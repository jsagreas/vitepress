---
title: 2ã€æ•°æ®å·æ“ä½œç®¡ç†
---
## ğŸ“š ç›®å½•

1. [æ•°æ®å·åŸºæœ¬æ¦‚å¿µ](#1-æ•°æ®å·åŸºæœ¬æ¦‚å¿µ)
2. [æ•°æ®å·ç±»å‹è¯¦è§£](#2-æ•°æ®å·ç±»å‹è¯¦è§£)
3. [docker volumeå‘½ä»¤é›†](#3-docker-volumeå‘½ä»¤é›†)
4. [æ•°æ®å·æŒ‚è½½é…ç½®](#4-æ•°æ®å·æŒ‚è½½é…ç½®)
5. [æ•°æ®å·å¤‡ä»½ä¸æ¢å¤](#5-æ•°æ®å·å¤‡ä»½ä¸æ¢å¤)
6. [æ•°æ®å·è¿ç§»ç­–ç•¥](#6-æ•°æ®å·è¿ç§»ç­–ç•¥)
7. [å·é©±åŠ¨é€‰æ‹©æŒ‡å—](#7-å·é©±åŠ¨é€‰æ‹©æŒ‡å—)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ’¾ æ•°æ®å·åŸºæœ¬æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯æ•°æ®å·


**æ•°æ®å·**å°±æ˜¯Dockerç”¨æ¥**æŒä¹…åŒ–å­˜å‚¨æ•°æ®**çš„æœºåˆ¶ï¼Œç®€å•è¯´å°±æ˜¯è®©å®¹å™¨é‡Œçš„æ•°æ®ä¸ä¼šéšç€å®¹å™¨åˆ é™¤è€Œä¸¢å¤±ã€‚

```
æƒ³è±¡ä¸€ä¸ªåœºæ™¯ï¼š
ä½ åœ¨å®¿èˆé‡Œï¼ˆå®¹å™¨ï¼‰å†™ä½œä¸šï¼ˆæ•°æ®ï¼‰
å¦‚æœå®¿èˆæ‹†äº†ï¼ˆå®¹å™¨åˆ é™¤ï¼‰ï¼Œä½œä¸šæœ¬ä¹Ÿæ²¡äº†
ä½†å¦‚æœä½ æŠŠä½œä¸šæ”¾åœ¨ä¿é™©æŸœé‡Œï¼ˆæ•°æ®å·ï¼‰ï¼Œå®¿èˆæ‹†äº†ä½œä¸šè¿˜åœ¨

å®¹å™¨ = ä¸´æ—¶çš„è¿è¡Œç¯å¢ƒ
æ•°æ®å· = æ°¸ä¹…çš„å­˜å‚¨ç©ºé—´
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®å·


**ğŸ”¸ æ ¸å¿ƒé—®é¢˜**ï¼šå®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿæ˜¯**ä¸´æ—¶çš„**

```
å®¹å™¨ç”Ÿå‘½å‘¨æœŸï¼š
åˆ›å»º â†’ è¿è¡Œ â†’ åœæ­¢ â†’ åˆ é™¤
  â†“      â†“      â†“      â†“
æ•°æ®äº§ç”Ÿ â†’ æ•°æ®ä¿®æ”¹ â†’ æ•°æ®ä¿ç•™ â†’ æ•°æ®æ¶ˆå¤± âŒ

ä½¿ç”¨æ•°æ®å·åï¼š
åˆ›å»º â†’ è¿è¡Œ â†’ åœæ­¢ â†’ åˆ é™¤
  â†“      â†“      â†“      â†“  
æ•°æ®äº§ç”Ÿ â†’ æ•°æ®ä¿®æ”¹ â†’ æ•°æ®ä¿ç•™ â†’ æ•°æ®ä¾ç„¶å­˜åœ¨ âœ…
```

**ğŸ”¸ æ•°æ®å·è§£å†³çš„é—®é¢˜**ï¼š
- **æ•°æ®æŒä¹…åŒ–**ï¼šå®¹å™¨åˆ é™¤åæ•°æ®ä¸ä¸¢å¤±
- **æ•°æ®å…±äº«**ï¼šå¤šä¸ªå®¹å™¨å¯ä»¥å…±äº«åŒä¸€ä¸ªæ•°æ®å·
- **æ€§èƒ½ä¼˜åŒ–**ï¼šç»•è¿‡å®¹å™¨æ–‡ä»¶ç³»ç»Ÿï¼Œç›´æ¥æ“ä½œå®¿ä¸»æœºæ–‡ä»¶
- **å¤‡ä»½æ–¹ä¾¿**ï¼šå¯ä»¥ç›´æ¥å¤‡ä»½å®¿ä¸»æœºä¸Šçš„æ•°æ®

### 1.3 æ•°æ®å·å·¥ä½œåŸç†


```
å®¿ä¸»æœºæ–‡ä»¶ç³»ç»Ÿ              å®¹å™¨æ–‡ä»¶ç³»ç»Ÿ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  /var/lib/docker/â”‚        â”‚    /app/data    â”‚
â”‚  volumes/my-vol â”‚â—„â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚
â”‚  â”œâ”€â”€ file1.txt  â”‚ æŒ‚è½½    â”‚   â”œâ”€â”€ file1.txt â”‚
â”‚  â””â”€â”€ file2.txt  â”‚        â”‚   â””â”€â”€ file2.txt â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å½“å®¹å™¨å†™å…¥ /app/data/file3.txt
å®é™…å†™å…¥åˆ° /var/lib/docker/volumes/my-vol/file3.txt
```

> ğŸ’¡ **å…³é”®ç†è§£**ï¼šæ•°æ®å·æ˜¯å®¿ä¸»æœºç›®å½•åˆ°å®¹å™¨ç›®å½•çš„"æ¡¥æ¢"

---

## 2. ğŸ“‚ æ•°æ®å·ç±»å‹è¯¦è§£


### 2.1 åŒ¿åå· (Anonymous Volume)


**å®šä¹‰**ï¼šDockerè‡ªåŠ¨åˆ›å»ºçš„ï¼Œæ²¡æœ‰å…·ä½“åç§°çš„æ•°æ®å·

```bash
# åˆ›å»ºåŒ¿åå·

docker run -v /app/data nginx

# Dockerä¼šè‡ªåŠ¨ç”Ÿæˆç±»ä¼¼è¿™æ ·çš„å·å

# /var/lib/docker/volumes/a1b2c3d4e5f6.../_data

```

**ç‰¹ç‚¹åˆ†æ**ï¼š
```
ä¼˜ç‚¹ï¼š
âœ… ä½¿ç”¨ç®€å•ï¼Œä¸€æ¡å‘½ä»¤æå®š
âœ… è‡ªåŠ¨ç®¡ç†ï¼Œæ— éœ€æ‰‹åŠ¨åˆ›å»º

ç¼ºç‚¹ï¼š
âŒ å·åéšæœºï¼Œéš¾ä»¥ç®¡ç†
âŒ å®¹å™¨åˆ é™¤æ—¶å®¹æ˜“è¯¯åˆ 
âŒ å¤šå®¹å™¨å…±äº«å›°éš¾
```

**é€‚ç”¨åœºæ™¯**ï¼š
- ä¸´æ—¶æ•°æ®å­˜å‚¨
- å•å®¹å™¨ä½¿ç”¨
- å¿«é€Ÿæµ‹è¯•

### 2.2 å‘½åå· (Named Volume)


**å®šä¹‰**ï¼šæœ‰æ˜ç¡®åç§°çš„æ•°æ®å·ï¼Œä¾¿äºç®¡ç†å’Œå¼•ç”¨

```bash
# åˆ›å»ºå‘½åå·

docker volume create my-data

# ä½¿ç”¨å‘½åå·

docker run -v my-data:/app/data nginx
```

**å‘½åè§„åˆ™å»ºè®®**ï¼š
```
é¡¹ç›®å-ç”¨é€”-ç¯å¢ƒï¼š
webapp-db-prod     (ç”Ÿäº§ç¯å¢ƒæ•°æ®åº“æ•°æ®)
webapp-logs-dev    (å¼€å‘ç¯å¢ƒæ—¥å¿—)
webapp-uploads-test (æµ‹è¯•ç¯å¢ƒä¸Šä¼ æ–‡ä»¶)
```

**ç‰¹ç‚¹åˆ†æ**ï¼š
```
ä¼˜ç‚¹ï¼š
âœ… åç§°æ˜ç¡®ï¼Œä¾¿äºç®¡ç†
âœ… å¤šå®¹å™¨å…±äº«æ–¹ä¾¿
âœ… å¤‡ä»½å’Œè¿ç§»å®¹æ˜“
âœ… ç”Ÿäº§ç¯å¢ƒé¦–é€‰

ç¼ºç‚¹ï¼š
âŒ éœ€è¦æ‰‹åŠ¨åˆ›å»ºå’Œç®¡ç†
```

### 2.3 ä¸»æœºç»‘å®šæŒ‚è½½ (Bind Mount)


**å®šä¹‰**ï¼šç›´æ¥å°†å®¿ä¸»æœºçš„ç›®å½•æˆ–æ–‡ä»¶æŒ‚è½½åˆ°å®¹å™¨ä¸­

```bash
# ç»‘å®šæŒ‚è½½ç›®å½•

docker run -v /host/path:/container/path nginx

# ç»‘å®šæŒ‚è½½æ–‡ä»¶

docker run -v /host/config.conf:/app/config.conf nginx
```

**è·¯å¾„ç±»å‹å¯¹æ¯”**ï¼š
```
ç»å¯¹è·¯å¾„æŒ‚è½½ï¼š
docker run -v /home/user/data:/app/data nginx
â†“
å®¿ä¸»æœºçš„ /home/user/data æŒ‚è½½åˆ°å®¹å™¨çš„ /app/data

ç›¸å¯¹è·¯å¾„æŒ‚è½½ï¼š
docker run -v ./data:/app/data nginx  
â†“
å½“å‰ç›®å½•ä¸‹çš„ data æ–‡ä»¶å¤¹æŒ‚è½½åˆ°å®¹å™¨
```

**ç‰¹ç‚¹åˆ†æ**ï¼š
```
ä¼˜ç‚¹ï¼š
âœ… å¯ä»¥æŒ‚è½½å®¿ä¸»æœºä»»æ„ä½ç½®
âœ… å¼€å‘æ—¶æ–¹ä¾¿å®æ—¶æŸ¥çœ‹ä¿®æ”¹
âœ… é…ç½®æ–‡ä»¶ç®¡ç†æ–¹ä¾¿

ç¼ºç‚¹ï¼š
âŒ ä¾èµ–å®¿ä¸»æœºè·¯å¾„ç»“æ„
âŒ è·¨å¹³å°å…¼å®¹æ€§å·®
âŒ å®‰å…¨é£é™©ç›¸å¯¹è¾ƒé«˜
```

### 2.4 ä¸‰ç§ç±»å‹ä½¿ç”¨å¯¹æ¯”


| ç±»å‹ | **ä½¿ç”¨è¯­æ³•** | **æ•°æ®ä½ç½®** | **é€‚ç”¨åœºæ™¯** | **ç®¡ç†éš¾åº¦** |
|------|------------|-------------|-------------|-------------|
| ğŸ”¸ **åŒ¿åå·** | `-v /container/path` | `Dockerç®¡ç†çš„éšæœºä½ç½®` | `ä¸´æ—¶æ•°æ®ã€æµ‹è¯•` | `ç®€å•ä½†éš¾è¿½è¸ª` |
| ğŸ”¸ **å‘½åå·** | `-v volume-name:/path` | `Dockerç®¡ç†çš„æŒ‡å®šä½ç½®` | `æ•°æ®åº“ã€æŒä¹…å­˜å‚¨` | `ä¸­ç­‰ï¼Œæ¨èä½¿ç”¨` |
| ğŸ”¸ **ç»‘å®šæŒ‚è½½** | `-v /host/path:/path` | `å®¿ä¸»æœºæŒ‡å®šä½ç½®` | `å¼€å‘ã€é…ç½®ç®¡ç†` | `å¤æ‚ä½†çµæ´»` |

---

## 3. âš™ï¸ docker volumeå‘½ä»¤é›†


### 3.1 åˆ›å»ºæ•°æ®å·


```bash
# åŸºæœ¬åˆ›å»º

docker volume create my-volume

# æŒ‡å®šé©±åŠ¨åˆ›å»º

docker volume create --driver local my-volume

# å¸¦æ ‡ç­¾åˆ›å»º

docker volume create --label project=webapp my-volume
```

**åˆ›å»ºæ—¶çš„é€‰é¡¹è¯´æ˜**ï¼š
```
--driverï¼šæŒ‡å®šå­˜å‚¨é©±åŠ¨ï¼ˆlocalã€nfsç­‰ï¼‰
--labelï¼šæ·»åŠ æ ‡ç­¾ï¼Œä¾¿äºåˆ†ç±»ç®¡ç†
--optï¼šä¼ é€’é©±åŠ¨ç‰¹å®šé€‰é¡¹
```

### 3.2 æŸ¥çœ‹æ•°æ®å·


```bash
# åˆ—å‡ºæ‰€æœ‰æ•°æ®å·

docker volume ls

# æŸ¥çœ‹ç‰¹å®šæ•°æ®å·è¯¦ç»†ä¿¡æ¯

docker volume inspect my-volume

# è¿‡æ»¤æŸ¥çœ‹

docker volume ls --filter dangling=true  # æ‚¬æŒ‚å·
docker volume ls --filter label=project=webapp  # æŒ‰æ ‡ç­¾è¿‡æ»¤
```

**inspectè¾“å‡ºè§£è¯»**ï¼š
```json
[
    {
        "CreatedAt": "2025-09-19T10:30:00Z",
        "Driver": "local",
        "Labels": {},
        "Mountpoint": "/var/lib/docker/volumes/my-volume/_data",
        "Name": "my-volume",
        "Options": {},
        "Scope": "local"
    }
]
```

> ğŸ“ **é‡ç‚¹ç†è§£**ï¼šMountpointå°±æ˜¯æ•°æ®åœ¨å®¿ä¸»æœºä¸Šçš„å®é™…å­˜å‚¨ä½ç½®

### 3.3 åˆ é™¤æ•°æ®å·


```bash
# åˆ é™¤å•ä¸ªæ•°æ®å·

docker volume rm my-volume

# æ‰¹é‡åˆ é™¤æ‚¬æŒ‚å·

docker volume prune

# å¼ºåˆ¶åˆ é™¤ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰

docker volume rm -f my-volume

# åˆ é™¤æ‰€æœ‰æœªä½¿ç”¨çš„å·

docker volume prune -a
```

**âš ï¸ åˆ é™¤æ³¨æ„äº‹é¡¹**ï¼š
```
åˆ é™¤å‰ç¡®è®¤ï¼š
1. å·æ˜¯å¦è¿˜è¢«å®¹å™¨ä½¿ç”¨ï¼Ÿ
2. æ•°æ®æ˜¯å¦å·²å¤‡ä»½ï¼Ÿ
3. æ˜¯å¦æ˜¯ç”Ÿäº§ç¯å¢ƒï¼Ÿ

å®‰å…¨åˆ é™¤æµç¨‹ï¼š
1. åœæ­¢ç›¸å…³å®¹å™¨
2. å¤‡ä»½é‡è¦æ•°æ®
3. ç¡®è®¤æ— è¯¯ååˆ é™¤
```

### 3.4 æ•°æ®å·æ¸…ç†


```bash
# æŸ¥çœ‹æ‚¬æŒ‚å·ï¼ˆæœªè¢«å®¹å™¨ä½¿ç”¨ï¼‰

docker volume ls -f dangling=true

# æ¸…ç†æ‚¬æŒ‚å·

docker volume prune

# ç³»ç»Ÿçº§æ¸…ç†ï¼ˆåŒ…å«æœªä½¿ç”¨çš„å·ï¼‰

docker system prune --volumes
```

**æ¸…ç†ç­–ç•¥å»ºè®®**ï¼š
```
æ—¥å¸¸ç»´æŠ¤ï¼š
æ¯å‘¨æ‰§è¡Œ docker volume prune
å®šæœŸæ£€æŸ¥ docker volume ls
ç›‘æ§ç£ç›˜ä½¿ç”¨æƒ…å†µ

ç”Ÿäº§ç¯å¢ƒï¼š
åˆ¶å®šæ•°æ®å·ç®¡ç†è§„èŒƒ
å®šæœŸå¤‡ä»½é‡è¦æ•°æ®å·
å»ºç«‹å·çš„å‘½åå’Œæ ‡ç­¾è§„èŒƒ
```

---

## 4. ğŸ”§ æ•°æ®å·æŒ‚è½½é…ç½®


### 4.1 åŸºæœ¬æŒ‚è½½è¯­æ³•


```bash
# ä¸‰ç§æŒ‚è½½æ–¹å¼å¯¹æ¯”

docker run -v volume-name:/path nginx          # å‘½åå·
docker run -v /host/path:/path nginx           # ç»‘å®šæŒ‚è½½
docker run -v /path nginx                      # åŒ¿åå·

# ä½¿ç”¨ --mount è¯­æ³•ï¼ˆæ¨èï¼‰

docker run --mount source=my-vol,target=/app/data nginx
```

### 4.2 æŒ‚è½½é€‰é¡¹è¯¦è§£


**åªè¯»æŒ‚è½½**ï¼š
```bash
# çŸ­è¯­æ³•

docker run -v my-vol:/app/data:ro nginx

# é•¿è¯­æ³•

docker run --mount source=my-vol,target=/app/data,readonly nginx
```

**è¯»å†™æƒé™æ§åˆ¶**ï¼š
```
ro (read-only)ï¼šåªè¯»ï¼Œå®¹å™¨æ— æ³•ä¿®æ”¹æ•°æ®
rw (read-write)ï¼šè¯»å†™ï¼Œé»˜è®¤é€‰é¡¹
```

### 4.3 å¤šå·æŒ‚è½½


```bash
# åŒæ—¶æŒ‚è½½å¤šä¸ªå·

docker run \
  -v app-data:/app/data \
  -v app-logs:/app/logs \
  -v app-config:/app/config:ro \
  nginx
```

**å¤šå·è®¾è®¡åŸåˆ™**ï¼š
```
æ•°æ®åˆ†ç¦»ï¼š
/app/data    â†’ ä¸šåŠ¡æ•°æ®ï¼ˆè¯»å†™ï¼‰
/app/logs    â†’ æ—¥å¿—æ–‡ä»¶ï¼ˆè¯»å†™ï¼‰
/app/config  â†’ é…ç½®æ–‡ä»¶ï¼ˆåªè¯»ï¼‰
/app/uploads â†’ ç”¨æˆ·ä¸Šä¼ ï¼ˆè¯»å†™ï¼‰

å¥½å¤„ï¼š
âœ… ä¾¿äºå¤‡ä»½ç­–ç•¥åˆ¶å®š
âœ… æƒé™æ§åˆ¶æ›´ç²¾ç»†
âœ… è¿ç§»å’Œæ‰©å±•æ›´çµæ´»
```

### 4.4 Docker Composeä¸­çš„å·é…ç½®


```yaml
version: '3.8'
services:
  web:
    image: nginx
    volumes:
      - app-data:/var/www/html
      - app-logs:/var/log/nginx
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
    
  db:
    image: mysql:8.0
    volumes:
      - db-data:/var/lib/mysql
      - ./mysql.conf:/etc/mysql/conf.d/mysql.conf:ro

volumes:
  app-data:
    driver: local
    labels:
      project: webapp
  app-logs:
    driver: local
  db-data:
    driver: local
    driver_opts:
      type: none
      o: bind
      device: /opt/mysql-data
```

---

## 5. ğŸ’¾ æ•°æ®å·å¤‡ä»½ä¸æ¢å¤


### 5.1 æ•°æ®å·å¤‡ä»½æ–¹æ³•


**æ–¹æ³•ä¸€ï¼šä½¿ç”¨ä¸´æ—¶å®¹å™¨å¤‡ä»½**
```bash
# å¤‡ä»½å‘½åå·

docker run --rm \
  -v my-volume:/data \
  -v $(pwd):/backup \
  ubuntu tar czf /backup/my-volume-backup.tar.gz -C /data .

# è§£é‡Šï¼š

# --rm: å®¹å™¨è¿è¡Œå®Œè‡ªåŠ¨åˆ é™¤

# -v my-volume:/data: æŒ‚è½½è¦å¤‡ä»½çš„å·

# -v $(pwd):/backup: å°†å½“å‰ç›®å½•æŒ‚è½½ä¸ºå¤‡ä»½ç›®æ ‡

# tar czf: åˆ›å»ºå‹ç¼©å½’æ¡£æ–‡ä»¶

```

**æ–¹æ³•äºŒï¼šç›´æ¥å¤åˆ¶å®¿ä¸»æœºæ–‡ä»¶**
```bash
# æ‰¾åˆ°å·çš„å®é™…ä½ç½®

docker volume inspect my-volume | grep Mountpoint

# ç›´æ¥å¤‡ä»½

sudo cp -r /var/lib/docker/volumes/my-volume/_data ./backup-$(date +%Y%m%d)
```

### 5.2 æ•°æ®å·æ¢å¤æ–¹æ³•


**ä»å¤‡ä»½æ¢å¤åˆ°æ–°å·**ï¼š
```bash
# åˆ›å»ºæ–°å·

docker volume create my-volume-restored

# æ¢å¤æ•°æ®

docker run --rm \
  -v my-volume-restored:/data \
  -v $(pwd):/backup \
  ubuntu tar xzf /backup/my-volume-backup.tar.gz -C /data
```

### 5.3 è‡ªåŠ¨åŒ–å¤‡ä»½è„šæœ¬


**ğŸ”¸ å¤‡ä»½è„šæœ¬ç¤ºä¾‹**ï¼š
```bash
#!/bin/bash

# docker-volume-backup.sh


VOLUME_NAME=$1
BACKUP_DIR="/backups"
DATE=$(date +%Y%m%d_%H%M%S)

if [ -z "$VOLUME_NAME" ]; then
  echo "ç”¨æ³•: $0 <å·å>"
  exit 1
fi

echo "å¼€å§‹å¤‡ä»½å·: $VOLUME_NAME"
docker run --rm \
  -v ${VOLUME_NAME}:/data:ro \
  -v ${BACKUP_DIR}:/backup \
  ubuntu tar czf /backup/${VOLUME_NAME}-${DATE}.tar.gz -C /data .

echo "å¤‡ä»½å®Œæˆ: ${BACKUP_DIR}/${VOLUME_NAME}-${DATE}.tar.gz"
```

**å®šæ—¶å¤‡ä»½è®¾ç½®**ï¼š
```bash
# æ·»åŠ åˆ°crontab

# æ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½æ•°æ®åº“å·

0 2 * * * /usr/local/bin/docker-volume-backup.sh db-data
```

---

## 6. ğŸš€ æ•°æ®å·è¿ç§»ç­–ç•¥


### 6.1 åŒä¸»æœºè¿ç§»


**åœºæ™¯**ï¼šåœ¨åŒä¸€å°æœºå™¨ä¸Šå¤åˆ¶å·æ•°æ®

```bash
# æ–¹æ³•1: é€šè¿‡å¤‡ä»½æ¢å¤

docker run --rm \
  -v source-volume:/from \
  -v target-volume:/to \
  ubuntu sh -c "cp -a /from/. /to/"

# æ–¹æ³•2: ä½¿ç”¨rsyncï¼ˆä¿æŒæƒé™ï¼‰

docker run --rm \
  -v source-volume:/from \
  -v target-volume:/to \
  ubuntu rsync -av /from/ /to/
```

### 6.2 è·¨ä¸»æœºè¿ç§»


**å‡†å¤‡é˜¶æ®µ**ï¼š
```
æºä¸»æœº (Host A)     ç›®æ ‡ä¸»æœº (Host B)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æºæ•°æ®å·   â”‚    â”‚   ç›®æ ‡ç¯å¢ƒ   â”‚
â”‚ my-app-data â”‚â”€â”€â”€â–ºâ”‚ å¾…è¿ç§»é…ç½®   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è¿ç§»æ­¥éª¤**ï¼š

**æ­¥éª¤1ï¼šæºä¸»æœºå¯¼å‡ºæ•°æ®**
```bash
# åœ¨ä¸»æœºAä¸Šæ‰§è¡Œ

docker run --rm \
  -v my-app-data:/data:ro \
  -v $(pwd):/backup \
  ubuntu tar czf /backup/app-data-migration.tar.gz -C /data .

# ä¼ è¾“åˆ°ä¸»æœºB

scp app-data-migration.tar.gz user@hostb:/tmp/
```

**æ­¥éª¤2ï¼šç›®æ ‡ä¸»æœºå¯¼å…¥æ•°æ®**
```bash
# åœ¨ä¸»æœºBä¸Šæ‰§è¡Œ

docker volume create my-app-data

docker run --rm \
  -v my-app-data:/data \
  -v /tmp:/backup \
  ubuntu tar xzf /backup/app-data-migration.tar.gz -C /data
```

### 6.3 æ‰¹é‡è¿ç§»è„šæœ¬


```bash
#!/bin/bash

# batch-volume-migrate.sh


SOURCE_HOST=$1
VOLUME_LIST=$2

if [ -z "$SOURCE_HOST" ] || [ -z "$VOLUME_LIST" ]; then
  echo "ç”¨æ³•: $0 <æºä¸»æœº> <å·åˆ—è¡¨æ–‡ä»¶>"
  exit 1
fi

while read volume; do
  echo "è¿ç§»å·: $volume"
  
#  # åœ¨æºä¸»æœºå¤‡ä»½
  ssh $SOURCE_HOST "docker run --rm \
    -v $volume:/data:ro \
    -v /tmp:/backup \
    ubuntu tar czf /backup/$volume.tar.gz -C /data ."
  
#  # ä¼ è¾“å¤‡ä»½æ–‡ä»¶
  scp $SOURCE_HOST:/tmp/$volume.tar.gz /tmp/
  
#  # åœ¨æœ¬æœºæ¢å¤
  docker volume create $volume
  docker run --rm \
    -v $volume:/data \
    -v /tmp:/backup \
    ubuntu tar xzf /backup/$volume.tar.gz -C /data
    
  echo "å®Œæˆè¿ç§»: $volume"
done < $VOLUME_LIST
```

---

## 7. ğŸ”Œ å·é©±åŠ¨é€‰æ‹©æŒ‡å—


### 7.1 æœ¬åœ°é©±åŠ¨ (local)


**ç‰¹ç‚¹**ï¼šDockeré»˜è®¤çš„å­˜å‚¨é©±åŠ¨

```bash
# é»˜è®¤ä½¿ç”¨localé©±åŠ¨

docker volume create my-volume

# æ˜¾å¼æŒ‡å®šlocalé©±åŠ¨

docker volume create --driver local my-volume

# æœ¬åœ°é©±åŠ¨çš„æŒ‚è½½é€‰é¡¹

docker volume create --driver local \
  --opt type=nfs \
  --opt o=addr=192.168.1.100,rw \
  --opt device=:/path/to/share \
  nfs-volume
```

**é€‚ç”¨åœºæ™¯**ï¼š
```
âœ… å•æœºéƒ¨ç½²
âœ… å¼€å‘æµ‹è¯•ç¯å¢ƒ
âœ… ç®€å•çš„æŒä¹…åŒ–å­˜å‚¨éœ€æ±‚
âœ… æ€§èƒ½è¦æ±‚è¾ƒé«˜çš„åœºæ™¯

âŒ ä¸é€‚ç”¨äºé›†ç¾¤ç¯å¢ƒ
âŒ ä¸æ”¯æŒè·¨ä¸»æœºå…±äº«
```

### 7.2 ç½‘ç»œå­˜å‚¨é©±åŠ¨


**NFSé©±åŠ¨é…ç½®**ï¼š
```bash
# åˆ›å»ºNFSå·

docker volume create --driver local \
  --opt type=nfs \
  --opt o=addr=nfs.example.com,rw,noatime,rsize=8192,wsize=8192 \
  --opt device=:/data/shared \
  nfs-shared-volume
```

**å…¶ä»–ç½‘ç»œå­˜å‚¨**ï¼š
```
CIFS/SMBï¼šWindowså…±äº«
GlusterFSï¼šåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ
Cephï¼šåˆ†å¸ƒå¼å­˜å‚¨é›†ç¾¤
```

### 7.3 äº‘å­˜å‚¨é©±åŠ¨


**AWS EBSç¤ºä¾‹**ï¼š
```yaml
# Docker Swarmæ¨¡å¼ä¸‹ä½¿ç”¨äº‘å­˜å‚¨

version: '3.8'
services:
  app:
    image: my-app
    volumes:
      - app-data:/data

volumes:
  app-data:
    driver: cloudstor:aws
    driver_opts:
      backing: ebs
      size: 100GB
      ebstype: gp2
```

### 7.4 é©±åŠ¨é€‰æ‹©å¯¹æ¯”


| é©±åŠ¨ç±»å‹ | **æ€§èƒ½** | **å¯ç”¨æ€§** | **å¤æ‚åº¦** | **æˆæœ¬** | **é€‚ç”¨åœºæ™¯** |
|---------|---------|-----------|-----------|---------|------------|
| ğŸ”¸ **Local** | `æé«˜` | `å•æœº` | `ç®€å•` | `ä½` | `å¼€å‘æµ‹è¯•` |
| ğŸ”¸ **NFS** | `ä¸­ç­‰` | `ç½‘ç»œå…±äº«` | `ä¸­ç­‰` | `ä¸­ç­‰` | `å°è§„æ¨¡é›†ç¾¤` |
| ğŸ”¸ **äº‘å­˜å‚¨** | `é«˜` | `é«˜å¯ç”¨` | `å¤æ‚` | `é«˜` | `ç”Ÿäº§é›†ç¾¤` |

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æ•°æ®å·æœ¬è´¨ï¼šå®¿ä¸»æœºå­˜å‚¨åˆ°å®¹å™¨ç›®å½•çš„æ¡¥æ¢
ğŸ”¸ ä¸‰ç§å·ç±»å‹ï¼šåŒ¿åå·ã€å‘½åå·ã€ç»‘å®šæŒ‚è½½
ğŸ”¸ æ ¸å¿ƒå‘½ä»¤ï¼šcreateã€lsã€inspectã€rmã€prune
ğŸ”¸ æŒ‚è½½è¯­æ³•ï¼š-v å’Œ --mount ä¸¤ç§æ–¹å¼
ğŸ”¸ å¤‡ä»½æ¢å¤ï¼šé€šè¿‡ä¸´æ—¶å®¹å™¨å®ç°æ•°æ®è¿ç§»
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä»€ä¹ˆæ—¶å€™ç”¨å“ªç§å·**
```
å¼€å‘é˜¶æ®µï¼š
â†’ ç»‘å®šæŒ‚è½½ï¼šå®æ—¶æŸ¥çœ‹ä»£ç å˜åŒ–
â†’ å‘½åå·ï¼šæ•°æ®åº“ç­‰æŒä¹…æ•°æ®

ç”Ÿäº§ç¯å¢ƒï¼š
â†’ å‘½åå·ï¼šåº”ç”¨æ•°æ®å­˜å‚¨
â†’ ç»‘å®šæŒ‚è½½ï¼šé…ç½®æ–‡ä»¶ç®¡ç†
â†’ é¿å…ä½¿ç”¨åŒ¿åå·
```

**ğŸ”¹ æ•°æ®å®‰å…¨æœ€ä½³å®è·µ**
```
å¤‡ä»½ç­–ç•¥ï¼š
âœ… å®šæœŸè‡ªåŠ¨å¤‡ä»½é‡è¦æ•°æ®å·
âœ… æµ‹è¯•æ¢å¤æµç¨‹çš„å¯è¡Œæ€§
âœ… å¼‚åœ°å¤‡ä»½å…³é”®ä¸šåŠ¡æ•°æ®

æƒé™æ§åˆ¶ï¼š
âœ… æ•æ„Ÿé…ç½®ä½¿ç”¨åªè¯»æŒ‚è½½
âœ… æ—¥å¿—ç›®å½•ä½¿ç”¨ç‹¬ç«‹å·
âœ… ä¸´æ—¶æ•°æ®ä½¿ç”¨åŒ¿åå·
```

### 8.3 å®è·µåº”ç”¨æŒ‡å—


**ğŸ¯ å¸¸è§åº”ç”¨åœºæ™¯**
- **Webåº”ç”¨**ï¼šä»£ç ã€é…ç½®ã€æ—¥å¿—ã€ä¸Šä¼ æ–‡ä»¶åˆ†ç¦»å­˜å‚¨
- **æ•°æ®åº“**ï¼šæ•°æ®æ–‡ä»¶ã€é…ç½®æ–‡ä»¶ã€æ—¥å¿—æ–‡ä»¶ç‹¬ç«‹ç®¡ç†
- **å¼€å‘ç¯å¢ƒ**ï¼šæºç å®æ—¶åŒæ­¥ï¼Œé…ç½®åŠ¨æ€åŠ è½½

**ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®**
- é¿å…åœ¨æ•°æ®å·ä¸­å­˜å‚¨ä¸´æ—¶æ–‡ä»¶
- å¤§æ–‡ä»¶æ“ä½œè€ƒè™‘ä½¿ç”¨ç»‘å®šæŒ‚è½½
- ç½‘ç»œå­˜å‚¨æ³¨æ„å»¶è¿Ÿå¯¹åº”ç”¨çš„å½±å“

**ğŸ”§ æ•…éšœæ’æŸ¥æ€è·¯**
1. æ£€æŸ¥å·æ˜¯å¦æ­£ç¡®æŒ‚è½½ï¼š`docker inspect container`
2. ç¡®è®¤æƒé™è®¾ç½®ï¼š`ls -la /var/lib/docker/volumes/`
3. æŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼š`docker logs container`
4. æµ‹è¯•è¯»å†™æƒé™ï¼šè¿›å…¥å®¹å™¨æ‰‹åŠ¨æ“ä½œæ–‡ä»¶

**ğŸ§  è®°å¿†å£è¯€**ï¼š
- æ•°æ®è¦æŒä¹…ï¼Œæ•°æ®å·æ¥åŠ©
- åŒ¿åä¸´æ—¶ç”¨ï¼Œå‘½åç”Ÿäº§å‚¨
- ç»‘å®šå¼€å‘è°ƒï¼Œç½‘ç»œé›†ç¾¤å¸ƒ
- å¤‡ä»½è¦å®šæ—¶ï¼Œæ¢å¤è¦æµ‹è¯•

**æ ¸å¿ƒè®°å¿†**ï¼š
- Dockeræ•°æ®å·æ˜¯å®ç°æ•°æ®æŒä¹…åŒ–çš„å…³é”®æŠ€æœ¯
- ç†è§£ä¸‰ç§å·ç±»å‹çš„é€‚ç”¨åœºæ™¯æ˜¯åŸºç¡€
- æŒæ¡å¤‡ä»½æ¢å¤æ˜¯ä¿éšœæ•°æ®å®‰å…¨çš„å¿…å¤‡æŠ€èƒ½
- åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¦å»ºç«‹å®Œå–„çš„å·ç®¡ç†è§„èŒƒ