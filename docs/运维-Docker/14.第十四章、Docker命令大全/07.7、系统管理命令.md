---
title: 7、系统管理命令
---
## 📚 目录

1. [系统信息查看](#1-系统信息查看)
2. [系统资源管理](#2-系统资源管理) 
3. [系统清理优化](#3-系统清理优化)
4. [系统监控事件](#4-系统监控事件)
5. [仓库认证管理](#5-仓库认证管理)
6. [版本帮助信息](#6-版本帮助信息)
7. [实际应用场景](#7-实际应用场景)
8. [核心要点总结](#8-核心要点总结)

---

## 1. 🔍 系统信息查看


### 1.1 docker system info - 查看系统详细信息


**🔸 基本概念**
`docker system info`命令用来查看Docker系统的详细配置信息，包括容器数量、镜像数量、存储驱动、网络配置等核心信息。

**💡 命令格式**
```bash
docker system info
# 或简写形式
docker info
```

**📊 输出信息解读**
```bash
# 执行命令后的典型输出
Client:
 Version:    20.10.12
 API version: 1.41

Server:
 Containers: 5          # 总容器数
  Running: 2           # 运行中的容器
  Paused: 0            # 暂停的容器  
  Stopped: 3           # 停止的容器
 Images: 10            # 本地镜像总数
 Server Version: 20.10.12
 Storage Driver: overlay2   # 存储驱动类型
 Registry: https://index.docker.io/v1/  # 默认仓库地址
```

### 1.2 关键信息说明


**🎯 重要参数含义**

| 参数项 | **含义说明** | **实际意义** |
|--------|-------------|-------------|
| **Containers** | `容器总数统计` | `了解容器使用情况` |
| **Images** | `本地镜像数量` | `评估存储空间占用` |
| **Storage Driver** | `存储驱动类型` | `影响性能和兼容性` |
| **Registry** | `默认镜像仓库` | `镜像拉取来源` |
| **Swarm** | `集群模式状态` | `是否启用集群功能` |

**⚡ 实用小技巧**
```bash
# 仅显示特定格式的信息
docker system info --format "{{.ServerVersion}}"

# 获取容器总数
docker system info --format "{{.Containers}}"
```

---

## 2. 📊 系统资源管理


### 2.1 docker system df - 磁盘使用情况


**🔸 基本概念**
`docker system df`命令类似Linux的`df`命令，用来查看Docker相关的磁盘空间使用情况，帮助我们了解存储资源的分配。

**💡 命令使用**
```bash
docker system df
```

**📈 输出结果解析**
```bash
TYPE            TOTAL     ACTIVE    SIZE      RECLAIMABLE
Images          10        5         2.1GB     1.2GB (57%)
Containers      8         2         150MB     100MB (66%)
Local Volumes   3         1         500MB     400MB (80%)
Build Cache     0         0         0B        0B
```

### 2.2 输出信息详解


**🎯 各列含义说明**

**TOTAL**: 总数量 - 表示该类型资源的总个数
**ACTIVE**: 活跃数量 - 正在使用的资源个数  
**SIZE**: 占用大小 - 总共占用的磁盘空间
**RECLAIMABLE**: 可回收空间 - 可以通过清理释放的空间

**💭 实际理解**
- **镜像(Images)**: 包括所有下载的镜像文件
- **容器(Containers)**: 包括运行和停止的容器
- **本地卷(Volumes)**: Docker管理的数据卷
- **构建缓存(Build Cache)**: Dockerfile构建时产生的缓存

**⚠️ 详细信息查看**
```bash
# 显示更详细的信息
docker system df -v
```

---

## 3. 🧹 系统清理优化


### 3.1 docker system prune - 系统清理


**🔸 基本概念**
`docker system prune`是Docker提供的"一键清理"命令，可以快速清理系统中不再使用的资源，释放磁盘空间。

### 3.2 清理级别选择


**🎯 基础清理**
```bash
# 清理未使用的资源（谨慎操作）
docker system prune
```
清理内容：
- ✅ 停止的容器
- ✅ 未使用的网络  
- ✅ 悬挂镜像（dangling images）
- ❌ **不会**清理正在使用的镜像

**💥 深度清理**
```bash
# 清理所有未使用的资源（非常谨慎！）
docker system prune -a
```
清理内容：
- ✅ 停止的容器
- ✅ 未使用的网络
- ✅ **所有**未使用的镜像
- ✅ 未使用的构建缓存

**🔧 指定时间清理**
```bash
# 清理24小时前创建的未使用资源
docker system prune --filter "until=24h"

# 清理7天前的资源
docker system prune --filter "until=168h"
```

### 3.3 清理操作说明


**⚡ 执行流程图示**
```
开始执行prune命令
        ↓
    系统扫描资源
        ↓
    识别未使用项目
        ↓
    [确认提示]
   Are you sure? (y/N)
        ↓
    用户确认(y)
        ↓
    开始清理资源
        ↓
    显示清理结果
```

**🛡️ 安全提醒**
```
⚠️ 重要提醒：
- prune操作不可逆，删除后无法恢复
- 建议先用 docker system df 查看要清理的内容
- 生产环境使用前务必备份重要数据
- 可以用 -f 参数跳过确认，但要格外小心
```

---

## 4. 📱 系统监控事件


### 4.1 docker system events - 实时事件监控


**🔸 基本概念**
`docker system events`命令用来实时监控Docker系统中发生的各种事件，比如容器的启动、停止、镜像的拉取等操作。

**💡 基础用法**
```bash
# 实时监控所有事件
docker system events
```

### 4.2 事件类型理解


**📋 常见事件类型**

| 事件类型 | **说明** | **典型场景** |
|---------|----------|-------------|
| `container` | `容器相关事件` | `start、stop、create、destroy` |
| `image` | `镜像相关事件` | `pull、push、delete、tag` |
| `network` | `网络相关事件` | `create、connect、disconnect` |
| `volume` | `数据卷事件` | `create、mount、unmount` |

**🔍 事件过滤监控**
```bash
# 只监控容器事件
docker system events --filter type=container

# 监控特定容器的事件
docker system events --filter container=my-container

# 监控最近1小时的事件
docker system events --since="1h"
```

### 4.3 实际监控示例


**📊 事件输出格式**
```bash
2024-01-20T10:30:45.123456789+08:00 container start abc123...
2024-01-20T10:31:02.456789012+08:00 container stop abc123...
2024-01-20T10:31:15.789012345+08:00 image pull nginx:latest
```

**💭 输出解读**
- **时间戳**: 事件发生的精确时间
- **事件类型**: container/image/network等
- **操作类型**: start/stop/pull/push等  
- **资源标识**: 容器ID、镜像名等

---

## 5. 🔐 仓库认证管理


### 5.1 docker login - 登录镜像仓库


**🔸 基本概念**
`docker login`命令用来登录Docker镜像仓库，获取推送(push)和拉取(pull)私有镜像的权限。

**💡 登录操作**
```bash
# 登录Docker Hub（默认仓库）
docker login

# 登录指定仓库
docker login registry.example.com
```

### 5.2 登录流程说明


**🔄 交互式登录流程**
```
执行 docker login
        ↓
输入用户名: your-username
        ↓  
输入密码: ********
        ↓
验证凭据
        ↓
登录成功，保存认证信息
```

**🔧 非交互式登录**
```bash
# 通过参数直接登录（不推荐，密码会在命令历史中）
docker login -u username -p password

# 通过环境变量登录（推荐方式）
echo $DOCKER_PASSWORD | docker login -u $DOCKER_USERNAME --password-stdin
```

### 5.3 docker logout - 退出登录


**🔸 基本使用**
```bash
# 退出默认仓库登录
docker logout

# 退出指定仓库登录  
docker logout registry.example.com
```

**🛡️ 安全说明**
```
登录信息存储位置：
- Linux: ~/.docker/config.json
- Windows: %USERPROFILE%\.docker\config.json
- macOS: ~/.docker/config.json

安全建议：
✅ 及时logout避免凭据泄露
✅ 定期更换登录密码
✅ 使用访问令牌代替密码（推荐）
```

---

## 6. ℹ️ 版本帮助信息


### 6.1 docker version - 版本信息查看


**🔸 基本概念**
`docker version`命令显示Docker客户端和服务端的详细版本信息，帮助我们了解Docker的安装情况。

**💡 基础用法**
```bash
docker version
```

**📊 输出信息结构**
```bash
Client: Docker Engine - Community
 Version:           20.10.12
 API version:       1.41
 Go version:        go1.16.12
 Git commit:        e91ed57
 Built:             Mon Dec 13 11:45:33 2021
 OS/Arch:           linux/amd64

Server: Docker Engine - Community  
 Engine:
  Version:          20.10.12
  API version:      1.41 (minimum version 1.12)
  Go version:       go1.16.12
  Git commit:       459d0df
  Built:            Mon Dec 13 11:44:05 2021
  OS/Arch:          linux/amd64
```

### 6.2 docker --help - 帮助信息


**🔸 帮助体系**
```bash
# 查看主要命令帮助
docker --help

# 查看具体命令的帮助
docker run --help
docker system --help
```

**📚 帮助信息层次**
```
docker --help                  ← 顶层命令概览
    ↓
docker system --help          ← 系统管理命令
    ↓  
docker system prune --help    ← 具体命令详情
```

**💡 快速查找技巧**
```bash
# 搜索包含特定关键词的帮助
docker --help | grep "system"

# 查看命令的简短说明
docker system --help | head -10
```

---

## 7. 🎯 实际应用场景


### 7.1 日常运维检查流程


**📋 系统健康检查清单**
```
1. 查看系统信息
   docker system info
   ↓
2. 检查磁盘使用
   docker system df  
   ↓
3. 监控系统事件（可选）
   docker system events
   ↓
4. 定期清理（根据需要）
   docker system prune
```

### 7.2 存储空间管理策略


**📊 空间使用监控**
```bash
#!/bin/bash
# Docker存储监控脚本

echo "=== Docker存储使用情况 ==="
docker system df

echo -e "\n=== 可清理空间统计 ==="  
docker system df --format "table {{.Type}}\t{{.Reclaimable}}"

# 当可回收空间超过1GB时提醒清理
RECLAIMABLE=$(docker system df --format "{{.Reclaimable}}" | head -1)
if [[ $RECLAIMABLE =~ ([0-9.]+)GB ]]; then
    if (( $(echo "${BASH_REMATCH[1]} > 1.0" | bc -l) )); then
        echo "⚠️  建议执行清理操作：docker system prune"
    fi
fi
```

### 7.3 安全运维最佳实践


**🛡️ 安全操作建议**

**登录安全**：
- ✅ 使用访问令牌而非密码
- ✅ 及时退出登录避免凭据泄露  
- ✅ 定期轮换认证信息

**清理安全**：
- ✅ 清理前先备份重要数据
- ✅ 生产环境避免使用`prune -a`
- ✅ 使用过滤器精确清理

**监控安全**：
- ✅ 定期检查系统events
- ✅ 监控异常登录行为
- ✅ 关注镜像拉取异常

---

## 8. 📋 核心要点总结


### 8.1 必须掌握的核心命令


```
🔸 系统信息：docker system info - 了解Docker运行状态
🔸 空间管理：docker system df - 监控磁盘使用情况  
🔸 系统清理：docker system prune - 释放存储空间
🔸 事件监控：docker system events - 实时监控系统活动
🔸 仓库认证：docker login/logout - 管理镜像仓库访问权限
🔸 版本信息：docker version - 查看Docker版本详情
```

### 8.2 关键理解要点


**🔹 系统管理的核心作用**
```
性能监控：
- 及时了解系统运行状态
- 监控资源使用情况
- 发现潜在问题

空间优化：
- 定期清理释放空间
- 避免存储空间不足
- 提高系统运行效率

安全管理：  
- 管理仓库访问权限
- 监控系统安全事件
- 保护敏感信息
```

**🔹 命令使用策略**
```
日常使用频率：
🔴 高频：docker system df, docker system info
🟡 中频：docker system prune, docker login
🟢 低频：docker system events, docker version

使用场景：
- 开发环境：重点关注空间清理
- 测试环境：重点关注系统监控  
- 生产环境：重点关注安全和稳定性
```

### 8.3 实际应用指导


**📊 运维操作时机**
```
每日检查：
- docker system df（磁盘使用情况）
- docker system info（系统运行状态）

每周维护：
- docker system prune（清理未使用资源）
- 检查登录状态和权限

问题排查：
- docker system events（监控实时事件）
- docker version（确认版本兼容性）
```

**🎯 最佳实践建议**
- **监控优先**：定期检查系统状态，预防问题发生
- **安全第一**：谨慎使用清理命令，重视权限管理
- **效率平衡**：在系统性能和存储空间之间找到平衡点
- **文档记录**：记录重要的系统管理操作和配置

**核心记忆口诀**：
```
info查状态，df看空间
prune清垃圾，events看动态  
login访仓库，version看信息
系统管理记心间，运维高效保平安
```