---
title: 1ã€å¸¸è§é—®é¢˜è¯Šæ–­
---
## ğŸ“š ç›®å½•

1. [å®¹å™¨å¯åŠ¨å¤±è´¥è¯Šæ–­](#1-å®¹å™¨å¯åŠ¨å¤±è´¥è¯Šæ–­)
2. [é•œåƒæ„å»ºé”™è¯¯å¤„ç†](#2-é•œåƒæ„å»ºé”™è¯¯å¤„ç†)
3. [ç½‘ç»œè¿æ¥é—®é¢˜è§£å†³](#3-ç½‘ç»œè¿æ¥é—®é¢˜è§£å†³)
4. [å­˜å‚¨æŒ‚è½½å¤±è´¥ä¿®å¤](#4-å­˜å‚¨æŒ‚è½½å¤±è´¥ä¿®å¤)
5. [æƒé™é”™è¯¯é—®é¢˜å¤„ç†](#5-æƒé™é”™è¯¯é—®é¢˜å¤„ç†)
6. [ç«¯å£å†²çªå¤„ç†æ–¹æ¡ˆ](#6-ç«¯å£å†²çªå¤„ç†æ–¹æ¡ˆ)
7. [èµ„æºä¸è¶³é—®é¢˜åº”å¯¹](#7-èµ„æºä¸è¶³é—®é¢˜åº”å¯¹)
8. [æ•…éšœæ’æŸ¥å·¥å…·ç®±](#8-æ•…éšœæ’æŸ¥å·¥å…·ç®±)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸš« å®¹å™¨å¯åŠ¨å¤±è´¥è¯Šæ–­


### 1.1 å®¹å™¨å¯åŠ¨å¤±è´¥çš„æœ¬è´¨


**ä»€ä¹ˆæ˜¯å®¹å™¨å¯åŠ¨å¤±è´¥ï¼Ÿ**
å®¹å™¨å¯åŠ¨å¤±è´¥å°±åƒä½ å‡†å¤‡å¼€è½¦ä½†è½¦å­å‘åŠ¨ä¸èµ·æ¥ä¸€æ ·ã€‚Dockeråˆ›å»ºäº†å®¹å™¨ï¼Œä½†æ˜¯å®¹å™¨é‡Œçš„ç¨‹åºæ— æ³•æ­£å¸¸è¿è¡Œï¼Œå¯¼è‡´å®¹å™¨ç«‹å³é€€å‡ºæˆ–æ— æ³•å¯åŠ¨ã€‚

**å®¹å™¨å¯åŠ¨è¿‡ç¨‹å›¾ç¤ºï¼š**
```
Dockerå‘½ä»¤ â†’ åˆ›å»ºå®¹å™¨ â†’ å¯åŠ¨ä¸»è¿›ç¨‹ â†’ è¿›ç¨‹æ­£å¸¸è¿è¡Œ
    â†“           â†“           â†“            â†“
  docker run   å®¹å™¨åˆ›å»º    æ‰§è¡Œå‘½ä»¤      å®¹å™¨è¿è¡Œä¸­
    â†“           â†“           â†“            â†“
   æˆåŠŸ        æˆåŠŸ        å¤±è´¥!        å®¹å™¨é€€å‡º
```

### 1.2 å¯åŠ¨å¤±è´¥çš„ä¸»è¦åŸå› 


**ğŸ”¸ ä¸»è¿›ç¨‹ç«‹å³é€€å‡º**
è¿™æ˜¯æœ€å¸¸è§çš„å¤±è´¥åŸå› ã€‚å®¹å™¨å¯åŠ¨åï¼Œä¸»è¿›ç¨‹é©¬ä¸Šå°±ç»“æŸäº†ï¼Œå®¹å™¨ä¹Ÿå°±åœæ­¢äº†ã€‚

**å…¸å‹åœºæ™¯ï¼š**
- å‘½ä»¤å†™é”™äº†ï¼Œæ¯”å¦‚ `docker run ubuntu ls` - lså‘½ä»¤æ‰§è¡Œå®Œå°±é€€å‡º
- ç¨‹åºé‡åˆ°é”™è¯¯ç«‹å³å´©æºƒ
- é…ç½®æ–‡ä»¶æœ‰é—®é¢˜å¯¼è‡´ç¨‹åºæ— æ³•å¯åŠ¨

**ğŸ”¸ æ‰¾ä¸åˆ°æŒ‡å®šçš„å‘½ä»¤æˆ–æ–‡ä»¶**
å°±åƒä½ åœ¨ç”µè„‘ä¸Šæ‰¾ä¸€ä¸ªä¸å­˜åœ¨çš„ç¨‹åºä¸€æ ·ã€‚

**ğŸ”¸ æƒé™ä¸å¤Ÿ**
ç¨‹åºéœ€è¦æŸäº›æƒé™æ‰èƒ½è¿è¡Œï¼Œä½†å®¹å™¨é‡Œæ²¡æœ‰è¿™äº›æƒé™ã€‚

### 1.3 è¯Šæ–­æ­¥éª¤å’Œæ–¹æ³•


**ğŸ“‹ æ ‡å‡†è¯Šæ–­æµç¨‹ï¼š**

```
æ­¥éª¤1ï¼šæŸ¥çœ‹å®¹å™¨çŠ¶æ€
â†“
æ­¥éª¤2ï¼šæ£€æŸ¥å®¹å™¨æ—¥å¿—  
â†“
æ­¥éª¤3ï¼šè¿›å…¥å®¹å™¨è°ƒè¯•
â†“
æ­¥éª¤4ï¼šæ£€æŸ¥é•œåƒå†…å®¹
```

**âš¡ å¿«é€Ÿè¯Šæ–­å‘½ä»¤ç»„åˆï¼š**

| å‘½ä»¤ | ç”¨é€” | ä½¿ç”¨åœºæ™¯ |
|------|------|----------|
| `docker ps -a` | æŸ¥çœ‹æ‰€æœ‰å®¹å™¨çŠ¶æ€ | ğŸ” äº†è§£å®¹å™¨æ˜¯å¦åˆ›å»ºæˆåŠŸ |
| `docker logs å®¹å™¨å` | æŸ¥çœ‹å®¹å™¨æ—¥å¿— | ğŸ“ æ‰¾å‡ºé”™è¯¯ä¿¡æ¯ |
| `docker exec -it å®¹å™¨å /bin/sh` | è¿›å…¥è¿è¡Œä¸­çš„å®¹å™¨ | ğŸ”§ æ‰‹åŠ¨è°ƒè¯•é—®é¢˜ |
| `docker run --rm -it é•œåƒå /bin/sh` | ä¸´æ—¶å¯åŠ¨å®¹å™¨è°ƒè¯• | ğŸ§ª æµ‹è¯•é•œåƒå†…å®¹ |

**ğŸ’¡ å®æˆ˜è¯Šæ–­ç¤ºä¾‹ï¼š**

å‡è®¾ä½ è¿è¡Œ `docker run --name web nginx` å¤±è´¥äº†ï¼š

```bash
# 1. å…ˆçœ‹å®¹å™¨çŠ¶æ€
docker ps -a
# è¾“å‡ºï¼šCONTAINER ID   IMAGE   COMMAND   CREATED   STATUS
#       abc123       nginx   ...       1 min     Exited (125)

# 2. æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—  
docker logs web
# è¾“å‡ºï¼šdocker: Error response from daemon: Conflict. 
#       The container name "/web" is already in use

# 3. é—®é¢˜åˆ†æï¼šå®¹å™¨åå†²çªäº†ï¼Œä¹‹å‰å·²æœ‰åŒåå®¹å™¨
```

### 1.4 å¸¸è§å¯åŠ¨å¤±è´¥åœºæ™¯


**åœºæ™¯1ï¼šå‘½ä»¤ä¸å­˜åœ¨**
```
âŒ é”™è¯¯ç¤ºä¾‹ï¼š
docker run ubuntu python app.py
# é”™è¯¯ï¼šubuntué•œåƒé‡Œæ²¡è£…python

âœ… æ­£ç¡®åšæ³•ï¼š
docker run python:3.9 python app.py
# ä½¿ç”¨åŒ…å«pythonçš„é•œåƒ
```

**åœºæ™¯2ï¼šç¨‹åºé…ç½®é”™è¯¯**
```
âŒ å¸¸è§é—®é¢˜ï¼š
- æ•°æ®åº“è¿æ¥åœ°å€é”™è¯¯
- é…ç½®æ–‡ä»¶è·¯å¾„ä¸å¯¹  
- ç¯å¢ƒå˜é‡ç¼ºå¤±

âœ… è§£å†³æ€è·¯ï¼š
1. æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®æŒ‚è½½
2. ç¡®è®¤ç¯å¢ƒå˜é‡æ˜¯å¦è®¾ç½®
3. éªŒè¯ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
```

**åœºæ™¯3ï¼šä¾èµ–ç¼ºå¤±**
```
é—®é¢˜è¡¨ç°ï¼š
ç¨‹åºå¯åŠ¨æ—¶æŠ¥é”™"æ‰¾ä¸åˆ°æŸä¸ªåº“"

è§£å†³æ­¥éª¤ï¼š
1. è¿›å…¥å®¹å™¨æ£€æŸ¥ä¾èµ–ï¼šdocker exec -it å®¹å™¨å /bin/sh
2. æ‰‹åŠ¨å®‰è£…ç¼ºå¤±ä¾èµ–
3. é‡æ–°æ„å»ºé•œåƒåŒ…å«æ‰€éœ€ä¾èµ–
```

---

## 2. ğŸ”¨ é•œåƒæ„å»ºé”™è¯¯å¤„ç†


### 2.1 é•œåƒæ„å»ºè¿‡ç¨‹ç†è§£


**æ„å»ºè¿‡ç¨‹å°±åƒç›–æˆ¿å­ï¼š**
```
Dockerfile = å»ºæˆ¿å›¾çº¸
æ¯æ¡æŒ‡ä»¤ = ç›–ä¸€å±‚æ¥¼  
æœ€ç»ˆé•œåƒ = å®Œæ•´æˆ¿å­

FROM ubuntu:20.04     â† æ‰“åœ°åŸº
RUN apt update        â† è£…æ°´ç”µ
COPY app.py /app/     â† è£…ä¿®
CMD ["python", "app.py"] â† å…¥ä½
```

**æ„å»ºå¤±è´¥ = æŸä¸€æ­¥ç›–æˆ¿å¤±è´¥ï¼Œæ•´ä¸ªå·¥ç¨‹åœæ­¢**

### 2.2 æ„å»ºé”™è¯¯åˆ†ç±»


**ğŸš¨ ç½‘ç»œç›¸å…³é”™è¯¯**
è¿™æ˜¯æœ€å¸¸è§çš„æ„å»ºå¤±è´¥åŸå› ï¼Œå°±åƒç›–æˆ¿æ—¶ææ–™è¿ä¸åˆ°å·¥åœ°ã€‚

**å…¸å‹é”™è¯¯ä¿¡æ¯ï¼š**
```
E: Unable to fetch some archives
Could not connect to archive.ubuntu.com
Temporary failure resolving 'registry-1.docker.io'
```

**è§£å†³æ–¹æ¡ˆï¼š**
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- é…ç½®å›½å†…é•œåƒæº
- è®¾ç½®ä»£ç†æˆ–DNS

**ğŸš¨ æŒ‡ä»¤è¯­æ³•é”™è¯¯**
Dockerfileè¯­æ³•å†™é”™äº†ï¼Œå°±åƒå»ºæˆ¿å›¾çº¸ç”»é”™äº†ã€‚

**å¸¸è§è¯­æ³•é”™è¯¯ï¼š**
```
âŒ é”™è¯¯å†™æ³•ï¼š
RUN apt update && 
    apt install python3

âœ… æ­£ç¡®å†™æ³•ï¼š
RUN apt update && \
    apt install python3
# æ³¨æ„è¡Œæœ«çš„åæ–œæ 
```

**ğŸš¨ æ–‡ä»¶è·¯å¾„é”™è¯¯**
è¦å¤åˆ¶çš„æ–‡ä»¶æ‰¾ä¸åˆ°ï¼Œå°±åƒè£…ä¿®ææ–™ä¸¢äº†ã€‚

### 2.3 æ„å»ºé”™è¯¯è°ƒè¯•æŠ€å·§


**ğŸ“Š åˆ†å±‚è°ƒè¯•æ³•**
Dockeræ„å»ºæ˜¯åˆ†å±‚è¿›è¡Œçš„ï¼Œå¯ä»¥é€å±‚æ’æŸ¥é—®é¢˜ï¼š

```bash
# æŸ¥çœ‹æ„å»ºå†å²ï¼Œæ‰¾åˆ°å¤±è´¥çš„å±‚
docker history é•œåƒå

# åŸºäºå¤±è´¥å‰çš„å±‚åˆ›å»ºä¸´æ—¶å®¹å™¨è°ƒè¯•
docker run -it ä¸Šä¸€å±‚é•œåƒID /bin/sh
```

**âš¡ å¢é‡è°ƒè¯•æŠ€å·§ï¼š**

1. **æš‚æ—¶æ³¨é‡Šé—®é¢˜æŒ‡ä»¤**
2. **å…ˆæ„å»ºèƒ½æˆåŠŸçš„éƒ¨åˆ†**  
3. **é€æ­¥æ·»åŠ æœ‰é—®é¢˜çš„æŒ‡ä»¤**
4. **å®šä½å…·ä½“é”™è¯¯åŸå› **

**ğŸ’¡ å®æˆ˜æ¡ˆä¾‹ï¼šPythonåº”ç”¨æ„å»ºå¤±è´¥**

```dockerfile
# åŸå§‹å¤±è´¥çš„Dockerfile
FROM ubuntu:20.04
RUN apt update && apt install python3 python3-pip
COPY requirements.txt .
RUN pip install -r requirements.txt  # è¿™æ­¥å¤±è´¥äº†
COPY app.py .
CMD ["python3", "app.py"]
```

**è°ƒè¯•è¿‡ç¨‹ï¼š**
```bash
# 1. å…ˆæ„å»ºåˆ°å¤±è´¥æ­¥éª¤ä¹‹å‰
FROM ubuntu:20.04  
RUN apt update && apt install python3 python3-pip
COPY requirements.txt .
# æš‚æ—¶æ³¨é‡Šæ‰ï¼š# RUN pip install -r requirements.txt

# 2. æ„å»ºå¹¶è¿›å…¥å®¹å™¨è°ƒè¯•
docker build -t debug-app .
docker run -it debug-app /bin/sh

# 3. åœ¨å®¹å™¨é‡Œæ‰‹åŠ¨æ‰§è¡Œå¤±è´¥çš„å‘½ä»¤
pip install -r requirements.txt
# å‘ç°é”™è¯¯ï¼šæŸä¸ªåŒ…éœ€è¦gccç¼–è¯‘å™¨

# 4. ä¿®æ”¹Dockerfileæ·»åŠ ç¼–è¯‘å·¥å…·
RUN apt update && apt install python3 python3-pip gcc
```

### 2.4 æ„å»ºä¼˜åŒ–æœ€ä½³å®è·µ


**ğŸ”¸ åˆ©ç”¨æ„å»ºç¼“å­˜**
Dockerä¼šç¼“å­˜æ¯ä¸€å±‚ï¼Œä¿®æ”¹æ—¶åªé‡æ–°æ„å»ºå˜åŒ–çš„éƒ¨åˆ†ï¼š

```dockerfile
# ä¼˜åŒ–å‰ï¼šæ”¹ä»£ç è¦é‡è£…æ‰€æœ‰ä¾èµ–
FROM python:3.9
COPY . /app/              # ä»£ç æ”¹äº†ï¼Œè¿™å±‚å˜äº†
WORKDIR /app  
RUN pip install -r requirements.txt  # è¿™å±‚è¦é‡æ–°æ‰§è¡Œ

# ä¼˜åŒ–åï¼šæ”¹ä»£ç ä¸å½±å“ä¾èµ–å®‰è£…
FROM python:3.9
WORKDIR /app
COPY requirements.txt .   # ä¾èµ–æ–‡ä»¶å•ç‹¬å¤åˆ¶
RUN pip install -r requirements.txt  # ä¾èµ–æ²¡å˜ï¼Œä½¿ç”¨ç¼“å­˜
COPY . .                  # ä»£ç æ”¹äº†åªå½±å“è¿™å±‚
```

**ğŸ”¸ å‡å°é•œåƒå¤§å°**
```dockerfile
# å¤šé˜¶æ®µæ„å»ºï¼šç¼–è¯‘å’Œè¿è¡Œåˆ†ç¦»
FROM python:3.9 as builder
COPY requirements.txt .
RUN pip install --user -r requirements.txt

FROM python:3.9-slim    # ä½¿ç”¨æ›´å°çš„åŸºç¡€é•œåƒ
COPY --from=builder /root/.local /root/.local
COPY app.py .
CMD ["python", "app.py"]
```

---

## 3. ğŸŒ ç½‘ç»œè¿æ¥é—®é¢˜è§£å†³


### 3.1 Dockerç½‘ç»œåŸºç¡€ç†è§£


**Dockerç½‘ç»œå°±åƒå°åŒºç½‘ç»œç³»ç»Ÿï¼š**
```
å®¿ä¸»æœº = å°åŒºå¤§é—¨
Dockerç½‘æ¡¥ = å°åŒºå†…éƒ¨ç½‘ç»œ
å®¹å™¨ = å„å®¶å„æˆ·
ç«¯å£æ˜ å°„ = é—¨ç‰Œå·å¯¹åº”å…³ç³»

å¤–ç½‘è®¿é—®å®¹å™¨ï¼š
å¤–ç½‘ â†’ å®¿ä¸»æœºç«¯å£ â†’ å®¹å™¨ç«¯å£
 80  â†’    8080    â†’   80
```

**ç½‘ç»œæ¨¡å¼å¯¹æ¯”ï¼š**

| ç½‘ç»œæ¨¡å¼ | è¯´æ˜ | ä½¿ç”¨åœºæ™¯ | ç‰¹ç‚¹ |
|---------|------|----------|------|
| **bridge** | æ¡¥æ¥æ¨¡å¼ | ğŸ  ä¸€èˆ¬webåº”ç”¨ | å®¹å™¨é—´å¯é€šä¿¡ï¼Œéœ€ç«¯å£æ˜ å°„ |
| **host** | ä¸»æœºæ¨¡å¼ | âš¡ é«˜æ€§èƒ½åº”ç”¨ | ç›´æ¥ä½¿ç”¨å®¿ä¸»æœºç½‘ç»œ |
| **none** | æ— ç½‘ç»œ | ğŸ”’ å®‰å…¨è¦æ±‚é«˜ | å®Œå…¨éš”ç¦»ï¼Œæ— ç½‘ç»œè®¿é—® |

### 3.2 å¸¸è§ç½‘ç»œé—®é¢˜ç±»å‹


**ğŸš« æ— æ³•è®¿é—®å®¹å™¨æœåŠ¡**

**é—®é¢˜ç°è±¡ï¼š**
æµè§ˆå™¨è®¿é—® `http://localhost:8080` æ— æ³•æ‰“å¼€å®¹å™¨é‡Œçš„webæœåŠ¡

**æ’æŸ¥æ€è·¯ï¼š**
```
æ£€æŸ¥æµç¨‹ï¼š
1. å®¹å™¨å†…æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œï¼Ÿ
2. ç«¯å£æ˜ å°„æ˜¯å¦é…ç½®æ­£ç¡®ï¼Ÿ  
3. é˜²ç«å¢™æ˜¯å¦é˜»æŒ¡äº†è®¿é—®ï¼Ÿ
4. æœåŠ¡æ˜¯å¦ç›‘å¬æ­£ç¡®çš„åœ°å€ï¼Ÿ
```

**ğŸ”§ å®æˆ˜æ’æŸ¥æ­¥éª¤ï¼š**

```bash
# 1. æ£€æŸ¥å®¹å™¨è¿è¡ŒçŠ¶æ€
docker ps
# ç¡®è®¤å®¹å™¨åœ¨è¿è¡Œï¼Œç«¯å£æ˜ å°„æ˜¯å¦æ˜¾ç¤º

# 2. æ£€æŸ¥å®¹å™¨å†…æœåŠ¡çŠ¶æ€
docker exec -it å®¹å™¨å /bin/sh
netstat -tlnp  # æŸ¥çœ‹ç›‘å¬ç«¯å£
curl localhost:80  # å®¹å™¨å†…éƒ¨æµ‹è¯•

# 3. æ£€æŸ¥å®¿ä¸»æœºç«¯å£
netstat -tlnp | grep 8080  # ç¡®è®¤ç«¯å£è¢«ç›‘å¬
telnet localhost 8080       # æµ‹è¯•ç«¯å£è¿é€šæ€§

# 4. æ£€æŸ¥é˜²ç«å¢™
sudo ufw status  # Ubuntué˜²ç«å¢™çŠ¶æ€
sudo iptables -L # æŸ¥çœ‹iptablesè§„åˆ™
```

**ğŸš« å®¹å™¨é—´æ— æ³•é€šä¿¡**

**åœºæ™¯ï¼šwebå®¹å™¨è¿æ¥ä¸åˆ°æ•°æ®åº“å®¹å™¨**

**è§£å†³æ–¹æ¡ˆå¯¹æ¯”ï¼š**
```
âŒ é”™è¯¯æ–¹å¼ï¼šä½¿ç”¨å®¹å™¨IP
docker run -d --name db mysql
docker run -d --name web -e DB_HOST=172.17.0.2 webapp
# é—®é¢˜ï¼šå®¹å™¨é‡å¯IPä¼šå˜åŒ–

âœ… æ­£ç¡®æ–¹å¼ï¼šä½¿ç”¨å®¹å™¨åæˆ–è‡ªå®šä¹‰ç½‘ç»œ
docker network create mynet
docker run -d --name db --network mynet mysql  
docker run -d --name web --network mynet -e DB_HOST=db webapp
# ä¼˜ç‚¹ï¼šé€šè¿‡å®¹å™¨åè®¿é—®ï¼Œç¨³å®šå¯é 
```

### 3.3 ç½‘ç»œè°ƒè¯•å·¥å…·ä½¿ç”¨


**ğŸ” åŸºç¡€ç½‘ç»œæ£€æŸ¥å‘½ä»¤ï¼š**

| å‘½ä»¤ | ç”¨é€” | ç¤ºä¾‹ |
|------|------|------|
| `ping` | æµ‹è¯•è¿é€šæ€§ | `ping google.com` |
| `telnet` | æµ‹è¯•ç«¯å£ | `telnet localhost 8080` |
| `netstat` | æŸ¥çœ‹ç½‘ç»œè¿æ¥ | `netstat -tlnp` |
| `curl` | æµ‹è¯•HTTPæœåŠ¡ | `curl http://localhost:8080` |
| `nslookup` | DNSè§£ææµ‹è¯• | `nslookup google.com` |

**ğŸ’¡ ç½‘ç»œé—®é¢˜è¯Šæ–­è„šæœ¬ï¼š**

```bash
#!/bin/bash
# ç½‘ç»œé—®é¢˜å¿«é€Ÿè¯Šæ–­è„šæœ¬

echo "=== Dockerç½‘ç»œè¯Šæ–­ ==="

echo "1. æ£€æŸ¥DockeræœåŠ¡çŠ¶æ€"
systemctl status docker | grep Active

echo "2. æ£€æŸ¥Dockerç½‘ç»œ"
docker network ls

echo "3. æ£€æŸ¥è¿è¡Œä¸­çš„å®¹å™¨"
docker ps --format "table {{.Names}}\t{{.Ports}}\t{{.Status}}"

echo "4. æ£€æŸ¥ç«¯å£å ç”¨"
netstat -tlnp | grep -E ":(80|8080|3000|5432|3306)"

echo "5. æµ‹è¯•DNSè§£æ"
nslookup google.com
```

### 3.4 ç½‘ç»œé…ç½®æœ€ä½³å®è·µ


**ğŸ”¸ è‡ªå®šä¹‰ç½‘ç»œä½¿ç”¨**
```bash
# åˆ›å»ºä¸“ç”¨ç½‘ç»œ
docker network create --driver bridge myapp-net

# å°†å®¹å™¨åŠ å…¥ç½‘ç»œ
docker run -d --name db --network myapp-net postgres
docker run -d --name web --network myapp-net -p 8080:80 nginx
```

**ğŸ”¸ ç«¯å£æ˜ å°„ç­–ç•¥**
```bash
# æ˜ç¡®æŒ‡å®šç«¯å£æ˜ å°„
docker run -p 8080:80 nginx      # å®¿ä¸»æœº8080 â†’ å®¹å™¨80

# åªç›‘å¬æœ¬åœ°æ¥å£ï¼ˆæ›´å®‰å…¨ï¼‰
docker run -p 127.0.0.1:8080:80 nginx  # åªå…è®¸æœ¬åœ°è®¿é—®

# éšæœºç«¯å£æ˜ å°„
docker run -P nginx              # Dockerè‡ªåŠ¨åˆ†é…ç«¯å£
```

---

## 4. ğŸ’¾ å­˜å‚¨æŒ‚è½½å¤±è´¥ä¿®å¤


### 4.1 Dockerå­˜å‚¨æœºåˆ¶ç†è§£


**å­˜å‚¨å°±åƒç§Ÿæˆ¿çš„å‚¨ç‰©è§„åˆ™ï¼š**
```
å®¹å™¨ = ç§Ÿçš„æˆ¿å­ï¼ˆä¸´æ—¶çš„ï¼‰
é•œåƒ = æˆ¿å­çš„åŸºæœ¬è£…ä¿®ï¼ˆåªè¯»çš„ï¼‰  
æ•°æ®å· = ä½ çš„ç§äººç‰©å“ï¼ˆæŒä¹…çš„ï¼‰
æŒ‚è½½ = æŠŠä½ çš„ç‰©å“æ”¾åˆ°æˆ¿å­é‡Œ

æˆ¿å­é€€ç§Ÿäº†ï¼ŒåŸºæœ¬è£…ä¿®è¿˜åœ¨ï¼Œä½ çš„ç‰©å“ä¹Ÿåœ¨
ä½†å¦‚æœæ²¡æœ‰æŒ‚è½½ï¼Œæˆ¿å­é‡Œæ–°æ·»çš„ä¸œè¥¿å°±ä¸¢äº†
```

**å­˜å‚¨ç±»å‹å¯¹æ¯”ï¼š**

| å­˜å‚¨ç±»å‹ | ç”Ÿå‘½å‘¨æœŸ | ä½¿ç”¨åœºæ™¯ | ç‰¹ç‚¹ |
|---------|---------|----------|------|
| **å®¹å™¨æ–‡ä»¶ç³»ç»Ÿ** | éšå®¹å™¨é”€æ¯ | ä¸´æ—¶æ–‡ä»¶ | ğŸ—‘ï¸ å®¹å™¨åˆ é™¤æ•°æ®ä¸¢å¤± |
| **æ•°æ®å·(Volume)** | ç‹¬ç«‹äºå®¹å™¨ | æ•°æ®åº“æ•°æ® | ğŸ’¾ Dockerç®¡ç†ï¼ŒæŒä¹…åŒ– |
| **ç»‘å®šæŒ‚è½½(Bind)** | å®¿ä¸»æœºè·¯å¾„ | é…ç½®æ–‡ä»¶ | ğŸ“ ç›´æ¥è®¿é—®å®¿ä¸»æœºæ–‡ä»¶ |
| **ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿ** | å†…å­˜ä¸­ | ç¼“å­˜æ•°æ® | âš¡ é«˜é€Ÿä½†é‡å¯ä¸¢å¤± |

### 4.2 æŒ‚è½½å¤±è´¥å¸¸è§åŸå› 


**ğŸš« è·¯å¾„ä¸å­˜åœ¨é”™è¯¯**

**é”™è¯¯ç¤ºä¾‹ï¼š**
```bash
docker run -v /not/exist:/app nginx
# é”™è¯¯ï¼šCannot start container: no such file or directory
```

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# 1. ç¡®ä¿å®¿ä¸»æœºè·¯å¾„å­˜åœ¨
mkdir -p /home/user/data

# 2. ä½¿ç”¨æ­£ç¡®è·¯å¾„æŒ‚è½½  
docker run -v /home/user/data:/app nginx

# 3. æˆ–è€…è®©Dockerè‡ªåŠ¨åˆ›å»ºæ•°æ®å·
docker run -v myvolume:/app nginx
```

**ğŸš« æƒé™é—®é¢˜**

**é—®é¢˜ç°è±¡ï¼š**
å®¹å™¨å¯åŠ¨æˆåŠŸï¼Œä½†æ— æ³•å†™å…¥æŒ‚è½½çš„ç›®å½•

**æƒé™æ£€æŸ¥æµç¨‹ï¼š**
```bash
# 1. æ£€æŸ¥å®¿ä¸»æœºç›®å½•æƒé™
ls -la /home/user/data
# è¾“å‡ºï¼šdrwxr-xr-x 2 root root 4096 Jan 20 10:30 data

# 2. æ£€æŸ¥å®¹å™¨å†…ç”¨æˆ·
docker exec -it å®¹å™¨å id
# è¾“å‡ºï¼šuid=1000(app) gid=1000(app)

# 3. æƒé™ä¸åŒ¹é…ï¼å®¿ä¸»æœºæ˜¯rootï¼Œå®¹å™¨æ˜¯appç”¨æˆ·
```

**æƒé™ä¿®å¤æ–¹æ³•ï¼š**
```bash
# æ–¹æ³•1ï¼šä¿®æ”¹å®¿ä¸»æœºç›®å½•æƒé™
sudo chown -R 1000:1000 /home/user/data

# æ–¹æ³•2ï¼šå®¹å™¨å†…åˆ‡æ¢ç”¨æˆ·
docker run --user 1000:1000 -v /home/user/data:/app nginx

# æ–¹æ³•3ï¼šä½¿ç”¨æ•°æ®å·ï¼ˆæ¨èï¼‰
docker run -v mydata:/app nginx  # Dockerè‡ªåŠ¨å¤„ç†æƒé™
```

### 4.3 å­˜å‚¨é—®é¢˜è¯Šæ–­æŠ€å·§


**ğŸ“‹ å­˜å‚¨é—®é¢˜æ£€æŸ¥æ¸…å•ï¼š**

```
â˜ æŒ‚è½½è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼Ÿ
â˜ å®¿ä¸»æœºç›®å½•æ˜¯å¦å­˜åœ¨ï¼Ÿ
â˜ æƒé™è®¾ç½®æ˜¯å¦æ­£ç¡®ï¼Ÿ
â˜ å®¹å™¨å†…è·¯å¾„æ˜¯å¦å†²çªï¼Ÿ
â˜ ç£ç›˜ç©ºé—´æ˜¯å¦å……è¶³ï¼Ÿ
â˜ SELinuxæ˜¯å¦å½±å“è®¿é—®ï¼Ÿ
```

**ğŸ” å®æˆ˜è¯Šæ–­ç¤ºä¾‹ï¼š**

```bash
# é—®é¢˜ï¼šæ•°æ®åº“å®¹å™¨æ•°æ®æ— æ³•æŒä¹…åŒ–
docker run --name mydb -v /var/lib/mysql mysql

# è¯Šæ–­æ­¥éª¤ï¼š
# 1. æ£€æŸ¥æŒ‚è½½æ˜¯å¦ç”Ÿæ•ˆ
docker inspect mydb | grep -A 10 Mounts
# æŸ¥çœ‹æŒ‚è½½é…ç½®

# 2. è¿›å…¥å®¹å™¨æ£€æŸ¥
docker exec -it mydb /bin/bash
ls -la /var/lib/mysql
# æ£€æŸ¥ç›®å½•å†…å®¹å’Œæƒé™

# 3. æ£€æŸ¥å®¿ä¸»æœºå¯¹åº”ç›®å½•
ls -la /var/lib/docker/volumes/xxx/_data
# æŸ¥çœ‹å®é™…å­˜å‚¨ä½ç½®

# 4. æµ‹è¯•è¯»å†™æƒé™
docker exec -it mydb touch /var/lib/mysql/test.txt
# æµ‹è¯•æ˜¯å¦èƒ½åˆ›å»ºæ–‡ä»¶
```

### 4.4 å­˜å‚¨æœ€ä½³å®è·µ


**ğŸ”¸ æ•°æ®æŒä¹…åŒ–ç­–ç•¥**
```bash
# æ•°æ®åº“ç­‰æœ‰çŠ¶æ€æœåŠ¡
docker run -d --name postgres \
  -v pgdata:/var/lib/postgresql/data \
  postgres:13

# é…ç½®æ–‡ä»¶æŒ‚è½½
docker run -d --name nginx \
  -v $(pwd)/nginx.conf:/etc/nginx/nginx.conf:ro \
  -v $(pwd)/html:/usr/share/nginx/html \
  nginx

# æ—¥å¿—ç›®å½•æŒ‚è½½
docker run -d --name app \
  -v $(pwd)/logs:/app/logs \
  myapp:latest
```

**ğŸ”¸ æŒ‚è½½å®‰å…¨æ³¨æ„äº‹é¡¹**
```bash
# âŒ å±é™©ï¼šæŒ‚è½½æ•æ„Ÿç³»ç»Ÿç›®å½•
docker run -v /:/host ubuntu  # å¯è®¿é—®æ•´ä¸ªå®¿ä¸»æœº

# âœ… å®‰å…¨ï¼šåªè¯»æŒ‚è½½
docker run -v $(pwd)/config:/app/config:ro nginx

# âœ… å®‰å…¨ï¼šé™åˆ¶æŒ‚è½½èŒƒå›´
docker run -v $(pwd)/data:/app/data nginx  # åªæŒ‚è½½éœ€è¦çš„ç›®å½•
```

---

## 5. ğŸ” æƒé™é”™è¯¯é—®é¢˜å¤„ç†


### 5.1 Dockeræƒé™æ¨¡å‹ç†è§£


**Dockeræƒé™å°±åƒå…¬å¸çš„é—¨ç¦ç³»ç»Ÿï¼š**
```
Dockerå®ˆæŠ¤è¿›ç¨‹ = å®‰ä¿ä¸»ç®¡ï¼ˆéœ€è¦rootæƒé™ï¼‰
Dockerå®¢æˆ·ç«¯ = å‘˜å·¥ï¼ˆéœ€è¦é€šè¡Œè¯ï¼‰
å®¹å™¨ = å„ä¸ªåŠå…¬å®¤ï¼ˆæœ‰ä¸åŒçš„è®¿é—®æƒé™ï¼‰
æ–‡ä»¶æƒé™ = åŠå…¬èµ„æ–™çš„è®¿é—®è§„åˆ™

æ™®é€šå‘˜å·¥æƒ³è¿›åŠå…¬å®¤ï¼Œéœ€è¦ï¼š
1. é€šè¡Œè¯ï¼ˆdockerç»„æƒé™ï¼‰
2. åŠå…¬å®¤é’¥åŒ™ï¼ˆå®¹å™¨æƒé™ï¼‰
3. èµ„æ–™è®¿é—®æƒï¼ˆæ–‡ä»¶æƒé™ï¼‰
```

**æƒé™å±‚æ¬¡ç»“æ„ï¼š**
```
ç³»ç»Ÿå±‚é¢ï¼šDocker daemonæƒé™
 â”œâ”€â”€ Dockerç»„æƒé™ï¼ˆdocker groupï¼‰
 â””â”€â”€ sudoæƒé™ï¼ˆroot accessï¼‰

å®¹å™¨å±‚é¢ï¼šç”¨æˆ·æ˜ å°„
 â”œâ”€â”€ å®¹å™¨å†…ç”¨æˆ·IDï¼ˆUIDï¼‰
 â””â”€â”€ å®¹å™¨å†…ç”¨æˆ·ç»„ï¼ˆGIDï¼‰

æ–‡ä»¶å±‚é¢ï¼šæ–‡ä»¶æƒé™
 â”œâ”€â”€ æ‰€æœ‰è€…æƒé™ï¼ˆownerï¼‰
 â”œâ”€â”€ ç”¨æˆ·ç»„æƒé™ï¼ˆgroupï¼‰  
 â””â”€â”€ å…¶ä»–ç”¨æˆ·æƒé™ï¼ˆotherï¼‰
```

### 5.2 æƒé™é”™è¯¯ç±»å‹åˆ†æ


**ğŸš« Dockerå‘½ä»¤æƒé™ä¸è¶³**

**é”™è¯¯ç°è±¡ï¼š**
```bash
docker run hello-world
# è¾“å‡ºï¼šGot permission denied while trying to connect to Docker daemon
```

**é—®é¢˜åŸå› ï¼š**
å½“å‰ç”¨æˆ·ä¸åœ¨dockerç»„ä¸­ï¼Œæ— æ³•è®¿é—®Docker socket

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# æ–¹æ³•1ï¼šå°†ç”¨æˆ·æ·»åŠ åˆ°dockerç»„ï¼ˆæ¨èï¼‰
sudo usermod -aG docker $USER
# é‡æ–°ç™»å½•ç”Ÿæ•ˆ

# æ–¹æ³•2ï¼šä½¿ç”¨sudoï¼ˆä¸´æ—¶æ–¹æ¡ˆï¼‰
sudo docker run hello-world

# éªŒè¯æƒé™
groups $USER  # åº”è¯¥çœ‹åˆ°dockerç»„
```

**ğŸš« å®¹å™¨å†…æ–‡ä»¶æƒé™é”™è¯¯**

**åœºæ™¯ï¼šWebåº”ç”¨æ— æ³•å†™å…¥æ—¥å¿—æ–‡ä»¶**
```bash
docker run -d --name webapp \
  -v $(pwd)/logs:/app/logs \
  mywebapp
  
# å®¹å™¨å¯åŠ¨å¤±è´¥ï¼Œæ—¥å¿—æ˜¾ç¤ºï¼š
# Permission denied: cannot write to /app/logs/app.log
```

**æƒé™åˆ†æè¿‡ç¨‹ï¼š**
```bash
# 1. æ£€æŸ¥å®¿ä¸»æœºç›®å½•æƒé™
ls -la logs/
# è¾“å‡ºï¼šdrwxr-xr-x 2 root root 4096 logs/

# 2. æ£€æŸ¥å®¹å™¨å†…è¿è¡Œç”¨æˆ·
docker run --rm mywebapp id  
# è¾“å‡ºï¼šuid=1000(www) gid=1000(www)

# 3. æƒé™å†²çªï¼šå®¿ä¸»æœºrootæ‹¥æœ‰ï¼Œå®¹å™¨wwwç”¨æˆ·æ— å†™æƒé™
```

### 5.3 æƒé™é—®é¢˜è§£å†³æ–¹æ¡ˆ


**ğŸ”§ ç”¨æˆ·IDæ˜ å°„æ–¹æ¡ˆ**

```bash
# æ–¹æ¡ˆ1ï¼šä¿®æ”¹å®¿ä¸»æœºç›®å½•æƒé™
sudo chown -R 1000:1000 logs/  # æ”¹ä¸ºå®¹å™¨ç”¨æˆ·æ‰€æœ‰

# æ–¹æ¡ˆ2ï¼šè¿è¡Œæ—¶æŒ‡å®šç”¨æˆ·
docker run --user 1000:1000 -v $(pwd)/logs:/app/logs mywebapp

# æ–¹æ¡ˆ3ï¼šä½¿ç”¨å½“å‰ç”¨æˆ·æƒé™
docker run --user $(id -u):$(id -g) -v $(pwd)/logs:/app/logs mywebapp
```

**ğŸ”§ Dockerfileä¸­å¤„ç†æƒé™**

```dockerfile
# åˆ›å»ºérootç”¨æˆ·è¿è¡Œåº”ç”¨
FROM ubuntu:20.04
RUN useradd -m -u 1000 appuser
USER appuser
WORKDIR /home/appuser/app
COPY --chown=appuser:appuser . .
CMD ["python", "app.py"]
```

**ğŸ”§ SELinuxæƒé™é—®é¢˜**

åœ¨CentOS/RHELç³»ç»Ÿä¸Šï¼ŒSELinuxå¯èƒ½é˜»æ­¢å®¹å™¨è®¿é—®æŒ‚è½½æ–‡ä»¶ï¼š

```bash
# æ£€æŸ¥SELinuxçŠ¶æ€
getenforce
# è¾“å‡ºï¼šEnforcing

# æŸ¥çœ‹SELinuxé”™è¯¯æ—¥å¿—
ausearch -m avc -ts recent | grep docker

# è§£å†³æ–¹æ¡ˆï¼šæ·»åŠ SELinuxæ ‡ç­¾
docker run -v $(pwd)/data:/app/data:Z myapp  # :Zè¡¨ç¤ºç§æœ‰æ ‡ç­¾
docker run -v $(pwd)/data:/app/data:z myapp  # :zè¡¨ç¤ºå…±äº«æ ‡ç­¾
```

### 5.4 æƒé™å®‰å…¨æœ€ä½³å®è·µ


**ğŸ”¸ æœ€å°æƒé™åŸåˆ™**
```dockerfile
# âŒ ä¸å®‰å…¨ï¼šä½¿ç”¨rootç”¨æˆ·
FROM nginx
COPY . /usr/share/nginx/html

# âœ… å®‰å…¨ï¼šä½¿ç”¨éç‰¹æƒç”¨æˆ·
FROM nginx
RUN adduser --disabled-password --gecos "" appuser
USER appuser
COPY --chown=appuser . /home/appuser/app
```

**ğŸ”¸ é¿å…ç‰¹æƒå®¹å™¨**
```bash
# âŒ å±é™©ï¼šç‰¹æƒæ¨¡å¼å¯è®¿é—®å®¿ä¸»æœºæ‰€æœ‰èµ„æº
docker run --privileged myapp

# âœ… å®‰å…¨ï¼šåªæˆäºˆå¿…è¦çš„capabilities
docker run --cap-add=NET_ADMIN myapp  # åªæ·»åŠ ç½‘ç»œç®¡ç†æƒé™
```

**æƒé™é—®é¢˜å¿«é€Ÿè¯Šæ–­è„šæœ¬ï¼š**
```bash
#!/bin/bash
echo "=== Dockeræƒé™è¯Šæ–­ ==="

echo "1. å½“å‰ç”¨æˆ·dockeræƒé™ï¼š"
groups $USER | grep -q docker && echo "âœ… æœ‰dockerç»„æƒé™" || echo "âŒ æ— dockerç»„æƒé™"

echo "2. DockeræœåŠ¡çŠ¶æ€ï¼š"
systemctl is-active docker

echo "3. æµ‹è¯•Dockerå‘½ä»¤ï¼š"
docker version >/dev/null 2>&1 && echo "âœ… Dockerå‘½ä»¤æ­£å¸¸" || echo "âŒ Dockerå‘½ä»¤å¤±è´¥"

echo "4. å½“å‰ç”¨æˆ·UID/GIDï¼š"
echo "UID: $(id -u), GID: $(id -g)"
```

---

## 6. ğŸ”Œ ç«¯å£å†²çªå¤„ç†æ–¹æ¡ˆ


### 6.1 ç«¯å£å†²çªæœºåˆ¶ç†è§£


**ç«¯å£å°±åƒåœè½¦ä½ï¼š**
```
å®¿ä¸»æœºç«¯å£ = åœè½¦åœºè½¦ä½å·
å®¹å™¨ç«¯å£ = è½¦å†…åº§ä½å·
ç«¯å£æ˜ å°„ = è½¦ä½å·å’Œåº§ä½å·çš„å¯¹åº”å…³ç³»

å†²çªæƒ…å†µï¼š
ä¸¤è¾†è½¦(å®¹å™¨)éƒ½æƒ³åœåŒä¸€ä¸ªè½¦ä½(å®¿ä¸»æœºç«¯å£)
```

**ç«¯å£æ˜ å°„åŸç†å›¾ï¼š**
```
å¤–éƒ¨è®¿é—®                 å®¿ä¸»æœº                   å®¹å™¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æµè§ˆå™¨    â”‚ --------> â”‚ ç«¯å£8080   â”‚ --------> â”‚ ç«¯å£80   â”‚
â”‚è®¿é—®:8080 â”‚           â”‚(iptables)  â”‚           â”‚(nginx)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 ç«¯å£å†²çªåœºæ™¯åˆ†æ


**ğŸš« å…¸å‹å†²çªåœºæ™¯**

**åœºæ™¯1ï¼šå¤šä¸ªå®¹å™¨ä½¿ç”¨ç›¸åŒç«¯å£**
```bash
# ç¬¬ä¸€ä¸ªå®¹å™¨å¯åŠ¨æˆåŠŸ
docker run -d --name web1 -p 8080:80 nginx

# ç¬¬äºŒä¸ªå®¹å™¨å¯åŠ¨å¤±è´¥
docker run -d --name web2 -p 8080:80 nginx
# é”™è¯¯ï¼šbind: address already in use
```

**åœºæ™¯2ï¼šå®¿ä¸»æœºæœåŠ¡å ç”¨ç«¯å£**
```bash
# å®¿ä¸»æœºå·²æœ‰nginxæœåŠ¡è¿è¡Œåœ¨80ç«¯å£
systemctl status nginx  # æ˜¾ç¤ºactive

# å®¹å™¨å¯åŠ¨å¤±è´¥
docker run -p 80:80 nginx  
# é”™è¯¯ï¼šbind: address already in use
```

**åœºæ™¯3ï¼šç³»ç»ŸæœåŠ¡å ç”¨ç«¯å£**
```bash
# SSHæœåŠ¡å ç”¨22ç«¯å£
docker run -p 22:22 myssh
# å†²çªï¼šç³»ç»ŸSSHæœåŠ¡å·²ä½¿ç”¨22ç«¯å£
```

### 6.3 å†²çªæ£€æµ‹å’Œè¯Šæ–­


**ğŸ” ç«¯å£å ç”¨æ£€æŸ¥æ–¹æ³•ï¼š**

```bash
# æ–¹æ³•1ï¼šnetstatæ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep :8080
# è¾“å‡ºï¼štcp 0 0 0.0.0.0:8080 0.0.0.0:* LISTEN 12345/nginx

# æ–¹æ³•2ï¼šsså‘½ä»¤æ£€æŸ¥ï¼ˆæ›´ç°ä»£ï¼‰
ss -tlnp | grep :8080

# æ–¹æ³•3ï¼šlsofæ£€æŸ¥ç«¯å£
lsof -i :8080
# è¾“å‡ºï¼šnginx 12345 root 6u IPv4 socket TCP *:8080 (LISTEN)

# æ–¹æ³•4ï¼šæ£€æŸ¥Dockerå®¹å™¨ç«¯å£ä½¿ç”¨
docker ps --format "table {{.Names}}\t{{.Ports}}"
```

**âš¡ ç«¯å£å†²çªå¿«é€Ÿè¯Šæ–­è„šæœ¬ï¼š**
```bash
#!/bin/bash
PORT=$1
if [ -z "$PORT" ]; then
    echo "ç”¨æ³•: $0 <ç«¯å£å·>"
    exit 1
fi

echo "=== ç«¯å£ $PORT å ç”¨æƒ…å†µ ==="

echo "1. ç³»ç»Ÿè¿›ç¨‹å ç”¨ï¼š"
netstat -tlnp | grep ":$PORT "

echo "2. Dockerå®¹å™¨å ç”¨ï¼š"
docker ps --format "table {{.Names}}\t{{.Ports}}" | grep ":$PORT->"

echo "3. å»ºè®®çš„ç©ºé—²ç«¯å£ï¼š"
for i in {8081..8090}; do
    if ! netstat -tln | grep -q ":$i "; then
        echo "ç«¯å£ $i å¯ç”¨"
        break
    fi
done
```

### 6.4 å†²çªè§£å†³ç­–ç•¥


**ğŸ”§ è§£å†³æ–¹æ¡ˆå¯¹æ¯”ï¼š**

| è§£å†³æ–¹æ¡ˆ | é€‚ç”¨åœºæ™¯ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|---------|---------|------|------|
| **æ›´æ¢ç«¯å£** | å¼€å‘æµ‹è¯• | âœ… ç®€å•å¿«é€Ÿ | âŒ å¯èƒ½éœ€è¦ä¿®æ”¹é…ç½® |
| **åœæ­¢å†²çªæœåŠ¡** | æ›¿æ¢æ—§æœåŠ¡ | âœ… ä½¿ç”¨æ ‡å‡†ç«¯å£ | âŒ å½±å“ç°æœ‰æœåŠ¡ |
| **ä½¿ç”¨éšæœºç«¯å£** | å†…éƒ¨æœåŠ¡ | âœ… è‡ªåŠ¨é¿å…å†²çª | âŒ ç«¯å£ä¸å›ºå®š |
| **ç«¯å£èŒƒå›´æ˜ å°„** | å¾®æœåŠ¡é›†ç¾¤ | âœ… æ‰¹é‡å¤„ç† | âŒ ç®¡ç†å¤æ‚ |

**ğŸ”§ å®é™…è§£å†³ç¤ºä¾‹ï¼š**

```bash
# é—®é¢˜ï¼šå¯åŠ¨ç¬¬äºŒä¸ªnginxå®¹å™¨
docker run -d --name web2 -p 8080:80 nginx  # ç«¯å£å†²çª

# è§£å†³æ–¹æ¡ˆ1ï¼šä½¿ç”¨ä¸åŒç«¯å£
docker run -d --name web2 -p 8081:80 nginx

# è§£å†³æ–¹æ¡ˆ2ï¼šè®©Dockerè‡ªåŠ¨åˆ†é…ç«¯å£
docker run -d --name web2 -P nginx
docker port web2  # æŸ¥çœ‹è‡ªåŠ¨åˆ†é…çš„ç«¯å£

# è§£å†³æ–¹æ¡ˆ3ï¼šåœæ­¢å†²çªå®¹å™¨åé‡å¯
docker stop web1
docker run -d --name web2 -p 8080:80 nginx
```

**ğŸ”§ é«˜çº§è§£å†³æ–¹æ¡ˆï¼šåå‘ä»£ç†**

å½“å¤šä¸ªæœåŠ¡éƒ½éœ€è¦ä½¿ç”¨80ç«¯å£æ—¶ï¼š
```bash
# 1. å¯åŠ¨å¤šä¸ªæœåŠ¡åœ¨ä¸åŒç«¯å£
docker run -d --name app1 -p 8001:80 webapp1
docker run -d --name app2 -p 8002:80 webapp2

# 2. ä½¿ç”¨nginxä½œä¸ºåå‘ä»£ç†
cat > nginx.conf << EOF
server {
    listen 80;
    server_name app1.example.com;
    location / {
        proxy_pass http://localhost:8001;
    }
}
server {
    listen 80;
    server_name app2.example.com;  
    location / {
        proxy_pass http://localhost:8002;
    }
}
EOF

# 3. å¯åŠ¨ä»£ç†æœåŠ¡
docker run -d --name proxy \
  -p 80:80 \
  -v $(pwd)/nginx.conf:/etc/nginx/conf.d/default.conf \
  nginx
```

---

## 7. ğŸ’½ èµ„æºä¸è¶³é—®é¢˜åº”å¯¹


### 7.1 Dockerèµ„æºé™åˆ¶æœºåˆ¶


**èµ„æºå°±åƒç§Ÿæˆ¿çš„æ°´ç”µæ°”é…é¢ï¼š**
```
CPU = ç”µåŠ›ä¾›åº”ï¼ˆå¤„ç†èƒ½åŠ›ï¼‰
å†…å­˜ = æ°´å‹ä¾›åº”ï¼ˆå­˜å‚¨ç©ºé—´ï¼‰
ç£ç›˜ = ç‡ƒæ°”ä¾›åº”ï¼ˆå­˜å‚¨å®¹é‡ï¼‰
ç½‘ç»œ = å®½å¸¦æµé‡ï¼ˆä¼ è¾“èƒ½åŠ›ï¼‰

è¶…å‡ºé…é¢ = æœåŠ¡ä¸­æ–­æˆ–æ€§èƒ½ä¸‹é™
åˆç†åˆ†é… = æ‰€æœ‰ç§Ÿæˆ·æ­£å¸¸ä½¿ç”¨
```

**Dockerèµ„æºæ§åˆ¶æ¶æ„ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            å®¿ä¸»æœºèµ„æº                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å®¹å™¨Aèµ„æºé™åˆ¶  â”‚    å®¹å™¨Bèµ„æºé™åˆ¶   â”‚
â”‚   CPU: 1æ ¸      â”‚    CPU: 2æ ¸       â”‚
â”‚   å†…å­˜: 512MB   â”‚    å†…å­˜: 1GB      â”‚  
â”‚   ç£ç›˜: 10GB    â”‚    ç£ç›˜: 20GB     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 èµ„æºä¸è¶³é—®é¢˜ç±»å‹


**ğŸš« å†…å­˜ä¸è¶³é—®é¢˜**

**é—®é¢˜ç°è±¡ï¼š**
```bash
# å®¹å™¨å¯åŠ¨å¤±è´¥æˆ–è¢«å¼ºåˆ¶ç»ˆæ­¢
docker logs myapp
# è¾“å‡ºï¼šKilled (ç¨‹åºè¢«OOMæ€æ­»)

# ç³»ç»Ÿæ—¥å¿—æ˜¾ç¤ºå†…å­˜ä¸è¶³
dmesg | grep -i "killed process"
# è¾“å‡ºï¼šOut of memory: Kill process 1234 (java) score 1000
```

**ğŸš« ç£ç›˜ç©ºé—´ä¸è¶³**

**é—®é¢˜è¡¨ç°ï¼š**
```bash
docker build -t myapp .
# é”™è¯¯ï¼šno space left on device

docker run myapp  
# é”™è¯¯ï¼šError response from daemon: mkdir: no space left on device
```

**ğŸš« CPUèµ„æºç«äº‰**

**æ€§èƒ½ä¸‹é™ç°è±¡ï¼š**
- åº”ç”¨å“åº”å˜æ…¢
- å®¹å™¨å¯åŠ¨æ—¶é—´å»¶é•¿
- ç³»ç»Ÿæ•´ä½“å¡é¡¿

### 7.3 èµ„æºç›‘æ§å’Œè¯Šæ–­


**ğŸ“Š èµ„æºä½¿ç”¨ç›‘æ§å‘½ä»¤ï¼š**

```bash
# 1. ç³»ç»Ÿæ•´ä½“èµ„æºä½¿ç”¨
free -h          # å†…å­˜ä½¿ç”¨æƒ…å†µ
df -h           # ç£ç›˜ä½¿ç”¨æƒ…å†µ  
top             # CPUå’Œå†…å­˜å®æ—¶ç›‘æ§

# 2. Dockerèµ„æºä½¿ç”¨
docker system df              # Dockerç©ºé—´ä½¿ç”¨æ¦‚å†µ
docker stats                 # å®¹å™¨å®æ—¶èµ„æºä½¿ç”¨
docker stats --no-stream     # è·å–ä¸€æ¬¡æ€§æ•°æ®

# 3. ç‰¹å®šå®¹å™¨èµ„æºç›‘æ§
docker stats å®¹å™¨å
# è¾“å‡ºï¼šCONTAINER CPU % MEM USAGE/LIMIT MEM % NET I/O BLOCK I/O
```

**ğŸ” èµ„æºé—®é¢˜è¯Šæ–­æ­¥éª¤ï¼š**

```bash
# è¯Šæ–­è„šæœ¬ç¤ºä¾‹
#!/bin/bash
echo "=== Dockerèµ„æºè¯Šæ–­ ==="

echo "1. ç³»ç»Ÿèµ„æºæ¦‚å†µï¼š"
echo "å†…å­˜ä½¿ç”¨: $(free -h | awk 'NR==2{print $3"/"$2" ("$3/$2*100"%)"}')"
echo "ç£ç›˜ä½¿ç”¨: $(df -h / | awk 'NR==2{print $5}')"
echo "CPUæ ¸æ•°: $(nproc)"

echo "2. Dockerèµ„æºä½¿ç”¨ï¼š"
docker system df

echo "3. è¿è¡Œä¸­å®¹å™¨èµ„æºï¼š"
docker stats --no-stream --format "table {{.Container}}\t{{.CPUPerc}}\t{{.MemUsage}}"

echo "4. å¤§å®¹å™¨è¯†åˆ«ï¼š"
docker ps -s --format "table {{.Names}}\t{{.Size}}" | sort -k2 -hr | head -5
```

### 7.4 èµ„æºä¼˜åŒ–ç­–ç•¥


**ğŸ”§ å†…å­˜ä¼˜åŒ–æ–¹æ¡ˆ**

```bash
# 1. è®¾ç½®å†…å­˜é™åˆ¶
docker run -m 512m myapp  # é™åˆ¶512MBå†…å­˜

# 2. æ¸…ç†ä¸å¿…è¦çš„é•œåƒå’Œå®¹å™¨
docker system prune -a    # æ¸…ç†æ‰€æœ‰æœªä½¿ç”¨èµ„æº
docker image prune        # æ¸…ç†æ‚¬ç©ºé•œåƒ
docker container prune    # æ¸…ç†åœæ­¢çš„å®¹å™¨

# 3. ä¼˜åŒ–åº”ç”¨å†…å­˜ä½¿ç”¨
# Javaåº”ç”¨ç¤ºä¾‹
docker run -e JAVA_OPTS="-Xmx256m -Xms128m" myapp
```

**ğŸ”§ ç£ç›˜ç©ºé—´ä¼˜åŒ–**

```bash
# 1. æ¸…ç†Dockeræ•°æ®
docker system df          # æŸ¥çœ‹ç©ºé—´ä½¿ç”¨
docker system prune -a    # æ¸…ç†æœªä½¿ç”¨èµ„æº

# 2. ä½¿ç”¨å¤šé˜¶æ®µæ„å»ºå‡å°é•œåƒ
dockerfile
FROM node:16 as builder
COPY package.json .
RUN npm install
COPY . .
RUN npm run build

FROM nginx:alpine         # ä½¿ç”¨æ›´å°çš„åŸºç¡€é•œåƒ
COPY --from=builder /app/dist /usr/share/nginx/html
```

**ğŸ”§ CPUæ€§èƒ½ä¼˜åŒ–**

```bash
# 1. é™åˆ¶CPUä½¿ç”¨
docker run --cpus="1.5" myapp     # é™åˆ¶ä½¿ç”¨1.5ä¸ªCPUæ ¸å¿ƒ
docker run --cpu-shares=512 myapp # è®¾ç½®CPUæƒé‡

# 2. ç›‘æ§CPUå¯†é›†å‹å®¹å™¨
docker stats | grep "100.00%"    # æ‰¾å‡ºCPUä½¿ç”¨ç‡é«˜çš„å®¹å™¨

# 3. è´Ÿè½½å‡è¡¡
# ä½¿ç”¨å¤šä¸ªå®¹å™¨å®ä¾‹åˆ†æ‹…è´Ÿè½½
docker run -d --name app1 myapp
docker run -d --name app2 myapp  
docker run -d --name app3 myapp
```

**ğŸ’¡ èµ„æºé…é¢æœ€ä½³å®è·µï¼š**

| åº”ç”¨ç±»å‹ | CPUé…é¢ | å†…å­˜é…é¢ | ç£ç›˜é…é¢ | è¯´æ˜ |
|---------|---------|---------|---------|------|
| **Webå‰ç«¯** | 0.5æ ¸ | 256MB | 1GB | ğŸŒ é™æ€èµ„æºæœåŠ¡ |
| **APIæœåŠ¡** | 1-2æ ¸ | 1-2GB | 5GB | âš¡ ä¸šåŠ¡é€»è¾‘å¤„ç† |
| **æ•°æ®åº“** | 2-4æ ¸ | 4-8GB | 50GB+ | ğŸ’¾ æ•°æ®å¯†é›†å‹ |
| **å¤§æ•°æ®å¤„ç†** | 4-8æ ¸ | 8-16GB | 100GB+ | ğŸ”¥ è®¡ç®—å¯†é›†å‹ |

---

## 8. ğŸ§° æ•…éšœæ’æŸ¥å·¥å…·ç®±


### 8.1 Dockerå†…ç½®è°ƒè¯•å·¥å…·


**ğŸ”§ åŸºç¡€è°ƒè¯•å‘½ä»¤å¥—è£…ï¼š**

```bash
# å®¹å™¨çŠ¶æ€æ£€æŸ¥å¥—ä»¶
alias dps='docker ps -a --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"'
alias dlogs='docker logs --tail 50 -f'
alias dexec='docker exec -it'
alias dinspect='docker inspect --format="{{json .State}}" | jq'

# å¿«é€Ÿè¿›å…¥å®¹å™¨è°ƒè¯•
debug_container() {
    local container=$1
    docker exec -it $container /bin/sh 2>/dev/null || \
    docker exec -it $container /bin/bash 2>/dev/null || \
    echo "æ— æ³•è¿›å…¥å®¹å™¨ $container"
}
```

**ğŸ“Š ç³»ç»Ÿä¿¡æ¯æ”¶é›†è„šæœ¬ï¼š**

```bash
#!/bin/bash
# Dockeræ•…éšœä¿¡æ¯æ”¶é›†å™¨
collect_docker_info() {
    echo "=== Dockerç¯å¢ƒä¿¡æ¯æ”¶é›† ==="
    echo "æ—¶é—´: $(date)"
    echo "ç”¨æˆ·: $(whoami)"
    
    echo -e "\n1. Dockerç‰ˆæœ¬ä¿¡æ¯:"
    docker version
    
    echo -e "\n2. ç³»ç»Ÿèµ„æºçŠ¶æ€:"
    free -h
    df -h
    
    echo -e "\n3. DockeræœåŠ¡çŠ¶æ€:"
    systemctl status docker --no-pager
    
    echo -e "\n4. è¿è¡Œä¸­çš„å®¹å™¨:"
    docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}\t{{.Image}}"
    
    echo -e "\n5. Dockerç½‘ç»œ:"
    docker network ls
    
    echo -e "\n6. Dockerå·:"
    docker volume ls
    
    echo -e "\n7. Dockeré•œåƒ:"
    docker images --format "table {{.Repository}}\t{{.Tag}}\t{{.Size}}"
    
    echo -e "\n8. Dockerèµ„æºä½¿ç”¨:"
    docker system df
}

# ä½¿ç”¨ï¼šcollect_docker_info > docker_debug_$(date +%Y%m%d_%H%M%S).log
```

### 8.2 æ—¥å¿—åˆ†æå·¥å…·


**ğŸ“ æ—¥å¿—æŸ¥çœ‹å¢å¼ºå‘½ä»¤ï¼š**

```bash
# æ™ºèƒ½æ—¥å¿—æŸ¥çœ‹å™¨
smart_logs() {
    local container=$1
    local lines=${2:-50}
    
    echo "=== $container å®¹å™¨æ—¥å¿—åˆ†æ ==="
    echo "æœ€è¿‘ $lines è¡Œæ—¥å¿—:"
    docker logs --tail $lines $container
    
    echo -e "\né”™è¯¯æ—¥å¿—è¿‡æ»¤:"
    docker logs $container 2>&1 | grep -i "error\|exception\|fail" | tail -10
    
    echo -e "\nè­¦å‘Šæ—¥å¿—è¿‡æ»¤:"  
    docker logs $container 2>&1 | grep -i "warn" | tail -5
}

# å®æ—¶æ—¥å¿—ç›‘æ§
live_logs() {
    local container=$1
    echo "å®æ—¶ç›‘æ§ $container æ—¥å¿— (Ctrl+C é€€å‡º):"
    docker logs -f --tail 20 $container | while read line; do
        if echo "$line" | grep -qi "error\|exception"; then
            echo -e "\033[31m[ERROR] $line\033[0m"  # çº¢è‰²æ˜¾ç¤ºé”™è¯¯
        elif echo "$line" | grep -qi "warn"; then
            echo -e "\033[33m[WARN] $line\033[0m"   # é»„è‰²æ˜¾ç¤ºè­¦å‘Š
        else
            echo "$line"
        fi
    done
}
```

### 8.3 ç½‘ç»œè¯Šæ–­å·¥å…·åŒ…


**ğŸŒ ç½‘ç»œé—®é¢˜è¯Šæ–­å¥—ä»¶ï¼š**

```bash
# ç½‘ç»œè¿é€šæ€§æµ‹è¯•
test_network() {
    local container=$1
    local target=${2:-"google.com"}
    
    echo "=== $container ç½‘ç»œè¯Šæ–­ ==="
    
    # åŸºç¡€ç½‘ç»œä¿¡æ¯
    echo "1. å®¹å™¨IPåœ°å€:"
    docker inspect $container --format '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}'
    
    # DNSè§£ææµ‹è¯•
    echo "2. DNSè§£ææµ‹è¯•:"
    docker exec $container nslookup $target 2>/dev/null || echo "DNSè§£æå¤±è´¥"
    
    # ç½‘ç»œè¿é€šæµ‹è¯•
    echo "3. ç½‘ç»œè¿é€šæµ‹è¯•:"
    docker exec $container ping -c 3 $target 2>/dev/null || echo "ç½‘ç»œè¿æ¥å¤±è´¥"
    
    # ç«¯å£æµ‹è¯•
    echo "4. å®¹å™¨å¼€æ”¾ç«¯å£:"
    docker port $container 2>/dev/null || echo "æ— ç«¯å£æ˜ å°„"
}

# å®¹å™¨é—´ç½‘ç»œæµ‹è¯•  
test_container_network() {
    local src_container=$1
    local dst_container=$2
    
    echo "æµ‹è¯• $src_container -> $dst_container ç½‘ç»œè¿é€šæ€§:"
    
    local dst_ip=$(docker inspect $dst_container --format '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}')
    echo "ç›®æ ‡å®¹å™¨IP: $dst_ip"
    
    docker exec $src_container ping -c 3 $dst_ip 2>/dev/null && echo "âœ… ç½‘ç»œè¿é€š" || echo "âŒ ç½‘ç»œä¸é€š"
}
```

### 8.4 æ€§èƒ½åˆ†æå·¥å…·


**ğŸ“ˆ å®¹å™¨æ€§èƒ½ç›‘æ§è„šæœ¬ï¼š**

```bash
# å®¹å™¨æ€§èƒ½åˆ†æå™¨
analyze_performance() {
    local container=$1
    local duration=${2:-30}  # ç›‘æ§æ—¶é•¿ï¼ˆç§’ï¼‰
    
    echo "=== $container æ€§èƒ½åˆ†æ ($duration ç§’) ==="
    
    # å®æ—¶èµ„æºç›‘æ§
    echo "å¼€å§‹æ”¶é›†æ€§èƒ½æ•°æ®..."
    docker stats --no-stream --format "table {{.Container}}\t{{.CPUPerc}}\t{{.MemUsage}}\t{{.NetIO}}\t{{.BlockIO}}" $container
    
    # è¿›ç¨‹ä¿¡æ¯
    echo -e "\nå®¹å™¨å†…è¿›ç¨‹ä¿¡æ¯:"
    docker exec $container ps aux 2>/dev/null | head -10
    
    # å†…å­˜è¯¦ç»†ä¿¡æ¯
    echo -e "\nå†…å­˜ä½¿ç”¨è¯¦æƒ…:"
    docker exec $container free -h 2>/dev/null || echo "æ— æ³•è·å–å†…å­˜ä¿¡æ¯"
    
    # ç£ç›˜ä½¿ç”¨æƒ…å†µ
    echo -e "\nç£ç›˜ä½¿ç”¨æƒ…å†µ:"  
    docker exec $container df -h 2>/dev/null || echo "æ— æ³•è·å–ç£ç›˜ä¿¡æ¯"
}

# æ‰¹é‡å®¹å™¨ç›‘æ§
monitor_all_containers() {
    echo "=== æ‰€æœ‰å®¹å™¨èµ„æºç›‘æ§ ==="
    docker stats --no-stream
    
    echo -e "\n=== CPUä½¿ç”¨ç‡TOP5 ==="
    docker stats --no-stream --format "table {{.Container}}\t{{.CPUPerc}}" | \
    tail -n +2 | sort -k2 -nr | head -5
    
    echo -e "\n=== å†…å­˜ä½¿ç”¨ç‡TOP5 ==="
    docker stats --no-stream --format "table {{.Container}}\t{{.MemPerc}}" | \
    tail -n +2 | sort -k2 -nr | head -5
}
```

### 8.5 æ•…éšœæ¢å¤è„šæœ¬


**ğŸ”„ è‡ªåŠ¨æ¢å¤å·¥å…·ï¼š**

```bash
# å®¹å™¨å¥åº·æ£€æŸ¥å’Œè‡ªåŠ¨é‡å¯
health_check_and_restart() {
    local container=$1
    local max_retries=${2:-3}
    local retry_count=0
    
    while [ $retry_count -lt $max_retries ]; do
        echo "æ£€æŸ¥å®¹å™¨ $container å¥åº·çŠ¶æ€..."
        
        if docker ps | grep -q $container; then
            echo "âœ… å®¹å™¨ $container è¿è¡Œæ­£å¸¸"
            return 0
        fi
        
        echo "âŒ å®¹å™¨ $container å¼‚å¸¸ï¼Œå°è¯•é‡å¯ (ç¬¬ $((retry_count+1)) æ¬¡)"
        docker start $container
        sleep 10
        
        retry_count=$((retry_count+1))
    done
    
    echo "ğŸš¨ å®¹å™¨ $container é‡å¯å¤±è´¥ï¼Œéœ€è¦æ‰‹åŠ¨å¤„ç†"
    return 1
}

# æ‰¹é‡å®¹å™¨å¥åº·æ£€æŸ¥
batch_health_check() {
    echo "=== æ‰¹é‡å®¹å™¨å¥åº·æ£€æŸ¥ ==="
    
    local containers=$(docker ps -a --format "{{.Names}}" --filter "status=exited")
    
    if [ -z "$containers" ]; then
        echo "âœ… æ‰€æœ‰å®¹å™¨è¿è¡Œæ­£å¸¸"
        return 0
    fi
    
    echo "å‘ç°å¼‚å¸¸å®¹å™¨:"
    echo "$containers"
    
    read -p "æ˜¯å¦å°è¯•è‡ªåŠ¨é‡å¯è¿™äº›å®¹å™¨ï¼Ÿ(y/n): " confirm
    if [ "$confirm" = "y" ]; then
        echo "$containers" | while read container; do
            health_check_and_restart $container
        done
    fi
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ•…éšœæ’æŸ¥æ€è·¯


```
ğŸ”¸ ç³»ç»ŸåŒ–è¯Šæ–­ï¼šä»å®¹å™¨çŠ¶æ€â†’æ—¥å¿—åˆ†æâ†’æ·±å…¥è°ƒè¯•
ğŸ”¸ åˆ†å±‚æ’æŸ¥ï¼šåº”ç”¨å±‚â†’å®¹å™¨å±‚â†’å®¿ä¸»æœºå±‚â†’ç½‘ç»œå±‚
ğŸ”¸ å·¥å…·ç»„åˆï¼šDockerå‘½ä»¤+ç³»ç»Ÿå·¥å…·+è‡ªå®šä¹‰è„šæœ¬
ğŸ”¸ é—®é¢˜åˆ†ç±»ï¼šå¯åŠ¨å¤±è´¥ã€ç½‘ç»œé—®é¢˜ã€å­˜å‚¨é—®é¢˜ã€æƒé™é—®é¢˜
ğŸ”¸ é¢„é˜²ä¸ºä¸»ï¼šç›‘æ§å‘Šè­¦ã€èµ„æºé™åˆ¶ã€æœ€ä½³å®è·µ
```

### 9.2 æ•…éšœæ’æŸ¥æ ¸å¿ƒå‘½ä»¤è®°å¿†


**ğŸ”¹ å¿«é€Ÿè¯Šæ–­å‘½ä»¤ç»„åˆ**
```bash
# ä¸€é”®æ•…éšœè¯Šæ–­
docker ps -a                    # æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker logs --tail 50 å®¹å™¨å    # æŸ¥çœ‹æœ€è¿‘æ—¥å¿—
docker inspect å®¹å™¨å           # æŸ¥çœ‹è¯¦ç»†é…ç½®
docker exec -it å®¹å™¨å /bin/sh  # è¿›å…¥å®¹å™¨è°ƒè¯•
docker stats --no-stream       # æŸ¥çœ‹èµ„æºä½¿ç”¨
```

**ğŸ”¹ å¸¸è§é—®é¢˜å¿«é€Ÿä¿®å¤**
```bash
# æƒé™é—®é¢˜
sudo usermod -aG docker $USER   # æ·»åŠ dockerç»„æƒé™

# ç«¯å£å†²çª  
docker run -P é•œåƒå            # è‡ªåŠ¨åˆ†é…ç«¯å£

# å­˜å‚¨æƒé™
docker run --user $(id -u):$(id -g) # ä½¿ç”¨å½“å‰ç”¨æˆ·æƒé™

# èµ„æºæ¸…ç†
docker system prune -a          # æ¸…ç†æ‰€æœ‰æœªä½¿ç”¨èµ„æº
```

### 9.3 æ•…éšœé¢„é˜²æœ€ä½³å®è·µ


**ğŸ’¡ å¼€å‘é˜¶æ®µé¢„é˜²æªæ–½ï¼š**
- **èµ„æºé™åˆ¶**ï¼šä¸ºå®¹å™¨è®¾ç½®åˆç†çš„CPUå’Œå†…å­˜é™åˆ¶
- **å¥åº·æ£€æŸ¥**ï¼šåœ¨Dockerfileä¸­æ·»åŠ HEALTHCHECKæŒ‡ä»¤
- **æ—¥å¿—ç­–ç•¥**ï¼šåˆç†é…ç½®æ—¥å¿—çº§åˆ«å’Œè½®è½¬ç­–ç•¥
- **æƒé™æœ€å°åŒ–**ï¼šé¿å…ä½¿ç”¨rootç”¨æˆ·è¿è¡Œåº”ç”¨

**ğŸ’¡ è¿ç»´é˜¶æ®µç›‘æ§ç­–ç•¥ï¼š**
- **å®šæœŸæ¸…ç†**ï¼šè®¾ç½®å®šæ—¶ä»»åŠ¡æ¸…ç†æœªä½¿ç”¨çš„é•œåƒå’Œå®¹å™¨
- **èµ„æºç›‘æ§**ï¼šä½¿ç”¨ç›‘æ§å·¥å…·è·Ÿè¸ªå®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µ
- **å¤‡ä»½ç­–ç•¥**ï¼šé‡è¦æ•°æ®ä½¿ç”¨æ•°æ®å·æŒä¹…åŒ–å­˜å‚¨
- **æ•…éšœæ¼”ç»ƒ**ï¼šå®šæœŸè¿›è¡Œæ•…éšœæ¨¡æ‹Ÿå’Œæ¢å¤æ¼”ç»ƒ

### 9.4 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ æ’æŸ¥æ•ˆç‡æå‡æŠ€å·§ï¼š**
- å»ºç«‹æ•…éšœæ’æŸ¥checklistï¼Œé¿å…é—æ¼å…³é”®æ£€æŸ¥é¡¹
- åˆ›å»ºå¸¸ç”¨è°ƒè¯•å‘½ä»¤åˆ«åï¼Œæé«˜æ“ä½œæ•ˆç‡  
- ç»´æŠ¤æ•…éšœçŸ¥è¯†åº“ï¼Œè®°å½•è§£å†³æ–¹æ¡ˆä¾›åç»­å‚è€ƒ
- è‡ªåŠ¨åŒ–å¸¸è§é—®é¢˜çš„æ£€æµ‹å’Œä¿®å¤æµç¨‹

**ğŸ¯ å›¢é˜Ÿåä½œå»ºè®®ï¼š**
- ç»Ÿä¸€æ•…éšœæ’æŸ¥æµç¨‹å’Œå·¥å…·ä½¿ç”¨è§„èŒƒ
- å»ºç«‹æ•…éšœåˆ†çº§æœºåˆ¶ï¼Œå¿«é€Ÿå“åº”å…³é”®é—®é¢˜
- å®šæœŸåˆ†äº«æ•…éšœæ¡ˆä¾‹å’Œè§£å†³ç»éªŒ
- æŒç»­ä¼˜åŒ–ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶

**æ ¸å¿ƒè®°å¿†å£è¯€ï¼š**
```
Dockeræ•…éšœè«æ…Œå¼ ï¼Œç³»ç»Ÿè¯Šæ–­æœ‰ç« æ³•
å…ˆçœ‹çŠ¶æ€æŸ¥æ—¥å¿—ï¼Œå†è¿›å®¹å™¨ç»†åˆ†æ
æƒé™ç½‘ç»œå’Œå­˜å‚¨ï¼Œèµ„æºä¸è¶³è¦æ¸…ç†
å·¥å…·è„šæœ¬æ˜¯å¸®æ‰‹ï¼Œé¢„é˜²èƒœè¿‡æ•‘ç«å¿™
```