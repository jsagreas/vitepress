---
title: 3ã€æ•°æ®åº“å®¹å™¨åŒ–
---
## ðŸ“š ç›®å½•

1. [æ•°æ®åº“å®¹å™¨åŒ–æ¦‚è¿°](#1-æ•°æ®åº“å®¹å™¨åŒ–æ¦‚è¿°)
2. [MySQLå®¹å™¨åŒ–å®žæˆ˜](#2-MySQLå®¹å™¨åŒ–å®žæˆ˜)
3. [PostgreSQLå®¹å™¨éƒ¨ç½²](#3-PostgreSQLå®¹å™¨éƒ¨ç½²)
4. [Redisç¼“å­˜æœåŠ¡å®¹å™¨](#4-Redisç¼“å­˜æœåŠ¡å®¹å™¨)
5. [MongoDBæ–‡æ¡£æ•°æ®åº“å®¹å™¨](#5-MongoDBæ–‡æ¡£æ•°æ®åº“å®¹å™¨)
6. [æ•°æ®åº“å®¹å™¨æ€§èƒ½ä¼˜åŒ–](#6-æ•°æ®åº“å®¹å™¨æ€§èƒ½ä¼˜åŒ–)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ðŸŽ¯ æ•°æ®åº“å®¹å™¨åŒ–æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯æ•°æ®åº“å®¹å™¨åŒ–


**ðŸ’¡ é€šä¿—ç†è§£**ï¼š
æŠŠæ•°æ®åº“è£…è¿›"é›†è£…ç®±"é‡Œï¼Œè¿™ä¸ªé›†è£…ç®±å°±æ˜¯Dockerå®¹å™¨ã€‚å°±åƒæŠŠå®¶å…·æ‰“åŒ…æ¬å®¶ä¸€æ ·ï¼Œæ•°æ®åº“å’Œå®ƒéœ€è¦çš„æ‰€æœ‰ä¸œè¥¿éƒ½æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œæƒ³åœ¨å“ªé‡Œç”¨å°±åœ¨å“ªé‡Œ"è§£åŒ…"è¿è¡Œã€‚

**ðŸ”¸ æ ¸å¿ƒæ¦‚å¿µ**
```
ä¼ ç»Ÿæ•°æ®åº“éƒ¨ç½²ï¼š
æœåŠ¡å™¨ â†’ å®‰è£…æ“ä½œç³»ç»Ÿ â†’ å®‰è£…æ•°æ®åº“è½¯ä»¶ â†’ é…ç½®çŽ¯å¢ƒ â†’ å¯åŠ¨æœåŠ¡

å®¹å™¨åŒ–æ•°æ®åº“éƒ¨ç½²ï¼š
æœåŠ¡å™¨ â†’ å®‰è£…Docker â†’ æ‹‰å–æ•°æ®åº“é•œåƒ â†’ è¿è¡Œå®¹å™¨ â†’ æœåŠ¡å°±ç»ª
```

### 1.2 ä¸ºä»€ä¹ˆè¦å®¹å™¨åŒ–æ•°æ®åº“


**âœ… æ ¸å¿ƒä¼˜åŠ¿**ï¼š

```
ðŸš€ éƒ¨ç½²é€Ÿåº¦å¿«ï¼š
- ä¼ ç»Ÿæ–¹å¼ï¼šå‡ å°æ—¶é…ç½®æ•°æ®åº“çŽ¯å¢ƒ
- å®¹å™¨æ–¹å¼ï¼šå‡ åˆ†é’Ÿå°±èƒ½å¯åŠ¨æ•°æ®åº“

ðŸ”„ çŽ¯å¢ƒä¸€è‡´æ€§ï¼š
å¼€å‘çŽ¯å¢ƒ = æµ‹è¯•çŽ¯å¢ƒ = ç”Ÿäº§çŽ¯å¢ƒ
é¿å…"åœ¨æˆ‘ç”µè„‘ä¸Šèƒ½è·‘"çš„é—®é¢˜

ðŸ“¦ èµ„æºéš”ç¦»ï¼š
ä¸åŒæ•°æ®åº“åœ¨å„è‡ªå®¹å™¨ä¸­è¿è¡Œ
äº’ä¸å¹²æ‰°ï¼Œç‰ˆæœ¬å†²çªé—®é¢˜è§£å†³

âš–ï¸ èµ„æºæŽ§åˆ¶ï¼š
å¯ä»¥é™åˆ¶æ¯ä¸ªæ•°æ®åº“å®¹å™¨çš„CPUå’Œå†…å­˜ä½¿ç”¨
é¿å…æŸä¸ªæ•°æ®åº“å ç”¨è¿‡å¤šèµ„æº
```

**âš ï¸ éœ€è¦æ³¨æ„çš„é—®é¢˜**ï¼š

```
ðŸ’¾ æ•°æ®æŒä¹…åŒ–ï¼š
å®¹å™¨åˆ é™¤æ•°æ®å°±æ²¡äº†ï¼Œå¿…é¡»ä½¿ç”¨æ•°æ®å·

ðŸ”§ æ€§èƒ½è°ƒä¼˜ï¼š
å®¹å™¨çŽ¯å¢ƒä¸‹çš„æ€§èƒ½ä¼˜åŒ–éœ€è¦ç‰¹åˆ«è€ƒè™‘

ðŸ”’ å®‰å…¨é…ç½®ï¼š
ç½‘ç»œè®¿é—®ã€å¯†ç ç®¡ç†éœ€è¦é¢å¤–å…³æ³¨
```

### 1.3 å®¹å™¨åŒ–æž¶æž„å›¾


```
å®¿ä¸»æœºçŽ¯å¢ƒ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Docker Engine                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ MySQLå®¹å™¨   â”‚  â”‚ Rediså®¹å™¨   â”‚     â”‚
â”‚  â”‚             â”‚  â”‚             â”‚     â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚     â”‚
â”‚  â”‚ â”‚æ•°æ®åº“ç¨‹åºâ”‚ â”‚  â”‚ â”‚ç¼“å­˜ç¨‹åº â”‚ â”‚     â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚          â”‚                â”‚           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”     â”‚
â”‚  â”‚MySQLæ•°æ®å· â”‚   â”‚Redisæ•°æ®å· â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
åº”ç”¨ç¨‹åºé€šè¿‡ç«¯å£è¿žæŽ¥åˆ°å„ä¸ªæ•°æ®åº“å®¹å™¨
```

---

## 2. ðŸ¬ MySQLå®¹å™¨åŒ–å®žæˆ˜


### 2.1 MySQLå®¹å™¨å¿«é€Ÿå¯åŠ¨


**ðŸŽ¯ å­¦ä¹ ç›®æ ‡**ï¼š
- [x] ç†è§£MySQLå®¹å™¨çš„åŸºæœ¬å¯åŠ¨æ–¹å¼
- [ ] æŽŒæ¡æ•°æ®æŒä¹…åŒ–é…ç½®
- [ ] å­¦ä¼šåˆå§‹åŒ–è„šæœ¬ä½¿ç”¨

**åŸºç¡€å¯åŠ¨å‘½ä»¤**ï¼š
```bash
# æœ€ç®€å•çš„MySQLå®¹å™¨å¯åŠ¨
docker run -d \
  --name my-mysql \
  -e MYSQL_ROOT_PASSWORD=123456 \
  mysql:8.0

# è§£é‡Šæ¯ä¸ªå‚æ•°çš„å«ä¹‰ï¼š
# -d: åŽå°è¿è¡Œï¼ˆä¸å ç”¨å½“å‰ç»ˆç«¯ï¼‰
# --name: ç»™å®¹å™¨èµ·ä¸ªåå­—ï¼Œæ–¹ä¾¿ç®¡ç†
# -e MYSQL_ROOT_PASSWORD: è®¾ç½®rootç”¨æˆ·å¯†ç 
# mysql:8.0: ä½¿ç”¨MySQL 8.0ç‰ˆæœ¬é•œåƒ
```

**ðŸ’­ ç”Ÿæ´»ç±»æ¯”**ï¼šå°±åƒç§Ÿæˆ¿å­ï¼Œ`--name`æ˜¯ç»™æˆ¿å­èµ·åå­—ï¼Œ`-e`æ˜¯è®¾ç½®æˆ¿å­çš„é—¨é”å¯†ç ï¼Œ`mysql:8.0`æ˜¯é€‰æ‹©ä»€ä¹ˆç±»åž‹çš„æˆ¿å­ã€‚

### 2.2 å®Œæ•´çš„MySQLå®¹å™¨é…ç½®


```bash
# ç”Ÿäº§çº§åˆ«çš„MySQLå®¹å™¨å¯åŠ¨
docker run -d \
  --name mysql-server \
  -p 3306:3306 \
  -v /opt/mysql/data:/var/lib/mysql \
  -v /opt/mysql/conf:/etc/mysql/conf.d \
  -v /opt/mysql/init:/docker-entrypoint-initdb.d \
  -e MYSQL_ROOT_PASSWORD=your_strong_password \
  -e MYSQL_DATABASE=myapp \
  -e MYSQL_USER=appuser \
  -e MYSQL_PASSWORD=appuser_password \
  --restart=unless-stopped \
  mysql:8.0
```

**ðŸ“‹ å‚æ•°è¯¦è§£è¡¨**ï¼š

| å‚æ•° | ä½œç”¨ | é€šä¿—è§£é‡Š |
|------|------|----------|
| `-p 3306:3306` | ç«¯å£æ˜ å°„ | æŠŠå®¹å™¨å†…çš„3306ç«¯å£"å¼€çª—"åˆ°å¤–é¢ |
| `-v /opt/mysql/data:/var/lib/mysql` | æ•°æ®æŒä¹…åŒ– | æŠŠæ•°æ®"æ¬"åˆ°å®¿ä¸»æœºä¿å­˜ |
| `-v /opt/mysql/conf:/etc/mysql/conf.d` | é…ç½®æ–‡ä»¶æ˜ å°„ | æŠŠé…ç½®æ–‡ä»¶æ”¾åœ¨å¤–é¢æ–¹ä¾¿ä¿®æ”¹ |
| `-v /opt/mysql/init:/docker-entrypoint-initdb.d` | åˆå§‹åŒ–è„šæœ¬ | å¯åŠ¨æ—¶è‡ªåŠ¨æ‰§è¡Œçš„SQLè„šæœ¬ |
| `--restart=unless-stopped` | é‡å¯ç­–ç•¥ | æœåŠ¡å™¨é‡å¯æ—¶è‡ªåŠ¨å¯åŠ¨å®¹å™¨ |

### 2.3 MySQLåˆå§‹åŒ–è„šæœ¬å®žæˆ˜


**åˆ›å»ºåˆå§‹åŒ–ç›®å½•å’Œè„šæœ¬**ï¼š
```bash
# åˆ›å»ºå¿…è¦çš„ç›®å½•
mkdir -p /opt/mysql/{data,conf,init}

# åˆ›å»ºåˆå§‹åŒ–è„šæœ¬
cat > /opt/mysql/init/init.sql << 'EOF'
-- åˆ›å»ºä¸šåŠ¡æ•°æ®åº“
CREATE DATABASE IF NOT EXISTS blog_db CHARACTER SET utf8mb4;

-- åˆ›å»ºç”¨æˆ·è¡¨
USE blog_db;
CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    email VARCHAR(100) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- æ’å…¥æµ‹è¯•æ•°æ®
INSERT INTO users (username, email) VALUES 
('alice', 'alice@example.com'),
('bob', 'bob@example.com');
EOF
```

**ðŸ” å·¥ä½œåŽŸç†**ï¼š
å®¹å™¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œ `/docker-entrypoint-initdb.d/` ç›®å½•ä¸‹çš„æ‰€æœ‰ `.sql` æ–‡ä»¶ï¼Œè¿™æ ·æ•°æ®åº“å¯åŠ¨å°±æœ‰äº†åˆå§‹æ•°æ®ã€‚

### 2.4 MySQLé…ç½®æ–‡ä»¶ä¼˜åŒ–


```bash
# åˆ›å»ºMySQLé…ç½®æ–‡ä»¶
cat > /opt/mysql/conf/my.cnf << 'EOF'
[mysqld]
# å­—ç¬¦é›†é…ç½®
character-set-server=utf8mb4
collation-server=utf8mb4_unicode_ci

# è¿žæŽ¥é…ç½®
max_connections=200
max_connect_errors=10

# ç¼“å­˜é…ç½®
innodb_buffer_pool_size=256M
query_cache_type=1
query_cache_size=64M

# æ—¥å¿—é…ç½®
slow_query_log=1
slow_query_log_file=/var/lib/mysql/slow.log
long_query_time=2

[mysql]
default-character-set=utf8mb4
EOF
```

> ðŸ’¡ **æ ¸å¿ƒç†è§£**ï¼šé…ç½®æ–‡ä»¶æ”¾åœ¨å®¹å™¨å¤–é¢ï¼Œè¿™æ ·ä¸ç”¨é‡å»ºå®¹å™¨å°±èƒ½è°ƒæ•´æ•°æ®åº“å‚æ•°ã€‚

---

## 3. ðŸ˜ PostgreSQLå®¹å™¨éƒ¨ç½²


### 3.1 PostgreSQLåŸºç¡€éƒ¨ç½²


**PostgreSQL vs MySQL ç®€å•å¯¹æ¯”**ï¼š
```
MySQLï¼šåƒå¤§ä¼—åŒ–é¤åŽ…ï¼Œç®€å•æ˜“ç”¨ï¼Œé€‚åˆå¤§éƒ¨åˆ†åœºæ™¯
PostgreSQLï¼šåƒé«˜çº§é¤åŽ…ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œé€‚åˆå¤æ‚ä¸šåŠ¡
```

**åŸºç¡€å¯åŠ¨å‘½ä»¤**ï¼š
```bash
docker run -d \
  --name postgres-server \
  -p 5432:5432 \
  -v /opt/postgres/data:/var/lib/postgresql/data \
  -e POSTGRES_DB=myapp \
  -e POSTGRES_USER=postgres \
  -e POSTGRES_PASSWORD=your_password \
  postgres:15
```

### 3.2 PostgreSQLé«˜çº§é…ç½®


```bash
# åˆ›å»ºPostgreSQLå®¹å™¨withå®Œæ•´é…ç½®
docker run -d \
  --name postgres-prod \
  -p 5432:5432 \
  -v /opt/postgres/data:/var/lib/postgresql/data \
  -v /opt/postgres/init:/docker-entrypoint-initdb.d \
  -e POSTGRES_DB=production_db \
  -e POSTGRES_USER=dbadmin \
  -e POSTGRES_PASSWORD=secure_password \
  -e POSTGRES_INITDB_ARGS="--encoding=UTF8 --locale=C" \
  --shm-size=256m \
  postgres:15
```

**ðŸ”§ PostgreSQLç‰¹æœ‰é…ç½®**ï¼š

| é…ç½®é¡¹ | ä½œç”¨ | è§£é‡Š |
|--------|------|------|
| `--shm-size=256m` | å…±äº«å†…å­˜å¤§å° | PostgreSQLéœ€è¦å…±äº«å†…å­˜è¿›è¡Œå¹¶è¡ŒæŸ¥è¯¢ |
| `POSTGRES_INITDB_ARGS` | åˆå§‹åŒ–å‚æ•° | è®¾ç½®æ•°æ®åº“ç¼–ç å’Œæœ¬åœ°åŒ– |

### 3.3 PostgreSQLåˆå§‹åŒ–è„šæœ¬


```bash
# åˆ›å»ºåˆå§‹åŒ–è„šæœ¬
cat > /opt/postgres/init/init.sql << 'EOF'
-- åˆ›å»ºåº”ç”¨æ•°æ®åº“
CREATE DATABASE ecommerce;

-- è¿žæŽ¥åˆ°æ–°æ•°æ®åº“
\c ecommerce;

-- åˆ›å»ºå•†å“è¡¨
CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    price DECIMAL(10,2) NOT NULL,
    category_id INTEGER,
    created_at TIMESTAMP DEFAULT NOW()
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_products_category ON products(category_id);
CREATE INDEX idx_products_price ON products(price);

-- æ’å…¥æµ‹è¯•æ•°æ®
INSERT INTO products (name, price, category_id) VALUES 
('ç¬”è®°æœ¬ç”µè„‘', 5999.00, 1),
('æ— çº¿é¼ æ ‡', 199.00, 1),
('æœºæ¢°é”®ç›˜', 699.00, 1);
EOF
```

---

## 4. ðŸ”´ Redisç¼“å­˜æœåŠ¡å®¹å™¨


### 4.1 Rediså®¹å™¨åŸºç¡€éƒ¨ç½²


**ðŸŽ¯ Redisçš„ä½œç”¨**ï¼š
æƒ³è±¡Redisæ˜¯ä¸€ä¸ªè¶…çº§å¿«çš„å°ä»“åº“ï¼Œä¸“é—¨å­˜æ”¾ç»å¸¸éœ€è¦çš„ä¸œè¥¿ã€‚ç½‘ç«™éœ€è¦ä»€ä¹ˆæ•°æ®ï¼Œå…ˆåŽ»Redisæ‰¾ï¼Œæ‰¾ä¸åˆ°å†åŽ»æ•°æ®åº“æ‰¾ã€‚

```bash
# åŸºç¡€Rediså®¹å™¨
docker run -d \
  --name redis-cache \
  -p 6379:6379 \
  redis:7-alpine

# alpineç‰ˆæœ¬ï¼šä½“ç§¯å°ï¼Œå¯åŠ¨å¿«ï¼Œé€‚åˆç¼“å­˜æœåŠ¡
```

### 4.2 RedisæŒä¹…åŒ–é…ç½®


```bash
# å¸¦æŒä¹…åŒ–çš„Rediså®¹å™¨
docker run -d \
  --name redis-server \
  -p 6379:6379 \
  -v /opt/redis/data:/data \
  -v /opt/redis/conf/redis.conf:/usr/local/etc/redis/redis.conf \
  --restart=unless-stopped \
  redis:7-alpine redis-server /usr/local/etc/redis/redis.conf
```

**åˆ›å»ºRedisé…ç½®æ–‡ä»¶**ï¼š
```bash
mkdir -p /opt/redis/{data,conf}

cat > /opt/redis/conf/redis.conf << 'EOF'
# ç½‘ç»œé…ç½®
bind 0.0.0.0
port 6379
timeout 300

# å†…å­˜é…ç½®
maxmemory 512mb
maxmemory-policy allkeys-lru

# æŒä¹…åŒ–é…ç½®
save 900 1      # 900ç§’å†…è‡³å°‘1ä¸ªkeyå˜åŒ–å°±ä¿å­˜
save 300 10     # 300ç§’å†…è‡³å°‘10ä¸ªkeyå˜åŒ–å°±ä¿å­˜
save 60 10000   # 60ç§’å†…è‡³å°‘10000ä¸ªkeyå˜åŒ–å°±ä¿å­˜

# å®‰å…¨é…ç½®
# requirepass your_redis_password

# æ—¥å¿—é…ç½®
loglevel notice
logfile ""
EOF
```

**ðŸ“Š RedisæŒä¹…åŒ–ç­–ç•¥å¯¹æ¯”**ï¼š

| ç­–ç•¥ | åŽŸç† | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|------|----------|
| **RDB** | å®šæœŸä¿å­˜å†…å­˜å¿«ç…§ | æ–‡ä»¶å°ï¼Œæ¢å¤å¿« | å¯èƒ½ä¸¢å¤±æ•°æ® | ç¼“å­˜åœºæ™¯ |
| **AOF** | è®°å½•æ¯ä¸ªå†™æ“ä½œ | æ•°æ®å®‰å…¨æ€§é«˜ | æ–‡ä»¶å¤§ï¼Œæ¢å¤æ…¢ | æ•°æ®é‡è¦åœºæ™¯ |

### 4.3 Redisé›†ç¾¤éƒ¨ç½²


```bash
# Redisä¸»ä»Žå¤åˆ¶æž¶æž„
# ä¸»èŠ‚ç‚¹
docker run -d \
  --name redis-master \
  -p 6379:6379 \
  -v /opt/redis/master:/data \
  redis:7-alpine

# ä»ŽèŠ‚ç‚¹
docker run -d \
  --name redis-slave \
  -p 6380:6379 \
  -v /opt/redis/slave:/data \
  redis:7-alpine redis-server --slaveof redis-master 6379
```

---

## 5. ðŸƒ MongoDBæ–‡æ¡£æ•°æ®åº“å®¹å™¨


### 5.1 MongoDBåŸºç¡€éƒ¨ç½²


**ðŸŽ¯ MongoDBç‰¹ç‚¹**ï¼š
MongoDBå°±åƒä¸€ä¸ªçµæ´»çš„æ–‡ä»¶æŸœï¼Œå¯ä»¥å­˜æ”¾å„ç§æ ¼å¼çš„æ–‡æ¡£ï¼Œä¸åƒä¼ ç»Ÿæ•°æ®åº“è¦æ±‚ä¸¥æ ¼çš„è¡¨æ ¼æ ¼å¼ã€‚

```bash
# åŸºç¡€MongoDBå®¹å™¨
docker run -d \
  --name mongodb-server \
  -p 27017:27017 \
  -v /opt/mongodb/data:/data/db \
  -e MONGO_INITDB_ROOT_USERNAME=admin \
  -e MONGO_INITDB_ROOT_PASSWORD=admin123 \
  mongo:6.0
```

### 5.2 MongoDBé«˜çº§é…ç½®


```bash
# ç”Ÿäº§çº§MongoDBéƒ¨ç½²
docker run -d \
  --name mongodb-prod \
  -p 27017:27017 \
  -v /opt/mongodb/data:/data/db \
  -v /opt/mongodb/config:/data/configdb \
  -v /opt/mongodb/init:/docker-entrypoint-initdb.d \
  -e MONGO_INITDB_ROOT_USERNAME=mongoadmin \
  -e MONGO_INITDB_ROOT_PASSWORD=secure_password \
  -e MONGO_INITDB_DATABASE=myapp \
  --restart=unless-stopped \
  mongo:6.0 --auth
```

### 5.3 MongoDBåˆå§‹åŒ–è„šæœ¬


```bash
# åˆ›å»ºåˆå§‹åŒ–JavaScriptè„šæœ¬
mkdir -p /opt/mongodb/{data,config,init}

cat > /opt/mongodb/init/init.js << 'EOF'
// åˆ‡æ¢åˆ°åº”ç”¨æ•°æ®åº“
db = db.getSiblingDB('myapp');

// åˆ›å»ºåº”ç”¨ç”¨æˆ·
db.createUser({
  user: 'appuser',
  pwd: 'appuser_password',
  roles: [
    {
      role: 'readWrite',
      db: 'myapp'
    }
  ]
});

// åˆ›å»ºé›†åˆå¹¶æ’å…¥æµ‹è¯•æ•°æ®
db.users.insertMany([
  {
    name: 'å¼ ä¸‰',
    age: 25,
    email: 'zhangsan@example.com',
    profile: {
      city: 'åŒ—äº¬',
      hobbies: ['è¯»ä¹¦', 'æ—…æ¸¸', 'ç¼–ç¨‹']
    },
    created_at: new Date()
  },
  {
    name: 'æŽå››',
    age: 30,
    email: 'lisi@example.com',
    profile: {
      city: 'ä¸Šæµ·',
      hobbies: ['éŸ³ä¹', 'ç”µå½±', 'è¿åŠ¨']
    },
    created_at: new Date()
  }
]);

// åˆ›å»ºç´¢å¼•
db.users.createIndex({ "email": 1 }, { unique: true });
db.users.createIndex({ "profile.city": 1 });

print('MongoDBåˆå§‹åŒ–å®Œæˆ');
EOF
```

**ðŸ’¡ MongoDBæ–‡æ¡£å­˜å‚¨ä¼˜åŠ¿**ï¼š
```
å…³ç³»åž‹æ•°æ®åº“å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼š
ç”¨æˆ·è¡¨ï¼šid, name, age, email
å…´è¶£è¡¨ï¼šuser_id, hobby
åœ°å€è¡¨ï¼šuser_id, city, address

MongoDBå­˜å‚¨åŒæ ·ä¿¡æ¯ï¼š
{
  name: "å¼ ä¸‰",
  age: 25,
  profile: {
    city: "åŒ—äº¬",
    hobbies: ["è¯»ä¹¦", "æ—…æ¸¸"]
  }
}

ä¸€ä¸ªæ–‡æ¡£åŒ…å«å®Œæ•´ä¿¡æ¯ï¼ŒæŸ¥è¯¢æ›´ç®€å•
```

---

## 6. ðŸš€ æ•°æ®åº“å®¹å™¨æ€§èƒ½ä¼˜åŒ–


### 6.1 å®¹å™¨èµ„æºé™åˆ¶é…ç½®


**ä¸ºä»€ä¹ˆè¦é™åˆ¶èµ„æº**ï¼š
å°±åƒç»™æ¯ä¸ªæˆ¿é—´åˆ†é…å›ºå®šçš„æ°´ç”µèµ„æºï¼Œé˜²æ­¢æŸä¸ªæ•°æ®åº“å®¹å™¨å ç”¨è¿‡å¤šèµ„æºå½±å“å…¶ä»–æœåŠ¡ã€‚

```bash
# MySQLå®¹å™¨èµ„æºé™åˆ¶
docker run -d \
  --name mysql-limited \
  --memory=1g \
  --memory-swap=1g \
  --cpus="1.5" \
  --oom-kill-disable=false \
  -p 3306:3306 \
  -v /opt/mysql/data:/var/lib/mysql \
  -e MYSQL_ROOT_PASSWORD=password \
  mysql:8.0
```

**ðŸ”§ èµ„æºé™åˆ¶å‚æ•°è¯´æ˜Ž**ï¼š

| å‚æ•° | ä½œç”¨ | æŽ¨èå€¼ | è¯´æ˜Ž |
|------|------|--------|------|
| `--memory=1g` | å†…å­˜é™åˆ¶ | æ€»å†…å­˜çš„50-70% | é˜²æ­¢OOM killer |
| `--cpus="1.5"` | CPUé™åˆ¶ | æ ¹æ®è´Ÿè½½è°ƒæ•´ | 1.5è¡¨ç¤º1.5ä¸ªCPUæ ¸å¿ƒ |
| `--memory-swap=1g` | äº¤æ¢å†…å­˜ | ä¸Žå†…å­˜ç›¸ç­‰æˆ–ç¨å¤§ | é¿å…è¿‡åº¦ä½¿ç”¨swap |

### 6.2 æ•°æ®åº“æ€§èƒ½è°ƒä¼˜é…ç½®


**MySQLæ€§èƒ½ä¼˜åŒ–é…ç½®**ï¼š
```bash
cat > /opt/mysql/conf/performance.cnf << 'EOF'
[mysqld]
# InnoDBä¼˜åŒ–
innodb_buffer_pool_size=512M          # ç¼“å†²æ± å¤§å°ï¼Œå»ºè®®ä¸ºå†…å­˜çš„70%
innodb_log_file_size=128M              # æ—¥å¿—æ–‡ä»¶å¤§å°
innodb_flush_log_at_trx_commit=2       # äº‹åŠ¡æäº¤æ—¶çš„åˆ·æ–°ç­–ç•¥
innodb_flush_method=O_DIRECT           # ç»•è¿‡æ“ä½œç³»ç»Ÿç¼“å­˜

# è¿žæŽ¥ä¼˜åŒ–
max_connections=300                    # æœ€å¤§è¿žæŽ¥æ•°
thread_cache_size=50                   # çº¿ç¨‹ç¼“å­˜
table_open_cache=400                   # è¡¨ç¼“å­˜

# æŸ¥è¯¢ä¼˜åŒ–
query_cache_type=1                     # å¼€å¯æŸ¥è¯¢ç¼“å­˜
query_cache_size=128M                  # æŸ¥è¯¢ç¼“å­˜å¤§å°
tmp_table_size=64M                     # ä¸´æ—¶è¡¨å¤§å°
max_heap_table_size=64M                # å†…å­˜è¡¨å¤§å°
EOF
```

### 6.3 å®¹å™¨ç½‘ç»œä¼˜åŒ–


**åˆ›å»ºä¸“ç”¨æ•°æ®åº“ç½‘ç»œ**ï¼š
```bash
# åˆ›å»ºæ•°æ®åº“ä¸“ç”¨ç½‘ç»œ
docker network create --driver bridge db-network

# åœ¨ä¸“ç”¨ç½‘ç»œä¸­å¯åŠ¨æ•°æ®åº“å®¹å™¨
docker run -d \
  --name mysql-app \
  --network db-network \
  -v /opt/mysql/data:/var/lib/mysql \
  -e MYSQL_ROOT_PASSWORD=password \
  mysql:8.0

# åº”ç”¨å®¹å™¨è¿žæŽ¥åˆ°åŒä¸€ç½‘ç»œ
docker run -d \
  --name web-app \
  --network db-network \
  -p 80:80 \
  your-web-app:latest
```

**ðŸŒ ç½‘ç»œä¼˜åŒ–å¥½å¤„**ï¼š
```
é»˜è®¤bridgeç½‘ç»œï¼š
å®¹å™¨é—´é€šä¿¡éœ€è¦é€šè¿‡å®¿ä¸»æœºIPå’Œç«¯å£

ä¸“ç”¨ç½‘ç»œï¼š
å®¹å™¨é—´ç›´æŽ¥é€šè¿‡å®¹å™¨åé€šä¿¡ï¼Œæ€§èƒ½æ›´å¥½ï¼Œå®‰å…¨æ€§æ›´é«˜
```

### 6.4 ç›‘æŽ§å’Œæ—¥å¿—é…ç½®


```bash
# å¯åŠ¨å¸¦ç›‘æŽ§çš„æ•°æ®åº“å®¹å™¨
docker run -d \
  --name mysql-monitored \
  -p 3306:3306 \
  -v /opt/mysql/data:/var/lib/mysql \
  -v /opt/mysql/logs:/var/log/mysql \
  -e MYSQL_ROOT_PASSWORD=password \
  --log-driver=json-file \
  --log-opt max-size=100m \
  --log-opt max-file=3 \
  mysql:8.0
```

**ðŸ“Š ç›‘æŽ§æŒ‡æ ‡é‡ç‚¹å…³æ³¨**ï¼š

| æŒ‡æ ‡ç±»åž‹ | å…³é”®æŒ‡æ ‡ | æ­£å¸¸èŒƒå›´ | å¼‚å¸¸å¤„ç† |
|----------|----------|----------|----------|
| **å†…å­˜ä½¿ç”¨** | å†…å­˜ä½¿ç”¨çŽ‡ | < 80% | å¢žåŠ å†…å­˜é™åˆ¶æˆ–ä¼˜åŒ–é…ç½® |
| **CPUä½¿ç”¨** | CPUä½¿ç”¨çŽ‡ | < 70% | ä¼˜åŒ–æŸ¥è¯¢æˆ–å¢žåŠ CPUé™åˆ¶ |
| **ç£ç›˜IO** | IOPS | æ ¹æ®ç£ç›˜ç±»åž‹ | ä½¿ç”¨SSDæˆ–ä¼˜åŒ–å­˜å‚¨é…ç½® |
| **è¿žæŽ¥æ•°** | æ´»è·ƒè¿žæŽ¥ | < æœ€å¤§è¿žæŽ¥æ•°çš„60% | å¢žåŠ è¿žæŽ¥æ± é…ç½® |

---

## 7. ðŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŽŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ðŸ”¸ æ•°æ®åº“å®¹å™¨åŒ–æœ¬è´¨ï¼šæŠŠæ•°æ®åº“åŠå…¶è¿è¡ŒçŽ¯å¢ƒæ‰“åŒ…æˆå®¹å™¨
ðŸ”¸ æ•°æ®æŒä¹…åŒ–ï¼šä½¿ç”¨æ•°æ®å·ä¿è¯å®¹å™¨åˆ é™¤æ•°æ®ä¸ä¸¢å¤±
ðŸ”¸ åˆå§‹åŒ–è„šæœ¬ï¼šå®¹å™¨å¯åŠ¨æ—¶è‡ªåŠ¨æ‰§è¡ŒSQLè„šæœ¬åˆå§‹åŒ–æ•°æ®
ðŸ”¸ é…ç½®æ–‡ä»¶æ˜ å°„ï¼šæŠŠé…ç½®æ–‡ä»¶æ”¾åœ¨å®¹å™¨å¤–æ–¹ä¾¿ç®¡ç†
ðŸ”¸ èµ„æºé™åˆ¶ï¼šé˜²æ­¢å•ä¸ªæ•°æ®åº“å®¹å™¨å ç”¨è¿‡å¤šèµ„æº
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ðŸ”¹ æ•°æ®æŒä¹…åŒ–çš„é‡è¦æ€§**
```
é—®é¢˜ï¼šå®¹å™¨æ˜¯ä¸´æ—¶çš„ï¼Œåˆ é™¤å®¹å™¨æ•°æ®å°±æ²¡äº†
è§£å†³ï¼šä½¿ç”¨æ•°æ®å·æŠŠæ•°æ®å­˜åœ¨å®¿ä¸»æœº
å‘½ä»¤ï¼š-v /host/path:/container/path

ç”Ÿæ´»ç±»æ¯”ï¼š
å®¹å™¨åƒé…’åº—æˆ¿é—´ï¼Œä½ é€€æˆ¿ä¸œè¥¿å°±æ²¡äº†
æ•°æ®å·åƒè¡ŒæŽç®±ï¼Œä¸œè¥¿å§‹ç»ˆè·Ÿç€ä½ 
```

**ðŸ”¹ ä¸åŒæ•°æ®åº“çš„ç‰¹ç‚¹é€‰æ‹©**
```
MySQLï¼š
â€¢ æœ€æµè¡Œï¼Œç”Ÿæ€å¥½ï¼Œé€‚åˆä¼ ç»ŸWebåº”ç”¨
â€¢ ä¸»ä»Žå¤åˆ¶ç®€å•ï¼Œé€‚åˆè¯»å¤šå†™å°‘åœºæ™¯

PostgreSQLï¼š
â€¢ åŠŸèƒ½å¼ºå¤§ï¼Œæ”¯æŒå¤æ‚æ•°æ®ç±»åž‹
â€¢ é€‚åˆä¼ä¸šçº§åº”ç”¨å’Œå¤æ‚æŸ¥è¯¢

Redisï¼š
â€¢ å†…å­˜æ•°æ®åº“ï¼Œé€Ÿåº¦æžå¿«
â€¢ é€‚åˆç¼“å­˜å’Œä¼šè¯å­˜å‚¨

MongoDBï¼š
â€¢ æ–‡æ¡£æ•°æ®åº“ï¼Œç»“æž„çµæ´»
â€¢ é€‚åˆéžç»“æž„åŒ–æ•°æ®å’Œå¿«é€Ÿå¼€å‘
```

**ðŸ”¹ æ€§èƒ½ä¼˜åŒ–é‡ç‚¹**
```
å®¹å™¨å±‚é¢ï¼š
â€¢ åˆç†è®¾ç½®å†…å­˜å’ŒCPUé™åˆ¶
â€¢ ä½¿ç”¨ä¸“ç”¨ç½‘ç»œå‡å°‘é€šä¿¡å¼€é”€
â€¢ é…ç½®åˆé€‚çš„é‡å¯ç­–ç•¥

æ•°æ®åº“å±‚é¢ï¼š
â€¢ æ ¹æ®æ•°æ®åº“ç‰¹ç‚¹è°ƒæ•´é…ç½®å‚æ•°
â€¢ è®¾ç½®åˆç†çš„ç¼“å­˜å¤§å°
â€¢ é…ç½®é€‚å½“çš„æ—¥å¿—çº§åˆ«
```

### 7.3 å®žé™…åº”ç”¨æŒ‡å¯¼


**ðŸŽ¯ ç”Ÿäº§çŽ¯å¢ƒéƒ¨ç½²æ¸…å•**ï¼š
- [x] æ•°æ®æŒä¹…åŒ–é…ç½®ï¼ˆæ•°æ®å·ï¼‰
- [x] é…ç½®æ–‡ä»¶å¤–éƒ¨ç®¡ç†
- [x] åˆå§‹åŒ–è„šæœ¬å‡†å¤‡
- [x] èµ„æºé™åˆ¶è®¾ç½®
- [x] ç½‘ç»œå®‰å…¨é…ç½®
- [x] ç›‘æŽ§å’Œæ—¥å¿—é…ç½®
- [x] å¤‡ä»½ç­–ç•¥åˆ¶å®š

**ðŸ”§ å¸¸è§é—®é¢˜è§£å†³**ï¼š

| é—®é¢˜ | ç—‡çŠ¶ | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| **å®¹å™¨å¯åŠ¨å¤±è´¥** | å®¹å™¨çŠ¶æ€ä¸ºExited | æ£€æŸ¥çŽ¯å¢ƒå˜é‡ã€ç«¯å£å ç”¨ã€æƒé™é—®é¢˜ |
| **æ•°æ®ä¸¢å¤±** | é‡å¯å®¹å™¨æ•°æ®æ²¡äº† | é…ç½®æ•°æ®å·æŒä¹…åŒ– |
| **è¿žæŽ¥è¢«æ‹’ç»** | åº”ç”¨æ— æ³•è¿žæŽ¥æ•°æ®åº“ | æ£€æŸ¥ç«¯å£æ˜ å°„ã€ç½‘ç»œé…ç½®ã€é˜²ç«å¢™ |
| **æ€§èƒ½å·®** | æŸ¥è¯¢å“åº”æ…¢ | è°ƒæ•´å†…å­˜é…ç½®ã€ä¼˜åŒ–æ•°æ®åº“å‚æ•° |

**ðŸ’¡ æœ€ä½³å®žè·µå»ºè®®**ï¼š
```
å¼€å‘çŽ¯å¢ƒï¼š
â€¢ å¿«é€Ÿå¯åŠ¨ï¼Œä½¿ç”¨é»˜è®¤é…ç½®
â€¢ å¯ä»¥ä¸æŒä¹…åŒ–æ•°æ®ï¼Œæ–¹ä¾¿é‡ç½®

æµ‹è¯•çŽ¯å¢ƒï¼š
â€¢ æ¨¡æ‹Ÿç”Ÿäº§çŽ¯å¢ƒé…ç½®
â€¢ ä½¿ç”¨ç›¸åŒçš„åˆå§‹åŒ–è„šæœ¬

ç”Ÿäº§çŽ¯å¢ƒï¼š
â€¢ å®Œæ•´çš„èµ„æºé™åˆ¶å’Œç›‘æŽ§
â€¢ ä¸¥æ ¼çš„å®‰å…¨é…ç½®å’Œå¤‡ä»½ç­–ç•¥
```

### 7.4 å­¦ä¹ è·¯å¾„å»ºè®®


**ðŸ“š è¿›é˜¶å­¦ä¹ æ–¹å‘**ï¼š
1. **Docker Compose**ï¼šå­¦ä¹ å¤šå®¹å™¨ç¼–æŽ’
2. **Kubernetes**ï¼šå­¦ä¹ å®¹å™¨é›†ç¾¤ç®¡ç†  
3. **æ•°æ®åº“é›†ç¾¤**ï¼šä¸»ä»Žå¤åˆ¶ã€åˆ†ç‰‡éƒ¨ç½²
4. **ç›‘æŽ§ä½“ç³»**ï¼šPrometheus + Grafanaç›‘æŽ§
5. **è‡ªåŠ¨åŒ–å¤‡ä»½**ï¼šå®šæ—¶å¤‡ä»½å’Œæ¢å¤ç­–ç•¥

**ðŸ”‘ ä¸€å¥è¯æ€»ç»“**ï¼š
æ•°æ®åº“å®¹å™¨åŒ–è®©éƒ¨ç½²å˜ç®€å•ï¼Œä½†æ•°æ®æŒä¹…åŒ–å’Œæ€§èƒ½ä¼˜åŒ–æ˜¯å…³é”®ï¼Œé€‰æ‹©åˆé€‚çš„æ•°æ®åº“ç±»åž‹å’Œé…ç½®å‚æ•°æ˜¯æˆåŠŸçš„åŸºç¡€ã€‚

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- å®¹å™¨åŒ–æ•°æ®åº“å¿«åˆå¥½ï¼Œæ•°æ®æŒä¹…åŒ–ä¸èƒ½å°‘
- é…ç½®æ–‡ä»¶æ”¾å¤–é¢ï¼Œåˆå§‹è„šæœ¬è‡ªåŠ¨è·‘  
- èµ„æºé™åˆ¶è¦åˆç†ï¼Œç›‘æŽ§æ—¥å¿—ä¸å¯å°‘
- MySQLä¼ ç»ŸPostgreSQLå¼ºï¼ŒRedisç¼“å­˜MongoDBçµæ´»ç”¨