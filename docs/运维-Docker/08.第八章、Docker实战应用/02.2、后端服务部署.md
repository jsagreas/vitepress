---
title: 2ã€åç«¯æœåŠ¡éƒ¨ç½²
---
## ğŸ“š ç›®å½•

1. [åç«¯æœåŠ¡å®¹å™¨åŒ–æ ¸å¿ƒæ¦‚å¿µ](#1-åç«¯æœåŠ¡å®¹å™¨åŒ–æ ¸å¿ƒæ¦‚å¿µ)
2. [Node.jsåº”ç”¨å®¹å™¨åŒ–éƒ¨ç½²](#2-nodejsåº”ç”¨å®¹å™¨åŒ–éƒ¨ç½²)
3. [Python Flask/Djangoéƒ¨ç½²å®æˆ˜](#3-python-flaskdjangoéƒ¨ç½²å®æˆ˜)
4. [Java Spring Bootå®¹å™¨åŒ–](#4-java-spring-bootå®¹å™¨åŒ–)
5. [Goè¯­è¨€åº”ç”¨éƒ¨ç½²](#5-goè¯­è¨€åº”ç”¨éƒ¨ç½²)
6. [ç¯å¢ƒå˜é‡ä¸é…ç½®ç®¡ç†](#6-ç¯å¢ƒå˜é‡ä¸é…ç½®ç®¡ç†)
7. [æ•°æ®åº“è¿æ¥é…ç½®å®è·µ](#7-æ•°æ®åº“è¿æ¥é…ç½®å®è·µ)
8. [APIæ¥å£æœåŠ¡ä¼˜åŒ–](#8-apiæ¥å£æœåŠ¡ä¼˜åŒ–)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ åç«¯æœåŠ¡å®¹å™¨åŒ–æ ¸å¿ƒæ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯åç«¯æœåŠ¡å®¹å™¨åŒ–


**é€šä¿—ç†è§£**ï¼šæŠŠä½ çš„åç«¯ç¨‹åºï¼ˆæ¯”å¦‚ä¸€ä¸ªç½‘ç«™çš„APIæœåŠ¡ï¼‰æ‰“åŒ…æˆä¸€ä¸ª"ç›’å­"ï¼Œè¿™ä¸ªç›’å­é‡ŒåŒ…å«äº†ç¨‹åºè¿è¡Œéœ€è¦çš„ä¸€åˆ‡ä¸œè¥¿ã€‚

```
ä¼ ç»Ÿéƒ¨ç½²æ–¹å¼ï¼š
å¼€å‘ç¯å¢ƒ â†’ æµ‹è¯•ç¯å¢ƒ â†’ ç”Ÿäº§ç¯å¢ƒ
âŒ æ¯ä¸ªç¯å¢ƒéƒ½è¦é‡æ–°é…ç½®
âŒ "åœ¨æˆ‘ç”µè„‘ä¸Šèƒ½è·‘" é—®é¢˜é¢‘å‘
âŒ ä¾èµ–ç®¡ç†å¤æ‚

å®¹å™¨åŒ–éƒ¨ç½²ï¼š
ä»£ç  + ä¾èµ– + é…ç½® â†’ Dockeré•œåƒ â†’ ä»»ä½•ç¯å¢ƒè¿è¡Œ
âœ… ä¸€æ¬¡æ‰“åŒ…ï¼Œåˆ°å¤„è¿è¡Œ
âœ… ç¯å¢ƒä¸€è‡´æ€§ä¿è¯
âœ… å¿«é€Ÿéƒ¨ç½²å’Œæ‰©å±•
```

### 1.2 å®¹å™¨åŒ–çš„æ ¸å¿ƒä»·å€¼


> ğŸ’¡ **æ ¸å¿ƒä»·å€¼**  
> å®¹å™¨åŒ–æœ€å¤§çš„å¥½å¤„æ˜¯è§£å†³äº†"ç¯å¢ƒä¸€è‡´æ€§"é—®é¢˜ï¼Œè®©ä½ çš„åº”ç”¨åœ¨å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒä¸­è¡¨ç°å®Œå…¨ä¸€è‡´

**å®é™…åœºæ™¯å¯¹æ¯”**ï¼š
```
åœºæ™¯ï¼šéƒ¨ç½²ä¸€ä¸ªNode.js APIæœåŠ¡

ä¼ ç»Ÿæ–¹å¼éœ€è¦ï¼š
â€¢ å®‰è£…Node.jsï¼ˆç‰ˆæœ¬è¦åŒ¹é…ï¼‰
â€¢ å®‰è£…npmä¾èµ–
â€¢ é…ç½®ç¯å¢ƒå˜é‡
â€¢ é…ç½®æ•°æ®åº“è¿æ¥
â€¢ å¯åŠ¨æœåŠ¡
â€¢ é…ç½®åå‘ä»£ç†

å®¹å™¨åŒ–æ–¹å¼ï¼š
â€¢ docker run your-api-image
â€¢ ä¸€è¡Œå‘½ä»¤æå®šæ‰€æœ‰é…ç½®
```

### 1.3 åç«¯æœåŠ¡å®¹å™¨åŒ–å…³é”®è¦ç´ 


```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Dockerå®¹å™¨              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚        åº”ç”¨ç¨‹åºä»£ç               â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚        è¿è¡Œæ—¶ç¯å¢ƒ               â”‚ â”‚
â”‚  â”‚     (Node.js/Python/Java)      â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚        ä¾èµ–åŒ…ç®¡ç†               â”‚ â”‚
â”‚  â”‚    (npm/pip/maven packages)    â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚        é…ç½®æ–‡ä»¶                 â”‚ â”‚
â”‚  â”‚   (ç¯å¢ƒå˜é‡/æ•°æ®åº“é…ç½®)          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ğŸŸ¢ Node.jsåº”ç”¨å®¹å™¨åŒ–éƒ¨ç½²


### 2.1 Node.jså®¹å™¨åŒ–åŸºç¡€


**ä»€ä¹ˆæ˜¯Node.jså®¹å™¨åŒ–**ï¼šæŠŠä½ çš„Expressã€Koaç­‰Node.jsåº”ç”¨æ‰“åŒ…æˆDockeré•œåƒï¼Œè®©å®ƒèƒ½åœ¨ä»»ä½•åœ°æ–¹è¿è¡Œã€‚

### 2.2 åŸºç¡€Node.jsåº”ç”¨å®¹å™¨åŒ–


> ğŸ¯ **å­¦ä¹ ç›®æ ‡**  
> æŒæ¡å¦‚ä½•å°†ä¸€ä¸ªç®€å•çš„Express APIåº”ç”¨å®¹å™¨åŒ–

**æ­¥éª¤1ï¼šå‡†å¤‡Node.jsåº”ç”¨**
```javascript
// app.js - ç®€å•çš„Expressåº”ç”¨
const express = require('express');
const app = express();
const port = process.env.PORT || 3000;

app.use(express.json());

// ç®€å•çš„APIæ¥å£
app.get('/api/health', (req, res) => {
  res.json({ status: 'healthy', timestamp: new Date().toISOString() });
});

app.get('/api/users', (req, res) => {
  res.json([
    { id: 1, name: 'Alice' },
    { id: 2, name: 'Bob' }
  ]);
});

app.listen(port, '0.0.0.0', () => {
  console.log(`Server running on port ${port}`);
});
```

**æ­¥éª¤2ï¼šç¼–å†™Dockerfile**
```dockerfile
# ä½¿ç”¨å®˜æ–¹Node.jsåŸºç¡€é•œåƒ
FROM node:18-alpine

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# å¤åˆ¶package.jsonæ–‡ä»¶ï¼ˆå……åˆ†åˆ©ç”¨Dockerç¼“å­˜ï¼‰
COPY package*.json ./

# å®‰è£…ä¾èµ–
RUN npm ci --only=production

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY . .

# æš´éœ²ç«¯å£
EXPOSE 3000

# åˆ›å»ºérootç”¨æˆ·ï¼ˆå®‰å…¨æœ€ä½³å®è·µï¼‰
RUN addgroup -g 1001 -S nodejs
RUN adduser -S nodejs -u 1001
USER nodejs

# å¯åŠ¨åº”ç”¨
CMD ["node", "app.js"]
```

> ğŸ“– **æœ¯è¯­è§£é‡Š**  
> - `FROM node:18-alpine`ï¼šä½¿ç”¨è½»é‡çº§çš„Alpine Linuxç‰ˆæœ¬Node.jsé•œåƒ
> - `WORKDIR /app`ï¼šè®¾ç½®å®¹å™¨å†…çš„å·¥ä½œç›®å½•
> - `npm ci`ï¼šæ¯”npm installæ›´é€‚åˆç”Ÿäº§ç¯å¢ƒçš„å®‰è£…å‘½ä»¤
> - `USER nodejs`ï¼šä»¥érootç”¨æˆ·è¿è¡Œï¼Œæé«˜å®‰å…¨æ€§

**æ­¥éª¤3ï¼šæ„å»ºå’Œè¿è¡Œ**
```bash
# æ„å»ºé•œåƒ
docker build -t my-node-api .

# è¿è¡Œå®¹å™¨
docker run -p 3000:3000 my-node-api

# æµ‹è¯•API
curl http://localhost:3000/api/health
```

### 2.3 Node.jså®¹å™¨åŒ–æœ€ä½³å®è·µ


**å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–**ï¼š
```dockerfile
# æ„å»ºé˜¶æ®µ
FROM node:18-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .

# ç”Ÿäº§é˜¶æ®µ
FROM node:18-alpine AS production
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production && npm cache clean --force
COPY --from=builder /app .
EXPOSE 3000
USER node
CMD ["node", "app.js"]
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**  
> å¤šé˜¶æ®µæ„å»ºå¯ä»¥æ˜¾è‘—å‡å°æœ€ç»ˆé•œåƒå¤§å°ï¼Œåªä¿ç•™ç”Ÿäº§ç¯å¢ƒéœ€è¦çš„æ–‡ä»¶

---

## 3. ğŸ Python Flask/Djangoéƒ¨ç½²å®æˆ˜


### 3.1 Pythonåº”ç”¨å®¹å™¨åŒ–åŸç†


**æ ¸å¿ƒæ¦‚å¿µ**ï¼šPythonåº”ç”¨å®¹å™¨åŒ–éœ€è¦å¤„ç†è™šæ‹Ÿç¯å¢ƒã€ä¾èµ–ç®¡ç†å’ŒWSGIæœåŠ¡å™¨é…ç½®ã€‚

### 3.2 Flaskåº”ç”¨å®¹å™¨åŒ–


**Flaskåº”ç”¨ç¤ºä¾‹**ï¼š
```python
# app.py
from flask import Flask, jsonify, request
import os

app = Flask(__name__)

@app.route('/api/health')
def health():
    return jsonify({
        'status': 'healthy',
        'python_version': '3.11',
        'environment': os.getenv('FLASK_ENV', 'production')
    })

@app.route('/api/data', methods=['GET', 'POST'])
def handle_data():
    if request.method == 'POST':
        return jsonify({'message': 'Data received', 'data': request.json})
    return jsonify({'data': [1, 2, 3, 4, 5]})

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=int(os.getenv('PORT', 5000)))
```

**Flask Dockerfile**ï¼š
```dockerfile
FROM python:3.11-slim

# è®¾ç½®ç¯å¢ƒå˜é‡
ENV PYTHONUNBUFFERED=1
ENV PYTHONDONTWRITEBYTECODE=1

WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–ï¼ˆå¦‚æœéœ€è¦ï¼‰
RUN apt-get update && apt-get install -y \
    gcc \
    && rm -rf /var/lib/apt/lists/*

# å¤åˆ¶requirementsæ–‡ä»¶
COPY requirements.txt .

# å®‰è£…Pythonä¾èµ–
RUN pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY . .

# åˆ›å»ºérootç”¨æˆ·
RUN useradd --create-home --shell /bin/bash app
USER app

EXPOSE 5000

# ä½¿ç”¨Gunicornä½œä¸ºWSGIæœåŠ¡å™¨
CMD ["gunicorn", "--bind", "0.0.0.0:5000", "--workers", "4", "app:app"]
```

### 3.3 Djangoåº”ç”¨å®¹å™¨åŒ–


**Djangoé¡¹ç›®ç»“æ„**ï¼š
```
myproject/
â”œâ”€â”€ manage.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ Dockerfile
â””â”€â”€ myproject/
    â”œâ”€â”€ settings.py
    â”œâ”€â”€ urls.py
    â””â”€â”€ wsgi.py
```

**Django Dockerfile**ï¼š
```dockerfile
FROM python:3.11-slim

ENV PYTHONUNBUFFERED=1
ENV PYTHONDONTWRITEBYTECODE=1

WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    postgresql-client \
    && rm -rf /var/lib/apt/lists/*

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

# æ”¶é›†é™æ€æ–‡ä»¶
RUN python manage.py collectstatic --noinput

EXPOSE 8000

# å¯åŠ¨è„šæœ¬
COPY entrypoint.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh

ENTRYPOINT ["/entrypoint.sh"]
```

**Djangoå¯åŠ¨è„šæœ¬**ï¼š
```bash
#!/bin/bash
# entrypoint.sh

# ç­‰å¾…æ•°æ®åº“å¯åŠ¨
python manage.py migrate

# å¯åŠ¨Djangoåº”ç”¨
exec gunicorn myproject.wsgi:application --bind 0.0.0.0:8000 --workers 3
```

> ğŸ”§ **å®è·µåº”ç”¨**  
> Djangoåº”ç”¨é€šå¸¸éœ€è¦æ•°æ®åº“è¿ç§»å’Œé™æ€æ–‡ä»¶æ”¶é›†ï¼Œä½¿ç”¨å¯åŠ¨è„šæœ¬å¯ä»¥è‡ªåŠ¨åŒ–è¿™äº›æ­¥éª¤

---

## 4. â˜• Java Spring Bootå®¹å™¨åŒ–


### 4.1 Spring Bootå®¹å™¨åŒ–ä¼˜åŠ¿


**ä¸ºä»€ä¹ˆè¦å®¹å™¨åŒ–Spring Boot**ï¼š
- **æ ‡å‡†åŒ–éƒ¨ç½²**ï¼šæ¶ˆé™¤"æœºå™¨å·®å¼‚"å¯¼è‡´çš„é—®é¢˜
- **å¾®æœåŠ¡æ¶æ„**ï¼šæ¯ä¸ªæœåŠ¡ç‹¬ç«‹æ‰“åŒ…å’Œéƒ¨ç½²
- **ç‰ˆæœ¬ç®¡ç†**ï¼šJDKç‰ˆæœ¬ç»Ÿä¸€ç®¡ç†

### 4.2 åŸºç¡€Spring Bootå®¹å™¨åŒ–


**Spring Bootåº”ç”¨ç¤ºä¾‹**ï¼š
```java
// Application.java
@SpringBootApplication
@RestController
public class Application {
    
    @GetMapping("/api/health")
    public Map<String, Object> health() {
        Map<String, Object> status = new HashMap<>();
        status.put("status", "healthy");
        status.put("timestamp", new Date());
        status.put("java_version", System.getProperty("java.version"));
        return status;
    }
    
    @GetMapping("/api/users")
    public List<Map<String, Object>> users() {
        return Arrays.asList(
            Map.of("id", 1, "name", "Alice"),
            Map.of("id", 2, "name", "Bob")
        );
    }
    
    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }
}
```

**ä¼ ç»ŸDockerfileæ–¹å¼**ï¼š
```dockerfile
FROM openjdk:17-jre-slim

WORKDIR /app

# å¤åˆ¶JARæ–‡ä»¶
COPY target/my-app-1.0.0.jar app.jar

# è®¾ç½®JVMå‚æ•°
ENV JAVA_OPTS="-Xmx512m -Xms256m"

EXPOSE 8080

# å¯åŠ¨åº”ç”¨
ENTRYPOINT exec java $JAVA_OPTS -jar app.jar
```

### 4.3 ä¼˜åŒ–çš„å¤šé˜¶æ®µæ„å»º


```dockerfile
# æ„å»ºé˜¶æ®µ
FROM maven:3.9-openjdk-17 AS build
WORKDIR /app
COPY pom.xml .
COPY src ./src
RUN mvn clean package -DskipTests

# è¿è¡Œé˜¶æ®µ
FROM openjdk:17-jre-slim
WORKDIR /app

# åˆ›å»ºérootç”¨æˆ·
RUN useradd --create-home --shell /bin/bash spring
USER spring

# å¤åˆ¶JARæ–‡ä»¶
COPY --from=build /app/target/*.jar app.jar

EXPOSE 8080

HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
    CMD curl -f http://localhost:8080/api/health || exit 1

ENTRYPOINT ["java", "-jar", "app.jar"]
```

> ğŸ’¡ **å­¦ä¹ æç¤º**  
> Spring Bootçš„Fat JARåŒ…å«äº†æ‰€æœ‰ä¾èµ–ï¼Œä½†ä¹Ÿå¯¼è‡´é•œåƒè¾ƒå¤§ã€‚ä½¿ç”¨åˆ†å±‚JARå¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–

---

## 5. ğŸš€ Goè¯­è¨€åº”ç”¨éƒ¨ç½²


### 5.1 Goåº”ç”¨å®¹å™¨åŒ–ç‰¹ç‚¹


**Goè¯­è¨€çš„å®¹å™¨åŒ–ä¼˜åŠ¿**ï¼š
- **é™æ€ç¼–è¯‘**ï¼šç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶æ— å¤–éƒ¨ä¾èµ–
- **é•œåƒå°**ï¼šå¯ä»¥ä½¿ç”¨æå°çš„åŸºç¡€é•œåƒ
- **å¯åŠ¨å¿«**ï¼šäºŒè¿›åˆ¶æ–‡ä»¶ç›´æ¥æ‰§è¡Œ

### 5.2 Go Webåº”ç”¨å®¹å™¨åŒ–


**Goåº”ç”¨ç¤ºä¾‹**ï¼š
```go
// main.go
package main

import (
    "encoding/json"
    "log"
    "net/http"
    "os"
    "time"
)

type HealthResponse struct {
    Status    string    `json:"status"`
    Timestamp time.Time `json:"timestamp"`
    Version   string    `json:"version"`
}

func healthHandler(w http.ResponseWriter, r *http.Request) {
    response := HealthResponse{
        Status:    "healthy",
        Timestamp: time.Now(),
        Version:   "1.0.0",
    }
    
    w.Header().Set("Content-Type", "application/json")
    json.NewEncoder(w).Encode(response)
}

func main() {
    http.HandleFunc("/api/health", healthHandler)
    
    port := os.Getenv("PORT")
    if port == "" {
        port = "8080"
    }
    
    log.Printf("Server starting on port %s", port)
    log.Fatal(http.ListenAndServe(":"+port, nil))
}
```

**é«˜æ•ˆçš„Go Dockerfile**ï¼š
```dockerfile
# æ„å»ºé˜¶æ®µ
FROM golang:1.21-alpine AS builder

WORKDIR /app

# å¤åˆ¶go modæ–‡ä»¶
COPY go.mod go.sum ./
RUN go mod download

# å¤åˆ¶æºç å¹¶æ„å»º
COPY . .
RUN CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o main .

# æœ€ç»ˆé•œåƒ - ä½¿ç”¨scratchæˆ–distroless
FROM alpine:latest

# å®‰è£…ca-certificatesï¼ˆç”¨äºHTTPSè¯·æ±‚ï¼‰
RUN apk --no-cache add ca-certificates
WORKDIR /root/

# å¤åˆ¶äºŒè¿›åˆ¶æ–‡ä»¶
COPY --from=builder /app/main .

EXPOSE 8080

CMD ["./main"]
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**  
> Goçš„é™æ€ç¼–è¯‘å…è®¸ä½¿ç”¨æå°çš„åŸºç¡€é•œåƒï¼Œç”šè‡³å¯ä»¥ä½¿ç”¨`FROM scratch`ï¼Œä½†è¦æ³¨æ„SSLè¯ä¹¦ç­‰ä¾èµ–

---

## 6. âš™ï¸ ç¯å¢ƒå˜é‡ä¸é…ç½®ç®¡ç†


### 6.1 ç¯å¢ƒå˜é‡ç®¡ç†åŸç†


**ä¸ºä»€ä¹ˆéœ€è¦ç¯å¢ƒå˜é‡**ï¼šä¸åŒç¯å¢ƒï¼ˆå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ï¼‰éœ€è¦ä¸åŒçš„é…ç½®ï¼Œä½†ä»£ç ä¿æŒä¸å˜ã€‚

```
é…ç½®ç®¡ç†çš„æ¼”è¿›ï¼š
ç¡¬ç¼–ç é…ç½® â†’ é…ç½®æ–‡ä»¶ â†’ ç¯å¢ƒå˜é‡ â†’ é…ç½®ä¸­å¿ƒ

é—®é¢˜ï¼š             ä¼˜ç‚¹ï¼š
â€¢ æ— æ³•åŠ¨æ€ä¿®æ”¹      â€¢ è¿è¡Œæ—¶å¯ä¿®æ”¹
â€¢ å®‰å…¨æ€§å·®         â€¢ æ•æ„Ÿä¿¡æ¯éš”ç¦»  
â€¢ ç¯å¢ƒè€¦åˆ         â€¢ ç¯å¢ƒæ— å…³
```

### 6.2 Dockerç¯å¢ƒå˜é‡ä½¿ç”¨æ–¹æ³•


**æ–¹æ³•1ï¼šè¿è¡Œæ—¶ä¼ é€’**
```bash
# å•ä¸ªç¯å¢ƒå˜é‡
docker run -e NODE_ENV=production my-app

# å¤šä¸ªç¯å¢ƒå˜é‡
docker run -e NODE_ENV=production -e PORT=3000 -e DB_HOST=mysql my-app
```

**æ–¹æ³•2ï¼šenvæ–‡ä»¶æ–¹å¼**
```bash
# .envæ–‡ä»¶å†…å®¹
NODE_ENV=production
PORT=3000
DB_HOST=mysql
DB_PORT=3306
DB_NAME=myapp
DB_USER=admin
# DB_PASSWORDé€šè¿‡secretsç®¡ç†

# ä½¿ç”¨envæ–‡ä»¶
docker run --env-file .env my-app
```

### 6.3 åº”ç”¨å†…ç¯å¢ƒå˜é‡å¤„ç†


**Node.jsç¯å¢ƒå˜é‡å¤„ç†**ï¼š
```javascript
// config.js
const config = {
  port: process.env.PORT || 3000,
  nodeEnv: process.env.NODE_ENV || 'development',
  database: {
    host: process.env.DB_HOST || 'localhost',
    port: parseInt(process.env.DB_PORT) || 3306,
    name: process.env.DB_NAME || 'myapp',
    user: process.env.DB_USER || 'root',
    password: process.env.DB_PASSWORD || ''
  },
  jwt: {
    secret: process.env.JWT_SECRET || 'default-secret',
    expiresIn: process.env.JWT_EXPIRES_IN || '24h'
  }
};

module.exports = config;
```

**Pythonç¯å¢ƒå˜é‡å¤„ç†**ï¼š
```python
# config.py
import os
from typing import Optional

class Config:
    PORT: int = int(os.getenv('PORT', '5000'))
    DEBUG: bool = os.getenv('DEBUG', 'False').lower() == 'true'
    
    # æ•°æ®åº“é…ç½®
    DB_HOST: str = os.getenv('DB_HOST', 'localhost')
    DB_PORT: int = int(os.getenv('DB_PORT', '5432'))
    DB_NAME: str = os.getenv('DB_NAME', 'myapp')
    DB_USER: str = os.getenv('DB_USER', 'postgres')
    DB_PASSWORD: Optional[str] = os.getenv('DB_PASSWORD')
    
    @property
    def database_url(self) -> str:
        return f"postgresql://{self.DB_USER}:{self.DB_PASSWORD}@{self.DB_HOST}:{self.DB_PORT}/{self.DB_NAME}"

config = Config()
```

> ğŸ”§ **å®è·µåº”ç”¨**  
> ç¯å¢ƒå˜é‡å‘½åå»ºè®®ä½¿ç”¨å¤§å†™å­—æ¯å’Œä¸‹åˆ’çº¿ï¼Œéµå¾ª12-Factor AppåŸåˆ™

---

## 7. ğŸ—„ï¸ æ•°æ®åº“è¿æ¥é…ç½®å®è·µ


### 7.1 å®¹å™¨åŒ–æ•°æ®åº“è¿æ¥ç­–ç•¥


**æ•°æ®åº“è¿æ¥çš„æ ¸å¿ƒé—®é¢˜**ï¼š
- **ç½‘ç»œè¿é€šæ€§**ï¼šå®¹å™¨é—´å¦‚ä½•é€šä¿¡
- **è¿æ¥é…ç½®**ï¼šä¸»æœºåã€ç«¯å£ã€è®¤è¯ä¿¡æ¯
- **è¿æ¥æ± ç®¡ç†**ï¼šä¼˜åŒ–æ€§èƒ½å’Œèµ„æºä½¿ç”¨

### 7.2 Dockerç½‘ç»œä¸­çš„æ•°æ®åº“è¿æ¥


**å®¹å™¨ç½‘ç»œé€šä¿¡æ¨¡å¼**ï¼š
```
åœºæ™¯1ï¼šæ•°æ®åº“ä¹Ÿåœ¨å®¹å™¨ä¸­
app-container â†â†’ mysql-container
ä½¿ç”¨å®¹å™¨åä½œä¸ºä¸»æœºå

åœºæ™¯2ï¼šå¤–éƒ¨æ•°æ®åº“æœåŠ¡
app-container â†â†’ å¤–éƒ¨MySQL
ä½¿ç”¨å®é™…IPæˆ–åŸŸå

åœºæ™¯3ï¼šDocker Compose
é€šè¿‡æœåŠ¡åè‡ªåŠ¨è§£æ
app â†â†’ db (æœåŠ¡å)
```

### 7.3 Node.jsæ•°æ®åº“è¿æ¥é…ç½®


**MySQLè¿æ¥ç¤ºä¾‹**ï¼š
```javascript
// db.js - MySQLè¿æ¥é…ç½®
const mysql = require('mysql2/promise');

const dbConfig = {
  host: process.env.DB_HOST || 'localhost',
  port: parseInt(process.env.DB_PORT) || 3306,
  user: process.env.DB_USER || 'root',
  password: process.env.DB_PASSWORD || '',
  database: process.env.DB_NAME || 'myapp',
  // è¿æ¥æ± é…ç½®
  connectionLimit: parseInt(process.env.DB_POOL_SIZE) || 10,
  acquireTimeout: 60000,
  timeout: 60000,
  reconnect: true
};

class DatabaseConnection {
  constructor() {
    this.pool = mysql.createPool(dbConfig);
  }
  
  async query(sql, params = []) {
    try {
      const [rows] = await this.pool.execute(sql, params);
      return rows;
    } catch (error) {
      console.error('Database query error:', error);
      throw error;
    }
  }
  
  async testConnection() {
    try {
      await this.query('SELECT 1');
      console.log('Database connected successfully');
      return true;
    } catch (error) {
      console.error('Database connection failed:', error);
      return false;
    }
  }
}

module.exports = new DatabaseConnection();
```

### 7.4 Pythonæ•°æ®åº“è¿æ¥é…ç½®


**SQLAlchemy + PostgreSQLç¤ºä¾‹**ï¼š
```python
# database.py
from sqlalchemy import create_engine, text
from sqlalchemy.orm import sessionmaker
from sqlalchemy.pool import QueuePool
import os
import logging

class DatabaseManager:
    def __init__(self):
        # æ„å»ºæ•°æ®åº“URL
        self.db_url = self._build_database_url()
        
        # åˆ›å»ºå¼•æ“ï¼Œé…ç½®è¿æ¥æ± 
        self.engine = create_engine(
            self.db_url,
            poolclass=QueuePool,
            pool_size=10,
            max_overflow=20,
            pool_pre_ping=True,  # è¿æ¥å‰æµ‹è¯•
            pool_recycle=3600,   # 1å°æ—¶å›æ”¶è¿æ¥
        )
        
        self.SessionLocal = sessionmaker(bind=self.engine)
    
    def _build_database_url(self):
        host = os.getenv('DB_HOST', 'localhost')
        port = os.getenv('DB_PORT', '5432')
        user = os.getenv('DB_USER', 'postgres')
        password = os.getenv('DB_PASSWORD', '')
        dbname = os.getenv('DB_NAME', 'myapp')
        
        return f"postgresql://{user}:{password}@{host}:{port}/{dbname}"
    
    def test_connection(self):
        try:
            with self.engine.connect() as conn:
                result = conn.execute(text("SELECT 1"))
                logging.info("Database connection successful")
                return True
        except Exception as e:
            logging.error(f"Database connection failed: {e}")
            return False

# åˆ›å»ºå…¨å±€æ•°æ®åº“ç®¡ç†å™¨
db_manager = DatabaseManager()
```

### 7.5 Docker Composeæ•°æ®åº“ç¼–æ’


```yaml
# docker-compose.yml
version: '3.8'

services:
  # åº”ç”¨æœåŠ¡
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - DB_HOST=mysql
      - DB_PORT=3306
      - DB_USER=app_user
      - DB_PASSWORD=secure_password
      - DB_NAME=myapp_db
    depends_on:
      - mysql
    networks:
      - app-network

  # MySQLæ•°æ®åº“æœåŠ¡
  mysql:
    image: mysql:8.0
    environment:
      - MYSQL_ROOT_PASSWORD=root_password
      - MYSQL_DATABASE=myapp_db
      - MYSQL_USER=app_user
      - MYSQL_PASSWORD=secure_password
    volumes:
      - mysql_data:/var/lib/mysql
      - ./init.sql:/docker-entrypoint-initdb.d/init.sql
    ports:
      - "3306:3306"
    networks:
      - app-network

volumes:
  mysql_data:

networks:
  app-network:
    driver: bridge
```

> ğŸ’­ **æ€è€ƒå¼•å¯¼é—®é¢˜**  
> ä¸ºä»€ä¹ˆåœ¨Docker Composeä¸­åº”ç”¨æœåŠ¡è¦ä¾èµ–æ•°æ®åº“æœåŠ¡ï¼Ÿå¦‚æœä¸è®¾ç½®depends_onä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

---

## 8. ğŸŒ APIæ¥å£æœåŠ¡ä¼˜åŒ–


### 8.1 å®¹å™¨åŒ–APIæœåŠ¡çš„æ€§èƒ½è€ƒè™‘


**æ€§èƒ½ä¼˜åŒ–çš„å…³é”®ç‚¹**ï¼š
- **èµ„æºé™åˆ¶**ï¼šCPUå’Œå†…å­˜ä½¿ç”¨æ§åˆ¶
- **å¹¶å‘å¤„ç†**ï¼šå¤šè¿›ç¨‹/å¤šçº¿ç¨‹é…ç½®
- **å¥åº·æ£€æŸ¥**ï¼šæœåŠ¡çŠ¶æ€ç›‘æ§
- **æ—¥å¿—ç®¡ç†**ï¼šç»“æ„åŒ–æ—¥å¿—è¾“å‡º

### 8.2 APIæœåŠ¡å¥åº·æ£€æŸ¥é…ç½®


**Dockerfileä¸­çš„å¥åº·æ£€æŸ¥**ï¼š
```dockerfile
# Node.jsåº”ç”¨å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
  CMD curl -f http://localhost:3000/api/health || exit 1

# Pythonåº”ç”¨å¥åº·æ£€æŸ¥  
HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
  CMD python -c "import requests; requests.get('http://localhost:5000/api/health')" || exit 1
```

**å¥åº·æ£€æŸ¥æ¥å£å®ç°**ï¼š
```javascript
// Node.jså¥åº·æ£€æŸ¥æ¥å£
app.get('/api/health', async (req, res) => {
  const healthStatus = {
    status: 'healthy',
    timestamp: new Date().toISOString(),
    uptime: process.uptime(),
    memory: process.memoryUsage(),
    // æ£€æŸ¥æ•°æ®åº“è¿æ¥
    database: await checkDatabaseConnection(),
    // æ£€æŸ¥å¤–éƒ¨ä¾èµ–
    dependencies: await checkExternalServices()
  };
  
  const isHealthy = healthStatus.database && 
                   Object.values(healthStatus.dependencies).every(dep => dep);
  
  res.status(isHealthy ? 200 : 503).json(healthStatus);
});
```

### 8.3 APIæœåŠ¡èµ„æºé™åˆ¶


**è¿è¡Œæ—¶èµ„æºé™åˆ¶**ï¼š
```bash
# é™åˆ¶CPUå’Œå†…å­˜ä½¿ç”¨
docker run -d \
  --name my-api \
  --memory="512m" \
  --cpus="1.0" \
  --restart=unless-stopped \
  -p 3000:3000 \
  my-api-image
```

**Docker Composeèµ„æºé™åˆ¶**ï¼š
```yaml
services:
  api:
    image: my-api
    deploy:
      resources:
        limits:
          cpus: '1.0'
          memory: 512M
        reservations:
          cpus: '0.5'
          memory: 256M
    restart: unless-stopped
```

### 8.4 APIæœåŠ¡æ—¥å¿—ä¼˜åŒ–


**ç»“æ„åŒ–æ—¥å¿—é…ç½®**ï¼š
```javascript
// ä½¿ç”¨winstonè¿›è¡Œç»“æ„åŒ–æ—¥å¿—
const winston = require('winston');

const logger = winston.createLogger({
  level: process.env.LOG_LEVEL || 'info',
  format: winston.format.combine(
    winston.format.timestamp(),
    winston.format.json()
  ),
  transports: [
    new winston.transports.Console({
      format: winston.format.combine(
        winston.format.colorize(),
        winston.format.simple()
      )
    })
  ]
});

// ä¸­é—´ä»¶è®°å½•APIè¯·æ±‚
app.use((req, res, next) => {
  const start = Date.now();
  
  res.on('finish', () => {
    const duration = Date.now() - start;
    logger.info('API Request', {
      method: req.method,
      url: req.url,
      status: res.statusCode,
      duration: `${duration}ms`,
      userAgent: req.get('User-Agent'),
      ip: req.ip
    });
  });
  
  next();
});
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å®¹å™¨åŒ–æœ¬è´¨ï¼šå°†åº”ç”¨åŠå…¶ç¯å¢ƒæ‰“åŒ…ï¼Œå®ç°ä¸€è‡´æ€§éƒ¨ç½²
ğŸ”¸ å¤šè¯­è¨€æ”¯æŒï¼šNode.jsã€Pythonã€Javaã€Goå„æœ‰ç‰¹ç‚¹
ğŸ”¸ é…ç½®ç®¡ç†ï¼šç¯å¢ƒå˜é‡æ˜¯å®¹å™¨åŒ–åº”ç”¨é…ç½®çš„æ ‡å‡†æ–¹å¼
ğŸ”¸ æ•°æ®åº“è¿æ¥ï¼šå®¹å™¨ç½‘ç»œå’Œè¿æ¥æ± æ˜¯å…³é”®
ğŸ”¸ æœåŠ¡ä¼˜åŒ–ï¼šå¥åº·æ£€æŸ¥ã€èµ„æºé™åˆ¶ã€æ—¥å¿—ç®¡ç†ç¼ºä¸€ä¸å¯
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆè¦å®¹å™¨åŒ–åç«¯æœåŠ¡**
```
æ ¸å¿ƒä»·å€¼ï¼š
â€¢ ç¯å¢ƒä¸€è‡´æ€§ â†’ æ¶ˆé™¤"åœ¨æˆ‘æœºå™¨ä¸Šèƒ½è·‘"é—®é¢˜
â€¢ å¿«é€Ÿéƒ¨ç½² â†’ åˆ†é’Ÿçº§éƒ¨ç½²ä»£æ›¿å°æ—¶çº§é…ç½®
â€¢ æ˜“äºæ‰©å±• â†’ æ°´å¹³æ‰©å±•å˜å¾—ç®€å•
â€¢ èµ„æºéš”ç¦» â†’ åº”ç”¨é—´ä¸ä¼šäº’ç›¸å¹²æ‰°
```

**ğŸ”¹ ä¸åŒè¯­è¨€çš„å®¹å™¨åŒ–å·®å¼‚**
```
Node.jsï¼šéœ€è¦å¤„ç†npmä¾èµ–å’Œnpmç¼“å­˜
Pythonï¼šè™šæ‹Ÿç¯å¢ƒå’Œpipä¾èµ–ç®¡ç†
Javaï¼šJARæ–‡ä»¶å’ŒJVMå‚æ•°è°ƒä¼˜
Goï¼šé™æ€ç¼–è¯‘çš„ä¼˜åŠ¿ï¼Œé•œåƒæœ€å°
```

**ğŸ”¹ ç”Ÿäº§ç¯å¢ƒçš„å…³é”®é…ç½®**
```
å®‰å…¨æ€§ï¼šérootç”¨æˆ·è¿è¡Œ
æ€§èƒ½ï¼šåˆç†çš„èµ„æºé™åˆ¶
ç›‘æ§ï¼šå¥åº·æ£€æŸ¥å’Œç»“æ„åŒ–æ—¥å¿—
ç½‘ç»œï¼šæ­£ç¡®çš„å®¹å™¨é—´é€šä¿¡é…ç½®
```

### 9.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ å¾®æœåŠ¡æ¶æ„**ï¼š
- æ¯ä¸ªæœåŠ¡ç‹¬ç«‹å®¹å™¨åŒ–
- æœåŠ¡é—´é€šè¿‡APIé€šä¿¡
- ç‹¬ç«‹éƒ¨ç½²å’Œæ‰©å±•

**ğŸ¯ DevOpsæµæ°´çº¿**ï¼š
- ä»£ç æäº¤ â†’ è‡ªåŠ¨æ„å»ºé•œåƒ
- é•œåƒæ¨é€åˆ°ä»“åº“
- è‡ªåŠ¨éƒ¨ç½²åˆ°ä¸åŒç¯å¢ƒ

**ğŸ¯ äº‘åŸç”Ÿéƒ¨ç½²**ï¼š
- Kubernetesé›†ç¾¤ç®¡ç†
- è‡ªåŠ¨æ‰©ç¼©å®¹
- æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡

### 9.4 æœ€ä½³å®è·µæ¸…å•


> ğŸ“‹ **éƒ¨ç½²æ£€æŸ¥æ¸…å•**  
> âœ… ä½¿ç”¨å¤šé˜¶æ®µæ„å»ºå‡å°é•œåƒå¤§å°  
> âœ… é…ç½®å¥åº·æ£€æŸ¥ç«¯ç‚¹  
> âœ… ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†é…ç½®  
> âœ… è®¾ç½®åˆç†çš„èµ„æºé™åˆ¶  
> âœ… å®ç°ç»“æ„åŒ–æ—¥å¿—è¾“å‡º  
> âœ… ä½¿ç”¨érootç”¨æˆ·è¿è¡Œ  
> âœ… æ­£ç¡®å¤„ç†ä¿¡å·å’Œä¼˜é›…å…³é—­  

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- å®¹å™¨åŒ–éƒ¨ç½²å¥½å¤„å¤šï¼Œç¯å¢ƒä¸€è‡´æœ€é‡è¦
- é…ç½®åˆ†ç¦»ç”¨ç¯å˜ï¼Œæ•°æ®åº“è¿æ¥è¦è§„èŒƒ  
- å¥åº·æ£€æŸ¥ä¸èƒ½å°‘ï¼Œæ—¥å¿—ç»“æ„è¦åšå¥½
- èµ„æºé™åˆ¶ä¿ç¨³å®šï¼Œå®‰å…¨è¿è¡Œæ˜¯ç‹é“