---
title: 3ã€asyncå’Œawait
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯async/await](#1-ä»€ä¹ˆæ˜¯asyncawait)
2. [ä¸ºä»€ä¹ˆè¦å­¦async/await](#2-ä¸ºä»€ä¹ˆè¦å­¦asyncawait)
3. [asyncå‡½æ•°æ€ä¹ˆç”¨](#3-asyncå‡½æ•°æ€ä¹ˆç”¨)
4. [awaitå…³é”®å­—æ€ä¹ˆç”¨](#4-awaitå…³é”®å­—æ€ä¹ˆç”¨)
5. [é”™è¯¯å¤„ç†æ€ä¹ˆåš](#5-é”™è¯¯å¤„ç†æ€ä¹ˆåš)
6. [å®é™…å¼€å‘ä¸­çš„åº”ç”¨](#6-å®é™…å¼€å‘ä¸­çš„åº”ç”¨)
7. [å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ](#7-å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¤” ä»€ä¹ˆæ˜¯async/await


### 1.1 ç”¨å¤§ç™½è¯è§£é‡Š


æƒ³è±¡ä½ å»é¤å…åƒé¥­ï¼š

```
ä¼ ç»Ÿæ–¹å¼ï¼ˆå›è°ƒåœ°ç‹±ï¼‰ï¼š
ç‚¹é¤ â†’ ç­‰èœ â†’ èœæ¥äº†ç»§ç»­ç‚¹ â†’ å†ç­‰èœ â†’ åˆæ¥äº†å†ç‚¹...
ä»£ç åµŒå¥—å¾ˆæ·±ï¼Œå¾ˆéš¾çœ‹æ‡‚

Promiseæ–¹å¼ï¼š
ç‚¹é¤.then(ç­‰èœ).then(ä¸Šèœ).then(ç»§ç»­ç‚¹).catch(å¤„ç†é—®é¢˜)
æ¯”å›è°ƒå¥½ï¼Œä½†é“¾æ¡å¾ˆé•¿

async/awaitæ–¹å¼ï¼š
ç‚¹é¤
ç­‰èœ  
ä¸Šèœ
ç»§ç»­ç‚¹
å°±åƒæ­£å¸¸è¯´è¯ä¸€æ ·ï¼Œä¸€æ­¥ä¸€æ­¥æ¥
```

### 1.2 æŠ€æœ¯å®šä¹‰


**async/await** æ˜¯JavaScriptå¤„ç†å¼‚æ­¥æ“ä½œçš„**æœ€æ–°è¯­æ³•**ï¼Œè®©ä½ å¯ä»¥ç”¨**å†™åŒæ­¥ä»£ç çš„æ–¹å¼**æ¥å¤„ç†å¼‚æ­¥æ“ä½œã€‚

```javascript
// ä»¥å‰çš„å†™æ³•ï¼ˆå¤æ‚ï¼‰
function getData() {
  fetch('/api/user')
    .then(response => response.json())
    .then(user => {
      fetch('/api/orders')
        .then(response => response.json())
        .then(orders => {
          console.log(user, orders);
        });
    });
}

// ç°åœ¨çš„å†™æ³•ï¼ˆç®€å•ï¼‰
async function getData() {
  const userResponse = await fetch('/api/user');
  const user = await userResponse.json();
  
  const ordersResponse = await fetch('/api/orders');
  const orders = await ordersResponse.json();
  
  console.log(user, orders);
}
```

### 1.3 æ ¸å¿ƒç†è§£


```
async/await = Promiseçš„åŒ–å¦†å“
è®©Promiseç©¿ä¸Šäº†"åŒæ­¥ä»£ç "çš„å¤–è¡£
æœ¬è´¨è¿˜æ˜¯å¼‚æ­¥ï¼Œä½†çœ‹èµ·æ¥åƒåŒæ­¥
```

**å…³é”®è¯ç†è§£**ï¼š
- **async** = "è¿™ä¸ªå‡½æ•°é‡Œæœ‰å¼‚æ­¥æ“ä½œ"
- **await** = "ç­‰ä¸€ä¸‹ï¼Œç­‰è¿™ä¸ªæ“ä½œå®Œæˆ"

---

## 2. ğŸ’¡ ä¸ºä»€ä¹ˆè¦å­¦async/await


### 2.1 è§£å†³çš„ç—›ç‚¹


**ğŸ”¸ å›è°ƒåœ°ç‹±é—®é¢˜**
```javascript
// ğŸ˜µ çœ‹ç€å¤´ç–¼çš„åµŒå¥—å›è°ƒ
getUserInfo(userId, function(user) {
  getOrderList(user.id, function(orders) {
    getOrderDetail(orders[0].id, function(detail) {
      updateUI(detail, function(result) {
        console.log('ç»ˆäºå®Œæˆäº†...');
      });
    });
  });
});
```

**ğŸ”¸ Promiseé“¾å¤ªé•¿**
```javascript
// ğŸ˜ å¥½ä¸€äº›ï¼Œä½†è¿˜æ˜¯å¾ˆé•¿
getUserInfo(userId)
  .then(user => getOrderList(user.id))
  .then(orders => getOrderDetail(orders[0].id))
  .then(detail => updateUI(detail))
  .then(result => console.log('å®Œæˆäº†'))
  .catch(error => console.error(error));
```

**ğŸ”¸ async/awaitæ¸…çˆ½**
```javascript
// ğŸ˜Š çœ‹èµ·æ¥èˆ’æœå¤šäº†
async function processUser(userId) {
  try {
    const user = await getUserInfo(userId);
    const orders = await getOrderList(user.id);
    const detail = await getOrderDetail(orders[0].id);
    const result = await updateUI(detail);
    console.log('å®Œæˆäº†');
  } catch (error) {
    console.error(error);
  }
}
```

### 2.2 å¸¦æ¥çš„å¥½å¤„


```
âœ… ä»£ç æ›´å®¹æ˜“è¯»æ‡‚
âœ… é”™è¯¯å¤„ç†æ›´ç®€å•  
âœ… è°ƒè¯•æ›´æ–¹ä¾¿
âœ… ç»´æŠ¤æ›´å®¹æ˜“
âœ… æ–°æ‰‹æ›´å¥½å­¦
```

---

## 3. ğŸ”§ asyncå‡½æ•°æ€ä¹ˆç”¨


### 3.1 åŸºç¡€è¯­æ³•


**æ­¥éª¤å¾ˆç®€å•**ï¼šåœ¨æ™®é€šå‡½æ•°å‰é¢åŠ ä¸Š `async`

```javascript
// æ™®é€šå‡½æ•°
function normalFunction() {
  return "Hello";
}

// asyncå‡½æ•°
async function asyncFunction() {
  return "Hello";
}

console.log(normalFunction());     // "Hello"
console.log(asyncFunction());      // Promise {<fulfilled>: "Hello"}
```

### 3.2 ä¸åŒçš„å†™æ³•


```javascript
// 1. å‡½æ•°å£°æ˜
async function getData() {
  return "æ•°æ®";
}

// 2. ç®­å¤´å‡½æ•°
const getData = async () => {
  return "æ•°æ®";
};

// 3. å¯¹è±¡æ–¹æ³•
const api = {
  async getData() {
    return "æ•°æ®";
  }
};

// 4. åŒ¿åå‡½æ•°
button.onclick = async function() {
  const data = await fetch('/api');
  console.log(data);
};
```

### 3.3 asyncå‡½æ•°çš„ç‰¹ç‚¹


**ğŸ”¸ æ€»æ˜¯è¿”å›Promise**

```javascript
async function test() {
  return "hello";  // è¿™é‡Œè¿”å›æ™®é€šå€¼
}

// ä½†å®é™…ä¸Šå¾—åˆ°çš„æ˜¯Promise
test().then(result => {
  console.log(result); // "hello"
});

// ç­‰ä»·äº
function test() {
  return Promise.resolve("hello");
}
```

**ğŸ”¸ å¯ä»¥åœ¨é‡Œé¢ä½¿ç”¨await**

```javascript
async function fetchData() {
  // åªæœ‰asyncå‡½æ•°é‡Œæ‰èƒ½ç”¨await
  const response = await fetch('/api/data');
  const data = await response.json();
  return data;
}
```

### 3.4 è°ƒç”¨asyncå‡½æ•°


```javascript
async function getUserName() {
  return "å¼ ä¸‰";
}

// æ–¹å¼1ï¼šå½“Promiseç”¨
getUserName().then(name => {
  console.log('ç”¨æˆ·åï¼š', name);
});

// æ–¹å¼2ï¼šåœ¨å¦ä¸€ä¸ªasyncå‡½æ•°ä¸­await
async function showUser() {
  const name = await getUserName();
  console.log('ç”¨æˆ·åï¼š', name);
}

// æ–¹å¼3ï¼šé¡¶å±‚awaitï¼ˆæ–°è¯­æ³•ï¼Œä¸æ˜¯æ‰€æœ‰åœ°æ–¹éƒ½æ”¯æŒï¼‰
// const name = await getUserName();
```

---

## 4. â³ awaitå…³é”®å­—æ€ä¹ˆç”¨


### 4.1 awaitçš„ä½œç”¨


**ç®€å•ç†è§£**ï¼š`await` = "ç­‰ç­‰ï¼Œç­‰è¿™ä¸ªPromiseå®Œæˆå†ç»§ç»­"

```javascript
async function example() {
  console.log('1. å¼€å§‹');
  
  const result = await fetch('/api/data'); // æš‚åœåœ¨è¿™é‡Œï¼Œç­‰è¯·æ±‚å®Œæˆ
  
  console.log('2. è¯·æ±‚å®Œæˆ'); // è¯·æ±‚å®Œæˆåæ‰æ‰§è¡Œè¿™è¡Œ
  return result;
}
```

### 4.2 awaitçš„è§„åˆ™


**ğŸ“‹ é‡è¦è§„åˆ™ï¼ˆå¿…é¡»è®°ä½ï¼‰**ï¼š

1. **åªèƒ½åœ¨asyncå‡½æ•°é‡Œä½¿ç”¨**
2. **awaitåé¢é€šå¸¸æ˜¯Promise**
3. **awaitä¼šæš‚åœå‡½æ•°æ‰§è¡Œ**

```javascript
// âœ… æ­£ç¡®ç”¨æ³•
async function correct() {
  const data = await fetch('/api');
  return data;
}

// âŒ é”™è¯¯ç”¨æ³•
function wrong() {
  const data = await fetch('/api'); // æŠ¥é”™ï¼ä¸åœ¨asyncå‡½æ•°é‡Œ
  return data;
}
```

### 4.3 awaitç­‰å¾…ä»€ä¹ˆ


```javascript
async function testAwait() {
  // 1. ç­‰å¾…Promiseï¼ˆæœ€å¸¸ç”¨ï¼‰
  const response = await fetch('/api/user');
  
  // 2. ç­‰å¾…æ™®é€šå€¼ï¼ˆç«‹å³è¿”å›ï¼‰
  const name = await "å¼ ä¸‰";          // ç›´æ¥å¾—åˆ° "å¼ ä¸‰"
  const age = await 25;               // ç›´æ¥å¾—åˆ° 25
  
  // 3. ç­‰å¾…å‡½æ•°è°ƒç”¨
  const result = await someFunction();
  
  console.log(response, name, age, result);
}
```

### 4.4 awaitçš„æ‰§è¡Œæµç¨‹


```javascript
async function stepByStep() {
  console.log('æ­¥éª¤1ï¼šå¼€å§‹æ‰§è¡Œ');
  
  console.log('æ­¥éª¤2ï¼šå¼€å§‹ç½‘ç»œè¯·æ±‚');
  const response = await fetch('/api/data'); // æš‚åœåœ¨è¿™é‡Œ
  
  console.log('æ­¥éª¤3ï¼šç½‘ç»œè¯·æ±‚å®Œæˆ');
  const data = await response.json(); // å†æ¬¡æš‚åœ
  
  console.log('æ­¥éª¤4ï¼šæ•°æ®è§£æå®Œæˆ');
  return data;
}

/*
æ‰§è¡Œé¡ºåºï¼š
æ­¥éª¤1ï¼šå¼€å§‹æ‰§è¡Œ
æ­¥éª¤2ï¼šå¼€å§‹ç½‘ç»œè¯·æ±‚
(ç­‰å¾…ç½‘ç»œè¯·æ±‚...)
æ­¥éª¤3ï¼šç½‘ç»œè¯·æ±‚å®Œæˆ  
(ç­‰å¾…JSONè§£æ...)
æ­¥éª¤4ï¼šæ•°æ®è§£æå®Œæˆ
*/
```

---

## 5. ğŸš¨ é”™è¯¯å¤„ç†æ€ä¹ˆåš


### 5.1 ç”¨try/catchå¤„ç†é”™è¯¯


**åŸºæœ¬æ¨¡å¼**ï¼šæŠŠå¯èƒ½å‡ºé”™çš„awaitæ“ä½œæ”¾åœ¨tryé‡Œ

```javascript
async function safeRequest() {
  try {
    const response = await fetch('/api/user');
    const data = await response.json();
    console.log('æˆåŠŸè·å–æ•°æ®ï¼š', data);
    return data;
  } catch (error) {
    console.log('å‡ºé”™äº†ï¼š', error.message);
    return null; // è¿”å›é»˜è®¤å€¼
  }
}
```

### 5.2 å®é™…åœºæ™¯çš„é”™è¯¯å¤„ç†


**ğŸ”¸ ç½‘ç»œè¯·æ±‚é”™è¯¯**
```javascript
async function getUserInfo(userId) {
  try {
    const response = await fetch(`/api/users/${userId}`);
    
    // æ£€æŸ¥å“åº”çŠ¶æ€
    if (!response.ok) {
      throw new Error(`è¯·æ±‚å¤±è´¥ï¼š${response.status}`);
    }
    
    const user = await response.json();
    return user;
  } catch (error) {
    if (error.message.includes('Failed to fetch')) {
      console.log('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ');
    } else {
      console.log('è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥ï¼š', error.message);
    }
    return null;
  }
}
```

**ğŸ”¸ å¤šä¸ªæ“ä½œçš„é”™è¯¯å¤„ç†**
```javascript
async function loadUserData(userId) {
  try {
    // å¦‚æœä»»ä½•ä¸€ä¸ªå¤±è´¥ï¼Œéƒ½ä¼šè·³åˆ°catch
    const user = await fetch(`/api/users/${userId}`);
    const orders = await fetch(`/api/users/${userId}/orders`);
    const settings = await fetch(`/api/users/${userId}/settings`);
    
    return {
      user: await user.json(),
      orders: await orders.json(),
      settings: await settings.json()
    };
  } catch (error) {
    console.log('åŠ è½½ç”¨æˆ·æ•°æ®å¤±è´¥ï¼š', error.message);
    
    // è¿”å›é»˜è®¤æ•°æ®
    return {
      user: null,
      orders: [],
      settings: {}
    };
  }
}
```

### 5.3 finallyçš„ä½¿ç”¨


**ç”¨é€”**ï¼šæ— è®ºæˆåŠŸå¤±è´¥éƒ½è¦æ‰§è¡Œçš„ä»£ç 

```javascript
async function uploadFile(file) {
  // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
  showLoading(true);
  
  try {
    const formData = new FormData();
    formData.append('file', file);
    
    const response = await fetch('/api/upload', {
      method: 'POST',
      body: formData
    });
    
    const result = await response.json();
    showMessage('ä¸Šä¼ æˆåŠŸï¼');
    return result;
    
  } catch (error) {
    showMessage('ä¸Šä¼ å¤±è´¥ï¼š' + error.message);
    throw error;
    
  } finally {
    // æ— è®ºæˆåŠŸå¤±è´¥éƒ½éšè—åŠ è½½çŠ¶æ€
    showLoading(false);
  }
}
```

---

## 6. ğŸ’¼ å®é™…å¼€å‘ä¸­çš„åº”ç”¨


### 6.1 ç™»å½•åŠŸèƒ½


```javascript
async function handleLogin(username, password) {
  const loginBtn = document.querySelector('#login-btn');
  
  try {
    // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
    loginBtn.disabled = true;
    loginBtn.textContent = 'ç™»å½•ä¸­...';
    
    // å‘é€ç™»å½•è¯·æ±‚
    const response = await fetch('/api/login', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ username, password })
    });
    
    if (!response.ok) {
      throw new Error('ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯');
    }
    
    const result = await response.json();
    
    // ä¿å­˜token
    localStorage.setItem('token', result.token);
    
    // è·³è½¬åˆ°é¦–é¡µ
    window.location.href = '/dashboard';
    
  } catch (error) {
    alert(error.message);
  } finally {
    // æ¢å¤æŒ‰é’®çŠ¶æ€
    loginBtn.disabled = false;
    loginBtn.textContent = 'ç™»å½•';
  }
}
```

### 6.2 åŠ è½½é¡µé¢æ•°æ®


```javascript
async function loadPageData() {
  try {
    // åŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚ï¼ˆå¹¶è¡Œï¼‰
    const [userResponse, postsResponse, commentsResponse] = await Promise.all([
      fetch('/api/user'),
      fetch('/api/posts'),
      fetch('/api/comments')
    ]);
    
    // è§£ææ•°æ®
    const user = await userResponse.json();
    const posts = await postsResponse.json();
    const comments = await commentsResponse.json();
    
    // æ¸²æŸ“é¡µé¢
    renderUser(user);
    renderPosts(posts);
    renderComments(comments);
    
    hideLoading();
    
  } catch (error) {
    showError('é¡µé¢åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•');
    hideLoading();
  }
}

// é¡µé¢åŠ è½½æ—¶è°ƒç”¨
window.onload = loadPageData;
```

### 6.3 è¡¨å•æäº¤


```javascript
async function submitContactForm(formData) {
  const submitBtn = document.querySelector('#submit');
  const messageDiv = document.querySelector('#message');
  
  try {
    submitBtn.disabled = true;
    submitBtn.textContent = 'æäº¤ä¸­...';
    messageDiv.textContent = '';
    
    const response = await fetch('/api/contact', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(formData)
    });
    
    if (!response.ok) {
      throw new Error('æäº¤å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
    }
    
    const result = await response.json();
    
    messageDiv.textContent = 'æäº¤æˆåŠŸï¼æˆ‘ä»¬ä¼šå°½å¿«å›å¤æ‚¨ã€‚';
    messageDiv.className = 'success';
    
    // æ¸…ç©ºè¡¨å•
    document.querySelector('#contact-form').reset();
    
  } catch (error) {
    messageDiv.textContent = error.message;
    messageDiv.className = 'error';
  } finally {
    submitBtn.disabled = false;
    submitBtn.textContent = 'æäº¤';
  }
}
```

### 6.4 åˆ†é¡µåŠ è½½


```javascript
async function loadMorePosts() {
  const loadMoreBtn = document.querySelector('#load-more');
  const postsContainer = document.querySelector('#posts');
  
  try {
    loadMoreBtn.textContent = 'åŠ è½½ä¸­...';
    loadMoreBtn.disabled = true;
    
    const page = parseInt(loadMoreBtn.dataset.page) || 1;
    const response = await fetch(`/api/posts?page=${page + 1}`);
    const posts = await response.json();
    
    if (posts.length === 0) {
      loadMoreBtn.textContent = 'æ²¡æœ‰æ›´å¤šäº†';
      return;
    }
    
    // æ·»åŠ æ–°æ–‡ç« åˆ°é¡µé¢
    posts.forEach(post => {
      const postElement = createPostElement(post);
      postsContainer.appendChild(postElement);
    });
    
    // æ›´æ–°é¡µç 
    loadMoreBtn.dataset.page = page + 1;
    
  } catch (error) {
    alert('åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•');
  } finally {
    loadMoreBtn.textContent = 'åŠ è½½æ›´å¤š';
    loadMoreBtn.disabled = false;
  }
}
```

---

## 7. ğŸ› å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ


### 7.1 å¿˜è®°ä½¿ç”¨await


**âŒ å¸¸è§é”™è¯¯**ï¼š
```javascript
async function wrong() {
  const data = fetch('/api/user'); // å¿˜è®°await
  console.log(data); // Promise {<pending>} è€Œä¸æ˜¯å®é™…æ•°æ®
  return data.name; // æŠ¥é”™ï¼Promiseæ²¡æœ‰nameå±æ€§
}
```

**âœ… æ­£ç¡®åšæ³•**ï¼š
```javascript
async function correct() {
  const response = await fetch('/api/user'); // è®°å¾—åŠ await
  const data = await response.json();        // è¿™é‡Œä¹Ÿè¦await
  console.log(data); // å®é™…çš„ç”¨æˆ·æ•°æ®
  return data.name;  // æ­£ç¡®è·å–name
}
```

### 7.2 åœ¨å¾ªç¯ä¸­é”™è¯¯ä½¿ç”¨await


**âŒ ä¸²è¡Œæ‰§è¡Œï¼ˆæ…¢ï¼‰**ï¼š
```javascript
async function slowWay(userIds) {
  const users = [];
  for (const id of userIds) {
    const user = await fetch(`/api/users/${id}`); // ä¸€ä¸ªä¸€ä¸ªç­‰å¾…
    users.push(await user.json());
  }
  return users; // å¦‚æœæœ‰10ä¸ªç”¨æˆ·ï¼Œè¦ç­‰10æ¬¡
}
```

**âœ… å¹¶è¡Œæ‰§è¡Œï¼ˆå¿«ï¼‰**ï¼š
```javascript
async function fastWay(userIds) {
  // åŒæ—¶å‘èµ·æ‰€æœ‰è¯·æ±‚
  const promises = userIds.map(id => 
    fetch(`/api/users/${id}`).then(res => res.json())
  );
  
  // ç­‰å¾…æ‰€æœ‰è¯·æ±‚å®Œæˆ
  const users = await Promise.all(promises);
  return users; // åŒæ—¶ç­‰å¾…ï¼Œé€Ÿåº¦å¿«å¾ˆå¤š
}
```

### 7.3 é”™è¯¯å¤„ç†ä¸å½“


**âŒ æ²¡æœ‰å¤„ç†é”™è¯¯**ï¼š
```javascript
async function dangerous() {
  const data = await fetch('/api/data'); // å¦‚æœè¯·æ±‚å¤±è´¥ï¼Œæ•´ä¸ªå‡½æ•°éƒ½ä¼šæŠ¥é”™
  return data.json();
}
```

**âœ… æ­£ç¡®å¤„ç†é”™è¯¯**ï¼š
```javascript
async function safe() {
  try {
    const response = await fetch('/api/data');
    
    if (!response.ok) {
      throw new Error(`è¯·æ±‚å¤±è´¥: ${response.status}`);
    }
    
    return await response.json();
  } catch (error) {
    console.error('è·å–æ•°æ®å¤±è´¥:', error.message);
    return null; // è¿”å›é»˜è®¤å€¼
  }
}
```

### 7.4 åœ¨éasyncå‡½æ•°ä¸­ä½¿ç”¨await


**âŒ è¯­æ³•é”™è¯¯**ï¼š
```javascript
function wrong() {
  const data = await fetch('/api'); // SyntaxError: awaitåªèƒ½åœ¨asyncå‡½æ•°ä¸­ä½¿ç”¨
  return data;
}
```

**âœ… ä¸¤ç§è§£å†³æ–¹æ¡ˆ**ï¼š
```javascript
// æ–¹æ¡ˆ1ï¼šæŠŠå‡½æ•°æ”¹æˆasync
async function solution1() {
  const data = await fetch('/api');
  return data;
}

// æ–¹æ¡ˆ2ï¼šä½¿ç”¨.then()
function solution2() {
  return fetch('/api').then(response => response.json());
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»è®°ä½çš„å…³é”®ç‚¹


```
ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ
â€¢ asyncï¼šå‘Šè¯‰JavaScript"è¿™ä¸ªå‡½æ•°é‡Œæœ‰å¼‚æ­¥æ“ä½œ"
â€¢ awaitï¼šå‘Šè¯‰JavaScript"ç­‰ç­‰ï¼Œç­‰è¿™ä¸ªæ“ä½œå®Œæˆ"
â€¢ è®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç 

ğŸ”§ åŸºæœ¬è¯­æ³•
â€¢ async function name() { }
â€¢ const result = await promise;
â€¢ try/catchå¤„ç†é”™è¯¯

ğŸš¨ é‡è¦è§„åˆ™
â€¢ awaitåªèƒ½åœ¨asyncå‡½æ•°é‡Œä½¿ç”¨
â€¢ asyncå‡½æ•°æ€»æ˜¯è¿”å›Promise
â€¢ awaitä¼šæš‚åœå‡½æ•°æ‰§è¡Œï¼Œç›´åˆ°Promiseå®Œæˆ
```

### 8.2 å®ç”¨å¼€å‘æ¨¡å¼


**ğŸ”¸ åŸºç¡€è¯·æ±‚æ¨¡å¼**
```javascript
async function fetchData(url) {
  try {
    const response = await fetch(url);
    if (!response.ok) throw new Error('è¯·æ±‚å¤±è´¥');
    return await response.json();
  } catch (error) {
    console.error(error.message);
    return null;
  }
}
```

**ğŸ”¸ å¹¶è¡Œè¯·æ±‚æ¨¡å¼**
```javascript
async function fetchMultiple() {
  try {
    const [data1, data2, data3] = await Promise.all([
      fetch('/api/data1'),
      fetch('/api/data2'),
      fetch('/api/data3')
    ]);
    return { data1, data2, data3 };
  } catch (error) {
    console.error('æ‰¹é‡è¯·æ±‚å¤±è´¥:', error);
    return {};
  }
}
```

**ğŸ”¸ å¸¦UIçŠ¶æ€çš„æ“ä½œæ¨¡å¼**
```javascript
async function actionWithUI(action) {
  showLoading(true);
  try {
    const result = await action();
    showSuccess('æ“ä½œæˆåŠŸ');
    return result;
  } catch (error) {
    showError('æ“ä½œå¤±è´¥: ' + error.message);
  } finally {
    showLoading(false);
  }
}
```

### 8.3 æœ€ä½³å®è·µå»ºè®®


```
âœ… æ¨èåšæ³•ï¼š
â€¢ æ€»æ˜¯ç”¨try/catchåŒ…è£¹awaitæ“ä½œ
â€¢ å¤šä¸ªç‹¬ç«‹è¯·æ±‚ç”¨Promise.all()å¹¶è¡Œå¤„ç†
â€¢ ç»™ç”¨æˆ·æ˜ç¡®çš„åŠ è½½å’Œé”™è¯¯æç¤º
â€¢ åœ¨finallyä¸­æ¸…ç†UIçŠ¶æ€

âŒ é¿å…åšæ³•ï¼š
â€¢ å¿˜è®°ä½¿ç”¨awaitå…³é”®å­—
â€¢ åœ¨å¾ªç¯ä¸­ä¸²è¡Œç­‰å¾…å¼‚æ­¥æ“ä½œ
â€¢ ä¸å¤„ç†å¼‚æ­¥æ“ä½œçš„é”™è¯¯
â€¢ åœ¨éasyncå‡½æ•°ä¸­ä½¿ç”¨await
```

### 8.4 ä¸ºä»€ä¹ˆè¦å­¦ä¼šasync/await


```
ç°ä»£å‰ç«¯å¼€å‘çš„æ ‡é…ï¼š
â€¢ å‡ ä¹æ‰€æœ‰çš„ç½‘ç»œè¯·æ±‚éƒ½ä¼šç”¨åˆ°
â€¢ æ¯”Promise.then()æ›´å®¹æ˜“ç†è§£å’Œç»´æŠ¤
â€¢ è°ƒè¯•å’Œæµ‹è¯•æ›´æ–¹ä¾¿
â€¢ å›¢é˜Ÿåä½œä¸­çš„ä»£ç æ›´æ˜“è¯»

å®é™…å¼€å‘ä»·å€¼ï¼š
â€¢ ç™»å½•æ³¨å†ŒåŠŸèƒ½
â€¢ æ•°æ®åŠ è½½å’Œå±•ç¤º  
â€¢ è¡¨å•æäº¤å¤„ç†
â€¢ æ–‡ä»¶ä¸Šä¼ ä¸‹è½½
â€¢ å®æ—¶æ•°æ®æ›´æ–°
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
asyncå£°æ˜å‡½æ•°æœ‰å¼‚æ­¥ï¼Œ
awaitç­‰å¾…Promiseå®Œæˆï¼Œ
try/catché”™è¯¯è¦å¤„ç†ï¼Œ
ä»£ç æ¸…æ™°åˆå¥½æ‡‚ï¼
```