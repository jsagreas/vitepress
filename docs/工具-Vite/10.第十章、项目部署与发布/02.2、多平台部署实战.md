---
title: 2、多平台部署实战
---
## 📚 目录

1. [部署基础概念](#1-部署基础概念)
2. [传统服务器部署](#2-传统服务器部署)
3. [云平台部署](#3-云平台部署)
4. [企业级部署方案](#4-企业级部署方案)
5. [域名与安全配置](#5-域名与安全配置)
6. [核心要点总结](#6-核心要点总结)

---

## 1. 🚀 部署基础概念


### 1.1 什么是项目部署

**部署就是把你本地开发的网站发布到网上，让别人也能访问**

```
本地开发阶段：
你的电脑 → http://localhost:3000 → 只有你能看到

部署上线阶段：
服务器 → https://你的域名.com → 全世界都能访问
```

**🔸 部署的本质**
- **静态文件服务**：把HTML、CSS、JS文件放到服务器上
- **文件托管**：服务器帮你保存文件，并提供访问服务
- **域名访问**：通过网址就能访问你的网站

### 1.2 Vite构建产物理解

**Vite开发时和部署时是完全不同的**

```
开发模式（npm run dev）：
- 文件实时编译，边改边看效果
- 有热更新、开发服务器等功能
- 只能在你电脑上访问

生产模式（npm run build）：
- 把所有文件打包压缩成最终版本
- 生成dist文件夹，里面就是要部署的文件
- 这些文件可以放到任何服务器上
```

**💡 构建产物结构**
```
dist/
├── index.html          ← 网站首页
├── assets/
│   ├── index-abc123.js  ← 打包后的JS文件（带版本号）
│   ├── index-def456.css ← 打包后的CSS文件
│   └── logo-xyz789.png  ← 图片资源
└── favicon.ico         ← 网站图标
```

### 1.3 静态文件服务器概念

**静态文件服务器就像一个文件管家**

```
你把文件给它：上传HTML、CSS、JS等文件
它帮你保管：存储在服务器硬盘上
别人要看时：通过网址访问，服务器就把文件发给他们

就像开了个网上图书馆：
- 你把书（文件）放进去
- 别人输入图书馆地址就能借书（访问文件）
```

**🔸 静态 vs 动态的区别**
- **静态网站**：文件内容固定，像看电子书一样
- **动态网站**：内容会变化，像聊天软件一样需要服务器程序处理

---

## 2. 🖥️ 传统服务器部署


### 2.1 部署流程概述

**传统部署就是把文件放到自己的服务器上**

```
第1步：构建项目
npm run build  → 生成dist文件夹

第2步：上传文件  
把dist里的文件上传到服务器

第3步：配置Web服务器
让Nginx或Apache知道怎么处理这些文件

第4步：访问测试
通过域名或IP地址访问网站
```

### 2.2 Nginx部署配置详解


**🔸 什么是Nginx**
- **Nginx是一个Web服务器软件**，就像网站的接待员
- 当有人访问你的网站时，Nginx负责找到对应文件并发送给访问者
- 它还能处理很多访问请求，性能很好

**⚡ Nginx配置文件示例**
```nginx
server {
    listen 80;                          # 监听80端口（HTTP标准端口）
    server_name your-domain.com;        # 你的域名
    root /var/www/your-site;            # 网站文件存放位置
    index index.html;                   # 首页文件名
    
    # 处理单页应用路由
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    # 静态资源缓存优化
    location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
        expires 1y;                     # 缓存1年
        add_header Cache-Control "public, immutable";
    }
}
```

**📋 配置文件各部分含义**
- `listen 80`：监听80端口，这是网页访问的标准端口
- `server_name`：你的域名，访问这个域名就会找到这个配置
- `root`：网站文件放在服务器的哪个文件夹
- `try_files`：处理Vue路由，确保刷新页面不会404

### 2.3 Apache服务器配置

**Apache也是一个Web服务器，功能和Nginx类似**

**.htaccess配置文件**
```apache
# 启用重写模块
RewriteEngine On

# 处理单页应用路由
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.html [L]

# 静态资源缓存
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType text/css "access plus 1 year"
    ExpiresByType application/javascript "access plus 1 year"
    ExpiresByType image/* "access plus 1 year"
</IfModule>
```

**🔧 部署步骤**
```bash
# 1. 构建项目
npm run build

# 2. 上传文件到服务器（使用scp命令）
scp -r dist/* user@your-server:/var/www/html/

# 3. 设置文件权限
chmod -R 755 /var/www/html/

# 4. 重启Web服务器
sudo systemctl restart nginx
# 或者
sudo systemctl restart apache2
```

---

## 3. ☁️ 云平台部署


### 3.1 云平台部署的优势

**云平台就像租房子，比自己买房省事多了**

```
传统服务器部署：
- 需要自己买服务器（贵）
- 自己配置软件（复杂）
- 自己维护更新（累）

云平台部署：
- 免费或便宜
- 自动配置好一切
- 自动更新维护
```

### 3.2 Vercel部署流程


**🔸 什么是Vercel**
- **专门为前端项目设计的云平台**
- 特点：**免费、快速、自动部署**
- 最适合React、Vue等前端框架

**⚡ Vercel部署步骤**
```
第1步：注册Vercel账号
去 https://vercel.com 注册（推荐用GitHub账号）

第2步：连接GitHub仓库
- 把你的项目推送到GitHub
- 在Vercel中导入这个仓库

第3步：自动部署
- Vercel自动识别是Vite项目
- 自动运行 npm run build
- 自动生成访问地址

第4步：每次提交代码都会自动更新
推送代码到GitHub → Vercel自动重新部署
```

**🔧 Vercel配置文件（可选）**
```json
// vercel.json
{
  "buildCommand": "npm run build",
  "outputDirectory": "dist",
  "framework": "vite"
}
```

### 3.3 Netlify部署配置


**🔸 什么是Netlify**
- **另一个优秀的前端部署平台**
- 特点：**拖拽部署、表单处理、函数功能**

**📁 两种部署方式**

**方式1：拖拽部署（最简单）**
```
1. 本地运行 npm run build
2. 把dist文件夹直接拖到Netlify网站上
3. 几秒钟就部署好了
4. 获得一个随机域名，可以立即访问
```

**方式2：Git自动部署**
```
1. 连接GitHub仓库
2. 设置构建命令：npm run build
3. 设置发布目录：dist
4. 每次推送代码自动部署
```

**⚙️ Netlify配置文件**
```toml
# netlify.toml
[build]
  command = "npm run build"
  publish = "dist"

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
```

### 3.4 GitHub Pages发布


**🔸 什么是GitHub Pages**
- **GitHub提供的免费静态网站托管**
- 特点：**完全免费、与GitHub集成、适合开源项目**

**🚀 自动部署配置**
```yaml
# .github/workflows/deploy.yml
name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ]

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    
    - name: Setup Node.js
      uses: actions/setup-node@v2
      with:
        node-version: '16'
        
    - name: Install dependencies
      run: npm install
      
    - name: Build project
      run: npm run build
      
    - name: Deploy to GitHub Pages
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./dist
```

**📋 GitHub Pages设置步骤**
```
1. 项目设置 → Pages
2. 选择源：GitHub Actions
3. 提交上面的配置文件
4. 推送代码，自动部署
5. 访问：https://你的用户名.github.io/仓库名
```

---

## 4. 🏢 企业级部署方案


### 4.1 阿里云/腾讯云部署


**🔸 云服务器部署特点**
- **更多控制权**：可以完全自定义服务器环境
- **更好性能**：专用资源，访问速度快
- **企业级功能**：监控、备份、安全防护

**⚡ 云服务器部署流程**
```
第1步：购买云服务器
选择配置：2核4G内存起步，选择操作系统（推荐Ubuntu）

第2步：连接服务器
ssh root@你的服务器IP

第3步：安装环境
sudo apt update
sudo apt install nginx nodejs npm

第4步：上传项目文件
scp -r dist/* root@服务器IP:/var/www/html/

第5步：配置Nginx
编辑 /etc/nginx/sites-available/default

第6步：启动服务
sudo systemctl start nginx
sudo systemctl enable nginx
```

### 4.2 Docker容器化部署


**🔸 什么是Docker**
- **把应用和环境打包在一起的技术**
- 好处：**在任何地方都能稳定运行，环境隔离**

**📦 创建Dockerfile**
```dockerfile
# 使用Nginx作为基础镜像
FROM nginx:alpine

# 复制构建产物到Nginx目录
COPY dist/ /usr/share/nginx/html/

# 复制Nginx配置文件
COPY nginx.conf /etc/nginx/nginx.conf

# 暴露80端口
EXPOSE 80

# 启动Nginx
CMD ["nginx", "-g", "daemon off;"]
```

**🔧 Docker部署命令**
```bash
# 构建项目
npm run build

# 构建Docker镜像
docker build -t my-vite-app .

# 运行容器
docker run -d -p 80:80 my-vite-app

# 访问 http://localhost 即可看到网站
```

**🐳 Docker Compose配置**
```yaml
# docker-compose.yml
version: '3'
services:
  web:
    build: .
    ports:
      - "80:80"
    restart: unless-stopped
```

---

## 5. 🔐 域名与安全配置


### 5.1 域名绑定和配置


**🔸 什么是域名**
- **域名就是网站的门牌号**，比如 www.baidu.com
- 让用户不用记住复杂的IP地址，直接输入好记的网址

**🌐 域名配置流程**
```
第1步：购买域名
在阿里云、腾讯云等平台购买（如：mysite.com）

第2步：获取服务器IP地址
云平台会给你一个IP地址（如：123.123.123.123）

第3步：添加DNS解析记录
类型：A记录
主机记录：@ 或 www
记录值：你的服务器IP地址

第4步：等待生效
DNS解析需要几分钟到几小时生效
```

### 5.2 DNS配置详解


**📋 常用DNS记录类型**

| 记录类型 | 作用 | 示例 |
|---------|------|------|
| **A记录** | 域名指向IP地址 | `www.mysite.com → 123.123.123.123` |
| **CNAME** | 域名指向另一个域名 | `blog.mysite.com → mysite.vercel.app` |
| **MX记录** | 邮件服务器配置 | 处理 `@mysite.com` 邮箱 |

**⚙️ DNS配置示例**
```
主域名配置：
类型：A记录
主机记录：@
记录值：123.123.123.123

www子域名配置：
类型：A记录  
主机记录：www
记录值：123.123.123.123

或者使用CNAME：
类型：CNAME
主机记录：www  
记录值：mysite.vercel.app
```

### 5.3 HTTPS证书配置


**🔸 为什么需要HTTPS**
- **安全**：数据传输加密，防止被窃取
- **信任**：浏览器显示小锁图标，用户更信任
- **SEO**：搜索引擎更喜欢HTTPS网站

**🔒 免费SSL证书获取**

**方式1：Let's Encrypt（推荐）**
```bash
# 安装certbot
sudo apt install certbot python3-certbot-nginx

# 自动获取并配置证书
sudo certbot --nginx -d your-domain.com

# 自动续期（证书3个月过期）
sudo crontab -e
# 添加：0 12 * * * /usr/bin/certbot renew --quiet
```

**方式2：云平台免费证书**
```
阿里云SSL证书：
1. 进入SSL证书控制台
2. 申请免费证书（DV类型）
3. 验证域名所有权
4. 下载证书文件
5. 配置到Nginx/Apache
```

**⚡ Nginx HTTPS配置**
```nginx
server {
    listen 443 ssl http2;
    server_name your-domain.com;
    
    # SSL证书配置
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/private.key;
    
    # SSL安全配置
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384;
    
    # 网站文件配置
    root /var/www/html;
    index index.html;
    
    location / {
        try_files $uri $uri/ /index.html;
    }
}

# HTTP自动跳转到HTTPS
server {
    listen 80;
    server_name your-domain.com;
    return 301 https://$server_name$request_uri;
}
```

---

## 6. 📋 核心要点总结


### 6.1 部署方式选择指南


**🎯 新手推荐顺序**
```
1️⃣ Vercel/Netlify（免费，最简单）
   适合：个人项目、学习练习

2️⃣ GitHub Pages（免费，Git集成）
   适合：开源项目、技术博客

3️⃣ 云服务器（付费，更多控制）
   适合：商业项目、企业应用

4️⃣ Docker容器（复杂，最灵活）
   适合：大型项目、微服务架构
```

### 6.2 部署流程标准化


**📋 通用部署检查清单**
- [x] **本地构建测试**：`npm run build` 成功
- [x] **预览构建结果**：`npm run preview` 验证
- [x] **选择部署平台**：根据需求选择合适平台
- [x] **配置域名解析**：设置A记录或CNAME
- [x] **配置HTTPS证书**：确保网站安全
- [x] **测试访问功能**：验证所有功能正常

### 6.3 常见问题解决


**❓ 刷新页面404错误**
```
原因：单页应用路由问题
解决：配置服务器重定向所有请求到index.html
```

**❓ 静态资源加载失败**
```
原因：资源路径配置错误
解决：检查vite.config.js中的base配置
```

**❓ 域名解析不生效**
```
原因：DNS缓存或配置错误
解决：等待24小时或检查DNS记录配置
```

### 6.4 性能优化建议


**⚡ 部署优化策略**
- **CDN加速**：使用云平台CDN分发静态资源
- **Gzip压缩**：服务器开启文件压缩
- **缓存策略**：合理设置静态资源缓存时间
- **图片优化**：使用WebP格式，适当压缩

**🔧 Vite构建优化**
```js
// vite.config.js
export default {
  build: {
    minify: 'terser',           // 代码压缩
    chunkSizeWarningLimit: 1000, // 包大小警告阈值
    rollupOptions: {
      output: {
        manualChunks: {         // 手动分包
          vendor: ['vue', 'vue-router'],
          utils: ['lodash', 'moment']
        }
      }
    }
  }
}
```

**核心记忆要点**：
- **部署本质**：把本地代码发布到网上让别人访问
- **选择策略**：新手用云平台，企业用云服务器
- **安全必备**：域名+HTTPS证书是标配
- **优化重点**：缓存、压缩、CDN提升访问速度