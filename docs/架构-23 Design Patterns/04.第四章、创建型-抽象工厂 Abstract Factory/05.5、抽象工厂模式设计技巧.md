---
title: 5ã€æŠ½è±¡å·¥å‚æ¨¡å¼è®¾è®¡æŠ€å·§
---
## ğŸ“š ç›®å½•

1. [äº§å“æ—è§„åˆ’æ–¹æ³•](#1-äº§å“æ—è§„åˆ’æ–¹æ³•)
2. [å·¥å‚å±‚æ¬¡ç»“æ„](#2-å·¥å‚å±‚æ¬¡ç»“æ„)
3. [æ‰©å±•æ€§ä¿è¯æœºåˆ¶](#3-æ‰©å±•æ€§ä¿è¯æœºåˆ¶)
4. [ç‰ˆæœ¬å…¼å®¹æ€§å¤„ç†](#4-ç‰ˆæœ¬å…¼å®¹æ€§å¤„ç†)
5. [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#5-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ äº§å“æ—è§„åˆ’æ–¹æ³•


### 1.1 ä»€ä¹ˆæ˜¯äº§å“æ—è§„åˆ’


**é€šä¿—ç†è§£**ï¼šå°±åƒè§„åˆ’ä¸€ä¸ªæ‰‹æœºäº§å“çº¿ï¼Œä½ éœ€è¦è€ƒè™‘ä¸åŒç³»åˆ—(iPhoneã€åä¸ºã€å°ç±³)ï¼Œæ¯ä¸ªç³»åˆ—éƒ½æœ‰è‡ªå·±çš„å±å¹•ã€ç”µæ± ã€æ‘„åƒå¤´ç­‰ç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶è¦é…å¥—ä½¿ç”¨ã€‚

```
äº§å“æ—è§„åˆ’æ€è·¯ï¼š
ä¸€ä¸ªå“ç‰Œ = ä¸€ä¸ªäº§å“æ—
ä¸€ä¸ªäº§å“æ—åŒ…å«å¤šä¸ªç›¸å…³äº§å“
è¿™äº›äº§å“è¦äº’ç›¸é…åˆä½¿ç”¨

ç°å®ä¾‹å­ï¼š
è‹¹æœç”Ÿæ€ â†’ iPhone + MacBook + iPad + AirPods
åä¸ºç”Ÿæ€ â†’ åä¸ºæ‰‹æœº + åä¸ºç”µè„‘ + åä¸ºå¹³æ¿ + åä¸ºè€³æœº
```

### 1.2 äº§å“æ—çš„è¯†åˆ«åŸåˆ™


**ğŸ”¸ ç›¸å…³æ€§åŸåˆ™**
```
åŒä¸€äº§å“æ—çš„äº§å“åº”è¯¥ï¼š
âœ… åŠŸèƒ½ä¸Šç›¸äº’é…åˆ
âœ… é£æ ¼ä¸Šä¿æŒä¸€è‡´
âœ… æŠ€æœ¯ä¸Šç›¸äº’å…¼å®¹
âœ… ä½¿ç”¨åœºæ™¯ç›¸å…³

é”™è¯¯ç¤ºä¾‹ï¼š
å°†"æ¸¸æˆæ‰‹æŸ„"å’Œ"åŠå…¬æ¤…"æ”¾åœ¨åŒä¸€äº§å“æ— âŒ
æ­£ç¡®ç¤ºä¾‹ï¼š
å°†"æ¸¸æˆæ‰‹æŸ„"å’Œ"æ¸¸æˆè€³æœº"æ”¾åœ¨åŒä¸€äº§å“æ— âœ…
```

**ğŸ”¸ æŠ½è±¡å±‚æ¬¡åŸåˆ™**
```
äº§å“æŠ½è±¡çº§åˆ«è¦ç»Ÿä¸€ï¼š

æ­£ç¡®çš„æŠ½è±¡å±‚æ¬¡ï¼š
â””â”€â”€ UIç»„ä»¶æ—
    â”œâ”€â”€ æŒ‰é’® Button
    â”œâ”€â”€ è¾“å…¥æ¡† Input  
    â””â”€â”€ ä¸‹æ‹‰æ¡† Select

é”™è¯¯çš„æŠ½è±¡å±‚æ¬¡ï¼š
â””â”€â”€ æ··åˆç»„ä»¶æ—
    â”œâ”€â”€ æŒ‰é’® Button
    â”œâ”€â”€ ç™»å½•é¡µé¢ LoginPage âŒ (å±‚æ¬¡å¤ªé«˜)
    â””â”€â”€ åƒç´ ç‚¹ Pixel âŒ (å±‚æ¬¡å¤ªä½)
```

### 1.3 äº§å“æ—è§„åˆ’å®æˆ˜æ­¥éª¤


**æ­¥éª¤1ï¼šä¸šåŠ¡åœºæ™¯åˆ†æ**
```
åˆ†æé—®é¢˜ï¼šæˆ‘è¦è§£å†³ä»€ä¹ˆä¸šåŠ¡é—®é¢˜ï¼Ÿ
è¯†åˆ«å˜åŒ–ï¼šå“ªäº›åœ°æ–¹ç»å¸¸éœ€è¦æ•´ä½“åˆ‡æ¢ï¼Ÿ

å®é™…ä¾‹å­ï¼š
é—®é¢˜ï¼šå¼€å‘è·¨å¹³å°åº”ç”¨ï¼Œéœ€è¦é€‚é…ä¸åŒæ“ä½œç³»ç»Ÿ
å˜åŒ–ç‚¹ï¼šWindowsé£æ ¼ vs MacOSé£æ ¼ vs Linuxé£æ ¼
ç»“è®ºï¼šæ¯ç§é£æ ¼å°±æ˜¯ä¸€ä¸ªäº§å“æ—
```

**æ­¥éª¤2ï¼šäº§å“æŠ½è±¡æå–**
```
ä»å…·ä½“åˆ°æŠ½è±¡çš„æ€ç»´è¿‡ç¨‹ï¼š

å…·ä½“äº§å“ï¼šWindowsæŒ‰é’®ã€MacOSæŒ‰é’®ã€LinuxæŒ‰é’®
æŠ½è±¡äº§å“ï¼šButtonæ¥å£

å…·ä½“äº§å“ï¼šWindowså¯¹è¯æ¡†ã€MacOSå¯¹è¯æ¡†ã€Linuxå¯¹è¯æ¡†  
æŠ½è±¡äº§å“ï¼šDialogæ¥å£

å…·ä½“äº§å“ï¼šWindowsèœå•ã€MacOSèœå•ã€Linuxèœå•
æŠ½è±¡äº§å“ï¼šMenuæ¥å£
```

**æ­¥éª¤3ï¼šæ—ç¾¤å…³ç³»æ¢³ç†**

```
äº§å“æ—å…³ç³»å›¾ï¼š

Windowsæ—ç¾¤          MacOSæ—ç¾¤           Linuxæ—ç¾¤
    â”‚                   â”‚                   â”‚
    â”œâ”€â”€ WinButton       â”œâ”€â”€ MacButton       â”œâ”€â”€ LinuxButton
    â”œâ”€â”€ WinDialog       â”œâ”€â”€ MacDialog       â”œâ”€â”€ LinuxDialog
    â””â”€â”€ WinMenu         â””â”€â”€ MacMenu         â””â”€â”€ LinuxMenu
    
ç‰¹ç‚¹ï¼šåŒä¸€åˆ—çš„äº§å“é£æ ¼ç»Ÿä¸€ï¼Œèƒ½å¤Ÿé…åˆä½¿ç”¨
```

---

## 2. ğŸ—ï¸ å·¥å‚å±‚æ¬¡ç»“æ„


### 2.1 å·¥å‚å±‚æ¬¡çš„è®¾è®¡åŸç†


**é€šä¿—è§£é‡Š**ï¼šå°±åƒå»ºç«‹ç”Ÿäº§çº¿ï¼Œæ€»å‚è´Ÿè´£åˆ¶å®šæ ‡å‡†ï¼Œåˆ†å‚è´Ÿè´£å…·ä½“ç”Ÿäº§ã€‚æ¯ä¸ªåˆ†å‚éƒ½æŒ‰ç…§æ€»å‚çš„æ ‡å‡†æ¥ç”Ÿäº§è‡ªå·±çš„äº§å“ç³»åˆ—ã€‚

```
å·¥å‚å±‚æ¬¡ç»“æ„ç±»æ¯”ï¼š

æ±½è½¦æ€»å‚ï¼ˆæŠ½è±¡å·¥å‚ï¼‰
    â”‚
    â”œâ”€â”€ å®šä¹‰ç”Ÿäº§æ ‡å‡†
    â”œâ”€â”€ è§„å®šäº§å“ç±»å‹
    â””â”€â”€ åˆ¶å®šæ¥å£è§„èŒƒ
    
å¥”é©°åˆ†å‚ï¼ˆå…·ä½“å·¥å‚ï¼‰    å®é©¬åˆ†å‚ï¼ˆå…·ä½“å·¥å‚ï¼‰
    â”‚                      â”‚
    â”œâ”€â”€ å¥”é©°å‘åŠ¨æœº          â”œâ”€â”€ å®é©¬å‘åŠ¨æœº
    â”œâ”€â”€ å¥”é©°è½®èƒ            â”œâ”€â”€ å®é©¬è½®èƒ
    â””â”€â”€ å¥”é©°åº§æ¤…            â””â”€â”€ å®é©¬åº§æ¤…
```

### 2.2 å•å±‚å·¥å‚ç»“æ„


**ğŸ”¸ é€‚ç”¨åœºæ™¯**ï¼šäº§å“æ—æ¯”è¾ƒç®€å•ï¼Œå˜åŒ–ä¸é¢‘ç¹

```java
// æŠ½è±¡å·¥å‚æ¥å£
interface UIFactory {
    Button createButton();
    Input createInput();
}

// å…·ä½“å·¥å‚å®ç°
class WindowsFactory implements UIFactory {
    public Button createButton() { return new WindowsButton(); }
    public Input createInput() { return new WindowsInput(); }
}

class MacFactory implements UIFactory {
    public Button createButton() { return new MacButton(); }
    public Input createInput() { return new MacInput(); }
}
```

**ä¼˜ç‚¹**ï¼šç»“æ„ç®€å•ï¼Œå®¹æ˜“ç†è§£å’Œç»´æŠ¤
**ç¼ºç‚¹**ï¼šäº§å“æ—å¤æ‚æ—¶ï¼Œå·¥å‚ç±»ä¼šå˜å¾—åºå¤§

### 2.3 å¤šå±‚å·¥å‚ç»“æ„


**ğŸ”¸ é€‚ç”¨åœºæ™¯**ï¼šäº§å“æ—å¤æ‚ï¼Œéœ€è¦è¿›ä¸€æ­¥ç»†åˆ†

```
å¤šå±‚ç»“æ„ç¤ºæ„ï¼š

æ€»å·¥å‚æ¥å£
    â”‚
    â”œâ”€â”€ åŸºç¡€ç»„ä»¶å·¥å‚ â”€â”€â”€â”€â”
    â”‚   â”œâ”€â”€ æŒ‰é’®å·¥å‚     â”‚
    â”‚   â””â”€â”€ è¾“å…¥æ¡†å·¥å‚   â”‚â”€â”€ ç¬¬ä¸€å±‚åˆ†ç±»
    â”‚                   â”‚
    â””â”€â”€ å¤æ‚ç»„ä»¶å·¥å‚ â”€â”€â”€â”€â”˜
        â”œâ”€â”€ è¡¨æ ¼å·¥å‚
        â””â”€â”€ å›¾è¡¨å·¥å‚

æ¯ä¸ªå­å·¥å‚å†åˆ†å¹³å°ï¼š
æŒ‰é’®å·¥å‚
    â”œâ”€â”€ WindowsæŒ‰é’®å·¥å‚
    â”œâ”€â”€ MacæŒ‰é’®å·¥å‚
    â””â”€â”€ LinuxæŒ‰é’®å·¥å‚
```

**å®ç°ç¤ºä¾‹**ï¼š
```java
// ç¬¬ä¸€å±‚ï¼šç»„ä»¶ç±»å‹å·¥å‚
interface ComponentFactory {
    BasicFactory getBasicFactory();
    ComplexFactory getComplexFactory();
}

// ç¬¬äºŒå±‚ï¼šå…·ä½“ç»„ä»¶å·¥å‚
interface BasicFactory {
    Button createButton();
    Input createInput();
}

// å¹³å°å®ç°
class WindowsComponentFactory implements ComponentFactory {
    public BasicFactory getBasicFactory() {
        return new WindowsBasicFactory();
    }
    
    public ComplexFactory getComplexFactory() {
        return new WindowsComplexFactory();
    }
}
```

### 2.4 å·¥å‚æ³¨å†Œæœºåˆ¶


**ç›®çš„**ï¼šè®©å·¥å‚çš„é€‰æ‹©æ›´åŠ çµæ´»ï¼Œä¸éœ€è¦ç¡¬ç¼–ç 

```java
// å·¥å‚æ³¨å†Œå™¨
class FactoryRegistry {
    private static Map<String, UIFactory> factories = new HashMap<>();
    
    // æ³¨å†Œå·¥å‚
    public static void register(String platform, UIFactory factory) {
        factories.put(platform, factory);
    }
    
    // è·å–å·¥å‚
    public static UIFactory getFactory(String platform) {
        return factories.get(platform);
    }
    
    // åˆå§‹åŒ–æ³¨å†Œ
    static {
        register("windows", new WindowsFactory());
        register("mac", new MacFactory());
        register("linux", new LinuxFactory());
    }
}
```

**ä½¿ç”¨æ–¹å¼**ï¼š
```java
// æ ¹æ®é…ç½®æˆ–è¿è¡Œç¯å¢ƒåŠ¨æ€é€‰æ‹©
String platform = System.getProperty("os.name").toLowerCase();
UIFactory factory = FactoryRegistry.getFactory(platform);
Button button = factory.createButton();
```

---

## 3. ğŸ”§ æ‰©å±•æ€§ä¿è¯æœºåˆ¶


### 3.1 æ‰©å±•æ€§çš„æ ¸å¿ƒè¦æ±‚


**é€šä¿—ç†è§£**ï¼šå°±åƒè®¾è®¡æˆ¿å­æ—¶è¦é¢„ç•™ç®¡é“ä½ç½®ï¼Œè™½ç„¶ç°åœ¨ä¸è£…ç©ºè°ƒï¼Œä½†è¦ä¸ºå°†æ¥è£…ç©ºè°ƒç•™å¥½ä½ç½®ã€‚ä»£ç ä¹Ÿä¸€æ ·ï¼Œè¦ä¸ºå°†æ¥çš„æ–°åŠŸèƒ½ç•™å¥½"æ¥å£"ã€‚

```
æ‰©å±•æ€§è¦è§£å†³çš„é—®é¢˜ï¼š

ç°çŠ¶ï¼šæ”¯æŒWindowså’ŒMacä¸¤ä¸ªå¹³å°
æœªæ¥ï¼šå¯èƒ½è¦æ”¯æŒAndroidã€iOSã€Webç­‰å¹³å°

è®¾è®¡è¦æ±‚ï¼š
âœ… æ·»åŠ æ–°å¹³å°æ—¶ï¼Œä¸ä¿®æ”¹ç°æœ‰ä»£ç 
âœ… æ–°å¹³å°çš„åŠŸèƒ½è¦å®Œæ•´
âœ… æ—§å¹³å°çš„åŠŸèƒ½ä¸å—å½±å“
```

### 3.2 å¼€é—­åŸåˆ™çš„å®è·µ


**ğŸ”¸ å¯¹æ‰©å±•å¼€æ”¾**

```java
// æŠ½è±¡å·¥å‚é¢„ç•™æ‰©å±•ç‚¹
interface UIFactory {
    // åŸºç¡€ç»„ä»¶ï¼ˆç°æœ‰åŠŸèƒ½ï¼‰
    Button createButton();
    Input createInput();
    
    // æ–°å¢ç»„ä»¶ï¼ˆæ‰©å±•åŠŸèƒ½ï¼‰
    default Slider createSlider() {
        return new DefaultSlider(); // æä¾›é»˜è®¤å®ç°
    }
    
    default DatePicker createDatePicker() {
        return new DefaultDatePicker();
    }
}
```

**ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ**
- ç”¨`default`æ–¹æ³•æä¾›é»˜è®¤å®ç°
- æ–°å·¥å‚å¯ä»¥é€‰æ‹©æ€§é‡å†™æ–°æ–¹æ³•
- æ—§å·¥å‚ä¸éœ€è¦ä¿®æ”¹å°±èƒ½ç¼–è¯‘é€šè¿‡

**ğŸ”¸ å¯¹ä¿®æ”¹å°é—­**

```java
// å®¢æˆ·ç«¯ä»£ç ä¿æŒç¨³å®š
class Application {
    private UIFactory factory;
    
    public Application(UIFactory factory) {
        this.factory = factory;
    }
    
    public void createUI() {
        // è¿™éƒ¨åˆ†ä»£ç æ°¸è¿œä¸éœ€è¦ä¿®æ”¹
        Button btn = factory.createButton();
        Input input = factory.createInput();
        
        // æ–°åŠŸèƒ½é€šè¿‡é…ç½®å†³å®šæ˜¯å¦ä½¿ç”¨
        if (needSlider()) {
            Slider slider = factory.createSlider();
        }
    }
}
```

### 3.3 ç‰ˆæœ¬æ¼”è¿›ç­–ç•¥


**ğŸ”¸ æ¸è¿›å¼æ‰©å±•**

```
ç‰ˆæœ¬1.0ï¼šåŸºç¡€ç»„ä»¶
â””â”€â”€ UIFactory v1.0
    â”œâ”€â”€ createButton()
    â””â”€â”€ createInput()

ç‰ˆæœ¬2.0ï¼šå¢åŠ é«˜çº§ç»„ä»¶
â””â”€â”€ UIFactory v2.0 (å‘ä¸‹å…¼å®¹)
    â”œâ”€â”€ createButton()     â† ä¿æŒä¸å˜
    â”œâ”€â”€ createInput()      â† ä¿æŒä¸å˜
    â”œâ”€â”€ createSlider()     â† æ–°å¢
    â””â”€â”€ createDatePicker() â† æ–°å¢

ç‰ˆæœ¬3.0ï¼šå¢åŠ å®¹å™¨ç»„ä»¶
â””â”€â”€ UIFactory v3.0 (å‘ä¸‹å…¼å®¹)
    â”œâ”€â”€ åŸºç¡€ç»„ä»¶ (v1.0åŠŸèƒ½)
    â”œâ”€â”€ é«˜çº§ç»„ä»¶ (v2.0åŠŸèƒ½)
    â””â”€â”€ å®¹å™¨ç»„ä»¶ (v3.0åŠŸèƒ½)
```

**å®ç°æŠ€å·§**ï¼š
```java
// ä½¿ç”¨æ¥å£ç»§æ‰¿ç®¡ç†ç‰ˆæœ¬
interface UIFactory_V1 {
    Button createButton();
    Input createInput();
}

interface UIFactory_V2 extends UIFactory_V1 {
    Slider createSlider();
    DatePicker createDatePicker();
}

interface UIFactory extends UIFactory_V2 {
    // å½“å‰æœ€æ–°ç‰ˆæœ¬
    Table createTable();
    Chart createChart();
}
```

### 3.4 æ–°å¹³å°æ¥å…¥æµç¨‹


**æ ‡å‡†åŒ–æ¥å…¥æ­¥éª¤**ï¼š

```
æ­¥éª¤1ï¼šåˆ†ææ–°å¹³å°ç‰¹ç‚¹
â””â”€â”€ äº†è§£å¹³å°çš„UIé£æ ¼
â””â”€â”€ ç¡®å®šéœ€è¦å®ç°çš„ç»„ä»¶
â””â”€â”€ è¯†åˆ«å¹³å°ç‰¹æœ‰åŠŸèƒ½

æ­¥éª¤2ï¼šå®ç°äº§å“ç±»
â””â”€â”€ ç»§æ‰¿æŠ½è±¡äº§å“æ¥å£
â””â”€â”€ å®ç°å¹³å°ç‰¹æœ‰é€»è¾‘
â””â”€â”€ ä¿æŒæ¥å£ä¸€è‡´æ€§

æ­¥éª¤3ï¼šåˆ›å»ºå…·ä½“å·¥å‚
â””â”€â”€ å®ç°æŠ½è±¡å·¥å‚æ¥å£
â””â”€â”€ åˆ›å»ºå¯¹åº”çš„äº§å“å®ä¾‹
â””â”€â”€ å¤„ç†å¹³å°ç‰¹æ®Šæƒ…å†µ

æ­¥éª¤4ï¼šæ³¨å†Œå’Œæµ‹è¯•
â””â”€â”€ å°†å·¥å‚æ³¨å†Œåˆ°ç³»ç»Ÿ
â””â”€â”€ è¿è¡Œå…¼å®¹æ€§æµ‹è¯•
â””â”€â”€ éªŒè¯åŠŸèƒ½å®Œæ•´æ€§
```

**å®é™…ç¤ºä¾‹**ï¼šæ–°å¢ç§»åŠ¨ç«¯æ”¯æŒ
```java
// 1. å®ç°ç§»åŠ¨ç«¯äº§å“
class MobileButton implements Button {
    public void render() {
        System.out.println("æ¸²æŸ“ç§»åŠ¨ç«¯æŒ‰é’®ï¼šè§¦æ‘¸å‹å¥½çš„å¤§æŒ‰é’®");
    }
}

// 2. åˆ›å»ºç§»åŠ¨ç«¯å·¥å‚
class MobileFactory implements UIFactory {
    public Button createButton() {
        return new MobileButton();
    }
    
    public Input createInput() {
        return new MobileInput();
    }
    
    // ç§»åŠ¨ç«¯ç‰¹æœ‰åŠŸèƒ½
    public SwipeGesture createSwipeGesture() {
        return new MobileSwipeGesture();
    }
}

// 3. æ³¨å†Œåˆ°ç³»ç»Ÿ
FactoryRegistry.register("mobile", new MobileFactory());
```

---

## 4. ğŸ”„ ç‰ˆæœ¬å…¼å®¹æ€§å¤„ç†


### 4.1 ç‰ˆæœ¬å…¼å®¹æ€§çš„é‡è¦æ€§


**ç°å®ç±»æ¯”**ï¼šå°±åƒæ‰‹æœºAppæ›´æ–°ï¼Œæ–°ç‰ˆæœ¬è¦èƒ½åœ¨æ—§æ‰‹æœºä¸Šè¿è¡Œï¼ŒåŒæ—¶æ–°æ‰‹æœºä¹Ÿè¦èƒ½è¿è¡Œæ—§ç‰ˆæœ¬Appã€‚ä»£ç æ›´æ–°ä¹Ÿè¦è€ƒè™‘å…¼å®¹æ€§ã€‚

```
å…¼å®¹æ€§é—®é¢˜åœºæ™¯ï¼š

å…¬å¸åœºæ™¯ï¼š
â”œâ”€â”€ è€é¡¹ç›®ä½¿ç”¨å·¥å‚v1.0
â”œâ”€â”€ æ–°é¡¹ç›®ä½¿ç”¨å·¥å‚v2.0  
â””â”€â”€ ç³»ç»Ÿé›†æˆæ—¶å‡ºç°å†²çª

è§£å†³æ€è·¯ï¼š
â”œâ”€â”€ å‘ä¸‹å…¼å®¹ï¼šæ–°ç‰ˆæœ¬æ”¯æŒæ—§æ¥å£
â”œâ”€â”€ å‘ä¸Šå…¼å®¹ï¼šæ—§ç‰ˆæœ¬èƒ½å¤„ç†æ–°æ•°æ®
â””â”€â”€ å¹³æ»‘è¿ç§»ï¼šé€æ­¥å‡çº§ï¼Œä¸ä¸€åˆ€åˆ‡
```

### 4.2 æ¥å£ç‰ˆæœ¬ç®¡ç†ç­–ç•¥


**ğŸ”¸ è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶**

```
ç‰ˆæœ¬å·æ ¼å¼ï¼šä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.ä¿®è®¢ç‰ˆæœ¬

ä¸»ç‰ˆæœ¬å˜åŒ–ï¼šä¸å…¼å®¹çš„æ¥å£ä¿®æ”¹
â”œâ”€â”€ 1.x.x â†’ 2.x.x
â””â”€â”€ å¯èƒ½ç ´åç°æœ‰ä»£ç 

æ¬¡ç‰ˆæœ¬å˜åŒ–ï¼šå‘ä¸‹å…¼å®¹çš„åŠŸèƒ½å¢åŠ 
â”œâ”€â”€ 1.1.x â†’ 1.2.x  
â””â”€â”€ æ—§ä»£ç ä»èƒ½å·¥ä½œ

ä¿®è®¢ç‰ˆæœ¬ï¼šå‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®å¤
â”œâ”€â”€ 1.1.1 â†’ 1.1.2
â””â”€â”€ åªä¿®å¤bugï¼Œä¸åŠ æ–°åŠŸèƒ½
```

**ğŸ”¸ æ¥å£æ¼”è¿›ç¤ºä¾‹**

```java
// ç‰ˆæœ¬1.0ï¼šåŸºç¡€æ¥å£
interface UIFactory_V1 {
    Button createButton();
    Input createInput();
}

// ç‰ˆæœ¬1.1ï¼šå‘ä¸‹å…¼å®¹çš„æ‰©å±•
interface UIFactory_V1_1 extends UIFactory_V1 {
    // æ–°å¢æ–¹æ³•æä¾›é»˜è®¤å®ç°
    default Checkbox createCheckbox() {
        return new DefaultCheckbox();
    }
}

// ç‰ˆæœ¬2.0ï¼šé‡å¤§æ›´æ–°ï¼ˆå¯èƒ½ä¸å…¼å®¹ï¼‰
interface UIFactory_V2 {
    // æ–¹æ³•ç­¾åå¯èƒ½æ”¹å˜
    Button createButton(ButtonStyle style);
    Input createInput(InputType type);
    
    // æ–°å¢åŠŸèƒ½
    Panel createPanel();
}
```

### 4.3 å‘ä¸‹å…¼å®¹çš„å®ç°æŠ€å·§


**ğŸ”¸ é€‚é…å™¨æ¨¡å¼ç»“åˆ**

```java
// æ–°æ¥å£
interface UIFactory_V2 {
    Button createButton(ButtonStyle style);
    Input createInput(InputType type);
}

// å…¼å®¹æ—§æ¥å£çš„é€‚é…å™¨
class CompatibilityAdapter implements UIFactory_V1 {
    private UIFactory_V2 newFactory;
    
    public CompatibilityAdapter(UIFactory_V2 newFactory) {
        this.newFactory = newFactory;
    }
    
    // å°†æ—§æ¥å£è°ƒç”¨è½¬æ¢ä¸ºæ–°æ¥å£è°ƒç”¨
    public Button createButton() {
        return newFactory.createButton(ButtonStyle.DEFAULT);
    }
    
    public Input createInput() {
        return newFactory.createInput(InputType.TEXT);
    }
}
```

**ä½¿ç”¨æ–¹å¼**ï¼š
```java
// æ—§ä»£ç ä¸éœ€è¦ä¿®æ”¹
UIFactory_V1 factory = new CompatibilityAdapter(new WindowsFactory_V2());
Button button = factory.createButton(); // ä»ç„¶å¯ä»¥å·¥ä½œ
```

**ğŸ”¸ é…ç½®é©±åŠ¨çš„å…¼å®¹æ€§**

```java
// é€šè¿‡é…ç½®æ§åˆ¶å…¼å®¹æ¨¡å¼
class SmartUIFactory implements UIFactory_V1, UIFactory_V2 {
    private boolean compatibilityMode;
    
    public SmartUIFactory(boolean compatibilityMode) {
        this.compatibilityMode = compatibilityMode;
    }
    
    // V1æ¥å£å®ç°
    public Button createButton() {
        if (compatibilityMode) {
            return createSimpleButton(); // ç®€å•æ¨¡å¼
        } else {
            return createButton(ButtonStyle.MODERN); // ç°ä»£æ¨¡å¼
        }
    }
    
    // V2æ¥å£å®ç°
    public Button createButton(ButtonStyle style) {
        return new ModernButton(style);
    }
}
```

### 4.4 æ¸è¿›å¼è¿ç§»æ–¹æ¡ˆ


**è¿ç§»æ­¥éª¤è§„åˆ’**ï¼š

```
é˜¶æ®µ1ï¼šåŒæ¥å£å¹¶å­˜
â”œâ”€â”€ ä¿ç•™æ—§æ¥å£UIFactory_V1
â”œâ”€â”€ å¢åŠ æ–°æ¥å£UIFactory_V2
â””â”€â”€ æä¾›é€‚é…å™¨æ”¯æŒ

é˜¶æ®µ2ï¼šé€æ­¥è¿ç§»
â”œâ”€â”€ æ–°åŠŸèƒ½ä½¿ç”¨æ–°æ¥å£
â”œâ”€â”€ æ—§åŠŸèƒ½ä¿æŒä¸å˜
â””â”€â”€ æä¾›è¿ç§»å·¥å…·å’Œæ–‡æ¡£

é˜¶æ®µ3ï¼šæ ‡è®°åºŸå¼ƒ
â”œâ”€â”€ ç»™æ—§æ¥å£åŠ @Deprecatedæ³¨è§£
â”œâ”€â”€ æä¾›è¿ç§»æŒ‡å¯¼
â””â”€â”€ è®¾å®šåºŸå¼ƒæ—¶é—´è¡¨

é˜¶æ®µ4ï¼šå®Œå…¨åˆ‡æ¢
â”œâ”€â”€ ç§»é™¤æ—§æ¥å£
â”œâ”€â”€ æ¸…ç†é€‚é…å™¨ä»£ç 
â””â”€â”€ æ›´æ–°æ‰€æœ‰æ–‡æ¡£
```

**å®é™…ä»£ç ç¤ºä¾‹**ï¼š
```java
public class UIFactoryManager {
    // é˜¶æ®µ1ï¼šæ”¯æŒä¸¤ç§å·¥å‚
    public static UIFactory_V1 createV1Factory(String platform) {
        UIFactory_V2 v2Factory = createV2Factory(platform);
        return new CompatibilityAdapter(v2Factory);
    }
    
    public static UIFactory_V2 createV2Factory(String platform) {
        switch (platform) {
            case "windows": return new WindowsFactory_V2();
            case "mac": return new MacFactory_V2();
            default: throw new UnsupportedPlatformException(platform);
        }
    }
    
    // é˜¶æ®µ2ï¼šæ¨èä½¿ç”¨æ–°æ¥å£
    @Deprecated
    public static UIFactory_V1 createFactory(String platform) {
        System.out.println("è­¦å‘Šï¼šä½¿ç”¨äº†åºŸå¼ƒçš„å·¥å‚åˆ›å»ºæ–¹æ³•ï¼Œè¯·è¿ç§»åˆ°V2æ¥å£");
        return createV1Factory(platform);
    }
}
```

---

## 5. âš¡ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


### 5.1 æ€§èƒ½é—®é¢˜çš„å¸¸è§åœºæ™¯


**é€šä¿—ç†è§£**ï¼šå°±åƒå·¥å‚ç”Ÿäº§ï¼Œå¦‚æœæ¯æ¬¡å®¢æˆ·è¦ä¸ªèºä¸é’‰éƒ½è¦é‡æ–°å»ºä¸€æ¡ç”Ÿäº§çº¿ï¼Œé‚£æˆæœ¬å¤ªé«˜äº†ã€‚åˆç†çš„åšæ³•æ˜¯æå‰å‡†å¤‡å¥½ç”Ÿäº§çº¿ï¼Œéœ€è¦æ—¶ç›´æ¥ç”Ÿäº§ã€‚

```
æŠ½è±¡å·¥å‚çš„æ€§èƒ½ç“¶é¢ˆï¼š

é—®é¢˜1ï¼šé‡å¤åˆ›å»ºå·¥å‚å®ä¾‹
â””â”€â”€ æ¯æ¬¡éœ€è¦äº§å“éƒ½newä¸€ä¸ªå·¥å‚

é—®é¢˜2ï¼šäº§å“åˆ›å»ºæˆæœ¬é«˜
â””â”€â”€ æŸäº›äº§å“åˆå§‹åŒ–å¾ˆå¤æ‚ã€å¾ˆè€—æ—¶

é—®é¢˜3ï¼šå†…å­˜å ç”¨è¿‡å¤š
â””â”€â”€ åŒæ—¶å­˜åœ¨å¤ªå¤šäº§å“å®ä¾‹

é—®é¢˜4ï¼šå·¥å‚é€‰æ‹©é€»è¾‘å¤æ‚
â””â”€â”€ é¢‘ç¹çš„æ¡ä»¶åˆ¤æ–­å’Œåå°„è°ƒç”¨
```

### 5.2 å·¥å‚å®ä¾‹çš„ç¼“å­˜ç­–ç•¥


**ğŸ”¸ å•ä¾‹å·¥å‚æ¨¡å¼**

```java
// æ¯ä¸ªå…·ä½“å·¥å‚åªåˆ›å»ºä¸€ä¸ªå®ä¾‹
class WindowsFactory implements UIFactory {
    private static volatile WindowsFactory instance;
    
    private WindowsFactory() {} // ç§æœ‰æ„é€ å™¨
    
    public static WindowsFactory getInstance() {
        if (instance == null) {
            synchronized (WindowsFactory.class) {
                if (instance == null) {
                    instance = new WindowsFactory();
                }
            }
        }
        return instance;
    }
}
```

**ä¸ºä»€ä¹ˆè¿™æ ·åšï¼Ÿ**
- å‡å°‘å¯¹è±¡åˆ›å»ºå¼€é”€
- ä¿è¯å·¥å‚çŠ¶æ€ä¸€è‡´æ€§
- èŠ‚çœå†…å­˜ç©ºé—´

**ğŸ”¸ å·¥å‚ç¼“å­˜æ± **

```java
class FactoryCache {
    private static final Map<String, UIFactory> cache = new ConcurrentHashMap<>();
    
    public static UIFactory getFactory(String platform) {
        return cache.computeIfAbsent(platform, key -> {
            switch (key) {
                case "windows": return new WindowsFactory();
                case "mac": return new MacFactory();
                case "linux": return new LinuxFactory();
                default: throw new IllegalArgumentException("ä¸æ”¯æŒçš„å¹³å°: " + key);
            }
        });
    }
    
    // é¢„çƒ­ç¼“å­˜
    public static void warmUp() {
        getFactory("windows");
        getFactory("mac"); 
        getFactory("linux");
    }
}
```

### 5.3 äº§å“å¯¹è±¡çš„å¤ç”¨æœºåˆ¶


**ğŸ”¸ å¯¹è±¡æ± æ¨¡å¼**

```java
// å¤ç”¨åˆ›å»ºæˆæœ¬é«˜çš„å¯¹è±¡
class ExpensiveComponentPool {
    private final Queue<ExpensiveComponent> pool = new ConcurrentLinkedQueue<>();
    private final int maxSize;
    
    public ExpensiveComponentPool(int maxSize) {
        this.maxSize = maxSize;
    }
    
    public ExpensiveComponent borrowObject() {
        ExpensiveComponent obj = pool.poll();
        if (obj == null) {
            obj = new ExpensiveComponent(); // åˆ›å»ºæ–°å¯¹è±¡
        }
        return obj;
    }
    
    public void returnObject(ExpensiveComponent obj) {
        if (pool.size() < maxSize) {
            obj.reset(); // é‡ç½®å¯¹è±¡çŠ¶æ€
            pool.offer(obj);
        }
    }
}
```

**é›†æˆåˆ°å·¥å‚ä¸­**ï¼š
```java
class OptimizedUIFactory implements UIFactory {
    private final ExpensiveComponentPool complexPool = new ExpensiveComponentPool(10);
    
    public ComplexComponent createComplexComponent() {
        return complexPool.borrowObject();
    }
    
    // æä¾›å›æ”¶æ–¹æ³•
    public void recycleComplexComponent(ComplexComponent component) {
        complexPool.returnObject(component);
    }
}
```

**ğŸ”¸ äº«å…ƒæ¨¡å¼ä¼˜åŒ–**

```java
// å¯¹äºå¤§é‡ç›¸ä¼¼å¯¹è±¡ï¼Œå…±äº«å…¬å…±éƒ¨åˆ†
class ButtonFlyweight {
    private final String style; // å†…åœ¨çŠ¶æ€ï¼ˆå…±äº«ï¼‰
    
    public ButtonFlyweight(String style) {
        this.style = style;
    }
    
    public void render(String text, Color color) { // å¤–åœ¨çŠ¶æ€ï¼ˆä¸å…±äº«ï¼‰
        System.out.println("æ¸²æŸ“" + style + "æŒ‰é’®: " + text + ", é¢œè‰²: " + color);
    }
}

class FlyweightFactory {
    private static final Map<String, ButtonFlyweight> flyweights = new HashMap<>();
    
    public static ButtonFlyweight getFlyweight(String style) {
        return flyweights.computeIfAbsent(style, ButtonFlyweight::new);
    }
}
```

### 5.4 å»¶è¿Ÿåˆå§‹åŒ–ç­–ç•¥


**ğŸ”¸ æ‡’åŠ è½½å·¥å‚**

```java
class LazyUIFactory implements UIFactory {
    private volatile Button buttonInstance;
    private volatile Input inputInstance;
    
    public Button createButton() {
        if (buttonInstance == null) {
            synchronized (this) {
                if (buttonInstance == null) {
                    buttonInstance = new WindowsButton();
                }
            }
        }
        return buttonInstance;
    }
    
    public Input createInput() {
        if (inputInstance == null) {
            synchronized (this) {
                if (inputInstance == null) {
                    inputInstance = new WindowsInput();
                }
            }
        }
        return inputInstance;
    }
}
```

**ğŸ”¸ æŒ‰éœ€åˆ›å»ºç­–ç•¥**

```java
class SmartFactory implements UIFactory {
    private final Map<Class<?>, Object> instances = new ConcurrentHashMap<>();
    
    @SuppressWarnings("unchecked")
    public <T> T createProduct(Class<T> productType) {
        return (T) instances.computeIfAbsent(productType, type -> {
            try {
                return type.getDeclaredConstructor().newInstance();
            } catch (Exception e) {
                throw new RuntimeException("æ— æ³•åˆ›å»ºäº§å“: " + type.getName(), e);
            }
        });
    }
    
    public Button createButton() {
        return createProduct(WindowsButton.class);
    }
}
```

### 5.5 æ€§èƒ½ç›‘æ§å’Œè°ƒä¼˜


**ğŸ”¸ æ€§èƒ½æŒ‡æ ‡ç›‘æ§**

```java
class PerformanceMonitor {
    private static final Map<String, Long> creationTimes = new ConcurrentHashMap<>();
    private static final Map<String, Integer> creationCounts = new ConcurrentHashMap<>();
    
    public static void recordCreation(String productType, long timeMs) {
        creationTimes.merge(productType, timeMs, Long::sum);
        creationCounts.merge(productType, 1, Integer::sum);
    }
    
    public static void printStatistics() {
        System.out.println("=== å·¥å‚æ€§èƒ½ç»Ÿè®¡ ===");
        creationCounts.forEach((type, count) -> {
            long totalTime = creationTimes.get(type);
            double avgTime = (double) totalTime / count;
            System.out.printf("%s: åˆ›å»º%dæ¬¡, å¹³å‡è€—æ—¶%.2fms%n", type, count, avgTime);
        });
    }
}
```

**ğŸ”¸ æ€§èƒ½ä¼˜åŒ–å»ºè®®**

```
ä¼˜åŒ–ä¼˜å…ˆçº§æ’åºï¼š

ğŸ”´ é«˜ä¼˜å…ˆçº§ï¼š
â”œâ”€â”€ ç¼“å­˜é¢‘ç¹ä½¿ç”¨çš„å·¥å‚å®ä¾‹
â”œâ”€â”€ å¯¹è±¡æ± ç®¡ç†é‡é‡çº§äº§å“
â””â”€â”€ å»¶è¿Ÿåˆå§‹åŒ–éå…³é”®ç»„ä»¶

ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ï¼š
â”œâ”€â”€ ä½¿ç”¨äº«å…ƒæ¨¡å¼å‡å°‘å†…å­˜å ç”¨
â”œâ”€â”€ é¢„çƒ­å…³é”®è·¯å¾„ä¸Šçš„å¯¹è±¡
â””â”€â”€ ç›‘æ§å’Œè°ƒä¼˜çƒ­ç‚¹ä»£ç 

ğŸŸ¢ ä½ä¼˜å…ˆçº§ï¼š
â”œâ”€â”€ å¾®ä¼˜åŒ–åˆ›å»ºé€»è¾‘
â”œâ”€â”€ å‹ç¼©å¯¹è±¡å†…å­˜å¸ƒå±€
â””â”€â”€ ä½¿ç”¨æ›´å¿«çš„æ•°æ®ç»“æ„
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„è®¾è®¡æŠ€å·§


```
ğŸ”¸ äº§å“æ—è§„åˆ’ï¼šç›¸å…³æ€§åŸåˆ™ï¼ŒæŠ½è±¡å±‚æ¬¡ç»Ÿä¸€ï¼Œä¸šåŠ¡åœºæ™¯é©±åŠ¨
ğŸ”¸ å·¥å‚å±‚æ¬¡ï¼šå•å±‚ç®€å•ç›´æ¥ï¼Œå¤šå±‚å¤„ç†å¤æ‚æ€§ï¼Œæ³¨å†Œæœºåˆ¶çµæ´»é€‰æ‹©
ğŸ”¸ æ‰©å±•æ€§ä¿è¯ï¼šå¼€é—­åŸåˆ™ï¼Œç‰ˆæœ¬æ¼”è¿›ï¼Œæ ‡å‡†åŒ–æ¥å…¥æµç¨‹
ğŸ”¸ ç‰ˆæœ¬å…¼å®¹ï¼šè¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼Œé€‚é…å™¨æ¨¡å¼ï¼Œæ¸è¿›å¼è¿ç§»
ğŸ”¸ æ€§èƒ½ä¼˜åŒ–ï¼šå®ä¾‹ç¼“å­˜ï¼Œå¯¹è±¡å¤ç”¨ï¼Œå»¶è¿Ÿåˆå§‹åŒ–ï¼Œæ€§èƒ½ç›‘æ§
```

### 6.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ äº§å“æ—è§„åˆ’çš„æœ¬è´¨**
```
æ ¸å¿ƒæ€æƒ³ï¼š
- æ‰¾åˆ°ä¸šåŠ¡ä¸­"æˆå¥—å‡ºç°"çš„å¯¹è±¡
- è¿™äº›å¯¹è±¡æœ‰å…±åŒçš„å˜åŒ–åŸå› 
- æŠ½è±¡å‡ºç¨³å®šçš„äº§å“æ¥å£
- æ¯ä¸ªäº§å“æ—ä¿æŒå†…éƒ¨ä¸€è‡´æ€§
```

**ğŸ”¹ æ‰©å±•æ€§è®¾è®¡çš„å¹³è¡¡**
```
è®¾è®¡è€ƒè™‘ï¼š
- è¿‡åº¦è®¾è®¡ vs è®¾è®¡ä¸è¶³
- çµæ´»æ€§ vs å¤æ‚æ€§  
- æ€§èƒ½ vs å¯ç»´æŠ¤æ€§
- å½“å‰éœ€æ±‚ vs æœªæ¥æ‰©å±•
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–çš„æ—¶æœº**
```
ä¼˜åŒ–åŸåˆ™ï¼š
- å…ˆä¿è¯åŠŸèƒ½æ­£ç¡®
- æµ‹é‡åå†ä¼˜åŒ–
- ä¼˜åŒ–çƒ­ç‚¹è·¯å¾„
- å¹³è¡¡å¤æ‚åº¦å’Œæ”¶ç›Š
```

### 6.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ è®¾è®¡å†³ç­–æ£€æŸ¥æ¸…å•**
```
äº§å“æ—è§„åˆ’ï¼š
â˜‘ï¸ äº§å“é—´æ˜¯å¦çœŸçš„éœ€è¦é…å¥—ä½¿ç”¨ï¼Ÿ
â˜‘ï¸ æŠ½è±¡å±‚æ¬¡æ˜¯å¦åˆé€‚ï¼Ÿ
â˜‘ï¸ æ˜¯å¦è€ƒè™‘äº†æœªæ¥æ‰©å±•ï¼Ÿ

å·¥å‚è®¾è®¡ï¼š
â˜‘ï¸ å·¥å‚å±‚æ¬¡æ˜¯å¦è¿‡äºå¤æ‚ï¼Ÿ
â˜‘ï¸ æ˜¯å¦æä¾›äº†çµæ´»çš„åˆ›å»ºæ–¹å¼ï¼Ÿ
â˜‘ï¸ é”™è¯¯å¤„ç†æ˜¯å¦å®Œå–„ï¼Ÿ

æ€§èƒ½è€ƒè™‘ï¼š
â˜‘ï¸ æ˜¯å¦è¯†åˆ«äº†æ€§èƒ½ç“¶é¢ˆï¼Ÿ
â˜‘ï¸ ç¼“å­˜ç­–ç•¥æ˜¯å¦åˆç†ï¼Ÿ
â˜‘ï¸ æ˜¯å¦æœ‰æ€§èƒ½ç›‘æ§ï¼Ÿ
```

**ğŸ”§ å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ**
```
é—®é¢˜ï¼šäº§å“æ—è¾¹ç•Œä¸æ¸…æ™°
è§£å†³ï¼šé‡æ–°åˆ†æä¸šåŠ¡åœºæ™¯ï¼Œæ˜ç¡®å˜åŒ–åŸå› 

é—®é¢˜ï¼šå·¥å‚ç±»è¿‡äºåºå¤§
è§£å†³ï¼šè€ƒè™‘åˆ†å±‚è®¾è®¡æˆ–å·¥å‚åˆ†è§£

é—®é¢˜ï¼šæ‰©å±•æ–°å¹³å°å›°éš¾
è§£å†³ï¼šæ£€æŸ¥æŠ½è±¡æ˜¯å¦åˆç†ï¼Œæ˜¯å¦éµå¾ªå¼€é—­åŸåˆ™

é—®é¢˜ï¼šæ€§èƒ½ä¸ç†æƒ³
è§£å†³ï¼šæ·»åŠ ç›‘æ§ï¼Œè¯†åˆ«ç“¶é¢ˆï¼Œé’ˆå¯¹æ€§ä¼˜åŒ–
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- äº§å“æ—è§„åˆ’çœ‹ç›¸å…³ï¼ŒæŠ½è±¡å±‚æ¬¡è¦ç»Ÿä¸€
- å·¥å‚å±‚æ¬¡åˆ†åœºæ™¯ï¼Œç®€å•å¤æ‚å„æœ‰æ‹›  
- æ‰©å±•è®¾è®¡å¼€é—­åŸåˆ™ï¼Œç‰ˆæœ¬å…¼å®¹æ¸è¿›å¼
- æ€§èƒ½ä¼˜åŒ–æŠ“é‡ç‚¹ï¼Œç¼“å­˜å¤ç”¨åŠ ç›‘æ§