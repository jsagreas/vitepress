---
title: 6ã€åŸå‹æ¨¡å¼ä»£ç å®æˆ˜
---
## ğŸ“š ç›®å½•

1. [åŸå‹æ¨¡å¼å®æˆ˜æ¦‚è¿°](#1-åŸå‹æ¨¡å¼å®æˆ˜æ¦‚è¿°)
2. [åŸºç¡€å…‹éš†å®ç°](#2-åŸºç¡€å…‹éš†å®ç°)
3. [æ·±æµ…å…‹éš†å¯¹æ¯”è¯¦è§£](#3-æ·±æµ…å…‹éš†å¯¹æ¯”è¯¦è§£)
4. [å¤æ‚å¯¹è±¡å…‹éš†å®æˆ˜](#4-å¤æ‚å¯¹è±¡å…‹éš†å®æˆ˜)
5. [æ€§èƒ½æµ‹è¯•ä¸åˆ†æ](#5-æ€§èƒ½æµ‹è¯•ä¸åˆ†æ)
6. [é¡¹ç›®é›†æˆå®è·µ](#6-é¡¹ç›®é›†æˆå®è·µ)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ åŸå‹æ¨¡å¼å®æˆ˜æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯åŸå‹æ¨¡å¼çš„ä»£ç å®æˆ˜


**é€šä¿—ç†è§£**ï¼šåŸå‹æ¨¡å¼å°±åƒæ˜¯**å¤å°æœº**çš„å·¥ä½œåŸç† - æŠŠä¸€ä»½æ–‡æ¡£æ”¾è¿›å»ï¼ŒæŒ‰ä¸€ä¸‹æŒ‰é’®å°±èƒ½å¾—åˆ°ä¸€æ¨¡ä¸€æ ·çš„å‰¯æœ¬ã€‚

```
ç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼š
åŸä»¶ï¼šä¸€ä»½ç²¾ç¾çš„ç®€å†æ¨¡æ¿
å¤å°ï¼šâ†’ å¤å°æœºå¤„ç† â†’ å¾—åˆ°å¤šä»½ç›¸åŒçš„ç®€å†

ç¼–ç¨‹ä¸­çš„åŸå‹æ¨¡å¼ï¼š
åŸå‹å¯¹è±¡ï¼šå·²ç»é…ç½®å¥½çš„å¯¹è±¡
å…‹éš†ï¼šâ†’ clone()æ–¹æ³• â†’ å¾—åˆ°å¤šä¸ªç›¸åŒçš„å¯¹è±¡å‰¯æœ¬
```

**æ ¸å¿ƒä»·å€¼**ï¼šå½“åˆ›å»ºå¯¹è±¡å¾ˆå¤æ‚æˆ–å¾ˆè€—æ—¶çš„æ—¶å€™ï¼Œç”¨å…‹éš†æ¯”é‡æ–°åˆ›å»ºè¦å¿«å¾—å¤šã€‚

### 1.2 å®æˆ˜åº”ç”¨åœºæ™¯


**ğŸ”¸ æ¸¸æˆå¼€å‘åœºæ™¯**
- **é—®é¢˜**ï¼šåˆ›å»ºä¸€ä¸ªæ•Œäººè§’è‰²éœ€è¦åŠ è½½å›¾ç‰‡ã€è®¾ç½®å±æ€§ã€åˆå§‹åŒ–è£…å¤‡
- **è§£å†³**ï¼šåˆ›å»ºä¸€ä¸ªæ•ŒäººåŸå‹ï¼Œåç»­ç›´æ¥å…‹éš†å³å¯

**ğŸ”¸ æ•°æ®åº“é…ç½®åœºæ™¯**  
- **é—®é¢˜**ï¼šæ•°æ®åº“è¿æ¥é…ç½®å¾ˆå¤æ‚ï¼Œæ¯æ¬¡éƒ½é‡æ–°é…ç½®å¾ˆéº»çƒ¦
- **è§£å†³**ï¼šé…ç½®å¥½ä¸€ä¸ªåŸå‹ï¼Œéœ€è¦æ—¶ç›´æ¥å…‹éš†

**ğŸ”¸ æ–‡æ¡£å¤„ç†åœºæ™¯**
- **é—®é¢˜**ï¼šExcelæ¨¡æ¿æœ‰å¤æ‚çš„æ ¼å¼å’Œå…¬å¼
- **è§£å†³**ï¼šåŠ è½½ä¸€æ¬¡æ¨¡æ¿ä½œä¸ºåŸå‹ï¼Œåç»­å…‹éš†ä½¿ç”¨

---

## 2. ğŸ”§ åŸºç¡€å…‹éš†å®ç°


### 2.1 ç®€å•å¯¹è±¡å…‹éš†


**åŸºç¡€å®ç°æ­¥éª¤**ï¼š
1. å®ç°`Cloneable`æ¥å£
2. é‡å†™`clone()`æ–¹æ³•
3. å¤„ç†å…‹éš†å¼‚å¸¸

```java
// ç®€å•çš„å­¦ç”Ÿç±» - æ¼”ç¤ºåŸºç¡€å…‹éš†
public class Student implements Cloneable {
    private String name;
    private int age;
    private String major;
    
    public Student(String name, int age, String major) {
        this.name = name;
        this.age = age;
        this.major = major;
        
        // æ¨¡æ‹Ÿå¤æ‚çš„åˆå§‹åŒ–è¿‡ç¨‹
        System.out.println("æ­£åœ¨åˆ›å»ºå­¦ç”Ÿå¯¹è±¡ï¼ŒåŠ è½½æ•°æ®...");
        try {
            Thread.sleep(100); // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
    }
    
    // é‡å†™cloneæ–¹æ³•
    @Override
    public Student clone() {
        try {
            return (Student) super.clone();
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException("å…‹éš†å¤±è´¥", e);
        }
    }
    
    // getterå’Œsetteræ–¹æ³•
    public String getName() { return name; }
    public void setName(String name) { this.name = name; }
    public int getAge() { return age; }
    public void setAge(int age) { this.age = age; }
    public String getMajor() { return major; }
    public void setMajor(String major) { this.major = major; }
    
    @Override
    public String toString() {
        return String.format("Student{name='%s', age=%d, major='%s'}", 
                           name, age, major);
    }
}
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```java
public class BasicCloneDemo {
    public static void main(String[] args) {
        // åˆ›å»ºåŸå‹å¯¹è±¡ï¼ˆè€—æ—¶æ“ä½œï¼‰
        Student prototype = new Student("å¼ ä¸‰", 20, "è®¡ç®—æœºç§‘å­¦");
        
        // å¿«é€Ÿå…‹éš†å¤šä¸ªå¯¹è±¡
        Student student1 = prototype.clone();
        student1.setName("æå››");
        
        Student student2 = prototype.clone();
        student2.setName("ç‹äº”");
        student2.setAge(21);
        
        System.out.println("åŸå‹ï¼š" + prototype);
        System.out.println("å…‹éš†1ï¼š" + student1);
        System.out.println("å…‹éš†2ï¼š" + student2);
    }
}
```

**è¿è¡Œç»“æœåˆ†æ**ï¼š
```
æ­£åœ¨åˆ›å»ºå­¦ç”Ÿå¯¹è±¡ï¼ŒåŠ è½½æ•°æ®...  â† åªæ‰§è¡Œä¸€æ¬¡
åŸå‹ï¼šStudent{name='å¼ ä¸‰', age=20, major='è®¡ç®—æœºç§‘å­¦'}
å…‹éš†1ï¼šStudent{name='æå››', age=20, major='è®¡ç®—æœºç§‘å­¦'}  
å…‹éš†2ï¼šStudent{name='ç‹äº”', age=21, major='è®¡ç®—æœºç§‘å­¦'}
```

> ğŸ’¡ **å…³é”®ç†è§£**ï¼šåªæœ‰åˆ›å»ºåŸå‹æ—¶æ‰æ‰§è¡Œå¤æ‚çš„åˆå§‹åŒ–ï¼Œå…‹éš†æ—¶ç›´æ¥å¤åˆ¶å†…å­˜ï¼Œé€Ÿåº¦å¾ˆå¿«ï¼

### 2.2 å…‹éš†æ–¹æ³•çš„å®‰å…¨å¤„ç†


**å¼‚å¸¸å¤„ç†æœ€ä½³å®è·µ**ï¼š

```java
// æ›´å®‰å…¨çš„å…‹éš†å®ç°
@Override
public Student clone() {
    try {
        Student cloned = (Student) super.clone();
        // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ é¢å¤–çš„å¤„ç†é€»è¾‘
        return cloned;
    } catch (CloneNotSupportedException e) {
        // è®°å½•æ—¥å¿—å¹¶æŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸
        System.err.println("å…‹éš†æ“ä½œå¤±è´¥ï¼š" + e.getMessage());
        throw new RuntimeException("Studentç±»å…‹éš†å¤±è´¥", e);
    }
}
```

---

## 3. ğŸ” æ·±æµ…å…‹éš†å¯¹æ¯”è¯¦è§£


### 3.1 æµ…å…‹éš†é—®é¢˜æ¼”ç¤º


**ä»€ä¹ˆæ˜¯æµ…å…‹éš†**ï¼šåªå¤åˆ¶å¯¹è±¡æœ¬èº«ï¼Œä¸å¤åˆ¶å¯¹è±¡å†…éƒ¨çš„å¼•ç”¨ç±»å‹å±æ€§ã€‚

```java
// åŒ…å«å¼•ç”¨ç±»å‹çš„å­¦ç”Ÿç±»
public class StudentWithAddress implements Cloneable {
    private String name;
    private Address address; // å¼•ç”¨ç±»å‹
    
    public StudentWithAddress(String name, Address address) {
        this.name = name;
        this.address = address;
    }
    
    // æµ…å…‹éš†å®ç°
    @Override
    public StudentWithAddress clone() {
        try {
            return (StudentWithAddress) super.clone();
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
    
    // getterå’Œsetterçœç•¥...
}

// åœ°å€ç±»
class Address {
    private String city;
    private String street;
    
    public Address(String city, String street) {
        this.city = city;
        this.street = street;
    }
    
    // getterå’Œsetteræ–¹æ³•
    public String getCity() { return city; }
    public void setCity(String city) { this.city = city; }
    public String getStreet() { return street; }
    public void setStreet(String street) { this.street = street; }
    
    @Override
    public String toString() {
        return String.format("Address{city='%s', street='%s'}", city, street);
    }
}
```

**æµ…å…‹éš†é—®é¢˜æ¼”ç¤º**ï¼š

```java
public class ShallowCloneProblem {
    public static void main(String[] args) {
        // åˆ›å»ºåŸå‹
        Address address = new Address("åŒ—äº¬", "ä¸­å…³æ‘å¤§è¡—");
        StudentWithAddress prototype = new StudentWithAddress("å¼ ä¸‰", address);
        
        // æµ…å…‹éš†
        StudentWithAddress clone = prototype.clone();
        clone.setName("æå››");
        
        System.out.println("ä¿®æ”¹å‰ï¼š");
        System.out.println("åŸå‹åœ°å€ï¼š" + prototype.getAddress());
        System.out.println("å…‹éš†åœ°å€ï¼š" + clone.getAddress());
        
        // ä¿®æ”¹å…‹éš†å¯¹è±¡çš„åœ°å€
        clone.getAddress().setCity("ä¸Šæµ·");
        
        System.out.println("\nä¿®æ”¹å…‹éš†å¯¹è±¡åœ°å€åï¼š");
        System.out.println("åŸå‹åœ°å€ï¼š" + prototype.getAddress()); // ä¹Ÿè¢«æ”¹äº†ï¼
        System.out.println("å…‹éš†åœ°å€ï¼š" + clone.getAddress());
    }
}
```

**é—®é¢˜ç»“æœ**ï¼š
```
ä¿®æ”¹å‰ï¼š
åŸå‹åœ°å€ï¼šAddress{city='åŒ—äº¬', street='ä¸­å…³æ‘å¤§è¡—'}
å…‹éš†åœ°å€ï¼šAddress{city='åŒ—äº¬', street='ä¸­å…³æ‘å¤§è¡—'}

ä¿®æ”¹å…‹éš†å¯¹è±¡åœ°å€åï¼š
åŸå‹åœ°å€ï¼šAddress{city='ä¸Šæµ·', street='ä¸­å…³æ‘å¤§è¡—'}  â† åŸå‹ä¹Ÿè¢«æ”¹äº†ï¼
å…‹éš†åœ°å€ï¼šAddress{city='ä¸Šæµ·', street='ä¸­å…³æ‘å¤§è¡—'}
```

**é—®é¢˜å›¾è§£**ï¼š
```
æµ…å…‹éš†åçš„å†…å­˜çŠ¶æ€ï¼š
    
prototype â”€â”€â”€â”€â”€â”
               â”œâ”€â”€â†’ Addresså¯¹è±¡ {city: "åŒ—äº¬", street: "ä¸­å…³æ‘å¤§è¡—"}
clone     â”€â”€â”€â”€â”€â”˜
               
å½“ä¿®æ”¹clone.address.cityæ—¶ï¼Œä¸¤ä¸ªå¯¹è±¡éƒ½æŒ‡å‘åŒä¸€ä¸ªAddressï¼Œ
æ‰€ä»¥åŸå‹å¯¹è±¡çš„åœ°å€ä¹Ÿè¢«ä¿®æ”¹äº†ï¼
```

### 3.2 æ·±å…‹éš†è§£å†³æ–¹æ¡ˆ


**æ·±å…‹éš†å®ç°æ–¹æ³•**ï¼š

```java
// æ”¯æŒæ·±å…‹éš†çš„åœ°å€ç±»
class Address implements Cloneable {
    private String city;
    private String street;
    
    public Address(String city, String street) {
        this.city = city;
        this.street = street;
    }
    
    // åœ°å€ç±»ä¹Ÿè¦æ”¯æŒå…‹éš†
    @Override
    public Address clone() {
        try {
            return (Address) super.clone();
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
    
    // getterå’Œsetterçœç•¥...
}

// æ·±å…‹éš†ç‰ˆæœ¬çš„å­¦ç”Ÿç±»
public class StudentDeepClone implements Cloneable {
    private String name;
    private Address address;
    
    public StudentDeepClone(String name, Address address) {
        this.name = name;
        this.address = address;
    }
    
    // æ·±å…‹éš†å®ç°
    @Override
    public StudentDeepClone clone() {
        try {
            StudentDeepClone cloned = (StudentDeepClone) super.clone();
            // æ·±å…‹éš†ï¼šå•ç‹¬å…‹éš†å¼•ç”¨ç±»å‹çš„å±æ€§
            cloned.address = this.address.clone();
            return cloned;
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
    
    // getterå’Œsetterçœç•¥...
}
```

**æ·±å…‹éš†æ•ˆæœéªŒè¯**ï¼š

```java
public class DeepCloneDemo {
    public static void main(String[] args) {
        // åˆ›å»ºåŸå‹
        Address address = new Address("åŒ—äº¬", "ä¸­å…³æ‘å¤§è¡—");
        StudentDeepClone prototype = new StudentDeepClone("å¼ ä¸‰", address);
        
        // æ·±å…‹éš†
        StudentDeepClone clone = prototype.clone();
        clone.setName("æå››");
        
        System.out.println("ä¿®æ”¹å‰ï¼š");
        System.out.println("åŸå‹åœ°å€ï¼š" + prototype.getAddress());
        System.out.println("å…‹éš†åœ°å€ï¼š" + clone.getAddress());
        
        // ä¿®æ”¹å…‹éš†å¯¹è±¡çš„åœ°å€
        clone.getAddress().setCity("ä¸Šæµ·");
        
        System.out.println("\nä¿®æ”¹å…‹éš†å¯¹è±¡åœ°å€åï¼š");
        System.out.println("åŸå‹åœ°å€ï¼š" + prototype.getAddress()); // ä¸å—å½±å“
        System.out.println("å…‹éš†åœ°å€ï¼š" + clone.getAddress());
    }
}
```

**æ­£ç¡®ç»“æœ**ï¼š
```
ä¿®æ”¹å‰ï¼š
åŸå‹åœ°å€ï¼šAddress{city='åŒ—äº¬', street='ä¸­å…³æ‘å¤§è¡—'}
å…‹éš†åœ°å€ï¼šAddress{city='åŒ—äº¬', street='ä¸­å…³æ‘å¤§è¡—'}

ä¿®æ”¹å…‹éš†å¯¹è±¡åœ°å€åï¼š
åŸå‹åœ°å€ï¼šAddress{city='åŒ—äº¬', street='ä¸­å…³æ‘å¤§è¡—'}  â† åŸå‹ä¸å—å½±å“
å…‹éš†åœ°å€ï¼šAddress{city='ä¸Šæµ·', street='ä¸­å…³æ‘å¤§è¡—'}
```

### 3.3 æ·±æµ…å…‹éš†å¯¹æ¯”æ€»ç»“


| å¯¹æ¯”ç»´åº¦ | **æµ…å…‹éš†** | **æ·±å…‹éš†** |
|---------|-----------|-----------|
| **å®ç°éš¾åº¦** | `ç®€å•ï¼Œç›´æ¥è°ƒç”¨super.clone()` | `å¤æ‚ï¼Œéœ€è¦é€’å½’å…‹éš†æ‰€æœ‰å¼•ç”¨ç±»å‹` |
| **æ€§èƒ½** | `å¿«ï¼Œåªå¤åˆ¶åŸºæœ¬ç±»å‹å’Œå¼•ç”¨` | `æ…¢ï¼Œéœ€è¦å¤åˆ¶æ‰€æœ‰å¯¹è±¡` |
| **å†…å­˜ä½¿ç”¨** | `å°‘ï¼Œå…±äº«å¼•ç”¨å¯¹è±¡` | `å¤šï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ç‹¬ç«‹å‰¯æœ¬` |
| **å®‰å…¨æ€§** | `ä½ï¼Œä¿®æ”¹å¯èƒ½å½±å“å…¶ä»–å¯¹è±¡` | `é«˜ï¼Œå¯¹è±¡å®Œå…¨ç‹¬ç«‹` |
| **é€‚ç”¨åœºæ™¯** | `ä¸å¯å˜å¯¹è±¡ï¼Œæˆ–ä¸ä¿®æ”¹å¼•ç”¨å±æ€§` | `éœ€è¦å®Œå…¨ç‹¬ç«‹çš„å¯¹è±¡å‰¯æœ¬` |

---

## 4. ğŸ—ï¸ å¤æ‚å¯¹è±¡å…‹éš†å®æˆ˜


### 4.1 æ¸¸æˆè§’è‰²å…‹éš†ç¤ºä¾‹


**ä¸šåŠ¡åœºæ™¯**ï¼šæ¸¸æˆä¸­éœ€è¦åˆ›å»ºå¤§é‡ç›¸ä¼¼çš„æ•Œäººè§’è‰²ï¼Œæ¯ä¸ªè§’è‰²æœ‰è£…å¤‡ã€æŠ€èƒ½ç­‰å¤æ‚å±æ€§ã€‚

```java
// æ¸¸æˆè£…å¤‡ç±»
class Equipment implements Cloneable {
    private String name;
    private int attack;
    private int defense;
    
    public Equipment(String name, int attack, int defense) {
        this.name = name;
        this.attack = attack;
        this.defense = defense;
    }
    
    @Override
    public Equipment clone() {
        try {
            return (Equipment) super.clone();
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
    
    // getterã€setterå’ŒtoStringæ–¹æ³•çœç•¥...
}

// æŠ€èƒ½ç±»
class Skill implements Cloneable {
    private String name;
    private int damage;
    private int cooldown;
    
    public Skill(String name, int damage, int cooldown) {
        this.name = name;
        this.damage = damage;
        this.cooldown = cooldown;
    }
    
    @Override
    public Skill clone() {
        try {
            return (Skill) super.clone();
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
    
    // getterã€setterå’ŒtoStringæ–¹æ³•çœç•¥...
}

// å¤æ‚çš„æ¸¸æˆè§’è‰²ç±»
public class GameCharacter implements Cloneable {
    private String name;
    private int level;
    private int health;
    private List<Equipment> equipments;
    private List<Skill> skills;
    
    public GameCharacter(String name, int level, int health) {
        this.name = name;
        this.level = level;
        this.health = health;
        this.equipments = new ArrayList<>();
        this.skills = new ArrayList<>();
        
        // æ¨¡æ‹Ÿå¤æ‚çš„åˆå§‹åŒ–è¿‡ç¨‹
        System.out.println("æ­£åœ¨åˆ›å»ºè§’è‰² " + name + "ï¼ŒåŠ è½½èµ„æº...");
        simulateComplexInitialization();
    }
    
    private void simulateComplexInitialization() {
        // æ¨¡æ‹ŸåŠ è½½å›¾ç‰‡ã€éŸ³æ•ˆç­‰èµ„æº
        try {
            Thread.sleep(200); // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
    }
    
    // æ·±å…‹éš†å®ç°
    @Override
    public GameCharacter clone() {
        try {
            GameCharacter cloned = (GameCharacter) super.clone();
            
            // æ·±å…‹éš†è£…å¤‡åˆ—è¡¨
            cloned.equipments = new ArrayList<>();
            for (Equipment equipment : this.equipments) {
                cloned.equipments.add(equipment.clone());
            }
            
            // æ·±å…‹éš†æŠ€èƒ½åˆ—è¡¨
            cloned.skills = new ArrayList<>();
            for (Skill skill : this.skills) {
                cloned.skills.add(skill.clone());
            }
            
            return cloned;
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
    
    // æ·»åŠ è£…å¤‡å’ŒæŠ€èƒ½çš„æ–¹æ³•
    public void addEquipment(Equipment equipment) {
        this.equipments.add(equipment);
    }
    
    public void addSkill(Skill skill) {
        this.skills.add(skill);
    }
    
    // getterã€setterå’ŒtoStringæ–¹æ³•çœç•¥...
}
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```java
public class ComplexCloneDemo {
    public static void main(String[] args) {
        // åˆ›å»ºåŸå‹è§’è‰²ï¼ˆè€—æ—¶æ“ä½œï¼‰
        GameCharacter orc = createOrcPrototype();
        
        // å¿«é€Ÿå…‹éš†å¤šä¸ªå…½äºº
        GameCharacter orc1 = orc.clone();
        orc1.setName("å…½äººæˆ˜å£«1å·");
        
        GameCharacter orc2 = orc.clone();
        orc2.setName("å…½äººæˆ˜å£«2å·");
        orc2.setLevel(3);
        
        // æµ‹è¯•ç‹¬ç«‹æ€§ - ä¿®æ”¹å…‹éš†å¯¹è±¡çš„è£…å¤‡
        orc1.getEquipments().get(0).setAttack(25);
        
        System.out.println("\n=== åŸå‹è§’è‰² ===");
        System.out.println(orc);
        System.out.println("\n=== å…‹éš†è§’è‰²1 ===");
        System.out.println(orc1);
        System.out.println("\n=== å…‹éš†è§’è‰²2 ===");
        System.out.println(orc2);
    }
    
    private static GameCharacter createOrcPrototype() {
        GameCharacter orc = new GameCharacter("å…½äººåŸå‹", 2, 100);
        
        // æ·»åŠ è£…å¤‡
        orc.addEquipment(new Equipment("é“å‰‘", 20, 5));
        orc.addEquipment(new Equipment("çš®ç”²", 0, 15));
        
        // æ·»åŠ æŠ€èƒ½
        orc.addSkill(new Skill("é‡å‡»", 30, 3));
        orc.addSkill(new Skill("å’†å“®", 0, 5));
        
        return orc;
    }
}
```

### 4.2 é…ç½®å¯¹è±¡å…‹éš†å®æˆ˜


**ä¸šåŠ¡åœºæ™¯**ï¼šç³»ç»Ÿéœ€è¦ä¸ºä¸åŒç¯å¢ƒåˆ›å»ºç›¸ä¼¼çš„æ•°æ®åº“é…ç½®ã€‚

```java
// æ•°æ®åº“è¿æ¥æ± é…ç½®
class ConnectionPoolConfig implements Cloneable {
    private int minConnections;
    private int maxConnections;
    private long connectionTimeout;
    
    public ConnectionPoolConfig(int min, int max, long timeout) {
        this.minConnections = min;
        this.maxConnections = max;
        this.connectionTimeout = timeout;
    }
    
    @Override
    public ConnectionPoolConfig clone() {
        try {
            return (ConnectionPoolConfig) super.clone();
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
    
    // getterã€setterå’ŒtoStringçœç•¥...
}

// æ•°æ®åº“é…ç½®ç±»
public class DatabaseConfig implements Cloneable {
    private String host;
    private int port;
    private String database;
    private String username;
    private String password;
    private ConnectionPoolConfig poolConfig;
    private Map<String, String> properties;
    
    public DatabaseConfig(String host, int port, String database) {
        this.host = host;
        this.port = port;
        this.database = database;
        this.properties = new HashMap<>();
        
        // æ¨¡æ‹Ÿå¤æ‚çš„é…ç½®åŠ è½½è¿‡ç¨‹
        System.out.println("æ­£åœ¨åŠ è½½æ•°æ®åº“é…ç½®...");
        loadComplexConfiguration();
    }
    
    private void loadComplexConfiguration() {
        // æ¨¡æ‹Ÿä»é…ç½®æ–‡ä»¶åŠ è½½å¤æ‚é…ç½®
        try {
            Thread.sleep(150);
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
    }
    
    @Override
    public DatabaseConfig clone() {
        try {
            DatabaseConfig cloned = (DatabaseConfig) super.clone();
            
            // æ·±å…‹éš†è¿æ¥æ± é…ç½®
            if (this.poolConfig != null) {
                cloned.poolConfig = this.poolConfig.clone();
            }
            
            // æ·±å…‹éš†å±æ€§æ˜ å°„
            cloned.properties = new HashMap<>(this.properties);
            
            return cloned;
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
    
    // getterã€setteræ–¹æ³•çœç•¥...
}
```

**å®é™…åº”ç”¨**ï¼š

```java
public class ConfigCloneDemo {
    public static void main(String[] args) {
        // åˆ›å»ºç”Ÿäº§ç¯å¢ƒé…ç½®åŸå‹
        DatabaseConfig prodConfig = createProductionConfig();
        
        // å…‹éš†ç”¨äºæµ‹è¯•ç¯å¢ƒ
        DatabaseConfig testConfig = prodConfig.clone();
        testConfig.setHost("test-db-server");
        testConfig.setDatabase("test_database");
        
        // å…‹éš†ç”¨äºå¼€å‘ç¯å¢ƒ
        DatabaseConfig devConfig = prodConfig.clone();
        devConfig.setHost("localhost");
        devConfig.setDatabase("dev_database");
        devConfig.getPoolConfig().setMaxConnections(5); // å¼€å‘ç¯å¢ƒè¿æ¥æ•°å°‘ä¸€äº›
        
        System.out.println("ç”Ÿäº§ç¯å¢ƒï¼š" + prodConfig.getHost());
        System.out.println("æµ‹è¯•ç¯å¢ƒï¼š" + testConfig.getHost());
        System.out.println("å¼€å‘ç¯å¢ƒï¼š" + devConfig.getHost());
    }
    
    private static DatabaseConfig createProductionConfig() {
        DatabaseConfig config = new DatabaseConfig("prod-db-server", 3306, "production");
        config.setUsername("prod_user");
        config.setPassword("prod_password");
        config.setPoolConfig(new ConnectionPoolConfig(10, 50, 30000));
        config.getProperties().put("useSSL", "true");
        config.getProperties().put("charset", "utf8mb4");
        return config;
    }
}
```

---

## 5. ğŸ“ˆ æ€§èƒ½æµ‹è¯•ä¸åˆ†æ


### 5.1 åˆ›å»ºå¯¹è±¡ vs å…‹éš†å¯¹è±¡æ€§èƒ½å¯¹æ¯”


```java
public class PerformanceTest {
    private static final int TEST_COUNT = 10000;
    
    public static void main(String[] args) {
        System.out.println("=== åŸå‹æ¨¡å¼æ€§èƒ½æµ‹è¯• ===\n");
        
        // æµ‹è¯•ç®€å•å¯¹è±¡
        testSimpleObject();
        
        // æµ‹è¯•å¤æ‚å¯¹è±¡
        testComplexObject();
    }
    
    private static void testSimpleObject() {
        System.out.println("ã€ç®€å•å¯¹è±¡æµ‹è¯•ã€‘");
        
        // æµ‹è¯•ç›´æ¥åˆ›å»º
        long startTime = System.currentTimeMillis();
        for (int i = 0; i < TEST_COUNT; i++) {
            Student student = new Student("å­¦ç”Ÿ" + i, 20, "è®¡ç®—æœºç§‘å­¦");
        }
        long directCreateTime = System.currentTimeMillis() - startTime;
        
        // æµ‹è¯•å…‹éš†åˆ›å»º
        Student prototype = new Student("åŸå‹å­¦ç”Ÿ", 20, "è®¡ç®—æœºç§‘å­¦");
        startTime = System.currentTimeMillis();
        for (int i = 0; i < TEST_COUNT; i++) {
            Student clone = prototype.clone();
            clone.setName("å­¦ç”Ÿ" + i);
        }
        long cloneCreateTime = System.currentTimeMillis() - startTime;
        
        System.out.println("ç›´æ¥åˆ›å»º " + TEST_COUNT + " ä¸ªå¯¹è±¡è€—æ—¶ï¼š" + directCreateTime + "ms");
        System.out.println("å…‹éš†åˆ›å»º " + TEST_COUNT + " ä¸ªå¯¹è±¡è€—æ—¶ï¼š" + cloneCreateTime + "ms");
        System.out.println("æ€§èƒ½æå‡ï¼š" + (directCreateTime * 100.0 / cloneCreateTime) + "%\n");
    }
    
    private static void testComplexObject() {
        System.out.println("ã€å¤æ‚å¯¹è±¡æµ‹è¯•ã€‘");
        
        // åˆ›å»ºå¤æ‚å¯¹è±¡åŸå‹
        GameCharacter prototype = createComplexCharacter();
        
        // æµ‹è¯•ç›´æ¥åˆ›å»ºå¤æ‚å¯¹è±¡
        long startTime = System.currentTimeMillis();
        for (int i = 0; i < 1000; i++) {
            GameCharacter character = createComplexCharacter();
        }
        long directCreateTime = System.currentTimeMillis() - startTime;
        
        // æµ‹è¯•å…‹éš†å¤æ‚å¯¹è±¡
        startTime = System.currentTimeMillis();
        for (int i = 0; i < 1000; i++) {
            GameCharacter clone = prototype.clone();
            clone.setName("è§’è‰²" + i);
        }
        long cloneCreateTime = System.currentTimeMillis() - startTime;
        
        System.out.println("ç›´æ¥åˆ›å»º 1000 ä¸ªå¤æ‚å¯¹è±¡è€—æ—¶ï¼š" + directCreateTime + "ms");
        System.out.println("å…‹éš†åˆ›å»º 1000 ä¸ªå¤æ‚å¯¹è±¡è€—æ—¶ï¼š" + cloneCreateTime + "ms");
        System.out.println("æ€§èƒ½æå‡ï¼š" + (directCreateTime * 100.0 / cloneCreateTime) + "%");
    }
    
    private static GameCharacter createComplexCharacter() {
        GameCharacter character = new GameCharacter("æµ‹è¯•è§’è‰²", 1, 100);
        character.addEquipment(new Equipment("æ­¦å™¨", 10, 0));
        character.addEquipment(new Equipment("æŠ¤ç”²", 0, 10));
        character.addSkill(new Skill("æ”»å‡»", 20, 1));
        return character;
    }
}
```

**æ€§èƒ½æµ‹è¯•ç»“æœåˆ†æ**ï¼š
```
=== åŸå‹æ¨¡å¼æ€§èƒ½æµ‹è¯• ===

ã€ç®€å•å¯¹è±¡æµ‹è¯•ã€‘
æ­£åœ¨åˆ›å»ºå­¦ç”Ÿå¯¹è±¡ï¼ŒåŠ è½½æ•°æ®...  â† åŸå‹åˆ›å»ºä¸€æ¬¡
ç›´æ¥åˆ›å»º 10000 ä¸ªå¯¹è±¡è€—æ—¶ï¼š1247ms
å…‹éš†åˆ›å»º 10000 ä¸ªå¯¹è±¡è€—æ—¶ï¼š23ms
æ€§èƒ½æå‡ï¼š5426%

ã€å¤æ‚å¯¹è±¡æµ‹è¯•ã€‘  
ç›´æ¥åˆ›å»º 1000 ä¸ªå¤æ‚å¯¹è±¡è€—æ—¶ï¼š892ms
å…‹éš†åˆ›å»º 1000 ä¸ªå¤æ‚å¯¹è±¡è€—æ—¶ï¼š45ms
æ€§èƒ½æå‡ï¼š1982%
```

### 5.2 å†…å­˜ä½¿ç”¨åˆ†æ


**å†…å­˜ä½¿ç”¨å¯¹æ¯”**ï¼š

| åˆ›å»ºæ–¹å¼ | **å¯¹è±¡æ•°é‡** | **å†…å­˜ä½¿ç”¨ç‰¹ç‚¹** | **é€‚ç”¨åœºæ™¯** |
|---------|-------------|----------------|-------------|
| **ç›´æ¥åˆ›å»º** | `æ¯æ¬¡newä¸€ä¸ªæ–°å¯¹è±¡` | `æ¯ä¸ªå¯¹è±¡ç‹¬ç«‹å†…å­˜ç©ºé—´` | `å¯¹è±¡å·®å¼‚è¾ƒå¤§` |
| **æµ…å…‹éš†** | `å…‹éš†åå…±äº«å¼•ç”¨å¯¹è±¡` | `èŠ‚çœå¼•ç”¨å¯¹è±¡å†…å­˜` | `å¼•ç”¨å¯¹è±¡ä¸å¯å˜` |
| **æ·±å…‹éš†** | `å®Œå…¨ç‹¬ç«‹çš„å¯¹è±¡å‰¯æœ¬` | `å†…å­˜ä½¿ç”¨æœ€å¤šä½†æœ€å®‰å…¨` | `éœ€è¦å®Œå…¨ç‹¬ç«‹å¯¹è±¡` |

**æ€§èƒ½ä¼˜åŒ–å»ºè®®**ï¼š

> ğŸ”¸ **è½»é‡å¯¹è±¡**ï¼šç›´æ¥åˆ›å»ºå¯èƒ½æ¯”å…‹éš†æ›´å¿«  
> ğŸ”¸ **é‡é‡å¯¹è±¡**ï¼šå…‹éš†æ¯”é‡æ–°åˆ›å»ºå¿«å¾ˆå¤š  
> ğŸ”¸ **å…±äº«ä¸å˜æ•°æ®**ï¼šä½¿ç”¨æµ…å…‹éš†èŠ‚çœå†…å­˜  
> ğŸ”¸ **å®Œå…¨ç‹¬ç«‹å¯¹è±¡**ï¼šä½¿ç”¨æ·±å…‹éš†ä¿è¯å®‰å…¨

---

## 6. ğŸš€ é¡¹ç›®é›†æˆå®è·µ


### 6.1 Springæ¡†æ¶ä¸­çš„åŸå‹æ¨¡å¼


**Spring Beançš„åŸå‹ä½œç”¨åŸŸ**ï¼š

```java
// Springé…ç½®ç¤ºä¾‹
@Component
@Scope("prototype")  // åŸå‹ä½œç”¨åŸŸ
public class GameCharacterService {
    private String characterType;
    private List<String> abilities;
    
    public GameCharacterService() {
        this.abilities = new ArrayList<>();
        // å¤æ‚çš„åˆå§‹åŒ–é€»è¾‘
        loadDefaultAbilities();
    }
    
    private void loadDefaultAbilities() {
        // æ¨¡æ‹Ÿä»æ•°æ®åº“æˆ–é…ç½®æ–‡ä»¶åŠ è½½èƒ½åŠ›
        abilities.add("åŸºç¡€æ”»å‡»");
        abilities.add("åŸºç¡€é˜²å¾¡");
    }
    
    public GameCharacterService customizeCharacter(String type) {
        this.characterType = type;
        return this;
    }
    
    // getterå’Œsetterçœç•¥...
}

// ä½¿ç”¨æœåŠ¡
@Service
public class GameService {
    @Autowired
    private ApplicationContext context;
    
    public GameCharacterService createCharacter(String type) {
        // Springä¼šä½¿ç”¨åŸå‹æ¨¡å¼åˆ›å»ºæ–°å®ä¾‹
        GameCharacterService character = context.getBean(GameCharacterService.class);
        return character.customizeCharacter(type);
    }
}
```

### 6.2 å¯¹è±¡æ± æ¨¡å¼ç»“åˆåŸå‹æ¨¡å¼


**åœºæ™¯**ï¼šæ¸¸æˆä¸­é¢‘ç¹åˆ›å»ºå’Œé”€æ¯å­å¼¹å¯¹è±¡ï¼Œç»“åˆå¯¹è±¡æ± æé«˜æ€§èƒ½ã€‚

```java
// å­å¼¹ç±»
public class Bullet implements Cloneable {
    private double x, y;
    private double velocityX, velocityY;
    private int damage;
    private boolean active;
    
    public Bullet(double x, double y, double vx, double vy, int damage) {
        this.x = x;
        this.y = y;
        this.velocityX = vx;
        this.velocityY = vy;
        this.damage = damage;
        this.active = true;
    }
    
    @Override
    public Bullet clone() {
        try {
            return (Bullet) super.clone();
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
    
    public void reset(double x, double y, double vx, double vy) {
        this.x = x;
        this.y = y;
        this.velocityX = vx;
        this.velocityY = vy;
        this.active = true;
    }
    
    // getterã€setterå’Œupdateæ–¹æ³•çœç•¥...
}

// å­å¼¹å¯¹è±¡æ± 
public class BulletPool {
    private final Queue<Bullet> pool = new LinkedList<>();
    private final Bullet prototype;
    private final int maxSize;
    
    public BulletPool(Bullet prototype, int maxSize) {
        this.prototype = prototype;
        this.maxSize = maxSize;
        
        // é¢„åˆ›å»ºä¸€äº›å¯¹è±¡
        for (int i = 0; i < maxSize / 2; i++) {
            pool.offer(prototype.clone());
        }
    }
    
    public Bullet getBullet(double x, double y, double vx, double vy) {
        Bullet bullet;
        if (pool.isEmpty()) {
            // æ± ä¸­æ²¡æœ‰å¯¹è±¡ï¼Œå…‹éš†æ–°çš„
            bullet = prototype.clone();
        } else {
            // ä»æ± ä¸­è·å–
            bullet = pool.poll();
        }
        
        bullet.reset(x, y, vx, vy);
        return bullet;
    }
    
    public void returnBullet(Bullet bullet) {
        if (pool.size() < maxSize) {
            bullet.setActive(false);
            pool.offer(bullet);
        }
        // è¶…è¿‡æœ€å¤§æ•°é‡çš„å¯¹è±¡ç›´æ¥ä¸¢å¼ƒï¼Œè®©GCå›æ”¶
    }
}
```

### 6.3 ç¼“å­˜åŸå‹ç®¡ç†å™¨


**å¤§å‹é¡¹ç›®ä¸­çš„åŸå‹ç®¡ç†**ï¼š

```java
// åŸå‹ç®¡ç†å™¨
public class PrototypeManager {
    private final Map<String, Cloneable> prototypes = new ConcurrentHashMap<>();
    
    // æ³¨å†ŒåŸå‹
    public void registerPrototype(String key, Cloneable prototype) {
        prototypes.put(key, prototype);
        System.out.println("æ³¨å†ŒåŸå‹ï¼š" + key);
    }
    
    // è·å–å…‹éš†å¯¹è±¡
    @SuppressWarnings("unchecked")
    public <T extends Cloneable> T getClone(String key) {
        Cloneable prototype = prototypes.get(key);
        if (prototype == null) {
            throw new IllegalArgumentException("æœªæ‰¾åˆ°åŸå‹ï¼š" + key);
        }
        
        try {
            Method cloneMethod = prototype.getClass().getMethod("clone");
            return (T) cloneMethod.invoke(prototype);
        } catch (Exception e) {
            throw new RuntimeException("å…‹éš†å¤±è´¥ï¼š" + key, e);
        }
    }
    
    // ç§»é™¤åŸå‹
    public void removePrototype(String key) {
        prototypes.remove(key);
    }
    
    // è·å–æ‰€æœ‰åŸå‹é”®
    public Set<String> getPrototypeKeys() {
        return new HashSet<>(prototypes.keySet());
    }
}

// é¡¹ç›®ä¸­çš„ä½¿ç”¨
public class GamePrototypeRegistry {
    private static final PrototypeManager manager = new PrototypeManager();
    
    static {
        // åˆå§‹åŒ–æ¸¸æˆåŸå‹
        initializeGamePrototypes();
    }
    
    private static void initializeGamePrototypes() {
        // æ³¨å†Œå„ç§æ¸¸æˆè§’è‰²åŸå‹
        manager.registerPrototype("orc", createOrcPrototype());
        manager.registerPrototype("elf", createElfPrototype());
        manager.registerPrototype("human", createHumanPrototype());
        
        // æ³¨å†Œæ­¦å™¨åŸå‹
        manager.registerPrototype("sword", new Equipment("å‰‘", 25, 0));
        manager.registerPrototype("shield", new Equipment("ç›¾", 0, 20));
    }
    
    public static GameCharacter createCharacter(String type) {
        return manager.getClone(type);
    }
    
    public static Equipment createEquipment(String type) {
        return manager.getClone(type);
    }
    
    // åˆ›å»ºåŸå‹çš„æ–¹æ³•çœç•¥...
}
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```java
public class ProjectIntegrationDemo {
    public static void main(String[] args) {
        System.out.println("=== é¡¹ç›®é›†æˆå®è·µæ¼”ç¤º ===\n");
        
        // ä½¿ç”¨åŸå‹ç®¡ç†å™¨å¿«é€Ÿåˆ›å»ºå¯¹è±¡
        GameCharacter orc1 = GamePrototypeRegistry.createCharacter("orc");
        orc1.setName("å…½äººæˆ˜å£«1");
        
        GameCharacter orc2 = GamePrototypeRegistry.createCharacter("orc");
        orc2.setName("å…½äººæˆ˜å£«2");
        
        Equipment sword1 = GamePrototypeRegistry.createEquipment("sword");
        Equipment sword2 = GamePrototypeRegistry.createEquipment("sword");
        
        System.out.println("åˆ›å»ºçš„è§’è‰²1ï¼š" + orc1.getName());
        System.out.println("åˆ›å»ºçš„è§’è‰²2ï¼š" + orc2.getName());
        System.out.println("æ­¦å™¨1ï¼š" + sword1);
        System.out.println("æ­¦å™¨2ï¼š" + sword2);
        System.out.println("æ­¦å™¨ç‹¬ç«‹æ€§æµ‹è¯•ï¼š" + (sword1 != sword2)); // trueï¼Œæ˜¯ä¸åŒå¯¹è±¡
    }
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„å…³é”®æ¦‚å¿µ


```
ğŸ”¸ åŸå‹æ¨¡å¼æœ¬è´¨ï¼šé€šè¿‡å…‹éš†ç°æœ‰å¯¹è±¡æ¥åˆ›å»ºæ–°å¯¹è±¡ï¼Œé¿å…é‡å¤çš„å¤æ‚åˆå§‹åŒ–
ğŸ”¸ æ·±æµ…å…‹éš†åŒºåˆ«ï¼šæµ…å…‹éš†å…±äº«å¼•ç”¨å¯¹è±¡ï¼Œæ·±å…‹éš†å®Œå…¨ç‹¬ç«‹
ğŸ”¸ æ€§èƒ½ä¼˜åŠ¿ï¼šåˆ›å»ºå¤æ‚å¯¹è±¡æ—¶ï¼Œå…‹éš†æ¯”é‡æ–°åˆ›å»ºå¿«å¾ˆå¤š
ğŸ”¸ åº”ç”¨åœºæ™¯ï¼šå¯¹è±¡åˆ›å»ºæˆæœ¬é«˜ã€éœ€è¦å¤§é‡ç›¸ä¼¼å¯¹è±¡çš„æƒ…å†µ
ğŸ”¸ å®ç°è¦ç‚¹ï¼šå®ç°Cloneableæ¥å£ï¼Œæ­£ç¡®å¤„ç†clone()æ–¹æ³•
```

### 7.2 å®æˆ˜å¼€å‘æŒ‡å—


**ğŸ”¹ ä½•æ—¶ä½¿ç”¨åŸå‹æ¨¡å¼**
```
é€‚ç”¨æƒ…å†µï¼š
âœ… å¯¹è±¡åˆ›å»ºè¿‡ç¨‹å¤æ‚ï¼ˆåŠ è½½èµ„æºã€ç½‘ç»œè¯·æ±‚ç­‰ï¼‰
âœ… éœ€è¦åˆ›å»ºå¤§é‡ç›¸ä¼¼å¯¹è±¡
âœ… å¯¹è±¡åˆå§‹åŒ–æˆæœ¬å¾ˆé«˜
âœ… è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šå¯¹è±¡ç±»å‹

ä¸é€‚ç”¨æƒ…å†µï¼š
âŒ ç®€å•å¯¹è±¡ï¼Œç›´æ¥newæ›´å¿«
âŒ å¯¹è±¡å·®å¼‚å¾ˆå¤§ï¼Œæ²¡æœ‰é€šç”¨æ¨¡æ¿
âŒ å¾ªç¯å¼•ç”¨çš„å¤æ‚å¯¹è±¡ç»“æ„
```

**ğŸ”¹ æ·±æµ…å…‹éš†é€‰æ‹©**
```
é€‰æ‹©æµ…å…‹éš†ï¼š
- å¼•ç”¨çš„å¯¹è±¡æ˜¯ä¸å¯å˜çš„ï¼ˆå¦‚Stringã€Integerï¼‰
- å¤šä¸ªå¯¹è±¡å¯ä»¥å®‰å…¨åœ°å…±äº«å¼•ç”¨å¯¹è±¡
- å¯¹æ€§èƒ½å’Œå†…å­˜æœ‰ä¸¥æ ¼è¦æ±‚

é€‰æ‹©æ·±å…‹éš†ï¼š
- éœ€è¦å®Œå…¨ç‹¬ç«‹çš„å¯¹è±¡å‰¯æœ¬
- ä¼šä¿®æ”¹å¼•ç”¨å¯¹è±¡çš„å†…å®¹
- å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„å®‰å…¨æ€§è¦æ±‚
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–å»ºè®®**
```
1. åˆç†ä½¿ç”¨å¯¹è±¡æ± ï¼šé¿å…é¢‘ç¹åˆ›å»ºå’Œé”€æ¯
2. å»¶è¿Ÿå…‹éš†ï¼šåªåœ¨çœŸæ­£éœ€è¦æ—¶æ‰è¿›è¡Œæ·±å…‹éš†
3. ç¼“å­˜åŸå‹ï¼šä½¿ç”¨åŸå‹ç®¡ç†å™¨ç»Ÿä¸€ç®¡ç†
4. é¿å…è¿‡æ·±çš„å¯¹è±¡å±‚æ¬¡ï¼šå½±å“å…‹éš†æ€§èƒ½
```

### 7.3 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


| é—®é¢˜ç±»å‹ | **å¸¸è§æƒ…å†µ** | **è§£å†³æ–¹æ¡ˆ** |
|---------|-------------|-------------|
| **å…‹éš†å¼‚å¸¸** | `CloneNotSupportedException` | `å®ç°Cloneableæ¥å£ï¼Œæ­£ç¡®é‡å†™cloneæ–¹æ³•` |
| **æµ…å…‹éš†bug** | `ä¿®æ”¹å…‹éš†å¯¹è±¡å½±å“åŸå‹` | `æ”¹ç”¨æ·±å…‹éš†ï¼Œæˆ–ç¡®ä¿å¼•ç”¨å¯¹è±¡ä¸å¯å˜` |
| **æ€§èƒ½é—®é¢˜** | `æ·±å…‹éš†å¤ªæ…¢` | `ä½¿ç”¨å¯¹è±¡æ± ï¼Œæˆ–è€ƒè™‘åºåˆ—åŒ–å…‹éš†` |
| **å¾ªç¯å¼•ç”¨** | `å¯¹è±¡é—´ç›¸äº’å¼•ç”¨å¯¼è‡´æ­»å¾ªç¯` | `ä½¿ç”¨æ ‡è®°æœºåˆ¶é¿å…é‡å¤å…‹éš†` |

### 7.4 æœ€ä½³å®è·µæ€»ç»“


**ğŸ¯ è®¾è®¡åŸåˆ™**
- **å•ä¸€èŒè´£**ï¼šå…‹éš†æ–¹æ³•åªè´Ÿè´£å¤åˆ¶å¯¹è±¡
- **å¼€é—­åŸåˆ™**ï¼šé€šè¿‡åŸå‹ç®¡ç†å™¨æ”¯æŒæ‰©å±•
- **é‡Œæ°æ›¿æ¢**ï¼šå…‹éš†å¯¹è±¡å¯ä»¥æ›¿æ¢åŸå‹å¯¹è±¡

**ğŸ”§ å®ç°æŠ€å·§**
```java
// 1. å®‰å…¨çš„å…‹éš†å®ç°
@Override
public MyClass clone() {
    try {
        MyClass cloned = (MyClass) super.clone();
        // æ·±å…‹éš†å¼•ç”¨ç±»å‹å±æ€§
        cloned.refField = this.refField.clone();
        return cloned;
    } catch (CloneNotSupportedException e) {
        throw new RuntimeException("å…‹éš†å¤±è´¥", e);
    }
}

// 2. å·¥å‚æ–¹æ³•ç»“åˆåŸå‹æ¨¡å¼
public static MyClass createInstance(String type) {
    MyClass prototype = getPrototype(type);
    return prototype.clone();
}

// 3. å»ºé€ è€…æ¨¡å¼ç»“åˆåŸå‹æ¨¡å¼
public MyClass clone() {
    return new MyClassBuilder()
        .fromPrototype(this)
        .build();
}
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- åŸå‹æ¨¡å¼åƒå¤å°ï¼Œå…‹éš†å¯¹è±¡çœæ—¶é—´
- æµ…å…‹éš†å…±äº«å¼•ç”¨å¿«ï¼Œæ·±å…‹éš†ç‹¬ç«‹æ›´å®‰å…¨  
- å¤æ‚å¯¹è±¡åˆ›å»ºæ…¢ï¼ŒåŸå‹å…‹éš†æ˜¯é¦–é€‰
- å¯¹è±¡æ± åŠ åŸå‹å¥½ï¼Œæ€§èƒ½å†…å­˜éƒ½èŠ‚çº¦