---
title: 2ã€ç­–ç•¥æ¨¡å¼ç»“æ„åˆ†æ
---
## ğŸ“š ç›®å½•

1. [ç­–ç•¥æ¨¡å¼æ•´ä½“ç»“æ„æ¦‚è§ˆ](#1-ç­–ç•¥æ¨¡å¼æ•´ä½“ç»“æ„æ¦‚è§ˆ)
2. [ç­–ç•¥æ¥å£å®šä¹‰è¯¦è§£](#2-ç­–ç•¥æ¥å£å®šä¹‰è¯¦è§£)
3. [å…·ä½“ç­–ç•¥å®ç°åˆ†æ](#3-å…·ä½“ç­–ç•¥å®ç°åˆ†æ)
4. [ä¸Šä¸‹æ–‡ç±»è®¾è®¡è¦ç‚¹](#4-ä¸Šä¸‹æ–‡ç±»è®¾è®¡è¦ç‚¹)
5. [å®¢æˆ·ç«¯ä½¿ç”¨æ–¹å¼](#5-å®¢æˆ·ç«¯ä½¿ç”¨æ–¹å¼)
6. [ç­–ç•¥é€‰æ‹©æœºåˆ¶](#6-ç­–ç•¥é€‰æ‹©æœºåˆ¶)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ—ï¸ ç­–ç•¥æ¨¡å¼æ•´ä½“ç»“æ„æ¦‚è§ˆ


### 1.1 ä»€ä¹ˆæ˜¯ç­–ç•¥æ¨¡å¼çš„ç»“æ„


**é€šä¿—ç†è§£**ï¼šç­–ç•¥æ¨¡å¼å°±åƒæ˜¯ä¸€ä¸ª"æ–¹æ³•å·¥å…·ç®±"ï¼Œé‡Œé¢æœ‰å¾ˆå¤šç§è§£å†³åŒä¸€ä¸ªé—®é¢˜çš„ä¸åŒæ–¹æ³•ï¼Œä½ å¯ä»¥æ ¹æ®æƒ…å†µé€‰æ‹©æœ€åˆé€‚çš„é‚£ä¸€ç§ã€‚

```
ç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼š
å‡ºè¡Œæ–¹å¼é€‰æ‹©
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    æˆ‘è¦      â”‚â”€â”€â”€â–¶â”‚   é€‰æ‹©äº¤é€š   â”‚
â”‚   å»åŒ—äº¬     â”‚    â”‚    å·¥å…·     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                    â”Œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”
                    â–¼     â–¼     â–¼
                  é£æœº   ç«è½¦   æ±½è½¦
                 æœ€å¿«   èˆ’é€‚   ä¾¿å®œ
```

### 1.2 ç­–ç•¥æ¨¡å¼çš„æ ¸å¿ƒç»“æ„


ç­–ç•¥æ¨¡å¼åŒ…å«ä¸‰ä¸ªæ ¸å¿ƒè§’è‰²ï¼Œå°±åƒä¸€ä¸ªå°å›¢é˜Ÿï¼š

```
ç­–ç•¥æ¨¡å¼ç»“æ„å›¾ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å®¢æˆ·ç«¯     â”‚ â† ä½¿ç”¨è€…ï¼Œéœ€è¦å®ŒæˆæŸä¸ªä»»åŠ¡
â”‚  (Client)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸Šä¸‹æ–‡ç±»    â”‚ â† ç®¡ç†è€…ï¼Œè´Ÿè´£åè°ƒå’Œæ‰§è¡Œ
â”‚ (Context)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç­–ç•¥æ¥å£    â”‚ â† è§„èŒƒï¼Œå®šä¹‰"æ€ä¹ˆåš"çš„æ ‡å‡†
â”‚ (Strategy)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”
â–¼      â–¼       â–¼
å…·ä½“ç­–ç•¥A  å…·ä½“ç­–ç•¥B  å…·ä½“ç­–ç•¥C â† å…·ä½“çš„è§£å†³æ–¹æ¡ˆ
```

### 1.3 ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡


**è®¾è®¡çš„æ™ºæ…§**ï¼š
- **èŒè´£åˆ†ç¦»**ï¼šæ¯ä¸ªè§’è‰²åªè´Ÿè´£è‡ªå·±çš„äº‹æƒ…
- **çµæ´»æ›¿æ¢**ï¼šå¯ä»¥éšæ—¶æ›´æ¢è§£å†³æ–¹æ¡ˆ
- **æ˜“äºæ‰©å±•**ï¼šæ–°å¢æ–¹æ¡ˆä¸å½±å“åŸæœ‰ä»£ç 
- **é™ä½è€¦åˆ**ï¼šå„éƒ¨åˆ†ç›¸å¯¹ç‹¬ç«‹

---

## 2. ğŸ“‹ ç­–ç•¥æ¥å£å®šä¹‰è¯¦è§£


### 2.1 ç­–ç•¥æ¥å£çš„æœ¬è´¨


**ç®€å•ç†è§£**ï¼šç­–ç•¥æ¥å£å°±åƒæ˜¯ä¸€ä¸ª"å·¥ä½œå²—ä½è¯´æ˜ä¹¦"ï¼Œè§„å®šäº†è¿™ä¸ªå²—ä½éœ€è¦åšä»€ä¹ˆäº‹æƒ…ï¼Œä½†ä¸ç®¡å…·ä½“æ€ä¹ˆåšã€‚

> ğŸ’¡ **å…³é”®æ¦‚å¿µ**ï¼šæ¥å£å®šä¹‰äº†"åšä»€ä¹ˆ"ï¼Œä½†ä¸è§„å®š"æ€ä¹ˆåš"

### 2.2 ç­–ç•¥æ¥å£çš„è®¾è®¡åŸåˆ™


**ğŸ¯ è®¾è®¡è¦ç‚¹**ï¼š
```
â‘  æ–¹æ³•è¦æŠ½è±¡ - åªå®šä¹‰åŠŸèƒ½ï¼Œä¸å†™å®ç°
â‘¡ å‚æ•°è¦é€šç”¨ - èƒ½æ»¡è¶³æ‰€æœ‰å…·ä½“ç­–ç•¥çš„éœ€è¦
â‘¢ è¿”å›å€¼è¦ç»Ÿä¸€ - ä¿è¯ç»“æœæ ¼å¼ä¸€è‡´
â‘£ å‘½åè¦æ¸…æ™° - è®©äººä¸€çœ‹å°±çŸ¥é“æ˜¯åšä»€ä¹ˆçš„
```

### 2.3 ç­–ç•¥æ¥å£çš„å…¸å‹å†™æ³•


```java
// ç­–ç•¥æ¥å£ - å®šä¹‰ç®—æ³•æ—çš„å…¬å…±æ¥å£
public interface PaymentStrategy {
    /**
     * æ‰§è¡Œæ”¯ä»˜æ“ä½œ
     * @param amount æ”¯ä»˜é‡‘é¢
     * @return æ”¯ä»˜ç»“æœä¿¡æ¯
     */
    PaymentResult pay(double amount);
    
    /**
     * è·å–æ”¯ä»˜æ–¹å¼åç§°
     * @return æ”¯ä»˜æ–¹å¼çš„æ˜¾ç¤ºåç§°
     */
    String getPaymentMethod();
}
```

**æ¥å£è®¾è®¡è§£è¯»**ï¼š
- `pay()` æ–¹æ³•ï¼š**æ ¸å¿ƒåŠŸèƒ½**ï¼Œæ‰€æœ‰æ”¯ä»˜æ–¹å¼éƒ½è¦å®ç°
- `getPaymentMethod()` æ–¹æ³•ï¼š**è¾…åŠ©åŠŸèƒ½**ï¼Œç”¨äºæ˜¾ç¤ºå’Œæ—¥å¿—
- å‚æ•°ç»Ÿä¸€ï¼šæ‰€æœ‰æ”¯ä»˜éƒ½éœ€è¦é‡‘é¢ä¿¡æ¯
- è¿”å›å€¼ç»Ÿä¸€ï¼šéƒ½è¿”å›æ”¯ä»˜ç»“æœå¯¹è±¡

### 2.4 æ¥å£è®¾è®¡çš„å¸¸è§è¯¯åŒº


| âŒ **é”™è¯¯åšæ³•** | âœ… **æ­£ç¡®åšæ³•** | **è¯´æ˜** |
|:---|:---|:---|
| `æ–¹æ³•å¤ªå…·ä½“` | `æ–¹æ³•è¦æŠ½è±¡` | ä¸è¦åœ¨æ¥å£ä¸­æš´éœ²å®ç°ç»†èŠ‚ |
| `å‚æ•°å¤ªæ­»æ¿` | `å‚æ•°è¦çµæ´»` | è€ƒè™‘ä¸åŒç­–ç•¥çš„å‚æ•°éœ€æ±‚ |
| `æ–¹æ³•å¤ªå¤š` | `æ–¹æ³•ç²¾ç®€` | æ¥å£è¦ä¸“æ³¨ï¼Œä¸è¦ä»€ä¹ˆéƒ½å¾€é‡Œæ”¾ |
| `å‘½åéšæ„` | `å‘½åè§„èŒƒ` | æ–¹æ³•åè¦æ¸…æ¥šè¡¨è¾¾æ„å›¾ |

---

## 3. ğŸ”§ å…·ä½“ç­–ç•¥å®ç°åˆ†æ


### 3.1 å…·ä½“ç­–ç•¥çš„èŒè´£


**é€šä¿—è§£é‡Š**ï¼šå…·ä½“ç­–ç•¥å°±åƒæ˜¯"ä¸“ä¸šæŠ€æœ¯å·¥äºº"ï¼Œæ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„ä¸“é•¿ï¼Œä½†éƒ½èƒ½å®ŒæˆåŒä¸€ç±»å·¥ä½œã€‚

```
æ”¯ä»˜åœºæ™¯ç¤ºä¾‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ”¯ä»˜å®æ”¯ä»˜  â”‚  â”‚  å¾®ä¿¡æ”¯ä»˜    â”‚  â”‚  é“¶è¡Œå¡æ”¯ä»˜  â”‚
â”‚     ğŸ’°      â”‚  â”‚     ğŸ’³      â”‚  â”‚     ğŸ¦      â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ æ‰«ç æ”¯ä»˜    â”‚  â”‚ äºŒç»´ç æ”¯ä»˜   â”‚  â”‚ åˆ·å¡æ”¯ä»˜    â”‚
â”‚ å¿«é€Ÿä¾¿æ·    â”‚  â”‚ ç¤¾äº¤å±æ€§    â”‚  â”‚ ä¼ ç»Ÿå®‰å…¨    â”‚
â”‚ æ‰‹ç»­è´¹ä½    â”‚  â”‚ çº¢åŒ…åŠŸèƒ½    â”‚  â”‚ é¢åº¦é«˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â–²              â–²              â–²
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
            éƒ½å®ç° PaymentStrategy æ¥å£
```

### 3.2 å…·ä½“ç­–ç•¥å®ç°ç¤ºä¾‹


**æ”¯ä»˜å®æ”¯ä»˜ç­–ç•¥**ï¼š
```java
public class AlipayStrategy implements PaymentStrategy {
    private String account;  // æ”¯ä»˜å®è´¦å·
    
    public AlipayStrategy(String account) {
        this.account = account;
    }
    
    @Override
    public PaymentResult pay(double amount) {
        // æ”¯ä»˜å®ç‰¹æœ‰çš„æ”¯ä»˜æµç¨‹
        System.out.println("æ­£åœ¨ä½¿ç”¨æ”¯ä»˜å®æ”¯ä»˜...");
        System.out.println("è´¦å·ï¼š" + account);
        System.out.println("é‡‘é¢ï¼š" + amount + "å…ƒ");
        
        // æ¨¡æ‹Ÿæ”¯ä»˜å®APIè°ƒç”¨
        boolean success = callAlipayAPI(amount);
        
        return new PaymentResult(success, "æ”¯ä»˜å®", amount);
    }
    
    @Override
    public String getPaymentMethod() {
        return "æ”¯ä»˜å®æ”¯ä»˜";
    }
    
    private boolean callAlipayAPI(double amount) {
        // æ¨¡æ‹ŸAPIè°ƒç”¨é€»è¾‘
        return amount > 0 && amount <= 10000;
    }
}
```

**å¾®ä¿¡æ”¯ä»˜ç­–ç•¥**ï¼š
```java
public class WechatStrategy implements PaymentStrategy {
    private String openId;   // å¾®ä¿¡ç”¨æˆ·æ ‡è¯†
    
    public WechatStrategy(String openId) {
        this.openId = openId;
    }
    
    @Override
    public PaymentResult pay(double amount) {
        System.out.println("æ­£åœ¨ä½¿ç”¨å¾®ä¿¡æ”¯ä»˜...");
        System.out.println("ç”¨æˆ·IDï¼š" + openId);
        System.out.println("é‡‘é¢ï¼š" + amount + "å…ƒ");
        
        // å¾®ä¿¡æ”¯ä»˜ç‰¹æœ‰çš„æµç¨‹
        boolean success = callWechatAPI(amount);
        
        return new PaymentResult(success, "å¾®ä¿¡æ”¯ä»˜", amount);
    }
    
    @Override
    public String getPaymentMethod() {
        return "å¾®ä¿¡æ”¯ä»˜";
    }
    
    private boolean callWechatAPI(double amount) {
        // å¾®ä¿¡æ”¯ä»˜é€»è¾‘
        return amount > 0 && amount <= 5000;
    }
}
```

### 3.3 å…·ä½“ç­–ç•¥çš„è®¾è®¡è¦ç‚¹


**ğŸ” å®ç°è¦ç‚¹**ï¼š
```
â‘  ä¸“æ³¨è‡ªå·±çš„ç®—æ³• - æ¯ä¸ªç­–ç•¥åªå…³å¿ƒè‡ªå·±çš„å®ç°
â‘¡ ä¿æŒæ¥å£ä¸€è‡´ - ä¸¥æ ¼æŒ‰ç…§æ¥å£è§„èŒƒå®ç°
â‘¢ å¤„ç†å¼‚å¸¸æƒ…å†µ - è€ƒè™‘å„ç§è¾¹ç•Œæƒ…å†µ
â‘£ æä¾›è¯¦ç»†ä¿¡æ¯ - æ–¹ä¾¿è°ƒè¯•å’Œç›‘æ§
```

---

## 4. ğŸ® ä¸Šä¸‹æ–‡ç±»è®¾è®¡è¦ç‚¹


### 4.1 ä¸Šä¸‹æ–‡ç±»çš„ä½œç”¨


**å½¢è±¡æ¯”å–»**ï¼šä¸Šä¸‹æ–‡ç±»å°±åƒæ˜¯ä¸€ä¸ª"é¡¹ç›®ç»ç†"ï¼Œå®ƒä¸ç›´æ¥å¹²æ´»ï¼Œä½†è´Ÿè´£ï¼š
- ğŸ“‹ é€‰æ‹©åˆé€‚çš„"å‘˜å·¥"ï¼ˆç­–ç•¥ï¼‰
- ğŸ¯ åˆ†é…å…·ä½“çš„"ä»»åŠ¡"ï¼ˆè°ƒç”¨ç­–ç•¥æ–¹æ³•ï¼‰
- ğŸ“Š æ”¶é›†"å·¥ä½œç»“æœ"ï¼ˆå¤„ç†è¿”å›å€¼ï¼‰

### 4.2 ä¸Šä¸‹æ–‡ç±»çš„æ ¸å¿ƒè®¾è®¡


```java
public class PaymentContext {
    private PaymentStrategy strategy;  // å½“å‰ä½¿ç”¨çš„æ”¯ä»˜ç­–ç•¥
    
    // æ„é€ å‡½æ•°ï¼šå¯ä»¥åœ¨åˆ›å»ºæ—¶æŒ‡å®šç­–ç•¥
    public PaymentContext(PaymentStrategy strategy) {
        this.strategy = strategy;
    }
    
    // é»˜è®¤æ„é€ å‡½æ•°ï¼šä¸æŒ‡å®šç­–ç•¥
    public PaymentContext() {
        this.strategy = null;
    }
    
    // è®¾ç½®ç­–ç•¥ï¼šå…è®¸è¿è¡Œæ—¶åˆ‡æ¢
    public void setStrategy(PaymentStrategy strategy) {
        if (strategy == null) {
            throw new IllegalArgumentException("æ”¯ä»˜ç­–ç•¥ä¸èƒ½ä¸ºç©º");
        }
        this.strategy = strategy;
        System.out.println("å·²åˆ‡æ¢åˆ°ï¼š" + strategy.getPaymentMethod());
    }
    
    // æ‰§è¡Œæ”¯ä»˜ï¼šè°ƒç”¨å½“å‰ç­–ç•¥
    public PaymentResult executePayment(double amount) {
        if (strategy == null) {
            throw new IllegalStateException("è¯·å…ˆè®¾ç½®æ”¯ä»˜ç­–ç•¥");
        }
        
        if (amount <= 0) {
            return new PaymentResult(false, "æ— æ•ˆé‡‘é¢", amount);
        }
        
        System.out.println("=== å¼€å§‹æ”¯ä»˜ ===");
        PaymentResult result = strategy.pay(amount);
        System.out.println("=== æ”¯ä»˜å®Œæˆ ===");
        
        return result;
    }
    
    // è·å–å½“å‰æ”¯ä»˜æ–¹å¼
    public String getCurrentPaymentMethod() {
        return strategy != null ? strategy.getPaymentMethod() : "æœªè®¾ç½®";
    }
}
```

### 4.3 ä¸Šä¸‹æ–‡ç±»çš„é«˜çº§åŠŸèƒ½


**ç­–ç•¥éªŒè¯åŠŸèƒ½**ï¼š
```java
// åœ¨ä¸Šä¸‹æ–‡ç±»ä¸­æ·»åŠ ç­–ç•¥éªŒè¯
public boolean validateStrategy(double amount) {
    if (strategy instanceof AlipayStrategy && amount > 10000) {
        System.out.println("æ”¯ä»˜å®å•æ¬¡æ”¯ä»˜é™é¢10000å…ƒ");
        return false;
    }
    if (strategy instanceof WechatStrategy && amount > 5000) {
        System.out.println("å¾®ä¿¡æ”¯ä»˜å•æ¬¡æ”¯ä»˜é™é¢5000å…ƒ");
        return false;
    }
    return true;
}
```

**æ”¯ä»˜å†å²è®°å½•**ï¼š
```java
private List<PaymentResult> paymentHistory = new ArrayList<>();

public PaymentResult executePayment(double amount) {
    // ... åŸæœ‰ä»£ç  ...
    PaymentResult result = strategy.pay(amount);
    
    // è®°å½•æ”¯ä»˜å†å²
    paymentHistory.add(result);
    
    return result;
}

public List<PaymentResult> getPaymentHistory() {
    return new ArrayList<>(paymentHistory);
}
```

### 4.4 ä¸Šä¸‹æ–‡ç±»è®¾è®¡çš„å…³é”®ç‚¹


> ğŸ’¡ **è®¾è®¡åŸåˆ™**ï¼šä¸Šä¸‹æ–‡ç±»è¦åšå¥½"ç®¡ç†å‘˜"çš„è§’è‰²ï¼Œæ—¢ä¸èƒ½ä»€ä¹ˆéƒ½ä¸ç®¡ï¼Œä¹Ÿä¸èƒ½ç®¡å¾—å¤ªç»†

**ğŸ“Œ æ ¸å¿ƒèŒè´£**ï¼š
- âœ… **ç­–ç•¥ç®¡ç†**ï¼šè®¾ç½®ã€åˆ‡æ¢ã€éªŒè¯ç­–ç•¥
- âœ… **ä»»åŠ¡åè°ƒ**ï¼šè°ƒç”¨ç­–ç•¥æ‰§è¡Œå…·ä½“ä»»åŠ¡
- âœ… **å¼‚å¸¸å¤„ç†**ï¼šå¤„ç†ç­–ç•¥æ‰§è¡Œä¸­çš„é—®é¢˜
- âœ… **ç»“æœå¤„ç†**ï¼šæ”¶é›†å’Œæ•´ç†æ‰§è¡Œç»“æœ

---

## 5. ğŸ‘¨â€ğŸ’» å®¢æˆ·ç«¯ä½¿ç”¨æ–¹å¼


### 5.1 åŸºæœ¬ä½¿ç”¨æ¨¡å¼


**æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼**ï¼š
```java
public class PaymentClient {
    public static void main(String[] args) {
        // åˆ›å»ºæ”¯ä»˜ä¸Šä¸‹æ–‡
        PaymentContext context = new PaymentContext();
        
        // åœºæ™¯1ï¼šä½¿ç”¨æ”¯ä»˜å®æ”¯ä»˜
        context.setStrategy(new AlipayStrategy("user123@example.com"));
        PaymentResult result1 = context.executePayment(100.0);
        
        // åœºæ™¯2ï¼šåˆ‡æ¢åˆ°å¾®ä¿¡æ”¯ä»˜
        context.setStrategy(new WechatStrategy("wx_openid_456"));
        PaymentResult result2 = context.executePayment(200.0);
        
        // æŸ¥çœ‹ç»“æœ
        System.out.println("æ”¯ä»˜å®ç»“æœï¼š" + result1.isSuccess());
        System.out.println("å¾®ä¿¡ç»“æœï¼š" + result2.isSuccess());
    }
}
```

### 5.2 å®é™…ä¸šåŠ¡åœºæ™¯çš„ä½¿ç”¨


**ç”µå•†è´­ç‰©åœºæ™¯**ï¼š
```java
public class ShoppingService {
    private PaymentContext paymentContext;
    
    public ShoppingService() {
        this.paymentContext = new PaymentContext();
    }
    
    // ç”¨æˆ·é€‰æ‹©æ”¯ä»˜æ–¹å¼
    public void choosePaymentMethod(String method, String userInfo) {
        PaymentStrategy strategy;
        
        switch (method.toLowerCase()) {
            case "alipay":
                strategy = new AlipayStrategy(userInfo);
                break;
            case "wechat":
                strategy = new WechatStrategy(userInfo);
                break;
            case "bank":
                strategy = new BankCardStrategy(userInfo);
                break;
            default:
                throw new IllegalArgumentException("ä¸æ”¯æŒçš„æ”¯ä»˜æ–¹å¼ï¼š" + method);
        }
        
        paymentContext.setStrategy(strategy);
    }
    
    // å¤„ç†è®¢å•æ”¯ä»˜
    public boolean processOrder(Order order) {
        try {
            PaymentResult result = paymentContext.executePayment(order.getAmount());
            
            if (result.isSuccess()) {
                order.setStatus("å·²æ”¯ä»˜");
                System.out.println("è®¢å• " + order.getId() + " æ”¯ä»˜æˆåŠŸ");
                return true;
            } else {
                order.setStatus("æ”¯ä»˜å¤±è´¥");
                System.out.println("è®¢å• " + order.getId() + " æ”¯ä»˜å¤±è´¥");
                return false;
            }
        } catch (Exception e) {
            System.out.println("æ”¯ä»˜è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸ï¼š" + e.getMessage());
            return false;
        }
    }
}
```

### 5.3 å®¢æˆ·ç«¯ä½¿ç”¨çš„æœ€ä½³å®è·µ


**ğŸ¯ ä½¿ç”¨å»ºè®®**ï¼š

â‘  **åŠæ—¶æ£€æŸ¥ç­–ç•¥**ï¼š
```java
// âœ… å¥½çš„åšæ³•ï¼šä½¿ç”¨å‰æ£€æŸ¥
if (context.getCurrentPaymentMethod().equals("æœªè®¾ç½®")) {
    throw new IllegalStateException("è¯·å…ˆé€‰æ‹©æ”¯ä»˜æ–¹å¼");
}
```

â‘¡ **å¤„ç†å¼‚å¸¸æƒ…å†µ**ï¼š
```java
// âœ… å¥½çš„åšæ³•ï¼šåŒ…è£…å¼‚å¸¸å¤„ç†
try {
    PaymentResult result = context.executePayment(amount);
    return result;
} catch (Exception e) {
    logger.error("æ”¯ä»˜å¤±è´¥", e);
    return new PaymentResult(false, "ç³»ç»Ÿå¼‚å¸¸", amount);
}
```

â‘¢ **æä¾›ç”¨æˆ·å‹å¥½çš„æç¤º**ï¼š
```java
// âœ… å¥½çš„åšæ³•ï¼šç»™ç”¨æˆ·æ¸…æ™°çš„åé¦ˆ
public String getPaymentStatusMessage(PaymentResult result) {
    if (result.isSuccess()) {
        return "æ”¯ä»˜æˆåŠŸï¼ä½¿ç”¨" + result.getMethod() + 
               "æ”¯ä»˜äº†" + result.getAmount() + "å…ƒ";
    } else {
        return "æ”¯ä»˜å¤±è´¥ï¼Œè¯·æ£€æŸ¥" + result.getMethod() + "è´¦æˆ·æˆ–é‡æ–°é€‰æ‹©æ”¯ä»˜æ–¹å¼";
    }
}
```

---

## 6. ğŸ”„ ç­–ç•¥é€‰æ‹©æœºåˆ¶


### 6.1 ç­–ç•¥é€‰æ‹©çš„é‡è¦æ€§


**ä¸ºä»€ä¹ˆéœ€è¦ç­–ç•¥é€‰æ‹©æœºåˆ¶**ï¼š
- ğŸ¯ **æ™ºèƒ½åŒ–**ï¼šæ ¹æ®æ¡ä»¶è‡ªåŠ¨é€‰æ‹©æœ€åˆé€‚çš„ç­–ç•¥
- âš¡ **æ•ˆç‡é«˜**ï¼šé¿å…ç”¨æˆ·æ‰‹åŠ¨é€‰æ‹©çš„ç¹ç
- ğŸ›¡ï¸ **å®¹é”™æ€§**ï¼šå½“æŸä¸ªç­–ç•¥ä¸å¯ç”¨æ—¶è‡ªåŠ¨åˆ‡æ¢
- ğŸ“Š **ä¼˜åŒ–æ€§**ï¼šåŸºäºå†å²æ•°æ®é€‰æ‹©æœ€ä¼˜ç­–ç•¥

### 6.2 åŸºäºæ¡ä»¶çš„ç­–ç•¥é€‰æ‹©


**æ ¹æ®é‡‘é¢é€‰æ‹©æ”¯ä»˜æ–¹å¼**ï¼š
```java
public class SmartPaymentSelector {
    
    public PaymentStrategy selectByAmount(double amount, String userId) {
        // å°é¢æ”¯ä»˜ï¼šä¼˜å…ˆå¾®ä¿¡ï¼ˆç¤¾äº¤åœºæ™¯å¤šï¼‰
        if (amount <= 100) {
            return new WechatStrategy(userId);
        }
        // ä¸­ç­‰é‡‘é¢ï¼šæ”¯ä»˜å®ï¼ˆé™é¢é«˜ï¼‰
        else if (amount <= 5000) {
            return new AlipayStrategy(userId);
        }
        // å¤§é¢æ”¯ä»˜ï¼šé“¶è¡Œå¡ï¼ˆæœ€å®‰å…¨ï¼‰
        else {
            return new BankCardStrategy(userId);
        }
    }
    
    // æ ¹æ®ç”¨æˆ·åå¥½é€‰æ‹©
    public PaymentStrategy selectByUserPreference(String userId) {
        UserPreference pref = getUserPreference(userId);
        
        switch (pref.getPreferredMethod()) {
            case ALIPAY: return new AlipayStrategy(userId);
            case WECHAT: return new WechatStrategy(userId);
            case BANK: return new BankCardStrategy(userId);
            default: return new AlipayStrategy(userId); // é»˜è®¤æ”¯ä»˜å®
        }
    }
}
```

### 6.3 ç­–ç•¥å·¥å‚æ¨¡å¼


**ä½¿ç”¨å·¥å‚æ¨¡å¼ç®¡ç†ç­–ç•¥åˆ›å»º**ï¼š
```java
public class PaymentStrategyFactory {
    
    // ç­–ç•¥æ³¨å†Œè¡¨
    private static final Map<String, Class<? extends PaymentStrategy>> strategies = 
        new HashMap<>();
    
    static {
        strategies.put("alipay", AlipayStrategy.class);
        strategies.put("wechat", WechatStrategy.class);
        strategies.put("bank", BankCardStrategy.class);
    }
    
    // åˆ›å»ºç­–ç•¥å®ä¾‹
    public static PaymentStrategy createStrategy(String type, String userInfo) {
        Class<? extends PaymentStrategy> strategyClass = strategies.get(type.toLowerCase());
        
        if (strategyClass == null) {
            throw new IllegalArgumentException("ä¸æ”¯æŒçš„æ”¯ä»˜ç±»å‹ï¼š" + type);
        }
        
        try {
            // ä½¿ç”¨åå°„åˆ›å»ºå®ä¾‹
            Constructor<? extends PaymentStrategy> constructor = 
                strategyClass.getConstructor(String.class);
            return constructor.newInstance(userInfo);
        } catch (Exception e) {
            throw new RuntimeException("åˆ›å»ºæ”¯ä»˜ç­–ç•¥å¤±è´¥", e);
        }
    }
    
    // è·å–æ‰€æœ‰æ”¯æŒçš„æ”¯ä»˜æ–¹å¼
    public static Set<String> getSupportedMethods() {
        return strategies.keySet();
    }
}
```

### 6.4 åŠ¨æ€ç­–ç•¥é€‰æ‹©


**è¿è¡Œæ—¶ç­–ç•¥é€‰æ‹©å™¨**ï¼š
```java
public class DynamicPaymentSelector {
    
    // ç­–ç•¥å¥åº·æ£€æŸ¥
    public boolean isStrategyAvailable(String strategyType) {
        switch (strategyType) {
            case "alipay":
                return checkAlipayService();
            case "wechat":
                return checkWechatService();
            case "bank":
                return checkBankService();
            default:
                return false;
        }
    }
    
    // è‡ªåŠ¨é€‰æ‹©å¯ç”¨ç­–ç•¥
    public PaymentStrategy selectAvailableStrategy(String userId, double amount) {
        List<String> preferredOrder = Arrays.asList("alipay", "wechat", "bank");
        
        for (String method : preferredOrder) {
            if (isStrategyAvailable(method)) {
                PaymentStrategy strategy = PaymentStrategyFactory.createStrategy(method, userId);
                
                // æ£€æŸ¥é‡‘é¢é™åˆ¶
                if (validateAmountLimit(strategy, amount)) {
                    System.out.println("é€‰æ‹©äº†å¯ç”¨çš„æ”¯ä»˜æ–¹å¼ï¼š" + method);
                    return strategy;
                }
            }
        }
        
        throw new RuntimeException("æ²¡æœ‰å¯ç”¨çš„æ”¯ä»˜æ–¹å¼");
    }
    
    private boolean validateAmountLimit(PaymentStrategy strategy, double amount) {
        if (strategy instanceof AlipayStrategy) {
            return amount <= 10000;
        } else if (strategy instanceof WechatStrategy) {
            return amount <= 5000;
        }
        return true; // é“¶è¡Œå¡æ— é™åˆ¶
    }
}
```

### 6.5 ç­–ç•¥é€‰æ‹©çš„é…ç½®åŒ–


**é€šè¿‡é…ç½®æ–‡ä»¶ç®¡ç†ç­–ç•¥é€‰æ‹©è§„åˆ™**ï¼š
```java
// ç­–ç•¥é…ç½®ç±»
public class PaymentConfig {
    private Map<String, StrategyRule> rules;
    
    public static class StrategyRule {
        private double maxAmount;
        private boolean enabled;
        private int priority;
        
        // getters and setters...
    }
    
    // æ ¹æ®é…ç½®é€‰æ‹©ç­–ç•¥
    public String selectStrategyByConfig(double amount) {
        return rules.entrySet().stream()
            .filter(entry -> entry.getValue().isEnabled())
            .filter(entry -> amount <= entry.getValue().getMaxAmount())
            .min(Map.Entry.comparingByValue(
                (r1, r2) -> Integer.compare(r1.getPriority(), r2.getPriority())
            ))
            .map(Map.Entry::getKey)
            .orElse("alipay"); // é»˜è®¤ç­–ç•¥
    }
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


> ğŸ¯ **ç­–ç•¥æ¨¡å¼ç»“æ„çš„ç²¾é«“**ï¼šåˆ†å·¥æ˜ç¡®ï¼Œå„å¸å…¶èŒï¼Œçµæ´»åä½œ

**ğŸ“Œ æ ¸å¿ƒç»„ä»¶ç†è§£**ï¼š
```
ğŸ”¸ ç­–ç•¥æ¥å£ï¼šå®šä¹‰"åšä»€ä¹ˆ"çš„æ ‡å‡†è§„èŒƒ
ğŸ”¸ å…·ä½“ç­–ç•¥ï¼šå®ç°"æ€ä¹ˆåš"çš„å…·ä½“æ–¹æ¡ˆ  
ğŸ”¸ ä¸Šä¸‹æ–‡ç±»ï¼šç®¡ç†"ä½•æ—¶åš"çš„æ‰§è¡Œæ§åˆ¶
ğŸ”¸ å®¢æˆ·ç«¯ï¼šå†³å®š"ç”¨å“ªä¸ª"çš„é€‰æ‹©å†³ç­–
ğŸ”¸ é€‰æ‹©æœºåˆ¶ï¼šä¼˜åŒ–"æ€ä¹ˆé€‰"çš„å†³ç­–é€»è¾‘
```

### 7.2 å…³é”®è®¾è®¡åŸåˆ™


**ğŸ”§ è®¾è®¡è¦ç‚¹å›é¡¾**ï¼š

â‘  **æ¥å£è®¾è®¡åŸåˆ™**ï¼š
- âœ… æ–¹æ³•è¦æŠ½è±¡ï¼Œä¸“æ³¨æ ¸å¿ƒåŠŸèƒ½
- âœ… å‚æ•°è¦é€šç”¨ï¼Œè€ƒè™‘æ‰©å±•æ€§
- âœ… å‘½åè¦æ¸…æ™°ï¼Œè¡¨è¾¾æ˜ç¡®æ„å›¾

â‘¡ **å…·ä½“ç­–ç•¥åŸåˆ™**ï¼š
- âœ… ä¸“æ³¨è‡ªå·±çš„ç®—æ³•å®ç°
- âœ… ä¸¥æ ¼éµå¾ªæ¥å£è§„èŒƒ
- âœ… å¤„ç†å¥½å¼‚å¸¸å’Œè¾¹ç•Œæƒ…å†µ

â‘¢ **ä¸Šä¸‹æ–‡ç±»åŸåˆ™**ï¼š
- âœ… åšå¥½ç­–ç•¥ç®¡ç†å’Œä»»åŠ¡åè°ƒ
- âœ… æä¾›å¿…è¦çš„éªŒè¯å’Œå¼‚å¸¸å¤„ç†
- âœ… ä¿æŒé€‚åº¦çš„åŠŸèƒ½è¾¹ç•Œ

â‘£ **å®¢æˆ·ç«¯ä½¿ç”¨åŸåˆ™**ï¼š
- âœ… åŠæ—¶æ£€æŸ¥ç­–ç•¥çŠ¶æ€
- âœ… å¦¥å–„å¤„ç†å¼‚å¸¸æƒ…å†µ
- âœ… æä¾›å‹å¥½çš„ç”¨æˆ·ä½“éªŒ

### 7.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ’¼ ä¸šåŠ¡åœºæ™¯åº”ç”¨**ï¼š
- **æ”¯ä»˜ç³»ç»Ÿ**ï¼šå¤šç§æ”¯ä»˜æ–¹å¼çš„ç»Ÿä¸€ç®¡ç†
- **è®¡ç®—å¼•æ“**ï¼šä¸åŒç®—æ³•çš„åŠ¨æ€åˆ‡æ¢
- **æ•°æ®å¤„ç†**ï¼šå¤šç§å¤„ç†ç­–ç•¥çš„çµæ´»é€‰æ‹©
- **æ–‡ä»¶å¤„ç†**ï¼šä¸åŒæ ¼å¼çš„è§£æç­–ç•¥

**ğŸ”§ æŠ€æœ¯ä¼˜åŠ¿ä½“ç°**ï¼š
- **æ‰©å±•æ€§å¼º**ï¼šæ–°å¢ç­–ç•¥ä¸å½±å“ç°æœ‰ä»£ç 
- **ç»´æŠ¤æ€§å¥½**ï¼šç­–ç•¥ç‹¬ç«‹ï¼Œä¾¿äºå•ç‹¬è°ƒè¯•
- **å¤ç”¨æ€§é«˜**ï¼šç­–ç•¥å¯ä»¥åœ¨ä¸åŒä¸Šä¸‹æ–‡ä¸­é‡ç”¨
- **æµ‹è¯•å‹å¥½**ï¼šæ¯ä¸ªç­–ç•¥å¯ä»¥ç‹¬ç«‹æµ‹è¯•

### 7.4 å­¦ä¹ è¦ç‚¹å¼ºåŒ–


**ğŸ§  è®°å¿†è¦ç‚¹**ï¼š
- ç­–ç•¥æ¨¡å¼ = æ¥å£å®šæ ‡å‡† + å®ç°å„æœ‰æ–¹ + ä¸Šä¸‹æ–‡åè°ƒ + å®¢æˆ·é€‰æ–¹æ¡ˆ
- ç»“æ„æ¸…æ™°ï¼šä¸€ä¸ªæ¥å£ï¼Œå¤šä¸ªå®ç°ï¼Œä¸€ä¸ªç®¡ç†ï¼Œå®¢æˆ·é€‰æ‹©
- æ ¸å¿ƒä»·å€¼ï¼šç®—æ³•æ—çš„å°è£…ä¸å¯æ›¿æ¢æ€§
- ä½¿ç”¨åœºæ™¯ï¼šåŒä¸€é—®é¢˜æœ‰å¤šç§è§£å†³æ–¹æ¡ˆçš„æƒ…å†µ

**âš ï¸ å¸¸è§è¯¯åŒº**ï¼š
- âŒ æŠŠç­–ç•¥æ¨¡å¼å½“æˆç®€å•çš„if-elseæ›¿æ¢
- âŒ åœ¨ç­–ç•¥ä¸­åŒ…å«è¿‡å¤šçš„ä¸šåŠ¡é€»è¾‘
- âŒ å¿½ç•¥ç­–ç•¥é€‰æ‹©æœºåˆ¶çš„é‡è¦æ€§
- âŒ ä¸è€ƒè™‘ç­–ç•¥çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
> ç­–ç•¥æ¨¡å¼ç»“æ„æ¸…ï¼Œæ¥å£å®šä¹‰è¦åˆ†æ˜  
> å…·ä½“å®ç°å„æ˜¾èƒ½ï¼Œä¸Šä¸‹æ–‡é‡Œåšåè°ƒ  
> å®¢æˆ·é€‰æ‹©è¦æ™ºèƒ½ï¼ŒåŠ¨æ€åˆ‡æ¢æ˜¾ç¥é€š  
> æ‰©å±•ç»´æŠ¤éƒ½è½»æ¾ï¼Œä»£ç å¤ç”¨ä»·å€¼é«˜