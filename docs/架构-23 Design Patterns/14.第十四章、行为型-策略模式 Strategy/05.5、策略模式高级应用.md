---
title: 5ã€ç­–ç•¥æ¨¡å¼é«˜çº§åº”ç”¨
---
## ğŸ“š ç›®å½•

1. [ç­–ç•¥æ¨¡å¼åŸºç¡€å›é¡¾](#1-ç­–ç•¥æ¨¡å¼åŸºç¡€å›é¡¾)
2. [ç­–ç•¥ç»„åˆæ¨¡å¼](#2-ç­–ç•¥ç»„åˆæ¨¡å¼)
3. [åŠ¨æ€ç­–ç•¥åŠ è½½](#3-åŠ¨æ€ç­–ç•¥åŠ è½½)
4. [ç­–ç•¥é“¾è®¾è®¡](#4-ç­–ç•¥é“¾è®¾è®¡)
5. [ç­–ç•¥æ¨¡å¼ä¸çŠ¶æ€æ¨¡å¼](#5-ç­–ç•¥æ¨¡å¼ä¸çŠ¶æ€æ¨¡å¼)
6. [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#6-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ç­–ç•¥æ¨¡å¼åŸºç¡€å›é¡¾


### 1.1 ç­–ç•¥æ¨¡å¼æ˜¯ä»€ä¹ˆ


**ğŸ  ç”Ÿæ´»ç±»æ¯”**
> æƒ³è±¡ä½ è¦å»ä¸Šç­ï¼Œå¯ä»¥é€‰æ‹©å¼€è½¦ã€ååœ°é“æˆ–éª‘è‡ªè¡Œè½¦ã€‚è¿™ä¸‰ç§æ–¹å¼å°±æ˜¯ä¸åŒçš„"ç­–ç•¥"ï¼Œæ ¹æ®å¤©æ°”ã€æ—¶é—´ã€å¿ƒæƒ…æ¥é€‰æ‹©æœ€åˆé€‚çš„æ–¹å¼ã€‚

**ğŸ“ æ ¸å¿ƒå®šä¹‰**
```
ç­–ç•¥æ¨¡å¼ï¼šå®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼ŒæŠŠå®ƒä»¬å°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢
ç›®çš„ï¼šè®©ç®—æ³•çš„å˜åŒ–ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·ç«¯
æœ¬è´¨ï¼šå°†"åšä»€ä¹ˆ"å’Œ"æ€ä¹ˆåš"åˆ†ç¦»
```

### 1.2 åŸºæœ¬ç»“æ„å›é¡¾


```
å®¢æˆ·ç«¯ä½¿ç”¨ï¼š           ç­–ç•¥æ¥å£ï¼š              å…·ä½“ç­–ç•¥ï¼š
Context              Strategy               ConcreteStrategyA
  |                     |                  ConcreteStrategyB  
  |---->ä½¿ç”¨------------>|                  ConcreteStrategyC
  |                     |
  |                  å®šä¹‰è§„èŒƒ               å®ç°å…·ä½“ç®—æ³•
é€‰æ‹©ç­–ç•¥              (æŠ½è±¡æ–¹æ³•)             (ä¸åŒå®ç°)
```

**ğŸ’¡ å…³é”®ç†è§£**
- **Contextï¼ˆä¸Šä¸‹æ–‡ï¼‰**ï¼šå°±åƒé¥æ§å™¨ï¼Œè´Ÿè´£è°ƒç”¨ç­–ç•¥
- **Strategyï¼ˆç­–ç•¥æ¥å£ï¼‰**ï¼šå°±åƒç”µå™¨çš„ç»Ÿä¸€æ¥å£ï¼Œå®šä¹‰è§„èŒƒ
- **ConcreteStrategyï¼ˆå…·ä½“ç­–ç•¥ï¼‰**ï¼šå°±åƒä¸åŒå“ç‰Œçš„ç”µå™¨ï¼ŒåŠŸèƒ½ç›¸åŒä½†å®ç°ä¸åŒ

### 1.3 ç®€å•ç¤ºä¾‹å›é¡¾


```java
// ç­–ç•¥æ¥å£ - å®šä¹‰åšäº‹çš„è§„èŒƒ
interface PaymentStrategy {
    void pay(double amount);
}

// å…·ä½“ç­–ç•¥ - ä¸åŒçš„å®ç°æ–¹å¼
class CreditCardPayment implements PaymentStrategy {
    public void pay(double amount) {
        System.out.println("ç”¨ä¿¡ç”¨å¡æ”¯ä»˜: " + amount);
    }
}

class AlipayPayment implements PaymentStrategy {
    public void pay(double amount) {
        System.out.println("ç”¨æ”¯ä»˜å®æ”¯ä»˜: " + amount);
    }
}

// ä¸Šä¸‹æ–‡ - ä½¿ç”¨ç­–ç•¥çš„åœ°æ–¹
class ShoppingCart {
    private PaymentStrategy strategy;
    
    public void setPaymentStrategy(PaymentStrategy strategy) {
        this.strategy = strategy;
    }
    
    public void checkout(double amount) {
        strategy.pay(amount);  // è°ƒç”¨å½“å‰ç­–ç•¥
    }
}
```

---

## 2. ğŸ”— ç­–ç•¥ç»„åˆæ¨¡å¼


### 2.1 ä»€ä¹ˆæ˜¯ç­–ç•¥ç»„åˆ


**ğŸ  ç”Ÿæ´»ç±»æ¯”**
> åšèœæ—¶ï¼Œä½ å¯èƒ½éœ€è¦å…ˆæ´—èœã€å†åˆ‡èœã€æœ€åç‚’èœã€‚æ¯ä¸ªæ­¥éª¤éƒ½æœ‰ä¸åŒçš„æ–¹æ³•ï¼Œç»„åˆèµ·æ¥å½¢æˆä¸€é“å®Œæ•´çš„èœã€‚ç­–ç•¥ç»„åˆå°±æ˜¯æŠŠå¤šä¸ªç­–ç•¥æŒ‰é¡ºåºæˆ–æ¡ä»¶ç»„åˆä½¿ç”¨ã€‚

**ğŸ“‹ æ ¸å¿ƒæ¦‚å¿µ**
```
ç­–ç•¥ç»„åˆï¼šå°†å¤šä¸ªç­–ç•¥æŒ‰ç…§ä¸€å®šè§„åˆ™ç»„åˆèµ·æ¥ä½¿ç”¨
åº”ç”¨åœºæ™¯ï¼š
- æ•°æ®å¤„ç†ç®¡é“ï¼ˆæ¸…æ´—â†’è½¬æ¢â†’å­˜å‚¨ï¼‰
- æƒé™éªŒè¯é“¾ï¼ˆèº«ä»½è®¤è¯â†’æˆæƒæ£€æŸ¥â†’èµ„æºè®¿é—®ï¼‰
- å›¾åƒå¤„ç†æµç¨‹ï¼ˆæ»¤é•œâ†’è°ƒè‰²â†’å‹ç¼©ï¼‰
```

### 2.2 ç»„åˆç­–ç•¥çš„å®ç°æ–¹å¼


#### ğŸ¯ æ–¹å¼ä¸€ï¼šé¡ºåºç»„åˆç­–ç•¥


```java
// æ•°æ®å¤„ç†ç­–ç•¥æ¥å£
interface DataProcessor {
    String process(String data);
}

// å…·ä½“å¤„ç†ç­–ç•¥
class DataCleanStrategy implements DataProcessor {
    public String process(String data) {
        return data.trim().replaceAll("\\s+", " ");  // æ¸…ç†ç©ºæ ¼
    }
}

class DataEncryptStrategy implements DataProcessor {
    public String process(String data) {
        return "encrypted_" + data;  // ç®€å•åŠ å¯†
    }
}

class DataCompressStrategy implements DataProcessor {
    public String process(String data) {
        return "compressed_" + data;  // ç®€å•å‹ç¼©
    }
}

// ç»„åˆç­–ç•¥æ‰§è¡Œå™¨
class DataProcessingPipeline {
    private List<DataProcessor> processors = new ArrayList<>();
    
    public void addProcessor(DataProcessor processor) {
        processors.add(processor);
    }
    
    public String processData(String data) {
        String result = data;
        for (DataProcessor processor : processors) {
            result = processor.process(result);
            System.out.println("å¤„ç†æ­¥éª¤: " + result);
        }
        return result;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
DataProcessingPipeline pipeline = new DataProcessingPipeline();
pipeline.addProcessor(new DataCleanStrategy());
pipeline.addProcessor(new DataEncryptStrategy());
pipeline.addProcessor(new DataCompressStrategy());

String result = pipeline.processData("  hello   world  ");
// è¾“å‡ºï¼š
// å¤„ç†æ­¥éª¤: hello world
// å¤„ç†æ­¥éª¤: encrypted_hello world
// å¤„ç†æ­¥éª¤: compressed_encrypted_hello world
```

#### ğŸ¯ æ–¹å¼äºŒï¼šæ¡ä»¶ç»„åˆç­–ç•¥


```java
// ä¿ƒé”€ç­–ç•¥æ¥å£
interface DiscountStrategy {
    double applyDiscount(double price);
    boolean isApplicable(Customer customer);
}

// å…·ä½“ä¿ƒé”€ç­–ç•¥
class VipDiscountStrategy implements DiscountStrategy {
    public double applyDiscount(double price) {
        return price * 0.8;  // VIPæ‰“8æŠ˜
    }
    
    public boolean isApplicable(Customer customer) {
        return customer.isVip();
    }
}

class NewUserDiscountStrategy implements DiscountStrategy {
    public double applyDiscount(double price) {
        return price - 10;  // æ–°ç”¨æˆ·å‡10å…ƒ
    }
    
    public boolean isApplicable(Customer customer) {
        return customer.isNewUser();
    }
}

// ç»„åˆä¿ƒé”€è®¡ç®—å™¨
class ComboDiscountCalculator {
    private List<DiscountStrategy> strategies = new ArrayList<>();
    
    public void addStrategy(DiscountStrategy strategy) {
        strategies.add(strategy);
    }
    
    public double calculateFinalPrice(double originalPrice, Customer customer) {
        double finalPrice = originalPrice;
        
        for (DiscountStrategy strategy : strategies) {
            if (strategy.isApplicable(customer)) {
                double newPrice = strategy.applyDiscount(finalPrice);
                System.out.println("åº”ç”¨ç­–ç•¥ï¼Œä»·æ ¼ä» " + finalPrice + " å˜ä¸º " + newPrice);
                finalPrice = newPrice;
            }
        }
        
        return finalPrice;
    }
}
```

### 2.3 ç­–ç•¥ç»„åˆçš„è®¾è®¡è¦ç‚¹


**âš ï¸ æ³¨æ„äº‹é¡¹**
```
ç­–ç•¥é¡ºåºï¼šç»„åˆç­–ç•¥æ—¶è¦è€ƒè™‘æ‰§è¡Œé¡ºåºçš„å½±å“
ä¾èµ–å…³ç³»ï¼šæŸäº›ç­–ç•¥å¯èƒ½ä¾èµ–äºå‰é¢ç­–ç•¥çš„ç»“æœ
å†²çªå¤„ç†ï¼šä¸åŒç­–ç•¥å¯èƒ½äº§ç”Ÿå†²çªï¼Œéœ€è¦å®šä¹‰ä¼˜å…ˆçº§
æ€§èƒ½è€ƒè™‘ï¼šè¿‡å¤šçš„ç­–ç•¥ç»„åˆå¯èƒ½å½±å“æ€§èƒ½
```

**ğŸ¯ æœ€ä½³å®è·µ**
- ğŸ“Œ **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªç­–ç•¥åªè´Ÿè´£ä¸€ä¸ªç‰¹å®šåŠŸèƒ½
- ğŸ“Œ **é¡ºåºæ˜ç¡®**ï¼šç»„åˆç­–ç•¥æ—¶æ˜ç¡®æ‰§è¡Œé¡ºåº
- ğŸ“Œ **å¯é…ç½®åŒ–**ï¼šæ”¯æŒåŠ¨æ€æ·»åŠ å’Œç§»é™¤ç­–ç•¥
- ğŸ“Œ **å¼‚å¸¸å¤„ç†**ï¼šè€ƒè™‘æŸä¸ªç­–ç•¥å¤±è´¥æ—¶çš„å¤„ç†æ–¹å¼

---

## 3. âš¡ åŠ¨æ€ç­–ç•¥åŠ è½½


### 3.1 ä»€ä¹ˆæ˜¯åŠ¨æ€ç­–ç•¥åŠ è½½


**ğŸ  ç”Ÿæ´»ç±»æ¯”**
> å°±åƒæ‰‹æœºAppå¯ä»¥åœ¨åº”ç”¨å•†åº—ä¸‹è½½æ–°åŠŸèƒ½ä¸€æ ·ï¼ŒåŠ¨æ€ç­–ç•¥åŠ è½½è®©ç¨‹åºåœ¨è¿è¡Œæ—¶æ ¹æ®éœ€è¦åŠ è½½æ–°çš„ç­–ç•¥ï¼Œè€Œä¸éœ€è¦é‡å¯ç¨‹åºã€‚

**ğŸ“‹ æ ¸å¿ƒæ¦‚å¿µ**
```
åŠ¨æ€ç­–ç•¥åŠ è½½ï¼šåœ¨ç¨‹åºè¿è¡Œæ—¶æ ¹æ®æ¡ä»¶åŠ¨æ€é€‰æ‹©å’ŒåŠ è½½ç­–ç•¥
ä¼˜åŠ¿ï¼š
- çµæ´»æ€§é«˜ï¼šå¯ä»¥æ ¹æ®å®æ—¶æƒ…å†µé€‰æ‹©ç­–ç•¥
- æ‰©å±•æ€§å¼ºï¼šæ–°å¢ç­–ç•¥ä¸éœ€è¦ä¿®æ”¹ç°æœ‰ä»£ç 
- å¯é…ç½®ï¼šé€šè¿‡é…ç½®æ–‡ä»¶æˆ–æ•°æ®åº“æ§åˆ¶ç­–ç•¥é€‰æ‹©
```

### 3.2 åŸºäºé…ç½®çš„åŠ¨æ€åŠ è½½


#### ğŸ”§ é…ç½®æ–‡ä»¶æ–¹å¼


```java
// ç­–ç•¥é…ç½®ç±»
class StrategyConfig {
    private String name;
    private String className;
    private Map<String, String> parameters;
    
    // getters and setters...
}

// ç­–ç•¥å·¥å‚
class StrategyFactory {
    private static Map<String, Class<?>> strategyClasses = new HashMap<>();
    
    // æ³¨å†Œç­–ç•¥ç±»
    static {
        strategyClasses.put("fast", FastProcessStrategy.class);
        strategyClasses.put("accurate", AccurateProcessStrategy.class);
        strategyClasses.put("balanced", BalancedProcessStrategy.class);
    }
    
    // åŠ¨æ€åˆ›å»ºç­–ç•¥
    public static ProcessStrategy createStrategy(String strategyName) {
        try {
            Class<?> clazz = strategyClasses.get(strategyName);
            if (clazz != null) {
                return (ProcessStrategy) clazz.newInstance();
            }
        } catch (Exception e) {
            System.out.println("åˆ›å»ºç­–ç•¥å¤±è´¥: " + e.getMessage());
        }
        
        // é»˜è®¤ç­–ç•¥
        return new DefaultProcessStrategy();
    }
}

// åŠ¨æ€ç­–ç•¥ç®¡ç†å™¨
class DynamicStrategyManager {
    private ProcessStrategy currentStrategy;
    private String configFile = "strategy-config.properties";
    
    public void loadStrategy() {
        try {
            Properties props = new Properties();
            props.load(new FileInputStream(configFile));
            
            String strategyName = props.getProperty("current.strategy", "default");
            currentStrategy = StrategyFactory.createStrategy(strategyName);
            
            System.out.println("åŠ è½½ç­–ç•¥: " + strategyName);
        } catch (IOException e) {
            System.out.println("åŠ è½½é…ç½®å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤ç­–ç•¥");
            currentStrategy = new DefaultProcessStrategy();
        }
    }
    
    public void executeStrategy(String data) {
        if (currentStrategy == null) {
            loadStrategy();
        }
        currentStrategy.process(data);
    }
    
    // çƒ­æ›´æ–°ç­–ç•¥
    public void reloadStrategy() {
        loadStrategy();
        System.out.println("ç­–ç•¥å·²çƒ­æ›´æ–°");
    }
}
```

#### ğŸ“Š è¿è¡Œæ—¶ç­–ç•¥é€‰æ‹©


```java
// æ™ºèƒ½ç­–ç•¥é€‰æ‹©å™¨
class IntelligentStrategySelector {
    private Map<String, ProcessStrategy> strategies = new HashMap<>();
    
    public IntelligentStrategySelector() {
        strategies.put("low_traffic", new FastProcessStrategy());
        strategies.put("high_traffic", new OptimizedProcessStrategy());
        strategies.put("peak_hours", new BalancedProcessStrategy());
    }
    
    public ProcessStrategy selectStrategy(SystemContext context) {
        // æ ¹æ®ç³»ç»ŸçŠ¶æ€åŠ¨æ€é€‰æ‹©ç­–ç•¥
        if (context.getCpuUsage() > 80) {
            System.out.println("CPUä½¿ç”¨ç‡é«˜ï¼Œé€‰æ‹©è½»é‡çº§ç­–ç•¥");
            return strategies.get("low_traffic");
        }
        
        if (context.getCurrentTime().getHour() >= 9 && 
            context.getCurrentTime().getHour() <= 18) {
            System.out.println("å·¥ä½œæ—¶é—´ï¼Œé€‰æ‹©å¹³è¡¡ç­–ç•¥");
            return strategies.get("peak_hours");
        }
        
        System.out.println("æ­£å¸¸æ—¶æ®µï¼Œé€‰æ‹©æ ‡å‡†ç­–ç•¥");
        return strategies.get("high_traffic");
    }
}

// ä½¿ç”¨ç¤ºä¾‹
class AdaptiveProcessor {
    private IntelligentStrategySelector selector = new IntelligentStrategySelector();
    
    public void processData(String data, SystemContext context) {
        ProcessStrategy strategy = selector.selectStrategy(context);
        strategy.process(data);
    }
}
```

### 3.3 åŸºäºæ³¨è§£çš„ç­–ç•¥å‘ç°


```java
// ç­–ç•¥æ³¨è§£
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
@interface StrategyComponent {
    String name();
    int priority() default 0;
}

// ä½¿ç”¨æ³¨è§£æ ‡è®°ç­–ç•¥
@StrategyComponent(name = "quickSort", priority = 1)
class QuickSortStrategy implements SortStrategy {
    public void sort(int[] array) {
        System.out.println("ä½¿ç”¨å¿«é€Ÿæ’åº");
        // å¿«é€Ÿæ’åºå®ç°
    }
}

@StrategyComponent(name = "mergeSort", priority = 2)
class MergeSortStrategy implements SortStrategy {
    public void sort(int[] array) {
        System.out.println("ä½¿ç”¨å½’å¹¶æ’åº");
        // å½’å¹¶æ’åºå®ç°
    }
}

// ç­–ç•¥æ‰«æå™¨
class StrategyScanner {
    public Map<String, SortStrategy> scanStrategies(String packageName) {
        Map<String, SortStrategy> strategies = new HashMap<>();
        
        // ç®€åŒ–çš„åŒ…æ‰«æé€»è¾‘
        List<Class<?>> classes = findClassesInPackage(packageName);
        
        for (Class<?> clazz : classes) {
            if (clazz.isAnnotationPresent(StrategyComponent.class)) {
                StrategyComponent annotation = clazz.getAnnotation(StrategyComponent.class);
                try {
                    SortStrategy strategy = (SortStrategy) clazz.newInstance();
                    strategies.put(annotation.name(), strategy);
                    System.out.println("å‘ç°ç­–ç•¥: " + annotation.name());
                } catch (Exception e) {
                    System.out.println("åˆ›å»ºç­–ç•¥å®ä¾‹å¤±è´¥: " + clazz.getName());
                }
            }
        }
        
        return strategies;
    }
}
```

---

## 4. ğŸ”— ç­–ç•¥é“¾è®¾è®¡


### 4.1 ç­–ç•¥é“¾çš„æ¦‚å¿µ


**ğŸ  ç”Ÿæ´»ç±»æ¯”**
> å°±åƒæµæ°´çº¿ç”Ÿäº§ï¼Œæ¯ä¸ªå·¥äººè´Ÿè´£ä¸€ä¸ªç¯èŠ‚ï¼Œäº§å“ä¾æ¬¡ç»è¿‡æ¯ä¸ªå·¥ä½ã€‚ç­–ç•¥é“¾å°±æ˜¯è®©æ•°æ®ä¾æ¬¡ç»è¿‡å¤šä¸ªç­–ç•¥å¤„ç†ï¼Œæ¯ä¸ªç­–ç•¥éƒ½æœ‰æœºä¼šå¯¹æ•°æ®è¿›è¡Œå¤„ç†æˆ–å†³å®šæ˜¯å¦ç»§ç»­ã€‚

**ğŸ“‹ æ ¸å¿ƒç‰¹ç‚¹**
```
ç­–ç•¥é“¾ï¼šå¤šä¸ªç­–ç•¥æŒ‰é“¾å¼ç»“æ„è¿æ¥ï¼Œä¾æ¬¡å¤„ç†è¯·æ±‚
ç‰¹ç‚¹ï¼š
- æ¯ä¸ªç­–ç•¥å¯ä»¥å¤„ç†è¯·æ±‚æˆ–ä¼ é€’ç»™ä¸‹ä¸€ä¸ªç­–ç•¥
- æ”¯æŒåŠ¨æ€æ·»åŠ å’Œç§»é™¤ç­–ç•¥èŠ‚ç‚¹
- å¯ä»¥åœ¨ä»»æ„ä½ç½®ä¸­æ–­å¤„ç†é“¾
```

### 4.2 è´£ä»»é“¾å¼ç­–ç•¥å®ç°


```java
// æŠ½è±¡ç­–ç•¥å¤„ç†å™¨
abstract class AbstractStrategyHandler {
    protected AbstractStrategyHandler nextHandler;
    
    public void setNext(AbstractStrategyHandler nextHandler) {
        this.nextHandler = nextHandler;
    }
    
    public abstract boolean handle(ProcessRequest request);
    
    protected void passToNext(ProcessRequest request) {
        if (nextHandler != null) {
            nextHandler.handle(request);
        }
    }
}

// å…·ä½“ç­–ç•¥å¤„ç†å™¨
class ValidationStrategyHandler extends AbstractStrategyHandler {
    public boolean handle(ProcessRequest request) {
        System.out.println("æ‰§è¡Œæ•°æ®éªŒè¯ç­–ç•¥");
        
        if (request.getData() == null || request.getData().isEmpty()) {
            System.out.println("æ•°æ®éªŒè¯å¤±è´¥ï¼Œç»ˆæ­¢å¤„ç†");
            return false;  // éªŒè¯å¤±è´¥ï¼Œä¸ç»§ç»­å¤„ç†
        }
        
        System.out.println("æ•°æ®éªŒè¯é€šè¿‡");
        passToNext(request);  // ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå¤„ç†å™¨
        return true;
    }
}

class TransformStrategyHandler extends AbstractStrategyHandler {
    public boolean handle(ProcessRequest request) {
        System.out.println("æ‰§è¡Œæ•°æ®è½¬æ¢ç­–ç•¥");
        
        // è½¬æ¢æ•°æ®
        String transformedData = request.getData().toUpperCase();
        request.setData(transformedData);
        
        System.out.println("æ•°æ®è½¬æ¢å®Œæˆ: " + transformedData);
        passToNext(request);
        return true;
    }
}

class SaveStrategyHandler extends AbstractStrategyHandler {
    public boolean handle(ProcessRequest request) {
        System.out.println("æ‰§è¡Œæ•°æ®ä¿å­˜ç­–ç•¥");
        
        // ä¿å­˜æ•°æ®é€»è¾‘
        System.out.println("æ•°æ®å·²ä¿å­˜: " + request.getData());
        
        passToNext(request);
        return true;
    }
}

// ç­–ç•¥é“¾æ„å»ºå™¨
class StrategyChainBuilder {
    private AbstractStrategyHandler firstHandler;
    private AbstractStrategyHandler lastHandler;
    
    public StrategyChainBuilder addHandler(AbstractStrategyHandler handler) {
        if (firstHandler == null) {
            firstHandler = handler;
            lastHandler = handler;
        } else {
            lastHandler.setNext(handler);
            lastHandler = handler;
        }
        return this;
    }
    
    public AbstractStrategyHandler build() {
        return firstHandler;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
StrategyChainBuilder builder = new StrategyChainBuilder();
AbstractStrategyHandler chain = builder
    .addHandler(new ValidationStrategyHandler())
    .addHandler(new TransformStrategyHandler())
    .addHandler(new SaveStrategyHandler())
    .build();

ProcessRequest request = new ProcessRequest("hello world");
chain.handle(request);
```

### 4.3 å¯ä¸­æ–­çš„ç­–ç•¥é“¾


```java
// å¸¦æœ‰ä¸­æ–­æœºåˆ¶çš„ç­–ç•¥é“¾
class InterruptibleStrategyChain {
    private List<InterruptibleStrategy> strategies = new ArrayList<>();
    
    public void addStrategy(InterruptibleStrategy strategy) {
        strategies.add(strategy);
    }
    
    public ProcessResult executeChain(ProcessRequest request) {
        ProcessResult result = new ProcessResult();
        
        for (int i = 0; i < strategies.size(); i++) {
            InterruptibleStrategy strategy = strategies.get(i);
            
            System.out.println("æ‰§è¡Œç­–ç•¥ " + (i + 1) + ": " + strategy.getName());
            
            StrategyResult strategyResult = strategy.execute(request);
            result.addStepResult(strategyResult);
            
            // æ£€æŸ¥æ˜¯å¦éœ€è¦ä¸­æ–­
            if (strategyResult.shouldInterrupt()) {
                System.out.println("ç­–ç•¥é“¾åœ¨ç¬¬ " + (i + 1) + " æ­¥ä¸­æ–­");
                result.setInterrupted(true);
                result.setInterruptReason(strategyResult.getInterruptReason());
                break;
            }
            
            // æ£€æŸ¥æ˜¯å¦éœ€è¦è·³è¿‡åç»­ç­–ç•¥
            if (strategyResult.shouldSkipRemaining()) {
                System.out.println("è·³è¿‡å‰©ä½™ç­–ç•¥");
                break;
            }
        }
        
        return result;
    }
}

// å¯ä¸­æ–­çš„ç­–ç•¥æ¥å£
interface InterruptibleStrategy {
    String getName();
    StrategyResult execute(ProcessRequest request);
}

// ç­–ç•¥æ‰§è¡Œç»“æœ
class StrategyResult {
    private boolean success;
    private boolean interrupt;
    private boolean skipRemaining;
    private String interruptReason;
    private Object data;
    
    // ä¾¿æ·æ–¹æ³•
    public static StrategyResult success() {
        StrategyResult result = new StrategyResult();
        result.success = true;
        return result;
    }
    
    public static StrategyResult interrupt(String reason) {
        StrategyResult result = new StrategyResult();
        result.interrupt = true;
        result.interruptReason = reason;
        return result;
    }
    
    public static StrategyResult skipRemaining() {
        StrategyResult result = new StrategyResult();
        result.success = true;
        result.skipRemaining = true;
        return result;
    }
}
```

### 4.4 ç­–ç•¥é“¾çš„åº”ç”¨åœºæ™¯


**ğŸ“Š å¸¸è§åº”ç”¨åœºæ™¯**

| åº”ç”¨é¢†åŸŸ | **å…·ä½“åœºæ™¯** | **ç­–ç•¥é“¾ä½œç”¨** |
|---------|------------|---------------|
| **Webè¯·æ±‚å¤„ç†** | `è®¤è¯â†’æˆæƒâ†’å‚æ•°éªŒè¯â†’ä¸šåŠ¡å¤„ç†` | `ç¡®ä¿è¯·æ±‚ç»è¿‡å®Œæ•´çš„å®‰å…¨æ£€æŸ¥` |
| **æ•°æ®å¤„ç†æµæ°´çº¿** | `æ¸…æ´—â†’è½¬æ¢â†’éªŒè¯â†’å­˜å‚¨` | `ä¿è¯æ•°æ®è´¨é‡å’Œå¤„ç†æµç¨‹` |
| **è®¢å•å¤„ç†ç³»ç»Ÿ** | `åº“å­˜æ£€æŸ¥â†’ä»·æ ¼è®¡ç®—â†’æ”¯ä»˜å¤„ç†â†’å‘è´§` | `ç¡®ä¿è®¢å•å¤„ç†çš„å®Œæ•´æ€§` |
| **å†…å®¹å®¡æ ¸ç³»ç»Ÿ** | `æ•æ„Ÿè¯è¿‡æ»¤â†’å›¾ç‰‡æ£€æµ‹â†’äººå·¥å®¡æ ¸` | `å¤šå±‚æ¬¡å†…å®¹å®‰å…¨ä¿éšœ` |

**ğŸ¯ è®¾è®¡åŸåˆ™**
- ğŸ“Œ **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªç­–ç•¥åªè´Ÿè´£ä¸€ä¸ªç‰¹å®šä»»åŠ¡
- ğŸ“Œ **æ¾è€¦åˆ**ï¼šç­–ç•¥ä¹‹é—´ä¸ç›´æ¥ä¾èµ–
- ğŸ“Œ **å¯æ‰©å±•**ï¼šæ”¯æŒåŠ¨æ€æ·»åŠ æ–°ç­–ç•¥
- ğŸ“Œ **å¯è§‚æµ‹**ï¼šè®°å½•æ¯ä¸ªç­–ç•¥çš„æ‰§è¡Œç»“æœ

---

## 5. ğŸ”„ ç­–ç•¥æ¨¡å¼ä¸çŠ¶æ€æ¨¡å¼


### 5.1 ä¸¤ç§æ¨¡å¼çš„åŒºåˆ«ä¸è”ç³»


**ğŸ  ç”Ÿæ´»ç±»æ¯”**
> **ç­–ç•¥æ¨¡å¼**å°±åƒé€‰æ‹©äº¤é€šå·¥å…·ï¼šä½ ä¸»åŠ¨å†³å®šä»Šå¤©å¼€è½¦è¿˜æ˜¯ååœ°é“
> **çŠ¶æ€æ¨¡å¼**å°±åƒçº¢ç»¿ç¯ï¼šç³»ç»Ÿæ ¹æ®å½“å‰çŠ¶æ€è‡ªåŠ¨åˆ‡æ¢è¡Œä¸º

**ğŸ“‹ æ ¸å¿ƒåŒºåˆ«**

| å¯¹æ¯”ç»´åº¦ | **ç­–ç•¥æ¨¡å¼** | **çŠ¶æ€æ¨¡å¼** |
|---------|------------|------------|
| **æ§åˆ¶æ–¹å¼** | `å®¢æˆ·ç«¯ä¸»åŠ¨é€‰æ‹©ç­–ç•¥` | `å¯¹è±¡æ ¹æ®çŠ¶æ€è‡ªåŠ¨åˆ‡æ¢` |
| **å˜åŒ–è§¦å‘** | `å¤–éƒ¨æ¡ä»¶å†³å®š` | `å†…éƒ¨çŠ¶æ€å˜åŒ–é©±åŠ¨` |
| **ç­–ç•¥å…³ç³»** | `ç­–ç•¥é—´ç›¸äº’ç‹¬ç«‹` | `çŠ¶æ€é—´æœ‰è½¬æ¢å…³ç³»` |
| **ä½¿ç”¨åœºæ™¯** | `ç®—æ³•é€‰æ‹©ã€è¡Œä¸ºå®šåˆ¶` | `çŠ¶æ€æœºã€ç”Ÿå‘½å‘¨æœŸç®¡ç†` |

### 5.2 ç­–ç•¥æ¨¡å¼è½¬çŠ¶æ€æ¨¡å¼


æœ‰æ—¶å€™ï¼Œå¤æ‚çš„ç­–ç•¥é€‰æ‹©é€»è¾‘å¯ä»¥è½¬æ¢ä¸ºçŠ¶æ€æ¨¡å¼æ¥ç®¡ç†ï¼š

```java
// æ¸¸æˆè§’è‰²çš„æ”»å‡»ç­–ç•¥ï¼ˆç­–ç•¥æ¨¡å¼ç‰ˆæœ¬ï¼‰
interface AttackStrategy {
    void attack();
}

class NormalAttackStrategy implements AttackStrategy {
    public void attack() {
        System.out.println("æ™®é€šæ”»å‡»ï¼šé€ æˆ 10 ç‚¹ä¼¤å®³");
    }
}

class PowerAttackStrategy implements AttackStrategy {
    public void attack() {
        System.out.println("å¼ºåŠ›æ”»å‡»ï¼šé€ æˆ 20 ç‚¹ä¼¤å®³");
    }
}

class SuperAttackStrategy implements AttackStrategy {
    public void attack() {
        System.out.println("è¶…çº§æ”»å‡»ï¼šé€ æˆ 50 ç‚¹ä¼¤å®³");
    }
}

// è½¬æ¢ä¸ºçŠ¶æ€æ¨¡å¼ç‰ˆæœ¬
abstract class CharacterState {
    protected GameCharacter character;
    
    public CharacterState(GameCharacter character) {
        this.character = character;
    }
    
    public abstract void attack();
    public abstract void useSkill();
    public abstract void checkStateTransition();
}

class NormalState extends CharacterState {
    public NormalState(GameCharacter character) {
        super(character);
    }
    
    public void attack() {
        System.out.println("æ™®é€šæ”»å‡»ï¼šé€ æˆ 10 ç‚¹ä¼¤å®³");
        character.increaseEnergy(5);
        checkStateTransition();
    }
    
    public void useSkill() {
        System.out.println("èƒ½é‡ä¸è¶³ï¼Œæ— æ³•ä½¿ç”¨æŠ€èƒ½");
    }
    
    public void checkStateTransition() {
        if (character.getEnergy() >= 50) {
            System.out.println("èƒ½é‡å……è¶³ï¼Œè¿›å…¥å¼ºåŠ›çŠ¶æ€");
            character.setState(new PowerState(character));
        }
    }
}

class PowerState extends CharacterState {
    public PowerState(GameCharacter character) {
        super(character);
    }
    
    public void attack() {
        System.out.println("å¼ºåŠ›æ”»å‡»ï¼šé€ æˆ 20 ç‚¹ä¼¤å®³");
        character.decreaseEnergy(10);
        checkStateTransition();
    }
    
    public void useSkill() {
        System.out.println("ä½¿ç”¨æŠ€èƒ½ï¼šé€ æˆ 30 ç‚¹ä¼¤å®³");
        character.increaseEnergy(20);
        checkStateTransition();
    }
    
    public void checkStateTransition() {
        if (character.getEnergy() >= 100) {
            System.out.println("èƒ½é‡çˆ†æ»¡ï¼Œè¿›å…¥è¶…çº§çŠ¶æ€");
            character.setState(new SuperState(character));
        } else if (character.getEnergy() < 20) {
            System.out.println("èƒ½é‡ä¸è¶³ï¼Œå›åˆ°æ™®é€šçŠ¶æ€");
            character.setState(new NormalState(character));
        }
    }
}

// æ¸¸æˆè§’è‰²ç±»
class GameCharacter {
    private CharacterState state;
    private int energy = 0;
    
    public GameCharacter() {
        state = new NormalState(this);
    }
    
    public void attack() {
        state.attack();
    }
    
    public void useSkill() {
        state.useSkill();
    }
    
    public void setState(CharacterState state) {
        this.state = state;
    }
    
    // èƒ½é‡ç®¡ç†
    public void increaseEnergy(int amount) {
        energy = Math.min(energy + amount, 100);
        System.out.println("å½“å‰èƒ½é‡ï¼š" + energy);
    }
    
    public void decreaseEnergy(int amount) {
        energy = Math.max(energy - amount, 0);
        System.out.println("å½“å‰èƒ½é‡ï¼š" + energy);
    }
    
    public int getEnergy() {
        return energy;
    }
}
```

### 5.3 æ··åˆä½¿ç”¨åœºæ™¯


åœ¨å¤æ‚ç³»ç»Ÿä¸­ï¼Œç­–ç•¥æ¨¡å¼å’ŒçŠ¶æ€æ¨¡å¼å¯ä»¥ç»“åˆä½¿ç”¨ï¼š

```java
// è®¢å•å¤„ç†ç³»ç»Ÿï¼šçŠ¶æ€æ¨¡å¼ç®¡ç†è®¢å•çŠ¶æ€ï¼Œç­–ç•¥æ¨¡å¼å¤„ç†å…·ä½“ä¸šåŠ¡
abstract class OrderState {
    protected Order order;
    
    public abstract void payOrder();
    public abstract void cancelOrder();
    public abstract void shipOrder();
}

class PendingPaymentState extends OrderState {
    public void payOrder() {
        // æ ¹æ®è®¢å•ç±»å‹é€‰æ‹©ä¸åŒçš„æ”¯ä»˜ç­–ç•¥
        PaymentStrategy strategy = PaymentStrategyFactory.getStrategy(order.getType());
        boolean success = strategy.processPayment(order);
        
        if (success) {
            order.setState(new PaidState());
            System.out.println("è®¢å•æ”¯ä»˜æˆåŠŸï¼ŒçŠ¶æ€è½¬ä¸ºå·²æ”¯ä»˜");
        }
    }
    
    public void cancelOrder() {
        order.setState(new CancelledState());
        System.out.println("è®¢å•å·²å–æ¶ˆ");
    }
    
    public void shipOrder() {
        System.out.println("è®¢å•æœªæ”¯ä»˜ï¼Œæ— æ³•å‘è´§");
    }
}

class PaidState extends OrderState {
    public void payOrder() {
        System.out.println("è®¢å•å·²æ”¯ä»˜ï¼Œæ— éœ€é‡å¤æ”¯ä»˜");
    }
    
    public void cancelOrder() {
        // å·²æ”¯ä»˜è®¢å•å–æ¶ˆéœ€è¦é€€æ¬¾ç­–ç•¥
        RefundStrategy strategy = RefundStrategyFactory.getStrategy(order.getPaymentMethod());
        strategy.processRefund(order);
        
        order.setState(new CancelledState());
        System.out.println("è®¢å•å·²å–æ¶ˆå¹¶é€€æ¬¾");
    }
    
    public void shipOrder() {
        // æ ¹æ®å•†å“ç±»å‹é€‰æ‹©é…é€ç­–ç•¥
        ShippingStrategy strategy = ShippingStrategyFactory.getStrategy(order.getShippingType());
        strategy.ship(order);
        
        order.setState(new ShippedState());
        System.out.println("è®¢å•å·²å‘è´§");
    }
}
```

**ğŸ’¡ å…³é”®ç†è§£**
- **ç­–ç•¥æ¨¡å¼**ï¼šè§£å†³"å¦‚ä½•åš"çš„é—®é¢˜ï¼Œå…³æ³¨ç®—æ³•å’Œè¡Œä¸ºçš„é€‰æ‹©
- **çŠ¶æ€æ¨¡å¼**ï¼šè§£å†³"ä»€ä¹ˆæ—¶å€™åš"çš„é—®é¢˜ï¼Œå…³æ³¨çŠ¶æ€å˜åŒ–å’Œè¡Œä¸ºåˆ‡æ¢
- **ç»“åˆä½¿ç”¨**ï¼šçŠ¶æ€æ¨¡å¼ç®¡ç†å¯¹è±¡ç”Ÿå‘½å‘¨æœŸï¼Œç­–ç•¥æ¨¡å¼å¤„ç†å…·ä½“ä¸šåŠ¡é€»è¾‘

---

## 6. âš¡ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


### 6.1 ç­–ç•¥ç¼“å­˜ä¼˜åŒ–


**ğŸ  ç”Ÿæ´»ç±»æ¯”**
> å°±åƒå¸¸ç”¨çš„å·¥å…·æ”¾åœ¨æ‰‹è¾¹ï¼Œé¿å…æ¯æ¬¡éƒ½å»å·¥å…·ç®±ç¿»æ‰¾ã€‚ç­–ç•¥ç¼“å­˜è®©æˆ‘ä»¬æŠŠå¸¸ç”¨çš„ç­–ç•¥å®ä¾‹ä¿å­˜èµ·æ¥ï¼Œé¿å…é‡å¤åˆ›å»ºã€‚

### ç­–ç•¥å®ä¾‹ç¼“å­˜


```java
// ç­–ç•¥ç¼“å­˜ç®¡ç†å™¨
class StrategyCache {
    private static final Map<String, Object> strategyCache = new ConcurrentHashMap<>();
    private static final int MAX_CACHE_SIZE = 100;
    
    @SuppressWarnings("unchecked")
    public static <T> T getStrategy(String key, Class<T> strategyClass) {
        T strategy = (T) strategyCache.get(key);
        
        if (strategy == null) {
            synchronized (StrategyCache.class) {
                // åŒé‡æ£€æŸ¥é”å®š
                strategy = (T) strategyCache.get(key);
                if (strategy == null) {
                    strategy = createStrategy(strategyClass);
                    
                    // ç¼“å­˜å¤§å°æ§åˆ¶
                    if (strategyCache.size() >= MAX_CACHE_SIZE) {
                        clearOldestEntries();
                    }
                    
                    strategyCache.put(key, strategy);
                    System.out.println("åˆ›å»ºå¹¶ç¼“å­˜ç­–ç•¥: " + key);
                }
            }
        } else {
            System.out.println("ä»ç¼“å­˜è·å–ç­–ç•¥: " + key);
        }
        
        return strategy;
    }
    
    private static <T> T createStrategy(Class<T> strategyClass) {
        try {
            return strategyClass.newInstance();
        } catch (Exception e) {
            throw new RuntimeException("åˆ›å»ºç­–ç•¥å¤±è´¥: " + strategyClass.getName(), e);
        }
    }
    
    private static void clearOldestEntries() {
        // ç®€å•çš„LRUå®ç°ï¼šæ¸…ç†å‰10ä¸ªæ¡ç›®
        Iterator<String> iterator = strategyCache.keySet().iterator();
        int count = 0;
        while (iterator.hasNext() && count < 10) {
            iterator.next();
            iterator.remove();
            count++;
        }
        System.out.println("æ¸…ç†äº† " + count + " ä¸ªæ—§ç¼“å­˜æ¡ç›®");
    }
    
    public static void clearCache() {
        strategyCache.clear();
        System.out.println("æ¸…ç©ºç­–ç•¥ç¼“å­˜");
    }
}

// ä¼˜åŒ–åçš„ç­–ç•¥å·¥å‚
class OptimizedStrategyFactory {
    public static SortStrategy getSortStrategy(String algorithmName) {
        String cacheKey = "sort_" + algorithmName;
        
        switch (algorithmName.toLowerCase()) {
            case "quick":
                return StrategyCache.getStrategy(cacheKey, QuickSortStrategy.class);
            case "merge":
                return StrategyCache.getStrategy(cacheKey, MergeSortStrategy.class);
            case "heap":
                return StrategyCache.getStrategy(cacheKey, HeapSortStrategy.class);
            default:
                return StrategyCache.getStrategy("sort_default", DefaultSortStrategy.class);
        }
    }
}
```

### 6.2 ç­–ç•¥é¢„çƒ­æœºåˆ¶


```java
// ç­–ç•¥é¢„çƒ­å™¨
class StrategyPreWarmer {
    private static final List<Class<?>> COMMON_STRATEGIES = Arrays.asList(
        QuickSortStrategy.class,
        MergeSortStrategy.class,
        CreditCardPaymentStrategy.class,
        AlipayPaymentStrategy.class
    );
    
    public static void preWarmStrategies() {
        System.out.println("å¼€å§‹é¢„çƒ­å¸¸ç”¨ç­–ç•¥...");
        
        for (Class<?> strategyClass : COMMON_STRATEGIES) {
            String cacheKey = "prewarm_" + strategyClass.getSimpleName();
            StrategyCache.getStrategy(cacheKey, strategyClass);
        }
        
        System.out.println("ç­–ç•¥é¢„çƒ­å®Œæˆ");
    }
    
    // åº”ç”¨å¯åŠ¨æ—¶è°ƒç”¨
    public static void initializeOnStartup() {
        // åœ¨åå°çº¿ç¨‹ä¸­é¢„çƒ­ï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹
        new Thread(() -> {
            try {
                Thread.sleep(2000);  // ç­‰å¾…åº”ç”¨åŸºæœ¬å¯åŠ¨å®Œæˆ
                preWarmStrategies();
            } catch (InterruptedException e) {
                Thread.currentThread().interrupt();
            }
        }, "strategy-prewarmer").start();
    }
}
```

### 6.3 ç­–ç•¥é€‰æ‹©ä¼˜åŒ–


#### ğŸ¯ æ™ºèƒ½ç­–ç•¥é€‰æ‹©ç¼“å­˜


```java
// ç­–ç•¥é€‰æ‹©å†å²è®°å½•
class StrategySelectionOptimizer {
    private Map<String, String> selectionHistory = new ConcurrentHashMap<>();
    private Map<String, Integer> strategyUsageCount = new ConcurrentHashMap<>();
    private Map<String, Double> strategyPerformance = new ConcurrentHashMap<>();
    
    public String selectOptimalStrategy(String context, List<String> availableStrategies) {
        // é¦–å…ˆæ£€æŸ¥æ˜¯å¦æœ‰å†å²æœ€ä¼˜é€‰æ‹©
        String historicalBest = selectionHistory.get(context);
        if (historicalBest != null && availableStrategies.contains(historicalBest)) {
            System.out.println("ä½¿ç”¨å†å²æœ€ä¼˜ç­–ç•¥: " + historicalBest);
            return historicalBest;
        }
        
        // æ ¹æ®ä½¿ç”¨é¢‘ç‡å’Œæ€§èƒ½é€‰æ‹©
        String bestStrategy = availableStrategies.stream()
            .max((s1, s2) -> {
                double score1 = calculateStrategyScore(s1);
                double score2 = calculateStrategyScore(s2);
                return Double.compare(score1, score2);
            })
            .orElse(availableStrategies.get(0));
        
        System.out.println("é€‰æ‹©æœ€ä¼˜ç­–ç•¥: " + bestStrategy);
        return bestStrategy;
    }
    
    private double calculateStrategyScore(String strategy) {
        int usage = strategyUsageCount.getOrDefault(strategy, 0);
        double performance = strategyPerformance.getOrDefault(strategy, 1.0);
        
        // ç»¼åˆè€ƒè™‘ä½¿ç”¨é¢‘ç‡å’Œæ€§èƒ½è¡¨ç°
        return usage * 0.3 + performance * 0.7;
    }
    
    public void recordStrategyUsage(String context, String strategy, double executionTime) {
        // è®°å½•ä½¿ç”¨æƒ…å†µ
        strategyUsageCount.merge(strategy, 1, Integer::sum);
        
        // æ›´æ–°æ€§èƒ½æŒ‡æ ‡ï¼ˆè¶Šå°è¶Šå¥½ï¼Œæ‰€ä»¥å–å€’æ•°ï¼‰
        double performanceScore = 1000.0 / Math.max(executionTime, 1.0);
        strategyPerformance.merge(strategy, performanceScore, 
            (oldValue, newValue) -> (oldValue + newValue) / 2);
        
        // æ›´æ–°å†å²æœ€ä¼˜é€‰æ‹©
        String currentBest = selectionHistory.get(context);
        if (currentBest == null || 
            calculateStrategyScore(strategy) > calculateStrategyScore(currentBest)) {
            selectionHistory.put(context, strategy);
        }
    }
}
```

### 6.4 æ‰¹é‡å¤„ç†ä¼˜åŒ–


```java
// æ‰¹é‡ç­–ç•¥å¤„ç†å™¨
class BatchStrategyProcessor {
    private Map<String, List<ProcessRequest>> strategyGroups = new HashMap<>();
    private int batchSize = 10;
    private long batchTimeout = 100; // æ¯«ç§’
    
    public void submitRequest(ProcessRequest request, String strategyType) {
        strategyGroups.computeIfAbsent(strategyType, k -> new ArrayList<>()).add(request);
        
        // æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰¹é‡å¤„ç†
        List<ProcessRequest> requests = strategyGroups.get(strategyType);
        if (requests.size() >= batchSize) {
            processBatch(strategyType, new ArrayList<>(requests));
            requests.clear();
        }
    }
    
    private void processBatch(String strategyType, List<ProcessRequest> requests) {
        System.out.println("æ‰¹é‡å¤„ç† " + requests.size() + " ä¸ªè¯·æ±‚ï¼Œç­–ç•¥ç±»å‹: " + strategyType);
        
        ProcessStrategy strategy = StrategyCache.getStrategy(strategyType, getStrategyClass(strategyType));
        
        // æ‰¹é‡å¤„ç†ï¼Œå‡å°‘ç­–ç•¥åˆ‡æ¢å¼€é”€
        long startTime = System.currentTimeMillis();
        for (ProcessRequest request : requests) {
            strategy.process(request.getData());
        }
        long endTime = System.currentTimeMillis();
        
        System.out.println("æ‰¹é‡å¤„ç†å®Œæˆï¼Œè€—æ—¶: " + (endTime - startTime) + "ms");
    }
    
    // å®šæ—¶å¤„ç†æœªæ»¡æ‰¹æ¬¡çš„è¯·æ±‚
    public void flushPendingRequests() {
        for (Map.Entry<String, List<ProcessRequest>> entry : strategyGroups.entrySet()) {
            List<ProcessRequest> requests = entry.getValue();
            if (!requests.isEmpty()) {
                processBatch(entry.getKey(), new ArrayList<>(requests));
                requests.clear();
            }
        }
    }
}
```

### 6.5 æ€§èƒ½ç›‘æ§ä¸è°ƒä¼˜


```java
// ç­–ç•¥æ€§èƒ½ç›‘æ§å™¨
class StrategyPerformanceMonitor {
    private Map<String, PerformanceMetrics> metricsMap = new ConcurrentHashMap<>();
    
    public void recordExecution(String strategyName, long executionTime, boolean success) {
        metricsMap.computeIfAbsent(strategyName, k -> new PerformanceMetrics())
                 .recordExecution(executionTime, success);
    }
    
    public void printPerformanceReport() {
        System.out.println("\n===== ç­–ç•¥æ€§èƒ½æŠ¥å‘Š =====");
        metricsMap.forEach((strategyName, metrics) -> {
            System.out.printf("ç­–ç•¥: %s\n", strategyName);
            System.out.printf("  æ‰§è¡Œæ¬¡æ•°: %d\n", metrics.getExecutionCount());
            System.out.printf("  å¹³å‡è€—æ—¶: %.2f ms\n", metrics.getAverageTime());
            System.out.printf("  æˆåŠŸç‡: %.2f%%\n", metrics.getSuccessRate());
            System.out.printf("  æœ€å¤§è€—æ—¶: %d ms\n", metrics.getMaxTime());
            System.out.printf("  æœ€å°è€—æ—¶: %d ms\n\n", metrics.getMinTime());
        });
    }
    
    public List<String> getSlowStrategies(double thresholdMs) {
        return metricsMap.entrySet().stream()
            .filter(entry -> entry.getValue().getAverageTime() > thresholdMs)
            .map(Map.Entry::getKey)
            .collect(Collectors.toList());
    }
}

// æ€§èƒ½æŒ‡æ ‡ç±»
class PerformanceMetrics {
    private long totalExecutions = 0;
    private long totalTime = 0;
    private long successCount = 0;
    private long maxTime = 0;
    private long minTime = Long.MAX_VALUE;
    
    public synchronized void recordExecution(long executionTime, boolean success) {
        totalExecutions++;
        totalTime += executionTime;
        
        if (success) {
            successCount++;
        }
        
        maxTime = Math.max(maxTime, executionTime);
        minTime = Math.min(minTime, executionTime);
    }
    
    public double getAverageTime() {
        return totalExecutions > 0 ? (double) totalTime / totalExecutions : 0;
    }
    
    public double getSuccessRate() {
        return totalExecutions > 0 ? (double) successCount / totalExecutions * 100 : 0;
    }
    
    // å…¶ä»–getteræ–¹æ³•...
    public long getExecutionCount() { return totalExecutions; }
    public long getMaxTime() { return maxTime; }
    public long getMinTime() { return minTime == Long.MAX_VALUE ? 0 : minTime; }
}
```

**ğŸ¯ æ€§èƒ½ä¼˜åŒ–è¦ç‚¹**
- ğŸ“Œ **ç¼“å­˜ç­–ç•¥å®ä¾‹**ï¼šé¿å…é‡å¤åˆ›å»ºç­–ç•¥å¯¹è±¡
- ğŸ“Œ **é¢„çƒ­æœºåˆ¶**ï¼šåº”ç”¨å¯åŠ¨æ—¶é¢„åŠ è½½å¸¸ç”¨ç­–ç•¥
- ğŸ“Œ **æ™ºèƒ½é€‰æ‹©**ï¼šåŸºäºå†å²æ•°æ®ä¼˜åŒ–ç­–ç•¥é€‰æ‹©
- ğŸ“Œ **æ‰¹é‡å¤„ç†**ï¼šç›¸åŒç­–ç•¥çš„è¯·æ±‚æ‰¹é‡å¤„ç†
- ğŸ“Œ **æ€§èƒ½ç›‘æ§**ï¼šæŒç»­ç›‘æ§å’Œä¼˜åŒ–ç­–ç•¥æ€§èƒ½

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ç­–ç•¥ç»„åˆï¼šå¤šä¸ªç­–ç•¥æŒ‰é¡ºåºæˆ–æ¡ä»¶ç»„åˆä½¿ç”¨
ğŸ”¸ åŠ¨æ€åŠ è½½ï¼šè¿è¡Œæ—¶æ ¹æ®é…ç½®æˆ–æ¡ä»¶é€‰æ‹©ç­–ç•¥
ğŸ”¸ ç­–ç•¥é“¾è®¾è®¡ï¼šå¤šä¸ªç­–ç•¥å½¢æˆå¤„ç†é“¾ï¼Œæ”¯æŒä¸­æ–­å’Œè·³è½¬
ğŸ”¸ ä¸çŠ¶æ€æ¨¡å¼åŒºåˆ«ï¼šç­–ç•¥å…³æ³¨ç®—æ³•é€‰æ‹©ï¼ŒçŠ¶æ€å…³æ³¨è¡Œä¸ºåˆ‡æ¢
ğŸ”¸ æ€§èƒ½ä¼˜åŒ–ï¼šç¼“å­˜ã€é¢„çƒ­ã€ç›‘æ§æå‡ç­–ç•¥æ‰§è¡Œæ•ˆç‡
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ç­–ç•¥ç»„åˆçš„ä»·å€¼**
```
çµæ´»æ€§ï¼šå¯ä»¥ä»»æ„ç»„åˆä¸åŒç­–ç•¥
å¯æ‰©å±•ï¼šæ–°å¢ç­–ç•¥ä¸å½±å“ç°æœ‰ç»„åˆ
å¯å¤ç”¨ï¼šåŒä¸€ç­–ç•¥å¯åœ¨å¤šä¸ªç»„åˆä¸­ä½¿ç”¨
å¯é…ç½®ï¼šé€šè¿‡é…ç½®åŠ¨æ€è°ƒæ•´ç»„åˆæ–¹å¼
```

**ğŸ”¹ åŠ¨æ€åŠ è½½çš„é€‚ç”¨åœºæ™¯**
```
é…ç½®é©±åŠ¨ï¼šæ ¹æ®é…ç½®æ–‡ä»¶é€‰æ‹©ç­–ç•¥
æ¡ä»¶åˆ¤æ–­ï¼šæ ¹æ®è¿è¡Œæ—¶æ¡ä»¶é€‰æ‹©ç­–ç•¥
A/Bæµ‹è¯•ï¼šåŠ¨æ€åˆ‡æ¢ä¸åŒçš„ä¸šåŠ¡ç­–ç•¥
æ’ä»¶ç³»ç»Ÿï¼šæ”¯æŒç¬¬ä¸‰æ–¹ç­–ç•¥æ‰©å±•
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–çš„å…³é”®ç‚¹**
```
å‡å°‘åˆ›å»ºå¼€é”€ï¼šç¼“å­˜ç­–ç•¥å®ä¾‹
æé«˜é€‰æ‹©æ•ˆç‡ï¼šæ™ºèƒ½ç­–ç•¥é€‰æ‹©
æ‰¹é‡å¤„ç†ï¼šå‡å°‘ç­–ç•¥åˆ‡æ¢æˆæœ¬
ç›‘æ§è°ƒä¼˜ï¼šåŸºäºæ•°æ®æŒç»­ä¼˜åŒ–
```

### 7.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ“Š é€‰æ‹©åˆé€‚çš„å®ç°æ–¹å¼**

| åœºæ™¯ | **æ¨èæ–¹å¼** | **ç†ç”±** |
|------|------------|---------|
| **ç®€å•ç­–ç•¥é€‰æ‹©** | `åŸºç¡€ç­–ç•¥æ¨¡å¼` | `å®ç°ç®€å•ï¼Œæ˜“äºç†è§£` |
| **å¤šæ­¥éª¤å¤„ç†** | `ç­–ç•¥ç»„åˆæ¨¡å¼` | `æ”¯æŒå¤æ‚çš„å¤„ç†æµç¨‹` |
| **çµæ´»é…ç½®** | `åŠ¨æ€ç­–ç•¥åŠ è½½` | `æ— éœ€ä¿®æ”¹ä»£ç å³å¯è°ƒæ•´` |
| **æµæ°´çº¿å¤„ç†** | `ç­–ç•¥é“¾è®¾è®¡` | `æ”¯æŒä¸­æ–­å’Œæ¡ä»¶è·³è½¬` |
| **é«˜æ€§èƒ½è¦æ±‚** | `ç¼“å­˜+æ‰¹é‡å¤„ç†` | `å‡å°‘å¼€é”€ï¼Œæå‡æ•ˆç‡` |

**ğŸ¯ è®¾è®¡åŸåˆ™**
- ğŸ“Œ **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªç­–ç•¥åªè´Ÿè´£ä¸€ä¸ªç‰¹å®šåŠŸèƒ½
- ğŸ“Œ **å¼€æ”¾å°é—­**ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­
- ğŸ“Œ **ä¾èµ–å€’ç½®**ï¼šä¾èµ–æŠ½è±¡ï¼Œä¸ä¾èµ–å…·ä½“å®ç°
- ğŸ“Œ **ç»„åˆä¼˜äºç»§æ‰¿**ï¼šé€šè¿‡ç»„åˆå®ç°å¤æ‚åŠŸèƒ½

### 7.4 é¿å…å¸¸è§è¯¯åŒº


**âš ï¸ å¸¸è§é—®é¢˜**
```
è¿‡åº¦è®¾è®¡ï¼šç®€å•åœºæ™¯ä½¿ç”¨å¤æ‚çš„ç­–ç•¥ç»„åˆ
æ€§èƒ½å¿½è§†ï¼šé¢‘ç¹åˆ›å»ºç­–ç•¥å®ä¾‹å½±å“æ€§èƒ½
ç¼ºä¹ç›‘æ§ï¼šä¸äº†è§£ç­–ç•¥çš„å®é™…ä½¿ç”¨æƒ…å†µ
é…ç½®å¤æ‚ï¼šåŠ¨æ€é…ç½®è¿‡äºå¤æ‚éš¾ä»¥ç»´æŠ¤
```

**âœ… æœ€ä½³å®è·µ**
- ğŸ”¸ **æ¸è¿›å¼è®¾è®¡**ï¼šä»ç®€å•å¼€å§‹ï¼Œé€æ­¥å¢åŠ å¤æ‚æ€§
- ğŸ”¸ **æ€§èƒ½ä¼˜å…ˆ**ï¼šåœ¨è®¾è®¡é˜¶æ®µè€ƒè™‘æ€§èƒ½å½±å“
- ğŸ”¸ **å¯è§‚æµ‹æ€§**ï¼šæ·»åŠ å¿…è¦çš„ç›‘æ§å’Œæ—¥å¿—
- ğŸ”¸ **æ–‡æ¡£å®Œå–„**ï¼šæ¸…æ™°è®°å½•ç­–ç•¥çš„ä½¿ç”¨æ–¹å¼å’Œé…ç½®

### 7.5 å­¦ä¹ æ£€æŸ¥ç‚¹


**ğŸ“ è‡ªæˆ‘æ£€æµ‹**
- [ ] èƒ½å¤Ÿè§£é‡Šç­–ç•¥æ¨¡å¼çš„åŸºæœ¬æ¦‚å¿µå’Œç»“æ„
- [ ] ç†è§£ç­–ç•¥ç»„åˆçš„ä¸åŒå®ç°æ–¹å¼
- [ ] æŒæ¡åŠ¨æ€ç­–ç•¥åŠ è½½çš„è®¾è®¡æ–¹æ³•
- [ ] çŸ¥é“ç­–ç•¥é“¾è®¾è®¡çš„åº”ç”¨åœºæ™¯
- [ ] äº†è§£ç­–ç•¥æ¨¡å¼ä¸çŠ¶æ€æ¨¡å¼çš„åŒºåˆ«
- [ ] èƒ½å¤Ÿè®¾è®¡æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ

**ğŸ’ª å®è·µæŒ‘æˆ˜**
1. è®¾è®¡ä¸€ä¸ªæ–‡ä»¶å¤„ç†ç³»ç»Ÿï¼Œæ”¯æŒå¤šç§å¤„ç†ç­–ç•¥çš„ç»„åˆ
2. å®ç°ä¸€ä¸ªå¯åŠ¨æ€é…ç½®çš„æ’åºç®—æ³•é€‰æ‹©å™¨
3. åˆ›å»ºä¸€ä¸ªæ”¯æŒä¸­æ–­çš„æ•°æ®éªŒè¯ç­–ç•¥é“¾
4. æ„å»ºä¸€ä¸ªé«˜æ€§èƒ½çš„ç­–ç•¥ç¼“å­˜ç³»ç»Ÿ

**ğŸ”— æ‰©å±•å­¦ä¹ **
- ğŸ“– **æ·±å…¥å­¦ä¹ **ï¼šè´£ä»»é“¾æ¨¡å¼ã€å‘½ä»¤æ¨¡å¼
- ğŸ¥ **å®æˆ˜é¡¹ç›®**ï¼šæ„å»ºå®Œæ•´çš„ç­–ç•¥ç®¡ç†æ¡†æ¶
- ğŸ’» **ä»£ç ç»ƒä¹ **ï¼šåœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨ç­–ç•¥æ¨¡å¼

**ğŸ¯ æ ¸å¿ƒè®°å¿†**
> ç­–ç•¥æ¨¡å¼é«˜çº§åº”ç”¨çš„æ ¸å¿ƒæ˜¯**çµæ´»ç»„åˆ**å’Œ**åŠ¨æ€é€‰æ‹©**ã€‚é€šè¿‡ç­–ç•¥ç»„åˆå®ç°å¤æ‚åŠŸèƒ½ï¼Œé€šè¿‡åŠ¨æ€åŠ è½½é€‚åº”å˜åŒ–éœ€æ±‚ï¼Œé€šè¿‡æ€§èƒ½ä¼˜åŒ–ä¿è¯ç³»ç»Ÿæ•ˆç‡ã€‚è®°ä½ï¼š**ç®€å•å¼€å§‹ï¼Œæ¸è¿›å¢å¼ºï¼Œæ€§èƒ½ä¸ºå…ˆï¼Œç›‘æ§ä¿éšœ**ã€‚