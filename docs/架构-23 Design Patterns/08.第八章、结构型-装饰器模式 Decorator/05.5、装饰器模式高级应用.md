---
title: 5ã€è£…é¥°å™¨æ¨¡å¼é«˜çº§åº”ç”¨
---
## ğŸ“š ç›®å½•

1. [è£…é¥°å™¨æ¨¡å¼å›é¡¾ä¸è¿›é˜¶å‡†å¤‡](#1-è£…é¥°å™¨æ¨¡å¼å›é¡¾ä¸è¿›é˜¶å‡†å¤‡)
2. [åŠ¨æ€è£…é¥°å™¨æ³¨å†Œ](#2-åŠ¨æ€è£…é¥°å™¨æ³¨å†Œ)
3. [æ³¨è§£é©±åŠ¨è£…é¥°å™¨](#3-æ³¨è§£é©±åŠ¨è£…é¥°å™¨)
4. [AOPåˆ‡é¢è£…é¥°](#4-AOPåˆ‡é¢è£…é¥°)
5. [è£…é¥°å™¨å·¥å‚](#5-è£…é¥°å™¨å·¥å‚)
6. [é…ç½®åŒ–è£…é¥°é“¾](#6-é…ç½®åŒ–è£…é¥°é“¾)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”„ è£…é¥°å™¨æ¨¡å¼å›é¡¾ä¸è¿›é˜¶å‡†å¤‡


### 1.1 è£…é¥°å™¨æ¨¡å¼åŸºç¡€å›é¡¾


**ğŸ¯ ä»€ä¹ˆæ˜¯è£…é¥°å™¨æ¨¡å¼**
> è£…é¥°å™¨æ¨¡å¼å°±åƒç»™æ‰‹æœºè´´è†œã€æˆ´ä¿æŠ¤å¥—ä¸€æ ·ï¼Œåœ¨ä¸æ”¹å˜æ‰‹æœºæœ¬èº«çš„æƒ…å†µä¸‹ï¼Œç»™å®ƒå¢åŠ æ–°çš„åŠŸèƒ½å’Œä¿æŠ¤ã€‚

```
åŸºç¡€è£…é¥°å™¨æ€è·¯ï¼š
åŸå§‹å¯¹è±¡ â†’ è£…é¥°å™¨1 â†’ è£…é¥°å™¨2 â†’ æœ€ç»ˆå¯¹è±¡
   â†“         â†“         â†“         â†“
  æ ¸å¿ƒåŠŸèƒ½   +åŠŸèƒ½A    +åŠŸèƒ½B    å®Œæ•´åŠŸèƒ½
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦é«˜çº§åº”ç”¨


**ğŸ”¸ åŸºç¡€è£…é¥°å™¨çš„é™åˆ¶**
- è£…é¥°å™¨éœ€è¦æ‰‹å·¥ç¼–å†™å’Œç»„åˆ
- æ— æ³•æ ¹æ®æ¡ä»¶åŠ¨æ€é€‰æ‹©è£…é¥°å™¨
- è£…é¥°å™¨çš„é¡ºåºå’Œé…ç½®å†™æ­»åœ¨ä»£ç é‡Œ
- éš¾ä»¥ç»Ÿä¸€ç®¡ç†å¤§é‡è£…é¥°å™¨

**ğŸš€ é«˜çº§åº”ç”¨è§£å†³çš„é—®é¢˜**
```
â“ å¦‚ä½•è®©ç¨‹åºè‡ªåŠ¨é€‰æ‹©éœ€è¦çš„è£…é¥°å™¨ï¼Ÿ
â“ å¦‚ä½•é€šè¿‡é…ç½®æ–‡ä»¶æ§åˆ¶è£…é¥°å™¨çš„è¡Œä¸ºï¼Ÿ
â“ å¦‚ä½•åƒSpring AOPä¸€æ ·è‡ªåŠ¨è£…é¥°æ–¹æ³•ï¼Ÿ
â“ å¦‚ä½•æ‰¹é‡ç”Ÿäº§å„ç§è£…é¥°å™¨ï¼Ÿ
â“ å¦‚ä½•è®©éç¨‹åºå‘˜ä¹Ÿèƒ½é…ç½®è£…é¥°å™¨ï¼Ÿ
```

---

## 2. ğŸ”§ åŠ¨æ€è£…é¥°å™¨æ³¨å†Œ


### 2.1 ä»€ä¹ˆæ˜¯åŠ¨æ€æ³¨å†Œ


**ğŸ’¡ ç”Ÿæ´»ç±»æ¯”**
> æƒ³è±¡ä¸€ä¸ªæ™ºèƒ½å’–å•¡æœºï¼Œä½ å¯ä»¥å‘Šè¯‰å®ƒ"æˆ‘ä»Šå¤©æƒ³åŠ ç³–ã€åŠ å¥¶ã€ä¸è¦å’–å•¡å› "ï¼Œæœºå™¨ä¼šè‡ªåŠ¨é€‰æ‹©å¯¹åº”çš„å¤„ç†æ¨¡å—ï¼Œè€Œä¸éœ€è¦ä½ æ‰‹å·¥ç»„è£…æ¯ä¸ªéƒ¨ä»¶ã€‚

**ğŸ¯ æ ¸å¿ƒæ€æƒ³**
- ç¨‹åºè¿è¡Œæ—¶æ‰å†³å®šä½¿ç”¨å“ªäº›è£…é¥°å™¨
- æ ¹æ®æ¡ä»¶è‡ªåŠ¨é€‰æ‹©å’Œç»„åˆè£…é¥°å™¨
- è£…é¥°å™¨å¯ä»¥éšæ—¶æ³¨å†Œå’Œæ³¨é”€

### 2.2 åŠ¨æ€æ³¨å†Œçš„å®ç°


**ğŸ“‹ æ³¨å†Œä¸­å¿ƒè®¾è®¡**
```java
// è£…é¥°å™¨æ³¨å†Œä¸­å¿ƒ - å°±åƒä¸€ä¸ªè£…é¥°å™¨çš„ä»“åº“
public class DecoratorRegistry {
    // å­˜å‚¨æ‰€æœ‰å¯ç”¨çš„è£…é¥°å™¨ç±»å‹
    private Map<String, Class<? extends Decorator>> decorators = new HashMap<>();
    
    // æ³¨å†Œæ–°çš„è£…é¥°å™¨ç±»å‹
    public void register(String name, Class<? extends Decorator> decoratorClass) {
        decorators.put(name, decoratorClass);
    }
    
    // æ ¹æ®åç§°åˆ›å»ºè£…é¥°å™¨å®ä¾‹
    public Decorator create(String name, Component component) {
        Class<? extends Decorator> clazz = decorators.get(name);
        // ä½¿ç”¨åå°„åˆ›å»ºå®ä¾‹ï¼ˆå°±åƒæŒ‰å›¾çº¸é€ é›¶ä»¶ï¼‰
        return clazz.getConstructor(Component.class).newInstance(component);
    }
}
```

**ğŸ”„ åŠ¨æ€è£…é¥°è¿‡ç¨‹**
```java
// åŠ¨æ€è£…é¥°å™¨åº”ç”¨å™¨
public class DynamicDecoratorApplier {
    private DecoratorRegistry registry;
    
    // æ ¹æ®é…ç½®åŠ¨æ€è£…é¥°å¯¹è±¡
    public Component decorate(Component base, List<String> decoratorNames) {
        Component result = base;
        
        // ä¾æ¬¡åº”ç”¨æ¯ä¸ªè£…é¥°å™¨
        for (String decoratorName : decoratorNames) {
            result = registry.create(decoratorName, result);
        }
        
        return result;
    }
}
```

### 2.3 å®é™…åº”ç”¨ç¤ºä¾‹


**ğŸ­ åœºæ™¯ï¼šæ–‡æœ¬å¤„ç†ç³»ç»Ÿ**
```java
// ä½¿ç”¨ç¤ºä¾‹
public class TextProcessorExample {
    public void processText() {
        // 1. å‡†å¤‡åŸºç¡€å¯¹è±¡
        Component text = new PlainText("Hello World");
        
        // 2. æ ¹æ®ç”¨æˆ·é€‰æ‹©åŠ¨æ€è£…é¥°
        List<String> userChoices = Arrays.asList("uppercase", "bold", "color");
        Component decoratedText = applier.decorate(text, userChoices);
        
        // 3. æœ€ç»ˆæ•ˆæœï¼šæ™®é€šæ–‡æœ¬ â†’ å¤§å†™ â†’ åŠ ç²— â†’ ç€è‰²
        decoratedText.display(); // è¾“å‡ºå½©è‰²åŠ ç²—çš„"HELLO WORLD"
    }
}
```

**ğŸ’¡ å®é™…ä»·å€¼**
- **ç”¨æˆ·å®šåˆ¶**ï¼šç”¨æˆ·å¯ä»¥è‡ªç”±é€‰æ‹©éœ€è¦çš„åŠŸèƒ½
- **æ‰©å±•æ€§å¼º**ï¼šæ–°å¢è£…é¥°å™¨åªéœ€æ³¨å†Œå³å¯
- **é…ç½®é©±åŠ¨**ï¼šé€šè¿‡é…ç½®æ§åˆ¶åŠŸèƒ½ç»„åˆ

---

## 3. ğŸ“ æ³¨è§£é©±åŠ¨è£…é¥°å™¨


### 3.1 æ³¨è§£é©±åŠ¨çš„æ¦‚å¿µ


**ğŸ¯ ä»€ä¹ˆæ˜¯æ³¨è§£é©±åŠ¨**
> å°±åƒåœ¨æ–‡æ¡£ä¸Šè´´ä¾¿ç­¾æ¡ä¸€æ ·ï¼Œåœ¨ä»£ç ä¸Šè´´"æ ‡ç­¾"ï¼Œå‘Šè¯‰ç¨‹åºéœ€è¦ä»€ä¹ˆæ ·çš„å¤„ç†ã€‚Springæ¡†æ¶çš„`@Autowired`ã€`@Transactional`éƒ½æ˜¯è¿™ç§æ€è·¯ã€‚

**ğŸ“Œ æ³¨è§£è£…é¥°å™¨çš„ä¼˜åŠ¿**
```
ä¼ ç»Ÿæ–¹å¼ï¼šæ‰‹å·¥åŒ…è£…æ¯ä¸ªå¯¹è±¡
æ³¨è§£æ–¹å¼ï¼šåœ¨ç±»æˆ–æ–¹æ³•ä¸ŠåŠ æ ‡ç­¾ï¼Œè‡ªåŠ¨è£…é¥°

ä¼ ç»Ÿï¼šComponent wrapped = new LogDecorator(new CacheDecorator(component));
æ³¨è§£ï¼š@Log @Cache public class MyComponent { ... }
```

### 3.2 æ³¨è§£è£…é¥°å™¨å®ç°


**ğŸ·ï¸ å®šä¹‰è£…é¥°å™¨æ³¨è§£**
```java
// æ—¥å¿—è£…é¥°å™¨æ³¨è§£
@Retention(RetentionPolicy.RUNTIME)  // è¿è¡Œæ—¶ä¿ç•™
@Target({ElementType.TYPE, ElementType.METHOD})  // å¯ç”¨äºç±»å’Œæ–¹æ³•
public @interface LogDecorator {
    String level() default "INFO";  // æ—¥å¿—çº§åˆ«
    boolean includeParams() default true;  // æ˜¯å¦åŒ…å«å‚æ•°
}

// ç¼“å­˜è£…é¥°å™¨æ³¨è§£
@Retention(RetentionPolicy.RUNTIME)
@Target({ElementType.TYPE, ElementType.METHOD})
public @interface CacheDecorator {
    int expireTime() default 300;  // ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰
    String key() default "";       // ç¼“å­˜é”®
}
```

**ğŸ” æ³¨è§£å¤„ç†å™¨**
```java
// æ³¨è§£è£…é¥°å™¨å¤„ç†å™¨
public class AnnotationDecoratorProcessor {
    
    // å¤„ç†å¸¦æ³¨è§£çš„å¯¹è±¡
    public <T> T process(T target) {
        Class<?> clazz = target.getClass();
        
        // æ£€æŸ¥ç±»ä¸Šçš„æ³¨è§£
        if (clazz.isAnnotationPresent(LogDecorator.class)) {
            target = wrapWithLogger(target, clazz.getAnnotation(LogDecorator.class));
        }
        
        if (clazz.isAnnotationPresent(CacheDecorator.class)) {
            target = wrapWithCache(target, clazz.getAnnotation(CacheDecorator.class));
        }
        
        return target;
    }
}
```

### 3.3 ä½¿ç”¨ç¤ºä¾‹


**ğŸ“± å®é™…åº”ç”¨åœºæ™¯**
```java
// ç”¨æˆ·æœåŠ¡ç±» - éœ€è¦æ—¥å¿—å’Œç¼“å­˜
@LogDecorator(level = "DEBUG", includeParams = true)
@CacheDecorator(expireTime = 600, key = "user")
public class UserService {
    
    public User getUserById(Long id) {
        // å®é™…çš„ä¸šåŠ¡é€»è¾‘
        return database.findUser(id);
    }
}

// ä½¿ç”¨æ—¶è‡ªåŠ¨è£…é¥°
UserService service = new UserService();
UserService decoratedService = processor.process(service);
// ç°åœ¨serviceè‡ªåŠ¨å…·æœ‰æ—¥å¿—å’Œç¼“å­˜åŠŸèƒ½
```

**ğŸ¯ æ³¨è§£é©±åŠ¨çš„ä»·å€¼**
- **å£°æ˜å¼ç¼–ç¨‹**ï¼šå…³æ³¨åšä»€ä¹ˆï¼Œä¸å…³å¿ƒæ€ä¹ˆåš
- **ä»£ç ç®€æ´**ï¼šå‡å°‘é‡å¤çš„è£…é¥°å™¨åŒ…è£…ä»£ç 
- **é…ç½®çµæ´»**ï¼šé€šè¿‡æ³¨è§£å‚æ•°è°ƒæ•´è¡Œä¸º

---

## 4. âœ‚ï¸ AOPåˆ‡é¢è£…é¥°


### 4.1 AOPä¸è£…é¥°å™¨çš„å…³ç³»


**ğŸ¯ ä»€ä¹ˆæ˜¯AOPåˆ‡é¢è£…é¥°**
> AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰å°±åƒç»™æ‰€æœ‰é—¨éƒ½å®‰è£…åŒæ ·çš„é—¨é“ƒç³»ç»Ÿï¼Œä¸éœ€è¦æ”¹é€ æ¯æ‰‡é—¨ï¼Œä½†æ¯æ‰‡é—¨éƒ½è·å¾—äº†é—¨é“ƒåŠŸèƒ½ã€‚åˆ‡é¢è£…é¥°å°±æ˜¯ç”¨è¿™ç§æ€è·¯æ¥å®ç°è£…é¥°å™¨æ¨¡å¼ã€‚

**ğŸ”— AOPä¸è£…é¥°å™¨çš„å¯¹æ¯”**
```
ä¼ ç»Ÿè£…é¥°å™¨ï¼šä¸€ä¸ªå¯¹è±¡ä¸€ä¸ªå¯¹è±¡åœ°åŒ…è£…
AOPè£…é¥°å™¨ï¼šæ‰¹é‡ç»™ä¸€ç±»å¯¹è±¡å¢åŠ åŠŸèƒ½

å°±åƒï¼š
ä¼ ç»Ÿï¼šç»™æ¯ä¸ªæ¯å­å•ç‹¬åŠ ç›–å­
AOPï¼š  ç»™æ‰€æœ‰åœ†å½¢æ¯å­éƒ½åŠ ç»Ÿä¸€è§„æ ¼çš„ç›–å­
```

### 4.2 åˆ‡é¢è£…é¥°å™¨å®ç°


**ğŸ¯ åˆ‡é¢å®šä¹‰**
```java
// æ—¥å¿—åˆ‡é¢è£…é¥°å™¨
@Aspect  // æ ‡è®°è¿™æ˜¯ä¸€ä¸ªåˆ‡é¢
public class LogAspectDecorator {
    
    // å®šä¹‰åˆ‡ç‚¹ï¼šå“ªäº›æ–¹æ³•éœ€è¦è£…é¥°
    @Pointcut("@annotation(LogDecorator)")
    public void loggedMethods() {}
    
    // ç¯ç»•é€šçŸ¥ï¼šåœ¨æ–¹æ³•æ‰§è¡Œå‰åæ·»åŠ åŠŸèƒ½
    @Around("loggedMethods()")
    public Object addLogging(ProceedingJoinPoint joinPoint) throws Throwable {
        // æ–¹æ³•æ‰§è¡Œå‰çš„è£…é¥°
        System.out.println("å¼€å§‹æ‰§è¡Œæ–¹æ³•: " + joinPoint.getSignature().getName());
        
        // æ‰§è¡ŒåŸå§‹æ–¹æ³•
        Object result = joinPoint.proceed();
        
        // æ–¹æ³•æ‰§è¡Œåçš„è£…é¥°
        System.out.println("æ–¹æ³•æ‰§è¡Œå®Œæˆ: " + result);
        
        return result;
    }
}
```

**ğŸ”§ åˆ‡é¢è£…é¥°å™¨é…ç½®**
```java
// AOPé…ç½®ç±»
@Configuration
@EnableAspectJAutoProxy  // å¯ç”¨AOPè‡ªåŠ¨ä»£ç†
public class AopDecoratorConfig {
    
    @Bean
    public LogAspectDecorator logAspectDecorator() {
        return new LogAspectDecorator();
    }
    
    @Bean
    public CacheAspectDecorator cacheAspectDecorator() {
        return new CacheAspectDecorator();
    }
}
```

### 4.3 AOPè£…é¥°å™¨çš„ä¼˜åŠ¿


**âš¡ AOPåˆ‡é¢è£…é¥°çš„ç‰¹ç‚¹**
```
ğŸ”¸ æ‰¹é‡è£…é¥°ï¼šä¸€æ¬¡é…ç½®ï¼Œå¤šå¤„ç”Ÿæ•ˆ
ğŸ”¸ æ— ä¾µå…¥æ€§ï¼šä¸ä¿®æ”¹åŸå§‹ä»£ç 
ğŸ”¸ ç»Ÿä¸€ç®¡ç†ï¼šæ‰€æœ‰åˆ‡é¢è£…é¥°é›†ä¸­é…ç½®
ğŸ”¸ åŠ¨æ€ç”Ÿæ•ˆï¼šè¿è¡Œæ—¶åŠ¨æ€åˆ›å»ºä»£ç†å¯¹è±¡

å®é™…æ•ˆæœï¼š
@LogDecorator
public void method1() { ... }  // è‡ªåŠ¨æœ‰æ—¥å¿—åŠŸèƒ½

@LogDecorator  
public void method2() { ... }  // è‡ªåŠ¨æœ‰æ—¥å¿—åŠŸèƒ½

@CacheDecorator
public void method3() { ... }  // è‡ªåŠ¨æœ‰ç¼“å­˜åŠŸèƒ½
```

**ğŸ’¡ ä½¿ç”¨åœºæ™¯**
- **äº‹åŠ¡ç®¡ç†**ï¼šæ•°æ®åº“æ“ä½œçš„äº‹åŠ¡æ§åˆ¶
- **å®‰å…¨æ£€æŸ¥**ï¼šæ–¹æ³•è°ƒç”¨å‰çš„æƒé™éªŒè¯
- **æ€§èƒ½ç›‘æ§**ï¼šè‡ªåŠ¨è®°å½•æ–¹æ³•æ‰§è¡Œæ—¶é—´
- **å¼‚å¸¸å¤„ç†**ï¼šç»Ÿä¸€çš„å¼‚å¸¸æ•è·å’Œå¤„ç†

---

## 5. ğŸ­ è£…é¥°å™¨å·¥å‚


### 5.1 è£…é¥°å™¨å·¥å‚çš„æ¦‚å¿µ


**ğŸ¯ ä»€ä¹ˆæ˜¯è£…é¥°å™¨å·¥å‚**
> å°±åƒæ±½è½¦å·¥å‚å¯ä»¥ç”Ÿäº§ä¸åŒå‹å·çš„æ±½è½¦ä¸€æ ·ï¼Œè£…é¥°å™¨å·¥å‚å¯ä»¥æ ¹æ®éœ€æ±‚ç”Ÿäº§ä¸åŒç±»å‹çš„è£…é¥°å™¨ã€‚ä½ åªéœ€è¦å‘Šè¯‰å·¥å‚"æˆ‘è¦ä¸€ä¸ªå¸¦æ—¥å¿—åŠŸèƒ½çš„è£…é¥°å™¨"ï¼Œå·¥å‚å°±ä¼šåˆ¶é€ å‡ºæ¥ã€‚

**ğŸ—ï¸ å·¥å‚æ¨¡å¼è§£å†³çš„é—®é¢˜**
```
â“ å¦‚ä½•ç®€åŒ–è£…é¥°å™¨çš„åˆ›å»ºè¿‡ç¨‹ï¼Ÿ
â“ å¦‚ä½•ç»Ÿä¸€ç®¡ç†è£…é¥°å™¨çš„é…ç½®ï¼Ÿ
â“ å¦‚ä½•å®ç°è£…é¥°å™¨çš„å¤ç”¨å’Œç¼“å­˜ï¼Ÿ
â“ å¦‚ä½•è®©è£…é¥°å™¨åˆ›å»ºè¿‡ç¨‹æ›´åŠ çµæ´»ï¼Ÿ
```

### 5.2 è£…é¥°å™¨å·¥å‚å®ç°


**ğŸ”§ åŸºç¡€å·¥å‚è®¾è®¡**
```java
// è£…é¥°å™¨å·¥å‚æ¥å£
public interface DecoratorFactory {
    Decorator createDecorator(String type, Component component, Map<String, Object> config);
}

// å…·ä½“è£…é¥°å™¨å·¥å‚
public class StandardDecoratorFactory implements DecoratorFactory {
    
    @Override
    public Decorator createDecorator(String type, Component component, Map<String, Object> config) {
        switch (type) {
            case "log":
                return createLogDecorator(component, config);
            case "cache":
                return createCacheDecorator(component, config);
            case "security":
                return createSecurityDecorator(component, config);
            default:
                throw new IllegalArgumentException("æœªçŸ¥çš„è£…é¥°å™¨ç±»å‹: " + type);
        }
    }
    
    private LogDecorator createLogDecorator(Component component, Map<String, Object> config) {
        String level = (String) config.getOrDefault("level", "INFO");
        boolean includeParams = (Boolean) config.getOrDefault("includeParams", true);
        return new LogDecorator(component, level, includeParams);
    }
}
```

**âš™ï¸ æ™ºèƒ½å·¥å‚è®¾è®¡**
```java
// æ™ºèƒ½è£…é¥°å™¨å·¥å‚
public class SmartDecoratorFactory {
    private Map<String, DecoratorBuilder> builders = new HashMap<>();
    
    // æ³¨å†Œè£…é¥°å™¨æ„å»ºå™¨
    public void registerBuilder(String type, DecoratorBuilder builder) {
        builders.put(type, builder);
    }
    
    // åˆ›å»ºè£…é¥°å™¨é“¾
    public Component createDecoratorChain(Component base, List<DecoratorConfig> configs) {
        Component result = base;
        
        for (DecoratorConfig config : configs) {
            DecoratorBuilder builder = builders.get(config.getType());
            if (builder != null) {
                result = builder.build(result, config.getParameters());
            }
        }
        
        return result;
    }
}
```

### 5.3 å·¥å‚ä½¿ç”¨ç¤ºä¾‹


**ğŸ“± å®é™…åº”ç”¨åœºæ™¯**
```java
// è£…é¥°å™¨é…ç½®
public class DecoratorConfig {
    private String type;
    private Map<String, Object> parameters;
    
    // æ„é€ å‡½æ•°å’Œgetter/setter
}

// ä½¿ç”¨å·¥å‚åˆ›å»ºè£…é¥°å™¨
public class DecoratorFactoryExample {
    public void demonstrateFactory() {
        // åŸºç¡€ç»„ä»¶
        Component service = new UserService();
        
        // é…ç½®è£…é¥°å™¨é“¾
        List<DecoratorConfig> configs = Arrays.asList(
            new DecoratorConfig("log", Map.of("level", "DEBUG")),
            new DecoratorConfig("cache", Map.of("expireTime", 300)),
            new DecoratorConfig("security", Map.of("requiredRole", "ADMIN"))
        );
        
        // å·¥å‚åˆ›å»ºå®Œæ•´è£…é¥°å™¨é“¾
        Component decoratedService = factory.createDecoratorChain(service, configs);
        
        // ç°åœ¨serviceå…·æœ‰æ—¥å¿—ã€ç¼“å­˜ã€å®‰å…¨ä¸‰ç§åŠŸèƒ½
    }
}
```

**ğŸ¯ è£…é¥°å™¨å·¥å‚çš„ä»·å€¼**
- **ç®€åŒ–åˆ›å»º**ï¼šå¤æ‚çš„è£…é¥°å™¨åˆ›å»ºé€»è¾‘å°è£…åœ¨å·¥å‚å†…
- **é…ç½®é©±åŠ¨**ï¼šé€šè¿‡é…ç½®æ§åˆ¶è£…é¥°å™¨çš„åˆ›å»º
- **æ‰©å±•æ€§å¼º**ï¼šæ–°å¢è£…é¥°å™¨ç±»å‹åªéœ€æ³¨å†Œæ–°çš„æ„å»ºå™¨
- **å¤ç”¨æ€§å¥½**ï¼šåŒä¸€ä¸ªå·¥å‚å¯ä»¥åˆ›å»ºå¤šç§è£…é¥°å™¨ç»„åˆ

---

## 6. âš™ï¸ é…ç½®åŒ–è£…é¥°é“¾


### 6.1 é…ç½®åŒ–è£…é¥°é“¾çš„æ¦‚å¿µ


**ğŸ¯ ä»€ä¹ˆæ˜¯é…ç½®åŒ–è£…é¥°é“¾**
> å°±åƒæ­ç§¯æœ¨ä¸€æ ·ï¼Œä½ å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶å‘Šè¯‰ç¨‹åºï¼š"æˆ‘è¦å…ˆæ”¾ä¸€ä¸ªçº¢è‰²ç§¯æœ¨ï¼Œå†æ”¾ä¸€ä¸ªè“è‰²ç§¯æœ¨ï¼Œæœ€åæ”¾ä¸€ä¸ªé»„è‰²ç§¯æœ¨"ï¼Œç¨‹åºä¼šæŒ‰ç…§é…ç½®è‡ªåŠ¨æ­å»ºç§¯æœ¨é“¾ã€‚

**ğŸ“‹ é…ç½®åŒ–çš„ä¼˜åŠ¿**
```
ä¼ ç»Ÿæ–¹å¼ï¼šè£…é¥°å™¨é“¾å†™æ­»åœ¨ä»£ç é‡Œ
é…ç½®æ–¹å¼ï¼šè£…é¥°å™¨é“¾å†™åœ¨é…ç½®æ–‡ä»¶é‡Œ

å¥½å¤„ï¼š
âœ… ä¸æ”¹ä»£ç å°±èƒ½è°ƒæ•´åŠŸèƒ½
âœ… ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒé…ç½®
âœ… ä¸šåŠ¡äººå‘˜ä¹Ÿèƒ½è°ƒæ•´é…ç½®
âœ… æ”¯æŒçƒ­æ›´æ–°é…ç½®
```

### 6.2 é…ç½®æ–‡ä»¶è®¾è®¡


**ğŸ“ YAMLé…ç½®ç¤ºä¾‹**
```yaml
# decorator-config.yml
decorators:
  userService:
    enabled: true
    chain:
      - type: "log"
        order: 1
        config:
          level: "DEBUG"
          includeParams: true
      - type: "cache"
        order: 2
        config:
          expireTime: 600
          keyPrefix: "user"
      - type: "security"
        order: 3
        config:
          requiredRole: "USER"
          
  orderService:
    enabled: true
    chain:
      - type: "security"
        order: 1
        config:
          requiredRole: "ADMIN"
      - type: "transaction"
        order: 2
        config:
          isolation: "READ_COMMITTED"
```

**ğŸ”§ é…ç½®è§£æå™¨**
```java
// è£…é¥°å™¨é…ç½®æ¨¡å‹
public class DecoratorChainConfig {
    private boolean enabled;
    private List<DecoratorItemConfig> chain;
    
    // getter/setter
}

public class DecoratorItemConfig {
    private String type;
    private int order;
    private Map<String, Object> config;
    
    // getter/setter
}

// é…ç½®è§£æå™¨
@Component
public class DecoratorConfigParser {
    
    @Value("classpath:decorator-config.yml")
    private Resource configFile;
    
    public Map<String, DecoratorChainConfig> parseConfig() {
        // ä½¿ç”¨YAMLè§£æå™¨è¯»å–é…ç½®
        Yaml yaml = new Yaml();
        Map<String, Object> data = yaml.load(configFile.getInputStream());
        
        // è½¬æ¢ä¸ºé…ç½®å¯¹è±¡
        return convertToConfigObjects(data);
    }
}
```

### 6.3 é…ç½®åŒ–è£…é¥°å™¨åº”ç”¨å™¨


**ğŸš€ é…ç½®é©±åŠ¨çš„è£…é¥°å™¨åº”ç”¨**
```java
// é…ç½®åŒ–è£…é¥°å™¨åº”ç”¨å™¨
@Service
public class ConfigurableDecoratorApplier {
    
    @Autowired
    private DecoratorConfigParser configParser;
    
    @Autowired
    private DecoratorFactory decoratorFactory;
    
    // æ ¹æ®é…ç½®åº”ç”¨è£…é¥°å™¨
    public <T> T applyDecorators(T component, String serviceName) {
        Map<String, DecoratorChainConfig> configs = configParser.parseConfig();
        DecoratorChainConfig chainConfig = configs.get(serviceName);
        
        if (chainConfig == null || !chainConfig.isEnabled()) {
            return component; // æ²¡æœ‰é…ç½®æˆ–æœªå¯ç”¨ï¼Œè¿”å›åŸå§‹ç»„ä»¶
        }
        
        // æŒ‰é¡ºåºåº”ç”¨è£…é¥°å™¨
        Component result = (Component) component;
        List<DecoratorItemConfig> chain = chainConfig.getChain();
        
        // æŒ‰orderå­—æ®µæ’åº
        chain.sort(Comparator.comparingInt(DecoratorItemConfig::getOrder));
        
        for (DecoratorItemConfig item : chain) {
            result = decoratorFactory.createDecorator(
                item.getType(), 
                result, 
                item.getConfig()
            );
        }
        
        return (T) result;
    }
}
```

### 6.4 å®é™…åº”ç”¨ç¤ºä¾‹


**ğŸ“± Spring Booté›†æˆç¤ºä¾‹**
```java
// è‡ªåŠ¨è£…é¥°å™¨é…ç½®
@Configuration
public class AutoDecoratorConfiguration {
    
    @Autowired
    private ConfigurableDecoratorApplier decoratorApplier;
    
    // åç½®å¤„ç†å™¨ï¼šè‡ªåŠ¨è£…é¥°æ‰€æœ‰Service
    @Bean
    public BeanPostProcessor decoratorBeanPostProcessor() {
        return new BeanPostProcessor() {
            @Override
            public Object postProcessAfterInitialization(Object bean, String beanName) {
                if (beanName.endsWith("Service")) {
                    return decoratorApplier.applyDecorators(bean, beanName);
                }
                return bean;
            }
        };
    }
}

// ä½¿ç”¨ç¤ºä¾‹
@Service
public class UserService {
    public User getUserById(Long id) {
        return userRepository.findById(id);
    }
}

// UserServiceä¼šè‡ªåŠ¨æ ¹æ®é…ç½®è¢«è£…é¥°
// æ— éœ€ä¿®æ”¹ä»»ä½•ä¸šåŠ¡ä»£ç 
```

**ğŸ¯ é…ç½®åŒ–è£…é¥°é“¾çš„ä»·å€¼**
- **çµæ´»é…ç½®**ï¼šä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒè£…é¥°å™¨ç»„åˆ
- **çƒ­æ›´æ–°**ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶å³å¯è°ƒæ•´åŠŸèƒ½
- **ä¸šåŠ¡å‹å¥½**ï¼šéæŠ€æœ¯äººå‘˜ä¹Ÿèƒ½ç†è§£å’Œä¿®æ”¹é…ç½®
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šé…ç½®æ–‡ä»¶å¯ä»¥ç‰ˆæœ¬ç®¡ç†ï¼Œä¾¿äºå›æ»š

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ åŠ¨æ€è£…é¥°å™¨æ³¨å†Œï¼šè¿è¡Œæ—¶é€‰æ‹©å’Œç»„åˆè£…é¥°å™¨
ğŸ”¸ æ³¨è§£é©±åŠ¨è£…é¥°å™¨ï¼šé€šè¿‡æ³¨è§£å£°æ˜å¼åœ°åº”ç”¨è£…é¥°å™¨
ğŸ”¸ AOPåˆ‡é¢è£…é¥°ï¼šæ‰¹é‡ç»™åŒç±»å¯¹è±¡å¢åŠ æ¨ªåˆ‡å…³æ³¨ç‚¹
ğŸ”¸ è£…é¥°å™¨å·¥å‚ï¼šç»Ÿä¸€åˆ›å»ºå’Œç®¡ç†è£…é¥°å™¨çš„å·¥å‚
ğŸ”¸ é…ç½®åŒ–è£…é¥°é“¾ï¼šé€šè¿‡é…ç½®æ–‡ä»¶æ§åˆ¶è£…é¥°å™¨çš„ç»„åˆ
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æŠ€æœ¯é€‰æ‹©æŒ‡å—**
```
åœºæ™¯é€‰æ‹©ï¼š
ç®€å•è£…é¥° â†’ åŸºç¡€è£…é¥°å™¨æ¨¡å¼
åŠ¨æ€é€‰æ‹© â†’ åŠ¨æ€æ³¨å†Œ + å·¥å‚æ¨¡å¼
æ‰¹é‡è£…é¥° â†’ AOPåˆ‡é¢è£…é¥°
çµæ´»é…ç½® â†’ é…ç½®åŒ–è£…é¥°é“¾
æ¡†æ¶é›†æˆ â†’ æ³¨è§£é©±åŠ¨è£…é¥°å™¨

å¤æ‚åº¦å¯¹æ¯”ï¼š
åŸºç¡€è£…é¥°å™¨ < åŠ¨æ€æ³¨å†Œ < æ³¨è§£é©±åŠ¨ < AOPåˆ‡é¢ < é…ç½®åŒ–è£…é¥°é“¾
```

**ğŸ”¹ å®ç°è¦ç‚¹æ€»ç»“**
```
æ ¸å¿ƒæ€æƒ³ï¼š
1. åˆ†ç¦»å…³æ³¨ç‚¹ï¼šè£…é¥°é€»è¾‘ä¸ä¸šåŠ¡é€»è¾‘åˆ†ç¦»
2. å¯é…ç½®æ€§ï¼šé€šè¿‡é…ç½®æ§åˆ¶è£…é¥°è¡Œä¸º
3. å¯æ‰©å±•æ€§ï¼šæ–°å¢è£…é¥°å™¨æ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç 
4. ç»Ÿä¸€ç®¡ç†ï¼šé›†ä¸­ç®¡ç†æ‰€æœ‰è£…é¥°å™¨

æŠ€æœ¯è¦ç‚¹ï¼š
- åå°„æœºåˆ¶ï¼šåŠ¨æ€åˆ›å»ºè£…é¥°å™¨å®ä¾‹
- æ³¨è§£å¤„ç†ï¼šè§£æå’Œå¤„ç†è£…é¥°å™¨æ³¨è§£
- AOPä»£ç†ï¼šè¿è¡Œæ—¶åˆ›å»ºä»£ç†å¯¹è±¡
- å·¥å‚æ¨¡å¼ï¼šç»Ÿä¸€è£…é¥°å™¨åˆ›å»ºé€»è¾‘
- é…ç½®è§£æï¼šè§£æå¤–éƒ¨é…ç½®æ–‡ä»¶
```

### 7.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ ä¸šåŠ¡åœºæ™¯åº”ç”¨**
- **Webåº”ç”¨**ï¼šè¯·æ±‚æ—¥å¿—ã€æƒé™æ ¡éªŒã€ç¼“å­˜æ§åˆ¶
- **å¾®æœåŠ¡**ï¼šæœåŠ¡ç›‘æ§ã€ç†”æ–­é™çº§ã€é“¾è·¯è¿½è¸ª
- **æ•°æ®å¤„ç†**ï¼šæ•°æ®éªŒè¯ã€æ ¼å¼è½¬æ¢ã€åŠ å¯†è§£å¯†
- **ä¼ä¸šåº”ç”¨**ï¼šäº‹åŠ¡ç®¡ç†ã€å®¡è®¡æ—¥å¿—ã€æ€§èƒ½ç›‘æ§

**ğŸ”§ å¼€å‘å®è·µä»·å€¼**
- **ä»£ç å¤ç”¨**ï¼šè£…é¥°å™¨å¯ä»¥åœ¨å¤šä¸ªåœ°æ–¹é‡å¤ä½¿ç”¨
- **ç»´æŠ¤æ€§å¼º**ï¼šè£…é¥°é€»è¾‘é›†ä¸­ç®¡ç†ï¼Œä¾¿äºç»´æŠ¤
- **æ‰©å±•å®¹æ˜“**ï¼šæ–°å¢åŠŸèƒ½åªéœ€æ–°å¢è£…é¥°å™¨
- **æµ‹è¯•å‹å¥½**ï¼šå¯ä»¥å•ç‹¬æµ‹è¯•æ¯ä¸ªè£…é¥°å™¨

### 7.4 å­¦ä¹ è¿›é˜¶è·¯å¾„


**ğŸ“š å­¦ä¹ å»ºè®®**
```
ğŸŒ± åˆçº§é˜¶æ®µï¼š
- ç†è§£åŸºç¡€è£…é¥°å™¨æ¨¡å¼
- æŒæ¡åŠ¨æ€æ³¨å†Œçš„æ¦‚å¿µ
- ç»ƒä¹ ç®€å•çš„å·¥å‚åˆ›å»º

ğŸŒ¿ ä¸­çº§é˜¶æ®µï¼š
- å­¦ä¹ æ³¨è§£é©±åŠ¨è£…é¥°å™¨
- ç†è§£AOPåˆ‡é¢ç¼–ç¨‹
- å®è·µé…ç½®åŒ–è£…é¥°é“¾

ğŸŒ³ é«˜çº§é˜¶æ®µï¼š
- è®¾è®¡å¤æ‚çš„è£…é¥°å™¨ä½“ç³»
- ç»“åˆSpringæ¡†æ¶å®ç°
- æ€§èƒ½ä¼˜åŒ–å’Œæœ€ä½³å®è·µ
```

**ğŸ’¡ å®è·µå»ºè®®**
```
1. ä»ç®€å•å¼€å§‹ï¼šå…ˆæŒæ¡åŸºç¡€è£…é¥°å™¨ï¼Œå†å­¦ä¹ é«˜çº§ç‰¹æ€§
2. åŠ¨æ‰‹å®è·µï¼šæ¯ä¸ªæ¦‚å¿µéƒ½è¦å†™ä»£ç éªŒè¯
3. åœºæ™¯æ€è€ƒï¼šæ€è€ƒå®é™…å·¥ä½œä¸­å“ªäº›åœ°æ–¹å¯ä»¥åº”ç”¨
4. æºç å­¦ä¹ ï¼šç ”ç©¶Springç­‰æ¡†æ¶ä¸­çš„è£…é¥°å™¨å®ç°
5. æ¨¡å¼ç»„åˆï¼šå­¦ä¼šå°†è£…é¥°å™¨ä¸å…¶ä»–è®¾è®¡æ¨¡å¼ç»“åˆä½¿ç”¨
```

**ğŸ¯ æ ¸å¿ƒè®°å¿†**
- è£…é¥°å™¨æ¨¡å¼çš„é«˜çº§åº”ç”¨ä¸»è¦è§£å†³"è‡ªåŠ¨åŒ–"å’Œ"é…ç½®åŒ–"çš„é—®é¢˜
- åŠ¨æ€æ³¨å†Œè®©è£…é¥°å™¨é€‰æ‹©æ›´çµæ´»ï¼Œæ³¨è§£é©±åŠ¨è®©ä½¿ç”¨æ›´ç®€å•
- AOPåˆ‡é¢å®ç°æ‰¹é‡è£…é¥°ï¼Œå·¥å‚æ¨¡å¼ç»Ÿä¸€åˆ›å»ºé€»è¾‘
- é…ç½®åŒ–è£…é¥°é“¾è®©éç¨‹åºå‘˜ä¹Ÿèƒ½è°ƒæ•´ç³»ç»Ÿè¡Œä¸º
- æ‰€æœ‰é«˜çº§ç‰¹æ€§éƒ½æ˜¯ä¸ºäº†è®©è£…é¥°å™¨æ¨¡å¼æ›´å¥½åœ°æœåŠ¡äºå®é™…ä¸šåŠ¡éœ€æ±‚