---
title: 6ã€å·¥å‚æ–¹æ³•æ¨¡å¼ä»£ç å®æˆ˜
---
## ğŸ“š ç›®å½•

1. [åŸºç¡€å®ç°ï¼šå›¾å½¢ç»˜åˆ¶ç³»ç»Ÿ](#1-åŸºç¡€å®ç°ï¼šå›¾å½¢ç»˜åˆ¶ç³»ç»Ÿ)
2. [è¿›é˜¶å®ç°ï¼šæ—¥å¿—å¤„ç†å™¨å·¥å‚](#2-è¿›é˜¶å®ç°ï¼šæ—¥å¿—å¤„ç†å™¨å·¥å‚)
3. [å¤šç§å®ç°æ–¹å¼å¯¹æ¯”](#3-å¤šç§å®ç°æ–¹å¼å¯¹æ¯”)
4. [æ‰©å±•æ€§æµ‹è¯•å®æˆ˜](#4-æ‰©å±•æ€§æµ‹è¯•å®æˆ˜)
5. [æ€§èƒ½ä¼˜åŒ–æŠ€å·§](#5-æ€§èƒ½ä¼˜åŒ–æŠ€å·§)
6. [å®é™…é¡¹ç›®åº”ç”¨æ¡ˆä¾‹](#6-å®é™…é¡¹ç›®åº”ç”¨æ¡ˆä¾‹)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¨ åŸºç¡€å®ç°ï¼šå›¾å½¢ç»˜åˆ¶ç³»ç»Ÿ


### 1.1 éœ€æ±‚èƒŒæ™¯

æƒ³è±¡ä½ åœ¨å¼€å‘ä¸€ä¸ªç”»å›¾è½¯ä»¶ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©ç”»åœ†å½¢ã€çŸ©å½¢ç­‰ä¸åŒå›¾å½¢ã€‚ä¼ ç»Ÿåšæ³•æ˜¯å†™ä¸€å †if-elseåˆ¤æ–­ï¼Œä½†è¿™æ ·æ‰©å±•æ–°å›¾å½¢æ—¶å¾ˆéº»çƒ¦ã€‚å·¥å‚æ–¹æ³•æ¨¡å¼å°±åƒç»™æ¯ç§å›¾å½¢å®‰æ’ä¸€ä¸ªä¸“é—¨çš„"ç”Ÿäº§è½¦é—´"ã€‚

### 1.2 æ ¸å¿ƒç»“æ„è®¾è®¡


**ğŸ“ äº§å“æ¥å£ï¼šå›¾å½¢çš„å…±åŒæ ‡å‡†**
```java
// æ‰€æœ‰å›¾å½¢éƒ½è¦éµå¾ªçš„"è§„èŒƒ"
public interface Shape {
    void draw();        // ç»˜åˆ¶å›¾å½¢
    double getArea();   // è®¡ç®—é¢ç§¯
}
```

**ğŸ­ æŠ½è±¡å·¥å‚ï¼šå›¾å½¢å·¥å‚çš„åŸºæœ¬æ¡†æ¶**
```java
// å®šä¹‰å·¥å‚çš„"æ¨¡æ¿"ï¼Œå‘Šè¯‰æ¯ä¸ªå·¥å‚åº”è¯¥æœ‰ä»€ä¹ˆåŠŸèƒ½
public abstract class ShapeFactory {
    // æ ¸å¿ƒæ–¹æ³•ï¼šåˆ›å»ºå›¾å½¢ï¼ˆå…·ä½“æ€ä¹ˆåˆ›å»ºç”±å­ç±»å†³å®šï¼‰
    public abstract Shape createShape();
    
    // é€šç”¨æ–¹æ³•ï¼šç»˜åˆ¶å¹¶æ˜¾ç¤ºå›¾å½¢ä¿¡æ¯
    public void displayShape() {
        Shape shape = createShape();
        System.out.println("åˆ›å»ºå›¾å½¢ï¼š" + shape.getClass().getSimpleName());
        shape.draw();
        System.out.println("é¢ç§¯ï¼š" + shape.getArea());
    }
}
```

### 1.3 å…·ä½“äº§å“å®ç°


**â­• åœ†å½¢äº§å“**
```java
public class Circle implements Shape {
    private double radius;
    
    public Circle(double radius) {
        this.radius = radius;
        System.out.println("åœ†å½¢å·²åˆ›å»ºï¼ŒåŠå¾„ï¼š" + radius);
    }
    
    @Override
    public void draw() {
        System.out.println("ç»˜åˆ¶åœ†å½¢ â—‹");
    }
    
    @Override
    public double getArea() {
        return Math.PI * radius * radius;
    }
}
```

**â¬œ çŸ©å½¢äº§å“**
```java
public class Rectangle implements Shape {
    private double width, height;
    
    public Rectangle(double width, double height) {
        this.width = width;
        this.height = height;
        System.out.println("çŸ©å½¢å·²åˆ›å»ºï¼Œå®½ï¼š" + width + "ï¼Œé«˜ï¼š" + height);
    }
    
    @Override
    public void draw() {
        System.out.println("ç»˜åˆ¶çŸ©å½¢ â–­");
    }
    
    @Override
    public double getArea() {
        return width * height;
    }
}
```

### 1.4 å…·ä½“å·¥å‚å®ç°


**ğŸ­ åœ†å½¢å·¥å‚**
```java
public class CircleFactory extends ShapeFactory {
    @Override
    public Shape createShape() {
        // ä¸“é—¨è´Ÿè´£åˆ›å»ºåœ†å½¢ï¼Œå‚æ•°å¯ä»¥ä»é…ç½®è·å–
        return new Circle(5.0);
    }
}
```

**ğŸ­ çŸ©å½¢å·¥å‚**
```java
public class RectangleFactory extends ShapeFactory {
    @Override
    public Shape createShape() {
        // ä¸“é—¨è´Ÿè´£åˆ›å»ºçŸ©å½¢
        return new Rectangle(4.0, 6.0);
    }
}
```

### 1.5 å®¢æˆ·ç«¯ä½¿ç”¨


```java
public class GraphicsApp {
    public static void main(String[] args) {
        System.out.println("=== å›¾å½¢ç»˜åˆ¶ç³»ç»Ÿæ¼”ç¤º ===");
        
        // ç”¨æˆ·é€‰æ‹©ç”»åœ†å½¢
        ShapeFactory circleFactory = new CircleFactory();
        circleFactory.displayShape();
        
        System.out.println();
        
        // ç”¨æˆ·é€‰æ‹©ç”»çŸ©å½¢
        ShapeFactory rectangleFactory = new RectangleFactory();
        rectangleFactory.displayShape();
    }
}
```

**è¿è¡Œç»“æœï¼š**
```
=== å›¾å½¢ç»˜åˆ¶ç³»ç»Ÿæ¼”ç¤º ===
åœ†å½¢å·²åˆ›å»ºï¼ŒåŠå¾„ï¼š5.0
åˆ›å»ºå›¾å½¢ï¼šCircle
ç»˜åˆ¶åœ†å½¢ â—‹
é¢ç§¯ï¼š78.53981633974483

çŸ©å½¢å·²åˆ›å»ºï¼Œå®½ï¼š4.0ï¼Œé«˜ï¼š6.0
åˆ›å»ºå›¾å½¢ï¼šRectangle
ç»˜åˆ¶çŸ©å½¢ â–­
é¢ç§¯ï¼š24.0
```

---

## 2. ğŸ“ è¿›é˜¶å®ç°ï¼šæ—¥å¿—å¤„ç†å™¨å·¥å‚


### 2.1 å®é™…åº”ç”¨åœºæ™¯

åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å°†æ—¥å¿—è¾“å‡ºåˆ°ä¸åŒåœ°æ–¹ï¼šæ§åˆ¶å°ã€æ–‡ä»¶ã€æ•°æ®åº“ç­‰ã€‚å·¥å‚æ–¹æ³•æ¨¡å¼è®©æˆ‘ä»¬å¯ä»¥è½»æ¾åˆ‡æ¢æ—¥å¿—è¾“å‡ºæ–¹å¼ï¼Œå°±åƒæ¢ä¸ª"æ‰“å°æœº"ä¸€æ ·ç®€å•ã€‚

### 2.2 çµæ´»çš„å·¥å‚è®¾è®¡


**ğŸ“„ æ—¥å¿—å™¨æ¥å£**
```java
public interface Logger {
    void log(String level, String message);
    void close();
}
```

**ğŸ­ å¸¦å‚æ•°çš„æŠ½è±¡å·¥å‚**
```java
public abstract class LoggerFactory {
    // æ ¸å¿ƒåˆ›å»ºæ–¹æ³•
    public abstract Logger createLogger();
    
    // ä¾¿æ·æ–¹æ³•ï¼šåˆ›å»ºå¹¶é…ç½®æ—¥å¿—å™¨
    public Logger getConfiguredLogger() {
        Logger logger = createLogger();
        configure(logger);
        return logger;
    }
    
    // é€šç”¨é…ç½®æ–¹æ³•ï¼ˆæ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ä½“ç°ï¼‰
    protected void configure(Logger logger) {
        System.out.println("æ—¥å¿—å™¨åŸºç¡€é…ç½®å®Œæˆ");
    }
}
```

### 2.3 å¤šç§æ—¥å¿—å™¨å®ç°


**ğŸ’» æ§åˆ¶å°æ—¥å¿—å™¨**
```java
public class ConsoleLogger implements Logger {
    private String prefix;
    
    public ConsoleLogger(String prefix) {
        this.prefix = prefix;
    }
    
    @Override
    public void log(String level, String message) {
        System.out.println(String.format("[%s][%s] %s", 
            prefix, level, message));
    }
    
    @Override
    public void close() {
        System.out.println("æ§åˆ¶å°æ—¥å¿—å™¨å…³é—­");
    }
}
```

**ğŸ“ æ–‡ä»¶æ—¥å¿—å™¨**
```java
public class FileLogger implements Logger {
    private String filename;
    private boolean isOpen = false;
    
    public FileLogger(String filename) {
        this.filename = filename;
        this.isOpen = true;
        System.out.println("æ–‡ä»¶æ—¥å¿—å™¨å·²æ‰“å¼€ï¼š" + filename);
    }
    
    @Override
    public void log(String level, String message) {
        if (isOpen) {
            // å®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šå†™å…¥æ–‡ä»¶
            System.out.println(String.format("å†™å…¥æ–‡ä»¶[%s]: [%s] %s", 
                filename, level, message));
        }
    }
    
    @Override
    public void close() {
        isOpen = false;
        System.out.println("æ–‡ä»¶æ—¥å¿—å™¨å·²å…³é—­ï¼š" + filename);
    }
}
```

### 2.4 å…·ä½“å·¥å‚å®ç°


**ğŸ­ æ§åˆ¶å°æ—¥å¿—å·¥å‚**
```java
public class ConsoleLoggerFactory extends LoggerFactory {
    private String appName;
    
    public ConsoleLoggerFactory(String appName) {
        this.appName = appName;
    }
    
    @Override
    public Logger createLogger() {
        return new ConsoleLogger(appName);
    }
    
    @Override
    protected void configure(Logger logger) {
        super.configure(logger);
        System.out.println("æ§åˆ¶å°æ—¥å¿—å™¨ç‰¹æ®Šé…ç½®ï¼šå½©è‰²è¾“å‡ºå·²å¯ç”¨");
    }
}
```

**ğŸ­ æ–‡ä»¶æ—¥å¿—å·¥å‚**
```java
public class FileLoggerFactory extends LoggerFactory {
    private String logDir;
    
    public FileLoggerFactory(String logDir) {
        this.logDir = logDir;
    }
    
    @Override
    public Logger createLogger() {
        String filename = logDir + "/app_" + 
            java.time.LocalDate.now() + ".log";
        return new FileLogger(filename);
    }
    
    @Override
    protected void configure(Logger logger) {
        super.configure(logger);
        System.out.println("æ–‡ä»¶æ—¥å¿—å™¨ç‰¹æ®Šé…ç½®ï¼šè‡ªåŠ¨è½®è½¬å·²å¯ç”¨");
    }
}
```

### 2.5 å®é™…ä½¿ç”¨æ¼”ç¤º


```java
public class LoggerDemo {
    public static void main(String[] args) {
        System.out.println("=== æ—¥å¿—ç³»ç»Ÿæ¼”ç¤º ===");
        
        // å¼€å‘ç¯å¢ƒï¼šä½¿ç”¨æ§åˆ¶å°æ—¥å¿—
        LoggerFactory devFactory = new ConsoleLoggerFactory("MyApp-Dev");
        Logger devLogger = devFactory.getConfiguredLogger();
        devLogger.log("INFO", "åº”ç”¨å¯åŠ¨æˆåŠŸ");
        devLogger.log("ERROR", "æ•°æ®åº“è¿æ¥å¤±è´¥");
        devLogger.close();
        
        System.out.println("\n--- åˆ‡æ¢åˆ°ç”Ÿäº§ç¯å¢ƒ ---");
        
        // ç”Ÿäº§ç¯å¢ƒï¼šä½¿ç”¨æ–‡ä»¶æ—¥å¿—
        LoggerFactory prodFactory = new FileLoggerFactory("/var/logs");
        Logger prodLogger = prodFactory.getConfiguredLogger();
        prodLogger.log("INFO", "ç”¨æˆ·ç™»å½•");
        prodLogger.log("WARN", "å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜");
        prodLogger.close();
    }
}
```

---

## 3. âš–ï¸ å¤šç§å®ç°æ–¹å¼å¯¹æ¯”


### 3.1 å®ç°æ–¹å¼å¯¹æ¯”è¡¨


| å®ç°æ–¹å¼ | **ä¼˜ç‚¹** | **ç¼ºç‚¹** | **é€‚ç”¨åœºæ™¯** |
|---------|---------|---------|-------------|
| ğŸ”§ **åŸºç¡€å·¥å‚æ–¹æ³•** | `ç®€å•ç›´è§‚ï¼Œæ˜“äºç†è§£` | `å·¥å‚ç±»è¾ƒå¤š` | `äº§å“ç§ç±»å›ºå®š` |
| ğŸ›ï¸ **å‚æ•°åŒ–å·¥å‚** | `å‡å°‘å·¥å‚ç±»æ•°é‡` | `å‚æ•°å¤æ‚æ—¶éš¾ç»´æŠ¤` | `äº§å“æœ‰å¤šç§é…ç½®` |
| ğŸ—ï¸ **æ³¨å†Œå¼å·¥å‚** | `åŠ¨æ€æ‰©å±•ï¼Œé«˜åº¦çµæ´»` | `å®ç°å¤æ‚ï¼Œè°ƒè¯•å›°éš¾` | `æ’ä»¶åŒ–ç³»ç»Ÿ` |
| âš™ï¸ **é…ç½®é©±åŠ¨å·¥å‚** | `æ— éœ€ä¿®æ”¹ä»£ç å³å¯æ‰©å±•` | `ä¾èµ–å¤–éƒ¨é…ç½®` | `ä¼ä¸šçº§åº”ç”¨` |

### 3.2 å‚æ•°åŒ–å·¥å‚å®ç°


```java
// ç”¨ä¸€ä¸ªå·¥å‚å¤„ç†å¤šç§å›¾å½¢
public class ParameterizedShapeFactory extends ShapeFactory {
    private String shapeType;
    private Map<String, Object> parameters;
    
    public ParameterizedShapeFactory(String shapeType, Map<String, Object> params) {
        this.shapeType = shapeType;
        this.parameters = params;
    }
    
    @Override
    public Shape createShape() {
        switch (shapeType.toLowerCase()) {
            case "circle":
                double radius = (Double) parameters.get("radius");
                return new Circle(radius);
            case "rectangle":
                double width = (Double) parameters.get("width");
                double height = (Double) parameters.get("height");
                return new Rectangle(width, height);
            default:
                throw new IllegalArgumentException("ä¸æ”¯æŒçš„å›¾å½¢ç±»å‹ï¼š" + shapeType);
        }
    }
}
```

### 3.3 æ³¨å†Œå¼å·¥å‚å®ç°


```java
public class RegistryShapeFactory {
    // å­˜å‚¨å›¾å½¢åˆ›å»ºå™¨çš„æ³¨å†Œè¡¨
    private static Map<String, Supplier<Shape>> shapeRegistry = new HashMap<>();
    
    // æ³¨å†Œå›¾å½¢åˆ›å»ºå™¨
    public static void register(String type, Supplier<Shape> creator) {
        shapeRegistry.put(type, creator);
        System.out.println("æ³¨å†Œå›¾å½¢ç±»å‹ï¼š" + type);
    }
    
    // åˆ›å»ºå›¾å½¢
    public static Shape createShape(String type) {
        Supplier<Shape> creator = shapeRegistry.get(type);
        if (creator == null) {
            throw new IllegalArgumentException("æœªæ³¨å†Œçš„å›¾å½¢ç±»å‹ï¼š" + type);
        }
        return creator.get();
    }
    
    // é™æ€åˆå§‹åŒ–
    static {
        register("circle", () -> new Circle(3.0));
        register("rectangle", () -> new Rectangle(2.0, 4.0));
    }
}
```

---

## 4. ğŸ§ª æ‰©å±•æ€§æµ‹è¯•å®æˆ˜


### 4.1 æ–°å¢å›¾å½¢ç±»å‹æµ‹è¯•


**ğŸ”º ä¸‰è§’å½¢äº§å“**
```java
public class Triangle implements Shape {
    private double base, height;
    
    public Triangle(double base, double height) {
        this.base = base;
        this.height = height;
        System.out.println("ä¸‰è§’å½¢å·²åˆ›å»ºï¼Œåº•ï¼š" + base + "ï¼Œé«˜ï¼š" + height);
    }
    
    @Override
    public void draw() {
        System.out.println("ç»˜åˆ¶ä¸‰è§’å½¢ â–³");
    }
    
    @Override
    public double getArea() {
        return 0.5 * base * height;
    }
}
```

**ğŸ­ ä¸‰è§’å½¢å·¥å‚**
```java
public class TriangleFactory extends ShapeFactory {
    @Override
    public Shape createShape() {
        return new Triangle(6.0, 4.0);
    }
}
```

### 4.2 æ‰©å±•æ€§æµ‹è¯•ä»£ç 


```java
public class ExtensibilityTest {
    public static void main(String[] args) {
        System.out.println("=== æ‰©å±•æ€§æµ‹è¯• ===");
        
        // åŸæœ‰åŠŸèƒ½ä»ç„¶æ­£å¸¸å·¥ä½œ
        testExistingShapes();
        
        System.out.println("\n--- æ–°å¢ä¸‰è§’å½¢åŠŸèƒ½ ---");
        
        // æ–°å¢åŠŸèƒ½æ— éœ€ä¿®æ”¹åŸæœ‰ä»£ç 
        testNewTriangle();
        
        System.out.println("\n--- æ³¨å†Œå¼å·¥å‚æµ‹è¯• ---");
        
        // åŠ¨æ€æ³¨å†Œæ–°å›¾å½¢
        testRegistryFactory();
    }
    
    private static void testExistingShapes() {
        ShapeFactory[] factories = {
            new CircleFactory(),
            new RectangleFactory()
        };
        
        for (ShapeFactory factory : factories) {
            factory.displayShape();
            System.out.println();
        }
    }
    
    private static void testNewTriangle() {
        ShapeFactory triangleFactory = new TriangleFactory();
        triangleFactory.displayShape();
    }
    
    private static void testRegistryFactory() {
        // åŠ¨æ€æ³¨å†Œæ–°çš„å›¾å½¢ç±»å‹
        RegistryShapeFactory.register("triangle", () -> new Triangle(5.0, 3.0));
        
        // ä½¿ç”¨æ³¨å†Œçš„å›¾å½¢ç±»å‹
        Shape triangle = RegistryShapeFactory.createShape("triangle");
        triangle.draw();
        System.out.println("é¢ç§¯ï¼š" + triangle.getArea());
    }
}
```

### 4.3 æ‰©å±•æ€§éªŒè¯ç»“æœ


**âœ… å¼€é—­åŸåˆ™éªŒè¯**
```
åŸæœ‰ä»£ç ä¿®æ”¹ï¼š0è¡Œ
æ–°å¢ä»£ç ï¼šTriangle.java + TriangleFactory.java
åŠŸèƒ½æ‰©å±•ï¼šå®Œå…¨æ”¯æŒæ–°å›¾å½¢ç±»å‹
å‘åå…¼å®¹ï¼š100%å…¼å®¹åŸæœ‰åŠŸèƒ½
```

---

## 5. âš¡ æ€§èƒ½ä¼˜åŒ–æŠ€å·§


### 5.1 å¯¹è±¡æ± ä¼˜åŒ–


**ğŸŠ å¯¹è±¡æ± å·¥å‚**
```java
public class PooledShapeFactory extends ShapeFactory {
    private Queue<Shape> circlePool = new ArrayDeque<>();
    private Queue<Shape> rectanglePool = new ArrayDeque<>();
    private final int maxPoolSize = 10;
    
    @Override
    public Shape createShape() {
        // è¿™é‡Œç®€åŒ–ä¸ºåˆ›å»ºåœ†å½¢ï¼Œå®é™…å¯ä»¥æ ¹æ®å‚æ•°å†³å®š
        return getCircleFromPool();
    }
    
    private Shape getCircleFromPool() {
        if (!circlePool.isEmpty()) {
            System.out.println("ä»å¯¹è±¡æ± è·å–åœ†å½¢");
            return circlePool.poll();
        } else {
            System.out.println("åˆ›å»ºæ–°çš„åœ†å½¢å¯¹è±¡");
            return new Circle(5.0);
        }
    }
    
    // å½’è¿˜å¯¹è±¡åˆ°æ± ä¸­
    public void returnToPool(Shape shape) {
        if (shape instanceof Circle && circlePool.size() < maxPoolSize) {
            circlePool.offer(shape);
            System.out.println("åœ†å½¢å·²å½’è¿˜å¯¹è±¡æ± ");
        }
        // å…¶ä»–ç±»å‹çš„å½’è¿˜é€»è¾‘...
    }
}
```

### 5.2 å•ä¾‹å·¥å‚ä¼˜åŒ–


```java
public class SingletonShapeFactory {
    // å·¥å‚å®ä¾‹ç¼“å­˜
    private static final Map<Class<?>, Object> factoryCache = new ConcurrentHashMap<>();
    
    @SuppressWarnings("unchecked")
    public static <T extends ShapeFactory> T getFactory(Class<T> factoryClass) {
        return (T) factoryCache.computeIfAbsent(factoryClass, clazz -> {
            try {
                System.out.println("åˆ›å»ºå·¥å‚å®ä¾‹ï¼š" + clazz.getSimpleName());
                return clazz.getDeclaredConstructor().newInstance();
            } catch (Exception e) {
                throw new RuntimeException("å·¥å‚åˆ›å»ºå¤±è´¥", e);
            }
        });
    }
}
```

### 5.3 æ€§èƒ½æµ‹è¯•å¯¹æ¯”


```java
public class PerformanceTest {
    private static final int TEST_COUNT = 100000;
    
    public static void main(String[] args) {
        System.out.println("=== æ€§èƒ½æµ‹è¯•å¯¹æ¯” ===");
        
        // æµ‹è¯•æ™®é€šå·¥å‚æ–¹æ³•
        long normalTime = testNormalFactory();
        
        // æµ‹è¯•å¯¹è±¡æ± å·¥å‚
        long pooledTime = testPooledFactory();
        
        // æµ‹è¯•å•ä¾‹å·¥å‚
        long singletonTime = testSingletonFactory();
        
        System.out.println("\n--- æ€§èƒ½æµ‹è¯•ç»“æœ ---");
        System.out.println("æ™®é€šå·¥å‚æ–¹æ³•ï¼š" + normalTime + "ms");
        System.out.println("å¯¹è±¡æ± å·¥å‚ï¼š" + pooledTime + "ms");
        System.out.println("å•ä¾‹å·¥å‚ï¼š" + singletonTime + "ms");
    }
    
    private static long testNormalFactory() {
        long start = System.currentTimeMillis();
        for (int i = 0; i < TEST_COUNT; i++) {
            ShapeFactory factory = new CircleFactory();
            Shape shape = factory.createShape();
        }
        return System.currentTimeMillis() - start;
    }
    
    private static long testPooledFactory() {
        PooledShapeFactory factory = new PooledShapeFactory();
        long start = System.currentTimeMillis();
        for (int i = 0; i < TEST_COUNT; i++) {
            Shape shape = factory.createShape();
            if (i % 2 == 0) {  // æ¨¡æ‹Ÿ50%çš„å¯¹è±¡å›æ”¶
                factory.returnToPool(shape);
            }
        }
        return System.currentTimeMillis() - start;
    }
    
    private static long testSingletonFactory() {
        long start = System.currentTimeMillis();
        for (int i = 0; i < TEST_COUNT; i++) {
            ShapeFactory factory = SingletonShapeFactory.getFactory(CircleFactory.class);
            Shape shape = factory.createShape();
        }
        return System.currentTimeMillis() - start;
    }
}
```

---

## 6. ğŸš€ å®é™…é¡¹ç›®åº”ç”¨æ¡ˆä¾‹


### 6.1 Webæ¡†æ¶ä¸­çš„æ§åˆ¶å™¨å·¥å‚


**ğŸŒ å®é™…åº”ç”¨åœºæ™¯**
åœ¨Webå¼€å‘ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ä¸åŒçš„URLè·¯å¾„åˆ›å»ºä¸åŒçš„æ§åˆ¶å™¨æ¥å¤„ç†è¯·æ±‚ã€‚

```java
// æ§åˆ¶å™¨æ¥å£
public interface Controller {
    String handleRequest(String request);
}

// ç”¨æˆ·æ§åˆ¶å™¨
public class UserController implements Controller {
    @Override
    public String handleRequest(String request) {
        return "ç”¨æˆ·ç®¡ç†é¡µé¢ï¼šå¤„ç†è¯·æ±‚ " + request;
    }
}

// äº§å“æ§åˆ¶å™¨
public class ProductController implements Controller {
    @Override
    public String handleRequest(String request) {
        return "äº§å“ç®¡ç†é¡µé¢ï¼šå¤„ç†è¯·æ±‚ " + request;
    }
}

// æ§åˆ¶å™¨å·¥å‚
public abstract class ControllerFactory {
    public abstract Controller createController();
    
    // å¤„ç†å®Œæ•´çš„è¯·æ±‚æµç¨‹
    public String processRequest(String request) {
        Controller controller = createController();
        return controller.handleRequest(request);
    }
}
```

### 6.2 æ•°æ®åº“è¿æ¥å·¥å‚åº”ç”¨


```java
// æ•°æ®åº“è¿æ¥å·¥å‚å®ä¾‹
public class DatabaseConnectionFactory {
    public static Connection createConnection(String dbType) {
        switch (dbType.toLowerCase()) {
            case "mysql":
                return new MySQLConnectionFactory().createConnection();
            case "postgresql":
                return new PostgreSQLConnectionFactory().createConnection();
            case "oracle":
                return new OracleConnectionFactory().createConnection();
            default:
                throw new IllegalArgumentException("ä¸æ”¯æŒçš„æ•°æ®åº“ç±»å‹ï¼š" + dbType);
        }
    }
}

// ä½¿ç”¨ç¤ºä¾‹
public class DatabaseService {
    private String dbType;
    
    public DatabaseService(String dbType) {
        this.dbType = dbType;
    }
    
    public void performOperation() {
        Connection conn = DatabaseConnectionFactory.createConnection(dbType);
        // æ‰§è¡Œæ•°æ®åº“æ“ä½œ...
        System.out.println("ä½¿ç”¨ " + dbType + " æ•°æ®åº“æ‰§è¡Œæ“ä½œ");
    }
}
```

### 6.3 æ¸¸æˆå¼€å‘ä¸­çš„æ•Œäººå·¥å‚


```java
// æ¸¸æˆæ•Œäººå·¥å‚åº”ç”¨
public class GameEnemyFactory {
    public static Enemy createEnemy(int level) {
        if (level <= 10) {
            return new WeakEnemyFactory().createEnemy();
        } else if (level <= 20) {
            return new NormalEnemyFactory().createEnemy();
        } else {
            return new BossEnemyFactory().createEnemy();
        }
    }
}

// æ¸¸æˆä½¿ç”¨ç¤ºä¾‹
public class GameLevel {
    public void spawnEnemies(int playerLevel) {
        for (int i = 0; i < 5; i++) {
            Enemy enemy = GameEnemyFactory.createEnemy(playerLevel);
            enemy.spawn();
        }
    }
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å·¥å‚æ–¹æ³•æ¨¡å¼æœ¬è´¨ï¼šç”¨ä¸“é—¨çš„å·¥å‚ç±»åˆ›å»ºå¯¹è±¡ï¼Œè€Œä¸æ˜¯ç›´æ¥new
ğŸ”¸ æ ¸å¿ƒç»“æ„ï¼šæŠ½è±¡äº§å“ + å…·ä½“äº§å“ + æŠ½è±¡å·¥å‚ + å…·ä½“å·¥å‚
ğŸ”¸ è®¾è®¡åŸåˆ™ï¼šå¼€é—­åŸåˆ™ã€ä¾èµ–å€’ç½®åŸåˆ™ã€å•ä¸€èŒè´£åŸåˆ™
ğŸ”¸ å®ç°è¦ç‚¹ï¼šä¸€ä¸ªå·¥å‚å¯¹åº”ä¸€ä¸ªäº§å“ï¼Œå·¥å‚è´Ÿè´£åˆ›å»ºé€»è¾‘
ğŸ”¸ æ‰©å±•æ–¹å¼ï¼šæ–°å¢äº§å“æ—¶åªéœ€æ–°å¢å¯¹åº”çš„å·¥å‚ç±»
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ç®€å•å·¥å‚çš„åŒºåˆ«**
```
ç®€å•å·¥å‚ï¼š
- ä¸€ä¸ªå·¥å‚ç±»å¤„ç†æ‰€æœ‰äº§å“åˆ›å»º
- æ–°å¢äº§å“éœ€è¦ä¿®æ”¹å·¥å‚ç±»ä»£ç 
- è¿åå¼€é—­åŸåˆ™

å·¥å‚æ–¹æ³•ï¼š
- æ¯ä¸ªäº§å“å¯¹åº”ä¸€ä¸ªä¸“é—¨çš„å·¥å‚
- æ–°å¢äº§å“åªéœ€æ–°å¢å·¥å‚ç±»
- ç¬¦åˆå¼€é—­åŸåˆ™
```

**ğŸ”¹ ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å·¥å‚æ–¹æ³•**
```
é€‚ç”¨åœºæ™¯ï¼š
âœ… éœ€è¦åˆ›å»ºçš„å¯¹è±¡ç±»å‹åœ¨è¿è¡Œæ—¶ç¡®å®š
âœ… å¯¹è±¡åˆ›å»ºè¿‡ç¨‹æ¯”è¾ƒå¤æ‚
âœ… éœ€è¦é¢‘ç¹æ‰©å±•æ–°çš„äº§å“ç±»å‹
âœ… å¸Œæœ›éšè—å¯¹è±¡åˆ›å»ºçš„å…·ä½“ç»†èŠ‚

ä¸é€‚ç”¨åœºæ™¯ï¼š
âŒ äº§å“ç±»å‹å¾ˆå°‘ä¸”å›ºå®šä¸å˜
âŒ å¯¹è±¡åˆ›å»ºé€»è¾‘éå¸¸ç®€å•
âŒ ä¸éœ€è¦è€ƒè™‘æ‰©å±•æ€§
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–è€ƒè™‘**
```
ä¼˜åŒ–ç­–ç•¥ï¼š
ğŸš€ å¯¹è±¡æ± ï¼šé‡å¤ä½¿ç”¨å¯¹è±¡ï¼Œå‡å°‘åˆ›å»ºå¼€é”€
ğŸš€ å•ä¾‹å·¥å‚ï¼šå·¥å‚æœ¬èº«ä½¿ç”¨å•ä¾‹æ¨¡å¼
ğŸš€ å»¶è¿Ÿåˆ›å»ºï¼šéœ€è¦æ—¶æ‰åˆ›å»ºå¯¹è±¡
ğŸš€ ç¼“å­˜æœºåˆ¶ï¼šç¼“å­˜åˆ›å»ºå¥½çš„å¯¹è±¡
```

### 7.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ è§£å†³çš„æ ¸å¿ƒé—®é¢˜**
- **åˆ›å»ºä¸ä½¿ç”¨åˆ†ç¦»**ï¼šå®¢æˆ·ç«¯ä¸éœ€è¦çŸ¥é“å…·ä½“å¦‚ä½•åˆ›å»ºå¯¹è±¡
- **æ˜“äºæ‰©å±•**ï¼šæ–°å¢äº§å“ç±»å‹æ—¶ä¸å½±å“ç°æœ‰ä»£ç 
- **ç»Ÿä¸€ç®¡ç†**ï¼šæ‰€æœ‰å¯¹è±¡åˆ›å»ºé€»è¾‘é›†ä¸­åœ¨å·¥å‚ä¸­
- **é™ä½è€¦åˆ**ï¼šå®¢æˆ·ç«¯åªä¾èµ–æŠ½è±¡ï¼Œä¸ä¾èµ–å…·ä½“å®ç°

**ğŸ”§ å·¥ç¨‹å®è·µå»ºè®®**
```
ä»£ç ç»„ç»‡ï¼š
ğŸ“ æŠŠç›¸å…³çš„äº§å“å’Œå·¥å‚æ”¾åœ¨åŒä¸€ä¸ªåŒ…ä¸­
ğŸ“ ä½¿ç”¨æ¸…æ™°çš„å‘½åçº¦å®šï¼ˆå¦‚XxxFactoryï¼‰
ğŸ“ æä¾›å·¥å‚çš„ç»Ÿä¸€å…¥å£ç±»

æµ‹è¯•ç­–ç•¥ï¼š
ğŸ§ª ä¸ºæ¯ä¸ªå·¥å‚ç¼–å†™å•å…ƒæµ‹è¯•
ğŸ§ª æµ‹è¯•å·¥å‚åˆ›å»ºçš„å¯¹è±¡æ˜¯å¦ç¬¦åˆé¢„æœŸ
ğŸ§ª æµ‹è¯•æ‰©å±•æ€§ï¼ˆæ–°å¢äº§å“ç±»å‹ï¼‰
ğŸ§ª è¿›è¡Œæ€§èƒ½æµ‹è¯•ï¼ˆå¦‚æœå¯¹è±¡åˆ›å»ºé¢‘ç¹ï¼‰
```

**ğŸ’¡ è®°å¿†å£è¯€**
```
å·¥å‚æ–¹æ³•æœ‰é—¨é“ï¼Œ
ä¸“é—¨å·¥å‚é€ ä¸“å“ã€‚
æ‰©å±•å®¹æ˜“ä¸æ”¹ç ï¼Œ
å¼€é—­åŸåˆ™è®°å¿ƒé—´ã€‚
æŠ½è±¡å®šä¹‰å…·ä½“åšï¼Œ
å®¢æˆ·åªç”¨ä¸å…³å¿ƒã€‚
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- å·¥å‚æ–¹æ³• = æ¯ä¸ªäº§å“éƒ½æœ‰ä¸“é—¨çš„å·¥å‚
- æ‰©å±•æ–°äº§å“ = æ–°å¢å·¥å‚ç±»ï¼Œä¸ä¿®æ”¹åŸä»£ç   
- å®¢æˆ·ç«¯åªéœ€è¦çŸ¥é“ç”¨å“ªä¸ªå·¥å‚ï¼Œä¸éœ€è¦çŸ¥é“æ€ä¹ˆåˆ›å»º
- æŠŠ"åˆ›å»ºå¯¹è±¡"è¿™ä»¶äº‹äº¤ç»™ä¸“é—¨çš„å·¥å‚å»åš