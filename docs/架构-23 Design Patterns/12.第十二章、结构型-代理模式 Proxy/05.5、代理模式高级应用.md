---
title: 5ã€ä»£ç†æ¨¡å¼é«˜çº§åº”ç”¨
---
## ğŸ“š ç›®å½•

1. [ä»£ç†æ¨¡å¼å›é¡¾ä¸è¿›é˜¶æ€è·¯](#1-ä»£ç†æ¨¡å¼å›é¡¾ä¸è¿›é˜¶æ€è·¯)
2. [AOPåˆ‡é¢ç¼–ç¨‹ä»£ç†](#2-AOPåˆ‡é¢ç¼–ç¨‹ä»£ç†)
3. [äº‹åŠ¡ä»£ç†ç®¡ç†](#3-äº‹åŠ¡ä»£ç†ç®¡ç†)
4. [å®‰å…¨ä»£ç†è®¾è®¡](#4-å®‰å…¨ä»£ç†è®¾è®¡)
5. [æ€§èƒ½ç›‘æ§ä»£ç†](#5-æ€§èƒ½ç›‘æ§ä»£ç†)
6. [ä»£ç†é“¾æ¨¡å¼](#6-ä»£ç†é“¾æ¨¡å¼)
7. [å®é™…é¡¹ç›®åº”ç”¨åœºæ™¯](#7-å®é™…é¡¹ç›®åº”ç”¨åœºæ™¯)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”„ ä»£ç†æ¨¡å¼å›é¡¾ä¸è¿›é˜¶æ€è·¯


### 1.1 ä»€ä¹ˆæ˜¯ä»£ç†æ¨¡å¼çš„é«˜çº§åº”ç”¨


**é€šä¿—ç†è§£**ï¼šå¦‚æœè¯´åŸºç¡€ä»£ç†æ¨¡å¼åƒæ˜¯æ‰¾äººä»£åŠäº‹æƒ…ï¼Œé‚£ä¹ˆé«˜çº§åº”ç”¨å°±æ˜¯æ‰¾**ä¸“ä¸šå›¢é˜Ÿ**æ¥ä»£åŠå¤æ‚çš„ä¸šåŠ¡æµç¨‹ã€‚

```
åŸºç¡€ä»£ç†ï¼š
ä½  â†’ ä¸­ä»‹ â†’ æˆ¿ä¸œï¼ˆç®€å•è½¬å‘ï¼‰

é«˜çº§ä»£ç†ï¼š
ä½  â†’ ä¸“ä¸šä»£ç†å›¢é˜Ÿ â†’ æˆ¿ä¸œ
     â†“
  1. æ³•å¾‹å®¡æŸ¥
  2. ä»·æ ¼è°ˆåˆ¤  
  3. åˆåŒç®¡ç†
  4. é£é™©æ§åˆ¶
```

**é«˜çº§åº”ç”¨çš„æ ¸å¿ƒä»·å€¼**ï¼š
- ğŸ¯ **æ¨ªåˆ‡å…³æ³¨ç‚¹**ï¼šå¤„ç†ä¸æ ¸å¿ƒä¸šåŠ¡æ— å…³ä½†å¿…éœ€çš„åŠŸèƒ½
- ğŸ”’ **å®‰å…¨å¢å¼º**ï¼šåœ¨ä¸ä¿®æ”¹åŸä»£ç çš„æƒ…å†µä¸‹å¢åŠ å®‰å…¨æ§åˆ¶
- ğŸ“Š **æ€§èƒ½ç›‘æ§**ï¼šé€æ˜åœ°æ·»åŠ æ€§èƒ½ç»Ÿè®¡å’Œç›‘æ§
- ğŸ”§ **äº‹åŠ¡ç®¡ç†**ï¼šè‡ªåŠ¨å¤„ç†å¤æ‚çš„äº‹åŠ¡é€»è¾‘

### 1.2 é«˜çº§ä»£ç†ä¸æ™®é€šä»£ç†çš„åŒºåˆ«


| ç‰¹æ€§ | **æ™®é€šä»£ç†** | **é«˜çº§ä»£ç†** |
|------|-------------|-------------|
| **å¤æ‚åº¦** | `ç®€å•è½¬å‘` | `å¤æ‚ä¸šåŠ¡é€»è¾‘å¤„ç†` |
| **åŠŸèƒ½** | `è®¿é—®æ§åˆ¶ã€ç¼“å­˜` | `AOPã€äº‹åŠ¡ã€å®‰å…¨ã€ç›‘æ§` |
| **ä½¿ç”¨åœºæ™¯** | `åŸºç¡€éœ€æ±‚` | `ä¼ä¸šçº§åº”ç”¨` |
| **æŠ€æœ¯è¦æ±‚** | `ç†è§£ä»£ç†æ¦‚å¿µ` | `æŒæ¡æ¡†æ¶åŸç†` |

---

## 2. âš¡ AOPåˆ‡é¢ç¼–ç¨‹ä»£ç†


### 2.1 ä»€ä¹ˆæ˜¯AOPåˆ‡é¢ç¼–ç¨‹


**ç”Ÿæ´»åŒ–ç†è§£**ï¼šæƒ³è±¡ä½ æ˜¯ä¸€ä¸ªé¤å…è€æ¿ï¼Œæ¯é“èœéƒ½éœ€è¦ï¼š
- ğŸ“ **è®°å½•è®¢å•**ï¼ˆå¼€å§‹å‰ï¼‰
- ğŸ³ **åˆ¶ä½œèœå“**ï¼ˆæ ¸å¿ƒä¸šåŠ¡ï¼‰
- ğŸ“Š **ç»Ÿè®¡é”€é‡**ï¼ˆç»“æŸåï¼‰
- ğŸ§¹ **æ¸…ç†å¨å…·**ï¼ˆæœ€ç»ˆæ¸…ç†ï¼‰

å¦‚æœæ¯ä¸ªå¨å¸ˆéƒ½è¦è®°ä½è¿™äº›é¢å¤–å·¥ä½œï¼Œå¾ˆå®¹æ˜“å‡ºé”™ã€‚æ›´å¥½çš„åŠæ³•æ˜¯å®‰æ’ä¸€ä¸ª**æ€»ç®¡**æ¥ç»Ÿä¸€å¤„ç†è¿™äº›äº‹æƒ…ã€‚

```
ä¼ ç»Ÿæ–¹å¼ï¼š
å¨å¸ˆAï¼šè®°å½•â†’åšèœâ†’ç»Ÿè®¡â†’æ¸…ç†
å¨å¸ˆBï¼šè®°å½•â†’åšèœâ†’ç»Ÿè®¡â†’æ¸…ç†  â† é‡å¤ä»£ç 
å¨å¸ˆCï¼šè®°å½•â†’åšèœâ†’ç»Ÿè®¡â†’æ¸…ç†

AOPæ–¹å¼ï¼š
æ€»ç®¡ï¼šç»Ÿä¸€å¤„ç†è®°å½•ã€ç»Ÿè®¡ã€æ¸…ç†
å¨å¸ˆï¼šä¸“æ³¨åšèœï¼ˆæ ¸å¿ƒä¸šåŠ¡ï¼‰
```

### 2.2 AOPçš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ¯ åˆ‡é¢ï¼ˆAspectï¼‰**ï¼šå°±åƒé¤å…æ€»ç®¡ï¼Œè´Ÿè´£å¤„ç†æ¨ªåˆ‡å…³æ³¨ç‚¹
**ğŸ“ åˆ‡ç‚¹ï¼ˆPointcutï¼‰**ï¼šåœ¨å“ªäº›åœ°æ–¹éœ€è¦æ€»ç®¡ä»‹å…¥ï¼ˆæ¯”å¦‚æ‰€æœ‰èœå“åˆ¶ä½œå‰åï¼‰
**âš¡ é€šçŸ¥ï¼ˆAdviceï¼‰**ï¼šæ€»ç®¡å…·ä½“åšä»€ä¹ˆäº‹æƒ…ï¼ˆè®°å½•ã€ç»Ÿè®¡ã€æ¸…ç†ï¼‰

```java
// ç®€å•çš„AOPä»£ç†ç¤ºä¾‹
public class AOPProxy implements InvocationHandler {
    private Object target;      // è¢«ä»£ç†çš„å¯¹è±¡ï¼ˆå¨å¸ˆï¼‰
    private Logger logger;      // æ—¥å¿—è®°å½•å™¨ï¼ˆæ€»ç®¡çš„è®°å½•æœ¬ï¼‰
    
    public AOPProxy(Object target) {
        this.target = target;
        this.logger = Logger.getLogger(target.getClass());
    }
    
    @Override
    public Object invoke(Object proxy, Method method, Object[] args) {
        // å‰ç½®é€šçŸ¥ï¼šæ–¹æ³•æ‰§è¡Œå‰çš„æ“ä½œ
        long startTime = System.currentTimeMillis();
        logger.info("å¼€å§‹æ‰§è¡Œæ–¹æ³•: " + method.getName());
        
        try {
            // æ‰§è¡ŒçœŸæ­£çš„ä¸šåŠ¡æ–¹æ³•
            Object result = method.invoke(target, args);
            
            // è¿”å›é€šçŸ¥ï¼šæ–¹æ³•æ­£å¸¸è¿”å›åçš„æ“ä½œ
            long endTime = System.currentTimeMillis();
            logger.info("æ–¹æ³•æ‰§è¡ŒæˆåŠŸï¼Œè€—æ—¶: " + (endTime - startTime) + "ms");
            
            return result;
        } catch (Exception e) {
            // å¼‚å¸¸é€šçŸ¥ï¼šæ–¹æ³•æŠ›å‡ºå¼‚å¸¸æ—¶çš„æ“ä½œ
            logger.error("æ–¹æ³•æ‰§è¡Œå¤±è´¥: " + e.getMessage());
            throw new RuntimeException(e);
        } finally {
            // æœ€ç»ˆé€šçŸ¥ï¼šæ— è®ºå¦‚ä½•éƒ½ä¼šæ‰§è¡Œçš„æ“ä½œ
            logger.info("æ–¹æ³•æ‰§è¡Œç»“æŸ: " + method.getName());
        }
    }
}
```

### 2.3 å®é™…åº”ç”¨åœºæ™¯


**ğŸ” æ—¥å¿—è®°å½•**ï¼šè‡ªåŠ¨è®°å½•æ–¹æ³•è°ƒç”¨ä¿¡æ¯
**ğŸ“Š æ€§èƒ½ç»Ÿè®¡**ï¼šç»Ÿè®¡æ–¹æ³•æ‰§è¡Œæ—¶é—´
**ğŸ”’ æƒé™éªŒè¯**ï¼šæ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æƒé™æ‰§è¡Œæ“ä½œ
**ğŸ“ˆ æ•°æ®ç»Ÿè®¡**ï¼šç»Ÿè®¡æ–¹æ³•è°ƒç”¨æ¬¡æ•°

---

## 3. ğŸ’³ äº‹åŠ¡ä»£ç†ç®¡ç†


### 3.1 ä»€ä¹ˆæ˜¯äº‹åŠ¡ä»£ç†


**ç”Ÿæ´»åŒ–æ¯”å–»**ï¼šäº‹åŠ¡å°±åƒé“¶è¡Œè½¬è´¦ï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚

```
è½¬è´¦è¿‡ç¨‹ï¼š
1. ä»Aè´¦æˆ·æ‰£æ¬¾ 1000å…ƒ
2. å‘Bè´¦æˆ·åŠ æ¬¾ 1000å…ƒ

é—®é¢˜ï¼šå¦‚æœç¬¬1æ­¥æˆåŠŸï¼Œç¬¬2æ­¥å¤±è´¥æ€ä¹ˆåŠï¼Ÿ
è§£å†³ï¼šäº‹åŠ¡ç®¡ç† - è¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å›æ»š
```

**äº‹åŠ¡çš„ACIDç‰¹æ€§**ï¼š
- ğŸ”’ **åŸå­æ€§ï¼ˆAtomicityï¼‰**ï¼šè¦ä¹ˆå…¨åšï¼Œè¦ä¹ˆå…¨ä¸åš
- ğŸ“Š **ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰**ï¼šæ•°æ®å§‹ç»ˆä¿æŒæ­£ç¡®çŠ¶æ€  
- ğŸ”„ **éš”ç¦»æ€§ï¼ˆIsolationï¼‰**ï¼šå¤šä¸ªäº‹åŠ¡äº’ä¸å¹²æ‰°
- ğŸ’¾ **æŒä¹…æ€§ï¼ˆDurabilityï¼‰**ï¼šæˆåŠŸçš„æ”¹åŠ¨æ°¸ä¹…ä¿å­˜

### 3.2 äº‹åŠ¡ä»£ç†çš„å·¥ä½œåŸç†


```java
public class TransactionProxy implements InvocationHandler {
    private Object target;
    private TransactionManager txManager;
    
    public TransactionProxy(Object target, TransactionManager txManager) {
        this.target = target;
        this.txManager = txManager;
    }
    
    @Override
    public Object invoke(Object proxy, Method method, Object[] args) {
        // æ£€æŸ¥æ–¹æ³•æ˜¯å¦éœ€è¦äº‹åŠ¡ç®¡ç†
        if (method.isAnnotationPresent(Transactional.class)) {
            return executeWithTransaction(method, args);
        }
        
        // ä¸éœ€è¦äº‹åŠ¡çš„æ–¹æ³•ç›´æ¥æ‰§è¡Œ
        try {
            return method.invoke(target, args);
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }
    
    private Object executeWithTransaction(Method method, Object[] args) {
        Transaction tx = txManager.begin();  // å¼€å§‹äº‹åŠ¡
        
        try {
            Object result = method.invoke(target, args);
            tx.commit();    // æäº¤äº‹åŠ¡
            return result;
        } catch (Exception e) {
            tx.rollback();  // å›æ»šäº‹åŠ¡
            throw new RuntimeException("äº‹åŠ¡æ‰§è¡Œå¤±è´¥", e);
        }
    }
}
```

### 3.3 äº‹åŠ¡ä»£ç†çš„åº”ç”¨åœºæ™¯


| åœºæ™¯ | **è¯´æ˜** | **ä¸ºä»€ä¹ˆéœ€è¦äº‹åŠ¡** |
|------|---------|------------------|
| ğŸ’° **è½¬è´¦æ“ä½œ** | `Aè´¦æˆ·-1000ï¼ŒBè´¦æˆ·+1000` | `ä¿è¯èµ„é‡‘å®‰å…¨ï¼Œé¿å…ä¸¢å¤±` |
| ğŸ“¦ **è®¢å•å¤„ç†** | `å‡åº“å­˜ï¼Œåˆ›å»ºè®¢å•ï¼Œå‘é€é€šçŸ¥` | `é¿å…è¶…å–ï¼Œä¿è¯æ•°æ®ä¸€è‡´` |
| ğŸ‘¤ **ç”¨æˆ·æ³¨å†Œ** | `åˆ›å»ºç”¨æˆ·ï¼Œå‘é€é‚®ä»¶ï¼Œè®°å½•æ—¥å¿—` | `ä¿è¯æ“ä½œå®Œæ•´æ€§` |

---

## 4. ğŸ›¡ï¸ å®‰å…¨ä»£ç†è®¾è®¡


### 4.1 å®‰å…¨ä»£ç†çš„ä½œç”¨


**ç°å®ç±»æ¯”**ï¼šå®‰å…¨ä»£ç†å°±åƒé“¶è¡Œçš„**å®‰ä¿ç³»ç»Ÿ**ï¼š
- ğŸ†” **èº«ä»½éªŒè¯**ï¼šç¡®è®¤ä½ æ˜¯è°ï¼ˆåˆ·èº«ä»½è¯ï¼‰
- ğŸ”‘ **æƒé™æ£€æŸ¥**ï¼šç¡®è®¤ä½ èƒ½åšä»€ä¹ˆï¼ˆæŸ¥çœ‹è´¦æˆ·æƒé™ï¼‰
- ğŸ“ **æ“ä½œè®°å½•**ï¼šè®°å½•ä½ åšäº†ä»€ä¹ˆï¼ˆç›‘æ§å½•åƒï¼‰
- ğŸš¨ **é£é™©æ§åˆ¶**ï¼šå‘ç°å¼‚å¸¸ç«‹å³é˜»æ­¢ï¼ˆå¤§é¢è½¬è´¦éªŒè¯ï¼‰

### 4.2 å®‰å…¨ä»£ç†çš„æ ¸å¿ƒåŠŸèƒ½


**ğŸ” èº«ä»½è®¤è¯ï¼ˆAuthenticationï¼‰**ï¼š
```java
public class SecurityProxy implements InvocationHandler {
    private Object target;
    private SecurityManager securityManager;
    
    @Override
    public Object invoke(Object proxy, Method method, Object[] args) {
        // 1. æ£€æŸ¥ç”¨æˆ·èº«ä»½
        User currentUser = securityManager.getCurrentUser();
        if (currentUser == null) {
            throw new SecurityException("ç”¨æˆ·æœªç™»å½•ï¼Œè®¿é—®è¢«æ‹’ç»");
        }
        
        // 2. æ£€æŸ¥æ–¹æ³•æƒé™
        if (!hasPermission(currentUser, method)) {
            throw new SecurityException("æƒé™ä¸è¶³ï¼Œæ— æ³•æ‰§è¡Œæ“ä½œ");
        }
        
        // 3. è®°å½•å®‰å…¨æ—¥å¿—
        securityManager.logAccess(currentUser, method.getName());
        
        // 4. æ‰§è¡Œä¸šåŠ¡æ–¹æ³•
        try {
            return method.invoke(target, args);
        } catch (Exception e) {
            securityManager.logSecurityEvent("æ–¹æ³•æ‰§è¡Œå¼‚å¸¸", e);
            throw new RuntimeException(e);
        }
    }
    
    private boolean hasPermission(User user, Method method) {
        // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æ‰§è¡Œè¯¥æ–¹æ³•çš„æƒé™
        RequirePermission annotation = method.getAnnotation(RequirePermission.class);
        if (annotation != null) {
            return user.hasPermission(annotation.value());
        }
        return true;  // æ²¡æœ‰æƒé™è¦æ±‚çš„æ–¹æ³•å…è®¸æ‰§è¡Œ
    }
}
```

### 4.3 å®‰å…¨ä»£ç†çš„åº”ç”¨å±‚æ¬¡


```
åº”ç”¨ç³»ç»Ÿå®‰å…¨å±‚æ¬¡ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ç”¨æˆ·ç•Œé¢å±‚               â”‚ â† ç™»å½•éªŒè¯ã€æ“ä½œç¡®è®¤
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     å®‰å…¨ä»£ç†å±‚               â”‚ â† æƒé™æ£€æŸ¥ã€æ“ä½œè®°å½•
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     ä¸šåŠ¡é€»è¾‘å±‚               â”‚ â† æ ¸å¿ƒä¸šåŠ¡å¤„ç†
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     æ•°æ®è®¿é—®å±‚               â”‚ â† æ•°æ®åº“æ“ä½œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. ğŸ“Š æ€§èƒ½ç›‘æ§ä»£ç†


### 5.1 ä¸ºä»€ä¹ˆéœ€è¦æ€§èƒ½ç›‘æ§


**ç”Ÿæ´»åŒ–ç†è§£**ï¼šæ€§èƒ½ç›‘æ§å°±åƒæ±½è½¦çš„**ä»ªè¡¨ç›˜**ï¼š
- â±ï¸ **é€Ÿåº¦è¡¨**ï¼šå½“å‰è¿è¡Œé€Ÿåº¦ï¼ˆæ–¹æ³•æ‰§è¡Œæ—¶é—´ï¼‰
- â›½ **æ²¹è¡¨**ï¼šèµ„æºæ¶ˆè€—æƒ…å†µï¼ˆå†…å­˜ä½¿ç”¨ï¼‰
- ğŸŒ¡ï¸ **æ°´æ¸©è¡¨**ï¼šç³»ç»Ÿè´Ÿè½½çŠ¶æ€ï¼ˆCPUä½¿ç”¨ç‡ï¼‰
- ğŸ“Š **é‡Œç¨‹è¡¨**ï¼šç´¯è®¡è¿è¡Œæ•°æ®ï¼ˆè°ƒç”¨æ¬¡æ•°ç»Ÿè®¡ï¼‰

æ²¡æœ‰ç›‘æ§ï¼Œå°±åƒè’™ç€çœ¼ç›å¼€è½¦ï¼Œä¸çŸ¥é“ç³»ç»Ÿå½“å‰çš„è¿è¡ŒçŠ¶æ€ã€‚

### 5.2 æ€§èƒ½ç›‘æ§ä»£ç†çš„å®ç°


```java
public class PerformanceMonitorProxy implements InvocationHandler {
    private Object target;
    private PerformanceCounter counter;
    
    public PerformanceMonitorProxy(Object target) {
        this.target = target;
        this.counter = new PerformanceCounter();
    }
    
    @Override
    public Object invoke(Object proxy, Method method, Object[] args) {
        String methodName = method.getName();
        
        // å¼€å§‹æ€§èƒ½ç›‘æ§
        long startTime = System.currentTimeMillis();
        long startMemory = getUsedMemory();
        
        try {
            Object result = method.invoke(target, args);
            
            // è®°å½•æˆåŠŸæ‰§è¡Œçš„æ€§èƒ½æ•°æ®
            recordPerformance(methodName, startTime, startMemory, true);
            
            return result;
        } catch (Exception e) {
            // è®°å½•å¼‚å¸¸æ‰§è¡Œçš„æ€§èƒ½æ•°æ®
            recordPerformance(methodName, startTime, startMemory, false);
            throw new RuntimeException(e);
        }
    }
    
    private void recordPerformance(String methodName, long startTime, 
                                 long startMemory, boolean success) {
        long endTime = System.currentTimeMillis();
        long endMemory = getUsedMemory();
        
        PerformanceData data = new PerformanceData();
        data.setMethodName(methodName);
        data.setExecutionTime(endTime - startTime);
        data.setMemoryUsed(endMemory - startMemory);
        data.setSuccess(success);
        data.setTimestamp(new Date());
        
        counter.record(data);
        
        // å¦‚æœæ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Œè®°å½•è­¦å‘Š
        if (data.getExecutionTime() > 1000) {
            System.out.println("âš ï¸ æ€§èƒ½è­¦å‘Š: " + methodName + 
                             " æ‰§è¡Œæ—¶é—´ " + data.getExecutionTime() + "ms");
        }
    }
    
    private long getUsedMemory() {
        Runtime runtime = Runtime.getRuntime();
        return runtime.totalMemory() - runtime.freeMemory();
    }
}
```

### 5.3 æ€§èƒ½ç›‘æ§çš„å…³é”®æŒ‡æ ‡


| æŒ‡æ ‡ç±»å‹ | **ç›‘æ§å†…å®¹** | **è­¦å‘Šé˜ˆå€¼ç¤ºä¾‹** | **ä¼˜åŒ–å»ºè®®** |
|---------|-------------|----------------|-------------|
| â±ï¸ **å“åº”æ—¶é—´** | `æ–¹æ³•æ‰§è¡Œè€—æ—¶` | `>1000ms` | `ä¼˜åŒ–ç®—æ³•ã€ä½¿ç”¨ç¼“å­˜` |
| ğŸ’¾ **å†…å­˜ä½¿ç”¨** | `æ–¹æ³•å†…å­˜æ¶ˆè€—` | `>100MB` | `ä¼˜åŒ–æ•°æ®ç»“æ„ã€åŠæ—¶é‡Šæ”¾` |
| ğŸ“ˆ **è°ƒç”¨é¢‘ç‡** | `æ–¹æ³•è°ƒç”¨æ¬¡æ•°` | `>1000æ¬¡/åˆ†é’Ÿ` | `è€ƒè™‘é™æµã€ç¼“å­˜` |
| âŒ **é”™è¯¯ç‡** | `å¼‚å¸¸å‘ç”Ÿæ¯”ä¾‹` | `>5%` | `å¢å¼ºå¼‚å¸¸å¤„ç†ã€æ•°æ®éªŒè¯` |

---

## 6. ğŸ”— ä»£ç†é“¾æ¨¡å¼


### 6.1 ä»€ä¹ˆæ˜¯ä»£ç†é“¾


**ç”Ÿæ´»åŒ–ç†è§£**ï¼šä»£ç†é“¾å°±åƒ**æ”¿åºœåŠäº‹æµç¨‹**ï¼š
```
ç”³è¯·äºº â†’ æ¥å¾…çª—å£ â†’ åˆå®¡éƒ¨é—¨ â†’ å¤å®¡éƒ¨é—¨ â†’ å®¡æ‰¹éƒ¨é—¨ â†’ å®Œæˆ

æ¯ä¸ªç¯èŠ‚éƒ½ï¼š
1. æ£€æŸ¥ä¸Šä¸€ç¯èŠ‚çš„ç»“æœ
2. å¤„ç†è‡ªå·±è´Ÿè´£çš„éƒ¨åˆ†  
3. ä¼ é€’ç»™ä¸‹ä¸€ä¸ªç¯èŠ‚
```

åœ¨è½¯ä»¶ä¸­ï¼Œä»£ç†é“¾è®©æˆ‘ä»¬å¯ä»¥**ç»„åˆå¤šä¸ªä»£ç†**æ¥å¤„ç†å¤æ‚çš„ä¸šåŠ¡éœ€æ±‚ã€‚

### 6.2 ä»£ç†é“¾çš„å·¥ä½œåŸç†


```java
// æŠ½è±¡ä»£ç†é“¾èŠ‚ç‚¹
public abstract class ProxyChainNode implements InvocationHandler {
    protected ProxyChainNode nextNode;  // ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
    
    public void setNext(ProxyChainNode next) {
        this.nextNode = next;
    }
    
    @Override
    public Object invoke(Object proxy, Method method, Object[] args) {
        // 1. æ‰§è¡Œå½“å‰èŠ‚ç‚¹çš„å¤„ç†é€»è¾‘
        if (shouldProcess(method)) {
            preProcess(method, args);   // å‰ç½®å¤„ç†
        }
        
        // 2. ä¼ é€’ç»™ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æˆ–æ‰§è¡Œç›®æ ‡æ–¹æ³•
        Object result;
        if (nextNode != null) {
            result = nextNode.invoke(proxy, method, args);
        } else {
            result = invokeTarget(method, args);
        }
        
        // 3. æ‰§è¡Œåç½®å¤„ç†
        if (shouldProcess(method)) {
            postProcess(method, args, result);  // åç½®å¤„ç†
        }
        
        return result;
    }
    
    // å­ç±»å®ç°å…·ä½“çš„å¤„ç†é€»è¾‘
    protected abstract boolean shouldProcess(Method method);
    protected abstract void preProcess(Method method, Object[] args);
    protected abstract void postProcess(Method method, Object[] args, Object result);
    protected abstract Object invokeTarget(Method method, Object[] args);
}

// å®‰å…¨æ£€æŸ¥èŠ‚ç‚¹
public class SecurityNode extends ProxyChainNode {
    private SecurityManager securityManager;
    
    @Override
    protected boolean shouldProcess(Method method) {
        return method.isAnnotationPresent(RequireAuth.class);
    }
    
    @Override
    protected void preProcess(Method method, Object[] args) {
        if (!securityManager.isAuthenticated()) {
            throw new SecurityException("ç”¨æˆ·æœªè®¤è¯");
        }
    }
    
    @Override
    protected void postProcess(Method method, Object[] args, Object result) {
        securityManager.logAccess(method.getName());
    }
}

// æ€§èƒ½ç›‘æ§èŠ‚ç‚¹
public class PerformanceNode extends ProxyChainNode {
    private long startTime;
    
    @Override
    protected void preProcess(Method method, Object[] args) {
        startTime = System.currentTimeMillis();
    }
    
    @Override
    protected void postProcess(Method method, Object[] args, Object result) {
        long duration = System.currentTimeMillis() - startTime;
        System.out.println("æ–¹æ³• " + method.getName() + " æ‰§è¡Œæ—¶é—´: " + duration + "ms");
    }
}
```

### 6.3 ä»£ç†é“¾çš„ä½¿ç”¨ç¤ºä¾‹


```java
// æ„å»ºä»£ç†é“¾
public class ProxyChainBuilder {
    public static Object createProxy(Object target) {
        // åˆ›å»ºå„ä¸ªèŠ‚ç‚¹
        SecurityNode securityNode = new SecurityNode();
        PerformanceNode performanceNode = new PerformanceNode();
        TransactionNode transactionNode = new TransactionNode(target);
        
        // æ„å»ºé“¾æ¡ï¼šå®‰å…¨ â†’ æ€§èƒ½ â†’ äº‹åŠ¡ â†’ ç›®æ ‡å¯¹è±¡
        securityNode.setNext(performanceNode);
        performanceNode.setNext(transactionNode);
        
        // åˆ›å»ºä»£ç†å¯¹è±¡
        return Proxy.newProxyInstance(
            target.getClass().getClassLoader(),
            target.getClass().getInterfaces(),
            securityNode
        );
    }
}
```

### 6.4 ä»£ç†é“¾çš„ä¼˜åŠ¿


âœ… **çµæ´»ç»„åˆ**ï¼šå¯ä»¥æ ¹æ®éœ€è¦ç»„åˆä¸åŒçš„ä»£ç†åŠŸèƒ½  
âœ… **æ˜“äºæ‰©å±•**ï¼šæ–°å¢åŠŸèƒ½åªéœ€è¦æ·»åŠ æ–°çš„èŠ‚ç‚¹  
âœ… **èŒè´£åˆ†ç¦»**ï¼šæ¯ä¸ªèŠ‚ç‚¹åªå…³æ³¨è‡ªå·±çš„èŒè´£  
âœ… **å¯é…ç½®**ï¼šå¯ä»¥åŠ¨æ€è°ƒæ•´é“¾æ¡çš„ç»„æˆå’Œé¡ºåº

---

## 7. ğŸš€ å®é™…é¡¹ç›®åº”ç”¨åœºæ™¯


### 7.1 Webåº”ç”¨ä¸­çš„ä»£ç†åº”ç”¨


**ğŸŒ Springæ¡†æ¶ä¸­çš„ä»£ç†**ï¼š
```
ç”¨æˆ·è¯·æ±‚ â†’ å®‰å…¨ä»£ç† â†’ äº‹åŠ¡ä»£ç† â†’ ç¼“å­˜ä»£ç† â†’ ä¸šåŠ¡æ–¹æ³•

å®é™…æµç¨‹ï¼š
1. æ£€æŸ¥ç”¨æˆ·ç™»å½•çŠ¶æ€å’Œæƒé™
2. å¼€å¯æ•°æ®åº“äº‹åŠ¡
3. æ£€æŸ¥ç¼“å­˜ä¸­æ˜¯å¦æœ‰ç»“æœ
4. æ‰§è¡Œä¸šåŠ¡é€»è¾‘
5. æäº¤äº‹åŠ¡å¹¶æ›´æ–°ç¼“å­˜
```

**ğŸ“Š å¾®æœåŠ¡ä¸­çš„ä»£ç†**ï¼š
- **ç†”æ–­ä»£ç†**ï¼šé˜²æ­¢æœåŠ¡é›ªå´©
- **é™æµä»£ç†**ï¼šæ§åˆ¶è¯·æ±‚é¢‘ç‡
- **ç›‘æ§ä»£ç†**ï¼šæ”¶é›†æœåŠ¡è°ƒç”¨æ•°æ®
- **è´Ÿè½½å‡è¡¡ä»£ç†**ï¼šåˆ†å‘è¯·æ±‚åˆ°ä¸åŒæœåŠ¡å®ä¾‹

### 7.2 æ•°æ®åº“æ“ä½œä¸­çš„ä»£ç†


```java
// æ•°æ®åº“è¿æ¥æ± ä»£ç†
public class ConnectionPoolProxy implements InvocationHandler {
    private ConnectionPool pool;
    private Connection realConnection;
    
    @Override
    public Object invoke(Object proxy, Method method, Object[] args) {
        if ("close".equals(method.getName())) {
            // ä¸çœŸæ­£å…³é—­è¿æ¥ï¼Œè€Œæ˜¯å½’è¿˜ç»™è¿æ¥æ± 
            pool.returnConnection(realConnection);
            return null;
        }
        
        // å…¶ä»–æ–¹æ³•æ­£å¸¸æ‰§è¡Œ
        return method.invoke(realConnection, args);
    }
}
```

### 7.3 ç¼“å­˜ç³»ç»Ÿä¸­çš„ä»£ç†


| åº”ç”¨åœºæ™¯ | **ä»£ç†ä½œç”¨** | **å®é™…æ•ˆæœ** |
|---------|-------------|-------------|
| ğŸ—„ï¸ **Redisç¼“å­˜** | `é€æ˜ç¼“å­˜è¯»å†™` | `ç”¨æˆ·æ— æ„ŸçŸ¥çš„æ€§èƒ½æå‡` |
| ğŸ’¾ **æœ¬åœ°ç¼“å­˜** | `å†…å­˜ç¼“å­˜ç®¡ç†` | `å‡å°‘ç½‘ç»œè¯·æ±‚` |
| ğŸ”„ **ç¼“å­˜æ›´æ–°** | `è‡ªåŠ¨å¤±æ•ˆå’Œåˆ·æ–°` | `ä¿è¯æ•°æ®ä¸€è‡´æ€§` |

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ AOPåˆ‡é¢ç¼–ç¨‹ï¼šæ¨ªåˆ‡å…³æ³¨ç‚¹çš„ç»Ÿä¸€å¤„ç†ï¼Œåƒæ€»ç®¡ç»Ÿä¸€å¤„ç†éæ ¸å¿ƒä¸šåŠ¡
ğŸ”¸ äº‹åŠ¡ä»£ç†ï¼šä¿è¯æ“ä½œçš„ACIDç‰¹æ€§ï¼Œè¦ä¹ˆå…¨æˆåŠŸè¦ä¹ˆå…¨å¤±è´¥
ğŸ”¸ å®‰å…¨ä»£ç†ï¼šèº«ä»½éªŒè¯ã€æƒé™æ£€æŸ¥ã€æ“ä½œè®°å½•çš„ç»Ÿä¸€ç®¡ç†
ğŸ”¸ æ€§èƒ½ç›‘æ§ï¼šé€æ˜åœ°æ”¶é›†ç³»ç»Ÿè¿è¡Œæ•°æ®ï¼ŒåŠæ—¶å‘ç°æ€§èƒ½é—®é¢˜
ğŸ”¸ ä»£ç†é“¾ï¼šå¤šä¸ªä»£ç†ç»„åˆä½¿ç”¨ï¼Œçµæ´»å¤„ç†å¤æ‚ä¸šåŠ¡éœ€æ±‚
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆéœ€è¦é«˜çº§ä»£ç†**ï¼š
```
ä¼ ç»Ÿæ–¹å¼é—®é¢˜ï¼š
- æ ¸å¿ƒä¸šåŠ¡ä»£ç ä¸è¾…åŠ©åŠŸèƒ½æ··æ‚
- é‡å¤ä»£ç å¤šï¼Œç»´æŠ¤å›°éš¾
- åŠŸèƒ½è€¦åˆåº¦é«˜ï¼Œéš¾ä»¥æµ‹è¯•

ä»£ç†æ¨¡å¼è§£å†³ï¼š
- å…³æ³¨ç‚¹åˆ†ç¦»ï¼Œå„å¸å…¶èŒ
- é€æ˜å¢å¼ºï¼Œæ— ä¾µå…¥æ€§
- çµæ´»ç»„åˆï¼Œæ˜“äºæ‰©å±•
```

**ğŸ”¹ ä»£ç†é“¾çš„è®¾è®¡æ€æƒ³**ï¼š
```
è´£ä»»é“¾æ¨¡å¼ + ä»£ç†æ¨¡å¼ = ä»£ç†é“¾æ¨¡å¼

ä¼˜åŠ¿ï¼š
- æ¯ä¸ªèŠ‚ç‚¹èŒè´£å•ä¸€
- å¯ä»¥çµæ´»ç»„åˆ
- æ˜“äºæµ‹è¯•å’Œç»´æŠ¤
- æ”¯æŒåŠ¨æ€é…ç½®
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ’¡ ä»€ä¹ˆæ—¶å€™ä½¿ç”¨é«˜çº§ä»£ç†**ï¼š
- âœ… éœ€è¦åœ¨å¤šä¸ªæ–¹æ³•ä¸­æ·»åŠ ç›¸åŒçš„è¾…åŠ©åŠŸèƒ½
- âœ… å¸Œæœ›åœ¨ä¸ä¿®æ”¹åŸä»£ç çš„æƒ…å†µä¸‹å¢å¼ºåŠŸèƒ½
- âœ… éœ€è¦åŠ¨æ€æ§åˆ¶æ–¹æ³•çš„æ‰§è¡Œè¡Œä¸º
- âœ… è¦ç»Ÿä¸€å¤„ç†æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆæ—¥å¿—ã€å®‰å…¨ã€äº‹åŠ¡ç­‰ï¼‰

**âš ï¸ ä½¿ç”¨æ³¨æ„äº‹é¡¹**ï¼š
- **æ€§èƒ½å¼€é”€**ï¼šä»£ç†ä¼šå¢åŠ æ–¹æ³•è°ƒç”¨å¼€é”€
- **è°ƒè¯•å›°éš¾**ï¼šä»£ç†é“¾è¿‡é•¿æ—¶éš¾ä»¥è°ƒè¯•
- **å¤æ‚åº¦æ§åˆ¶**ï¼šé¿å…è¿‡åº¦è®¾è®¡ï¼Œæ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©
- **æ–‡æ¡£è¯´æ˜**ï¼šä»£ç†é€»è¾‘è¦æœ‰æ¸…æ™°çš„æ–‡æ¡£è¯´æ˜

### 8.4 å­¦ä¹ è·¯å¾„å»ºè®®


```
å­¦ä¹ æ­¥éª¤ï¼š
1ï¸âƒ£ ç†è§£åŸºç¡€ä»£ç†æ¨¡å¼
2ï¸âƒ£ æŒæ¡JavaåŠ¨æ€ä»£ç†æœºåˆ¶  
3ï¸âƒ£ å­¦ä¹ AOPåŸºæœ¬æ¦‚å¿µ
4ï¸âƒ£ å®è·µç®€å•çš„ç›‘æ§ä»£ç†
5ï¸âƒ£ å°è¯•æ„å»ºä»£ç†é“¾
6ï¸âƒ£ ç ”ç©¶Spring AOPæºç 
```

**ğŸ”§ åŠ¨æ‰‹ç»ƒä¹ å»ºè®®**ï¼š
- å®ç°ä¸€ä¸ªç®€å•çš„æ—¥å¿—ä»£ç†
- æ„å»ºä¸€ä¸ªæ€§èƒ½ç›‘æ§ç³»ç»Ÿ
- è®¾è®¡ä¸€ä¸ªæƒé™æ§åˆ¶ä»£ç†
- å°è¯•ç»„åˆå¤šä¸ªä»£ç†åŠŸèƒ½

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
ä»£ç†æ¨¡å¼ç”¨é€”å¹¿ï¼Œæ¨ªåˆ‡å…³æ³¨ç‚¹æ¥å¸®å¿™
AOPåˆ‡é¢å¾ˆé‡è¦ï¼Œäº‹åŠ¡å®‰å…¨ä¸èƒ½å°‘  
æ€§èƒ½ç›‘æ§è¦åšå¥½ï¼Œä»£ç†é“¾æ¡æ›´çµå·§
æ— ä¾µå…¥æ€§æ˜¯å…³é”®ï¼Œå…³æ³¨åˆ†ç¦»å¥½ç»´æŠ¤
```