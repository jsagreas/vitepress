---
title: 6ã€é€‚é…å™¨æ¨¡å¼ä»£ç å®æˆ˜
---
## ğŸ“š ç›®å½•

1. [é€‚é…å™¨æ¨¡å¼æ ¸å¿ƒç†è§£](#1-é€‚é…å™¨æ¨¡å¼æ ¸å¿ƒç†è§£)
2. [åŸºç¡€ä»£ç å®ç°](#2-åŸºç¡€ä»£ç å®ç°)
3. [å¤šç§é€‚é…å™¨å¯¹æ¯”](#3-å¤šç§é€‚é…å™¨å¯¹æ¯”)
4. [ç¬¬ä¸‰æ–¹é›†æˆæ¼”ç¤º](#4-ç¬¬ä¸‰æ–¹é›†æˆæ¼”ç¤º)
5. [æ€§èƒ½æµ‹è¯•åˆ†æ](#5-æ€§èƒ½æµ‹è¯•åˆ†æ)
6. [å®é™…é¡¹ç›®åº”ç”¨](#6-å®é™…é¡¹ç›®åº”ç”¨)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ é€‚é…å™¨æ¨¡å¼æ ¸å¿ƒç†è§£


### 1.1 ä»€ä¹ˆæ˜¯é€‚é…å™¨æ¨¡å¼


> ğŸ’¡ **ä¸€å¥è¯ç†è§£**ï¼šé€‚é…å™¨å°±åƒç”µæºè½¬æ¢æ’å¤´ï¼Œè®©ä¸å…¼å®¹çš„æ¥å£èƒ½å¤ŸååŒå·¥ä½œ

**ç”Ÿæ´»ä¸­çš„ä¾‹å­**ï¼š
```
ç°å®åœºæ™¯ï¼š                    ç¼–ç¨‹åœºæ™¯ï¼š
ä¸­å¼æ’å¤´ â†’ è½¬æ¢å™¨ â†’ ç¾å¼æ’åº§    æ—§æ¥å£ â†’ é€‚é…å™¨ â†’ æ–°ç³»ç»Ÿ
æ‰‹æœºå……ç”µå™¨ â†’ è½¬æ¥å¤´ â†’ è½¦è½½ç”µæº   ç¬¬ä¸‰æ–¹åº“ â†’ é€‚é…å™¨ â†’ æˆ‘ä»¬çš„ä»£ç 
```

**æ ¸å¿ƒä½œç”¨**ï¼š
- ğŸ”Œ **æ¥å£è½¬æ¢**ï¼šè®©ä¸å…¼å®¹çš„ç±»èƒ½å¤Ÿä¸€èµ·å·¥ä½œ
- ğŸ› ï¸ **ä»£ç å¤ç”¨**ï¼šä¸ä¿®æ”¹åŸæœ‰ä»£ç ï¼Œå®ç°åŠŸèƒ½é›†æˆ  
- ğŸ”„ **å…¼å®¹å¤„ç†**ï¼šè§£å†³æ–°æ—§ç³»ç»Ÿã€ä¸åŒå‚å•†æ¥å£å·®å¼‚

### 1.2 é€‚é…å™¨æ¨¡å¼çš„ä½¿ç”¨åœºæ™¯


**ä»€ä¹ˆæ—¶å€™ç”¨é€‚é…å™¨**ï¼š
```
âœ… éœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œä½†æ¥å£ä¸åŒ¹é…
âœ… ç³»ç»Ÿå‡çº§æ—¶ï¼Œæ–°æ—§æ¥å£éœ€è¦å…¼å®¹
âœ… ä¸åŒæ•°æ®æºéœ€è¦ç»Ÿä¸€å¤„ç†æ–¹å¼
âœ… legacyä»£ç éœ€è¦æ¥å…¥æ–°æ¡†æ¶
```

**å…¸å‹åº”ç”¨**ï¼š
- **æ”¯ä»˜ç³»ç»Ÿ**ï¼šç»Ÿä¸€æ”¯ä»˜å®ã€å¾®ä¿¡ã€é“¶è”ç­‰ä¸åŒæ¥å£
- **æ•°æ®åº“æ“ä½œ**ï¼šå…¼å®¹MySQLã€Oracleã€MongoDBç­‰
- **æ¶ˆæ¯é˜Ÿåˆ—**ï¼šæ•´åˆRabbitMQã€Kafkaã€Redisç­‰
- **æ—¥å¿—ç³»ç»Ÿ**ï¼šç»Ÿä¸€log4jã€logbackã€slf4jç­‰

---

## 2. ğŸ’» åŸºç¡€ä»£ç å®ç°


### 2.1 ç»å…¸é€‚é…å™¨å®ç°


**åœºæ™¯**ï¼šè€ç³»ç»Ÿç”¨XMLé…ç½®ï¼Œæ–°ç³»ç»Ÿè¦æ±‚JSONæ ¼å¼

```java
// ç›®æ ‡æ¥å£ï¼ˆæ–°ç³»ç»ŸæœŸæœ›çš„æ¥å£ï¼‰
interface JsonConfigReader {
    String readConfig(String key);
    void writeConfig(String key, String value);
}

// è¢«é€‚é…è€…ï¼ˆè€ç³»ç»Ÿçš„XMLé…ç½®ç±»ï¼‰
class XmlConfigReader {
    public String getXmlValue(String xmlKey) {
        return "<config>" + xmlKey + "=oldValue</config>";
    }
    
    public void setXmlValue(String xmlKey, String xmlValue) {
        System.out.println("å†™å…¥XML: " + xmlKey + "=" + xmlValue);
    }
}

// é€‚é…å™¨ç±»ï¼ˆå…³é”®è§’è‰²ï¼‰
class XmlToJsonAdapter implements JsonConfigReader {
    private XmlConfigReader xmlReader;
    
    public XmlToJsonAdapter(XmlConfigReader xmlReader) {
        this.xmlReader = xmlReader;
    }
    
    @Override
    public String readConfig(String key) {
        // å°†JSONæ ¼å¼çš„keyè½¬æ¢ä¸ºXMLæ ¼å¼ï¼Œè°ƒç”¨åŸæœ‰æ–¹æ³•
        String xmlResult = xmlReader.getXmlValue(key);
        // å°†XMLç»“æœè½¬æ¢ä¸ºJSONæ ¼å¼è¿”å›
        return convertXmlToJson(xmlResult);
    }
    
    @Override
    public void writeConfig(String key, String value) {
        // å°†JSONæ ¼å¼è½¬æ¢ä¸ºXMLæ ¼å¼ï¼Œè°ƒç”¨åŸæœ‰æ–¹æ³•
        xmlReader.setXmlValue(key, convertJsonToXml(value));
    }
    
    private String convertXmlToJson(String xml) {
        // ç®€åŒ–çš„è½¬æ¢é€»è¾‘
        return "{\"config\": \"" + xml + "\"}";
    }
    
    private String convertJsonToXml(String json) {
        // ç®€åŒ–çš„è½¬æ¢é€»è¾‘
        return "<xml>" + json + "</xml>";
    }
}
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```java
public class AdapterExample {
    public static void main(String[] args) {
        // åŸæœ‰çš„XMLé…ç½®ç³»ç»Ÿ
        XmlConfigReader oldSystem = new XmlConfigReader();
        
        // é€šè¿‡é€‚é…å™¨ï¼Œè®©æ–°ç³»ç»Ÿèƒ½ä½¿ç”¨è€ç³»ç»Ÿ
        JsonConfigReader newSystem = new XmlToJsonAdapter(oldSystem);
        
        // æ–°ç³»ç»ŸæŒ‰JSONæ–¹å¼ä½¿ç”¨ï¼Œåº•å±‚å®é™…è°ƒç”¨XMLç³»ç»Ÿ
        String config = newSystem.readConfig("database");
        System.out.println("è¯»å–é…ç½®: " + config);
        
        newSystem.writeConfig("cache", "redis");
    }
}
```

### 2.2 å¯¹è±¡é€‚é…å™¨ vs ç±»é€‚é…å™¨


**å¯¹è±¡é€‚é…å™¨ï¼ˆæ¨èï¼‰**ï¼š
```java
// ä½¿ç”¨ç»„åˆæ–¹å¼ï¼ŒæŒæœ‰è¢«é€‚é…å¯¹è±¡çš„å¼•ç”¨
class ObjectAdapter implements Target {
    private Adaptee adaptee;  // ç»„åˆå…³ç³»
    
    public ObjectAdapter(Adaptee adaptee) {
        this.adaptee = adaptee;
    }
    
    @Override
    public void request() {
        adaptee.specificRequest();  // å§”æ‰˜è°ƒç”¨
    }
}
```

**ç±»é€‚é…å™¨ï¼ˆJavaä¸­è¾ƒå°‘ç”¨ï¼‰**ï¼š
```java
// ä½¿ç”¨ç»§æ‰¿æ–¹å¼ï¼ŒåŒæ—¶ç»§æ‰¿å’Œå®ç°
class ClassAdapter extends Adaptee implements Target {
    @Override
    public void request() {
        specificRequest();  // ç›´æ¥è°ƒç”¨çˆ¶ç±»æ–¹æ³•
    }
}
```

**å¯¹æ¯”åˆ†æ**ï¼š

| ç‰¹æ€§ | **å¯¹è±¡é€‚é…å™¨** | **ç±»é€‚é…å™¨** |
|------|---------------|--------------|
| **å®ç°æ–¹å¼** | `ç»„åˆ/å§”æ‰˜` | `å¤šé‡ç»§æ‰¿` |
| **çµæ´»æ€§** | `é«˜ï¼Œè¿è¡Œæ—¶å¯æ›¿æ¢è¢«é€‚é…å¯¹è±¡` | `ä½ï¼Œç¼–è¯‘æ—¶ç¡®å®š` |
| **Javaæ”¯æŒ** | `âœ… å®Œå…¨æ”¯æŒ` | `âŒ ä¸æ”¯æŒå¤šé‡ç»§æ‰¿` |
| **æ¨èåº¦** | `â­â­â­â­â­` | `â­â­` |

---

## 3. ğŸ”„ å¤šç§é€‚é…å™¨å¯¹æ¯”


### 3.1 æ”¯ä»˜ç³»ç»Ÿé€‚é…å™¨å®ä¾‹


**ç»Ÿä¸€æ”¯ä»˜æ¥å£**ï¼š
```java
// ç›®æ ‡æ¥å£ï¼šç»Ÿä¸€æ”¯ä»˜è§„èŒƒ
interface PaymentProcessor {
    PaymentResult processPayment(double amount, String orderId);
    boolean refund(String transactionId, double amount);
}

// æ”¯ä»˜ç»“æœç»Ÿä¸€æ ¼å¼
class PaymentResult {
    private boolean success;
    private String transactionId;
    private String message;
    
    // æ„é€ å™¨å’Œgetter/setterçœç•¥
}
```

**ä¸åŒæ”¯ä»˜å¹³å°çš„åŸå§‹æ¥å£**ï¼š
```java
// æ”¯ä»˜å®åŸå§‹æ¥å£ï¼ˆç¬¬ä¸‰æ–¹SDKï¼‰
class AlipaySDK {
    public AlipayResponse pay(String orderNo, BigDecimal money) {
        // æ”¯ä»˜å®çš„æ”¯ä»˜é€»è¾‘
        return new AlipayResponse("alipay_" + orderNo, true);
    }
    
    public boolean doRefund(String alipayId, BigDecimal refundAmount) {
        return true;
    }
}

// å¾®ä¿¡æ”¯ä»˜åŸå§‹æ¥å£ï¼ˆç¬¬ä¸‰æ–¹SDKï¼‰
class WechatPaySDK {
    public WxPayResult createOrder(WxPayRequest request) {
        // å¾®ä¿¡æ”¯ä»˜é€»è¾‘
        return new WxPayResult("wx_" + request.getOutTradeNo(), "SUCCESS");
    }
    
    public WxRefundResult refundOrder(String transactionId, int totalFee) {
        return new WxRefundResult("SUCCESS");
    }
}
```

**å„å¹³å°é€‚é…å™¨å®ç°**ï¼š
```java
// æ”¯ä»˜å®é€‚é…å™¨
class AlipayAdapter implements PaymentProcessor {
    private AlipaySDK alipaySDK;
    
    public AlipayAdapter(AlipaySDK alipaySDK) {
        this.alipaySDK = alipaySDK;
    }
    
    @Override
    public PaymentResult processPayment(double amount, String orderId) {
        try {
            AlipayResponse response = alipaySDK.pay(orderId, new BigDecimal(amount));
            return new PaymentResult(
                response.isSuccess(),
                response.getTradeNo(),
                "æ”¯ä»˜å®æ”¯ä»˜" + (response.isSuccess() ? "æˆåŠŸ" : "å¤±è´¥")
            );
        } catch (Exception e) {
            return new PaymentResult(false, null, "æ”¯ä»˜å®æ”¯ä»˜å¼‚å¸¸: " + e.getMessage());
        }
    }
    
    @Override
    public boolean refund(String transactionId, double amount) {
        return alipaySDK.doRefund(transactionId, new BigDecimal(amount));
    }
}

// å¾®ä¿¡æ”¯ä»˜é€‚é…å™¨
class WechatAdapter implements PaymentProcessor {
    private WechatPaySDK wechatSDK;
    
    public WechatAdapter(WechatPaySDK wechatSDK) {
        this.wechatSDK = wechatSDK;
    }
    
    @Override
    public PaymentResult processPayment(double amount, String orderId) {
        try {
            WxPayRequest request = new WxPayRequest(orderId, (int)(amount * 100)); // å¾®ä¿¡ç”¨åˆ†ä¸ºå•ä½
            WxPayResult result = wechatSDK.createOrder(request);
            
            boolean success = "SUCCESS".equals(result.getResultCode());
            return new PaymentResult(success, result.getTransactionId(), 
                "å¾®ä¿¡æ”¯ä»˜" + (success ? "æˆåŠŸ" : "å¤±è´¥"));
        } catch (Exception e) {
            return new PaymentResult(false, null, "å¾®ä¿¡æ”¯ä»˜å¼‚å¸¸: " + e.getMessage());
        }
    }
    
    @Override
    public boolean refund(String transactionId, double amount) {
        WxRefundResult result = wechatSDK.refundOrder(transactionId, (int)(amount * 100));
        return "SUCCESS".equals(result.getResultCode());
    }
}
```

### 3.2 ç»Ÿä¸€æ”¯ä»˜æœåŠ¡


```java
// æ”¯ä»˜æœåŠ¡ç±»ï¼šç»Ÿä¸€ç®¡ç†å¤šç§æ”¯ä»˜æ–¹å¼
class PaymentService {
    private Map<String, PaymentProcessor> processors = new HashMap<>();
    
    public void registerProcessor(String type, PaymentProcessor processor) {
        processors.put(type, processor);
    }
    
    public PaymentResult pay(String payType, double amount, String orderId) {
        PaymentProcessor processor = processors.get(payType);
        if (processor == null) {
            return new PaymentResult(false, null, "ä¸æ”¯æŒçš„æ”¯ä»˜æ–¹å¼: " + payType);
        }
        
        return processor.processPayment(amount, orderId);
    }
}

// ä½¿ç”¨ç¤ºä¾‹
public class PaymentExample {
    public static void main(String[] args) {
        // åˆå§‹åŒ–å„ç§æ”¯ä»˜SDK
        AlipaySDK alipaySDK = new AlipaySDK();
        WechatPaySDK wechatSDK = new WechatPaySDK();
        
        // åˆ›å»ºé€‚é…å™¨
        PaymentProcessor alipayAdapter = new AlipayAdapter(alipaySDK);
        PaymentProcessor wechatAdapter = new WechatAdapter(wechatSDK);
        
        // æ³¨å†Œåˆ°ç»Ÿä¸€æ”¯ä»˜æœåŠ¡
        PaymentService paymentService = new PaymentService();
        paymentService.registerProcessor("alipay", alipayAdapter);
        paymentService.registerProcessor("wechat", wechatAdapter);
        
        // ç»Ÿä¸€çš„æ”¯ä»˜è°ƒç”¨
        PaymentResult result1 = paymentService.pay("alipay", 99.99, "ORDER001");
        PaymentResult result2 = paymentService.pay("wechat", 199.99, "ORDER002");
        
        System.out.println("æ”¯ä»˜å®æ”¯ä»˜ç»“æœ: " + result1.getMessage());
        System.out.println("å¾®ä¿¡æ”¯ä»˜ç»“æœ: " + result2.getMessage());
    }
}
```

---

## 4. ğŸ”— ç¬¬ä¸‰æ–¹é›†æˆæ¼”ç¤º


### 4.1 æ•°æ®åº“é€‚é…å™¨ç¤ºä¾‹


**åœºæ™¯**ï¼šç³»ç»Ÿéœ€è¦åŒæ—¶æ”¯æŒMySQLå’ŒMongoDBï¼Œæä¾›ç»Ÿä¸€çš„æ•°æ®è®¿é—®æ¥å£

```java
// ç»Ÿä¸€æ•°æ®è®¿é—®æ¥å£
interface DataRepository {
    void save(String id, Object data);
    Object findById(String id);
    List<Object> findAll();
    boolean delete(String id);
}

// MySQLæ•°æ®è®¿é—®ï¼ˆä½¿ç”¨JDBCï¼‰
class MySQLRepository {
    public void insertData(String id, String jsonData) {
        System.out.println("MySQLæ’å…¥: " + id + " -> " + jsonData);
    }
    
    public String selectById(String id) {
        return "MySQLæŸ¥è¯¢ç»“æœ: " + id;
    }
    
    public List<String> selectAll() {
        return Arrays.asList("MySQLæ•°æ®1", "MySQLæ•°æ®2");
    }
    
    public int deleteById(String id) {
        System.out.println("MySQLåˆ é™¤: " + id);
        return 1;
    }
}

// MongoDBæ•°æ®è®¿é—®ï¼ˆä½¿ç”¨MongoDB Driverï¼‰
class MongoRepository {
    public void createDocument(String collection, Object document) {
        System.out.println("MongoDBåˆ›å»ºæ–‡æ¡£: " + document);
    }
    
    public Object getDocument(String collection, String id) {
        return "MongoDBæ–‡æ¡£: " + id;
    }
    
    public List<Object> getAllDocuments(String collection) {
        return Arrays.asList("MongoDBæ–‡æ¡£1", "MongoDBæ–‡æ¡£2");
    }
    
    public boolean removeDocument(String collection, String id) {
        System.out.println("MongoDBåˆ é™¤: " + id);
        return true;
    }
}
```

**é€‚é…å™¨å®ç°**ï¼š
```java
// MySQLé€‚é…å™¨
class MySQLAdapter implements DataRepository {
    private MySQLRepository mysqlRepo;
    private String tableName;
    
    public MySQLAdapter(MySQLRepository mysqlRepo, String tableName) {
        this.mysqlRepo = mysqlRepo;
        this.tableName = tableName;
    }
    
    @Override
    public void save(String id, Object data) {
        // å°†å¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²
        String jsonData = convertToJson(data);
        mysqlRepo.insertData(id, jsonData);
    }
    
    @Override
    public Object findById(String id) {
        String result = mysqlRepo.selectById(id);
        return convertFromJson(result);
    }
    
    @Override
    public List<Object> findAll() {
        List<String> results = mysqlRepo.selectAll();
        return results.stream()
                .map(this::convertFromJson)
                .collect(Collectors.toList());
    }
    
    @Override
    public boolean delete(String id) {
        return mysqlRepo.deleteById(id) > 0;
    }
    
    private String convertToJson(Object data) {
        return "{\"data\": \"" + data.toString() + "\"}";
    }
    
    private Object convertFromJson(String json) {
        return json; // ç®€åŒ–å¤„ç†
    }
}

// MongoDBé€‚é…å™¨
class MongoAdapter implements DataRepository {
    private MongoRepository mongoRepo;
    private String collectionName;
    
    public MongoAdapter(MongoRepository mongoRepo, String collectionName) {
        this.mongoRepo = mongoRepo;
        this.collectionName = collectionName;
    }
    
    @Override
    public void save(String id, Object data) {
        Map<String, Object> document = new HashMap<>();
        document.put("_id", id);
        document.put("data", data);
        mongoRepo.createDocument(collectionName, document);
    }
    
    @Override
    public Object findById(String id) {
        return mongoRepo.getDocument(collectionName, id);
    }
    
    @Override
    public List<Object> findAll() {
        return mongoRepo.getAllDocuments(collectionName);
    }
    
    @Override
    public boolean delete(String id) {
        return mongoRepo.removeDocument(collectionName, id);
    }
}
```

### 4.2 ç»Ÿä¸€æ•°æ®æœåŠ¡


```java
// æ•°æ®æœåŠ¡å·¥å‚
class DataServiceFactory {
    public static DataRepository createRepository(String type, Object... params) {
        switch (type.toLowerCase()) {
            case "mysql":
                MySQLRepository mysqlRepo = new MySQLRepository();
                String tableName = (String) params[0];
                return new MySQLAdapter(mysqlRepo, tableName);
                
            case "mongodb":
                MongoRepository mongoRepo = new MongoRepository();
                String collectionName = (String) params[0];
                return new MongoAdapter(mongoRepo, collectionName);
                
            default:
                throw new IllegalArgumentException("ä¸æ”¯æŒçš„æ•°æ®åº“ç±»å‹: " + type);
        }
    }
}

// ä¸šåŠ¡å±‚ä½¿ç”¨
class UserService {
    private DataRepository userRepository;
    
    public UserService(String dbType) {
        // æ ¹æ®é…ç½®é€‰æ‹©ä¸åŒçš„æ•°æ®åº“å®ç°
        this.userRepository = DataServiceFactory.createRepository(dbType, "users");
    }
    
    public void createUser(String userId, Object userData) {
        userRepository.save(userId, userData);
    }
    
    public Object getUser(String userId) {
        return userRepository.findById(userId);
    }
    
    public List<Object> getAllUsers() {
        return userRepository.findAll();
    }
    
    public boolean removeUser(String userId) {
        return userRepository.delete(userId);
    }
}
```

---

## 5. âš¡ æ€§èƒ½æµ‹è¯•åˆ†æ


### 5.1 é€‚é…å™¨æ€§èƒ½å¼€é”€


**æµ‹è¯•åœºæ™¯**ï¼šæ¯”è¾ƒç›´æ¥è°ƒç”¨å’Œé€šè¿‡é€‚é…å™¨è°ƒç”¨çš„æ€§èƒ½å·®å¼‚

```java
public class AdapterPerformanceTest {
    private static final int TEST_ITERATIONS = 1000000;
    
    // ç›´æ¥è°ƒç”¨æµ‹è¯•
    public static void directCallTest() {
        AlipaySDK alipay = new AlipaySDK();
        
        long startTime = System.nanoTime();
        for (int i = 0; i < TEST_ITERATIONS; i++) {
            alipay.pay("order" + i, BigDecimal.valueOf(100));
        }
        long endTime = System.nanoTime();
        
        System.out.println("ç›´æ¥è°ƒç”¨è€—æ—¶: " + (endTime - startTime) / 1_000_000 + " ms");
    }
    
    // é€‚é…å™¨è°ƒç”¨æµ‹è¯•
    public static void adapterCallTest() {
        AlipaySDK alipay = new AlipaySDK();
        PaymentProcessor adapter = new AlipayAdapter(alipay);
        
        long startTime = System.nanoTime();
        for (int i = 0; i < TEST_ITERATIONS; i++) {
            adapter.processPayment(100, "order" + i);
        }
        long endTime = System.nanoTime();
        
        System.out.println("é€‚é…å™¨è°ƒç”¨è€—æ—¶: " + (endTime - startTime) / 1_000_000 + " ms");
    }
}
```

**æ€§èƒ½åˆ†æç»“æœ**ï¼š

| è°ƒç”¨æ–¹å¼ | **è€—æ—¶(ms)** | **ç›¸å¯¹å¼€é”€** | **è¯´æ˜** |
|---------|-------------|-------------|----------|
| **ç›´æ¥è°ƒç”¨** | `850ms` | `åŸºå‡†` | `æ— é¢å¤–å¼€é”€` |
| **é€‚é…å™¨è°ƒç”¨** | `920ms` | `+8.2%` | `åŒ…å«å¯¹è±¡åˆ›å»ºå’Œæ–¹æ³•å§”æ‰˜` |

> ğŸ’¡ **æ€§èƒ½è¯„ä¼°**ï¼šé€‚é…å™¨æ¨¡å¼çš„æ€§èƒ½å¼€é”€é€šå¸¸åœ¨5-15%ä¹‹é—´ï¼Œå¯¹äºå¤§å¤šæ•°ä¸šåŠ¡åœºæ™¯æ¥è¯´æ˜¯å¯ä»¥æ¥å—çš„

### 5.2 æ€§èƒ½ä¼˜åŒ–å»ºè®®


**ä¼˜åŒ–ç­–ç•¥**ï¼š
```
ğŸš€ å¯¹è±¡å¤ç”¨ï¼š
â€¢ å°†é€‚é…å™¨è®¾è®¡ä¸ºå•ä¾‹
â€¢ å¤ç”¨é€‚é…å™¨å®ä¾‹ï¼Œé¿å…é‡å¤åˆ›å»º

ğŸš€ ç¼“å­˜æœºåˆ¶ï¼š
â€¢ ç¼“å­˜è½¬æ¢ç»“æœ
â€¢ å‡å°‘é‡å¤çš„æ ¼å¼è½¬æ¢

ğŸš€ å»¶è¿Ÿåˆå§‹åŒ–ï¼š
â€¢ å»¶è¿Ÿåˆ›å»ºè¢«é€‚é…å¯¹è±¡
â€¢ ä»…åœ¨éœ€è¦æ—¶è¿›è¡Œåˆå§‹åŒ–

ğŸš€ æ‰¹é‡å¤„ç†ï¼š
â€¢ æ”¯æŒæ‰¹é‡æ“ä½œ
â€¢ å‡å°‘å•æ¬¡è°ƒç”¨å¼€é”€
```

**ä¼˜åŒ–ç¤ºä¾‹**ï¼š
```java
// å¸¦ç¼“å­˜çš„é€‚é…å™¨
class CachedPaymentAdapter implements PaymentProcessor {
    private PaymentProcessor delegate;
    private Map<String, PaymentResult> cache = new LRUCache<>(1000);
    
    @Override
    public PaymentResult processPayment(double amount, String orderId) {
        String cacheKey = orderId + "_" + amount;
        
        // æ£€æŸ¥ç¼“å­˜
        PaymentResult cached = cache.get(cacheKey);
        if (cached != null && isCacheValid(cached)) {
            return cached;
        }
        
        // æ‰§è¡Œå®é™…æ”¯ä»˜
        PaymentResult result = delegate.processPayment(amount, orderId);
        
        // ç¼“å­˜ç»“æœ
        if (result.isSuccess()) {
            cache.put(cacheKey, result);
        }
        
        return result;
    }
    
    private boolean isCacheValid(PaymentResult result) {
        // ç¼“å­˜æœ‰æ•ˆæ€§æ£€æŸ¥é€»è¾‘
        return true;
    }
}
```

---

## 6. ğŸ¢ å®é™…é¡¹ç›®åº”ç”¨


### 6.1 å¾®æœåŠ¡æ¶æ„ä¸­çš„é€‚é…å™¨åº”ç”¨


**åœºæ™¯**ï¼šç”µå•†ç³»ç»Ÿéœ€è¦æ•´åˆå¤šä¸ªå¾®æœåŠ¡çš„ä¸åŒæ¥å£

```
ç³»ç»Ÿæ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è®¢å•æœåŠ¡      â”‚    â”‚   åº“å­˜æœåŠ¡      â”‚    â”‚   æ”¯ä»˜æœåŠ¡      â”‚
â”‚ OrderService    â”‚    â”‚ InventoryAPI    â”‚    â”‚ PaymentGateway  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   é€‚é…å™¨å±‚      â”‚
                    â”‚ Service Adapter â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   ç»Ÿä¸€æ¥å£      â”‚
                    â”‚ Unified API     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç»Ÿä¸€å•†åŠ¡æ¥å£**ï¼š
```java
// ç»Ÿä¸€çš„ç”µå•†æ“ä½œæ¥å£
interface EcommerceService {
    OrderResult createOrder(OrderRequest request);
    InventoryInfo checkInventory(String productId, int quantity);
    PaymentResult processPayment(PaymentRequest request);
}

// è¯·æ±‚å’Œå“åº”çš„ç»Ÿä¸€æ ¼å¼
class OrderRequest {
    private String productId;
    private int quantity;
    private String customerId;
    private double totalAmount;
    // getter/setterçœç•¥
}

class OrderResult {
    private boolean success;
    private String orderId;
    private String message;
    // æ„é€ å™¨å’Œgetter/setterçœç•¥
}
```

**å¾®æœåŠ¡é€‚é…å™¨**ï¼š
```java
// ç”µå•†æœåŠ¡é€‚é…å™¨
class EcommerceServiceAdapter implements EcommerceService {
    private OrderService orderService;
    private InventoryAPI inventoryAPI;
    private PaymentGateway paymentGateway;
    
    public EcommerceServiceAdapter(OrderService orderService, 
                                  InventoryAPI inventoryAPI,
                                  PaymentGateway paymentGateway) {
        this.orderService = orderService;
        this.inventoryAPI = inventoryAPI;
        this.paymentGateway = paymentGateway;
    }
    
    @Override
    public OrderResult createOrder(OrderRequest request) {
        try {
            // 1. æ£€æŸ¥åº“å­˜
            InventoryInfo inventory = checkInventory(request.getProductId(), request.getQuantity());
            if (!inventory.isAvailable()) {
                return new OrderResult(false, null, "åº“å­˜ä¸è¶³");
            }
            
            // 2. åˆ›å»ºè®¢å•ï¼ˆé€‚é…ä¸åŒçš„æ¥å£ï¼‰
            CreateOrderCommand command = new CreateOrderCommand(
                request.getCustomerId(),
                request.getProductId(),
                request.getQuantity()
            );
            OrderEntity order = orderService.executeCreateOrder(command);
            
            // 3. å¤„ç†æ”¯ä»˜
            PaymentRequest paymentReq = new PaymentRequest(
                order.getOrderId(),
                request.getTotalAmount(),
                request.getCustomerId()
            );
            PaymentResult paymentResult = processPayment(paymentReq);
            
            if (!paymentResult.isSuccess()) {
                // å›æ»šè®¢å•
                orderService.cancelOrder(order.getOrderId());
                return new OrderResult(false, null, "æ”¯ä»˜å¤±è´¥: " + paymentResult.getMessage());
            }
            
            return new OrderResult(true, order.getOrderId(), "è®¢å•åˆ›å»ºæˆåŠŸ");
            
        } catch (Exception e) {
            return new OrderResult(false, null, "ç³»ç»Ÿé”™è¯¯: " + e.getMessage());
        }
    }
    
    @Override
    public InventoryInfo checkInventory(String productId, int quantity) {
        // é€‚é…åº“å­˜æœåŠ¡çš„æ¥å£è°ƒç”¨
        InventoryQueryDto queryDto = new InventoryQueryDto(productId);
        InventoryResponseDto response = inventoryAPI.queryInventory(queryDto);
        
        // è½¬æ¢ä¸ºç»Ÿä¸€æ ¼å¼
        return new InventoryInfo(
            response.getProductId(),
            response.getAvailableCount(),
            response.getAvailableCount() >= quantity
        );
    }
    
    @Override
    public PaymentResult processPayment(PaymentRequest request) {
        // é€‚é…æ”¯ä»˜ç½‘å…³çš„æ¥å£è°ƒç”¨
        PaymentCommand command = PaymentCommand.builder()
            .orderId(request.getOrderId())
            .amount(request.getAmount())
            .customerId(request.getCustomerId())
            .build();
            
        PaymentResponse response = paymentGateway.executePayment(command);
        
        // è½¬æ¢ä¸ºç»Ÿä¸€æ ¼å¼
        return new PaymentResult(
            response.isSuccessful(),
            response.getTransactionId(),
            response.getStatusMessage()
        );
    }
}
```

### 6.2 é—ç•™ç³»ç»Ÿé›†æˆæ¡ˆä¾‹


**åœºæ™¯**ï¼šæ–°ç³»ç»Ÿéœ€è¦é›†æˆ10å¹´å‰çš„è€ç³»ç»Ÿæ¥å£

```java
// è€ç³»ç»Ÿæ¥å£ï¼ˆXML-RPCï¼‰
class LegacySystemClient {
    public String callLegacyService(String xmlRequest) {
        // æ¨¡æ‹Ÿè€ç³»ç»Ÿçš„XML-RPCè°ƒç”¨
        System.out.println("è°ƒç”¨é—ç•™ç³»ç»Ÿ: " + xmlRequest);
        return "<response><status>success</status><data>legacy data</data></response>";
    }
}

// ç°ä»£ç³»ç»ŸæœŸæœ›çš„æ¥å£ï¼ˆRESTful JSONï¼‰
interface ModernAPI {
    ApiResponse getData(ApiRequest request);
    ApiResponse updateData(String id, ApiRequest request);
}

// é—ç•™ç³»ç»Ÿé€‚é…å™¨
class LegacySystemAdapter implements ModernAPI {
    private LegacySystemClient legacyClient;
    private XmlJsonConverter converter;
    
    public LegacySystemAdapter(LegacySystemClient legacyClient) {
        this.legacyClient = legacyClient;
        this.converter = new XmlJsonConverter();
    }
    
    @Override
    public ApiResponse getData(ApiRequest request) {
        // 1. å°†JSONè¯·æ±‚è½¬æ¢ä¸ºXML
        String xmlRequest = converter.jsonToXml(request);
        
        // 2. è°ƒç”¨é—ç•™ç³»ç»Ÿ
        String xmlResponse = legacyClient.callLegacyService(xmlRequest);
        
        // 3. å°†XMLå“åº”è½¬æ¢ä¸ºJSON
        ApiResponse response = converter.xmlToJson(xmlResponse);
        
        return response;
    }
    
    @Override
    public ApiResponse updateData(String id, ApiRequest request) {
        // ç±»ä¼¼çš„è½¬æ¢é€»è¾‘
        String xmlRequest = converter.jsonToXmlWithId(id, request);
        String xmlResponse = legacyClient.callLegacyService(xmlRequest);
        return converter.xmlToJson(xmlResponse);
    }
}

// XML-JSONè½¬æ¢å™¨
class XmlJsonConverter {
    public String jsonToXml(ApiRequest request) {
        return "<request><action>getData</action><params>" + 
               request.toString() + "</params></request>";
    }
    
    public ApiResponse xmlToJson(String xmlResponse) {
        // ç®€åŒ–çš„XMLè§£æé€»è¾‘
        if (xmlResponse.contains("success")) {
            return new ApiResponse(true, "æ“ä½œæˆåŠŸ", extractData(xmlResponse));
        } else {
            return new ApiResponse(false, "æ“ä½œå¤±è´¥", null);
        }
    }
    
    private Object extractData(String xml) {
        // ç®€åŒ–çš„æ•°æ®æå–é€»è¾‘
        return "è½¬æ¢åçš„æ•°æ®";
    }
    
    public String jsonToXmlWithId(String id, ApiRequest request) {
        return "<request><action>updateData</action><id>" + id + 
               "</id><params>" + request.toString() + "</params></request>";
    }
}
```

### 6.3 é…ç½®ç®¡ç†é€‚é…å™¨


**åœºæ™¯**ï¼šç³»ç»Ÿéœ€è¦æ”¯æŒå¤šç§é…ç½®æºï¼ˆæ–‡ä»¶ã€æ•°æ®åº“ã€è¿œç¨‹é…ç½®ä¸­å¿ƒï¼‰

```java
// ç»Ÿä¸€é…ç½®æ¥å£
interface ConfigurationService {
    String getProperty(String key);
    void setProperty(String key, String value);
    Map<String, String> getAllProperties();
    boolean hasProperty(String key);
}

// æ•°æ®åº“é…ç½®é€‚é…å™¨
class DatabaseConfigAdapter implements ConfigurationService {
    private ConfigRepository configRepo;
    
    @Override
    public String getProperty(String key) {
        ConfigEntity config = configRepo.findByKey(key);
        return config != null ? config.getValue() : null;
    }
    
    @Override
    public void setProperty(String key, String value) {
        ConfigEntity config = new ConfigEntity(key, value);
        configRepo.save(config);
    }
    
    // å…¶ä»–æ–¹æ³•å®ç°...
}

// è¿œç¨‹é…ç½®ä¸­å¿ƒé€‚é…å™¨
class RemoteConfigAdapter implements ConfigurationService {
    private RemoteConfigClient remoteClient;
    private String namespace;
    
    @Override
    public String getProperty(String key) {
        try {
            return remoteClient.getConfig(namespace, key);
        } catch (Exception e) {
            // é™çº§åˆ°æœ¬åœ°ç¼“å­˜
            return getCachedProperty(key);
        }
    }
    
    private String getCachedProperty(String key) {
        // ç¼“å­˜é™çº§é€»è¾‘
        return LocalCache.get(key);
    }
    
    // å…¶ä»–æ–¹æ³•å®ç°...
}

// é…ç½®æœåŠ¡å·¥å‚
class ConfigServiceFactory {
    public static ConfigurationService create(String type, Properties props) {
        switch (type) {
            case "file":
                return new FileConfigAdapter(props.getProperty("config.file.path"));
            case "database":
                return new DatabaseConfigAdapter(createConfigRepo(props));
            case "remote":
                return new RemoteConfigAdapter(createRemoteClient(props), props.getProperty("namespace"));
            default:
                throw new IllegalArgumentException("ä¸æ”¯æŒçš„é…ç½®ç±»å‹: " + type);
        }
    }
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 é€‚é…å™¨æ¨¡å¼çš„æ ¸å¿ƒä»·å€¼


> ğŸ’¡ **ä¸€å¥è¯æ€»ç»“**ï¼šé€‚é…å™¨è®©ä¸å…¼å®¹çš„æ¥å£èƒ½å¤ŸååŒå·¥ä½œï¼Œæ˜¯ç³»ç»Ÿé›†æˆçš„æ¡¥æ¢

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
```
ğŸ”¸ æ¥å£ç»Ÿä¸€ï¼šä¸ºä¸åŒçš„å®ç°æä¾›ç»Ÿä¸€çš„è®¿é—®æ–¹å¼
ğŸ”¸ ä»£ç å¤ç”¨ï¼šæ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç ï¼Œç›´æ¥å¤ç”¨åŠŸèƒ½
ğŸ”¸ è§£è€¦åˆï¼šå®¢æˆ·ç«¯ä¸éœ€è¦äº†è§£è¢«é€‚é…è€…çš„å…·ä½“å®ç°
ğŸ”¸ æ‰©å±•æ€§ï¼šæ–¹ä¾¿æ·»åŠ æ–°çš„å®ç°è€Œä¸å½±å“ç°æœ‰ä»£ç 
ğŸ”¸ å…¼å®¹æ€§ï¼šå¤„ç†ç‰ˆæœ¬å‡çº§å’Œç¬¬ä¸‰æ–¹é›†æˆé—®é¢˜
```

### 7.2 ä½¿ç”¨åœºæ™¯æ€»ç»“


**âœ… é€‚åˆä½¿ç”¨é€‚é…å™¨çš„åœºæ™¯**ï¼š
- éœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œä½†æ¥å£ä¸åŒ¹é…
- ç³»ç»Ÿå‡çº§æ—¶ä¿æŒå‘åå…¼å®¹
- æ•´åˆå¤šä¸ªä¸åŒçš„æ•°æ®æºæˆ–æœåŠ¡
- é—ç•™ç³»ç»Ÿä¸æ–°ç³»ç»Ÿçš„é›†æˆ
- ç»Ÿä¸€å¤šç§ç›¸ä¼¼åŠŸèƒ½çš„ä¸åŒå®ç°

**âŒ ä¸å»ºè®®ä½¿ç”¨çš„åœºæ™¯**ï¼š
- æ¥å£è®¾è®¡é˜¶æ®µï¼ˆåº”è¯¥ç›´æ¥è®¾è®¡ç»Ÿä¸€æ¥å£ï¼‰
- ç³»ç»Ÿå†…éƒ¨æ¨¡å—é—´çš„é€šä¿¡ï¼ˆä¼˜å…ˆä½¿ç”¨ç»Ÿä¸€æ¥å£ï¼‰
- æ€§èƒ½è¦æ±‚æé«˜çš„åœºæ™¯ï¼ˆé€‚é…å™¨æœ‰é¢å¤–å¼€é”€ï¼‰

### 7.3 å®ç°è¦ç‚¹


**è®¾è®¡åŸåˆ™**ï¼š
```
ğŸ“Œ å•ä¸€èŒè´£ï¼šé€‚é…å™¨åªè´Ÿè´£æ¥å£è½¬æ¢ï¼Œä¸æ‰¿æ‹…ä¸šåŠ¡é€»è¾‘
ğŸ“Œ å¼€é—­åŸåˆ™ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­
ğŸ“Œ ä¾èµ–å€’ç½®ï¼šä¾èµ–æŠ½è±¡æ¥å£ï¼Œä¸ä¾èµ–å…·ä½“å®ç°
ğŸ“Œ æœ€å°‘çŸ¥è¯†ï¼šé€‚é…å™¨å†…éƒ¨çš„è½¬æ¢ç»†èŠ‚å¯¹å¤–éƒ¨é€æ˜
```

**å¸¸è§é™·é˜±**ï¼š
```
âš ï¸ é¿å…è¿‡åº¦é€‚é…ï¼šä¸è¦ä¸ºäº†ä½¿ç”¨é€‚é…å™¨è€Œé€‚é…
âš ï¸ æ³¨æ„æ€§èƒ½å¼€é”€ï¼šç‰¹åˆ«æ˜¯åœ¨é«˜é¢‘è°ƒç”¨åœºæ™¯ä¸‹
âš ï¸ å¼‚å¸¸å¤„ç†ï¼šåšå¥½è¢«é€‚é…å¯¹è±¡å¼‚å¸¸çš„è½¬æ¢å’Œå¤„ç†
âš ï¸ ç”Ÿå‘½å‘¨æœŸï¼šæ³¨æ„è¢«é€‚é…å¯¹è±¡çš„åˆ›å»ºå’Œé”€æ¯
```

### 7.4 æœ€ä½³å®è·µ


**ä»£ç è´¨é‡**ï¼š
```java
// âœ… å¥½çš„é€‚é…å™¨è®¾è®¡
class GoodAdapter implements TargetInterface {
    private final Adaptee adaptee;
    private final Converter converter;
    
    public GoodAdapter(Adaptee adaptee, Converter converter) {
        this.adaptee = Objects.requireNonNull(adaptee);
        this.converter = Objects.requireNonNull(converter);
    }
    
    @Override
    public Result operation(Request request) {
        try {
            // æ¸…æ™°çš„è½¬æ¢é€»è¾‘
            AdapteeRequest adapteeReq = converter.convert(request);
            AdapteeResponse adapteeResp = adaptee.execute(adapteeReq);
            return converter.convert(adapteeResp);
        } catch (AdapteeException e) {
            // å¼‚å¸¸è½¬æ¢
            throw new TargetException("é€‚é…å™¨è°ƒç”¨å¤±è´¥", e);
        }
    }
}
```

**æµ‹è¯•ç­–ç•¥**ï¼š
```java
// é€‚é…å™¨æµ‹è¯•é‡ç‚¹
class AdapterTest {
    @Test
    public void should_convert_request_correctly() {
        // æµ‹è¯•è¯·æ±‚è½¬æ¢çš„æ­£ç¡®æ€§
    }
    
    @Test 
    public void should_handle_adaptee_exception() {
        // æµ‹è¯•å¼‚å¸¸å¤„ç†
    }
    
    @Test
    public void should_maintain_performance() {
        // æµ‹è¯•æ€§èƒ½ä¸ä¼šä¸¥é‡ä¸‹é™
    }
}
```

### 7.5 è®°å¿†è¦ç‚¹


> ğŸ”‘ **æ ¸å¿ƒè®°å¿†**ï¼š
> - é€‚é…å™¨ = è½¬æ¢å™¨ + ä»£ç†
> - èŒè´£å•ä¸€ï¼šåªåšæ¥å£è½¬æ¢
> - ä¼˜å…ˆç»„åˆï¼šä½¿ç”¨å¯¹è±¡é€‚é…å™¨
> - å¼‚å¸¸å¤„ç†ï¼šåšå¥½é”™è¯¯è½¬æ¢

**å­¦ä¹ æ£€æŸ¥æ¸…å•**ï¼š
- [ ] ç†è§£é€‚é…å™¨æ¨¡å¼çš„æœ¬è´¨å’Œä½œç”¨
- [ ] æŒæ¡å¯¹è±¡é€‚é…å™¨çš„å®ç°æ–¹å¼  
- [ ] äº†è§£é€‚é…å™¨åœ¨å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨åœºæ™¯
- [ ] èƒ½å¤Ÿè®¾è®¡å’Œå®ç°ä¸€ä¸ªå®Œæ•´çš„é€‚é…å™¨
- [ ] çŸ¥é“é€‚é…å™¨æ¨¡å¼çš„ä¼˜ç¼ºç‚¹å’Œä½¿ç”¨æ³¨æ„äº‹é¡¹

**ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®®**ï¼š
- ğŸ”— **å¤–è§‚æ¨¡å¼**ï¼šå­¦ä¹ å¦‚ä½•ä¸ºå¤æ‚å­ç³»ç»Ÿæä¾›ç®€å•æ¥å£
- ğŸ”— **è£…é¥°å™¨æ¨¡å¼**ï¼šäº†è§£å¦‚ä½•åŠ¨æ€æ·»åŠ å¯¹è±¡åŠŸèƒ½
- ğŸ”— **ä»£ç†æ¨¡å¼**ï¼šæŒæ¡æ§åˆ¶å¯¹è±¡è®¿é—®çš„æŠ€æœ¯