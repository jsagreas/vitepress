---
title: 3ã€æ¨¡æ¿æ–¹æ³•æ¨¡å¼å®ç°æŠ€å·§
---
## ğŸ“š ç›®å½•

1. [æ¨¡æ¿æ–¹æ³•è®¾è®¡åŸåˆ™](#1-æ¨¡æ¿æ–¹æ³•è®¾è®¡åŸåˆ™)
2. [é’©å­æ–¹æ³•ä½¿ç”¨æŠ€å·§](#2-é’©å­æ–¹æ³•ä½¿ç”¨æŠ€å·§)
3. [å‚æ•°ä¼ é€’æœºåˆ¶](#3-å‚æ•°ä¼ é€’æœºåˆ¶)
4. [å¼‚å¸¸å¤„ç†ç­–ç•¥](#4-å¼‚å¸¸å¤„ç†ç­–ç•¥)
5. [æ‰©å±•ç‚¹è®¾è®¡](#5-æ‰©å±•ç‚¹è®¾è®¡)
6. [å®æˆ˜åº”ç”¨æ€»ç»“](#6-å®æˆ˜åº”ç”¨æ€»ç»“)

---

## 1. ğŸ¯ æ¨¡æ¿æ–¹æ³•è®¾è®¡åŸåˆ™


### 1.1 ä»€ä¹ˆæ˜¯æ¨¡æ¿æ–¹æ³•è®¾è®¡åŸåˆ™


**é€šä¿—ç†è§£**ï¼šå°±åƒåšèœçš„æ ‡å‡†æµç¨‹ä¸€æ ·ï¼Œå…ˆæ´—èœã€å†åˆ‡èœã€ç„¶åç‚’èœã€æœ€åè£…ç›˜ã€‚è¿™ä¸ªæµç¨‹æ˜¯å›ºå®šçš„ï¼Œä½†æ¯ä¸€æ­¥çš„å…·ä½“åšæ³•å¯ä»¥ä¸åŒã€‚

```
åšèœçš„é€šç”¨æµç¨‹ï¼š
å‡†å¤‡å·¥ä½œ â†’ å¤„ç†é£Ÿæ â†’ çƒ¹é¥ªåŠ å·¥ â†’ æœ€ç»ˆè£…ç›˜

ä¸åŒèœå“çš„å…·ä½“å®ç°ï¼š
ğŸ¥— æ²™æ‹‰ï¼šæ´—èœ â†’ åˆ‡ä¸ â†’ æ‹Œè°ƒæ–™ â†’ è£…ç›˜
ğŸœ æ±¤å“ï¼šæ´—èœ â†’ åˆ‡å— â†’ ç…®æ±¤ â†’ ç››ç¢—
ğŸ¥˜ ç‚’èœï¼šæ´—èœ â†’ åˆ‡ä¸ â†’ ç‚’åˆ¶ â†’ è£…ç›˜
```

### 1.2 æ ¸å¿ƒè®¾è®¡åŸåˆ™è¯¦è§£


**ğŸ”¸ å•ä¸€èŒè´£åŸåˆ™**
```
æ¨¡æ¿ç±»èŒè´£ï¼šå®šä¹‰ç®—æ³•éª¨æ¶ï¼Œæ§åˆ¶æ‰§è¡Œæµç¨‹
å­ç±»èŒè´£ï¼šå®ç°å…·ä½“æ­¥éª¤ï¼Œæä¾›ä¸ªæ€§åŒ–è¡Œä¸º

é”™è¯¯ç¤ºä¾‹ï¼šæŠŠæ‰€æœ‰é€»è¾‘éƒ½æ”¾åœ¨æ¨¡æ¿ç±»ä¸­
æ­£ç¡®ç¤ºä¾‹ï¼šæ¨¡æ¿ç±»åªè´Ÿè´£æµç¨‹æ§åˆ¶ï¼Œå…·ä½“å®ç°äº¤ç»™å­ç±»
```

**ğŸ”¸ å¼€é—­åŸåˆ™**
```
å¯¹æ‰©å±•å¼€æ”¾ï¼šå¯ä»¥æ·»åŠ æ–°çš„å­ç±»å®ç°
å¯¹ä¿®æ”¹å…³é—­ï¼šä¸éœ€è¦ä¿®æ”¹æ¨¡æ¿ç±»çš„æ ¸å¿ƒæµç¨‹

å®é™…ä½“ç°ï¼š
- æ–°å¢ä¸šåŠ¡åœºæ™¯ â†’ æ–°å¢å­ç±»
- æµç¨‹ä¿æŒç¨³å®š â†’ æ¨¡æ¿ç±»ä¸å˜
```

**ğŸ”¸ é‡Œæ°æ›¿æ¢åŸåˆ™**
```java
// æ‰€æœ‰å­ç±»éƒ½èƒ½æ›¿æ¢çˆ¶ç±»ä½¿ç”¨
public class DataProcessor {
    public void process() {
        readData();    // å­ç±»å¿…é¡»å®ç°
        processData(); // å­ç±»å¿…é¡»å®ç°  
        saveData();    // å­ç±»å¿…é¡»å®ç°
    }
    
    // ä»»ä½•å­ç±»éƒ½èƒ½æ­£å¸¸å·¥ä½œ
    protected abstract void readData();
    protected abstract void processData();
    protected abstract void saveData();
}
```

### 1.3 è®¾è®¡åŸåˆ™å®æˆ˜æŒ‡å—


**ğŸ“‹ è®¾è®¡æ£€æŸ¥æ¸…å•**

| æ£€æŸ¥é¡¹ç›® | **è®¾è®¡è¦æ±‚** | **åˆ¤æ–­æ ‡å‡†** |
|---------|-------------|-------------|
| ğŸ¯ **èŒè´£åˆ†ç¦»** | `æ¨¡æ¿ç±»æ§åˆ¶æµç¨‹ï¼Œå­ç±»å®ç°ç»†èŠ‚` | `æ¨¡æ¿ç±»æ²¡æœ‰å…·ä½“ä¸šåŠ¡é€»è¾‘` |
| ğŸ”„ **æµç¨‹ç¨³å®š** | `æ ¸å¿ƒç®—æ³•éª¨æ¶ä¸å˜` | `å­ç±»åªå®ç°æŠ½è±¡æ–¹æ³•` |
| ğŸ“ˆ **æ‰©å±•æ€§** | `æ–°éœ€æ±‚é€šè¿‡æ–°å­ç±»æ»¡è¶³` | `ä¸ä¿®æ”¹ç°æœ‰ä»£ç ` |
| ğŸ›¡ï¸ **å°è£…æ€§** | `æ¨¡æ¿æ–¹æ³•ç”¨finalä¿®é¥°` | `å­ç±»æ— æ³•ä¿®æ”¹ç®—æ³•æµç¨‹` |

> ğŸ’¡ **è®¾è®¡æŠ€å·§**ï¼šæ¨¡æ¿æ–¹æ³•åº”è¯¥åƒ"å‰§æœ¬"ä¸€æ ·ï¼Œè§„å®šäº†æ¼”å‡ºçš„æµç¨‹å’Œç»“æ„ï¼Œä½†æ¯ä¸ªæ¼”å‘˜å¯ä»¥æœ‰è‡ªå·±çš„è¡¨æ¼”é£æ ¼ã€‚

---

## 2. ğŸ”— é’©å­æ–¹æ³•ä½¿ç”¨æŠ€å·§


### 2.1 ä»€ä¹ˆæ˜¯é’©å­æ–¹æ³•


**ç®€å•ç†è§£**ï¼šé’©å­æ–¹æ³•å°±åƒæ˜¯"å¯é€‰æ­¥éª¤"ï¼Œæœ‰äº›å­ç±»éœ€è¦æ‰§è¡Œï¼Œæœ‰äº›ä¸éœ€è¦ã€‚å°±åƒåšé¥­æ—¶çš„"åŠ è°ƒæ–™"æ­¥éª¤ï¼Œæœ‰äººå–œæ¬¢åŠ ï¼Œæœ‰äººä¸åŠ ã€‚

```
åŸºæœ¬æµç¨‹ï¼šå‡†å¤‡ â†’ å¤„ç† â†’ å®Œæˆ
é’©å­æ‰©å±•ï¼šå‡†å¤‡ â†’ å¤„ç† â†’ [å¯é€‰ï¼šç‰¹æ®Šå¤„ç†] â†’ å®Œæˆ

é’©å­çš„ä½œç”¨ï¼š
âœ… æä¾›æ‰©å±•ç‚¹ï¼Œä½†ä¸å¼ºåˆ¶å®ç°
âœ… è®©å­ç±»å¯ä»¥"æ’å…¥"è‡ªå·±çš„é€»è¾‘
âœ… ä¿æŒæ¨¡æ¿æ–¹æ³•çš„çµæ´»æ€§
```

### 2.2 é’©å­æ–¹æ³•çš„ä¸‰ç§ç±»å‹


**ğŸ”¸ æ¡ä»¶é’©å­**ï¼šæ ¹æ®æ¡ä»¶å†³å®šæ˜¯å¦æ‰§è¡ŒæŸäº›æ­¥éª¤
```java
public abstract class DocumentProcessor {
    // æ¨¡æ¿æ–¹æ³•
    public final void processDocument() {
        openDocument();
        readContent();
        
        // æ¡ä»¶é’©å­ï¼šæ˜¯å¦éœ€è¦éªŒè¯
        if (needValidation()) {
            validateContent();
        }
        
        processContent();
        saveDocument();
    }
    
    // é’©å­æ–¹æ³•ï¼šé»˜è®¤éœ€è¦éªŒè¯
    protected boolean needValidation() {
        return true;
    }
    
    // å…·ä½“å­ç±»å¯ä»¥é€‰æ‹©è·³è¿‡éªŒè¯
    class SimpleProcessor extends DocumentProcessor {
        @Override
        protected boolean needValidation() {
            return false; // ç®€å•å¤„ç†ï¼Œè·³è¿‡éªŒè¯
        }
    }
}
```

**ğŸ”¸ æ‰©å±•é’©å­**ï¼šåœ¨ç‰¹å®šä½ç½®æ’å…¥é¢å¤–é€»è¾‘
```java
public abstract class EmailSender {
    public final void sendEmail() {
        prepareEmail();
        
        // æ‰©å±•é’©å­ï¼šå‘é€å‰çš„é¢å¤–å¤„ç†
        beforeSend();
        
        doSend();
        
        // æ‰©å±•é’©å­ï¼šå‘é€åçš„é¢å¤–å¤„ç†
        afterSend();
    }
    
    // ç©ºå®ç°çš„é’©å­æ–¹æ³•
    protected void beforeSend() {
        // é»˜è®¤ä»€ä¹ˆéƒ½ä¸åš
    }
    
    protected void afterSend() {
        // é»˜è®¤ä»€ä¹ˆéƒ½ä¸åš
    }
}

// å­ç±»å¯ä»¥é€‰æ‹©æ€§åœ°ä½¿ç”¨é’©å­
class ImportantEmailSender extends EmailSender {
    @Override
    protected void beforeSend() {
        logSendAttempt(); // è®°å½•å‘é€æ—¥å¿—
    }
    
    @Override
    protected void afterSend() {
        sendConfirmation(); // å‘é€ç¡®è®¤é‚®ä»¶
    }
}
```

**ğŸ”¸ å†³ç­–é’©å­**ï¼šè®©å­ç±»å‚ä¸ç®—æ³•å†³ç­–
```java
public abstract class FileBackup {
    public final void backup() {
        List<File> files = scanFiles();
        
        for (File file : files) {
            // å†³ç­–é’©å­ï¼šè®©å­ç±»å†³å®šæ˜¯å¦å¤‡ä»½è¿™ä¸ªæ–‡ä»¶
            if (shouldBackup(file)) {
                backupFile(file);
            }
        }
        
        cleanup();
    }
    
    // å†³ç­–é’©å­ï¼šå­ç±»å†³å®šå¤‡ä»½ç­–ç•¥
    protected abstract boolean shouldBackup(File file);
}
```

### 2.3 é’©å­æ–¹æ³•æœ€ä½³å®è·µ


**âœ… å‘½åè§„èŒƒ**
```java
// æ¡ä»¶é’©å­ï¼šä½¿ç”¨ should/need/can å¼€å¤´
protected boolean shouldValidate() { return true; }
protected boolean needBackup() { return false; }
protected boolean canProcess() { return true; }

// æ‰©å±•é’©å­ï¼šä½¿ç”¨ before/after/on å¼€å¤´
protected void beforeProcess() { }
protected void afterProcess() { }
protected void onError() { }

// å†³ç­–é’©å­ï¼šä½¿ç”¨ choose/select/determine å¼€å¤´
protected String chooseStrategy() { return "default"; }
protected int selectPriority() { return 0; }
```

**âœ… å®ç°å»ºè®®**
```
ğŸ¯ æä¾›åˆç†çš„é»˜è®¤å®ç°
ğŸ¯ ä¿æŒé’©å­æ–¹æ³•ç®€å•
ğŸ¯ åœ¨å…³é”®èŠ‚ç‚¹è®¾ç½®é’©å­
ğŸ¯ é¿å…é’©å­æ–¹æ³•è¿‡å¤š
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**ï¼šé’©å­æ–¹æ³•ä¸èƒ½æ”¹å˜ä¸»æµç¨‹çš„é€»è¾‘ï¼Œåªèƒ½åœ¨ä¸å½±å“æ•´ä½“ç®—æ³•çš„å‰æä¸‹æä¾›æ‰©å±•ã€‚

---

## 3. ğŸ“¤ å‚æ•°ä¼ é€’æœºåˆ¶


### 3.1 å‚æ•°ä¼ é€’çš„æŒ‘æˆ˜


**å®é™…é—®é¢˜**ï¼šæ¨¡æ¿æ–¹æ³•ä¸­çš„å„ä¸ªæ­¥éª¤ç»å¸¸éœ€è¦å…±äº«æ•°æ®ï¼Œä½†æ¯ä¸ªæ–¹æ³•çš„å‚æ•°ä¸èƒ½å¤ªå¤æ‚ã€‚

```
å…¸å‹åœºæ™¯ï¼šæ•°æ®å¤„ç†æµç¨‹
æ­¥éª¤1ï¼šè¯»å–æ•°æ® â†’ äº§ç”ŸåŸå§‹æ•°æ®
æ­¥éª¤2ï¼šéªŒè¯æ•°æ® â†’ éœ€è¦åŸå§‹æ•°æ®ï¼Œäº§ç”ŸéªŒè¯ç»“æœ  
æ­¥éª¤3ï¼šè½¬æ¢æ•°æ® â†’ éœ€è¦åŸå§‹æ•°æ®å’ŒéªŒè¯ç»“æœ
æ­¥éª¤4ï¼šä¿å­˜æ•°æ® â†’ éœ€è¦è½¬æ¢åçš„æ•°æ®

é—®é¢˜ï¼šè¿™äº›æ•°æ®æ€ä¹ˆåœ¨æ­¥éª¤é—´ä¼ é€’ï¼Ÿ
```

### 3.2 å››ç§å‚æ•°ä¼ é€’æ–¹å¼


**ğŸ”¸ æ–¹å¼ä¸€ï¼šå®ä¾‹å˜é‡å­˜å‚¨**
```java
public abstract class DataProcessor {
    // ç”¨å®ä¾‹å˜é‡å­˜å‚¨ä¸­é—´ç»“æœ
    protected String rawData;
    protected boolean isValid;
    protected String processedData;
    
    public final void process() {
        rawData = readData();           // æ­¥éª¤1ï¼šè¯»å–
        isValid = validateData(rawData); // æ­¥éª¤2ï¼šéªŒè¯
        
        if (isValid) {
            processedData = transformData(rawData); // æ­¥éª¤3ï¼šè½¬æ¢
            saveData(processedData);                // æ­¥éª¤4ï¼šä¿å­˜
        }
    }
    
    protected abstract String readData();
    protected abstract boolean validateData(String data);
    protected abstract String transformData(String data);
    protected abstract void saveData(String data);
}
```

**ğŸ”¸ æ–¹å¼äºŒï¼šä¸Šä¸‹æ–‡å¯¹è±¡ä¼ é€’**
```java
// åˆ›å»ºä¸Šä¸‹æ–‡å¯¹è±¡å°è£…æ‰€æœ‰æ•°æ®
public class ProcessContext {
    private String rawData;
    private boolean isValid;
    private String processedData;
    private Map<String, Object> extras = new HashMap<>();
    
    // getterå’Œsetteræ–¹æ³•...
}

public abstract class DataProcessor {
    public final void process() {
        ProcessContext context = new ProcessContext();
        
        readData(context);      // è¯»å–æ•°æ®åˆ°ä¸Šä¸‹æ–‡
        validateData(context);  // éªŒè¯ä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®
        transformData(context); // è½¬æ¢ä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®
        saveData(context);      // ä¿å­˜ä¸Šä¸‹æ–‡ä¸­çš„æ•°æ®
    }
    
    protected abstract void readData(ProcessContext context);
    protected abstract void validateData(ProcessContext context);
    protected abstract void transformData(ProcessContext context);
    protected abstract void saveData(ProcessContext context);
}
```

**ğŸ”¸ æ–¹å¼ä¸‰ï¼šè¿”å›å€¼é“¾å¼ä¼ é€’**
```java
public abstract class SimpleProcessor {
    public final void process() {
        String data = readData();
        data = validateAndClean(data);
        data = transform(data);
        save(data);
    }
    
    protected abstract String readData();
    protected abstract String validateAndClean(String data);
    protected abstract String transform(String data);
    protected abstract void save(String data);
}
```

**ğŸ”¸ æ–¹å¼å››ï¼šå»ºé€ è€…æ¨¡å¼ç»“åˆ**
```java
public abstract class ConfigurableProcessor {
    protected ProcessConfig config;
    
    public final void process(ProcessConfig config) {
        this.config = config;
        
        String data = readData();
        if (config.needValidation()) {
            data = validateData(data);
        }
        if (config.needTransform()) {
            data = transformData(data);
        }
        saveData(data);
    }
}
```

### 3.3 é€‰æ‹©å‚æ•°ä¼ é€’æ–¹å¼çš„æŒ‡å¯¼


| åœºæ™¯ç‰¹ç‚¹ | **æ¨èæ–¹å¼** | **ç†ç”±** |
|---------|-------------|----------|
| ğŸ”¸ **æ•°æ®é‡å°‘** | `è¿”å›å€¼é“¾å¼ä¼ é€’` | `ç®€å•ç›´æ¥ï¼Œæ˜“ç†è§£` |
| ğŸ”¸ **æ•°æ®é‡å¤š** | `ä¸Šä¸‹æ–‡å¯¹è±¡` | `å°è£…æ€§å¥½ï¼Œæ‰©å±•æ–¹ä¾¿` |
| ğŸ”¸ **çŠ¶æ€å¤æ‚** | `å®ä¾‹å˜é‡` | `è®¿é—®æ–¹ä¾¿ï¼Œæ€§èƒ½å¥½` |
| ğŸ”¸ **é…ç½®é©±åŠ¨** | `å»ºé€ è€…æ¨¡å¼` | `çµæ´»é…ç½®ï¼Œå¯å¤ç”¨` |

> ğŸ’¡ **é€‰æ‹©æŠ€å·§**ï¼šä¼˜å…ˆè€ƒè™‘ä»£ç çš„å¯è¯»æ€§å’Œç»´æŠ¤æ€§ï¼Œæ€§èƒ½å…¶æ¬¡ã€‚ç®€å•åœºæ™¯ç”¨ç®€å•æ–¹æ³•ï¼Œå¤æ‚åœºæ™¯ç”¨å¤æ‚æ–¹æ¡ˆã€‚

---

## 4. âš ï¸ å¼‚å¸¸å¤„ç†ç­–ç•¥


### 4.1 æ¨¡æ¿æ–¹æ³•ä¸­çš„å¼‚å¸¸æŒ‘æˆ˜


**æ ¸å¿ƒé—®é¢˜**ï¼šæ¨¡æ¿æ–¹æ³•åŒ…å«å¤šä¸ªæ­¥éª¤ï¼Œä»»ä½•ä¸€æ­¥å‡ºé”™éƒ½å¯èƒ½å½±å“æ•´ä¸ªæµç¨‹ã€‚

```
æ•°æ®å¤„ç†æµç¨‹å¼‚å¸¸ç‚¹ï¼š
è¯»å–æ•°æ® â†’ [å¯èƒ½ï¼šæ–‡ä»¶ä¸å­˜åœ¨]
éªŒè¯æ•°æ® â†’ [å¯èƒ½ï¼šæ•°æ®æ ¼å¼é”™è¯¯]  
è½¬æ¢æ•°æ® â†’ [å¯èƒ½ï¼šè½¬æ¢è§„åˆ™å¼‚å¸¸]
ä¿å­˜æ•°æ® â†’ [å¯èƒ½ï¼šç£ç›˜ç©ºé—´ä¸è¶³]

é—®é¢˜ï¼šå¼‚å¸¸åœ¨å“ªé‡Œå¤„ç†ï¼Ÿæ€ä¹ˆä¿è¯æµç¨‹çš„å®Œæ•´æ€§ï¼Ÿ
```

### 4.2 ä¸‰å±‚å¼‚å¸¸å¤„ç†ç­–ç•¥


**ğŸ”¸ ç¬¬ä¸€å±‚ï¼šæ¨¡æ¿æ–¹æ³•ç»Ÿä¸€å¤„ç†**
```java
public abstract class SafeDataProcessor {
    public final ProcessResult process() {
        try {
            doProcess();
            return ProcessResult.success();
        } catch (ValidationException e) {
            logger.error("æ•°æ®éªŒè¯å¤±è´¥", e);
            return ProcessResult.failure("æ•°æ®æ ¼å¼ä¸æ­£ç¡®");
        } catch (TransformException e) {
            logger.error("æ•°æ®è½¬æ¢å¤±è´¥", e);
            return ProcessResult.failure("æ•°æ®è½¬æ¢å‡ºé”™");
        } catch (Exception e) {
            logger.error("å¤„ç†è¿‡ç¨‹å‘ç”ŸæœªçŸ¥é”™è¯¯", e);
            return ProcessResult.failure("ç³»ç»Ÿå†…éƒ¨é”™è¯¯");
        }
    }
    
    private void doProcess() throws Exception {
        String data = readData();
        data = validateData(data);
        data = transformData(data);
        saveData(data);
    }
}
```

**ğŸ”¸ ç¬¬äºŒå±‚ï¼šé’©å­æ–¹æ³•å¤„ç†ç‰¹å®šå¼‚å¸¸**
```java
public abstract class FlexibleProcessor {
    public final void process() {
        try {
            doProcess();
        } catch (Exception e) {
            // é’©å­æ–¹æ³•ï¼šè®©å­ç±»å†³å®šå¦‚ä½•å¤„ç†å¼‚å¸¸
            if (!handleException(e)) {
                throw new RuntimeException("å¤„ç†å¤±è´¥", e);
            }
        }
    }
    
    // é’©å­æ–¹æ³•ï¼šå¼‚å¸¸å¤„ç†ç­–ç•¥
    protected boolean handleException(Exception e) {
        // é»˜è®¤ä¸å¤„ç†ï¼Œç”±å­ç±»å†³å®š
        return false;
    }
}

// å­ç±»å®ç°å…·ä½“çš„å¼‚å¸¸å¤„ç†ç­–ç•¥
class RetryProcessor extends FlexibleProcessor {
    private int retryCount = 0;
    
    @Override
    protected boolean handleException(Exception e) {
        if (retryCount < 3) {
            retryCount++;
            logger.info("ç¬¬{}æ¬¡é‡è¯•", retryCount);
            try {
                Thread.sleep(1000); // ç­‰å¾…1ç§’åé‡è¯•
                process(); // é‡æ–°æ‰§è¡Œ
                return true;
            } catch (Exception ex) {
                return false;
            }
        }
        return false;
    }
}
```

**ğŸ”¸ ç¬¬ä¸‰å±‚ï¼šæ­¥éª¤çº§å¼‚å¸¸å¤„ç†**
```java
public abstract class RobustProcessor {
    public final void process() {
        ProcessContext context = new ProcessContext();
        
        // æ¯ä¸ªæ­¥éª¤éƒ½æœ‰ç‹¬ç«‹çš„å¼‚å¸¸å¤„ç†
        if (!executeStep("è¯»å–æ•°æ®", () -> readData(context))) {
            return;
        }
        
        if (!executeStep("éªŒè¯æ•°æ®", () -> validateData(context))) {
            return;
        }
        
        if (!executeStep("è½¬æ¢æ•°æ®", () -> transformData(context))) {
            return;
        }
        
        executeStep("ä¿å­˜æ•°æ®", () -> saveData(context));
    }
    
    private boolean executeStep(String stepName, Runnable step) {
        try {
            step.run();
            logger.info("{}æ‰§è¡ŒæˆåŠŸ", stepName);
            return true;
        } catch (Exception e) {
            logger.error("{}æ‰§è¡Œå¤±è´¥: {}", stepName, e.getMessage());
            return onStepFailed(stepName, e);
        }
    }
    
    // é’©å­æ–¹æ³•ï¼šæ­¥éª¤å¤±è´¥æ—¶çš„å¤„ç†ç­–ç•¥
    protected boolean onStepFailed(String stepName, Exception e) {
        return false; // é»˜è®¤å¤±è´¥å°±åœæ­¢
    }
}
```

### 4.3 å¼‚å¸¸å¤„ç†æœ€ä½³å®è·µ


**âœ… å¼‚å¸¸åˆ†ç±»å¤„ç†**
```java
// ä¸šåŠ¡å¼‚å¸¸ï¼šé¢„æœŸå†…çš„é”™è¯¯ï¼Œå¯ä»¥ä¼˜é›…å¤„ç†
class BusinessException extends Exception {
    public BusinessException(String message) {
        super(message);
    }
}

// ç³»ç»Ÿå¼‚å¸¸ï¼šæ„å¤–é”™è¯¯ï¼Œéœ€è¦è®°å½•æ—¥å¿—
class SystemException extends RuntimeException {
    public SystemException(String message, Throwable cause) {
        super(message, cause);
    }
}
```

**âœ… æ¸…ç†èµ„æºçš„æŠ€å·§**
```java
public abstract class ResourceSafeProcessor {
    public final void process() {
        Resource resource = null;
        try {
            resource = acquireResource();
            doProcess(resource);
        } catch (Exception e) {
            handleException(e);
        } finally {
            if (resource != null) {
                releaseResource(resource);
            }
        }
    }
    
    protected abstract Resource acquireResource();
    protected abstract void doProcess(Resource resource);
    protected abstract void releaseResource(Resource resource);
}
```

> âš ï¸ **é‡è¦æé†’**ï¼šå¼‚å¸¸å¤„ç†ä¸æ˜¯ä¸ºäº†éšè—é”™è¯¯ï¼Œè€Œæ˜¯ä¸ºäº†è®©ç¨‹åºåœ¨å‡ºé”™æ—¶èƒ½å¤Ÿä¼˜é›…åœ°å¤„ç†ï¼Œç»™ç”¨æˆ·åˆç†çš„åé¦ˆã€‚

---

## 5. ğŸ”§ æ‰©å±•ç‚¹è®¾è®¡


### 5.1 ä»€ä¹ˆæ˜¯æ‰©å±•ç‚¹


**é€šä¿—è§£é‡Š**ï¼šæ‰©å±•ç‚¹å°±åƒæ˜¯"é¢„ç•™çš„æ’åº§"ï¼Œä½ å¯ä»¥åœ¨è¿™äº›åœ°æ–¹"æ’å…¥"è‡ªå·±çš„åŠŸèƒ½ï¼Œä½†ä¸å½±å“åŸæ¥çš„ç”µè·¯ã€‚

```
åŸå§‹æµç¨‹ï¼šA â†’ B â†’ C â†’ D
åŠ æ‰©å±•ç‚¹ï¼šA â†’ [æ‰©å±•1] â†’ B â†’ [æ‰©å±•2] â†’ C â†’ [æ‰©å±•3] â†’ D

æ‰©å±•ç‚¹çš„ä½œç”¨ï¼š
âœ… åœ¨ä¸ä¿®æ”¹åŸæµç¨‹çš„æƒ…å†µä¸‹å¢åŠ åŠŸèƒ½
âœ… è®©ä¸åŒçš„ä¸šåŠ¡åœºæ™¯å¯ä»¥æœ‰ä¸åŒçš„å¤„ç†æ–¹å¼
âœ… ä¿æŒä»£ç çš„å¼€æ”¾æ€§å’Œçµæ´»æ€§
```

### 5.2 äº”ç§æ‰©å±•ç‚¹è®¾è®¡æ¨¡å¼


**ğŸ”¸ é’©å­æ‰©å±•ç‚¹**ï¼šæœ€ç®€å•çš„æ‰©å±•æ–¹å¼
```java
public abstract class BasicProcessor {
    public final void process() {
        beforeProcess();  // æ‰©å±•ç‚¹1ï¼šå¤„ç†å‰
        doProcess();
        afterProcess();   // æ‰©å±•ç‚¹2ï¼šå¤„ç†å
    }
    
    protected void beforeProcess() { } // é»˜è®¤ç©ºå®ç°
    protected void afterProcess() { }  // é»˜è®¤ç©ºå®ç°
    protected abstract void doProcess();
}
```

**ğŸ”¸ ç­–ç•¥æ‰©å±•ç‚¹**ï¼šå¯æ’æ‹”çš„ç®—æ³•
```java
public abstract class ConfigurableProcessor {
    // ç­–ç•¥æ‰©å±•ç‚¹ï¼šå¯ä»¥æ›¿æ¢ä¸åŒçš„å¤„ç†ç­–ç•¥
    protected ProcessStrategy strategy = getDefaultStrategy();
    
    public final void process(String data) {
        String result = strategy.process(data);
        saveResult(result);
    }
    
    // æ‰©å±•ç‚¹ï¼šå­ç±»å¯ä»¥æä¾›ä¸åŒçš„ç­–ç•¥
    protected abstract ProcessStrategy getDefaultStrategy();
    
    // æ‰©å±•ç‚¹ï¼šè¿è¡Œæ—¶åˆ‡æ¢ç­–ç•¥
    public void setStrategy(ProcessStrategy strategy) {
        this.strategy = strategy;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
class SmartProcessor extends ConfigurableProcessor {
    @Override
    protected ProcessStrategy getDefaultStrategy() {
        return new FastProcessStrategy(); // é»˜è®¤ä½¿ç”¨å¿«é€Ÿç­–ç•¥
    }
    
    public void switchToAccurateMode() {
        setStrategy(new AccurateProcessStrategy()); // åˆ‡æ¢åˆ°ç²¾ç¡®ç­–ç•¥
    }
}
```

**ğŸ”¸ å·¥å‚æ‰©å±•ç‚¹**ï¼šåˆ›å»ºå¯¹è±¡çš„æ‰©å±•
```java
public abstract class FlexibleProcessor {
    public final void process() {
        // å·¥å‚æ‰©å±•ç‚¹ï¼šåˆ›å»ºä¸åŒç±»å‹çš„å¤„ç†å™¨
        DataHandler handler = createHandler();
        Validator validator = createValidator();
        
        String data = readData();
        if (validator.validate(data)) {
            handler.handle(data);
        }
    }
    
    // æ‰©å±•ç‚¹ï¼šå­ç±»å†³å®šåˆ›å»ºä»€ä¹ˆç±»å‹çš„å¤„ç†å™¨
    protected abstract DataHandler createHandler();
    protected abstract Validator createValidator();
}
```

**ğŸ”¸ è§‚å¯Ÿè€…æ‰©å±•ç‚¹**ï¼šäº‹ä»¶é€šçŸ¥æœºåˆ¶
```java
public abstract class EventDrivenProcessor {
    private List<ProcessListener> listeners = new ArrayList<>();
    
    public void addListener(ProcessListener listener) {
        listeners.add(listener);
    }
    
    public final void process() {
        notifyStart();
        
        try {
            doProcess();
            notifySuccess();
        } catch (Exception e) {
            notifyError(e);
        }
    }
    
    // æ‰©å±•ç‚¹ï¼šé€šçŸ¥æ‰€æœ‰ç›‘å¬å™¨
    private void notifyStart() {
        listeners.forEach(listener -> listener.onProcessStart());
    }
    
    private void notifySuccess() {
        listeners.forEach(listener -> listener.onProcessSuccess());
    }
    
    private void notifyError(Exception e) {
        listeners.forEach(listener -> listener.onProcessError(e));
    }
}
```

**ğŸ”¸ è£…é¥°å™¨æ‰©å±•ç‚¹**ï¼šåŠŸèƒ½å¢å¼ºæœºåˆ¶
```java
// åŸºç¡€å¤„ç†å™¨æ¥å£
interface Processor {
    void process(String data);
}

// æ¨¡æ¿æ–¹æ³•åŸºç±»
public abstract class BaseProcessor implements Processor {
    public final void process(String data) {
        String prepared = prepareData(data);
        String processed = doProcess(prepared);
        saveResult(processed);
    }
    
    protected abstract String prepareData(String data);
    protected abstract String doProcess(String data);
    protected abstract void saveResult(String result);
}

// è£…é¥°å™¨æ‰©å±•ç‚¹ï¼šå¯ä»¥å±‚å±‚åŒ…è£…å¢åŠ åŠŸèƒ½
class LoggingProcessor implements Processor {
    private Processor wrapped;
    
    public LoggingProcessor(Processor wrapped) {
        this.wrapped = wrapped;
    }
    
    @Override
    public void process(String data) {
        System.out.println("å¼€å§‹å¤„ç†: " + data);
        wrapped.process(data);
        System.out.println("å¤„ç†å®Œæˆ");
    }
}

class TimingProcessor implements Processor {
    private Processor wrapped;
    
    public TimingProcessor(Processor wrapped) {
        this.wrapped = wrapped;
    }
    
    @Override
    public void process(String data) {
        long start = System.currentTimeMillis();
        wrapped.process(data);
        long end = System.currentTimeMillis();
        System.out.println("å¤„ç†è€—æ—¶: " + (end - start) + "ms");
    }
}
```

### 5.3 æ‰©å±•ç‚¹è®¾è®¡åŸåˆ™


**ğŸ“‹ è®¾è®¡æ£€æŸ¥è¡¨**

| è®¾è®¡è€ƒè™‘ | **è®¾è®¡è¦ç‚¹** | **å®ç°å»ºè®®** |
|---------|-------------|-------------|
| ğŸ¯ **ä½ç½®é€‰æ‹©** | `åœ¨å…³é”®ä¸šåŠ¡èŠ‚ç‚¹è®¾ç½®æ‰©å±•ç‚¹` | `æµç¨‹å¼€å§‹ã€ç»“æŸã€å¼‚å¸¸å¤„ç†å¤„` |
| ğŸ”§ **ç²’åº¦æ§åˆ¶** | `æ‰©å±•ç‚¹ä¸å®œè¿‡å¤šè¿‡ç»†` | `ä¸€ä¸ªæ‰©å±•ç‚¹è§£å†³ä¸€ç±»é—®é¢˜` |
| ğŸ“ **æ¥å£è®¾è®¡** | `æ‰©å±•æ¥å£è¦ç®€å•æ˜ç¡®` | `å‚æ•°æ¸…æ™°ï¼ŒèŒè´£å•ä¸€` |
| ğŸ”„ **å‘åå…¼å®¹** | `æ–°å¢æ‰©å±•ç‚¹ä¸å½±å“æ—§ä»£ç ` | `æä¾›é»˜è®¤å®ç°` |

**âœ… æ‰©å±•ç‚¹å‘½åè§„èŒƒ**
```java
// äº‹ä»¶ç±»æ‰©å±•ç‚¹
protected void onDataLoaded() { }
protected void onValidationFailed() { }
protected void onProcessComplete() { }

// ç­–ç•¥ç±»æ‰©å±•ç‚¹  
protected Strategy chooseStrategy() { }
protected Validator createValidator() { }
protected Handler buildHandler() { }

// é…ç½®ç±»æ‰©å±•ç‚¹
protected boolean enableCache() { return true; }
protected int getRetryCount() { return 3; }
protected long getTimeout() { return 5000; }
```

---

## 6. ğŸ“Š å®æˆ˜åº”ç”¨æ€»ç»“


### 6.1 æ¨¡æ¿æ–¹æ³•æ¨¡å¼é€‚ç”¨åœºæ™¯


**âœ… æœ€é€‚åˆçš„åœºæ™¯**
```
ğŸ¯ ç®—æ³•æ­¥éª¤å›ºå®šï¼Œä½†å…·ä½“å®ç°ä¸åŒ
   ä¾‹å¦‚ï¼šæ–‡ä»¶å¤„ç†ï¼ˆè¯»å–â†’è§£æâ†’è½¬æ¢â†’ä¿å­˜ï¼‰
   
ğŸ¯ éœ€è¦æ§åˆ¶å­ç±»çš„æ‰©å±•ç‚¹
   ä¾‹å¦‚ï¼šæ¡†æ¶å¼€å‘ï¼Œæä¾›æ‰©å±•ä½†æ§åˆ¶æ ¸å¿ƒæµç¨‹
   
ğŸ¯ ä»£ç å¤ç”¨åº¦é«˜çš„åœºæ™¯
   ä¾‹å¦‚ï¼šæ•°æ®å¯¼å…¥å¯¼å‡ºï¼ŒæŠ¥è¡¨ç”Ÿæˆ
```

**âŒ ä¸é€‚åˆçš„åœºæ™¯**
```
ğŸš« ç®—æ³•æµç¨‹ç»å¸¸å˜åŒ–
ğŸš« æ­¥éª¤ä¹‹é—´æ²¡æœ‰å›ºå®šé¡ºåº
ğŸš« æ¯ä¸ªå­ç±»çš„æµç¨‹å®Œå…¨ä¸åŒ
```

### 6.2 å®ç°è´¨é‡è¯„ä¼°æ ‡å‡†


**ğŸ” ä»£ç è´¨é‡æ£€æŸ¥**

| æ£€æŸ¥é¡¹ | **ä¼˜ç§€æ ‡å‡†** | **æ”¹è¿›å»ºè®®** |
|-------|-------------|-------------|
| ğŸ“ **æµç¨‹æ¸…æ™°** | `ä¸€çœ¼èƒ½çœ‹æ‡‚å¤„ç†æ­¥éª¤` | `æ–¹æ³•åè¦è§åçŸ¥æ„` |
| ğŸ”§ **æ‰©å±•çµæ´»** | `æ–°éœ€æ±‚é€šè¿‡å­ç±»æ»¡è¶³` | `åˆç†è®¾ç½®æ‰©å±•ç‚¹` |
| ğŸ›¡ï¸ **å¼‚å¸¸å¤„ç†** | `å„å±‚å¼‚å¸¸éƒ½æœ‰åº”å¯¹` | `æä¾›å¼‚å¸¸æ¢å¤æœºåˆ¶` |
| ğŸ“Š **æ€§èƒ½è€ƒè™‘** | `é¿å…ä¸å¿…è¦çš„å¯¹è±¡åˆ›å»º` | `åˆç†é€‰æ‹©å‚æ•°ä¼ é€’æ–¹å¼` |

### 6.3 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


**ğŸ”¸ é—®é¢˜1ï¼šå­ç±»è¿‡åº¦ä¾èµ–çˆ¶ç±»å®ç°**
```java
// âŒ é”™è¯¯ç¤ºä¾‹ï¼šå­ç±»ç›´æ¥è®¿é—®çˆ¶ç±»å®ç°ç»†èŠ‚
class BadChild extends Template {
    @Override
    protected void doStep() {
        // ç›´æ¥è®¿é—®çˆ¶ç±»çš„ç§æœ‰é€»è¾‘ï¼Œè€¦åˆä¸¥é‡
        super.internalMethod(); 
    }
}

// âœ… æ­£ç¡®ç¤ºä¾‹ï¼šé€šè¿‡å—ä¿æŠ¤çš„æ¥å£äº¤äº’
class GoodChild extends Template {
    @Override
    protected void doStep() {
        // é€šè¿‡è®¾è®¡å¥½çš„æ‰©å±•ç‚¹äº¤äº’
        String data = getSharedData();
        processMyWay(data);
    }
}
```

**ğŸ”¸ é—®é¢˜2ï¼šæ¨¡æ¿æ–¹æ³•è¿‡äºå¤æ‚**
```java
// âŒ é”™è¯¯ç¤ºä¾‹ï¼šä¸€ä¸ªæ–¹æ³•åŒ…å«å¤ªå¤šæ­¥éª¤
public final void complexProcess() {
    step1(); step2(); step3(); step4(); step5();
    step6(); step7(); step8(); step9(); step10();
}

// âœ… æ­£ç¡®ç¤ºä¾‹ï¼šåˆ†ç»„ç»„ç»‡ï¼Œå±‚æ¬¡æ¸…æ™°
public final void clearProcess() {
    preparePhase();   // å‡†å¤‡é˜¶æ®µ
    processPhase();   // å¤„ç†é˜¶æ®µ  
    finishPhase();    // å®Œæˆé˜¶æ®µ
}

private void preparePhase() {
    step1(); step2(); step3();
}
```

**ğŸ”¸ é—®é¢˜3ï¼šæ‰©å±•ç‚¹è®¾è®¡ä¸åˆç†**
```java
// âŒ é”™è¯¯ç¤ºä¾‹ï¼šæ‰©å±•ç‚¹å¤ªç»†ï¼Œå¯¼è‡´å­ç±»éœ€è¦å®ç°å¾ˆå¤šæ–¹æ³•
protected abstract void validateField1();
protected abstract void validateField2();
protected abstract void validateField3();
// ... æ›´å¤šå­—æ®µéªŒè¯æ–¹æ³•

// âœ… æ­£ç¡®ç¤ºä¾‹ï¼šåˆç†ç²’åº¦çš„æ‰©å±•ç‚¹
protected abstract ValidationResult validateData(DataObject data);
```

### 6.4 æœ€ä½³å®è·µæ€»ç»“


**ğŸ“ å¼€å‘å»ºè®®**
```
ğŸ’¡ å…ˆå®ç°ä¸€ä¸ªå…·ä½“åœºæ™¯ï¼Œå†æŠ½è±¡æˆæ¨¡æ¿
ğŸ’¡ æ‰©å±•ç‚¹ä¸è¦è®¾è®¡å¾—è¿‡äºæå‰ï¼ŒæŒ‰éœ€æ·»åŠ 
ğŸ’¡ æ¨¡æ¿æ–¹æ³•è¦æœ‰æ¸…æ™°çš„æ–‡æ¡£è¯´æ˜ä½¿ç”¨æ–¹å¼
ğŸ’¡ ä¸ºå¸¸è§çš„å­ç±»å®ç°æä¾›ç¤ºä¾‹ä»£ç 
ğŸ’¡ è€ƒè™‘æä¾›ä¸€äº›ä¾¿åˆ©çš„å·¥å…·æ–¹æ³•
```

**ğŸ¯ æ ¸å¿ƒè¦ç‚¹è®°å¿†**
- **æ¨¡æ¿æ–¹æ³•**ï¼šå®šä¹‰ç®—æ³•éª¨æ¶ï¼Œæ§åˆ¶æ‰§è¡Œæµç¨‹
- **é’©å­æ–¹æ³•**ï¼šæä¾›æ‰©å±•ç‚¹ï¼Œä½†ä¸å¼ºåˆ¶å®ç°
- **å‚æ•°ä¼ é€’**ï¼šæ ¹æ®å¤æ‚åº¦é€‰æ‹©åˆé€‚çš„æ–¹å¼
- **å¼‚å¸¸å¤„ç†**ï¼šåˆ†å±‚å¤„ç†ï¼Œä¼˜é›…é™çº§
- **æ‰©å±•ç‚¹**ï¼šåœ¨å…³é”®èŠ‚ç‚¹æä¾›å¯æ’æ‹”çš„åŠŸèƒ½

> ğŸš€ **å®æˆ˜å¿ƒå¾—**ï¼šæ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ç²¾é«“åœ¨äº"æ§åˆ¶ä¸­æœ‰çµæ´»ï¼Œçµæ´»ä¸­æœ‰æ§åˆ¶"ã€‚æ—¢è¦ä¿è¯æ ¸å¿ƒæµç¨‹çš„ç¨³å®šæ€§ï¼Œåˆè¦ç»™å­ç±»è¶³å¤Ÿçš„æ‰©å±•ç©ºé—´ã€‚