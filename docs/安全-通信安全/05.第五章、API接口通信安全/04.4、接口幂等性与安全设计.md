---
title: 4ã€æ¥å£å¹‚ç­‰æ€§ä¸å®‰å…¨è®¾è®¡
---
## ğŸ“š ç›®å½•

1. [æ¥å£å¹‚ç­‰æ€§åŸºæœ¬æ¦‚å¿µ](#1-æ¥å£å¹‚ç­‰æ€§åŸºæœ¬æ¦‚å¿µ)
2. [å¹‚ç­‰æ€§å®ç°æ–¹æ³•](#2-å¹‚ç­‰æ€§å®ç°æ–¹æ³•)
3. [å¹‚ç­‰Tokenæœºåˆ¶](#3-å¹‚ç­‰Tokenæœºåˆ¶)
4. [é™æµç®—æ³•å®ç°](#4-é™æµç®—æ³•å®ç°)
5. [é™æµç»´åº¦è®¾è®¡](#5-é™æµç»´åº¦è®¾è®¡)
6. [åˆ†å¸ƒå¼é™æµå®ç°](#6-åˆ†å¸ƒå¼é™æµå®ç°)
7. [æ¥å£é˜²åˆ·ç­–ç•¥](#7-æ¥å£é˜²åˆ·ç­–ç•¥)
8. [DDoSé˜²æŠ¤ä½“ç³»](#8-DDoSé˜²æŠ¤ä½“ç³»)
9. [é™æµä¸­é—´ä»¶éƒ¨ç½²](#9-é™æµä¸­é—´ä»¶éƒ¨ç½²)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”„ æ¥å£å¹‚ç­‰æ€§åŸºæœ¬æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯å¹‚ç­‰æ€§


**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
å¹‚ç­‰æ€§ï¼šå¤šæ¬¡æ‰§è¡ŒåŒä¸€ä¸ªæ“ä½œï¼Œç»“æœéƒ½æ˜¯ä¸€æ ·çš„
æ•°å­¦ä¾‹å­ï¼šf(f(x)) = f(x)ï¼Œæ¯”å¦‚å¼€ç¯å¼€å…³ï¼ŒæŒ‰ä¸€æ¬¡å¼€ç¯ï¼Œå†æŒ‰è¿˜æ˜¯å¼€ç¯çŠ¶æ€

æ¥å£å¹‚ç­‰æ€§ï¼šåŒä¸€ä¸ªæ¥å£è¢«é‡å¤è°ƒç”¨ï¼Œç³»ç»ŸçŠ¶æ€å’Œæ•°æ®ç»“æœä¿æŒä¸€è‡´
```

**ğŸ’¡ é€šä¿—ç†è§£**
```
ç”Ÿæ´»åœºæ™¯ç±»æ¯”ï¼š
Ã— ä¹°ä¸œè¥¿ï¼šä¹°ä¸€æ¬¡èŠ±10å…ƒï¼Œä¹°ä¸¤æ¬¡èŠ±20å…ƒ â†’ ä¸æ˜¯å¹‚ç­‰çš„
âœ“ å¼€é—¨ï¼šå¼€ä¸€æ¬¡é—¨æ˜¯å¼€ç€ï¼Œå¼€ä¸¤æ¬¡é—¨è¿˜æ˜¯å¼€ç€ â†’ è¿™å°±æ˜¯å¹‚ç­‰çš„

æ¥å£åœºæ™¯ï¼š
Ã— ä½™é¢å……å€¼ï¼šå……å€¼100å…ƒä¸€æ¬¡ä½™é¢+100ï¼Œå……å€¼ä¸¤æ¬¡ä½™é¢+200 â†’ ä¸å¹‚ç­‰
âœ“ è®¾ç½®å¯†ç ï¼šè®¾ç½®å¯†ç ä¸º123456ï¼Œé‡å¤è®¾ç½®è¿˜æ˜¯123456 â†’ å¹‚ç­‰
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦å¹‚ç­‰æ€§


**ğŸš¨ ç°å®é—®é¢˜åœºæ™¯**
```
åœºæ™¯1: ç½‘ç»œé‡è¯•
ç”¨æˆ·ç‚¹å‡»æ”¯ä»˜æŒ‰é’® â†’ ç½‘ç»œè¶…æ—¶ â†’ ç”¨æˆ·å†æ¬¡ç‚¹å‡» â†’ é‡å¤æ‰£æ¬¾

åœºæ™¯2: ç³»ç»Ÿå¼‚å¸¸
è®¢å•æäº¤ä¸­æ–­ â†’ ç”¨æˆ·åˆ·æ–°é¡µé¢é‡è¯• â†’ äº§ç”Ÿé‡å¤è®¢å•

åœºæ™¯3: å‰ç«¯é‡å¤è¯·æ±‚
ç”¨æˆ·å¿«é€Ÿè¿ç»­ç‚¹å‡»æäº¤æŒ‰é’® â†’ åŒæ—¶å‘é€å¤šä¸ªç›¸åŒè¯·æ±‚
```

**âš¡ å¹‚ç­‰æ€§çš„ä»·å€¼**
- **æ•°æ®å®‰å…¨**ï¼šé˜²æ­¢é‡å¤æ“ä½œé€ æˆæ•°æ®é”™è¯¯
- **ç”¨æˆ·ä½“éªŒ**ï¼šç”¨æˆ·å¯ä»¥å®‰å¿ƒé‡è¯•ï¼Œä¸ç”¨æ‹…å¿ƒå‰¯ä½œç”¨
- **ç³»ç»Ÿç¨³å®š**ï¼šé¿å…å› é‡å¤æ“ä½œå¯¼è‡´çš„ç³»ç»Ÿå¼‚å¸¸

### 1.3 HTTPæ–¹æ³•çš„å¤©ç„¶å¹‚ç­‰æ€§


**ğŸ“Š HTTPæ–¹æ³•å¹‚ç­‰æ€§åˆ†æ**
```
å¤©ç„¶å¹‚ç­‰çš„æ–¹æ³•ï¼š
GET    â†’ æŸ¥è¯¢æ“ä½œï¼Œå¤šæ¬¡æŸ¥è¯¢ç»“æœä¸€æ · âœ“
PUT    â†’ æ›´æ–°æ“ä½œï¼Œè¦†ç›–å¼æ›´æ–°ï¼Œç»“æœä¸€æ · âœ“  
DELETE â†’ åˆ é™¤æ“ä½œï¼Œåˆ é™¤ä¸€æ¬¡å’Œåˆ é™¤å¤šæ¬¡æ•ˆæœä¸€æ · âœ“

éå¹‚ç­‰çš„æ–¹æ³•ï¼š
POST   â†’ åˆ›å»ºæ“ä½œï¼Œæ¯æ¬¡åˆ›å»ºæ–°èµ„æº âœ—
PATCH  â†’ éƒ¨åˆ†æ›´æ–°ï¼Œå¯èƒ½ç´¯åŠ æ•ˆæœ âœ—
```

**ğŸ’­ å®é™…åœºæ™¯ä¸¾ä¾‹**
```
å¹‚ç­‰åœºæ™¯ï¼š
PUT /user/123 {"name": "å¼ ä¸‰", "age": 25}
â†’ æ— è®ºè°ƒç”¨å‡ æ¬¡ï¼Œç”¨æˆ·123çš„ä¿¡æ¯éƒ½æ˜¯å¼ ä¸‰ï¼Œ25å²

éå¹‚ç­‰åœºæ™¯ï¼š
POST /orders {"product": "æ‰‹æœº", "price": 2000}
â†’ æ¯æ¬¡è°ƒç”¨éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°è®¢å•
```

---

## 2. ğŸ› ï¸ å¹‚ç­‰æ€§å®ç°æ–¹æ³•


### 2.1 å¹‚ç­‰Tokenæ–¹æ¡ˆ


**ğŸ”‘ åŸºæœ¬æ€è·¯**
```
å·¥ä½œæµç¨‹ï¼š
1. å®¢æˆ·ç«¯å…ˆè¯·æ±‚è·å–å¹‚ç­‰Token
2. å®¢æˆ·ç«¯å¸¦ç€Tokenè°ƒç”¨ä¸šåŠ¡æ¥å£
3. æœåŠ¡ç«¯éªŒè¯Tokençš„å”¯ä¸€æ€§å’Œæœ‰æ•ˆæ€§
4. æ‰§è¡Œä¸šåŠ¡é€»è¾‘ååˆ é™¤æˆ–æ ‡è®°Tokenå·²ä½¿ç”¨
```

**ğŸ’» ç®€å•å®ç°ç¤ºä¾‹**
```java
// è·å–å¹‚ç­‰Token
@GetMapping("/idempotent/token")
public String getIdempotentToken() {
    String token = UUID.randomUUID().toString();
    // å­˜å‚¨åˆ°Redisï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´
    redisTemplate.setex("idempotent:" + token, 300, "unused");
    return token;
}

// ä¸šåŠ¡æ¥å£ä½¿ç”¨Token
@PostMapping("/orders")
public String createOrder(@RequestHeader("Idempotent-Token") String token, 
                         @RequestBody OrderRequest request) {
    // éªŒè¯Token
    String key = "idempotent:" + token;
    String status = redisTemplate.get(key);
    
    if (status == null) {
        throw new RuntimeException("Tokenä¸å­˜åœ¨æˆ–å·²è¿‡æœŸ");
    }
    if ("used".equals(status)) {
        throw new RuntimeException("è¯·å‹¿é‡å¤æäº¤");
    }
    
    // æ ‡è®°Tokenä¸ºå·²ä½¿ç”¨
    redisTemplate.set(key, "used");
    
    // æ‰§è¡Œä¸šåŠ¡é€»è¾‘
    return orderService.createOrder(request);
}
```

### 2.2 å”¯ä¸€ä¸šåŠ¡å·æ–¹æ¡ˆ


**ğŸ·ï¸ æ ¸å¿ƒæ€æƒ³**
```
åˆ©ç”¨ä¸šåŠ¡æœ¬èº«çš„å”¯ä¸€æ ‡è¯†æ¥ä¿è¯å¹‚ç­‰æ€§
æ¯”å¦‚ï¼šè®¢å•å·ã€æµæ°´å·ã€ç”¨æˆ·ID+æ“ä½œç±»å‹ç­‰
```

**ğŸ“ å®ç°æ–¹å¼**
```java
@PostMapping("/payment")
public String processPayment(@RequestBody PaymentRequest request) {
    String businessKey = request.getUserId() + ":" + request.getOrderId();
    
    // æ£€æŸ¥æ˜¯å¦å·²å¤„ç†è¿‡
    if (paymentService.isProcessed(businessKey)) {
        return paymentService.getResult(businessKey);
    }
    
    // æ‰§è¡Œæ”¯ä»˜é€»è¾‘
    String result = paymentService.doPayment(request);
    
    // è®°å½•å¤„ç†ç»“æœ
    paymentService.saveResult(businessKey, result);
    return result;
}
```

### 2.3 çŠ¶æ€æœºæ§åˆ¶æ–¹æ¡ˆ


**âš™ï¸ çŠ¶æ€æœºæ€ç»´**
```
è®¢å•çŠ¶æ€æµè½¬ï¼š
å¾…æ”¯ä»˜ â†’ æ”¯ä»˜ä¸­ â†’ å·²æ”¯ä»˜ â†’ å·²å‘è´§ â†’ å·²å®Œæˆ

å¹‚ç­‰æ§åˆ¶ï¼š
- åªæœ‰åœ¨"å¾…æ”¯ä»˜"çŠ¶æ€æ‰èƒ½æ‰§è¡Œæ”¯ä»˜æ“ä½œ
- é‡å¤æ”¯ä»˜è¯·æ±‚ä¼šå› ä¸ºçŠ¶æ€ä¸ç¬¦åˆè€Œè¢«æ‹’ç»
```

**ğŸ”„ æ•°æ®åº“å®ç°**
```sql
-- è®¢å•è¡¨è®¾è®¡
CREATE TABLE orders (
    id BIGINT PRIMARY KEY,
    status VARCHAR(20) NOT NULL, -- å¾…æ”¯ä»˜ã€å·²æ”¯ä»˜ç­‰
    version INT DEFAULT 0,       -- ä¹è§‚é”ç‰ˆæœ¬å·
    update_time TIMESTAMP
);

-- æ›´æ–°æ—¶æ£€æŸ¥çŠ¶æ€å’Œç‰ˆæœ¬
UPDATE orders 
SET status = 'å·²æ”¯ä»˜', version = version + 1 
WHERE id = ? AND status = 'å¾…æ”¯ä»˜' AND version = ?;
```

---

## 3. ğŸ« å¹‚ç­‰Tokenæœºåˆ¶


### 3.1 Tokenç”Ÿæˆç­–ç•¥


**ğŸ” Tokenç‰¹æ€§è¦æ±‚**
```
å”¯ä¸€æ€§ï¼šç¡®ä¿Tokenä¸ä¼šé‡å¤
éšæœºæ€§ï¼šé˜²æ­¢è¢«æ¶æ„é¢„æµ‹
æ—¶æ•ˆæ€§ï¼šè®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´
æ˜“éªŒè¯ï¼šæœåŠ¡ç«¯èƒ½å¿«é€ŸéªŒè¯æœ‰æ•ˆæ€§
```

**âš¡ ç”Ÿæˆç®—æ³•é€‰æ‹©**
```java
// æ–¹æ¡ˆ1ï¼šUUIDï¼ˆæ¨èï¼‰
String token = UUID.randomUUID().toString().replace("-", "");

// æ–¹æ¡ˆ2ï¼šé›ªèŠ±ç®—æ³• + éšæœºæ•°
String token = snowflakeId + "_" + RandomStringUtils.randomAlphanumeric(8);

// æ–¹æ¡ˆ3ï¼šæ—¶é—´æˆ³ + éšæœºæ•° + ç”¨æˆ·IDçš„MD5
String raw = System.currentTimeMillis() + "_" + random + "_" + userId;
String token = DigestUtils.md5Hex(raw);
```

### 3.2 Tokenå­˜å‚¨ä¸ç®¡ç†


**ğŸ’¾ å­˜å‚¨æ–¹æ¡ˆå¯¹æ¯”**
```
Rediså­˜å‚¨ï¼ˆæ¨èï¼‰ï¼š
âœ“ æ”¯æŒè¿‡æœŸæ—¶é—´ï¼Œè‡ªåŠ¨æ¸…ç†
âœ“ é«˜æ€§èƒ½ï¼Œé€‚åˆé«˜å¹¶å‘
âœ“ æ”¯æŒåŸå­æ“ä½œ
Ã— éœ€è¦é¢å¤–çš„Redisèµ„æº

å†…å­˜å­˜å‚¨ï¼š
âœ“ æ€§èƒ½æœ€é«˜ï¼Œæ— ç½‘ç»œå¼€é”€
Ã— æœåŠ¡é‡å¯æ•°æ®ä¸¢å¤±
Ã— æ— æ³•æ”¯æŒåˆ†å¸ƒå¼

æ•°æ®åº“å­˜å‚¨ï¼š
âœ“ æ•°æ®æŒä¹…åŒ–ï¼Œä¸ä¸¢å¤±
Ã— æ€§èƒ½ç›¸å¯¹è¾ƒä½
Ã— éœ€è¦å®šæ—¶æ¸…ç†è¿‡æœŸæ•°æ®
```

### 3.3 TokenéªŒè¯æµç¨‹


**ğŸ” éªŒè¯æ­¥éª¤è®¾è®¡**
```
1. æ£€æŸ¥Tokenæ ¼å¼æ˜¯å¦æ­£ç¡®
2. éªŒè¯Tokenæ˜¯å¦å­˜åœ¨ï¼ˆé˜²æ­¢ä¼ªé€ ï¼‰
3. æ£€æŸ¥Tokenæ˜¯å¦å·²è¢«ä½¿ç”¨ï¼ˆé˜²æ­¢é‡å¤ï¼‰
4. éªŒè¯Tokenæ˜¯å¦åœ¨æœ‰æ•ˆæœŸå†…
5. æ ‡è®°Tokenä¸ºå·²ä½¿ç”¨çŠ¶æ€
```

**ğŸš€ é«˜å¹¶å‘åœºæ™¯å¤„ç†**
```java
// ä½¿ç”¨Redisçš„åŸå­æ“ä½œé˜²æ­¢å¹¶å‘é—®é¢˜
public boolean checkAndUseToken(String token) {
    String script = 
        "if redis.call('get', KEYS[1]) == 'unused' then " +
        "  redis.call('set', KEYS[1], 'used') " +
        "  return 1 " +
        "else " +
        "  return 0 " +
        "end";
    
    Long result = redisTemplate.execute(
        RedisScript.of(script, Long.class), 
        Collections.singletonList("idempotent:" + token)
    );
    
    return result != null && result == 1;
}
```

---

## 4. â±ï¸ é™æµç®—æ³•å®ç°


### 4.1 å›ºå®šçª—å£é™æµ


**ğŸ“Š åŸºæœ¬åŸç†**
```
æ—¶é—´çª—å£æ¦‚å¿µï¼š
æŠŠæ—¶é—´åˆ†æˆå›ºå®šçš„çª—å£ï¼Œæ¯”å¦‚æ¯åˆ†é’Ÿä¸€ä¸ªçª—å£
åœ¨æ¯ä¸ªçª—å£å†…é™åˆ¶è¯·æ±‚æ•°é‡ï¼Œæ¯”å¦‚æ¯åˆ†é’Ÿæœ€å¤š100æ¬¡è¯·æ±‚

æ—¶é—´è½´ç¤ºä¾‹ï¼š
[00:00-01:00] [01:00-02:00] [02:00-03:00]
    50æ¬¡         100æ¬¡         30æ¬¡
    âœ“å…è®¸        Ã—æ‹’ç»         âœ“å…è®¸
```

**ğŸ’» ç®€å•å®ç°**
```java
public class FixedWindowLimiter {
    private final Map<String, WindowData> windows = new ConcurrentHashMap<>();
    private final int limit;      // é™åˆ¶æ¬¡æ•°
    private final int windowSize; // çª—å£å¤§å°ï¼ˆç§’ï¼‰
    
    public boolean tryAcquire(String key) {
        long currentWindow = System.currentTimeMillis() / (windowSize * 1000);
        WindowData window = windows.computeIfAbsent(key, k -> new WindowData());
        
        if (window.windowStart != currentWindow) {
            // æ–°çª—å£ï¼Œé‡ç½®è®¡æ•°
            window.windowStart = currentWindow;
            window.count = 0;
        }
        
        if (window.count < limit) {
            window.count++;
            return true; // å…è®¸é€šè¿‡
        }
        
        return false; // æ‹’ç»è¯·æ±‚
    }
    
    static class WindowData {
        long windowStart;
        int count;
    }
}
```

### 4.2 æ»‘åŠ¨çª—å£é™æµ


**ğŸŒŠ æ”¹è¿›æ€è·¯**
```
å›ºå®šçª—å£çš„é—®é¢˜ï¼š
æ—¶é—´è¾¹ç•Œçªåˆºé—®é¢˜ï¼Œæ¯”å¦‚ï¼š
[00:59] 100æ¬¡è¯·æ±‚ + [01:01] 100æ¬¡è¯·æ±‚ = 2ç§’å†…200æ¬¡è¯·æ±‚

æ»‘åŠ¨çª—å£è§£å†³ï¼š
ä¸æŒ‰æ•´ç‚¹åˆ’åˆ†ï¼Œè€Œæ˜¯ä»¥å½“å‰æ—¶é—´ä¸ºåŸºå‡†ï¼Œå‘å‰æ¨ç®—ä¸€ä¸ªæ—¶é—´çª—å£
æ¯”å¦‚ï¼šå½“å‰æ—¶é—´å¾€å‰1åˆ†é’Ÿå†…çš„è¯·æ±‚æ•°é‡
```

**âš¡ å®ç°æ€è·¯**
```java
public class SlidingWindowLimiter {
    private final Map<String, Queue<Long>> requestTimes = new ConcurrentHashMap<>();
    private final int limit;
    private final long windowSizeMs;
    
    public boolean tryAcquire(String key) {
        long currentTime = System.currentTimeMillis();
        Queue<Long> times = requestTimes.computeIfAbsent(key, k -> new LinkedList<>());
        
        // æ¸…ç†è¿‡æœŸçš„è¯·æ±‚æ—¶é—´
        while (!times.isEmpty() && currentTime - times.peek() > windowSizeMs) {
            times.poll();
        }
        
        if (times.size() < limit) {
            times.offer(currentTime);
            return true;
        }
        
        return false;
    }
}
```

### 4.3 æ¼æ¡¶ç®—æ³•


**ğŸª£ æ¼æ¡¶æ¯”å–»**
```
æƒ³è±¡ä¸€ä¸ªæœ‰æ´çš„æ¡¶ï¼š
- æ°´ï¼ˆè¯·æ±‚ï¼‰ä»¥ä»»æ„é€Ÿåº¦å€’å…¥æ¡¶ä¸­
- æ°´ä»¥å›ºå®šé€Ÿåº¦ä»æ¡¶åº•æ¼å‡ºï¼ˆåŒ€é€Ÿå¤„ç†ï¼‰
- æ¡¶æ»¡äº†å°±æº¢å‡ºï¼ˆæ‹’ç»è¯·æ±‚ï¼‰

ç‰¹ç‚¹ï¼š
âœ“ æµé‡æ•´å½¢ï¼šè¾“å‡ºé€Ÿåº¦æ’å®š
âœ“ å‰Šå³°å¡«è°·ï¼šç¼“å†²çªå‘æµé‡
Ã— æ— æ³•åº”å¯¹çªå‘éœ€æ±‚
```

**ğŸ’§ å®ç°ç¤ºä¾‹**
```java
public class LeakyBucketLimiter {
    private long capacity;        // æ¡¶å®¹é‡
    private long currentWater;    // å½“å‰æ°´é‡
    private long leakRate;        // æ¼æ°´é€Ÿç‡ï¼ˆæ¯ç§’ï¼‰
    private long lastLeakTime;    // ä¸Šæ¬¡æ¼æ°´æ—¶é—´
    
    public synchronized boolean tryAcquire() {
        // å…ˆæ¼æ°´
        long currentTime = System.currentTimeMillis();
        long elapsedTime = currentTime - lastLeakTime;
        long leakedWater = elapsedTime * leakRate / 1000;
        
        currentWater = Math.max(0, currentWater - leakedWater);
        lastLeakTime = currentTime;
        
        // åˆ¤æ–­æ˜¯å¦è¿˜èƒ½åŠ æ°´
        if (currentWater < capacity) {
            currentWater++;
            return true;
        }
        
        return false;
    }
}
```

### 4.4 ä»¤ç‰Œæ¡¶ç®—æ³•


**ğŸ« ä»¤ç‰Œæ¡¶æ€æƒ³**
```
ä»¤ç‰Œæ¡¶å·¥ä½œåŸç†ï¼š
- ç³»ç»Ÿä»¥å›ºå®šé€Ÿåº¦å¾€æ¡¶é‡Œæ”¾ä»¤ç‰Œ
- æ¡¶æœ‰æœ€å¤§å®¹é‡é™åˆ¶
- è¯·æ±‚éœ€è¦æ¶ˆè€—ä»¤ç‰Œæ‰èƒ½é€šè¿‡
- æ²¡æœ‰ä»¤ç‰Œå°±æ‹’ç»è¯·æ±‚

ä¼˜åŠ¿ï¼š
âœ“ å…è®¸çªå‘æµé‡ï¼ˆæ¡¶é‡Œæœ‰ç§¯ç´¯çš„ä»¤ç‰Œï¼‰
âœ“ é•¿æœŸå¹³å‡é€Ÿç‡å¯æ§
âœ“ æ›´çµæ´»çš„æµé‡æ§åˆ¶
```

**ğŸ”§ æ ¸å¿ƒå®ç°**
```java
public class TokenBucketLimiter {
    private long capacity;          // æ¡¶å®¹é‡
    private long tokens;           // å½“å‰ä»¤ç‰Œæ•°
    private long refillRate;       // ä»¤ç‰Œç”Ÿæˆé€Ÿç‡ï¼ˆæ¯ç§’ï¼‰
    private long lastRefillTime;   // ä¸Šæ¬¡å¡«å……æ—¶é—´
    
    public synchronized boolean tryAcquire() {
        refillTokens();
        
        if (tokens > 0) {
            tokens--;
            return true;
        }
        
        return false;
    }
    
    private void refillTokens() {
        long currentTime = System.currentTimeMillis();
        long elapsedTime = currentTime - lastRefillTime;
        long newTokens = elapsedTime * refillRate / 1000;
        
        tokens = Math.min(capacity, tokens + newTokens);
        lastRefillTime = currentTime;
    }
}
```

---

## 5. ğŸ¯ é™æµç»´åº¦è®¾è®¡


### 5.1 IPé™æµ


**ğŸŒ åŸºæœ¬æ€è·¯**
```
æ ¹æ®å®¢æˆ·ç«¯IPåœ°å€è¿›è¡Œé™æµ
åœºæ™¯ï¼šé˜²æ­¢å•ä¸ªIPæ¶æ„æ”»å‡»
å®ç°ï¼šä»¥IPä¸ºkeyï¼Œç»Ÿè®¡è¯·æ±‚é¢‘ç‡
```

**ğŸ”§ å®ç°è¦ç‚¹**
```java
@Component
public class IpRateLimiter {
    private final RedisTemplate<String, String> redisTemplate;
    
    public boolean tryAcquire(String ip, int limit, int windowSeconds) {
        String key = "rate_limit:ip:" + ip;
        String script = 
            "local current = redis.call('INCR', KEYS[1]) " +
            "if current == 1 then " +
            "  redis.call('EXPIRE', KEYS[1], ARGV[1]) " +
            "end " +
            "return current";
        
        Long current = redisTemplate.execute(
            RedisScript.of(script, Long.class),
            Collections.singletonList(key),
            String.valueOf(windowSeconds)
        );
        
        return current != null && current <= limit;
    }
}
```

### 5.2 ç”¨æˆ·é™æµ


**ğŸ‘¤ ç”¨æˆ·ç»´åº¦é™æµ**
```
åŸºäºç”¨æˆ·IDè¿›è¡Œé™æµ
åœºæ™¯ï¼šé˜²æ­¢å•ä¸ªç”¨æˆ·è¿‡åº¦ä½¿ç”¨èµ„æº
è€ƒè™‘å› ç´ ï¼š
- ä¸åŒç”¨æˆ·ç­‰çº§ä¸åŒé™åˆ¶
- VIPç”¨æˆ·æ›´é«˜çš„è®¿é—®é¢‘ç‡
- æ–°ç”¨æˆ·æ›´ä¸¥æ ¼çš„é™åˆ¶
```

**ğŸ“Š åˆ†çº§é™æµè®¾è®¡**
```java
public enum UserLevel {
    NORMAL(100),    // æ™®é€šç”¨æˆ·æ¯åˆ†é’Ÿ100æ¬¡
    VIP(500),       // VIPç”¨æˆ·æ¯åˆ†é’Ÿ500æ¬¡
    PREMIUM(1000);  // é«˜çº§ç”¨æˆ·æ¯åˆ†é’Ÿ1000æ¬¡
    
    private final int limitPerMinute;
    
    public int getLimit() { return limitPerMinute; }
}

public boolean checkUserLimit(Long userId) {
    UserLevel level = userService.getUserLevel(userId);
    String key = "rate_limit:user:" + userId;
    return rateLimiter.tryAcquire(key, level.getLimit(), 60);
}
```

### 5.3 æ¥å£é™æµ


**ğŸ”Œ æ¥å£çº§åˆ«æ§åˆ¶**
```
é’ˆå¯¹ä¸åŒæ¥å£è®¾ç½®ä¸åŒçš„é™æµç­–ç•¥
è€ƒè™‘å› ç´ ï¼š
- æ¥å£é‡è¦ç¨‹åº¦ï¼ˆæ ¸å¿ƒæ¥å£ vs æ™®é€šæ¥å£ï¼‰
- æ¥å£æ¶ˆè€—èµ„æºï¼ˆæŸ¥è¯¢æ¥å£ vs è®¡ç®—æ¥å£ï¼‰
- ä¸šåŠ¡å½±å“ç¨‹åº¦ï¼ˆæ”¯ä»˜æ¥å£ vs æ—¥å¿—æ¥å£ï¼‰
```

**âš™ï¸ é…ç½®åŒ–å®ç°**
```java
@RestController
public class ApiController {
    
    @RateLimit(limit = 1000, window = 60) // æ¯åˆ†é’Ÿ1000æ¬¡
    @GetMapping("/products")
    public List<Product> getProducts() {
        return productService.findAll();
    }
    
    @RateLimit(limit = 10, window = 60)   // æ¯åˆ†é’Ÿ10æ¬¡
    @PostMapping("/orders")
    public Order createOrder(@RequestBody Order order) {
        return orderService.create(order);
    }
}

// æ³¨è§£å¤„ç†å™¨
@Aspect
public class RateLimitAspect {
    @Around("@annotation(rateLimit)")
    public Object around(ProceedingJoinPoint point, RateLimit rateLimit) {
        String key = "api:" + point.getSignature().getName();
        
        if (!rateLimiter.tryAcquire(key, rateLimit.limit(), rateLimit.window())) {
            throw new RuntimeException("æ¥å£è®¿é—®é¢‘ç‡è¶…é™");
        }
        
        return point.proceed();
    }
}
```

### 5.4 å…¨å±€é™æµ


**ğŸŒ å…¨å±€æµé‡æ§åˆ¶**
```
æ§åˆ¶æ•´ä¸ªç³»ç»Ÿçš„æ€»ä½“æµé‡
åœºæ™¯ï¼š
- ç³»ç»Ÿå®¹é‡ä¿æŠ¤
- æˆæœ¬æ§åˆ¶ï¼ˆäº‘æœåŠ¡è®¡è´¹ï¼‰
- ä¸‹æ¸¸ç³»ç»Ÿä¿æŠ¤
```

### 5.5 åˆ†çº§é™æµ


**ğŸ“ˆ å¤šå±‚é™æµè®¾è®¡**
```
é™æµå±‚æ¬¡è®¾è®¡ï¼š
1. å…¨å±€é™æµï¼šä¿æŠ¤ç³»ç»Ÿæ•´ä½“ç¨³å®š
2. æ¥å£é™æµï¼šä¿æŠ¤å•ä¸ªæ¥å£ä¸è¢«æ‰“å®
3. ç”¨æˆ·é™æµï¼šé˜²æ­¢å•ç”¨æˆ·æ»¥ç”¨
4. IPé™æµï¼šåŸºç¡€å®‰å…¨é˜²æŠ¤

é™æµä¼˜å…ˆçº§ï¼š
å…¨å±€é™æµ â†’ æ¥å£é™æµ â†’ ç”¨æˆ·é™æµ â†’ IPé™æµ
ä»»ä¸€å±‚é™æµè§¦å‘éƒ½ä¼šæ‹’ç»è¯·æ±‚
```

```
        è¯·æ±‚æµå…¥
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  å…¨å±€é™æµ    â”‚ â† æ¯ç§’10000æ¬¡
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  æ¥å£é™æµ    â”‚ â† ç™»å½•æ¥å£æ¯ç§’100æ¬¡
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  ç”¨æˆ·é™æµ    â”‚ â† å•ç”¨æˆ·æ¯åˆ†é’Ÿ10æ¬¡
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   IPé™æµ    â”‚ â† å•IPæ¯åˆ†é’Ÿ50æ¬¡
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
       ä¸šåŠ¡å¤„ç†
```

---

## 6. ğŸŒ åˆ†å¸ƒå¼é™æµå®ç°


### 6.1 Redisé›†ä¸­å¼é™æµ


**ğŸ¯ åŸºæœ¬æ€è·¯**
```
æ‰€æœ‰æœåŠ¡èŠ‚ç‚¹å…±äº«åŒä¸€ä¸ªRedisä½œä¸ºé™æµæ•°æ®å­˜å‚¨
ä¼˜ç‚¹ï¼šæ•°æ®ä¸€è‡´æ€§å¥½ï¼Œé™æµç²¾ç¡®
ç¼ºç‚¹ï¼šä¾èµ–Redisï¼Œæœ‰ç½‘ç»œå»¶è¿Ÿ
```

**ğŸ’¾ Redisé™æµè„šæœ¬**
```lua
-- Redis Luaè„šæœ¬å®ç°åŸå­æ€§é™æµ
local key = KEYS[1]           -- é™æµkey
local limit = tonumber(ARGV[1])  -- é™åˆ¶æ•°é‡
local window = tonumber(ARGV[2]) -- æ—¶é—´çª—å£

-- è·å–å½“å‰è®¡æ•°
local current = redis.call('GET', key)
if current == false then
    current = 0
else
    current = tonumber(current)
end

-- æ£€æŸ¥æ˜¯å¦è¶…é™
if current < limit then
    -- å¢åŠ è®¡æ•°
    local result = redis.call('INCR', key)
    if result == 1 then
        -- ç¬¬ä¸€æ¬¡è®¾ç½®ï¼Œæ·»åŠ è¿‡æœŸæ—¶é—´
        redis.call('EXPIRE', key, window)
    end
    return 1  -- å…è®¸é€šè¿‡
else
    return 0  -- æ‹’ç»è¯·æ±‚
end
```

**ğŸ”§ Javaå®¢æˆ·ç«¯è°ƒç”¨**
```java
@Service
public class RedisRateLimiter {
    private final RedisTemplate<String, String> redisTemplate;
    private final RedisScript<Long> limitScript;
    
    public boolean tryAcquire(String key, int limit, int windowSeconds) {
        Long result = redisTemplate.execute(
            limitScript,
            Collections.singletonList(key),
            String.valueOf(limit),
            String.valueOf(windowSeconds)
        );
        
        return result != null && result == 1;
    }
}
```

### 6.2 æœ¬åœ°+åˆ†å¸ƒå¼æ··åˆæ–¹æ¡ˆ


**âš¡ æ··åˆæ¶æ„æ€è·¯**
```
è®¾è®¡æ€æƒ³ï¼š
1. æœ¬åœ°é™æµï¼šå¿«é€Ÿæ‹¦æˆªæ˜æ˜¾è¶…é™çš„è¯·æ±‚
2. åˆ†å¸ƒå¼é™æµï¼šç²¾ç¡®æ§åˆ¶æ€»ä½“æµé‡

ä¸¤çº§é™æµï¼š
æœ¬åœ°é™æµé˜ˆå€¼ = æ€»é™æµ / èŠ‚ç‚¹æ•° * 1.2  ï¼ˆé¢„ç•™ç¼“å†²ï¼‰
åˆ†å¸ƒå¼é™æµ = ç²¾ç¡®çš„æ€»ä½“é™åˆ¶
```

**ğŸ—ï¸ å®ç°æ¶æ„**
```java
@Component
public class HybridRateLimiter {
    private final LocalRateLimiter localLimiter;    // æœ¬åœ°é™æµå™¨
    private final RedisRateLimiter redisLimiter;    // Redisé™æµå™¨
    
    public boolean tryAcquire(String key, int globalLimit) {
        // ç¬¬ä¸€å±‚ï¼šæœ¬åœ°å¿«é€Ÿæ£€æŸ¥
        int localLimit = globalLimit / getNodeCount() * 120 / 100; // 120%å®¹é‡
        if (!localLimiter.tryAcquire(key, localLimit)) {
            return false; // æœ¬åœ°é™æµæ‹¦æˆª
        }
        
        // ç¬¬äºŒå±‚ï¼šåˆ†å¸ƒå¼ç²¾ç¡®é™æµ
        return redisLimiter.tryAcquire(key, globalLimit);
    }
}
```

### 6.3 é›†ç¾¤åè°ƒæ–¹æ¡ˆ


**ğŸ¤ èŠ‚ç‚¹é—´åè°ƒ**
```
åè°ƒæœºåˆ¶ï¼š
1. é…é¢åˆ†é…ï¼šæ€»é™æµé‡æŒ‰èŠ‚ç‚¹æ•°åŠ¨æ€åˆ†é…
2. å®šæ—¶åŒæ­¥ï¼šå„èŠ‚ç‚¹å®šæœŸä¸ŠæŠ¥å’Œè·å–æµé‡æƒ…å†µ
3. åŠ¨æ€è°ƒæ•´ï¼šæ ¹æ®å®é™…æµé‡åŠ¨æ€è°ƒæ•´å„èŠ‚ç‚¹é…é¢
```

### 6.4 ä¸€è‡´æ€§ä¿éšœ


**ğŸ”’ æ•°æ®ä¸€è‡´æ€§è€ƒè™‘**
```
æŒ‘æˆ˜ï¼š
- ç½‘ç»œåˆ†åŒºæ—¶çš„é™æµç­–ç•¥
- Redisæ•…éšœæ—¶çš„é™çº§æ–¹æ¡ˆ
- æ—¶é’Ÿä¸ä¸€è‡´çš„å¤„ç†

è§£å†³æ–¹æ¡ˆï¼š
1. æ•…éšœé™çº§ï¼šRedisä¸å¯ç”¨æ—¶åˆ‡æ¢åˆ°æœ¬åœ°é™æµ
2. å…œåº•ç­–ç•¥ï¼šè®¾ç½®ä¿åº•çš„æœ¬åœ°é™æµé˜ˆå€¼
3. æ—¶é—´åŒæ­¥ï¼šä½¿ç”¨NTPä¿è¯å„èŠ‚ç‚¹æ—¶é—´ä¸€è‡´
```

```java
public class FaultTolerantRateLimiter {
    public boolean tryAcquire(String key, int limit) {
        try {
            // ä¼˜å…ˆä½¿ç”¨Redisåˆ†å¸ƒå¼é™æµ
            return redisLimiter.tryAcquire(key, limit);
        } catch (Exception e) {
            // Redisæ•…éšœï¼Œé™çº§åˆ°æœ¬åœ°é™æµ
            log.warn("Redisé™æµå¤±è´¥ï¼Œé™çº§åˆ°æœ¬åœ°é™æµ", e);
            return localLimiter.tryAcquire(key, limit / nodeCount);
        }
    }
}
```

---

## 7. ğŸ›¡ï¸ æ¥å£é˜²åˆ·ç­–ç•¥


### 7.1 éªŒè¯ç æœºåˆ¶


**ğŸ” äººæœºéªŒè¯**
```
è§¦å‘æ¡ä»¶ï¼š
- çŸ­æ—¶é—´å†…é¢‘ç¹è¯·æ±‚
- å¼‚å¸¸è¡Œä¸ºæ¨¡å¼æ£€æµ‹
- æ•æ„Ÿæ“ä½œä¿æŠ¤

éªŒè¯ç ç±»å‹ï¼š
- å›¾å½¢éªŒè¯ç ï¼šç®€å•æ˜“å®ç°
- æ»‘åŠ¨éªŒè¯ï¼šç”¨æˆ·ä½“éªŒå¥½
- çŸ­ä¿¡éªŒè¯ç ï¼šå¼ºå®‰å…¨æ€§
- è¡Œä¸ºéªŒè¯ï¼šæ™ºèƒ½åˆ¤æ–­
```

**ğŸ“± å®ç°ç¤ºä¾‹**
```java
@Service
public class CaptchaService {
    
    // æ£€æŸ¥æ˜¯å¦éœ€è¦éªŒè¯ç 
    public boolean needCaptcha(String identifier) {
        String key = "captcha_required:" + identifier;
        String count = redisTemplate.opsForValue().get(key);
        
        // 5åˆ†é’Ÿå†…å¤±è´¥3æ¬¡å°±éœ€è¦éªŒè¯ç 
        return count != null && Integer.parseInt(count) >= 3;
    }
    
    // è®°å½•å¤±è´¥æ¬¡æ•°
    public void recordFailure(String identifier) {
        String key = "captcha_required:" + identifier;
        redisTemplate.opsForValue().increment(key);
        redisTemplate.expire(key, 300, TimeUnit.SECONDS); // 5åˆ†é’Ÿè¿‡æœŸ
    }
    
    // éªŒè¯æˆåŠŸæ¸…é™¤è®°å½•
    public void clearFailureRecord(String identifier) {
        redisTemplate.delete("captcha_required:" + identifier);
    }
}
```

### 7.2 è®¾å¤‡æŒ‡çº¹è¯†åˆ«


**ğŸ–±ï¸ è®¾å¤‡ç‰¹å¾è¯†åˆ«**
```
æ”¶é›†çš„è®¾å¤‡ä¿¡æ¯ï¼š
- æµè§ˆå™¨ç±»å‹å’Œç‰ˆæœ¬
- æ“ä½œç³»ç»Ÿä¿¡æ¯
- å±å¹•åˆ†è¾¨ç‡
- æ—¶åŒºè®¾ç½®
- è¯­è¨€è®¾ç½®
- å­—ä½“åˆ—è¡¨
- CanvasæŒ‡çº¹
```

**ğŸ” å¼‚å¸¸è®¾å¤‡æ£€æµ‹**
```javascript
// å‰ç«¯è®¾å¤‡æŒ‡çº¹æ”¶é›†
function generateDeviceFingerprint() {
    const fingerprint = {
        userAgent: navigator.userAgent,
        language: navigator.language,
        platform: navigator.platform,
        screenResolution: screen.width + 'x' + screen.height,
        timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
        // CanvasæŒ‡çº¹
        canvas: getCanvasFingerprint()
    };
    
    return btoa(JSON.stringify(fingerprint));
}

// åç«¯éªŒè¯
@PostMapping("/login")
public String login(@RequestHeader("Device-Fingerprint") String fingerprint,
                   @RequestBody LoginRequest request) {
    
    if (deviceService.isBlacklisted(fingerprint)) {
        throw new SecurityException("è®¾å¤‡å·²è¢«å°ç¦");
    }
    
    if (deviceService.isSuspicious(fingerprint, request.getUsername())) {
        // è¦æ±‚é¢å¤–éªŒè¯
        return "NEED_ADDITIONAL_VERIFICATION";
    }
    
    return authService.login(request);
}
```

### 7.3 è¡Œä¸ºåˆ†æ


**ğŸ“Š ç”¨æˆ·è¡Œä¸ºæ¨¡å¼**
```
æ­£å¸¸ç”¨æˆ·è¡Œä¸ºç‰¹å¾ï¼š
- æ“ä½œé—´éš”æœ‰éšæœºæ€§
- é¼ æ ‡ç§»åŠ¨è½¨è¿¹è‡ªç„¶
- é¡µé¢åœç•™æ—¶é—´åˆç†
- æ“ä½œé¡ºåºç¬¦åˆé€»è¾‘

æœºå™¨è¡Œä¸ºç‰¹å¾ï¼š
- æ“ä½œé—´éš”è¿‡äºè§„å¾‹
- æ²¡æœ‰é¼ æ ‡ç§»åŠ¨è½¨è¿¹
- é¡µé¢åœç•™æ—¶é—´æçŸ­
- æ“ä½œé¡ºåºæœºæ¢°åŒ–
```

**ğŸ¤– è¡Œä¸ºè¯„åˆ†ç®—æ³•**
```java
@Component
public class BehaviorAnalyzer {
    
    public int calculateRiskScore(UserBehavior behavior) {
        int score = 0;
        
        // æ£€æŸ¥æ“ä½œé—´éš”
        if (isRegularInterval(behavior.getActionIntervals())) {
            score += 30; // è§„å¾‹æ€§æ“ä½œåŠ åˆ†
        }
        
        // æ£€æŸ¥æ“ä½œé€Ÿåº¦
        if (behavior.getAvgActionTime() < 100) {
            score += 25; // æ“ä½œè¿‡å¿«åŠ åˆ†
        }
        
        // æ£€æŸ¥é¡µé¢åœç•™æ—¶é—´
        if (behavior.getPageStayTime() < 2000) {
            score += 20; // åœç•™æ—¶é—´è¿‡çŸ­åŠ åˆ†
        }
        
        // æ£€æŸ¥å¤±è´¥ç‡
        if (behavior.getFailureRate() > 0.8) {
            score += 25; // å¤±è´¥ç‡è¿‡é«˜åŠ åˆ†
        }
        
        return score; // åˆ†æ•°è¶Šé«˜é£é™©è¶Šå¤§
    }
}
```

### 7.4 é£æ§æ¨¡å‹


**ğŸ¯ å¤šç»´åº¦é£æ§**
```
é£æ§ç»´åº¦ï¼š
1. è®¾å¤‡ç»´åº¦ï¼šè®¾å¤‡æŒ‡çº¹ã€IPåœ°å€ã€åœ°ç†ä½ç½®
2. è¡Œä¸ºç»´åº¦ï¼šæ“ä½œé¢‘ç‡ã€æ—¶é—´æ¨¡å¼ã€å¤±è´¥ç‡
3. ä¸šåŠ¡ç»´åº¦ï¼šè´¦æˆ·ç­‰çº§ã€å†å²è®°å½•ã€å…³è”åˆ†æ
4. æ—¶é—´ç»´åº¦ï¼šè®¿é—®æ—¶æ®µã€æŒç»­æ—¶é—´ã€é—´éš”åˆ†æ
```

**âš–ï¸ é£é™©è¯„åˆ†ä½“ç³»**
```java
@Service
public class RiskControlService {
    
    public RiskLevel evaluateRisk(RequestContext context) {
        int totalScore = 0;
        
        // è®¾å¤‡é£é™©è¯„åˆ† (0-30åˆ†)
        totalScore += deviceRiskAnalyzer.analyze(context.getDeviceInfo());
        
        // è¡Œä¸ºé£é™©è¯„åˆ† (0-40åˆ†)  
        totalScore += behaviorRiskAnalyzer.analyze(context.getBehavior());
        
        // IPé£é™©è¯„åˆ† (0-20åˆ†)
        totalScore += ipRiskAnalyzer.analyze(context.getIpAddress());
        
        // ä¸šåŠ¡é£é™©è¯„åˆ† (0-10åˆ†)
        totalScore += businessRiskAnalyzer.analyze(context.getBusinessData());
        
        // æ ¹æ®æ€»åˆ†åˆ¤æ–­é£é™©ç­‰çº§
        if (totalScore < 20) return RiskLevel.LOW;
        if (totalScore < 50) return RiskLevel.MEDIUM;
        if (totalScore < 80) return RiskLevel.HIGH;
        return RiskLevel.CRITICAL;
    }
}
```

---

## 8. âš”ï¸ DDoSé˜²æŠ¤ä½“ç³»


### 8.1 å…¥å£é˜²æŠ¤


**ğŸšª ç½‘ç»œå±‚é˜²æŠ¤**
```
ç¬¬ä¸€é“é˜²çº¿ï¼šç½‘ç»œè®¾å¤‡å’Œäº‘æœåŠ¡
- ç¡¬ä»¶é˜²ç«å¢™ï¼šè¿‡æ»¤æ¶æ„æµé‡
- CDNæœåŠ¡ï¼šåˆ†æ•£æ”»å‡»æµé‡
- äº‘é˜²æŠ¤ï¼šåˆ©ç”¨äº‘å‚å•†çš„DDoSé˜²æŠ¤èƒ½åŠ›

é˜²æŠ¤ç­–ç•¥ï¼š
- IPé»‘åå•ï¼šå°ç¦æ¶æ„IP
- åœ°ç†ä½ç½®è¿‡æ»¤ï¼šé™åˆ¶ç‰¹å®šåœ°åŒºè®¿é—®  
- åè®®è¿‡æ»¤ï¼šé˜»æ–­å¼‚å¸¸åè®®æµé‡
```

**ğŸŒ©ï¸ äº‘æœåŠ¡é…ç½®ç¤ºä¾‹**
```yaml
# é˜¿é‡Œäº‘DDoSé˜²æŠ¤é…ç½®ç¤ºä¾‹
ddos_protection:
  enabled: true
  clean_threshold: 1000   # æ¸…æ´—é˜ˆå€¼(Mbps)
  black_hole_threshold: 2000  # é»‘æ´é˜ˆå€¼(Mbps)
  
  rules:
    - type: ip_blacklist
      ips: ["192.168.1.100", "10.0.0.50"]
      
    - type: geo_block  
      countries: ["CN"]  # åªå…è®¸ä¸­å›½è®¿é—®
      
    - type: rate_limit
      max_requests_per_second: 10000
```

### 8.2 åº”ç”¨å±‚é˜²æŠ¤


**ğŸ›¡ï¸ Webåº”ç”¨é˜²æŠ¤**
```
Nginxå±‚é˜²æŠ¤ï¼š
- è¿æ¥æ•°é™åˆ¶ï¼šé™åˆ¶å•IPå¹¶å‘è¿æ¥
- è¯·æ±‚é¢‘ç‡é™åˆ¶ï¼šæ§åˆ¶è¯·æ±‚é€Ÿç‡
- è¯·æ±‚å¤§å°é™åˆ¶ï¼šé˜²æ­¢å¤§æ–‡ä»¶æ”»å‡»
- è¿æ¥è¶…æ—¶è®¾ç½®ï¼šå¿«é€Ÿé‡Šæ”¾å¼‚å¸¸è¿æ¥
```

**âš™ï¸ Nginxé…ç½®ç¤ºä¾‹**
```nginx
# é™åˆ¶è¿æ¥æ•°
limit_conn_zone $binary_remote_addr zone=conn_limit_per_ip:10m;
limit_conn conn_limit_per_ip 20;

# é™åˆ¶è¯·æ±‚é¢‘ç‡  
limit_req_zone $binary_remote_addr zone=req_limit_per_ip:10m rate=10r/s;
limit_req zone=req_limit_per_ip burst=20 nodelay;

# é™åˆ¶è¯·æ±‚ä½“å¤§å°
client_max_body_size 1m;

# è¶…æ—¶è®¾ç½®
client_header_timeout 10s;
client_body_timeout 10s;
send_timeout 10s;

# ç¼“å†²åŒºé™åˆ¶
client_header_buffer_size 1k;
large_client_header_buffers 4 4k;
```

### 8.3 ä¸šåŠ¡é€»è¾‘é˜²æŠ¤


**ğŸ§  æ™ºèƒ½é˜²æŠ¤ç­–ç•¥**
```
ä¸šåŠ¡å±‚é˜²æŠ¤æ€è·¯ï¼š
1. å¼‚å¸¸æ£€æµ‹ï¼šè¯†åˆ«éæ­£å¸¸ä¸šåŠ¡è®¿é—®æ¨¡å¼
2. èµ„æºä¿æŠ¤ï¼šä¿æŠ¤æ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½
3. é™çº§æœåŠ¡ï¼šå¿…è¦æ—¶é™çº§éæ ¸å¿ƒåŠŸèƒ½
4. ç†”æ–­æœºåˆ¶ï¼šå¿«é€Ÿåˆ‡æ–­å¼‚å¸¸æµé‡
```

**ğŸ’» ä¸šåŠ¡é˜²æŠ¤å®ç°**
```java
@Component
public class BusinessProtection {
    
    @Autowired
    private CircuitBreaker circuitBreaker;
    
    // æ ¸å¿ƒä¸šåŠ¡ä¿æŠ¤
    public Object protectedBusinessCall(Supplier<Object> businessLogic) {
        // æ£€æŸ¥å½“å‰ç³»ç»Ÿè´Ÿè½½
        if (systemMonitor.getCpuUsage() > 80) {
            throw new ServiceUnavailableException("ç³»ç»Ÿè´Ÿè½½è¿‡é«˜");
        }
        
        // ç†”æ–­ä¿æŠ¤
        return circuitBreaker.executeSupplier(businessLogic);
    }
    
    // éæ ¸å¿ƒåŠŸèƒ½é™çº§
    @HystrixCommand(fallbackMethod = "getStaticRecommendation")
    public List<Product> getRecommendation(Long userId) {
        return recommendationService.getPersonalized(userId);
    }
    
    // é™çº§æ–¹æ³•ï¼šè¿”å›é™æ€æ¨è
    public List<Product> getStaticRecommendation(Long userId) {
        return productService.getHotProducts(); // è¿”å›çƒ­é—¨å•†å“
    }
}
```

### 8.4 ç´§æ€¥ç†”æ–­æœºåˆ¶


**âš¡ è‡ªåŠ¨ç†”æ–­ç­–ç•¥**
```
ç†”æ–­è§¦å‘æ¡ä»¶ï¼š
- é”™è¯¯ç‡è¶…è¿‡é˜ˆå€¼ï¼ˆå¦‚50%ï¼‰
- å“åº”æ—¶é—´è¶…è¿‡é˜ˆå€¼ï¼ˆå¦‚5ç§’ï¼‰
- å¹¶å‘è¯·æ±‚æ•°è¶…è¿‡é˜ˆå€¼
- ç³»ç»Ÿèµ„æºä½¿ç”¨ç‡è¿‡é«˜

ç†”æ–­ç­–ç•¥ï¼š
- å¿«é€Ÿå¤±è´¥ï¼šç«‹å³è¿”å›é”™è¯¯
- æœåŠ¡é™çº§ï¼šè¿”å›å¤‡ç”¨æ•°æ®
- é™æµä¿æŠ¤ï¼šåªå…è®¸å°‘é‡è¯·æ±‚
- æŠ¥è­¦é€šçŸ¥ï¼šåŠæ—¶é€šçŸ¥è¿ç»´äººå‘˜
```

**ğŸ”§ ç†”æ–­å™¨å®ç°**
```java
@Component
public class EmergencyCircuitBreaker {
    private volatile boolean circuitOpen = false;
    private final AtomicInteger failureCount = new AtomicInteger(0);
    private volatile long lastFailureTime = 0;
    
    public <T> T execute(Supplier<T> operation, Supplier<T> fallback) {
        // ç†”æ–­å™¨æ‰“å¼€ï¼Œç›´æ¥é™çº§
        if (circuitOpen) {
            if (shouldTryReset()) {
                // å°è¯•é‡ç½®ç†”æ–­å™¨
                return tryReset(operation, fallback);
            }
            return fallback.get();
        }
        
        try {
            T result = operation.get();
            onSuccess(); // æˆåŠŸæ—¶é‡ç½®å¤±è´¥è®¡æ•°
            return result;
        } catch (Exception e) {
            onFailure(); // å¤±è´¥æ—¶å¢åŠ è®¡æ•°
            return fallback.get();
        }
    }
    
    private void onFailure() {
        failureCount.incrementAndGet();
        lastFailureTime = System.currentTimeMillis();
        
        // å¤±è´¥æ¬¡æ•°è¾¾åˆ°é˜ˆå€¼ï¼Œæ‰“å¼€ç†”æ–­å™¨
        if (failureCount.get() >= 10) {
            circuitOpen = true;
            log.warn("ç†”æ–­å™¨å¼€å¯ï¼Œç³»ç»Ÿè¿›å…¥ä¿æŠ¤æ¨¡å¼");
        }
    }
    
    private boolean shouldTryReset() {
        // ç†”æ–­å™¨æ‰“å¼€60ç§’åå°è¯•é‡ç½®
        return System.currentTimeMillis() - lastFailureTime > 60000;
    }
}
```

---

## 9. ğŸ”§ é™æµä¸­é—´ä»¶éƒ¨ç½²


### 9.1 Nginx Rate Limit


**âš™ï¸ Nginxé™æµæ¨¡å—**
```
Nginxå†…ç½®é™æµæ¨¡å—ï¼š
- limit_req_moduleï¼šè¯·æ±‚é¢‘ç‡é™åˆ¶
- limit_conn_moduleï¼šè¿æ¥æ•°é™åˆ¶
- limit_rate_moduleï¼šå¸¦å®½é™åˆ¶

ä¼˜åŠ¿ï¼š
âœ“ æ€§èƒ½æé«˜ï¼Œå¤„ç†é€Ÿåº¦å¿«
âœ“ é…ç½®ç®€å•ï¼Œæ˜“äºéƒ¨ç½²
âœ“ å†…å­˜å ç”¨å°‘
```

**ğŸ“ è¯¦ç»†é…ç½®ç¤ºä¾‹**
```nginx
http {
    # å®šä¹‰é™æµåŒºåŸŸ
    limit_req_zone $binary_remote_addr zone=login:10m rate=5r/m;  # ç™»å½•æ¥å£
    limit_req_zone $binary_remote_addr zone=api:10m rate=100r/s;  # APIæ¥å£
    limit_req_zone $binary_remote_addr zone=global:10m rate=500r/s; # å…¨å±€é™æµ
    
    # è¿æ¥æ•°é™åˆ¶
    limit_conn_zone $binary_remote_addr zone=perip:10m;
    limit_conn_zone $server_name zone=perserver:10m;
    
    server {
        listen 80;
        server_name api.example.com;
        
        # å…¨å±€é™åˆ¶
        limit_conn perip 10;           # å•IPæœ€å¤š10ä¸ªè¿æ¥
        limit_conn perserver 1000;     # æœåŠ¡å™¨æœ€å¤š1000ä¸ªè¿æ¥
        
        # ç™»å½•æ¥å£ä¸¥æ ¼é™åˆ¶
        location /api/login {
            limit_req zone=login burst=2 nodelay;
            proxy_pass http://backend;
        }
        
        # APIæ¥å£ä¸€èˆ¬é™åˆ¶
        location /api/ {
            limit_req zone=api burst=50 nodelay;
            limit_req zone=global burst=100 nodelay;
            proxy_pass http://backend;
        }
        
        # é™æ€èµ„æºä¸é™åˆ¶
        location /static/ {
            expires 1d;
            root /var/www;
        }
    }
}
```

### 9.2 API Gatewayé™æµ


**ğŸšª ç½‘å…³å±‚ç»Ÿä¸€é™æµ**
```
APIç½‘å…³ä¼˜åŠ¿ï¼š
- ç»Ÿä¸€å…¥å£ï¼šæ‰€æœ‰è¯·æ±‚ç»è¿‡ç½‘å…³
- é…ç½®é›†ä¸­ï¼šç»Ÿä¸€ç®¡ç†é™æµè§„åˆ™
- åŠŸèƒ½ä¸°å¯Œï¼šæ”¯æŒå¤æ‚é™æµç­–ç•¥
- æ˜“äºç›‘æ§ï¼šæµé‡å¯è§†åŒ–

å¸¸ç”¨ç½‘å…³ï¼š
- Spring Cloud Gateway
- Kong
- Zuul
- Envoy
```

**ğŸŒŸ Spring Cloud Gatewayé…ç½®**
```yaml
spring:
  cloud:
    gateway:
      routes:
        - id: api_route
          uri: http://localhost:8080
          predicates:
            - Path=/api/**
          filters:
            - name: RequestRateLimiter
              args:
                redis-rate-limiter.replenishRate: 100  # ä»¤ç‰Œæ¡¶å¡«å……é€Ÿç‡
                redis-rate-limiter.burstCapacity: 200  # ä»¤ç‰Œæ¡¶å®¹é‡
                key-resolver: "#{@ipKeyResolver}"      # é™æµkeyè§£æå™¨

# è‡ªå®šä¹‰Keyè§£æå™¨
@Component
public class IpKeyResolver implements KeyResolver {
    @Override
    public Mono<String> resolve(ServerWebExchange exchange) {
        return Mono.just(exchange.getRequest().getRemoteAddress().getAddress().getHostAddress());
    }
}
```

### 9.3 åº”ç”¨å±‚é™æµ


**ğŸ’» åº”ç”¨å†…åµŒé™æµ**
```
åº”ç”¨å±‚é™æµç‰¹ç‚¹ï¼š
- ä¸šåŠ¡æ„ŸçŸ¥ï¼šå¯ä»¥åŸºäºä¸šåŠ¡é€»è¾‘é™æµ
- çµæ´»æ§åˆ¶ï¼šæ”¯æŒå¤æ‚çš„é™æµç­–ç•¥
- ç²¾ç¡®è®¡é‡ï¼šå¯ä»¥æŒ‰ä¸šåŠ¡æ“ä½œè®¡é‡
- å®¹æ˜“æ‰©å±•ï¼šæ”¯æŒè‡ªå®šä¹‰é™æµé€»è¾‘
```

**ğŸ”— Spring Booté›†æˆç¤ºä¾‹**
```java
// é™æµæ³¨è§£å®šä¹‰
@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface RateLimit {
    String key() default "";           // é™æµkey
    int limit() default 100;          // é™åˆ¶æ¬¡æ•°
    int window() default 60;          // æ—¶é—´çª—å£(ç§’)
    String message() default "è®¿é—®é¢‘ç‡è¶…é™"; // é”™è¯¯æ¶ˆæ¯
}

// AOPå®ç°
@Aspect
@Component
public class RateLimitAspect {
    
    @Around("@annotation(rateLimit)")
    public Object around(ProceedingJoinPoint point, RateLimit rateLimit) throws Throwable {
        String key = buildKey(point, rateLimit);
        
        if (!rateLimiter.tryAcquire(key, rateLimit.limit(), rateLimit.window())) {
            throw new RateLimitException(rateLimit.message());
        }
        
        return point.proceed();
    }
    
    private String buildKey(ProceedingJoinPoint point, RateLimit rateLimit) {
        if (StringUtils.hasText(rateLimit.key())) {
            return rateLimit.key();
        }
        
        // é»˜è®¤ä½¿ç”¨æ–¹æ³•åä½œä¸ºkey
        return point.getSignature().toShortString();
    }
}

// ä½¿ç”¨ç¤ºä¾‹
@RestController
public class UserController {
    
    @RateLimit(key = "register", limit = 5, window = 300)
    @PostMapping("/register")
    public String register(@RequestBody User user) {
        return userService.register(user);
    }
    
    @RateLimit(limit = 100, window = 60)
    @GetMapping("/profile")
    public User getProfile() {
        return userService.getCurrentUser();
    }
}
```

### 9.4 äº‘é˜²æŠ¤æœåŠ¡


**â˜ï¸ äº‘å‚å•†DDoSé˜²æŠ¤**
```
ä¸»æµäº‘å‚å•†é˜²æŠ¤æœåŠ¡ï¼š
- é˜¿é‡Œäº‘ï¼šDDoSé˜²æŠ¤ã€Webåº”ç”¨é˜²ç«å¢™
- è…¾è®¯äº‘ï¼šå¤§ç¦¹DDoSé˜²æŠ¤ã€Webåº”ç”¨é˜²ç«å¢™  
- AWSï¼šShieldã€WAF
- åä¸ºäº‘ï¼šAnti-DDoSã€Webåº”ç”¨é˜²ç«å¢™

ä¼˜åŠ¿ï¼š
âœ“ é˜²æŠ¤èƒ½åŠ›å¼ºï¼šTçº§é˜²æŠ¤èƒ½åŠ›
âœ“ éƒ¨ç½²ç®€å•ï¼šDNSè§£æåˆ‡æ¢å³å¯
âœ“ æ™ºèƒ½é˜²æŠ¤ï¼šAIç®—æ³•è¯†åˆ«æ”»å‡»
âœ“ å…¨çƒèŠ‚ç‚¹ï¼šå°±è¿‘é˜²æŠ¤
```

**ğŸ›¡ï¸ é˜²æŠ¤æœåŠ¡é…ç½®**
```yaml
# äº‘é˜²æŠ¤é…ç½®ç¤ºä¾‹
cloud_protection:
  provider: aliyun
  
  ddos_protection:
    enabled: true
    threshold: 5Gbps        # æ¸…æ´—é˜ˆå€¼
    black_hole: 10Gbps      # é»‘æ´é˜ˆå€¼
    
  waf_protection:
    enabled: true
    rules:
      - sql_injection: block    # SQLæ³¨å…¥é˜²æŠ¤
      - xss: block             # XSSæ”»å‡»é˜²æŠ¤
      - cc_attack: challenge   # CCæ”»å‡»é˜²æŠ¤
      
  rate_limiting:
    global_limit: 10000      # å…¨å±€QPSé™åˆ¶
    single_ip_limit: 100     # å•IP QPSé™åˆ¶
    
  geo_blocking:
    enabled: true
    allowed_countries: ["CN", "US", "SG"]  # å…è®¸çš„å›½å®¶
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å¹‚ç­‰æ€§æœ¬è´¨ï¼šé‡å¤æ“ä½œç»“æœä¸€è‡´ï¼Œä¿è¯æ•°æ®å®‰å…¨
ğŸ”¸ Tokenæœºåˆ¶ï¼šé€šè¿‡å”¯ä¸€ä»¤ç‰Œé˜²æ­¢é‡å¤æäº¤
ğŸ”¸ é™æµç®—æ³•ï¼šå›ºå®šçª—å£ã€æ»‘åŠ¨çª—å£ã€æ¼æ¡¶ã€ä»¤ç‰Œæ¡¶å„æœ‰ç‰¹ç‚¹
ğŸ”¸ é™æµç»´åº¦ï¼šIPã€ç”¨æˆ·ã€æ¥å£ã€å…¨å±€å¤šå±‚é˜²æŠ¤
ğŸ”¸ åˆ†å¸ƒå¼é™æµï¼šRedisé›†ä¸­å¼ vs æœ¬åœ°+åˆ†å¸ƒå¼æ··åˆ
ğŸ”¸ é˜²åˆ·ç­–ç•¥ï¼šéªŒè¯ç ã€è®¾å¤‡æŒ‡çº¹ã€è¡Œä¸ºåˆ†æã€é£æ§æ¨¡å‹
ğŸ”¸ DDoSé˜²æŠ¤ï¼šå…¥å£ã€åº”ç”¨å±‚ã€ä¸šåŠ¡å±‚ã€ç†”æ–­å¤šå±‚é˜²æŠ¤
ğŸ”¸ ä¸­é—´ä»¶éƒ¨ç½²ï¼šNginxã€ç½‘å…³ã€åº”ç”¨å±‚ã€äº‘é˜²æŠ¤å„å±‚é…åˆ
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆéœ€è¦å¹‚ç­‰æ€§**
```
æ ¸å¿ƒä»·å€¼ï¼š
- é˜²æ­¢é‡å¤æ“ä½œï¼šç½‘ç»œé‡è¯•ã€ç”¨æˆ·è¯¯æ“ä½œ
- ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼šé¿å…é‡å¤æ‰£æ¬¾ã€é‡å¤ä¸‹å•
- æå‡ç”¨æˆ·ä½“éªŒï¼šç”¨æˆ·å¯ä»¥å®‰å¿ƒé‡è¯•
- ç³»ç»Ÿç¨³å®šæ€§ï¼šå‡å°‘å› é‡å¤æ“ä½œå¯¼è‡´çš„å¼‚å¸¸
```

**ğŸ”¹ é™æµç®—æ³•çš„é€‰æ‹©åŸåˆ™**
```
å›ºå®šçª—å£ï¼šå®ç°ç®€å•ï¼Œä½†æœ‰çªåˆºé—®é¢˜
æ»‘åŠ¨çª—å£ï¼šæ›´å¹³æ»‘ï¼Œä½†å†…å­˜æ¶ˆè€—å¤§
æ¼æ¡¶ç®—æ³•ï¼šæµé‡æ•´å½¢å¥½ï¼Œä½†æ— æ³•åº”å¯¹çªå‘
ä»¤ç‰Œæ¡¶ç®—æ³•ï¼šæ”¯æŒçªå‘ï¼Œæœ€çµæ´»ï¼ˆæ¨èï¼‰
```

**ğŸ”¹ åˆ†å¸ƒå¼é™æµçš„æŒ‘æˆ˜**
```
ä¸€è‡´æ€§é—®é¢˜ï¼šå¤šèŠ‚ç‚¹é—´æ•°æ®åŒæ­¥
æ€§èƒ½é—®é¢˜ï¼šç½‘ç»œå»¶è¿Ÿå½±å“å“åº”é€Ÿåº¦  
å¯ç”¨æ€§é—®é¢˜ï¼šå•ç‚¹æ•…éšœé£é™©
è§£å†³æ–¹æ¡ˆï¼šæœ¬åœ°+åˆ†å¸ƒå¼æ··åˆï¼Œæ•…éšœé™çº§
```

### 10.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ› ï¸ å¹‚ç­‰æ€§è®¾è®¡é€‰æ‹©**
```
Tokenæ–¹æ¡ˆï¼š
âœ“ é€‚ç”¨ï¼šè¡¨å•æäº¤ã€æ”¯ä»˜æ¥å£
âœ“ ä¼˜ç‚¹ï¼šé€šç”¨æ€§å¼ºï¼Œå®ç°æ ‡å‡†
Ã— ç¼ºç‚¹ï¼šéœ€è¦é¢å¤–è¯·æ±‚è·å–Token

ä¸šåŠ¡å”¯ä¸€å·ï¼š  
âœ“ é€‚ç”¨ï¼šæœ‰å¤©ç„¶ä¸šåŠ¡æ ‡è¯†çš„åœºæ™¯
âœ“ ä¼˜ç‚¹ï¼šæ— éœ€é¢å¤–å¼€é”€
Ã— ç¼ºç‚¹ï¼šä¾èµ–ä¸šåŠ¡è®¾è®¡

çŠ¶æ€æœºæ§åˆ¶ï¼š
âœ“ é€‚ç”¨ï¼šæœ‰æ˜ç¡®çŠ¶æ€æµè½¬çš„ä¸šåŠ¡
âœ“ ä¼˜ç‚¹ï¼šä¸šåŠ¡è¯­ä¹‰æ¸…æ™°
Ã— ç¼ºç‚¹ï¼šè®¾è®¡å¤æ‚åº¦é«˜
```

**âš¡ é™æµç­–ç•¥é…ç½®**
```
é«˜é¢‘æŸ¥è¯¢æ¥å£ï¼š
- ç®—æ³•ï¼šä»¤ç‰Œæ¡¶
- é™åˆ¶ï¼š1000æ¬¡/åˆ†é’Ÿ
- ç»´åº¦ï¼šç”¨æˆ·çº§åˆ«

æ•æ„Ÿæ“ä½œæ¥å£ï¼š
- ç®—æ³•ï¼šå›ºå®šçª—å£
- é™åˆ¶ï¼š10æ¬¡/åˆ†é’Ÿ  
- ç»´åº¦ï¼šIP+ç”¨æˆ·åŒé‡é™åˆ¶

å…¬å¼€APIæ¥å£ï¼š
- ç®—æ³•ï¼šæ»‘åŠ¨çª—å£
- é™åˆ¶ï¼š100æ¬¡/åˆ†é’Ÿ
- ç»´åº¦ï¼šAPI Key
```

**ğŸ”’ é˜²æŠ¤ç­–ç•¥ç»„åˆ**
```
ç¬¬ä¸€å±‚ï¼šäº‘é˜²æŠ¤
- DDoSæ”»å‡»é˜²æŠ¤
- æ¶æ„IPæ‹¦æˆª

ç¬¬äºŒå±‚ï¼šç½‘å…³é™æµ
- å…¨å±€æµé‡æ§åˆ¶
- APIçº§åˆ«é™æµ

ç¬¬ä¸‰å±‚ï¼šåº”ç”¨é˜²åˆ·
- éªŒè¯ç æœºåˆ¶
- è¡Œä¸ºåˆ†æ

ç¬¬å››å±‚ï¼šä¸šåŠ¡ä¿æŠ¤
- å¹‚ç­‰æ€§æ§åˆ¶
- ç†”æ–­é™çº§
```

### 10.4 æœ€ä½³å®è·µæ€»ç»“


**ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–è¦ç‚¹**
```
1. å°±è¿‘åŸåˆ™ï¼šé™æµæ•°æ®å­˜å‚¨åœ¨ç¦»åº”ç”¨æœ€è¿‘çš„åœ°æ–¹
2. æ‰¹é‡æ“ä½œï¼šå‡å°‘ç½‘ç»œIOï¼Œæé«˜å¤„ç†æ•ˆç‡
3. å¼‚æ­¥å¤„ç†ï¼šéå…³é”®è·¯å¾„å¼‚æ­¥æ‰§è¡Œ
4. ç¼“å­˜ç­–ç•¥ï¼šåˆç†ä½¿ç”¨ç¼“å­˜å‡å°‘è®¡ç®—å¼€é”€
```

**ğŸš¨ ç›‘æ§å‘Šè­¦è®¾ç½®**
```
å…³é”®æŒ‡æ ‡ï¼š
- é™æµè§¦å‘é¢‘ç‡ï¼šæ£€æµ‹å¼‚å¸¸æµé‡
- å¹‚ç­‰Tokenä½¿ç”¨ç‡ï¼šè¯„ä¼°ç³»ç»Ÿè´Ÿè½½
- æ¥å£å“åº”æ—¶é—´ï¼šç›‘æ§æ€§èƒ½å½±å“
- é”™è¯¯ç‡å˜åŒ–ï¼šåŠæ—¶å‘ç°é—®é¢˜

å‘Šè­¦é˜ˆå€¼ï¼š
- é™æµè§¦å‘ç‡ > 10%ï¼šæµé‡å¼‚å¸¸å‘Šè­¦
- Tokenè·å–å¤±è´¥ç‡ > 5%ï¼šç³»ç»Ÿå¼‚å¸¸å‘Šè­¦  
- æ¥å£å“åº”æ—¶é—´ > 1sï¼šæ€§èƒ½å‘Šè­¦
```

**ğŸ”§ æ•…éšœå¤„ç†ç­–ç•¥**
```
é™çº§æ–¹æ¡ˆï¼š
1. Redisæ•…éšœ â†’ åˆ‡æ¢æœ¬åœ°é™æµ
2. éªŒè¯ç æœåŠ¡æ•…éšœ â†’ ä¸´æ—¶æ”¾å¼€é™åˆ¶
3. é£æ§æœåŠ¡æ•…éšœ â†’ ä½¿ç”¨ç®€åŒ–è§„åˆ™
4. æ•°æ®åº“æ•…éšœ â†’ è¿”å›ç¼“å­˜æ•°æ®

æ¢å¤ç­–ç•¥ï¼š
1. ç°åº¦æ¢å¤ï¼šé€æ­¥æ¢å¤æ­£å¸¸æµé‡
2. ç›‘æ§éªŒè¯ï¼šç¡®è®¤ç³»ç»Ÿç¨³å®šåå…¨é‡æ¢å¤
3. æ•°æ®è¡¥å¿ï¼šå¤„ç†é™çº§æœŸé—´çš„æ•°æ®ä¸ä¸€è‡´
```

**ğŸ’¡ æ ¸å¿ƒè®°å¿†å£è¯€**
```
æ¥å£å®‰å…¨å¾ˆé‡è¦ï¼Œå¹‚ç­‰é™æµä¸èƒ½å°‘
TokenéªŒè¯é˜²é‡å¤ï¼Œå¤šç§ç®—æ³•é€‰æ‹©å¥½
åˆ†å¸ƒå¼ä¸‹è¦åè°ƒï¼Œæœ¬åœ°è¿œç¨‹ç›¸ç»“åˆ
é˜²åˆ·ç­–ç•¥å¤šå±‚æ¬¡ï¼ŒéªŒè¯ç åŠ è¡Œä¸ºæ
DDoSé˜²æŠ¤è¦å…¨é¢ï¼Œå…¥å£åº”ç”¨åŠ ä¸šåŠ¡
ä¸­é—´ä»¶æ¥å¸®å¤§å¿™ï¼Œç½‘å…³åº”ç”¨äº‘é˜²æŠ¤
```

**ğŸ¯ å­¦ä¹ å»ºè®®**
- **ç†è®ºåŸºç¡€**ï¼šå…ˆç†è§£æ ¸å¿ƒæ¦‚å¿µå’ŒåŸç†
- **åŠ¨æ‰‹å®è·µ**ï¼šä»ç®€å•çš„TokenéªŒè¯å¼€å§‹
- **é€æ­¥æ·±å…¥**ï¼šæŒæ¡åŸºç¡€åå­¦ä¹ åˆ†å¸ƒå¼æ–¹æ¡ˆ
- **å®æˆ˜ç»éªŒ**ï¼šåœ¨é¡¹ç›®ä¸­åº”ç”¨å’Œä¼˜åŒ–
- **æŒç»­å­¦ä¹ **ï¼šå…³æ³¨æ–°æŠ€æœ¯å’Œæœ€ä½³å®è·µ