---
title: 2ã€RBACæƒé™æ§åˆ¶ä¸æ¥å£è®¾è®¡
---
## ğŸ“š ç›®å½•

1. [RBACæƒé™æ¨¡å‹åŸºç¡€æ¦‚å¿µ](#1-RBACæƒé™æ¨¡å‹åŸºç¡€æ¦‚å¿µ)
2. [RBACä¸‰å±‚æ¶æ„è®¾è®¡](#2-RBACä¸‰å±‚æ¶æ„è®¾è®¡)
3. [ç»†ç²’åº¦æƒé™æ§åˆ¶å®ç°](#3-ç»†ç²’åº¦æƒé™æ§åˆ¶å®ç°)
4. [æ¥å£çº§æƒé™æ‹¦æˆªç­–ç•¥](#4-æ¥å£çº§æƒé™æ‹¦æˆªç­–ç•¥)
5. [æƒé™éªŒè¯ç³»ç»Ÿå®ç°](#5-æƒé™éªŒè¯ç³»ç»Ÿå®ç°)
6. [å®è·µåº”ç”¨åœºæ™¯è§£æ](#6-å®è·µåº”ç”¨åœºæ™¯è§£æ)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” RBACæƒé™æ¨¡å‹åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯RBACæƒé™æ¨¡å‹


**ğŸ”¸ RBACæ ¸å¿ƒå®šä¹‰**
```
RBAC = Role-Based Access Controlï¼ˆåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼‰

ç®€å•ç†è§£ï¼š
å°±åƒå…¬å¸é‡Œçš„èŒä½ä½“ç³»ä¸€æ ·
- ä¸åŒèŒä½çš„äººæœ‰ä¸åŒçš„æƒé™
- ç»™å‘˜å·¥åˆ†é…èŒä½ï¼Œå°±ç­‰äºç»™äº†ç›¸åº”çš„æƒé™
- è¦è°ƒæ•´æƒé™ï¼Œåªéœ€è¦è°ƒæ•´èŒä½å³å¯
```

**ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦RBAC**
```
ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜ï¼š
âŒ ç›´æ¥ç»™ç”¨æˆ·åˆ†é…æƒé™ â†’ ç”¨æˆ·å¤šäº†ç®¡ç†æ··ä¹±
âŒ æƒé™å˜æ›´æ—¶è¦é€ä¸ªä¿®æ”¹ â†’ å·¥ä½œé‡å·¨å¤§
âŒ æ–°å‘˜å·¥å…¥èŒéœ€è¦é€é¡¹é…ç½® â†’ å®¹æ˜“é—æ¼

RBACçš„ä¼˜åŠ¿ï¼š
âœ… é€šè¿‡è§’è‰²ç®¡ç†æƒé™ â†’ æ¸…æ™°æ˜äº†
âœ… æ‰¹é‡æƒé™ç®¡ç† â†’ æ•ˆç‡é«˜
âœ… æ ‡å‡†åŒ–é…ç½® â†’ ä¸æ˜“å‡ºé”™
```

### 1.2 RBACæ¨¡å‹çš„ç”Ÿæ´»åŒ–ç†è§£


**ğŸ¢ å…¬å¸æƒé™ç±»æ¯”**
```
ç°å®ä¸–ç•Œçš„æƒé™ç®¡ç†ï¼š

CEOï¼ˆè§’è‰²ï¼‰ï¼š
- æŸ¥çœ‹æ‰€æœ‰è´¢åŠ¡æŠ¥è¡¨ï¼ˆæƒé™ï¼‰
- å®¡æ‰¹å¤§é¢æ”¯å‡ºï¼ˆæƒé™ï¼‰
- äººäº‹ä»»å…å†³ç­–ï¼ˆæƒé™ï¼‰

è´¢åŠ¡ç»ç†ï¼ˆè§’è‰²ï¼‰ï¼š
- æŸ¥çœ‹è´¢åŠ¡æŠ¥è¡¨ï¼ˆæƒé™ï¼‰
- å®¡æ‰¹ä¸­ç­‰é‡‘é¢æ”¯å‡ºï¼ˆæƒé™ï¼‰

æ™®é€šå‘˜å·¥ï¼ˆè§’è‰²ï¼‰ï¼š
- æŸ¥çœ‹è‡ªå·±çš„å·¥èµ„ï¼ˆæƒé™ï¼‰
- æäº¤æŠ¥é”€ç”³è¯·ï¼ˆæƒé™ï¼‰

å½“å°ç‹å…¥èŒå½“è´¢åŠ¡ç»ç†æ—¶ï¼š
ç›´æ¥ç»™ä»–"è´¢åŠ¡ç»ç†"è§’è‰² â†’ è‡ªåŠ¨è·å¾—æ‰€æœ‰ç›¸å…³æƒé™
```

### 1.3 RBACçš„æ ¸å¿ƒä»·å€¼


**ğŸ¯ è§£å†³çš„æ ¸å¿ƒé—®é¢˜**
```
æƒé™ç®¡ç†å¤æ‚æ€§ï¼š
é—®é¢˜ï¼š1000ä¸ªç”¨æˆ· Ã— 100ä¸ªæƒé™ = 10ä¸‡ä¸ªå…³ç³»éœ€è¦ç®¡ç†
è§£å†³ï¼š1000ä¸ªç”¨æˆ· â†’ 10ä¸ªè§’è‰² â†’ 100ä¸ªæƒé™ = åªéœ€ç®¡ç†1010ä¸ªå…³ç³»

æƒé™æ ‡å‡†åŒ–ï¼š
é—®é¢˜ï¼šæ¯ä¸ªæ–°å‘˜å·¥çš„æƒé™é…ç½®éƒ½å¯èƒ½ä¸åŒ
è§£å†³ï¼šåŒæ ·èŒä½çš„å‘˜å·¥è‡ªåŠ¨è·å¾—ç›¸åŒçš„æ ‡å‡†æƒé™

æƒé™å˜æ›´æ•ˆç‡ï¼š
é—®é¢˜ï¼šè°ƒæ•´æŸç±»å‘˜å·¥æƒé™éœ€è¦é€ä¸ªä¿®æ”¹
è§£å†³ï¼šåªéœ€è¦ä¿®æ”¹è§’è‰²æƒé™ï¼Œæ‰€æœ‰ç›¸å…³ç”¨æˆ·è‡ªåŠ¨ç”Ÿæ•ˆ
```

---

## 2. ğŸ—ï¸ RBACä¸‰å±‚æ¶æ„è®¾è®¡


### 2.1 ä¸‰å±‚æ¶æ„å…¨æ™¯å›¾


**ğŸ“Š RBACæ¶æ„ç¤ºæ„å›¾**
```
ç”¨æˆ·å±‚ (User)          è§’è‰²å±‚ (Role)          æƒé™å±‚ (Permission)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¼ ä¸‰        â”‚â”€â”€â”€â”€â†’  â”‚  ç®¡ç†å‘˜      â”‚â”€â”€â”€â”€â†’  â”‚  ç”¨æˆ·ç®¡ç†    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æå››        â”‚â”€â”€â”€â”€â†’  â”‚  ç¼–è¾‘è€…      â”‚â”€â”€â”€â”€â†’  â”‚  æ–‡ç« ç¼–è¾‘    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç‹äº”        â”‚â”€â”€â”€â”€â†’  â”‚  æŸ¥çœ‹è€…      â”‚â”€â”€â”€â”€â†’  â”‚  å†…å®¹æŸ¥çœ‹    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å…³ç³»è¯´æ˜ï¼š
ç”¨æˆ· â†â†’ è§’è‰²ï¼šå¤šå¯¹å¤šï¼ˆä¸€ä¸ªç”¨æˆ·å¯ä»¥æœ‰å¤šä¸ªè§’è‰²ï¼‰
è§’è‰² â†â†’ æƒé™ï¼šå¤šå¯¹å¤šï¼ˆä¸€ä¸ªè§’è‰²å¯ä»¥æœ‰å¤šä¸ªæƒé™ï¼‰
```

### 2.2 ç”¨æˆ·å±‚ï¼ˆUser Layerï¼‰è¯¦è§£


**ğŸ‘¤ ç”¨æˆ·å±‚æ ¸å¿ƒè¦ç´ **
```java
// ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
public class User {
    private Long userId;           // ç”¨æˆ·å”¯ä¸€æ ‡è¯†
    private String username;       // ç”¨æˆ·å
    private String email;          // é‚®ç®±
    private Boolean enabled;       // æ˜¯å¦å¯ç”¨
    private List<Role> roles;      // ç”¨æˆ·æ‹¥æœ‰çš„è§’è‰²åˆ—è¡¨
}
```

**ğŸ”¸ ç”¨æˆ·å±‚è®¾è®¡è¦ç‚¹**
```
ç”¨æˆ·åŸºç¡€å±æ€§ï¼š
- èº«ä»½æ ‡è¯†ï¼šç¡®ä¿æ¯ä¸ªç”¨æˆ·çš„å”¯ä¸€æ€§
- åŸºæœ¬ä¿¡æ¯ï¼šç”¨äºèº«ä»½éªŒè¯å’Œå±•ç¤º
- çŠ¶æ€ç®¡ç†ï¼šå¯ç”¨/ç¦ç”¨çŠ¶æ€æ§åˆ¶

ç”¨æˆ·ä¸è§’è‰²å…³è”ï¼š
- æ”¯æŒä¸€ä¸ªç”¨æˆ·æ‹¥æœ‰å¤šä¸ªè§’è‰²
- ä¾‹ï¼šå¼ ä¸‰æ—¢æ˜¯"ç¼–è¾‘è€…"åˆæ˜¯"å®¡æ ¸è€…"
- æœ€ç»ˆæƒé™æ˜¯æ‰€æœ‰è§’è‰²æƒé™çš„å¹¶é›†
```

### 2.3 è§’è‰²å±‚ï¼ˆRole Layerï¼‰è¯¦è§£


**ğŸ­ è§’è‰²å±‚æ ¸å¿ƒè®¾è®¡**
```java
// è§’è‰²å®šä¹‰
public class Role {
    private Long roleId;              // è§’è‰²å”¯ä¸€æ ‡è¯†
    private String roleName;          // è§’è‰²åç§°ï¼ˆå¦‚ï¼šç®¡ç†å‘˜ï¼‰
    private String roleCode;          // è§’è‰²ç¼–ç ï¼ˆå¦‚ï¼šADMINï¼‰
    private String description;       // è§’è‰²æè¿°
    private List<Permission> permissions; // è§’è‰²æ‹¥æœ‰çš„æƒé™
}
```

**ğŸ”¸ è§’è‰²è®¾è®¡åŸåˆ™**
```
è§’è‰²å‘½åè§„èŒƒï¼š
âœ… èŒèƒ½å¯¼å‘ï¼šç®¡ç†å‘˜ã€ç¼–è¾‘è€…ã€æŸ¥çœ‹è€…
âœ… ä¸šåŠ¡å¯¼å‘ï¼šè´¢åŠ¡ç»ç†ã€é”€å”®ä»£è¡¨ã€å®¢æœä¸“å‘˜
âŒ æŠ€æœ¯å¯¼å‘ï¼šé¿å…ç”¨technical-adminè¿™ç§

è§’è‰²ç²’åº¦æ§åˆ¶ï¼š
ç²—ç²’åº¦è§’è‰²ï¼šç®¡ç†å‘˜ï¼ˆæƒé™å¾ˆå¤šï¼Œé€‚åˆé«˜çº§ç”¨æˆ·ï¼‰
ä¸­ç²’åº¦è§’è‰²ï¼šç¼–è¾‘è€…ï¼ˆç‰¹å®šé¢†åŸŸæƒé™ï¼‰
ç»†ç²’åº¦è§’è‰²ï¼šæŸ¥çœ‹è€…ï¼ˆåªè¯»æƒé™ï¼‰
```

### 2.4 æƒé™å±‚ï¼ˆPermission Layerï¼‰è¯¦è§£


**ğŸ”‘ æƒé™å±‚è®¾è®¡æ€è·¯**
```java
// æƒé™å®šä¹‰
public class Permission {
    private Long permissionId;     // æƒé™å”¯ä¸€æ ‡è¯†
    private String permissionName; // æƒé™åç§°
    private String permissionCode; // æƒé™ç¼–ç 
    private String resource;       // èµ„æºæ ‡è¯†
    private String action;         // æ“ä½œç±»å‹
}
```

**ğŸ”¸ æƒé™è¡¨è¾¾æ–¹å¼**
```
æƒé™ç¼–ç è§„èŒƒï¼š
æ ¼å¼ï¼šèµ„æº:æ“ä½œ
ç¤ºä¾‹ï¼š
- user:read    â†’ ç”¨æˆ·æŸ¥çœ‹æƒé™
- user:write   â†’ ç”¨æˆ·ç¼–è¾‘æƒé™
- user:delete  â†’ ç”¨æˆ·åˆ é™¤æƒé™
- order:create â†’ è®¢å•åˆ›å»ºæƒé™

æƒé™åˆ†ç»„ç®¡ç†ï¼š
ç”¨æˆ·ç®¡ç†ï¼šuser:read, user:write, user:delete
è®¢å•ç®¡ç†ï¼šorder:read, order:write, order:delete
ç³»ç»Ÿè®¾ç½®ï¼šsystem:config, system:monitor
```

### 2.5 ä¸‰å±‚å…³ç³»æ˜ å°„


**ğŸ”— æ•°æ®åº“å…³ç³»è®¾è®¡**
```sql
-- ç”¨æˆ·è¡¨
CREATE TABLE users (
    user_id BIGINT PRIMARY KEY,
    username VARCHAR(50) UNIQUE,
    email VARCHAR(100),
    enabled BOOLEAN DEFAULT TRUE
);

-- è§’è‰²è¡¨
CREATE TABLE roles (
    role_id BIGINT PRIMARY KEY,
    role_name VARCHAR(50),
    role_code VARCHAR(50) UNIQUE,
    description TEXT
);

-- æƒé™è¡¨
CREATE TABLE permissions (
    permission_id BIGINT PRIMARY KEY,
    permission_name VARCHAR(100),
    permission_code VARCHAR(100) UNIQUE,
    resource VARCHAR(50),
    action VARCHAR(50)
);

-- ç”¨æˆ·-è§’è‰²å…³ç³»è¡¨
CREATE TABLE user_roles (
    user_id BIGINT,
    role_id BIGINT,
    PRIMARY KEY (user_id, role_id)
);

-- è§’è‰²-æƒé™å…³ç³»è¡¨
CREATE TABLE role_permissions (
    role_id BIGINT,
    permission_id BIGINT,
    PRIMARY KEY (role_id, permission_id)
);
```

---

## 3. ğŸ¯ ç»†ç²’åº¦æƒé™æ§åˆ¶å®ç°


### 3.1 å››è¦ç´ æƒé™æ¨¡å‹


**ğŸ”¸ æƒé™æ§åˆ¶å››è¦ç´ **
```
æƒé™åˆ¤æ–­å…¬å¼ï¼šæ˜¯å¦å…è®¸ = f(ç”¨æˆ·, è§’è‰², èµ„æº, æ“ä½œ)

å››è¦ç´ è¯¦è§£ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¦ç´      â”‚ å«ä¹‰          â”‚ ç¤ºä¾‹             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç”¨æˆ·     â”‚ è°åœ¨æ“ä½œ      â”‚ å¼ ä¸‰ã€æå››       â”‚
â”‚ è§’è‰²     â”‚ ä»¥ä»€ä¹ˆèº«ä»½    â”‚ ç®¡ç†å‘˜ã€ç¼–è¾‘è€…   â”‚
â”‚ èµ„æº     â”‚ æ“ä½œä»€ä¹ˆå¯¹è±¡  â”‚ ç”¨æˆ·ä¿¡æ¯ã€è®¢å•   â”‚
â”‚ æ“ä½œ     â”‚ æ‰§è¡Œä»€ä¹ˆåŠ¨ä½œ  â”‚ æŸ¥çœ‹ã€ç¼–è¾‘ã€åˆ é™¤ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 èµ„æºæƒé™ç»†åˆ†


**ğŸ“‚ èµ„æºåˆ†ç±»ç®¡ç†**
```
èµ„æºå±‚æ¬¡åŒ–è®¾è®¡ï¼š

ä¸€çº§èµ„æºï¼ˆæ¨¡å—çº§ï¼‰ï¼š
â”œâ”€â”€ ç”¨æˆ·ç®¡ç†æ¨¡å—
â”œâ”€â”€ è®¢å•ç®¡ç†æ¨¡å—
â”œâ”€â”€ è´¢åŠ¡ç®¡ç†æ¨¡å—
â””â”€â”€ ç³»ç»Ÿè®¾ç½®æ¨¡å—

äºŒçº§èµ„æºï¼ˆåŠŸèƒ½çº§ï¼‰ï¼š
ç”¨æˆ·ç®¡ç†æ¨¡å—/
â”œâ”€â”€ ç”¨æˆ·åˆ—è¡¨
â”œâ”€â”€ è§’è‰²ç®¡ç†
â”œâ”€â”€ æƒé™é…ç½®
â””â”€â”€ ç”¨æˆ·ç»„ç®¡ç†

ä¸‰çº§èµ„æºï¼ˆæ•°æ®çº§ï¼‰ï¼š
ç”¨æˆ·åˆ—è¡¨/
â”œâ”€â”€ æœ¬éƒ¨é—¨ç”¨æˆ·æ•°æ®
â”œâ”€â”€ å…¨å…¬å¸ç”¨æˆ·æ•°æ®
â””â”€â”€ ç‰¹å®šç”¨æˆ·è¯¦ç»†ä¿¡æ¯
```

### 3.3 æ“ä½œæƒé™å®šä¹‰


**âš¡ æ ‡å‡†æ“ä½œç±»å‹**
```java
// æ ‡å‡†CRUDæ“ä½œ
public enum ActionType {
    CREATE("create", "åˆ›å»º"),
    READ("read", "æŸ¥çœ‹"),
    UPDATE("update", "æ›´æ–°"),
    DELETE("delete", "åˆ é™¤"),
    
    // æ‰©å±•æ“ä½œ
    EXPORT("export", "å¯¼å‡º"),
    IMPORT("import", "å¯¼å…¥"),
    APPROVE("approve", "å®¡æ‰¹"),
    REJECT("reject", "æ‹’ç»");
    
    private String code;
    private String description;
}
```

**ğŸ”¸ æƒé™ç»„åˆç¤ºä¾‹**
```
å®é™…æƒé™é…ç½®ï¼š
user:read         â†’ å¯ä»¥æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨
user:read:detail  â†’ å¯ä»¥æŸ¥çœ‹ç”¨æˆ·è¯¦ç»†ä¿¡æ¯
user:write        â†’ å¯ä»¥ç¼–è¾‘ç”¨æˆ·ä¿¡æ¯
user:delete       â†’ å¯ä»¥åˆ é™¤ç”¨æˆ·
user:export       â†’ å¯ä»¥å¯¼å‡ºç”¨æˆ·æ•°æ®

order:read:own    â†’ åªèƒ½æŸ¥çœ‹è‡ªå·±çš„è®¢å•
order:read:dept   â†’ å¯ä»¥æŸ¥çœ‹éƒ¨é—¨è®¢å•
order:read:all    â†’ å¯ä»¥æŸ¥çœ‹æ‰€æœ‰è®¢å•
```

### 3.4 æ•°æ®çº§æƒé™æ§åˆ¶


**ğŸ—ƒï¸ æ•°æ®æƒé™å®ç°**
```java
// æ•°æ®æƒé™æ³¨è§£
@DataPermission
public class DataScope {
    public static final String ALL = "all";           // å…¨éƒ¨æ•°æ®
    public static final String DEPT = "dept";         // éƒ¨é—¨æ•°æ®
    public static final String DEPT_AND_SUB = "dept_sub"; // éƒ¨é—¨åŠä¸‹çº§
    public static final String SELF = "self";         // ä»…è‡ªå·±
}

// ä½¿ç”¨ç¤ºä¾‹
@GetMapping("/users")
@DataPermission(scope = DataScope.DEPT)
public List<User> getUserList() {
    // æ ¹æ®ç”¨æˆ·æƒé™è‡ªåŠ¨è¿‡æ»¤æ•°æ®
    return userService.findUsers();
}
```

**ğŸ”¸ æ•°æ®æƒé™è¿‡æ»¤é€»è¾‘**
```
æ•°æ®è¿‡æ»¤ç­–ç•¥ï¼š

ç®¡ç†å‘˜è§’è‰²ï¼š
- æ•°æ®èŒƒå›´ï¼šå…¨éƒ¨æ•°æ®
- SQLå¢å¼ºï¼šæ— é¢å¤–æ¡ä»¶

éƒ¨é—¨ç»ç†è§’è‰²ï¼š
- æ•°æ®èŒƒå›´ï¼šæœ¬éƒ¨é—¨åŠä¸‹çº§éƒ¨é—¨
- SQLå¢å¼ºï¼šWHERE dept_id IN (å½“å‰éƒ¨é—¨, ä¸‹çº§éƒ¨é—¨åˆ—è¡¨)

æ™®é€šå‘˜å·¥è§’è‰²ï¼š
- æ•°æ®èŒƒå›´ï¼šä»…è‡ªå·±çš„æ•°æ®
- SQLå¢å¼ºï¼šWHERE user_id = å½“å‰ç”¨æˆ·ID
```

---

## 4. ğŸ›¡ï¸ æ¥å£çº§æƒé™æ‹¦æˆªç­–ç•¥


### 4.1 åŸºäºæ³¨è§£çš„æƒé™æ§åˆ¶


**ğŸ·ï¸ æƒé™æ³¨è§£è®¾è®¡**
```java
// æƒé™æ£€æŸ¥æ³¨è§£
@Target({ElementType.METHOD, ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
public @interface RequirePermission {
    String[] value();                    // éœ€è¦çš„æƒé™
    LogicalType logical() default LogicalType.AND; // æƒé™ç»„åˆé€»è¾‘
}

// é€»è¾‘ç±»å‹
public enum LogicalType {
    AND, // éœ€è¦åŒæ—¶æ‹¥æœ‰æ‰€æœ‰æƒé™
    OR   // æ‹¥æœ‰å…¶ä¸­ä¸€ä¸ªæƒé™å³å¯
}
```

**ğŸ”¸ æ³¨è§£ä½¿ç”¨ç¤ºä¾‹**
```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    // å•ä¸€æƒé™æ£€æŸ¥
    @GetMapping
    @RequirePermission("user:read")
    public List<User> getUsers() {
        return userService.findAll();
    }
    
    // å¤šæƒé™ANDç»„åˆ
    @PostMapping
    @RequirePermission({"user:write", "user:create"})
    public User createUser(@RequestBody User user) {
        return userService.create(user);
    }
    
    // å¤šæƒé™ORç»„åˆ
    @GetMapping("/{id}")
    @RequirePermission(value = {"user:read:all", "user:read:dept"}, 
                      logical = LogicalType.OR)
    public User getUser(@PathVariable Long id) {
        return userService.findById(id);
    }
}
```

### 4.2 æ‹¦æˆªå™¨å®ç°æƒé™æ£€æŸ¥


**ğŸ”§ æƒé™æ‹¦æˆªå™¨è®¾è®¡**
```java
@Component
public class PermissionInterceptor implements HandlerInterceptor {
    
    @Override
    public boolean preHandle(HttpServletRequest request, 
                           HttpServletResponse response, 
                           Object handler) throws Exception {
        
        // 1. è·å–æ–¹æ³•ä¸Šçš„æƒé™æ³¨è§£
        RequirePermission permission = getPermissionAnnotation(handler);
        if (permission == null) {
            return true; // æ— æƒé™è¦æ±‚ï¼Œç›´æ¥é€šè¿‡
        }
        
        // 2. è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
        User currentUser = getCurrentUser(request);
        if (currentUser == null) {
            throw new UnauthorizedException("ç”¨æˆ·æœªç™»å½•");
        }
        
        // 3. æ£€æŸ¥ç”¨æˆ·æƒé™
        boolean hasPermission = checkPermission(currentUser, permission);
        if (!hasPermission) {
            throw new ForbiddenException("æƒé™ä¸è¶³");
        }
        
        return true;
    }
    
    private boolean checkPermission(User user, RequirePermission permission) {
        String[] requiredPermissions = permission.value();
        Set<String> userPermissions = getUserPermissions(user);
        
        if (permission.logical() == LogicalType.AND) {
            // éœ€è¦æ‹¥æœ‰æ‰€æœ‰æƒé™
            return Arrays.stream(requiredPermissions)
                        .allMatch(userPermissions::contains);
        } else {
            // æ‹¥æœ‰ä»»ä¸€æƒé™å³å¯
            return Arrays.stream(requiredPermissions)
                        .anyMatch(userPermissions::contains);
        }
    }
}
```

### 4.3 APIç½‘å…³æƒé™æ§åˆ¶


**ğŸŒ ç½‘å…³çº§æƒé™è®¾è®¡**
```
APIç½‘å…³æƒé™æ¶æ„ï¼š

å®¢æˆ·ç«¯è¯·æ±‚ â†’ APIç½‘å…³ â†’ æƒé™æœåŠ¡ â†’ ä¸šåŠ¡æœåŠ¡
              â†“
        1. èº«ä»½éªŒè¯
        2. æƒé™æ£€æŸ¥
        3. è¯·æ±‚è½¬å‘
        4. å“åº”è¿”å›
```

**ğŸ”¸ ç½‘å…³æƒé™é…ç½®**
```yaml
# ç½‘å…³æƒé™é…ç½®ç¤ºä¾‹
gateway:
  routes:
    - path: /api/users/**
      permissions:
        - user:read
      methods: [GET]
    
    - path: /api/users
      permissions:
        - user:write
      methods: [POST, PUT]
    
    - path: /api/users/**
      permissions:
        - user:delete
      methods: [DELETE]
```

### 4.4 åŠ¨æ€æƒé™è·¯ç”±


**ğŸ”„ åŠ¨æ€æƒé™å®ç°**
```java
@Component
public class DynamicPermissionFilter {
    
    // æƒé™é…ç½®ç¼“å­˜
    private final Map<String, PermissionConfig> permissionCache = new ConcurrentHashMap<>();
    
    public boolean checkApiPermission(String path, String method, User user) {
        // 1. è·å–APIæƒé™é…ç½®
        PermissionConfig config = getPermissionConfig(path, method);
        if (config == null) {
            return true; // æ— æƒé™è¦æ±‚
        }
        
        // 2. è·å–ç”¨æˆ·æƒé™é›†åˆ
        Set<String> userPermissions = getUserPermissions(user);
        
        // 3. æƒé™åŒ¹é…æ£€æŸ¥
        return config.getRequiredPermissions().stream()
                    .anyMatch(userPermissions::contains);
    }
    
    private PermissionConfig getPermissionConfig(String path, String method) {
        String key = method + ":" + path;
        return permissionCache.computeIfAbsent(key, k -> 
            permissionService.getPermissionConfig(path, method));
    }
}
```

---

## 5. âš™ï¸ æƒé™éªŒè¯ç³»ç»Ÿå®ç°


### 5.1 æƒé™æœåŠ¡æ ¸å¿ƒå®ç°


**ğŸ”§ æƒé™æœåŠ¡è®¾è®¡**
```java
@Service
public class PermissionService {
    
    @Autowired
    private UserRoleRepository userRoleRepository;
    
    @Autowired
    private RolePermissionRepository rolePermissionRepository;
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    /**
     * è·å–ç”¨æˆ·æ‰€æœ‰æƒé™
     */
    public Set<String> getUserPermissions(Long userId) {
        String cacheKey = "user:permissions:" + userId;
        
        // 1. å…ˆä»ç¼“å­˜è·å–
        Set<String> permissions = (Set<String>) redisTemplate.opsForValue().get(cacheKey);
        if (permissions != null) {
            return permissions;
        }
        
        // 2. ä»æ•°æ®åº“æŸ¥è¯¢
        permissions = new HashSet<>();
        
        // è·å–ç”¨æˆ·è§’è‰²
        List<Role> userRoles = userRoleRepository.findRolesByUserId(userId);
        
        // è·å–è§’è‰²æƒé™
        for (Role role : userRoles) {
            List<Permission> rolePermissions = rolePermissionRepository.findPermissionsByRoleId(role.getRoleId());
            rolePermissions.forEach(permission -> 
                permissions.add(permission.getPermissionCode()));
        }
        
        // 3. ç¼“å­˜æƒé™ä¿¡æ¯ï¼ˆ1å°æ—¶è¿‡æœŸï¼‰
        redisTemplate.opsForValue().set(cacheKey, permissions, 1, TimeUnit.HOURS);
        
        return permissions;
    }
    
    /**
     * æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æŒ‡å®šæƒé™
     */
    public boolean hasPermission(Long userId, String permission) {
        Set<String> userPermissions = getUserPermissions(userId);
        return userPermissions.contains(permission);
    }
}
```

### 5.2 æƒé™ç¼“å­˜ç­–ç•¥


**ğŸ“¦ ç¼“å­˜è®¾è®¡åŸåˆ™**
```
ç¼“å­˜å±‚æ¬¡ç»“æ„ï¼š

ä¸€çº§ç¼“å­˜ï¼ˆåº”ç”¨å†…å­˜ï¼‰ï¼š
- çƒ­ç‚¹æƒé™æ•°æ®
- è¿‡æœŸæ—¶é—´ï¼š10åˆ†é’Ÿ
- é€‚ç”¨ï¼šé«˜é¢‘è®¿é—®çš„æƒé™æ£€æŸ¥

äºŒçº§ç¼“å­˜ï¼ˆRedisï¼‰ï¼š
- ç”¨æˆ·æƒé™é›†åˆ
- è¿‡æœŸæ—¶é—´ï¼š1å°æ—¶
- é€‚ç”¨ï¼šç”¨æˆ·æƒé™å®Œæ•´æ•°æ®

ä¸‰çº§ç¼“å­˜ï¼ˆæ•°æ®åº“ï¼‰ï¼š
- æƒé™å…³ç³»åŸå§‹æ•°æ®
- å®æ—¶æ€§ï¼šæœ€æ–°æ•°æ®
- é€‚ç”¨ï¼šæƒé™å˜æ›´æ—¶çš„æœ€ç»ˆæ•°æ®æº
```

**ğŸ”¸ ç¼“å­˜æ›´æ–°ç­–ç•¥**
```java
@Service
public class PermissionCacheService {
    
    /**
     * ç”¨æˆ·æƒé™å˜æ›´æ—¶æ¸…é™¤ç¼“å­˜
     */
    public void refreshUserPermissions(Long userId) {
        // æ¸…é™¤ç”¨æˆ·æƒé™ç¼“å­˜
        String userCacheKey = "user:permissions:" + userId;
        redisTemplate.delete(userCacheKey);
        
        // æ¸…é™¤ç›¸å…³åº”ç”¨ç¼“å­˜
        localCache.invalidate("user:permissions:" + userId);
        
        // å‘é€æƒé™å˜æ›´äº‹ä»¶
        eventPublisher.publishEvent(new PermissionChangedEvent(userId));
    }
    
    /**
     * è§’è‰²æƒé™å˜æ›´æ—¶æ‰¹é‡æ¸…é™¤ç¼“å­˜
     */
    public void refreshRolePermissions(Long roleId) {
        // è·å–æ‹¥æœ‰è¯¥è§’è‰²çš„æ‰€æœ‰ç”¨æˆ·
        List<Long> userIds = userRoleRepository.findUserIdsByRoleId(roleId);
        
        // æ‰¹é‡æ¸…é™¤ç”¨æˆ·æƒé™ç¼“å­˜
        userIds.forEach(this::refreshUserPermissions);
    }
}
```

### 5.3 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


**âš¡ æƒé™æ£€æŸ¥ä¼˜åŒ–**
```java
@Component
public class PermissionOptimizer {
    
    // æœ¬åœ°ç¼“å­˜ï¼Œé¿å…é¢‘ç¹Redisè®¿é—®
    private final Cache<String, Boolean> permissionCache = 
        Caffeine.newBuilder()
                .maximumSize(10000)
                .expireAfterWrite(5, TimeUnit.MINUTES)
                .build();
    
    /**
     * ä¼˜åŒ–åçš„æƒé™æ£€æŸ¥
     */
    public boolean checkPermissionOptimized(Long userId, String permission) {
        String cacheKey = userId + ":" + permission;
        
        // 1. æœ¬åœ°ç¼“å­˜æ£€æŸ¥
        Boolean hasPermission = permissionCache.getIfPresent(cacheKey);
        if (hasPermission != null) {
            return hasPermission;
        }
        
        // 2. æƒé™æœåŠ¡æ£€æŸ¥
        hasPermission = permissionService.hasPermission(userId, permission);
        
        // 3. ç¼“å­˜ç»“æœ
        permissionCache.put(cacheKey, hasPermission);
        
        return hasPermission;
    }
}
```

### 5.4 æƒé™é…ç½®åŠ¨æ€åŠ è½½


**ğŸ”„ åŠ¨æ€é…ç½®å®ç°**
```java
@Component
public class DynamicPermissionConfig {
    
    @Value("${permission.config.refresh.interval:300}")
    private int refreshInterval; // 5åˆ†é’Ÿåˆ·æ–°ä¸€æ¬¡
    
    private Map<String, PermissionRule> permissionRules = new ConcurrentHashMap<>();
    
    @PostConstruct
    public void init() {
        loadPermissionConfig();
        scheduleConfigRefresh();
    }
    
    /**
     * åŠ è½½æƒé™é…ç½®
     */
    private void loadPermissionConfig() {
        try {
            List<PermissionConfig> configs = permissionConfigRepository.findAll();
            
            Map<String, PermissionRule> newRules = new HashMap<>();
            for (PermissionConfig config : configs) {
                String key = config.getResource() + ":" + config.getAction();
                PermissionRule rule = new PermissionRule(
                    config.getRequiredPermissions(),
                    config.getLogicalType()
                );
                newRules.put(key, rule);
            }
            
            // åŸå­æ€§æ›´æ–°é…ç½®
            this.permissionRules = newRules;
            
            log.info("æƒé™é…ç½®åŠ è½½å®Œæˆï¼Œå…±{}æ¡è§„åˆ™", newRules.size());
        } catch (Exception e) {
            log.error("æƒé™é…ç½®åŠ è½½å¤±è´¥", e);
        }
    }
    
    /**
     * å®šæ—¶åˆ·æ–°é…ç½®
     */
    @Scheduled(fixedDelayString = "${permission.config.refresh.interval:300}000")
    public void scheduleConfigRefresh() {
        loadPermissionConfig();
    }
}
```

---

## 6. ğŸš€ å®è·µåº”ç”¨åœºæ™¯è§£æ


### 6.1 ä¼ä¸šçº§æƒé™ç³»ç»Ÿè®¾è®¡


**ğŸ¢ ä¼ä¸šæƒé™æ¶æ„**
```
ä¼ä¸šçº§æƒé™ç³»ç»Ÿæ¶æ„ï¼š

ç»„ç»‡æ¶æ„å±‚ï¼š
â”œâ”€â”€ é›†å›¢æ€»éƒ¨
â”‚   â”œâ”€â”€ æŠ€æœ¯éƒ¨
â”‚   â”‚   â”œâ”€â”€ å¼€å‘ç»„
â”‚   â”‚   â””â”€â”€ æµ‹è¯•ç»„
â”‚   â””â”€â”€ å¸‚åœºéƒ¨
â”‚       â”œâ”€â”€ é”€å”®ç»„
â”‚       â””â”€â”€ æ¨å¹¿ç»„
â””â”€â”€ åˆ†å…¬å¸A
    â”œâ”€â”€ ä¸šåŠ¡éƒ¨
    â””â”€â”€ è´¢åŠ¡éƒ¨

æƒé™ç»§æ‰¿å…³ç³»ï¼š
ä¸Šçº§æƒé™ â†’ ä¸‹çº§æƒé™
éƒ¨é—¨æƒé™ â†’ ä¸ªäººæƒé™
```

**ğŸ”¸ ä¼ä¸šæƒé™å®ç°**
```java
@Entity
public class Organization {
    private Long orgId;
    private String orgName;
    private String orgCode;
    private Long parentId;          // ä¸Šçº§ç»„ç»‡
    private Integer orgLevel;       // ç»„ç»‡å±‚çº§
    private String orgPath;         // ç»„ç»‡è·¯å¾„ï¼š/1/2/3
}

@Service
public class EnterprisePermissionService {
    
    /**
     * è·å–ç”¨æˆ·åœ¨ç»„ç»‡æ¶æ„ä¸­çš„æƒé™
     */
    public Set<String> getOrgPermissions(Long userId, Long orgId) {
        Set<String> permissions = new HashSet<>();
        
        // 1. è·å–ç”¨æˆ·ç›´æ¥æƒé™
        permissions.addAll(getUserDirectPermissions(userId));
        
        // 2. è·å–ç”¨æˆ·åœ¨è¯¥ç»„ç»‡çš„è§’è‰²æƒé™
        permissions.addAll(getUserOrgRolePermissions(userId, orgId));
        
        // 3. è·å–ç»§æ‰¿çš„ä¸Šçº§ç»„ç»‡æƒé™
        permissions.addAll(getInheritedPermissions(userId, orgId));
        
        return permissions;
    }
}
```

### 6.2 å¤šç§Ÿæˆ·æƒé™éš”ç¦»


**ğŸ  å¤šç§Ÿæˆ·æ¶æ„è®¾è®¡**
```
å¤šç§Ÿæˆ·æƒé™éš”ç¦»ï¼š

ç§Ÿæˆ·Aï¼š
â”œâ”€â”€ ç”¨æˆ·æ•°æ®ï¼štenant_id = A
â”œâ”€â”€ è§’è‰²æ•°æ®ï¼štenant_id = A
â””â”€â”€ æƒé™æ•°æ®ï¼štenant_id = A

ç§Ÿæˆ·Bï¼š
â”œâ”€â”€ ç”¨æˆ·æ•°æ®ï¼štenant_id = B
â”œâ”€â”€ è§’è‰²æ•°æ®ï¼štenant_id = B
â””â”€â”€ æƒé™æ•°æ®ï¼štenant_id = B

éš”ç¦»ç­–ç•¥ï¼š
- æ•°æ®åº“çº§åˆ«ï¼šæ¯ä¸ªç§Ÿæˆ·ç‹¬ç«‹æ•°æ®åº“
- è¡¨çº§åˆ«ï¼šå…±äº«æ•°æ®åº“ï¼Œé€šè¿‡tenant_idåŒºåˆ†
- è¡Œçº§åˆ«ï¼šé€šè¿‡æƒé™æ§åˆ¶è®¿é—®ä¸åŒç§Ÿæˆ·æ•°æ®
```

**ğŸ”¸ å¤šç§Ÿæˆ·æƒé™å®ç°**
```java
@Component
public class MultiTenantPermissionService {
    
    /**
     * ç§Ÿæˆ·æƒé™æ£€æŸ¥
     */
    public boolean checkTenantPermission(Long userId, String tenantId, String permission) {
        // 1. éªŒè¯ç”¨æˆ·æ˜¯å¦å±äºè¯¥ç§Ÿæˆ·
        if (!userBelongsToTenant(userId, tenantId)) {
            return false;
        }
        
        // 2. è·å–ç”¨æˆ·åœ¨è¯¥ç§Ÿæˆ·ä¸‹çš„æƒé™
        Set<String> tenantPermissions = getUserTenantPermissions(userId, tenantId);
        
        // 3. æ£€æŸ¥æ˜¯å¦æ‹¥æœ‰æŒ‡å®šæƒé™
        return tenantPermissions.contains(permission);
    }
    
    /**
     * æ•°æ®è®¿é—®æƒé™è¿‡æ»¤
     */
    @TenantFilter
    public List<Order> getOrders(Long userId) {
        String tenantId = getCurrentTenantId();
        return orderRepository.findByTenantId(tenantId);
    }
}
```

### 6.3 APIç½‘å…³æƒé™é›†æˆ


**ğŸŒ ç½‘å…³æƒé™æµç¨‹**
```
APIç½‘å…³æƒé™éªŒè¯æµç¨‹ï¼š

è¯·æ±‚åˆ°è¾¾ â†’ èº«ä»½éªŒè¯ â†’ æƒé™æ£€æŸ¥ â†’ è·¯ç”±è½¬å‘ â†’ å“åº”è¿”å›
    â†“          â†“          â†“          â†“
1. TokenéªŒè¯  2. è§£æç”¨æˆ·  3. æƒé™åŒ¹é…  4. ä¸šåŠ¡å¤„ç†
2. ç”¨æˆ·è¯†åˆ«  3. è·å–æƒé™  4. é€šè¿‡/æ‹’ç»  5. ç»“æœè¿”å›
```

**ğŸ”¸ ç½‘å…³æƒé™å®ç°**
```java
@Component
public class GatewayPermissionFilter implements GlobalFilter {
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {
        ServerHttpRequest request = exchange.getRequest();
        
        // 1. æå–è®¿é—®Token
        String token = extractToken(request);
        if (StringUtils.isEmpty(token)) {
            return unauthorized(exchange);
        }
        
        // 2. éªŒè¯Tokenå¹¶è·å–ç”¨æˆ·ä¿¡æ¯
        User user = validateTokenAndGetUser(token);
        if (user == null) {
            return unauthorized(exchange);
        }
        
        // 3. æ£€æŸ¥APIè®¿é—®æƒé™
        String path = request.getPath().value();
        String method = request.getMethod().name();
        
        boolean hasPermission = checkApiPermission(user, path, method);
        if (!hasPermission) {
            return forbidden(exchange);
        }
        
        // 4. åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ ç”¨æˆ·ä¿¡æ¯ï¼Œä¼ é€’ç»™ä¸‹æ¸¸æœåŠ¡
        ServerHttpRequest modifiedRequest = request.mutate()
            .header("X-User-Id", user.getUserId().toString())
            .header("X-User-Roles", String.join(",", user.getRoleCodes()))
            .build();
        
        return chain.filter(exchange.mutate().request(modifiedRequest).build());
    }
}
```

### 6.4 ç§»åŠ¨ç«¯æƒé™é€‚é…


**ğŸ“± ç§»åŠ¨ç«¯æƒé™ç‰¹ç‚¹**
```
ç§»åŠ¨ç«¯æƒé™è€ƒè™‘ï¼š

ç½‘ç»œç¯å¢ƒï¼š
- å¼±ç½‘ç»œä¸‹çš„æƒé™ç¼“å­˜
- ç¦»çº¿çŠ¶æ€ä¸‹çš„æƒé™éªŒè¯
- æƒé™æ•°æ®çš„å¢é‡åŒæ­¥

ç”¨æˆ·ä½“éªŒï¼š
- æƒé™é¢„æ£€æŸ¥ï¼Œé¿å…æ“ä½œå¤±è´¥
- èœå•åŠ¨æ€æ˜¾ç¤º/éšè—
- åŠŸèƒ½æŒ‰é’®çš„çŠ¶æ€æ§åˆ¶

å®‰å…¨è¦æ±‚ï¼š
- Tokenè‡ªåŠ¨åˆ·æ–°æœºåˆ¶
- ç”Ÿç‰©è¯†åˆ«æƒé™éªŒè¯
- è®¾å¤‡ç»‘å®šæƒé™æ§åˆ¶
```

**ğŸ”¸ ç§»åŠ¨ç«¯æƒé™å®ç°**
```java
@RestController
@RequestMapping("/api/mobile")
public class MobilePermissionController {
    
    /**
     * è·å–ç”¨æˆ·èœå•æƒé™
     */
    @GetMapping("/menus")
    public List<MenuVO> getUserMenus(@RequestHeader("Authorization") String token) {
        User user = tokenService.parseToken(token);
        Set<String> permissions = permissionService.getUserPermissions(user.getUserId());
        
        // æ ¹æ®æƒé™è¿‡æ»¤èœå•
        List<Menu> allMenus = menuService.getAllMenus();
        return allMenus.stream()
                      .filter(menu -> permissions.contains(menu.getPermissionCode()))
                      .map(this::convertToVO)
                      .collect(Collectors.toList());
    }
    
    /**
     * æƒé™é¢„æ£€æŸ¥
     */
    @PostMapping("/permission/check")
    public PermissionCheckResult checkPermissions(@RequestBody List<String> permissions) {
        User user = getCurrentUser();
        Set<String> userPermissions = permissionService.getUserPermissions(user.getUserId());
        
        Map<String, Boolean> result = permissions.stream()
            .collect(Collectors.toMap(
                permission -> permission,
                userPermissions::contains
            ));
        
        return new PermissionCheckResult(result);
    }
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ RBACæ¨¡å‹ï¼šåŸºäºè§’è‰²çš„æƒé™æ§åˆ¶ï¼Œç”¨æˆ·-è§’è‰²-æƒé™ä¸‰å±‚æ¶æ„
ğŸ”¸ æƒé™å››è¦ç´ ï¼šç”¨æˆ·ã€è§’è‰²ã€èµ„æºã€æ“ä½œçš„ç»„åˆæ§åˆ¶
ğŸ”¸ ç»†ç²’åº¦æ§åˆ¶ï¼šä»æ¨¡å—çº§åˆ°æ•°æ®çº§çš„å¤šå±‚æ¬¡æƒé™ç®¡ç†
ğŸ”¸ æƒé™æ‹¦æˆªï¼šæ³¨è§£ã€æ‹¦æˆªå™¨ã€ç½‘å…³çš„å¤šé‡æƒé™æ£€æŸ¥æœºåˆ¶
ğŸ”¸ ç¼“å­˜ä¼˜åŒ–ï¼šå¤šçº§ç¼“å­˜æå‡æƒé™éªŒè¯æ€§èƒ½
ğŸ”¸ åŠ¨æ€é…ç½®ï¼šæ”¯æŒæƒé™è§„åˆ™çš„åŠ¨æ€åŠ è½½å’Œæ›´æ–°
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ RBACçš„æ ¸å¿ƒä»·å€¼**
```
ç®€åŒ–ç®¡ç†ï¼š
- é€šè¿‡è§’è‰²æ‰¹é‡ç®¡ç†æƒé™ï¼Œå‡å°‘ç®¡ç†å¤æ‚åº¦
- æ ‡å‡†åŒ–æƒé™é…ç½®ï¼Œé¿å…é—æ¼å’Œé”™è¯¯
- æ”¯æŒæƒé™çš„å¿«é€Ÿåˆ†é…å’Œå›æ”¶

æé«˜æ•ˆç‡ï¼š
- æ–°å‘˜å·¥å…¥èŒæ—¶ç›´æ¥åˆ†é…è§’è‰²å³å¯
- æƒé™è°ƒæ•´æ—¶ä¿®æ”¹è§’è‰²å³å¯æ‰¹é‡ç”Ÿæ•ˆ
- æ”¯æŒæƒé™çš„ç»§æ‰¿å’Œç»„åˆ
```

**ğŸ”¹ æƒé™æ§åˆ¶çš„å±‚æ¬¡æ€§**
```
æ¥å£çº§æ§åˆ¶ï¼š
- æ§åˆ¶å“ªäº›æ¥å£å¯ä»¥è®¿é—®
- æœ€ç²—ç²’åº¦çš„æƒé™æ§åˆ¶

åŠŸèƒ½çº§æ§åˆ¶ï¼š
- æ§åˆ¶å…·ä½“åŠŸèƒ½çš„ä½¿ç”¨æƒé™
- æ›´ç»†è‡´çš„æƒé™åˆ’åˆ†

æ•°æ®çº§æ§åˆ¶ï¼š
- æ§åˆ¶èƒ½è®¿é—®å“ªäº›å…·ä½“æ•°æ®
- æœ€ç»†ç²’åº¦çš„æƒé™æ§åˆ¶
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–çš„é‡è¦æ€§**
```
æƒé™æ£€æŸ¥é¢‘ç‡ï¼š
- æ¯ä¸ªæ¥å£è¯·æ±‚éƒ½éœ€è¦æƒé™éªŒè¯
- é«˜å¹¶å‘ä¸‹æƒé™æ£€æŸ¥æˆä¸ºæ€§èƒ½ç“¶é¢ˆ

ä¼˜åŒ–ç­–ç•¥ï¼š
- å¤šçº§ç¼“å­˜å‡å°‘æ•°æ®åº“è®¿é—®
- æœ¬åœ°ç¼“å­˜æå‡æ£€æŸ¥é€Ÿåº¦
- æ‰¹é‡æƒé™éªŒè¯å‡å°‘ç½‘ç»œå¼€é”€
```

### 7.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ é€‚ç”¨åœºæ™¯é€‰æ‹©**
```
ç®€å•åº”ç”¨ï¼š
âœ… ç”¨æˆ·æ•°é‡å°‘ï¼ˆ<1000ï¼‰
âœ… æƒé™ç›¸å¯¹å›ºå®š
âœ… ä½¿ç”¨åŸºç¡€RBACå³å¯

ä¸­ç­‰åº”ç”¨ï¼š
âœ… ç”¨æˆ·æ•°é‡ä¸­ç­‰ï¼ˆ1000-10000ï¼‰
âœ… éœ€è¦æ•°æ®çº§æƒé™æ§åˆ¶
âœ… éœ€è¦æƒé™ç¼“å­˜ä¼˜åŒ–

å¤æ‚åº”ç”¨ï¼š
âœ… å¤§é‡ç”¨æˆ·ï¼ˆ>10000ï¼‰
âœ… å¤šç§Ÿæˆ·æ¶æ„
âœ… éœ€è¦åŠ¨æ€æƒé™é…ç½®
```

**ğŸ”§ å®æ–½å»ºè®®**
```
è®¾è®¡é˜¶æ®µï¼š
- å……åˆ†åˆ†æä¸šåŠ¡éœ€æ±‚ï¼Œåˆç†è®¾è®¡è§’è‰²ä½“ç³»
- è€ƒè™‘æƒé™çš„æ‰©å±•æ€§å’Œçµæ´»æ€§
- è®¾è®¡å¥½æƒé™ç¼–ç è§„èŒƒ

å¼€å‘é˜¶æ®µï¼š
- ä½¿ç”¨æ³¨è§£ç®€åŒ–æƒé™æ§åˆ¶ä»£ç 
- å®ç°å¤šçº§ç¼“å­˜æå‡æ€§èƒ½
- æ·»åŠ æƒé™å˜æ›´çš„ç›‘æ§å’Œæ—¥å¿—

è¿ç»´é˜¶æ®µï¼š
- ç›‘æ§æƒé™æ£€æŸ¥çš„æ€§èƒ½æŒ‡æ ‡
- å®šæœŸå®¡è®¡æƒé™åˆ†é…çš„åˆç†æ€§
- å»ºç«‹æƒé™å˜æ›´çš„å®¡æ‰¹æµç¨‹
```

### 7.4 å¸¸è§é—®é¢˜é¿å…


```
è®¾è®¡é—®é¢˜ï¼š
âŒ è§’è‰²è®¾è®¡è¿‡äºå¤æ‚ï¼Œéš¾ä»¥ç®¡ç†
âŒ æƒé™ç²’åº¦è¿‡ç»†ï¼Œå½±å“æ€§èƒ½
âŒ ç¼ºä¹æƒé™ç»§æ‰¿æœºåˆ¶

å®ç°é—®é¢˜ï¼š
âŒ æƒé™æ£€æŸ¥é€»è¾‘åˆ†æ•£ï¼Œéš¾ä»¥ç»´æŠ¤
âŒ ç¼ºä¹æƒé™ç¼“å­˜ï¼Œæ€§èƒ½è¾ƒå·®
âŒ æƒé™å˜æ›´æ²¡æœ‰åŠæ—¶æ¸…é™¤ç¼“å­˜

å®‰å…¨é—®é¢˜ï¼š
âŒ æƒé™æ£€æŸ¥ä¸å¤Ÿä¸¥æ ¼ï¼Œå­˜åœ¨ç»•è¿‡é£é™©
âŒ æƒé™ä¿¡æ¯åœ¨å‰ç«¯æš´éœ²è¿‡å¤š
âŒ ç¼ºä¹æƒé™æ“ä½œçš„å®¡è®¡æ—¥å¿—
```

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- RBACè®©æƒé™ç®¡ç†åƒå…¬å¸èŒä½ä½“ç³»ä¸€æ ·æ¸…æ™°
- æƒé™æ§åˆ¶è¦ä»æ¥å£ã€åŠŸèƒ½ã€æ•°æ®ä¸‰ä¸ªå±‚æ¬¡è€ƒè™‘
- æ€§èƒ½ä¼˜åŒ–é€šè¿‡ç¼“å­˜ç­–ç•¥è§£å†³é«˜é¢‘æƒé™æ£€æŸ¥é—®é¢˜
- å®é™…åº”ç”¨è¦æ ¹æ®ä¸šåŠ¡å¤æ‚åº¦é€‰æ‹©åˆé€‚çš„å®ç°æ–¹æ¡ˆ