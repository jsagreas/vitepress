---
title: 2ã€å‰ç«¯ä»£ç å®‰å…¨æœ€ä½³å®è·µ
---
## ğŸ“š ç›®å½•

1. [å‰ç«¯å®‰å…¨æ¦‚è¿°](#1-å‰ç«¯å®‰å…¨æ¦‚è¿°)
2. [è¾“å…¥å®‰å…¨åŸåˆ™](#2-è¾“å…¥å®‰å…¨åŸåˆ™)
3. [è¾“å‡ºç¼–ç è§„èŒƒ](#3-è¾“å‡ºç¼–ç è§„èŒƒ)
4. [å‰ç«¯åŠ å¯†ä½¿ç”¨è¯¯åŒº](#4-å‰ç«¯åŠ å¯†ä½¿ç”¨è¯¯åŒº)
5. [å®‰å…¨ç¼–ç å»ºè®®](#5-å®‰å…¨ç¼–ç å»ºè®®)
6. [å‰ç«¯å®‰å…¨æ£€æŸ¥æ¸…å•](#6-å‰ç«¯å®‰å…¨æ£€æŸ¥æ¸…å•)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ›¡ï¸ å‰ç«¯å®‰å…¨æ¦‚è¿°


### 1.1 ä¸ºä»€ä¹ˆå‰ç«¯å®‰å…¨å¦‚æ­¤é‡è¦


**ç°å®èƒŒæ™¯**ï¼šå‰ç«¯ä»£ç ç›´æ¥è¿è¡Œåœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­ï¼Œé¢ä¸´å„ç§å®‰å…¨å¨èƒ

```
ä¼ ç»Ÿå®‰å…¨è§‚å¿µï¼š                ç°ä»£å®‰å…¨ç°å®ï¼š
"å‰ç«¯ä¸é‡è¦ï¼Œåæ­£çœ‹å¾—è§"  â†’   "å‰ç«¯æ˜¯ç¬¬ä¸€é“é˜²çº¿"
"åç«¯éªŒè¯å°±å¤Ÿäº†"         â†’   "å‰åç«¯éƒ½è¦é˜²æŠ¤"
"åŠ å¯†åœ¨åç«¯åš"           â†’   "å‰ç«¯ä¹Ÿè¦æ‡‚å®‰å…¨åŸç†"
```

**ğŸ”¥ å‰ç«¯é¢ä¸´çš„ä¸»è¦å¨èƒ**
```
XSSæ”»å‡»ï¼šæ¶æ„è„šæœ¬æ³¨å…¥
CSRFæ”»å‡»ï¼šè·¨ç«™è¯·æ±‚ä¼ªé€   
ç‚¹å‡»åŠ«æŒï¼šç•Œé¢æ¬ºéª—
æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼šä»£ç ä¸­çš„ç§˜å¯†
ä¾›åº”é“¾æ”»å‡»ï¼šç¬¬ä¸‰æ–¹åº“é£é™©
```

### 1.2 å‰ç«¯å®‰å…¨çš„æ ¸å¿ƒæ€æƒ³


**ğŸ¯ å®‰å…¨ä¸‰åŸåˆ™**
- **æœ€å°æƒé™**ï¼šåªç»™å¿…è¦çš„æƒé™ï¼Œä¸å¤šç»™ä¸€ç‚¹
- **çºµæ·±é˜²å¾¡**ï¼šå¤šå±‚é˜²æŠ¤ï¼Œä¸ä¾èµ–å•ä¸€é˜²çº¿
- **é›¶ä¿¡ä»»**ï¼šä¸ä¿¡ä»»ä»»ä½•è¾“å…¥ï¼ŒéªŒè¯ä¸€åˆ‡

**ğŸ’¡ é€šä¿—ç†è§£**
```
å°±åƒé˜²ç›—ä¸€æ ·ï¼š
ğŸ  é—¨é”ï¼ˆè¾“å…¥éªŒè¯ï¼‰
ğŸšª é˜²ç›—é—¨ï¼ˆè¾“å‡ºç¼–ç ï¼‰
ğŸ“¹ ç›‘æ§ï¼ˆæ—¥å¿—è®°å½•ï¼‰
ğŸš¨ æŠ¥è­¦ï¼ˆå¼‚å¸¸æ£€æµ‹ï¼‰
```

---

## 2. ğŸ” è¾“å…¥å®‰å…¨åŸåˆ™


### 2.1 ä¸ä¿¡ä»»ä»»ä½•è¾“å…¥


**ğŸš¨ æ ¸å¿ƒåŸåˆ™**ï¼šæ°¸è¿œä¸è¦ç›¸ä¿¡ç”¨æˆ·è¾“å…¥çš„ä»»ä½•æ•°æ®

**ä¸ºä»€ä¹ˆä¸èƒ½ä¿¡ä»»ï¼Ÿ**
```
ç”¨æˆ·å¯èƒ½ï¼š
âŒ æ¶æ„è¾“å…¥ï¼š<script>alert('XSS')</script>
âŒ é”™è¯¯è¾“å…¥ï¼šå¹´é¾„è¾“å…¥-100å²
âŒ å¼‚å¸¸è¾“å…¥ï¼šä¸Šä¼ ç—…æ¯’æ–‡ä»¶
âŒ è¶…é•¿è¾“å…¥ï¼šæ•…æ„é€ æˆç¨‹åºå´©æºƒ

ç³»ç»Ÿå¯èƒ½ï¼š
âŒ æ•°æ®ä¼ è¾“é”™è¯¯ï¼šç½‘ç»œé—®é¢˜å¯¼è‡´æ•°æ®æŸå
âŒ ç¬¬ä¸‰æ–¹æ¥å£ï¼šè¿”å›æ„å¤–æ ¼å¼æ•°æ®
âŒ ç¼“å­˜é—®é¢˜ï¼šè¿‡æœŸæˆ–æŸåçš„æ•°æ®
```

### 2.2 è¾“å…¥æ ¡éªŒå®æˆ˜


**ğŸ”§ å‰ç«¯æ ¡éªŒç­–ç•¥**

```javascript
// âœ… æ­£ç¡®çš„è¾“å…¥æ ¡éªŒ
class InputValidator {
    // æ ¡éªŒé‚®ç®±æ ¼å¼
    static validateEmail(email) {
        if (!email || typeof email !== 'string') {
            return { valid: false, error: 'é‚®ç®±ä¸èƒ½ä¸ºç©º' };
        }
        
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
            return { valid: false, error: 'é‚®ç®±æ ¼å¼ä¸æ­£ç¡®' };
        }
        
        return { valid: true };
    }
    
    // æ ¡éªŒç”¨æˆ·åï¼ˆåªå…è®¸å­—æ¯æ•°å­—ä¸‹åˆ’çº¿ï¼‰
    static validateUsername(username) {
        if (!username || username.length < 3 || username.length > 20) {
            return { valid: false, error: 'ç”¨æˆ·åé•¿åº¦3-20ä½' };
        }
        
        const usernameRegex = /^[a-zA-Z0-9_]+$/;
        if (!usernameRegex.test(username)) {
            return { valid: false, error: 'ç”¨æˆ·ååªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿' };
        }
        
        return { valid: true };
    }
}

// ä½¿ç”¨ç¤ºä¾‹
const emailResult = InputValidator.validateEmail(userInput);
if (!emailResult.valid) {
    showError(emailResult.error);
    return;
}
```

### 2.3 ç™½åå•ç­–ç•¥


**ğŸ’¡ ç™½åå• vs é»‘åå•**

| ç­–ç•¥ç±»å‹ | **åŸç†** | **å®‰å…¨æ€§** | **ç»´æŠ¤æˆæœ¬** | **æ¨èåº¦** |
|---------|---------|-----------|-------------|-----------|
| ğŸŸ¢ **ç™½åå•** | `åªå…è®¸æ˜ç¡®å®‰å…¨çš„å†…å®¹` | `æé«˜` | `ä¸­ç­‰` | `å¼ºçƒˆæ¨è` |
| ğŸ”´ **é»‘åå•** | `ç¦æ­¢å·²çŸ¥å±é™©çš„å†…å®¹` | `è¾ƒä½` | `æé«˜` | `ä¸æ¨è` |

**ğŸ¯ ç™½åå•å®è·µ**
```javascript
// âœ… ç™½åå•ï¼šåªå…è®¸å®‰å…¨å­—ç¬¦
function sanitizeInput(input) {
    // åªä¿ç•™å­—æ¯ã€æ•°å­—ã€ç©ºæ ¼ã€å¸¸ç”¨æ ‡ç‚¹
    return input.replace(/[^a-zA-Z0-9\s\.,!?-]/g, '');
}

// âœ… æ–‡ä»¶ä¸Šä¼ ç™½åå•
const ALLOWED_FILE_TYPES = ['.jpg', '.png', '.gif', '.pdf'];
function validateFileType(filename) {
    const ext = filename.toLowerCase().substring(filename.lastIndexOf('.'));
    return ALLOWED_FILE_TYPES.includes(ext);
}

// âŒ é»‘åå•æ–¹å¼ï¼ˆå®¹æ˜“è¢«ç»•è¿‡ï¼‰
function badSanitize(input) {
    // è¯•å›¾è¿‡æ»¤å±é™©å†…å®¹ï¼Œä½†æ€»æœ‰é—æ¼
    return input.replace(/<script>/gi, '').replace(/javascript:/gi, '');
}
```

### 2.4 å®ç”¨æ ¡éªŒå·¥å…·


**ğŸ“¦ æ¨èçš„æ ¡éªŒåº“**
```javascript
// ä½¿ç”¨ validator.js åº“
import validator from 'validator';

// é‚®ç®±æ ¡éªŒ
if (!validator.isEmail(email)) {
    throw new Error('é‚®ç®±æ ¼å¼é”™è¯¯');
}

// URLæ ¡éªŒ
if (!validator.isURL(url)) {
    throw new Error('URLæ ¼å¼é”™è¯¯');
}

// æ‰‹æœºå·æ ¡éªŒï¼ˆä¸­å›½ï¼‰
if (!validator.isMobilePhone(phone, 'zh-CN')) {
    throw new Error('æ‰‹æœºå·æ ¼å¼é”™è¯¯');
}
```

---

## 3. ğŸ”’ è¾“å‡ºç¼–ç è§„èŒƒ


### 3.1 ä¸ºä»€ä¹ˆéœ€è¦è¾“å‡ºç¼–ç 


**ğŸš¨ é—®é¢˜åœºæ™¯**ï¼šç”¨æˆ·è¾“å…¥åŒ…å«ç‰¹æ®Šå­—ç¬¦æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

```html
<!-- ç”¨æˆ·è¾“å…¥ï¼š<script>alert('XSS')</script> -->
<!-- âŒ ç›´æ¥è¾“å‡ºï¼ˆå±é™©ï¼ï¼‰ -->
<div>ç”¨æˆ·è¯´ï¼š<script>alert('XSS')</script></div>
<!-- ç»“æœï¼šè„šæœ¬è¢«æ‰§è¡Œï¼ -->

<!-- âœ… æ­£ç¡®ç¼–ç åè¾“å‡º -->
<div>ç”¨æˆ·è¯´ï¼š&lt;script&gt;alert('XSS')&lt;/script&gt;</div>
<!-- ç»“æœï¼šæ˜¾ç¤ºä¸ºæ–‡æœ¬ï¼Œä¸æ‰§è¡Œ -->
```

### 3.2 HTMLç¼–ç å®è·µ


**ğŸ› ï¸ HTMLå­—ç¬¦ç¼–ç **

```javascript
// HTMLç¼–ç å‡½æ•°
function htmlEncode(str) {
    const div = document.createElement('div');
    div.textContent = str;
    return div.innerHTML;
}

// æˆ–è€…æ‰‹åŠ¨ç¼–ç 
function htmlEncodeManual(str) {
    return str
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#x27;');
}

// ä½¿ç”¨ç¤ºä¾‹
const userInput = '<script>alert("hack")</script>';
const safeOutput = htmlEncode(userInput);
// ç»“æœï¼š&lt;script&gt;alert(&quot;hack&quot;)&lt;/script&gt;
```

**ğŸ“‹ å¸¸è§å­—ç¬¦ç¼–ç å¯¹ç…§è¡¨**

| åŸå­—ç¬¦ | **HTMLç¼–ç ** | **è¯´æ˜** |
|-------|-------------|---------|
| `<` | `&lt;` | `å°äºå·ï¼Œé˜²æ­¢æ ‡ç­¾æ³¨å…¥` |
| `>` | `&gt;` | `å¤§äºå·ï¼Œé˜²æ­¢æ ‡ç­¾é—­åˆ` |
| `&` | `&amp;` | `å’Œå·ï¼Œé˜²æ­¢å®ä½“æ³¨å…¥` |
| `"` | `&quot;` | `åŒå¼•å·ï¼Œé˜²æ­¢å±æ€§æ³¨å…¥` |
| `'` | `&#x27;` | `å•å¼•å·ï¼Œé˜²æ­¢å±æ€§æ³¨å…¥` |

### 3.3 JavaScriptç¼–ç 


**âš ï¸ åŠ¨æ€ç”ŸæˆJavaScriptçš„é£é™©**

```javascript
// âŒ å±é™©ï¼šç›´æ¥æ‹¼æ¥ç”¨æˆ·è¾“å…¥åˆ°JSä»£ç 
function badExample(userInput) {
    const script = `
        var message = "${userInput}";
        alert(message);
    `;
    eval(script); // éå¸¸å±é™©ï¼
}

// âœ… å®‰å…¨ï¼šä½¿ç”¨JSON.stringifyç¼–ç 
function safeExample(userInput) {
    const script = `
        var message = ${JSON.stringify(userInput)};
        alert(message);
    `;
    // ä»ç„¶ä¸æ¨èevalï¼Œä½†è‡³å°‘è¾“å…¥æ˜¯å®‰å…¨çš„
}

// âœ… æœ€ä½³ï¼šé¿å…åŠ¨æ€ç”Ÿæˆä»£ç 
function bestExample(userInput) {
    // ç›´æ¥ä½¿ç”¨å˜é‡ï¼Œä¸ç”Ÿæˆä»£ç 
    alert(userInput);
}
```

### 3.4 é¿å…DOM XSS


**ğŸ¯ DOM XSSçš„å¸¸è§åœºæ™¯**

```javascript
// âŒ å±é™©ï¼šinnerHTMLç›´æ¥æ’å…¥ç”¨æˆ·æ•°æ®
function displayMessage(message) {
    document.getElementById('output').innerHTML = message;
    // å¦‚æœmessageåŒ…å«<script>ï¼Œä¼šè¢«æ‰§è¡Œï¼
}

// âœ… å®‰å…¨ï¼šä½¿ç”¨textContent
function safeDisplayMessage(message) {
    document.getElementById('output').textContent = message;
    // ä¼šæ˜¾ç¤ºä¸ºçº¯æ–‡æœ¬ï¼Œä¸ä¼šæ‰§è¡Œè„šæœ¬
}

// âœ… æ›´å®‰å…¨ï¼šä½¿ç”¨createElement
function createElement(tag, text) {
    const element = document.createElement(tag);
    element.textContent = text; // è‡ªåŠ¨ç¼–ç 
    return element;
}
```

**ğŸ“ Vue/Reactä¸­çš„æœ€ä½³å®è·µ**

```javascript
// Vue.js - è‡ªåŠ¨è½¬ä¹‰
<template>
  <!-- âœ… è‡ªåŠ¨HTMLç¼–ç  -->
  <div>{{ userMessage }}</div>
  
  <!-- âŒ å±é™©ï¼šè·³è¿‡ç¼–ç  -->
  <div v-html="userMessage"></div>
</template>

// React - è‡ªåŠ¨è½¬ä¹‰
function MyComponent({ userMessage }) {
  return (
    <div>
      {/* âœ… è‡ªåŠ¨HTMLç¼–ç  */}
      {userMessage}
      
      {/* âŒ å±é™©ï¼šè·³è¿‡ç¼–ç  */}
      <div dangerouslySetInnerHTML={{__html: userMessage}} />
    </div>
  );
}
```

---

## 4. ğŸ”‘ å‰ç«¯åŠ å¯†ä½¿ç”¨è¯¯åŒº


### 4.1 å®¢æˆ·ç«¯åŠ å¯†çš„å±€é™æ€§


**ğŸ’¡ é‡è¦è®¤çŸ¥**ï¼šå®¢æˆ·ç«¯ä»£ç å¯¹ç”¨æˆ·å®Œå…¨é€æ˜ï¼

```
å¸¸è§è¯¯åŒºï¼š                     å®é™…æƒ…å†µï¼š
"å‰ç«¯åŠ å¯†å¾ˆå®‰å…¨"           â†’   "ç”¨æˆ·å¯ä»¥çœ‹åˆ°æ‰€æœ‰ä»£ç "
"å¯†é’¥å†™åœ¨å‰ç«¯æ²¡é—®é¢˜"       â†’   "å¯†é’¥å®Œå…¨æš´éœ²"
"å‰ç«¯åŠ å¯†å¯ä»¥ä¿æŠ¤æ•°æ®"     â†’   "åªèƒ½é˜²æ­¢ä¼ è¾“çªƒå¬"
```

**ğŸ” å®¢æˆ·ç«¯ä»£ç çš„é€æ˜æ€§**
```javascript
// âŒ é”™è¯¯æƒ³æ³•ï¼šè¿™æ ·å¾ˆå®‰å…¨
const SECRET_KEY = 'my-super-secret-key'; // ç”¨æˆ·F12å°±èƒ½çœ‹åˆ°ï¼
function encrypt(data) {
    return CryptoJS.AES.encrypt(data, SECRET_KEY).toString();
}

// ç”¨æˆ·åªéœ€è¦ï¼š
// 1. æŒ‰F12æ‰“å¼€å¼€å‘è€…å·¥å…·
// 2. æŸ¥çœ‹Sourcesæˆ–Console
// 3. å°±èƒ½çœ‹åˆ°SECRET_KEYçš„å€¼ï¼
```

### 4.2 å‰ç«¯åŠ å¯†çš„æ­£ç¡®ç”¨é€”


**âœ… åˆç†çš„å‰ç«¯åŠ å¯†åœºæ™¯**

```javascript
// 1. ä¼ è¾“åŠ å¯†ï¼ˆé˜²æ­¢ç½‘ç»œçªƒå¬ï¼‰
function secureTransmit(password) {
    // ä½¿ç”¨æœåŠ¡å™¨å…¬é’¥åŠ å¯†å¯†ç 
    const publicKey = await getServerPublicKey();
    const encryptedPassword = RSA.encrypt(password, publicKey);
    
    return fetch('/login', {
        method: 'POST',
        body: JSON.stringify({ password: encryptedPassword })
    });
}

// 2. æœ¬åœ°æ•°æ®ä¿æŠ¤ï¼ˆé˜²æ­¢ç®€å•æŸ¥çœ‹ï¼‰
function saveToLocalStorage(data) {
    // ç®€å•æ··æ·†ï¼Œä¸æ˜¯çœŸæ­£çš„å®‰å…¨
    const obfuscated = btoa(JSON.stringify(data));
    localStorage.setItem('user_data', obfuscated);
}
```

### 4.3 ä¸èƒ½æ›¿ä»£æœåŠ¡ç«¯éªŒè¯


**ğŸš¨ å…³é”®åŸåˆ™**ï¼šå‰ç«¯çš„ä¸€åˆ‡éªŒè¯éƒ½å¯ä»¥è¢«ç»•è¿‡ï¼

```
å‰ç«¯éªŒè¯çš„é—®é¢˜ï¼š
1. ç”¨æˆ·å¯ä»¥ç¦ç”¨JavaScript      â†’ ç»•è¿‡æ‰€æœ‰å‰ç«¯é€»è¾‘
2. ç”¨æˆ·å¯ä»¥ä¿®æ”¹å‰ç«¯ä»£ç         â†’ æ”¹å˜éªŒè¯é€»è¾‘
3. ç”¨æˆ·å¯ä»¥ç›´æ¥è°ƒç”¨API        â†’ è·³è¿‡å‰ç«¯ç•Œé¢
4. è‡ªåŠ¨åŒ–å·¥å…·å¯ä»¥æ¨¡æ‹Ÿè¯·æ±‚      â†’ æ‰¹é‡æ”»å‡»
```

**ğŸ”„ æ­£ç¡®çš„éªŒè¯ç­–ç•¥**
```javascript
// âœ… å‰ç«¯éªŒè¯ï¼šæå‡ç”¨æˆ·ä½“éªŒ
function frontendValidation(email) {
    if (!isValidEmail(email)) {
        showError('é‚®ç®±æ ¼å¼ä¸æ­£ç¡®');
        return false;
    }
    return true;
}

// âœ… åç«¯éªŒè¯ï¼šçœŸæ­£çš„å®‰å…¨ä¿éšœ
app.post('/register', (req, res) => {
    const { email } = req.body;
    
    // å¿…é¡»é‡æ–°éªŒè¯ï¼ä¸èƒ½ä¿¡ä»»å‰ç«¯
    if (!isValidEmail(email)) {
        return res.status(400).json({ error: 'é‚®ç®±æ ¼å¼ä¸æ­£ç¡®' });
    }
    
    // ç»§ç»­å¤„ç†...
});
```

### 4.4 å¯†é’¥ç®¡ç†æœ€ä½³å®è·µ


**ğŸ” å®‰å…¨çš„å¯†é’¥å¤„ç†**

```javascript
// âŒ é”™è¯¯ï¼šç¡¬ç¼–ç å¯†é’¥
const API_KEY = 'sk-1234567890abcdef'; // æš´éœ²åœ¨ä»£ç ä¸­

// âœ… æ­£ç¡®ï¼šæœåŠ¡å™¨ä»£ç†
// å‰ç«¯ä¸å­˜å‚¨æ•æ„Ÿå¯†é’¥ï¼Œé€šè¿‡åç«¯APIè°ƒç”¨ç¬¬ä¸‰æ–¹æœåŠ¡
async function callThirdPartyAPI(data) {
    return fetch('/api/proxy/third-party', {
        method: 'POST',
        headers: {
            'Authorization': `Bearer ${userToken}` // ç”¨æˆ·tokenï¼Œä¸æ˜¯ç¬¬ä¸‰æ–¹å¯†é’¥
        },
        body: JSON.stringify(data)
    });
}

// åç«¯ä»£ç†
app.post('/api/proxy/third-party', authenticateUser, (req, res) => {
    // åœ¨æœåŠ¡å™¨ç«¯ä½¿ç”¨çœŸæ­£çš„APIå¯†é’¥
    const response = await thirdPartyAPI.call(req.body, process.env.THIRD_PARTY_API_KEY);
    res.json(response);
});
```

---

## 5. ğŸ› ï¸ å®‰å…¨ç¼–ç å»ºè®®


### 5.1 Vueé¡¹ç›®å®‰å…¨å¼€å‘å®è·µ


**ğŸ¯ Vueå®‰å…¨é…ç½®**

```javascript
// vue.config.js - å®‰å…¨é…ç½®
module.exports = {
    // ç¦ç”¨æºç æ˜ å°„ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
    productionSourceMap: false,
    
    // CSPé…ç½®
    chainWebpack: config => {
        config.plugin('html').tap(args => {
            args[0].meta = {
                'Content-Security-Policy': "default-src 'self'; script-src 'self'"
            };
            return args;
        });
    }
};

// è·¯ç”±å®ˆå« - æƒé™æ§åˆ¶
router.beforeEach((to, from, next) => {
    const token = localStorage.getItem('token');
    
    if (to.meta.requiresAuth && !token) {
        next('/login');
    } else if (token && !isTokenValid(token)) {
        localStorage.removeItem('token');
        next('/login');
    } else {
        next();
    }
});
```

**ğŸ”’ Vueç»„ä»¶å®‰å…¨å®è·µ**

```vue
<template>
  <div>
    <!-- âœ… è‡ªåŠ¨è½¬ä¹‰ç”¨æˆ·è¾“å…¥ -->
    <h1>{{ userTitle }}</h1>
    
    <!-- âœ… å±æ€§ç»‘å®šä¹Ÿæ˜¯å®‰å…¨çš„ -->
    <img :src="userAvatar" :alt="userName">
    
    <!-- âŒ é¿å…v-htmlï¼Œé™¤éç»å¯¹å¿…è¦ -->
    <div v-html="trustedContent"></div>
    
    <!-- âœ… å¦‚æœå¿…é¡»ä½¿ç”¨v-htmlï¼Œå…ˆsanitize -->
    <div v-html="sanitizedContent"></div>
  </div>
</template>

<script>
import DOMPurify from 'dompurify';

export default {
  computed: {
    sanitizedContent() {
      // ä½¿ç”¨DOMPurifyæ¸…ç†HTML
      return DOMPurify.sanitize(this.rawContent);
    }
  },
  
  methods: {
    // å®‰å…¨çš„APIè°ƒç”¨
    async fetchUserData() {
      try {
        const response = await this.$http.get('/api/user', {
          headers: {
            'Authorization': `Bearer ${this.$store.state.token}`
          }
        });
        
        // éªŒè¯å“åº”æ•°æ®
        if (!this.validateUserData(response.data)) {
          throw new Error('Invalid user data received');
        }
        
        return response.data;
      } catch (error) {
        console.error('Failed to fetch user data:', error);
        // ä¸è¦åœ¨æ§åˆ¶å°è¾“å‡ºæ•æ„Ÿä¿¡æ¯
        this.$message.error('è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥');
      }
    }
  }
};
</script>
```

### 5.2 Reacté¡¹ç›®å®‰å…¨å¼€å‘å®è·µ


**âš›ï¸ Reactå®‰å…¨ç»„ä»¶**

```javascript
import React, { useState, useEffect } from 'react';
import DOMPurify from 'dompurify';

// å®‰å…¨çš„ç”¨æˆ·è¾“å…¥ç»„ä»¶
function SecureInput({ onSubmit }) {
    const [input, setInput] = useState('');
    const [error, setError] = useState('');
    
    const validateInput = (value) => {
        if (value.length > 1000) {
            return 'è¾“å…¥å†…å®¹è¿‡é•¿';
        }
        
        // æ£€æŸ¥æ˜¯å¦åŒ…å«å¯ç–‘å†…å®¹
        if (/<script|javascript:|on\w+=/i.test(value)) {
            return 'è¾“å…¥å†…å®¹åŒ…å«ä¸å®‰å…¨å­—ç¬¦';
        }
        
        return null;
    };
    
    const handleSubmit = (e) => {
        e.preventDefault();
        
        const validationError = validateInput(input);
        if (validationError) {
            setError(validationError);
            return;
        }
        
        // æ¸…ç†è¾“å…¥
        const cleanInput = DOMPurify.sanitize(input);
        onSubmit(cleanInput);
        setInput('');
        setError('');
    };
    
    return (
        <form onSubmit={handleSubmit}>
            <textarea
                value={input}
                onChange={(e) => setInput(e.target.value)}
                placeholder="è¯·è¾“å…¥å†…å®¹..."
                maxLength={1000}
            />
            {error && <div className="error">{error}</div>}
            <button type="submit">æäº¤</button>
        </form>
    );
}

// å®‰å…¨çš„ç”¨æˆ·å†…å®¹æ˜¾ç¤ºç»„ä»¶
function UserContent({ content, allowHTML = false }) {
    if (allowHTML) {
        // åªæœ‰åœ¨æ˜ç¡®å…è®¸HTMLä¸”å†…å®¹å¯ä¿¡æ—¶æ‰ä½¿ç”¨
        const cleanHTML = DOMPurify.sanitize(content);
        return <div dangerouslySetInnerHTML={{ __html: cleanHTML }} />;
    }
    
    // é»˜è®¤æƒ…å†µä¸‹æ˜¾ç¤ºä¸ºçº¯æ–‡æœ¬
    return <div>{content}</div>;
}
```

### 5.3 é€šç”¨å®‰å…¨ç¼–ç è§„èŒƒ


**ğŸ“ å®‰å…¨ä»£ç æ¸…å•**

```javascript
// âœ… 1. è¾“å…¥éªŒè¯
function secureFunction(userInput) {
    // ç±»å‹æ£€æŸ¥
    if (typeof userInput !== 'string') {
        throw new Error('Invalid input type');
    }
    
    // é•¿åº¦é™åˆ¶
    if (userInput.length > MAX_LENGTH) {
        throw new Error('Input too long');
    }
    
    // æ ¼å¼éªŒè¯
    if (!VALID_PATTERN.test(userInput)) {
        throw new Error('Invalid input format');
    }
    
    // ç»§ç»­å¤„ç†...
}

// âœ… 2. é”™è¯¯å¤„ç†
async function safeApiCall() {
    try {
        const response = await fetch('/api/data');
        
        if (!response.ok) {
            throw new Error(`HTTP ${response.status}`);
        }
        
        const data = await response.json();
        return validateApiResponse(data) ? data : null;
        
    } catch (error) {
        // è®°å½•é”™è¯¯ä½†ä¸æš´éœ²æ•æ„Ÿä¿¡æ¯
        console.error('API call failed:', error.message);
        throw new Error('æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åé‡è¯•');
    }
}

// âœ… 3. æ•æ„Ÿä¿¡æ¯ä¿æŠ¤
function logUserAction(action, user) {
    // ä¸è¦è®°å½•æ•æ„Ÿä¿¡æ¯
    console.log('User action:', {
        action,
        userId: user.id, // âœ… åªè®°å½•ID
        // password: user.password, // âŒ ä¸è¦è®°å½•å¯†ç 
        timestamp: new Date().toISOString()
    });
}
```

---

## 6. âœ… å‰ç«¯å®‰å…¨æ£€æŸ¥æ¸…å•


### 6.1 ä»£ç å®¡æŸ¥è¦ç‚¹


**ğŸ” å®‰å…¨ä»£ç å®¡æŸ¥æ¸…å•**

<details>
<summary>ğŸ“‹ ç‚¹å‡»å±•å¼€å®Œæ•´æ£€æŸ¥æ¸…å•</summary>

**è¾“å…¥éªŒè¯æ£€æŸ¥**
- [ ] æ‰€æœ‰ç”¨æˆ·è¾“å…¥éƒ½è¿›è¡Œäº†éªŒè¯
- [ ] ä½¿ç”¨ç™½åå•è€Œéé»‘åå•ç­–ç•¥
- [ ] æ–‡ä»¶ä¸Šä¼ æœ‰ç±»å‹å’Œå¤§å°é™åˆ¶
- [ ] URLå‚æ•°å¾—åˆ°éªŒè¯
- [ ] Cookieå’ŒlocalStorageæ•°æ®å¾—åˆ°éªŒè¯

**è¾“å‡ºç¼–ç æ£€æŸ¥**
- [ ] ç”¨æˆ·æ•°æ®è¾“å‡ºå‰éƒ½è¿›è¡Œäº†ç¼–ç 
- [ ] é¿å…ä½¿ç”¨innerHTMLã€v-htmlç­‰å±é™©API
- [ ] åŠ¨æ€ç”Ÿæˆçš„URLå¾—åˆ°æ­£ç¡®ç¼–ç 
- [ ] JSONæ•°æ®ä½¿ç”¨JSON.stringify()
- [ ] é¿å…eval()å’ŒFunction()æ„é€ å™¨

**è®¤è¯æˆæƒæ£€æŸ¥**
- [ ] æ•æ„Ÿæ“ä½œéœ€è¦é‡æ–°éªŒè¯
- [ ] Tokenæœ‰è¿‡æœŸæ—¶é—´
- [ ] é€€å‡ºç™»å½•æ¸…ç†æ‰€æœ‰æœ¬åœ°æ•°æ®
- [ ] é¡µé¢åˆ·æ–°åé‡æ–°éªŒè¯æƒé™
- [ ] è·¯ç”±å®ˆå«æ­£ç¡®é…ç½®

**æ•æ„Ÿä¿¡æ¯æ£€æŸ¥**
- [ ] ä»£ç ä¸­æ²¡æœ‰ç¡¬ç¼–ç å¯†é’¥
- [ ] æ§åˆ¶å°æ—¥å¿—ä¸åŒ…å«æ•æ„Ÿä¿¡æ¯
- [ ] ç”Ÿäº§ç¯å¢ƒå…³é—­è°ƒè¯•ä¿¡æ¯
- [ ] æºç æ˜ å°„åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç¦ç”¨
- [ ] APIå“åº”ä¸æš´éœ²æ•æ„Ÿæ•°æ®

</details>

### 6.2 è‡ªåŠ¨åŒ–å®‰å…¨æ£€æµ‹


**ğŸ¤– é›†æˆå®‰å…¨å·¥å…·**

```json
// package.json - å®‰å…¨ä¾èµ–æ£€æŸ¥
{
  "scripts": {
    "security-audit": "npm audit",
    "security-fix": "npm audit fix",
    "lint-security": "eslint --ext .js,.vue src/ --config .eslintrc-security.js"
  },
  "husky": {
    "hooks": {
      "pre-commit": "npm run security-audit && npm run lint-security"
    }
  }
}
```

**âš™ï¸ ESLintå®‰å…¨é…ç½®**

```javascript
// .eslintrc-security.js
module.exports = {
  plugins: ['security'],
  extends: ['plugin:security/recommended'],
  rules: {
    'security/detect-eval-with-expression': 'error',
    'security/detect-non-literal-regexp': 'warn',
    'security/detect-unsafe-regex': 'error',
    'security/detect-buffer-noassert': 'error',
    'security/detect-child-process': 'warn',
    'security/detect-disable-mustache-escape': 'error',
    'security/detect-no-csrf-before-method-override': 'error',
    'security/detect-non-literal-fs-filename': 'warn',
    'security/detect-non-literal-require': 'error',
    'security/detect-object-injection': 'warn',
    'security/detect-possible-timing-attacks': 'warn',
    'security/detect-pseudoRandomBytes': 'error'
  }
};
```

### 6.3 å®‰å…¨æµ‹è¯•æ–¹æ³•


**ğŸ§ª å‰ç«¯å®‰å…¨æµ‹è¯•ç­–ç•¥**

```javascript
// å®‰å…¨æµ‹è¯•ç”¨ä¾‹ç¤ºä¾‹
describe('è¾“å…¥éªŒè¯å®‰å…¨æµ‹è¯•', () => {
    test('åº”è¯¥æ‹’ç»åŒ…å«è„šæœ¬çš„è¾“å…¥', () => {
        const maliciousInput = '<script>alert("XSS")</script>';
        expect(() => validateUserInput(maliciousInput)).toThrow();
    });
    
    test('åº”è¯¥æ­£ç¡®ç¼–ç HTMLç‰¹æ®Šå­—ç¬¦', () => {
        const input = '<div>test</div>';
        const output = htmlEncode(input);
        expect(output).toBe('&lt;div&gt;test&lt;/div&gt;');
    });
    
    test('åº”è¯¥é™åˆ¶è¾“å…¥é•¿åº¦', () => {
        const longInput = 'a'.repeat(10000);
        expect(() => validateUserInput(longInput)).toThrow('Input too long');
    });
});

// æ‰‹åŠ¨å®‰å…¨æµ‹è¯•
const securityTestCases = [
    '<script>alert("XSS")</script>',
    'javascript:alert("XSS")',
    '"><script>alert("XSS")</script>',
    "'; DROP TABLE users; --",
    '../../../etc/passwd',
    '{{7*7}}', // æ¨¡æ¿æ³¨å…¥
    '${7*7}',  // è¡¨è¾¾å¼æ³¨å…¥
];

securityTestCases.forEach(testCase => {
    console.log(`Testing: ${testCase}`);
    // æµ‹è¯•æ¯ä¸ªè¾“å…¥æ˜¯å¦è¢«æ­£ç¡®å¤„ç†
});
```

**ğŸ”§ æµè§ˆå™¨å®‰å…¨æµ‹è¯•**

```javascript
// æ£€æŸ¥CSPæ˜¯å¦ç”Ÿæ•ˆ
function testCSP() {
    try {
        eval('console.log("CSP bypass!")'); // åº”è¯¥è¢«é˜»æ­¢
        console.warn('âš ï¸ CSPå¯èƒ½æœªæ­£ç¡®é…ç½®');
    } catch (e) {
        console.log('âœ… CSPæ­£å¸¸å·¥ä½œ');
    }
}

// æ£€æŸ¥HTTPS
function testHTTPS() {
    if (location.protocol !== 'https:' && location.hostname !== 'localhost') {
        console.warn('âš ï¸ å»ºè®®ä½¿ç”¨HTTPS');
    } else {
        console.log('âœ… è¿æ¥å®‰å…¨');
    }
}

// æ£€æŸ¥æ•æ„Ÿä¿¡æ¯æ³„éœ²
function testInfoLeakage() {
    const scripts = document.querySelectorAll('script');
    scripts.forEach(script => {
        if (script.textContent.includes('password') || 
            script.textContent.includes('secret') ||
            script.textContent.includes('key')) {
            console.warn('âš ï¸ è„šæœ¬ä¸­å¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯');
        }
    });
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„å®‰å…¨åŸåˆ™


```
ğŸ”¸ è¾“å…¥å®‰å…¨ï¼šä¸ä¿¡ä»»ä»»ä½•è¾“å…¥ï¼Œå…¨é¢éªŒè¯ï¼Œç™½åå•ç­–ç•¥
ğŸ”¸ è¾“å‡ºç¼–ç ï¼šHTMLç¼–ç ã€JSç¼–ç ï¼Œé˜²æ­¢XSSæ”»å‡»
ğŸ”¸ åŠ å¯†è®¤çŸ¥ï¼šå®¢æˆ·ç«¯åŠ å¯†æœ‰é™ï¼Œä¸èƒ½æ›¿ä»£æœåŠ¡ç«¯éªŒè¯
ğŸ”¸ æ¡†æ¶å®‰å…¨ï¼šæ­£ç¡®ä½¿ç”¨Vue/Reactå®‰å…¨ç‰¹æ€§
ğŸ”¸ å®‰å…¨æ£€æŸ¥ï¼šä»£ç å®¡æŸ¥ã€è‡ªåŠ¨åŒ–æ£€æµ‹ã€å®‰å…¨æµ‹è¯•
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ å‰ç«¯å®‰å…¨çš„æœ¬è´¨**
```
å‰ç«¯å®‰å…¨ = ç”¨æˆ·ä½“éªŒ + ç¬¬ä¸€é“é˜²çº¿
- æå‡ç”¨æˆ·ä½“éªŒï¼šåŠæ—¶åé¦ˆï¼Œå‡å°‘é”™è¯¯æäº¤
- ç¬¬ä¸€é“é˜²çº¿ï¼šè¿‡æ»¤æ˜æ˜¾çš„æ¶æ„è¾“å…¥
- ä½†ä¸æ˜¯æœ€åé˜²çº¿ï¼šæœåŠ¡ç«¯å¿…é¡»é‡æ–°éªŒè¯
```

**ğŸ”¹ è¾“å…¥éªŒè¯çš„å±‚æ¬¡**
```
æµè§ˆå™¨éªŒè¯ï¼šåŸºæœ¬æ ¼å¼æ£€æŸ¥ï¼ˆHTML5è¡¨å•éªŒè¯ï¼‰
     â†“
å‰ç«¯éªŒè¯ï¼šä¸šåŠ¡é€»è¾‘éªŒè¯ï¼ˆJavaScriptï¼‰
     â†“
åç«¯éªŒè¯ï¼šå®‰å…¨éªŒè¯å’Œä¸šåŠ¡éªŒè¯ï¼ˆå¿…éœ€ï¼ï¼‰
     â†“
æ•°æ®åº“å±‚ï¼šçº¦æŸå’Œè§¦å‘å™¨ï¼ˆæœ€åä¿éšœï¼‰
```

**ğŸ”¹ ç¼–ç çš„é‡è¦æ€§**
```
ç”¨æˆ·è¾“å…¥ â†’ éªŒè¯ â†’ ç¼–ç  â†’ å­˜å‚¨
         â†“      â†“      â†“
      æ‹’ç»æ¶æ„  è½¬ä¹‰ç‰¹æ®Š  å®‰å…¨å­˜å‚¨
```

### 7.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ æ—¥å¸¸å¼€å‘ä¸­çš„å®‰å…¨ä¹ æƒ¯**
- **è¾“å…¥å¤„ç†**ï¼šå…ˆéªŒè¯å†ä½¿ç”¨ï¼Œæ°¸è¿œä¸ä¿¡ä»»
- **è¾“å‡ºæ˜¾ç¤º**ï¼šä½¿ç”¨æ¡†æ¶çš„å®‰å…¨APIï¼Œé¿å…innerHTML
- **é”™è¯¯å¤„ç†**ï¼šè®°å½•é”™è¯¯ä½†ä¸æš´éœ²æ•æ„Ÿä¿¡æ¯
- **ä»£ç å®¡æŸ¥**ï¼šé‡ç‚¹æ£€æŸ¥ç”¨æˆ·è¾“å…¥å¤„ç†é€»è¾‘
- **å·¥å…·é›†æˆ**ï¼šä½¿ç”¨ESLintå®‰å…¨è§„åˆ™ï¼Œå®šæœŸä¾èµ–æ£€æŸ¥

**ğŸš¨ å¸¸è§é™·é˜±æé†’**
- âŒ ä»¥ä¸ºå‰ç«¯éªŒè¯å°±å¤Ÿäº†
- âŒ åœ¨å‰ç«¯ä»£ç ä¸­ç¡¬ç¼–ç å¯†é’¥
- âŒ ä½¿ç”¨eval()æˆ–innerHTMLå¤„ç†ç”¨æˆ·æ•°æ®
- âŒ ä¸å¯¹ç¬¬ä¸‰æ–¹åº“è¿›è¡Œå®‰å…¨å®¡è®¡
- âŒ åœ¨ç”Ÿäº§ç¯å¢ƒæš´éœ²è°ƒè¯•ä¿¡æ¯

**ğŸ’¡ å®‰å…¨å¼€å‘å£è¯€**
```
è¾“å…¥ä¸ä¿¡ä»»ï¼Œè¾“å‡ºè¦ç¼–ç 
å¯†é’¥ä¸å‰ç«¯ï¼ŒéªŒè¯ä¸å·æ‡’
æ¡†æ¶è¦ç”¨å¯¹ï¼Œå·¥å…·æ¥å¸®å¿™
æµ‹è¯•è¦å…¨é¢ï¼Œå®¡æŸ¥ä¸èƒ½å¿˜
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- å‰ç«¯å®‰å…¨æ˜¯ä½“éªŒæå‡ï¼Œä¸æ˜¯å®‰å…¨ä¿éšœ
- è¾“å…¥éªŒè¯ç”¨ç™½åå•ï¼Œè¾“å‡ºç¼–ç é˜²æ³¨å…¥
- å®¢æˆ·ç«¯åŠ å¯†æœ‰å±€é™ï¼ŒæœåŠ¡ç«¯éªŒè¯æ˜¯å…³é”®
- å®‰å…¨ç¼–ç æˆä¹ æƒ¯ï¼Œå·¥å…·æ£€æµ‹ä¿è´¨é‡