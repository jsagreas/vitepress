---
title: 6ã€é—®é¢˜ä¸äº‹ä»¶ç®¡ç†API
---
## ğŸ“š ç›®å½•

1. [é—®é¢˜ä¸äº‹ä»¶åŸºæœ¬æ¦‚å¿µ](#1-é—®é¢˜ä¸äº‹ä»¶åŸºæœ¬æ¦‚å¿µ)
2. [é—®é¢˜æŸ¥è¯¢APIè¯¦è§£](#2-é—®é¢˜æŸ¥è¯¢APIè¯¦è§£)
3. [äº‹ä»¶æŸ¥è¯¢ä¸ç®¡ç†](#3-äº‹ä»¶æŸ¥è¯¢ä¸ç®¡ç†)
4. [äº‹ä»¶ç¡®è®¤æ“ä½œ](#4-äº‹ä»¶ç¡®è®¤æ“ä½œ)
5. [é—®é¢˜æ›´æ–°ä¸çŠ¶æ€ç®¡ç†](#5-é—®é¢˜æ›´æ–°ä¸çŠ¶æ€ç®¡ç†)
6. [æ‰¹é‡æ“ä½œä¸è‡ªåŠ¨åŒ–](#6-æ‰¹é‡æ“ä½œä¸è‡ªåŠ¨åŒ–)
7. [å®é™…åº”ç”¨åœºæ™¯](#7-å®é™…åº”ç”¨åœºæ™¯)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” é—®é¢˜ä¸äº‹ä»¶åŸºæœ¬æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯é—®é¢˜å’Œäº‹ä»¶


**ç®€å•ç†è§£**ï¼š
- **äº‹ä»¶ï¼ˆEventï¼‰**ï¼šå°±åƒç›‘æ§ç³»ç»Ÿçš„"æ—¥è®°æœ¬"ï¼Œè®°å½•æ¯ä¸€æ¬¡çŠ¶æ€å˜åŒ–
- **é—®é¢˜ï¼ˆProblemï¼‰**ï¼šå°±åƒ"å¾…åŠäº‹é¡¹"ï¼Œéœ€è¦äººå·¥å¤„ç†çš„å¼‚å¸¸æƒ…å†µ

```
ç”Ÿæ´»ä¸­çš„ç±»æ¯”ï¼š
æ±½è½¦ä»ªè¡¨ç›˜äº®çº¢ç¯ = äº‹ä»¶ï¼ˆè®°å½•ä»€ä¹ˆæ—¶å€™äº®çš„ï¼‰
éœ€è¦å»ä¿®è½¦ = é—®é¢˜ï¼ˆéœ€è¦è§£å†³çš„äº‹æƒ…ï¼‰

ç›‘æ§ç³»ç»Ÿä¸­ï¼š
CPUä½¿ç”¨ç‡è¶…è¿‡90% = äº‹ä»¶
æœåŠ¡å™¨æ€§èƒ½å‘Šè­¦éœ€è¦å¤„ç† = é—®é¢˜
```

### 1.2 é—®é¢˜ä¸äº‹ä»¶çš„å…³ç³»


**ğŸ”— å…³ç³»å›¾ç¤º**ï¼š
```
è§¦å‘å™¨çŠ¶æ€å˜åŒ–
        â†“
    ç”Ÿæˆäº‹ä»¶è®°å½•
        â†“
   (å¦‚æœæ˜¯æ•…éšœçŠ¶æ€)
        â†“
     åˆ›å»ºé—®é¢˜
        â†“
    ç­‰å¾…äººå·¥å¤„ç†
        â†“
   (é—®é¢˜è§£å†³å)
        â†“
     é—®é¢˜å…³é—­
```

**æ ¸å¿ƒç†è§£**ï¼š
- **äº‹ä»¶**ï¼šæ‰€æœ‰çŠ¶æ€å˜åŒ–éƒ½ä¼šäº§ç”Ÿäº‹ä»¶ï¼ˆåŒ…æ‹¬æ¢å¤æ­£å¸¸ï¼‰
- **é—®é¢˜**ï¼šåªæœ‰æ•…éšœçŠ¶æ€æ‰ä¼šäº§ç”Ÿé—®é¢˜
- **ç”Ÿå‘½å‘¨æœŸ**ï¼šé—®é¢˜ä»åˆ›å»ºåˆ°è§£å†³çš„å®Œæ•´è¿‡ç¨‹

### 1.3 æ ¸å¿ƒå­—æ®µå«ä¹‰


**ğŸ“‹ å¿…é¡»ç†è§£çš„å…³é”®å­—æ®µ**ï¼š

| å­—æ®µå | ä¸­æ–‡å«ä¹‰ | é€šä¿—è§£é‡Š | ç¤ºä¾‹å€¼ |
|--------|----------|----------|--------|
| `eventid` | äº‹ä»¶ID | æ¯ä¸ªäº‹ä»¶çš„å”¯ä¸€ç¼–å· | 12345 |
| `objectid` | å¯¹è±¡ID | è§¦å‘å™¨IDï¼ˆå“ªä¸ªè§„åˆ™è§¦å‘çš„ï¼‰ | 67890 |
| `source` | äº‹ä»¶æº | äº‹ä»¶æ¥æºç±»å‹ | 0=è§¦å‘å™¨ |
| `clock` | äº‹ä»¶æ—¶é—´ | äº‹ä»¶å‘ç”Ÿçš„æ—¶é—´æˆ³ | 1642118400 |
| `severity` | ä¸¥é‡ç¨‹åº¦ | é—®é¢˜çš„ä¸¥é‡çº§åˆ« | 4=é«˜ |
| `acknowledged` | ç¡®è®¤çŠ¶æ€ | æ˜¯å¦å·²ç»æœ‰äººå¤„ç† | 0=æœªç¡®è®¤ |

---

## 2. ğŸ“Š é—®é¢˜æŸ¥è¯¢APIè¯¦è§£


### 2.1 åŸºç¡€é—®é¢˜æŸ¥è¯¢


**ğŸ¯ æœ€ç®€å•çš„é—®é¢˜æŸ¥è¯¢**ï¼š

```bash
# æŸ¥è¯¢æ‰€æœ‰æœªè§£å†³çš„é—®é¢˜
curl -X POST http://zabbix-server/api_jsonrpc.php \
-H "Content-Type: application/json" \
-d '{
    "jsonrpc": "2.0",
    "method": "problem.get",
    "params": {},
    "auth": "ä½ çš„è®¤è¯token",
    "id": 1
}'
```

**é€šä¿—è§£é‡Š**ï¼š
- `problem.get`ï¼šè·å–é—®é¢˜åˆ—è¡¨çš„å‘½ä»¤
- ç©ºçš„`params`ï¼šè¡¨ç¤ºæŸ¥è¯¢æ‰€æœ‰é—®é¢˜
- å°±åƒé—®ç³»ç»Ÿ"ç°åœ¨æœ‰å“ªäº›éœ€è¦å¤„ç†çš„é—®é¢˜ï¼Ÿ"

### 2.2 æŒ‰ä¸¥é‡ç¨‹åº¦æŸ¥è¯¢


**ğŸš¨ æŸ¥è¯¢é«˜å±é—®é¢˜**ï¼š

```json
{
    "jsonrpc": "2.0",
    "method": "problem.get",
    "params": {
        "severities": [4, 5],
        "output": ["eventid", "name", "severity", "clock"]
    },
    "auth": "ä½ çš„token",
    "id": 1
}
```

**å‚æ•°è§£é‡Š**ï¼š
- `severities: [4, 5]`ï¼šåªæŸ¥ä¸¥é‡å’Œç¾éš¾çº§åˆ«
- `output`ï¼šæŒ‡å®šè¿”å›å“ªäº›å­—æ®µï¼Œé¿å…æ•°æ®è¿‡å¤š

**ğŸ’¡ ä¸¥é‡ç¨‹åº¦å¯¹ç…§è¡¨**ï¼š
```
0 = æœªåˆ†ç±»ï¼ˆNot classifiedï¼‰
1 = ä¿¡æ¯ï¼ˆInformationï¼‰  
2 = è­¦å‘Šï¼ˆWarningï¼‰
3 = å¹³å‡ï¼ˆAverageï¼‰
4 = é«˜ï¼ˆHighï¼‰
5 = ç¾éš¾ï¼ˆDisasterï¼‰
```

### 2.3 æŒ‰æ—¶é—´èŒƒå›´æŸ¥è¯¢


**â° æŸ¥è¯¢æœ€è¿‘24å°æ—¶çš„é—®é¢˜**ï¼š

```json
{
    "jsonrpc": "2.0",
    "method": "problem.get",
    "params": {
        "time_from": "ç°åœ¨æ—¶é—´æˆ³-86400",
        "time_till": "ç°åœ¨æ—¶é—´æˆ³",
        "sortfield": "clock",
        "sortorder": "DESC"
    },
    "auth": "ä½ çš„token",
    "id": 1
}
```

**æ—¶é—´è®¡ç®—æŠ€å·§**ï¼š
```bash
# Linuxè·å–å½“å‰æ—¶é—´æˆ³
ç°åœ¨=$(date +%s)
# 24å°æ—¶å‰
æ˜¨å¤©=$(($ç°åœ¨ - 86400))

# åœ¨å®é™…ä½¿ç”¨ä¸­
time_from=$(date -d "24 hours ago" +%s)
time_till=$(date +%s)
```

### 2.4 æŒ‰ä¸»æœºæŸ¥è¯¢é—®é¢˜


**ğŸ–¥ï¸ æŸ¥è¯¢ç‰¹å®šä¸»æœºçš„é—®é¢˜**ï¼š

```json
{
    "jsonrpc": "2.0",
    "method": "problem.get",
    "params": {
        "hostids": ["10084", "10085"],
        "selectHosts": ["host", "name"],
        "recent": "true"
    },
    "auth": "ä½ çš„token", 
    "id": 1
}
```

**å‚æ•°è¯´æ˜**ï¼š
- `hostids`ï¼šæŒ‡å®šä¸»æœºIDåˆ—è¡¨
- `selectHosts`ï¼šåŒæ—¶è¿”å›ä¸»æœºä¿¡æ¯
- `recent`ï¼šåªè¿”å›æœ€è¿‘çš„é—®é¢˜

---

## 3. ğŸ“ˆ äº‹ä»¶æŸ¥è¯¢ä¸ç®¡ç†


### 3.1 äº‹ä»¶æŸ¥è¯¢åŸºç¡€


**ä»€ä¹ˆæ—¶å€™æŸ¥äº‹ä»¶**ï¼š
- æƒ³äº†è§£å®Œæ•´çš„çŠ¶æ€å˜åŒ–å†å²
- åˆ†æé—®é¢˜çš„äº§ç”Ÿå’Œæ¢å¤è¿‡ç¨‹
- ç»Ÿè®¡ç³»ç»Ÿç¨³å®šæ€§æ•°æ®

**ğŸ” åŸºç¡€äº‹ä»¶æŸ¥è¯¢**ï¼š

```json
{
    "jsonrpc": "2.0",
    "method": "event.get",
    "params": {
        "source": 0,
        "object": 0,
        "output": ["eventid", "source", "object", "objectid", "clock", "value"]
    },
    "auth": "ä½ çš„token",
    "id": 1
}
```

**å­—æ®µå«ä¹‰è§£é‡Š**ï¼š
- `source: 0`ï¼šäº‹ä»¶æ¥æºæ˜¯è§¦å‘å™¨
- `object: 0`ï¼šå¯¹è±¡ç±»å‹æ˜¯è§¦å‘å™¨
- `value`ï¼š0=æ­£å¸¸æ¢å¤ï¼Œ1=æ•…éšœå‘ç”Ÿ

### 3.2 äº‹ä»¶ä¸è§¦å‘å™¨å…³è”æŸ¥è¯¢


**ğŸ”— æŸ¥è¯¢ç‰¹å®šè§¦å‘å™¨çš„æ‰€æœ‰äº‹ä»¶**ï¼š

```json
{
    "jsonrpc": "2.0", 
    "method": "event.get",
    "params": {
        "objectids": ["13926"],
        "selectHosts": ["host", "name"],
        "selectItems": ["name", "key_"],
        "time_from": "å¼€å§‹æ—¶é—´æˆ³",
        "time_till": "ç»“æŸæ—¶é—´æˆ³"
    },
    "auth": "ä½ çš„token",
    "id": 1
}
```

**å®é™…ç”¨é€”**ï¼š
- åˆ†ææŸä¸ªç›‘æ§é¡¹çš„å†å²è¡¨ç°
- äº†è§£æ•…éšœå‘ç”Ÿçš„é¢‘ç‡å’Œè§„å¾‹
- ä¸ºå®¹é‡è§„åˆ’æä¾›æ•°æ®æ”¯æŒ

### 3.3 äº‹ä»¶çŠ¶æ€åˆ†æ


**ğŸ“Š äº‹ä»¶çŠ¶æ€ç»Ÿè®¡æŸ¥è¯¢**ï¼š

```json
{
    "jsonrpc": "2.0",
    "method": "event.get", 
    "params": {
        "groupids": ["2"],
        "source": 0,
        "object": 0,
        "countOutput": true,
        "groupby": ["value", "severity"]
    },
    "auth": "ä½ çš„token",
    "id": 1
}
```

**ç»Ÿè®¡ç»´åº¦**ï¼š
- æŒ‰`value`åˆ†ç»„ï¼šæ•…éšœäº‹ä»¶ vs æ¢å¤äº‹ä»¶
- æŒ‰`severity`åˆ†ç»„ï¼šä¸åŒä¸¥é‡ç¨‹åº¦çš„äº‹ä»¶æ•°é‡
- `countOutput`ï¼šè¿”å›ç»Ÿè®¡æ•°é‡è€Œä¸æ˜¯è¯¦ç»†æ•°æ®

---

## 4. âœ… äº‹ä»¶ç¡®è®¤æ“ä½œ


### 4.1 ä»€ä¹ˆæ˜¯äº‹ä»¶ç¡®è®¤


**ç”Ÿæ´»ä¸­çš„ç±»æ¯”**ï¼š
```
ç«è­¦è­¦æŠ¥å“äº† â†’ äº‹ä»¶å‘ç”Ÿ
æ¶ˆé˜²å‘˜åˆ°è¾¾ç°åœº â†’ äº‹ä»¶ç¡®è®¤
"æˆ‘ä»¬æ­£åœ¨å¤„ç†" â†’ ç¡®è®¤æ¶ˆæ¯
ç«ç¾æ‰‘ç­ â†’ é—®é¢˜è§£å†³
```

**ç¡®è®¤çš„ä½œç”¨**ï¼š
- **å‘ŠçŸ¥çŠ¶æ€**ï¼šè®©å…¶ä»–äººçŸ¥é“æœ‰äººåœ¨å¤„ç†
- **è®°å½•è¿‡ç¨‹**ï¼šç•™ä¸‹å¤„ç†ç—•è¿¹ï¼Œä¾¿äºè¿½æº¯
- **é¿å…é‡å¤**ï¼šé˜²æ­¢å¤šäººåŒæ—¶å¤„ç†åŒä¸€é—®é¢˜

### 4.2 åŸºç¡€ç¡®è®¤æ“ä½œ


**âœï¸ ç¡®è®¤å•ä¸ªäº‹ä»¶**ï¼š

```json
{
    "jsonrpc": "2.0",
    "method": "event.acknowledge",
    "params": {
        "eventids": ["12345"],
        "message": "å·²æ”¶åˆ°å‘Šè­¦ï¼Œæ­£åœ¨æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€",
        "action": 6
    },
    "auth": "ä½ çš„token",
    "id": 1
}
```

**å‚æ•°è¯¦è§£**ï¼š
- `eventids`ï¼šè¦ç¡®è®¤çš„äº‹ä»¶IDåˆ—è¡¨
- `message`ï¼šç¡®è®¤æ—¶çš„å¤‡æ³¨ä¿¡æ¯ï¼ˆè¯´æ˜å¤„ç†æƒ…å†µï¼‰
- `action`ï¼šç¡®è®¤åŠ¨ä½œç±»å‹

**ğŸ¯ ActionåŠ¨ä½œç±»å‹å¯¹ç…§**ï¼š
```
1 = ä»…ç¡®è®¤ï¼ˆClose problemï¼‰
2 = æ·»åŠ æ¶ˆæ¯ï¼ˆAdd messageï¼‰
4 = ä¿®æ”¹ä¸¥é‡ç¨‹åº¦ï¼ˆChange severityï¼‰
6 = ç¡®è®¤å¹¶æ·»åŠ æ¶ˆæ¯ï¼ˆ1+2ï¼‰
```

### 4.3 æ‰¹é‡ç¡®è®¤æ“ä½œ


**ğŸ”„ æ‰¹é‡ç¡®è®¤å¤šä¸ªäº‹ä»¶**ï¼š

```json
{
    "jsonrpc": "2.0",
    "method": "event.acknowledge", 
    "params": {
        "eventids": ["12345", "12346", "12347"],
        "message": "æ‰¹é‡å¤„ç†ï¼šå·²é€šçŸ¥ç›¸å…³è¿ç»´äººå‘˜",
        "action": 6
    },
    "auth": "ä½ çš„token",
    "id": 1
}
```

**æ‰¹é‡ç¡®è®¤çš„åœºæ™¯**ï¼š
- åŒä¸€æ‰¹ä¸»æœºçš„ç›¸åŒé—®é¢˜
- ç”±åŒä¸€ä¸ªæ ¹å› å¯¼è‡´çš„å¤šä¸ªå‘Šè­¦
- è®¡åˆ’æ€§ç»´æŠ¤æœŸé—´çš„é¢„æœŸå‘Šè­¦

### 4.4 ä¿®æ”¹é—®é¢˜ä¸¥é‡ç¨‹åº¦


**âš ï¸ è°ƒæ•´é—®é¢˜ä¸¥é‡çº§åˆ«**ï¼š

```json
{
    "jsonrpc": "2.0",
    "method": "event.acknowledge",
    "params": {
        "eventids": ["12345"],
        "message": "ç»è¯„ä¼°ï¼Œå½±å“èŒƒå›´æœ‰é™ï¼Œé™ä½ä¸¥é‡ç¨‹åº¦",
        "action": 4,
        "severity": 2
    },
    "auth": "ä½ çš„token",
    "id": 1
}
```

**è°ƒæ•´ä¸¥é‡ç¨‹åº¦çš„åœºæ™¯**ï¼š
- è¯¯æŠ¥ï¼šç³»ç»Ÿåˆ¤æ–­è¿‡äºä¸¥é‡
- å½±å“è¯„ä¼°ï¼šå®é™…å½±å“æ¯”é¢„æœŸå°
- ä¸´æ—¶æªæ–½ï¼šå·²æœ‰ä¸´æ—¶è§£å†³æ–¹æ¡ˆ

---

## 5. ğŸ”„ é—®é¢˜æ›´æ–°ä¸çŠ¶æ€ç®¡ç†


### 5.1 é—®é¢˜çŠ¶æ€ç”Ÿå‘½å‘¨æœŸ


**ğŸ“‹ é—®é¢˜çŠ¶æ€æµè½¬å›¾**ï¼š
```
é—®é¢˜äº§ç”Ÿ â†’ å¾…ç¡®è®¤ â†’ å¤„ç†ä¸­ â†’ å·²è§£å†³ â†’ å·²å…³é—­
   â†“         â†“        â†“        â†“        â†“
 è‡ªåŠ¨åˆ›å»º   äººå·¥ç¡®è®¤  æ·»åŠ å¤‡æ³¨  è§¦å‘å™¨æ¢å¤ é—®é¢˜å½’æ¡£
```

### 5.2 æŸ¥è¯¢ä¸åŒçŠ¶æ€çš„é—®é¢˜


**ğŸ” æŸ¥è¯¢æœªç¡®è®¤çš„é—®é¢˜**ï¼š

```json
{
    "jsonrpc": "2.0",
    "method": "problem.get",
    "params": {
        "acknowledged": false,
        "sortfield": "clock",
        "sortorder": "DESC",
        "output": ["eventid", "name", "severity", "clock"]
    },
    "auth": "ä½ çš„token",
    "id": 1
}
```

**ğŸ” æŸ¥è¯¢å·²ç¡®è®¤ä½†æœªè§£å†³çš„é—®é¢˜**ï¼š

```json
{
    "jsonrpc": "2.0",
    "method": "problem.get",
    "params": {
        "acknowledged": true,
        "suppressed": false,
        "selectAcknowledges": ["userid", "message", "clock"]
    },
    "auth": "ä½ çš„token",
    "id": 1
}
```

### 5.3 é—®é¢˜æŠ‘åˆ¶ç®¡ç†


**ä»€ä¹ˆæ˜¯é—®é¢˜æŠ‘åˆ¶**ï¼š
- **æŠ‘åˆ¶ï¼ˆSuppressedï¼‰**ï¼šä¸´æ—¶éšè—é—®é¢˜ï¼Œä½†ä¸åˆ é™¤
- **ä½¿ç”¨åœºæ™¯**ï¼šè®¡åˆ’ç»´æŠ¤ã€å·²çŸ¥é—®é¢˜ã€ä¸´æ—¶å±è”½

**ğŸ”‡ æŠ‘åˆ¶é—®é¢˜ç¤ºä¾‹**ï¼š

```json
{
    "jsonrpc": "2.0",
    "method": "problem.update",
    "params": {
        "eventids": ["12345"],
        "suppressed": "1"
    },
    "auth": "ä½ çš„token",
    "id": 1
}
```

---

## 6. âš¡ æ‰¹é‡æ“ä½œä¸è‡ªåŠ¨åŒ–


### 6.1 è‡ªåŠ¨åŒ–ç¡®è®¤è„šæœ¬


**ğŸ¤– Pythonè‡ªåŠ¨ç¡®è®¤è„šæœ¬ç¤ºä¾‹**ï¼š

```python
import requests
import json
from datetime import datetime, timedelta

class ZabbixAPI:
    def __init__(self, url, token):
        self.url = url
        self.token = token
    
    def get_unacknowledged_problems(self, severity_min=3):
        """è·å–æœªç¡®è®¤çš„é«˜ä¼˜å…ˆçº§é—®é¢˜"""
        payload = {
            "jsonrpc": "2.0",
            "method": "problem.get",
            "params": {
                "acknowledged": False,
                "severities": list(range(severity_min, 6)),
                "output": ["eventid", "name", "severity", "clock"]
            },
            "auth": self.token,
            "id": 1
        }
        
        response = requests.post(self.url, json=payload)
        return response.json()['result']
    
    def auto_acknowledge_old_problems(self, hours=2):
        """è‡ªåŠ¨ç¡®è®¤è¶…è¿‡æŒ‡å®šå°æ—¶æ•°çš„é—®é¢˜"""
        cutoff_time = datetime.now() - timedelta(hours=hours)
        
        problems = self.get_unacknowledged_problems()
        old_problems = [p for p in problems 
                       if datetime.fromtimestamp(int(p['clock'])) < cutoff_time]
        
        if old_problems:
            eventids = [p['eventid'] for p in old_problems]
            self.acknowledge_events(eventids, f"è‡ªåŠ¨ç¡®è®¤ï¼šè¶…è¿‡{hours}å°æ—¶æœªå¤„ç†")
            
        return len(old_problems)
```

### 6.2 æ‰¹é‡å¤„ç†æœ€ä½³å®è·µ


**ğŸ“ æ‰¹é‡æ“ä½œå»ºè®®**ï¼š

```
âœ… å¥½çš„åšæ³•ï¼š
- åˆ†æ‰¹å¤„ç†ï¼šæ¯æ¬¡ä¸è¶…è¿‡100ä¸ªäº‹ä»¶
- æ·»åŠ æè¿°ï¼šè¯´æ˜æ‰¹é‡æ“ä½œçš„åŸå› 
- è®°å½•æ—¥å¿—ï¼šä¿ç•™æ“ä½œè®°å½•ä¾¿äºå®¡è®¡

âŒ é¿å…çš„åšæ³•ï¼š
- ä¸€æ¬¡å¤„ç†è¿‡å¤šäº‹ä»¶
- æ‰¹é‡æ“ä½œæ²¡æœ‰å¤‡æ³¨è¯´æ˜
- ç›²ç›®ç¡®è®¤æ‰€æœ‰é—®é¢˜
```

### 6.3 åŸºäºæ¡ä»¶çš„è‡ªåŠ¨åŒ–


**ğŸ”„ æ¡ä»¶åŒ–ç¡®è®¤é€»è¾‘**ï¼š

```python
def smart_acknowledge(zapi, problem):
    """æ™ºèƒ½ç¡®è®¤é€»è¾‘"""
    
    # ä½ä¼˜å…ˆçº§é—®é¢˜ï¼šè‡ªåŠ¨ç¡®è®¤
    if problem['severity'] <= 2:
        return zapi.acknowledge_event(
            problem['eventid'], 
            "ä½ä¼˜å…ˆçº§é—®é¢˜è‡ªåŠ¨ç¡®è®¤"
        )
    
    # é‡å¤é—®é¢˜ï¼šåˆå¹¶ç¡®è®¤
    if is_duplicate_problem(problem):
        return zapi.acknowledge_event(
            problem['eventid'],
            "é‡å¤é—®é¢˜ï¼Œå·²å½’å¹¶å¤„ç†"
        )
    
    # é«˜ä¼˜å…ˆçº§ï¼šäººå·¥å¤„ç†
    return False
```

---

## 7. ğŸ¯ å®é™…åº”ç”¨åœºæ™¯


### 7.1 è¿ç»´å€¼ç­åœºæ™¯


**ğŸ“± å€¼ç­å·¥ç¨‹å¸ˆçš„ä¸€å¤©**ï¼š

```
09:00 - æŸ¥è¯¢å¤œé—´äº§ç”Ÿçš„é—®é¢˜
curl -X POST $ZABBIX_API \
-d '{
    "method": "problem.get",
    "params": {
        "time_from": "'$(date -d "yesterday 18:00" +%s)'",
        "time_till": "'$(date -d "today 09:00" +%s)'",
        "acknowledged": false
    }
}'

10:30 - ç¡®è®¤å·²å¤„ç†çš„é—®é¢˜
ç¡®è®¤æ—¶æ·»åŠ å¤„ç†è®°å½•ï¼š
"å·²é‡å¯ApacheæœåŠ¡ï¼Œç½‘ç«™æ¢å¤æ­£å¸¸"

15:00 - æ£€æŸ¥æœªç¡®è®¤çš„é«˜å±é—®é¢˜
æŸ¥è¯¢ä¸¥é‡ç¨‹åº¦4-5ä¸”æœªç¡®è®¤çš„é—®é¢˜
```

### 7.2 è‡ªåŠ¨åŒ–è¿ç»´åœºæ™¯


**ğŸ¤– è‡ªåŠ¨åŒ–å¤„ç†æµç¨‹**ï¼š

```
ç›‘æ§å‘ç°é—®é¢˜
     â†“
è‡ªåŠ¨åŒ–è„šæœ¬åˆ¤æ–­
     â†“
â”œâ”€ å¸¸è§é—®é¢˜ â†’ è‡ªåŠ¨ä¿®å¤ â†’ è‡ªåŠ¨ç¡®è®¤
â”œâ”€ ä¸­ç­‰é—®é¢˜ â†’ å‘é€é€šçŸ¥ â†’ ç­‰å¾…ç¡®è®¤  
â””â”€ ä¸¥é‡é—®é¢˜ â†’ ç«‹å³å‘Šè­¦ â†’ å‡çº§å¤„ç†
```

### 7.3 æŠ¥è¡¨ç»Ÿè®¡åœºæ™¯


**ğŸ“Š ç”Ÿæˆæœˆåº¦é—®é¢˜æŠ¥å‘Š**ï¼š

```bash
#!/bin/bash
# è·å–æœ¬æœˆé—®é¢˜ç»Ÿè®¡

START_TIME=$(date -d "$(date +%Y-%m-01)" +%s)
END_TIME=$(date +%s)

# æŒ‰ä¸¥é‡ç¨‹åº¦ç»Ÿè®¡
curl -X POST $ZABBIX_API \
-d "{
    \"method\": \"problem.get\",
    \"params\": {
        \"time_from\": \"$START_TIME\",
        \"time_till\": \"$END_TIME\",
        \"countOutput\": true,
        \"groupby\": [\"severity\"]
    }
}"
```

### 7.4 é—®é¢˜è¶‹åŠ¿åˆ†æ


**ğŸ“ˆ åˆ†æé—®é¢˜å‘ç”Ÿè§„å¾‹**ï¼š

```python
def analyze_problem_trends(zapi, days=30):
    """åˆ†ææœ€è¿‘30å¤©çš„é—®é¢˜è¶‹åŠ¿"""
    
    # æŒ‰å¤©ç»Ÿè®¡é—®é¢˜æ•°é‡
    daily_problems = {}
    
    for day in range(days):
        date = datetime.now() - timedelta(days=day)
        start_time = date.replace(hour=0, minute=0, second=0)
        end_time = date.replace(hour=23, minute=59, second=59)
        
        problems = zapi.get_problems_by_time(
            int(start_time.timestamp()),
            int(end_time.timestamp())
        )
        
        daily_problems[date.strftime('%Y-%m-%d')] = len(problems)
    
    return daily_problems
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ äº‹ä»¶ï¼ˆEventï¼‰ï¼šçŠ¶æ€å˜åŒ–çš„è®°å½•
ğŸ”¸ é—®é¢˜ï¼ˆProblemï¼‰ï¼šéœ€è¦å¤„ç†çš„æ•…éšœ
ğŸ”¸ ç¡®è®¤ï¼ˆAcknowledgeï¼‰ï¼šäººå·¥å“åº”å’Œå¤„ç†æ ‡è®°
ğŸ”¸ ä¸¥é‡ç¨‹åº¦ï¼ˆSeverityï¼‰ï¼šé—®é¢˜çš„é‡è¦ç¨‹åº¦åˆ†çº§
ğŸ”¸ æŠ‘åˆ¶ï¼ˆSuppressedï¼‰ï¼šä¸´æ—¶éšè—é—®é¢˜
```

### 8.2 å…³é”®APIæ–¹æ³•


**ğŸ“š æ ¸å¿ƒAPIæ–¹æ³•æ€»è§ˆ**ï¼š

| APIæ–¹æ³• | åŠŸèƒ½è¯´æ˜ | ä¸»è¦ç”¨é€” |
|---------|----------|----------|
| `problem.get` | æŸ¥è¯¢é—®é¢˜åˆ—è¡¨ | è·å–å¾…å¤„ç†é—®é¢˜ |
| `event.get` | æŸ¥è¯¢äº‹ä»¶è®°å½• | åˆ†æå†å²çŠ¶æ€å˜åŒ– |
| `event.acknowledge` | ç¡®è®¤äº‹ä»¶ | æ ‡è®°é—®é¢˜å¤„ç†çŠ¶æ€ |
| `problem.update` | æ›´æ–°é—®é¢˜ | ä¿®æ”¹é—®é¢˜å±æ€§ |

### 8.3 å®ç”¨æŸ¥è¯¢æ¨¡æ¿


**ğŸ¯ å¸¸ç”¨æŸ¥è¯¢åœºæ™¯**ï¼š

```bash
# 1. æŸ¥è¯¢å½“å‰æ‰€æœ‰æœªè§£å†³é—®é¢˜
method: problem.get
params: {"acknowledged": false}

# 2. æŸ¥è¯¢é«˜å±æœªç¡®è®¤é—®é¢˜  
method: problem.get
params: {"acknowledged": false, "severities": [4,5]}

# 3. æŸ¥è¯¢ç‰¹å®šæ—¶é—´æ®µäº‹ä»¶
method: event.get  
params: {"time_from": timestamp1, "time_till": timestamp2}

# 4. ç¡®è®¤é—®é¢˜å¹¶æ·»åŠ å¤‡æ³¨
method: event.acknowledge
params: {"eventids": ["123"], "message": "å¤„ç†è¯´æ˜", "action": 6}
```

### 8.4 æœ€ä½³å®è·µå»ºè®®


**âœ… æ¨èåšæ³•**ï¼š
- **åŠæ—¶ç¡®è®¤**ï¼šæ”¶åˆ°å‘Šè­¦åå°½å¿«ç¡®è®¤ï¼Œé¿å…é‡å¤é€šçŸ¥
- **è¯¦ç»†å¤‡æ³¨**ï¼šç¡®è®¤æ—¶æ·»åŠ å¤„ç†è¿‡ç¨‹å’Œç»“æœè¯´æ˜
- **åˆ†çº§å¤„ç†**ï¼šæ ¹æ®ä¸¥é‡ç¨‹åº¦è®¾å®šä¸åŒçš„å“åº”æ—¶é—´
- **å®šæœŸæ¸…ç†**ï¼šå®šæœŸç¡®è®¤å’Œå…³é—­å·²è§£å†³çš„å†å²é—®é¢˜

**âŒ é¿å…é”™è¯¯**ï¼š
- ä¸è¦ç›²ç›®æ‰¹é‡ç¡®è®¤æ‰€æœ‰é—®é¢˜
- ä¸è¦å¿½ç•¥é«˜ä¼˜å…ˆçº§æœªç¡®è®¤é—®é¢˜
- ä¸è¦åœ¨ç¡®è®¤æ—¶ä½¿ç”¨æ— æ„ä¹‰çš„å¤‡æ³¨
- ä¸è¦é•¿æœŸä¿ç•™å·²è§£å†³ä½†æœªç¡®è®¤çš„é—®é¢˜

### 8.5 è‡ªåŠ¨åŒ–å»ºè®®


**ğŸ¤– è‡ªåŠ¨åŒ–åœºæ™¯**ï¼š
- **è‡ªåŠ¨ç¡®è®¤**ï¼šä½ä¼˜å…ˆçº§æˆ–é‡å¤æ€§é—®é¢˜
- **æ™ºèƒ½åˆ†ç±»**ï¼šæ ¹æ®é—®é¢˜ç‰¹å¾è‡ªåŠ¨åˆ†ç»„
- **æŠ¥è¡¨ç”Ÿæˆ**ï¼šå®šæœŸç”Ÿæˆé—®é¢˜ç»Ÿè®¡æŠ¥å‘Š
- **è¶‹åŠ¿é¢„è­¦**ï¼šåˆ†æé—®é¢˜å¢é•¿è¶‹åŠ¿ï¼Œæå‰é¢„è­¦

**æ ¸å¿ƒè®°å¿†**ï¼š
- é—®é¢˜å’Œäº‹ä»¶æ˜¯ç›‘æ§ç³»ç»Ÿçš„æ ¸å¿ƒæ¦‚å¿µ
- åˆç†çš„ç¡®è®¤å’ŒçŠ¶æ€ç®¡ç†æé«˜è¿ç»´æ•ˆç‡
- APIè°ƒç”¨è¦è€ƒè™‘æ€§èƒ½å’Œæ‰¹é‡å¤„ç†
- è‡ªåŠ¨åŒ–å¤„ç†ç»“åˆäººå·¥åˆ¤æ–­æ•ˆæœæœ€ä½³