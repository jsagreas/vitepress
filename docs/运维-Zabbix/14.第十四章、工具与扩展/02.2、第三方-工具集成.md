---
title: 2ã€ç¬¬ä¸‰æ–¹-å·¥å…·é›†æˆ
---
## ğŸ“š ç›®å½•

1. [ç›‘æ§å·¥å…·å¯¹æ¯”](#1-ç›‘æ§å·¥å…·å¯¹æ¯”)
2. [å·¥å…·é›†æˆæ–¹æ¡ˆ](#2-å·¥å…·é›†æˆæ–¹æ¡ˆ)
3. [æ•°æ®æ ¼å¼è½¬æ¢](#3-æ•°æ®æ ¼å¼è½¬æ¢)
4. [é…ç½®è¿ç§»å·¥å…·](#4-é…ç½®è¿ç§»å·¥å…·)
5. [ç›‘æ§æ•°æ®åˆ†æ](#5-ç›‘æ§æ•°æ®åˆ†æ)
6. [å¯è§†åŒ–å·¥å…·æ‰©å±•](#6-å¯è§†åŒ–å·¥å…·æ‰©å±•)
7. [è‡ªåŠ¨åŒ–å·¥å…·é“¾](#7-è‡ªåŠ¨åŒ–å·¥å…·é“¾)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” ç›‘æ§å·¥å…·å¯¹æ¯”


### 1.1 ä¸ºä»€ä¹ˆéœ€è¦äº†è§£å…¶ä»–ç›‘æ§å·¥å…·


**ç”Ÿæ´»ä¸­çš„ä¾‹å­**ï¼š
å°±åƒä¹°è½¦æ—¶è¦å¯¹æ¯”ä¸åŒå“ç‰Œä¸€æ ·ï¼Œé€‰æ‹©ç›‘æ§å·¥å…·ä¹Ÿéœ€è¦äº†è§£å„ç§é€‰æ‹©ã€‚è™½ç„¶æˆ‘ä»¬å­¦ä¹ Zabbixï¼Œä½†äº†è§£å…¶ä»–å·¥å…·èƒ½å¸®æˆ‘ä»¬ï¼š
- æ›´å¥½åœ°ç†è§£Zabbixçš„ä¼˜åŠ¿
- åœ¨ä¸åŒåœºæ™¯ä¸‹åšå‡ºåˆé€‚é€‰æ‹©
- ä¸ä½¿ç”¨å…¶ä»–å·¥å…·çš„å›¢é˜Ÿåä½œ

### 1.2 ä¸»æµç›‘æ§å·¥å…·å¯¹æ¯”


**ğŸ“Š ç›‘æ§å·¥å…·ç‰¹æ€§å¯¹æ¯”**

| å·¥å…· | **é€‚ç”¨åœºæ™¯** | **å­¦ä¹ éš¾åº¦** | **åŠŸèƒ½ä¸°å¯Œåº¦** | **ç¤¾åŒºæ”¯æŒ** |
|------|-------------|-------------|---------------|-------------|
| ğŸ”§ **Zabbix** | `ä¼ä¸šçº§å…¨é¢ç›‘æ§` | â­â­â­ ä¸­ç­‰ | â­â­â­â­â­ æé«˜ | â­â­â­â­ å¾ˆå¥½ |
| ğŸ“Š **Prometheus** | `äº‘åŸç”Ÿå¾®æœåŠ¡` | â­â­â­â­ è¾ƒéš¾ | â­â­â­â­ å¾ˆé«˜ | â­â­â­â­â­ æå¥½ |
| ğŸ¯ **Nagios** | `ä¼ ç»Ÿç½‘ç»œç›‘æ§` | â­â­ ç®€å• | â­â­â­ ä¸­ç­‰ | â­â­â­ ä¸€èˆ¬ |
| â˜ï¸ **DataDog** | `äº‘æœåŠ¡SaaS` | â­ å¾ˆç®€å• | â­â­â­â­ å¾ˆé«˜ | â­â­â­â­ å¾ˆå¥½ |

### 1.3 å·¥å…·ç‰¹ç‚¹è¯¦è§£


**ğŸ”§ Zabbixçš„ç‰¹è‰²**
```
ä¼˜åŠ¿ï¼š
â€¢ åŠŸèƒ½å…¨é¢ï¼šç½‘ç»œã€æœåŠ¡å™¨ã€åº”ç”¨ä¸€ä½“åŒ–ç›‘æ§
â€¢ ç•Œé¢å‹å¥½ï¼šWebç•Œé¢æ“ä½œï¼Œæ–°æ‰‹å®¹æ˜“ä¸Šæ‰‹
â€¢ å†å²æ•°æ®ï¼šå¼ºå¤§çš„æ•°æ®å­˜å‚¨å’Œè¶‹åŠ¿åˆ†æ
â€¢ å‘Šè­¦ä¸°å¯Œï¼šå¤šç§å‘Šè­¦æ–¹å¼ï¼Œæ”¯æŒå‡çº§

é€‚åˆï¼šä¸­å¤§å‹ä¼ä¸šã€éœ€è¦å…¨é¢ç›‘æ§çš„åœºæ™¯
```

**ğŸ“Š Prometheusçš„ç‰¹è‰²**
```
ä¼˜åŠ¿ï¼š
â€¢ äº‘åŸç”Ÿï¼šä¸“ä¸ºå®¹å™¨å’Œå¾®æœåŠ¡è®¾è®¡
â€¢ æŸ¥è¯¢å¼ºå¤§ï¼šPromQLæŸ¥è¯¢è¯­è¨€åŠŸèƒ½å¼ºå¤§
â€¢ ç”Ÿæ€ä¸°å¯Œï¼šä¸Kubernetesç­‰å®Œç¾é›†æˆ
â€¢ æ‰©å±•æ€§å¥½ï¼šåˆ†å¸ƒå¼æ¶æ„ï¼Œæ€§èƒ½ä¼˜ç§€

é€‚åˆï¼šå®¹å™¨åŒ–ç¯å¢ƒã€DevOpså›¢é˜Ÿ
```

### 1.4 é€‰æ‹©å»ºè®®


**ğŸ¯ åœºæ™¯åŒ–é€‰æ‹©æŒ‡å—**

```
ä¼ ç»Ÿä¼ä¸šç¯å¢ƒï¼š
â”œâ”€â”€ æœåŠ¡å™¨æ•°é‡ï¼š100-1000å°
â”œâ”€â”€ ç½‘ç»œè®¾å¤‡ï¼šäº¤æ¢æœºã€è·¯ç”±å™¨è¾ƒå¤š
â”œâ”€â”€ åº”ç”¨ç±»å‹ï¼šä¼ ç»Ÿä¸‰å±‚æ¶æ„
â””â”€â”€ æ¨èï¼šZabbix (å…¨é¢è¦†ç›–ï¼Œæ˜“ç®¡ç†)

äº‘åŸç”Ÿç¯å¢ƒï¼š
â”œâ”€â”€ æ¶æ„ï¼šå¾®æœåŠ¡ã€å®¹å™¨åŒ–
â”œâ”€â”€ å¹³å°ï¼šKubernetesã€Docker
â”œâ”€â”€ å¼€å‘æ¨¡å¼ï¼šDevOpsã€CI/CD
â””â”€â”€ æ¨èï¼šPrometheus + Grafana

æ··åˆç¯å¢ƒï¼š
â”œâ”€â”€ éƒ¨åˆ†ä¼ ç»Ÿåº”ç”¨
â”œâ”€â”€ éƒ¨åˆ†å®¹å™¨åŒ–åº”ç”¨
â”œâ”€â”€ å¤šäº‘éƒ¨ç½²
â””â”€â”€ æ¨èï¼šZabbix + Prometheus ç»„åˆ
```

---

## 2. ğŸ”— å·¥å…·é›†æˆæ–¹æ¡ˆ


### 2.1 ä»€ä¹ˆæ˜¯å·¥å…·é›†æˆ


**é€šä¿—ç†è§£**ï¼š
å°±åƒæ‰‹æœºå¯ä»¥è¿æ¥è“ç‰™è€³æœºã€æ™ºèƒ½æ‰‹è¡¨ä¸€æ ·ï¼Œç›‘æ§å·¥å…·ä¹Ÿå¯ä»¥äº’ç›¸è¿æ¥ï¼Œå…±äº«æ•°æ®ã€‚è¿™æ ·èƒ½å‘æŒ¥å„å·¥å…·çš„ä¼˜åŠ¿ï¼Œé¿å…é‡å¤å·¥ä½œã€‚

### 2.2 Zabbixä¸Prometheusé›†æˆ


**ğŸ”„ é›†æˆæ¶æ„å›¾**
```
åº”ç”¨æœåŠ¡
    â†“ (metrics)
Prometheus â†â†’ Zabbix
    â†“              â†“
Grafana      Zabbix Web
(å¯è§†åŒ–)      (å‘Šè­¦ç®¡ç†)
```

**ğŸ“ é›†æˆæ­¥éª¤**

**æ­¥éª¤1ï¼šé…ç½®Prometheusæ•°æ®æº**
```yaml
# prometheus.ymlé…ç½®ç¤ºä¾‹
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'zabbix-server'
    static_configs:
      - targets: ['zabbix-server:10051']
    metrics_path: /metrics
    scrape_interval: 30s
```

**æ­¥éª¤2ï¼šé…ç½®Zabbixæ¥æ”¶Prometheusæ•°æ®**
```bash
# åœ¨Zabbixä¸­åˆ›å»ºPrometheusç›‘æ§é¡¹
# ç›‘æ§é¡¹ç±»å‹ï¼šHTTPä»£ç†
# URLï¼šhttp://prometheus:9090/api/v1/query?query=up
# æ•°æ®ç±»å‹ï¼šæ•°å­—(æµ®ç‚¹)
```

### 2.3 ä¸Grafanaé›†æˆ


**ğŸ¨ ä¸ºä»€ä¹ˆè¦é›†æˆGrafanaï¼Ÿ**

Grafanaå°±åƒä¸€ä¸ªä¸“ä¸šçš„"æ•°æ®ç”»å®¶"ï¼Œèƒ½æŠŠæ¯ç‡¥çš„æ•°å­—å˜æˆæ¼‚äº®çš„å›¾è¡¨ï¼š
- Zabbixè´Ÿè´£æ”¶é›†æ•°æ®ï¼ˆåƒæ‘„å½±å¸ˆæ‹ç…§ï¼‰
- Grafanaè´Ÿè´£ç¾åŒ–å±•ç¤ºï¼ˆåƒä¿®å›¾å¸ˆç¾åŒ–ç…§ç‰‡ï¼‰

**ğŸ“Š é›†æˆé…ç½®**
```json
{
  "datasource": {
    "type": "alexanderzobnin-zabbix-datasource",
    "name": "Zabbix",
    "url": "http://zabbix-server/zabbix",
    "access": "proxy",
    "basicAuth": false,
    "jsonData": {
      "username": "grafana",
      "trends": true,
      "trendsFrom": "7d",
      "trendsRange": "4h"
    }
  }
}
```

### 2.4 ä¸ELK Stacké›†æˆ


**ğŸ“‹ æ—¥å¿—ç›‘æ§é›†æˆ**

```
åº”ç”¨æ—¥å¿— â†’ Logstash â†’ Elasticsearch â†’ Kibana
              â†“
         Zabbixç›‘æ§
        (æ—¥å¿—æ•°é‡ã€é”™è¯¯ç‡)
```

**ğŸ”§ å®ç°æ–¹å¼**
- Logstashè§£ææ—¥å¿—å¹¶å‘é€ç»Ÿè®¡æ•°æ®åˆ°Zabbix
- Zabbixç›‘æ§æ—¥å¿—æ•°é‡ã€é”™è¯¯å…³é”®å­—
- ç»“åˆç»“æ„åŒ–æ—¥å¿—å’ŒæŒ‡æ ‡ç›‘æ§

---

## 3. ğŸ”„ æ•°æ®æ ¼å¼è½¬æ¢


### 3.1 ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®æ ¼å¼è½¬æ¢


**ç”Ÿæ´»ä¾‹å­**ï¼š
å°±åƒä¸åŒå“ç‰Œçš„å……ç”µå™¨æ¥å£ä¸åŒï¼Œéœ€è¦è½¬æ¢å™¨ä¸€æ ·ã€‚ä¸åŒç›‘æ§å·¥å…·çš„æ•°æ®æ ¼å¼ä¹Ÿä¸åŒï¼Œéœ€è¦è½¬æ¢æ‰èƒ½äº’ç›¸ç†è§£ã€‚

### 3.2 å¸¸è§æ•°æ®æ ¼å¼


**ğŸ“Š ç›‘æ§æ•°æ®æ ¼å¼å¯¹æ¯”**

| æ ¼å¼ | **å·¥å…·** | **ç‰¹ç‚¹** | **ç¤ºä¾‹** |
|------|---------|---------|---------|
| **JSON** | `é€šç”¨æ ¼å¼` | æ˜“è¯»æ˜“è§£æ | `{"metric": "cpu.usage", "value": 85.5}` |
| **PromQL** | `Prometheus` | æŸ¥è¯¢è¯­è¨€ | `cpu_usage_percent{host="server1"}` |
| **InfluxDB Line** | `InfluxDB` | æ—¶åºæ•°æ® | `cpu,host=server1 usage=85.5` |
| **Zabbix Item** | `Zabbix` | ç›‘æ§é¡¹æ ¼å¼ | `system.cpu.util[,user]` |

### 3.3 æ•°æ®è½¬æ¢å·¥å…·


**ğŸ› ï¸ è½¬æ¢å·¥å…·ä»‹ç»**

**Telegrafï¼šæ•°æ®æ”¶é›†å’Œè½¬æ¢**
```toml
# telegraf.conf - ä»å¤šç§æ•°æ®æºæ”¶é›†å¹¶è½¬æ¢
[[inputs.prometheus]]
  urls = ["http://prometheus:9090/metrics"]

[[outputs.zabbix]]
  address = "zabbix-server:10051"
  prefix = "telegraf."
```

**Fluentdï¼šæ—¥å¿—æ•°æ®è½¬æ¢**
```ruby
# æ”¶é›†JSONæ ¼å¼æ—¥å¿—ï¼Œè½¬æ¢ä¸ºZabbixæ ¼å¼
<source>
  @type tail
  path /var/log/app.log
  format json
</source>

<match **>
  @type zabbix
  zabbix_server zabbix-server
  port 10051
  host "#{Socket.gethostname}"
</match>
```

### 3.4 è‡ªå®šä¹‰è½¬æ¢è„šæœ¬


**ğŸ Pythonè½¬æ¢ç¤ºä¾‹**
```python
# ç®€å•çš„æ•°æ®æ ¼å¼è½¬æ¢è„šæœ¬
import json
import requests

def prometheus_to_zabbix(prom_data):
    """å°†Prometheusæ•°æ®è½¬æ¢ä¸ºZabbixæ ¼å¼"""
    zabbix_data = []
    
    for metric in prom_data['data']['result']:
        item = {
            'host': metric['metric'].get('instance', 'unknown'),
            'key': metric['metric']['__name__'],
            'value': float(metric['value'][1]),
            'clock': int(metric['value'][0])
        }
        zabbix_data.append(item)
    
    return zabbix_data

# ä½¿ç”¨ç¤ºä¾‹
prom_response = requests.get('http://prometheus:9090/api/v1/query?query=up')
zabbix_format = prometheus_to_zabbix(prom_response.json())
```

---

## 4. ğŸšš é…ç½®è¿ç§»å·¥å…·


### 4.1 ä»€ä¹ˆæ˜¯é…ç½®è¿ç§»


**é€šä¿—ç†è§£**ï¼š
å°±åƒæ¬å®¶æ—¶è¦æŠŠæ—§æˆ¿å­çš„å®¶å…·æ¬åˆ°æ–°æˆ¿å­ä¸€æ ·ï¼Œé…ç½®è¿ç§»å°±æ˜¯æŠŠä¸€ä¸ªç›‘æ§ç³»ç»Ÿçš„é…ç½®"æ¬åˆ°"å¦ä¸€ä¸ªç³»ç»Ÿä¸­ã€‚

### 4.2 ä¸ºä»€ä¹ˆéœ€è¦è¿ç§»


**ğŸ’¡ å¸¸è§è¿ç§»åœºæ™¯**
- å…¬å¸ä»Nagiosè¿ç§»åˆ°Zabbix
- æµ‹è¯•ç¯å¢ƒé…ç½®åŒæ­¥åˆ°ç”Ÿäº§ç¯å¢ƒ
- ä¸åŒç‰ˆæœ¬çš„Zabbixä¹‹é—´è¿ç§»
- å¤šä¸ªZabbixå®ä¾‹åˆå¹¶

### 4.3 Zabbixé…ç½®è¿ç§»å·¥å…·


**ğŸ”§ å®˜æ–¹è¿ç§»å·¥å…·**

**XMLå¯¼å…¥å¯¼å‡º**
```bash
# å¯¼å‡ºä¸»æœºé…ç½®
zabbix_export.php --type=hosts --id=10001 > hosts.xml

# å¯¼å…¥ä¸»æœºé…ç½®
zabbix_import.php --file=hosts.xml --type=hosts
```

**ğŸ› ï¸ ç¬¬ä¸‰æ–¹è¿ç§»å·¥å…·**

**zabbix-cliï¼šå‘½ä»¤è¡Œå·¥å…·**
```bash
# å®‰è£…zabbix-cli
pip install zabbix-cli

# é…ç½®è¿æ¥ä¿¡æ¯
zabbix-cli --config-create

# å¯¼å‡ºæ¨¡æ¿
zabbix-cli export_template "Template OS Linux"

# æ‰¹é‡æ“ä½œ
zabbix-cli create_host "web-server-01" "10.1.1.100" "Linux servers"
```

### 4.4 è‡ªåŠ¨åŒ–è¿ç§»è„šæœ¬


**ğŸ“ è¿ç§»è„šæœ¬ç¤ºä¾‹**
```python
from pyzabbix import ZabbixAPI

class ZabbixMigrator:
    def __init__(self, source_url, target_url, username, password):
        self.source = ZabbixAPI(source_url)
        self.target = ZabbixAPI(target_url)
        
        # ç™»å½•ä¸¤ä¸ªç³»ç»Ÿ
        self.source.login(username, password)
        self.target.login(username, password)
    
    def migrate_hosts(self, group_name):
        """è¿ç§»æŒ‡å®šç»„çš„æ‰€æœ‰ä¸»æœº"""
        # è·å–æºç³»ç»Ÿçš„ä¸»æœº
        hosts = self.source.host.get(
            output=['hostid', 'host', 'name'],
            groupids=self.get_group_id(group_name)
        )
        
        # åœ¨ç›®æ ‡ç³»ç»Ÿä¸­åˆ›å»ºä¸»æœº
        for host in hosts:
            self.create_host_in_target(host)
    
    def get_group_id(self, group_name):
        """è·å–ä¸»æœºç»„ID"""
        groups = self.source.hostgroup.get(
            filter={'name': group_name}
        )
        return groups[0]['groupid'] if groups else None
```

### 4.5 è¿ç§»æ³¨æ„äº‹é¡¹


**âš ï¸ è¿ç§»å‰æ£€æŸ¥æ¸…å•**

âœ… **æ•°æ®å¤‡ä»½**
```bash
# å¤‡ä»½Zabbixæ•°æ®åº“
mysqldump -u zabbix -p zabbix > zabbix_backup.sql

# å¤‡ä»½é…ç½®æ–‡ä»¶
cp /etc/zabbix/zabbix_server.conf /backup/
```

âœ… **ç‰ˆæœ¬å…¼å®¹æ€§**
- æ£€æŸ¥æºç‰ˆæœ¬å’Œç›®æ ‡ç‰ˆæœ¬çš„å…¼å®¹æ€§
- äº†è§£ç‰ˆæœ¬å·®å¼‚å’Œæ–°å¢åŠŸèƒ½
- æµ‹è¯•é‡è¦åŠŸèƒ½æ˜¯å¦æ­£å¸¸

âœ… **ä¾èµ–å…³ç³»**
- æ¨¡æ¿ä¾èµ–å…³ç³»
- ä¸»æœºç»„å…³è”
- ç”¨æˆ·æƒé™è®¾ç½®

---

## 5. ğŸ“Š ç›‘æ§æ•°æ®åˆ†æ


### 5.1 ä»€ä¹ˆæ˜¯ç›‘æ§æ•°æ®åˆ†æ


**é€šä¿—ç†è§£**ï¼š
å°±åƒåŒ»ç”Ÿé€šè¿‡åŒ–éªŒæŠ¥å‘Šåˆ†æç—…æƒ…ä¸€æ ·ï¼Œæˆ‘ä»¬é€šè¿‡åˆ†æç›‘æ§æ•°æ®æ¥äº†è§£ç³»ç»Ÿå¥åº·çŠ¶å†µï¼Œå‘ç°æ½œåœ¨é—®é¢˜ã€‚

### 5.2 æ•°æ®åˆ†æå·¥å…·é›†æˆ


**ğŸ” åˆ†æå·¥å…·åˆ†ç±»**

```
å®æ—¶åˆ†æï¼š
â”œâ”€â”€ Grafana (å›¾è¡¨å±•ç¤º)
â”œâ”€â”€ Kibana (æ—¥å¿—åˆ†æ)
â””â”€â”€ Zabbixè‡ªå¸¦å›¾è¡¨

å†å²åˆ†æï¼š
â”œâ”€â”€ Jupyter Notebook (æ·±åº¦åˆ†æ)
â”œâ”€â”€ Rè¯­è¨€ (ç»Ÿè®¡åˆ†æ)
â””â”€â”€ Python pandas (æ•°æ®å¤„ç†)

æœºå™¨å­¦ä¹ ï¼š
â”œâ”€â”€ TensorFlow (é¢„æµ‹åˆ†æ)
â”œâ”€â”€ scikit-learn (å¼‚å¸¸æ£€æµ‹)
â””â”€â”€ Prometheus Alert Manager (æ™ºèƒ½å‘Šè­¦)
```

### 5.3 Jupyteré›†æˆåˆ†æ


**ğŸ““ ä¸ºä»€ä¹ˆä½¿ç”¨Jupyterï¼Ÿ**

Jupyterå°±åƒä¸€ä¸ª"æ•°æ®å®éªŒå®¤"ï¼Œè®©æˆ‘ä»¬å¯ä»¥ï¼š
- äº¤äº’å¼åˆ†ææ•°æ®
- åˆ¶ä½œä¸“ä¸šæŠ¥å‘Š
- åˆ†äº«åˆ†æç»“æœ

**ğŸ é›†æˆç¤ºä¾‹**
```python
import pandas as pd
import matplotlib.pyplot as plt
from pyzabbix import ZabbixAPI

# è¿æ¥Zabbix
zapi = ZabbixAPI("http://zabbix-server/zabbix")
zapi.login("admin", "password")

# è·å–CPUä½¿ç”¨ç‡å†å²æ•°æ®
def get_cpu_history(host_name, days=7):
    # è·å–ä¸»æœºID
    hosts = zapi.host.get(filter={"host": host_name})
    hostid = hosts[0]['hostid']
    
    # è·å–CPUç›‘æ§é¡¹
    items = zapi.item.get(
        hostids=hostid,
        search={"key_": "system.cpu.util"}
    )
    itemid = items[0]['itemid']
    
    # è·å–å†å²æ•°æ®
    history = zapi.history.get(
        itemids=itemid,
        time_from=int(time.time() - days * 24 * 3600),
        output='extend'
    )
    
    return pd.DataFrame(history)

# åˆ†æå’Œå¯è§†åŒ–
cpu_data = get_cpu_history("web-server-01")
cpu_data['value'] = pd.to_numeric(cpu_data['value'])
cpu_data['timestamp'] = pd.to_datetime(cpu_data['clock'], unit='s')

# ç»˜åˆ¶è¶‹åŠ¿å›¾
plt.figure(figsize=(12, 6))
plt.plot(cpu_data['timestamp'], cpu_data['value'])
plt.title('CPUä½¿ç”¨ç‡è¶‹åŠ¿ - æœ€è¿‘7å¤©')
plt.xlabel('æ—¶é—´')
plt.ylabel('CPUä½¿ç”¨ç‡ (%)')
plt.show()
```

### 5.4 å¼‚å¸¸æ£€æµ‹åˆ†æ


**ğŸ¤– æ™ºèƒ½å¼‚å¸¸æ£€æµ‹**

```python
from sklearn.ensemble import IsolationForest
import numpy as np

def detect_anomalies(data, contamination=0.1):
    """ä½¿ç”¨æœºå™¨å­¦ä¹ æ£€æµ‹å¼‚å¸¸å€¼"""
    
    # å‡†å¤‡æ•°æ®
    values = data['value'].values.reshape(-1, 1)
    
    # è®­ç»ƒå¼‚å¸¸æ£€æµ‹æ¨¡å‹
    clf = IsolationForest(contamination=contamination, random_state=42)
    anomalies = clf.fit_predict(values)
    
    # æ ‡è®°å¼‚å¸¸ç‚¹
    data['is_anomaly'] = anomalies == -1
    
    return data[data['is_anomaly']]

# æ£€æµ‹CPUä½¿ç”¨ç‡å¼‚å¸¸
anomalies = detect_anomalies(cpu_data)
print(f"å‘ç° {len(anomalies)} ä¸ªå¼‚å¸¸æ•°æ®ç‚¹")
```

---

## 6. ğŸ¨ å¯è§†åŒ–å·¥å…·æ‰©å±•


### 6.1 ä¸ºä»€ä¹ˆéœ€è¦æ‰©å±•å¯è§†åŒ–


**ç”Ÿæ´»ä¾‹å­**ï¼š
å°±åƒçœ‹ç”µå½±æ¯”çœ‹ä¹¦æ›´ç›´è§‚ä¸€æ ·ï¼Œå¥½çš„å›¾è¡¨æ¯”æ•°å­—è¡¨æ ¼æ›´å®¹æ˜“ç†è§£ã€‚Zabbixè‡ªå¸¦çš„å›¾è¡¨è™½ç„¶åŠŸèƒ½å¼ºå¤§ï¼Œä½†æœ‰æ—¶æˆ‘ä»¬éœ€è¦æ›´ç‚«é…·ã€æ›´ä¸“ä¸šçš„å±•ç¤ºæ•ˆæœã€‚

### 6.2 Grafanaæ·±åº¦é›†æˆ


**ğŸ¨ Grafanaçš„ä¼˜åŠ¿**
- å›¾è¡¨ç±»å‹ä¸°å¯Œï¼ˆçƒ­åŠ›å›¾ã€åœ°å›¾ã€ä»ªè¡¨ç›˜ç­‰ï¼‰
- äº¤äº’æ€§å¼ºï¼ˆç¼©æ”¾ã€è¿‡æ»¤ã€é’»å–ï¼‰
- æ¨¡æ¿åŒ–ï¼ˆä¸€å¥—æ¨¡æ¿é€‚ç”¨å¤šä¸ªä¸»æœºï¼‰
- åˆ†äº«æ–¹ä¾¿ï¼ˆé“¾æ¥åˆ†äº«ã€PDFå¯¼å‡ºï¼‰

**ğŸ“Š é«˜çº§å›¾è¡¨é…ç½®**
```json
{
  "dashboard": {
    "title": "æœåŠ¡å™¨ç›‘æ§å¤§å±",
    "panels": [
      {
        "title": "CPUä½¿ç”¨ç‡çƒ­åŠ›å›¾",
        "type": "heatmap",
        "targets": [
          {
            "expr": "system.cpu.util",
            "legendFormat": "{{host}}"
          }
        ],
        "xAxis": {"mode": "time"},
        "yAxis": {"unit": "percent"}
      }
    ]
  }
}
```

### 6.3 è‡ªå®šä¹‰Dashboardå¼€å‘


**ğŸ› ï¸ ä½¿ç”¨Reactå¼€å‘ç›‘æ§Dashboard**
```javascript
import React, { useState, useEffect } from 'react';
import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip } from 'recharts';

function ZabbixDashboard() {
  const [cpuData, setCpuData] = useState([]);
  
  useEffect(() => {
    // ä»Zabbix APIè·å–æ•°æ®
    fetchZabbixData().then(data => {
      setCpuData(transformData(data));
    });
  }, []);
  
  return (
    <div className="dashboard">
      <h1>å®æ—¶ç›‘æ§Dashboard</h1>
      <LineChart width={800} height={400} data={cpuData}>
        <CartesianGrid strokeDasharray="3 3" />
        <XAxis dataKey="time" />
        <YAxis />
        <Tooltip />
        <Line type="monotone" dataKey="cpu" stroke="#8884d8" />
      </LineChart>
    </div>
  );
}
```

### 6.4 ç§»åŠ¨ç«¯ç›‘æ§åº”ç”¨


**ğŸ“± ç§»åŠ¨ç«¯å±•ç¤ºæ–¹æ¡ˆ**

**å“åº”å¼Webè®¾è®¡**
```css
/* ç§»åŠ¨ç«¯é€‚é…æ ·å¼ */
@media (max-width: 768px) {
  .dashboard-panel {
    width: 100%;
    margin: 10px 0;
  }
  
  .metric-card {
    padding: 15px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    border-radius: 8px;
  }
}
```

**PWAåº”ç”¨å¼€å‘**
```javascript
// æ³¨å†ŒService Workerï¼Œå®ç°ç¦»çº¿è®¿é—®
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/sw.js')
    .then(registration => {
      console.log('SW registered: ', registration);
    })
    .catch(registrationError => {
      console.log('SW registration failed: ', registrationError);
    });
}
```

---

## 7. ğŸ¤– è‡ªåŠ¨åŒ–å·¥å…·é“¾


### 7.1 ä»€ä¹ˆæ˜¯è‡ªåŠ¨åŒ–å·¥å…·é“¾


**é€šä¿—ç†è§£**ï¼š
å°±åƒå·¥å‚çš„æµæ°´çº¿ä¸€æ ·ï¼Œè‡ªåŠ¨åŒ–å·¥å…·é“¾æŠŠç›‘æ§ç›¸å…³çš„å„ç§å·¥ä½œä¸²è”èµ·æ¥ï¼Œå®ç°"ä¸€é”®å¼"æ“ä½œï¼Œå‡å°‘äººå·¥å¹²é¢„ã€‚

### 7.2 CI/CDé›†æˆ


**ğŸ”„ ç›‘æ§ä¸å¼€å‘æµç¨‹é›†æˆ**

```
ä»£ç æäº¤ â†’ è‡ªåŠ¨æ„å»º â†’ è‡ªåŠ¨éƒ¨ç½² â†’ è‡ªåŠ¨é…ç½®ç›‘æ§
    â†“           â†“           â†“            â†“
  GitLab    Jenkins    Ansible     Zabbix API
```

**ğŸ“ Jenkins Pipelineç¤ºä¾‹**
```groovy
pipeline {
    agent any
    stages {
        stage('Deploy') {
            steps {
                // éƒ¨ç½²åº”ç”¨
                sh 'ansible-playbook deploy.yml'
            }
        }
        stage('Configure Monitoring') {
            steps {
                // è‡ªåŠ¨é…ç½®Zabbixç›‘æ§
                script {
                    def zabbixAPI = 'http://zabbix-server/zabbix/api_jsonrpc.php'
                    sh """
                        python3 auto_monitor_setup.py \
                            --host ${env.TARGET_HOST} \
                            --app ${env.APP_NAME} \
                            --env ${env.ENVIRONMENT}
                    """
                }
            }
        }
    }
}
```

### 7.3 Ansibleè‡ªåŠ¨åŒ–


**ğŸ“¦ åŸºç¡€è®¾æ–½å³ä»£ç **

**Ansible Playbookç¤ºä¾‹**
```yaml
---
- name: è‡ªåŠ¨é…ç½®Zabbixç›‘æ§
  hosts: web_servers
  tasks:
    - name: å®‰è£…Zabbix Agent
      yum:
        name: zabbix-agent
        state: present
    
    - name: é…ç½®Agent
      template:
        src: zabbix_agentd.conf.j2
        dest: /etc/zabbix/zabbix_agentd.conf
      notify: restart zabbix-agent
    
    - name: åœ¨Zabbix Serverä¸­æ·»åŠ ä¸»æœº
      uri:
        url: "{{ zabbix_api_url }}"
        method: POST
        body_format: json
        body:
          jsonrpc: "2.0"
          method: "host.create"
          params:
            host: "{{ inventory_hostname }}"
            interfaces:
              - type: 1
                main: 1
                useip: 1
                ip: "{{ ansible_default_ipv4.address }}"
                port: "10050"
            groups:
              - groupid: "{{ web_servers_group_id }}"
            templates:
              - templateid: "{{ linux_template_id }}"
          auth: "{{ zabbix_auth_token }}"
          id: 1
```

### 7.4 Terraformé›†æˆ


**ğŸ—ï¸ åŸºç¡€è®¾æ–½è‡ªåŠ¨åŒ–**
```hcl
# åˆ›å»ºè™šæ‹Ÿæœºæ—¶è‡ªåŠ¨é…ç½®ç›‘æ§
resource "aws_instance" "web_server" {
  ami           = "ami-12345678"
  instance_type = "t2.micro"
  
  user_data = <<-EOF
    #!/bin/bash
    # å®‰è£…å¹¶é…ç½®Zabbix Agent
    wget https://repo.zabbix.com/zabbix/5.0/ubuntu/pool/main/z/zabbix-release/zabbix-release_5.0-1+bionic_all.deb
    dpkg -i zabbix-release_5.0-1+bionic_all.deb
    apt update
    apt install -y zabbix-agent
    
    # é…ç½®Agent
    sed -i 's/Server=127.0.0.1/Server=${var.zabbix_server_ip}/' /etc/zabbix/zabbix_agentd.conf
    systemctl enable zabbix-agent
    systemctl start zabbix-agent
  EOF
  
  tags = {
    Name = "web-server-${count.index + 1}"
    Environment = var.environment
  }
}

# è‡ªåŠ¨åœ¨Zabbixä¸­æ·»åŠ ä¸»æœº
resource "null_resource" "zabbix_host" {
  depends_on = [aws_instance.web_server]
  
  provisioner "local-exec" {
    command = <<-EOT
      python3 zabbix_auto_add.py \
        --host ${aws_instance.web_server.public_ip} \
        --name ${aws_instance.web_server.tags.Name} \
        --group "AWS Servers"
    EOT
  }
}
```

### 7.5 è‡ªåŠ¨åŒ–è„šæœ¬å·¥å…·


**ğŸ”§ å¸¸ç”¨è‡ªåŠ¨åŒ–è„šæœ¬**

**æ‰¹é‡ä¸»æœºæ·»åŠ è„šæœ¬**
```python
#!/usr/bin/env python3
import csv
import argparse
from pyzabbix import ZabbixAPI

def bulk_add_hosts(csv_file, template_name, group_name):
    """æ‰¹é‡æ·»åŠ ä¸»æœºåˆ°Zabbix"""
    
    # è¿æ¥Zabbix
    zapi = ZabbixAPI("http://zabbix-server/zabbix")
    zapi.login("admin", "password")
    
    # è·å–æ¨¡æ¿å’Œç»„ID
    template_id = get_template_id(zapi, template_name)
    group_id = get_group_id(zapi, group_name)
    
    # è¯»å–CSVæ–‡ä»¶
    with open(csv_file, 'r') as f:
        reader = csv.DictReader(f)
        for row in reader:
            create_host(zapi, row, template_id, group_id)
    
    print("æ‰¹é‡æ·»åŠ å®Œæˆï¼")

def create_host(zapi, host_info, template_id, group_id):
    """åˆ›å»ºå•ä¸ªä¸»æœº"""
    try:
        zapi.host.create(
            host=host_info['hostname'],
            name=host_info['display_name'],
            interfaces=[{
                'type': 1,
                'main': 1,
                'useip': 1,
                'ip': host_info['ip'],
                'port': '10050'
            }],
            groups=[{'groupid': group_id}],
            templates=[{'templateid': template_id}]
        )
        print(f"âœ… æˆåŠŸæ·»åŠ ä¸»æœº: {host_info['hostname']}")
    except Exception as e:
        print(f"âŒ æ·»åŠ ä¸»æœºå¤±è´¥ {host_info['hostname']}: {e}")

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description='æ‰¹é‡æ·»åŠ Zabbixä¸»æœº')
    parser.add_argument('--csv', required=True, help='ä¸»æœºä¿¡æ¯CSVæ–‡ä»¶')
    parser.add_argument('--template', required=True, help='æ¨¡æ¿åç§°')
    parser.add_argument('--group', required=True, help='ä¸»æœºç»„åç§°')
    
    args = parser.parse_args()
    bulk_add_hosts(args.csv, args.template, args.group)
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å·¥å…·é›†æˆï¼šé€šè¿‡APIå’Œæ ‡å‡†åè®®è¿æ¥ä¸åŒç›‘æ§å·¥å…·
ğŸ”¸ æ•°æ®è½¬æ¢ï¼šç»Ÿä¸€ä¸åŒå·¥å…·çš„æ•°æ®æ ¼å¼ï¼Œå®ç°äº’æ“ä½œ
ğŸ”¸ é…ç½®è¿ç§»ï¼šå®‰å…¨å¯é åœ°åœ¨ä¸åŒç³»ç»Ÿé—´è¿ç§»ç›‘æ§é…ç½®
ğŸ”¸ æ•°æ®åˆ†æï¼šåˆ©ç”¨ä¸“ä¸šå·¥å…·æ·±åº¦åˆ†æç›‘æ§æ•°æ®
ğŸ”¸ å¯è§†åŒ–æ‰©å±•ï¼šé€šè¿‡ç¬¬ä¸‰æ–¹å·¥å…·å¢å¼ºæ•°æ®å±•ç¤ºæ•ˆæœ
ğŸ”¸ è‡ªåŠ¨åŒ–å·¥å…·é“¾ï¼šå°†ç›‘æ§é›†æˆåˆ°DevOpsæµç¨‹ä¸­
```

### 8.2 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ ä¸šåŠ¡åœºæ™¯åº”ç”¨**

**ä¼ä¸šç›‘æ§å‡çº§**
- ä»ä¼ ç»Ÿå·¥å…·å¹³æ»‘è¿ç§»åˆ°ç°ä»£ç›‘æ§å¹³å°
- ä¿æŒä¸šåŠ¡è¿ç»­æ€§ï¼Œé™ä½è¿ç§»é£é™©
- å……åˆ†åˆ©ç”¨ç°æœ‰æŠ•èµ„å’Œæ–°æŠ€æœ¯ä¼˜åŠ¿

**DevOpsæµç¨‹ä¼˜åŒ–**
- ç›‘æ§é…ç½®è‡ªåŠ¨åŒ–ï¼Œå‡å°‘äººå·¥é”™è¯¯
- ä¸CI/CDæµç¨‹æ·±åº¦é›†æˆ
- å®ç°åŸºç¡€è®¾æ–½å³ä»£ç 

**æ•°æ®ä»·å€¼æŒ–æ˜**
- é€šè¿‡ä¸“ä¸šåˆ†æå·¥å…·å‘ç°æ½œåœ¨é—®é¢˜
- é¢„æµ‹æ€§ç»´æŠ¤ï¼Œé™ä½æ•…éšœç‡
- ä¸ºä¸šåŠ¡å†³ç­–æä¾›æ•°æ®æ”¯æŒ

### 8.3 å­¦ä¹ å»ºè®®


**ğŸ“š å­¦ä¹ è·¯å¾„**
```
å…¥é—¨é˜¶æ®µï¼š
1. ç†Ÿç»ƒæŒæ¡ZabbixåŸºç¡€åŠŸèƒ½
2. äº†è§£ä¸»æµç›‘æ§å·¥å…·ç‰¹ç‚¹
3. å­¦ä¼šåŸºæœ¬çš„APIæ“ä½œ

è¿›é˜¶é˜¶æ®µï¼š
1. æŒæ¡å·¥å…·é—´æ•°æ®è½¬æ¢æ–¹æ³•
2. å­¦ä¼šé…ç½®è‡ªåŠ¨åŒ–è¿ç§»
3. ç†Ÿæ‚‰Grafanaç­‰å¯è§†åŒ–å·¥å…·

é«˜çº§é˜¶æ®µï¼š
1. è®¾è®¡å®Œæ•´çš„ç›‘æ§æ¶æ„
2. å¼€å‘è‡ªå®šä¹‰é›†æˆæ–¹æ¡ˆ
3. æ„å»ºè‡ªåŠ¨åŒ–å·¥å…·é“¾
```

**âš ï¸ æ³¨æ„äº‹é¡¹**
- é›†æˆå‰è¦å……åˆ†æµ‹è¯•ï¼Œé¿å…å½±å“ç”Ÿäº§ç¯å¢ƒ
- æ³¨æ„æ•°æ®å®‰å…¨å’Œæƒé™æ§åˆ¶
- ä¿æŒè‰¯å¥½çš„æ–‡æ¡£è®°å½•
- å®šæœŸæ£€æŸ¥é›†æˆçŠ¶æ€ï¼Œç¡®ä¿ç¨³å®šè¿è¡Œ

**ğŸ’¡ æœ€ä½³å®è·µ**
- é‡‡ç”¨æ ‡å‡†åŒ–çš„APIæ¥å£
- ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ç®¡ç†é…ç½®æ–‡ä»¶
- å®æ–½ç›‘æ§çš„ç›‘æ§ï¼ˆç›‘æ§ç³»ç»Ÿæœ¬èº«ä¹Ÿè¦è¢«ç›‘æ§ï¼‰
- å»ºç«‹å®Œå–„çš„å˜æ›´ç®¡ç†æµç¨‹

**æ ¸å¿ƒè®°å¿†**ï¼š
- å·¥å…·é›†æˆè®©ç›‘æ§æ›´å¼ºå¤§ï¼Œæ•°æ®è½¬æ¢æ˜¯å…³é”®æŠ€æœ¯
- è‡ªåŠ¨åŒ–å‡å°‘äººå·¥é”™è¯¯ï¼Œæé«˜æ•ˆç‡
- é€‰æ‹©åˆé€‚çš„å·¥å…·ç»„åˆï¼Œå‘æŒ¥å„è‡ªä¼˜åŠ¿
- æŒç»­å­¦ä¹ æ–°æŠ€æœ¯ï¼Œä¿æŒç«äº‰åŠ›