---
title: 4ã€kubectlå‘½ä»¤è¡Œå·¥å…·
---
## ğŸ“š ç›®å½•

1. [kubectlæ˜¯ä»€ä¹ˆ](#1-kubectlæ˜¯ä»€ä¹ˆ)
2. [å®‰è£…ä¸é…ç½®kubectl](#2-å®‰è£…ä¸é…ç½®kubectl)
3. [åŸºç¡€å‘½ä»¤è¯¦è§£](#3-åŸºç¡€å‘½ä»¤è¯¦è§£)
4. [YAMLé…ç½®æ–‡ä»¶å…¥é—¨](#4-YAMLé…ç½®æ–‡ä»¶å…¥é—¨)
5. [èµ„æºç®¡ç†å®æˆ˜æ“ä½œ](#5-èµ„æºç®¡ç†å®æˆ˜æ“ä½œ)
6. [kubeconfigé…ç½®ç®¡ç†](#6-kubeconfigé…ç½®ç®¡ç†)
7. [é«˜æ•ˆä½¿ç”¨æŠ€å·§](#7-é«˜æ•ˆä½¿ç”¨æŠ€å·§)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”§ kubectlæ˜¯ä»€ä¹ˆ


### 1.1 é€šä¿—ç†è§£kubectl


**ç®€å•ç±»æ¯”**ï¼škubectlå°±åƒæ˜¯ä½ å’ŒKubernetesé›†ç¾¤å¯¹è¯çš„"ç¿»è¯‘å®˜"

```
ä½ æƒ³è¦åšçš„äº‹              kubectlçš„ä½œç”¨              Kubernetesé›†ç¾¤
    â†“                      â†“                         â†“
"æˆ‘è¦åˆ›å»ºä¸€ä¸ªåº”ç”¨"  â†’  kubectl create  â†’  åœ¨é›†ç¾¤ä¸­åˆ›å»ºPod
"æŸ¥çœ‹è¿è¡ŒçŠ¶æ€"     â†’  kubectl get      â†’  æ˜¾ç¤ºæ‰€æœ‰è¿è¡Œçš„å®¹å™¨
"åˆ é™¤ä¸ç”¨çš„åº”ç”¨"   â†’  kubectl delete   â†’  ä»é›†ç¾¤ä¸­ç§»é™¤èµ„æº
```

**kubectlçš„æœ¬è´¨**ï¼š
- ğŸ“± **å‘½ä»¤è¡Œå®¢æˆ·ç«¯**ï¼šå°±åƒæ‰‹æœºä¸Šçš„APPï¼Œç”¨æ¥æ“ä½œè¿œç¨‹çš„Kubernetesé›†ç¾¤
- ğŸŒ **APIè°ƒç”¨å·¥å…·**ï¼šæŠŠä½ çš„å‘½ä»¤è½¬æ¢æˆKubernetesèƒ½ç†è§£çš„APIè°ƒç”¨
- ğŸ® **é›†ç¾¤æ§åˆ¶å™¨**ï¼šè®©ä½ èƒ½å¤Ÿç®¡ç†é›†ç¾¤ä¸­çš„æ‰€æœ‰èµ„æº

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦kubectl


**ä¼ ç»Ÿæ–¹å¼ vs kubectlæ–¹å¼**ï¼š

```
ä¼ ç»Ÿéƒ¨ç½²åº”ç”¨ï¼š
ä½  â†’ ç™»å½•æœåŠ¡å™¨ â†’ æ‰‹åŠ¨å®‰è£…è½¯ä»¶ â†’ é…ç½®æœåŠ¡ â†’ å¯åŠ¨ç¨‹åº
    ç¹çã€å®¹æ˜“å‡ºé”™ã€éš¾ä»¥æ‰¹é‡æ“ä½œ

kubectlæ–¹å¼ï¼š
ä½  â†’ kubectl apply -f app.yaml â†’ Kubernetesè‡ªåŠ¨éƒ¨ç½²
    ç®€å•ã€æ ‡å‡†åŒ–ã€å¯é‡å¤ã€æ˜“ç®¡ç†
```

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- âœ… **ç»Ÿä¸€æ“ä½œ**ï¼šä¸€ä¸ªå·¥å…·ç®¡ç†æ•´ä¸ªé›†ç¾¤
- âœ… **å£°æ˜å¼ç®¡ç†**ï¼šæè¿°ä½ æƒ³è¦çš„çŠ¶æ€ï¼Œç³»ç»Ÿè‡ªåŠ¨è¾¾æˆ
- âœ… **æ‰¹é‡æ“ä½œ**ï¼šä¸€ä¸ªå‘½ä»¤å¯ä»¥æ“ä½œå¤šä¸ªèµ„æº
- âœ… **ç‰ˆæœ¬æ§åˆ¶**ï¼šé…ç½®æ–‡ä»¶å¯ä»¥ç”¨Gitç®¡ç†

---

## 2. ğŸ“¥ å®‰è£…ä¸é…ç½®kubectl


### 2.1 å®‰è£…kubectl


**ğŸ’» ä¸åŒç³»ç»Ÿçš„å®‰è£…æ–¹æ³•**ï¼š

| æ“ä½œç³»ç»Ÿ | å®‰è£…æ–¹å¼ | å‘½ä»¤ç¤ºä¾‹ |
|---------|----------|----------|
| ğŸ§ **Linux** | å®˜æ–¹äºŒè¿›åˆ¶ | `curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl"` |
| ğŸ **macOS** | Homebrew | `brew install kubectl` |
| ğŸªŸ **Windows** | Chocolatey | `choco install kubernetes-cli` |

**éªŒè¯å®‰è£…**ï¼š
```bash
kubectl version --client
# è¾“å‡ºç±»ä¼¼ï¼šClient Version: v1.28.0
```

### 2.2 è¿æ¥åˆ°é›†ç¾¤


**ç†è§£kubeconfigæ–‡ä»¶**ï¼š

```
kubeconfigæ–‡ä»¶å°±åƒæ˜¯ä½ çš„"é’¥åŒ™ä¸²"
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        kubeconfig           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”‘ cluster1ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰      â”‚
â”‚ ğŸ”‘ cluster2ï¼ˆæµ‹è¯•ç¯å¢ƒï¼‰      â”‚  
â”‚ ğŸ”‘ cluster3ï¼ˆå¼€å‘ç¯å¢ƒï¼‰      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é…ç½®æ–‡ä»¶ä½ç½®**ï¼š
- é»˜è®¤ä½ç½®ï¼š`~/.kube/config`
- è‡ªå®šä¹‰ä½ç½®ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡ `KUBECONFIG`

### 2.3 åŸºç¡€è¿æ¥æµ‹è¯•


```bash
# æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯
kubectl cluster-info

# æŸ¥çœ‹èŠ‚ç‚¹åˆ—è¡¨
kubectl get nodes

# æŸ¥çœ‹å½“å‰é…ç½®
kubectl config view
```

**ğŸ” ç†è§£è¾“å‡ºç»“æœ**ï¼š
- âœ… **æ­£å¸¸è¿æ¥**ï¼šèƒ½çœ‹åˆ°é›†ç¾¤ä¿¡æ¯å’ŒèŠ‚ç‚¹åˆ—è¡¨
- âŒ **è¿æ¥å¤±è´¥**ï¼šæ£€æŸ¥ç½‘ç»œè¿æ¥å’Œé…ç½®æ–‡ä»¶
- âš ï¸ **æƒé™ä¸è¶³**ï¼šç¡®è®¤ç”¨æˆ·æƒé™é…ç½®æ­£ç¡®

---

## 3. âš¡ åŸºç¡€å‘½ä»¤è¯¦è§£


### 3.1 æŸ¥çœ‹èµ„æº - GETå‘½ä»¤


**getå‘½ä»¤**ï¼šå°±åƒ"æŸ¥çœ‹"åŠŸèƒ½ï¼Œè®©ä½ çœ‹åˆ°é›†ç¾¤ä¸­æœ‰ä»€ä¹ˆ

```bash
# åŸºç¡€è¯­æ³•
kubectl get <èµ„æºç±»å‹> [èµ„æºåç§°] [å‚æ•°]
```

**å¸¸ç”¨æŸ¥çœ‹æ“ä½œ**ï¼š

| å‘½ä»¤ | ä½œç”¨ | å®é™…å«ä¹‰ |
|------|------|----------|
| `kubectl get pods` | æŸ¥çœ‹æ‰€æœ‰Pod | "ç»™æˆ‘çœ‹çœ‹ç°åœ¨è¿è¡Œçš„æ‰€æœ‰åº”ç”¨" |
| `kubectl get nodes` | æŸ¥çœ‹é›†ç¾¤èŠ‚ç‚¹ | "é›†ç¾¤æœ‰å‡ å°æœåŠ¡å™¨ï¼Ÿ" |
| `kubectl get services` | æŸ¥çœ‹æœåŠ¡ | "æœ‰å“ªäº›å¯¹å¤–æä¾›çš„æœåŠ¡ï¼Ÿ" |
| `kubectl get deployments` | æŸ¥çœ‹éƒ¨ç½² | "éƒ¨ç½²äº†å“ªäº›åº”ç”¨ï¼Ÿ" |

**è¾“å‡ºæ ¼å¼æ§åˆ¶**ï¼š
```bash
# è¯¦ç»†ä¿¡æ¯
kubectl get pods -o wide

# YAMLæ ¼å¼
kubectl get pod my-pod -o yaml

# JSONæ ¼å¼  
kubectl get pod my-pod -o json

# è‡ªå®šä¹‰åˆ—
kubectl get pods -o custom-columns=NAME:.metadata.name,STATUS:.status.phase
```

### 3.2 è¯¦ç»†æè¿° - DESCRIBEå‘½ä»¤


**describeå‘½ä»¤**ï¼šå°±åƒ"è¯¦ç»†ä¿¡æ¯"åŠŸèƒ½ï¼Œå‘Šè¯‰ä½ èµ„æºçš„å®Œæ•´çŠ¶æ€

```bash
# æŸ¥çœ‹Podè¯¦ç»†ä¿¡æ¯
kubectl describe pod my-pod

# æŸ¥çœ‹èŠ‚ç‚¹è¯¦ç»†ä¿¡æ¯
kubectl describe node worker-node-1
```

**ğŸ“‹ describeè¾“å‡ºåŒ…å«**ï¼š
- **åŸºæœ¬ä¿¡æ¯**ï¼šåç§°ã€å‘½åç©ºé—´ã€åˆ›å»ºæ—¶é—´
- **çŠ¶æ€ä¿¡æ¯**ï¼šè¿è¡ŒçŠ¶æ€ã€é‡å¯æ¬¡æ•°ã€èµ„æºä½¿ç”¨
- **äº‹ä»¶å†å²**ï¼šæœ€è¿‘å‘ç”Ÿçš„æ“ä½œå’Œé”™è¯¯
- **é…ç½®è¯¦æƒ…**ï¼šç¯å¢ƒå˜é‡ã€æŒ‚è½½çš„å­˜å‚¨ç­‰

### 3.3 åˆ›å»ºèµ„æº - CREATEå’ŒAPPLY


**ä¸¤ç§åˆ›å»ºæ–¹å¼çš„åŒºåˆ«**ï¼š

```
CREATE vs APPLY é€šä¿—ç†è§£ï¼š

CREATEåƒ"æ–°å»ºæ–‡ä»¶"ï¼š
- å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ â†’ åˆ›å»ºæˆåŠŸ âœ…
- å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ â†’ æŠ¥é”™å¤±è´¥ âŒ

APPLYåƒ"ä¿å­˜æ–‡ä»¶"ï¼š  
- å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ â†’ åˆ›å»ºæ–°çš„ âœ…
- å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ â†’ æ›´æ–°å†…å®¹ âœ…
```

**å®é™…ä½¿ç”¨å»ºè®®**ï¼š
- ğŸ†• **å­¦ä¹ é˜¶æ®µ**ï¼šç”¨CREATEç†è§£èµ„æºåˆ›å»ºè¿‡ç¨‹
- ğŸ”„ **ç”Ÿäº§ç¯å¢ƒ**ï¼šç”¨APPLYæ”¯æŒé…ç½®æ›´æ–°

### 3.4 åˆ é™¤èµ„æº - DELETEå‘½ä»¤


**deleteå‘½ä»¤**ï¼šå°±åƒ"åˆ é™¤"åŠŸèƒ½ï¼Œä»é›†ç¾¤ä¸­ç§»é™¤èµ„æº

```bash
# åˆ é™¤å•ä¸ªèµ„æº
kubectl delete pod my-pod

# åˆ é™¤å¤šä¸ªèµ„æº
kubectl delete pods pod1 pod2 pod3

# é€šè¿‡æ–‡ä»¶åˆ é™¤
kubectl delete -f my-app.yaml

# åˆ é™¤æ‰€æœ‰åŒç±»èµ„æº
kubectl delete pods --all
```

**âš ï¸ å®‰å…¨æé†’**ï¼š
- åˆ é™¤æ“ä½œé€šå¸¸ä¸å¯æ¢å¤
- ç”Ÿäº§ç¯å¢ƒå»ºè®®å…ˆå¤‡ä»½é…ç½®
- å¯ä»¥ä½¿ç”¨ `--dry-run` å‚æ•°é¢„è§ˆæ“ä½œ

---

## 4. ğŸ“ YAMLé…ç½®æ–‡ä»¶å…¥é—¨


### 4.1 ä»€ä¹ˆæ˜¯YAML


**YAMLç®€å•ç†è§£**ï¼šå°±åƒå¡«è¡¨æ ¼ï¼Œç”¨æ¥æè¿°ä½ æƒ³è¦çš„åº”ç”¨é…ç½®

```yaml
# YAMLå°±åƒè¿™æ ·çš„è¡¨æ ¼
å§“å: å¼ ä¸‰
å¹´é¾„: 25  
åœ°å€:
  çœä»½: åŒ—äº¬
  åŸå¸‚: åŒ—äº¬å¸‚
  åŒºå¿: æµ·æ·€åŒº
çˆ±å¥½:
  - ç¼–ç¨‹
  - è¯»ä¹¦
  - è¿åŠ¨
```

**YAMLåŸºç¡€è¯­æ³•è§„åˆ™**ï¼š
- ğŸ”¸ **å†’å·åˆ†éš”**ï¼š`key: value` è¡¨ç¤ºé”®å€¼å¯¹
- ğŸ”¸ **ç¼©è¿›è¡¨ç¤ºå±‚çº§**ï¼šç”¨ç©ºæ ¼ç¼©è¿›ï¼Œä¸èƒ½ç”¨Tab
- ğŸ”¸ **çŸ­æ¨ªçº¿è¡¨ç¤ºåˆ—è¡¨**ï¼š`- é¡¹ç›®1`
- ğŸ”¸ **äº•å·è¡¨ç¤ºæ³¨é‡Š**ï¼š`# è¿™æ˜¯æ³¨é‡Š`

### 4.2 Kubernetes YAMLç»“æ„


**æ ‡å‡†çš„K8s YAMLåŒ…å«å››ä¸ªéƒ¨åˆ†**ï¼š

```yaml
# 1. APIç‰ˆæœ¬ - å‘Šè¯‰K8sç”¨å“ªä¸ªç‰ˆæœ¬çš„API
apiVersion: apps/v1

# 2. èµ„æºç±»å‹ - è¿™æ˜¯ä»€ä¹ˆç±»å‹çš„èµ„æº  
kind: Deployment

# 3. å…ƒæ•°æ® - èµ„æºçš„åŸºæœ¬ä¿¡æ¯
metadata:
  name: my-app        # èµ„æºåç§°
  namespace: default  # æ‰€åœ¨å‘½åç©ºé—´
  
# 4. è§„æ ¼è¯´æ˜ - è¯¦ç»†é…ç½®
spec:
  replicas: 3         # æƒ³è¦è¿è¡Œ3ä¸ªå‰¯æœ¬
  selector:
    matchLabels:
      app: my-app
  template:
    metadata:
      labels:
        app: my-app
    spec:
      containers:
      - name: app
        image: nginx:1.20
        ports:
        - containerPort: 80
```

### 4.3 å¸¸è§èµ„æºç±»å‹ç¼©å†™


**èµ„æºç±»å‹**ï¼šæ¯ç§èµ„æºéƒ½æœ‰å…¨ç§°å’Œç¼©å†™ï¼Œæ–¹ä¾¿å¿«é€Ÿè¾“å…¥

| å…¨ç§° | ç¼©å†™ | ä¸­æ–‡å«ä¹‰ | ç”¨é€” |
|------|------|----------|------|
| `pods` | `po` | å®¹å™¨ç»„ | è¿è¡Œåº”ç”¨çš„åŸºæœ¬å•å…ƒ |
| `services` | `svc` | æœåŠ¡ | æä¾›ç½‘ç»œè®¿é—® |
| `deployments` | `deploy` | éƒ¨ç½² | ç®¡ç†åº”ç”¨çš„å¤šä¸ªå‰¯æœ¬ |
| `configmaps` | `cm` | é…ç½®æ˜ å°„ | å­˜å‚¨é…ç½®ä¿¡æ¯ |
| `secrets` | `secret` | å¯†é’¥ | å­˜å‚¨æ•æ„Ÿä¿¡æ¯ |
| `nodes` | `no` | èŠ‚ç‚¹ | é›†ç¾¤ä¸­çš„æœåŠ¡å™¨ |

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```bash
# è¿™ä¸¤ä¸ªå‘½ä»¤æ•ˆæœç›¸åŒ
kubectl get pods
kubectl get po

# è¿™ä¸¤ä¸ªå‘½ä»¤æ•ˆæœç›¸åŒ  
kubectl get services
kubectl get svc
```

---

## 5. ğŸ› ï¸ èµ„æºç®¡ç†å®æˆ˜æ“ä½œ


### 5.1 åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªåº”ç”¨


**æ­¥éª¤1ï¼šåˆ›å»ºåº”ç”¨é…ç½®æ–‡ä»¶**

```yaml
# my-first-app.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-nginx
spec:
  replicas: 2
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:1.20
        ports:
        - containerPort: 80
```

**æ­¥éª¤2ï¼šéƒ¨ç½²åº”ç”¨**
```bash
# åº”ç”¨é…ç½®æ–‡ä»¶
kubectl apply -f my-first-app.yaml

# æŸ¥çœ‹éƒ¨ç½²ç»“æœ
kubectl get deployments
kubectl get pods
```

**æ­¥éª¤3ï¼šæŸ¥çœ‹åº”ç”¨çŠ¶æ€**
```bash
# æŸ¥çœ‹Podè¯¦ç»†ä¿¡æ¯
kubectl describe pod <pod-name>

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
kubectl logs <pod-name>
```

### 5.2 åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†


**å®Œæ•´çš„åº”ç”¨ç®¡ç†æµç¨‹**ï¼š

```
åˆ›å»ºåº”ç”¨ â†’ æŸ¥çœ‹çŠ¶æ€ â†’ æ›´æ–°é…ç½® â†’ æ‰©å®¹ç¼©å®¹ â†’ åˆ é™¤åº”ç”¨
    â†“         â†“         â†“         â†“         â†“
  apply     get       apply     scale    delete
```

**æ‰©å®¹ç¼©å®¹æ“ä½œ**ï¼š
```bash
# æ‰©å®¹åˆ°5ä¸ªå‰¯æœ¬
kubectl scale deployment my-nginx --replicas=5

# ç¼©å®¹åˆ°1ä¸ªå‰¯æœ¬
kubectl scale deployment my-nginx --replicas=1

# æŸ¥çœ‹æ‰©å®¹ç»“æœ
kubectl get deployment my-nginx
```

**æ›´æ–°åº”ç”¨é•œåƒ**ï¼š
```bash
# æ›´æ–°é•œåƒç‰ˆæœ¬
kubectl set image deployment/my-nginx nginx=nginx:1.21

# æŸ¥çœ‹æ›´æ–°è¿‡ç¨‹
kubectl rollout status deployment/my-nginx

# å¦‚æœæ›´æ–°æœ‰é—®é¢˜ï¼Œå›æ»šåˆ°ä¸Šä¸€ç‰ˆæœ¬
kubectl rollout undo deployment/my-nginx
```

### 5.3 æ•…éšœæ’æŸ¥åŸºç¡€æ“ä½œ


**å¸¸ç”¨æ’æŸ¥å‘½ä»¤**ï¼š

| é—®é¢˜åœºæ™¯ | ä½¿ç”¨å‘½ä»¤ | æŸ¥çœ‹ä»€ä¹ˆ |
|---------|----------|----------|
| ğŸ”´ Podæ— æ³•å¯åŠ¨ | `kubectl describe pod <name>` | æŸ¥çœ‹é”™è¯¯äº‹ä»¶ |
| ğŸ“Š æŸ¥çœ‹èµ„æºä½¿ç”¨ | `kubectl top pods` | CPUå’Œå†…å­˜ä½¿ç”¨æƒ…å†µ |
| ğŸ“ æŸ¥çœ‹åº”ç”¨æ—¥å¿— | `kubectl logs <pod-name>` | åº”ç”¨è¿è¡Œæ—¥å¿— |
| ğŸ” è¿›å…¥å®¹å™¨è°ƒè¯• | `kubectl exec -it <pod> -- /bin/bash` | åœ¨å®¹å™¨å†…æ‰§è¡Œå‘½ä»¤ |

**æ’æŸ¥é—®é¢˜çš„ä¸€èˆ¬æ­¥éª¤**ï¼š
```
1. kubectl get pods              # æŸ¥çœ‹PodçŠ¶æ€
2. kubectl describe pod <name>   # æŸ¥çœ‹è¯¦ç»†äº‹ä»¶
3. kubectl logs <pod-name>       # æŸ¥çœ‹åº”ç”¨æ—¥å¿—  
4. kubectl exec -it <pod> -- sh  # è¿›å…¥å®¹å™¨æ£€æŸ¥
```

---

## 6. âš™ï¸ kubeconfigé…ç½®ç®¡ç†


### 6.1 ç†è§£kubeconfig


**kubeconfigå°±åƒç”µè¯ç°¿**ï¼šå­˜å‚¨äº†æ‰€æœ‰é›†ç¾¤çš„"è”ç³»æ–¹å¼"

```
kubeconfigæ–‡ä»¶ç»“æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         clusters            â”‚  â† é›†ç¾¤ä¿¡æ¯ï¼ˆæœåŠ¡å™¨åœ°å€ï¼‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         users               â”‚  â† ç”¨æˆ·ä¿¡æ¯ï¼ˆè®¤è¯å‡­æ®ï¼‰  
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        contexts             â”‚  â† ä¸Šä¸‹æ–‡ï¼ˆé›†ç¾¤+ç”¨æˆ·çš„ç»„åˆï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®é™…é…ç½®ç¤ºä¾‹**ï¼š
```yaml
# ~/.kube/config
apiVersion: v1
kind: Config
clusters:
- cluster:
    server: https://prod-cluster.example.com
  name: production
- cluster:  
    server: https://test-cluster.example.com
  name: testing
users:
- name: admin
  user:
    token: abc123...
contexts:
- context:
    cluster: production
    user: admin
  name: prod-admin
- context:
    cluster: testing  
    user: admin
  name: test-admin
current-context: prod-admin
```

### 6.2 Contextä¸Šä¸‹æ–‡åˆ‡æ¢


**Contextæ¦‚å¿µ**ï¼šå°±åƒæ‰‹æœºä¸Šçš„"å·¥ä½œæ¨¡å¼"å’Œ"ä¸ªäººæ¨¡å¼"

```
Context = é›†ç¾¤ + ç”¨æˆ· + å‘½åç©ºé—´

ä¾‹å¦‚ï¼š
ğŸ“± å·¥ä½œæ¨¡å¼ = å…¬å¸é›†ç¾¤ + å·¥ä½œè´¦å· + ç”Ÿäº§å‘½åç©ºé—´
ğŸ“± æµ‹è¯•æ¨¡å¼ = æµ‹è¯•é›†ç¾¤ + æµ‹è¯•è´¦å· + æµ‹è¯•å‘½åç©ºé—´
```

**Contextç®¡ç†å‘½ä»¤**ï¼š
```bash
# æŸ¥çœ‹æ‰€æœ‰context
kubectl config get-contexts

# æŸ¥çœ‹å½“å‰context
kubectl config current-context

# åˆ‡æ¢context
kubectl config use-context test-admin

# è®¾ç½®é»˜è®¤å‘½åç©ºé—´
kubectl config set-context --current --namespace=my-app
```

**ğŸ’¡ å®ç”¨æŠ€å·§**ï¼š
- ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒcontextï¼Œé¿å…è¯¯æ“ä½œ
- å¯ä»¥åœ¨å‘½ä»¤è¡Œæç¤ºç¬¦ä¸­æ˜¾ç¤ºå½“å‰context
- ä½¿ç”¨å·¥å…·å¦‚`kubectx`ç®€åŒ–contextåˆ‡æ¢

### 6.3 å¤šé›†ç¾¤ç®¡ç†


**ç®¡ç†å¤šä¸ªé›†ç¾¤çš„æœ€ä½³å®è·µ**ï¼š

```bash
# æ·»åŠ æ–°é›†ç¾¤é…ç½®
kubectl config set-cluster new-cluster \
  --server=https://new-cluster.example.com \
  --certificate-authority=ca.crt

# æ·»åŠ ç”¨æˆ·å‡­è¯
kubectl config set-credentials new-user \
  --client-certificate=user.crt \
  --client-key=user.key

# åˆ›å»ºæ–°çš„context
kubectl config set-context new-context \
  --cluster=new-cluster \
  --user=new-user \
  --namespace=default
```

---

## 7. ğŸš€ é«˜æ•ˆä½¿ç”¨æŠ€å·§


### 7.1 å¹²è¿è¡Œæ¨¡å¼


**--dry-runå‚æ•°**ï¼šå°±åƒ"é¢„è§ˆ"åŠŸèƒ½ï¼Œè®©ä½ çœ‹çœ‹å‘½ä»¤ä¼šäº§ç”Ÿä»€ä¹ˆæ•ˆæœ

```bash
# é¢„è§ˆåˆ›å»ºPodä½†ä¸å®é™…åˆ›å»º
kubectl run test-pod --image=nginx --dry-run=client -o yaml

# é¢„è§ˆåº”ç”¨é…ç½®æ–‡ä»¶ä½†ä¸å®é™…éƒ¨ç½²  
kubectl apply -f app.yaml --dry-run=client

# é¢„è§ˆåˆ é™¤æ“ä½œä½†ä¸å®é™…åˆ é™¤
kubectl delete pod test-pod --dry-run=client
```

**ğŸ¯ å¹²è¿è¡Œçš„ç”¨é€”**ï¼š
- âœ… **å­¦ä¹ éªŒè¯**ï¼šéªŒè¯YAMLè¯­æ³•æ˜¯å¦æ­£ç¡®
- âœ… **ç”Ÿäº§ä¿æŠ¤**ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒæ‰§è¡Œå‰ç¡®è®¤æ“ä½œ
- âœ… **ç”Ÿæˆæ¨¡æ¿**ï¼šå¿«é€Ÿç”ŸæˆYAMLé…ç½®æ¨¡æ¿

### 7.2 è¾“å‡ºæ ¼å¼æ§åˆ¶


**ä¸°å¯Œçš„è¾“å‡ºæ ¼å¼**ï¼š

```bash
# è¡¨æ ¼æ ¼å¼ï¼ˆé»˜è®¤ï¼‰
kubectl get pods

# å®½è¡¨æ ¼æ ¼å¼ï¼Œæ˜¾ç¤ºæ›´å¤šä¿¡æ¯
kubectl get pods -o wide

# YAMLæ ¼å¼ï¼Œæ˜¾ç¤ºå®Œæ•´é…ç½®
kubectl get pod my-pod -o yaml

# JSONæ ¼å¼ï¼Œä¾¿äºç¨‹åºå¤„ç†
kubectl get pod my-pod -o json

# è‡ªå®šä¹‰åˆ—æ˜¾ç¤º
kubectl get pods -o custom-columns=\
"NAME:.metadata.name,STATUS:.status.phase,NODE:.spec.nodeName"

# æ˜¾ç¤ºèµ„æºæ ‡ç­¾
kubectl get pods --show-labels

# æŒ‰æ ‡ç­¾è¿‡æ»¤
kubectl get pods -l app=nginx
```

### 7.3 å‘½ä»¤è¡Œå¿«æ·æŠ€å·§


**æé«˜æ•ˆç‡çš„å¿«æ·æ“ä½œ**ï¼š

```bash
# ä½¿ç”¨èµ„æºç¼©å†™
kubectl get po,svc,deploy  # åŒæ—¶æŸ¥çœ‹podsã€servicesã€deployments

# ä½¿ç”¨é€šé…ç¬¦
kubectl delete pods --all  # åˆ é™¤æ‰€æœ‰pods

# ç»„åˆæ“ä½œ
kubectl get pods -o name | head -5  # è·å–å‰5ä¸ªpodåç§°

# å¿«é€Ÿè¿›å…¥Pod
kubectl exec -it $(kubectl get pod -l app=nginx -o jsonpath='{.items[0].metadata.name}') -- bash

# æŸ¥çœ‹æœ€è¿‘çš„äº‹ä»¶
kubectl get events --sort-by=.metadata.creationTimestamp

# ç›‘æ§èµ„æºå˜åŒ–
kubectl get pods -w  # å®æ—¶ç›‘æ§podçŠ¶æ€å˜åŒ–
```

### 7.4 å¸¸ç”¨åˆ«åè®¾ç½®


**è®¾ç½®å‘½ä»¤åˆ«åæé«˜æ•ˆç‡**ï¼š

```bash
# åœ¨ ~/.bashrc æˆ– ~/.zshrc ä¸­æ·»åŠ 
alias k='kubectl'
alias kg='kubectl get'
alias kd='kubectl describe'  
alias ka='kubectl apply -f'
alias kdel='kubectl delete'

# ä½¿ç”¨ç¤ºä¾‹
k get po           # ç­‰åŒäº kubectl get pods
kg svc             # ç­‰åŒäº kubectl get services
kd pod my-pod      # ç­‰åŒäº kubectl describe pod my-pod
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ kubectlæœ¬è´¨ï¼šå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨æ¥æ“ä½œKubernetesé›†ç¾¤
ğŸ”¸ åŸºç¡€å‘½ä»¤ï¼šgetï¼ˆæŸ¥çœ‹ï¼‰ã€describeï¼ˆè¯¦æƒ…ï¼‰ã€applyï¼ˆéƒ¨ç½²ï¼‰ã€deleteï¼ˆåˆ é™¤ï¼‰
ğŸ”¸ YAMLé…ç½®ï¼šæè¿°åº”ç”¨é…ç½®çš„æ ‡å‡†æ ¼å¼ï¼ŒåŒ…å«å››ä¸ªæ ¸å¿ƒéƒ¨åˆ†
ğŸ”¸ èµ„æºç¼©å†™ï¼špods=po, services=svc, deployments=deployç­‰
ğŸ”¸ kubeconfigï¼šå­˜å‚¨é›†ç¾¤è¿æ¥ä¿¡æ¯çš„é…ç½®æ–‡ä»¶
ğŸ”¸ Contextï¼šé›†ç¾¤+ç”¨æˆ·+å‘½åç©ºé—´çš„ç»„åˆï¼Œç”¨äºç¯å¢ƒåˆ‡æ¢
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ kubectlçš„å·¥ä½œåŸç†**
```
ä½ çš„å‘½ä»¤ â†’ kubectl â†’ Kubernetes API â†’ é›†ç¾¤æ“ä½œ
    â†‘         â†‘           â†‘              â†‘
  ç”¨æˆ·æ„å›¾   è½¬æ¢å·¥å…·     æ ‡å‡†æ¥å£        å®é™…æ‰§è¡Œ
```

**ğŸ”¹ YAMLé…ç½®æ–‡ä»¶çš„é‡è¦æ€§**
```
å‘½ä»¤è¡Œæ“ä½œï¼šä¸´æ—¶ã€éš¾å¤ç°ã€ä¸ä¾¿ç‰ˆæœ¬æ§åˆ¶
YAMLæ–‡ä»¶ï¼šæŒä¹…ã€å¯å¤ç°ã€æ”¯æŒç‰ˆæœ¬æ§åˆ¶ã€å›¢é˜Ÿåä½œ
```

**ğŸ”¹ Contextçš„å®é™…ä»·å€¼**
```
é¿å…è¯¯æ“ä½œï¼šæµ‹è¯•å‘½ä»¤åœ¨ç”Ÿäº§ç¯å¢ƒæ‰§è¡Œ
ç¯å¢ƒéš”ç¦»ï¼šå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒæ¸…æ™°åˆ†ç¦»
æƒé™ç®¡ç†ï¼šä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒçš„ç”¨æˆ·æƒé™
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ æ–°æ‰‹å­¦ä¹ è·¯å¾„**
```
ç¬¬ä¸€é˜¶æ®µï¼šæŒæ¡åŸºç¡€æŸ¥çœ‹å‘½ä»¤ï¼ˆget, describeï¼‰
ç¬¬äºŒé˜¶æ®µï¼šå­¦ä¼šåˆ›å»ºå’Œåˆ é™¤èµ„æºï¼ˆapply, deleteï¼‰  
ç¬¬ä¸‰é˜¶æ®µï¼šç†è§£YAMLé…ç½®æ–‡ä»¶ç»“æ„
ç¬¬å››é˜¶æ®µï¼šæŒæ¡å¤šç¯å¢ƒåˆ‡æ¢ï¼ˆcontextç®¡ç†ï¼‰
ç¬¬äº”é˜¶æ®µï¼šå­¦ä¹ æ•…éšœæ’æŸ¥å’Œè°ƒä¼˜æŠ€å·§
```

**ğŸ› ï¸ æ—¥å¸¸å·¥ä½œæµç¨‹**
```
1. å‡†å¤‡YAMLé…ç½®æ–‡ä»¶
2. ä½¿ç”¨dry-runéªŒè¯é…ç½®  
3. applyéƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ
4. éªŒè¯åº”ç”¨è¿è¡ŒçŠ¶æ€
5. applyéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
6. ç›‘æ§åº”ç”¨è¿è¡ŒçŠ¶å†µ
```

**âš ï¸ å¸¸è§é”™è¯¯é¿å…**
- **æƒé™é”™è¯¯**ï¼šç¡®ä¿kubeconfigé…ç½®æ­£ç¡®
- **å‘½åç©ºé—´é”™è¯¯**ï¼šæ³¨æ„åˆ‡æ¢åˆ°æ­£ç¡®çš„namespace
- **èµ„æºå†²çª**ï¼šåˆ é™¤èµ„æºå‰ç¡®è®¤ä¾èµ–å…³ç³»
- **YAMLè¯­æ³•é”™è¯¯**ï¼šæ³¨æ„ç¼©è¿›å’Œæ ¼å¼
- **contextæ··æ·†**ï¼šæ“ä½œå‰ç¡®è®¤å½“å‰ç¯å¢ƒ

### 8.4 è¿›é˜¶å­¦ä¹ å»ºè®®


**ğŸš€ æå‡æ•ˆç‡çš„æŠ€å·§**
- ç†Ÿç»ƒä½¿ç”¨èµ„æºç¼©å†™å’Œå‘½ä»¤åˆ«å
- æŒæ¡è¾“å‡ºæ ¼å¼æ§åˆ¶å’Œè¿‡æ»¤æŠ€å·§
- å­¦ä¼šä½¿ç”¨dry-runé¢„è§ˆæ“ä½œç»“æœ
- å»ºç«‹å¤šç¯å¢ƒçš„contextç®¡ç†è§„èŒƒ

**ğŸ“š æ‰©å±•å­¦ä¹ æ–¹å‘**
- **Helm**ï¼šKubernetesçš„åŒ…ç®¡ç†å·¥å…·
- **Kustomize**ï¼šé…ç½®ç®¡ç†å·¥å…·
- **kubectlæ’ä»¶**ï¼šæ‰©å±•kubectlåŠŸèƒ½
- **ç›‘æ§å·¥å…·**ï¼šPrometheus + Grafana

**æ ¸å¿ƒè®°å¿†**ï¼š
- kubectlæ˜¯ä½ æ“ä½œK8sçš„ä¸»è¦å·¥å…·ï¼Œç†Ÿç»ƒæŒæ¡åŸºç¡€å‘½ä»¤æ˜¯å‰æ
- YAMLé…ç½®æ–‡ä»¶æ˜¯åŸºç¡€è®¾æ–½å³ä»£ç çš„ä½“ç°ï¼Œæ˜¯å›¢é˜Ÿåä½œçš„åŸºç¡€
- Contextç®¡ç†æ˜¯å¤šç¯å¢ƒæ“ä½œçš„å…³é”®ï¼Œé¿å…è¯¯æ“ä½œçš„é‡è¦é˜²çº¿
- å®è·µå‡ºçœŸçŸ¥ï¼Œå¤šåŠ¨æ‰‹æ“ä½œæ‰èƒ½çœŸæ­£æŒæ¡kubectlçš„ä½¿ç”¨æŠ€å·§