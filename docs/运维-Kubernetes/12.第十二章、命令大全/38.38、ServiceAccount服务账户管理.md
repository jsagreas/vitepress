---
title: 38ã€ServiceAccountæœåŠ¡è´¦æˆ·ç®¡ç†
---
## ğŸ“š ç›®å½•

1. [ServiceAccountåŸºç¡€æ¦‚å¿µ](#1-serviceaccountåŸºç¡€æ¦‚å¿µ)
2. [ServiceAccountæ ¸å¿ƒæ“ä½œ](#2-serviceaccountæ ¸å¿ƒæ“ä½œ)
3. [Tokenä»¤ç‰Œç®¡ç†](#3-tokenä»¤ç‰Œç®¡ç†)
4. [æƒé™ç»‘å®šä¸å®‰å…¨æ§åˆ¶](#4-æƒé™ç»‘å®šä¸å®‰å…¨æ§åˆ¶)
5. [å®é™…åº”ç”¨åœºæ™¯](#5-å®é™…åº”ç”¨åœºæ™¯)
6. [æ•…éšœæ’æŸ¥ä¸æœ€ä½³å®è·µ](#6-æ•…éšœæ’æŸ¥ä¸æœ€ä½³å®è·µ)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” ServiceAccountåŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯ServiceAccountï¼Ÿ


**ğŸ¯ é€šä¿—ç†è§£**
æƒ³è±¡ä¸€ä¸‹ç°å®ç”Ÿæ´»ä¸­çš„èº«ä»½è¯ï¼šå½“ä½ éœ€è¦åŠç†é“¶è¡Œä¸šåŠ¡æ—¶ï¼Œå¿…é¡»å‡ºç¤ºèº«ä»½è¯è¯æ˜ä½ æ˜¯è°ã€‚**ServiceAccountå°±åƒæ˜¯Podçš„èº«ä»½è¯**ï¼Œç”¨æ¥è¯æ˜Podçš„èº«ä»½ï¼Œè®©Podèƒ½å¤Ÿè®¿é—®Kubernetesé›†ç¾¤çš„èµ„æºã€‚

```
ç°å®ä¸–ç•Œçš„èº«ä»½éªŒè¯ï¼š
äºº â†’ å‡ºç¤ºèº«ä»½è¯ â†’ é“¶è¡Œ â†’ éªŒè¯èº«ä»½ â†’ æä¾›æœåŠ¡

Kubernetesä¸–ç•Œçš„èº«ä»½éªŒè¯ï¼š
Pod â†’ ä½¿ç”¨ServiceAccount â†’ API Server â†’ éªŒè¯èº«ä»½ â†’ è®¿é—®èµ„æº
```

**ğŸ”¸ ServiceAccountæ ¸å¿ƒä½œç”¨**
- **èº«ä»½æ ‡è¯†**ï¼šä¸ºPodæä¾›èº«ä»½è®¤è¯
- **æƒé™æ§åˆ¶**ï¼šå†³å®šPodèƒ½åšä»€ä¹ˆæ“ä½œ
- **å®‰å…¨éš”ç¦»**ï¼šä¸åŒçš„Podå¯ä»¥æœ‰ä¸åŒçš„æƒé™

### 1.2 ServiceAccount vs ç”¨æˆ·è´¦æˆ·


**ğŸ” ä¸¤è€…åŒºåˆ«å¯¹æ¯”**

| ç‰¹å¾ | **ServiceAccount** | **ç”¨æˆ·è´¦æˆ·(User)** |
|------|------------------|------------------|
| ğŸ¯ **ç”¨é€”** | `Podå†…çš„ç¨‹åºä½¿ç”¨` | `äººç±»ç”¨æˆ·ä½¿ç”¨` |
| ğŸ“ **ä½œç”¨åŸŸ** | `å‘½åç©ºé—´çº§åˆ«` | `é›†ç¾¤çº§åˆ«` |
| â° **ç”Ÿå‘½å‘¨æœŸ** | `ç”±Kubernetesç®¡ç†` | `ç”±å¤–éƒ¨ç³»ç»Ÿç®¡ç†` |
| ğŸ”‘ **è®¤è¯æ–¹å¼** | `Tokenè‡ªåŠ¨æŒ‚è½½` | `è¯ä¹¦ã€Tokenç­‰å¤šç§` |
| ğŸ“ **åˆ›å»ºæ–¹å¼** | `kubectlå‘½ä»¤åˆ›å»º` | `å¤–éƒ¨èº«ä»½ç³»ç»Ÿ` |

> ğŸ’¡ **æ–°æ‰‹æç¤º**  
> ç®€å•è®°ä½ï¼šServiceAccountæ˜¯ç»™"ç¨‹åº"ç”¨çš„ï¼ŒUseræ˜¯ç»™"äºº"ç”¨çš„ï¼

### 1.3 ServiceAccountå·¥ä½œåŸç†


**ğŸ”„ å·¥ä½œæµç¨‹å›¾ç¤º**
```
Podå¯åŠ¨
    â†“
è‡ªåŠ¨æŒ‚è½½ServiceAccount Token
    â†“
Podå†…ç¨‹åºè®¿é—®API Server
    â†“
API ServeréªŒè¯Token
    â†“
æ£€æŸ¥RBACæƒé™è§„åˆ™
    â†“
å…è®¸/æ‹’ç»è®¿é—®
```

**ğŸ“‹ æ ¸å¿ƒç»„ä»¶å…³ç³»**
```
ServiceAccount æœåŠ¡è´¦æˆ·
    â†“ å…³è”
Secret (å­˜å‚¨Token)
    â†“ æŒ‚è½½åˆ°
Pod (/var/run/secrets/kubernetes.io/serviceaccount/)
    â†“ ä½¿ç”¨Tokenè®¿é—®
Kubernetes API Server
```

---

## 2. ğŸ› ï¸ ServiceAccountæ ¸å¿ƒæ“ä½œ


### 2.1 åˆ›å»ºServiceAccount


**ğŸ”§ åŸºç¡€åˆ›å»ºå‘½ä»¤**
```bash
# åˆ›å»ºæœåŠ¡è´¦æˆ·
kubectl create serviceaccount my-app-sa

# åœ¨æŒ‡å®šå‘½åç©ºé—´åˆ›å»º
kubectl create serviceaccount my-app-sa -n production
```

> ğŸ¯ **å®ç”¨æŠ€å·§**  
> ServiceAccountåç§°è¦æœ‰æ„ä¹‰ï¼Œå»ºè®®æ ¼å¼ï¼š`åº”ç”¨å-åŠŸèƒ½-sa`ï¼Œæ¯”å¦‚ `web-app-reader-sa`

**ğŸ“ æŸ¥çœ‹åˆ›å»ºç»“æœ**
```bash
# åˆ—å‡ºå½“å‰å‘½åç©ºé—´çš„æ‰€æœ‰ServiceAccount
kubectl get serviceaccounts
kubectl get sa  # ç®€å†™å½¢å¼

# æŸ¥çœ‹æ‰€æœ‰å‘½åç©ºé—´çš„ServiceAccount
kubectl get sa --all-namespaces
```

**ğŸ“Š è¾“å‡ºç¤ºä¾‹è§£è¯»**
```
NAME       SECRETS   AGE
default    1         50d
my-app-sa  1         5m
```
- **default**ï¼šæ¯ä¸ªå‘½åç©ºé—´è‡ªåŠ¨åˆ›å»ºçš„é»˜è®¤ServiceAccount
- **SECRETS**ï¼šå…³è”çš„Secretæ•°é‡ï¼ˆé€šå¸¸æ˜¯Tokenï¼‰
- **AGE**ï¼šåˆ›å»ºæ—¶é—´

### 2.2 æŸ¥çœ‹ServiceAccountè¯¦ç»†ä¿¡æ¯


**ğŸ” è¯¦ç»†ä¿¡æ¯æŸ¥çœ‹**
```bash
# æŸ¥çœ‹ServiceAccountè¯¦ç»†ä¿¡æ¯
kubectl describe serviceaccount my-app-sa

# ä»¥YAMLæ ¼å¼è¾“å‡º
kubectl get serviceaccount my-app-sa -o yaml
```

**ğŸ“‹ è¯¦ç»†ä¿¡æ¯è§£è¯»**
```yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: my-app-sa
  namespace: default
secrets:
- name: my-app-sa-token-abc123  # å…³è”çš„Token Secret
imagePullSecrets: []             # é•œåƒæ‹‰å–å‡­è¯
automountServiceAccountToken: true # æ˜¯å¦è‡ªåŠ¨æŒ‚è½½Token
```

> âš ï¸ **é‡è¦æ¦‚å¿µ**  
> `automountServiceAccountToken: true` è¡¨ç¤ºPodä¼šè‡ªåŠ¨æŒ‚è½½è¿™ä¸ªServiceAccountçš„Tokenï¼Œè¿™æ˜¯é»˜è®¤è¡Œä¸º

### 2.3 åˆ é™¤ServiceAccount


**ğŸ—‘ï¸ åˆ é™¤æ“ä½œ**
```bash
# åˆ é™¤ServiceAccount
kubectl delete serviceaccount my-app-sa

# åŒæ—¶åˆ é™¤å¤šä¸ª
kubectl delete sa sa1 sa2 sa3
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**  
> åˆ é™¤ServiceAccountæ—¶ï¼Œæ­£åœ¨ä½¿ç”¨å®ƒçš„Podéœ€è¦é‡å¯æ‰èƒ½ç”Ÿæ•ˆï¼

---

## 3. ğŸ”‘ Tokenä»¤ç‰Œç®¡ç†


### 3.1 ä»€ä¹ˆæ˜¯ServiceAccount Tokenï¼Ÿ


**ğŸ« Tokençš„æœ¬è´¨**
Tokenå°±åƒæ˜¯ä¸€å¼ "é€šè¡Œè¯"ï¼Œé‡Œé¢åŒ…å«äº†ï¼š
- **èº«ä»½ä¿¡æ¯**ï¼šæˆ‘æ˜¯è°ï¼Ÿ
- **æƒé™ä¿¡æ¯**ï¼šæˆ‘èƒ½åšä»€ä¹ˆï¼Ÿ
- **æœ‰æ•ˆæœŸ**ï¼šä»€ä¹ˆæ—¶å€™è¿‡æœŸï¼Ÿ

**ğŸ” Tokenå­˜å‚¨ä½ç½®**
Podå†…çš„Tokenè‡ªåŠ¨æŒ‚è½½åˆ°ï¼š
```
/var/run/secrets/kubernetes.io/serviceaccount/
â”œâ”€â”€ ca.crt     # é›†ç¾¤CAè¯ä¹¦
â”œâ”€â”€ namespace  # å½“å‰å‘½åç©ºé—´
â””â”€â”€ token      # JWTæ ¼å¼çš„è®¿é—®ä»¤ç‰Œ
```

### 3.2 æŸ¥çœ‹ServiceAccountçš„Secret


**ğŸ“‹ æŸ¥çœ‹å…³è”çš„Secret**
```bash
# æŸ¥çœ‹ServiceAccountå…³è”çš„Secret
kubectl get secrets -l kubernetes.io/service-account.name=my-app-sa

# æŸ¥çœ‹Secretè¯¦ç»†å†…å®¹
kubectl describe secret my-app-sa-token-abc123
```

**ğŸ” Secretå†…å®¹è§£è¯»**
```yaml
Data
====
ca.crt:     1066 bytes    # é›†ç¾¤è¯ä¹¦
namespace:  7 bytes       # å‘½åç©ºé—´å
token:      eyJhbGciOi... # JWT Tokenï¼ˆå¾ˆé•¿çš„å­—ç¬¦ä¸²ï¼‰
```

### 3.3 åˆ›å»ºä¸´æ—¶Token


**â° æ–°ç‰ˆKubernetesçš„Tokenç®¡ç†**
ä»Kubernetes 1.22å¼€å§‹ï¼Œæ¨èä½¿ç”¨ä¸´æ—¶Tokenï¼š

```bash
# åˆ›å»ºä¸´æ—¶Tokenï¼ˆé»˜è®¤1å°æ—¶ï¼‰
kubectl create token my-app-sa

# æŒ‡å®šTokenæœ‰æ•ˆæœŸ
kubectl create token my-app-sa --duration=24h
kubectl create token my-app-sa --duration=30m
```

**ğŸ¯ ä¸´æ—¶Tokençš„ä¼˜åŠ¿**
- **æ›´å®‰å…¨**ï¼šæœ‰è¿‡æœŸæ—¶é—´ï¼Œé™ä½æ³„éœ²é£é™©
- **æŒ‰éœ€åˆ›å»º**ï¼šéœ€è¦æ—¶æ‰åˆ›å»ºï¼Œç”¨å®Œå³å¤±æ•ˆ
- **æƒé™æœ€å°åŒ–**ï¼šé¿å…é•¿æœŸTokençš„å®‰å…¨éšæ‚£

> ğŸ’¡ **æœ€ä½³å®è·µ**  
> ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ä¸´æ—¶Tokenï¼Œé¿å…ä½¿ç”¨æ°¸ä¹…æ€§Secretä¸­çš„Token

---

## 4. ğŸ”’ æƒé™ç»‘å®šä¸å®‰å…¨æ§åˆ¶


### 4.1 ServiceAccountæƒé™ç»‘å®š


**ğŸ”— RBACæƒé™ç»‘å®š**
ServiceAccountæœ¬èº«æ²¡æœ‰æƒé™ï¼Œéœ€è¦é€šè¿‡RBACç»‘å®šæƒé™ï¼š

```bash
# ç»‘å®šé›†ç¾¤çº§åˆ«çš„è§’è‰²
kubectl create clusterrolebinding my-app-binding \
  --clusterrole=view \
  --serviceaccount=default:my-app-sa

# ç»‘å®šå‘½åç©ºé—´çº§åˆ«çš„è§’è‰²
kubectl create rolebinding my-app-binding \
  --role=pod-reader \
  --serviceaccount=default:my-app-sa
```

**ğŸ“Š æƒé™çº§åˆ«å¯¹æ¯”**

| ç»‘å®šç±»å‹ | **ä½œç”¨èŒƒå›´** | **é€‚ç”¨åœºæ™¯** | **å®‰å…¨çº§åˆ«** |
|---------|------------|------------|------------|
| ğŸŒ **ClusterRoleBinding** | `æ•´ä¸ªé›†ç¾¤` | `éœ€è¦è·¨å‘½åç©ºé—´è®¿é—®` | `è¾ƒä½` |
| ğŸ“ **RoleBinding** | `å•ä¸ªå‘½åç©ºé—´` | `åªåœ¨ç‰¹å®šå‘½åç©ºé—´å·¥ä½œ` | `è¾ƒé«˜` |

### 4.2 ä¸ºPodè®¾ç½®ServiceAccount


**ğŸ”§ åœ¨Deploymentä¸­ä½¿ç”¨ServiceAccount**
```bash
# ä¸ºç°æœ‰Deploymentè®¾ç½®ServiceAccount
kubectl set serviceaccount deployment my-app my-app-sa

# éªŒè¯è®¾ç½®ç»“æœ
kubectl get deployment my-app -o jsonpath='{.spec.template.spec.serviceAccount}'
```

**ğŸ“ YAMLé…ç½®ç¤ºä¾‹**
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-app
spec:
  template:
    spec:
      serviceAccount: my-app-sa        # æŒ‡å®šServiceAccount
      serviceAccountName: my-app-sa    # æ¨èä½¿ç”¨è¿™ä¸ªå­—æ®µ
      containers:
      - name: my-app
        image: nginx
```

> ğŸ’¡ **å­—æ®µè¯´æ˜**  
> `serviceAccount` å’Œ `serviceAccountName` ä½œç”¨ç›¸åŒï¼Œæ¨èä½¿ç”¨ `serviceAccountName`

### 4.3 é•œåƒæ‹‰å–Secretç®¡ç†


**ğŸ³ æ·»åŠ é•œåƒæ‹‰å–å‡­è¯**
```bash
# ä¸ºServiceAccountæ·»åŠ é•œåƒæ‹‰å–Secret
kubectl patch serviceaccount my-app-sa \
  -p '{"imagePullSecrets":[{"name":"my-registry-secret"}]}'

# æŸ¥çœ‹æ·»åŠ ç»“æœ
kubectl describe serviceaccount my-app-sa
```

**ğŸ“‹ æ·»åŠ åçš„æ•ˆæœ**
ä½¿ç”¨æ­¤ServiceAccountçš„Podå°†è‡ªåŠ¨ä½¿ç”¨æŒ‡å®šçš„é•œåƒæ‹‰å–å‡­è¯ï¼Œæ— éœ€åœ¨Podä¸­å•ç‹¬é…ç½®ã€‚

---

## 5. ğŸš€ å®é™…åº”ç”¨åœºæ™¯


### 5.1 åº”ç”¨ç¨‹åºè®¿é—®Kubernetes API


**ğŸ“± åœºæ™¯ï¼šç›‘æ§åº”ç”¨è®¿é—®é›†ç¾¤èµ„æº**
```bash
# 1. åˆ›å»ºç›‘æ§åº”ç”¨çš„ServiceAccount
kubectl create serviceaccount monitor-app-sa

# 2. åˆ›å»ºåªè¯»æƒé™çš„è§’è‰²
kubectl create clusterrole monitor-reader \
  --verb=get,list,watch \
  --resource=pods,nodes,services

# 3. ç»‘å®šæƒé™
kubectl create clusterrolebinding monitor-binding \
  --clusterrole=monitor-reader \
  --serviceaccount=default:monitor-app-sa
```

**ğŸ”§ åº”ç”¨ç¨‹åºä½¿ç”¨ç¤ºä¾‹**
```python
# Pythonä»£ç ç¤ºä¾‹ï¼ˆç®€åŒ–ç‰ˆï¼‰
from kubernetes import client, config

# ä½¿ç”¨Podå†…çš„ServiceAccount Token
config.load_incluster_config()
v1 = client.CoreV1Api()

# ç°åœ¨å¯ä»¥è®¿é—®APIäº†
pods = v1.list_pod_for_all_namespaces()
```

### 5.2 CI/CDæµæ°´çº¿éƒ¨ç½²æƒé™


**ğŸ—ï¸ åœºæ™¯ï¼šéƒ¨ç½²æµæ°´çº¿éœ€è¦éƒ¨ç½²æƒé™**
```bash
# 1. åˆ›å»ºéƒ¨ç½²ä¸“ç”¨ServiceAccount
kubectl create serviceaccount deploy-pipeline-sa -n kube-system

# 2. ç»‘å®šéƒ¨ç½²æƒé™ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
kubectl create clusterrolebinding deploy-pipeline-binding \
  --clusterrole=cluster-admin \
  --serviceaccount=kube-system:deploy-pipeline-sa

# 3. è·å–Tokenç”¨äºCI/CD
kubectl create token deploy-pipeline-sa -n kube-system --duration=24h
```

> âš ï¸ **å®‰å…¨è­¦å‘Š**  
> ç”Ÿäº§ç¯å¢ƒä¸­é¿å…ä½¿ç”¨`cluster-admin`æƒé™ï¼Œåº”è¯¥åˆ›å»ºæœ€å°æƒé™çš„è‡ªå®šä¹‰è§’è‰²

### 5.3 å¤šç§Ÿæˆ·ç¯å¢ƒéš”ç¦»


**ğŸ¢ åœºæ™¯ï¼šä¸åŒå›¢é˜Ÿä½¿ç”¨ä¸åŒServiceAccount**
```bash
# ä¸ºä¸åŒå›¢é˜Ÿåˆ›å»ºServiceAccount
kubectl create serviceaccount team-frontend-sa -n frontend
kubectl create serviceaccount team-backend-sa -n backend

# æ¯ä¸ªå›¢é˜Ÿåªèƒ½è®¿é—®è‡ªå·±çš„å‘½åç©ºé—´
kubectl create rolebinding frontend-team-binding \
  --role=edit \
  --serviceaccount=frontend:team-frontend-sa \
  -n frontend
```

---

## 6. ğŸ”§ æ•…éšœæ’æŸ¥ä¸æœ€ä½³å®è·µ


### 6.1 å¸¸è§é—®é¢˜è¯Šæ–­


**âŒ é—®é¢˜1ï¼šPodæ— æ³•è®¿é—®API Server**
```bash
# æ£€æŸ¥Podçš„ServiceAccount
kubectl get pod my-pod -o jsonpath='{.spec.serviceAccount}'

# æ£€æŸ¥ServiceAccountæ˜¯å¦å­˜åœ¨
kubectl get serviceaccount my-app-sa

# æ£€æŸ¥Tokenæ˜¯å¦æ­£ç¡®æŒ‚è½½
kubectl exec my-pod -- ls -la /var/run/secrets/kubernetes.io/serviceaccount/
```

**âŒ é—®é¢˜2ï¼šæƒé™ä¸è¶³é”™è¯¯**
```bash
# æ£€æŸ¥ServiceAccountçš„æƒé™ç»‘å®š
kubectl get clusterrolebindings -o json | \
  jq '.items[] | select(.subjects[]?.name=="my-app-sa")'

# æŸ¥çœ‹è§’è‰²çš„å…·ä½“æƒé™
kubectl describe clusterrole view
```

**âŒ é—®é¢˜3ï¼šTokenè¿‡æœŸ**
```bash
# åˆ›å»ºæ–°çš„ä¸´æ—¶Token
kubectl create token my-app-sa --duration=1h

# æ£€æŸ¥Tokenæ˜¯å¦æœ‰æ•ˆï¼ˆéœ€è¦å·¥å…·è§£æJWTï¼‰
```

### 6.2 å®‰å…¨æœ€ä½³å®è·µ


**ğŸ›¡ï¸ å®‰å…¨å»ºè®®æ¸…å•**

> âœ… **æƒé™æœ€å°åŒ–åŸåˆ™**  
> åªç»™ServiceAccountå¿…éœ€çš„æœ€å°æƒé™ï¼Œé¿å…ä½¿ç”¨cluster-admin

> âœ… **ä½¿ç”¨ä¸´æ—¶Token**  
> ä¼˜å…ˆä½¿ç”¨`kubectl create token`åˆ›å»ºçš„ä¸´æ—¶Token

> âœ… **å‘½åç©ºé—´éš”ç¦»**  
> ä¸åŒåº”ç”¨ä½¿ç”¨ä¸åŒçš„ServiceAccountå’Œå‘½åç©ºé—´

> âœ… **å®šæœŸè½®æ¢å‡­è¯**  
> å®šæœŸæ›´æ–°å’Œè½®æ¢é•¿æœŸä½¿ç”¨çš„Token

> âœ… **å®¡è®¡æ—¥å¿—ç›‘æ§**  
> ç›‘æ§ServiceAccountçš„APIè®¿é—®è¡Œä¸º

**ğŸ”’ å®‰å…¨é…ç½®ç¤ºä¾‹**
```yaml
# ç¦ç”¨è‡ªåŠ¨æŒ‚è½½Tokenï¼ˆå¦‚æœä¸éœ€è¦ï¼‰
apiVersion: v1
kind: ServiceAccount
metadata:
  name: no-token-sa
automountServiceAccountToken: false
```

### 6.3 ç›‘æ§å’Œç»´æŠ¤


**ğŸ“Š ServiceAccountä½¿ç”¨æƒ…å†µç›‘æ§**
```bash
# æŸ¥çœ‹æ‰€æœ‰ServiceAccountçš„ä½¿ç”¨æƒ…å†µ
kubectl get sa --all-namespaces

# æŸ¥æ‰¾æœªä½¿ç”¨çš„ServiceAccount
kubectl get sa -o json | \
  jq '.items[] | select(.metadata.name != "default") | .metadata.name'
```

**ğŸ§¹ æ¸…ç†unused ServiceAccount**
```bash
# åˆ é™¤ä¸å†ä½¿ç”¨çš„ServiceAccount
kubectl delete serviceaccount unused-sa

# æ‰¹é‡æ¸…ç†ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
kubectl get sa --all-namespaces --no-headers | \
  grep -v default | \
  awk '{print "kubectl delete sa " $2 " -n " $1}' | \
  # æ£€æŸ¥åå†æ‰§è¡Œ
  sh
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ServiceAccountæœ¬è´¨ï¼šPodçš„èº«ä»½è¯ï¼Œç”¨äºAPIè®¤è¯æˆæƒ
ğŸ”¸ Tokenæœºåˆ¶ï¼šJWTä»¤ç‰Œï¼Œè‡ªåŠ¨æŒ‚è½½åˆ°Podçš„å›ºå®šè·¯å¾„
ğŸ”¸ RBACç»‘å®šï¼šServiceAccountéœ€è¦ç»‘å®šè§’è‰²æ‰æœ‰æƒé™
ğŸ”¸ å‘½åç©ºé—´çº§åˆ«ï¼šServiceAccountå±äºç‰¹å®šå‘½åç©ºé—´
ğŸ”¸ å®‰å…¨åŸåˆ™ï¼šæœ€å°æƒé™ã€ä¸´æ—¶Tokenã€å®šæœŸè½®æ¢
```

### 7.2 å…³é”®å‘½ä»¤é€ŸæŸ¥


**ğŸ”§ åˆ›å»ºå’Œç®¡ç†**
```bash
kubectl create serviceaccount <name>              # åˆ›å»ºSA
kubectl get serviceaccounts                       # åˆ—å‡ºSA
kubectl describe serviceaccount <name>            # æŸ¥çœ‹è¯¦æƒ…
kubectl delete serviceaccount <name>              # åˆ é™¤SA
```

**ğŸ”‘ Tokenç®¡ç†**
```bash
kubectl create token <sa-name>                    # åˆ›å»ºä¸´æ—¶Token
kubectl create token <sa-name> --duration=24h     # æŒ‡å®šæ—¶é•¿
kubectl get secrets -l kubernetes.io/service-account.name=<sa-name>  # æŸ¥çœ‹Secret
```

**ğŸ”— æƒé™ç»‘å®š**
```bash
kubectl set serviceaccount deployment <deploy-name> <sa-name>  # è®¾ç½®SA
kubectl create rolebinding <name> --role=<role> --serviceaccount=<ns:sa-name>  # è§’è‰²ç»‘å®š
```

### 7.3 å®é™…åº”ç”¨æŒ‡å—


**ğŸ¯ æ–°æ‰‹å­¦ä¹ è·¯å¾„**
1. **ç†è§£æ¦‚å¿µ**ï¼šä»€ä¹ˆæ˜¯ServiceAccountï¼Œä¸ºä»€ä¹ˆéœ€è¦å®ƒ
2. **åŸºç¡€æ“ä½œ**ï¼šåˆ›å»ºã€æŸ¥çœ‹ã€åˆ é™¤ServiceAccount
3. **æƒé™ç»‘å®š**ï¼šå­¦ä¹ RBACï¼Œä¸ºServiceAccountåˆ†é…æƒé™
4. **å®é™…åº”ç”¨**ï¼šåœ¨Podä¸­ä½¿ç”¨ServiceAccountè®¿é—®API
5. **å®‰å…¨å®è·µ**ï¼šæŒæ¡å®‰å…¨é…ç½®å’Œæœ€ä½³å®è·µ

**ğŸ“š è¿›é˜¶å­¦ä¹ å»ºè®®**
- æ·±å…¥å­¦ä¹ RBACæƒé™æ¨¡å‹
- äº†è§£Pod Security Policyå’ŒServiceAccountçš„å…³ç³»  
- å­¦ä¹ åœ¨ä¸åŒåœºæ™¯ä¸‹çš„ServiceAccountè®¾è®¡æ¨¡å¼
- æŒæ¡ServiceAccountçš„ç›‘æ§å’Œå®¡è®¡æ–¹æ³•

**ğŸ” å¸¸è§åº”ç”¨åœºæ™¯**
- **ç›‘æ§ç³»ç»Ÿ**ï¼šéœ€è¦è¯»å–é›†ç¾¤çŠ¶æ€ä¿¡æ¯
- **CI/CDå·¥å…·**ï¼šéœ€è¦éƒ¨ç½²å’Œæ›´æ–°åº”ç”¨
- **æ—¥å¿—æ”¶é›†**ï¼šéœ€è¦è®¿é—®Podæ—¥å¿—å’Œäº‹ä»¶
- **è‡ªåŠ¨åŒ–è„šæœ¬**ï¼šéœ€è¦å®šæœŸæ‰§è¡Œé›†ç¾¤æ“ä½œ

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- ServiceAccountæ˜¯Podèº«ä»½è¯
- TokenæŒ‚è½½è®¿é—®APIæœ‰æƒé™  
- RBACç»‘å®šè§’è‰²æ‰ç”Ÿæ•ˆ
- å®‰å…¨ç¬¬ä¸€æœ€å°æƒé™åˆ¶