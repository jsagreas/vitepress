---
title: 15ã€é…ç½®æ–‡ä»¶æŒ‚è½½ä¸ç¯å¢ƒå˜é‡
---
## ğŸ“š ç›®å½•

1. [é…ç½®ç®¡ç†æ ¸å¿ƒæ¦‚å¿µ](#1-é…ç½®ç®¡ç†æ ¸å¿ƒæ¦‚å¿µ)
2. [ç¯å¢ƒå˜é‡é…ç½®å®æˆ˜](#2-ç¯å¢ƒå˜é‡é…ç½®å®æˆ˜)
3. [æ–‡ä»¶æŒ‚è½½é…ç½®è¯¦è§£](#3-æ–‡ä»¶æŒ‚è½½é…ç½®è¯¦è§£)
4. [é…ç½®æ›´æ–°ä¸çƒ­é‡è½½](#4-é…ç½®æ›´æ–°ä¸çƒ­é‡è½½)
5. [å®ç”¨å‘½ä»¤å¤§å…¨](#5-å®ç”¨å‘½ä»¤å¤§å…¨)
6. [æœ€ä½³å®è·µä¸è¸©å‘æŒ‡å—](#6-æœ€ä½³å®è·µä¸è¸©å‘æŒ‡å—)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ é…ç½®ç®¡ç†æ ¸å¿ƒæ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯é…ç½®ç®¡ç†


**é€šä¿—ç†è§£**ï¼šå°±åƒç»™åº”ç”¨ç¨‹åºå‡†å¤‡"é…èœ"

```
ä¼ ç»Ÿåº”ç”¨ï¼šé…ç½®å†™æ­»åœ¨ä»£ç é‡Œ
    åº”ç”¨ä»£ç  + ç¡¬ç¼–ç é…ç½® = éš¾ç»´æŠ¤

K8sé…ç½®ç®¡ç†ï¼šé…ç½®å’Œä»£ç åˆ†ç¦»
    åº”ç”¨ä»£ç  + å¤–éƒ¨é…ç½® = çµæ´»å¯æ§
```

**æ ¸å¿ƒä»·å€¼**ï¼š
- ğŸ”§ **é…ç½®åˆ†ç¦»**ï¼šä»£ç ä¸å˜ï¼Œé…ç½®å¯è°ƒ
- ğŸš€ **ç¯å¢ƒé€‚é…**ï¼šå¼€å‘/æµ‹è¯•/ç”Ÿäº§ç”¨ä¸åŒé…ç½®
- ğŸ”’ **å®‰å…¨ç®¡ç†**ï¼šæ•æ„Ÿä¿¡æ¯ç‹¬ç«‹å­˜å‚¨
- ğŸ“ **ç‰ˆæœ¬ç®¡ç†**ï¼šé…ç½®å˜æ›´å¯è¿½è¸ª

### 1.2 ConfigMap vs Secret å¯¹æ¯”


| ç‰¹æ€§ | **ConfigMap** | **Secret** |
|------|-------------|-----------|
| ğŸ¯ **ç”¨é€”** | `æ™®é€šé…ç½®ä¿¡æ¯` | `æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç ã€å¯†é’¥ï¼‰` |
| ğŸ“¦ **å­˜å‚¨æ–¹å¼** | `æ˜æ–‡å­˜å‚¨` | `Base64ç¼–ç å­˜å‚¨` |
| ğŸ” **æŸ¥çœ‹æ–¹å¼** | `ç›´æ¥å¯è§` | `éœ€è§£ç æŸ¥çœ‹` |
| ğŸ›¡ï¸ **å®‰å…¨çº§åˆ«** | `ä¸€èˆ¬` | `è¾ƒé«˜ï¼ˆetcdåŠ å¯†ï¼‰` |
| ğŸ“Š **ä½¿ç”¨åœºæ™¯** | `é…ç½®æ–‡ä»¶ã€ç¯å¢ƒå˜é‡` | `æ•°æ®åº“å¯†ç ã€APIå¯†é’¥` |

**ç®€å•è®°å¿†**ï¼š
- ConfigMap = æ™®é€šèœè°±ï¼ˆäººäººå¯çœ‹ï¼‰
- Secret = ç§˜åˆ¶è°ƒæ–™ï¼ˆéœ€è¦ä¿å¯†ï¼‰

### 1.3 é…ç½®ä½¿ç”¨æ–¹å¼å¯¹æ¯”


```
é…ç½®æ³¨å…¥æ–¹å¼ï¼š

æ–¹å¼1ï¼šç¯å¢ƒå˜é‡
Podå®¹å™¨å¯åŠ¨æ—¶ â†’ è¯»å–ConfigMap/Secret â†’ è®¾ç½®ç¯å¢ƒå˜é‡

æ–¹å¼2ï¼šæ–‡ä»¶æŒ‚è½½
Podå¯åŠ¨æ—¶ â†’ å°†ConfigMap/SecretæŒ‚è½½ä¸ºæ–‡ä»¶ â†’ åº”ç”¨è¯»å–æ–‡ä»¶

æ–¹å¼3ï¼šå‘½ä»¤è¡Œå‚æ•°
å¯åŠ¨å‘½ä»¤ â†’ å¼•ç”¨ç¯å¢ƒå˜é‡ â†’ ä¼ é€’ç»™åº”ç”¨
```

---

## 2. ğŸš€ ç¯å¢ƒå˜é‡é…ç½®å®æˆ˜


### 2.1 ä»ConfigMapè®¾ç½®ç¯å¢ƒå˜é‡


**æ ¸å¿ƒæ¦‚å¿µ**ï¼šæŠŠé…ç½®ä¿¡æ¯"æ³¨å…¥"åˆ°å®¹å™¨çš„ç¯å¢ƒå˜é‡ä¸­

```bash
# 1. å…ˆåˆ›å»ºä¸€ä¸ªConfigMapï¼ˆç›¸å½“äºå‡†å¤‡é…ç½®æ¸…å•ï¼‰
kubectl create configmap app-config \
  --from-literal=DATABASE_URL=mysql://localhost:3306/myapp \
  --from-literal=LOG_LEVEL=info \
  --from-literal=MAX_CONNECTIONS=100

# 2. å°†ConfigMapé…ç½®æ³¨å…¥åˆ°Deploymentçš„ç¯å¢ƒå˜é‡
kubectl set env deployment/my-app --from=configmap/app-config
```

**å®é™…æ•ˆæœ**ï¼š
```
å®¹å™¨å†…éƒ¨ç¯å¢ƒå˜é‡ï¼š
DATABASE_URL=mysql://localhost:3306/myapp
LOG_LEVEL=info
MAX_CONNECTIONS=100
```

### 2.2 ä»Secretè®¾ç½®ç¯å¢ƒå˜é‡


**ä½¿ç”¨åœºæ™¯**ï¼šæ•°æ®åº“å¯†ç ã€APIå¯†é’¥ç­‰æ•æ„Ÿä¿¡æ¯

```bash
# 1. åˆ›å»ºSecretï¼ˆæ•æ„Ÿä¿¡æ¯ï¼‰
kubectl create secret generic app-secrets \
  --from-literal=DB_PASSWORD=mySecretPassword123 \
  --from-literal=API_KEY=sk-1234567890abcdef

# 2. å°†Secretæ³¨å…¥åˆ°ç¯å¢ƒå˜é‡
kubectl set env deployment/my-app --from=secret/app-secrets
```

**å®‰å…¨æç¤º**ï¼šSecretä¼šè‡ªåŠ¨è¿›è¡ŒBase64ç¼–ç ï¼Œä½†å®¹å™¨å†…ä½¿ç”¨æ—¶ä¼šè‡ªåŠ¨è§£ç 

### 2.3 æ··åˆä½¿ç”¨ConfigMapå’ŒSecret


**å®é™…é¡¹ç›®åœºæ™¯**ï¼šåº”ç”¨æ—¢éœ€è¦æ™®é€šé…ç½®ï¼Œä¹Ÿéœ€è¦æ•æ„Ÿé…ç½®

```bash
# ç»„åˆä½¿ç”¨ï¼šå…ˆè®¾ç½®ConfigMapï¼Œå†è®¾ç½®Secret
kubectl set env deployment/my-app --from=configmap/app-config
kubectl set env deployment/my-app --from=secret/app-secrets

# éªŒè¯ç¯å¢ƒå˜é‡è®¾ç½®
kubectl exec -it deployment/my-app -- env | grep -E "(DATABASE_URL|DB_PASSWORD|LOG_LEVEL)"
```

### 2.4 ç¯å¢ƒå˜é‡éªŒè¯ä¸è°ƒè¯•


**è°ƒè¯•æŠ€å·§**ï¼šå¦‚ä½•ç¡®è®¤ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®è®¾ç½®

```bash
# æŸ¥çœ‹Podä¸­çš„æ‰€æœ‰ç¯å¢ƒå˜é‡
kubectl exec -it [pod-name] -- env

# æŸ¥æ‰¾ç‰¹å®šç¯å¢ƒå˜é‡
kubectl exec -it [pod-name] -- env | grep DATABASE

# æŸ¥çœ‹Podçš„ç¯å¢ƒå˜é‡é…ç½®ï¼ˆYAMLæ ¼å¼ï¼‰
kubectl get pods -o jsonpath='{.items[*].spec.containers[*].env}' | jq

# æŸ¥çœ‹Deploymentçš„ç¯å¢ƒå˜é‡é…ç½®
kubectl describe deployment my-app | grep -A 10 "Environment"
```

**å¸¸è§é—®é¢˜æ’æŸ¥**ï¼š
```
âŒ ç¯å¢ƒå˜é‡æ²¡ç”Ÿæ•ˆï¼Ÿ
â†’ æ£€æŸ¥ConfigMap/Secretæ˜¯å¦å­˜åœ¨
â†’ æ£€æŸ¥Podæ˜¯å¦é‡å¯ç”Ÿæ•ˆ

âŒ ç¯å¢ƒå˜é‡å€¼ä¸å¯¹ï¼Ÿ  
â†’ æ£€æŸ¥ConfigMap/Secretå†…å®¹
â†’ æ£€æŸ¥æ˜¯å¦æœ‰åŒåå˜é‡è¦†ç›–
```

---

## 3. ğŸ“ æ–‡ä»¶æŒ‚è½½é…ç½®è¯¦è§£


### 3.1 ConfigMapæ–‡ä»¶æŒ‚è½½åŸºç¡€


**æ ¸å¿ƒæ¦‚å¿µ**ï¼šæŠŠConfigMapå½“ä½œ"é…ç½®æ–‡ä»¶"æŒ‚è½½åˆ°å®¹å™¨å†…éƒ¨

**åˆ›å»ºåŒ…å«æ–‡ä»¶å†…å®¹çš„ConfigMap**ï¼š
```bash
# æ–¹æ³•1ï¼šä»ç°æœ‰æ–‡ä»¶åˆ›å»º
echo "server_name: my-app
port: 8080
database:
  host: localhost
  port: 3306" > app.yaml

kubectl create configmap app-config-file --from-file=app.yaml

# æ–¹æ³•2ï¼šç›´æ¥åˆ›å»ºå¤šä¸ªæ–‡ä»¶
kubectl create configmap nginx-config \
  --from-literal=nginx.conf="server { listen 80; }" \
  --from-literal=index.html="<h1>Hello K8s</h1>"
```

### 3.2 æŒ‚è½½ConfigMapä¸ºæ–‡ä»¶


**æ·»åŠ ConfigMapå·åˆ°Deployment**ï¼š
```bash
# å°†ConfigMapæŒ‚è½½åˆ°/configç›®å½•
kubectl set volume deployment/my-app \
  --add \
  --type=configmap \
  --mount-path=/config \
  --configmap-name=app-config-file
```

**æŒ‚è½½åçš„æ–‡ä»¶ç»“æ„**ï¼š
```
Podå†…éƒ¨æ–‡ä»¶ç³»ç»Ÿï¼š
/config/
  â””â”€â”€ app.yaml  (ConfigMapä¸­çš„å†…å®¹)
  
åº”ç”¨å¯ä»¥è¯»å–ï¼š/config/app.yaml
```

### 3.3 Secretæ–‡ä»¶æŒ‚è½½


**ä½¿ç”¨åœºæ™¯**ï¼šSSLè¯ä¹¦ã€ç§é’¥æ–‡ä»¶ç­‰

```bash
# åˆ›å»ºåŒ…å«è¯ä¹¦æ–‡ä»¶çš„Secret
kubectl create secret tls my-tls-secret \
  --cert=tls.crt \
  --key=tls.key

# æŒ‚è½½Secretåˆ°/secretsç›®å½•
kubectl set volume deployment/my-app \
  --add \
  --type=secret \
  --mount-path=/secrets \
  --secret-name=my-tls-secret
```

**æŒ‚è½½æ•ˆæœ**ï¼š
```
/secrets/
  â”œâ”€â”€ tls.crt  (è¯ä¹¦æ–‡ä»¶)
  â””â”€â”€ tls.key  (ç§é’¥æ–‡ä»¶)
```

### 3.4 æ–‡ä»¶æŒ‚è½½éªŒè¯


**æ£€æŸ¥æŒ‚è½½æ˜¯å¦æˆåŠŸ**ï¼š
```bash
# æŸ¥çœ‹æŒ‚è½½ç‚¹ä¿¡æ¯
kubectl describe pod [pod-name] | grep -A 10 "Mounts"

# è¿›å…¥å®¹å™¨æŸ¥çœ‹æŒ‚è½½çš„æ–‡ä»¶
kubectl exec -it [pod-name] -- ls -la /config

# æŸ¥çœ‹é…ç½®æ–‡ä»¶å†…å®¹
kubectl exec -it [pod-name] -- cat /config/app.yaml

# æŸ¥çœ‹Secretæ–‡ä»¶å†…å®¹
kubectl exec -it [pod-name] -- cat /secrets/tls.crt
```

### 3.5 é«˜çº§æŒ‚è½½é€‰é¡¹


**æŒ‚è½½ç‰¹å®šæ–‡ä»¶**ï¼ˆä¸æŒ‚è½½æ•´ä¸ªConfigMapï¼‰ï¼š
```bash
# åªæŒ‚è½½ConfigMapä¸­çš„ç‰¹å®šæ–‡ä»¶
kubectl patch deployment my-app -p '{
  "spec": {
    "template": {
      "spec": {
        "containers": [{
          "name": "my-app",
          "volumeMounts": [{
            "name": "config-volume",
            "mountPath": "/app/config.yaml",
            "subPath": "app.yaml"
          }]
        }],
        "volumes": [{
          "name": "config-volume",
          "configMap": {"name": "app-config-file"}
        }]
      }
    }
  }
}'
```

**è®¾ç½®æ–‡ä»¶æƒé™**ï¼š
```bash
# è®¾ç½®æŒ‚è½½æ–‡ä»¶çš„æƒé™ä¸º0600
kubectl patch deployment my-app -p '{
  "spec": {
    "template": {
      "spec": {
        "volumes": [{
          "name": "secret-volume",
          "secret": {
            "secretName": "my-tls-secret",
            "defaultMode": 384
          }
        }]
      }
    }
  }
}'
```

---

## 4. ğŸ”„ é…ç½®æ›´æ–°ä¸çƒ­é‡è½½


### 4.1 ConfigMapæ›´æ–°æœºåˆ¶


**æ ¸å¿ƒç†è§£**ï¼šé…ç½®æ›´æ–°ä¸ä¼šè‡ªåŠ¨é‡å¯Pod

```bash
# æ›´æ–°ConfigMapå†…å®¹
kubectl patch configmap app-config -p '{"data":{"LOG_LEVEL":"debug"}}'

# æ‰‹åŠ¨è§¦å‘Podé‡å¯ä»¥åº”ç”¨æ–°é…ç½®
kubectl rollout restart deployment/my-app

# æŸ¥çœ‹æ›´æ–°çŠ¶æ€
kubectl rollout status deployment/my-app
```

### 4.2 ç¯å¢ƒå˜é‡ vs æ–‡ä»¶æŒ‚è½½çš„æ›´æ–°åŒºåˆ«


| é…ç½®æ–¹å¼ | **æ›´æ–°è¡Œä¸º** | **æ˜¯å¦éœ€è¦é‡å¯** |
|---------|------------|---------------|
| ğŸ”§ **ç¯å¢ƒå˜é‡** | `Podå¯åŠ¨æ—¶å›ºå®š` | `å¿…é¡»é‡å¯Pod` |
| ğŸ“ **æ–‡ä»¶æŒ‚è½½** | `æ–‡ä»¶å†…å®¹ä¼šè‡ªåŠ¨æ›´æ–°` | `åº”ç”¨éœ€è¦é‡æ–°è¯»å–æ–‡ä»¶` |

**æ–‡ä»¶æŒ‚è½½è‡ªåŠ¨æ›´æ–°ç¤ºä¾‹**ï¼š
```bash
# æ›´æ–°ConfigMap
kubectl patch configmap app-config-file -p '{
  "data": {
    "app.yaml": "server_name: my-app-v2\nport: 9090"
  }
}'

# æ–‡ä»¶ä¼šåœ¨çº¦60ç§’å†…è‡ªåŠ¨æ›´æ–°
kubectl exec -it [pod-name] -- cat /config/app.yaml

# ä½†åº”ç”¨éœ€è¦é‡æ–°è¯»å–æ–‡ä»¶æ‰èƒ½ç”Ÿæ•ˆ
```

### 4.3 é…ç½®çƒ­é‡è½½æœ€ä½³å®è·µ


**åº”ç”¨å±‚é¢çš„çƒ­é‡è½½**ï¼š
```bash
# å‘é€ä¿¡å·è®©åº”ç”¨é‡æ–°åŠ è½½é…ç½®ï¼ˆéœ€è¦åº”ç”¨æ”¯æŒï¼‰
kubectl exec -it [pod-name] -- kill -HUP 1

# ä½¿ç”¨é…ç½®ç®¡ç†å·¥å…·ï¼ˆå¦‚Helmï¼‰è¿›è¡Œç‰ˆæœ¬åŒ–æ›´æ–°
helm upgrade my-app ./my-chart --set config.logLevel=debug
```

---

## 5. ğŸ› ï¸ å®ç”¨å‘½ä»¤å¤§å…¨


### 5.1 ç”ŸæˆDeploymentæ¨¡æ¿


**å¿«é€Ÿç”Ÿæˆå¸¦é…ç½®çš„Deployment**ï¼š
```bash
# ç”ŸæˆåŸºç¡€Deployment YAML
kubectl create deployment my-app --image=nginx:1.20 --dry-run=client -o yaml > my-app.yaml

# ç”Ÿæˆå¸¦ConfigMapç¯å¢ƒå˜é‡çš„Deployment
kubectl create deployment my-app --image=nginx:1.20 --dry-run=client -o yaml | \
kubectl set env --from=configmap/app-config --local -f - -o yaml
```

### 5.2 æ‰¹é‡æ“ä½œå‘½ä»¤


**æ‰¹é‡è®¾ç½®ç¯å¢ƒå˜é‡**ï¼š
```bash
# ä¸ºå¤šä¸ªDeploymentè®¾ç½®ç›¸åŒçš„ConfigMap
for deploy in app1 app2 app3; do
  kubectl set env deployment/$deploy --from=configmap/shared-config
done

# æ‰¹é‡æŸ¥çœ‹ç¯å¢ƒå˜é‡é…ç½®
kubectl get deployments -o custom-columns=NAME:.metadata.name,ENV:.spec.template.spec.containers[0].env
```

### 5.3 é…ç½®å¤‡ä»½ä¸æ¢å¤


**å¤‡ä»½é…ç½®**ï¼š
```bash
# å¤‡ä»½ConfigMap
kubectl get configmap app-config -o yaml > app-config-backup.yaml

# å¤‡ä»½Secret
kubectl get secret app-secrets -o yaml > app-secrets-backup.yaml
```

**æ¢å¤é…ç½®**ï¼š
```bash
# ä»å¤‡ä»½æ¢å¤
kubectl apply -f app-config-backup.yaml
kubectl apply -f app-secrets-backup.yaml
```

### 5.4 ä¸€é”®å¼é…ç½®éƒ¨ç½²


**å®Œæ•´çš„åº”ç”¨é…ç½®éƒ¨ç½²è„šæœ¬**ï¼š
```bash
#!/bin/bash
# deploy-with-config.sh

# 1. åˆ›å»ºConfigMap
kubectl create configmap app-config \
  --from-literal=DATABASE_URL=$DB_URL \
  --from-literal=LOG_LEVEL=$LOG_LEVEL \
  --dry-run=client -o yaml | kubectl apply -f -

# 2. åˆ›å»ºSecret  
kubectl create secret generic app-secrets \
  --from-literal=DB_PASSWORD=$DB_PASSWORD \
  --dry-run=client -o yaml | kubectl apply -f -

# 3. éƒ¨ç½²åº”ç”¨
kubectl create deployment my-app --image=$APP_IMAGE

# 4. æ³¨å…¥é…ç½®
kubectl set env deployment/my-app --from=configmap/app-config
kubectl set env deployment/my-app --from=secret/app-secrets

# 5. éªŒè¯éƒ¨ç½²
kubectl rollout status deployment/my-app
```

---

## 6. â­ æœ€ä½³å®è·µä¸è¸©å‘æŒ‡å—


### 6.1 å‘½åè§„èŒƒæœ€ä½³å®è·µ


```
ConfigMapå‘½åè§„èŒƒï¼š
âœ… [app-name]-config        # åº”ç”¨é…ç½®
âœ… [app-name]-[env]-config  # ç¯å¢ƒç‰¹å®šé…ç½®
âœ… shared-config           # å…±äº«é…ç½®

Secretå‘½åè§„èŒƒï¼š
âœ… [app-name]-secrets      # åº”ç”¨å¯†é’¥
âœ… [app-name]-tls          # TLSè¯ä¹¦
âœ… registry-credentials    # é•œåƒä»“åº“è®¤è¯
```

### 6.2 å¸¸è§è¸©å‘ä¸è§£å†³æ–¹æ¡ˆ


**è¸©å‘1**ï¼šç¯å¢ƒå˜é‡æ²¡ç”Ÿæ•ˆ
```bash
# âŒ å¸¸è§é”™è¯¯ï¼šæ›´æ–°ConfigMapåæ²¡é‡å¯Pod
kubectl patch configmap app-config -p '{"data":{"NEW_VAR":"value"}}'
# Podä¸­çœ‹ä¸åˆ°NEW_VAR

# âœ… æ­£ç¡®åšæ³•ï¼šæ›´æ–°åé‡å¯Deployment
kubectl rollout restart deployment/my-app
```

**è¸©å‘2**ï¼šSecretå†…å®¹çœ‹ä¸åˆ°
```bash
# âŒ é”™è¯¯ï¼šç›´æ¥æŸ¥çœ‹Secretå†…å®¹æ˜¯Base64ç¼–ç çš„
kubectl get secret app-secrets -o yaml
# çœ‹åˆ°çš„æ˜¯ç¼–ç åçš„å†…å®¹

# âœ… æ­£ç¡®ï¼šè§£ç æŸ¥çœ‹æˆ–è¿›å®¹å™¨æŸ¥çœ‹
kubectl get secret app-secrets -o jsonpath='{.data.DB_PASSWORD}' | base64 -d
```

**è¸©å‘3**ï¼šæ–‡ä»¶æŒ‚è½½è¦†ç›–äº†åŸç›®å½•
```bash
# âŒ é—®é¢˜ï¼šæŒ‚è½½åˆ°/etcä¼šè¦†ç›–å®¹å™¨åŸæœ‰æ–‡ä»¶
kubectl set volume deployment/my-app --add --type=configmap \
  --mount-path=/etc --configmap-name=app-config

# âœ… è§£å†³ï¼šä½¿ç”¨subPathæˆ–ä¸“é—¨çš„é…ç½®ç›®å½•
kubectl set volume deployment/my-app --add --type=configmap \
  --mount-path=/app/config --configmap-name=app-config
```

### 6.3 å®‰å…¨æœ€ä½³å®è·µ


**Secretå®‰å…¨ä½¿ç”¨**ï¼š
```bash
# âœ… ä½¿ç”¨RBACé™åˆ¶Secretè®¿é—®
kubectl create role secret-reader --verb=get --resource=secrets
kubectl create rolebinding secret-reader-binding \
  --role=secret-reader --user=my-service-account

# âœ… å®šæœŸè½®æ¢æ•æ„Ÿä¿¡æ¯
kubectl create secret generic app-secrets-v2 \
  --from-literal=DB_PASSWORD=$NEW_PASSWORD
kubectl set env deployment/my-app --from=secret/app-secrets-v2
```

### 6.4 æ€§èƒ½ä¼˜åŒ–å»ºè®®


**å‡å°‘é…ç½®æ›´æ–°é¢‘ç‡**ï¼š
```bash
# âœ… æ‰¹é‡æ›´æ–°è€Œä¸æ˜¯å•ä¸ªæ›´æ–°
kubectl patch configmap app-config -p '{
  "data": {
    "LOG_LEVEL": "debug",
    "MAX_CONNECTIONS": "200",
    "TIMEOUT": "30s"
  }
}'

# âœ… ä½¿ç”¨é…ç½®ç‰ˆæœ¬åŒ–ç®¡ç†
kubectl label configmap app-config version=v1.2.0
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ¯ é…ç½®ç®¡ç†æœ¬è´¨ï¼š
- ConfigMap = æ™®é€šé…ç½®ï¼ˆæ˜æ–‡å­˜å‚¨ï¼‰
- Secret = æ•æ„Ÿé…ç½®ï¼ˆç¼–ç å­˜å‚¨ï¼‰
- ç¯å¢ƒå˜é‡ = å¯åŠ¨æ—¶æ³¨å…¥ï¼Œéœ€é‡å¯æ›´æ–°
- æ–‡ä»¶æŒ‚è½½ = è¿è¡Œæ—¶æ›´æ–°ï¼Œåº”ç”¨éœ€é‡è¯»

ğŸ”§ ä¸¤ç§æ³¨å…¥æ–¹å¼ï¼š
- kubectl set envï¼šè®¾ç½®ç¯å¢ƒå˜é‡
- kubectl set volumeï¼šæŒ‚è½½ä¸ºæ–‡ä»¶

ğŸ“Š æ›´æ–°æœºåˆ¶ï¼š
- ç¯å¢ƒå˜é‡ï¼šå¿…é¡»é‡å¯Pod
- æŒ‚è½½æ–‡ä»¶ï¼šè‡ªåŠ¨æ›´æ–°ï¼ˆ60ç§’å†…ï¼‰
```

### 7.2 å…³é”®å‘½ä»¤é€Ÿè®°


| æ“ä½œç±»å‹ | **å¿«é€Ÿå‘½ä»¤** |
|---------|------------|
| ğŸ”§ **ç¯å¢ƒå˜é‡æ³¨å…¥** | `kubectl set env deployment/app --from=configmap/config` |
| ğŸ“ **æ–‡ä»¶æŒ‚è½½** | `kubectl set volume deployment/app --add --type=configmap --mount-path=/config --configmap-name=config` |
| ğŸ” **é…ç½®éªŒè¯** | `kubectl exec -it pod -- env \| grep KEY` |
| ğŸ”„ **é‡å¯ç”Ÿæ•ˆ** | `kubectl rollout restart deployment/app` |

### 7.3 å®é™…åº”ç”¨ä»·å€¼


**å¼€å‘åœºæ™¯**ï¼š
- ğŸš€ **å¤šç¯å¢ƒéƒ¨ç½²**ï¼šåŒä¸€é•œåƒï¼Œä¸åŒé…ç½®
- ğŸ”’ **å¯†é’¥ç®¡ç†**ï¼šæ•°æ®åº“å¯†ç ã€APIå¯†é’¥ç‹¬ç«‹ç®¡ç†  
- ğŸ“ **é…ç½®çƒ­æ›´æ–°**ï¼šä¸é‡æ–°æ„å»ºé•œåƒå³å¯æ›´æ–°é…ç½®
- ğŸ¯ **é…ç½®ç‰ˆæœ¬åŒ–**ï¼šé…ç½®å˜æ›´å¯è¿½æº¯å›æ»š

**è¿ç»´ä»·å€¼**ï¼š
- é…ç½®ä¸ä»£ç åˆ†ç¦»ï¼Œé™ä½éƒ¨ç½²é£é™©
- æ•æ„Ÿä¿¡æ¯å®‰å…¨å­˜å‚¨ï¼Œç¬¦åˆå®‰å…¨è§„èŒƒ
- æ‰¹é‡é…ç½®æ›´æ–°ï¼Œæé«˜è¿ç»´æ•ˆç‡
- é…ç½®æ ‡å‡†åŒ–ï¼Œå‡å°‘ç¯å¢ƒå·®å¼‚é—®é¢˜

### 7.4 å­¦ä¹ è¿›é˜¶è·¯å¾„


```
å…¥é—¨é˜¶æ®µï¼š
âœ… ç†è§£ConfigMapå’ŒSecretåŒºåˆ«
âœ… æŒæ¡ç¯å¢ƒå˜é‡æ³¨å…¥æ–¹æ³•
âœ… å­¦ä¼šåŸºæœ¬çš„é…ç½®éªŒè¯

è¿›é˜¶é˜¶æ®µï¼š
âœ… æŒæ¡æ–‡ä»¶æŒ‚è½½æŠ€å·§
âœ… ç†è§£é…ç½®æ›´æ–°æœºåˆ¶
âœ… å­¦ä¼šé…ç½®ç‰ˆæœ¬åŒ–ç®¡ç†

é«˜çº§é˜¶æ®µï¼š
âœ… ç»“åˆHelmè¿›è¡Œé…ç½®æ¨¡æ¿åŒ–
âœ… å®ç°é…ç½®çš„CI/CDæµç¨‹
âœ… æŒæ¡é…ç½®å®‰å…¨æœ€ä½³å®è·µ
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
é…ç½®ç®¡ç†ä¸¤å¤§å®ï¼šConfigMapå’ŒSecretå¥½
ç¯å¢ƒå˜é‡è¦é‡å¯ï¼Œæ–‡ä»¶æŒ‚è½½è‡ªåŠ¨åˆ°
set envæ³¨å…¥å¿«ï¼Œset volumeæŒ‚è½½å¦™
éªŒè¯è°ƒè¯•execç”¨ï¼Œrollouté‡å¯ä¸èƒ½å°‘
```

**å®æˆ˜å»ºè®®**ï¼š
- ä»ç®€å•çš„ç¯å¢ƒå˜é‡å¼€å§‹ç»ƒä¹ 
- é€æ­¥å°è¯•æ–‡ä»¶æŒ‚è½½çš„å¤æ‚åœºæ™¯
- å¤šåŠ¨æ‰‹éªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆ
- ç»“åˆå®é™…é¡¹ç›®éœ€æ±‚é€‰æ‹©é…ç½®æ–¹å¼