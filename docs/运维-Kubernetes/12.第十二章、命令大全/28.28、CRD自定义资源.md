---
title: 28ã€CRDè‡ªå®šä¹‰èµ„æº
---
## ğŸ“š ç›®å½•

1. [CRDæ˜¯ä»€ä¹ˆ - é€šä¿—ç†è§£](#1-CRDæ˜¯ä»€ä¹ˆ-é€šä¿—ç†è§£)
2. [ä¸ºä»€ä¹ˆéœ€è¦CRD](#2-ä¸ºä»€ä¹ˆéœ€è¦CRD)
3. [CRDåŸºæœ¬æ¦‚å¿µä¸ç»„æˆ](#3-CRDåŸºæœ¬æ¦‚å¿µä¸ç»„æˆ)
4. [CRDå‘½ä»¤å®æˆ˜æ“ä½œ](#4-CRDå‘½ä»¤å®æˆ˜æ“ä½œ)
5. [åˆ›å»ºå’Œç®¡ç†è‡ªå®šä¹‰èµ„æº](#5-åˆ›å»ºå’Œç®¡ç†è‡ªå®šä¹‰èµ„æº)
6. [CRDé«˜çº§ç‰¹æ€§](#6-CRDé«˜çº§ç‰¹æ€§)
7. [å®é™…åº”ç”¨åœºæ™¯](#7-å®é™…åº”ç”¨åœºæ™¯)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¤” CRDæ˜¯ä»€ä¹ˆ - é€šä¿—ç†è§£


### 1.1 ç”Ÿæ´»åŒ–ç†è§£CRD


**ğŸ  æˆ¿å±‹è£…ä¿®çš„æ¯”å–»**
```
æƒ³è±¡ä½ åœ¨è£…ä¿®æˆ¿å­ï¼š
â€¢ Kubernetes = æ¯›å¯æˆ¿ï¼ˆåŸºç¡€è®¾æ–½ï¼‰
â€¢ åŸç”Ÿèµ„æº = æ ‡å‡†å®¶å…·ï¼ˆåºŠã€æ¡Œå­ã€æ¤…å­ï¼‰
â€¢ CRD = è‡ªå®šä¹‰å®¶å…·è®¾è®¡å›¾çº¸
â€¢ Custom Resource = æ ¹æ®å›¾çº¸åšå‡ºæ¥çš„å®é™…å®¶å…·

å°±åƒä½ å¯ä»¥è®¾è®¡ä¸“å±ä¹¦æ¶ã€ç‰¹æ®ŠæŸœå­ä¸€æ ·ï¼Œ
CRDè®©ä½ å¯ä»¥åœ¨Kubernetesé‡Œå®šä¹‰ä¸“å±çš„"èµ„æºç±»å‹"
```

### 1.2 æŠ€æœ¯å®šä¹‰


**ğŸ”¸ CRDå…¨ç§°**ï¼šCustom Resource Definitionï¼ˆè‡ªå®šä¹‰èµ„æºå®šä¹‰ï¼‰

**æ ¸å¿ƒä½œç”¨**ï¼š
```
è®©ä½ å¯ä»¥åœ¨Kubernetesä¸­åˆ›å»ºæ–°çš„èµ„æºç±»å‹ï¼Œ
å°±åƒåŸç”Ÿçš„Podã€Serviceä¸€æ ·ï¼Œ
ä½†æ˜¯å®Œå…¨æŒ‰ç…§ä½ çš„éœ€æ±‚å®šåˆ¶ã€‚
```

ğŸ’¡ **ç®€å•ç†è§£**ï¼š
- Kubernetesæœ¬èº«æœ‰Podã€Serviceã€Deploymentç­‰èµ„æºç±»å‹
- CRDè®©ä½ å¯ä»¥åˆ›å»ºè‡ªå·±çš„èµ„æºç±»å‹ï¼Œæ¯”å¦‚"Database"ã€"Monitor"
- è¿™æ ·ä½ å°±å¯ä»¥ç”¨ç†Ÿæ‚‰çš„kubectlå‘½ä»¤ç®¡ç†è¿™äº›è‡ªå®šä¹‰èµ„æº

---

## 2. ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦CRD


### 2.1 è§£å†³çš„æ ¸å¿ƒé—®é¢˜


**ğŸ“± æ‰‹æœºAppç±»æ¯”**
```
åŸç”ŸKubernetes = æ‰‹æœºç³»ç»Ÿï¼ˆiOS/Androidï¼‰
åŸç”Ÿèµ„æº = ç³»ç»Ÿè‡ªå¸¦åº”ç”¨ï¼ˆç”µè¯ã€çŸ­ä¿¡ã€ç›¸æœºï¼‰
CRD = åº”ç”¨å•†åº—çš„æ¦‚å¿µ
è‡ªå®šä¹‰èµ„æº = ç¬¬ä¸‰æ–¹åº”ç”¨ï¼ˆå¾®ä¿¡ã€æŠ–éŸ³ã€æ¸¸æˆï¼‰

æ²¡æœ‰åº”ç”¨å•†åº—ï¼Œæ‰‹æœºåŠŸèƒ½å¾ˆæœ‰é™
æ²¡æœ‰CRDï¼ŒKubernetesåŠŸèƒ½ä¹Ÿå¾ˆæœ‰é™
```

### 2.2 å®é™…åº”ç”¨éœ€æ±‚


**ğŸ”§ ä¼ä¸šçº§åœºæ™¯**
```
å‡è®¾ä½ çš„å…¬å¸éœ€è¦ç®¡ç†ï¼š
â€¢ æ•°æ®åº“é›†ç¾¤
â€¢ ç›‘æ§å‘Šè­¦è§„åˆ™  
â€¢ å¤‡ä»½ç­–ç•¥
â€¢ CI/CDæµæ°´çº¿

ç”¨åŸç”ŸKubernetesèµ„æºå¾ˆå¤æ‚ï¼Œéœ€è¦å¾ˆå¤šé…ç½®æ–‡ä»¶ã€‚
ç”¨CRDå¯ä»¥æŠŠå¤æ‚çš„é…ç½®ç®€åŒ–æˆä¸€ä¸ªè‡ªå®šä¹‰èµ„æºã€‚
```

**å¯¹æ¯”ç¤ºä¾‹**ï¼š
```
ä¼ ç»Ÿæ–¹å¼ï¼šéœ€è¦åˆ›å»º10+ä¸ªYAMLæ–‡ä»¶
ä½¿ç”¨CRDï¼šåªéœ€è¦1ä¸ªç®€å•çš„è‡ªå®šä¹‰èµ„æºé…ç½®
```

### 2.3 CRDçš„æ ¸å¿ƒä»·å€¼


| **ä¼˜åŠ¿** | **å…·ä½“ä½“ç°** | **å¯¹æ–°æ‰‹çš„å¥½å¤„** |
|---------|------------|---------------|
| ğŸ¯ **ç®€åŒ–å¤æ‚åº¦** | æŠŠå¤æ‚é…ç½®åŒ…è£…æˆç®€å•èµ„æº | ä¸éœ€è¦è®°ä½å¤ªå¤šé…ç½®ç»†èŠ‚ |
| ğŸ”„ **ç»Ÿä¸€ç®¡ç†** | ç”¨kubectlç®¡ç†æ‰€æœ‰èµ„æº | å‘½ä»¤ç»Ÿä¸€ï¼Œå­¦ä¹ æˆæœ¬ä½ |
| ğŸ”Œ **æ‰©å±•æ€§å¼º** | å¯ä»¥é›†æˆç¬¬ä¸‰æ–¹å·¥å…· | ç”Ÿæ€ä¸°å¯Œï¼ŒåŠŸèƒ½å¼ºå¤§ |
| ğŸ“š **æŠ½è±¡å‹å¥½** | ä¸šåŠ¡æ¦‚å¿µç›´æ¥æ˜ å°„ | æ›´è´´è¿‘å®é™…å·¥ä½œåœºæ™¯ |

---

## 3. ğŸ—ï¸ CRDåŸºæœ¬æ¦‚å¿µä¸ç»„æˆ


### 3.1 CRDçš„æ ¸å¿ƒç»„ä»¶


```
CRDæ¶æ„å›¾ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          CRD Definition             â”‚ â† å®šä¹‰æ–°èµ„æºç±»å‹çš„"æ¨¡æ¿"
â”‚  (Custom Resource Definition)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        Custom Resources             â”‚ â† æ ¹æ®CRDåˆ›å»ºçš„å…·ä½“"å®ä¾‹"
â”‚     (CR - Custom Resource)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Controller                  â”‚ â† è´Ÿè´£å¤„ç†è‡ªå®šä¹‰èµ„æºçš„"å¤§è„‘"
â”‚    (Optional but Important)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ä¸‰è€…å…³ç³»è¯¦è§£


**ğŸ­ å·¥å‚ç”Ÿäº§çº¿ç±»æ¯”**
```
CRD = äº§å“è®¾è®¡å›¾çº¸
â€¢ å®šä¹‰äº§å“è§„æ ¼ã€å‚æ•°ã€ç‰¹æ€§
â€¢ å‘Šè¯‰å·¥å‚æ€ä¹ˆç”Ÿäº§è¿™ä¸ªäº§å“

Custom Resource = å…·ä½“ç”Ÿäº§çš„äº§å“
â€¢ æŒ‰ç…§å›¾çº¸ç”Ÿäº§å‡ºæ¥çš„å®é™…äº§å“
â€¢ æ¯ä¸ªäº§å“éƒ½æœ‰è‡ªå·±çš„é…ç½®å’ŒçŠ¶æ€

Controller = è´¨æ£€å‘˜ + ç”Ÿäº§è°ƒåº¦å‘˜
â€¢ ç›‘æ§äº§å“çŠ¶æ€
â€¢ å‘ç°é—®é¢˜æ—¶è‡ªåŠ¨ä¿®å¤
â€¢ ç¡®ä¿äº§å“ç¬¦åˆè®¾è®¡è¦æ±‚
```

### 3.3 CRDå®šä¹‰ç»“æ„


**æ ¸å¿ƒå­—æ®µè§£é‡Š**ï¼š
```yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: databases.example.com    # CRDçš„åç§°
spec:
  group: example.com            # APIç»„å
  versions:                     # ç‰ˆæœ¬ä¿¡æ¯
  - name: v1
    served: true
    storage: true
    schema:                     # èµ„æºçš„ç»“æ„å®šä¹‰
      openAPIV3Schema:
        type: object
        properties:
          spec:                 # ç”¨æˆ·é…ç½®çš„éƒ¨åˆ†
            type: object
          status:               # ç³»ç»ŸçŠ¶æ€éƒ¨åˆ†
            type: object
  scope: Namespaced            # å‘½åç©ºé—´çº§åˆ«
  names:
    plural: databases          # å¤æ•°åç§°
    singular: database         # å•æ•°åç§°
    kind: Database             # èµ„æºç±»å‹å
```

ğŸ’¡ **æ–°æ‰‹ç†è§£è¦ç‚¹**ï¼š
- `group`ï¼šå°±åƒè½¯ä»¶çš„å‚å•†åï¼Œé¿å…å†²çª
- `names`ï¼šå®šä¹‰è¿™ä¸ªèµ„æºæ€ä¹ˆç§°å‘¼
- `scope`ï¼šå†³å®šèµ„æºæ˜¯å…¨é›†ç¾¤çš„è¿˜æ˜¯å‘½åç©ºé—´çº§åˆ«çš„
- `schema`ï¼šå®šä¹‰è¿™ä¸ªèµ„æºå¯ä»¥é…ç½®å“ªäº›å‚æ•°

---

## 4. âš¡ CRDå‘½ä»¤å®æˆ˜æ“ä½œ


### 4.1 æŸ¥çœ‹ç³»ç»Ÿä¸­çš„CRD


**ğŸ“‹ åŸºç¡€æŸ¥çœ‹å‘½ä»¤**

```bash
# åˆ—å‡ºæ‰€æœ‰CRD
kubectl get crd

# æŸ¥çœ‹CRDè¯¦ç»†ä¿¡æ¯
kubectl describe crd [crd-name]

# ä»¥YAMLæ ¼å¼æŸ¥çœ‹CRD
kubectl get crd [crd-name] -o yaml
```

**å®é™…æ“ä½œç¤ºä¾‹**ï¼š
```bash
# æŸ¥çœ‹æ‰€æœ‰CRD
$ kubectl get crd
NAME                              CREATED AT
databases.example.com             2024-01-01T10:00:00Z
monitors.example.com              2024-01-01T11:00:00Z

# æŸ¥çœ‹å…·ä½“CRDè¯¦æƒ…
$ kubectl describe crd databases.example.com
Name:         databases.example.com
Namespace:    
Group:        example.com
Version:      v1
Kind:         Database
```

### 4.2 æŸ¥çœ‹ç‰¹å®šAPIç»„çš„èµ„æº


```bash
# æŸ¥çœ‹ç‰¹å®šAPIç»„ä¸‹çš„æ‰€æœ‰èµ„æº
kubectl api-resources --api-group=[group-name]

# å®ä¾‹ï¼šæŸ¥çœ‹example.comç»„çš„èµ„æº
kubectl api-resources --api-group=example.com
```

**ğŸ“Š å‘½ä»¤è¾“å‡ºè§£è¯»**ï¼š
```
NAME        SHORTNAMES   APIVERSION        NAMESPACED   KIND
databases   db           example.com/v1    true         Database
monitors    mon          example.com/v1    true         Monitor
```

### 4.3 è·å–è‡ªå®šä¹‰èµ„æºå­—æ®µè¯´æ˜


```bash
# æŸ¥çœ‹è‡ªå®šä¹‰èµ„æºçš„å­—æ®µå®šä¹‰
kubectl explain [custom-resource]

# æŸ¥çœ‹åµŒå¥—å­—æ®µ
kubectl explain [custom-resource].spec
kubectl explain [custom-resource].status
```

**ğŸ’¡ æ–°æ‰‹æç¤º**ï¼š
- `explain`å‘½ä»¤å°±åƒæŸ¥çœ‹"è¯´æ˜ä¹¦"
- å‘Šè¯‰ä½ è¿™ä¸ªèµ„æºå¯ä»¥é…ç½®ä»€ä¹ˆå‚æ•°
- æ¯ä¸ªå­—æ®µçš„ä½œç”¨å’Œæ ¼å¼è¦æ±‚

---

## 5. ğŸ› ï¸ åˆ›å»ºå’Œç®¡ç†è‡ªå®šä¹‰èµ„æº


### 5.1 ç®¡ç†è‡ªå®šä¹‰èµ„æºå®ä¾‹


**åŸºç¡€CRUDæ“ä½œ**ï¼š
```bash
# åˆ›å»ºè‡ªå®šä¹‰èµ„æº
kubectl apply -f custom-resource.yaml

# è·å–è‡ªå®šä¹‰èµ„æºåˆ—è¡¨
kubectl get [custom-resource]

# æŸ¥çœ‹å…·ä½“å®ä¾‹è¯¦æƒ…
kubectl describe [custom-resource] [name]

# ç¼–è¾‘è‡ªå®šä¹‰èµ„æº
kubectl edit [custom-resource] [name]

# åˆ é™¤è‡ªå®šä¹‰èµ„æºå®ä¾‹
kubectl delete [custom-resource] [name]
```

### 5.2 è·¨å‘½åç©ºé—´æ“ä½œ


```bash
# æŸ¥çœ‹æ‰€æœ‰å‘½åç©ºé—´çš„è‡ªå®šä¹‰èµ„æº
kubectl get [custom-resource] -A

# æŸ¥çœ‹ç‰¹å®šå‘½åç©ºé—´çš„èµ„æº
kubectl get [custom-resource] -n [namespace]

# ç›‘æ§è‡ªå®šä¹‰èµ„æºå˜åŒ–
kubectl get [custom-resource] -w
```

### 5.3 è‡ªå®šä¹‰èµ„æºçš„æ›´æ–°æ“ä½œ


**ğŸ”§ æ›´æ–°æ–¹å¼å¯¹æ¯”**ï¼š

| **æ›´æ–°æ–¹å¼** | **é€‚ç”¨åœºæ™¯** | **å‘½ä»¤ç¤ºä¾‹** |
|------------|------------|-------------|
| `apply` | å£°æ˜å¼æ›´æ–°ï¼Œæ¨è | `kubectl apply -f resource.yaml` |
| `patch` | éƒ¨åˆ†å­—æ®µæ›´æ–° | `kubectl patch db mydb --type='merge' -p='{"spec":{"version":"2.0"}}'` |
| `edit` | ä¸´æ—¶ä¿®æ”¹ï¼Œè°ƒè¯•ç”¨ | `kubectl edit database mydb` |

### 5.4 å®æˆ˜ç¤ºä¾‹ï¼šæ•°æ®åº“èµ„æºç®¡ç†


å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªDatabase CRDï¼Œæ¼”ç¤ºå®Œæ•´æ“ä½œæµç¨‹ï¼š

```bash
# 1. æŸ¥çœ‹Database CRDæ˜¯å¦å­˜åœ¨
kubectl get crd databases.example.com

# 2. äº†è§£Databaseèµ„æºç»“æ„
kubectl explain database

# 3. åˆ›å»ºä¸€ä¸ªæ•°æ®åº“å®ä¾‹
kubectl apply -f - <<EOF
apiVersion: example.com/v1
kind: Database
metadata:
  name: my-mysql
  namespace: default
spec:
  engine: mysql
  version: "8.0"
  replicas: 3
  storage: "100Gi"
EOF

# 4. æŸ¥çœ‹åˆ›å»ºçš„æ•°æ®åº“
kubectl get database

# 5. æŸ¥çœ‹è¯¦ç»†çŠ¶æ€
kubectl describe database my-mysql

# 6. æ›´æ–°æ•°æ®åº“ç‰ˆæœ¬
kubectl patch database my-mysql --type='merge' \
  -p='{"spec":{"version":"8.1"}}'

# 7. æ¸…ç†èµ„æº
kubectl delete database my-mysql
```

---

## 6. ğŸš€ CRDé«˜çº§ç‰¹æ€§


### 6.1 CRDç‰ˆæœ¬ç®¡ç†


**å¤šç‰ˆæœ¬æ”¯æŒ**ï¼š
```
å®é™…åœºæ™¯ï¼šæ•°æ®åº“CRDå‡çº§

v1ç‰ˆæœ¬ï¼šåªæ”¯æŒåŸºç¡€é…ç½®
v2ç‰ˆæœ¬ï¼šå¢åŠ äº†å¤‡ä»½é…ç½®
v3ç‰ˆæœ¬ï¼šå¢åŠ äº†ç›‘æ§é…ç½®

Kuberneteså¯ä»¥åŒæ—¶æ”¯æŒå¤šä¸ªç‰ˆæœ¬ï¼Œ
è®©è€ç‰ˆæœ¬çš„èµ„æºç»§ç»­å·¥ä½œï¼Œæ–°èµ„æºç”¨æ–°ç‰ˆæœ¬ã€‚
```

**ç‰ˆæœ¬è½¬æ¢ç¤ºä¾‹**ï¼š
```bash
# æŸ¥çœ‹CRDæ”¯æŒçš„ç‰ˆæœ¬
kubectl get crd databases.example.com -o jsonpath='{.spec.versions[*].name}'

# ä¸åŒç‰ˆæœ¬çš„èµ„æºå¯ä»¥å¹¶å­˜
kubectl get database.v1.example.com
kubectl get database.v2.example.com
```

### 6.2 èµ„æºéªŒè¯


**ğŸ›¡ï¸ è¾“å…¥éªŒè¯**ï¼š
```yaml
# CRDä¸­çš„éªŒè¯è§„åˆ™ç¤ºä¾‹
schema:
  openAPIV3Schema:
    type: object
    properties:
      spec:
        type: object
        properties:
          replicas:
            type: integer
            minimum: 1      # å‰¯æœ¬æ•°è‡³å°‘ä¸º1
            maximum: 10     # å‰¯æœ¬æ•°æœ€å¤š10ä¸ª
          version:
            type: string
            pattern: '^[0-9]+\.[0-9]+$'  # ç‰ˆæœ¬æ ¼å¼éªŒè¯
        required:
        - replicas          # å¿…å¡«å­—æ®µ
        - version
```

ğŸ’¡ **éªŒè¯çš„å¥½å¤„**ï¼š
- é˜²æ­¢ç”¨æˆ·è¾“å…¥é”™è¯¯é…ç½®
- æå‰å‘ç°é—®é¢˜ï¼Œé¿å…è¿è¡Œæ—¶é”™è¯¯
- æä¾›æ¸…æ™°çš„é”™è¯¯æç¤º

### 6.3 çŠ¶æ€å­èµ„æº


**çŠ¶æ€ç®¡ç†æœºåˆ¶**ï¼š
```
Custom Resourceç»“æ„ï¼š
â”œâ”€â”€ specï¼ˆç”¨æˆ·æœŸæœ›çš„é…ç½®ï¼‰
â””â”€â”€ statusï¼ˆç³»ç»Ÿå½“å‰çš„çŠ¶æ€ï¼‰

å°±åƒè®¢å¤–å–ï¼š
â€¢ spec = ä½ ä¸‹çš„è®¢å•ï¼ˆè¦ä»€ä¹ˆèœï¼‰
â€¢ status = è®¢å•å½“å‰çŠ¶æ€ï¼ˆåˆ¶ä½œä¸­/é…é€ä¸­/å·²é€è¾¾ï¼‰
```

---

## 7. ğŸ¯ å®é™…åº”ç”¨åœºæ™¯


### 7.1 æ•°æ®åº“ç®¡ç†åœºæ™¯


**ğŸ—„ï¸ MySQLé›†ç¾¤ç®¡ç†**
```yaml
apiVersion: example.com/v1
kind: Database
metadata:
  name: prod-mysql
spec:
  engine: mysql
  version: "8.0"
  replicas: 3
  resources:
    memory: "4Gi"
    cpu: "2"
  backup:
    schedule: "0 2 * * *"
    retention: "7d"
```

**å¥½å¤„**ï¼š
- ä¸€ä¸ªé…ç½®æ–‡ä»¶ç®¡ç†æ•´ä¸ªæ•°æ®åº“é›†ç¾¤
- è‡ªåŠ¨å¤„ç†ä¸»ä»å¤åˆ¶ã€å¤‡ä»½ã€ç›‘æ§
- è¿ç»´äººå‘˜ä¸éœ€è¦æ‡‚å¤æ‚çš„æ•°æ®åº“é…ç½®

### 7.2 ç›‘æ§å‘Šè­¦åœºæ™¯


**ğŸ“Š å‘Šè­¦è§„åˆ™ç®¡ç†**
```yaml
apiVersion: monitoring.com/v1
kind: AlertRule  
metadata:
  name: cpu-high-alert
spec:
  metric: cpu_usage
  threshold: 80
  duration: "5m"
  actions:
    - email: ops@company.com
    - slack: "#alerts"
```

### 7.3 CI/CDæµæ°´çº¿åœºæ™¯


**ğŸ”„ æµæ°´çº¿å®šä¹‰**
```yaml
apiVersion: cicd.com/v1
kind: Pipeline
metadata:
  name: web-app-deploy
spec:
  source:
    git: https://github.com/company/web-app
    branch: main
  stages:
    - name: build
      image: node:16
    - name: test
      image: node:16
    - name: deploy
      target: production
```

### 7.4 åº”ç”¨åœºæ™¯æ€»ç»“


| **åœºæ™¯** | **ä¼ ç»Ÿæ–¹å¼ç—›ç‚¹** | **CRDè§£å†³æ–¹æ¡ˆ** |
|---------|----------------|---------------|
| **æ•°æ®åº“ç®¡ç†** | é…ç½®å¤æ‚ï¼Œå®¹æ˜“å‡ºé”™ | ç®€å•å£°æ˜ï¼Œè‡ªåŠ¨åŒ–ç®¡ç† |
| **ç›‘æ§å‘Šè­¦** | å¤šä¸ªå·¥å…·ï¼Œéš¾ä»¥ç»Ÿä¸€ | ç»Ÿä¸€APIï¼Œkubectlç®¡ç† |
| **åº”ç”¨å‘å¸ƒ** | æµç¨‹å¤æ‚ï¼Œæ‰‹å·¥æ“ä½œå¤š | å£°æ˜å¼æµæ°´çº¿ï¼Œè‡ªåŠ¨åŒ– |
| **å¤‡ä»½æ¢å¤** | è„šæœ¬ç¹å¤šï¼Œå®¹æ˜“é—æ¼ | ç­–ç•¥åŒ–é…ç½®ï¼Œå®šæ—¶æ‰§è¡Œ |

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 CRDæ ¸å¿ƒæ¦‚å¿µå›é¡¾


```
ğŸ”¸ CRD = è‡ªå®šä¹‰èµ„æºçš„"è®¾è®¡å›¾çº¸"
ğŸ”¸ Custom Resource = æ ¹æ®CRDåˆ›å»ºçš„å…·ä½“"å®ä¾‹"  
ğŸ”¸ Controller = è´Ÿè´£å¤„ç†è‡ªå®šä¹‰èµ„æºçš„"ç®¡ç†ç¨‹åº"
ğŸ”¸ ç”¨é€” = æ‰©å±•Kubernetesï¼Œæ”¯æŒå¤æ‚ä¸šåŠ¡åœºæ™¯
```

### 8.2 å¿…çŸ¥å¿…ä¼šçš„å‘½ä»¤


**ğŸ“š å‘½ä»¤é€ŸæŸ¥è¡¨**
```bash
# CRDç®¡ç†
kubectl get crd                          # æŸ¥çœ‹æ‰€æœ‰CRD
kubectl describe crd [name]              # CRDè¯¦ç»†ä¿¡æ¯
kubectl explain [custom-resource]        # å­—æ®µè¯´æ˜

# è‡ªå®šä¹‰èµ„æºç®¡ç†  
kubectl get [custom-resource]            # åˆ—å‡ºèµ„æºå®ä¾‹
kubectl describe [custom-resource] [name] # å®ä¾‹è¯¦æƒ…
kubectl delete [custom-resource] [name]  # åˆ é™¤å®ä¾‹
kubectl get [custom-resource] -A         # å…¨å±€æŸ¥çœ‹
kubectl patch [custom-resource] [name] --type='merge' -p='[data]' # æ›´æ–°

# APIèµ„æºæŸ¥è¯¢
kubectl api-resources --api-group=[group] # æŸ¥çœ‹APIç»„èµ„æº
```

### 8.3 å­¦ä¹ é‡ç‚¹æ€»ç»“


**ğŸ¯ æŒæ¡å±‚æ¬¡**

```
æ–°æ‰‹å…¥é—¨ â­
â”œâ”€â”€ ç†è§£CRDåŸºæœ¬æ¦‚å¿µ
â”œâ”€â”€ ä¼šæŸ¥çœ‹ç°æœ‰CRD
â””â”€â”€ ä¼šç®¡ç†è‡ªå®šä¹‰èµ„æºå®ä¾‹

è¿›é˜¶åº”ç”¨ â­â­
â”œâ”€â”€ ç†è§£CRDç»„ä»¶å…³ç³»
â”œâ”€â”€ æŒæ¡é«˜çº§æŸ¥è¯¢æŠ€å·§  
â””â”€â”€ äº†è§£å¸¸è§åº”ç”¨åœºæ™¯

æ·±å…¥ç†è§£ â­â­â­
â”œâ”€â”€ ç†è§£å¤šç‰ˆæœ¬ç®¡ç†
â”œâ”€â”€ æŒæ¡éªŒè¯å’ŒçŠ¶æ€ç®¡ç†
â””â”€â”€ èƒ½å¤Ÿè®¾è®¡CRDæ–¹æ¡ˆ
```

### 8.4 å®æˆ˜å­¦ä¹ å»ºè®®


**ğŸ“ å­¦ä¹ è·¯å¾„**
```
ç¬¬1æ­¥ï¼šè§‚å¯Ÿç°æœ‰CRD
â€¢ kubectl get crd
â€¢ é€‰æ‹©ä¸€ä¸ªç®€å•çš„CRDäº†è§£ç»“æ„

ç¬¬2æ­¥ï¼šå®è·µåŸºæœ¬æ“ä½œ  
â€¢ åˆ›å»ºè‡ªå®šä¹‰èµ„æºå®ä¾‹
â€¢ ä¿®æ”¹å’Œåˆ é™¤å®ä¾‹

ç¬¬3æ­¥ï¼šæ·±å…¥ç†è§£
â€¢ é˜…è¯»CRDå®šä¹‰
â€¢ ç†è§£å­—æ®µå«ä¹‰å’ŒéªŒè¯è§„åˆ™

ç¬¬4æ­¥ï¼šåœºæ™¯åº”ç”¨
â€¢ æ‰¾åˆ°å®é™…ä¸šåŠ¡åœºæ™¯
â€¢ æ€è€ƒå¦‚ä½•ç”¨CRDç®€åŒ–æ“ä½œ
```

### 8.5 å¸¸è§é—®é¢˜ä¸æ³¨æ„äº‹é¡¹


**âš ï¸ æ–°æ‰‹å®¹æ˜“çŠ¯çš„é”™è¯¯**

| **é—®é¢˜** | **åŸå› ** | **è§£å†³æ–¹æ¡ˆ** |
|---------|---------|-------------|
| æ‰¾ä¸åˆ°è‡ªå®šä¹‰èµ„æº | CRDæœªå®‰è£… | å…ˆæ£€æŸ¥`kubectl get crd` |
| æ— æ³•åˆ›å»ºèµ„æº | æƒé™ä¸è¶³ | æ£€æŸ¥RBACæƒé™é…ç½® |
| å­—æ®µéªŒè¯å¤±è´¥ | ä¸äº†è§£èµ„æºç»“æ„ | ä½¿ç”¨`kubectl explain`æŸ¥çœ‹ |
| èµ„æºä¸ç”Ÿæ•ˆ | ç¼ºå°‘Controller | ç¡®è®¤æ˜¯å¦æœ‰å¯¹åº”çš„æ§åˆ¶å™¨ |

**ğŸ”§ è°ƒè¯•æŠ€å·§**
```bash
# 1. æ£€æŸ¥CRDæ˜¯å¦å­˜åœ¨
kubectl get crd | grep [your-resource]

# 2. æŸ¥çœ‹èµ„æºç»“æ„
kubectl explain [your-resource]

# 3. æ£€æŸ¥èµ„æºçŠ¶æ€
kubectl describe [your-resource] [name]

# 4. æŸ¥çœ‹äº‹ä»¶
kubectl get events --field-selector involvedObject.name=[name]
```

### 8.6 æ ¸å¿ƒè®°å¿†è¦ç‚¹


**ğŸ’¡ è®°å¿†å£è¯€**
```
CRDæ‰©å±•K8såŠŸèƒ½å¼ºï¼Œ
è‡ªå®šä¹‰èµ„æºä¸šåŠ¡æ£’ã€‚
explainæŸ¥ç»“æ„ï¼Œgetçœ‹å®ä¾‹ï¼Œ
describeè¯¦æƒ…patchæ¥æ”¹ã€‚
æ§åˆ¶å™¨é…åˆæ‰å®Œæ•´ï¼Œ
å£°æ˜å¼ç®¡ç†çœŸè½»æ¾ï¼
```

**ğŸ¯ æ ¸å¿ƒä»·å€¼**
- **ç®€åŒ–å¤æ‚åº¦**ï¼šæŠŠå¤æ‚çš„ç³»ç»ŸæŠ½è±¡æˆç®€å•çš„èµ„æº
- **ç»Ÿä¸€ç®¡ç†**ï¼šç”¨ç†Ÿæ‚‰çš„kubectlå‘½ä»¤ç®¡ç†ä¸€åˆ‡
- **æ‰©å±•æ€§å¼º**ï¼šè®©Kubernetesé€‚åº”å„ç§ä¸šåŠ¡åœºæ™¯
- **å£°æ˜å¼**ï¼šæè¿°æœŸæœ›çŠ¶æ€ï¼Œç³»ç»Ÿè‡ªåŠ¨è¾¾æˆç›®æ ‡

é€šè¿‡CRDï¼Œæˆ‘ä»¬å¯ä»¥è®©Kubernetesä¸ä»…ä»…æ˜¯å®¹å™¨ç¼–æ’å¹³å°ï¼Œæ›´æˆä¸ºæ•´ä¸ªåŸºç¡€è®¾æ–½çš„ç»Ÿä¸€ç®¡ç†å¹³å°ï¼