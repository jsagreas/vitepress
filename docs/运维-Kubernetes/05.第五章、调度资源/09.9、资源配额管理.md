---
title: 9ã€èµ„æºé…é¢ç®¡ç†
---
## ğŸ“š ç›®å½•

1. [èµ„æºé…é¢ç®¡ç†æ¦‚è¿°](#1-èµ„æºé…é¢ç®¡ç†æ¦‚è¿°)
2. [ResourceQuotaèµ„æºé…é¢è¯¦è§£](#2-ResourceQuotaèµ„æºé…é¢è¯¦è§£)
3. [LimitRangeé™åˆ¶èŒƒå›´è¯¦è§£](#3-LimitRangeé™åˆ¶èŒƒå›´è¯¦è§£)
4. [å¤šç§Ÿæˆ·èµ„æºéš”ç¦»å®è·µ](#4-å¤šç§Ÿæˆ·èµ„æºéš”ç¦»å®è·µ)
5. [èµ„æºé…é¢ç›‘æ§ä¸è°ƒä¼˜](#5-èµ„æºé…é¢ç›‘æ§ä¸è°ƒä¼˜)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ èµ„æºé…é¢ç®¡ç†æ¦‚è¿°


### 1.1 ä¸ºä»€ä¹ˆéœ€è¦èµ„æºé…é¢ç®¡ç†


**ç°å®åœºæ™¯ç†è§£**ï¼š
æƒ³è±¡ä¸€ä¸ªå…¬å¸çš„åŠå…¬æ¥¼ï¼Œå¦‚æœæ²¡æœ‰ç®¡ç†ï¼Œå¯èƒ½å‡ºç°è¿™äº›é—®é¢˜ï¼š
- æŸä¸ªéƒ¨é—¨å ç”¨äº†å¤§éƒ¨åˆ†ä¼šè®®å®¤ï¼Œå…¶ä»–éƒ¨é—¨å¼€ä¼šå›°éš¾
- æœ‰äººåœ¨èŒ¶æ°´é—´å †æ”¾å¤§é‡ç‰©å“ï¼Œå½±å“å…¶ä»–äººä½¿ç”¨
- æ‰“å°æœºè¢«æŸä¸ªé¡¹ç›®ç»„å¤§é‡ä½¿ç”¨ï¼Œå…¶ä»–äººæ— æ³•æ­£å¸¸æ‰“å°

```
æ²¡æœ‰èµ„æºç®¡ç†çš„K8sé›†ç¾¤ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Node1 (8æ ¸16G)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚åº”ç”¨Aå ç”¨â”‚ â”‚åº”ç”¨Bç­‰å¾…â”‚ â”‚åº”ç”¨C   â”‚ â”‚
â”‚  â”‚7æ ¸14G   â”‚ â”‚èµ„æºä¸è¶³ â”‚ â”‚è¢«æŒ¤å‹  â”‚ â”‚
â”‚  â”‚è¿è¡Œæ­£å¸¸ â”‚ â”‚æ— æ³•å¯åŠ¨ â”‚ â”‚é¢‘ç¹é‡å¯â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é—®é¢˜åˆ†æï¼š
âŒ åº”ç”¨Aç‹¬å å¤§éƒ¨åˆ†èµ„æº
âŒ åº”ç”¨Bæ— æ³•è·å¾—è¶³å¤Ÿèµ„æºå¯åŠ¨
âŒ åº”ç”¨Cèµ„æºä¸è¶³å½±å“ç¨³å®šæ€§
âŒ é›†ç¾¤æ•´ä½“åˆ©ç”¨ç‡ä¸å‡è¡¡
```

**èµ„æºé…é¢ç®¡ç†è§£å†³çš„æ ¸å¿ƒé—®é¢˜**ï¼š
- **èµ„æºå…¬å¹³åˆ†é…**ï¼šç¡®ä¿æ¯ä¸ªå›¢é˜Ÿ/é¡¹ç›®éƒ½èƒ½è·å¾—åˆç†çš„èµ„æº
- **èµ„æºä¸Šé™æ§åˆ¶**ï¼šé˜²æ­¢æŸä¸ªåº”ç”¨æ¶ˆè€—è¿‡å¤šèµ„æºå½±å“å…¶ä»–åº”ç”¨
- **æˆæœ¬æ§åˆ¶**ï¼šé€šè¿‡é…é¢é™åˆ¶æ§åˆ¶äº‘èµ„æºä½¿ç”¨æˆæœ¬
- **å¤šç§Ÿæˆ·éš”ç¦»**ï¼šåœ¨å…±äº«é›†ç¾¤ä¸­å®ç°ç§Ÿæˆ·é—´çš„èµ„æºéš”ç¦»

### 1.2 Kubernetesèµ„æºé…é¢ç®¡ç†ä½“ç³»


**ä¸¤å¤§æ ¸å¿ƒç»„ä»¶**ï¼š
```
Kubernetesèµ„æºé…é¢ç®¡ç†
â”œâ”€â”€ ResourceQuota (é…é¢ç®¡ç†)
â”‚   â”œâ”€â”€ å‘½åç©ºé—´çº§åˆ«èµ„æºé™åˆ¶
â”‚   â”œâ”€â”€ è®¡ç®—èµ„æºé…é¢ (CPU/å†…å­˜)
â”‚   â”œâ”€â”€ å­˜å‚¨èµ„æºé…é¢ (ç£ç›˜ç©ºé—´)
â”‚   â””â”€â”€ å¯¹è±¡æ•°é‡é…é¢ (Pod/Serviceæ•°é‡)
â””â”€â”€ LimitRange (èŒƒå›´é™åˆ¶)
    â”œâ”€â”€ å•ä¸ªèµ„æºå¯¹è±¡é™åˆ¶
    â”œâ”€â”€ æœ€å°/æœ€å¤§èµ„æºé™åˆ¶
    â”œâ”€â”€ é»˜è®¤èµ„æºåˆ†é…
    â””â”€â”€ èµ„æºä½¿ç”¨æ¯”ä¾‹é™åˆ¶
```

**é€šä¿—ç†è§£å¯¹æ¯”**ï¼š
- **ResourceQuota**ï¼šåƒæ˜¯ç»™æ¯ä¸ªéƒ¨é—¨åˆ†é…çš„æ€»é¢„ç®—
  - "å¼€å‘éƒ¨é—¨è¿™ä¸ªæœˆæœ€å¤šç”¨10ä¸‡å…ƒ"
  - "æµ‹è¯•ç¯å¢ƒæœ€å¤šä½¿ç”¨8æ ¸CPUï¼Œ16Gå†…å­˜"
  
- **LimitRange**ï¼šåƒæ˜¯å¯¹å•ç¬”å¼€æ”¯çš„é™åˆ¶è§„åˆ™
  - "å•æ¬¡é‡‡è´­ä¸èƒ½è¶…è¿‡5000å…ƒ"
  - "æ¯ä¸ªPodæœ€å¤šä½¿ç”¨2æ ¸CPUï¼Œ4Gå†…å­˜"

### 1.3 èµ„æºé…é¢ç®¡ç†çš„ä½œç”¨èŒƒå›´


**å‘½åç©ºé—´çº§åˆ«ç®¡ç†**ï¼š
```
é›†ç¾¤èµ„æºåˆ†é…ç¤ºä¾‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             Kubernetesé›†ç¾¤                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚devå‘½åç©ºé—´  â”‚ â”‚testå‘½åç©ºé—´ â”‚ â”‚prod    â”‚ â”‚
â”‚  â”‚é…é¢: 4æ ¸8G â”‚ â”‚é…é¢: 2æ ¸4G  â”‚ â”‚å‘½åç©ºé—´â”‚ â”‚
â”‚  â”‚å·²ç”¨: 2æ ¸4G â”‚ â”‚å·²ç”¨: 1æ ¸2G  â”‚ â”‚é…é¢:   â”‚ â”‚
â”‚  â”‚å‰©ä½™: 2æ ¸4G â”‚ â”‚å‰©ä½™: 1æ ¸2G  â”‚ â”‚8æ ¸16G  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¼˜åŠ¿ï¼š
âœ… æ¯ä¸ªç¯å¢ƒèµ„æºç‹¬ç«‹ç®¡ç†
âœ… é¿å…å¼€å‘ç¯å¢ƒå½±å“ç”Ÿäº§ç¯å¢ƒ
âœ… ä¾¿äºæˆæœ¬æ ¸ç®—å’Œè´£ä»»åˆ’åˆ†
```

---

## 2. ğŸ“Š ResourceQuotaèµ„æºé…é¢è¯¦è§£


### 2.1 ResourceQuotaåŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯ResourceQuota**ï¼š
ResourceQuotaå°±åƒæ˜¯ç»™æ¯ä¸ªéƒ¨é—¨è®¾å®šçš„**èµ„æºä½¿ç”¨ä¸Šé™**ï¼Œç¡®ä¿æ²¡æœ‰äººèƒ½ç‹¬å é›†ç¾¤èµ„æºã€‚

**æ ¸å¿ƒå·¥ä½œåŸç†**ï¼š
```
ResourceQuotaå·¥ä½œæµç¨‹ï¼š
ç”¨æˆ·åˆ›å»ºPod â†’ API Serveræ£€æŸ¥é…é¢ â†’ åˆ¤æ–­æ˜¯å¦è¶…é™ â†’ å†³å®šæ˜¯å¦å…è®¸åˆ›å»º

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ç”¨æˆ·æäº¤  â”‚ â†’  â”‚æ£€æŸ¥å½“å‰é…é¢  â”‚ â†’  â”‚åˆ›å»ºæˆåŠŸ/å¤±è´¥â”‚
â”‚Podè¯·æ±‚   â”‚    â”‚æ˜¯å¦è¶³å¤Ÿ      â”‚    â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ£€æŸ¥é¡¹ç›®ï¼š
ğŸ”¸ CPUè¯·æ±‚æ€»é‡æ˜¯å¦è¶…è¿‡é…é¢
ğŸ”¸ å†…å­˜è¯·æ±‚æ€»é‡æ˜¯å¦è¶…è¿‡é…é¢  
ğŸ”¸ å­˜å‚¨è¯·æ±‚æ€»é‡æ˜¯å¦è¶…è¿‡é…é¢
ğŸ”¸ Podæ•°é‡æ˜¯å¦è¶…è¿‡é™åˆ¶
```

### 2.2 è®¡ç®—èµ„æºé…é¢ç®¡ç†


**CPUå’Œå†…å­˜é…é¢è®¾ç½®**ï¼š
```yaml
# å¼€å‘ç¯å¢ƒèµ„æºé…é¢ç¤ºä¾‹
apiVersion: v1
kind: ResourceQuota
metadata:
  name: dev-quota
  namespace: development
spec:
  hard:
    # CPUé…é¢è®¾ç½®
    requests.cpu: "4"      # æ€»CPUè¯·æ±‚ä¸è¶…è¿‡4æ ¸
    limits.cpu: "8"        # æ€»CPUé™åˆ¶ä¸è¶…è¿‡8æ ¸
    
    # å†…å­˜é…é¢è®¾ç½®  
    requests.memory: "8Gi" # æ€»å†…å­˜è¯·æ±‚ä¸è¶…è¿‡8G
    limits.memory: "16Gi"  # æ€»å†…å­˜é™åˆ¶ä¸è¶…è¿‡16G
```

**é€šä¿—è§£é‡Šrequestså’Œlimitsçš„åŒºåˆ«**ï¼š
- **requestsï¼ˆè¯·æ±‚èµ„æºï¼‰**ï¼šå°±åƒè®¢é…’åº—æ—¶çš„"æœ€å°‘éœ€è¦"
  - "æˆ‘è‡³å°‘éœ€è¦ä¸€å¼ åºŠå’Œä¸€ä¸ªå«ç”Ÿé—´"
  - Podå¯åŠ¨æ—¶ä¿è¯èƒ½åˆ†é…åˆ°çš„æœ€å°èµ„æº
  
- **limitsï¼ˆé™åˆ¶èµ„æºï¼‰**ï¼šå°±åƒé…’åº—çš„"æœ€å¤šæä¾›"
  - "è¿™ä¸ªæˆ¿é—´æœ€å¤šä½2ä¸ªäººï¼Œæœ€å¤šç”¨2ä¸ªæµ´å·¾"
  - Podè¿è¡Œæ—¶æœ€å¤šèƒ½ä½¿ç”¨çš„èµ„æºä¸Šé™

```
èµ„æºåˆ†é…ç¤ºä¾‹ï¼š
Pod A: requests.cpu=1æ ¸, limits.cpu=2æ ¸
Pod B: requests.cpu=2æ ¸, limits.cpu=4æ ¸  
Pod C: requests.cpu=1æ ¸, limits.cpu=2æ ¸

é…é¢æ£€æŸ¥ï¼š
âœ… CPUè¯·æ±‚æ€»é‡: 1+2+1=4æ ¸ â‰¤ é…é¢4æ ¸ (é€šè¿‡)
âœ… CPUé™åˆ¶æ€»é‡: 2+4+2=8æ ¸ â‰¤ é…é¢8æ ¸ (é€šè¿‡)
âŒ å¦‚æœå†åŠ Pod D(requests.cpu=1æ ¸)ï¼Œæ€»è¯·æ±‚=5æ ¸ > é…é¢4æ ¸ (æ‹’ç»)
```

### 2.3 å­˜å‚¨èµ„æºé…é¢ç®¡ç†


**å­˜å‚¨é…é¢çš„é‡è¦æ€§**ï¼š
å­˜å‚¨é…é¢é˜²æ­¢åº”ç”¨æ— é™åˆ¶å ç”¨ç£ç›˜ç©ºé—´ï¼Œç‰¹åˆ«æ˜¯åœ¨äº‘ç¯å¢ƒä¸­æ§åˆ¶å­˜å‚¨æˆæœ¬ã€‚

```yaml
# å­˜å‚¨èµ„æºé…é¢ç¤ºä¾‹
apiVersion: v1
kind: ResourceQuota  
metadata:
  name: storage-quota
  namespace: development
spec:
  hard:
    # å­˜å‚¨é…é¢è®¾ç½®
    requests.storage: "100Gi"           # æ€»å­˜å‚¨è¯·æ±‚ä¸è¶…è¿‡100G
    persistentvolumeclaims: "10"        # æœ€å¤šåˆ›å»º10ä¸ªPVC
    requests.ephemeral-storage: "20Gi"  # ä¸´æ—¶å­˜å‚¨ä¸è¶…è¿‡20G
    
    # æŒ‰å­˜å‚¨ç±»åˆ«é™åˆ¶
    requests.storage.ssd: "50Gi"        # SSDå­˜å‚¨ä¸è¶…è¿‡50G
    requests.storage.hdd: "200Gi"       # HDDå­˜å‚¨ä¸è¶…è¿‡200G
```

**å­˜å‚¨ç±»å‹è¯´æ˜**ï¼š
```
å­˜å‚¨ç±»å‹å¯¹æ¯”ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å­˜å‚¨ç±»å‹    â”‚ æ€§èƒ½      â”‚ ä»·æ ¼     â”‚ é€‚ç”¨åœºæ™¯â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SSDå­˜å‚¨     â”‚ é«˜IOPS    â”‚ è¾ƒè´µ     â”‚ æ•°æ®åº“  â”‚
â”‚ HDDå­˜å‚¨     â”‚ ä¸€èˆ¬      â”‚ ä¾¿å®œ     â”‚ æ—¥å¿—æ–‡ä»¶â”‚  
â”‚ ä¸´æ—¶å­˜å‚¨    â”‚ å¾ˆå¿«      â”‚ ä¸æŒä¹…   â”‚ ç¼“å­˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.4 å¯¹è±¡æ•°é‡é…é¢ç®¡ç†


**ä¸ºä»€ä¹ˆéœ€è¦é™åˆ¶å¯¹è±¡æ•°é‡**ï¼š
é˜²æ­¢åœ¨å‘½åç©ºé—´ä¸­åˆ›å»ºè¿‡å¤šçš„Kuberneteså¯¹è±¡ï¼Œé¿å…API Serverè´Ÿè½½è¿‡é«˜ã€‚

```yaml
# å¯¹è±¡æ•°é‡é…é¢ç¤ºä¾‹
apiVersion: v1
kind: ResourceQuota
metadata:
  name: object-quota  
  namespace: development
spec:
  hard:
    # Podç›¸å…³é™åˆ¶
    pods: "20"                    # æœ€å¤š20ä¸ªPod
    replicationcontrollers: "5"   # æœ€å¤š5ä¸ªRC
    
    # æœåŠ¡ç›¸å…³é™åˆ¶  
    services: "10"                # æœ€å¤š10ä¸ªService
    services.loadbalancers: "2"   # æœ€å¤š2ä¸ªè´Ÿè½½å‡è¡¡å™¨
    services.nodeports: "3"       # æœ€å¤š3ä¸ªNodePortæœåŠ¡
    
    # å­˜å‚¨ç›¸å…³é™åˆ¶
    persistentvolumeclaims: "10"  # æœ€å¤š10ä¸ªPVC
    
    # å…¶ä»–å¯¹è±¡é™åˆ¶
    secrets: "15"                 # æœ€å¤š15ä¸ªSecret
    configmaps: "20"              # æœ€å¤š20ä¸ªConfigMap
```

**å®é™…åœºæ™¯ç†è§£**ï¼š
```
å¼€å‘ç¯å¢ƒå¯¹è±¡æ•°é‡è§„åˆ’ï¼š
å¼€å‘å›¢é˜Ÿ5äºº â†’ é¢„ä¼°éœ€æ±‚ï¼š
â”œâ”€â”€ æ¯äººå¹³å‡2ä¸ªå¾®æœåŠ¡ â†’ 10ä¸ªDeployment â†’ 20ä¸ªPod
â”œâ”€â”€ æ¯ä¸ªæœåŠ¡1ä¸ªService â†’ 10ä¸ªService  
â”œâ”€â”€ æ•°æ®åº“å¯†ç ç­‰ â†’ 5ä¸ªSecret
â”œâ”€â”€ é…ç½®æ–‡ä»¶ â†’ 10ä¸ªConfigMap
â””â”€â”€ æŒä¹…åŒ–å­˜å‚¨ â†’ 5ä¸ªPVC

é…é¢è®¾ç½®å»ºè®®ï¼šé€‚å½“ç•™ä½™é‡ï¼Œè®¾ç½®ä¸ºé¢„ä¼°çš„1.5-2å€
```

### 2.5 é…é¢èŒƒå›´é™åˆ¶


**é…é¢èŒƒå›´çš„ä½œç”¨**ï¼š
å¯ä»¥é’ˆå¯¹ä¸åŒçš„PodæœåŠ¡è´¨é‡ç­‰çº§è®¾ç½®ä¸åŒçš„é…é¢é™åˆ¶ã€‚

```yaml
# åŸºäºæœåŠ¡è´¨é‡çš„é…é¢èŒƒå›´  
apiVersion: v1
kind: ResourceQuota
metadata:
  name: qos-quota
  namespace: development  
spec:
  # åªå¯¹BestEffortç±»å‹çš„Podç”Ÿæ•ˆ
  scopes: ["BestEffort"]
  hard:
    pods: "5"           # BestEffort Podæœ€å¤š5ä¸ª
    
---
apiVersion: v1  
kind: ResourceQuota
metadata:
  name: guaranteed-quota
  namespace: development
spec:
  # åªå¯¹Guaranteedç±»å‹çš„Podç”Ÿæ•ˆ
  scopes: ["NotBestEffort"] 
  hard:
    requests.cpu: "4"
    requests.memory: "8Gi"
```

**PodæœåŠ¡è´¨é‡ç­‰çº§è¯´æ˜**ï¼š
```
Pod QoSç­‰çº§ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ QoSç­‰çº§      â”‚ èµ„æºè®¾ç½®è¦æ±‚    â”‚ ä¼˜å…ˆçº§      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Guaranteed   â”‚ requests=limits â”‚ æœ€é«˜ ğŸ”´     â”‚
â”‚ Burstable    â”‚ è®¾ç½®äº†requests  â”‚ ä¸­ç­‰ ğŸŸ¡     â”‚  
â”‚ BestEffort   â”‚ æœªè®¾ç½®èµ„æºè¦æ±‚  â”‚ æœ€ä½ ğŸŸ¢     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å®é™…å«ä¹‰ï¼š
ğŸ”´ Guaranteed: å…³é”®ä¸šåŠ¡ï¼Œèµ„æºä¿è¯ï¼Œä¸ä¼šè¢«é©±é€
ğŸŸ¡ Burstable: é‡è¦ä¸šåŠ¡ï¼Œæœ‰åŸºç¡€ä¿è¯ï¼Œèµ„æºä¸è¶³æ—¶å¯èƒ½è¢«é™åˆ¶
ğŸŸ¢ BestEffort: ä¸€èˆ¬ä¸šåŠ¡ï¼Œæ— èµ„æºä¿è¯ï¼Œèµ„æºç´§å¼ æ—¶é¦–å…ˆè¢«é©±é€
```

---

## 3. ğŸ“ LimitRangeé™åˆ¶èŒƒå›´è¯¦è§£


### 3.1 LimitRangeåŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯LimitRange**ï¼š
å¦‚æœè¯´ResourceQuotaæ˜¯æ§åˆ¶"æ€»é‡"ï¼Œé‚£ä¹ˆLimitRangeå°±æ˜¯æ§åˆ¶"å•ç¬”"çš„ä½¿ç”¨é‡ã€‚

**é€šä¿—ç±»æ¯”**ï¼š
```
é“¶è¡Œå¡é¢åº¦ç®¡ç†ï¼š
â”œâ”€â”€ ä¿¡ç”¨å¡æ€»é¢åº¦: 10ä¸‡å…ƒ     â† ç±»ä¼¼ResourceQuota
â””â”€â”€ å•ç¬”æ¶ˆè´¹é™åˆ¶: 2ä¸‡å…ƒ      â† ç±»ä¼¼LimitRange

Kubernetesèµ„æºç®¡ç†ï¼š  
â”œâ”€â”€ å‘½åç©ºé—´æ€»CPU: 8æ ¸       â† ResourceQuota
â””â”€â”€ å•ä¸ªPodæœ€å¤š: 2æ ¸         â† LimitRange
```

### 3.2 å®¹å™¨çº§åˆ«é™åˆ¶è®¾ç½®


**ä¸ºä»€ä¹ˆéœ€è¦å®¹å™¨çº§åˆ«é™åˆ¶**ï¼š
é˜²æ­¢å•ä¸ªå®¹å™¨æ¶ˆè€—è¿‡å¤šèµ„æºï¼Œå½±å“åŒä¸€Podå†…å…¶ä»–å®¹å™¨æˆ–èŠ‚ç‚¹ä¸Šå…¶ä»–Podã€‚

```yaml
# å®¹å™¨èµ„æºé™åˆ¶ç¤ºä¾‹
apiVersion: v1
kind: LimitRange
metadata:
  name: container-limit-range
  namespace: development
spec:
  limits:
  - type: Container
    # å®¹å™¨èµ„æºé™åˆ¶
    max:
      cpu: "2"          # å•ä¸ªå®¹å™¨æœ€å¤šä½¿ç”¨2æ ¸CPU
      memory: "4Gi"     # å•ä¸ªå®¹å™¨æœ€å¤šä½¿ç”¨4Gå†…å­˜
    min:  
      cpu: "100m"       # å•ä¸ªå®¹å™¨æœ€å°‘è¯·æ±‚0.1æ ¸CPU
      memory: "128Mi"   # å•ä¸ªå®¹å™¨æœ€å°‘è¯·æ±‚128Må†…å­˜
    default:
      cpu: "500m"       # é»˜è®¤CPUé™åˆ¶0.5æ ¸
      memory: "1Gi"     # é»˜è®¤å†…å­˜é™åˆ¶1G
    defaultRequest:
      cpu: "200m"       # é»˜è®¤CPUè¯·æ±‚0.2æ ¸  
      memory: "256Mi"   # é»˜è®¤å†…å­˜è¯·æ±‚256M
```

**å‚æ•°è¯¦ç»†è¯´æ˜**ï¼š
- **max**: å•ä¸ªå®¹å™¨èƒ½ä½¿ç”¨çš„æœ€å¤§èµ„æº
- **min**: å•ä¸ªå®¹å™¨å¿…é¡»ç”³è¯·çš„æœ€å°èµ„æº  
- **default**: å¦‚æœæœªæŒ‡å®šlimitsï¼Œä½¿ç”¨æ­¤é»˜è®¤å€¼
- **defaultRequest**: å¦‚æœæœªæŒ‡å®šrequestsï¼Œä½¿ç”¨æ­¤é»˜è®¤å€¼

```
å®é™…åº”ç”¨æ•ˆæœï¼š
å¼€å‘äººå‘˜åˆ›å»ºPodæ—¶ï¼š

æƒ…å†µ1 - æœªæŒ‡å®šä»»ä½•èµ„æºï¼š
apiVersion: v1
kind: Pod  
spec:
  containers:
  - name: app
    image: nginx
    # æ²¡æœ‰æŒ‡å®šresources
    
è‡ªåŠ¨åº”ç”¨é»˜è®¤å€¼ï¼š
resources:
  requests:
    cpu: "200m"     # æ¥è‡ªdefaultRequest
    memory: "256Mi"
  limits:
    cpu: "500m"     # æ¥è‡ªdefault  
    memory: "1Gi"

æƒ…å†µ2 - èµ„æºè®¾ç½®è¶…é™ï¼š
resources:
  limits:
    cpu: "3"        # è¶…è¿‡maxé™åˆ¶2æ ¸
    memory: "4Gi"
    
ç»“æœï¼šPodåˆ›å»ºå¤±è´¥ï¼Œæç¤ºè¶…è¿‡LimitRangeé™åˆ¶
```

### 3.3 Podçº§åˆ«é™åˆ¶è®¾ç½®


**Podçº§åˆ«é™åˆ¶çš„å¿…è¦æ€§**ï¼š
ä¸€ä¸ªPodå¯èƒ½åŒ…å«å¤šä¸ªå®¹å™¨ï¼Œéœ€è¦æ§åˆ¶æ•´ä¸ªPodçš„èµ„æºä½¿ç”¨æ€»é‡ã€‚

```yaml
# Podçº§åˆ«é™åˆ¶ç¤ºä¾‹
apiVersion: v1
kind: LimitRange  
metadata:
  name: pod-limit-range
  namespace: development
spec:
  limits:
  - type: Pod
    max:
      cpu: "4"          # å•ä¸ªPodæ‰€æœ‰å®¹å™¨CPUæ€»å’Œä¸è¶…è¿‡4æ ¸
      memory: "8Gi"     # å•ä¸ªPodæ‰€æœ‰å®¹å™¨å†…å­˜æ€»å’Œä¸è¶…è¿‡8G
    min:
      cpu: "200m"       # å•ä¸ªPodæ‰€æœ‰å®¹å™¨CPUæ€»å’Œä¸å°‘äº0.2æ ¸
      memory: "256Mi"   # å•ä¸ªPodæ‰€æœ‰å®¹å™¨å†…å­˜æ€»å’Œä¸å°‘äº256M
```

**å¤šå®¹å™¨Podèµ„æºè®¡ç®—ç¤ºä¾‹**ï¼š
```
PodåŒ…å«3ä¸ªå®¹å™¨çš„èµ„æºè®¡ç®—ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å®¹å™¨        â”‚ CPU     â”‚ å†…å­˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ webå®¹å™¨     â”‚ 1æ ¸     â”‚ 2G      â”‚
â”‚ cacheå®¹å™¨   â”‚ 0.5æ ¸   â”‚ 1G      â”‚  
â”‚ monitorå®¹å™¨ â”‚ 0.2æ ¸   â”‚ 512M    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Podæ€»è®¡     â”‚ 1.7æ ¸   â”‚ 3.5G    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LimitRangeæ£€æŸ¥ï¼š
âœ… CPU: 1.7æ ¸ < 4æ ¸ä¸Šé™ (é€šè¿‡)
âœ… å†…å­˜: 3.5G < 8Gä¸Šé™ (é€šè¿‡)  
âœ… CPU: 1.7æ ¸ > 0.2æ ¸ä¸‹é™ (é€šè¿‡)
âœ… å†…å­˜: 3.5G > 256Mä¸‹é™ (é€šè¿‡)
```

### 3.4 å­˜å‚¨é™åˆ¶è®¾ç½®


**å­˜å‚¨é™åˆ¶çš„åº”ç”¨åœºæ™¯**ï¼š
æ§åˆ¶PVCï¼ˆæŒä¹…å·å£°æ˜ï¼‰çš„å¤§å°ï¼Œé˜²æ­¢åº”ç”¨ç”³è¯·è¿‡å¤§çš„å­˜å‚¨ç©ºé—´ã€‚

```yaml
# å­˜å‚¨é™åˆ¶ç¤ºä¾‹
apiVersion: v1
kind: LimitRange
metadata:
  name: storage-limit-range  
  namespace: development
spec:
  limits:
  - type: PersistentVolumeClaim
    max:
      storage: "50Gi"       # å•ä¸ªPVCæœ€å¤§50G
    min:
      storage: "1Gi"        # å•ä¸ªPVCæœ€å°1G
    default:
      storage: "10Gi"       # é»˜è®¤PVCå¤§å°10G
```

**å­˜å‚¨é™åˆ¶å®é™…æ•ˆæœ**ï¼š
```
ç”¨æˆ·åˆ›å»ºPVCï¼š
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: my-storage
spec:
  resources:
    requests:
      storage: 100Gi    # è¯·æ±‚100Gå­˜å‚¨
      
ç»“æœï¼š
âŒ åˆ›å»ºå¤±è´¥ï¼åŸå› ï¼š100Gi > LimitRangeæœ€å¤§é™åˆ¶50Gi

æ­£ç¡®çš„PVCï¼š
spec:
  resources:
    requests:
      storage: 30Gi     # 30Giåœ¨1Gi-50GièŒƒå›´å†…
      
ç»“æœï¼š
âœ… åˆ›å»ºæˆåŠŸï¼
```

### 3.5 èµ„æºæ¯”ä¾‹é™åˆ¶


**ä»€ä¹ˆæ˜¯èµ„æºæ¯”ä¾‹é™åˆ¶**ï¼š
æ§åˆ¶requestså’Œlimitsä¹‹é—´çš„æ¯”ä¾‹å…³ç³»ï¼Œç¡®ä¿èµ„æºé…ç½®åˆç†ã€‚

```yaml
# èµ„æºæ¯”ä¾‹é™åˆ¶ç¤ºä¾‹  
apiVersion: v1
kind: LimitRange
metadata:
  name: ratio-limit-range
  namespace: development  
spec:
  limits:
  - type: Container
    maxLimitRequestRatio:
      cpu: "2"          # limits.cpuä¸èƒ½è¶…è¿‡requests.cpuçš„2å€
      memory: "3"       # limits.memoryä¸èƒ½è¶…è¿‡requests.memoryçš„3å€
```

**æ¯”ä¾‹é™åˆ¶çš„å®é™…æ„ä¹‰**ï¼š
```
ä¸ºä»€ä¹ˆéœ€è¦æ¯”ä¾‹é™åˆ¶ï¼Ÿ

åˆç†é…ç½®ç¤ºä¾‹ï¼š
resources:
  requests:
    cpu: "500m"         # è¯·æ±‚0.5æ ¸
    memory: "1Gi"       # è¯·æ±‚1G
  limits:  
    cpu: "1000m"        # é™åˆ¶1æ ¸ (æ¯”ä¾‹2:1) âœ…
    memory: "2Gi"       # é™åˆ¶2G (æ¯”ä¾‹2:1) âœ…

ä¸åˆç†é…ç½®ç¤ºä¾‹ï¼š
resources:
  requests:
    cpu: "100m"         # è¯·æ±‚0.1æ ¸
    memory: "256Mi"     # è¯·æ±‚256M
  limits:
    cpu: "2000m"        # é™åˆ¶2æ ¸ (æ¯”ä¾‹20:1) âŒ
    memory: "8Gi"       # é™åˆ¶8G (æ¯”ä¾‹32:1) âŒ

é—®é¢˜åˆ†æï¼š
âŒ æ¯”ä¾‹è¿‡å¤§å¯¼è‡´èµ„æºè¶…é¢é¢„è®¢
âŒ å½±å“é›†ç¾¤æ•´ä½“èµ„æºåˆ©ç”¨ç‡
âŒ å¯èƒ½å¯¼è‡´èŠ‚ç‚¹èµ„æºä¸è¶³
```

---

## 4. ğŸ¢ å¤šç§Ÿæˆ·èµ„æºéš”ç¦»å®è·µ


### 4.1 å¤šç§Ÿæˆ·åœºæ™¯ç†è§£


**ä»€ä¹ˆæ˜¯å¤šç§Ÿæˆ·**ï¼š
å°±åƒä¸€æ ‹åŠå…¬æ¥¼é‡Œæœ‰å¤šä¸ªå…¬å¸ï¼Œæ¯ä¸ªå…¬å¸éœ€è¦ç‹¬ç«‹çš„åŠå…¬ç©ºé—´ï¼Œäº’ä¸å¹²æ‰°ã€‚

```
å¤šç§Ÿæˆ·Kubernetesé›†ç¾¤ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                K8sé›†ç¾¤                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ç§Ÿæˆ·A      â”‚ â”‚  ç§Ÿæˆ·B      â”‚ â”‚  ç§Ÿæˆ·C      â”‚ â”‚
â”‚  â”‚(å¼€å‘å›¢é˜Ÿ)   â”‚ â”‚(æµ‹è¯•å›¢é˜Ÿ)   â”‚ â”‚(è¿è¥å›¢é˜Ÿ)   â”‚ â”‚
â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚
â”‚  â”‚namespace:   â”‚ â”‚namespace:   â”‚ â”‚namespace:   â”‚ â”‚
â”‚  â”‚- dev-team-a â”‚ â”‚- test-env   â”‚ â”‚- ops-prod   â”‚ â”‚
â”‚  â”‚- staging-a  â”‚ â”‚- qa-env     â”‚ â”‚- ops-monitorâ”‚ â”‚
â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚
â”‚  â”‚èµ„æºé…é¢:    â”‚ â”‚èµ„æºé…é¢:    â”‚ â”‚èµ„æºé…é¢:    â”‚ â”‚
â”‚  â”‚CPU: 8æ ¸     â”‚ â”‚CPU: 4æ ¸     â”‚ â”‚CPU: 16æ ¸    â”‚ â”‚
â”‚  â”‚å†…å­˜: 16G    â”‚ â”‚å†…å­˜: 8G     â”‚ â”‚å†…å­˜: 32G    â”‚ â”‚
â”‚  â”‚å­˜å‚¨: 100G   â”‚ â”‚å­˜å‚¨: 50G    â”‚ â”‚å­˜å‚¨: 500G   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ç§Ÿæˆ·èµ„æºé…é¢è®¾è®¡


**ç§Ÿæˆ·çº§é…é¢è®¾è®¡åŸåˆ™**ï¼š
```
èµ„æºé…é¢è®¾è®¡è€ƒè™‘å› ç´ ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç§Ÿæˆ·ç±»å‹       â”‚ ä¼˜å…ˆçº§      â”‚ èµ„æºåˆ†é…ç­–ç•¥    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç”Ÿäº§ç¯å¢ƒ       â”‚ æœ€é«˜ ğŸ”´     â”‚ ä¿è¯å‹èµ„æºé…é¢  â”‚
â”‚ é¢„å‘å¸ƒç¯å¢ƒ     â”‚ é«˜ ğŸŸ        â”‚ å¼¹æ€§èµ„æºé…é¢    â”‚
â”‚ æµ‹è¯•ç¯å¢ƒ       â”‚ ä¸­ ğŸŸ¡       â”‚ å…±äº«èµ„æºé…é¢    â”‚  
â”‚ å¼€å‘ç¯å¢ƒ       â”‚ ä½ ğŸŸ¢       â”‚ å°½åŠ›è€Œä¸ºé…é¢    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç”Ÿäº§ç¯å¢ƒç§Ÿæˆ·é…é¢ç¤ºä¾‹**ï¼š
```yaml
# ç”Ÿäº§ç¯å¢ƒç§Ÿæˆ·Aé…é¢
apiVersion: v1
kind: ResourceQuota
metadata:
  name: prod-tenant-a
  namespace: prod-tenant-a
spec:
  hard:
    # è®¡ç®—èµ„æº - ä¿è¯å‹é…é¢
    requests.cpu: "16"       # ä¿è¯16æ ¸CPU
    limits.cpu: "32"         # æœ€å¤š32æ ¸CPU
    requests.memory: "32Gi"  # ä¿è¯32Gå†…å­˜
    limits.memory: "64Gi"    # æœ€å¤š64Gå†…å­˜
    
    # å­˜å‚¨èµ„æº
    requests.storage: "1Ti"  # 1TBå­˜å‚¨ç©ºé—´
    persistentvolumeclaims: "20" # æœ€å¤š20ä¸ªPVC
    
    # å¯¹è±¡æ•°é‡ - è¾ƒé«˜é™åˆ¶
    pods: "100"              # æœ€å¤š100ä¸ªPod
    services: "20"           # æœ€å¤š20ä¸ªæœåŠ¡
    secrets: "50"            # æœ€å¤š50ä¸ªå¯†é’¥
    configmaps: "50"         # æœ€å¤š50ä¸ªé…ç½®
```

**å¼€å‘ç¯å¢ƒç§Ÿæˆ·é…é¢ç¤ºä¾‹**ï¼š
```yaml
# å¼€å‘ç¯å¢ƒç§Ÿæˆ·é…é¢  
apiVersion: v1
kind: ResourceQuota
metadata:
  name: dev-tenant-quota
  namespace: dev-team-x
spec:
  hard:
    # è®¡ç®—èµ„æº - å°½åŠ›è€Œä¸ºé…é¢
    requests.cpu: "4"        # ä¿è¯4æ ¸CPU  
    limits.cpu: "8"          # æœ€å¤š8æ ¸CPU
    requests.memory: "8Gi"   # ä¿è¯8Gå†…å­˜
    limits.memory: "16Gi"    # æœ€å¤š16Gå†…å­˜
    
    # å­˜å‚¨èµ„æº - é€‚åº¦é™åˆ¶
    requests.storage: "100Gi" # 100Gå­˜å‚¨
    persistentvolumeclaims: "10" # æœ€å¤š10ä¸ªPVC
    
    # å¯¹è±¡æ•°é‡ - å¼€å‘éœ€è¦  
    pods: "30"               # æœ€å¤š30ä¸ªPod
    services: "15"           # æœ€å¤š15ä¸ªæœåŠ¡
```

### 4.3 ç§Ÿæˆ·é—´èµ„æºéš”ç¦»ç­–ç•¥


**ç½‘ç»œéš”ç¦» + èµ„æºéš”ç¦»**ï¼š
```yaml
# ç½‘ç»œç­–ç•¥ - ç§Ÿæˆ·ç½‘ç»œéš”ç¦»
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy  
metadata:
  name: tenant-isolation
  namespace: tenant-a
spec:
  podSelector: {}  # åº”ç”¨åˆ°å‘½åç©ºé—´æ‰€æœ‰Pod
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          tenant: "tenant-a"  # åªå…è®¸åŒç§Ÿæˆ·è®¿é—®
  egress:
  - to:
    - namespaceSelector:
        matchLabels:
          tenant: "tenant-a"
```

**èŠ‚ç‚¹äº²å’Œæ€§éš”ç¦»**ï¼š
```yaml
# ä¸ºé‡è¦ç§Ÿæˆ·é¢„ç•™ä¸“ç”¨èŠ‚ç‚¹
apiVersion: v1
kind: Node
metadata:
  name: prod-node-1
  labels:
    tenant: "prod-tenant-a"
    node-type: "dedicated"

---
# Podè°ƒåº¦åˆ°ä¸“ç”¨èŠ‚ç‚¹
apiVersion: apps/v1  
kind: Deployment
metadata:
  name: critical-app
  namespace: prod-tenant-a
spec:
  template:
    spec:
      nodeSelector:
        tenant: "prod-tenant-a"    # åªè°ƒåº¦åˆ°ç§Ÿæˆ·Açš„èŠ‚ç‚¹
      # æˆ–ä½¿ç”¨èŠ‚ç‚¹äº²å’Œæ€§
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: tenant
                operator: In
                values: ["prod-tenant-a"]
```

### 4.4 ç§Ÿæˆ·é…é¢ç›‘æ§å‘Šè­¦


**é…é¢ä½¿ç”¨ç›‘æ§è„šæœ¬**ï¼š
```bash
#!/bin/bash
# ç§Ÿæˆ·é…é¢ç›‘æ§è„šæœ¬

check_tenant_quota() {
    local namespace=$1
    local tenant_name=$2
    
    echo "=== ç§Ÿæˆ· $tenant_name é…é¢ä½¿ç”¨æƒ…å†µ ==="
    
    # æ£€æŸ¥CPUä½¿ç”¨ç‡
    cpu_used=$(kubectl top nodes --selector=tenant=$tenant_name --no-headers | awk '{sum+=$2} END {print sum}')
    cpu_quota=$(kubectl get quota -n $namespace -o jsonpath='{.items[0].spec.hard.requests\.cpu}')
    
    echo "CPUä½¿ç”¨: ${cpu_used}æ ¸ / ${cpu_quota}æ ¸"
    
    # æ£€æŸ¥å†…å­˜ä½¿ç”¨ç‡  
    memory_used=$(kubectl top nodes --selector=tenant=$tenant_name --no-headers | awk '{sum+=$4} END {print sum}')
    memory_quota=$(kubectl get quota -n $namespace -o jsonpath='{.items[0].spec.hard.requests\.memory}')
    
    echo "å†…å­˜ä½¿ç”¨: ${memory_used} / ${memory_quota}"
    
    # æ£€æŸ¥Podæ•°é‡
    pod_count=$(kubectl get pods -n $namespace --no-headers | wc -l)
    pod_quota=$(kubectl get quota -n $namespace -o jsonpath='{.items[0].spec.hard.pods}')
    
    echo "Podæ•°é‡: ${pod_count} / ${pod_quota}"
    
    # å‘Šè­¦é˜ˆå€¼æ£€æŸ¥
    if (( $(echo "$cpu_used / $cpu_quota * 100 > 80" | bc -l) )); then
        echo "âš ï¸  è­¦å‘Š: CPUä½¿ç”¨ç‡è¶…è¿‡80%"
    fi
}

# æ£€æŸ¥æ‰€æœ‰ç§Ÿæˆ·
check_tenant_quota "prod-tenant-a" "prod-tenant-a"  
check_tenant_quota "dev-team-x" "dev-team-x"
```

---

## 5. ğŸ“ˆ èµ„æºé…é¢ç›‘æ§ä¸è°ƒä¼˜


### 5.1 é…é¢ä½¿ç”¨æƒ…å†µç›‘æ§


**æŸ¥çœ‹é…é¢ä½¿ç”¨çŠ¶æ€**ï¼š
```bash
# æŸ¥çœ‹å‘½åç©ºé—´é…é¢è¯¦æƒ…
kubectl describe quota -n development

# è¾“å‡ºç¤ºä¾‹ï¼š
Name:            dev-quota
Namespace:       development  
Resource         Used   Hard
--------         ----   ----
limits.cpu       6      8      # å·²ä½¿ç”¨6æ ¸ï¼Œé™åˆ¶8æ ¸
limits.memory    12Gi   16Gi   # å·²ä½¿ç”¨12Gï¼Œé™åˆ¶16G
pods             15     20     # å·²åˆ›å»º15ä¸ªPodï¼Œé™åˆ¶20ä¸ª
requests.cpu     3      4      # å·²è¯·æ±‚3æ ¸ï¼Œé™åˆ¶4æ ¸
requests.memory  6Gi    8Gi    # å·²è¯·æ±‚6Gï¼Œé™åˆ¶8G

# æŸ¥çœ‹æ‰€æœ‰å‘½åç©ºé—´é…é¢
kubectl get quota --all-namespaces

# ä»¥JSONæ ¼å¼è¾“å‡ºè¯¦ç»†ä¿¡æ¯
kubectl get quota dev-quota -n development -o json
```

**é…é¢ä½¿ç”¨ç‡è®¡ç®—**ï¼š
```bash
# è®¡ç®—é…é¢ä½¿ç”¨ç‡çš„è„šæœ¬
#!/bin/bash

namespace="development"
quota_name="dev-quota"

# è·å–CPUä½¿ç”¨ç‡
cpu_used=$(kubectl get quota $quota_name -n $namespace -o jsonpath='{.status.used.requests\.cpu}')
cpu_hard=$(kubectl get quota $quota_name -n $namespace -o jsonpath='{.status.hard.requests\.cpu}')
cpu_percent=$(echo "scale=1; $cpu_used * 100 / $cpu_hard" | bc)

echo "CPUä½¿ç”¨ç‡: $cpu_percent% ($cpu_used/$cpu_hard)"

# è·å–å†…å­˜ä½¿ç”¨ç‡
memory_used=$(kubectl get quota $quota_name -n $namespace -o jsonpath='{.status.used.requests\.memory}')
memory_hard=$(kubectl get quota $quota_name -n $namespace -o jsonpath='{.status.hard.requests\.memory}')  

echo "å†…å­˜ä½¿ç”¨: $memory_used / $memory_hard"
```

### 5.2 é…é¢è°ƒä¼˜ç­–ç•¥


**é…é¢è°ƒä¼˜çš„æ€è·¯**ï¼š
```
é…é¢è°ƒä¼˜å†³ç­–æ ‘ï¼š
æ˜¯å¦ç»å¸¸é‡åˆ°é…é¢ä¸è¶³ï¼Ÿ
â”œâ”€ æ˜¯ â†’ æ£€æŸ¥æ˜¯å¦èµ„æºä½¿ç”¨ä¸åˆç†
â”‚       â”œâ”€ åº”ç”¨èµ„æºè®¾ç½®è¿‡é«˜ â†’ ä¼˜åŒ–åº”ç”¨é…ç½®
â”‚       â””â”€ ç¡®å®éœ€è¦æ›´å¤šèµ„æº â†’ è°ƒæ•´é…é¢ä¸Šé™
â””â”€ å¦ â†’ æ£€æŸ¥èµ„æºåˆ©ç”¨ç‡
        â”œâ”€ åˆ©ç”¨ç‡è¿‡ä½(<50%) â†’ è€ƒè™‘é™ä½é…é¢
        â””â”€ åˆ©ç”¨ç‡åˆç†(50-80%) â†’ ä¿æŒå½“å‰é…é¢
```

**å¸¸è§é…é¢è°ƒä¼˜åœºæ™¯**ï¼š

**åœºæ™¯1ï¼šå¼€å‘ç¯å¢ƒèµ„æºä¸è¶³**
```yaml
# é—®é¢˜ï¼šå¼€å‘å›¢é˜Ÿåé¦ˆPodæ— æ³•åˆ›å»º
# åŸå› ï¼šCPU requestsé…é¢ä¸è¶³

# å½“å‰é…é¢
hard:
  requests.cpu: "4"
  requests.memory: "8Gi"

# å®é™…éœ€æ±‚åˆ†æï¼š
# 10ä¸ªå¾®æœåŠ¡ Ã— æ¯ä¸ª0.5æ ¸ = 5æ ¸CPUéœ€æ±‚

# è°ƒä¼˜åé…é¢
hard:
  requests.cpu: "6"      # å¢åŠ åˆ°6æ ¸ï¼Œç•™1æ ¸ä½™é‡
  requests.memory: "12Gi" # å¯¹åº”å¢åŠ å†…å­˜é…é¢
```

**åœºæ™¯2ï¼šèµ„æºåˆ©ç”¨ç‡è¿‡ä½**
```yaml
# é—®é¢˜ï¼šæµ‹è¯•ç¯å¢ƒèµ„æºå¤§é‡ç©ºé—²
# åˆ†æï¼šé…é¢16æ ¸ï¼Œå®é™…åªä½¿ç”¨4æ ¸

# ä¼˜åŒ–å‰
hard:
  requests.cpu: "16"
  limits.cpu: "32"

# ä¼˜åŒ–å  
hard:
  requests.cpu: "8"      # å‡å°‘åˆ°8æ ¸  
  limits.cpu: "16"       # å¯¹åº”è°ƒæ•´limits
```

### 5.3 åŠ¨æ€é…é¢è°ƒæ•´ç­–ç•¥


**åŸºäºæ—¶é—´çš„åŠ¨æ€é…é¢**ï¼š
```bash
#!/bin/bash
# å·¥ä½œæ—¶é—´vséå·¥ä½œæ—¶é—´é…é¢åŠ¨æ€è°ƒæ•´

current_hour=$(date +%H)

if [ $current_hour -ge 9 ] && [ $current_hour -le 18 ]; then
    # å·¥ä½œæ—¶é—´ - å¢åŠ å¼€å‘ç¯å¢ƒé…é¢
    kubectl patch quota dev-quota -n development --type merge -p '{
        "spec": {
            "hard": {
                "requests.cpu": "8",
                "requests.memory": "16Gi"
            }
        }
    }'
    echo "å·²åˆ‡æ¢åˆ°å·¥ä½œæ—¶é—´é…é¢"
else
    # éå·¥ä½œæ—¶é—´ - å‡å°‘å¼€å‘ç¯å¢ƒé…é¢  
    kubectl patch quota dev-quota -n development --type merge -p '{
        "spec": {
            "hard": {
                "requests.cpu": "4", 
                "requests.memory": "8Gi"
            }
        }
    }'
    echo "å·²åˆ‡æ¢åˆ°éå·¥ä½œæ—¶é—´é…é¢"
fi
```

**åŸºäºè´Ÿè½½çš„åŠ¨æ€é…é¢**ï¼š
```yaml
# ä½¿ç”¨HPA + VPAç»“åˆé…é¢åŠ¨æ€è°ƒæ•´
apiVersion: v1
kind: ConfigMap
metadata:
  name: quota-adjustment-config
data:
  adjustment-policy: |
    # é…é¢è°ƒæ•´ç­–ç•¥
    rules:
      - condition: "cpu_utilization > 80%"
        action: "increase_quota_by_25%"
        cooldown: "10m"
      - condition: "cpu_utilization < 30%"  
        action: "decrease_quota_by_15%"
        cooldown: "30m"
        min_quota: "2"  # æœ€å°é…é¢ä¿æŠ¤
```

### 5.4 é…é¢å‘Šè­¦ä¸é€šçŸ¥


**Prometheusé…é¢ç›‘æ§è§„åˆ™**ï¼š
```yaml
# prometheuså‘Šè­¦è§„åˆ™
groups:
- name: quota-alerts
  rules:
  - alert: QuotaUsageHigh
    expr: |
      (
        kube_resourcequota{resource="requests.cpu", type="used"} / 
        kube_resourcequota{resource="requests.cpu", type="hard"}
      ) * 100 > 80
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "é…é¢ä½¿ç”¨ç‡è¿‡é«˜"
      description: "å‘½åç©ºé—´{{ $labels.namespace }}çš„CPUé…é¢ä½¿ç”¨ç‡å·²è¾¾{{ $value }}%"
      
  - alert: QuotaExhausted
    expr: |
      (
        kube_resourcequota{resource="requests.cpu", type="used"} / 
        kube_resourcequota{resource="requests.cpu", type="hard"}  
      ) * 100 >= 95
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "é…é¢å³å°†è€—å°½" 
      description: "å‘½åç©ºé—´{{ $labels.namespace }}çš„CPUé…é¢ä½¿ç”¨ç‡å·²è¾¾{{ $value }}%ï¼Œè¯·ç«‹å³æ£€æŸ¥"
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ èµ„æºé…é¢ç®¡ç†åŒæ ¸å¿ƒï¼šResourceQuotaæ§åˆ¶æ€»é‡ï¼ŒLimitRangeæ§åˆ¶å•ä½“
ğŸ”¸ é…é¢å±‚æ¬¡ç†è§£ï¼šå‘½åç©ºé—´çº§æ€»é‡æ§åˆ¶ â†’ Podçº§å•ä½“æ§åˆ¶ â†’ å®¹å™¨çº§ç»†èŠ‚æ§åˆ¶  
ğŸ”¸ èµ„æºç±»å‹å…¨è¦†ç›–ï¼šè®¡ç®—èµ„æº(CPU/å†…å­˜) + å­˜å‚¨èµ„æº + å¯¹è±¡æ•°é‡
ğŸ”¸ å¤šç§Ÿæˆ·éš”ç¦»ç­–ç•¥ï¼šå‘½åç©ºé—´éš”ç¦» + ç½‘ç»œéš”ç¦» + èŠ‚ç‚¹äº²å’Œæ€§
ğŸ”¸ åŠ¨æ€è°ƒä¼˜æ€è·¯ï¼šç›‘æ§ä½¿ç”¨ç‡ â†’ åˆ†æç“¶é¢ˆ â†’ è°ƒæ•´é…é¢ â†’ æŒç»­ä¼˜åŒ–
```

### 6.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ requests vs limitsçš„æœ¬è´¨åŒºåˆ«**
```
é€šä¿—ç†è§£ï¼š
requests = æœ€ä½ä¿è¯ = "æˆ‘è‡³å°‘éœ€è¦è¿™äº›èµ„æºæ‰èƒ½æ­£å¸¸å·¥ä½œ"
limits = æœ€é«˜é™åˆ¶ = "æˆ‘æœ€å¤šåªèƒ½ä½¿ç”¨è¿™äº›èµ„æºï¼Œä¸èƒ½å†å¤šäº†"

å®é™…å½±å“ï¼š
- requestså½±å“Podè°ƒåº¦ï¼šèŠ‚ç‚¹èµ„æºä¸è¶³æ—¶æ— æ³•è°ƒåº¦
- limitså½±å“Podè¿è¡Œï¼šè¶…å‡ºlimitsæ—¶å®¹å™¨ä¼šè¢«ç»ˆæ­¢æˆ–é™æµ
```

**ğŸ”¹ é…é¢è®¾è®¡çš„å¹³è¡¡è‰ºæœ¯**
```
é…é¢è®¾ç½®å¹³è¡¡ï¼š
è¿‡ç´§ â†’ å½±å“ä¸šåŠ¡æ­£å¸¸è¿è¡Œï¼Œé¢‘ç¹é‡åˆ°èµ„æºä¸è¶³  
è¿‡æ¾ â†’ èµ„æºæµªè´¹ï¼Œæˆæœ¬å¢åŠ ï¼Œæ— æ³•æœ‰æ•ˆéš”ç¦»

æœ€ä½³å®è·µï¼š
âœ… åŸºäºå†å²æ•°æ®è®¾å®šåŸºå‡†é…é¢
âœ… é¢„ç•™20-30%çš„ç¼“å†²ç©ºé—´
âœ… å®šæœŸå®¡æŸ¥å’Œè°ƒæ•´é…é¢è®¾ç½®
âœ… å»ºç«‹ç›‘æ§å‘Šè­¦æœºåˆ¶
```

**ğŸ”¹ å¤šç§Ÿæˆ·éš”ç¦»çš„å±‚æ¬¡åŒ–è®¾è®¡**
```
éš”ç¦»å±‚æ¬¡ï¼š
ç‰©ç†éš”ç¦» > è™šæ‹Ÿéš”ç¦» > é€»è¾‘éš”ç¦»

Kuberneteså¤šç§Ÿæˆ·éš”ç¦»ï¼š
1. å‘½åç©ºé—´éš”ç¦»ï¼ˆé€»è¾‘éš”ç¦»ï¼‰
2. ç½‘ç»œç­–ç•¥éš”ç¦»ï¼ˆç½‘ç»œéš”ç¦»ï¼‰ 
3. èŠ‚ç‚¹äº²å’Œæ€§ï¼ˆç‰©ç†/è™šæ‹Ÿéš”ç¦»ï¼‰
4. èµ„æºé…é¢ï¼ˆèµ„æºéš”ç¦»ï¼‰

é€‰æ‹©åŸåˆ™ï¼šæ ¹æ®å®‰å…¨è¦æ±‚å’Œæˆæœ¬é¢„ç®—é€‰æ‹©åˆé€‚çš„éš”ç¦»çº§åˆ«
```

### 6.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ“Š æˆæœ¬æ§åˆ¶ä»·å€¼**ï¼š
- **äº‘èµ„æºæˆæœ¬æ§åˆ¶**ï¼šé€šè¿‡é…é¢é™åˆ¶é˜²æ­¢èµ„æºè¶…é¢ä½¿ç”¨
- **å¤šé¡¹ç›®æˆæœ¬åˆ†æ‘Š**ï¼šåŸºäºå‘½åç©ºé—´çš„èµ„æºä½¿ç”¨é‡è¿›è¡Œæˆæœ¬æ ¸ç®—
- **é¢„ç®—ç®¡ç†**ï¼šè®¾å®šèµ„æºé…é¢ç›¸å½“äºè®¾å®šèµ„æºé¢„ç®—ä¸Šé™

**ğŸ”’ å®‰å…¨éš”ç¦»ä»·å€¼**ï¼š
- **ç§Ÿæˆ·å®‰å…¨éš”ç¦»**ï¼šé˜²æ­¢ä¸åŒç§Ÿæˆ·é—´çš„èµ„æºç«äº‰å’Œè®¿é—®
- **ç¯å¢ƒå®‰å…¨éš”ç¦»**ï¼šç¡®ä¿å¼€å‘ç¯å¢ƒé—®é¢˜ä¸å½±å“ç”Ÿäº§ç¯å¢ƒ
- **æ•…éšœå½±å“éš”ç¦»**ï¼šå•ä¸ªåº”ç”¨çš„èµ„æºé—®é¢˜ä¸å½±å“å…¶ä»–åº”ç”¨

**âš™ï¸ è¿ç»´ç®¡ç†ä»·å€¼**ï¼š
- **èµ„æºè§„åˆ’ä¾æ®**ï¼šåŸºäºé…é¢ä½¿ç”¨æƒ…å†µè¿›è¡Œå®¹é‡è§„åˆ’  
- **é—®é¢˜è¯Šæ–­å·¥å…·**ï¼šé…é¢é™åˆ¶å¸®åŠ©å¿«é€Ÿå®šä½èµ„æºç“¶é¢ˆ
- **SLAä¿è¯æ‰‹æ®µ**ï¼šé€šè¿‡èµ„æºä¿è¯ç¡®ä¿å…³é”®åº”ç”¨çš„æœåŠ¡æ°´å¹³

### 6.4 æœ€ä½³å®è·µæ€»ç»“


**ğŸ¯ é…é¢è®¾è®¡æœ€ä½³å®è·µ**ï¼š
```
1. åˆ†å±‚è®¾è®¡é…é¢ç­–ç•¥
   å‘½åç©ºé—´æ€»é…é¢ â†’ Podçº§é…é¢ â†’ å®¹å™¨çº§é…é¢

2. å·®å¼‚åŒ–é…é¢ç®¡ç†  
   ç”Ÿäº§ç¯å¢ƒ: ä¿è¯å‹é…é¢ï¼Œèµ„æºå……è¶³
   æµ‹è¯•ç¯å¢ƒ: å¼¹æ€§é…é¢ï¼Œèµ„æºå…±äº«
   å¼€å‘ç¯å¢ƒ: å°½åŠ›è€Œä¸ºï¼Œæˆæœ¬ä¼˜å…ˆ

3. å»ºç«‹é…é¢ç›‘æ§ä½“ç³»
   å®æ—¶ç›‘æ§ + é˜ˆå€¼å‘Šè­¦ + å®šæœŸå®¡æŸ¥

4. å®æ–½åŠ¨æ€è°ƒæ•´æœºåˆ¶
   åŸºäºä½¿ç”¨æ¨¡å¼åŠ¨æ€è°ƒæ•´é…é¢
   å·¥ä½œæ—¶é—´vséå·¥ä½œæ—¶é—´å·®å¼‚åŒ–é…é¢
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- é…é¢ç®¡ç†åˆ†ä¸¤å±‚ï¼Œæ€»é‡å•ä½“è¦åˆ†æ¸…
- è®¡ç®—å­˜å‚¨åŠ å¯¹è±¡ï¼Œä¸‰ç±»èµ„æºå…¨è¦†ç›–  
- å¤šç§Ÿæˆ·æ¥è¦éš”ç¦»ï¼Œå‘½åç©ºé—´æ˜¯åŸºç¡€
- ç›‘æ§è°ƒä¼˜ä¸å¯å°‘ï¼ŒåŠ¨æ€å¹³è¡¡æ˜¯å…³é”®