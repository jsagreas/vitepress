---
title: 2ã€Protocol-Buffersè¯­æ³•å…¥é—¨
---
## ğŸ“š ç›®å½•

1. [Protocol Buffersæ˜¯ä»€ä¹ˆ](#1-Protocol-Buffersæ˜¯ä»€ä¹ˆ)
2. [protoæ–‡ä»¶çš„åŸºæœ¬ç»“æ„](#2-protoæ–‡ä»¶çš„åŸºæœ¬ç»“æ„)
3. [æ¶ˆæ¯å®šä¹‰åŸºç¡€](#3-æ¶ˆæ¯å®šä¹‰åŸºç¡€)
4. [æ•°æ®ç±»å‹è¯¦è§£](#4-æ•°æ®ç±»å‹è¯¦è§£)
5. [å­—æ®µä¿®é¥°ç¬¦è§£æ](#5-å­—æ®µä¿®é¥°ç¬¦è§£æ)
6. [å¤åˆç±»å‹ä½¿ç”¨](#6-å¤åˆç±»å‹ä½¿ç”¨)
7. [å­—æ®µç¼–å·è§„åˆ™](#7-å­—æ®µç¼–å·è§„åˆ™)
8. [åŒ…ç®¡ç†ä¸å¯¼å…¥](#8-åŒ…ç®¡ç†ä¸å¯¼å…¥)
9. [ç¼–è¯‘å™¨ä½¿ç”¨](#9-ç¼–è¯‘å™¨ä½¿ç”¨)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¤” Protocol Buffersæ˜¯ä»€ä¹ˆ


### 1.1 é€šä¿—ç†è§£

**æƒ³è±¡ä¸€ä¸‹**ï¼šä½ è¦ç»™æœ‹å‹å‘æ¶ˆæ¯ï¼Œä½†ä½ ä»¬è¯´ä¸åŒçš„è¯­è¨€ã€‚Protocol Buffersï¼ˆç®€ç§°protobufï¼‰å°±åƒæ˜¯ä¸€ä¸ª**é€šç”¨ç¿»è¯‘å™¨**ï¼Œè®©ä¸åŒçš„ç¨‹åºèƒ½å¤Ÿäº’ç›¸ç†è§£å¯¹æ–¹å‘é€çš„æ•°æ®ã€‚

```
æ™®é€šæƒ…å†µä¸‹ï¼š
ç¨‹åºA(Java) â†â†’ ??? â†â†’ ç¨‹åºB(Python)
            çœ‹ä¸æ‡‚å¯¹æ–¹çš„æ•°æ®

ä½¿ç”¨Protocol Buffersåï¼š
ç¨‹åºA(Java) â†â†’ protobuf â†â†’ ç¨‹åºB(Python)
            é€šè¿‡ç»Ÿä¸€æ ¼å¼äº¤æµ
```

### 1.2 æ ¸å¿ƒä½œç”¨

- **ğŸ”„ æ•°æ®åºåˆ—åŒ–**ï¼šæŠŠå†…å­˜ä¸­çš„å¯¹è±¡å˜æˆå¯ä¼ è¾“çš„å­—èŠ‚æµ
- **ğŸ“¡ è·¨è¯­è¨€é€šä¿¡**ï¼šJavaå†™çš„ç¨‹åºèƒ½å’ŒPythonå†™çš„ç¨‹åºå¯¹è¯
- **ğŸ—œï¸ é«˜æ•ˆå­˜å‚¨**ï¼šæ¯”JSONã€XMLæ›´çœç©ºé—´ï¼Œä¼ è¾“æ›´å¿«
- **ğŸ“‹ ç»“æ„åŒ–å®šä¹‰**ï¼šæå‰çº¦å®šå¥½æ•°æ®çš„æ ¼å¼ï¼Œé¿å…æ··ä¹±

> **ğŸ’¡ ç®€å•ç±»æ¯”**ï¼šå°±åƒåˆ¶å®šä¸€ä¸ª"æ•°æ®æ ¼å¼æ ‡å‡†"ï¼Œå¤§å®¶éƒ½æŒ‰è¿™ä¸ªæ ‡å‡†æ¥æ‰“åŒ…å’Œè§£åŒ…æ•°æ®ï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºç°"é¸¡åŒé¸­è®²"çš„æƒ…å†µã€‚

---

## 2. ğŸ“„ protoæ–‡ä»¶çš„åŸºæœ¬ç»“æ„


### 2.1 æ–‡ä»¶ç»“æ„æ¦‚è§ˆ

ä¸€ä¸ª`.proto`æ–‡ä»¶å°±åƒæ˜¯ä¸€ä»½**æ•°æ®æ ¼å¼è¯´æ˜ä¹¦**ï¼Œå‘Šè¯‰ç¨‹åº"æ•°æ®åº”è¯¥é•¿ä»€ä¹ˆæ ·"ã€‚

```protobuf
// HelloService.proto - å®Œæ•´ç¤ºä¾‹

// 1. è¯­æ³•ç‰ˆæœ¬å£°æ˜
syntax = "proto3";

// 2. åŒ…åå®šä¹‰
package hello.service;

// 3. å¯¼å…¥å…¶ä»–protoæ–‡ä»¶
import "google/protobuf/timestamp.proto";

// 4. ç”Ÿæˆé€‰é¡¹è®¾ç½®
option java_package = "com.example.hello";
option java_outer_classname = "HelloProto";

// 5. æ¶ˆæ¯å®šä¹‰
message HelloRequest {
    string name = 1;
    int32 age = 2;
}

message HelloResponse {
    string message = 1;
    google.protobuf.Timestamp timestamp = 2;
}

// 6. æœåŠ¡å®šä¹‰
service HelloService {
    rpc SayHello(HelloRequest) returns (HelloResponse);
}
```

### 2.2 å„éƒ¨åˆ†è¯¦è§£


**ğŸ”¸ syntax - è¯­æ³•ç‰ˆæœ¬**
```protobuf
syntax = "proto3";  // ä½¿ç”¨proto3è¯­æ³•ï¼ˆæ¨èï¼‰
```
- **proto2 vs proto3**ï¼šproto3æ›´ç®€æ´ï¼Œå»æ‰äº†ä¸€äº›å¤æ‚ç‰¹æ€§
- **å¿…é¡»å†™åœ¨æ–‡ä»¶ç¬¬ä¸€è¡Œ**ï¼šå‘Šè¯‰ç¼–è¯‘å™¨ç”¨å“ªä¸ªç‰ˆæœ¬è§£æ

**ğŸ”¸ package - åŒ…å**
```protobuf
package hello.service;  // ç±»ä¼¼Javaçš„åŒ…åï¼Œé¿å…å‘½åå†²çª
```

**ğŸ”¸ import - å¯¼å…¥**
```protobuf
import "google/protobuf/timestamp.proto";  // å¯¼å…¥æ—¶é—´æˆ³ç±»å‹
```

**ğŸ”¸ option - ç¼–è¯‘é€‰é¡¹**
```protobuf
option java_package = "com.example.hello";      // JavaåŒ…å
option java_outer_classname = "HelloProto";     // Javaç±»å
```

---

## 3. ğŸ“ æ¶ˆæ¯å®šä¹‰åŸºç¡€


### 3.1 ä»€ä¹ˆæ˜¯message

**messageå°±æ˜¯æ•°æ®ç»“æ„çš„å®šä¹‰**ï¼Œå‘Šè¯‰ç¨‹åº"è¿™ä¸ªæ•°æ®åŒ…é‡Œæœ‰ä»€ä¹ˆä¸œè¥¿"ã€‚

```protobuf
// å®šä¹‰ä¸€ä¸ªç”¨æˆ·ä¿¡æ¯çš„æ•°æ®ç»“æ„
message UserInfo {
    string name = 1;        // å§“åï¼Œå­—æ®µç¼–å·æ˜¯1
    int32 age = 2;         // å¹´é¾„ï¼Œå­—æ®µç¼–å·æ˜¯2
    string email = 3;      // é‚®ç®±ï¼Œå­—æ®µç¼–å·æ˜¯3
}
```

### 3.2 æ¶ˆæ¯å®šä¹‰è§„åˆ™


**ğŸ¯ åŸºæœ¬æ ¼å¼**
```
ç±»å‹ å­—æ®µå = å­—æ®µç¼–å·;
```

**ğŸ“‹ å®é™…ç¤ºä¾‹**
```protobuf
message BookInfo {
    string title = 1;           // ä¹¦å
    string author = 2;          // ä½œè€…
    int32 pages = 3;           // é¡µæ•°
    double price = 4;          // ä»·æ ¼
    bool is_available = 5;     // æ˜¯å¦å¯å€Ÿ
}
```

> **ğŸ’¡ ç†è§£è¦ç‚¹**ï¼šæ¯ä¸ªå­—æ®µéƒ½æœ‰**ç±»å‹**ã€**åç§°**ã€**ç¼–å·**ä¸‰è¦ç´ ï¼Œç¼ºä¸€ä¸å¯ã€‚

### 3.3 å­—æ®µå‘½åå»ºè®®

```protobuf
// âœ… æ¨èï¼šä¸‹åˆ’çº¿å‘½å
message GoodExample {
    string user_name = 1;      // ç”¨æˆ·å
    int32 user_age = 2;        // ç”¨æˆ·å¹´é¾„
    string phone_number = 3;   // ç”µè¯å·ç 
}

// âŒ ä¸æ¨èï¼šé©¼å³°å‘½ååœ¨protoä¸­ä¸å¸¸ç”¨
message BadExample {
    string userName = 1;
    int32 userAge = 2;
}
```

---

## 4. ğŸ¯ æ•°æ®ç±»å‹è¯¦è§£


### 4.1 åŸºç¡€æ•°æ®ç±»å‹å¯¹ç…§è¡¨


| **protobufç±»å‹** | **å«ä¹‰** | **å¯¹åº”Javaç±»å‹** | **ä½¿ç”¨åœºæ™¯** |
|-----------------|---------|----------------|-------------|
| `int32` | 32ä½æ•´æ•° | `int` | å¹´é¾„ã€æ•°é‡ã€ID |
| `int64` | 64ä½æ•´æ•° | `long` | æ—¶é—´æˆ³ã€å¤§æ•°å€¼ |
| `string` | æ–‡æœ¬å­—ç¬¦ä¸² | `String` | å§“åã€æè¿°ã€URL |
| `bool` | å¸ƒå°”å€¼ | `boolean` | å¼€å…³çŠ¶æ€ã€æ ‡å¿—ä½ |
| `bytes` | å­—èŠ‚æ•°ç»„ | `byte[]` | æ–‡ä»¶å†…å®¹ã€å›¾ç‰‡ |
| `float` | å•ç²¾åº¦æµ®ç‚¹ | `float` | ç®€å•å°æ•° |
| `double` | åŒç²¾åº¦æµ®ç‚¹ | `double` | ç²¾ç¡®å°æ•°ã€ä»·æ ¼ |

### 4.2 å®é™…ä½¿ç”¨ç¤ºä¾‹

```protobuf
message StudentInfo {
    // åŸºæœ¬ä¿¡æ¯
    string name = 1;           // å§“åï¼š"å¼ ä¸‰"
    int32 age = 2;            // å¹´é¾„ï¼š18
    int64 student_id = 3;     // å­¦å·ï¼š2023001001
    
    // çŠ¶æ€ä¿¡æ¯
    bool is_active = 4;       // æ˜¯å¦åœ¨æ ¡ï¼štrue
    double gpa = 5;           // ç»©ç‚¹ï¼š3.75
    
    // æ‰©å±•ä¿¡æ¯
    bytes profile_photo = 6;  // å¤´åƒæ•°æ®
    string description = 7;   // ä¸ªäººç®€ä»‹
}
```

### 4.3 ç±»å‹é€‰æ‹©å»ºè®®


**ğŸ”¸ æ•´æ•°ç±»å‹é€‰æ‹©**
```protobuf
message NumberExamples {
    int32 small_number = 1;    // å°æ•°å€¼ï¼šå¹´é¾„ã€æ•°é‡(å»ºè®®<2äº¿)
    int64 big_number = 2;      // å¤§æ•°å€¼ï¼šæ—¶é—´æˆ³ã€ID
    int32 negative_ok = 3;     // å¯èƒ½ä¸ºè´Ÿæ•°çš„æƒ…å†µ
}
```

**ğŸ”¸ å­—ç¬¦ä¸² vs å­—èŠ‚**
```protobuf
message DataExamples {
    string text_content = 1;   // æ–‡æœ¬å†…å®¹ï¼šUTF-8ç¼–ç 
    bytes binary_data = 2;     // äºŒè¿›åˆ¶æ•°æ®ï¼šå›¾ç‰‡ã€æ–‡ä»¶
}
```

---

## 5. ğŸ·ï¸ å­—æ®µä¿®é¥°ç¬¦è§£æ


### 5.1 proto3ä¸­çš„å­—æ®µè§„åˆ™

**é‡è¦å˜åŒ–**ï¼šproto3ç®€åŒ–äº†å­—æ®µä¿®é¥°ç¬¦ï¼Œåªä¿ç•™äº†æœ€å®ç”¨çš„ã€‚

```protobuf
message UserProfile {
    // proto3ä¸­æ‰€æœ‰å­—æ®µé»˜è®¤éƒ½æ˜¯optionalçš„
    string name = 1;              // å•ä¸ªå€¼
    repeated string hobbies = 2;  // æ•°ç»„/åˆ—è¡¨
}
```

### 5.2 repeated - è¡¨ç¤ºæ•°ç»„

**repeatedå°±æ˜¯"å¯ä»¥æœ‰å¤šä¸ª"çš„æ„æ€**ï¼Œç›¸å½“äºæ•°ç»„æˆ–åˆ—è¡¨ã€‚

```protobuf
message ClassInfo {
    string class_name = 1;              // ç­çº§åç§°
    repeated string students = 2;        // å­¦ç”Ÿåˆ—è¡¨
    repeated int32 scores = 3;          // æˆç»©åˆ—è¡¨
    repeated BookInfo books = 4;        // å›¾ä¹¦åˆ—è¡¨(è‡ªå®šä¹‰ç±»å‹)
}
```

**ğŸ“Š å¯¹åº”å…³ç³»**
```
protobuf: repeated string students
Java:     List<String> students
Python:   List[str] students
Go:       []string students
```

### 5.3 å®é™…ä½¿ç”¨ç¤ºä¾‹

```protobuf
message ShoppingCart {
    string user_id = 1;                 // ç”¨æˆ·ID
    repeated CartItem items = 2;        // è´­ç‰©é¡¹åˆ—è¡¨
    double total_price = 3;             // æ€»ä»·
}

message CartItem {
    string product_id = 1;              // å•†å“ID
    string product_name = 2;            // å•†å“åç§°
    int32 quantity = 3;                 // æ•°é‡
    double unit_price = 4;              // å•ä»·
}
```

---

## 6. ğŸ”§ å¤åˆç±»å‹ä½¿ç”¨


### 6.1 æšä¸¾ç±»å‹(enum)

**æšä¸¾å°±æ˜¯"ä»å‡ ä¸ªå›ºå®šé€‰é¡¹ä¸­é€‰ä¸€ä¸ª"**ï¼Œæ¯”å¦‚æ€§åˆ«ã€çŠ¶æ€ç­‰ã€‚

```protobuf
// å®šä¹‰ç”¨æˆ·çŠ¶æ€æšä¸¾
enum UserStatus {
    UNKNOWN = 0;        // é»˜è®¤å€¼å¿…é¡»æ˜¯0
    ACTIVE = 1;         // æ´»è·ƒ
    INACTIVE = 2;       // ä¸æ´»è·ƒ
    SUSPENDED = 3;      // æš‚åœ
    DELETED = 4;        // å·²åˆ é™¤
}

message User {
    string name = 1;
    UserStatus status = 2;  // ä½¿ç”¨æšä¸¾ç±»å‹
}
```

**ğŸ’¡ æšä¸¾ä½¿ç”¨è¦ç‚¹**ï¼š
- ç¬¬ä¸€ä¸ªå€¼å¿…é¡»æ˜¯0
- ç”¨äºè¡¨ç¤ºæœ‰é™çš„å‡ ç§çŠ¶æ€
- æ¯”å­—ç¬¦ä¸²æ›´é«˜æ•ˆï¼Œæ¯”æ•°å­—æ›´æ¸…æ™°

### 6.2 åµŒå¥—æ¶ˆæ¯

**ä¸€ä¸ªæ¶ˆæ¯é‡Œå¯ä»¥åŒ…å«å¦ä¸€ä¸ªæ¶ˆæ¯**ï¼Œå°±åƒä¿„ç½—æ–¯å¥—å¨ƒã€‚

```protobuf
message Address {
    string province = 1;        // çœä»½
    string city = 2;           // åŸå¸‚
    string district = 3;       // åŒºå¿
    string detail = 4;         // è¯¦ç»†åœ°å€
}

message Person {
    string name = 1;           // å§“å
    int32 age = 2;            // å¹´é¾„
    Address home_address = 3;  // å®¶åº­åœ°å€(åµŒå¥—æ¶ˆæ¯)
    Address work_address = 4;  // å·¥ä½œåœ°å€
}
```

### 6.3 å¤åˆç±»å‹ç»„åˆä½¿ç”¨

```protobuf
enum OrderStatus {
    PENDING = 0;      // å¾…å¤„ç†
    PROCESSING = 1;   // å¤„ç†ä¸­
    SHIPPED = 2;      // å·²å‘è´§
    DELIVERED = 3;    // å·²é€è¾¾
    CANCELLED = 4;    // å·²å–æ¶ˆ
}

message OrderItem {
    string product_name = 1;
    int32 quantity = 2;
    double price = 3;
}

message Order {
    string order_id = 1;                // è®¢å•ID
    OrderStatus status = 2;             // è®¢å•çŠ¶æ€(æšä¸¾)
    repeated OrderItem items = 3;       // è®¢å•é¡¹åˆ—è¡¨(repeated + åµŒå¥—)
    Address shipping_address = 4;       // æ”¶è´§åœ°å€(åµŒå¥—æ¶ˆæ¯)
    int64 create_time = 5;             // åˆ›å»ºæ—¶é—´
}
```

---

## 7. ğŸ”¢ å­—æ®µç¼–å·è§„åˆ™


### 7.1 ç¼–å·çš„é‡è¦æ€§

**å­—æ®µç¼–å·å°±åƒèº«ä»½è¯å·**ï¼Œprotobufç”¨å®ƒæ¥è¯†åˆ«å­—æ®µï¼Œè€Œä¸æ˜¯ç”¨å­—æ®µåã€‚

```
ä¸ºä»€ä¹ˆç”¨ç¼–å·è€Œä¸ç”¨åå­—ï¼Ÿ
- åå­—å¯èƒ½å¾ˆé•¿ï¼Œç¼–å·åªéœ€è¦1-2ä¸ªå­—èŠ‚
- å¯ä»¥éšæ„ä¿®æ”¹å­—æ®µåï¼Œä¸å½±å“å…¼å®¹æ€§
- ä¸åŒè¯­è¨€å¯ä»¥ç”¨ä¸åŒçš„å­—æ®µå
```

### 7.2 ç¼–å·èŒƒå›´å’Œæ•ˆç‡


**ğŸ“Š ç¼–å·æ•ˆç‡å¯¹æ¯”è¡¨**

| **ç¼–å·èŒƒå›´** | **å­˜å‚¨å­—èŠ‚æ•°** | **æ¨èç”¨é€”** | **è¯´æ˜** |
|-------------|--------------|-------------|---------|
| **1-15** | **1å­—èŠ‚** | **å¸¸ç”¨å­—æ®µ** | æœ€é«˜æ•ˆï¼Œä¼˜å…ˆä½¿ç”¨ |
| **16-2047** | **2å­—èŠ‚** | æ™®é€šå­—æ®µ | æ•ˆç‡è¾ƒé«˜ |
| **2048-262143** | 3å­—èŠ‚ | ä¸å¸¸ç”¨å­—æ®µ | æ•ˆç‡ä¸€èˆ¬ |

### 7.3 ç¼–å·åˆ†é…ç­–ç•¥

```protobuf
message UserInfo {
    // 1-15ï¼šæœ€å¸¸ç”¨çš„å­—æ®µ
    string name = 1;           // å§“å(å¿…éœ€)
    int32 age = 2;            // å¹´é¾„(å¸¸ç”¨)
    string email = 3;         // é‚®ç®±(å¸¸ç”¨)
    
    // 16-2047ï¼šæ™®é€šå­—æ®µ
    string phone = 16;        // ç”µè¯(æ™®é€š)
    string address = 17;      // åœ°å€(æ™®é€š)
    
    // æ›´å¤§ç¼–å·ï¼šå¾ˆå°‘ç”¨åˆ°çš„å­—æ®µ
    string backup_email = 1000;  // å¤‡ç”¨é‚®ç®±(å¾ˆå°‘ç”¨)
}
```

### 7.4 ç¼–å·ä½¿ç”¨ç¦å¿Œ


**ğŸš« ä¸èƒ½åšçš„äº‹æƒ…**
```protobuf
message BadExample {
    string name = 1;
    int32 age = 1;        // âŒ ç¼–å·é‡å¤ï¼
    // string old_field = 2;  // âŒ åˆ é™¤å­—æ®µåä¸èƒ½é‡ç”¨ç¼–å·ï¼
    string new_field = 3;  // âœ… ä½¿ç”¨æ–°çš„ç¼–å·
}
```

**âœ… æ­£ç¡®çš„åšæ³•**
```protobuf
message GoodExample {
    // ä¿ç•™å·²åˆ é™¤çš„å­—æ®µç¼–å·
    reserved 2, 5 to 10;
    reserved "old_field_name";
    
    string name = 1;
    int32 age = 3;        // è·³è¿‡å·²ä¿ç•™çš„2
    string email = 4;
    string phone = 11;    // è·³è¿‡ä¿ç•™çš„5-10
}
```

---

## 8. ğŸ“¦ åŒ…ç®¡ç†ä¸å¯¼å…¥


### 8.1 åŒ…çš„ä½œç”¨

**åŒ…å°±åƒæ–‡ä»¶å¤¹**ï¼Œç”¨æ¥ç»„ç»‡å’Œç®¡ç†ä¸åŒçš„protoæ–‡ä»¶ï¼Œé¿å…å‘½åå†²çªã€‚

```
é¡¹ç›®ç»“æ„ç¤ºä¾‹ï¼š
src/
â”œâ”€â”€ common/
â”‚   â”œâ”€â”€ base.proto          (package common.base)
â”‚   â””â”€â”€ types.proto         (package common.types)
â”œâ”€â”€ user/
â”‚   â””â”€â”€ user_service.proto  (package user.service)
â””â”€â”€ order/
    â””â”€â”€ order_service.proto (package order.service)
```

### 8.2 packageå£°æ˜

```protobuf
// common/types.proto
syntax = "proto3";
package common.types;

message Address {
    string province = 1;
    string city = 2;
    string detail = 3;
}

enum Gender {
    UNKNOWN = 0;
    MALE = 1;
    FEMALE = 2;
}
```

### 8.3 importå¯¼å…¥ä½¿ç”¨

```protobuf
// user/user_service.proto
syntax = "proto3";
package user.service;

// å¯¼å…¥å…¶ä»–protoæ–‡ä»¶
import "common/types.proto";

message UserInfo {
    string name = 1;
    int32 age = 2;
    common.types.Address address = 3;  // ä½¿ç”¨å®Œæ•´è·¯å¾„
    common.types.Gender gender = 4;
}

service UserService {
    rpc GetUser(GetUserRequest) returns (UserInfo);
}

message GetUserRequest {
    string user_id = 1;
}
```

### 8.4 å¯¼å…¥è·¯å¾„è§£æ

```bash
# é¡¹ç›®ç›®å½•ç»“æ„
my-project/
â”œâ”€â”€ proto/
â”‚   â”œâ”€â”€ common/
â”‚   â”‚   â””â”€â”€ types.proto
â”‚   â””â”€â”€ user/
â”‚       â””â”€â”€ service.proto
â””â”€â”€ generated/
```

```protobuf
// åœ¨user/service.protoä¸­å¯¼å…¥
import "common/types.proto";  // ç›¸å¯¹äºprotoæ ¹ç›®å½•
```

---

## 9. âš™ï¸ ç¼–è¯‘å™¨ä½¿ç”¨


### 9.1 protocç¼–è¯‘å™¨ç®€ä»‹

**protocå°±æ˜¯protobufçš„"ç¿»è¯‘å®˜"**ï¼ŒæŠŠ`.proto`æ–‡ä»¶ç¿»è¯‘æˆå„ç§ç¼–ç¨‹è¯­è¨€çš„ä»£ç ã€‚

```
.protoæ–‡ä»¶ â”€â”€â†’ protocç¼–è¯‘å™¨ â”€â”€â†’ Java/Python/Goç­‰ä»£ç 
           (ç¿»è¯‘)              (å¯ä»¥ç›´æ¥ä½¿ç”¨)
```

### 9.2 åŸºæœ¬ç¼–è¯‘å‘½ä»¤

```bash
# åŸºæœ¬è¯­æ³•
protoc [é€‰é¡¹] protoæ–‡ä»¶

# ç”ŸæˆJavaä»£ç 
protoc --java_out=./generated hello.proto

# ç”ŸæˆPythonä»£ç   
protoc --python_out=./generated hello.proto

# ç”ŸæˆGoä»£ç 
protoc --go_out=./generated hello.proto
```

### 9.3 å®é™…ç¼–è¯‘ç¤ºä¾‹

```bash
# é¡¹ç›®ç»“æ„
my-project/
â”œâ”€â”€ proto/
â”‚   â””â”€â”€ hello_service.proto
â””â”€â”€ generated/
    â”œâ”€â”€ java/
    â”œâ”€â”€ python/
    â””â”€â”€ go/

# ç¼–è¯‘å‘½ä»¤
cd my-project

# ç”ŸæˆJavaä»£ç 
protoc --java_out=./generated/java \
       --proto_path=./proto \
       hello_service.proto

# ç”ŸæˆPythonä»£ç 
protoc --python_out=./generated/python \
       --proto_path=./proto \
       hello_service.proto
```

### 9.4 ç¼–è¯‘é€‰é¡¹è¯´æ˜

| **é€‰é¡¹** | **ä½œç”¨** | **ç¤ºä¾‹** |
|---------|---------|---------|
| `--java_out` | æŒ‡å®šJavaä»£ç è¾“å‡ºç›®å½• | `--java_out=./java` |
| `--python_out` | æŒ‡å®šPythonä»£ç è¾“å‡ºç›®å½• | `--python_out=./python` |
| `--go_out` | æŒ‡å®šGoä»£ç è¾“å‡ºç›®å½• | `--go_out=./go` |
| `--proto_path` | æŒ‡å®šprotoæ–‡ä»¶æœç´¢è·¯å¾„ | `--proto_path=./proto` |
| `-I` | `--proto_path`çš„ç®€å†™ | `-I./proto` |

### 9.5 ç”Ÿæˆçš„ä»£ç ç¤ºä¾‹

**ç¼–è¯‘å‰çš„protoæ–‡ä»¶**ï¼š
```protobuf
syntax = "proto3";
package hello;

message HelloRequest {
    string name = 1;
}

message HelloResponse {
    string message = 1;
}
```

**ç¼–è¯‘åçš„Javaä»£ç ï¼ˆç®€åŒ–ï¼‰**ï¼š
```java
public class HelloProto {
    public static class HelloRequest {
        private String name;
        
        public String getName() { return name; }
        public void setName(String name) { this.name = name; }
        // ... å…¶ä»–æ–¹æ³•
    }
    
    public static class HelloResponse {
        private String message;
        
        public String getMessage() { return message; }
        public void setMessage(String message) { this.message = message; }
        // ... å…¶ä»–æ–¹æ³•
    }
}
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ Protocol Buffersæœ¬è´¨ï¼šè·¨è¯­è¨€çš„æ•°æ®åºåˆ—åŒ–æ ¼å¼
ğŸ”¸ protoæ–‡ä»¶ï¼šæ•°æ®ç»“æ„çš„å®šä¹‰æ–‡ä»¶ï¼Œç±»ä¼¼"æ•°æ®æ ¼å¼è¯´æ˜ä¹¦"
ğŸ”¸ messageï¼šæ•°æ®ç»“æ„å®šä¹‰ï¼ŒåŒ…å«å­—æ®µç±»å‹ã€åç§°ã€ç¼–å·
ğŸ”¸ å­—æ®µç¼–å·ï¼šprotobufç”¨ç¼–å·è¯†åˆ«å­—æ®µï¼Œ1-15æœ€é«˜æ•ˆ
ğŸ”¸ å¤åˆç±»å‹ï¼šenumæšä¸¾å’ŒåµŒå¥—messageï¼Œç»„ç»‡å¤æ‚æ•°æ®
ğŸ”¸ åŒ…ç®¡ç†ï¼šç”¨packageç»„ç»‡ä»£ç ï¼Œç”¨importå¤ç”¨å®šä¹‰
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆè¦ç”¨å­—æ®µç¼–å·**
```
ä¼ ç»Ÿæ–¹å¼ï¼šç”¨å­—æ®µåè¯†åˆ« â†’ åå­—é•¿ï¼Œå ç©ºé—´
protobufæ–¹å¼ï¼šç”¨ç¼–å·è¯†åˆ« â†’ æ•°å­—çŸ­ï¼Œçœç©ºé—´
ä¼˜åŠ¿ï¼šå¯ä»¥æ”¹å­—æ®µåè€Œä¸å½±å“å…¼å®¹æ€§
```

**ğŸ”¹ æ•°æ®ç±»å‹é€‰æ‹©åŸåˆ™**
```
å°æ•´æ•°ç”¨int32ï¼Œå¤§æ•´æ•°ç”¨int64
æ–‡æœ¬ç”¨stringï¼ŒäºŒè¿›åˆ¶ç”¨bytes
å¤šä¸ªå€¼ç”¨repeated
å›ºå®šé€‰é¡¹ç”¨enum
```

**ğŸ”¹ ç¼–å·åˆ†é…ç­–ç•¥**
```
1-15ï¼šæœ€å¸¸ç”¨å­—æ®µï¼ˆ1å­—èŠ‚ï¼‰
16-2047ï¼šæ™®é€šå­—æ®µï¼ˆ2å­—èŠ‚ï¼‰  
æ›´å¤§ç¼–å·ï¼šå¾ˆå°‘ç”¨çš„å­—æ®µ
å·²åˆ é™¤å­—æ®µç¼–å·è¦reservedä¿ç•™
```

### 10.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ é€‚ç”¨åœºæ™¯**
- **å¾®æœåŠ¡é€šä¿¡**ï¼šæœåŠ¡é—´é«˜æ•ˆæ•°æ®äº¤æ¢
- **æ•°æ®å­˜å‚¨**ï¼šæ¯”JSONæ›´çœç©ºé—´çš„å­˜å‚¨æ ¼å¼
- **APIè®¾è®¡**ï¼šä¸¥æ ¼çš„æ¥å£å®šä¹‰ï¼Œæ”¯æŒç‰ˆæœ¬æ¼”è¿›
- **è·¨è¯­è¨€é¡¹ç›®**ï¼šJavaåç«¯ + Pythonç®—æ³• + Goç½‘å…³

**ğŸ”§ æœ€ä½³å®è·µ**
- å¸¸ç”¨å­—æ®µç”¨å°ç¼–å·ï¼ˆ1-15ï¼‰
- å­—æ®µåç”¨ä¸‹åˆ’çº¿å‘½åæ³•
- åˆ é™¤å­—æ®µè¦ä¿ç•™ç¼–å·
- åˆç†ä½¿ç”¨åŒ…å’Œå¯¼å…¥ç»„ç»‡ä»£ç 

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
protoå®šæ ¼å¼ï¼Œmessageå®šç»“æ„
å­—æ®µä¸‰è¦ç´ ï¼šç±»å‹åç¼–å·
1åˆ°15æœ€é«˜æ•ˆï¼Œåˆ é™¤ç¼–å·è¦ä¿ç•™
enumè¡¨é€‰æ‹©ï¼Œrepeatedè¡¨æ•°ç»„
åŒ…åé¿å†²çªï¼Œimportæ¥å¤ç”¨
```

> **ğŸ’¡ å­¦ä¹ å»ºè®®**ï¼šProtocol Buffersçš„æ ¸å¿ƒå°±æ˜¯"çº¦å®šæ•°æ®æ ¼å¼"ï¼Œé‡ç‚¹ç†è§£å­—æ®µç¼–å·æœºåˆ¶å’Œç±»å‹ç³»ç»Ÿï¼Œå¤šåšå®é™…ç¼–è¯‘ç»ƒä¹ ï¼Œä½“ä¼šç”Ÿæˆä»£ç çš„ä½¿ç”¨æ–¹å¼ã€‚