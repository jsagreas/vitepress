---
title: 2、nginx反向代理配置
---
## 📚 目录

1. [Nginx反向代理基础概念](#1-nginx反向代理基础概念)
2. [GitLab Nginx配置目录结构](#2-gitlab-nginx配置目录结构)
3. [主配置文件gitlab-http.conf详解](#3-主配置文件gitlab-httpconf详解)
4. [端口监听配置详解](#4-端口监听配置详解)
5. [域名绑定配置](#5-域名绑定配置)
6. [SSL证书配置与HTTPS](#6-ssl证书配置与https)
7. [客户端上传限制配置](#7-客户端上传限制配置)
8. [代理超时参数设置](#8-代理超时参数设置)
9. [访问日志配置管理](#9-访问日志配置管理)
10. [常见配置问题解决](#10-常见配置问题解决)
11. [核心要点总结](#11-核心要点总结)

---

## 1. 🌐 Nginx反向代理基础概念


### 1.1 什么是反向代理


**🔸 通俗理解反向代理**
```
想象一个场景：
你去餐厅吃饭，服务员就是"反向代理"

正常情况：你直接找厨师点菜（客户端直接访问服务器）
反向代理：你告诉服务员要什么菜，服务员去厨房处理（Nginx接收请求，转发给GitLab）

好处：
- 厨师专心做菜，不用管点菜收钱（GitLab专心处理业务逻辑）
- 服务员处理多个客户（Nginx处理并发请求）
- 服务员还能记住常点的菜（缓存功能）
```

**💡 GitLab中的反向代理作用**
```
客户端浏览器 → Nginx → GitLab应用

Nginx负责：
✅ 接收用户的HTTP请求
✅ 处理SSL加密（HTTPS）
✅ 限制上传文件大小
✅ 记录访问日志
✅ 静态文件直接返回（提升性能）

GitLab负责：
✅ 处理业务逻辑（代码管理、CI/CD等）
✅ 数据库操作
✅ 用户认证授权
```

### 1.2 为什么GitLab需要Nginx


**🎯 解决的实际问题**
```
性能问题：
- GitLab是Ruby应用，处理静态文件效率不高
- Nginx专门优化了静态文件服务
- 结果：网页加载更快，服务器压力更小

安全问题：
- Nginx可以隐藏GitLab的真实端口
- 提供SSL终端，统一处理加密
- 防止直接攻击GitLab应用

扩展性：
- 可以配置多个GitLab实例做负载均衡
- 方便添加缓存、压缩等功能
```

---

## 2. 📁 GitLab Nginx配置目录结构


### 2.1 配置文件位置详解


**🗂️ 主要配置目录**
```
/var/opt/gitlab/nginx/conf/
├── gitlab-http.conf          # 主配置文件（HTTP）
├── gitlab-ssl.conf           # HTTPS配置文件
├── nginx.conf               # Nginx主配置
└── conf.d/                  # 额外配置目录
    ├── gitlab.conf          # GitLab专用配置
    └── custom.conf          # 自定义配置
```

**📂 目录权限和所有者**
```
# 查看配置目录权限
ls -la /var/opt/gitlab/nginx/conf/

# 通常的权限设置：
drwxr-xr-x  gitlab-www gitlab-www  /var/opt/gitlab/nginx/conf/
-rw-r--r--  gitlab-www gitlab-www  gitlab-http.conf

重要说明：
- 目录属于gitlab-www用户，这是GitLab的Web服务用户
- 配置文件只有所有者可写，其他人只读（安全考虑）
- 普通用户需要sudo权限才能修改
```

### 2.2 配置文件的生成机制


**⚙️ 自动生成vs手动配置**
```
GitLab的配置文件管理机制：

自动生成（推荐方式）：
1. 编辑 /etc/gitlab/gitlab.rb
2. 运行 gitlab-ctl reconfigure
3. 系统自动生成nginx配置文件

手动修改（不推荐）：
直接编辑 /var/opt/gitlab/nginx/conf/ 下的文件
问题：下次reconfigure会覆盖手动修改

正确做法：
修改 gitlab.rb → 运行 reconfigure → 查看生成的配置
```

### 2.3 备份配置文件


**💾 配置备份的重要性**
```bash
# 修改前先备份
sudo cp /var/opt/gitlab/nginx/conf/gitlab-http.conf \
       /var/opt/gitlab/nginx/conf/gitlab-http.conf.backup

# 批量备份所有nginx配置
sudo tar -czf nginx_config_backup_$(date +%Y%m%d).tar.gz \
       /var/opt/gitlab/nginx/conf/
```

---

## 3. 📋 主配置文件gitlab-http.conf详解


### 3.1 配置文件结构概览


**🏗️ 典型的gitlab-http.conf结构**
```nginx
# 这是一个完整的GitLab HTTP配置示例

# 如果需要重定向HTTP到HTTPS，这个server块处理重定向
server {
  listen 80;
  server_name gitlab.example.com;
  return 301 https://$server_name$request_uri;
}

# 主要的GitLab服务配置
server {
  listen 80;                    # 监听端口
  server_name gitlab.example.com;  # 域名配置
  
  # 日志配置
  access_log /var/log/gitlab/nginx/gitlab_access.log;
  error_log  /var/log/gitlab/nginx/gitlab_error.log;
  
  # 上传大小限制
  client_max_body_size 250m;
  
  # 代理设置
  location / {
    proxy_pass http://127.0.0.1:8080;
    proxy_set_header Host $host;
    # ... 更多代理配置
  }
}
```

### 3.2 配置文件各部分作用


**📌 server块的核心作用**
```
server块就像是"接待员"的工作说明书：

listen部分：
- 告诉nginx在哪个端口"守门"
- 类似告诉接待员在几号门等客人

server_name部分：
- 告诉nginx这个配置处理哪个域名的请求
- 类似告诉接待员只接待某个公司的客人

location部分：
- 告诉nginx不同的URL路径如何处理
- 类似告诉接待员不同类型的客人去哪个办公室
```

### 3.3 注释和文档


**📝 配置文件中的注释规范**
```nginx
# 注释以#开头，说明配置的作用
# GitLab推荐在每个重要配置项前添加说明

server {
  # 监听标准HTTP端口
  listen 80;
  
  # 配置域名，支持通配符
  server_name gitlab.example.com *.gitlab.example.com;
  
  # 客户端请求体大小限制（重要：影响Git推送）
  client_max_body_size 250m;
}
```

---

## 4. 🚪 端口监听配置详解


### 4.1 listen参数详细说明


**🔧 基础端口配置**
```nginx
# 最简单的端口监听
listen 80;

# 指定IP地址和端口
listen 192.168.1.100:80;

# 监听所有IPv4地址
listen 0.0.0.0:80;

# 同时监听IPv6
listen [::]:80;
```

**💡 端口配置的实际含义**
```
listen 80 的作用：
- 告诉nginx在80端口等待HTTP请求
- 80是HTTP的默认端口，浏览器访问时可以不写端口号
- 例如：http://gitlab.example.com 等同于 http://gitlab.example.com:80

listen 443 的作用：
- 443是HTTPS的默认端口
- 用于加密的安全连接
- 例如：https://gitlab.example.com 等同于 https://gitlab.example.com:443
```

### 4.2 非标准端口配置


**🔄 自定义端口的使用场景**
```nginx
# 使用非标准端口（例如8080）
server {
  listen 8080;
  server_name gitlab.example.com;
  
  # 这种情况下，用户需要在URL中指定端口
  # 访问地址：http://gitlab.example.com:8080
}
```

**⚠️ 非标准端口的注意事项**
```
使用非标准端口的影响：

用户体验：
- 需要记住端口号，如 http://gitlab.company.com:8080
- URL变长，不够简洁

防火墙：
- 需要开放相应端口
- 企业防火墙可能阻止非标准端口

GitLab功能：
- Git clone地址会包含端口号
- Webhook回调URL需要包含端口号
```

### 4.3 端口冲突解决


**🔍 常见端口冲突问题**
```bash
# 检查端口是否被占用
sudo netstat -tulpn | grep :80
sudo ss -tulpn | grep :80

# 常见冲突：
- 80端口：Apache、其他web服务器
- 443端口：其他HTTPS服务
- 22端口：SSH服务（GitLab SSH需要配置）

# 解决方法：
1. 停止冲突服务
2. 更改GitLab端口
3. 使用不同IP地址
```

---

## 5. 🌐 域名绑定配置


### 5.1 server_name基础配置


**📛 域名配置的几种方式**
```nginx
# 1. 单个域名
server {
  server_name gitlab.example.com;
}

# 2. 多个域名
server {
  server_name gitlab.example.com git.example.com;
}

# 3. 通配符域名
server {
  server_name *.gitlab.example.com;
}

# 4. 正则表达式域名
server {
  server_name ~^gitlab-\d+\.example\.com$;
}
```

**💭 域名配置的实际应用**
```
单域名使用场景：
- 小公司，只有一个GitLab实例
- 简单部署，域名管理简单
- 例如：gitlab.company.com

多域名使用场景：
- 同一个GitLab服务，多个域名访问
- 内外网不同域名
- 例如：gitlab.internal.com 和 git.company.com

通配符域名：
- 支持子域名访问
- 多项目独立域名
- 例如：project1.gitlab.com, project2.gitlab.com
```

### 5.2 域名优先级和匹配规则


**🎯 nginx域名匹配顺序**
```
nginx按以下顺序匹配域名：

1. 精确匹配：gitlab.example.com
2. 通配符前缀：*.example.com  
3. 通配符后缀：gitlab.*
4. 正则表达式：~^gitlab\..*$
5. 默认server（default_server）

实际例子：
请求：gitlab.example.com
匹配：gitlab.example.com（精确匹配，优先级最高）

请求：test.example.com  
匹配：*.example.com（通配符匹配）
```

### 5.3 默认服务器配置


**🏠 default_server的作用**
```nginx
# 设置默认服务器
server {
  listen 80 default_server;
  server_name _;  # 下划线表示匹配任何域名
  
  # 处理未知域名的请求
  return 444;  # 直接关闭连接
  # 或者重定向到主域名
  # return 301 https://gitlab.example.com$request_uri;
}
```

**🛡️ 安全考虑**
```
为什么需要default_server：

安全防护：
- 防止通过IP直接访问
- 避免域名解析攻击
- 隐藏真实的服务配置

实例：
攻击者可能通过IP地址：http://192.168.1.100
default_server可以直接拒绝这类请求
```

---

## 6. 🔒 SSL证书配置与HTTPS


### 6.1 HTTPS基础概念


**🔐 为什么GitLab需要HTTPS**
```
HTTPS的重要性：

数据安全：
- 保护用户密码、API密钥
- 防止代码传输被窃听
- 保护CI/CD敏感信息

身份验证：
- 确保连接到真正的GitLab服务器
- 防止中间人攻击

合规要求：
- 现代浏览器对HTTP网站显示"不安全"
- 企业安全政策要求
- Git操作推荐使用HTTPS
```

### 6.2 SSL证书配置


**📜 基本SSL配置结构**
```nginx
server {
  # HTTPS端口
  listen 443 ssl http2;
  server_name gitlab.example.com;
  
  # SSL证书文件路径
  ssl_certificate /etc/gitlab/ssl/gitlab.example.com.crt;
  ssl_certificate_key /etc/gitlab/ssl/gitlab.example.com.key;
  
  # SSL协议和加密套件
  ssl_protocols TLSv1.2 TLSv1.3;
  ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384;
  
  # 其他SSL安全配置...
}
```

**🔑 证书文件说明**
```
证书文件类型：

.crt文件（证书文件）：
- 包含公钥和证书信息
- 可以被任何人查看
- 用于验证服务器身份

.key文件（私钥文件）：
- 包含私钥信息
- 必须严格保密
- 用于解密SSL连接

获取证书的方式：
1. 免费证书：Let's Encrypt
2. 购买证书：商业CA机构
3. 自签名证书：测试环境使用
```

### 6.3 Let's Encrypt自动证书


**🚀 自动化SSL证书管理**
```ruby
# 在gitlab.rb中启用Let's Encrypt
letsencrypt['enable'] = true
letsencrypt['contact_emails'] = ['admin@example.com']

# 自动更新证书
letsencrypt['auto_renew'] = true
letsencrypt['auto_renew_hour'] = 1
letsencrypt['auto_renew_minute'] = 30
```

**💡 Let's Encrypt的优势**
```
免费证书的好处：

成本：
- 完全免费，无需购买
- 自动续期，无需手动操作
- 支持通配符证书

集成：
- GitLab内置支持
- 自动配置nginx
- 自动处理证书更新

限制：
- 需要域名验证
- 证书有效期只有90天（但自动续期）
- 需要服务器能访问互联网
```

### 6.4 强制HTTPS配置


**🔄 HTTP到HTTPS重定向**
```nginx
# HTTP服务器块，专门处理重定向
server {
  listen 80;
  server_name gitlab.example.com;
  
  # 将所有HTTP请求重定向到HTTPS
  return 301 https://$server_name$request_uri;
}

# HTTPS服务器块，处理实际请求
server {
  listen 443 ssl http2;
  server_name gitlab.example.com;
  # SSL配置...
}
```

**⚡ 在gitlab.rb中配置强制HTTPS**
```ruby
# 强制所有连接使用HTTPS
nginx['redirect_http_to_https'] = true

# 配置HSTS安全头
nginx['hsts_max_age'] = 31536000
nginx['hsts_include_subdomains'] = true
```

---

## 7. 📤 客户端上传限制配置


### 7.1 client_max_body_size参数详解


**📏 上传大小限制的作用**
```
为什么需要限制上传大小：

服务器保护：
- 防止恶意用户上传超大文件
- 避免服务器磁盘空间被耗尽
- 保护服务器内存不被占满

网络考虑：
- 大文件上传时间长，可能导致超时
- 占用网络带宽，影响其他用户
- 移动网络环境下体验不好
```

**⚙️ 基本配置方法**
```nginx
server {
  # 设置客户端请求体最大大小为250MB
  client_max_body_size 250m;
  
  # 也可以设置为其他单位：
  # client_max_body_size 1g;     # 1GB
  # client_max_body_size 500k;   # 500KB
  # client_max_body_size 0;      # 无限制（不推荐）
}
```

### 7.2 不同场景的大小配置


**🎯 根据使用场景调整大小**
```
小团队开发（建议100MB-250MB）：
- 主要是代码文件，通常很小
- 偶尔有文档、图片资源
- 很少有大型文件需求

大型项目（建议500MB-1GB）：
- 可能包含大型资源文件
- 数据库备份文件
- 编译产物、安装包

企业环境（建议1GB-2GB）：
- 多种类型项目
- 可能有大型二进制文件
- 需要存储各种文档资料
```

### 7.3 Git推送大小限制


**📦 Git操作的特殊考虑**
```
Git推送与Web上传的区别：

Web界面上传：
- 单个文件上传
- 受client_max_body_size限制
- 用于上传文档、图片等

Git推送：
- 推送整个提交历史
- 可能包含多个文件变更
- 也受client_max_body_size限制

实际案例：
如果你的Git仓库单次推送超过250MB，会看到：
"413 Request Entity Too Large" 错误
```

### 7.4 上传错误处理


**🚨 常见上传错误和解决方法**
```nginx
# 自定义413错误页面
error_page 413 /413.html;
location = /413.html {
  root /var/opt/gitlab/nginx/www;
  internal;
}
```

**💡 用户友好的错误提示**
```html
<!-- 创建 /var/opt/gitlab/nginx/www/413.html -->
<!DOCTYPE html>
<html>
<head>
  <title>文件过大</title>
</head>
<body>
  <h1>文件上传失败</h1>
  <p>您尝试上传的文件超出了大小限制（250MB）。</p>
  <p>请联系管理员或尝试上传较小的文件。</p>
</body>
</html>
```

---

## 8. ⏱️ 代理超时参数设置


### 8.1 超时参数的重要性


**🕐 为什么需要配置超时**
```
超时设置的作用：

保护服务器资源：
- 防止连接长时间占用
- 避免僵尸连接耗尽资源
- 及时释放无效连接

提升用户体验：
- 快速返回错误信息
- 避免页面无限等待
- 合理的等待时间
```

### 8.2 主要超时参数详解


**⏰ 关键超时参数配置**
```nginx
server {
  # 客户端连接超时（nginx等待客户端发送请求的时间）
  client_header_timeout 60s;
  client_body_timeout 60s;
  
  # 发送响应超时（nginx向客户端发送响应的时间）
  send_timeout 60s;
  
  # 代理超时设置
  proxy_connect_timeout 300s;    # 连接后端服务器超时
  proxy_send_timeout 300s;       # 向后端发送请求超时
  proxy_read_timeout 300s;       # 从后端读取响应超时
}
```

**📝 每个参数的具体含义**
```
client_header_timeout：
- 用户访问网页时，浏览器发送请求头的时间限制
- 太短：网络慢的用户可能访问失败
- 太长：恶意用户可能滥用连接

proxy_read_timeout：
- nginx等待GitLab返回响应的时间
- GitLab处理复杂操作（如大型合并）可能需要较长时间
- 这个参数很重要，影响CI/CD任务的执行
```

### 8.3 针对GitLab的超时优化


**🎯 GitLab特殊操作的超时考虑**
```nginx
location / {
  proxy_pass http://127.0.0.1:8080;
  
  # GitLab操作可能较慢，适当延长超时
  proxy_read_timeout 300s;
  proxy_connect_timeout 60s;
  proxy_send_timeout 60s;
}

# 对于特定的慢操作，可以设置更长超时
location ~ ^/(admin|api/v4/projects/.*/repository/archive) {
  proxy_pass http://127.0.0.1:8080;
  proxy_read_timeout 600s;  # 10分钟超时
}
```

**⚙️ GitLab内部超时配置**
```ruby
# 在gitlab.rb中配置GitLab应用层超时
gitlab_rails['gitlab_default_projects_limit'] = 100000
gitlab_rails['gitlab_default_can_create_group'] = true

# Web服务器超时
unicorn['worker_timeout'] = 300
puma['worker_timeout'] = 300
```

### 8.4 超时问题诊断


**🔍 超时错误的识别和解决**
```
常见超时错误：

504 Gateway Timeout：
- nginx无法从GitLab获取响应
- 通常是proxy_read_timeout不够
- 解决：增加proxy_read_timeout值

502 Bad Gateway：
- nginx无法连接到GitLab
- 可能是GitLab服务停止
- 解决：检查GitLab服务状态

408 Request Timeout：
- 客户端发送请求太慢
- 通常是client_body_timeout不够
- 解决：增加客户端超时设置
```

---

## 9. 📊 访问日志配置管理


### 9.1 日志的重要性


**📈 访问日志的作用**
```
日志记录的价值：

安全监控：
- 记录访问来源和行为
- 发现异常访问模式
- 追踪安全事件

性能分析：
- 分析响应时间
- 找出访问热点
- 优化系统性能

故障排查：
- 记录错误请求详情
- 帮助定位问题原因
- 提供故障恢复依据
```

### 9.2 基本日志配置


**📝 日志配置示例**
```nginx
server {
  # 访问日志配置
  access_log /var/log/gitlab/nginx/gitlab_access.log;
  
  # 错误日志配置
  error_log /var/log/gitlab/nginx/gitlab_error.log;
  
  # 也可以指定日志级别
  error_log /var/log/gitlab/nginx/gitlab_error.log warn;
}
```

**🗂️ 日志文件路径说明**
```
GitLab日志目录结构：
/var/log/gitlab/
├── nginx/
│   ├── gitlab_access.log    # nginx访问日志
│   ├── gitlab_error.log     # nginx错误日志
│   └── current              # 当前日志（如果使用logrotate）
├── gitlab-rails/
│   └── production.log       # GitLab应用日志
└── postgresql/
    └── current              # 数据库日志
```

### 9.3 自定义日志格式


**🎨 定制日志格式**
```nginx
# 定义日志格式
log_format gitlab_access '$remote_addr - $remote_user [$time_local] '
                         '"$request" $status $bytes_sent '
                         '"$http_referer" "$http_user_agent" '
                         '$request_time $upstream_response_time';

server {
  # 使用自定义格式
  access_log /var/log/gitlab/nginx/gitlab_access.log gitlab_access;
}
```

**📋 日志字段含义**
```
$remote_addr: 客户端IP地址
$remote_user: 认证用户名（如果有）
$time_local: 本地时间
$request: 完整的HTTP请求行
$status: HTTP响应状态码
$bytes_sent: 发送给客户端的字节数
$http_referer: 请求来源页面
$http_user_agent: 客户端浏览器信息
$request_time: 处理请求总时间
$upstream_response_time: 后端响应时间
```

### 9.4 日志轮转和管理


**🔄 日志轮转配置**
```bash
# 创建logrotate配置文件
sudo cat > /etc/logrotate.d/gitlab-nginx << 'EOF'
/var/log/gitlab/nginx/*.log {
    daily                    # 每天轮转
    missingok               # 日志文件不存在不报错
    rotate 52               # 保留52个轮转文件
    compress                # 压缩旧日志
    delaycompress          # 延迟压缩
    notifempty             # 空文件不轮转
    create 0644 gitlab-www gitlab-www  # 创建新文件的权限
    postrotate
        /usr/bin/gitlab-ctl hup nginx
    endscript
}
EOF
```

**💾 日志存储空间管理**
```bash
# 检查日志文件大小
du -sh /var/log/gitlab/nginx/

# 清理旧日志（谨慎操作）
find /var/log/gitlab/nginx/ -name "*.log.*" -mtime +30 -delete

# 实时查看访问日志
tail -f /var/log/gitlab/nginx/gitlab_access.log
```

---

## 10. 🔧 常见配置问题解决


### 10.1 配置测试和验证


**✅ 配置正确性检查**
```bash
# 测试nginx配置语法
sudo gitlab-ctl nginx -t

# 重新加载配置（不中断服务）
sudo gitlab-ctl hup nginx

# 重启nginx服务
sudo gitlab-ctl restart nginx

# 查看nginx状态
sudo gitlab-ctl status nginx
```

### 10.2 常见错误和解决方案


**🚨 典型配置错误**

| 错误现象 | 可能原因 | 解决方法 |
|---------|----------|----------|
| `502 Bad Gateway` | GitLab服务未启动 | `gitlab-ctl start` |
| `413 Request Entity Too Large` | 上传大小限制太小 | 增加`client_max_body_size` |
| `SSL证书错误` | 证书文件路径错误 | 检查证书文件路径和权限 |
| `域名无法访问` | DNS配置错误 | 检查域名解析设置 |

### 10.3 性能优化建议


**⚡ 提升nginx性能的配置**
```nginx
# 工作进程数（通常等于CPU核心数）
worker_processes auto;

# 增加工作连接数
events {
    worker_connections 1024;
    use epoll;
}

# 开启文件缓存
http {
    open_file_cache max=1000 inactive=20s;
    open_file_cache_valid 30s;
    
    # 开启gzip压缩
    gzip on;
    gzip_types text/plain text/css application/javascript;
}
```

---

## 11. 📋 核心要点总结


### 11.1 必须掌握的基本概念


```
🔸 反向代理：nginx接收请求，转发给GitLab处理
🔸 配置文件：主要是gitlab-http.conf，通过gitlab.rb生成
🔸 端口监听：80端口HTTP，443端口HTTPS
🔸 域名绑定：server_name指定域名，支持通配符
🔸 上传限制：client_max_body_size控制文件大小
🔸 超时设置：防止连接长时间占用资源
🔸 日志记录：记录访问信息，便于监控和排查问题
```

### 11.2 关键理解要点


**🔹 配置管理的正确方法**
```
正确流程：
1. 修改 /etc/gitlab/gitlab.rb
2. 运行 gitlab-ctl reconfigure  
3. 检查生成的nginx配置
4. 测试配置是否正确

错误做法：
直接修改 /var/opt/gitlab/nginx/conf/ 下的文件
（会被reconfigure覆盖）
```

**🔹 SSL配置的重要性**
```
HTTPS的必要性：
- 保护用户数据安全
- 现代浏览器要求
- Git操作推荐使用HTTPS
- 企业安全合规需求

Let's Encrypt的优势：
- 免费、自动续期
- GitLab内置支持
- 简化SSL配置流程
```

### 11.3 实践建议


**💡 日常维护要点**
```
定期检查：
✅ 查看错误日志，及时发现问题
✅ 监控访问日志，分析使用模式  
✅ 检查SSL证书有效期
✅ 验证备份配置文件

性能优化：
✅ 根据实际使用调整上传大小限制
✅ 合理设置超时参数
✅ 配置日志轮转，避免磁盘空间不足
✅ 开启gzip压缩提升传输效率
```

**🎯 故障排查思路**
```
问题分析步骤：
1. 查看nginx错误日志
2. 检查GitLab服务状态
3. 验证配置文件语法
4. 测试网络连接
5. 检查防火墙设置

常用命令：
- gitlab-ctl status：检查服务状态
- gitlab-ctl nginx -t：测试配置
- tail -f /var/log/gitlab/nginx/：查看实时日志
```

**核心记忆要点**：
- nginx是GitLab的前端代理，负责HTTP处理和SSL终端
- 所有配置修改都应该通过gitlab.rb进行
- 合理的超时和上传限制设置对用户体验很重要
- 日志是排查问题和性能优化的重要依据
- HTTPS配置是现代Web应用的基本要求