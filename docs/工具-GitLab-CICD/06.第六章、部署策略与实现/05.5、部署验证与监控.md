---
title: 5ã€éƒ¨ç½²éªŒè¯ä¸ç›‘æ§
---
## ğŸ“š ç›®å½•

1. [éƒ¨ç½²éªŒè¯åŸºç¡€æ¦‚å¿µ](#1-éƒ¨ç½²éªŒè¯åŸºç¡€æ¦‚å¿µ)
2. [éƒ¨ç½²åéªŒè¯ç­–ç•¥](#2-éƒ¨ç½²åéªŒè¯ç­–ç•¥)
3. [å¥åº·æ£€æŸ¥é…ç½®](#3-å¥åº·æ£€æŸ¥é…ç½®)
4. [éƒ¨ç½²çŠ¶æ€ç›‘æ§](#4-éƒ¨ç½²çŠ¶æ€ç›‘æ§)
5. [æ—¥å¿—æ”¶é›†é…ç½®](#5-æ—¥å¿—æ”¶é›†é…ç½®)
6. [å‘Šè­¦è®¾ç½®](#6-å‘Šè­¦è®¾ç½®)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ éƒ¨ç½²éªŒè¯åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯éƒ¨ç½²éªŒè¯


**ğŸ’¡ é€šä¿—ç†è§£**ï¼šéƒ¨ç½²éªŒè¯å°±åƒæ˜¯æ–°æˆ¿è£…ä¿®å®Œæˆåçš„éªŒæ”¶å·¥ä½œ
```
è£…ä¿®å®Œæˆ¿å­åè¦æ£€æŸ¥ï¼š
âœ… æ°´ç”µæ˜¯å¦æ­£å¸¸ï¼Ÿ
âœ… é—¨çª—èƒ½å¦æ­£å¸¸å¼€å…³ï¼Ÿ
âœ… å„ä¸ªæˆ¿é—´åŠŸèƒ½æ˜¯å¦å®Œå¥½ï¼Ÿ

åŒæ ·ï¼Œéƒ¨ç½²å®Œåº”ç”¨åè¦æ£€æŸ¥ï¼š
âœ… æœåŠ¡æ˜¯å¦å¯åŠ¨æˆåŠŸï¼Ÿ
âœ… æ¥å£æ˜¯å¦èƒ½æ­£å¸¸å“åº”ï¼Ÿ
âœ… æ ¸å¿ƒåŠŸèƒ½æ˜¯å¦è¿è¡Œæ­£å¸¸ï¼Ÿ
```

**ğŸ”¸ æ ¸å¿ƒå®šä¹‰**
```
éƒ¨ç½²éªŒè¯ï¼šåœ¨åº”ç”¨éƒ¨ç½²å®Œæˆåï¼Œè‡ªåŠ¨æˆ–æ‰‹åŠ¨æ£€æŸ¥åº”ç”¨æ˜¯å¦æ­£ç¡®è¿è¡Œ
ç›®çš„ï¼šç¡®ä¿æ–°ç‰ˆæœ¬åŠŸèƒ½æ­£å¸¸ï¼Œç”¨æˆ·ä½“éªŒä¸å—å½±å“
æ—¶æœºï¼šéƒ¨ç½²å®Œæˆåç«‹å³è¿›è¡Œï¼Œç¡®ä¿é—®é¢˜æ—©å‘ç°æ—©è§£å†³
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦éƒ¨ç½²éªŒè¯


**ğŸš¨ çœŸå®é—®é¢˜åœºæ™¯**
```
å¸¸è§éƒ¨ç½²é—®é¢˜ï¼š
â€¢ ä»£ç éƒ¨ç½²æˆåŠŸï¼Œä½†æœåŠ¡å¯åŠ¨å¤±è´¥
â€¢ æœåŠ¡å¯åŠ¨äº†ï¼Œä½†æ ¸å¿ƒåŠŸèƒ½å¼‚å¸¸
â€¢ æ•°æ®åº“è¿æ¥é…ç½®é”™è¯¯
â€¢ ä¾èµ–æœåŠ¡ä¸å¯ç”¨
â€¢ æ–°ç‰ˆæœ¬å‡ºç°æ€§èƒ½é—®é¢˜

å¦‚æœæ²¡æœ‰éªŒè¯ï¼š
âŒ ç”¨æˆ·è®¿é—®æ—¶æ‰å‘ç°é—®é¢˜
âŒ å½±å“ç”¨æˆ·ä½“éªŒå’Œä¸šåŠ¡
âŒ ç´§æ€¥å›æ»šï¼Œæ‰‹å¿™è„šä¹±
```

**âœ… éƒ¨ç½²éªŒè¯çš„ä»·å€¼**
```
æ—©æœŸå‘ç°ï¼šéƒ¨ç½²å®Œç«‹å³æ£€æµ‹é—®é¢˜
è‡ªåŠ¨å›æ»šï¼šæ£€æµ‹å¤±è´¥è‡ªåŠ¨å›åˆ°ä¸Šä¸€ç‰ˆæœ¬
é™ä½é£é™©ï¼šå‡å°‘å¯¹ç”¨æˆ·çš„å½±å“
æå‡ä¿¡å¿ƒï¼šç¡®ä¿æ¯æ¬¡éƒ¨ç½²éƒ½æ˜¯å¯é çš„
```

### 1.3 éªŒè¯çš„å±‚æ¬¡ç»“æ„


```
éªŒè¯å±‚æ¬¡ä»æµ…åˆ°æ·±ï¼š

ğŸ”¸ åŸºç¡€éªŒè¯ï¼ˆå¿…é¡»ï¼‰
â”œâ”€â”€ æœåŠ¡å¯åŠ¨æ£€æŸ¥
â”œâ”€â”€ ç«¯å£ç›‘å¬æ£€æŸ¥
â””â”€â”€ åŸºæœ¬è¿é€šæ€§æµ‹è¯•

ğŸ”¸ åŠŸèƒ½éªŒè¯ï¼ˆé‡è¦ï¼‰
â”œâ”€â”€ æ ¸å¿ƒAPIæµ‹è¯•
â”œâ”€â”€ æ•°æ®åº“è¿æ¥æµ‹è¯•
â””â”€â”€ å…³é”®ä¸šåŠ¡æµç¨‹éªŒè¯

ğŸ”¸ æ€§èƒ½éªŒè¯ï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ å“åº”æ—¶é—´æ£€æŸ¥
â”œâ”€â”€ å¹¶å‘èƒ½åŠ›æµ‹è¯•
â””â”€â”€ èµ„æºä½¿ç”¨ç›‘æ§
```

---

## 2. ğŸ” éƒ¨ç½²åéªŒè¯ç­–ç•¥


### 2.1 GitLab CI/CD ä¸­çš„éªŒè¯é˜¶æ®µ


**ğŸ—ï¸ éªŒè¯åœ¨ Pipeline ä¸­çš„ä½ç½®**
```
GitLab Pipeline æµç¨‹ï¼š

æ„å»ºé˜¶æ®µ â†’ æµ‹è¯•é˜¶æ®µ â†’ éƒ¨ç½²é˜¶æ®µ â†’ ã€éªŒè¯é˜¶æ®µã€‘â†’ æ¸…ç†é˜¶æ®µ
   â†“          â†“          â†“           â†“
 ç¼–è¯‘ä»£ç     å•å…ƒæµ‹è¯•    å‘å¸ƒåº”ç”¨    æ£€æŸ¥éƒ¨ç½²ç»“æœ
```

**âš™ï¸ åœ¨ .gitlab-ci.yml ä¸­é…ç½®éªŒè¯**
```yaml
stages:
  - build
  - test
  - deploy
  - verify    # éªŒè¯é˜¶æ®µ
  - cleanup

# éƒ¨ç½²job
deploy_production:
  stage: deploy
  script:
    - echo "éƒ¨ç½²åº”ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒ"
    - kubectl apply -f k8s/

# éªŒè¯job
verify_deployment:
  stage: verify
  script:
    - echo "å¼€å§‹éªŒè¯éƒ¨ç½²ç»“æœ"
    - ./scripts/health_check.sh
  dependencies:
    - deploy_production
```

### 2.2 éªŒè¯ç­–ç•¥ç±»å‹


**ğŸ¯ ç«‹å³éªŒè¯**ï¼šéƒ¨ç½²å®Œæˆåç«‹å³æ£€æŸ¥
```yaml
verify_immediate:
  stage: verify
  script:
    # ç­‰å¾…æœåŠ¡å¯åŠ¨
    - sleep 30
    # æ£€æŸ¥æœåŠ¡çŠ¶æ€
    - curl -f http://localhost:8080/health
    # éªŒè¯æ ¸å¿ƒåŠŸèƒ½
    - ./test_core_features.sh
  timeout: 5m  # 5åˆ†é’Ÿè¶…æ—¶
```

**â° å»¶è¿ŸéªŒè¯**ï¼šç»™åº”ç”¨ä¸€äº›å¯åŠ¨æ—¶é—´
```yaml
verify_delayed:
  stage: verify
  script:
    # ç­‰å¾…æœåŠ¡å®Œå…¨å¯åŠ¨å’Œé¢„çƒ­
    - echo "ç­‰å¾…æœåŠ¡é¢„çƒ­..."
    - sleep 120
    # è¿›è¡Œæ·±åº¦éªŒè¯
    - ./comprehensive_test.sh
  when: delayed
  start_in: 2 minutes
```

**ğŸ”„ æŒç»­éªŒè¯**ï¼šåœ¨ä¸€æ®µæ—¶é—´å†…æŒç»­æ£€æŸ¥
```yaml
verify_continuous:
  stage: verify
  script:
    - |
      for i in {1..10}; do
        echo "ç¬¬ $i æ¬¡éªŒè¯"
        curl -f http://app.example.com/api/status
        sleep 30
      done
  timeout: 10m
```

### 2.3 éªŒè¯å¤±è´¥å¤„ç†ç­–ç•¥


**ğŸš¨ è‡ªåŠ¨å›æ»šé…ç½®**
```yaml
verify_with_rollback:
  stage: verify
  script:
    - ./health_check.sh
  after_script:
    - |
      if [ $CI_JOB_STATUS == "failed" ]; then
        echo "éªŒè¯å¤±è´¥ï¼Œå¼€å§‹è‡ªåŠ¨å›æ»š"
        kubectl rollout undo deployment/myapp
        echo "å›æ»šå®Œæˆ"
      fi
```

**ğŸ“§ å¤±è´¥é€šçŸ¥è®¾ç½®**
```yaml
verify_with_notification:
  stage: verify
  script:
    - ./deployment_verification.sh
  after_script:
    - |
      if [ $CI_JOB_STATUS == "failed" ]; then
        curl -X POST "$SLACK_WEBHOOK" \
          -d "{\"text\":\"ğŸš¨ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²éªŒè¯å¤±è´¥ï¼è¯·ç«‹å³æ£€æŸ¥\"}"
      fi
```

---

## 3. ğŸ¥ å¥åº·æ£€æŸ¥é…ç½®


### 3.1 ä»€ä¹ˆæ˜¯å¥åº·æ£€æŸ¥


**ğŸ’¡ ç”Ÿæ´»ç±»æ¯”**ï¼šå¥åº·æ£€æŸ¥å°±åƒå®šæœŸä½“æ£€
```
äººçš„ä½“æ£€é¡¹ç›®ï¼š
ğŸ”¸ æµ‹è¡€å‹ã€å¿ƒç‡ â†’ åŸºæœ¬ç”Ÿå‘½ä½“å¾
ğŸ”¸ åŒ–éªŒè¡€æ¶² â†’ å†…éƒ¨åŠŸèƒ½çŠ¶æ€
ğŸ”¸ Xå…‰æ£€æŸ¥ â†’ ç»“æ„æ˜¯å¦æ­£å¸¸

åº”ç”¨å¥åº·æ£€æŸ¥ï¼š
ğŸ”¸ HTTPå“åº”æ£€æŸ¥ â†’ æœåŠ¡æ˜¯å¦æ´»ç€
ğŸ”¸ æ•°æ®åº“è¿æ¥æ£€æŸ¥ â†’ ä¾èµ–æ˜¯å¦æ­£å¸¸
ğŸ”¸ ä¸šåŠ¡é€»è¾‘æ£€æŸ¥ â†’ åŠŸèƒ½æ˜¯å¦å®Œæ•´
```

### 3.2 å¥åº·æ£€æŸ¥ç«¯ç‚¹è®¾è®¡


**ğŸ”§ åŸºç¡€å¥åº·æ£€æŸ¥ç«¯ç‚¹**
```javascript
// Node.js ç¤ºä¾‹
app.get('/health', (req, res) => {
  res.status(200).json({
    status: 'UP',
    timestamp: new Date().toISOString(),
    service: 'my-app',
    version: process.env.APP_VERSION
  });
});
```

**ğŸ” æ·±åº¦å¥åº·æ£€æŸ¥ç«¯ç‚¹**
```javascript
app.get('/health/detailed', async (req, res) => {
  const checks = {
    database: await checkDatabase(),
    redis: await checkRedis(),
    external_api: await checkExternalAPI()
  };
  
  const allHealthy = Object.values(checks).every(check => check.status === 'UP');
  
  res.status(allHealthy ? 200 : 503).json({
    status: allHealthy ? 'UP' : 'DOWN',
    checks: checks,
    timestamp: new Date().toISOString()
  });
});
```

### 3.3 ä¸åŒå±‚çº§çš„å¥åº·æ£€æŸ¥


**ğŸ“Š å¥åº·æ£€æŸ¥å±‚çº§å¯¹æ¯”**

| æ£€æŸ¥ç±»å‹ | **æ£€æŸ¥å†…å®¹** | **å“åº”æ—¶é—´** | **é€‚ç”¨åœºæ™¯** |
|---------|-------------|-------------|-------------|
| **å­˜æ´»æ£€æŸ¥** | `æœåŠ¡è¿›ç¨‹æ˜¯å¦è¿è¡Œ` | `< 1ç§’` | `åŸºç¡€ç›‘æ§` |
| **å°±ç»ªæ£€æŸ¥** | `æœåŠ¡æ˜¯å¦å¯ä»¥å¤„ç†è¯·æ±‚` | `< 3ç§’` | `è´Ÿè½½å‡è¡¡å™¨é…ç½®` |
| **æ·±åº¦æ£€æŸ¥** | `æ‰€æœ‰ä¾èµ–æ˜¯å¦æ­£å¸¸` | `< 10ç§’` | `å®Œæ•´æ€§éªŒè¯` |

**ğŸ”¸ å­˜æ´»æ£€æŸ¥ï¼ˆLivenessï¼‰**ï¼šæœ€åŸºç¡€çš„æ£€æŸ¥
```bash
# ç®€å•çš„å­˜æ´»æ£€æŸ¥
curl -f http://localhost:8080/ping
# è¿”å›ï¼špong
```

**ğŸ”¸ å°±ç»ªæ£€æŸ¥ï¼ˆReadinessï¼‰**ï¼šæœåŠ¡å‡†å¤‡å¥½å¤„ç†è¯·æ±‚
```bash
# æ£€æŸ¥æœåŠ¡æ˜¯å¦å‡†å¤‡å°±ç»ª
curl -f http://localhost:8080/ready
# è¿”å›ï¼š{"status": "ready", "dependencies": "ok"}
```

**ğŸ”¸ æ·±åº¦æ£€æŸ¥ï¼ˆDeep Health Checkï¼‰**ï¼šå…¨é¢éªŒè¯
```bash
# å…¨é¢å¥åº·æ£€æŸ¥
curl -f http://localhost:8080/health/deep
# è¿”å›è¯¦ç»†çš„ä¾èµ–çŠ¶æ€ä¿¡æ¯
```

### 3.4 åœ¨ CI/CD ä¸­ä½¿ç”¨å¥åº·æ£€æŸ¥


**âš™ï¸ GitLab CI å¥åº·æ£€æŸ¥è„šæœ¬**
```yaml
health_check:
  stage: verify
  script:
    - |
      echo "å¼€å§‹å¥åº·æ£€æŸ¥..."
      
      # ç­‰å¾…æœåŠ¡å¯åŠ¨
      for i in {1..30}; do
        if curl -f http://localhost:8080/health; then
          echo "âœ… åŸºç¡€å¥åº·æ£€æŸ¥é€šè¿‡"
          break
        fi
        echo "ç­‰å¾…æœåŠ¡å¯åŠ¨... ($i/30)"
        sleep 10
      done
      
      # æ·±åº¦å¥åº·æ£€æŸ¥
      if curl -f http://localhost:8080/health/detailed; then
        echo "âœ… æ·±åº¦å¥åº·æ£€æŸ¥é€šè¿‡"
      else
        echo "âŒ æ·±åº¦å¥åº·æ£€æŸ¥å¤±è´¥"
        exit 1
      fi
```

**ğŸ› ï¸ å¥åº·æ£€æŸ¥è„šæœ¬ç¤ºä¾‹**
```bash
#!/bin/bash
# health_check.sh

APP_URL="http://localhost:8080"
MAX_RETRIES=10
RETRY_INTERVAL=10

echo "ğŸ” å¼€å§‹å¥åº·æ£€æŸ¥..."

# åŸºç¡€è¿é€šæ€§æ£€æŸ¥
for i in $(seq 1 $MAX_RETRIES); do
  echo "å°è¯•è¿æ¥æœåŠ¡... ($i/$MAX_RETRIES)"
  
  if curl -s -f "$APP_URL/health" > /dev/null; then
    echo "âœ… æœåŠ¡è¿æ¥æˆåŠŸ"
    break
  fi
  
  if [ $i -eq $MAX_RETRIES ]; then
    echo "âŒ æœåŠ¡è¿æ¥å¤±è´¥ï¼Œè¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°"
    exit 1
  fi
  
  sleep $RETRY_INTERVAL
done

# åŠŸèƒ½æ€§æ£€æŸ¥
echo "ğŸ§ª æ‰§è¡ŒåŠŸèƒ½æ£€æŸ¥..."
response=$(curl -s "$APP_URL/api/status")

if echo "$response" | grep -q "\"status\":\"ok\""; then
  echo "âœ… åŠŸèƒ½æ£€æŸ¥é€šè¿‡"
else
  echo "âŒ åŠŸèƒ½æ£€æŸ¥å¤±è´¥: $response"
  exit 1
fi

echo "ğŸ‰ æ‰€æœ‰å¥åº·æ£€æŸ¥é€šè¿‡ï¼"
```

---

## 4. ğŸ“Š éƒ¨ç½²çŠ¶æ€ç›‘æ§


### 4.1 ç›‘æ§çš„é‡è¦æ€§


**ğŸ¯ ç›‘æ§å°±åƒæ±½è½¦ä»ªè¡¨ç›˜**
```
å¼€è½¦æ—¶ä»ªè¡¨ç›˜æ˜¾ç¤ºï¼š
ğŸ”¸ é€Ÿåº¦è¡¨ â†’ å½“å‰è¿è¡Œé€Ÿåº¦
ğŸ”¸ æ²¹é‡è¡¨ â†’ èµ„æºå‰©ä½™æƒ…å†µ  
ğŸ”¸ æ°´æ¸©è¡¨ â†’ ç³»ç»Ÿå¥åº·çŠ¶æ€
ğŸ”¸ æ•…éšœç¯ â†’ å¼‚å¸¸è­¦å‘Šä¿¡å·

åº”ç”¨ç›‘æ§æ˜¾ç¤ºï¼š
ğŸ”¸ å“åº”æ—¶é—´ â†’ æ€§èƒ½çŠ¶å†µ
ğŸ”¸ CPU/å†…å­˜ä½¿ç”¨ç‡ â†’ èµ„æºçŠ¶å†µ
ğŸ”¸ é”™è¯¯ç‡ â†’ å¥åº·çŠ¶å†µ
ğŸ”¸ å‘Šè­¦ä¿¡æ¯ â†’ å¼‚å¸¸çŠ¶å†µ
```

### 4.2 å…³é”®ç›‘æ§æŒ‡æ ‡


**ğŸ“ˆ æ ¸å¿ƒç›‘æ§æŒ‡æ ‡**

```
ğŸ”¸ å¯ç”¨æ€§æŒ‡æ ‡
â”œâ”€â”€ æœåŠ¡å­˜æ´»çŠ¶æ€ï¼ˆUP/DOWNï¼‰
â”œâ”€â”€ å“åº”æ—¶é—´ï¼ˆå¹³å‡ã€P95ã€P99ï¼‰
â””â”€â”€ é”™è¯¯ç‡ï¼ˆ4xxã€5xxé”™è¯¯æ¯”ä¾‹ï¼‰

ğŸ”¸ æ€§èƒ½æŒ‡æ ‡  
â”œâ”€â”€ CPUä½¿ç”¨ç‡
â”œâ”€â”€ å†…å­˜ä½¿ç”¨ç‡
â”œâ”€â”€ ç£ç›˜I/O
â””â”€â”€ ç½‘ç»œæµé‡

ğŸ”¸ ä¸šåŠ¡æŒ‡æ ‡
â”œâ”€â”€ æ´»è·ƒç”¨æˆ·æ•°
â”œâ”€â”€ è¯·æ±‚å¤„ç†é‡
â””â”€â”€ å…³é”®ä¸šåŠ¡æ“ä½œæˆåŠŸç‡
```

### 4.3 ç›‘æ§å·¥å…·é›†æˆ


**ğŸ› ï¸ Prometheus + Grafana ç›‘æ§**
```yaml
# docker-compose.yml ç›‘æ§æ ˆ
version: '3.8'
services:
  prometheus:
    image: prom/prometheus
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
  
  grafana:
    image: grafana/grafana
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin123
```

**âš™ï¸ åº”ç”¨ç›‘æ§æŒ‡æ ‡æš´éœ²**
```javascript
// åº”ç”¨ä¸­æš´éœ²æŒ‡æ ‡
const prometheus = require('prom-client');

// åˆ›å»ºæŒ‡æ ‡
const httpRequestDuration = new prometheus.Histogram({
  name: 'http_request_duration_seconds',
  help: 'HTTPè¯·æ±‚è€—æ—¶',
  labelNames: ['method', 'route', 'status']
});

// ä¸­é—´ä»¶è®°å½•æŒ‡æ ‡
app.use((req, res, next) => {
  const start = Date.now();
  
  res.on('finish', () => {
    const duration = (Date.now() - start) / 1000;
    httpRequestDuration
      .labels(req.method, req.route?.path || req.path, res.statusCode)
      .observe(duration);
  });
  
  next();
});

// æŒ‡æ ‡ç«¯ç‚¹
app.get('/metrics', (req, res) => {
  res.set('Content-Type', prometheus.register.contentType);
  res.end(prometheus.register.metrics());
});
```

### 4.4 åœ¨ GitLab CI ä¸­é›†æˆç›‘æ§


**ğŸ“Š éƒ¨ç½²åç›‘æ§éªŒè¯**
```yaml
monitor_deployment:
  stage: verify
  script:
    - |
      echo "ğŸ“Š å¼€å§‹ç›‘æ§éªŒè¯..."
      
      # ç­‰å¾…æŒ‡æ ‡æ”¶é›†
      sleep 60
      
      # æ£€æŸ¥æœåŠ¡å¯ç”¨æ€§
      UPTIME=$(curl -s "http://prometheus:9090/api/v1/query?query=up{job='myapp'}" | jq -r '.data.result[0].value[1]')
      
      if [ "$UPTIME" == "1" ]; then
        echo "âœ… æœåŠ¡ç›‘æ§çŠ¶æ€æ­£å¸¸"
      else
        echo "âŒ æœåŠ¡ç›‘æ§å¼‚å¸¸"
        exit 1
      fi
      
      # æ£€æŸ¥é”™è¯¯ç‡
      ERROR_RATE=$(curl -s "http://prometheus:9090/api/v1/query?query=rate(http_requests_total{status=~'5..'}[5m])")
      echo "å½“å‰é”™è¯¯ç‡: $ERROR_RATE"
```

---

## 5. ğŸ“ æ—¥å¿—æ”¶é›†é…ç½®


### 5.1 æ—¥å¿—æ”¶é›†çš„ä»·å€¼


**ğŸ’¡ æ—¥å¿—å°±åƒåŒ»ç”Ÿçš„ç—…å†**
```
åŒ»ç”Ÿè¯Šæ–­éœ€è¦ï¼š
ğŸ”¸ ç—…å²è®°å½• â†’ äº†è§£è¿‡å¾€æƒ…å†µ
ğŸ”¸ ç—‡çŠ¶æè¿° â†’ æŒæ¡å½“å‰çŠ¶æ€
ğŸ”¸ æ£€æŸ¥ç»“æœ â†’ è·å–å®¢è§‚æ•°æ®

åº”ç”¨è¯Šæ–­éœ€è¦ï¼š
ğŸ”¸ è®¿é—®æ—¥å¿— â†’ äº†è§£ç”¨æˆ·è¡Œä¸º
ğŸ”¸ é”™è¯¯æ—¥å¿— â†’ å‘ç°é—®é¢˜æ ¹å› 
ğŸ”¸ æ€§èƒ½æ—¥å¿— â†’ åˆ†æç³»ç»Ÿç“¶é¢ˆ
```

### 5.2 æ—¥å¿—ç±»å‹ä¸æ ¼å¼


**ğŸ“‹ å¸¸è§æ—¥å¿—åˆ†ç±»**

```
ğŸ”¸ è®¿é—®æ—¥å¿—ï¼ˆAccess Logï¼‰
è®°å½•å†…å®¹ï¼šè°ã€ä»€ä¹ˆæ—¶å€™ã€è®¿é—®äº†ä»€ä¹ˆã€ç»“æœå¦‚ä½•
æ ¼å¼ç¤ºä¾‹ï¼š[2024-01-15 10:30:25] GET /api/users 200 125ms

ğŸ”¸ é”™è¯¯æ—¥å¿—ï¼ˆError Logï¼‰  
è®°å½•å†…å®¹ï¼šä»€ä¹ˆé”™è¯¯ã€åœ¨å“ªé‡Œå‘ç”Ÿã€è¯¦ç»†å †æ ˆä¿¡æ¯
æ ¼å¼ç¤ºä¾‹ï¼š[2024-01-15 10:31:02] ERROR: Database connection failed

ğŸ”¸ åº”ç”¨æ—¥å¿—ï¼ˆApplication Logï¼‰
è®°å½•å†…å®¹ï¼šä¸šåŠ¡æ“ä½œã€çŠ¶æ€å˜åŒ–ã€é‡è¦äº‹ä»¶
æ ¼å¼ç¤ºä¾‹ï¼š[2024-01-15 10:31:15] INFO: User 1234 logged in successfully
```

### 5.3 ç»“æ„åŒ–æ—¥å¿—é…ç½®


**ğŸ› ï¸ JSON æ ¼å¼æ—¥å¿—é…ç½®**
```javascript
// Node.js winston æ—¥å¿—é…ç½®
const winston = require('winston');

const logger = winston.createLogger({
  format: winston.format.combine(
    winston.format.timestamp(),
    winston.format.errors({ stack: true }),
    winston.format.json()
  ),
  transports: [
    new winston.transports.File({ 
      filename: 'logs/error.log', 
      level: 'error' 
    }),
    new winston.transports.File({ 
      filename: 'logs/combined.log' 
    })
  ]
});

// ä½¿ç”¨ç¤ºä¾‹
logger.info('ç”¨æˆ·ç™»å½•', { 
  userId: 1234, 
  ip: '192.168.1.100',
  userAgent: 'Chrome/96.0'
});
```

### 5.4 ELK Stack æ—¥å¿—æ”¶é›†


**ğŸ”§ Elasticsearch + Logstash + Kibana é…ç½®**

**Filebeat é…ç½®æ”¶é›†æ—¥å¿—**
```yaml
# filebeat.yml
filebeat.inputs:
  - type: log
    enabled: true
    paths:
      - /var/log/myapp/*.log
    fields:
      service: myapp
      environment: production

output.elasticsearch:
  hosts: ["elasticsearch:9200"]
  
setup.kibana:
  host: "kibana:5601"
```

**åœ¨ GitLab CI ä¸­é…ç½®æ—¥å¿—æ”¶é›†**
```yaml
deploy_with_logging:
  stage: deploy
  script:
    - |
      # éƒ¨ç½²åº”ç”¨
      kubectl apply -f k8s/
      
      # é…ç½®æ—¥å¿—æ”¶é›†
      kubectl apply -f logging/filebeat-config.yaml
      
      echo "âœ… åº”ç”¨å’Œæ—¥å¿—æ”¶é›†å·²é…ç½®"
  
verify_logging:
  stage: verify
  script:
    - |
      echo "ğŸ” éªŒè¯æ—¥å¿—æ”¶é›†..."
      
      # ç­‰å¾…æ—¥å¿—äº§ç”Ÿ
      sleep 60
      
      # æ£€æŸ¥ Elasticsearch ä¸­æ˜¯å¦æœ‰æ—¥å¿—
      LOG_COUNT=$(curl -s "http://elasticsearch:9200/logstash-*/_count" | jq .count)
      
      if [ "$LOG_COUNT" -gt 0 ]; then
        echo "âœ… æ—¥å¿—æ”¶é›†æ­£å¸¸ï¼Œå…±æ”¶é›† $LOG_COUNT æ¡æ—¥å¿—"
      else
        echo "âŒ æ—¥å¿—æ”¶é›†å¼‚å¸¸"
        exit 1
      fi
```

---

## 6. ğŸš¨ å‘Šè­¦è®¾ç½®


### 6.1 å‘Šè­¦çš„é‡è¦æ€§


**ğŸš¨ å‘Šè­¦å°±åƒç«ç¾æŠ¥è­¦å™¨**
```
ç«ç¾æŠ¥è­¦å™¨ä½œç”¨ï¼š
ğŸ”¸ åŠæ—¶å‘ç°å±é™© â†’ çƒŸé›¾æ£€æµ‹
ğŸ”¸ ç«‹å³é€šçŸ¥ç›¸å…³äººå‘˜ â†’ å£°éŸ³/çŸ­ä¿¡
ğŸ”¸ ä¾¿äºå¿«é€Ÿå“åº” â†’ æ˜ç¡®ä½ç½®ä¿¡æ¯

åº”ç”¨å‘Šè­¦ä½œç”¨ï¼š
ğŸ”¸ åŠæ—¶å‘ç°é—®é¢˜ â†’ é”™è¯¯ç‡/å“åº”æ—¶é—´å¼‚å¸¸
ğŸ”¸ é€šçŸ¥è¿ç»´äººå‘˜ â†’ é‚®ä»¶/çŸ­ä¿¡/IM
ğŸ”¸ ä¾¿äºå¿«é€Ÿä¿®å¤ â†’ è¯¦ç»†é”™è¯¯ä¿¡æ¯
```

### 6.2 å‘Šè­¦è§„åˆ™è®¾è®¡


**ğŸ“ å‘Šè­¦è§„åˆ™å±‚æ¬¡**

```
ğŸ”¸ ç´§æ€¥å‘Šè­¦ï¼ˆCriticalï¼‰
è§¦å‘æ¡ä»¶ï¼šæœåŠ¡å®Œå…¨ä¸å¯ç”¨ã€æ•°æ®ä¸¢å¤±é£é™©
é€šçŸ¥æ–¹å¼ï¼šç”µè¯ + çŸ­ä¿¡ + é‚®ä»¶
å“åº”æ—¶é—´ï¼šç«‹å³ï¼ˆ5åˆ†é’Ÿå†…ï¼‰

ğŸ”¸ é‡è¦å‘Šè­¦ï¼ˆWarningï¼‰  
è§¦å‘æ¡ä»¶ï¼šæ€§èƒ½ä¸‹é™ã€é”™è¯¯ç‡ä¸Šå‡
é€šçŸ¥æ–¹å¼ï¼šé‚®ä»¶ + IM
å“åº”æ—¶é—´ï¼š30åˆ†é’Ÿå†…

ğŸ”¸ ä¿¡æ¯å‘Šè­¦ï¼ˆInfoï¼‰
è§¦å‘æ¡ä»¶ï¼šèµ„æºä½¿ç”¨ç‡é«˜ã€æ…¢æŸ¥è¯¢
é€šçŸ¥æ–¹å¼ï¼šé‚®ä»¶
å“åº”æ—¶é—´ï¼šå·¥ä½œæ—¶é—´å†…å¤„ç†
```

### 6.3 Prometheus å‘Šè­¦è§„åˆ™


**âš™ï¸ å‘Šè­¦è§„åˆ™é…ç½®**
```yaml
# alerts.yml
groups:
  - name: application.rules
    rules:
      # æœåŠ¡ä¸å¯ç”¨å‘Šè­¦
      - alert: ServiceDown
        expr: up{job="myapp"} == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "æœåŠ¡ {{ $labels.instance }} ä¸å¯ç”¨"
          description: "æœåŠ¡å·²ç»ä¸‹çº¿è¶…è¿‡1åˆ†é’Ÿ"
      
      # é”™è¯¯ç‡è¿‡é«˜å‘Šè­¦
      - alert: HighErrorRate
        expr: rate(http_requests_total{status=~"5.."}[5m]) > 0.1
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "é”™è¯¯ç‡è¿‡é«˜"
          description: "5åˆ†é’Ÿå†…é”™è¯¯ç‡è¶…è¿‡10%: {{ $value }}"
      
      # å“åº”æ—¶é—´è¿‡é•¿å‘Šè­¦
      - alert: HighLatency
        expr: histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m])) > 1
        for: 10m
        labels:
          severity: warning
        annotations:
          summary: "å“åº”æ—¶é—´è¿‡é•¿"
          description: "95%å“åº”æ—¶é—´è¶…è¿‡1ç§’: {{ $value }}s"
```

### 6.4 é€šçŸ¥æ¸ é“é…ç½®


**ğŸ“§ å¤šæ¸ é“é€šçŸ¥é…ç½®**
```yaml
# alertmanager.yml
global:
  smtp_smarthost: 'smtp.gmail.com:587'
  smtp_from: 'alerts@company.com'

route:
  group_by: ['alertname']
  group_wait: 10s
  group_interval: 10s
  repeat_interval: 1h
  receiver: 'web.hook'

receivers:
  - name: 'web.hook'
    email_configs:
      - to: 'admin@company.com'
        subject: 'ğŸš¨ {{ .GroupLabels.alertname }}'
        body: |
          å‘Šè­¦è¯¦æƒ…:
          {{ range .Alerts }}
          - {{ .Annotations.summary }}
            {{ .Annotations.description }}
          {{ end }}
    
    slack_configs:
      - api_url: 'YOUR_SLACK_WEBHOOK_URL'
        channel: '#alerts'
        title: 'ğŸš¨ ç”Ÿäº§ç¯å¢ƒå‘Šè­¦'
        text: '{{ range .Alerts }}{{ .Annotations.summary }}{{ end }}'
```

### 6.5 GitLab CI ä¸­çš„å‘Šè­¦é›†æˆ


**âš™ï¸ éƒ¨ç½²å¤±è´¥å‘Šè­¦**
```yaml
deploy_production:
  stage: deploy
  script:
    - ./deploy.sh
  after_script:
    - |
      if [ $CI_JOB_STATUS == "failed" ]; then
        # å‘é€å‘Šè­¦é€šçŸ¥
        curl -X POST "$SLACK_WEBHOOK" \
          -H 'Content-type: application/json' \
          -d "{
            \"text\": \"ğŸš¨ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å¤±è´¥!\",
            \"attachments\": [{
              \"color\": \"danger\",
              \"fields\": [{
                \"title\": \"é¡¹ç›®\",
                \"value\": \"$CI_PROJECT_NAME\",
                \"short\": true
              }, {
                \"title\": \"åˆ†æ”¯\",
                \"value\": \"$CI_COMMIT_REF_NAME\",
                \"short\": true
              }, {
                \"title\": \"æäº¤\",
                \"value\": \"$CI_COMMIT_SHA\",
                \"short\": true
              }]
            }]
          }"
      fi
```

**ğŸ“Š éƒ¨ç½²æˆåŠŸç›‘æ§å‘Šè­¦**
```yaml
setup_monitoring:
  stage: verify
  script:
    - |
      # åˆ›å»ºä¸´æ—¶å‘Šè­¦è§„åˆ™ç”¨äºéƒ¨ç½²éªŒè¯
      cat > /tmp/deployment_alerts.yml << EOF
      groups:
        - name: deployment.verification
          rules:
            - alert: DeploymentVerificationFailed
              expr: up{job="myapp",instance="new-deployment"} == 0
              for: 2m
              labels:
                severity: critical
              annotations:
                summary: "æ–°éƒ¨ç½²éªŒè¯å¤±è´¥"
                description: "æ–°éƒ¨ç½²çš„æœåŠ¡åœ¨2åˆ†é’Ÿå†…æ— æ³•å“åº”"
      EOF
      
      # åŠ è½½å‘Šè­¦è§„åˆ™
      curl -X POST http://prometheus:9090/-/reload
      
      echo "âœ… éƒ¨ç½²ç›‘æ§å‘Šè­¦å·²é…ç½®"
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ éƒ¨ç½²éªŒè¯æœ¬è´¨ï¼šç¡®ä¿éƒ¨ç½²çš„åº”ç”¨èƒ½å¤Ÿæ­£å¸¸å·¥ä½œ
ğŸ”¸ éªŒè¯å±‚æ¬¡ï¼šä»åŸºç¡€è¿é€šæ€§åˆ°æ·±åº¦åŠŸèƒ½æ£€æŸ¥
ğŸ”¸ å¥åº·æ£€æŸ¥ï¼šæä¾›æ ‡å‡†åŒ–çš„æœåŠ¡çŠ¶æ€æ£€æŸ¥æ¥å£
ğŸ”¸ ç›‘æ§æŒ‡æ ‡ï¼šå®æ—¶äº†è§£åº”ç”¨è¿è¡ŒçŠ¶å†µ
ğŸ”¸ æ—¥å¿—æ”¶é›†ï¼šè®°å½•å’Œåˆ†æåº”ç”¨è¿è¡Œè¯¦æƒ…
ğŸ”¸ å‘Šè­¦æœºåˆ¶ï¼šé—®é¢˜å‘ç”Ÿæ—¶åŠæ—¶é€šçŸ¥ç›¸å…³äººå‘˜
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ éªŒè¯ç­–ç•¥çš„é€‰æ‹©**
```
ç«‹å³éªŒè¯ â†’ å¿«é€Ÿå‘ç°æ˜æ˜¾é—®é¢˜
å»¶è¿ŸéªŒè¯ â†’ ç­‰å¾…æœåŠ¡å®Œå…¨å°±ç»ªåæ·±åº¦æ£€æŸ¥
æŒç»­éªŒè¯ â†’ åœ¨ä¸€æ®µæ—¶é—´å†…æŒç»­è§‚å¯ŸæœåŠ¡ç¨³å®šæ€§

é€‰æ‹©å»ºè®®ï¼š
â€¢ å…³é”®æœåŠ¡ï¼šä¸‰ç§éªŒè¯éƒ½è¦åš
â€¢ ä¸€èˆ¬æœåŠ¡ï¼šç«‹å³éªŒè¯ + å»¶è¿ŸéªŒè¯
â€¢ ç®€å•æœåŠ¡ï¼šåªåšç«‹å³éªŒè¯
```

**ğŸ”¹ ç›‘æ§æŒ‡æ ‡çš„é‡è¦æ€§æ’åº**
```
1ï¸âƒ£ å¯ç”¨æ€§æŒ‡æ ‡ â†’ æœåŠ¡æ˜¯å¦æ­£å¸¸ï¼ˆæœ€é‡è¦ï¼‰
2ï¸âƒ£ æ€§èƒ½æŒ‡æ ‡ â†’ ç”¨æˆ·ä½“éªŒå¦‚ä½•ï¼ˆå¾ˆé‡è¦ï¼‰  
3ï¸âƒ£ èµ„æºæŒ‡æ ‡ â†’ ç³»ç»Ÿè´Ÿè½½æƒ…å†µï¼ˆé‡è¦ï¼‰
4ï¸âƒ£ ä¸šåŠ¡æŒ‡æ ‡ â†’ ä¸šåŠ¡ç›®æ ‡è¾¾æˆï¼ˆé‡è¦ï¼‰

è®°å¿†æŠ€å·§ï¼šå…ˆä¿è¯"æ´»ç€"ï¼Œå†å…³æ³¨"å¥½ä¸å¥½ç”¨"
```

**ğŸ”¹ å‘Šè­¦è§„åˆ™è®¾è®¡åŸåˆ™**
```
é¿å…å‘Šè­¦ç–²åŠ³ï¼š
â€¢ ä¸è¦ä¸ºæ¯ä¸ªå°é—®é¢˜éƒ½è®¾ç½®å‘Šè­¦
â€¢ åˆç†è®¾ç½®å‘Šè­¦é˜ˆå€¼ï¼Œé¿å…è¯¯æŠ¥
â€¢ åŒºåˆ†å‘Šè­¦ä¸¥é‡çº§åˆ«

ç¡®ä¿åŠæ—¶å“åº”ï¼š
â€¢ å…³é”®é—®é¢˜ç«‹å³é€šçŸ¥
â€¢ æä¾›è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ä¿¡æ¯
â€¢ å¤šæ¸ é“é€šçŸ¥ç¡®ä¿é€è¾¾
```

### 7.3 å®é™…åº”ç”¨å»ºè®®


**ğŸ› ï¸ éƒ¨ç½²éªŒè¯æœ€ä½³å®è·µ**
- **æ¸è¿›å¼éªŒè¯**ï¼šä»ç®€å•åˆ°å¤æ‚ï¼Œé€æ­¥éªŒè¯å„ä¸ªå±‚é¢
- **è‡ªåŠ¨åŒ–ç¨‹åº¦**ï¼šæ ¸å¿ƒéªŒè¯è¦è‡ªåŠ¨åŒ–ï¼Œå¤æ‚éªŒè¯å¯ä»¥äººå·¥ä»‹å…¥
- **å¤±è´¥å¤„ç†**ï¼šåˆ¶å®šæ¸…æ™°çš„å¤±è´¥å¤„ç†æµç¨‹ï¼ŒåŒ…æ‹¬å›æ»šå’Œé€šçŸ¥
- **æ–‡æ¡£è®°å½•**ï¼šè®°å½•éªŒè¯è¿‡ç¨‹å’Œç»“æœï¼Œä¾¿äºé—®é¢˜è¿½è¸ª

**ğŸ“Š ç›‘æ§å®æ–½ç­–ç•¥**
- **å…ˆå»ºåŸºç¡€ç›‘æ§**ï¼šæœåŠ¡å¯ç”¨æ€§ã€åŸºæœ¬æ€§èƒ½æŒ‡æ ‡
- **å†æ·»ä¸šåŠ¡ç›‘æ§**ï¼šæ ¹æ®å…·ä½“ä¸šåŠ¡éœ€æ±‚æ·»åŠ å®šåˆ¶æŒ‡æ ‡
- **é€æ­¥å®Œå–„å‘Šè­¦**ï¼šä»ä¸¥é‡å‘Šè­¦å¼€å§‹ï¼Œé€æ­¥ç»†åŒ–å‘Šè­¦è§„åˆ™
- **å®šæœŸè¯„ä¼°ä¼˜åŒ–**ï¼šæ ¹æ®å®é™…ä½¿ç”¨æƒ…å†µè°ƒæ•´ç›‘æ§ç­–ç•¥

**ğŸ”§ å·¥å…·é€‰æ‹©å»ºè®®**
- **å°å›¢é˜Ÿ**ï¼šä½¿ç”¨ç®€å•çš„å¥åº·æ£€æŸ¥ + åŸºç¡€ç›‘æ§å·¥å…·
- **ä¸­ç­‰è§„æ¨¡**ï¼šå¼•å…¥ Prometheus + Grafana ç›‘æ§æ ˆ
- **å¤§å‹ç³»ç»Ÿ**ï¼šè€ƒè™‘ä¸“ä¸šçš„ APM å·¥å…·ï¼ˆå¦‚ Datadogã€New Relicï¼‰

### 7.4 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


| é—®é¢˜ç±»å‹ | **å¸¸è§åŸå› ** | **è§£å†³æ–¹æ¡ˆ** |
|---------|-------------|-------------|
| **éªŒè¯è¶…æ—¶** | `æœåŠ¡å¯åŠ¨æ—¶é—´é•¿` | `è°ƒæ•´è¶…æ—¶æ—¶é—´ï¼Œå¢åŠ é‡è¯•æœºåˆ¶` |
| **å¥åº·æ£€æŸ¥å¤±è´¥** | `ä¾èµ–æœåŠ¡ä¸å¯ç”¨` | `åˆ†å±‚æ£€æŸ¥ï¼ŒåŒºåˆ†æ ¸å¿ƒå’Œéæ ¸å¿ƒä¾èµ–` |
| **ç›‘æ§æ•°æ®å¼‚å¸¸** | `æŒ‡æ ‡æ”¶é›†é…ç½®é”™è¯¯` | `æ£€æŸ¥æŒ‡æ ‡æš´éœ²å’Œæ”¶é›†é…ç½®` |
| **å‘Šè­¦é£æš´** | `é˜ˆå€¼è®¾ç½®ä¸åˆç†` | `è°ƒæ•´å‘Šè­¦é˜ˆå€¼ï¼Œå¢åŠ å‘Šè­¦æŠ‘åˆ¶è§„åˆ™` |

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- éƒ¨ç½²å®Œæˆè¦éªŒè¯ï¼Œå¥åº·æ£€æŸ¥æ˜¯å…³é”®
- ç›‘æ§æŒ‡æ ‡çœ‹å…¨é¢ï¼Œå‘Šè­¦è®¾ç½®è¦åˆç†  
- é—®é¢˜å‘ç°è¦åŠæ—¶ï¼Œè‡ªåŠ¨å¤„ç†å‡äººå·¥
- æ—¥å¿—è®°å½•åŠ©æ’æŸ¥ï¼Œè¿ç»´æ•ˆç‡å¤§æå‡