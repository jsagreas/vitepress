---
title: 2ã€è‡ªåŠ¨åŒ–æµ‹è¯•é›†æˆ
---
## ğŸ“š ç›®å½•

1. [è‡ªåŠ¨åŒ–æµ‹è¯•åŸºç¡€æ¦‚å¿µ](#1-è‡ªåŠ¨åŒ–æµ‹è¯•åŸºç¡€æ¦‚å¿µ)
2. [å•å…ƒæµ‹è¯•é…ç½®](#2-å•å…ƒæµ‹è¯•é…ç½®)
3. [é›†æˆæµ‹è¯•è®¾ç½®](#3-é›†æˆæµ‹è¯•è®¾ç½®)
4. [æµ‹è¯•æŠ¥å‘Šç”Ÿæˆ](#4-æµ‹è¯•æŠ¥å‘Šç”Ÿæˆ)
5. [ä»£ç è¦†ç›–ç‡æ”¶é›†](#5-ä»£ç è¦†ç›–ç‡æ”¶é›†)
6. [JUnitæŠ¥å‘Šè§£æ](#6-junitæŠ¥å‘Šè§£æ)
7. [æµ‹è¯•å¤±è´¥å¤„ç†ç­–ç•¥](#7-æµ‹è¯•å¤±è´¥å¤„ç†ç­–ç•¥)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ§ª è‡ªåŠ¨åŒ–æµ‹è¯•åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯è‡ªåŠ¨åŒ–æµ‹è¯•


**ç®€å•ç†è§£**ï¼šå°±åƒå·¥å‚é‡Œçš„è´¨æ£€å‘˜ï¼Œæ¯å½“æœ‰æ–°äº§å“ï¼ˆä»£ç ï¼‰å‡ºæ¥ï¼Œè‡ªåŠ¨æ£€æŸ¥æ˜¯å¦åˆæ ¼

```
ä¼ ç»Ÿæ‰‹å·¥æµ‹è¯•ï¼š
å¼€å‘è€…å†™ä»£ç  â†’ æ‰‹åŠ¨è¿è¡Œç¨‹åº â†’ æ‰‹åŠ¨ç‚¹å‡»æµ‹è¯• â†’ å‘ç°é—®é¢˜ â†’ ä¿®å¤

è‡ªåŠ¨åŒ–æµ‹è¯•ï¼š
å¼€å‘è€…å†™ä»£ç  â†’ è‡ªåŠ¨è¿è¡Œæµ‹è¯• â†’ è‡ªåŠ¨æ£€æŸ¥ç»“æœ â†’ è‡ªåŠ¨æŠ¥å‘Šé—®é¢˜
```

**ğŸ’¡ æ ¸å¿ƒä»·å€¼**
- **èŠ‚çœæ—¶é—´**ï¼šæµ‹è¯•è‡ªåŠ¨æ‰§è¡Œï¼Œä¸éœ€è¦äººå·¥é‡å¤æ“ä½œ
- **æé«˜è´¨é‡**ï¼šæ¯æ¬¡ä»£ç å˜æ›´éƒ½ä¼šè‡ªåŠ¨æµ‹è¯•ï¼Œé¿å…é—æ¼
- **å¿«é€Ÿåé¦ˆ**ï¼šå‡ åˆ†é’Ÿå†…å°±çŸ¥é“ä»£ç æœ‰æ²¡æœ‰é—®é¢˜
- **æŒç»­ä¿éšœ**ï¼šç¡®ä¿æ–°åŠŸèƒ½ä¸ä¼šç ´ååŸæœ‰åŠŸèƒ½

### 1.2 æµ‹è¯•çš„å±‚æ¬¡åˆ’åˆ†


**ğŸ—ï¸ æµ‹è¯•é‡‘å­—å¡”**
```
        UIæµ‹è¯•ï¼ˆå°‘é‡ï¼‰
       /             \
    é›†æˆæµ‹è¯•ï¼ˆé€‚é‡ï¼‰
   /                   \
 å•å…ƒæµ‹è¯•ï¼ˆå¤§é‡ï¼‰
```

**ğŸ“‹ å„å±‚æ¬¡è¯¦è§£**

| æµ‹è¯•ç±»å‹ | **ä½œç”¨** | **ç‰¹ç‚¹** | **ä¸¾ä¾‹** |
|---------|---------|---------|---------|
| ğŸ”¬ **å•å…ƒæµ‹è¯•** | `æµ‹è¯•æœ€å°ä»£ç å•å…ƒ` | `å¿«é€Ÿã€ç¨³å®šã€æˆæœ¬ä½` | `æµ‹è¯•ä¸€ä¸ªå‡½æ•°æ˜¯å¦æ­£ç¡®è®¡ç®—` |
| ğŸ”— **é›†æˆæµ‹è¯•** | `æµ‹è¯•æ¨¡å—é—´åä½œ` | `ä¸­ç­‰é€Ÿåº¦ã€å‘ç°æ¥å£é—®é¢˜` | `æµ‹è¯•ç™»å½•åŠŸèƒ½æ•´ä¸ªæµç¨‹` |
| ğŸ–¥ï¸ **UIæµ‹è¯•** | `æµ‹è¯•ç”¨æˆ·ç•Œé¢` | `æ…¢é€Ÿã€å®¹æ˜“å‡ºé”™ã€æˆæœ¬é«˜` | `æµ‹è¯•ç”¨æˆ·ç‚¹å‡»æŒ‰é’®çš„ååº”` |

### 1.3 GitLab CI/CDä¸­çš„æµ‹è¯•ä½ç½®


**ğŸ”„ CI/CDæµç¨‹å›¾**
```
ä»£ç æäº¤ â†’ è‡ªåŠ¨æ„å»º â†’ è‡ªåŠ¨æµ‹è¯• â†’ è‡ªåŠ¨éƒ¨ç½²
    â†“         â†“         â†“         â†“
  Git Push   ç¼–è¯‘ä»£ç    è¿è¡Œæµ‹è¯•   å‘å¸ƒåº”ç”¨
             æ‰“åŒ…èµ„æº   ç”ŸæˆæŠ¥å‘Š   æ›´æ–°æœåŠ¡
```

**æµ‹è¯•åœ¨å“ªé‡Œå‘ç”Ÿ**ï¼š
- **Pushé˜¶æ®µ**ï¼šæ¯æ¬¡ä»£ç æäº¤åè‡ªåŠ¨è§¦å‘
- **Mergeé˜¶æ®µ**ï¼šåˆå¹¶ä»£ç å‰å¿…é¡»é€šè¿‡æµ‹è¯•
- **éƒ¨ç½²å‰**ï¼šç¡®ä¿è¦å‘å¸ƒçš„ä»£ç è´¨é‡åˆæ ¼

---

## 2. ğŸ”¬ å•å…ƒæµ‹è¯•é…ç½®


### 2.1 å•å…ƒæµ‹è¯•æ˜¯ä»€ä¹ˆ


**é€šä¿—è§£é‡Š**ï¼šå•å…ƒæµ‹è¯•å°±åƒæ£€æŸ¥é›¶ä»¶è´¨é‡ï¼Œæ¯ä¸ªé›¶ä»¶ï¼ˆå‡½æ•°ï¼‰éƒ½è¦å•ç‹¬æ£€æŸ¥æ˜¯å¦å·¥ä½œæ­£å¸¸

```javascript
// è¢«æµ‹è¯•çš„å‡½æ•°ï¼ˆä¸€ä¸ªé›¶ä»¶ï¼‰
function add(a, b) {
  return a + b;
}

// æµ‹è¯•è¿™ä¸ªå‡½æ•°ï¼ˆæ£€æŸ¥é›¶ä»¶ï¼‰
test('åŠ æ³•å‡½æ•°æµ‹è¯•', () => {
  expect(add(2, 3)).toBe(5);     // æœŸæœ›2+3ç­‰äº5
  expect(add(-1, 1)).toBe(0);    // æœŸæœ›-1+1ç­‰äº0
});
```

### 2.2 åœ¨GitLab CIä¸­é…ç½®å•å…ƒæµ‹è¯•


**ğŸ“ åŸºç¡€é…ç½®ç¤ºä¾‹**

```yaml
# .gitlab-ci.yml
stages:
  - test
  - build

# å•å…ƒæµ‹è¯•ä»»åŠ¡
unit_test:
  stage: test
  image: node:18                    # ä½¿ç”¨Node.jsç¯å¢ƒ
  script:
    - npm install                   # å®‰è£…ä¾èµ–
    - npm run test                  # è¿è¡Œæµ‹è¯•
  artifacts:
    reports:
      junit: test-results.xml       # ä¿å­˜æµ‹è¯•æŠ¥å‘Š
```

### 2.3 ä¸åŒè¯­è¨€çš„å•å…ƒæµ‹è¯•é…ç½®


**ğŸ¯ Javaé¡¹ç›®ç¤ºä¾‹**
```yaml
java_unit_test:
  stage: test
  image: maven:3.8-openjdk-11
  script:
    - mvn clean test               # Mavenè¿è¡Œæµ‹è¯•
  artifacts:
    reports:
      junit: target/surefire-reports/*.xml
    paths:
      - target/                    # ä¿å­˜æ„å»ºç»“æœ
```

**ğŸ¯ Pythoné¡¹ç›®ç¤ºä¾‹**
```yaml
python_unit_test:
  stage: test
  image: python:3.9
  before_script:
    - pip install -r requirements.txt
  script:
    - python -m pytest tests/ --junitxml=report.xml
  artifacts:
    reports:
      junit: report.xml
```

### 2.4 å•å…ƒæµ‹è¯•æœ€ä½³å®è·µ


**ğŸ“Œ å…³é”®åŸåˆ™**
- **å¿«é€Ÿæ‰§è¡Œ**ï¼šå•ä¸ªæµ‹è¯•åº”è¯¥åœ¨æ¯«ç§’çº§å®Œæˆ
- **ç‹¬ç«‹è¿è¡Œ**ï¼šæµ‹è¯•ä¹‹é—´ä¸èƒ½ç›¸äº’ä¾èµ–
- **æ˜ç¡®æ–­è¨€**ï¼šæ¸…æ¥šåœ°æ£€æŸ¥æœŸæœ›ç»“æœ
- **è¦†ç›–è¾¹ç•Œ**ï¼šæµ‹è¯•æ­£å¸¸æƒ…å†µå’Œå¼‚å¸¸æƒ…å†µ

**ğŸ’¡ å®ç”¨æŠ€å·§**
```yaml
unit_test:
  stage: test
  script:
    - npm test
  only:
    - merge_requests              # åªåœ¨åˆå¹¶è¯·æ±‚æ—¶è¿è¡Œ
    - master                      # ä¸»åˆ†æ”¯å˜æ›´æ—¶è¿è¡Œ
  cache:
    paths:
      - node_modules/             # ç¼“å­˜ä¾èµ–ï¼ŒåŠ é€Ÿæ„å»º
```

---

## 3. ğŸ”— é›†æˆæµ‹è¯•è®¾ç½®


### 3.1 é›†æˆæµ‹è¯•çš„å«ä¹‰


**é€šä¿—ç†è§£**ï¼šå¦‚æœå•å…ƒæµ‹è¯•æ˜¯æ£€æŸ¥é›¶ä»¶ï¼Œé›†æˆæµ‹è¯•å°±æ˜¯æ£€æŸ¥é›¶ä»¶ç»„è£…åæ˜¯å¦èƒ½æ­£å¸¸å·¥ä½œ

```
å•å…ƒæµ‹è¯•ï¼šæ£€æŸ¥ç™»å½•æŒ‰é’®èƒ½å¦ç‚¹å‡»
é›†æˆæµ‹è¯•ï¼šæ£€æŸ¥ç‚¹å‡»ç™»å½•æŒ‰é’®åï¼Œæ•´ä¸ªç™»å½•æµç¨‹æ˜¯å¦æ­£å¸¸
         ï¼ˆå‰ç«¯ â†’ åç«¯ â†’ æ•°æ®åº“ â†’ è¿”å›ç»“æœï¼‰
```

### 3.2 é›†æˆæµ‹è¯•çš„é…ç½®æ–¹æ³•


**ğŸ› ï¸ åŸºç¡€é›†æˆæµ‹è¯•é…ç½®**
```yaml
integration_test:
  stage: test
  image: node:18
  services:
    - name: postgres:13           # å¯åŠ¨æ•°æ®åº“æœåŠ¡
      alias: postgres
    - name: redis:6-alpine        # å¯åŠ¨ç¼“å­˜æœåŠ¡
      alias: redis
  variables:
    POSTGRES_DB: test_db
    POSTGRES_USER: test_user
    POSTGRES_PASSWORD: test_pass
    DATABASE_URL: "postgresql://test_user:test_pass@postgres:5432/test_db"
  script:
    - npm install
    - npm run test:integration    # è¿è¡Œé›†æˆæµ‹è¯•
  artifacts:
    reports:
      junit: integration-results.xml
```

### 3.3 æ•°æ®åº“æµ‹è¯•é…ç½®


**ğŸ—„ï¸ æ•°æ®åº“ç›¸å…³æµ‹è¯•**
```yaml
database_test:
  stage: test
  image: python:3.9
  services:
    - name: mysql:8.0
      alias: mysql
  variables:
    MYSQL_ROOT_PASSWORD: rootpass
    MYSQL_DATABASE: testdb
    MYSQL_USER: testuser
    MYSQL_PASSWORD: testpass
  before_script:
    - pip install -r requirements.txt
    - sleep 30                    # ç­‰å¾…æ•°æ®åº“å¯åŠ¨
  script:
    - python manage.py migrate    # è¿è¡Œæ•°æ®åº“è¿ç§»
    - python manage.py test       # è¿è¡Œæ•°æ®åº“ç›¸å…³æµ‹è¯•
```

### 3.4 APIæ¥å£æµ‹è¯•


**ğŸŒ APIæµ‹è¯•ç¤ºä¾‹**
```yaml
api_test:
  stage: test
  image: postman/newman:latest    # ä½¿ç”¨Newmanå·¥å…·
  script:
    - newman run api_tests.json   # è¿è¡ŒPostmanæµ‹è¯•é›†åˆ
      --environment test_env.json
      --reporters cli,junit
      --reporter-junit-export results.xml
  artifacts:
    reports:
      junit: results.xml
```

---

## 4. ğŸ“Š æµ‹è¯•æŠ¥å‘Šç”Ÿæˆ


### 4.1 ä¸ºä»€ä¹ˆéœ€è¦æµ‹è¯•æŠ¥å‘Š


**å®ç”¨ä»·å€¼**ï¼š
- **å¯è§†åŒ–ç»“æœ**ï¼šæ¸…æ¥šçœ‹åˆ°å“ªäº›æµ‹è¯•é€šè¿‡ï¼Œå“ªäº›å¤±è´¥
- **è¿½è¸ªè¶‹åŠ¿**ï¼šäº†è§£ä»£ç è´¨é‡å˜åŒ–è¶‹åŠ¿
- **å›¢é˜Ÿåä½œ**ï¼šè®©å›¢é˜Ÿæˆå‘˜éƒ½èƒ½çœ‹åˆ°æµ‹è¯•çŠ¶æ€
- **é—®é¢˜å®šä½**ï¼šå¿«é€Ÿæ‰¾åˆ°å¤±è´¥çš„å…·ä½“åŸå› 

### 4.2 GitLabå†…ç½®æµ‹è¯•æŠ¥å‘Š


**ğŸ“ˆ æŠ¥å‘Šé…ç½®**
```yaml
test_with_reports:
  stage: test
  script:
    - npm test -- --reporter=xunit --outputFile=test-results.xml
  artifacts:
    reports:
      junit: test-results.xml     # JUnitæ ¼å¼æŠ¥å‘Š
    expire_in: 1 week             # æŠ¥å‘Šä¿å­˜ä¸€å‘¨
  coverage: '/Coverage: \d+\.\d+%/'  # æå–è¦†ç›–ç‡ä¿¡æ¯
```

### 4.3 è‡ªå®šä¹‰æµ‹è¯•æŠ¥å‘Š


**ğŸ¨ HTMLæŠ¥å‘Šç”Ÿæˆ**
```yaml
generate_html_report:
  stage: test
  script:
    - npm test
    - npm run test:report         # ç”ŸæˆHTMLæŠ¥å‘Š
  artifacts:
    paths:
      - coverage/                 # ä¿å­˜è¦†ç›–ç‡æŠ¥å‘Š
      - test-report.html         # ä¿å­˜HTMLæŠ¥å‘Š
    expire_in: 30 days
```

### 4.4 æŠ¥å‘ŠæŸ¥çœ‹æ–¹å¼


**ğŸ” åœ¨GitLabä¸­æŸ¥çœ‹**
1. **Pipelineé¡µé¢**ï¼šç›´æ¥æ˜¾ç¤ºæµ‹è¯•ç»“æœæ‘˜è¦
2. **Jobè¯¦æƒ…**ï¼šç‚¹å‡»å…·ä½“ä»»åŠ¡æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
3. **Merge Request**ï¼šåœ¨åˆå¹¶è¯·æ±‚ä¸­æ˜¾ç¤ºæµ‹è¯•çŠ¶æ€
4. **ä¸‹è½½æ–‡ä»¶**ï¼šä¸‹è½½è¯¦ç»†çš„æµ‹è¯•æŠ¥å‘Šæ–‡ä»¶

---

## 5. ğŸ“ˆ ä»£ç è¦†ç›–ç‡æ”¶é›†


### 5.1 ä»£ç è¦†ç›–ç‡æ˜¯ä»€ä¹ˆ


**ç®€å•ç†è§£**ï¼šä»£ç è¦†ç›–ç‡å°±åƒè€ƒè¯•çš„è€ƒç‚¹è¦†ç›–ç‡ï¼Œçœ‹ä½ çš„æµ‹è¯•è¦†ç›–äº†å¤šå°‘ä»£ç 

```
å‡è®¾ä½ æœ‰100è¡Œä»£ç ï¼š
æµ‹è¯•è¿è¡Œæ—¶æ‰§è¡Œäº†80è¡Œä»£ç  â†’ è¦†ç›–ç‡80%
è¿˜æœ‰20è¡Œä»£ç æ²¡æœ‰è¢«æµ‹è¯•æ‰§è¡Œ â†’ å¯èƒ½å­˜åœ¨é£é™©
```

**ğŸ“Š è¦†ç›–ç‡ç±»å‹**
- **è¡Œè¦†ç›–ç‡**ï¼šæµ‹è¯•æ‰§è¡Œäº†å¤šå°‘è¡Œä»£ç 
- **å‡½æ•°è¦†ç›–ç‡**ï¼šæµ‹è¯•è°ƒç”¨äº†å¤šå°‘ä¸ªå‡½æ•°
- **åˆ†æ”¯è¦†ç›–ç‡**ï¼šæµ‹è¯•æ‰§è¡Œäº†å¤šå°‘ä¸ªif/elseåˆ†æ”¯

### 5.2 JavaScripté¡¹ç›®è¦†ç›–ç‡é…ç½®


**ğŸ”§ Jestè¦†ç›–ç‡é…ç½®**
```yaml
coverage_test:
  stage: test
  image: node:18
  script:
    - npm install
    - npm test -- --coverage      # è¿è¡Œæµ‹è¯•å¹¶æ”¶é›†è¦†ç›–ç‡
  artifacts:
    reports:
      coverage_report:
        coverage_format: cobertura
        path: coverage/cobertura-coverage.xml
    paths:
      - coverage/                  # ä¿å­˜è¦†ç›–ç‡HTMLæŠ¥å‘Š
  coverage: '/All files[^|]*\|[^|]*\s+([\d\.]+)/'  # æå–è¦†ç›–ç‡æ•°å­—
```

### 5.3 Javaé¡¹ç›®è¦†ç›–ç‡é…ç½®


**â˜• JaCoCoè¦†ç›–ç‡å·¥å…·**
```yaml
java_coverage:
  stage: test
  image: maven:3.8-openjdk-11
  script:
    - mvn clean test jacoco:report  # è¿è¡Œæµ‹è¯•å’Œè¦†ç›–ç‡
  artifacts:
    reports:
      junit: target/surefire-reports/*.xml
      coverage_report:
        coverage_format: jacoco
        path: target/site/jacoco/jacoco.xml
    paths:
      - target/site/jacoco/        # HTMLè¦†ç›–ç‡æŠ¥å‘Š
```

### 5.4 è¦†ç›–ç‡è´¨é‡é—¨ç¦


**ğŸšª è®¾ç½®è¦†ç›–ç‡é˜ˆå€¼**
```yaml
quality_gate:
  stage: test
  script:
    - npm test -- --coverage
    - npx coverage-threshold-check  # æ£€æŸ¥è¦†ç›–ç‡æ˜¯å¦è¾¾æ ‡
  coverage: '/All files[^|]*\|[^|]*\s+([\d\.]+)/'
  rules:
    - if: '$CI_PIPELINE_SOURCE == "merge_request_event"'
      when: always
```

**ğŸ“ è¦†ç›–ç‡æ ‡å‡†å»ºè®®**
- **æ–°é¡¹ç›®**ï¼šå»ºè®®80%ä»¥ä¸Šè¦†ç›–ç‡
- **å…³é”®åŠŸèƒ½**ï¼šè¦æ±‚95%ä»¥ä¸Šè¦†ç›–ç‡
- **é—ç•™ç³»ç»Ÿ**ï¼šé€æ­¥æå‡ï¼Œè®¾ç½®é€’å¢ç›®æ ‡

---

## 6. ğŸ“‹ JUnitæŠ¥å‘Šè§£æ


### 6.1 JUnitæŠ¥å‘Šæ ¼å¼è¯´æ˜


**ä»€ä¹ˆæ˜¯JUnit**ï¼šJUnitæ˜¯Javaä¸–ç•Œæœ€æµè¡Œçš„æµ‹è¯•æ¡†æ¶ï¼Œå®ƒçš„æŠ¥å‘Šæ ¼å¼å·²æˆä¸ºæµ‹è¯•æŠ¥å‘Šçš„é€šç”¨æ ‡å‡†

**ğŸ“„ JUnit XMLæ ¼å¼ç¤ºä¾‹**
```xml
<?xml version="1.0" encoding="UTF-8"?>
<testsuites>
  <testsuite name="ç”¨æˆ·ç™»å½•æµ‹è¯•" tests="3" failures="1" time="2.5">
    <testcase name="æ­£ç¡®å¯†ç ç™»å½•" time="0.8"/>
    <testcase name="é”™è¯¯å¯†ç ç™»å½•" time="0.9">
      <failure message="å¯†ç éªŒè¯å¤±è´¥">
        é¢„æœŸï¼šç™»å½•å¤±è´¥
        å®é™…ï¼šç³»ç»Ÿå¼‚å¸¸
      </failure>
    </testcase>
    <testcase name="ç©ºå¯†ç ç™»å½•" time="0.8"/>
  </testsuite>
</testsuites>
```

### 6.2 GitLabä¸­çš„JUnité›†æˆ


**ğŸ”§ é…ç½®JUnitæŠ¥å‘Š**
```yaml
test_with_junit:
  stage: test
  script:
    - python -m pytest --junitxml=report.xml
  artifacts:
    reports:
      junit: report.xml           # GitLabè‡ªåŠ¨è§£æè¿™ä¸ªæ–‡ä»¶
```

**ğŸ“Š GitLabæ˜¾ç¤ºæ•ˆæœ**
- **Pipelineé¡µé¢**ï¼šæ˜¾ç¤ºæµ‹è¯•æ€»æ•°ã€é€šè¿‡æ•°ã€å¤±è´¥æ•°
- **Jobé¡µé¢**ï¼šæ˜¾ç¤ºæ¯ä¸ªæµ‹è¯•çš„è¯¦ç»†ç»“æœ
- **Merge Request**ï¼šé˜»æ­¢æœ‰å¤±è´¥æµ‹è¯•çš„ä»£ç åˆå¹¶

### 6.3 ä¸åŒè¯­è¨€ç”ŸæˆJUnitæŠ¥å‘Š


**ğŸ¯ å¤šè¯­è¨€ç¤ºä¾‹å¯¹æ¯”**

| è¯­è¨€ | **å·¥å…·** | **å‘½ä»¤ç¤ºä¾‹** |
|------|---------|-------------|
| **Java** | `Maven Surefire` | `mvn test` |
| **Python** | `pytest` | `pytest --junitxml=report.xml` |
| **JavaScript** | `Jest` | `jest --reporters=jest-junit` |
| **Go** | `go-junit-report` | `go test -v | go-junit-report > report.xml` |
| **C#** | `dotnet test` | `dotnet test --logger "junit;LogFilePath=report.xml"` |

---

## 7. ğŸ› ï¸ æµ‹è¯•å¤±è´¥å¤„ç†ç­–ç•¥


### 7.1 æµ‹è¯•å¤±è´¥çš„å¸¸è§åŸå› 


**ğŸ” å¤±è´¥åŸå› åˆ†æ**
```
æµ‹è¯•ç¯å¢ƒé—®é¢˜ï¼š
- ä¾èµ–æœåŠ¡æœªå¯åŠ¨ï¼ˆæ•°æ®åº“ã€Redisç­‰ï¼‰
- ç½‘ç»œè¿æ¥é—®é¢˜
- ç¯å¢ƒå˜é‡é…ç½®é”™è¯¯

ä»£ç è´¨é‡é—®é¢˜ï¼š
- æ–°åŠŸèƒ½å¼•å…¥äº†Bug
- ä¿®æ”¹ç ´åäº†åŸæœ‰åŠŸèƒ½
- æµ‹è¯•ç”¨ä¾‹æœ¬èº«æœ‰é—®é¢˜

å¤–éƒ¨ä¾èµ–é—®é¢˜ï¼š
- ç¬¬ä¸‰æ–¹APIä¸å¯ç”¨
- ä¾èµ–åŒ…ç‰ˆæœ¬å†²çª
- ç³»ç»Ÿèµ„æºä¸è¶³
```

### 7.2 è‡ªåŠ¨é‡è¯•æœºåˆ¶


**ğŸ”„ é…ç½®æµ‹è¯•é‡è¯•**
```yaml
flaky_test:
  stage: test
  script:
    - npm test
  retry:
    max: 2                        # æœ€å¤šé‡è¯•2æ¬¡
    when:
      - runner_system_failure     # ç³»ç»Ÿæ•…éšœæ—¶é‡è¯•
      - stuck_or_timeout_failure  # è¶…æ—¶æ—¶é‡è¯•
```

### 7.3 æµ‹è¯•å¤±è´¥é€šçŸ¥


**ğŸ“¢ é…ç½®å¤±è´¥é€šçŸ¥**
```yaml
test_with_notification:
  stage: test
  script:
    - npm test
  after_script:
    - |
      if [ $CI_JOB_STATUS == "failed" ]; then
        curl -X POST "https://hooks.slack.com/xxx" \
        -d '{"text":"æµ‹è¯•å¤±è´¥: '$CI_PROJECT_NAME' - '$CI_COMMIT_TITLE'"}'
      fi
```

### 7.4 å¤±è´¥åˆ†æå’Œå¤„ç†æµç¨‹


**ğŸ“‹ å¤„ç†æ­¥éª¤**
1. **æŸ¥çœ‹æ—¥å¿—**ï¼šæ£€æŸ¥å¤±è´¥çš„å…·ä½“é”™è¯¯ä¿¡æ¯
2. **æœ¬åœ°å¤ç°**ï¼šåœ¨æœ¬åœ°ç¯å¢ƒå°è¯•é‡ç°é—®é¢˜
3. **ç¡®å®šåŸå› **ï¼šæ˜¯ä»£ç é—®é¢˜è¿˜æ˜¯ç¯å¢ƒé—®é¢˜
4. **å¿«é€Ÿä¿®å¤**ï¼šä¼˜å…ˆä¿®å¤é˜»å¡æ€§é—®é¢˜
5. **æ·»åŠ æµ‹è¯•**ï¼šä¸ºä¿®å¤çš„Bugæ·»åŠ å¯¹åº”æµ‹è¯•

**ğŸ¯ å¿«é€Ÿè¯Šæ–­æŠ€å·§**
```yaml
debug_test:
  stage: test
  script:
    - echo "=== ç¯å¢ƒä¿¡æ¯ ==="
    - node --version              # æ£€æŸ¥ç¯å¢ƒç‰ˆæœ¬
    - npm --version
    - echo "=== ä¾èµ–çŠ¶æ€ ==="
    - npm list --depth=0         # æ£€æŸ¥ä¾èµ–å®‰è£…æƒ…å†µ
    - echo "=== è¿è¡Œæµ‹è¯• ==="
    - npm test                   # è¿è¡Œæµ‹è¯•
  artifacts:
    when: always                 # æ— è®ºæˆåŠŸå¤±è´¥éƒ½ä¿å­˜æ—¥å¿—
    paths:
      - npm-debug.log
      - test-output.log
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ¯ è‡ªåŠ¨åŒ–æµ‹è¯•æœ¬è´¨**
- è‡ªåŠ¨åŒ–æµ‹è¯•æ˜¯ä»£ç è´¨é‡çš„å®ˆé—¨å‘˜
- é€šè¿‡CI/CDè‡ªåŠ¨æ‰§è¡Œï¼ŒåŠæ—¶å‘ç°é—®é¢˜
- æµ‹è¯•é‡‘å­—å¡”ï¼šå•å…ƒæµ‹è¯•ä¸ºä¸»ï¼Œé›†æˆæµ‹è¯•ä¸ºè¾…ï¼ŒUIæµ‹è¯•ç‚¹ç¼€

**ğŸ“Š GitLab CI/CDæµ‹è¯•é›†æˆ**
- ä½¿ç”¨`artifacts.reports.junit`é›†æˆæµ‹è¯•æŠ¥å‘Š
- é€šè¿‡`coverage`æ­£åˆ™è¡¨è¾¾å¼æå–è¦†ç›–ç‡
- é…ç½®`services`æä¾›æµ‹è¯•æ‰€éœ€çš„å¤–éƒ¨ä¾èµ–

### 8.2 å®ç”¨é…ç½®æ¨¡æ¿


**ğŸ”§ é€šç”¨æµ‹è¯•é…ç½®**
```yaml
test_template:
  stage: test
  image: node:18
  services:
    - postgres:13
  variables:
    NODE_ENV: test
  before_script:
    - npm ci                     # å®‰è£…ä¾èµ–
  script:
    - npm run test:unit          # å•å…ƒæµ‹è¯•
    - npm run test:integration   # é›†æˆæµ‹è¯•
  artifacts:
    reports:
      junit: test-results.xml
      coverage_report:
        coverage_format: cobertura
        path: coverage/cobertura-coverage.xml
    paths:
      - coverage/
    expire_in: 1 week
  coverage: '/All files[^|]*\|[^|]*\s+([\d\.]+)/'
```

### 8.3 å…³é”®æˆåŠŸè¦ç´ 


**âœ… æµ‹è¯•ç­–ç•¥**
- **åˆ†å±‚æµ‹è¯•**ï¼šå•å…ƒæµ‹è¯•ä¿è¯åŸºç¡€è´¨é‡ï¼Œé›†æˆæµ‹è¯•éªŒè¯åŠŸèƒ½å®Œæ•´æ€§
- **å¿«é€Ÿåé¦ˆ**ï¼šå•å…ƒæµ‹è¯•è¦ç§’çº§å®Œæˆï¼Œé›†æˆæµ‹è¯•æ§åˆ¶åœ¨å‡ åˆ†é’Ÿå†…
- **ç¨³å®šå¯é **ï¼šå‡å°‘ä¸ç¨³å®šæµ‹è¯•ï¼Œé¿å…è¯¯æŠ¥å½±å“å¼€å‘æ•ˆç‡

**ğŸ¯ å›¢é˜Ÿåä½œ**
- **æµ‹è¯•æ–‡åŒ–**ï¼šè®©ç¼–å†™æµ‹è¯•æˆä¸ºå¼€å‘ä¹ æƒ¯
- **ä»£ç è¦†ç›–ç‡**ï¼šè®¾ç½®åˆç†çš„è¦†ç›–ç‡ç›®æ ‡å¹¶æŒç»­æ”¹è¿›
- **å¤±è´¥å¤„ç†**ï¼šå»ºç«‹å¿«é€Ÿå“åº”å’Œä¿®å¤æœºåˆ¶

### 8.4 å¸¸è§é—®é¢˜è§£å†³


**âŒ é¿å…çš„è¯¯åŒº**
- ä¸è¦æŠŠæ‰€æœ‰æµ‹è¯•éƒ½å†™æˆé›†æˆæµ‹è¯•ï¼ˆå¤ªæ…¢ï¼‰
- ä¸è¦å¿½ç•¥æµ‹è¯•ç¯å¢ƒçš„ç¨³å®šæ€§å»ºè®¾
- ä¸è¦ä¸ºäº†è¦†ç›–ç‡è€Œå†™æ— æ„ä¹‰çš„æµ‹è¯•

**ğŸ’¡ å®è·µå»ºè®®**
- ä¼˜å…ˆç¼–å†™æ ¸å¿ƒä¸šåŠ¡é€»è¾‘çš„å•å…ƒæµ‹è¯•
- ä¸ºé‡è¦çš„ç”¨æˆ·æµç¨‹ç¼–å†™é›†æˆæµ‹è¯•
- å»ºç«‹æµ‹è¯•æ•°æ®ç®¡ç†å’Œæ¸…ç†æœºåˆ¶
- å®šæœŸreviewå’Œé‡æ„æµ‹è¯•ä»£ç 

**æ ¸å¿ƒè®°å¿†**ï¼š
- è‡ªåŠ¨åŒ–æµ‹è¯•æ˜¯CI/CDçš„è´¨é‡ä¿éšœï¼Œé€šè¿‡é…ç½®è®©GitLabè‡ªåŠ¨è¿è¡Œæµ‹è¯•ã€ç”ŸæˆæŠ¥å‘Šã€æ”¶é›†è¦†ç›–ç‡
- æµ‹è¯•å¤±è´¥è¦å¿«é€Ÿå®šä½åŸå› ï¼Œå»ºç«‹é‡è¯•å’Œé€šçŸ¥æœºåˆ¶
- å¥½çš„æµ‹è¯•ç­–ç•¥æ˜¯å¿«é€Ÿã€ç¨³å®šã€åˆ†å±‚çš„ï¼Œé‡ç‚¹ä¿éšœæ ¸å¿ƒåŠŸèƒ½è´¨é‡