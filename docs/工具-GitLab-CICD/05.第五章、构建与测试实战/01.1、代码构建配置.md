---
title: 1ã€ä»£ç æ„å»ºé…ç½®
---
## ğŸ“š ç›®å½•

1. [æ„å»ºé…ç½®åŸºç¡€æ¦‚å¿µ](#1-æ„å»ºé…ç½®åŸºç¡€æ¦‚å¿µ)
2. [ç¼–è¯‘ç¯å¢ƒå‡†å¤‡](#2-ç¼–è¯‘ç¯å¢ƒå‡†å¤‡)
3. [æ„å»ºè„šæœ¬ç¼–å†™](#3-æ„å»ºè„šæœ¬ç¼–å†™)
4. [Javaé¡¹ç›®æ„å»º](#4-Javaé¡¹ç›®æ„å»º)
5. [å‰ç«¯é¡¹ç›®æ„å»º](#5-å‰ç«¯é¡¹ç›®æ„å»º)
6. [æ„å»ºäº§ç‰©æ”¶é›†](#6-æ„å»ºäº§ç‰©æ”¶é›†)
7. [æ„å»ºä¼˜åŒ–æŠ€å·§](#7-æ„å»ºä¼˜åŒ–æŠ€å·§)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ—ï¸ æ„å»ºé…ç½®åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯ä»£ç æ„å»º


**æ„å»ºçš„æœ¬è´¨**ï¼šæŠŠä½ å†™çš„æºä»£ç è½¬æ¢æˆå¯ä»¥è¿è¡Œçš„ç¨‹åº

```
æºä»£ç  â†’ ç¼–è¯‘/æ‰“åŒ… â†’ å¯æ‰§è¡Œç¨‹åº
  â†“         â†“           â†“
Javaæ–‡ä»¶   javacç¼–è¯‘   jaråŒ…
JSæ–‡ä»¶     webpackæ‰“åŒ…  distæ–‡ä»¶å¤¹
```

**é€šä¿—ç†è§£**ï¼š
- å°±åƒåšèœä¸€æ ·ï¼Œ**æºä»£ç **æ˜¯é£Ÿæï¼Œ**æ„å»ºè¿‡ç¨‹**æ˜¯çƒ¹é¥ªï¼Œ**æœ€ç»ˆäº§ç‰©**æ˜¯å¯ä»¥åƒçš„èœ
- ä½ å†™çš„ä»£ç è®¡ç®—æœºä¸èƒ½ç›´æ¥ç†è§£ï¼Œéœ€è¦é€šè¿‡æ„å»ºè¿‡ç¨‹"ç¿»è¯‘"æˆè®¡ç®—æœºèƒ½è¿è¡Œçš„æ ¼å¼

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦è‡ªåŠ¨åŒ–æ„å»º


**ä¼ ç»Ÿæ‰‹åŠ¨æ„å»ºçš„é—®é¢˜**ï¼š
- ğŸ”´ **å®¹æ˜“å‡ºé”™** - æ¯æ¬¡æ‰‹åŠ¨æ“ä½œå¯èƒ½å¿˜è®°æ­¥éª¤
- ğŸ”´ **æ•ˆç‡ä½ä¸‹** - é‡å¤æ€§å·¥ä½œæµªè´¹æ—¶é—´  
- ğŸ”´ **ç¯å¢ƒä¸ä¸€è‡´** - ä¸åŒå¼€å‘è€…ç”µè„‘ç¯å¢ƒå·®å¼‚å¯¼è‡´æ„å»ºç»“æœä¸åŒ
- ğŸ”´ **éš¾ä»¥è¿½è¸ª** - ä¸çŸ¥é“å“ªæ¬¡æ„å»ºå‡ºäº†é—®é¢˜

**è‡ªåŠ¨åŒ–æ„å»ºçš„ä¼˜åŠ¿**ï¼š
- âœ… **æ ‡å‡†åŒ–æµç¨‹** - æ¯æ¬¡æ„å»ºéƒ½æŒ‰ç›¸åŒæ­¥éª¤æ‰§è¡Œ
- âœ… **æé«˜æ•ˆç‡** - ä¸€é”®è§¦å‘ï¼Œæ— éœ€äººå·¥å¹²é¢„
- âœ… **ç¯å¢ƒä¸€è‡´** - åœ¨æ ‡å‡†å®¹å™¨ç¯å¢ƒä¸­æ„å»º
- âœ… **å¯è¿½æº¯æ€§** - è¯¦ç»†çš„æ„å»ºæ—¥å¿—å’Œå†å²è®°å½•

### 1.3 GitLab CI/CDä¸­çš„æ„å»º


**æ„å»ºåœ¨CI/CDä¸­çš„ä½ç½®**ï¼š

```
ä»£ç æäº¤ â†’ ğŸ”æ£€æŸ¥ â†’ ğŸ—ï¸æ„å»º â†’ ğŸ§ªæµ‹è¯• â†’ ğŸš€éƒ¨ç½²
          â†“        â†“        â†“       â†“
        è¯­æ³•æ£€æŸ¥   ç¼–è¯‘æ‰“åŒ…  å•å…ƒæµ‹è¯•  å‘å¸ƒä¸Šçº¿
```

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
- **Pipelineï¼ˆæµæ°´çº¿ï¼‰**ï¼šæ•´ä¸ªCI/CDæµç¨‹
- **Jobï¼ˆä»»åŠ¡ï¼‰**ï¼šæµæ°´çº¿ä¸­çš„å…·ä½“å·¥ä½œï¼Œæ¯”å¦‚æ„å»ºä»»åŠ¡
- **Stageï¼ˆé˜¶æ®µï¼‰**ï¼šå°†ç›¸å…³ä»»åŠ¡åˆ†ç»„ï¼Œæ¯”å¦‚æ„å»ºé˜¶æ®µã€æµ‹è¯•é˜¶æ®µ
- **Runnerï¼ˆè¿è¡Œå™¨ï¼‰**ï¼šæ‰§è¡Œä»»åŠ¡çš„æœºå™¨

---

## 2. ğŸ”§ ç¼–è¯‘ç¯å¢ƒå‡†å¤‡


### 2.1 Dockeré•œåƒé€‰æ‹©


**ä¸ºä»€ä¹ˆç”¨Docker**ï¼š
- ğŸ“¦ **ç¯å¢ƒéš”ç¦»** - æ¯æ¬¡æ„å»ºéƒ½åœ¨å¹²å‡€çš„ç¯å¢ƒä¸­è¿›è¡Œ
- ğŸ”„ **å¯é‡å¤** - ä»»ä½•äººä»»ä½•æ—¶å€™æ„å»ºç»“æœéƒ½ä¸€æ ·
- âš¡ **å¿«é€Ÿå¯åŠ¨** - é¢„é…ç½®çš„é•œåƒå‡ ç§’é’Ÿå°±èƒ½å¯åŠ¨

**å¸¸ç”¨åŸºç¡€é•œåƒ**ï¼š

| é¡¹ç›®ç±»å‹ | æ¨èé•œåƒ | è¯´æ˜ |
|---------|---------|------|
| **Javaé¡¹ç›®** | `openjdk:11` | åŒ…å«Java 11è¿è¡Œç¯å¢ƒ |
| **Node.jsé¡¹ç›®** | `node:16-alpine` | è½»é‡çº§Node.jsç¯å¢ƒ |
| **Pythoné¡¹ç›®** | `python:3.9-slim` | ç²¾ç®€Pythonç¯å¢ƒ |
| **é€šç”¨é¡¹ç›®** | `ubuntu:20.04` | é€šç”¨Linuxç¯å¢ƒ |

**é€‰æ‹©é•œåƒçš„åŸåˆ™**ï¼š
- ğŸ¯ **å¤Ÿç”¨å°±å¥½** - ä¸è¦é€‰æ‹©è¿‡äºåºå¤§çš„é•œåƒ
- âš¡ **ä¼˜å…ˆå®˜æ–¹** - å®˜æ–¹é•œåƒæ›´ç¨³å®šæ›´å®‰å…¨
- ğŸ·ï¸ **å›ºå®šç‰ˆæœ¬** - é¿å…ç”¨`latest`æ ‡ç­¾ï¼Œç¡®ä¿æ„å»ºç¨³å®š

### 2.2 ç¯å¢ƒé…ç½®ç¤ºä¾‹


**åŸºç¡€ç¯å¢ƒé…ç½®**ï¼š

```yaml
# .gitlab-ci.yml åŸºç¡€ç»“æ„
image: node:16-alpine  # æŒ‡å®šè¿è¡Œç¯å¢ƒ

variables:
  NODE_ENV: production   # è®¾ç½®ç¯å¢ƒå˜é‡

before_script:
  - echo "å¼€å§‹å‡†å¤‡æ„å»ºç¯å¢ƒ..."
  - node --version      # æ£€æŸ¥ç¯å¢ƒ
  - npm --version
```

**å¤šç¯å¢ƒé€‚é…**ï¼š

```yaml
# ä¸åŒä»»åŠ¡ä½¿ç”¨ä¸åŒç¯å¢ƒ
stages:
  - build
  - test

java_build:
  stage: build
  image: openjdk:11
  script:
    - ./gradlew build

frontend_build:
  stage: build  
  image: node:16-alpine
  script:
    - npm run build
```

### 2.3 ç¼“å­˜é…ç½®


**ä¸ºä»€ä¹ˆéœ€è¦ç¼“å­˜**ï¼š
- â° **èŠ‚çœæ—¶é—´** - é¿å…é‡å¤ä¸‹è½½ä¾èµ–åŒ…
- ğŸ’° **èŠ‚çº¦èµ„æº** - å‡å°‘ç½‘ç»œå¸¦å®½ä½¿ç”¨
- ğŸš€ **æå‡ä½“éªŒ** - æ„å»ºé€Ÿåº¦æ›´å¿«

**ç¼“å­˜é…ç½®ç¤ºä¾‹**ï¼š

```yaml
# Node.jsé¡¹ç›®ç¼“å­˜
variables:
  npm_config_cache: "$CI_PROJECT_DIR/.npm"

cache:
  key: "$CI_COMMIT_REF_SLUG"  # ç¼“å­˜é”®å
  paths:
    - .npm/                   # ç¼“å­˜npmåŒ…
    - node_modules/           # ç¼“å­˜ä¾èµ–æ–‡ä»¶å¤¹

build:
  script:
    - npm ci --cache .npm     # ä½¿ç”¨ç¼“å­˜å®‰è£…ä¾èµ–
    - npm run build
```

---

## 3. ğŸ“ æ„å»ºè„šæœ¬ç¼–å†™


### 3.1 è„šæœ¬ç¼–å†™åŸºç¡€


**è„šæœ¬çš„ä½œç”¨**ï¼š
- å‘Šè¯‰CI/CDç³»ç»Ÿå…·ä½“è¦æ‰§è¡Œå“ªäº›å‘½ä»¤
- å°±åƒç»™ç”µè„‘å†™äº†ä¸€ä¸ªè¯¦ç»†çš„æ“ä½œè¯´æ˜ä¹¦

**åŸºæœ¬è¯­æ³•ç»“æ„**ï¼š

```yaml
job_name:           # ä»»åŠ¡åç§°
  stage: build      # æ‰€å±é˜¶æ®µ
  script:           # è¦æ‰§è¡Œçš„å‘½ä»¤
    - echo "å¼€å§‹æ„å»º"
    - npm install
    - npm run build
  artifacts:        # æ„å»ºäº§ç‰©
    paths:
      - dist/
```

### 3.2 å¸¸ç”¨è„šæœ¬æ¨¡å¼


**æ£€æŸ¥å¼è„šæœ¬**ï¼š

```yaml
check_environment:
  script:
    - echo "æ£€æŸ¥ç¯å¢ƒä¿¡æ¯..."
    - echo "Nodeç‰ˆæœ¬: $(node --version)"
    - echo "NPMç‰ˆæœ¬: $(npm --version)"
    - echo "å½“å‰ç›®å½•: $(pwd)"
    - ls -la  # æŸ¥çœ‹æ–‡ä»¶åˆ—è¡¨
```

**æ¡ä»¶å¼è„šæœ¬**ï¼š

```yaml
conditional_build:
  script:
    - |
      if [ "$CI_COMMIT_BRANCH" = "main" ]; then
        echo "ä¸»åˆ†æ”¯æ„å»ºï¼Œæ‰§è¡Œå®Œæ•´æ„å»º..."
        npm run build:production
      else
        echo "å¼€å‘åˆ†æ”¯æ„å»ºï¼Œæ‰§è¡Œå¿«é€Ÿæ„å»º..."
        npm run build:dev
      fi
```

**é”™è¯¯å¤„ç†è„šæœ¬**ï¼š

```yaml
safe_build:
  script:
    - echo "å¼€å§‹å®‰å…¨æ„å»º..."
    - npm install || (echo "ä¾èµ–å®‰è£…å¤±è´¥" && exit 1)
    - npm run test || (echo "æµ‹è¯•å¤±è´¥" && exit 1)  
    - npm run build || (echo "æ„å»ºå¤±è´¥" && exit 1)
    - echo "æ„å»ºæˆåŠŸå®Œæˆ!"
```

### 3.3 è„šæœ¬æœ€ä½³å®è·µ


**ğŸ“‹ ç¼–å†™åŸåˆ™**ï¼š
- **ç®€å•æ˜äº†** - æ¯ä¸ªå‘½ä»¤éƒ½æœ‰æ˜ç¡®ç›®çš„
- **é”™è¯¯å‹å¥½** - å‡ºé”™æ—¶èƒ½ç»™å‡ºæœ‰ç”¨çš„æç¤ºä¿¡æ¯
- **å¯è°ƒè¯•** - æ·»åŠ é€‚å½“çš„æ—¥å¿—è¾“å‡º
- **å¯å¤ç”¨** - ç›¸åŒé€»è¾‘å¯ä»¥æŠ½å–æˆæ¨¡æ¿

**ğŸ” è°ƒè¯•æŠ€å·§**ï¼š

```yaml
debug_build:
  script:
    - echo "=== æ„å»ºå¼€å§‹ ==="
    - echo "åˆ†æ”¯: $CI_COMMIT_BRANCH"
    - echo "æäº¤: $CI_COMMIT_SHA"
    - echo "=== å®‰è£…ä¾èµ– ==="
    - npm install
    - echo "=== å¼€å§‹æ„å»º ==="
    - npm run build
    - echo "=== æ„å»ºå®Œæˆ ==="
    - ls -la dist/  # æ£€æŸ¥æ„å»ºç»“æœ
```

---

## 4. â˜• Javaé¡¹ç›®æ„å»º


### 4.1 Mavené¡¹ç›®æ„å»º


**Mavenæ˜¯ä»€ä¹ˆ**ï¼š
- Javaé¡¹ç›®çš„**ä¾èµ–ç®¡ç†å·¥å…·**å’Œ**æ„å»ºå·¥å…·**
- å°±åƒæ˜¯Javaé¡¹ç›®çš„"é¡¹ç›®ç»ç†"ï¼Œç®¡ç†é¡¹ç›®éœ€è¦çš„æ‰€æœ‰å¤–éƒ¨åº“

**åŸºç¡€Mavenæ„å»º**ï¼š

```yaml
# Mavené¡¹ç›®æ„å»ºé…ç½®
image: maven:3.8-openjdk-11

variables:
  MAVEN_OPTS: "-Dmaven.repo.local=$CI_PROJECT_DIR/.m2/repository"

cache:
  paths:
    - .m2/repository/  # ç¼“å­˜Mavenä¾èµ–

maven_build:
  stage: build
  script:
    - echo "å¼€å§‹Mavenæ„å»º..."
    - mvn clean compile  # æ¸…ç†å¹¶ç¼–è¯‘
    - mvn test          # è¿è¡Œæµ‹è¯•
    - mvn package       # æ‰“åŒ…æˆjar
  artifacts:
    reports:
      junit: target/surefire-reports/TEST-*.xml
    paths:
      - target/*.jar    # ä¿å­˜æ„å»ºäº§ç‰©
```

**å¤šç¯å¢ƒMavenæ„å»º**ï¼š

```yaml
# å¼€å‘ç¯å¢ƒæ„å»º
maven_dev:
  script:
    - mvn clean package -Pdev  # ä½¿ç”¨devé…ç½®æ–‡ä»¶
  only:
    - develop

# ç”Ÿäº§ç¯å¢ƒæ„å»º  
maven_prod:
  script:
    - mvn clean package -Pprod -DskipTests  # ç”Ÿäº§ç¯å¢ƒè·³è¿‡æµ‹è¯•
  only:
    - main
```

### 4.2 Gradleé¡¹ç›®æ„å»º


**Gradleæ˜¯ä»€ä¹ˆ**ï¼š
- å¦ä¸€ç§Javaæ„å»ºå·¥å…·ï¼Œæ¯”Mavenæ›´çµæ´»
- ç”¨Groovyæˆ–Kotlinè¯­è¨€å†™é…ç½®ï¼Œæ¯”XMLæ›´ç®€æ´

**åŸºç¡€Gradleæ„å»º**ï¼š

```yaml
# Gradleé¡¹ç›®æ„å»ºé…ç½®
image: gradle:7-jdk11

gradle_build:
  stage: build
  script:
    - echo "å¼€å§‹Gradleæ„å»º..."
    - ./gradlew clean build  # æ¸…ç†å¹¶æ„å»º
  artifacts:
    paths:
      - build/libs/*.jar     # ä¿å­˜jaræ–‡ä»¶
    reports:
      junit: build/test-results/test/TEST-*.xml
```

**Gradleæ„å»ºä¼˜åŒ–**ï¼š

```yaml
gradle_optimized:
  variables:
    GRADLE_OPTS: "-Dorg.gradle.daemon=false"  # ç¦ç”¨å®ˆæŠ¤è¿›ç¨‹
  cache:
    key: "$CI_COMMIT_REF_SLUG"
    paths:
      - .gradle/caches/      # ç¼“å­˜Gradleæ–‡ä»¶
      - gradle/wrapper/      # ç¼“å­˜GradleåŒ…è£…å™¨
  script:
    - ./gradlew --build-cache clean build  # ä½¿ç”¨æ„å»ºç¼“å­˜
```

### 4.3 Javaæ„å»ºå¸¸è§é—®é¢˜


**ğŸš¨ å†…å­˜ä¸è¶³é—®é¢˜**ï¼š

```yaml
java_build_memory:
  variables:
    MAVEN_OPTS: "-Xmx1024m -XX:MaxPermSize=256m"  # å¢åŠ å†…å­˜
    GRADLE_OPTS: "-Xmx1024m -Dfile.encoding=UTF-8"
```

**ğŸ”§ ç¼–ç é—®é¢˜è§£å†³**ï¼š

```yaml
java_encoding:
  variables:
    LANG: "en_US.UTF-8"      # è®¾ç½®ç³»ç»Ÿç¼–ç 
    LC_ALL: "en_US.UTF-8"
  before_script:
    - export JAVA_TOOL_OPTIONS="-Dfile.encoding=UTF-8"
```

---

## 5. ğŸŒ å‰ç«¯é¡¹ç›®æ„å»º


### 5.1 Node.jsåŸºç¡€æ„å»º


**npm vs yarn vs pnpmå¯¹æ¯”**ï¼š

| å·¥å…· | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| **npm** | å®˜æ–¹å·¥å…·ï¼Œç¨³å®šå¯é  | å¤§éƒ¨åˆ†é¡¹ç›®çš„é»˜è®¤é€‰æ‹© |
| **yarn** | é€Ÿåº¦å¿«ï¼Œé”æ–‡ä»¶ç²¾ç¡® | å¯¹ä¾èµ–ä¸€è‡´æ€§è¦æ±‚é«˜çš„é¡¹ç›® |
| **pnpm** | èŠ‚çœç£ç›˜ç©ºé—´ | å•ä½“ä»“åº“æˆ–ç£ç›˜ç©ºé—´å—é™ |

**åŸºç¡€npmæ„å»º**ï¼š

```yaml
# npmé¡¹ç›®æ„å»º
image: node:16-alpine

variables:
  npm_config_cache: "$CI_PROJECT_DIR/.npm"

cache:
  key: 
    files:
      - package-lock.json    # åŸºäºlockfileç¼“å­˜
  paths:
    - .npm/
    - node_modules/

npm_build:
  stage: build
  script:
    - echo "æ£€æŸ¥Nodeç¯å¢ƒ..."
    - node --version && npm --version
    - echo "å®‰è£…ä¾èµ–..."
    - npm ci --cache .npm --prefer-offline
    - echo "å¼€å§‹æ„å»º..."
    - npm run build
  artifacts:
    paths:
      - dist/              # æ„å»ºè¾“å‡ºç›®å½•
    expire_in: 1 hour      # äº§ç‰©ä¿ç•™æ—¶é—´
```

### 5.2 ç°ä»£å‰ç«¯æ¡†æ¶æ„å»º


**Vue.jsé¡¹ç›®æ„å»º**ï¼š

```yaml
vue_build:
  image: node:16-alpine
  script:
    - npm ci
    - npm run lint         # ä»£ç æ£€æŸ¥
    - npm run test:unit    # å•å…ƒæµ‹è¯•
    - npm run build        # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
  artifacts:
    paths:
      - dist/
```

**Reacté¡¹ç›®æ„å»º**ï¼š

```yaml
react_build:
  image: node:16-alpine
  script:
    - npm ci
    - npm run test -- --coverage --ci  # å¸¦è¦†ç›–ç‡çš„æµ‹è¯•
    - npm run build
  artifacts:
    paths:
      - build/           # Reactæ„å»ºè¾“å‡º
    reports:
      coverage_report:
        coverage_format: cobertura
        path: coverage/cobertura-coverage.xml
```

**Angularé¡¹ç›®æ„å»º**ï¼š

```yaml
angular_build:
  image: node:16-alpine
  script:
    - npm ci
    - npx ng lint         # Angularä»£ç æ£€æŸ¥
    - npx ng test --browsers=ChromeHeadless --watch=false
    - npx ng build --prod  # ç”Ÿäº§æ„å»º
  artifacts:
    paths:
      - dist/my-app/     # Angularè¾“å‡ºç›®å½•
```

### 5.3 å‰ç«¯æ„å»ºä¼˜åŒ–ç­–ç•¥


**ğŸš€ æ„å»ºé€Ÿåº¦ä¼˜åŒ–**ï¼š

```yaml
fast_frontend_build:
  image: node:16-alpine
  variables:
    npm_config_cache: "$CI_PROJECT_DIR/.npm"
    CYPRESS_CACHE_FOLDER: "$CI_PROJECT_DIR/cache/Cypress"
  cache:
    key: 
      files:
        - package-lock.json
    paths:
      - .npm/
      - node_modules/
      - cache/Cypress/      # ç¼“å­˜E2Eæµ‹è¯•å·¥å…·
  script:
    - npm ci --cache .npm --prefer-offline  # ä¼˜å…ˆä½¿ç”¨ç¼“å­˜
    - npm run build
  parallel: 2             # å¹¶è¡Œæ„å»ºå¤šä¸ªç‰ˆæœ¬
```

**ğŸ“¦ å¤šç¯å¢ƒæ„å»º**ï¼š

```yaml
# å¼€å‘ç¯å¢ƒæ„å»º
build_dev:
  script:
    - npm run build:dev
  environment:
    name: development
  only:
    - develop

# ç”Ÿäº§ç¯å¢ƒæ„å»º
build_prod:
  script:
    - npm run build:prod
  environment:
    name: production
  only:
    - main
```

---

## 6. ğŸ“¦ æ„å»ºäº§ç‰©æ”¶é›†


### 6.1 ä»€ä¹ˆæ˜¯æ„å»ºäº§ç‰©


**æ„å»ºäº§ç‰©ï¼ˆArtifactsï¼‰**ï¼š
- æ„å»ºè¿‡ç¨‹ç”Ÿæˆçš„**æœ‰ç”¨æ–‡ä»¶**ï¼Œæ¯”å¦‚ç¼–è¯‘åçš„ç¨‹åºã€æµ‹è¯•æŠ¥å‘Šç­‰
- å°±åƒå·¥å‚ç”Ÿäº§çš„æœ€ç»ˆ**äº§å“**ï¼Œéœ€è¦ä¿å­˜èµ·æ¥ä¾›åç»­ä½¿ç”¨

**å¸¸è§æ„å»ºäº§ç‰©ç±»å‹**ï¼š

```
ğŸ“ å¯æ‰§è¡Œæ–‡ä»¶
  â”œâ”€â”€ *.jar        (Javaåº”ç”¨)
  â”œâ”€â”€ *.war        (Webåº”ç”¨)  
  â”œâ”€â”€ dist/        (å‰ç«¯èµ„æº)
  â””â”€â”€ *.exe        (å¯æ‰§è¡Œç¨‹åº)

ğŸ“Š æŠ¥å‘Šæ–‡ä»¶
  â”œâ”€â”€ æµ‹è¯•æŠ¥å‘Š     (JUnit, Coverage)
  â”œâ”€â”€ ä»£ç è´¨é‡æŠ¥å‘Š (SonarQube)
  â””â”€â”€ æ„å»ºæ—¥å¿—     (Build logs)

ğŸ”§ é…ç½®æ–‡ä»¶
  â”œâ”€â”€ Dockeré•œåƒ   (å®¹å™¨åŒ–éƒ¨ç½²)
  â”œâ”€â”€ éƒ¨ç½²è„šæœ¬     (Deploy scripts)
  â””â”€â”€ é…ç½®æ–‡ä»¶     (Config files)
```

### 6.2 äº§ç‰©æ”¶é›†é…ç½®


**åŸºç¡€äº§ç‰©æ”¶é›†**ï¼š

```yaml
collect_artifacts:
  stage: build
  script:
    - npm run build
  artifacts:
    name: "build-$CI_COMMIT_SHORT_SHA"  # äº§ç‰©åç§°åŒ…å«æäº¤ID
    paths:
      - dist/                          # è¦æ”¶é›†çš„æ–‡ä»¶è·¯å¾„
      - build/
    expire_in: 1 week                  # ä¿ç•™æ—¶é—´
    when: always                       # æ€»æ˜¯æ”¶é›†ï¼Œå³ä½¿æ„å»ºå¤±è´¥
```

**é«˜çº§äº§ç‰©é…ç½®**ï¼š

```yaml
advanced_artifacts:
  artifacts:
    name: "$CI_JOB_NAME-$CI_COMMIT_REF_NAME"
    paths:
      - target/*.jar      # Java jaråŒ…
      - dist/            # å‰ç«¯æ„å»ºäº§ç‰©
      - reports/         # æµ‹è¯•æŠ¥å‘Š
    reports:             # ç‰¹æ®ŠæŠ¥å‘Šç±»å‹
      junit: reports/junit.xml          # æµ‹è¯•ç»“æœ
      coverage_report:                  # ä»£ç è¦†ç›–ç‡
        coverage_format: cobertura
        path: reports/coverage.xml
    exclude:             # æ’é™¤ä¸éœ€è¦çš„æ–‡ä»¶
      - "**/*.tmp"
      - ".cache/*"
```

### 6.3 äº§ç‰©ç®¡ç†æœ€ä½³å®è·µ


**ğŸ“ å‘½åè§„èŒƒ**ï¼š

```yaml
# è§„èŒƒçš„äº§ç‰©å‘½å
artifacts:
  name: "${CI_PROJECT_NAME}-${CI_COMMIT_BRANCH}-${CI_COMMIT_SHORT_SHA}"
  # ç¤ºä¾‹: myapp-main-a1b2c3d4
```

**â° ç”Ÿå‘½å‘¨æœŸç®¡ç†**ï¼š

```yaml
# ä¸åŒç±»å‹äº§ç‰©çš„ä¿ç•™ç­–ç•¥
development_artifacts:
  artifacts:
    expire_in: 1 day      # å¼€å‘ç‰ˆæœ¬ä¿ç•™1å¤©
  only:
    - develop

release_artifacts:
  artifacts:
    expire_in: 1 month    # å‘å¸ƒç‰ˆæœ¬ä¿ç•™1ä¸ªæœˆ
  only:
    - /^release\/.*$/

production_artifacts:
  artifacts:
    expire_in: 1 year     # ç”Ÿäº§ç‰ˆæœ¬ä¿ç•™1å¹´
  only:
    - main
```

**ğŸ“Š äº§ç‰©å¤§å°ä¼˜åŒ–**ï¼š

```yaml
optimized_artifacts:
  script:
    - npm run build
    - echo "å‹ç¼©å‰å¤§å°:" && du -sh dist/
    - tar -czf dist.tar.gz dist/  # å‹ç¼©äº§ç‰©
    - echo "å‹ç¼©åå¤§å°:" && du -sh dist.tar.gz
  artifacts:
    paths:
      - dist.tar.gz       # åªä¿å­˜å‹ç¼©æ–‡ä»¶
```

---

## 7. âš¡ æ„å»ºä¼˜åŒ–æŠ€å·§


### 7.1 ç¼“å­˜ä¼˜åŒ–ç­–ç•¥


**ğŸ¯ ç¼“å­˜çš„æ ¸å¿ƒåŸç†**ï¼š
- æŠŠ**ç»å¸¸ä½¿ç”¨**ä½†**ä¸ç»å¸¸å˜åŒ–**çš„æ–‡ä»¶ä¿å­˜èµ·æ¥
- ä¸‹æ¬¡æ„å»ºæ—¶ç›´æ¥ä½¿ç”¨ï¼Œé¿å…é‡å¤ä¸‹è½½æˆ–è®¡ç®—

**å¤šå±‚ç¼“å­˜ç­–ç•¥**ï¼š

```yaml
optimized_cache:
  variables:
    # è®¾ç½®ç¼“å­˜ç›®å½•
    npm_config_cache: "$CI_PROJECT_DIR/.npm"
    CYPRESS_CACHE_FOLDER: "$CI_PROJECT_DIR/.cypress"
    
  cache:
    # å…¨å±€ç¼“å­˜ - æ‰€æœ‰åˆ†æ”¯å…±äº«
    - key: global-cache
      paths:
        - .npm/           # npmåŒ…ç¼“å­˜
        - .cypress/       # Cypressç¼“å­˜
      policy: pull        # åªæ‹‰å–ï¼Œä¸æ¨é€
    
    # åˆ†æ”¯ç¼“å­˜ - åˆ†æ”¯çº§åˆ«ç¼“å­˜
    - key: 
        files:
          - package-lock.json  # åŸºäºä¾èµ–æ–‡ä»¶å˜åŒ–
        prefix: "$CI_COMMIT_REF_SLUG"
      paths:
        - node_modules/        # ä¾èµ–æ–‡ä»¶å¤¹
      policy: pull-push        # æ‹‰å–å’Œæ¨é€
```

**ğŸ”„ ç¼“å­˜å¤±æ•ˆç­–ç•¥**ï¼š

```yaml
smart_cache:
  cache:
    key: 
      files:
        - package-lock.json    # ä¾èµ–å˜åŒ–æ—¶æ›´æ–°ç¼“å­˜
        - yarn.lock
        - pom.xml             # Mavené¡¹ç›®
        - build.gradle        # Gradleé¡¹ç›®
      prefix: "v1-$CI_COMMIT_REF_SLUG"  # ç‰ˆæœ¬å‰ç¼€æ–¹ä¾¿æ›´æ–°
```

### 7.2 å¹¶è¡Œæ„å»ºä¼˜åŒ–


**ğŸš€ ä»»åŠ¡å¹¶è¡ŒåŒ–**ï¼š

```yaml
# å¹¶è¡Œæ‰§è¡Œå¤šä¸ªæ„å»ºä»»åŠ¡
parallel_builds:
  stage: build
  parallel:
    matrix:
      - NODE_VERSION: ["14", "16", "18"]  # å¤šç‰ˆæœ¬å¹¶è¡Œæµ‹è¯•
        OS: ["alpine", "ubuntu"]
  image: node:${NODE_VERSION}-${OS}
  script:
    - npm ci
    - npm run build
```

**ğŸ“Š åˆ†é˜¶æ®µå¹¶è¡Œ**ï¼š

```yaml
stages:
  - prepare    # å‡†å¤‡é˜¶æ®µ
  - build      # æ„å»ºé˜¶æ®µï¼ˆå¹¶è¡Œï¼‰
  - test       # æµ‹è¯•é˜¶æ®µï¼ˆå¹¶è¡Œï¼‰
  - deploy     # éƒ¨ç½²é˜¶æ®µ

# å‡†å¤‡ä¾èµ–ï¼ˆä¸²è¡Œï¼‰
install_deps:
  stage: prepare
  script:
    - npm ci
  artifacts:
    paths:
      - node_modules/

# æ„å»ºä»»åŠ¡ï¼ˆå¹¶è¡Œï¼‰
build_frontend:
  stage: build
  script:
    - npm run build:frontend
  dependencies:
    - install_deps

build_backend:
  stage: build  
  script:
    - npm run build:backend
  dependencies:
    - install_deps
```

### 7.3 æ„å»ºç¯å¢ƒä¼˜åŒ–


**ğŸ³ Dockeré•œåƒä¼˜åŒ–**ï¼š

```yaml
# ä½¿ç”¨è½»é‡çº§é•œåƒ
optimized_image:
  image: node:16-alpine  # alpineç‰ˆæœ¬æ›´å°æ›´å¿«
  
  before_script:
    # åªå®‰è£…å¿…è¦çš„ç³»ç»Ÿä¾èµ–
    - apk add --no-cache git python3 make g++
```

**ğŸ’¾ èµ„æºé™åˆ¶ä¼˜åŒ–**ï¼š

```yaml
resource_optimized:
  variables:
    # Node.jså†…å­˜é™åˆ¶
    NODE_OPTIONS: "--max-old-space-size=1024"
    # Mavenå†…å­˜è®¾ç½®
    MAVEN_OPTS: "-Xmx512m -XX:MaxPermSize=128m"
  
  script:
    - echo "å¯ç”¨å†…å­˜: $(free -h)"
    - npm run build
```

### 7.4 æ¡ä»¶æ„å»ºä¼˜åŒ–


**ğŸ¯ æ™ºèƒ½è§¦å‘**ï¼š

```yaml
# åªåœ¨ç›¸å…³æ–‡ä»¶å˜åŒ–æ—¶æ„å»º
smart_frontend_build:
  script:
    - npm run build:frontend
  only:
    changes:              # åªåœ¨è¿™äº›æ–‡ä»¶å˜åŒ–æ—¶æ‰§è¡Œ
      - "frontend/**/*"
      - "package*.json"
      - "*.config.js"

smart_backend_build:
  script:
    - mvn package
  only:
    changes:
      - "backend/**/*"
      - "pom.xml"
```

**ğŸŒ¿ åˆ†æ”¯ç­–ç•¥ä¼˜åŒ–**ï¼š

```yaml
# å¼€å‘åˆ†æ”¯å¿«é€Ÿæ„å»º
quick_build:
  script:
    - npm run build:dev    # å¼€å‘ç‰ˆæœ¬ï¼Œé€Ÿåº¦ä¼˜å…ˆ
  only:
    - develop
    
# ä¸»åˆ†æ”¯å®Œæ•´æ„å»º  
full_build:
  script:
    - npm run lint         # å®Œæ•´çš„ä»£ç æ£€æŸ¥
    - npm run test:full    # å®Œæ•´æµ‹è¯•
    - npm run build:prod   # ç”Ÿäº§æ„å»º
  only:
    - main
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æ„å»ºæœ¬è´¨ï¼šå°†æºä»£ç è½¬æ¢ä¸ºå¯æ‰§è¡Œç¨‹åºçš„è¿‡ç¨‹
ğŸ”¸ è‡ªåŠ¨åŒ–ä»·å€¼ï¼šæ ‡å‡†åŒ–ã€é«˜æ•ˆç‡ã€å¯è¿½æº¯çš„æ„å»ºæµç¨‹  
ğŸ”¸ ç¯å¢ƒé…ç½®ï¼šDockeré•œåƒé€‰æ‹©ã€ç¼“å­˜é…ç½®ã€å˜é‡è®¾ç½®
ğŸ”¸ è„šæœ¬ç¼–å†™ï¼šæ¸…æ™°çš„å‘½ä»¤åºåˆ—ï¼Œè‰¯å¥½çš„é”™è¯¯å¤„ç†
ğŸ”¸ äº§ç‰©ç®¡ç†ï¼šæ”¶é›†ã€å‘½åã€ç”Ÿå‘½å‘¨æœŸç®¡ç†æ„å»ºè¾“å‡º
ğŸ”¸ ä¼˜åŒ–ç­–ç•¥ï¼šç¼“å­˜ã€å¹¶è¡Œã€æ¡ä»¶æ„å»ºæå‡æ•ˆç‡
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æ„å»ºé…ç½®çš„æ ¸å¿ƒæ€è·¯**
```
ç¯å¢ƒå‡†å¤‡ â†’ ä¾èµ–å®‰è£… â†’ ä»£ç ç¼–è¯‘ â†’ æµ‹è¯•éªŒè¯ â†’ äº§ç‰©æ”¶é›†
   â†“          â†“         â†“         â†“         â†“
Dockeré•œåƒ   npm/maven   build    test    artifacts
```

**ğŸ”¹ ä¸åŒé¡¹ç›®ç±»å‹çš„æ„å»ºç‰¹ç‚¹**
```
Javaé¡¹ç›®ï¼š
- Maven/Gradleç®¡ç†ä¾èµ–
- ç¼–è¯‘ç”Ÿæˆjar/waråŒ…
- æ³¨é‡å†…å­˜å’Œç¼–ç é…ç½®

å‰ç«¯é¡¹ç›®ï¼š  
- npm/yarnç®¡ç†ä¾èµ–
- Webpackç­‰å·¥å…·æ‰“åŒ…
- ç”Ÿæˆé™æ€èµ„æºæ–‡ä»¶

å…±åŒç‚¹ï¼š
- éƒ½éœ€è¦ä¾èµ–ç®¡ç†
- éƒ½æœ‰æ„å»ºå·¥å…·
- éƒ½ç”Ÿæˆå¯éƒ¨ç½²çš„äº§ç‰©
```

**ğŸ”¹ ä¼˜åŒ–çš„å¹³è¡¡è‰ºæœ¯**
```
é€Ÿåº¦ vs å®Œæ•´æ€§ï¼š
- å¼€å‘åˆ†æ”¯ï¼šå¿«é€Ÿæ„å»ºï¼ŒåŠæ—¶åé¦ˆ
- ä¸»åˆ†æ”¯ï¼šå®Œæ•´æ„å»ºï¼Œä¿è¯è´¨é‡

èµ„æº vs æ•ˆæœï¼š
- ç¼“å­˜å ç”¨ç©ºé—´ä½†èŠ‚çœæ—¶é—´
- å¹¶è¡Œæ¶ˆè€—èµ„æºä½†æå‡é€Ÿåº¦
- éœ€è¦æ ¹æ®å®é™…æƒ…å†µå¹³è¡¡
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ æ–°æ‰‹å…¥é—¨æ­¥éª¤**
1. **é€‰æ‹©åˆé€‚é•œåƒ** - æ ¹æ®é¡¹ç›®æŠ€æœ¯æ ˆé€‰æ‹©åŸºç¡€ç¯å¢ƒ
2. **ç¼–å†™åŸºç¡€è„šæœ¬** - å…ˆå®ç°æœ€ç®€å•çš„æ„å»ºæµç¨‹
3. **é…ç½®äº§ç‰©æ”¶é›†** - ç¡®ä¿æ„å»ºç»“æœèƒ½æ­£ç¡®ä¿å­˜
4. **é€æ­¥æ·»åŠ ä¼˜åŒ–** - åœ¨åŸºç¡€ç‰ˆæœ¬ç¨³å®šåå†ä¼˜åŒ–æ€§èƒ½

**âš ï¸ å¸¸è§é—®é¢˜é¿å…**
- âŒ **è¿‡åº¦ä¼˜åŒ–** - ä¸€å¼€å§‹å°±è¿½æ±‚å¤æ‚çš„ä¼˜åŒ–ç­–ç•¥
- âŒ **å¿½ç•¥é”™è¯¯å¤„ç†** - è„šæœ¬æ²¡æœ‰é€‚å½“çš„é”™è¯¯æ£€æŸ¥
- âŒ **ç¼“å­˜æ»¥ç”¨** - ç¼“å­˜äº†ä¸åº”è¯¥ç¼“å­˜çš„æ–‡ä»¶
- âŒ **äº§ç‰©æ··ä¹±** - æ²¡æœ‰æ¸…æ™°çš„äº§ç‰©ç®¡ç†ç­–ç•¥

**âœ… æœ€ä½³å®è·µchecklist**
- [ ] æ„å»ºç¯å¢ƒæ ‡å‡†åŒ–ï¼ˆDockeré•œåƒå›ºå®šç‰ˆæœ¬ï¼‰
- [ ] è„šæœ¬æœ‰æ¸…æ™°çš„æ—¥å¿—è¾“å‡º
- [ ] ç¼“å­˜ç­–ç•¥åˆç†ï¼ˆåŸºäºæ–‡ä»¶å˜åŒ–ï¼‰
- [ ] äº§ç‰©å‘½åè§„èŒƒï¼ˆåŒ…å«ç‰ˆæœ¬ä¿¡æ¯ï¼‰
- [ ] é”™è¯¯å¤„ç†å®Œå–„ï¼ˆå¤±è´¥æ—¶æœ‰æ˜ç¡®æç¤ºï¼‰
- [ ] ä¸åŒç¯å¢ƒæœ‰ä¸åŒçš„æ„å»ºç­–ç•¥

### 8.4 è¿›é˜¶å­¦ä¹ æ–¹å‘


**ğŸš€ æ€§èƒ½ä¼˜åŒ–æ·±å…¥**
- æ„å»ºæ—¶é—´åˆ†æå’Œç“¶é¢ˆè¯†åˆ«
- é«˜çº§ç¼“å­˜ç­–ç•¥ï¼ˆåˆ†å±‚ç¼“å­˜ã€æ™ºèƒ½å¤±æ•ˆï¼‰
- åˆ†å¸ƒå¼æ„å»ºå’Œä»»åŠ¡è°ƒåº¦

**ğŸ”§ å·¥å…·é“¾æ•´åˆ**
- ä»£ç è´¨é‡æ£€æŸ¥é›†æˆï¼ˆESLintã€SonarQubeï¼‰
- å®‰å…¨æ‰«æé›†æˆï¼ˆä¾èµ–æ¼æ´æ£€æŸ¥ï¼‰
- å¤šå¹³å°æ„å»ºï¼ˆè·¨å¹³å°å…¼å®¹æ€§ï¼‰

**ğŸ“Š ç›‘æ§å’Œåˆ†æ**
- æ„å»ºæŒ‡æ ‡æ”¶é›†å’Œåˆ†æ
- æ„å»ºæˆåŠŸç‡å’Œå¤±è´¥åŸå› ç»Ÿè®¡
- æ„å»ºèµ„æºä½¿ç”¨ä¼˜åŒ–

**æ ¸å¿ƒè®°å¿†**ï¼š
- æ„å»ºå°±æ˜¯æŠŠä»£ç å˜æˆç¨‹åºçš„è‡ªåŠ¨åŒ–è¿‡ç¨‹
- ç¯å¢ƒä¸€è‡´æ€§æ˜¯æ„å»ºç¨³å®šçš„åŸºç¡€
- ç¼“å­˜å’Œå¹¶è¡Œæ˜¯æå‡æ•ˆç‡çš„ä¸¤å¤§æ³•å®
- å¥½çš„æ„å»ºé…ç½®åº”è¯¥ç®€å•ã€å¯é ã€å¯ç»´æŠ¤