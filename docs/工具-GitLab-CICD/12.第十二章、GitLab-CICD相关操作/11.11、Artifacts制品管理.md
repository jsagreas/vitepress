---
title: 11ã€Artifactsåˆ¶å“ç®¡ç†
---
## ğŸ“š ç›®å½•

1. [Artifactsåˆ¶å“æ˜¯ä»€ä¹ˆ](#1-artifactsåˆ¶å“æ˜¯ä»€ä¹ˆ)
2. [ArtifactsåŸºç¡€é…ç½®](#2-artifactsåŸºç¡€é…ç½®)
3. [åˆ¶å“è·¯å¾„ä¸æ–‡ä»¶ç®¡ç†](#3-åˆ¶å“è·¯å¾„ä¸æ–‡ä»¶ç®¡ç†)
4. [åˆ¶å“è¿‡æœŸæ—¶é—´ç­–ç•¥](#4-åˆ¶å“è¿‡æœŸæ—¶é—´ç­–ç•¥)
5. [åˆ¶å“åœ¨Jobé—´ä¼ é€’](#5-åˆ¶å“åœ¨jobé—´ä¼ é€’)
6. [Reportsç±»å‹åˆ¶å“](#6-reportsç±»å‹åˆ¶å“)
7. [åˆ¶å“å­˜å‚¨ä¸æƒé™ç®¡ç†](#7-åˆ¶å“å­˜å‚¨ä¸æƒé™ç®¡ç†)
8. [å®æˆ˜åº”ç”¨åœºæ™¯](#8-å®æˆ˜åº”ç”¨åœºæ™¯)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ Artifactsåˆ¶å“æ˜¯ä»€ä¹ˆ


### 1.1 é€šä¿—ç†è§£Artifacts


**ğŸ’¡ ç”Ÿæ´»åŒ–ç†è§£**
æƒ³è±¡ä½ åœ¨å¨æˆ¿åšèœï¼š
- **åŸæ–™**ï¼šæºä»£ç ï¼ˆé¢ç²‰ã€é¸¡è›‹ï¼‰
- **åˆ¶ä½œè¿‡ç¨‹**ï¼šCI/CDæµæ°´çº¿ï¼ˆå’Œé¢ã€çƒ˜çƒ¤ï¼‰
- **æˆå“**ï¼šArtifactsåˆ¶å“ï¼ˆé¢åŒ…ã€è›‹ç³•ï¼‰

Artifactså°±æ˜¯æµæ°´çº¿"åˆ¶ä½œ"å‡ºæ¥çš„**æœ€ç»ˆäº§å“**ï¼Œå¯ä»¥æ˜¯ç¼–è¯‘åçš„ç¨‹åºã€æµ‹è¯•æŠ¥å‘Šã€æˆ–è€…ä»»ä½•ä½ æƒ³ä¿å­˜çš„æ–‡ä»¶ã€‚

**ğŸ”¸ æ ¸å¿ƒæ¦‚å¿µ**
```
Artifacts = æµæ°´çº¿Jobäº§ç”Ÿçš„æ–‡ä»¶ + éœ€è¦ä¿å­˜çš„äº§ç‰©

ä½œç”¨ï¼š
â€¢ ä¿å­˜Jobæ‰§è¡Œç»“æœ
â€¢ åœ¨ä¸åŒJobé—´ä¼ é€’æ–‡ä»¶
â€¢ æä¾›ä¸‹è½½å’Œéƒ¨ç½²
â€¢ ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦Artifacts


**ğŸ¤” é—®é¢˜åœºæ™¯**
```
æ²¡æœ‰Artifactsæ—¶ï¼š
æ„å»ºJob â”€â”
         â”œâ”€ ç¼–è¯‘ç”Ÿæˆapp.jar âŒ Jobç»“æŸåæ–‡ä»¶æ¶ˆå¤±
æµ‹è¯•Job â”€â”˜

æœ‰äº†Artifactsåï¼š
æ„å»ºJob â”€â”â”€ ç¼–è¯‘ç”Ÿæˆapp.jar âœ… ä¿å­˜åˆ°Artifacts
         â”‚
æµ‹è¯•Job â”€â”˜â”€ ä½¿ç”¨app.jarè¿›è¡Œæµ‹è¯• âœ… ä»Artifactsè·å–
```

**âœ¨ æ ¸å¿ƒä»·å€¼**
- **æ–‡ä»¶ä¿å­˜**ï¼šé˜²æ­¢é‡è¦æ–‡ä»¶åœ¨Jobç»“æŸåä¸¢å¤±
- **æ•°æ®ä¼ é€’**ï¼šè®©ä¸åŒJobèƒ½å…±äº«æ–‡ä»¶
- **ç»“æœå±•ç¤º**ï¼šæµ‹è¯•æŠ¥å‘Šã€ä»£ç è¦†ç›–ç‡ç­‰å¯è§†åŒ–
- **éƒ¨ç½²æ”¯æŒ**ï¼šä¿å­˜å¯éƒ¨ç½²çš„åº”ç”¨åŒ…

### 1.3 Artifactsçš„ç”Ÿå‘½å‘¨æœŸ


```
åˆ¶å“ç”Ÿå‘½å‘¨æœŸæµç¨‹ï¼š
Jobæ‰§è¡Œ â†’ ç”Ÿæˆæ–‡ä»¶ â†’ ä¿å­˜åˆ°Artifacts â†’ è®¾ç½®è¿‡æœŸæ—¶é—´ â†’ è‡ªåŠ¨æ¸…ç†
   â†“         â†“           â†“            â†“           â†“
æºç ç¼–è¯‘   app.jar    åˆ¶å“å­˜å‚¨     30å¤©åè¿‡æœŸ   é‡Šæ”¾ç©ºé—´
```

---

## 2. âš™ï¸ ArtifactsåŸºç¡€é…ç½®


### 2.1 æœ€ç®€å•çš„Artifactsé…ç½®


**ğŸ“ åŸºç¡€è¯­æ³•**
```yaml
# æœ€ç®€å•çš„é…ç½®ç¤ºä¾‹
build_job:
  script:
    - echo "æ„å»ºåº”ç”¨ç¨‹åº"
    - mkdir output
    - echo "Hello World" > output/app.txt
  artifacts:
    paths:
      - output/        # ä¿å­˜outputç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶
```

**ğŸ”¸ é…ç½®è¦ç´ è§£é‡Š**
- `artifacts:`ï¼šå…³é”®è¯ï¼Œå‘Šè¯‰GitLabè¿™ä¸ªJobä¼šäº§ç”Ÿåˆ¶å“
- `paths:`ï¼šæŒ‡å®šè¦ä¿å­˜çš„æ–‡ä»¶æˆ–ç›®å½•è·¯å¾„
- `output/`ï¼šå®é™…çš„æ–‡ä»¶è·¯å¾„ï¼ˆå¯ä»¥æ˜¯æ–‡ä»¶æˆ–ç›®å½•ï¼‰

### 2.2 å®Œæ•´é…ç½®ç»“æ„


```yaml
job_name:
  script:
    - # ä½ çš„æ„å»ºå‘½ä»¤
  artifacts:
    name: "åˆ¶å“åç§°"              # åˆ¶å“åŒ…çš„åç§°
    paths:                      # è¦ä¿å­˜çš„æ–‡ä»¶è·¯å¾„
      - build/
      - dist/
    exclude:                    # æ’é™¤çš„æ–‡ä»¶
      - "*.log"
    expire_in: 1 week          # è¿‡æœŸæ—¶é—´
    when: on_success           # ä»€ä¹ˆæ—¶å€™ä¿å­˜åˆ¶å“
    reports:                   # ç‰¹æ®ŠæŠ¥å‘Šç±»å‹
      junit: test-results.xml
```

**ğŸ·ï¸ é…ç½®å‚æ•°è¯´æ˜**

| å‚æ•° | ä½œç”¨ | ç¤ºä¾‹å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `name` | åˆ¶å“åŒ…åç§° | `"app-v1.0"` | ä¸‹è½½æ—¶çš„æ–‡ä»¶å |
| `paths` | æ–‡ä»¶è·¯å¾„ | `["build/", "*.jar"]` | æ”¯æŒç›®å½•å’Œé€šé…ç¬¦ |
| `exclude` | æ’é™¤æ–‡ä»¶ | `["*.log", "temp/"]` | ä¸ä¿å­˜çš„æ–‡ä»¶ |
| `expire_in` | è¿‡æœŸæ—¶é—´ | `1 week`, `30 days` | è‡ªåŠ¨åˆ é™¤æ—¶é—´ |
| `when` | ä¿å­˜æ¡ä»¶ | `always`, `on_success` | ä½•æ—¶ä¿å­˜åˆ¶å“ |

### 2.3 å®é™…åº”ç”¨ç¤ºä¾‹


**ğŸ“± å‰ç«¯é¡¹ç›®ç¤ºä¾‹**
```yaml
build_frontend:
  stage: build
  script:
    - npm install
    - npm run build
  artifacts:
    name: "frontend-dist-$CI_COMMIT_SHORT_SHA"
    paths:
      - dist/
    expire_in: 1 week
    when: on_success
```

**â˜• Javaé¡¹ç›®ç¤ºä¾‹**
```yaml
build_java:
  stage: build
  script:
    - mvn clean package
  artifacts:
    name: "java-app-$CI_PIPELINE_ID"
    paths:
      - target/*.jar
      - target/classes/
    exclude:
      - target/*-sources.jar
    expire_in: 2 weeks
```

---

## 3. ğŸ“ åˆ¶å“è·¯å¾„ä¸æ–‡ä»¶ç®¡ç†


### 3.1 è·¯å¾„æŒ‡å®šè§„åˆ™


**ğŸ”¸ ç»å¯¹è·¯å¾„ vs ç›¸å¯¹è·¯å¾„**
```yaml
artifacts:
  paths:
    # âœ… æ¨èï¼šç›¸å¯¹è·¯å¾„ï¼ˆç›¸å¯¹äºé¡¹ç›®æ ¹ç›®å½•ï¼‰
    - build/output/
    - src/main/resources/config.properties
    
    # âŒ é¿å…ï¼šç»å¯¹è·¯å¾„ï¼ˆå¯èƒ½åœ¨ä¸åŒç¯å¢ƒå¤±æ•ˆï¼‰
    - /home/user/project/build/
```

**ğŸ”¸ é€šé…ç¬¦ä½¿ç”¨**
```yaml
artifacts:
  paths:
    - "*.jar"              # æ‰€æœ‰jaræ–‡ä»¶
    - "build/**/*.js"      # buildç›®å½•ä¸‹æ‰€æœ‰jsæ–‡ä»¶
    - "logs/*.{log,txt}"   # logsç›®å½•ä¸‹çš„logå’Œtxtæ–‡ä»¶
    - "target/classes/"    # æ•´ä¸ªclassesç›®å½•
```

**ğŸ“Š é€šé…ç¬¦å¯¹ç…§è¡¨**

| é€šé…ç¬¦ | å«ä¹‰ | ç¤ºä¾‹ | åŒ¹é…ç»“æœ |
|--------|------|------|----------|
| `*` | ä»»æ„å­—ç¬¦ | `*.jar` | `app.jar`, `test.jar` |
| `**` | ä»»æ„ç›®å½•å±‚çº§ | `**/*.js` | `src/main.js`, `build/dist/app.js` |
| `?` | å•ä¸ªå­—ç¬¦ | `log?.txt` | `log1.txt`, `logA.txt` |
| `{}` | å¤šé€‰ä¸€ | `*.{js,css}` | `app.js`, `style.css` |

### 3.2 æ–‡ä»¶æ’é™¤ç­–ç•¥


**ğŸš« æ’é™¤ä¸å¿…è¦çš„æ–‡ä»¶**
```yaml
artifacts:
  paths:
    - build/
  exclude:
    - "build/**/*.log"      # æ’é™¤æ‰€æœ‰æ—¥å¿—æ–‡ä»¶
    - "build/temp/"         # æ’é™¤ä¸´æ—¶ç›®å½•
    - "**/.DS_Store"        # æ’é™¤Macç³»ç»Ÿæ–‡ä»¶
    - "build/**/*-dev.*"    # æ’é™¤å¼€å‘ç‰ˆæœ¬æ–‡ä»¶
```

**ğŸ’¡ æœ€ä½³å®è·µå»ºè®®**
```
ä¼˜åŒ–å­˜å‚¨ç©ºé—´çš„ç­–ç•¥ï¼š
1. åªä¿å­˜å¿…éœ€æ–‡ä»¶ï¼ˆå¯æ‰§è¡Œæ–‡ä»¶ã€é…ç½®æ–‡ä»¶ï¼‰
2. æ’é™¤æ—¥å¿—æ–‡ä»¶ï¼ˆ*.log, *.outï¼‰
3. æ’é™¤æºä»£ç ï¼ˆå¦‚æœä¸éœ€è¦ä¼ é€’çš„è¯ï¼‰
4. æ’é™¤ä¾èµ–åŒ…ï¼ˆnode_modules, .mvnç­‰ï¼‰
5. æ’é™¤ä¸´æ—¶æ–‡ä»¶ï¼ˆtemp/, cache/ï¼‰
```

### 3.3 å¤šç±»å‹æ–‡ä»¶ç®¡ç†


**ğŸ“¦ å¤æ‚é¡¹ç›®ç¤ºä¾‹**
```yaml
build_complex_app:
  script:
    - make build
    - make test
    - make package
  artifacts:
    name: "full-package-$CI_COMMIT_REF_NAME"
    paths:
      # åº”ç”¨ç¨‹åºæ–‡ä»¶
      - bin/app
      - config/*.yml
      # æ–‡æ¡£æ–‡ä»¶  
      - docs/api/
      - README.md
      # æµ‹è¯•ç»“æœ
      - test-reports/
    exclude:
      # æ’é™¤ä¸éœ€è¦çš„æ–‡ä»¶
      - test-reports/**/*.tmp
      - docs/**/*.draft
      - config/*-local.yml
    expire_in: 1 month
```

---

## 4. â° åˆ¶å“è¿‡æœŸæ—¶é—´ç­–ç•¥


### 4.1 è¿‡æœŸæ—¶é—´è®¾ç½®


**ğŸ• æ—¶é—´å•ä½è¯´æ˜**
```yaml
artifacts:
  expire_in: 1 hour        # 1å°æ—¶
  # expire_in: 30 minutes  # 30åˆ†é’Ÿ  
  # expire_in: 2 days      # 2å¤©
  # expire_in: 1 week      # 1å‘¨
  # expire_in: 2 months    # 2ä¸ªæœˆ
  # expire_in: 1 year      # 1å¹´
  # expire_in: never       # æ°¸ä¸è¿‡æœŸï¼ˆä¸æ¨èï¼‰
```

**ğŸ“‹ æ”¯æŒçš„æ—¶é—´å•ä½**

| å•ä½ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `minutes` | åˆ†é’Ÿ | `30 minutes` |
| `hours` | å°æ—¶ | `2 hours` |
| `days` | å¤© | `7 days` |
| `weeks` | å‘¨ | `2 weeks` |
| `months` | æœˆ | `1 month` |
| `years` | å¹´ | `1 year` |
| `never` | æ°¸ä¸è¿‡æœŸ | `never` |

### 4.2 ä¸åŒåœºæ™¯çš„è¿‡æœŸç­–ç•¥


**ğŸ¯ åœºæ™¯åŒ–é…ç½®å»ºè®®**

```yaml
# ğŸš€ ä¸´æ—¶æ„å»ºæµ‹è¯•ï¼ˆçŸ­æœŸï¼‰
temp_build:
  artifacts:
    expire_in: 2 hours      # ä¸´æ—¶éªŒè¯ï¼Œå¿«é€Ÿæ¸…ç†

# ğŸ”§ å¼€å‘åˆ†æ”¯æ„å»ºï¼ˆä¸­æœŸï¼‰  
dev_build:
  artifacts:
    expire_in: 3 days       # å¼€å‘æœŸé—´ä¿ç•™å‡ å¤©

# ğŸ“¦ å‘å¸ƒå€™é€‰ç‰ˆæœ¬ï¼ˆé•¿æœŸï¼‰
release_candidate:
  artifacts:
    expire_in: 1 month      # å‘å¸ƒç‰ˆæœ¬ä¿ç•™æ›´ä¹…

# ğŸ† æ­£å¼å‘å¸ƒç‰ˆæœ¬ï¼ˆè¶…é•¿æœŸï¼‰
production_release:
  artifacts:
    expire_in: 1 year       # ç”Ÿäº§ç‰ˆæœ¬é•¿æœŸä¿ç•™
```

### 4.3 åŠ¨æ€è¿‡æœŸæ—¶é—´


**ğŸ”„ åŸºäºåˆ†æ”¯çš„åŠ¨æ€é…ç½®**
```yaml
build_app:
  script:
    - make build
  artifacts:
    name: "app-${CI_COMMIT_REF_NAME}-${CI_COMMIT_SHORT_SHA}"
    paths:
      - build/
    # æ ¹æ®åˆ†æ”¯è®¾ç½®ä¸åŒçš„è¿‡æœŸæ—¶é—´
    expire_in: !reference [.expire_rules, expire_time]

# å®šä¹‰è¿‡æœŸè§„åˆ™
.expire_rules:
  expire_time:
    - if: '$CI_COMMIT_REF_NAME == "main"'
      expire_in: 6 months        # ä¸»åˆ†æ”¯ä¿ç•™6ä¸ªæœˆ
    - if: '$CI_COMMIT_REF_NAME =~ /^release\//'
      expire_in: 3 months        # å‘å¸ƒåˆ†æ”¯ä¿ç•™3ä¸ªæœˆ  
    - expire_in: 1 week          # å…¶ä»–åˆ†æ”¯ä¿ç•™1å‘¨
```

**ğŸ’¾ å­˜å‚¨ç©ºé—´è€ƒè™‘**
```
åˆ¶å“å­˜å‚¨ç©ºé—´è§„åˆ’ï¼š
ä¸´æ—¶åˆ¶å“ï¼ˆæµ‹è¯•ç”¨ï¼‰ï¼šå‡ å°æ—¶åˆ°1å¤©
å¼€å‘åˆ¶å“ï¼ˆè°ƒè¯•ç”¨ï¼‰ï¼š3-7å¤©
é¢„å‘å¸ƒåˆ¶å“ï¼ˆéªŒæ”¶ç”¨ï¼‰ï¼š2-4å‘¨
ç”Ÿäº§åˆ¶å“ï¼ˆå½’æ¡£ç”¨ï¼‰ï¼š3-12ä¸ªæœˆ

å¹³è¡¡ç‚¹ï¼šæ»¡è¶³ä½¿ç”¨éœ€æ±‚ + æ§åˆ¶å­˜å‚¨æˆæœ¬
```

---

## 5. ğŸ”„ åˆ¶å“åœ¨Jobé—´ä¼ é€’


### 5.1 åŸºç¡€ä¼ é€’æœºåˆ¶


**ğŸ“ˆ ä¼ é€’æµç¨‹å›¾**
```
Job A (æ„å»º)                Job B (æµ‹è¯•)
     â†“                          â†“
ç”Ÿæˆ app.jar  â”€â”€artifactsâ”€â”€â†’  ä½¿ç”¨ app.jar
ä¿å­˜åˆ¶å“                      ä¸‹è½½åˆ¶å“
```

**ğŸ”¸ åŸºç¡€ä¼ é€’ç¤ºä¾‹**
```yaml
# ç¬¬ä¸€ä¸ªJobï¼šæ„å»ºåº”ç”¨
build:
  stage: build
  script:
    - mvn package
  artifacts:
    paths:
      - target/app.jar
    expire_in: 1 hour

# ç¬¬äºŒä¸ªJobï¼šæµ‹è¯•åº”ç”¨  
test:
  stage: test
  script:
    - java -jar target/app.jar --test
  dependencies:
    - build                    # ä¾èµ–build Jobçš„åˆ¶å“
```

### 5.2 Dependenciesä¾èµ–å…³ç³»


**ğŸ”— ä¾èµ–é…ç½®è¯¦è§£**
```yaml
# æ„å»ºJob
build_frontend:
  stage: build
  script:
    - npm run build
  artifacts:
    paths:
      - dist/

build_backend:
  stage: build  
  script:
    - mvn package
  artifacts:
    paths:
      - target/app.jar

# é›†æˆæµ‹è¯•Job
integration_test:
  stage: test
  script:
    - echo "å‰ç«¯æ–‡ä»¶ï¼š" && ls dist/
    - echo "åç«¯æ–‡ä»¶ï¼š" && ls target/
    - # è¿è¡Œé›†æˆæµ‹è¯•
  dependencies:
    - build_frontend           # è·å–å‰ç«¯åˆ¶å“
    - build_backend           # è·å–åç«¯åˆ¶å“
```

**âš ï¸ ä¾èµ–å…³ç³»æ³¨æ„äº‹é¡¹**
```
ä¾èµ–è§„åˆ™ï¼š
âœ… dependenciesä¸­çš„Jobå¿…é¡»åœ¨ä¹‹å‰çš„stage
âœ… è¢«ä¾èµ–çš„Jobå¿…é¡»æœ‰artifactsé…ç½®
âœ… å¯ä»¥ä¾èµ–å¤šä¸ªJobçš„åˆ¶å“
âŒ ä¸èƒ½ä¾èµ–åŒä¸€stageçš„Job
âŒ ä¸èƒ½å¾ªç¯ä¾èµ–
```

### 5.3 éœ€è¦åˆ¶å“ vs ä¸éœ€è¦åˆ¶å“


**ğŸ›ï¸ ç²¾ç¡®æ§åˆ¶åˆ¶å“ä¸‹è½½**
```yaml
# åœºæ™¯1ï¼šéœ€è¦æ‰€æœ‰å‰ç½®åˆ¶å“ï¼ˆé»˜è®¤è¡Œä¸ºï¼‰
deploy_all:
  stage: deploy
  script:
    - echo "éƒ¨ç½²æ‰€æœ‰åº”ç”¨"
  # é»˜è®¤ä¼šä¸‹è½½æ‰€æœ‰å‰ç½®stageçš„åˆ¶å“

# åœºæ™¯2ï¼šåªéœ€è¦ç‰¹å®šåˆ¶å“
deploy_frontend:
  stage: deploy
  script:
    - echo "åªéƒ¨ç½²å‰ç«¯"
  dependencies:
    - build_frontend          # åªè¦å‰ç«¯åˆ¶å“

# åœºæ™¯3ï¼šä¸éœ€è¦ä»»ä½•åˆ¶å“
lint_code:
  stage: test
  script:
    - eslint src/
  dependencies: []            # æ˜ç¡®æŒ‡å®šä¸éœ€è¦åˆ¶å“
```

### 5.4 è·¨Stageåˆ¶å“ä¼ é€’å®Œæ•´ç¤ºä¾‹


**ğŸ—ï¸ å®Œæ•´æµæ°´çº¿ç¤ºä¾‹**
```yaml
stages:
  - build
  - test  
  - package
  - deploy

# Stage 1: æ„å»º
compile_app:
  stage: build
  script:
    - javac -d build/ src/*.java
  artifacts:
    paths:
      - build/
    expire_in: 2 hours

# Stage 2: æµ‹è¯•
unit_test:
  stage: test
  script:
    - java -cp build/ TestRunner
  dependencies:
    - compile_app

# Stage 3: æ‰“åŒ…
create_package:
  stage: package
  script:
    - jar -cf app.jar -C build/ .
  artifacts:
    paths:
      - app.jar
    expire_in: 1 week
  dependencies:
    - compile_app

# Stage 4: éƒ¨ç½²
deploy_prod:
  stage: deploy
  script:
    - scp app.jar server:/opt/app/
  dependencies:
    - create_package         # åªéœ€è¦æœ€ç»ˆçš„jaråŒ…
  only:
    - main
```

---

## 6. ğŸ“Š Reportsç±»å‹åˆ¶å“


### 6.1 Reportsåˆ¶å“æ¦‚è¿°


**ğŸ’¡ ä»€ä¹ˆæ˜¯Reportsåˆ¶å“**
Reportsæ˜¯ä¸€ç§ç‰¹æ®Šçš„åˆ¶å“ç±»å‹ï¼ŒGitLabä¼šå¯¹è¿™äº›æ–‡ä»¶è¿›è¡Œ**è§£æå’Œå¯è§†åŒ–å±•ç¤º**ï¼Œè€Œä¸æ˜¯ä»…ä»…å­˜å‚¨æ–‡ä»¶ã€‚

```
æ™®é€šåˆ¶å“ vs Reportsåˆ¶å“ï¼š
æ™®é€šåˆ¶å“ï¼šapp.jar     â†’ ä¿å­˜æ–‡ä»¶ï¼Œæä¾›ä¸‹è½½
Reportsåˆ¶å“ï¼štest.xml  â†’ è§£æå†…å®¹ï¼Œç”ŸæˆæŠ¥å‘Šç•Œé¢
```

**ğŸ”¸ æ”¯æŒçš„Reportsç±»å‹**
- **JUnit**ï¼šå•å…ƒæµ‹è¯•ç»“æœ
- **Coverage**ï¼šä»£ç è¦†ç›–ç‡
- **Performance**ï¼šæ€§èƒ½æµ‹è¯•æ•°æ®
- **SAST**ï¼šé™æ€ä»£ç åˆ†æ
- **Container Scanning**ï¼šå®¹å™¨å®‰å…¨æ‰«æ

### 6.2 JUnitæµ‹è¯•æŠ¥å‘Š


**ğŸ“‹ JUnitæŠ¥å‘Šé…ç½®**
```yaml
test_java:
  stage: test
  script:
    - mvn test
  artifacts:
    when: always              # æµ‹è¯•å¤±è´¥ä¹Ÿè¦ä¿å­˜æŠ¥å‘Š
    reports:
      junit: target/surefire-reports/TEST-*.xml
    expire_in: 1 week
```

**ğŸ¯ æŠ¥å‘Šæ–‡ä»¶è·¯å¾„ç¤ºä¾‹**
```
Javaé¡¹ç›®ï¼š
- Mavenï¼štarget/surefire-reports/TEST-*.xml
- Gradleï¼šbuild/test-results/test/TEST-*.xml

JavaScripté¡¹ç›®ï¼š
- Jestï¼šjunit.xml
- Mochaï¼štest-results.xml

Pythoné¡¹ç›®ï¼š
- pytestï¼špytest-report.xml
- unittestï¼šunittest-results.xml
```

### 6.3 ä»£ç è¦†ç›–ç‡æŠ¥å‘Š


**ğŸ“ˆ CoverageæŠ¥å‘Šç¤ºä¾‹**
```yaml
test_with_coverage:
  stage: test
  script:
    - mvn test jacoco:report
  artifacts:
    reports:
      coverage_report:
        coverage_format: cobertura
        path: target/site/jacoco/jacoco.xml
    expire_in: 2 weeks
```

**ğŸ·ï¸ æ”¯æŒçš„è¦†ç›–ç‡æ ¼å¼**

| æ ¼å¼ | å·¥å…· | æ–‡ä»¶åç¤ºä¾‹ |
|------|------|-----------|
| `cobertura` | JaCoCo, pytest-cov | `coverage.xml` |
| `jacoco` | JaCoCo | `jacoco.xml` |  
| `simplecov` | SimpleCov (Ruby) | `coverage.json` |

### 6.4 å¤šç§Reportsç»„åˆ


**ğŸ”§ ç»¼åˆæµ‹è¯•æŠ¥å‘Šç¤ºä¾‹**
```yaml
comprehensive_test:
  stage: test
  script:
    - npm test               # è¿è¡Œæµ‹è¯•
    - npm run coverage       # ç”Ÿæˆè¦†ç›–ç‡
    - npm run lint          # ä»£ç æ£€æŸ¥
  artifacts:
    when: always
    paths:
      - coverage/           # æ™®é€šåˆ¶å“ï¼šè¦†ç›–ç‡è¯¦ç»†æ–‡ä»¶
    reports:
      junit: junit.xml                    # æµ‹è¯•ç»“æœ
      coverage_report:
        coverage_format: cobertura  
        path: coverage/cobertura-coverage.xml
    expire_in: 1 month
```

**ğŸ“Š Reportså¸¦æ¥çš„ä»·å€¼**
```
GitLabç•Œé¢å±•ç¤ºï¼š
âœ… æµ‹è¯•é€šè¿‡ç‡ç»Ÿè®¡
âœ… ä»£ç è¦†ç›–ç‡è¶‹åŠ¿å›¾
âœ… å¤±è´¥æµ‹è¯•ç”¨ä¾‹è¯¦æƒ…
âœ… æ€§èƒ½æŒ‡æ ‡å˜åŒ–
âœ… å®‰å…¨æ‰«æç»“æœ
```

---

## 7. ğŸ” åˆ¶å“å­˜å‚¨ä¸æƒé™ç®¡ç†


### 7.1 åˆ¶å“å­˜å‚¨ä½ç½®


**ğŸ’¾ å­˜å‚¨æ¶æ„å›¾**
```
GitLabæœåŠ¡å™¨
â”œâ”€â”€ é¡¹ç›®å­˜å‚¨
â”‚   â”œâ”€â”€ æºä»£ç ä»“åº“
â”‚   â””â”€â”€ Artifactså­˜å‚¨
â”‚       â”œâ”€â”€ Job #123 åˆ¶å“
â”‚       â”œâ”€â”€ Job #124 åˆ¶å“
â”‚       â””â”€â”€ ...
â””â”€â”€ å…¨å±€é…ç½®
    â”œâ”€â”€ å­˜å‚¨é™åˆ¶
    â””â”€â”€ æ¸…ç†ç­–ç•¥
```

**ğŸ”¸ å­˜å‚¨ç©ºé—´ç®¡ç†**
```yaml
# é¡¹ç›®çº§åˆ«çš„å­˜å‚¨è®¾ç½®ï¼ˆåœ¨é¡¹ç›®è®¾ç½®ä¸­é…ç½®ï¼‰
é¡¹ç›®è®¾ç½® â†’ CI/CD â†’ General pipelinesï¼š
- åˆ¶å“æœ€å¤§å¤§å°ï¼š100MBï¼ˆå•ä¸ªJobï¼‰
- é¡¹ç›®æ€»å­˜å‚¨é™åˆ¶ï¼š1GB
- è‡ªåŠ¨æ¸…ç†ç­–ç•¥ï¼š30å¤©ååˆ é™¤
```

### 7.2 åˆ¶å“è®¿é—®æƒé™


**ğŸ‘¥ æƒé™çº§åˆ«è¯´æ˜**

| è§’è‰² | æŸ¥çœ‹åˆ¶å“ | ä¸‹è½½åˆ¶å“ | åˆ é™¤åˆ¶å“ |
|------|----------|----------|----------|
| Guest | âŒ | âŒ | âŒ |
| Reporter | âœ… | âœ… | âŒ |
| Developer | âœ… | âœ… | âŒ |
| Maintainer | âœ… | âœ… | âœ… |
| Owner | âœ… | âœ… | âœ… |

**ğŸ” ç§æœ‰é¡¹ç›®åˆ¶å“è®¿é—®**
```yaml
# ç§æœ‰é¡¹ç›®ä¸­ï¼Œåˆ¶å“è®¿é—®éœ€è¦è®¤è¯
download_artifacts:
  stage: deploy
  script:
    # ä½¿ç”¨é¡¹ç›®è®¿é—®ä»¤ç‰Œä¸‹è½½åˆ¶å“
    - 'curl --header "PRIVATE-TOKEN: $ACCESS_TOKEN" 
       "$CI_SERVER_URL/api/v4/projects/$CI_PROJECT_ID/jobs/123/artifacts"'
```

### 7.3 åˆ¶å“ä¸‹è½½æ–¹å¼


**ğŸŒ Webç•Œé¢ä¸‹è½½**
```
ä¸‹è½½è·¯å¾„ï¼š
é¡¹ç›®é¡µé¢ â†’ CI/CD â†’ Pipelines â†’ é€‰æ‹©Pipeline â†’ é€‰æ‹©Job â†’ å³ä¾§ArtifactsåŒºåŸŸ
```

**ğŸ”§ APIæ–¹å¼ä¸‹è½½**
```bash
# ä¸‹è½½ç‰¹å®šJobçš„åˆ¶å“
curl --location --header "PRIVATE-TOKEN: <access_token>" \
     "https://gitlab.example.com/api/v4/projects/1/jobs/123/artifacts"

# ä¸‹è½½æœ€æ–°æˆåŠŸæ„å»ºçš„åˆ¶å“
curl --location --header "PRIVATE-TOKEN: <access_token>" \
     "https://gitlab.example.com/api/v4/projects/1/jobs/artifacts/main/download?job=build"
```

### 7.4 åˆ¶å“æ¸…ç†ç­–ç•¥


**ğŸ—‘ï¸ è‡ªåŠ¨æ¸…ç†é…ç½®**
```yaml
# åœ¨gitlab-ci.ymlä¸­é…ç½®ä¸åŒçš„è¿‡æœŸç­–ç•¥
cleanup_policy:
  stage: maintenance
  script:
    - echo "æ¸…ç†è¿‡æœŸåˆ¶å“"
  artifacts:
    expire_in: never         # è¿™ä¸ªJobæœ¬èº«ä¸äº§ç”Ÿåˆ¶å“
  only:
    - schedules             # åªåœ¨å®šæ—¶ä»»åŠ¡ä¸­è¿è¡Œ
```

**ğŸ“Š å­˜å‚¨ä¼˜åŒ–å»ºè®®**
```
å­˜å‚¨ä¼˜åŒ–ç­–ç•¥ï¼š
1. è®¾ç½®åˆç†è¿‡æœŸæ—¶é—´ï¼ˆé¿å…neverï¼‰
2. æ’é™¤ä¸å¿…è¦æ–‡ä»¶ï¼ˆæ—¥å¿—ã€ä¸´æ—¶æ–‡ä»¶ï¼‰
3. å‹ç¼©å¤§æ–‡ä»¶ï¼ˆä½¿ç”¨zipã€tar.gzï¼‰
4. å®šæœŸæ¸…ç†å†å²åˆ¶å“
5. ç›‘æ§å­˜å‚¨ä½¿ç”¨é‡
```

---

## 8. ğŸš€ å®æˆ˜åº”ç”¨åœºæ™¯


### 8.1 å‰ç«¯é¡¹ç›®å®Œæ•´æµç¨‹


**ğŸ“± React/Vueé¡¹ç›®ç¤ºä¾‹**
```yaml
stages:
  - install
  - build
  - test
  - deploy

# ä¾èµ–å®‰è£…
install_deps:
  stage: install
  script:
    - npm ci
  artifacts:
    paths:
      - node_modules/
    expire_in: 1 hour
  cache:
    key: npm-$CI_COMMIT_REF_SLUG
    paths:
      - node_modules/

# æ„å»ºåº”ç”¨
build_app:
  stage: build
  script:
    - npm run build
  artifacts:
    name: "frontend-$CI_COMMIT_SHORT_SHA"
    paths:
      - dist/
      - package.json        # ç‰ˆæœ¬ä¿¡æ¯
    expire_in: 1 week
  dependencies:
    - install_deps

# è¿è¡Œæµ‹è¯•
test_app:
  stage: test
  script:
    - npm run test:ci
  artifacts:
    when: always
    reports:
      junit: junit.xml
      coverage_report:
        coverage_format: cobertura
        path: coverage/cobertura-coverage.xml
    paths:
      - coverage/
    expire_in: 2 weeks
  dependencies:
    - install_deps

# éƒ¨ç½²åˆ°ç”Ÿäº§
deploy_prod:
  stage: deploy
  script:
    - aws s3 sync dist/ s3://my-website-bucket/
  dependencies:
    - build_app           # åªéœ€è¦æ„å»ºäº§ç‰©
  only:
    - main
```

### 8.2 Javaå¾®æœåŠ¡é¡¹ç›®


**â˜• Spring Bootåº”ç”¨ç¤ºä¾‹**
```yaml
stages:
  - build
  - test
  - package
  - deploy

# ç¼–è¯‘æ„å»º
maven_build:
  stage: build
  script:
    - mvn compile
  artifacts:
    paths:
      - target/classes/
    expire_in: 2 hours

# å•å…ƒæµ‹è¯•
unit_test:
  stage: test
  script:
    - mvn test
  artifacts:
    when: always
    reports:
      junit: target/surefire-reports/TEST-*.xml
      coverage_report:
        coverage_format: jacoco
        path: target/site/jacoco/jacoco.xml
    expire_in: 1 week
  dependencies:
    - maven_build

# æ‰“åŒ…åº”ç”¨
package_app:
  stage: package
  script:
    - mvn package -DskipTests
  artifacts:
    name: "microservice-$CI_COMMIT_TAG"
    paths:
      - target/*.jar
      - Dockerfile
      - docker-compose.yml
    expire_in: 1 month
  dependencies:
    - maven_build
  only:
    - tags

# Dockeræ„å»º
build_docker:
  stage: package
  script:
    - docker build -t $CI_REGISTRY_IMAGE:$CI_COMMIT_SHA .
    - docker push $CI_REGISTRY_IMAGE:$CI_COMMIT_SHA
  dependencies:
    - package_app
```

### 8.3 å¤šç¯å¢ƒéƒ¨ç½²ç­–ç•¥


**ğŸŒ ç¯å¢ƒé…ç½®ç®¡ç†**
```yaml
# æ„å»ºä¸€æ¬¡ï¼Œå¤šç¯å¢ƒéƒ¨ç½²
build_once:
  stage: build
  script:
    - npm run build
  artifacts:
    name: "app-universal-$CI_PIPELINE_ID"
    paths:
      - dist/
      - config/              # åŒ…å«æ‰€æœ‰ç¯å¢ƒé…ç½®
    expire_in: 1 month

# å¼€å‘ç¯å¢ƒéƒ¨ç½²
deploy_dev:
  stage: deploy
  script:
    - cp config/dev.env .env
    - docker-compose up -d
  dependencies:
    - build_once
  environment:
    name: development
    url: https://dev.example.com
  only:
    - develop

# æµ‹è¯•ç¯å¢ƒéƒ¨ç½²
deploy_test:
  stage: deploy
  script:
    - cp config/test.env .env
    - kubectl apply -f k8s/
  dependencies:
    - build_once
  environment:
    name: testing
    url: https://test.example.com
  only:
    - /^release\/.*/

# ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
deploy_prod:
  stage: deploy
  script:
    - cp config/prod.env .env
    - helm upgrade --install myapp ./helm-chart
  dependencies:
    - build_once
  environment:
    name: production
    url: https://example.com
  when: manual              # æ‰‹åŠ¨è§¦å‘
  only:
    - main
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„åŸºç¡€æ¦‚å¿µ


```
ğŸ¯ Artifactsæœ¬è´¨ï¼š
â€¢ æµæ°´çº¿Jobäº§ç”Ÿçš„æ–‡ä»¶ä¿å­˜æœºåˆ¶
â€¢ è§£å†³Jobé—´æ–‡ä»¶ä¼ é€’é—®é¢˜
â€¢ æä¾›ä¸‹è½½å’Œå±•ç¤ºåŠŸèƒ½
â€¢ æ”¯æŒè‡ªåŠ¨è¿‡æœŸç®¡ç†

ğŸ”§ æ ¸å¿ƒé…ç½®ï¼š
â€¢ pathsï¼šæŒ‡å®šä¿å­˜çš„æ–‡ä»¶è·¯å¾„
â€¢ expire_inï¼šè®¾ç½®è¿‡æœŸæ—¶é—´
â€¢ dependenciesï¼šæ§åˆ¶åˆ¶å“ä¸‹è½½
â€¢ reportsï¼šç‰¹æ®ŠæŠ¥å‘Šç±»å‹
```

### 9.2 å…³é”®é…ç½®è¦ç‚¹


**ğŸ”¹ è·¯å¾„é…ç½®æœ€ä½³å®è·µ**
```
æ¨èåšæ³•ï¼š
âœ… ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼ˆportableï¼‰
âœ… åˆ©ç”¨é€šé…ç¬¦ï¼ˆçµæ´»åŒ¹é…ï¼‰
âœ… æ’é™¤ä¸å¿…è¦æ–‡ä»¶ï¼ˆèŠ‚çœç©ºé—´ï¼‰
âœ… åˆç†å‘½ååˆ¶å“ï¼ˆä¾¿äºè¯†åˆ«ï¼‰

é¿å…åšæ³•ï¼š
âŒ ç»å¯¹è·¯å¾„ï¼ˆç¯å¢ƒç›¸å…³ï¼‰
âŒ ä¿å­˜æºä»£ç ï¼ˆæµªè´¹ç©ºé—´ï¼‰
âŒ ä¿å­˜æ—¥å¿—æ–‡ä»¶ï¼ˆæ— ç”¨ä¿¡æ¯ï¼‰
âŒ è®¾ç½®æ°¸ä¸è¿‡æœŸï¼ˆå ç”¨å­˜å‚¨ï¼‰
```

**ğŸ”¹ ç”Ÿå‘½å‘¨æœŸç®¡ç†**
```
è¿‡æœŸæ—¶é—´ç­–ç•¥ï¼š
ä¸´æ—¶éªŒè¯ï¼š1-2å°æ—¶
å¼€å‘è°ƒè¯•ï¼š1-3å¤©
æµ‹è¯•ç‰ˆæœ¬ï¼š1-2å‘¨
å‘å¸ƒç‰ˆæœ¬ï¼š1-6ä¸ªæœˆ

å­˜å‚¨ä¼˜åŒ–ï¼š
å®šæœŸæ¸…ç† + åˆç†è¿‡æœŸ + æ–‡ä»¶æ’é™¤ = å­˜å‚¨é«˜æ•ˆåˆ©ç”¨
```

### 9.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ’¼ ä¸šåŠ¡åœºæ™¯åº”ç”¨**
- **å‰ç«¯é¡¹ç›®**ï¼šæ„å»ºäº§ç‰©(dist)ä¼ é€’ç»™éƒ¨ç½²Job
- **åç«¯æœåŠ¡**ï¼šç¼–è¯‘åçš„jar/waråŒ…ç”¨äºæµ‹è¯•å’Œéƒ¨ç½²
- **ç§»åŠ¨åº”ç”¨**ï¼šAPK/IPAæ–‡ä»¶æä¾›ç»™æµ‹è¯•å›¢é˜Ÿä¸‹è½½
- **æ–‡æ¡£ç”Ÿæˆ**ï¼šAPIæ–‡æ¡£ã€æµ‹è¯•æŠ¥å‘Šç­‰ä¾›å›¢é˜ŸæŸ¥çœ‹

**ğŸ¨ Reportsçš„ç‰¹æ®Šä»·å€¼**
- **æµ‹è¯•ç»“æœå¯è§†åŒ–**ï¼šç›´æ¥åœ¨GitLabç•Œé¢æŸ¥çœ‹æµ‹è¯•é€šè¿‡ç‡
- **ä»£ç è¦†ç›–ç‡è¶‹åŠ¿**ï¼šè·Ÿè¸ªä»£ç è´¨é‡å˜åŒ–
- **æ€§èƒ½ç›‘æ§**ï¼šæ€§èƒ½æµ‹è¯•ç»“æœå›¾è¡¨åŒ–å±•ç¤º
- **å®‰å…¨æŠ¥å‘Š**ï¼šå®‰å…¨æ‰«æç»“æœé›†ä¸­å±•ç¤º

### 9.4 å¸¸è§é—®é¢˜ä¸è§£å†³


**ğŸ”§ æ•…éšœæ’æŸ¥æŒ‡å—**

```
â“ åˆ¶å“æ²¡æœ‰ä¿å­˜ï¼Ÿ
æ£€æŸ¥ï¼špathsè·¯å¾„æ˜¯å¦æ­£ç¡®ã€æ–‡ä»¶æ˜¯å¦å­˜åœ¨

â“ æ— æ³•ä¸‹è½½åˆ¶å“ï¼Ÿ
æ£€æŸ¥ï¼šæƒé™è®¾ç½®ã€è¿‡æœŸæ—¶é—´ã€JobçŠ¶æ€

â“ åˆ¶å“å¤ªå¤§ï¼Ÿ
è§£å†³ï¼šæ·»åŠ excludeæ’é™¤ã€å‹ç¼©æ–‡ä»¶ã€åˆ†å‰²åˆ¶å“

â“ å­˜å‚¨ç©ºé—´ä¸è¶³ï¼Ÿ
è§£å†³ï¼šè®¾ç½®åˆç†è¿‡æœŸã€æ¸…ç†å†å²åˆ¶å“ã€ä¼˜åŒ–æ–‡ä»¶å¤§å°
```

**âš¡ æ€§èƒ½ä¼˜åŒ–æŠ€å·§**
```
æå‡æ•ˆç‡çš„æ–¹æ³•ï¼š
1. ç²¾ç¡®ä¾èµ–ï¼ˆdependenciesï¼‰å‡å°‘ä¸‹è½½æ—¶é—´
2. åˆç†è¿‡æœŸæ—¶é—´å¹³è¡¡å­˜å‚¨å’Œéœ€æ±‚
3. æ–‡ä»¶å‹ç¼©å‡å°‘ä¼ è¾“æ—¶é—´
4. å¹¶è¡ŒJobå‡å°‘ç­‰å¾…æ—¶é—´
```

### 9.5 å­¦ä¹ è¿›é˜¶è·¯å¾„


**ğŸ“ˆ æŒæ¡ç¨‹åº¦æ£€æŸ¥**
- [ ] ç†è§£ArtifactsåŸºæœ¬æ¦‚å¿µå’Œä½œç”¨
- [ ] ä¼šé…ç½®åŸºç¡€çš„pathså’Œexpire_in
- [ ] æŒæ¡dependenciesçš„ä½¿ç”¨
- [ ] äº†è§£Reportsç±»å‹çš„é…ç½®
- [ ] èƒ½è®¾è®¡å®Œæ•´é¡¹ç›®çš„åˆ¶å“ç­–ç•¥

**ğŸ¯ ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®®**
```
åŸºç¡€å·©å›ºï¼š
â†’ ç»ƒä¹ ä¸åŒç±»å‹é¡¹ç›®çš„åˆ¶å“é…ç½®
â†’ ç†Ÿæ‚‰å¸¸è§Reportsæ ¼å¼

è¿›é˜¶å­¦ä¹ ï¼š
â†’ å­¦ä¹ GitLab Package Registry
â†’ äº†è§£Dockeré•œåƒç®¡ç†
â†’ æŒæ¡å¤šé¡¹ç›®åˆ¶å“å…±äº«
```

**ğŸ’¡ æ ¸å¿ƒè®°å¿†**
- Artifactsè®©Jobäº§ç”Ÿçš„æ–‡ä»¶å¯ä»¥ä¿å­˜å’Œä¼ é€’
- é€šè¿‡pathsæŒ‡å®šæ–‡ä»¶ï¼Œexpire_inæ§åˆ¶ç”Ÿå‘½å‘¨æœŸ
- dependenciesç²¾ç¡®æ§åˆ¶åˆ¶å“ä¸‹è½½ï¼Œä¼˜åŒ–æ€§èƒ½
- Reportsæä¾›æµ‹è¯•ç»“æœç­‰çš„å¯è§†åŒ–å±•ç¤º
- åˆç†çš„åˆ¶å“ç­–ç•¥å¹³è¡¡åŠŸèƒ½éœ€æ±‚å’Œå­˜å‚¨æˆæœ¬