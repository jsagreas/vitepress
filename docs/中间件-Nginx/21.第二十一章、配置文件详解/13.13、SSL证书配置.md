---
title: 13ã€SSLè¯ä¹¦é…ç½®
---
## ğŸ“š ç›®å½•

1. [SSLåŸºç¡€æ¦‚å¿µç†è§£](#1-sslåŸºç¡€æ¦‚å¿µç†è§£)
2. [SSLè¯ä¹¦é…ç½®åŸºç¡€](#2-sslè¯ä¹¦é…ç½®åŸºç¡€)
3. [SSLåè®®ä¸åŠ å¯†å¥—ä»¶](#3-sslåè®®ä¸åŠ å¯†å¥—ä»¶)
4. [SSLä¼šè¯ç®¡ç†](#4-sslä¼šè¯ç®¡ç†)
5. [OCSPè£…è®¢æŠ€æœ¯](#5-ocspè£…è®¢æŠ€æœ¯)
6. [SSLå®‰å…¨é…ç½®æœ€ä½³å®è·µ](#6-sslå®‰å…¨é…ç½®æœ€ä½³å®è·µ)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” SSLåŸºç¡€æ¦‚å¿µç†è§£


### 1.1 ä»€ä¹ˆæ˜¯SSLï¼Ÿä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ


**ğŸ”¸ SSLçš„æœ¬è´¨ç†è§£**
```
SSLå°±åƒç»™ç½‘ç»œé€šä¿¡åŠ äº†ä¸€ä¸ª"ä¿é™©ç®±"

æ²¡æœ‰SSLçš„HTTPï¼š
ç”¨æˆ· â†â†’ æ˜æ–‡ä¼ è¾“ â†â†’ æœåŠ¡å™¨
å°±åƒå¯„æ˜ä¿¡ç‰‡ï¼Œä»»ä½•äººéƒ½èƒ½çœ‹åˆ°å†…å®¹

æœ‰äº†SSLçš„HTTPSï¼š
ç”¨æˆ· â†â†’ åŠ å¯†ä¼ è¾“ â†â†’ æœåŠ¡å™¨
å°±åƒå¯„å¯†å‡½ï¼Œåªæœ‰æ”¶ä»¶äººèƒ½çœ‹æ‡‚
```

**ğŸ’¡ é€šä¿—ç±»æ¯”**
> æƒ³è±¡ä½ è¦ç»™æœ‹å‹å¯„é’±ï¼š
> - **HTTP**ï¼šæŠŠé’±ç›´æ¥æ”¾åœ¨é€æ˜è¢‹å­é‡Œå¯„å‡ºå»ï¼Œè·¯ä¸Šä»»ä½•äººéƒ½èƒ½çœ‹åˆ°
> - **HTTPS**ï¼šæŠŠé’±æ”¾åœ¨å¯†ç ç®±é‡Œï¼Œåªæœ‰ä½ æœ‹å‹çŸ¥é“å¯†ç æ‰èƒ½æ‰“å¼€

**ğŸ¯ SSLè§£å†³çš„æ ¸å¿ƒé—®é¢˜**
- **ğŸ”’ æ•°æ®åŠ å¯†**ï¼šé˜²æ­¢æ•°æ®è¢«çªƒå¬
- **ğŸ”‘ èº«ä»½éªŒè¯**ï¼šç¡®è®¤ä½ è®¿é—®çš„æ˜¯çœŸæ­£çš„ç½‘ç«™
- **âœ… æ•°æ®å®Œæ•´æ€§**ï¼šç¡®ä¿æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«ç¯¡æ”¹

### 1.2 SSLå·¥ä½œåŸç†ç®€åŒ–ç†è§£


**ğŸ“Š SSLæ¡æ‰‹è¿‡ç¨‹**
```
å®¢æˆ·ç«¯                                æœåŠ¡å™¨
   |                                    |
   |--[1] ä½ å¥½ï¼Œæˆ‘æƒ³å»ºç«‹å®‰å…¨è¿æ¥--------->|
   |                                    |
   |<-[2] å¥½çš„ï¼Œè¿™æ˜¯æˆ‘çš„è¯ä¹¦ï¼ˆèº«ä»½è¯ï¼‰----|
   |                                    |
   |--[3] è¯ä¹¦éªŒè¯é€šè¿‡ï¼Œè¿™æ˜¯å¯†é’¥--------->|
   |                                    |
   |<-[4] æ”¶åˆ°ï¼Œå¼€å§‹åŠ å¯†é€šä¿¡--------------|
   |                                    |
```

**ğŸ”‘ å…³é”®ç†è§£ç‚¹**
- **è¯ä¹¦**ï¼šç½‘ç«™çš„"èº«ä»½è¯"ï¼Œè¯æ˜"æˆ‘å°±æ˜¯æ·˜å®ç½‘"
- **å¯†é’¥**ï¼šåŒæ–¹çº¦å®šçš„"æš—å·"ï¼Œç”¨æ¥åŠ å¯†è§£å¯†æ•°æ®
- **æ¡æ‰‹**ï¼šå»ºç«‹ä¿¡ä»»å…³ç³»çš„è¿‡ç¨‹ï¼Œå°±åƒè§é¢å…ˆäº¤æ¢åç‰‡

---

## 2. ğŸ“‹ SSLè¯ä¹¦é…ç½®åŸºç¡€


### 2.1 ssl_certificate - è¯ä¹¦æ–‡ä»¶é…ç½®


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µ**
```nginx
# ssl_certificate æŒ‡å®šè¯ä¹¦æ–‡ä»¶çš„ä½ç½®
ssl_certificate /path/to/your/certificate.crt;
```

**ğŸ’¡ é€šä¿—ç†è§£**
> è¿™å°±åƒå‘Šè¯‰Nginxï¼š"æˆ‘çš„èº«ä»½è¯æ”¾åœ¨å“ªé‡Œ"
> å½“æœ‰å®¢æˆ·ç«¯è¿æ¥æ—¶ï¼ŒNginxä¼šæ‹¿å‡ºè¿™ä¸ª"èº«ä»½è¯"ç»™å¯¹æ–¹éªŒè¯

**ğŸ“‚ è¯ä¹¦æ–‡ä»¶ç±»å‹ç†è§£**
```
.crt/.pemæ–‡ä»¶ï¼šè¯ä¹¦æ–‡ä»¶ï¼ˆå…¬å¼€çš„èº«ä»½è¯ï¼‰
åŒ…å«å†…å®¹ï¼š
- ç½‘ç«™åŸŸåä¿¡æ¯
- å…¬é’¥ä¿¡æ¯  
- è¯ä¹¦é¢å‘æœºæ„ä¿¡æ¯
- æœ‰æ•ˆæœŸç­‰

ä½œç”¨ï¼šå‘è®¿é—®è€…è¯æ˜"æˆ‘æ˜¯çœŸçš„æ·˜å®ç½‘ï¼Œä¸æ˜¯å‡å†’çš„"
```

**ğŸ› ï¸ å®é™…é…ç½®ç¤ºä¾‹**
```nginx
server {
    listen 443 ssl;
    server_name www.example.com;
    
    # è¯ä¹¦æ–‡ä»¶è·¯å¾„ - ç½‘ç«™çš„"èº«ä»½è¯"
    ssl_certificate /etc/nginx/ssl/www.example.com.crt;
    
    location / {
        root /var/www/html;
        index index.html;
    }
}
```

### 2.2 ssl_certificate_key - ç§é’¥æ–‡ä»¶é…ç½®


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µ**
```nginx
# ssl_certificate_key æŒ‡å®šç§é’¥æ–‡ä»¶çš„ä½ç½®
ssl_certificate_key /path/to/your/private.key;
```

**ğŸ’¡ é€šä¿—ç†è§£**
> å¦‚æœè¯ä¹¦æ˜¯"èº«ä»½è¯"ï¼Œé‚£ä¹ˆç§é’¥å°±æ˜¯"ç­¾å"
> åªæœ‰çœŸæ­£çš„ç½‘ç«™æ‹¥æœ‰è€…æ‰æœ‰è¿™ä¸ªç§é’¥ï¼Œç”¨æ¥è¯æ˜èº«ä»½çš„çœŸå®æ€§

**ğŸ” ç§é’¥çš„é‡è¦æ€§**
```
ç§é’¥æ–‡ä»¶ç‰¹ç‚¹ï¼š
â— ç»å¯¹ä¿å¯†ï¼šå°±åƒé“¶è¡Œå¡å¯†ç ï¼Œä¸èƒ½æ³„éœ²
â— å”¯ä¸€æ€§ï¼šæ¯ä¸ªè¯ä¹¦å¯¹åº”å”¯ä¸€ç§é’¥
â— ä¸å¯æ¢å¤ï¼šä¸¢å¤±äº†åªèƒ½é‡æ–°ç”³è¯·è¯ä¹¦

å®‰å…¨è¦æ±‚ï¼š
- æ–‡ä»¶æƒé™è®¾ç½®ä¸º600ï¼ˆåªæœ‰ownerèƒ½è¯»å†™ï¼‰
- ä¸èƒ½æ”¾åœ¨webç›®å½•ä¸‹
- å®šæœŸå¤‡ä»½ä½†è¦åŠ å¯†ä¿å­˜
```

**ğŸ› ï¸ å®Œæ•´é…ç½®ç¤ºä¾‹**
```nginx
server {
    listen 443 ssl;
    server_name www.example.com;
    
    # è¯ä¹¦å’Œç§é’¥é…ç½®
    ssl_certificate     /etc/nginx/ssl/www.example.com.crt;
    ssl_certificate_key /etc/nginx/ssl/www.example.com.key;
    
    # ç¡®ä¿ç§é’¥æ–‡ä»¶å®‰å…¨
    # åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼šchmod 600 /etc/nginx/ssl/www.example.com.key
}
```

---

## 3. ğŸ”§ SSLåè®®ä¸åŠ å¯†å¥—ä»¶


### 3.1 ssl_protocols - æ”¯æŒçš„SSL/TLSåè®®ç‰ˆæœ¬


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µ**
```nginx
# æŒ‡å®šæ”¯æŒå“ªäº›SSL/TLSåè®®ç‰ˆæœ¬
ssl_protocols TLSv1.2 TLSv1.3;
```

**ğŸ’¡ åè®®ç‰ˆæœ¬ç†è§£**
```
SSL/TLSåè®®å‘å±•å†å²ï¼š
SSLv2 (1995) â†’ å·²åºŸå¼ƒï¼Œæ¼æ´å¤ªå¤š
SSLv3 (1996) â†’ å·²åºŸå¼ƒï¼Œä¸å®‰å…¨
TLSv1.0 (1999) â†’ å·²åºŸå¼ƒï¼Œè€æ—§
TLSv1.1 (2006) â†’ å·²åºŸå¼ƒï¼Œå®‰å…¨æ€§ä¸å¤Ÿ
TLSv1.2 (2008) â†’ âœ… ç›®å‰ä¸»æµï¼Œå®‰å…¨å¯é 
TLSv1.3 (2018) â†’ âœ… æœ€æ–°ç‰ˆæœ¬ï¼Œæ€§èƒ½æ›´å¥½
```

**ğŸ¯ ç‰ˆæœ¬é€‰æ‹©ç­–ç•¥**
| ğŸ¯ **åœºæ™¯** | **æ¨èé…ç½®** | **è¯´æ˜** |
|-------------|--------------|----------|
| ğŸ¢ **ç°ä»£ç½‘ç«™** | `TLSv1.2 TLSv1.3` | å¹³è¡¡å®‰å…¨ä¸å…¼å®¹æ€§ |
| ğŸ”’ **é«˜å®‰å…¨è¦æ±‚** | `TLSv1.3` | ä»…æ”¯æŒæœ€æ–°åè®® |
| ğŸ”§ **å…¼å®¹è€è®¾å¤‡** | `TLSv1.1 TLSv1.2 TLSv1.3` | æ”¯æŒæ›´å¤šè®¾å¤‡ |

**âš ï¸ å®‰å…¨å»ºè®®**
```nginx
# âœ… æ¨èé…ç½®ï¼šåªæ”¯æŒå®‰å…¨çš„åè®®ç‰ˆæœ¬
ssl_protocols TLSv1.2 TLSv1.3;

# âŒ ä¸æ¨èï¼šåŒ…å«ä¸å®‰å…¨çš„è€åè®®
ssl_protocols SSLv3 TLSv1.0 TLSv1.1 TLSv1.2;
```

### 3.2 ssl_ciphers - åŠ å¯†å¥—ä»¶é…ç½®


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µ**
```nginx
# æŒ‡å®šæ”¯æŒçš„åŠ å¯†ç®—æ³•å¥—ä»¶
ssl_ciphers 'ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384';
```

**ğŸ’¡ åŠ å¯†å¥—ä»¶ç†è§£**
> åŠ å¯†å¥—ä»¶å°±åƒ"å¯†ç æœ¬"çš„è§„åˆ™
> å®ƒè§„å®šäº†ç”¨ä»€ä¹ˆæ–¹æ³•æ¥åŠ å¯†æ•°æ®ã€éªŒè¯èº«ä»½ã€äº¤æ¢å¯†é’¥

**ğŸ” åŠ å¯†å¥—ä»¶ç»„æˆéƒ¨åˆ†**
```
ECDHE-RSA-AES128-GCM-SHA256 è§£æï¼š

ECDHE: å¯†é’¥äº¤æ¢ç®—æ³•ï¼ˆå¦‚ä½•å®‰å…¨åœ°äº¤æ¢å¯†é’¥ï¼‰
RSA:   èº«ä»½éªŒè¯ç®—æ³•ï¼ˆå¦‚ä½•éªŒè¯èº«ä»½ï¼‰
AES128: å¯¹ç§°åŠ å¯†ç®—æ³•ï¼ˆå¦‚ä½•åŠ å¯†å®é™…æ•°æ®ï¼‰
GCM:   åŠ å¯†æ¨¡å¼ï¼ˆå¦‚ä½•ä½¿ç”¨åŠ å¯†ç®—æ³•ï¼‰
SHA256: å“ˆå¸Œç®—æ³•ï¼ˆå¦‚ä½•éªŒè¯æ•°æ®å®Œæ•´æ€§ï¼‰
```

**ğŸ¯ å®‰å…¨ç­‰çº§å¯¹æ¯”**
| ğŸ” **å®‰å…¨çº§åˆ«** | **æ¨èå¥—ä»¶** | **ç‰¹ç‚¹** |
|----------------|--------------|----------|
| ğŸŸ¢ **é«˜å®‰å…¨** | `ECDHE-RSA-AES256-GCM-SHA384` | æœ€å¼ºåŠ å¯†ï¼Œæ€§èƒ½ç¨æ…¢ |
| ğŸŸ¡ **å¹³è¡¡** | `ECDHE-RSA-AES128-GCM-SHA256` | å®‰å…¨æ€§èƒ½å¹³è¡¡ |
| ğŸ”´ **å…¼å®¹** | åŒ…å«æ›´å¤šç®—æ³• | å…¼å®¹è€è®¾å¤‡ï¼Œå®‰å…¨æ€§é™ä½ |

**ğŸ› ï¸ å®é™…é…ç½®ç¤ºä¾‹**
```nginx
server {
    listen 443 ssl;
    server_name www.example.com;
    
    # ç°ä»£å®‰å…¨é…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384';
}
```

### 3.3 ssl_prefer_server_ciphers - æœåŠ¡å™¨åŠ å¯†å¥—ä»¶ä¼˜å…ˆ


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µ**
```nginx
# æœåŠ¡å™¨å†³å®šä½¿ç”¨å“ªä¸ªåŠ å¯†å¥—ä»¶ï¼Œè€Œä¸æ˜¯å®¢æˆ·ç«¯
ssl_prefer_server_ciphers on;
```

**ğŸ’¡ é€šä¿—ç†è§£**
```
åå•†è¿‡ç¨‹ï¼š
å®¢æˆ·ç«¯ï¼šæˆ‘æ”¯æŒç®—æ³•Aã€Bã€C
æœåŠ¡å™¨ï¼šæˆ‘æ”¯æŒç®—æ³•Bã€Cã€D

ssl_prefer_server_ciphers offï¼ˆå®¢æˆ·ç«¯ä¼˜å…ˆï¼‰ï¼š
é€‰æ‹©Aï¼ˆå®¢æˆ·ç«¯åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªï¼‰

ssl_prefer_server_ciphers onï¼ˆæœåŠ¡å™¨ä¼˜å…ˆï¼‰ï¼š
é€‰æ‹©Bï¼ˆæœåŠ¡å™¨åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªï¼‰
```

**ğŸ¯ ä¸ºä»€ä¹ˆè¦æœåŠ¡å™¨ä¼˜å…ˆï¼Ÿ**
- **ğŸ”’ å®‰å…¨æ§åˆ¶**ï¼šæœåŠ¡å™¨ç®¡ç†å‘˜æ›´äº†è§£å®‰å…¨é…ç½®
- **âš¡ æ€§èƒ½ä¼˜åŒ–**ï¼šæœåŠ¡å™¨å¯ä»¥é€‰æ‹©æ€§èƒ½æœ€å¥½çš„ç®—æ³•
- **ğŸ›¡ï¸ é˜²æ­¢é™çº§æ”»å‡»**ï¼šé˜²æ­¢æ¶æ„å®¢æˆ·ç«¯å¼ºåˆ¶ä½¿ç”¨å¼±åŠ å¯†

---

## 4. âš¡ SSLä¼šè¯ç®¡ç†


### 4.1 ssl_session_cache - ä¼šè¯ç¼“å­˜é…ç½®


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µ**
```nginx
# ç¼“å­˜SSLä¼šè¯ä¿¡æ¯ï¼Œé¿å…é‡å¤æ¡æ‰‹
ssl_session_cache shared:SSL:10m;
```

**ğŸ’¡ é€šä¿—ç†è§£**
> SSLæ¡æ‰‹å°±åƒæ¯æ¬¡è§é¢éƒ½è¦é‡æ–°è‡ªæˆ‘ä»‹ç»
> ä¼šè¯ç¼“å­˜å°±åƒ"è®°ä½è€æœ‹å‹"ï¼Œä¸‹æ¬¡è§é¢å¯ä»¥ç›´æ¥èŠå¤©

**ğŸ“Š ä¼šè¯ç¼“å­˜ç±»å‹**
```
none: ä¸ä½¿ç”¨ç¼“å­˜
off:  ç¦ç”¨ç¼“å­˜
builtin: å†…ç½®ç¼“å­˜ï¼ˆå•workerè¿›ç¨‹ï¼‰
shared: å…±äº«ç¼“å­˜ï¼ˆå¤šworkerè¿›ç¨‹å…±äº«ï¼‰

æ¨èä½¿ç”¨sharedï¼Œå› ä¸ºï¼š
âœ… å¤šä¸ªworkerè¿›ç¨‹å…±äº«
âœ… å†…å­˜ä½¿ç”¨æ›´é«˜æ•ˆ
âœ… æ€§èƒ½æ›´å¥½
```

**ğŸ”§ ç¼“å­˜å¤§å°é…ç½®**
```nginx
# ä¸åŒè§„æ¨¡ç½‘ç«™çš„ç¼“å­˜é…ç½®
ssl_session_cache shared:SSL:1m;   # å°ç½‘ç«™ï¼šçº¦4000ä¸ªä¼šè¯
ssl_session_cache shared:SSL:10m;  # ä¸­å‹ç½‘ç«™ï¼šçº¦40000ä¸ªä¼šè¯  
ssl_session_cache shared:SSL:50m;  # å¤§å‹ç½‘ç«™ï¼šçº¦200000ä¸ªä¼šè¯
```

### 4.2 ssl_session_timeout - ä¼šè¯è¶…æ—¶è®¾ç½®


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µ**
```nginx
# SSLä¼šè¯çš„æœ‰æ•ˆæ—¶é—´
ssl_session_timeout 5m;
```

**ğŸ’¡ é€šä¿—ç†è§£**
> å°±åƒ"æœ‹å‹å…³ç³»ä¿è´¨æœŸ"
> 5åˆ†é’Ÿå†…å†æ¬¡è®¿é—®ï¼Œç›´æ¥è®¤è¯†ä¸ç”¨é‡æ–°ä»‹ç»
> è¶…è¿‡5åˆ†é’Ÿï¼Œéœ€è¦é‡æ–°æ¡æ‰‹

**âš–ï¸ è¶…æ—¶æ—¶é—´æƒè¡¡**
| â° **æ—¶é—´è®¾ç½®** | **ä¼˜åŠ¿** | **åŠ£åŠ¿** | **é€‚ç”¨åœºæ™¯** |
|----------------|----------|----------|-------------|
| ğŸŸ¢ **çŸ­æ—¶é—´(1-5åˆ†é’Ÿ)** | å®‰å…¨æ€§é«˜ | æ¡æ‰‹æ¬¡æ•°å¤š | é«˜å®‰å…¨è¦æ±‚ |
| ğŸŸ¡ **ä¸­ç­‰æ—¶é—´(5-10åˆ†é’Ÿ)** | å¹³è¡¡æ€§èƒ½å®‰å…¨ | - | ä¸€èˆ¬ç½‘ç«™ |
| ğŸ”´ **é•¿æ—¶é—´(30åˆ†é’Ÿ+)** | æ€§èƒ½æœ€å¥½ | å®‰å…¨é£é™© | å†…ç½‘ç¯å¢ƒ |

**ğŸ› ï¸ ä¼šè¯ç®¡ç†å®Œæ•´é…ç½®**
```nginx
server {
    listen 443 ssl;
    server_name www.example.com;
    
    # SSLä¼šè¯ç®¡ç†
    ssl_session_cache    shared:SSL:10m;  # 10MBç¼“å­˜ç©ºé—´
    ssl_session_timeout  5m;              # 5åˆ†é’Ÿè¶…æ—¶
    
    # å…¶ä»–SSLé…ç½®...
}
```

---

## 5. ğŸš€ OCSPè£…è®¢æŠ€æœ¯


### 5.1 ä»€ä¹ˆæ˜¯OCSPè£…è®¢ï¼Ÿ


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µç†è§£**
```
OCSP = Online Certificate Status Protocol
ä½œç”¨ï¼šå®æ—¶æ£€æŸ¥è¯ä¹¦æ˜¯å¦è¢«åŠé”€

ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜ï¼š
ç”¨æˆ· â†’ è¯ä¹¦é¢å‘æœºæ„ â†’ æ£€æŸ¥è¯ä¹¦çŠ¶æ€ â†’ è¿”å›ç»“æœ
é—®é¢˜ï¼šæ…¢ã€å¯èƒ½è¢«ç›‘å¬ã€å¢åŠ å»¶è¿Ÿ

OCSPè£…è®¢çš„è§£å†³æ–¹æ¡ˆï¼š
æœåŠ¡å™¨å®šæœŸå‘è¯ä¹¦é¢å‘æœºæ„è·å–è¯ä¹¦çŠ¶æ€
ç”¨æˆ·è®¿é—®æ—¶ï¼ŒæœåŠ¡å™¨ç›´æ¥æä¾›è¯ä¹¦çŠ¶æ€ä¿¡æ¯
```

**ğŸ’¡ ç”Ÿæ´»åŒ–ç±»æ¯”**
> **ä¼ ç»Ÿæ–¹å¼**ï¼šæ¯æ¬¡ä¹°ä¸œè¥¿éƒ½è¦æ‰“ç”µè¯é—®é“¶è¡Œ"è¿™å¼ å¡æœ‰æ•ˆå—ï¼Ÿ"
> **OCSPè£…è®¢**ï¼šå•†å®¶æå‰ç¡®è®¤è¿‡ï¼Œç›´æ¥å‘Šè¯‰ä½ "è¿™å¼ å¡æ˜¯æœ‰æ•ˆçš„"

### 5.2 ssl_stapling - å¯ç”¨OCSPè£…è®¢


**ğŸ”¸ åŸºæœ¬é…ç½®**
```nginx
# å¯ç”¨OCSPè£…è®¢
ssl_stapling on;
ssl_stapling_verify on;
```

**ğŸ¯ OCSPè£…è®¢çš„å¥½å¤„**
- **âš¡ æå‡æ€§èƒ½**ï¼šå‡å°‘å®¢æˆ·ç«¯çš„é¢å¤–è¯·æ±‚
- **ğŸ”’ å¢å¼ºéšç§**ï¼šå®¢æˆ·ç«¯ä¸ç›´æ¥è”ç³»è¯ä¹¦é¢å‘æœºæ„
- **âœ… æé«˜å¯é æ€§**ï¼šé¿å…å› OCSPæœåŠ¡å™¨é—®é¢˜å¯¼è‡´è®¿é—®å¤±è´¥

**ğŸ› ï¸ å®Œæ•´OCSPé…ç½®**
```nginx
server {
    listen 443 ssl;
    server_name www.example.com;
    
    # åŸºç¡€SSLé…ç½®
    ssl_certificate     /etc/nginx/ssl/cert.pem;
    ssl_certificate_key /etc/nginx/ssl/key.pem;
    
    # OCSPè£…è®¢é…ç½®
    ssl_stapling on;                          # å¯ç”¨OCSPè£…è®¢
    ssl_stapling_verify on;                   # éªŒè¯OCSPå“åº”
    ssl_trusted_certificate /etc/nginx/ssl/chain.pem;  # è¯ä¹¦é“¾æ–‡ä»¶
    
    # DNSè§£æå™¨ï¼ˆç”¨äºè§£æOCSPæœåŠ¡å™¨åœ°å€ï¼‰
    resolver 8.8.8.8 8.8.4.4 valid=300s;
    resolver_timeout 5s;
}
```

---

## 6. ğŸ›¡ï¸ SSLå®‰å…¨é…ç½®æœ€ä½³å®è·µ


### 6.1 å®Œæ•´çš„å®‰å…¨SSLé…ç½®æ¨¡æ¿


```nginx
server {
    listen 443 ssl http2;
    server_name www.example.com;
    
    # ğŸ“‹ è¯ä¹¦é…ç½®
    ssl_certificate     /etc/nginx/ssl/www.example.com.crt;
    ssl_certificate_key /etc/nginx/ssl/www.example.com.key;
    
    # ğŸ” åè®®å’ŒåŠ å¯†å¥—ä»¶
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384';
    ssl_prefer_server_ciphers off;  # TLS 1.3æ—¶å»ºè®®å…³é—­
    
    # âš¡ ä¼šè¯ç®¡ç†
    ssl_session_cache    shared:SSL:10m;
    ssl_session_timeout  5m;
    
    # ğŸš€ OCSPè£…è®¢
    ssl_stapling on;
    ssl_stapling_verify on;
    ssl_trusted_certificate /etc/nginx/ssl/chain.pem;
    
    # ğŸŒ DNSè§£æå™¨
    resolver 8.8.8.8 8.8.4.4 valid=300s;
    resolver_timeout 5s;
    
    # ğŸ›¡ï¸ å®‰å…¨å¤´éƒ¨
    add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload" always;
    add_header X-Frame-Options DENY always;
    add_header X-Content-Type-Options nosniff always;
    add_header Referrer-Policy "strict-origin-when-cross-origin" always;
    
    location / {
        root /var/www/html;
        index index.html index.htm;
    }
}

# HTTPè‡ªåŠ¨è·³è½¬åˆ°HTTPS
server {
    listen 80;
    server_name www.example.com;
    return 301 https://$server_name$request_uri;
}
```

### 6.2 SSLé…ç½®å®‰å…¨æ£€æŸ¥æ¸…å•


**âœ… å¿…åšé…ç½®æ£€æŸ¥**
- [ ] åªå¯ç”¨TLS 1.2å’Œ1.3åè®®
- [ ] ä½¿ç”¨å¼ºåŠ å¯†å¥—ä»¶
- [ ] ç§é’¥æ–‡ä»¶æƒé™è®¾ç½®ä¸º600
- [ ] å¯ç”¨OCSPè£…è®¢
- [ ] é…ç½®HSTSå®‰å…¨å¤´
- [ ] HTTPè‡ªåŠ¨è·³è½¬HTTPS

**ğŸ” é…ç½®éªŒè¯æ–¹æ³•**
```bash
# æ£€æŸ¥SSLé…ç½®
nginx -t

# æµ‹è¯•SSLå®‰å…¨æ€§ï¼ˆä½¿ç”¨åœ¨çº¿å·¥å…·ï¼‰
# SSL Labs: https://www.ssllabs.com/ssltest/
# è¾“å…¥ä½ çš„åŸŸåè¿›è¡Œæµ‹è¯•

# æ£€æŸ¥è¯ä¹¦æœ‰æ•ˆæœŸ
openssl x509 -in /etc/nginx/ssl/cert.pem -noout -dates
```

### 6.3 å¸¸è§SSLé…ç½®é—®é¢˜ä¸è§£å†³


**â— å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ**

| ğŸš« **é—®é¢˜** | **åŸå› ** | **è§£å†³æ–¹æ¡ˆ** |
|-------------|----------|-------------|
| è¯ä¹¦é”™è¯¯ | è¯ä¹¦è·¯å¾„é”™è¯¯æˆ–è¿‡æœŸ | æ£€æŸ¥è·¯å¾„å’Œæœ‰æ•ˆæœŸ |
| ç§é’¥ä¸åŒ¹é… | è¯ä¹¦å’Œç§é’¥ä¸å¯¹åº” | é‡æ–°ç”Ÿæˆæˆ–ç”³è¯· |
| åè®®ä¸æ”¯æŒ | å®¢æˆ·ç«¯ä¸æ”¯æŒé…ç½®çš„åè®® | æ·»åŠ å…¼å®¹åè®®ç‰ˆæœ¬ |
| OCSPå¤±è´¥ | DNSè§£ææˆ–ç½‘ç»œé—®é¢˜ | æ£€æŸ¥resolveré…ç½® |

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒé…ç½®


**ğŸ”¸ è¯ä¹¦é…ç½®**
```nginx
ssl_certificate     /path/to/cert.pem;      # è¯ä¹¦æ–‡ä»¶
ssl_certificate_key /path/to/key.pem;       # ç§é’¥æ–‡ä»¶
```

**ğŸ”¸ åè®®å®‰å…¨**
```nginx
ssl_protocols TLSv1.2 TLSv1.3;             # ä»…æ”¯æŒå®‰å…¨åè®®
ssl_ciphers 'ç°ä»£å®‰å…¨åŠ å¯†å¥—ä»¶';              # å¼ºåŠ å¯†ç®—æ³•
```

**ğŸ”¸ æ€§èƒ½ä¼˜åŒ–**
```nginx
ssl_session_cache shared:SSL:10m;           # ä¼šè¯ç¼“å­˜
ssl_session_timeout 5m;                     # ä¼šè¯è¶…æ—¶
```

**ğŸ”¸ å®‰å…¨å¢å¼º**
```nginx
ssl_stapling on;                            # OCSPè£…è®¢
ssl_stapling_verify on;                     # éªŒè¯OCSP
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ¯ SSLé…ç½®ä¸‰å¤§æ ¸å¿ƒ**
- **ğŸ” å®‰å…¨æ€§**ï¼šä½¿ç”¨å¼ºåè®®å’ŒåŠ å¯†å¥—ä»¶ï¼Œä¿æŠ¤æ•°æ®ä¼ è¾“
- **âš¡ æ€§èƒ½**ï¼šåˆç†é…ç½®ä¼šè¯ç¼“å­˜ï¼Œå‡å°‘æ¡æ‰‹å¼€é”€  
- **ğŸ›¡ï¸ å¯é æ€§**ï¼šå¯ç”¨OCSPè£…è®¢ï¼Œæå‡è¯ä¹¦éªŒè¯æ•ˆç‡

**ğŸ”¹ é…ç½®å±‚æ¬¡ç†è§£**
```
åŸºç¡€å±‚ï¼šèƒ½ç”¨ï¼ˆè¯ä¹¦+ç§é’¥ï¼‰
å®‰å…¨å±‚ï¼šå®‰å…¨å¯é ï¼ˆå¼ºåè®®+åŠ å¯†ï¼‰
ä¼˜åŒ–å±‚ï¼šé«˜æ€§èƒ½ï¼ˆç¼“å­˜+OCSPï¼‰
```

### 7.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ’¼ ä¸šåŠ¡åº”ç”¨åœºæ™¯**
- **ğŸ›’ ç”µå•†ç½‘ç«™**ï¼šä¿æŠ¤ç”¨æˆ·æ”¯ä»˜ä¿¡æ¯å’Œä¸ªäººæ•°æ®
- **ğŸ¦ é‡‘èç³»ç»Ÿ**ï¼šæ»¡è¶³ä¸¥æ ¼çš„å®‰å…¨åˆè§„è¦æ±‚
- **ğŸ“± ç§»åŠ¨åº”ç”¨**ï¼šç¡®ä¿APIé€šä¿¡å®‰å…¨
- **ğŸ¢ ä¼ä¸šå†…ç½‘**ï¼šä¿æŠ¤å†…éƒ¨æ•°æ®ä¼ è¾“å®‰å…¨

**ğŸ”§ è¿ç»´å®è·µè¦ç‚¹**
- **è¯ä¹¦ç®¡ç†**ï¼šå®šæœŸæ£€æŸ¥è¯ä¹¦æœ‰æ•ˆæœŸï¼Œè‡ªåŠ¨åŒ–æ›´æ–°
- **å®‰å…¨è¯„ä¼°**ï¼šä½¿ç”¨SSL Labsç­‰å·¥å…·å®šæœŸæ£€æµ‹
- **æ€§èƒ½ç›‘æ§**ï¼šå…³æ³¨SSLæ¡æ‰‹å»¶è¿Ÿå’ŒæˆåŠŸç‡
- **æ•…éšœå¤„ç†**ï¼šå»ºç«‹è¯ä¹¦é—®é¢˜å¿«é€Ÿå“åº”æœºåˆ¶

**ğŸ§  è®°å¿†è¦ç‚¹**
- SSLé…ç½®æ ¸å¿ƒæ˜¯"è¯ä¹¦+ç§é’¥+åè®®+ç¼“å­˜"
- å®‰å…¨æ€§å’Œæ€§èƒ½éœ€è¦å¹³è¡¡ï¼Œä¸èƒ½åªé¡¾ä¸€æ–¹é¢
- OCSPè£…è®¢æ˜¯ç°ä»£SSLé…ç½®çš„é‡è¦ä¼˜åŒ–
- å®šæœŸç»´æŠ¤å’Œç›‘æ§æ˜¯SSLå®‰å…¨çš„é‡è¦ä¿éšœ