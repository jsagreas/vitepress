---
title: 9ã€æ‰¹é‡æ“ä½œå‘½ä»¤
---
## ğŸ“š ç›®å½•

1. [æ‰¹é‡æ“ä½œåŸºç¡€æ¦‚å¿µ](#1-æ‰¹é‡æ“ä½œåŸºç¡€æ¦‚å¿µ)
2. [_bulk æ‰¹é‡æ“ä½œå‘½ä»¤](#2-_bulk-æ‰¹é‡æ“ä½œå‘½ä»¤)
3. [_mget æ‰¹é‡è·å–æ–‡æ¡£](#3-_mget-æ‰¹é‡è·å–æ–‡æ¡£)
4. [_update_by_query æŒ‰æŸ¥è¯¢æ›´æ–°](#4-_update_by_query-æŒ‰æŸ¥è¯¢æ›´æ–°)
5. [_delete_by_query æŒ‰æŸ¥è¯¢åˆ é™¤](#5-_delete_by_query-æŒ‰æŸ¥è¯¢åˆ é™¤)
6. [_reindex é‡æ–°ç´¢å¼•](#6-_reindex-é‡æ–°ç´¢å¼•)
7. [ä»»åŠ¡ç®¡ç†ä¸ç›‘æ§](#7-ä»»åŠ¡ç®¡ç†ä¸ç›‘æ§)
8. [æ‰¹é‡æ“ä½œæœ€ä½³å®è·µ](#8-æ‰¹é‡æ“ä½œæœ€ä½³å®è·µ)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ æ‰¹é‡æ“ä½œåŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯æ‰¹é‡æ“ä½œ


**é€šä¿—ç†è§£**ï¼šå°±åƒä½ å»è¶…å¸‚è´­ç‰©ï¼Œå¦‚æœä¸€ä¸ªä¸€ä¸ªå•†å“å•ç‹¬ç»“è´¦ä¼šå¾ˆæ…¢ï¼Œæ‰¹é‡æ“ä½œå°±æ˜¯æŠŠæ‰€æœ‰å•†å“æ”¾åœ¨è´­ç‰©è½¦é‡Œä¸€æ¬¡æ€§ç»“è´¦ï¼Œå¤§å¤§æé«˜æ•ˆç‡ã€‚

```
å•ä¸ªæ“ä½œ vs æ‰¹é‡æ“ä½œ:

å•ä¸ªæ“ä½œï¼š
æ·»åŠ æ–‡æ¡£1 â†’ ç­‰å¾…å“åº” â†’ æ·»åŠ æ–‡æ¡£2 â†’ ç­‰å¾…å“åº” â†’ ...
è€—æ—¶ï¼šæ¯æ¬¡éƒ½è¦ç½‘ç»œå¾€è¿”

æ‰¹é‡æ“ä½œï¼š
[æ·»åŠ æ–‡æ¡£1, æ·»åŠ æ–‡æ¡£2, æ·»åŠ æ–‡æ¡£3, ...] â†’ ä¸€æ¬¡æ€§å‘é€
è€—æ—¶ï¼šåªéœ€è¦ä¸€æ¬¡ç½‘ç»œå¾€è¿”
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦æ‰¹é‡æ“ä½œ


**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- ğŸš€ **æ€§èƒ½æå‡** - å‡å°‘ç½‘ç»œå¾€è¿”æ¬¡æ•°
- ğŸ’¡ **èµ„æºèŠ‚çº¦** - é™ä½æœåŠ¡å™¨è´Ÿè½½  
- âš¡ **é€Ÿåº¦ä¼˜åŒ–** - å•æ¬¡å¤„ç†å¤šä¸ªæ“ä½œ
- ğŸ”§ **äº‹åŠ¡æ€§** - ç›¸å…³æ“ä½œå¯ä»¥ä¸€èµ·æ‰§è¡Œ

> ğŸ’¡ **æ¯”å–»è¯´æ˜**ï¼šå•ä¸ªæ“ä½œåƒæ˜¯æ¯æ¬¡éƒ½è¦å¼€é—¨å…³é—¨ï¼Œæ‰¹é‡æ“ä½œæ˜¯ä¸€æ¬¡æ€§æ¬è¿å¾ˆå¤šä¸œè¥¿

### 1.3 æ‰¹é‡æ“ä½œçš„åº”ç”¨åœºæ™¯


```
å¸¸è§ä½¿ç”¨åœºæ™¯ï¼š
ğŸ“Š æ•°æ®å¯¼å…¥ï¼šå°†å¤§é‡æ•°æ®ä¸€æ¬¡æ€§å¯¼å…¥ES
ğŸ”„ æ•°æ®åŒæ­¥ï¼šä»æ•°æ®åº“åŒæ­¥æ•°æ®åˆ°ES
ğŸ“ æ—¥å¿—å¤„ç†ï¼šæ‰¹é‡å†™å…¥æ—¥å¿—æ•°æ®
ğŸ”§ æ•°æ®æ¸…ç†ï¼šæ‰¹é‡æ›´æ–°æˆ–åˆ é™¤è¿‡æœŸæ•°æ®
```

---

## 2. ğŸ“¦ _bulk æ‰¹é‡æ“ä½œå‘½ä»¤


### 2.1 _bulk åŸºæœ¬æ¦‚å¿µ


**_bulk** æ˜¯ Elasticsearch ä¸­æœ€é‡è¦çš„æ‰¹é‡æ“ä½œå‘½ä»¤ï¼Œå¯ä»¥åœ¨ä¸€æ¬¡è¯·æ±‚ä¸­æ‰§è¡Œå¤šä¸ªå¢åˆ æ”¹æ“ä½œã€‚

**æ”¯æŒçš„æ“ä½œç±»å‹**ï¼š
- `index` - ç´¢å¼•æ–‡æ¡£ï¼ˆæ–°å¢æˆ–æ›¿æ¢ï¼‰
- `create` - åˆ›å»ºæ–‡æ¡£ï¼ˆä»…æ–°å¢ï¼‰
- `update` - æ›´æ–°æ–‡æ¡£
- `delete` - åˆ é™¤æ–‡æ¡£

### 2.2 _bulk å‘½ä»¤æ ¼å¼è¯¦è§£


**åŸºæœ¬è¯­æ³•ç»“æ„**ï¼š
```
POST /_bulk
POST /{index}/_bulk

è¯·æ±‚ä½“æ ¼å¼ï¼ˆNDJSONï¼‰ï¼š
{æ“ä½œç±»å‹å’Œå…ƒæ•°æ®}
{æ–‡æ¡£æ•°æ®}
{æ“ä½œç±»å‹å’Œå…ƒæ•°æ®}
{æ–‡æ¡£æ•°æ®}
...
```

> âš ï¸ **é‡è¦æç¤º**ï¼š_bulk ä½¿ç”¨ç‰¹æ®Šçš„ NDJSON æ ¼å¼ï¼Œæ¯è¡Œéƒ½æ˜¯ç‹¬ç«‹çš„JSONï¼Œè¡Œä¸è¡Œä¹‹é—´ç”¨æ¢è¡Œç¬¦åˆ†éš”

### 2.3 å®é™…æ“ä½œç¤ºä¾‹


**ç¤ºä¾‹1ï¼šæ··åˆæ‰¹é‡æ“ä½œ**
```bash
POST /_bulk
{"index":{"_index":"products","_id":"1"}}
{"name":"iPhone 14","price":5999,"category":"æ‰‹æœº"}
{"create":{"_index":"products","_id":"2"}}
{"name":"iPad Air","price":4399,"category":"å¹³æ¿"}
{"update":{"_index":"products","_id":"3"}}
{"doc":{"price":3999}}
{"delete":{"_index":"products","_id":"4"}}
```

**æ“ä½œè§£é‡Š**ï¼š
- ç¬¬1-2è¡Œï¼šåœ¨productsç´¢å¼•ä¸­æ·»åŠ /æ›¿æ¢IDä¸º1çš„æ–‡æ¡£
- ç¬¬3-4è¡Œï¼šåˆ›å»ºIDä¸º2çš„æ–°æ–‡æ¡£ï¼ˆå¦‚æœå·²å­˜åœ¨ä¼šå¤±è´¥ï¼‰
- ç¬¬5-6è¡Œï¼šæ›´æ–°IDä¸º3çš„æ–‡æ¡£ä»·æ ¼
- ç¬¬7è¡Œï¼šåˆ é™¤IDä¸º4çš„æ–‡æ¡£

**ç¤ºä¾‹2ï¼šæŒ‡å®šç´¢å¼•çš„æ‰¹é‡æ“ä½œ**
```bash
POST /my_store/_bulk
{"index":{"_id":"1"}}
{"product":"ç¬”è®°æœ¬ç”µè„‘","brand":"è”æƒ³","price":4999}
{"index":{"_id":"2"}}
{"product":"å°å¼æœº","brand":"æˆ´å°”","price":3999}
{"update":{"_id":"1"}}
{"doc":{"price":4799,"discount":true}}
```

### 2.4 _bulk å“åº”ç»“æœè§£è¯»


**å“åº”æ ¼å¼**ï¼š
```json
{
  "took": 150,
  "errors": false,
  "items": [
    {
      "index": {
        "_index": "products",
        "_id": "1",
        "_version": 1,
        "result": "created",
        "status": 201
      }
    },
    {
      "update": {
        "_index": "products", 
        "_id": "3",
        "_version": 2,
        "result": "updated",
        "status": 200
      }
    }
  ]
}
```

**å…³é”®å­—æ®µè¯´æ˜**ï¼š
- `took` - æ‰§è¡Œè€—æ—¶ï¼ˆæ¯«ç§’ï¼‰
- `errors` - æ˜¯å¦æœ‰é”™è¯¯å‘ç”Ÿ
- `items` - æ¯ä¸ªæ“ä½œçš„è¯¦ç»†ç»“æœ
- `result` - æ“ä½œç»“æœï¼šcreatedã€updatedã€deletedã€noop
- `status` - HTTPçŠ¶æ€ç 

---

## 3. ğŸ“‹ _mget æ‰¹é‡è·å–æ–‡æ¡£


### 3.1 _mget åŸºæœ¬æ¦‚å¿µ


**_mget**ï¼ˆmulti-getï¼‰ç”¨äºä¸€æ¬¡æ€§è·å–å¤šä¸ªæ–‡æ¡£ï¼Œå°±åƒä½ ä¸€æ¬¡æ€§ä»å›¾ä¹¦é¦†å€Ÿé˜…å¤šæœ¬ä¹¦ï¼Œè€Œä¸æ˜¯æ¯æ¬¡åªå€Ÿä¸€æœ¬ã€‚

### 3.2 _mget åŸºæœ¬è¯­æ³•


**å…¨å±€æ‰¹é‡è·å–**ï¼š
```bash
GET /_mget
{
  "docs": [
    {
      "_index": "products",
      "_id": "1"
    },
    {
      "_index": "users", 
      "_id": "2"
    }
  ]
}
```

**æŒ‡å®šç´¢å¼•æ‰¹é‡è·å–**ï¼š
```bash
GET /products/_mget
{
  "docs": [
    {"_id": "1"},
    {"_id": "2"},
    {"_id": "3"}
  ]
}
```

**ç®€åŒ–è¯­æ³•ï¼ˆåŒä¸€ç´¢å¼•ï¼‰**ï¼š
```bash
GET /products/_mget
{
  "ids": ["1", "2", "3", "4"]
}
```

### 3.3 _mget é«˜çº§ç”¨æ³•


**æŒ‡å®šè¿”å›å­—æ®µ**ï¼š
```bash
GET /products/_mget
{
  "docs": [
    {
      "_id": "1",
      "_source": ["name", "price"]
    },
    {
      "_id": "2", 
      "_source": false
    }
  ]
}
```

**è·¯ç”±å’Œç‰ˆæœ¬æ§åˆ¶**ï¼š
```bash
GET /products/_mget
{
  "docs": [
    {
      "_id": "1",
      "routing": "user1",
      "version": 2
    }
  ]
}
```

### 3.4 _mget å“åº”ç»“æœ


```json
{
  "docs": [
    {
      "_index": "products",
      "_id": "1", 
      "_version": 1,
      "_found": true,
      "_source": {
        "name": "iPhone 14",
        "price": 5999
      }
    },
    {
      "_index": "products",
      "_id": "999",
      "_found": false
    }
  ]
}
```

> ğŸ’¡ **æç¤º**ï¼šå³ä½¿æŸäº›æ–‡æ¡£ä¸å­˜åœ¨ï¼Œ_mget ä¹Ÿä¼šè¿”å›å®Œæ•´ç»“æœï¼Œä¸å­˜åœ¨çš„æ–‡æ¡£æ ‡è®°ä¸º `"_found": false`

---

## 4. ğŸ”„ _update_by_query æŒ‰æŸ¥è¯¢æ›´æ–°


### 4.1 åŸºæœ¬æ¦‚å¿µç†è§£


**_update_by_query** å°±åƒæ˜¯"æŒ‰æ¡ä»¶æ‰¹é‡ä¿®æ”¹"ï¼Œæ¯”å¦‚ä½ è¦æŠŠå•†åº—é‡Œæ‰€æœ‰è‹¹æœçš„ä»·æ ¼éƒ½ä¸Šè°ƒ10%ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä¸€ä¸ªå»æ”¹ã€‚

### 4.2 åŸºæœ¬è¯­æ³•


**ç®€å•æŒ‰æŸ¥è¯¢æ›´æ–°**ï¼š
```bash
POST /products/_update_by_query
{
  "query": {
    "term": {
      "category": "æ‰‹æœº"
    }
  },
  "script": {
    "source": "ctx._source.price = ctx._source.price * 1.1"
  }
}
```

**æ›´æ–°ç‰¹å®šå­—æ®µ**ï¼š
```bash
POST /products/_update_by_query
{
  "query": {
    "range": {
      "price": {
        "lt": 1000
      }
    }
  },
  "script": {
    "source": "ctx._source.status = 'budget_friendly'"
  }
}
```

### 4.3 å®é™…åº”ç”¨ç¤ºä¾‹


**ç¤ºä¾‹1ï¼šæ‰¹é‡æ‰“æŠ˜**
```bash
# ç»™æ‰€æœ‰ç”µå­äº§å“æ‰“9æŠ˜
POST /products/_update_by_query
{
  "query": {
    "term": {
      "category": "ç”µå­äº§å“"
    }
  },
  "script": {
    "source": """
      ctx._source.original_price = ctx._source.price;
      ctx._source.price = Math.round(ctx._source.price * 0.9);
      ctx._source.discount = true;
    """
  }
}
```

**ç¤ºä¾‹2ï¼šæ·»åŠ æ—¶é—´æˆ³**
```bash
# ç»™æ‰€æœ‰æ–‡æ¡£æ·»åŠ æ›´æ–°æ—¶é—´
POST /products/_update_by_query
{
  "script": {
    "source": "ctx._source.updated_at = System.currentTimeMillis()"
  }
}
```

### 4.4 æ¡ä»¶æ›´æ–°å’Œå†²çªå¤„ç†


**æ¡ä»¶æ›´æ–°**ï¼š
```bash
POST /products/_update_by_query
{
  "query": {
    "bool": {
      "must": [
        {"term": {"status": "active"}},
        {"range": {"created_at": {"gte": "2024-01-01"}}}
      ]
    }
  },
  "script": {
    "source": "if (ctx._source.views > 1000) { ctx._source.popular = true }"
  }
}
```

**å†²çªå¤„ç†**ï¼š
```bash
POST /products/_update_by_query?conflicts=proceed
{
  "query": {"match_all": {}},
  "script": {
    "source": "ctx._source.batch_updated = true"
  }
}
```

> âš ï¸ **å†²çªè¯´æ˜**ï¼š`conflicts=proceed` è¡¨ç¤ºé‡åˆ°ç‰ˆæœ¬å†²çªæ—¶ç»§ç»­æ‰§è¡Œï¼Œé»˜è®¤æ˜¯ `abort`ï¼ˆé‡åˆ°å†²çªå°±åœæ­¢ï¼‰

---

## 5. ğŸ—‘ï¸ _delete_by_query æŒ‰æŸ¥è¯¢åˆ é™¤


### 5.1 åŸºæœ¬æ¦‚å¿µ


**_delete_by_query** ç›¸å½“äº"æŒ‰æ¡ä»¶æ‰¹é‡åˆ é™¤"ï¼Œå°±åƒæ¸…ç†ä»“åº“æ—¶ï¼ŒæŠŠæ‰€æœ‰è¿‡æœŸå•†å“ä¸€æ¬¡æ€§æ¸…ç†æ‰ã€‚

### 5.2 åŸºæœ¬ç”¨æ³•


**åˆ é™¤è¿‡æœŸæ•°æ®**ï¼š
```bash
POST /logs/_delete_by_query
{
  "query": {
    "range": {
      "timestamp": {
        "lt": "2024-01-01"
      }
    }
  }
}
```

**åˆ é™¤ç‰¹å®šçŠ¶æ€çš„æ–‡æ¡£**ï¼š
```bash
POST /users/_delete_by_query
{
  "query": {
    "term": {
      "status": "inactive"
    }
  }
}
```

### 5.3 å¤æ‚åˆ é™¤æ¡ä»¶


**ç»„åˆæ¡ä»¶åˆ é™¤**ï¼š
```bash
POST /products/_delete_by_query
{
  "query": {
    "bool": {
      "must": [
        {"term": {"status": "discontinued"}},
        {"range": {"last_sold": {"lt": "2023-01-01"}}},
        {"term": {"inventory": 0}}
      ]
    }
  }
}
```

### 5.4 å®‰å…¨åˆ é™¤å®è·µ


**é™åˆ¶åˆ é™¤æ•°é‡**ï¼š
```bash
POST /products/_delete_by_query?size=1000
{
  "query": {
    "term": {
      "category": "test_data"
    }
  }
}
```

**å…ˆæŸ¥è¯¢å†åˆ é™¤**ï¼š
```bash
# ç¬¬1æ­¥ï¼šå…ˆæŸ¥çœ‹è¦åˆ é™¤çš„æ•°æ®
GET /products/_search
{
  "query": {
    "term": {"status": "draft"}
  }
}

# ç¬¬2æ­¥ï¼šç¡®è®¤æ— è¯¯åå†åˆ é™¤
POST /products/_delete_by_query
{
  "query": {
    "term": {"status": "draft"}
  }
}
```

> ğŸ”§ **å®‰å…¨å»ºè®®**ï¼šåˆ é™¤å‰å…ˆç”¨ `_search` æŸ¥çœ‹è¦åˆ é™¤çš„æ•°æ®ï¼Œç¡®è®¤æ— è¯¯åå†æ‰§è¡Œåˆ é™¤æ“ä½œ

---

## 6. ğŸ”€ _reindex é‡æ–°ç´¢å¼•


### 6.1 ä»€ä¹ˆæ˜¯é‡æ–°ç´¢å¼•


**é‡æ–°ç´¢å¼•** å°±åƒæ˜¯æ¬å®¶ï¼ŒæŠŠæ•°æ®ä»ä¸€ä¸ªåœ°æ–¹å®Œæ•´åœ°æ¬åˆ°å¦ä¸€ä¸ªåœ°æ–¹ï¼Œé€šå¸¸ç”¨äºï¼š
- ğŸ  **ç´¢å¼•è¿ç§»** - æ¢åˆ°æ–°çš„ç´¢å¼•ç»“æ„
- ğŸ”§ **æ˜ å°„ä¿®æ”¹** - æ”¹å˜å­—æ®µç±»å‹æˆ–åˆ†æå™¨
- ğŸ“Š **æ•°æ®æ¸…ç†** - åœ¨è¿ç§»è¿‡ç¨‹ä¸­æ¸…ç†æ•°æ®
- ğŸš€ **æ€§èƒ½ä¼˜åŒ–** - é‡æ–°åˆ†ç‰‡æˆ–ä¼˜åŒ–å­˜å‚¨

### 6.2 åŸºæœ¬é‡æ–°ç´¢å¼•


**ç®€å•çš„ç´¢å¼•å¤åˆ¶**ï¼š
```bash
POST /_reindex
{
  "source": {
    "index": "old_products"
  },
  "dest": {
    "index": "new_products"
  }
}
```

**æŒ‡å®šæŸ¥è¯¢æ¡ä»¶çš„é‡æ–°ç´¢å¼•**ï¼š
```bash
POST /_reindex
{
  "source": {
    "index": "products",
    "query": {
      "term": {
        "status": "active"
      }
    }
  },
  "dest": {
    "index": "active_products"
  }
}
```

### 6.3 é«˜çº§é‡æ–°ç´¢å¼•åŠŸèƒ½


**å­—æ®µæ˜ å°„å’Œè„šæœ¬å¤„ç†**ï¼š
```bash
POST /_reindex
{
  "source": {
    "index": "old_products"
  },
  "dest": {
    "index": "new_products"
  },
  "script": {
    "source": """
      ctx._source.price_usd = ctx._source.price;
      ctx._source.price_cny = ctx._source.price * 7.2;
      ctx._source.migrated_at = System.currentTimeMillis();
    """
  }
}
```

**è¿œç¨‹é‡æ–°ç´¢å¼•**ï¼š
```bash
POST /_reindex
{
  "source": {
    "remote": {
      "host": "http://other-cluster:9200",
      "username": "user",
      "password": "pass"
    },
    "index": "remote_products"
  },
  "dest": {
    "index": "local_products"
  }
}
```

### 6.4 é‡æ–°ç´¢å¼•æœ€ä½³å®è·µ


**åˆ†æ‰¹å¤„ç†å¤§é‡æ•°æ®**ï¼š
```bash
POST /_reindex?wait_for_completion=false
{
  "source": {
    "index": "huge_index",
    "size": 1000
  },
  "dest": {
    "index": "new_huge_index"
  }
}
```

**ç‰ˆæœ¬å†²çªå¤„ç†**ï¼š
```bash
POST /_reindex
{
  "source": {
    "index": "source_index"
  },
  "dest": {
    "index": "dest_index",
    "version_type": "external"
  },
  "conflicts": "proceed"
}
```

---

## 7. ğŸ“Š ä»»åŠ¡ç®¡ç†ä¸ç›‘æ§


### 7.1 æŸ¥çœ‹æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡


**æŸ¥çœ‹æ‰€æœ‰ä»»åŠ¡**ï¼š
```bash
GET /_tasks
```

**æŸ¥çœ‹ç‰¹å®šç±»å‹ä»»åŠ¡**ï¼š
```bash
GET /_tasks?actions=*reindex
GET /_tasks?actions=*update_by_query
GET /_tasks?actions=*delete_by_query
```

### 7.2 ä»»åŠ¡è¯¦ç»†ä¿¡æ¯


**æŸ¥çœ‹ä»»åŠ¡è¯¦æƒ…**ï¼š
```bash
GET /_tasks/èŠ‚ç‚¹ID:ä»»åŠ¡ID
```

**ä»»åŠ¡å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "nodes": {
    "node1": {
      "tasks": {
        "123": {
          "node": "node1",
          "id": 123,
          "type": "transport",
          "action": "indices:data/write/reindex",
          "status": {
            "total": 10000,
            "updated": 3500,
            "created": 0,
            "deleted": 0,
            "batches": 4,
            "version_conflicts": 0,
            "noops": 0
          },
          "description": "reindex from [old_index] to [new_index]",
          "start_time_in_millis": 1609459200000,
          "running_time_in_nanos": 15000000000
        }
      }
    }
  }
}
```

### 7.3 å–æ¶ˆé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡


**å–æ¶ˆç‰¹å®šä»»åŠ¡**ï¼š
```bash
POST /_tasks/èŠ‚ç‚¹ID:ä»»åŠ¡ID/_cancel
```

**å–æ¶ˆæ‰€æœ‰é‡æ–°ç´¢å¼•ä»»åŠ¡**ï¼š
```bash
POST /_tasks/_cancel?actions=*reindex
```

### 7.4 å¼‚æ­¥ä»»åŠ¡å¤„ç†


**å¼‚æ­¥æ‰§è¡Œé‡æ–°ç´¢å¼•**ï¼š
```bash
POST /_reindex?wait_for_completion=false
{
  "source": {"index": "source"},
  "dest": {"index": "dest"}
}
```

**æ£€æŸ¥å¼‚æ­¥ä»»åŠ¡çŠ¶æ€**ï¼š
```bash
# ä¼šè¿”å› task_idï¼Œç„¶åå¯ä»¥ç”¨æ¥æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
GET /_tasks/{task_id}
```

---

## 8. ğŸ’¡ æ‰¹é‡æ“ä½œæœ€ä½³å®è·µ


### 8.1 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


**æ‰¹é‡å¤§å°æ§åˆ¶**ï¼š
```
æ¨èçš„æ‰¹é‡å¤§å°ï¼š
ğŸ“¦ æ–‡æ¡£æ•°é‡ï¼š100-1000ä¸ªæ–‡æ¡£/æ‰¹æ¬¡
ğŸ’¾ æ•°æ®å¤§å°ï¼š1-15MB/æ‰¹æ¬¡  
âš¡ å¤æ‚ç¨‹åº¦ï¼šç®€å•æ–‡æ¡£å¯ä»¥æ›´å¤§æ‰¹æ¬¡ï¼Œå¤æ‚æ–‡æ¡£è¦å°æ‰¹æ¬¡
```

**ç¤ºä¾‹ï¼šæ§åˆ¶æ‰¹é‡å¤§å°**
```bash
# å¥½çš„åšæ³•ï¼šé€‚ä¸­çš„æ‰¹é‡å¤§å°
POST /_bulk
{"index":{"_index":"products","_id":"1"}}
{"name":"å•†å“1","price":100}
{"index":{"_index":"products","_id":"2"}}
{"name":"å•†å“2","price":200}
... # æ€»å…±500ä¸ªæ–‡æ¡£

# é¿å…ï¼šè¿‡å¤§çš„æ‰¹é‡
# ä¸è¦ä¸€æ¬¡æ€§å‘é€10000ä¸ªæ–‡æ¡£
```

### 8.2 é”™è¯¯å¤„ç†ç­–ç•¥


**æ£€æŸ¥å’Œå¤„ç†é”™è¯¯**ï¼š
```bash
# 1. æ‰§è¡Œæ‰¹é‡æ“ä½œ
POST /_bulk
{"index":{"_index":"products","_id":"1"}}
{"name":"å•†å“1","price":100}

# 2. æ£€æŸ¥å“åº”ä¸­çš„errorså­—æ®µ
# å¦‚æœ "errors": trueï¼Œæ£€æŸ¥itemsä¸­çš„è¯¦ç»†é”™è¯¯ä¿¡æ¯

# 3. é‡è¯•å¤±è´¥çš„æ“ä½œ
```

**ç›‘æ§æ‰¹é‡æ“ä½œæ€§èƒ½**ï¼š
```
å…³é”®æŒ‡æ ‡ï¼š
â±ï¸ tookæ—¶é—´ï¼šå•æ¬¡æ‰¹é‡æ“ä½œè€—æ—¶
ğŸ“Š errorsæ¯”ä¾‹ï¼šå¤±è´¥æ“ä½œçš„æ¯”ä¾‹
ğŸ”„ ååé‡ï¼šæ¯ç§’å¤„ç†çš„æ–‡æ¡£æ•°é‡
ğŸ’¾ å†…å­˜ä½¿ç”¨ï¼šæ‰¹é‡æ“ä½œçš„å†…å­˜å¼€é”€
```

### 8.3 æ•°æ®ä¸€è‡´æ€§è€ƒè™‘


**ç†è§£æ‰¹é‡æ“ä½œçš„ç‰¹ç‚¹**ï¼š
- âœ… **åŸå­æ€§**ï¼šæ¯ä¸ªå•ç‹¬æ“ä½œæ˜¯åŸå­çš„
- âŒ **éäº‹åŠ¡æ€§**ï¼šæ•´ä¸ªæ‰¹é‡æ“ä½œä¸æ˜¯äº‹åŠ¡æ€§çš„
- ğŸ”„ **éƒ¨åˆ†æˆåŠŸ**ï¼šéƒ¨åˆ†æ“ä½œå¯èƒ½æˆåŠŸï¼Œéƒ¨åˆ†å¯èƒ½å¤±è´¥

**å¤„ç†éƒ¨åˆ†å¤±è´¥**ï¼š
```bash
# æ‰¹é‡æ“ä½œåæ£€æŸ¥ç»“æœ
{
  "errors": true,
  "items": [
    {"index": {"status": 201, "result": "created"}},  // æˆåŠŸ
    {"index": {"status": 400, "error": "parsing_exception"}}  // å¤±è´¥
  ]
}

# å¯¹å¤±è´¥çš„æ“ä½œè¿›è¡Œé‡è¯•æˆ–è®°å½•
```

### 8.4 ç´¢å¼•è®¾ç½®ä¼˜åŒ–


**æ‰¹é‡å¯¼å…¥æ—¶çš„ç´¢å¼•ä¼˜åŒ–**ï¼š
```bash
# ä¸´æ—¶å…³é—­åˆ·æ–°
PUT /my_index/_settings
{
  "refresh_interval": -1,
  "number_of_replicas": 0
}

# æ‰§è¡Œæ‰¹é‡æ“ä½œ
POST /my_index/_bulk
{...}

# æ¢å¤æ­£å¸¸è®¾ç½®
PUT /my_index/_settings
{
  "refresh_interval": "1s",
  "number_of_replicas": 1
}

# å¼ºåˆ¶åˆ·æ–°
POST /my_index/_refresh
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒå‘½ä»¤


```
ğŸ”¸ _bulkï¼šä¸‡èƒ½æ‰¹é‡æ“ä½œå‘½ä»¤ï¼Œæ”¯æŒå¢åˆ æ”¹
ğŸ”¸ _mgetï¼šæ‰¹é‡è·å–å¤šä¸ªæ–‡æ¡£
ğŸ”¸ _update_by_queryï¼šæŒ‰æŸ¥è¯¢æ¡ä»¶æ‰¹é‡æ›´æ–°
ğŸ”¸ _delete_by_queryï¼šæŒ‰æŸ¥è¯¢æ¡ä»¶æ‰¹é‡åˆ é™¤  
ğŸ”¸ _reindexï¼šé‡æ–°ç´¢å¼•ï¼Œæ•°æ®è¿ç§»ç¥å™¨
ğŸ”¸ _tasksï¼šä»»åŠ¡ç›‘æ§å’Œç®¡ç†
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æ‰¹é‡æ“ä½œçš„æœ¬è´¨**
```
æ ¸å¿ƒæ€æƒ³ï¼š
- å‡å°‘ç½‘ç»œå¾€è¿”ï¼šä¸€æ¬¡è¯·æ±‚å¤„ç†å¤šä¸ªæ“ä½œ
- æé«˜ååé‡ï¼šå……åˆ†åˆ©ç”¨ESçš„å¤„ç†èƒ½åŠ›
- é™ä½å¼€é”€ï¼šå‡å°‘è¿æ¥å’Œè¯·æ±‚çš„å¼€é”€
```

**ğŸ”¹ æ“ä½œç±»å‹é€‰æ‹©**
```
é€‰æ‹©åŸåˆ™ï¼š
- ç®€å•æ“ä½œ â†’ ä½¿ç”¨_bulk
- å¤æ‚æŸ¥è¯¢æ›´æ–° â†’ ä½¿ç”¨_update_by_query
- æ•°æ®è¿ç§» â†’ ä½¿ç”¨_reindex
- æ‰¹é‡æŸ¥è¯¢ â†’ ä½¿ç”¨_mget
```

**ğŸ”¹ æ€§èƒ½ä¸å®‰å…¨å¹³è¡¡**
```
å¹³è¡¡è€ƒè™‘ï¼š
- æ‰¹é‡å¤§å°ï¼šä¸æ˜¯è¶Šå¤§è¶Šå¥½ï¼Œè¦é€‚ä¸­
- é”™è¯¯å¤„ç†ï¼šéƒ¨åˆ†å¤±è´¥æ˜¯å¸¸æ€ï¼Œè¦æœ‰å¤„ç†æœºåˆ¶
- ç›‘æ§ä»»åŠ¡ï¼šé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡è¦ç›‘æ§è¿›åº¦
```

### 9.3 å®é™…åº”ç”¨åœºæ™¯æ€»ç»“


| åœºæ™¯ | **æ¨èå‘½ä»¤** | **æ ¸å¿ƒè¦ç‚¹** |
|------|-------------|-------------|
| ğŸš€ **æ•°æ®å¯¼å…¥** | `_bulk` | `æ§åˆ¶æ‰¹é‡å¤§å°ï¼Œç›‘æ§é”™è¯¯ç‡` |
| ğŸ”„ **æ•°æ®åŒæ­¥** | `_bulk + _update_by_query` | `å¢é‡æ›´æ–°ï¼Œå†²çªå¤„ç†` |
| ğŸ§¹ **æ•°æ®æ¸…ç†** | `_delete_by_query` | `å…ˆæŸ¥è¯¢ååˆ é™¤ï¼Œé™åˆ¶æ•°é‡` |
| ğŸ“Š **ç´¢å¼•è¿ç§»** | `_reindex` | `å¼‚æ­¥æ‰§è¡Œï¼Œç›‘æ§è¿›åº¦` |
| ğŸ“‹ **æ‰¹é‡æŸ¥è¯¢** | `_mget` | `æŒ‡å®šå­—æ®µï¼Œå¤„ç†ä¸å­˜åœ¨æ–‡æ¡£` |

### 9.4 å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ


**é—®é¢˜1ï¼šæ‰¹é‡æ“ä½œå¤ªæ…¢**
```
è§£å†³æ–¹æ¡ˆï¼š
âœ… å‡å°æ‰¹é‡å¤§å°
âœ… ä¼˜åŒ–ç´¢å¼•è®¾ç½®ï¼ˆä¸´æ—¶å…³é—­åˆ·æ–°ï¼‰
âœ… å¢åŠ åˆ†ç‰‡æ•°é‡
âœ… æ£€æŸ¥ç¡¬ä»¶èµ„æº
```

**é—®é¢˜2ï¼šéƒ¨åˆ†æ“ä½œå¤±è´¥**
```
è§£å†³æ–¹æ¡ˆï¼š
âœ… æ£€æŸ¥é”™è¯¯è¯¦æƒ…
âœ… é‡è¯•å¤±è´¥çš„æ“ä½œ
âœ… ä¼˜åŒ–æ•°æ®æ ¼å¼
âœ… è°ƒæ•´æ˜ å°„è®¾ç½®
```

**é—®é¢˜3ï¼šé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡**
```
è§£å†³æ–¹æ¡ˆï¼š
âœ… ä½¿ç”¨å¼‚æ­¥æ‰§è¡Œ
âœ… ç›‘æ§ä»»åŠ¡è¿›åº¦
âœ… åˆ†æ‰¹å¤„ç†æ•°æ®
âœ… å¿…è¦æ—¶å–æ¶ˆä»»åŠ¡
```

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- æ‰¹é‡æ“ä½œæ˜¯ESæ€§èƒ½ä¼˜åŒ–çš„å…³é”®
- é€‰æ‹©åˆé€‚çš„æ‰¹é‡å¤§å°å’Œå‘½ä»¤ç±»å‹
- é‡è§†é”™è¯¯å¤„ç†å’Œä»»åŠ¡ç›‘æ§
- ç†è§£æ¯ä¸ªå‘½ä»¤çš„é€‚ç”¨åœºæ™¯å’Œé™åˆ¶