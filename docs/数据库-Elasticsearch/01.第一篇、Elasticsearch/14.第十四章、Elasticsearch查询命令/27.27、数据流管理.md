---
title: 27ã€æ•°æ®æµç®¡ç†
---
## ğŸ“š ç›®å½•

1. [æ•°æ®æµåŸºç¡€æ¦‚å¿µ](#1-æ•°æ®æµåŸºç¡€æ¦‚å¿µ)
2. [æ•°æ®æµåˆ›å»ºä¸æŸ¥çœ‹](#2-æ•°æ®æµåˆ›å»ºä¸æŸ¥çœ‹)
3. [æ•°æ®æµå†™å…¥æ“ä½œ](#3-æ•°æ®æµå†™å…¥æ“ä½œ)
4. [æ•°æ®æµæ»šåŠ¨æœºåˆ¶](#4-æ•°æ®æµæ»šåŠ¨æœºåˆ¶)
5. [æ•°æ®æµç»Ÿè®¡ä¸ç›‘æ§](#5-æ•°æ®æµç»Ÿè®¡ä¸ç›‘æ§)
6. [æ•°æ®æµåˆ é™¤ä¸ç®¡ç†](#6-æ•°æ®æµåˆ é™¤ä¸ç®¡ç†)
7. [å®æˆ˜åº”ç”¨åœºæ™¯](#7-å®æˆ˜åº”ç”¨åœºæ™¯)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒŠ æ•°æ®æµåŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯æ•°æ®æµ


**ğŸ’¡ é€šä¿—ç†è§£**
```
æƒ³è±¡ä¸€ä¸‹è‡ªæ¥æ°´ç®¡é“ç³»ç»Ÿï¼š
ğŸš° æ°´é¾™å¤´ = æ•°æ®å…¥å£
ğŸ”§ æ°´ç®¡ = æ•°æ®æµ
ğŸª£ æ°´æ¡¶ = ç´¢å¼•ï¼ˆå­˜å‚¨å®¹å™¨ï¼‰

æ•°æ®æµå°±åƒä¸€æ ¹æ™ºèƒ½æ°´ç®¡ï¼Œä¼šè‡ªåŠ¨ï¼š
â€¢ æŠŠæ–°æ•°æ®å¯¼å…¥åˆ°æœ€æ–°çš„"æ°´æ¡¶"ï¼ˆç´¢å¼•ï¼‰
â€¢ å½“"æ°´æ¡¶"æ»¡äº†å°±è‡ªåŠ¨æ¢æ–°æ¡¶
â€¢ è€çš„"æ°´æ¡¶"åªèƒ½çœ‹ä¸èƒ½æ”¹
```

**ğŸ”¸ æ ¸å¿ƒå®šä¹‰**
```
æ•°æ®æµï¼ˆData Streamï¼‰ï¼š
ä¸“é—¨ç”¨äºå¤„ç†æ—¶é—´åºåˆ—æ•°æ®çš„ç´¢å¼•æŠ½è±¡å±‚

ç‰¹ç‚¹ï¼š
âœ… åªèƒ½è¿½åŠ æ•°æ®ï¼Œä¸èƒ½ä¿®æ”¹
âœ… è‡ªåŠ¨ç®¡ç†åº•å±‚ç´¢å¼•
âœ… æ”¯æŒè‡ªåŠ¨æ»šåŠ¨
âœ… ä¼˜åŒ–æ—¶é—´åºåˆ—æŸ¥è¯¢
```

### 1.2 æ•°æ®æµ vs æ™®é€šç´¢å¼•


**ğŸ“Š å¯¹æ¯”åˆ†æ**

| ç‰¹æ€§ | **æ™®é€šç´¢å¼•** | **æ•°æ®æµ** |
|------|-------------|-----------|
| **æ•°æ®æ“ä½œ** | `å¢åˆ æ”¹æŸ¥éƒ½æ”¯æŒ` | `åªæ”¯æŒè¿½åŠ å’ŒæŸ¥è¯¢` |
| **ç´¢å¼•ç®¡ç†** | `æ‰‹åŠ¨åˆ›å»ºç®¡ç†` | `è‡ªåŠ¨åˆ›å»ºå’Œæ»šåŠ¨` |
| **é€‚ç”¨åœºæ™¯** | `ä¸€èˆ¬ä¸šåŠ¡æ•°æ®` | `æ—¥å¿—ã€ç›‘æ§ç­‰æ—¶åºæ•°æ®` |
| **æ€§èƒ½ä¼˜åŒ–** | `é€šç”¨ä¼˜åŒ–` | `ä¸“é—¨ä¼˜åŒ–æ—¶åºæŸ¥è¯¢` |

### 1.3 æ•°æ®æµæ¶æ„åŸç†


**ğŸ—ï¸ æ¶æ„å›¾ç¤º**
```
æ•°æ®æµå±‚æ¬¡ç»“æ„ï¼š

åº”ç”¨ç¨‹åº
    â†“ å†™å…¥æ•°æ®
æ•°æ®æµ (logs-app-prod)
    â†“ è‡ªåŠ¨è·¯ç”±
åå¤‡ç´¢å¼•ç¾¤ç»„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ .ds-logs-app-prod-  â”‚ â† æœ€æ–°ç´¢å¼•ï¼ˆå¯å†™ï¼‰
â”‚ 2024.09.21-000003   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ .ds-logs-app-prod-  â”‚ â† å†å²ç´¢å¼•ï¼ˆåªè¯»ï¼‰
â”‚ 2024.09.20-000002   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ .ds-logs-app-prod-  â”‚ â† å†å²ç´¢å¼•ï¼ˆåªè¯»ï¼‰
â”‚ 2024.09.19-000001   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”„ å·¥ä½œæµç¨‹**
```
â‘  åº”ç”¨å‘æ•°æ®æµå†™å…¥æ•°æ®
â‘¡ æ•°æ®æµè‡ªåŠ¨è·¯ç”±åˆ°æœ€æ–°çš„åå¤‡ç´¢å¼•
â‘¢ å½“æ»¡è¶³æ»šåŠ¨æ¡ä»¶æ—¶ï¼š
   â€¢ å½“å‰ç´¢å¼•å˜ä¸ºåªè¯»
   â€¢ è‡ªåŠ¨åˆ›å»ºæ–°çš„åå¤‡ç´¢å¼•
   â€¢ æ–°æ•°æ®å†™å…¥æ–°ç´¢å¼•
â‘£ æŸ¥è¯¢æ—¶è‡ªåŠ¨æœç´¢æ‰€æœ‰åå¤‡ç´¢å¼•
```

---

## 2. ğŸ”§ æ•°æ®æµåˆ›å»ºä¸æŸ¥çœ‹


### 2.1 åˆ›å»ºæ•°æ®æµ


**ğŸ¯ åŸºç¡€åˆ›å»ºå‘½ä»¤**
```http
PUT /_data_stream/logs-myapp-prod
```

> ğŸ’¡ **æ–°æ‰‹æç¤º**ï¼šæ•°æ®æµåç§°å»ºè®®éµå¾ª `{type}-{dataset}-{namespace}` æ ¼å¼ï¼Œæ¯”å¦‚ `logs-nginx-production`

**âš™ï¸ ä½¿ç”¨ç´¢å¼•æ¨¡æ¿åˆ›å»º**
```http
# ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºç´¢å¼•æ¨¡æ¿
PUT /_index_template/logs-template
{
  "index_patterns": ["logs-*"],
  "data_stream": {},
  "template": {
    "settings": {
      "number_of_shards": 1,
      "number_of_replicas": 1
    },
    "mappings": {
      "properties": {
        "@timestamp": {
          "type": "date"
        },
        "message": {
          "type": "text"
        },
        "level": {
          "type": "keyword"
        }
      }
    }
  }
}

# ç¬¬äºŒæ­¥ï¼šåˆ›å»ºæ•°æ®æµï¼ˆä¼šè‡ªåŠ¨åº”ç”¨æ¨¡æ¿ï¼‰
PUT /_data_stream/logs-myapp-prod
```

### 2.2 æŸ¥çœ‹æ•°æ®æµ


**ğŸ“‹ æŸ¥çœ‹æ‰€æœ‰æ•°æ®æµ**
```http
GET /_data_stream
```

**ğŸ“ å“åº”ç¤ºä¾‹**
```json
{
  "data_streams": [
    {
      "name": "logs-myapp-prod",
      "timestamp_field": {
        "name": "@timestamp"
      },
      "indices": [
        {
          "index_name": ".ds-logs-myapp-prod-2024.09.21-000001",
          "index_uuid": "abc123..."
        }
      ],
      "generation": 1,
      "status": "green"
    }
  ]
}
```

**ğŸ” æŸ¥çœ‹ç‰¹å®šæ•°æ®æµè¯¦æƒ…**
```http
GET /_data_stream/logs-myapp-prod
```

**ğŸ“Š ä½¿ç”¨cat APIæŸ¥çœ‹æ•°æ®æµåˆ—è¡¨**
```http
GET /_cat/data_streams?v&h=name,status,backing_indices,store.size
```

---

## 3. ğŸ“ æ•°æ®æµå†™å…¥æ“ä½œ


### 3.1 åŸºç¡€å†™å…¥æ“ä½œ


**âœï¸ å†™å…¥å•æ¡æ–‡æ¡£**
```http
POST /logs-myapp-prod/_doc
{
  "@timestamp": "2024-09-21T10:30:00.000Z",
  "level": "INFO",
  "message": "ç”¨æˆ·ç™»å½•æˆåŠŸ",
  "user_id": "12345",
  "ip": "192.168.1.100"
}
```

> ğŸ”¸ **é‡è¦è¯´æ˜**ï¼šæ•°æ®æµä¸­çš„æ–‡æ¡£å¿…é¡»åŒ…å« `@timestamp` å­—æ®µ

**ğŸ“¦ æ‰¹é‡å†™å…¥æ–‡æ¡£**
```http
POST /_bulk
{ "create": { "_index": "logs-myapp-prod" } }
{ "@timestamp": "2024-09-21T10:30:00.000Z", "level": "INFO", "message": "ç”¨æˆ·ç™»å½•", "user_id": "12345" }
{ "create": { "_index": "logs-myapp-prod" } }
{ "@timestamp": "2024-09-21T10:31:00.000Z", "level": "ERROR", "message": "æ•°æ®åº“è¿æ¥å¤±è´¥", "error_code": "DB001" }
```

### 3.2 å†™å…¥æ³¨æ„äº‹é¡¹


**âš ï¸ é‡è¦é™åˆ¶**
```
æ•°æ®æµçš„å†™å…¥é™åˆ¶ï¼š
âŒ ä¸æ”¯æŒ PUT æ“ä½œï¼ˆæ›´æ–°æ–‡æ¡£ï¼‰
âŒ ä¸æ”¯æŒ DELETE æ“ä½œï¼ˆåˆ é™¤æ–‡æ¡£ï¼‰
âœ… åªæ”¯æŒ POST æ“ä½œï¼ˆè¿½åŠ æ–‡æ¡£ï¼‰
âœ… æ”¯æŒæ‰¹é‡å†™å…¥
```

**ğŸ“… æ—¶é—´æˆ³å­—æ®µè¦æ±‚**
```json
{
  "@timestamp": "2024-09-21T10:30:00.000Z",  // âœ… æ­£ç¡®ï¼šISO 8601æ ¼å¼
  "@timestamp": "2024-09-21 10:30:00",       // âŒ é”™è¯¯ï¼šæ ¼å¼ä¸æ­£ç¡®
  "timestamp": "2024-09-21T10:30:00.000Z"    // âŒ é”™è¯¯ï¼šå­—æ®µåé”™è¯¯
}
```

---

## 4. ğŸ”„ æ•°æ®æµæ»šåŠ¨æœºåˆ¶


### 4.1 ä»€ä¹ˆæ˜¯æ•°æ®æµæ»šåŠ¨


**ğŸ’¡ å½¢è±¡æ¯”å–»**
```
å°±åƒå†™æ—¥è®°æœ¬ï¼š
ğŸ“– å½“å‰æ—¥è®°æœ¬ = å½“å‰åå¤‡ç´¢å¼•ï¼ˆå¯å†™å…¥ï¼‰
ğŸ“š å†™æ»¡çš„æ—¥è®°æœ¬ = å†å²åå¤‡ç´¢å¼•ï¼ˆåªè¯»ï¼‰

æ»šåŠ¨ = æ¢æ–°æ—¥è®°æœ¬çš„è¿‡ç¨‹
```

**ğŸ”¸ æ»šåŠ¨è§¦å‘æ¡ä»¶**
```
è‡ªåŠ¨æ»šåŠ¨æ¡ä»¶ï¼š
â€¢ ç´¢å¼•å¤§å°è¾¾åˆ°è®¾å®šå€¼
â€¢ ç´¢å¼•æ–‡æ¡£æ•°è¾¾åˆ°ä¸Šé™  
â€¢ ç´¢å¼•å¹´é¾„è¾¾åˆ°è®¾å®šæ—¶é—´

æ‰‹åŠ¨æ»šåŠ¨ï¼š
â€¢ ä½¿ç”¨ rollover APIå¼ºåˆ¶æ»šåŠ¨
```

### 4.2 é…ç½®è‡ªåŠ¨æ»šåŠ¨ç­–ç•¥


**âš™ï¸ åœ¨ç´¢å¼•æ¨¡æ¿ä¸­é…ç½®**
```http
PUT /_index_template/logs-rollover-template
{
  "index_patterns": ["logs-*"],
  "data_stream": {},
  "template": {
    "settings": {
      "index.lifecycle.name": "logs-policy",
      "index.lifecycle.rollover_alias": "logs-myapp-prod"
    }
  }
}

# åˆ›å»ºILMç­–ç•¥
PUT /_ilm/policy/logs-policy
{
  "policy": {
    "phases": {
      "hot": {
        "actions": {
          "rollover": {
            "max_size": "1GB",
            "max_age": "7d",
            "max_docs": 10000000
          }
        }
      }
    }
  }
}
```

### 4.3 æ‰‹åŠ¨æ»šåŠ¨æ“ä½œ


**ğŸ”„ æ‰§è¡Œæ‰‹åŠ¨æ»šåŠ¨**
```http
POST /_data_stream/logs-myapp-prod/_rollover
```

**ğŸ“‹ æ»šåŠ¨å“åº”ç¤ºä¾‹**
```json
{
  "acknowledged": true,
  "shards_acknowledged": true,
  "old_index": ".ds-logs-myapp-prod-2024.09.21-000001",
  "new_index": ".ds-logs-myapp-prod-2024.09.21-000002",
  "rolled_over": true,
  "dry_run": false,
  "conditions": {
    "max_age": "7d",
    "max_docs": 10000000,
    "max_size": "1gb"
  }
}
```

**ğŸ¯ å¸¦æ¡ä»¶çš„æ»šåŠ¨**
```http
POST /_data_stream/logs-myapp-prod/_rollover
{
  "conditions": {
    "max_age": "1d",
    "max_docs": 1000000,
    "max_size": "500mb"
  }
}
```

---

## 5. ğŸ“Š æ•°æ®æµç»Ÿè®¡ä¸ç›‘æ§


### 5.1 æ•°æ®æµç»Ÿè®¡ä¿¡æ¯


**ğŸ“ˆ è·å–æ•°æ®æµç»Ÿè®¡**
```http
GET /_data_stream/_stats
```

**ğŸ“‹ ç»Ÿè®¡å“åº”ç¤ºä¾‹**
```json
{
  "_shards": {
    "total": 3,
    "successful": 3,
    "failed": 0
  },
  "data_stream_count": 1,
  "backing_indices": 3,
  "total_store_size_bytes": 1048576,
  "data_streams": {
    "logs-myapp-prod": {
      "backing_indices": 3,
      "store_size_bytes": 1048576,
      "maximum_timestamp": 1695290400000
    }
  }
}
```

**ğŸ” ç‰¹å®šæ•°æ®æµç»Ÿè®¡**
```http
GET /_data_stream/logs-myapp-prod/_stats
```

### 5.2 ç›‘æ§æ•°æ®æµå¥åº·çŠ¶æ€


**ğŸ“Š ä½¿ç”¨cat APIç›‘æ§**
```http
# æŸ¥çœ‹æ•°æ®æµæ¦‚è§ˆ
GET /_cat/data_streams?v&h=name,status,backing_indices,store.size,docs.count

# è¾“å‡ºç¤ºä¾‹ï¼š
name             status backing_indices store.size docs.count
logs-myapp-prod  green  3               1mb        1500
logs-nginx-prod  yellow 2               500kb      800
```

**ğŸ” æŸ¥çœ‹åå¤‡ç´¢å¼•è¯¦æƒ…**
```http
GET /_cat/indices/.ds-logs-myapp-prod-*?v&h=index,status,health,pri,docs.count,store.size
```

### 5.3 æ•°æ®æµæ€§èƒ½æŒ‡æ ‡


**âš¡ å…³é”®æ€§èƒ½æŒ‡æ ‡**
```
é‡è¦ç›‘æ§æŒ‡æ ‡ï¼š

ğŸ“ˆ å†™å…¥æ€§èƒ½ï¼š
â€¢ docs.count - æ–‡æ¡£æ€»æ•°
â€¢ indexing.index_total - ç´¢å¼•æ“ä½œæ€»æ•°
â€¢ indexing.index_time_in_millis - ç´¢å¼•è€—æ—¶

ğŸ’¾ å­˜å‚¨æŒ‡æ ‡ï¼š
â€¢ store.size_bytes - å­˜å‚¨å¤§å°
â€¢ segments.count - æ®µæ•°é‡
â€¢ segments.memory_in_bytes - æ®µå†…å­˜å ç”¨

ğŸ”„ æ»šåŠ¨æŒ‡æ ‡ï¼š
â€¢ backing_indices - åå¤‡ç´¢å¼•æ•°é‡
â€¢ maximum_timestamp - æœ€æ–°æ—¶é—´æˆ³
```

---

## 6. ğŸ—‘ï¸ æ•°æ®æµåˆ é™¤ä¸ç®¡ç†


### 6.1 åˆ é™¤æ•°æ®æµ


**âš ï¸ å®Œå…¨åˆ é™¤æ•°æ®æµ**
```http
DELETE /_data_stream/logs-myapp-prod
```

> ğŸš¨ **å±é™©æ“ä½œ**ï¼šè¿™ä¼šåˆ é™¤æ•°æ®æµåŠå…¶æ‰€æœ‰åå¤‡ç´¢å¼•å’Œæ•°æ®ï¼Œæ— æ³•æ¢å¤ï¼

**ğŸ”’ å®‰å…¨åˆ é™¤ç­–ç•¥**
```http
# ç¬¬ä¸€æ­¥ï¼šåœæ­¢å†™å…¥æ•°æ®æµ
# ç¬¬äºŒæ­¥ï¼šå¤‡ä»½é‡è¦æ•°æ®
# ç¬¬ä¸‰æ­¥ï¼šç¡®è®¤æ— ä¸šåŠ¡å½±å“ååˆ é™¤
DELETE /_data_stream/logs-myapp-prod
```

### 6.2 åˆ é™¤ç‰¹å®šåå¤‡ç´¢å¼•


**ğŸ¯ åˆ é™¤å†å²ç´¢å¼•**
```http
# åªåˆ é™¤ç‰¹å®šçš„åå¤‡ç´¢å¼•ï¼ˆå†å²æ•°æ®ï¼‰
DELETE /.ds-logs-myapp-prod-2024.09.19-000001
```

> ğŸ’¡ **æœ€ä½³å®è·µ**ï¼šé€šå¸¸é…åˆILMç­–ç•¥è‡ªåŠ¨åˆ é™¤è¿‡æœŸæ•°æ®ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨åˆ é™¤

### 6.3 æ•°æ®æµé‡å‘½å


**ğŸ·ï¸ æ•°æ®æµåˆ«åç®¡ç†**
```http
# åˆ›å»ºåˆ«åæŒ‡å‘æ•°æ®æµ
POST /_aliases
{
  "actions": [
    {
      "add": {
        "index": "logs-myapp-prod",
        "alias": "current-logs"
      }
    }
  ]
}
```

---

## 7. ğŸ¯ å®æˆ˜åº”ç”¨åœºæ™¯


### 7.1 æ—¥å¿—æ”¶é›†ç³»ç»Ÿ


**ğŸ“ åº”ç”¨åœºæ™¯**
```
åœºæ™¯ï¼šå¾®æœåŠ¡æ¶æ„çš„æ—¥å¿—æ”¶é›†
éœ€æ±‚ï¼š
â€¢ æ¯å¤©äº§ç”ŸGBçº§åˆ«çš„æ—¥å¿—æ•°æ®
â€¢ éœ€è¦æŒ‰æ—¥æœŸè‡ªåŠ¨æ»šåŠ¨
â€¢ ä¿ç•™30å¤©çš„å†å²æ•°æ®
```

**âš™ï¸ å®Œæ•´é…ç½®ç¤ºä¾‹**
```http
# åˆ›å»ºç´¢å¼•ç”Ÿå‘½å‘¨æœŸç­–ç•¥
PUT /_ilm/policy/logs-30day-policy
{
  "policy": {
    "phases": {
      "hot": {
        "actions": {
          "rollover": {
            "max_size": "2GB",
            "max_age": "1d"
          }
        }
      },
      "delete": {
        "min_age": "30d",
        "actions": {
          "delete": {}
        }
      }
    }
  }
}

# åˆ›å»ºç´¢å¼•æ¨¡æ¿
PUT /_index_template/microservice-logs
{
  "index_patterns": ["logs-*-*"],
  "data_stream": {},
  "template": {
    "settings": {
      "index.lifecycle.name": "logs-30day-policy",
      "number_of_shards": 1,
      "number_of_replicas": 1
    },
    "mappings": {
      "properties": {
        "@timestamp": { "type": "date" },
        "service": { "type": "keyword" },
        "level": { "type": "keyword" },
        "message": { "type": "text" },
        "trace_id": { "type": "keyword" }
      }
    }
  }
}

# åˆ›å»ºæ•°æ®æµ
PUT /_data_stream/logs-microservice-prod
```

### 7.2 ç›‘æ§æ•°æ®æ”¶é›†


**ğŸ“Š æ€§èƒ½ç›‘æ§åœºæ™¯**
```http
# åˆ›å»ºç›‘æ§æ•°æ®æµæ¨¡æ¿
PUT /_index_template/metrics-template
{
  "index_patterns": ["metrics-*"],
  "data_stream": {},
  "template": {
    "settings": {
      "index.lifecycle.name": "metrics-policy"
    },
    "mappings": {
      "properties": {
        "@timestamp": { "type": "date" },
        "host": { "type": "keyword" },
        "cpu_usage": { "type": "float" },
        "memory_usage": { "type": "float" },
        "disk_usage": { "type": "float" }
      }
    }
  }
}

# å†™å…¥ç›‘æ§æ•°æ®
POST /metrics-system-prod/_doc
{
  "@timestamp": "2024-09-21T10:30:00.000Z",
  "host": "web-server-01",
  "cpu_usage": 75.5,
  "memory_usage": 68.2,
  "disk_usage": 45.0
}
```

### 7.3 æŸ¥è¯¢æ•°æ®æµ


**ğŸ” æ—¶é—´èŒƒå›´æŸ¥è¯¢**
```http
GET /logs-myapp-prod/_search
{
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2024-09-21T00:00:00.000Z",
        "lte": "2024-09-21T23:59:59.999Z"
      }
    }
  },
  "sort": [
    { "@timestamp": { "order": "desc" } }
  ],
  "size": 100
}
```

**ğŸ“‹ èšåˆåˆ†æ**
```http
GET /logs-myapp-prod/_search
{
  "size": 0,
  "aggs": {
    "logs_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "1h"
      },
      "aggs": {
        "log_levels": {
          "terms": {
            "field": "level"
          }
        }
      }
    }
  }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒå‘½ä»¤


| å‘½ä»¤ | **ç”¨é€”** | **ä½¿ç”¨é¢‘ç‡** |
|------|---------|-------------|
| `PUT /_data_stream/{name}` | `åˆ›å»ºæ•°æ®æµ` | â­â­â­ |
| `GET /_data_stream` | `æŸ¥çœ‹æ‰€æœ‰æ•°æ®æµ` | â­â­â­ |
| `POST /{data_stream}/_doc` | `å†™å…¥æ•°æ®` | â­â­â­â­â­ |
| `POST /_data_stream/{name}/_rollover` | `æ‰‹åŠ¨æ»šåŠ¨` | â­â­ |
| `GET /_data_stream/_stats` | `è·å–ç»Ÿè®¡ä¿¡æ¯` | â­â­â­ |
| `DELETE /_data_stream/{name}` | `åˆ é™¤æ•°æ®æµ` | â­ |

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æ•°æ®æµæœ¬è´¨**
```
æ•°æ®æµ = æ™ºèƒ½ç´¢å¼•ç®¡ç†å™¨
åŠŸèƒ½ï¼š
â€¢ è‡ªåŠ¨åˆ›å»ºå’Œç®¡ç†åå¤‡ç´¢å¼•
â€¢ åªå…è®¸è¿½åŠ æ•°æ®ï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§
â€¢ é’ˆå¯¹æ—¶é—´åºåˆ—æ•°æ®ä¼˜åŒ–
â€¢ ç®€åŒ–æ—¶åºæ•°æ®çš„å­˜å‚¨å’ŒæŸ¥è¯¢
```

**ğŸ”¹ æ•°æ®æµ vs ç´¢å¼•åˆ«å**
```
ç›¸åŒç‚¹ï¼š
â€¢ éƒ½æ˜¯ç´¢å¼•çš„æŠ½è±¡å±‚
â€¢ éƒ½æ”¯æŒæŸ¥è¯¢æ“ä½œ

ä¸åŒç‚¹ï¼š
â€¢ æ•°æ®æµä¸“é—¨ç”¨äºæ—¶åºæ•°æ®
â€¢ æ•°æ®æµæœ‰ä¸¥æ ¼çš„å†™å…¥é™åˆ¶
â€¢ æ•°æ®æµè‡ªåŠ¨ç®¡ç†ç”Ÿå‘½å‘¨æœŸ
```

**ğŸ”¹ æ»šåŠ¨ç­–ç•¥é€‰æ‹©**
```
é€‰æ‹©ä¾æ®ï¼š
â€¢ æ•°æ®é‡å¤§ â†’ æŒ‰å¤§å°æ»šåŠ¨ (max_size)
â€¢ æ—¶é—´æ•æ„Ÿ â†’ æŒ‰æ—¶é—´æ»šåŠ¨ (max_age)  
â€¢ æŸ¥è¯¢æ€§èƒ½ â†’ æŒ‰æ–‡æ¡£æ•°æ»šåŠ¨ (max_docs)
â€¢ é€šå¸¸ç»„åˆä½¿ç”¨å¤šä¸ªæ¡ä»¶
```

### 8.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ’¼ ä¸šåŠ¡åœºæ™¯åº”ç”¨**
- **ğŸ“Š æ—¥å¿—ç³»ç»Ÿ**ï¼šåº”ç”¨æ—¥å¿—ã€è®¿é—®æ—¥å¿—çš„å­˜å‚¨ç®¡ç†
- **ğŸ“ˆ ç›‘æ§ç³»ç»Ÿ**ï¼šç³»ç»ŸæŒ‡æ ‡ã€ä¸šåŠ¡æŒ‡æ ‡çš„æ—¶åºå­˜å‚¨
- **ğŸ” APMç³»ç»Ÿ**ï¼šé“¾è·¯è¿½è¸ªã€æ€§èƒ½ç›‘æ§æ•°æ®
- **ğŸ“± IoTç³»ç»Ÿ**ï¼šä¼ æ„Ÿå™¨æ•°æ®ã€è®¾å¤‡çŠ¶æ€æ•°æ®

**ğŸ› ï¸ è¿ç»´å®è·µ**
- **å®¹é‡è§„åˆ’**ï¼šæ ¹æ®æ•°æ®å¢é•¿é…ç½®æ»šåŠ¨ç­–ç•¥
- **æ€§èƒ½ä¼˜åŒ–**ï¼šåˆç†è®¾ç½®åˆ†ç‰‡å’Œå‰¯æœ¬æ•°é‡
- **æ•°æ®ç”Ÿå‘½å‘¨æœŸ**ï¼šé…ç½®ILMè‡ªåŠ¨åˆ é™¤è¿‡æœŸæ•°æ®
- **ç›‘æ§å‘Šè­¦**ï¼šç›‘æ§æ•°æ®æµçŠ¶æ€å’Œæ€§èƒ½æŒ‡æ ‡

### 8.4 æœ€ä½³å®è·µæ€»ç»“


**âœ… æ¨èåšæ³•**
```
â‘  å‘½åè§„èŒƒï¼šä½¿ç”¨ {type}-{dataset}-{namespace} æ ¼å¼
â‘¡ ç´¢å¼•æ¨¡æ¿ï¼šæå‰å®šä¹‰å¥½æ˜ å°„å’Œè®¾ç½®
â‘¢ ILMç­–ç•¥ï¼šé…ç½®è‡ªåŠ¨æ»šåŠ¨å’Œåˆ é™¤ç­–ç•¥
â‘£ ç›‘æ§å‘Šè­¦ï¼šç›‘æ§æ•°æ®æµå¥åº·çŠ¶æ€
â‘¤ å®¹é‡è§„åˆ’ï¼šæ ¹æ®ä¸šåŠ¡é‡è®¾ç½®åˆç†çš„æ»šåŠ¨æ¡ä»¶
```

**âŒ é¿å…é”™è¯¯**
```
â‘  ä¸è¦åœ¨æ•°æ®æµä¸­ä½¿ç”¨PUT/DELETEæ“ä½œ
â‘¡ ä¸è¦å¿˜è®°è®¾ç½®@timestampå­—æ®µ
â‘¢ ä¸è¦æ‰‹åŠ¨ç®¡ç†åå¤‡ç´¢å¼•
â‘£ ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒç›´æ¥åˆ é™¤æ•°æ®æµ
â‘¤ ä¸è¦å¿½ç•¥ç´¢å¼•æ¨¡æ¿çš„é‡è¦æ€§
```

**ğŸ¯ æ ¸å¿ƒè®°å¿†å£è¯€**
```
æ•°æ®æµç®¡ç†è¦è®°ç‰¢ï¼Œæ—¶åºæ•°æ®æœ€é€‚å®œ
åªèƒ½è¿½åŠ ä¸èƒ½æ”¹ï¼Œè‡ªåŠ¨æ»šåŠ¨çœå¿ƒåŠ›
æ¨¡æ¿ç­–ç•¥å…ˆé…å¥½ï¼Œç›‘æ§ç»Ÿè®¡å¸¸æŸ¥çœ‹
ç”Ÿäº§åˆ é™¤éœ€è°¨æ…ï¼Œå¤‡ä»½å…ˆè¡Œä¿å¹³å®‰
```