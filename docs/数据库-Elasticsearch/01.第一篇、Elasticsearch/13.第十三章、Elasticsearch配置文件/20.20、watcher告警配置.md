---
title: 20ã€watcherå‘Šè­¦é…ç½®
---
## ğŸ“š ç›®å½•

1. [Watcherå‘Šè­¦ç³»ç»Ÿæ¦‚è¿°](#1-Watcherå‘Šè­¦ç³»ç»Ÿæ¦‚è¿°)
2. [æ ¸å¿ƒé…ç½®å‚æ•°è¯¦è§£](#2-æ ¸å¿ƒé…ç½®å‚æ•°è¯¦è§£)
3. [å‘Šè­¦é€šé“é…ç½®å®æˆ˜](#3-å‘Šè­¦é€šé“é…ç½®å®æˆ˜)
4. [è°ƒåº¦ä¸è§¦å‘æœºåˆ¶](#4-è°ƒåº¦ä¸è§¦å‘æœºåˆ¶)
5. [å®é™…åº”ç”¨åœºæ™¯](#5-å®é™…åº”ç”¨åœºæ™¯)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”” Watcherå‘Šè­¦ç³»ç»Ÿæ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯Watcher


**ğŸ”¸ ç®€å•ç†è§£**
```
Watcherå°±åƒæ˜¯Elasticsearchçš„"å“¨å…µ"
- 24å°æ—¶ä¸åœåœ°ç›‘æ§ä½ çš„æ•°æ®
- å‘ç°å¼‚å¸¸æƒ…å†µç«‹å³é€šçŸ¥ä½ 
- æ”¯æŒé‚®ä»¶ã€å¾®ä¿¡ã€é’‰é’‰ç­‰å¤šç§é€šçŸ¥æ–¹å¼
```

**ğŸ¯ æ ¸å¿ƒä½œç”¨**
- **å®æ—¶ç›‘æ§**ï¼šæŒç»­ç›‘æ§é›†ç¾¤çŠ¶æ€å’Œæ•°æ®å˜åŒ–
- **æ™ºèƒ½å‘Šè­¦**ï¼šæ ¹æ®è®¾å®šæ¡ä»¶è‡ªåŠ¨è§¦å‘å‘Šè­¦
- **å¤šæ¸ é“é€šçŸ¥**ï¼šæ”¯æŒé‚®ä»¶ã€Slackã€é’‰é’‰ç­‰é€šçŸ¥æ–¹å¼
- **å†å²è¿½è¸ª**ï¼šè®°å½•æ‰€æœ‰å‘Šè­¦å†å²ä¾¿äºåˆ†æ

### 1.2 Watcherå·¥ä½œåŸç†


**ğŸ”„ å·¥ä½œæµç¨‹å›¾**
```
æ•°æ®æº â†’ ç›‘æ§æ¡ä»¶ â†’ è§¦å‘å™¨ â†’ æ‰§è¡ŒåŠ¨ä½œ â†’ å‘é€é€šçŸ¥

å…·ä½“è¿‡ç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®šæ—¶æ£€æŸ¥    â”‚â”€â”€â”€â†’â”‚  æ¡ä»¶åˆ¤æ–­    â”‚â”€â”€â”€â†’â”‚  æ‰§è¡Œå‘Šè­¦    â”‚
â”‚  (Schedule) â”‚    â”‚ (Condition) â”‚    â”‚  (Action)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†‘                   â”‚                   â”‚
       â”‚                   â–¼                   â–¼
   è°ƒåº¦å™¨é…ç½®         æŸ¥è¯¢ESæ•°æ®        å‘é€é‚®ä»¶/æ¶ˆæ¯
```

### 1.3 ä¸ºä»€ä¹ˆéœ€è¦å‘Šè­¦ç›‘æ§


**ğŸ’¡ å®é™…åœºæ™¯ä¸¾ä¾‹**
```
ç”µå•†ç½‘ç«™åœºæ™¯ï¼š
âŒ æ²¡æœ‰ç›‘æ§ï¼šç³»ç»Ÿå®•æœº2å°æ—¶æ‰å‘ç°ï¼ŒæŸå¤±å·¨å¤§
âœ… æœ‰äº†Watcherï¼š1åˆ†é’Ÿå†…æ”¶åˆ°å‘Šè­¦ï¼Œå¿«é€Ÿå“åº”

å…·ä½“ç›‘æ§å†…å®¹ï¼š
â€¢ è®¢å•é‡çªç„¶ä¸‹é™ â†’ å¯èƒ½ç³»ç»Ÿæ•…éšœ
â€¢ é”™è¯¯æ—¥å¿—æ¿€å¢ â†’ å¯èƒ½ç¨‹åºbug
â€¢ ç£ç›˜ç©ºé—´ä¸è¶³ â†’ å¯èƒ½å½±å“å†™å…¥
â€¢ æŸ¥è¯¢å“åº”å˜æ…¢ â†’ å¯èƒ½æ€§èƒ½é—®é¢˜
```

---

## 2. âš™ï¸ æ ¸å¿ƒé…ç½®å‚æ•°è¯¦è§£


### 2.1 åŸºç¡€å¯ç”¨é…ç½®


#### ğŸ”¸ xpack.watcher.enabled


**å‚æ•°å«ä¹‰**ï¼šæ§åˆ¶WatcheråŠŸèƒ½çš„æ€»å¼€å…³

```yaml
# elasticsearch.ymlé…ç½®
xpack.watcher.enabled: true
```

**ğŸ¯ é…ç½®è¯´æ˜**
- `true`ï¼šå¯ç”¨WatcheråŠŸèƒ½
- `false`ï¼šå®Œå…¨ç¦ç”¨Watcher
- **é»˜è®¤å€¼**ï¼štrueï¼ˆå¦‚æœæœ‰X-Packè®¸å¯è¯ï¼‰

**ğŸ’­ æ–°æ‰‹ç†è§£**
> å°±åƒå®¶é‡Œçš„æ€»ç”µé—¸ï¼Œåªæœ‰æ‰“å¼€äº†ï¼Œå„ä¸ªæˆ¿é—´çš„ç¯æ‰èƒ½äº®ã€‚è¿™ä¸ªå‚æ•°å°±æ˜¯Watcherçš„"æ€»ç”µé—¸"

#### ğŸ”¸ xpack.watcher.history.cleaner_service.enabled


**å‚æ•°å«ä¹‰**ï¼šè‡ªåŠ¨æ¸…ç†å‘Šè­¦å†å²è®°å½•

```yaml
xpack.watcher.history.cleaner_service.enabled: true
```

**ğŸ”§ é…ç½®è¯¦è§£**
```
å¯ç”¨åçš„å¥½å¤„ï¼š
â€¢ è‡ªåŠ¨åˆ é™¤è¿‡æœŸçš„å‘Šè­¦è®°å½•
â€¢ é˜²æ­¢å†å²æ•°æ®å ç”¨è¿‡å¤šç£ç›˜ç©ºé—´
â€¢ ä¿æŒç³»ç»Ÿæ€§èƒ½ç¨³å®š

é»˜è®¤æ¸…ç†è§„åˆ™ï¼š
â€¢ ä¿ç•™æœ€è¿‘7å¤©çš„å‘Šè­¦å†å²
â€¢ æ¯å¤©å‡Œæ™¨è‡ªåŠ¨æ‰§è¡Œæ¸…ç†
```

### 2.2 é™æµä¸æ€§èƒ½é…ç½®


#### ğŸ”¸ xpack.watcher.execution.default_throttle_period


**å‚æ•°å«ä¹‰**ï¼šé˜²æ­¢å‘Šè­¦è½°ç‚¸çš„é™æµè®¾ç½®

```yaml
# è®¾ç½®é»˜è®¤é™æµæœŸä¸º5åˆ†é’Ÿ
xpack.watcher.execution.default_throttle_period: 5m
```

**ğŸ“Š é™æµæœºåˆ¶å›¾è§£**
```
æ­£å¸¸æƒ…å†µï¼š
æ—¶é—´: 10:00  10:05  10:10  10:15
å‘Šè­¦: [å‘é€]  [å‘é€]  [å‘é€]  [å‘é€]

é™æµæœŸ5åˆ†é’Ÿï¼š
æ—¶é—´: 10:00  10:01  10:02  10:05  
å‘Šè­¦: [å‘é€]  [é˜»æ­¢]  [é˜»æ­¢]  [å‘é€]
       â†‘      â†‘      â†‘      â†‘
    é¦–æ¬¡å‘Šè­¦  é™æµä¸­  é™æµä¸­  é™æµæœŸæ»¡
```

**ğŸ¯ å®é™…åº”ç”¨**
```
åœºæ™¯ï¼šæœåŠ¡å™¨CPUä½¿ç”¨ç‡è¶…è¿‡90%

ä¸è®¾é™æµï¼š
10:00:01 - å‘Šè­¦ï¼šCPU 91%
10:00:02 - å‘Šè­¦ï¼šCPU 92% 
10:00:03 - å‘Šè­¦ï¼šCPU 93%
...è¿ç»­è½°ç‚¸100æ¡æ¶ˆæ¯

è®¾ç½®5åˆ†é’Ÿé™æµï¼š
10:00:01 - å‘Šè­¦ï¼šCPU 91%
10:05:01 - å‘Šè­¦ï¼šCPUä»ç„¶91%
```

### 2.3 è°ƒåº¦å™¨é…ç½®


#### ğŸ”¸ xpack.watcher.trigger.schedule.ticker.tick_interval


**å‚æ•°å«ä¹‰**ï¼šè°ƒåº¦å™¨æ£€æŸ¥é—´éš”æ—¶é—´

```yaml
# æ¯1ç§’æ£€æŸ¥ä¸€æ¬¡æ˜¯å¦æœ‰éœ€è¦æ‰§è¡Œçš„Watch
xpack.watcher.trigger.schedule.ticker.tick_interval: 1s
```

**â° è°ƒåº¦å™¨å·¥ä½œåŸç†**
```
è°ƒåº¦å™¨æ—¶é—´è½´ï¼š
â”œâ”€1sâ”€â”¼â”€1sâ”€â”¼â”€1sâ”€â”¼â”€1sâ”€â”¼â”€1sâ”€â”¼â”€1sâ”€â”¼
     æ£€æŸ¥  æ£€æŸ¥  æ£€æŸ¥  æ£€æŸ¥  æ£€æŸ¥  æ£€æŸ¥

æ¯æ¬¡æ£€æŸ¥å†…å®¹ï¼š
1. æ˜¯å¦æœ‰Watchåˆ°æœŸéœ€è¦æ‰§è¡Œï¼Ÿ
2. æ‰§è¡Œæ¡ä»¶æ˜¯å¦æ»¡è¶³ï¼Ÿ
3. æ˜¯å¦åœ¨é™æµæœŸå†…ï¼Ÿ
4. æ‰§è¡Œç›¸åº”çš„åŠ¨ä½œ
```

**ğŸ”§ æ€§èƒ½å½±å“å¯¹æ¯”**

| é—´éš”æ—¶é—´ | **èµ„æºæ¶ˆè€—** | **å“åº”é€Ÿåº¦** | **é€‚ç”¨åœºæ™¯** |
|---------|------------|------------|------------|
| `1s` | `é«˜` | `æœ€å¿«` | `å…³é”®ä¸šåŠ¡ç›‘æ§` |
| `5s` | `ä¸­` | `è¾ƒå¿«` | `ä¸€èˆ¬ä¸šåŠ¡ç›‘æ§` |
| `30s` | `ä½` | `ä¸€èˆ¬` | `æ—¥å¸¸çŠ¶æ€æ£€æŸ¥` |
| `1m` | `å¾ˆä½` | `è¾ƒæ…¢` | `é•¿æœŸè¶‹åŠ¿ç›‘æ§` |

---

## 3. ğŸ“§ å‘Šè­¦é€šé“é…ç½®å®æˆ˜


### 3.1 é‚®ä»¶å‘Šè­¦é…ç½®


#### ğŸ”¸ xpack.watcher.actions.email.service.account


**é…ç½®ç¤ºä¾‹**
```yaml
# elasticsearch.yml
xpack.watcher.actions.email.service.account:
  gmail_account:
    smtp:
      host: smtp.gmail.com
      port: 587
      user: your-email@gmail.com
      password: your-app-password
    email_defaults:
      from: alerts@yourcompany.com
      to: ["admin@yourcompany.com"]
```

**ğŸ“¬ é‚®ä»¶é…ç½®è¯¦è§£**
```
é…ç½®å‚æ•°è¯´æ˜ï¼š
â€¢ host: é‚®ä»¶æœåŠ¡å™¨åœ°å€
â€¢ port: SMTPç«¯å£ï¼ˆ587-TLS, 465-SSL, 25-æ™®é€šï¼‰
â€¢ user: å‘é€é‚®ç®±è´¦å·
â€¢ password: é‚®ç®±å¯†ç æˆ–åº”ç”¨ä¸“ç”¨å¯†ç 
â€¢ from: å‘ä»¶äººæ˜¾ç¤ºåœ°å€
â€¢ to: é»˜è®¤æ”¶ä»¶äººåˆ—è¡¨
```

**ğŸ’¡ å¸¸è§é‚®ç®±é…ç½®**
```yaml
# ä¼ä¸šé‚®ç®±é…ç½®
enterprise_email:
  smtp:
    host: smtp.exmail.qq.com    # è…¾è®¯ä¼ä¸šé‚®ç®±
    port: 587
    user: alerts@company.com
    password: your-password

# 163é‚®ç®±é…ç½®  
netease_email:
  smtp:
    host: smtp.163.com
    port: 25
    user: your-email@163.com
    password: your-password
```

### 3.2 å³æ—¶é€šè®¯é…ç½®


#### ğŸ”¸ Slacké›†æˆé…ç½®


```yaml
xpack.watcher.actions.slack.service.account:
  monitoring:
    url: https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
    message_defaults:
      channel: "#alerts"
      username: "ElasticWatcher"
```

**ğŸ’¬ Slackå‘Šè­¦æ•ˆæœ**
```
Slackæ¶ˆæ¯ç¤ºä¾‹ï¼š
ğŸš¨ [å‘Šè­¦] Elasticsearché›†ç¾¤å¼‚å¸¸
æ—¶é—´: 2025-09-21 15:30:00
é—®é¢˜: CPUä½¿ç”¨ç‡è¶…è¿‡90%
å½“å‰å€¼: 95%
é›†ç¾¤: production-cluster
å»ºè®®: ç«‹å³æ£€æŸ¥æœåŠ¡å™¨è´Ÿè½½
```

#### ğŸ”¸ é’‰é’‰/ä¼ä¸šå¾®ä¿¡é…ç½®


```yaml
# é€šè¿‡webhookå®ç°é’‰é’‰å‘Šè­¦
xpack.watcher.actions.webhook.service.account:
  dingtalk:
    url: https://oapi.dingtalk.com/robot/send?access_token=YOUR_TOKEN
    method: POST
    headers:
      Content-Type: "application/json"
```

### 3.3 PagerDutyé›†æˆ


#### ğŸ”¸ xpack.watcher.actions.pagerduty.service.account


```yaml
xpack.watcher.actions.pagerduty.service.account:
  my_pagerduty_account:
    service_api_key: YOUR_PAGERDUTY_SERVICE_KEY
    event_defaults:
      client: "Elasticsearch Watcher"
      client_url: "https://your-kibana-url"
```

**ğŸš¨ PagerDutyå‘Šè­¦æµç¨‹**
```
å‘Šè­¦è§¦å‘æµç¨‹ï¼š
ESå¼‚å¸¸ â†’ Watcheræ£€æµ‹ â†’ PagerDutyåˆ›å»ºäº‹ä»¶ â†’ é€šçŸ¥å€¼ç­äººå‘˜

é€šçŸ¥æ–¹å¼ï¼š
ğŸ“± æ‰‹æœºAPPæ¨é€
ğŸ“§ é‚®ä»¶é€šçŸ¥  
ğŸ“ ç”µè¯å‘Šè­¦ï¼ˆä¸¥é‡çº§åˆ«ï¼‰
ğŸ’¬ çŸ­ä¿¡æé†’
```

---

## 4. â° è°ƒåº¦ä¸è§¦å‘æœºåˆ¶


### 4.1 Watchæ‰§è¡Œå‘¨æœŸ


**ğŸ”„ è°ƒåº¦ç±»å‹å¯¹æ¯”**

| è°ƒåº¦ç±»å‹ | **é…ç½®ç¤ºä¾‹** | **æ‰§è¡Œé¢‘ç‡** | **é€‚ç”¨åœºæ™¯** |
|---------|------------|------------|------------|
| `interval` | `"interval": "30s"` | `å›ºå®šé—´éš”` | `æŒç»­ç›‘æ§` |
| `daily` | `"daily": {"at": ["09:00"]}` | `æ¯å¤©æ‰§è¡Œ` | `æ—¥æŠ¥å‘Šè­¦` |
| `weekly` | `"weekly": [{"on": "monday", "at": "09:00"}]` | `æ¯å‘¨æ‰§è¡Œ` | `å‘¨æŠ¥å‘Šè­¦` |
| `monthly` | `"monthly": [{"on": 1, "at": "00:00"}]` | `æ¯æœˆæ‰§è¡Œ` | `æœˆåº¦æ£€æŸ¥` |
| `cron` | `"cron": "0 0 12 * * ?"` | `è‡ªå®šä¹‰` | `å¤æ‚è°ƒåº¦` |

### 4.2 è§¦å‘æ¡ä»¶è®¾ç½®


**ğŸ“Š å¸¸è§ç›‘æ§æŒ‡æ ‡**
```yaml
# CPUä½¿ç”¨ç‡ç›‘æ§
condition:
  compare:
    ctx.payload.aggregations.avg_cpu.value:
      gte: 90

# é”™è¯¯æ—¥å¿—ç›‘æ§  
condition:
  compare:
    ctx.payload.hits.total:
      gt: 100

# ç£ç›˜ç©ºé—´ç›‘æ§
condition:
  compare:
    ctx.payload.aggregations.disk_usage.value:
      gte: 85
```

**ğŸ¯ æ¡ä»¶åˆ¤æ–­é€»è¾‘**
```
åˆ¤æ–­è¿ç®—ç¬¦ï¼š
â€¢ eq: ç­‰äº (equal)
â€¢ ne: ä¸ç­‰äº (not equal)  
â€¢ gt: å¤§äº (greater than)
â€¢ gte: å¤§äºç­‰äº (greater than or equal)
â€¢ lt: å°äº (less than)
â€¢ lte: å°äºç­‰äº (less than or equal)
```

### 4.3 WatchçŠ¶æ€ç®¡ç†


**ğŸ“‹ Watchç”Ÿå‘½å‘¨æœŸ**
```
WatchçŠ¶æ€æµè½¬ï¼š
åˆ›å»º â†’ æ¿€æ´» â†’ æ‰§è¡Œ â†’ å®Œæˆ
  â†“       â†“       â†“       â†“
draft  active  executing acknowledged

çŠ¶æ€è¯´æ˜ï¼š
â€¢ draft: è‰ç¨¿çŠ¶æ€ï¼Œæœªæ¿€æ´»
â€¢ active: æ¿€æ´»çŠ¶æ€ï¼Œæ­£å¸¸ç›‘æ§
â€¢ executing: æ‰§è¡Œä¸­çŠ¶æ€
â€¢ acknowledged: å·²ç¡®è®¤çŠ¶æ€ï¼Œæš‚åœå‘Šè­¦
```

---

## 5. ğŸ¢ å®é™…åº”ç”¨åœºæ™¯


### 5.1 ä¸šåŠ¡ç›‘æ§åœºæ™¯


**ğŸ“ˆ ç”µå•†è®¢å•ç›‘æ§**
```yaml
# è®¢å•é‡å¼‚å¸¸ç›‘æ§Watch
{
  "trigger": {
    "schedule": {"interval": "5m"}
  },
  "input": {
    "search": {
      "request": {
        "indices": ["orders-*"],
        "body": {
          "query": {
            "range": {
              "timestamp": {"gte": "now-5m"}
            }
          },
          "aggs": {
            "order_count": {"value_count": {"field": "order_id"}}
          }
        }
      }
    }
  },
  "condition": {
    "compare": {
      "ctx.payload.aggregations.order_count.value": {"lt": 10}
    }
  },
  "actions": {
    "send_email": {
      "email": {
        "to": ["business@company.com"],
        "subject": "âš ï¸ è®¢å•é‡å¼‚å¸¸å‘Šè­¦",
        "body": "æœ€è¿‘5åˆ†é’Ÿè®¢å•é‡ä»…{{ctx.payload.aggregations.order_count.value}}å•ï¼Œè¯·åŠæ—¶æ£€æŸ¥ï¼"
      }
    }
  }
}
```

### 5.2 ç³»ç»Ÿæ€§èƒ½ç›‘æ§


**âš¡ é›†ç¾¤å¥åº·ç›‘æ§**
```yaml
# é›†ç¾¤çŠ¶æ€ç›‘æ§
{
  "trigger": {
    "schedule": {"interval": "1m"}
  },
  "input": {
    "http": {
      "request": {
        "host": "localhost",
        "port": 9200,
        "path": "/_cluster/health"
      }
    }
  },
  "condition": {
    "compare": {
      "ctx.payload.status": {"ne": "green"}
    }
  },
  "actions": {
    "notify_ops": {
      "slack": {
        "account": "monitoring",
        "message": {
          "text": "ğŸš¨ é›†ç¾¤çŠ¶æ€å¼‚å¸¸: {{ctx.payload.status}}\né›†ç¾¤: {{ctx.payload.cluster_name}}\næ—¶é—´: {{ctx.execution_time}}"
        }
      }
    }
  }
}
```

### 5.3 å®‰å…¨ç›‘æ§åœºæ™¯


**ğŸ”’ å¼‚å¸¸ç™»å½•ç›‘æ§**
```yaml
# å¤±è´¥ç™»å½•æ¬¡æ•°ç›‘æ§
{
  "trigger": {
    "schedule": {"interval": "1m"}
  },
  "input": {
    "search": {
      "request": {
        "indices": ["security-logs-*"],
        "body": {
          "query": {
            "bool": {
              "must": [
                {"term": {"event_type": "login_failed"}},
                {"range": {"timestamp": {"gte": "now-1m"}}}
              ]
            }
          },
          "aggs": {
            "by_ip": {
              "terms": {"field": "source_ip"},
              "aggs": {
                "failure_count": {"value_count": {"field": "timestamp"}}
              }
            }
          }
        }
      }
    }
  },
  "condition": {
    "array_compare": {
      "ctx.payload.aggregations.by_ip.buckets": {
        "path": "failure_count.value",
        "gte": {"value": 5}
      }
    }
  }
}
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ Watcheræœ¬è´¨ï¼šESçš„æ™ºèƒ½ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿ
ğŸ”¸ æ ¸å¿ƒç»„ä»¶ï¼šè§¦å‘å™¨(Trigger) + è¾“å…¥(Input) + æ¡ä»¶(Condition) + åŠ¨ä½œ(Action)
ğŸ”¸ é…ç½®è¦ç‚¹ï¼šå¯ç”¨å¼€å…³ã€é™æµè®¾ç½®ã€è°ƒåº¦é—´éš”ã€é€šçŸ¥æ¸ é“
ğŸ”¸ åº”ç”¨åœºæ™¯ï¼šä¸šåŠ¡ç›‘æ§ã€æ€§èƒ½å‘Šè­¦ã€å®‰å…¨é˜²æŠ¤ã€è¿ç»´è‡ªåŠ¨åŒ–
```

### 6.2 å…³é”®é…ç½®è®°å¿†


**ğŸ”¹ å¿…è®°é…ç½®å‚æ•°**
```yaml
# æ ¸å¿ƒé…ç½®ä¸‰è¦ç´ 
xpack.watcher.enabled: true                    # åŠŸèƒ½å¼€å…³
xpack.watcher.execution.default_throttle_period: 5m  # é™æµé˜²è½°ç‚¸
xpack.watcher.trigger.schedule.ticker.tick_interval: 1s  # æ£€æŸ¥é¢‘ç‡

# é‚®ä»¶é…ç½®
xpack.watcher.actions.email.service.account.gmail_account.smtp.host: smtp.gmail.com

# å†å²æ¸…ç†
xpack.watcher.history.cleaner_service.enabled: true
```

**ğŸ”¹ é…ç½®ä¼˜å…ˆçº§**
```
é‡è¦æ€§æ’åºï¼š
1. â­â­â­ enabled - åŠŸèƒ½æ€»å¼€å…³
2. â­â­â­ email.service.account - å‘Šè­¦é€šé“  
3. â­â­ default_throttle_period - é˜²æ­¢å‘Šè­¦è½°ç‚¸
4. â­â­ tick_interval - å“åº”é€Ÿåº¦
5. â­ history.cleaner_service - ç»´æŠ¤æ¸…ç†
```

### 6.3 å®æˆ˜åº”ç”¨æŒ‡å—


**ğŸ¯ æ–°æ‰‹ä¸Šè·¯æ­¥éª¤**
```
ç¬¬ä¸€æ­¥ï¼šåŸºç¡€é…ç½®
â€¢ å¯ç”¨WatcheråŠŸèƒ½
â€¢ é…ç½®é‚®ä»¶è´¦æˆ·
â€¢ è®¾ç½®åˆç†çš„é™æµæ—¶é—´

ç¬¬äºŒæ­¥ï¼šåˆ›å»ºç®€å•Watch  
â€¢ ç›‘æ§é›†ç¾¤å¥åº·çŠ¶æ€
â€¢ è®¾ç½®é‚®ä»¶å‘Šè­¦
â€¢ æµ‹è¯•å‘Šè­¦æ˜¯å¦æ­£å¸¸

ç¬¬ä¸‰æ­¥ï¼šæ‰©å±•ç›‘æ§
â€¢ æ·»åŠ ä¸šåŠ¡æŒ‡æ ‡ç›‘æ§
â€¢ é…ç½®å¤šç§é€šçŸ¥æ¸ é“
â€¢ ä¼˜åŒ–å‘Šè­¦è§„åˆ™

ç¬¬å››æ­¥ï¼šè¿ç»´ä¼˜åŒ–
â€¢ å®šæœŸæ¸…ç†å†å²æ•°æ®
â€¢ è°ƒæ•´å‘Šè­¦é˜ˆå€¼
â€¢ å®Œå–„å‘Šè­¦å¤„ç†æµç¨‹
```

**ğŸ’¡ æœ€ä½³å®è·µå»ºè®®**
- **å‘Šè­¦ä¸è¦å¤ªé¢‘ç¹**ï¼šè®¾ç½®åˆç†çš„é™æµæœŸï¼Œé¿å…å‘Šè­¦è½°ç‚¸
- **åˆ†çº§å‘Šè­¦å¤„ç†**ï¼šä¸åŒä¸¥é‡çº§åˆ«ä½¿ç”¨ä¸åŒé€šçŸ¥æ–¹å¼
- **æµ‹è¯•å‘Šè­¦é…ç½®**ï¼šä¸Šçº¿å‰ä¸€å®šè¦æµ‹è¯•å‘Šè­¦æ˜¯å¦æ­£å¸¸å·¥ä½œ
- **å®šæœŸç»´æŠ¤æ¸…ç†**ï¼šé¿å…å†å²æ•°æ®å ç”¨è¿‡å¤šå­˜å‚¨ç©ºé—´

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
Watcherç›‘æ§å¾ˆé‡è¦ï¼Œé…ç½®å‚æ•°è¦è®°ç‰¢
enabledå¼€å…³è¦æ‰“å¼€ï¼Œemailè´¦æˆ·é…ç½®å¥½  
é™æµæ—¶é—´é˜²è½°ç‚¸ï¼Œè°ƒåº¦é—´éš”æ§é¢‘ç‡
å‘Šè­¦é€šé“å¤šæ ·åŒ–ï¼Œæµ‹è¯•éªŒè¯ä¸å¯å°‘
```