---
title: 1ã€Consoleä¸APIè°ƒè¯•
---
## ğŸ“š ç›®å½•

1. [Kibanaå¼€å‘å·¥å…·æ¦‚è¿°](#1-Kibanaå¼€å‘å·¥å…·æ¦‚è¿°)
2. [Consoleç•Œé¢è¯¦è§£](#2-Consoleç•Œé¢è¯¦è§£)
3. [Elasticsearch APIè°ƒè¯•åŸºç¡€](#3-Elasticsearch-APIè°ƒè¯•åŸºç¡€)
4. [ç´¢å¼•æ“ä½œAPIå®æˆ˜](#4-ç´¢å¼•æ“ä½œAPIå®æˆ˜)
5. [æŸ¥è¯¢APIæµ‹è¯•ä¸ä¼˜åŒ–](#5-æŸ¥è¯¢APIæµ‹è¯•ä¸ä¼˜åŒ–)
6. [èšåˆAPIæ·±åº¦åº”ç”¨](#6-èšåˆAPIæ·±åº¦åº”ç”¨)
7. [æ˜ å°„APIæ“ä½œæŒ‡å—](#7-æ˜ å°„APIæ“ä½œæŒ‡å—)
8. [æ‰¹é‡æ“ä½œè„šæœ¬ç¼–å†™](#8-æ‰¹é‡æ“ä½œè„šæœ¬ç¼–å†™)
9. [APIå“åº”åˆ†ææŠ€å·§](#9-APIå“åº”åˆ†ææŠ€å·§)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ› ï¸ Kibanaå¼€å‘å·¥å…·æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯Kibanaå¼€å‘å·¥å…·


**ç®€å•ç†è§£**ï¼š
Kibanaçš„å¼€å‘å·¥å…·(Dev Tools)å°±åƒæ˜¯ä¸€ä¸ª**ä¸“é—¨å’ŒElasticsearchå¯¹è¯çš„èŠå¤©çª—å£**ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œç›´æ¥ç»™Elasticsearchå‘é€å„ç§æŒ‡ä»¤ï¼Œå°±åƒåœ¨å‘½ä»¤è¡Œé‡Œè¾“å…¥å‘½ä»¤ä¸€æ ·ã€‚

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
```
ğŸ“ Consoleï¼šä¸»è¦å·¥å…·ï¼Œç”¨æ¥å‘é€APIè¯·æ±‚
ğŸ” Search Profilerï¼šåˆ†ææŸ¥è¯¢æ€§èƒ½
ğŸ“Š Grok Debuggerï¼šè°ƒè¯•æ—¥å¿—è§£æè§„åˆ™
ğŸ”§ Painless Labï¼šæµ‹è¯•è„šæœ¬ä»£ç 
```

### 1.2 ä¸ºä»€ä¹ˆè¦ç”¨å¼€å‘å·¥å…·


**ç°å®åœºæ™¯ç±»æ¯”**ï¼š
```
ä¸ç”¨å¼€å‘å·¥å…· = åªèƒ½é€šè¿‡å›¾å½¢ç•Œé¢ç‚¹ç‚¹ç‚¹
ä½¿ç”¨å¼€å‘å·¥å…· = ç›´æ¥ç”¨"ä»£ç "å’Œæ•°æ®åº“äº¤æµ

å°±åƒï¼š
ğŸ–±ï¸ ç”¨é¼ æ ‡å¤åˆ¶æ–‡ä»¶ vs âŒ¨ï¸ ç”¨å‘½ä»¤è¡Œæ‰¹é‡å¤„ç†
å‰è€…ç®€å•ä½†æœ‰é™ï¼Œåè€…çµæ´»ä½†éœ€è¦å­¦ä¹ 
```

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- ğŸ¯ **ç²¾ç¡®æ§åˆ¶**ï¼šèƒ½åšå›¾å½¢ç•Œé¢åšä¸åˆ°çš„äº‹
- âš¡ **æ•ˆç‡æ›´é«˜**ï¼šæ‰¹é‡æ“ä½œã€å¤æ‚æŸ¥è¯¢
- ğŸ”§ **è°ƒè¯•åˆ©å™¨**ï¼šå¿«é€Ÿæµ‹è¯•å’Œæ’é”™
- ğŸ“š **å­¦ä¹ å·¥å…·**ï¼šç†è§£Elasticsearchå·¥ä½œåŸç†

### 1.3 é€‚ç”¨åœºæ™¯


**ä»€ä¹ˆæ—¶å€™ç”¨å¼€å‘å·¥å…·**ï¼š
- âœ… éœ€è¦å¤æ‚çš„æ•°æ®æŸ¥è¯¢
- âœ… æ‰¹é‡åˆ›å»º/åˆ é™¤ç´¢å¼•
- âœ… è°ƒè¯•æŸ¥è¯¢æ€§èƒ½é—®é¢˜
- âœ… å­¦ä¹ Elasticsearch API
- âœ… è‡ªåŠ¨åŒ–è„šæœ¬å¼€å‘

**ä»€ä¹ˆæ—¶å€™ç”¨å›¾å½¢ç•Œé¢**ï¼š
- âœ… å¿«é€ŸæŸ¥çœ‹æ•°æ®
- âœ… åˆ¶ä½œå¯è§†åŒ–å›¾è¡¨
- âœ… æ—¥å¸¸æ•°æ®åˆ†æ
- âœ… å±•ç¤ºç»™ä¸šåŠ¡äººå‘˜

---

## 2. ğŸ’» Consoleç•Œé¢è¯¦è§£


### 2.1 Consoleç•Œé¢å¸ƒå±€


**ç•Œé¢ç»„æˆ**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Kibanaèœå•                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dev Tools > Console                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 â”‚                                   â”‚
â”‚   è¯·æ±‚ç¼–è¾‘åŒº     â”‚        å“åº”æ˜¾ç¤ºåŒº                  â”‚
â”‚                 â”‚                                   â”‚
â”‚ GET _cat/indicesâ”‚ {                                â”‚
â”‚                 â”‚   "health": "green",             â”‚
â”‚                 â”‚   "status": "open"               â”‚
â”‚                 â”‚ }                                â”‚
â”‚                 â”‚                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [æ‰§è¡ŒæŒ‰é’®] [å†å²è®°å½•] [è®¾ç½®]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 åŸºæœ¬æ“ä½œæ–¹å¼


**å‘é€è¯·æ±‚çš„æ­¥éª¤**ï¼š
```
ç¬¬1æ­¥ï¼šåœ¨å·¦ä¾§ç¼–è¾‘åŒºè¾“å…¥APIå‘½ä»¤
ç¬¬2æ­¥ï¼šç‚¹å‡»æ’­æ”¾æŒ‰é’®ï¼ˆæˆ–æŒ‰Ctrl+Enterï¼‰
ç¬¬3æ­¥ï¼šåœ¨å³ä¾§æŸ¥çœ‹è¿”å›ç»“æœ
```

**å®é™…æ“ä½œç¤ºä¾‹**ï¼š
```json
# 1. æŸ¥çœ‹é›†ç¾¤å¥åº·çŠ¶æ€ï¼ˆæœ€ç®€å•çš„å‘½ä»¤ï¼‰
GET _cluster/health

# 2. æŸ¥çœ‹æ‰€æœ‰ç´¢å¼•
GET _cat/indices?v

# 3. è·å–ç‰¹å®šç´¢å¼•ä¿¡æ¯
GET my_index/_settings
```

### 2.3 Consoleå¿«æ·åŠŸèƒ½


**è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½**ï¼š
```
ğŸ’¡ æ™ºèƒ½æç¤ºï¼š
- è¾“å…¥GETæ—¶ä¼šæç¤ºå¯ç”¨çš„APIè·¯å¾„
- è¾“å…¥ç´¢å¼•åæ—¶ä¼šæç¤ºå·²å­˜åœ¨çš„ç´¢å¼•
- æ”¯æŒAPIå‚æ•°çš„è‡ªåŠ¨è¡¥å…¨

ğŸ” ä½¿ç”¨æ–¹æ³•ï¼š
è¾“å…¥æ—¶æŒ‰Tabé”®æˆ–Ctrl+Spaceè§¦å‘è¡¥å…¨
```

**å†å²è®°å½•åŠŸèƒ½**ï¼š
- ğŸ“– **æŸ¥çœ‹å†å²**ï¼šç‚¹å‡»æ—¶é’Ÿå›¾æ ‡æŸ¥çœ‹ä¹‹å‰æ‰§è¡Œçš„å‘½ä»¤
- ğŸ”„ **é‡å¤æ‰§è¡Œ**ï¼šç›´æ¥ç‚¹å‡»å†å²è®°å½•ä¸­çš„å‘½ä»¤
- ğŸ’¾ **ä¿å­˜å¸¸ç”¨**ï¼šå¯ä»¥æ”¶è—ç»å¸¸ä½¿ç”¨çš„å‘½ä»¤

**å¤šè¡Œç¼–è¾‘æŠ€å·§**ï¼š
```json
# æ”¯æŒä¸€æ¬¡å†™å¤šä¸ªè¯·æ±‚
GET _cluster/health

GET _cat/indices

POST my_index/_doc
{
  "title": "æµ‹è¯•æ–‡æ¡£",
  "content": "è¿™æ˜¯æµ‹è¯•å†…å®¹"
}
```

---

## 3. ğŸ” Elasticsearch APIè°ƒè¯•åŸºç¡€


### 3.1 APIè¯·æ±‚æ ¼å¼è¯¦è§£


**åŸºæœ¬è¯­æ³•ç»“æ„**ï¼š
```
HTTPæ–¹æ³• APIè·¯å¾„ HTTPç‰ˆæœ¬(å¯é€‰)
è¯·æ±‚ä½“å†…å®¹(JSONæ ¼å¼)
```

**å¸¸ç”¨HTTPæ–¹æ³•**ï¼š
```
GET    - è·å–æ•°æ®ï¼ˆæŸ¥è¯¢ã€è·å–è®¾ç½®ç­‰ï¼‰
POST   - åˆ›å»ºæ•°æ®ï¼ˆæ–°å¢æ–‡æ¡£ç­‰ï¼‰
PUT    - åˆ›å»ºæˆ–æ›´æ–°ï¼ˆç´¢å¼•ã€æ–‡æ¡£ç­‰ï¼‰
DELETE - åˆ é™¤æ•°æ®ï¼ˆåˆ é™¤ç´¢å¼•ã€æ–‡æ¡£ç­‰ï¼‰
HEAD   - æ£€æŸ¥æ˜¯å¦å­˜åœ¨ï¼ˆä¸è¿”å›å†…å®¹ï¼‰
```

### 3.2 APIè·¯å¾„è§„åˆ™


**è·¯å¾„ç»„æˆè§„å¾‹**ï¼š
```
åŸºæœ¬æ ¼å¼ï¼š/{ç´¢å¼•åç§°}/{ç±»å‹}/{æ–‡æ¡£ID}

ç°ä»£æ ¼å¼ï¼ˆES 7.x+ï¼‰ï¼š/{ç´¢å¼•åç§°}/_doc/{æ–‡æ¡£ID}

ç¤ºä¾‹è¯´æ˜ï¼š
/users/_doc/1     â†’ usersç´¢å¼•ä¸­IDä¸º1çš„æ–‡æ¡£
/logs-*/_search   â†’ æ‰€æœ‰logså¼€å¤´çš„ç´¢å¼•ä¸­æœç´¢
/_cluster/health  â†’ é›†ç¾¤çº§åˆ«çš„å¥åº·æ£€æŸ¥
```

### 3.3 å‚æ•°ä¼ é€’æ–¹å¼


**URLå‚æ•°**ï¼š
```json
# åœ¨è·¯å¾„åç”¨?æ·»åŠ å‚æ•°ï¼Œå¤šä¸ªå‚æ•°ç”¨&è¿æ¥
GET _cat/indices?v&h=index,docs.count&s=docs.count:desc

å‚æ•°è¯´æ˜ï¼š
v        - æ˜¾ç¤ºåˆ—æ ‡é¢˜
h        - æŒ‡å®šæ˜¾ç¤ºçš„åˆ—
s        - æ’åºæ–¹å¼
```

**è¯·æ±‚ä½“å‚æ•°**ï¼š
```json
# å¤æ‚å‚æ•°ç”¨JSONæ ¼å¼åœ¨è¯·æ±‚ä½“ä¸­ä¼ é€’
POST _search
{
  "query": {
    "match": {
      "title": "elasticsearch"
    }
  },
  "size": 10
}
```

### 3.4 å“åº”ç»“æœè§£è¯»


**æˆåŠŸå“åº”ç¤ºä¾‹**ï¼š
```json
{
  "took": 30,                    // æ‰§è¡Œè€—æ—¶ï¼ˆæ¯«ç§’ï¼‰
  "timed_out": false,           // æ˜¯å¦è¶…æ—¶
  "hits": {
    "total": {
      "value": 100,             // åŒ¹é…æ€»æ•°
      "relation": "eq"          // ç²¾ç¡®åŒ¹é…
    },
    "hits": [...]              // å…·ä½“ç»“æœ
  }
}
```

**é”™è¯¯å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "error": {
    "type": "index_not_found_exception",
    "reason": "no such index [nonexistent]"
  },
  "status": 404
}
```

> ğŸ’¡ **æ–°æ‰‹æç¤º**ï¼šçœ‹åˆ°é”™è¯¯ä¸è¦æ…Œï¼Œerrorå­—æ®µé‡Œçš„reasoné€šå¸¸ç”¨ç®€å•è‹±æ–‡è¯´æ˜äº†é—®é¢˜æ‰€åœ¨

---

## 4. ğŸ“‹ ç´¢å¼•æ“ä½œAPIå®æˆ˜


### 4.1 ç´¢å¼•çš„åˆ›å»ºä¸é…ç½®


**åˆ›å»ºæœ€ç®€å•çš„ç´¢å¼•**ï¼š
```json
# åˆ›å»ºä¸€ä¸ªç©ºç´¢å¼•ï¼ˆç³»ç»Ÿè‡ªåŠ¨é…ç½®ï¼‰
PUT my_first_index

# å“åº”ç¤ºä¾‹ï¼š
{
  "acknowledged": true,
  "shards_acknowledged": true,
  "index": "my_first_index"
}
```

**åˆ›å»ºå¸¦é…ç½®çš„ç´¢å¼•**ï¼š
```json
PUT my_blog_index
{
  "settings": {
    "number_of_shards": 3,      // åˆ†ç‰‡æ•°é‡
    "number_of_replicas": 1     // å‰¯æœ¬æ•°é‡
  },
  "mappings": {
    "properties": {
      "title": {
        "type": "text",         // å…¨æ–‡æœç´¢å­—æ®µ
        "analyzer": "standard"
      },
      "publish_date": {
        "type": "date"          // æ—¥æœŸå­—æ®µ
      },
      "author": {
        "type": "keyword"       // ç²¾ç¡®åŒ¹é…å­—æ®µ
      }
    }
  }
}
```

> ğŸ§  **ç†è§£è¦ç‚¹**ï¼š
> - `text`ç±»å‹é€‚åˆæœç´¢ï¼Œä¼šè¢«åˆ†è¯
> - `keyword`ç±»å‹é€‚åˆè¿‡æ»¤å’Œèšåˆï¼Œä¸åˆ†è¯
> - `date`ç±»å‹è‡ªåŠ¨å¤„ç†æ—¥æœŸæ ¼å¼

### 4.2 ç´¢å¼•ä¿¡æ¯æŸ¥è¯¢


**æŸ¥çœ‹æ‰€æœ‰ç´¢å¼•**ï¼š
```json
GET _cat/indices?v

# è¾“å‡ºç¤ºä¾‹ï¼š
health status index         pri rep docs.count store.size
green  open   my_blog_index  3   1       1000     50.2mb
yellow open   test_index     1   1        100     10.1mb
```

**æŸ¥çœ‹ç‰¹å®šç´¢å¼•è¯¦æƒ…**ï¼š
```json
# æŸ¥çœ‹ç´¢å¼•è®¾ç½®
GET my_blog_index/_settings

# æŸ¥çœ‹ç´¢å¼•æ˜ å°„
GET my_blog_index/_mappings

# æŸ¥çœ‹ç´¢å¼•ç»Ÿè®¡ä¿¡æ¯
GET my_blog_index/_stats
```

### 4.3 ç´¢å¼•çš„ä¿®æ”¹ä¸åˆ é™¤


**ä¿®æ”¹ç´¢å¼•è®¾ç½®**ï¼š
```json
# ä¿®æ”¹å‰¯æœ¬æ•°é‡ï¼ˆå¯ä»¥åŠ¨æ€ä¿®æ”¹ï¼‰
PUT my_blog_index/_settings
{
  "number_of_replicas": 2
}

# æ³¨æ„ï¼šåˆ†ç‰‡æ•°é‡åˆ›å»ºåä¸èƒ½ä¿®æ”¹ï¼
```

**åˆ é™¤ç´¢å¼•**ï¼š
```json
# åˆ é™¤å•ä¸ªç´¢å¼•
DELETE my_blog_index

# åˆ é™¤å¤šä¸ªç´¢å¼•ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰
DELETE index1,index2,index3

# æ‰¹é‡åˆ é™¤ï¼ˆç”¨é€šé…ç¬¦ï¼Œè¦å°å¿ƒï¼ï¼‰
DELETE test_*
```

> âš ï¸ **é‡è¦æé†’**ï¼šåˆ é™¤ç´¢å¼•æ˜¯ä¸å¯é€†æ“ä½œï¼Œæ•°æ®ä¼šæ°¸ä¹…ä¸¢å¤±ï¼ç”Ÿäº§ç¯å¢ƒä¸­è¦æ ¼å¤–å°å¿ƒã€‚

### 4.4 ç´¢å¼•æ¨¡æ¿ä½¿ç”¨


**ä»€ä¹ˆæ˜¯ç´¢å¼•æ¨¡æ¿**ï¼š
ç´¢å¼•æ¨¡æ¿å°±åƒæ˜¯ä¸€ä¸ª**è£…ä¿®æ ·æ¿é—´**ï¼Œæ–°å»ºç´¢å¼•æ—¶è‡ªåŠ¨æŒ‰ç…§æ¨¡æ¿è¿›è¡Œé…ç½®ã€‚

**åˆ›å»ºç´¢å¼•æ¨¡æ¿**ï¼š
```json
PUT _index_template/logs_template
{
  "index_patterns": ["logs-*"],  // åŒ¹é…ä»¥logs-å¼€å¤´çš„ç´¢å¼•
  "template": {
    "settings": {
      "number_of_shards": 1,
      "number_of_replicas": 1
    },
    "mappings": {
      "properties": {
        "timestamp": {"type": "date"},
        "level": {"type": "keyword"},
        "message": {"type": "text"}
      }
    }
  }
}
```

**æµ‹è¯•æ¨¡æ¿æ•ˆæœ**ï¼š
```json
# åˆ›å»ºåŒ¹é…æ¨¡æ¿çš„ç´¢å¼•
PUT logs-2024-01-01

# æŸ¥çœ‹æ˜¯å¦åº”ç”¨äº†æ¨¡æ¿é…ç½®
GET logs-2024-01-01/_mappings
```

---

## 5. ğŸ” æŸ¥è¯¢APIæµ‹è¯•ä¸ä¼˜åŒ–


### 5.1 åŸºç¡€æŸ¥è¯¢ç±»å‹


**å…¨åŒ¹é…æŸ¥è¯¢**ï¼š
```json
# æŸ¥è¯¢æ‰€æœ‰æ–‡æ¡£
GET my_blog_index/_search
{
  "query": {
    "match_all": {}
  }
}
```

**å…³é”®è¯æœç´¢**ï¼š
```json
# åœ¨titleå­—æ®µä¸­æœç´¢åŒ…å«"elasticsearch"çš„æ–‡æ¡£
GET my_blog_index/_search
{
  "query": {
    "match": {
      "title": "elasticsearch tutorial"
    }
  }
}
```

**ç²¾ç¡®åŒ¹é…**ï¼š
```json
# ç²¾ç¡®åŒ¹é…ä½œè€…
GET my_blog_index/_search
{
  "query": {
    "term": {
      "author": "å¼ ä¸‰"
    }
  }
}
```

### 5.2 å¤åˆæŸ¥è¯¢æ„å»º


**å¸ƒå°”æŸ¥è¯¢ï¼ˆæœ€å¸¸ç”¨ï¼‰**ï¼š
```json
GET my_blog_index/_search
{
  "query": {
    "bool": {
      "must": [                    // å¿…é¡»æ»¡è¶³ï¼ˆANDï¼‰
        {"match": {"title": "elasticsearch"}}
      ],
      "must_not": [               // å¿…é¡»ä¸æ»¡è¶³ï¼ˆNOTï¼‰
        {"term": {"status": "draft"}}
      ],
      "should": [                 // å¯ä»¥æ»¡è¶³ï¼ˆORï¼Œæé«˜è¯„åˆ†ï¼‰
        {"match": {"tags": "tutorial"}}
      ],
      "filter": [                 // è¿‡æ»¤æ¡ä»¶ï¼ˆä¸å½±å“è¯„åˆ†ï¼‰
        {"range": {"publish_date": {"gte": "2024-01-01"}}}
      ]
    }
  }
}
```

> ğŸ§  **è®°å¿†æŠ€å·§**ï¼š
> - `must` = å¿…é¡»æ»¡è¶³ï¼Œåƒ"AND"
> - `must_not` = å¿…é¡»ä¸æ»¡è¶³ï¼Œåƒ"NOT"  
> - `should` = æœ€å¥½æ»¡è¶³ï¼Œåƒ"OR"
> - `filter` = è¿‡æ»¤æ¡ä»¶ï¼Œä¸æ‰“åˆ†ä½†æé«˜æ€§èƒ½

**èŒƒå›´æŸ¥è¯¢**ï¼š
```json
GET my_blog_index/_search
{
  "query": {
    "range": {
      "publish_date": {
        "gte": "2024-01-01",      // å¤§äºç­‰äº
        "lte": "2024-12-31",      // å°äºç­‰äº
        "format": "yyyy-MM-dd"
      }
    }
  }
}
```

### 5.3 æŸ¥è¯¢ç»“æœæ§åˆ¶


**åˆ†é¡µæ§åˆ¶**ï¼š
```json
GET my_blog_index/_search
{
  "from": 0,           // ä»ç¬¬å‡ æ¡å¼€å§‹ï¼ˆ0å¼€å§‹è®¡æ•°ï¼‰
  "size": 10,          // è¿”å›å¤šå°‘æ¡
  "query": {
    "match_all": {}
  }
}
```

**å­—æ®µé€‰æ‹©**ï¼š
```json
GET my_blog_index/_search
{
  "_source": ["title", "author", "publish_date"],  // åªè¿”å›æŒ‡å®šå­—æ®µ
  "query": {
    "match_all": {}
  }
}
```

**æ’åºè®¾ç½®**ï¼š
```json
GET my_blog_index/_search
{
  "sort": [
    {"publish_date": {"order": "desc"}},  // æŒ‰å‘å¸ƒæ—¥æœŸé™åº
    {"_score": {"order": "desc"}}         // å†æŒ‰ç›¸å…³æ€§è¯„åˆ†é™åº
  ],
  "query": {
    "match": {"title": "elasticsearch"}
  }
}
```

### 5.4 æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–


**ä½¿ç”¨filterè€Œä¸æ˜¯query**ï¼š
```json
# ğŸ”´ æ€§èƒ½è¾ƒå·®ï¼ˆä¼šè®¡ç®—è¯„åˆ†ï¼‰
GET my_blog_index/_search
{
  "query": {
    "range": {
      "publish_date": {"gte": "2024-01-01"}
    }
  }
}

# âœ… æ€§èƒ½æ›´å¥½ï¼ˆä¸è®¡ç®—è¯„åˆ†ï¼Œå¯ç¼“å­˜ï¼‰
GET my_blog_index/_search
{
  "query": {
    "bool": {
      "filter": [
        {"range": {"publish_date": {"gte": "2024-01-01"}}}
      ]
    }
  }
}
```

**æŸ¥è¯¢æ€§èƒ½åˆ†æ**ï¼š
```json
# ä½¿ç”¨profileåˆ†ææŸ¥è¯¢æ€§èƒ½
GET my_blog_index/_search
{
  "profile": true,
  "query": {
    "match": {"title": "elasticsearch"}
  }
}
```

---

## 6. ğŸ“Š èšåˆAPIæ·±åº¦åº”ç”¨


### 6.1 èšåˆçš„åŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯èšåˆ**ï¼š
èšåˆå°±åƒExcelä¸­çš„**æ•°æ®é€è§†è¡¨**ï¼Œå¯ä»¥å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ã€ç»Ÿè®¡ã€è®¡ç®—ã€‚

**èšåˆçš„ç±»å‹**ï¼š
```
ğŸ“Š æŒ‡æ ‡èšåˆï¼ˆMetricsï¼‰ï¼šè®¡ç®—æ•°å€¼ï¼ˆæ±‚å’Œã€å¹³å‡å€¼ã€æœ€å¤§å€¼ç­‰ï¼‰
ğŸ—‚ï¸ æ¡¶èšåˆï¼ˆBucketsï¼‰ï¼šæ•°æ®åˆ†ç»„ï¼ˆæŒ‰æ—¥æœŸã€æŒ‰ç±»åˆ«åˆ†ç»„ç­‰ï¼‰
ğŸ“ˆ ç®¡é“èšåˆï¼ˆPipelineï¼‰ï¼šå¯¹å…¶ä»–èšåˆç»“æœå†è¿›è¡Œè®¡ç®—
```

### 6.2 å¸¸ç”¨æŒ‡æ ‡èšåˆ


**æ•°å€¼ç»Ÿè®¡**ï¼š
```json
GET sales_index/_search
{
  "size": 0,              // ä¸è¿”å›æ–‡æ¡£ï¼Œåªè¦èšåˆç»“æœ
  "aggs": {
    "total_sales": {
      "sum": {"field": "amount"}           // æ€»é”€å”®é¢
    },
    "avg_sales": {
      "avg": {"field": "amount"}           // å¹³å‡é”€å”®é¢
    },
    "max_sales": {
      "max": {"field": "amount"}           // æœ€å¤§å•ç¬”é”€å”®
    },
    "sales_stats": {
      "stats": {"field": "amount"}         // ä¸€æ¬¡æ€§è·å–å¤šç§ç»Ÿè®¡
    }
  }
}
```

**ç»“æœç¤ºä¾‹**ï¼š
```json
{
  "aggregations": {
    "total_sales": {"value": 150000},
    "avg_sales": {"value": 1500},
    "max_sales": {"value": 5000},
    "sales_stats": {
      "count": 100,
      "min": 50,
      "max": 5000,
      "avg": 1500,
      "sum": 150000
    }
  }
}
```

### 6.3 æ¡¶èšåˆåº”ç”¨


**æŒ‰ç±»åˆ«åˆ†ç»„**ï¼š
```json
GET sales_index/_search
{
  "size": 0,
  "aggs": {
    "sales_by_category": {
      "terms": {
        "field": "category",    // æŒ‰å•†å“ç±»åˆ«åˆ†ç»„
        "size": 10             // è¿”å›å‰10ä¸ªç±»åˆ«
      }
    }
  }
}
```

**æŒ‰æ—¶é—´åˆ†ç»„ï¼ˆæœ€å¸¸ç”¨ï¼‰**ï¼š
```json
GET sales_index/_search
{
  "size": 0,
  "aggs": {
    "sales_over_time": {
      "date_histogram": {
        "field": "sale_date",
        "calendar_interval": "month",    // æŒ‰æœˆåˆ†ç»„
        "format": "yyyy-MM"
      }
    }
  }
}
```

**æ•°å€¼èŒƒå›´åˆ†ç»„**ï¼š
```json
GET sales_index/_search
{
  "size": 0,
  "aggs": {
    "price_ranges": {
      "range": {
        "field": "amount",
        "ranges": [
          {"to": 100},                    // 0-100
          {"from": 100, "to": 500},       // 100-500
          {"from": 500}                   // 500ä»¥ä¸Š
        ]
      }
    }
  }
}
```

### 6.4 åµŒå¥—èšåˆåˆ†æ


**ç»„åˆèšåˆç¤ºä¾‹**ï¼š
```json
GET sales_index/_search
{
  "size": 0,
  "aggs": {
    "categories": {
      "terms": {"field": "category"},    // å¤–å±‚ï¼šæŒ‰ç±»åˆ«åˆ†ç»„
      "aggs": {
        "monthly_sales": {
          "date_histogram": {             // å†…å±‚ï¼šæ¯ä¸ªç±»åˆ«æŒ‰æœˆåˆ†ç»„
            "field": "sale_date",
            "calendar_interval": "month"
          },
          "aggs": {
            "total_amount": {
              "sum": {"field": "amount"}  // æœ€å†…å±‚ï¼šè®¡ç®—æ¯æœˆæ¯ç±»åˆ«çš„æ€»é¢
            }
          }
        }
      }
    }
  }
}
```

> ğŸ’¡ **ç†è§£åµŒå¥—èšåˆ**ï¼š
> å°±åƒä¿„ç½—æ–¯å¥—å¨ƒï¼Œå¤–å±‚èšåˆçš„æ¯ä¸ªç»“æœéƒ½ä¼šæ‰§è¡Œå†…å±‚èšåˆ
> ä¸Šé¢çš„ä¾‹å­ä¼šå¾—åˆ°ï¼šæ¯ä¸ªå•†å“ç±»åˆ« â†’ æ¯ä¸ªæœˆ â†’ è¯¥æœˆè¯¥ç±»åˆ«çš„é”€å”®æ€»é¢

---

## 7. ğŸ—ºï¸ æ˜ å°„APIæ“ä½œæŒ‡å—


### 7.1 æ˜ å°„çš„åŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯æ˜ å°„(Mapping)**ï¼š
æ˜ å°„å°±åƒæ•°æ®åº“çš„**è¡¨ç»“æ„å®šä¹‰**ï¼Œå‘Šè¯‰Elasticsearchæ¯ä¸ªå­—æ®µæ˜¯ä»€ä¹ˆç±»å‹ã€å¦‚ä½•å¤„ç†ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦æ˜ å°„**ï¼š
```
æ²¡æœ‰æ˜ å°„ = Elasticsearchè‡ªåŠ¨çŒœæµ‹å­—æ®µç±»å‹
æœ‰æ˜ å°„ = æ˜ç¡®å®šä¹‰ï¼Œé¿å…é—®é¢˜

ç±»æ¯”ï¼š
æ²¡æœ‰æ˜ å°„ = è®©ç³»ç»ŸçŒœä½ æƒ³è¦ä»€ä¹ˆ
æœ‰æ˜ å°„ = æ˜ç¡®å‘Šè¯‰ç³»ç»Ÿä½ çš„éœ€æ±‚
```

### 7.2 å¸¸ç”¨å­—æ®µç±»å‹


**æ–‡æœ¬ç±»å‹å¯¹æ¯”**ï¼š
```json
{
  "properties": {
    "title": {
      "type": "text",           // å…¨æ–‡æœç´¢ï¼Œä¼šåˆ†è¯
      "analyzer": "standard"    // æŒ‡å®šåˆ†è¯å™¨
    },
    "status": {
      "type": "keyword"         // ç²¾ç¡®åŒ¹é…ï¼Œä¸åˆ†è¯
    }
  }
}
```

**æ•°å­—å’Œæ—¥æœŸç±»å‹**ï¼š
```json
{
  "properties": {
    "price": {
      "type": "double"          // æµ®ç‚¹æ•°
    },
    "quantity": {
      "type": "integer"         // æ•´æ•°
    },
    "created_at": {
      "type": "date",           // æ—¥æœŸ
      "format": "yyyy-MM-dd HH:mm:ss"
    }
  }
}
```

**å¤æ‚ç±»å‹**ï¼š
```json
{
  "properties": {
    "location": {
      "type": "geo_point"       // åœ°ç†ä½ç½®ç‚¹
    },
    "tags": {
      "type": "keyword"         // æ•°ç»„ï¼ˆå¤šä¸ªå€¼ï¼‰
    },
    "user": {
      "type": "object",         // åµŒå¥—å¯¹è±¡
      "properties": {
        "name": {"type": "text"},
        "age": {"type": "integer"}
      }
    }
  }
}
```

### 7.3 åŠ¨æ€æ˜ å°„æ§åˆ¶


**æŸ¥çœ‹å½“å‰æ˜ å°„**ï¼š
```json
GET my_index/_mapping
```

**æ›´æ–°æ˜ å°„ï¼ˆæ·»åŠ å­—æ®µï¼‰**ï¼š
```json
PUT my_index/_mapping
{
  "properties": {
    "new_field": {
      "type": "keyword"
    }
  }
}
```

> âš ï¸ **æ˜ å°„é™åˆ¶**ï¼šå·²å­˜åœ¨å­—æ®µçš„ç±»å‹ä¸èƒ½ä¿®æ”¹ï¼Œåªèƒ½æ·»åŠ æ–°å­—æ®µ

**åŠ¨æ€æ˜ å°„è®¾ç½®**ï¼š
```json
PUT my_strict_index
{
  "mappings": {
    "dynamic": "strict",        // ä¸¥æ ¼æ¨¡å¼ï¼šä¸å…è®¸æ–°å­—æ®µ
    "properties": {
      "title": {"type": "text"},
      "author": {"type": "keyword"}
    }
  }
}

# dynamicé€‰é¡¹ï¼š
# trueï¼ˆé»˜è®¤ï¼‰: è‡ªåŠ¨æ·»åŠ æ–°å­—æ®µ
# false: å¿½ç•¥æ–°å­—æ®µï¼Œä½†ä¸æŠ¥é”™
# strict: é‡åˆ°æ–°å­—æ®µå°±æŠ¥é”™
```

### 7.4 åˆ†è¯å™¨é…ç½®


**è®¾ç½®ä¸­æ–‡åˆ†è¯å™¨**ï¼š
```json
PUT chinese_blog_index
{
  "settings": {
    "analysis": {
      "analyzer": {
        "my_chinese_analyzer": {
          "type": "custom",
          "tokenizer": "ik_max_word",     // ä½¿ç”¨IKåˆ†è¯å™¨
          "filter": ["lowercase"]
        }
      }
    }
  },
  "mappings": {
    "properties": {
      "title": {
        "type": "text",
        "analyzer": "my_chinese_analyzer"
      }
    }
  }
}
```

**æµ‹è¯•åˆ†è¯æ•ˆæœ**ï¼š
```json
GET chinese_blog_index/_analyze
{
  "analyzer": "my_chinese_analyzer",
  "text": "Elasticsearchä¸­æ–‡åˆ†è¯æµ‹è¯•"
}
```

---

## 8. âš¡ æ‰¹é‡æ“ä½œè„šæœ¬ç¼–å†™


### 8.1 æ‰¹é‡æ“ä½œçš„é‡è¦æ€§


**ä¸ºä»€ä¹ˆéœ€è¦æ‰¹é‡æ“ä½œ**ï¼š
```
å•æ¡æ“ä½œ = ä¸€æ¬¡è¯·æ±‚å¤„ç†ä¸€æ¡æ•°æ®
æ‰¹é‡æ“ä½œ = ä¸€æ¬¡è¯·æ±‚å¤„ç†å¤šæ¡æ•°æ®

æ•ˆç‡å¯¹æ¯”ï¼š
å•æ¡ï¼š1000æ¡æ•°æ® = 1000æ¬¡è¯·æ±‚ = å¾ˆæ…¢
æ‰¹é‡ï¼š1000æ¡æ•°æ® = 10æ¬¡è¯·æ±‚ = å¾ˆå¿«
```

### 8.2 bulk APIåŸºç¡€


**bulkæ“ä½œæ ¼å¼**ï¼š
```json
POST _bulk
{"index": {"_index": "my_index", "_id": "1"}}
{"title": "ç¬¬ä¸€ç¯‡æ–‡ç« ", "author": "å¼ ä¸‰"}
{"index": {"_index": "my_index", "_id": "2"}}
{"title": "ç¬¬äºŒç¯‡æ–‡ç« ", "author": "æå››"}
{"update": {"_index": "my_index", "_id": "1"}}
{"doc": {"views": 100}}
{"delete": {"_index": "my_index", "_id": "3"}}
```

> ğŸ“‹ **æ ¼å¼è¯´æ˜**ï¼š
> - æ¯ä¸¤è¡Œä¸ºä¸€ç»„ï¼šç¬¬ä¸€è¡Œæ˜¯æ“ä½œä¿¡æ¯ï¼Œç¬¬äºŒè¡Œæ˜¯æ•°æ®
> - deleteæ“ä½œåªéœ€è¦ä¸€è¡Œï¼ˆæ²¡æœ‰æ•°æ®ï¼‰
> - æ¯è¡Œéƒ½å¿…é¡»æ˜¯å®Œæ•´çš„JSONï¼Œä¸èƒ½æ ¼å¼åŒ–

### 8.3 å¸¸ç”¨æ‰¹é‡æ“ä½œ


**æ‰¹é‡åˆ›å»ºæ–‡æ¡£**ï¼š
```json
POST my_blog_index/_bulk
{"index": {"_id": "1"}}
{"title": "Elasticsearchå…¥é—¨", "author": "å¼ ä¸‰", "publish_date": "2024-01-01"}
{"index": {"_id": "2"}}
{"title": "Kibanaå¯è§†åŒ–", "author": "æå››", "publish_date": "2024-01-02"}
{"index": {"_id": "3"}}
{"title": "Logstashæ•°æ®å¤„ç†", "author": "ç‹äº”", "publish_date": "2024-01-03"}
```

**æ‰¹é‡æ›´æ–°æ–‡æ¡£**ï¼š
```json
POST my_blog_index/_bulk
{"update": {"_id": "1"}}
{"doc": {"views": 150, "likes": 20}}
{"update": {"_id": "2"}}
{"doc": {"views": 89, "likes": 15}}
{"update": {"_id": "3"}}
{"doc": {"views": 234, "likes": 45}}
```

**æ··åˆæ‰¹é‡æ“ä½œ**ï¼š
```json
POST my_blog_index/_bulk
{"index": {"_id": "4"}}
{"title": "æ–°æ–‡ç« ", "author": "èµµå…­"}
{"update": {"_id": "1"}}
{"doc": {"tags": ["elasticsearch", "search"]}}
{"delete": {"_id": "old_doc"}}
```

### 8.4 æ‰¹é‡æ“ä½œæœ€ä½³å®è·µ


**æ‰¹é‡å¤§å°æ§åˆ¶**ï¼š
```json
# æ¨èçš„æ‰¹é‡å¤§å°
å•æ¬¡æ‰¹é‡ï¼š100-1000æ¡è®°å½•
æ•°æ®å¤§å°ï¼š5-15MB
å…·ä½“æ ¹æ®æ–‡æ¡£å¤§å°è°ƒæ•´

# ç›‘æ§æ‰¹é‡æ“ä½œæ€§èƒ½
POST _bulk
{...bulk data...}

# å“åº”ä¼šæ˜¾ç¤ºæ¯æ¡æ“ä½œçš„ç»“æœ
{
  "took": 30,
  "errors": false,
  "items": [
    {"index": {"_id": "1", "result": "created"}},
    {"update": {"_id": "2", "result": "updated"}}
  ]
}
```

**é”™è¯¯å¤„ç†**ï¼š
```json
# æ‰¹é‡æ“ä½œä¸­æŸæ¡å¤±è´¥ä¸ä¼šå½±å“å…¶ä»–æ“ä½œ
{
  "took": 25,
  "errors": true,        // æœ‰é”™è¯¯å‘ç”Ÿ
  "items": [
    {"index": {"_id": "1", "result": "created"}},
    {"index": {
      "_id": "2",
      "error": {
        "type": "version_conflict_engine_exception",
        "reason": "version conflict"
      }
    }}
  ]
}
```

### 8.5 å®ç”¨æ‰¹é‡è„šæœ¬æ¨¡æ¿


**ä»CSVæ–‡ä»¶æ‰¹é‡å¯¼å…¥çš„é€»è¾‘**ï¼š
```json
# æ­¥éª¤1ï¼šå‡†å¤‡ç´¢å¼•
PUT products_index
{
  "mappings": {
    "properties": {
      "name": {"type": "text"},
      "price": {"type": "double"},
      "category": {"type": "keyword"}
    }
  }
}

# æ­¥éª¤2ï¼šæ‰¹é‡å¯¼å…¥æ•°æ®
POST products_index/_bulk
{"index": {"_id": "P001"}}
{"name": "è‹¹æœæ‰‹æœº", "price": 6999.00, "category": "ç”µå­äº§å“"}
{"index": {"_id": "P002"}}
{"name": "åä¸ºç¬”è®°æœ¬", "price": 5999.00, "category": "ç”µå­äº§å“"}
# ...æ›´å¤šäº§å“æ•°æ®
```

---

## 9. ğŸ“ˆ APIå“åº”åˆ†ææŠ€å·§


### 9.1 å“åº”ç»“æ„è§£è¯»


**æ ‡å‡†æœç´¢å“åº”**ï¼š
```json
{
  "took": 5,                    // ğŸ• æ‰§è¡Œè€—æ—¶ï¼ˆæ¯«ç§’ï¼‰
  "timed_out": false,           // â° æ˜¯å¦è¶…æ—¶
  "_shards": {                  // ğŸ” åˆ†ç‰‡æ‰§è¡Œæƒ…å†µ
    "total": 3,                 // æ€»åˆ†ç‰‡æ•°
    "successful": 3,            // æˆåŠŸçš„åˆ†ç‰‡æ•°
    "skipped": 0,               // è·³è¿‡çš„åˆ†ç‰‡æ•°
    "failed": 0                 // å¤±è´¥çš„åˆ†ç‰‡æ•°
  },
  "hits": {
    "total": {
      "value": 1000,            // ğŸ“Š åŒ¹é…çš„æ–‡æ¡£æ€»æ•°
      "relation": "eq"          // è®¡æ•°å…³ç³»ï¼ˆeq=ç²¾ç¡®ï¼Œgte=å¤§äºç­‰äºï¼‰
    },
    "max_score": 1.2345,        // ğŸ¯ æœ€é«˜ç›¸å…³æ€§è¯„åˆ†
    "hits": [...]               // ğŸ“„ å…·ä½“çš„æœç´¢ç»“æœ
  }
}
```

### 9.2 æ€§èƒ½æŒ‡æ ‡åˆ†æ


**æ‰§è¡Œæ—¶é—´åˆ†æ**ï¼š
```
took < 100ms    âœ… å¾ˆå¿«ï¼Œç”¨æˆ·æ„Ÿè§‰å³æ—¶
took < 500ms    âœ… è¾ƒå¿«ï¼Œç”¨æˆ·å¯æ¥å—
took < 1000ms   âš ï¸ æœ‰ç‚¹æ…¢ï¼Œéœ€è¦ä¼˜åŒ–
took > 1000ms   ğŸ”´ å¤ªæ…¢ï¼Œç”¨æˆ·ä½“éªŒå·®
```

**åˆ†ç‰‡çŠ¶æ€æ£€æŸ¥**ï¼š
```json
# å¥åº·çš„å“åº”
"_shards": {
  "total": 3,
  "successful": 3,      // âœ… æ‰€æœ‰åˆ†ç‰‡éƒ½æˆåŠŸ
  "failed": 0
}

# æœ‰é—®é¢˜çš„å“åº”
"_shards": {
  "total": 5,
  "successful": 3,      // âš ï¸ æœ‰2ä¸ªåˆ†ç‰‡å¤±è´¥
  "failed": 2,
  "failures": [...]     // æŸ¥çœ‹å¤±è´¥åŸå› 
}
```

### 9.3 é”™è¯¯ä¿¡æ¯åˆ†æ


**å¸¸è§é”™è¯¯ç±»å‹**ï¼š

| é”™è¯¯çŠ¶æ€ç  | **é”™è¯¯åŸå› ** | **è§£å†³æ–¹æ³•** |
|-----------|-------------|-------------|
| `400` | è¯·æ±‚æ ¼å¼é”™è¯¯ | æ£€æŸ¥JSONè¯­æ³•ï¼ŒAPIå‚æ•° |
| `404` | ç´¢å¼•/æ–‡æ¡£ä¸å­˜åœ¨ | ç¡®è®¤ç´¢å¼•åç§°ï¼Œæ£€æŸ¥æ–‡æ¡£ID |
| `409` | ç‰ˆæœ¬å†²çª | å¤„ç†å¹¶å‘æ›´æ–°å†²çª |
| `429` | è¯·æ±‚è¿‡äºé¢‘ç¹ | é™ä½è¯·æ±‚é¢‘ç‡ï¼Œå¢åŠ å»¶è¿Ÿ |

**é”™è¯¯ä¿¡æ¯ç¤ºä¾‹**ï¼š
```json
{
  "error": {
    "type": "parsing_exception",
    "reason": "Unknown key for a START_OBJECT in [query].",
    "line": 3,
    "col": 15
  }
}
```

> ğŸ’¡ **è°ƒè¯•æŠ€å·§**ï¼š
> - ä»”ç»†é˜…è¯»`reason`å­—æ®µï¼Œé€šå¸¸æœ‰æ˜ç¡®çš„é”™è¯¯æè¿°
> - æ³¨æ„`line`å’Œ`col`å­—æ®µï¼ŒæŒ‡ç¤ºé”™è¯¯ä½ç½®
> - å¤æ‚æŸ¥è¯¢å‡ºé”™æ—¶ï¼Œå…ˆç®€åŒ–æŸ¥è¯¢å®šä½é—®é¢˜

### 9.4 ç»“æœè´¨é‡è¯„ä¼°


**ç›¸å…³æ€§è¯„åˆ†ç†è§£**ï¼š
```json
{
  "hits": [
    {
      "_score": 2.5,        // é«˜åˆ† = æ›´ç›¸å…³
      "_source": {...}
    },
    {
      "_score": 1.8,        // ä½åˆ† = ç›¸å…³æ€§è¾ƒä½  
      "_source": {...}
    }
  ]
}
```

**ç»“æœå®Œæ•´æ€§æ£€æŸ¥**ï¼š
```json
{
  "hits": {
    "total": {
      "value": 10000,
      "relation": "gte"     // âš ï¸ å®é™…å¯èƒ½è¶…è¿‡10000æ¡
    }
  }
}

# relationçš„å«ä¹‰ï¼š
# "eq" = ç²¾ç¡®è®¡æ•°
# "gte" = å¤§äºç­‰äºï¼ˆESé»˜è®¤æœ€å¤šè®¡ç®—10000æ¡ï¼‰
```

### 9.5 èšåˆç»“æœåˆ†æ


**èšåˆå“åº”ç»“æ„**ï¼š
```json
{
  "aggregations": {
    "categories": {
      "buckets": [
        {
          "key": "electronics",     // åˆ†ç»„é”®å€¼
          "doc_count": 1500,        // è¯¥ç»„æ–‡æ¡£æ•°é‡
          "avg_price": {            // åµŒå¥—èšåˆç»“æœ
            "value": 299.99
          }
        }
      ]
    }
  }
}
```

**æ•°æ®è´¨é‡æ£€æŸ¥**ï¼š
```json
# æ£€æŸ¥èšåˆçš„å‡†ç¡®æ€§
"aggregations": {
  "categories": {
    "doc_count_error_upper_bound": 0,    // è®¡æ•°è¯¯å·®ä¸Šç•Œ
    "sum_other_doc_count": 50,           // æœªæ˜¾ç¤ºçš„å…¶ä»–ç»„çš„æ–‡æ¡£æ•°
    "buckets": [...]
  }
}
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”§ Consoleå·¥å…·ï¼šElasticsearchçš„"èŠå¤©çª—å£"
ğŸŒ APIè°ƒè¯•ï¼šç›´æ¥ä¸Elasticsearchå¯¹è¯çš„æ–¹å¼
ğŸ“Š ç´¢å¼•æ“ä½œï¼šæ•°æ®å®¹å™¨çš„åˆ›å»ºã€é…ç½®ã€ç®¡ç†
ğŸ” æŸ¥è¯¢APIï¼šæ•°æ®æ£€ç´¢çš„æ ¸å¿ƒæŠ€èƒ½
ğŸ“ˆ èšåˆåˆ†æï¼šæ•°æ®ç»Ÿè®¡å’Œåˆ†æçš„åˆ©å™¨
ğŸ—ºï¸ æ˜ å°„ç®¡ç†ï¼šå­—æ®µç±»å‹å’Œç»“æ„çš„å®šä¹‰
âš¡ æ‰¹é‡æ“ä½œï¼šé«˜æ•ˆæ•°æ®å¤„ç†çš„å¿…å¤‡æŠ€èƒ½
ğŸ“‹ å“åº”åˆ†æï¼šç»“æœè§£è¯»å’Œé—®é¢˜æ’æŸ¥
```

### 10.2 å…³é”®æ“ä½œæµç¨‹


**ğŸ”¹ ä»é›¶å¼€å§‹çš„å®Œæ•´æµç¨‹**ï¼š
```
ç¬¬1æ­¥ï¼šåˆ›å»ºç´¢å¼•ï¼ˆå®šä¹‰ç»“æ„ï¼‰
ç¬¬2æ­¥ï¼šé…ç½®æ˜ å°„ï¼ˆè®¾ç½®å­—æ®µç±»å‹ï¼‰
ç¬¬3æ­¥ï¼šå¯¼å…¥æ•°æ®ï¼ˆå•æ¡æˆ–æ‰¹é‡ï¼‰
ç¬¬4æ­¥ï¼šæŸ¥è¯¢æµ‹è¯•ï¼ˆéªŒè¯æ•°æ®å’Œæœç´¢ï¼‰
ç¬¬5æ­¥ï¼šèšåˆåˆ†æï¼ˆç»Ÿè®¡å’Œæ´å¯Ÿï¼‰
ç¬¬6æ­¥ï¼šæ€§èƒ½ä¼˜åŒ–ï¼ˆåˆ†æå“åº”æ—¶é—´ï¼‰
```

**ğŸ”¹ æ—¥å¸¸ä½¿ç”¨æœ€é¢‘ç¹çš„API**ï¼š
```
GET _cat/indices        â†’ æŸ¥çœ‹æ‰€æœ‰ç´¢å¼•
GET index_name/_search  â†’ æœç´¢æ•°æ®
POST index_name/_bulk   â†’ æ‰¹é‡æ“ä½œ
GET index_name/_mapping â†’ æŸ¥çœ‹å­—æ®µç»“æ„
```

### 10.3 å®æˆ˜æœ€ä½³å®è·µ


**ğŸ“Š æŸ¥è¯¢ä¼˜åŒ–åŸåˆ™**ï¼š
- ä¼˜å…ˆä½¿ç”¨`filter`è€Œä¸æ˜¯`query`ï¼ˆå¯ç¼“å­˜ï¼Œæ›´å¿«ï¼‰
- åˆç†è®¾ç½®`size`å’Œ`from`ï¼ˆé¿å…æ·±åº¦åˆ†é¡µï¼‰
- æ˜ç¡®æŒ‡å®š`_source`å­—æ®µï¼ˆå‡å°‘ç½‘ç»œä¼ è¾“ï¼‰
- ä½¿ç”¨åˆé€‚çš„æŸ¥è¯¢ç±»å‹ï¼ˆterm vs matchï¼‰

**âš¡ æ‰¹é‡æ“ä½œå»ºè®®**ï¼š
- å•æ¬¡æ‰¹é‡100-1000æ¡è®°å½•
- æ€»å¤§å°æ§åˆ¶åœ¨5-15MBä»¥å†…
- ç›‘æ§`errors`å­—æ®µå¤„ç†å¤±è´¥æƒ…å†µ
- æ ¹æ®å“åº”æ—¶é—´è°ƒæ•´æ‰¹é‡å¤§å°

**ğŸ› ï¸ è°ƒè¯•æŠ€å·§æ€»ç»“**ï¼š
- å…ˆç”¨ç®€å•æŸ¥è¯¢æµ‹è¯•è¿æ¥æ€§
- é€æ­¥å¢åŠ æŸ¥è¯¢å¤æ‚åº¦
- ä½¿ç”¨`profile: true`åˆ†ææ€§èƒ½
- ä»”ç»†é˜…è¯»é”™è¯¯ä¿¡æ¯ä¸­çš„`reason`å­—æ®µ

### 10.4 ä»æ–°æ‰‹åˆ°ç†Ÿç»ƒçš„å­¦ä¹ è·¯å¾„


**ğŸ¯ ç¬¬ä¸€é˜¶æ®µï¼ˆå…¥é—¨ï¼‰**ï¼š
- [ ] ç†Ÿæ‚‰Consoleç•Œé¢æ“ä½œ
- [ ] æŒæ¡åŸºæœ¬çš„CRUDæ“ä½œ
- [ ] ç†è§£ç´¢å¼•ã€æ–‡æ¡£ã€å­—æ®µçš„æ¦‚å¿µ
- [ ] èƒ½å†™ç®€å•çš„matchæŸ¥è¯¢

**ğŸ¯ ç¬¬äºŒé˜¶æ®µï¼ˆè¿›é˜¶ï¼‰**ï¼š
- [ ] æŒæ¡å¤æ‚çš„boolæŸ¥è¯¢
- [ ] ç†è§£ä¸åŒå­—æ®µç±»å‹çš„åŒºåˆ«
- [ ] èƒ½è¿›è¡ŒåŸºæœ¬çš„èšåˆåˆ†æ
- [ ] å­¦ä¼šä½¿ç”¨æ‰¹é‡æ“ä½œ

**ğŸ¯ ç¬¬ä¸‰é˜¶æ®µï¼ˆç†Ÿç»ƒï¼‰**ï¼š
- [ ] èƒ½è®¾è®¡åˆç†çš„ç´¢å¼•æ˜ å°„
- [ ] æŒæ¡æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–
- [ ] ç†Ÿç»ƒè¿›è¡Œå¤æ‚èšåˆåˆ†æ
- [ ] èƒ½æ’æŸ¥å¸¸è§é—®é¢˜

> ğŸ’¡ **å­¦ä¹ å»ºè®®**ï¼š
> æ¯ä¸ªçŸ¥è¯†ç‚¹éƒ½è¦åŠ¨æ‰‹å®è·µï¼Œåœ¨Consoleä¸­å®é™…æ“ä½œæ¯”åªçœ‹ç†è®ºæ•ˆæœå¥½å¾—å¤šã€‚é‡åˆ°é—®é¢˜æ—¶ï¼Œå…ˆçœ‹å“åº”ä¸­çš„é”™è¯¯ä¿¡æ¯ï¼Œå¤§éƒ¨åˆ†é—®é¢˜éƒ½èƒ½ä»é”™è¯¯æè¿°ä¸­æ‰¾åˆ°è§£å†³æ–¹å‘ã€‚

**ğŸ”‘ æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- Consoleæ˜¯å­¦ä¹ Elasticsearchçš„æœ€ä½³å·¥å…·
- APIæ ¼å¼ï¼š`æ–¹æ³• è·¯å¾„ å‚æ•°`ï¼Œç®€å•æ¸…æ™°
- æŸ¥è¯¢å’Œè¿‡æ»¤è¦åˆ†æ¸…ï¼Œæ€§èƒ½å·®åˆ«å¾ˆå¤§  
- æ‰¹é‡æ“ä½œæ˜¯æ•ˆç‡æå‡çš„å…³é”®
- é”™è¯¯ä¿¡æ¯æ˜¯æœ€å¥½çš„è°ƒè¯•åŠ©æ‰‹
- å®è·µå‡ºçœŸçŸ¥ï¼Œå¤šåŠ¨æ‰‹å°‘ç©ºè°ˆ