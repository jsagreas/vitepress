---
title: 7、环境变量与启动参数
---
## 📚 目录

1. [环境变量基础概念](#1-环境变量基础概念)
2. [Kibana核心环境变量](#2-Kibana核心环境变量)
3. [启动参数详解](#3-启动参数详解)
4. [Java虚拟机配置](#4-Java虚拟机配置)
5. [Node.js运行时配置](#5-Nodejs运行时配置)
6. [路径与目录配置](#6-路径与目录配置)
7. [性能调优配置](#7-性能调优配置)
8. [开发调试配置](#8-开发调试配置)
9. [生产环境最佳实践](#9-生产环境最佳实践)
10. [核心要点总结](#10-核心要点总结)

---

## 1. 🌟 环境变量基础概念


### 1.1 什么是环境变量

**简单理解**：环境变量就像是给计算机程序设置的"全局设置开关"，告诉程序应该怎么运行。

```
生活中的类比：
就像空调遥控器上的设置：
- 温度设定 → 环境变量值
- 模式选择 → 环境变量名
- 开关状态 → 环境变量是否启用

程序启动时会"读取"这些设置来决定行为
```

**核心作用**：
- 🔧 **配置程序行为**：不修改代码就能改变程序运行方式
- 🔄 **环境适配**：同一个程序在不同环境(开发/测试/生产)有不同表现
- 🔒 **安全保护**：敏感信息(密码、密钥)不写死在代码里
- 📊 **运行时调整**：程序运行过程中可以动态调整某些行为

### 1.2 环境变量的设置方式


**操作系统层面设置**：
```bash
# Linux/Mac 临时设置(当前会话有效)
export KIBANA_HOST=0.0.0.0
export KIBANA_PORT=5601

# Linux/Mac 永久设置(写入配置文件)
echo 'export KIBANA_HOST=0.0.0.0' >> ~/.bashrc
source ~/.bashrc

# Windows 临时设置
set KIBANA_HOST=0.0.0.0
set KIBANA_PORT=5601

# Windows 永久设置(通过系统属性设置)
```

**启动时临时设置**：
```bash
# 只在这次启动时生效
KIBANA_PORT=5602 ./bin/kibana

# 设置多个环境变量
NODE_OPTIONS="--max-old-space-size=4096" KIBANA_PORT=5602 ./bin/kibana
```

### 1.3 环境变量的优先级


```
优先级从高到低：
1. 命令行启动时设置 → 最高优先级
2. 系统环境变量     → 中等优先级  
3. kibana.yml配置  → 较低优先级
4. 程序默认值       → 最低优先级

实际效果：
如果同时设置了环境变量和配置文件，环境变量会覆盖配置文件的设置
```

---

## 2. ⚙️ Kibana核心环境变量


### 2.1 基础连接配置


**服务器监听配置**：
```bash
# 服务器绑定地址
KIBANA_HOST=0.0.0.0        # 允许所有IP访问
KIBANA_HOST=localhost      # 只允许本机访问
KIBANA_HOST=192.168.1.100  # 指定IP访问

# 服务器监听端口
KIBANA_PORT=5601           # 默认端口
KIBANA_PORT=8080           # 自定义端口
```

**通俗解释**：
- `KIBANA_HOST`就像你家的门牌号，决定别人能不能找到你的Kibana
- `0.0.0.0`表示"欢迎所有人来访问"
- `localhost`表示"只有本机能访问，外人免进"
- `KIBANA_PORT`就像房间号，访问者需要敲对门才能进入

### 2.2 Elasticsearch连接配置


```bash
# Elasticsearch服务器地址
ELASTICSEARCH_HOSTS=http://localhost:9200
ELASTICSEARCH_HOSTS=http://es1:9200,http://es2:9200  # 多节点

# 认证配置
ELASTICSEARCH_USERNAME=kibana_user
ELASTICSEARCH_PASSWORD=your_password

# SSL/TLS配置
ELASTICSEARCH_SSL_VERIFY=false  # 跳过SSL验证(开发环境)
ELASTICSEARCH_SSL_VERIFY=true   # 启用SSL验证(生产环境)
```

**实际场景应用**：
```bash
# 开发环境：连接本地ES，无认证
ELASTICSEARCH_HOSTS=http://localhost:9200

# 测试环境：连接测试集群，有认证
ELASTICSEARCH_HOSTS=http://test-es:9200
ELASTICSEARCH_USERNAME=test_user
ELASTICSEARCH_PASSWORD=test_pass

# 生产环境：连接生产集群，启用SSL
ELASTICSEARCH_HOSTS=https://prod-es1:9200,https://prod-es2:9200
ELASTICSEARCH_USERNAME=prod_kibana
ELASTICSEARCH_PASSWORD=complex_password
ELASTICSEARCH_SSL_VERIFY=true
```

### 2.3 日志配置


```bash
# 日志级别设置
LOGGING_LEVEL=info    # 一般信息
LOGGING_LEVEL=debug   # 详细调试信息
LOGGING_LEVEL=warn    # 只显示警告和错误
LOGGING_LEVEL=error   # 只显示错误

# 日志输出目标
LOGGING_DEST=stdout           # 输出到控制台
LOGGING_DEST=/var/log/kibana  # 输出到文件
```

**日志级别选择指南**：
```
📊 各级别适用场景：

🔍 debug级别：
✅ 开发阶段排查问题
✅ 新功能测试验证
❌ 生产环境(日志太多，影响性能)

ℹ️ info级别：
✅ 生产环境常规运行
✅ 记录重要操作和状态变化
✅ 性能监控和审计

⚠️ warn级别：
✅ 生产环境精简日志
✅ 只关注潜在问题
✅ 磁盘空间有限的环境

❌ error级别：
✅ 高度敏感的生产环境
✅ 只记录真正的错误
⚠️ 可能遗漏重要信息
```

---

## 3. 🚀 启动参数详解


### 3.1 基本启动参数格式


**标准启动方式**：
```bash
# 最简单的启动
./bin/kibana

# 带参数启动
./bin/kibana --port 5602 --host 0.0.0.0

# 指定配置文件
./bin/kibana --config /path/to/custom/kibana.yml
```

### 3.2 常用启动参数详解


**网络配置参数**：

| 参数 | 说明 | 示例 | 使用场景 |
|------|------|------|----------|
| `--host` | 指定监听地址 | `--host 0.0.0.0` | 允许外部访问 |
| `--port` | 指定监听端口 | `--port 8080` | 端口冲突时使用 |
| `--ssl` | 启用HTTPS | `--ssl` | 安全访问需求 |
| `--ssl-cert` | SSL证书路径 | `--ssl-cert /path/cert.pem` | HTTPS配置 |
| `--ssl-key` | SSL私钥路径 | `--ssl-key /path/key.pem` | HTTPS配置 |

**配置文件参数**：
```bash
# 使用自定义配置文件
./bin/kibana --config /opt/kibana/config/production.yml

# 覆盖配置文件中的设置
./bin/kibana --config kibana.yml --elasticsearch.hosts http://new-es:9200
```

**实际应用示例**：
```bash
# 开发环境启动：调试模式，自定义端口
./bin/kibana --port 5602 --logging.level debug

# 生产环境启动：启用SSL，指定配置
./bin/kibana --config /etc/kibana/production.yml --ssl

# 测试环境启动：连接特定ES集群
./bin/kibana --elasticsearch.hosts http://test-cluster:9200 --port 8080
```

### 3.3 高级启动参数


**开发调试参数**：
```bash
# 启用开发者模式
./bin/kibana --dev

# 启用详细日志
./bin/kibana --verbose

# 指定插件开发目录
./bin/kibana --plugin-dir /path/to/plugins

# 禁用优化(开发时更快启动)
./bin/kibana --no-optimize
```

**性能相关参数**：
```bash
# 设置最大内存使用
./bin/kibana --max-old-space-size=4096

# 启用集群模式
./bin/kibana --cluster.enabled=true

# 设置worker进程数
./bin/kibana --cluster.workers=4
```

---

## 4. ☕ Java虚拟机配置


### 4.1 JAVA_OPTS基础概念


**什么是JAVA_OPTS**：
虽然Kibana主要基于Node.js，但某些插件和功能可能需要Java支持。JAVA_OPTS用于配置Java虚拟机的运行参数。

```bash
# 设置Java堆内存
export JAVA_OPTS="-Xms512m -Xmx2g"

# 启用垃圾回收日志
export JAVA_OPTS="-Xms1g -Xmx2g -XX:+PrintGC -XX:+PrintGCDetails"

# 设置时区
export JAVA_OPTS="-Duser.timezone=Asia/Shanghai"
```

### 4.2 内存配置详解


**堆内存配置**：
```bash
# 基本内存设置
-Xms1g      # 初始堆内存大小
-Xmx4g      # 最大堆内存大小
-Xss1m      # 每个线程的栈大小

# 新生代配置
-Xmn1g                    # 新生代大小
-XX:NewRatio=3           # 老年代与新生代的比例
-XX:SurvivorRatio=8      # Eden区与Survivor区的比例
```

**内存配置建议**：
```
💡 内存大小选择指南：

🏠 小型环境(单用户开发)：
-Xms512m -Xmx1g

🏢 中型环境(小团队)：  
-Xms1g -Xmx2g

🏭 大型环境(企业级)：
-Xms2g -Xmx4g

🌐 超大型环境(大数据)：
-Xms4g -Xmx8g

⚠️ 注意事项：
- 不要超过系统总内存的70%
- Xms和Xmx设置相同值避免动态扩容
- 监控实际内存使用情况进行调整
```

### 4.3 垃圾回收配置


```bash
# G1垃圾回收器(推荐)
-XX:+UseG1GC
-XX:MaxGCPauseMillis=200
-XX:G1HeapRegionSize=16m

# CMS垃圾回收器
-XX:+UseConcMarkSweepGC
-XX:CMSInitiatingOccupancyFraction=70
-XX:+UseCMSInitiatingOccupancyOnly

# 垃圾回收日志
-XX:+PrintGC
-XX:+PrintGCDetails
-XX:+PrintGCTimeStamps
-Xloggc:/var/log/kibana/gc.log
```

---

## 5. 🟢 Node.js运行时配置


### 5.1 NODE_OPTIONS核心配置


**内存配置**：
```bash
# 设置Node.js最大堆内存(重要!)
export NODE_OPTIONS="--max-old-space-size=4096"  # 4GB

# 设置新生代内存
export NODE_OPTIONS="--max-semi-space-size=256"  # 256MB

# 组合设置多个选项
export NODE_OPTIONS="--max-old-space-size=4096 --max-semi-space-size=256"
```

**通俗解释**：
```
🧠 Node.js内存就像大脑的工作台：

--max-old-space-size：
相当于"长期记忆区"的大小，存放程序运行时需要长期保存的数据
默认约1.4GB，大型Kibana实例建议设置4-8GB

--max-semi-space-size：  
相当于"短期记忆区"的大小，存放临时数据
影响垃圾回收频率，适当增大可提升性能

实际建议：
- 小型环境：2048MB (2GB)
- 中型环境：4096MB (4GB)  
- 大型环境：8192MB (8GB)
```

### 5.2 性能优化选项


```bash
# 启用优化编译
export NODE_OPTIONS="--optimize-for-size"

# 设置垃圾回收
export NODE_OPTIONS="--expose-gc --gc-global"

# 启用性能监控
export NODE_OPTIONS="--prof --prof-process"

# 调试选项(开发环境)
export NODE_OPTIONS="--inspect=0.0.0.0:9229"
```

### 5.3 生产环境推荐配置


```bash
# 生产环境NODE_OPTIONS配置模板
export NODE_OPTIONS="
  --max-old-space-size=4096
  --max-semi-space-size=256  
  --optimize-for-size
  --gc-global
"

# 启动Kibana
./bin/kibana
```

**配置效果对比**：
```
📊 内存配置前后对比：

默认配置：
- 最大内存：~1.4GB
- 大数据量处理：容易内存溢出
- 复杂查询：可能崩溃

优化后配置：
- 最大内存：4GB
- 大数据量处理：稳定运行
- 复杂查询：响应流畅
- 多用户访问：并发性能好
```

---

## 6. 📁 路径与目录配置


### 6.1 关键路径环境变量


```bash
# Kibana安装根目录
export KIBANA_HOME=/opt/kibana

# 配置文件目录  
export KIBANA_CONFIG_PATH=/etc/kibana

# 数据存储目录
export KIBANA_DATA_PATH=/var/lib/kibana

# 日志文件目录
export KIBANA_LOG_PATH=/var/log/kibana

# 插件安装目录
export KIBANA_PLUGIN_PATH=/opt/kibana/plugins

# 临时文件目录
export KIBANA_TMP_PATH=/tmp/kibana
```

### 6.2 目录结构规划


**标准目录布局**：
```
/opt/kibana/                 ← KIBANA_HOME
├── bin/                     ← 启动脚本
├── config/                  ← 配置文件
│   └── kibana.yml
├── data/                    ← 数据目录
│   ├── uuid                 ← 实例UUID
│   └── ...
├── logs/                    ← 日志目录
├── plugins/                 ← 插件目录
└── ...

/etc/kibana/                 ← 系统配置
├── kibana.yml               ← 主配置文件
├── certificates/            ← SSL证书
└── ...

/var/lib/kibana/             ← 运行时数据
/var/log/kibana/             ← 系统日志
```

### 6.3 路径配置最佳实践


**开发环境配置**：
```bash
# 开发环境：所有文件在项目目录下
export KIBANA_HOME=/home/user/kibana
export KIBANA_CONFIG_PATH=$KIBANA_HOME/config
export KIBANA_DATA_PATH=$KIBANA_HOME/data
export KIBANA_LOG_PATH=$KIBANA_HOME/logs
```

**生产环境配置**：
```bash
# 生产环境：遵循Linux文件系统标准
export KIBANA_HOME=/opt/kibana
export KIBANA_CONFIG_PATH=/etc/kibana
export KIBANA_DATA_PATH=/var/lib/kibana  
export KIBANA_LOG_PATH=/var/log/kibana

# 设置合适的权限
sudo chown -R kibana:kibana /var/lib/kibana
sudo chown -R kibana:kibana /var/log/kibana
sudo chmod 750 /etc/kibana
```

**Docker环境配置**：
```bash
# Docker容器中的路径映射
docker run -d \
  -e KIBANA_CONFIG_PATH=/usr/share/kibana/config \
  -e KIBANA_DATA_PATH=/usr/share/kibana/data \
  -v /host/kibana/config:/usr/share/kibana/config \
  -v /host/kibana/data:/usr/share/kibana/data \
  kibana:latest
```

---

## 7. 🏃‍♂️ 性能调优配置


### 7.1 内存优化配置


**综合内存配置示例**：
```bash
# Node.js内存配置
export NODE_OPTIONS="--max-old-space-size=6144 --max-semi-space-size=512"

# Java内存配置(如果需要)
export JAVA_OPTS="-Xms1g -Xmx2g -XX:+UseG1GC"

# 系统级别配置
export KIBANA_MEMORY_LIMIT=8g
```

### 7.2 并发性能配置


```bash
# 启用集群模式
export KIBANA_CLUSTER_ENABLED=true
export KIBANA_CLUSTER_WORKERS=4

# 连接池配置
export ELASTICSEARCH_MAX_SOCKETS=50
export ELASTICSEARCH_KEEP_ALIVE=true

# 缓存配置
export KIBANA_CACHE_TTL=3600        # 缓存过期时间(秒)
export KIBANA_CACHE_MAX_SIZE=100    # 最大缓存条目数
```

### 7.3 网络优化配置


```bash
# 超时配置
export ELASTICSEARCH_PING_TIMEOUT=30000      # 30秒
export ELASTICSEARCH_REQUEST_TIMEOUT=60000   # 60秒

# 重试配置  
export ELASTICSEARCH_MAX_RETRIES=3
export ELASTICSEARCH_RETRY_DELAY=1000

# 压缩配置
export ELASTICSEARCH_COMPRESSION=true
```

**性能配置组合示例**：
```bash
#!/bin/bash
# 高性能Kibana启动脚本

# 内存优化
export NODE_OPTIONS="--max-old-space-size=6144 --max-semi-space-size=512 --optimize-for-size"

# 集群配置
export KIBANA_CLUSTER_ENABLED=true
export KIBANA_CLUSTER_WORKERS=4

# 网络优化
export ELASTICSEARCH_MAX_SOCKETS=100
export ELASTICSEARCH_KEEP_ALIVE=true
export ELASTICSEARCH_COMPRESSION=true

# 缓存优化
export KIBANA_CACHE_TTL=7200
export KIBANA_CACHE_MAX_SIZE=200

# 启动Kibana
./bin/kibana --port 5601 --host 0.0.0.0
```

---

## 8. 🔧 开发调试配置


### 8.1 调试模式配置


```bash
# 启用开发者模式
export KIBANA_DEV_MODE=true
export KIBANA_LOGGING_LEVEL=debug

# Node.js调试选项
export NODE_OPTIONS="--inspect=0.0.0.0:9229 --inspect-brk"

# 启用详细错误信息
export KIBANA_VERBOSE_ERRORS=true
export KIBANA_STACK_TRACE=true
```

### 8.2 热重载配置


```bash
# 启用文件监控
export KIBANA_WATCH_MODE=true
export KIBANA_WATCH_POLLING=true

# 跳过优化加速启动
export KIBANA_NO_OPTIMIZE=true
export KIBANA_NO_BASE_PATH=true

# 开发服务器配置
export KIBANA_DEV_SERVER_PORT=5603
export KIBANA_DEV_SERVER_HOST=localhost
```

### 8.3 插件开发配置


```bash
# 插件开发目录
export KIBANA_PLUGIN_DEV_DIR=/path/to/plugin/dev

# 启用插件热重载
export KIBANA_PLUGIN_WATCH=true

# 插件构建配置
export KIBANA_PLUGIN_BUILD_TARGET=development
export KIBANA_PLUGIN_SOURCE_MAPS=true
```

**完整开发环境启动脚本**：
```bash
#!/bin/bash
# 开发环境启动配置

echo "🚀 启动Kibana开发环境..."

# 基础配置
export KIBANA_PORT=5602
export KIBANA_HOST=localhost
export ELASTICSEARCH_HOSTS=http://localhost:9200

# 开发模式
export KIBANA_DEV_MODE=true
export KIBANA_LOGGING_LEVEL=debug
export KIBANA_NO_OPTIMIZE=true

# Node.js调试
export NODE_OPTIONS="--inspect=9229 --max-old-space-size=4096"

# 启动并显示调试信息
echo "📊 Node.js调试端口: 9229"
echo "🌐 Kibana访问地址: http://localhost:5602"
echo "🔍 日志级别: debug"

./bin/kibana
```

---

## 9. 🏭 生产环境最佳实践


### 9.1 生产环境配置模板


```bash
#!/bin/bash
# 生产环境Kibana启动配置

# 基础服务配置
export KIBANA_HOST=0.0.0.0
export KIBANA_PORT=5601
export ELASTICSEARCH_HOSTS="https://es-node1:9200,https://es-node2:9200,https://es-node3:9200"

# 安全配置
export ELASTICSEARCH_USERNAME=kibana_system
export ELASTICSEARCH_PASSWORD=$(cat /etc/kibana/password)
export ELASTICSEARCH_SSL_VERIFY=true
export KIBANA_SSL_ENABLED=true
export KIBANA_SSL_CERT=/etc/kibana/certs/kibana.crt
export KIBANA_SSL_KEY=/etc/kibana/certs/kibana.key

# 性能优化
export NODE_OPTIONS="--max-old-space-size=8192 --max-semi-space-size=1024"
export KIBANA_CLUSTER_ENABLED=true
export KIBANA_CLUSTER_WORKERS=8

# 日志配置
export KIBANA_LOGGING_LEVEL=info
export KIBANA_LOG_PATH=/var/log/kibana

# 监控配置
export KIBANA_MONITORING_ENABLED=true
export KIBANA_METRICS_ENABLED=true

# 启动Kibana
exec /opt/kibana/bin/kibana
```

### 9.2 系统服务配置


**systemd服务文件示例** (`/etc/systemd/system/kibana.service`)：
```ini
[Unit]
Description=Kibana
Documentation=https://www.elastic.co
Wants=network-online.target
After=network-online.target
After=elasticsearch.service

[Service]
Type=simple
User=kibana
Group=kibana
ExecStart=/opt/kibana/bin/kibana
Restart=on-failure
RestartSec=3
StartLimitBurst=3
StartLimitInterval=60
TimeoutStopSec=10
KillMode=process

# 环境变量配置
Environment=NODE_OPTIONS=--max-old-space-size=8192
Environment=KIBANA_CONFIG_PATH=/etc/kibana/kibana.yml
Environment=KIBANA_LOG_PATH=/var/log/kibana
EnvironmentFile=-/etc/default/kibana

# 安全配置
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ReadWritePaths=/var/lib/kibana
ReadWritePaths=/var/log/kibana

[Install]
WantedBy=multi-user.target
```

### 9.3 容器化部署配置


**Docker Compose配置**：
```yaml
version: '3.8'
services:
  kibana:
    image: kibana:8.x.x
    container_name: kibana
    environment:
      # 基础配置
      - ELASTICSEARCH_HOSTS=http://elasticsearch:9200
      - KIBANA_HOST=0.0.0.0
      - KIBANA_PORT=5601
      
      # 性能配置
      - NODE_OPTIONS=--max-old-space-size=4096
      - KIBANA_CLUSTER_ENABLED=true
      
      # 安全配置
      - ELASTICSEARCH_USERNAME=kibana_system
      - ELASTICSEARCH_PASSWORD=your_password
      
      # 日志配置
      - KIBANA_LOGGING_LEVEL=info
      
    ports:
      - "5601:5601"
    volumes:
      - kibana_data:/usr/share/kibana/data
      - ./config/kibana.yml:/usr/share/kibana/config/kibana.yml
      - ./logs:/usr/share/kibana/logs
    depends_on:
      - elasticsearch
    restart: unless-stopped
    
volumes:
  kibana_data:
```

**Kubernetes部署配置**：
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: kibana
spec:
  replicas: 2
  selector:
    matchLabels:
      app: kibana
  template:
    metadata:
      labels:
        app: kibana
    spec:
      containers:
      - name: kibana
        image: kibana:8.x.x
        env:
        - name: ELASTICSEARCH_HOSTS
          value: "http://elasticsearch:9200"
        - name: NODE_OPTIONS
          value: "--max-old-space-size=4096"
        - name: KIBANA_CLUSTER_ENABLED
          value: "true"
        resources:
          requests:
            memory: "2Gi"
            cpu: "500m"
          limits:
            memory: "4Gi"
            cpu: "2000m"
        ports:
        - containerPort: 5601
```

---

## 10. 📋 核心要点总结


### 10.1 必须掌握的核心配置


```
🔑 最重要的环境变量：

1. NODE_OPTIONS="--max-old-space-size=4096"
   → 解决内存不足问题，必须设置！

2. ELASTICSEARCH_HOSTS=http://your-es:9200  
   → 告诉Kibana去哪里找数据

3. KIBANA_PORT=5601
   → 决定用什么端口访问Kibana

4. KIBANA_LOGGING_LEVEL=info
   → 控制日志详细程度

5. ELASTICSEARCH_USERNAME/PASSWORD
   → 连接ES的账号密码
```

### 10.2 不同环境的推荐配置


**🏠 开发环境**：
```bash
# 简单快速启动
export NODE_OPTIONS="--max-old-space-size=2048"
export KIBANA_PORT=5602
export KIBANA_LOGGING_LEVEL=debug
export KIBANA_DEV_MODE=true
```

**🧪 测试环境**：
```bash
# 模拟生产但资源较少
export NODE_OPTIONS="--max-old-space-size=4096"
export KIBANA_PORT=5601
export KIBANA_LOGGING_LEVEL=info
export KIBANA_CLUSTER_ENABLED=false
```

**🏭 生产环境**：
```bash
# 高性能高可用配置
export NODE_OPTIONS="--max-old-space-size=8192 --max-semi-space-size=1024"
export KIBANA_CLUSTER_ENABLED=true
export KIBANA_CLUSTER_WORKERS=8
export KIBANA_LOGGING_LEVEL=warn
export ELASTICSEARCH_SSL_VERIFY=true
```

### 10.3 常见问题与解决方案


**💥 内存不足错误**：
```
问题现象：Kibana启动后崩溃，提示内存不足
解决方案：增加NODE_OPTIONS内存设置
export NODE_OPTIONS="--max-old-space-size=4096"
```

**🔌 连接ES失败**：
```
问题现象：Kibana无法连接Elasticsearch
检查项目：
1. ELASTICSEARCH_HOSTS是否正确
2. ES服务是否启动
3. 网络是否通畅
4. 认证信息是否正确
```

**🐌 启动速度慢**：
```
问题现象：Kibana启动很慢
解决方案：
开发环境：export KIBANA_NO_OPTIMIZE=true
生产环境：增加内存和worker数量
```

**🚫 端口冲突**：
```
问题现象：5601端口被占用
解决方案：
export KIBANA_PORT=5602
或者: ./bin/kibana --port 5602
```

### 10.4 配置检查清单


**🔍 启动前检查清单**：
```
□ 内存配置是否足够(至少2GB)
□ ES连接地址是否正确
□ 端口是否可用
□ 日志目录是否有写权限
□ SSL证书路径是否正确(如果启用)
□ 环境变量是否正确设置
□ 配置文件语法是否正确
```

**📊 性能监控要点**：
```
监控项目：
- 内存使用率(不超过80%)
- CPU使用率(不超过70%)
- 响应时间(小于3秒)
- 错误日志频率
- ES连接状态
```

**核心记忆要点**：
- 🧠 内存配置是关键，NODE_OPTIONS必须设置
- 🔗 ES连接配置要准确，否则Kibana无法工作
- 📊 不同环境使用不同配置，不要一刀切
- 🔧 遇到问题先查日志，再检查环境变量
- 🚀 生产环境重视安全和性能配置