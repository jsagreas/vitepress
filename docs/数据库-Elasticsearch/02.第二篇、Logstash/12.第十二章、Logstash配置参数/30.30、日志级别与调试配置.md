---
title: 30ã€æ—¥å¿—çº§åˆ«ä¸è°ƒè¯•é…ç½®
---
## ğŸ“š ç›®å½•

1. [æ—¥å¿—çº§åˆ«åŸºç¡€æ¦‚å¿µ](#1-æ—¥å¿—çº§åˆ«åŸºç¡€æ¦‚å¿µ)
2. [log.levelå‚æ•°è¯¦è§£](#2-log-levelå‚æ•°è¯¦è§£)
3. [log4j2.propertiesé…ç½®æ–‡ä»¶](#3-log4j2-propertiesé…ç½®æ–‡ä»¶)
4. [slowlogæ…¢æŸ¥è¯¢æ—¥å¿—é…ç½®](#4-slowlogæ…¢æŸ¥è¯¢æ—¥å¿—é…ç½®)
5. [pipeline.separate_logsç®¡é“åˆ†ç¦»æ—¥å¿—](#5-pipeline-separate-logsç®¡é“åˆ†ç¦»æ—¥å¿—)
6. [è°ƒè¯•è¾“å‡ºé…ç½®å®æˆ˜](#6-è°ƒè¯•è¾“å‡ºé…ç½®å®æˆ˜)
7. [æ€§èƒ½ç›‘æ§æ—¥å¿—é…ç½®](#7-æ€§èƒ½ç›‘æ§æ—¥å¿—é…ç½®)
8. [å®ç”¨è°ƒè¯•æŠ€å·§](#8-å®ç”¨è°ƒè¯•æŠ€å·§)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ“Š æ—¥å¿—çº§åˆ«åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯æ—¥å¿—çº§åˆ«


**ğŸ’¡ ç”Ÿæ´»ç±»æ¯”**
> å°±åƒæ‰‹æœºçš„é“ƒå£°éŸ³é‡è°ƒèŠ‚ä¸€æ ·ï¼Œæ—¥å¿—çº§åˆ«å°±æ˜¯æ§åˆ¶Logstash"è¯´è¯"å¤šå°‘çš„å¼€å…³ã€‚è°ƒåˆ°æœ€é«˜çº§åˆ«ï¼Œå®ƒä¼šå‘Šè¯‰ä½ æ¯ä¸€ä¸ªç»†èŠ‚ï¼›è°ƒåˆ°æœ€ä½çº§åˆ«ï¼Œå®ƒåªåœ¨å‡ºç°ä¸¥é‡é—®é¢˜æ—¶æ‰å¼€å£ã€‚

**ğŸ” æ ¸å¿ƒæ¦‚å¿µ**
```
æ—¥å¿—çº§åˆ« = ä¿¡æ¯è¯¦ç»†ç¨‹åº¦çš„æ§åˆ¶å™¨

ä½œç”¨ï¼š
â€¢ æ§åˆ¶è¾“å‡ºä¿¡æ¯çš„å¤šå°‘
â€¢ å¸®åŠ©æ’æŸ¥é—®é¢˜å’Œè°ƒè¯•
â€¢ é¿å…ä¿¡æ¯è¿‡è½½å½±å“æ€§èƒ½
â€¢ ä¾¿äºç”Ÿäº§ç¯å¢ƒç›‘æ§
```

### 1.2 Logstashä¸­çš„æ—¥å¿—çº§åˆ«ä½“ç³»


**ğŸ“ˆ çº§åˆ«ç­‰çº§ï¼ˆä»é«˜åˆ°ä½ï¼‰**
```
TRACE â†’ DEBUG â†’ INFO â†’ WARN â†’ ERROR â†’ FATAL
 â†‘                                        â†‘
æœ€è¯¦ç»†                                   æœ€é‡è¦
(å¼€å‘è°ƒè¯•ç”¨)                            (ç”Ÿäº§ç¯å¢ƒç”¨)
```

**ğŸ¯ å„çº§åˆ«å«ä¹‰è§£é‡Š**

| çº§åˆ« | **è¯´æ˜** | **ä½¿ç”¨åœºæ™¯** | **ä¿¡æ¯é‡** |
|------|----------|-------------|-----------|
| ğŸ” **TRACE** | `æœ€è¯¦ç»†çš„è·Ÿè¸ªä¿¡æ¯` | `æ·±åº¦è°ƒè¯•ï¼ŒæŸ¥çœ‹æ¯ä¸€æ­¥æ‰§è¡Œ` | `ğŸ“Š æå¤š` |
| ğŸ› **DEBUG** | `è°ƒè¯•ä¿¡æ¯ï¼Œå¼€å‘æ—¶ç”¨` | `å¼€å‘å’Œæµ‹è¯•é˜¶æ®µæ’é”™` | `ğŸ“Š å¾ˆå¤š` |
| â„¹ï¸ **INFO** | `ä¸€èˆ¬è¿è¡Œä¿¡æ¯` | `äº†è§£ç¨‹åºæ­£å¸¸è¿è¡ŒçŠ¶æ€` | `ğŸ“Š é€‚ä¸­` |
| âš ï¸ **WARN** | `è­¦å‘Šä¿¡æ¯ï¼Œéœ€è¦æ³¨æ„` | `å¯èƒ½å‡ºç°é—®é¢˜çš„æé†’` | `ğŸ“Š è¾ƒå°‘` |
| âŒ **ERROR** | `é”™è¯¯ä¿¡æ¯ï¼Œéœ€è¦å¤„ç†` | `å¤„ç†å¼‚å¸¸å’Œé”™è¯¯` | `ğŸ“Š å¾ˆå°‘` |
| ğŸ’¥ **FATAL** | `è‡´å‘½é”™è¯¯ï¼Œç¨‹åºå´©æºƒ` | `ä¸¥é‡ç³»ç»Ÿé—®é¢˜` | `ğŸ“Š æå°‘` |

**ğŸ¤” è‡ªæˆ‘æ£€æµ‹**
> Q: åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½ è®¤ä¸ºåº”è¯¥ä½¿ç”¨å“ªä¸ªæ—¥å¿—çº§åˆ«ï¼Ÿ
> æç¤ºï¼šè€ƒè™‘æ€§èƒ½å’Œé—®é¢˜æ’æŸ¥çš„å¹³è¡¡

---

## 2. âš™ï¸ log.levelå‚æ•°è¯¦è§£


### 2.1 log.levelå‚æ•°åŸºç¡€


**ğŸ”¸ å‚æ•°ä½œç”¨**
```
log.level = Logstashå…¨å±€æ—¥å¿—è¾“å‡ºçº§åˆ«æ§åˆ¶å™¨

è®¾ç½®ä½ç½®ï¼š
â€¢ logstash.ymlä¸»é…ç½®æ–‡ä»¶
â€¢ å‘½ä»¤è¡Œå¯åŠ¨å‚æ•°
â€¢ ç¯å¢ƒå˜é‡
```

### 2.2 é…ç½®æ–¹æ³•è¯¦è§£


**ğŸ“ æ–¹æ³•ä¸€ï¼šlogstash.ymlé…ç½®**
```yaml
# /etc/logstash/logstash.yml
log.level: info

# å…¶ä»–ç›¸å…³é…ç½®
path.logs: /var/log/logstash
```

**ğŸ“ æ–¹æ³•äºŒï¼šå‘½ä»¤è¡Œå‚æ•°**
```bash
# å¯åŠ¨æ—¶æŒ‡å®šæ—¥å¿—çº§åˆ«
bin/logstash -f myconfig.conf --log.level=debug

# ä¸´æ—¶è°ƒè¯•ç”¨æ³•
bin/logstash -f myconfig.conf --log.level=trace
```

**ğŸ“ æ–¹æ³•ä¸‰ï¼šç¯å¢ƒå˜é‡**
```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export LS_LOG_LEVEL=debug
bin/logstash -f myconfig.conf
```

### 2.3 ä¸åŒçº§åˆ«çš„å®é™…æ•ˆæœ


**ğŸ® å®é™…å¯¹æ¯”æ¼”ç¤º**
```
çº§åˆ«è®¾ç½®ä¸º INFOï¼š
[INFO ] 2025-09-21 14:30:00 Pipeline started successfully
[WARN ] 2025-09-21 14:30:05 Input queue is getting full

çº§åˆ«è®¾ç½®ä¸º DEBUGï¼š
[DEBUG] 2025-09-21 14:30:00 Loading plugin inputs/file
[DEBUG] 2025-09-21 14:30:00 Plugin loaded: LogStash::Inputs::File
[INFO ] 2025-09-21 14:30:00 Pipeline started successfully
[DEBUG] 2025-09-21 14:30:03 Processing event: {"message":"test"}
[WARN ] 2025-09-21 14:30:05 Input queue is getting full
[DEBUG] 2025-09-21 14:30:06 Filter execution time: 2ms
```

**ğŸ’ª å®è·µæŒ‘æˆ˜**
> è¯•ç€ç”¨ä¸åŒçš„æ—¥å¿—çº§åˆ«å¯åŠ¨Logstashï¼Œè§‚å¯Ÿè¾“å‡ºä¿¡æ¯çš„å·®å¼‚

### 2.4 çº§åˆ«é€‰æ‹©æœ€ä½³å®è·µ


**ğŸ¯ ç¯å¢ƒæ¨èé…ç½®**

```
å¼€å‘ç¯å¢ƒï¼šDEBUG
â”œâ”€â”€ ä¼˜ç‚¹ï¼šè¯¦ç»†ä¿¡æ¯ä¾¿äºè°ƒè¯•
â”œâ”€â”€ ç¼ºç‚¹ï¼šæ—¥å¿—æ–‡ä»¶è¾ƒå¤§
â””â”€â”€ é€‚ç”¨ï¼šå¼€å‘å’Œæµ‹è¯•é˜¶æ®µ

ç”Ÿäº§ç¯å¢ƒï¼šINFO
â”œâ”€â”€ ä¼˜ç‚¹ï¼šæ€§èƒ½å¥½ï¼Œä¿¡æ¯é€‚ä¸­
â”œâ”€â”€ ç¼ºç‚¹ï¼šè°ƒè¯•ä¿¡æ¯è¾ƒå°‘
â””â”€â”€ é€‚ç”¨ï¼šæ—¥å¸¸è¿è¡Œç›‘æ§

æ•…éšœæ’æŸ¥ï¼šDEBUG/TRACE
â”œâ”€â”€ ä¼˜ç‚¹ï¼šæœ€è¯¦ç»†çš„è¯Šæ–­ä¿¡æ¯
â”œâ”€â”€ ç¼ºç‚¹ï¼šå½±å“æ€§èƒ½ï¼Œæ—¥å¿—åºå¤§
â””â”€â”€ é€‚ç”¨ï¼šä¸´æ—¶é—®é¢˜å®šä½
```

---

## 3. ğŸ“„ log4j2.propertiesé…ç½®æ–‡ä»¶


### 3.1 log4j2.propertiesæ˜¯ä»€ä¹ˆ


**ğŸ  ç”Ÿæ´»ç±»æ¯”**
> å¦‚æœè¯´log.levelæ˜¯è°ƒèŠ‚éŸ³é‡çš„æ—‹é’®ï¼Œé‚£ä¹ˆlog4j2.propertieså°±æ˜¯æ•´ä¸ªéŸ³å“ç³»ç»Ÿçš„è¯¦ç»†è®¾ç½®é¢æ¿ï¼Œå¯ä»¥æ§åˆ¶æ¯ä¸ªéŸ³ç®±ï¼ˆä¸åŒç»„ä»¶ï¼‰çš„éŸ³é‡ã€éŸ³è´¨ã€è¾“å‡ºä½ç½®ç­‰ã€‚

**ğŸ“‹ æ ¸å¿ƒæ¦‚å¿µ**
```
log4j2.properties = Logstashæ—¥å¿—ç³»ç»Ÿçš„è¯¦ç»†é…ç½®æ–‡ä»¶

ä½œç”¨ï¼š
â€¢ ç²¾ç¡®æ§åˆ¶ä¸åŒç»„ä»¶çš„æ—¥å¿—çº§åˆ«
â€¢ å®šä¹‰æ—¥å¿—è¾“å‡ºæ ¼å¼
â€¢ è®¾ç½®æ—¥å¿—æ–‡ä»¶ä½ç½®å’Œæ»šåŠ¨ç­–ç•¥
â€¢ æ§åˆ¶ç‰¹å®šåŠŸèƒ½çš„æ—¥å¿—è¡Œä¸º
```

### 3.2 é…ç½®æ–‡ä»¶ä½ç½®å’Œç»“æ„


**ğŸ“‚ æ–‡ä»¶ä½ç½®**
```
é»˜è®¤ä½ç½®ï¼š
/usr/share/logstash/config/log4j2.properties

è‡ªå®šä¹‰ä½ç½®ï¼š
é€šè¿‡ --path.settings å‚æ•°æŒ‡å®š
```

**ğŸ—ï¸ åŸºç¡€ç»“æ„è§£æ**
```properties
# æ ¹æ—¥å¿—è®°å½•å™¨é…ç½®
rootLogger.level = info
rootLogger.appenderRef.console.ref = plain_console
rootLogger.appenderRef.rolling.ref = plain_rolling

# æ§åˆ¶å°è¾“å‡ºé…ç½®
appender.console.type = Console
appender.console.name = plain_console
appender.console.layout.type = PatternLayout

# æ–‡ä»¶è¾“å‡ºé…ç½®
appender.rolling.type = RollingFile
appender.rolling.name = plain_rolling
appender.rolling.fileName = ${sys:ls.logs}/logstash-plain.log
```

### 3.3 å®ç”¨é…ç½®ç¤ºä¾‹


**ğŸ”§ åŸºç¡€é…ç½®æ¨¡æ¿**
```properties
# è®¾ç½®æ ¹æ—¥å¿—çº§åˆ«
rootLogger.level = info
rootLogger.appenderRef.console.ref = plain_console
rootLogger.appenderRef.rolling.ref = plain_rolling

# === æ§åˆ¶å°è¾“å‡ºé…ç½® ===
appender.console.type = Console
appender.console.name = plain_console
appender.console.layout.type = PatternLayout
appender.console.layout.pattern = [%d{ISO8601}][%-5p][%-25c] %m%n

# === æ–‡ä»¶è¾“å‡ºé…ç½® ===
appender.rolling.type = RollingFile
appender.rolling.name = plain_rolling
appender.rolling.fileName = ${sys:ls.logs}/logstash-plain.log
appender.rolling.filePattern = ${sys:ls.logs}/logstash-plain-%i.log.gz
appender.rolling.layout.type = PatternLayout
appender.rolling.layout.pattern = [%d{ISO8601}][%-5p][%-25c] %m%n

# === æ—¥å¿—æ»šåŠ¨ç­–ç•¥ ===
appender.rolling.policies.type = Policies
appender.rolling.policies.size.type = SizeBasedTriggeringPolicy
appender.rolling.policies.size.size = 100MB
appender.rolling.strategy.type = DefaultRolloverStrategy
appender.rolling.strategy.max = 30
```

**ğŸ¨ è‡ªå®šä¹‰ç»„ä»¶æ—¥å¿—çº§åˆ«**
```properties
# ç®¡é“ç›¸å…³æ—¥å¿—
logger.pipeline.name = logstash.pipeline
logger.pipeline.level = debug

# è¾“å…¥æ’ä»¶æ—¥å¿—
logger.inputs.name = logstash.inputs
logger.inputs.level = info

# è¿‡æ»¤å™¨æ—¥å¿—
logger.filters.name = logstash.filters
logger.filters.level = debug

# è¾“å‡ºæ’ä»¶æ—¥å¿—
logger.outputs.name = logstash.outputs
logger.outputs.level = warn

# ESè¾“å‡ºæ’ä»¶ä¸“é—¨é…ç½®
logger.elasticsearch.name = logstash.outputs.elasticsearch
logger.elasticsearch.level = debug
```

### 3.4 æ—¥å¿—æ ¼å¼æ¨¡å¼è¯¦è§£


**ğŸ“ æ¨¡å¼ç¬¦å·è¯´æ˜**

| æ¨¡å¼ | **è¯´æ˜** | **ç¤ºä¾‹** |
|------|----------|----------|
| `%d{ISO8601}` | `æ—¶é—´æˆ³ï¼ˆISOæ ¼å¼ï¼‰` | `2025-09-21T14:30:00.123Z` |
| `%-5p` | `æ—¥å¿—çº§åˆ«ï¼ˆå·¦å¯¹é½5å­—ç¬¦ï¼‰` | `INFO `, `DEBUG` |
| `%-25c` | `ç±»åï¼ˆå·¦å¯¹é½25å­—ç¬¦ï¼‰` | `logstash.pipeline    ` |
| `%m` | `æ—¥å¿—æ¶ˆæ¯å†…å®¹` | `Pipeline started` |
| `%n` | `æ¢è¡Œç¬¦` | `æ¢è¡Œ` |
| `%t` | `çº¿ç¨‹å` | `[main]` |

**ğŸ¯ å®ç”¨æ ¼å¼ç¤ºä¾‹**
```properties
# ç®€æ´æ ¼å¼
layout.pattern = [%d{HH:mm:ss}][%p] %m%n
# è¾“å‡ºï¼š[14:30:00][INFO] Pipeline started

# è¯¦ç»†æ ¼å¼
layout.pattern = [%d{ISO8601}][%-5p][%t][%-25c] %m%n
# è¾“å‡ºï¼š[2025-09-21T14:30:00.123Z][INFO ][main][logstash.pipeline    ] Pipeline started

# è°ƒè¯•æ ¼å¼
layout.pattern = [%d{ISO8601}][%-5p][%t][%-30c{1.}] %m%n
# è¾“å‡ºï¼š[2025-09-21T14:30:00.123Z][DEBUG][main][pipeline                     ] Processing event
```

---

## 4. ğŸŒ slowlogæ…¢æŸ¥è¯¢æ—¥å¿—é…ç½®


### 4.1 slowlogæ˜¯ä»€ä¹ˆ


**ğŸš— ç”Ÿæ´»ç±»æ¯”**
> slowlogå°±åƒæ±½è½¦çš„è¡Œè½¦è®°å½•ä»ªï¼Œä¸“é—¨è®°å½•é‚£äº›"å¼€å¾—å¾ˆæ…¢"çš„æ“ä½œã€‚å½“Logstashå¤„ç†æŸäº›æ•°æ®è¶…è¿‡é¢„è®¾æ—¶é—´æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨è®°å½•ä¸‹æ¥ï¼Œå¸®ä½ æ‰¾å‡ºæ€§èƒ½ç“¶é¢ˆã€‚

**ğŸ” æ ¸å¿ƒæ¦‚å¿µ**
```
slowlog = æ…¢æ“ä½œè®°å½•å™¨

è®°å½•å†…å®¹ï¼š
â€¢ å¤„ç†æ—¶é—´è¶…è¿‡é˜ˆå€¼çš„äº‹ä»¶
â€¢ å…·ä½“çš„æ‰§è¡Œæ—¶é—´
â€¢ ç›¸å…³çš„ç®¡é“å’Œæ’ä»¶ä¿¡æ¯
â€¢ äº‹ä»¶å†…å®¹ï¼ˆå¯é€‰ï¼‰
```

### 4.2 slowlogé…ç½®å‚æ•°


**âš™ï¸ ä¸»è¦é…ç½®é¡¹**
```yaml
# logstash.ymlä¸­çš„slowlogé…ç½®
slowlog.threshold.warn: 2s
slowlog.threshold.info: 1s
slowlog.threshold.debug: 500ms
slowlog.threshold.trace: 100ms
```

**ğŸ“Š å‚æ•°è¯¦è§£**

| å‚æ•° | **å«ä¹‰** | **æ¨èå€¼** | **ä½¿ç”¨åœºæ™¯** |
|------|----------|------------|-------------|
| `warn` | `è­¦å‘Šçº§åˆ«é˜ˆå€¼` | `2-5ç§’` | `æ ‡è¯†æ˜æ˜¾çš„æ€§èƒ½é—®é¢˜` |
| `info` | `ä¿¡æ¯çº§åˆ«é˜ˆå€¼` | `1-2ç§’` | `è®°å½•è¾ƒæ…¢çš„æ“ä½œ` |
| `debug` | `è°ƒè¯•çº§åˆ«é˜ˆå€¼` | `500ms-1s` | `å¼€å‘è°ƒè¯•æ—¶ä½¿ç”¨` |
| `trace` | `è·Ÿè¸ªçº§åˆ«é˜ˆå€¼` | `100-500ms` | `è¯¦ç»†æ€§èƒ½åˆ†æ` |

### 4.3 slowlogå®é™…é…ç½®ç¤ºä¾‹


**ğŸ”§ åŸºç¡€é…ç½®**
```yaml
# /etc/logstash/logstash.yml
slowlog.threshold.warn: 3s
slowlog.threshold.info: 1s
slowlog.threshold.debug: 500ms
```

**ğŸ“ˆ é«˜çº§é…ç½®**
```yaml
# æ›´ç»†ç²’åº¦çš„slowlogé…ç½®
slowlog.threshold.warn: 5s
slowlog.threshold.info: 2s
slowlog.threshold.debug: 1s
slowlog.threshold.trace: 200ms

# é…åˆlog4j2.propertiesä¸­çš„slowlogé…ç½®
```

**ğŸ”§ log4j2.propertiesä¸­çš„slowlogé…ç½®**
```properties
# slowlogä¸“ç”¨è¾“å‡ºå™¨
appender.slowlog.type = RollingFile
appender.slowlog.name = slowlog
appender.slowlog.fileName = ${sys:ls.logs}/logstash-slowlog.log
appender.slowlog.filePattern = ${sys:ls.logs}/logstash-slowlog-%i.log.gz
appender.slowlog.layout.type = PatternLayout
appender.slowlog.layout.pattern = [%d{ISO8601}][%-5p][%-25c] %m%n

# slowlogä¸“ç”¨logger
logger.slowlog.name = slowlog
logger.slowlog.level = trace
logger.slowlog.appenderRef.slowlog.ref = slowlog
logger.slowlog.additivity = false
```

### 4.4 slowlogè¾“å‡ºè§£è¯»


**ğŸ“ å…¸å‹slowlogè¾“å‡º**
```
[2025-09-21T14:30:15.123Z][WARN ][slowlog] event processing time {:time_ms=>3045, :event=>{"message"=>"test log"}}

[2025-09-21T14:30:20.456Z][INFO ][slowlog] filter processing time {:time_ms=>1234, :plugin=>"grok", :event=>{"@timestamp"=>"2025-09-21"}}
```

**ğŸ” è¾“å‡ºå­—æ®µè§£é‡Š**
```
time_ms: å®é™…å¤„ç†æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
plugin: å¯¼è‡´æ…¢æ“ä½œçš„å…·ä½“æ’ä»¶
event: ç›¸å…³çš„äº‹ä»¶æ•°æ®
pipeline: æ‰€å±ç®¡é“åç§°
```

**ğŸ’¡ å…³é”®æ´å¯Ÿ**
> slowlogä¸ä»…å‘Šè¯‰ä½ "æ…¢"ï¼Œæ›´é‡è¦çš„æ˜¯å‘Šè¯‰ä½ "ä¸ºä»€ä¹ˆæ…¢"å’Œ"æ…¢åœ¨å“ªé‡Œ"

---

## 5. ğŸ”€ pipeline.separate_logsç®¡é“åˆ†ç¦»æ—¥å¿—


### 5.1 ä»€ä¹ˆæ˜¯ç®¡é“åˆ†ç¦»æ—¥å¿—


**ğŸ¢ ç”Ÿæ´»ç±»æ¯”**
> æƒ³è±¡ä¸€ä¸ªå¤§å…¬å¸æœ‰å¤šä¸ªéƒ¨é—¨ï¼Œå¦‚æœæ‰€æœ‰éƒ¨é—¨çš„ä¼šè®®è®°å½•éƒ½æ··åœ¨ä¸€èµ·ï¼Œå°±å¾ˆéš¾ç®¡ç†ã€‚pipeline.separate_logså°±åƒç»™æ¯ä¸ªéƒ¨é—¨å»ºç«‹ç‹¬ç«‹çš„ä¼šè®®è®°å½•æœ¬ï¼Œè®©ä¸åŒç®¡é“çš„æ—¥å¿—åˆ†å¼€å­˜å‚¨ã€‚

**ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ**
```
pipeline.separate_logs = ç®¡é“æ—¥å¿—éš”ç¦»å¼€å…³

ä½œç”¨ï¼š
â€¢ ä¸ºæ¯ä¸ªç®¡é“åˆ›å»ºç‹¬ç«‹çš„æ—¥å¿—æ–‡ä»¶
â€¢ ä¾¿äºé—®é¢˜å®šä½å’Œç®¡ç†
â€¢ é¿å…ä¸åŒç®¡é“æ—¥å¿—æ··æ·†
â€¢ æé«˜è¿ç»´æ•ˆç‡
```

### 5.2 é…ç½®å‚æ•°è¯¦è§£


**âš™ï¸ åŸºç¡€é…ç½®**
```yaml
# logstash.yml
pipeline.separate_logs: true
```

**ğŸ“‚ å¼€å¯åçš„æ—¥å¿—æ–‡ä»¶ç»“æ„**
```
/var/log/logstash/
â”œâ”€â”€ logstash-plain.log          # ä¸»æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ pipeline.main.log           # mainç®¡é“ä¸“ç”¨æ—¥å¿—
â”œâ”€â”€ pipeline.beats.log          # beatsç®¡é“ä¸“ç”¨æ—¥å¿—
â”œâ”€â”€ pipeline.nginx.log          # nginxç®¡é“ä¸“ç”¨æ—¥å¿—
â””â”€â”€ pipeline.app.log            # appç®¡é“ä¸“ç”¨æ—¥å¿—
```

### 5.3 é…ç½®ç¤ºä¾‹å’Œæ•ˆæœå¯¹æ¯”


**ğŸ“Š å¯¹æ¯”æ•ˆæœ**

**ğŸ”¸ æœªå¼€å¯åˆ†ç¦»ï¼ˆé»˜è®¤ï¼‰**
```
# æ‰€æœ‰ç®¡é“æ—¥å¿—æ··åœ¨ä¸€èµ·
[INFO ][main] Pipeline main started
[INFO ][beats] Pipeline beats started  
[ERROR][main] Failed to process event
[WARN ][nginx] High memory usage
[INFO ][beats] Event processed successfully
```

**ğŸ”¸ å¼€å¯åˆ†ç¦»å**
```
# pipeline.main.log
[INFO ][main] Pipeline main started
[ERROR][main] Failed to process event

# pipeline.beats.log  
[INFO ][beats] Pipeline beats started
[INFO ][beats] Event processed successfully

# pipeline.nginx.log
[WARN ][nginx] High memory usage
```

### 5.4 é«˜çº§é…ç½®é€‰é¡¹


**ğŸ”§ é…åˆlog4j2.propertiesçš„é«˜çº§é…ç½®**
```properties
# ä¸ºæ¯ä¸ªç®¡é“é…ç½®ä¸åŒçš„æ—¥å¿—çº§åˆ«
logger.pipeline.main.name = logstash.pipeline.main
logger.pipeline.main.level = debug

logger.pipeline.beats.name = logstash.pipeline.beats  
logger.pipeline.beats.level = info

logger.pipeline.nginx.name = logstash.pipeline.nginx
logger.pipeline.nginx.level = warn
```

**ğŸ“ˆ å®ç”¨æ€§è¯„ä¼°**

âœ… **é€‚åˆä½¿ç”¨çš„åœºæ™¯ï¼š**
- å¤šç®¡é“ç”Ÿäº§ç¯å¢ƒ
- éœ€è¦ç²¾ç¡®é—®é¢˜å®šä½
- ä¸åŒç®¡é“æœ‰ä¸åŒé‡è¦æ€§
- å›¢é˜Ÿåä½œå¼€å‘

âŒ **ä¸å¿…è¦çš„åœºæ™¯ï¼š**
- å•ç®¡é“ç®€å•åº”ç”¨
- å¼€å‘æµ‹è¯•ç¯å¢ƒ
- èµ„æºå—é™ç¯å¢ƒ

---

## 6. ğŸ”§ è°ƒè¯•è¾“å‡ºé…ç½®å®æˆ˜


### 6.1 è°ƒè¯•è¾“å‡ºçš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ•µï¸ è°ƒè¯•æ€ç»´**
> è°ƒè¯•å°±åƒå½“ä¾¦æ¢ï¼Œéœ€è¦æ”¶é›†å„ç§è¯æ®ï¼ˆæ—¥å¿—ï¼‰æ¥æ‰¾å‡ºçœŸç›¸ï¼ˆé—®é¢˜åŸå› ï¼‰ã€‚å¥½çš„è°ƒè¯•é…ç½®èƒ½è®©ä½ å¿«é€Ÿæ‰¾åˆ°çº¿ç´¢ã€‚

**ğŸ¯ è°ƒè¯•é…ç½®ç›®æ ‡**
```
è®©é—®é¢˜"æ— æ‰€éå½¢"ï¼š
â€¢ æ•°æ®æµå‘æ¸…æ™°å¯è§
â€¢ é”™è¯¯ä¿¡æ¯è¯¦ç»†æ˜ç¡®  
â€¢ æ€§èƒ½ç“¶é¢ˆä¸€ç›®äº†ç„¶
â€¢ é…ç½®é—®é¢˜å¿«é€Ÿå®šä½
```

### 6.2 è¾“å‡ºæ’ä»¶è°ƒè¯•é…ç½®


**ğŸ” stdoutè°ƒè¯•è¾“å‡º**
```ruby
# åœ¨ç®¡é“é…ç½®ä¸­æ·»åŠ è°ƒè¯•è¾“å‡º
output {
  # ä¸»è¦è¾“å‡ºåˆ°elasticsearch
  elasticsearch {
    hosts => ["localhost:9200"]
    index => "logs-%{+YYYY.MM.dd}"
  }
  
  # è°ƒè¯•è¾“å‡ºåˆ°æ§åˆ¶å°  
  stdout {
    codec => rubydebug {
      metadata => true
    }
  }
}
```

**ğŸ“Š rubydebugæ ¼å¼è¯´æ˜**
```ruby
# rubydebugè¾“å‡ºæ ¼å¼
{
       "message" => "User login successful",
      "@version" => "1",
    "@timestamp" => 2025-09-21T14:30:00.000Z,
         "host" => "web-server-01",
         "user" => "john.doe",
       "action" => "login",
      "@metadata" => {
        "beat" => "filebeat",
        "type" => "log"
      }
}
```

### 6.3 æ¡ä»¶è°ƒè¯•è¾“å‡º


**ğŸ¯ æœ‰é€‰æ‹©çš„è°ƒè¯•**
```ruby
output {
  # åªè°ƒè¯•é”™è¯¯äº‹ä»¶
  if [level] == "ERROR" {
    stdout {
      codec => rubydebug
    }
  }
  
  # åªè°ƒè¯•ç‰¹å®šæ¥æº
  if [source] =~ /nginx/ {
    file {
      path => "/tmp/nginx-debug.log"
      codec => json_lines
    }
  }
}
```

### 6.4 è¿‡æ»¤å™¨è°ƒè¯•æŠ€å·§


**ğŸ” åœ¨è¿‡æ»¤å™¨ä¸­æ·»åŠ è°ƒè¯•ä¿¡æ¯**
```ruby
filter {
  grok {
    match => { "message" => "%{COMMONAPACHELOG}" }
  }
  
  # æ·»åŠ è°ƒè¯•æ ‡è®°
  mutate {
    add_field => { "debug_stage" => "after_grok" }
  }
  
  # è§£æå¤±è´¥çš„è°ƒè¯•
  if "_grokparsefailure" in [tags] {
    mutate {
      add_field => { "debug_info" => "Grok parsing failed for: %{message}" }
    }
  }
}
```

**ğŸ“ è°ƒè¯•æ—¥å¿—çº§åˆ«è®¾ç½®**
```yaml
# è°ƒè¯•æ—¶çš„æ¨èé…ç½®
log.level: debug

# æˆ–è€…æ›´è¯¦ç»†
log.level: trace
```

### 6.5 å®ç”¨è°ƒè¯•å‘½ä»¤ç»„åˆ


**âš¡ å¿«é€Ÿè°ƒè¯•å¯åŠ¨**
```bash
# è¯¦ç»†è°ƒè¯•æ¨¡å¼å¯åŠ¨
bin/logstash -f config/debug.conf --log.level=debug --config.reload.automatic

# è¾“å‡ºåˆ°æ–‡ä»¶ä¾¿äºåˆ†æ
bin/logstash -f config/debug.conf --log.level=debug > debug.log 2>&1

# åªæµ‹è¯•é…ç½®ä¸å®é™…è¿è¡Œ
bin/logstash -f config/debug.conf --config.test_and_exit
```

**ğŸ“Š è°ƒè¯•æ£€æŸ¥æ¸…å•**

- [ ] **é…ç½®è¯­æ³•æ£€æŸ¥**: `--config.test_and_exit`
- [ ] **æ•°æ®æµæ£€æŸ¥**: æ·»åŠ `stdout`è¾“å‡º
- [ ] **é”™è¯¯å¤„ç†æ£€æŸ¥**: æ£€æŸ¥`_grokparsefailure`ç­‰æ ‡ç­¾
- [ ] **æ€§èƒ½æ£€æŸ¥**: å¼€å¯`slowlog`
- [ ] **å†…å­˜æ£€æŸ¥**: ç›‘æ§é˜Ÿåˆ—å¤§å°

---

## 7. ğŸ“ˆ æ€§èƒ½ç›‘æ§æ—¥å¿—é…ç½®


### 7.1 æ€§èƒ½ç›‘æ§çš„é‡è¦æ€§


**ğŸï¸ æ€§èƒ½ç›‘æ§ç±»æ¯”**
> æ€§èƒ½ç›‘æ§å°±åƒæ±½è½¦çš„ä»ªè¡¨ç›˜ï¼Œå‘Šè¯‰ä½ å¼•æ“è½¬é€Ÿã€æ²¹è€—ã€æ¸©åº¦ç­‰å…³é”®æŒ‡æ ‡ã€‚æ²¡æœ‰è¿™äº›æ•°æ®ï¼Œä½ å°±ä¸çŸ¥é“è½¦å­çš„å¥åº·çŠ¶å†µã€‚

**ğŸ¯ ç›‘æ§ç›®æ ‡**
```
æ€§èƒ½å¥åº·æŒ‡æ ‡ï¼š
â€¢ äº‹ä»¶å¤„ç†é€Ÿåº¦ï¼ˆthroughputï¼‰
â€¢ å†…å­˜ä½¿ç”¨æƒ…å†µ
â€¢ é˜Ÿåˆ—å †ç§¯æƒ…å†µ
â€¢ æ’ä»¶æ‰§è¡Œæ—¶é—´
â€¢ é”™è¯¯ç‡ç»Ÿè®¡
```

### 7.2 æ€§èƒ½ç›‘æ§é…ç½®


**âš™ï¸ åŸºç¡€ç›‘æ§é…ç½®**
```yaml
# logstash.ymlä¸­çš„ç›‘æ§é…ç½®
monitoring.enabled: true
monitoring.elasticsearch.hosts: ["http://localhost:9200"]
monitoring.collection.interval: 10s

# å¼€å¯è¯¦ç»†ç»Ÿè®¡
node.stats.enabled: true
```

**ğŸ“Š ç›‘æ§æ—¥å¿—æ ¼å¼é…ç½®**
```properties
# log4j2.propertiesä¸­æ·»åŠ æ€§èƒ½ç›‘æ§æ—¥å¿—
logger.monitoring.name = logstash.monitoring
logger.monitoring.level = info
logger.monitoring.appenderRef.rolling.ref = monitoring_rolling

# ä¸“ç”¨çš„ç›‘æ§æ—¥å¿—æ–‡ä»¶
appender.monitoring.type = RollingFile
appender.monitoring.name = monitoring_rolling
appender.monitoring.fileName = ${sys:ls.logs}/logstash-monitoring.log
```

### 7.3 å…³é”®æ€§èƒ½æŒ‡æ ‡


**ğŸ“ˆ æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡è§£è¯»**

| æŒ‡æ ‡ | **å«ä¹‰** | **æ­£å¸¸èŒƒå›´** | **å¼‚å¸¸ä¿¡å·** |
|------|----------|-------------|-------------|
| `events.in` | `è¾“å…¥äº‹ä»¶æ•°/ç§’` | `æ ¹æ®ä¸šåŠ¡éœ€æ±‚` | `çªç„¶ä¸‹é™ä¸º0` |
| `events.out` | `è¾“å‡ºäº‹ä»¶æ•°/ç§’` | `â‰ˆ events.in` | `è¿œå°äºevents.in` |
| `queue.events` | `é˜Ÿåˆ—ä¸­äº‹ä»¶æ•°` | `< 1000` | `æŒç»­å¢é•¿` |
| `cpu.percent` | `CPUä½¿ç”¨ç‡` | `< 80%` | `> 90%` |
| `mem.heap_used_percent` | `å †å†…å­˜ä½¿ç”¨ç‡` | `< 85%` | `> 95%` |

**ğŸ” æ€§èƒ½æ—¥å¿—ç¤ºä¾‹**
```json
{
  "timestamp": "2025-09-21T14:30:00.000Z",
  "logstash": {
    "events": {
      "in": 1000,
      "filtered": 950,  
      "out": 950
    },
    "jvm": {
      "mem": {
        "heap_used_percent": 45
      }
    },
    "process": {
      "cpu": {
        "percent": 25
      }
    }
  }
}
```

### 7.4 æ€§èƒ½å‘Šè­¦é…ç½®


**âš ï¸ å…³é”®æŒ‡æ ‡å‘Šè­¦**
```yaml
# åœ¨logstash.ymlä¸­é…ç½®å‘Šè­¦é˜ˆå€¼
monitoring.cluster_uuid: "production_cluster"

# é€šè¿‡æ—¥å¿—çº§åˆ«æ§åˆ¶å‘Šè­¦
```

**ğŸš¨ å‘Šè­¦è§„åˆ™ç¤ºä¾‹**
```properties
# é«˜å†…å­˜ä½¿ç”¨å‘Šè­¦
logger.memory_alert.name = logstash.memory
logger.memory_alert.level = warn

# é˜Ÿåˆ—å †ç§¯å‘Šè­¦  
logger.queue_alert.name = logstash.queue
logger.queue_alert.level = error
```

---

## 8. ğŸ› ï¸ å®ç”¨è°ƒè¯•æŠ€å·§


### 8.1 åˆ†å±‚è°ƒè¯•ç­–ç•¥


**ğŸ¯ è°ƒè¯•é‡‘å­—å¡”**
```
                  è¯¦ç»†è°ƒè¯•
                 â†—          â†–
               é—®é¢˜å®šä½ â† â†’ å¿«é€Ÿæ£€æŸ¥
              â†—                    â†–
            é…ç½®éªŒè¯ â† â†’ æ€§èƒ½ç›‘æ§ â† â†’ æ—¥å¿—åˆ†æ
           â†—                                  â†–
        åŸºç¡€æ£€æŸ¥ â† â†’ ç½‘ç»œè¿æ¥ â† â†’ èµ„æºæ£€æŸ¥ â† â†’ æƒé™æ£€æŸ¥
```

### 8.2 å¸¸è§é—®é¢˜çš„è°ƒè¯•é…ç½®


**ğŸ”§ æ•°æ®ä¸è¿›æ¥çš„è°ƒè¯•**
```yaml
# å¢åŠ è¾“å…¥æ’ä»¶è°ƒè¯•
log.level: debug

# åœ¨è¾“å…¥æ’ä»¶æ·»åŠ è°ƒè¯•ä¿¡æ¯
```

```ruby
input {
  file {
    path => "/var/log/*.log"
    start_position => "beginning"
    stat_interval => 1  # é™ä½æ£€æŸ¥é—´éš”
    discover_interval => 5
  }
}

filter {
  # æ·»åŠ è°ƒè¯•æ ‡è®°
  mutate {
    add_field => { "debug_input_received" => "%{@timestamp}" }
  }
}

output {
  stdout { codec => rubydebug }
}
```

**ğŸ”§ æ•°æ®è§£æå¤±è´¥çš„è°ƒè¯•**
```ruby
filter {
  grok {
    match => { "message" => "%{COMMONAPACHELOG}" }
    tag_on_failure => ["grok_parse_failure"]
  }
  
  # è§£æå¤±è´¥æ—¶æ·»åŠ åŸå§‹æ¶ˆæ¯
  if "grok_parse_failure" in [tags] {
    mutate {
      add_field => { 
        "original_message" => "%{message}"
        "parse_failure_reason" => "Grok pattern mismatch"
      }
    }
  }
}
```

### 8.3 æ€§èƒ½é—®é¢˜è°ƒè¯•


**ğŸ“Š æ€§èƒ½ç“¶é¢ˆå®šä½**
```yaml
# å¼€å¯è¯¦ç»†çš„æ€§èƒ½ç›‘æ§
slowlog.threshold.warn: 1s
slowlog.threshold.info: 500ms
slowlog.threshold.debug: 100ms

# ç®¡é“æ€§èƒ½é…ç½®
pipeline.workers: 4
pipeline.batch.size: 125
pipeline.batch.delay: 50
```

**ğŸ® å®é™…è°ƒè¯•å·¥ä½œæµ**
```
1. åŸºç¡€æ£€æŸ¥
   â”œâ”€â”€ é…ç½®è¯­æ³•: bin/logstash --config.test_and_exit
   â”œâ”€â”€ æ—¥å¿—çº§åˆ«: è®¾ç½®ä¸ºdebug
   â””â”€â”€ è¿æ¥æµ‹è¯•: telnet/curlæµ‹è¯•

2. æ•°æ®æµæ£€æŸ¥  
   â”œâ”€â”€ æ·»åŠ stdoutè¾“å‡º
   â”œâ”€â”€ æ£€æŸ¥è¾“å…¥æº
   â””â”€â”€ éªŒè¯è¿‡æ»¤å™¨

3. æ€§èƒ½åˆ†æ
   â”œâ”€â”€ å¼€å¯slowlog
   â”œâ”€â”€ ç›‘æ§èµ„æºä½¿ç”¨
   â””â”€â”€ è°ƒæ•´ç®¡é“å‚æ•°

4. é—®é¢˜å®šä½
   â”œâ”€â”€ åˆ†æé”™è¯¯æ—¥å¿—
   â”œâ”€â”€ æŸ¥çœ‹å †æ ˆè·Ÿè¸ª
   â””â”€â”€ æ£€æŸ¥å¤–éƒ¨ä¾èµ–
```

### 8.4 ç”Ÿäº§ç¯å¢ƒè°ƒè¯•æœ€ä½³å®è·µ


**âš¡ å®‰å…¨è°ƒè¯•æ–¹æ³•**
```bash
# 1. å…ˆåœ¨æµ‹è¯•ç¯å¢ƒå¤ç°
bin/logstash -f config/test.conf --log.level=debug

# 2. ç”Ÿäº§ç¯å¢ƒä¸´æ—¶è°ƒè¯•ï¼ˆè‡ªåŠ¨æ¢å¤ï¼‰
bin/logstash -f config/prod.conf --log.level=debug &
sleep 300  # 5åˆ†é’Ÿåæ¢å¤
kill $!
bin/logstash -f config/prod.conf --log.level=info &
```

**ğŸ¯ è°ƒè¯•æ£€æŸ¥æ¸…å•**

âœ… **è°ƒè¯•å‰å‡†å¤‡ï¼š**
- [ ] å¤‡ä»½å½“å‰é…ç½®
- [ ] å‡†å¤‡æµ‹è¯•æ•°æ®
- [ ] è®¾ç½®æ—¥å¿—è½®è½¬
- [ ] é€šçŸ¥ç›¸å…³äººå‘˜

âœ… **è°ƒè¯•è¿‡ç¨‹ï¼š**
- [ ] ä»æœ€ç®€é…ç½®å¼€å§‹
- [ ] é€æ­¥æ·»åŠ å¤æ‚åŠŸèƒ½
- [ ] è®°å½•æ¯ä¸ªæ­¥éª¤çš„ç»“æœ
- [ ] ä¿å­˜é‡è¦çš„è°ƒè¯•æ—¥å¿—

âœ… **è°ƒè¯•åæ¸…ç†ï¼š**
- [ ] æ¢å¤ç”Ÿäº§æ—¥å¿—çº§åˆ«
- [ ] æ¸…ç†ä¸´æ—¶è°ƒè¯•æ–‡ä»¶
- [ ] æ›´æ–°æ–‡æ¡£å’ŒçŸ¥è¯†åº“
- [ ] æ€»ç»“ç»éªŒæ•™è®­

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æ—¥å¿—çº§åˆ«ï¼šæ§åˆ¶ä¿¡æ¯è¯¦ç»†ç¨‹åº¦çš„å¼€å…³ï¼Œä»TRACEåˆ°FATAL
ğŸ”¸ log.levelï¼šå…¨å±€æ—¥å¿—çº§åˆ«æ§åˆ¶ï¼Œå½±å“æ‰€æœ‰ç»„ä»¶è¾“å‡º
ğŸ”¸ log4j2.propertiesï¼šç²¾ç»†åŒ–æ—¥å¿—é…ç½®ï¼Œæ§åˆ¶æ ¼å¼å’Œè¾“å‡ºä½ç½®
ğŸ”¸ slowlogï¼šæ€§èƒ½ç›‘æ§å·¥å…·ï¼Œè®°å½•å¤„ç†æ—¶é—´è¿‡é•¿çš„æ“ä½œ
ğŸ”¸ pipeline.separate_logsï¼šç®¡é“æ—¥å¿—åˆ†ç¦»ï¼Œä¾¿äºç®¡ç†å’Œé—®é¢˜å®šä½
ğŸ”¸ è°ƒè¯•è¾“å‡ºï¼šé€šè¿‡stdoutã€æ–‡ä»¶ç­‰æ–¹å¼æŸ¥çœ‹æ•°æ®æµå’Œå¤„ç†ç»“æœ
ğŸ”¸ æ€§èƒ½ç›‘æ§ï¼šå®æ—¶ç›‘æ§ç³»ç»Ÿå¥åº·çŠ¶å†µå’Œå…³é”®æŒ‡æ ‡
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ è°ƒè¯•çš„æœ¬è´¨**
```
è°ƒè¯• = è®©é—®é¢˜å˜å¾—å¯è§
â€¢ æ—¥å¿—æ˜¯çª—å£ï¼Œè®©æˆ‘ä»¬çœ‹åˆ°å†…éƒ¨å‘ç”Ÿäº†ä»€ä¹ˆ
â€¢ åˆé€‚çš„æ—¥å¿—çº§åˆ«å¹³è¡¡äº†ä¿¡æ¯é‡å’Œæ€§èƒ½
â€¢ ç»“æ„åŒ–çš„æ—¥å¿—é…ç½®æé«˜äº†é—®é¢˜å®šä½æ•ˆç‡
```

**ğŸ”¹ æ€§èƒ½ç›‘æ§çš„ä»·å€¼**
```
é¢„é˜²èƒœäºæ²»ç–—ï¼š
â€¢ æå‰å‘ç°æ€§èƒ½é—®é¢˜
â€¢ é¿å…ç³»ç»Ÿå´©æºƒ
â€¢ æŒ‡å¯¼å®¹é‡è§„åˆ’
â€¢ ä¼˜åŒ–é…ç½®å‚æ•°
```

**ğŸ”¹ é…ç½®çš„è‰ºæœ¯**
```
å¥½çš„é…ç½®ç‰¹ç‚¹ï¼š
â€¢ å¼€å‘ç¯å¢ƒè¯¦ç»†ï¼Œç”Ÿäº§ç¯å¢ƒç²¾å‡†
â€¢ é‡è¦ä¿¡æ¯ä¸é—æ¼ï¼Œæ— å…³ä¿¡æ¯ä¸å¹²æ‰°
â€¢ ä¾¿äºè‡ªåŠ¨åŒ–å¤„ç†å’Œåˆ†æ
â€¢ å…·æœ‰è‰¯å¥½çš„å¯ç»´æŠ¤æ€§
```

### 9.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ å¼€å‘é˜¶æ®µåº”ç”¨**
- **å¿«é€Ÿè°ƒè¯•**ï¼šè¯¦ç»†çš„DEBUGæ—¥å¿—å¸®åŠ©å®šä½é—®é¢˜
- **é…ç½®éªŒè¯**ï¼šé€šè¿‡æ—¥å¿—ç¡®è®¤é…ç½®æ˜¯å¦ç”Ÿæ•ˆ
- **æ€§èƒ½ä¼˜åŒ–**ï¼šslowlogå¸®åŠ©æ‰¾å‡ºæ€§èƒ½ç“¶é¢ˆ

**ğŸ¯ ç”Ÿäº§ç¯å¢ƒåº”ç”¨**
- **é—®é¢˜å®šä½**ï¼šåˆ†ç¦»çš„ç®¡é“æ—¥å¿—å¿«é€Ÿå®šä½é—®é¢˜æ¥æº
- **ç›‘æ§å‘Šè­¦**ï¼šå…³é”®æŒ‡æ ‡è¶…é˜ˆå€¼æ—¶åŠæ—¶å‘ç°
- **å®¹é‡è§„åˆ’**ï¼šåŸºäºå†å²æ•°æ®è¿›è¡Œèµ„æºè§„åˆ’

**ğŸ¯ è¿ç»´ç®¡ç†**
- **æ•…éšœæ’æŸ¥**ï¼šç»“æ„åŒ–æ—¥å¿—æé«˜æ’æŸ¥æ•ˆç‡
- **æ€§èƒ½åˆ†æ**ï¼šå¤šç»´åº¦ç›‘æ§æ•°æ®æ”¯æŒå†³ç­–
- **å›¢é˜Ÿåä½œ**ï¼šæ¸…æ™°çš„æ—¥å¿—åˆ†ç±»ä¾¿äºåˆ†å·¥

### 9.4 æœ€ä½³å®è·µæ€»ç»“


**ğŸ“ é…ç½®å»ºè®®**
```
å¼€å‘ç¯å¢ƒï¼š
â”œâ”€â”€ log.level: debug
â”œâ”€â”€ slowlogé˜ˆå€¼è®¾ç½®è¾ƒä½
â”œâ”€â”€ å¼€å¯æ‰€æœ‰è°ƒè¯•è¾“å‡º
â””â”€â”€ è¯¦ç»†çš„é”™è¯¯è·Ÿè¸ª

ç”Ÿäº§ç¯å¢ƒï¼š
â”œâ”€â”€ log.level: info
â”œâ”€â”€ å¼€å¯æ€§èƒ½ç›‘æ§
â”œâ”€â”€ é…ç½®æ—¥å¿—è½®è½¬
â””â”€â”€ è®¾ç½®å…³é”®å‘Šè­¦

é—®é¢˜æ’æŸ¥ï¼š
â”œâ”€â”€ ä¸´æ—¶æå‡æ—¥å¿—çº§åˆ«
â”œâ”€â”€ å¼€å¯ç‰¹å®šç»„ä»¶è°ƒè¯•
â”œâ”€â”€ æ·»åŠ ä¸´æ—¶è°ƒè¯•è¾“å‡º
â””â”€â”€ å®ŒæˆååŠæ—¶æ¢å¤
```

**âš¡ æ•ˆç‡æå‡æŠ€å·§**
- ä½¿ç”¨ç®¡é“åˆ†ç¦»æ—¥å¿—å‡å°‘ä¿¡æ¯å¹²æ‰°
- é…ç½®åˆé€‚çš„slowlogé˜ˆå€¼è‡ªåŠ¨å‘ç°æ€§èƒ½é—®é¢˜
- å»ºç«‹æ ‡å‡†åŒ–çš„è°ƒè¯•æµç¨‹å’Œæ£€æŸ¥æ¸…å•
- å®šæœŸåˆ†ææ€§èƒ½æ•°æ®æŒ‡å¯¼ä¼˜åŒ–æ–¹å‘

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- è°ƒè¯•é…ç½®è¦åˆ†å±‚ï¼Œå¼€å‘è¯¦ç»†ç”Ÿäº§ç®€
- æ€§èƒ½ç›‘æ§ä¸å¯å°‘ï¼Œslowlogé˜ˆå€¼è¦è®¾å¥½  
- ç®¡é“åˆ†ç¦»ä¾¿ç®¡ç†ï¼Œé—®é¢˜å®šä½æ•ˆç‡é«˜
- æ—¥å¿—è½®è½¬é˜²çˆ†æ»¡ï¼Œå‘Šè­¦æœºåˆ¶è¦å»ºå¥½

**ğŸ¯ ä¸€å¥è¯æ€»ç»“**
> å¥½çš„æ—¥å¿—é…ç½®æ˜¯Logstashè¿ç»´çš„çœ¼ç›ï¼Œè®©ä½ çœ‹å¾—è§æ•°æ®æµå‘ï¼Œæ‰¾å¾—åˆ°æ€§èƒ½ç“¶é¢ˆï¼Œå®šä½å¾—äº†å…·ä½“é—®é¢˜ã€‚