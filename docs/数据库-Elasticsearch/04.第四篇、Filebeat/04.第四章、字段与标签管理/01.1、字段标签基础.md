---
title: 1ã€å­—æ®µæ ‡ç­¾åŸºç¡€
---
## ğŸ“š ç›®å½•

1. [å­—æ®µä¸æ ‡ç­¾åŸºç¡€æ¦‚å¿µ](#1-å­—æ®µä¸æ ‡ç­¾åŸºç¡€æ¦‚å¿µ)
2. [è‡ªå®šä¹‰å­—æ®µè¯¦è§£](#2-è‡ªå®šä¹‰å­—æ®µè¯¦è§£)
3. [æ ‡ç­¾ç³»ç»Ÿç®¡ç†](#3-æ ‡ç­¾ç³»ç»Ÿç®¡ç†)
4. [å­—æ®µä½ç½®æ§åˆ¶](#4-å­—æ®µä½ç½®æ§åˆ¶)
5. [æ¡ä»¶å­—æ®µè®¾ç½®](#5-æ¡ä»¶å­—æ®µè®¾ç½®)
6. [å…ƒæ•°æ®å­—æ®µç®¡ç†](#6-å…ƒæ•°æ®å­—æ®µç®¡ç†)
7. [å®æˆ˜åº”ç”¨æ¡ˆä¾‹](#7-å®æˆ˜åº”ç”¨æ¡ˆä¾‹)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ å­—æ®µä¸æ ‡ç­¾åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯å­—æ®µä¸æ ‡ç­¾


**ğŸ”¸ ç®€å•ç†è§£**
æƒ³è±¡ä½ åœ¨æ•´ç†æ–‡ä»¶æŸœï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½éœ€è¦è´´ä¸Šæ ‡ç­¾æ–¹ä¾¿æŸ¥æ‰¾ã€‚Filebeatçš„å­—æ®µå’Œæ ‡ç­¾å°±æ˜¯è¿™ä¸ªé“ç†ï¼š

```
åŸå§‹æ—¥å¿—ï¼š[2025-09-21] ERROR Database connection failed
æ·»åŠ å­—æ®µåï¼š
{
  "@timestamp": "2025-09-21T14:30:00.000Z",
  "message": "[2025-09-21] ERROR Database connection failed",
  "log_level": "ERROR",        â† è‡ªå®šä¹‰å­—æ®µ
  "service": "database",       â† è‡ªå®šä¹‰å­—æ®µ
  "tags": ["production", "db"] â† æ ‡ç­¾
}
```

**ğŸ’¡ æ ¸å¿ƒä½œç”¨**
- **åˆ†ç±»æ ‡è¯†**ï¼šç»™æ—¥å¿—è´´ä¸Š"èº«ä»½è¯"ï¼ŒçŸ¥é“æ¥è‡ªå“ªé‡Œ
- **æœç´¢ä¾¿åˆ©**ï¼šåœ¨æˆåƒä¸Šä¸‡æ¡æ—¥å¿—ä¸­å¿«é€Ÿæ‰¾åˆ°æƒ³è¦çš„
- **ç»Ÿè®¡åˆ†æ**ï¼šæŒ‰ç…§å­—æ®µè¿›è¡Œæ•°æ®ç»Ÿè®¡å’Œåˆ†æ

### 1.2 å­—æ®µä¸æ ‡ç­¾çš„åŒºåˆ«


| ç‰¹å¾ | **å­—æ®µ(Fields)** | **æ ‡ç­¾(Tags)** |
|------|------------------|----------------|
| **æ€§è´¨** | `é”®å€¼å¯¹å½¢å¼` | `å­—ç¬¦ä¸²æ•°ç»„` |
| **ç”¨é€”** | `å­˜å‚¨å…·ä½“æ•°æ®` | `åˆ†ç±»æ ‡è®°` |
| **ç¤ºä¾‹** | `"level": "ERROR"` | `["web", "prod"]` |
| **æŸ¥è¯¢æ–¹å¼** | `level:ERROR` | `tags:web` |

**ğŸ” å®é™…åº”ç”¨åœºæ™¯**
```
æ—¥å¿—æ¥æºï¼šWebæœåŠ¡å™¨çš„é”™è¯¯æ—¥å¿—
è‡ªå®šä¹‰å­—æ®µï¼š
- server_name: "web-01"        # æœåŠ¡å™¨åç§°
- response_time: 500           # å“åº”æ—¶é—´
- status_code: 500             # HTTPçŠ¶æ€ç 

æ ‡ç­¾ï¼š
- tags: ["web", "error", "prod"]  # åˆ†ç±»æ ‡è®°
```

---

## 2. ğŸ› ï¸ è‡ªå®šä¹‰å­—æ®µè¯¦è§£


### 2.1 fieldså­—æ®µåŸºæœ¬ç”¨æ³•


**ğŸ”¸ åŸºç¡€é…ç½®è¯­æ³•**
```yaml
filebeat.inputs:
- type: log
  paths:
    - /var/log/app.log
  fields:                    # æ·»åŠ è‡ªå®šä¹‰å­—æ®µ
    service: "user-service"  # æœåŠ¡åç§°
    env: "production"        # ç¯å¢ƒæ ‡è¯†
    version: "v1.2.3"        # ç‰ˆæœ¬å·
```

**ğŸ’¡ é€šä¿—è§£é‡Š**
- `fields`å°±åƒç»™æ¯æ¡æ—¥å¿—è´´ä¸Šå›ºå®šçš„æ ‡ç­¾çº¸
- æ— è®ºæ—¥å¿—å†…å®¹æ˜¯ä»€ä¹ˆï¼Œè¿™äº›å­—æ®µéƒ½ä¼šè‡ªåŠ¨æ·»åŠ 
- å°±åƒå¿«é€’åŒ…è£¹ä¸Šçš„å‘ä»¶äººä¿¡æ¯ï¼Œæ¯ä¸ªåŒ…è£¹éƒ½æœ‰

### 2.2 ä¸åŒæ•°æ®ç±»å‹çš„å­—æ®µ


**ğŸ”¸ å­—ç¬¦ä¸²å­—æ®µ**
```yaml
fields:
  service_name: "order-api"      # æ–‡æœ¬ç±»å‹
  datacenter: "beijing"          # åœ°ç†ä½ç½®
```

**ğŸ”¸ æ•°å­—å­—æ®µ**
```yaml
fields:
  port: 8080                     # ç«¯å£å·
  max_connections: 1000          # æœ€å¤§è¿æ¥æ•°
  timeout: 30.5                  # è¶…æ—¶æ—¶é—´(æµ®ç‚¹æ•°)
```

**ğŸ”¸ å¸ƒå°”å­—æ®µ**
```yaml
fields:
  is_production: true            # æ˜¯å¦ç”Ÿäº§ç¯å¢ƒ
  debug_enabled: false           # æ˜¯å¦å¼€å¯è°ƒè¯•
```

**ğŸ”¸ å¤æ‚å¯¹è±¡å­—æ®µ**
```yaml
fields:
  server_info:                   # åµŒå¥—å¯¹è±¡
    hostname: "web-server-01"
    ip: "192.168.1.100"
    cpu_cores: 8
    memory_gb: 16
```

### 2.3 å­—æ®µçš„å®é™…åº”ç”¨


**ğŸ“Š åœºæ™¯ä¸€ï¼šå¤šæœåŠ¡æ—¥å¿—æ”¶é›†**
```yaml
# ç”¨æˆ·æœåŠ¡çš„é…ç½®
filebeat.inputs:
- type: log
  paths:
    - /opt/user-service/logs/*.log
  fields:
    service: "user-service"
    team: "backend"
    business_line: "user_management"

# è®¢å•æœåŠ¡çš„é…ç½®  
- type: log
  paths:
    - /opt/order-service/logs/*.log
  fields:
    service: "order-service"
    team: "backend"
    business_line: "transaction"
```

**âœ… æ•ˆæœå±•ç¤º**
```json
// ç”¨æˆ·æœåŠ¡æ—¥å¿—
{
  "message": "User login failed",
  "fields": {
    "service": "user-service",
    "team": "backend",
    "business_line": "user_management"
  }
}

// è®¢å•æœåŠ¡æ—¥å¿—
{
  "message": "Order created successfully", 
  "fields": {
    "service": "order-service",
    "team": "backend", 
    "business_line": "transaction"
  }
}
```

---

## 3. ğŸ·ï¸ æ ‡ç­¾ç³»ç»Ÿç®¡ç†


### 3.1 tagsæ ‡ç­¾åŸºç¡€ä½¿ç”¨


**ğŸ”¸ åŸºæœ¬è¯­æ³•**
```yaml
filebeat.inputs:
- type: log
  paths:
    - /var/log/nginx/access.log
  tags: ["nginx", "web", "access"]  # æ·»åŠ å¤šä¸ªæ ‡ç­¾
  
- type: log
  paths:
    - /var/log/nginx/error.log
  tags: ["nginx", "web", "error"]   # é”™è¯¯æ—¥å¿—ç”¨ä¸åŒæ ‡ç­¾
```

**ğŸ’¡ æ ‡ç­¾çš„ä½œç”¨**
- **å¿«é€Ÿç­›é€‰**ï¼š`tags:nginx` æ‰¾å‡ºæ‰€æœ‰nginxç›¸å…³æ—¥å¿—
- **æ‰¹é‡æ“ä½œ**ï¼šå¯¹å¸¦æœ‰ç‰¹å®šæ ‡ç­¾çš„æ—¥å¿—è¿›è¡Œç»Ÿä¸€å¤„ç†
- **å¯è§†åŒ–åˆ†ç»„**ï¼šåœ¨Kibanaä¸­æŒ‰æ ‡ç­¾åˆ†ç»„æ˜¾ç¤º

### 3.2 æ ‡ç­¾çš„åˆ†å±‚ç®¡ç†


**ğŸ”¸ æŒ‰ç¯å¢ƒåˆ†ç±»**
```yaml
# ç”Ÿäº§ç¯å¢ƒ
filebeat.inputs:
- type: log
  paths:
    - /var/log/app.log
  tags: ["production", "app", "critical"]

# æµ‹è¯•ç¯å¢ƒ  
- type: log
  paths:
    - /var/log/app.log
  tags: ["testing", "app", "debug"]
```

**ğŸ”¸ æŒ‰ä¸šåŠ¡æ¨¡å—åˆ†ç±»**
```yaml
# ç”¨æˆ·æ¨¡å—
- type: log
  paths:
    - /var/log/user/*.log
  tags: ["user-module", "backend", "auth"]

# æ”¯ä»˜æ¨¡å—
- type: log  
  paths:
    - /var/log/payment/*.log
  tags: ["payment-module", "backend", "transaction"]
```

### 3.3 æ ‡ç­¾å‘½åè§„èŒƒ


**âœ… æ¨èçš„å‘½åæ–¹å¼**
```yaml
tags: [
  "env-prod",           # ç¯å¢ƒï¼šenv-{ç¯å¢ƒå}
  "service-userapi",    # æœåŠ¡ï¼šservice-{æœåŠ¡å}  
  "team-backend",       # å›¢é˜Ÿï¼šteam-{å›¢é˜Ÿå}
  "level-error"         # çº§åˆ«ï¼šlevel-{çº§åˆ«}
]
```

**âŒ é¿å…çš„å‘½åæ–¹å¼**
```yaml
tags: [
  "ç”Ÿäº§ç¯å¢ƒ",           # é¿å…ä¸­æ–‡
  "User API Service",   # é¿å…ç©ºæ ¼
  "BACKEND-TEAM",       # é¿å…å…¨å¤§å†™
  "error!!!"            # é¿å…ç‰¹æ®Šç¬¦å·
]
```

---

## 4. ğŸ“ å­—æ®µä½ç½®æ§åˆ¶


### 4.1 fields_under_rootè¯¦è§£


**ğŸ”¸ é»˜è®¤å­—æ®µä½ç½®**
```yaml
filebeat.inputs:
- type: log
  paths:
    - /var/log/app.log
  fields:
    service: "user-api"
  fields_under_root: false    # é»˜è®¤å€¼ï¼Œå­—æ®µæ”¾åœ¨fieldså¯¹è±¡ä¸‹
```

**ç»“æœæ•°æ®ç»“æ„ï¼š**
```json
{
  "@timestamp": "2025-09-21T14:30:00.000Z",
  "message": "User login successful",
  "fields": {                    â† å­—æ®µè¢«åŒ…è£…åœ¨fieldså¯¹è±¡ä¸­
    "service": "user-api"
  }
}
```

**ğŸ”¸ å­—æ®µæå‡åˆ°æ ¹çº§åˆ«**
```yaml
filebeat.inputs:
- type: log
  paths:
    - /var/log/app.log
  fields:
    service: "user-api"
    env: "production"
  fields_under_root: true      # å­—æ®µæå‡åˆ°æ ¹çº§åˆ«
```

**ç»“æœæ•°æ®ç»“æ„ï¼š**
```json
{
  "@timestamp": "2025-09-21T14:30:00.000Z",
  "message": "User login successful",
  "service": "user-api",       â† ç›´æ¥åœ¨æ ¹çº§åˆ«
  "env": "production"          â† ç›´æ¥åœ¨æ ¹çº§åˆ«
}
```

### 4.2 å­—æ®µä½ç½®é€‰æ‹©æŒ‡å—


**ğŸ’¡ ä½•æ—¶ä½¿ç”¨ `fields_under_root: false`ï¼ˆé»˜è®¤ï¼‰**
- **å¤šæ•°æ®æº**ï¼šä¸åŒinputçš„å­—æ®µä¸ä¼šå†²çª
- **å­—æ®µéš”ç¦»**ï¼šä¿æŒè‡ªå®šä¹‰å­—æ®µçš„ç‹¬ç«‹æ€§
- **è§„èŒƒç®¡ç†**ï¼šä¾¿äºç»Ÿä¸€ç®¡ç†è‡ªå®šä¹‰å­—æ®µ

**ğŸ’¡ ä½•æ—¶ä½¿ç”¨ `fields_under_root: true`**
- **Elasticsearchæ¨¡æ¿**ï¼šéœ€è¦å­—æ®µç›´æ¥æ˜ å°„
- **æŸ¥è¯¢ä¾¿åˆ©**ï¼šç›´æ¥ä½¿ç”¨ `service:user-api` è€Œä¸æ˜¯ `fields.service:user-api`
- **å…¼å®¹æ€§**ï¼šä¸å…¶ä»–ç³»ç»Ÿé›†æˆæ—¶çš„å­—æ®µæ ¼å¼è¦æ±‚

### 4.3 å­—æ®µè¦†ç›–è§„åˆ™


**âš ï¸ é‡è¦ï¼šå­—æ®µè¦†ç›–ä¼˜å…ˆçº§**

```
ä¼˜å…ˆçº§ï¼ˆé«˜åˆ°ä½ï¼‰ï¼š
1. Processorå¤„ç†çš„å­—æ®µ
2. fields_under_rootä¸ºtrueçš„è‡ªå®šä¹‰å­—æ®µ  
3. åŸå§‹æ—¥å¿—è§£æå‡ºçš„å­—æ®µ
4. fields_under_rootä¸ºfalseçš„è‡ªå®šä¹‰å­—æ®µ
```

**ğŸ”¸ è¦†ç›–ç¤ºä¾‹**
```yaml
filebeat.inputs:
- type: log
  paths:
    - /var/log/app.log
  fields:
    host: "my-custom-host"     # è‡ªå®šä¹‰hostå­—æ®µ
  fields_under_root: true
```

å¦‚æœåŸå§‹æ—¥å¿—ä¸­å·²ç»æœ‰`host`å­—æ®µï¼Œè‡ªå®šä¹‰çš„ä¼šè¦†ç›–åŸå§‹çš„ã€‚

---

## 5. ğŸ›ï¸ æ¡ä»¶å­—æ®µè®¾ç½®


### 5.1 åŸºäºæ–‡ä»¶è·¯å¾„çš„æ¡ä»¶å­—æ®µ


**ğŸ”¸ ä¸åŒæ—¥å¿—æ–‡ä»¶æ·»åŠ ä¸åŒå­—æ®µ**
```yaml
filebeat.inputs:
- type: log
  paths:
    - /var/log/nginx/access.log
  fields:
    log_type: "access"
    service: "nginx"
  tags: ["nginx", "access"]

- type: log
  paths:
    - /var/log/nginx/error.log  
  fields:
    log_type: "error"
    service: "nginx"
    severity: "high"           # é”™è¯¯æ—¥å¿—æ·»åŠ ä¸¥é‡ç¨‹åº¦
  tags: ["nginx", "error"]
```

### 5.2 åŸºäºæ–‡ä»¶åæ¨¡å¼çš„å­—æ®µ


**ğŸ”¸ ä½¿ç”¨é€šé…ç¬¦å’Œå­—æ®µæ¨¡æ¿**
```yaml
filebeat.inputs:
- type: log
  paths:
    - /var/log/apps/*/access.log
  fields:
    log_type: "access"
    source_type: "application"
    
- type: log
  paths:
    - /var/log/apps/*/error.log
  fields:
    log_type: "error" 
    source_type: "application"
    alert_level: "warning"
```

### 5.3 åŸºäºæ—¥å¿—å†…å®¹çš„æ¡ä»¶å¤„ç†


**ğŸ”¸ ä½¿ç”¨Processorè¿›è¡Œæ¡ä»¶å­—æ®µæ·»åŠ **
```yaml
filebeat.inputs:
- type: log
  paths:
    - /var/log/app.log
  processors:
    - add_fields:                     # æ·»åŠ å­—æ®µå¤„ç†å™¨
        when:                         # æ¡ä»¶åˆ¤æ–­
          contains:
            message: "ERROR"          # å½“æ¶ˆæ¯åŒ…å«ERRORæ—¶
        fields:
          alert_required: true        # æ·»åŠ å‘Šè­¦å­—æ®µ
          priority: "high"

    - add_fields:
        when:
          contains:
            message: "INFO"
        fields:
          alert_required: false
          priority: "low"
```

---

## 6. ğŸ“Š å…ƒæ•°æ®å­—æ®µç®¡ç†


### 6.1 Filebeatè‡ªåŠ¨æ·»åŠ çš„å…ƒæ•°æ®


**ğŸ”¸ é»˜è®¤å…ƒæ•°æ®å­—æ®µ**
```json
{
  "@timestamp": "2025-09-21T14:30:00.000Z",    // æ—¶é—´æˆ³
  "@metadata": {                               // å…ƒæ•°æ®å¯¹è±¡
    "beat": "filebeat",                        // Beatç±»å‹
    "type": "_doc",                            // æ–‡æ¡£ç±»å‹
    "version": "8.10.0"                        // Filebeatç‰ˆæœ¬
  },
  "agent": {                                   // Agentä¿¡æ¯
    "type": "filebeat",
    "version": "8.10.0",
    "hostname": "web-server-01"
  },
  "log": {                                     // æ—¥å¿—æºä¿¡æ¯
    "file": {
      "path": "/var/log/app.log"              // æ–‡ä»¶è·¯å¾„
    },
    "offset": 12345                            // æ–‡ä»¶åç§»é‡
  }
}
```

### 6.2 æ§åˆ¶å…ƒæ•°æ®å­—æ®µ


**ğŸ”¸ ç¦ç”¨æŸäº›å…ƒæ•°æ®å­—æ®µ**
```yaml
filebeat.inputs:
- type: log
  paths:
    - /var/log/app.log
  fields_under_root: true
  publisher_pipeline.disable_host: true       # ç¦ç”¨hostå­—æ®µ
  
output.elasticsearch:
  hosts: ["localhost:9200"]
  pipeline: ""                                # ç¦ç”¨pipelineå…ƒæ•°æ®
```

### 6.3 è‡ªå®šä¹‰å…ƒæ•°æ®å­—æ®µ


**ğŸ”¸ æ·»åŠ ä¸šåŠ¡ç›¸å…³çš„å…ƒæ•°æ®**
```yaml
filebeat.inputs:
- type: log
  paths:
    - /var/log/app.log
  fields:
    # ä¸šåŠ¡å…ƒæ•°æ®
    business_unit: "e-commerce"
    cost_center: "IT-001"
    data_classification: "internal"
    retention_policy: "90days"
  fields_under_root: false
```

---

## 7. ğŸ› ï¸ å®æˆ˜åº”ç”¨æ¡ˆä¾‹


### 7.1 ç”µå•†ç³»ç»Ÿæ—¥å¿—ç®¡ç†æ¡ˆä¾‹


**ğŸ“‹ ä¸šåŠ¡åœºæ™¯**
```
ç³»ç»Ÿæ¶æ„ï¼š
â”œâ”€â”€ ç”¨æˆ·æœåŠ¡ (user-service)
â”œâ”€â”€ è®¢å•æœåŠ¡ (order-service)  
â”œâ”€â”€ æ”¯ä»˜æœåŠ¡ (payment-service)
â””â”€â”€ åº“å­˜æœåŠ¡ (inventory-service)

éœ€æ±‚ï¼š
- æŒ‰æœåŠ¡åˆ†ç±»æ—¥å¿—
- æŒ‰ç¯å¢ƒåŒºåˆ†ï¼ˆå¼€å‘/æµ‹è¯•/ç”Ÿäº§ï¼‰
- æŒ‰æ—¥å¿—çº§åˆ«æ ‡è®°
- æ·»åŠ ä¸šåŠ¡æ ‡è¯†å­—æ®µ
```

**ğŸ”§ é…ç½®å®ç°**
```yaml
filebeat.inputs:
# ç”¨æˆ·æœåŠ¡æ—¥å¿—
- type: log
  paths:
    - /opt/ecommerce/user-service/logs/*.log
  fields:
    service_name: "user-service"
    business_domain: "user-management"
    team: "user-team"
    environment: "production"
    criticality: "high"
  tags: ["ecommerce", "user", "backend", "prod"]
  fields_under_root: true

# è®¢å•æœåŠ¡æ—¥å¿—  
- type: log
  paths:
    - /opt/ecommerce/order-service/logs/*.log
  fields:
    service_name: "order-service"
    business_domain: "transaction"
    team: "order-team" 
    environment: "production"
    criticality: "critical"
  tags: ["ecommerce", "order", "backend", "prod"]
  fields_under_root: true

# æ”¯ä»˜æœåŠ¡æ—¥å¿—
- type: log
  paths:
    - /opt/ecommerce/payment-service/logs/*.log
  fields:
    service_name: "payment-service"
    business_domain: "financial"
    team: "payment-team"
    environment: "production"
    criticality: "critical"
    compliance: "pci-dss"               # åˆè§„æ ‡è¯†
  tags: ["ecommerce", "payment", "backend", "prod", "financial"]
  fields_under_root: true
```

### 7.2 å¤šç¯å¢ƒæ—¥å¿—ç®¡ç†


**ğŸ¯ åœºæ™¯éœ€æ±‚**
- å¼€å‘ç¯å¢ƒï¼šè¯¦ç»†è°ƒè¯•ä¿¡æ¯
- æµ‹è¯•ç¯å¢ƒï¼šåŠŸèƒ½æµ‹è¯•æ ‡è®°
- ç”Ÿäº§ç¯å¢ƒï¼šå…³é”®ä¸šåŠ¡ç›‘æ§

**é…ç½®ç¤ºä¾‹ï¼š**

```yaml
# å¼€å‘ç¯å¢ƒé…ç½®
filebeat.inputs:
- type: log
  paths:
    - /var/log/app-dev/*.log
  fields:
    environment: "development"
    debug_level: "verbose"
    team: "dev-team"
    cost_tracking: false
  tags: ["dev", "debug", "non-critical"]
  
# ç”Ÿäº§ç¯å¢ƒé…ç½®  
- type: log
  paths:
    - /var/log/app-prod/*.log
  fields:
    environment: "production"
    monitoring_enabled: true
    sla_tracking: true
    alert_threshold: "error"
    cost_tracking: true
  tags: ["prod", "critical", "monitored"]
  fields_under_root: true
```

### 7.3 æ—¥å¿—å‘Šè­¦å­—æ®µè®¾ç½®


**ğŸš¨ å‘Šè­¦ç›¸å…³å­—æ®µé…ç½®**
```yaml
filebeat.inputs:
- type: log
  paths:
    - /var/log/critical-app/*.log
  processors:
    # é”™è¯¯çº§åˆ«æ—¥å¿—æ·»åŠ å‘Šè­¦å­—æ®µ
    - add_fields:
        when:
          or:
            - contains:
                message: "ERROR"
            - contains:
                message: "FATAL"
        fields:
          alert_required: true
          alert_level: "high"
          notification_channel: "slack-alerts"
          escalation_required: true
        target: "alert_metadata"

    # è­¦å‘Šçº§åˆ«æ—¥å¿—
    - add_fields:
        when:
          contains:
            message: "WARN"
        fields:
          alert_required: true
          alert_level: "medium"
          notification_channel: "email"
          escalation_required: false
        target: "alert_metadata"
```

**ğŸ“Š ç»“æœæ•°æ®ç¤ºä¾‹**
```json
{
  "message": "ERROR: Database connection failed",
  "service_name": "user-service",
  "environment": "production",
  "alert_metadata": {
    "alert_required": true,
    "alert_level": "high", 
    "notification_channel": "slack-alerts",
    "escalation_required": true
  }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ è‡ªå®šä¹‰å­—æ®µï¼šç»™æ—¥å¿—æ·»åŠ ä¸šåŠ¡æ ‡è¯†ä¿¡æ¯ï¼Œæ–¹ä¾¿åˆ†ç±»å’ŒæŸ¥è¯¢
ğŸ”¸ æ ‡ç­¾ç³»ç»Ÿï¼šç”¨äºå¿«é€Ÿåˆ†ç±»å’Œç­›é€‰ï¼Œæ”¯æŒå¤šæ ‡ç­¾ç»„åˆ
ğŸ”¸ å­—æ®µä½ç½®ï¼šæ§åˆ¶å­—æ®µåœ¨JSONä¸­çš„ä½ç½®å±‚çº§
ğŸ”¸ æ¡ä»¶è®¾ç½®ï¼šåŸºäºä¸åŒæ¡ä»¶åŠ¨æ€æ·»åŠ å­—æ®µ
ğŸ”¸ å…ƒæ•°æ®ç®¡ç†ï¼šæ§åˆ¶ç³»ç»Ÿè‡ªåŠ¨æ·»åŠ çš„å…ƒæ•°æ®å­—æ®µ
```

### 8.2 å®é™…åº”ç”¨è¦ç‚¹


**âœ… æœ€ä½³å®è·µ**
- **å­—æ®µå‘½å**ï¼šä½¿ç”¨æœ‰æ„ä¹‰çš„å­—æ®µåï¼Œéµå¾ªå‘½åè§„èŒƒ
- **æ ‡ç­¾è§„åˆ’**ï¼šå»ºç«‹ç»Ÿä¸€çš„æ ‡ç­¾åˆ†ç±»ä½“ç³»
- **å­—æ®µç²¾ç®€**ï¼šåªæ·»åŠ å¿…è¦çš„å­—æ®µï¼Œé¿å…å†—ä½™
- **ç¯å¢ƒåŒºåˆ†**ï¼šä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒçš„å­—æ®µé…ç½®

**âŒ å¸¸è§é”™è¯¯**
- å­—æ®µåä½¿ç”¨ä¸­æ–‡æˆ–ç‰¹æ®Šå­—ç¬¦
- æ ‡ç­¾è¿‡å¤šå¯¼è‡´æŸ¥è¯¢å¤æ‚
- å­—æ®µè¦†ç›–å¯¼è‡´æ•°æ®ä¸¢å¤±
- ç¼ºä¹ç»Ÿä¸€çš„å­—æ®µç®¡ç†è§„èŒƒ

### 8.3 é…ç½®æ£€æŸ¥æ¸…å•


**ğŸ“‹ é…ç½®å‰æ£€æŸ¥**
- [ ] ç¡®å®šå­—æ®µçš„ä¸šåŠ¡å«ä¹‰å’Œç”¨é€”
- [ ] è§„åˆ’æ ‡ç­¾çš„åˆ†ç±»ä½“ç³»
- [ ] é€‰æ‹©åˆé€‚çš„å­—æ®µä½ç½®(`fields_under_root`)
- [ ] è€ƒè™‘å­—æ®µè¦†ç›–çš„å½±å“
- [ ] è®¾è®¡æ¡ä»¶å­—æ®µçš„é€»è¾‘

**ğŸ” é…ç½®åéªŒè¯**
- [ ] æ£€æŸ¥Elasticsearchä¸­çš„å­—æ®µæ˜ å°„
- [ ] éªŒè¯å­—æ®µå€¼çš„å‡†ç¡®æ€§
- [ ] æµ‹è¯•åŸºäºå­—æ®µçš„æŸ¥è¯¢åŠŸèƒ½
- [ ] ç¡®è®¤æ ‡ç­¾çš„ç­›é€‰æ•ˆæœ

**æ ¸å¿ƒè®°å¿†**ï¼š
- **å­—æ®µ**æ˜¯ç»™æ—¥å¿—è´´æ ‡ç­¾ï¼Œ**æ ‡ç­¾**æ˜¯ç»™æ—¥å¿—åˆ†ç±»åˆ«
- **fields_under_root**å†³å®šå­—æ®µçš„"å®¶åº­åœ°å€"
- **æ¡ä»¶å­—æ®µ**è®©é…ç½®æ›´æ™ºèƒ½ï¼Œ**å…ƒæ•°æ®**æä¾›ç³»ç»Ÿä¿¡æ¯
- **å®æˆ˜åº”ç”¨**è¦ç»“åˆä¸šåŠ¡éœ€æ±‚ï¼Œä¸èƒ½ä¸ºäº†é…ç½®è€Œé…ç½®