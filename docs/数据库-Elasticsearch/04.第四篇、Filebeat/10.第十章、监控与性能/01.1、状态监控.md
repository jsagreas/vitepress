---
title: 1ã€çŠ¶æ€ç›‘æ§
---
## ğŸ“š ç›®å½•

1. [ç›‘æ§åŸºç¡€æ¦‚å¿µ](#1-ç›‘æ§åŸºç¡€æ¦‚å¿µ)
2. [å†…ç½®ç›‘æ§åŠŸèƒ½](#2-å†…ç½®ç›‘æ§åŠŸèƒ½)
3. [HTTPç›‘æ§ç«¯ç‚¹](#3-HTTPç›‘æ§ç«¯ç‚¹)
4. [çŠ¶æ€æ£€æŸ¥å‘½ä»¤](#4-çŠ¶æ€æ£€æŸ¥å‘½ä»¤)
5. [X-Packç›‘æ§é›†æˆ](#5-X-Packç›‘æ§é›†æˆ)
6. [Prometheusé›†æˆ](#6-Prometheusé›†æˆ)
7. [å®è·µåº”ç”¨æ¡ˆä¾‹](#7-å®è·µåº”ç”¨æ¡ˆä¾‹)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” ç›‘æ§åŸºç¡€æ¦‚å¿µ


### 1.1 ä¸ºä»€ä¹ˆéœ€è¦ç›‘æ§Filebeat


**ğŸ’¡ æ ¸å¿ƒç†è§£**
> æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ´¾äº†ä¸€ä¸ªå¿«é€’å‘˜(Filebeat)å»é€åŒ…è£¹(æ—¥å¿—)ï¼Œä½†ä½ ä¸çŸ¥é“ä»–æ˜¯å¦æŒ‰æ—¶é€è¾¾ã€æ˜¯å¦é‡åˆ°äº†å›°éš¾ã€‚ç›‘æ§å°±æ˜¯ç»™è¿™ä¸ªå¿«é€’å‘˜é…ä¸ªå¯¹è®²æœºï¼Œè®©ä»–éšæ—¶æ±‡æŠ¥å·¥ä½œçŠ¶æ€ã€‚

**ğŸ¯ ç›‘æ§çš„æ ¸å¿ƒä»·å€¼**
```
è¿è¡ŒçŠ¶æ€ç›‘æ§ï¼š
â€¢ Filebeatæ˜¯å¦æ­£å¸¸è¿è¡Œï¼Ÿ
â€¢ æ˜¯å¦å‡ºç°é”™è¯¯æˆ–å¼‚å¸¸ï¼Ÿ
â€¢ å†…å­˜å’ŒCPUä½¿ç”¨æƒ…å†µå¦‚ä½•ï¼Ÿ

æ•°æ®æµç›‘æ§ï¼š
â€¢ è¯»å–äº†å¤šå°‘è¡Œæ—¥å¿—ï¼Ÿ
â€¢ å‘é€äº†å¤šå°‘æ•°æ®ï¼Ÿ
â€¢ æœ‰æ²¡æœ‰æ•°æ®ç§¯å‹ï¼Ÿ

æ€§èƒ½ç›‘æ§ï¼š
â€¢ å¤„ç†é€Ÿåº¦æ˜¯å¦æ­£å¸¸ï¼Ÿ
â€¢ ç½‘ç»œè¿æ¥æ˜¯å¦ç¨³å®šï¼Ÿ
â€¢ ç£ç›˜è¯»å†™æ˜¯å¦æœ‰ç“¶é¢ˆï¼Ÿ
```

### 1.2 ç›‘æ§çš„ä¸‰ä¸ªå±‚æ¬¡


**ğŸ“Š ç›‘æ§æ¶æ„å›¾**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         åº”ç”¨å±‚ç›‘æ§                   â”‚ â† ä¸šåŠ¡æŒ‡æ ‡ã€é”™è¯¯ç‡
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Filebeatå†…éƒ¨ç›‘æ§             â”‚ â† é‡‡é›†å™¨çŠ¶æ€ã€æ€§èƒ½æŒ‡æ ‡
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         ç³»ç»Ÿå±‚ç›‘æ§                   â”‚ â† CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”¸ åŸºç¡€ç›‘æ§** - ç¡®ä¿æœåŠ¡æ­£å¸¸è¿è¡Œ
**ğŸ”¹ æ€§èƒ½ç›‘æ§** - ä¼˜åŒ–å¤„ç†æ•ˆç‡  
**â­ ä¸šåŠ¡ç›‘æ§** - ä¿éšœæ•°æ®è´¨é‡

---

## 2. âš™ï¸ å†…ç½®ç›‘æ§åŠŸèƒ½


### 2.1 å¯ç”¨åŸºç¡€ç›‘æ§


**ğŸ“‹ åŸºæœ¬é…ç½®æ­¥éª¤ï¼š**

**ç¬¬ä¸€æ­¥ï¼šå¼€å¯ç›‘æ§åŠŸèƒ½**
```yaml
# filebeat.yml
monitoring.enabled: true

# è®¾ç½®ç›‘æ§æ•°æ®æ”¶é›†é—´éš”ï¼ˆé»˜è®¤10ç§’ï¼‰
monitoring.period: 10s

# é…ç½®ç›‘æ§æ•°æ®è¾“å‡º
monitoring.elasticsearch:
  hosts: ["localhost:9200"]
  username: "monitoring_user"
  password: "password"
```

> **ğŸ’¡ æ–°æ‰‹æç¤º**
> `monitoring.enabled: true` å°±åƒç»™Filebeatè£…äº†ä¸€ä¸ª"çŠ¶æ€æ’­æŠ¥å™¨"ï¼Œè®©å®ƒå®šæœŸæ±‡æŠ¥è‡ªå·±çš„å·¥ä½œæƒ…å†µã€‚

### 2.2 ç›‘æ§æ•°æ®ç±»å‹è¯¦è§£


**ğŸ”§ å†…éƒ¨æŒ‡æ ‡æ”¶é›†**
```yaml
monitoring:
  enabled: true
  # æ”¶é›†çš„æŒ‡æ ‡ç±»å‹
  metrics:
    # ç³»ç»Ÿçº§æŒ‡æ ‡
    system.cpu.total.pct: true
    system.memory.total: true
    system.filesystem.used.pct: true
    
    # Filebeatç‰¹æœ‰æŒ‡æ ‡  
    filebeat.harvester.open_files: true
    filebeat.harvester.running: true
    filebeat.libbeat.output.events.total: true
```

**ğŸ“Š å…³é”®æŒ‡æ ‡å«ä¹‰**

| æŒ‡æ ‡ç±»å‹ | **å«ä¹‰è¯´æ˜** | **æ­£å¸¸èŒƒå›´** | **å¼‚å¸¸è¡¨ç°** |
|---------|-------------|-------------|-------------|
| `harvester.open_files` | æ­£åœ¨è¯»å–çš„æ–‡ä»¶æ•° | `< 1000` | `> 5000 å¯èƒ½æœ‰æ–‡ä»¶å¥æŸ„æ³„éœ²` |
| `harvester.running` | è¿è¡Œä¸­çš„é‡‡é›†å™¨æ•°é‡ | `æ ¹æ®é…ç½®è€Œå®š` | `ä¸º0è¡¨ç¤ºæ²¡æœ‰é‡‡é›†å™¨å·¥ä½œ` |
| `output.events.total` | å·²å‘é€çš„äº‹ä»¶æ€»æ•° | `æŒç»­å¢é•¿` | `é•¿æ—¶é—´ä¸å˜è¯´æ˜å‘é€æœ‰é—®é¢˜` |

### 2.3 RegistryçŠ¶æ€ç›‘æ§


**â“ å¸¸è§ç–‘é—®ï¼š**
**Qï¼šä»€ä¹ˆæ˜¯Registryï¼Ÿ**
**Aï¼š** Registryå°±åƒFilebeatçš„"å·¥ä½œæ—¥è®°æœ¬"ï¼Œè®°å½•æ¯ä¸ªæ–‡ä»¶è¯»åˆ°äº†å“ªä¸€è¡Œï¼Œé˜²æ­¢é‡å¤è¯»å–æˆ–é—æ¼ã€‚

**ğŸ” RegistryçŠ¶æ€æŸ¥çœ‹**
```bash
# æŸ¥çœ‹registryæ–‡ä»¶ï¼ˆè®°å½•è¯»å–è¿›åº¦ï¼‰
cat /var/lib/filebeat/registry/filebeat/data.json

# ä½¿ç”¨Filebeatå‘½ä»¤æŸ¥çœ‹çŠ¶æ€
filebeat export registry
```

**ğŸ“ å®ä¾‹è¯´æ˜ï¼š**
```json
{
  "cursor": {
    "offset": 1024
  },
  "meta": {
    "path": "/var/log/app.log",
    "size": 2048
  }
}
```
> è¿™è¡¨ç¤º `/var/log/app.log` æ–‡ä»¶å·²ç»è¯»å–åˆ°ç¬¬1024å­—èŠ‚ä½ç½®ï¼Œæ–‡ä»¶æ€»å¤§å°2048å­—èŠ‚ã€‚

---

## 3. ğŸŒ HTTPç›‘æ§ç«¯ç‚¹


### 3.1 å¯ç”¨HTTPç›‘æ§æ¥å£


**ğŸ”¸ HTTPç«¯ç‚¹é…ç½®**
```yaml
# filebeat.yml
http.enabled: true
http.host: "0.0.0.0"  
http.port: 5066

# å¯é€‰ï¼šé…ç½®åŸºç¡€è®¤è¯
http.username: "admin"
http.password: "secret"
```

> **âš ï¸ æ³¨æ„äº‹é¡¹**
> ç”Ÿäº§ç¯å¢ƒä¸­å»ºè®®åªåœ¨å†…ç½‘å¼€æ”¾ç›‘æ§ç«¯å£ï¼Œé¿å…å®‰å…¨é£é™©ã€‚

### 3.2 ç›‘æ§ç«¯ç‚¹è¯¦è§£


**âš¡ å¿«é€Ÿå‚è€ƒï¼š**

| ç«¯ç‚¹è·¯å¾„ | **åŠŸèƒ½è¯´æ˜** | **è¿”å›æ ¼å¼** |
|---------|-------------|-------------|
| `/` | åŸºæœ¬ä¿¡æ¯å’ŒçŠ¶æ€æ¦‚è§ˆ | `JSON` |
| `/stats` | è¯¦ç»†è¿è¡Œç»Ÿè®¡ | `JSON` |
| `/state` | å½“å‰è¿è¡ŒçŠ¶æ€ | `JSON` |

**ğŸ“‹ å®é™…æ“ä½œæ­¥éª¤ï¼š**

1. **åŸºæœ¬çŠ¶æ€æ£€æŸ¥**
```bash
curl http://localhost:5066/
```

2. **è¯¦ç»†ç»Ÿè®¡ä¿¡æ¯**
```bash
curl http://localhost:5066/stats | jq .
```

3. **è¿è¡ŒçŠ¶æ€æŸ¥è¯¢**
```bash
curl http://localhost:5066/state
```

### 3.3 ç›‘æ§æ•°æ®è§£è¯»


**ğŸ“Š `/stats` è¿”å›çš„å…³é”®ä¿¡æ¯**
```json
{
  "beat": {
    "cpu": {
      "system": {
        "ticks": 1234,
        "time": {
          "ms": 500
        }
      },
      "user": {
        "ticks": 5678,
        "time": {
          "ms": 1200
        }
      }
    },
    "info": {
      "name": "filebeat",
      "version": "8.10.0"
    }
  },
  "filebeat": {
    "harvester": {
      "open_files": 5,
      "running": 3
    }
  },
  "libbeat": {
    "output": {
      "events": {
        "total": 15432
      }
    }
  }
}
```

**ğŸ§  è®°å¿†è¦ç‚¹ï¼š**
- `harvester.open_files`ï¼šæ­£åœ¨è¯»å–çš„æ–‡ä»¶æ•°
- `harvester.running`ï¼šæ´»è·ƒçš„é‡‡é›†å™¨æ•°é‡
- `output.events.total`ï¼šç´¯è®¡å‘é€çš„æ—¥å¿—æ¡æ•°

---

## 4. ğŸ“‹ çŠ¶æ€æ£€æŸ¥å‘½ä»¤


### 4.1 å‘½ä»¤è¡ŒçŠ¶æ€æ£€æŸ¥


**ğŸ”§ å®è·µæŠ€å·§**
> å°±åƒåŒ»ç”Ÿç»™ç—…äººåšä½“æ£€ï¼ŒFilebeatä¹Ÿæœ‰è‡ªå·±çš„"ä½“æ£€å‘½ä»¤"ï¼Œå¸®ä½ å¿«é€Ÿäº†è§£å¥åº·çŠ¶å†µã€‚

**âš¡ å¸¸ç”¨æ£€æŸ¥å‘½ä»¤ï¼š**

```bash
# æ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•
filebeat test config

# æµ‹è¯•è¿æ¥åˆ°Elasticsearch  
filebeat test output

# æ£€æŸ¥æ¨¡å—é…ç½®
filebeat test modules

# å¯¼å‡ºå½“å‰é…ç½®
filebeat export config
```

### 4.2 å®æ—¶ç›‘æ§å‘½ä»¤


**ğŸ“‹ æ“ä½œæ­¥éª¤ï¼š**

1. **å®æ—¶æŸ¥çœ‹æ—¥å¿—è¾“å‡º**
```bash
filebeat -e -v
```

2. **æŸ¥çœ‹è¯¦ç»†è°ƒè¯•ä¿¡æ¯**
```bash
filebeat -e -d "*"
```

3. **åªè¾“å‡ºåˆ°æ§åˆ¶å°ï¼ˆä¸å‘é€åˆ°ESï¼‰**
```bash
filebeat -e -E output.console.enabled=true -E output.elasticsearch.enabled=false
```

> **ğŸ’¡ æ–°æ‰‹æç¤º**
> `-e` è¡¨ç¤ºè¾“å‡ºåˆ°æ§åˆ¶å°ï¼Œ`-v` è¡¨ç¤ºè¯¦ç»†æ¨¡å¼ï¼Œ`-d "*"` è¡¨ç¤ºå¼€å¯æ‰€æœ‰æ¨¡å—çš„è°ƒè¯•è¾“å‡ºã€‚

### 4.3 æ—¥å¿—çº§åˆ«æ§åˆ¶


**ğŸ¯ å®è·µåº”ç”¨**
```yaml
# filebeat.yml
logging.level: info  # å¯é€‰ï¼šdebug, info, warning, error

# æ—¥å¿—è¾“å‡ºåˆ°æ–‡ä»¶
logging.to_files: true
logging.files:
  path: /var/log/filebeat
  name: filebeat.log
  keepfiles: 7
  rotateeverybytes: 10485760  # 10MB
```

**ğŸ“Š æ—¥å¿—çº§åˆ«å¯¹æ¯”**

| çº§åˆ« | **åŒ…å«ä¿¡æ¯** | **é€‚ç”¨åœºæ™¯** | **æ€§èƒ½å½±å“** |
|-----|-------------|-------------|-------------|
| `debug` | æ‰€æœ‰è¯¦ç»†ä¿¡æ¯ | å¼€å‘è°ƒè¯• | é«˜ |
| `info` | åŸºæœ¬è¿è¡Œä¿¡æ¯ | æ—¥å¸¸è¿ç»´ | ä½ |
| `warning` | è­¦å‘Šå’Œé”™è¯¯ | ç”Ÿäº§ç¯å¢ƒ | æä½ |
| `error` | åªæœ‰é”™è¯¯ä¿¡æ¯ | é—®é¢˜æ’æŸ¥ | æä½ |

---

## 5. ğŸ”— X-Packç›‘æ§é›†æˆ


### 5.1 X-Packç›‘æ§æ¦‚è¿°


**ğŸ’¡ æ ¸å¿ƒç†è§£**
> X-Packç›‘æ§å°±åƒç»™Filebeatæ¥å…¥äº†ä¸€ä¸ª"æ™ºèƒ½å¥åº·ç®¡ç†ç³»ç»Ÿ"ï¼Œä¸ä»…è®°å½•çŠ¶æ€ï¼Œè¿˜èƒ½åˆ†æè¶‹åŠ¿ã€é¢„è­¦é—®é¢˜ã€‚

**ğŸ¯ X-Packç›‘æ§ä¼˜åŠ¿**
```
ç»Ÿä¸€ç›‘æ§ï¼š
â€¢ åœ¨Kibanaä¸­æŸ¥çœ‹æ‰€æœ‰Elastic Stackç»„ä»¶
â€¢ å›¾å½¢åŒ–ç•Œé¢ï¼Œä¸€ç›®äº†ç„¶
â€¢ å†å²æ•°æ®åˆ†æï¼Œè¶‹åŠ¿é¢„æµ‹

æ™ºèƒ½å‘Šè­¦ï¼š
â€¢ è‡ªåŠ¨æ£€æµ‹å¼‚å¸¸çŠ¶å†µ
â€¢ é‚®ä»¶/çŸ­ä¿¡é€šçŸ¥
â€¢ è‡ªå®šä¹‰å‘Šè­¦è§„åˆ™
```

### 5.2 é…ç½®X-Packç›‘æ§


**ğŸ“‹ é…ç½®æ­¥éª¤ï¼š**

**ç¬¬ä¸€æ­¥ï¼šåœ¨Filebeatä¸­å¯ç”¨**
```yaml
# filebeat.yml
xpack.monitoring.enabled: true

# æŒ‡å®šç›‘æ§æ•°æ®å‘é€åˆ°çš„Elasticsearché›†ç¾¤
xpack.monitoring.elasticsearch:
  hosts: ["localhost:9200"]
  username: "filebeat_internal"
  password: "password"
  
# å¯é€‰ï¼šè‡ªå®šä¹‰ç›‘æ§ç´¢å¼•
xpack.monitoring.elasticsearch.index: "filebeat-monitoring"
```

**ç¬¬äºŒæ­¥ï¼šåœ¨Elasticsearchä¸­å¯ç”¨ç›‘æ§**
```bash
# å¯ç”¨X-Packç›‘æ§
PUT _cluster/settings
{
  "persistent": {
    "xpack.monitoring.collection.enabled": true
  }
}
```

### 5.3 Kibanaç›‘æ§ä»ªè¡¨æ¿


**ğŸ” ç›‘æ§é¢æ¿åŠŸèƒ½**

```
Filebeatæ¦‚è§ˆé¢æ¿ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š æ€»ä½“çŠ¶æ€          ğŸ“ˆ äº‹ä»¶å¤„ç†ç‡    â”‚
â”‚ â€¢ è¿è¡ŒçŠ¶æ€ï¼šæ­£å¸¸      â€¢ 1000 events/s â”‚  
â”‚ â€¢ æ´»è·ƒèŠ‚ç‚¹ï¼š3         â€¢ å“åº”æ—¶é—´ï¼š50ms â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“‹ é‡‡é›†å™¨çŠ¶æ€        âš ï¸ å‘Šè­¦ä¿¡æ¯      â”‚
â”‚ â€¢ è¿è¡Œä¸­ï¼š5ä¸ª         â€¢ æ— æ´»è·ƒå‘Šè­¦     â”‚
â”‚ â€¢ ç©ºé—²ï¼š2ä¸ª          â€¢ å†å²å‘Šè­¦ï¼šæŸ¥çœ‹  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**âš¡ å¿«é€Ÿå¯¼èˆªè·¯å¾„ï¼š**
`Kibana â†’ Stack Monitoring â†’ Beats â†’ Filebeat`

---

## 6. ğŸ“Š Prometheusé›†æˆ


### 6.1 Prometheusç›‘æ§æ¦‚è¿°


**â“ å¸¸è§ç–‘é—®ï¼š**
**Qï¼šä¸ºä»€ä¹ˆè¦ç”¨Prometheusï¼Ÿ**
**Aï¼š** Prometheuså°±åƒä¸€ä¸ªä¸“ä¸šçš„"æ•°æ®æ”¶é›†ä¸“å®¶"ï¼Œä¸“é—¨æ“…é•¿æ”¶é›†å’Œå­˜å‚¨æ—¶é—´åºåˆ—æ•°æ®ï¼Œé…åˆGrafanaå¯ä»¥åˆ¶ä½œæ¼‚äº®çš„ç›‘æ§å›¾è¡¨ã€‚

### 6.2 é…ç½®Prometheus metrics


**ğŸ”§ é…ç½®ç¤ºä¾‹ï¼š**
```yaml
# filebeat.yml
http.enabled: true
http.host: "0.0.0.0"
http.port: 5066

# å¯ç”¨Prometheusæ ¼å¼çš„metrics
http.metrics: true
```

**ğŸ“‹ Prometheusé…ç½®ï¼š**
```yaml
# prometheus.yml
scrape_configs:
  - job_name: 'filebeat'
    static_configs:
      - targets: ['localhost:5066']
    metrics_path: '/metrics'
    scrape_interval: 30s
```

### 6.3 å…³é”®ç›‘æ§æŒ‡æ ‡


**ğŸ“Š é‡è¦Metricsè¯´æ˜**

| æŒ‡æ ‡åç§° | **å«ä¹‰** | **ç”¨é€”** |
|---------|---------|---------|
| `filebeat_harvester_open_files` | æ‰“å¼€æ–‡ä»¶æ•° | ç›‘æ§èµ„æºä½¿ç”¨ |
| `filebeat_harvester_running` | è¿è¡Œé‡‡é›†å™¨æ•° | ç›‘æ§å·¥ä½œçŠ¶æ€ |
| `libbeat_output_events_total` | è¾“å‡ºäº‹ä»¶æ€»æ•° | ç›‘æ§æ•°æ®æµé‡ |
| `process_cpu_seconds_total` | CPUä½¿ç”¨æ—¶é—´ | æ€§èƒ½ç›‘æ§ |

**ğŸ¯ Grafanaä»ªè¡¨æ¿æ¨¡æ¿**
```json
{
  "dashboard": {
    "title": "Filebeatç›‘æ§",
    "panels": [
      {
        "title": "äº‹ä»¶å¤„ç†ç‡",
        "targets": [
          {
            "expr": "rate(libbeat_output_events_total[5m])"
          }
        ]
      }
    ]
  }
}
```

---

## 7. ğŸ› ï¸ å®è·µåº”ç”¨æ¡ˆä¾‹


### 7.1 ç”Ÿäº§ç¯å¢ƒç›‘æ§æ–¹æ¡ˆ


**ğŸ“ å®ä¾‹è¯´æ˜ï¼š**
```
åœºæ™¯ï¼šç”µå•†ç½‘ç«™æ—¥å¿—ç›‘æ§
éœ€æ±‚ï¼š
â€¢ ç›‘æ§10å°æœåŠ¡å™¨çš„åº”ç”¨æ—¥å¿—
â€¢ ç¡®ä¿æ—¥å¿—ä¸ä¸¢å¤±
â€¢ åŠæ—¶å‘ç°å¼‚å¸¸æƒ…å†µ
```

**ğŸ”¸ ç›‘æ§æ¶æ„è®¾è®¡**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Filebeat   â”‚â”€â”€â”€â–¶â”‚Elasticsearchâ”‚â”€â”€â”€â–¶â”‚   Kibana    â”‚
â”‚   + ç›‘æ§     â”‚    â”‚     +       â”‚    â”‚    ç›‘æ§     â”‚
â”‚             â”‚    â”‚   X-Pack    â”‚    â”‚   ä»ªè¡¨æ¿    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚   å‘Šè­¦      â”‚
                   â”‚   ç³»ç»Ÿ      â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 å®Œæ•´é…ç½®ç¤ºä¾‹


**ğŸ”§ ç”Ÿäº§çº§ç›‘æ§é…ç½®**
```yaml
# filebeat.yml
filebeat.inputs:
- type: log
  paths:
    - /var/log/nginx/*.log
    - /var/log/app/*.log
  
# å¯ç”¨å®Œæ•´ç›‘æ§
monitoring.enabled: true
monitoring.period: 10s

# HTTPç›‘æ§ç«¯ç‚¹
http.enabled: true
http.host: "localhost"  # ç”Ÿäº§ç¯å¢ƒå»ºè®®åªç›‘å¬å†…ç½‘
http.port: 5066

# X-Packç›‘æ§
xpack.monitoring.enabled: true
xpack.monitoring.elasticsearch:
  hosts: ["es-cluster:9200"]
  username: "filebeat_monitoring"
  password: "${FILEBEAT_PASSWORD}"

# æ—¥å¿—é…ç½®
logging.level: info
logging.to_files: true
logging.files:
  path: /var/log/filebeat
  name: filebeat.log
  keepfiles: 7
  rotateeverybytes: 10485760

# è¾“å‡ºåˆ°Elasticsearch
output.elasticsearch:
  hosts: ["es-cluster:9200"]
  username: "filebeat_writer"
  password: "${FILEBEAT_PASSWORD}"
```

### 7.3 ç›‘æ§æ£€æŸ¥æ¸…å•


**ğŸ“‹ æ—¥å¸¸æ£€æŸ¥é¡¹ç›®ï¼š**

- [ ] **åŸºç¡€çŠ¶æ€æ£€æŸ¥**
  - `curl http://localhost:5066/` è¿”å›æ­£å¸¸
  - Filebeatè¿›ç¨‹è¿è¡Œæ­£å¸¸
  - å†…å­˜ä½¿ç”¨åœ¨åˆç†èŒƒå›´å†…

- [ ] **æ•°æ®æµæ£€æŸ¥** 
  - `harvester.running > 0` æœ‰é‡‡é›†å™¨åœ¨å·¥ä½œ
  - `output.events.total` æŒç»­å¢é•¿
  - Elasticsearchä¸­æœ‰æ–°æ•°æ®å†™å…¥

- [ ] **æ€§èƒ½æ£€æŸ¥**
  - CPUä½¿ç”¨ç‡ < 80%
  - å†…å­˜ä½¿ç”¨ < 2GBï¼ˆé»˜è®¤é…ç½®ï¼‰
  - ç£ç›˜ç©ºé—´å……è¶³

- [ ] **å‘Šè­¦æ£€æŸ¥**
  - Kibanaç›‘æ§æ— çº¢è‰²å‘Šè­¦
  - é”™è¯¯æ—¥å¿—æ•°é‡æ­£å¸¸
  - ç½‘ç»œè¿æ¥ç¨³å®š

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„ç›‘æ§æ¦‚å¿µ


```
ğŸ”¸ åŸºç¡€ç›‘æ§ï¼šç¡®ä¿Filebeatæ­£å¸¸è¿è¡Œ
ğŸ”¸ HTTPç«¯ç‚¹ï¼šæä¾›å®æ—¶çŠ¶æ€æŸ¥è¯¢æ¥å£  
ğŸ”¸ å†…éƒ¨æŒ‡æ ‡ï¼šé‡‡é›†å™¨ã€è¾“å‡ºã€æ€§èƒ½ç­‰å…³é”®æ•°æ®
ğŸ”¸ X-Packé›†æˆï¼šä¼ä¸šçº§ç»Ÿä¸€ç›‘æ§æ–¹æ¡ˆ
ğŸ”¸ çŠ¶æ€æ£€æŸ¥ï¼šå‘½ä»¤è¡Œå·¥å…·å¿«é€Ÿè¯Šæ–­é—®é¢˜
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ç›‘æ§çš„æœ¬è´¨ç›®çš„**
```
é¢„é˜²é—®é¢˜ï¼š
â€¢ æå‰å‘ç°æ½œåœ¨æ•…éšœ
â€¢ ç›‘æ§èµ„æºä½¿ç”¨è¶‹åŠ¿
â€¢ ä¼˜åŒ–æ€§èƒ½é…ç½®

å¿«é€Ÿå“åº”ï¼š
â€¢ å®æ—¶çŠ¶æ€æŸ¥çœ‹
â€¢ å¼‚å¸¸æƒ…å†µå‘Šè­¦
â€¢ é—®é¢˜å®šä½å·¥å…·
```

**ğŸ”¹ ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ**
```
å®‰å…¨åŸåˆ™ï¼š
â€¢ ç›‘æ§ç«¯å£åªå¯¹å†…ç½‘å¼€æ”¾
â€¢ ä½¿ç”¨è®¤è¯ä¿æŠ¤æ•æ„Ÿæ¥å£
â€¢ å®šæœŸæ›´æ–°ç›‘æ§å¯†ç 

æ€§èƒ½åŸåˆ™ï¼š
â€¢ åˆç†è®¾ç½®ç›‘æ§é—´éš”
â€¢ é¿å…è¿‡åº¦è¯¦ç»†çš„æ—¥å¿—
â€¢ å®šæœŸæ¸…ç†ç›‘æ§æ•°æ®
```

### 8.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ ä¸šåŠ¡åœºæ™¯åº”ç”¨**
- **è¿ç»´ç›‘æ§**ï¼šå®æ—¶æŒæ¡æ—¥å¿—æ”¶é›†çŠ¶æ€ï¼Œç¡®ä¿ä¸šåŠ¡æ•°æ®ä¸ä¸¢å¤±
- **æ€§èƒ½ä¼˜åŒ–**ï¼šé€šè¿‡ç›‘æ§æ•°æ®è°ƒä¼˜Filebeaté…ç½®ï¼Œæå‡å¤„ç†æ•ˆç‡  
- **æ•…éšœæ’æŸ¥**ï¼šå¿«é€Ÿå®šä½é—®é¢˜æ ¹å› ï¼Œç¼©çŸ­æ•…éšœæ¢å¤æ—¶é—´
- **å®¹é‡è§„åˆ’**ï¼šåŸºäºå†å²æ•°æ®é¢„æµ‹èµ„æºéœ€æ±‚ï¼Œåˆç†æ‰©å®¹

**ğŸ”§ è¿ç»´å®è·µ**
- **æ—¥å¸¸å·¡æ£€**ï¼šå»ºç«‹ç›‘æ§æ£€æŸ¥æ¸…å•ï¼Œå½¢æˆæ ‡å‡†åŒ–è¿ç»´æµç¨‹
- **è‡ªåŠ¨åŒ–å‘Šè­¦**ï¼šé…ç½®å…³é”®æŒ‡æ ‡é˜ˆå€¼ï¼Œå®ç°æ— äººå€¼å®ˆç›‘æ§
- **è¶‹åŠ¿åˆ†æ**ï¼šåˆ©ç”¨å†å²æ•°æ®åˆ†æä¸šåŠ¡å¢é•¿ï¼Œæå‰å‡†å¤‡èµ„æº
- **æ–‡æ¡£è®°å½•**ï¼šå»ºç«‹ç›‘æ§çŸ¥è¯†åº“ï¼Œæå‡å›¢é˜Ÿè¿ç»´æ°´å¹³

**ğŸ§  å­¦ä¹ è®°å¿†è¦ç‚¹**
- **ä¸€å¥è¯æ€»ç»“**ï¼šç›‘æ§è®©Filebeatä»"å“‘å·´"å˜æˆ"ä¼šè¯´è¯"çš„æ™ºèƒ½åŠ©æ‰‹
- **å…³é”®è¯è®°å¿†**ï¼š`ç›‘æ§å¼€å¯` + `HTTPç«¯ç‚¹` + `çŠ¶æ€æ£€æŸ¥` = `å…¨é¢æŒæ§`
- **ç±»æ¯”ç†è§£**ï¼šå°±åƒç»™æ±½è½¦è£…ä¸Šä»ªè¡¨ç›˜ï¼Œéšæ—¶äº†è§£"æ²¹é‡"ã€"é€Ÿåº¦"ã€"æ•…éšœ"

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- ç›‘æ§å¼€å¯çŠ¶æ€æ˜ï¼ŒHTTPç«¯ç‚¹æŸ¥å¾—æ¸…
- å‘½ä»¤æ£€æŸ¥é…ç½®æ­£ï¼ŒX-Packé›†æˆåŠŸèƒ½å¼º
- Prometheuså›¾è¡¨ç¾ï¼Œç”Ÿäº§ç¯å¢ƒè¦ä»”ç»†