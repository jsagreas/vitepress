---
title: 17ã€æ—¶é—´ä¸åœ°ç†ä½ç½®å¤„ç†å™¨
---
## ğŸ“š ç›®å½•

1. [æ—¶é—´æˆ³å¤„ç†å™¨æ¦‚è¿°](#1-æ—¶é—´æˆ³å¤„ç†å™¨æ¦‚è¿°)
2. [timestampå¤„ç†å™¨è¯¦è§£](#2-timestampå¤„ç†å™¨è¯¦è§£)
3. [æœ¬åœ°åŒ–ä¸ç¤¾åŒºIDå¤„ç†å™¨](#3-æœ¬åœ°åŒ–ä¸ç¤¾åŒºIDå¤„ç†å™¨)
4. [æŒ‡çº¹ä¸DNSå¤„ç†å™¨](#4-æŒ‡çº¹ä¸DNSå¤„ç†å™¨)
5. [å®é™…åº”ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ](#5-å®é™…åº”ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. â° æ—¶é—´æˆ³å¤„ç†å™¨æ¦‚è¿°


### 1.1 ä¸ºä»€ä¹ˆéœ€è¦æ—¶é—´å¤„ç†å™¨


**ğŸ”¸ æ—¥å¸¸ç”Ÿæ´»ç±»æ¯”**
æƒ³è±¡ä½ åœ¨æ•´ç†ä¸€å †ç…§ç‰‡ï¼Œæ¯å¼ ç…§ç‰‡éƒ½æœ‰æ‹æ‘„æ—¶é—´ï¼Œä½†æœ‰äº›æ˜¯"2025-01-15"ï¼Œæœ‰äº›æ˜¯"Jan 15, 2025"ï¼Œè¿˜æœ‰äº›æ˜¯"15/01/2025"ã€‚ä½ éœ€è¦æŠŠå®ƒä»¬ç»Ÿä¸€æˆä¸€ç§æ ¼å¼æ‰èƒ½æŒ‰æ—¶é—´æ’åºã€‚

**ğŸ“Š æ—¥å¿—æ—¶é—´å¤„ç†çš„ç°å®é—®é¢˜**
```
åŸå§‹æ—¥å¿—æ—¶é—´æ ¼å¼äº”èŠ±å…«é—¨ï¼š
Apacheè®¿é—®æ—¥å¿—ï¼š[15/Jan/2025:14:30:45 +0800]
åº”ç”¨ç¨‹åºæ—¥å¿—ï¼š2025-01-15T14:30:45.123Z
ç³»ç»Ÿæ—¥å¿—ï¼šJan 15 14:30:45
æ•°æ®åº“æ—¥å¿—ï¼š20250115143045

ç»Ÿä¸€åçš„æ ‡å‡†æ ¼å¼ï¼š
2025-01-15T14:30:45.123+08:00
```

### 1.2 æ—¶é—´å¤„ç†å™¨çš„æ ¸å¿ƒä½œç”¨


**ğŸ¯ ä¸»è¦åŠŸèƒ½**
- **æ ¼å¼æ ‡å‡†åŒ–**ï¼šæŠŠå„ç§æ—¶é—´æ ¼å¼è½¬æ¢æˆç»Ÿä¸€æ ‡å‡†
- **æ—¶åŒºè½¬æ¢**ï¼šå¤„ç†ä¸åŒæ—¶åŒºçš„æ—¶é—´æ•°æ®
- **å­—æ®µæå–**ï¼šä»æ—¶é—´æˆ³ä¸­æå–å¹´ã€æœˆã€æ—¥ç­‰ä¿¡æ¯
- **æ’åºåŸºç¡€**ï¼šä¸ºæ—¥å¿—æä¾›å‡†ç¡®çš„æ—¶é—´é¡ºåº

> ğŸ’¡ **æ ¸å¿ƒç†è§£**ï¼šæ—¶é—´å¤„ç†å™¨å°±åƒç¿»è¯‘å®˜ï¼ŒæŠŠå„ç§"æ–¹è¨€"æ—¶é—´æ ¼å¼ç¿»è¯‘æˆ"æ™®é€šè¯"æ ‡å‡†æ ¼å¼

---

## 2. ğŸ• timestampå¤„ç†å™¨è¯¦è§£


### 2.1 åŸºæœ¬æ¦‚å¿µä¸è¯­æ³•


**timestampå¤„ç†å™¨**ï¼šä¸“é—¨ç”¨æ¥è§£æå’Œè½¬æ¢æ—¶é—´å­—æ®µçš„å·¥å…·

```yaml
# åŸºç¡€è¯­æ³•ç»“æ„
processors:
  - timestamp:
      field: "åŸå§‹æ—¶é—´å­—æ®µå"
      layouts: 
        - "æ—¶é—´æ ¼å¼æ¨¡æ¿1"
        - "æ—¶é—´æ ¼å¼æ¨¡æ¿2"
      target_field: "ç›®æ ‡å­—æ®µå"
      timezone: "æ—¶åŒºè®¾ç½®"
```

### 2.2 timestamp.field æ—¶é—´å­—æ®µæŒ‡å®š


**ğŸ”¸ ä½œç”¨è¯´æ˜**
æŒ‡å®šå“ªä¸ªå­—æ®µåŒ…å«éœ€è¦å¤„ç†çš„æ—¶é—´ä¿¡æ¯

```yaml
# ç¤ºä¾‹1ï¼šå¤„ç†messageå­—æ®µä¸­çš„æ—¶é—´
processors:
  - timestamp:
      field: "message"
      layouts: ["2006-01-02 15:04:05"]

# ç¤ºä¾‹2ï¼šå¤„ç†è‡ªå®šä¹‰æ—¶é—´å­—æ®µ
processors:
  - timestamp:
      field: "log_time"
      layouts: ["Jan 02 15:04:05"]
```

**ğŸ“ å®é™…åº”ç”¨åœºæ™¯**
```
æ—¥å¿—ç¤ºä¾‹ï¼š
message: "2025-01-15 14:30:45 ç”¨æˆ·ç™»å½•æˆåŠŸ"
â†“ å¤„ç†å
@timestamp: 2025-01-15T14:30:45.000Z
message: "2025-01-15 14:30:45 ç”¨æˆ·ç™»å½•æˆåŠŸ"
```

### 2.3 timestamp.layouts æ—¶é—´æ ¼å¼é…ç½®


**ğŸ”¸ æ ¼å¼æ¨¡æ¿è¯­æ³•**
ä½¿ç”¨Goè¯­è¨€æ—¶é—´æ ¼å¼ï¼ŒåŸºå‡†æ—¶é—´ï¼š`Mon Jan 2 15:04:05 MST 2006`

| **æ ¼å¼å…ƒç´ ** | **å«ä¹‰** | **ç¤ºä¾‹** |
|-------------|---------|---------|
| `2006` | 4ä½å¹´ä»½ | `2025` |
| `06` | 2ä½å¹´ä»½ | `25` |
| `01` | 2ä½æœˆä»½ | `03` |
| `Jan` | æœˆä»½ç®€å†™ | `Mar` |
| `January` | æœˆä»½å…¨ç§° | `March` |
| `02` | 2ä½æ—¥æœŸ | `15` |
| `15` | 24å°æ—¶åˆ¶å°æ—¶ | `14` |
| `03` | 12å°æ—¶åˆ¶å°æ—¶ | `02` |
| `04` | åˆ†é’Ÿ | `30` |
| `05` | ç§’é’Ÿ | `45` |

**ğŸ’» å¸¸ç”¨æ ¼å¼é…ç½®ç¤ºä¾‹**
```yaml
processors:
  - timestamp:
      field: "timestamp_field"
      layouts:
        - "2006-01-02 15:04:05"          # 2025-01-15 14:30:45
        - "2006/01/02 15:04:05"          # 2025/01/15 14:30:45
        - "Jan 02 15:04:05"              # Jan 15 14:30:45
        - "2006-01-02T15:04:05.000Z"     # ISO 8601æ ¼å¼
        - "02/Jan/2006:15:04:05 -0700"   # Apacheæ—¥å¿—æ ¼å¼
```

### 2.4 timestamp.timezone æ—¶åŒºè®¾ç½®


**ğŸŒ æ—¶åŒºå¤„ç†çš„é‡è¦æ€§**
ä¸åŒæœåŠ¡å™¨å¯èƒ½åœ¨ä¸åŒæ—¶åŒºï¼Œéœ€è¦ç»Ÿä¸€åˆ°åŒä¸€æ—¶åŒºè¿›è¡Œåˆ†æ

```yaml
# ç¤ºä¾‹ï¼šå¤„ç†ä¸åŒæ—¶åŒºçš„æ—¥å¿—
processors:
  - timestamp:
      field: "log_time"
      layouts: ["2006-01-02 15:04:05"]
      timezone: "Asia/Shanghai"        # ä¸­å›½æ—¶åŒº
      target_field: "@timestamp"

# å¸¸ç”¨æ—¶åŒºè®¾ç½®
timezone: "UTC"                       # ä¸–ç•Œåè°ƒæ—¶
timezone: "Asia/Shanghai"             # åŒ—äº¬æ—¶é—´
timezone: "America/New_York"          # çº½çº¦æ—¶é—´
timezone: "Europe/London"             # ä¼¦æ•¦æ—¶é—´
```

**âš ï¸ æ—¶åŒºå¤„ç†æ³¨æ„äº‹é¡¹**
```
åŸå§‹æ—¥å¿—ï¼š2025-01-15 14:30:45 (æœåŠ¡å™¨æœ¬åœ°æ—¶é—´ï¼Œä¸œå…«åŒº)
è®¾ç½®timezone: "Asia/Shanghai"
ç»“æœï¼š2025-01-15T06:30:45.000Z (è½¬æ¢ä¸ºUTCæ—¶é—´)

å¦‚æœä¸è®¾ç½®æ—¶åŒºï¼Œå¯èƒ½å¯¼è‡´ï¼š
âŒ æ—¶é—´åå·®8å°æ—¶
âŒ æ—¥å¿—æ—¶åºæ··ä¹±
âŒ åˆ†æç»“æœé”™è¯¯
```

### 2.5 å®Œæ•´é…ç½®ç¤ºä¾‹


```yaml
# filebeat.yml ä¸­çš„å®Œæ•´æ—¶é—´å¤„ç†é…ç½®
filebeat.inputs:
- type: log
  paths:
    - /var/log/app/*.log
  processors:
    # è§£æApacheè®¿é—®æ—¥å¿—æ—¶é—´æ ¼å¼
    - timestamp:
        field: "message"
        layouts: 
          - "02/Jan/2006:15:04:05 -0700"  # [15/Jan/2025:14:30:45 +0800]
        target_field: "@timestamp"
        timezone: "Local"
        
    # è§£æåº”ç”¨è‡ªå®šä¹‰æ—¶é—´æ ¼å¼  
    - timestamp:
        field: "app_time"
        layouts:
          - "2006-01-02 15:04:05.000"
          - "2006-01-02T15:04:05Z"
        target_field: "parsed_time"
        timezone: "Asia/Shanghai"
```

---

## 3. ğŸŒ æœ¬åœ°åŒ–ä¸ç¤¾åŒºIDå¤„ç†å™¨


### 3.1 add_locale æœ¬åœ°åŒ–ä¿¡æ¯å¤„ç†å™¨


**ğŸ”¸ ä»€ä¹ˆæ˜¯æœ¬åœ°åŒ–ä¿¡æ¯**
å°±åƒç»™æ•°æ®è´´ä¸Š"äº§åœ°æ ‡ç­¾"ï¼Œè®°å½•æ•°æ®æ¥è‡ªå“ªä¸ªåœ°åŒºã€ä½¿ç”¨ä»€ä¹ˆè¯­è¨€

**åŸºæœ¬é…ç½®è¯­æ³•**
```yaml
processors:
  - add_locale:
      format: "offset"  # æˆ– "abbreviation"
      target: "locale_info"
```

**ğŸ“Š é…ç½®é€‰é¡¹è¯´æ˜**

| **å‚æ•°** | **ä½œç”¨** | **ç¤ºä¾‹è¾“å‡º** |
|---------|---------|-------------|
| `offset` | æ—¶åŒºåç§»é‡ | `+08:00` |
| `abbreviation` | æ—¶åŒºç¼©å†™ | `CST` |

**ğŸ’» å®é™…åº”ç”¨ç¤ºä¾‹**
```yaml
processors:
  - add_locale:
      format: "offset"
      target: "timezone_offset"
      
# å¤„ç†ç»“æœ
åŸå§‹æ•°æ®: {"message": "ç”¨æˆ·ç™»å½•"}
å¤„ç†å: {
  "message": "ç”¨æˆ·ç™»å½•",
  "timezone_offset": "+08:00"
}
```

### 3.2 community_id ç½‘ç»œè¿æ¥IDç”Ÿæˆ


**ğŸ”¸ ç½‘ç»œè¿æ¥æŒ‡çº¹**
æƒ³è±¡æ¯ä¸ªç½‘ç»œè¿æ¥éƒ½æœ‰ä¸€ä¸ªèº«ä»½è¯å·ï¼Œç”¨æ¥å”¯ä¸€æ ‡è¯†è¿™ä¸ªè¿æ¥

**ğŸŒŸ ä¸»è¦ç”¨é€”**
- **è¿æ¥è·Ÿè¸ª**ï¼šè¿½è¸ªç½‘ç»œæµé‡çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸ
- **å®‰å…¨åˆ†æ**ï¼šè¯†åˆ«å¯ç–‘çš„ç½‘ç»œè¿æ¥æ¨¡å¼
- **æ€§èƒ½ç›‘æ§**ï¼šåˆ†æç½‘ç»œè¿æ¥çš„æ€§èƒ½æŒ‡æ ‡

```yaml
processors:
  - community_id:
      fields:
        source_ip: "src_ip"
        source_port: "src_port"  
        destination_ip: "dest_ip"
        destination_port: "dest_port"
        protocol: "protocol"
      target: "network_community_id"
```

**ğŸ” ç”Ÿæˆè¿‡ç¨‹ç¤ºä¾‹**
```
ç½‘ç»œè¿æ¥ä¿¡æ¯ï¼š
æºIP: 192.168.1.100
æºç«¯å£: 12345
ç›®æ ‡IP: 220.181.38.148  
ç›®æ ‡ç«¯å£: 80
åè®®: TCP

ç”Ÿæˆçš„Community ID: 1:Qj8+ZANGcw/4IXFo4rANzHYp8=
```

---

## 4. ğŸ” æŒ‡çº¹ä¸DNSå¤„ç†å™¨


### 4.1 fingerprint æŒ‡çº¹ç”Ÿæˆå¤„ç†å™¨


**ğŸ”¸ æ•°æ®æŒ‡çº¹çš„æ¦‚å¿µ**
å°±åƒäººçš„æŒ‡çº¹ä¸€æ ·ï¼Œä¸ºæ¯æ¡æ•°æ®ç”Ÿæˆå”¯ä¸€çš„æ ‡è¯†ç¬¦

**ä¸»è¦åº”ç”¨åœºæ™¯**
```
å»é‡æ£€æµ‹ï¼š
æ•°æ®1: {"user": "å¼ ä¸‰", "action": "ç™»å½•"}
æ•°æ®2: {"user": "å¼ ä¸‰", "action": "ç™»å½•"}  
é€šè¿‡æŒ‡çº¹è¯†åˆ«è¿™æ˜¯é‡å¤æ•°æ®

æ•°æ®å®Œæ•´æ€§ï¼š
å‘é€æ–¹ç”ŸæˆæŒ‡çº¹: abc123def
æ¥æ”¶æ–¹éªŒè¯æŒ‡çº¹: abc123def (ä¸€è‡´=æ•°æ®å®Œæ•´)
```

**ğŸ’» åŸºæœ¬é…ç½®**
```yaml
processors:
  - fingerprint:
      fields: ["user", "action", "timestamp"]
      target_field: "data_fingerprint"
      method: "sha256"                    # å“ˆå¸Œç®—æ³•
      encoding: "hex"                     # ç¼–ç æ–¹å¼
```

**ğŸ”§ é…ç½®å‚æ•°è¯¦è§£**

| **å‚æ•°** | **è¯´æ˜** | **å¯é€‰å€¼** |
|---------|---------|-----------|
| `fields` | å‚ä¸æŒ‡çº¹è®¡ç®—çš„å­—æ®µ | å­—æ®µåæ•°ç»„ |
| `method` | å“ˆå¸Œç®—æ³• | `md5`, `sha1`, `sha256` |
| `encoding` | ç¼–ç æ ¼å¼ | `hex`, `base64` |
| `target_field` | è¾“å‡ºå­—æ®µå | è‡ªå®šä¹‰å­—æ®µå |

### 4.2 dns DNSè§£æå¤„ç†å™¨


**ğŸ”¸ DNSè§£æçš„ä½œç”¨**
æŠŠIPåœ°å€è½¬æ¢æˆåŸŸåï¼Œè®©æ—¥å¿—æ›´å®¹æ˜“ç†è§£

```
IPåœ°å€ â†’ åŸŸåè½¬æ¢ï¼š
åŸå§‹: è®¿é—®è€…IP 220.181.38.148
è§£æå: è®¿é—®è€…æ¥è‡ª www.baidu.com

åå‘è§£æç¤ºä¾‹ï¼š
åŸå§‹: ç›®æ ‡IP 8.8.8.8  
è§£æå: ç›®æ ‡ä¸»æœº dns.google
```

**ğŸ’» DNSå¤„ç†å™¨é…ç½®**
```yaml
processors:
  - dns:
      type: "reverse"                    # åå‘è§£æ(IPâ†’åŸŸå)
      fields:
        source.ip: "source.hostname"     # IPå­—æ®µ â†’ ä¸»æœºåå­—æ®µ
        dest.ip: "dest.hostname"
      timeout: "500ms"                   # è§£æè¶…æ—¶æ—¶é—´
      nameservers: ["8.8.8.8", "1.1.1.1"]  # æŒ‡å®šDNSæœåŠ¡å™¨
```

**âš ï¸ DNSè§£ææ³¨æ„äº‹é¡¹**
```
æ€§èƒ½å½±å“ï¼š
âœ… ç¼“å­˜DNSç»“æœï¼Œé¿å…é‡å¤æŸ¥è¯¢
âŒ æ¯æ¡æ—¥å¿—éƒ½å®æ—¶è§£æDNS(å¤ªæ…¢)

è¶…æ—¶è®¾ç½®ï¼š
âœ… è®¾ç½®åˆç†è¶…æ—¶(500ms-2s)
âŒ è¶…æ—¶å¤ªé•¿å½±å“å¤„ç†é€Ÿåº¦

å¤±è´¥å¤„ç†ï¼š
âœ… DNSè§£æå¤±è´¥ä¿ç•™åŸIP
âŒ è§£æå¤±è´¥ä¸¢å¼ƒæ•´æ¡æ—¥å¿—
```

---

## 5. ğŸš€ å®é™…åº”ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ


### 5.1 WebæœåŠ¡å™¨æ—¥å¿—æ—¶é—´æ ‡å‡†åŒ–


**ğŸ“‹ åœºæ™¯æè¿°**
æœ‰ä¸€ä¸ªç”µå•†ç½‘ç«™ï¼Œnginxè®¿é—®æ—¥å¿—ã€åº”ç”¨æ—¥å¿—ã€æ•°æ®åº“æ—¥å¿—çš„æ—¶é—´æ ¼å¼éƒ½ä¸åŒï¼Œéœ€è¦ç»Ÿä¸€å¤„ç†

```yaml
# nginxè®¿é—®æ—¥å¿—å¤„ç†
processors:
  - timestamp:
      field: "message"
      layouts: ["02/Jan/2006:15:04:05 -0700"]
      target_field: "@timestamp"
      
  # æ·»åŠ æœ¬åœ°åŒ–ä¿¡æ¯
  - add_locale:
      format: "offset"
      target: "server_timezone"
      
  # ç”Ÿæˆç½‘ç»œè¿æ¥ID
  - community_id:
      fields:
        source_ip: "remote_addr"
        destination_port: "server_port"
      target: "connection_id"
```

### 5.2 å¤šæ•°æ®ä¸­å¿ƒæ—¥å¿—ç»Ÿä¸€


**ğŸŒ åœºæ™¯æè¿°**
å…¬å¸åœ¨åŒ—äº¬ã€ä¸Šæµ·ã€æ·±åœ³æœ‰ä¸‰ä¸ªæ•°æ®ä¸­å¿ƒï¼Œéœ€è¦æŠŠæ‰€æœ‰æ—¥å¿—çš„æ—¶é—´ç»Ÿä¸€åˆ°UTCæ—¶åŒº

```yaml
filebeat.inputs:
- type: log
  paths: ["/var/log/app/*.log"]
  fields:
    datacenter: "beijing"
  processors:
    - timestamp:
        field: "log_time"  
        layouts: ["2006-01-02 15:04:05"]
        timezone: "Asia/Shanghai"          # ç»Ÿä¸€è½¬æ¢ä¸ºUTC
        
    - add_locale:
        format: "abbreviation"
        target: "original_timezone"        # ä¿ç•™åŸå§‹æ—¶åŒºä¿¡æ¯
```

### 5.3 å®‰å…¨æ—¥å¿—å¢å¼ºå¤„ç†


**ğŸ”’ åœºæ™¯æè¿°**
ç½‘ç»œå®‰å…¨å›¢é˜Ÿéœ€è¦åˆ†æç½‘ç»œè¿æ¥æ¨¡å¼ï¼Œè¦æ±‚æ¯æ¡è¿æ¥éƒ½æœ‰å”¯ä¸€æ ‡è¯†å’Œä¸»æœºåè§£æ

```yaml
processors:
  # æ—¶é—´æ ‡å‡†åŒ–
  - timestamp:
      field: "timestamp"
      layouts: ["2006-01-02T15:04:05.000Z"]
      
  # ç”Ÿæˆè¿æ¥æŒ‡çº¹
  - community_id:
      fields:
        source_ip: "src_ip"
        destination_ip: "dst_ip"
        source_port: "src_port"
        destination_port: "dst_port"
      target: "flow_id"
      
  # DNSåå‘è§£æ
  - dns:
      type: "reverse"
      fields:
        src_ip: "src_hostname"
        dst_ip: "dst_hostname"
      timeout: "1s"
      
  # ç”Ÿæˆäº‹ä»¶æŒ‡çº¹(ç”¨äºå»é‡)
  - fingerprint:
      fields: ["src_ip", "dst_ip", "flow_id"]
      target_field: "event_hash"
      method: "sha256"
```

### 5.4 æ€§èƒ½ä¼˜åŒ–é…ç½®


```yaml
# ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–é…ç½®
processors:
  - timestamp:
      field: "time"
      layouts: ["2006-01-02 15:04:05"]
      ignore_missing: true               # å¿½ç•¥ç¼ºå¤±å­—æ®µ
      ignore_failure: true               # å¿½ç•¥è§£æå¤±è´¥
      
  - dns:
      type: "reverse" 
      timeout: "200ms"                   # å¿«é€Ÿè¶…æ—¶
      fields:
        client_ip: "client_host"
      action: "replace"                  # æ›¿æ¢è€Œä¸æ˜¯æ·»åŠ å­—æ®µ
```

**ğŸš€ æ€§èƒ½ä¼˜åŒ–è¦ç‚¹**

| **ä¼˜åŒ–é¡¹** | **è¯´æ˜** | **å»ºè®®å€¼** |
|-----------|---------|-----------|
| `ignore_failure` | å¤„ç†å¤±è´¥ä¸å½±å“æ•´ä½“ | `true` |
| `DNS timeout` | DNSè§£æè¶…æ—¶æ—¶é—´ | `200ms-500ms` |
| `fieldsæ•°é‡` | æŒ‡çº¹è®¡ç®—å­—æ®µæ•°é‡ | `<5ä¸ªå­—æ®µ` |
| `ç¼“å­˜ç­–ç•¥` | DNSç»“æœç¼“å­˜ | `å¯ç”¨å†…ç½®ç¼“å­˜` |

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ timestampå¤„ç†å™¨ï¼šæ—¶é—´æ ¼å¼æ ‡å‡†åŒ–çš„æ ¸å¿ƒå·¥å…·
ğŸ”¸ æ—¶é—´å¸ƒå±€æ¨¡æ¿ï¼šGoè¯­è¨€æ ¼å¼ï¼ŒåŸºå‡†æ—¶é—´2006-01-02 15:04:05
ğŸ”¸ æ—¶åŒºå¤„ç†ï¼šç»Ÿä¸€ä¸åŒæ¥æºæ—¥å¿—çš„æ—¶åŒºï¼Œé¿å…æ—¶åºæ··ä¹±
ğŸ”¸ community_idï¼šç½‘ç»œè¿æ¥çš„å”¯ä¸€èº«ä»½æ ‡è¯†
ğŸ”¸ fingerprintï¼šæ•°æ®å®Œæ•´æ€§å’Œå»é‡çš„æ•°å­—æŒ‡çº¹
ğŸ”¸ DNSè§£æï¼šIPåœ°å€å’ŒåŸŸåçš„åŒå‘è½¬æ¢
```

### 6.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æ—¶é—´å¤„ç†çš„é‡è¦æ€§**
```
ä¸ºä»€ä¹ˆé‡è¦ï¼š
â€¢ æ—¥å¿—åˆ†æåŸºç¡€ï¼šæŒ‰æ—¶é—´æ’åºå’Œè¿‡æ»¤
â€¢ æ•…éšœæ’æŸ¥å…³é”®ï¼šå‡†ç¡®çš„æ—¶é—´çº¿
â€¢ æ€§èƒ½ç›‘æ§åŸºå‡†ï¼šæ—¶é—´æ˜¯å…³é”®æŒ‡æ ‡
â€¢ åˆè§„å®¡è®¡è¦æ±‚ï¼šæ³•å¾‹è¦æ±‚æ—¶é—´å‡†ç¡®æ€§

å¸¸è§æ—¶åŒºé™·é˜±ï¼š
âŒ ä¸è®¾ç½®æ—¶åŒºå¯¼è‡´8å°æ—¶åå·®
âŒ æ··åˆä¸åŒæ—¶åŒºçš„æ—¥å¿—å¯¼è‡´ä¹±åº
âŒ å¤ä»¤æ—¶åˆ‡æ¢å¯¼è‡´çš„æ—¶é—´è·³è·ƒ
```

**ğŸ”¹ ç½‘ç»œè¿æ¥æ ‡è¯†çš„ä»·å€¼**
```
community_idçš„ç‹¬ç‰¹ä»·å€¼ï¼š
â€¢ æ ‡å‡†åŒ–ï¼šè¡Œä¸šæ ‡å‡†çš„è¿æ¥æ ‡è¯†æ–¹æ³•
â€¢ ä¸€è‡´æ€§ï¼šåŒä¸€è¿æ¥åœ¨ä¸åŒå·¥å…·ä¸­IDç›¸åŒ
â€¢ å…³è”æ€§ï¼šæ–¹ä¾¿è·¨ç³»ç»Ÿå…³è”åˆ†æ
â€¢ æŒä¹…æ€§ï¼šè¿æ¥IDä¸ä¼šå› é‡å¯è€Œæ”¹å˜
```

**ğŸ”¹ æŒ‡çº¹æŠ€æœ¯çš„åº”ç”¨æ€ç»´**
```
ä½•æ—¶ä½¿ç”¨æŒ‡çº¹ï¼š
âœ… æ•°æ®å»é‡ï¼šè¯†åˆ«é‡å¤çš„æ—¥å¿—æ¡ç›®
âœ… å®Œæ•´æ€§æ ¡éªŒï¼šæ£€æµ‹æ•°æ®æ˜¯å¦è¢«ç¯¡æ”¹
âœ… æ•°æ®åˆ†ç»„ï¼šç›¸åŒæŒ‡çº¹çš„æ•°æ®å½’ç±»
âœ… ç¼“å­˜æ ‡è¯†ï¼šä½œä¸ºç¼“å­˜çš„å”¯ä¸€é”®

æŒ‡çº¹ç®—æ³•é€‰æ‹©ï¼š
â€¢ MD5ï¼šé€Ÿåº¦å¿«ï¼Œå®‰å…¨æ€§ä¸€èˆ¬ï¼Œé€‚åˆå»é‡
â€¢ SHA256ï¼šå®‰å…¨æ€§é«˜ï¼Œé€Ÿåº¦ä¸­ç­‰ï¼Œé€‚åˆæ ¡éªŒ
â€¢ SHA1ï¼šå¹³è¡¡é€‰æ‹©ï¼Œå…¼å®¹æ€§å¥½
```

### 6.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ é…ç½®é€‰æ‹©å»ºè®®**

| **åœºæ™¯** | **æ¨èé…ç½®** | **åŸå› ** |
|---------|-------------|---------|
| **Webè®¿é—®æ—¥å¿—** | `timestamp + community_id` | `æ—¶é—´æ’åº + è¿æ¥è·Ÿè¸ª` |
| **åº”ç”¨ç¨‹åºæ—¥å¿—** | `timestamp + fingerprint` | `æ—¶é—´ç»Ÿä¸€ + å»é‡æ£€æµ‹` |
| **å®‰å…¨å®¡è®¡æ—¥å¿—** | `å…¨éƒ¨å¤„ç†å™¨` | `å®Œæ•´çš„æ•°æ®å¢å¼º` |
| **é«˜é¢‘æ—¥å¿—** | `ä»…timestamp` | `é¿å…æ€§èƒ½å½±å“` |

**ğŸ”§ ç”Ÿäº§ç¯å¢ƒå»ºè®®**
```
æ€§èƒ½è€ƒè™‘ï¼š
â€¢ DNSè§£æè®¾ç½®çŸ­è¶…æ—¶(200-500ms)
â€¢ å¯ç”¨ignore_failureé¿å…å•æ¡é”™è¯¯å½±å“æ•´ä½“
â€¢ åˆç†é€‰æ‹©æŒ‡çº¹ç®—æ³•(MD5é€Ÿåº¦å¿«)
â€¢ æ‰¹é‡å¤„ç†æé«˜æ•ˆç‡

ç›‘æ§æŒ‡æ ‡ï¼š
â€¢ æ—¶é—´è§£ææˆåŠŸç‡ >95%
â€¢ DNSè§£ææˆåŠŸç‡ >80%
â€¢ å¤„ç†å»¶è¿Ÿ <100ms
â€¢ é”™è¯¯ç‡ <1%
```

### 6.4 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


**â“ æ—¶é—´è§£æå¤±è´¥**
```
é—®é¢˜ï¼šéƒ¨åˆ†æ—¥å¿—æ—¶é—´è§£æä¸æˆåŠŸ
è§£å†³ï¼š
1. æ£€æŸ¥layoutsæ ¼å¼æ˜¯å¦åŒ¹é…
2. è®¾ç½®ignore_failure: true
3. ä½¿ç”¨å¤šä¸ªlayoutsè¦†ç›–ä¸åŒæ ¼å¼
4. æ£€æŸ¥åŸå§‹æ•°æ®çš„æ—¶é—´æ ¼å¼
```

**â“ DNSè§£æå¤ªæ…¢**
```
é—®é¢˜ï¼šDNSè§£æå¯¼è‡´å¤„ç†æ€§èƒ½ä¸‹é™
è§£å†³ï¼š
1. å‡å°‘timeoutåˆ°200-500ms
2. æŒ‡å®šå¿«é€Ÿçš„DNSæœåŠ¡å™¨(8.8.8.8)
3. åªå¯¹é‡è¦IPè¿›è¡Œè§£æ
4. å¯ç”¨DNSç¼“å­˜æœºåˆ¶
```

**â“ æŒ‡çº¹é‡å¤ç‡é«˜**
```
é—®é¢˜ï¼šä¸åŒæ•°æ®ç”Ÿæˆç›¸åŒæŒ‡çº¹
è§£å†³ï¼š
1. å¢åŠ æ›´å¤šå·®å¼‚åŒ–å­—æ®µ
2. åŒ…å«æ—¶é—´æˆ³å­—æ®µ
3. ä½¿ç”¨æ›´å¼ºçš„å“ˆå¸Œç®—æ³•(SHA256)
4. æ£€æŸ¥æ•°æ®æ˜¯å¦çœŸçš„é‡å¤
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- æ—¶é—´ç»Ÿä¸€å¾ˆé‡è¦ï¼Œæ ¼å¼æ—¶åŒºè¦è®¾å¥½
- ç½‘ç»œè¿æ¥æœ‰IDï¼Œè¿½è¸ªåˆ†æç”¨å¾—åˆ°  
- æŒ‡çº¹å»é‡ä¿å®Œæ•´ï¼ŒDNSè§£æIPå˜å
- æ€§èƒ½ä¼˜åŒ–åˆ«å¿˜è®°ï¼Œè¶…æ—¶å¤±è´¥è¦å¤„ç†