---
title: 4ã€è°ƒè¯•æŠ€å·§ä¸å·¥å…·
---
## ğŸ“š ç›®å½•

1. [è°ƒè¯•åŸºç¡€æ¦‚å¿µ](#1-è°ƒè¯•åŸºç¡€æ¦‚å¿µ)
2. [é”™è¯¯æ’æŸ¥æŠ€å·§](#2-é”™è¯¯æ’æŸ¥æŠ€å·§)
3. [è°ƒè¯•æ¨¡å¼ä½¿ç”¨](#3-è°ƒè¯•æ¨¡å¼ä½¿ç”¨)
4. [æ—¥å¿—åˆ†ææ–¹æ³•](#4-æ—¥å¿—åˆ†ææ–¹æ³•)
5. [ç½‘ç»œé—®é¢˜å®šä½](#5-ç½‘ç»œé—®é¢˜å®šä½)
6. [è¿æ¥é—®é¢˜æ’æŸ¥](#6-è¿æ¥é—®é¢˜æ’æŸ¥)
7. [é…ç½®éªŒè¯æ–¹æ³•](#7-é…ç½®éªŒè¯æ–¹æ³•)
8. [å®ç”¨è°ƒè¯•å·¥å…·](#8-å®ç”¨è°ƒè¯•å·¥å…·)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” è°ƒè¯•åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯Filebeatè°ƒè¯•


**ğŸ”¸ è°ƒè¯•æœ¬è´¨ç†è§£**
è°ƒè¯•å°±åƒæ˜¯ç»™Filebeatåš"ä½“æ£€"ï¼Œå½“å®ƒä¸æ­£å¸¸å·¥ä½œæ—¶ï¼Œæˆ‘ä»¬è¦æ‰¾å‡ºé—®é¢˜åœ¨å“ªé‡Œï¼Œå°±åƒåŒ»ç”Ÿçœ‹ç—…ä¸€æ ·ã€‚

```
æ—¥å¸¸å·¥ä½œåœºæ™¯ï¼š
ç”¨æˆ·ï¼š"æˆ‘çš„æ—¥å¿—æ€ä¹ˆæ²¡æœ‰ä¼ åˆ°Elasticsearchï¼Ÿ"
è¿ç»´ï¼š"è®©æˆ‘ä»¬æ¥è¯Šæ–­ä¸€ä¸‹Filebeatå‡ºäº†ä»€ä¹ˆé—®é¢˜"

è°ƒè¯•è¿‡ç¨‹å°±æ˜¯ï¼š
1. è§‚å¯Ÿç—‡çŠ¶ï¼ˆä»€ä¹ˆä¸æ­£å¸¸ï¼‰
2. æ”¶é›†ä¿¡æ¯ï¼ˆæŸ¥çœ‹æ—¥å¿—ã€é…ç½®ï¼‰
3. åˆ†æåŸå› ï¼ˆæ‰¾åˆ°æ ¹æœ¬é—®é¢˜ï¼‰
4. è§£å†³é—®é¢˜ï¼ˆä¿®å¤é…ç½®æˆ–ç¯å¢ƒï¼‰
```

**ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦è°ƒè¯•**
- **é—®é¢˜å‘ç°**ï¼šFilebeatè¿è¡Œå¼‚å¸¸æ—¶å¿«é€Ÿå®šä½
- **æ€§èƒ½ä¼˜åŒ–**ï¼šå‘ç°æ•ˆç‡ç“¶é¢ˆå¹¶æ”¹è¿›
- **é¢„é˜²æ•…éšœ**ï¼šæå‰å‘ç°æ½œåœ¨é—®é¢˜
- **è¿ç»´ä¿éšœ**ï¼šç¡®ä¿æ—¥å¿—ä¼ è¾“ç¨³å®šå¯é 

### 1.2 å¸¸è§é—®é¢˜ç±»å‹


**ğŸ¯ é—®é¢˜åˆ†ç±»å›¾è°±**
```
Filebeaté—®é¢˜å…¨æ™¯å›¾ï¼š

é…ç½®é—®é¢˜ (40%)          ç½‘ç»œé—®é¢˜ (25%)
â”œâ”€ è·¯å¾„é”™è¯¯              â”œâ”€ è¿æ¥è¶…æ—¶
â”œâ”€ æ ¼å¼é”™è¯¯              â”œâ”€ ç½‘ç»œä¸é€š
â”œâ”€ æƒé™é—®é¢˜              â””â”€ é˜²ç«å¢™é˜»æ–­
â””â”€ è¯­æ³•é”™è¯¯                   

æƒé™é—®é¢˜ (20%)          èµ„æºé—®é¢˜ (15%)
â”œâ”€ æ–‡ä»¶è¯»å–æƒé™          â”œâ”€ å†…å­˜ä¸è¶³
â”œâ”€ ç›®å½•è®¿é—®æƒé™          â”œâ”€ ç£ç›˜ç©ºé—´
â””â”€ è¿›ç¨‹æƒé™              â””â”€ CPUè¿‡è½½
```

---

## 2. ğŸš¨ é”™è¯¯æ’æŸ¥æŠ€å·§


### 2.1 ç³»ç»ŸåŒ–æ’æŸ¥æ€è·¯


**ğŸ”„ æ’æŸ¥æµç¨‹**
```
é—®é¢˜æŠ¥å‘Š
    â†“
ç°è±¡ç¡®è®¤ â†’ æ˜¯å¦çœŸçš„æœ‰é—®é¢˜ï¼Ÿ
    â†“
ä¿¡æ¯æ”¶é›† â†’ æ”¶é›†æ‰€æœ‰ç›¸å…³ä¿¡æ¯
    â†“
å‡è®¾éªŒè¯ â†’ é€ä¸€éªŒè¯å¯èƒ½åŸå› 
    â†“
é—®é¢˜å®šä½ â†’ æ‰¾åˆ°æ ¹æœ¬åŸå› 
    â†“
è§£å†³æ–¹æ¡ˆ â†’ å®æ–½ä¿®å¤æªæ–½
    â†“
éªŒè¯ç»“æœ â†’ ç¡®è®¤é—®é¢˜è§£å†³
```

### 2.2 å¿«é€Ÿå®šä½é—®é¢˜æŠ€å·§


**âš¡ 5åˆ†é’Ÿå¿«é€Ÿè¯Šæ–­æ³•**

**æ­¥éª¤â‘  æ£€æŸ¥æœåŠ¡çŠ¶æ€**
```bash
# æŸ¥çœ‹Filebeatæ˜¯å¦è¿è¡Œ
systemctl status filebeat

# é¢„æœŸç»“æœï¼šActive: active (running)
# å¦‚æœä¸æ˜¯runningçŠ¶æ€ï¼Œè¯´æ˜æœåŠ¡æœ¬èº«æœ‰é—®é¢˜
```

**æ­¥éª¤â‘¡ æ£€æŸ¥åŸºç¡€è¿æ¥**
```bash
# æµ‹è¯•åˆ°Elasticsearchçš„è¿æ¥
curl -X GET "localhost:9200/_cluster/health"

# é¢„æœŸç»“æœï¼šè¿”å›é›†ç¾¤çŠ¶æ€ä¿¡æ¯
# å¦‚æœè¿æ¥å¤±è´¥ï¼Œè¯´æ˜ç½‘ç»œæˆ–Elasticsearchæœ‰é—®é¢˜
```

**æ­¥éª¤â‘¢ æŸ¥çœ‹æœ€æ–°æ—¥å¿—**
```bash
# æŸ¥çœ‹æœ€è¿‘çš„é”™è¯¯æ—¥å¿—
tail -n 50 /var/log/filebeat/filebeat.log | grep ERROR

# è¿™èƒ½å¿«é€Ÿçœ‹åˆ°æœ€æ–°çš„é”™è¯¯ä¿¡æ¯
```

### 2.3 é—®é¢˜åˆ†ç±»è¯Šæ–­


**ğŸ“Š é—®é¢˜è¯Šæ–­å†³ç­–æ ‘**
```
Filebeatä¸å·¥ä½œï¼Ÿ
â”œâ”€ æœåŠ¡æœªå¯åŠ¨ â†’ æ£€æŸ¥systemctl status
â”œâ”€ é…ç½®æ–‡ä»¶é”™è¯¯ â†’ æ£€æŸ¥YAMLè¯­æ³•
â”œâ”€ æƒé™é—®é¢˜ â†’ æ£€æŸ¥æ–‡ä»¶æƒé™
â”œâ”€ ç½‘ç»œé—®é¢˜ â†’ æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
â””â”€ èµ„æºä¸è¶³ â†’ æ£€æŸ¥ç³»ç»Ÿèµ„æº
```

**ğŸ”¸ é…ç½®é—®é¢˜æ’æŸ¥**
```yaml
# å¸¸è§é…ç½®é”™è¯¯ç¤ºä¾‹
filebeat.inputs:
- type: log
  enabled: true
  paths:
    - /var/log/*.log  # âœ“ æ­£ç¡®å†™æ³•
    # - /var/log/*log  # âœ— è·¯å¾„é”™è¯¯ï¼Œå°‘äº†ç‚¹å·
  
output.elasticsearch:
  hosts: ["localhost:9200"]  # âœ“ æ­£ç¡®æ ¼å¼
  # host: "localhost:9200"   # âœ— å­—æ®µåé”™è¯¯ï¼Œåº”è¯¥æ˜¯hosts
```

**ğŸ”¸ æƒé™é—®é¢˜æ’æŸ¥**
```bash
# æ£€æŸ¥æ–‡ä»¶æƒé™
ls -la /var/log/nginx/access.log
# ç»“æœï¼š-rw-r--r-- 1 nginx nginx 1234 Sep 21 10:30 access.log

# æ£€æŸ¥Filebeatç”¨æˆ·æ˜¯å¦èƒ½è¯»å–
sudo -u filebeat cat /var/log/nginx/access.log
# å¦‚æœæç¤ºPermission deniedï¼Œè¯´æ˜æƒé™ä¸å¤Ÿ
```

---

## 3. ğŸ”§ è°ƒè¯•æ¨¡å¼ä½¿ç”¨


### 3.1 å¼€å¯è°ƒè¯•æ¨¡å¼


**ğŸ’¡ ä»€ä¹ˆæ˜¯è°ƒè¯•æ¨¡å¼**
è°ƒè¯•æ¨¡å¼å°±åƒç»™Filebeatè£…ä¸Š"æ”¾å¤§é•œ"ï¼Œè®©å®ƒæŠŠæ‰€æœ‰çš„å·¥ä½œç»†èŠ‚éƒ½å‘Šè¯‰æˆ‘ä»¬ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½çœ‹åˆ°å®ƒåˆ°åº•åœ¨åšä»€ä¹ˆã€‚

**ğŸš€ å¯ç”¨è°ƒè¯•çš„æ–¹æ³•**

**æ–¹æ³•â‘  å‘½ä»¤è¡Œå¯ç”¨**
```bash
# ç›´æ¥åœ¨å‘½ä»¤è¡Œå¼€å¯è°ƒè¯•
./filebeat -e -d "*"

# å‚æ•°è¯´æ˜ï¼š
# -e: è¾“å‡ºåˆ°stderrï¼Œåœ¨ç»ˆç«¯æ˜¾ç¤ºæ—¥å¿—
# -d "*": å¼€å¯æ‰€æœ‰æ¨¡å—çš„è°ƒè¯•ä¿¡æ¯
```

**æ–¹æ³•â‘¡ é…ç½®æ–‡ä»¶å¯ç”¨**
```yaml
# åœ¨filebeat.ymlä¸­é…ç½®
logging.level: debug
logging.to_stderr: true
logging.to_files: true

# è¿™æ ·é…ç½®åï¼Œé‡å¯Filebeatå°±ä¼šè¾“å‡ºè¯¦ç»†è°ƒè¯•ä¿¡æ¯
```

### 3.2 è°ƒè¯•ä¿¡æ¯è§£è¯»


**ğŸ“– è°ƒè¯•æ—¥å¿—ç¤ºä¾‹**
```
2025-09-21T10:30:01.123Z	DEBUG	[input]	log/input.go:162	Start next scan
2025-09-21T10:30:01.124Z	DEBUG	[input]	log/harvester.go:89	Reading from /var/log/nginx/access.log
2025-09-21T10:30:01.125Z	DEBUG	[publish]	pipeline/client.go:145	Pipeline client published event
```

**ğŸ” æ—¥å¿—ä¿¡æ¯åˆ†è§£**
- **æ—¶é—´æˆ³**ï¼š`2025-09-21T10:30:01.123Z` - äº‹ä»¶å‘ç”Ÿçš„ç²¾ç¡®æ—¶é—´
- **çº§åˆ«**ï¼š`DEBUG` - æ—¥å¿—çº§åˆ«ï¼Œè¿˜æœ‰INFOã€WARNã€ERROR
- **æ¨¡å—**ï¼š`[input]` - å“ªä¸ªåŠŸèƒ½æ¨¡å—äº§ç”Ÿçš„æ—¥å¿—
- **æ–‡ä»¶ä½ç½®**ï¼š`log/input.go:162` - ä»£ç æ–‡ä»¶å’Œè¡Œå·
- **æ¶ˆæ¯å†…å®¹**ï¼šå…·ä½“çš„æ“ä½œæè¿°

### 3.3 è°ƒè¯•æ¨¡å¼æœ€ä½³å®è·µ


**âš ï¸ è°ƒè¯•æ³¨æ„äº‹é¡¹**
- **æ€§èƒ½å½±å“**ï¼šè°ƒè¯•æ¨¡å¼ä¼šäº§ç”Ÿå¤§é‡æ—¥å¿—ï¼Œå½±å“æ€§èƒ½
- **ç£ç›˜ç©ºé—´**ï¼šè°ƒè¯•æ—¥å¿—ä¼šå¿«é€Ÿæ¶ˆè€—ç£ç›˜ç©ºé—´
- **ç”Ÿäº§ç¯å¢ƒ**ï¼šç”Ÿäº§ç¯å¢ƒæ…ç”¨ï¼Œå»ºè®®åªåœ¨æµ‹è¯•ç¯å¢ƒå¼€å¯

**ğŸ’¡ å®ç”¨è°ƒè¯•æŠ€å·§**
```bash
# åªå¼€å¯ç‰¹å®šæ¨¡å—çš„è°ƒè¯•
./filebeat -e -d "input,output"

# ä¸´æ—¶è°ƒè¯•ï¼Œè¾“å‡ºåˆ°æ–‡ä»¶
./filebeat -e -d "*" > debug.log 2>&1

# è°ƒè¯•å®Œæˆåè®°å¾—å…³é—­
# ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå°†logging.levelæ”¹å›info
```

---

## 4. ğŸ“‹ æ—¥å¿—åˆ†ææ–¹æ³•


### 4.1 æ—¥å¿—æ–‡ä»¶ä½ç½®


**ğŸ“ é»˜è®¤æ—¥å¿—ä½ç½®**
```
ç³»ç»Ÿå®‰è£…ï¼š
â”œâ”€ CentOS/RHEL: /var/log/filebeat/
â”œâ”€ Ubuntu/Debian: /var/log/filebeat/
â”œâ”€ Windows: C:\ProgramData\Elastic\Beats\filebeat\logs\
â””â”€ Docker: å®¹å™¨å†… /usr/share/filebeat/logs/
```

**ğŸ” æŸ¥æ‰¾æ—¥å¿—æ–‡ä»¶**
```bash
# æ–¹æ³•1ï¼šæŸ¥çœ‹é…ç½®æ–‡ä»¶ä¸­çš„æ—¥å¿—è·¯å¾„
grep -n "logging" /etc/filebeat/filebeat.yml

# æ–¹æ³•2ï¼šæŸ¥æ‰¾æ‰€æœ‰filebeatç›¸å…³æ—¥å¿—
find /var/log -name "*filebeat*" -type f

# æ–¹æ³•3ï¼šæŸ¥çœ‹systemdæœåŠ¡æ—¥å¿—
journalctl -u filebeat -f
```

### 4.2 æ—¥å¿—çº§åˆ«ç†è§£


**ğŸ“Š æ—¥å¿—çº§åˆ«è¯´æ˜**

| çº§åˆ« | **å«ä¹‰** | **ä»€ä¹ˆæ—¶å€™å‡ºç°** | **æ˜¯å¦éœ€è¦å…³æ³¨** |
|------|---------|-----------------|----------------|
| `DEBUG` | `è°ƒè¯•ä¿¡æ¯` | `å¼€å¯è°ƒè¯•æ¨¡å¼æ—¶` | `æ’æŸ¥é—®é¢˜æ—¶å…³æ³¨` |
| `INFO` | `æ­£å¸¸ä¿¡æ¯` | `æ­£å¸¸è¿è¡Œæ—¶` | `ä¸€èˆ¬ä¸éœ€è¦å…³æ³¨` |
| `WARN` | `è­¦å‘Šä¿¡æ¯` | `æœ‰æ½œåœ¨é—®é¢˜æ—¶` | `éœ€è¦å…³æ³¨ï¼Œå¯èƒ½å½±å“æ€§èƒ½` |
| `ERROR` | `é”™è¯¯ä¿¡æ¯` | `å‡ºç°é—®é¢˜æ—¶` | `å¿…é¡»å…³æ³¨å¹¶è§£å†³` |
| `FATAL` | `è‡´å‘½é”™è¯¯` | `ä¸¥é‡é”™è¯¯ï¼Œç¨‹åºé€€å‡º` | `ç´§æ€¥å¤„ç†` |

### 4.3 å¸¸è§æ—¥å¿—æ¨¡å¼


**ğŸ” æ­£å¸¸è¿è¡Œæ—¥å¿—æ¨¡å¼**
```
INFO	Filebeat started
INFO	Loading and starting Inputs
INFO	Input 'log' starting
INFO	Harvester started for file: /var/log/nginx/access.log
INFO	Pipeline started
```

**âš ï¸ è­¦å‘Šæ—¥å¿—æ¨¡å¼**
```
WARN	Harvester could not be started on new file: /var/log/app.log, Reason: file not accessible
WARN	Can not index event (status=429): {"type":"es_rejected_execution_exception"}
```

**ğŸš¨ é”™è¯¯æ—¥å¿—æ¨¡å¼**
```
ERROR	Connection to elasticsearch failed: dial tcp: lookup elasticsearch on no such host
ERROR	Failed to connect to elasticsearch: dial tcp 127.0.0.1:9200: connect: connection refused
```

### 4.4 æ—¥å¿—åˆ†æå·¥å…·


**ğŸ› ï¸ å®ç”¨åˆ†æå‘½ä»¤**
```bash
# ç»Ÿè®¡é”™è¯¯æ•°é‡
grep -c "ERROR" /var/log/filebeat/filebeat.log

# æŸ¥çœ‹æœ€è¿‘çš„é”™è¯¯ï¼ˆæœ€å10ä¸ªï¼‰
grep "ERROR" /var/log/filebeat/filebeat.log | tail -10

# æŒ‰æ—¶é—´èŒƒå›´æŸ¥çœ‹æ—¥å¿—
grep "2025-09-21T10:" /var/log/filebeat/filebeat.log

# æŸ¥çœ‹ç‰¹å®šæ–‡ä»¶ç›¸å…³çš„æ—¥å¿—
grep "nginx/access.log" /var/log/filebeat/filebeat.log
```

---

## 5. ğŸŒ ç½‘ç»œé—®é¢˜å®šä½


### 5.1 ç½‘ç»œè¿æ¥æµ‹è¯•


**ğŸ”§ åŸºç¡€è¿é€šæ€§æµ‹è¯•**

**pingæµ‹è¯•**
```bash
# æµ‹è¯•åˆ°ElasticsearchæœåŠ¡å™¨çš„åŸºç¡€è¿é€šæ€§
ping elasticsearch-server.com

# é¢„æœŸç»“æœï¼šèƒ½æ”¶åˆ°å›å¤åŒ…
# å¦‚æœè¶…æ—¶ï¼Œè¯´æ˜ç½‘ç»œä¸é€šæˆ–æœåŠ¡å™¨ä¸å­˜åœ¨
```

**ç«¯å£è¿æ¥æµ‹è¯•**
```bash
# æµ‹è¯•Elasticsearchç«¯å£æ˜¯å¦å¼€æ”¾
telnet elasticsearch-server.com 9200

# æˆ–è€…ä½¿ç”¨ncå‘½ä»¤
nc -zv elasticsearch-server.com 9200

# é¢„æœŸç»“æœï¼šConnection succeeded
# å¦‚æœè¿æ¥å¤±è´¥ï¼Œè¯´æ˜ç«¯å£æœªå¼€æ”¾æˆ–è¢«é˜²ç«å¢™é˜»æ–­
```

**HTTPè¿æ¥æµ‹è¯•**
```bash
# æµ‹è¯•Elasticsearch HTTPæ¥å£
curl -X GET "http://elasticsearch-server.com:9200/"

# é¢„æœŸè¿”å›ï¼š
# {
#   "name" : "node-1",
#   "cluster_name" : "elasticsearch",
#   "version" : { ... }
# }
```

### 5.2 ç½‘ç»œé—®é¢˜åˆ†ç±»


**ğŸ“Š ç½‘ç»œé—®é¢˜ç±»å‹**
```
ç½‘ç»œé—®é¢˜åˆ†ç±»ï¼š

è¿æ¥å±‚é—®é¢˜               åº”ç”¨å±‚é—®é¢˜
â”œâ”€ ç‰©ç†ç½‘ç»œä¸é€š          â”œâ”€ HTTPåè®®é”™è¯¯
â”œâ”€ è·¯ç”±é—®é¢˜              â”œâ”€ è®¤è¯å¤±è´¥
â”œâ”€ é˜²ç«å¢™é˜»æ–­            â”œâ”€ è¯ä¹¦é—®é¢˜
â””â”€ ç«¯å£æœªå¼€æ”¾            â””â”€ ä»£ç†é…ç½®é”™è¯¯
```

### 5.3 é˜²ç«å¢™æ£€æŸ¥


**ğŸ”’ é˜²ç«å¢™æ’æŸ¥**
```bash
# CentOS/RHEL æ£€æŸ¥é˜²ç«å¢™çŠ¶æ€
systemctl status firewalld

# æŸ¥çœ‹å¼€æ”¾çš„ç«¯å£
firewall-cmd --list-ports

# ä¸´æ—¶å¼€æ”¾ç«¯å£ï¼ˆæµ‹è¯•ç”¨ï¼‰
firewall-cmd --add-port=9200/tcp

# Ubuntu æ£€æŸ¥é˜²ç«å¢™
ufw status

# å¼€æ”¾ç«¯å£
ufw allow 9200/tcp
```

### 5.4 DNSè§£ææ£€æŸ¥


**ğŸ” DNSé—®é¢˜æ’æŸ¥**
```bash
# æ£€æŸ¥åŸŸåè§£æ
nslookup elasticsearch-server.com

# æˆ–ä½¿ç”¨digå‘½ä»¤
dig elasticsearch-server.com

# å¦‚æœè§£æå¤±è´¥ï¼Œå¯ä»¥ï¼š
# 1. æ£€æŸ¥/etc/hostsæ–‡ä»¶
# 2. æ£€æŸ¥DNSæœåŠ¡å™¨é…ç½®
# 3. ä¸´æ—¶ä½¿ç”¨IPåœ°å€
```

---

## 6. ğŸ”Œ è¿æ¥é—®é¢˜æ’æŸ¥


### 6.1 Elasticsearchè¿æ¥é—®é¢˜


**âš¡ è¿æ¥é—®é¢˜å¿«é€Ÿè¯Šæ–­**

**æ­¥éª¤â‘  æ£€æŸ¥ElasticsearchçŠ¶æ€**
```bash
# æ£€æŸ¥Elasticsearchæ˜¯å¦è¿è¡Œ
curl -X GET "localhost:9200/_cluster/health?pretty"

# å¥åº·çŠ¶æ€è¯´æ˜ï¼š
# green: æ‰€æœ‰åŠŸèƒ½æ­£å¸¸
# yellow: åŠŸèƒ½æ­£å¸¸ä½†æœ‰è­¦å‘Š
# red: æœ‰ä¸¥é‡é—®é¢˜
```

**æ­¥éª¤â‘¡ æ£€æŸ¥è¿æ¥é…ç½®**
```yaml
# filebeat.ymlä¸­çš„è¾“å‡ºé…ç½®
output.elasticsearch:
  hosts: ["elasticsearch:9200"]
  protocol: "http"  # æˆ– "https"
  username: "elastic"
  password: "changeme"
  
# å¸¸è§é”™è¯¯ï¼š
# - ä¸»æœºåå†™é”™
# - ç«¯å£å·é”™è¯¯
# - åè®®ä¸åŒ¹é…ï¼ˆhttp vs httpsï¼‰
# - è®¤è¯ä¿¡æ¯é”™è¯¯
```

### 6.2 è®¤è¯é—®é¢˜è§£å†³


**ğŸ” è®¤è¯é…ç½®**
```yaml
# ç”¨æˆ·åå¯†ç è®¤è¯
output.elasticsearch:
  hosts: ["localhost:9200"]
  username: "filebeat_writer"
  password: "your_password"

# API Keyè®¤è¯
output.elasticsearch:
  hosts: ["localhost:9200"]
  api_key: "your_api_key"

# è¯ä¹¦è®¤è¯
output.elasticsearch:
  hosts: ["https://localhost:9200"]
  ssl.certificate_authorities: ["/etc/certs/ca.crt"]
  ssl.certificate: "/etc/certs/client.crt"
  ssl.key: "/etc/certs/client.key"
```

### 6.3 SSL/TLSé—®é¢˜


**ğŸ”’ HTTPSè¿æ¥é—®é¢˜**
```yaml
# å¼€å‘ç¯å¢ƒï¼šå¿½ç•¥è¯ä¹¦éªŒè¯ï¼ˆä»…æµ‹è¯•ç”¨ï¼‰
output.elasticsearch:
  hosts: ["https://localhost:9200"]
  ssl.verification_mode: none

# ç”Ÿäº§ç¯å¢ƒï¼šæ­£ç¡®é…ç½®è¯ä¹¦
output.elasticsearch:
  hosts: ["https://localhost:9200"]
  ssl.certificate_authorities: ["/path/to/ca.crt"]
  ssl.verification_mode: certificate
```

**ğŸ” è¯ä¹¦é—®é¢˜è¯Šæ–­**
```bash
# æŸ¥çœ‹è¯ä¹¦ä¿¡æ¯
openssl s_client -connect elasticsearch-server.com:9200 -servername elasticsearch-server.com

# æµ‹è¯•è¯ä¹¦æ˜¯å¦æœ‰æ•ˆ
curl -k https://elasticsearch-server.com:9200/  # -k å¿½ç•¥è¯ä¹¦é”™è¯¯

# å¦‚æœåŠ -kèƒ½è¿æ¥ï¼Œä¸åŠ -kä¸èƒ½è¿æ¥ï¼Œè¯´æ˜æ˜¯è¯ä¹¦é—®é¢˜
```

---

## 7. âœ… é…ç½®éªŒè¯æ–¹æ³•


### 7.1 é…ç½®æ–‡ä»¶è¯­æ³•æ£€æŸ¥


**ğŸ“ YAMLè¯­æ³•éªŒè¯**

**ä½¿ç”¨Filebeatå†…ç½®éªŒè¯**
```bash
# éªŒè¯é…ç½®æ–‡ä»¶è¯­æ³•
filebeat test config

# é¢„æœŸè¾“å‡ºï¼šConfig OK
# å¦‚æœæœ‰é”™è¯¯ï¼Œä¼šæ˜¾ç¤ºå…·ä½“çš„é”™è¯¯ä¿¡æ¯å’Œè¡Œå·
```

**å¸¸è§YAMLè¯­æ³•é”™è¯¯**
```yaml
# âœ— é”™è¯¯ï¼šç¼©è¿›ä¸å¯¹
filebeat.inputs:
- type: log
enabled: true  # ç¼ºå°‘ç¼©è¿›

# âœ“ æ­£ç¡®ï¼šç¼©è¿›å¯¹é½
filebeat.inputs:
- type: log
  enabled: true

# âœ— é”™è¯¯ï¼šå†’å·åæ²¡æœ‰ç©ºæ ¼
filebeat.inputs:- type: log

# âœ“ æ­£ç¡®ï¼šå†’å·åæœ‰ç©ºæ ¼
filebeat.inputs:
- type: log
```

### 7.2 è¾“å‡ºè¿æ¥æµ‹è¯•


**ğŸ”— æµ‹è¯•è¾“å‡ºè¿æ¥**
```bash
# æµ‹è¯•Elasticsearchè¿æ¥
filebeat test output

# æˆåŠŸè¾“å‡ºç¤ºä¾‹ï¼š
# elasticsearch: http://localhost:9200...
#   parse url... OK
#   connection...
#     parse host... OK
#     dns lookup... OK
#     addresses: 127.0.0.1
#     dial up... OK
#   TLS... WARN secure connection disabled
#   talk to server... OK
```

### 7.3 è¾“å…¥é…ç½®æµ‹è¯•


**ğŸ“ æµ‹è¯•è¾“å…¥é…ç½®**
```bash
# æµ‹è¯•è¾“å…¥é…ç½®æ˜¯å¦æ­£ç¡®
filebeat test inputs

# è¿™ä¼šæ˜¾ç¤ºï¼š
# - èƒ½æ‰¾åˆ°å“ªäº›æ–‡ä»¶
# - æƒé™æ˜¯å¦æ­£ç¡®
# - æ˜¯å¦èƒ½è¯»å–æ–‡ä»¶å†…å®¹
```

### 7.4 å®Œæ•´é…ç½®éªŒè¯æµç¨‹


**ğŸ”„ å®Œæ•´éªŒè¯æ­¥éª¤**
```bash
# æ­¥éª¤1ï¼šè¯­æ³•æ£€æŸ¥
filebeat test config
echo "é…ç½®è¯­æ³•æ£€æŸ¥: $?"

# æ­¥éª¤2ï¼šè¾“å‡ºæµ‹è¯•
filebeat test output
echo "è¾“å‡ºè¿æ¥æµ‹è¯•: $?"

# æ­¥éª¤3ï¼šè¾“å…¥æµ‹è¯•
filebeat test inputs
echo "è¾“å…¥é…ç½®æµ‹è¯•: $?"

# æ­¥éª¤4ï¼šå¯åŠ¨å‰æœ€åæ£€æŸ¥
filebeat --dry-run -c /etc/filebeat/filebeat.yml
```

---

## 8. ğŸ› ï¸ å®ç”¨è°ƒè¯•å·¥å…·


### 8.1 å‘½ä»¤è¡Œå·¥å…·


**ğŸ“Š ç³»ç»Ÿç›‘æ§å·¥å…·**
```bash
# æŸ¥çœ‹Filebeatè¿›ç¨‹èµ„æºä½¿ç”¨
top -p $(pgrep filebeat)

# æŸ¥çœ‹æ–‡ä»¶å¥æŸ„ä½¿ç”¨æƒ…å†µ
lsof -p $(pgrep filebeat)

# æŸ¥çœ‹ç½‘ç»œè¿æ¥
netstat -an | grep :9200

# æŸ¥çœ‹ç£ç›˜ç©ºé—´
df -h /var/log
```

### 8.2 æ—¥å¿—å®æ—¶ç›‘æ§


**ğŸ‘€ å®æ—¶æŸ¥çœ‹æ—¥å¿—**
```bash
# å®æ—¶ç›‘æ§Filebeatæ—¥å¿—
tail -f /var/log/filebeat/filebeat.log

# åªçœ‹é”™è¯¯ä¿¡æ¯
tail -f /var/log/filebeat/filebeat.log | grep ERROR

# ä½¿ç”¨multitailåŒæ—¶ç›‘æ§å¤šä¸ªæ—¥å¿—
multitail /var/log/filebeat/filebeat.log /var/log/nginx/access.log
```

### 8.3 æ€§èƒ½åˆ†æå·¥å…·


**âš¡ æ€§èƒ½ç›‘æ§**
```bash
# ä½¿ç”¨iostatç›‘æ§ç£ç›˜IO
iostat -x 1

# ä½¿ç”¨iotopæŸ¥çœ‹è¿›ç¨‹IO
iotop -p $(pgrep filebeat)

# å†…å­˜ä½¿ç”¨åˆ†æ
pmap $(pgrep filebeat)
```

### 8.4 è°ƒè¯•å·¥å…·è„šæœ¬


**ğŸ”§ å¿«é€Ÿè¯Šæ–­è„šæœ¬**
```bash
#!/bin/bash
# filebeat_debug.sh - Filebeatå¿«é€Ÿè¯Šæ–­è„šæœ¬

echo "=== FilebeatçŠ¶æ€æ£€æŸ¥ ==="
systemctl status filebeat

echo "=== é…ç½®æ–‡ä»¶æ£€æŸ¥ ==="
filebeat test config

echo "=== è¿æ¥æµ‹è¯• ==="
filebeat test output

echo "=== è¿›ç¨‹èµ„æºä½¿ç”¨ ==="
ps aux | grep filebeat

echo "=== æœ€æ–°é”™è¯¯æ—¥å¿— ==="
tail -10 /var/log/filebeat/filebeat.log | grep ERROR
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„è°ƒè¯•æŠ€èƒ½


```
ğŸ”¸ åŸºç¡€è¯Šæ–­ï¼šå¿«é€Ÿåˆ¤æ–­Filebeatæ˜¯å¦æ­£å¸¸è¿è¡Œ
ğŸ”¸ æ—¥å¿—åˆ†æï¼šèƒ½çœ‹æ‡‚Filebeatæ—¥å¿—ï¼Œè¯†åˆ«é”™è¯¯ç±»å‹
ğŸ”¸ ç½‘ç»œæ’æŸ¥ï¼šæ£€æŸ¥ç½‘ç»œè¿é€šæ€§å’Œç«¯å£å¼€æ”¾æƒ…å†µ
ğŸ”¸ é…ç½®éªŒè¯ï¼šä½¿ç”¨å†…ç½®å‘½ä»¤éªŒè¯é…ç½®æ­£ç¡®æ€§
ğŸ”¸ é—®é¢˜å®šä½ï¼šç³»ç»ŸåŒ–åœ°åˆ†æå’Œè§£å†³é—®é¢˜
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ è°ƒè¯•æ€ç»´**
```
é—®é¢˜å‡ºç°æ—¶ä¸è¦æ…Œå¼ ï¼ŒæŒ‰æ­¥éª¤æ’æŸ¥ï¼š
1. ç¡®è®¤é—®é¢˜ç°è±¡
2. æ”¶é›†ç›¸å…³ä¿¡æ¯
3. é€ä¸€éªŒè¯å‡è®¾
4. å®šä½æ ¹æœ¬åŸå› 
5. å®æ–½è§£å†³æ–¹æ¡ˆ
```

**ğŸ”¹ æ—¥å¿—é‡è¦æ€§**
```
æ—¥å¿—æ˜¯è°ƒè¯•çš„æœ€ä½³æœ‹å‹ï¼š
- DEBUGçº§åˆ«ï¼šçœ‹è¯¦ç»†æ‰§è¡Œè¿‡ç¨‹
- INFOçº§åˆ«ï¼šçœ‹æ­£å¸¸è¿è¡ŒçŠ¶æ€
- WARNçº§åˆ«ï¼šæ³¨æ„æ½œåœ¨é—®é¢˜
- ERRORçº§åˆ«ï¼šå¿…é¡»è§£å†³çš„é—®é¢˜
```

**ğŸ”¹ ç½‘ç»œé—®é¢˜ç‰¹ç‚¹**
```
ç½‘ç»œé—®é¢˜é€šå¸¸è¡¨ç°ä¸ºï¼š
- è¿æ¥è¶…æ—¶æˆ–æ‹’ç»
- é—´æ­‡æ€§è¿æ¥å¤±è´¥
- æ•°æ®ä¼ è¾“ä¸­æ–­
- è®¤è¯å¤±è´¥
```

### 9.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ’¼ å·¥ä½œåœºæ™¯åº”ç”¨**
- **æ—¥å¸¸è¿ç»´**ï¼šå¿«é€Ÿå®šä½Filebeatè¿è¡Œé—®é¢˜
- **æ€§èƒ½ä¼˜åŒ–**ï¼šé€šè¿‡æ—¥å¿—åˆ†æå‘ç°æ€§èƒ½ç“¶é¢ˆ
- **æ•…éšœå¤„ç†**ï¼šç³»ç»ŸåŒ–è§£å†³å„ç±»æ•…éšœ
- **é¢„é˜²ç»´æŠ¤**ï¼šæå‰å‘ç°å’Œå¤„ç†æ½œåœ¨é—®é¢˜

**ğŸ”§ æœ€ä½³å®è·µå»ºè®®**
- **å®šæœŸæ£€æŸ¥**ï¼šæ¯å‘¨æ£€æŸ¥Filebeatè¿è¡ŒçŠ¶æ€å’Œæ—¥å¿—
- **ç›‘æ§å‘Šè­¦**ï¼šè®¾ç½®å…³é”®æŒ‡æ ‡çš„ç›‘æ§å‘Šè­¦
- **æ–‡æ¡£è®°å½•**ï¼šè®°å½•å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ³•
- **å¤‡ä»½é…ç½®**ï¼šé‡è¦é…ç½®æ–‡ä»¶è¦æœ‰å¤‡ä»½

### 9.4 è°ƒè¯•å·¥å…·ç®±


**ğŸ¯ å¿…å¤‡å‘½ä»¤æ¸…å•**
```bash
# çŠ¶æ€æ£€æŸ¥
systemctl status filebeat
filebeat test config
filebeat test output

# æ—¥å¿—æŸ¥çœ‹
tail -f /var/log/filebeat/filebeat.log
grep ERROR /var/log/filebeat/filebeat.log

# ç½‘ç»œæµ‹è¯•
ping elasticsearch-server
curl -X GET "localhost:9200/"
netstat -an | grep :9200

# èµ„æºç›‘æ§
top -p $(pgrep filebeat)
lsof -p $(pgrep filebeat)
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- è°ƒè¯•å°±æ˜¯ç³»ç»ŸåŒ–åœ°æ‰¾é—®é¢˜å’Œè§£å†³é—®é¢˜
- æ—¥å¿—æ˜¯æœ€é‡è¦çš„è°ƒè¯•ä¿¡æ¯æ¥æº
- ç½‘ç»œè¿é€šæ€§æ˜¯æœ€å¸¸è§çš„é—®é¢˜ç±»å‹
- é…ç½®éªŒè¯èƒ½é¢„é˜²å¤§éƒ¨åˆ†é—®é¢˜
- æŒæ¡åŸºç¡€å·¥å…·å°±èƒ½è§£å†³80%çš„é—®é¢˜