---
title: 3ã€åœ¨çº¿èŠå¤©åŠŸèƒ½
---
## ğŸ“š ç›®å½•

1. [èŠå¤©å®¤æ¶æ„è®¾è®¡](#1-èŠå¤©å®¤æ¶æ„è®¾è®¡)
2. [æˆ¿é—´æ¦‚å¿µè®¾è®¡åŸç†](#2-æˆ¿é—´æ¦‚å¿µè®¾è®¡åŸç†)
3. [æ¶ˆæ¯å¹¿æ’­æœºåˆ¶](#3-æ¶ˆæ¯å¹¿æ’­æœºåˆ¶)
4. [ç”¨æˆ·çŠ¶æ€åŒæ­¥ç­–ç•¥](#4-ç”¨æˆ·çŠ¶æ€åŒæ­¥ç­–ç•¥)
5. [å†å²æ¶ˆæ¯åŠ è½½æ–¹æ¡ˆ](#5-å†å²æ¶ˆæ¯åŠ è½½æ–¹æ¡ˆ)
6. [åœ¨çº¿ç”¨æˆ·åˆ—è¡¨ç®¡ç†](#6-åœ¨çº¿ç”¨æˆ·åˆ—è¡¨ç®¡ç†)
7. [æ¶ˆæ¯å»é‡æœºåˆ¶å®ç°](#7-æ¶ˆæ¯å»é‡æœºåˆ¶å®ç°)
8. [èŠå¤©åŠŸèƒ½å®Œæ•´å®ç°](#8-èŠå¤©åŠŸèƒ½å®Œæ•´å®ç°)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ—ï¸ èŠå¤©å®¤æ¶æ„è®¾è®¡


### 1.1 æ•´ä½“æ¶æ„æ€è·¯


**ğŸ¯ ä»€ä¹ˆæ˜¯èŠå¤©å®¤æ¶æ„**
èŠå¤©å®¤æ¶æ„å°±åƒç°å®ä¸­çš„ä¼šè®®å®¤ç³»ç»Ÿ - æœ‰ä¸åŒçš„æˆ¿é—´ï¼Œæ¯ä¸ªæˆ¿é—´é‡Œçš„äººå¯ä»¥äº’ç›¸è¯´è¯ï¼Œæˆ¿é—´å¤–çš„äººå¬ä¸åˆ°ã€‚

```
ç°å®ä¸­çš„ä¼šè®®ç³»ç»Ÿï¼š              åœ¨çº¿èŠå¤©ç³»ç»Ÿï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¼šè®®å®¤A     â”‚ â†â†’             â”‚  èŠå¤©å®¤A     â”‚
â”‚ ğŸ‘¤ğŸ‘¤ğŸ‘¤      â”‚                â”‚ ç”¨æˆ·1,2,3   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¼šè®®å®¤B     â”‚ â†â†’             â”‚  èŠå¤©å®¤B     â”‚
â”‚ ğŸ‘¤ğŸ‘¤        â”‚                â”‚ ç”¨æˆ·4,5     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ’¡ æ ¸å¿ƒè®¾è®¡æ€è·¯**
- **æœåŠ¡å™¨ç«¯**ï¼šç®¡ç†æ‰€æœ‰æˆ¿é—´å’Œç”¨æˆ·è¿æ¥
- **å®¢æˆ·ç«¯**ï¼šè¿æ¥åˆ°æœåŠ¡å™¨ï¼ŒåŠ å…¥ç‰¹å®šæˆ¿é—´
- **æ¶ˆæ¯æµè½¬**ï¼šç”¨æˆ·å‘æ¶ˆæ¯ â†’ æœåŠ¡å™¨æ¥æ”¶ â†’ å¹¿æ’­ç»™æˆ¿é—´å†…å…¶ä»–ç”¨æˆ·

### 1.2 æŠ€æœ¯æ¶æ„ç»„æˆ


**ğŸ”§ ä¸»è¦ç»„ä»¶**
```
å®¢æˆ·ç«¯ (æµè§ˆå™¨)
    â†• SSEè¿æ¥
æœåŠ¡å™¨ç«¯ (Node.js)
    â”œâ”€â”€ æˆ¿é—´ç®¡ç†å™¨ (ç®¡ç†æ‰€æœ‰èŠå¤©å®¤)
    â”œâ”€â”€ ç”¨æˆ·ç®¡ç†å™¨ (è·Ÿè¸ªåœ¨çº¿ç”¨æˆ·)
    â”œâ”€â”€ æ¶ˆæ¯å¤„ç†å™¨ (å¤„ç†å’Œè½¬å‘æ¶ˆæ¯)
    â””â”€â”€ æ•°æ®å­˜å‚¨ (ä¿å­˜å†å²æ¶ˆæ¯)
```

**âš¡ æ•°æ®æµå‘**
```
ç”¨æˆ·Aå‘æ¶ˆæ¯ â†’ æœåŠ¡å™¨æ¥æ”¶ â†’ æŸ¥æ‰¾æˆ¿é—´å†…ç”¨æˆ· â†’ æ¨é€ç»™ç”¨æˆ·B,C,D
     â†‘                                           â†“
   HTTP POST                                SSEæ¨é€
```

### 1.3 ç®€å•æ¶æ„ç¤ºä¾‹


```javascript
// æœåŠ¡ç«¯æ ¸å¿ƒç»“æ„ï¼ˆç®€åŒ–ç‰ˆï¼‰
class ChatServer {
    constructor() {
        this.rooms = new Map();     // å­˜å‚¨æ‰€æœ‰æˆ¿é—´
        this.users = new Map();     // å­˜å‚¨æ‰€æœ‰ç”¨æˆ·è¿æ¥
    }
    
    // ç”¨æˆ·åŠ å…¥æˆ¿é—´
    joinRoom(userId, roomId) {
        // å®ç°é€»è¾‘
    }
    
    // å¹¿æ’­æ¶ˆæ¯åˆ°æˆ¿é—´
    broadcastToRoom(roomId, message) {
        // å®ç°é€»è¾‘
    }
}
```

---

## 2. ğŸ  æˆ¿é—´æ¦‚å¿µè®¾è®¡åŸç†


### 2.1 æˆ¿é—´æ˜¯ä»€ä¹ˆ


**ğŸ¯ æˆ¿é—´çš„æœ¬è´¨å«ä¹‰**
æˆ¿é—´å°±åƒQQç¾¤æˆ–å¾®ä¿¡ç¾¤ - æ˜¯ä¸€ä¸ª**è™šæ‹Ÿçš„èŠå¤©ç©ºé—´**ï¼Œé‡Œé¢çš„äººå¯ä»¥äº’ç›¸çœ‹åˆ°æ¶ˆæ¯ï¼Œå¤–é¢çš„äººçœ‹ä¸åˆ°ã€‚

```
æˆ¿é—´Aï¼šæŠ€æœ¯è®¨è®ºç¾¤
â”œâ”€â”€ ç”¨æˆ·1: "ä»Šå¤©å­¦äº†Vue"
â”œâ”€â”€ ç”¨æˆ·2: "Reactä¹Ÿä¸é”™"
â””â”€â”€ ç”¨æˆ·3: "æˆ‘åœ¨å­¦Node.js"

æˆ¿é—´Bï¼šæ¸¸æˆäº¤æµç¾¤  
â”œâ”€â”€ ç”¨æˆ·4: "ä»Šæ™šä¸€èµ·ç©æ¸¸æˆ"
â””â”€â”€ ç”¨æˆ·5: "å¥½çš„ï¼Œå‡ ç‚¹å¼€å§‹"

æˆ¿é—´Aå’ŒBäº’ç›¸ç‹¬ç«‹ï¼Œæ¶ˆæ¯ä¸ä¼šä¸²!
```

### 2.2 æˆ¿é—´ç®¡ç†åŸç†


**ğŸ’¡ æˆ¿é—´æ•°æ®ç»“æ„**
```javascript
// æˆ¿é—´å°±æ˜¯ä¸€ä¸ªç®€å•çš„å¯¹è±¡ï¼ŒåŒ…å«ç”¨æˆ·åˆ—è¡¨
const room = {
    id: 'room_001',           // æˆ¿é—´å”¯ä¸€æ ‡è¯†
    name: 'æŠ€æœ¯è®¨è®º',         // æˆ¿é—´åç§°  
    users: [                 // æˆ¿é—´å†…çš„ç”¨æˆ·åˆ—è¡¨
        { id: 'user1', name: 'å°æ˜' },
        { id: 'user2', name: 'å°çº¢' }
    ],
    messages: []             // æˆ¿é—´æ¶ˆæ¯å†å²ï¼ˆå¯é€‰ï¼‰
};
```

**ğŸ”§ æˆ¿é—´æ“ä½œå®ç°**
```javascript
class RoomManager {
    constructor() {
        this.rooms = new Map(); // ç”¨Mapå­˜å‚¨æ‰€æœ‰æˆ¿é—´
    }
    
    // åˆ›å»ºæˆ¿é—´ï¼ˆå¾ˆç®€å•ï¼‰
    createRoom(roomId, roomName) {
        this.rooms.set(roomId, {
            id: roomId,
            name: roomName,
            users: [],
            createdAt: new Date()
        });
    }
    
    // ç”¨æˆ·åŠ å…¥æˆ¿é—´
    addUserToRoom(roomId, user) {
        const room = this.rooms.get(roomId);
        if (room) {
            room.users.push(user);
        }
    }
    
    // è·å–æˆ¿é—´å†…æ‰€æœ‰ç”¨æˆ·
    getRoomUsers(roomId) {
        const room = this.rooms.get(roomId);
        return room ? room.users : [];
    }
}
```

### 2.3 æˆ¿é—´è®¾è®¡è¦ç‚¹


**âœ… è®¾è®¡åŸåˆ™**
- **éš”ç¦»æ€§**ï¼šä¸åŒæˆ¿é—´çš„æ¶ˆæ¯å®Œå…¨éš”ç¦»
- **çµæ´»æ€§**ï¼šç”¨æˆ·å¯ä»¥åŒæ—¶åœ¨å¤šä¸ªæˆ¿é—´
- **å¯æ‰©å±•**ï¼šå®¹æ˜“æ·»åŠ æˆ¿é—´æƒé™ã€å¯†ç ç­‰åŠŸèƒ½

**ğŸ¯ å®é™…åº”ç”¨åœºæ™¯**
```
æŠ€æœ¯è®ºå›ï¼š
â”œâ”€â”€ JavaScriptè®¨è®ºå®¤
â”œâ”€â”€ Pythonå­¦ä¹ å®¤  
â””â”€â”€ å‰ç«¯äº¤æµå®¤

æ¸¸æˆå¹³å°ï¼š
â”œâ”€â”€ æ–°æ‰‹æ‘èŠå¤©
â”œâ”€â”€ å…¬ä¼šé¢‘é“
â””â”€â”€ ä¸–ç•Œé¢‘é“

å®¢æœç³»ç»Ÿï¼š
â”œâ”€â”€ å”®å‰å’¨è¯¢å®¤
â”œâ”€â”€ æŠ€æœ¯æ”¯æŒå®¤
â””â”€â”€ æŠ•è¯‰å»ºè®®å®¤
```

---

## 3. ğŸ“¡ æ¶ˆæ¯å¹¿æ’­æœºåˆ¶


### 3.1 å¹¿æ’­æ˜¯ä»€ä¹ˆ


**ğŸ¯ å¹¿æ’­çš„é€šä¿—å«ä¹‰**
å¹¿æ’­å°±åƒå­¦æ ¡çš„å¹¿æ’­ç³»ç»Ÿ - å½“æœ‰é€šçŸ¥æ—¶ï¼Œä¼šåŒæ—¶ä¼ è¾¾ç»™æŒ‡å®šèŒƒå›´å†…çš„æ‰€æœ‰äººã€‚åœ¨èŠå¤©å®¤ä¸­ï¼Œå½“æœ‰äººå‘æ¶ˆæ¯æ—¶ï¼Œéœ€è¦åŒæ—¶å‘ç»™æˆ¿é—´é‡Œçš„æ‰€æœ‰å…¶ä»–äººã€‚

```
ä¼ ç»Ÿå¹¿æ’­ï¼šæ ¡é•¿è®²è¯ â†’ å¹¿æ’­ç³»ç»Ÿ â†’ å…¨æ ¡å­¦ç”Ÿéƒ½å¬åˆ°

èŠå¤©å®¤å¹¿æ’­ï¼šç”¨æˆ·Aå‘æ¶ˆæ¯ â†’ æœåŠ¡å™¨å¤„ç† â†’ æˆ¿é—´å†…ç”¨æˆ·B,C,Déƒ½æ”¶åˆ°
```

### 3.2 SSEå¹¿æ’­å®ç°åŸç†


**ğŸ’¡ æ ¸å¿ƒå®ç°é€»è¾‘**
```javascript
// 1. ä¿å­˜æ‰€æœ‰ç”¨æˆ·çš„SSEè¿æ¥
const userConnections = new Map();

// 2. ç”¨æˆ·è¿æ¥æ—¶ï¼Œä¿å­˜è¿æ¥å¯¹è±¡
app.get('/chat/:roomId/:userId', (req, res) => {
    // è®¾ç½®SSEå“åº”å¤´
    res.writeHead(200, {
        'Content-Type': 'text/event-stream',
        'Cache-Control': 'no-cache',
        'Connection': 'keep-alive'
    });
    
    // ä¿å­˜ç”¨æˆ·è¿æ¥
    const userId = req.params.userId;
    userConnections.set(userId, res);
});

// 3. å¹¿æ’­æ¶ˆæ¯ç»™æˆ¿é—´å†…æ‰€æœ‰ç”¨æˆ·
function broadcastToRoom(roomId, message, senderUserId) {
    const roomUsers = getRoomUsers(roomId); // è·å–æˆ¿é—´ç”¨æˆ·åˆ—è¡¨
    
    roomUsers.forEach(user => {
        if (user.id !== senderUserId) { // ä¸å‘ç»™è‡ªå·±
            const connection = userConnections.get(user.id);
            if (connection) {
                // å‘é€SSEæ¶ˆæ¯
                connection.write(`data: ${JSON.stringify(message)}\n\n`);
            }
        }
    });
}
```

### 3.3 æ¶ˆæ¯æ ¼å¼è®¾è®¡


**ğŸ“‹ ç»Ÿä¸€æ¶ˆæ¯æ ¼å¼**
```javascript
// æ ‡å‡†çš„èŠå¤©æ¶ˆæ¯æ ¼å¼
const message = {
    type: 'chat',           // æ¶ˆæ¯ç±»å‹
    roomId: 'room_001',     // æˆ¿é—´ID
    userId: 'user_123',     // å‘é€è€…ID  
    userName: 'å°æ˜',       // å‘é€è€…æ˜µç§°
    content: 'å¤§å®¶å¥½ï¼',    // æ¶ˆæ¯å†…å®¹
    timestamp: 1704711000000 // å‘é€æ—¶é—´æˆ³
};

// ç³»ç»Ÿé€šçŸ¥æ¶ˆæ¯æ ¼å¼
const notification = {
    type: 'notification',
    roomId: 'room_001', 
    content: 'å°æ˜åŠ å…¥äº†èŠå¤©å®¤',
    timestamp: 1704711000000
};
```

**âš¡ å¹¿æ’­å®ç°ç¤ºä¾‹**
```javascript
// å¤„ç†ç”¨æˆ·å‘é€çš„æ¶ˆæ¯
app.post('/send-message', (req, res) => {
    const { roomId, userId, userName, content } = req.body;
    
    // æ„é€ æ¶ˆæ¯å¯¹è±¡
    const message = {
        type: 'chat',
        roomId,
        userId,
        userName,
        content,
        timestamp: Date.now()
    };
    
    // å¹¿æ’­ç»™æˆ¿é—´å†…æ‰€æœ‰ç”¨æˆ·ï¼ˆé™¤äº†å‘é€è€…ï¼‰
    broadcastToRoom(roomId, message, userId);
    
    res.json({ success: true });
});
```

---

## 4. ğŸ‘¥ ç”¨æˆ·çŠ¶æ€åŒæ­¥ç­–ç•¥


### 4.1 ç”¨æˆ·çŠ¶æ€æ˜¯ä»€ä¹ˆ


**ğŸ¯ ç”¨æˆ·çŠ¶æ€çš„å«ä¹‰**
ç”¨æˆ·çŠ¶æ€å°±æ˜¯ç”¨æˆ·å½“å‰çš„æƒ…å†µ - æ¯”å¦‚åœ¨çº¿ã€ç¦»çº¿ã€æ­£åœ¨è¾“å…¥ç­‰ã€‚å°±åƒQQæ˜¾ç¤ºçš„"åœ¨çº¿"ã€"å¿™ç¢Œ"ã€"ç¦»å¼€"çŠ¶æ€ä¸€æ ·ã€‚

```
å¸¸è§ç”¨æˆ·çŠ¶æ€ï¼š
ğŸŸ¢ åœ¨çº¿    - ç”¨æˆ·æ­£åœ¨ä½¿ç”¨èŠå¤©å®¤
ğŸŸ¡ ç©ºé—²    - ç”¨æˆ·æ²¡æœ‰æ“ä½œä½†è¿æ¥è¿˜åœ¨
ğŸ”´ ç¦»çº¿    - ç”¨æˆ·å·²ç»æ–­å¼€è¿æ¥
âŒ¨ï¸ è¾“å…¥ä¸­  - ç”¨æˆ·æ­£åœ¨æ‰“å­—
```

### 4.2 çŠ¶æ€åŒæ­¥å®ç°


**ğŸ’¡ çŠ¶æ€ç®¡ç†æ ¸å¿ƒ**
```javascript
class UserStatusManager {
    constructor() {
        this.userStatus = new Map(); // å­˜å‚¨æ‰€æœ‰ç”¨æˆ·çŠ¶æ€
    }
    
    // è®¾ç½®ç”¨æˆ·çŠ¶æ€
    setUserStatus(userId, status) {
        this.userStatus.set(userId, {
            status: status,      // çŠ¶æ€ç±»å‹
            lastActive: Date.now(), // æœ€åæ´»è·ƒæ—¶é—´
            roomId: null         // å½“å‰æ‰€åœ¨æˆ¿é—´
        });
        
        // é€šçŸ¥ç›¸å…³ç”¨æˆ·çŠ¶æ€å˜åŒ–
        this.notifyStatusChange(userId, status);
    }
    
    // é€šçŸ¥çŠ¶æ€å˜åŒ–
    notifyStatusChange(userId, newStatus) {
        const user = this.getUser(userId);
        const roomId = user.roomId;
        
        if (roomId) {
            const statusMessage = {
                type: 'user_status',
                userId: userId,
                userName: user.name,
                status: newStatus,
                timestamp: Date.now()
            };
            
            // å¹¿æ’­çŠ¶æ€å˜åŒ–ç»™æˆ¿é—´å†…å…¶ä»–ç”¨æˆ·
            broadcastToRoom(roomId, statusMessage, userId);
        }
    }
}
```

### 4.3 çŠ¶æ€è‡ªåŠ¨æ£€æµ‹


**âš¡ è¿æ¥çŠ¶æ€ç›‘æ§**
```javascript
// å®šæœŸæ£€æŸ¥ç”¨æˆ·è¿æ¥çŠ¶æ€
setInterval(() => {
    userConnections.forEach((connection, userId) => {
        // æ£€æŸ¥è¿æ¥æ˜¯å¦è¿˜æ´»ç€
        if (connection.destroyed) {
            // è¿æ¥å·²æ–­å¼€ï¼Œæ›´æ–°ç”¨æˆ·çŠ¶æ€
            userStatusManager.setUserStatus(userId, 'offline');
            userConnections.delete(userId);
        }
    });
}, 30000); // æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡
```

**ğŸ”” ç”¨æˆ·æ´»è·ƒåº¦æ£€æµ‹**
```javascript
// ç”¨æˆ·å‘æ¶ˆæ¯æ—¶æ›´æ–°æ´»è·ƒçŠ¶æ€
app.post('/send-message', (req, res) => {
    const { userId } = req.body;
    
    // æ›´æ–°ç”¨æˆ·æœ€åæ´»è·ƒæ—¶é—´
    userStatusManager.setUserStatus(userId, 'online');
    
    // ... å¤„ç†æ¶ˆæ¯å‘é€
});
```

---

## 5. ğŸ“œ å†å²æ¶ˆæ¯åŠ è½½æ–¹æ¡ˆ


### 5.1 å†å²æ¶ˆæ¯çš„å¿…è¦æ€§


**ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦å†å²æ¶ˆæ¯**
å°±åƒå¾®ä¿¡èŠå¤©è®°å½•ä¸€æ ·ï¼Œç”¨æˆ·è¿›å…¥èŠå¤©å®¤æ—¶ï¼Œéœ€è¦çœ‹åˆ°ä¹‹å‰çš„å¯¹è¯å†…å®¹ï¼Œè¿™æ ·æ‰èƒ½äº†è§£ä¸Šä¸‹æ–‡ï¼Œæ›´å¥½åœ°å‚ä¸å¯¹è¯ã€‚

```
ç”¨æˆ·ä½“éªŒå¯¹æ¯”ï¼š

æ²¡æœ‰å†å²æ¶ˆæ¯ï¼š
ç”¨æˆ·è¿›å…¥ â†’ çœ‹åˆ°ç©ºç™½ â†’ ä¸çŸ¥é“å¤§å®¶åœ¨èŠä»€ä¹ˆ â†’ ä½“éªŒå·®

æœ‰å†å²æ¶ˆæ¯ï¼š
ç”¨æˆ·è¿›å…¥ â†’ çœ‹åˆ°æœ€è¿‘èŠå¤© â†’ å¿«é€Ÿäº†è§£è¯é¢˜ â†’ å‚ä¸å¯¹è¯ â†’ ä½“éªŒå¥½
```

### 5.2 æ¶ˆæ¯å­˜å‚¨è®¾è®¡


**ğŸ’¾ ç®€å•å­˜å‚¨æ–¹æ¡ˆ**
```javascript
class MessageStorage {
    constructor() {
        this.messages = new Map(); // roomId -> messages[]
    }
    
    // ä¿å­˜æ¶ˆæ¯
    saveMessage(roomId, message) {
        if (!this.messages.has(roomId)) {
            this.messages.set(roomId, []);
        }
        
        const roomMessages = this.messages.get(roomId);
        roomMessages.push({
            ...message,
            id: this.generateMessageId(), // ç”Ÿæˆæ¶ˆæ¯ID
            createdAt: new Date()
        });
        
        // é™åˆ¶å†å²æ¶ˆæ¯æ•°é‡ï¼ˆæ¯”å¦‚åªä¿ç•™æœ€è¿‘1000æ¡ï¼‰
        if (roomMessages.length > 1000) {
            roomMessages.shift(); // åˆ é™¤æœ€è€çš„æ¶ˆæ¯
        }
    }
    
    // è·å–å†å²æ¶ˆæ¯
    getRecentMessages(roomId, limit = 50) {
        const roomMessages = this.messages.get(roomId) || [];
        // è¿”å›æœ€è¿‘çš„Næ¡æ¶ˆæ¯
        return roomMessages.slice(-limit);
    }
}
```

### 5.3 åˆ†é¡µåŠ è½½å®ç°


**ğŸ“„ åˆ†é¡µåŠ è½½ç­–ç•¥**
```javascript
// è·å–å†å²æ¶ˆæ¯çš„API
app.get('/messages/:roomId', (req, res) => {
    const { roomId } = req.params;
    const { page = 1, limit = 20 } = req.query;
    
    const messages = messageStorage.getMessages(roomId, page, limit);
    
    res.json({
        messages: messages,
        hasMore: messages.length === limit, // æ˜¯å¦è¿˜æœ‰æ›´å¤šæ¶ˆæ¯
        currentPage: parseInt(page)
    });
});
```

**ğŸ”„ å®¢æˆ·ç«¯åŠ è½½é€»è¾‘**
```javascript
// ç”¨æˆ·è¿›å…¥èŠå¤©å®¤æ—¶åŠ è½½æœ€è¿‘æ¶ˆæ¯
async function loadRecentMessages(roomId) {
    try {
        const response = await fetch(`/messages/${roomId}?limit=30`);
        const data = await response.json();
        
        // æ˜¾ç¤ºå†å²æ¶ˆæ¯
        data.messages.forEach(message => {
            displayMessage(message);
        });
        
    } catch (error) {
        console.error('åŠ è½½å†å²æ¶ˆæ¯å¤±è´¥:', error);
    }
}
```

---

## 6. ğŸ‘¥ åœ¨çº¿ç”¨æˆ·åˆ—è¡¨ç®¡ç†


### 6.1 åœ¨çº¿ç”¨æˆ·åˆ—è¡¨çš„ä½œç”¨


**ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦ç”¨æˆ·åˆ—è¡¨**
å°±åƒQQç¾¤æˆå‘˜åˆ—è¡¨ä¸€æ ·ï¼Œæ˜¾ç¤ºå½“å‰æœ‰è°åœ¨èŠå¤©å®¤é‡Œï¼Œè®©ç”¨æˆ·çŸ¥é“å’Œè°åœ¨ä¸€èµ·èŠå¤©ã€‚

```
ç”¨æˆ·åˆ—è¡¨åŠŸèƒ½ï¼š
â”œâ”€â”€ æ˜¾ç¤ºåœ¨çº¿äººæ•° ("å½“å‰3äººåœ¨çº¿")
â”œâ”€â”€ æ˜¾ç¤ºç”¨æˆ·æ˜µç§°å’ŒçŠ¶æ€
â”œâ”€â”€ æ”¯æŒ@æŸäººåŠŸèƒ½
â””â”€â”€ æ˜¾ç¤ºç”¨æˆ·åŠ å…¥/ç¦»å¼€é€šçŸ¥
```

### 6.2 ç”¨æˆ·åˆ—è¡¨å®ç°


**ğŸ‘¥ ç”¨æˆ·ç®¡ç†æ ¸å¿ƒä»£ç **
```javascript
class OnlineUsersManager {
    constructor() {
        this.roomUsers = new Map(); // roomId -> Set(users)
    }
    
    // ç”¨æˆ·åŠ å…¥æˆ¿é—´
    addUserToRoom(roomId, user) {
        if (!this.roomUsers.has(roomId)) {
            this.roomUsers.set(roomId, new Set());
        }
        
        const users = this.roomUsers.get(roomId);
        users.add(user);
        
        // å¹¿æ’­ç”¨æˆ·åŠ å…¥é€šçŸ¥
        this.broadcastUserListUpdate(roomId);
        this.broadcastJoinNotification(roomId, user);
    }
    
    // ç”¨æˆ·ç¦»å¼€æˆ¿é—´
    removeUserFromRoom(roomId, userId) {
        const users = this.roomUsers.get(roomId);
        if (users) {
            const user = Array.from(users).find(u => u.id === userId);
            if (user) {
                users.delete(user);
                // å¹¿æ’­ç”¨æˆ·ç¦»å¼€é€šçŸ¥
                this.broadcastUserListUpdate(roomId);
                this.broadcastLeaveNotification(roomId, user);
            }
        }
    }
    
    // è·å–æˆ¿é—´ç”¨æˆ·åˆ—è¡¨
    getRoomUsers(roomId) {
        const users = this.roomUsers.get(roomId);
        return users ? Array.from(users) : [];
    }
    
    // å¹¿æ’­ç”¨æˆ·åˆ—è¡¨æ›´æ–°
    broadcastUserListUpdate(roomId) {
        const users = this.getRoomUsers(roomId);
        const message = {
            type: 'user_list',
            roomId: roomId,
            users: users.map(u => ({
                id: u.id,
                name: u.name,
                status: u.status || 'online'
            })),
            timestamp: Date.now()
        };
        
        broadcastToRoom(roomId, message);
    }
}
```

### 6.3 ç”¨æˆ·è¿›å‡ºé€šçŸ¥


**ğŸ“¢ ç³»ç»Ÿé€šçŸ¥å®ç°**
```javascript
// ç”¨æˆ·åŠ å…¥é€šçŸ¥
broadcastJoinNotification(roomId, user) {
    const notification = {
        type: 'notification',
        subType: 'user_join',
        roomId: roomId,
        content: `${user.name} åŠ å…¥äº†èŠå¤©å®¤`,
        timestamp: Date.now()
    };
    
    broadcastToRoom(roomId, notification);
}

// ç”¨æˆ·ç¦»å¼€é€šçŸ¥  
broadcastLeaveNotification(roomId, user) {
    const notification = {
        type: 'notification',
        subType: 'user_leave', 
        roomId: roomId,
        content: `${user.name} ç¦»å¼€äº†èŠå¤©å®¤`,
        timestamp: Date.now()
    };
    
    broadcastToRoom(roomId, notification);
}
```

---

## 7. ğŸ”„ æ¶ˆæ¯å»é‡æœºåˆ¶å®ç°


### 7.1 ä¸ºä»€ä¹ˆéœ€è¦æ¶ˆæ¯å»é‡


**ğŸ¯ é‡å¤æ¶ˆæ¯çš„é—®é¢˜**
åœ¨ç½‘ç»œä¸ç¨³å®šçš„æƒ…å†µä¸‹ï¼Œå¯èƒ½å‡ºç°é‡å¤æ¶ˆæ¯çš„é—®é¢˜ï¼š

```
é—®é¢˜åœºæ™¯ï¼š
ç”¨æˆ·å‘é€æ¶ˆæ¯ â†’ ç½‘ç»œå¡é¡¿ â†’ ç”¨æˆ·ä»¥ä¸ºæ²¡å‘é€æˆåŠŸ â†’ å†æ¬¡ç‚¹å‡»å‘é€ â†’ å‡ºç°é‡å¤æ¶ˆæ¯

æˆ–è€…ï¼š
ç½‘ç»œé‡è¿æ—¶ â†’ SSEè¿æ¥é‡æ–°å»ºç«‹ â†’ å¯èƒ½æ”¶åˆ°é‡å¤çš„æ¨é€æ¶ˆæ¯
```

### 7.2 æ¶ˆæ¯IDç”Ÿæˆç­–ç•¥


**ğŸ”‘ å”¯ä¸€IDç”Ÿæˆ**
```javascript
class MessageIdGenerator {
    // ç”Ÿæˆæ¶ˆæ¯å”¯ä¸€ID
    static generateMessageId() {
        // æ–¹æ¡ˆ1: æ—¶é—´æˆ³ + éšæœºæ•°
        return `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    }
    
    // æ–¹æ¡ˆ2: åŸºäºå†…å®¹å’Œç”¨æˆ·çš„å“ˆå¸ŒID
    static generateHashId(userId, content, timestamp) {
        const input = `${userId}_${content}_${timestamp}`;
        return this.simpleHash(input);
    }
    
    // ç®€å•å“ˆå¸Œå‡½æ•°
    static simpleHash(str) {
        let hash = 0;
        for (let i = 0; i < str.length; i++) {
            const char = str.charCodeAt(i);
            hash = ((hash << 5) - hash) + char;
        }
        return `msg_${Math.abs(hash).toString(36)}`;
    }
}
```

### 7.3 å®¢æˆ·ç«¯å»é‡å®ç°


**ğŸ”„ å®¢æˆ·ç«¯æ¶ˆæ¯å»é‡**
```javascript
class ChatClient {
    constructor() {
        this.messageIds = new Set(); // å­˜å‚¨å·²æ”¶åˆ°çš„æ¶ˆæ¯ID
        this.messageTimeout = 60000; // 1åˆ†é’Ÿåæ¸…ç†æ—§æ¶ˆæ¯ID
    }
    
    // å¤„ç†æ”¶åˆ°çš„æ¶ˆæ¯
    handleMessage(message) {
        const messageId = message.id;
        
        // æ£€æŸ¥æ˜¯å¦å·²ç»å¤„ç†è¿‡è¿™æ¡æ¶ˆæ¯
        if (this.messageIds.has(messageId)) {
            console.log('é‡å¤æ¶ˆæ¯ï¼Œå¿½ç•¥:', messageId);
            return; // å¿½ç•¥é‡å¤æ¶ˆæ¯
        }
        
        // è®°å½•æ¶ˆæ¯ID
        this.messageIds.add(messageId);
        
        // æ˜¾ç¤ºæ¶ˆæ¯
        this.displayMessage(message);
        
        // å®šæ—¶æ¸…ç†æ—§çš„æ¶ˆæ¯IDï¼ˆé¿å…å†…å­˜æ³„æ¼ï¼‰
        setTimeout(() => {
            this.messageIds.delete(messageId);
        }, this.messageTimeout);
    }
}
```

### 7.4 æœåŠ¡ç«¯å»é‡ç­–ç•¥


**ğŸ›¡ï¸ æœåŠ¡ç«¯é˜²é‡å¤å‘é€**
```javascript
class MessageDeduplication {
    constructor() {
        this.recentMessages = new Map(); // å­˜å‚¨æœ€è¿‘çš„æ¶ˆæ¯
        this.cleanupInterval = 5 * 60 * 1000; // 5åˆ†é’Ÿæ¸…ç†ä¸€æ¬¡
        
        this.startCleanup();
    }
    
    // æ£€æŸ¥æ¶ˆæ¯æ˜¯å¦é‡å¤
    isDuplicateMessage(userId, content, roomId) {
        const key = `${userId}_${roomId}`;
        const recent = this.recentMessages.get(key);
        
        if (recent && recent.content === content) {
            const timeDiff = Date.now() - recent.timestamp;
            // å¦‚æœç›¸åŒå†…å®¹åœ¨30ç§’å†…é‡å¤å‘é€ï¼Œè®¤ä¸ºæ˜¯é‡å¤æ¶ˆæ¯
            return timeDiff < 30000;
        }
        
        return false;
    }
    
    // è®°å½•æ¶ˆæ¯
    recordMessage(userId, content, roomId) {
        const key = `${userId}_${roomId}`;
        this.recentMessages.set(key, {
            content: content,
            timestamp: Date.now()
        });
    }
    
    // å®šæ—¶æ¸…ç†
    startCleanup() {
        setInterval(() => {
            const now = Date.now();
            for (const [key, message] of this.recentMessages) {
                if (now - message.timestamp > this.cleanupInterval) {
                    this.recentMessages.delete(key);
                }
            }
        }, this.cleanupInterval);
    }
}
```

---

## 8. ğŸ’¬ èŠå¤©åŠŸèƒ½å®Œæ•´å®ç°


### 8.1 æœåŠ¡ç«¯å®Œæ•´ä»£ç 


```javascript
const express = require('express');
const path = require('path');
const app = express();

app.use(express.json());
app.use(express.static('public'));

// å…¨å±€ç®¡ç†å™¨
const roomManager = new RoomManager();
const userManager = new OnlineUsersManager();
const messageStorage = new MessageStorage();
const deduplication = new MessageDeduplication();
const connections = new Map(); // userId -> SSEè¿æ¥

// SSEè¿æ¥endpoint
app.get('/chat/:roomId/:userId', (req, res) => {
    const { roomId, userId } = req.params;
    const { userName } = req.query;
    
    // è®¾ç½®SSEå¤´
    res.writeHead(200, {
        'Content-Type': 'text/event-stream',
        'Cache-Control': 'no-cache',
        'Connection': 'keep-alive',
        'Access-Control-Allow-Origin': '*'
    });
    
    // ä¿å­˜è¿æ¥
    connections.set(userId, res);
    
    // ç”¨æˆ·åŠ å…¥æˆ¿é—´
    const user = { id: userId, name: userName };
    roomManager.createRoom(roomId, `æˆ¿é—´${roomId}`);
    userManager.addUserToRoom(roomId, user);
    
    // å‘é€å†å²æ¶ˆæ¯
    const recentMessages = messageStorage.getRecentMessages(roomId, 20);
    recentMessages.forEach(msg => {
        res.write(`data: ${JSON.stringify(msg)}\n\n`);
    });
    
    // è¿æ¥æ–­å¼€å¤„ç†
    req.on('close', () => {
        connections.delete(userId);
        userManager.removeUserFromRoom(roomId, userId);
    });
});

// å‘é€æ¶ˆæ¯endpoint
app.post('/send-message', (req, res) => {
    const { roomId, userId, userName, content } = req.body;
    
    // æ£€æŸ¥é‡å¤æ¶ˆæ¯
    if (deduplication.isDuplicateMessage(userId, content, roomId)) {
        return res.json({ success: false, error: 'è¯·ä¸è¦é‡å¤å‘é€ç›¸åŒæ¶ˆæ¯' });
    }
    
    // æ„é€ æ¶ˆæ¯
    const message = {
        id: MessageIdGenerator.generateMessageId(),
        type: 'chat',
        roomId,
        userId,
        userName,
        content,
        timestamp: Date.now()
    };
    
    // ä¿å­˜æ¶ˆæ¯
    messageStorage.saveMessage(roomId, message);
    deduplication.recordMessage(userId, content, roomId);
    
    // å¹¿æ’­æ¶ˆæ¯
    broadcastToRoom(roomId, message, userId);
    
    res.json({ success: true, messageId: message.id });
});

// å¹¿æ’­å‡½æ•°
function broadcastToRoom(roomId, message, excludeUserId = null) {
    const roomUsers = userManager.getRoomUsers(roomId);
    
    roomUsers.forEach(user => {
        if (user.id !== excludeUserId) {
            const connection = connections.get(user.id);
            if (connection && !connection.destroyed) {
                connection.write(`data: ${JSON.stringify(message)}\n\n`);
            }
        }
    });
}

app.listen(3000, () => {
    console.log('èŠå¤©æœåŠ¡å™¨å¯åŠ¨åœ¨ç«¯å£ 3000');
});
```

### 8.2 å®¢æˆ·ç«¯å®Œæ•´ä»£ç 


```html
<!DOCTYPE html>
<html>
<head>
    <title>SSEèŠå¤©å®¤</title>
    <style>
        .chat-container { max-width: 800px; margin: 20px auto; }
        .messages { height: 400px; border: 1px solid #ccc; overflow-y: auto; padding: 10px; }
        .message { margin: 10px 0; padding: 5px; border-radius: 5px; }
        .message.own { background: #dcf8c6; text-align: right; }
        .message.other { background: #f1f1f1; }
        .notification { color: #666; font-style: italic; text-align: center; }
        .input-area { margin-top: 10px; }
        .user-list { border: 1px solid #ccc; padding: 10px; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="chat-container">
        <h2>èŠå¤©å®¤: <span id="roomId"></span></h2>
        
        <div id="messages" class="messages"></div>
        
        <div class="input-area">
            <input type="text" id="messageInput" placeholder="è¾“å…¥æ¶ˆæ¯..." style="width: 70%;">
            <button onclick="sendMessage()">å‘é€</button>
        </div>
        
        <div class="user-list">
            <h3>åœ¨çº¿ç”¨æˆ· (<span id="userCount">0</span>)</h3>
            <div id="userList"></div>
        </div>
    </div>

    <script>
        class ChatRoom {
            constructor(roomId, userId, userName) {
                this.roomId = roomId;
                this.userId = userId;
                this.userName = userName;
                this.eventSource = null;
                this.messageIds = new Set();
                
                this.init();
            }
            
            init() {
                // å»ºç«‹SSEè¿æ¥
                const url = `/chat/${this.roomId}/${this.userId}?userName=${encodeURIComponent(this.userName)}`;
                this.eventSource = new EventSource(url);
                
                this.eventSource.onmessage = (event) => {
                    const message = JSON.parse(event.data);
                    this.handleMessage(message);
                };
                
                this.eventSource.onerror = () => {
                    console.log('è¿æ¥æ–­å¼€ï¼Œå°è¯•é‡è¿...');
                    // ç®€å•é‡è¿é€»è¾‘
                    setTimeout(() => {
                        this.init();
                    }, 5000);
                };
                
                // å›è½¦å‘é€æ¶ˆæ¯
                document.getElementById('messageInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.sendMessage();
                    }
                });
                
                document.getElementById('roomId').textContent = this.roomId;
            }
            
            handleMessage(message) {
                // æ¶ˆæ¯å»é‡
                if (this.messageIds.has(message.id)) {
                    return;
                }
                this.messageIds.add(message.id);
                
                switch (message.type) {
                    case 'chat':
                        this.displayChatMessage(message);
                        break;
                    case 'notification':
                        this.displayNotification(message);
                        break;
                    case 'user_list':
                        this.updateUserList(message.users);
                        break;
                }
            }
            
            displayChatMessage(message) {
                const messagesDiv = document.getElementById('messages');
                const messageDiv = document.createElement('div');
                
                const isOwn = message.userId === this.userId;
                messageDiv.className = `message ${isOwn ? 'own' : 'other'}`;
                
                const time = new Date(message.timestamp).toLocaleTimeString();
                messageDiv.innerHTML = `
                    <strong>${message.userName}:</strong> 
                    ${this.escapeHtml(message.content)}
                    <small>(${time})</small>
                `;
                
                messagesDiv.appendChild(messageDiv);
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
            }
            
            displayNotification(message) {
                const messagesDiv = document.getElementById('messages');
                const notificationDiv = document.createElement('div');
                notificationDiv.className = 'notification';
                notificationDiv.textContent = message.content;
                messagesDiv.appendChild(notificationDiv);
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
            }
            
            updateUserList(users) {
                document.getElementById('userCount').textContent = users.length;
                const userListDiv = document.getElementById('userList');
                userListDiv.innerHTML = users.map(user => 
                    `<div>ğŸŸ¢ ${user.name}</div>`
                ).join('');
            }
            
            async sendMessage() {
                const input = document.getElementById('messageInput');
                const content = input.value.trim();
                
                if (!content) return;
                
                try {
                    const response = await fetch('/send-message', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            roomId: this.roomId,
                            userId: this.userId,
                            userName: this.userName,
                            content: content
                        })
                    });
                    
                    const result = await response.json();
                    if (result.success) {
                        input.value = '';
                    } else {
                        alert(result.error || 'å‘é€å¤±è´¥');
                    }
                } catch (error) {
                    console.error('å‘é€æ¶ˆæ¯å¤±è´¥:', error);
                }
            }
            
            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }
        
        // åˆå§‹åŒ–èŠå¤©å®¤ï¼ˆå®é™…ä½¿ç”¨æ—¶ä»URLå‚æ•°æˆ–ç”¨æˆ·è¾“å…¥è·å–ï¼‰
        const roomId = 'room_001';
        const userId = 'user_' + Math.random().toString(36).substr(2, 9);
        const userName = prompt('è¯·è¾“å…¥æ‚¨çš„æ˜µç§°:') || 'åŒ¿åç”¨æˆ·';
        
        const chatRoom = new ChatRoom(roomId, userId, userName);
        
        // å…¨å±€å‘é€æ¶ˆæ¯å‡½æ•°
        function sendMessage() {
            chatRoom.sendMessage();
        }
    </script>
</body>
</html>
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ èŠå¤©å®¤æ¶æ„ï¼šæœåŠ¡å™¨ç®¡ç†æˆ¿é—´ï¼Œç”¨æˆ·é€šè¿‡SSEè¿æ¥åŠ å…¥
ğŸ”¸ æˆ¿é—´æ¦‚å¿µï¼šè™šæ‹ŸèŠå¤©ç©ºé—´ï¼Œéš”ç¦»ä¸åŒç¾¤ç»„çš„æ¶ˆæ¯
ğŸ”¸ æ¶ˆæ¯å¹¿æ’­ï¼šä¸€äººå‘è¨€ï¼Œæˆ¿é—´å†…æ‰€æœ‰äººéƒ½æ”¶åˆ°
ğŸ”¸ ç”¨æˆ·ç®¡ç†ï¼šè·Ÿè¸ªè°åœ¨çº¿ï¼Œè°ç¦»çº¿ï¼Œå®æ—¶åŒæ­¥çŠ¶æ€  
ğŸ”¸ å†å²æ¶ˆæ¯ï¼šä¿å­˜èŠå¤©è®°å½•ï¼Œæ–°ç”¨æˆ·å¯ä»¥çœ‹åˆ°ä¸Šä¸‹æ–‡
ğŸ”¸ æ¶ˆæ¯å»é‡ï¼šé˜²æ­¢é‡å¤æ¶ˆæ¯ï¼Œä¿è¯ç”¨æˆ·ä½“éªŒ
```

### 9.2 å…³é”®å®ç°è¦ç‚¹


**ğŸ”¹ æŠ€æœ¯é€‰å‹åˆç†æ€§**
```
ä¸ºä»€ä¹ˆé€‰æ‹©SSEï¼š
âœ… æœåŠ¡å™¨ä¸»åŠ¨æ¨é€ - æ¶ˆæ¯åŠæ—¶æ€§å¥½
âœ… è‡ªåŠ¨é‡è¿æœºåˆ¶ - ç½‘ç»œç¨³å®šæ€§å¼º  
âœ… å®ç°ç®€å• - å¼€å‘ç»´æŠ¤æˆæœ¬ä½
âœ… æµè§ˆå™¨åŸç”Ÿæ”¯æŒ - å…¼å®¹æ€§å¥½

vs WebSocketï¼š
â€¢ SSEæ›´ç®€å•ï¼Œé€‚åˆå•å‘æ¨é€ä¸ºä¸»çš„åœºæ™¯
â€¢ WebSocketé€‚åˆéœ€è¦é¢‘ç¹åŒå‘é€šä¿¡çš„åœºæ™¯
```

**ğŸ”¹ æ•°æ®ç»“æ„è®¾è®¡**
```
æˆ¿é—´ç®¡ç†ï¼šMap<roomId, Room>
ç”¨æˆ·ç®¡ç†ï¼šMap<roomId, Set<User>>  
è¿æ¥ç®¡ç†ï¼šMap<userId, SSEConnection>
æ¶ˆæ¯å­˜å‚¨ï¼šMap<roomId, Message[]>

è®¾è®¡åŸåˆ™ï¼š
â€¢ å¿«é€ŸæŸ¥æ‰¾ - ä½¿ç”¨Mapå’ŒSet
â€¢ å†…å­˜æ§åˆ¶ - é™åˆ¶å†å²æ¶ˆæ¯æ•°é‡
â€¢ æ•°æ®éš”ç¦» - ä¸åŒæˆ¿é—´æ•°æ®åˆ†ç¦»
```

### 9.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ’¼ ä¸šåŠ¡åœºæ™¯åº”ç”¨**
- **åœ¨çº¿å®¢æœ**ï¼šå®¢æœå’Œç”¨æˆ·ä¸€å¯¹ä¸€èŠå¤©
- **æŠ€æœ¯è®ºå›**ï¼šæŒ‰æŠ€æœ¯åˆ†ç±»çš„è®¨è®ºåŒº  
- **æ¸¸æˆèŠå¤©**ï¼šæ¸¸æˆå†…çš„é¢‘é“ç³»ç»Ÿ
- **åœ¨çº¿æ•™è‚²**ï¼šè¯¾å ‚è®¨è®ºå’Œç­”ç–‘
- **ååŒåŠå…¬**ï¼šé¡¹ç›®ç»„å³æ—¶æ²Ÿé€š

**ğŸ”§ æŠ€æœ¯æ‰©å±•æ–¹å‘**
- **ç§èŠåŠŸèƒ½**ï¼šä¸€å¯¹ä¸€æ¶ˆæ¯å‘é€
- **æ–‡ä»¶ä¼ è¾“**ï¼šå›¾ç‰‡ã€æ–‡ä»¶åˆ†äº«
- **æ¶ˆæ¯å›å¤**ï¼šå¼•ç”¨å›å¤æŸæ¡æ¶ˆæ¯
- **ç”¨æˆ·æƒé™**ï¼šç®¡ç†å‘˜ã€ç¦è¨€ç­‰åŠŸèƒ½
- **æ¶ˆæ¯æœç´¢**ï¼šå†å²æ¶ˆæ¯æ£€ç´¢

**æ ¸å¿ƒè®°å¿†**ï¼š
- èŠå¤©å®¤ = æˆ¿é—´ç®¡ç† + ç”¨æˆ·ç®¡ç† + æ¶ˆæ¯å¹¿æ’­
- SSEè¿æ¥è´Ÿè´£æ¨é€ï¼ŒHTTPæ¥å£è´Ÿè´£å‘é€
- æ¶ˆæ¯è¦å»é‡ï¼Œç”¨æˆ·è¦åŒæ­¥ï¼Œå†å²è¦ä¿å­˜
- ç®€å•æ¶æ„è§£å†³å¤æ‚éœ€æ±‚ï¼Œæ¸è¿›å¼åŠŸèƒ½æ‰©å±•