---
title: 1ã€SSEæ€§èƒ½ä¼˜åŒ–ä¸è°ƒä¼˜
---
## ğŸ“š ç›®å½•

1. [æ€§èƒ½ç›‘æ§ä¸è¯„ä¼°](#1-æ€§èƒ½ç›‘æ§ä¸è¯„ä¼°)
2. [è¿æ¥ç®¡ç†ä¼˜åŒ–](#2-è¿æ¥ç®¡ç†ä¼˜åŒ–)
3. [å†…å­˜ä¼˜åŒ–ç­–ç•¥](#3-å†…å­˜ä¼˜åŒ–ç­–ç•¥)
4. [CPUä¸ç½‘ç»œä¼˜åŒ–](#4-CPUä¸ç½‘ç»œä¼˜åŒ–)
5. [å®‰å…¨é‰´æƒç­–ç•¥](#5-å®‰å…¨é‰´æƒç­–ç•¥)
6. [æ¶ˆæ¯é˜Ÿåˆ—ä¸ç¼“å†²](#6-æ¶ˆæ¯é˜Ÿåˆ—ä¸ç¼“å†²)
7. [å‹åŠ›æµ‹è¯•å®è·µ](#7-å‹åŠ›æµ‹è¯•å®è·µ)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ“Š æ€§èƒ½ç›‘æ§ä¸è¯„ä¼°


### 1.1 ä¸ºä»€ä¹ˆè¦ç›‘æ§SSEæ€§èƒ½ï¼Ÿ


**ç®€å•ç†è§£**ï¼šSSEå°±åƒä¸€æ¡æ°´ç®¡ï¼Œè¿æ¥ç€æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ã€‚å¦‚æœåŒæ—¶æœ‰å¾ˆå¤šç”¨æˆ·è¿æ¥ï¼Œå°±åƒå¾ˆå¤šæ°´ç®¡åŒæ—¶å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“è¿™äº›"æ°´ç®¡"çš„å·¥ä½œæƒ…å†µã€‚

```
æƒ³è±¡ä¸€ä¸ªèŠå¤©å®¤ï¼š
ğŸ‘¥ 1000ä¸ªç”¨æˆ·åŒæ—¶åœ¨çº¿
ğŸ“¡ æ¯ä¸ªç”¨æˆ·éƒ½ä¿æŒSSEè¿æ¥
âš¡ æœåŠ¡å™¨éœ€è¦ä¸æ–­æ¨é€æ¶ˆæ¯

é—®é¢˜ï¼š
- æœåŠ¡å™¨èƒ½æ‰¿å—å¤šå°‘è¿æ¥ï¼Ÿ
- å†…å­˜ä¼šä¸ä¼šçˆ†ç‚¸ï¼Ÿ
- CPUæ˜¯å¦åƒå¾—æ¶ˆï¼Ÿ
```

### 1.2 æ ¸å¿ƒç›‘æ§æŒ‡æ ‡


**ğŸ” è¿æ¥æ•°ç›‘æ§**
```javascript
// ç®€å•çš„è¿æ¥è®¡æ•°å™¨
class SSEConnectionMonitor {
    constructor() {
        this.activeConnections = 0;
        this.totalConnections = 0;
    }
    
    // æ–°è¿æ¥å»ºç«‹
    onConnect() {
        this.activeConnections++;
        this.totalConnections++;
        console.log(`å½“å‰åœ¨çº¿: ${this.activeConnections}`);
    }
    
    // è¿æ¥æ–­å¼€
    onDisconnect() {
        this.activeConnections--;
        console.log(`å½“å‰åœ¨çº¿: ${this.activeConnections}`);
    }
}
```

**ğŸ“ˆ å…³é”®æ€§èƒ½æŒ‡æ ‡**

| æŒ‡æ ‡ç±»å‹ | å«ä¹‰è¯´æ˜ | æ­£å¸¸èŒƒå›´ | è­¦å‘Šé˜ˆå€¼ |
|---------|----------|----------|----------|
| **æ´»è·ƒè¿æ¥æ•°** | åŒæ—¶åœ¨çº¿çš„SSEè¿æ¥ | < 5000 | > 8000 |
| **å†…å­˜ä½¿ç”¨** | æœåŠ¡å™¨å†…å­˜å ç”¨ | < 70% | > 85% |
| **CPUä½¿ç”¨ç‡** | å¤„ç†å™¨å ç”¨ç‡ | < 60% | > 80% |
| **æ¶ˆæ¯å‘é€é€Ÿåº¦** | æ¯ç§’æ¨é€æ¶ˆæ¯æ•° | < 1000/s | > 2000/s |

### 1.3 æ€§èƒ½ç“¶é¢ˆè¯†åˆ«


**ğŸš¨ å¸¸è§æ€§èƒ½é—®é¢˜**
```
è¿æ¥æ•°è¿‡å¤š â†’ å†…å­˜ä¸å¤Ÿç”¨
æ¶ˆæ¯å¤ªé¢‘ç¹ â†’ CPUè·Ÿä¸ä¸Š
æ•°æ®åŒ…å¤ªå¤§ â†’ ç½‘ç»œå µå¡
è¿æ¥ä¸é‡Šæ”¾ â†’ å†…å­˜æ³„æ¼
```

**ğŸ’¡ ç®€å•ç›‘æ§å®ç°**
```javascript
// Node.js æ€§èƒ½ç›‘æ§ç¤ºä¾‹
const os = require('os');

class PerformanceMonitor {
    static getSystemInfo() {
        return {
            // CPUä½¿ç”¨æƒ…å†µ
            cpuUsage: process.cpuUsage(),
            // å†…å­˜ä½¿ç”¨æƒ…å†µ
            memoryUsage: process.memoryUsage(),
            // ç³»ç»Ÿè´Ÿè½½
            loadAverage: os.loadavg()
        };
    }
    
    // æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
    static startMonitoring() {
        setInterval(() => {
            const info = this.getSystemInfo();
            const memoryMB = Math.round(info.memoryUsage.used / 1024 / 1024);
            
            console.log(`å†…å­˜ä½¿ç”¨: ${memoryMB}MB`);
            
            // å†…å­˜è¶…è¿‡500MBå‘å‡ºè­¦å‘Š
            if (memoryMB > 500) {
                console.warn('âš ï¸ å†…å­˜ä½¿ç”¨è¿‡é«˜ï¼');
            }
        }, 60000);
    }
}
```

---

## 2. ğŸ”— è¿æ¥ç®¡ç†ä¼˜åŒ–


### 2.1 ä»€ä¹ˆæ˜¯è¿æ¥ç®¡ç†ï¼Ÿ


**é€šä¿—è§£é‡Š**ï¼šå°±åƒé¤å…ç®¡ç†å®¢äººä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦ï¼š
- è®°å½•è°ååœ¨å“ªå¼ æ¡Œå­ï¼ˆè¿æ¥åˆ—è¡¨ï¼‰
- å®¢äººèµ°äº†è¦åŠæ—¶æ”¶æ‹¾æ¡Œå­ï¼ˆæ¸…ç†è¿æ¥ï¼‰
- æ§åˆ¶åŒæ—¶æœåŠ¡çš„å®¢äººæ•°é‡ï¼ˆè¿æ¥é™åˆ¶ï¼‰

### 2.2 è¿æ¥æ± ç®¡ç†ç­–ç•¥


**ğŸŠâ€â™‚ï¸ è¿æ¥æ± æ¦‚å¿µ**
```
ä¼ ç»Ÿæ–¹å¼ï¼šæ¥ä¸€ä¸ªå®¢æˆ·å°±æ–°å¼€ä¸€ä¸ªè¿æ¥
é—®é¢˜ï¼šè¿æ¥æ•°å¯èƒ½æ— é™å¢é•¿

è¿æ¥æ± æ–¹å¼ï¼šé™åˆ¶æœ€å¤§è¿æ¥æ•°
å¥½å¤„ï¼šå¯æ§çš„èµ„æºä½¿ç”¨
```

**ğŸ’» å®ç”¨è¿æ¥ç®¡ç†å™¨**
```javascript
class SSEConnectionManager {
    constructor(maxConnections = 5000) {
        this.connections = new Map(); // å­˜å‚¨æ‰€æœ‰è¿æ¥
        this.maxConnections = maxConnections;
        this.connectionCount = 0;
    }
    
    // æ·»åŠ æ–°è¿æ¥
    addConnection(userId, response) {
        // æ£€æŸ¥è¿æ¥æ•°é™åˆ¶
        if (this.connectionCount >= this.maxConnections) {
            response.status(503).send('æœåŠ¡å™¨è¿æ¥å·²æ»¡');
            return false;
        }
        
        // å¦‚æœç”¨æˆ·å·²æœ‰è¿æ¥ï¼Œå…ˆå…³é—­æ—§çš„
        if (this.connections.has(userId)) {
            this.removeConnection(userId);
        }
        
        this.connections.set(userId, {
            response: response,
            connectTime: Date.now(),
            lastActivity: Date.now()
        });
        
        this.connectionCount++;
        return true;
    }
    
    // ç§»é™¤è¿æ¥
    removeConnection(userId) {
        if (this.connections.has(userId)) {
            const conn = this.connections.get(userId);
            conn.response.end(); // å…³é—­HTTPå“åº”
            this.connections.delete(userId);
            this.connectionCount--;
        }
    }
    
    // å¹¿æ’­æ¶ˆæ¯ç»™æ‰€æœ‰è¿æ¥
    broadcast(message) {
        for (let [userId, conn] of this.connections) {
            try {
                conn.response.write(`data: ${message}\n\n`);
                conn.lastActivity = Date.now();
            } catch (error) {
                // è¿æ¥å·²æ–­å¼€ï¼Œæ¸…ç†å®ƒ
                this.removeConnection(userId);
            }
        }
    }
}
```

### 2.3 é˜²æ­¢è¿æ¥æ³„æ¼


**âŒ è¿æ¥æ³„æ¼æ˜¯ä»€ä¹ˆï¼Ÿ**
```
ç®€å•è¯´ï¼šå°±æ˜¯è¿æ¥æ–­å¼€äº†ï¼Œä½†æœåŠ¡å™¨è¿˜ä»¥ä¸ºè¿æ¥ç€
ç»“æœï¼šå†…å­˜è¶Šç”¨è¶Šå¤šï¼Œæœ€ç»ˆæœåŠ¡å™¨å´©æºƒ
```

**âœ… é˜²æ³„æ¼æªæ–½**
```javascript
class LeakProofSSE {
    constructor() {
        this.connections = new Map();
        this.startCleanup(); // å¯åŠ¨å®šæ—¶æ¸…ç†
    }
    
    addConnection(userId, req, res) {
        // è®¾ç½®è¿æ¥è¶…æ—¶
        req.setTimeout(30000, () => {
            console.log('è¿æ¥è¶…æ—¶ï¼Œè‡ªåŠ¨æ–­å¼€');
            this.removeConnection(userId);
        });
        
        // ç›‘å¬å®¢æˆ·ç«¯æ–­å¼€
        req.on('close', () => {
            console.log('å®¢æˆ·ç«¯æ–­å¼€è¿æ¥');
            this.removeConnection(userId);
        });
        
        // ç›‘å¬é”™è¯¯äº‹ä»¶
        req.on('error', (err) => {
            console.log('è¿æ¥å‡ºé”™:', err);
            this.removeConnection(userId);
        });
        
        this.connections.set(userId, {
            response: res,
            lastPing: Date.now()
        });
    }
    
    // å®šæ—¶æ¸…ç†åƒµå°¸è¿æ¥
    startCleanup() {
        setInterval(() => {
            const now = Date.now();
            for (let [userId, conn] of this.connections) {
                // 5åˆ†é’Ÿæ²¡æœ‰æ´»åŠ¨å°±è®¤ä¸ºæ˜¯åƒµå°¸è¿æ¥
                if (now - conn.lastPing > 5 * 60 * 1000) {
                    console.log(`æ¸…ç†åƒµå°¸è¿æ¥: ${userId}`);
                    this.removeConnection(userId);
                }
            }
        }, 60000); // æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
    }
}
```

### 2.4 å¿ƒè·³ä¿æ´»æœºåˆ¶


**ğŸ’“ ä¸ºä»€ä¹ˆéœ€è¦å¿ƒè·³ï¼Ÿ**
```
é—®é¢˜ï¼šç½‘ç»œä¸ç¨³å®šï¼Œè¿æ¥å¯èƒ½"å‡æ­»"
ç°è±¡ï¼šçœ‹èµ·æ¥è¿æ¥ç€ï¼Œå®é™…ä¸Šå·²ç»æ–­äº†
è§£å†³ï¼šå®šæœŸå‘é€å¿ƒè·³ï¼Œæ£€æŸ¥è¿æ¥æ˜¯å¦æ­£å¸¸
```

**ğŸ“¡ å¿ƒè·³å®ç°**
```javascript
// æœåŠ¡å™¨ç«¯å¿ƒè·³
class HeartbeatSSE {
    constructor() {
        this.connections = new Map();
        this.startHeartbeat();
    }
    
    // æ¯30ç§’å‘é€ä¸€æ¬¡å¿ƒè·³
    startHeartbeat() {
        setInterval(() => {
            this.sendHeartbeat();
        }, 30000);
    }
    
    sendHeartbeat() {
        const heartbeatMsg = JSON.stringify({
            type: 'heartbeat',
            timestamp: Date.now()
        });
        
        for (let [userId, conn] of this.connections) {
            try {
                conn.response.write(`data: ${heartbeatMsg}\n\n`);
            } catch (error) {
                // å¿ƒè·³å‘é€å¤±è´¥ï¼Œè¿æ¥å·²æ–­å¼€
                this.removeConnection(userId);
            }
        }
    }
}
```

---

## 3. ğŸ§  å†…å­˜ä¼˜åŒ–ç­–ç•¥


### 3.1 å†…å­˜æ³„æ¼çš„åŸå› 


**ğŸ” ä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼ï¼Ÿ**
```
ç®€å•æ¯”å–»ï¼šå°±åƒæˆ¿é—´é‡Œçš„åƒåœ¾è¶Šç§¯è¶Šå¤šï¼Œæœ€ç»ˆæˆ¿é—´è£…ä¸ä¸‹äº†
SSEä¸­çš„è¡¨ç°ï¼šè¿æ¥å¯¹è±¡æ²¡æœ‰æ­£ç¡®æ¸…ç†ï¼Œå†…å­˜å ç”¨ä¸æ–­å¢åŠ 
```

**âš ï¸ å¸¸è§æ³„æ¼åœºæ™¯**
```
1. è¿æ¥æ–­å¼€åï¼Œæ²¡æœ‰ä»è¿æ¥æ± ä¸­ç§»é™¤
2. äº‹ä»¶ç›‘å¬å™¨æ²¡æœ‰æ­£ç¡®ç§»é™¤
3. å®šæ—¶å™¨æ²¡æœ‰æ¸…ç†
4. å¤§å¯¹è±¡æ²¡æœ‰åŠæ—¶é‡Šæ”¾å¼•ç”¨
```

### 3.2 å†…å­˜ä¼˜åŒ–å®æˆ˜


**ğŸ—‘ï¸ æ­£ç¡®çš„è¿æ¥æ¸…ç†**
```javascript
class MemoryOptimizedSSE {
    constructor() {
        this.connections = new Map();
        this.timers = new Map(); // è®°å½•æ‰€æœ‰å®šæ—¶å™¨
    }
    
    addConnection(userId, req, res) {
        // å¦‚æœå·²å­˜åœ¨è¿æ¥ï¼Œå…ˆå½»åº•æ¸…ç†æ—§çš„
        if (this.connections.has(userId)) {
            this.cleanupConnection(userId);
        }
        
        const connectionData = {
            response: res,
            request: req,
            startTime: Date.now()
        };
        
        this.connections.set(userId, connectionData);
        
        // è®¾ç½®è¿æ¥æ¸…ç†ç›‘å¬å™¨
        req.on('close', () => this.cleanupConnection(userId));
        req.on('error', () => this.cleanupConnection(userId));
    }
    
    cleanupConnection(userId) {
        if (!this.connections.has(userId)) return;
        
        const conn = this.connections.get(userId);
        
        // 1. å…³é—­å“åº”æµ
        if (conn.response && !conn.response.destroyed) {
            conn.response.end();
        }
        
        // 2. æ¸…ç†å®šæ—¶å™¨
        if (this.timers.has(userId)) {
            clearTimeout(this.timers.get(userId));
            this.timers.delete(userId);
        }
        
        // 3. ä»è¿æ¥æ± ç§»é™¤
        this.connections.delete(userId);
        
        // 4. æ‰‹åŠ¨è§¦å‘åƒåœ¾å›æ”¶æç¤º
        if (global.gc) {
            global.gc();
        }
        
        console.log(`è¿æ¥å·²æ¸…ç†: ${userId}`);
    }
}
```

### 3.3 æ¶ˆæ¯ç¼“å†²ä¼˜åŒ–


**ğŸ“¦ ä¸ºä»€ä¹ˆéœ€è¦æ¶ˆæ¯ç¼“å†²ï¼Ÿ**
```
é—®é¢˜ï¼šå¤§é‡æ¶ˆæ¯åŒæ—¶å‘é€ï¼Œå†…å­˜ç¬é—´å ç”¨å¾ˆé«˜
è§£å†³ï¼šè®¾ç½®æ¶ˆæ¯é˜Ÿåˆ—ï¼Œåˆ†æ‰¹å‘é€
```

**âš¡ ç¼“å†²é˜Ÿåˆ—å®ç°**
```javascript
class BufferedSSE {
    constructor() {
        this.connections = new Map();
        this.messageBuffer = []; // æ¶ˆæ¯ç¼“å†²åŒº
        this.batchSize = 10; // æ¯æ‰¹å‘é€10æ¡æ¶ˆæ¯
        this.flushInterval = 100; // 100mså‘é€ä¸€æ¬¡
        
        this.startBufferFlush();
    }
    
    // æ·»åŠ æ¶ˆæ¯åˆ°ç¼“å†²åŒº
    queueMessage(message) {
        this.messageBuffer.push({
            data: message,
            timestamp: Date.now()
        });
        
        // ç¼“å†²åŒºæ»¡äº†ç«‹å³å‘é€
        if (this.messageBuffer.length >= this.batchSize) {
            this.flushBuffer();
        }
    }
    
    // å®šæ—¶å‘é€ç¼“å†²åŒºæ¶ˆæ¯
    startBufferFlush() {
        setInterval(() => {
            if (this.messageBuffer.length > 0) {
                this.flushBuffer();
            }
        }, this.flushInterval);
    }
    
    // æ¸…ç©ºç¼“å†²åŒºï¼Œå‘é€æ¶ˆæ¯
    flushBuffer() {
        const messages = this.messageBuffer.splice(0, this.batchSize);
        
        for (let msg of messages) {
            this.broadcastMessage(msg.data);
        }
    }
    
    broadcastMessage(data) {
        for (let [userId, conn] of this.connections) {
            try {
                conn.response.write(`data: ${JSON.stringify(data)}\n\n`);
            } catch (error) {
                this.removeConnection(userId);
            }
        }
    }
}
```

---

## 4. âš¡ CPUä¸ç½‘ç»œä¼˜åŒ–


### 4.1 CPUä¼˜åŒ–ç­–ç•¥


**ğŸ–¥ï¸ CPUç“¶é¢ˆåœ¨å“ªï¼Ÿ**
```
ä¸»è¦æ¶ˆè€—ï¼š
1. JSONåºåˆ—åŒ–/ååºåˆ—åŒ–
2. æ¶ˆæ¯æ ¼å¼åŒ–
3. è¿æ¥ç®¡ç†æ“ä½œ
4. æ•°æ®å‹ç¼©å¤„ç†
```

**ğŸš€ CPUä¼˜åŒ–æŠ€å·§**
```javascript
class CPUOptimizedSSE {
    constructor() {
        this.connections = new Map();
        this.messageCache = new Map(); // ç¼“å­˜æ ¼å¼åŒ–åçš„æ¶ˆæ¯
    }
    
    // æ¶ˆæ¯é¢„å¤„ç†å’Œç¼“å­˜
    prepareMessage(type, data) {
        const cacheKey = `${type}_${JSON.stringify(data)}`;
        
        // æ£€æŸ¥ç¼“å­˜
        if (this.messageCache.has(cacheKey)) {
            return this.messageCache.get(cacheKey);
        }
        
        // æ ¼å¼åŒ–æ¶ˆæ¯ï¼ˆåªåšä¸€æ¬¡ï¼‰
        const formattedMessage = `data: ${JSON.stringify({
            type: type,
            data: data,
            timestamp: Date.now()
        })}\n\n`;
        
        // ç¼“å­˜ç»“æœï¼ˆé™åˆ¶ç¼“å­˜å¤§å°ï¼‰
        if (this.messageCache.size < 100) {
            this.messageCache.set(cacheKey, formattedMessage);
        }
        
        return formattedMessage;
    }
    
    // æ‰¹é‡å‘é€ï¼Œå‡å°‘ç³»ç»Ÿè°ƒç”¨
    broadcastOptimized(type, data) {
        const message = this.prepareMessage(type, data);
        const failedConnections = [];
        
        // æ”¶é›†æ‰€æœ‰éœ€è¦å‘é€çš„è¿æ¥
        for (let [userId, conn] of this.connections) {
            try {
                conn.response.write(message);
            } catch (error) {
                failedConnections.push(userId);
            }
        }
        
        // æ‰¹é‡æ¸…ç†å¤±è´¥çš„è¿æ¥
        failedConnections.forEach(userId => {
            this.removeConnection(userId);
        });
    }
}
```

### 4.2 æ•°æ®å‹ç¼©æŠ€æœ¯


**ğŸ—œï¸ ä¸ºä»€ä¹ˆè¦å‹ç¼©ï¼Ÿ**
```
é—®é¢˜ï¼šå¤§æ•°æ®åŒ…ä¼ è¾“æ…¢ï¼Œå ç”¨å¸¦å®½å¤š
è§£å†³ï¼šä½¿ç”¨gzipå‹ç¼©ï¼Œå‡å°‘ä¼ è¾“æ•°æ®é‡
```

**ğŸ“¦ Gzipå‹ç¼©å®ç°**
```javascript
const zlib = require('zlib');

class CompressedSSE {
    constructor() {
        this.connections = new Map();
    }
    
    setupConnection(userId, req, res) {
        // æ£€æŸ¥å®¢æˆ·ç«¯æ˜¯å¦æ”¯æŒgzip
        const acceptEncoding = req.headers['accept-encoding'] || '';
        const supportGzip = acceptEncoding.includes('gzip');
        
        // è®¾ç½®SSEå¤´
        res.writeHead(200, {
            'Content-Type': 'text/event-stream',
            'Cache-Control': 'no-cache',
            'Connection': 'keep-alive',
            'Access-Control-Allow-Origin': '*',
            ...(supportGzip && { 'Content-Encoding': 'gzip' })
        });
        
        let outputStream = res;
        
        // å¦‚æœæ”¯æŒå‹ç¼©ï¼Œåˆ›å»ºå‹ç¼©æµ
        if (supportGzip) {
            const gzipStream = zlib.createGzip();
            gzipStream.pipe(res);
            outputStream = gzipStream;
        }
        
        this.connections.set(userId, {
            response: outputStream,
            isCompressed: supportGzip
        });
    }
    
    sendMessage(userId, data) {
        const conn = this.connections.get(userId);
        if (!conn) return;
        
        const message = `data: ${JSON.stringify(data)}\n\n`;
        conn.response.write(message);
    }
}
```

### 4.3 ç½‘ç»œå¸¦å®½ç®¡ç†


**ğŸ“¡ å¸¦å®½æ§åˆ¶ç­–ç•¥**
```javascript
class BandwidthControlledSSE {
    constructor() {
        this.connections = new Map();
        this.rateLimiter = new Map(); // æ¯ä¸ªç”¨æˆ·çš„é€Ÿç‡é™åˆ¶
        this.maxMessagesPerSecond = 10; // æ¯ç§’æœ€å¤š10æ¡æ¶ˆæ¯
    }
    
    // æ£€æŸ¥æ˜¯å¦å¯ä»¥å‘é€æ¶ˆæ¯
    canSendMessage(userId) {
        const now = Date.now();
        const userLimit = this.rateLimiter.get(userId) || {
            count: 0,
            resetTime: now + 1000
        };
        
        // é‡ç½®è®¡æ•°å™¨
        if (now > userLimit.resetTime) {
            userLimit.count = 0;
            userLimit.resetTime = now + 1000;
        }
        
        // æ£€æŸ¥æ˜¯å¦è¶…è¿‡é™åˆ¶
        if (userLimit.count >= this.maxMessagesPerSecond) {
            return false;
        }
        
        userLimit.count++;
        this.rateLimiter.set(userId, userLimit);
        return true;
    }
    
    sendMessage(userId, data) {
        if (!this.canSendMessage(userId)) {
            console.log(`ç”¨æˆ· ${userId} å‘é€é¢‘ç‡è¿‡å¿«ï¼Œæ¶ˆæ¯è¢«ä¸¢å¼ƒ`);
            return false;
        }
        
        const conn = this.connections.get(userId);
        if (conn) {
            conn.response.write(`data: ${JSON.stringify(data)}\n\n`);
            return true;
        }
        return false;
    }
}
```

---

## 5. ğŸ”’ å®‰å…¨é‰´æƒç­–ç•¥


### 5.1 ä¸ºä»€ä¹ˆéœ€è¦é‰´æƒï¼Ÿ


**ğŸš¨ å®‰å…¨é£é™©**
```
æ— é‰´æƒçš„é—®é¢˜ï¼š
- ä»»ä½•äººéƒ½èƒ½è¿æ¥SSE
- å¯èƒ½æ³„éœ²æ•æ„Ÿä¿¡æ¯
- å®¹æ˜“é­å—DDoSæ”»å‡»
- æ¶æ„ç”¨æˆ·æ¶ˆè€—æœåŠ¡å™¨èµ„æº
```

### 5.2 Tokené‰´æƒå®ç°


**ğŸ”‘ JWT TokenéªŒè¯**
```javascript
const jwt = require('jsonwebtoken');

class SecureSSE {
    constructor(secretKey) {
        this.secretKey = secretKey;
        this.connections = new Map();
        this.authorizedUsers = new Set(); // å·²æˆæƒç”¨æˆ·åˆ—è¡¨
    }
    
    // éªŒè¯Token
    verifyToken(token) {
        try {
            const decoded = jwt.verify(token, this.secretKey);
            return {
                valid: true,
                userId: decoded.userId,
                permissions: decoded.permissions || []
            };
        } catch (error) {
            return { valid: false, error: error.message };
        }
    }
    
    // å»ºç«‹å®‰å…¨è¿æ¥
    establishSecureConnection(req, res) {
        // ä»è¯·æ±‚å¤´æˆ–æŸ¥è¯¢å‚æ•°è·å–token
        const token = req.headers.authorization?.replace('Bearer ', '') ||
                     req.query.token;
        
        if (!token) {
            res.status(401).json({ error: 'ç¼ºå°‘è®¤è¯Token' });
            return;
        }
        
        // éªŒè¯Token
        const authResult = this.verifyToken(token);
        if (!authResult.valid) {
            res.status(403).json({ error: 'Tokenæ— æ•ˆ: ' + authResult.error });
            return;
        }
        
        const userId = authResult.userId;
        
        // æ£€æŸ¥ç”¨æˆ·æƒé™
        if (!this.hasSSEPermission(authResult.permissions)) {
            res.status(403).json({ error: 'æ— SSEè®¿é—®æƒé™' });
            return;
        }
        
        // è®¾ç½®SSEè¿æ¥
        res.writeHead(200, {
            'Content-Type': 'text/event-stream',
            'Cache-Control': 'no-cache',
            'Connection': 'keep-alive',
            'Access-Control-Allow-Origin': '*'
        });
        
        this.connections.set(userId, {
            response: res,
            permissions: authResult.permissions,
            connectTime: Date.now()
        });
        
        this.authorizedUsers.add(userId);
        
        // è¿æ¥æ–­å¼€æ—¶æ¸…ç†æˆæƒ
        req.on('close', () => {
            this.connections.delete(userId);
            this.authorizedUsers.delete(userId);
        });
        
        console.log(`ç”¨æˆ· ${userId} å®‰å…¨è¿æ¥å·²å»ºç«‹`);
    }
    
    // æ£€æŸ¥SSEæƒé™
    hasSSEPermission(permissions) {
        return permissions.includes('sse:read') || 
               permissions.includes('admin');
    }
    
    // å‘é€æ¶ˆæ¯ç»™ç‰¹å®šæƒé™ç”¨æˆ·
    sendToAuthorizedUsers(message, requiredPermission) {
        for (let [userId, conn] of this.connections) {
            if (conn.permissions.includes(requiredPermission)) {
                conn.response.write(`data: ${JSON.stringify(message)}\n\n`);
            }
        }
    }
}
```

### 5.3 è¯·æ±‚å¤´æ ¡éªŒ


**ğŸ›¡ï¸ é¢å¤–å®‰å…¨æ£€æŸ¥**
```javascript
class EnhancedSecureSSE extends SecureSSE {
    
    validateRequest(req) {
        const checks = {
            origin: this.validateOrigin(req),
            userAgent: this.validateUserAgent(req),
            ip: this.validateIP(req),
            headers: this.validateHeaders(req)
        };
        
        return {
            valid: Object.values(checks).every(check => check.valid),
            checks: checks
        };
    }
    
    // éªŒè¯è¯·æ±‚æ¥æº
    validateOrigin(req) {
        const allowedOrigins = [
            'https://myapp.com',
            'https://admin.myapp.com'
        ];
        
        const origin = req.headers.origin;
        if (!origin || !allowedOrigins.includes(origin)) {
            return { valid: false, reason: 'æ¥æºåŸŸåä¸è¢«å…è®¸' };
        }
        
        return { valid: true };
    }
    
    // éªŒè¯User-Agentï¼ˆé˜²æ­¢ç®€å•çš„è„šæœ¬æ”»å‡»ï¼‰
    validateUserAgent(req) {
        const userAgent = req.headers['user-agent'];
        if (!userAgent || userAgent.length < 10) {
            return { valid: false, reason: 'User-Agentå¼‚å¸¸' };
        }
        
        // æ£€æŸ¥æ˜¯å¦ä¸ºå·²çŸ¥çš„æ¶æ„UA
        const blacklistedUA = ['bot', 'crawler', 'script'];
        if (blacklistedUA.some(ua => userAgent.toLowerCase().includes(ua))) {
            return { valid: false, reason: 'User-Agentè¢«æ‹’ç»' };
        }
        
        return { valid: true };
    }
    
    // IPç™½åå•æ£€æŸ¥
    validateIP(req) {
        const clientIP = req.ip || req.connection.remoteAddress;
        const allowedIPs = ['127.0.0.1', '::1']; // ç¤ºä¾‹IPç™½åå•
        
        // ç”Ÿäº§ç¯å¢ƒä¸­è¿™é‡Œåº”è¯¥æœ‰æ›´å®Œå–„çš„IPéªŒè¯é€»è¾‘
        return { valid: true }; // ç®€åŒ–ç¤ºä¾‹
    }
    
    // æ£€æŸ¥å¿…è¦çš„è¯·æ±‚å¤´
    validateHeaders(req) {
        const requiredHeaders = ['user-agent', 'accept'];
        
        for (let header of requiredHeaders) {
            if (!req.headers[header]) {
                return { 
                    valid: false, 
                    reason: `ç¼ºå°‘å¿…è¦çš„è¯·æ±‚å¤´: ${header}` 
                };
            }
        }
        
        return { valid: true };
    }
}
```

---

## 6. ğŸ“¨ æ¶ˆæ¯é˜Ÿåˆ—ä¸ç¼“å†²


### 6.1 ä¸ºä»€ä¹ˆéœ€è¦æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ


**ğŸ¤” è§£å†³çš„é—®é¢˜**
```
åœºæ™¯ï¼šèŠå¤©å®¤æœ‰1000äººï¼Œæœ‰äººå‘äº†ä¸€æ¡æ¶ˆæ¯
é—®é¢˜ï¼šéœ€è¦åŒæ—¶ç»™1000ä¸ªäººå‘é€ï¼ŒæœåŠ¡å™¨å‹åŠ›å¤§
è§£å†³ï¼šæ¶ˆæ¯å…ˆæ”¾åˆ°é˜Ÿåˆ—é‡Œï¼Œç„¶åæ…¢æ…¢å‘é€
```

**ğŸ“‹ æ¶ˆæ¯é˜Ÿåˆ—çš„å¥½å¤„**
```
âœ… å‰Šå³°å¡«è°·ï¼šå¹³æ»‘å¤„ç†çªå‘æµé‡
âœ… å¯é æ€§ï¼šæ¶ˆæ¯ä¸ä¼šä¸¢å¤±
âœ… è§£è€¦ï¼šå‘é€å’Œæ¥æ”¶åˆ†ç¦»
âœ… å¯æ‰©å±•ï¼šå®¹æ˜“æ¨ªå‘æ‰©å±•
```

### 6.2 å†…å­˜æ¶ˆæ¯é˜Ÿåˆ—


**ğŸ—ƒï¸ ç®€å•é˜Ÿåˆ—å®ç°**
```javascript
class MessageQueue {
    constructor() {
        this.queues = new Map(); // æ¯ä¸ªç”¨æˆ·ä¸€ä¸ªé˜Ÿåˆ—
        this.processing = false;
        this.batchSize = 50; // æ¯æ‰¹å¤„ç†50æ¡æ¶ˆæ¯
        
        this.startProcessing();
    }
    
    // æ·»åŠ æ¶ˆæ¯åˆ°é˜Ÿåˆ—
    enqueue(userId, message) {
        if (!this.queues.has(userId)) {
            this.queues.set(userId, []);
        }
        
        const userQueue = this.queues.get(userId);
        userQueue.push({
            data: message,
            timestamp: Date.now(),
            retries: 0
        });
        
        // é˜Ÿåˆ—å¤ªé•¿æ—¶åˆ é™¤æœ€è€çš„æ¶ˆæ¯
        if (userQueue.length > 1000) {
            userQueue.shift();
        }
    }
    
    // å¤„ç†é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯
    startProcessing() {
        setInterval(() => {
            this.processQueues();
        }, 100); // æ¯100mså¤„ç†ä¸€æ¬¡
    }
    
    processQueues() {
        if (this.processing) return;
        this.processing = true;
        
        try {
            for (let [userId, queue] of this.queues) {
                if (queue.length === 0) continue;
                
                // å–å‡ºä¸€æ‰¹æ¶ˆæ¯
                const batch = queue.splice(0, this.batchSize);
                this.processBatch(userId, batch);
            }
        } finally {
            this.processing = false;
        }
    }
    
    processBatch(userId, messages) {
        const connection = this.getConnection(userId);
        if (!connection) {
            // è¿æ¥ä¸å­˜åœ¨ï¼Œæ¶ˆæ¯æ”¾å›é˜Ÿåˆ—æˆ–ä¸¢å¼ƒ
            return;
        }
        
        for (let msg of messages) {
            try {
                connection.response.write(`data: ${JSON.stringify(msg.data)}\n\n`);
            } catch (error) {
                // å‘é€å¤±è´¥ï¼Œé‡è¯•
                if (msg.retries < 3) {
                    msg.retries++;
                    this.enqueue(userId, msg.data);
                }
            }
        }
    }
}
```

### 6.3 Redisæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰


**ğŸš€ Redisé˜Ÿåˆ—å®ç°**
```javascript
const Redis = require('redis');

class RedisMessageQueue {
    constructor(redisConfig) {
        this.client = Redis.createClient(redisConfig);
        this.subscriber = Redis.createClient(redisConfig);
        this.connections = new Map();
        
        this.startSubscriber();
    }
    
    // å‘å¸ƒæ¶ˆæ¯åˆ°Redis
    async publishMessage(channel, message) {
        const messageData = {
            data: message,
            timestamp: Date.now(),
            id: this.generateMessageId()
        };
        
        await this.client.publish(channel, JSON.stringify(messageData));
    }
    
    // è®¢é˜…Redisæ¶ˆæ¯
    startSubscriber() {
        this.subscriber.on('message', (channel, message) => {
            try {
                const messageData = JSON.parse(message);
                this.handleMessage(channel, messageData);
            } catch (error) {
                console.error('è§£ææ¶ˆæ¯å¤±è´¥:', error);
            }
        });
        
        // è®¢é˜…æ‰€æœ‰SSEç›¸å…³é¢‘é“
        this.subscriber.subscribe('sse:broadcast');
        this.subscriber.subscribe('sse:private:*');
    }
    
    // å¤„ç†æ”¶åˆ°çš„æ¶ˆæ¯
    handleMessage(channel, messageData) {
        if (channel === 'sse:broadcast') {
            // å¹¿æ’­ç»™æ‰€æœ‰è¿æ¥
            this.broadcastToAll(messageData);
        } else if (channel.startsWith('sse:private:')) {
            // å‘é€ç»™ç‰¹å®šç”¨æˆ·
            const userId = channel.split(':')[2];
            this.sendToUser(userId, messageData);
        }
    }
    
    broadcastToAll(messageData) {
        for (let [userId, conn] of this.connections) {
            this.sendToConnection(conn, messageData);
        }
    }
    
    sendToUser(userId, messageData) {
        const conn = this.connections.get(userId);
        if (conn) {
            this.sendToConnection(conn, messageData);
        }
    }
    
    sendToConnection(connection, messageData) {
        try {
            connection.response.write(
                `data: ${JSON.stringify(messageData.data)}\n\n`
            );
        } catch (error) {
            console.error('å‘é€æ¶ˆæ¯å¤±è´¥:', error);
            // è¿æ¥å¼‚å¸¸ï¼Œæ¸…ç†è¿æ¥
            this.removeConnection(connection.userId);
        }
    }
    
    generateMessageId() {
        return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
    }
}
```

---

## 7. ğŸ§ª å‹åŠ›æµ‹è¯•å®è·µ


### 7.1 ä¸ºä»€ä¹ˆè¦å‹åŠ›æµ‹è¯•ï¼Ÿ


**ğŸ¯ æµ‹è¯•ç›®çš„**
```
æ‰¾å‡ºç³»ç»Ÿç“¶é¢ˆï¼š
- æœ€å¤šèƒ½æ”¯æŒå¤šå°‘å¹¶å‘è¿æ¥ï¼Ÿ
- æ¶ˆæ¯å‘é€é€Ÿåº¦çš„æé™åœ¨å“ªï¼Ÿ
- ä»€ä¹ˆæ—¶å€™å¼€å§‹å‡ºç°æ€§èƒ½é—®é¢˜ï¼Ÿ
- å†…å­˜å’ŒCPUçš„ä½¿ç”¨æƒ…å†µå¦‚ä½•ï¼Ÿ
```

### 7.2 ç®€å•å‹åŠ›æµ‹è¯•è„šæœ¬


**ğŸ“Š å¹¶å‘è¿æ¥æµ‹è¯•**
```javascript
// æµ‹è¯•è„šæœ¬ï¼štest-sse-performance.js
const EventSource = require('eventsource');

class SSELoadTester {
    constructor(serverUrl, options = {}) {
        this.serverUrl = serverUrl;
        this.maxConnections = options.maxConnections || 1000;
        this.connectionInterval = options.connectionInterval || 10; // ms
        
        this.connections = [];
        this.stats = {
            connected: 0,
            failed: 0,
            messagesReceived: 0,
            startTime: Date.now()
        };
    }
    
    // å¼€å§‹å‹åŠ›æµ‹è¯•
    async startTest() {
        console.log(`å¼€å§‹å‹åŠ›æµ‹è¯•: ${this.maxConnections} ä¸ªå¹¶å‘è¿æ¥`);
        console.log('æœåŠ¡å™¨åœ°å€:', this.serverUrl);
        
        // æ¯éš”ä¸€æ®µæ—¶é—´åˆ›å»ºæ–°è¿æ¥
        for (let i = 0; i < this.maxConnections; i++) {
            setTimeout(() => {
                this.createConnection(i);
            }, i * this.connectionInterval);
        }
        
        // å®šæœŸè¾“å‡ºç»Ÿè®¡ä¿¡æ¯
        this.startStatsReporting();
    }
    
    createConnection(id) {
        try {
            const eventSource = new EventSource(this.serverUrl);
            
            eventSource.onopen = () => {
                this.stats.connected++;
                console.log(`è¿æ¥ ${id} å»ºç«‹æˆåŠŸï¼Œæ€»è¿æ¥æ•°: ${this.stats.connected}`);
            };
            
            eventSource.onmessage = (event) => {
                this.stats.messagesReceived++;
            };
            
            eventSource.onerror = (error) => {
                this.stats.failed++;
                console.error(`è¿æ¥ ${id} å‡ºé”™:`, error);
                eventSource.close();
            };
            
            this.connections.push({
                id: id,
                eventSource: eventSource,
                startTime: Date.now()
            });
            
        } catch (error) {
            this.stats.failed++;
            console.error(`åˆ›å»ºè¿æ¥ ${id} å¤±è´¥:`, error);
        }
    }
    
    startStatsReporting() {
        setInterval(() => {
            const runtime = Date.now() - this.stats.startTime;
            const runtimeSeconds = Math.floor(runtime / 1000);
            
            console.log('=== å‹åŠ›æµ‹è¯•ç»Ÿè®¡ ===');
            console.log(`è¿è¡Œæ—¶é—´: ${runtimeSeconds}ç§’`);
            console.log(`æˆåŠŸè¿æ¥: ${this.stats.connected}`);
            console.log(`å¤±è´¥è¿æ¥: ${this.stats.failed}`);
            console.log(`æ”¶åˆ°æ¶ˆæ¯: ${this.stats.messagesReceived}`);
            console.log(`æ¶ˆæ¯é€Ÿåº¦: ${Math.floor(this.stats.messagesReceived / runtimeSeconds)}/ç§’`);
            console.log('==================');
        }, 10000); // æ¯10ç§’æŠ¥å‘Šä¸€æ¬¡
    }
    
    // åœæ­¢æµ‹è¯•
    stopTest() {
        console.log('åœæ­¢å‹åŠ›æµ‹è¯•...');
        this.connections.forEach(conn => {
            conn.eventSource.close();
        });
    }
}

// è¿è¡Œæµ‹è¯•
const tester = new SSELoadTester('http://localhost:3000/sse', {
    maxConnections: 1000,
    connectionInterval: 10
});

tester.startTest();

// 30ç§’ååœæ­¢æµ‹è¯•
setTimeout(() => {
    tester.stopTest();
    process.exit(0);
}, 30000);
```

### 7.3 æ€§èƒ½ç›‘æ§è„šæœ¬


**ğŸ“ˆ æœåŠ¡å™¨æ€§èƒ½ç›‘æ§**
```javascript
const os = require('os');

class ServerMonitor {
    constructor() {
        this.startTime = Date.now();
        this.lastCPUUsage = process.cpuUsage();
        this.peakMemory = 0;
        this.connectionCount = 0;
    }
    
    startMonitoring(interval = 5000) {
        setInterval(() => {
            this.collectMetrics();
        }, interval);
    }
    
    collectMetrics() {
        const currentTime = Date.now();
        const uptime = Math.floor((currentTime - this.startTime) / 1000);
        
        // CPUä½¿ç”¨ç‡
        const currentCPUUsage = process.cpuUsage(this.lastCPUUsage);
        const cpuPercent = (currentCPUUsage.user + currentCPUUsage.system) / 1000000 * 100;
        this.lastCPUUsage = process.cpuUsage();
        
        // å†…å­˜ä½¿ç”¨æƒ…å†µ
        const memUsage = process.memoryUsage();
        const memoryMB = Math.round(memUsage.used / 1024 / 1024);
        this.peakMemory = Math.max(this.peakMemory, memoryMB);
        
        // ç³»ç»Ÿè´Ÿè½½
        const loadAvg = os.loadavg();
        
        console.log('=== æœåŠ¡å™¨æ€§èƒ½ç›‘æ§ ===');
        console.log(`è¿è¡Œæ—¶é—´: ${uptime}ç§’`);
        console.log(`CPUä½¿ç”¨ç‡: ${cpuPercent.toFixed(2)}%`);
        console.log(`å†…å­˜ä½¿ç”¨: ${memoryMB}MB (å³°å€¼: ${this.peakMemory}MB)`);
        console.log(`ç³»ç»Ÿè´Ÿè½½: ${loadAvg[0].toFixed(2)} ${loadAvg[1].toFixed(2)} ${loadAvg[2].toFixed(2)}`);
        console.log(`æ´»è·ƒè¿æ¥: ${this.connectionCount}`);
        console.log('=====================');
    }
    
    updateConnectionCount(count) {
        this.connectionCount = count;
    }
}

module.exports = ServerMonitor;
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„ä¼˜åŒ–è¦ç‚¹


**ğŸ¯ æ€§èƒ½ä¼˜åŒ–æ ¸å¿ƒ**
```
ğŸ”¸ è¿æ¥ç®¡ç†ï¼šæ§åˆ¶è¿æ¥æ•°ï¼ŒåŠæ—¶æ¸…ç†åƒµå°¸è¿æ¥
ğŸ”¸ å†…å­˜ä¼˜åŒ–ï¼šé˜²æ­¢å†…å­˜æ³„æ¼ï¼Œä½¿ç”¨æ¶ˆæ¯ç¼“å†²
ğŸ”¸ CPUä¼˜åŒ–ï¼šå‡å°‘JSONåºåˆ—åŒ–ï¼Œæ‰¹é‡å¤„ç†æ¶ˆæ¯
ğŸ”¸ ç½‘ç»œä¼˜åŒ–ï¼šä½¿ç”¨gzipå‹ç¼©ï¼Œæ§åˆ¶å‘é€é¢‘ç‡
ğŸ”¸ å®‰å…¨é˜²æŠ¤ï¼šTokené‰´æƒï¼Œè¯·æ±‚å¤´æ ¡éªŒ
ğŸ”¸ æ¶ˆæ¯é˜Ÿåˆ—ï¼šå‰Šå³°å¡«è°·ï¼Œæé«˜ç³»ç»Ÿç¨³å®šæ€§
```

### 8.2 ç”Ÿäº§ç¯å¢ƒæ£€æŸ¥æ¸…å•


**â˜‘ï¸ ä¸Šçº¿å‰å¿…æ£€é¡¹**
- [ ] **è¿æ¥æ•°ç›‘æ§**ï¼šå®æ—¶ç›‘æ§æ´»è·ƒè¿æ¥æ•°é‡
- [ ] **å†…å­˜ç›‘æ§**ï¼šè®¾ç½®å†…å­˜ä½¿ç”¨å‘Šè­¦é˜ˆå€¼
- [ ] **é‰´æƒæœºåˆ¶**ï¼šæ‰€æœ‰SSEè¿æ¥éƒ½éœ€è¦éªŒè¯
- [ ] **é”™è¯¯å¤„ç†**ï¼šè¿æ¥å¼‚å¸¸æ—¶æ­£ç¡®æ¸…ç†èµ„æº
- [ ] **å‹åŠ›æµ‹è¯•**ï¼šç¡®è®¤ç³»ç»Ÿæœ€å¤§æ‰¿è½½èƒ½åŠ›
- [ ] **æ—¥å¿—è®°å½•**ï¼šè®°å½•å…³é”®æ“ä½œå’Œå¼‚å¸¸æƒ…å†µ
- [ ] **ä¼˜é›…å…³é—­**ï¼šæœåŠ¡é‡å¯æ—¶æ­£ç¡®å…³é—­æ‰€æœ‰è¿æ¥

### 8.3 å¸¸è§é—®é¢˜è§£å†³


**â“ é—®é¢˜è¯Šæ–­æŒ‡å—**
```
é—®é¢˜ï¼šè¿æ¥æ•°ä¸æ–­å¢é•¿
æ’æŸ¥ï¼šæ£€æŸ¥è¿æ¥æ¸…ç†é€»è¾‘ï¼Œæ˜¯å¦æœ‰å†…å­˜æ³„æ¼

é—®é¢˜ï¼šæ¶ˆæ¯å‘é€å¾ˆæ…¢
æ’æŸ¥ï¼šæ£€æŸ¥æ˜¯å¦éœ€è¦å¯ç”¨å‹ç¼©ï¼Œä¼˜åŒ–æ¶ˆæ¯æ ¼å¼

é—®é¢˜ï¼šCPUå ç”¨è¿‡é«˜
æ’æŸ¥ï¼šæ˜¯å¦é¢‘ç¹åºåˆ—åŒ–JSONï¼Œè€ƒè™‘æ¶ˆæ¯ç¼“å­˜

é—®é¢˜ï¼šå†…å­˜æŒç»­å¢é•¿
æ’æŸ¥ï¼šæ£€æŸ¥å®šæ—¶å™¨æ¸…ç†ï¼Œæ¶ˆæ¯é˜Ÿåˆ—æ˜¯å¦è¿‡é•¿

é—®é¢˜ï¼šè¿æ¥ç»å¸¸æ–­å¼€
æ’æŸ¥ï¼šç½‘ç»œç¨³å®šæ€§ï¼Œå¿ƒè·³æœºåˆ¶æ˜¯å¦æ­£å¸¸
```

### 8.4 æœ€ä½³å®è·µå»ºè®®


**ğŸ’¡ ç”Ÿäº§ç¯å¢ƒå»ºè®®**
- **ç›‘æ§å…ˆè¡Œ**ï¼šä¸Šçº¿å‰å…ˆæ­å»ºå®Œå–„çš„ç›‘æ§ä½“ç³»
- **é™æµä¿æŠ¤**ï¼šè®¾ç½®åˆç†çš„è¿æ¥æ•°å’Œæ¶ˆæ¯é¢‘ç‡é™åˆ¶
- **ä¼˜é›…é™çº§**ï¼šé«˜è´Ÿè½½æ—¶ä¼˜å…ˆä¿è¯æ ¸å¿ƒåŠŸèƒ½
- **å®šæœŸæ¸…ç†**ï¼šå®šæ—¶æ¸…ç†æ— æ•ˆè¿æ¥å’Œè¿‡æœŸæ¶ˆæ¯
- **æ–‡æ¡£è®°å½•**ï¼šè¯¦ç»†è®°å½•é…ç½®å‚æ•°å’Œè°ƒä¼˜è¿‡ç¨‹

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- SSEæ€§èƒ½ä¼˜åŒ–æ˜¯ç³»ç»Ÿæ€§å·¥ç¨‹ï¼Œéœ€è¦å¤šæ–¹é¢é…åˆ
- ç›‘æ§å’Œæµ‹è¯•æ˜¯ä¼˜åŒ–çš„åŸºç¡€ï¼Œæ²¡æœ‰æ•°æ®å°±æ²¡æœ‰ä¼˜åŒ–æ–¹å‘
- å®‰å…¨å’Œæ€§èƒ½éœ€è¦å¹³è¡¡ï¼Œä¸èƒ½å› ä¸ºæ€§èƒ½ç‰ºç‰²å®‰å…¨æ€§
- ç”Ÿäº§ç¯å¢ƒé—®é¢˜å¾€å¾€æ˜¯å¤šä¸ªå°é—®é¢˜çš„å åŠ ï¼Œéœ€è¦ç³»ç»Ÿæ€§æ’æŸ¥