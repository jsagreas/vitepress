---
title: 15ã€å®æˆ˜å¼€å‘æŒ‡å—
---
## ğŸ“š ç›®å½•

1. [Session-Cookieè®¤è¯åŸºç¡€æ¦‚å¿µ](#1-Session-Cookieè®¤è¯åŸºç¡€æ¦‚å¿µ)
2. [è®¤è¯å·¥ä½œåŸç†è¯¦è§£](#2-è®¤è¯å·¥ä½œåŸç†è¯¦è§£)
3. [Javaå®æˆ˜å¼€å‘ç¤ºä¾‹](#3-Javaå®æˆ˜å¼€å‘ç¤ºä¾‹)
4. [Node.jså®æˆ˜å¼€å‘ç¤ºä¾‹](#4-Node.jså®æˆ˜å¼€å‘ç¤ºä¾‹)
5. [PHPå®æˆ˜å¼€å‘ç¤ºä¾‹](#5-PHPå®æˆ˜å¼€å‘ç¤ºä¾‹)
6. [å‰ç«¯é›†æˆä¸è¯·æ±‚å¤„ç†](#6-å‰ç«¯é›†æˆä¸è¯·æ±‚å¤„ç†)
7. [ä¸»æµæ¡†æ¶Sessionåº”ç”¨](#7-ä¸»æµæ¡†æ¶Sessionåº”ç”¨)
8. [æƒé™æ§åˆ¶å®ç°](#8-æƒé™æ§åˆ¶å®ç°)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸª Session-Cookieè®¤è¯åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯Session-Cookieè®¤è¯


> **é€šä¿—è§£é‡Š**ï¼šå°±åƒå»é“¶è¡ŒåŠäº‹æ—¶çš„å–å·æ’é˜Ÿç³»ç»Ÿã€‚ä½ å…ˆåœ¨å‰å°ç™»è®°èº«ä»½æ‹¿åˆ°ä¸€ä¸ªå·ç ç‰Œï¼ˆCookieï¼‰ï¼Œé“¶è¡Œç³»ç»Ÿè®°å½•ä½ çš„ä¿¡æ¯å’Œå·ç ï¼ˆSessionï¼‰ï¼Œåç»­ä½ å‡­è¿™ä¸ªå·ç ç‰Œå°±èƒ½åŠå„ç§ä¸šåŠ¡ï¼Œä¸ç”¨æ¯æ¬¡éƒ½é‡æ–°è¯æ˜èº«ä»½ã€‚

**ğŸ”¸ æ ¸å¿ƒæ¦‚å¿µæ‹†è§£**

```
è®¤è¯è¿‡ç¨‹ç±»æ¯”ï¼šé¤å…ç”¨é¤ç³»ç»Ÿ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·ç™»å½•    â†’    æœåŠ¡å™¨éªŒè¯    â†’    å‘æ”¾å‡­è¯        â”‚
â”‚     â†“               â†“               â†“             â”‚
â”‚  é¡¾å®¢æŠ¥å§“å   â†’   æœåŠ¡å‘˜ç¡®è®¤é¢„è®¢   â†’   ç»™æ¡Œå·ç‰Œ      â”‚
â”‚                                                   â”‚
â”‚  åç»­è®¿é—®    â†’    å‡­è¯éªŒè¯      â†’    æä¾›æœåŠ¡        â”‚
â”‚     â†“               â†“               â†“             â”‚
â”‚  å‡ºç¤ºæ¡Œå·ç‰Œ   â†’   æœåŠ¡å‘˜æ ¸å¯¹     â†’   ä¸ŠèœæœåŠ¡       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Sessionå’ŒCookieçš„æœ¬è´¨åŒºåˆ«**ï¼š
- **Cookie**ï¼šå­˜åœ¨ç”¨æˆ·æµè§ˆå™¨é‡Œçš„å°çº¸æ¡ï¼Œä¸Šé¢å†™ç€"æˆ‘æ˜¯å¼ ä¸‰ï¼Œç¼–å·123"
- **Session**ï¼šå­˜åœ¨æœåŠ¡å™¨å†…å­˜é‡Œçš„æ¡£æ¡ˆæŸœï¼Œè®°å½•ç€"ç¼–å·123å¯¹åº”å¼ ä¸‰ï¼Œä»–å·²ç»ç™»å½•äº†"

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦Session-Cookieè®¤è¯


**ğŸ¤” HTTPåè®®çš„"å¥å¿˜ç—‡"**
```
HTTPåè®®ç‰¹ç‚¹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç¬¬1æ¬¡è¯·æ±‚     â”‚    â”‚   ç¬¬2æ¬¡è¯·æ±‚     â”‚
â”‚ "æˆ‘è¦ç™»å½•"      â”‚    â”‚ "æˆ‘è¦æŸ¥çœ‹èµ„æ–™"  â”‚
â”‚                â”‚    â”‚                â”‚
â”‚ æœåŠ¡å™¨ï¼šå¥½çš„    â”‚    â”‚ æœåŠ¡å™¨ï¼šä½ æ˜¯è°ï¼Ÿ â”‚ â† å®Œå…¨ä¸è®°å¾—ä¹‹å‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ’¡ è§£å†³æ–¹æ¡ˆï¼šSession-Cookieæœºåˆ¶**
- **é—®é¢˜**ï¼šHTTPä¸è®°ä½ç”¨æˆ·çŠ¶æ€
- **è§£å†³**ï¼šç”¨Cookieå­˜å‚¨æ ‡è¯†ï¼Œç”¨Sessionä¿å­˜çŠ¶æ€
- **ç»“æœ**ï¼šç”¨æˆ·ä¸ç”¨æ¯æ¬¡éƒ½é‡æ–°ç™»å½•

### 1.3 Session-Cookieè®¤è¯çš„æ ¸å¿ƒä¼˜åŠ¿


| **ä¼˜åŠ¿** | **å…·ä½“è¡¨ç°** | **å®é™…æ„ä¹‰** |
|---------|-------------|-------------|
| ğŸ”’ **å®‰å…¨æ€§é«˜** | `æ•æ„Ÿä¿¡æ¯å­˜æœåŠ¡å™¨ç«¯` | `ç”¨æˆ·å¯†ç ç­‰ä¸ä¼šæ³„éœ²åˆ°æµè§ˆå™¨` |
| ğŸ¯ **æ§åˆ¶æ€§å¼º** | `æœåŠ¡å™¨å¯éšæ—¶åºŸé™¤Session` | `å¯ä»¥å¼ºåˆ¶ç”¨æˆ·ä¸‹çº¿` |
| ğŸ“± **å…¼å®¹æ€§å¥½** | `æ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒCookie` | `ä¸éœ€è¦é¢å¤–çš„å‰ç«¯å¤„ç†` |
| ğŸ› ï¸ **å®ç°ç®€å•** | `æ¡†æ¶å†…ç½®æ”¯æŒ` | `å¼€å‘æˆæœ¬ä½ï¼Œç»´æŠ¤ç®€å•` |

---

## 2. ğŸ”„ è®¤è¯å·¥ä½œåŸç†è¯¦è§£


### 2.1 å®Œæ•´è®¤è¯æµç¨‹


```
Session-Cookieè®¤è¯å®Œæ•´æ—¶åºå›¾ï¼š

ç”¨æˆ·æµè§ˆå™¨          WebæœåŠ¡å™¨          Sessionå­˜å‚¨
    |                   |                   |
    |--[1]ç™»å½•è¯·æ±‚------>|                   |
    |  (ç”¨æˆ·å/å¯†ç )      |                   |
    |                   |--[2]éªŒè¯ç”¨æˆ·------>|æ•°æ®åº“
    |                   |<-[3]éªŒè¯ç»“æœ-------|
    |                   |                   |
    |                   |--[4]åˆ›å»ºSession--->|
    |                   |   (SessionID:abc123)|
    |<--[5]è¿”å›Cookie----|                   |
    |  (Set-Cookie:      |                   |
    |   SessionID=abc123)|                   |
    |                   |                   |
    |--[6]åç»­è¯·æ±‚------>|                   |
    |  (Cookie:          |                   |
    |   SessionID=abc123)|--[7]æŸ¥æ‰¾Session-->|
    |                   |<-[8]Sessionä¿¡æ¯----|
    |<--[9]è¿”å›æ•°æ®-------|                   |
```

### 2.2 å…³é”®æ­¥éª¤è¯¦ç»†è§£é‡Š


**æ­¥éª¤1-3ï¼šèº«ä»½éªŒè¯é˜¶æ®µ**
```javascript
// ç”¨æˆ·æäº¤ç™»å½•ä¿¡æ¯
const loginData = {
    username: "zhangsan",
    password: "123456"
}

// æœåŠ¡å™¨éªŒè¯é€»è¾‘ï¼ˆä¼ªä»£ç ï¼‰
if (database.checkUser(username, password)) {
    // éªŒè¯æˆåŠŸï¼Œç»§ç»­åˆ›å»ºsession
} else {
    // éªŒè¯å¤±è´¥ï¼Œè¿”å›é”™è¯¯
}
```

**æ­¥éª¤4-5ï¼šä¼šè¯å»ºç«‹é˜¶æ®µ**
```javascript
// æœåŠ¡å™¨åˆ›å»ºSession
const sessionId = generateUniqueId(); // ç”Ÿæˆå”¯ä¸€IDï¼šabc123
server.sessions[sessionId] = {
    userId: "zhangsan",
    loginTime: new Date(),
    isLoggedIn: true
};

// é€šè¿‡Cookieå‘é€ç»™æµè§ˆå™¨
response.setHeader("Set-Cookie", "SessionID=abc123; HttpOnly; Path=/");
```

**æ­¥éª¤6-9ï¼šåç»­è®¿é—®é˜¶æ®µ**
```javascript
// æµè§ˆå™¨è‡ªåŠ¨åœ¨è¯·æ±‚ä¸­æºå¸¦Cookie
request.headers.cookie = "SessionID=abc123";

// æœåŠ¡å™¨æ ¹æ®SessionIDæŸ¥æ‰¾ç”¨æˆ·ä¿¡æ¯
const sessionId = extractSessionId(request.cookie);
const userInfo = server.sessions[sessionId];
if (userInfo && userInfo.isLoggedIn) {
    // ç”¨æˆ·å·²ç™»å½•ï¼Œå¤„ç†ä¸šåŠ¡è¯·æ±‚
}
```

### 2.3 Sessionå­˜å‚¨ç­–ç•¥


```
Sessionå­˜å‚¨æ–¹æ¡ˆå¯¹æ¯”ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    å†…å­˜å­˜å‚¨     â”‚    æ•°æ®åº“å­˜å‚¨   â”‚    Rediså­˜å‚¨    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é€Ÿåº¦ï¼šâš¡âš¡âš¡     â”‚ é€Ÿåº¦ï¼šâš¡        â”‚ é€Ÿåº¦ï¼šâš¡âš¡      â”‚
â”‚ æŒä¹…åŒ–ï¼šâŒ      â”‚ æŒä¹…åŒ–ï¼šâœ…      â”‚ æŒä¹…åŒ–ï¼šâœ…      â”‚
â”‚ æ‰©å±•æ€§ï¼šâŒ      â”‚ æ‰©å±•æ€§ï¼šâœ…      â”‚ æ‰©å±•æ€§ï¼šâœ…      â”‚
â”‚ é€‚ç”¨ï¼šå•æœºæµ‹è¯•  â”‚ é€‚ç”¨ï¼šå°å‹é¡¹ç›®  â”‚ é€‚ç”¨ï¼šç”Ÿäº§ç¯å¢ƒ  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. â˜• Javaå®æˆ˜å¼€å‘ç¤ºä¾‹


### 3.1 Spring Boot Session-Cookieç™»å½•


**ğŸ”§ æ ¸å¿ƒä¾èµ–é…ç½®**
```xml
<!-- pom.xml -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
</dependency>
<dependency>
    <groupId>org.springframework.session</groupId>
    <artifactId>spring-session-core</artifactId>
</dependency>
```

**ğŸ¯ ç™»å½•æ§åˆ¶å™¨å®ç°**
```java
@RestController
@RequestMapping("/auth")
public class AuthController {
    
    // ç™»å½•æ¥å£
    @PostMapping("/login")
    public ResponseEntity<String> login(
            @RequestBody LoginRequest request,
            HttpServletRequest httpRequest) {
        
        // 1. éªŒè¯ç”¨æˆ·åå¯†ç 
        if ("admin".equals(request.getUsername()) && 
            "123456".equals(request.getPassword())) {
            
            // 2. åˆ›å»ºSessionå¹¶å­˜å‚¨ç”¨æˆ·ä¿¡æ¯
            HttpSession session = httpRequest.getSession();
            session.setAttribute("userId", "admin");
            session.setAttribute("loginTime", new Date());
            
            return ResponseEntity.ok("ç™»å½•æˆåŠŸ");
        }
        
        return ResponseEntity.badRequest().body("ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯");
    }
    
    // è·å–ç”¨æˆ·ä¿¡æ¯
    @GetMapping("/profile")
    public ResponseEntity<Object> getProfile(HttpServletRequest request) {
        HttpSession session = request.getSession(false);
        
        if (session != null && session.getAttribute("userId") != null) {
            Map<String, Object> userInfo = new HashMap<>();
            userInfo.put("userId", session.getAttribute("userId"));
            userInfo.put("loginTime", session.getAttribute("loginTime"));
            
            return ResponseEntity.ok(userInfo);
        }
        
        return ResponseEntity.status(401).body("æœªç™»å½•");
    }
}
```

**ğŸ”’ Sessioné…ç½®**
```java
// application.yml
server:
  servlet:
    session:
      timeout: 30m          # Sessionè¶…æ—¶æ—¶é—´
      cookie:
        name: JSESSIONID    # Cookieåç§°
        http-only: true     # é˜²XSSæ”»å‡»
        secure: false       # HTTPSç¯å¢ƒè®¾ä¸ºtrue
```

### 3.2 ServletåŸç”Ÿå®ç°


```java
@WebServlet("/login")
public class LoginServlet extends HttpServlet {
    
    @Override
    protected void doPost(HttpServletRequest request, 
                         HttpServletResponse response) throws IOException {
        
        String username = request.getParameter("username");
        String password = request.getParameter("password");
        
        // ç®€å•éªŒè¯
        if ("admin".equals(username) && "123456".equals(password)) {
            // åˆ›å»ºSession
            HttpSession session = request.getSession();
            session.setAttribute("user", username);
            session.setMaxInactiveInterval(1800); // 30åˆ†é’Ÿ
            
            response.getWriter().write("ç™»å½•æˆåŠŸ");
        } else {
            response.setStatus(401);
            response.getWriter().write("ç™»å½•å¤±è´¥");
        }
    }
}
```

---

## 4. ğŸŸ¢ Node.jså®æˆ˜å¼€å‘ç¤ºä¾‹


### 4.1 Express Session-Cookieå®ç°


**ğŸ“¦ å®‰è£…ä¾èµ–**
```bash
npm install express express-session
```

**ğŸ”§ åŸºç¡€æœåŠ¡å™¨é…ç½®**
```javascript
const express = require('express');
const session = require('express-session');

const app = express();

// Sessioné…ç½®
app.use(session({
    secret: 'your-secret-key',        // åŠ å¯†å¯†é’¥
    resave: false,                    // ä¸å¼ºåˆ¶ä¿å­˜
    saveUninitialized: false,         // ä¸ä¿å­˜ç©ºsession
    cookie: {
        maxAge: 30 * 60 * 1000,      // 30åˆ†é’Ÿ
        httpOnly: true,               // é˜²XSS
        secure: false                 // å¼€å‘ç¯å¢ƒè®¾false
    }
}));

app.use(express.json());
```

**ğŸ¯ ç™»å½•è·¯ç”±å®ç°**
```javascript
// ç™»å½•æ¥å£
app.post('/login', (req, res) => {
    const { username, password } = req.body;
    
    // éªŒè¯ç”¨æˆ·ï¼ˆç®€åŒ–ç‰ˆï¼‰
    if (username === 'admin' && password === '123456') {
        // åœ¨sessionä¸­ä¿å­˜ç”¨æˆ·ä¿¡æ¯
        req.session.userId = username;
        req.session.loginTime = new Date();
        
        res.json({ 
            success: true, 
            message: 'ç™»å½•æˆåŠŸ' 
        });
    } else {
        res.status(401).json({ 
            success: false, 
            message: 'ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯' 
        });
    }
});

// è·å–ç”¨æˆ·ä¿¡æ¯
app.get('/profile', (req, res) => {
    if (req.session.userId) {
        res.json({
            userId: req.session.userId,
            loginTime: req.session.loginTime
        });
    } else {
        res.status(401).json({ message: 'æœªç™»å½•' });
    }
});

// ç™»å‡º
app.post('/logout', (req, res) => {
    req.session.destroy((err) => {
        if (err) {
            return res.status(500).json({ message: 'ç™»å‡ºå¤±è´¥' });
        }
        res.json({ message: 'ç™»å‡ºæˆåŠŸ' });
    });
});
```

### 4.2 Sessionå­˜å‚¨ä¼˜åŒ–


**ğŸ”„ ä½¿ç”¨Rediså­˜å‚¨Session**
```javascript
const RedisStore = require('connect-redis')(session);
const redis = require('redis');
const client = redis.createClient();

app.use(session({
    store: new RedisStore({ client: client }),
    secret: 'your-secret-key',
    resave: false,
    saveUninitialized: false,
    cookie: {
        maxAge: 30 * 60 * 1000
    }
}));
```

---

## 5. ğŸ˜ PHPå®æˆ˜å¼€å‘ç¤ºä¾‹


### 5.1 åŸç”ŸPHP Sessionå®ç°


**ğŸ¯ ç™»å½•é¡µé¢**
```php
<?php
// login.php
session_start();

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $username = $_POST['username'];
    $password = $_POST['password'];
    
    // ç®€å•éªŒè¯
    if ($username === 'admin' && $password === '123456') {
        // è®¾ç½®Session
        $_SESSION['user_id'] = $username;
        $_SESSION['login_time'] = date('Y-m-d H:i:s');
        
        echo json_encode([
            'success' => true,
            'message' => 'ç™»å½•æˆåŠŸ'
        ]);
    } else {
        http_response_code(401);
        echo json_encode([
            'success' => false,
            'message' => 'ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯'
        ]);
    }
} else {
    // æ˜¾ç¤ºç™»å½•è¡¨å•
    ?>
    <form method="post">
        <input type="text" name="username" placeholder="ç”¨æˆ·å" required>
        <input type="password" name="password" placeholder="å¯†ç " required>
        <button type="submit">ç™»å½•</button>
    </form>
    <?php
}
?>
```

**ğŸ”’ Sessioné…ç½®**
```php
<?php
// config/session.php
ini_set('session.cookie_lifetime', 1800);  // 30åˆ†é’Ÿ
ini_set('session.cookie_httponly', 1);     // é˜²XSS
ini_set('session.use_strict_mode', 1);     // ä¸¥æ ¼æ¨¡å¼

session_start();
?>
```

**ğŸ“„ ç”¨æˆ·ä¿¡æ¯é¡µé¢**
```php
<?php
// profile.php
session_start();

if (isset($_SESSION['user_id'])) {
    echo json_encode([
        'user_id' => $_SESSION['user_id'],
        'login_time' => $_SESSION['login_time']
    ]);
} else {
    http_response_code(401);
    echo json_encode(['message' => 'æœªç™»å½•']);
}
?>
```

### 5.2 Laravelæ¡†æ¶å®ç°


```php
// routes/web.php
Route::post('/login', function (Request $request) {
    $credentials = $request->only('username', 'password');
    
    if ($credentials['username'] === 'admin' && 
        $credentials['password'] === '123456') {
        
        // Laravelè‡ªåŠ¨ç®¡ç†Session
        session([
            'user_id' => 'admin',
            'login_time' => now()
        ]);
        
        return response()->json(['message' => 'ç™»å½•æˆåŠŸ']);
    }
    
    return response()->json(['message' => 'ç™»å½•å¤±è´¥'], 401);
});

Route::get('/profile', function () {
    if (session('user_id')) {
        return response()->json([
            'user_id' => session('user_id'),
            'login_time' => session('login_time')
        ]);
    }
    
    return response()->json(['message' => 'æœªç™»å½•'], 401);
});
```

---

## 6. ğŸŒ å‰ç«¯é›†æˆä¸è¯·æ±‚å¤„ç†


### 6.1 Fetch APIæºå¸¦Cookie


**ğŸ”§ åŸºç¡€Fetché…ç½®**
```javascript
// ç™»å½•è¯·æ±‚
async function login(username, password) {
    try {
        const response = await fetch('/api/login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            credentials: 'include',  // å…³é”®ï¼šæºå¸¦Cookie
            body: JSON.stringify({ username, password })
        });
        
        const result = await response.json();
        
        if (response.ok) {
            console.log('ç™»å½•æˆåŠŸ');
            return result;
        } else {
            throw new Error(result.message);
        }
    } catch (error) {
        console.error('ç™»å½•å¤±è´¥:', error.message);
    }
}

// è·å–ç”¨æˆ·ä¿¡æ¯
async function getUserProfile() {
    const response = await fetch('/api/profile', {
        method: 'GET',
        credentials: 'include'  // è‡ªåŠ¨æºå¸¦Session Cookie
    });
    
    if (response.ok) {
        return await response.json();
    } else {
        throw new Error('æœªç™»å½•');
    }
}
```

### 6.2 Axiosé…ç½®æºå¸¦Cookie


```javascript
// axioså…¨å±€é…ç½®
import axios from 'axios';

// åˆ›å»ºaxioså®ä¾‹
const api = axios.create({
    baseURL: '/api',
    withCredentials: true,  // å…¨å±€å¼€å¯Cookieæºå¸¦
    timeout: 5000
});

// è¯·æ±‚æ‹¦æˆªå™¨
api.interceptors.request.use(config => {
    // è¯·æ±‚ä¼šè‡ªåŠ¨æºå¸¦Cookie
    return config;
});

// å“åº”æ‹¦æˆªå™¨
api.interceptors.response.use(
    response => response,
    error => {
        if (error.response?.status === 401) {
            // æœªç™»å½•ï¼Œè·³è½¬åˆ°ç™»å½•é¡µ
            window.location.href = '/login';
        }
        return Promise.reject(error);
    }
);

// ä½¿ç”¨ç¤ºä¾‹
const userApi = {
    async login(username, password) {
        const response = await api.post('/login', { username, password });
        return response.data;
    },
    
    async getProfile() {
        const response = await api.get('/profile');
        return response.data;
    }
};
```

### 6.3 Vue.jsé›†æˆç¤ºä¾‹


```vue
<template>
  <div>
    <div v-if="!user">
      <form @submit.prevent="handleLogin">
        <input v-model="username" placeholder="ç”¨æˆ·å" required>
        <input v-model="password" type="password" placeholder="å¯†ç " required>
        <button type="submit">ç™»å½•</button>
      </form>
    </div>
    
    <div v-else>
      <h2>æ¬¢è¿, {{ user.userId }}</h2>
      <p>ç™»å½•æ—¶é—´: {{ user.loginTime }}</p>
      <button @click="handleLogout">é€€å‡ºç™»å½•</button>
    </div>
  </div>
</template>

<script>
export default {
  data() {
    return {
      username: '',
      password: '',
      user: null
    }
  },
  
  async mounted() {
    // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥ç™»å½•çŠ¶æ€
    await this.checkLoginStatus();
  },
  
  methods: {
    async handleLogin() {
      try {
        await this.$http.post('/api/login', {
          username: this.username,
          password: this.password
        });
        
        await this.checkLoginStatus();
      } catch (error) {
        alert('ç™»å½•å¤±è´¥');
      }
    },
    
    async checkLoginStatus() {
      try {
        const response = await this.$http.get('/api/profile');
        this.user = response.data;
      } catch (error) {
        this.user = null;
      }
    }
  }
}
</script>
```

---

## 7. ğŸ› ï¸ ä¸»æµæ¡†æ¶Sessionåº”ç”¨


### 7.1 Expressæ¡†æ¶æ·±åº¦é…ç½®


```javascript
const session = require('express-session');
const MongoStore = require('connect-mongo');

// ç”Ÿäº§ç¯å¢ƒSessioné…ç½®
app.use(session({
    secret: process.env.SESSION_SECRET,
    name: 'sessionId',              // è‡ªå®šä¹‰Cookieå
    resave: false,
    saveUninitialized: false,
    
    // MongoDBå­˜å‚¨
    store: MongoStore.create({
        mongoUrl: 'mongodb://localhost:27017/myapp'
    }),
    
    cookie: {
        maxAge: 24 * 60 * 60 * 1000, // 24å°æ—¶
        httpOnly: true,               // é˜²XSS
        secure: process.env.NODE_ENV === 'production', // ç”Ÿäº§ç¯å¢ƒHTTPS
        sameSite: 'strict'            // é˜²CSRF
    }
}));

// Sessionä¸­é—´ä»¶å°è£…
const requireAuth = (req, res, next) => {
    if (req.session && req.session.userId) {
        next();
    } else {
        res.status(401).json({ message: 'è¯·å…ˆç™»å½•' });
    }
};

// ä½¿ç”¨è®¤è¯ä¸­é—´ä»¶
app.get('/protected', requireAuth, (req, res) => {
    res.json({ message: 'è¿™æ˜¯å—ä¿æŠ¤çš„èµ„æº' });
});
```

### 7.2 Spring Booté«˜çº§é…ç½®


```java
@Configuration
public class SessionConfig {
    
    @Bean
    public CookieSerializer cookieSerializer() {
        DefaultCookieSerializer serializer = new DefaultCookieSerializer();
        serializer.setCookieName("JSESSIONID");
        serializer.setHttpOnly(true);
        serializer.setSecure(false); // ç”Ÿäº§ç¯å¢ƒè®¾ä¸ºtrue
        serializer.setMaxAge(Duration.ofHours(2));
        return serializer;
    }
    
    @Bean
    public SessionRepository<MapSession> sessionRepository() {
        return new MapSessionRepository(new ConcurrentHashMap<>());
    }
}

// Sessionç›‘å¬å™¨
@Component
public class SessionListener implements HttpSessionListener {
    
    private final AtomicInteger activeSessions = new AtomicInteger();
    
    @Override
    public void sessionCreated(HttpSessionEvent se) {
        activeSessions.incrementAndGet();
        log.info("Sessionåˆ›å»ºï¼Œå½“å‰æ´»è·ƒä¼šè¯æ•°: {}", activeSessions.get());
    }
    
    @Override
    public void sessionDestroyed(HttpSessionEvent se) {
        activeSessions.decrementAndGet();
        log.info("Sessioné”€æ¯ï¼Œå½“å‰æ´»è·ƒä¼šè¯æ•°: {}", activeSessions.get());
    }
}
```

### 7.3 Django Sessionåº”ç”¨


```python
# settings.py
SESSION_ENGINE = 'django.contrib.sessions.backends.db'  # æ•°æ®åº“å­˜å‚¨
SESSION_COOKIE_AGE = 1800  # 30åˆ†é’Ÿ
SESSION_COOKIE_HTTPONLY = True
SESSION_COOKIE_SECURE = False  # ç”Ÿäº§ç¯å¢ƒè®¾ä¸ºTrue
SESSION_SAVE_EVERY_REQUEST = True

# views.py
from django.contrib.sessions.models import Session
from django.http import JsonResponse
from django.views.decorators.csrf import csrf_exempt
import json

@csrf_exempt
def login(request):
    if request.method == 'POST':
        data = json.loads(request.body)
        username = data.get('username')
        password = data.get('password')
        
        if username == 'admin' and password == '123456':
            # è®¾ç½®Session
            request.session['user_id'] = username
            request.session['login_time'] = str(timezone.now())
            
            return JsonResponse({'success': True, 'message': 'ç™»å½•æˆåŠŸ'})
        
        return JsonResponse({'success': False, 'message': 'ç™»å½•å¤±è´¥'}, status=401)

def profile(request):
    user_id = request.session.get('user_id')
    if user_id:
        return JsonResponse({
            'user_id': user_id,
            'login_time': request.session.get('login_time')
        })
    
    return JsonResponse({'message': 'æœªç™»å½•'}, status=401)
```

---

## 8. ğŸ›¡ï¸ æƒé™æ§åˆ¶å®ç°


### 8.1 åŸºäºè§’è‰²çš„æƒé™ä¸­é—´ä»¶


**Node.jsæƒé™ä¸­é—´ä»¶**
```javascript
// æƒé™æ£€æŸ¥ä¸­é—´ä»¶
const checkPermission = (requiredRole) => {
    return (req, res, next) => {
        // æ£€æŸ¥æ˜¯å¦ç™»å½•
        if (!req.session.userId) {
            return res.status(401).json({ message: 'è¯·å…ˆç™»å½•' });
        }
        
        // æ£€æŸ¥ç”¨æˆ·è§’è‰²ï¼ˆç®€åŒ–ç‰ˆï¼Œå®é™…ä»æ•°æ®åº“è·å–ï¼‰
        const userRole = getUserRole(req.session.userId);
        
        if (hasPermission(userRole, requiredRole)) {
            next();
        } else {
            res.status(403).json({ message: 'æƒé™ä¸è¶³' });
        }
    };
};

// è§’è‰²æƒé™æ˜ å°„
const rolePermissions = {
    'admin': ['read', 'write', 'delete'],
    'user': ['read'],
    'guest': []
};

function hasPermission(userRole, requiredRole) {
    const userPermissions = rolePermissions[userRole] || [];
    return userPermissions.includes(requiredRole);
}

// ä½¿ç”¨æƒé™ä¸­é—´ä»¶
app.get('/admin/users', checkPermission('write'), (req, res) => {
    res.json({ message: 'ç®¡ç†å‘˜é¡µé¢' });
});

app.get('/user/profile', checkPermission('read'), (req, res) => {
    res.json({ message: 'ç”¨æˆ·èµ„æ–™' });
});
```

### 8.2 Spring Bootæƒé™æ‹¦æˆªå™¨


```java
@Component
public class AuthInterceptor implements HandlerInterceptor {
    
    @Override
    public boolean preHandle(HttpServletRequest request, 
                           HttpServletResponse response, 
                           Object handler) throws Exception {
        
        HttpSession session = request.getSession(false);
        
        // æ£€æŸ¥æ˜¯å¦ç™»å½•
        if (session == null || session.getAttribute("userId") == null) {
            response.setStatus(401);
            response.getWriter().write("{\"message\":\"æœªç™»å½•\"}");
            return false;
        }
        
        // æ£€æŸ¥æƒé™æ³¨è§£
        if (handler instanceof HandlerMethod) {
            HandlerMethod method = (HandlerMethod) handler;
            RequireRole roleAnnotation = method.getMethodAnnotation(RequireRole.class);
            
            if (roleAnnotation != null) {
                String requiredRole = roleAnnotation.value();
                String userRole = getUserRole(session.getAttribute("userId").toString());
                
                if (!hasPermission(userRole, requiredRole)) {
                    response.setStatus(403);
                    response.getWriter().write("{\"message\":\"æƒé™ä¸è¶³\"}");
                    return false;
                }
            }
        }
        
        return true;
    }
}

// è‡ªå®šä¹‰æƒé™æ³¨è§£
@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface RequireRole {
    String value();
}

// ä½¿ç”¨ç¤ºä¾‹
@RestController
public class AdminController {
    
    @GetMapping("/admin/users")
    @RequireRole("ADMIN")
    public ResponseEntity<List<User>> getUsers() {
        return ResponseEntity.ok(userService.getAllUsers());
    }
}
```

### 8.3 å®Œæ•´ç™»å½•æƒé™ç³»ç»Ÿ


```javascript
// å®Œæ•´çš„Expressè®¤è¯æˆæƒç³»ç»Ÿ
class AuthSystem {
    constructor() {
        this.users = new Map(); // ç®€åŒ–çš„ç”¨æˆ·å­˜å‚¨
        this.setupDefaultUsers();
    }
    
    setupDefaultUsers() {
        this.users.set('admin', {
            password: '123456',
            role: 'admin',
            permissions: ['read', 'write', 'delete']
        });
        
        this.users.set('user', {
            password: '123456',
            role: 'user',
            permissions: ['read']
        });
    }
    
    // ç™»å½•éªŒè¯
    authenticate(username, password) {
        const user = this.users.get(username);
        return user && user.password === password ? user : null;
    }
    
    // æƒé™æ£€æŸ¥
    authorize(userRole, requiredPermission) {
        const user = Array.from(this.users.values())
                          .find(u => u.role === userRole);
        return user && user.permissions.includes(requiredPermission);
    }
}

const authSystem = new AuthSystem();

// ç™»å½•ä¸­é—´ä»¶
app.post('/login', (req, res) => {
    const { username, password } = req.body;
    const user = authSystem.authenticate(username, password);
    
    if (user) {
        req.session.userId = username;
        req.session.userRole = user.role;
        res.json({ 
            success: true, 
            role: user.role,
            permissions: user.permissions
        });
    } else {
        res.status(401).json({ message: 'ç™»å½•å¤±è´¥' });
    }
});

// æƒé™æ£€æŸ¥ä¸­é—´ä»¶å·¥å‚
const requirePermission = (permission) => {
    return (req, res, next) => {
        if (!req.session.userId) {
            return res.status(401).json({ message: 'è¯·å…ˆç™»å½•' });
        }
        
        if (authSystem.authorize(req.session.userRole, permission)) {
            next();
        } else {
            res.status(403).json({ message: 'æƒé™ä¸è¶³' });
        }
    };
};

// åº”ç”¨æƒé™æ§åˆ¶
app.get('/api/users', requirePermission('read'), (req, res) => {
    res.json({ message: 'ç”¨æˆ·åˆ—è¡¨' });
});

app.delete('/api/users/:id', requirePermission('delete'), (req, res) => {
    res.json({ message: 'åˆ é™¤ç”¨æˆ·æˆåŠŸ' });
});
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Session-Cookieæœ¬è´¨ï¼šæµè§ˆå™¨å­˜Cookieæ ‡è¯†ï¼ŒæœåŠ¡å™¨å­˜SessionçŠ¶æ€
ğŸ”¸ è®¤è¯æµç¨‹ï¼šç™»å½•éªŒè¯ â†’ åˆ›å»ºSession â†’ å‘é€Cookie â†’ åç»­è‡ªåŠ¨æºå¸¦
ğŸ”¸ å®‰å…¨ä¼˜åŠ¿ï¼šæ•æ„Ÿä¿¡æ¯æœåŠ¡å™¨ç«¯å­˜å‚¨ï¼Œæ”¯æŒå¼ºåˆ¶ä¸‹çº¿
ğŸ”¸ å®ç°è¦ç‚¹ï¼šæ­£ç¡®é…ç½®Cookieå±æ€§ï¼Œåˆç†è®¾ç½®è¶…æ—¶æ—¶é—´
ğŸ”¸ æƒé™æ§åˆ¶ï¼šåŸºäºSessionä¿¡æ¯è¿›è¡Œè§’è‰²å’Œæƒé™éªŒè¯
ğŸ”¸ å­˜å‚¨ç­–ç•¥ï¼šå†…å­˜/æ•°æ®åº“/Redisæ ¹æ®åœºæ™¯é€‰æ‹©
```

### 9.2 å…³é”®å®ç°è¦ç‚¹


**ğŸ”¹ Cookieå®‰å…¨é…ç½®**
```javascript
cookie: {
    httpOnly: true,    // é˜²XSSæ”»å‡»
    secure: true,      // HTTPSç¯å¢ƒå¿…é¡»
    sameSite: 'strict' // é˜²CSRFæ”»å‡»
}
```

**ğŸ”¹ Sessionç®¡ç†æœ€ä½³å®è·µ**
```
1. è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´ï¼ˆé€šå¸¸15-30åˆ†é’Ÿï¼‰
2. é‡è¦æ“ä½œåå»¶é•¿Sessionæœ‰æ•ˆæœŸ
3. ç™»å‡ºæ—¶ä¸»åŠ¨é”€æ¯Session
4. å®šæœŸæ¸…ç†è¿‡æœŸSession
```

**ğŸ”¹ å‰ç«¯è¯·æ±‚å…³é”®ç‚¹**
```javascript
// æ‰€æœ‰è¯·æ±‚å¿…é¡»æºå¸¦credentials
fetch('/api/data', {
    credentials: 'include'  // å…³é”®è®¾ç½®
});
```

### 9.3 å®é™…åº”ç”¨åœºæ™¯


**ğŸ’¼ é€‚ç”¨åœºæ™¯**
- âœ… **ä¼ ç»ŸWebåº”ç”¨**ï¼šæœåŠ¡å™¨æ¸²æŸ“é¡µé¢çš„ç½‘ç«™
- âœ… **ä¼ä¸šå†…éƒ¨ç³»ç»Ÿ**ï¼šOAã€CRMç­‰ç®¡ç†ç³»ç»Ÿ  
- âœ… **ç®€å•SPAåº”ç”¨**ï¼šä¸éœ€è¦è·¨åŸŸçš„å•é¡µåº”ç”¨
- âœ… **åŸå‹å¼€å‘**ï¼šå¿«é€Ÿå¼€å‘éªŒè¯åŠŸèƒ½

**âŒ ä¸é€‚ç”¨åœºæ™¯**
- âŒ **ç§»åŠ¨APP**ï¼šåŸç”Ÿåº”ç”¨ä¸æ”¯æŒCookie
- âŒ **å¾®æœåŠ¡æ¶æ„**ï¼šè·¨æœåŠ¡Sessionå…±äº«å¤æ‚
- âŒ **å¤§è§„æ¨¡åˆ†å¸ƒå¼**ï¼šSessionåŒæ­¥æˆæœ¬é«˜
- âŒ **ç¬¬ä¸‰æ–¹API**ï¼šæ— çŠ¶æ€RESTful API

### 9.4 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


**ğŸ”§ è·¨åŸŸé—®é¢˜**
```javascript
// åç«¯CORSé…ç½®
app.use(cors({
    origin: 'http://localhost:3000',
    credentials: true  // å…è®¸æºå¸¦Cookie
}));

// å‰ç«¯è¯·æ±‚é…ç½®
axios.defaults.withCredentials = true;
```

**ğŸ”’ å®‰å…¨åŠ å›º**
```javascript
// Sessionå®‰å…¨é…ç½®æ¸…å•
{
    secret: 'complex-random-string',  // å¤æ‚å¯†é’¥
    name: 'sid',                     // ä¸æš´éœ²æŠ€æœ¯æ ˆ
    httpOnly: true,                  // é˜²XSS
    secure: true,                    // HTTPS only
    maxAge: 1800000,                 // 30åˆ†é’Ÿ
    sameSite: 'strict'               // é˜²CSRF
}
```

**âš¡ æ€§èƒ½ä¼˜åŒ–**
```javascript
// Redis Sessionå­˜å‚¨
const RedisStore = require('connect-redis')(session);
app.use(session({
    store: new RedisStore({
        host: 'localhost',
        port: 6379,
        ttl: 1800  // 30åˆ†é’Ÿè¿‡æœŸ
    })
}));
```

### 9.5 æ ¸å¿ƒè®°å¿†å£è¯€


```
Session-Cookieä¼ ç»Ÿè®¤è¯è®°å¿†æ³•ï¼š

ğŸª Cookieæ˜¯é€šè¡Œè¯ï¼Œæµè§ˆå™¨å¸®ä½ å¸¦
ğŸ“‹ Sessionæ˜¯æ¡£æ¡ˆæŸœï¼ŒæœåŠ¡å™¨æ¥ç®¡ç†  
ğŸ” ç™»å½•åˆ›å»ºä¼šè¯ï¼ŒCookieè‡ªåŠ¨æºå¸¦
â° è¶…æ—¶è‡ªåŠ¨æ¸…ç†ï¼Œå®‰å…¨è®¾ç½®è¦å…¨
ğŸ›¡ï¸ HttpOnlyé˜²è„šæœ¬ï¼ŒSecureè¦HTTPS
ğŸš« SameSiteé˜²æ”»å‡»ï¼Œæƒé™ä¸­é—´ä»¶æ¥æŸ¥
```

**å®æˆ˜å¼€å‘ä¸‰æ­¥èµ°**ï¼š
1. **åç«¯**ï¼šé…ç½®Sessionå­˜å‚¨ï¼Œå®ç°ç™»å½•æ¥å£ï¼Œæ·»åŠ æƒé™ä¸­é—´ä»¶
2. **å‰ç«¯**ï¼šè®¾ç½®credentialsï¼Œå¤„ç†ç™»å½•çŠ¶æ€ï¼Œé”™è¯¯å¤„ç†è·³è½¬  
3. **å®‰å…¨**ï¼šHTTPSéƒ¨ç½²ï¼Œå®‰å…¨é…ç½®ï¼Œå®šæœŸSessionæ¸…ç†