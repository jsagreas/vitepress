---
title: 20ã€RBACå®‰å…¨å®¡è®¡å®è·µ
---
## ğŸ“š ç›®å½•

1. [æƒé™å®‰å…¨å¨èƒåˆ†æ](#1-æƒé™å®‰å…¨å¨èƒåˆ†æ)
2. [æƒé™æå‡æ”»å‡»é˜²æŠ¤](#2-æƒé™æå‡æ”»å‡»é˜²æŠ¤)
3. [æƒé™æ•°æ®åŠ å¯†å­˜å‚¨](#3-æƒé™æ•°æ®åŠ å¯†å­˜å‚¨)
4. [æ“ä½œè¡Œä¸ºå®¡è®¡æ—¥å¿—](#4-æ“ä½œè¡Œä¸ºå®¡è®¡æ—¥å¿—)
5. [æƒé™å˜æ›´è¿½è¸ª](#5-æƒé™å˜æ›´è¿½è¸ª)
6. [åˆè§„æ€§è¦æ±‚å¤„ç†](#6-åˆè§„æ€§è¦æ±‚å¤„ç†)
7. [å®‰å…¨æ¼æ´é¢„é˜²](#7-å®‰å…¨æ¼æ´é¢„é˜²)
8. [åº”æ€¥å“åº”æœºåˆ¶](#8-åº”æ€¥å“åº”æœºåˆ¶)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸš¨ æƒé™å®‰å…¨å¨èƒåˆ†æ


### 1.1 ä»€ä¹ˆæ˜¯æƒé™å®‰å…¨å¨èƒ


**é€šä¿—ç†è§£**ï¼šæƒé™å®‰å…¨å¨èƒå°±åƒæˆ¿å­é‡Œçš„å„ç§å®‰å…¨éšæ‚£ï¼Œæœ‰äººå¯èƒ½é€šè¿‡å„ç§æ–¹å¼è·å¾—æœ¬ä¸åº”è¯¥æœ‰çš„"é’¥åŒ™"ï¼Œæˆ–è€…æ»¥ç”¨ç°æœ‰çš„"é’¥åŒ™"åšåäº‹ã€‚

```
æ—¥å¸¸ç”Ÿæ´»ç±»æ¯”ï¼š
ğŸ  æˆ¿å­é’¥åŒ™ç®¡ç†é—®é¢˜
â”œâ”€ ğŸ—ï¸ é’¥åŒ™ä¸¢å¤±è¢«æ¡åˆ°ï¼ˆè´¦å·æ³„éœ²ï¼‰
â”œâ”€ ğŸšª é—¨é”è¢«æ’¬å¼€ï¼ˆæš´åŠ›ç ´è§£ï¼‰
â”œâ”€ ğŸ”“ å¤‡ç”¨é’¥åŒ™ç®¡ç†æ··ä¹±ï¼ˆæƒé™åˆ†é…ä¸å½“ï¼‰
â””â”€ ğŸ‘¥ å†…éƒ¨äººå‘˜æ»¥ç”¨é’¥åŒ™ï¼ˆå†…éƒ¨å¨èƒï¼‰

ç³»ç»Ÿæƒé™å¨èƒå¯¹åº”ï¼š
ğŸ’» RBACæƒé™ç³»ç»Ÿå¨èƒ
â”œâ”€ ğŸ” è´¦å·å¯†ç æ³„éœ²
â”œâ”€ ğŸ¯ æƒé™æå‡æ”»å‡»
â”œâ”€ ğŸ“Š æƒé™é…ç½®é”™è¯¯
â””â”€ ğŸ‘¤ å†…éƒ¨æƒé™æ»¥ç”¨
```

### 1.2 å¸¸è§æƒé™å¨èƒç±»å‹


**ğŸ¯ å¤–éƒ¨å¨èƒ**
```
æ”»å‡»æ–¹å¼                  å¨èƒæè¿°                    å½±å“ç¨‹åº¦
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”“ æš´åŠ›ç ´è§£æ”»å‡»          çŒœæµ‹è´¦å·å¯†ç                   â­â­â­â˜†â˜†
ğŸ£ é’“é±¼æ”»å‡»             è¯±éª—ç”¨æˆ·è¾“å…¥å‡­è¯              â­â­â­â­â˜†
ğŸ•³ï¸ ç³»ç»Ÿæ¼æ´åˆ©ç”¨         åˆ©ç”¨ä»£ç æ¼æ´è·å–æƒé™          â­â­â­â­â­
ğŸ”„ ä¼šè¯åŠ«æŒ             ç›—å–ç”¨æˆ·ç™»å½•ä¼šè¯              â­â­â­â­â˜†
```

**ğŸ‘¥ å†…éƒ¨å¨èƒ**
```
å¨èƒç±»å‹                  å…·ä½“è¡¨ç°                    é˜²æŠ¤éš¾åº¦
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ˜ˆ æ¶æ„å†…éƒ¨äººå‘˜          æ•…æ„æ»¥ç”¨æƒé™è¿›è¡Œç ´å          â­â­â­â­â­
ğŸ˜´ æ— æ„è¯†é”™è¯¯           è¯¯æ“ä½œå¯¼è‡´å®‰å…¨é—®é¢˜            â­â­â­â˜†â˜†
ğŸ”‘ æƒé™è¿‡åº¦åˆ†é…          ç»™äºˆè¶…è¿‡éœ€è¦çš„æƒé™            â­â­â˜†â˜†â˜†
ğŸ“± è®¾å¤‡ä¸¢å¤±             ç§»åŠ¨è®¾å¤‡ä¸¢å¤±å¯¼è‡´æƒé™æ³„éœ²      â­â­â­â˜†â˜†
```

### 1.3 å¨èƒå½±å“è¯„ä¼°


> ğŸ’¡ **è¯„ä¼°æ–¹æ³•**ï¼šå¨èƒå½±å“ = å‘ç”Ÿæ¦‚ç‡ Ã— æŸå¤±ç¨‹åº¦

**ğŸ“Š å¨èƒå½±å“çŸ©é˜µ**
```
        ä½æŸå¤±    ä¸­ç­‰æŸå¤±    é«˜æŸå¤±    ä¸¥é‡æŸå¤±
é«˜æ¦‚ç‡    ğŸŸ¡ä¸­      ğŸŸ é«˜       ğŸ”´ä¸¥é‡    ğŸ”´ä¸¥é‡
ä¸­æ¦‚ç‡    ğŸŸ¢ä½      ğŸŸ¡ä¸­       ğŸŸ é«˜      ğŸ”´ä¸¥é‡
ä½æ¦‚ç‡    ğŸŸ¢ä½      ğŸŸ¢ä½       ğŸŸ¡ä¸­      ğŸŸ é«˜
```

**å®é™…æ¡ˆä¾‹åˆ†æ**ï¼š
- **ğŸ”´ ä¸¥é‡å¨èƒ**ï¼šç®¡ç†å‘˜è´¦å·è¢«ç›—ï¼Œå¯åˆ é™¤æ‰€æœ‰æ•°æ®
- **ğŸŸ  é«˜é£é™©å¨èƒ**ï¼šè´¢åŠ¡æƒé™æ³„éœ²ï¼Œå¯æŸ¥çœ‹æ•æ„Ÿè´¢åŠ¡ä¿¡æ¯
- **ğŸŸ¡ ä¸­ç­‰å¨èƒ**ï¼šæ™®é€šç”¨æˆ·æƒé™æå‡ï¼Œå¯è®¿é—®å…¶ä»–éƒ¨é—¨æ•°æ®

---

## 2. ğŸ›¡ï¸ æƒé™æå‡æ”»å‡»é˜²æŠ¤


### 2.1 ä»€ä¹ˆæ˜¯æƒé™æå‡æ”»å‡»


**é€šä¿—è§£é‡Š**ï¼šæƒé™æå‡å°±åƒä¸€ä¸ªæ™®é€šå‘˜å·¥æƒ³åŠæ³•è·å¾—è€æ¿çš„æƒé™ã€‚æ¯”å¦‚ï¼š
- **æ°´å¹³æå‡**ï¼šåŒçº§å‘˜å·¥Aè·å¾—åŒçº§å‘˜å·¥Bçš„æƒé™ï¼ˆä¸²å²—ï¼‰
- **å‚ç›´æå‡**ï¼šæ™®é€šå‘˜å·¥è·å¾—ç®¡ç†å‘˜æƒé™ï¼ˆå‡èŒï¼‰

```
æƒé™æå‡æ”»å‡»ç¤ºæ„å›¾ï¼š

æ­£å¸¸æƒé™å±‚çº§ï¼š
    ğŸ‘‘ è¶…çº§ç®¡ç†å‘˜
    â”œâ”€â”€ ğŸ¢ éƒ¨é—¨ç»ç†  
    â”‚   â”œâ”€â”€ ğŸ‘¨â€ğŸ’¼ ç»„é•¿
    â”‚   â””â”€â”€ ğŸ‘©â€ğŸ’¼ æ™®é€šå‘˜å·¥ â† æ”»å‡»è€…èµ·ç‚¹

æ”»å‡»ç›®æ ‡ï¼š
ğŸ‘©â€ğŸ’¼ æ™®é€šå‘˜å·¥ â”€â”€æ”»å‡»â”€â”€> ğŸ‘‘ è¶…çº§ç®¡ç†å‘˜
     â†‘                    â†‘
   å½“å‰æƒé™              ç›®æ ‡æƒé™
```

### 2.2 å¸¸è§æƒé™æå‡æ‰‹æ®µ


**ğŸ” æŠ€æœ¯æ‰‹æ®µ**
```java
// âŒ å±é™©ç¤ºä¾‹ï¼šç›´æ¥ä¿®æ”¹URLå‚æ•°
// ç”¨æˆ·è®¿é—®ï¼š/user/profile?userId=123
// æ¶æ„ä¿®æ”¹ï¼š/user/profile?userId=456 ï¼ˆæŸ¥çœ‹ä»–äººä¿¡æ¯ï¼‰

// âœ… æ­£ç¡®é˜²æŠ¤ï¼šæœåŠ¡ç«¯æƒé™éªŒè¯
@GetMapping("/user/profile")
public UserProfile getProfile(@RequestParam Long userId, HttpSession session) {
    Long currentUserId = (Long) session.getAttribute("userId");
    
    // åªèƒ½æŸ¥çœ‹è‡ªå·±çš„ä¿¡æ¯
    if (!currentUserId.equals(userId)) {
        throw new AccessDeniedException("æ— æƒè®¿é—®ä»–äººä¿¡æ¯");
    }
    
    return userService.getProfile(userId);
}
```

**ğŸ•³ï¸ ä¸šåŠ¡é€»è¾‘æ¼æ´**
```java
// âŒ å±é™©ç¤ºä¾‹ï¼šæ‰¹é‡æ“ä½œæœªæ ¡éªŒæƒé™
@PostMapping("/users/batch-delete")
public void batchDeleteUsers(@RequestBody List<Long> userIds) {
    // ç›´æ¥åˆ é™¤ï¼Œæ²¡æœ‰æƒé™æ£€æŸ¥
    userService.deleteUsers(userIds);
}

// âœ… æ­£ç¡®é˜²æŠ¤ï¼šé€ä¸ªéªŒè¯æƒé™
@PostMapping("/users/batch-delete")
@PreAuthorize("hasRole('ADMIN')")
public void batchDeleteUsers(@RequestBody List<Long> userIds, 
                           Authentication auth) {
    for (Long userId : userIds) {
        // æ£€æŸ¥æ˜¯å¦æœ‰æƒé™åˆ é™¤è¿™ä¸ªç”¨æˆ·
        if (!permissionService.canDeleteUser(auth, userId)) {
            throw new AccessDeniedException("æ— æƒåˆ é™¤ç”¨æˆ·: " + userId);
        }
    }
    userService.deleteUsers(userIds);
}
```

### 2.3 é˜²æŠ¤ç­–ç•¥å®è·µ


**ğŸ”’ æœ€å°æƒé™åŸåˆ™**
```
åŸåˆ™è¯´æ˜ï¼šåªç»™ç”¨æˆ·å®Œæˆå·¥ä½œæ‰€å¿…éœ€çš„æœ€å°æƒé™

å®æ–½æ­¥éª¤ï¼š
1. ğŸ“‹ æ¢³ç†å²—ä½èŒè´£ â†’ ç¡®å®šå¿…è¦æƒé™
2. ğŸ¯ ç²¾ç¡®æƒé™åˆ†é… â†’ é¿å…æƒé™å†—ä½™  
3. â° å®šæœŸæƒé™å®¡æŸ¥ â†’ åŠæ—¶æ”¶å›å¤šä½™æƒé™
4. ğŸ”„ åŠ¨æ€æƒé™è°ƒæ•´ â†’ æ ¹æ®å·¥ä½œå˜åŒ–è°ƒæ•´
```

**ğŸš§ é˜²æŠ¤æŠ€æœ¯æªæ–½**
```java
// æƒé™éªŒè¯æ‹¦æˆªå™¨
@Component
public class PermissionInterceptor implements HandlerInterceptor {
    
    @Override
    public boolean preHandle(HttpServletRequest request, 
                           HttpServletResponse response, 
                           Object handler) {
        
        // 1. è·å–å½“å‰ç”¨æˆ·
        String userId = getCurrentUserId(request);
        
        // 2. è·å–è¯·æ±‚çš„èµ„æºå’Œæ“ä½œ
        String resource = getResourceFromUrl(request.getRequestURI());
        String action = request.getMethod();
        
        // 3. éªŒè¯æƒé™
        if (!permissionService.hasPermission(userId, resource, action)) {
            response.setStatus(403);
            return false;
        }
        
        return true;
    }
}
```

---

## 3. ğŸ” æƒé™æ•°æ®åŠ å¯†å­˜å‚¨


### 3.1 ä¸ºä»€ä¹ˆéœ€è¦åŠ å¯†å­˜å‚¨æƒé™æ•°æ®


**é€šä¿—ç†è§£**ï¼šæƒé™æ•°æ®å°±åƒé“¶è¡Œä¿é™©æŸœé‡Œçš„é‡è¦æ–‡ä»¶ï¼Œå³ä½¿æœ‰äººé—¯è¿›é“¶è¡Œï¼Œä¹Ÿä¸èƒ½ç›´æ¥çœ‹æ‡‚è¿™äº›åŠ å¯†çš„æ–‡ä»¶å†…å®¹ã€‚

```
æœªåŠ å¯†å­˜å‚¨çš„é£é™©ï¼š
ğŸ“ æ•°æ®åº“æ–‡ä»¶
â”œâ”€ usersè¡¨: ç”¨æˆ·åã€å¯†ç æ˜æ–‡ â† âŒ ä¸€è§ˆæ— ä½™
â”œâ”€ rolesè¡¨: è§’è‰²ä¿¡æ¯æ˜æ–‡ â† âŒ æƒé™ç»“æ„æš´éœ²  
â””â”€ permissionsè¡¨: æƒé™è¯¦æƒ…æ˜æ–‡ â† âŒ ç³»ç»Ÿæ¶æ„æ³„éœ²

åŠ å¯†å­˜å‚¨çš„å¥½å¤„ï¼š
ğŸ” åŠ å¯†æ•°æ®åº“
â”œâ”€ usersè¡¨: æ•æ„Ÿä¿¡æ¯å¯†æ–‡ â† âœ… æ— æ³•ç›´æ¥æŸ¥çœ‹
â”œâ”€ rolesè¡¨: å…³é”®å­—æ®µåŠ å¯† â† âœ… ç»“æ„ä¿¡æ¯å—ä¿æŠ¤
â””â”€ permissionsè¡¨: æ ¸å¿ƒæ•°æ®åŠ å¯† â† âœ… ç³»ç»Ÿå®‰å…¨æ€§æå‡
```

### 3.2 æƒé™æ•°æ®åŠ å¯†ç­–ç•¥


**ğŸ”‘ å¯†ç åŠ å¯†å­˜å‚¨**
```java
// ä½¿ç”¨BCryptåŠ å¯†å¯†ç ï¼ˆå•å‘åŠ å¯†ï¼‰
@Service
public class PasswordService {
    
    private final BCryptPasswordEncoder encoder = new BCryptPasswordEncoder();
    
    // åŠ å¯†å¯†ç 
    public String encryptPassword(String plainPassword) {
        return encoder.encode(plainPassword);
    }
    
    // éªŒè¯å¯†ç 
    public boolean verifyPassword(String plainPassword, String encryptedPassword) {
        return encoder.matches(plainPassword, encryptedPassword);
    }
}

// å­˜å‚¨ç¤ºä¾‹
ç”¨æˆ·è¾“å…¥å¯†ç : "mypassword123"
æ•°æ®åº“å­˜å‚¨: "$2a$10$N9qo8uLOickgx2ZMRZoMy.OU8UO.k.GU..."
```

**ğŸ›¡ï¸ æ•æ„Ÿå­—æ®µåŠ å¯†**
```java
// AESåŠ å¯†æ•æ„Ÿä¿¡æ¯ï¼ˆåŒå‘åŠ å¯†ï¼‰
@Service
public class SensitiveDataService {
    
    @Value("${app.encryption.key}")
    private String encryptionKey;
    
    // åŠ å¯†æ•æ„Ÿä¿¡æ¯
    public String encryptSensitiveData(String data) {
        try {
            Cipher cipher = Cipher.getInstance("AES");
            SecretKeySpec key = new SecretKeySpec(encryptionKey.getBytes(), "AES");
            cipher.init(Cipher.ENCRYPT_MODE, key);
            
            byte[] encrypted = cipher.doFinal(data.getBytes());
            return Base64.getEncoder().encodeToString(encrypted);
        } catch (Exception e) {
            throw new RuntimeException("åŠ å¯†å¤±è´¥", e);
        }
    }
}
```

### 3.3 æ•°æ®åº“çº§åˆ«åŠ å¯†


**ğŸ“Š é€æ˜æ•°æ®åŠ å¯†ï¼ˆTDEï¼‰**
```sql
-- MySQL 8.0 é€æ˜åŠ å¯†ç¤ºä¾‹
CREATE TABLE user_permissions (
    id BIGINT PRIMARY KEY,
    user_id BIGINT NOT NULL,
    permission_data JSON,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
) ENCRYPTION='Y';  -- å¯ç”¨è¡¨çº§åŠ å¯†

-- æŸ¥è¯¢æ—¶è‡ªåŠ¨è§£å¯†ï¼Œåº”ç”¨å±‚æ— æ„ŸçŸ¥
SELECT * FROM user_permissions WHERE user_id = 123;
```

**ğŸ—ï¸ å¯†é’¥ç®¡ç†æœ€ä½³å®è·µ**
```
å¯†é’¥ç®¡ç†ç­–ç•¥ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å¯†é’¥ç®¡ç†æœåŠ¡     â”‚
â”‚  (AWS KMS/é˜¿é‡Œäº‘)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
    â”‚ åº”ç”¨æœåŠ¡å™¨ â”‚
    â”‚ (è¿è¡Œæ—¶)   â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
          â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
    â”‚   æ•°æ®åº“   â”‚
    â”‚ (åŠ å¯†å­˜å‚¨) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å®‰å…¨åŸåˆ™ï¼š
ğŸ” å¯†é’¥ä¸æ•°æ®åˆ†ç¦»å­˜å‚¨
ğŸ”„ å®šæœŸè½®æ¢åŠ å¯†å¯†é’¥  
ğŸš« å¯†é’¥ä¸èƒ½ç¡¬ç¼–ç 
ğŸ‘¥ å¯†é’¥è®¿é—®æƒé™æ§åˆ¶
```

---

## 4. ğŸ“‹ æ“ä½œè¡Œä¸ºå®¡è®¡æ—¥å¿—


### 4.1 ä»€ä¹ˆæ˜¯å®¡è®¡æ—¥å¿—


**é€šä¿—è§£é‡Š**ï¼šå®¡è®¡æ—¥å¿—å°±åƒé“¶è¡Œçš„ç›‘æ§å½•åƒï¼Œè®°å½•æ¯ä¸ªäººä»€ä¹ˆæ—¶é—´åšäº†ä»€ä¹ˆäº‹æƒ…ï¼Œæ–¹ä¾¿äº‹åè¿½æŸ¥å’Œåˆ†æã€‚

```
å®¡è®¡æ—¥å¿—è®°å½•å†…å®¹ï¼š
ğŸ“¹ é“¶è¡Œç›‘æ§å½•åƒ              ğŸ—‚ï¸ ç³»ç»Ÿå®¡è®¡æ—¥å¿—
â”œâ”€ ğŸ‘¤ è°: å“ªä¸ªäºº              â”œâ”€ ğŸ‘¤ è°: ç”¨æˆ·ID/ç”¨æˆ·å
â”œâ”€ â° ä½•æ—¶: å…·ä½“æ—¶é—´          â”œâ”€ â° ä½•æ—¶: ç²¾ç¡®æ—¶é—´æˆ³
â”œâ”€ ğŸ  ä½•åœ°: å“ªä¸ªä½ç½®          â”œâ”€ ğŸŒ ä½•åœ°: IPåœ°å€/åœ°ç†ä½ç½®
â”œâ”€ ğŸ¬ ä½•äº‹: åšäº†ä»€ä¹ˆ          â”œâ”€ ğŸ¯ ä½•äº‹: å…·ä½“æ“ä½œåŠ¨ä½œ
â””â”€ ğŸ¯ ç»“æœ: æˆåŠŸæˆ–å¤±è´¥        â””â”€ âœ… ç»“æœ: æ“ä½œæˆåŠŸ/å¤±è´¥
```

### 4.2 å®¡è®¡æ—¥å¿—è®¾è®¡


**ğŸ“ æ—¥å¿—æ•°æ®ç»“æ„**
```java
// å®¡è®¡æ—¥å¿—å®ä½“
@Entity
@Table(name = "audit_logs")
public class AuditLog {
    @Id
    private String logId;           // æ—¥å¿—å”¯ä¸€æ ‡è¯†
    
    // ç”¨æˆ·ä¿¡æ¯
    private Long userId;            // æ“ä½œç”¨æˆ·ID
    private String username;        // ç”¨æˆ·å
    private String userRole;        // ç”¨æˆ·è§’è‰²
    
    // æ“ä½œä¿¡æ¯  
    private String action;          // æ“ä½œåŠ¨ä½œ(CREATE/UPDATE/DELETE/VIEW)
    private String resource;        // æ“ä½œèµ„æº(ç”¨æˆ·/è§’è‰²/æƒé™)
    private String resourceId;      // èµ„æºID
    
    // ç¯å¢ƒä¿¡æ¯
    private String ipAddress;       // IPåœ°å€
    private String userAgent;       // æµè§ˆå™¨ä¿¡æ¯
    private String sessionId;       // ä¼šè¯ID
    
    // ç»“æœä¿¡æ¯
    private String result;          // SUCCESS/FAILED
    private String errorMsg;        // é”™è¯¯ä¿¡æ¯
    private String oldValue;        // ä¿®æ”¹å‰çš„å€¼
    private String newValue;        // ä¿®æ”¹åçš„å€¼
    
    // æ—¶é—´ä¿¡æ¯
    private LocalDateTime timestamp; // æ“ä½œæ—¶é—´
}
```

**ğŸ” æ“ä½œåˆ†ç±»è®°å½•**
```java
// å®¡è®¡æ—¥å¿—æœåŠ¡
@Service
public class AuditLogService {
    
    // æƒé™å˜æ›´æ—¥å¿—
    public void logPermissionChange(String action, Long userId, 
                                  String resource, String oldValue, String newValue) {
        AuditLog log = AuditLog.builder()
            .action(action)
            .userId(userId)
            .resource(resource)
            .oldValue(oldValue)      // å˜æ›´å‰æƒé™
            .newValue(newValue)      // å˜æ›´åæƒé™
            .timestamp(LocalDateTime.now())
            .result("SUCCESS")
            .build();
            
        auditLogRepository.save(log);
    }
    
    // ç™»å½•å®¡è®¡æ—¥å¿—
    public void logUserLogin(Long userId, String ipAddress, boolean success) {
        AuditLog log = AuditLog.builder()
            .action("LOGIN")
            .userId(userId)
            .ipAddress(ipAddress)
            .result(success ? "SUCCESS" : "FAILED")
            .timestamp(LocalDateTime.now())
            .build();
            
        auditLogRepository.save(log);
    }
}
```

### 4.3 å®æ—¶ç›‘æ§å‘Šè­¦


**âš ï¸ å¼‚å¸¸è¡Œä¸ºæ£€æµ‹**
```java
// å¼‚å¸¸è¡Œä¸ºç›‘æ§å™¨  
@Component
public class SecurityMonitor {
    
    // æ£€æµ‹é¢‘ç¹å¤±è´¥ç™»å½•
    public void detectFailedLogins(String ipAddress, int failedCount) {
        if (failedCount >= 5) {
            // è§¦å‘å®‰å…¨å‘Šè­¦
            SecurityAlert alert = new SecurityAlert()
                .setType("BRUTE_FORCE_ATTACK")
                .setMessage("æ£€æµ‹åˆ°æš´åŠ›ç ´è§£æ”»å‡»: " + ipAddress)
                .setSeverity("HIGH");
                
            alertService.sendAlert(alert);
            
            // ä¸´æ—¶å°ç¦IP
            securityService.blockIpTemporary(ipAddress, Duration.ofHours(1));
        }
    }
    
    // æ£€æµ‹å¼‚å¸¸æƒé™æ“ä½œ
    public void detectSuspiciousPermissionChange(Long userId, String operation) {
        // æ£€æŸ¥æ˜¯å¦åœ¨éå·¥ä½œæ—¶é—´è¿›è¡Œæ•æ„Ÿæ“ä½œ
        LocalTime now = LocalTime.now();
        boolean isOffHours = now.isBefore(LocalTime.of(9, 0)) || 
                           now.isAfter(LocalTime.of(18, 0));
        
        if (isOffHours && operation.contains("DELETE")) {
            SecurityAlert alert = new SecurityAlert()
                .setType("OFF_HOURS_SENSITIVE_OPERATION")
                .setMessage("éå·¥ä½œæ—¶é—´æ£€æµ‹åˆ°æ•æ„Ÿæ“ä½œ: ç”¨æˆ·" + userId)
                .setSeverity("MEDIUM");
                
            alertService.sendAlert(alert);
        }
    }
}
```

---

## 5. ğŸ”„ æƒé™å˜æ›´è¿½è¸ª


### 5.1 ä¸ºä»€ä¹ˆéœ€è¦æƒé™å˜æ›´è¿½è¸ª


**ç”Ÿæ´»åœºæ™¯ç±»æ¯”**ï¼š
```
ğŸ¢ å…¬å¸äººå‘˜å˜åŠ¨è®°å½•æœ¬
â”œâ”€ ğŸ“… 2024-01-15: å¼ ä¸‰ä»æ™®é€šå‘˜å·¥æå‡ä¸ºç»„é•¿
â”œâ”€ ğŸ“… 2024-02-20: æå››ç¦»èŒï¼Œå›æ”¶æ‰€æœ‰é—¨ç¦å¡æƒé™  
â”œâ”€ ğŸ“… 2024-03-10: ç‹äº”è°ƒåˆ°è´¢åŠ¡éƒ¨ï¼Œæƒé™é‡æ–°åˆ†é…
â””â”€ ğŸ“… 2024-04-05: å‘ç°æ•°æ®æ³„éœ²ï¼Œè¿½æŸ¥æƒé™å˜æ›´å†å²

ğŸ’» RBACæƒé™å˜æ›´è¿½è¸ª
â”œâ”€ ğŸ” è°æ‰¹å‡†äº†æƒé™å˜æ›´
â”œâ”€ â° æƒé™ä½•æ—¶è¢«ä¿®æ”¹
â”œâ”€ ğŸ“ å˜æ›´çš„å…·ä½“å†…å®¹
â””â”€ ğŸ¯ å˜æ›´çš„ä¸šåŠ¡åŸå› 
```

### 5.2 æƒé™å˜æ›´è¿½è¸ªå®ç°


**ğŸ“Š æƒé™å˜æ›´å†å²è¡¨**
```java
@Entity
@Table(name = "permission_change_history")
public class PermissionChangeHistory {
    @Id
    private String changeId;
    
    // å˜æ›´å¯¹è±¡ä¿¡æ¯
    private Long targetUserId;      // è¢«ä¿®æ”¹æƒé™çš„ç”¨æˆ·
    private Long targetRoleId;      // è¢«ä¿®æ”¹çš„è§’è‰²
    
    // å˜æ›´æ“ä½œä¿¡æ¯
    private String changeType;      // GRANT/REVOKE/MODIFY
    private String permissionBefore; // å˜æ›´å‰æƒé™JSON
    private String permissionAfter;  // å˜æ›´åæƒé™JSON
    
    // å˜æ›´å‘èµ·ä¿¡æ¯
    private Long operatorId;        // æ“ä½œäººå‘˜ID
    private String operatorName;    // æ“ä½œäººå‘˜å§“å
    private String changeReason;    // å˜æ›´åŸå› 
    
    // å®¡æ‰¹ä¿¡æ¯
    private Long approverId;        // å®¡æ‰¹äººID
    private String approverName;    // å®¡æ‰¹äººå§“å
    private LocalDateTime approvedAt; // å®¡æ‰¹æ—¶é—´
    
    // æ—¶é—´ä¿¡æ¯
    private LocalDateTime changedAt; // å˜æ›´ç”Ÿæ•ˆæ—¶é—´
    private LocalDateTime createdAt; // è®°å½•åˆ›å»ºæ—¶é—´
}
```

**ğŸ”„ æƒé™å˜æ›´æœåŠ¡**
```java
@Service
@Transactional
public class PermissionChangeService {
    
    // ç”³è¯·æƒé™å˜æ›´
    public String requestPermissionChange(PermissionChangeRequest request) {
        // 1. åˆ›å»ºå˜æ›´ç”³è¯·è®°å½•
        PermissionChangeHistory history = new PermissionChangeHistory();
        history.setTargetUserId(request.getUserId());
        history.setChangeType(request.getChangeType());
        history.setPermissionBefore(getCurrentPermissions(request.getUserId()));
        history.setPermissionAfter(request.getNewPermissions());
        history.setOperatorId(request.getOperatorId());
        history.setChangeReason(request.getReason());
        history.setStatus("PENDING_APPROVAL"); // å¾…å®¡æ‰¹çŠ¶æ€
        
        String changeId = historyRepository.save(history).getChangeId();
        
        // 2. å‘é€å®¡æ‰¹é€šçŸ¥
        approvalService.sendApprovalRequest(changeId, request);
        
        return changeId;
    }
    
    // å®¡æ‰¹æƒé™å˜æ›´
    public void approvePermissionChange(String changeId, Long approverId) {
        PermissionChangeHistory history = historyRepository.findById(changeId)
            .orElseThrow(() -> new NotFoundException("å˜æ›´è®°å½•ä¸å­˜åœ¨"));
            
        // 1. æ›´æ–°å®¡æ‰¹ä¿¡æ¯
        history.setApproverId(approverId);
        history.setApprovedAt(LocalDateTime.now());
        history.setStatus("APPROVED");
        
        // 2. æ‰§è¡Œæƒé™å˜æ›´
        executePermissionChange(history);
        
        // 3. è®°å½•å®¡è®¡æ—¥å¿—
        auditLogService.logPermissionChange(
            "PERMISSION_APPROVED",
            history.getTargetUserId(),
            history.getPermissionBefore(),
            history.getPermissionAfter()
        );
    }
}
```

### 5.3 æƒé™å˜æ›´åˆ†æ


**ğŸ“ˆ å˜æ›´è¶‹åŠ¿åˆ†æ**
```java
// æƒé™å˜æ›´åˆ†ææœåŠ¡
@Service
public class PermissionAnalysisService {
    
    // åˆ†ææƒé™å˜æ›´è¶‹åŠ¿
    public PermissionTrendReport analyzeTrend(LocalDate startDate, LocalDate endDate) {
        List<PermissionChangeHistory> changes = historyRepository
            .findByChangedAtBetween(startDate.atStartOfDay(), endDate.atTime(23, 59, 59));
        
        Map<String, Long> changeTypeCounts = changes.stream()
            .collect(Collectors.groupingBy(
                PermissionChangeHistory::getChangeType,
                Collectors.counting()
            ));
        
        return PermissionTrendReport.builder()
            .period(startDate + " è‡³ " + endDate)
            .totalChanges(changes.size())
            .grantCount(changeTypeCounts.getOrDefault("GRANT", 0L))
            .revokeCount(changeTypeCounts.getOrDefault("REVOKE", 0L))
            .modifyCount(changeTypeCounts.getOrDefault("MODIFY", 0L))
            .topOperators(findTopOperators(changes))
            .build();
    }
    
    // æ£€æµ‹å¼‚å¸¸æƒé™å˜æ›´
    public List<SecurityAlert> detectAnomalousChanges() {
        List<SecurityAlert> alerts = new ArrayList<>();
        
        // æ£€æµ‹çŸ­æ—¶é—´å†…å¤§é‡æƒé™å˜æ›´
        LocalDateTime oneHourAgo = LocalDateTime.now().minusHours(1);
        List<PermissionChangeHistory> recentChanges = historyRepository
            .findByChangedAtAfter(oneHourAgo);
        
        if (recentChanges.size() > 20) {
            alerts.add(new SecurityAlert()
                .setType("BULK_PERMISSION_CHANGES")
                .setMessage("æ£€æµ‹åˆ°1å°æ—¶å†…" + recentChanges.size() + "æ¬¡æƒé™å˜æ›´")
                .setSeverity("HIGH"));
        }
        
        return alerts;
    }
}
```

---

## 6. ğŸ“‹ åˆè§„æ€§è¦æ±‚å¤„ç†


### 6.1 ä»€ä¹ˆæ˜¯åˆè§„æ€§è¦æ±‚


**é€šä¿—è§£é‡Š**ï¼šåˆè§„æ€§å°±åƒå¼€è½¦è¦éµå®ˆäº¤é€šæ³•è§„ä¸€æ ·ï¼Œä¼ä¸šçš„æƒé™ç®¡ç†ä¹Ÿè¦éµå®ˆå„ç§æ³•å¾‹æ³•è§„å’Œè¡Œä¸šæ ‡å‡†ã€‚

```
å¸¸è§åˆè§„æ€§è¦æ±‚å¯¹æ¯”ï¼š
ğŸ“‹ äº¤é€šæ³•è§„                    ğŸ¢ æƒé™åˆè§„è¦æ±‚
â”œâ”€ ğŸš— é©¾é©¶å‘˜éœ€è¦é©¾ç…§            â”œâ”€ ğŸ‘¤ ç”¨æˆ·éœ€è¦èº«ä»½è®¤è¯
â”œâ”€ ğŸš¦ éµå®ˆäº¤é€šä¿¡å·ç¯            â”œâ”€ ğŸš« éµå®ˆè®¿é—®æ§åˆ¶è§„åˆ™
â”œâ”€ ğŸ“¹ è¿ç« è¡Œä¸ºä¼šè¢«è®°å½•          â”œâ”€ ğŸ“ æ“ä½œè¡Œä¸ºè¢«å®¡è®¡è®°å½•
â”œâ”€ ğŸš“ å®šæœŸæ£€æŸ¥è½¦è¾†çŠ¶æ€          â”œâ”€ ğŸ” å®šæœŸå®¡æŸ¥æƒé™çŠ¶æ€
â””â”€ ğŸ“‹ ä¿é™©å’Œå¹´æ£€è¦æ±‚            â””â”€ ğŸ“Š åˆè§„æ€§æŠ¥å‘Šè¦æ±‚
```

### 6.2 ä¸»è¦åˆè§„æ ‡å‡†


**ğŸ›ï¸ æ³•å¾‹æ³•è§„åˆè§„**
```
ä¸­å›½æ³•å¾‹è¦æ±‚ï¼š
â”œâ”€ ğŸ‡¨ğŸ‡³ ç½‘ç»œå®‰å…¨æ³•
â”‚  â”œâ”€ ä¸ªäººä¿¡æ¯ä¿æŠ¤è¦æ±‚
â”‚  â”œâ”€ æ•°æ®å®‰å…¨ç®¡ç†è§„å®š  
â”‚  â””â”€ ç½‘ç»œè¿è¥è€…è´£ä»»
â”œâ”€ ğŸ“Š æ•°æ®å®‰å…¨æ³•
â”‚  â”œâ”€ æ•°æ®åˆ†ç±»åˆ†çº§ä¿æŠ¤
â”‚  â”œâ”€ é‡è¦æ•°æ®å¤„ç†è§„å®š
â”‚  â””â”€ æ•°æ®è·¨å¢ƒä¼ è¾“é™åˆ¶
â””â”€ ğŸ›¡ï¸ ä¸ªäººä¿¡æ¯ä¿æŠ¤æ³•
   â”œâ”€ æœ€å°å¿…è¦åŸåˆ™
   â”œâ”€ æ˜ç¤ºåŒæ„è¦æ±‚
   â””â”€ æƒåˆ©ä¿éšœæœºåˆ¶
```

**ğŸŒ å›½é™…æ ‡å‡†åˆè§„**
```
GDPR (æ¬§ç›Ÿé€šç”¨æ•°æ®ä¿æŠ¤æ¡ä¾‹)ï¼š
â”œâ”€ ğŸ” æ•°æ®å¤„ç†åˆæ³•æ€§åŸºç¡€
â”œâ”€ ğŸ‘¤ æ•°æ®ä¸»ä½“æƒåˆ©ä¿æŠ¤  
â”œâ”€ ğŸ¢ æ•°æ®æ§åˆ¶è€…è´£ä»»
â”œâ”€ ğŸ“‹ æ•°æ®å¤„ç†è®°å½•è¦æ±‚
â””â”€ ğŸ’° è¿è§„å¤„ç½šæœºåˆ¶

SOX (è¨ç­æ–¯-å¥¥å…‹æ–¯åˆ©æ³•æ¡ˆ)ï¼š
â”œâ”€ ğŸ“Š è´¢åŠ¡æŠ¥å‘Šå†…æ§è¦æ±‚
â”œâ”€ ğŸ” å®¡è®¡è·Ÿè¸ªå®Œæ•´æ€§
â”œâ”€ ğŸ‘¥ èŒè´£åˆ†ç¦»åŸåˆ™  
â””â”€ ğŸ“ åˆè§„æ€§è¯æ˜æ–‡æ¡£
```

### 6.3 åˆè§„æ€§æ§åˆ¶å®ç°


**ğŸ“‹ æ•°æ®è®¿é—®æ§åˆ¶**
```java
// GDPRåˆè§„çš„æ•°æ®è®¿é—®æ§åˆ¶
@Service
public class GDPRComplianceService {
    
    // æ£€æŸ¥æ•°æ®å¤„ç†åˆæ³•æ€§
    public boolean checkProcessingLawfulness(DataProcessingRequest request) {
        // 1. æ£€æŸ¥æ˜¯å¦æœ‰æ˜ç¡®çš„åˆæ³•åŸºç¡€
        if (!hasLegalBasis(request)) {
            throw new ComplianceException("ç¼ºå°‘æ•°æ®å¤„ç†çš„åˆæ³•åŸºç¡€");
        }
        
        // 2. æ£€æŸ¥æ˜¯å¦éµå¾ªæœ€å°åŒ–åŸåˆ™
        if (!isDataMinimized(request)) {
            throw new ComplianceException("è¿åæ•°æ®æœ€å°åŒ–åŸåˆ™");
        }
        
        // 3. æ£€æŸ¥æ˜¯å¦åœ¨ç”¨æˆ·åŒæ„èŒƒå›´å†…
        if (!isWithinConsentScope(request)) {
            throw new ComplianceException("è¶…å‡ºç”¨æˆ·åŒæ„èŒƒå›´");
        }
        
        return true;
    }
    
    // è®°å½•æ•°æ®å¤„ç†æ´»åŠ¨
    public void recordProcessingActivity(String activity, String purpose, 
                                       String dataCategories, String retention) {
        DataProcessingRecord record = DataProcessingRecord.builder()
            .activity(activity)           // å¤„ç†æ´»åŠ¨
            .purpose(purpose)             // å¤„ç†ç›®çš„
            .dataCategories(dataCategories) // æ•°æ®ç±»åˆ«
            .retentionPeriod(retention)   // ä¿ç•™æœŸé™
            .legalBasis("LEGITIMATE_INTEREST") // åˆæ³•åŸºç¡€
            .timestamp(LocalDateTime.now())
            .build();
            
        processingRecordRepository.save(record);
    }
}
```

**ğŸ‘¥ èŒè´£åˆ†ç¦»æ§åˆ¶**
```java
// SOXåˆè§„çš„èŒè´£åˆ†ç¦»æ§åˆ¶
@Service
public class SOXComplianceService {
    
    // æ£€æŸ¥èŒè´£åˆ†ç¦»å†²çª
    public void checkSeparationOfDuties(Long userId, String requestedPermission) {
        List<String> currentPermissions = permissionService.getUserPermissions(userId);
        
        // å®šä¹‰å†²çªçš„æƒé™ç»„åˆ
        Map<String, List<String>> conflictingPermissions = Map.of(
            "CREATE_FINANCIAL_RECORD", List.of("APPROVE_FINANCIAL_RECORD"),
            "SUBMIT_EXPENSE", List.of("APPROVE_EXPENSE"),
            "CREATE_USER", List.of("AUDIT_USER_ACTIVITY")
        );
        
        // æ£€æŸ¥æ˜¯å¦å­˜åœ¨å†²çª
        List<String> conflicts = conflictingPermissions.get(requestedPermission);
        if (conflicts != null) {
            for (String conflict : conflicts) {
                if (currentPermissions.contains(conflict)) {
                    throw new SOXComplianceException(
                        "èŒè´£åˆ†ç¦»å†²çª: ç”¨æˆ·å·²å…·æœ‰æƒé™ " + conflict + 
                        "ï¼Œä¸èƒ½å†åˆ†é…æƒé™ " + requestedPermission
                    );
                }
            }
        }
    }
}
```

---

## 7. ğŸ” å®‰å…¨æ¼æ´é¢„é˜²


### 7.1 å¸¸è§RBACå®‰å…¨æ¼æ´


**ğŸ•³ï¸ æƒé™ç»•è¿‡æ¼æ´**
```java
// âŒ å±é™©ä»£ç ï¼šå‰ç«¯æƒé™æ§åˆ¶
// ä»…åœ¨å‰ç«¯éšè—æŒ‰é’®ï¼Œåç«¯æ²¡æœ‰éªŒè¯
<button v-if="hasPermission('DELETE_USER')" @click="deleteUser">
    åˆ é™¤ç”¨æˆ·
</button>

// æ”»å‡»è€…å¯ä»¥ç›´æ¥è°ƒç”¨API
fetch('/api/users/123', { method: 'DELETE' });

// âœ… å®‰å…¨ä¿®å¤ï¼šåç«¯å¿…é¡»éªŒè¯æƒé™
@DeleteMapping("/users/{id}")
@PreAuthorize("hasPermission('DELETE_USER')")
public void deleteUser(@PathVariable Long id) {
    userService.delete(id);
}
```

**ğŸ”„ ä¼šè¯å›ºå®šæ”»å‡»**
```java
// âŒ å±é™©ï¼šç™»å½•åä¸æ›´æ¢ä¼šè¯ID
public void login(String username, String password) {
    if (authenticate(username, password)) {
        session.setAttribute("userId", user.getId());
        // ä¼šè¯IDä¿æŒä¸å˜ï¼Œå­˜åœ¨å›ºå®šæ”»å‡»é£é™©
    }
}

// âœ… å®‰å…¨ï¼šç™»å½•åé‡æ–°ç”Ÿæˆä¼šè¯ID
public void login(String username, String password, HttpServletRequest request) {
    if (authenticate(username, password)) {
        // ä½¿æ—§ä¼šè¯å¤±æ•ˆ
        request.getSession().invalidate();
        
        // åˆ›å»ºæ–°ä¼šè¯
        HttpSession newSession = request.getSession(true);
        newSession.setAttribute("userId", user.getId());
    }
}
```

### 7.2 è¾“å…¥éªŒè¯ä¸é˜²æŠ¤


**ğŸ›¡ï¸ SQLæ³¨å…¥é˜²æŠ¤**
```java
// âŒ å±é™©ï¼šå­—ç¬¦ä¸²æ‹¼æ¥SQL
public List<User> findUsersByRole(String roleName) {
    String sql = "SELECT * FROM users WHERE role = '" + roleName + "'";
    // æ”»å‡»è€…è¾“å…¥: admin'; DROP TABLE users; --
    return jdbcTemplate.query(sql, userRowMapper);
}

// âœ… å®‰å…¨ï¼šå‚æ•°åŒ–æŸ¥è¯¢
public List<User> findUsersByRole(String roleName) {
    String sql = "SELECT * FROM users WHERE role = ?";
    return jdbcTemplate.query(sql, userRowMapper, roleName);
}
```

**ğŸ”’ XSSæ”»å‡»é˜²æŠ¤**
```java
// æƒé™æè¿°å­—æ®µXSSé˜²æŠ¤
@Service
public class PermissionService {
    
    // æ¸…ç†ç”¨æˆ·è¾“å…¥ï¼Œé˜²æ­¢XSS
    public Permission createPermission(String name, String description) {
        // ä½¿ç”¨OWASP AntiSamyæ¸…ç†HTMLå†…å®¹
        String safeName = antiSamy.scan(name, policy).getCleanHTML();
        String safeDescription = antiSamy.scan(description, policy).getCleanHTML();
        
        return Permission.builder()
            .name(safeName)
            .description(safeDescription)
            .createdAt(LocalDateTime.now())
            .build();
    }
}
```

### 7.3 å®‰å…¨ä»£ç å®è·µ


**ğŸ” å®‰å…¨ç¼–ç è§„èŒƒ**
```java
// å®‰å…¨çš„æƒé™æ£€æŸ¥å·¥å…·ç±»
@Component
public class SecurityUtils {
    
    // å®‰å…¨çš„æƒé™éªŒè¯
    public static boolean hasPermission(Authentication auth, String permission) {
        if (auth == null || !auth.isAuthenticated()) {
            return false;
        }
        
        // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦è¢«ç¦ç”¨
        UserDetails user = (UserDetails) auth.getPrincipal();
        if (!user.isEnabled() || !user.isAccountNonLocked()) {
            return false;
        }
        
        // æ£€æŸ¥æƒé™
        return auth.getAuthorities().stream()
            .anyMatch(authority -> authority.getAuthority().equals(permission));
    }
    
    // å®‰å…¨çš„ç”¨æˆ·IDè·å–
    public static Long getCurrentUserId(Authentication auth) {
        if (auth == null || !auth.isAuthenticated()) {
            throw new SecurityException("ç”¨æˆ·æœªè®¤è¯");
        }
        
        Object principal = auth.getPrincipal();
        if (principal instanceof UserPrincipal) {
            return ((UserPrincipal) principal).getId();
        }
        
        throw new SecurityException("æ— æ³•è·å–ç”¨æˆ·ID");
    }
}
```

---

## 8. ğŸš¨ åº”æ€¥å“åº”æœºåˆ¶


### 8.1 ä»€ä¹ˆæ˜¯åº”æ€¥å“åº”


**é€šä¿—ç†è§£**ï¼šåº”æ€¥å“åº”å°±åƒåŒ»é™¢çš„æ€¥æ•‘ç³»ç»Ÿï¼Œå½“ç³»ç»Ÿå‡ºç°å®‰å…¨é—®é¢˜æ—¶ï¼Œè¦èƒ½å¿«é€Ÿå‘ç°ã€å¿«é€Ÿå¤„ç†ã€å¿«é€Ÿæ¢å¤ã€‚

```
åŒ»é™¢æ€¥æ•‘æµç¨‹                  ç³»ç»Ÿå®‰å…¨åº”æ€¥å“åº”
â”œâ”€ ğŸš¨ å‘ç°ç´§æ€¥æƒ…å†µ            â”œâ”€ ğŸš¨ æ£€æµ‹å®‰å…¨äº‹ä»¶
â”œâ”€ ğŸ“ å‘¼å«æ€¥æ•‘ä¸­å¿ƒ            â”œâ”€ ğŸ“¢ è§¦å‘å®‰å…¨å‘Šè­¦  
â”œâ”€ ğŸš‘ æ´¾é£æ•‘æŠ¤è½¦              â”œâ”€ ğŸ‘¥ é€šçŸ¥å®‰å…¨å›¢é˜Ÿ
â”œâ”€ ğŸ¥ ç´§æ€¥åŒ»ç–—å¤„ç†            â”œâ”€ ğŸ”§ æ‰§è¡Œåº”æ€¥æªæ–½
â”œâ”€ ğŸ’Š åç»­æ²»ç–—è§‚å¯Ÿ            â”œâ”€ ğŸ“Š äº‹ååˆ†ææ€»ç»“
â””â”€ ğŸ“‹ åŒ»ç–—è®°å½•å½’æ¡£            â””â”€ ğŸ“ äº‹ä»¶æŠ¥å‘Šå­˜æ¡£
```

### 8.2 åº”æ€¥å“åº”æµç¨‹


**âš¡ äº‹ä»¶åˆ†çº§å¤„ç†**
```java
// å®‰å…¨äº‹ä»¶åˆ†çº§
public enum SecurityIncidentLevel {
    LOW("ä½", "ä¸€èˆ¬å®‰å…¨é—®é¢˜", "24å°æ—¶å†…å¤„ç†"),
    MEDIUM("ä¸­", "é‡è¦å®‰å…¨é—®é¢˜", "4å°æ—¶å†…å¤„ç†"),  
    HIGH("é«˜", "ä¸¥é‡å®‰å…¨å¨èƒ", "1å°æ—¶å†…å¤„ç†"),
    CRITICAL("ä¸¥é‡", "ç³»ç»Ÿå®‰å…¨å±æœº", "ç«‹å³å¤„ç†");
    
    private String name;
    private String description;
    private String responseTime;
}

// åº”æ€¥å“åº”æœåŠ¡
@Service
public class IncidentResponseService {
    
    // å®‰å…¨äº‹ä»¶å¤„ç†
    public void handleSecurityIncident(SecurityIncident incident) {
        // 1. äº‹ä»¶åˆ†çº§
        SecurityIncidentLevel level = classifyIncident(incident);
        
        // 2. ç«‹å³å“åº”æªæ–½
        executeImmediateResponse(incident, level);
        
        // 3. é€šçŸ¥ç›¸å…³äººå‘˜
        notifySecurityTeam(incident, level);
        
        // 4. æ‰§è¡Œä¿®å¤æªæ–½
        executeRemediationActions(incident);
        
        // 5. è®°å½•å¤„ç†è¿‡ç¨‹
        logIncidentHandling(incident);
    }
    
    private void executeImmediateResponse(SecurityIncident incident, 
                                        SecurityIncidentLevel level) {
        switch (level) {
            case CRITICAL:
                // ç«‹å³ç¦ç”¨å—å½±å“çš„è´¦æˆ·
                disableCompromisedAccounts(incident.getAffectedUsers());
                // é˜»æ–­å¯ç–‘IP
                blockSuspiciousIPs(incident.getSourceIPs());
                // åˆ‡æ¢åˆ°åº”æ€¥æ¨¡å¼
                activateEmergencyMode();
                break;
                
            case HIGH:
                // ä¸´æ—¶é™åˆ¶æ•æ„Ÿæ“ä½œ
                restrictSensitiveOperations();
                // åŠ å¼ºç›‘æ§
                enhanceMonitoring(incident.getAffectedResources());
                break;
                
            case MEDIUM:
            case LOW:
                // è®°å½•å’Œç›‘æ§
                enhanceLogging(incident.getAffectedResources());
                break;
        }
    }
}
```

### 8.3 è‡ªåŠ¨åŒ–åº”æ€¥æªæ–½


**ğŸ¤– è‡ªåŠ¨å“åº”æœºåˆ¶**
```java
// è‡ªåŠ¨åº”æ€¥å“åº”è§„åˆ™å¼•æ“
@Component
public class AutoResponseEngine {
    
    @EventListener
    public void handleBruteForceAttack(BruteForceAttackEvent event) {
        String attackerIP = event.getSourceIP();
        int attemptCount = event.getAttemptCount();
        
        // è‡ªåŠ¨å°ç¦IP
        if (attemptCount >= 10) {
            ipBlockingService.blockIP(attackerIP, Duration.ofHours(24));
            
            // å‘é€å‘Šè­¦é€šçŸ¥
            alertService.sendAlert(SecurityAlert.builder()
                .type("AUTO_IP_BLOCKED")
                .message("è‡ªåŠ¨å°ç¦æ¶æ„IP: " + attackerIP)
                .severity("HIGH")
                .build());
        }
    }
    
    @EventListener  
    public void handleSuspiciousPermissionChange(PermissionChangeEvent event) {
        // æ£€æµ‹æ•æ„Ÿæƒé™å˜æ›´
        if (isSensitivePermission(event.getPermission()) && 
            isOffHours(event.getTimestamp())) {
            
            // è‡ªåŠ¨å†»ç»“æƒé™å˜æ›´
            permissionService.freezePermissionChange(event.getChangeId());
            
            // è¦æ±‚é¢å¤–å®¡æ‰¹
            approvalService.requestEmergencyApproval(event);
            
            // é€šçŸ¥å®‰å…¨å›¢é˜Ÿ
            notificationService.notifySecurityTeam(
                "æ£€æµ‹åˆ°éå·¥ä½œæ—¶é—´æ•æ„Ÿæƒé™å˜æ›´ï¼Œå·²è‡ªåŠ¨å†»ç»“"
            );
        }
    }
}
```

**ğŸ“‹ åº”æ€¥é¢„æ¡ˆæ¨¡æ¿**
```java
// åº”æ€¥å“åº”é¢„æ¡ˆ
@Service
public class EmergencyPlaybookService {
    
    // æ•°æ®æ³„éœ²åº”æ€¥é¢„æ¡ˆ
    public void executeDataBreachPlaybook(DataBreachIncident incident) {
        EmergencyPlaybook playbook = EmergencyPlaybook.builder()
            .name("æ•°æ®æ³„éœ²åº”æ€¥å“åº”")
            .steps(Arrays.asList(
                "1. ç«‹å³éš”ç¦»å—å½±å“ç³»ç»Ÿ",
                "2. è¯„ä¼°æ³„éœ²æ•°æ®èŒƒå›´å’Œæ•æ„Ÿæ€§", 
                "3. é€šçŸ¥æ³•åŠ¡å’Œåˆè§„å›¢é˜Ÿ",
                "4. å‡†å¤‡ç”¨æˆ·é€šçŸ¥æ–¹æ¡ˆ",
                "5. é…åˆç›‘ç®¡éƒ¨é—¨è°ƒæŸ¥",
                "6. ä¿®å¤å®‰å…¨æ¼æ´",
                "7. åŠ å¼ºåç»­ç›‘æ§"
            ))
            .build();
            
        executePlaybook(playbook, incident);
    }
    
    // æƒé™æ»¥ç”¨åº”æ€¥é¢„æ¡ˆ
    public void executePrivilegeAbusePlaybook(PrivilegeAbuseIncident incident) {
        // 1. ç«‹å³å†»ç»“æ¶‰äº‹è´¦æˆ·
        accountService.freezeAccount(incident.getUserId());
        
        // 2. å®¡æŸ¥è¯¥ç”¨æˆ·è¿‘æœŸæ‰€æœ‰æ“ä½œ
        List<AuditLog> recentActivities = auditLogService
            .getUserActivities(incident.getUserId(), Duration.ofDays(30));
            
        // 3. è¯„ä¼°æ½œåœ¨å½±å“èŒƒå›´
        ImpactAssessment assessment = assessImpact(recentActivities);
        
        // 4. é€šçŸ¥ç›¸å…³åˆ©ç›Šæ–¹
        notifyStakeholders(assessment);
        
        // 5. å¯åŠ¨å†…éƒ¨è°ƒæŸ¥ç¨‹åº
        investigationService.startInternalInvestigation(incident);
    }
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„å®‰å…¨æ¦‚å¿µ


```
ğŸ” RBACå®‰å…¨å®¡è®¡æ ¸å¿ƒè¦ç´ 
â”œâ”€ ğŸš¨ å¨èƒè¯†åˆ«: å†…å¤–éƒ¨å®‰å…¨å¨èƒåˆ†æ
â”œâ”€ ğŸ›¡ï¸ æ”»å‡»é˜²æŠ¤: æƒé™æå‡æ”»å‡»é˜²èŒƒ  
â”œâ”€ ğŸ”’ æ•°æ®ä¿æŠ¤: æƒé™æ•°æ®åŠ å¯†å­˜å‚¨
â”œâ”€ ğŸ“ è¡Œä¸ºå®¡è®¡: æ“ä½œæ—¥å¿—è®°å½•è¿½è¸ª
â”œâ”€ ğŸ”„ å˜æ›´ç®¡ç†: æƒé™å˜æ›´å…¨ç¨‹è·Ÿè¸ª
â”œâ”€ ğŸ“‹ åˆè§„è¦æ±‚: æ³•è§„æ ‡å‡†éµå¾ªæ‰§è¡Œ
â”œâ”€ ğŸ” æ¼æ´é˜²æŠ¤: å¸¸è§å®‰å…¨é—®é¢˜é¢„é˜²
â””â”€ ğŸš¨ åº”æ€¥å“åº”: å®‰å…¨äº‹ä»¶å¿«é€Ÿå¤„ç†
```

### 9.2 å®‰å…¨é˜²æŠ¤å…³é”®åŸåˆ™


**ğŸ¯ çºµæ·±é˜²å¾¡ç­–ç•¥**
```
å¤šå±‚å®‰å…¨é˜²æŠ¤ä½“ç³»:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ç”¨æˆ·èº«ä»½è®¤è¯å±‚       â”‚ â† èº«ä»½éªŒè¯ã€å¤šå› å­è®¤è¯
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  
â”‚     æƒé™æˆæƒæ§åˆ¶å±‚       â”‚ â† RBACæƒé™æ§åˆ¶ã€æœ€å°æƒé™åŸåˆ™
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     æ•°æ®åŠ å¯†ä¿æŠ¤å±‚       â”‚ â† ä¼ è¾“åŠ å¯†ã€å­˜å‚¨åŠ å¯†
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     æ“ä½œå®¡è®¡ç›‘æ§å±‚       â”‚ â† è¡Œä¸ºæ—¥å¿—ã€å¼‚å¸¸æ£€æµ‹
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     åº”æ€¥å“åº”å¤„ç½®å±‚       â”‚ â† äº‹ä»¶å“åº”ã€å¿«é€Ÿæ¢å¤
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**âœ… æœ€ä½³å®è·µæ¸…å•**
- [ ] **æœ€å°æƒé™åŸåˆ™**: åªç»™å¿…è¦çš„æœ€å°æƒé™
- [ ] **èŒè´£åˆ†ç¦»åŸåˆ™**: é¿å…æƒé™å†²çªå’Œæ»¥ç”¨  
- [ ] **å®šæœŸæƒé™å®¡æŸ¥**: åŠæ—¶æ¸…ç†æ— ç”¨æƒé™
- [ ] **å…¨ç¨‹æ“ä½œå®¡è®¡**: è®°å½•æ‰€æœ‰å…³é”®æ“ä½œ
- [ ] **å¼‚å¸¸è¡Œä¸ºç›‘æ§**: å®æ—¶æ£€æµ‹å¯ç–‘æ´»åŠ¨
- [ ] **æ•°æ®åŠ å¯†å­˜å‚¨**: ä¿æŠ¤æ•æ„Ÿæƒé™æ•°æ®
- [ ] **åº”æ€¥å“åº”å‡†å¤‡**: åˆ¶å®šå®Œå–„åº”æ€¥é¢„æ¡ˆ
- [ ] **åˆè§„è¦æ±‚éµå¾ª**: æ»¡è¶³æ³•å¾‹æ³•è§„è¦æ±‚

### 9.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ”§ æŠ€æœ¯å®ç°è¦ç‚¹**
```
æƒé™å®‰å…¨å®ç°æ ¸å¿ƒæŠ€æœ¯:
ğŸ“Š æ•°æ®å±‚å®‰å…¨
â”œâ”€ ğŸ” æ•æ„Ÿæ•°æ®åŠ å¯† (AES/RSA)
â”œâ”€ ğŸ›¡ï¸ SQLæ³¨å…¥é˜²æŠ¤ (å‚æ•°åŒ–æŸ¥è¯¢)  
â””â”€ ğŸ“ å®¡è®¡æ—¥å¿—å®Œæ•´æ€§ä¿æŠ¤

âš¡ åº”ç”¨å±‚å®‰å…¨  
â”œâ”€ ğŸš« æƒé™éªŒè¯æ‹¦æˆªå™¨
â”œâ”€ ğŸ”’ ä¼šè¯å®‰å…¨ç®¡ç†
â””â”€ ğŸ¯ è¾“å…¥éªŒè¯è¿‡æ»¤

ğŸŒ ç½‘ç»œå±‚å®‰å…¨
â”œâ”€ ğŸ”’ HTTPSä¼ è¾“åŠ å¯†
â”œâ”€ ğŸš« IPè®¿é—®æ§åˆ¶  
â””â”€ ğŸ›¡ï¸ DDoSæ”»å‡»é˜²æŠ¤
```

**ğŸ“ˆ å®‰å…¨æˆç†Ÿåº¦è¯„ä¼°**
```
å®‰å…¨èƒ½åŠ›æˆç†Ÿåº¦ç­‰çº§:
ğŸŒŸ Level 1 - åŸºç¡€é˜²æŠ¤
â”œâ”€ âœ… åŸºæœ¬èº«ä»½è®¤è¯
â”œâ”€ âœ… ç®€å•æƒé™æ§åˆ¶  
â””â”€ âœ… åŸºç¡€æ—¥å¿—è®°å½•

ğŸŒŸğŸŒŸ Level 2 - è§„èŒƒç®¡ç†
â”œâ”€ âœ… RBACæƒé™æ¨¡å‹
â”œâ”€ âœ… æ“ä½œå®¡è®¡å®Œæ•´
â””â”€ âœ… å®‰å…¨ç­–ç•¥åˆ¶åº¦

ğŸŒŸğŸŒŸğŸŒŸ Level 3 - ä¸»åŠ¨é˜²å¾¡
â”œâ”€ âœ… å¼‚å¸¸è¡Œä¸ºæ£€æµ‹
â”œâ”€ âœ… è‡ªåŠ¨åº”æ€¥å“åº”
â””â”€ âœ… å¨èƒæƒ…æŠ¥é›†æˆ

ğŸŒŸğŸŒŸğŸŒŸğŸŒŸ Level 4 - æ™ºèƒ½å®‰å…¨
â”œâ”€ âœ… AIå®‰å…¨åˆ†æ
â”œâ”€ âœ… é¢„æµ‹æ€§é˜²æŠ¤
â””â”€ âœ… è‡ªé€‚åº”å®‰å…¨ç­–ç•¥
```

> ğŸ’¡ **æ ¸å¿ƒè®°å¿†**: RBACå®‰å…¨å®¡è®¡æ˜¯ä¸€ä¸ªç³»ç»Ÿæ€§å·¥ç¨‹ï¼Œéœ€è¦ä»å¨èƒåˆ†æã€æ”»å‡»é˜²æŠ¤ã€æ•°æ®åŠ å¯†ã€å®¡è®¡ç›‘æ§ã€åˆè§„ç®¡ç†ç­‰å¤šä¸ªç»´åº¦æ„å»ºå®Œæ•´çš„å®‰å…¨é˜²æŠ¤ä½“ç³»ï¼Œç¡®ä¿æƒé™ç³»ç»Ÿçš„å®‰å…¨å¯é è¿è¡Œã€‚

**ğŸ¯ å­¦ä¹ å»ºè®®**:
1. **ç†è®ºåŸºç¡€**: æ·±å…¥ç†è§£å„ç§å®‰å…¨å¨èƒå’Œé˜²æŠ¤åŸç†
2. **å®è·µç»éªŒ**: é€šè¿‡å®é™…é¡¹ç›®ç§¯ç´¯å®‰å…¨å®ç°ç»éªŒ  
3. **æŒç»­å­¦ä¹ **: è·Ÿè¸ªæœ€æ–°å®‰å…¨å¨èƒå’Œé˜²æŠ¤æŠ€æœ¯å‘å±•
4. **åˆè§„æ„è¯†**: å…³æ³¨ç›¸å…³æ³•å¾‹æ³•è§„å’Œè¡Œä¸šæ ‡å‡†è¦æ±‚