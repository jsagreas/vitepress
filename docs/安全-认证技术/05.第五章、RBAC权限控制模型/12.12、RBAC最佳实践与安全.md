---
title: 12ã€RBACæœ€ä½³å®è·µä¸å®‰å…¨
---
## ğŸ“š ç›®å½•

1. [æœ€å°æƒé™åŸåˆ™è¯¦è§£](#1-æœ€å°æƒé™åŸåˆ™è¯¦è§£)
2. [æƒé™ç¡¬ç¼–ç é—®é¢˜ä¸è§£å†³](#2-æƒé™ç¡¬ç¼–ç é—®é¢˜ä¸è§£å†³)
3. [æƒé™è¡¨ä¸æ¥å£å®‰å…¨ä¸€è‡´æ€§](#3-æƒé™è¡¨ä¸æ¥å£å®‰å…¨ä¸€è‡´æ€§)
4. [é˜²æ­¢è¶Šæƒè®¿é—®æ”»å‡»](#4-é˜²æ­¢è¶Šæƒè®¿é—®æ”»å‡»)
5. [æƒé™å®‰å…¨æµ‹è¯•ç­–ç•¥](#5-æƒé™å®‰å…¨æµ‹è¯•ç­–ç•¥)
6. [æƒé™å˜æ›´å®æ—¶ç”Ÿæ•ˆæœºåˆ¶](#6-æƒé™å˜æ›´å®æ—¶ç”Ÿæ•ˆæœºåˆ¶)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ›¡ï¸ æœ€å°æƒé™åŸåˆ™è¯¦è§£


### 1.1 ä»€ä¹ˆæ˜¯æœ€å°æƒé™åŸåˆ™


> **æœ€å°æƒé™åŸåˆ™**ï¼ˆLeast Privilegeï¼‰ï¼šç»™ç”¨æˆ·åˆ†é…==åˆšå¥½å¤Ÿç”¨==çš„æƒé™ï¼Œä¸å¤šç»™ä¸€ä¸ç‚¹å¤šä½™çš„æƒé™ã€‚

**ğŸ” é€šä¿—ç†è§£**

```
ç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼š
é…’åº—æˆ¿å¡ â†’ åªèƒ½å¼€ä½ ä½çš„é‚£é—´æˆ¿ï¼Œä¸èƒ½å¼€å…¶ä»–æˆ¿é—´
é“¶è¡Œå¡ â†’ åªèƒ½æ“ä½œä½ è‡ªå·±çš„è´¦æˆ·ï¼Œä¸èƒ½åŠ¨åˆ«äººçš„é’±
å‘˜å·¥å·¥ç‰Œ â†’ åªèƒ½è¿›å…¥ä½ å·¥ä½œéœ€è¦çš„æ¥¼å±‚å’ŒåŒºåŸŸ

ç¨‹åºä¸­çš„åº”ç”¨ï¼š
æ™®é€šç”¨æˆ· â†’ åªèƒ½æŸ¥çœ‹å’Œç¼–è¾‘è‡ªå·±çš„èµ„æ–™
éƒ¨é—¨ç»ç† â†’ åªèƒ½ç®¡ç†æœ¬éƒ¨é—¨çš„å‘˜å·¥ä¿¡æ¯  
ç³»ç»Ÿç®¡ç†å‘˜ â†’ åªæœ‰ç³»ç»Ÿç»´æŠ¤æƒé™ï¼Œä¸èƒ½æŸ¥çœ‹ä¸šåŠ¡æ•°æ®
```

### 1.2 ä¸ºä»€ä¹ˆè¦éµå¾ªæœ€å°æƒé™åŸåˆ™


**ğŸš¨ æƒé™è¿‡å¤§çš„é£é™©**

```
é£é™©åˆ†æï¼š

æƒé™è¶Šå¤§ï¼Œç ´ååŠ›è¶Šå¼º
    â†“
å†…éƒ¨å‘˜å·¥è¯¯æ“ä½œ â†’ æ•°æ®æŸå¤±
    â†“
è´¦å·è¢«ç›—ç”¨ â†’ å½±å“èŒƒå›´æ‰©å¤§
    â†“
æ¶æ„å†…éƒ¨äººå‘˜ â†’ ç³»ç»Ÿç˜«ç—ª
```

| **æƒé™çº§åˆ«** | **å¯èƒ½é£é™©** | **å½±å“èŒƒå›´** | **é£é™©ç­‰çº§** |
|-------------|-------------|-------------|-------------|
| **è¶…çº§ç®¡ç†å‘˜** | `åˆ é™¤æ•´ä¸ªæ•°æ®åº“` | `å…¨ç³»ç»Ÿ` | ğŸ”´ **æé«˜** |
| **æ™®é€šç®¡ç†å‘˜** | `è¯¯åˆ é‡è¦é…ç½®` | `éƒ¨åˆ†åŠŸèƒ½` | ğŸŸ¡ **ä¸­ç­‰** |
| **æ™®é€šç”¨æˆ·** | `ä¿®æ”¹ä¸ªäººèµ„æ–™` | `ä¸ªäººæ•°æ®` | ğŸŸ¢ **ä½** |

### 1.3 å¦‚ä½•å®æ–½æœ€å°æƒé™åŸåˆ™


**âš¡ æƒé™åˆ†é…ç­–ç•¥**

```java
// âŒ é”™è¯¯åšæ³•ï¼šä¸€åˆ€åˆ‡ç»™å¤§æƒé™
@PreAuthorize("hasRole('ADMIN')")  // ç»™äº†ç®¡ç†å‘˜æ‰€æœ‰æƒé™
public String deleteUser(Long userId) {
    // ç”¨æˆ·ç®¡ç†å‘˜ä¹Ÿèƒ½åˆ é™¤ç”¨æˆ·ï¼Ÿå¤ªå±é™©äº†ï¼
}

// âœ… æ­£ç¡®åšæ³•ï¼šç²¾ç»†åŒ–æƒé™
@PreAuthorize("hasAuthority('user:delete')")  // åªæœ‰åˆ é™¤ç”¨æˆ·æƒé™æ‰èƒ½æ‰§è¡Œ
public String deleteUser(Long userId) {
    // å³ä½¿æ˜¯ç®¡ç†å‘˜ï¼Œä¹Ÿè¦æœ‰å…·ä½“çš„åˆ é™¤æƒé™æ‰è¡Œ
}
```

**ğŸ¯ æƒé™è®¾è®¡åŸåˆ™**

```
æƒé™è®¾è®¡é‡‘å­—å¡”ï¼š

                    æ‹’ç»æ‰€æœ‰
                   /        \
              é»˜è®¤æ— æƒé™    æ˜ç¡®æˆæƒ
             /        \   /        \
        ä¸šåŠ¡éœ€è¦æ—¶     å®šæœŸå®¡æŸ¥    æƒé™å›æ”¶    æœ€å°åŒ–åŸåˆ™
```

**ğŸ“‹ å®é™…åº”ç”¨ç¤ºä¾‹**

```java
// æ–‡ä»¶ç®¡ç†ç³»ç»Ÿçš„æƒé™è®¾è®¡
public class FilePermissionExample {
    
    // æ™®é€šç”¨æˆ·ï¼šåªèƒ½æ“ä½œè‡ªå·±çš„æ–‡ä»¶
    @PreAuthorize("@fileService.isOwner(#fileId, authentication.name)")
    public void editFile(Long fileId, String content) {
        // åªèƒ½ç¼–è¾‘è‡ªå·±çš„æ–‡ä»¶
    }
    
    // éƒ¨é—¨ç»ç†ï¼šå¯ä»¥æŸ¥çœ‹éƒ¨é—¨å†…æ–‡ä»¶
    @PreAuthorize("hasAuthority('file:dept_view') and " +
                  "@fileService.isInSameDept(#fileId, authentication.name)")
    public List<File> getDeptFiles(Long deptId) {
        // åªèƒ½æŸ¥çœ‹æœ¬éƒ¨é—¨çš„æ–‡ä»¶
    }
    
    // ç³»ç»Ÿå¤‡ä»½å‘˜ï¼šåªæœ‰å¤‡ä»½æƒé™ï¼Œä¸èƒ½æŸ¥çœ‹æ–‡ä»¶å†…å®¹
    @PreAuthorize("hasAuthority('system:backup')")
    public void backupFiles() {
        // åªèƒ½æ‰§è¡Œå¤‡ä»½æ“ä½œï¼Œçœ‹ä¸åˆ°æ–‡ä»¶å†…å®¹
    }
}
```

---

## 2. ğŸš« æƒé™ç¡¬ç¼–ç é—®é¢˜ä¸è§£å†³


### 2.1 ä»€ä¹ˆæ˜¯æƒé™ç¡¬ç¼–ç 


> **æƒé™ç¡¬ç¼–ç **ï¼šæŠŠæƒé™æ£€æŸ¥çš„é€»è¾‘ç›´æ¥å†™æ­»åœ¨ä»£ç é‡Œï¼Œåƒé’‰é’‰å­ä¸€æ ·ï¼Œä¸€æ—¦å†™å¥½å°±å¾ˆéš¾æ”¹åŠ¨ã€‚

**ğŸ˜± ç¡¬ç¼–ç çš„å…¸å‹è¡¨ç°**

```java
// âŒ ç¡¬ç¼–ç ç¤ºä¾‹1ï¼šè§’è‰²å†™æ­»åœ¨ä»£ç é‡Œ
public String deleteUser(Long userId) {
    String currentUser = getCurrentUser();
    // ç›´æ¥åœ¨ä»£ç é‡Œå†™æ­»åªæœ‰adminèƒ½åˆ é™¤ç”¨æˆ·
    if (!"admin".equals(currentUser.getRole())) {
        throw new SecurityException("æ²¡æœ‰æƒé™åˆ é™¤ç”¨æˆ·");
    }
    // åˆ é™¤ç”¨æˆ·çš„é€»è¾‘...
}

// âŒ ç¡¬ç¼–ç ç¤ºä¾‹2ï¼šç”¨æˆ·åå†™æ­»åœ¨ä»£ç é‡Œ  
public List<SalaryInfo> getSalaryReport() {
    String username = getCurrentUsername();
    // ç›´æ¥å†™æ­»åªæœ‰è€æ¿èƒ½çœ‹å·¥èµ„æŠ¥è¡¨
    if (!"boss".equals(username) && !"hr_manager".equals(username)) {
        throw new SecurityException("æ— æƒæŸ¥çœ‹å·¥èµ„æŠ¥è¡¨");
    }
    // æŸ¥è¯¢å·¥èµ„æ•°æ®...
}
```

### 2.2 ç¡¬ç¼–ç çš„é—®é¢˜


**ğŸ”¥ ç¡¬ç¼–ç å¸¦æ¥çš„ç—›è‹¦**

```
ç¡¬ç¼–ç é—®é¢˜é“¾ï¼š

éœ€æ±‚å˜æ›´ â†’ ä»£ç è¦æ”¹ â†’ é‡æ–°ç¼–è¯‘ â†’ é‡æ–°éƒ¨ç½² â†’ åœæœºæ—¶é—´
    â†“          â†“         â†“         â†“         â†“
æ–°è§’è‰²å‡ºç°   æ”¹Nä¸ªæ–‡ä»¶   æµ‹è¯•é£é™©   å‘å¸ƒé£é™©   ç”¨æˆ·æŠ±æ€¨
```

| **é—®é¢˜** | **å…·ä½“è¡¨ç°** | **è§£å†³æˆæœ¬** |
|---------|-------------|-------------|
| **ç»´æŠ¤å›°éš¾** | `æƒé™é€»è¾‘æ•£è½åœ¨å„ä¸ªä»£ç æ–‡ä»¶ä¸­` | ğŸ”´ **å¾ˆé«˜** |
| **æ‰©å±•æ€§å·®** | `æ–°å¢è§’è‰²éœ€è¦æ”¹ä»£ç ` | ğŸ”´ **å¾ˆé«˜** |
| **æµ‹è¯•å¤æ‚** | `æ¯æ¬¡æ”¹æƒé™éƒ½è¦å…¨é¢æµ‹è¯•` | ğŸŸ¡ **ä¸­ç­‰** |
| **éƒ¨ç½²é£é™©** | `æƒé™è°ƒæ•´éœ€è¦é‡å¯æœåŠ¡` | ğŸŸ¡ **ä¸­ç­‰** |

### 2.3 è§£å†³ç¡¬ç¼–ç çš„æ–¹æ³•


**âœ… é…ç½®åŒ–æƒé™ç®¡ç†**

```java
// æƒé™é…ç½®è¡¨ï¼ˆæ•°æ®åº“ï¼‰
// role_permissionsè¡¨ï¼š
// role_code | permission_code | resource
// admin     | user:delete     | user_management
// manager   | user:view       | user_management  
// hr        | salary:view     | salary_report

// æ­£ç¡®åšæ³•ï¼šä»æ•°æ®åº“è¯»å–æƒé™
@Service
public class PermissionService {
    
    public boolean hasPermission(String roleCode, String permission) {
        // ä»æ•°æ®åº“æŸ¥è¯¢è¯¥è§’è‰²æ˜¯å¦æœ‰è¿™ä¸ªæƒé™
        return permissionMapper.checkPermission(roleCode, permission);
    }
}

// æ§åˆ¶å™¨ä¸­ä½¿ç”¨
@RestController
public class UserController {
    
    @Autowired
    private PermissionService permissionService;
    
    public String deleteUser(Long userId) {
        String currentRole = getCurrentUserRole();
        
        // åŠ¨æ€æ£€æŸ¥æƒé™ï¼Œä¸å†™æ­»åœ¨ä»£ç é‡Œ
        if (!permissionService.hasPermission(currentRole, "user:delete")) {
            throw new SecurityException("æ²¡æœ‰åˆ é™¤ç”¨æˆ·çš„æƒé™");
        }
        
        // åˆ é™¤ç”¨æˆ·é€»è¾‘...
        return "åˆ é™¤æˆåŠŸ";
    }
}
```

**ğŸ¯ ä½¿ç”¨Spring Securityæ³¨è§£**

```java
// æ›´ç®€æ´çš„æ–¹å¼ï¼šä½¿ç”¨æ³¨è§£
@RestController
public class UserController {
    
    // æ³¨è§£ä¼šè‡ªåŠ¨æ£€æŸ¥æƒé™ï¼Œä¸éœ€è¦å†™ifåˆ¤æ–­
    @PreAuthorize("hasAuthority('user:delete')")
    public String deleteUser(Long userId) {
        // ç›´æ¥å†™ä¸šåŠ¡é€»è¾‘ï¼Œæƒé™æ£€æŸ¥äº¤ç»™æ¡†æ¶
        userService.deleteById(userId);
        return "åˆ é™¤æˆåŠŸ";
    }
    
    // æ›´çµæ´»çš„è¡¨è¾¾å¼
    @PreAuthorize("hasRole('ADMIN') or (hasRole('MANAGER') and @userService.isInSameDept(#userId, authentication.name))")
    public String editUser(Long userId, UserDTO userInfo) {
        // ç®¡ç†å‘˜å¯ä»¥ç¼–è¾‘æ‰€æœ‰ç”¨æˆ·ï¼Œéƒ¨é—¨ç»ç†åªèƒ½ç¼–è¾‘æœ¬éƒ¨é—¨ç”¨æˆ·
        userService.update(userId, userInfo);
        return "ä¿®æ”¹æˆåŠŸ";
    }
}
```

---

## 3. ğŸ”— æƒé™è¡¨ä¸æ¥å£å®‰å…¨ä¸€è‡´æ€§


### 3.1 ä»€ä¹ˆæ˜¯ä¸€è‡´æ€§é—®é¢˜


> **ä¸€è‡´æ€§é—®é¢˜**ï¼šæ•°æ®åº“é‡Œçš„æƒé™é…ç½®å’Œå®é™…æ¥å£çš„å®‰å…¨æ£€æŸ¥==ä¸åŒ¹é…==ï¼Œå°±åƒåœ°å›¾å’Œå®é™…é“è·¯å¯¹ä¸ä¸Šã€‚

**ğŸš¨ å¸¸è§ä¸ä¸€è‡´ç°è±¡**

```
ä¸ä¸€è‡´çš„å…¸å‹åœºæ™¯ï¼š

æƒé™è¡¨è¯´ï¼šç”¨æˆ·æœ‰"æŸ¥çœ‹å·¥èµ„"æƒé™
    â†“
å®é™…æ¥å£ï¼šæ£€æŸ¥çš„æ˜¯"æŸ¥çœ‹è´¢åŠ¡"æƒé™  
    â†“
ç»“æœï¼šç”¨æˆ·æ˜æ˜æœ‰æƒé™ï¼Œä½†å°±æ˜¯è®¿é—®ä¸äº†
```

```java
// æ•°æ®åº“ä¸­çš„æƒé™é…ç½®
// permissionsè¡¨ä¸­æœ‰: "salary:view" - æŸ¥çœ‹å·¥èµ„æƒé™

// ä½†æ˜¯æ¥å£ä¸­æ£€æŸ¥çš„æ˜¯åˆ«çš„æƒé™
@PreAuthorize("hasAuthority('finance:view')")  // æ£€æŸ¥çš„æ˜¯finance:view
public List<Salary> getSalaryList() {
    // æƒé™åç§°ä¸åŒ¹é…ï¼ç”¨æˆ·æœ‰salary:viewæƒé™ä½†æ¥å£è¦æ±‚finance:view
    return salaryService.getAllSalaries();
}
```

### 3.2 å¦‚ä½•ä¿è¯ä¸€è‡´æ€§


**ğŸ“‹ æƒé™æ ‡å‡†åŒ–ç®¡ç†**

```java
// 1. å®šä¹‰æƒé™å¸¸é‡ç±»ï¼Œé¿å…æ‹¼å†™é”™è¯¯
public class PermissionConstants {
    // ç”¨æˆ·ç®¡ç†æƒé™
    public static final String USER_VIEW = "user:view";
    public static final String USER_CREATE = "user:create";
    public static final String USER_DELETE = "user:delete";
    
    // å·¥èµ„ç®¡ç†æƒé™
    public static final String SALARY_VIEW = "salary:view";
    public static final String SALARY_EDIT = "salary:edit";
}

// 2. æ¥å£ä½¿ç”¨æ ‡å‡†æƒé™åç§°
@PreAuthorize("hasAuthority(T(com.example.PermissionConstants).USER_DELETE)")
public String deleteUser(Long userId) {
    userService.deleteById(userId);
    return "åˆ é™¤æˆåŠŸ";
}
```

**âœ… æƒé™ä¸€è‡´æ€§æ£€æŸ¥å·¥å…·**

```java
// è‡ªåŠ¨æ£€æŸ¥å·¥å…·ï¼šæ‰«æä»£ç ä¸­çš„æƒé™æ³¨è§£
@Component
public class PermissionConsistencyChecker {
    
    @Autowired
    private PermissionMapper permissionMapper;
    
    // å¯åŠ¨æ—¶æ£€æŸ¥æƒé™ä¸€è‡´æ€§
    @PostConstruct
    public void checkConsistency() {
        // è·å–æ•°æ®åº“ä¸­æ‰€æœ‰æƒé™
        Set<String> dbPermissions = permissionMapper.getAllPermissions();
        
        // è·å–ä»£ç ä¸­ä½¿ç”¨çš„æƒé™ï¼ˆé€šè¿‡åå°„æ‰«ææ³¨è§£ï¼‰
        Set<String> codePermissions = scanPermissionsInCode();
        
        // æ‰¾å‡ºä¸ä¸€è‡´çš„æƒé™
        Set<String> missingInDb = new HashSet<>(codePermissions);
        missingInDb.removeAll(dbPermissions);
        
        Set<String> unusedInCode = new HashSet<>(dbPermissions);
        unusedInCode.removeAll(codePermissions);
        
        if (!missingInDb.isEmpty()) {
            log.warn("ä»£ç ä¸­ä½¿ç”¨ä½†æ•°æ®åº“ä¸­ä¸å­˜åœ¨çš„æƒé™: {}", missingInDb);
        }
        
        if (!unusedInCode.isEmpty()) {
            log.warn("æ•°æ®åº“ä¸­å­˜åœ¨ä½†ä»£ç ä¸­æœªä½¿ç”¨çš„æƒé™: {}", unusedInCode);
        }
    }
}
```

---

## 4. âš”ï¸ é˜²æ­¢è¶Šæƒè®¿é—®æ”»å‡»


### 4.1 ä»€ä¹ˆæ˜¯è¶Šæƒè®¿é—®


> **è¶Šæƒè®¿é—®**ï¼šç”¨æˆ·è®¿é—®äº†==è¶…å‡ºè‡ªå·±æƒé™èŒƒå›´==çš„èµ„æºæˆ–åŠŸèƒ½ï¼Œå°±åƒç”¨åˆ«äººçš„é’¥åŒ™å¼€é—¨ã€‚

**ğŸ” è¶Šæƒè®¿é—®çš„ä¸¤ç§ç±»å‹**

```
è¶Šæƒè®¿é—®åˆ†ç±»å›¾ï¼š

                    è¶Šæƒè®¿é—®
                   /        \
            æ°´å¹³è¶Šæƒ          å‚ç›´è¶Šæƒ
           /        \       /        \
    åŒçº§åˆ«ç”¨æˆ·     çœ‹åˆ«äººæ•°æ®  ä½æƒé™ç”¨æˆ·   è·å¾—é«˜æƒé™
    ä¾‹ï¼šæ™®é€šå‘˜å·¥    ä¾‹ï¼šAæŸ¥çœ‹B   ä¾‹ï¼šæ™®é€šç”¨æˆ·  ä¾‹ï¼šè·å¾—ç®¡ç†æƒé™
    çœ‹å…¶ä»–å‘˜å·¥èµ„æ–™   çš„ä¸ªäººèµ„æ–™   æ‰§è¡Œç®¡ç†åŠŸèƒ½
```

### 4.2 æ°´å¹³è¶Šæƒæ”»å‡»


**ğŸ¯ æ°´å¹³è¶Šæƒå«ä¹‰**

> **æ°´å¹³è¶Šæƒ**ï¼šç›¸åŒæƒé™çº§åˆ«çš„ç”¨æˆ·Aè®¿é—®äº†ç”¨æˆ·Bçš„ç§äººæ•°æ®ã€‚

**ğŸ˜ˆ å…¸å‹æ”»å‡»åœºæ™¯**

```java
// ç”¨æˆ·Açš„è¯·æ±‚ï¼šGET /api/profile/123
// ç”¨æˆ·Bçš„è¯·æ±‚ï¼šGET /api/profile/456  

// âŒ å­˜åœ¨æ°´å¹³è¶Šæƒæ¼æ´çš„ä»£ç 
@GetMapping("/profile/{userId}")
public UserProfile getProfile(@PathVariable Long userId) {
    // å±é™©ï¼æ²¡æœ‰æ£€æŸ¥å½“å‰ç”¨æˆ·æ˜¯å¦èƒ½è®¿é—®è¿™ä¸ªç”¨æˆ·IDçš„èµ„æ–™
    return userService.getProfileById(userId);
}

// æ”»å‡»è€…å¯èƒ½çš„æ“ä½œï¼š
// ç”¨æˆ·Aï¼ˆID=123ï¼‰å‘é€è¯·æ±‚ï¼šGET /api/profile/456
// å¦‚æœæ¥å£æ²¡æœ‰æ ¡éªŒï¼Œç”¨æˆ·Aå°±èƒ½çœ‹åˆ°ç”¨æˆ·Bçš„ä¸ªäººèµ„æ–™
```

**âœ… é˜²æŠ¤æ–¹æ³•**

```java
// æ­£ç¡®çš„é˜²æŠ¤ä»£ç 
@GetMapping("/profile/{userId}")
public UserProfile getProfile(@PathVariable Long userId) {
    Long currentUserId = getCurrentUserId();
    
    // æ£€æŸ¥1ï¼šç”¨æˆ·åªèƒ½æŸ¥çœ‹è‡ªå·±çš„èµ„æ–™
    if (!currentUserId.equals(userId)) {
        throw new SecurityException("æ— æƒè®¿é—®å…¶ä»–ç”¨æˆ·çš„ä¸ªäººèµ„æ–™");
    }
    
    return userService.getProfileById(userId);
}

// æ›´çµæ´»çš„æƒé™æ§åˆ¶
@GetMapping("/profile/{userId}")
@PreAuthorize("@userService.canAccess(#userId, authentication.name)")
public UserProfile getProfile(@PathVariable Long userId) {
    return userService.getProfileById(userId);
}

@Service
public class UserService {
    public boolean canAccess(Long userId, String currentUsername) {
        Long currentUserId = getUserIdByUsername(currentUsername);
        
        // å¯ä»¥è®¿é—®è‡ªå·±çš„èµ„æ–™
        if (currentUserId.equals(userId)) {
            return true;
        }
        
        // ç®¡ç†å‘˜å¯ä»¥è®¿é—®ä¸‹å±çš„èµ„æ–™
        if (isManager(currentUserId) && isSubordinate(userId, currentUserId)) {
            return true;
        }
        
        return false;
    }
}
```

### 4.3 å‚ç›´è¶Šæƒæ”»å‡»


**ğŸ¯ å‚ç›´è¶Šæƒå«ä¹‰**

> **å‚ç›´è¶Šæƒ**ï¼šä½æƒé™ç”¨æˆ·æ‰§è¡Œäº†åªæœ‰é«˜æƒé™ç”¨æˆ·æ‰èƒ½æ‰§è¡Œçš„æ“ä½œã€‚

**ğŸ˜ˆ å…¸å‹æ”»å‡»åœºæ™¯**

```java
// âŒ å­˜åœ¨å‚ç›´è¶Šæƒæ¼æ´çš„ä»£ç 
@PostMapping("/admin/deleteUser")
public String deleteUser(@RequestParam Long userId) {
    // å±é™©ï¼æ¥å£åç§°æš—ç¤ºåªæœ‰adminèƒ½ç”¨ï¼Œä½†æ²¡æœ‰å®é™…æƒé™æ£€æŸ¥
    userService.deleteById(userId);
    return "åˆ é™¤æˆåŠŸ";
}

// æ”»å‡»è€…å¯èƒ½çš„æ“ä½œï¼š
// æ™®é€šç”¨æˆ·ç›´æ¥è®¿é—® POST /admin/deleteUser?userId=123
// å¦‚æœæ²¡æœ‰æƒé™éªŒè¯ï¼Œæ™®é€šç”¨æˆ·å°±èƒ½åˆ é™¤å…¶ä»–ç”¨æˆ·
```

**âœ… é˜²æŠ¤æ–¹æ³•**

```java
// æ­£ç¡®çš„é˜²æŠ¤ä»£ç 
@PostMapping("/admin/deleteUser")
@PreAuthorize("hasRole('ADMIN')")  // æ˜ç¡®è¦æ±‚ç®¡ç†å‘˜è§’è‰²
public String deleteUser(@RequestParam Long userId) {
    // åŒé‡æ£€æŸ¥ï¼šå³ä½¿æœ‰ç®¡ç†å‘˜è§’è‰²ï¼Œä¹Ÿè¦æ£€æŸ¥å…·ä½“æƒé™
    if (!hasPermission("user:delete")) {
        throw new SecurityException("æ²¡æœ‰åˆ é™¤ç”¨æˆ·çš„æƒé™");
    }
    
    userService.deleteById(userId);
    return "åˆ é™¤æˆåŠŸ";
}

// æ›´ç»†è‡´çš„æƒé™æ§åˆ¶
@PostMapping("/deleteUser")
@PreAuthorize("hasAuthority('user:delete')")
public String deleteUser(@RequestParam Long userId) {
    Long currentUserId = getCurrentUserId();
    
    // é˜²æ­¢åˆ é™¤æ›´é«˜çº§åˆ«çš„ç”¨æˆ·
    if (userService.isHigherLevel(userId, currentUserId)) {
        throw new SecurityException("æ— æƒåˆ é™¤æ›´é«˜çº§åˆ«çš„ç”¨æˆ·");
    }
    
    // é˜²æ­¢åˆ é™¤è‡ªå·±
    if (userId.equals(currentUserId)) {
        throw new SecurityException("ä¸èƒ½åˆ é™¤è‡ªå·±");
    }
    
    userService.deleteById(userId);
    return "åˆ é™¤æˆåŠŸ";
}
```

### 4.4 ç»¼åˆé˜²æŠ¤ç­–ç•¥


**ğŸ›¡ï¸ å¤šå±‚é˜²æŠ¤ä½“ç³»**

```
è¶Šæƒé˜²æŠ¤ä½“ç³»ï¼š

å‰ç«¯æ ¡éªŒï¼ˆä½“éªŒä¼˜åŒ–ï¼‰
    â†“
ç½‘å…³å±‚æ‹¦æˆªï¼ˆç¬¬ä¸€é“é˜²çº¿ï¼‰
    â†“  
æ¥å£æƒé™æ³¨è§£ï¼ˆç¬¬äºŒé“é˜²çº¿ï¼‰
    â†“
ä¸šåŠ¡é€»è¾‘æ ¡éªŒï¼ˆç¬¬ä¸‰é“é˜²çº¿ï¼‰
    â†“
æ•°æ®åº“æƒé™æ§åˆ¶ï¼ˆæœ€åé˜²çº¿ï¼‰
```

```java
// ç»¼åˆé˜²æŠ¤ç¤ºä¾‹
@RestController
public class OrderController {
    
    @GetMapping("/order/{orderId}")
    @PreAuthorize("hasAuthority('order:view')")  // åŸºç¡€æƒé™æ£€æŸ¥
    public Order getOrder(@PathVariable Long orderId) {
        Long currentUserId = getCurrentUserId();
        
        // ä¸šåŠ¡çº§æƒé™æ£€æŸ¥
        Order order = orderService.getById(orderId);
        
        // ç”¨æˆ·åªèƒ½æŸ¥çœ‹è‡ªå·±çš„è®¢å•
        if (!order.getUserId().equals(currentUserId)) {
            // æ£€æŸ¥æ˜¯å¦æ˜¯å®¢æœï¼Œå®¢æœå¯ä»¥æŸ¥çœ‹ä»»ä½•è®¢å•
            if (!hasRole("CUSTOMER_SERVICE")) {
                throw new SecurityException("æ— æƒæŸ¥çœ‹æ­¤è®¢å•");
            }
        }
        
        return order;
    }
}
```

---

## 5. ğŸ§ª æƒé™å®‰å…¨æµ‹è¯•ç­–ç•¥


### 5.1 ä¸ºä»€ä¹ˆè¦æµ‹è¯•æƒé™å®‰å…¨


> **æƒé™æµ‹è¯•**ï¼šç¡®ä¿ç³»ç»Ÿçš„æƒé™æ§åˆ¶==çœŸçš„æœ‰æ•ˆ==ï¼Œä¸æ˜¯æ‘†è®¾ã€‚

**ğŸš¨ ä¸æµ‹è¯•æƒé™çš„é£é™©**

```
æƒé™æ¼æ´çš„å‘ç°æ—¶æœºï¼š

å¼€å‘é˜¶æ®µ â†’ åŠŸèƒ½æµ‹è¯•é˜¶æ®µ â†’ ç”¨æˆ·ä½¿ç”¨é˜¶æ®µ â†’ è¢«æ”»å‡»å‘ç°
   (å…è´¹)    (æˆæœ¬è¾ƒä½)      (å½±å“ç”¨æˆ·)    (å·¨å¤§æŸå¤±)
```

### 5.2 æƒé™æµ‹è¯•çš„é‡ç‚¹å†…å®¹


**ğŸ“‹ æƒé™æµ‹è¯•æ£€æŸ¥æ¸…å•**

| **æµ‹è¯•ç±»å‹** | **æµ‹è¯•å†…å®¹** | **é¢„æœŸç»“æœ** |
|-------------|-------------|-------------|
| **ğŸ” èº«ä»½éªŒè¯æµ‹è¯•** | `æœªç™»å½•è®¿é—®å—ä¿æŠ¤æ¥å£` | `è¢«æ‹’ç»è®¿é—®` |
| **ğŸ­ è§’è‰²æƒé™æµ‹è¯•** | `ä¸åŒè§’è‰²è®¿é—®åŒä¸€æ¥å£` | `æŒ‰æƒé™å…è®¸æˆ–æ‹’ç»` |
| **âš”ï¸ è¶Šæƒæµ‹è¯•** | `ç”¨æˆ·Aè®¿é—®ç”¨æˆ·Bçš„æ•°æ®` | `è¢«æ‹’ç»è®¿é—®` |
| **ğŸ”„ æƒé™å˜æ›´æµ‹è¯•** | `æƒé™æ’¤é”€åç«‹å³ç”Ÿæ•ˆ` | `å¤±å»å¯¹åº”è®¿é—®æƒé™` |

### 5.3 è‡ªåŠ¨åŒ–æƒé™æµ‹è¯•


**ğŸ¤– ç¼–å†™æƒé™æµ‹è¯•ç”¨ä¾‹**

```java
@SpringBootTest
@AutoConfigureTestDatabase
public class PermissionSecurityTest {
    
    @Autowired
    private MockMvc mockMvc;
    
    @Test
    public void æµ‹è¯•æœªç™»å½•ç”¨æˆ·è®¿é—®å—ä¿æŠ¤æ¥å£() throws Exception {
        // ä¸æä¾›ä»»ä½•èº«ä»½è®¤è¯ä¿¡æ¯
        mockMvc.perform(get("/api/admin/users"))
                .andExpect(status().isUnauthorized())  // æœŸæœ›è¿”å›401
                .andExpect(jsonPath("$.message").value("éœ€è¦ç™»å½•"));
    }
    
    @Test
    public void æµ‹è¯•æ™®é€šç”¨æˆ·è®¿é—®ç®¡ç†å‘˜æ¥å£() throws Exception {
        String userToken = getTokenForRole("USER");  // è·å–æ™®é€šç”¨æˆ·token
        
        mockMvc.perform(get("/api/admin/users")
                .header("Authorization", "Bearer " + userToken))
                .andExpect(status().isForbidden())  // æœŸæœ›è¿”å›403
                .andExpect(jsonPath("$.message").value("æƒé™ä¸è¶³"));
    }
    
    @Test
    public void æµ‹è¯•æ°´å¹³è¶Šæƒè®¿é—®() throws Exception {
        String userAToken = getTokenForUser("userA");  // ç”¨æˆ·Açš„token
        Long userBId = getUserId("userB");             // ç”¨æˆ·Bçš„ID
        
        // ç”¨æˆ·Aå°è¯•è®¿é—®ç”¨æˆ·Bçš„ä¸ªäººèµ„æ–™
        mockMvc.perform(get("/api/profile/" + userBId)
                .header("Authorization", "Bearer " + userAToken))
                .andExpect(status().isForbidden())
                .andExpect(jsonPath("$.message").value("æ— æƒè®¿é—®å…¶ä»–ç”¨æˆ·èµ„æ–™"));
    }
    
    @Test 
    public void æµ‹è¯•æƒé™å˜æ›´ç«‹å³ç”Ÿæ•ˆ() throws Exception {
        // 1. ç»™ç”¨æˆ·åˆ†é…æƒé™
        String userId = "testUser";
        grantPermission(userId, "user:delete");
        
        String userToken = getTokenForUser(userId);
        
        // 2. éªŒè¯ç”¨æˆ·æœ‰æƒé™
        mockMvc.perform(delete("/api/users/123")
                .header("Authorization", "Bearer " + userToken))
                .andExpect(status().isOk());
        
        // 3. æ’¤é”€æƒé™
        revokePermission(userId, "user:delete");
        
        // 4. éªŒè¯æƒé™ç«‹å³å¤±æ•ˆï¼ˆéœ€è¦åˆ·æ–°tokenæˆ–æ¸…é™¤ç¼“å­˜ï¼‰
        String newToken = getTokenForUser(userId);  // è·å–æ–°token
        
        mockMvc.perform(delete("/api/users/124")
                .header("Authorization", "Bearer " + newToken))
                .andExpect(status().isForbidden());
    }
}
```

### 5.4 æ‰‹å·¥æ¸—é€æµ‹è¯•è¦ç‚¹


**ğŸ” æ‰‹å·¥æµ‹è¯•æ£€æŸ¥é¡¹**

```bash
# 1. URLæšä¸¾æµ‹è¯•
# å°è¯•è®¿é—®å¯èƒ½å­˜åœ¨çš„ç®¡ç†æ¥å£
curl -X GET http://localhost:8080/admin
curl -X GET http://localhost:8080/admin/users  
curl -X GET http://localhost:8080/api/admin/config

# 2. å‚æ•°ç¯¡æ”¹æµ‹è¯•
# ä¿®æ”¹è¯·æ±‚å‚æ•°ä¸­çš„ç”¨æˆ·ID
curl -X GET http://localhost:8080/api/profile/123  # è‡ªå·±çš„ID
curl -X GET http://localhost:8080/api/profile/456  # åˆ«äººçš„ID

# 3. HTTPæ–¹æ³•æµ‹è¯•
# å°è¯•ä¸åŒçš„HTTPæ–¹æ³•
curl -X GET    http://localhost:8080/api/users/123    # æŸ¥çœ‹
curl -X PUT    http://localhost:8080/api/users/123    # ä¿®æ”¹
curl -X DELETE http://localhost:8080/api/users/123    # åˆ é™¤

# 4. æƒé™ç»•è¿‡æµ‹è¯•
# å°è¯•é€šè¿‡ä¸åŒè·¯å¾„è®¿é—®åŒä¸€èµ„æº
curl -X GET http://localhost:8080/api/user/profile
curl -X GET http://localhost:8080/user/profile
curl -X GET http://localhost:8080/profile
```

---

## 6. âš¡ æƒé™å˜æ›´å®æ—¶ç”Ÿæ•ˆæœºåˆ¶


### 6.1 ä¸ºä»€ä¹ˆéœ€è¦å®æ—¶ç”Ÿæ•ˆ


> **å®æ—¶ç”Ÿæ•ˆ**ï¼šç®¡ç†å‘˜ä¿®æ”¹äº†ç”¨æˆ·æƒé™ï¼Œ==ç«‹åˆ»ç”Ÿæ•ˆ==ï¼Œä¸éœ€è¦ç”¨æˆ·é‡æ–°ç™»å½•ã€‚

**ğŸ”„ æƒé™å˜æ›´çš„å¸¸è§åœºæ™¯**

```
æƒé™å˜æ›´åœºæ™¯ï¼š

å‘˜å·¥ç¦»èŒ â†’ ç«‹å³æ’¤é”€æ‰€æœ‰æƒé™ â†’ é˜²æ­¢æ¶æ„æ“ä½œ
å‘˜å·¥è°ƒå²— â†’ æ’¤é”€æ—§æƒé™ï¼Œåˆ†é…æ–°æƒé™ â†’ ç¬¦åˆæ–°å²—ä½è¦æ±‚  
ç´§æ€¥æƒ…å†µ â†’ ä¸´æ—¶æå‡æƒé™ â†’ å¿«é€Ÿå“åº”ä¸šåŠ¡éœ€æ±‚
å®‰å…¨äº‹ä»¶ â†’ æ‰¹é‡æ’¤é”€æƒé™ â†’ æ­¢æŸæ§åˆ¶
```

### 6.2 æƒé™ç¼“å­˜çš„é—®é¢˜


**ğŸ˜… ä¼ ç»Ÿç¼“å­˜å¸¦æ¥çš„å»¶è¿Ÿ**

```java
// âŒ é—®é¢˜ï¼šæƒé™ä¿¡æ¯ç¼“å­˜æ—¶é—´å¤ªé•¿
@Cacheable(value = "userPermissions", key = "#userId")
public List<String> getUserPermissions(Long userId) {
    return permissionMapper.getPermissionsByUserId(userId);
}

// é—®é¢˜åˆ†æï¼š
// 1. ç®¡ç†å‘˜æ’¤é”€äº†ç”¨æˆ·æƒé™
// 2. æ•°æ®åº“å·²æ›´æ–°ï¼Œä½†ç¼“å­˜è¿˜æ˜¯æ—§æ•°æ®
// 3. ç”¨æˆ·åœ¨ç¼“å­˜è¿‡æœŸå‰ä»ç„¶æœ‰æƒé™
// 4. å®‰å…¨é£é™©ï¼
```

### 6.3 å®æ—¶ç”Ÿæ•ˆçš„è§£å†³æ–¹æ¡ˆ


**âš¡ æ–¹æ¡ˆä¸€ï¼šRedisç¼“å­˜ + æ¶ˆæ¯é€šçŸ¥**

```java
@Service
public class PermissionService {
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    @Autowired
    private RedisMessagePublisher messagePublisher;
    
    // è·å–ç”¨æˆ·æƒé™ï¼ˆä»Redisç¼“å­˜ï¼‰
    public List<String> getUserPermissions(Long userId) {
        String key = "user:permissions:" + userId;
        List<String> permissions = (List<String>) redisTemplate.opsForValue().get(key);
        
        if (permissions == null) {
            // ç¼“å­˜ä¸å­˜åœ¨ï¼Œä»æ•°æ®åº“åŠ è½½
            permissions = permissionMapper.getPermissionsByUserId(userId);
            // ç¼“å­˜30åˆ†é’Ÿ
            redisTemplate.opsForValue().set(key, permissions, Duration.ofMinutes(30));
        }
        
        return permissions;
    }
    
    // æ›´æ–°ç”¨æˆ·æƒé™
    public void updateUserPermissions(Long userId, List<String> newPermissions) {
        // 1. æ›´æ–°æ•°æ®åº“
        permissionMapper.updateUserPermissions(userId, newPermissions);
        
        // 2. ç«‹å³æ›´æ–°ç¼“å­˜
        String key = "user:permissions:" + userId;
        redisTemplate.opsForValue().set(key, newPermissions, Duration.ofMinutes(30));
        
        // 3. å‘é€æ¶ˆæ¯é€šçŸ¥å…¶ä»–èŠ‚ç‚¹æ›´æ–°ç¼“å­˜
        PermissionChangeMessage message = new PermissionChangeMessage();
        message.setUserId(userId);
        message.setPermissions(newPermissions);
        
        messagePublisher.publish("permission-change", message);
    }
}

// æ¶ˆæ¯ç›‘å¬å™¨ï¼šå¤„ç†æƒé™å˜æ›´é€šçŸ¥
@Component
public class PermissionChangeListener {
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    @EventListener
    public void handlePermissionChange(PermissionChangeMessage message) {
        // æ›´æ–°æœ¬åœ°ç¼“å­˜
        String key = "user:permissions:" + message.getUserId();
        redisTemplate.opsForValue().set(key, message.getPermissions(), Duration.ofMinutes(30));
        
        log.info("ç”¨æˆ·{}çš„æƒé™å·²æ›´æ–°", message.getUserId());
    }
}
```

**âš¡ æ–¹æ¡ˆäºŒï¼šJWTé»‘åå•æœºåˆ¶**

```java
@Service
public class JwtBlacklistService {
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    // å°†ç”¨æˆ·çš„JWTåŠ å…¥é»‘åå•
    public void blacklistUserTokens(Long userId) {
        String key = "jwt:blacklist:user:" + userId;
        // é»‘åå•æœ‰æ•ˆæœŸè®¾ä¸ºJWTçš„è¿‡æœŸæ—¶é—´
        redisTemplate.opsForValue().set(key, true, Duration.ofHours(24));
    }
    
    // æ£€æŸ¥JWTæ˜¯å¦åœ¨é»‘åå•ä¸­
    public boolean isTokenBlacklisted(String token) {
        try {
            Claims claims = Jwts.parser()
                    .setSigningKey(jwtSecret)
                    .parseClaimsJws(token)
                    .getBody();
            
            Long userId = Long.valueOf(claims.getSubject());
            String userKey = "jwt:blacklist:user:" + userId;
            
            // æ£€æŸ¥ç”¨æˆ·çº§é»‘åå•
            Boolean isUserBlacklisted = (Boolean) redisTemplate.opsForValue().get(userKey);
            if (Boolean.TRUE.equals(isUserBlacklisted)) {
                return true;
            }
            
            // æ£€æŸ¥tokençº§é»‘åå•
            String tokenKey = "jwt:blacklist:token:" + DigestUtils.md5Hex(token);
            Boolean isTokenBlacklisted = (Boolean) redisTemplate.opsForValue().get(tokenKey);
            return Boolean.TRUE.equals(isTokenBlacklisted);
            
        } catch (Exception e) {
            return true;  // tokenæ— æ•ˆï¼Œå½“ä½œé»‘åå•å¤„ç†
        }
    }
}

// åœ¨æƒé™æ£€æŸ¥æ‹¦æˆªå™¨ä¸­ä½¿ç”¨
@Component
public class PermissionInterceptor implements HandlerInterceptor {
    
    @Autowired
    private JwtBlacklistService blacklistService;
    
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {
        String token = extractToken(request);
        
        if (token != null && blacklistService.isTokenBlacklisted(token)) {
            response.setStatus(HttpStatus.UNAUTHORIZED.value());
            response.getWriter().write("{\"message\":\"Tokenå·²å¤±æ•ˆï¼Œè¯·é‡æ–°ç™»å½•\"}");
            return false;
        }
        
        return true;
    }
}
```

**âš¡ æ–¹æ¡ˆä¸‰ï¼šWebSocketå®æ—¶æ¨é€**

```java
// æƒé™å˜æ›´æ—¶å‘ç”¨æˆ·æ¨é€æ¶ˆæ¯
@Service
public class PermissionNotificationService {
    
    @Autowired
    private SimpMessagingTemplate messagingTemplate;
    
    // é€šçŸ¥ç”¨æˆ·æƒé™å·²å˜æ›´
    public void notifyPermissionChange(Long userId, String changeType) {
        PermissionChangeNotification notification = new PermissionChangeNotification();
        notification.setChangeType(changeType);  // "REVOKED", "GRANTED", "UPDATED"
        notification.setTimestamp(System.currentTimeMillis());
        notification.setMessage("æ‚¨çš„æƒé™å·²æ›´æ–°ï¼Œè¯·åˆ·æ–°é¡µé¢");
        
        // å‘ç‰¹å®šç”¨æˆ·æ¨é€æ¶ˆæ¯
        messagingTemplate.convertAndSendToUser(
                userId.toString(), 
                "/topic/permission-change", 
                notification
        );
    }
}

// å‰ç«¯JavaScriptå¤„ç†æƒé™å˜æ›´é€šçŸ¥
/*
const stompClient = new StompJs.Client({
    brokerURL: 'ws://localhost:8080/ws'
});

stompClient.onConnect = function(frame) {
    // è®¢é˜…æƒé™å˜æ›´æ¶ˆæ¯
    stompClient.subscribe('/user/topic/permission-change', function(message) {
        const notification = JSON.parse(message.body);
        
        // æ˜¾ç¤ºæç¤ºä¿¡æ¯
        alert(notification.message);
        
        // æ¸…é™¤å‰ç«¯ç¼“å­˜çš„æƒé™ä¿¡æ¯
        localStorage.removeItem('userPermissions');
        
        // é‡æ–°åŠ è½½ç”¨æˆ·æƒé™
        location.reload();
    });
};
*/
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æœ€å°æƒé™åŸåˆ™ï¼šç»™ç”¨æˆ·åˆšå¥½å¤Ÿç”¨çš„æƒé™ï¼Œä¸å¤šç»™
ğŸ”¸ é¿å…ç¡¬ç¼–ç ï¼šæƒé™é€»è¾‘è¦å¯é…ç½®ï¼Œä¸èƒ½å†™æ­»åœ¨ä»£ç é‡Œ
ğŸ”¸ ä¸€è‡´æ€§æ£€æŸ¥ï¼šæ•°æ®åº“æƒé™é…ç½®å’Œæ¥å£æ£€æŸ¥è¦åŒ¹é…
ğŸ”¸ è¶Šæƒé˜²æŠ¤ï¼šé˜²æ­¢æ°´å¹³è¶Šæƒï¼ˆçœ‹åˆ«äººæ•°æ®ï¼‰å’Œå‚ç›´è¶Šæƒï¼ˆè·å¾—é«˜æƒé™ï¼‰
ğŸ”¸ å®‰å…¨æµ‹è¯•ï¼šè‡ªåŠ¨åŒ–æµ‹è¯• + æ‰‹å·¥æ¸—é€æµ‹è¯•
ğŸ”¸ å®æ—¶ç”Ÿæ•ˆï¼šæƒé™å˜æ›´è¦ç«‹å³ç”Ÿæ•ˆï¼Œä¸èƒ½æœ‰å»¶è¿Ÿ
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æƒé™å®‰å…¨çš„æœ¬è´¨**
```
æƒé™å®‰å…¨ = æ­£ç¡®çš„äºº + æ­£ç¡®çš„æ—¶é—´ + æ­£ç¡®çš„æƒé™ + æ­£ç¡®çš„èµ„æº
ç¼ºå°‘ä»»ä½•ä¸€ä¸ªè¦ç´ ï¼Œéƒ½å¯èƒ½é€ æˆå®‰å…¨é£é™©
```

**ğŸ”¹ é˜²æŠ¤è¦åˆ†å±‚æ¬¡**
```
å‰ç«¯æ£€æŸ¥ï¼šç”¨æˆ·ä½“éªŒä¼˜åŒ–ï¼ˆå¯ç»•è¿‡ï¼‰
åç«¯éªŒè¯ï¼šæ ¸å¿ƒå®‰å…¨é˜²æŠ¤ï¼ˆä¸å¯ç»•è¿‡ï¼‰
æ•°æ®åº“æƒé™ï¼šæœ€åä¸€é“é˜²çº¿
å®¡è®¡æ—¥å¿—ï¼šäº‹åè¿½è¸ªåˆ†æ
```

**ğŸ”¹ æƒé™è®¾è®¡çš„å¹³è¡¡**
```
å®‰å…¨æ€§ vs æ˜“ç”¨æ€§ï¼šè¿‡äºä¸¥æ ¼å½±å“ä½“éªŒ
çµæ´»æ€§ vs å¤æ‚æ€§ï¼šå¤ªçµæ´»å®¹æ˜“å‡ºé”™
æ€§èƒ½ vs å®æ—¶æ€§ï¼šç¼“å­˜æå‡æ€§èƒ½ä½†å½±å“å®æ—¶æ€§
```

### 7.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ’¼ ä¼ä¸šçº§æœ€ä½³å®è·µ**
- **æƒé™æ¨¡å‹**ï¼šé‡‡ç”¨RBACæ¨¡å‹ï¼Œç»“åˆä¸šåŠ¡ç‰¹ç‚¹è®¾è®¡è§’è‰²å’Œæƒé™
- **ä»£ç è§„èŒƒ**ï¼šç»Ÿä¸€æƒé™æ³¨è§£ä½¿ç”¨ï¼Œå»ºç«‹æƒé™å¸¸é‡ç±»
- **æµ‹è¯•ç­–ç•¥**ï¼šæ¯æ¬¡å‘å¸ƒå‰è¿›è¡Œå…¨é¢æƒé™æµ‹è¯•
- **ç›‘æ§å‘Šè­¦**ï¼šå»ºç«‹æƒé™ç›¸å…³çš„ç›‘æ§å’Œå¼‚å¸¸å‘Šè­¦

**ğŸ”§ å¼€å‘å®æ–½è¦ç‚¹**
- **è®¾è®¡é˜¶æ®µ**ï¼šå…ˆè®¾è®¡æƒé™æ¨¡å‹ï¼Œå†å¼€å‘åŠŸèƒ½
- **ç¼–ç é˜¶æ®µ**ï¼šä½¿ç”¨æ³¨è§£è€Œä¸æ˜¯ç¡¬ç¼–ç 
- **æµ‹è¯•é˜¶æ®µ**ï¼šé‡ç‚¹æµ‹è¯•è¾¹ç•Œæƒ…å†µå’Œå¼‚å¸¸åœºæ™¯
- **ä¸Šçº¿é˜¶æ®µ**ï¼šç°åº¦å‘å¸ƒï¼Œè§‚å¯Ÿæƒé™ç›¸å…³æŒ‡æ ‡

**âš ï¸ å¸¸è§è¯¯åŒºé¿å…**
```
âŒ è®¤ä¸ºå‰ç«¯éšè—æŒ‰é’®å°±æ˜¯æƒé™æ§åˆ¶
âŒ åªåœ¨é‡è¦æ¥å£åšæƒé™æ£€æŸ¥
âŒ æƒé™ç¼“å­˜æ—¶é—´è®¾ç½®è¿‡é•¿
âŒ å¿½è§†æƒé™å˜æ›´çš„æµ‹è¯•
âŒ ä¸è®°å½•æƒé™ç›¸å…³çš„æ“ä½œæ—¥å¿—
```

**ğŸ¯ å®‰å…¨æ£€æŸ¥æ¸…å•**
```
âœ“ æ¯ä¸ªæ¥å£éƒ½æœ‰æƒé™æ£€æŸ¥
âœ“ æƒé™æ£€æŸ¥é€»è¾‘ä¸èƒ½è¢«ç»•è¿‡
âœ“ æ•æ„Ÿæ“ä½œæœ‰é¢å¤–éªŒè¯
âœ“ æƒé™å˜æ›´æœ‰æ—¥å¿—è®°å½•
âœ“ å®šæœŸå®¡è®¡ç”¨æˆ·æƒé™
âœ“ å»ºç«‹æƒé™å›æ”¶æœºåˆ¶
```

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
```
æœ€å°æƒé™ä¿å¹³å®‰ï¼Œç¡¬ç¼–ç åšå†³ä¸èƒ½è¦
ä¸€è‡´æ€§æ£€æŸ¥å¾ˆé‡è¦ï¼Œè¶Šæƒæ”»å‡»è¦é˜²å¥½
å®‰å…¨æµ‹è¯•ä¸èƒ½å°‘ï¼Œå®æ—¶ç”Ÿæ•ˆç«‹å³åˆ°
æƒé™å®‰å…¨æ— å°äº‹ï¼Œç»†èŠ‚å†³å®šæˆè´¥é«˜
```