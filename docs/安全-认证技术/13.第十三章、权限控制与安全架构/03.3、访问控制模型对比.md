---
title: 3ã€è®¿é—®æ§åˆ¶æ¨¡å‹å¯¹æ¯”
---
## ğŸ“š ç›®å½•

1. [è®¿é—®æ§åˆ¶æ¨¡å‹æ¦‚è¿°](#1-è®¿é—®æ§åˆ¶æ¨¡å‹æ¦‚è¿°)
2. [ACLè®¿é—®æ§åˆ¶åˆ—è¡¨](#2-ACLè®¿é—®æ§åˆ¶åˆ—è¡¨)
3. [RBACåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶](#3-RBACåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶)
4. [ABACåŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶](#4-ABACåŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶)
5. [MACå¼ºåˆ¶è®¿é—®æ§åˆ¶](#5-MACå¼ºåˆ¶è®¿é—®æ§åˆ¶)
6. [DACè‡ªä¸»è®¿é—®æ§åˆ¶](#6-DACè‡ªä¸»è®¿é—®æ§åˆ¶)
7. [è®¿é—®æ§åˆ¶æ¨¡å‹å¯¹æ¯”](#7-è®¿é—®æ§åˆ¶æ¨¡å‹å¯¹æ¯”)
8. [æ··åˆæ–¹æ¡ˆä¸æœ€ä½³å®è·µ](#8-æ··åˆæ–¹æ¡ˆä¸æœ€ä½³å®è·µ)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ è®¿é—®æ§åˆ¶æ¨¡å‹æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯è®¿é—®æ§åˆ¶


> ğŸ’¡ **æ ¸å¿ƒæ¦‚å¿µ**ï¼šè®¿é—®æ§åˆ¶å°±æ˜¯å†³å®š"è°èƒ½å¯¹ä»€ä¹ˆèµ„æºåšä»€ä¹ˆæ“ä½œ"çš„å®‰å…¨æœºåˆ¶

**é€šä¿—ç†è§£**ï¼šå°±åƒé—¨ç¦å¡ä¸€æ ·ï¼Œä¸åŒçš„äººæœ‰ä¸åŒçš„æƒé™å¡ï¼Œèƒ½è¿›å…¥ä¸åŒçš„æˆ¿é—´ï¼Œåšä¸åŒçš„äº‹æƒ…ã€‚

```
è®¿é—®æ§åˆ¶çš„ä¸‰è¦ç´ ï¼š
ğŸ‘¤ ä¸»ä½“(Subject) - è°ï¼Ÿ     â†’ ç”¨æˆ·ã€ç¨‹åºã€æœåŠ¡
ğŸ“ å®¢ä½“(Object) - ä»€ä¹ˆï¼Ÿ    â†’ æ–‡ä»¶ã€æ•°æ®åº“ã€æ¥å£  
âš¡ æ“ä½œ(Action) - åšä»€ä¹ˆï¼Ÿ  â†’ è¯»å–ã€å†™å…¥ã€åˆ é™¤ã€æ‰§è¡Œ
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦è®¿é—®æ§åˆ¶


**ç°å®åœºæ™¯å¯¹æ¯”**ï¼š
```
å…¬å¸åŠå…¬æ¥¼çš„æƒé™ç®¡ç†ï¼š
ğŸ¢ CEO           â†’ æ‰€æœ‰æ¥¼å±‚ã€æ‰€æœ‰æˆ¿é—´
ğŸ‘¨â€ğŸ’¼ éƒ¨é—¨ç»ç†      â†’ æœ¬éƒ¨é—¨æ¥¼å±‚ã€ä¼šè®®å®¤
ğŸ‘©â€ğŸ’» æ™®é€šå‘˜å·¥      â†’ åŠå…¬åŒºã€èŒ¶æ°´é—´
ğŸ§¹ ä¿æ´å‘˜        â†’ å…¬å…±åŒºåŸŸã€åƒåœ¾æˆ¿

ç³»ç»Ÿæƒé™ç®¡ç†ï¼š
ğŸ‘‘ ç³»ç»Ÿç®¡ç†å‘˜     â†’ æ‰€æœ‰åŠŸèƒ½ã€æ‰€æœ‰æ•°æ®
ğŸ‘¨â€ğŸ’¼ éƒ¨é—¨ä¸»ç®¡      â†’ éƒ¨é—¨æ•°æ®ã€å®¡æ‰¹åŠŸèƒ½
ğŸ‘©â€ğŸ’» æ™®é€šç”¨æˆ·      â†’ ä¸ªäººæ•°æ®ã€åŸºç¡€åŠŸèƒ½
ğŸ¤– ç³»ç»ŸæœåŠ¡      â†’ ç‰¹å®šæ¥å£ã€æ—¥å¿—è®°å½•
```

### 1.3 è®¿é—®æ§åˆ¶çš„å‘å±•å†ç¨‹


```
æ—¶é—´çº¿ï¼šæ—©æœŸ â†’ ç°åœ¨ â†’ æœªæ¥

æ—©æœŸé˜¶æ®µï¼š
ğŸ“ ç”¨æˆ·åå¯†ç     â†’ ç®€å•èº«ä»½éªŒè¯
ğŸ“‹ æƒé™åˆ—è¡¨      â†’ ç›´æ¥ç”¨æˆ·-æƒé™å¯¹åº”

å‘å±•é˜¶æ®µï¼š  
ğŸ­ è§’è‰²ç®¡ç†      â†’ RBACè§’è‰²æ¦‚å¿µ
ğŸ“Š å±æ€§æ§åˆ¶      â†’ ABACåŠ¨æ€åˆ¤æ–­

ç°ä»£é˜¶æ®µï¼š
ğŸ¤– æ™ºèƒ½åˆ†æ      â†’ AIè¾…åŠ©æƒé™å†³ç­–
ğŸ”„ é›¶ä¿¡ä»»æ¨¡å‹    â†’ æŒç»­éªŒè¯è®¿é—®
```

---

## 2. ğŸ“‹ ACLè®¿é—®æ§åˆ¶åˆ—è¡¨


### 2.1 ACLæ ¸å¿ƒæ¦‚å¿µ


> ğŸ’¡ **ACLå®šä¹‰**ï¼šAccess Control Listï¼Œä¸ºæ¯ä¸ªèµ„æºç»´æŠ¤ä¸€ä¸ªæƒé™åˆ—è¡¨ï¼Œæ˜ç¡®è®°å½•"è°å¯ä»¥å¯¹è¿™ä¸ªèµ„æºåšä»€ä¹ˆ"

**é€šä¿—ç†è§£**ï¼šå°±åƒæ¯ä¸ªæˆ¿é—´é—¨ä¸Šè´´ä¸€å¼ çº¸æ¡ï¼Œå†™æ˜å“ªäº›äººå¯ä»¥è¿›å…¥ï¼Œèƒ½åšä»€ä¹ˆäº‹ã€‚

```
æ–‡ä»¶ç³»ç»Ÿä¸­çš„ACLç¤ºä¾‹ï¼š

/home/documents/project.doc
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è®¿é—®æ§åˆ¶åˆ—è¡¨(ACL)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¼ ä¸‰ï¼šè¯»å–ã€ä¿®æ”¹          â”‚
â”‚ æå››ï¼šè¯»å–               â”‚
â”‚ ç®¡ç†å‘˜ï¼šå…¨éƒ¨æƒé™          â”‚
â”‚ å…¶ä»–ç”¨æˆ·ï¼šæ— æƒé™          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ACLçš„ç»“æ„ç»„æˆ


**åŸºæœ¬ç»“æ„**ï¼š
```
ACLæ¡ç›® = (ä¸»ä½“, æƒé™, å…è®¸/æ‹’ç»)

å®é™…ç¤ºä¾‹ï¼š
Resource: /api/user/profile
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ACL Entry 1             â”‚
â”‚ Subject: user_123       â”‚
â”‚ Permission: READ, WRITE â”‚  
â”‚ Type: ALLOW             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ACL Entry 2             â”‚
â”‚ Subject: guest_*        â”‚
â”‚ Permission: READ        â”‚
â”‚ Type: DENY              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»£ç å®ç°ç¤ºä¾‹**ï¼š
```javascript
// ACLç»“æ„å®šä¹‰
class ACLEntry {
  constructor(subject, resource, permissions, type = 'ALLOW') {
    this.subject = subject;        // ä¸»ä½“ï¼šuser_123
    this.resource = resource;      // èµ„æºï¼š/api/data
    this.permissions = permissions; // æƒé™ï¼š['READ', 'WRITE']
    this.type = type;              // ç±»å‹ï¼šALLOW/DENY
  }
}

// ACLç®¡ç†å™¨
class ACLManager {
  constructor() {
    this.entries = [];
  }
  
  // æ·»åŠ æƒé™æ¡ç›®
  addEntry(subject, resource, permissions, type = 'ALLOW') {
    this.entries.push(new ACLEntry(subject, resource, permissions, type));
  }
  
  // æ£€æŸ¥æƒé™
  checkPermission(subject, resource, permission) {
    const entry = this.entries.find(e => 
      e.subject === subject && e.resource === resource
    );
    
    if (!entry) return false;
    return entry.permissions.includes(permission) && entry.type === 'ALLOW';
  }
}
```

### 2.3 ACLçš„ä¼˜ç¼ºç‚¹


**âœ… ä¼˜ç‚¹**ï¼š
- **ç›´è§‚æ˜ç¡®**ï¼šæ¯ä¸ªèµ„æºçš„æƒé™ä¸€ç›®äº†ç„¶
- **ç²¾ç»†æ§åˆ¶**ï¼šå¯ä»¥ç²¾ç¡®åˆ°å•ä¸ªèµ„æºçš„å•ä¸ªæƒé™
- **çµæ´»æ€§é«˜**ï¼šå¯ä»¥ä¸ºä¸åŒèµ„æºè®¾ç½®ä¸åŒè§„åˆ™

**âŒ ç¼ºç‚¹**ï¼š
- **ç®¡ç†å¤æ‚**ï¼šèµ„æºå¤šæ—¶æƒé™æ¡ç›®çˆ†ç‚¸å¼å¢é•¿
- **ç»´æŠ¤å›°éš¾**ï¼šç”¨æˆ·å˜åŠ¨æ—¶éœ€è¦ä¿®æ”¹å¤§é‡ACLæ¡ç›®
- **æ€§èƒ½é—®é¢˜**ï¼šæ¯æ¬¡è®¿é—®éƒ½è¦éå†æƒé™åˆ—è¡¨

**é€‚ç”¨åœºæ™¯**ï¼š
```
âœ… é€‚åˆåœºæ™¯ï¼š
â€¢ æ–‡ä»¶ç³»ç»Ÿæƒé™ç®¡ç†
â€¢ æ•°æ®åº“è¡¨çº§æƒé™æ§åˆ¶  
â€¢ APIæ¥å£ç»†ç²’åº¦æƒé™
â€¢ å°è§„æ¨¡ç”¨æˆ·ç³»ç»Ÿ

âŒ ä¸é€‚åˆåœºæ™¯ï¼š
â€¢ å¤§é‡ç”¨æˆ·çš„å¤æ‚ç³»ç»Ÿ
â€¢ é¢‘ç¹å˜åŒ–çš„ç»„ç»‡æ¶æ„
â€¢ éœ€è¦æ‰¹é‡æƒé™ç®¡ç†çš„åœºæ™¯
```

### 2.4 åŠ¨æ€èµ„æºæƒé™æ§åˆ¶


**ä»€ä¹ˆæ˜¯åŠ¨æ€èµ„æº**ï¼š
```
é™æ€èµ„æºï¼š/api/users (å›ºå®šçš„APIæ¥å£)
åŠ¨æ€èµ„æºï¼š/api/users/123 (åŒ…å«å˜é‡çš„èµ„æº)
         /documents/project_*/files
         /orders/{order_id}/details
```

**åŠ¨æ€ACLå®ç°**ï¼š
```javascript
class DynamicACL {
  constructor() {
    this.patterns = []; // å­˜å‚¨æƒé™æ¨¡å¼
  }
  
  // æ·»åŠ åŠ¨æ€æƒé™è§„åˆ™
  addPattern(subjectPattern, resourcePattern, permissions) {
    this.patterns.push({
      subjectPattern,   // å¦‚ï¼šuser_*
      resourcePattern,  // å¦‚ï¼š/api/users/{user_id}
      permissions
    });
  }
  
  // æ£€æŸ¥åŠ¨æ€æƒé™
  checkDynamicPermission(subject, resource, permission) {
    for (let pattern of this.patterns) {
      if (this.matchPattern(subject, pattern.subjectPattern) &&
          this.matchPattern(resource, pattern.resourcePattern)) {
        return pattern.permissions.includes(permission);
      }
    }
    return false;
  }
  
  // æ¨¡å¼åŒ¹é…é€»è¾‘
  matchPattern(value, pattern) {
    // ç®€å•é€šé…ç¬¦åŒ¹é…
    const regex = pattern.replace(/\*/g, '.*').replace(/\{[^}]+\}/g, '[^/]+');
    return new RegExp(`^${regex}$`).test(value);
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const dynamicACL = new DynamicACL();

// ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®
dynamicACL.addPattern(
  'user_{id}',           // ä¸»ä½“æ¨¡å¼
  '/api/users/{id}/*',   // èµ„æºæ¨¡å¼  
  ['READ', 'WRITE']      // å…è®¸çš„æƒé™
);
```

---

## 3. ğŸ­ RBACåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶


### 3.1 RBACæ ¸å¿ƒç†å¿µ


> ğŸ’¡ **RBACå®šä¹‰**ï¼šRole-Based Access Controlï¼Œé€šè¿‡è§’è‰²ä½œä¸ºä¸­ä»‹ï¼Œå°†ç”¨æˆ·å’Œæƒé™åˆ†ç¦»ï¼Œç”¨æˆ·è¢«åˆ†é…è§’è‰²ï¼Œè§’è‰²æ‹¥æœ‰æƒé™

**é€šä¿—ç†è§£**ï¼šå°±åƒèŒä½åˆ¶åº¦ï¼Œä¸åŒèŒä½æœ‰ä¸åŒèŒè´£æƒé™ï¼Œå‘˜å·¥æ ¹æ®èŒä½è·å¾—ç›¸åº”æƒé™ã€‚

```
ä¼ ç»Ÿç›´æ¥æˆæƒæ¨¡å¼ï¼š
ğŸ‘¤ç”¨æˆ·1 â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â†’ ğŸ“„æƒé™A
ğŸ‘¤ç”¨æˆ·2 â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â†’ ğŸ“„æƒé™B  
ğŸ‘¤ç”¨æˆ·3 â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â†’ ğŸ“„æƒé™C
é—®é¢˜ï¼šæƒé™ç®¡ç†æ··ä¹±ï¼Œéš¾ä»¥ç»´æŠ¤

RBACè§’è‰²æˆæƒæ¨¡å¼ï¼š
ğŸ‘¤ç”¨æˆ· â€”â€”â†’ ğŸ­è§’è‰² â€”â€”â†’ ğŸ“„æƒé™
       åˆ†é…     æ‹¥æœ‰

å®é™…ç¤ºä¾‹ï¼š
ğŸ‘¤å¼ ä¸‰ â€”â€”â†’ ğŸ­é”€å”®å‘˜ â€”â€”â†’ ğŸ“„æŸ¥çœ‹å®¢æˆ·ã€åˆ›å»ºè®¢å•
ğŸ‘¤æå›› â€”â€”â†’ ğŸ­ç»ç†   â€”â€”â†’ ğŸ“„å®¡æ‰¹è®¢å•ã€æŸ¥çœ‹æŠ¥è¡¨
ğŸ‘¤ç‹äº” â€”â€”â†’ ğŸ­ç®¡ç†å‘˜ â€”â€”â†’ ğŸ“„ç³»ç»Ÿé…ç½®ã€ç”¨æˆ·ç®¡ç†
```

### 3.2 RBACæ¨¡å‹å±‚æ¬¡


**RBAC0 - åŸºç¡€æ¨¡å‹**ï¼š
```
åŸºæœ¬è¦ç´ ï¼š
ğŸ‘¤ ç”¨æˆ·(Users)     - ç³»ç»Ÿä¸­çš„æ“ä½œä¸»ä½“
ğŸ­ è§’è‰²(Roles)     - æƒé™çš„é›†åˆ
ğŸ“„ æƒé™(Permissions) - å¯¹èµ„æºçš„æ“ä½œè®¸å¯
ğŸ”— å…³ç³»(Relations)  - ç”¨æˆ·-è§’è‰²ã€è§’è‰²-æƒé™çš„æ˜ å°„

æ ¸å¿ƒå…³ç³»ï¼š
ç”¨æˆ· â†â†’ è§’è‰² (å¤šå¯¹å¤š)
è§’è‰² â†â†’ æƒé™ (å¤šå¯¹å¤š)
```

**RBAC1 - è§’è‰²å±‚æ¬¡æ¨¡å‹**ï¼š
```
è§’è‰²ç»§æ‰¿å…³ç³»ï¼š
       ğŸ‘‘ ç³»ç»Ÿç®¡ç†å‘˜
           â†“ ç»§æ‰¿
       ğŸ‘¨â€ğŸ’¼ éƒ¨é—¨ç»ç†  
           â†“ ç»§æ‰¿
       ğŸ‘©â€ğŸ’» æ™®é€šå‘˜å·¥

ç»§æ‰¿è§„åˆ™ï¼šä¸Šçº§è§’è‰²è‡ªåŠ¨æ‹¥æœ‰ä¸‹çº§è§’è‰²çš„æ‰€æœ‰æƒé™
```

### 3.3 RBACå®ç°ç¤ºä¾‹


```javascript
// RBACæƒé™ç®¡ç†ç³»ç»Ÿ
class RBACManager {
  constructor() {
    this.users = new Map();      // ç”¨æˆ·ä¿¡æ¯
    this.roles = new Map();      // è§’è‰²ä¿¡æ¯  
    this.permissions = new Map(); // æƒé™ä¿¡æ¯
    this.userRoles = new Map();   // ç”¨æˆ·-è§’è‰²å…³ç³»
    this.rolePermissions = new Map(); // è§’è‰²-æƒé™å…³ç³»
  }
  
  // åˆ›å»ºè§’è‰²
  createRole(roleId, roleName, description) {
    this.roles.set(roleId, {
      id: roleId,
      name: roleName,
      description: description,
      permissions: new Set()
    });
  }
  
  // åˆ†é…è§’è‰²ç»™ç”¨æˆ·
  assignRole(userId, roleId) {
    if (!this.userRoles.has(userId)) {
      this.userRoles.set(userId, new Set());
    }
    this.userRoles.get(userId).add(roleId);
  }
  
  // ç»™è§’è‰²åˆ†é…æƒé™
  grantPermission(roleId, permission) {
    if (!this.rolePermissions.has(roleId)) {
      this.rolePermissions.set(roleId, new Set());
    }
    this.rolePermissions.get(roleId).add(permission);
  }
  
  // æ£€æŸ¥ç”¨æˆ·æƒé™
  hasPermission(userId, permission) {
    const userRoles = this.userRoles.get(userId);
    if (!userRoles) return false;
    
    for (let roleId of userRoles) {
      const rolePermissions = this.rolePermissions.get(roleId);
      if (rolePermissions && rolePermissions.has(permission)) {
        return true;
      }
    }
    return false;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const rbac = new RBACManager();

// åˆ›å»ºè§’è‰²
rbac.createRole('admin', 'ç®¡ç†å‘˜', 'ç³»ç»Ÿç®¡ç†å‘˜è§’è‰²');
rbac.createRole('editor', 'ç¼–è¾‘å‘˜', 'å†…å®¹ç¼–è¾‘è§’è‰²');
rbac.createRole('viewer', 'æŸ¥çœ‹å‘˜', 'åªè¯»æƒé™è§’è‰²');

// åˆ†é…æƒé™ç»™è§’è‰²
rbac.grantPermission('admin', 'system:manage');
rbac.grantPermission('admin', 'user:create');
rbac.grantPermission('editor', 'content:edit');
rbac.grantPermission('viewer', 'content:read');

// åˆ†é…è§’è‰²ç»™ç”¨æˆ·
rbac.assignRole('user_001', 'admin');
rbac.assignRole('user_002', 'editor');

// æƒé™æ£€æŸ¥
console.log(rbac.hasPermission('user_001', 'system:manage')); // true
console.log(rbac.hasPermission('user_002', 'system:manage')); // false
```

---

## 4. ğŸ¯ ABACåŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶


### 4.1 ABACæ ¸å¿ƒæ¦‚å¿µ


> ğŸ’¡ **ABACå®šä¹‰**ï¼šAttribute-Based Access Controlï¼ŒåŸºäºä¸»ä½“ã€å®¢ä½“ã€ç¯å¢ƒç­‰å¤šç»´å±æ€§æ¥åŠ¨æ€å†³ç­–è®¿é—®æƒé™

**é€šä¿—ç†è§£**ï¼šå°±åƒä¸€ä¸ªæ™ºèƒ½é—¨ç¦ç³»ç»Ÿï¼Œä¸ä»…çœ‹ä½ çš„èº«ä»½å¡ï¼Œè¿˜è¦çœ‹æ—¶é—´ã€åœ°ç‚¹ã€å¤©æ°”ç­‰å„ç§æ¡ä»¶æ¥å†³å®šæ˜¯å¦æ”¾è¡Œã€‚

```
RBAC vs ABAC çš„åŒºåˆ«ï¼š

RBAC (è§’è‰²é©±åŠ¨)ï¼š
ğŸ‘¤ å¼ ä¸‰ â†’ ğŸ­ é”€å”®å‘˜ â†’ ğŸ“„ æŸ¥çœ‹å®¢æˆ·ä¿¡æ¯
å›ºå®šè§„åˆ™ï¼ŒåŸºäºè§’è‰²å†³ç­–

ABAC (å±æ€§é©±åŠ¨)ï¼š
ğŸ‘¤ å¼ ä¸‰ (éƒ¨é—¨=é”€å”®, çº§åˆ«=é«˜çº§, åœ°ç‚¹=åŒ—äº¬)
ğŸ“ å®¢æˆ·èµ„æ–™ (æœºå¯†çº§åˆ«=æ™®é€š, åœ°åŒº=ååŒ—)  
ğŸŒ ç¯å¢ƒ (æ—¶é—´=å·¥ä½œæ—¥, IP=å…¬å¸ç½‘ç»œ)
âš–ï¸ åŠ¨æ€å†³ç­–ï¼šå…è®¸è®¿é—®

å†³ç­–è¿‡ç¨‹æ›´å¤æ‚ä½†æ›´çµæ´»ï¼
```

### 4.2 ABACå±æ€§ç±»å‹


**å››ç±»æ ¸å¿ƒå±æ€§**ï¼š

```
ğŸ§‘ ä¸»ä½“å±æ€§ (Subject Attributes)
â€¢ ç”¨æˆ·IDã€å§“åã€éƒ¨é—¨
â€¢ èŒä½çº§åˆ«ã€å®‰å…¨ç­‰çº§  
â€¢ å·¥ä½œç»éªŒã€è®¤è¯çŠ¶æ€

ğŸ“ å®¢ä½“å±æ€§ (Object Attributes)  
â€¢ èµ„æºç±»å‹ã€æ•æ„Ÿçº§åˆ«
â€¢ åˆ›å»ºè€…ã€ä¿®æ”¹æ—¶é—´
â€¢ æ–‡ä»¶å¤§å°ã€å­˜å‚¨ä½ç½®

ğŸŒ ç¯å¢ƒå±æ€§ (Environment Attributes)
â€¢ è®¿é—®æ—¶é—´ã€åœ°ç†ä½ç½®
â€¢ ç½‘ç»œç±»å‹ã€è®¾å¤‡ä¿¡æ¯
â€¢ å®‰å…¨å¨èƒçº§åˆ«

âš¡ æ“ä½œå±æ€§ (Action Attributes)
â€¢ æ“ä½œç±»å‹ (è¯»/å†™/åˆ )
â€¢ æ‰¹é‡æ“ä½œæ ‡è¯†
â€¢ ç´§æ€¥ç¨‹åº¦
```

### 4.3 ABACç­–ç•¥å¼•æ“


**ç­–ç•¥è§„åˆ™ç¤ºä¾‹**ï¼š
```javascript
// ABACç­–ç•¥è§„åˆ™å®šä¹‰
const abacPolicies = [
  {
    id: 'policy_001',
    name: 'å·¥ä½œæ—¶é—´è®¿é—®è§„åˆ™',
    rule: `
      subject.department === 'IT' AND
      object.confidential_level <= subject.clearance_level AND
      environment.time >= '09:00' AND environment.time <= '18:00' AND
      environment.network === 'company_network'
    `,
    effect: 'ALLOW'
  },
  
  {
    id: 'policy_002', 
    name: 'è·¨éƒ¨é—¨æ•°æ®è®¿é—®',
    rule: `
      subject.level >= 'manager' AND
      object.owner_department !== subject.department AND
      action.type === 'READ'
    `,
    effect: 'ALLOW'
  }
];

// ABACå†³ç­–å¼•æ“
class ABACEngine {
  constructor(policies) {
    this.policies = policies;
  }
  
  // è®¿é—®æ§åˆ¶å†³ç­–
  evaluate(subject, object, environment, action) {
    const context = { subject, object, environment, action };
    
    for (let policy of this.policies) {
      if (this.evaluateRule(policy.rule, context)) {
        return policy.effect === 'ALLOW';
      }
    }
    
    return false; // é»˜è®¤æ‹’ç»
  }
  
  // è§„åˆ™è¯„ä¼° (ç®€åŒ–ç‰ˆæœ¬)
  evaluateRule(rule, context) {
    // å®é™…åœºæ™¯ä¸­ä¼šç”¨ä¸“ä¸šçš„è§„åˆ™å¼•æ“
    try {
      // å°†è§„åˆ™è½¬æ¢ä¸ºå¯æ‰§è¡Œä»£ç å¹¶æ±‚å€¼
      return this.parseAndEvaluate(rule, context);
    } catch (error) {
      console.error('è§„åˆ™è¯„ä¼°é”™è¯¯:', error);
      return false;
    }
  }
}
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```javascript
// åˆ›å»ºABACå¼•æ“
const abacEngine = new ABACEngine(abacPolicies);

// å®šä¹‰è®¿é—®ä¸Šä¸‹æ–‡
const accessRequest = {
  subject: {
    id: 'user_123',
    department: 'IT',
    level: 'senior',
    clearance_level: 3
  },
  object: {
    id: 'document_456',
    type: 'report',
    confidential_level: 2,
    owner_department: 'Finance'
  },
  environment: {
    time: '14:30',
    network: 'company_network',
    location: 'beijing_office'
  },
  action: {
    type: 'read'
  }
};

// æƒé™å†³ç­–
const allowed = abacEngine.evaluate(
  accessRequest.subject,
  accessRequest.object, 
  accessRequest.environment,
  accessRequest.action
);

console.log('è®¿é—®æƒé™:', allowed ? 'å…è®¸' : 'æ‹’ç»');
```

---

## 5. ğŸ”’ MACå¼ºåˆ¶è®¿é—®æ§åˆ¶


### 5.1 MACæ ¸å¿ƒç†å¿µ


> ğŸ’¡ **MACå®šä¹‰**ï¼šMandatory Access Controlï¼Œç”±ç³»ç»Ÿå¼ºåˆ¶æ‰§è¡Œçš„è®¿é—®æ§åˆ¶ï¼Œç”¨æˆ·æ— æ³•è‡ªä¸»ä¿®æ”¹æƒé™è®¾ç½®

**é€šä¿—ç†è§£**ï¼šå°±åƒå†›é˜Ÿçš„ä¿å¯†åˆ¶åº¦ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½æœ‰å¯†çº§ï¼ˆç»å¯†ã€æœºå¯†ã€ç§˜å¯†ï¼‰ï¼Œæ¯ä¸ªäººéƒ½æœ‰æƒé™çº§åˆ«ï¼Œä½çº§åˆ«çš„äººç»å¯¹ä¸èƒ½çœ‹é«˜çº§åˆ«çš„æ–‡ä»¶ï¼Œè¿™æ˜¯ç¡¬è§„å®šï¼Œä¸èƒ½å˜é€šã€‚

```
ç”Ÿæ´»ä¸­çš„MACä¾‹å­ï¼š

ğŸ›ï¸ æ”¿åºœæœºå¯†ç³»ç»Ÿï¼š
ğŸ“„ ç»å¯†æ–‡ä»¶ â† åªæœ‰å‰¯éƒ¨çº§ä»¥ä¸Šæ‰èƒ½çœ‹
ğŸ“„ æœºå¯†æ–‡ä»¶ â† å¤„çº§ä»¥ä¸Šå¯ä»¥çœ‹  
ğŸ“„ å†…éƒ¨æ–‡ä»¶ â† ç§‘çº§ä»¥ä¸Šå¯ä»¥çœ‹
ğŸ“„ å…¬å¼€æ–‡ä»¶ â† æ‰€æœ‰äººéƒ½èƒ½çœ‹

ç‰¹ç‚¹ï¼š
â€¢ ç³»ç»Ÿä¸¥æ ¼æ§åˆ¶ï¼Œä¸ªäººæ— æ³•æ›´æ”¹
â€¢ çº§åˆ«é«˜çš„å¯ä»¥çœ‹çº§åˆ«ä½çš„
â€¢ çº§åˆ«ä½çš„ç»å¯¹ä¸èƒ½çœ‹çº§åˆ«é«˜çš„
```

### 5.2 MACå®‰å…¨æ¨¡å‹


**Bell-LaPadulaæ¨¡å‹** (ä¿å¯†æ€§å¯¼å‘)ï¼š
```
æ ¸å¿ƒè§„åˆ™ï¼š

ğŸ“– Simple Security (ç®€å•å®‰å…¨æ€§)ï¼š
   ä¸»ä½“åªèƒ½è¯»å– â‰¤ è‡ªå·±å®‰å…¨çº§åˆ«çš„å®¢ä½“
   
âœï¸ *-Property (æ˜Ÿå·å±æ€§)ï¼š  
   ä¸»ä½“åªèƒ½å†™å…¥ â‰¥ è‡ªå·±å®‰å…¨çº§åˆ«çš„å®¢ä½“

å®é™…å«ä¹‰ï¼š
ğŸ”´ æœºå¯†çº§ç”¨æˆ· åªèƒ½ï¼š
   â€¢ è¯»å–ï¼šå…¬å¼€ã€å†…éƒ¨ã€æœºå¯†çº§åˆ«æ–‡ä»¶  
   â€¢ å†™å…¥ï¼šæœºå¯†ã€ç»å¯†çº§åˆ«æ–‡ä»¶
   
é˜²æ­¢ï¼šä¿¡æ¯å‘ä¸‹æ³„éœ² (é«˜å¯†çº§â†’ä½å¯†çº§)
```

**Bibaæ¨¡å‹** (å®Œæ•´æ€§å¯¼å‘)ï¼š
```
æ ¸å¿ƒè§„åˆ™ï¼š

ğŸ“– Simple Integrityï¼š
   ä¸»ä½“åªèƒ½è¯»å– â‰¥ è‡ªå·±å®Œæ•´æ€§çº§åˆ«çš„å®¢ä½“
   
âœï¸ *-Integrity Propertyï¼š
   ä¸»ä½“åªèƒ½å†™å…¥ â‰¤ è‡ªå·±å®Œæ•´æ€§çº§åˆ«çš„å®¢ä½“
   
é˜²æ­¢ï¼šä¿¡æ¯æ±¡æŸ“ (ä½å¯ä¿¡â†’é«˜å¯ä¿¡)
```

### 5.3 MACå®ç°ç¤ºä¾‹


```javascript
// MACå®‰å…¨çº§åˆ«å®šä¹‰
const SecurityLevels = {
  PUBLIC: 0,      // å…¬å¼€
  INTERNAL: 1,    // å†…éƒ¨  
  CONFIDENTIAL: 2, // æœºå¯†
  SECRET: 3,      // ç§˜å¯†
  TOP_SECRET: 4   // ç»å¯†
};

// MACè®¿é—®æ§åˆ¶å™¨
class MACController {
  constructor() {
    this.subjects = new Map(); // ä¸»ä½“åŠå…¶å®‰å…¨çº§åˆ«
    this.objects = new Map();  // å®¢ä½“åŠå…¶å®‰å…¨çº§åˆ«
  }
  
  // è®¾ç½®ä¸»ä½“å®‰å…¨çº§åˆ«
  setSubjectLevel(subjectId, level) {
    this.subjects.set(subjectId, level);
  }
  
  // è®¾ç½®å®¢ä½“å®‰å…¨çº§åˆ«  
  setObjectLevel(objectId, level) {
    this.objects.set(objectId, level);
  }
  
  // æ£€æŸ¥è¯»å–æƒé™ (Bell-LaPadula: ä¸èƒ½è¯»å–é«˜äºè‡ªå·±çº§åˆ«çš„)
  canRead(subjectId, objectId) {
    const subjectLevel = this.subjects.get(subjectId);
    const objectLevel = this.objects.get(objectId);
    
    if (subjectLevel === undefined || objectLevel === undefined) {
      return false;
    }
    
    return subjectLevel >= objectLevel; // ä¸»ä½“çº§åˆ« â‰¥ å®¢ä½“çº§åˆ«
  }
  
  // æ£€æŸ¥å†™å…¥æƒé™ (Bell-LaPadula: ä¸èƒ½å†™å…¥ä½äºè‡ªå·±çº§åˆ«çš„)
  canWrite(subjectId, objectId) {
    const subjectLevel = this.subjects.get(subjectId);
    const objectLevel = this.objects.get(objectId);
    
    if (subjectLevel === undefined || objectLevel === undefined) {
      return false;
    }
    
    return subjectLevel <= objectLevel; // ä¸»ä½“çº§åˆ« â‰¤ å®¢ä½“çº§åˆ«
  }
  
  // ç»¼åˆè®¿é—®æ£€æŸ¥
  checkAccess(subjectId, objectId, operation) {
    switch (operation.toLowerCase()) {
      case 'read':
        return this.canRead(subjectId, objectId);
      case 'write':
        return this.canWrite(subjectId, objectId);
      default:
        return false;
    }
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const mac = new MACController();

// è®¾ç½®ç”¨æˆ·å®‰å…¨çº§åˆ«
mac.setSubjectLevel('analyst', SecurityLevels.CONFIDENTIAL);
mac.setSubjectLevel('manager', SecurityLevels.SECRET);
mac.setSubjectLevel('director', SecurityLevels.TOP_SECRET);

// è®¾ç½®æ–‡æ¡£å®‰å…¨çº§åˆ«
mac.setObjectLevel('public_report', SecurityLevels.PUBLIC);
mac.setObjectLevel('budget_plan', SecurityLevels.CONFIDENTIAL);
mac.setObjectLevel('strategy_doc', SecurityLevels.SECRET);

// æƒé™æµ‹è¯•
console.log('åˆ†æå¸ˆèƒ½è¯»é¢„ç®—è®¡åˆ’å—ï¼Ÿ', mac.canRead('analyst', 'budget_plan')); // true
console.log('åˆ†æå¸ˆèƒ½è¯»æˆ˜ç•¥æ–‡æ¡£å—ï¼Ÿ', mac.canRead('analyst', 'strategy_doc')); // false
console.log('ç»ç†èƒ½å†™å…¬å¼€æŠ¥å‘Šå—ï¼Ÿ', mac.canWrite('manager', 'public_report')); // false
```

---

## 6. ğŸ”“ DACè‡ªä¸»è®¿é—®æ§åˆ¶


### 6.1 DACæ ¸å¿ƒç†å¿µ


> ğŸ’¡ **DACå®šä¹‰**ï¼šDiscretionary Access Controlï¼Œèµ„æºçš„æ‹¥æœ‰è€…å¯ä»¥è‡ªä¸»å†³å®šè°èƒ½è®¿é—®è‡ªå·±çš„èµ„æº

**é€šä¿—ç†è§£**ï¼šå°±åƒä½ çš„ä¸ªäººæ–‡ä»¶å¤¹ï¼Œä½ å¯ä»¥å†³å®šåˆ†äº«ç»™è°ï¼Œç»™ä»€ä¹ˆæƒé™ï¼Œå®Œå…¨ç”±ä½ è‡ªå·±åšä¸»ã€‚

```
ç”Ÿæ´»ä¸­çš„DACä¾‹å­ï¼š

ğŸ“± å¾®ä¿¡æœ‹å‹åœˆï¼š
ğŸ‘¤ ä½  â†’ å‘å¸ƒåŠ¨æ€ï¼Œå¯ä»¥è®¾ç½®ï¼š
      â€¢ å…¬å¼€ (æ‰€æœ‰äººå¯è§)  
      â€¢ ä»…æœ‹å‹å¯è§
      â€¢ éƒ¨åˆ†æœ‹å‹å¯è§
      â€¢ ä»…è‡ªå·±å¯è§
      
ğŸ’» æ–‡ä»¶å…±äº«ï¼š
ğŸ‘¤ ä½  â†’ ä¸Šä¼ æ–‡ä»¶åˆ°ç½‘ç›˜ï¼Œå¯ä»¥ï¼š
      â€¢ è®¾ç½®åˆ†äº«é“¾æ¥
      â€¢ è®¾ç½®è®¿é—®å¯†ç 
      â€¢ è®¾ç½®è¿‡æœŸæ—¶é—´
      â€¢ é€‰æ‹©å¯ç¼–è¾‘/åªè¯»æƒé™

ç‰¹ç‚¹ï¼šä½ æ˜¯ä¸»äººï¼Œä½ è¯´äº†ç®—ï¼
```

### 6.2 DACæƒé™ç®¡ç†


**æƒé™çŸ©é˜µæ¨¡å‹**ï¼š
```
        æ–‡ä»¶A   æ–‡ä»¶B   æ–‡ä»¶C   æ–‡ä»¶D
ç”¨æˆ·1    RW      R       -       RW
ç”¨æˆ·2    R       RW      W       -  
ç”¨æˆ·3    -       R       RW      R

å…¶ä¸­ï¼šR=è¯»å–, W=å†™å…¥, -=æ— æƒé™
æ¯ä¸ªèµ„æºçš„æ‰€æœ‰è€…å¯ä»¥ä¿®æ”¹å¯¹åº”åˆ—çš„æƒé™è®¾ç½®
```

**å®ç°ç¤ºä¾‹**ï¼š
```javascript
// DACæƒé™ç®¡ç†ç³»ç»Ÿ
class DACController {
  constructor() {
    this.resources = new Map(); // èµ„æºä¿¡æ¯
    this.permissions = new Map(); // æƒé™çŸ©é˜µ
  }
  
  // åˆ›å»ºèµ„æº(è‡ªåŠ¨æˆä¸ºæ‹¥æœ‰è€…)
  createResource(resourceId, ownerId, resourceData) {
    this.resources.set(resourceId, {
      id: resourceId,
      owner: ownerId,
      data: resourceData,
      created: new Date()
    });
    
    // æ‹¥æœ‰è€…é»˜è®¤æ‹¥æœ‰æ‰€æœ‰æƒé™
    this.setPermission(resourceId, ownerId, ['read', 'write', 'delete', 'grant']);
  }
  
  // è®¾ç½®æƒé™ (åªæœ‰æ‹¥æœ‰è€…æˆ–æœ‰grantæƒé™çš„ç”¨æˆ·å¯ä»¥è®¾ç½®)
  setPermission(resourceId, userId, permissions, grantor) {
    const resource = this.resources.get(resourceId);
    if (!resource) return false;
    
    // æ£€æŸ¥è®¾ç½®æƒé™çš„æƒé™
    if (grantor && grantor !== resource.owner && 
        !this.hasPermission(resourceId, grantor, 'grant')) {
      throw new Error('æ²¡æœ‰æƒé™è®¾ç½®å…¶ä»–ç”¨æˆ·çš„æƒé™');
    }
    
    const key = `${resourceId}:${userId}`;
    this.permissions.set(key, new Set(permissions));
    return true;
  }
  
  // æ£€æŸ¥æƒé™
  hasPermission(resourceId, userId, permission) {
    const key = `${resourceId}:${userId}`;
    const userPermissions = this.permissions.get(key);
    return userPermissions && userPermissions.has(permission);
  }
  
  // èµ„æºæ‹¥æœ‰è€…å¯ä»¥è½¬è®©æ‰€æœ‰æƒ
  transferOwnership(resourceId, currentOwner, newOwner) {
    const resource = this.resources.get(resourceId);
    if (!resource || resource.owner !== currentOwner) {
      throw new Error('åªæœ‰æ‹¥æœ‰è€…å¯ä»¥è½¬è®©æ‰€æœ‰æƒ');
    }
    
    resource.owner = newOwner;
    // æ–°æ‹¥æœ‰è€…è·å¾—æ‰€æœ‰æƒé™
    this.setPermission(resourceId, newOwner, ['read', 'write', 'delete', 'grant']);
  }
  
  // è·å–èµ„æºæƒé™åˆ—è¡¨ (åªæœ‰æ‹¥æœ‰è€…å¯ä»¥æŸ¥çœ‹)
  getResourcePermissions(resourceId, requester) {
    const resource = this.resources.get(resourceId);
    if (!resource || resource.owner !== requester) {
      throw new Error('åªæœ‰æ‹¥æœ‰è€…å¯ä»¥æŸ¥çœ‹æƒé™åˆ—è¡¨');
    }
    
    const resourcePermissions = {};
    for (let [key, permissions] of this.permissions) {
      const [resId, userId] = key.split(':');
      if (resId === resourceId) {
        resourcePermissions[userId] = Array.from(permissions);
      }
    }
    return resourcePermissions;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const dac = new DACController();

// ç”¨æˆ·1åˆ›å»ºæ–‡æ¡£
dac.createResource('doc_001', 'user_001', { title: 'é¡¹ç›®è®¡åˆ’', content: '...' });

// ç”¨æˆ·1åˆ†äº«ç»™ç”¨æˆ·2è¯»æƒé™
dac.setPermission('doc_001', 'user_002', ['read'], 'user_001');

// ç”¨æˆ·1åˆ†äº«ç»™ç”¨æˆ·3è¯»å†™æƒé™
dac.setPermission('doc_001', 'user_003', ['read', 'write'], 'user_001');

// æƒé™æ£€æŸ¥
console.log('ç”¨æˆ·2èƒ½è¯»æ–‡æ¡£å—ï¼Ÿ', dac.hasPermission('doc_001', 'user_002', 'read')); // true
console.log('ç”¨æˆ·2èƒ½å†™æ–‡æ¡£å—ï¼Ÿ', dac.hasPermission('doc_001', 'user_002', 'write')); // false
console.log('ç”¨æˆ·3èƒ½å†™æ–‡æ¡£å—ï¼Ÿ', dac.hasPermission('doc_001', 'user_003', 'write')); // true
```

---

## 7. âš–ï¸ è®¿é—®æ§åˆ¶æ¨¡å‹å¯¹æ¯”


### 7.1 æ¨¡å‹ç‰¹ç‚¹å¯¹æ¯”è¡¨


| è®¿é—®æ§åˆ¶æ¨¡å‹ | **æ ¸å¿ƒç‰¹ç‚¹** | **å†³ç­–ä¾æ®** | **çµæ´»æ€§** | **å®‰å…¨æ€§** | **å¤æ‚åº¦** |
|------------|------------|------------|-----------|----------|-----------|
| ğŸ” **ACL** | `èµ„æºå¯¼å‘ï¼Œç›´æ¥æˆæƒ` | `æƒé™åˆ—è¡¨` | `é«˜` | `ä¸­` | `ä½` |
| ğŸ­ **RBAC** | `è§’è‰²ä¸­ä»‹ï¼Œé—´æ¥æˆæƒ` | `ç”¨æˆ·è§’è‰²` | `ä¸­` | `ä¸­` | `ä¸­` |
| ğŸ¯ **ABAC** | `å±æ€§é©±åŠ¨ï¼ŒåŠ¨æ€å†³ç­–` | `å¤šç»´å±æ€§` | `æé«˜` | `é«˜` | `é«˜` |
| ğŸ”’ **MAC** | `ç³»ç»Ÿå¼ºåˆ¶ï¼Œå¤šçº§å®‰å…¨` | `å®‰å…¨æ ‡ç­¾` | `ä½` | `æé«˜` | `ä¸­` |
| ğŸ”“ **DAC** | `ç”¨æˆ·è‡ªä¸»ï¼Œçµæ´»åˆ†äº«` | `æ‰€æœ‰è€…æ„æ„¿` | `æé«˜` | `ä½` | `ä½` |

### 7.2 åº”ç”¨åœºæ™¯å¯¹æ¯”


```
ğŸ¢ ä¼ä¸šåŠå…¬ç³»ç»Ÿï¼š
â€¢ å°å…¬å¸ â†’ DAC (ç”¨æˆ·è‡ªä¸»åˆ†äº«æ–‡æ¡£)
â€¢ ä¸­å‹ä¼ä¸š â†’ RBAC (æŒ‰éƒ¨é—¨è§’è‰²ç®¡ç†)  
â€¢ å¤§å‹é›†å›¢ â†’ ABAC (å¤æ‚ä¸šåŠ¡è§„åˆ™)

ğŸ›ï¸ æ”¿åºœæœºå…³ç³»ç»Ÿï¼š
â€¢ æ¶‰å¯†ç³»ç»Ÿ â†’ MAC (ä¸¥æ ¼ç­‰çº§åˆ¶åº¦)
â€¢ å†…éƒ¨åŠå…¬ â†’ RBAC + ACL (è§’è‰²+ç»†ç²’åº¦)

ğŸ’° é‡‘èç³»ç»Ÿï¼š
â€¢ æ ¸å¿ƒç³»ç»Ÿ â†’ MAC (èµ„é‡‘å®‰å…¨ç¬¬ä¸€)
â€¢ ä¸šåŠ¡ç³»ç»Ÿ â†’ RBAC + ABAC (è§’è‰²+é£æ§è§„åˆ™)
â€¢ åŠå…¬ç³»ç»Ÿ â†’ DAC + RBAC (çµæ´»æ€§+ç®¡ç†)

ğŸŒ äº’è”ç½‘åº”ç”¨ï¼š
â€¢ ç¤¾äº¤å¹³å° â†’ DAC (ç”¨æˆ·æ§åˆ¶éšç§)
â€¢ ä¼ä¸šSaaS â†’ RBAC (æ ‡å‡†åŒ–æƒé™)  
â€¢ äº‘æœåŠ¡ â†’ ABAC (å¤æ‚è®¡è´¹å’Œæ§åˆ¶)
```

### 7.3 é€‰æ‹©å†³ç­–æ ‘


```
é€‰æ‹©è®¿é—®æ§åˆ¶æ¨¡å‹çš„å†³ç­–æµç¨‹ï¼š

å¼€å§‹é€‰æ‹©
    â†“
æ˜¯å¦éœ€è¦æœ€é«˜å®‰å…¨ç­‰çº§ï¼Ÿ 
    â†“ æ˜¯           â†“ å¦
   MAC           ç»§ç»­åˆ¤æ–­
                    â†“
              ç”¨æˆ·æ˜¯å¦éœ€è¦è‡ªä¸»æ§åˆ¶æƒé™ï¼Ÿ
                â†“ æ˜¯        â†“ å¦  
               DAC        ç»§ç»­åˆ¤æ–­
                            â†“
                    æ˜¯å¦æœ‰å¤æ‚çš„ä¸šåŠ¡è§„åˆ™ï¼Ÿ
                      â†“ æ˜¯      â†“ å¦
                     ABAC     ç»§ç»­åˆ¤æ–­  
                                â†“
                        ç»„ç»‡ç»“æ„æ˜¯å¦ç¨³å®šï¼Ÿ
                          â†“ æ˜¯    â†“ å¦
                         RBAC    ACL
```

---

## 8. ğŸ”„ æ··åˆæ–¹æ¡ˆä¸æœ€ä½³å®è·µ


### 8.1 RBAC + ACLæ··åˆæ–¹æ¡ˆ


**åº”ç”¨åœºæ™¯**ï¼šæ—¢éœ€è¦è§’è‰²ç®¡ç†çš„ä¾¿åˆ©æ€§ï¼Œåˆéœ€è¦ç»†ç²’åº¦çš„æƒé™æ§åˆ¶

```javascript
// RBAC + ACL æ··åˆæƒé™ç³»ç»Ÿ
class HybridPermissionSystem {
  constructor() {
    this.rbac = new RBACManager();
    this.acl = new ACLManager();
  }
  
  // æƒé™æ£€æŸ¥ï¼šå…ˆæŸ¥RBACï¼Œå†æŸ¥ACL
  checkPermission(userId, resource, permission) {
    // 1. å…ˆæ£€æŸ¥RBACæƒé™ (åŸºç¡€æƒé™)
    if (this.rbac.hasPermission(userId, permission)) {
      // 2. å†æ£€æŸ¥ACLæƒé™ (ç»†ç²’åº¦æ§åˆ¶)
      return this.acl.checkPermission(userId, resource, permission);
    }
    
    // 3. RBACæƒé™éƒ½æ²¡æœ‰ï¼Œç›´æ¥æ‹’ç»
    return false;
  }
  
  // æ‰¹é‡æˆæƒï¼šé€šè¿‡è§’è‰² + ç‰¹æ®Šèµ„æºæƒé™
  grantHybridPermission(userId, roleId, specialResources = []) {
    // åˆ†é…è§’è‰² (è·å¾—åŸºç¡€æƒé™)
    this.rbac.assignRole(userId, roleId);
    
    // åˆ†é…ç‰¹æ®Šèµ„æºæƒé™
    specialResources.forEach(({resource, permissions}) => {
      permissions.forEach(permission => {
        this.acl.addEntry(userId, resource, [permission], 'ALLOW');
      });
    });
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const hybrid = new HybridPermissionSystem();

// ç”¨æˆ·è·å¾—ç¼–è¾‘å‘˜è§’è‰² + ç‰¹å®šæ–‡æ¡£çš„ç®¡ç†æƒé™
hybrid.grantHybridPermission('user_001', 'editor', [
  {
    resource: '/documents/important.doc',
    permissions: ['delete', 'share']
  }
]);
```

### 8.2 RBAC + ABACç»“åˆæ–¹æ¡ˆ


**åº”ç”¨åœºæ™¯**ï¼šåŸºæœ¬æƒé™ç”¨è§’è‰²ç®¡ç†ï¼Œå¤æ‚ä¸šåŠ¡è§„åˆ™ç”¨å±æ€§æ§åˆ¶

```javascript
// RBAC + ABAC æ™ºèƒ½æƒé™ç³»ç»Ÿ
class SmartPermissionSystem {
  constructor() {
    this.rbac = new RBACManager();
    this.abac = new ABACEngine();
  }
  
  // æ™ºèƒ½æƒé™å†³ç­–
  intelligentAuth(userId, resource, action, context) {
    // 1. è·å–ç”¨æˆ·åŸºç¡€è§’è‰²æƒé™
    const basePermission = this.rbac.hasPermission(userId, action.type);
    
    if (!basePermission) {
      return { allowed: false, reason: 'ç¼ºå°‘åŸºç¡€è§’è‰²æƒé™' };
    }
    
    // 2. ABACåŠ¨æ€è§„åˆ™æ£€æŸ¥
    const contextualAuth = this.abac.evaluate(
      context.subject,
      context.object,
      context.environment,
      action
    );
    
    if (!contextualAuth) {
      return { allowed: false, reason: 'ä¸ç¬¦åˆä¸šåŠ¡è§„åˆ™' };
    }
    
    return { allowed: true, reason: 'æƒé™éªŒè¯é€šè¿‡' };
  }
}

// å®é™…ä½¿ç”¨åœºæ™¯
const smartSystem = new SmartPermissionSystem();

const authResult = smartSystem.intelligentAuth('user_001', 'sensitive_data', 
  { type: 'read' },
  {
    subject: { department: 'finance', level: 'senior' },
    object: { sensitivity: 'high', department: 'finance' },
    environment: { time: '10:00', location: 'office', vpn: false }
  }
);

console.log('æƒé™å†³ç­–ç»“æœ:', authResult);
// è¾“å‡º: { allowed: true, reason: 'æƒé™éªŒè¯é€šè¿‡' }
```

### 8.3 å¤šå±‚é˜²æŠ¤ç­–ç•¥


**æ·±åº¦é˜²å¾¡æ¨¡å‹**ï¼š
```
ç”¨æˆ·è®¿é—®è¯·æ±‚
    â†“
ğŸšª ç¬¬1å±‚ï¼šèº«ä»½è®¤è¯ (Authentication)
    â†“ é€šè¿‡
ğŸ­ ç¬¬2å±‚ï¼šè§’è‰²æƒé™ (RBAC)  
    â†“ é€šè¿‡
ğŸ“‹ ç¬¬3å±‚ï¼šèµ„æºæƒé™ (ACL)
    â†“ é€šè¿‡
ğŸ¯ ç¬¬4å±‚ï¼šä¸šåŠ¡è§„åˆ™ (ABAC)
    â†“ é€šè¿‡
ğŸ”’ ç¬¬5å±‚ï¼šæ•æ„Ÿæ“ä½œäºŒæ¬¡éªŒè¯
    â†“ é€šè¿‡
âœ… å…è®¸è®¿é—®
```

**å®ç°ç¤ºä¾‹**ï¼š
```javascript
// å¤šå±‚é˜²æŠ¤æƒé™ç³»ç»Ÿ
class LayeredSecuritySystem {
  constructor() {
    this.auth = new AuthenticationService();
    this.rbac = new RBACManager();
    this.acl = new ACLManager();
    this.abac = new ABACEngine();
    this.mfa = new MultiFactorAuth();
  }
  
  async secureAccess(request) {
    try {
      // ç¬¬1å±‚ï¼šèº«ä»½éªŒè¯
      const user = await this.auth.verify(request.token);
      if (!user) {
        return this.deny('èº«ä»½éªŒè¯å¤±è´¥');
      }
      
      // ç¬¬2å±‚ï¼šè§’è‰²æƒé™
      if (!this.rbac.hasPermission(user.id, request.action)) {
        return this.deny('è§’è‰²æƒé™ä¸è¶³');
      }
      
      // ç¬¬3å±‚ï¼šèµ„æºæƒé™  
      if (!this.acl.checkPermission(user.id, request.resource, request.action)) {
        return this.deny('èµ„æºæƒé™ä¸è¶³');
      }
      
      // ç¬¬4å±‚ï¼šä¸šåŠ¡è§„åˆ™
      const contextResult = this.abac.evaluate(
        this.buildSubject(user),
        this.buildObject(request.resource),
        this.buildEnvironment(request),
        request.action
      );
      
      if (!contextResult) {
        return this.deny('ä¸šåŠ¡è§„åˆ™ä¸å…è®¸');
      }
      
      // ç¬¬5å±‚ï¼šæ•æ„Ÿæ“ä½œäºŒæ¬¡éªŒè¯
      if (this.isSensitiveOperation(request)) {
        const mfaResult = await this.mfa.verify(user.id, request.mfaCode);
        if (!mfaResult) {
          return this.deny('äºŒæ¬¡éªŒè¯å¤±è´¥');
        }
      }
      
      return this.allow('è®¿é—®æƒé™éªŒè¯é€šè¿‡');
      
    } catch (error) {
      return this.deny(`ç³»ç»Ÿé”™è¯¯: ${error.message}`);
    }
  }
  
  deny(reason) {
    return { allowed: false, reason, timestamp: new Date() };
  }
  
  allow(reason) {
    return { allowed: true, reason, timestamp: new Date() };
  }
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ è®¿é—®æ§åˆ¶æœ¬è´¨ï¼šå†³å®š"è°èƒ½å¯¹ä»€ä¹ˆèµ„æºåšä»€ä¹ˆæ“ä½œ"çš„å®‰å…¨æœºåˆ¶
ğŸ”¸ ACLç‰¹ç‚¹ï¼šç›´æ¥æˆæƒï¼Œèµ„æºå¯¼å‘ï¼Œé€‚åˆå°è§„æ¨¡ç²¾ç¡®æ§åˆ¶  
ğŸ”¸ RBACç‰¹ç‚¹ï¼šè§’è‰²ä¸­ä»‹ï¼Œæ˜“ç®¡ç†ï¼Œé€‚åˆä¼ä¸šç»„ç»‡æ¶æ„
ğŸ”¸ ABACç‰¹ç‚¹ï¼šå±æ€§é©±åŠ¨ï¼ŒåŠ¨æ€å†³ç­–ï¼Œé€‚åˆå¤æ‚ä¸šåŠ¡åœºæ™¯
ğŸ”¸ MACç‰¹ç‚¹ï¼šç³»ç»Ÿå¼ºåˆ¶ï¼Œå¤šçº§å®‰å…¨ï¼Œé€‚åˆé«˜å®‰å…¨è¦æ±‚
ğŸ”¸ DACç‰¹ç‚¹ï¼šç”¨æˆ·è‡ªä¸»ï¼Œçµæ´»åˆ†äº«ï¼Œé€‚åˆä¸ªäººèµ„æºç®¡ç†
```

### 9.2 å…³é”®é€‰æ‹©åŸåˆ™


**ğŸ”¹ æ ¹æ®å®‰å…¨éœ€æ±‚é€‰æ‹©**ï¼š
```
å®‰å…¨çº§åˆ«ï¼šä½ â†’ ä¸­ â†’ é«˜ â†’ æé«˜
å¯¹åº”æ–¹æ¡ˆï¼šDAC â†’ RBAC â†’ ABAC/ACL â†’ MAC

çµæ´»æ€§éœ€æ±‚ï¼šä½ â†’ ä¸­ â†’ é«˜ â†’ æé«˜  
å¯¹åº”æ–¹æ¡ˆï¼šMAC â†’ RBAC â†’ ACL â†’ ABAC/DAC
```

**ğŸ”¹ æ ¹æ®ç»„ç»‡è§„æ¨¡é€‰æ‹©**ï¼š
```
å°å›¢é˜Ÿ (< 50äºº)ï¼š
â€¢ ä¼˜å…ˆé€‰æ‹© DAC + ç®€å•RBAC
â€¢ ç”¨æˆ·å¯ä»¥çµæ´»åˆ†äº«ï¼Œç®¡ç†å‘˜å¯ä»¥å…¨å±€æ§åˆ¶

ä¸­å‹ä¼ä¸š (50-500äºº)ï¼š
â€¢ ä¼˜å…ˆé€‰æ‹© RBAC + ACL
â€¢ æŒ‰éƒ¨é—¨è§’è‰²ç®¡ç†ï¼Œå…³é”®èµ„æºç»†ç²’åº¦æ§åˆ¶  

å¤§å‹ç»„ç»‡ (> 500äºº)ï¼š
â€¢ ä¼˜å…ˆé€‰æ‹© RBAC + ABAC
â€¢ æ ‡å‡†åŒ–è§’è‰² + å¤æ‚ä¸šåŠ¡è§„åˆ™
```

### 9.3 å®é™…åº”ç”¨å»ºè®®


**âœ… æœ€ä½³å®è·µ**ï¼š
- **åˆ†å±‚è®¾è®¡**ï¼šä¸åŒå±‚æ¬¡ä½¿ç”¨ä¸åŒçš„è®¿é—®æ§åˆ¶æ¨¡å‹
- **æ··åˆä½¿ç”¨**ï¼šç»“åˆå¤šç§æ¨¡å‹çš„ä¼˜åŠ¿
- **æœ€å°æƒé™åŸåˆ™**ï¼šç”¨æˆ·åªè·å¾—å®Œæˆå·¥ä½œæ‰€éœ€çš„æœ€å°æƒé™
- **æƒé™å®¡è®¡**ï¼šå®šæœŸæ£€æŸ¥å’Œæ¸…ç†æ— ç”¨æƒé™
- **åº”æ€¥æœºåˆ¶**ï¼šè®¾è®¡æƒé™å‡çº§å’Œåº”æ€¥è®¿é—®æµç¨‹

**âš ï¸ å¸¸è§é™·é˜±**ï¼š
- **è¿‡åº¦å¤æ‚**ï¼šä¸è¦ä¸ºäº†æŠ€æœ¯è€ŒæŠ€æœ¯ï¼Œé€‰æ‹©é€‚åˆçš„å°±æ˜¯æœ€å¥½çš„
- **æƒé™è†¨èƒ€**ï¼šå®šæœŸæ¸…ç†ä¸ç”¨çš„æƒé™ï¼Œé¿å…æƒé™è¶Šæ¥è¶Šå¤š
- **å•ç‚¹å¤±è´¥**ï¼šé¿å…è¿‡åº¦ä¾èµ–æŸä¸€ç§æ§åˆ¶æ–¹å¼
- **ç”¨æˆ·ä½“éªŒ**ï¼šæƒé™æ§åˆ¶ä¸èƒ½å½±å“æ­£å¸¸ä¸šåŠ¡æµç¨‹

### 9.4 å‘å±•è¶‹åŠ¿


```
ğŸš€ æœªæ¥å‘å±•æ–¹å‘ï¼š

æ™ºèƒ½åŒ–ï¼š
â€¢ AIè¾…åŠ©æƒé™å†³ç­–
â€¢ æœºå™¨å­¦ä¹ è¯†åˆ«å¼‚å¸¸è®¿é—®  
â€¢ è‡ªåŠ¨æƒé™æ¨èå’Œä¼˜åŒ–

é›¶ä¿¡ä»»ï¼š
â€¢ æŒç»­éªŒè¯è®¿é—®è¯·æ±‚
â€¢ åŠ¨æ€æƒé™è°ƒæ•´
â€¢ ç»†ç²’åº¦ç½‘ç»œéš”ç¦»

äº‘åŸç”Ÿï¼š  
â€¢ å¾®æœåŠ¡æƒé™æ²»ç†
â€¢ å®¹å™¨åŒ–æƒé™ç®¡ç†
â€¢ APIç½‘å…³ç»Ÿä¸€é‰´æƒ

éšç§ä¿æŠ¤ï¼š
â€¢ æ•°æ®æœ€å°åŒ–è®¿é—®
â€¢ åŒæ€åŠ å¯†è®¡ç®—
â€¢ å·®åˆ†éšç§ä¿æŠ¤
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- è®¿é—®æ§åˆ¶äº”æ¨¡å‹ï¼Œå„æœ‰ç‰¹è‰²è¦åˆ†æ¸…
- ACLç›´æ¥å¾ˆç²¾ç¡®ï¼ŒRBACè§’è‰²æ˜“ç®¡ç†  
- ABACå±æ€§æœ€çµæ´»ï¼ŒMACå¼ºåˆ¶ä¿å®‰å…¨
- DACè‡ªä¸»ç”¨æˆ·å®šï¼Œæ··åˆä½¿ç”¨æ•ˆæœä½³