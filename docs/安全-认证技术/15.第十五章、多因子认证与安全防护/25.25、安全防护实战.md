---
title: 25ã€å®‰å…¨é˜²æŠ¤å®æˆ˜
---
## ğŸ“š ç›®å½•

1. [æš´åŠ›ç ´è§£é˜²æŠ¤](#1-æš´åŠ›ç ´è§£é˜²æŠ¤)
2. [è´¦æˆ·é”å®šç­–ç•¥](#2-è´¦æˆ·é”å®šç­–ç•¥)
3. [å¼‚å¸¸ç™»å½•æ£€æµ‹](#3-å¼‚å¸¸ç™»å½•æ£€æµ‹)
4. [å¯†ç æ³„éœ²æ£€æµ‹](#4-å¯†ç æ³„éœ²æ£€æµ‹)
5. [å®‰å…¨å®¡è®¡æ—¥å¿—](#5-å®‰å…¨å®¡è®¡æ—¥å¿—)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ›¡ï¸ æš´åŠ›ç ´è§£é˜²æŠ¤


### 1.1 ä»€ä¹ˆæ˜¯æš´åŠ›ç ´è§£


**ğŸ”¸ é€šä¿—ç†è§£**
```
æš´åŠ›ç ´è§£å°±åƒå°å·ä¸åœåœ°è¯•å¯†ç é”ï¼š
è¯•è¯• 123456... ä¸å¯¹
è¯•è¯• 111111... ä¸å¯¹
è¯•è¯• 000000... ä¸å¯¹
ä¸€ç›´è¯•åˆ°å¯¹ä¸ºæ­¢

ç½‘ç»œæ”»å‡»ä¹Ÿæ˜¯è¿™æ ·ï¼š
é»‘å®¢ç”¨ç¨‹åºè‡ªåŠ¨å°è¯•å¤§é‡å¯†ç ç»„åˆ
æ¯ç§’å¯ä»¥è¯•å‡ ç™¾æ¬¡ç”šè‡³ä¸Šåƒæ¬¡
ç›´åˆ°æ‰¾åˆ°æ­£ç¡®å¯†ç 
```

**ğŸ¯ æ”»å‡»ç‰¹å¾**
- ğŸ“ˆ **é«˜é¢‘ç™»å½•å°è¯•**ï¼šçŸ­æ—¶é—´å†…å¤§é‡ç™»å½•è¯·æ±‚
- ğŸ¤– **è‡ªåŠ¨åŒ–å·¥å…·**ï¼šä½¿ç”¨è„šæœ¬æ‰¹é‡æµ‹è¯•
- ğŸ“‹ **å­—å…¸æ”»å‡»**ï¼šä½¿ç”¨å¸¸è§å¯†ç åˆ—è¡¨
- ğŸ”„ **æŒç»­æ€§**ï¼š24å°æ—¶ä¸é—´æ–­å°è¯•

### 1.2 é˜²æŠ¤ç­–ç•¥è¯¦è§£


#### ğŸš¦ **é¢‘ç‡é™åˆ¶ï¼ˆRate Limitingï¼‰**


**ğŸ’¡ æ ¸å¿ƒæ€æƒ³**ï¼šé™åˆ¶åŒä¸€IPæˆ–ç”¨æˆ·çš„ç™»å½•å°è¯•é¢‘ç‡

```javascript
// ç®€å•çš„ç™»å½•é¢‘ç‡é™åˆ¶
class LoginRateLimit {
    constructor() {
        this.attempts = new Map(); // å­˜å‚¨å°è¯•è®°å½•
    }
    
    // æ£€æŸ¥æ˜¯å¦å…è®¸ç™»å½•
    canAttempt(ip) {
        const key = ip;
        const now = Date.now();
        
        if (!this.attempts.has(key)) {
            this.attempts.set(key, []);
        }
        
        const attempts = this.attempts.get(key);
        // æ¸…ç†1å°æ—¶å‰çš„è®°å½•
        const oneHour = 60 * 60 * 1000;
        const recent = attempts.filter(time => now - time < oneHour);
        
        // 1å°æ—¶å†…è¶…è¿‡5æ¬¡å°±ç¦æ­¢
        if (recent.length >= 5) {
            return false;
        }
        
        // è®°å½•æœ¬æ¬¡å°è¯•
        recent.push(now);
        this.attempts.set(key, recent);
        return true;
    }
}
```

#### ğŸ•°ï¸ **å»¶è¿Ÿå“åº”ï¼ˆDelay Responseï¼‰**


**ğŸ’¡ æ ¸å¿ƒæ€æƒ³**ï¼šæ¯æ¬¡å¤±è´¥åå¢åŠ å“åº”æ—¶é—´ï¼Œè®©ç ´è§£å˜æ…¢

```javascript
// é€’å¢å»¶è¿Ÿç­–ç•¥
class LoginDelay {
    constructor() {
        this.failCounts = new Map();
    }
    
    async handleLogin(username, password) {
        const failCount = this.failCounts.get(username) || 0;
        
        // è®¡ç®—å»¶è¿Ÿæ—¶é—´ï¼š2^å¤±è´¥æ¬¡æ•° ç§’
        const delaySeconds = Math.pow(2, failCount);
        const maxDelay = 300; // æœ€å¤§5åˆ†é’Ÿ
        const actualDelay = Math.min(delaySeconds, maxDelay);
        
        // å…ˆå»¶è¿Ÿï¼Œå†å¤„ç†ç™»å½•
        await new Promise(resolve => 
            setTimeout(resolve, actualDelay * 1000)
        );
        
        const success = await this.verifyLogin(username, password);
        
        if (success) {
            this.failCounts.delete(username); // æˆåŠŸåæ¸…é›¶
        } else {
            this.failCounts.set(username, failCount + 1);
        }
        
        return success;
    }
}
```

#### ğŸ§© **éªŒè¯ç æœºåˆ¶ï¼ˆCAPTCHAï¼‰**


**ğŸ’¡ æ ¸å¿ƒæ€æƒ³**ï¼šåŒºåˆ†äººç±»å’Œæœºå™¨ï¼Œé˜»æ­¢è‡ªåŠ¨åŒ–æ”»å‡»

```javascript
// æ™ºèƒ½éªŒè¯ç ç­–ç•¥
class SmartCaptcha {
    constructor() {
        this.riskScores = new Map();
    }
    
    // è¯„ä¼°æ˜¯å¦éœ€è¦éªŒè¯ç 
    needsCaptcha(ip, username) {
        const ipRisk = this.getIPRisk(ip);
        const userRisk = this.getUserRisk(username);
        
        // é£é™©è¯„åˆ†ï¼šIPé£é™© + ç”¨æˆ·é£é™©
        const totalRisk = ipRisk + userRisk;
        
        return totalRisk > 30; // é£é™©è¶…è¿‡30åˆ†å°±è¦éªŒè¯ç 
    }
    
    getIPRisk(ip) {
        const attempts = this.getRecentAttempts(ip);
        return Math.min(attempts * 10, 50); // æœ€é«˜50åˆ†
    }
    
    getUserRisk(username) {
        const failures = this.getRecentFailures(username);
        return Math.min(failures * 15, 50); // æœ€é«˜50åˆ†
    }
}
```

### 1.3 é˜²æŠ¤ç­‰çº§è®¾è®¡


| é£é™©çº§åˆ« | **è§¦å‘æ¡ä»¶** | **é˜²æŠ¤æªæ–½** | **æŒç»­æ—¶é—´** |
|---------|-------------|-------------|-------------|
| ğŸŸ¢ **ä½é£é™©** | `< 3æ¬¡å¤±è´¥` | `æ— é¢å¤–é™åˆ¶` | `- ` |
| ğŸŸ¡ **ä¸­é£é™©** | `3-5æ¬¡å¤±è´¥` | `éªŒè¯ç  + 5ç§’å»¶è¿Ÿ` | `30åˆ†é’Ÿ` |
| ğŸŸ  **é«˜é£é™©** | `6-10æ¬¡å¤±è´¥` | `è´¦æˆ·é”å®š + éªŒè¯ç ` | `1å°æ—¶` |
| ğŸ”´ **æé«˜é£é™©** | `>10æ¬¡å¤±è´¥` | `IPå°ç¦ + è´¦æˆ·é”å®š` | `24å°æ—¶` |

---

## 2. ğŸ”’ è´¦æˆ·é”å®šç­–ç•¥


### 2.1 è´¦æˆ·é”å®šçš„ä½œç”¨


**ğŸ”¸ é€šä¿—ç†è§£**
```
å°±åƒé“¶è¡ŒATMæœºåˆ¶ï¼š
å¯†ç è¾“é”™3æ¬¡ â†’ é“¶è¡Œå¡è¢«å
éœ€è¦åˆ°é“¶è¡ŒæŸœå°è§£é”

ç½‘ç»œè´¦æˆ·ä¹Ÿæ˜¯è¿™æ ·ï¼š
å¯†ç è¾“é”™Næ¬¡ â†’ è´¦æˆ·è¢«é”å®š
éœ€è¦é€šè¿‡å…¶ä»–æ–¹å¼è§£é”
```

**ğŸ¯ é”å®šçš„å¥½å¤„**
- ğŸ›¡ï¸ **é˜»æ­¢ç ´è§£**ï¼šå¼ºåˆ¶åœæ­¢æš´åŠ›æ”»å‡»
- â° **äº‰å–æ—¶é—´**ï¼šç»™ç”¨æˆ·æ—¶é—´å‘ç°å¼‚å¸¸
- ğŸ“± **è§¦å‘é€šçŸ¥**ï¼šåŠæ—¶å‘ŠçŸ¥è´¦æˆ·é£é™©

### 2.2 é”å®šç­–ç•¥è®¾è®¡


#### ğŸ“Š **æ™ºèƒ½é”å®šç®—æ³•**


```javascript
// æ™ºèƒ½è´¦æˆ·é”å®šç³»ç»Ÿ
class AccountLockManager {
    constructor() {
        this.lockInfo = new Map(); // é”å®šä¿¡æ¯
        this.config = {
            maxAttempts: 5,      // æœ€å¤§å°è¯•æ¬¡æ•°
            lockDuration: 3600,  // é”å®šæ—¶é•¿(ç§’)
            escalationFactor: 2  // é€’å¢å› å­
        };
    }
    
    // æ£€æŸ¥è´¦æˆ·æ˜¯å¦è¢«é”å®š
    isLocked(username) {
        const info = this.lockInfo.get(username);
        if (!info) return false;
        
        const now = Date.now();
        if (now > info.unlockTime) {
            // é”å®šæ—¶é—´å·²è¿‡ï¼Œè‡ªåŠ¨è§£é”
            this.lockInfo.delete(username);
            return false;
        }
        
        return true;
    }
    
    // å¤„ç†ç™»å½•å¤±è´¥
    handleFailure(username) {
        const info = this.lockInfo.get(username) || {
            attempts: 0,
            lockLevel: 0,
            lastAttempt: Date.now()
        };
        
        info.attempts++;
        info.lastAttempt = Date.now();
        
        // è¾¾åˆ°é”å®šé˜ˆå€¼
        if (info.attempts >= this.config.maxAttempts) {
            info.lockLevel++;
            info.attempts = 0; // é‡ç½®è®¡æ•°
            
            // è®¡ç®—é”å®šæ—¶é•¿ï¼šåŸºç¡€æ—¶é•¿ Ã— 2^é”å®šçº§åˆ«
            const lockDuration = this.config.lockDuration * 
                Math.pow(this.config.escalationFactor, info.lockLevel - 1);
            
            info.unlockTime = Date.now() + (lockDuration * 1000);
            
            console.log(`è´¦æˆ· ${username} è¢«é”å®š ${lockDuration} ç§’`);
        }
        
        this.lockInfo.set(username, info);
    }
    
    // æˆåŠŸç™»å½•ï¼Œæ¸…é™¤å¤±è´¥è®°å½•
    handleSuccess(username) {
        const info = this.lockInfo.get(username);
        if (info) {
            info.attempts = 0; // æ¸…é™¤å°è¯•æ¬¡æ•°ï¼Œä½†ä¿ç•™é”å®šçº§åˆ«
            this.lockInfo.set(username, info);
        }
    }
}
```

#### ğŸ”„ **æ¸è¿›å¼é”å®šç­–ç•¥**


```
ç¬¬1æ¬¡é”å®šï¼š5æ¬¡å¤±è´¥ â†’ é”å®š30åˆ†é’Ÿ
ç¬¬2æ¬¡é”å®šï¼šå†5æ¬¡å¤±è´¥ â†’ é”å®š1å°æ—¶  
ç¬¬3æ¬¡é”å®šï¼šå†5æ¬¡å¤±è´¥ â†’ é”å®š2å°æ—¶
ç¬¬4æ¬¡é”å®šï¼šå†5æ¬¡å¤±è´¥ â†’ é”å®š4å°æ—¶
...ä»¥æ­¤ç±»æ¨ï¼Œæœ€é•¿ä¸è¶…è¿‡24å°æ—¶
```

### 2.3 è§£é”æœºåˆ¶è®¾è®¡


#### ğŸ“§ **é‚®ç®±éªŒè¯è§£é”**


```javascript
// é‚®ç®±è§£é”æœåŠ¡
class EmailUnlockService {
    async sendUnlockEmail(username, email) {
        const token = this.generateUnlockToken(username);
        const unlockUrl = `https://example.com/unlock?token=${token}`;
        
        const emailContent = `
            æ‚¨çš„è´¦æˆ·å› å¤šæ¬¡ç™»å½•å¤±è´¥è¢«é”å®šã€‚
            å¦‚æœæ˜¯æ‚¨æœ¬äººæ“ä½œï¼Œè¯·ç‚¹å‡»ä¸‹æ–¹é“¾æ¥è§£é”ï¼š
            ${unlockUrl}
            
            å¦‚æœä¸æ˜¯æ‚¨æœ¬äººæ“ä½œï¼Œè¯·ç«‹å³ä¿®æ”¹å¯†ç ã€‚
            é“¾æ¥æœ‰æ•ˆæœŸï¼š30åˆ†é’Ÿ
        `;
        
        await this.sendEmail(email, 'è´¦æˆ·è§£é”é€šçŸ¥', emailContent);
    }
    
    // éªŒè¯è§£é”ä»¤ç‰Œ
    async verifyUnlockToken(token) {
        const payload = this.decodeToken(token);
        
        if (this.isTokenExpired(payload)) {
            return { success: false, message: 'é“¾æ¥å·²è¿‡æœŸ' };
        }
        
        // è§£é”è´¦æˆ·
        this.unlockAccount(payload.username);
        
        return { success: true, message: 'è´¦æˆ·è§£é”æˆåŠŸ' };
    }
}
```

#### ğŸ“± **æ‰‹æœºéªŒè¯è§£é”**


```javascript
// çŸ­ä¿¡è§£é”æœåŠ¡  
class SMSUnlockService {
    async sendUnlockCode(username, phone) {
        const code = this.generateSixDigitCode();
        const message = `æ‚¨çš„è§£é”éªŒè¯ç ï¼š${code}ï¼Œ5åˆ†é’Ÿå†…æœ‰æ•ˆã€‚å¦‚éæœ¬äººæ“ä½œè¯·å¿½ç•¥ã€‚`;
        
        // å­˜å‚¨éªŒè¯ç ï¼ˆ5åˆ†é’Ÿè¿‡æœŸï¼‰
        this.storeCode(username, code, 300);
        
        await this.sendSMS(phone, message);
    }
    
    // éªŒè¯è§£é”ç 
    async verifyUnlockCode(username, code) {
        const storedCode = this.getStoredCode(username);
        
        if (!storedCode || storedCode !== code) {
            return { success: false, message: 'éªŒè¯ç é”™è¯¯æˆ–å·²è¿‡æœŸ' };
        }
        
        // è§£é”è´¦æˆ·
        this.unlockAccount(username);
        this.clearStoredCode(username);
        
        return { success: true, message: 'è´¦æˆ·è§£é”æˆåŠŸ' };
    }
}
```

---

## 3. ğŸ” å¼‚å¸¸ç™»å½•æ£€æµ‹


### 3.1 ä»€ä¹ˆæ˜¯å¼‚å¸¸ç™»å½•


**ğŸ”¸ é€šä¿—ç†è§£**
```
å°±åƒé“¶è¡Œçš„é£æ§ç³»ç»Ÿï¼š
å¹³æ—¶ä½ åœ¨åŒ—äº¬æ¶ˆè´¹ï¼Œçªç„¶åœ¨ä¸Šæµ·åˆ·å¡
ç³»ç»Ÿä¼šå‘çŸ­ä¿¡ç¡®è®¤ï¼šè¿™ç¬”æ¶ˆè´¹æ˜¯æ‚¨æœ¬äººå—ï¼Ÿ

å¼‚å¸¸ç™»å½•æ£€æµ‹ä¹Ÿæ˜¯è¿™æ ·ï¼š
æ£€æµ‹ä¸ç¬¦åˆç”¨æˆ·ä¹ æƒ¯çš„ç™»å½•è¡Œä¸º
åŠæ—¶å‘ç°å¯èƒ½çš„è´¦æˆ·è¢«ç›—
```

**ğŸš¨ å¼‚å¸¸è¡Œä¸ºç‰¹å¾**
- ğŸŒ **åœ°ç†ä½ç½®å¼‚å¸¸**ï¼šä¸åŒåŸå¸‚/å›½å®¶åŒæ—¶ç™»å½•
- ğŸ• **æ—¶é—´å¼‚å¸¸**ï¼šæ·±å¤œæˆ–éå¸¸è§„æ—¶é—´ç™»å½•  
- ğŸ“± **è®¾å¤‡å¼‚å¸¸**ï¼šä»æœªä½¿ç”¨è¿‡çš„è®¾å¤‡ç™»å½•
- ğŸŒ **æµè§ˆå™¨å¼‚å¸¸**ï¼šä¸å¸¸ç”¨çš„æµè§ˆå™¨æˆ–ç‰ˆæœ¬

### 3.2 æ£€æµ‹ç®—æ³•å®ç°


#### ğŸ—ºï¸ **åœ°ç†ä½ç½®æ£€æµ‹**


```javascript
// åœ°ç†ä½ç½®å¼‚å¸¸æ£€æµ‹
class LocationDetector {
    constructor() {
        this.userLocations = new Map(); // ç”¨æˆ·å†å²ä½ç½®
    }
    
    async detectLocationAnomaly(username, ip) {
        const currentLocation = await this.getLocationFromIP(ip);
        const userHistory = this.userLocations.get(username) || [];
        
        if (userHistory.length === 0) {
            // é¦–æ¬¡ç™»å½•ï¼Œè®°å½•ä½ç½®
            this.addLocation(username, currentLocation);
            return { anomaly: false, reason: 'é¦–æ¬¡ç™»å½•' };
        }
        
        // æ£€æŸ¥æ˜¯å¦åœ¨å¸¸ç”¨ä½ç½®é™„è¿‘ï¼ˆ100å…¬é‡Œå†…ï¼‰
        const isNearKnownLocation = userHistory.some(location => 
            this.calculateDistance(currentLocation, location) < 100
        );
        
        if (!isNearKnownLocation) {
            // æ£€æŸ¥ç‰©ç†å¯èƒ½æ€§ï¼ˆäººä¸å¯èƒ½ç¬é—´ä¼ é€ï¼‰
            const lastLocation = userHistory[userHistory.length - 1];
            const distance = this.calculateDistance(currentLocation, lastLocation);
            const timeDiff = Date.now() - lastLocation.timestamp;
            const maxPossibleSpeed = 1000; // å‡è®¾æœ€å¤§1000km/hï¼ˆé£æœºé€Ÿåº¦ï¼‰
            
            const requiredTime = distance / maxPossibleSpeed * 3600000; // è½¬æ¢ä¸ºæ¯«ç§’
            
            if (timeDiff < requiredTime) {
                return {
                    anomaly: true,
                    reason: `åœ°ç†ä½ç½®å¼‚å¸¸ï¼šä»${lastLocation.city}åˆ°${currentLocation.city}è·ç¦»${distance}kmï¼Œæ—¶é—´é—´éš”è¿‡çŸ­`
                };
            }
        }
        
        this.addLocation(username, currentLocation);
        return { anomaly: false };
    }
    
    // è®¡ç®—ä¸¤ç‚¹é—´è·ç¦»ï¼ˆç®€åŒ–ç®—æ³•ï¼‰
    calculateDistance(loc1, loc2) {
        const R = 6371; // åœ°çƒåŠå¾„
        const dLat = (loc2.lat - loc1.lat) * Math.PI / 180;
        const dLon = (loc2.lon - loc1.lon) * Math.PI / 180;
        const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(loc1.lat * Math.PI / 180) * Math.cos(loc2.lat * Math.PI / 180) *
                Math.sin(dLon/2) * Math.sin(dLon/2);
        return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
    }
}
```

#### ğŸ• **æ—¶é—´æ¨¡å¼æ£€æµ‹**


```javascript
// ç™»å½•æ—¶é—´æ¨¡å¼åˆ†æ
class TimePatternDetector {
    constructor() {
        this.userPatterns = new Map();
    }
    
    detectTimeAnomaly(username) {
        const now = new Date();
        const hour = now.getHours();
        const dayOfWeek = now.getDay(); // 0=å‘¨æ—¥, 1=å‘¨ä¸€...
        
        const pattern = this.userPatterns.get(username);
        if (!pattern) {
            this.initUserPattern(username, hour, dayOfWeek);
            return { anomaly: false, reason: 'å»ºç«‹æ—¶é—´æ¨¡å¼' };
        }
        
        // æ£€æŸ¥å½“å‰æ—¶é—´æ˜¯å¦åœ¨ç”¨æˆ·å¸¸ç”¨æ—¶é—´æ®µ
        const isNormalHour = pattern.commonHours.includes(hour);
        const isNormalDay = pattern.commonDays.includes(dayOfWeek);
        
        // æ·±å¤œç™»å½•æ£€æµ‹ï¼ˆå‡Œæ™¨2-6ç‚¹ï¼‰
        const isLateNight = hour >= 2 && hour <= 6;
        const userUsuallyLateNight = pattern.lateNightLogin > 0.3; // 30%ä»¥ä¸Šçš„æ·±å¤œç™»å½•
        
        if (isLateNight && !userUsuallyLateNight) {
            return {
                anomaly: true,
                reason: `å¼‚å¸¸æ—¶é—´ç™»å½•ï¼šå‡Œæ™¨${hour}ç‚¹ï¼Œç”¨æˆ·é€šå¸¸ä¸åœ¨æ­¤æ—¶é—´ç™»å½•`
            };
        }
        
        if (!isNormalHour && !isNormalDay) {
            return {
                anomaly: true,
                reason: `æ—¶é—´æ¨¡å¼å¼‚å¸¸ï¼š${this.getDayName(dayOfWeek)} ${hour}ç‚¹ä¸ç¬¦åˆç”¨æˆ·ä¹ æƒ¯`
            };
        }
        
        this.updatePattern(username, hour, dayOfWeek);
        return { anomaly: false };
    }
}
```

#### ğŸ“± **è®¾å¤‡æŒ‡çº¹æ£€æµ‹**


```javascript
// è®¾å¤‡æŒ‡çº¹å¼‚å¸¸æ£€æµ‹
class DeviceFingerprintDetector {
    constructor() {
        this.userDevices = new Map();
    }
    
    detectDeviceAnomaly(username, fingerprint) {
        const knownDevices = this.userDevices.get(username) || [];
        
        // æ£€æŸ¥æ˜¯å¦æ˜¯å·²çŸ¥è®¾å¤‡
        const isKnownDevice = knownDevices.some(device => 
            this.compareFingerprints(device, fingerprint)
        );
        
        if (!isKnownDevice) {
            // æ–°è®¾å¤‡ç™»å½•
            const riskScore = this.calculateDeviceRisk(fingerprint);
            
            return {
                anomaly: true,
                reason: 'æ–°è®¾å¤‡ç™»å½•',
                riskScore: riskScore,
                deviceInfo: {
                    os: fingerprint.os,
                    browser: fingerprint.browser,
                    resolution: fingerprint.screen
                }
            };
        }
        
        return { anomaly: false, reason: 'å·²çŸ¥è®¾å¤‡' };
    }
    
    // è®¾å¤‡æŒ‡çº¹ç›¸ä¼¼åº¦æ¯”è¾ƒ
    compareFingerprints(device1, device2) {
        const similarity = 
            (device1.os === device2.os ? 0.3 : 0) +
            (device1.browser === device2.browser ? 0.3 : 0) +
            (device1.screen === device2.screen ? 0.2 : 0) +
            (device1.timezone === device2.timezone ? 0.2 : 0);
        
        return similarity >= 0.7; // 70%ç›¸ä¼¼åº¦è®¤ä¸ºæ˜¯åŒä¸€è®¾å¤‡
    }
}
```

### 3.3 ç»¼åˆé£é™©è¯„ä¼°


```javascript
// å¼‚å¸¸ç™»å½•ç»¼åˆè¯„ä¼°ç³»ç»Ÿ
class LoginAnomalyDetector {
    constructor() {
        this.locationDetector = new LocationDetector();
        this.timeDetector = new TimePatternDetector();
        self.deviceDetector = new DeviceFingerprintDetector();
    }
    
    async evaluateLogin(username, loginData) {
        const results = await Promise.all([
            this.locationDetector.detectLocationAnomaly(username, loginData.ip),
            this.timeDetector.detectTimeAnomaly(username),
            this.deviceDetector.detectDeviceAnomaly(username, loginData.fingerprint)
        ]);
        
        // è®¡ç®—ç»¼åˆé£é™©åˆ†æ•°
        let riskScore = 0;
        const anomalies = [];
        
        results.forEach(result => {
            if (result.anomaly) {
                riskScore += this.getAnomalyWeight(result.type);
                anomalies.push(result.reason);
            }
        });
        
        // é£é™©ç­‰çº§åˆ¤å®š
        const riskLevel = this.getRiskLevel(riskScore);
        
        return {
            riskScore,
            riskLevel,
            anomalies,
            actions: this.getRequiredActions(riskLevel)
        };
    }
    
    getRiskLevel(score) {
        if (score >= 80) return 'HIGH';
        if (score >= 50) return 'MEDIUM';  
        if (score >= 20) return 'LOW';
        return 'NORMAL';
    }
    
    getRequiredActions(riskLevel) {
        const actions = {
            'HIGH': ['é˜»æ­¢ç™»å½•', 'å‘é€è­¦å‘Šé‚®ä»¶', 'è¦æ±‚èº«ä»½éªŒè¯'],
            'MEDIUM': ['è¦æ±‚éªŒè¯ç ', 'å‘é€ç™»å½•é€šçŸ¥'],
            'LOW': ['è®°å½•æ—¥å¿—', 'å‘é€ç™»å½•é€šçŸ¥'],
            'NORMAL': ['æ­£å¸¸å¤„ç†']
        };
        
        return actions[riskLevel] || actions['NORMAL'];
    }
}
```

---

## 4. ğŸ” å¯†ç æ³„éœ²æ£€æµ‹


### 4.1 ä»€ä¹ˆæ˜¯å¯†ç æ³„éœ²æ£€æµ‹


**ğŸ”¸ é€šä¿—ç†è§£**
```
å°±åƒæŸ¥é‡è½¯ä»¶æ£€æµ‹è®ºæ–‡æŠ„è¢­ï¼š
æŠŠä½ çš„å¯†ç å’Œå·²çŸ¥çš„æ³„éœ²å¯†ç åº“å¯¹æ¯”
å¦‚æœå‘ç°åŒ¹é…ï¼Œè¯´æ˜è¿™ä¸ªå¯†ç å·²ç»ä¸å®‰å…¨äº†

å¯†ç æ³„éœ²åº“æ¥æºï¼š
- å†å²ä¸Šå„å¤§ç½‘ç«™çš„æ•°æ®æ³„éœ²äº‹ä»¶
- é»‘å¸‚ä¸Šæµä¼ çš„å¯†ç å­—å…¸  
- ç ”ç©¶æœºæ„æ”¶é›†çš„å¼±å¯†ç 
```

**ğŸ¯ æ£€æµ‹ç›®çš„**
- ğŸš¨ **é¢„è­¦é£é™©**ï¼šå‘ŠçŸ¥ç”¨æˆ·å¯†ç å¯èƒ½å·²è¢«ä»–äººçŸ¥é“
- ğŸ”’ **å¼ºåˆ¶æ›´æ¢**ï¼šè¦æ±‚ç«‹å³ä¿®æ”¹å·²æ³„éœ²çš„å¯†ç 
- ğŸ“Š **ç»Ÿè®¡åˆ†æ**ï¼šäº†è§£ç”¨æˆ·å¯†ç å®‰å…¨ç°çŠ¶

### 4.2 æ£€æµ‹æ–¹æ³•å®ç°


#### ğŸ“š **æœ¬åœ°å¯†ç åº“æ£€æµ‹**


```javascript
// æœ¬åœ°å¯†ç æ³„éœ²æ£€æµ‹
class LocalPasswordLeakDetector {
    constructor() {
        // å¸¸è§æ³„éœ²å¯†ç å“ˆå¸Œåº“ï¼ˆç®€åŒ–ç¤ºä¾‹ï¼‰
        this.leakedHashes = new Set([
            'e10adc3949ba59abbe56e057f20f883e', // 123456
            '25d55ad283aa400af464c76d713c07ad', // 12345678  
            '5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8', // password
            // ... æ›´å¤šæ³„éœ²å¯†ç å“ˆå¸Œ
        ]);
        
        this.weakPatterns = [
            /^123+$/, // è¿ç»­æ•°å­—
            /^abc+$/i, // è¿ç»­å­—æ¯
            /^(.)\1{3,}$/, // é‡å¤å­—ç¬¦
            /^(password|admin|user)/i // å¸¸è§å•è¯å¼€å¤´
        ];
    }
    
    async checkPassword(password) {
        const hash = await this.hashPassword(password);
        
        // æ£€æŸ¥æ˜¯å¦åœ¨æ³„éœ²åº“ä¸­
        if (this.leakedHashes.has(hash)) {
            return {
                leaked: true,
                reason: 'æ­¤å¯†ç åœ¨å†å²æ•°æ®æ³„éœ²äº‹ä»¶ä¸­è¢«å‘ç°',
                riskLevel: 'HIGH'
            };
        }
        
        // æ£€æŸ¥å¼±å¯†ç æ¨¡å¼
        for (let pattern of this.weakPatterns) {
            if (pattern.test(password)) {
                return {
                    leaked: true,
                    reason: 'æ­¤å¯†ç å±äºå¸¸è§å¼±å¯†ç æ¨¡å¼',
                    riskLevel: 'MEDIUM'
                };
            }
        }
        
        // æ£€æŸ¥å¯†ç å¤æ‚åº¦
        const complexity = this.checkComplexity(password);
        if (complexity.score < 60) {
            return {
                leaked: false,
                reason: 'å¯†ç å¼ºåº¦è¾ƒå¼±ï¼Œå»ºè®®ä½¿ç”¨æ›´å¤æ‚çš„å¯†ç ',
                riskLevel: 'LOW',
                suggestions: complexity.suggestions
            };
        }
        
        return {
            leaked: false,
            reason: 'å¯†ç å®‰å…¨æ€§è‰¯å¥½',
            riskLevel: 'NORMAL'
        };
    }
    
    // å¯†ç å¤æ‚åº¦è¯„ä¼°
    checkComplexity(password) {
        let score = 0;
        const suggestions = [];
        
        // é•¿åº¦è¯„åˆ†
        if (password.length >= 12) score += 25;
        else if (password.length >= 8) score += 15;
        else suggestions.push('å»ºè®®å¯†ç é•¿åº¦è‡³å°‘8ä½');
        
        // å­—ç¬¦ç§ç±»è¯„åˆ†
        if (/[a-z]/.test(password)) score += 10;
        else suggestions.push('å»ºè®®åŒ…å«å°å†™å­—æ¯');
        
        if (/[A-Z]/.test(password)) score += 15;
        else suggestions.push('å»ºè®®åŒ…å«å¤§å†™å­—æ¯');
        
        if (/[0-9]/.test(password)) score += 15;
        else suggestions.push('å»ºè®®åŒ…å«æ•°å­—');
        
        if (/[^a-zA-Z0-9]/.test(password)) score += 20;
        else suggestions.push('å»ºè®®åŒ…å«ç‰¹æ®Šå­—ç¬¦');
        
        // æ¨¡å¼æ£€æŸ¥
        if (!/(.)\1{2,}/.test(password)) score += 15;
        else suggestions.push('é¿å…é‡å¤å­—ç¬¦');
        
        return { score, suggestions };
    }
}
```

#### ğŸŒ **åœ¨çº¿APIæ£€æµ‹ï¼ˆHaveIBeenPwnedï¼‰**


```javascript
// HaveIBeenPwned API æ£€æµ‹
class OnlineLeakDetector {
    constructor() {
        this.apiUrl = 'https://api.pwnedpasswords.com/range/';
    }
    
    async checkPasswordOnline(password) {
        try {
            // è®¡ç®—å¯†ç çš„SHA1å“ˆå¸Œ
            const hash = await this.sha1(password);
            const prefix = hash.substring(0, 5).toUpperCase();
            const suffix = hash.substring(5).toUpperCase();
            
            // å‘é€å‰5ä½å“ˆå¸Œåˆ°APIï¼ˆä¿æŠ¤éšç§ï¼‰
            const response = await fetch(`${this.apiUrl}${prefix}`);
            const text = await response.text();
            
            // æŸ¥æ‰¾å®Œæ•´å“ˆå¸ŒåŒ¹é…
            const lines = text.split('\n');
            for (let line of lines) {
                const [hashSuffix, count] = line.split(':');
                if (hashSuffix.trim() === suffix) {
                    return {
                        leaked: true,
                        count: parseInt(count),
                        reason: `æ­¤å¯†ç åœ¨${count}æ¬¡æ•°æ®æ³„éœ²ä¸­è¢«å‘ç°`
                    };
                }
            }
            
            return {
                leaked: false,
                reason: 'æœªåœ¨å·²çŸ¥æ³„éœ²æ•°æ®åº“ä¸­å‘ç°æ­¤å¯†ç '
            };
        } catch (error) {
            console.error('åœ¨çº¿æ£€æµ‹å¤±è´¥:', error);
            return {
                leaked: null,
                reason: 'æ— æ³•è¿æ¥åˆ°åœ¨çº¿æ£€æµ‹æœåŠ¡'
            };
        }
    }
    
    // SHA1å“ˆå¸Œè®¡ç®—
    async sha1(message) {
        const msgBuffer = new TextEncoder().encode(message);
        const hashBuffer = await crypto.subtle.digest('SHA-1', msgBuffer);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    }
}
```

### 4.3 å®æ—¶ç›‘æ§ä¸å¤„ç†


```javascript
// å¯†ç å®‰å…¨ç›‘æ§ç³»ç»Ÿ
class PasswordSecurityMonitor {
    constructor() {
        this.localDetector = new LocalPasswordLeakDetector();
        this.onlineDetector = new OnlineLeakDetector();
        this.notifications = new NotificationService();
    }
    
    // ç”¨æˆ·è®¾ç½®å¯†ç æ—¶æ£€æµ‹
    async validateNewPassword(username, password) {
        const [localResult, onlineResult] = await Promise.all([
            this.localDetector.checkPassword(password),
            this.onlineDetector.checkPasswordOnline(password)
        ]);
        
        // åˆå¹¶æ£€æµ‹ç»“æœ
        const result = this.mergeResults(localResult, onlineResult);
        
        // æ ¹æ®é£é™©ç­‰çº§å¤„ç†
        await this.handleRiskLevel(username, result);
        
        return result;
    }
    
    mergeResults(local, online) {
        if (local.leaked || online.leaked) {
            return {
                allowed: false,
                riskLevel: online.leaked ? 'CRITICAL' : local.riskLevel,
                reason: online.leaked ? online.reason : local.reason,
                count: online.count || 0
            };
        }
        
        return {
            allowed: true,
            riskLevel: local.riskLevel,
            reason: local.reason,
            suggestions: local.suggestions
        };
    }
    
    async handleRiskLevel(username, result) {
        switch (result.riskLevel) {
            case 'CRITICAL':
                // ä¸¥é‡é£é™©ï¼šæ‹’ç»å¯†ç 
                await this.notifications.sendAlert(username, 
                    'æ‚¨å°è¯•è®¾ç½®çš„å¯†ç å­˜åœ¨ä¸¥é‡å®‰å…¨é£é™©ï¼Œå·²åœ¨å¤šæ¬¡æ•°æ®æ³„éœ²ä¸­è¢«å‘ç°ï¼Œè¯·é€‰æ‹©å…¶ä»–å¯†ç ã€‚');
                break;
                
            case 'HIGH':
                // é«˜é£é™©ï¼šå»ºè®®æ›´æ¢
                await this.notifications.sendWarning(username,
                    'æ‚¨çš„å¯†ç å­˜åœ¨å®‰å…¨é£é™©ï¼Œå»ºè®®ç«‹å³æ›´æ¢ä¸ºæ›´å®‰å…¨çš„å¯†ç ã€‚');
                break;
                
            case 'MEDIUM':
                // ä¸­é£é™©ï¼šç»™å‡ºå»ºè®®
                await this.notifications.sendTip(username,
                    'å»ºè®®ä½¿ç”¨æ›´å¤æ‚çš„å¯†ç ä»¥æé«˜è´¦æˆ·å®‰å…¨æ€§ã€‚');
                break;
        }
    }
}
```

---

## 5. ğŸ“Š å®‰å…¨å®¡è®¡æ—¥å¿—


### 5.1 ä»€ä¹ˆæ˜¯å®‰å…¨å®¡è®¡æ—¥å¿—


**ğŸ”¸ é€šä¿—ç†è§£**
```
å°±åƒé“¶è¡Œçš„äº¤æ˜“è®°å½•ï¼š
æ¯ç¬”è½¬è´¦éƒ½æœ‰è¯¦ç»†è®°å½•
ä»€ä¹ˆæ—¶é—´ã€ä»€ä¹ˆäººã€åšäº†ä»€ä¹ˆã€ç»“æœå¦‚ä½•

å®‰å…¨å®¡è®¡æ—¥å¿—ä¹Ÿæ˜¯è¿™æ ·ï¼š
è®°å½•æ‰€æœ‰å®‰å…¨ç›¸å…³çš„æ“ä½œ
ç”¨äºäº‹ååˆ†æã€é—®é¢˜æ’æŸ¥ã€åˆè§„æ£€æŸ¥
```

**ğŸ¯ æ—¥å¿—çš„ä½œç”¨**
- ğŸ” **äº‹ä»¶è¿½æº¯**ï¼šå‡ºé—®é¢˜æ—¶èƒ½æ‰¾åˆ°æ ¹æœ¬åŸå› 
- ğŸ“ˆ **è¶‹åŠ¿åˆ†æ**ï¼šå‘ç°æ”»å‡»æ¨¡å¼å’Œå®‰å…¨è¶‹åŠ¿  
- âš–ï¸ **åˆè§„è¦æ±‚**ï¼šæ»¡è¶³æ³•å¾‹æ³•è§„å®¡è®¡éœ€æ±‚
- ğŸš¨ **å®æ—¶ç›‘æ§**ï¼šåŠæ—¶å‘ç°å¼‚å¸¸è¡Œä¸º

### 5.2 æ—¥å¿—è®¾è®¡è§„èŒƒ


#### ğŸ“‹ **æ—¥å¿—å­—æ®µå®šä¹‰**


```javascript
// æ ‡å‡†å®‰å…¨æ—¥å¿—æ ¼å¼
class SecurityLogEntry {
    constructor(data) {
        this.timestamp = new Date().toISOString(); // æ—¶é—´æˆ³
        this.eventType = data.eventType;           // äº‹ä»¶ç±»å‹
        this.username = data.username || 'anonymous'; // ç”¨æˆ·å
        this.ip = data.ip;                         // IPåœ°å€
        this.userAgent = data.userAgent;           // æµè§ˆå™¨ä¿¡æ¯
        this.sessionId = data.sessionId;           // ä¼šè¯ID
        this.result = data.result;                 // æ“ä½œç»“æœ
        this.riskLevel = data.riskLevel || 'LOW';  // é£é™©çº§åˆ«
        this.details = data.details || {};         // è¯¦ç»†ä¿¡æ¯
        this.location = data.location;             // åœ°ç†ä½ç½®
    }
    
    toJSON() {
        return {
            '@timestamp': this.timestamp,
            'event.type': this.eventType,
            'user.name': this.username,
            'source.ip': this.ip,
            'user_agent.original': this.userAgent,
            'session.id': this.sessionId,
            'event.outcome': this.result,
            'risk.level': this.riskLevel,
            'event.details': this.details,
            'geo.location': this.location
        };
    }
}
```

#### ğŸ·ï¸ **äº‹ä»¶ç±»å‹åˆ†ç±»**


| ç±»åˆ« | **äº‹ä»¶ç±»å‹** | **æè¿°** | **é£é™©çº§åˆ«** |
|------|------------|----------|-------------|
| ğŸ” **è®¤è¯äº‹ä»¶** | `login_success` | `ç™»å½•æˆåŠŸ` | `LOW` |
| ğŸ” **è®¤è¯äº‹ä»¶** | `login_failure` | `ç™»å½•å¤±è´¥` | `MEDIUM` |
| ğŸ” **è®¤è¯äº‹ä»¶** | `account_locked` | `è´¦æˆ·é”å®š` | `HIGH` |
| ğŸ›¡ï¸ **é˜²æŠ¤äº‹ä»¶** | `brute_force_detected` | `æš´åŠ›ç ´è§£æ£€æµ‹` | `HIGH` |
| ğŸ›¡ï¸ **é˜²æŠ¤äº‹ä»¶** | `captcha_failed` | `éªŒè¯ç å¤±è´¥` | `MEDIUM` |
| ğŸš¨ **å¼‚å¸¸äº‹ä»¶** | `anomaly_location` | `å¼‚å¸¸åœ°ç†ä½ç½®` | `HIGH` |
| ğŸš¨ **å¼‚å¸¸äº‹ä»¶** | `anomaly_device` | `å¼‚å¸¸è®¾å¤‡` | `MEDIUM` |
| ğŸ”‘ **å¯†ç äº‹ä»¶** | `password_changed` | `å¯†ç ä¿®æ”¹` | `MEDIUM` |
| ğŸ”‘ **å¯†ç äº‹ä»¶** | `weak_password_attempt` | `å¼±å¯†ç å°è¯•` | `LOW` |

### 5.3 æ—¥å¿—æ”¶é›†å®ç°


```javascript
// å®‰å…¨å®¡è®¡æ—¥å¿—ç³»ç»Ÿ
class SecurityAuditLogger {
    constructor() {
        this.loggers = {
            file: new FileLogger('./logs/security.log'),
            database: new DatabaseLogger(),
            syslog: new SyslogLogger(),
            elastic: new ElasticSearchLogger()
        };
        this.asyncQueue = [];
    }
    
    // è®°å½•å®‰å…¨äº‹ä»¶
    async logSecurityEvent(eventData) {
        try {
            const logEntry = new SecurityLogEntry(eventData);
            
            // åŒæ­¥å†™å…¥å…³é”®æ—¥å¿—
            if (this.isCriticalEvent(eventData.eventType)) {
                await this.syncWrite(logEntry);
            } else {
                // å¼‚æ­¥å†™å…¥ä¸€èˆ¬æ—¥å¿—
                this.asyncWrite(logEntry);
            }
            
            // å®æ—¶å‘Šè­¦æ£€æŸ¥
            await this.checkAlerts(logEntry);
            
        } catch (error) {
            console.error('æ—¥å¿—è®°å½•å¤±è´¥:', error);
            // å¤±è´¥æ—¶å†™å…¥å¤‡ç”¨æ—¥å¿—
            await this.loggers.file.writeError(eventData, error);
        }
    }
    
    // åˆ¤æ–­æ˜¯å¦ä¸ºå…³é”®äº‹ä»¶
    isCriticalEvent(eventType) {
        const criticalEvents = [
            'account_locked',
            'brute_force_detected',
            'admin_login',
            'privilege_escalation',
            'data_export'
        ];
        return criticalEvents.includes(eventType);
    }
    
    // åŒæ­¥å†™å…¥å¤šä¸ªç›®æ ‡
    async syncWrite(logEntry) {
        const promises = Object.values(this.loggers).map(logger =>
            logger.write(logEntry).catch(err => console.error('Logger error:', err))
        );
        await Promise.allSettled(promises);
    }
    
    // å¼‚æ­¥æ‰¹é‡å†™å…¥
    asyncWrite(logEntry) {
        this.asyncQueue.push(logEntry);
        
        // è¾¾åˆ°æ‰¹é‡å¤§å°æˆ–è¶…æ—¶æ—¶å†™å…¥
        if (this.asyncQueue.length >= 100) {
            this.flushQueue();
        }
    }
    
    // å®æ—¶å‘Šè­¦æ£€æŸ¥
    async checkAlerts(logEntry) {
        const rules = [
            {
                condition: entry => entry.eventType === 'login_failure',
                threshold: 5,
                timeWindow: 300000, // 5åˆ†é’Ÿ
                action: 'LOCK_ACCOUNT'
            },
            {
                condition: entry => entry.riskLevel === 'HIGH',
                threshold: 3,
                timeWindow: 600000, // 10åˆ†é’Ÿ  
                action: 'SEND_ALERT'
            }
        ];
        
        for (let rule of rules) {
            if (rule.condition(logEntry)) {
                await this.processAlert(rule, logEntry);
            }
        }
    }
}
```

### 5.4 æ—¥å¿—åˆ†æä¸æŠ¥å‘Š


#### ğŸ“ˆ **ç»Ÿè®¡åˆ†æ**


```javascript
// å®‰å…¨æ—¥å¿—åˆ†æå™¨
class SecurityLogAnalyzer {
    constructor() {
        this.database = new LogDatabase();
    }
    
    // ç”Ÿæˆæ¯æ—¥å®‰å…¨æŠ¥å‘Š
    async generateDailyReport() {
        const today = new Date();
        const yesterday = new Date(today - 24 * 60 * 60 * 1000);
        
        const stats = await this.database.query(`
            SELECT 
                event_type,
                COUNT(*) as count,
                COUNT(DISTINCT username) as unique_users,
                COUNT(DISTINCT source_ip) as unique_ips
            FROM security_logs 
            WHERE timestamp >= ? AND timestamp < ?
            GROUP BY event_type
        `, [yesterday, today]);
        
        const report = {
            date: yesterday.toISOString().split('T')[0],
            summary: {
                totalEvents: stats.reduce((sum, row) => sum + row.count, 0),
                uniqueUsers: new Set(stats.map(row => row.unique_users)).size,
                uniqueIPs: new Set(stats.map(row => row.unique_ips)).size
            },
            events: stats,
            alerts: await this.getHighRiskEvents(yesterday, today),
            trends: await this.analyzeTrends(yesterday)
        };
        
        return report;
    }
    
    // æ£€æµ‹æ”»å‡»æ¨¡å¼
    async detectAttackPatterns() {
        // SQLæ³¨å…¥æ”»å‡»æ£€æµ‹
        const sqlInjectionAttempts = await this.database.query(`
            SELECT source_ip, COUNT(*) as attempts
            FROM security_logs 
            WHERE event_details LIKE '%union%select%' 
               OR event_details LIKE '%drop%table%'
               OR event_details LIKE '%script%alert%'
            GROUP BY source_ip
            HAVING attempts > 10
        `);
        
        // æš´åŠ›ç ´è§£æ£€æµ‹
        const bruteForceAttempts = await this.database.query(`
            SELECT username, source_ip, COUNT(*) as attempts
            FROM security_logs 
            WHERE event_type = 'login_failure'
              AND timestamp > DATE_SUB(NOW(), INTERVAL 1 HOUR)
            GROUP BY username, source_ip
            HAVING attempts > 20
        `);
        
        return {
            sqlInjection: sqlInjectionAttempts,
            bruteForce: bruteForceAttempts,
            timestamp: new Date()
        };
    }
}
```

#### ğŸ“Š **å¯è§†åŒ–æŠ¥è¡¨**


```javascript
// å®‰å…¨æŠ¥è¡¨ç”Ÿæˆå™¨
class SecurityDashboard {
    constructor() {
        this.analyzer = new SecurityLogAnalyzer();
    }
    
    // ç”ŸæˆHTMLæŠ¥è¡¨
    async generateDashboard() {
        const report = await this.analyzer.generateDailyReport();
        const patterns = await this.analyzer.detectAttackPatterns();
        
        return `
        <!DOCTYPE html>
        <html>
        <head>
            <title>å®‰å…¨ç›‘æ§é¢æ¿</title>
            <style>
                .dashboard { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
                .card { border: 1px solid #ddd; padding: 20px; border-radius: 8px; }
                .high-risk { border-left: 4px solid #f44336; }
                .medium-risk { border-left: 4px solid #ff9800; }
                .low-risk { border-left: 4px solid #4caf50; }
            </style>
        </head>
        <body>
            <h1>ğŸ›¡ï¸ å®‰å…¨ç›‘æ§é¢æ¿</h1>
            
            <div class="dashboard">
                <div class="card">
                    <h3>ğŸ“Š ä»Šæ—¥ç»Ÿè®¡</h3>
                    <p>æ€»äº‹ä»¶æ•°: ${report.summary.totalEvents}</p>
                    <p>æ´»è·ƒç”¨æˆ·: ${report.summary.uniqueUsers}</p>
                    <p>è®¿é—®IP: ${report.summary.uniqueIPs}</p>
                </div>
                
                <div class="card high-risk">
                    <h3>ğŸš¨ é«˜é£é™©å‘Šè­¦</h3>
                    <ul>
                        ${report.alerts.map(alert => 
                            `<li>${alert.type}: ${alert.description}</li>`
                        ).join('')}
                    </ul>
                </div>
                
                <div class="card">
                    <h3>ğŸ” æ”»å‡»æ£€æµ‹</h3>
                    <p>SQLæ³¨å…¥å°è¯•: ${patterns.sqlInjection.length} ä¸ªIP</p>
                    <p>æš´åŠ›ç ´è§£å°è¯•: ${patterns.bruteForce.length} ä¸ªè´¦æˆ·</p>
                </div>
                
                <div class="card">
                    <h3>ğŸ“ˆ è¶‹åŠ¿åˆ†æ</h3>
                    <canvas id="trendChart" width="400" height="200"></canvas>
                </div>
            </div>
        </body>
        </html>
        `;
    }
}
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æš´åŠ›ç ´è§£é˜²æŠ¤ï¼šé¢‘ç‡é™åˆ¶ + å»¶è¿Ÿå“åº” + éªŒè¯ç æœºåˆ¶
ğŸ”¸ è´¦æˆ·é”å®šç­–ç•¥ï¼šæ™ºèƒ½é”å®š + æ¸è¿›å¼æƒ©ç½š + å¤šç§è§£é”æ–¹å¼
ğŸ”¸ å¼‚å¸¸ç™»å½•æ£€æµ‹ï¼šåœ°ç†ä½ç½® + æ—¶é—´æ¨¡å¼ + è®¾å¤‡æŒ‡çº¹ + ç»¼åˆè¯„ä¼°
ğŸ”¸ å¯†ç æ³„éœ²æ£€æµ‹ï¼šæœ¬åœ°æ£€æµ‹ + åœ¨çº¿API + å¤æ‚åº¦è¯„ä¼°
ğŸ”¸ å®‰å…¨å®¡è®¡æ—¥å¿—ï¼šæ ‡å‡†æ ¼å¼ + åˆ†ç±»è®°å½• + å®æ—¶åˆ†æ + æŠ¥è¡¨ç”Ÿæˆ
```

### 6.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ é˜²æŠ¤è¦æœ‰å±‚æ¬¡**
```
ç¬¬ä¸€å±‚ï¼šé¢‘ç‡é™åˆ¶ï¼Œé˜»æ­¢å¤§éƒ¨åˆ†è‡ªåŠ¨æ”»å‡»
ç¬¬äºŒå±‚ï¼šéªŒè¯ç æœºåˆ¶ï¼ŒåŒºåˆ†äººæœº
ç¬¬ä¸‰å±‚ï¼šè´¦æˆ·é”å®šï¼Œå¼ºåˆ¶åœæ­¢æ”»å‡»
ç¬¬å››å±‚ï¼šå¼‚å¸¸æ£€æµ‹ï¼Œå‘ç°é«˜çº§æ”»å‡»
ç¬¬äº”å±‚ï¼šå®¡è®¡æ—¥å¿—ï¼Œäº‹ååˆ†æè¿½è¸ª
```

**ğŸ”¹ å¹³è¡¡å®‰å…¨ä¸ç”¨æˆ·ä½“éªŒ**
```
è¿‡åº¦é˜²æŠ¤ï¼šç”¨æˆ·ä½“éªŒå·®ï¼Œæ­£å¸¸ç”¨æˆ·è¢«è¯¯ä¼¤
é˜²æŠ¤ä¸è¶³ï¼šå®¹æ˜“è¢«æ”»å‡»ï¼Œè´¦æˆ·ä¸å®‰å…¨
åˆç†å¹³è¡¡ï¼šæ ¹æ®é£é™©çº§åˆ«é‡‡å–å¯¹åº”æªæ–½
```

**ğŸ”¹ å®æ—¶æ€§ä¸å‡†ç¡®æ€§**
```
å®æ—¶æ£€æµ‹ï¼šå¿«é€Ÿå“åº”ï¼ŒåŠæ—¶é˜»æ­¢æ”»å‡»
ç¦»çº¿åˆ†æï¼šæ·±åº¦åˆ†æï¼Œå‘ç°å¤æ‚æ¨¡å¼  
ä¸¤è€…ç»“åˆï¼šæ—¢èƒ½å¿«é€Ÿé˜²æŠ¤ï¼Œåˆèƒ½æŒç»­ä¼˜åŒ–
```

### 6.3 å®é™…åº”ç”¨ä»·å€¼


- **ğŸ›¡ï¸ ä¼ä¸šå®‰å…¨**ï¼šä¿æŠ¤å…¬å¸é‡è¦æ•°æ®å’Œç³»ç»Ÿ
- **ğŸ’³ é‡‘èè¡Œä¸š**ï¼šé˜²èŒƒèµ„é‡‘æŸå¤±å’Œæ¬ºè¯ˆ
- **ğŸ¥ åŒ»ç–—ç³»ç»Ÿ**ï¼šä¿æŠ¤æ‚£è€…éšç§ä¿¡æ¯
- **ğŸ“ æ•™è‚²å¹³å°**ï¼šç»´æŠ¤è€ƒè¯•å’Œæˆç»©å®‰å…¨
- **ğŸ›’ ç”µå•†ç½‘ç«™**ï¼šé˜²æ­¢è´¦æˆ·è¢«ç›—å’Œè™šå‡äº¤æ˜“

### 6.4 æœ€ä½³å®è·µå»ºè®®


**ğŸ”§ æŠ€æœ¯å±‚é¢**
- å¤šç§é˜²æŠ¤æ‰‹æ®µç»„åˆä½¿ç”¨
- æ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹è°ƒæ•´å‚æ•°
- å®šæœŸæ›´æ–°æ£€æµ‹è§„åˆ™å’Œå¯†ç åº“
- å»ºç«‹å®Œå–„çš„ç›‘æ§å‘Šè­¦æœºåˆ¶

**ğŸ“Š è¿è¥å±‚é¢**  
- å®šæœŸåˆ†ææ—¥å¿—å‘ç°æ–°çš„æ”»å‡»æ¨¡å¼
- æŒç»­ä¼˜åŒ–é˜²æŠ¤ç­–ç•¥å‡å°‘è¯¯æŠ¥
- å»ºç«‹åº”æ€¥å“åº”æµç¨‹
- åŠ å¼ºç”¨æˆ·å®‰å…¨æ„è¯†æ•™è‚²

**æ ¸å¿ƒè®°å¿†**ï¼š
- å®‰å…¨é˜²æŠ¤è¦å¤šå±‚æ¬¡ï¼Œå•ä¸€æ‰‹æ®µæ˜“è¢«ç»•è¿‡
- å¼‚å¸¸æ£€æµ‹é‡æ¨¡å¼ï¼Œæ­£å¸¸è¡Œä¸ºåšåŸºçº¿
- æ—¥å¿—è®°å½•è¦å…¨é¢ï¼Œäº‹ååˆ†æé æ•°æ®
- å¹³è¡¡ä½“éªŒä¸å®‰å…¨ï¼Œè¿‡çŠ¹ä¸åŠè¦é¿å…