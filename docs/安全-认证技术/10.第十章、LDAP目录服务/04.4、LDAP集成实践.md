---
title: 4ã€LDAPé›†æˆå®è·µ
---
## ğŸ“š ç›®å½•

1. [LDAPç›®å½•æœåŠ¡æ¦‚è¿°](#1-LDAPç›®å½•æœåŠ¡æ¦‚è¿°)
2. [LDAPæŸ¥è¯¢è¯­æ³•è¯¦è§£](#2-LDAPæŸ¥è¯¢è¯­æ³•è¯¦è§£)
3. [Active Directoryé›†æˆå®æˆ˜](#3-Active-Directoryé›†æˆå®æˆ˜)
4. [Spring Security + LDAPé›†æˆ](#4-Spring-Security-LDAPé›†æˆ)
5. [LDAP vs æ•°æ®åº“è®¤è¯å¯¹æ¯”](#5-LDAP-vs-æ•°æ®åº“è®¤è¯å¯¹æ¯”)
6. [ä¼ä¸šç»Ÿä¸€èº«ä»½ç®¡ç†æ–¹æ¡ˆ](#6-ä¼ä¸šç»Ÿä¸€èº«ä»½ç®¡ç†æ–¹æ¡ˆ)
7. [OpenLDAPéƒ¨ç½²ä¸ä¼˜åŒ–](#7-OpenLDAPéƒ¨ç½²ä¸ä¼˜åŒ–)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ“‚ LDAPç›®å½•æœåŠ¡æ¦‚è¿°


### 1.1 LDAPæ˜¯ä»€ä¹ˆï¼Ÿé€šä¿—ç†è§£


> **LDAP**ï¼šLightweight Directory Access Protocolï¼ˆè½»é‡çº§ç›®å½•è®¿é—®åè®®ï¼‰
> 
> **é€šä¿—è§£é‡Š**ï¼šå°±åƒæ˜¯ä¸€ä¸ª**è¶…çº§é€šè®¯å½•**ï¼Œä½†æ¯”é€šè®¯å½•å¼ºå¤§å¾ˆå¤šã€‚æƒ³è±¡ä¸€ä¸‹å…¬å¸çš„ç»„ç»‡æ¶æ„å›¾ï¼Œæ¯ä¸ªäººéƒ½æœ‰å§“åã€éƒ¨é—¨ã€èŒä½ã€ç”µè¯ç­‰ä¿¡æ¯ï¼ŒLDAPå°±æ˜¯ç”¨æ¥å­˜å‚¨å’ŒæŸ¥è¯¢è¿™äº›ä¿¡æ¯çš„"æ•°æ®åº“"ã€‚

**ğŸ” LDAPçš„æœ¬è´¨ç†è§£**

```
ä¼ ç»Ÿæ•°æ®åº“ vs LDAPç›®å½•ï¼š

ä¼ ç»Ÿæ•°æ®åº“ï¼ˆå…³ç³»å‹ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ID    â”‚  å§“å   â”‚  éƒ¨é—¨   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   001   â”‚  å¼ ä¸‰   â”‚  æŠ€æœ¯éƒ¨ â”‚
â”‚   002   â”‚  æå››   â”‚  é”€å”®éƒ¨ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ä¼˜ç‚¹ï¼šå¢åˆ æ”¹æŸ¥éƒ½å¾ˆå¿«
ç¼ºç‚¹ï¼šå±‚çº§å…³ç³»è¡¨è¾¾å›°éš¾

LDAPç›®å½•ï¼ˆæ ‘å½¢ç»“æ„ï¼‰ï¼š
å…¬å¸æ€»éƒ¨
â”œâ”€â”€ æŠ€æœ¯éƒ¨
â”‚   â”œâ”€â”€ å¼€å‘ç»„
â”‚   â”‚   â”œâ”€â”€ å¼ ä¸‰ï¼ˆJavaå·¥ç¨‹å¸ˆï¼‰
â”‚   â”‚   â””â”€â”€ æå››ï¼ˆå‰ç«¯å·¥ç¨‹å¸ˆï¼‰
â”‚   â””â”€â”€ æµ‹è¯•ç»„
â”‚       â””â”€â”€ ç‹äº”ï¼ˆæµ‹è¯•å·¥ç¨‹å¸ˆï¼‰
â””â”€â”€ é”€å”®éƒ¨
    â””â”€â”€ åå—åŒº
        â””â”€â”€ èµµå…­ï¼ˆé”€å”®ç»ç†ï¼‰

ä¼˜ç‚¹ï¼šå¤©ç„¶è¡¨è¾¾ç»„ç»‡æ¶æ„
ç¼ºç‚¹ï¼šå†™å…¥æ“ä½œç›¸å¯¹è¾ƒæ…¢
```

### 1.2 LDAPçš„æ ¸å¿ƒç‰¹ç‚¹


**ğŸŒŸ ä¸ºä»€ä¹ˆä¼ä¸šéƒ½åœ¨ç”¨LDAPï¼Ÿ**

| **ç‰¹ç‚¹** | **ä¼ ç»Ÿæ•°æ®åº“** | **LDAPç›®å½•** | **å®é™…å¥½å¤„** |
|---------|--------------|-------------|-------------|
| **æŸ¥è¯¢æ€§èƒ½** | `è¯»å†™å‡è¡¡` | `è¯»å¤šå†™å°‘ï¼ŒæŸ¥è¯¢æå¿«` | `å‘˜å·¥ä¿¡æ¯æŸ¥è¯¢ç§’çº§å“åº”` |
| **æ•°æ®ç»“æ„** | `è¡¨æ ¼å…³ç³»` | `æ ‘å½¢å±‚çº§` | `å¤©ç„¶åŒ¹é…ä¼ä¸šç»„ç»‡æ¶æ„` |
| **æ ‡å‡†åŒ–** | `å„å®¶ä¸åŒ` | `å›½é™…æ ‡å‡†` | `ä¸åŒç³»ç»Ÿé—´å¯ä»¥äº’é€š` |
| **æ‰©å±•æ€§** | `éœ€è¦è®¾è®¡è¡¨` | `çµæ´»æ·»åŠ å±æ€§` | `æ–°å¢å‘˜å·¥å±æ€§æ— éœ€æ”¹è¡¨ç»“æ„` |

### 1.3 LDAPçš„åŸºæœ¬æ¦‚å¿µ


**ğŸ“ æ ¸å¿ƒæœ¯è¯­é€šä¿—è§£é‡Š**

```
LDAPåŸºæœ¬æ¦‚å¿µè§£é‡Šï¼š

DN (Distinguished Name) - å®Œæ•´åœ°å€
å°±åƒèº«ä»½è¯å·ï¼Œå…¨çƒå”¯ä¸€æ ‡è¯†ä¸€ä¸ªäºº
ä¾‹å¦‚ï¼šcn=å¼ ä¸‰,ou=æŠ€æœ¯éƒ¨,dc=company,dc=com
ç†è§£ï¼šå¼ ä¸‰è¿™ä¸ªäººï¼Œåœ¨æŠ€æœ¯éƒ¨ï¼Œå±äºcompany.comå…¬å¸

RDN (Relative Distinguished Name) - ç›¸å¯¹åœ°å€  
å°±åƒä½ åœ¨éƒ¨é—¨å†…çš„åå­—ï¼Œåœ¨å½“å‰å±‚çº§å”¯ä¸€
ä¾‹å¦‚ï¼šcn=å¼ ä¸‰

Base DN - æœç´¢èµ·ç‚¹
å°±åƒè¯´"ä»æŠ€æœ¯éƒ¨å¼€å§‹æ‰¾"
ä¾‹å¦‚ï¼šou=æŠ€æœ¯éƒ¨,dc=company,dc=com

Scope - æœç´¢èŒƒå›´
baseï¼šåªæ‰¾å½“å‰è¿™ä¸€ä¸ª
oneï¼šæ‰¾ç›´æ¥ä¸‹çº§
subï¼šæ‰¾æ‰€æœ‰ä¸‹çº§ï¼ˆåŒ…æ‹¬ä¸‹çº§çš„ä¸‹çº§ï¼‰
```

---

## 2. ğŸ” LDAPæŸ¥è¯¢è¯­æ³•è¯¦è§£


### 2.1 åŸºæœ¬æœç´¢å‘½ä»¤ç»“æ„


**ğŸ› ï¸ LDAPæœç´¢çš„ä¸‰è¦ç´ **

```bash
# LDAPæœç´¢å‘½ä»¤çš„åŸºæœ¬ç»“æ„
ldapsearch -H ldap://æœåŠ¡å™¨åœ°å€ \
           -D "ç”¨æˆ·DN" \
           -w å¯†ç  \
           -b "æœç´¢èµ·ç‚¹" \
           -s æœç´¢èŒƒå›´ \
           "è¿‡æ»¤æ¡ä»¶" \
           è¿”å›å±æ€§
```

**ğŸ’¡ å®é™…ä¾‹å­ç†è§£**

```bash
# ä¾‹å­1ï¼šæŸ¥æ‰¾æŠ€æœ¯éƒ¨çš„æ‰€æœ‰å‘˜å·¥
ldapsearch -H ldap://company.com:389 \
           -D "cn=admin,dc=company,dc=com" \
           -w admin123 \
           -b "ou=æŠ€æœ¯éƒ¨,dc=company,dc=com" \
           -s sub \
           "(objectClass=person)" \
           cn mail

è§£é‡Šï¼š
- -Hï¼šè¿æ¥åˆ°å…¬å¸LDAPæœåŠ¡å™¨
- -Dï¼šç”¨ç®¡ç†å‘˜èº«ä»½ç™»å½•
- -wï¼šç®¡ç†å‘˜å¯†ç 
- -bï¼šä»æŠ€æœ¯éƒ¨å¼€å§‹æœç´¢
- -s subï¼šæœç´¢æ‰€æœ‰ä¸‹çº§éƒ¨é—¨
- "è¿‡æ»¤æ¡ä»¶"ï¼šæ‰¾æ‰€æœ‰äººå‘˜
- cn mailï¼šåªè¿”å›å§“åå’Œé‚®ç®±
```

### 2.2 Base DNå’Œæœç´¢èŒƒå›´è¯¦è§£


**ğŸ¯ æœç´¢èŒƒå›´(Scope)çš„ä¸‰ç§æ¨¡å¼**

```
ä¼ä¸šç»„ç»‡æ¶æ„ç¤ºä¾‹ï¼š
dc=company,dc=com
â””â”€â”€ ou=æŠ€æœ¯éƒ¨
    â”œâ”€â”€ cn=å¼ ä¸‰ (Javaå·¥ç¨‹å¸ˆ)
    â”œâ”€â”€ cn=æå›› (å‰ç«¯å·¥ç¨‹å¸ˆ)
    â””â”€â”€ ou=å¼€å‘ç»„
        â””â”€â”€ cn=ç‹äº” (æ¶æ„å¸ˆ)

æœç´¢èŒƒå›´å¯¹æ¯”ï¼š

1. baseèŒƒå›´ï¼ˆåªæ‰¾å½“å‰èŠ‚ç‚¹ï¼‰
æœç´¢ï¼šou=æŠ€æœ¯éƒ¨,dc=company,dc=comï¼Œscope=base
ç»“æœï¼šåªè¿”å›æŠ€æœ¯éƒ¨æœ¬èº«çš„ä¿¡æ¯

2. oneèŒƒå›´ï¼ˆåªæ‰¾ç›´æ¥ä¸‹çº§ï¼‰  
æœç´¢ï¼šou=æŠ€æœ¯éƒ¨,dc=company,dc=comï¼Œscope=one
ç»“æœï¼šå¼ ä¸‰ã€æå››ã€å¼€å‘ç»„ï¼ˆä½†ä¸åŒ…æ‹¬ç‹äº”ï¼‰

3. subèŒƒå›´ï¼ˆæ‰¾æ‰€æœ‰ä¸‹çº§ï¼‰
æœç´¢ï¼šou=æŠ€æœ¯éƒ¨,dc=company,dc=comï¼Œscope=sub  
ç»“æœï¼šå¼ ä¸‰ã€æå››ã€å¼€å‘ç»„ã€ç‹äº”ï¼ˆå…¨éƒ¨éƒ½æ‰¾åˆ°ï¼‰
```

### 2.3 è¿‡æ»¤å™¨è¯­æ³•è¯¦è§£


**ğŸ” è¿‡æ»¤å™¨è¯­æ³•è§„åˆ™**

```
è¿‡æ»¤å™¨è¯­æ³•è§„åˆ™ï¼š

åŸºæœ¬æ ¼å¼ï¼š(å±æ€§ è¿ç®—ç¬¦ å€¼)

1. ç²¾ç¡®åŒ¹é… (=)
(cn=å¼ ä¸‰)           # å§“åç­‰äºå¼ ä¸‰
(department=æŠ€æœ¯éƒ¨)  # éƒ¨é—¨ç­‰äºæŠ€æœ¯éƒ¨

2. æ¨¡ç³ŠåŒ¹é… (~=)  
(cn~=å¼ )            # å§“ååŒ…å«"å¼ "å­—

3. å¤§äºç­‰äº (>=)
(employeeNumber>=1000) # å·¥å·å¤§äºç­‰äº1000

4. å°äºç­‰äº (<=)
(createTime<=20231201) # åˆ›å»ºæ—¶é—´å°äºç­‰äºæŸæ—¥æœŸ

5. é€šé…ç¬¦ (*)
(mail=*@company.com)   # é‚®ç®±ä»¥@company.comç»“å°¾
(cn=å¼ *)               # å§“åä»¥"å¼ "å¼€å¤´
```

**ğŸ§© é€»è¾‘è¿ç®—ç¬¦ç»„åˆ**

```
é€»è¾‘è¿ç®—ç¬¦ï¼š

1. ä¸è¿ç®— (&) - åŒæ—¶æ»¡è¶³å¤šä¸ªæ¡ä»¶
(&(cn=å¼ ä¸‰)(department=æŠ€æœ¯éƒ¨))
# å§“åæ˜¯å¼ ä¸‰ AND éƒ¨é—¨æ˜¯æŠ€æœ¯éƒ¨

2. æˆ–è¿ç®— (|) - æ»¡è¶³ä»»ä¸€æ¡ä»¶
(|(department=æŠ€æœ¯éƒ¨)(department=é”€å”®éƒ¨))
# éƒ¨é—¨æ˜¯æŠ€æœ¯éƒ¨ OR éƒ¨é—¨æ˜¯é”€å”®éƒ¨

3. éè¿ç®— (!) - ä¸æ»¡è¶³æ¡ä»¶
(!(department=æŠ€æœ¯éƒ¨))
# éƒ¨é—¨ä¸æ˜¯æŠ€æœ¯éƒ¨

4. å¤æ‚ç»„åˆ
(&(|(cn=å¼ *)(cn=æ*))(department=æŠ€æœ¯éƒ¨))
# (å§“å¼  OR å§“æ) AND åœ¨æŠ€æœ¯éƒ¨
```

### 2.4 åˆ†é¡µä¸æœç´¢é™åˆ¶


**ğŸ“„ å¤„ç†å¤§é‡æœç´¢ç»“æœ**

```bash
# åˆ†é¡µæœç´¢ç¤ºä¾‹
ldapsearch -H ldap://company.com:389 \
           -D "cn=admin,dc=company,dc=com" \
           -w admin123 \
           -b "dc=company,dc=com" \
           -s sub \
           -z 100 \                    # é™åˆ¶è¿”å›100æ¡è®°å½•
           -E pr=50/noprompt \         # æ¯é¡µ50æ¡ï¼Œè‡ªåŠ¨ç¿»é¡µ
           "(objectClass=person)" \
           cn mail department

è§£é‡Šï¼š
-z 100ï¼šæœ€å¤šè¿”å›100æ¡è®°å½•
-E pr=50ï¼šå¯ç”¨åˆ†é¡µï¼Œæ¯é¡µ50æ¡
nopromptï¼šä¸ç­‰å¾…ç”¨æˆ·ç¡®è®¤ï¼Œè‡ªåŠ¨ç¿»é¡µ
```

### 2.5 å¸¸è§æœç´¢å®æˆ˜æ¡ˆä¾‹


**ğŸ¯ ä¼ä¸šå¸¸ç”¨æœç´¢åœºæ™¯**

```bash
# åœºæ™¯1ï¼šæ‰¾åˆ°æ‰€æœ‰Javaå·¥ç¨‹å¸ˆ
ldapsearch -b "dc=company,dc=com" \
           "(&(objectClass=person)(title=*Java*))" \
           cn mail title

# åœºæ™¯2ï¼šæ‰¾æŠ€æœ¯éƒ¨é—¨çš„æ‰€æœ‰ç®¡ç†è€…
ldapsearch -b "ou=æŠ€æœ¯éƒ¨,dc=company,dc=com" \
           "(&(objectClass=person)(|(title=*ç»ç†*)(title=*æ€»ç›‘*)))" \
           cn title department

# åœºæ™¯3ï¼šæ‰¾æœ€è¿‘å…¥èŒçš„å‘˜å·¥ï¼ˆ30å¤©å†…ï¼‰
ldapsearch -b "dc=company,dc=com" \
           "(&(objectClass=person)(createTimestamp>=20231101000000Z))" \
           cn mail createTimestamp

# åœºæ™¯4ï¼šæ‰¾æœ‰é‚®ç®±ä½†æ²¡æœ‰æ‰‹æœºå·çš„å‘˜å·¥
ldapsearch -b "dc=company,dc=com" \
           "(&(objectClass=person)(mail=*)(!(mobile=*)))" \
           cn mail mobile

# åœºæ™¯5ï¼šæŒ‰éƒ¨é—¨ç»Ÿè®¡äººæ•°ï¼ˆåªè¿”å›éƒ¨é—¨ä¿¡æ¯ï¼‰
ldapsearch -b "dc=company,dc=com" \
           -s one \
           "(objectClass=organizationalUnit)" \
           ou description
```

---

## 3. ğŸ¢ Active Directoryé›†æˆå®æˆ˜


### 3.1 Active Directoryæ˜¯ä»€ä¹ˆï¼Ÿ


> **Active Directory (AD)**ï¼šå¾®è½¯å¼€å‘çš„ç›®å½•æœåŠ¡ï¼Œæ˜¯LDAPçš„ä¸€ä¸ªå…·ä½“å®ç°
> 
> **é€šä¿—ç†è§£**ï¼šå¦‚æœè¯´LDAPæ˜¯"é€šè®¯å½•çš„æ ‡å‡†æ ¼å¼"ï¼Œé‚£ä¹ˆADå°±æ˜¯"å¾®è½¯ç‰ˆçš„è¶…çº§é€šè®¯å½•è½¯ä»¶"

**ğŸ”— ADä¸LDAPçš„å…³ç³»**

```
LDAPä¸Active Directoryå…³ç³»å›¾ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LDAPåè®®                         â”‚
â”‚            (å›½é™…æ ‡å‡†ï¼Œå°±åƒHTTPåè®®)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   OpenLDAP      â”‚ Active Directoryâ”‚   å…¶ä»–LDAPå®ç°   â”‚
â”‚  (å¼€æºå®ç°)     â”‚   (å¾®è½¯å®ç°)    â”‚                 â”‚
â”‚                 â”‚                 â”‚                 â”‚
â”‚â€¢ å…è´¹å¼€æº       â”‚â€¢ Windowsé›†æˆ    â”‚â€¢ IBM Directory  â”‚
â”‚â€¢ Linuxå‹å¥½      â”‚â€¢ GUIç®¡ç†ç•Œé¢    â”‚â€¢ Oracle Directoryâ”‚
â”‚â€¢ é…ç½®å¤æ‚       â”‚â€¢ åŠŸèƒ½ä¸°å¯Œ       â”‚â€¢ ç­‰ç­‰...        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Active Directoryé›†æˆè¦ç‚¹


**ğŸ¯ ADé›†æˆçš„æ ¸å¿ƒé…ç½®**

```java
// Spring Bootä¸­é…ç½®ADè¿æ¥
# application.yml
spring:
  ldap:
    urls: ldap://ad.company.com:389
    base: dc=company,dc=com
    username: administrator@company.com  # ADä½¿ç”¨é‚®ç®±æ ¼å¼
    password: admin123
    
# ADç‰¹æ®Šé…ç½®
ldap:
  ad:
    domain: company.com                  # ADåŸŸå
    server: ad.company.com              # ADæœåŠ¡å™¨
    search-base: dc=company,dc=com      # æœç´¢æ ¹ç›®å½•
    user-search-filter: (sAMAccountName={0})  # ADç”¨æˆ·åè¿‡æ»¤å™¨
    group-search-base: ou=Groups,dc=company,dc=com  # ç»„æœç´¢ä½ç½®
```

**âš ï¸ ADé›†æˆæ³¨æ„äº‹é¡¹**

| **é—®é¢˜** | **åŸå› ** | **è§£å†³æ–¹æ¡ˆ** |
|---------|---------|-------------|
| `è¿æ¥è¶…æ—¶` | `ADæœåŠ¡å™¨ç«¯å£æœªå¼€æ”¾` | `æ£€æŸ¥389/636ç«¯å£ï¼Œé…ç½®é˜²ç«å¢™` |
| `è®¤è¯å¤±è´¥` | `ç”¨æˆ·åæ ¼å¼ä¸å¯¹` | `ä½¿ç”¨sAMAccountNameæˆ–UPNæ ¼å¼` |
| `SSLè¿æ¥é—®é¢˜` | `è¯ä¹¦ä¸å—ä¿¡ä»»` | `å¯¼å…¥ADè¯ä¹¦æˆ–ç¦ç”¨SSLéªŒè¯` |
| `æƒé™ä¸è¶³` | `æœç´¢ç”¨æˆ·æƒé™ä¸å¤Ÿ` | `ä½¿ç”¨åŸŸç®¡ç†å‘˜è´¦å·æˆ–æˆäºˆæŸ¥è¯¢æƒé™` |

### 3.3 ADç‰¹æœ‰å±æ€§å’ŒæŸ¥è¯¢


**ğŸ“ ADå¸¸ç”¨å±æ€§è¯´æ˜**

```
Active Directoryç‰¹æœ‰å±æ€§ï¼š

ç”¨æˆ·å±æ€§ï¼š
sAMAccountName    # ç™»å½•ç”¨æˆ·åï¼ˆå¦‚ï¼šzhangsanï¼‰
userPrincipalName # å®Œæ•´ç”¨æˆ·åï¼ˆå¦‚ï¼šzhangsan@company.comï¼‰
displayName       # æ˜¾ç¤ºåç§°ï¼ˆå¦‚ï¼šå¼ ä¸‰ï¼‰
mail             # é‚®ç®±åœ°å€
department       # éƒ¨é—¨
title            # èŒä½
manager          # ç›´æ¥ä¸Šçº§
memberOf         # æ‰€å±ç»„

ç»„å±æ€§ï¼š
cn               # ç»„å
member           # ç»„æˆå‘˜åˆ—è¡¨
groupType        # ç»„ç±»å‹

è®¡ç®—æœºå±æ€§ï¼š
dNSHostName      # è®¡ç®—æœºDNSåç§°
operatingSystem  # æ“ä½œç³»ç»Ÿ
```

**ğŸ” ADä¸“ç”¨æŸ¥è¯¢ç¤ºä¾‹**

```bash
# æŸ¥æ‰¾ç‰¹å®šç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯
ldapsearch -H ldap://ad.company.com \
           -D "administrator@company.com" \
           -w admin123 \
           -b "dc=company,dc=com" \
           "(sAMAccountName=zhangsan)" \
           displayName mail department title manager

# æŸ¥æ‰¾æŸä¸ªç»„çš„æ‰€æœ‰æˆå‘˜
ldapsearch -H ldap://ad.company.com \
           -D "administrator@company.com" \
           -w admin123 \
           -b "cn=æŠ€æœ¯éƒ¨,ou=Groups,dc=company,dc=com" \
           "(objectClass=group)" \
           member

# æŸ¥æ‰¾ç”¨æˆ·æ‰€å±çš„æ‰€æœ‰ç»„
ldapsearch -H ldap://ad.company.com \
           -D "administrator@company.com" \
           -w admin123 \
           -b "dc=company,dc=com" \
           "(sAMAccountName=zhangsan)" \
           memberOf
```

---

## 4. ğŸ” Spring Security + LDAPé›†æˆ


### 4.1 ä¸ºä»€ä¹ˆè¦é›†æˆLDAPï¼Ÿ


> **åœºæ™¯ç†è§£**ï¼šå…¬å¸æœ‰1000ä¸ªå‘˜å·¥ï¼Œå¦‚æœæ¯ä¸ªç³»ç»Ÿéƒ½è¦å•ç‹¬ç®¡ç†ç”¨æˆ·è´¦å·ï¼Œé‚£å°±æ˜¯å™©æ¢¦ï¼
> 
> æœ‰äº†LDAPé›†æˆï¼Œå‘˜å·¥åªéœ€è¦è®°ä½ä¸€ä¸ªå¯†ç ï¼Œå°±èƒ½ç™»å½•æ‰€æœ‰å…¬å¸ç³»ç»Ÿã€‚

**ğŸ¯ é›†æˆåçš„ç”¨æˆ·ä½“éªŒ**

```
æ²¡æœ‰LDAPé›†æˆï¼š
å‘˜å·¥å¼ ä¸‰éœ€è¦è®°ä½ï¼š
â€¢ OAç³»ç»Ÿï¼šzhangsan / oa123
â€¢ é‚®ä»¶ç³»ç»Ÿï¼šzhang.san / mail456  
â€¢ é¡¹ç›®ç³»ç»Ÿï¼šz.san / project789
â€¢ æŠ¥é”€ç³»ç»Ÿï¼šzs / expense012
â€¢ ...è¿˜æœ‰åå‡ ä¸ªç³»ç»Ÿ

æœ‰LDAPé›†æˆï¼š
å‘˜å·¥å¼ ä¸‰åªéœ€è¦è®°ä½ï¼š
â€¢ åŸŸè´¦å·ï¼šzhangsan@company.com / ç»Ÿä¸€å¯†ç 123
â€¢ ç”¨è¿™ä¸€ä¸ªè´¦å·ç™»å½•æ‰€æœ‰ç³»ç»Ÿï¼
```

### 4.2 Spring Securityé›†æˆLDAPè¯¦ç»†æ­¥éª¤


**ğŸ“‹ ç¬¬ä¸€æ­¥ï¼šæ·»åŠ ä¾èµ–**

```xml
<!-- pom.xml -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-security</artifactId>
</dependency>
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-data-ldap</artifactId>
</dependency>
<dependency>
    <groupId>org.springframework.ldap</groupId>
    <artifactId>spring-ldap-core</artifactId>
</dependency>
<dependency>
    <groupId>org.springframework.security</groupId>
    <artifactId>spring-security-ldap</artifactId>
</dependency>
```

**âš™ï¸ ç¬¬äºŒæ­¥ï¼šåŸºç¡€é…ç½®**

```yaml
# application.yml
spring:
  ldap:
    urls: ldap://company.com:389
    base: dc=company,dc=com
    username: cn=admin,dc=company,dc=com
    password: admin123
    
# è‡ªå®šä¹‰LDAPé…ç½®
app:
  ldap:
    user-search-base: ou=ç”¨æˆ·,dc=company,dc=com
    user-search-filter: (uid={0})
    group-search-base: ou=ç»„,dc=company,dc=com
    group-search-filter: (member={0})
```

**ğŸ”§ ç¬¬ä¸‰æ­¥ï¼šSecurityé…ç½®ç±»**

```java
@Configuration
@EnableWebSecurity
public class LdapSecurityConfig {

    @Value("${spring.ldap.urls}")
    private String ldapUrl;
    
    @Value("${app.ldap.user-search-base}")
    private String userSearchBase;
    
    @Value("${app.ldap.user-search-filter}")
    private String userSearchFilter;

    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            .authorizeHttpRequests(auth -> auth
                .requestMatchers("/public/**").permitAll()
                .requestMatchers("/admin/**").hasRole("ADMIN")
                .anyRequest().authenticated()
            )
            .formLogin(form -> form
                .loginPage("/login")
                .defaultSuccessUrl("/dashboard")
                .permitAll()
            )
            .logout(logout -> logout
                .logoutSuccessUrl("/login?logout")
                .permitAll()
            );
        
        return http.build();
    }

    @Bean
    public AuthenticationManager authenticationManager() throws Exception {
        return new ProviderManager(ldapAuthenticationProvider());
    }

    @Bean
    public LdapAuthenticationProvider ldapAuthenticationProvider() {
        // åˆ›å»ºLDAPè®¤è¯æä¾›è€…
        LdapAuthenticationProvider provider = new LdapAuthenticationProvider(
            bindAuthenticator(), 
            authoritiesPopulator()
        );
        return provider;
    }

    @Bean
    public BindAuthenticator bindAuthenticator() {
        BindAuthenticator authenticator = new BindAuthenticator(contextSource());
        // è®¾ç½®ç”¨æˆ·æœç´¢
        authenticator.setUserSearch(userSearch());
        return authenticator;
    }

    @Bean
    public FilterBasedLdapUserSearch userSearch() {
        return new FilterBasedLdapUserSearch(
            userSearchBase,     // æœç´¢åŸºç¡€è·¯å¾„
            userSearchFilter,   // æœç´¢è¿‡æ»¤å™¨
            contextSource()
        );
    }

    @Bean
    public LdapAuthoritiesPopulator authoritiesPopulator() {
        // ä»LDAPç»„ä¿¡æ¯ä¸­è·å–ç”¨æˆ·æƒé™
        DefaultLdapAuthoritiesPopulator populator = 
            new DefaultLdapAuthoritiesPopulator(
                contextSource(),
                "ou=ç»„,dc=company,dc=com"  // ç»„æœç´¢åŸºç¡€è·¯å¾„
            );
        populator.setGroupSearchFilter("(member={0})");
        populator.setRolePrefix("ROLE_");
        populator.setSearchSubtree(true);
        return populator;
    }

    @Bean
    public LdapContextSource contextSource() {
        LdapContextSource source = new LdapContextSource();
        source.setUrl(ldapUrl);
        source.setBase("dc=company,dc=com");
        source.setUserDn("cn=admin,dc=company,dc=com");
        source.setPassword("admin123");
        return source;
    }
}
```

**ğŸ¯ ç¬¬å››æ­¥ï¼šåˆ›å»ºç™»å½•æ§åˆ¶å™¨**

```java
@Controller
public class LoginController {

    @GetMapping("/login")
    public String loginPage() {
        return "login";  // è¿”å›ç™»å½•é¡µé¢
    }

    @GetMapping("/dashboard")
    public String dashboard(Authentication auth, Model model) {
        // è·å–LDAPç”¨æˆ·ä¿¡æ¯
        LdapUserDetails userDetails = (LdapUserDetails) auth.getPrincipal();
        
        model.addAttribute("username", userDetails.getUsername());
        model.addAttribute("authorities", userDetails.getAuthorities());
        
        return "dashboard";
    }

    @GetMapping("/profile")
    @PreAuthorize("hasRole('USER')")
    public String profile(Authentication auth, Model model) {
        // ä»LDAPè·å–ç”¨æˆ·è¯¦ç»†ä¿¡æ¯
        String username = auth.getName();
        UserInfo userInfo = ldapService.getUserInfo(username);
        
        model.addAttribute("userInfo", userInfo);
        return "profile";
    }
}
```

### 4.3 LDAPç”¨æˆ·ä¿¡æ¯æœåŠ¡


```java
@Service
public class LdapUserService {

    @Autowired
    private LdapTemplate ldapTemplate;

    /**
     * æ ¹æ®ç”¨æˆ·åè·å–ç”¨æˆ·è¯¦ç»†ä¿¡æ¯
     */
    public UserInfo getUserInfo(String username) {
        String filter = "(uid=" + username + ")";
        
        return ldapTemplate.search(
            "ou=ç”¨æˆ·,dc=company,dc=com",
            filter,
            new UserInfoMapper()
        ).stream().findFirst().orElse(null);
    }

    /**
     * è·å–ç”¨æˆ·æ‰€å±ç»„
     */
    public List<String> getUserGroups(String userDn) {
        String filter = "(member=" + userDn + ")";
        
        return ldapTemplate.search(
            "ou=ç»„,dc=company,dc=com",
            filter,
            (AttributesMapper<String>) attrs -> 
                attrs.get("cn").get().toString()
        );
    }

    /**
     * LDAPå±æ€§æ˜ å°„å™¨
     */
    private static class UserInfoMapper implements AttributesMapper<UserInfo> {
        @Override
        public UserInfo mapFromAttributes(Attributes attrs) throws NamingException {
            UserInfo user = new UserInfo();
            user.setUsername(getAttributeValue(attrs, "uid"));
            user.setDisplayName(getAttributeValue(attrs, "displayName"));
            user.setEmail(getAttributeValue(attrs, "mail"));
            user.setDepartment(getAttributeValue(attrs, "department"));
            user.setTitle(getAttributeValue(attrs, "title"));
            return user;
        }
        
        private String getAttributeValue(Attributes attrs, String attrName) {
            try {
                Attribute attr = attrs.get(attrName);
                return attr != null ? attr.get().toString() : null;
            } catch (NamingException e) {
                return null;
            }
        }
    }
}

// ç”¨æˆ·ä¿¡æ¯å®ä½“ç±»
@Data
public class UserInfo {
    private String username;
    private String displayName;
    private String email;
    private String department;
    private String title;
    private List<String> groups;
}
```

---

## 5. âš–ï¸ LDAP vs æ•°æ®åº“è®¤è¯å¯¹æ¯”


### 5.1 ä¸¤ç§è®¤è¯æ–¹å¼å¯¹æ¯”


**ğŸ” è®¤è¯æ–¹å¼æœ¬è´¨åŒºåˆ«**

```
æ•°æ®åº“è®¤è¯æ¨¡å¼ï¼š
åº”ç”¨ç³»ç»ŸA â”€â”€â†’ æœ¬åœ°æ•°æ®åº“A â”€â”€â†’ ç”¨æˆ·è¡¨A
åº”ç”¨ç³»ç»ŸB â”€â”€â†’ æœ¬åœ°æ•°æ®åº“B â”€â”€â†’ ç”¨æˆ·è¡¨B  
åº”ç”¨ç³»ç»ŸC â”€â”€â†’ æœ¬åœ°æ•°æ®åº“C â”€â”€â†’ ç”¨æˆ·è¡¨C

é—®é¢˜ï¼šæ¯ä¸ªç³»ç»Ÿéƒ½è¦ç»´æŠ¤è‡ªå·±çš„ç”¨æˆ·æ•°æ®ï¼

LDAPè®¤è¯æ¨¡å¼ï¼š
åº”ç”¨ç³»ç»ŸA â”€â”€â”
åº”ç”¨ç³»ç»ŸB â”€â”€â”¼â”€â”€â†’ ç»Ÿä¸€LDAPæœåŠ¡å™¨ â”€â”€â†’ ä¼ä¸šç”¨æˆ·ç›®å½•
åº”ç”¨ç³»ç»ŸC â”€â”€â”˜

ä¼˜åŠ¿ï¼šæ‰€æœ‰ç³»ç»Ÿå…±äº«ä¸€å¥—ç”¨æˆ·æ•°æ®ï¼
```

### 5.2 è¯¦ç»†å¯¹æ¯”åˆ†æ


| **å¯¹æ¯”é¡¹** | **æ•°æ®åº“è®¤è¯** | **LDAPè®¤è¯** | **æ¨èåœºæ™¯** |
|-----------|---------------|-------------|-------------|
| **ç”¨æˆ·ç®¡ç†** | `æ¯ä¸ªç³»ç»Ÿç‹¬ç«‹ç»´æŠ¤` | `ç»Ÿä¸€ç”¨æˆ·ç›®å½•` | `LDAPé€‚åˆä¼ä¸šçº§` |
| **å¯†ç ç®¡ç†** | `ç”¨æˆ·è¦è®°ä½å¤šä¸ªå¯†ç ` | `ä¸€ä¸ªå¯†ç ç™»å½•æ‰€æœ‰ç³»ç»Ÿ` | `LDAPæ˜æ˜¾æ›´å¥½` |
| **æ•°æ®ä¸€è‡´æ€§** | `å®¹æ˜“å‡ºç°æ•°æ®ä¸ä¸€è‡´` | `ç»Ÿä¸€æ•°æ®æºï¼Œä¸€è‡´æ€§å¥½` | `LDAPä¿è¯ä¸€è‡´æ€§` |
| **å¼€å‘å¤æ‚åº¦** | `ç®€å•ï¼Œç›´æ¥æŸ¥æ•°æ®åº“` | `éœ€è¦äº†è§£LDAPåè®®` | `æ•°æ®åº“æ›´ç®€å•` |
| **æ€§èƒ½è¡¨ç°** | `è¯»å†™é€Ÿåº¦å¿«` | `è¯»å¿«å†™æ…¢ï¼Œé€‚åˆè¯»å¤šå†™å°‘` | `çœ‹å…·ä½“éœ€æ±‚` |
| **æ‰©å±•æ€§** | `éœ€è¦ä¿®æ”¹è¡¨ç»“æ„` | `çµæ´»æ·»åŠ å±æ€§` | `LDAPæ‰©å±•æ€§æ›´å¥½` |
| **æ ‡å‡†åŒ–** | `å„ç³»ç»Ÿå®ç°ä¸åŒ` | `éµå¾ªå›½é™…æ ‡å‡†` | `LDAPæ ‡å‡†åŒ–ç¨‹åº¦é«˜` |

### 5.3 å®é™…ä½¿ç”¨å»ºè®®


**ğŸ¯ é€‰æ‹©å†³ç­–æŒ‡å—**

```
é€‰æ‹©æ•°æ®åº“è®¤è¯çš„åœºæ™¯ï¼š
âœ… å°å‹åº”ç”¨ï¼ˆç”¨æˆ·<100äººï¼‰
âœ… å•ä¸€ç³»ç»Ÿï¼Œä¸éœ€è¦ä¸å…¶ä»–ç³»ç»Ÿé›†æˆ
âœ… å¼€å‘å›¢é˜Ÿå¯¹LDAPä¸ç†Ÿæ‚‰
âœ… éœ€è¦é¢‘ç¹çš„ç”¨æˆ·ä¿¡æ¯å†™å…¥æ“ä½œ
âœ… å¯¹è®¤è¯æ€§èƒ½è¦æ±‚æé«˜

é€‰æ‹©LDAPè®¤è¯çš„åœºæ™¯ï¼š
âœ… ä¼ä¸šçº§åº”ç”¨ï¼ˆç”¨æˆ·>100äººï¼‰
âœ… éœ€è¦å¤šç³»ç»Ÿç»Ÿä¸€è®¤è¯
âœ… ä¸ADæˆ–å…¶ä»–ä¼ä¸šç³»ç»Ÿé›†æˆ
âœ… ç”¨æˆ·ä¿¡æ¯å˜æ›´ä¸é¢‘ç¹
âœ… éœ€è¦å±‚çº§åŒ–çš„ç»„ç»‡æ¶æ„ç®¡ç†
```

**ğŸ’¡ æ··åˆä½¿ç”¨æ–¹æ¡ˆ**

```java
@Service
public class HybridAuthService {

    @Autowired
    private LdapTemplate ldapTemplate;
    
    @Autowired
    private UserRepository userRepository;

    /**
     * æ··åˆè®¤è¯ï¼šå…ˆLDAPéªŒè¯ï¼Œå†æœ¬åœ°è¡¥å……ä¿¡æ¯
     */
    public UserDetails authenticate(String username, String password) {
        // ç¬¬ä¸€æ­¥ï¼šLDAPéªŒè¯ç”¨æˆ·åå¯†ç 
        boolean ldapAuth = validateWithLdap(username, password);
        
        if (ldapAuth) {
            // ç¬¬äºŒæ­¥ï¼šä»LDAPè·å–åŸºæœ¬ä¿¡æ¯
            UserInfo ldapUser = getLdapUserInfo(username);
            
            // ç¬¬ä¸‰æ­¥ï¼šä»æœ¬åœ°æ•°æ®åº“è·å–ä¸šåŠ¡ç›¸å…³ä¿¡æ¯
            User localUser = userRepository.findByUsername(username);
            
            // ç¬¬å››æ­¥ï¼šåˆå¹¶ä¿¡æ¯
            return buildUserDetails(ldapUser, localUser);
        }
        
        throw new BadCredentialsException("è®¤è¯å¤±è´¥");
    }
    
    private boolean validateWithLdap(String username, String password) {
        // LDAPå¯†ç éªŒè¯é€»è¾‘
        try {
            String userDn = "uid=" + username + ",ou=ç”¨æˆ·,dc=company,dc=com";
            DirContext ctx = ldapTemplate.getContextSource()
                .getContext(userDn, password);
            ctx.close();
            return true;
        } catch (Exception e) {
            return false;
        }
    }
}
```

---

## 6. ğŸ¢ ä¼ä¸šç»Ÿä¸€èº«ä»½ç®¡ç†æ–¹æ¡ˆ


### 6.1 ä»€ä¹ˆæ˜¯ç»Ÿä¸€èº«ä»½ç®¡ç†ï¼Ÿ


> **ç»Ÿä¸€èº«ä»½ç®¡ç†(Identity Management)**ï¼šè®©å‘˜å·¥ç”¨ä¸€ä¸ªè´¦å·å¯†ç ï¼Œè®¿é—®å…¬å¸æ‰€æœ‰ç³»ç»Ÿçš„è§£å†³æ–¹æ¡ˆ
> 
> **é€šä¿—æ¯”å–»**ï¼šå°±åƒä¸€æŠŠä¸‡èƒ½é’¥åŒ™ï¼Œèƒ½å¼€å…¬å¸æ‰€æœ‰çš„é—¨

**ğŸ”‘ ç»Ÿä¸€èº«ä»½ç®¡ç†çš„ä»·å€¼**

```
å‘˜å·¥è§†è§’çš„å˜åŒ–ï¼š

ä¼ ç»Ÿæ¨¡å¼ï¼ˆç—›è‹¦ï¼‰ï¼š
æ—©ä¸Š8ç‚¹ï¼šç™»å½•è€ƒå‹¤ç³»ç»Ÿ - zhangsan/123456
8ç‚¹30åˆ†ï¼šç™»å½•é‚®ä»¶ç³»ç»Ÿ - zhang.san/abcdef  
9ç‚¹ï¼šç™»å½•OAç³»ç»Ÿ - zs001/qwerty
10ç‚¹ï¼šç™»å½•é¡¹ç›®ç³»ç»Ÿ - å¼ ä¸‰/password123
...ä¸€å¤©è¦è¾“å…¥åå‡ æ¬¡ä¸åŒçš„ç”¨æˆ·åå¯†ç ï¼

ç»Ÿä¸€èº«ä»½ç®¡ç†ï¼ˆèˆ’çˆ½ï¼‰ï¼š
æ—©ä¸Š8ç‚¹ï¼šåŸŸç™»å½• - zhangsan@company.com/å”¯ä¸€å¯†ç 
ç„¶åï¼šè‡ªåŠ¨ç™»å½•æ‰€æœ‰ç³»ç»Ÿï¼Œæ— éœ€å†æ¬¡è¾“å…¥å¯†ç ï¼
```

### 6.2 ä¼ä¸šç»Ÿä¸€èº«ä»½ç®¡ç†æ¶æ„


**ğŸ—ï¸ å®Œæ•´æ¶æ„å›¾**

```
ä¼ä¸šç»Ÿä¸€èº«ä»½ç®¡ç†æ¶æ„ï¼š

                    å‘˜å·¥ç»ˆç«¯
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Webåº”ç”¨ç½‘å…³                           â”‚
â”‚              (ç»Ÿä¸€è®¤è¯å…¥å£)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            èº«ä»½è®¤è¯æœåŠ¡                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚   LDAP    â”‚  â”‚   SAML    â”‚  â”‚   OAuth   â”‚       â”‚
â”‚  â”‚   è®¤è¯    â”‚  â”‚   è®¤è¯    â”‚  â”‚   è®¤è¯    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ç”¨æˆ·ç›®å½•å­˜å‚¨                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚Active       â”‚  â”‚  OpenLDAP   â”‚  â”‚  æ•°æ®åº“     â”‚  â”‚
â”‚  â”‚Directory    â”‚  â”‚             â”‚  â”‚  åŒæ­¥       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ä¸šåŠ¡åº”ç”¨ç³»ç»Ÿ                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ OAç³»ç»Ÿ    â”‚  â”‚ é‚®ä»¶ç³»ç»Ÿ  â”‚  â”‚ é¡¹ç›®ç³»ç»Ÿ  â”‚  ...  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 ç»Ÿä¸€èº«ä»½ç®¡ç†å®æ–½æ­¥éª¤


**ğŸ“‹ ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€ç¯å¢ƒæ­å»º**

```yaml
# ç¬¬ä¸€æ­¥ï¼šéƒ¨ç½²LDAPæœåŠ¡å™¨
# docker-compose.yml
version: '3'
services:
  openldap:
    image: osixia/openldap:latest
    container_name: openldap
    ports:
      - "389:389"
      - "636:636"
    environment:
      LDAP_ORGANISATION: "å…¬å¸åç§°"
      LDAP_DOMAIN: "company.com"
      LDAP_ADMIN_PASSWORD: "admin123"
    volumes:
      - ./ldap/database:/var/lib/ldap
      - ./ldap/config:/etc/ldap/slapd.d

  phpldapadmin:
    image: osixia/phpldapadmin:latest
    container_name: phpldapadmin
    ports:
      - "8080:80"
    environment:
      PHPLDAPADMIN_LDAP_HOSTS: openldap
```

**ğŸ”§ ç¬¬äºŒæ­¥ï¼šç»„ç»‡æ¶æ„è§„åˆ’**

```ldif
# company.ldif - ä¼ä¸šç»„ç»‡æ¶æ„åˆå§‹åŒ–
dn: dc=company,dc=com
objectClass: top
objectClass: dcObject
objectClass: organization
o: å…¬å¸åç§°
dc: company

# åˆ›å»ºç»„ç»‡å•å…ƒ
dn: ou=ç”¨æˆ·,dc=company,dc=com
objectClass: organizationalUnit
ou: ç”¨æˆ·

dn: ou=ç»„,dc=company,dc=com
objectClass: organizationalUnit
ou: ç»„

dn: ou=æŠ€æœ¯éƒ¨,dc=company,dc=com
objectClass: organizationalUnit
ou: æŠ€æœ¯éƒ¨

dn: ou=é”€å”®éƒ¨,dc=company,dc=com
objectClass: organizationalUnit
ou: é”€å”®éƒ¨

# åˆ›å»ºç”¨æˆ·ç»„
dn: cn=æŠ€æœ¯éƒ¨å‘˜å·¥,ou=ç»„,dc=company,dc=com
objectClass: groupOfNames
cn: æŠ€æœ¯éƒ¨å‘˜å·¥
description: æŠ€æœ¯éƒ¨æ‰€æœ‰å‘˜å·¥

dn: cn=ç®¡ç†å‘˜,ou=ç»„,dc=company,dc=com
objectClass: groupOfNames
cn: ç®¡ç†å‘˜
description: ç³»ç»Ÿç®¡ç†å‘˜
```

**ğŸ‘¥ ç¬¬ä¸‰æ­¥ï¼šç”¨æˆ·æ•°æ®è¿ç§»**

```java
@Service
public class UserMigrationService {

    @Autowired
    private LdapTemplate ldapTemplate;
    
    @Autowired
    private UserRepository userRepository;

    /**
     * å°†æ•°æ®åº“ç”¨æˆ·è¿ç§»åˆ°LDAP
     */
    public void migrateUsersToLdap() {
        List<User> dbUsers = userRepository.findAll();
        
        for (User dbUser : dbUsers) {
            // åˆ›å»ºLDAPç”¨æˆ·æ¡ç›®
            LdapUser ldapUser = new LdapUser();
            ldapUser.setUsername(dbUser.getUsername());
            ldapUser.setDisplayName(dbUser.getDisplayName());
            ldapUser.setEmail(dbUser.getEmail());
            ldapUser.setDepartment(dbUser.getDepartment());
            ldapUser.setTitle(dbUser.getTitle());
            
            // ä¿å­˜åˆ°LDAP
            String userDn = "uid=" + ldapUser.getUsername() + 
                           ",ou=ç”¨æˆ·,dc=company,dc=com";
            
            try {
                ldapTemplate.bind(userDn, null, buildUserAttributes(ldapUser));
                log.info("ç”¨æˆ· {} è¿ç§»æˆåŠŸ", ldapUser.getUsername());
            } catch (Exception e) {
                log.error("ç”¨æˆ· {} è¿ç§»å¤±è´¥: {}", ldapUser.getUsername(), e.getMessage());
            }
        }
    }
    
    private Attributes buildUserAttributes(LdapUser user) {
        BasicAttributes attrs = new BasicAttributes();
        attrs.put("objectClass", "inetOrgPerson");
        attrs.put("uid", user.getUsername());
        attrs.put("cn", user.getDisplayName());
        attrs.put("sn", user.getDisplayName());
        attrs.put("mail", user.getEmail());
        attrs.put("ou", user.getDepartment());
        attrs.put("title", user.getTitle());
        // è®¾ç½®åˆå§‹å¯†ç ï¼Œç”¨æˆ·é¦–æ¬¡ç™»å½•éœ€è¦ä¿®æ”¹
        attrs.put("userPassword", "{PLAIN}changeme123");
        return attrs;
    }
}
```

### 6.4 ä¼ä¸šå†…éƒ¨ç»Ÿä¸€èº«ä»½è®¤è¯æœ€ä½³å®è·µ


**ğŸ† æœ€ä½³å®è·µæ¸…å•**

```
èº«ä»½ç®¡ç†æœ€ä½³å®è·µï¼š

1. ç»„ç»‡æ¶æ„è®¾è®¡ âœ…
   - æŒ‰å…¬å¸å®é™…ç»„ç»‡æ¶æ„è®¾è®¡OU
   - éƒ¨é—¨å˜æ›´æ—¶åŒæ­¥æ›´æ–°LDAPç»“æ„
   - é¢„ç•™æ‰©å±•ç©ºé—´ï¼Œæ”¯æŒæœªæ¥ç»„ç»‡è°ƒæ•´

2. ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸç®¡ç† âœ…  
   å…¥èŒï¼šHRç³»ç»Ÿè‡ªåŠ¨åœ¨LDAPåˆ›å»ºè´¦å·
   è°ƒå²—ï¼šè‡ªåŠ¨æ›´æ–°éƒ¨é—¨å’Œæƒé™ç»„
   ç¦»èŒï¼šè‡ªåŠ¨ç¦ç”¨è´¦å·ä½†ä¿ç•™å†å²è®°å½•

3. å¯†ç ç­–ç•¥ âœ…
   - å¤æ‚åº¦è¦æ±‚ï¼šè‡³å°‘8ä½ï¼ŒåŒ…å«å¤§å°å†™æ•°å­—ç‰¹æ®Šå­—ç¬¦
   - å®šæœŸæ›´æ¢ï¼š90å¤©å¼ºåˆ¶æ›´æ¢
   - å†å²å¯†ç ï¼šä¸èƒ½é‡å¤ä½¿ç”¨æœ€è¿‘5ä¸ªå¯†ç 

4. æƒé™ç®¡ç† âœ…
   - åŸºäºç»„çš„æƒé™åˆ†é…
   - æœ€å°æƒé™åŸåˆ™
   - å®šæœŸæƒé™å®¡æ ¸

5. å®‰å…¨ç›‘æ§ âœ…
   - ç™»å½•å¼‚å¸¸æ£€æµ‹
   - æƒé™å˜æ›´å®¡è®¡
   - å¤±è´¥å°è¯•å‘Šè­¦
```

**ğŸ”’ å®‰å…¨é…ç½®ç¤ºä¾‹**

```yaml
# LDAPå®‰å…¨é…ç½®
ldap:
  security:
    # SSL/TLSé…ç½®
    ssl:
      enabled: true
      keystore: /path/to/keystore.jks
      keystore-password: keystorepass
    
    # è®¿é—®æ§åˆ¶
    access-control:
      # ç®¡ç†å‘˜æƒé™
      - dn: "cn=admin,dc=company,dc=com"
        permissions: ["read", "write", "delete"]
      
      # æ™®é€šç”¨æˆ·æƒé™  
      - dn: "ou=ç”¨æˆ·,dc=company,dc=com"
        permissions: ["read"]
        scope: "self"  # åªèƒ½è®¿é—®è‡ªå·±çš„ä¿¡æ¯
      
      # ç³»ç»ŸæœåŠ¡æƒé™
      - dn: "cn=app-service,ou=service,dc=company,dc=com"  
        permissions: ["read"]
        scope: "subtree"

    # å¯†ç ç­–ç•¥
    password-policy:
      min-length: 8
      require-uppercase: true
      require-lowercase: true  
      require-numeric: true
      require-special: true
      max-age-days: 90
      history-count: 5
      lockout-threshold: 5
      lockout-duration: 30
```

---

## 7. ğŸš€ OpenLDAPéƒ¨ç½²ä¸ä¼˜åŒ–


### 7.1 OpenLDAPå¿«é€Ÿéƒ¨ç½²


**ğŸ³ Dockeræ–¹å¼éƒ¨ç½²ï¼ˆæ¨èï¼‰**

```bash
# åˆ›å»ºéƒ¨ç½²ç›®å½•
mkdir -p /opt/ldap/{data,config,backup}
cd /opt/ldap

# docker-compose.yml
cat > docker-compose.yml << 'EOF'
version: '3.8'
services:
  openldap:
    image: osixia/openldap:1.5.0
    container_name: openldap
    restart: unless-stopped
    ports:
      - "389:389"   # LDAPç«¯å£
      - "636:636"   # LDAPSç«¯å£
    environment:
      # åŸºæœ¬é…ç½®
      LDAP_ORGANISATION: "æˆ‘çš„å…¬å¸"
      LDAP_DOMAIN: "company.com"
      LDAP_ADMIN_PASSWORD: "admin123"
      
      # SSLé…ç½®
      LDAP_TLS: "true"
      LDAP_TLS_CRT_FILENAME: "ldap.crt"
      LDAP_TLS_KEY_FILENAME: "ldap.key"
      LDAP_TLS_CA_CRT_FILENAME: "ca.crt"
      
      # æ—¥å¿—çº§åˆ«
      LDAP_LOG_LEVEL: "256"
    volumes:
      - ./data:/var/lib/ldap
      - ./config:/etc/ldap/slapd.d
      - ./certs:/container/service/slapd/assets/certs
    networks:
      - ldap-network

  # LDAPç®¡ç†ç•Œé¢
  phpldapadmin:
    image: osixia/phpldapadmin:0.9.0
    container_name: phpldapadmin
    restart: unless-stopped
    ports:
      - "8080:80"
    environment:
      PHPLDAPADMIN_LDAP_HOSTS: "openldap"
      PHPLDAPADMIN_HTTPS: "false"
    depends_on:
      - openldap
    networks:
      - ldap-network

networks:
  ldap-network:
    driver: bridge
EOF

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker-compose ps
docker logs openldap
```

**ğŸ”§ ä¼ ç»Ÿæ–¹å¼å®‰è£…**

```bash
# CentOS/RHELå®‰è£…
sudo yum update -y
sudo yum install -y openldap openldap-servers openldap-clients

# Ubuntu/Debianå®‰è£…  
sudo apt update
sudo apt install -y slapd ldap-utils

# å¯åŠ¨æœåŠ¡
sudo systemctl enable slapd
sudo systemctl start slapd

# æ£€æŸ¥æœåŠ¡
sudo systemctl status slapd
netstat -tlnp | grep 389
```

### 7.2 OpenLDAPåŸºç¡€é…ç½®


**ğŸ“ åˆå§‹åŒ–é…ç½®**

```bash
# è®¾ç½®ç®¡ç†å‘˜å¯†ç 
sudo slappasswd
# è¾“å…¥å¯†ç ï¼Œå¾—åˆ°åŠ å¯†åçš„å¯†ç å“ˆå¸Œ

# åˆ›å»ºåŸºç¡€é…ç½®æ–‡ä»¶
cat > /tmp/base.ldif << 'EOF'
dn: dc=company,dc=com
objectClass: top
objectClass: dcObject  
objectClass: organization
o: æˆ‘çš„å…¬å¸
dc: company

dn: cn=Manager,dc=company,dc=com
objectClass: organizationalRole
cn: Manager
description: LDAP Manager

dn: ou=People,dc=company,dc=com
objectClass: organizationalUnit
ou: People

dn: ou=Groups,dc=company,dc=com
objectClass: organizationalUnit
ou: Groups
EOF

# å¯¼å…¥åŸºç¡€ç»“æ„
ldapadd -x -D "cn=Manager,dc=company,dc=com" -W -f /tmp/base.ldif
```

**ğŸ‘¤ åˆ›å»ºæµ‹è¯•ç”¨æˆ·**

```bash
# åˆ›å»ºç”¨æˆ·æ¡ç›®
cat > /tmp/users.ldif << 'EOF'
dn: uid=zhangsan,ou=People,dc=company,dc=com
objectClass: inetOrgPerson
objectClass: posixAccount
objectClass: shadowAccount
uid: zhangsan
sn: å¼ 
givenName: ä¸‰
cn: å¼ ä¸‰
displayName: å¼ ä¸‰
uidNumber: 1001
gidNumber: 1001
userPassword: {PLAIN}123456
gecos: å¼ ä¸‰
loginShell: /bin/bash
homeDirectory: /home/zhangsan
mail: zhangsan@company.com
ou: æŠ€æœ¯éƒ¨
title: Javaå·¥ç¨‹å¸ˆ

dn: uid=lisi,ou=People,dc=company,dc=com
objectClass: inetOrgPerson
objectClass: posixAccount  
objectClass: shadowAccount
uid: lisi
sn: æ
givenName: å››
cn: æå››
displayName: æå››
uidNumber: 1002
gidNumber: 1002  
userPassword: {PLAIN}123456
gecos: æå››
loginShell: /bin/bash
homeDirectory: /home/lisi
mail: lisi@company.com
ou: é”€å”®éƒ¨
title: é”€å”®ç»ç†
EOF

# å¯¼å…¥ç”¨æˆ·
ldapadd -x -D "cn=Manager,dc=company,dc=com" -W -f /tmp/users.ldif

# æµ‹è¯•ç”¨æˆ·è®¤è¯
ldapwhoami -x -D "uid=zhangsan,ou=People,dc=company,dc=com" -W
```

### 7.3 æ€§èƒ½ä¼˜åŒ–é…ç½®


**âš¡ æ•°æ®åº“ä¼˜åŒ–**

```bash
# åˆ›å»ºæ•°æ®åº“é…ç½®
cat > /tmp/db_config.ldif << 'EOF'
dn: olcDatabase={2}hdb,cn=config
changetype: modify
replace: olcDbConfig
olcDbConfig: set_cachesize 0 268435456 1
olcDbConfig: set_lk_max_objects 1500
olcDbConfig: set_lk_max_locks 1500
olcDbConfig: set_lk_max_lockers 1500

# æ·»åŠ ç´¢å¼•
dn: olcDatabase={2}hdb,cn=config
changetype: modify
add: olcDbIndex
olcDbIndex: uid eq,pres,sub
olcDbIndex: mail eq,pres,sub
olcDbIndex: cn eq,pres,sub
olcDbIndex: displayName eq,pres,sub
olcDbIndex: uidNumber eq
olcDbIndex: gidNumber eq
olcDbIndex: memberUid eq,pres,sub
olcDbIndex: sambaSID eq
olcDbIndex: sambaPrimaryGroupSID eq
olcDbIndex: sambaGroupType eq
olcDbIndex: sambaSIDList eq
olcDbIndex: sambaDomainName eq
EOF

# åº”ç”¨é…ç½®
ldapmodify -Y EXTERNAL -H ldapi:/// -f /tmp/db_config.ldif
```

**ğŸ” ç›‘æ§é…ç½®**

```bash
# å¯ç”¨ç›‘æ§
cat > /tmp/monitor.ldif << 'EOF'
dn: cn=module,cn=config
objectClass: olcModuleList
cn: module
olcModulepath: /usr/lib/ldap
olcModuleload: back_monitor

dn: olcDatabase=monitor,cn=config
objectClass: olcDatabaseConfig
objectClass: olcMonitorConfig
olcDatabase: monitor
olcRootDN: cn=Manager,dc=company,dc=com
olcMonitorContext: cn=Monitor
EOF

ldapadd -Y EXTERNAL -H ldapi:/// -f /tmp/monitor.ldif

# æŸ¥çœ‹ç›‘æ§ä¿¡æ¯
ldapsearch -Y EXTERNAL -H ldapi:/// -b cn=Monitor
```

### 7.4 é«˜å¯ç”¨éƒ¨ç½²


**ğŸ”„ ä¸»ä»å¤åˆ¶é…ç½®**

```bash
# ä¸»æœåŠ¡å™¨é…ç½®
cat > /tmp/master_sync.ldif << 'EOF'
# å¯ç”¨åŒæ­¥æä¾›è€…æ¨¡å—
dn: cn=module,cn=config
objectClass: olcModuleList
cn: module  
olcModulePath: /usr/lib/ldap
olcModuleLoad: syncprov

# é…ç½®åŒæ­¥æä¾›è€…
dn: olcOverlay=syncprov,olcDatabase={2}hdb,cn=config
objectClass: olcOverlayConfig
objectClass: olcSyncProvConfig
olcOverlay: syncprov
olcSpSessionLog: 100
EOF

ldapadd -Y EXTERNAL -H ldapi:/// -f /tmp/master_sync.ldif

# ä»æœåŠ¡å™¨é…ç½®
cat > /tmp/slave_sync.ldif << 'EOF'
dn: olcDatabase={2}hdb,cn=config
changetype: modify
add: olcSyncRepl
olcSyncRepl: rid=001
  provider=ldap://master.company.com:389
  bindmethod=simple
  binddn="cn=Manager,dc=company,dc=com"
  credentials=admin123
  searchbase="dc=company,dc=com"
  scope=sub
  schemachecking=on
  type=refreshAndPersist
  retry="30 5 300 3"
  interval=00:00:05:00
EOF

ldapmodify -Y EXTERNAL -H ldapi:/// -f /tmp/slave_sync.ldif
```

**ğŸ”§ è´Ÿè½½å‡è¡¡é…ç½®**

```nginx
# nginx.conf - LDAPè´Ÿè½½å‡è¡¡
upstream ldap_backend {
    server ldap1.company.com:389 weight=3;
    server ldap2.company.com:389 weight=2;  
    server ldap3.company.com:389 weight=1 backup;
    
    # å¥åº·æ£€æŸ¥
    check interval=3000 rise=2 fall=3 timeout=1000;
}

server {
    listen 389;
    proxy_pass ldap_backend;
    proxy_timeout 1s;
    proxy_responses 1;
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ LDAPæœ¬è´¨ï¼šä¼ä¸šçº§"é€šè®¯å½•"ï¼Œæ ‘å½¢ç»“æ„å­˜å‚¨ç”¨æˆ·ä¿¡æ¯
ğŸ”¸ æ ¸å¿ƒä¼˜åŠ¿ï¼šç»Ÿä¸€èº«ä»½ç®¡ç†ã€è¯»æ€§èƒ½ä¼˜å¼‚ã€æ ‡å‡†åŒ–åè®®
ğŸ”¸ æŸ¥è¯¢è¯­æ³•ï¼šBase DN + Scope + Filter ä¸‰è¦ç´ 
ğŸ”¸ ADé›†æˆï¼šä¼ä¸šWindowsç¯å¢ƒçš„LDAPå®ç°
ğŸ”¸ Springé›†æˆï¼šé€šè¿‡Security + LDAPå®ç°ç»Ÿä¸€è®¤è¯
ğŸ”¸ ä¼ä¸šä»·å€¼ï¼šä¸€ä¸ªè´¦å·è®¿é—®æ‰€æœ‰ç³»ç»Ÿï¼Œé™ä½ç®¡ç†æˆæœ¬
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ LDAP vs æ•°æ®åº“çš„é€‰æ‹©é€»è¾‘**
```
å°å›¢é˜Ÿ + å•ç³»ç»Ÿ = æ•°æ®åº“è®¤è¯
å¤§ä¼ä¸š + å¤šç³»ç»Ÿ = LDAPè®¤è¯
è¯»å¤šå†™å°‘ + å±‚çº§ç»“æ„ = LDAPæ›´åˆé€‚
é¢‘ç¹æ›´æ–° + å¤æ‚æŸ¥è¯¢ = æ•°æ®åº“æ›´åˆé€‚
```

**ğŸ”¹ LDAPæŸ¥è¯¢çš„æ€ç»´æ¨¡å¼**
```
ç¡®å®šèµ·ç‚¹ï¼ˆBase DNï¼‰â†’ è®¾å®šèŒƒå›´ï¼ˆScopeï¼‰â†’ è¿‡æ»¤æ¡ä»¶ï¼ˆFilterï¼‰
å°±åƒï¼šä»å“ªé‡Œå¼€å§‹æ‰¾ â†’ æ‰¾å¤šæ·± â†’ æ‰¾ä»€ä¹ˆæ ·çš„
```

**ğŸ”¹ ä¼ä¸šéƒ¨ç½²çš„å®é™…è€ƒè™‘**
```
å®‰å…¨æ€§ï¼šSSL/TLSåŠ å¯† + è®¿é—®æ§åˆ¶
æ€§èƒ½ï¼šç´¢å¼•ä¼˜åŒ– + ç¼“å­˜é…ç½®  
å¯ç”¨æ€§ï¼šä¸»ä»å¤åˆ¶ + è´Ÿè½½å‡è¡¡
å¯ç»´æŠ¤æ€§ï¼šç›‘æ§å‘Šè­¦ + å¤‡ä»½ç­–ç•¥
```

### 8.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ’¼ ä¼ä¸šåº”ç”¨åœºæ™¯**
- **ç»Ÿä¸€ç™»å½•**ï¼šå‘˜å·¥ä¸€ä¸ªå¯†ç ç™»å½•æ‰€æœ‰ç³»ç»Ÿ
- **æƒé™ç®¡ç†**ï¼šåŸºäºéƒ¨é—¨å’Œè§’è‰²çš„æƒé™åˆ†é…
- **ç³»ç»Ÿé›†æˆ**ï¼šæ–°ç³»ç»Ÿå¿«é€Ÿæ¥å…¥ä¼ä¸šèº«ä»½ä½“ç³»
- **åˆè§„è¦æ±‚**ï¼šæ»¡è¶³ä¼ä¸šå®‰å…¨å’Œå®¡è®¡è¦æ±‚

**ğŸ”§ æŠ€æœ¯åº”ç”¨åœºæ™¯**
- **Spring Booté¡¹ç›®**ï¼šé›†æˆLDAPå®ç°ä¼ä¸šçº§è®¤è¯
- **å¾®æœåŠ¡æ¶æ„**ï¼šç»Ÿä¸€èº«ä»½è®¤è¯ä¸­å¿ƒ
- **DevOpså·¥å…·é“¾**ï¼šJenkinsã€GitLabç­‰å·¥å…·çš„ç»Ÿä¸€è®¤è¯
- **åŠå…¬ç³»ç»Ÿ**ï¼šé‚®ä»¶ã€OAã€æ–‡æ¡£ç­‰ç³»ç»Ÿçš„ç”¨æˆ·ç®¡ç†

### 8.4 å­¦ä¹ è¿›é˜¶è·¯å¾„


**ğŸ“ˆ æŠ€æœ¯æ·±å…¥æ–¹å‘**
```
åŸºç¡€åº”ç”¨ â†’ é«˜çº§æŸ¥è¯¢ â†’ æ€§èƒ½ä¼˜åŒ– â†’ é«˜å¯ç”¨æ¶æ„
   â†“           â†“           â†“           â†“
ç®€å•æŸ¥è¯¢    å¤æ‚è¿‡æ»¤å™¨   ç´¢å¼•ä¼˜åŒ–    ä¸»ä»å¤åˆ¶
ç”¨æˆ·è®¤è¯    æƒé™ç®¡ç†     ç¼“å­˜é…ç½®    è´Ÿè½½å‡è¡¡
```

**ğŸ› ï¸ å®æˆ˜æŠ€èƒ½å»ºè®®**
- **æŒæ¡å·¥å…·**ï¼šApache Directory Studioã€phpLDAPadmin
- **ç›‘æ§æŠ€èƒ½**ï¼šæ—¥å¿—åˆ†æã€æ€§èƒ½ç›‘æ§ã€æ•…éšœè¯Šæ–­  
- **å®‰å…¨æ„è¯†**ï¼šSSLé…ç½®ã€æƒé™æ§åˆ¶ã€å®¡è®¡æ—¥å¿—
- **è¿ç»´èƒ½åŠ›**ï¼šå¤‡ä»½æ¢å¤ã€å‡çº§ç»´æŠ¤ã€å®¹é‡è§„åˆ’

### 8.5 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


**âš ï¸ æ–°æ‰‹å¸¸è§é”™è¯¯**
```
DNæ ¼å¼é”™è¯¯ â†’ ä»”ç»†æ£€æŸ¥é€—å·å’Œç­‰å·
æœç´¢æ— ç»“æœ â†’ ç¡®è®¤Base DNå’ŒScopeè®¾ç½®
è¿æ¥è¶…æ—¶ â†’ æ£€æŸ¥ç½‘ç»œå’Œç«¯å£é…ç½®
æƒé™æ‹’ç» â†’ ç¡®è®¤ç»‘å®šç”¨æˆ·æœ‰è¶³å¤Ÿæƒé™
```

**ğŸ’¡ æœ€ä½³å®è·µå»ºè®®**
```
æµ‹è¯•å…ˆè¡Œï¼šå…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯é…ç½®
å¤‡ä»½é‡è¦ï¼šå®šæœŸå¤‡ä»½LDAPæ•°æ®å’Œé…ç½®
ç›‘æ§åˆ°ä½ï¼šè®¾ç½®å…³é”®æŒ‡æ ‡çš„å‘Šè­¦
æ–‡æ¡£å®Œå–„ï¼šè®°å½•é…ç½®è¿‡ç¨‹å’Œæ•…éšœå¤„ç†
å®‰å…¨ç¬¬ä¸€ï¼šå®šæœŸå®‰å…¨å®¡è®¡å’Œæƒé™æ£€æŸ¥
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
LDAPç›®å½•åƒå¤§æ ‘ï¼Œå±‚å±‚ç›¸è¿æœ‰ç»“æ„
DNåœ°å€è¦ç²¾ç¡®ï¼ŒBase Scope Filteré…åˆ
ä¼ä¸šè®¤è¯ç»Ÿä¸€åŒ–ï¼Œä¸€å·èµ°éå¤©ä¸‹è·¯
è¯»å¤šå†™å°‘æ€§èƒ½ä½³ï¼Œé«˜å¯ç”¨æ¥ä¿å¹³è·¯
Springé›†æˆå¾ˆç®€å•ï¼Œé…ç½®æ­£ç¡®å°±æˆåŠŸ
```