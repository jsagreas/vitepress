---
title: 6ã€OIDCæ ‡å‡†ç«¯ç‚¹æœºåˆ¶
---
## ğŸ“š ç›®å½•

1. [OIDCç«¯ç‚¹æœºåˆ¶æ¦‚è¿°](#1-OIDCç«¯ç‚¹æœºåˆ¶æ¦‚è¿°)
2. [Authorization Endpointæˆæƒç«¯ç‚¹](#2-Authorization-Endpointæˆæƒç«¯ç‚¹)
3. [Token Endpointä»¤ç‰Œç«¯ç‚¹](#3-Token-Endpointä»¤ç‰Œç«¯ç‚¹)
4. [UserInfo Endpointç”¨æˆ·ä¿¡æ¯ç«¯ç‚¹](#4-UserInfo-Endpointç”¨æˆ·ä¿¡æ¯ç«¯ç‚¹)
5. [JWKS Endpointå¯†é’¥ç«¯ç‚¹](#5-JWKS-Endpointå¯†é’¥ç«¯ç‚¹)
6. [End Session Endpointç™»å‡ºç«¯ç‚¹](#6-End-Session-Endpointç™»å‡ºç«¯ç‚¹)
7. [Discovery DocumentæœåŠ¡å‘ç°](#7-Discovery-DocumentæœåŠ¡å‘ç°)
8. [åŠ¨æ€å®¢æˆ·ç«¯æ³¨å†Œç«¯ç‚¹](#8-åŠ¨æ€å®¢æˆ·ç«¯æ³¨å†Œç«¯ç‚¹)
9. [é”™è¯¯å¤„ç†æœºåˆ¶](#9-é”™è¯¯å¤„ç†æœºåˆ¶)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ OIDCç«¯ç‚¹æœºåˆ¶æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯ç«¯ç‚¹ï¼ˆEndpointï¼‰


**ç®€å•ç†è§£**ï¼šç«¯ç‚¹å°±æ˜¯ä¸€ä¸ª**ç‰¹å®šåŠŸèƒ½çš„ç½‘å€**ï¼Œä¸“é—¨å¤„ç†æŸç±»è¯·æ±‚

```
ç±»æ¯”ç†è§£ï¼š
é“¶è¡ŒæŸœå°ç³»ç»Ÿï¼š
- å¼€æˆ·æŸœå°    â†’ Authorization Endpointï¼ˆæˆæƒï¼‰
- å–æ¬¾æœº      â†’ Token Endpointï¼ˆè·å–ä»¤ç‰Œï¼‰
- æŸ¥è¯¢æœº      â†’ UserInfo Endpointï¼ˆæŸ¥ç”¨æˆ·ä¿¡æ¯ï¼‰
- æ³¨é”€çª—å£    â†’ End Session Endpointï¼ˆç™»å‡ºï¼‰

æ¯ä¸ª"æŸœå°"éƒ½æœ‰ä¸“é—¨çš„åŠŸèƒ½ï¼Œå®¢æˆ·çŸ¥é“å»å“ªé‡ŒåŠä»€ä¹ˆäº‹
```

### 1.2 OIDCæ ‡å‡†ç«¯ç‚¹ä½“ç³»


**ğŸ”¸ æ ¸å¿ƒç«¯ç‚¹æ¶æ„**

```
OIDCèº«ä»½æä¾›å•† (Identity Provider)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸšª Authorization Endpoint              â”‚ â† ç”¨æˆ·ç™»å½•å…¥å£
â”‚     /oauth/authorize                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ« Token Endpoint                      â”‚ â† æ¢å–ä»¤ç‰Œ
â”‚     /oauth/token                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ‘¤ UserInfo Endpoint                   â”‚ â† è·å–ç”¨æˆ·ä¿¡æ¯
â”‚     /userinfo                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”‘ JWKS Endpoint                       â”‚ â† è·å–éªŒè¯å¯†é’¥
â”‚     /.well-known/jwks.json              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸš« End Session Endpoint                â”‚ â† ç™»å‡ºå¤„ç†
â”‚     /oauth/logout                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 ç«¯ç‚¹çš„å·¥ä½œåŸç†


**äº¤äº’æµç¨‹æ¦‚è§ˆ**ï¼š
```
ç”¨æˆ· â†’ åº”ç”¨ â†’ Authorization â†’ Token â†’ UserInfo â†’ åº”ç”¨ â†’ ç”¨æˆ·
     â‘ è¯·æ±‚ç™»å½•  â‘¡è·³è½¬è®¤è¯    â‘¢æ¢ä»¤ç‰Œ  â‘£è·å–ä¿¡æ¯   â‘¤å®Œæˆç™»å½•
```

---

## 2. ğŸšª Authorization Endpointæˆæƒç«¯ç‚¹


### 2.1 ç«¯ç‚¹ä½œç”¨å’Œå«ä¹‰


**ğŸ”¸ æ ¸å¿ƒä½œç”¨**ï¼šè¿™æ˜¯ç”¨æˆ·**å¼€å§‹ç™»å½•**çš„åœ°æ–¹ï¼Œå°±åƒå•†åœºçš„**å…¥å£å¤§é—¨**

**ç®€å•ç†è§£**ï¼š
- ç”¨æˆ·æƒ³ç™»å½•ä½ çš„åº”ç”¨
- åº”ç”¨æŠŠç”¨æˆ·**é‡å®šå‘**åˆ°è¿™ä¸ªç«¯ç‚¹
- ç”¨æˆ·åœ¨è¿™é‡Œ**è¾“å…¥è´¦å·å¯†ç **å®Œæˆè®¤è¯
- è®¤è¯æˆåŠŸå**è·³è½¬å›**ä½ çš„åº”ç”¨

### 2.2 æ ‡å‡†è¯·æ±‚å‚æ•°


**ğŸ”§ å¿…éœ€å‚æ•°**ï¼š

| å‚æ•°å | å«ä¹‰ | ç¤ºä¾‹å€¼ | è¯´æ˜ |
|--------|------|---------|------|
| `response_type` | **å“åº”ç±»å‹** | `code` | å‘Šè¯‰æœåŠ¡å™¨æˆ‘è¦ä»€ä¹ˆç±»å‹çš„å“åº” |
| `client_id` | **åº”ç”¨æ ‡è¯†** | `myapp123` | ä½ çš„åº”ç”¨åœ¨OIDCæœåŠ¡å•†é‚£é‡Œçš„èº«ä»½è¯ |
| `redirect_uri` | **å›è°ƒåœ°å€** | `https://myapp.com/callback` | ç™»å½•æˆåŠŸåè·³è½¬åˆ°å“ªé‡Œ |
| `scope` | **æƒé™èŒƒå›´** | `openid profile email` | æˆ‘éœ€è¦è·å–ç”¨æˆ·çš„å“ªäº›ä¿¡æ¯ |

**ğŸ”§ å¯é€‰å‚æ•°**ï¼š

| å‚æ•°å | å«ä¹‰ | ç”¨é€” |
|--------|------|------|
| `state` | **çŠ¶æ€æ ‡è¯†** | é˜²æ­¢CSRFæ”»å‡»ï¼Œç¡®ä¿è¯·æ±‚æ¥æºåˆæ³• |
| `nonce` | **éšæœºæ•°** | é˜²æ­¢é‡æ”¾æ”»å‡»ï¼Œç¡®ä¿ä»¤ç‰Œæ–°é²œ |
| `prompt` | **äº¤äº’æ–¹å¼** | `none`/`login`/`consent` æ§åˆ¶ç”¨æˆ·äº¤äº’ |

### 2.3 å®é™…è¯·æ±‚ç¤ºä¾‹


**ğŸ“ å…¸å‹çš„æˆæƒè¯·æ±‚**ï¼š
```http
GET https://auth.example.com/oauth/authorize
?response_type=code
&client_id=webapp123
&redirect_uri=https://myapp.com/callback
&scope=openid+profile+email
&state=xyz123
&nonce=abc789
```

**ğŸ”¸ å‚æ•°å«ä¹‰è§£é‡Š**ï¼š
```
response_type=code  â†’ "æˆ‘è¦æˆæƒç "
client_id=webapp123 â†’ "æˆ‘æ˜¯webapp123è¿™ä¸ªåº”ç”¨"
redirect_uri=...    â†’ "ç™»å½•æˆåŠŸåè¯·è·³è½¬åˆ°æˆ‘æŒ‡å®šçš„åœ°å€"
scope=openid...     â†’ "æˆ‘éœ€è¦ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯å’Œé‚®ç®±"
state=xyz123        â†’ "è¿™æ˜¯æˆ‘çš„è¯·æ±‚æ ‡è¯†ï¼Œå›è°ƒæ—¶è¯·åŸæ ·è¿”å›"
```

### 2.4 å“åº”å¤„ç†


**âœ… æˆåŠŸå“åº”**ï¼š
```http
HTTP/1.1 302 Found
Location: https://myapp.com/callback
?code=SplxlOBeZQQYbYS6WxSbIA
&state=xyz123
```

**âŒ é”™è¯¯å“åº”**ï¼š
```http
HTTP/1.1 302 Found
Location: https://myapp.com/callback
?error=invalid_request
&error_description=Missing+required+parameter
&state=xyz123
```

---

## 3. ğŸ« Token Endpointä»¤ç‰Œç«¯ç‚¹


### 3.1 ç«¯ç‚¹ä½œç”¨å’Œå«ä¹‰


**ğŸ”¸ æ ¸å¿ƒä½œç”¨**ï¼šç”¨**æˆæƒç æ¢å–ä»¤ç‰Œ**çš„åœ°æ–¹ï¼Œå°±åƒç”¨**å–æ¬¾å•å»é“¶è¡Œå–é’±**

**å·¥ä½œè¿‡ç¨‹**ï¼š
```
ç¬¬ä¸€æ­¥ï¼šç”¨æˆ·ç™»å½•æˆåŠŸï¼Œå¾—åˆ°æˆæƒç ï¼ˆåƒå–æ¬¾å•ï¼‰
ç¬¬äºŒæ­¥ï¼šåº”ç”¨æ‹¿æˆæƒç åˆ°Token Endpointæ¢çœŸæ­£çš„ä»¤ç‰Œï¼ˆå–åˆ°çœŸé’±ï¼‰
ç¬¬ä¸‰æ­¥ï¼šåº”ç”¨ç”¨ä»¤ç‰Œè®¿é—®ç”¨æˆ·ä¿¡æ¯
```

### 3.2 æ ‡å‡†è¯·æ±‚æ ¼å¼


**ğŸ”§ è¯·æ±‚æ–¹å¼**ï¼š`POST` è¯·æ±‚ï¼Œå†…å®¹ç±»å‹ï¼š`application/x-www-form-urlencoded`

**å¿…éœ€å‚æ•°**ï¼š

| å‚æ•°å | å«ä¹‰ | ç¤ºä¾‹ |
|--------|------|------|
| `grant_type` | **æˆæƒç±»å‹** | `authorization_code` |
| `code` | **æˆæƒç ** | `SplxlOBeZQQYbYS6WxSbIA` |
| `redirect_uri` | **å›è°ƒåœ°å€** | å¿…é¡»ä¸æˆæƒæ—¶ä¸€è‡´ |
| `client_id` | **å®¢æˆ·ç«¯ID** | åº”ç”¨æ ‡è¯† |
| `client_secret` | **å®¢æˆ·ç«¯å¯†é’¥** | åº”ç”¨å¯†ç ï¼ˆæœºå¯†å®¢æˆ·ç«¯éœ€è¦ï¼‰ |

### 3.3 å®é™…è¯·æ±‚ç¤ºä¾‹


**ğŸ“ ä»¤ç‰Œäº¤æ¢è¯·æ±‚**ï¼š
```http
POST https://auth.example.com/oauth/token
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code
&code=SplxlOBeZQQYbYS6WxSbIA
&redirect_uri=https://myapp.com/callback
&client_id=webapp123
&client_secret=secret456
```

### 3.4 å“åº”å†…å®¹


**âœ… æˆåŠŸå“åº”**ï¼š
```json
{
  "access_token": "eyJhbGciOiJSUzI1NiIs...",
  "token_type": "Bearer",
  "expires_in": 3600,
  "id_token": "eyJ0eXAiOiJKV1QiLCJhbGc...",
  "refresh_token": "tGzv3JOkF0XG5Qx2TlKWIA",
  "scope": "openid profile email"
}
```

**ğŸ”¸ å“åº”å­—æ®µå«ä¹‰**ï¼š
```
access_token  â†’ è®¿é—®ä»¤ç‰Œï¼ˆç”¨æ¥è°ƒç”¨APIï¼‰
id_token      â†’ èº«ä»½ä»¤ç‰Œï¼ˆåŒ…å«ç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼‰
refresh_token â†’ åˆ·æ–°ä»¤ç‰Œï¼ˆç”¨æ¥è·å–æ–°çš„è®¿é—®ä»¤ç‰Œï¼‰
expires_in    â†’ ä»¤ç‰Œæœ‰æ•ˆæœŸï¼ˆç§’ï¼‰
```

---

## 4. ğŸ‘¤ UserInfo Endpointç”¨æˆ·ä¿¡æ¯ç«¯ç‚¹


### 4.1 ç«¯ç‚¹ä½œç”¨å’Œå«ä¹‰


**ğŸ”¸ æ ¸å¿ƒä½œç”¨**ï¼šç”¨**è®¿é—®ä»¤ç‰Œè·å–ç”¨æˆ·è¯¦ç»†ä¿¡æ¯**ï¼Œå°±åƒç”¨**ä¼šå‘˜å¡æŸ¥è¯¢ä¸ªäººèµ„æ–™**

**ä½¿ç”¨åœºæ™¯**ï¼š
- åº”ç”¨æ‹¿åˆ°è®¿é—®ä»¤ç‰Œå
- æƒ³è·å–ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ï¼ˆå§“åã€é‚®ç®±ã€å¤´åƒç­‰ï¼‰
- è°ƒç”¨è¿™ä¸ªç«¯ç‚¹æ¥è·å–

### 4.2 è¯·æ±‚æ–¹å¼


**ğŸ”§ æ ‡å‡†è¯·æ±‚**ï¼š
```http
GET https://auth.example.com/userinfo
Authorization: Bearer eyJhbGciOiJSUzI1NiIs...
```

**âš ï¸ å…³é”®ç‚¹**ï¼š
- å¿…é¡»åœ¨**è¯·æ±‚å¤´**ä¸­æºå¸¦è®¿é—®ä»¤ç‰Œ
- ä½¿ç”¨ `Bearer` è®¤è¯æ–¹å¼
- ä»¤ç‰Œå¿…é¡»æœ‰æ•ˆä¸”åŒ…å«é€‚å½“çš„æƒé™èŒƒå›´

### 4.3 å“åº”ç¤ºä¾‹


**âœ… æˆåŠŸå“åº”**ï¼š
```json
{
  "sub": "248289761001",
  "name": "å¼ ä¸‰",
  "given_name": "ä¸‰",
  "family_name": "å¼ ",
  "preferred_username": "zhangsan",
  "email": "zhangsan@example.com",
  "email_verified": true,
  "picture": "https://example.com/avatar/zhangsan.jpg",
  "locale": "zh-CN"
}
```

**ğŸ”¸ å“åº”å­—æ®µè¯´æ˜**ï¼š

| å­—æ®µå | å«ä¹‰ | è¯´æ˜ |
|--------|------|------|
| `sub` | **ä¸»ä½“æ ‡è¯†** | ç”¨æˆ·çš„å”¯ä¸€IDï¼Œæ°¸ä¸æ”¹å˜ |
| `name` | **å…¨å** | ç”¨æˆ·å®Œæ•´å§“å |
| `email` | **é‚®ç®±** | ç”¨æˆ·é‚®ç®±åœ°å€ |
| `picture` | **å¤´åƒ** | ç”¨æˆ·å¤´åƒå›¾ç‰‡URL |
| `locale` | **åŒºåŸŸè®¾ç½®** | ç”¨æˆ·çš„è¯­è¨€å’Œåœ°åŒºåå¥½ |

### 4.4 æƒé™èŒƒå›´å½±å“


**ä¸åŒçš„ `scope` è¿”å›ä¸åŒä¿¡æ¯**ï¼š

```
scope=openid           â†’ åªè¿”å› sub
scope=openid profile   â†’ è¿”å› sub + å§“åç­‰åŸºæœ¬ä¿¡æ¯  
scope=openid email     â†’ è¿”å› sub + é‚®ç®±ä¿¡æ¯
scope=openid profile email â†’ è¿”å›å®Œæ•´ä¿¡æ¯
```

---

## 5. ğŸ”‘ JWKS Endpointå¯†é’¥ç«¯ç‚¹


### 5.1 ç«¯ç‚¹ä½œç”¨å’Œå«ä¹‰


**ğŸ”¸ æ ¸å¿ƒä½œç”¨**ï¼šæä¾›**å…¬é’¥ä¿¡æ¯**ï¼Œè®©åº”ç”¨èƒ½å¤Ÿ**éªŒè¯JWTä»¤ç‰Œçš„çœŸå®æ€§**

**ç®€å•ç†è§£**ï¼š
- JWTä»¤ç‰Œæ˜¯ç”¨ç§é’¥ç­¾åçš„
- åº”ç”¨éœ€è¦å…¬é’¥æ¥éªŒè¯ç­¾å
- JWKSç«¯ç‚¹å°±æ˜¯**å…¬é’¥çš„ä»“åº“**

```
ç±»æ¯”ç†è§£ï¼š
ç§é’¥ = é“¶è¡Œçš„å°ç« ï¼ˆé“¶è¡Œä¿ç®¡ï¼Œç”¨æ¥ç›–ç« ï¼‰
å…¬é’¥ = å°ç« æ ·æœ¬ï¼ˆå…¬å¼€å‘å¸ƒï¼Œå¤§å®¶ç”¨æ¥éªŒçœŸä¼ªï¼‰
JWKS = å°ç« æ ·æœ¬å±•ç¤ºæŸœï¼ˆæ‰€æœ‰äººéƒ½èƒ½æŸ¥çœ‹ï¼‰
```

### 5.2 ç«¯ç‚¹åœ°å€


**ğŸ”¸ æ ‡å‡†è·¯å¾„**ï¼š
```
https://auth.example.com/.well-known/jwks.json
```

**è¯·æ±‚æ–¹å¼**ï¼šç®€å•çš„ `GET` è¯·æ±‚ï¼Œæ— éœ€è®¤è¯

### 5.3 å“åº”æ ¼å¼


**ğŸ“ å…¸å‹å“åº”**ï¼š
```json
{
  "keys": [
    {
      "kty": "RSA",
      "use": "sig",
      "kid": "2011-04-29",
      "n": "0vx7agoebGcQSuuPiLJXZptN9nndrQmbXEps2aiAFbWhM78LhWx4cbbfAAtVT86zwu1RK7aPFFxuhDR1L6tSoc_BJECPebWKRXjBZCiFV4n3oknjhMstn64tZ_2W-5JsGY4Hc5n9yBXArwl93lqt7_RN5w6Cf0h4QyQ5v-65YGjQR0_FDW2QvzqY368QQMicAtaSqzs8KJZgnYb9c7d0zgdAZHzu6qMQvRL5hajrn1n91CbOpbISD08qNLyrdkt-bFTWhAI4vMQFh6WeZu0fM4lFd2NcRwr3XPksINHaQ-G_xBniIqbw0Ls1jF44-csFCur-kEgU8awapJzKnqDKgw",
      "e": "AQAB",
      "alg": "RS256"
    }
  ]
}
```

**ğŸ”¸ å­—æ®µå«ä¹‰**ï¼š

| å­—æ®µ | å«ä¹‰ | è¯´æ˜ |
|------|------|------|
| `kty` | **å¯†é’¥ç±»å‹** | RSAã€ECç­‰ |
| `use` | **ç”¨é€”** | sig=ç­¾åï¼Œenc=åŠ å¯† |
| `kid` | **å¯†é’¥ID** | å¯†é’¥çš„å”¯ä¸€æ ‡è¯† |
| `alg` | **ç®—æ³•** | RS256ã€ES256ç­‰ |
| `n`, `e` | **RSAå‚æ•°** | å…¬é’¥çš„æ•°å­¦å‚æ•° |

### 5.4 ä½¿ç”¨åœºæ™¯


**ğŸ”§ åº”ç”¨éªŒè¯ä»¤ç‰Œçš„è¿‡ç¨‹**ï¼š
```
â‘  åº”ç”¨æ”¶åˆ°JWTä»¤ç‰Œ
â‘¡ ä»JWTå¤´éƒ¨è·å–kidï¼ˆå¯†é’¥IDï¼‰
â‘¢ è°ƒç”¨JWKSç«¯ç‚¹è·å–å¯¹åº”å…¬é’¥
â‘£ ä½¿ç”¨å…¬é’¥éªŒè¯JWTç­¾å
â‘¤ éªŒè¯æˆåŠŸ â†’ ä»¤ç‰Œå¯ä¿¡
```

---

## 6. ğŸš« End Session Endpointç™»å‡ºç«¯ç‚¹


### 6.1 ç«¯ç‚¹ä½œç”¨å’Œå«ä¹‰


**ğŸ”¸ æ ¸å¿ƒä½œç”¨**ï¼šå¤„ç†ç”¨æˆ·**ç»Ÿä¸€ç™»å‡º**ï¼Œç¡®ä¿åœ¨æ‰€æœ‰ç›¸å…³ç³»ç»Ÿä¸­éƒ½é€€å‡ºç™»å½•

**ä¸ºä»€ä¹ˆéœ€è¦ç»Ÿä¸€ç™»å‡º**ï¼š
```
å•ç‚¹ç™»å½•åœºæ™¯ï¼š
ç”¨æˆ·ç™»å½•ä¸€æ¬¡ â†’ å¯ä»¥è®¿é—®å¤šä¸ªåº”ç”¨
ä½†æ˜¯ç™»å‡ºæ—¶ â†’ éœ€è¦åœ¨æ‰€æœ‰åº”ç”¨ä¸­éƒ½é€€å‡º

å¦‚æœä¸ç»Ÿä¸€ç™»å‡ºï¼š
ç”¨æˆ·åœ¨åº”ç”¨Aé€€å‡º â†’ ä½†åº”ç”¨Bã€Cä»ç„¶å¤„äºç™»å½•çŠ¶æ€
è¿™ä¼šå¸¦æ¥å®‰å…¨é£é™©
```

### 6.2 è¯·æ±‚å‚æ•°


**ğŸ”§ æ ‡å‡†å‚æ•°**ï¼š

| å‚æ•°å | å«ä¹‰ | å¿…éœ€æ€§ | è¯´æ˜ |
|--------|------|---------|------|
| `id_token_hint` | **èº«ä»½ä»¤ç‰Œæç¤º** | æ¨è | å¸®åŠ©è¯†åˆ«è¦ç™»å‡ºçš„ä¼šè¯ |
| `post_logout_redirect_uri` | **ç™»å‡ºåè·³è½¬åœ°å€** | å¯é€‰ | ç™»å‡ºå®Œæˆåè·³è½¬åˆ°å“ªé‡Œ |
| `state` | **çŠ¶æ€å‚æ•°** | å¯é€‰ | ç”¨äºç»´æŠ¤è¯·æ±‚çŠ¶æ€ |

### 6.3 è¯·æ±‚ç¤ºä¾‹


**ğŸ“ ç™»å‡ºè¯·æ±‚**ï¼š
```http
GET https://auth.example.com/oauth/logout
?id_token_hint=eyJ0eXAiOiJKV1QiLCJhbGc...
&post_logout_redirect_uri=https://myapp.com/goodbye
&state=logout123
```

### 6.4 ç™»å‡ºæµç¨‹


**ğŸ”„ å®Œæ•´ç™»å‡ºè¿‡ç¨‹**ï¼š
```
ç”¨æˆ·ç‚¹å‡»"é€€å‡ºç™»å½•"
        â†“
åº”ç”¨é‡å®šå‘åˆ°End Session Endpoint
        â†“
OIDCæœåŠ¡å™¨æ¸…é™¤ä¼šè¯
        â†“
é€šçŸ¥æ‰€æœ‰ç›¸å…³åº”ç”¨ï¼ˆå¯é€‰ï¼‰
        â†“
è·³è½¬åˆ°æŒ‡å®šé¡µé¢
```

---

## 7. ğŸ“‹ Discovery DocumentæœåŠ¡å‘ç°


### 7.1 ä»€ä¹ˆæ˜¯Discovery Document


**ğŸ”¸ æ ¸å¿ƒä½œç”¨**ï¼šä¸€ä¸ª**é…ç½®æ¸…å•**ï¼Œå‘Šè¯‰åº”ç”¨å¼€å‘è€…"æˆ‘è¿™ä¸ªOIDCæœåŠ¡éƒ½æœ‰å“ªäº›åŠŸèƒ½å’Œç«¯ç‚¹"

**ç®€å•ç†è§£**ï¼š
```
å°±åƒå•†åœºçš„å¯¼èˆªç‰Œï¼š
- 1æ¥¼æœ‰ä»€ä¹ˆåº—
- 2æ¥¼æœ‰ä»€ä¹ˆåº—  
- æ¯ä¸ªåº—çš„å…·ä½“ä½ç½®
- è¥ä¸šæ—¶é—´
- æ”¯æŒçš„æœåŠ¡

Discovery Documentå°±æ˜¯OIDCæœåŠ¡çš„"å¯¼èˆªç‰Œ"
```

### 7.2 æ ‡å‡†è·¯å¾„


**ğŸ”¸ å›ºå®šåœ°å€**ï¼š
```
https://auth.example.com/.well-known/openid_configuration
```

**âš ï¸ é‡è¦è§„åˆ™**ï¼š
- è·¯å¾„æ˜¯**æ ‡å‡†åŒ–**çš„ï¼Œæ‰€æœ‰OIDCæœåŠ¡å•†éƒ½ä½¿ç”¨è¿™ä¸ªè·¯å¾„
- å®¢æˆ·ç«¯å¯ä»¥**è‡ªåŠ¨å‘ç°**æœåŠ¡ç«¯çš„é…ç½®ä¿¡æ¯

### 7.3 å…¸å‹å“åº”å†…å®¹


**ğŸ“ é…ç½®æ–‡æ¡£ç¤ºä¾‹**ï¼š
```json
{
  "issuer": "https://auth.example.com",
  "authorization_endpoint": "https://auth.example.com/oauth/authorize",
  "token_endpoint": "https://auth.example.com/oauth/token",
  "userinfo_endpoint": "https://auth.example.com/userinfo",
  "jwks_uri": "https://auth.example.com/.well-known/jwks.json",
  "end_session_endpoint": "https://auth.example.com/oauth/logout",
  "registration_endpoint": "https://auth.example.com/oauth/register",
  
  "response_types_supported": ["code", "id_token", "token"],
  "subject_types_supported": ["public"],
  "id_token_signing_alg_values_supported": ["RS256", "HS256"],
  "scopes_supported": ["openid", "profile", "email", "phone"],
  "claims_supported": ["sub", "name", "email", "picture"]
}
```

### 7.4 å…³é”®å­—æ®µè¯´æ˜


**ğŸ”¸ ç«¯ç‚¹ä¿¡æ¯**ï¼š

| å­—æ®µ | å«ä¹‰ |
|------|------|
| `issuer` | **é¢å‘è€…æ ‡è¯†** |
| `authorization_endpoint` | **æˆæƒç«¯ç‚¹åœ°å€** |
| `token_endpoint` | **ä»¤ç‰Œç«¯ç‚¹åœ°å€** |
| `userinfo_endpoint` | **ç”¨æˆ·ä¿¡æ¯ç«¯ç‚¹** |
| `jwks_uri` | **å¯†é’¥ç«¯ç‚¹åœ°å€** |

**ğŸ”¸ èƒ½åŠ›ä¿¡æ¯**ï¼š

| å­—æ®µ | å«ä¹‰ |
|------|------|
| `response_types_supported` | **æ”¯æŒçš„å“åº”ç±»å‹** |
| `scopes_supported` | **æ”¯æŒçš„æƒé™èŒƒå›´** |
| `claims_supported` | **æ”¯æŒçš„ç”¨æˆ·å£°æ˜** |

---

## 8. ğŸ”§ åŠ¨æ€å®¢æˆ·ç«¯æ³¨å†Œç«¯ç‚¹


### 8.1 ç«¯ç‚¹ä½œç”¨å’Œå«ä¹‰


**ğŸ”¸ æ ¸å¿ƒä½œç”¨**ï¼šå…è®¸åº”ç”¨**è‡ªåŠ¨æ³¨å†Œ**åˆ°OIDCæœåŠ¡ï¼Œè€Œä¸éœ€è¦äººå·¥é…ç½®

**ä¼ ç»Ÿæ–¹å¼ vs åŠ¨æ€æ³¨å†Œ**ï¼š
```
ä¼ ç»Ÿæ–¹å¼ï¼š
å¼€å‘è€… â†’ æ‰‹åŠ¨åˆ°ç®¡ç†åå° â†’ å¡«å†™åº”ç”¨ä¿¡æ¯ â†’ è·å¾—client_id

åŠ¨æ€æ³¨å†Œï¼š
åº”ç”¨ â†’ è°ƒç”¨æ³¨å†Œç«¯ç‚¹ â†’ è‡ªåŠ¨è·å¾—client_id â†’ ç›´æ¥ä½¿ç”¨
```

### 8.2 æ³¨å†Œè¯·æ±‚


**ğŸ”§ è¯·æ±‚æ ¼å¼**ï¼š
```http
POST https://auth.example.com/oauth/register
Content-Type: application/json

{
  "redirect_uris": ["https://myapp.com/callback"],
  "application_type": "web",
  "grant_types": ["authorization_code"],
  "response_types": ["code"],
  "client_name": "æˆ‘çš„åº”ç”¨",
  "client_uri": "https://myapp.com",
  "scope": "openid profile email"
}
```

### 8.3 æ³¨å†Œå“åº”


**âœ… æˆåŠŸå“åº”**ï¼š
```json
{
  "client_id": "auto_generated_123456",
  "client_secret": "auto_secret_789012",
  "client_id_issued_at": 1649318400,
  "client_secret_expires_at": 1680854400,
  "redirect_uris": ["https://myapp.com/callback"],
  "grant_types": ["authorization_code"],
  "response_types": ["code"]
}
```

**ğŸ”¸ ä½¿ç”¨åœºæ™¯**ï¼š
- **ç§»åŠ¨åº”ç”¨**ï¼šæ¯ä¸ªå®‰è£…åŒ…å¯ä»¥æœ‰å”¯ä¸€æ ‡è¯†
- **å¾®æœåŠ¡æ¶æ„**ï¼šæœåŠ¡åŠ¨æ€éƒ¨ç½²æ—¶è‡ªåŠ¨æ³¨å†Œ
- **å¼€å‘æµ‹è¯•**ï¼šå¿«é€Ÿåˆ›å»ºæµ‹è¯•ç”¨çš„å®¢æˆ·ç«¯

---

## 9. âš ï¸ é”™è¯¯å¤„ç†æœºåˆ¶


### 9.1 æ ‡å‡†é”™è¯¯ç 


**ğŸ”¸ Authorization Endpoint é”™è¯¯**ï¼š

| é”™è¯¯ç  | å«ä¹‰ | åœºæ™¯ |
|--------|------|------|
| `invalid_request` | **è¯·æ±‚æ ¼å¼é”™è¯¯** | ç¼ºå°‘å¿…éœ€å‚æ•° |
| `unauthorized_client` | **å®¢æˆ·ç«¯æœªæˆæƒ** | client_idæ— æ•ˆ |
| `access_denied` | **ç”¨æˆ·æ‹’ç»æˆæƒ** | ç”¨æˆ·ç‚¹å‡»"æ‹’ç»" |
| `unsupported_response_type` | **ä¸æ”¯æŒçš„å“åº”ç±»å‹** | response_typeé”™è¯¯ |
| `invalid_scope` | **æ— æ•ˆçš„æƒé™èŒƒå›´** | scopeå‚æ•°é”™è¯¯ |

**ğŸ”¸ Token Endpoint é”™è¯¯**ï¼š

| é”™è¯¯ç  | å«ä¹‰ | åœºæ™¯ |
|--------|------|------|
| `invalid_request` | **è¯·æ±‚æ— æ•ˆ** | å‚æ•°æ ¼å¼é”™è¯¯ |
| `invalid_client` | **å®¢æˆ·ç«¯è®¤è¯å¤±è´¥** | å¯†é’¥é”™è¯¯ |
| `invalid_grant` | **æˆæƒç æ— æ•ˆ** | codeè¿‡æœŸæˆ–é”™è¯¯ |
| `unsupported_grant_type` | **ä¸æ”¯æŒçš„æˆæƒç±»å‹** | grant_typeé”™è¯¯ |

### 9.2 é”™è¯¯å“åº”æ ¼å¼


**ğŸ“ æ ‡å‡†é”™è¯¯å“åº”**ï¼š
```json
{
  "error": "invalid_request",
  "error_description": "Request was missing the 'redirect_uri' parameter.",
  "error_uri": "https://docs.example.com/errors#invalid_request"
}
```

### 9.3 é”™è¯¯å¤„ç†æœ€ä½³å®è·µ


**ğŸ”§ åº”ç”¨ç«¯å¤„ç†å»ºè®®**ï¼š

```javascript
// å¤„ç†æˆæƒå›è°ƒä¸­çš„é”™è¯¯
function handleCallback() {
  const params = new URLSearchParams(window.location.search);
  
  if (params.has('error')) {
    const error = params.get('error');
    const description = params.get('error_description');
    
    switch(error) {
      case 'access_denied':
        // ç”¨æˆ·æ‹’ç»æˆæƒï¼Œæ˜¾ç¤ºå‹å¥½æç¤º
        showMessage('ç™»å½•å·²å–æ¶ˆï¼Œè¯·é‡è¯•');
        break;
      case 'invalid_request':
        // è¯·æ±‚å‚æ•°é”™è¯¯ï¼Œæ£€æŸ¥é…ç½®
        console.error('é…ç½®é”™è¯¯ï¼š', description);
        break;
      default:
        // å…¶ä»–é”™è¯¯ï¼Œæ˜¾ç¤ºé€šç”¨æç¤º
        showMessage('ç™»å½•å‡ºç°é—®é¢˜ï¼Œè¯·ç¨åé‡è¯•');
    }
    return;
  }
  
  // å¤„ç†æˆåŠŸæƒ…å†µ
  const code = params.get('code');
  if (code) {
    exchangeCodeForTokens(code);
  }
}
```

**âš ï¸ å®‰å…¨æ³¨æ„äº‹é¡¹**ï¼š
- ä¸è¦åœ¨å®¢æˆ·ç«¯æ˜¾ç¤ºè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
- è®°å½•é”™è¯¯æ—¥å¿—ç”¨äºè°ƒè¯•
- å¯¹æ•æ„Ÿé”™è¯¯è¿›è¡Œè„±æ•å¤„ç†

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ç«¯ç‚¹æœ¬è´¨ï¼šæ¯ä¸ªç«¯ç‚¹éƒ½æœ‰ä¸“é—¨çš„åŠŸèƒ½ï¼Œå°±åƒä¸åŒçš„æœåŠ¡çª—å£
ğŸ”¸ äº¤äº’æµç¨‹ï¼šAuthorization â†’ Token â†’ UserInfo çš„åŸºæœ¬æµç¨‹
ğŸ”¸ å®‰å…¨æœºåˆ¶ï¼šæ¯ä¸ªç«¯ç‚¹éƒ½æœ‰ç›¸åº”çš„å®‰å…¨ä¿æŠ¤æªæ–½
ğŸ”¸ æ ‡å‡†åŒ–ï¼šæ‰€æœ‰OIDCæœåŠ¡å•†éƒ½éµå¾ªç›¸åŒçš„ç«¯ç‚¹è§„èŒƒ
ğŸ”¸ è‡ªåŠ¨å‘ç°ï¼šé€šè¿‡Discovery Documentè‡ªåŠ¨è·å–ç«¯ç‚¹é…ç½®
```

### 10.2 å„ç«¯ç‚¹æ ¸å¿ƒä½œç”¨


**ğŸ”¹ ç«¯ç‚¹åŠŸèƒ½é€Ÿè®°**ï¼š
```
Authorization Endpoint â†’ ğŸšª ç”¨æˆ·ç™»å½•çš„å¤§é—¨
Token Endpoint        â†’ ğŸ« ç”¨æˆæƒç æ¢ä»¤ç‰Œçš„æŸœå°  
UserInfo Endpoint     â†’ ğŸ‘¤ æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯çš„çª—å£
JWKS Endpoint        â†’ ğŸ”‘ è·å–éªŒè¯å¯†é’¥çš„ä»“åº“
End Session Endpoint â†’ ğŸš« ç»Ÿä¸€ç™»å‡ºçš„å‡ºå£
Discovery Document   â†’ ğŸ“‹ æœåŠ¡é…ç½®çš„è¯´æ˜ä¹¦
```

### 10.3 å®é™…åº”ç”¨è¦ç‚¹


**ğŸ”¹ å¼€å‘å®è·µå»ºè®®**ï¼š
```
é…ç½®ç®¡ç†ï¼š
- ä¼˜å…ˆä½¿ç”¨Discovery Documentè‡ªåŠ¨è·å–ç«¯ç‚¹åœ°å€
- ä¸è¦ç¡¬ç¼–ç ç«¯ç‚¹URLåˆ°ä»£ç ä¸­
- å®šæœŸæ£€æŸ¥æœåŠ¡å•†çš„é…ç½®å˜æ›´

é”™è¯¯å¤„ç†ï¼š
- å®ç°å®Œæ•´çš„é”™è¯¯å¤„ç†é€»è¾‘
- ä¸ºç”¨æˆ·æä¾›å‹å¥½çš„é”™è¯¯æç¤º
- è®°å½•è¯¦ç»†çš„é”™è¯¯æ—¥å¿—ç”¨äºæ’æŸ¥

å®‰å…¨è€ƒè™‘ï¼š
- éªŒè¯æ‰€æœ‰å›è°ƒå‚æ•°çš„stateå€¼
- æ­£ç¡®å¤„ç†ä»¤ç‰Œçš„å­˜å‚¨å’Œä¼ è¾“
- å®ç°é€‚å½“çš„ä¼šè¯ç®¡ç†
```

**ğŸ”¹ å¸¸è§é—®é¢˜é¿å…**ï¼š
```
å‚æ•°é”™è¯¯ï¼š
- redirect_uriå¿…é¡»ä¸æ³¨å†Œæ—¶å®Œå…¨ä¸€è‡´
- scopeå‚æ•°è¦ä¸æœåŠ¡ç«¯æ”¯æŒçš„èŒƒå›´åŒ¹é…
- å®¢æˆ·ç«¯è®¤è¯æ–¹å¼è¦æ­£ç¡®é…ç½®

ä»¤ç‰Œå¤„ç†ï¼š
- åŠæ—¶å¤„ç†è¿‡æœŸçš„è®¿é—®ä»¤ç‰Œ
- æ­£ç¡®å®ç°ä»¤ç‰Œåˆ·æ–°æœºåˆ¶
- å®‰å…¨å­˜å‚¨æ•æ„Ÿçš„ä»¤ç‰Œä¿¡æ¯
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- OIDCç«¯ç‚¹æ˜¯èº«ä»½è®¤è¯çš„**æ ‡å‡†åŒ–æ¥å£**
- æ¯ä¸ªç«¯ç‚¹éƒ½æœ‰**ä¸“é—¨çš„èŒè´£**å’Œ**æ ‡å‡†çš„æ ¼å¼**
- é€šè¿‡**Discovery Document**å¯ä»¥è‡ªåŠ¨å‘ç°æ‰€æœ‰ç«¯ç‚¹
- æ­£ç¡®çš„**é”™è¯¯å¤„ç†**æ˜¯å®ç°å¥å£®åº”ç”¨çš„å…³é”®