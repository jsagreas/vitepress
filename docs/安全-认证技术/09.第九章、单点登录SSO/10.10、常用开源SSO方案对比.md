---
title: 10ã€å¸¸ç”¨å¼€æºSSOæ–¹æ¡ˆå¯¹æ¯”
---
## ğŸ“š ç›®å½•

1. [SSOåŸºç¡€æ¦‚å¿µå›é¡¾](#1-SSOåŸºç¡€æ¦‚å¿µå›é¡¾)
2. [CASä¸­å¤®è®¤è¯æœåŠ¡](#2-CASä¸­å¤®è®¤è¯æœåŠ¡)
3. [Keycloakä¼ä¸šçº§è§£å†³æ–¹æ¡ˆ](#3-Keycloakä¼ä¸šçº§è§£å†³æ–¹æ¡ˆ)
4. [Auth0äº‘ç«¯SaaSæ–¹æ¡ˆ](#4-Auth0äº‘ç«¯SaaSæ–¹æ¡ˆ)
5. [Spring Security OAuth/OIDC](#5-Spring-Security-OAuth-OIDC)
6. [æ–¹æ¡ˆå…¨é¢å¯¹æ¯”åˆ†æ](#6-æ–¹æ¡ˆå…¨é¢å¯¹æ¯”åˆ†æ)
7. [é€‰å‹å†³ç­–æŒ‡å—](#7-é€‰å‹å†³ç­–æŒ‡å—)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” SSOåŸºç¡€æ¦‚å¿µå›é¡¾


### 1.1 ä»€ä¹ˆæ˜¯å•ç‚¹ç™»å½•SSO


> ğŸ’¡ **é€šä¿—ç†è§£**ï¼šå°±åƒä½ æœ‰ä¸€æŠŠä¸‡èƒ½é’¥åŒ™ï¼Œå¯ä»¥æ‰“å¼€å®¶é‡Œæ‰€æœ‰æˆ¿é—´çš„é—¨
> 
> **æŠ€æœ¯å®šä¹‰**ï¼šç”¨æˆ·åªéœ€è¦ç™»å½•ä¸€æ¬¡ï¼Œå°±èƒ½è®¿é—®æ‰€æœ‰ç›¸å…³çš„åº”ç”¨ç³»ç»Ÿï¼Œæ— éœ€é‡å¤ç™»å½•

**ç°å®åœºæ™¯ä¸¾ä¾‹**ï¼š
```
ä¼ ç»Ÿæ–¹å¼ï¼š
ç”¨æˆ·ç™»å½• â†’ é‚®ç®±ç³»ç»Ÿ â†’ è¾“å…¥è´¦å·å¯†ç 
ç”¨æˆ·ç™»å½• â†’ åŠå…¬ç³»ç»Ÿ â†’ å†æ¬¡è¾“å…¥è´¦å·å¯†ç   
ç”¨æˆ·ç™»å½• â†’ è´¢åŠ¡ç³»ç»Ÿ â†’ åˆè¦è¾“å…¥è´¦å·å¯†ç 

SSOæ–¹å¼ï¼š
ç”¨æˆ·ç™»å½• â†’ ç»Ÿä¸€è®¤è¯ä¸­å¿ƒ â†’ è¾“å…¥ä¸€æ¬¡è´¦å·å¯†ç 
è‡ªåŠ¨è®¿é—® â†’ é‚®ç®±ç³»ç»Ÿ âœ… 
è‡ªåŠ¨è®¿é—® â†’ åŠå…¬ç³»ç»Ÿ âœ…
è‡ªåŠ¨è®¿é—® â†’ è´¢åŠ¡ç³»ç»Ÿ âœ…
```

### 1.2 SSOè§£å†³çš„æ ¸å¿ƒé—®é¢˜


**ğŸ¯ ç”¨æˆ·ä½“éªŒé—®é¢˜**ï¼š
- **å¯†ç ç–²åŠ³**ï¼šè®°ä½å¤šä¸ªç³»ç»Ÿçš„ä¸åŒå¯†ç 
- **é‡å¤ç™»å½•**ï¼šæ¯ä¸ªç³»ç»Ÿéƒ½è¦å•ç‹¬ç™»å½•
- **æ“ä½œç¹ç**ï¼šé¢‘ç¹çš„ç™»å½•æ‰“æ–­å·¥ä½œæµç¨‹

**ğŸ”’ å®‰å…¨ç®¡ç†é—®é¢˜**ï¼š
- **å¯†ç åˆ†æ•£**ï¼šéš¾ä»¥ç»Ÿä¸€ç®¡ç†ç”¨æˆ·å¯†ç ç­–ç•¥
- **æƒé™æ··ä¹±**ï¼šæ¯ä¸ªç³»ç»Ÿç‹¬ç«‹ç®¡ç†ç”¨æˆ·æƒé™
- **å®¡è®¡å›°éš¾**ï¼šæ— æ³•ç»Ÿä¸€ç›‘æ§ç”¨æˆ·è®¿é—®è¡Œä¸º

### 1.3 SSOçš„å·¥ä½œåŸç†


```
SSOåŸºæœ¬æµç¨‹å›¾ï¼š

ç”¨æˆ·                è®¤è¯ä¸­å¿ƒ               åº”ç”¨ç³»ç»ŸA        åº”ç”¨ç³»ç»ŸB
 |                     |                      |               |
 |--[1]è®¿é—®åº”ç”¨A------->|                      |               |
 |                     |--[2]é‡å®šå‘åˆ°ç™»å½•é¡µ--->|               |
 |<--[3]æ˜¾ç¤ºç™»å½•é¡µ------|                      |               |
 |                     |                      |               |
 |--[4]è¾“å…¥ç”¨æˆ·åå¯†ç --->|                      |               |
 |                     |--[5]éªŒè¯æˆåŠŸ--------->|               |
 |<--[6]è¿”å›è®¿é—®ç¥¨æ®----|                      |               |
 |                     |                      |               |
 |--[7]æºå¸¦ç¥¨æ®è®¿é—®A--->|                      |               |
 |<--[8]æ­£å¸¸è®¿é—®A-------|                      |               |
 |                     |                      |               |
 |--[9]è®¿é—®åº”ç”¨B------->|                      |               |
 |                     |                      |               |--[10]æ£€æŸ¥ç™»å½•çŠ¶æ€
 |                     |                      |               |<-[11]å·²ç™»å½•ï¼Œç›´æ¥è®¿é—®
 |<--[12]æ­£å¸¸è®¿é—®B------|                      |               |
```

**å…³é”®ç†è§£**ï¼š
- ğŸ”‘ **ç»Ÿä¸€è®¤è¯**ï¼šæ‰€æœ‰åº”ç”¨éƒ½ä¿¡ä»»åŒä¸€ä¸ªè®¤è¯ä¸­å¿ƒ
- ğŸ« **ç¥¨æ®æœºåˆ¶**ï¼šç”¨ç™»å½•ç¥¨æ®ä»£æ›¿é‡å¤è¾“å…¥å¯†ç 
- ğŸ”„ **çŠ¶æ€å…±äº«**ï¼šç™»å½•çŠ¶æ€åœ¨å¤šä¸ªåº”ç”¨é—´å…±äº«

---

## 2. ğŸ›ï¸ CASä¸­å¤®è®¤è¯æœåŠ¡


### 2.1 CASæ˜¯ä»€ä¹ˆ


> ğŸ’¡ **é€šä¿—æ¯”å–»**ï¼šCASå°±åƒå­¦æ ¡çš„é—¨å«å¤§çˆ·ï¼Œæ‰€æœ‰å­¦ç”Ÿè¿›æ ¡å›­éƒ½è¦ç»è¿‡ä»–çš„éªŒè¯ï¼ŒéªŒè¯é€šè¿‡åç»™ä½ ä¸€ä¸ªé€šè¡Œè¯ï¼Œä½ æ‹¿ç€è¿™ä¸ªé€šè¡Œè¯å¯ä»¥è¿›å…¥æ ¡å›­å†…çš„ä»»ä½•å»ºç­‘
> 
> **æŠ€æœ¯å®šä¹‰**ï¼šCASï¼ˆCentral Authentication Serviceï¼‰æ˜¯ä¸€ä¸ªå¼€æºçš„ä¼ä¸šçº§å•ç‚¹ç™»å½•è§£å†³æ–¹æ¡ˆ

**ğŸ—ï¸ CASçš„æ ¸å¿ƒç»„ä»¶**ï¼š

```
CASæ¶æ„å›¾ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CAS Server                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Login Module  â”‚  â”‚    Ticket Registry         â”‚   â”‚
â”‚  â”‚   ç™»å½•å¤„ç†æ¨¡å—    â”‚  â”‚    ç¥¨æ®æ³¨å†Œè¡¨              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Service Manager â”‚  â”‚   Authentication Handler   â”‚   â”‚
â”‚  â”‚ æœåŠ¡ç®¡ç†å™¨       â”‚  â”‚   è®¤è¯å¤„ç†å™¨                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ CAS Protocol
                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Web App A      â”‚    â”‚   Web App B      â”‚    â”‚   Web App C      â”‚
â”‚                  â”‚    â”‚                  â”‚    â”‚                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ CAS Client   â”‚ â”‚    â”‚ â”‚ CAS Client   â”‚ â”‚    â”‚ â”‚ CAS Client   â”‚ â”‚
â”‚ â”‚ CASå®¢æˆ·ç«¯    â”‚ â”‚    â”‚ â”‚ CASå®¢æˆ·ç«¯    â”‚ â”‚    â”‚ â”‚ CASå®¢æˆ·ç«¯    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 CASçš„æ ¸å¿ƒç‰¹ç‚¹


**âœ… ä¸»è¦ä¼˜åŠ¿**ï¼š
- **ğŸ¯ ç®€å•å¯é **ï¼šåè®®ç®€å•ï¼Œç»è¿‡å¤§é‡å®è·µéªŒè¯
- **ğŸ”§ æ˜“äºé›†æˆ**ï¼šæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€å’Œæ¡†æ¶
- **ğŸ“± å¹¿æ³›æ”¯æŒ**ï¼šå‡ ä¹æ‰€æœ‰ä¸»æµæŠ€æœ¯æ ˆéƒ½æœ‰å®¢æˆ·ç«¯
- **ğŸ¢ ä¼ä¸šæˆç†Ÿ**ï¼šåœ¨ä¼ä¸šç¯å¢ƒä¸­ä½¿ç”¨å¹¿æ³›

**âš ï¸ ä¸»è¦é™åˆ¶**ï¼š
- **ğŸ“‹ åè®®å•ä¸€**ï¼šä¸»è¦æ”¯æŒCASåè®®ï¼Œç°ä»£åè®®æ”¯æŒæœ‰é™
- **ğŸ¨ ç•Œé¢ä¼ ç»Ÿ**ï¼šé»˜è®¤ç•Œé¢æ¯”è¾ƒç®€é™‹
- **ğŸ”Œ æ‰©å±•å¤æ‚**ï¼šæ·±åº¦å®šåˆ¶éœ€è¦è¾ƒå¤šå¼€å‘å·¥ä½œ

### 2.3 CASçš„å·¥ä½œæµç¨‹


**ğŸ”„ è¯¦ç»†ç™»å½•æµç¨‹**ï¼š

```java
// 1. ç”¨æˆ·è®¿é—®å—ä¿æŠ¤çš„åº”ç”¨
GET http://app.company.com/protected-page

// 2. åº”ç”¨æ£€æµ‹åˆ°æœªç™»å½•ï¼Œé‡å®šå‘åˆ°CASç™»å½•
HTTP 302 Redirect
Location: https://cas.company.com/login?service=http://app.company.com/protected-page

// 3. ç”¨æˆ·åœ¨CASé¡µé¢è¾“å…¥ç”¨æˆ·åå¯†ç 
POST https://cas.company.com/login
Content: username=john&password=secret123&service=http://app.company.com/protected-page

// 4. CASéªŒè¯æˆåŠŸï¼Œé‡å®šå‘å›åº”ç”¨å¹¶æºå¸¦ç¥¨æ®
HTTP 302 Redirect  
Location: http://app.company.com/protected-page?ticket=ST-123456-abcdef

// 5. åº”ç”¨åå°éªŒè¯ç¥¨æ®
GET https://cas.company.com/validate?ticket=ST-123456-abcdef&service=http://app.company.com/protected-page
Response: yes\njohn
```

**ğŸ« CASç¥¨æ®ç±»å‹**ï¼š

| ç¥¨æ®ç±»å‹ | **å…¨ç§°** | **ç”¨é€”** | **ç”Ÿå‘½å‘¨æœŸ** |
|---------|---------|---------|-------------|
| ğŸ« **TGT** | `Ticket Granting Ticket` | ç”¨æˆ·ç™»å½•å‡­è¯ | å‡ å°æ—¶åˆ°å‡ å¤© |
| ğŸŸï¸ **ST** | `Service Ticket` | åº”ç”¨è®¿é—®å‡­è¯ | å‡ åˆ†é’Ÿï¼ˆä¸€æ¬¡æ€§ï¼‰ |
| ğŸª **PGT** | `Proxy Granting Ticket` | ä»£ç†è®¿é—®å‡­è¯ | ä¸TGTç›¸åŒ |

### 2.4 CASå®é™…éƒ¨ç½²ç¤ºä¾‹


**ğŸš€ å¿«é€Ÿéƒ¨ç½²é…ç½®**ï¼š

```yaml
# application.yml - CASæœåŠ¡å™¨é…ç½®
server:
  port: 8443
  ssl:
    enabled: true
    
cas:
  server:
    name: https://cas.company.com:8443
    prefix: https://cas.company.com:8443/cas
  
  # è®¤è¯é…ç½®
  authn:
    accept:
      users: admin::secret,user::password
      
  # æœåŠ¡æ³¨å†Œ
  service-registry:
    core:
      init-from-json: true
```

```java
// Javaåº”ç”¨é›†æˆCASå®¢æˆ·ç«¯
@Configuration
public class CasConfig {
    
    @Bean
    public FilterRegistrationBean casFilter() {
        FilterRegistrationBean registration = new FilterRegistrationBean();
        registration.setFilter(new CASFilter());
        registration.addInitParameter("cas.server.name", "https://cas.company.com:8443");
        registration.addInitParameter("cas.service", "http://app.company.com");
        return registration;
    }
}
```

**ğŸ’¡ éƒ¨ç½²è¦ç‚¹**ï¼š
- **ğŸ”’ HTTPSå¿…éœ€**ï¼šç”Ÿäº§ç¯å¢ƒå¿…é¡»å¯ç”¨HTTPS
- **ğŸ—„ï¸ æ•°æ®åº“é…ç½®**ï¼šç¥¨æ®å­˜å‚¨éœ€è¦é…ç½®æ•°æ®åº“
- **âš–ï¸ è´Ÿè½½å‡è¡¡**ï¼šå¤šå®ä¾‹éƒ¨ç½²éœ€è¦å…±äº«ç¥¨æ®å­˜å‚¨

---

## 3. ğŸ¦„ Keycloakä¼ä¸šçº§è§£å†³æ–¹æ¡ˆ


### 3.1 Keycloakæ˜¯ä»€ä¹ˆ


> ğŸ’¡ **é€šä¿—æ¯”å–»**ï¼šKeycloakå°±åƒä¸€ä¸ªè¶…çº§æ™ºèƒ½çš„é—¨ç¦ç³»ç»Ÿï¼Œä¸ä»…èƒ½éªŒè¯ä½ çš„èº«ä»½ï¼Œè¿˜èƒ½ç®¡ç†ä½ åœ¨æ•´ä¸ªå¤§æ¥¼å†…çš„å„ç§æƒé™ï¼Œæ”¯æŒæŒ‡çº¹ã€åˆ·å¡ã€äººè„¸è¯†åˆ«ç­‰å¤šç§æ–¹å¼
> 
> **æŠ€æœ¯å®šä¹‰**ï¼šKeycloakæ˜¯Red Hatå¼€å‘çš„ç°ä»£åŒ–èº«ä»½å’Œè®¿é—®ç®¡ç†è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒOAuth 2.0ã€OpenID Connectã€SAMLç­‰ä¸»æµåè®®

**ğŸŒŸ Keycloakçš„æ ¸å¿ƒç‰¹è‰²**ï¼š

```
KeycloakåŠŸèƒ½æ¶æ„ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Keycloak Server                         â”‚
â”‚                                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚   Admin Console â”‚ â”‚   User Account  â”‚ â”‚   Welcome Page  â”‚ â”‚
â”‚ â”‚   ç®¡ç†æ§åˆ¶å°     â”‚ â”‚   ç”¨æˆ·è´¦æˆ·ç®¡ç†   â”‚ â”‚   æ¬¢è¿é¡µé¢      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚              Authentication Services                    â”‚ â”‚
â”‚ â”‚                    è®¤è¯æœåŠ¡                              â”‚ â”‚
â”‚ â”‚  OAuth 2.0  â”‚  OpenID Connect  â”‚  SAML 2.0  â”‚  LDAP   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚               Identity Providers                        â”‚ â”‚
â”‚ â”‚                 èº«ä»½æä¾›å•†                               â”‚ â”‚
â”‚ â”‚  Google  â”‚  Facebook  â”‚  GitHub  â”‚  LDAP  â”‚  æ•°æ®åº“   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      Applications       â”‚
                    â”‚         åº”ç”¨ç³»ç»Ÿ          â”‚
                    â”‚                         â”‚
                    â”‚  Web Apps â”‚ Mobile Apps â”‚
                    â”‚  å¾®æœåŠ¡   â”‚ API Gateway â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Keycloakçš„æ ¸å¿ƒåŠŸèƒ½


**ğŸ” èº«ä»½è®¤è¯åŠŸèƒ½**ï¼š
- **ğŸŒ å¤šåè®®æ”¯æŒ**ï¼šOAuth 2.0ã€OpenID Connectã€SAML 2.0
- **ğŸ”‘ å¤šå› ç´ è®¤è¯**ï¼šçŸ­ä¿¡ã€é‚®ç®±ã€Google Authenticator
- **ğŸ¢ ä¼ä¸šé›†æˆ**ï¼šLDAPã€Active Directory
- **ğŸ“± ç¤¾äº¤ç™»å½•**ï¼šGoogleã€Facebookã€GitHubç­‰

**ğŸ‘¥ ç”¨æˆ·ç®¡ç†åŠŸèƒ½**ï¼š
- **ğŸ“‹ ç”¨æˆ·æ³¨å†Œ**ï¼šè‡ªåŠ©æ³¨å†Œã€é‚®ç®±éªŒè¯
- **ğŸ”§ è´¦æˆ·ç®¡ç†**ï¼šå¯†ç é‡ç½®ã€ä¸ªäººä¿¡æ¯ä¿®æ”¹
- **ğŸ‘‘ è§’è‰²æƒé™**ï¼šåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰
- **ğŸ›ï¸ ç»„ç»‡æ¶æ„**ï¼šæ”¯æŒå¤æ‚çš„ç»„ç»‡å±‚çº§

**âš™ï¸ ç®¡ç†åŠŸèƒ½**ï¼š
- **ğŸ›ï¸ Webæ§åˆ¶å°**ï¼šå›¾å½¢åŒ–ç®¡ç†ç•Œé¢
- **ğŸ“Š å®¡è®¡æ—¥å¿—**ï¼šè¯¦ç»†çš„ç”¨æˆ·è¡Œä¸ºè®°å½•
- **ğŸ”§ ä¸»é¢˜å®šåˆ¶**ï¼šå¯è‡ªå®šä¹‰ç™»å½•é¡µé¢æ ·å¼
- **ğŸŒ å›½é™…åŒ–**ï¼šæ”¯æŒå¤šè¯­è¨€

### 3.3 Keycloakå®æˆ˜é…ç½®


**ğŸš€ Dockerå¿«é€Ÿéƒ¨ç½²**ï¼š

```bash
# å¯åŠ¨KeycloakæœåŠ¡å™¨
docker run -p 8080:8080 \
  -e KEYCLOAK_ADMIN=admin \
  -e KEYCLOAK_ADMIN_PASSWORD=admin123 \
  quay.io/keycloak/keycloak:latest start-dev
```

**ğŸ”§ åŸºç¡€é…ç½®æµç¨‹**ï¼š

```
Keycloaké…ç½®æ­¥éª¤ï¼š

1. åˆ›å»ºRealmï¼ˆé¢†åŸŸï¼‰
   â””â”€â”€ ç±»ä¼¼äºä¸€ä¸ªç‹¬ç«‹çš„è®¤è¯åŸŸ
   
2. é…ç½®Clientï¼ˆå®¢æˆ·ç«¯ï¼‰
   â”œâ”€â”€ Webåº”ç”¨
   â”œâ”€â”€ ç§»åŠ¨åº”ç”¨  
   â””â”€â”€ å¾®æœåŠ¡API

3. åˆ›å»ºç”¨æˆ·å’Œè§’è‰²
   â”œâ”€â”€ æ·»åŠ ç”¨æˆ·è´¦æˆ·
   â”œâ”€â”€ å®šä¹‰è§’è‰²æƒé™
   â””â”€â”€ åˆ†é…ç”¨æˆ·è§’è‰²

4. é…ç½®èº«ä»½æä¾›å•†
   â”œâ”€â”€ LDAPé›†æˆ
   â”œâ”€â”€ ç¤¾äº¤ç™»å½•
   â””â”€â”€ ç¬¬ä¸‰æ–¹SSO

5. å®šåˆ¶åŒ–è®¾ç½®
   â”œâ”€â”€ ç™»å½•é¡µé¢ä¸»é¢˜
   â”œâ”€â”€ å¯†ç ç­–ç•¥
   â””â”€â”€ å¤šå› ç´ è®¤è¯
```

**ğŸ“± å‰ç«¯é›†æˆç¤ºä¾‹**ï¼š

```javascript
// JavaScriptåº”ç”¨é›†æˆKeycloak
import Keycloak from 'keycloak-js';

// åˆå§‹åŒ–Keycloak
const keycloak = new Keycloak({
  url: 'http://localhost:8080/',
  realm: 'my-company',
  clientId: 'my-web-app'
});

// åˆå§‹åŒ–è®¤è¯
keycloak.init({
  onLoad: 'login-required',  // è¦æ±‚ç™»å½•
  checkLoginIframe: false
}).then(authenticated => {
  if (authenticated) {
    console.log('ç”¨æˆ·å·²ç™»å½•');
    console.log('ç”¨æˆ·ä¿¡æ¯:', keycloak.tokenParsed);
  }
});

// ç™»å‡º
function logout() {
  keycloak.logout({
    redirectUri: window.location.origin
  });
}

// è·å–ç”¨æˆ·ä¿¡æ¯
function getUserInfo() {
  return {
    username: keycloak.tokenParsed.preferred_username,
    email: keycloak.tokenParsed.email,
    roles: keycloak.realmAccess.roles
  };
}
```

**ğŸ¢ Spring Booté›†æˆ**ï¼š

```java
// Spring Bootåº”ç”¨é…ç½®
@Configuration
@EnableWebSecurity
public class SecurityConfig {
    
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http.authorizeHttpRequests(authz -> authz
                .requestMatchers("/public/**").permitAll()
                .anyRequest().authenticated()
            )
            .oauth2Login(oauth2 -> oauth2
                .userInfoEndpoint(userInfo -> userInfo
                    .userService(oidcUserService())
                )
            );
        return http.build();
    }
}
```

```yaml
# application.yml
spring:
  security:
    oauth2:
      client:
        registration:
          keycloak:
            client-id: my-spring-app
            client-secret: your-client-secret
            authorization-grant-type: authorization_code
            redirect-uri: http://localhost:8081/login/oauth2/code/keycloak
        provider:
          keycloak:
            authorization-uri: http://localhost:8080/realms/my-company/protocol/openid-connect/auth
            token-uri: http://localhost:8080/realms/my-company/protocol/openid-connect/token
            user-info-uri: http://localhost:8080/realms/my-company/protocol/openid-connect/userinfo
            jwk-set-uri: http://localhost:8080/realms/my-company/protocol/openid-connect/certs
```

### 3.4 Keycloaké«˜çº§åŠŸèƒ½


**ğŸ”„ ç”¨æˆ·è”é‚¦**ï¼š
```
å¤šæ•°æ®æºç”¨æˆ·ç®¡ç†ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Keycloak      â”‚    â”‚   External IDP  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚                 â”‚
â”‚   â”‚Local Usersâ”‚ â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚<-->â”‚ â”‚    LDAP     â”‚ â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚   â”‚   RBAC    â”‚ â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â”‚   Google    â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                       â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                       â”‚ â”‚  Facebook   â”‚ â”‚
                       â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§**ï¼š
- **ğŸ” å¯†ç ç­–ç•¥**ï¼šå¤æ‚åº¦è¦æ±‚ã€å®šæœŸæ›´æ¢
- **ğŸš« æš´åŠ›æ”»å‡»é˜²æŠ¤**ï¼šç™»å½•å¤±è´¥é”å®š
- **ğŸ• ä¼šè¯ç®¡ç†**ï¼šè¶…æ—¶æ§åˆ¶ã€å¹¶å‘ä¼šè¯é™åˆ¶
- **ğŸ“± è®¾å¤‡ç®¡ç†**ï¼šå¯ä¿¡è®¾å¤‡ã€è®¾å¤‡æ³¨å†Œ

---

## 4. â˜ï¸ Auth0äº‘ç«¯SaaSæ–¹æ¡ˆ


### 4.1 Auth0æ˜¯ä»€ä¹ˆ


> ğŸ’¡ **é€šä¿—æ¯”å–»**ï¼šAuth0å°±åƒä¸€ä¸ªä¸“ä¸šçš„ä¿å®‰å…¬å¸ï¼Œä½ ä¸éœ€è¦è‡ªå·±åŸ¹è®­ä¿å®‰ã€è´­ä¹°è®¾å¤‡ï¼Œç›´æ¥é›‡ä½£ä»–ä»¬æä¾›å®Œæ•´çš„å®‰ä¿æœåŠ¡
> 
> **æŠ€æœ¯å®šä¹‰**ï¼šAuth0æ˜¯ä¸€ä¸ªèº«ä»½éªŒè¯å’Œæˆæƒå¹³å°ï¼Œæä¾›äº‘ç«¯SaaSæœåŠ¡ï¼Œè®©å¼€å‘è€…å¯ä»¥å¿«é€Ÿä¸ºåº”ç”¨æ·»åŠ è®¤è¯åŠŸèƒ½

**ğŸŒ©ï¸ Auth0çš„æ ¸å¿ƒç†å¿µ**ï¼š

```
Auth0æœåŠ¡æ¶æ„ï¼š

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚         Auth0 Cloud             â”‚
                    â”‚                                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Your App      â”‚ â”‚ â”‚      Universal Login       â”‚ â”‚ â”‚   Management    â”‚
â”‚   ä½ çš„åº”ç”¨       â”‚<->â”‚      ç»Ÿä¸€ç™»å½•é¡µé¢           â”‚<->â”‚   Dashboard     â”‚
â”‚                 â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚   ç®¡ç†æ§åˆ¶å°     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚                                 â”‚ â”‚                 â”‚
â”‚ â”‚Auth0 SDK   â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚Auth0 SDK   â”‚ â”‚ â”‚ â”‚     Identity Providers      â”‚ â”‚ â”‚ â”‚   Rules     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚      èº«ä»½æä¾›å•†              â”‚ â”‚ â”‚ â”‚   è§„åˆ™å¼•æ“   â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚  Google â”‚ GitHub â”‚ LDAP   â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Auth0çš„æ ¸å¿ƒä¼˜åŠ¿


**âœ… å¼€å‘æ•ˆç‡ä¼˜åŠ¿**ï¼š
- **ğŸš€ å¿«é€Ÿé›†æˆ**ï¼šå‡ è¡Œä»£ç å³å¯å®Œæˆé›†æˆ
- **ğŸ“± å¤šå¹³å°æ”¯æŒ**ï¼šWebã€ç§»åŠ¨ç«¯ã€æ¡Œé¢åº”ç”¨
- **ğŸ”§ æ— éœ€ç»´æŠ¤**ï¼šæ— éœ€ç®¡ç†æœåŠ¡å™¨ã€æ•°æ®åº“
- **ğŸ“– ä¸°å¯Œæ–‡æ¡£**ï¼šè¯¦ç»†çš„æ–‡æ¡£å’Œç¤ºä¾‹

**ğŸ›¡ï¸ å®‰å…¨æ€§ä¼˜åŠ¿**ï¼š
- **ğŸ† ä¸“ä¸šå®‰å…¨**ï¼šç”±å®‰å…¨ä¸“å®¶å›¢é˜Ÿç»´æŠ¤
- **ğŸ”„ è‡ªåŠ¨æ›´æ–°**ï¼šå®‰å…¨è¡¥ä¸è‡ªåŠ¨åº”ç”¨
- **ğŸ“Š åˆè§„è®¤è¯**ï¼šSOC 2ã€ISO 27001ã€GDPRç­‰
- **ğŸ” å¨èƒæ£€æµ‹**ï¼šAIé©±åŠ¨çš„å¼‚å¸¸æ£€æµ‹

**ğŸŒ å…¨çƒåŒ–ä¼˜åŠ¿**ï¼š
- **âš¡ CDNåŠ é€Ÿ**ï¼šå…¨çƒèŠ‚ç‚¹ï¼Œè®¿é—®é€Ÿåº¦å¿«
- **ğŸŒ å¤šè¯­è¨€**ï¼šæ”¯æŒæ•°åç§è¯­è¨€
- **ğŸ“± ç§»åŠ¨ä¼˜åŒ–**ï¼šé’ˆå¯¹ç§»åŠ¨è®¾å¤‡ä¼˜åŒ–
- **â™¿ æ— éšœç¢**ï¼šç¬¦åˆå¯è®¿é—®æ€§æ ‡å‡†

### 4.3 Auth0å®æˆ˜é›†æˆ


**ğŸ”§ å‰ç«¯é›†æˆç¤ºä¾‹**ï¼š

```javascript
// Reactåº”ç”¨é›†æˆAuth0
import { Auth0Provider } from '@auth0/auth0-react';

// åº”ç”¨æ ¹ç»„ä»¶é…ç½®
function App() {
  return (
    <Auth0Provider
      domain="your-tenant.auth0.com"
      clientId="your-client-id"
      redirectUri={window.location.origin}
    >
      <MyApp />
    </Auth0Provider>
  );
}

// ç™»å½•ç»„ä»¶
import { useAuth0 } from '@auth0/auth0-react';

function LoginButton() {
  const { loginWithRedirect, logout, user, isAuthenticated } = useAuth0();

  if (isAuthenticated) {
    return (
      <div>
        <img src={user.picture} alt={user.name} />
        <h2>æ¬¢è¿, {user.name}!</h2>
        <button onClick={() => logout()}>ç™»å‡º</button>
      </div>
    );
  }

  return (
    <button onClick={() => loginWithRedirect()}>
      ç™»å½•
    </button>
  );
}
```

**ğŸ—ï¸ åç«¯APIä¿æŠ¤**ï¼š

```javascript
// Node.js Express APIä¿æŠ¤
const jwt = require('express-jwt');
const jwks = require('jwks-rsa');

// JWTéªŒè¯ä¸­é—´ä»¶
const jwtCheck = jwt({
  secret: jwks.expressJwtSecret({
    cache: true,
    rateLimit: true,
    jwksRequestsPerMinute: 5,
    jwksUri: 'https://your-tenant.auth0.com/.well-known/jwks.json'
  }),
  audience: 'your-api-identifier',
  issuer: 'https://your-tenant.auth0.com/',
  algorithms: ['RS256']
});

// ä¿æŠ¤APIç«¯ç‚¹
app.get('/api/protected', jwtCheck, (req, res) => {
  res.json({
    message: 'è¿™æ˜¯å—ä¿æŠ¤çš„æ•°æ®',
    user: req.user
  });
});
```

**ğŸ“± ç§»åŠ¨åº”ç”¨é›†æˆ**ï¼š

```swift
// iOS Swifté›†æˆ
import Auth0

class AuthService {
    static let shared = AuthService()
    
    func login() {
        Auth0
            .webAuth()
            .audience("your-api-identifier")
            .start { result in
                switch result {
                case .success(let credentials):
                    print("ç™»å½•æˆåŠŸ: \(credentials.accessToken)")
                    self.saveCredentials(credentials)
                case .failure(let error):
                    print("ç™»å½•å¤±è´¥: \(error)")
                }
            }
    }
    
    func logout() {
        Auth0
            .webAuth()
            .clearSession { result in
                switch result {
                case .success:
                    print("ç™»å‡ºæˆåŠŸ")
                    self.clearCredentials()
                case .failure(let error):
                    print("ç™»å‡ºå¤±è´¥: \(error)")
                }
            }
    }
}
```

### 4.4 Auth0é«˜çº§åŠŸèƒ½


**ğŸ”§ Rulesè§„åˆ™å¼•æ“**ï¼š

```javascript
// Auth0 Rules - ç™»å½•æ—¶è‡ªåŠ¨æ·»åŠ è§’è‰²
function addRolesToUser(user, context, callback) {
  // æ ¹æ®é‚®ç®±åŸŸååˆ†é…è§’è‰²
  const emailDomain = user.email.split('@')[1];
  
  if (emailDomain === 'company.com') {
    context.idToken['https://myapp.com/roles'] = ['employee'];
    
    // ç®¡ç†å‘˜é‚®ç®±
    if (user.email === 'admin@company.com') {
      context.idToken['https://myapp.com/roles'].push('admin');
    }
  }
  
  callback(null, user, context);
}

// å¤šå› ç´ è®¤è¯è§„åˆ™
function requireMFA(user, context, callback) {
  // ç®¡ç†å‘˜å¿…é¡»ä½¿ç”¨MFA
  if (user.app_metadata && user.app_metadata.roles.includes('admin')) {
    context.multifactor = {
      provider: 'any',
      allowRememberBrowser: false
    };
  }
  
  callback(null, user, context);
}
```

**ğŸ’° å®šä»·è€ƒè™‘**ï¼š

| è®¡åˆ’ç±»å‹ | **æœˆæ´»ç”¨æˆ·** | **åŠŸèƒ½ç‰¹æ€§** | **é€‚ç”¨åœºæ™¯** |
|---------|-------------|-------------|-------------|
| ğŸ†“ **å…è´¹ç‰ˆ** | `7,000 MAU` | åŸºç¡€SSOã€ç¤¾äº¤ç™»å½• | å°å‹é¡¹ç›®ã€æµ‹è¯• |
| ğŸ’¼ **å¼€å‘ç‰ˆ** | `$23/æœˆ` | æ— é™MAUã€åŸºç¡€åŠŸèƒ½ | åˆåˆ›å…¬å¸ |
| ğŸ¢ **ä¸“ä¸šç‰ˆ** | `$0.0350/MAU` | é«˜çº§åŠŸèƒ½ã€SLAä¿éšœ | ä¼ä¸šåº”ç”¨ |
| ğŸ›ï¸ **ä¼ä¸šç‰ˆ** | `å®šåˆ¶æŠ¥ä»·` | ç§æœ‰äº‘ã€ä¸“å±æ”¯æŒ | å¤§å‹ä¼ä¸š |

---

## 5. ğŸŒ± Spring Security OAuth/OIDC


### 5.1 Spring Security OAuth/OIDCæ˜¯ä»€ä¹ˆ


> ğŸ’¡ **é€šä¿—æ¯”å–»**ï¼šSpring Securityå°±åƒä¸€ä¸ªå¯ä»¥è‡ªç”±ç»„è£…çš„å®‰é˜²ç³»ç»Ÿï¼Œä½ å¯ä»¥é€‰æ‹©ä¸åŒçš„é—¨é”ã€ç›‘æ§è®¾å¤‡ã€è­¦æŠ¥ç³»ç»Ÿæ¥æ­å»ºé€‚åˆè‡ªå·±çš„å®‰å…¨æ–¹æ¡ˆ
> 
> **æŠ€æœ¯å®šä¹‰**ï¼šSpring Security OAuth/OIDCæ˜¯Springç”Ÿæ€ç³»ç»Ÿä¸­çš„å®‰å…¨æ¡†æ¶ï¼Œæä¾›OAuth 2.0å’ŒOpenID Connectçš„å®Œæ•´å®ç°

**ğŸ—ï¸ Spring Securityæ¶æ„**ï¼š

```
Spring Security OAuth/OIDCæ¶æ„ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Spring Boot Application                 â”‚
â”‚                                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                 Spring Security                         â”‚ â”‚
â”‚ â”‚                                                         â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚   Filter    â”‚ â”‚    OAuth2   â”‚ â”‚       OIDC          â”‚ â”‚ â”‚
â”‚ â”‚ â”‚   Chain     â”‚ â”‚   Client    â”‚ â”‚      Client         â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚                                                         â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚Authorizationâ”‚ â”‚ Resource    â”‚ â”‚   Method Security   â”‚ â”‚ â”‚
â”‚ â”‚ â”‚  Server     â”‚ â”‚  Server     â”‚ â”‚   æ–¹æ³•çº§å®‰å…¨        â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚     External Identity       â”‚
                â”‚       å¤–éƒ¨èº«ä»½æä¾›å•†         â”‚
                â”‚                             â”‚
                â”‚ Google â”‚ GitHub â”‚ Keycloak â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Spring Securityçš„æ ¸å¿ƒç‰¹ç‚¹


**âœ… æŠ€æœ¯ä¼˜åŠ¿**ï¼š
- **ğŸ§© é«˜åº¦æ¨¡å—åŒ–**ï¼šå¯ä»¥æŒ‰éœ€é€‰æ‹©ç»„ä»¶
- **ğŸ”§ æ·±åº¦å®šåˆ¶**ï¼šå‡ ä¹æ‰€æœ‰è¡Œä¸ºéƒ½å¯ä»¥è‡ªå®šä¹‰
- **ğŸ—ï¸ åŸç”Ÿé›†æˆ**ï¼šä¸Springç”Ÿæ€å®Œç¾èåˆ
- **ğŸ“š ç¤¾åŒºæ”¯æŒ**ï¼šåºå¤§çš„ç¤¾åŒºå’Œä¸°å¯Œçš„èµ„æ–™

**âš ï¸ ä½¿ç”¨è€ƒè™‘**ï¼š
- **ğŸ“ˆ å­¦ä¹ æ›²çº¿**ï¼šé…ç½®ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦æ·±å…¥ç†è§£
- **ğŸ”§ å¼€å‘å·¥ä½œé‡**ï¼šéœ€è¦æ›´å¤šçš„å¼€å‘å’Œé…ç½®å·¥ä½œ
- **ğŸ› ï¸ ç»´æŠ¤æˆæœ¬**ï¼šéœ€è¦è‡ªå·±ç»´æŠ¤å’Œæ›´æ–°

### 5.3 OAuth2å®¢æˆ·ç«¯é…ç½®


**ğŸ”§ åŸºç¡€é…ç½®ç¤ºä¾‹**ï¼š

```java
// Spring Securityé…ç½®ç±»
@Configuration
@EnableWebSecurity
public class OAuth2SecurityConfig {

    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            .authorizeHttpRequests(authorize -> authorize
                .requestMatchers("/", "/login**", "/error**").permitAll()
                .anyRequest().authenticated()
            )
            .oauth2Login(oauth2 -> oauth2
                .loginPage("/login")
                .defaultSuccessUrl("/dashboard")
                .userInfoEndpoint(userInfo -> userInfo
                    .userService(customOAuth2UserService())
                )
            )
            .logout(logout -> logout
                .logoutSuccessUrl("/")
                .invalidateHttpSession(true)
                .clearAuthentication(true)
            );
        
        return http.build();
    }

    @Bean
    public OAuth2UserService<OAuth2UserRequest, OAuth2User> customOAuth2UserService() {
        return new CustomOAuth2UserService();
    }
}
```

**ğŸ“‹ é…ç½®æ–‡ä»¶è®¾ç½®**ï¼š

```yaml
# application.yml
spring:
  security:
    oauth2:
      client:
        registration:
          # Google OAuth2é…ç½®
          google:
            client-id: your-google-client-id
            client-secret: your-google-client-secret
            scope:
              - openid
              - profile
              - email
            
          # GitHub OAuth2é…ç½®  
          github:
            client-id: your-github-client-id
            client-secret: your-github-client-secret
            scope:
              - read:user
              - user:email
            
          # è‡ªå®šä¹‰OIDCæä¾›å•†
          custom-oidc:
            client-id: my-client-id
            client-secret: my-client-secret
            authorization-grant-type: authorization_code
            redirect-uri: http://localhost:8080/login/oauth2/code/custom-oidc
            scope: openid,profile,email
            
        provider:
          custom-oidc:
            authorization-uri: https://auth.example.com/oauth2/authorize
            token-uri: https://auth.example.com/oauth2/token
            user-info-uri: https://auth.example.com/userinfo
            jwk-set-uri: https://auth.example.com/.well-known/jwks.json
            user-name-attribute: sub
```

**ğŸ‘¤ è‡ªå®šä¹‰ç”¨æˆ·æœåŠ¡**ï¼š

```java
// è‡ªå®šä¹‰OAuth2ç”¨æˆ·æœåŠ¡
@Service
public class CustomOAuth2UserService implements OAuth2UserService<OAuth2UserRequest, OAuth2User> {
    
    private final DefaultOAuth2UserService delegate = new DefaultOAuth2UserService();
    
    @Override
    public OAuth2User loadUser(OAuth2UserRequest userRequest) throws OAuth2AuthenticationException {
        OAuth2User oauth2User = delegate.loadUser(userRequest);
        
        // è·å–æ³¨å†ŒIDï¼ˆgoogle, githubç­‰ï¼‰
        String registrationId = userRequest.getClientRegistration().getRegistrationId();
        
        // è·å–ç”¨æˆ·å±æ€§åç§°
        String userNameAttributeName = userRequest.getClientRegistration()
                .getProviderDetails()
                .getUserInfoEndpoint()
                .getUserNameAttributeName();
        
        // å¤„ç†ç”¨æˆ·ä¿¡æ¯
        return processOAuth2User(oauth2User, registrationId, userNameAttributeName);
    }
    
    private OAuth2User processOAuth2User(OAuth2User oauth2User, String registrationId, String userNameAttributeName) {
        // æå–ç”¨æˆ·ä¿¡æ¯
        String email = oauth2User.getAttribute("email");
        String name = oauth2User.getAttribute("name");
        
        // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²å­˜åœ¨
        User user = userRepository.findByEmail(email)
                .orElseGet(() -> {
                    // åˆ›å»ºæ–°ç”¨æˆ·
                    User newUser = new User();
                    newUser.setEmail(email);
                    newUser.setName(name);
                    newUser.setProvider(registrationId);
                    return userRepository.save(newUser);
                });
        
        // è¿”å›è‡ªå®šä¹‰çš„OAuth2Userå®ç°
        return new CustomOAuth2User(oauth2User.getAttributes(), userNameAttributeName, user);
    }
}
```

### 5.4 OAuth2èµ„æºæœåŠ¡å™¨é…ç½®


**ğŸ›¡ï¸ APIä¿æŠ¤é…ç½®**ï¼š

```java
// OAuth2èµ„æºæœåŠ¡å™¨é…ç½®
@Configuration
@EnableWebSecurity
@EnableGlobalMethodSecurity(prePostEnabled = true)
public class ResourceServerConfig {

    @Bean
    public SecurityFilterChain resourceServerFilterChain(HttpSecurity http) throws Exception {
        http
            .authorizeHttpRequests(authorize -> authorize
                .requestMatchers("/api/public/**").permitAll()
                .requestMatchers("/api/admin/**").hasRole("ADMIN")
                .requestMatchers("/api/user/**").hasRole("USER")
                .anyRequest().authenticated()
            )
            .oauth2ResourceServer(oauth2 -> oauth2
                .jwt(jwt -> jwt
                    .jwtAuthenticationConverter(jwtAuthenticationConverter())
                    .jwtDecoder(jwtDecoder())
                )
            );
        
        return http.build();
    }

    @Bean
    public JwtDecoder jwtDecoder() {
        // ä»æˆæƒæœåŠ¡å™¨è·å–å…¬é’¥
        return JwtDecoders.fromIssuerLocation("https://auth.example.com");
    }

    @Bean
    public JwtAuthenticationConverter jwtAuthenticationConverter() {
        JwtGrantedAuthoritiesConverter authoritiesConverter = new JwtGrantedAuthoritiesConverter();
        authoritiesConverter.setAuthorityPrefix("ROLE_");
        authoritiesConverter.setAuthoritiesClaimName("roles");

        JwtAuthenticationConverter jwtConverter = new JwtAuthenticationConverter();
        jwtConverter.setJwtGrantedAuthoritiesConverter(authoritiesConverter);
        return jwtConverter;
    }
}
```

**ğŸ¯ æ–¹æ³•çº§å®‰å…¨**ï¼š

```java
// ä½¿ç”¨æ–¹æ³•çº§å®‰å…¨ä¿æŠ¤ä¸šåŠ¡é€»è¾‘
@RestController
@RequestMapping("/api")
public class SecureController {

    @GetMapping("/user/profile")
    @PreAuthorize("hasRole('USER')")
    public UserProfile getUserProfile(Authentication authentication) {
        String username = authentication.getName();
        return userService.getUserProfile(username);
    }

    @PostMapping("/admin/users")
    @PreAuthorize("hasRole('ADMIN')")
    public ResponseEntity<User> createUser(@RequestBody CreateUserRequest request) {
        User user = userService.createUser(request);
        return ResponseEntity.ok(user);
    }

    @GetMapping("/data/{id}")
    @PreAuthorize("@dataService.canAccess(#id, authentication.name)")
    public DataResponse getData(@PathVariable Long id, Authentication authentication) {
        return dataService.getData(id);
    }
}
```

### 5.5 æˆæƒæœåŠ¡å™¨å®ç°


**ğŸ—ï¸ ç®€å•æˆæƒæœåŠ¡å™¨**ï¼š

```java
// Spring Authorization Serveré…ç½®
@Configuration
@EnableAuthorizationServer
public class AuthorizationServerConfig {

    @Bean
    public RegisteredClientRepository registeredClientRepository() {
        RegisteredClient registeredClient = RegisteredClient.withId(UUID.randomUUID().toString())
                .clientId("my-client")
                .clientSecret("{noop}secret")
                .clientAuthenticationMethod(ClientAuthenticationMethod.CLIENT_SECRET_BASIC)
                .authorizationGrantType(AuthorizationGrantType.AUTHORIZATION_CODE)
                .authorizationGrantType(AuthorizationGrantType.REFRESH_TOKEN)
                .redirectUri("http://localhost:8080/login/oauth2/code/my-client")
                .scope(OidcScopes.OPENID)
                .scope(OidcScopes.PROFILE)
                .scope("read")
                .scope("write")
                .build();

        return new InMemoryRegisteredClientRepository(registeredClient);
    }

    @Bean
    public JWKSource<SecurityContext> jwkSource() {
        KeyPair keyPair = generateRsaKey();
        RSAPublicKey publicKey = (RSAPublicKey) keyPair.getPublic();
        RSAPrivateKey privateKey = (RSAPrivateKey) keyPair.getPrivate();
        RSAKey rsaKey = new RSAKey.Builder(publicKey)
                .privateKey(privateKey)
                .keyID(UUID.randomUUID().toString())
                .build();
        JWKSet jwkSet = new JWKSet(rsaKey);
        return new ImmutableJWKSet<>(jwkSet);
    }

    private static KeyPair generateRsaKey() {
        KeyPair keyPair;
        try {
            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance("RSA");
            keyPairGenerator.initialize(2048);
            keyPair = keyPairGenerator.generateKeyPair();
        } catch (Exception ex) {
            throw new IllegalStateException(ex);
        }
        return keyPair;
    }
}
```

---

## 6. âš–ï¸ æ–¹æ¡ˆå…¨é¢å¯¹æ¯”åˆ†æ


### 6.1 åŠŸèƒ½ç‰¹æ€§å¯¹æ¯”


| ç‰¹æ€§åˆ†ç±» | **CAS** | **Keycloak** | **Auth0** | **Spring Security** |
|---------|---------|-------------|-----------|-------------------|
| **ğŸ” åè®®æ”¯æŒ** | | | | |
| CASåè®® | âœ… åŸç”Ÿæ”¯æŒ | âŒ ä¸æ”¯æŒ | âŒ ä¸æ”¯æŒ | âŒ ä¸æ”¯æŒ |
| OAuth 2.0 | âš ï¸ æ’ä»¶æ”¯æŒ | âœ… å®Œæ•´æ”¯æŒ | âœ… å®Œæ•´æ”¯æŒ | âœ… å®Œæ•´æ”¯æŒ |
| OIDC | âš ï¸ æ’ä»¶æ”¯æŒ | âœ… å®Œæ•´æ”¯æŒ | âœ… å®Œæ•´æ”¯æŒ | âœ… å®Œæ•´æ”¯æŒ |
| SAML 2.0 | âš ï¸ æœ‰é™æ”¯æŒ | âœ… å®Œæ•´æ”¯æŒ | âœ… å®Œæ•´æ”¯æŒ | âš ï¸ éœ€è¦é¢å¤–é…ç½® |
| **ğŸ‘¥ ç”¨æˆ·ç®¡ç†** | | | | |
| ç”¨æˆ·æ³¨å†Œ | âš ï¸ åŸºç¡€åŠŸèƒ½ | âœ… ä¸°å¯ŒåŠŸèƒ½ | âœ… ä¸°å¯ŒåŠŸèƒ½ | ğŸ”§ éœ€è¦å¼€å‘ |
| å¯†ç é‡ç½® | âš ï¸ åŸºç¡€åŠŸèƒ½ | âœ… å®Œæ•´æµç¨‹ | âœ… å®Œæ•´æµç¨‹ | ğŸ”§ éœ€è¦å¼€å‘ |
| å¤šå› ç´ è®¤è¯ | âš ï¸ æ’ä»¶æ”¯æŒ | âœ… å†…ç½®æ”¯æŒ | âœ… å†…ç½®æ”¯æŒ | ğŸ”§ éœ€è¦å¼€å‘ |
| ç¤¾äº¤ç™»å½• | âŒ ä¸æ”¯æŒ | âœ… æ”¯æŒå¤šç§ | âœ… æ”¯æŒå¤šç§ | âœ… é…ç½®æ”¯æŒ |
| **ğŸ¢ ä¼ä¸šé›†æˆ** | | | | |
| LDAP/AD | âœ… åŸç”Ÿæ”¯æŒ | âœ… åŸç”Ÿæ”¯æŒ | âœ… åŸç”Ÿæ”¯æŒ | âœ… é…ç½®æ”¯æŒ |
| è‡ªå®šä¹‰è®¤è¯ | âœ… æ”¯æŒ | âœ… çµæ´»æ”¯æŒ | âœ… Rulesæ”¯æŒ | âœ… å®Œå…¨è‡ªå®šä¹‰ |
| å®¡è®¡æ—¥å¿— | âš ï¸ åŸºç¡€åŠŸèƒ½ | âœ… è¯¦ç»†æ—¥å¿— | âœ… è¯¦ç»†æ—¥å¿— | ğŸ”§ éœ€è¦å¼€å‘ |

### 6.2 éƒ¨ç½²å’Œè¿ç»´å¯¹æ¯”


| è¿ç»´æ–¹é¢ | **CAS** | **Keycloak** | **Auth0** | **Spring Security** |
|---------|---------|-------------|-----------|-------------------|
| **ğŸš€ éƒ¨ç½²å¤æ‚åº¦** | | | | |
| å®‰è£…é…ç½® | â­â­â­ ä¸­ç­‰ | â­â­â­â­ è¾ƒå¤æ‚ | â­ éå¸¸ç®€å• | â­â­â­â­â­ å¤æ‚ |
| ä¾èµ–ç»„ä»¶ | æ•°æ®åº“ã€Tomcat | æ•°æ®åº“ã€Javaè¿è¡Œæ—¶ | æ— ï¼ˆSaaSï¼‰ | å®Œæ•´åº”ç”¨æ ˆ |
| **ğŸ”§ ç»´æŠ¤å·¥ä½œ** | | | | |
| æœåŠ¡å™¨ç»´æŠ¤ | âœ… éœ€è¦ç»´æŠ¤ | âœ… éœ€è¦ç»´æŠ¤ | âŒ æ— éœ€ç»´æŠ¤ | âœ… éœ€è¦ç»´æŠ¤ |
| å®‰å…¨æ›´æ–° | ğŸ”§ æ‰‹åŠ¨æ›´æ–° | ğŸ”§ æ‰‹åŠ¨æ›´æ–° | âœ… è‡ªåŠ¨æ›´æ–° | ğŸ”§ æ‰‹åŠ¨æ›´æ–° |
| å¤‡ä»½æ¢å¤ | ğŸ”§ éœ€è¦é…ç½® | ğŸ”§ éœ€è¦é…ç½® | âœ… è‡ªåŠ¨å¤„ç† | ğŸ”§ éœ€è¦é…ç½® |
| **ğŸ“Š ç›‘æ§å‘Šè­¦** | | | | |
| å†…ç½®ç›‘æ§ | âš ï¸ åŸºç¡€åŠŸèƒ½ | âœ… ä¸°å¯ŒæŒ‡æ ‡ | âœ… è¯¦ç»†ç›‘æ§ | ğŸ”§ éœ€è¦å¼€å‘ |
| å¥åº·æ£€æŸ¥ | âš ï¸ åŸºç¡€åŠŸèƒ½ | âœ… å®Œæ•´æ”¯æŒ | âœ… è‡ªåŠ¨ç›‘æ§ | ğŸ”§ éœ€è¦é…ç½® |

### 6.3 æˆæœ¬åˆ†æå¯¹æ¯”


**ğŸ’° æ€»ä½“æˆæœ¬å¯¹æ¯”**ï¼š

```
æˆæœ¬æ„æˆåˆ†æï¼š

CASï¼š
â”œâ”€â”€ ğŸ’» æœåŠ¡å™¨æˆæœ¬ï¼šä¸­ç­‰ï¼ˆéœ€è¦ä¸“ç”¨æœåŠ¡å™¨ï¼‰
â”œâ”€â”€ ğŸ‘¨â€ğŸ’» å¼€å‘æˆæœ¬ï¼šä¸­ç­‰ï¼ˆåŸºç¡€é…ç½®ï¼‰
â”œâ”€â”€ ğŸ”§ ç»´æŠ¤æˆæœ¬ï¼šä¸­ç­‰ï¼ˆéœ€è¦æŒç»­ç»´æŠ¤ï¼‰
â””â”€â”€ ğŸ“š å­¦ä¹ æˆæœ¬ï¼šä½ï¼ˆåè®®ç®€å•ï¼‰

Keycloakï¼š
â”œâ”€â”€ ğŸ’» æœåŠ¡å™¨æˆæœ¬ï¼šè¾ƒé«˜ï¼ˆèµ„æºæ¶ˆè€—å¤§ï¼‰
â”œâ”€â”€ ğŸ‘¨â€ğŸ’» å¼€å‘æˆæœ¬ï¼šä¸­ç­‰ï¼ˆé…ç½®è¾ƒå¤æ‚ï¼‰
â”œâ”€â”€ ğŸ”§ ç»´æŠ¤æˆæœ¬ï¼šè¾ƒé«˜ï¼ˆåŠŸèƒ½å¤æ‚ï¼‰
â””â”€â”€ ğŸ“š å­¦ä¹ æˆæœ¬ï¼šä¸­ç­‰ï¼ˆåŠŸèƒ½ä¸°å¯Œï¼‰

Auth0ï¼š
â”œâ”€â”€ ğŸ’» æœåŠ¡å™¨æˆæœ¬ï¼šæ— ï¼ˆSaaSæœåŠ¡ï¼‰
â”œâ”€â”€ ğŸ‘¨â€ğŸ’» å¼€å‘æˆæœ¬ï¼šä½ï¼ˆSDKç®€å•ï¼‰
â”œâ”€â”€ ğŸ”§ ç»´æŠ¤æˆæœ¬ï¼šæ— ï¼ˆæ‰˜ç®¡æœåŠ¡ï¼‰
â”œâ”€â”€ ğŸ’³ æœåŠ¡è´¹ç”¨ï¼šæŒ‰ç”¨æˆ·è®¡è´¹
â””â”€â”€ ğŸ“š å­¦ä¹ æˆæœ¬ï¼šä½ï¼ˆæ–‡æ¡£å®Œå–„ï¼‰

Spring Securityï¼š
â”œâ”€â”€ ğŸ’» æœåŠ¡å™¨æˆæœ¬ï¼šé«˜ï¼ˆéœ€è¦å®Œæ•´åº”ç”¨æ ˆï¼‰
â”œâ”€â”€ ğŸ‘¨â€ğŸ’» å¼€å‘æˆæœ¬ï¼šé«˜ï¼ˆéœ€è¦å¤§é‡å¼€å‘ï¼‰
â”œâ”€â”€ ğŸ”§ ç»´æŠ¤æˆæœ¬ï¼šé«˜ï¼ˆè‡ªå·±ç»´æŠ¤å…¨éƒ¨ï¼‰
â””â”€â”€ ğŸ“š å­¦ä¹ æˆæœ¬ï¼šé«˜ï¼ˆæŠ€æœ¯å¤æ‚ï¼‰
```

### 6.4 é€‚ç”¨åœºæ™¯å¯¹æ¯”


| ä½¿ç”¨åœºæ™¯ | **æ¨èæ–¹æ¡ˆ** | **åŸå› è¯´æ˜** |
|---------|-------------|-------------|
| **ğŸ¢ ä¼ ç»Ÿä¼ä¸šå†…ç½‘** | `CAS` | ç®€å•å¯é ï¼Œæˆç†Ÿç¨³å®šï¼Œä¸ç°æœ‰ç³»ç»Ÿé›†æˆå®¹æ˜“ |
| **ğŸŒ ç°ä»£åŒ–ä¼ä¸šåº”ç”¨** | `Keycloak` | åŠŸèƒ½å…¨é¢ï¼Œæ”¯æŒç°ä»£åè®®ï¼Œå¼€æºå…è´¹ |
| **ğŸš€ å¿«é€Ÿé¡¹ç›®ä¸Šçº¿** | `Auth0` | é›¶ç»´æŠ¤æˆæœ¬ï¼Œå¿«é€Ÿé›†æˆï¼Œä¸“ä¸šæœåŠ¡ |
| **ğŸ”§ é«˜åº¦å®šåˆ¶éœ€æ±‚** | `Spring Security` | å®Œå…¨å¯æ§ï¼Œæ·±åº¦å®šåˆ¶ï¼ŒæŠ€æœ¯æ ˆç»Ÿä¸€ |
| **ğŸ’° é¢„ç®—å—é™é¡¹ç›®** | `Keycloak` | å¼€æºå…è´¹ï¼ŒåŠŸèƒ½å®Œæ•´ï¼Œç¤¾åŒºæ”¯æŒå¥½ |
| **ğŸŒ å…¨çƒåŒ–åº”ç”¨** | `Auth0` | å…¨çƒCDNï¼Œå¤šè¯­è¨€æ”¯æŒï¼Œåˆè§„è®¤è¯ |
| **ğŸ” é«˜å®‰å…¨è¦æ±‚** | `Keycloak/Auth0` | ä¸“ä¸šå®‰å…¨å›¢é˜Ÿï¼Œå®šæœŸå®‰å…¨æ›´æ–° |
| **ğŸ—ï¸ å¾®æœåŠ¡æ¶æ„** | `Keycloak/Auth0` | APIå‹å¥½ï¼Œå®¹å™¨åŒ–éƒ¨ç½²ï¼Œäº‘åŸç”Ÿ |

---

## 7. ğŸ¯ é€‰å‹å†³ç­–æŒ‡å—


### 7.1 å†³ç­–çŸ©é˜µ


**ğŸ“Š é€‰å‹å†³ç­–æµç¨‹å›¾**ï¼š

```
SSOæ–¹æ¡ˆé€‰å‹å†³ç­–æ ‘ï¼š

å¼€å§‹é€‰å‹
    â”‚
    â”œâ”€ é¢„ç®—å……è¶³ï¼Œè¿½æ±‚å¿«é€Ÿä¸Šçº¿ï¼Ÿ
    â”‚   â””â”€ æ˜¯ â†’ Auth0 âœ…
    â”‚
    â”œâ”€ å·²æœ‰SpringæŠ€æœ¯æ ˆï¼Œéœ€è¦æ·±åº¦å®šåˆ¶ï¼Ÿ
    â”‚   â””â”€ æ˜¯ â†’ Spring Security âœ…
    â”‚
    â”œâ”€ ä¼ ç»Ÿä¼ä¸šç¯å¢ƒï¼Œè¿½æ±‚ç®€å•ç¨³å®šï¼Ÿ
    â”‚   â””â”€ æ˜¯ â†’ CAS âœ…
    â”‚
    â””â”€ ç°ä»£åŒ–åº”ç”¨ï¼ŒåŠŸèƒ½è¦æ±‚å…¨é¢ï¼Ÿ
        â””â”€ æ˜¯ â†’ Keycloak âœ…
```

### 7.2 æŠ€æœ¯é€‰å‹è¯„ä¼°è¡¨


**â­ è¯„åˆ†æ ‡å‡†**ï¼š1åˆ†ï¼ˆå·®ï¼‰ - 5åˆ†ï¼ˆä¼˜ç§€ï¼‰

| è¯„ä¼°ç»´åº¦ | **CAS** | **Keycloak** | **Auth0** | **Spring Security** |
|---------|---------|-------------|-----------|-------------------|
| **ğŸš€ ä¸Šæ‰‹éš¾åº¦** | 4â­â­â­â­ | 3â­â­â­ | 5â­â­â­â­â­ | 2â­â­ |
| **ğŸ”§ åŠŸèƒ½ä¸°å¯Œåº¦** | 2â­â­ | 5â­â­â­â­â­ | 5â­â­â­â­â­ | 4â­â­â­â­ |
| **ğŸ—ï¸ æ‰©å±•æ€§** | 3â­â­â­ | 4â­â­â­â­ | 3â­â­â­ | 5â­â­â­â­â­ |
| **ğŸ’° æˆæœ¬æ§åˆ¶** | 4â­â­â­â­ | 5â­â­â­â­â­ | 2â­â­ | 3â­â­â­ |
| **ğŸ›¡ï¸ å®‰å…¨æ€§** | 4â­â­â­â­ | 4â­â­â­â­ | 5â­â­â­â­â­ | 4â­â­â­â­ |
| **ğŸ“š ç¤¾åŒºæ”¯æŒ** | 3â­â­â­ | 4â­â­â­â­ | 4â­â­â­â­ | 5â­â­â­â­â­ |
| **ğŸ”§ è¿ç»´éš¾åº¦** | 3â­â­â­ | 2â­â­ | 5â­â­â­â­â­ | 2â­â­ |
| **âš¡ æ€§èƒ½è¡¨ç°** | 4â­â­â­â­ | 3â­â­â­ | 4â­â­â­â­ | 4â­â­â­â­ |

### 7.3 å®é™…é€‰å‹å»ºè®®


**ğŸ¯ æŒ‰å›¢é˜Ÿè§„æ¨¡é€‰æ‹©**ï¼š

```
å›¢é˜Ÿè§„æ¨¡å»ºè®®ï¼š

ğŸ‘¤ å°å›¢é˜Ÿï¼ˆ1-5äººï¼‰ï¼š
â”œâ”€â”€ é¦–é€‰ï¼šAuth0ï¼ˆå¿«é€Ÿä¸Šçº¿ï¼Œæ— ç»´æŠ¤ï¼‰
â””â”€â”€ å¤‡é€‰ï¼šSpring Securityï¼ˆæŠ€æœ¯æ ˆç»Ÿä¸€ï¼‰

ğŸ‘¥ ä¸­ç­‰å›¢é˜Ÿï¼ˆ5-20äººï¼‰ï¼š
â”œâ”€â”€ é¦–é€‰ï¼šKeycloakï¼ˆåŠŸèƒ½å…¨é¢ï¼Œæˆæœ¬å¯æ§ï¼‰
â””â”€â”€ å¤‡é€‰ï¼šAuth0ï¼ˆè¿½æ±‚ç¨³å®šçš„è¯ï¼‰

ğŸ¢ å¤§å›¢é˜Ÿï¼ˆ20+äººï¼‰ï¼š
â”œâ”€â”€ é¦–é€‰ï¼šKeycloakï¼ˆå¼€æºï¼Œå¯æ§åˆ¶ï¼‰
â”œâ”€â”€ å¤‡é€‰ï¼šSpring Securityï¼ˆæ·±åº¦å®šåˆ¶ï¼‰
â””â”€â”€ ç‰¹æ®Šï¼šCASï¼ˆä¼ ç»Ÿä¼ä¸šç¯å¢ƒï¼‰
```

**ğŸ’¡ æŒ‰é¡¹ç›®ç‰¹ç‚¹é€‰æ‹©**ï¼š

```
é¡¹ç›®ç‰¹ç‚¹åŒ¹é…ï¼š

ğŸš€ å¿«é€ŸåŸå‹/MVPï¼š
â””â”€â”€ Auth0ï¼ˆå‡ å°æ—¶å®Œæˆé›†æˆï¼‰

ğŸ¢ ä¼ä¸šçº§åº”ç”¨ï¼š
â”œâ”€â”€ Keycloakï¼ˆåŠŸèƒ½å®Œæ•´ï¼Œä¼ä¸šçº§ç‰¹æ€§ï¼‰
â””â”€â”€ CASï¼ˆä¼ ç»Ÿä¼ä¸šç¯å¢ƒï¼‰

ğŸ”§ é«˜åº¦å®šåˆ¶ï¼š
â””â”€â”€ Spring Securityï¼ˆå®Œå…¨å¯æ§ï¼‰

ğŸ’° æˆæœ¬æ•æ„Ÿï¼š
â”œâ”€â”€ Keycloakï¼ˆå¼€æºå…è´¹ï¼‰
â””â”€â”€ Spring Securityï¼ˆè‡ªä¸»å¼€å‘ï¼‰

ğŸŒ å…¨çƒåŒ–éƒ¨ç½²ï¼š
â””â”€â”€ Auth0ï¼ˆå…¨çƒCDNï¼Œå¤šåœ°åŸŸï¼‰
```

### 7.4 è¿ç§»ç­–ç•¥å»ºè®®


**ğŸ”„ å¹³æ»‘è¿ç§»æ–¹æ¡ˆ**ï¼š

```
è¿ç§»è·¯å¾„è§„åˆ’ï¼š

ç°æœ‰ç³»ç»Ÿ â†’ ç›®æ ‡ç³»ç»Ÿ

ä¼ ç»Ÿè®¤è¯ â†’ CASï¼š
â”œâ”€â”€ é˜¶æ®µ1ï¼šéƒ¨ç½²CASæœåŠ¡å™¨
â”œâ”€â”€ é˜¶æ®µ2ï¼šåº”ç”¨é€æ­¥æ¥å…¥
â””â”€â”€ é˜¶æ®µ3ï¼šä¸‹çº¿åŸè®¤è¯ç³»ç»Ÿ

CAS â†’ Keycloakï¼š
â”œâ”€â”€ é˜¶æ®µ1ï¼šæ•°æ®è¿ç§»ï¼ˆç”¨æˆ·ã€è§’è‰²ï¼‰
â”œâ”€â”€ é˜¶æ®µ2ï¼šåè®®é€‚é…ï¼ˆCAS â†’ OIDCï¼‰
â””â”€â”€ é˜¶æ®µ3ï¼šå®¢æˆ·ç«¯æ›´æ–°

è‡ªå»ºç³»ç»Ÿ â†’ Auth0ï¼š
â”œâ”€â”€ é˜¶æ®µ1ï¼šç”¨æˆ·æ•°æ®å¯¼å…¥
â”œâ”€â”€ é˜¶æ®µ2ï¼šåº”ç”¨SDKå‡çº§
â””â”€â”€ é˜¶æ®µ3ï¼šDNSåˆ‡æ¢

ä»»æ„æ–¹æ¡ˆ â†’ Spring Securityï¼š
â”œâ”€â”€ é˜¶æ®µ1ï¼šæ–°åº”ç”¨ä½¿ç”¨æ–°æ–¹æ¡ˆ
â”œâ”€â”€ é˜¶æ®µ2ï¼šè€åº”ç”¨é€æ­¥æ”¹é€ 
â””â”€â”€ é˜¶æ®µ3ï¼šç»Ÿä¸€æŠ€æœ¯æ ˆ
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ SSOæœ¬è´¨ï¼šä¸€æ¬¡ç™»å½•ï¼Œå¤šåº”ç”¨è®¿é—®ï¼Œæå‡ç”¨æˆ·ä½“éªŒå’Œå®‰å…¨ç®¡ç†
ğŸ”¸ æ–¹æ¡ˆé€‰æ‹©ï¼šæ²¡æœ‰æœ€å¥½çš„æ–¹æ¡ˆï¼Œåªæœ‰æœ€é€‚åˆçš„æ–¹æ¡ˆ
ğŸ”¸ æŠ€æœ¯æ ˆåŒ¹é…ï¼šé€‰æ‹©ä¸ç°æœ‰æŠ€æœ¯æ ˆåŒ¹é…çš„æ–¹æ¡ˆ
ğŸ”¸ æˆæœ¬è€ƒè™‘ï¼šå¼€å‘æˆæœ¬ã€ç»´æŠ¤æˆæœ¬ã€æœåŠ¡è´¹ç”¨çš„ç»¼åˆè€ƒé‡
ğŸ”¸ å®‰å…¨ä¼˜å…ˆï¼šå®‰å…¨æ€§æ˜¯SSOæ–¹æ¡ˆçš„é¦–è¦è€ƒè™‘å› ç´ 
```

### 8.2 å„æ–¹æ¡ˆæ ¸å¿ƒä¼˜åŠ¿


**ğŸ›ï¸ CAS - ç®€å•å¯é **ï¼š
- âœ… **é€‚åˆåœºæ™¯**ï¼šä¼ ç»Ÿä¼ä¸šã€ç°æœ‰CASç¯å¢ƒã€è¿½æ±‚ç¨³å®š
- ğŸ’¡ **æ ¸å¿ƒä»·å€¼**ï¼šæˆç†Ÿç¨³å®šã€ç®€å•å¯é ã€å¹¿æ³›æ”¯æŒ

**ğŸ¦„ Keycloak - åŠŸèƒ½å…¨é¢**ï¼š
- âœ… **é€‚åˆåœºæ™¯**ï¼šç°ä»£åŒ–åº”ç”¨ã€åŠŸèƒ½è¦æ±‚é«˜ã€æˆæœ¬æ•æ„Ÿ
- ğŸ’¡ **æ ¸å¿ƒä»·å€¼**ï¼šå¼€æºå…è´¹ã€åŠŸèƒ½ä¸°å¯Œã€ä¼ä¸šçº§ç‰¹æ€§

**â˜ï¸ Auth0 - ä¸“ä¸šæ‰˜ç®¡**ï¼š
- âœ… **é€‚åˆåœºæ™¯**ï¼šå¿«é€Ÿä¸Šçº¿ã€å…¨çƒåŒ–åº”ç”¨ã€è¿½æ±‚ç¨³å®šæ€§
- ğŸ’¡ **æ ¸å¿ƒä»·å€¼**ï¼šé›¶ç»´æŠ¤ã€ä¸“ä¸šæœåŠ¡ã€å¿«é€Ÿé›†æˆ

**ğŸŒ± Spring Security - é«˜åº¦å®šåˆ¶**ï¼š
- âœ… **é€‚åˆåœºæ™¯**ï¼šæ·±åº¦å®šåˆ¶ã€SpringæŠ€æœ¯æ ˆã€å®Œå…¨å¯æ§
- ğŸ’¡ **æ ¸å¿ƒä»·å€¼**ï¼šå®Œå…¨è‡ªä¸»ã€æ·±åº¦é›†æˆã€æŠ€æœ¯æ ˆç»Ÿä¸€

### 8.3 é€‰å‹å†³ç­–è¦ç‚¹


**ğŸ¯ å…³é”®å†³ç­–å› ç´ **ï¼š
- **â° æ—¶é—´è¦æ±‚**ï¼šå¿«é€Ÿä¸Šçº¿é€‰Auth0ï¼Œæœ‰å……è¶³æ—¶é—´å¯é€‰å…¶ä»–
- **ğŸ’° é¢„ç®—è€ƒè™‘**ï¼šå……è¶³é¢„ç®—é€‰Auth0ï¼Œæœ‰é™é¢„ç®—é€‰Keycloak
- **ğŸ‘¨â€ğŸ’» å›¢é˜ŸæŠ€èƒ½**ï¼šJavaå›¢é˜Ÿé€‰Spring Securityï¼Œè¿ç»´å¼ºé€‰Keycloak
- **ğŸ¢ ä¼ä¸šç¯å¢ƒ**ï¼šä¼ ç»Ÿä¼ä¸šé€‰CASï¼Œç°ä»£åŒ–ä¼ä¸šé€‰Keycloak
- **ğŸ”§ å®šåˆ¶éœ€æ±‚**ï¼šé«˜åº¦å®šåˆ¶é€‰Spring Securityï¼Œæ ‡å‡†éœ€æ±‚é€‰å…¶ä»–

**âš ï¸ å¸¸è§è¯¯åŒº**ï¼š
- âŒ **åŠŸèƒ½è¶Šå¤šè¶Šå¥½**ï¼šåº”è¯¥æŒ‰éœ€é€‰æ‹©ï¼Œé¿å…è¿‡åº¦è®¾è®¡
- âŒ **åªçœ‹æŠ€æœ¯æŒ‡æ ‡**ï¼šè¦ç»¼åˆè€ƒè™‘å›¢é˜Ÿèƒ½åŠ›å’Œç»´æŠ¤æˆæœ¬
- âŒ **è¿½æ±‚æœ€æ–°æŠ€æœ¯**ï¼šç¨³å®šæ€§æ¯”æ–°é¢–æ€§æ›´é‡è¦
- âŒ **å¿½è§†è¿ç§»æˆæœ¬**ï¼šè¦è€ƒè™‘ä»ç°æœ‰ç³»ç»Ÿçš„è¿ç§»éš¾åº¦

### 8.4 å®æ–½æœ€ä½³å®è·µ


**ğŸ“‹ å®æ–½æ£€æŸ¥æ¸…å•**ï¼š
- âœ… **éœ€æ±‚åˆ†æ**ï¼šæ˜ç¡®ç”¨æˆ·æ•°é‡ã€åº”ç”¨æ•°é‡ã€å®‰å…¨è¦æ±‚
- âœ… **æŠ€æœ¯è°ƒç ”**ï¼šè¯„ä¼°å›¢é˜ŸæŠ€èƒ½ã€ç°æœ‰æŠ€æœ¯æ ˆã€ç»´æŠ¤èƒ½åŠ›
- âœ… **åŸå‹éªŒè¯**ï¼šæ­å»ºæ¦‚å¿µéªŒè¯ç¯å¢ƒï¼Œæµ‹è¯•å…³é”®åŠŸèƒ½
- âœ… **å®‰å…¨è¯„ä¼°**ï¼šè¿›è¡Œå®‰å…¨æµ‹è¯•ï¼Œç¡®ä¿ç¬¦åˆå®‰å…¨è¦æ±‚
- âœ… **æ€§èƒ½æµ‹è¯•**ï¼šéªŒè¯åœ¨é¢„æœŸè´Ÿè½½ä¸‹çš„æ€§èƒ½è¡¨ç°
- âœ… **ç¾å¤‡è®¡åˆ’**ï¼šåˆ¶å®šå¤‡ä»½æ¢å¤å’Œæ•…éšœåº”æ€¥é¢„æ¡ˆ
- âœ… **åŸ¹è®­è®¡åˆ’**ï¼šä¸ºå›¢é˜Ÿæä¾›ç›¸å…³æŠ€æœ¯åŸ¹è®­
- âœ… **ç›‘æ§å‘Šè­¦**ï¼šå»ºç«‹å®Œå–„çš„ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶

**ğŸ”„ æŒç»­æ”¹è¿›**ï¼š
- ğŸ“Š **å®šæœŸè¯„ä¼°**ï¼šå®šæœŸè¯„ä¼°æ–¹æ¡ˆçš„é€‚ç”¨æ€§å’Œæ•ˆæœ
- ğŸ”„ **ç‰ˆæœ¬å‡çº§**ï¼šåŠæ—¶å‡çº§åˆ°æ–°ç‰ˆæœ¬ï¼Œè·å¾—å®‰å…¨å’ŒåŠŸèƒ½æ›´æ–°
- ğŸ“š **çŸ¥è¯†ç§¯ç´¯**ï¼šå»ºç«‹æŠ€æœ¯æ–‡æ¡£ï¼Œç§¯ç´¯è¿ç»´ç»éªŒ
- ğŸ” **å®‰å…¨å®¡è®¡**ï¼šå®šæœŸè¿›è¡Œå®‰å…¨å®¡è®¡å’Œæ¼æ´æ‰«æ

**æ ¸å¿ƒè®°å¿†**ï¼š
- SSOé€‰å‹æ— æ ‡å‡†ç­”æ¡ˆï¼Œåœºæ™¯åŒ¹é…æœ€é‡è¦
- å¿«é€Ÿä¸Šçº¿é€‰Auth0ï¼ŒåŠŸèƒ½å…¨é¢é€‰Keycloak
- æ·±åº¦å®šåˆ¶é€‰Spring Securityï¼Œç®€å•ç¨³å®šé€‰CAS
- ç»¼åˆè€ƒè™‘å¼€å‘ã€ç»´æŠ¤ã€æœåŠ¡å„é¡¹æˆæœ¬
- å®‰å…¨æ€§å’Œç¨³å®šæ€§æ°¸è¿œæ˜¯ç¬¬ä¸€ä¼˜å…ˆçº§