---
title: 12ã€SSOéƒ¨ç½²ä¸è¿ç»´æ³¨æ„äº‹é¡¹
---
## ğŸ“š ç›®å½•

1. [éƒ¨ç½²æ¶æ„è®¾è®¡](#1-éƒ¨ç½²æ¶æ„è®¾è®¡)
2. [æ•°æ®ä¸€è‡´æ€§ä¸ç¼“å­˜åŒæ­¥](#2-æ•°æ®ä¸€è‡´æ€§ä¸ç¼“å­˜åŒæ­¥)
3. [ç›‘æ§ä¸æ—¥å¿—è¿½è¸ª](#3-ç›‘æ§ä¸æ—¥å¿—è¿½è¸ª)
4. [å‡çº§ä¸åè®®å˜æ›´ç®¡ç†](#4-å‡çº§ä¸åè®®å˜æ›´ç®¡ç†)
5. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#5-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ—ï¸ éƒ¨ç½²æ¶æ„è®¾è®¡


### 1.1 ä»€ä¹ˆæ˜¯SSOéƒ¨ç½²æ¶æ„


**ç®€å•ç†è§£**ï¼šå°±åƒæ­å»ºä¸€ä¸ª"èº«ä»½éªŒè¯ä¸­å¿ƒ"ï¼Œéœ€è¦è€ƒè™‘æ€ä¹ˆæ‘†æ”¾æœåŠ¡å™¨ï¼Œä¿è¯æ—¢ç¨³å®šåˆé«˜æ•ˆã€‚

```
æƒ³è±¡ä¸€ä¸‹é“¶è¡Œçš„ä¸šåŠ¡ï¼š
å•ä¸ªç½‘ç‚¹ â†’ å•èŠ‚ç‚¹éƒ¨ç½²ï¼ˆç®€å•ä½†æœ‰é£é™©ï¼‰
å¤šä¸ªç½‘ç‚¹ â†’ é›†ç¾¤éƒ¨ç½²ï¼ˆåˆ†æ‹…å‹åŠ›ï¼‰
æ€»è¡Œ+åˆ†è¡Œ â†’ é«˜å¯ç”¨éƒ¨ç½²ï¼ˆæ°¸ä¸åœæœºï¼‰
```

### 1.2 å•èŠ‚ç‚¹éƒ¨ç½²ï¼ˆé€‚åˆå°å…¬å¸ï¼‰


**ğŸ”¸ ä»€ä¹ˆæ˜¯å•èŠ‚ç‚¹**ï¼šåªç”¨ä¸€å°æœåŠ¡å™¨è·‘SSOç³»ç»Ÿ

**åŸºæœ¬æ¶æ„å›¾**ï¼š
```
ç”¨æˆ·æµè§ˆå™¨
    |
    â–¼
è´Ÿè½½å‡è¡¡å™¨
    |
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SSOæœåŠ¡å™¨   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚è®¤è¯æ¨¡å— â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ä¼šè¯ç®¡ç† â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ç”¨æˆ·å­˜å‚¨ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    |
    â–¼
æ•°æ®åº“æœåŠ¡å™¨
```

**ğŸ’¡ é…ç½®è¦ç‚¹**ï¼š
```bash
# å…¸å‹å•èŠ‚ç‚¹é…ç½®
æœåŠ¡å™¨é…ç½®ï¼š
- CPU: 4æ ¸å¿ƒ
- å†…å­˜: 8GB
- ç¡¬ç›˜: SSD 100GB
- ç½‘ç»œ: åƒå…†ç½‘å¡

è½¯ä»¶æ ˆï¼š
- æ“ä½œç³»ç»Ÿ: Linux (CentOS/Ubuntu)
- WebæœåŠ¡å™¨: Nginx
- åº”ç”¨æœåŠ¡å™¨: Tomcat/Spring Boot
- æ•°æ®åº“: MySQL/PostgreSQL
```

**âœ… ä¼˜åŠ¿**ï¼š
- éƒ¨ç½²ç®€å•ï¼Œæˆæœ¬ä½
- ç»´æŠ¤æ–¹ä¾¿ï¼Œé—®é¢˜å¥½æ’æŸ¥
- é€‚åˆç”¨æˆ·é‡å°‘çš„åœºæ™¯ï¼ˆ<1000äººï¼‰

**âŒ åŠ£åŠ¿**ï¼š
- å•ç‚¹æ•…éšœé£é™©
- æ€§èƒ½ç“¶é¢ˆæ˜æ˜¾
- æ— æ³•æ°´å¹³æ‰©å±•

### 1.3 é›†ç¾¤éƒ¨ç½²ï¼ˆä¸­ç­‰è§„æ¨¡å…¬å¸ï¼‰


**ğŸ”¸ ä»€ä¹ˆæ˜¯é›†ç¾¤**ï¼šå¤šå°æœåŠ¡å™¨ä¸€èµ·å·¥ä½œï¼Œåˆ†æ‹…è®¤è¯å‹åŠ›

**é›†ç¾¤æ¶æ„å›¾**ï¼š
```
                ç”¨æˆ·è¯·æ±‚
                    |
                    â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  è´Ÿè½½å‡è¡¡å™¨   â”‚
            â”‚   (Nginx)   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    |
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼           â–¼           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SSOèŠ‚ç‚¹1     â”‚ â”‚ SSOèŠ‚ç‚¹2     â”‚ â”‚ SSOèŠ‚ç‚¹3     â”‚
â”‚ 192.168.1.10â”‚ â”‚ 192.168.1.11â”‚ â”‚ 192.168.1.12â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        |           |           |
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   å…±äº«å­˜å‚¨   â”‚
            â”‚   (Redis)   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    |
                    â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  æ•°æ®åº“é›†ç¾¤  â”‚
            â”‚ (MySQL HA)  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”§ è´Ÿè½½å‡è¡¡é…ç½®ç¤ºä¾‹**ï¼š
```nginx
# Nginxè´Ÿè½½å‡è¡¡é…ç½®
upstream sso_backend {
    # IP Hashç¡®ä¿åŒä¸€ç”¨æˆ·è®¿é—®åŒä¸€æœåŠ¡å™¨
    ip_hash;
    
    server 192.168.1.10:8080 weight=3 max_fails=2;
    server 192.168.1.11:8080 weight=3 max_fails=2;
    server 192.168.1.12:8080 weight=2 backup;
}

server {
    listen 443 ssl;
    server_name sso.company.com;
    
    location / {
        proxy_pass http://sso_backend;
        # ä¿æŒä¼šè¯ç²˜æ€§
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

**ğŸ’¡ å…³é”®é…ç½®è¦ç‚¹**ï¼š
- **ä¼šè¯å…±äº«**ï¼šä½¿ç”¨Rediså­˜å‚¨ä¼šè¯ä¿¡æ¯
- **è´Ÿè½½ç­–ç•¥**ï¼šå»ºè®®ä½¿ç”¨ip_hashä¿è¯ä¼šè¯ç²˜æ€§
- **å¥åº·æ£€æŸ¥**ï¼šå®šæœŸæ£€æµ‹èŠ‚ç‚¹çŠ¶æ€
- **æ•…éšœè½¬ç§»**ï¼šè‡ªåŠ¨å‰”é™¤æ•…éšœèŠ‚ç‚¹

### 1.4 é«˜å¯ç”¨éƒ¨ç½²ï¼ˆå¤§å‹ä¼ä¸šï¼‰


**ğŸ”¸ ä»€ä¹ˆæ˜¯é«˜å¯ç”¨**ï¼šç³»ç»Ÿ24å°æ—¶ä¸åœæœºï¼Œä»»ä½•å•ç‚¹æ•…éšœéƒ½ä¸å½±å“ç”¨æˆ·ç™»å½•

**é«˜å¯ç”¨æ¶æ„å›¾**ï¼š
```
         ç”¨æˆ·è¯·æ±‚ (HTTPS)
              |
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Nginx1  â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Nginx2  â”‚ (Keepalived)
â”‚ ä¸»èŠ‚ç‚¹   â”‚  VIP     â”‚ å¤‡èŠ‚ç‚¹   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    |
    â–¼ (è´Ÿè½½å‡è¡¡)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          SSOåº”ç”¨é›†ç¾¤              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Node1   â”‚ Node2   â”‚ Node3       â”‚
â”‚ æœºæˆ¿A    â”‚ æœºæˆ¿A    â”‚ æœºæˆ¿B       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    |           |         |
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     Redisé›†ç¾¤        â”‚
    â”‚  Master + Slave     â”‚
    â”‚   + Sentinel        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                |
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    æ•°æ®åº“é›†ç¾¤        â”‚
    â”‚ Master-Slave + MHA  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ¢ è·¨æœºæˆ¿éƒ¨ç½²ç­–ç•¥**ï¼š

| ç»„ä»¶ | æœºæˆ¿A | æœºæˆ¿B | è¯´æ˜ |
|------|-------|-------|------|
| **è´Ÿè½½å‡è¡¡** | `ä¸»èŠ‚ç‚¹` | `å¤‡èŠ‚ç‚¹` | `Keepalivedå®ç°æ•…éšœåˆ‡æ¢` |
| **SSOåº”ç”¨** | `2ä¸ªèŠ‚ç‚¹` | `1ä¸ªèŠ‚ç‚¹` | `å°±è¿‘è®¿é—®ï¼Œå¼‚åœ°å®¹ç¾` |
| **Redis** | `ä¸»+ä»` | `ä»èŠ‚ç‚¹` | `ä¸»ä»å¤åˆ¶+å“¨å…µç›‘æ§` |
| **æ•°æ®åº“** | `ä¸»åº“` | `ä»åº“` | `ä¸»ä»åŒæ­¥+MHAåˆ‡æ¢` |

**âš¡ é«˜å¯ç”¨å…³é”®æŠ€æœ¯**ï¼š

```bash
# 1. è™šæ‹ŸIPåˆ‡æ¢ (Keepalived)
vrrp_instance VI_1 {
    state MASTER
    interface eth0
    virtual_router_id 51
    priority 150
    advert_int 1
    virtual_ipaddress {
        192.168.1.100  # VIPåœ°å€
    }
}

# 2. æ•°æ®åº“ä¸»ä»åˆ‡æ¢ (MHA)
[server1]
hostname=192.168.1.20
master_binlog_dir=/var/lib/mysql

[server2] 
hostname=192.168.1.21
candidate_master=1
```

---

## 2. ğŸ”„ æ•°æ®ä¸€è‡´æ€§ä¸ç¼“å­˜åŒæ­¥


### 2.1 ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®ä¸€è‡´æ€§


**ç”Ÿæ´»ä¾‹å­**ï¼šå°±åƒé“¶è¡Œçš„å¤šä¸ªç½‘ç‚¹ï¼Œä½ åœ¨Aç½‘ç‚¹å­˜é’±ï¼Œåœ¨Bç½‘ç‚¹åº”è¯¥èƒ½çœ‹åˆ°ä½™é¢æ›´æ–°ã€‚

**SSOåœºæ™¯çš„ä¸€è‡´æ€§é—®é¢˜**ï¼š
```
ç”¨æˆ·åœ¨èŠ‚ç‚¹1ç™»å½• â†’ ç”Ÿæˆä¼šè¯
ç”¨æˆ·è¯·æ±‚è¢«è½¬å‘åˆ°èŠ‚ç‚¹2 â†’ æ‰¾ä¸åˆ°ä¼šè¯ï¼Ÿ
ç»“æœï¼šç”¨æˆ·éœ€è¦é‡æ–°ç™»å½• âŒ
```

### 2.2 ä¼šè¯æ•°æ®åŒæ­¥ç­–ç•¥


**ğŸ”¸ ç­–ç•¥1ï¼šç²˜æ€§ä¼šè¯ (Session Sticky)**

```
åŸç†ï¼šåŒä¸€ç”¨æˆ·å§‹ç»ˆè®¿é—®åŒä¸€å°æœåŠ¡å™¨

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    ç”¨æˆ·Aè¯·æ±‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·A   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ èŠ‚ç‚¹1    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    ç”¨æˆ·Bè¯·æ±‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  
â”‚  ç”¨æˆ·B   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ èŠ‚ç‚¹2    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```nginx
# Nginxé…ç½®ç²˜æ€§ä¼šè¯
upstream backend {
    ip_hash;  # æ ¹æ®ç”¨æˆ·IPåˆ†å‘
    server node1:8080;
    server node2:8080;
}
```

**âœ… ä¼˜åŠ¿**ï¼šå®ç°ç®€å•ï¼Œæ— éœ€é¢å¤–å­˜å‚¨
**âŒ åŠ£åŠ¿**ï¼šèŠ‚ç‚¹æ•…éšœæ—¶ç”¨æˆ·ä¼šè¯ä¸¢å¤±

**ğŸ”¸ ç­–ç•¥2ï¼šå…±äº«å­˜å‚¨ (æ¨è)**

```
åŸç†ï¼šæ‰€æœ‰ä¼šè¯ä¿¡æ¯å­˜å‚¨åœ¨å…±äº«çš„Redisä¸­

èŠ‚ç‚¹1 â”€â”
       â”œâ”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â†â”€â”¬â”€ èŠ‚ç‚¹2
èŠ‚ç‚¹3 â”€â”˜   â”‚  Redis  â”‚   â””â”€ èŠ‚ç‚¹4
           â”‚ ä¼šè¯å­˜å‚¨ â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```java
// Spring Boot + Redisä¼šè¯å…±äº«é…ç½®
@Configuration
@EnableRedisHttpSession
public class SessionConfig {
    
    @Bean
    public RedisConnectionFactory connectionFactory() {
        LettuceConnectionFactory factory = new LettuceConnectionFactory();
        factory.setHostName("redis.company.com");
        factory.setPort(6379);
        return factory;
    }
}
```

**âœ… ä¼˜åŠ¿**ï¼šçœŸæ­£çš„ä¼šè¯å…±äº«ï¼Œä»»æ„èŠ‚ç‚¹æ•…éšœä¸å½±å“
**âŒ åŠ£åŠ¿**ï¼šå¢åŠ äº†Redisä¾èµ–

### 2.3 ç¼“å­˜åŒæ­¥æœºåˆ¶


**ğŸ”¸ ä»€ä¹ˆæ˜¯ç¼“å­˜åŒæ­¥**ï¼šå¤šä¸ªèŠ‚ç‚¹çš„ç¼“å­˜æ•°æ®ä¿æŒä¸€è‡´

**å¸¸è§ç¼“å­˜æ•°æ®**ï¼š
- ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ç¼“å­˜
- æƒé™ä¿¡æ¯ç¼“å­˜  
- åº”ç”¨é…ç½®ç¼“å­˜
- ä»¤ç‰Œé»‘åå•ç¼“å­˜

**åŒæ­¥ç­–ç•¥å¯¹æ¯”**ï¼š

| ç­–ç•¥ | å®ç°æ–¹å¼ | ä¸€è‡´æ€§ | æ€§èƒ½ | å¤æ‚åº¦ |
|------|---------|--------|------|--------|
| **ä¸»åŠ¨æ¨é€** | `æ¶ˆæ¯é˜Ÿåˆ—é€šçŸ¥` | `å¼ºä¸€è‡´` | `é«˜` | `ä¸­` |
| **å®šæ—¶åŒæ­¥** | `å®šæœŸæ‹‰å–æ›´æ–°` | `æœ€ç»ˆä¸€è‡´` | `ä¸­` | `ä½` |
| **äº‹ä»¶é©±åŠ¨** | `æ•°æ®å˜æ›´è§¦å‘` | `å¼ºä¸€è‡´` | `é«˜` | `é«˜` |

**ğŸ“¨ æ¶ˆæ¯é˜Ÿåˆ—åŒæ­¥ç¤ºä¾‹**ï¼š
```java
// ç”¨æˆ·ä¿¡æ¯æ›´æ–°æ—¶å‘é€åŒæ­¥æ¶ˆæ¯
@Service
public class UserService {
    
    @Autowired
    private RabbitTemplate rabbitTemplate;
    
    public void updateUser(User user) {
        // æ›´æ–°æ•°æ®åº“
        userRepository.save(user);
        
        // é€šçŸ¥å…¶ä»–èŠ‚ç‚¹æ¸…é™¤ç¼“å­˜
        CacheInvalidateMessage msg = new CacheInvalidateMessage();
        msg.setKey("user:" + user.getId());
        msg.setType("USER_UPDATE");
        
        rabbitTemplate.convertAndSend("cache.invalidate", msg);
    }
}

// æ¥æ”¶ç¼“å­˜å¤±æ•ˆæ¶ˆæ¯
@RabbitListener(queues = "cache.invalidate")
public void handleCacheInvalidate(CacheInvalidateMessage msg) {
    if ("USER_UPDATE".equals(msg.getType())) {
        cacheManager.evict("userCache", msg.getKey());
    }
}
```

### 2.4 æ•°æ®ä¸€è‡´æ€§æœ€ä½³å®è·µ


**ğŸ¯ åˆ†å±‚ç¼“å­˜ç­–ç•¥**ï¼š
```
åº”ç”¨å±‚ç¼“å­˜ (JVM)
    â†“ 5åˆ†é’Ÿè¿‡æœŸ
åˆ†å¸ƒå¼ç¼“å­˜ (Redis)  
    â†“ 30åˆ†é’Ÿè¿‡æœŸ
æ•°æ®åº“ (MySQL)
    â†“ æŒä¹…åŒ–å­˜å‚¨
```

**âš™ï¸ ç¼“å­˜æ›´æ–°ç­–ç•¥**ï¼š
1. **Cache Aside**ï¼šä¸šåŠ¡ä»£ç ä¸»åŠ¨ç»´æŠ¤ç¼“å­˜
2. **Write Through**ï¼šå†™æ•°æ®åº“åŒæ—¶å†™ç¼“å­˜
3. **Write Behind**ï¼šå¼‚æ­¥å†™å…¥æ•°æ®åº“

**ğŸ”¥ çƒ­ç‚¹æ•°æ®å¤„ç†**ï¼š
```java
// ä½¿ç”¨æœ¬åœ°ç¼“å­˜ + åˆ†å¸ƒå¼ç¼“å­˜
@Cacheable(value = "userInfo", key = "#userId")
public User getUserInfo(Long userId) {
    // å…ˆæŸ¥æœ¬åœ°ç¼“å­˜ï¼Œå†æŸ¥Redisï¼Œæœ€åæŸ¥æ•°æ®åº“
    return userRepository.findById(userId);
}
```

---

## 3. ğŸ“Š ç›‘æ§ä¸æ—¥å¿—è¿½è¸ª


### 3.1 ä¸ºä»€ä¹ˆéœ€è¦ç›‘æ§æ—¥å¿—


**å½¢è±¡æ¯”å–»**ï¼šç›‘æ§å°±åƒåŒ»é™¢çš„å¿ƒç”µå›¾ï¼Œæ—¥å¿—å°±åƒç—…å†è®°å½•ï¼Œå¸®åŠ©æˆ‘ä»¬ï¼š
- ğŸ“ˆ **å®æ—¶äº†è§£ç³»ç»Ÿå¥åº·çŠ¶å†µ**
- ğŸ” **å¿«é€Ÿå®šä½é—®é¢˜æ ¹å› **
- ğŸ“‹ **æ»¡è¶³å®‰å…¨å®¡è®¡è¦æ±‚**
- ğŸ“Š **åˆ†æç”¨æˆ·è¡Œä¸ºæ¨¡å¼**

### 3.2 ç›‘æ§æŒ‡æ ‡è®¾è®¡


**ğŸ”¸ ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡**ï¼š

| æŒ‡æ ‡ç±»å‹ | å…·ä½“æŒ‡æ ‡ | æ­£å¸¸èŒƒå›´ | å‘Šè­¦é˜ˆå€¼ |
|---------|---------|---------|---------|
| **å“åº”æ—¶é—´** | `ç™»å½•æ¥å£RT` | `< 200ms` | `> 500ms` |
| **ååé‡** | `æ¯ç§’ç™»å½•æ¬¡æ•°` | `100-500 TPS` | `< 50 TPS` |
| **æˆåŠŸç‡** | `è®¤è¯æˆåŠŸç‡` | `> 99%` | `< 95%` |
| **èµ„æºä½¿ç”¨** | `CPU/å†…å­˜/ç½‘ç»œ` | `< 70%` | `> 85%` |

**ğŸ“Š ä¸šåŠ¡ç›‘æ§æŒ‡æ ‡**ï¼š
```
è®¤è¯ç›¸å…³ï¼š
â”œâ”€â”€ ç™»å½•æˆåŠŸç‡ (æŒ‰å°æ—¶/å¤©ç»Ÿè®¡)
â”œâ”€â”€ ç™»å½•å¤±è´¥åˆ†å¸ƒ (å¯†ç é”™è¯¯/è´¦å·é”å®š/ç³»ç»Ÿå¼‚å¸¸)
â”œâ”€â”€ å¹³å‡ç™»å½•æ—¶é—´
â””â”€â”€ å¹¶å‘ç™»å½•ç”¨æˆ·æ•°

å®‰å…¨ç›¸å…³ï¼š
â”œâ”€â”€ å¼‚å¸¸ç™»å½•æ£€æµ‹ (IPå¼‚å¸¸/æ—¶é—´å¼‚å¸¸)
â”œâ”€â”€ æš´åŠ›ç ´è§£å°è¯•
â”œâ”€â”€ Tokenå¼‚å¸¸ä½¿ç”¨
â””â”€â”€ æƒé™è¶Šæƒå°è¯•
```

**âš¡ ç›‘æ§å®ç°ç¤ºä¾‹**ï¼š
```java
// ä½¿ç”¨Micrometerç›‘æ§æŒ‡æ ‡
@RestController
public class AuthController {
    
    private final MeterRegistry meterRegistry;
    private final Counter loginAttempts;
    private final Timer loginTimer;
    
    public AuthController(MeterRegistry meterRegistry) {
        this.meterRegistry = meterRegistry;
        this.loginAttempts = Counter.builder("sso.login.attempts")
            .tag("type", "total")
            .register(meterRegistry);
        this.loginTimer = Timer.builder("sso.login.duration")
            .register(meterRegistry);
    }
    
    @PostMapping("/login")
    public ResponseEntity<LoginResult> login(@RequestBody LoginRequest request) {
        return loginTimer.recordCallable(() -> {
            loginAttempts.increment();
            
            try {
                LoginResult result = authService.authenticate(request);
                
                // è®°å½•æˆåŠŸæŒ‡æ ‡
                Counter.builder("sso.login.success")
                    .tag("user_type", result.getUserType())
                    .register(meterRegistry)
                    .increment();
                
                return ResponseEntity.ok(result);
                
            } catch (AuthenticationException e) {
                // è®°å½•å¤±è´¥æŒ‡æ ‡
                Counter.builder("sso.login.failure")
                    .tag("reason", e.getReason())
                    .register(meterRegistry)
                    .increment();
                    
                throw e;
            }
        });
    }
}
```

### 3.3 å®¡è®¡è®¤è¯äº‹ä»¶


**ğŸ”¸ ä»€ä¹ˆæ˜¯å®¡è®¡æ—¥å¿—**ï¼šè®°å½•æ‰€æœ‰å®‰å…¨ç›¸å…³çš„æ“ä½œï¼Œç”¨äºäº‹åè¿½æŸ¥å’Œåˆè§„æ£€æŸ¥

**æ ¸å¿ƒå®¡è®¡äº‹ä»¶**ï¼š
```
ç”¨æˆ·è®¤è¯äº‹ä»¶ï¼š
â”œâ”€â”€ ç™»å½•æˆåŠŸ/å¤±è´¥
â”œâ”€â”€ ç™»å‡ºæ“ä½œ
â”œâ”€â”€ å¯†ç ä¿®æ”¹
â”œâ”€â”€ è´¦å·é”å®š/è§£é”
â””â”€â”€ å¤šå› ç´ è®¤è¯

æˆæƒç›¸å…³äº‹ä»¶ï¼š
â”œâ”€â”€ æƒé™åˆ†é…/å›æ”¶
â”œâ”€â”€ è§’è‰²å˜æ›´
â”œâ”€â”€ åº”ç”¨è®¿é—®æˆæƒ
â””â”€â”€ æ•æ„Ÿæ“ä½œå®¡æ‰¹

ç³»ç»Ÿç®¡ç†äº‹ä»¶ï¼š
â”œâ”€â”€ ç®¡ç†å‘˜ç™»å½•
â”œâ”€â”€ é…ç½®å˜æ›´
â”œâ”€â”€ ç³»ç»Ÿå‡çº§
â””â”€â”€ æ•°æ®å¯¼å…¥/å¯¼å‡º
```

**ğŸ“ å®¡è®¡æ—¥å¿—æ ¼å¼æ ‡å‡†**ï¼š
```json
{
  "timestamp": "2025-08-12T10:30:00.123Z",
  "event_id": "auth_login_success",
  "user_id": "user123",
  "username": "john.doe",
  "client_ip": "192.168.1.100",
  "user_agent": "Mozilla/5.0...",
  "session_id": "sess_abc123",
  "application": "oa_system",
  "result": "success",
  "details": {
    "login_method": "password",
    "mfa_used": true,
    "device_trusted": false
  },
  "risk_score": 2.5
}
```

**ğŸ” æ—¥å¿—æ”¶é›†æ¶æ„**ï¼š
```
SSOåº”ç”¨èŠ‚ç‚¹
    â”‚
    â–¼ (JSONæ ¼å¼æ—¥å¿—)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Filebeat   â”‚ â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ—¥å¿—é‡‡é›†    â”‚     â”‚ Elasticsearchâ”‚     â”‚   Kibana    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   æ—¥å¿—å­˜å‚¨   â”‚     â”‚  å¯è§†åŒ–ç•Œé¢  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   å‘Šè­¦ç³»ç»Ÿ   â”‚
                    â”‚ (AlertManager)â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 æ—¥å¿—åˆ†æä¸å‘Šè­¦


**ğŸš¨ å¼‚å¸¸æ£€æµ‹è§„åˆ™**ï¼š

```yaml
# æš´åŠ›ç ´è§£æ£€æµ‹
- name: "brute_force_attack"
  condition: "login_failure_count > 10 within 5 minutes from same IP"
  action: "block_ip_and_alert"
  
# å¼‚åœ°ç™»å½•æ£€æµ‹  
- name: "geo_anomaly"
  condition: "login from different country within 30 minutes"
  action: "require_additional_verification"

# æ‰¹é‡è´¦å·å°è¯•
- name: "account_enumeration"
  condition: "login attempts for > 20 different users from same IP"
  action: "alert_security_team"
```

**ğŸ“ˆ å¯è§†åŒ–ç›‘æ§é¢æ¿**ï¼š
```
å®æ—¶ç›‘æ§é¢æ¿åŒ…å«ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SSOç³»ç»Ÿç›‘æ§é¢æ¿                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ¯ æ ¸å¿ƒæŒ‡æ ‡                          â”‚
â”‚ â€¢ åœ¨çº¿ç”¨æˆ·æ•°: 1,234                  â”‚
â”‚ â€¢ ç™»å½•æˆåŠŸç‡: 99.2%                  â”‚
â”‚ â€¢ å¹³å‡å“åº”æ—¶é—´: 156ms                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“Š è¶‹åŠ¿å›¾è¡¨                          â”‚
â”‚ â€¢ ç™»å½•é‡è¶‹åŠ¿ (24å°æ—¶)                â”‚
â”‚ â€¢ å¤±è´¥ç‡åˆ†å¸ƒ (æŒ‰åŸå› )                â”‚
â”‚ â€¢ åº”ç”¨è®¿é—®TOP10                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš ï¸  å®æ—¶å‘Šè­¦                         â”‚
â”‚ â€¢ æ£€æµ‹åˆ°å¯ç–‘ç™»å½• (5åˆ†é’Ÿå‰)           â”‚
â”‚ â€¢ èŠ‚ç‚¹2å“åº”æ—¶é—´è¿‡é«˜ (åˆšåˆš)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. ğŸ”„ å‡çº§ä¸åè®®å˜æ›´ç®¡ç†


### 4.1 ä¸ºä»€ä¹ˆå‡çº§ç®¡ç†å¾ˆé‡è¦


**ç°å®ä¾‹å­**ï¼šå°±åƒæ‰‹æœºç³»ç»Ÿå‡çº§ï¼Œéœ€è¦ä¿è¯ï¼š
- ğŸ“± **å‡çº§è¿‡ç¨‹ä¸­ä¸èƒ½å½±å“æ­£åœ¨ä½¿ç”¨çš„ç”¨æˆ·**
- ğŸ”„ **æ–°è€ç‰ˆæœ¬èƒ½å¤Ÿå…¼å®¹**
- ğŸ“‹ **å‡ºé—®é¢˜æ—¶èƒ½å¿«é€Ÿå›æ»š**

**SSOç³»ç»Ÿå‡çº§çš„ç‰¹æ®Šæ€§**ï¼š
- ğŸŒ **å½±å“èŒƒå›´å¹¿**ï¼šæ‰€æœ‰ä¸šåŠ¡ç³»ç»Ÿéƒ½ä¾èµ–SSO
- â° **å¯ç”¨æ€§è¦æ±‚é«˜**ï¼š24å°æ—¶ä¸é—´æ–­æœåŠ¡
- ğŸ” **å®‰å…¨æ€§æ•æ„Ÿ**ï¼šè®¤è¯ç³»ç»Ÿä¸èƒ½å‡ºé”™

### 4.2 å‡çº§ç­–ç•¥ä¸æ–¹æ¡ˆ


**ğŸ”¸ ç°åº¦å‡çº§ç­–ç•¥ (æ¨è)**

```
å‡çº§æµç¨‹ï¼š
æ—§ç‰ˆæœ¬ (100%æµé‡)
    â†“
æ—§ç‰ˆæœ¬ (90%æµé‡) + æ–°ç‰ˆæœ¬ (10%æµé‡)
    â†“  
æ—§ç‰ˆæœ¬ (50%æµé‡) + æ–°ç‰ˆæœ¬ (50%æµé‡)
    â†“
æ–°ç‰ˆæœ¬ (100%æµé‡)
```

**ğŸ¯ ç°åº¦å®æ–½æ­¥éª¤**ï¼š

**Step â‘ ** éƒ¨ç½²å‡†å¤‡
```bash
# 1. å¤‡ä»½æ•°æ®åº“å’Œé…ç½®
mysqldump sso_db > backup_$(date +%Y%m%d).sql

# 2. å‡†å¤‡æ–°ç‰ˆæœ¬é•œåƒ
docker pull sso-server:v2.1.0

# 3. éªŒè¯æ–°ç‰ˆæœ¬åŠŸèƒ½
docker run --name sso-test sso-server:v2.1.0
```

**Step â‘¡** å°æµé‡éªŒè¯
```nginx
# Nginxé…ç½®ç°åº¦è§„åˆ™
upstream sso_v1 {
    server sso-v1-1:8080;
    server sso-v1-2:8080;
}

upstream sso_v2 {
    server sso-v2-1:8080;
}

server {
    location / {
        # 5%æµé‡åˆ°æ–°ç‰ˆæœ¬
        if ($request_id ~ "^[0-9a-f]{0,1}") {
            proxy_pass http://sso_v2;
        }
        proxy_pass http://sso_v1;
    }
}
```

**Step â‘¢** ç›‘æ§éªŒè¯æŒ‡æ ‡
```
å…³é”®æŒ‡æ ‡ç›‘æ§ï¼š
â”œâ”€â”€ é”™è¯¯ç‡å¯¹æ¯” (æ–°ç‰ˆæœ¬ vs æ—§ç‰ˆæœ¬)
â”œâ”€â”€ å“åº”æ—¶é—´å¯¹æ¯”
â”œâ”€â”€ ç”¨æˆ·æŠ•è¯‰æ•°é‡
â””â”€â”€ ä¸šåŠ¡ç³»ç»Ÿé›†æˆçŠ¶æ€
```

**ğŸ”¸ è“ç»¿éƒ¨ç½²ç­–ç•¥**

```
è“ç»¿éƒ¨ç½²æ¶æ„ï¼š
                è´Ÿè½½å‡è¡¡å™¨
                     â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”
            â–¼                 â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   è“ç¯å¢ƒ     â”‚   â”‚   ç»¿ç¯å¢ƒ     â”‚
    â”‚ (å½“å‰ç‰ˆæœ¬)   â”‚   â”‚ (æ–°ç‰ˆæœ¬)     â”‚
    â”‚ æœåŠ¡æµé‡     â”‚   â”‚ å‡†å¤‡å°±ç»ª     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                 â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
                 å…±äº«æ•°æ®åº“
```

### 4.3 åè®®å˜æ›´ç®¡ç†


**ğŸ”¸ ä»€ä¹ˆæ˜¯åè®®å˜æ›´**ï¼šSSOç³»ç»Ÿçš„æ¥å£ã€æ•°æ®æ ¼å¼ã€è®¤è¯æµç¨‹å‘ç”Ÿå˜åŒ–

**å¸¸è§åè®®å˜æ›´åœºæ™¯**ï¼š
- **Tokenæ ¼å¼å‡çº§**ï¼šJWTç»“æ„è°ƒæ•´
- **APIæ¥å£å˜æ›´**ï¼šæ–°å¢å­—æ®µæˆ–ä¿®æ”¹å“åº”æ ¼å¼
- **è®¤è¯æµç¨‹ä¼˜åŒ–**ï¼šå¢åŠ äºŒæ¬¡éªŒè¯æ­¥éª¤
- **å®‰å…¨ç­–ç•¥è°ƒæ•´**ï¼šå¯†ç å¤æ‚åº¦è¦æ±‚å˜æ›´

**ğŸ“‹ ç‰ˆæœ¬å…¼å®¹æ€§ç­–ç•¥**ï¼š

| å˜æ›´ç±»å‹ | å…¼å®¹æ€§è¦æ±‚ | å®æ–½ç­–ç•¥ |
|---------|-----------|---------|
| **å‘åå…¼å®¹** | `æ–°ç‰ˆæœ¬æ”¯æŒæ—§å®¢æˆ·ç«¯` | `ä¿ç•™æ—§æ¥å£ï¼Œé€æ­¥è¿ç§»` |
| **å‘å‰å…¼å®¹** | `æ—§ç‰ˆæœ¬æ”¯æŒæ–°å®¢æˆ·ç«¯` | `åŠŸèƒ½é™çº§ï¼Œä¼˜é›…å¤„ç†` |
| **ç ´åæ€§å˜æ›´** | `ä¸å…¼å®¹` | `åˆ†é˜¶æ®µå¼ºåˆ¶å‡çº§` |

**ğŸ”§ APIç‰ˆæœ¬ç®¡ç†ç¤ºä¾‹**ï¼š
```java
// æ”¯æŒå¤šç‰ˆæœ¬API
@RestController
@RequestMapping("/api")
public class AuthController {
    
    // ç‰ˆæœ¬1 - ä¿æŒå…¼å®¹
    @PostMapping(value = "/v1/login", produces = "application/json")
    public LoginResponseV1 loginV1(@RequestBody LoginRequest request) {
        AuthResult result = authService.authenticate(request);
        return convertToV1Response(result);
    }
    
    // ç‰ˆæœ¬2 - æ–°å¢åŠŸèƒ½
    @PostMapping(value = "/v2/login", produces = "application/json")  
    public LoginResponseV2 loginV2(@RequestBody LoginRequestV2 request) {
        AuthResult result = authService.authenticateWithMFA(request);
        return convertToV2Response(result);
    }
    
    // é»˜è®¤ç‰ˆæœ¬è·¯ç”±åˆ°æœ€æ–°
    @PostMapping("/login")
    public LoginResponseV2 login(@RequestBody LoginRequestV2 request) {
        return loginV2(request);
    }
}
```

**ğŸ”„ æ•°æ®åº“å˜æ›´ç®¡ç†**ï¼š
```sql
-- ä½¿ç”¨Flywayç®¡ç†æ•°æ®åº“ç‰ˆæœ¬
-- V2.1.0__add_mfa_columns.sql
ALTER TABLE users 
ADD COLUMN mfa_enabled BOOLEAN DEFAULT FALSE,
ADD COLUMN mfa_secret VARCHAR(32) NULL;

-- ä¿æŒå‘åå…¼å®¹
UPDATE users SET mfa_enabled = FALSE WHERE mfa_enabled IS NULL;
```

### 4.4 å›æ»šç­–ç•¥ä¸åº”æ€¥é¢„æ¡ˆ


**ğŸš¨ ä»€ä¹ˆæ—¶å€™éœ€è¦å›æ»š**ï¼š
- ğŸ”´ **ç™»å½•æˆåŠŸç‡ä¸‹é™è¶…è¿‡5%**
- ğŸ”´ **å“åº”æ—¶é—´å¢åŠ è¶…è¿‡50%**
- ğŸ”´ **å‡ºç°ä¸¥é‡å®‰å…¨æ¼æ´**
- ğŸ”´ **ä¸šåŠ¡ç³»ç»Ÿå¤§é‡æŠ¥é”™**

**âš¡ å¿«é€Ÿå›æ»šæ–¹æ¡ˆ**ï¼š

**æ–¹æ¡ˆ1ï¼šé…ç½®åˆ‡æ¢å›æ»š**
```bash
# 1åˆ†é’Ÿå†…å®Œæˆå›æ»š
kubectl patch service sso-service -p '{"spec":{"selector":{"version":"v1.9.0"}}}'

# éªŒè¯å›æ»šç»“æœ
kubectl get pods -l app=sso,version=v1.9.0
```

**æ–¹æ¡ˆ2ï¼šæ•°æ®åº“å›æ»š**
```bash
# æ•°æ®åº“ç»“æ„å›æ»š (è°¨æ…æ“ä½œ)
mysql sso_db < backup_20250812.sql

# ä»…å›æ»šé…ç½®æ•°æ®
UPDATE system_config SET config_value = 'v1.9.0' WHERE config_key = 'version';
```

**ğŸ“‹ åº”æ€¥é¢„æ¡ˆæ£€æŸ¥æ¸…å•**ï¼š

```
å‡çº§å‰å‡†å¤‡ï¼š
â˜ å®Œæ•´æ•°æ®å¤‡ä»½å·²å®Œæˆ
â˜ å›æ»šè„šæœ¬å·²æµ‹è¯•é€šè¿‡  
â˜ ç›‘æ§å‘Šè­¦å·²é…ç½®
â˜ åº”æ€¥è”ç³»äººå·²é€šçŸ¥

å‡çº§è¿‡ç¨‹ä¸­ï¼š
â˜ å®æ—¶ç›‘æ§å…³é”®æŒ‡æ ‡
â˜ ä¿æŒæ²Ÿé€šæ¸ é“ç•…é€š
â˜ è®°å½•æ‰€æœ‰æ“ä½œæ­¥éª¤
â˜ å‡†å¤‡éšæ—¶æ‰§è¡Œå›æ»š

å‡çº§åéªŒè¯ï¼š
â˜ åŠŸèƒ½å›å½’æµ‹è¯•é€šè¿‡
â˜ æ€§èƒ½æŒ‡æ ‡æ­£å¸¸
â˜ ä¸šåŠ¡ç³»ç»Ÿé›†æˆæ­£å¸¸
â˜ ç”¨æˆ·åé¦ˆæ— å¼‚å¸¸
```

---

## 5. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 5.1 å¿…é¡»æŒæ¡çš„å…³é”®æ¦‚å¿µ


```
ğŸ”¸ éƒ¨ç½²æ¶æ„ï¼šå•èŠ‚ç‚¹â†’é›†ç¾¤â†’é«˜å¯ç”¨ï¼Œæ ¹æ®è§„æ¨¡é€‰æ‹©åˆé€‚æ–¹æ¡ˆ
ğŸ”¸ æ•°æ®ä¸€è‡´æ€§ï¼šä¼šè¯å…±äº«æ˜¯é›†ç¾¤éƒ¨ç½²çš„æ ¸å¿ƒï¼Œæ¨èRedisæ–¹æ¡ˆ
ğŸ”¸ ç›‘æ§æ—¥å¿—ï¼šæ€§èƒ½ç›‘æ§+å®‰å…¨å®¡è®¡ï¼Œé¢„é˜²é—®é¢˜+äº‹åè¿½æŸ¥
ğŸ”¸ å‡çº§ç®¡ç†ï¼šç°åº¦å‘å¸ƒ+ç‰ˆæœ¬å…¼å®¹+å¿«é€Ÿå›æ»šï¼Œä¿è¯ç¨³å®šæ€§
```

### 5.2 éƒ¨ç½²è¿ç»´æœ€ä½³å®è·µ


**ğŸ¯ æ¶æ„è®¾è®¡åŸåˆ™**ï¼š
```
é«˜å¯ç”¨æ€§ï¼š
â€¢ æ¶ˆé™¤å•ç‚¹æ•…éšœ
â€¢ å¤šæœºæˆ¿å®¹ç¾å¤‡ä»½
â€¢ è‡ªåŠ¨æ•…éšœåˆ‡æ¢

å¯æ‰©å±•æ€§ï¼š
â€¢ æ°´å¹³æ‰©å±•èƒ½åŠ›
â€¢ å¾®æœåŠ¡åŒ–æ‹†åˆ†
â€¢ å¼¹æ€§ä¼¸ç¼©æ”¯æŒ

å®‰å…¨æ€§ï¼š
â€¢ ç½‘ç»œéš”ç¦»é˜²æŠ¤
â€¢ æ•°æ®åŠ å¯†ä¼ è¾“
â€¢ è®¿é—®æƒé™æ§åˆ¶
```

**âš¡ æ€§èƒ½ä¼˜åŒ–è¦ç‚¹**ï¼š
```
ç¼“å­˜ç­–ç•¥ï¼š
â€¢ å¤šå±‚ç¼“å­˜è®¾è®¡
â€¢ çƒ­ç‚¹æ•°æ®é¢„åŠ è½½
â€¢ ç¼“å­˜å¤±æ•ˆç­–ç•¥

æ•°æ®åº“ä¼˜åŒ–ï¼š
â€¢ è¯»å†™åˆ†ç¦»
â€¢ è¿æ¥æ± é…ç½®
â€¢ ç´¢å¼•è®¾è®¡ä¼˜åŒ–
```

**ğŸ” ç›‘æ§è¿ç»´é‡ç‚¹**ï¼š
```
å®æ—¶ç›‘æ§ï¼š
â€¢ å…³é”®ä¸šåŠ¡æŒ‡æ ‡
â€¢ ç³»ç»Ÿèµ„æºä½¿ç”¨
â€¢ å®‰å…¨å¨èƒæ£€æµ‹

æ—¥å¿—ç®¡ç†ï¼š
â€¢ ç»“æ„åŒ–æ—¥å¿—æ ¼å¼
â€¢ é›†ä¸­æ”¶é›†å­˜å‚¨
â€¢ æ™ºèƒ½åˆ†æå‘Šè­¦
```

### 5.3 å®é™…åº”ç”¨ä»·å€¼


**ä¼ä¸šåœºæ™¯åº”ç”¨**ï¼š
- ğŸ¢ **ä¸­å°ä¼ä¸š**ï¼šå•èŠ‚ç‚¹éƒ¨ç½²ï¼Œé‡ç‚¹å…³æ³¨å¤‡ä»½å’Œç›‘æ§
- ğŸ­ **å¤§å‹ä¼ä¸š**ï¼šé«˜å¯ç”¨é›†ç¾¤ï¼Œå®Œå–„çš„ç›‘æ§å®¡è®¡ä½“ç³»
- ğŸŒ **äº’è”ç½‘å…¬å¸**ï¼šå¾®æœåŠ¡æ¶æ„ï¼Œè‡ªåŠ¨åŒ–è¿ç»´å¹³å°

**è¿ç»´æˆç†Ÿåº¦æ¼”è¿›**ï¼š
```
Level 1: åŸºç¡€éƒ¨ç½² â†’ èƒ½è·‘èµ·æ¥
Level 2: ç›‘æ§å‘Šè­¦ â†’ çŸ¥é“æœ‰é—®é¢˜  
Level 3: è‡ªåŠ¨åŒ–è¿ç»´ â†’ è‡ªåŠ¨å¤„ç†é—®é¢˜
Level 4: æ™ºèƒ½è¿ç»´ â†’ é¢„æµ‹å’Œé¢„é˜²é—®é¢˜
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- éƒ¨ç½²æ¶æ„è¦åŒ¹é…ä¸šåŠ¡è§„æ¨¡ï¼Œä»ç®€åˆ°ç¹é€æ­¥æ¼”è¿›
- æ•°æ®ä¸€è‡´æ€§æ˜¯åˆ†å¸ƒå¼éƒ¨ç½²çš„æ ¸å¿ƒæŒ‘æˆ˜ï¼Œå¿…é¡»é‡ç‚¹è§£å†³
- ç›‘æ§æ—¥å¿—æ˜¯è¿ç»´çš„çœ¼ç›ï¼Œç¼ºå¤±ç›‘æ§ç­‰äºç›²äººå¼€è½¦
- å‡çº§å˜æ›´æ˜¯é«˜é£é™©æ“ä½œï¼Œå¿…é¡»æœ‰å®Œå–„çš„é¢„æ¡ˆå’Œå›æ»šæœºåˆ¶