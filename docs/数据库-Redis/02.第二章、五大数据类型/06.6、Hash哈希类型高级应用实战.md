---
title: 6ã€Hashå“ˆå¸Œç±»å‹é«˜çº§åº”ç”¨å®æˆ˜
---
## ğŸ“š ç›®å½•

1. [Hashç±»å‹æ ¸å¿ƒæ¦‚å¿µå›é¡¾](#1-Hashç±»å‹æ ¸å¿ƒæ¦‚å¿µå›é¡¾)
2. [å¤æ‚å¯¹è±¡å­˜å‚¨å®æˆ˜](#2-å¤æ‚å¯¹è±¡å­˜å‚¨å®æˆ˜)
3. [è´­ç‰©è½¦ç³»ç»Ÿå®Œæ•´å®ç°](#3-è´­ç‰©è½¦ç³»ç»Ÿå®Œæ•´å®ç°)
4. [å®æ—¶ç»Ÿè®¡åº”ç”¨è¯¦è§£](#4-å®æ—¶ç»Ÿè®¡åº”ç”¨è¯¦è§£)
5. [ç»¼åˆå®æˆ˜æ¡ˆä¾‹](#5-ç»¼åˆå®æˆ˜æ¡ˆä¾‹)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ Hashç±»å‹æ ¸å¿ƒæ¦‚å¿µå›é¡¾


### 1.1 Hashæ˜¯ä»€ä¹ˆ


**ç®€å•ç†è§£**ï¼šHashå°±åƒä¸€ä¸ª**æ•°æ®å­˜å‚¨ç›’å­**ï¼Œè¿™ä¸ªç›’å­é‡Œé¢æœ‰å¾ˆå¤š**å°æ ¼å­**ï¼Œæ¯ä¸ªå°æ ¼å­éƒ½æœ‰ä¸€ä¸ª**æ ‡ç­¾**ï¼ˆå­—æ®µåï¼‰å’Œ**å†…å®¹**ï¼ˆå­—æ®µå€¼ï¼‰ã€‚

```
æƒ³è±¡ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼š
ç”¨æˆ·ä¿¡æ¯æ–‡ä»¶å¤¹
â”œâ”€â”€ å§“å: å¼ ä¸‰
â”œâ”€â”€ å¹´é¾„: 25  
â”œâ”€â”€ é‚®ç®±: zhang@example.com
â”œâ”€â”€ ç”µè¯: 13812345678
â””â”€â”€ åŸå¸‚: åŒ—äº¬

Redis Hashå°±æ˜¯è¿™æ ·å­˜å‚¨æ•°æ®çš„ï¼
```

### 1.2 ä¸ºä»€ä¹ˆè¦ç”¨Hash


**å¯¹æ¯”å…¶ä»–å­˜å‚¨æ–¹å¼**ï¼š
```
âŒ ç”¨Stringå­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼š
user:1001 -> "å¼ ä¸‰,25,zhang@example.com,13812345678,åŒ—äº¬"
é—®é¢˜ï¼šè¦ä¿®æ”¹å¹´é¾„ï¼Œéœ€è¦æŠŠæ•´ä¸ªå­—ç¬¦ä¸²å–å‡ºæ¥ï¼Œæ‹†åˆ†ï¼Œä¿®æ”¹ï¼Œå†å­˜å›å»

âœ… ç”¨Hashå­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼š
user:1001 -> {
  name: "å¼ ä¸‰",
  age: "25", 
  email: "zhang@example.com",
  phone: "13812345678",
  city: "åŒ—äº¬"
}
ä¼˜åŠ¿ï¼šåªæƒ³ä¿®æ”¹å¹´é¾„ï¼Ÿç›´æ¥æ”¹ageå­—æ®µå°±è¡Œï¼
```

### 1.3 Hashçš„åŸºæœ¬æ“ä½œ


**æ ¸å¿ƒå‘½ä»¤**ï¼š
```bash
# è®¾ç½®å•ä¸ªå­—æ®µ
HSET user:1001 name "å¼ ä¸‰"

# è®¾ç½®å¤šä¸ªå­—æ®µ
HMSET user:1001 name "å¼ ä¸‰" age 25 city "åŒ—äº¬"

# è·å–å•ä¸ªå­—æ®µ
HGET user:1001 name

# è·å–å¤šä¸ªå­—æ®µ
HMGET user:1001 name age city

# è·å–æ‰€æœ‰å­—æ®µå’Œå€¼
HGETALL user:1001
```

---

## 2. ğŸ’¾ å¤æ‚å¯¹è±¡å­˜å‚¨å®æˆ˜


### 2.1 ç”¨æˆ·å®Œæ•´ä¿¡æ¯å­˜å‚¨


**ä¸šåŠ¡åœºæ™¯**ï¼šä¸€ä¸ªç”¨æˆ·æœ‰åŸºæœ¬ä¿¡æ¯ã€åå¥½è®¾ç½®ã€çŠ¶æ€ä¿¡æ¯ç­‰å¤šä¸ªç»´åº¦çš„æ•°æ®ã€‚

**æ•°æ®ç»“æ„è®¾è®¡**ï¼š
```
ç”¨æˆ·ä¿¡æ¯å­˜å‚¨æ–¹æ¡ˆï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Key: user:profile:1001              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åŸºæœ¬ä¿¡æ¯                             â”‚
â”‚ â”œâ”€â”€ name: "å¼ ä¸‰"                     â”‚
â”‚ â”œâ”€â”€ age: "25"                       â”‚
â”‚ â”œâ”€â”€ gender: "male"                  â”‚
â”‚ â”œâ”€â”€ email: "zhang@example.com"      â”‚
â”‚ â””â”€â”€ phone: "13812345678"            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åå¥½è®¾ç½®                             â”‚
â”‚ â”œâ”€â”€ theme: "dark"                   â”‚
â”‚ â”œâ”€â”€ language: "zh-CN"               â”‚
â”‚ â””â”€â”€ timezone: "Asia/Shanghai"       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ çŠ¶æ€ä¿¡æ¯                             â”‚
â”‚ â”œâ”€â”€ status: "active"                â”‚
â”‚ â”œâ”€â”€ last_login: "2025-08-28"        â”‚
â”‚ â””â”€â”€ login_count: "156"              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®ç°ä»£ç **ï¼š
```java
// ç”¨æˆ·ä¿¡æ¯ç®¡ç†ç±»
public class UserProfileManager {
    private RedisTemplate<String, Object> redisTemplate;
    
    // ä¿å­˜ç”¨æˆ·å®Œæ•´ä¿¡æ¯
    public void saveUserProfile(Long userId, UserProfile profile) {
        String key = "user:profile:" + userId;
        
        // ä¸€æ¬¡æ€§ä¿å­˜æ‰€æœ‰å­—æ®µ
        Map<String, Object> userMap = new HashMap<>();
        userMap.put("name", profile.getName());
        userMap.put("age", profile.getAge());
        userMap.put("email", profile.getEmail());
        userMap.put("phone", profile.getPhone());
        userMap.put("theme", profile.getTheme());
        userMap.put("language", profile.getLanguage());
        userMap.put("status", profile.getStatus());
        userMap.put("last_login", System.currentTimeMillis());
        
        redisTemplate.opsForHash().putAll(key, userMap);
    }
    
    // åªæ›´æ–°ç”¨æˆ·æŸä¸ªå­—æ®µ
    public void updateUserField(Long userId, String field, Object value) {
        String key = "user:profile:" + userId;
        redisTemplate.opsForHash().put(key, field, value);
    }
    
    // è·å–ç”¨æˆ·å®Œæ•´ä¿¡æ¯
    public UserProfile getUserProfile(Long userId) {
        String key = "user:profile:" + userId;
        Map<Object, Object> userMap = redisTemplate.opsForHash().entries(key);
        
        // è½¬æ¢ä¸ºç”¨æˆ·å¯¹è±¡
        return mapToUserProfile(userMap);
    }
}
```

### 2.2 å•†å“è¯¦æƒ…ä¿¡æ¯ç®¡ç†


**ä¸šåŠ¡åœºæ™¯**ï¼šç”µå•†ç³»ç»Ÿä¸­ï¼Œå•†å“æœ‰åŸºæœ¬ä¿¡æ¯ã€ä»·æ ¼ä¿¡æ¯ã€åº“å­˜ä¿¡æ¯ã€é”€å”®ç»Ÿè®¡ç­‰ã€‚

**å­˜å‚¨ç­–ç•¥**ï¼š
```
å•†å“ä¿¡æ¯åˆ†å±‚å­˜å‚¨ï¼š

å•†å“åŸºç¡€ä¿¡æ¯ï¼šproduct:info:10001
â”œâ”€â”€ title: "iPhone 15 Pro"
â”œâ”€â”€ brand: "Apple" 
â”œâ”€â”€ category: "æ‰‹æœº"
â”œâ”€â”€ description: "æœ€æ–°æ¬¾iPhone..."
â””â”€â”€ images: "img1.jpg,img2.jpg"

å•†å“ä»·æ ¼ä¿¡æ¯ï¼šproduct:price:10001  
â”œâ”€â”€ original_price: "7999.00"
â”œâ”€â”€ current_price: "7599.00"
â”œâ”€â”€ discount_rate: "0.05"
â””â”€â”€ price_update_time: "2025-08-28"

å•†å“åº“å­˜ä¿¡æ¯ï¼šproduct:stock:10001
â”œâ”€â”€ total_stock: "100"
â”œâ”€â”€ available_stock: "87" 
â”œâ”€â”€ reserved_stock: "13"
â””â”€â”€ stock_update_time: "2025-08-28"
```

**å®ç°ç¤ºä¾‹**ï¼š
```java
// å•†å“ç®¡ç†
public void updateProductPrice(Long productId, BigDecimal newPrice) {
    String key = "product:price:" + productId;
    
    // åªæ›´æ–°ä»·æ ¼ç›¸å…³å­—æ®µï¼Œä¸å½±å“å…¶ä»–ä¿¡æ¯
    redisTemplate.opsForHash().put(key, "current_price", newPrice.toString());
    redisTemplate.opsForHash().put(key, "price_update_time", 
        LocalDateTime.now().format(DateTimeFormatter.ISO_LOCAL_DATE_TIME));
}

// è·å–å•†å“å®Œæ•´ä¿¡æ¯
public ProductDetail getProductDetail(Long productId) {
    // å¹¶è¡Œè·å–å¤šä¸ªç»´åº¦çš„ä¿¡æ¯
    Map<Object, Object> basicInfo = redisTemplate.opsForHash()
        .entries("product:info:" + productId);
    Map<Object, Object> priceInfo = redisTemplate.opsForHash()
        .entries("product:price:" + productId);
    Map<Object, Object> stockInfo = redisTemplate.opsForHash()
        .entries("product:stock:" + productId);
        
    return buildProductDetail(basicInfo, priceInfo, stockInfo);
}
```

### 2.3 è®¢å•çŠ¶æ€è·Ÿè¸ª


**ä¸šåŠ¡åœºæ™¯**ï¼šè®¢å•ä»åˆ›å»ºåˆ°å®Œæˆï¼Œéœ€è¦è®°å½•å„ä¸ªç¯èŠ‚çš„çŠ¶æ€å’Œæ—¶é—´ã€‚

**è®¢å•çŠ¶æ€è®¾è®¡**ï¼š
```
è®¢å•è·Ÿè¸ªä¿¡æ¯ï¼šorder:track:20250828001
â”œâ”€â”€ order_status: "shipped"        â† å½“å‰çŠ¶æ€
â”œâ”€â”€ create_time: "2025-08-26"      â† åˆ›å»ºæ—¶é—´
â”œâ”€â”€ pay_time: "2025-08-26"         â† æ”¯ä»˜æ—¶é—´  
â”œâ”€â”€ ship_time: "2025-08-27"        â† å‘è´§æ—¶é—´
â”œâ”€â”€ delivery_time: ""              â† é…é€æ—¶é—´
â”œâ”€â”€ finish_time: ""                â† å®Œæˆæ—¶é—´
â”œâ”€â”€ tracking_no: "SF1234567890"    â† å¿«é€’å•å·
â””â”€â”€ current_location: "ä¸Šæµ·è½¬è¿ä¸­å¿ƒ" â† å½“å‰ä½ç½®
```

### 2.4 é…ç½®ä¸­å¿ƒå®ç°


**ä¸šåŠ¡åœºæ™¯**ï¼šç³»ç»Ÿæœ‰å¾ˆå¤šé…ç½®é¡¹ï¼Œéœ€è¦åŠ¨æ€ä¿®æ”¹ï¼Œå®æ—¶ç”Ÿæ•ˆã€‚

**é…ç½®å­˜å‚¨æ–¹æ¡ˆ**ï¼š
```
åº”ç”¨é…ç½®ï¼šconfig:app:user-service
â”œâ”€â”€ max_connections: "100"
â”œâ”€â”€ timeout: "5000" 
â”œâ”€â”€ retry_times: "3"
â”œâ”€â”€ log_level: "INFO"
â””â”€â”€ feature_enabled: "true"

æ•°æ®åº“é…ç½®ï¼šconfig:db:mysql
â”œâ”€â”€ host: "localhost"
â”œâ”€â”€ port: "3306"
â”œâ”€â”€ username: "root" 
â”œâ”€â”€ max_pool_size: "20"
â””â”€â”€ connection_timeout: "30000"
```

---

## 3. ğŸ›’ è´­ç‰©è½¦ç³»ç»Ÿå®Œæ•´å®ç°


### 3.1 è´­ç‰©è½¦æ•°æ®ç»“æ„è®¾è®¡


**æ ¸å¿ƒæ€è·¯**ï¼šä¸€ä¸ªç”¨æˆ·çš„è´­ç‰©è½¦å°±æ˜¯ä¸€ä¸ªHashï¼Œæ¯ä¸ªå•†å“IDä½œä¸ºå­—æ®µåï¼Œå•†å“æ•°é‡ä½œä¸ºå­—æ®µå€¼ã€‚

```
è´­ç‰©è½¦å­˜å‚¨ç»“æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Key: cart:user:1001                 â”‚  â† ç”¨æˆ·1001çš„è´­ç‰©è½¦
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å•†å“ID : æ•°é‡                        â”‚
â”‚ â”œâ”€â”€ 10001: "2"    â† iPhone 15 ä¹°äº†2ä¸ª â”‚
â”‚ â”œâ”€â”€ 10002: "1"    â† MacBook ä¹°äº†1ä¸ª   â”‚
â”‚ â”œâ”€â”€ 10003: "3"    â† AirPods ä¹°äº†3ä¸ª   â”‚
â”‚ â””â”€â”€ 10004: "1"    â† iPad ä¹°äº†1ä¸ª      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é¢å¤–ä¿¡æ¯å­˜å‚¨ï¼šcart:info:user:1001
â”œâ”€â”€ total_items: "7"        â† æ€»å•†å“æ•°é‡
â”œâ”€â”€ total_amount: "25999"   â† æ€»é‡‘é¢
â”œâ”€â”€ update_time: "2025-08-28"
â””â”€â”€ discount_amount: "500"  â† ä¼˜æƒ é‡‘é¢
```

### 3.2 è´­ç‰©è½¦æ ¸å¿ƒæ“ä½œå®ç°


**å®Œæ•´çš„è´­ç‰©è½¦ç®¡ç†ç±»**ï¼š
```java
@Service
public class ShoppingCartService {
    
    private RedisTemplate<String, Object> redisTemplate;
    
    // æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦
    public void addToCart(Long userId, Long productId, Integer quantity) {
        String cartKey = "cart:user:" + userId;
        String infoKey = "cart:info:user:" + userId;
        
        // è·å–å½“å‰å•†å“æ•°é‡
        Object currentQty = redisTemplate.opsForHash().get(cartKey, productId.toString());
        int newQuantity = quantity;
        
        if (currentQty != null) {
            // å¦‚æœå•†å“å·²å­˜åœ¨ï¼Œç´¯åŠ æ•°é‡
            newQuantity += Integer.parseInt(currentQty.toString());
        }
        
        // æ›´æ–°å•†å“æ•°é‡
        redisTemplate.opsForHash().put(cartKey, productId.toString(), newQuantity);
        
        // æ›´æ–°è´­ç‰©è½¦ç»Ÿè®¡ä¿¡æ¯
        updateCartSummary(userId);
        
        System.out.println("å•†å“ " + productId + " å·²æ·»åŠ åˆ°è´­ç‰©è½¦ï¼Œæ•°é‡ï¼š" + newQuantity);
    }
    
    // ä¿®æ”¹å•†å“æ•°é‡
    public void updateQuantity(Long userId, Long productId, Integer quantity) {
        String cartKey = "cart:user:" + userId;
        
        if (quantity <= 0) {
            // æ•°é‡ä¸º0æˆ–è´Ÿæ•°ï¼Œåˆ é™¤å•†å“
            removeFromCart(userId, productId);
            return;
        }
        
        // æ£€æŸ¥å•†å“æ˜¯å¦åœ¨è´­ç‰©è½¦ä¸­
        if (!redisTemplate.opsForHash().hasKey(cartKey, productId.toString())) {
            throw new RuntimeException("å•†å“ä¸åœ¨è´­ç‰©è½¦ä¸­");
        }
        
        // æ›´æ–°æ•°é‡
        redisTemplate.opsForHash().put(cartKey, productId.toString(), quantity);
        updateCartSummary(userId);
    }
    
    // ä»è´­ç‰©è½¦åˆ é™¤å•†å“
    public void removeFromCart(Long userId, Long productId) {
        String cartKey = "cart:user:" + userId;
        
        // åˆ é™¤å•†å“
        redisTemplate.opsForHash().delete(cartKey, productId.toString());
        updateCartSummary(userId);
        
        System.out.println("å•†å“ " + productId + " å·²ä»è´­ç‰©è½¦åˆ é™¤");
    }
    
    // è·å–è´­ç‰©è½¦è¯¦æƒ…
    public CartDetail getCartDetail(Long userId) {
        String cartKey = "cart:user:" + userId;
        String infoKey = "cart:info:user:" + userId;
        
        // è·å–è´­ç‰©è½¦å•†å“
        Map<Object, Object> cartItems = redisTemplate.opsForHash().entries(cartKey);
        
        // è·å–è´­ç‰©è½¦ç»Ÿè®¡ä¿¡æ¯  
        Map<Object, Object> cartInfo = redisTemplate.opsForHash().entries(infoKey);
        
        return buildCartDetail(cartItems, cartInfo);
    }
    
    // æ¸…ç©ºè´­ç‰©è½¦
    public void clearCart(Long userId) {
        String cartKey = "cart:user:" + userId;
        String infoKey = "cart:info:user:" + userId;
        
        redisTemplate.delete(cartKey);
        redisTemplate.delete(infoKey);
        
        System.out.println("ç”¨æˆ· " + userId + " çš„è´­ç‰©è½¦å·²æ¸…ç©º");
    }
}
```

### 3.3 è´­ç‰©è½¦ç»Ÿè®¡è®¡ç®—


**ç»Ÿè®¡ä¿¡æ¯å®æ—¶æ›´æ–°**ï¼š
```java
// æ›´æ–°è´­ç‰©è½¦æ±‡æ€»ä¿¡æ¯
private void updateCartSummary(Long userId) {
    String cartKey = "cart:user:" + userId;
    String infoKey = "cart:info:user:" + userId;
    
    // è·å–è´­ç‰©è½¦æ‰€æœ‰å•†å“
    Map<Object, Object> cartItems = redisTemplate.opsForHash().entries(cartKey);
    
    if (cartItems.isEmpty()) {
        // è´­ç‰©è½¦ä¸ºç©ºï¼Œåˆ é™¤ç»Ÿè®¡ä¿¡æ¯
        redisTemplate.delete(infoKey);
        return;
    }
    
    int totalItems = 0;
    BigDecimal totalAmount = BigDecimal.ZERO;
    
    // è®¡ç®—æ€»æ•°é‡å’Œæ€»é‡‘é¢
    for (Map.Entry<Object, Object> entry : cartItems.entrySet()) {
        Long productId = Long.valueOf(entry.getKey().toString());
        Integer quantity = Integer.valueOf(entry.getValue().toString());
        
        totalItems += quantity;
        
        // è·å–å•†å“ä»·æ ¼ï¼ˆè¿™é‡Œç®€åŒ–å¤„ç†ï¼‰
        BigDecimal price = getProductPrice(productId);
        totalAmount = totalAmount.add(price.multiply(BigDecimal.valueOf(quantity)));
    }
    
    // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
    Map<String, Object> summary = new HashMap<>();
    summary.put("total_items", totalItems);
    summary.put("total_amount", totalAmount.toString());
    summary.put("update_time", System.currentTimeMillis());
    
    redisTemplate.opsForHash().putAll(infoKey, summary);
}
```

### 3.4 å¤šç«¯æ•°æ®åŒæ­¥


**åŒæ­¥ç­–ç•¥**ï¼šç”¨æˆ·åœ¨æ‰‹æœºAppåŠ å…¥è´­ç‰©è½¦ï¼Œåœ¨ç½‘é¡µç«¯ä¹Ÿèƒ½çœ‹åˆ°ã€‚

```java
// è´­ç‰©è½¦åŒæ­¥ç®¡ç†
public class CartSyncManager {
    
    // è·å–ç”¨æˆ·åœ¨æ‰€æœ‰ç«¯çš„è´­ç‰©è½¦åˆå¹¶ç»“æœ
    public CartDetail getSyncedCart(Long userId) {
        // æ‰€æœ‰ç«¯å…±ç”¨åŒä¸€ä¸ªè´­ç‰©è½¦Keyï¼Œå¤©ç„¶åŒæ­¥
        return shoppingCartService.getCartDetail(userId);
    }
    
    // è´­ç‰©è½¦å˜æ›´é€šçŸ¥ï¼ˆå¯ç”¨äºå®æ—¶æ¨é€ï¼‰
    public void notifyCartChange(Long userId, String operation, Long productId) {
        String notifyKey = "cart:notify:" + userId;
        
        // è®°å½•å˜æ›´ä¿¡æ¯ï¼Œä¾›å…¶ä»–ç«¯è·å–
        Map<String, Object> changeInfo = new HashMap<>();
        changeInfo.put("operation", operation);  // add/update/remove
        changeInfo.put("product_id", productId);
        changeInfo.put("timestamp", System.currentTimeMillis());
        
        redisTemplate.opsForHash().putAll(notifyKey, changeInfo);
        
        // è®¾ç½®é€šçŸ¥è¿‡æœŸæ—¶é—´ï¼ˆ5åˆ†é’Ÿï¼‰
        redisTemplate.expire(notifyKey, Duration.ofMinutes(5));
    }
}
```

---

## 4. ğŸ“Š å®æ—¶ç»Ÿè®¡åº”ç”¨è¯¦è§£


### 4.1 ç”¨æˆ·è¡Œä¸ºç»Ÿè®¡


**åœºæ™¯è¯´æ˜**ï¼šè®°å½•ç”¨æˆ·çš„å„ç§è¡Œä¸ºæ•°æ®ï¼Œå¦‚æµè§ˆã€ç‚¹å‡»ã€è´­ä¹°ç­‰ã€‚

**ç»Ÿè®¡ç»´åº¦è®¾è®¡**ï¼š
```
ç”¨æˆ·è¡Œä¸ºç»Ÿè®¡ï¼šuser:behavior:1001
â”œâ”€â”€ page_views: "156"        â† é¡µé¢æµè§ˆæ¬¡æ•°
â”œâ”€â”€ product_clicks: "89"     â† å•†å“ç‚¹å‡»æ¬¡æ•°  
â”œâ”€â”€ add_to_cart: "23"        â† åŠ è´­ç‰©è½¦æ¬¡æ•°
â”œâ”€â”€ orders: "5"              â† ä¸‹å•æ¬¡æ•°
â”œâ”€â”€ payments: "4"            â† æ”¯ä»˜æˆåŠŸæ¬¡æ•°
â”œâ”€â”€ last_active: "2025-08-28" â† æœ€åæ´»è·ƒæ—¶é—´
â””â”€â”€ total_spend: "2999.99"   â† æ€»æ¶ˆè´¹é‡‘é¢

æ¯æ—¥è¡Œä¸ºç»Ÿè®¡ï¼šuser:daily:1001:20250828
â”œâ”€â”€ page_views: "12"
â”œâ”€â”€ product_clicks: "8" 
â”œâ”€â”€ session_time: "3600"     â† ä¼šè¯æ—¶é•¿(ç§’)
â””â”€â”€ active_hours: "2"        â† æ´»è·ƒå°æ—¶æ•°
```

**ç»Ÿè®¡å®ç°**ï¼š
```java
@Service
public class UserBehaviorStats {
    
    // è®°å½•ç”¨æˆ·è¡Œä¸º
    public void recordBehavior(Long userId, String behaviorType) {
        String userKey = "user:behavior:" + userId;
        String dailyKey = "user:daily:" + userId + ":" + getTodayDate();
        
        // æ€»ä½“ç»Ÿè®¡ç´¯åŠ 
        redisTemplate.opsForHash().increment(userKey, behaviorType, 1);
        redisTemplate.opsForHash().put(userKey, "last_active", getTodayDate());
        
        // å½“æ—¥ç»Ÿè®¡ç´¯åŠ 
        redisTemplate.opsForHash().increment(dailyKey, behaviorType, 1);
        
        // å½“æ—¥ç»Ÿè®¡è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆ30å¤©ï¼‰
        redisTemplate.expire(dailyKey, Duration.ofDays(30));
    }
    
    // è®°å½•ç”¨æˆ·æ¶ˆè´¹
    public void recordSpending(Long userId, BigDecimal amount) {
        String userKey = "user:behavior:" + userId;
        
        // ç´¯åŠ æ€»æ¶ˆè´¹é‡‘é¢
        String currentSpend = (String) redisTemplate.opsForHash()
            .get(userKey, "total_spend");
        
        BigDecimal newTotal = amount;
        if (currentSpend != null) {
            newTotal = new BigDecimal(currentSpend).add(amount);
        }
        
        redisTemplate.opsForHash().put(userKey, "total_spend", newTotal.toString());
        redisTemplate.opsForHash().increment(userKey, "payments", 1);
    }
    
    // è·å–ç”¨æˆ·è¡Œä¸ºç»Ÿè®¡
    public UserBehaviorData getUserBehavior(Long userId) {
        String userKey = "user:behavior:" + userId;
        Map<Object, Object> behavior = redisTemplate.opsForHash().entries(userKey);
        
        return convertToBehaviorData(behavior);
    }
}
```

### 4.2 å•†å“é”€å”®ç»Ÿè®¡


**ç»Ÿè®¡å†…å®¹**ï¼šæ¯ä¸ªå•†å“çš„é”€å”®æ•°æ®ï¼ŒåŒ…æ‹¬æµè§ˆé‡ã€é”€å”®é‡ã€æ”¶å…¥ç­‰ã€‚

**æ•°æ®ç»“æ„**ï¼š
```
å•†å“é”€å”®ç»Ÿè®¡ï¼šproduct:stats:10001
â”œâ”€â”€ view_count: "1250"       â† å•†å“æµè§ˆæ¬¡æ•°
â”œâ”€â”€ click_count: "89"        â† å•†å“ç‚¹å‡»æ¬¡æ•°
â”œâ”€â”€ add_cart_count: "45"     â† åŠ å…¥è´­ç‰©è½¦æ¬¡æ•°  
â”œâ”€â”€ order_count: "12"        â† ä¸‹å•æ¬¡æ•°
â”œâ”€â”€ sold_count: "8"          â† å®é™…é”€å”®æ•°é‡
â”œâ”€â”€ total_revenue: "15999"   â† æ€»æ”¶å…¥
â”œâ”€â”€ avg_rating: "4.5"        â† å¹³å‡è¯„åˆ†
â””â”€â”€ last_order_time: "2025-08-28" â† æœ€åä¸‹å•æ—¶é—´

å•†å“æ¯æ—¥ç»Ÿè®¡ï¼šproduct:daily:10001:20250828  
â”œâ”€â”€ views: "25"
â”œâ”€â”€ clicks: "5"
â”œâ”€â”€ orders: "2" 
â””â”€â”€ revenue: "1999"
```

### 4.3 ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡ç»Ÿè®¡


**ç›‘æ§æŒ‡æ ‡**ï¼š
```java
// ç³»ç»Ÿæ€§èƒ½ç»Ÿè®¡
public class SystemMetricsCollector {
    
    // è®°å½•APIè°ƒç”¨ç»Ÿè®¡
    public void recordApiCall(String apiName, long responseTime, boolean success) {
        String metricsKey = "api:metrics:" + apiName;
        String todayKey = "api:daily:" + apiName + ":" + getTodayDate();
        
        // æ€»ä½“ç»Ÿè®¡
        redisTemplate.opsForHash().increment(metricsKey, "total_calls", 1);
        redisTemplate.opsForHash().increment(metricsKey, 
            success ? "success_calls" : "error_calls", 1);
        
        // æ›´æ–°å¹³å‡å“åº”æ—¶é—´
        updateAverageResponseTime(metricsKey, responseTime);
        
        // æ¯æ—¥ç»Ÿè®¡
        redisTemplate.opsForHash().increment(todayKey, "calls", 1);
        redisTemplate.opsForHash().increment(todayKey, 
            success ? "success" : "errors", 1);
    }
    
    // ç³»ç»Ÿè´Ÿè½½ç»Ÿè®¡
    public void recordSystemLoad(double cpuUsage, double memoryUsage) {
        String loadKey = "system:load:current";
        
        Map<String, Object> loadData = new HashMap<>();
        loadData.put("cpu_usage", String.valueOf(cpuUsage));
        loadData.put("memory_usage", String.valueOf(memoryUsage));
        loadData.put("timestamp", System.currentTimeMillis());
        
        redisTemplate.opsForHash().putAll(loadKey, loadData);
        
        // å†å²æ•°æ®ä¿å­˜ï¼ˆç®€åŒ–ç‰ˆï¼‰
        recordHistoryLoad(cpuUsage, memoryUsage);
    }
}
```

### 4.4 ä¸šåŠ¡æ•°æ®èšåˆ


**å¤šç»´åº¦ç»Ÿè®¡æ±‡æ€»**ï¼š
```java
// ä¸šåŠ¡æ•°æ®èšåˆæœåŠ¡
public class BusinessDataAggregator {
    
    // ç”Ÿæˆä¸šåŠ¡æ—¥æŠ¥ç»Ÿè®¡
    public DailyReport generateDailyReport(String date) {
        DailyReport report = new DailyReport();
        
        // ç”¨æˆ·ç›¸å…³ç»Ÿè®¡
        report.setNewUsers(getNewUserCount(date));
        report.setActiveUsers(getActiveUserCount(date));
        report.setTotalUsers(getTotalUserCount());
        
        // è®¢å•ç›¸å…³ç»Ÿè®¡
        report.setTotalOrders(getDailyOrderCount(date));
        report.setTotalRevenue(getDailyRevenue(date));
        report.setAvgOrderValue(calculateAvgOrderValue(date));
        
        // å•†å“ç›¸å…³ç»Ÿè®¡
        report.setTopProducts(getTopSellingProducts(date));
        report.setTotalViews(getTotalProductViews(date));
        
        return report;
    }
    
    // å®æ—¶è·å–æ ¸å¿ƒæŒ‡æ ‡
    public BusinessMetrics getRealTimeMetrics() {
        BusinessMetrics metrics = new BusinessMetrics();
        
        // ä»å„ä¸ªHashä¸­æ±‡æ€»æ•°æ®
        String today = getTodayDate();
        
        // ä»Šæ—¥æ–°å¢ç”¨æˆ·
        String newUserKey = "stats:users:new:" + today;
        metrics.setTodayNewUsers(getHashFieldAsInt(newUserKey, "count"));
        
        // ä»Šæ—¥è®¢å•æ•°
        String orderKey = "stats:orders:" + today;
        metrics.setTodayOrders(getHashFieldAsInt(orderKey, "count"));
        
        // ä»Šæ—¥æ”¶å…¥
        metrics.setTodayRevenue(getHashFieldAsBigDecimal(orderKey, "revenue"));
        
        return metrics;
    }
}
```

---

## 5. ğŸ¯ ç»¼åˆå®æˆ˜æ¡ˆä¾‹


### 5.1 ç”¨æˆ·èµ„æ–™ç®¡ç†ç³»ç»Ÿ


**å®Œæ•´çš„ç”¨æˆ·ç®¡ç†æ–¹æ¡ˆ**ï¼š
```java
@Service
public class UserProfileSystem {
    
    // ç”¨æˆ·æ³¨å†Œ
    public void registerUser(UserRegistration registration) {
        Long userId = generateUserId();
        String profileKey = "user:profile:" + userId;
        String settingsKey = "user:settings:" + userId;
        String statsKey = "user:stats:" + userId;
        
        // åŸºæœ¬èµ„æ–™
        Map<String, Object> profile = new HashMap<>();
        profile.put("username", registration.getUsername());
        profile.put("email", registration.getEmail());
        profile.put("phone", registration.getPhone());
        profile.put("register_time", System.currentTimeMillis());
        profile.put("status", "active");
        
        // é»˜è®¤è®¾ç½®
        Map<String, Object> settings = new HashMap<>();
        settings.put("theme", "light");
        settings.put("language", "zh-CN");
        settings.put("notification", "true");
        settings.put("privacy", "normal");
        
        // åˆå§‹ç»Ÿè®¡
        Map<String, Object> stats = new HashMap<>();
        stats.put("login_count", "0");
        stats.put("last_login", "");
        stats.put("total_time", "0");
        stats.put("level", "1");
        
        // æ‰¹é‡ä¿å­˜
        redisTemplate.opsForHash().putAll(profileKey, profile);
        redisTemplate.opsForHash().putAll(settingsKey, settings);
        redisTemplate.opsForHash().putAll(statsKey, stats);
    }
    
    // ç”¨æˆ·ç™»å½•ç»Ÿè®¡
    public void recordLogin(Long userId) {
        String statsKey = "user:stats:" + userId;
        
        // å¢åŠ ç™»å½•æ¬¡æ•°
        redisTemplate.opsForHash().increment(statsKey, "login_count", 1);
        
        // æ›´æ–°æœ€åç™»å½•æ—¶é—´
        redisTemplate.opsForHash().put(statsKey, "last_login", 
            System.currentTimeMillis());
            
        // è®°å½•ç™»å½•æ—¥å¿—ï¼ˆå¯é€‰ï¼‰
        recordLoginHistory(userId);
    }
}
```

### 5.2 ç”µå•†è´­ç‰©è½¦å®ç°


å·²åœ¨ç¬¬3èŠ‚è¯¦ç»†ä»‹ç»ï¼Œè¿™é‡Œè¡¥å……**è´­ç‰©è½¦ä¼˜åŒ–ç­–ç•¥**ï¼š

```java
// è´­ç‰©è½¦æ€§èƒ½ä¼˜åŒ–
public class CartOptimizer {
    
    // è´­ç‰©è½¦é¢„åŠ è½½ï¼ˆç”¨æˆ·ç™»å½•æ—¶ï¼‰
    public void preloadCart(Long userId) {
        String cartKey = "cart:user:" + userId;
        
        // æ£€æŸ¥è´­ç‰©è½¦æ˜¯å¦å­˜åœ¨
        if (!redisTemplate.hasKey(cartKey)) {
            // ä»æ•°æ®åº“åŠ è½½å†å²è´­ç‰©è½¦æ•°æ®ï¼ˆå¦‚æœæœ‰ï¼‰
            loadCartFromDatabase(userId);
        }
        
        // é¢„è®¡ç®—è´­ç‰©è½¦ç»Ÿè®¡ä¿¡æ¯
        updateCartSummary(userId);
    }
    
    // è´­ç‰©è½¦æ•°æ®åŒæ­¥åˆ°æ•°æ®åº“ï¼ˆå¼‚æ­¥ï¼‰
    @Async
    public void syncCartToDatabase(Long userId) {
        CartDetail cart = shoppingCartService.getCartDetail(userId);
        
        // å¼‚æ­¥ä¿å­˜åˆ°æ•°æ®åº“ï¼Œé¿å…å½±å“ç”¨æˆ·æ“ä½œä½“éªŒ
        databaseService.saveCart(cart);
    }
    
    // è´­ç‰©è½¦è¿‡æœŸæ¸…ç†
    @Scheduled(fixedRate = 3600000) // æ¯å°æ—¶æ‰§è¡Œ
    public void cleanExpiredCarts() {
        // æŸ¥æ‰¾é•¿æœŸæœªæ›´æ–°çš„è´­ç‰©è½¦
        String pattern = "cart:user:*";
        Set<String> cartKeys = redisTemplate.keys(pattern);
        
        for (String key : cartKeys) {
            String infoKey = key.replace("cart:user:", "cart:info:user:");
            Object updateTime = redisTemplate.opsForHash().get(infoKey, "update_time");
            
            if (updateTime != null) {
                long lastUpdate = Long.parseLong(updateTime.toString());
                long daysSinceUpdate = (System.currentTimeMillis() - lastUpdate) / (24 * 60 * 60 * 1000);
                
                // è¶…è¿‡30å¤©æœªæ›´æ–°çš„è´­ç‰©è½¦ï¼ŒåŒæ­¥åˆ°æ•°æ®åº“åæ¸…ç†
                if (daysSinceUpdate > 30) {
                    Long userId = extractUserIdFromKey(key);
                    syncCartToDatabase(userId);
                    
                    redisTemplate.delete(key);
                    redisTemplate.delete(infoKey);
                }
            }
        }
    }
}
```

### 5.3 ç³»ç»Ÿé…ç½®ç®¡ç†


**åŠ¨æ€é…ç½®ä¸­å¿ƒ**ï¼š
```java
@Component
public class ConfigurationCenter {
    
    // åº”ç”¨å¯åŠ¨æ—¶åŠ è½½é…ç½®
    @PostConstruct
    public void loadConfigurations() {
        loadDefaultConfigs();
    }
    
    // è·å–é…ç½®å€¼
    public String getConfig(String module, String key) {
        String configKey = "config:" + module;
        Object value = redisTemplate.opsForHash().get(configKey, key);
        
        return value != null ? value.toString() : null;
    }
    
    // è·å–é…ç½®å€¼ï¼ˆå¸¦é»˜è®¤å€¼ï¼‰
    public String getConfig(String module, String key, String defaultValue) {
        String value = getConfig(module, key);
        return value != null ? value : defaultValue;
    }
    
    // æ›´æ–°é…ç½®
    public void updateConfig(String module, String key, String value) {
        String configKey = "config:" + module;
        
        // è®°å½•é…ç½®å˜æ›´å†å²
        recordConfigChange(module, key, getConfig(module, key), value);
        
        // æ›´æ–°é…ç½®
        redisTemplate.opsForHash().put(configKey, key, value);
        
        // é€šçŸ¥åº”ç”¨é…ç½®å·²æ›´æ–°
        notifyConfigUpdate(module, key, value);
    }
    
    // æ‰¹é‡æ›´æ–°é…ç½®
    public void updateConfigs(String module, Map<String, String> configs) {
        String configKey = "config:" + module;
        
        // æ‰¹é‡æ›´æ–°
        redisTemplate.opsForHash().putAll(configKey, configs);
        
        // æ‰¹é‡é€šçŸ¥
        configs.forEach((key, value) -> notifyConfigUpdate(module, key, value));
    }
    
    // è·å–æ¨¡å—æ‰€æœ‰é…ç½®
    public Map<String, String> getModuleConfigs(String module) {
        String configKey = "config:" + module;
        Map<Object, Object> configs = redisTemplate.opsForHash().entries(configKey);
        
        return configs.entrySet().stream()
            .collect(Collectors.toMap(
                entry -> entry.getKey().toString(),
                entry -> entry.getValue().toString()
            ));
    }
}
```

### 5.4 å¤šç»´åº¦æ•°æ®ç»Ÿè®¡


**ç»¼åˆç»Ÿè®¡dashboardæ•°æ®**ï¼š
```java
@Service
public class StatisticsService {
    
    // ç”Ÿæˆå®æ—¶æ•°æ®é¢æ¿
    public DashboardData generateDashboard() {
        DashboardData dashboard = new DashboardData();
        
        // ç”¨æˆ·ç›¸å…³ç»Ÿè®¡
        dashboard.setUserStats(getUserStatistics());
        
        // è®¢å•ç›¸å…³ç»Ÿè®¡  
        dashboard.setOrderStats(getOrderStatistics());
        
        // å•†å“ç›¸å…³ç»Ÿè®¡
        dashboard.setProductStats(getProductStatistics());
        
        // ç³»ç»Ÿæ€§èƒ½ç»Ÿè®¡
        dashboard.setSystemStats(getSystemStatistics());
        
        return dashboard;
    }
    
    // ç”¨æˆ·ç»Ÿè®¡
    private UserStats getUserStatistics() {
        UserStats stats = new UserStats();
        
        // æ€»ç”¨æˆ·æ•°
        String userCountKey = "stats:users:total";
        stats.setTotalUsers(getHashFieldAsInt(userCountKey, "count"));
        
        // ä»Šæ—¥æ–°å¢
        String todayKey = "stats:users:new:" + getTodayDate();
        stats.setTodayNewUsers(getHashFieldAsInt(todayKey, "count"));
        
        // ä»Šæ—¥æ´»è·ƒ
        String activeKey = "stats:users:active:" + getTodayDate();  
        stats.setTodayActiveUsers(getHashFieldAsInt(activeKey, "count"));
        
        return stats;
    }
    
    // å®æ—¶æ›´æ–°ç»Ÿè®¡æ•°æ®
    public void updateRealTimeStats(String statsType, String key, Object value) {
        String statsKey = "stats:realtime:" + statsType;
        
        redisTemplate.opsForHash().put(statsKey, key, value);
        redisTemplate.opsForHash().put(statsKey, "update_time", System.currentTimeMillis());
        
        // è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆ1å°æ—¶ï¼‰
        redisTemplate.expire(statsKey, Duration.ofHours(1));
    }
}
```

### 5.5 è¡¨å•æ•°æ®ç¼“å­˜


**è¡¨å•ä¸´æ—¶å­˜å‚¨**ï¼š
```java
@Service  
public class FormCacheService {
    
    // ä¿å­˜è¡¨å•è‰ç¨¿
    public void saveFormDraft(Long userId, String formType, Map<String, Object> formData) {
        String draftKey = "form:draft:" + userId + ":" + formType;
        
        // æ·»åŠ å…ƒæ•°æ®
        formData.put("save_time", System.currentTimeMillis());
        formData.put("form_version", "1.0");
        
        // ä¿å­˜è¡¨å•æ•°æ®
        redisTemplate.opsForHash().putAll(draftKey, formData);
        
        // è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆ24å°æ—¶ï¼‰
        redisTemplate.expire(draftKey, Duration.ofHours(24));
    }
    
    // è·å–è¡¨å•è‰ç¨¿
    public Map<String, Object> getFormDraft(Long userId, String formType) {
        String draftKey = "form:draft:" + userId + ":" + formType;
        
        Map<Object, Object> draft = redisTemplate.opsForHash().entries(draftKey);
        
        if (draft.isEmpty()) {
            return null;
        }
        
        // è½¬æ¢æ•°æ®ç±»å‹
        return draft.entrySet().stream()
            .collect(Collectors.toMap(
                entry -> entry.getKey().toString(),
                Map.Entry::getValue
            ));
    }
    
    // æ¸…é™¤è¡¨å•è‰ç¨¿
    public void clearFormDraft(Long userId, String formType) {
        String draftKey = "form:draft:" + userId + ":" + formType;
        redisTemplate.delete(draftKey);
    }
    
    // è¡¨å•æ•°æ®ä¸´æ—¶é”å®šï¼ˆé˜²æ­¢é‡å¤æäº¤ï¼‰
    public boolean lockFormSubmission(Long userId, String formType) {
        String lockKey = "form:lock:" + userId + ":" + formType;
        
        // å°è¯•è®¾ç½®é”ï¼Œè¿‡æœŸæ—¶é—´30ç§’
        Boolean locked = redisTemplate.opsForValue()
            .setIfAbsent(lockKey, "locked", Duration.ofSeconds(30));
            
        return Boolean.TRUE.equals(locked);
    }
}
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 Hashç±»å‹é€‚ç”¨åœºæ™¯æ€»ç»“


**âœ… Hashæœ€é€‚åˆçš„åœºæ™¯**ï¼š
- **å¯¹è±¡å­˜å‚¨**ï¼šç”¨æˆ·ä¿¡æ¯ã€å•†å“ä¿¡æ¯ç­‰ç»“æ„åŒ–æ•°æ®
- **é…ç½®ç®¡ç†**ï¼šç³»ç»Ÿé…ç½®ã€åº”ç”¨å‚æ•°ç­‰é”®å€¼å¯¹æ•°æ®  
- **ç»Ÿè®¡è®¡æ•°**ï¼šå„ç§ç»´åº¦çš„è®¡æ•°ç»Ÿè®¡
- **ç¼“å­˜ä¼˜åŒ–**ï¼šå‡å°‘åºåˆ—åŒ–å¼€é”€çš„å¯¹è±¡ç¼“å­˜
- **è´­ç‰©è½¦**ï¼šå•†å“IDå’Œæ•°é‡çš„æ˜ å°„å…³ç³»

**âŒ Hashä¸å¤ªé€‚åˆçš„åœºæ™¯**ï¼š
- **ç®€å•å€¼å­˜å‚¨**ï¼šå•ä¸ªå­—ç¬¦ä¸²æˆ–æ•°å­—ï¼Œç›´æ¥ç”¨Stringç±»å‹
- **åˆ—è¡¨æ•°æ®**ï¼šæœ‰åºçš„æ•°æ®é›†åˆï¼Œåº”è¯¥ç”¨Listç±»å‹
- **é›†åˆè¿ç®—**ï¼šéœ€è¦äº¤é›†ã€å¹¶é›†ç­‰è¿ç®—ï¼Œåº”è¯¥ç”¨Setç±»å‹
- **æ’åºéœ€æ±‚**ï¼šéœ€è¦æŒ‰åˆ†æ•°æ’åºï¼Œåº”è¯¥ç”¨ZSetç±»å‹

### 6.2 Hashä½¿ç”¨æœ€ä½³å®è·µ


**ğŸ¯ è®¾è®¡åŸåˆ™**ï¼š
```
Keyå‘½åè§„èŒƒï¼š
âœ… æ¨¡å—:ç±»å‹:æ ‡è¯†ç¬¦  â†’ user:profile:1001
âœ… ä¸šåŠ¡:å¯¹è±¡:ID     â†’ order:info:20250828001
âœ… åŠŸèƒ½:èŒƒå›´:å‚æ•°   â†’ config:app:user-service

âŒ é¿å…çš„å‘½åï¼š
âŒ user1001profile  â†’ æ²¡æœ‰å±‚æ¬¡ç»“æ„
âŒ u:p:1001        â†’ è¿‡åº¦ç®€åŒ–ï¼Œå¯è¯»æ€§å·®
```

**âš¡ æ€§èƒ½ä¼˜åŒ–æŠ€å·§**ï¼š
```
1. åˆç†æ§åˆ¶Hashå¤§å°
   - å•ä¸ªHashä¸è¶…è¿‡1000ä¸ªå­—æ®µ
   - å­—æ®µåå°½é‡ç®€çŸ­
   - é¿å…å­˜å‚¨è¿‡å¤§çš„å€¼

2. æ‰¹é‡æ“ä½œä¼˜åŒ–
   - ä½¿ç”¨HMSETæ‰¹é‡è®¾ç½®
   - ä½¿ç”¨HMGETæ‰¹é‡è·å–
   - é¿å…å¤šæ¬¡å•å­—æ®µæ“ä½œ

3. å†…å­˜ä¼˜åŒ–
   - å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®
   - åˆå¹¶ç›¸å…³å­—æ®µåˆ°ä¸€ä¸ªHash
   - é¿å…åˆ›å»ºç©ºHash
```

**ğŸ”’ æ•°æ®ä¸€è‡´æ€§ä¿è¯**ï¼š
```
1. åŸå­æ€§æ“ä½œ
   - ä½¿ç”¨Redisäº‹åŠ¡(MULTI/EXEC)
   - åˆ©ç”¨Hashæ“ä½œçš„åŸå­æ€§
   - é¿å…åˆ†æ­¥éª¤çš„å¤åˆæ“ä½œ

2. æ•°æ®åŒæ­¥ç­–ç•¥
   - å®šæœŸåŒæ­¥åˆ°æŒä¹…åŒ–å­˜å‚¨
   - ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—å¼‚æ­¥åŒæ­¥
   - è®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´

3. å¼‚å¸¸å¤„ç†
   - æ“ä½œå¤±è´¥çš„å›æ»šç­–ç•¥
   - æ•°æ®ä¸¢å¤±çš„æ¢å¤æ–¹æ¡ˆ
   - ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶
```

### 6.3 å®é™…é¡¹ç›®åº”ç”¨æŒ‡å¯¼


**ğŸ“Š å®¹é‡è§„åˆ’**ï¼š
```
ç”¨æˆ·è§„æ¨¡è¯„ä¼°ï¼š
- 10ä¸‡ç”¨æˆ· â†’ æ¯ä¸ªç”¨æˆ·Hashçº¦1KB â†’ æ€»è®¡çº¦100MB
- 100ä¸‡ç”¨æˆ· â†’ æ¯ä¸ªç”¨æˆ·Hashçº¦1KB â†’ æ€»è®¡çº¦1GB  
- 1000ä¸‡ç”¨æˆ· â†’ éœ€è¦è€ƒè™‘æ•°æ®åˆ†ç‰‡å’Œé›†ç¾¤

è´­ç‰©è½¦è§„æ¨¡è¯„ä¼°ï¼š
- å¹³å‡æ¯ç”¨æˆ·10ä¸ªå•†å“ â†’ æ¯ä¸ªHashçº¦200B
- 100ä¸‡æ´»è·ƒç”¨æˆ· â†’ è´­ç‰©è½¦æ•°æ®çº¦200MB
```

**ğŸ”„ ç”Ÿäº§ç¯å¢ƒæ³¨æ„äº‹é¡¹**ï¼š
```
ç›‘æ§æŒ‡æ ‡ï¼š
- Hashé”®çš„æ•°é‡å¢é•¿è¶‹åŠ¿
- å•ä¸ªHashçš„å­—æ®µæ•°é‡
- Hashæ“ä½œçš„å“åº”æ—¶é—´
- å†…å­˜ä½¿ç”¨ç‡

è¿ç»´ç­–ç•¥ï¼š
- è®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´
- å®šæœŸæ¸…ç†æ— ç”¨æ•°æ®
- ç›‘æ§å¤§keyçš„äº§ç”Ÿ
- å¤‡ä»½é‡è¦çš„Hashæ•°æ®
```

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- Hashé€‚åˆå­˜å‚¨**å¯¹è±¡å’Œé…ç½®**ï¼Œä¸€ä¸ªHashå°±æ˜¯ä¸€ä¸ªæ•°æ®ç›’å­
- **å­—æ®µçº§æ“ä½œ**æ˜¯Hashçš„æ ¸å¿ƒä¼˜åŠ¿ï¼Œä¸ç”¨åºåˆ—åŒ–æ•´ä¸ªå¯¹è±¡
- **è´­ç‰©è½¦å’Œç»Ÿè®¡**æ˜¯Hashçš„ç»å…¸åº”ç”¨åœºæ™¯
- **åˆç†å‘½å**å’Œ**æ§åˆ¶å¤§å°**æ˜¯ä½¿ç”¨Hashçš„å…³é”®
- Hashè®©**å¤æ‚æ•°æ®å˜ç®€å•**ï¼Œè®©**é¢‘ç¹æ›´æ–°æ›´é«˜æ•ˆ**