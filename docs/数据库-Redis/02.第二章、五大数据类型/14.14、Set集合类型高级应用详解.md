---
title: 14ã€Seté›†åˆç±»å‹é«˜çº§åº”ç”¨è¯¦è§£
---
## ğŸ“š ç›®å½•

1. [Seté›†åˆåŸºç¡€å›é¡¾](#1-Seté›†åˆåŸºç¡€å›é¡¾)
2. [ç”¨æˆ·æ ‡ç­¾ç³»ç»Ÿ](#2-ç”¨æˆ·æ ‡ç­¾ç³»ç»Ÿ)
3. [æƒé™ç®¡ç†ç³»ç»Ÿ](#3-æƒé™ç®¡ç†ç³»ç»Ÿ)
4. [ç¤¾äº¤åŠŸèƒ½å®ç°](#4-ç¤¾äº¤åŠŸèƒ½å®ç°)
5. [æŠ½å¥–ç³»ç»Ÿè®¾è®¡](#5-æŠ½å¥–ç³»ç»Ÿè®¾è®¡)
6. [å®æˆ˜æ¡ˆä¾‹é›†é”¦](#6-å®æˆ˜æ¡ˆä¾‹é›†é”¦)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”„ Seté›†åˆåŸºç¡€å›é¡¾


### 1.1 Setæ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆç”¨å®ƒï¼Ÿ


**ğŸ’¡ é€šä¿—ç†è§£**ï¼šSetå°±åƒä¸€ä¸ª**æ— åºçš„æ ‡ç­¾ç›’å­**ï¼Œé‡Œé¢è£…ç€ä¸é‡å¤çš„æ ‡ç­¾
```
æƒ³è±¡ä¸€ä¸ªè£…æ ‡ç­¾çš„ç›’å­ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·1001çš„æ ‡ç­¾ç›’  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ç¨‹åºå‘˜â”‚å®…ç”· â”‚   â”‚ â† æ¯ä¸ªæ ‡ç­¾éƒ½ä¸é‡å¤
â”‚ â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤   â”‚
â”‚ â”‚æ¸¸æˆâ”‚ç¾é£Ÿ â”‚   â”‚ â† æ ‡ç­¾ä¹‹é—´æ²¡æœ‰é¡ºåº
â”‚ â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”¸ æ ¸å¿ƒç‰¹ç‚¹**
- **å”¯ä¸€æ€§**ï¼šä¸€ä¸ªæ ‡ç­¾åªèƒ½å­˜åœ¨ä¸€æ¬¡ï¼Œå¤©ç„¶å»é‡
- **æ— åºæ€§**ï¼šæ ‡ç­¾æ²¡æœ‰å…ˆåé¡ºåº
- **å¿«é€ŸæŸ¥æ‰¾**ï¼šæ£€æŸ¥æŸä¸ªæ ‡ç­¾æ˜¯å¦å­˜åœ¨ï¼Œé€Ÿåº¦å¾ˆå¿«
- **é›†åˆè¿ç®—**ï¼šå¯ä»¥åšäº¤é›†ã€å¹¶é›†ã€å·®é›†è¿ç®—

### 1.2 åŸºæœ¬æ“ä½œé€Ÿè§ˆ


**âš¡ å¸¸ç”¨å‘½ä»¤**
```bash
# æ·»åŠ æ ‡ç­¾
SADD user:1001:tags "ç¨‹åºå‘˜" "å®…ç”·" "æ¸¸æˆ"

# æŸ¥çœ‹æ‰€æœ‰æ ‡ç­¾
SMEMBERS user:1001:tags

# æ£€æŸ¥æ˜¯å¦æœ‰æŸä¸ªæ ‡ç­¾
SISMEMBER user:1001:tags "ç¨‹åºå‘˜"  # è¿”å›1(æœ‰) æˆ– 0(æ²¡æœ‰)

# åˆ é™¤æ ‡ç­¾
SREM user:1001:tags "å®…ç”·"
```

---

## 2. ğŸ·ï¸ ç”¨æˆ·æ ‡ç­¾ç³»ç»Ÿ


### 2.1 ä»€ä¹ˆæ˜¯ç”¨æˆ·æ ‡ç­¾ç³»ç»Ÿï¼Ÿ


**ğŸ’¡ ç”Ÿæ´»åŒ–ç†è§£**ï¼šå°±åƒç»™æ¯ä¸ªç”¨æˆ·è´´æ ‡ç­¾
```
ç°å®ä¸­çš„æ ‡ç­¾åœºæ™¯ï¼š
ğŸ“± æ·˜å®ç»™ä½ è´´æ ‡ç­¾ï¼šã€Œæ•°ç çˆ±å¥½è€…ã€ã€Œä¸Šç­æ—ã€ã€Œä»·æ ¼æ•æ„Ÿã€
ğŸ¬ æŠ–éŸ³ç»™ä½ è´´æ ‡ç­¾ï¼šã€Œæç¬‘ã€ã€Œç¾é£Ÿã€ã€Œå® ç‰©ã€
ğŸ“š çŸ¥ä¹ç»™ä½ è´´æ ‡ç­¾ï¼šã€ŒæŠ€æœ¯ã€ã€ŒèŒåœºã€ã€Œç†è´¢ã€

ç›®çš„ï¼šäº†è§£ç”¨æˆ·ç‰¹å¾ï¼Œæä¾›ä¸ªæ€§åŒ–æœåŠ¡
```

### 2.2 æ ‡ç­¾å­˜å‚¨è®¾è®¡


**ğŸ—‚ï¸ æ•°æ®ç»“æ„è®¾è®¡**
```
ç”¨æˆ·æ ‡ç­¾å­˜å‚¨æ–¹æ¡ˆï¼š
ç”¨æˆ·ID -> æ ‡ç­¾é›†åˆ

key: user:æ ‡ç­¾ç±»å‹:ç”¨æˆ·ID
value: Seté›†åˆå­˜å‚¨æ ‡ç­¾

ç¤ºä¾‹ï¼š
user:hobby:1001    -> {"æ¸¸æˆ", "éŸ³ä¹", "æ—…æ¸¸"}
user:career:1001   -> {"ç¨‹åºå‘˜", "æŠ€æœ¯ä¸“å®¶"}  
user:shopping:1001 -> {"æ•°ç ", "å›¾ä¹¦", "ç¾é£Ÿ"}
```

**ğŸ“‹ å­˜å‚¨ç¤ºä¾‹ä»£ç **
```python
# ç»™ç”¨æˆ·æ·»åŠ å…´è¶£æ ‡ç­¾
def add_user_hobby_tags(user_id, tags):
    """ç»™ç”¨æˆ·æ·»åŠ å…´è¶£æ ‡ç­¾"""
    key = f"user:hobby:{user_id}"
    # ä¸€æ¬¡æ€§æ·»åŠ å¤šä¸ªæ ‡ç­¾
    redis_client.sadd(key, *tags)
    
# ä½¿ç”¨ç¤ºä¾‹
add_user_hobby_tags(1001, ["æ¸¸æˆ", "éŸ³ä¹", "ç”µå½±"])
```

### 2.3 æ ‡ç­¾æ“ä½œå®ç°


**ğŸ”§ å¢åˆ æ”¹æŸ¥æ“ä½œ**
```python
class UserTagSystem:
    def __init__(self, redis_client):
        self.redis = redis_client
    
    def add_tags(self, user_id, category, tags):
        """æ·»åŠ ç”¨æˆ·æ ‡ç­¾"""
        key = f"user:{category}:{user_id}"
        return self.redis.sadd(key, *tags)
    
    def get_tags(self, user_id, category):
        """è·å–ç”¨æˆ·æ ‡ç­¾"""
        key = f"user:{category}:{user_id}" 
        return self.redis.smembers(key)
    
    def has_tag(self, user_id, category, tag):
        """æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æŸä¸ªæ ‡ç­¾"""
        key = f"user:{category}:{user_id}"
        return self.redis.sismember(key, tag) == 1
    
    def remove_tags(self, user_id, category, tags):
        """åˆ é™¤ç”¨æˆ·æ ‡ç­¾"""
        key = f"user:{category}:{user_id}"
        return self.redis.srem(key, *tags)
```

### 2.4 æ ‡ç­¾æœç´¢å’Œç­›é€‰


**ğŸ” æ ‡ç­¾æœç´¢å®ç°**
```python
def find_users_by_tags(category, tags, operation='AND'):
    """
    æ ¹æ®æ ‡ç­¾æœç´¢ç”¨æˆ·
    operation: 'AND'(å¿…é¡»éƒ½æœ‰) æˆ– 'OR'(æœ‰å…¶ä¸­ä¸€ä¸ªå³å¯)
    """
    if operation == 'AND':
        # äº¤é›†ï¼šæ‰¾åˆ°åŒæ—¶æ‹¥æœ‰æ‰€æœ‰æ ‡ç­¾çš„ç”¨æˆ·
        keys = [f"tag_users:{category}:{tag}" for tag in tags]
        return redis_client.sinter(*keys)  # äº¤é›†è¿ç®—
    
    elif operation == 'OR': 
        # å¹¶é›†ï¼šæ‰¾åˆ°æ‹¥æœ‰ä»»æ„æ ‡ç­¾çš„ç”¨æˆ·
        keys = [f"tag_users:{category}:{tag}" for tag in tags]
        return redis_client.sunion(*keys)  # å¹¶é›†è¿ç®—

# å®é™…ä½¿ç”¨
# æ‰¾åŒæ—¶å–œæ¬¢"æ¸¸æˆ"å’Œ"éŸ³ä¹"çš„ç”¨æˆ·
game_music_users = find_users_by_tags('hobby', ['æ¸¸æˆ', 'éŸ³ä¹'], 'AND')

# æ‰¾å–œæ¬¢"æ¸¸æˆ"æˆ–"ç”µå½±"çš„ç”¨æˆ·  
entertainment_users = find_users_by_tags('hobby', ['æ¸¸æˆ', 'ç”µå½±'], 'OR')
```

### 2.5 æ ‡ç­¾ç»Ÿè®¡åˆ†æ


**ğŸ“Š æ ‡ç­¾çƒ­åº¦ç»Ÿè®¡**
```python
def analyze_tag_popularity(category):
    """åˆ†ææ ‡ç­¾çƒ­åº¦"""
    # è·å–æ‰€æœ‰æ ‡ç­¾ç›¸å…³çš„key
    pattern = f"tag_users:{category}:*"
    keys = redis_client.keys(pattern)
    
    tag_stats = {}
    for key in keys:
        # ä»keyä¸­æå–æ ‡ç­¾å
        tag_name = key.split(':')[-1]
        # ç»Ÿè®¡æœ‰å¤šå°‘ç”¨æˆ·æœ‰è¿™ä¸ªæ ‡ç­¾
        user_count = redis_client.scard(key)
        tag_stats[tag_name] = user_count
    
    # æŒ‰çƒ­åº¦æ’åº
    return sorted(tag_stats.items(), key=lambda x: x[1], reverse=True)

# ä½¿ç”¨ç¤ºä¾‹ï¼šåˆ†æå…´è¶£æ ‡ç­¾çƒ­åº¦
hobby_stats = analyze_tag_popularity('hobby')
print("æœ€çƒ­é—¨çš„å…´è¶£æ ‡ç­¾ï¼š", hobby_stats[:5])
```

---

## 3. ğŸ” æƒé™ç®¡ç†ç³»ç»Ÿ


### 3.1 æƒé™ç®¡ç†æ˜¯ä»€ä¹ˆï¼Ÿ


**ğŸ’¡ é€šä¿—ç†è§£**ï¼šå°±åƒç»™æ¯ä¸ªäººå‘**é€šè¡Œè¯**
```
ç”Ÿæ´»ä¸­çš„æƒé™æ¦‚å¿µï¼š
ğŸ¢ å…¬å¸é—¨ç¦å¡ï¼šä¸åŒå‘˜å·¥å¯ä»¥è¿›å…¥ä¸åŒçš„æ¥¼å±‚
ğŸ¥ åŒ»é™¢ç§‘å®¤ï¼šä¸åŒåŒ»ç”Ÿåªèƒ½è¿›å…¥å¯¹åº”ç§‘å®¤  
ğŸ« å­¦æ ¡ç³»ç»Ÿï¼šå­¦ç”Ÿã€è€å¸ˆã€ç®¡ç†å‘˜æœ‰ä¸åŒæ“ä½œæƒé™

åœ¨ç³»ç»Ÿä¸­ï¼šç”¨æˆ· -> è§’è‰² -> æƒé™
```

### 3.2 ç”¨æˆ·æƒé™é›†åˆè®¾è®¡


**ğŸ—‚ï¸ æƒé™å­˜å‚¨ç»“æ„**
```
æƒé™ç³»ç»Ÿä¸‰å±‚ç»“æ„ï¼š

1. ç”¨æˆ·æƒé™ (ç›´æ¥æƒé™)
user:permissions:ç”¨æˆ·ID -> {"æŸ¥çœ‹è®¢å•", "ä¿®æ”¹èµ„æ–™"}

2. è§’è‰²æƒé™ (è§’è‰²åŒ…å«çš„æƒé™)  
role:permissions:è§’è‰²å -> {"æ·»åŠ å•†å“", "åˆ é™¤å•†å“", "æŸ¥çœ‹ç»Ÿè®¡"}

3. ç”¨æˆ·è§’è‰² (ç”¨æˆ·æ‹¥æœ‰çš„è§’è‰²)
user:roles:ç”¨æˆ·ID -> {"ç®¡ç†å‘˜", "ç¼–è¾‘"}
```

**ğŸ—ï¸ æƒé™ç³»ç»Ÿæ¶æ„**
```
ç”¨æˆ·æƒé™è·å–æµç¨‹ï¼š

ç”¨æˆ·1001 
    â†“
æ‹¥æœ‰è§’è‰²: {"ç®¡ç†å‘˜", "ç¼–è¾‘"}
    â†“  
è§’è‰²æƒé™: ç®¡ç†å‘˜ -> {"ç”¨æˆ·ç®¡ç†", "ç³»ç»Ÿé…ç½®"} 
          ç¼–è¾‘ -> {"å†…å®¹å‘å¸ƒ", "å†…å®¹ä¿®æ”¹"}
    â†“
ç›´æ¥æƒé™: {"æŸ¥çœ‹æŠ¥è¡¨"}  
    â†“
æœ€ç»ˆæƒé™ = è§’è‰²æƒé™ âˆª ç›´æ¥æƒé™
        = {"ç”¨æˆ·ç®¡ç†", "ç³»ç»Ÿé…ç½®", "å†…å®¹å‘å¸ƒ", "å†…å®¹ä¿®æ”¹", "æŸ¥çœ‹æŠ¥è¡¨"}
```

### 3.3 æƒé™æ£€æŸ¥æœºåˆ¶


**âš¡ å¿«é€Ÿæƒé™æ£€æŸ¥**
```python
class PermissionSystem:
    def __init__(self, redis_client):
        self.redis = redis_client
    
    def check_permission(self, user_id, permission):
        """æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æŸä¸ªæƒé™"""
        
        # 1. æ£€æŸ¥ç›´æ¥æƒé™
        direct_key = f"user:permissions:{user_id}"
        if self.redis.sismember(direct_key, permission):
            return True
            
        # 2. æ£€æŸ¥è§’è‰²æƒé™
        roles_key = f"user:roles:{user_id}"
        user_roles = self.redis.smembers(roles_key)
        
        for role in user_roles:
            role_key = f"role:permissions:{role}"
            if self.redis.sismember(role_key, permission):
                return True
                
        return False
    
    def get_user_all_permissions(self, user_id):
        """è·å–ç”¨æˆ·çš„æ‰€æœ‰æƒé™"""
        all_permissions = set()
        
        # ç›´æ¥æƒé™
        direct_key = f"user:permissions:{user_id}"
        direct_perms = self.redis.smembers(direct_key)
        all_permissions.update(direct_perms)
        
        # è§’è‰²æƒé™
        roles_key = f"user:roles:{user_id}"
        user_roles = self.redis.smembers(roles_key)
        
        for role in user_roles:
            role_key = f"role:permissions:{role}"
            role_perms = self.redis.smembers(role_key) 
            all_permissions.update(role_perms)
            
        return all_permissions
```

### 3.4 åŠ¨æ€æƒé™æ§åˆ¶


**ğŸ”„ æƒé™çš„åŠ¨æ€ç®¡ç†**
```python
def assign_role_to_user(user_id, role_name):
    """ç»™ç”¨æˆ·åˆ†é…è§’è‰²"""
    key = f"user:roles:{user_id}"
    redis_client.sadd(key, role_name)
    
def revoke_role_from_user(user_id, role_name): 
    """æ’¤é”€ç”¨æˆ·è§’è‰²"""
    key = f"user:roles:{user_id}"
    redis_client.srem(key, role_name)
    
def update_role_permissions(role_name, permissions):
    """æ›´æ–°è§’è‰²æƒé™"""
    key = f"role:permissions:{role_name}"
    # å…ˆæ¸…ç©ºåŸæœ‰æƒé™
    redis_client.delete(key)
    # æ·»åŠ æ–°æƒé™
    if permissions:
        redis_client.sadd(key, *permissions)

# ä½¿ç”¨åœºæ™¯ï¼š
# æ–°å‘˜å·¥å…¥èŒï¼Œåˆ†é…"å‘˜å·¥"è§’è‰²
assign_role_to_user(2001, "å‘˜å·¥")

# å‘˜å·¥å‡èŒï¼Œæ·»åŠ "ä¸»ç®¡"è§’è‰²
assign_role_to_user(2001, "ä¸»ç®¡") 

# è°ƒæ•´"ä¸»ç®¡"è§’è‰²æƒé™
update_role_permissions("ä¸»ç®¡", ["å›¢é˜Ÿç®¡ç†", "ç»©æ•ˆè€ƒæ ¸", "è¯·å‡å®¡æ‰¹"])
```

---

## 4. ğŸ‘¥ ç¤¾äº¤åŠŸèƒ½å®ç°


### 4.1 ç¤¾äº¤å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ


**ğŸ’¡ ç”Ÿæ´»åŒ–ç†è§£**ï¼šå°±åƒ**æœ‹å‹åœˆç®¡ç†**
```
å¾®ä¿¡æœ‹å‹åœˆçš„æ¦‚å¿µï¼š
ä½ çš„æœ‹å‹: {"å°æ˜", "å°çº¢", "å°åˆš"}
å°æ˜çš„æœ‹å‹: {"ä½ ", "å°æ", "å°ç‹"}  

å…±åŒæœ‹å‹ = ä½ çš„æœ‹å‹ âˆ© å°æ˜çš„æœ‹å‹ = {"ä½ "} (ä¸åŒ…å«è‡ªå·±ï¼Œå®é™…ä¸ºç©º)

çœŸå®åœºæ™¯ï¼š
ä½ : {"A", "B", "C"}
å°æ˜: {"B", "C", "D"} 
å…±åŒæœ‹å‹: {"B", "C"}
```

### 4.2 å¥½å‹å…³ç³»å­˜å‚¨


**ğŸ‘« å…³ç³»æ•°æ®ç»“æ„**
```
å¥½å‹å…³ç³»å­˜å‚¨ï¼š
user:friends:ç”¨æˆ·ID -> å¥½å‹Seté›†åˆ

å…³æ³¨å…³ç³»å­˜å‚¨ï¼š  
user:following:ç”¨æˆ·ID -> å…³æ³¨çš„äººSeté›†åˆ
user:followers:ç”¨æˆ·ID -> ç²‰ä¸Seté›†åˆ

ç¤ºä¾‹ï¼š
user:friends:1001 -> {"1002", "1003", "1004"}
user:following:1001 -> {"1002", "1005", "1006"} 
user:followers:1001 -> {"1003", "1007", "1008"}
```

### 4.3 å…±åŒå¥½å‹è®¡ç®—


**ğŸ¤ å…±åŒå¥½å‹ç®—æ³•**
```python
def get_mutual_friends(user1_id, user2_id):
    """è®¡ç®—ä¸¤ä¸ªç”¨æˆ·çš„å…±åŒå¥½å‹"""
    key1 = f"user:friends:{user1_id}"
    key2 = f"user:friends:{user2_id}"
    
    # Setäº¤é›†è¿ç®— - Redisä¸€æ­¥å®Œæˆ
    mutual_friends = redis_client.sinter(key1, key2)
    return list(mutual_friends)

def get_mutual_friends_count(user1_id, user2_id):
    """å¿«é€Ÿè·å–å…±åŒå¥½å‹æ•°é‡"""
    key1 = f"user:friends:{user1_id}"
    key2 = f"user:friends:{user2_id}"
    
    # åªè®¡ç®—æ•°é‡ï¼Œä¸è¿”å›å…·ä½“å¥½å‹
    return redis_client.sinterstore("temp", key1, key2)

# ä½¿ç”¨ç¤ºä¾‹
mutual = get_mutual_friends("1001", "1002")
print(f"å…±åŒå¥½å‹: {mutual}")  # ['1003', '1004']
```

### 4.4 å¥½å‹æ¨èç®—æ³•


**ğŸ’« åŸºäºå…±åŒå¥½å‹çš„æ¨è**
```python
def recommend_friends(user_id, limit=10):
    """åŸºäºå…±åŒå¥½å‹æ¨èæ–°æœ‹å‹"""
    user_friends_key = f"user:friends:{user_id}"
    user_friends = redis_client.smembers(user_friends_key)
    
    # ç»Ÿè®¡æ¯ä¸ªæ½œåœ¨å¥½å‹çš„å…±åŒå¥½å‹æ•°é‡
    candidate_scores = {}
    
    for friend_id in user_friends:
        friend_key = f"user:friends:{friend_id}"
        # è·å–æœ‹å‹çš„æœ‹å‹
        friends_of_friend = redis_client.smembers(friend_key)
        
        for candidate in friends_of_friend:
            # æ’é™¤è‡ªå·±å’Œå·²ç»æ˜¯å¥½å‹çš„äºº
            if candidate != user_id and candidate not in user_friends:
                candidate_scores[candidate] = candidate_scores.get(candidate, 0) + 1
    
    # æŒ‰å…±åŒå¥½å‹æ•°é‡æ’åºï¼Œè¿”å›å‰Nä¸ª
    recommendations = sorted(candidate_scores.items(), 
                           key=lambda x: x[1], reverse=True)
    return recommendations[:limit]

# ä½¿ç”¨ç¤ºä¾‹
recommendations = recommend_friends("1001", 5)
print("æ¨èå¥½å‹:", recommendations)  # [('1008', 3), ('1009', 2), ...]
```

### 4.5 å…³æ³¨å…³ç³»ç®¡ç†


**ğŸ“± ç±»ä¼¼å¾®åšçš„å…³æ³¨ç³»ç»Ÿ**
```python
class SocialSystem:
    def follow_user(self, follower_id, following_id):
        """ç”¨æˆ·å…³æ³¨æ“ä½œ"""
        # æ·»åŠ åˆ°å…³æ³¨åˆ—è¡¨
        following_key = f"user:following:{follower_id}"
        self.redis.sadd(following_key, following_id)
        
        # æ·»åŠ åˆ°ç²‰ä¸åˆ—è¡¨  
        followers_key = f"user:followers:{following_id}"
        self.redis.sadd(followers_key, follower_id)
    
    def unfollow_user(self, follower_id, following_id):
        """å–æ¶ˆå…³æ³¨"""
        following_key = f"user:following:{follower_id}"
        self.redis.srem(following_key, following_id)
        
        followers_key = f"user:followers:{following_id}"
        self.redis.srem(followers_key, follower_id)
    
    def get_mutual_following(self, user1_id, user2_id):
        """è·å–å…±åŒå…³æ³¨çš„äºº"""
        key1 = f"user:following:{user1_id}"
        key2 = f"user:following:{user2_id}" 
        return self.redis.sinter(key1, key2)
```

---

## 5. ğŸ² æŠ½å¥–ç³»ç»Ÿè®¾è®¡


### 5.1 æŠ½å¥–ç³»ç»Ÿæ˜¯ä»€ä¹ˆï¼Ÿ


**ğŸ’¡ ç”Ÿæ´»åœºæ™¯ç†è§£**ï¼šå°±åƒ**æ‘‡å·æŠ½å¥–**
```
ç°å®ä¸­çš„æŠ½å¥–ï¼š
ğŸ« æŠ½å¥–ç®±ï¼šé‡Œé¢æ”¾ç€æ‰€æœ‰å‚ä¸è€…çš„å·ç 
ğŸ¯ éšæœºæŠ½å–ï¼šæ¯æ¬¡éšæœºæ‹¿å‡ºä¸€ä¸ªå·ç 
âœ… é˜²é‡å¤ï¼šæŠ½è¿‡çš„å·ç ä¸èƒ½å†æŠ½
ğŸ“¦ å¥–å“ç®¡ç†ï¼šä¸åŒå¥–å“æœ‰æ•°é‡é™åˆ¶

Redis Setçš„ä¼˜åŠ¿ï¼š
- è‡ªåŠ¨å»é‡ï¼ˆä¸€ä¸ªç”¨æˆ·åªèƒ½æŠ½ä¸€æ¬¡ï¼‰
- éšæœºè·å–ï¼ˆSRANDMEMBERå‘½ä»¤ï¼‰
- å¿«é€Ÿåˆ é™¤ï¼ˆæŠ½ä¸­åä»æ± ä¸­ç§»é™¤ï¼‰
```

### 5.2 æŠ½å¥–æ± ç®¡ç†


**ğŸ² æŠ½å¥–æ± è®¾è®¡**
```
æŠ½å¥–æ´»åŠ¨æ•°æ®ç»“æ„ï¼š

lottery:pool:æ´»åŠ¨ID -> å‚ä¸ç”¨æˆ·é›†åˆ
lottery:winners:æ´»åŠ¨ID -> ä¸­å¥–ç”¨æˆ·é›†åˆ  
lottery:prizes:æ´»åŠ¨ID -> å¥–å“ä¿¡æ¯Hash

ç¤ºä¾‹æ•°æ®ï¼š
lottery:pool:spring2024 -> {"user1001", "user1002", "user1003", ...}
lottery:winners:spring2024 -> {"user1001", "user1005"}
```

**ğŸ“‹ æŠ½å¥–æ± ç®¡ç†ä»£ç **
```python
class LotterySystem:
    def __init__(self, redis_client):
        self.redis = redis_client
    
    def join_lottery(self, lottery_id, user_id):
        """ç”¨æˆ·å‚ä¸æŠ½å¥–"""
        pool_key = f"lottery:pool:{lottery_id}"
        winners_key = f"lottery:winners:{lottery_id}"
        
        # æ£€æŸ¥æ˜¯å¦å·²ç»ä¸­å¥–
        if self.redis.sismember(winners_key, user_id):
            return {"success": False, "message": "æ‚¨å·²ç»ä¸­å¥–ï¼Œä¸èƒ½é‡å¤å‚ä¸"}
            
        # åŠ å…¥æŠ½å¥–æ± 
        added = self.redis.sadd(pool_key, user_id)
        if added:
            return {"success": True, "message": "å‚ä¸æŠ½å¥–æˆåŠŸ"}
        else:
            return {"success": False, "message": "æ‚¨å·²ç»å‚ä¸è¿‡æ­¤æ¬¡æŠ½å¥–"}
    
    def get_participants_count(self, lottery_id):
        """è·å–å‚ä¸äººæ•°"""
        pool_key = f"lottery:pool:{lottery_id}"
        return self.redis.scard(pool_key)
```

### 5.3 éšæœºæŠ½å–ç®—æ³•


**ğŸ¯ æŠ½å¥–æ ¸å¿ƒç®—æ³•**
```python
def draw_winners(self, lottery_id, count=1, remove_from_pool=True):
    """
    éšæœºæŠ½å–ä¸­å¥–è€…
    count: æŠ½å–äººæ•°
    remove_from_pool: æ˜¯å¦ä»æŠ½å¥–æ± ä¸­ç§»é™¤ï¼ˆé˜²æ­¢é‡å¤ä¸­å¥–ï¼‰
    """
    pool_key = f"lottery:pool:{lottery_id}"
    winners_key = f"lottery:winners:{lottery_id}"
    
    if remove_from_pool:
        # æ–¹å¼1ï¼šæŠ½ä¸­åä»æ± ä¸­ç§»é™¤ï¼ˆä¸èƒ½é‡å¤ä¸­å¥–ï¼‰
        winners = []
        for _ in range(count):
            winner = self.redis.spop(pool_key)  # éšæœºå–å‡ºå¹¶ç§»é™¤
            if winner:
                winners.append(winner)
                # è®°å½•ä¸­å¥–è€…
                self.redis.sadd(winners_key, winner)
            else:
                break  # æ± å­ç©ºäº†
        return winners
    else:
        # æ–¹å¼2ï¼šä¸ç§»é™¤ï¼Œå¯ä»¥é‡å¤ä¸­å¥–
        return self.redis.srandmember(pool_key, count)

# å®é™…ä½¿ç”¨
lottery = LotterySystem(redis_client)

# æŠ½å–3åä¸­å¥–è€…
winners = lottery.draw_winners("spring2024", 3, remove_from_pool=True)
print(f"ä¸­å¥–ç”¨æˆ·: {winners}")
```

### 5.4 ä¸­å¥–è®°å½•é˜²é‡


**ğŸ”’ é˜²é‡å¤ä¸­å¥–æœºåˆ¶**
```python
def multi_level_lottery(self, lottery_id):
    """å¤šè½®æŠ½å¥–ï¼Œé˜²æ­¢é‡å¤ä¸­å¥–"""
    
    # ç¬¬ä¸€è½®ï¼šæŠ½å–ä¸€ç­‰å¥–
    first_prize_winners = self.draw_winners(f"{lottery_id}:first", 1)
    
    # ç¬¬äºŒè½®ï¼šä»å‰©ä½™äººä¸­æŠ½å–äºŒç­‰å¥–
    second_prize_winners = self.draw_winners(f"{lottery_id}:second", 3)
    
    # ç¬¬ä¸‰è½®ï¼šä»å‰©ä½™äººä¸­æŠ½å–ä¸‰ç­‰å¥–  
    third_prize_winners = self.draw_winners(f"{lottery_id}:third", 10)
    
    return {
        "first_prize": first_prize_winners,
        "second_prize": second_prize_winners, 
        "third_prize": third_prize_winners
    }

def check_user_prize_history(self, user_id, lottery_id):
    """æŸ¥è¯¢ç”¨æˆ·ä¸­å¥–å†å²"""
    prizes = ["first", "second", "third"] 
    user_prizes = []
    
    for prize in prizes:
        winners_key = f"lottery:winners:{lottery_id}:{prize}"
        if self.redis.sismember(winners_key, user_id):
            user_prizes.append(prize)
            
    return user_prizes
```

### 5.5 å¥–å“åº“å­˜æ§åˆ¶


**ğŸ“¦ åº“å­˜ç®¡ç†**
```python
def draw_with_prize_limit(self, lottery_id, prize_type, max_winners):
    """å¸¦åº“å­˜é™åˆ¶çš„æŠ½å¥–"""
    winners_key = f"lottery:winners:{lottery_id}:{prize_type}"
    current_winners = self.redis.scard(winners_key)
    
    # æ£€æŸ¥åº“å­˜
    if current_winners >= max_winners:
        return {"success": False, "message": f"{prize_type}å¥–å“å·²æŠ½å®Œ"}
    
    # è®¡ç®—å¯æŠ½å¥–æ•°é‡
    remaining = max_winners - current_winners
    draw_count = min(remaining, 1)  # è¿™æ¬¡æŠ½å–æ•°é‡
    
    # æ‰§è¡ŒæŠ½å¥–
    pool_key = f"lottery:pool:{lottery_id}"
    winner = self.redis.spop(pool_key)
    
    if winner:
        self.redis.sadd(winners_key, winner)
        return {
            "success": True, 
            "winner": winner,
            "remaining_prizes": remaining - 1
        }
    else:
        return {"success": False, "message": "æŠ½å¥–æ± å·²ç©º"}
```

---

## 6. ğŸ¢ å®æˆ˜æ¡ˆä¾‹é›†é”¦


### 6.1 ç”µå•†ç”¨æˆ·æ ‡ç­¾ç³»ç»Ÿ


**ğŸ›ï¸ ç”µå•†æ ‡ç­¾åº”ç”¨**
```
æ ‡ç­¾åˆ†ç±»ç³»ç»Ÿï¼š
è´­ç‰©è¡Œä¸º: {"ç»å¸¸è´­ä¹°", "ä»·æ ¼æ•æ„Ÿ", "å“ç‰Œå¿ è¯š"}  
å…´è¶£åå¥½: {"æ•°ç äº§å“", "æœè£…é…é¥°", "æ¯å©´ç”¨å“"}
ç”¨æˆ·ç”»åƒ: {"å¹´è½»ç™½é¢†", "å®¶åº­ä¸»å¦‡", "å­¦ç”Ÿç¾¤ä½“"}

åº”ç”¨åœºæ™¯ï¼š
1. ä¸ªæ€§åŒ–æ¨èï¼šæ ¹æ®æ ‡ç­¾æ¨é€å•†å“
2. è¥é”€æ´»åŠ¨ï¼šå‘ç‰¹å®šæ ‡ç­¾ç”¨æˆ·å‘é€ä¼˜æƒ åˆ¸
3. ç”¨æˆ·åˆ†ç¾¤ï¼šæŒ‰æ ‡ç­¾ç»Ÿè®¡ç”¨æˆ·è¡Œä¸º
```

**ğŸ’» å®ç°æ¡ˆä¾‹**
```python
class EcommerceTagSystem:
    def tag_user_by_behavior(self, user_id, order_data):
        """æ ¹æ®è´­ä¹°è¡Œä¸ºæ‰“æ ‡ç­¾"""
        
        # ä»·æ ¼æ•æ„Ÿæ€§åˆ†æ
        avg_discount = sum(order['discount_rate'] for order in order_data) / len(order_data)
        if avg_discount > 0.3:  # å¹³å‡æŠ˜æ‰£è¶…è¿‡30%
            self.add_tag(user_id, 'behavior', 'ä»·æ ¼æ•æ„Ÿ')
        
        # è´­ä¹°é¢‘æ¬¡åˆ†æ
        if len(order_data) > 10:  # è´­ä¹°æ¬¡æ•°è¶…è¿‡10æ¬¡
            self.add_tag(user_id, 'behavior', 'æ´»è·ƒä¹°å®¶')
            
        # å•†å“ç±»åˆ«åå¥½
        categories = [order['category'] for order in order_data]
        most_common = max(set(categories), key=categories.count)
        self.add_tag(user_id, 'preference', most_common)

# è¥é”€åœºæ™¯åº”ç”¨
def send_promotion_to_tagged_users(tag_category, tag_name, promotion_info):
    """å‘ç‰¹å®šæ ‡ç­¾ç”¨æˆ·å‘é€è¥é”€ä¿¡æ¯"""
    # æ‰¾åˆ°æ‹¥æœ‰ç‰¹å®šæ ‡ç­¾çš„ç”¨æˆ·
    tagged_users = find_users_with_tag(tag_category, tag_name)
    
    for user_id in tagged_users:
        send_promotion_message(user_id, promotion_info)
    
    return f"å·²å‘{len(tagged_users)}ä¸ªç”¨æˆ·å‘é€è¥é”€ä¿¡æ¯"
```

### 6.2 ç¤¾äº¤å¥½å‹å…³ç³»ç³»ç»Ÿ


**ğŸ‘¥ ç¤¾äº¤å¹³å°åº”ç”¨**
```python
class SocialPlatform:
    def recommend_friends_advanced(self, user_id):
        """é«˜çº§å¥½å‹æ¨èç®—æ³•"""
        
        recommendations = {}
        
        # 1. åŸºäºå…±åŒå¥½å‹æ¨è
        mutual_scores = self.get_mutual_friend_scores(user_id)
        
        # 2. åŸºäºå…±åŒå…´è¶£æ¨è  
        interest_scores = self.get_common_interest_scores(user_id)
        
        # 3. ç»¼åˆæ‰“åˆ†
        for candidate in set(list(mutual_scores.keys()) + list(interest_scores.keys())):
            score = mutual_scores.get(candidate, 0) * 0.6 + interest_scores.get(candidate, 0) * 0.4
            recommendations[candidate] = score
            
        return sorted(recommendations.items(), key=lambda x: x[1], reverse=True)
    
    def analyze_social_circle(self, user_id):
        """åˆ†æç”¨æˆ·ç¤¾äº¤åœˆ"""
        friends_key = f"user:friends:{user_id}"
        friends = self.redis.smembers(friends_key)
        
        # ç»Ÿè®¡æœ‹å‹é—´çš„è¿æ¥åº¦
        connections = 0
        total_possible = len(friends) * (len(friends) - 1) / 2
        
        for friend1 in friends:
            for friend2 in friends:
                if friend1 < friend2:  # é¿å…é‡å¤è®¡ç®—
                    if self.are_friends(friend1, friend2):
                        connections += 1
                        
        # è®¡ç®—ç¤¾äº¤åœˆå¯†åº¦
        density = connections / total_possible if total_possible > 0 else 0
        
        return {
            "friends_count": len(friends),
            "connections": connections, 
            "density": density,
            "circle_type": "ç´§å¯†" if density > 0.7 else "æ¾æ•£"
        }
```

### 6.3 æŠ½å¥–æ´»åŠ¨ç³»ç»Ÿ


**ğŸ‰ æŠ½å¥–æ´»åŠ¨å®æˆ˜**
```python
class LotteryActivity:
    def create_activity(self, activity_id, prizes_config):
        """åˆ›å»ºæŠ½å¥–æ´»åŠ¨"""
        
        # è®¾ç½®å¥–å“é…ç½®
        prizes_key = f"lottery:prizes:{activity_id}"
        for prize_name, config in prizes_config.items():
            self.redis.hset(prizes_key, mapping={
                f"{prize_name}:total": config['total'],
                f"{prize_name}:remaining": config['total'],
                f"{prize_name}:description": config['description']
            })
        
        # åˆå§‹åŒ–å‚ä¸æ± 
        pool_key = f"lottery:pool:{activity_id}"
        self.redis.delete(pool_key)  # æ¸…ç©ºæ—§æ•°æ®
        
        return f"æŠ½å¥–æ´»åŠ¨ {activity_id} åˆ›å»ºæˆåŠŸ"
    
    def instant_lottery(self, activity_id, user_id):
        """å³æ—¶æŠ½å¥–ï¼ˆå¦‚åˆ®åˆ®å¡ï¼‰"""
        
        # æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²å‚ä¸
        if self.has_participated(activity_id, user_id):
            return {"success": False, "message": "æ‚¨å·²ç»å‚ä¸è¿‡æ­¤æ¬¡æŠ½å¥–"}
        
        # è®°å½•å‚ä¸
        pool_key = f"lottery:pool:{activity_id}"
        self.redis.sadd(pool_key, user_id)
        
        # éšæœºå†³å®šæ˜¯å¦ä¸­å¥–
        import random
        win_probability = 0.1  # 10%ä¸­å¥–ç‡
        
        if random.random() < win_probability:
            # ä¸­å¥–é€»è¾‘
            prize = self.allocate_prize(activity_id, user_id)
            return {"success": True, "result": "ä¸­å¥–", "prize": prize}
        else:
            return {"success": True, "result": "æœªä¸­å¥–", "message": "è°¢è°¢å‚ä¸"}
```

### 6.4 æƒé™æ§åˆ¶ä¸­å¿ƒ


**ğŸ” ä¼ä¸šçº§æƒé™ç®¡ç†**
```python
class EnterprisePermissionCenter:
    def setup_department_permissions(self, department, base_permissions):
        """è®¾ç½®éƒ¨é—¨åŸºç¡€æƒé™"""
        dept_role = f"department:{department}"
        role_key = f"role:permissions:{dept_role}"
        
        # æ¸…ç©ºæ—§æƒé™
        self.redis.delete(role_key)
        # è®¾ç½®æ–°æƒé™
        if base_permissions:
            self.redis.sadd(role_key, *base_permissions)
    
    def grant_temporary_permission(self, user_id, permission, expire_hours=24):
        """æˆäºˆä¸´æ—¶æƒé™"""
        temp_key = f"user:temp_permissions:{user_id}"
        self.redis.sadd(temp_key, permission)
        # è®¾ç½®è¿‡æœŸæ—¶é—´
        self.redis.expire(temp_key, expire_hours * 3600)
    
    def check_permission_with_temp(self, user_id, permission):
        """æ£€æŸ¥æƒé™ï¼ˆåŒ…å«ä¸´æ—¶æƒé™ï¼‰"""
        
        # æ£€æŸ¥å¸¸è§„æƒé™
        if self.check_permission(user_id, permission):
            return True
            
        # æ£€æŸ¥ä¸´æ—¶æƒé™
        temp_key = f"user:temp_permissions:{user_id}"
        return self.redis.sismember(temp_key, permission)

# ä½¿ç”¨åœºæ™¯
perm_center = EnterprisePermissionCenter(redis_client)

# è®¾ç½®å¼€å‘éƒ¨é—¨æƒé™
perm_center.setup_department_permissions("å¼€å‘éƒ¨", [
    "ä»£ç æäº¤", "æµ‹è¯•ç¯å¢ƒéƒ¨ç½²", "æŸ¥çœ‹æ—¥å¿—"
])

# ä¸´æ—¶æˆæƒç”Ÿäº§ç¯å¢ƒæƒé™
perm_center.grant_temporary_permission("dev001", "ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²", 2)  # 2å°æ—¶ä¸´æ—¶æƒé™
```

### 6.5 æ•°æ®å»é‡æœåŠ¡


**ğŸ”„ é€šç”¨å»é‡è§£å†³æ–¹æ¡ˆ**
```python
class DeduplicationService:
    def __init__(self, redis_client):
        self.redis = redis_client
    
    def add_unique_item(self, category, item_id, item_data=None):
        """æ·»åŠ å”¯ä¸€é¡¹ç›®"""
        dedup_key = f"dedup:{category}"
        
        # æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
        if self.redis.sismember(dedup_key, item_id):
            return {"success": False, "message": "é¡¹ç›®å·²å­˜åœ¨", "duplicate": True}
        
        # æ·»åŠ åˆ°å»é‡é›†åˆ
        self.redis.sadd(dedup_key, item_id)
        
        # å¦‚æœæœ‰æ•°æ®ï¼Œå­˜å‚¨åˆ°è¯¦ç»†ä¿¡æ¯ä¸­
        if item_data:
            detail_key = f"detail:{category}:{item_id}"
            self.redis.hset(detail_key, mapping=item_data)
        
        return {"success": True, "message": "æ·»åŠ æˆåŠŸ", "duplicate": False}
    
    def batch_deduplicate(self, category, items):
        """æ‰¹é‡å»é‡"""
        dedup_key = f"dedup:{category}"
        existing_items = self.redis.smembers(dedup_key)
        
        # è¿‡æ»¤å‡ºä¸å­˜åœ¨çš„é¡¹ç›®
        new_items = [item for item in items if item not in existing_items]
        
        # æ‰¹é‡æ·»åŠ æ–°é¡¹ç›®
        if new_items:
            self.redis.sadd(dedup_key, *new_items)
        
        return {
            "total_input": len(items),
            "duplicates": len(items) - len(new_items),
            "new_items": len(new_items),
            "new_item_list": new_items
        }

# åº”ç”¨åœºæ™¯ç¤ºä¾‹
dedup_service = DeduplicationService(redis_client)

# ç½‘ç»œçˆ¬è™«URLå»é‡
urls = ["http://example1.com", "http://example2.com", "http://example1.com"]
result = dedup_service.batch_deduplicate("crawler_urls", urls)
print(f"å»é‡ç»“æœ: {result}")  # ä¼šæ˜¾ç¤ºæœ‰1ä¸ªé‡å¤URL

# ç”¨æˆ·æ³¨å†Œé‚®ç®±å»é‡
email_check = dedup_service.add_unique_item("user_emails", "user@example.com", {
    "register_time": "2024-01-20",
    "status": "active"
})
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 Seté›†åˆæ ¸å¿ƒä¼˜åŠ¿å›é¡¾


**âš¡ ä¸ºä»€ä¹ˆé€‰æ‹©Setï¼Ÿ**
- **å¤©ç„¶å»é‡**ï¼šä¸ç”¨æ‹…å¿ƒé‡å¤æ•°æ®é—®é¢˜
- **å¿«é€ŸæŸ¥æ‰¾**ï¼šæ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨ï¼Œæ—¶é—´å¤æ‚åº¦O(1)
- **é›†åˆè¿ç®—**ï¼šäº¤é›†ã€å¹¶é›†ã€å·®é›†ï¼Œä¸€ä¸ªå‘½ä»¤æå®š
- **å†…å­˜é«˜æ•ˆ**ï¼šåªå­˜å‚¨å”¯ä¸€å€¼ï¼ŒèŠ‚çœç©ºé—´

### 7.2 äº”å¤§åº”ç”¨åœºæ™¯è®°å¿†è¦ç‚¹


| åº”ç”¨åœºæ™¯ | **æ ¸å¿ƒç”¨æ³•** | **å…¸å‹å‘½ä»¤** | **ä¸šåŠ¡ä»·å€¼** |
|---------|------------|-------------|-------------|
| ğŸ·ï¸ **ç”¨æˆ·æ ‡ç­¾** | `å­˜å‚¨ç”¨æˆ·ç‰¹å¾æ ‡ç­¾` | `SADD` `SMEMBERS` | `ä¸ªæ€§åŒ–æ¨èã€ç”¨æˆ·ç”»åƒ` |
| ğŸ” **æƒé™ç®¡ç†** | `å­˜å‚¨ç”¨æˆ·/è§’è‰²æƒé™` | `SISMEMBER` `SINTER` | `è®¿é—®æ§åˆ¶ã€å®‰å…¨ç®¡ç†` |
| ğŸ‘¥ **ç¤¾äº¤åŠŸèƒ½** | `å­˜å‚¨å¥½å‹å…³ç³»` | `SINTER` `SUNION` | `å¥½å‹æ¨èã€ç¤¾äº¤åˆ†æ` |
| ğŸ² **æŠ½å¥–ç³»ç»Ÿ** | `å­˜å‚¨å‚ä¸è€…æ± å­` | `SPOP` `SRANDMEMBER` | `æ´»åŠ¨è¿è¥ã€ç”¨æˆ·æ¿€åŠ±` |
| ğŸ”„ **æ•°æ®å»é‡** | `ç¡®ä¿æ•°æ®å”¯ä¸€æ€§` | `SADD` `SISMEMBER` | `æ•°æ®è´¨é‡ã€é¿å…é‡å¤` |

### 7.3 å…³é”®æŠ€æœ¯è¦ç‚¹


**ğŸ”§ å¸¸ç”¨æ“ä½œæ¨¡å¼**
```bash
# æ¨¡å¼1ï¼šæˆå‘˜æ£€æŸ¥
SISMEMBER key member  # O(1)æ—¶é—´å¤æ‚åº¦

# æ¨¡å¼2ï¼šé›†åˆè¿ç®—
SINTER key1 key2     # äº¤é›†ï¼šå…±åŒå¥½å‹ã€å…±åŒæ ‡ç­¾
SUNION key1 key2     # å¹¶é›†ï¼šæ‰€æœ‰ç›¸å…³ç”¨æˆ·
SDIFF key1 key2      # å·®é›†ï¼šæ‰¾å‡ºä¸åŒ

# æ¨¡å¼3ï¼šéšæœºæ“ä½œ
SRANDMEMBER key count # éšæœºè·å–ï¼Œä¸åˆ é™¤
SPOP key count       # éšæœºè·å–å¹¶åˆ é™¤
```

**ğŸ’¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®**
- **åˆç†å‘½å**ï¼šä½¿ç”¨æ¸…æ™°çš„keyå‘½åè§„èŒƒ
- **æ‰¹é‡æ“ä½œ**ï¼šä½¿ç”¨`SADD key member1 member2...`
- **é¿å…å¤§é›†åˆ**ï¼šå•ä¸ªSetä¸è¦è¶…è¿‡100ä¸‡å…ƒç´ 
- **è®¾ç½®è¿‡æœŸ**ï¼šä¸´æ—¶æ•°æ®è®°å¾—è®¾ç½®TTL

### 7.4 æœ€ä½³å®è·µåŸåˆ™


**âœ… æ¨èåšæ³•**
- ç”¨Setåšå»é‡ï¼šå¤©ç„¶ç‰¹æ€§ï¼Œæ€§èƒ½æœ€ä¼˜
- ç”¨Setåšæ ‡ç­¾ï¼šçµæ´»æ‰©å±•ï¼Œå¿«é€ŸæŸ¥è¯¢
- ç”¨Setåšå…³ç³»ï¼šé›†åˆè¿ç®—ï¼ŒåŠŸèƒ½å¼ºå¤§
- åˆç†è®¾è®¡keyï¼šåˆ†ç±»æ¸…æ™°ï¼Œä¾¿äºç®¡ç†

**âŒ é¿å…ä½¿ç”¨**
- ä¸è¦ç”¨Setå­˜å‚¨å¤§é‡æ•°æ®ï¼šå½±å“æ€§èƒ½
- ä¸è¦é¢‘ç¹åšå…¨é‡æ“ä½œï¼šå¦‚`SMEMBERS`å¤§é›†åˆ
- ä¸è¦å¿½ç•¥è¿‡æœŸæ—¶é—´ï¼šé¿å…å†…å­˜æ³„æ¼
- ä¸è¦è¿‡åº¦æ‹†åˆ†ï¼šå¤ªå¤šå°Setåè€Œä½æ•ˆ

**ğŸ¯ æ ¸å¿ƒè®°å¿†å£è¯€**
```
Seté›†åˆå»é‡å¿«ï¼Œæ ‡ç­¾æƒé™ç¤¾äº¤å¦™
æŠ½å¥–å»é‡æ ·æ ·è¡Œï¼Œäº¤å¹¶å·®é›†åŠŸèƒ½å¼º  
SADDæ·»åŠ SREMåˆ ï¼ŒSINTERäº¤é›†SUNIONå¹¶
SPOPéšæœºåˆåˆ é™¤ï¼ŒSISMEMBERæ£€æŸ¥å‡†
```

**ğŸš€ åº”ç”¨é€‰æ‹©æŒ‡å—**
- **éœ€è¦å»é‡** â†’ é¦–é€‰Set
- **éœ€è¦å¿«é€ŸæŸ¥æ‰¾** â†’ é¦–é€‰Set  
- **éœ€è¦é›†åˆè¿ç®—** â†’ åªèƒ½æ˜¯Set
- **éœ€è¦éšæœºè·å–** â†’ Setå¾ˆåˆé€‚
- **éœ€è¦æ’åº** â†’ è€ƒè™‘Sorted Set
- **éœ€è¦å­˜å‚¨å€¼** â†’ è€ƒè™‘Hash

é€šè¿‡è¿™äº›å®æˆ˜æ¡ˆä¾‹ï¼Œä½ åº”è¯¥èƒ½å¤Ÿçµæ´»è¿ç”¨Redis Setæ¥è§£å†³å„ç§ä¸šåŠ¡åœºæ™¯ä¸­çš„é—®é¢˜ã€‚è®°ä½ï¼š**Setçš„æ ¸å¿ƒä»·å€¼åœ¨äºå»é‡å’Œé›†åˆè¿ç®—ï¼Œé€‰å¯¹åœºæ™¯ï¼Œäº‹åŠåŠŸå€ï¼**