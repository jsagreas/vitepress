---
title: 4ã€Rediså¸¸ç”¨è°ƒè¯•å‘½ä»¤è¯¦è§£
---
## ğŸ“š ç›®å½•

1. [è°ƒè¯•å‘½ä»¤æ¦‚è¿°](#1-è°ƒè¯•å‘½ä»¤æ¦‚è¿°)
2. [ç›‘æ§ç±»å‘½ä»¤è¯¦è§£](#2-ç›‘æ§ç±»å‘½ä»¤è¯¦è§£)
3. [é…ç½®ç®¡ç†å‘½ä»¤](#3-é…ç½®ç®¡ç†å‘½ä»¤)
4. [æ—¥å¿—ç›¸å…³å‘½ä»¤](#4-æ—¥å¿—ç›¸å…³å‘½ä»¤)
5. [å®æˆ˜è°ƒè¯•æŠ€å·§](#5-å®æˆ˜è°ƒè¯•æŠ€å·§)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” è°ƒè¯•å‘½ä»¤æ¦‚è¿°


### 1.1 ä¸ºä»€ä¹ˆéœ€è¦è°ƒè¯•å‘½ä»¤


**ç°å®åœºæ™¯**ï¼šå°±åƒåŒ»ç”Ÿç»™ç—…äººä½“æ£€ï¼Œéœ€è¦å„ç§æ£€æŸ¥å·¥å…·æ¥äº†è§£èº«ä½“çŠ¶å†µï¼ŒRedisè°ƒè¯•å‘½ä»¤å°±æ˜¯ç»™Redis"ä½“æ£€"çš„å·¥å…·ã€‚

**ä¸»è¦ç”¨é€”**ï¼š
- **æ€§èƒ½ç›‘æ§**ï¼šRedisè¿è¡Œæ˜¯å¦æ­£å¸¸ï¼Œæ˜¯å¦æœ‰æ€§èƒ½ç“¶é¢ˆ
- **é—®é¢˜æ’æŸ¥**ï¼šå½“Rediså˜æ…¢æ—¶æ‰¾å‡ºåŸå› 
- **é…ç½®ä¼˜åŒ–**ï¼šè°ƒæ•´Redisè®¾ç½®æå‡æ€§èƒ½
- **å®¹é‡è§„åˆ’**ï¼šäº†è§£å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œè§„åˆ’æ‰©å®¹

### 1.2 è°ƒè¯•å‘½ä»¤åˆ†ç±»


```
ç›‘æ§è§‚å¯Ÿç±»ï¼š
â”œâ”€â”€ MONITOR    # å®æ—¶æŸ¥çœ‹æ‰§è¡Œçš„å‘½ä»¤
â”œâ”€â”€ INFO       # æŸ¥çœ‹Redisæ•´ä½“çŠ¶æ€
â”œâ”€â”€ MEMORY     # å†…å­˜ä½¿ç”¨åˆ†æ
â””â”€â”€ STATS      # ç»Ÿè®¡ä¿¡æ¯

é…ç½®ç®¡ç†ç±»ï¼š
â”œâ”€â”€ CONFIG GET # æŸ¥çœ‹é…ç½®é¡¹
â””â”€â”€ CONFIG SET # ä¿®æ”¹é…ç½®é¡¹

æ—¥å¿—åˆ†æç±»ï¼š
â”œâ”€â”€ SLOWLOG    # æ…¢æŸ¥è¯¢æ—¥å¿—
â””â”€â”€ æ—¥å¿—çº§åˆ«è®¾ç½® # æ§åˆ¶æ—¥å¿—è¾“å‡º
```

---

## 2. ğŸ“Š ç›‘æ§ç±»å‘½ä»¤è¯¦è§£


### 2.1 MONITORå‘½ä»¤ - å®æ—¶ç›‘æ§


**ä½œç”¨**ï¼šåƒç›‘æ§æ‘„åƒå¤´ä¸€æ ·ï¼Œå®æ—¶æŸ¥çœ‹Redisæ­£åœ¨æ‰§è¡Œä»€ä¹ˆå‘½ä»¤ã€‚

```bash
# å¼€å¯ç›‘æ§
redis-cli> MONITOR
OK
1692174829.463950 [0 127.0.0.1:52156] "SET" "user:1001" "å¼ ä¸‰"
1692174832.167834 [0 127.0.0.1:52156] "GET" "user:1001" 
1692174835.982741 [0 127.0.0.1:52157] "LPUSH" "messages" "hello"
```

**è¾“å‡ºæ ¼å¼è§£é‡Š**ï¼š
```
æ—¶é—´æˆ³.å¾®ç§’ [æ•°æ®åº“ç¼–å· å®¢æˆ·ç«¯IP:ç«¯å£] "å‘½ä»¤" "å‚æ•°1" "å‚æ•°2"
```

**âš ï¸ é‡è¦æé†’**ï¼š
```
ä½¿ç”¨åœºæ™¯ï¼š
âœ… å¼€å‘è°ƒè¯•æ—¶æŸ¥çœ‹æ‰§è¡Œçš„å‘½ä»¤
âœ… æ’æŸ¥é—®é¢˜æ—¶åˆ†æå‘½ä»¤æ‰§è¡Œæƒ…å†µ  
âœ… å­¦ä¹ æ—¶è§‚å¯ŸRediså‘½ä»¤æ•ˆæœ

æ³¨æ„äº‹é¡¹ï¼š
âŒ ç”Ÿäº§ç¯å¢ƒæ…ç”¨ï¼Œä¼šå½±å“æ€§èƒ½
âŒ ç›‘æ§ä¼šæ¶ˆè€—é¢å¤–CPUå’Œå†…å­˜
âŒ é«˜å¹¶å‘æ—¶è¾“å‡ºä¿¡æ¯è¿‡å¤šéš¾ä»¥åˆ†æ
```

### 2.2 INFOå‘½ä»¤ - çŠ¶æ€ä¿¡æ¯


**ä½œç”¨**ï¼šè·å–Redisçš„"ä½“æ£€æŠ¥å‘Š"ï¼ŒåŒ…å«è¿è¡ŒçŠ¶æ€ã€å†…å­˜ä½¿ç”¨ã€è¿æ¥æ•°ç­‰å…³é”®ä¿¡æ¯ã€‚

```bash
# æŸ¥çœ‹æ‰€æœ‰ä¿¡æ¯
redis-cli> INFO

# æŸ¥çœ‹ç‰¹å®šåˆ†ç±»
redis-cli> INFO memory      # å†…å­˜ç›¸å…³ä¿¡æ¯
redis-cli> INFO stats       # ç»Ÿè®¡ä¿¡æ¯  
redis-cli> INFO replication # ä¸»ä»å¤åˆ¶ä¿¡æ¯
redis-cli> INFO cpu         # CPUä½¿ç”¨ä¿¡æ¯
```

**é‡è¦ä¿¡æ¯è§£è¯»**ï¼š
```bash
# æœåŠ¡å™¨åŸºæœ¬ä¿¡æ¯
redis_version:7.0.0          # Redisç‰ˆæœ¬
os:Linux 5.4.0              # æ“ä½œç³»ç»Ÿ
process_id:12345             # è¿›ç¨‹ID
uptime_in_seconds:86400      # è¿è¡Œæ—¶é—´(ç§’)

# å†…å­˜ä½¿ç”¨æƒ…å†µ
used_memory:1048576          # å·²ç”¨å†…å­˜(å­—èŠ‚)
used_memory_human:1.00M      # å·²ç”¨å†…å­˜(äººç±»å¯è¯»)
maxmemory:2147483648         # æœ€å¤§å†…å­˜é™åˆ¶
maxmemory_human:2.00G        # æœ€å¤§å†…å­˜(äººç±»å¯è¯»)

# å®¢æˆ·ç«¯è¿æ¥
connected_clients:5          # å½“å‰è¿æ¥æ•°
blocked_clients:2            # é˜»å¡çš„å®¢æˆ·ç«¯æ•°

# å‘½ä»¤ç»Ÿè®¡
total_commands_processed:1000 # æ€»æ‰§è¡Œå‘½ä»¤æ•°
instantaneous_ops_per_sec:50  # å½“å‰æ¯ç§’æ“ä½œæ•°
```

**ğŸ“ˆ å…³é”®æŒ‡æ ‡ç›‘æ§**ï¼š
| æŒ‡æ ‡åˆ†ç±» | **å…³é”®å­—æ®µ** | **æ­£å¸¸èŒƒå›´** | **å¼‚å¸¸å‘Šè­¦** |
|---------|------------|-------------|-------------|
| **å†…å­˜ä½¿ç”¨** | `used_memory_rss` | `< maxmemory 80%` | `è¶…è¿‡90%éœ€æ‰©å®¹` |
| **è¿æ¥æ•°** | `connected_clients` | `< maxclients 80%` | `æ¥è¿‘ä¸Šé™éœ€ä¼˜åŒ–` |
| **å‘½ä»¤å¤„ç†** | `rejected_connections` | `= 0` | `> 0è¯´æ˜è¿æ¥æ»¡äº†` |
| **æŒä¹…åŒ–** | `rdb_last_save_time` | `< 1å°æ—¶` | `å¤ªä¹…æœªä¿å­˜æœ‰é£é™©` |

### 2.3 MEMORYå‘½ä»¤ - å†…å­˜åˆ†æ


**ä½œç”¨**ï¼šæ·±å…¥åˆ†æRediså†…å­˜ä½¿ç”¨æƒ…å†µï¼Œæ‰¾å‡ºå†…å­˜å¤§æˆ·ã€‚

```bash
# æŸ¥çœ‹å†…å­˜ä½¿ç”¨ç»Ÿè®¡
redis-cli> MEMORY STATS
1) "peak.allocated"        # å†å²æœ€é«˜å†…å­˜ä½¿ç”¨
2) (integer) 2097152
3) "total.allocated"       # å½“å‰åˆ†é…çš„æ€»å†…å­˜
4) (integer) 1048576
5) "startup.allocated"     # å¯åŠ¨æ—¶åˆ†é…çš„å†…å­˜
6) (integer) 524288

# åˆ†æç‰¹å®škeyçš„å†…å­˜ä½¿ç”¨
redis-cli> MEMORY USAGE user:profile:1001
(integer) 256              # è¯¥keyä½¿ç”¨256å­—èŠ‚

# æŸ¥çœ‹å†…å­˜ä½¿ç”¨è¯¦æƒ…
redis-cli> MEMORY DOCTOR
Redis is using more memory than expected. Here are some suggestions:
* Check for keys with high memory usage using MEMORY USAGE
* Consider using more memory-efficient data structures
```

**å†…å­˜ä½¿ç”¨åˆ†æå®ä¾‹**ï¼š
```bash
# æ‰¾å‡ºå†…å­˜ä½¿ç”¨æœ€å¤šçš„keyç±»å‹
redis-cli> MEMORY USAGE user:*    # ç”¨æˆ·ç›¸å…³key
redis-cli> MEMORY USAGE session:* # ä¼šè¯ç›¸å…³key  
redis-cli> MEMORY USAGE cache:*   # ç¼“å­˜ç›¸å…³key

# å†…å­˜ä¼˜åŒ–å»ºè®®
å¦‚æœå‘ç°æŸç±»keyå†…å­˜å ç”¨è¿‡é«˜ï¼š
1. æ£€æŸ¥æ•°æ®ç»“æ„æ˜¯å¦åˆç†
2. è€ƒè™‘è®¾ç½®è¿‡æœŸæ—¶é—´
3. å‹ç¼©æ•°æ®æˆ–æ”¹å˜å­˜å‚¨æ–¹å¼
```

---

## 3. âš™ï¸ é…ç½®ç®¡ç†å‘½ä»¤


### 3.1 CONFIG GET - æŸ¥çœ‹é…ç½®


**ä½œç”¨**ï¼šæŸ¥çœ‹Rediså½“å‰çš„é…ç½®å‚æ•°ï¼ŒåƒæŸ¥çœ‹æ±½è½¦çš„è®¾ç½®ä¸€æ ·ã€‚

```bash
# æŸ¥çœ‹æ‰€æœ‰é…ç½®
redis-cli> CONFIG GET *

# æŸ¥çœ‹ç‰¹å®šé…ç½®
redis-cli> CONFIG GET maxmemory
1) "maxmemory"
2) "2147483648"

# æŸ¥çœ‹å¤šä¸ªç›¸å…³é…ç½®
redis-cli> CONFIG GET max*
1) "maxclients"
2) "10000"  
3) "maxmemory"
4) "2147483648"
5) "maxmemory-policy"
6) "allkeys-lru"
```

**å¸¸ç”¨é…ç½®å‚æ•°**ï¼š
```bash
# å†…å­˜ç›¸å…³
maxmemory                    # æœ€å¤§å†…å­˜é™åˆ¶
maxmemory-policy            # å†…å­˜æ»¡æ—¶çš„æ·˜æ±°ç­–ç•¥

# è¿æ¥ç›¸å…³  
maxclients                  # æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°
tcp-keepalive              # TCPè¿æ¥ä¿æ´»æ—¶é—´

# æŒä¹…åŒ–ç›¸å…³
save                       # RDBä¿å­˜ç­–ç•¥
dbfilename                 # RDBæ–‡ä»¶å
dir                        # æ•°æ®æ–‡ä»¶ç›®å½•

# æ—¥å¿—ç›¸å…³
loglevel                   # æ—¥å¿—çº§åˆ«
logfile                    # æ—¥å¿—æ–‡ä»¶è·¯å¾„
```

### 3.2 CONFIG SET - ä¿®æ”¹é…ç½®


**ä½œç”¨**ï¼šåŠ¨æ€ä¿®æ”¹Redisé…ç½®ï¼Œä¸éœ€è¦é‡å¯æœåŠ¡ã€‚

```bash
# ä¿®æ”¹æœ€å¤§å†…å­˜é™åˆ¶ä¸º4GB
redis-cli> CONFIG SET maxmemory 4294967296
OK

# ä¿®æ”¹å†…å­˜æ·˜æ±°ç­–ç•¥
redis-cli> CONFIG SET maxmemory-policy allkeys-lfu
OK

# ä¿®æ”¹æ—¥å¿—çº§åˆ«
redis-cli> CONFIG SET loglevel warning
OK

# éªŒè¯ä¿®æ”¹æ˜¯å¦ç”Ÿæ•ˆ
redis-cli> CONFIG GET maxmemory
1) "maxmemory"  
2) "4294967296"
```

**âš ï¸ é…ç½®ä¿®æ”¹æ³¨æ„äº‹é¡¹**ï¼š

> **ä¸´æ—¶æ€§å˜æ›´**ï¼šCONFIG SETçš„ä¿®æ”¹åªå¯¹å½“å‰è¿è¡Œç”Ÿæ•ˆï¼Œé‡å¯åä¼šä¸¢å¤±
> 
> **æ°¸ä¹…æ€§ä¿å­˜**ï¼šéœ€è¦æ‰§è¡Œ `CONFIG REWRITE` æˆ–ä¿®æ”¹é…ç½®æ–‡ä»¶
> 
> **å®‰å…¨è€ƒè™‘**ï¼šæŸäº›é…ç½®ä¿®æ”¹å¯èƒ½å½±å“ç¨³å®šæ€§ï¼Œå»ºè®®å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯

```bash
# ä¿å­˜å½“å‰é…ç½®åˆ°æ–‡ä»¶
redis-cli> CONFIG REWRITE
OK
```

### 3.3 å¸¸ç”¨é…ç½®è°ƒä¼˜


**å†…å­˜ä¼˜åŒ–é…ç½®**ï¼š
```bash
# è®¾ç½®å†…å­˜é™åˆ¶(æ ¹æ®æœåŠ¡å™¨å†…å­˜è®¾ç½®ï¼Œå»ºè®®ç•™20%ç»™ç³»ç»Ÿ)
CONFIG SET maxmemory 8589934592  # 8GB

# è®¾ç½®å†…å­˜æ·˜æ±°ç­–ç•¥
CONFIG SET maxmemory-policy allkeys-lru  # æœ€è¿‘æœ€å°‘ä½¿ç”¨ç®—æ³•

# å¼€å¯å†…å­˜å‹ç¼©
CONFIG SET hash-max-ziplist-entries 512
CONFIG SET list-max-ziplist-size -2
```

**æ€§èƒ½ä¼˜åŒ–é…ç½®**ï¼š
```bash  
# TCPè¿æ¥ä¿æ´»(é˜²æ­¢è¿æ¥æ–­å¼€)
CONFIG SET tcp-keepalive 300

# è®¾ç½®æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°
CONFIG SET maxclients 20000

# å…³é—­ä¿æŠ¤æ¨¡å¼(ç”Ÿäº§ç¯å¢ƒéœ€é…ç½®å¯†ç )
CONFIG SET protected-mode no
```

---

## 4. ğŸ“ æ—¥å¿—ç›¸å…³å‘½ä»¤


### 4.1 SLOWLOG - æ…¢æŸ¥è¯¢æ—¥å¿—


**ä½œç”¨**ï¼šè®°å½•æ‰§è¡Œæ—¶é—´è¶…è¿‡é˜ˆå€¼çš„å‘½ä»¤ï¼Œå¸®åŠ©æ‰¾å‡ºæ€§èƒ½ç“¶é¢ˆã€‚

**åŸºæœ¬æ¦‚å¿µ**ï¼š
```
ä»€ä¹ˆæ˜¯æ…¢æŸ¥è¯¢ï¼Ÿ
å°±åƒæ’é˜Ÿçœ‹ç—…ï¼Œå¦‚æœæŸä¸ªç—…äººçœ‹ç—…æ—¶é—´ç‰¹åˆ«é•¿ï¼Œ
ä¼šå½±å“åé¢æ‰€æœ‰äººçš„ç­‰å¾…æ—¶é—´ã€‚
Redisä¸­æ‰§è¡Œæ—¶é—´é•¿çš„å‘½ä»¤å°±æ˜¯"æ…¢æŸ¥è¯¢"ã€‚
```

```bash
# æŸ¥çœ‹æ…¢æŸ¥è¯¢é…ç½®
redis-cli> CONFIG GET slowlog*
1) "slowlog-log-slower-than"
2) "10000"                 # è¶…è¿‡10æ¯«ç§’è®°å½•
3) "slowlog-max-len"  
4) "128"                   # æœ€å¤šä¿å­˜128æ¡è®°å½•

# æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—
redis-cli> SLOWLOG GET 5   # è·å–æœ€è¿‘5æ¡æ…¢æŸ¥è¯¢
1) 1) (integer) 12         # æ—¥å¿—ID
   2) (integer) 1692174829 # æ‰§è¡Œæ—¶é—´æˆ³  
   3) (integer) 15000      # æ‰§è¡Œè€—æ—¶(å¾®ç§’)
   4) 1) "KEYS"            # æ‰§è¡Œçš„å‘½ä»¤
      2) "user:*"          # å‘½ä»¤å‚æ•°

# æ¸…ç©ºæ…¢æŸ¥è¯¢æ—¥å¿—
redis-cli> SLOWLOG RESET
OK

# æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—æ•°é‡
redis-cli> SLOWLOG LEN
(integer) 5
```

**æ…¢æŸ¥è¯¢åˆ†æç¤ºä¾‹**ï¼š
```bash
# è°ƒæ•´æ…¢æŸ¥è¯¢é˜ˆå€¼(æ”¹ä¸º5æ¯«ç§’)
CONFIG SET slowlog-log-slower-than 5000

# æ¨¡æ‹Ÿä¸€äº›æ“ä½œåæŸ¥çœ‹
SLOWLOG GET 10

# åˆ†æç»“æœ
å¸¸è§çš„æ…¢å‘½ä»¤ï¼š
- KEYS *           # å…¨è¡¨æ‰«æï¼Œç”Ÿäº§ç¯å¢ƒç¦ç”¨
- FLUSHALL        # æ¸…ç©ºæ‰€æœ‰æ•°æ®ï¼Œè€—æ—¶é•¿
- SORT            # æ’åºå¤§é‡æ•°æ®
- å¤§æ‰¹é‡æ“ä½œ       # ä¸€æ¬¡å¤„ç†å¤ªå¤šæ•°æ®
```

### 4.2 æ—¥å¿—çº§åˆ«è®¾ç½®


**Redisæ—¥å¿—çº§åˆ«**ï¼š
```bash
æ—¥å¿—çº§åˆ«ä»é«˜åˆ°ä½ï¼š
debug   â†’ æœ€è¯¦ç»†ï¼ŒåŒ…å«æ‰€æœ‰ä¿¡æ¯(å¼€å‘è°ƒè¯•ç”¨)
verbose â†’ è¯¦ç»†ä¿¡æ¯  
notice  â†’ é‡è¦ä¿¡æ¯(é»˜è®¤çº§åˆ«ï¼Œç”Ÿäº§ç¯å¢ƒæ¨è)
warning â†’ åªè®°å½•è­¦å‘Šå’Œé”™è¯¯
```

**é…ç½®æ—¥å¿—çº§åˆ«**ï¼š
```bash
# æŸ¥çœ‹å½“å‰æ—¥å¿—çº§åˆ«
redis-cli> CONFIG GET loglevel
1) "loglevel"
2) "notice"

# è®¾ç½®ä¸ºè°ƒè¯•çº§åˆ«(å¼€å‘ç¯å¢ƒ)
redis-cli> CONFIG SET loglevel debug

# è®¾ç½®ä¸ºè­¦å‘Šçº§åˆ«(ç”Ÿäº§ç¯å¢ƒ)  
redis-cli> CONFIG SET loglevel warning

# æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ä½ç½®
redis-cli> CONFIG GET logfile
1) "logfile"
2) "/var/log/redis/redis-server.log"
```

**æ—¥å¿—å†…å®¹ç¤ºä¾‹**ï¼š
```bash
# noticeçº§åˆ«æ—¥å¿—å†…å®¹
[12345] 28 Aug 15:30:25.123 * Ready to accept connections
[12345] 28 Aug 15:35:30.456 * 10 changes in 60 seconds. Saving...
[12345] 28 Aug 15:35:31.789 * Background saving started

# warningçº§åˆ«æ—¥å¿—å†…å®¹  
[12345] 28 Aug 16:00:15.234 # WARNING: no config file specified
[12345] 28 Aug 16:05:20.567 # Client timeout, closing connection
```

---

## 5. ğŸ› ï¸ å®æˆ˜è°ƒè¯•æŠ€å·§


### 5.1 æ€§èƒ½é—®é¢˜æ’æŸ¥æµç¨‹


**ç¬¬1æ­¥ï¼šæŸ¥çœ‹æ•´ä½“çŠ¶æ€**
```bash
# å¿«é€Ÿå¥åº·æ£€æŸ¥
redis-cli> INFO stats
```

**å…³é”®æŒ‡æ ‡åˆ†æ**ï¼š
```
è¿æ¥ç›¸å…³ï¼š
connected_clients: å½“å‰è¿æ¥æ•°
rejected_connections: è¢«æ‹’ç»çš„è¿æ¥æ•°(å¦‚æœ>0è¯´æ˜è¿æ¥æ•°è¾¾åˆ°ä¸Šé™)

å‘½ä»¤ç›¸å…³ï¼š  
total_commands_processed: æ€»æ‰§è¡Œå‘½ä»¤æ•°
instantaneous_ops_per_sec: å½“å‰æ¯ç§’æ‰§è¡Œå‘½ä»¤æ•°

å†…å­˜ç›¸å…³ï¼š
used_memory_human: å½“å‰å†…å­˜ä½¿ç”¨
used_memory_peak_human: å†å²æœ€é«˜å†…å­˜ä½¿ç”¨
```

**ç¬¬2æ­¥ï¼šæ£€æŸ¥æ…¢æŸ¥è¯¢**
```bash
# æŸ¥çœ‹æœ€è¿‘çš„æ…¢æŸ¥è¯¢
redis-cli> SLOWLOG GET 20

# åˆ†ææ…¢æŸ¥è¯¢æ¨¡å¼
å¦‚æœå‘ç°ï¼š
- å¤§é‡KEYSå‘½ä»¤ â†’ æ”¹ç”¨SCANå‘½ä»¤
- å¤§é‡SORTæ“ä½œ â†’ è€ƒè™‘åœ¨åº”ç”¨å±‚æ’åº
- å¤§æ‰¹é‡æ“ä½œ â†’ åˆ†æ‰¹å¤„ç†ï¼Œä½¿ç”¨ç®¡é“
```

**ç¬¬3æ­¥ï¼šå†…å­˜ä½¿ç”¨åˆ†æ**
```bash
# æ£€æŸ¥å†…å­˜ä½¿ç”¨è¯¦æƒ…
redis-cli> INFO memory

# åˆ†æå…³é”®æŒ‡æ ‡
used_memory_rss: æ“ä½œç³»ç»Ÿçœ‹åˆ°çš„å†…å­˜ä½¿ç”¨
used_memory: Rediså†…éƒ¨ç»Ÿè®¡çš„å†…å­˜ä½¿ç”¨  
mem_fragmentation_ratio: å†…å­˜ç¢ç‰‡ç‡

# å†…å­˜ç¢ç‰‡ç‡åˆ†æ
ç¢ç‰‡ç‡ < 1: å¯èƒ½ä½¿ç”¨äº†äº¤æ¢å†…å­˜(å±é™©)
ç¢ç‰‡ç‡ 1-1.5: æ­£å¸¸èŒƒå›´
ç¢ç‰‡ç‡ > 1.5: å†…å­˜ç¢ç‰‡è¾ƒå¤šï¼Œè€ƒè™‘é‡å¯æ•´ç†
```

### 5.2 å®æ—¶ç›‘æ§è„šæœ¬


**ç›‘æ§è„šæœ¬ç¤ºä¾‹**ï¼š
```python
import redis
import time
import json

def redis_monitor():
    """RedisçŠ¶æ€ç›‘æ§"""
    r = redis.Redis(host='localhost', port=6379, db=0)
    
    while True:
        try:
            # è·å–åŸºæœ¬ä¿¡æ¯
            info = r.info()
            
            # æ•´ç†å…³é”®æŒ‡æ ‡
            metrics = {
                'timestamp': time.time(),
                'used_memory_mb': round(info['used_memory'] / (1024*1024), 2),
                'connected_clients': info['connected_clients'],
                'ops_per_sec': info.get('instantaneous_ops_per_sec', 0),
                'keyspace_hits': info.get('keyspace_hits', 0),
                'keyspace_misses': info.get('keyspace_misses', 0)
            }
            
            # è®¡ç®—å‘½ä¸­ç‡
            hits = metrics['keyspace_hits']
            misses = metrics['keyspace_misses'] 
            if hits + misses > 0:
                hit_rate = round(hits / (hits + misses) * 100, 2)
                metrics['hit_rate'] = f"{hit_rate}%"
            
            print(f"ç›‘æ§æ•°æ®: {json.dumps(metrics, indent=2)}")
            
            # æ£€æŸ¥å‘Šè­¦æ¡ä»¶
            check_alerts(metrics, info)
            
        except Exception as e:
            print(f"ç›‘æ§å¼‚å¸¸: {e}")
        
        time.sleep(10)  # æ¯10ç§’ç›‘æ§ä¸€æ¬¡

def check_alerts(metrics, info):
    """æ£€æŸ¥å‘Šè­¦æ¡ä»¶"""
    # å†…å­˜ä½¿ç”¨ç‡è¶…è¿‡80%å‘Šè­¦
    if 'maxmemory' in info and info['maxmemory'] > 0:
        memory_usage = info['used_memory'] / info['maxmemory']
        if memory_usage > 0.8:
            print(f"âš ï¸ å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜: {memory_usage:.1%}")
    
    # è¿æ¥æ•°è¿‡å¤šå‘Šè­¦
    if metrics['connected_clients'] > 1000:
        print(f"âš ï¸ è¿æ¥æ•°è¿‡å¤š: {metrics['connected_clients']}")
    
    # å‘½ä¸­ç‡è¿‡ä½å‘Šè­¦
    hit_rate = float(metrics.get('hit_rate', '100%').rstrip('%'))
    if hit_rate < 80:
        print(f"âš ï¸ ç¼“å­˜å‘½ä¸­ç‡è¿‡ä½: {hit_rate}%")
```

### 5.3 è°ƒè¯•å‘½ä»¤ç»„åˆæŠ€å·§


**åœºæ™¯1ï¼šRedisçªç„¶å˜æ…¢äº†**
```bash
# æ­¥éª¤1: æŸ¥çœ‹æ˜¯å¦æœ‰æ…¢æŸ¥è¯¢
SLOWLOG GET 50

# æ­¥éª¤2: æ£€æŸ¥å†…å­˜ä½¿ç”¨
INFO memory

# æ­¥éª¤3: æŸ¥çœ‹è¿æ¥æƒ…å†µ
INFO clients

# æ­¥éª¤4: å®æ—¶ç›‘æ§å‘½ä»¤æ‰§è¡Œ  
MONITOR
# è§‚å¯Ÿä¸€æ®µæ—¶é—´ï¼Œæ‰¾å‡ºå¼‚å¸¸å‘½ä»¤æ¨¡å¼
```

**åœºæ™¯2ï¼šå†…å­˜ä½¿ç”¨å¼‚å¸¸å¢é•¿**
```bash  
# æ­¥éª¤1: æŸ¥çœ‹å†…å­˜è¯¦æƒ…
INFO memory
MEMORY STATS

# æ­¥éª¤2: åˆ†æå¤§key
# (éœ€è¦ä½¿ç”¨redis-rdb-toolsç­‰å·¥å…·åˆ†æRDBæ–‡ä»¶)

# æ­¥éª¤3: æ£€æŸ¥è¿‡æœŸç­–ç•¥
CONFIG GET maxmemory-policy

# æ­¥éª¤4: è°ƒæ•´é…ç½®
CONFIG SET maxmemory-policy allkeys-lru
```

**åœºæ™¯3ï¼šè¿æ¥æ•°è¿‡å¤š**
```bash
# æ­¥éª¤1: æŸ¥çœ‹è¿æ¥ä¿¡æ¯
INFO clients
CLIENT LIST

# æ­¥éª¤2: æ£€æŸ¥é…ç½®
CONFIG GET maxclients
CONFIG GET timeout

# æ­¥éª¤3: è°ƒæ•´è¶…æ—¶æ—¶é—´
CONFIG SET timeout 300  # 5åˆ†é’Ÿç©ºé—²è¶…æ—¶
```

### 5.4 è°ƒè¯•æœ€ä½³å®è·µ


**ğŸ¯ æ—¥å¸¸ç›‘æ§ç­–ç•¥**ï¼š

```
æ¯æ—¥æ£€æŸ¥ï¼š
âœ… INFO stats - æŸ¥çœ‹åŸºæœ¬è¿è¡ŒçŠ¶æ€
âœ… SLOWLOG GET 10 - æ£€æŸ¥æ…¢æŸ¥è¯¢
âœ… CONFIG GET maxmemory* - ç¡®è®¤å†…å­˜é…ç½®

æ¯å‘¨æ£€æŸ¥ï¼š
âœ… MEMORY STATS - å†…å­˜ä½¿ç”¨è¶‹åŠ¿  
âœ… INFO persistence - æŒä¹…åŒ–çŠ¶æ€
âœ… å¤‡ä»½æ•°æ®æ–‡ä»¶

å¼‚å¸¸æ’æŸ¥ï¼š
âœ… ä½¿ç”¨MONITORè§‚å¯Ÿå®æ—¶å‘½ä»¤
âœ… åˆ†ææ…¢æŸ¥è¯¢æ‰¾å‡ºæ€§èƒ½ç“¶é¢ˆ
âœ… æ£€æŸ¥é…ç½®æ˜¯å¦åˆç†
âœ… å¿…è¦æ—¶é‡å¯RedisæœåŠ¡
```

**ğŸ“‹ è°ƒè¯•æ¸…å•**ï¼š

| é—®é¢˜ç—‡çŠ¶ | **æ£€æŸ¥å‘½ä»¤** | **å¯èƒ½åŸå› ** | **è§£å†³æ–¹æ¡ˆ** |
|---------|------------|-------------|-------------|
| **å“åº”æ…¢** | `SLOWLOG GET` | `æ…¢å‘½ä»¤è¿‡å¤š` | `ä¼˜åŒ–å‘½ä»¤ï¼Œé¿å…KEYS *` |
| **å†…å­˜ä¸è¶³** | `INFO memory` | `æ•°æ®è¿‡å¤šæˆ–å†…å­˜æ³„æ¼` | `è®¾ç½®è¿‡æœŸï¼Œæ¸…ç†æ— ç”¨æ•°æ®` |
| **è¿æ¥å¼‚å¸¸** | `INFO clients` | `è¿æ¥æ•°è¾¾åˆ°ä¸Šé™` | `è°ƒæ•´maxclientsé…ç½®` |
| **å‘½ä¸­ç‡ä½** | `INFO stats` | `ç¼“å­˜ç­–ç•¥ä¸å½“` | `è°ƒæ•´è¿‡æœŸæ—¶é—´å’Œæ·˜æ±°ç­–ç•¥` |

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ MONITORï¼šå®æ—¶æŸ¥çœ‹å‘½ä»¤æ‰§è¡Œï¼Œè°ƒè¯•æ—¶çš„çœ¼ç›
ğŸ”¸ INFOï¼šè·å–Redisè¿è¡ŒçŠ¶æ€ï¼Œå¥åº·æ£€æŸ¥çš„å·¥å…·  
ğŸ”¸ MEMORYï¼šåˆ†æå†…å­˜ä½¿ç”¨ï¼Œæ‰¾å‡ºå†…å­˜å¤§æˆ·
ğŸ”¸ CONFIG GET/SETï¼šæŸ¥çœ‹å’Œä¿®æ”¹é…ç½®ï¼ŒåŠ¨æ€è°ƒä¼˜
ğŸ”¸ SLOWLOGï¼šæ…¢æŸ¥è¯¢åˆ†æï¼Œæ€§èƒ½ç“¶é¢ˆå®šä½
ğŸ”¸ æ—¥å¿—çº§åˆ«ï¼šæ§åˆ¶æ—¥å¿—è¯¦ç»†ç¨‹åº¦ï¼Œå¹³è¡¡ä¿¡æ¯ä¸æ€§èƒ½
```

### 6.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ è°ƒè¯•å‘½ä»¤çš„æœ¬è´¨ä½œç”¨**
```
ç›‘æ§ç±»å‘½ä»¤ï¼š
ç›¸å½“äºç»™Redisè£…äº†å„ç§"ä»ªè¡¨ç›˜"
éšæ—¶äº†è§£Redisçš„è¿è¡ŒçŠ¶æ€
å°±åƒå¼€è½¦çœ‹ä»ªè¡¨ç›˜ä¸€æ ·é‡è¦

é…ç½®ç±»å‘½ä»¤ï¼š
ç›¸å½“äºRedisçš„"è®¾ç½®èœå•"  
å¯ä»¥åŠ¨æ€è°ƒæ•´Redisçš„è¡Œä¸º
ä¸éœ€è¦é‡å¯å°±èƒ½ç”Ÿæ•ˆ

æ—¥å¿—ç±»å‘½ä»¤ï¼š
ç›¸å½“äºRedisçš„"è¡Œè½¦è®°å½•ä»ª"
è®°å½•å‘ç”Ÿäº†ä»€ä¹ˆï¼Œå‡ºé—®é¢˜æ—¶å›æº¯åˆ†æ
```

**ğŸ”¹ ä»€ä¹ˆæ—¶å€™ç”¨ä»€ä¹ˆå‘½ä»¤**
```
å¼€å‘è°ƒè¯•é˜¶æ®µï¼š
- å¤šç”¨MONITORè§‚å¯Ÿå‘½ä»¤æ‰§è¡Œ
- è®¾ç½®debugæ—¥å¿—çº§åˆ«çœ‹è¯¦ç»†ä¿¡æ¯
- ç”¨SLOWLOGä¼˜åŒ–æ…¢å‘½ä»¤

ç”Ÿäº§ç¯å¢ƒç›‘æ§ï¼š
- å®šæœŸINFOæ£€æŸ¥çŠ¶æ€
- å…³æ³¨SLOWLOGä¸­çš„æ€§èƒ½é—®é¢˜
- ç”¨warningæ—¥å¿—çº§åˆ«ï¼Œé¿å…æ—¥å¿—è¿‡å¤š
- è°¨æ…ä½¿ç”¨MONITOR(å½±å“æ€§èƒ½)
```

**ğŸ”¹ é…ç½®ä¿®æ”¹çš„æ³¨æ„äº‹é¡¹**
```
ä¸´æ—¶è°ƒæ•´ï¼šCONFIG SETç«‹å³ç”Ÿæ•ˆï¼Œé‡å¯ä¸¢å¤±
æ°¸ä¹…ä¿å­˜ï¼šéœ€è¦CONFIG REWRITEæˆ–ä¿®æ”¹é…ç½®æ–‡ä»¶
å®‰å…¨åŸåˆ™ï¼šå…ˆæµ‹è¯•ç¯å¢ƒéªŒè¯ï¼Œå†ç”Ÿäº§ç¯å¢ƒåº”ç”¨
å¤‡ä»½ä¹ æƒ¯ï¼šé‡è¦é…ç½®ä¿®æ”¹å‰å…ˆå¤‡ä»½å½“å‰é…ç½®
```

### 6.3 å®é™…åº”ç”¨ä»·å€¼


**æ—¥å¸¸è¿ç»´åœºæ™¯**ï¼š
- **æ€§èƒ½ç›‘æ§**ï¼šå®šæœŸæ£€æŸ¥RedisçŠ¶æ€ï¼Œé¢„é˜²é—®é¢˜
- **é—®é¢˜æ’æŸ¥**ï¼šRediså˜æ…¢æ—¶å¿«é€Ÿå®šä½åŸå› 
- **å®¹é‡è§„åˆ’**ï¼šåŸºäºå†…å­˜ä½¿ç”¨è¶‹åŠ¿è§„åˆ’æ‰©å®¹
- **é…ç½®ä¼˜åŒ–**ï¼šæ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹è°ƒæ•´Rediså‚æ•°

**æ•…éšœå¤„ç†æµç¨‹**ï¼š
```
å‘ç°é—®é¢˜ â†’ INFOæ£€æŸ¥çŠ¶æ€ â†’ SLOWLOGæŸ¥æ…¢å‘½ä»¤ â†’ 
MONITORè§‚å¯Ÿå®æ—¶ â†’ è°ƒæ•´é…ç½® â†’ éªŒè¯æ•ˆæœ
```

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- è°ƒè¯•å‘½ä»¤æ˜¯Redisè¿ç»´çš„åŸºæœ¬å·¥å…·
- ç›‘æ§è¦çœ‹INFOå’ŒSLOWLOGï¼Œé…ç½®ç”¨CONFIG
- ç”Ÿäº§ç¯å¢ƒæ…ç”¨MONITORï¼Œå½±å“æ€§èƒ½
- é…ç½®ä¿®æ”¹è¦REWRITEæ‰èƒ½æ°¸ä¹…ä¿å­˜