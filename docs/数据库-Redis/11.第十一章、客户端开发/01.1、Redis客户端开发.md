---
title: 1ã€Rediså®¢æˆ·ç«¯å¼€å‘
---
## ğŸ“š ç›®å½•

1. [Jediså®¢æˆ·ç«¯è¯¦è§£](#1-jediså®¢æˆ·ç«¯è¯¦è§£)
2. [Lettuceå®¢æˆ·ç«¯è¯¦è§£](#2-lettuceå®¢æˆ·ç«¯è¯¦è§£)
3. [Springç”Ÿæ€é›†æˆ](#3-springç”Ÿæ€é›†æˆ)
4. [å®è·µä¸ä¼˜åŒ–](#4-å®è·µä¸ä¼˜åŒ–)
5. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#5-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”§ Jediså®¢æˆ·ç«¯è¯¦è§£


### 1.1 JedisåŸºç¡€ä½¿ç”¨


**ğŸ”¸ ä»€ä¹ˆæ˜¯Jedis**
```
Jedis = Java + Redis
ä½œç”¨ï¼šJavaç¨‹åºè¿æ¥å’Œæ“ä½œRedisçš„å·¥å…·åŒ…
æœ¬è´¨ï¼šå°†Rediså‘½ä»¤å°è£…æˆJavaæ–¹æ³•
ä¼˜åŠ¿ï¼šä½¿ç”¨ç®€å•ï¼ŒAPIç›´è§‚ï¼Œä¸Rediså‘½ä»¤ä¸€ä¸€å¯¹åº”
```

**ğŸ’¡ åŸºæœ¬ä½¿ç”¨æµç¨‹**
```java
// 1. å¼•å…¥ä¾èµ–
<dependency>
    <groupId>redis.clients</groupId>
    <artifactId>jedis</artifactId>
    <version>4.3.1</version>
</dependency>

// 2. åˆ›å»ºè¿æ¥
Jedis jedis = new Jedis("localhost", 6379);

// 3. æ‰§è¡Œæ“ä½œ
jedis.set("key", "value");
String result = jedis.get("key");

// 4. å…³é—­è¿æ¥
jedis.close();
```

**ğŸ¯ æ ¸å¿ƒAPIæ“ä½œ**
```java
// å­—ç¬¦ä¸²æ“ä½œ
jedis.set("name", "å¼ ä¸‰");
jedis.get("name");
jedis.incr("counter");

// å“ˆå¸Œæ“ä½œ
jedis.hset("user:1", "name", "å¼ ä¸‰");
jedis.hget("user:1", "name");

// åˆ—è¡¨æ“ä½œ
jedis.lpush("list", "item1", "item2");
jedis.rpop("list");

// é›†åˆæ“ä½œ
jedis.sadd("set", "member1", "member2");
jedis.smembers("set");

ç‰¹ç‚¹ï¼šæ–¹æ³•åä¸Rediså‘½ä»¤å®Œå…¨ä¸€è‡´ï¼Œå­¦ä¹ æˆæœ¬ä½
```

### 1.2 è¿æ¥æ± é…ç½®è¯¦è§£


**ğŸŠ ä¸ºä»€ä¹ˆéœ€è¦è¿æ¥æ± **
```
é—®é¢˜åœºæ™¯ï¼š
æ™®é€šæ–¹å¼ï¼šæ¯æ¬¡æ“ä½œéƒ½åˆ›å»ºæ–°è¿æ¥
å¼Šç«¯ï¼šåˆ›å»ºè¿æ¥è€—æ—¶ï¼Œé¢‘ç¹åˆ›å»ºé”€æ¯å½±å“æ€§èƒ½

è¿æ¥æ± æ–¹å¼ï¼š
é¢„å…ˆåˆ›å»ºå¤šä¸ªè¿æ¥æ”¾åœ¨æ± å­é‡Œ
ä½¿ç”¨æ—¶ä»æ± å­å–ï¼Œç”¨å®Œæ”¾å›æ± å­
å¥½å¤„ï¼šé¿å…é¢‘ç¹åˆ›å»ºï¼Œæå‡æ€§èƒ½ï¼Œæ§åˆ¶è¿æ¥æ•°
```

**âš™ï¸ JedisPoolé…ç½®**
```java
// è¿æ¥æ± é…ç½®å¯¹è±¡
JedisPoolConfig config = new JedisPoolConfig();
config.setMaxTotal(20);           // æœ€å¤§è¿æ¥æ•°
config.setMaxIdle(10);            // æœ€å¤§ç©ºé—²è¿æ¥æ•°
config.setMinIdle(2);             // æœ€å°ç©ºé—²è¿æ¥æ•°
config.setTestOnBorrow(true);     // å€Ÿç”¨æ—¶æµ‹è¯•è¿æ¥

// åˆ›å»ºè¿æ¥æ± 
JedisPool pool = new JedisPool(config, "localhost", 6379, 2000);

// ä½¿ç”¨è¿æ¥æ± 
try (Jedis jedis = pool.getResource()) {
    jedis.set("key", "value");
    return jedis.get("key");
} // try-with-resourcesè‡ªåŠ¨å½’è¿˜è¿æ¥
```

**ğŸ“Š å…³é”®å‚æ•°è§£é‡Š**

| å‚æ•° | **å«ä¹‰** | **æ¨èå€¼** | **è¯´æ˜** |
|------|---------|-----------|----------|
| `MaxTotal` | `è¿æ¥æ± æœ€å¤§è¿æ¥æ•°` | `8-20` | `æ§åˆ¶æ€»è¿æ¥æ•°ä¸Šé™` |
| `MaxIdle` | `æœ€å¤§ç©ºé—²è¿æ¥æ•°` | `8` | `ç©ºé—²æ—¶ä¿æŒçš„è¿æ¥æ•°` |
| `MinIdle` | `æœ€å°ç©ºé—²è¿æ¥æ•°` | `2` | `ä¿è¯æœ€å°‘çš„å¯ç”¨è¿æ¥` |
| `TestOnBorrow` | `å€Ÿç”¨æ—¶æµ‹è¯•è¿æ¥` | `true` | `ç¡®ä¿è¿æ¥å¯ç”¨æ€§` |
| `MaxWaitMillis` | `è·å–è¿æ¥æœ€å¤§ç­‰å¾…æ—¶é—´` | `3000ms` | `é¿å…æ— é™ç­‰å¾…` |

### 1.3 åˆ†å¸ƒå¼æ”¯æŒ


**ğŸŒ JedisClusteré›†ç¾¤æ”¯æŒ**
```
Redisé›†ç¾¤ç¯å¢ƒï¼š
èŠ‚ç‚¹1: 192.168.1.100:7000
èŠ‚ç‚¹2: 192.168.1.101:7001  
èŠ‚ç‚¹3: 192.168.1.102:7002
```

```java
// é›†ç¾¤èŠ‚ç‚¹é…ç½®
Set<HostAndPort> nodes = new HashSet<>();
nodes.add(new HostAndPort("192.168.1.100", 7000));
nodes.add(new HostAndPort("192.168.1.101", 7001));
nodes.add(new HostAndPort("192.168.1.102", 7002));

// åˆ›å»ºé›†ç¾¤å®¢æˆ·ç«¯
JedisCluster cluster = new JedisCluster(nodes);

// ä½¿ç”¨æ–¹å¼ä¸å•æœºç‰ˆç›¸åŒ
cluster.set("key", "value");
String result = cluster.get("key");

ä¼˜åŠ¿ï¼š
â€¢ è‡ªåŠ¨å‘ç°é›†ç¾¤èŠ‚ç‚¹
â€¢ è‡ªåŠ¨æ•…éšœè½¬ç§»
â€¢ è´Ÿè½½å‡è¡¡
â€¢ æ§½ä½æ˜ å°„è‡ªåŠ¨ç®¡ç†
```

**ğŸ”„ ä¸»ä»å¤åˆ¶æ”¯æŒ**
```java
// å“¨å…µæ¨¡å¼é…ç½®
Set<String> sentinels = new HashSet<>();
sentinels.add("192.168.1.100:26379");
sentinels.add("192.168.1.101:26379");
sentinels.add("192.168.1.102:26379");

JedisSentinelPool pool = new JedisSentinelPool(
    "mymaster",    // ä¸»æœåŠ¡å™¨åç§°
    sentinels,     // å“¨å…µèŠ‚ç‚¹
    poolConfig     // è¿æ¥æ± é…ç½®
);

ç‰¹ç‚¹ï¼š
â€¢ è‡ªåŠ¨å‘ç°ä¸»ä»èŠ‚ç‚¹
â€¢ ä¸»èŠ‚ç‚¹æ•…éšœè‡ªåŠ¨åˆ‡æ¢
â€¢ è¯»å†™åˆ†ç¦»æ”¯æŒ
```

---

## 2. ğŸš€ Lettuceå®¢æˆ·ç«¯è¯¦è§£


### 2.1 Lettuceæ ¸å¿ƒç‰¹æ€§


**ğŸ”¸ ä»€ä¹ˆæ˜¯Lettuce**
```
å®šä¹‰ï¼šåŸºäºNettyçš„é«˜æ€§èƒ½Rediså®¢æˆ·ç«¯
æ ¸å¿ƒç‰¹ç‚¹ï¼šå¼‚æ­¥ã€ååº”å¼ã€çº¿ç¨‹å®‰å…¨
ä¸JedisåŒºåˆ«ï¼š
â€¢ Jedisï¼šåŒæ­¥é˜»å¡ï¼Œè¿æ¥ä¸å®‰å…¨ï¼Œç®€å•æ˜“ç”¨
â€¢ Lettuceï¼šå¼‚æ­¥éé˜»å¡ï¼Œè¿æ¥çº¿ç¨‹å®‰å…¨ï¼Œæ€§èƒ½æ›´é«˜
```

**âš¡ å¼‚æ­¥æ“ä½œæ¨¡å‹**
```java
// åŸºæœ¬è¿æ¥
RedisClient client = RedisClient.create("redis://localhost:6379");
StatefulRedisConnection<String, String> connection = client.connect();
RedisAsyncCommands<String, String> async = connection.async();

// å¼‚æ­¥æ“ä½œç¤ºä¾‹
RedisFuture<String> future = async.set("key", "value");
future.thenAccept(result -> {
    System.out.println("è®¾ç½®å®Œæˆï¼š" + result);
});

// è·å–ç»“æœ
RedisFuture<String> getFuture = async.get("key");
String value = getFuture.get(); // é˜»å¡è·å–ç»“æœ

ä¼˜åŠ¿è§£é‡Šï¼š
â€¢ å¼‚æ­¥æ“ä½œä¸é˜»å¡çº¿ç¨‹
â€¢ å¯ä»¥åŒæ—¶å‘é€å¤šä¸ªå‘½ä»¤
â€¢ æé«˜å¹¶å‘å¤„ç†èƒ½åŠ›
```

### 2.2 è¿æ¥å¤ç”¨æœºåˆ¶


**ğŸ”„ è¿æ¥å¤ç”¨åŸç†**
```
ä¼ ç»Ÿæ¨¡å¼ï¼ˆJedisï¼‰ï¼š
çº¿ç¨‹1 â†’ è¿æ¥1 â†’ Redis
çº¿ç¨‹2 â†’ è¿æ¥2 â†’ Redis  
çº¿ç¨‹3 â†’ è¿æ¥3 â†’ Redis

Lettuceæ¨¡å¼ï¼š
çº¿ç¨‹1 â†˜
çº¿ç¨‹2 â†’ å…±äº«è¿æ¥ â†’ Redis
çº¿ç¨‹3 â†—

ä¼˜åŠ¿ï¼š
â€¢ å‡å°‘è¿æ¥æ•°
â€¢ é™ä½èµ„æºæ¶ˆè€—  
â€¢ æ”¯æŒæ›´é«˜å¹¶å‘
â€¢ è¿æ¥ç®¡ç†ç®€å•
```

**ğŸ› ï¸ è¿æ¥é…ç½®ç¤ºä¾‹**
```java
// è¿æ¥URIé…ç½®
RedisURI uri = RedisURI.Builder
    .redis("localhost", 6379)
    .withTimeout(Duration.ofSeconds(10))
    .withPassword("password")
    .build();

RedisClient client = RedisClient.create(uri);

// è¿æ¥æ± é…ç½®
GenericObjectPoolConfig poolConfig = new GenericObjectPoolConfig();
poolConfig.setMaxTotal(20);
ConnectionPoolSupport.createGenericObjectPool(
    () -> client.connect(), poolConfig
);
```

### 2.3 ååº”å¼ç¼–ç¨‹æ”¯æŒ


**ğŸŒŠ ä»€ä¹ˆæ˜¯ååº”å¼ç¼–ç¨‹**
```
ä¼ ç»Ÿç¼–ç¨‹æ€ç»´ï¼š
æ•°æ® â†’ å¤„ç† â†’ ç»“æœ

ååº”å¼ç¼–ç¨‹æ€ç»´ï¼š
æ•°æ®æµ â†’ å“åº”å¼å¤„ç† â†’ ç»“æœæµ

ç‰¹ç‚¹ï¼š
â€¢ æ•°æ®ä»¥æµçš„å½¢å¼å¤„ç†
â€¢ å¼‚æ­¥éé˜»å¡
â€¢ äº‹ä»¶é©±åŠ¨
â€¢ èƒŒå‹å¤„ç†ï¼ˆå¤„ç†é€Ÿåº¦ä¸åŒ¹é…æ—¶çš„ç¼“å†²ï¼‰
```

**ğŸ’« ååº”å¼APIä½¿ç”¨**
```java
// è·å–ååº”å¼å‘½ä»¤æ¥å£
RedisReactiveCommands<String, String> reactive = connection.reactive();

// ååº”å¼æ“ä½œç¤ºä¾‹
Flux<String> values = reactive.mget("key1", "key2", "key3")
    .flatMapMany(result -> Flux.fromIterable(result))
    .filter(value -> value != null)
    .map(String::toUpperCase);

// è®¢é˜…å¤„ç†ç»“æœ
values.subscribe(
    value -> System.out.println("å¤„ç†ç»“æœï¼š" + value),
    error -> System.err.println("é”™è¯¯ï¼š" + error),
    () -> System.out.println("å¤„ç†å®Œæˆ")
);

åº”ç”¨åœºæ™¯ï¼š
â€¢ é«˜å¹¶å‘æ•°æ®å¤„ç†
â€¢ æµå¼æ•°æ®å¤„ç†
â€¢ å®æ—¶æ•°æ®åˆ†æ
```

---

## 3. ğŸƒ Springç”Ÿæ€é›†æˆ


### 3.1 Spring Data Redisæ¡†æ¶


**ğŸ”¸ æ¡†æ¶æ¦‚è¿°**
```
Spring Data Redisä½œç”¨ï¼š
â€¢ ç®€åŒ–Redisæ“ä½œ
â€¢ æä¾›ç»Ÿä¸€çš„ç¼–ç¨‹æ¨¡å‹
â€¢ è‡ªåŠ¨é…ç½®å’Œä¾èµ–æ³¨å…¥
â€¢ ä¸Springç”Ÿæ€å®Œç¾é›†æˆ

æ ¸å¿ƒç»„ä»¶ï¼š
â€¢ RedisTemplateï¼šæ“ä½œæ¨¡æ¿ç±»
â€¢ Repositoryï¼šä»“å‚¨æ¨¡å¼æ”¯æŒ
â€¢ ç¼“å­˜æŠ½è±¡ï¼š@Cacheableç­‰æ³¨è§£
```

**ğŸ› ï¸ åŸºæœ¬é…ç½®**
```java
@Configuration
public class RedisConfig {
    
    @Bean
    public RedisConnectionFactory connectionFactory() {
        LettuceConnectionFactory factory = 
            new LettuceConnectionFactory("localhost", 6379);
        return factory;
    }
    
    @Bean
    public RedisTemplate<String, Object> redisTemplate(
            RedisConnectionFactory factory) {
        RedisTemplate<String, Object> template = new RedisTemplate<>();
        template.setConnectionFactory(factory);
        
        // åºåˆ—åŒ–é…ç½®
        template.setKeySerializer(new StringRedisSerializer());
        template.setValueSerializer(new GenericJackson2JsonRedisSerializer());
        
        return template;
    }
}
```

### 3.2 RedisTemplateè¯¦è§£


**ğŸ¯ RedisTemplateæ ¸å¿ƒåŠŸèƒ½**
```
ä½œç”¨ï¼šæä¾›é«˜çº§Redisæ“ä½œæ¥å£
ç‰¹ç‚¹ï¼š
â€¢ çº¿ç¨‹å®‰å…¨
â€¢ åºåˆ—åŒ–æ”¯æŒ
â€¢ äº‹åŠ¡æ”¯æŒ
â€¢ ç®¡é“æ“ä½œ
â€¢ è„šæœ¬æ‰§è¡Œ
```

**ğŸ“‹ æ ¸å¿ƒAPIæ“ä½œ**
```java
@Service
public class UserService {
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    // å­—ç¬¦ä¸²æ“ä½œ
    public void setUser(String userId, User user) {
        redisTemplate.opsForValue().set("user:" + userId, user);
    }
    
    public User getUser(String userId) {
        return (User) redisTemplate.opsForValue().get("user:" + userId);
    }
    
    // å“ˆå¸Œæ“ä½œ
    public void setUserField(String userId, String field, Object value) {
        redisTemplate.opsForHash().put("user:" + userId, field, value);
    }
    
    // åˆ—è¡¨æ“ä½œ
    public void addToList(String listKey, Object value) {
        redisTemplate.opsForList().leftPush(listKey, value);
    }
    
    // é›†åˆæ“ä½œ
    public void addToSet(String setKey, Object value) {
        redisTemplate.opsForSet().add(setKey, value);
    }
}
```

**ğŸ”§ åºåˆ—åŒ–é…ç½®è¯¦è§£**
```java
// ä¸åŒçš„åºåˆ—åŒ–å™¨å¯¹æ¯”
StringRedisSerializer     â†’ å­—ç¬¦ä¸²åºåˆ—åŒ–ï¼Œé€‚åˆkey
GenericJackson2JsonRedisSerializer â†’ JSONåºåˆ—åŒ–ï¼Œé€‚åˆå¯¹è±¡
JdkSerializationRedisSerializer    â†’ JDKåºåˆ—åŒ–ï¼Œå…¼å®¹æ€§å¥½ä½†ä½“ç§¯å¤§

// å®Œæ•´åºåˆ—åŒ–é…ç½®
@Bean
public RedisTemplate<String, Object> redisTemplate() {
    RedisTemplate<String, Object> template = new RedisTemplate<>();
    
    // Keyåºåˆ—åŒ–
    template.setKeySerializer(new StringRedisSerializer());
    template.setHashKeySerializer(new StringRedisSerializer());
    
    // Valueåºåˆ—åŒ–
    Jackson2JsonRedisSerializer<Object> serializer = 
        new Jackson2JsonRedisSerializer<>(Object.class);
    template.setValueSerializer(serializer);
    template.setHashValueSerializer(serializer);
    
    return template;
}
```

### 3.3 Spring Bootè‡ªåŠ¨é…ç½®


**âš¡ è‡ªåŠ¨é…ç½®æœºåˆ¶**
```
Spring Bootè‡ªåŠ¨é…ç½®åŸç†ï¼š
1. æ£€æµ‹åˆ°redis-starterä¾èµ–
2. è‡ªåŠ¨åˆ›å»ºRedisConnectionFactory
3. è‡ªåŠ¨åˆ›å»ºRedisTemplate
4. è¯»å–application.ymlé…ç½®
5. åº”ç”¨é»˜è®¤é…ç½®ç­–ç•¥
```

**ğŸ“ é…ç½®æ–‡ä»¶ç¤ºä¾‹**
```yaml
# application.yml
spring:
  redis:
    host: localhost
    port: 6379
    password: 
    database: 0
    timeout: 3000ms
    
    # Lettuceè¿æ¥æ± é…ç½®
    lettuce:
      pool:
        max-active: 20
        max-idle: 10
        min-idle: 2
        max-wait: 3000ms
        
    # é›†ç¾¤é…ç½®ï¼ˆå¯é€‰ï¼‰
    cluster:
      nodes:
        - 192.168.1.100:7000
        - 192.168.1.101:7001
        - 192.168.1.102:7002
```

**ğŸ¨ ä½¿ç”¨æ³¨è§£ç®€åŒ–å¼€å‘**
```java
@Service
public class CacheService {
    
    // è‡ªåŠ¨ç¼“å­˜æ–¹æ³•ç»“æœ
    @Cacheable(value = "users", key = "#userId")
    public User findUser(String userId) {
        // æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢
        return userRepository.findById(userId);
    }
    
    // æ›´æ–°ç¼“å­˜
    @CachePut(value = "users", key = "#user.id")
    public User updateUser(User user) {
        return userRepository.save(user);
    }
    
    // æ¸…é™¤ç¼“å­˜
    @CacheEvict(value = "users", key = "#userId")
    public void deleteUser(String userId) {
        userRepository.deleteById(userId);
    }
}

å¯ç”¨ç¼“å­˜ï¼š
@EnableCaching  // åœ¨å¯åŠ¨ç±»æˆ–é…ç½®ç±»ä¸Šæ·»åŠ 
```

---

## 4. ğŸ›¡ï¸ å®è·µä¸ä¼˜åŒ–


### 4.1 å¼‚å¸¸å¤„ç†æœ€ä½³å®è·µ


**âš ï¸ å¸¸è§å¼‚å¸¸ç±»å‹**
```
è¿æ¥å¼‚å¸¸ï¼š
â€¢ JedisConnectionExceptionï¼šè¿æ¥Rediså¤±è´¥
â€¢ åŸå› ï¼šç½‘ç»œé—®é¢˜ã€RedisæœåŠ¡åœæ­¢ã€è¿æ¥è¶…æ—¶
â€¢ å¤„ç†ï¼šé‡è¯•æœºåˆ¶ã€é™çº§ç­–ç•¥

æ•°æ®å¼‚å¸¸ï¼š
â€¢ JedisDataExceptionï¼šæ•°æ®ç±»å‹é”™è¯¯
â€¢ åŸå› ï¼šå¯¹é”™è¯¯çš„æ•°æ®ç±»å‹æ‰§è¡Œæ“ä½œ
â€¢ å¤„ç†ï¼šæ•°æ®ç±»å‹æ£€æŸ¥ã€å¼‚å¸¸æ•è·

è¶…æ—¶å¼‚å¸¸ï¼š
â€¢ JedisTimeoutExceptionï¼šæ“ä½œè¶…æ—¶
â€¢ åŸå› ï¼šç½‘ç»œå»¶è¿Ÿã€Redisè´Ÿè½½é«˜
â€¢ å¤„ç†ï¼šè°ƒæ•´è¶…æ—¶æ—¶é—´ã€ä¼˜åŒ–æŸ¥è¯¢
```

**ğŸ”§ å¼‚å¸¸å¤„ç†ç­–ç•¥**
```java
@Service
public class RedisService {
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    public String getValue(String key) {
        try {
            return (String) redisTemplate.opsForValue().get(key);
        } catch (Exception e) {
            logger.error("Redisè·å–æ•°æ®å¼‚å¸¸ï¼Œkey: {}", key, e);
            
            // é™çº§ç­–ç•¥ï¼šè¿”å›é»˜è®¤å€¼æˆ–ä»æ•°æ®åº“æŸ¥è¯¢
            return getFromDatabase(key);
        }
    }
    
    // å¸¦é‡è¯•çš„æ“ä½œ
    @Retryable(value = {RedisConnectionFailureException.class}, 
               maxAttempts = 3, backoff = @Backoff(delay = 1000))
    public void setValueWithRetry(String key, Object value) {
        redisTemplate.opsForValue().set(key, value);
    }
}
```

### 4.2 è¿æ¥ç®¡ç†æ–¹æ¡ˆ


**ğŸ”— è¿æ¥ç®¡ç†ç­–ç•¥**
```
å•æœºåº”ç”¨ï¼š
â€¢ ä½¿ç”¨JedisPoolè¿æ¥æ± 
â€¢ é…ç½®åˆç†çš„è¿æ¥æ•°
â€¢ åŠæ—¶é‡Šæ”¾è¿æ¥

é›†ç¾¤åº”ç”¨ï¼š
â€¢ ä½¿ç”¨JedisCluster
â€¢ é…ç½®æ‰€æœ‰é›†ç¾¤èŠ‚ç‚¹
â€¢ å¯ç”¨æ•…éšœè½¬ç§»

å“¨å…µæ¨¡å¼ï¼š
â€¢ ä½¿ç”¨JedisSentinelPool
â€¢ é…ç½®å“¨å…µèŠ‚ç‚¹ä¿¡æ¯
â€¢ è‡ªåŠ¨ä¸»ä»åˆ‡æ¢
```

**ğŸ“ˆ è¿æ¥æ± ç›‘æ§**
```java
@Component
public class RedisMonitor {
    
    @Autowired
    private JedisPool jedisPool;
    
    @Scheduled(fixedRate = 30000) // 30ç§’ç›‘æ§ä¸€æ¬¡
    public void monitorPool() {
        logger.info("Redisè¿æ¥æ± çŠ¶æ€ï¼š");
        logger.info("æ´»è·ƒè¿æ¥æ•°ï¼š{}", jedisPool.getNumActive());
        logger.info("ç©ºé—²è¿æ¥æ•°ï¼š{}", jedisPool.getNumIdle());
        logger.info("ç­‰å¾…çº¿ç¨‹æ•°ï¼š{}", jedisPool.getNumWaiters());
    }
}

ç›‘æ§æŒ‡æ ‡ï¼š
â€¢ è¿æ¥æ•°ä½¿ç”¨ç‡ï¼šé¿å…è¿æ¥è€—å°½
â€¢ ç­‰å¾…æ—¶é—´ï¼šæ£€æŸ¥æ€§èƒ½ç“¶é¢ˆ
â€¢ å¼‚å¸¸ç‡ï¼šå‘ç°é—®é¢˜åŠæ—¶å¤„ç†
```

### 4.3 æ€§èƒ½ä¼˜åŒ–æŠ€å·§


**ğŸš€ æ‰¹é‡æ“ä½œä¼˜åŒ–**
```java
// ä½æ•ˆåšæ³•ï¼šé€ä¸ªæ“ä½œ
for (String key : keys) {
    redisTemplate.opsForValue().set(key, values.get(key));
}

// é«˜æ•ˆåšæ³•ï¼šæ‰¹é‡æ“ä½œ
Map<String, Object> map = new HashMap<>();
for (int i = 0; i < keys.size(); i++) {
    map.put(keys.get(i), values.get(i));
}
redisTemplate.opsForValue().multiSet(map);

æ€§èƒ½æå‡ï¼š
â€¢ å‡å°‘ç½‘ç»œå¾€è¿”æ¬¡æ•°
â€¢ é™ä½ç½‘ç»œå»¶è¿Ÿå½±å“
â€¢ æé«˜ååé‡
```

**ğŸ§® ç®¡é“æ“ä½œ**
```java
// ç®¡é“æ“ä½œï¼šä¸€æ¬¡æ€§å‘é€å¤šä¸ªå‘½ä»¤
List<Object> results = redisTemplate.executePipelined(
    new RedisCallback<Object>() {
        @Override
        public Object doInRedis(RedisConnection connection) {
            StringRedisConnection stringConn = (StringRedisConnection) connection;
            
            // æ‰¹é‡æ‰§è¡Œå‘½ä»¤
            for (String key : keys) {
                stringConn.get(key);
            }
            
            return null; // ç®¡é“æ“ä½œè¿”å›null
        }
    }
);

é€‚ç”¨åœºæ™¯ï¼š
â€¢ å¤§é‡è¯»æ“ä½œ
â€¢ æ‰¹é‡æ•°æ®å¯¼å…¥
â€¢ æ€§èƒ½è¦æ±‚é«˜çš„åœºæ™¯
```

**ğŸ’¾ å†…å­˜ä¼˜åŒ–**
```java
// åˆç†è®¾ç½®è¿‡æœŸæ—¶é—´
redisTemplate.opsForValue().set(key, value, Duration.ofHours(1));

// å‹ç¼©å¤§å¯¹è±¡
@Bean
public RedisSerializer<Object> redisSerializer() {
    return new GenericJackson2JsonRedisSerializer();
}

// é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„
// å¤§é‡å­—æ®µç”¨Hashè€Œä¸æ˜¯å¤šä¸ªString
redisTemplate.opsForHash().putAll("user:1", userMap);
```

### 4.4 å¸¸è§é—®é¢˜è§£å†³


**ğŸ”§ é—®é¢˜è¯Šæ–­æ¸…å•**

```
è¿æ¥é—®é¢˜ï¼š
âœ“ æ£€æŸ¥RedisæœåŠ¡æ˜¯å¦å¯åŠ¨
âœ“ ç¡®è®¤ç½‘ç»œè¿é€šæ€§
âœ“ éªŒè¯ç«¯å£å’Œå¯†ç é…ç½®
âœ“ æŸ¥çœ‹é˜²ç«å¢™è®¾ç½®

æ€§èƒ½é—®é¢˜ï¼š
âœ“ ç›‘æ§è¿æ¥æ± ä½¿ç”¨æƒ…å†µ
âœ“ æ£€æŸ¥å‘½ä»¤æ‰§è¡Œæ—¶é—´
âœ“ åˆ†æç½‘ç»œå»¶è¿Ÿ
âœ“ ä¼˜åŒ–æ•°æ®ç»“æ„é€‰æ‹©

å†…å­˜é—®é¢˜ï¼š
âœ“ ç›‘æ§Rediså†…å­˜ä½¿ç”¨
âœ“ æ£€æŸ¥æ•°æ®è¿‡æœŸç­–ç•¥
âœ“ ä¼˜åŒ–æ•°æ®åºåˆ—åŒ–æ–¹å¼
âœ“ åˆç†è®¾ç½®ç¼“å­˜å¤§å°
```

**ğŸ’¡ æ•…éšœæ’æŸ¥æ–¹æ³•**
```java
// è¿æ¥æµ‹è¯•
@Component
public class RedisHealthCheck {
    
    @Autowired
    private RedisTemplate<String, String> redisTemplate;
    
    public boolean isRedisAvailable() {
        try {
            String pong = redisTemplate.execute(
                (RedisCallback<String>) connection -> {
                    return connection.ping();
                }
            );
            return "PONG".equals(pong);
        } catch (Exception e) {
            logger.error("Rediså¥åº·æ£€æŸ¥å¤±è´¥", e);
            return false;
        }
    }
}

// æ€§èƒ½æµ‹è¯•
public void performanceTest() {
    long start = System.currentTimeMillis();
    
    for (int i = 0; i < 1000; i++) {
        redisTemplate.opsForValue().set("test:" + i, "value" + i);
    }
    
    long end = System.currentTimeMillis();
    logger.info("1000æ¬¡setæ“ä½œè€—æ—¶ï¼š{}ms", end - start);
}
```

---

## 5. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 5.1 å®¢æˆ·ç«¯é€‰æ‹©æŒ‡å—


```
ğŸ”¸ Jedisé€‚ç”¨åœºæ™¯ï¼š
â€¢ ç®€å•åº”ç”¨ï¼Œå¯¹æ€§èƒ½è¦æ±‚ä¸é«˜
â€¢ å›¢é˜Ÿå¯¹Rediså‘½ä»¤ç†Ÿæ‚‰
â€¢ éœ€è¦ä¸Rediså‘½ä»¤ä¸€ä¸€å¯¹åº”çš„API
â€¢ åŒæ­¥ç¼–ç¨‹æ¨¡å‹

ğŸ”¸ Lettuceé€‚ç”¨åœºæ™¯ï¼š
â€¢ é«˜å¹¶å‘åº”ç”¨
â€¢ éœ€è¦å¼‚æ­¥ç¼–ç¨‹
â€¢ å¯¹æ€§èƒ½è¦æ±‚è¾ƒé«˜
â€¢ ç°ä»£åŒ–åº”ç”¨æ¶æ„
```

### 5.2 Springé›†æˆæœ€ä½³å®è·µ


**ğŸ¯ é…ç½®ä¼˜åŒ–**
```
è¿æ¥é…ç½®ï¼š
â€¢ ä½¿ç”¨Lettuceä½œä¸ºé»˜è®¤å®¢æˆ·ç«¯
â€¢ åˆç†é…ç½®è¿æ¥æ± å‚æ•°
â€¢ å¯ç”¨è¿æ¥å¤ç”¨æœºåˆ¶

åºåˆ—åŒ–é…ç½®ï¼š
â€¢ Keyä½¿ç”¨Stringåºåˆ—åŒ–
â€¢ Valueæ ¹æ®éœ€è¦é€‰æ‹©JSONæˆ–JDKåºåˆ—åŒ–
â€¢ Hashçš„Keyå’ŒValueå•ç‹¬é…ç½®

ç¼“å­˜é…ç½®ï¼š
â€¢ åˆç†è®¾ç½®è¿‡æœŸæ—¶é—´
â€¢ ä½¿ç”¨ç¼“å­˜æ³¨è§£ç®€åŒ–å¼€å‘
â€¢ é…ç½®ç¼“å­˜keyç”Ÿæˆç­–ç•¥
```

### 5.3 æ€§èƒ½ä¼˜åŒ–è¦ç‚¹


**âš¡ å…³é”®ä¼˜åŒ–ç­–ç•¥**
```
æ‰¹é‡æ“ä½œï¼š
â€¢ ä½¿ç”¨multiSet/multiGetä»£æ›¿å¾ªç¯æ“ä½œ
â€¢ åˆ©ç”¨ç®¡é“æŠ€æœ¯æé«˜ååé‡
â€¢ åˆç†ç»„ç»‡æ‰¹é‡æ“ä½œå¤§å°

è¿æ¥ç®¡ç†ï¼š
â€¢ ä½¿ç”¨è¿æ¥æ± é¿å…é¢‘ç¹åˆ›å»ºè¿æ¥
â€¢ ç›‘æ§è¿æ¥æ± çŠ¶æ€
â€¢ åŠæ—¶é‡Šæ”¾è¿æ¥èµ„æº

å†…å­˜ç®¡ç†ï¼š
â€¢ è®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´
â€¢ é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„
â€¢ ä¼˜åŒ–åºåˆ—åŒ–æ–¹å¼
```

### 5.4 æ¶æ„è®¾è®¡å»ºè®®


**ğŸ—ï¸ åˆ†å±‚æ¶æ„**
```
åº”ç”¨å±‚æ¶æ„ï¼š

Controllerå±‚ï¼š
â”œâ”€ æ¥æ”¶HTTPè¯·æ±‚
â”œâ”€ å‚æ•°éªŒè¯
â””â”€ è°ƒç”¨Serviceå±‚

Serviceå±‚ï¼š
â”œâ”€ ä¸šåŠ¡é€»è¾‘å¤„ç†  
â”œâ”€ ç¼“å­˜ç­–ç•¥å†³ç­–
â””â”€ è°ƒç”¨DAOå±‚

DAOå±‚ï¼š
â”œâ”€ æ•°æ®åº“æ“ä½œ
â”œâ”€ Redisç¼“å­˜æ“ä½œ
â””â”€ æ•°æ®ä¸€è‡´æ€§ä¿è¯

Rediså±‚ï¼š
â”œâ”€ RedisTemplateæ“ä½œ
â”œâ”€ è¿æ¥æ± ç®¡ç†
â””â”€ åºåˆ—åŒ–å¤„ç†
```

**ğŸ”„ ç¼“å­˜è®¾è®¡æ¨¡å¼**
```
Cache-Asideæ¨¡å¼ï¼š
1. åº”ç”¨å…ˆæŸ¥ç¼“å­˜
2. ç¼“å­˜missæŸ¥æ•°æ®åº“
3. å°†ç»“æœå†™å…¥ç¼“å­˜

Write-Throughæ¨¡å¼ï¼š
1. åº”ç”¨å†™ç¼“å­˜
2. ç¼“å­˜åŒæ­¥å†™æ•°æ®åº“
3. ä¿è¯æ•°æ®ä¸€è‡´æ€§

Write-Behindæ¨¡å¼ï¼š
1. åº”ç”¨å†™ç¼“å­˜
2. ç¼“å­˜å¼‚æ­¥å†™æ•°æ®åº“
3. æé«˜å†™å…¥æ€§èƒ½
```

### 5.5 å®é™…åº”ç”¨ä»·å€¼


**ğŸ’¼ ä¸šåŠ¡åœºæ™¯åº”ç”¨**
- **ç”µå•†ç³»ç»Ÿ**ï¼šå•†å“ä¿¡æ¯ç¼“å­˜ã€è´­ç‰©è½¦å­˜å‚¨ã€ç§’æ€è®¡æ•°
- **ç¤¾äº¤åº”ç”¨**ï¼šç”¨æˆ·ä¼šè¯ã€æ¶ˆæ¯é˜Ÿåˆ—ã€å¥½å‹å…³ç³»
- **å†…å®¹ç³»ç»Ÿ**ï¼šæ–‡ç« ç¼“å­˜ã€è¯„è®ºå­˜å‚¨ã€çƒ­é—¨æ’è¡Œ
- **é‡‘èç³»ç»Ÿ**ï¼šäº¤æ˜“è®°å½•ã€é£æ§æ•°æ®ã€å®æ—¶è®¡ç®—

**ğŸ”§ æŠ€æœ¯é€‰å‹åŸåˆ™**
- **é¡¹ç›®è§„æ¨¡å°**ï¼šé€‰æ‹©Jedisï¼Œç®€å•ç›´æ¥
- **é«˜å¹¶å‘éœ€æ±‚**ï¼šé€‰æ‹©Lettuceï¼Œæ€§èƒ½æ›´å¥½
- **Springé¡¹ç›®**ï¼šä¼˜å…ˆSpring Data Redisé›†æˆ
- **å¾®æœåŠ¡æ¶æ„**ï¼šç»“åˆSpring Cloudä½¿ç”¨åˆ†å¸ƒå¼ç¼“å­˜

**æ ¸å¿ƒè®°å¿†**ï¼š
- Jedisç®€å•ç›´æ¥ï¼ŒLettuceå¼‚æ­¥é«˜æ•ˆ
- Spring Data Redisæä¾›ç»Ÿä¸€ç¼–ç¨‹æ¨¡å‹
- è¿æ¥æ± é…ç½®æ˜¯æ€§èƒ½å…³é”®
- å¼‚å¸¸å¤„ç†å’Œç›‘æ§ä¸å¯å¿½è§†
- æ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚çš„å®¢æˆ·ç«¯å’Œé…ç½®ç­–ç•¥