---
title: 16ã€æŒä¹…åŒ–ç»„åˆç­–ç•¥å’Œé…ç½®å®æˆ˜
---
## ğŸ“š ç›®å½•

1. [æŒä¹…åŒ–åŸºç¡€æ¦‚å¿µå›é¡¾](#1-æŒä¹…åŒ–åŸºç¡€æ¦‚å¿µå›é¡¾)
2. [RDB + AOFç»„åˆä½¿ç”¨](#2-RDB-AOFç»„åˆä½¿ç”¨)
3. [æ··åˆæŒä¹…åŒ–ç­–ç•¥](#3-æ··åˆæŒä¹…åŒ–ç­–ç•¥)
4. [åˆ†çº§å¤‡ä»½ç­–ç•¥](#4-åˆ†çº§å¤‡ä»½ç­–ç•¥)
5. [é…ç½®æ¨¡æ¿å®ä¾‹](#5-é…ç½®æ¨¡æ¿å®ä¾‹)
6. [åœºæ™¯åŒ–é€‰æ‹©æŒ‡å—](#6-åœºæ™¯åŒ–é€‰æ‹©æŒ‡å—)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ’¾ æŒä¹…åŒ–åŸºç¡€æ¦‚å¿µå›é¡¾


### 1.1 ä»€ä¹ˆæ˜¯RedisæŒä¹…åŒ–ï¼Ÿ


**ğŸ’¡ ç”Ÿæ´»åŒ–ç†è§£**ï¼šå°±åƒç»™é‡è¦æ–‡ä»¶**åšå¤‡ä»½**
```
æ—¥å¸¸å¤‡ä»½åœºæ™¯å¯¹æ¯”ï¼š

ğŸ“± æ‰‹æœºç…§ç‰‡å¤‡ä»½ï¼š
- å®æ—¶å¤‡ä»½ï¼šæ¯æ‹ä¸€å¼ ç…§ç‰‡ç«‹å³ä¸Šä¼ åˆ°äº‘ç›˜ (ç±»ä¼¼AOF)
- å®šæœŸå¤‡ä»½ï¼šæ¯å‘¨æŠŠæ‰€æœ‰ç…§ç‰‡æ‰“åŒ…å¤‡ä»½ (ç±»ä¼¼RDB)
- åŒé‡ä¿é™©ï¼šæ—¢å®æ—¶å¤‡ä»½åˆå®šæœŸå¤‡ä»½ (ç±»ä¼¼RDB+AOF)

ğŸ¢ å…¬å¸æ–‡æ¡£å¤‡ä»½ï¼š
- è‡ªåŠ¨ä¿å­˜ï¼šWordæ¯å‡ åˆ†é’Ÿè‡ªåŠ¨ä¿å­˜ (ç±»ä¼¼AOF)
- ç‰ˆæœ¬å¿«ç…§ï¼šæ¯å¤©æ™šä¸Šæ•´ä½“å¤‡ä»½æ‰€æœ‰æ–‡æ¡£ (ç±»ä¼¼RDB)
```

**ğŸ”¸ Redisä¸ºä»€ä¹ˆéœ€è¦æŒä¹…åŒ–ï¼Ÿ**
```
Redisç‰¹ç‚¹ï¼šæ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­
é—®é¢˜ï¼šæœåŠ¡å™¨é‡å¯æˆ–æ–­ç”µï¼Œå†…å­˜æ•°æ®å°±ä¸¢å¤±äº†
è§£å†³æ–¹æ¡ˆï¼šæŠŠå†…å­˜æ•°æ®ä¿å­˜åˆ°ç£ç›˜ï¼Œé‡å¯æ—¶æ¢å¤

ä¸¤ç§æŒä¹…åŒ–æ–¹å¼ï¼š
RDBï¼šæ‹å¿«ç…§ - æŸä¸ªæ—¶é—´ç‚¹çš„å®Œæ•´æ•°æ®å‰¯æœ¬
AOFï¼šè®°æ—¥å¿— - è®°å½•æ¯ä¸ªå†™æ“ä½œçš„å†å²
```

### 1.2 RDB vs AOF å¿«é€Ÿå¯¹æ¯”


**ğŸ“Š ç‰¹ç‚¹å¯¹æ¯”è¡¨**

| æŒä¹…åŒ–æ–¹å¼ | **å·¥ä½œåŸç†** | **æ•°æ®ä¸¢å¤±é£é™©** | **æ–‡ä»¶å¤§å°** | **æ¢å¤é€Ÿåº¦** | **CPUå ç”¨** |
|-----------|------------|----------------|-------------|-------------|------------|
| ğŸï¸ **RDB** | `æ‹å¿«ç…§ï¼Œå…¨é‡å¤‡ä»½` | `å¯èƒ½ä¸¢å¤±å‡ åˆ†é’Ÿæ•°æ®` | `å°ï¼Œå‹ç¼©æ•ˆæœå¥½` | `å¿«ï¼Œç›´æ¥åŠ è½½` | `ä½ï¼Œforkå­è¿›ç¨‹` |
| ğŸ“ **AOF** | `è®°æ—¥å¿—ï¼Œå¢é‡å¤‡ä»½` | `æœ€å¤šä¸¢å¤±1ç§’æ•°æ®` | `å¤§ï¼Œè®°å½•æ‰€æœ‰æ“ä½œ` | `æ…¢ï¼Œé‡æ”¾æ“ä½œ` | `é«˜ï¼Œæ¯æ¬¡å†™ç£ç›˜` |
| ğŸ”„ **æ··åˆ** | `RDBå¿«ç…§+AOFå¢é‡` | `å…¼é¡¾ä¸¤è€…ä¼˜åŠ¿` | `ä¸­ç­‰ï¼Œå¹³è¡¡å¤§å°` | `ä¸­ç­‰ï¼Œæ··åˆæ¢å¤` | `ä¸­ç­‰ï¼Œæ™ºèƒ½åˆ‡æ¢` |

---

## 2. ğŸ¤ RDB + AOFç»„åˆä½¿ç”¨


### 2.1 ä¸ºä»€ä¹ˆè¦ç»„åˆä½¿ç”¨ï¼Ÿ


**ğŸ’¡ ç”Ÿæ´»ç±»æ¯”**ï¼šå°±åƒ**å¤šé‡ä¿é™©**
```
ä¿é™©ç»„åˆçš„é“ç†ï¼š

ğŸ’¼ é‡è¦æ–‡æ¡£ä¿ç®¡ï¼š
æ–¹å¼1ï¼šæ‰«ææˆPDFä¿å­˜ (ç±»ä¼¼RDB) 
     - ä¼˜ç‚¹ï¼šæ–‡ä»¶å°ï¼ŒæŸ¥é˜…å¿«
     - ç¼ºç‚¹ï¼šåªèƒ½æ¢å¤åˆ°æ‰«ææ—¶çš„çŠ¶æ€

æ–¹å¼2ï¼šè®°å½•æ¯æ¬¡ä¿®æ”¹ (ç±»ä¼¼AOF)
     - ä¼˜ç‚¹ï¼šèƒ½æ¢å¤åˆ°æœ€åä¸€æ¬¡ä¿®æ”¹
     - ç¼ºç‚¹ï¼šè®°å½•æ–‡ä»¶å¾ˆå¤§ï¼Œæ¢å¤æ…¢

ç»„åˆä½¿ç”¨ï¼šå®šæœŸæ‰«æ + ä¿®æ”¹è®°å½•
     - æ—¢æœ‰å®Œæ•´å¤‡ä»½ï¼Œåˆæœ‰è¯¦ç»†å†å²
     - å‡ºé—®é¢˜æ—¶èƒ½æœ€å¤§ç¨‹åº¦æ¢å¤æ•°æ®
```

### 2.2 ç»„åˆé…ç½®å®ç°


**ğŸ”§ åŒæ—¶å¼€å¯ä¸¤ç§æŒä¹…åŒ–**
```bash
# redis.conf é…ç½®æ–‡ä»¶

# å¼€å¯RDBæŒä¹…åŒ–
save 900 1      # 900ç§’å†…è‡³å°‘1ä¸ªkeyå˜åŒ–å°±ä¿å­˜
save 300 10     # 300ç§’å†…è‡³å°‘10ä¸ªkeyå˜åŒ–å°±ä¿å­˜  
save 60 10000   # 60ç§’å†…è‡³å°‘10000ä¸ªkeyå˜åŒ–å°±ä¿å­˜

# å¼€å¯AOFæŒä¹…åŒ–
appendonly yes                    # å¯ç”¨AOF
appendfilename "appendonly.aof"   # AOFæ–‡ä»¶å
appendfsync everysec             # æ¯ç§’åŒæ­¥ä¸€æ¬¡åˆ°ç£ç›˜

# æ··åˆæŒä¹…åŒ– (Redis 4.0+)
aof-use-rdb-preamble yes         # å¼€å¯æ··åˆæŒä¹…åŒ–
```

### 2.3 æ•°æ®æ¢å¤ä¼˜å…ˆçº§


**ğŸ”„ æ¢å¤æ—¶çš„ä¼˜å…ˆçº§æœºåˆ¶**
```
Rediså¯åŠ¨æ—¶çš„æ•°æ®æ¢å¤æµç¨‹ï¼š

1ï¸âƒ£ æ£€æŸ¥AOFæ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”å¯ç”¨
   â†“ å­˜åœ¨
   ä¼˜å…ˆä½¿ç”¨AOFæ–‡ä»¶æ¢å¤ (æ•°æ®æœ€æ–°æœ€å®Œæ•´)
   
   â†“ ä¸å­˜åœ¨  
2ï¸âƒ£ æ£€æŸ¥RDBæ–‡ä»¶æ˜¯å¦å­˜åœ¨
   â†“ å­˜åœ¨
   ä½¿ç”¨RDBæ–‡ä»¶æ¢å¤
   
   â†“ ä¸å­˜åœ¨
3ï¸âƒ£ ç©ºå®ä¾‹å¯åŠ¨

åŸå› ï¼šAOFè®°å½•æ›´è¯¦ç»†ï¼Œæ•°æ®ä¸¢å¤±é£é™©æ›´å°
```

**ğŸ’» éªŒè¯æ¢å¤ä¼˜å…ˆçº§**
```python
# æ¼”ç¤ºæ•°æ®æ¢å¤ä¼˜å…ˆçº§

# 1. å‡†å¤‡æµ‹è¯•æ•°æ®
redis_client.set("test_key", "rdb_value")
redis_client.bgsave()  # æ‰‹åŠ¨è§¦å‘RDB

redis_client.set("test_key", "aof_value") 
# AOFä¼šè®°å½•è¿™æ¬¡ä¿®æ”¹

# 2. é‡å¯Redis
# ç»“æœï¼štest_key = "aof_value" (AOFä¼˜å…ˆ)

# 3. å¦‚æœåˆ é™¤AOFæ–‡ä»¶å†é‡å¯
# ç»“æœï¼štest_key = "rdb_value" (ä½¿ç”¨RDB)
```

### 2.4 åŒé‡ä¿é™©æœºåˆ¶åŸç†


**ğŸ›¡ï¸ æ•°æ®å®‰å…¨ä¿éšœ**
```
ç»„åˆä½¿ç”¨çš„å®‰å…¨ä¼˜åŠ¿ï¼š

åœºæ™¯1ï¼šAOFæ–‡ä»¶æŸå
- AOFæ— æ³•è§£ææ—¶ï¼Œè‡ªåŠ¨ä½¿ç”¨RDBæ¢å¤
- è™½ç„¶å¯èƒ½ä¸¢å¤±ä¸€äº›æ•°æ®ï¼Œä½†é¿å…å®Œå…¨ä¸¢å¤±

åœºæ™¯2ï¼šRDBæ–‡ä»¶è¿‡æ—§
- RDBæ–‡ä»¶æ˜¯æ˜¨å¤©çš„ï¼Œä½†AOFæœ‰ä»Šå¤©çš„æ“ä½œè®°å½•
- æ¢å¤æ—¶ç”¨AOFï¼Œæ•°æ®æœ€æ–°æœ€å®Œæ•´

åœºæ™¯3ï¼šç£ç›˜ç©ºé—´ä¸è¶³
- AOFæ–‡ä»¶å¤ªå¤§æ—¶ï¼Œå¯ä»¥åŸºäºæœ€æ–°RDBé‡å†™AOF
- ä¿æŒæ•°æ®å®Œæ•´æ€§çš„åŒæ—¶æ§åˆ¶æ–‡ä»¶å¤§å°
```

---

## 3. ğŸ”„ æ··åˆæŒä¹…åŒ–ç­–ç•¥


### 3.1 ä»€ä¹ˆæ˜¯æ··åˆæŒä¹…åŒ–ï¼Ÿ


**ğŸ’¡ é€šä¿—ç†è§£**ï¼šå°±åƒ**æ™ºèƒ½å¤‡ä»½**
```
ä¼ ç»Ÿå¤‡ä»½æ–¹å¼çš„é—®é¢˜ï¼š

ğŸ“ çº¯æ—¥å¿—æ–¹å¼(çº¯AOF)ï¼š
è®°å½•: æ·»åŠ ç”¨æˆ·A -> ä¿®æ”¹ç”¨æˆ·A -> åˆ é™¤ç”¨æˆ·A -> æ·»åŠ ç”¨æˆ·A...
é—®é¢˜: æ–‡ä»¶è¶Šæ¥è¶Šå¤§ï¼Œæ¢å¤è¶Šæ¥è¶Šæ…¢

ğŸ“· çº¯å¿«ç…§æ–¹å¼(çº¯RDB)ï¼š
è®°å½•: æ¯å°æ—¶æ‹ä¸€æ¬¡å®Œæ•´ç…§ç‰‡
é—®é¢˜: ä¸­é—´çš„ä¿®æ”¹å¯èƒ½ä¸¢å¤±

ğŸ§  æ™ºèƒ½æ··åˆæ–¹å¼ï¼š
åŸºç¡€: å®Œæ•´å¿«ç…§ (RDB)
å¢é‡: + æœ€è¿‘çš„ä¿®æ”¹è®°å½• (AOF)
ç»“æœ: æ–‡ä»¶ä¸ä¼šå¤ªå¤§ï¼Œæ•°æ®ä¸ä¼šä¸¢å¤±å¤ªå¤š
```

### 3.2 æ··åˆæŒä¹…åŒ–å·¥ä½œåŸç†


**âš™ï¸ å·¥ä½œæµç¨‹å›¾**
```
æ··åˆæŒä¹…åŒ–è¿‡ç¨‹ï¼š

æ—¶é—´è½´: 0--------10--------20--------30 (åˆ†é’Ÿ)
         |         |         |         |
         RDBå¿«ç…§    AOFè®°å½•    AOFè®°å½•    AOFé‡å†™

æ–‡ä»¶å†…å®¹å˜åŒ–ï¼š
0åˆ†é’Ÿ:  [ç©º]
10åˆ†é’Ÿ: [RDBå¿«ç…§] åŒ…å«0-10åˆ†é’Ÿçš„å®Œæ•´æ•°æ®
20åˆ†é’Ÿ: [RDBå¿«ç…§] + [AOFå¢é‡] åŒ…å«10-20åˆ†é’Ÿçš„æ“ä½œ
30åˆ†é’Ÿ: [æ–°RDBå¿«ç…§] é‡å†™ååŒ…å«0-30åˆ†é’Ÿå®Œæ•´æ•°æ®

ä¼˜åŠ¿è§£æï¼š
âœ… æ–‡ä»¶å¤§å°å¯æ§ï¼šå®šæœŸé‡å†™ï¼Œä¸ä¼šæ— é™å¢é•¿
âœ… æ¢å¤é€Ÿåº¦å¿«ï¼šåŸºäºRDBå¿«ç…§ + å°‘é‡AOFé‡æ”¾
âœ… æ•°æ®ä¸¢å¤±å°‘ï¼šæœ€å¤šä¸¢å¤±é‡å†™é—´éš”çš„æ•°æ®
```

### 3.3 æ··åˆæŒä¹…åŒ–é…ç½®


**ğŸ”§ è¯¦ç»†é…ç½®è¯´æ˜**
```bash
# redis.conf æ··åˆæŒä¹…åŒ–é…ç½®

# 1. åŸºç¡€é…ç½®
appendonly yes                    # å¿…é¡»å¼€å¯AOF
aof-use-rdb-preamble yes         # å¼€å¯æ··åˆæŒä¹…åŒ–

# 2. é‡å†™è§¦å‘æ¡ä»¶
auto-aof-rewrite-percentage 100  # AOFæ–‡ä»¶å¤§å°æ¯”ä¸Šæ¬¡é‡å†™åå¤§ä¸€å€æ—¶è§¦å‘
auto-aof-rewrite-min-size 64mb   # AOFæ–‡ä»¶è‡³å°‘64MBæ‰è€ƒè™‘é‡å†™

# 3. åŒæ­¥ç­–ç•¥
appendfsync everysec             # æ¨èï¼šæ¯ç§’åŒæ­¥ï¼Œå¹³è¡¡æ€§èƒ½å’Œå®‰å…¨

# 4. é‡å†™æœŸé—´å®‰å…¨ç­–ç•¥
no-appendfsync-on-rewrite no     # é‡å†™æœŸé—´ä¸åœæ­¢åŒæ­¥ï¼ˆæ›´å®‰å…¨ï¼‰
```

### 3.4 æ··åˆæ¨¡å¼ä¸çº¯æ¨¡å¼å¯¹æ¯”


**ğŸ“ˆ æ€§èƒ½å¯¹æ¯”åˆ†æ**

| å¯¹æ¯”ç»´åº¦ | **çº¯RDB** | **çº¯AOF** | **æ··åˆæ¨¡å¼** | **æœ€ä½³åœºæ™¯** |
|---------|----------|----------|-------------|-------------|
| ğŸ“ **æ–‡ä»¶å¤§å°** | `å¾ˆå°` | `å¾ˆå¤§` | `ä¸­ç­‰` | `å­˜å‚¨ç©ºé—´æœ‰é™` |
| âš¡ **æ¢å¤é€Ÿåº¦** | `å¾ˆå¿«` | `å¾ˆæ…¢` | `è¾ƒå¿«` | `å¿«é€Ÿé‡å¯éœ€æ±‚` |
| ğŸ”’ **æ•°æ®å®‰å…¨** | `ä¸¢å¤±è¾ƒå¤š` | `ä¸¢å¤±æœ€å°‘` | `ä¸¢å¤±è¾ƒå°‘` | `æ•°æ®é‡è¦æ€§é«˜` |
| ğŸ’» **CPUæ¶ˆè€—** | `ä½` | `é«˜` | `ä¸­ç­‰` | `æ€§èƒ½æ•æ„Ÿåº”ç”¨` |
| ğŸ’¿ **ç£ç›˜IO** | `ä½` | `é«˜` | `ä¸­ç­‰` | `IOæ€§èƒ½æœ‰é™` |

### 3.5 é€‚ç”¨åœºæ™¯åˆ†æ


**ğŸ¯ ä»€ä¹ˆæ—¶å€™ç”¨æ··åˆæŒä¹…åŒ–ï¼Ÿ**
```
âœ… æ¨èä½¿ç”¨æ··åˆæ¨¡å¼çš„åœºæ™¯ï¼š
- æ•°æ®é‡è¦æ€§é«˜ï¼Œä¸èƒ½ä¸¢å¤±å¤ªå¤š
- éœ€è¦å¿«é€Ÿé‡å¯æ¢å¤æœåŠ¡  
- æœåŠ¡å™¨æ€§èƒ½è¾ƒå¥½ï¼Œèƒ½æ‰¿å—ä¸­ç­‰å¼€é”€
- AOFæ–‡ä»¶å¢é•¿è¿‡å¿«ï¼Œéœ€è¦æ§åˆ¶å¤§å°

âŒ ä¸å»ºè®®ä½¿ç”¨çš„åœºæ™¯ï¼š
- å¯¹æ•°æ®ä¸¢å¤±ä¸æ•æ„Ÿçš„ç¼“å­˜åœºæ™¯
- ç£ç›˜ç©ºé—´æåº¦æœ‰é™
- CPUå’ŒIOèµ„æºéå¸¸ç´§å¼ 
- Redisç‰ˆæœ¬ä½äº4.0
```

---

## 4. ğŸ“Š åˆ†çº§å¤‡ä»½ç­–ç•¥


### 4.1 ä»€ä¹ˆæ˜¯åˆ†çº§å¤‡ä»½ï¼Ÿ


**ğŸ’¡ ç†è§£åˆ†çº§å¤‡ä»½**ï¼šå°±åƒ**å¤šå±‚é˜²æŠ¤ç½‘**
```
ä¼ä¸šæ•°æ®ä¿æŠ¤çš„å±‚æ¬¡ï¼š

ğŸ• å®æ—¶ä¿æŠ¤ï¼šæ¯ä¸ªæ“ä½œéƒ½è®°å½• (AOF everysec)
ğŸ“… å®šæœŸå¤‡ä»½ï¼šæ¯å¤©æ™šä¸Šå®Œæ•´å¤‡ä»½ (RDB auto)  
ğŸ“¦ å½’æ¡£ä¿å­˜ï¼šæ¯æœˆå¤‡ä»½æ–‡ä»¶å½’æ¡£å­˜å‚¨
â˜ï¸ å¼‚åœ°å¤‡ä»½ï¼šå¤‡ä»½æ–‡ä»¶ä¸Šä¼ åˆ°å…¶ä»–åœ°åŒº

ç›®çš„ï¼š
- è¿‘æœŸæ•°æ®å¿«é€Ÿæ¢å¤
- å†å²æ•°æ®é•¿æœŸä¿å­˜
- ç¾éš¾æƒ…å†µä¸‹æ•°æ®ä¸ä¸¢å¤±
```

### 4.2 å®æ—¶å¤‡ä»½é…ç½®


**âš¡ AOFå®æ—¶å¤‡ä»½ç­–ç•¥**
```bash
# å®æ—¶å¤‡ä»½é…ç½®
appendonly yes
appendfsync everysec              # æ¯ç§’åŒæ­¥ï¼Œå¹³è¡¡å®‰å…¨å’Œæ€§èƒ½

# å¦‚æœå¯¹æ•°æ®å®‰å…¨è¦æ±‚æé«˜
appendfsync always               # æ¯ä¸ªå†™æ“ä½œéƒ½åŒæ­¥ï¼Œæœ€å®‰å…¨ä½†æ€§èƒ½å·®

# å¦‚æœå¯¹æ€§èƒ½è¦æ±‚æé«˜  
appendfsync no                   # ç”±æ“ä½œç³»ç»Ÿå†³å®šä½•æ—¶åŒæ­¥ï¼Œæ€§èƒ½æœ€å¥½ä½†æœ€ä¸å®‰å…¨
```

**âš ï¸ åŒæ­¥ç­–ç•¥é€‰æ‹©**
- **always**ï¼šé“¶è¡Œè½¬è´¦ã€æ”¯ä»˜ç³»ç»Ÿç­‰ï¼Œæ•°æ®ç»å¯¹ä¸èƒ½ä¸¢
- **everysec**ï¼šå¤§éƒ¨åˆ†ä¸šåŠ¡åœºæ™¯ï¼Œå¹³è¡¡ç‚¹æœ€ä½³
- **no**ï¼šæ—¥å¿—æ”¶é›†ã€ä¸´æ—¶ç¼“å­˜ç­‰ï¼Œä¸¢å¤±å°‘é‡æ•°æ®å¯æ¥å—

### 4.3 å®šæœŸå¤‡ä»½é…ç½®


**ğŸ“… RDBå®šæœŸå¤‡ä»½ç­–ç•¥**
```bash
# å®šæœŸå¤‡ä»½è§¦å‘æ¡ä»¶
save 900 1       # 15åˆ†é’Ÿå†…æœ‰1ä¸ªkeyå˜åŒ– -> é€‚åˆä½é¢‘å†™å…¥
save 300 10      # 5åˆ†é’Ÿå†…æœ‰10ä¸ªkeyå˜åŒ– -> é€‚åˆä¸­é¢‘å†™å…¥
save 60 10000    # 1åˆ†é’Ÿå†…æœ‰10000ä¸ªkeyå˜åŒ– -> é€‚åˆé«˜é¢‘å†™å…¥

# å¤‡ä»½æ–‡ä»¶é…ç½®
dbfilename dump.rdb              # RDBæ–‡ä»¶å
dir /var/lib/redis/              # å¤‡ä»½æ–‡ä»¶å­˜å‚¨ç›®å½•

# å¤‡ä»½è¿‡ç¨‹ä¼˜åŒ–
rdbcompression yes               # å¯ç”¨å‹ç¼©ï¼Œå‡å°æ–‡ä»¶å¤§å°
rdbchecksum yes                  # å¯ç”¨æ ¡éªŒï¼Œç¡®ä¿æ–‡ä»¶å®Œæ•´æ€§
```

### 4.4 å½’æ¡£å¤‡ä»½ç­–ç•¥


**ğŸ“¦ å¤‡ä»½æ–‡ä»¶å½’æ¡£ç®¡ç†**
```bash
#!/bin/bash
# è‡ªåŠ¨å½’æ¡£è„šæœ¬ï¼šredis-archive.sh

DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/backup/redis"
ARCHIVE_DIR="/archive/redis"

# 1. è§¦å‘RDBå¤‡ä»½
redis-cli BGSAVE

# 2. ç­‰å¾…å¤‡ä»½å®Œæˆ
while [ $(redis-cli LASTSAVE) -eq $LASTSAVE ]; do
    sleep 1
done

# 3. å¤åˆ¶å¤‡ä»½æ–‡ä»¶å¹¶é‡å‘½å
cp /var/lib/redis/dump.rdb $BACKUP_DIR/dump_$DATE.rdb

# 4. æ¯å‘¨å½’æ¡£ä¸€æ¬¡
if [ $(date +%w) -eq 0 ]; then  # å‘¨æ—¥
    cp $BACKUP_DIR/dump_$DATE.rdb $ARCHIVE_DIR/
    
    # æ¸…ç†7å¤©å‰çš„æ—¥å¸¸å¤‡ä»½
    find $BACKUP_DIR -name "dump_*.rdb" -mtime +7 -delete
fi

# 5. æ¯æœˆå½’æ¡£ä¸€æ¬¡
if [ $(date +%d) -eq 01 ]; then  # æ¯æœˆ1å·
    tar -czf $ARCHIVE_DIR/redis_monthly_$(date +%Y%m).tar.gz $ARCHIVE_DIR/dump_*.rdb
fi
```

### 4.5 å¼‚åœ°å¤‡ä»½ç­–ç•¥


**â˜ï¸ è¿œç¨‹å¤‡ä»½å®ç°**
```python
import boto3  # AWS S3ç¤ºä¾‹
from datetime import datetime

class RemoteBackupService:
    def __init__(self, aws_access_key, aws_secret_key, bucket_name):
        self.s3 = boto3.client(
            's3',
            aws_access_key_id=aws_access_key,
            aws_secret_access_key=aws_secret_key
        )
        self.bucket = bucket_name
    
    def upload_backup(self, local_file_path, backup_type="daily"):
        """ä¸Šä¼ å¤‡ä»½æ–‡ä»¶åˆ°äº‘å­˜å‚¨"""
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        remote_key = f"redis-backup/{backup_type}/dump_{timestamp}.rdb"
        
        try:
            self.s3.upload_file(local_file_path, self.bucket, remote_key)
            return {"success": True, "remote_path": remote_key}
        except Exception as e:
            return {"success": False, "error": str(e)}
    
    def download_backup(self, remote_key, local_path):
        """ä»äº‘å­˜å‚¨ä¸‹è½½å¤‡ä»½æ–‡ä»¶"""
        try:
            self.s3.download_file(self.bucket, remote_key, local_path)
            return {"success": True}
        except Exception as e:
            return {"success": False, "error": str(e)}

# è‡ªåŠ¨åŒ–å¼‚åœ°å¤‡ä»½
def auto_remote_backup():
    backup_service = RemoteBackupService(aws_key, aws_secret, "my-redis-backup")
    
    # ä¸Šä¼ ä»Šå¤©çš„å¤‡ä»½
    today_backup = f"/backup/redis/dump_{datetime.now().strftime('%Y%m%d')}.rdb"
    result = backup_service.upload_backup(today_backup, "daily")
    
    if result["success"]:
        print("å¼‚åœ°å¤‡ä»½æˆåŠŸ")
    else:
        print(f"å¤‡ä»½å¤±è´¥: {result['error']}")
```

---

## 5. ğŸ“‹ é…ç½®æ¨¡æ¿å®ä¾‹


### 5.1 å¼€å‘ç¯å¢ƒé…ç½®æ¨¡æ¿


**ğŸ’» å¼€å‘ç¯å¢ƒç‰¹ç‚¹**ï¼š**æ€§èƒ½ä¼˜å…ˆ**ï¼Œæ•°æ®ä¸¢å¤±å½±å“å°
```bash
# redis-dev.conf - å¼€å‘ç¯å¢ƒé…ç½®

# åŸºç¡€é…ç½®
port 6379
daemonize yes
logfile /var/log/redis/redis-dev.log

# æŒä¹…åŒ–é…ç½® - æ€§èƒ½ä¼˜å…ˆ
save 60 1000     # é™ä½å¤‡ä»½é¢‘ç‡ï¼Œæå‡æ€§èƒ½
appendonly yes
appendfsync no   # æ€§èƒ½æœ€ä¼˜ï¼Œå…è®¸å°‘é‡æ•°æ®ä¸¢å¤±

# å†…å­˜é…ç½®
maxmemory 1gb
maxmemory-policy allkeys-lru  # å†…å­˜ä¸å¤Ÿæ—¶åˆ é™¤æœ€å°‘ä½¿ç”¨çš„key

# å¼€å‘ä¾¿åˆ©æ€§é…ç½®
timeout 300      # 5åˆ†é’Ÿç©ºé—²è¶…æ—¶
tcp-keepalive 60
```

### 5.2 æµ‹è¯•ç¯å¢ƒé…ç½®æ¨¡æ¿


**ğŸ§ª æµ‹è¯•ç¯å¢ƒç‰¹ç‚¹**ï¼š**æ¨¡æ‹Ÿç”Ÿäº§**ï¼Œä½†èµ„æºæœ‰é™
```bash
# redis-test.conf - æµ‹è¯•ç¯å¢ƒé…ç½®

port 6379
daemonize yes
logfile /var/log/redis/redis-test.log

# æŒä¹…åŒ–é…ç½® - æ¥è¿‘ç”Ÿäº§ç¯å¢ƒ
save 900 1
save 300 10  
save 60 1000
appendonly yes
appendfsync everysec             # å¹³è¡¡æ€§èƒ½å’Œå®‰å…¨
aof-use-rdb-preamble yes        # å¼€å¯æ··åˆæŒä¹…åŒ–

# æµ‹è¯•ç¯å¢ƒç‰¹æ®Šé…ç½®
maxmemory 2gb
maxmemory-policy volatile-lru    # ä¼˜å…ˆåˆ é™¤æœ‰è¿‡æœŸæ—¶é—´çš„key

# è°ƒè¯•é…ç½®
slowlog-log-slower-than 10000    # è®°å½•æ‰§è¡Œè¶…è¿‡10msçš„å‘½ä»¤
slowlog-max-len 128
```

### 5.3 ç”Ÿäº§ç¯å¢ƒé…ç½®æ¨¡æ¿


**ğŸ­ ç”Ÿäº§ç¯å¢ƒç‰¹ç‚¹**ï¼š**ç¨³å®šæ€§ç¬¬ä¸€**ï¼Œæ•°æ®å®‰å…¨æœ€é‡è¦
```bash
# redis-prod.conf - ç”Ÿäº§ç¯å¢ƒé…ç½®

port 6379
daemonize yes
logfile /var/log/redis/redis-prod.log

# æŒä¹…åŒ–é…ç½® - å®‰å…¨ä¼˜å…ˆ
save 900 1       # ä¸¥æ ¼çš„å¤‡ä»½ç­–ç•¥
save 300 10
save 60 10000

appendonly yes
appendfsync everysec            # æ¯ç§’åŒæ­¥ï¼Œæœ€ä½³å®è·µ
aof-use-rdb-preamble yes       # æ··åˆæŒä¹…åŒ–
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

# ç”Ÿäº§ç¯å¢ƒå®‰å…¨é…ç½®
maxmemory 8gb                   # æ ¹æ®æœåŠ¡å™¨å†…å­˜è®¾ç½®
maxmemory-policy noeviction     # å†…å­˜æ»¡æ—¶æ‹’ç»å†™å…¥ï¼Œä¸è‡ªåŠ¨åˆ é™¤æ•°æ®

# ç½‘ç»œå’Œå®‰å…¨
timeout 0                       # ä¸è®¾è¶…æ—¶ï¼Œé¿å…é•¿è¿æ¥æ–­å¼€
tcp-keepalive 300
bind 127.0.0.1 10.0.1.100      # ç»‘å®šç‰¹å®šIP
requirepass your_strong_password # è®¾ç½®å¯†ç 

# ç›‘æ§é…ç½®
slowlog-log-slower-than 1000    # è®°å½•è¶…è¿‡1msçš„æ…¢æŸ¥è¯¢
slowlog-max-len 1000
```

### 5.4 é«˜å¯ç”¨ç¯å¢ƒé…ç½®æ¨¡æ¿


**âš¡ é«˜å¯ç”¨é›†ç¾¤é…ç½®**
```bash
# redis-ha.conf - é«˜å¯ç”¨ç¯å¢ƒé…ç½®

# ä¸»ä»å¤åˆ¶é…ç½®
replicaof 192.168.1.100 6379    # ä»èŠ‚ç‚¹é…ç½®
replica-read-only yes

# æŒä¹…åŒ–é…ç½® - ä¸»ä»éƒ½å¼€å¯
save 900 1
save 300 10
save 60 10000
appendonly yes
appendfsync everysec
aof-use-rdb-preamble yes

# é«˜å¯ç”¨ç‰¹æ®Šé…ç½®
replica-serve-stale-data yes     # ä¸»ä»æ–­çº¿æ—¶ä»èŠ‚ç‚¹ç»§ç»­æœåŠ¡
replica-priority 100             # ä»èŠ‚ç‚¹ä¼˜å…ˆçº§

# å“¨å…µç›¸å…³é…ç½®ï¼ˆå“¨å…µå•ç‹¬é…ç½®æ–‡ä»¶ï¼‰
# sentinel.conf
sentinel monitor mymaster 192.168.1.100 6379 2
sentinel down-after-milliseconds mymaster 5000
sentinel failover-timeout mymaster 60000
sentinel parallel-syncs mymaster 1
```

---

## 6. ğŸ¯ åœºæ™¯åŒ–é€‰æ‹©æŒ‡å—


### 6.1 ä¸šåŠ¡åœºæ™¯åˆ†ç±»é€‰æ‹©


**ğŸª ç”µå•†å¹³å°é€‰æ‹©ç­–ç•¥**
```
ğŸ“Š ä¸šåŠ¡ç‰¹ç‚¹åˆ†æï¼š
- ç”¨æˆ·æ•°æ®ï¼šé‡è¦ï¼Œä¸èƒ½ä¸¢å¤± â†’ AOF every second
- å•†å“ä¿¡æ¯ï¼šé‡è¦ï¼Œä½†å¯å®¹å¿å°‘é‡ä¸¢å¤± â†’ RDB + AOF
- è´­ç‰©è½¦ï¼šä¸´æ—¶æ€§ï¼Œå¯é‡å»º â†’ RDBå³å¯
- è®¢å•æ•°æ®ï¼šæé‡è¦ï¼Œç»å¯¹ä¸èƒ½ä¸¢ â†’ AOF always

é…ç½®å»ºè®®ï¼š
# ç”¨æˆ·æœåŠ¡Redis
appendonly yes
appendfsync everysec
save 900 1

# è´­ç‰©è½¦Redis  
appendonly no    # å…³é—­AOF
save 300 10      # åªç”¨RDB

# è®¢å•æœåŠ¡Redis
appendonly yes
appendfsync always  # æœ€é«˜å®‰å…¨çº§åˆ«
```

### 6.2 æ€§èƒ½ä¸å®‰å…¨å¹³è¡¡


**âš–ï¸ å¹³è¡¡ç­–ç•¥é€‰æ‹©**
```
æ€§èƒ½è¦æ±‚ vs æ•°æ®å®‰å…¨çŸ©é˜µï¼š

                 â”‚ æ€§èƒ½è¦æ±‚ä½ â”‚ æ€§èƒ½è¦æ±‚ä¸­ â”‚ æ€§èƒ½è¦æ±‚é«˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ•°æ®å®‰å…¨è¦æ±‚é«˜     â”‚  AOF alwaysâ”‚ æ··åˆæŒä¹…åŒ–  â”‚  AOF everysec
æ•°æ®å®‰å…¨è¦æ±‚ä¸­     â”‚ æ··åˆæŒä¹…åŒ–  â”‚ AOF everysecâ”‚  RDBé¢‘ç¹
æ•°æ®å®‰å…¨è¦æ±‚ä½     â”‚ AOF everysecâ”‚  RDBä¸­ç­‰   â”‚  RDBç¨€å°‘

é€‰æ‹©é€»è¾‘ï¼š
1. å…ˆè¯„ä¼°æ•°æ®é‡è¦æ€§ï¼šèƒ½æ¥å—ä¸¢å¤±å¤šå°‘æ•°æ®ï¼Ÿ
2. å†è¯„ä¼°æ€§èƒ½éœ€æ±‚ï¼šèƒ½æ¥å—å¤šå°‘å»¶è¿Ÿï¼Ÿ
3. æœ€åè¯„ä¼°èµ„æºé™åˆ¶ï¼šCPUã€å†…å­˜ã€ç£ç›˜å¤Ÿç”¨å—ï¼Ÿ
```

### 6.3 èµ„æºé™åˆ¶ä¸‹çš„é€‰æ‹©


**ğŸ’° èµ„æºæœ‰é™æ—¶çš„ç­–ç•¥**
```
å†…å­˜æœ‰é™ (< 4GB)ï¼š
âœ… ä¼˜å…ˆé€‰æ‹©RDB
âœ… è®¾ç½®maxmemoryç­–ç•¥
âŒ é¿å…AOF always

ç£ç›˜æœ‰é™ (< 100GB)ï¼š
âœ… ä¼˜å…ˆé€‰æ‹©RDB  
âœ… å¼€å¯RDBå‹ç¼©
âŒ é¿å…AOFæˆ–è®¾ç½®å°çš„é‡å†™é˜ˆå€¼

CPUæœ‰é™ (< 4æ ¸)ï¼š
âœ… å‡å°‘RDBè§¦å‘é¢‘ç‡
âœ… AOFç”¨everysecæˆ–no
âŒ é¿å…é¢‘ç¹çš„AOFé‡å†™

ç½‘ç»œå¸¦å®½æœ‰é™ï¼š
âœ… æœ¬åœ°å¤‡ä»½ä¸ºä¸»
âœ… å‹ç¼©åå†ä¼ è¾“
âŒ é¿å…é¢‘ç¹çš„è¿œç¨‹å¤‡ä»½
```

---

## 7. ğŸ› ï¸ å®æˆ˜é…ç½®ç¤ºä¾‹


### 7.1 é…ç½®æ–‡ä»¶ç”Ÿæˆå·¥å…·


**ğŸ”§ è‡ªåŠ¨é…ç½®ç”Ÿæˆå™¨**
```python
class RedisConfigGenerator:
    def __init__(self):
        self.templates = {
            'development': self._dev_template,
            'testing': self._test_template,
            'production': self._prod_template
        }
    
    def generate_config(self, env_type, custom_params=None):
        """ç”Ÿæˆç‰¹å®šç¯å¢ƒçš„é…ç½®æ–‡ä»¶"""
        if env_type not in self.templates:
            raise ValueError(f"ä¸æ”¯æŒçš„ç¯å¢ƒç±»å‹: {env_type}")
            
        config = self.templates[env_type]()
        
        # åº”ç”¨è‡ªå®šä¹‰å‚æ•°
        if custom_params:
            config.update(custom_params)
            
        return self._format_config(config)
    
    def _prod_template(self):
        """ç”Ÿäº§ç¯å¢ƒæ¨¡æ¿"""
        return {
            'port': 6379,
            'daemonize': 'yes',
            'logfile': '/var/log/redis/redis-prod.log',
            'save': ['900 1', '300 10', '60 10000'],
            'appendonly': 'yes',
            'appendfsync': 'everysec',
            'aof-use-rdb-preamble': 'yes',
            'maxmemory': '8gb',
            'maxmemory-policy': 'noeviction',
            'timeout': 0,
            'tcp-keepalive': 300
        }

# ä½¿ç”¨ç¤ºä¾‹
config_gen = RedisConfigGenerator()
prod_config = config_gen.generate_config('production', {
    'maxmemory': '16gb',  # è‡ªå®šä¹‰å†…å­˜å¤§å°
    'requirepass': 'your_password'  # æ·»åŠ å¯†ç 
})

print(prod_config)
```

### 7.2 æŒä¹…åŒ–ç›‘æ§è„šæœ¬


**ğŸ“ˆ ç›‘æ§å¤‡ä»½çŠ¶æ€**
```python
class PersistenceMonitor:
    def __init__(self, redis_client):
        self.redis = redis_client
    
    def check_persistence_status(self):
        """æ£€æŸ¥æŒä¹…åŒ–çŠ¶æ€"""
        info = self.redis.info('persistence')
        
        status = {
            'rdb_enabled': info.get('rdb_last_save_time', 0) > 0,
            'aof_enabled': info.get('aof_enabled', 0) == 1,
            'last_rdb_save': info.get('rdb_last_save_time', 0),
            'aof_file_size': info.get('aof_current_size', 0),
            'aof_rewrite_in_progress': info.get('aof_rewrite_in_progress', 0) == 1
        }
        
        return status
    
    def get_backup_health_score(self):
        """è®¡ç®—å¤‡ä»½å¥åº·åˆ†æ•°"""
        status = self.check_persistence_status()
        score = 0
        
        # RDBæ£€æŸ¥
        if status['rdb_enabled']:
            score += 30
            # æ£€æŸ¥æœ€è¿‘å¤‡ä»½æ—¶é—´
            import time
            last_save = status['last_rdb_save']
            if time.time() - last_save < 3600:  # 1å°æ—¶å†…æœ‰å¤‡ä»½
                score += 20
        
        # AOFæ£€æŸ¥  
        if status['aof_enabled']:
            score += 30
            # æ£€æŸ¥AOFæ–‡ä»¶å¤§å°åˆç†æ€§
            if status['aof_file_size'] < 1024 * 1024 * 100:  # å°äº100MB
                score += 20
        
        return min(score, 100)  # æœ€é«˜100åˆ†

# ç›‘æ§ä½¿ç”¨
monitor = PersistenceMonitor(redis_client)
health_score = monitor.get_backup_health_score()
print(f"å¤‡ä»½å¥åº·åˆ†æ•°: {health_score}/100")

if health_score < 70:
    print("âš ï¸ è­¦å‘Šï¼šå¤‡ä»½é…ç½®å¯èƒ½æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥æŒä¹…åŒ–è®¾ç½®")
```

### 7.3 ç¾éš¾æ¢å¤é¢„æ¡ˆ


**ğŸ†˜ æ•°æ®æ¢å¤æµç¨‹**
```python
class DisasterRecovery:
    def recover_from_files(self, rdb_file=None, aof_file=None):
        """ä»å¤‡ä»½æ–‡ä»¶æ¢å¤æ•°æ®"""
        
        recovery_plan = []
        
        # 1. åœæ­¢RedisæœåŠ¡
        recovery_plan.append("systemctl stop redis")
        
        # 2. æ¸…ç†å½“å‰æ•°æ®ç›®å½•
        recovery_plan.append("rm -f /var/lib/redis/*")
        
        # 3. æ¢å¤æ–‡ä»¶
        if aof_file and os.path.exists(aof_file):
            recovery_plan.append(f"cp {aof_file} /var/lib/redis/appendonly.aof")
            recovery_plan.append("# AOFæ–‡ä»¶æ¢å¤ï¼Œæ•°æ®æœ€å®Œæ•´")
        elif rdb_file and os.path.exists(rdb_file):
            recovery_plan.append(f"cp {rdb_file} /var/lib/redis/dump.rdb")  
            recovery_plan.append("# RDBæ–‡ä»¶æ¢å¤ï¼Œå¯èƒ½ä¸¢å¤±éƒ¨åˆ†æ•°æ®")
        else:
            recovery_plan.append("# é”™è¯¯ï¼šæ²¡æœ‰å¯ç”¨çš„å¤‡ä»½æ–‡ä»¶")
            
        # 4. å¯åŠ¨Redis
        recovery_plan.append("systemctl start redis")
        recovery_plan.append("# æ£€æŸ¥Redisæ—¥å¿—ç¡®è®¤æ¢å¤çŠ¶æ€")
        
        return recovery_plan
    
    def estimate_data_loss(self, backup_timestamp):
        """ä¼°ç®—æ•°æ®ä¸¢å¤±é‡"""
        import time
        current_time = time.time()
        loss_hours = (current_time - backup_timestamp) / 3600
        
        return {
            "loss_time_hours": loss_hours,
            "risk_level": "ä½" if loss_hours < 1 else "ä¸­" if loss_hours < 24 else "é«˜",
            "recommendation": "ç«‹å³æ¢å¤" if loss_hours < 1 else "è¯„ä¼°åæ¢å¤" if loss_hours < 24 else "è°¨æ…æ¢å¤"
        }
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 æŒä¹…åŒ–ç»„åˆç­–ç•¥è®°å¿†è¦ç‚¹


**ğŸ”¸ ä¸‰ç§æ¨¡å¼é€‰æ‹©å£è¯€**
```
å•ç‹¬RDBï¼šç®€å•åœºæ™¯ï¼Œæ€§èƒ½ç¬¬ä¸€  
å•ç‹¬AOFï¼šå®‰å…¨åœºæ™¯ï¼Œæ•°æ®ç¬¬ä¸€
æ··åˆæ¨¡å¼ï¼šå¹³è¡¡åœºæ™¯ï¼Œä¸¤å…¨å…¶ç¾
ç»„åˆä½¿ç”¨ï¼šé‡è¦åœºæ™¯ï¼ŒåŒé‡ä¿é™©
```

### 8.2 é…ç½®å‚æ•°æ ¸å¿ƒè¦ç‚¹


**âš¡ å…³é”®é…ç½®è®°å¿†**
```bash
# å¿…è®°çš„æ ¸å¿ƒé…ç½®
appendonly yes                   # å¼€å¯AOF
appendfsync everysec            # æœ€ä½³å®è·µ
aof-use-rdb-preamble yes       # å¼€å¯æ··åˆæŒä¹…åŒ–  
save 900 1                      # 15åˆ†é’Ÿ1æ¬¡å˜åŒ–å°±å¤‡ä»½

# ç”Ÿäº§ç¯å¢ƒå¿…å¤‡
maxmemory-policy noeviction     # å†…å­˜æ»¡æ—¶ä¸åˆ é™¤æ•°æ®
requirepass strong_password     # è®¾ç½®å¼ºå¯†ç 
bind 127.0.0.1                # ç»‘å®šå®‰å…¨IP
```

### 8.3 æœ€ä½³å®è·µæ€»ç»“


| ç¯å¢ƒç±»å‹ | **æŒä¹…åŒ–ç­–ç•¥** | **æ ¸å¿ƒé…ç½®** | **å¤‡ä»½é¢‘ç‡** | **ç›‘æ§é‡ç‚¹** |
|---------|--------------|-------------|-------------|-------------|
| ğŸ› ï¸ **å¼€å‘** | `RDBä¸ºä¸»` | `æ€§èƒ½ä¼˜å…ˆé…ç½®` | `æ¯å°æ—¶` | `å¯ç”¨æ€§` |
| ğŸ§ª **æµ‹è¯•** | `æ··åˆæŒä¹…åŒ–` | `æ¥è¿‘ç”Ÿäº§é…ç½®` | `æ¯30åˆ†é’Ÿ` | `åŠŸèƒ½éªŒè¯` |
| ğŸ­ **ç”Ÿäº§** | `RDB+AOFåŒä¿é™©` | `å®‰å…¨ä¼˜å…ˆé…ç½®` | `æ¯15åˆ†é’Ÿ+å®æ—¶` | `æ•°æ®å®‰å…¨` |
| âš¡ **é«˜å¯ç”¨** | `ä¸»ä»+æ··åˆæŒä¹…åŒ–` | `é›†ç¾¤ä¸“ç”¨é…ç½®` | `å®æ—¶åŒæ­¥` | `æœåŠ¡è¿ç»­æ€§` |

### 8.4 æ•…éšœå¤„ç†è¦ç‚¹


**ğŸ†˜ å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ**
- **AOFæ–‡ä»¶æŸå** â†’ ä½¿ç”¨`redis-check-aof --fix`ä¿®å¤
- **RDBæ–‡ä»¶æŸå** â†’ ä½¿ç”¨`redis-check-rdb`æ£€æŸ¥ï¼Œä½¿ç”¨å¤‡ä»½æ–‡ä»¶
- **ç£ç›˜ç©ºé—´ä¸è¶³** â†’ æ¸…ç†æ—§å¤‡ä»½ï¼Œè°ƒæ•´é‡å†™é˜ˆå€¼
- **å¤‡ä»½æ—¶é—´è¿‡é•¿** â†’ è°ƒæ•´saveå‚æ•°ï¼Œè€ƒè™‘ä½¿ç”¨SSD

**ğŸ’¡ æ ¸å¿ƒåŸåˆ™**
1. **å®‰å…¨ç¬¬ä¸€**ï¼šé‡è¦æ•°æ®å¿…é¡»æœ‰æŒä¹…åŒ–
2. **é€‚åº¦é…ç½®**ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©åˆé€‚ç­–ç•¥
3. **å®šæœŸæ£€æŸ¥**ï¼šç›‘æ§å¤‡ä»½æ–‡ä»¶å®Œæ•´æ€§
4. **ç¾éš¾é¢„æ¡ˆ**ï¼šæå‰å‡†å¤‡æ¢å¤æµç¨‹
5. **æ¸è¿›å‡çº§**ï¼šä»ç®€å•é…ç½®é€æ­¥ä¼˜åŒ–

é€šè¿‡è¿™å¥—å®Œæ•´çš„æŒä¹…åŒ–ç­–ç•¥ï¼Œä½ å¯ä»¥æ ¹æ®ä¸åŒçš„ä¸šåŠ¡åœºæ™¯å’Œèµ„æºæƒ…å†µï¼Œé€‰æ‹©æœ€åˆé€‚çš„RedisæŒä¹…åŒ–é…ç½®ã€‚è®°ä½ï¼š**æ²¡æœ‰æœ€å¥½çš„é…ç½®ï¼Œåªæœ‰æœ€é€‚åˆçš„é…ç½®ï¼**