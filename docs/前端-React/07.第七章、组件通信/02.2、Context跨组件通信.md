---
title: 2ã€Contextè·¨ç»„ä»¶é€šä¿¡
---
## ğŸ“š ç›®å½•

1. [ContextåŸºæœ¬æ¦‚å¿µ](#1-ContextåŸºæœ¬æ¦‚å¿µ)
2. [è§£å†³çš„æ ¸å¿ƒé—®é¢˜](#2-è§£å†³çš„æ ¸å¿ƒé—®é¢˜)
3. [Contextæ ¸å¿ƒAPIè¯¦è§£](#3-Contextæ ¸å¿ƒAPIè¯¦è§£)
4. [åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹](#4-åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹)
5. [å¤šä¸ªContextä½¿ç”¨](#5-å¤šä¸ªContextä½¿ç”¨)
6. [Contextæ›´æ–°æœºåˆ¶](#6-Contextæ›´æ–°æœºåˆ¶)
7. [æ€§èƒ½å½±å“ä¸ä¼˜åŒ–](#7-æ€§èƒ½å½±å“ä¸ä¼˜åŒ–)
8. [åº”ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ](#8-åº”ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ContextåŸºæœ¬æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯Context

**ç®€å•ç†è§£**ï¼šContextå°±åƒæ˜¯ç»„ä»¶æ ‘ä¸­çš„"**å…¨å±€å˜é‡**"ï¼Œè®©ä½ å¯ä»¥åœ¨ä»»æ„å±‚çº§çš„ç»„ä»¶ä¸­ç›´æ¥è·å–æ•°æ®ï¼Œä¸ç”¨ä¸€å±‚å±‚å¾€ä¸‹ä¼ é€’ã€‚

```
ä¸ç”¨Contextï¼šçˆ·çˆ· â†’ çˆ¸çˆ¸ â†’ å­™å­ (æ•°æ®è¦ä¸€å±‚å±‚ä¼ )
ä½¿ç”¨Contextï¼šçˆ·çˆ· â†â†’ å­™å­ (æ•°æ®ç›´æ¥å…±äº«)
```

### 1.2 Contextçš„æœ¬è´¨

- **æ•°æ®å…±äº«æœºåˆ¶**ï¼šè®©ç»„ä»¶æ ‘ä¸­çš„ä»»æ„ç»„ä»¶éƒ½èƒ½è®¿é—®å…±åŒçš„æ•°æ®
- **è·¨å±‚çº§é€šä¿¡**ï¼šè·³è¿‡ä¸­é—´ç»„ä»¶ï¼Œç›´æ¥åœ¨éœ€è¦çš„ç»„ä»¶ä¸­ä½¿ç”¨æ•°æ®
- **Reactå†…ç½®åŠŸèƒ½**ï¼šä¸éœ€è¦é¢å¤–å®‰è£…åŒ…ï¼ŒReactè‡ªå¸¦çš„åŠŸèƒ½

### 1.3 ä¸ºä»€ä¹ˆéœ€è¦Context

åœ¨å®é™…å¼€å‘ä¸­ï¼Œç»å¸¸é‡åˆ°è¿™ç§æƒ…å†µï¼š

```
åº”ç”¨æ ¹ç»„ä»¶
â”œâ”€â”€ å¤´éƒ¨ç»„ä»¶
â”œâ”€â”€ ä¸»ä½“ç»„ä»¶
â”‚   â”œâ”€â”€ ä¾§è¾¹æ ç»„ä»¶
â”‚   â””â”€â”€ å†…å®¹ç»„ä»¶
â”‚       â””â”€â”€ ç”¨æˆ·ä¿¡æ¯ç»„ä»¶ â† éœ€è¦ç”¨æˆ·æ•°æ®
â””â”€â”€ åº•éƒ¨ç»„ä»¶
```

ç”¨æˆ·ä¿¡æ¯å¯èƒ½åœ¨åº”ç”¨æ ¹ç»„ä»¶ï¼Œä½†è¦ä¼ åˆ°æ·±å±‚çš„ç”¨æˆ·ä¿¡æ¯ç»„ä»¶ï¼Œå°±å¾—ä¸€å±‚å±‚ä¼ é€’ï¼Œå¾ˆéº»çƒ¦ï¼

---

## 2. ğŸ”§ è§£å†³çš„æ ¸å¿ƒé—®é¢˜


### 2.1 Props Drillingé—®é¢˜

**ä»€ä¹ˆæ˜¯Props Drilling**ï¼šæ•°æ®åƒé’»å¤´ä¸€æ ·ï¼Œä¸€å±‚å±‚å¾€ä¸‹é’»ï¼Œä¸­é—´çš„ç»„ä»¶åªæ˜¯"ä¼ è¯ç­’"ï¼Œè‡ªå·±å¹¶ä¸éœ€è¦è¿™äº›æ•°æ®ã€‚

```
ä¼ ç»ŸPropsä¼ é€’çš„ç—›ç‚¹ï¼š

Appç»„ä»¶
 â”œâ”€ user={userData}
 â””â”€ Headerç»„ä»¶ (ä¸éœ€è¦userï¼Œä½†è¦ä¼ é€’)
     â”œâ”€ user={userData}  
     â””â”€ UserMenuç»„ä»¶ (ä¸éœ€è¦userï¼Œä½†è¦ä¼ é€’)
         â”œâ”€ user={userData}
         â””â”€ UserProfileç»„ä»¶ â† çœŸæ­£éœ€è¦userçš„ç»„ä»¶
```

### 2.2 Contextè§£å†³æ–¹æ¡ˆ

```
ä½¿ç”¨Contextåï¼š

Appç»„ä»¶ (æä¾›Context)
 â””â”€ UserContext.Provider
     â”œâ”€ Headerç»„ä»¶ (ä¸ç”¨ç®¡user)
     â””â”€ UserMenuç»„ä»¶ (ä¸ç”¨ç®¡user)  
         â””â”€ UserProfileç»„ä»¶ (ç›´æ¥ä»Contextè·å–user)
```

### 2.3 è§£å†³çš„å…·ä½“åœºæ™¯

- **ğŸ‘¤ ç”¨æˆ·ä¿¡æ¯**ï¼šç™»å½•çŠ¶æ€ã€ç”¨æˆ·èµ„æ–™åœ¨å¤šä¸ªç»„ä»¶ä¸­ä½¿ç”¨
- **ğŸ¨ ä¸»é¢˜åˆ‡æ¢**ï¼šæ·±è‰²/æµ…è‰²ä¸»é¢˜åœ¨æ•´ä¸ªåº”ç”¨ä¸­åˆ‡æ¢
- **ğŸŒ è¯­è¨€å›½é™…åŒ–**ï¼šä¸­æ–‡/è‹±æ–‡åˆ‡æ¢å½±å“æ‰€æœ‰æ–‡æœ¬ç»„ä»¶
- **âš™ï¸ å…¨å±€é…ç½®**ï¼šAPIåœ°å€ã€åº”ç”¨è®¾ç½®ç­‰å…¨å±€å‚æ•°

---

## 3. ğŸ“– Contextæ ¸å¿ƒAPIè¯¦è§£


### 3.1 React.createContextè¯¦è§£

**ä½œç”¨**ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„Contextå¯¹è±¡ï¼Œè¿™æ˜¯ä½¿ç”¨Contextçš„ç¬¬ä¸€æ­¥ã€‚

```javascript
// åŸºæœ¬è¯­æ³•
const MyContext = React.createContext(defaultValue);

// å®é™…ä¾‹å­
const UserContext = React.createContext(null); // é»˜è®¤å€¼ä¸ºnull
const ThemeContext = React.createContext('light'); // é»˜è®¤å€¼ä¸º'light'
```

**æ ¸å¿ƒç†è§£**ï¼š
- `createContext`å°±åƒåˆ›å»ºäº†ä¸€ä¸ª"**æ•°æ®å®¹å™¨**"
- **é»˜è®¤å€¼**ï¼šå½“ç»„ä»¶æ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„Provideræ—¶ä½¿ç”¨çš„å€¼
- è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«`Provider`å’Œ`Consumer`ä¸¤ä¸ªç»„ä»¶

### 3.2 Context.Providerè¯¦è§£

**ä½œç”¨**ï¼šæ•°æ®çš„"**ä¾›åº”å•†**"ï¼Œè´Ÿè´£å‘ä¸‹å±‚ç»„ä»¶æä¾›æ•°æ®ã€‚

```javascript
<UserContext.Provider value={userData}>
  {/* æ‰€æœ‰å­ç»„ä»¶éƒ½å¯ä»¥è®¿é—®userData */}
  <App />
</UserContext.Provider>
```

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
- **valueå±æ€§**ï¼šè¦å…±äº«çš„æ•°æ®ï¼Œå¯ä»¥æ˜¯ä»»ä½•ç±»å‹
- **åŒ…è£¹èŒƒå›´**ï¼šåªæœ‰è¢«ProvideråŒ…è£¹çš„ç»„ä»¶æ‰èƒ½è®¿é—®æ•°æ®
- **åµŒå¥—ä½¿ç”¨**ï¼šå¯ä»¥å¤šå±‚åµŒå¥—ï¼Œå†…å±‚ä¼šè¦†ç›–å¤–å±‚

### 3.3 useContext Hookè¯¦è§£

**ä½œç”¨**ï¼šåœ¨å‡½æ•°ç»„ä»¶ä¸­æ¶ˆè´¹Contextæ•°æ®çš„é’©å­ã€‚

```javascript
// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
function UserProfile() {
  const user = useContext(UserContext); // ç›´æ¥è·å–æ•°æ®
  
  return <div>Hello, {user.name}!</div>;
}
```

**æ ¸å¿ƒç†è§£**ï¼š
- `useContext`å°±åƒæ˜¯"**æ•°æ®æ¥æ”¶å™¨**"
- è‡ªåŠ¨æ‰¾åˆ°æœ€è¿‘çš„Providerè·å–æ•°æ®
- å½“Contextæ•°æ®æ›´æ–°æ—¶ï¼Œç»„ä»¶ä¼šè‡ªåŠ¨é‡æ–°æ¸²æŸ“

### 3.4 Context.Consumerè¯¦è§£

**ä½œç”¨**ï¼šç±»ç»„ä»¶æˆ–éœ€è¦render propsæ¨¡å¼æ—¶ä½¿ç”¨çš„æ•°æ®æ¶ˆè´¹æ–¹å¼ã€‚

```javascript
<UserContext.Consumer>
  {user => (
    <div>Hello, {user.name}!</div>
  )}
</UserContext.Consumer>
```

**ä»€ä¹ˆæ—¶å€™ç”¨**ï¼š
- **ç±»ç»„ä»¶**ï¼šæ²¡æœ‰useContext Hookæ—¶ä½¿ç”¨
- **ç‰¹æ®Šéœ€æ±‚**ï¼šéœ€è¦åœ¨renderå‡½æ•°å¤–æ¶ˆè´¹Contextæ—¶

---

## 4. ğŸ’¡ åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹


### 4.1 åˆ›å»ºå’Œæä¾›Context

```javascript
// 1. åˆ›å»ºContext
const UserContext = React.createContext();

// 2. åœ¨é¡¶å±‚ç»„ä»¶æä¾›æ•°æ®
function App() {
  const [user, setUser] = useState({
    name: 'å¼ ä¸‰',
    avatar: '/avatar.jpg'
  });

  return (
    <UserContext.Provider value={{ user, setUser }}>
      <Header />
      <MainContent />
    </UserContext.Provider>
  );
}
```

### 4.2 æ¶ˆè´¹Contextæ•°æ®

```javascript
// æ–¹å¼1ï¼šä½¿ç”¨useContext Hook (æ¨è)
function UserProfile() {
  const { user } = useContext(UserContext);
  
  return (
    <div>
      <img src={user.avatar} alt="å¤´åƒ" />
      <span>{user.name}</span>
    </div>
  );
}

// æ–¹å¼2ï¼šä½¿ç”¨Consumerç»„ä»¶
function UserProfile() {
  return (
    <UserContext.Consumer>
      {({ user }) => (
        <div>
          <img src={user.avatar} alt="å¤´åƒ" />
          <span>{user.name}</span>
        </div>
      )}
    </UserContext.Consumer>
  );
}
```

### 4.3 å®Œæ•´çš„ä¸»é¢˜åˆ‡æ¢ç¤ºä¾‹

```javascript
// åˆ›å»ºä¸»é¢˜Context
const ThemeContext = React.createContext();

// ä¸»åº”ç”¨ç»„ä»¶
function App() {
  const [theme, setTheme] = useState('light');
  
  const toggleTheme = () => {
    setTheme(theme === 'light' ? 'dark' : 'light');
  };

  return (
    <ThemeContext.Provider value={{ theme, toggleTheme }}>
      <Header />
      <MainPage />
    </ThemeContext.Provider>
  );
}

// ä¸»é¢˜åˆ‡æ¢æŒ‰é’®
function ThemeToggle() {
  const { theme, toggleTheme } = useContext(ThemeContext);
  
  return (
    <button onClick={toggleTheme}>
      å½“å‰ä¸»é¢˜ï¼š{theme === 'light' ? 'æµ…è‰²' : 'æ·±è‰²'}
    </button>
  );
}

// ä½¿ç”¨ä¸»é¢˜çš„ç»„ä»¶
function Card() {
  const { theme } = useContext(ThemeContext);
  
  return (
    <div style={{
      backgroundColor: theme === 'light' ? '#fff' : '#333',
      color: theme === 'light' ? '#000' : '#fff'
    }}>
      å¡ç‰‡å†…å®¹
    </div>
  );
}
```

---

## 5. ğŸ”„ å¤šä¸ªContextä½¿ç”¨


### 5.1 å¤šä¸ªContextçš„ç®¡ç†

å®é™…åº”ç”¨ä¸­ï¼Œé€šå¸¸éœ€è¦å¤šä¸ªContextæ¥ç®¡ç†ä¸åŒç±»å‹çš„æ•°æ®ï¼š

```javascript
// åˆ›å»ºå¤šä¸ªContext
const UserContext = React.createContext();
const ThemeContext = React.createContext();
const LanguageContext = React.createContext();

// åµŒå¥—ä½¿ç”¨å¤šä¸ªProvider
function App() {
  const [user, setUser] = useState(null);
  const [theme, setTheme] = useState('light');
  const [language, setLanguage] = useState('zh');

  return (
    <UserContext.Provider value={{ user, setUser }}>
      <ThemeContext.Provider value={{ theme, setTheme }}>
        <LanguageContext.Provider value={{ language, setLanguage }}>
          <MainApp />
        </LanguageContext.Provider>
      </ThemeContext.Provider>
    </UserContext.Provider>
  );
}
```

### 5.2 ç»„åˆContextçš„ä¼˜åŒ–å†™æ³•

```javascript
// åˆ›å»ºä¸€ä¸ªç»„åˆProviderç»„ä»¶
function AppProviders({ children }) {
  const [user, setUser] = useState(null);
  const [theme, setTheme] = useState('light');
  const [language, setLanguage] = useState('zh');

  return (
    <UserContext.Provider value={{ user, setUser }}>
      <ThemeContext.Provider value={{ theme, setTheme }}>
        <LanguageContext.Provider value={{ language, setLanguage }}>
          {children}
        </LanguageContext.Provider>
      </ThemeContext.Provider>
    </UserContext.Provider>
  );
}

// ä½¿ç”¨
function App() {
  return (
    <AppProviders>
      <MainApp />
    </AppProviders>
  );
}
```

### 5.3 åœ¨ç»„ä»¶ä¸­ä½¿ç”¨å¤šä¸ªContext

```javascript
function UserCard() {
  // å¯ä»¥åŒæ—¶ä½¿ç”¨å¤šä¸ªContext
  const { user } = useContext(UserContext);
  const { theme } = useContext(ThemeContext);
  const { language } = useContext(LanguageContext);

  const getText = (key) => {
    const texts = {
      zh: { hello: 'ä½ å¥½' },
      en: { hello: 'Hello' }
    };
    return texts[language][key];
  };

  return (
    <div style={{
      backgroundColor: theme === 'light' ? '#fff' : '#333',
      color: theme === 'light' ? '#000' : '#fff'
    }}>
      {getText('hello')}, {user?.name}!
    </div>
  );
}
```

---

## 6. âš¡ Contextæ›´æ–°æœºåˆ¶


### 6.1 Contextæ˜¯å¦‚ä½•æ›´æ–°çš„

Contextçš„æ›´æ–°éå¸¸ç®€å•ï¼š**å½“Providerçš„valueå‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰€æœ‰æ¶ˆè´¹è¯¥Contextçš„ç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“**ã€‚

```javascript
function App() {
  const [count, setCount] = useState(0);

  // countå˜åŒ–æ—¶ï¼Œæ‰€æœ‰ä½¿ç”¨CountContextçš„ç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“
  return (
    <CountContext.Provider value={count}>
      <Counter />
      <Display />
    </CountContext.Provider>
  );
}
```

### 6.2 å¯¹è±¡ç±»å‹valueçš„æ³¨æ„äº‹é¡¹

```javascript
// âŒ é”™è¯¯å†™æ³•ï¼šæ¯æ¬¡éƒ½åˆ›å»ºæ–°å¯¹è±¡ï¼Œå¯¼è‡´ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“
function App() {
  const [user, setUser] = useState({ name: 'å¼ ä¸‰' });

  return (
    <UserContext.Provider value={{ user, setUser }}>
      <UserProfile />
    </UserContext.Provider>
  );
}

// âœ… æ­£ç¡®å†™æ³•ï¼šä½¿ç”¨useMemoä¼˜åŒ–
function App() {
  const [user, setUser] = useState({ name: 'å¼ ä¸‰' });
  
  const value = useMemo(() => ({ user, setUser }), [user]);

  return (
    <UserContext.Provider value={value}>
      <UserProfile />
    </UserContext.Provider>
  );
}
```

### 6.3 Contexté»˜è®¤å€¼çš„ä½¿ç”¨æ—¶æœº

```javascript
const UserContext = React.createContext({
  name: 'æ¸¸å®¢',
  isLoggedIn: false
});

// å½“ç»„ä»¶æ²¡æœ‰è¢«ProvideråŒ…è£¹æ—¶ï¼Œä¼šä½¿ç”¨é»˜è®¤å€¼
function UserGreeting() {
  const user = useContext(UserContext); // å¦‚æœæ²¡æœ‰Providerï¼Œè·å–åˆ°é»˜è®¤å€¼
  
  return <div>Hello, {user.name}!</div>; // æ˜¾ç¤º "Hello, æ¸¸å®¢!"
}
```

---

## 7. ğŸš€ æ€§èƒ½å½±å“ä¸ä¼˜åŒ–


### 7.1 Contextçš„æ€§èƒ½ç‰¹ç‚¹

**æ ¸å¿ƒç†è§£**ï¼šContextçš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹æ˜¯**æ‰€æœ‰æ¶ˆè´¹è€…éƒ½ä¼šåœ¨valueå˜åŒ–æ—¶é‡æ–°æ¸²æŸ“**ï¼Œè¿™å¯èƒ½å¸¦æ¥æ€§èƒ½é—®é¢˜ã€‚

```
Contextæ›´æ–°æ—¶çš„æ¸²æŸ“èŒƒå›´ï¼š

Provider (valueå˜åŒ–)
â”œâ”€â”€ ComponentA (ä½¿ç”¨Context) â† é‡æ–°æ¸²æŸ“ âœ“
â”œâ”€â”€ ComponentB (ä¸ä½¿ç”¨Context) â† ä¸ä¼šé‡æ–°æ¸²æŸ“
â””â”€â”€ ComponentC
    â”œâ”€â”€ ComponentD (ä½¿ç”¨Context) â† é‡æ–°æ¸²æŸ“ âœ“  
    â””â”€â”€ ComponentE (ä¸ä½¿ç”¨Context) â† ä¸ä¼šé‡æ–°æ¸²æŸ“
```

### 7.2 é¿å…ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“

```javascript
// âŒ é—®é¢˜ï¼šæ¯æ¬¡æ¸²æŸ“éƒ½åˆ›å»ºæ–°çš„valueå¯¹è±¡
function App() {
  const [user, setUser] = useState(null);
  
  return (
    <UserContext.Provider value={{ user, setUser }}> {/* æ¯æ¬¡éƒ½æ˜¯æ–°å¯¹è±¡ */}
      <MainApp />
    </UserContext.Provider>
  );
}

// âœ… è§£å†³ï¼šä½¿ç”¨useMemoç¼“å­˜value
function App() {
  const [user, setUser] = useState(null);
  
  const contextValue = useMemo(() => {
    return { user, setUser };
  }, [user]); // åªæœ‰userå˜åŒ–æ—¶æ‰åˆ›å»ºæ–°å¯¹è±¡

  return (
    <UserContext.Provider value={contextValue}>
      <MainApp />
    </UserContext.Provider>
  );
}
```

### 7.3 åˆ†ç¦»ä¸åŒå˜åŒ–é¢‘ç‡çš„æ•°æ®

```javascript
// âŒ å°†å˜åŒ–é¢‘ç‡ä¸åŒçš„æ•°æ®æ”¾åœ¨ä¸€èµ·
const AppContext = React.createContext();
function App() {
  const [user, setUser] = useState(null); // å¾ˆå°‘å˜åŒ–
  const [count, setCount] = useState(0);  // ç»å¸¸å˜åŒ–
  
  return (
    <AppContext.Provider value={{ user, setUser, count, setCount }}>
      <MainApp />
    </AppContext.Provider>
  );
}

// âœ… åˆ†ç¦»æˆä¸åŒçš„Context
const UserContext = React.createContext();
const CountContext = React.createContext();

function App() {
  const [user, setUser] = useState(null);
  const [count, setCount] = useState(0);
  
  return (
    <UserContext.Provider value={{ user, setUser }}>
      <CountContext.Provider value={{ count, setCount }}>
        <MainApp />
      </CountContext.Provider>
    </UserContext.Provider>
  );
}
```

---

## 8. ğŸ¯ åº”ç”¨åœºæ™¯ä¸æœ€ä½³å®è·µ


### 8.1 é€‚åˆä½¿ç”¨Contextçš„åœºæ™¯

| åœºæ™¯ | **è¯´æ˜** | **ç¤ºä¾‹** |
|------|---------|---------|
| **ğŸ” ç”¨æˆ·è®¤è¯** | `ç”¨æˆ·ç™»å½•çŠ¶æ€éœ€è¦åœ¨å¤šä¸ªç»„ä»¶ä¸­ä½¿ç”¨` | `ç™»å½•ä¿¡æ¯ã€æƒé™æ§åˆ¶` |
| **ğŸ¨ ä¸»é¢˜åˆ‡æ¢** | `ä¸»é¢˜é…ç½®å½±å“æ•´ä¸ªåº”ç”¨çš„æ ·å¼` | `æ·±è‰²æ¨¡å¼ã€æµ…è‰²æ¨¡å¼` |
| **ğŸŒ å›½é™…åŒ–** | `è¯­è¨€è®¾ç½®å½±å“æ‰€æœ‰æ–‡æœ¬å†…å®¹` | `ä¸­è‹±æ–‡åˆ‡æ¢` |
| **âš™ï¸ å…¨å±€é…ç½®** | `åº”ç”¨çº§åˆ«çš„é…ç½®ä¿¡æ¯` | `APIåœ°å€ã€åŠŸèƒ½å¼€å…³` |
| **ğŸ“± åº”ç”¨çŠ¶æ€** | `éœ€è¦åœ¨å¤šä¸ªé¡µé¢é—´å…±äº«çš„çŠ¶æ€` | `è´­ç‰©è½¦ã€é€šçŸ¥æ¶ˆæ¯` |

### 8.2 ä¸é€‚åˆä½¿ç”¨Contextçš„åœºæ™¯

- **ğŸš« å±€éƒ¨çŠ¶æ€**ï¼šåªåœ¨å•ä¸ªç»„ä»¶å†…ä½¿ç”¨çš„çŠ¶æ€
- **ğŸš« é¢‘ç¹å˜åŒ–**ï¼šé«˜é¢‘æ›´æ–°çš„æ•°æ®ï¼ˆå¦‚è¾“å…¥æ¡†å†…å®¹ï¼‰
- **ğŸš« å¤æ‚çŠ¶æ€**ï¼šéœ€è¦å¤æ‚çŠ¶æ€ç®¡ç†é€»è¾‘ï¼ˆå»ºè®®ç”¨Reduxç­‰ï¼‰

### 8.3 Contextä½¿ç”¨æœ€ä½³å®è·µ

```javascript
// âœ… æœ€ä½³å®è·µç¤ºä¾‹ï¼šç”¨æˆ·è®¤è¯Context
const AuthContext = React.createContext();

// 1. åˆ›å»ºä¸“é—¨çš„Providerç»„ä»¶
export function AuthProvider({ children }) {
  const [user, setUser] = useState(null);
  const [loading, setLoading] = useState(true);

  // 2. æä¾›æœ‰æ„ä¹‰çš„æ–¹æ³•
  const login = async (credentials) => {
    setLoading(true);
    try {
      const userData = await authAPI.login(credentials);
      setUser(userData);
    } finally {
      setLoading(false);
    }
  };

  const logout = () => {
    setUser(null);
    localStorage.removeItem('token');
  };

  // 3. ä½¿ç”¨useMemoä¼˜åŒ–æ€§èƒ½
  const value = useMemo(() => ({
    user,
    loading,
    login,
    logout,
    isLoggedIn: !!user
  }), [user, loading]);

  return (
    <AuthContext.Provider value={value}>
      {children}
    </AuthContext.Provider>
  );
}

// 4. åˆ›å»ºè‡ªå®šä¹‰Hookç®€åŒ–ä½¿ç”¨
export function useAuth() {
  const context = useContext(AuthContext);
  if (!context) {
    throw new Error('useAuthå¿…é¡»åœ¨AuthProviderå†…ä½¿ç”¨');
  }
  return context;
}

// 5. ä½¿ç”¨ç¤ºä¾‹
function LoginButton() {
  const { login, logout, isLoggedIn } = useAuth();
  
  return (
    <button onClick={isLoggedIn ? logout : login}>
      {isLoggedIn ? 'é€€å‡º' : 'ç™»å½•'}
    </button>
  );
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 Contextæ ¸å¿ƒæ¦‚å¿µå›é¡¾

```
ğŸ¯ Contextæœ¬è´¨ï¼šç»„ä»¶æ ‘ä¸­çš„"å…¨å±€å˜é‡"ï¼Œå®ç°è·¨å±‚çº§æ•°æ®å…±äº«
ğŸ”§ è§£å†³é—®é¢˜ï¼šé¿å…Propså±‚å±‚ä¼ é€’ï¼ˆProps Drillingï¼‰
ğŸ“¦ æ ¸å¿ƒAPIï¼šcreateContextã€Providerã€useContextã€Consumer
âš¡ æ›´æ–°æœºåˆ¶ï¼šProviderçš„valueå˜åŒ–æ—¶ï¼Œæ‰€æœ‰æ¶ˆè´¹è€…é‡æ–°æ¸²æŸ“
ğŸš€ æ€§èƒ½ä¼˜åŒ–ï¼šä½¿ç”¨useMemoç¼“å­˜valueï¼Œåˆ†ç¦»ä¸åŒå˜åŒ–é¢‘ç‡çš„æ•°æ®
```

### 9.2 ä½¿ç”¨Contextçš„ä¸‰ä¸ªæ­¥éª¤

```javascript
// æ­¥éª¤1ï¼šåˆ›å»ºContext
const MyContext = React.createContext(defaultValue);

// æ­¥éª¤2ï¼šæä¾›æ•°æ®
<MyContext.Provider value={data}>
  <App />
</MyContext.Provider>

// æ­¥éª¤3ï¼šæ¶ˆè´¹æ•°æ®
const data = useContext(MyContext);
```

### 9.3 ä½•æ—¶ä½¿ç”¨Context

**âœ… é€‚åˆçš„åœºæ™¯**ï¼š
- æ•°æ®éœ€è¦åœ¨**å¤šä¸ªå±‚çº§**çš„ç»„ä»¶ä¸­ä½¿ç”¨
- æ•°æ®**å˜åŒ–é¢‘ç‡è¾ƒä½**ï¼ˆå¦‚ç”¨æˆ·ä¿¡æ¯ã€ä¸»é¢˜ï¼‰
- é¿å…**Propså±‚å±‚ä¼ é€’**çš„ç¹ç

**âŒ ä¸é€‚åˆçš„åœºæ™¯**ï¼š
- åªåœ¨**å•ä¸ªç»„ä»¶å†…**ä½¿ç”¨çš„çŠ¶æ€
- **é«˜é¢‘å˜åŒ–**çš„æ•°æ®
- éœ€è¦**å¤æ‚çŠ¶æ€ç®¡ç†**é€»è¾‘

### 9.4 è®°å¿†è¦ç‚¹

```
Contextä¸‰å…„å¼Ÿï¼šåˆ›å»º â†’ æä¾› â†’ æ¶ˆè´¹
æ€§èƒ½ä¼˜åŒ–ï¼šuseMemoåŒ…è£…valueï¼Œé¿å…æ— æ„ä¹‰é‡æ¸²æŸ“
æœ€ä½³å®è·µï¼šä¸“é—¨çš„Providerç»„ä»¶ + è‡ªå®šä¹‰Hook
ä½¿ç”¨åŸåˆ™ï¼šå…¨å±€å…±äº«çš„ã€å˜åŒ–è¾ƒå°‘çš„æ•°æ®æ‰ç”¨Context
```

**ğŸ¯ æ ¸å¿ƒç†è§£**ï¼šContextå°±åƒæ˜¯Reactç»„ä»¶æ ‘ä¸­çš„"**æ•°æ®é«˜é€Ÿå…¬è·¯**"ï¼Œè®©æ•°æ®å¯ä»¥ç›´è¾¾ç›®çš„åœ°ï¼Œä¸ç”¨åœ¨æ¯ä¸ªæ”¶è´¹ç«™ï¼ˆä¸­é—´ç»„ä»¶ï¼‰éƒ½åœä¸‹æ¥äº¤è´¹ï¼ˆä¼ é€’propsï¼‰ï¼