---
title: 2ã€æµ‹è¯•åŸºç¡€ä¸å®è·µ
---
## ğŸ“š ç›®å½•

1. [æµ‹è¯•çš„é‡è¦æ€§ä¸åˆ†ç±»](#1-æµ‹è¯•çš„é‡è¦æ€§ä¸åˆ†ç±»)
2. [Jestæµ‹è¯•æ¡†æ¶åŸºç¡€](#2-Jestæµ‹è¯•æ¡†æ¶åŸºç¡€)
3. [React Testing Libraryæ ¸å¿ƒ](#3-React-Testing-Libraryæ ¸å¿ƒ)
4. [å•å…ƒæµ‹è¯•å®æˆ˜](#4-å•å…ƒæµ‹è¯•å®æˆ˜)
5. [é›†æˆæµ‹è¯•ä¸MockæŠ€æœ¯](#5-é›†æˆæµ‹è¯•ä¸MockæŠ€æœ¯)
6. [å¼‚æ­¥æµ‹è¯•ä¸ç”¨æˆ·äº¤äº’](#6-å¼‚æ­¥æµ‹è¯•ä¸ç”¨æˆ·äº¤äº’)
7. [æµ‹è¯•è¦†ç›–ç‡ä¸æœ€ä½³å®è·µ](#7-æµ‹è¯•è¦†ç›–ç‡ä¸æœ€ä½³å®è·µ)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ æµ‹è¯•çš„é‡è¦æ€§ä¸åˆ†ç±»


### 1.1 ä¸ºä»€ä¹ˆè¦å†™æµ‹è¯•


**ğŸ¤” æµ‹è¯•å°±åƒä½“æ£€**
```
æ²¡æœ‰æµ‹è¯•çš„ä»£ç  = æ²¡æœ‰ä½“æ£€çš„èº«ä½“
- ä¸çŸ¥é“å“ªé‡Œå‡ºé—®é¢˜
- ä¿®æ”¹æ—¶å¿ƒé‡Œæ²¡åº•
- ä¸Šçº¿åå¯èƒ½å´©æºƒ
```

**ğŸ“ˆ æµ‹è¯•çš„æ ¸å¿ƒä»·å€¼**
- **ä¿è¯è´¨é‡**ï¼šä»£ç æŒ‰é¢„æœŸå·¥ä½œ
- **å¿«é€Ÿåé¦ˆ**ï¼šç«‹å³çŸ¥é“æ”¹åŠ¨æ˜¯å¦ç ´åäº†åŠŸèƒ½
- **é‡æ„ä¿éšœ**ï¼šæ”¾å¿ƒåœ°ä¼˜åŒ–ä»£ç 
- **æ–‡æ¡£ä½œç”¨**ï¼šæµ‹è¯•ç”¨ä¾‹å°±æ˜¯æ´»æ–‡æ¡£

### 1.2 æµ‹è¯•åˆ†ç±»è¯¦è§£


**ğŸ” æµ‹è¯•é‡‘å­—å¡”ç»“æ„**
```
       /\
      /UI\     â† ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆå°‘é‡ï¼‰
     /____\
    /é›†æˆæµ‹è¯•\   â† é›†æˆæµ‹è¯•ï¼ˆé€‚é‡ï¼‰
   /________\
  /å•å…ƒæµ‹è¯•æµ‹è¯•\ â† å•å…ƒæµ‹è¯•ï¼ˆå¤§é‡ï¼‰
 /__________\
```

**ğŸ¯ ä¸‰ç§æµ‹è¯•ç±»å‹å¯¹æ¯”**

| æµ‹è¯•ç±»å‹ | **æµ‹è¯•èŒƒå›´** | **æ‰§è¡Œé€Ÿåº¦** | **ç»´æŠ¤æˆæœ¬** | **å‘ç°é—®é¢˜ç²¾åº¦** |
|---------|------------|------------|------------|---------------|
| **å•å…ƒæµ‹è¯•** | `å•ä¸ªå‡½æ•°/ç»„ä»¶` | `æå¿«` | `ä½` | `é«˜` |
| **é›†æˆæµ‹è¯•** | `å¤šä¸ªç»„ä»¶äº¤äº’` | `è¾ƒå¿«` | `ä¸­` | `ä¸­` |
| **ç«¯åˆ°ç«¯æµ‹è¯•** | `å®Œæ•´ç”¨æˆ·æµç¨‹` | `æ…¢` | `é«˜` | `ä½` |

### 1.3 Reactä¸­çš„æµ‹è¯•æ€ç»´


**ğŸ§  æµ‹è¯•æ€ç»´è½¬æ¢**
```
ä¼ ç»Ÿæ€ç»´ï¼šå†™å®Œä»£ç å†æµ‹è¯•
Reactæ€ç»´ï¼šè¾¹å†™ä»£ç è¾¹æµ‹è¯•

âŒ æ—§æ–¹å¼ï¼š
1. å†™ç»„ä»¶
2. æ‰‹åŠ¨ç‚¹å‡»æµ‹è¯•
3. å‘ç°bugä¿®å¤
4. é‡å¤æ‰‹åŠ¨æµ‹è¯•

âœ… æ–°æ–¹å¼ï¼š
1. å†™æµ‹è¯•ç”¨ä¾‹
2. å†™ç»„ä»¶å®ç°
3. è¿è¡Œæµ‹è¯•
4. è‡ªåŠ¨éªŒè¯åŠŸèƒ½
```

---

## 2. âš¡ Jestæµ‹è¯•æ¡†æ¶åŸºç¡€


### 2.1 Jestæ˜¯ä»€ä¹ˆ


**ğŸª Jest = JavaScriptçš„æµ‹è¯•æ¸¸ä¹åœº**
```
Jestæ˜¯Facebookå¼€å‘çš„JavaScriptæµ‹è¯•æ¡†æ¶
ç‰¹ç‚¹ï¼š
- é›¶é…ç½®ï¼šå¼€ç®±å³ç”¨
- å¿«ç…§æµ‹è¯•ï¼šè‡ªåŠ¨å¯¹æ¯”UIå˜åŒ–
- å¹¶è¡Œæ‰§è¡Œï¼šæµ‹è¯•é€Ÿåº¦å¿«
- å†…ç½®æ–­è¨€ï¼šä¸éœ€è¦é¢å¤–åº“
```

### 2.2 Jestæ ¸å¿ƒæ¦‚å¿µ


**ğŸ“ æµ‹è¯•æ–‡ä»¶å‘½åè§„åˆ™**
```
âœ… æ­£ç¡®çš„æµ‹è¯•æ–‡ä»¶åï¼š
Button.test.js        â† æ¨èæ ¼å¼
Button.spec.js        â† ä¹Ÿå¯ä»¥
__tests__/Button.js   â† ä¸“é—¨çš„æµ‹è¯•ç›®å½•

âŒ é”™è¯¯çš„æ–‡ä»¶åï¼š
ButtonTest.js         â† Jestæ‰¾ä¸åˆ°
test-button.js        â† ä¸ç¬¦åˆè§„èŒƒ
```

**ğŸ”§ åŸºç¡€æµ‹è¯•ç»“æ„**
```javascript
// æè¿°æµ‹è¯•ç»„ï¼šè¿™æ˜¯åœ¨æµ‹è¯•ä»€ä¹ˆ
describe('è®¡ç®—å™¨åŠŸèƒ½', () => {
  // å…·ä½“æµ‹è¯•ç”¨ä¾‹ï¼šæœŸæœ›ä»€ä¹ˆç»“æœ
  test('2 + 2 åº”è¯¥ç­‰äº 4', () => {
    // æ‰§è¡Œä»£ç 
    const result = 2 + 2;
    // æ–­è¨€ç»“æœ
    expect(result).toBe(4);
  });
});
```

### 2.3 å¸¸ç”¨æ–­è¨€æ–¹æ³•


**ğŸ¯ Jestæ–­è¨€é€ŸæŸ¥**
```javascript
// ç›¸ç­‰æ€§æ–­è¨€
expect(value).toBe(4);              // ä¸¥æ ¼ç›¸ç­‰ ===
expect(object).toEqual({name: 'Tom'}); // å¯¹è±¡å†…å®¹ç›¸ç­‰

// çœŸå‡æ€§æ–­è¨€
expect(value).toBeTruthy();         // çœŸå€¼
expect(value).toBeFalsy();          // å‡å€¼
expect(value).toBeNull();           // null
expect(value).toBeUndefined();      // undefined

// æ•°å€¼æ–­è¨€
expect(value).toBeGreaterThan(3);   // å¤§äº
expect(value).toBeCloseTo(0.3);     // æµ®ç‚¹æ•°è¿‘ä¼¼

// å­—ç¬¦ä¸²æ–­è¨€
expect('hello world').toMatch(/world/); // æ­£åˆ™åŒ¹é…
expect('hello').toContain('ell');       // åŒ…å«å­ä¸²

// æ•°ç»„æ–­è¨€
expect(['a', 'b', 'c']).toContain('b'); // åŒ…å«å…ƒç´ 
expect(arr).toHaveLength(3);            // é•¿åº¦
```

### 2.4 æµ‹è¯•ç¯å¢ƒé…ç½®


**âš™ï¸ åŸºç¡€é…ç½®æ–‡ä»¶**
```javascript
// jest.config.js
module.exports = {
  // æµ‹è¯•ç¯å¢ƒ
  testEnvironment: 'jsdom',
  
  // æµ‹è¯•æ–‡ä»¶åŒ¹é…
  testMatch: [
    '**/__tests__/**/*.js',
    '**/*.test.js'
  ],
  
  // å¿½ç•¥çš„æ–‡ä»¶
  testPathIgnorePatterns: [
    '/node_modules/',
    '/build/'
  ],
  
  // è¦†ç›–ç‡é…ç½®
  collectCoverageFrom: [
    'src/**/*.{js,jsx}',
    '!src/index.js'
  ]
};
```

---

## 3. ğŸ§ª React Testing Libraryæ ¸å¿ƒ


### 3.1 ä»€ä¹ˆæ˜¯React Testing Library


**ğŸ­ ä»ç”¨æˆ·è§’åº¦æµ‹è¯•Reactç»„ä»¶**
```
React Testing Libraryçš„æ ¸å¿ƒç†å¿µï¼š
"æµ‹è¯•åº”è¯¥åƒç”¨æˆ·ä½¿ç”¨åº”ç”¨ä¸€æ ·"

âŒ ä¸è¦æµ‹è¯•ï¼šç»„ä»¶å†…éƒ¨å®ç°
âœ… åº”è¯¥æµ‹è¯•ï¼šç”¨æˆ·çœ‹åˆ°ä»€ä¹ˆã€èƒ½åšä»€ä¹ˆ
```

**ğŸ” ä¸Enzymeçš„åŒºåˆ«**
```
Enzymeï¼ˆæ—§æ–¹å¼ï¼‰ï¼š
- æµ‹è¯•ç»„ä»¶å†…éƒ¨çŠ¶æ€
- æµ‹è¯•ç»„ä»¶æ–¹æ³•
- å…³æ³¨å®ç°ç»†èŠ‚

React Testing Libraryï¼ˆæ–°æ–¹å¼ï¼‰ï¼š
- æµ‹è¯•æ¸²æŸ“ç»“æœ
- æµ‹è¯•ç”¨æˆ·äº¤äº’
- å…³æ³¨ç”¨æˆ·ä½“éªŒ
```

### 3.2 æ ¸å¿ƒæŸ¥è¯¢æ–¹æ³•


**ğŸ¯ æŸ¥è¯¢ä¼˜å…ˆçº§ï¼ˆé‡è¦ï¼ï¼‰**
```
ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼š

1. getByRole     â† æœ€æ¨èï¼Œè¯­ä¹‰åŒ–å¼º
2. getByLabelText â† è¡¨å•å…ƒç´ é¦–é€‰
3. getByText     â† æŸ¥æ‰¾æ˜¾ç¤ºæ–‡æœ¬
4. getByTestId   â† æœ€åé€‰æ‹©
```

**ğŸ“ æŸ¥è¯¢æ–¹æ³•è¯¦è§£**
```javascript
import { render, screen } from '@testing-library/react';

function App() {
  return (
    <div>
      <h1>æ¬¢è¿ä½¿ç”¨</h1>
      <button>ç‚¹å‡»æˆ‘</button>
      <input aria-label="ç”¨æˆ·å" />
      <span data-testid="status">å·²ç™»å½•</span>
    </div>
  );
}

// ä¸åŒæŸ¥è¯¢æ–¹å¼
test('æŸ¥è¯¢å…ƒç´ çš„å„ç§æ–¹æ³•', () => {
  render(<App />);
  
  // 1. æŒ‰è§’è‰²æŸ¥è¯¢ï¼ˆæœ€æ¨èï¼‰
  const button = screen.getByRole('button', { name: 'ç‚¹å‡»æˆ‘' });
  const heading = screen.getByRole('heading', { name: 'æ¬¢è¿ä½¿ç”¨' });
  
  // 2. æŒ‰æ ‡ç­¾æŸ¥è¯¢
  const input = screen.getByLabelText('ç”¨æˆ·å');
  
  // 3. æŒ‰æ–‡æœ¬æŸ¥è¯¢
  const title = screen.getByText('æ¬¢è¿ä½¿ç”¨');
  
  // 4. æŒ‰æµ‹è¯•IDæŸ¥è¯¢ï¼ˆæœ€åé€‰æ‹©ï¼‰
  const status = screen.getByTestId('status');
});
```

### 3.3 æŸ¥è¯¢å˜ä½“è¯´æ˜


**ğŸ”„ ä¸‰ç§æŸ¥è¯¢å˜ä½“**
```javascript
// getBy - æ‰¾åˆ°ä¸€ä¸ªï¼Œæ‰¾ä¸åˆ°æˆ–æ‰¾åˆ°å¤šä¸ªéƒ½æŠ¥é”™
const button = screen.getByRole('button');

// queryBy - æ‰¾åˆ°ä¸€ä¸ªæˆ–nullï¼Œæ‰¾åˆ°å¤šä¸ªæŠ¥é”™
const button = screen.queryByRole('button');
if (button) {
  // å…ƒç´ å­˜åœ¨çš„é€»è¾‘
}

// findBy - å¼‚æ­¥æŸ¥æ‰¾ï¼Œè¿”å›Promise
const button = await screen.findByRole('button');

// æŸ¥æ‰¾å¤šä¸ªå…ƒç´ 
const buttons = screen.getAllByRole('button'); // æ•°ç»„
const buttons = screen.queryAllByRole('button'); // æ•°ç»„æˆ–[]
const buttons = await screen.findAllByRole('button'); // Promise<æ•°ç»„>
```

---

## 4. ğŸ§© å•å…ƒæµ‹è¯•å®æˆ˜


### 4.1 ç®€å•ç»„ä»¶æµ‹è¯•


**ğŸ‘¶ ä»æœ€ç®€å•çš„ç»„ä»¶å¼€å§‹**
```javascript
// components/Welcome.js
function Welcome({ name }) {
  return <h1>ä½ å¥½, {name}!</h1>;
}

export default Welcome;
```

```javascript
// components/Welcome.test.js
import { render, screen } from '@testing-library/react';
import Welcome from './Welcome';

describe('Welcomeç»„ä»¶', () => {
  test('æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯', () => {
    // æ¸²æŸ“ç»„ä»¶
    render(<Welcome name="å¼ ä¸‰" />);
    
    // éªŒè¯æ¸²æŸ“ç»“æœ
    expect(screen.getByText('ä½ å¥½, å¼ ä¸‰!')).toBeInTheDocument();
  });
  
  test('å¤„ç†ç©ºåå­—', () => {
    render(<Welcome name="" />);
    expect(screen.getByText('ä½ å¥½, !')).toBeInTheDocument();
  });
});
```

### 4.2 æœ‰çŠ¶æ€ç»„ä»¶æµ‹è¯•


**ğŸ›ï¸ æµ‹è¯•çŠ¶æ€å˜åŒ–**
```javascript
// components/Counter.js
import { useState } from 'react';

function Counter() {
  const [count, setCount] = useState(0);
  
  return (
    <div>
      <span>è®¡æ•°: {count}</span>
      <button onClick={() => setCount(count + 1)}>
        å¢åŠ 
      </button>
      <button onClick={() => setCount(0)}>
        é‡ç½®
      </button>
    </div>
  );
}

export default Counter;
```

```javascript
// components/Counter.test.js
import { render, screen } from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import Counter from './Counter';

describe('Counterç»„ä»¶', () => {
  test('åˆå§‹è®¡æ•°ä¸º0', () => {
    render(<Counter />);
    expect(screen.getByText('è®¡æ•°: 0')).toBeInTheDocument();
  });
  
  test('ç‚¹å‡»å¢åŠ æŒ‰é’®', async () => {
    const user = userEvent.setup();
    render(<Counter />);
    
    const increaseButton = screen.getByRole('button', { name: 'å¢åŠ ' });
    
    // ç‚¹å‡»æŒ‰é’®
    await user.click(increaseButton);
    expect(screen.getByText('è®¡æ•°: 1')).toBeInTheDocument();
    
    // å†æ¬¡ç‚¹å‡»
    await user.click(increaseButton);
    expect(screen.getByText('è®¡æ•°: 2')).toBeInTheDocument();
  });
  
  test('ç‚¹å‡»é‡ç½®æŒ‰é’®', async () => {
    const user = userEvent.setup();
    render(<Counter />);
    
    // å…ˆå¢åŠ å‡ æ¬¡
    const increaseButton = screen.getByRole('button', { name: 'å¢åŠ ' });
    await user.click(increaseButton);
    await user.click(increaseButton);
    
    // ç„¶åé‡ç½®
    const resetButton = screen.getByRole('button', { name: 'é‡ç½®' });
    await user.click(resetButton);
    
    expect(screen.getByText('è®¡æ•°: 0')).toBeInTheDocument();
  });
});
```

### 4.3 è¡¨å•ç»„ä»¶æµ‹è¯•


**ğŸ“ æµ‹è¯•ç”¨æˆ·è¾“å…¥**
```javascript
// components/LoginForm.js
import { useState } from 'react';

function LoginForm({ onSubmit }) {
  const [username, setUsername] = useState('');
  const [password, setPassword] = useState('');
  
  const handleSubmit = (e) => {
    e.preventDefault();
    onSubmit({ username, password });
  };
  
  return (
    <form onSubmit={handleSubmit}>
      <input
        type="text"
        placeholder="ç”¨æˆ·å"
        value={username}
        onChange={(e) => setUsername(e.target.value)}
      />
      <input
        type="password"
        placeholder="å¯†ç "
        value={password}
        onChange={(e) => setPassword(e.target.value)}
      />
      <button type="submit">ç™»å½•</button>
    </form>
  );
}

export default LoginForm;
```

```javascript
// components/LoginForm.test.js
import { render, screen } from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import LoginForm from './LoginForm';

describe('LoginFormç»„ä»¶', () => {
  test('ç”¨æˆ·å¯ä»¥è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ', async () => {
    const user = userEvent.setup();
    render(<LoginForm onSubmit={() => {}} />);
    
    const usernameInput = screen.getByPlaceholderText('ç”¨æˆ·å');
    const passwordInput = screen.getByPlaceholderText('å¯†ç ');
    
    // è¾“å…¥ç”¨æˆ·å
    await user.type(usernameInput, 'testuser');
    expect(usernameInput).toHaveValue('testuser');
    
    // è¾“å…¥å¯†ç 
    await user.type(passwordInput, 'password123');
    expect(passwordInput).toHaveValue('password123');
  });
  
  test('æäº¤è¡¨å•è°ƒç”¨onSubmit', async () => {
    const user = userEvent.setup();
    const mockSubmit = jest.fn(); // Mockå‡½æ•°
    
    render(<LoginForm onSubmit={mockSubmit} />);
    
    // å¡«å†™è¡¨å•
    await user.type(screen.getByPlaceholderText('ç”¨æˆ·å'), 'testuser');
    await user.type(screen.getByPlaceholderText('å¯†ç '), 'password123');
    
    // æäº¤è¡¨å•
    await user.click(screen.getByRole('button', { name: 'ç™»å½•' }));
    
    // éªŒè¯onSubmitè¢«è°ƒç”¨
    expect(mockSubmit).toHaveBeenCalledWith({
      username: 'testuser',
      password: 'password123'
    });
  });
});
```

---

## 5. ğŸ”— é›†æˆæµ‹è¯•ä¸MockæŠ€æœ¯


### 5.1 ä»€ä¹ˆæ˜¯é›†æˆæµ‹è¯•


**ğŸ¤ æµ‹è¯•ç»„ä»¶ä¹‹é—´çš„é…åˆ**
```
å•å…ƒæµ‹è¯•ï¼šæµ‹è¯•ä¸€ä¸ªç»„ä»¶
é›†æˆæµ‹è¯•ï¼šæµ‹è¯•å¤šä¸ªç»„ä»¶ä¸€èµ·å·¥ä½œ

å°±åƒæµ‹è¯•ä¹é˜Ÿï¼š
å•å…ƒæµ‹è¯• = æµ‹è¯•æ¯ä¸ªä¹æ‰‹å•ç‹¬æ¼”å¥
é›†æˆæµ‹è¯• = æµ‹è¯•æ•´ä¸ªä¹é˜Ÿåˆå¥
```

### 5.2 MockæŠ€æœ¯åŸºç¡€


**ğŸ­ Mock = æ›¿èº«æ¼”å‘˜**
```javascript
// ä»€ä¹ˆæ—¶å€™éœ€è¦Mockï¼Ÿ
1. ç½‘ç»œè¯·æ±‚ - ä¸æƒ³çœŸçš„å‘è¯·æ±‚
2. å¤–éƒ¨ä¾èµ– - ç¬¬ä¸‰æ–¹åº“
3. å¤æ‚é€»è¾‘ - ä¸“æ³¨æµ‹è¯•ç›®æ ‡åŠŸèƒ½
4. éšæœºæ•°æ® - è®©æµ‹è¯•ç»“æœå¯é¢„æµ‹
```

**ğŸ“ Mockå‡½æ•°åŸºç¡€**
```javascript
describe('Mockå‡½æ•°ç¤ºä¾‹', () => {
  test('Mockå‡½æ•°çš„åŸºæœ¬ç”¨æ³•', () => {
    // åˆ›å»ºMockå‡½æ•°
    const mockFn = jest.fn();
    
    // è®¾ç½®è¿”å›å€¼
    mockFn.mockReturnValue('hello');
    
    // è°ƒç”¨å‡½æ•°
    const result = mockFn('test');
    
    // éªŒè¯è°ƒç”¨å’Œè¿”å›å€¼
    expect(mockFn).toHaveBeenCalledWith('test');
    expect(result).toBe('hello');
  });
  
  test('Mockå®ç°', () => {
    const mockCallback = jest.fn((x) => x * 2);
    
    [1, 2, 3].forEach(mockCallback);
    
    // éªŒè¯è°ƒç”¨æ¬¡æ•°
    expect(mockCallback).toHaveBeenCalledTimes(3);
    
    // éªŒè¯æ¯æ¬¡è°ƒç”¨çš„å‚æ•°
    expect(mockCallback).toHaveBeenNthCalledWith(1, 1);
    expect(mockCallback).toHaveBeenNthCalledWith(2, 2);
    expect(mockCallback).toHaveBeenNthCalledWith(3, 3);
  });
});
```

### 5.3 Mockæ¨¡å—å’ŒAPI


**ğŸŒ Mockç½‘ç»œè¯·æ±‚**
```javascript
// services/api.js
export async function fetchUser(id) {
  const response = await fetch(`/api/users/${id}`);
  return response.json();
}
```

```javascript
// components/UserProfile.test.js
import { render, screen, waitFor } from '@testing-library/react';
import UserProfile from './UserProfile';
import * as api from '../services/api';

// Mockæ•´ä¸ªAPIæ¨¡å—
jest.mock('../services/api');
const mockApi = api as jest.Mocked<typeof api>;

describe('UserProfileç»„ä»¶', () => {
  test('æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯', async () => {
    // è®¾ç½®Mockè¿”å›æ•°æ®
    mockApi.fetchUser.mockResolvedValue({
      id: 1,
      name: 'å¼ ä¸‰',
      email: 'zhangsan@example.com'
    });
    
    render(<UserProfile userId={1} />);
    
    // ç­‰å¾…å¼‚æ­¥æ•°æ®åŠ è½½
    await waitFor(() => {
      expect(screen.getByText('å¼ ä¸‰')).toBeInTheDocument();
    });
    
    expect(screen.getByText('zhangsan@example.com')).toBeInTheDocument();
  });
  
  test('å¤„ç†åŠ è½½é”™è¯¯', async () => {
    // Mockè¯·æ±‚å¤±è´¥
    mockApi.fetchUser.mockRejectedValue(new Error('ç½‘ç»œé”™è¯¯'));
    
    render(<UserProfile userId={1} />);
    
    await waitFor(() => {
      expect(screen.getByText('åŠ è½½å¤±è´¥')).toBeInTheDocument();
    });
  });
});
```

### 5.4 é›†æˆæµ‹è¯•å®ä¾‹


**ğŸ  æµ‹è¯•ç»„ä»¶ç»„åˆ**
```javascript
// App.js
import { useState } from 'react';
import UserList from './UserList';
import UserDetail from './UserDetail';

function App() {
  const [selectedUser, setSelectedUser] = useState(null);
  
  return (
    <div>
      <UserList onSelectUser={setSelectedUser} />
      {selectedUser && <UserDetail user={selectedUser} />}
    </div>
  );
}

export default App;
```

```javascript
// App.test.js
import { render, screen } from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import App from './App';

describe('Appé›†æˆæµ‹è¯•', () => {
  test('é€‰æ‹©ç”¨æˆ·æ˜¾ç¤ºè¯¦æƒ…', async () => {
    const user = userEvent.setup();
    render(<App />);
    
    // ç‚¹å‡»ç”¨æˆ·åˆ—è¡¨ä¸­çš„ç”¨æˆ·
    const userItem = screen.getByText('å¼ ä¸‰');
    await user.click(userItem);
    
    // éªŒè¯ç”¨æˆ·è¯¦æƒ…æ˜¾ç¤º
    expect(screen.getByText('ç”¨æˆ·è¯¦æƒ…')).toBeInTheDocument();
    expect(screen.getByText('å§“å: å¼ ä¸‰')).toBeInTheDocument();
  });
});
```

---

## 6. â° å¼‚æ­¥æµ‹è¯•ä¸ç”¨æˆ·äº¤äº’


### 6.1 å¼‚æ­¥æµ‹è¯•åŸºç¡€


**â³ ç­‰å¾…å¼‚æ­¥æ“ä½œ**
```javascript
// ä¸‰ç§ç­‰å¾…æ–¹å¼ï¼š

// 1. waitFor - ç­‰å¾…æ¡ä»¶æˆç«‹
await waitFor(() => {
  expect(screen.getByText('åŠ è½½å®Œæˆ')).toBeInTheDocument();
});

// 2. findBy - å¼‚æ­¥æŸ¥æ‰¾å…ƒç´ 
const element = await screen.findByText('åŠ è½½å®Œæˆ');

// 3. waitForElementToBeRemoved - ç­‰å¾…å…ƒç´ æ¶ˆå¤±
await waitForElementToBeRemoved(screen.getByText('åŠ è½½ä¸­...'));
```

### 6.2 æµ‹è¯•åŠ è½½çŠ¶æ€


**â²ï¸ æµ‹è¯•LoadingçŠ¶æ€**
```javascript
// components/DataLoader.js
import { useState, useEffect } from 'react';

function DataLoader() {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);
  
  useEffect(() => {
    setTimeout(() => {
      setData('æ•°æ®åŠ è½½å®Œæˆ');
      setLoading(false);
    }, 1000);
  }, []);
  
  if (loading) return <div>åŠ è½½ä¸­...</div>;
  return <div>{data}</div>;
}

export default DataLoader;
```

```javascript
// components/DataLoader.test.js
import { render, screen } from '@testing-library/react';
import DataLoader from './DataLoader';

describe('DataLoaderç»„ä»¶', () => {
  test('æ˜¾ç¤ºåŠ è½½çŠ¶æ€ç„¶åæ˜¾ç¤ºæ•°æ®', async () => {
    render(<DataLoader />);
    
    // åˆå§‹æ˜¾ç¤ºåŠ è½½çŠ¶æ€
    expect(screen.getByText('åŠ è½½ä¸­...')).toBeInTheDocument();
    
    // ç­‰å¾…æ•°æ®åŠ è½½å®Œæˆ
    const dataElement = await screen.findByText('æ•°æ®åŠ è½½å®Œæˆ');
    expect(dataElement).toBeInTheDocument();
    
    // åŠ è½½çŠ¶æ€åº”è¯¥æ¶ˆå¤±
    expect(screen.queryByText('åŠ è½½ä¸­...')).not.toBeInTheDocument();
  });
});
```

### 6.3 å¤æ‚ç”¨æˆ·äº¤äº’æµ‹è¯•


**ğŸ–±ï¸ æµ‹è¯•å¤æ‚äº¤äº’**
```javascript
// components/TodoApp.test.js
import { render, screen } from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import TodoApp from './TodoApp';

describe('TodoAppç”¨æˆ·äº¤äº’', () => {
  test('å®Œæ•´çš„å¾…åŠäº‹é¡¹æµç¨‹', async () => {
    const user = userEvent.setup();
    render(<TodoApp />);
    
    // æ·»åŠ æ–°ä»»åŠ¡
    const input = screen.getByPlaceholderText('æ·»åŠ æ–°ä»»åŠ¡');
    await user.type(input, 'å­¦ä¹ Reactæµ‹è¯•');
    await user.keyboard('{Enter}');
    
    // éªŒè¯ä»»åŠ¡æ·»åŠ æˆåŠŸ
    expect(screen.getByText('å­¦ä¹ Reactæµ‹è¯•')).toBeInTheDocument();
    
    // æ ‡è®°ä»»åŠ¡å®Œæˆ
    const checkbox = screen.getByRole('checkbox');
    await user.click(checkbox);
    
    // éªŒè¯ä»»åŠ¡çŠ¶æ€æ”¹å˜
    expect(checkbox).toBeChecked();
    
    // åˆ é™¤ä»»åŠ¡
    const deleteButton = screen.getByRole('button', { name: 'åˆ é™¤' });
    await user.click(deleteButton);
    
    // éªŒè¯ä»»åŠ¡åˆ é™¤
    expect(screen.queryByText('å­¦ä¹ Reactæµ‹è¯•')).not.toBeInTheDocument();
  });
});
```

---

## 7. ğŸ“Š æµ‹è¯•è¦†ç›–ç‡ä¸æœ€ä½³å®è·µ


### 7.1 æµ‹è¯•è¦†ç›–ç‡ç†è§£


**ğŸ“ˆ ä»€ä¹ˆæ˜¯è¦†ç›–ç‡**
```
æµ‹è¯•è¦†ç›–ç‡ = æµ‹è¯•æ‰§è¡Œçš„ä»£ç è¡Œæ•° / æ€»ä»£ç è¡Œæ•°

è¦†ç›–ç‡ç±»å‹ï¼š
- è¡Œè¦†ç›–ç‡ï¼šæ‰§è¡Œäº†å¤šå°‘è¡Œä»£ç 
- åˆ†æ”¯è¦†ç›–ç‡ï¼šæ‰§è¡Œäº†å¤šå°‘åˆ†æ”¯æ¡ä»¶
- å‡½æ•°è¦†ç›–ç‡ï¼šè°ƒç”¨äº†å¤šå°‘å‡½æ•°
- è¯­å¥è¦†ç›–ç‡ï¼šæ‰§è¡Œäº†å¤šå°‘è¯­å¥
```

**âš–ï¸ è¦†ç›–ç‡çš„æ­£ç¡®ç†è§£**
```
âŒ é”™è¯¯è§‚å¿µï¼šè¦†ç›–ç‡è¶Šé«˜è¶Šå¥½
âœ… æ­£ç¡®è§‚å¿µï¼šå…³æ³¨æµ‹è¯•è´¨é‡ï¼Œä¸æ˜¯æ•°é‡

80%çš„é«˜è´¨é‡æµ‹è¯• > 100%çš„ä½è´¨é‡æµ‹è¯•
```

### 7.2 å¿«ç…§æµ‹è¯•


**ğŸ“¸ å¿«ç…§æµ‹è¯• = ç»™ç»„ä»¶æ‹ç…§**
```javascript
// components/Button.test.js
import { render } from '@testing-library/react';
import Button from './Button';

test('Buttonç»„ä»¶å¿«ç…§', () => {
  const { container } = render(
    <Button variant="primary" size="large">
      ç‚¹å‡»æˆ‘
    </Button>
  );
  
  // ç”Ÿæˆå¿«ç…§
  expect(container.firstChild).toMatchSnapshot();
});
```

**ğŸ¯ å¿«ç…§æµ‹è¯•æœ€ä½³å®è·µ**
```javascript
// âœ… å¥½çš„å¿«ç…§æµ‹è¯•
test('MessageCardå¿«ç…§', () => {
  const props = {
    title: 'æµ‹è¯•æ ‡é¢˜',
    content: 'æµ‹è¯•å†…å®¹',
    type: 'success'
  };
  
  const { container } = render(<MessageCard {...props} />);
  expect(container.firstChild).toMatchSnapshot();
});

// âŒ é¿å…çš„å¿«ç…§æµ‹è¯•
test('æ•´ä¸ªAppå¿«ç…§', () => {
  // å¤ªå¤§çš„å¿«ç…§éš¾ä»¥ç»´æŠ¤
  const { container } = render(<App />);
  expect(container).toMatchSnapshot();
});
```

### 7.3 æµ‹è¯•æœ€ä½³å®è·µ


**ğŸ¯ AAAæ¨¡å¼ï¼ˆæ¨èï¼‰**
```javascript
test('æè¿°æµ‹è¯•å†…å®¹', () => {
  // Arrange - å‡†å¤‡æµ‹è¯•æ•°æ®
  const props = { name: 'å¼ ä¸‰', age: 25 };
  
  // Act - æ‰§è¡Œæ“ä½œ
  render(<UserCard {...props} />);
  
  // Assert - éªŒè¯ç»“æœ
  expect(screen.getByText('å¼ ä¸‰')).toBeInTheDocument();
});
```

**ğŸ“ æµ‹è¯•å‘½åæœ€ä½³å®è·µ**
```javascript
// âœ… å¥½çš„æµ‹è¯•åç§°
test('ç”¨æˆ·ç‚¹å‡»ç™»å½•æŒ‰é’®åæ˜¾ç¤ºåŠ è½½çŠ¶æ€')
test('è¡¨å•éªŒè¯å¤±è´¥æ—¶æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯')
test('å•†å“æ·»åŠ åˆ°è´­ç‰©è½¦æˆåŠŸ')

// âŒ ä¸å¥½çš„æµ‹è¯•åç§°
test('æµ‹è¯•æŒ‰é’®')
test('æ£€æŸ¥ç»„ä»¶')
test('éªŒè¯åŠŸèƒ½')
```

**ğŸ§¹ æµ‹è¯•ä»£ç ç»„ç»‡**
```javascript
describe('UserProfileç»„ä»¶', () => {
  // é€šç”¨çš„è®¾ç½®
  const defaultProps = {
    user: { id: 1, name: 'å¼ ä¸‰' }
  };
  
  describe('æ¸²æŸ“æµ‹è¯•', () => {
    test('æ˜¾ç¤ºç”¨æˆ·åç§°', () => {
      // å…·ä½“æµ‹è¯•
    });
  });
  
  describe('äº¤äº’æµ‹è¯•', () => {
    test('ç‚¹å‡»ç¼–è¾‘æŒ‰é’®', () => {
      // å…·ä½“æµ‹è¯•
    });
  });
  
  describe('è¾¹ç•Œæƒ…å†µ', () => {
    test('å¤„ç†ç©ºç”¨æˆ·æ•°æ®', () => {
      // è¾¹ç•Œæµ‹è¯•
    });
  });
});
```

### 7.4 å¸¸è§æµ‹è¯•é™·é˜±


**âš ï¸ é¿å…çš„æµ‹è¯•åæ¨¡å¼**
```javascript
// âŒ æµ‹è¯•å®ç°ç»†èŠ‚
test('ç»„ä»¶çŠ¶æ€æ”¹å˜', () => {
  const wrapper = shallow(<Counter />);
  wrapper.setState({ count: 5 });
  expect(wrapper.state('count')).toBe(5);
});

// âœ… æµ‹è¯•ç”¨æˆ·è¡Œä¸º
test('ç‚¹å‡»æŒ‰é’®å¢åŠ è®¡æ•°', async () => {
  render(<Counter />);
  await user.click(screen.getByRole('button', { name: 'å¢åŠ ' }));
  expect(screen.getByText('è®¡æ•°: 1')).toBeInTheDocument();
});

// âŒ æµ‹è¯•è¿‡äºå…·ä½“çš„DOMç»“æ„
expect(container.querySelector('.button-wrapper .btn')).toBeInTheDocument();

// âœ… æµ‹è¯•ç”¨æˆ·å¯è§çš„å†…å®¹
expect(screen.getByRole('button', { name: 'æäº¤' })).toBeInTheDocument();
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æµ‹è¯•é‡‘å­—å¡”ï¼šå•å…ƒæµ‹è¯•ä¸ºä¸»ï¼Œé›†æˆæµ‹è¯•ä¸ºè¾…ï¼Œç«¯åˆ°ç«¯æµ‹è¯•æœ€å°‘
ğŸ”¸ JeståŸºç¡€ï¼šdescribeã€testã€expectä¸‰è¦ç´ ï¼Œæ–­è¨€æ–¹æ³•
ğŸ”¸ React Testing Libraryï¼šä»ç”¨æˆ·è§’åº¦æµ‹è¯•ï¼Œä¼˜å…ˆä½¿ç”¨getByRole
ğŸ”¸ æŸ¥è¯¢ä¼˜å…ˆçº§ï¼šRole > LabelText > Text > TestId
ğŸ”¸ å¼‚æ­¥æµ‹è¯•ï¼šwaitForã€findByå¤„ç†å¼‚æ­¥æ“ä½œ
ğŸ”¸ MockæŠ€æœ¯ï¼šæ¨¡æ‹Ÿå¤–éƒ¨ä¾èµ–ï¼Œä¸“æ³¨æµ‹è¯•ç›®æ ‡åŠŸèƒ½
ğŸ”¸ ç”¨æˆ·äº¤äº’ï¼šuserEventæ¨¡æ‹ŸçœŸå®ç”¨æˆ·æ“ä½œ
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æµ‹è¯•æ€ç»´è½¬æ¢**
```
ä»å¼€å‘è€…æ€ç»´åˆ°ç”¨æˆ·æ€ç»´ï¼š
âŒ è¿™ä¸ªç»„ä»¶çš„stateæ˜¯ä»€ä¹ˆï¼Ÿ
âœ… ç”¨æˆ·çœ‹åˆ°äº†ä»€ä¹ˆï¼Ÿèƒ½åšä»€ä¹ˆï¼Ÿ

âŒ è¿™ä¸ªæ–¹æ³•è¢«è°ƒç”¨äº†å—ï¼Ÿ
âœ… ç”¨æˆ·çš„æ“ä½œäº§ç”Ÿäº†é¢„æœŸæ•ˆæœå—ï¼Ÿ
```

**ğŸ”¹ æµ‹è¯•ç­–ç•¥**
```
æµ‹è¯•é‡ç‚¹ä¼˜å…ˆçº§ï¼š
1. æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼ˆç”¨æˆ·æœ€å…³å¿ƒçš„åŠŸèƒ½ï¼‰
2. ç”¨æˆ·äº¤äº’æµç¨‹ï¼ˆç‚¹å‡»ã€è¾“å…¥ã€æäº¤ï¼‰
3. é”™è¯¯å¤„ç†ï¼ˆç½‘ç»œå¤±è´¥ã€éªŒè¯å¤±è´¥ï¼‰
4. è¾¹ç•Œæ¡ä»¶ï¼ˆç©ºæ•°æ®ã€æå€¼ï¼‰
```

**ğŸ”¹ Mockä½¿ç”¨åŸåˆ™**
```
ä½•æ—¶Mockï¼š
âœ… å¤–éƒ¨APIè°ƒç”¨
âœ… ç¬¬ä¸‰æ–¹åº“
âœ… å¤æ‚çš„ä¾èµ–
âœ… éšæœºæ•°æ®

ä½•æ—¶ä¸Mockï¼š
âŒ ç®€å•çš„å·¥å…·å‡½æ•°
âŒ Reactå†…ç½®åŠŸèƒ½
âŒ æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ æµ‹è¯•ç¼–å†™æµç¨‹**
```
1. ç¡®å®šæµ‹è¯•ç›®æ ‡
   - è¿™ä¸ªç»„ä»¶çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿ
   - ç”¨æˆ·ä¼šæ€ä¹ˆä½¿ç”¨å®ƒï¼Ÿ

2. ç¼–å†™æµ‹è¯•ç”¨ä¾‹
   - æ­£å¸¸æƒ…å†µæµ‹è¯•
   - å¼‚å¸¸æƒ…å†µæµ‹è¯•
   - è¾¹ç•Œæ¡ä»¶æµ‹è¯•

3. è¿è¡Œå’Œç»´æŠ¤
   - å®šæœŸè¿è¡Œæµ‹è¯•
   - æ ¹æ®éœ€æ±‚æ›´æ–°æµ‹è¯•
```

**ğŸ“Š æµ‹è¯•è¦†ç›–ç­–ç•¥**
```
ç»„ä»¶æµ‹è¯•ä¼˜å…ˆçº§ï¼š
ğŸ”´ é«˜ä¼˜å…ˆçº§ï¼šæ ¸å¿ƒä¸šåŠ¡ç»„ä»¶ã€å¤æ‚äº¤äº’ç»„ä»¶
ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ï¼šé€šç”¨UIç»„ä»¶ã€å·¥å…·ç»„ä»¶
ğŸŸ¢ ä½ä¼˜å…ˆçº§ï¼šç®€å•å±•ç¤ºç»„ä»¶ã€ç¬¬ä¸‰æ–¹å°è£…
```

**ğŸ› ï¸ æµ‹è¯•ç¯å¢ƒæ­å»º**
```javascript
// package.jsonæµ‹è¯•è„šæœ¬
{
  "scripts": {
    "test": "jest",
    "test:watch": "jest --watch",
    "test:coverage": "jest --coverage",
    "test:ci": "jest --coverage --watchAll=false"
  }
}
```

### 8.4 å­¦ä¹ è·¯å¾„å»ºè®®


**ğŸ“š æ¨èå­¦ä¹ é¡ºåº**
```
ç¬¬1å‘¨ï¼šJeståŸºç¡€
- å­¦ä¹ åŸºæœ¬æ–­è¨€
- ç†è§£describeå’Œtest
- ç»ƒä¹ ç®€å•å‡½æ•°æµ‹è¯•

ç¬¬2å‘¨ï¼šReact Testing Library
- æŒæ¡æŸ¥è¯¢æ–¹æ³•
- ç»ƒä¹ ç»„ä»¶æ¸²æŸ“æµ‹è¯•
- å­¦ä¹ ç”¨æˆ·äº‹ä»¶æ¨¡æ‹Ÿ

ç¬¬3å‘¨ï¼šå¼‚æ­¥å’ŒMock
- å¤„ç†å¼‚æ­¥æ“ä½œ
- å­¦ä¹ MockæŠ€æœ¯
- æµ‹è¯•ç½‘ç»œè¯·æ±‚

ç¬¬4å‘¨ï¼šç»¼åˆå®è·µ
- ç¼–å†™çœŸå®é¡¹ç›®æµ‹è¯•
- å»ºç«‹æµ‹è¯•è§„èŒƒ
- æŒç»­ä¼˜åŒ–æµ‹è¯•
```

**ğŸ’¡ å®è·µå»ºè®®**
- **ä»ç®€å•å¼€å§‹**ï¼šå…ˆæµ‹è¯•çº¯å‡½æ•°ï¼Œå†æµ‹è¯•ç»„ä»¶
- **å…³æ³¨ç”¨æˆ·ä»·å€¼**ï¼šæµ‹è¯•ç”¨æˆ·å…³å¿ƒçš„åŠŸèƒ½ï¼Œä¸æ˜¯æ‰€æœ‰ä»£ç 
- **ä¿æŒæµ‹è¯•ç®€å•**ï¼šä¸€ä¸ªæµ‹è¯•éªŒè¯ä¸€ä¸ªè¡Œä¸º
- **å®šæœŸç»´æŠ¤**ï¼šåŠæ—¶æ›´æ–°è¿‡æ—¶çš„æµ‹è¯•

**æ ¸å¿ƒè®°å¿†è¦ç‚¹ï¼š**
- æµ‹è¯•æ˜¯ä¸ºäº†ä¿è¯è´¨é‡ï¼Œä¸æ˜¯ä¸ºäº†å®Œæˆä»»åŠ¡
- ä»ç”¨æˆ·è§’åº¦æ€è€ƒï¼Œæµ‹è¯•ç”¨æˆ·è¡Œä¸ºè€Œä¸æ˜¯ä»£ç å®ç°
- Mockå¤–éƒ¨ä¾èµ–ï¼Œä¸“æ³¨æµ‹è¯•æ ¸å¿ƒåŠŸèƒ½
- å¥½çš„æµ‹è¯•æ˜¯æ´»æ–‡æ¡£ï¼Œèƒ½æ¸…æ¥šè¯´æ˜åŠŸèƒ½å¦‚ä½•å·¥ä½œ