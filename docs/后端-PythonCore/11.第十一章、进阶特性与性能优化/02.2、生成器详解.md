---
title: 2ã€ç”Ÿæˆå™¨è¯¦è§£
---
## ğŸ“š ç›®å½•

1. [ç”Ÿæˆå™¨åŸºç¡€æ¦‚å¿µ](#1-ç”Ÿæˆå™¨åŸºç¡€æ¦‚å¿µ)
2. [ç”Ÿæˆå™¨å‡½æ•°ä¸yieldè¯­å¥](#2-ç”Ÿæˆå™¨å‡½æ•°ä¸yieldè¯­å¥)
3. [ç”Ÿæˆå™¨è¡¨è¾¾å¼](#3-ç”Ÿæˆå™¨è¡¨è¾¾å¼)
4. [ç”Ÿæˆå™¨é«˜çº§æ–¹æ³•](#4-ç”Ÿæˆå™¨é«˜çº§æ–¹æ³•)
5. [yield fromè¯­å¥è¯¦è§£](#5-yield-fromè¯­å¥è¯¦è§£)
6. [ç”Ÿæˆå™¨ä¸åç¨‹å…³ç³»](#6-ç”Ÿæˆå™¨ä¸åç¨‹å…³ç³»)
7. [æ€§èƒ½ä¼˜åŠ¿ä¸åº”ç”¨åœºæ™¯](#7-æ€§èƒ½ä¼˜åŠ¿ä¸åº”ç”¨åœºæ™¯)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ± ç”Ÿæˆå™¨åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯ç”Ÿæˆå™¨ï¼Ÿ


**ğŸ”¸ ç®€å•ç†è§£**ï¼šç”Ÿæˆå™¨å°±åƒä¸€ä¸ª"æ‡’æƒ°çš„å·¥å‚"ï¼Œåªæœ‰åœ¨ä½ éœ€è¦äº§å“çš„æ—¶å€™æ‰å¼€å§‹ç”Ÿäº§ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§ç”Ÿäº§æ‰€æœ‰äº§å“ã€‚

```
ä¼ ç»Ÿæ–¹å¼ï¼ˆåˆ—è¡¨ï¼‰ï¼š
å·¥å‚ä¸€æ¬¡æ€§ç”Ÿäº§1000ä¸ªäº§å“ â†’ å ç”¨å¤§é‡ä»“åº“ç©ºé—´

ç”Ÿæˆå™¨æ–¹å¼ï¼š
å·¥å‚æ¥åˆ°è®¢å•æ‰ç”Ÿäº§ä¸€ä¸ª â†’ èŠ‚çœä»“åº“ç©ºé—´ï¼ŒæŒ‰éœ€ç”Ÿäº§
```

**ğŸ’¡ æŠ€æœ¯å®šä¹‰**ï¼š
- **ç”Ÿæˆå™¨**ï¼šä¸€ç§ç‰¹æ®Šçš„è¿­ä»£å™¨ï¼Œèƒ½å¤Ÿ**æŒ‰éœ€ç”Ÿæˆå€¼**è€Œä¸æ˜¯ä¸€æ¬¡æ€§åˆ›å»ºæ‰€æœ‰å€¼
- **æ ¸å¿ƒç‰¹ç‚¹**ï¼š**å»¶è¿Ÿè®¡ç®—**ï¼ˆlazy evaluationï¼‰- ç”¨åˆ°çš„æ—¶å€™æ‰è®¡ç®—
- **å†…å­˜å‹å¥½**ï¼šä¸ä¼šä¸€æ¬¡æ€§å ç”¨å¤§é‡å†…å­˜

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦ç”Ÿæˆå™¨ï¼Ÿ


**ğŸ¯ è§£å†³çš„é—®é¢˜**ï¼š

```python
# é—®é¢˜ç¤ºä¾‹ï¼šåˆ›å»ºå¤§æ•°æ®åˆ—è¡¨
def create_big_list():
    return [i * 2 for i in range(1000000)]  # ç«‹å³åˆ›å»º100ä¸‡ä¸ªæ•°å­—

big_list = create_big_list()  # ç¬é—´å ç”¨å¤§é‡å†…å­˜ï¼
print(big_list[0])  # åªç”¨ç¬¬ä¸€ä¸ªï¼Œä½†å·²ç»åˆ›å»ºäº†å…¨éƒ¨
```

**ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜**ï¼š
- ğŸ’¾ **å†…å­˜å ç”¨å¤§**ï¼šä¸€æ¬¡æ€§åˆ›å»ºæ‰€æœ‰æ•°æ®
- â° **å¯åŠ¨æ—¶é—´é•¿**ï¼šéœ€è¦ç­‰å¾…æ‰€æœ‰æ•°æ®åˆ›å»ºå®Œæˆ
- ğŸ’¸ **èµ„æºæµªè´¹**ï¼šå¯èƒ½åªç”¨åˆ°éƒ¨åˆ†æ•°æ®

**ç”Ÿæˆå™¨çš„ä¼˜åŠ¿**ï¼š
- âœ… **æŒ‰éœ€ç”Ÿæˆ**ï¼šéœ€è¦å¤šå°‘ç”Ÿæˆå¤šå°‘
- âœ… **å†…å­˜é«˜æ•ˆ**ï¼šå§‹ç»ˆåªå ç”¨ä¸€ä¸ªå…ƒç´ çš„å†…å­˜
- âœ… **å“åº”å¿«é€Ÿ**ï¼šç«‹å³å¯ä»¥å¼€å§‹ä½¿ç”¨

### 1.3 ç”Ÿæˆå™¨ vs æ™®é€šå‡½æ•°å¯¹æ¯”


```
æ™®é€šå‡½æ•°ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è°ƒç”¨å‡½æ•°        â”‚ â†’ æ‰§è¡Œå®Œæ¯• â†’ è¿”å›ç»“æœ â†’ å‡½æ•°ç»“æŸ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç”Ÿæˆå™¨å‡½æ•°ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è°ƒç”¨å‡½æ•°        â”‚ â†’ é‡åˆ°yield â†’ æš‚åœä¿å­˜çŠ¶æ€ â†’ è¿”å›å€¼
â”‚ ç»§ç»­è°ƒç”¨        â”‚ â†’ ä»æš‚åœå¤„ç»§ç»­ â†’ é‡åˆ°yield â†’ å†æ¬¡æš‚åœ...
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ğŸ”§ ç”Ÿæˆå™¨å‡½æ•°ä¸yieldè¯­å¥


### 2.1 åˆ›å»ºç”Ÿæˆå™¨å‡½æ•°


**ğŸ”¸ åŸºæœ¬è¯­æ³•**ï¼šåŒ…å«`yield`å…³é”®å­—çš„å‡½æ•°å°±æ˜¯ç”Ÿæˆå™¨å‡½æ•°

```python
# æœ€ç®€å•çš„ç”Ÿæˆå™¨
def simple_generator():
    print("å¼€å§‹æ‰§è¡Œ")
    yield 1
    print("ç»§ç»­æ‰§è¡Œ")
    yield 2
    print("å³å°†ç»“æŸ")
    yield 3
    print("æ‰§è¡Œå®Œæ¯•")

# åˆ›å»ºç”Ÿæˆå™¨å¯¹è±¡ï¼ˆæ³¨æ„ï¼šæ­¤æ—¶å‡½æ•°è¿˜æ²¡æœ‰æ‰§è¡Œï¼‰
gen = simple_generator()
print(type(gen))  # <class 'generator'>
```

**ğŸ’­ å…³é”®ç†è§£**ï¼š
- `yield`**ä¸æ˜¯**`return`ï¼Œå‡½æ•°ä¸ä¼šç»“æŸ
- `yield`ä¼š**æš‚åœ**å‡½æ•°æ‰§è¡Œï¼Œ**ä¿å­˜å½“å‰çŠ¶æ€**
- ä¸‹æ¬¡è°ƒç”¨æ—¶ä»`yield`**ä¸‹ä¸€è¡Œ**ç»§ç»­æ‰§è¡Œ

### 2.2 yieldè¯­å¥è¯¦è§£


**ğŸ” yieldçš„ä¸‰ç§åŸºæœ¬ç”¨æ³•**ï¼š

```python
# 1. äº§ç”Ÿå€¼
def number_generator():
    yield 10        # äº§ç”Ÿå€¼10
    yield 20        # äº§ç”Ÿå€¼20
    yield 30        # äº§ç”Ÿå€¼30

# 2. yieldè¡¨è¾¾å¼ï¼ˆå¯ä»¥æ¥æ”¶å¤–éƒ¨å‘é€çš„å€¼ï¼‰
def echo_generator():
    while True:
        received = yield "å‡†å¤‡æ¥æ”¶"
        if received:
            yield f"æ”¶åˆ°äº†: {received}"

# 3. yield fromï¼ˆå§”æ‰˜ç»™å…¶ä»–ç”Ÿæˆå™¨ï¼‰
def delegating_generator():
    yield from range(3)      # ç›¸å½“äº yield 0, yield 1, yield 2
    yield from ['a', 'b']    # ç›¸å½“äº yield 'a', yield 'b'
```

### 2.3 ç”Ÿæˆå™¨çš„æ‰§è¡Œæµç¨‹


**ğŸ“Š æ‰§è¡Œæ­¥éª¤è¯¦è§£**ï¼š

```python
def count_up_to(max_count):
    count = 1
    while count <= max_count:
        print(f"å³å°†äº§ç”Ÿ {count}")
        yield count           # åœ¨è¿™é‡Œæš‚åœï¼Œè¿”å›countå€¼
        print(f"åˆšåˆšäº§ç”Ÿäº† {count}")
        count += 1
    print("ç”Ÿæˆå™¨ç»“æŸ")

# æ¼”ç¤ºæ‰§è¡Œæµç¨‹
gen = count_up_to(3)

print("=== ç¬¬ä¸€æ¬¡è°ƒç”¨ ===")
value1 = next(gen)  # æ‰§è¡Œåˆ°ç¬¬ä¸€ä¸ªyield
print(f"å¾—åˆ°å€¼: {value1}")

print("=== ç¬¬äºŒæ¬¡è°ƒç”¨ ===")  
value2 = next(gen)  # ä»ç¬¬ä¸€ä¸ªyieldåç»§ç»­æ‰§è¡Œ
print(f"å¾—åˆ°å€¼: {value2}")

print("=== ç¬¬ä¸‰æ¬¡è°ƒç”¨ ===")
value3 = next(gen)
print(f"å¾—åˆ°å€¼: {value3}")

print("=== ç¬¬å››æ¬¡è°ƒç”¨ï¼ˆç”Ÿæˆå™¨è€—å°½ï¼‰===")
try:
    next(gen)  # æŠ›å‡ºStopIterationå¼‚å¸¸
except StopIteration:
    print("ç”Ÿæˆå™¨å·²ç»ç»“æŸ")
```

**ğŸ¯ å®é™…è¾“å‡º**ï¼š
```
=== ç¬¬ä¸€æ¬¡è°ƒç”¨ ===
å³å°†äº§ç”Ÿ 1
å¾—åˆ°å€¼: 1

=== ç¬¬äºŒæ¬¡è°ƒç”¨ ===
åˆšåˆšäº§ç”Ÿäº† 1
å³å°†äº§ç”Ÿ 2
å¾—åˆ°å€¼: 2

=== ç¬¬ä¸‰æ¬¡è°ƒç”¨ ===
åˆšåˆšäº§ç”Ÿäº† 2
å³å°†äº§ç”Ÿ 3
å¾—åˆ°å€¼: 3

=== ç¬¬å››æ¬¡è°ƒç”¨ï¼ˆç”Ÿæˆå™¨è€—å°½ï¼‰===
åˆšåˆšäº§ç”Ÿäº† 3
ç”Ÿæˆå™¨ç»“æŸ
ç”Ÿæˆå™¨å·²ç»ç»“æŸ
```

### 2.4 å®ç”¨ç”Ÿæˆå™¨ç¤ºä¾‹


**ğŸ“ æ–‡ä»¶é€è¡Œè¯»å–**ï¼š
```python
def read_large_file(filename):
    """é€è¡Œè¯»å–å¤§æ–‡ä»¶ï¼Œå†…å­˜å‹å¥½"""
    with open(filename, 'r') as file:
        for line in file:
            yield line.strip()  # ä¸€æ¬¡åªäº§ç”Ÿä¸€è¡Œ

# ä½¿ç”¨æ–¹å¼
for line in read_large_file('big_file.txt'):
    if 'error' in line:
        print(f"å‘ç°é”™è¯¯: {line}")
        break  # å¯ä»¥éšæ—¶åœæ­¢ï¼Œä¸ä¼šæµªè´¹å†…å­˜
```

**ğŸ”¢ æ— é™åºåˆ—ç”Ÿæˆå™¨**ï¼š
```python
def fibonacci():
    """ç”Ÿæˆæ–æ³¢é‚£å¥‘æ•°åˆ—ï¼ˆæ— é™åºåˆ—ï¼‰"""
    a, b = 0, 1
    while True:
        yield a
        a, b = b, a + b

# åªå–å‰10ä¸ªæ–æ³¢é‚£å¥‘æ•°
fib = fibonacci()
first_10 = [next(fib) for _ in range(10)]
print(first_10)  # [0, 1, 1, 2, 3, 5, 8, 13, 21, 34]
```

---

## 3. âš¡ ç”Ÿæˆå™¨è¡¨è¾¾å¼


### 3.1 åŸºæœ¬è¯­æ³•


**ğŸ”¸ è¯­æ³•æ ¼å¼**ï¼š`(expression for item in iterable if condition)`

```python
# åˆ—è¡¨æ¨å¯¼å¼ vs ç”Ÿæˆå™¨è¡¨è¾¾å¼
list_comp = [x * 2 for x in range(5)]        # åˆ—è¡¨æ¨å¯¼å¼
gen_exp = (x * 2 for x in range(5))          # ç”Ÿæˆå™¨è¡¨è¾¾å¼

print(list_comp)    # [0, 2, 4, 6, 8] - ç«‹å³åˆ›å»ºæ‰€æœ‰å…ƒç´ 
print(gen_exp)      # <generator object> - åªæ˜¯ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡
print(list(gen_exp)) # [0, 2, 4, 6, 8] - è½¬æ¢ä¸ºåˆ—è¡¨æ‰æ˜¾ç¤ºæ‰€æœ‰å…ƒç´ 
```

**ğŸ”‘ å…³é”®åŒºåˆ«**ï¼š

| ç‰¹å¾ | åˆ—è¡¨æ¨å¯¼å¼ `[...]` | ç”Ÿæˆå™¨è¡¨è¾¾å¼ `(...)` |
|------|-------------------|-------------------|
| **å†…å­˜ä½¿ç”¨** | ç«‹å³åˆ›å»ºæ‰€æœ‰å…ƒç´  | æŒ‰éœ€ç”Ÿæˆå…ƒç´  |
| **è¿”å›ç±»å‹** | `list` | `generator` |
| **é€‚ç”¨åœºæ™¯** | å°æ•°æ®é›†ï¼Œéœ€è¦å¤šæ¬¡ä½¿ç”¨ | å¤§æ•°æ®é›†ï¼Œä¸€æ¬¡æ€§å¤„ç† |
| **æ€§èƒ½** | åˆ›å»ºæ—¶é—´é•¿ï¼Œè®¿é—®å¿« | åˆ›å»ºæ—¶é—´çŸ­ï¼ŒæŒ‰éœ€è®¡ç®— |

### 3.2 å®é™…åº”ç”¨ç¤ºä¾‹


**ğŸ“Š å¤§æ•°æ®å¤„ç†**ï¼š
```python
# å¤„ç†å¤§é‡æ•°æ®çš„å¹³æ–¹
def process_large_numbers():
    # å‡è®¾æœ‰ä¸€ä¸ªåŒ…å«ç™¾ä¸‡æ•°å­—çš„æ•°æ®æº
    large_data = range(1000000)
    
    # æ–¹å¼1ï¼šåˆ—è¡¨æ¨å¯¼å¼ï¼ˆå†…å­˜å¯†é›†ï¼‰
    # squares_list = [x**2 for x in large_data if x % 2 == 0]  # å ç”¨å¤§é‡å†…å­˜
    
    # æ–¹å¼2ï¼šç”Ÿæˆå™¨è¡¨è¾¾å¼ï¼ˆå†…å­˜å‹å¥½ï¼‰
    squares_gen = (x**2 for x in large_data if x % 2 == 0)
    
    # åªå¤„ç†å‰5ä¸ªç»“æœ
    for i, square in enumerate(squares_gen):
        if i >= 5:
            break
        print(f"å¶æ•° {int(square**0.5)} çš„å¹³æ–¹æ˜¯ {square}")

process_large_numbers()
```

**ğŸ” æ–‡æœ¬å¤„ç†ç®¡é“**ï¼š
```python
def process_text_file(filename):
    """ä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼åˆ›å»ºå¤„ç†ç®¡é“"""
    # è¯»å–æ–‡ä»¶è¡Œ
    lines = (line.strip() for line in open(filename))
    
    # è¿‡æ»¤ç©ºè¡Œ
    non_empty_lines = (line for line in lines if line)
    
    # è½¬æ¢ä¸ºå¤§å†™
    upper_lines = (line.upper() for line in non_empty_lines)
    
    # åªä¿ç•™åŒ…å«ç‰¹å®šå…³é”®è¯çš„è¡Œ
    keyword_lines = (line for line in upper_lines if 'PYTHON' in line)
    
    return keyword_lines

# ä½¿ç”¨ç®¡é“å¤„ç†
# for line in process_text_file('data.txt'):
#     print(line)
```

### 3.3 ç”Ÿæˆå™¨è¡¨è¾¾å¼çš„é«˜çº§ç”¨æ³•


**ğŸ¯ åµŒå¥—ç”Ÿæˆå™¨è¡¨è¾¾å¼**ï¼š
```python
# ç”Ÿæˆåæ ‡ç‚¹
coordinates = ((x, y) for x in range(3) for y in range(3) if x != y)
print(list(coordinates))  # [(0, 1), (0, 2), (1, 0), (1, 2), (2, 0), (2, 1)]

# ç­‰ä»·çš„åµŒå¥—å¾ªç¯
def coordinate_generator():
    for x in range(3):
        for y in range(3):
            if x != y:
                yield (x, y)
```

---

## 4. ğŸ› ï¸ ç”Ÿæˆå™¨é«˜çº§æ–¹æ³•


### 4.1 send() æ–¹æ³• - å‘ç”Ÿæˆå™¨å‘é€å€¼


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µ**ï¼š`send()`æ–¹æ³•å¯ä»¥å‘ç”Ÿæˆå™¨å†…éƒ¨å‘é€å€¼ï¼Œè¿™ä¸ªå€¼ä¼šæˆä¸º`yield`è¡¨è¾¾å¼çš„è¿”å›å€¼ã€‚

```python
def echo_generator():
    """æ¥æ”¶å¹¶å›æ˜¾æ¶ˆæ¯çš„ç”Ÿæˆå™¨"""
    print("ç”Ÿæˆå™¨å¯åŠ¨ï¼Œå‡†å¤‡æ¥æ”¶æ¶ˆæ¯")
    
    while True:
        # yieldè¡¨è¾¾å¼å¯ä»¥æ¥æ”¶å¤–éƒ¨å‘é€çš„å€¼
        received_message = yield "è¯·å‘é€æ¶ˆæ¯ç»™æˆ‘"
        
        if received_message is None:
            print("æ”¶åˆ°ç©ºæ¶ˆæ¯")
        else:
            print(f"æ”¶åˆ°æ¶ˆæ¯: {received_message}")
            yield f"å›æ˜¾: {received_message}"

# ä½¿ç”¨ç¤ºä¾‹
gen = echo_generator()

# ç¬¬ä¸€æ¬¡å¿…é¡»ç”¨next()å¯åŠ¨ç”Ÿæˆå™¨
response1 = next(gen)
print(response1)  # "è¯·å‘é€æ¶ˆæ¯ç»™æˆ‘"

# ä½¿ç”¨send()å‘é€å€¼
response2 = gen.send("Hello")
print(response2)  # "å›æ˜¾: Hello"

# ç»§ç»­å¯¹è¯
response3 = next(gen)
print(response3)  # "è¯·å‘é€æ¶ˆæ¯ç»™æˆ‘"

response4 = gen.send("World")
print(response4)  # "å›æ˜¾: World"
```

**ğŸ’¡ send() çš„å·¥ä½œåŸç†**ï¼š
```
ç”Ÿæˆå™¨å†…éƒ¨çŠ¶æ€å˜åŒ–ï¼š

1. next(gen) â†’ æ‰§è¡Œåˆ° yield "è¯·å‘é€æ¶ˆæ¯ç»™æˆ‘"
   â†“
2. gen.send("Hello") â†’ received_message = "Hello"
   â†“  
3. ç»§ç»­æ‰§è¡Œ â†’ yield f"å›æ˜¾: {received_message}"
   â†“
4. next(gen) â†’ æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ª yield "è¯·å‘é€æ¶ˆæ¯ç»™æˆ‘"
```

### 4.2 throw() æ–¹æ³• - å‘ç”Ÿæˆå™¨å‘é€å¼‚å¸¸


**ğŸ”¸ ç”¨é€”**ï¼šåœ¨ç”Ÿæˆå™¨å†…éƒ¨æŠ›å‡ºå¼‚å¸¸ï¼Œç”¨äºé”™è¯¯å¤„ç†å’Œæµç¨‹æ§åˆ¶ã€‚

```python
def robust_generator():
    """å…·æœ‰å¼‚å¸¸å¤„ç†èƒ½åŠ›çš„ç”Ÿæˆå™¨"""
    try:
        while True:
            value = yield "æ­£å¸¸è¿è¡Œä¸­"
            if value:
                yield f"å¤„ç†: {value}"
    except ValueError as e:
        yield f"æ•è·åˆ°ValueError: {e}"
        # å¯ä»¥é€‰æ‹©ç»§ç»­è¿è¡Œæˆ–ç»“æŸ
    except GeneratorExit:
        print("ç”Ÿæˆå™¨æ­£åœ¨å…³é—­")
        return
    except Exception as e:
        yield f"æ•è·åˆ°å…¶ä»–å¼‚å¸¸: {e}"

# ä½¿ç”¨ç¤ºä¾‹
gen = robust_generator()
print(next(gen))  # "æ­£å¸¸è¿è¡Œä¸­"

# å‘é€æ­£å¸¸å€¼
print(gen.send("æ•°æ®"))  # "å¤„ç†: æ•°æ®"

print(next(gen))  # "æ­£å¸¸è¿è¡Œä¸­"

# å‘é€å¼‚å¸¸
response = gen.throw(ValueError, "è¿™æ˜¯ä¸€ä¸ªå€¼é”™è¯¯")
print(response)  # "æ•è·åˆ°ValueError: è¿™æ˜¯ä¸€ä¸ªå€¼é”™è¯¯"
```

### 4.3 close() æ–¹æ³• - å…³é—­ç”Ÿæˆå™¨


**ğŸ”¸ ç”¨é€”**ï¼šä¼˜é›…åœ°å…³é—­ç”Ÿæˆå™¨ï¼Œé‡Šæ”¾èµ„æºã€‚

```python
def resource_manager():
    """ç®¡ç†èµ„æºçš„ç”Ÿæˆå™¨"""
    print("ğŸ“‚ æ‰“å¼€èµ„æº")
    try:
        while True:
            data = yield "èµ„æºå¯ç”¨"
            if data:
                yield f"å¤„ç†æ•°æ®: {data}"
    except GeneratorExit:
        print("ğŸ“¤ æ­£åœ¨å…³é—­èµ„æº")
        # åœ¨è¿™é‡Œè¿›è¡Œæ¸…ç†å·¥ä½œ
        return "èµ„æºå·²å®‰å…¨å…³é—­"
    finally:
        print("ğŸ”’ èµ„æºæ¸…ç†å®Œæˆ")

# ä½¿ç”¨ç¤ºä¾‹
gen = resource_manager()
print(next(gen))  # "èµ„æºå¯ç”¨"
print(gen.send("é‡è¦æ•°æ®"))  # "å¤„ç†æ•°æ®: é‡è¦æ•°æ®"

# å…³é—­ç”Ÿæˆå™¨
gen.close()  # è§¦å‘GeneratorExitå¼‚å¸¸

# å°è¯•ç»§ç»­ä½¿ç”¨ä¼šæŠ›å‡ºStopIteration
try:
    next(gen)
except StopIteration:
    print("ç”Ÿæˆå™¨å·²å…³é—­")
```

### 4.4 ç”Ÿæˆå™¨æ–¹æ³•ç»¼åˆåº”ç”¨


**ğŸ¯ çŠ¶æ€æœºç¤ºä¾‹**ï¼š
```python
def traffic_light():
    """äº¤é€šç¯çŠ¶æ€æœºç”Ÿæˆå™¨"""
    states = ['çº¢ç¯', 'ç»¿ç¯', 'é»„ç¯']
    current = 0
    
    try:
        while True:
            command = yield states[current]
            
            if command == 'next':
                current = (current + 1) % len(states)
            elif command == 'reset':
                current = 0
            elif command == 'stop':
                break
            # å¦‚æœcommandæ˜¯Noneæˆ–å…¶ä»–å€¼ï¼Œä¿æŒå½“å‰çŠ¶æ€
            
    except GeneratorExit:
        yield "äº¤é€šç¯ç³»ç»Ÿå…³é—­"

# ä½¿ç”¨äº¤é€šç¯çŠ¶æ€æœº
light = traffic_light()
print(next(light))          # "çº¢ç¯"
print(light.send('next'))   # "ç»¿ç¯"  
print(light.send('next'))   # "é»„ç¯"
print(light.send('reset'))  # "çº¢ç¯"
print(light.send('stop'))   # StopIteration (ç”Ÿæˆå™¨ç»“æŸ)
```

---

## 5. ğŸ”— yield fromè¯­å¥è¯¦è§£


### 5.1 yield fromåŸºæœ¬æ¦‚å¿µ


**ğŸ”¸ ä½œç”¨**ï¼š`yield from`ç”¨äº**å§”æ‰˜**ç»™å¦ä¸€ä¸ªç”Ÿæˆå™¨ï¼Œç›¸å½“äºæŠŠå¦ä¸€ä¸ªç”Ÿæˆå™¨çš„æ‰€æœ‰å€¼"è½¬å‘"å‡ºæ¥ã€‚

```python
# ä¸ä½¿ç”¨yield fromçš„æ–¹å¼
def manual_delegation():
    for value in range(3):
        yield value
    for value in ['a', 'b', 'c']:
        yield value

# ä½¿ç”¨yield fromçš„æ–¹å¼
def yield_from_delegation():
    yield from range(3)        # å§”æ‰˜ç»™rangeç”Ÿæˆå™¨
    yield from ['a', 'b', 'c'] # å§”æ‰˜ç»™åˆ—è¡¨è¿­ä»£å™¨

# ä¸¤ç§æ–¹å¼æ•ˆæœç›¸åŒ
print(list(manual_delegation()))        # [0, 1, 2, 'a', 'b', 'c']
print(list(yield_from_delegation()))    # [0, 1, 2, 'a', 'b', 'c']
```

**ğŸ’¡ yield fromçš„ä¼˜åŠ¿**ï¼š
- âœ… **ä»£ç ç®€æ´**ï¼šä¸€è¡Œä»£ç æ›¿ä»£å¾ªç¯
- âœ… **æ€§èƒ½æ›´å¥½**ï¼šç›´æ¥å§”æ‰˜ï¼Œå‡å°‘ä¸­é—´å±‚å¼€é”€  
- âœ… **å¼‚å¸¸é€ä¼ **ï¼šå¼‚å¸¸å¯ä»¥ç›´æ¥ä¼ é€’ç»™è¢«å§”æ‰˜çš„ç”Ÿæˆå™¨
- âœ… **åŒå‘é€šä¿¡**ï¼šæ”¯æŒsend()å’Œthrow()æ–¹æ³•çš„é€ä¼ 

### 5.2 yield fromçš„æ·±å…¥ç†è§£


**ğŸ” å§”æ‰˜æœºåˆ¶è¯¦è§£**ï¼š

```python
def sub_generator():
    """å­ç”Ÿæˆå™¨"""
    print("å­ç”Ÿæˆå™¨å¼€å§‹")
    yield "å­-1"
    yield "å­-2"
    print("å­ç”Ÿæˆå™¨ç»“æŸ")
    return "å­ç”Ÿæˆå™¨è¿”å›å€¼"

def delegating_generator():
    """å§”æ‰˜ç”Ÿæˆå™¨"""
    print("å§”æ‰˜ç”Ÿæˆå™¨å¼€å§‹")
    result = yield from sub_generator()  # å§”æ‰˜ç»™å­ç”Ÿæˆå™¨
    print(f"æ”¶åˆ°å­ç”Ÿæˆå™¨è¿”å›å€¼: {result}")
    yield "å§”æ‰˜-æœ€å"
    print("å§”æ‰˜ç”Ÿæˆå™¨ç»“æŸ")

# æ¼”ç¤ºæ‰§è¡Œè¿‡ç¨‹
gen = delegating_generator()
for value in gen:
    print(f"ä¸»ç¨‹åºæ”¶åˆ°: {value}")
```

**ğŸ“Š æ‰§è¡Œè¾“å‡º**ï¼š
```
å§”æ‰˜ç”Ÿæˆå™¨å¼€å§‹
å­ç”Ÿæˆå™¨å¼€å§‹
ä¸»ç¨‹åºæ”¶åˆ°: å­-1
ä¸»ç¨‹åºæ”¶åˆ°: å­-2
å­ç”Ÿæˆå™¨ç»“æŸ
æ”¶åˆ°å­ç”Ÿæˆå™¨è¿”å›å€¼: å­ç”Ÿæˆå™¨è¿”å›å€¼
ä¸»ç¨‹åºæ”¶åˆ°: å§”æ‰˜-æœ€å
å§”æ‰˜ç”Ÿæˆå™¨ç»“æŸ
```

### 5.3 yield fromçš„å®é™…åº”ç”¨


**ğŸŒ³ æ ‘ç»“æ„éå†**ï¼š
```python
class TreeNode:
    def __init__(self, value, children=None):
        self.value = value
        self.children = children or []

def traverse_tree(node):
    """ä½¿ç”¨yield froméå†æ ‘ç»“æ„"""
    yield node.value
    for child in node.children:
        yield from traverse_tree(child)  # é€’å½’å§”æ‰˜

# æ„å»ºæ ‘ç»“æ„
root = TreeNode('æ ¹',
    [TreeNode('åˆ†æ”¯1', [TreeNode('å¶å­1'), TreeNode('å¶å­2')]),
     TreeNode('åˆ†æ”¯2', [TreeNode('å¶å­3')])])

# éå†æ ‘
for value in traverse_tree(root):
    print(value)
# è¾“å‡º: æ ¹, åˆ†æ”¯1, å¶å­1, å¶å­2, åˆ†æ”¯2, å¶å­3
```

**ğŸ“ æ–‡ä»¶ç³»ç»Ÿæ‰«æ**ï¼š
```python
import os

def scan_directory(path):
    """é€’å½’æ‰«æç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶"""
    try:
        for item in os.listdir(path):
            item_path = os.path.join(path, item)
            
            if os.path.isfile(item_path):
                yield item_path  # è¿”å›æ–‡ä»¶è·¯å¾„
            elif os.path.isdir(item_path):
                yield from scan_directory(item_path)  # é€’å½’å§”æ‰˜
                
    except PermissionError:
        pass  # è·³è¿‡æ— æƒé™è®¿é—®çš„ç›®å½•

# ä½¿ç”¨ç¤ºä¾‹ï¼ˆæ³¨é‡Šæ‰é¿å…å®é™…æ‰§è¡Œï¼‰
# for file_path in scan_directory('/some/directory'):
#     if file_path.endswith('.py'):
#         print(f"æ‰¾åˆ°Pythonæ–‡ä»¶: {file_path}")
```

### 5.4 yield fromä¸å¼‚å¸¸å¤„ç†


**âš ï¸ å¼‚å¸¸é€ä¼ æœºåˆ¶**ï¼š

```python
def error_prone_generator():
    """å¯èƒ½å‡ºé”™çš„ç”Ÿæˆå™¨"""
    yield "å¼€å§‹"
    yield "ä¸­é—´"
    raise ValueError("å‡ºé”™äº†ï¼")
    yield "ç»“æŸ"  # è¿™è¡Œä¸ä¼šæ‰§è¡Œ

def safe_delegator():
    """å®‰å…¨çš„å§”æ‰˜ç”Ÿæˆå™¨"""
    try:
        yield from error_prone_generator()
    except ValueError as e:
        yield f"æ•è·å¼‚å¸¸: {e}"
        yield "æ¢å¤æ­£å¸¸"

# æµ‹è¯•å¼‚å¸¸å¤„ç†
for value in safe_delegator():
    print(value)
# è¾“å‡º: å¼€å§‹, ä¸­é—´, æ•è·å¼‚å¸¸: å‡ºé”™äº†ï¼, æ¢å¤æ­£å¸¸
```

---

## 6. ğŸ”„ ç”Ÿæˆå™¨ä¸åç¨‹å…³ç³»


### 6.1 åç¨‹çš„åŸºæœ¬æ¦‚å¿µ


**ğŸ”¸ ä»€ä¹ˆæ˜¯åç¨‹**ï¼šåç¨‹æ˜¯ä¸€ç§**ç”¨æˆ·æ€çš„è½»é‡çº§çº¿ç¨‹**ï¼Œå¯ä»¥åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸»åŠ¨è®©å‡ºæ§åˆ¶æƒï¼Œç¨åå†æ¢å¤æ‰§è¡Œã€‚

```
ä¼ ç»Ÿå‡½æ•°ï¼š
Aå‡½æ•° â†’ è°ƒç”¨Bå‡½æ•° â†’ Bæ‰§è¡Œå®Œæ¯• â†’ è¿”å›Aå‡½æ•°

åç¨‹ï¼š
åç¨‹A â†’ è®©å‡ºæ§åˆ¶æƒ â†’ åç¨‹Bæ‰§è¡Œ â†’ è®©å‡ºæ§åˆ¶æƒ â†’ åç¨‹Aç»§ç»­æ‰§è¡Œ
```

**ğŸ’¡ åç¨‹çš„ç‰¹ç‚¹**ï¼š
- **åˆä½œå¼å¤šä»»åŠ¡**ï¼šä¸»åŠ¨è®©å‡ºCPUï¼Œä¸æ˜¯è¢«æŠ¢å 
- **çŠ¶æ€ä¿æŒ**ï¼šæš‚åœæ—¶ä¿å­˜å±€éƒ¨å˜é‡å’Œæ‰§è¡Œä½ç½®
- **é«˜æ•ˆåˆ‡æ¢**ï¼šæ²¡æœ‰çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€

### 6.2 ç”Ÿæˆå™¨å®ç°ç®€å•åç¨‹


**ğŸ”§ åŸºäºç”Ÿæˆå™¨çš„åç¨‹ç¤ºä¾‹**ï¼š

```python
def simple_coroutine():
    """ç®€å•çš„åç¨‹ç¤ºä¾‹"""
    print("åç¨‹å¯åŠ¨")
    
    while True:
        value = yield  # æ¥æ”¶å¤–éƒ¨å‘é€çš„å€¼
        if value is None:
            break
        print(f"åç¨‹å¤„ç†: {value}")
        
    print("åç¨‹ç»“æŸ")

# å¯åŠ¨åç¨‹
coro = simple_coroutine()
next(coro)  # å¯åŠ¨åç¨‹ï¼ˆæ¨è¿›åˆ°ç¬¬ä¸€ä¸ªyieldï¼‰

# å‘é€æ•°æ®ç»™åç¨‹
coro.send("ä»»åŠ¡1")
coro.send("ä»»åŠ¡2") 
coro.send("ä»»åŠ¡3")

# ç»“æŸåç¨‹
coro.send(None)
```

**ğŸ”„ åç¨‹é€šä¿¡ç¤ºä¾‹**ï¼š

```python
def producer():
    """ç”Ÿäº§è€…åç¨‹"""
    for i in range(5):
        print(f"ç”Ÿäº§æ•°æ®: {i}")
        yield i

def consumer():
    """æ¶ˆè´¹è€…åç¨‹"""
    while True:
        data = yield
        if data is None:
            break
        print(f"æ¶ˆè´¹æ•°æ®: {data}")

def coordinator():
    """åè°ƒè€…ï¼šè¿æ¥ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…"""
    prod = producer()
    cons = consumer()
    next(cons)  # å¯åŠ¨æ¶ˆè´¹è€…
    
    for data in prod:
        cons.send(data)  # å°†ç”Ÿäº§è€…çš„æ•°æ®å‘é€ç»™æ¶ˆè´¹è€…
    
    cons.send(None)  # ç»“æŸæ¶ˆè´¹è€…

# è¿è¡Œåç¨‹ç³»ç»Ÿ
coordinator()
```

### 6.3 ç°ä»£Pythonä¸­çš„async/await


**ğŸ†• Python 3.5+çš„ç°ä»£åç¨‹è¯­æ³•**ï¼š

```python
import asyncio

# ä½¿ç”¨async/awaitçš„ç°ä»£åç¨‹
async def modern_coroutine(name, delay):
    """ç°ä»£åç¨‹è¯­æ³•"""
    print(f"{name} å¼€å§‹æ‰§è¡Œ")
    await asyncio.sleep(delay)  # æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ
    print(f"{name} æ‰§è¡Œå®Œæ¯•")
    return f"{name} çš„ç»“æœ"

async def main():
    """ä¸»åç¨‹"""
    # å¹¶å‘æ‰§è¡Œå¤šä¸ªåç¨‹
    tasks = [
        modern_coroutine("ä»»åŠ¡1", 1),
        modern_coroutine("ä»»åŠ¡2", 2),
        modern_coroutine("ä»»åŠ¡3", 1.5)
    ]
    
    results = await asyncio.gather(*tasks)
    print(f"æ‰€æœ‰ä»»åŠ¡å®Œæˆ: {results}")

# è¿è¡Œå¼‚æ­¥ç¨‹åº
# asyncio.run(main())  # åœ¨å®é™…ç¯å¢ƒä¸­è¿è¡Œ
```

**ğŸ”— ç”Ÿæˆå™¨åç¨‹ vs async/awaitå¯¹æ¯”**ï¼š

| ç‰¹å¾ | ç”Ÿæˆå™¨åç¨‹ | async/await |
|------|------------|-------------|
| **è¯­æ³•** | `yield`, `send()` | `async`, `await` |
| **å¯è¯»æ€§** | è¾ƒå¤æ‚ | æ›´æ¸…æ™°ç›´è§‚ |
| **æ€§èƒ½** | åŸºæœ¬ç›¸åŒ | ç•¥æœ‰ä¼˜åŒ– |
| **ç”Ÿæ€æ”¯æŒ** | æœ‰é™ | ä¸°å¯Œçš„asyncioç”Ÿæ€ |
| **æ¨èä½¿ç”¨** | Python < 3.5 | Python 3.5+ |

---

## 7. ğŸš€ æ€§èƒ½ä¼˜åŠ¿ä¸åº”ç”¨åœºæ™¯


### 7.1 å†…å­˜æ€§èƒ½ä¼˜åŠ¿


**ğŸ“Š å†…å­˜ä½¿ç”¨å¯¹æ¯”**ï¼š

```python
import sys

def memory_comparison():
    """å¯¹æ¯”åˆ—è¡¨å’Œç”Ÿæˆå™¨çš„å†…å­˜ä½¿ç”¨"""
    
    # åˆ›å»ºå¤§åˆ—è¡¨
    big_list = [x for x in range(100000)]
    list_size = sys.getsizeof(big_list)
    
    # åˆ›å»ºç”Ÿæˆå™¨
    big_generator = (x for x in range(100000))
    generator_size = sys.getsizeof(big_generator)
    
    print(f"åˆ—è¡¨å†…å­˜ä½¿ç”¨: {list_size:,} å­—èŠ‚")
    print(f"ç”Ÿæˆå™¨å†…å­˜ä½¿ç”¨: {generator_size:,} å­—èŠ‚")
    print(f"å†…å­˜èŠ‚çœ: {(list_size - generator_size) / list_size * 100:.1f}%")

# memory_comparison()
# è¾“å‡ºç¤ºä¾‹ï¼š
# åˆ—è¡¨å†…å­˜ä½¿ç”¨: 800,984 å­—èŠ‚
# ç”Ÿæˆå™¨å†…å­˜ä½¿ç”¨: 112 å­—èŠ‚  
# å†…å­˜èŠ‚çœ: 99.9%
```

**âš¡ æ—¶é—´æ€§èƒ½æµ‹è¯•**ï¼š

```python
import time

def performance_test():
    """æ€§èƒ½æµ‹è¯•ï¼šåˆ›å»ºæ—¶é—´å¯¹æ¯”"""
    
    # æµ‹è¯•åˆ—è¡¨åˆ›å»ºæ—¶é—´
    start = time.time()
    big_list = [x * 2 for x in range(1000000)]
    list_time = time.time() - start
    
    # æµ‹è¯•ç”Ÿæˆå™¨åˆ›å»ºæ—¶é—´
    start = time.time()
    big_gen = (x * 2 for x in range(1000000))
    gen_time = time.time() - start
    
    print(f"åˆ—è¡¨åˆ›å»ºæ—¶é—´: {list_time:.4f} ç§’")
    print(f"ç”Ÿæˆå™¨åˆ›å»ºæ—¶é—´: {gen_time:.6f} ç§’")
    print(f"ç”Ÿæˆå™¨å¿«äº†: {list_time / gen_time:.0f} å€")

# performance_test()
# è¾“å‡ºç¤ºä¾‹ï¼š
# åˆ—è¡¨åˆ›å»ºæ—¶é—´: 0.0842 ç§’
# ç”Ÿæˆå™¨åˆ›å»ºæ—¶é—´: 0.000001 ç§’
# ç”Ÿæˆå™¨å¿«äº†: 84200 å€
```

### 7.2 å…¸å‹åº”ç”¨åœºæ™¯


**ğŸ—‚ï¸ åœºæ™¯1ï¼šå¤§æ–‡ä»¶å¤„ç†**

```python
def process_large_log_file(filename):
    """å¤„ç†å¤§å‹æ—¥å¿—æ–‡ä»¶"""
    def read_log_lines(filename):
        with open(filename, 'r') as file:
            for line in file:
                yield line.strip()
    
    def filter_errors(lines):
        for line in lines:
            if 'ERROR' in line:
                yield line
    
    def extract_timestamp(error_lines):
        for line in error_lines:
            # å‡è®¾æ—¶é—´æˆ³åœ¨è¡Œé¦–
            timestamp = line.split()[0]
            yield timestamp
    
    # æ„å»ºå¤„ç†ç®¡é“
    log_lines = read_log_lines(filename)
    error_lines = filter_errors(log_lines)
    timestamps = extract_timestamp(error_lines)
    
    # åªå¤„ç†å‰10ä¸ªé”™è¯¯
    for i, timestamp in enumerate(timestamps):
        if i >= 10:
            break
        print(f"é”™è¯¯æ—¶é—´: {timestamp}")

# ä¼˜åŠ¿ï¼šå³ä½¿æ–‡ä»¶æœ‰å‡ GBï¼Œå†…å­˜ä½¿ç”¨ä¹Ÿå¾ˆå°‘
```

**ğŸŒ åœºæ™¯2ï¼šç½‘ç»œæ•°æ®æµå¤„ç†**

```python
def simulate_data_stream():
    """æ¨¡æ‹Ÿç½‘ç»œæ•°æ®æµ"""
    def fetch_data_stream():
        # æ¨¡æ‹ŸæŒç»­çš„æ•°æ®æµ
        import random
        while True:
            # æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿå’Œæ•°æ®
            yield {
                'id': random.randint(1, 1000),
                'value': random.random(),
                'timestamp': time.time()
            }
    
    def filter_high_values(stream, threshold=0.8):
        for data in stream:
            if data['value'] > threshold:
                yield data
    
    def format_alerts(high_value_stream):
        for data in high_value_stream:
            yield f"ğŸš¨ è­¦æŠ¥ï¼ID {data['id']} æ•°å€¼è¿‡é«˜: {data['value']:.3f}"
    
    # æ„å»ºå®æ—¶å¤„ç†ç®¡é“
    stream = fetch_data_stream()
    high_values = filter_high_values(stream)
    alerts = format_alerts(high_values)
    
    # å¤„ç†å‰5ä¸ªè­¦æŠ¥
    for i, alert in enumerate(alerts):
        if i >= 5:
            break
        print(alert)
        time.sleep(0.1)  # æ¨¡æ‹Ÿå¤„ç†æ—¶é—´

# simulate_data_stream()
```

**ğŸ”„ åœºæ™¯3ï¼šæ— é™åºåˆ—ç”Ÿæˆ**

```python
def mathematical_sequences():
    """æ•°å­¦åºåˆ—ç”Ÿæˆå™¨"""
    
    def primes():
        """ç”Ÿæˆè´¨æ•°åºåˆ—"""
        def is_prime(n):
            if n < 2:
                return False
            for i in range(2, int(n**0.5) + 1):
                if n % i == 0:
                    return False
            return True
        
        n = 2
        while True:
            if is_prime(n):
                yield n
            n += 1
    
    def collatz_sequence(start):
        """ç”Ÿæˆè€ƒæ‹‰å…¹çŒœæƒ³åºåˆ—"""
        n = start
        while n != 1:
            yield n
            n = n // 2 if n % 2 == 0 else 3 * n + 1
        yield 1
    
    # ä½¿ç”¨ç¤ºä¾‹
    print("å‰10ä¸ªè´¨æ•°:")
    prime_gen = primes()
    for i, prime in enumerate(prime_gen):
        if i >= 10:
            break
        print(prime, end=' ')
    
    print("\n\nè€ƒæ‹‰å…¹åºåˆ— (èµ·å§‹å€¼27):")
    for num in collatz_sequence(27):
        print(num, end=' ')
    print()

# mathematical_sequences()
```

### 7.3 ç”Ÿæˆå™¨çš„æœ€ä½³å®è·µ


**âœ… é€‚åˆä½¿ç”¨ç”Ÿæˆå™¨çš„æƒ…å†µ**ï¼š
- ğŸ”¸ å¤„ç†å¤§æ•°æ®é›†ï¼Œå†…å­˜æœ‰é™
- ğŸ”¸ æ•°æ®æµå¤„ç†ï¼Œå®æ—¶å¤„ç†
- ğŸ”¸ æ— é™åºåˆ—æˆ–æ‡’åŠ è½½éœ€æ±‚
- ğŸ”¸ ç®¡é“å¼æ•°æ®å¤„ç†
- ğŸ”¸ åªéœ€è¦éƒ¨åˆ†ç»“æœçš„æƒ…å†µ

**âŒ ä¸é€‚åˆä½¿ç”¨ç”Ÿæˆå™¨çš„æƒ…å†µ**ï¼š
- ğŸ”¸ éœ€è¦å¤šæ¬¡éå†ç›¸åŒæ•°æ®
- ğŸ”¸ éœ€è¦éšæœºè®¿é—®å…ƒç´ 
- ğŸ”¸ æ•°æ®é‡å¾ˆå°ï¼ˆ< 1000ä¸ªå…ƒç´ ï¼‰
- ğŸ”¸ éœ€è¦len()ã€count()ç­‰ç»Ÿè®¡æ“ä½œ

**ğŸ¯ æ€§èƒ½ä¼˜åŒ–æŠ€å·§**ï¼š

```python
def optimization_tips():
    """ç”Ÿæˆå™¨æ€§èƒ½ä¼˜åŒ–æŠ€å·§"""
    
    # 1. ä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼æ›¿ä»£ç®€å•çš„ç”Ÿæˆå™¨å‡½æ•°
    # å¥½çš„åšæ³•
    squares = (x**2 for x in range(1000))
    
    # ä¸å¿…è¦çš„åšæ³•
    def square_generator():
        for x in range(1000):
            yield x**2
    
    # 2. åˆç†ä½¿ç”¨yield from
    def efficient_flatten(nested_list):
        for sublist in nested_list:
            yield from sublist  # æ¯”å¾ªç¯yieldæ›´é«˜æ•ˆ
    
    # 3. é¿å…åœ¨ç”Ÿæˆå™¨ä¸­è¿›è¡Œæ˜‚è´µçš„è®¡ç®—
    def smart_processing(data):
        for item in data:
            # åªåœ¨éœ€è¦æ—¶æ‰è¿›è¡Œå¤æ‚è®¡ç®—
            if item > threshold:  # å…ˆè¿›è¡Œç®€å•è¿‡æ»¤
                yield expensive_calculation(item)

def expensive_calculation(x):
    return x ** 3  # æ¨¡æ‹Ÿæ˜‚è´µè®¡ç®—

threshold = 100
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ç”Ÿæˆå™¨æœ¬è´¨ï¼šå»¶è¿Ÿè®¡ç®—çš„è¿­ä»£å™¨ï¼ŒæŒ‰éœ€ç”Ÿæˆå€¼
ğŸ”¸ yieldå…³é”®å­—ï¼šæš‚åœå‡½æ•°æ‰§è¡Œï¼Œä¿å­˜çŠ¶æ€ï¼Œè¿”å›å€¼
ğŸ”¸ ç”Ÿæˆå™¨è¡¨è¾¾å¼ï¼š(expression for item in iterable) çš„ç®€æ´è¯­æ³•
ğŸ”¸ ç”Ÿæˆå™¨æ–¹æ³•ï¼šsend()ã€throw()ã€close() çš„é«˜çº§æ§åˆ¶
ğŸ”¸ yield fromï¼šå§”æ‰˜ç»™å…¶ä»–ç”Ÿæˆå™¨ï¼Œæ”¯æŒå¼‚å¸¸é€ä¼ 
ğŸ”¸ æ€§èƒ½ä¼˜åŠ¿ï¼šæä½å†…å­˜ä½¿ç”¨ï¼Œå¿«é€Ÿåˆ›å»ºï¼Œé€‚åˆå¤§æ•°æ®å¤„ç†
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ç”Ÿæˆå™¨ vs æ™®é€šå‡½æ•°çš„æœ¬è´¨åŒºåˆ«**ï¼š
```
æ™®é€šå‡½æ•°ï¼šè°ƒç”¨ â†’ æ‰§è¡Œå®Œæ¯• â†’ è¿”å›ç»“æœ â†’ é”€æ¯
ç”Ÿæˆå™¨å‡½æ•°ï¼šè°ƒç”¨ â†’ åˆ›å»ºç”Ÿæˆå™¨å¯¹è±¡ â†’ æŒ‰éœ€æ‰§è¡Œ â†’ ä¿æŒçŠ¶æ€
```

**ğŸ”¹ å†…å­˜æ•ˆç‡çš„æ ¹æœ¬åŸå› **ï¼š
```
åˆ—è¡¨ï¼šä¸€æ¬¡æ€§åˆ›å»ºæ‰€æœ‰å…ƒç´  â†’ å ç”¨å¤§é‡å†…å­˜
ç”Ÿæˆå™¨ï¼šæŒ‰éœ€ç”Ÿæˆä¸€ä¸ªå…ƒç´  â†’ å§‹ç»ˆåªå ç”¨ä¸€ä¸ªå…ƒç´ çš„å†…å­˜
```

**ğŸ”¹ é€‚ç”¨åœºæ™¯åˆ¤æ–­æ ‡å‡†**ï¼š
```
âœ… æ•°æ®é‡å¤§ + å†…å­˜æœ‰é™ â†’ ä½¿ç”¨ç”Ÿæˆå™¨
âœ… æµå¼å¤„ç† + å®æ—¶éœ€æ±‚ â†’ ä½¿ç”¨ç”Ÿæˆå™¨  
âœ… éƒ¨åˆ†ä½¿ç”¨ + æå‰é€€å‡º â†’ ä½¿ç”¨ç”Ÿæˆå™¨
âŒ å°æ•°æ® + å¤šæ¬¡è®¿é—® â†’ ä½¿ç”¨åˆ—è¡¨
âŒ éšæœºè®¿é—® + ç»Ÿè®¡æ“ä½œ â†’ ä½¿ç”¨åˆ—è¡¨
```

### 8.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ’¼ å·¥ä½œä¸­çš„å®é™…ç”¨é€”**ï¼š
- **æ•°æ®åˆ†æ**ï¼šå¤„ç†å¤§å‹CSVã€æ—¥å¿—æ–‡ä»¶
- **ç½‘ç»œç¼–ç¨‹**ï¼šå¤„ç†æ•°æ®æµã€å®æ—¶é€šä¿¡
- **ç³»ç»Ÿç›‘æ§**ï¼šæŒç»­ç›‘æ§ç³»ç»ŸçŠ¶æ€
- **ç®—æ³•å®ç°**ï¼šç”Ÿæˆæ•°å­¦åºåˆ—ã€æœç´¢ç®—æ³•
- **æ€§èƒ½ä¼˜åŒ–**ï¼šå‡å°‘å†…å­˜ä½¿ç”¨ï¼Œæé«˜å“åº”é€Ÿåº¦

**ğŸ”§ ç¼–ç¨‹æœ€ä½³å®è·µ**ï¼š
- ä¼˜å…ˆè€ƒè™‘ç”Ÿæˆå™¨è¡¨è¾¾å¼çš„ç®€æ´æ€§
- ä½¿ç”¨`yield from`å¤„ç†åµŒå¥—ç»“æ„
- åˆç†ä½¿ç”¨ç”Ÿæˆå™¨æ–¹æ³•è¿›è¡Œé«˜çº§æ§åˆ¶
- åœ¨é€‚å½“åœºæ™¯é€‰æ‹©ç”Ÿæˆå™¨è€Œéåˆ—è¡¨
- æ„å»ºæ•°æ®å¤„ç†ç®¡é“æé«˜ä»£ç å¯è¯»æ€§

**ğŸ“ å­¦ä¹ å»ºè®®**ï¼š
1. **ä»ç®€å•å¼€å§‹**ï¼šå…ˆæŒæ¡åŸºæœ¬çš„`yield`è¯­æ³•
2. **ç†è§£åŸç†**ï¼šé‡ç‚¹ç†è§£å»¶è¿Ÿè®¡ç®—å’ŒçŠ¶æ€ä¿æŒ
3. **å¤šåšç»ƒä¹ **ï¼šç”¨ç”Ÿæˆå™¨é‡å†™ç°æœ‰çš„åˆ—è¡¨å¤„ç†ä»£ç 
4. **å…³æ³¨æ€§èƒ½**ï¼šåœ¨å®é™…é¡¹ç›®ä¸­æµ‹è¯•å†…å­˜å’Œæ—¶é—´æ•ˆæœ
5. **æŒæ¡è¿›é˜¶**ï¼šå­¦ä¼šä½¿ç”¨`send()`ã€`throw()`ç­‰é«˜çº§ç‰¹æ€§

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- ç”Ÿæˆå™¨lazyæ€§è´¨å¥½ï¼ŒæŒ‰éœ€è®¡ç®—å†…å­˜å°‘
- yieldæš‚åœä¿çŠ¶æ€ï¼Œsendé€šä¿¡throwå¼‚å¸¸
- yield fromæ¥å§”æ‰˜ï¼Œå¼‚å¸¸é€ä¼ å¾ˆé‡è¦  
- å¤§æ•°æ®æµæœ€é€‚åˆï¼Œå°æ•°æ®åˆ—è¡¨æ›´é«˜æ•ˆ