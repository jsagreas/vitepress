---
title: 7ã€å­—å…¸é«˜çº§åº”ç”¨
---
## ğŸ“š ç›®å½•

1. [å­—å…¸æ¨å¯¼å¼](#1-å­—å…¸æ¨å¯¼å¼)
2. [åµŒå¥—å­—å…¸å¤„ç†](#2-åµŒå¥—å­—å…¸å¤„ç†)
3. [å­—å…¸ä½œä¸ºç¼“å­˜ä½¿ç”¨](#3-å­—å…¸ä½œä¸ºç¼“å­˜ä½¿ç”¨)
4. [å­—å…¸ä¸JSONè½¬æ¢](#4-å­—å…¸ä¸jsonè½¬æ¢)
5. [defaultdicté»˜è®¤å­—å…¸](#5-defaultdicté»˜è®¤å­—å…¸)
6. [OrderedDictæœ‰åºå­—å…¸](#6-ordereddictæœ‰åºå­—å…¸)
7. [Counterè®¡æ•°å™¨](#7-counterè®¡æ•°å™¨)
8. [ChainMapå­—å…¸é“¾](#8-chainmapå­—å…¸é“¾)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ“ å­—å…¸æ¨å¯¼å¼


### 1.1 ä»€ä¹ˆæ˜¯å­—å…¸æ¨å¯¼å¼


**ğŸ’¡ é€šä¿—ç†è§£**ï¼šå­—å…¸æ¨å¯¼å¼å°±åƒæ˜¯ä¸€ä¸ª"å­—å…¸ç”Ÿäº§çº¿"ï¼Œä½ ç»™å®ƒä¸€ä¸ªè§„åˆ™ï¼Œå®ƒå°±èƒ½æŒ‰ç…§è¿™ä¸ªè§„åˆ™å¿«é€Ÿç”Ÿäº§å‡ºä¸€ä¸ªæ–°å­—å…¸ã€‚

```python
# ä¼ ç»Ÿæ–¹æ³•ï¼šä¸€æ­¥æ­¥å»ºå­—å…¸
numbers = [1, 2, 3, 4, 5]
squares = {}
for num in numbers:
    squares[num] = num ** 2
print(squares)  # {1: 1, 2: 4, 3: 9, 4: 16, 5: 25}

# å­—å…¸æ¨å¯¼å¼ï¼šä¸€è¡Œæå®š
squares = {num: num ** 2 for num in numbers}
print(squares)  # {1: 1, 2: 4, 3: 9, 4: 16, 5: 25}
```

### 1.2 å­—å…¸æ¨å¯¼å¼çš„åŸºæœ¬è¯­æ³•


```
{é”®è¡¨è¾¾å¼: å€¼è¡¨è¾¾å¼ for å˜é‡ in å¯è¿­ä»£å¯¹è±¡}
```

**ğŸ”¸ è¯­æ³•æ‹†è§£**ï¼š
- `é”®è¡¨è¾¾å¼`ï¼šå†³å®šå­—å…¸çš„é”®æ˜¯ä»€ä¹ˆ
- `å€¼è¡¨è¾¾å¼`ï¼šå†³å®šå­—å…¸çš„å€¼æ˜¯ä»€ä¹ˆ  
- `for å˜é‡ in å¯è¿­ä»£å¯¹è±¡`ï¼šæ•°æ®æ¥æº

### 1.3 å®ç”¨åœºæ™¯ç¤ºä¾‹


**ğŸ¯ åœºæ™¯1ï¼šåˆ›å»ºåå‘æ˜ å°„**
```python
# åŸå­—å…¸ï¼šä¸­æ–‡å -> è‹±æ–‡å
chinese_english = {'è‹¹æœ': 'apple', 'é¦™è•‰': 'banana', 'æ©™å­': 'orange'}

# åˆ›å»ºåå‘å­—å…¸ï¼šè‹±æ–‡å -> ä¸­æ–‡å
english_chinese = {v: k for k, v in chinese_english.items()}
print(english_chinese)  # {'apple': 'è‹¹æœ', 'banana': 'é¦™è•‰', 'orange': 'æ©™å­'}
```

**ğŸ¯ åœºæ™¯2ï¼šæ•°æ®ç­›é€‰å’Œè½¬æ¢**
```python
# å­¦ç”Ÿæˆç»©æ•°æ®
scores = {'å°æ˜': 85, 'å°çº¢': 92, 'å°åˆš': 78, 'å°ä¸½': 96, 'å°å': 65}

# ç­›é€‰å‡ºåŠæ ¼å­¦ç”Ÿ(â‰¥80åˆ†)å¹¶è½¬æ¢æ ¼å¼
passed_students = {name: f"{score}åˆ†" for name, score in scores.items() if score >= 80}
print(passed_students)  # {'å°æ˜': '85åˆ†', 'å°çº¢': '92åˆ†', 'å°ä¸½': '96åˆ†'}
```

**ğŸ¯ åœºæ™¯3ï¼šå­—ç¬¦ä¸²å¤„ç†**
```python
text = "hello world"
# ç»Ÿè®¡æ¯ä¸ªå­—ç¬¦çš„ä½ç½®
char_positions = {char: i for i, char in enumerate(text) if char != ' '}
print(char_positions)  # {'h': 0, 'e': 1, 'l': 9, 'o': 10, 'w': 6, 'r': 8, 'd': 10}
```

---

## 2. ğŸ—ï¸ åµŒå¥—å­—å…¸å¤„ç†


### 2.1 ä»€ä¹ˆæ˜¯åµŒå¥—å­—å…¸


**ğŸ’¡ é€šä¿—ç†è§£**ï¼šåµŒå¥—å­—å…¸å°±åƒæ˜¯"å¥—å¨ƒ"ï¼Œä¸€ä¸ªå­—å…¸é‡Œé¢è¿˜æœ‰å­—å…¸ã€‚æ¯”å¦‚å…¬å¸éƒ¨é—¨ä¿¡æ¯ï¼š

```
å…¬å¸
â”œâ”€â”€ æŠ€æœ¯éƒ¨
â”‚   â”œâ”€â”€ å‰ç«¯ç»„ï¼š[å°æ˜, å°çº¢]
â”‚   â””â”€â”€ åç«¯ç»„ï¼š[å°åˆš, å°ä¸½]
â””â”€â”€ é”€å”®éƒ¨
    â”œâ”€â”€ åä¸œåŒºï¼š[å°å, å°å¼º]  
    â””â”€â”€ åå—åŒºï¼š[å°ç¾, å°å³°]
```

### 2.2 åˆ›å»ºå’Œè®¿é—®åµŒå¥—å­—å…¸


```python
# åˆ›å»ºå…¬å¸ç»„ç»‡æ¶æ„
company = {
    'æŠ€æœ¯éƒ¨': {
        'å‰ç«¯ç»„': ['å°æ˜', 'å°çº¢'],
        'åç«¯ç»„': ['å°åˆš', 'å°ä¸½']
    },
    'é”€å”®éƒ¨': {
        'åä¸œåŒº': ['å°å', 'å°å¼º'],
        'åå—åŒº': ['å°ç¾', 'å°å³°']
    }
}

# è®¿é—®åµŒå¥—æ•°æ®
print(company['æŠ€æœ¯éƒ¨']['å‰ç«¯ç»„'])  # ['å°æ˜', 'å°çº¢']
print(company['é”€å”®éƒ¨']['åä¸œåŒº'][0])  # å°å
```

### 2.3 å®‰å…¨è®¿é—®åµŒå¥—å­—å…¸


**âš ï¸ é—®é¢˜**ï¼šç›´æ¥è®¿é—®å¯èƒ½å‡ºé”™
```python
# è¿™æ ·å¯èƒ½æŠ¥é”™ KeyError
# print(company['è´¢åŠ¡éƒ¨']['ä¼šè®¡ç»„'])  # è´¢åŠ¡éƒ¨ä¸å­˜åœ¨ï¼
```

**âœ… è§£å†³æ–¹æ¡ˆ1ï¼šä½¿ç”¨get()æ–¹æ³•**
```python
# å®‰å…¨è®¿é—®ï¼Œä¸å­˜åœ¨è¿”å›None
finance_dept = company.get('è´¢åŠ¡éƒ¨', {})
accounting_group = finance_dept.get('ä¼šè®¡ç»„', [])
print(accounting_group)  # []
```

**âœ… è§£å†³æ–¹æ¡ˆ2ï¼šå°è£…å®‰å…¨è®¿é—®å‡½æ•°**
```python
def safe_get_nested(data, *keys):
    """å®‰å…¨è·å–åµŒå¥—å­—å…¸çš„å€¼"""
    for key in keys:
        if isinstance(data, dict) and key in data:
            data = data[key]
        else:
            return None
    return data

# ä½¿ç”¨ç¤ºä¾‹
result = safe_get_nested(company, 'æŠ€æœ¯éƒ¨', 'å‰ç«¯ç»„')
print(result)  # ['å°æ˜', 'å°çº¢']

result = safe_get_nested(company, 'è´¢åŠ¡éƒ¨', 'ä¼šè®¡ç»„')  
print(result)  # None
```

### 2.4 ä¿®æ”¹åµŒå¥—å­—å…¸


```python
# æ·»åŠ æ–°éƒ¨é—¨
company['è´¢åŠ¡éƒ¨'] = {
    'ä¼šè®¡ç»„': ['å°å¼ ', 'å°æ'],
    'å‡ºçº³ç»„': ['å°ç‹']
}

# å‘ç°æœ‰ç»„æ·»åŠ æˆå‘˜
company['æŠ€æœ¯éƒ¨']['å‰ç«¯ç»„'].append('å°æ–°')

# æ·»åŠ æ–°çš„å°ç»„
company['æŠ€æœ¯éƒ¨']['æµ‹è¯•ç»„'] = ['å°æµ‹', 'å°è¯•']

print(company['æŠ€æœ¯éƒ¨'])
# {'å‰ç«¯ç»„': ['å°æ˜', 'å°çº¢', 'å°æ–°'], 'åç«¯ç»„': ['å°åˆš', 'å°ä¸½'], 'æµ‹è¯•ç»„': ['å°æµ‹', 'å°è¯•']}
```

### 2.5 éå†åµŒå¥—å­—å…¸


```python
def print_company_structure(data, level=0):
    """é€’å½’æ‰“å°å…¬å¸ç»“æ„"""
    indent = "  " * level  # ç¼©è¿›è¡¨ç¤ºå±‚çº§
    
    for key, value in data.items():
        if isinstance(value, dict):
            print(f"{indent}{key}:")
            print_company_structure(value, level + 1)
        elif isinstance(value, list):
            print(f"{indent}{key}: {', '.join(value)}")
        else:
            print(f"{indent}{key}: {value}")

print_company_structure(company)
```

**è¾“å‡ºæ•ˆæœ**ï¼š
```
æŠ€æœ¯éƒ¨:
  å‰ç«¯ç»„: å°æ˜, å°çº¢, å°æ–°
  åç«¯ç»„: å°åˆš, å°ä¸½
  æµ‹è¯•ç»„: å°æµ‹, å°è¯•
é”€å”®éƒ¨:
  åä¸œåŒº: å°å, å°å¼º
  åå—åŒº: å°ç¾, å°å³°
è´¢åŠ¡éƒ¨:
  ä¼šè®¡ç»„: å°å¼ , å°æ
  å‡ºçº³ç»„: å°ç‹
```

---

## 3. ğŸ’¾ å­—å…¸ä½œä¸ºç¼“å­˜ä½¿ç”¨


### 3.1 ä»€ä¹ˆæ˜¯ç¼“å­˜


**ğŸ’¡ é€šä¿—ç†è§£**ï¼šç¼“å­˜å°±åƒæ˜¯"å°æŠ„æœ¬"ï¼ŒæŠŠè®¡ç®—è¿‡çš„ç»“æœè®°ä¸‹æ¥ï¼Œä¸‹æ¬¡é‡åˆ°åŒæ ·çš„é—®é¢˜å°±ä¸ç”¨é‡æ–°è®¡ç®—äº†ï¼Œç›´æ¥æŸ¥"å°æŠ„"ã€‚

### 3.2 ç®€å•ç¼“å­˜å®ç°


```python
# è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼ˆå¾ˆæ…¢çš„é€’å½’ç‰ˆæœ¬ï¼‰
def fibonacci_slow(n):
    """æ²¡æœ‰ç¼“å­˜çš„æ–æ³¢é‚£å¥‘å‡½æ•°"""
    if n <= 1:
        return n
    return fibonacci_slow(n-1) + fibonacci_slow(n-2)

# å¸¦ç¼“å­˜çš„ç‰ˆæœ¬
fibonacci_cache = {}  # è¿™å°±æ˜¯æˆ‘ä»¬çš„"å°æŠ„æœ¬"

def fibonacci_fast(n):
    """æœ‰ç¼“å­˜çš„æ–æ³¢é‚£å¥‘å‡½æ•°"""
    # å…ˆæŸ¥å°æŠ„æœ¬ï¼Œçœ‹çœ‹ä¹‹å‰ç®—è¿‡æ²¡æœ‰
    if n in fibonacci_cache:
        print(f"ä»ç¼“å­˜è·å– f({n})")
        return fibonacci_cache[n]
    
    # æ²¡ç®—è¿‡ï¼Œé‚£å°±ç®—ä¸€é
    if n <= 1:
        result = n
    else:
        result = fibonacci_fast(n-1) + fibonacci_fast(n-2)
    
    # æŠŠç»“æœè®°åˆ°å°æŠ„æœ¬ä¸Š
    fibonacci_cache[n] = result
    print(f"è®¡ç®—å¹¶ç¼“å­˜ f({n}) = {result}")
    return result

# æµ‹è¯•æ•ˆæœ
print(fibonacci_fast(10))
print("å†æ¬¡è®¡ç®—:")
print(fibonacci_fast(10))  # è¿™æ¬¡ç›´æ¥ä»ç¼“å­˜å–
```

### 3.3 LRUç¼“å­˜ï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰


**ğŸ’¡ é€šä¿—ç†è§£**ï¼šLRUå°±åƒæ•´ç†ä¹¦æ¡Œï¼Œæœ€è¿‘ç”¨è¿‡çš„ä¹¦æ”¾åœ¨æ‰‹è¾¹ï¼Œå¾ˆä¹…æ²¡ç”¨çš„ä¹¦æ”¾åˆ°è§’è½ï¼Œä¹¦æ¡Œæ»¡äº†å°±æŠŠæœ€ä¹…æ²¡ç”¨çš„ä¹¦æ”¶èµ·æ¥ã€‚

```python
from functools import lru_cache

@lru_cache(maxsize=128)  # æœ€å¤šç¼“å­˜128ä¸ªç»“æœ
def expensive_calculation(x, y):
    """æ¨¡æ‹Ÿä¸€ä¸ªè€—æ—¶çš„è®¡ç®—"""
    print(f"æ­£åœ¨è®¡ç®— {x} + {y}...")
    import time
    time.sleep(1)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
    return x + y

# ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œéœ€è¦è®¡ç®—
print(expensive_calculation(3, 5))  # æ­£åœ¨è®¡ç®— 3 + 5... ç„¶åè¾“å‡º 8

# ç¬¬äºŒæ¬¡è°ƒç”¨ï¼Œç›´æ¥ä»ç¼“å­˜å–
print(expensive_calculation(3, 5))  # ç›´æ¥è¾“å‡º 8ï¼Œå¾ˆå¿«

# æŸ¥çœ‹ç¼“å­˜ä¿¡æ¯
print(expensive_calculation.cache_info())
# CacheInfo(hits=1, misses=1, maxsize=128, currsize=1)
```

### 3.4 è‡ªå®šä¹‰ç¼“å­˜è£…é¥°å™¨


```python
def simple_cache(func):
    """ç®€å•çš„ç¼“å­˜è£…é¥°å™¨"""
    cache = {}
    
    def wrapper(*args, **kwargs):
        # åˆ›å»ºç¼“å­˜é”®ï¼ˆæŠŠå‚æ•°ç»„åˆæˆå”¯ä¸€æ ‡è¯†ï¼‰
        key = str(args) + str(sorted(kwargs.items()))
        
        if key in cache:
            print(f"ç¼“å­˜å‘½ä¸­: {func.__name__}{args}")
            return cache[key]
        
        # æ‰§è¡ŒåŸå‡½æ•°
        result = func(*args, **kwargs)
        cache[key] = result
        print(f"è®¡ç®—ç»“æœ: {func.__name__}{args} = {result}")
        return result
    
    # æ·»åŠ æŸ¥çœ‹ç¼“å­˜çš„æ–¹æ³•
    wrapper.cache = cache
    wrapper.clear_cache = lambda: cache.clear()
    
    return wrapper

@simple_cache
def multiply(a, b):
    return a * b

# ä½¿ç”¨ç¤ºä¾‹
print(multiply(3, 4))  # è®¡ç®—ç»“æœ: multiply(3, 4) = 12
print(multiply(3, 4))  # ç¼“å­˜å‘½ä¸­: multiply(3, 4)
print("å½“å‰ç¼“å­˜:", multiply.cache)
```

---

## 4. ğŸ”„ å­—å…¸ä¸JSONè½¬æ¢


### 4.1 ä»€ä¹ˆæ˜¯JSON


**ğŸ’¡ é€šä¿—ç†è§£**ï¼šJSONå°±åƒæ˜¯"é€šç”¨è¯­è¨€"ï¼Œä¸ç®¡æ˜¯Pythonã€JavaScriptè¿˜æ˜¯å…¶ä»–è¯­è¨€ï¼Œå¤§å®¶éƒ½èƒ½ç†è§£ã€‚å®ƒæ˜¯ä¸€ç§æ–‡æœ¬æ ¼å¼ï¼Œä¸“é—¨ç”¨æ¥å­˜å‚¨å’Œä¼ è¾“æ•°æ®ã€‚

```
Pythonå­—å…¸: {'name': 'å°æ˜', 'age': 20}
JSONå­—ç¬¦ä¸²: '{"name": "å°æ˜", "age": 20}'
```

### 4.2 å­—å…¸è½¬JSONï¼ˆåºåˆ—åŒ–ï¼‰


```python
import json

# Pythonå­—å…¸
student = {
    'name': 'å°æ˜',
    'age': 20,
    'courses': ['æ•°å­¦', 'ç‰©ç†', 'åŒ–å­¦'],
    'is_graduated': False,
    'score': None
}

# è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²
json_string = json.dumps(student, ensure_ascii=False, indent=2)
print("JSONå­—ç¬¦ä¸²:")
print(json_string)
```

**è¾“å‡ºæ•ˆæœ**ï¼š
```json
{
  "name": "å°æ˜",
  "age": 20,
  "courses": [
    "æ•°å­¦",
    "ç‰©ç†", 
    "åŒ–å­¦"
  ],
  "is_graduated": false,
  "score": null
}
```

**ğŸ”¸ é‡è¦å‚æ•°è¯´æ˜**ï¼š
- `ensure_ascii=False`ï¼šå…è®¸ä¸­æ–‡å­—ç¬¦ï¼Œä¸è½¬æ¢æˆunicodeç¼–ç 
- `indent=2`ï¼šæ ¼å¼åŒ–è¾“å‡ºï¼Œæ¯å±‚ç¼©è¿›2ä¸ªç©ºæ ¼
- `sort_keys=True`ï¼šæŒ‰é”®åæ’åº

### 4.3 JSONè½¬å­—å…¸ï¼ˆååºåˆ—åŒ–ï¼‰


```python
# JSONå­—ç¬¦ä¸²è½¬å›Pythonå­—å…¸
json_data = '''
{
  "name": "å°çº¢",
  "age": 21,
  "courses": ["è‹±è¯­", "å†å²"],
  "is_graduated": true
}
'''

student_dict = json.loads(json_data)
print("è½¬æ¢åçš„å­—å…¸:")
print(student_dict)
print(f"å­¦ç”Ÿå§“å: {student_dict['name']}")
```

### 4.4 æ–‡ä»¶æ“ä½œ


**ğŸ’¾ ä¿å­˜åˆ°æ–‡ä»¶**ï¼š
```python
students = [
    {'name': 'å°æ˜', 'score': 85},
    {'name': 'å°çº¢', 'score': 92},
    {'name': 'å°åˆš', 'score': 78}
]

# ä¿å­˜åˆ°JSONæ–‡ä»¶
with open('students.json', 'w', encoding='utf-8') as file:
    json.dump(students, file, ensure_ascii=False, indent=2)

print("æ•°æ®å·²ä¿å­˜åˆ° students.json")
```

**ğŸ“‚ ä»æ–‡ä»¶è¯»å–**ï¼š
```python
# ä»JSONæ–‡ä»¶è¯»å–
with open('students.json', 'r', encoding='utf-8') as file:
    loaded_students = json.load(file)

print("ä»æ–‡ä»¶è¯»å–çš„æ•°æ®:")
for student in loaded_students:
    print(f"{student['name']}: {student['score']}åˆ†")
```

### 4.5 å¤„ç†å¤æ‚æ•°æ®ç±»å‹


```python
from datetime import datetime
import json

class DateTimeEncoder(json.JSONEncoder):
    """è‡ªå®šä¹‰JSONç¼–ç å™¨ï¼Œå¤„ç†æ—¥æœŸæ—¶é—´"""
    def default(self, obj):
        if isinstance(obj, datetime):
            return obj.strftime('%Y-%m-%d %H:%M:%S')
        return super().default(obj)

# åŒ…å«æ—¥æœŸçš„æ•°æ®
event = {
    'title': 'ä¼šè®®',
    'date': datetime.now(),
    'attendees': ['å°æ˜', 'å°çº¢']
}

# ä½¿ç”¨è‡ªå®šä¹‰ç¼–ç å™¨
json_string = json.dumps(event, cls=DateTimeEncoder, ensure_ascii=False, indent=2)
print(json_string)
```

---

## 5. ğŸ¯ defaultdicté»˜è®¤å­—å…¸


### 5.1 defaultdictæ˜¯ä»€ä¹ˆ


**ğŸ’¡ é€šä¿—ç†è§£**ï¼šæ™®é€šå­—å…¸å°±åƒä¸€ä¸ªæ²¡æœ‰é»˜è®¤å€¼çš„æŸœå­ï¼Œä½ è¦ä»€ä¹ˆä¸œè¥¿ï¼ŒæŸœå­é‡Œæ²¡æœ‰å°±æŠ¥é”™ã€‚è€Œdefaultdictåƒæ˜¯ä¸€ä¸ª"æ™ºèƒ½æŸœå­"ï¼Œä½ è¦ä»€ä¹ˆæ²¡æœ‰çš„ä¸œè¥¿ï¼Œå®ƒä¼šè‡ªåŠ¨ç»™ä½ åˆ›å»ºä¸€ä¸ªé»˜è®¤çš„ã€‚

```python
from collections import defaultdict

# æ™®é€šå­—å…¸çš„é—®é¢˜
normal_dict = {}
# normal_dict['count'] += 1  # KeyError: 'count'

# defaultdictçš„è§£å†³æ–¹æ¡ˆ
smart_dict = defaultdict(int)  # é»˜è®¤å€¼æ˜¯0
smart_dict['count'] += 1  # æ²¡é—®é¢˜ï¼è‡ªåŠ¨åˆ›å»ºå¹¶è®¾ä¸º0ï¼Œç„¶å+1
print(smart_dict['count'])  # 1
```

### 5.2 å¸¸ç”¨é»˜è®¤å€¼ç±»å‹


```python
from collections import defaultdict

# intç±»å‹é»˜è®¤å€¼ï¼ˆæ•°å­—0ï¼‰
counter = defaultdict(int)
counter['apples'] += 5
counter['oranges'] += 3
print(dict(counter))  # {'apples': 5, 'oranges': 3}

# listç±»å‹é»˜è®¤å€¼ï¼ˆç©ºåˆ—è¡¨ï¼‰
groups = defaultdict(list)
groups['æŠ€æœ¯éƒ¨'].append('å°æ˜')
groups['æŠ€æœ¯éƒ¨'].append('å°çº¢')
groups['é”€å”®éƒ¨'].append('å°åˆš')
print(dict(groups))  # {'æŠ€æœ¯éƒ¨': ['å°æ˜', 'å°çº¢'], 'é”€å”®éƒ¨': ['å°åˆš']}

# setç±»å‹é»˜è®¤å€¼ï¼ˆç©ºé›†åˆï¼‰
tags = defaultdict(set)
tags['python'].add('ç¼–ç¨‹')
tags['python'].add('è„šæœ¬')
tags['java'].add('ç¼–ç¨‹')
print(dict(tags))  # {'python': {'ç¼–ç¨‹', 'è„šæœ¬'}, 'java': {'ç¼–ç¨‹'}}
```

### 5.3 å®ç”¨åœºæ™¯ç¤ºä¾‹


**ğŸ¯ åœºæ™¯1ï¼šç»Ÿè®¡è¯é¢‘**
```python
text = "python is great python is powerful python is easy"
words = text.split()

# ä¼ ç»Ÿæ–¹æ³•ï¼ˆç¹çï¼‰
word_count1 = {}
for word in words:
    if word in word_count1:
        word_count1[word] += 1
    else:
        word_count1[word] = 1

# defaultdictæ–¹æ³•ï¼ˆç®€æ´ï¼‰
word_count2 = defaultdict(int)
for word in words:
    word_count2[word] += 1

print(dict(word_count2))  # {'python': 3, 'is': 3, 'great': 1, 'powerful': 1, 'easy': 1}
```

**ğŸ¯ åœºæ™¯2ï¼šæŒ‰æ¡ä»¶åˆ†ç»„**
```python
students = [
    {'name': 'å°æ˜', 'grade': 'ä¸€å¹´çº§', 'subject': 'æ•°å­¦'},
    {'name': 'å°çº¢', 'grade': 'ä¸€å¹´çº§', 'subject': 'è¯­æ–‡'},
    {'name': 'å°åˆš', 'grade': 'äºŒå¹´çº§', 'subject': 'æ•°å­¦'},
    {'name': 'å°ä¸½', 'grade': 'äºŒå¹´çº§', 'subject': 'è‹±è¯­'}
]

# æŒ‰å¹´çº§åˆ†ç»„
by_grade = defaultdict(list)
for student in students:
    by_grade[student['grade']].append(student['name'])

for grade, names in by_grade.items():
    print(f"{grade}: {', '.join(names)}")
```

**è¾“å‡º**ï¼š
```
ä¸€å¹´çº§: å°æ˜, å°çº¢
äºŒå¹´çº§: å°åˆš, å°ä¸½
```

### 5.4 åµŒå¥—defaultdict


```python
# åˆ›å»ºäºŒçº§defaultdictï¼šçœä»½ -> åŸå¸‚ -> äººå£
nested_dict = defaultdict(lambda: defaultdict(int))

# å½•å…¥æ•°æ®
nested_dict['å¹¿ä¸œ']['æ·±åœ³'] = 1756
nested_dict['å¹¿ä¸œ']['å¹¿å·'] = 1868
nested_dict['æ±Ÿè‹']['å—äº¬'] = 850

print(dict(nested_dict))
# {'å¹¿ä¸œ': defaultdict(<class 'int'>, {'æ·±åœ³': 1756, 'å¹¿å·': 1868}), 'æ±Ÿè‹': defaultdict(<class 'int'>, {'å—äº¬': 850})}

# è®¿é—®ä¸å­˜åœ¨çš„æ•°æ®ä¹Ÿä¸ä¼šæŠ¥é”™
print(nested_dict['åŒ—äº¬']['æœé˜³'])  # 0ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
```

---

## 6. ğŸ“‹ OrderedDictæœ‰åºå­—å…¸


### 6.1 ä»€ä¹ˆæ˜¯æœ‰åºå­—å…¸


**ğŸ’¡ é€šä¿—ç†è§£**ï¼šæ™®é€šå­—å…¸å°±åƒéšæ„æ‘†æ”¾çš„ä¹¦æ¶ï¼Œä¹¦çš„é¡ºåºå¯èƒ½ä¼šå˜ã€‚æœ‰åºå­—å…¸åƒæ˜¯æŒ‰ç…§æ”¾å…¥é¡ºåºæ’åˆ—çš„ä¹¦æ¶ï¼Œä½ å…ˆæ”¾çš„ä¹¦æ°¸è¿œåœ¨å‰é¢ã€‚

```python
from collections import OrderedDict

# Python 3.7+çš„æ™®é€šå­—å…¸ä¹Ÿä¿æŒé¡ºåºäº†
normal_dict = {'ç¬¬ä¸€': 1, 'ç¬¬äºŒ': 2, 'ç¬¬ä¸‰': 3}
print("æ™®é€šå­—å…¸:", normal_dict)

# æœ‰åºå­—å…¸ï¼ˆå…¼å®¹æ—§ç‰ˆæœ¬Pythonï¼‰
ordered_dict = OrderedDict([('ç¬¬ä¸€', 1), ('ç¬¬äºŒ', 2), ('ç¬¬ä¸‰', 3)])
print("æœ‰åºå­—å…¸:", ordered_dict)
```

### 6.2 æœ‰åºå­—å…¸çš„ç‰¹æ®Šæ–¹æ³•


```python
from collections import OrderedDict

menu = OrderedDict()
menu['å¼€èƒƒèœ'] = 'æ²™æ‹‰'
menu['ä¸»èœ'] = 'ç‰›æ’'
menu['ç”œå“'] = 'è›‹ç³•'
menu['é¥®å“'] = 'å’–å•¡'

print("å®Œæ•´èœå•:")
for course, dish in menu.items():
    print(f"{course}: {dish}")

# ç§»åŠ¨åˆ°æœ«å°¾
menu.move_to_end('å¼€èƒƒèœ')
print("\nç§»åŠ¨å¼€èƒƒèœåˆ°æœ€å:")
for course, dish in menu.items():
    print(f"{course}: {dish}")

# ç§»åŠ¨åˆ°å¼€å¤´
menu.move_to_end('é¥®å“', last=False)
print("\nç§»åŠ¨é¥®å“åˆ°æœ€å‰:")
for course, dish in menu.items():
    print(f"{course}: {dish}")

# å¼¹å‡ºæœ€åä¸€ä¸ª
last_item = menu.popitem(last=True)
print(f"\nå¼¹å‡ºæœ€åä¸€é¡¹: {last_item}")

# å¼¹å‡ºç¬¬ä¸€ä¸ª  
first_item = menu.popitem(last=False)
print(f"å¼¹å‡ºç¬¬ä¸€é¡¹: {first_item}")
```

### 6.3 å®ç”¨åœºæ™¯


**ğŸ¯ åœºæ™¯1ï¼šLRUç¼“å­˜å®ç°**
```python
from collections import OrderedDict

class LRUCache:
    """æœ€è¿‘æœ€å°‘ä½¿ç”¨ç¼“å­˜"""
    def __init__(self, capacity):
        self.capacity = capacity
        self.cache = OrderedDict()
    
    def get(self, key):
        if key in self.cache:
            # ç§»åˆ°æœ€åï¼ˆè¡¨ç¤ºæœ€è¿‘ä½¿ç”¨ï¼‰
            self.cache.move_to_end(key)
            return self.cache[key]
        return None
    
    def put(self, key, value):
        if key in self.cache:
            # æ›´æ–°å€¼å¹¶ç§»åˆ°æœ€å
            self.cache[key] = value
            self.cache.move_to_end(key)
        else:
            # æ–°å¢
            if len(self.cache) >= self.capacity:
                # åˆ é™¤æœ€ä¹…æœªä½¿ç”¨çš„ï¼ˆç¬¬ä¸€ä¸ªï¼‰
                self.cache.popitem(last=False)
            self.cache[key] = value
    
    def show_cache(self):
        return list(self.cache.items())

# ä½¿ç”¨ç¤ºä¾‹
cache = LRUCache(3)
cache.put('a', 1)
cache.put('b', 2)
cache.put('c', 3)
print("åˆå§‹ç¼“å­˜:", cache.show_cache())  # [('a', 1), ('b', 2), ('c', 3)]

cache.get('a')  # è®¿é—®aï¼Œaå˜æˆæœ€æ–°ä½¿ç”¨
print("è®¿é—®aå:", cache.show_cache())   # [('b', 2), ('c', 3), ('a', 1)]

cache.put('d', 4)  # æ·»åŠ dï¼Œbè¢«æ·˜æ±°
print("æ·»åŠ då:", cache.show_cache())   # [('c', 3), ('a', 1), ('d', 4)]
```

---

## 7. ğŸ”¢ Counterè®¡æ•°å™¨


### 7.1 ä»€ä¹ˆæ˜¯Counter


**ğŸ’¡ é€šä¿—ç†è§£**ï¼šCounterå°±åƒæ˜¯ä¸€ä¸ª"è‡ªåŠ¨ç‚¹ç¥¨æœº"ï¼Œä½ å¾€é‡Œé¢æŠ•ä»€ä¹ˆï¼Œå®ƒå°±å¸®ä½ æ•°æœ‰å¤šå°‘ä¸ªï¼Œæœ€åå‘Šè¯‰ä½ ç»Ÿè®¡ç»“æœã€‚

```python
from collections import Counter

# ç»Ÿè®¡æ°´æœæ•°é‡
fruits = ['è‹¹æœ', 'é¦™è•‰', 'è‹¹æœ', 'æ©™å­', 'é¦™è•‰', 'è‹¹æœ']
fruit_counter = Counter(fruits)
print(fruit_counter)  # Counter({'è‹¹æœ': 3, 'é¦™è•‰': 2, 'æ©™å­': 1})

# ç»Ÿè®¡å­—ç¬¦å‡ºç°æ¬¡æ•°
text = "hello world"
char_counter = Counter(text)
print(char_counter)  # Counter({'l': 3, 'o': 2, 'h': 1, 'e': 1, ' ': 1, 'w': 1, 'r': 1, 'd': 1})
```

### 7.2 Counterçš„åˆ›å»ºæ–¹æ³•


```python
from collections import Counter

# æ–¹æ³•1ï¼šä»åˆ—è¡¨åˆ›å»º
colors = ['çº¢', 'è“', 'çº¢', 'ç»¿', 'è“', 'çº¢']
counter1 = Counter(colors)

# æ–¹æ³•2ï¼šä»å­—ç¬¦ä¸²åˆ›å»º
counter2 = Counter("programming")

# æ–¹æ³•3ï¼šä»å­—å…¸åˆ›å»º
counter3 = Counter({'çº¢': 3, 'è“': 2, 'ç»¿': 1})

# æ–¹æ³•4ï¼šä½¿ç”¨å…³é”®å­—å‚æ•°
counter4 = Counter(çº¢=3, è“=2, ç»¿=1)

print("æ–¹æ³•1:", counter1)  # Counter({'çº¢': 3, 'è“': 2, 'ç»¿': 1})
print("æ–¹æ³•2:", counter2)  # Counter({'r': 2, 'g': 2, 'm': 2, 'p': 1, 'o': 1, 'a': 1, 'n': 1, 'i': 1})
print("æ–¹æ³•3:", counter3)  # Counter({'çº¢': 3, 'è“': 2, 'ç»¿': 1})
print("æ–¹æ³•4:", counter4)  # Counter({'çº¢': 3, 'è“': 2, 'ç»¿': 1})
```

### 7.3 Counterçš„å¸¸ç”¨æ–¹æ³•


```python
from collections import Counter

votes = Counter(['å¼ ä¸‰', 'æå››', 'å¼ ä¸‰', 'ç‹äº”', 'æå››', 'å¼ ä¸‰', 'èµµå…­'])

# 1. most_common() - æœ€å¸¸è§çš„å…ƒç´ 
print("å¾—ç¥¨æœ€å¤šçš„3ä½å€™é€‰äºº:")
for candidate, count in votes.most_common(3):
    print(f"{candidate}: {count}ç¥¨")

# 2. elements() - è¿”å›æ‰€æœ‰å…ƒç´ ï¼ˆä¼šé‡å¤ï¼‰
print("\næ‰€æœ‰æŠ•ç¥¨:")
print(list(votes.elements()))

# 3. total() - æ€»æ•°ï¼ˆPython 3.10+ï¼‰
try:
    print(f"\næ€»ç¥¨æ•°: {votes.total()}")
except AttributeError:
    print(f"\næ€»ç¥¨æ•°: {sum(votes.values())}")

# 4. subtract() - å‡æ³•æ“ä½œ
counter_a = Counter(['a', 'b', 'c', 'a'])
counter_b = Counter(['a', 'b', 'b'])
counter_a.subtract(counter_b)
print(f"\nå‡æ³•ç»“æœ: {counter_a}")  # Counter({'c': 1, 'a': 1, 'b': -1})

# 5. update() - åŠ æ³•æ“ä½œ
counter_x = Counter(['x', 'y', 'x'])
counter_y = Counter(['x', 'z'])
counter_x.update(counter_y)
print(f"åŠ æ³•ç»“æœ: {counter_x}")  # Counter({'x': 3, 'y': 1, 'z': 1})
```

### 7.4 Counterçš„æ•°å­¦è¿ç®—


```python
from collections import Counter

# ä¸¤ä¸ªå•†åº—çš„åº“å­˜
store_a = Counter({'è‹¹æœ': 10, 'é¦™è•‰': 5, 'æ©™å­': 8})
store_b = Counter({'è‹¹æœ': 3, 'é¦™è•‰': 7, 'è‘¡è„': 4})

# åŠ æ³•ï¼šæ€»åº“å­˜
total_inventory = store_a + store_b
print("æ€»åº“å­˜:", total_inventory)  # Counter({'è‹¹æœ': 13, 'é¦™è•‰': 12, 'æ©™å­': 8, 'è‘¡è„': 4})

# å‡æ³•ï¼šAåº—æ¯”Båº—å¤šçš„éƒ¨åˆ†
difference = store_a - store_b
print("Aåº—æ›´å¤šçš„:", difference)  # Counter({'æ©™å­': 8, 'è‹¹æœ': 7})

# äº¤é›†ï¼šä¸¤åº—éƒ½æœ‰çš„å•†å“ï¼ˆå–è¾ƒå°å€¼ï¼‰
common = store_a & store_b
print("å…±åŒå•†å“:", common)  # Counter({'è‹¹æœ': 3, 'é¦™è•‰': 5})

# å¹¶é›†ï¼šæ‰€æœ‰å•†å“ï¼ˆå–è¾ƒå¤§å€¼ï¼‰
all_items = store_a | store_b
print("æ‰€æœ‰å•†å“:", all_items)  # Counter({'è‹¹æœ': 10, 'é¦™è•‰': 7, 'æ©™å­': 8, 'è‘¡è„': 4})
```

### 7.5 å®ç”¨åœºæ™¯ç¤ºä¾‹


**ğŸ¯ åœºæ™¯1ï¼šæ–‡æœ¬åˆ†æ**
```python
def analyze_text(text):
    """åˆ†ææ–‡æœ¬çš„è¯é¢‘"""
    # ç®€å•åˆ†è¯ï¼ˆæŒ‰ç©ºæ ¼åˆ†å‰²ï¼‰
    words = text.lower().split()
    word_counter = Counter(words)
    
    print(f"æ€»è¯æ•°: {sum(word_counter.values())}")
    print(f"ä¸åŒè¯æ•°: {len(word_counter)}")
    print("\nè¯é¢‘ç»Ÿè®¡ï¼ˆå‰5ï¼‰:")
    for word, count in word_counter.most_common(5):
        print(f"{word}: {count}")

text = "Python is great Python is easy Python is powerful"
analyze_text(text)
```

**ğŸ¯ åœºæ™¯2ï¼šæ•°æ®è´¨é‡æ£€æŸ¥**
```python
def check_data_quality(data):
    """æ£€æŸ¥æ•°æ®è´¨é‡"""
    counter = Counter(data)
    
    print(f"æ•°æ®æ€»æ•°: {len(data)}")
    print(f"å”¯ä¸€å€¼æ•°: {len(counter)}")
    print(f"é‡å¤ç‡: {(len(data) - len(counter)) / len(data) * 100:.1f}%")
    
    # æ‰¾å‡ºé‡å¤æœ€å¤šçš„å€¼
    if counter:
        most_common = counter.most_common(1)[0]
        print(f"å‡ºç°æœ€å¤šçš„å€¼: {most_common[0]} (å‡ºç°{most_common[1]}æ¬¡)")

user_ids = [1001, 1002, 1001, 1003, 1002, 1001, 1004]
check_data_quality(user_ids)
```

---

## 8. ğŸ”— ChainMapå­—å…¸é“¾


### 8.1 ä»€ä¹ˆæ˜¯ChainMap


**ğŸ’¡ é€šä¿—ç†è§£**ï¼šChainMapå°±åƒæ˜¯"æŸ¥å­—å…¸åŠ©æ‰‹"ï¼Œä½ æœ‰å¥½å‡ æœ¬å­—å…¸ï¼Œå®ƒå¸®ä½ æŒ‰é¡ºåºæŸ¥æ‰¾ã€‚åœ¨ç¬¬ä¸€æœ¬é‡Œæ‰¾ä¸åˆ°ï¼Œå°±å»ç¬¬äºŒæœ¬æ‰¾ï¼Œä¾æ­¤ç±»æ¨ã€‚

```python
from collections import ChainMap

# ä¸‰ä¸ªé…ç½®å­—å…¸
user_config = {'theme': 'dark', 'language': 'zh-CN'}
app_config = {'theme': 'light', 'font_size': 14, 'auto_save': True}
default_config = {'theme': 'light', 'language': 'en-US', 'font_size': 12, 'auto_save': False}

# åˆ›å»ºå­—å…¸é“¾ï¼šç”¨æˆ·é…ç½® -> åº”ç”¨é…ç½® -> é»˜è®¤é…ç½®
config = ChainMap(user_config, app_config, default_config)

print("æœ€ç»ˆé…ç½®:")
for key, value in config.items():
    print(f"{key}: {value}")
```

**è¾“å‡º**ï¼š
```
theme: dark          # æ¥è‡ªç”¨æˆ·é…ç½®ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰
language: zh-CN      # æ¥è‡ªç”¨æˆ·é…ç½®
font_size: 14        # æ¥è‡ªåº”ç”¨é…ç½®ï¼ˆç”¨æˆ·é…ç½®æ²¡æœ‰ï¼‰
auto_save: True      # æ¥è‡ªåº”ç”¨é…ç½®
```

### 8.2 ChainMapçš„ç‰¹ç‚¹


```python
from collections import ChainMap

dict1 = {'a': 1, 'b': 2}
dict2 = {'b': 20, 'c': 3}
dict3 = {'c': 30, 'd': 4}

chain = ChainMap(dict1, dict2, dict3)

# 1. æŸ¥æ‰¾é¡ºåºï¼šä»å·¦åˆ°å³
print(f"bçš„å€¼: {chain['b']}")  # 2ï¼ˆæ¥è‡ªdict1ï¼Œä¸æ˜¯dict2çš„20ï¼‰
print(f"cçš„å€¼: {chain['c']}")  # 3ï¼ˆæ¥è‡ªdict2ï¼Œä¸æ˜¯dict3çš„30ï¼‰
print(f"dçš„å€¼: {chain['d']}")  # 4ï¼ˆæ¥è‡ªdict3ï¼‰

# 2. ä¿®æ”¹æ“ä½œåªå½±å“ç¬¬ä¸€ä¸ªå­—å…¸
chain['a'] = 100  # ä¿®æ”¹dict1ä¸­çš„a
chain['e'] = 5    # åœ¨dict1ä¸­æ–°å¢e
print("ä¿®æ”¹ådict1:", dict1)  # {'a': 100, 'b': 2, 'e': 5}

# 3. åˆ é™¤æ“ä½œä¹Ÿåªåœ¨ç¬¬ä¸€ä¸ªå­—å…¸ä¸­è¿›è¡Œ
del chain['e']
print("åˆ é™¤ådict1:", dict1)  # {'a': 100, 'b': 2}

# 4. æŸ¥çœ‹æ‰€æœ‰å­—å…¸
print("æ‰€æœ‰å­—å…¸:", chain.maps)
```

### 8.3 ChainMapçš„æ–¹æ³•


```python
from collections import ChainMap

local_vars = {'x': 10}
global_vars = {'x': 1, 'y': 2}

scope = ChainMap(local_vars, global_vars)

# new_child() - æ·»åŠ æ–°çš„å­å­—å…¸
new_scope = scope.new_child({'z': 3})
print("æ–°ä½œç”¨åŸŸ:", dict(new_scope))  # {'z': 3, 'x': 10, 'y': 2}

# parents - é™¤ç¬¬ä¸€ä¸ªå¤–çš„æ‰€æœ‰å­—å…¸
print("çˆ¶çº§ä½œç”¨åŸŸ:", dict(scope.parents))  # {'x': 1, 'y': 2}

# ä¿®æ”¹åº•å±‚å­—å…¸ä¼šå½±å“ChainMap
global_vars['w'] = 4
print("æ·»åŠ wå:", dict(scope))  # {'x': 10, 'y': 2, 'w': 4}
```

### 8.4 å®ç”¨åœºæ™¯ç¤ºä¾‹


**ğŸ¯ åœºæ™¯1ï¼šé…ç½®ç®¡ç†ç³»ç»Ÿ**
```python
from collections import ChainMap
import os

class ConfigManager:
    """é…ç½®ç®¡ç†å™¨"""
    def __init__(self):
        # é…ç½®ä¼˜å…ˆçº§ï¼šå‘½ä»¤è¡Œ > ç¯å¢ƒå˜é‡ > ç”¨æˆ·é…ç½® > é»˜è®¤é…ç½®
        self.default_config = {
            'debug': False,
            'port': 8080,
            'host': 'localhost',
            'database_url': 'sqlite:///app.db'
        }
        
        self.user_config = {}
        self.env_config = {}
        self.cli_config = {}
        
        self._load_configs()
    
    def _load_configs(self):
        # ä»ç¯å¢ƒå˜é‡åŠ è½½
        self.env_config = {
            'debug': os.getenv('DEBUG', '').lower() == 'true',
            'port': int(os.getenv('PORT', 0)) or None,
            'host': os.getenv('HOST'),
            'database_url': os.getenv('DATABASE_URL')
        }
        # ç§»é™¤Noneå€¼
        self.env_config = {k: v for k, v in self.env_config.items() if v is not None}
    
    def set_user_config(self, config):
        """è®¾ç½®ç”¨æˆ·é…ç½®"""
        self.user_config.update(config)
    
    def set_cli_config(self, config):
        """è®¾ç½®å‘½ä»¤è¡Œé…ç½®"""
        self.cli_config.update(config)
    
    def get_config(self):
        """è·å–æœ€ç»ˆé…ç½®"""
        return ChainMap(
            self.cli_config,
            self.env_config, 
            self.user_config,
            self.default_config
        )

# ä½¿ç”¨ç¤ºä¾‹
config_mgr = ConfigManager()

# ç”¨æˆ·é…ç½®
config_mgr.set_user_config({
    'debug': True,
    'port': 3000
})

# å‘½ä»¤è¡Œé…ç½®ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
config_mgr.set_cli_config({
    'port': 5000
})

final_config = config_mgr.get_config()
print("æœ€ç»ˆé…ç½®:")
for key, value in final_config.items():
    print(f"{key}: {value}")
```

**ğŸ¯ åœºæ™¯2ï¼šä½œç”¨åŸŸé“¾æ¨¡æ‹Ÿ**
```python
from collections import ChainMap

class ScopeChain:
    """æ¨¡æ‹Ÿç¼–ç¨‹è¯­è¨€çš„ä½œç”¨åŸŸé“¾"""
    def __init__(self):
        self.scopes = ChainMap()
    
    def push_scope(self, scope_name):
        """è¿›å…¥æ–°ä½œç”¨åŸŸ"""
        self.scopes = self.scopes.new_child()
        print(f"è¿›å…¥ä½œç”¨åŸŸ: {scope_name}")
    
    def pop_scope(self, scope_name):
        """é€€å‡ºä½œç”¨åŸŸ"""
        self.scopes = self.scopes.parents
        print(f"é€€å‡ºä½œç”¨åŸŸ: {scope_name}")
    
    def define_var(self, name, value):
        """åœ¨å½“å‰ä½œç”¨åŸŸå®šä¹‰å˜é‡"""
        if not self.scopes.maps:
            self.scopes.maps.append({})
        self.scopes.maps[0][name] = value
        print(f"å®šä¹‰å˜é‡: {name} = {value}")
    
    def get_var(self, name):
        """æŸ¥æ‰¾å˜é‡"""
        if name in self.scopes:
            return self.scopes[name]
        raise NameError(f"å˜é‡ '{name}' æœªå®šä¹‰")
    
    def show_scopes(self):
        """æ˜¾ç¤ºæ‰€æœ‰ä½œç”¨åŸŸ"""
        print("å½“å‰ä½œç”¨åŸŸé“¾:")
        for i, scope in enumerate(self.scopes.maps):
            print(f"  çº§åˆ«{i}: {scope}")

# ä½¿ç”¨ç¤ºä¾‹
scope = ScopeChain()

# å…¨å±€ä½œç”¨åŸŸ
scope.push_scope("global")
scope.define_var("x", 1)
scope.define_var("y", 2)

# å‡½æ•°ä½œç”¨åŸŸ
scope.push_scope("function")
scope.define_var("x", 10)  # è¦†ç›–å…¨å±€çš„x
scope.define_var("z", 3)

print(f"x = {scope.get_var('x')}")  # 10 (å‡½æ•°ä½œç”¨åŸŸ)
print(f"y = {scope.get_var('y')}")  # 2  (å…¨å±€ä½œç”¨åŸŸ)
print(f"z = {scope.get_var('z')}")  # 3  (å‡½æ•°ä½œç”¨åŸŸ)

scope.show_scopes()

# é€€å‡ºå‡½æ•°ä½œç”¨åŸŸ
scope.pop_scope("function")
print(f"é€€å‡ºå‡½æ•°å x = {scope.get_var('x')}")  # 1 (å›åˆ°å…¨å±€)
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å­—å…¸æ¨å¯¼å¼ï¼š{key: value for item in iterable} - å¿«é€Ÿç”Ÿæˆå­—å…¸
ğŸ”¸ åµŒå¥—å­—å…¸ï¼šå­—å…¸å¥—å­—å…¸ï¼Œç”¨get()æ–¹æ³•å®‰å…¨è®¿é—®
ğŸ”¸ å­—å…¸ç¼“å­˜ï¼šç”¨å­—å…¸å­˜å‚¨è®¡ç®—ç»“æœï¼Œæé«˜æ€§èƒ½
ğŸ”¸ JSONè½¬æ¢ï¼šdumps()/loads()ç”¨äºå­—ç¬¦ä¸²ï¼Œdump()/load()ç”¨äºæ–‡ä»¶
ğŸ”¸ defaultdictï¼šè‡ªåŠ¨æä¾›é»˜è®¤å€¼ï¼Œé¿å…KeyError
ğŸ”¸ OrderedDictï¼šä¿æŒæ’å…¥é¡ºåºï¼ˆPython 3.7+æ™®é€šå­—å…¸ä¹Ÿæœ‰åºï¼‰
ğŸ”¸ Counterï¼šè‡ªåŠ¨è®¡æ•°å™¨ï¼Œç»Ÿè®¡å…ƒç´ å‡ºç°æ¬¡æ•°
ğŸ”¸ ChainMapï¼šå¤šå­—å…¸è”åˆæŸ¥æ‰¾ï¼ŒæŒ‰ä¼˜å…ˆçº§é¡ºåº
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä½•æ—¶ä½¿ç”¨å“ªç§å­—å…¸ç±»å‹**
```
æ™®é€šå­—å…¸ â†’ ä¸€èˆ¬ç”¨é€”ï¼ŒPython 3.7+å·²ä¿æŒé¡ºåº
defaultdict â†’ éœ€è¦é»˜è®¤å€¼ï¼Œé¿å…æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨
OrderedDict â†’ éœ€è¦åœ¨æ—§ç‰ˆæœ¬Pythonä¸­ä¿æŒé¡ºåºï¼Œæˆ–ä½¿ç”¨move_to_end()
Counter â†’ éœ€è¦ç»Ÿè®¡è®¡æ•°çš„åœºæ™¯
ChainMap â†’ å¤šå±‚é…ç½®ã€ä½œç”¨åŸŸé“¾ç­‰åœºæ™¯
```

**ğŸ”¹ æ€§èƒ½è€ƒè™‘**
```
å­—å…¸æŸ¥æ‰¾ï¼šO(1)å¹³å‡æ—¶é—´å¤æ‚åº¦ï¼Œæ˜¯Pythonä¸­æœ€å¿«çš„æŸ¥æ‰¾ç»“æ„
ç¼“å­˜ç­–ç•¥ï¼šåˆç†ä½¿ç”¨ç¼“å­˜å¯ä»¥å¤§å¹…æå‡æ€§èƒ½
JSONåºåˆ—åŒ–ï¼šå¤§æ•°æ®é‡æ—¶æ³¨æ„å†…å­˜ä½¿ç”¨
åµŒå¥—è®¿é—®ï¼šæ·±å±‚åµŒå¥—æ—¶è€ƒè™‘ä½¿ç”¨å®‰å…¨è®¿é—®æ–¹æ³•
```

**ğŸ”¹ æœ€ä½³å®è·µ**
```
âœ… ä½¿ç”¨å­—å…¸æ¨å¯¼å¼æ›¿ä»£å¾ªç¯åˆ›å»ºå­—å…¸
âœ… ç”¨get()æ–¹æ³•å®‰å…¨è®¿é—®å­—å…¸å€¼
âœ… JSONå¤„ç†æ—¶æŒ‡å®šencoding='utf-8'
âœ… å¤§æ•°æ®é‡æ—¶è€ƒè™‘ä½¿ç”¨ç”Ÿæˆå™¨
âœ… å¤æ‚åµŒå¥—æ—¶æä¾›è¾…åŠ©å‡½æ•°
```

### 9.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ“ˆ æå‡ç¼–ç¨‹æ•ˆç‡**ï¼š
- å­—å…¸æ¨å¯¼å¼è®©ä»£ç æ›´ç®€æ´
- defaultdictå‡å°‘é‡å¤çš„é”®æ£€æŸ¥ä»£ç 
- Counterè‡ªåŠ¨å®Œæˆç»Ÿè®¡å·¥ä½œ

**ğŸš€ æ€§èƒ½ä¼˜åŒ–**ï¼š
- å­—å…¸ç¼“å­˜é¿å…é‡å¤è®¡ç®—
- åˆç†çš„æ•°æ®ç»“æ„é€‰æ‹©æå‡æŸ¥æ‰¾æ•ˆç‡
- JSONåºåˆ—åŒ–å®ç°æ•°æ®æŒä¹…åŒ–

**ğŸ’¡ è§£å†³å®é™…é—®é¢˜**ï¼š
- é…ç½®ç®¡ç†ï¼šChainMapå¤„ç†å¤šå±‚é…ç½®
- æ•°æ®ç»Ÿè®¡ï¼šCounterè¿›è¡Œè¯é¢‘åˆ†æ
- æ•°æ®è½¬æ¢ï¼šJSONå®ç°æ•°æ®äº¤æ¢

### 9.4 å­¦ä¹ å»ºè®®


**ğŸ¯ å¾ªåºæ¸è¿›**ï¼š
1. å…ˆæŒæ¡åŸºæœ¬å­—å…¸æ“ä½œå’Œæ¨å¯¼å¼
2. ç†è§£å„ç§ç‰¹æ®Šå­—å…¸çš„é€‚ç”¨åœºæ™¯  
3. åœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨è¿™äº›æŠ€å·§

**ğŸ”§ åŠ¨æ‰‹å®è·µ**ï¼š
- å°è¯•ç”¨ä¸åŒæ–¹æ³•è§£å†³åŒä¸€ä¸ªé—®é¢˜
- å¯¹æ¯”æ€§èƒ½å·®å¼‚
- åœ¨çœŸå®é¡¹ç›®ä¸­åº”ç”¨å­¦åˆ°çš„æŠ€å·§

**ğŸ“š æ‰©å±•å­¦ä¹ **ï¼š
- äº†è§£å­—å…¸çš„åº•å±‚å®ç°ï¼ˆå“ˆå¸Œè¡¨ï¼‰
- å­¦ä¹ æ›´å¤šcollectionsæ¨¡å—çš„å·¥å…·
- å…³æ³¨Pythonæ–°ç‰ˆæœ¬çš„å­—å…¸ç‰¹æ€§æ›´æ–°

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- æ¨å¯¼åˆ›å»ºå­—å…¸å¿«ï¼ŒåµŒå¥—è®¿é—®ç”¨getæŸ¥
- ç¼“å­˜åŠ é€Ÿé‡è®¡ç®—ï¼ŒJSONè½¬æ¢æ•°æ®åŒ–  
- defaultç»™é»˜è®¤ï¼ŒCounterè‡ªåŠ¨æ•°
- Orderä¿é¡ºåºï¼ŒChainå¤šå­—å…¸é“¾æŸ¥