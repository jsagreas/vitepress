---
title: 6、字典基础操作
---
## 📚 目录

1. [字典是什么](#1-字典是什么)
2. [字典创建方式](#2-字典创建方式)
3. [字典访问与修改](#3-字典访问与修改)
4. [字典键值操作](#4-字典键值操作)
5. [字典元素增删操作](#5-字典元素增删操作)
6. [字典查找方法](#6-字典查找方法)
7. [字典遍历方式](#7-字典遍历方式)
8. [字典合并技巧](#8-字典合并技巧)
9. [字典键值互换技巧](#9-字典键值互换技巧)
10. [核心要点总结](#10-核心要点总结)

---

## 1. 🎯 字典是什么


### 1.1 通俗理解字典


**字典就像现实中的电话簿**：
```
现实中的电话簿：        Python中的字典：
姓名    →    电话         键(key)  →  值(value)
张三    →  13800138000    "name"   →  "张三"
李四    →  13900139000    "age"    →   25
王五    →  13700137000    "city"   →  "北京"
```

> 💡 **核心理解**：字典是一种**键值对**的数据结构，通过**唯一的键**来快速查找对应的**值**

### 1.2 字典的特点


**🔸 键值对结构**：
- **键(Key)**：相当于标签，必须是**唯一**的
- **值(Value)**：可以是任何数据类型

**🔸 字典的优势**：
```
查找速度快：通过键直接找值，不用一个个遍历
结构清晰：键名有意义，代码更易读
灵活存储：值可以是数字、字符串、列表等任何类型
```

### 1.3 字典 vs 列表对比


| 特性 | **列表** | **字典** |
|------|---------|----------|
| **访问方式** | `list[索引]` | `dict[键]` |
| **查找速度** | 需要遍历，慢 | 直接定位，快 |
| **数据意义** | 位置有序 | 键名有意义 |
| **适用场景** | 序列数据 | 关联数据 |

**实际例子对比**：
```python
# 用列表存储学生信息（不推荐）
student_list = ["张三", 20, "计算机", 85.5]  # 需要记住每个位置的含义

# 用字典存储学生信息（推荐）
student_dict = {
    "name": "张三",
    "age": 20,
    "major": "计算机",
    "score": 85.5
}  # 键名直接说明了数据含义
```

---

## 2. 🔧 字典创建方式


### 2.1 字面量创建（最常用）


**🔸 基本语法**：
```python
# 空字典
empty_dict = {}

# 有数据的字典
student = {
    "name": "小明",
    "age": 18,
    "grade": "高三"
}
```

**🔸 键的类型要求**：
```python
# ✅ 正确的键类型
valid_dict = {
    "字符串键": "值1",
    123: "数字键",
    (1, 2): "元组键"
}

# ❌ 错误的键类型
# invalid_dict = {
#     [1, 2]: "列表不能作为键",  # 列表是可变的
#     {"a": 1}: "字典不能作为键"  # 字典是可变的
# }
```

> ⚠️ **重要提醒**：字典的键必须是**不可变类型**（字符串、数字、元组），不能是列表或字典

### 2.2 dict()构造函数创建


**🔸 从列表创建**：
```python
# 方法1：传入键值对列表
pairs = [("name", "张三"), ("age", 25), ("city", "上海")]
person = dict(pairs)
print(person)  # {'name': '张三', 'age': 25, 'city': '上海'}

# 方法2：使用关键字参数
person = dict(name="张三", age=25, city="上海")
print(person)  # 同样的结果
```

**🔸 从两个列表创建**：
```python
keys = ["苹果", "香蕉", "橙子"]
values = [3.5, 2.8, 4.2]
fruit_prices = dict(zip(keys, values))
print(fruit_prices)  # {'苹果': 3.5, '香蕉': 2.8, '橙子': 4.2}
```

### 2.3 fromkeys()方法创建


**🔸 批量初始化相同值**：
```python
# 创建多个键，都设置为相同的初始值
subjects = ["语文", "数学", "英语", "物理"]
scores = dict.fromkeys(subjects, 0)
print(scores)  # {'语文': 0, '数学': 0, '英语': 0, '物理': 0}

# 常见用途：初始化计数器
counters = dict.fromkeys(['a', 'b', 'c'], 0)
```

> 💡 **使用技巧**：`fromkeys()`适合快速创建具有默认值的字典，比如计数器、状态记录等

---

## 3. 🔍 字典访问与修改


### 3.1 访问字典中的值


**🔸 方括号访问法**：
```python
student = {"name": "李四", "age": 20, "major": "数学"}

# 访问存在的键
name = student["name"]
print(name)  # 李四

# ❌ 访问不存在的键会报错
# grade = student["grade"]  # KeyError: 'grade'
```

**🔸 安全访问的重要性**：
```
直接用方括号访问不存在的键时：
- Python会抛出KeyError异常
- 程序会崩溃停止运行
- 在实际项目中需要避免这种情况
```

### 3.2 修改字典中的值


**🔸 直接赋值修改**：
```python
student = {"name": "王五", "age": 19, "grade": "大一"}

# 修改已存在的键的值
student["age"] = 20
print(student)  # {'name': '王五', 'age': 20, 'grade': '大一'}

# 添加新的键值对
student["major"] = "计算机"
print(student)  # {'name': '王五', 'age': 20, 'grade': '大一', 'major': '计算机'}
```

**🔸 批量修改示例**：
```python
# 学生成绩更新
grades = {"语文": 85, "数学": 90, "英语": 78}

# 期末考试后更新成绩
grades["语文"] = 88  # 语文提高了
grades["数学"] = 95  # 数学也提高了
grades["物理"] = 82  # 新增物理成绩

print(grades)  # {'语文': 88, '数学': 95, '英语': 78, '物理': 82}
```

---

## 4. 🔑 字典键值操作


### 4.1 keys()方法 - 获取所有键


**🔸 基本用法**：
```python
book = {
    "title": "Python入门",
    "author": "张老师",
    "price": 45.8,
    "pages": 320
}

# 获取所有键
book_keys = book.keys()
print(book_keys)  # dict_keys(['title', 'author', 'price', 'pages'])
print(list(book_keys))  # ['title', 'author', 'price', 'pages']
```

**🔸 实际应用场景**：
```python
# 检查必需的字段是否都存在
required_fields = ["name", "email", "phone"]
user_data = {"name": "张三", "email": "zhang@qq.com", "age": 25}

missing_fields = []
for field in required_fields:
    if field not in user_data.keys():
        missing_fields.append(field)

if missing_fields:
    print(f"缺少字段: {missing_fields}")  # 缺少字段: ['phone']
```

### 4.2 values()方法 - 获取所有值


**🔸 基本用法**：
```python
scores = {"语文": 85, "数学": 92, "英语": 78, "物理": 88}

# 获取所有分数
all_scores = scores.values()
print(list(all_scores))  # [85, 92, 78, 88]

# 计算平均分
average = sum(all_scores) / len(all_scores)
print(f"平均分: {average:.1f}")  # 平均分: 85.8
```

### 4.3 items()方法 - 获取键值对


**🔸 基本用法**：
```python
product = {"name": "笔记本电脑", "brand": "联想", "price": 4999}

# 获取所有键值对
items = product.items()
print(list(items))  # [('name', '笔记本电脑'), ('brand', '联想'), ('price', 4999)]
```

**🔸 实际应用 - 格式化输出**：
```python
student_info = {
    "姓名": "李明",
    "学号": "2023001",
    "专业": "软件工程",
    "年级": "大二"
}

print("=== 学生信息 ===")
for key, value in student_info.items():
    print(f"{key}: {value}")

# 输出：
# === 学生信息 ===
# 姓名: 李明
# 学号: 2023001
# 专业: 软件工程
# 年级: 大二
```

---

## 5. ➕➖ 字典元素增删操作


### 5.1 update()方法 - 批量更新


**🔸 基本语法与用途**：
```python
# update()用于批量添加或更新键值对
# 如果键已存在，会更新值；如果键不存在，会添加新的键值对
```

**🔸 不同的update()用法**：
```python
student = {"name": "张三", "age": 20}

# 方法1：用另一个字典更新
new_info = {"age": 21, "major": "计算机", "grade": "大二"}
student.update(new_info)
print(student)  # {'name': '张三', 'age': 21, 'major': '计算机', 'grade': '大二'}

# 方法2：用关键字参数更新
student.update(city="北京", phone="138xxxx")
print(student)  # 会添加city和phone字段

# 方法3：用键值对列表更新
updates = [("email", "zhang@qq.com"), ("hobby", "编程")]
student.update(updates)
```

### 5.2 pop()方法 - 删除指定键


**🔸 基本用法**：
```python
data = {"a": 1, "b": 2, "c": 3, "d": 4}

# 删除键'b'并返回其值
removed_value = data.pop("b")
print(f"删除的值: {removed_value}")  # 删除的值: 2
print(data)  # {'a': 1, 'c': 3, 'd': 4}

# 删除不存在的键时提供默认值
value = data.pop("e", "键不存在")
print(value)  # 键不存在
```

**🔸 实际应用示例**：
```python
# 用户权限管理
user_permissions = {
    "read": True,
    "write": True,
    "delete": True,
    "admin": False
}

# 移除管理员权限
admin_status = user_permissions.pop("admin", False)
print(f"原管理员状态: {admin_status}")  # False
print("当前权限:", user_permissions)  # 不包含admin字段了
```

### 5.3 popitem()方法 - 删除最后一个


**🔸 基本特点**：
```python
# popitem()删除并返回字典中的最后一个键值对
# Python 3.7+字典是有序的，删除的是最后插入的项
```

```python
inventory = {"苹果": 50, "香蕉": 30, "橙子": 25}

# 删除最后添加的项
last_item = inventory.popitem()
print(f"删除的项: {last_item}")  # ('橙子', 25)
print(inventory)  # {'苹果': 50, '香蕉': 30}

# 如果字典为空，会报错
# empty_dict = {}
# empty_dict.popitem()  # KeyError: 'popitem(): dictionary is empty'
```

### 5.4 del语句和clear()方法


**🔸 del删除指定键**：
```python
person = {"name": "王五", "age": 30, "city": "上海", "job": "工程师"}

# 删除指定键
del person["city"]
print(person)  # {'name': '王五', 'age': 30, 'job': '工程师'}

# 删除整个字典
# del person  # 字典对象被删除，无法再使用
```

**🔸 clear()清空字典**：
```python
temp_data = {"a": 1, "b": 2, "c": 3}
print("清空前:", temp_data)  # {'a': 1, 'b': 2, 'c': 3}

temp_data.clear()
print("清空后:", temp_data)  # {}
print("字典对象仍存在:", temp_data is not None)  # True
```

> 💡 **del vs clear()区别**：
> - `del dict[key]`：删除指定键值对
> - `del dict`：删除整个字典对象
> - `dict.clear()`：清空字典内容，但字典对象仍存在

---

## 6. 🔍 字典查找方法


### 6.1 get()方法 - 安全获取值


**🔸 为什么需要get()方法**：
```python
# 问题：直接访问可能出错
student = {"name": "张三", "age": 20}

# ❌ 危险的访问方式
# grade = student["grade"]  # KeyError！程序崩溃

# ✅ 安全的访问方式
grade = student.get("grade")
print(grade)  # None（不会报错）

# ✅ 提供默认值
grade = student.get("grade", "未录入")
print(grade)  # 未录入
```

**🔸 get()方法的实际应用**：
```python
# 网站访问统计
page_views = {"首页": 1250, "产品页": 890, "关于我们": 320}

# 安全获取访问量，默认为0
home_views = page_views.get("首页", 0)
contact_views = page_views.get("联系我们", 0)  # 页面不存在，返回0

print(f"首页访问量: {home_views}")      # 1250
print(f"联系我们访问量: {contact_views}")  # 0
```

**🔸 get()在条件判断中的使用**：
```python
user_settings = {"theme": "dark", "language": "zh"}

# 检查设置并提供默认值
theme = user_settings.get("theme", "light")
font_size = user_settings.get("font_size", "medium")

print(f"主题: {theme}")        # dark
print(f"字体大小: {font_size}")  # medium
```

### 6.2 setdefault()方法 - 获取并设置默认值


**🔸 setdefault()的独特作用**：
```python
# setdefault()特点：
# 1. 如果键存在，返回对应的值
# 2. 如果键不存在，设置默认值并返回该值
```

```python
config = {"debug": True, "port": 8080}

# 键存在时，返回现有值
debug_mode = config.setdefault("debug", False)
print(debug_mode)  # True（原有值）

# 键不存在时，设置默认值并返回
max_connections = config.setdefault("max_connections", 100)
print(max_connections)  # 100（新设置的默认值）
print(config)  # {'debug': True, 'port': 8080, 'max_connections': 100}
```

**🔸 实际应用场景 - 计数器**：
```python
# 统计单词出现次数
text = "python is great python is fun"
word_count = {}

for word in text.split():
    # setdefault确保键存在，初始值为0
    word_count.setdefault(word, 0)
    word_count[word] += 1

print(word_count)  # {'python': 2, 'is': 2, 'great': 1, 'fun': 1}
```

**🔸 setdefault()构建复杂数据结构**：
```python
# 按类别分组数据
students = [
    {"name": "张三", "class": "1班", "subject": "数学"},
    {"name": "李四", "class": "1班", "subject": "英语"},
    {"name": "王五", "class": "2班", "subject": "数学"}
]

class_groups = {}
for student in students:
    class_name = student["class"]
    # setdefault确保每个班级都有一个列表
    class_groups.setdefault(class_name, [])
    class_groups[class_name].append(student["name"])

print(class_groups)
# {'1班': ['张三', '李四'], '2班': ['王五']}
```

---

## 7. 🔄 字典遍历方式


### 7.1 遍历键（keys）


**🔸 基本遍历键**：
```python
scores = {"张三": 85, "李四": 92, "王五": 78}

# 方法1：直接遍历字典（默认遍历键）
print("=== 方法1：直接遍历 ===")
for name in scores:
    print(f"学生: {name}, 成绩: {scores[name]}")

# 方法2：显式遍历keys()
print("=== 方法2：遍历keys() ===")
for name in scores.keys():
    print(f"学生: {name}")
```

### 7.2 遍历值（values）


**🔸 基本遍历值**：
```python
temperatures = {"北京": 25, "上海": 28, "广州": 32, "深圳": 30}

# 遍历所有温度值
print("今日各城市温度：")
for temp in temperatures.values():
    print(f"{temp}°C")

# 统计分析
max_temp = max(temperatures.values())
min_temp = min(temperatures.values())
avg_temp = sum(temperatures.values()) / len(temperatures)

print(f"最高温度: {max_temp}°C")
print(f"最低温度: {min_temp}°C")  
print(f"平均温度: {avg_temp:.1f}°C")
```

### 7.3 遍历键值对（items）


**🔸 最常用的遍历方式**：
```python
product_info = {
    "名称": "iPhone 15",
    "品牌": "Apple",
    "价格": 5999,
    "库存": 50
}

# 同时获取键和值
print("=== 产品信息 ===")
for key, value in product_info.items():
    print(f"{key}: {value}")
```

**🔸 实际应用示例**：
```python
# 购物车计算
cart = {"苹果": 3, "香蕉": 2, "橙子": 4}
prices = {"苹果": 5.0, "香蕉": 3.5, "橙子": 4.8}

total_cost = 0
print("=== 购物清单 ===")
for item, quantity in cart.items():
    cost = quantity * prices[item]
    total_cost += cost
    print(f"{item}: {quantity}个 × {prices[item]}元 = {cost}元")

print(f"总计: {total_cost}元")
```

### 7.4 带索引的遍历


**🔸 使用enumerate()添加索引**：
```python
menu = {"宫保鸡丁": 28, "麻婆豆腐": 18, "糖醋里脊": 32, "青椒土豆丝": 15}

print("=== 今日菜单 ===")
for index, (dish, price) in enumerate(menu.items(), 1):
    print(f"{index}. {dish} - {price}元")

# 输出：
# 1. 宫保鸡丁 - 28元
# 2. 麻婆豆腐 - 18元
# 3. 糖醋里脊 - 32元
# 4. 青椒土豆丝 - 15元
```

---

## 8. 🔗 字典合并技巧


### 8.1 使用update()合并


**🔸 基本合并操作**：
```python
# 原始字典
base_config = {"host": "localhost", "port": 8080, "debug": True}
user_config = {"port": 9090, "timeout": 30, "ssl": True}

# 合并配置（user_config会覆盖base_config中的相同键）
base_config.update(user_config)
print(base_config)
# {'host': 'localhost', 'port': 9090, 'debug': True, 'timeout': 30, 'ssl': True}
```

> ⚠️ **注意**：`update()`会**修改原字典**，相同的键会被**覆盖**

### 8.2 使用字典解包合并（推荐）


**🔸 Python 3.5+的新语法**：
```python
dict1 = {"a": 1, "b": 2}
dict2 = {"b": 3, "c": 4}
dict3 = {"d": 5}

# 使用**解包语法合并（不修改原字典）
merged = {**dict1, **dict2, **dict3}
print(merged)  # {'a': 1, 'b': 3, 'c': 4, 'd': 5}

# 原字典保持不变
print(dict1)   # {'a': 1, 'b': 2}
print(dict2)   # {'b': 3, 'c': 4}
```

**🔸 实际应用 - 配置文件合并**：
```python
# 默认配置
default_settings = {
    "theme": "light",
    "font_size": "medium", 
    "auto_save": True,
    "language": "en"
}

# 用户配置
user_settings = {
    "theme": "dark",
    "font_size": "large"
}

# 合并配置（用户设置优先）
final_settings = {**default_settings, **user_settings}
print("最终配置:")
for key, value in final_settings.items():
    print(f"{key}: {value}")
```

### 8.3 使用dict()构造函数合并


**🔸 另一种合并方式**：
```python
person_basic = {"name": "张三", "age": 25}
person_contact = {"email": "zhang@qq.com", "phone": "138xxxx"}

# 使用dict()和**解包
person_full = dict(**person_basic, **person_contact)
print(person_full)
# {'name': '张三', 'age': 25, 'email': 'zhang@qq.com', 'phone': '138xxxx'}
```

### 8.4 合并多个字典的函数


**🔸 编写通用合并函数**：
```python
def merge_dicts(*dicts):
    """合并多个字典，后面的字典会覆盖前面的相同键"""
    result = {}
    for d in dicts:
        result.update(d)
    return result

# 使用示例
config1 = {"host": "localhost", "port": 8080}
config2 = {"port": 9090, "debug": True}  
config3 = {"timeout": 30, "ssl": False}

final_config = merge_dicts(config1, config2, config3)
print(final_config)
# {'host': 'localhost', 'port': 9090, 'debug': True, 'timeout': 30, 'ssl': False}
```

---

## 9. 🔄 字典键值互换技巧


### 9.1 基本键值互换


**🔸 简单的键值互换**：
```python
# 原字典：编号 → 姓名
student_id = {1001: "张三", 1002: "李四", 1003: "王五"}

# 互换为：姓名 → 编号
student_name = {name: id for id, name in student_id.items()}
print(student_name)
# {'张三': 1001, '李四': 1002, '王五': 1003}
```

**🔸 实际应用场景**：
```python
# 城市代码查询
city_codes = {"BJ": "北京", "SH": "上海", "GZ": "广州", "SZ": "深圳"}

# 创建反向查询字典
code_by_city = {city: code for code, city in city_codes.items()}

# 现在可以双向查询
print(f"北京的代码: {code_by_city['北京']}")  # BJ
print(f"SH是哪个城市: {city_codes['SH']}")   # 上海
```

### 9.2 处理重复值的情况


**🔸 当值不唯一时的处理**：
```python
# 问题：多个键对应相同的值
grades = {"张三": "A", "李四": "B", "王五": "A", "赵六": "B"}

# 方法1：只保留最后一个（可能丢失数据）
grade_to_student = {grade: name for name, grade in grades.items()}
print(grade_to_student)  # {'A': '王五', 'B': '赵六'}  # 张三和李四丢失了！

# 方法2：将相同值的键收集到列表中（推荐）
grade_groups = {}
for name, grade in grades.items():
    if grade not in grade_groups:
        grade_groups[grade] = []
    grade_groups[grade].append(name)

print(grade_groups)  # {'A': ['张三', '王五'], 'B': ['李四', '赵六']}
```

### 9.3 高级键值互换技巧


**🔸 使用setdefault()构建反向字典**：
```python
# 部门员工信息
employees = {
    "张三": "技术部",
    "李四": "销售部", 
    "王五": "技术部",
    "赵六": "人事部",
    "钱七": "销售部"
}

# 按部门分组员工
departments = {}
for name, dept in employees.items():
    departments.setdefault(dept, []).append(name)

print("部门员工分布:")
for dept, names in departments.items():
    print(f"{dept}: {names}")

# 输出：
# 技术部: ['张三', '王五']  
# 销售部: ['李四', '钱七']
# 人事部: ['赵六']
```

**🔸 条件性键值互换**：
```python
# 商品价格字典
products = {
    "笔记本": 4999,
    "鼠标": 89,
    "键盘": 299,
    "显示器": 1299,
    "耳机": 199
}

# 只互换价格在200以上的商品
expensive_products = {
    price: name for name, price in products.items() 
    if price >= 200
}
print("高价商品（价格→名称）:")
print(expensive_products)
# {4999: '笔记本', 299: '键盘', 1299: '显示器'}
```

### 9.4 实用的双向查找字典类


**🔸 创建支持双向查找的字典**：
```python
class BiDict:
    """双向字典：支持键值双向查找"""
    
    def __init__(self, data=None):
        self.forward = {}   # 正向字典
        self.backward = {}  # 反向字典
        
        if data:
            for key, value in data.items():
                self.add(key, value)
    
    def add(self, key, value):
        """添加键值对"""
        self.forward[key] = value
        self.backward[value] = key
    
    def get_by_key(self, key):
        """通过键获取值"""
        return self.forward.get(key)
    
    def get_by_value(self, value):
        """通过值获取键"""
        return self.backward.get(value)

# 使用示例
country_capital = BiDict({
    "中国": "北京",
    "美国": "华盛顿", 
    "英国": "伦敦",
    "法国": "巴黎"
})

# 双向查找
print(f"中国的首都: {country_capital.get_by_key('中国')}")      # 北京
print(f"巴黎是哪国首都: {country_capital.get_by_value('巴黎')}")  # 法国
```

---

## 10. 📋 核心要点总结


### 10.1 必须掌握的基本概念


```
🔸 字典本质：键值对的映射关系，通过唯一键快速查找值
🔸 字典特点：无序（3.7+有序）、键唯一、值可重复、可变类型
🔸 访问方式：dict[key] 或 dict.get(key, default)
🔸 修改方式：直接赋值 dict[key] = value
🔸 遍历方式：keys()、values()、items()
```

### 10.2 关键操作方法对比


| 操作类型 | **方法** | **特点** | **使用场景** |
|---------|---------|----------|-------------|
| **创建** | `{}` | 字面量，最直观 | 一般创建 |
| | `dict()` | 构造函数，灵活 | 动态创建 |
| | `fromkeys()` | 批量初始化 | 默认值设置 |
| **访问** | `dict[key]` | 直接访问，可能报错 | 确定键存在时 |
| | `get()` | 安全访问，返回默认值 | 不确定键是否存在 |
| | `setdefault()` | 获取并设置默认值 | 初始化操作 |
| **修改** | `update()` | 批量更新 | 合并字典 |
| | `pop()` | 删除并返回值 | 需要删除的值时 |
| | `clear()` | 清空所有元素 | 重置字典 |

### 10.3 实际应用指南


**🔹 选择合适的创建方式**：
```python
# 静态数据 → 字面量
config = {"host": "localhost", "port": 8080}

# 动态数据 → dict()
user_data = dict(zip(keys, values))

# 初始化计数器 → fromkeys()
counters = dict.fromkeys(['a', 'b', 'c'], 0)
```

**🔹 安全访问的最佳实践**：
```python
# ✅ 推荐：使用get()避免KeyError
value = data.get("key", "默认值")

# ❌ 避免：直接访问可能不存在的键
# value = data["key"]  # 可能报错
```

**🔹 高效遍历技巧**：
```python
# 只需要键：for key in dict
# 只需要值：for value in dict.values()  
# 需要键值对：for key, value in dict.items()  # 最常用
```

### 10.4 常见应用场景总结


- **📊 数据统计**：`setdefault()`初始化计数器
- **⚙️ 配置管理**：字典合并技巧
- **🔍 双向查找**：键值互换构建反向索引
- **📋 数据分组**：按某个属性将数据分组到字典
- **🛡️ 缓存实现**：用字典存储计算结果
- **📝 记录映射**：ID与对象的映射关系

**核心记忆口诀**：
- 字典键值配对，通过键来查找快
- 创建访问要安全，get方法很关键  
- 遍历方式三选择，items最常用
- 合并互换有技巧，实际应用价值高