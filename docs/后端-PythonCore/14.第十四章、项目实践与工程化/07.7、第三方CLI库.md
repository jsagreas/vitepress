---
title: 7ã€ç¬¬ä¸‰æ–¹CLIåº“
---
## ğŸ“š ç›®å½•

1. [CLIåº“æ¦‚è¿°ä¸é€‰æ‹©](#1-CLIåº“æ¦‚è¿°ä¸é€‰æ‹©)
2. [Clickæ¡†æ¶è¯¦è§£](#2-Clickæ¡†æ¶è¯¦è§£)
3. [å‘½ä»¤è£…é¥°å™¨ç³»ç»Ÿ](#3-å‘½ä»¤è£…é¥°å™¨ç³»ç»Ÿ)
4. [å‚æ•°ç±»å‹å®šä¹‰](#4-å‚æ•°ç±»å‹å®šä¹‰)
5. [ä¸Šä¸‹æ–‡ç®¡ç†æœºåˆ¶](#5-ä¸Šä¸‹æ–‡ç®¡ç†æœºåˆ¶)
6. [æ’ä»¶ç³»ç»Ÿæ‰©å±•](#6-æ’ä»¶ç³»ç»Ÿæ‰©å±•)
7. [å½©è‰²è¾“å‡ºå¢å¼º](#7-å½©è‰²è¾“å‡ºå¢å¼º)
8. [è¿›åº¦æ¡æ˜¾ç¤º](#8-è¿›åº¦æ¡æ˜¾ç¤º)
9. [CLIæ¡†æ¶å¯¹æ¯”åˆ†æ](#9-CLIæ¡†æ¶å¯¹æ¯”åˆ†æ)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ CLIåº“æ¦‚è¿°ä¸é€‰æ‹©


### 1.1 ä»€ä¹ˆæ˜¯CLIåº“


**CLIçš„æœ¬è´¨ç†è§£**ï¼š
CLIï¼ˆCommand Line Interfaceï¼‰åº“å°±æ˜¯**å¸®ä½ å¿«é€Ÿåˆ¶ä½œå‘½ä»¤è¡Œå·¥å…·çš„"è„šæ‰‹æ¶"**ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœä½ è¦å¼€ä¸€å®¶é¤å…ï¼ŒCLIåº“å°±åƒæ˜¯æä¾›äº†å¨æˆ¿è®¾å¤‡ã€èœå•æ¨¡æ¿ã€æœåŠ¡æµç¨‹çš„"é¤å…å¼€ä¸šå¥—è£…"ã€‚

```
ä¼ ç»Ÿæ–¹å¼ï¼šè‡ªå·±å¤„ç†å‘½ä»¤è¡Œå‚æ•°
python script.py --name å¼ ä¸‰ --age 25 --verbose

éœ€è¦è‡ªå·±å†™ä»£ç ï¼š
- è§£æ --name å¼ ä¸‰
- è§£æ --age 25  
- å¤„ç† --verbose æ ‡å¿—
- éªŒè¯å‚æ•°æ˜¯å¦æ­£ç¡®
- æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯

CLIåº“æ–¹å¼ï¼šæ¡†æ¶å¸®ä½ æå®šä¸€åˆ‡
åªéœ€è¦å®šä¹‰ï¼š"æˆ‘è¦ä¸€ä¸ªnameå‚æ•°ï¼Œä¸€ä¸ªageå‚æ•°ï¼Œä¸€ä¸ªverboseå¼€å…³"
å…¶ä»–å…¨éƒ¨è‡ªåŠ¨å¤„ç†ï¼
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦CLIåº“


**ğŸ”¸ è§£å†³çš„æ ¸å¿ƒç—›ç‚¹**ï¼š

```
æ‰‹å·¥è§£æå‚æ•°çš„ç—›è‹¦ï¼š
import sys
args = sys.argv[1:]  # è·å–å‘½ä»¤è¡Œå‚æ•°
# ç„¶åè¦å†™ä¸€å¤§å †if/elseæ¥è§£æ...
# å®¹æ˜“å‡ºé”™ï¼Œä»£ç å†—é•¿

ä½¿ç”¨CLIåº“çš„ä¼˜åŠ¿ï¼š
- ğŸš€ è‡ªåŠ¨å‚æ•°è§£æ
- âœ… è‡ªåŠ¨å‚æ•°éªŒè¯  
- ğŸ“‹ è‡ªåŠ¨ç”Ÿæˆå¸®åŠ©æ–‡æ¡£
- ğŸ¨ ç¾è§‚çš„é”™è¯¯æç¤º
- ğŸ”§ ç±»å‹è½¬æ¢
- ğŸ“Š è¿›åº¦æ¡ã€å½©è‰²è¾“å‡º
```

### 1.3 ä¸»æµCLIåº“å¯¹æ¯”


| åº“åç§° | **ç‰¹ç‚¹** | **é€‚ç”¨åœºæ™¯** | **å­¦ä¹ éš¾åº¦** |
|--------|---------|-------------|-------------|
| ğŸ”¥ **Click** | `ç°ä»£ã€ä¼˜é›…ã€åŠŸèƒ½ä¸°å¯Œ` | `ä¸­å¤§å‹CLIåº”ç”¨` | `ğŸŸ¡ ä¸­ç­‰` |
| âš¡ **Typer** | `åŸºäºClickï¼Œç±»å‹æç¤ºå‹å¥½` | `ç°ä»£Pythoné¡¹ç›®` | `ğŸŸ¢ ç®€å•` |
| ğŸ“š **argparse** | `Pythonå†…ç½®ï¼ŒåŠŸèƒ½å®Œæ•´` | `æ ‡å‡†åŒ–éœ€æ±‚` | `ğŸŸ¡ ä¸­ç­‰` |
| ğŸ¯ **Fire** | `è‡ªåŠ¨ç”ŸæˆCLIï¼Œé›¶é…ç½®` | `å¿«é€ŸåŸå‹` | `ğŸŸ¢ æç®€` |

---

## 2. ğŸš€ Clickæ¡†æ¶è¯¦è§£


### 2.1 Clickçš„è®¾è®¡å“²å­¦


**Click = "Command Line Interface Creation Kit"**

Clickçš„è®¾è®¡ç†å¿µå°±åƒ**æ­ç§¯æœ¨**ï¼šæ¯ä¸ªå‘½ä»¤ã€å‚æ•°ã€é€‰é¡¹éƒ½æ˜¯ä¸€å—ç§¯æœ¨ï¼Œä½ å¯ä»¥**è‡ªç”±ç»„åˆ**æ­å»ºå‡ºä»»ä½•å¤æ‚çš„å‘½ä»¤è¡Œå·¥å…·ã€‚

```
Clickçš„ä¸‰å¤§æ ¸å¿ƒç†å¿µï¼š
1. ğŸ¯ è£…é¥°å™¨é©±åŠ¨ï¼šç”¨@ç¬¦å·"è£…é¥°"å‡½æ•°å˜æˆå‘½ä»¤
2. ğŸ”§ ç»„åˆä¼˜äºç»§æ‰¿ï¼šå°å—ç§¯æœ¨ç»„åˆæˆå¤§å·¥å…·  
3. ğŸ“– è‡ªåŠ¨æ–‡æ¡£ï¼šå†™ä»£ç çš„åŒæ—¶è‡ªåŠ¨ç”Ÿæˆå¸®åŠ©
```

### 2.2 ClickåŸºç¡€å…¥é—¨


**ğŸ’¡ æœ€ç®€å•çš„Clickç¨‹åº**ï¼š

```python
import click

@click.command()
@click.option('--name', default='World', help='è¦é—®å€™çš„åå­—')
def hello(name):
    """è¿™æ˜¯ä¸€ä¸ªç®€å•çš„é—®å€™ç¨‹åº"""
    click.echo(f'Hello {name}!')

if __name__ == '__main__':
    hello()
```

**è¿è¡Œæ•ˆæœå±•ç¤º**ï¼š
```bash
$ python hello.py --name å¼ ä¸‰
Hello å¼ ä¸‰!

$ python hello.py --help
Usage: hello.py [OPTIONS]

  è¿™æ˜¯ä¸€ä¸ªç®€å•çš„é—®å€™ç¨‹åº

Options:
  --name TEXT  è¦é—®å€™çš„åå­—
  --help       Show this message and exit.
```

### 2.3 Clickçš„æ ¸å¿ƒç»„ä»¶


**ğŸ—ï¸ Clickæ¶æ„å›¾**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Clickåº”ç”¨               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  @click.group()     â† å‘½ä»¤ç»„ç®¡ç†      â”‚
â”‚  @click.command()   â† å•ä¸ªå‘½ä»¤        â”‚
â”‚  @click.option()    â† å¯é€‰å‚æ•°        â”‚
â”‚  @click.argument() â† å¿…éœ€å‚æ•°         â”‚
â”‚  @click.pass_context â† ä¸Šä¸‹æ–‡ä¼ é€’     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç»„ä»¶è¯´æ˜**ï¼š
- **Commandï¼ˆå‘½ä»¤ï¼‰**ï¼šå¯æ‰§è¡Œçš„æ“ä½œï¼Œå¯¹åº”ä¸€ä¸ªPythonå‡½æ•°
- **Groupï¼ˆå‘½ä»¤ç»„ï¼‰**ï¼šç®¡ç†å¤šä¸ªç›¸å…³å‘½ä»¤ï¼Œå¦‚`git add`ã€`git commit`
- **Optionï¼ˆé€‰é¡¹ï¼‰**ï¼šå¯é€‰å‚æ•°ï¼Œå¦‚`--verbose`ã€`--output file.txt`
- **Argumentï¼ˆå‚æ•°ï¼‰**ï¼šå¿…éœ€å‚æ•°ï¼Œå¦‚æ–‡ä»¶åã€ç”¨æˆ·å
- **Contextï¼ˆä¸Šä¸‹æ–‡ï¼‰**ï¼šåœ¨å‘½ä»¤é—´ä¼ é€’ä¿¡æ¯çš„"ä¿¡ä½¿"

---

## 3. ğŸ¨ å‘½ä»¤è£…é¥°å™¨ç³»ç»Ÿ


### 3.1 è£…é¥°å™¨çš„æœ¬è´¨ç†è§£


**è£…é¥°å™¨å°±åƒç»™å‡½æ•°"è´´æ ‡ç­¾"**ï¼š

```python
# æ™®é€šå‡½æ•°ï¼šåªæ˜¯ä¸€ä¸ªPythonå‡½æ•°
def greet(name):
    print(f"Hello {name}")

# åŠ ä¸Š@click.command()è£…é¥°å™¨ï¼šå˜æˆCLIå‘½ä»¤ï¼
@click.command()
def greet(name):
    print(f"Hello {name}")
    
# è£…é¥°å™¨åšäº†ä»€ä¹ˆï¼Ÿ
# 1. å‘Šè¯‰Clickï¼š"è¿™ä¸ªå‡½æ•°æ˜¯ä¸ªå‘½ä»¤"
# 2. è‡ªåŠ¨å¤„ç†å‘½ä»¤è¡Œè°ƒç”¨
# 3. ç”Ÿæˆå¸®åŠ©æ–‡æ¡£
# 4. å¤„ç†é”™è¯¯æƒ…å†µ
```

### 3.2 å‘½ä»¤è£…é¥°å™¨è¯¦è§£


**ğŸ”¸ @click.command() - å•å‘½ä»¤è£…é¥°å™¨**

```python
@click.command()
@click.option('--count', default=1, help='é‡å¤æ¬¡æ•°')
@click.option('--name', prompt='ä½ çš„åå­—', help='è¦é—®å€™çš„äºº')
def hello(count, name):
    """é‡å¤é—®å€™ç¨‹åº - å¯ä»¥é—®å€™å¤šæ¬¡"""
    for i in range(count):
        click.echo(f'Hello {name}! (ç¬¬{i+1}æ¬¡)')
```

**ç‰¹æ®ŠåŠŸèƒ½å±•ç¤º**ï¼š
- `prompt='ä½ çš„åå­—'`ï¼šå¦‚æœç”¨æˆ·æ²¡æä¾›å‚æ•°ï¼Œ**è‡ªåŠ¨è¯¢é—®**
- `default=1`ï¼š**é»˜è®¤å€¼**è®¾ç½®
- `help='...'`ï¼š**å¸®åŠ©æ–‡æœ¬**è‡ªåŠ¨ç”Ÿæˆ

### 3.3 å‘½ä»¤ç»„ç®¡ç†


**ğŸ”¸ @click.group() - å¤šå‘½ä»¤ç®¡ç†**

```python
@click.group()
def cli():
    """æ–‡ä»¶ç®¡ç†å·¥å…· - æä¾›å¤šç§æ–‡ä»¶æ“ä½œ"""
    pass

@cli.command()
@click.argument('filename')
def create(filename):
    """åˆ›å»ºæ–°æ–‡ä»¶"""
    with open(filename, 'w') as f:
        f.write('')
    click.echo(f'æ–‡ä»¶ {filename} åˆ›å»ºæˆåŠŸï¼')

@cli.command()
@click.argument('filename')
def delete(filename):
    """åˆ é™¤æ–‡ä»¶"""
    import os
    if os.path.exists(filename):
        os.remove(filename)
        click.echo(f'æ–‡ä»¶ {filename} åˆ é™¤æˆåŠŸï¼')
    else:
        click.echo(f'æ–‡ä»¶ {filename} ä¸å­˜åœ¨ï¼', err=True)

if __name__ == '__main__':
    cli()
```

**ä½¿ç”¨æ•ˆæœ**ï¼š
```bash
$ python filetool.py create test.txt    # åˆ›å»ºæ–‡ä»¶
$ python filetool.py delete test.txt    # åˆ é™¤æ–‡ä»¶
$ python filetool.py --help            # æŸ¥çœ‹æ‰€æœ‰å‘½ä»¤
```

### 3.4 åµŒå¥—å‘½ä»¤ç»„


**ğŸ—ï¸ å¤æ‚å‘½ä»¤ç»“æ„**ï¼š

```python
@click.group()
def cli():
    """æ•°æ®åº“ç®¡ç†å·¥å…·"""
    pass

@cli.group()
def user():
    """ç”¨æˆ·ç®¡ç†å‘½ä»¤ç»„"""
    pass

@user.command()
@click.argument('username')
def add(username):
    """æ·»åŠ æ–°ç”¨æˆ·"""
    click.echo(f'ç”¨æˆ· {username} æ·»åŠ æˆåŠŸ')

@user.command()
def list():
    """åˆ—å‡ºæ‰€æœ‰ç”¨æˆ·"""
    click.echo('ç”¨æˆ·åˆ—è¡¨ï¼š...')
```

**å‘½ä»¤å±‚æ¬¡ç»“æ„**ï¼š
```
cli
â”œâ”€â”€ user
â”‚   â”œâ”€â”€ add     â† python tool.py user add å¼ ä¸‰
â”‚   â””â”€â”€ list    â† python tool.py user list
â””â”€â”€ å…¶ä»–å‘½ä»¤...
```

---

## 4. ğŸ“ å‚æ•°ç±»å‹å®šä¹‰


### 4.1 å‚æ•°ç±»å‹ç³»ç»Ÿæ¦‚è¿°


**Clickçš„å‚æ•°ç±»å‹å°±åƒ"æ•°æ®éªŒè¯å™¨"**ï¼šç”¨æˆ·è¾“å…¥ä»€ä¹ˆï¼ŒClickå¸®ä½ **è‡ªåŠ¨æ£€æŸ¥**æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼Œä¸ç¬¦åˆå°±**å‹å¥½æç¤ºé”™è¯¯**ã€‚

```
ç”¨æˆ·è¾“å…¥ï¼špython script.py --age abc
æ²¡æœ‰ç±»å‹æ£€æŸ¥ï¼šç¨‹åºå´©æºƒ ğŸ’¥
æœ‰ç±»å‹æ£€æŸ¥ï¼šå‹å¥½æç¤º "abcä¸æ˜¯æœ‰æ•ˆçš„æ•´æ•°" âœ…
```

### 4.2 åŸºç¡€ç±»å‹å®šä¹‰


**ğŸ”¸ å¸¸ç”¨ç±»å‹é€Ÿè§ˆ**ï¼š

```python
@click.command()
@click.option('--age', type=int, help='å¹´é¾„ï¼ˆæ•´æ•°ï¼‰')
@click.option('--price', type=float, help='ä»·æ ¼ï¼ˆå°æ•°ï¼‰')
@click.option('--name', type=str, help='å§“åï¼ˆå­—ç¬¦ä¸²ï¼‰')
@click.option('--active', type=bool, help='æ˜¯å¦æ¿€æ´»ï¼ˆå¸ƒå°”å€¼ï¼‰')
def demo(age, price, name, active):
    click.echo(f'å¹´é¾„: {age} (ç±»å‹: {type(age)})')
    click.echo(f'ä»·æ ¼: {price} (ç±»å‹: {type(price)})')
    click.echo(f'å§“å: {name} (ç±»å‹: {type(name)})')
    click.echo(f'æ¿€æ´»: {active} (ç±»å‹: {type(active)})')
```

**ç±»å‹è½¬æ¢æ•ˆæœ**ï¼š
```bash
$ python demo.py --age 25 --price 99.9 --name å¼ ä¸‰ --active true
å¹´é¾„: 25 (ç±»å‹: <class 'int'>)
ä»·æ ¼: 99.9 (ç±»å‹: <class 'float'>)  
å§“å: å¼ ä¸‰ (ç±»å‹: <class 'str'>)
æ¿€æ´»: True (ç±»å‹: <class 'bool'>)
```

### 4.3 é«˜çº§ç±»å‹å®šä¹‰


**ğŸ¯ Choiceç±»å‹ - é™åˆ¶é€‰æ‹©èŒƒå›´**ï¼š

```python
@click.command()
@click.option('--level', 
              type=click.Choice(['debug', 'info', 'warning', 'error']),
              default='info',
              help='æ—¥å¿—çº§åˆ«')
def log(level):
    """è®¾ç½®æ—¥å¿—çº§åˆ«"""
    click.echo(f'æ—¥å¿—çº§åˆ«è®¾ç½®ä¸º: {level}')
```

**ğŸ”¸ Rangeç±»å‹ - æ•°å€¼èŒƒå›´é™åˆ¶**ï¼š

```python
@click.command()
@click.option('--port', 
              type=click.IntRange(1, 65535),
              default=8080,
              help='ç«¯å£å· (1-65535)')
@click.option('--cpu', 
              type=click.FloatRange(0.0, 100.0),
              help='CPUä½¿ç”¨ç‡ (0-100%)')
def server(port, cpu):
    click.echo(f'æœåŠ¡å™¨ç«¯å£: {port}, CPUé™åˆ¶: {cpu}%')
```

### 4.4 æ–‡ä»¶ç±»å‹å¤„ç†


**ğŸ“ Fileç±»å‹ - è‡ªåŠ¨æ–‡ä»¶å¤„ç†**ï¼š

```python
@click.command()
@click.option('--input', 
              type=click.File('r', encoding='utf-8'),
              help='è¾“å…¥æ–‡ä»¶')
@click.option('--output', 
              type=click.File('w', encoding='utf-8'),
              default='output.txt',
              help='è¾“å‡ºæ–‡ä»¶')
def process(input, output):
    """æ–‡ä»¶å¤„ç†å·¥å…·"""
    if input:
        content = input.read()
        output.write(f'å¤„ç†åçš„å†…å®¹: {content}')
        click.echo('æ–‡ä»¶å¤„ç†å®Œæˆï¼')
```

**ğŸ—‚ï¸ Pathç±»å‹ - è·¯å¾„éªŒè¯**ï¼š

```python
@click.command()
@click.option('--config', 
              type=click.Path(exists=True, readable=True),
              help='é…ç½®æ–‡ä»¶è·¯å¾„ï¼ˆå¿…é¡»å­˜åœ¨ä¸”å¯è¯»ï¼‰')
@click.option('--output-dir', 
              type=click.Path(file_okay=False, dir_okay=True),
              help='è¾“å‡ºç›®å½•è·¯å¾„')
def backup(config, output_dir):
    click.echo(f'é…ç½®æ–‡ä»¶: {config}')
    click.echo(f'è¾“å‡ºç›®å½•: {output_dir}')
```

---

## 5. ğŸ”„ ä¸Šä¸‹æ–‡ç®¡ç†æœºåˆ¶


### 5.1 ä¸Šä¸‹æ–‡çš„æ¦‚å¿µç†è§£


**ä¸Šä¸‹æ–‡å°±åƒ"ä¿¡æ¯ä¼ é€’å‘˜"**ï¼šåœ¨å¤æ‚çš„å¤šå‘½ä»¤ç¨‹åºä¸­ï¼Œæœ‰äº›ä¿¡æ¯éœ€è¦åœ¨ä¸åŒå‘½ä»¤é—´**å…±äº«**ï¼Œä¸Šä¸‹æ–‡å°±æ˜¯è´Ÿè´£**ä¼ é€’å’Œä¿å­˜**è¿™äº›å…±äº«ä¿¡æ¯çš„æœºåˆ¶ã€‚

```
æƒ³è±¡åœºæ™¯ï¼šæ•°æ®åº“ç®¡ç†å·¥å…·
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å…¨å±€é…ç½®ï¼ˆéœ€è¦å„å‘½ä»¤å…±äº«ï¼‰            â”‚
â”‚  â”œâ”€ æ•°æ®åº“è¿æ¥ä¿¡æ¯                   â”‚
â”‚  â”œâ”€ ç”¨æˆ·æƒé™çº§åˆ«                     â”‚
â”‚  â””â”€ æ—¥å¿—é…ç½®                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‘½ä»¤1: åˆ›å»ºè¡¨ â† éœ€è¦æ•°æ®åº“è¿æ¥ä¿¡æ¯    â”‚
â”‚  å‘½ä»¤2: æŸ¥è¯¢æ•°æ® â† éœ€è¦æ•°æ®åº“è¿æ¥ä¿¡æ¯  â”‚
â”‚  å‘½ä»¤3: å¤‡ä»½ â† éœ€è¦æƒé™éªŒè¯           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¸Šä¸‹æ–‡ = è¿™äº›å…±äº«ä¿¡æ¯çš„"å‚¨ç‰©æŸœ"
```

### 5.2 åŸºç¡€ä¸Šä¸‹æ–‡ä½¿ç”¨


**ğŸ”¸ åˆ›å»ºå’Œä¼ é€’ä¸Šä¸‹æ–‡**ï¼š

```python
@click.group()
@click.option('--verbose', is_flag=True, help='è¯¦ç»†è¾“å‡º')
@click.pass_context
def cli(ctx, verbose):
    """æ•°æ®å¤„ç†å·¥å…·"""
    # åˆ›å»ºä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œå­˜å‚¨å…¨å±€é…ç½®
    ctx.ensure_object(dict)
    ctx.obj['verbose'] = verbose
    ctx.obj['start_time'] = time.time()

@cli.command()
@click.argument('filename')
@click.pass_context  
def process(ctx, filename):
    """å¤„ç†æ–‡ä»¶"""
    # ä»ä¸Šä¸‹æ–‡è·å–å…¨å±€é…ç½®
    verbose = ctx.obj['verbose']
    
    if verbose:
        click.echo(f'å¼€å§‹å¤„ç†æ–‡ä»¶: {filename}')
        
    # æ¨¡æ‹Ÿå¤„ç†
    time.sleep(1)
    
    if verbose:
        elapsed = time.time() - ctx.obj['start_time']
        click.echo(f'å¤„ç†å®Œæˆï¼Œè€—æ—¶: {elapsed:.2f}ç§’')
```

### 5.3 ä¸Šä¸‹æ–‡çš„é«˜çº§ç”¨æ³•


**ğŸ”§ ä¸Šä¸‹æ–‡å¯¹è±¡å°è£…**ï¼š

```python
class AppConfig:
    """åº”ç”¨é…ç½®ç±»"""
    def __init__(self, debug=False, db_url=None):
        self.debug = debug
        self.db_url = db_url
        self.logger = self._setup_logger()
    
    def _setup_logger(self):
        import logging
        level = logging.DEBUG if self.debug else logging.INFO
        logging.basicConfig(level=level)
        return logging.getLogger(__name__)

@click.group()
@click.option('--debug', is_flag=True, help='è°ƒè¯•æ¨¡å¼')
@click.option('--db-url', default='sqlite:///app.db', help='æ•°æ®åº“URL')
@click.pass_context
def cli(ctx, debug, db_url):
    """åº”ç”¨ä¸»å‘½ä»¤ç»„"""
    ctx.obj = AppConfig(debug=debug, db_url=db_url)

@cli.command()
@click.pass_obj  # ç›´æ¥ä¼ é€’ctx.objå¯¹è±¡
def status(config):
    """æ˜¾ç¤ºåº”ç”¨çŠ¶æ€"""
    config.logger.info('æ£€æŸ¥åº”ç”¨çŠ¶æ€...')
    click.echo(f'è°ƒè¯•æ¨¡å¼: {config.debug}')
    click.echo(f'æ•°æ®åº“: {config.db_url}')
```

---

## 6. ğŸ”Œ æ’ä»¶ç³»ç»Ÿæ‰©å±•


### 6.1 æ’ä»¶ç³»ç»Ÿçš„ä½œç”¨


**æ’ä»¶ç³»ç»Ÿå°±åƒ"æ¨¡å—åŒ–ç»„è£…"**ï¼šæŠŠåŠŸèƒ½æ‹†åˆ†æˆç‹¬ç«‹çš„å°æ¨¡å—ï¼Œéœ€è¦ä»€ä¹ˆåŠŸèƒ½å°±"æ’"ä»€ä¹ˆæ¨¡å—ï¼Œè®©ä½ çš„CLIå·¥å…·å¯ä»¥**çµæ´»æ‰©å±•**ã€‚

```
ä¸»ç¨‹åºï¼šæ ¸å¿ƒCLIæ¡†æ¶
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ä¸»CLIå·¥å…·               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”Œ æ•°æ®åº“æ’ä»¶  â† å¯é€‰åŠŸèƒ½            â”‚
â”‚  ğŸ”Œ é‚®ä»¶æ’ä»¶    â† å¯é€‰åŠŸèƒ½            â”‚  
â”‚  ğŸ”Œ æ—¥å¿—æ’ä»¶    â† å¯é€‰åŠŸèƒ½            â”‚
â”‚  ğŸ”Œ è®¤è¯æ’ä»¶    â† å¯é€‰åŠŸèƒ½            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¥½å¤„ï¼š
âœ… æŒ‰éœ€åŠ è½½ï¼Œç¨‹åºæ›´è½»é‡
âœ… åŠŸèƒ½ç‹¬ç«‹ï¼Œä¾¿äºç»´æŠ¤  
âœ… æ˜“äºæ‰©å±•æ–°åŠŸèƒ½
```

### 6.2 åŸºäºsetuptoolsçš„æ’ä»¶ç³»ç»Ÿ


**ğŸ”§ æ’ä»¶æ³¨å†Œæœºåˆ¶**ï¼š

```python
# setup.py - æ’ä»¶æ³¨å†Œ
from setuptools import setup

setup(
    name='my-cli-tool',
    entry_points={
        'console_scripts': [
            'mytool=mytool.cli:main',
        ],
        'mytool.plugins': [
            'database=mytool.plugins.database:DatabasePlugin',
            'email=mytool.plugins.email:EmailPlugin',
        ],
    },
)
```

**ğŸ” æ’ä»¶å‘ç°å’ŒåŠ è½½**ï¼š

```python
import pkg_resources

class PluginManager:
    """æ’ä»¶ç®¡ç†å™¨"""
    
    def __init__(self):
        self.plugins = {}
        self.load_plugins()
    
    def load_plugins(self):
        """è‡ªåŠ¨å‘ç°å’ŒåŠ è½½æ’ä»¶"""
        for entry_point in pkg_resources.iter_entry_points('mytool.plugins'):
            try:
                plugin_class = entry_point.load()
                plugin = plugin_class()
                self.plugins[entry_point.name] = plugin
                click.echo(f'æ’ä»¶åŠ è½½æˆåŠŸ: {entry_point.name}')
            except Exception as e:
                click.echo(f'æ’ä»¶åŠ è½½å¤±è´¥ {entry_point.name}: {e}', err=True)
    
    def get_plugin(self, name):
        """è·å–æŒ‡å®šæ’ä»¶"""
        return self.plugins.get(name)
```

### 6.3 åŠ¨æ€å‘½ä»¤æ’ä»¶


**ğŸš€ æ’ä»¶åŒ–å‘½ä»¤æ‰©å±•**ï¼š

```python
class PluginCommand(click.MultiCommand):
    """æ”¯æŒæ’ä»¶çš„å‘½ä»¤ç±»"""
    
    def list_commands(self, ctx):
        """åˆ—å‡ºæ‰€æœ‰å¯ç”¨å‘½ä»¤ï¼ˆåŒ…æ‹¬æ’ä»¶å‘½ä»¤ï¼‰"""
        # å†…ç½®å‘½ä»¤
        commands = ['status', 'config']
        
        # æ’ä»¶å‘½ä»¤
        for entry_point in pkg_resources.iter_entry_points('mytool.commands'):
            commands.append(entry_point.name)
            
        return sorted(commands)
    
    def get_command(self, ctx, name):
        """è·å–å‘½ä»¤ï¼ˆåŠ¨æ€åŠ è½½æ’ä»¶å‘½ä»¤ï¼‰"""
        # å…ˆæŸ¥æ‰¾å†…ç½®å‘½ä»¤
        if name == 'status':
            return status_command
        elif name == 'config':
            return config_command
            
        # æŸ¥æ‰¾æ’ä»¶å‘½ä»¤
        for entry_point in pkg_resources.iter_entry_points('mytool.commands'):
            if entry_point.name == name:
                return entry_point.load()
        
        return None

@click.command(cls=PluginCommand)
def cli():
    """æ”¯æŒæ’ä»¶çš„CLIå·¥å…·"""
    pass
```

---

## 7. ğŸ¨ å½©è‰²è¾“å‡ºå¢å¼º


### 7.1 ä¸ºä»€ä¹ˆéœ€è¦å½©è‰²è¾“å‡º


**å½©è‰²è¾“å‡ºçš„ä»·å€¼**ï¼š
æƒ³è±¡ä¸€ä¸‹ï¼Œä½ çœ‹ä¸€ä»½**å…¨æ˜¯é»‘ç™½å­—**çš„é•¿æŠ¥å‘Š vs ä¸€ä»½**ç”¨ä¸åŒé¢œè‰²æ ‡è®°é‡ç‚¹**çš„æŠ¥å‘Šï¼Œå“ªä¸ªæ›´å®¹æ˜“ç†è§£ï¼Ÿ

```
æ™®é€šè¾“å‡ºï¼š
ERROR: æ–‡ä»¶ä¸å­˜åœ¨
WARNING: ç£ç›˜ç©ºé—´ä¸è¶³  
INFO: æ“ä½œå®Œæˆ

å½©è‰²è¾“å‡ºï¼š
ğŸ”´ ERROR: æ–‡ä»¶ä¸å­˜åœ¨      â† çº¢è‰²ï¼Œç«‹å³å¼•èµ·æ³¨æ„
ğŸŸ¡ WARNING: ç£ç›˜ç©ºé—´ä¸è¶³   â† é»„è‰²ï¼Œæé†’æ³¨æ„
ğŸŸ¢ INFO: æ“ä½œå®Œæˆ         â† ç»¿è‰²ï¼Œè¡¨ç¤ºæˆåŠŸ

æ•ˆæœï¼šä¸€çœ¼å°±èƒ½çœ‹å‡ºé—®é¢˜çš„ä¸¥é‡ç¨‹åº¦ï¼
```

### 7.2 ä½¿ç”¨coloramaå®ç°å½©è‰²è¾“å‡º


**ğŸŒˆ coloramaåŸºç¡€ç”¨æ³•**ï¼š

```python
from colorama import init, Fore, Back, Style
import click

# åˆå§‹åŒ–coloramaï¼ˆWindowså…¼å®¹ï¼‰
init(autoreset=True)

@click.command()
def demo():
    """å½©è‰²è¾“å‡ºæ¼”ç¤º"""
    # å‰æ™¯è‰²ï¼ˆæ–‡å­—é¢œè‰²ï¼‰
    click.echo(Fore.RED + 'è¿™æ˜¯çº¢è‰²æ–‡å­—')
    click.echo(Fore.GREEN + 'è¿™æ˜¯ç»¿è‰²æ–‡å­—')  
    click.echo(Fore.BLUE + 'è¿™æ˜¯è“è‰²æ–‡å­—')
    
    # èƒŒæ™¯è‰²
    click.echo(Back.YELLOW + 'è¿™æ˜¯é»„è‰²èƒŒæ™¯')
    
    # æ–‡å­—æ ·å¼
    click.echo(Style.BRIGHT + 'è¿™æ˜¯é«˜äº®æ–‡å­—')
    click.echo(Style.DIM + 'è¿™æ˜¯æš—æ·¡æ–‡å­—')
    
    # ç»„åˆä½¿ç”¨
    click.echo(Fore.WHITE + Back.RED + Style.BRIGHT + 'é‡è¦è­¦å‘Šï¼')
```

**ğŸ”§ å°è£…å½©è‰²è¾“å‡ºå‡½æ•°**ï¼š

```python
def colored_echo(message, color='white', bg=None, bright=False):
    """å°è£…çš„å½©è‰²è¾“å‡ºå‡½æ•°"""
    color_map = {
        'red': Fore.RED,
        'green': Fore.GREEN,
        'blue': Fore.BLUE,
        'yellow': Fore.YELLOW,
        'white': Fore.WHITE,
        'cyan': Fore.CYAN,
        'magenta': Fore.MAGENTA,
    }
    
    bg_map = {
        'red': Back.RED,
        'green': Back.GREEN,
        'blue': Back.BLUE,
        'yellow': Back.YELLOW,
    }
    
    style = ''
    if bright:
        style += Style.BRIGHT
    
    text_color = color_map.get(color, Fore.WHITE)
    bg_color = bg_map.get(bg, '') if bg else ''
    
    click.echo(style + bg_color + text_color + message + Style.RESET_ALL)

# ä½¿ç”¨ç¤ºä¾‹
colored_echo('æˆåŠŸå®Œæˆï¼', 'green', bright=True)
colored_echo('è­¦å‘Šä¿¡æ¯', 'yellow')
colored_echo('ä¸¥é‡é”™è¯¯ï¼', 'white', 'red', bright=True)
```

### 7.3 ä½¿ç”¨richå®ç°é«˜çº§ç¾åŒ–


**âœ¨ rich - ç°ä»£åŒ–ç»ˆç«¯ç¾åŒ–åº“**ï¼š

```python
from rich.console import Console
from rich.table import Table
from rich.progress import Progress
from rich.panel import Panel
from rich.text import Text

console = Console()

@click.command()
def rich_demo():
    """richç¾åŒ–æ¼”ç¤º"""
    
    # 1. é¢æ¿è¾“å‡º
    console.print(Panel("æ¬¢è¿ä½¿ç”¨æˆ‘çš„CLIå·¥å…·ï¼", title="ğŸ‰ æ¬¢è¿"))
    
    # 2. è¡¨æ ¼è¾“å‡º
    table = Table(title="â­ ç”¨æˆ·ä¿¡æ¯")
    table.add_column("å§“å", style="cyan")
    table.add_column("å¹´é¾„", style="magenta")
    table.add_column("çŠ¶æ€", style="green")
    
    table.add_row("å¼ ä¸‰", "25", "âœ… åœ¨çº¿")
    table.add_row("æå››", "30", "âŒ ç¦»çº¿")
    console.print(table)
    
    # 3. è¯­æ³•é«˜äº®ä»£ç 
    code = '''
def hello(name):
    print(f"Hello {name}!")
    '''
    console.print(Panel(code, title="Pythonä»£ç ", border_style="blue"))
```

### 7.4 æ™ºèƒ½å½©è‰²è¾“å‡ºç®¡ç†


**ğŸ¯ åŸºäºæ—¥å¿—çº§åˆ«çš„æ™ºèƒ½ç€è‰²**ï¼š

```python
class SmartLogger:
    """æ™ºèƒ½å½©è‰²æ—¥å¿—å™¨"""
    
    def __init__(self):
        self.console = Console()
    
    def info(self, message):
        """ä¿¡æ¯çº§åˆ« - è“è‰²"""
        self.console.print(f"â„¹ï¸  [blue]{message}[/blue]")
    
    def success(self, message):
        """æˆåŠŸçº§åˆ« - ç»¿è‰²"""
        self.console.print(f"âœ… [green]{message}[/green]")
    
    def warning(self, message):
        """è­¦å‘Šçº§åˆ« - é»„è‰²"""
        self.console.print(f"âš ï¸  [yellow]{message}[/yellow]")
    
    def error(self, message):
        """é”™è¯¯çº§åˆ« - çº¢è‰²"""
        self.console.print(f"âŒ [red]{message}[/red]")
    
    def debug(self, message):
        """è°ƒè¯•çº§åˆ« - ç°è‰²"""
        self.console.print(f"ğŸ› [dim]{message}[/dim]")

logger = SmartLogger()

@click.command()
@click.option('--verbose', is_flag=True)
def process(verbose):
    """æ–‡ä»¶å¤„ç†ç¤ºä¾‹"""
    logger.info("å¼€å§‹å¤„ç†æ–‡ä»¶...")
    
    try:
        # æ¨¡æ‹Ÿå¤„ç†è¿‡ç¨‹
        if verbose:
            logger.debug("æ­£åœ¨è¯»å–é…ç½®æ–‡ä»¶...")
            logger.debug("æ­£åœ¨éªŒè¯è¾“å…¥å‚æ•°...")
        
        logger.success("æ–‡ä»¶å¤„ç†å®Œæˆï¼")
        
    except Exception as e:
        logger.error(f"å¤„ç†å¤±è´¥: {e}")
```

---

## 8. ğŸ“Š è¿›åº¦æ¡æ˜¾ç¤º


### 8.1 è¿›åº¦æ¡çš„é‡è¦æ€§


**è¿›åº¦æ¡ = ç”¨æˆ·ä½“éªŒçš„"å®šå¿ƒä¸¸"**ï¼š

```
æ²¡æœ‰è¿›åº¦æ¡çš„ä½“éªŒï¼š
ç”¨æˆ·ï¼šç‚¹å‡»å¤„ç†æŒ‰é’®
ç¨‹åºï¼šï¼ˆé™é»˜è¿è¡Œ30ç§’ï¼‰
ç”¨æˆ·ï¼šç¨‹åºæ­»äº†å—ï¼Ÿè¦ä¸è¦é‡å¯ï¼ŸğŸ˜°

æœ‰è¿›åº¦æ¡çš„ä½“éªŒï¼š  
ç”¨æˆ·ï¼šç‚¹å‡»å¤„ç†æŒ‰é’®
ç¨‹åºï¼šProcessing... â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 80% (24s left)
ç”¨æˆ·ï¼šè¿˜æœ‰24ç§’ï¼Œå»å†²æ¯å’–å•¡ â˜•ğŸ˜Š
```

### 8.2 ä½¿ç”¨tqdmå®ç°è¿›åº¦æ¡


**ğŸ”„ tqdm - æœ€æµè¡Œçš„è¿›åº¦æ¡åº“**ï¼š

```python
from tqdm import tqdm
import time
import click

@click.command()
@click.option('--count', default=100, help='å¤„ç†æ•°é‡')
def process_with_tqdm(count):
    """ä½¿ç”¨tqdmæ˜¾ç¤ºè¿›åº¦"""
    
    # åŸºç¡€è¿›åº¦æ¡
    click.echo("å¼€å§‹å¤„ç†æ–‡ä»¶...")
    for i in tqdm(range(count), desc="å¤„ç†è¿›åº¦"):
        time.sleep(0.01)  # æ¨¡æ‹Ÿå¤„ç†æ—¶é—´
    
    click.echo("âœ… å¤„ç†å®Œæˆï¼")

@click.command()  
def advanced_tqdm():
    """é«˜çº§tqdmç”¨æ³•æ¼”ç¤º"""
    
    # å¤šä¸ªè¿›åº¦æ¡
    with tqdm(total=100, desc="é˜¶æ®µ1", position=0) as pbar1:
        with tqdm(total=50, desc="é˜¶æ®µ2", position=1) as pbar2:
            for i in range(100):
                time.sleep(0.02)
                pbar1.update(1)
                if i < 50:
                    pbar2.update(1)
```

**ğŸ¨ è‡ªå®šä¹‰è¿›åº¦æ¡æ ·å¼**ï¼š

```python
@click.command()
@click.argument('files', nargs=-1)
def backup_files(files):
    """æ–‡ä»¶å¤‡ä»½å·¥å…·"""
    
    # è‡ªå®šä¹‰è¿›åº¦æ¡æ ¼å¼
    progress_format = "{desc}: {percentage:3.0f}%|{bar}| {n}/{total} [{elapsed}<{remaining}]"
    
    with tqdm(files, desc="ğŸ“ å¤‡ä»½æ–‡ä»¶", 
              unit="ä¸ªæ–‡ä»¶", 
              bar_format=progress_format,
              colour='green') as pbar:
        
        for file in pbar:
            # åŠ¨æ€æ›´æ–°æè¿°
            pbar.set_description(f"ğŸ“ æ­£åœ¨å¤‡ä»½: {file}")
            
            # æ¨¡æ‹Ÿå¤‡ä»½è¿‡ç¨‹
            time.sleep(0.5)
            
            # æ›´æ–°åç¼€ä¿¡æ¯
            pbar.set_postfix({"çŠ¶æ€": "âœ…å®Œæˆ"})
```

### 8.3 ä½¿ç”¨Clickå†…ç½®è¿›åº¦æ¡


**ğŸ”§ ClickåŸç”Ÿè¿›åº¦æ¡æ”¯æŒ**ï¼š

```python
@click.command()
@click.option('--items', default=1000, help='å¤„ç†é¡¹ç›®æ•°')
def click_progress(items):
    """Clickå†…ç½®è¿›åº¦æ¡æ¼”ç¤º"""
    
    # åŸºç¡€è¿›åº¦æ¡
    with click.progressbar(range(items), label='å¤„ç†è¿›åº¦') as bar:
        for item in bar:
            time.sleep(0.001)
    
    click.echo('âœ… å¤„ç†å®Œæˆï¼')

@click.command()
def file_download():
    """æ–‡ä»¶ä¸‹è½½è¿›åº¦æ¼”ç¤º"""
    
    # æ¨¡æ‹Ÿæ–‡ä»¶ä¸‹è½½
    total_size = 1024 * 1024  # 1MB
    chunk_size = 1024  # 1KBæ¯æ¬¡
    
    with click.progressbar(length=total_size, 
                          label='ğŸ“¥ ä¸‹è½½æ–‡ä»¶',
                          fill_char='â–ˆ',
                          empty_char='â–‘') as bar:
        
        downloaded = 0
        while downloaded < total_size:
            # æ¨¡æ‹Ÿä¸‹è½½chunk
            time.sleep(0.01)
            chunk = min(chunk_size, total_size - downloaded)
            downloaded += chunk
            bar.update(chunk)
    
    click.echo('ğŸ“ ä¸‹è½½å®Œæˆï¼')
```

### 8.4 Richè¿›åº¦æ¡çš„é«˜çº§åŠŸèƒ½


**âœ¨ Rich - æœ€ç¾è§‚çš„è¿›åº¦æ¡**ï¼š

```python
from rich.progress import Progress, TaskID, BarColumn, TextColumn, TimeRemainingColumn

@click.command()
def rich_progress_demo():
    """Richè¿›åº¦æ¡æ¼”ç¤º"""
    
    with Progress(
        TextColumn("[progress.description]{task.description}"),
        BarColumn(),
        "[progress.percentage]{task.percentage:>3.0f}%",
        TimeRemainingColumn(),
        console=console
    ) as progress:
        
        # å¤šä»»åŠ¡è¿›åº¦è·Ÿè¸ª
        task1 = progress.add_task("ğŸ” æ‰«ææ–‡ä»¶...", total=100)
        task2 = progress.add_task("ğŸ“¦ å‹ç¼©æ•°æ®...", total=80)
        task3 = progress.add_task("ğŸš€ ä¸Šä¼ æ–‡ä»¶...", total=60)
        
        # æ¨¡æ‹Ÿä¸åŒé€Ÿåº¦çš„ä»»åŠ¡
        for i in range(100):
            time.sleep(0.02)
            progress.update(task1, advance=1)
            
            if i < 80:
                progress.update(task2, advance=1)
            if i < 60:
                progress.update(task3, advance=1)
```

---

## 9. âš–ï¸ CLIæ¡†æ¶å¯¹æ¯”åˆ†æ


### 9.1 å…¨é¢å¯¹æ¯”è¡¨æ ¼


| ç‰¹æ€§ | **Click** | **Typer** | **argparse** | **Fire** |
|------|-----------|-----------|--------------|----------|
| ğŸ¯ **å­¦ä¹ éš¾åº¦** | `ğŸŸ¡ ä¸­ç­‰` | `ğŸŸ¢ ç®€å•` | `ğŸŸ¡ ä¸­ç­‰` | `ğŸŸ¢ æç®€` |
| ğŸš€ **å¼€å‘é€Ÿåº¦** | `ğŸŸ¡ ä¸­ç­‰` | `ğŸŸ¢ å¿«é€Ÿ` | `ğŸ”´ è¾ƒæ…¢` | `ğŸŸ¢ æå¿«` |
| ğŸ’ª **åŠŸèƒ½ä¸°å¯Œåº¦** | `ğŸŸ¢ ä¸°å¯Œ` | `ğŸŸ¢ ä¸°å¯Œ` | `ğŸŸ¡ æ ‡å‡†` | `ğŸ”´ åŸºç¡€` |
| ğŸ¨ **ç¾è§‚ç¨‹åº¦** | `ğŸŸ¢ ä¼˜ç§€` | `ğŸŸ¢ ä¼˜ç§€` | `ğŸ”´ æœ´ç´ ` | `ğŸ”´ æœ´ç´ ` |
| ğŸ“š **ç”Ÿæ€ç³»ç»Ÿ** | `ğŸŸ¢ æˆç†Ÿ` | `ğŸŸ¡ å‘å±•ä¸­` | `ğŸŸ¢ å†…ç½®` | `ğŸŸ¡ Google` |
| ğŸ”§ **ç±»å‹æç¤º** | `ğŸŸ¡ éƒ¨åˆ†æ”¯æŒ` | `ğŸŸ¢ åŸç”Ÿæ”¯æŒ` | `ğŸ”´ ä¸æ”¯æŒ` | `ğŸŸ¢ è‡ªåŠ¨æ¨æ–­` |

### 9.2 é€‚ç”¨åœºæ™¯åˆ†æ


**ğŸ¯ é€‰æ‹©å†³ç­–æ ‘**ï¼š

```
ä½ çš„é¡¹ç›®éœ€æ±‚ï¼š
â”‚
â”œâ”€ ğŸš€ å¿«é€ŸåŸå‹å¼€å‘
â”‚   â””â”€ æ¨èï¼šFireï¼ˆé›¶é…ç½®ï¼Œç«‹å³å¯ç”¨ï¼‰
â”‚
â”œâ”€ ğŸ¨ ç¾è§‚çš„ç”¨æˆ·ç•Œé¢  
â”‚   â””â”€ æ¨èï¼šClick + Richï¼ˆä¸“ä¸šçº§ç¾åŒ–ï¼‰
â”‚
â”œâ”€ ğŸ“ ç°ä»£Pythonå¼€å‘ï¼ˆç±»å‹æç¤ºï¼‰
â”‚   â””â”€ æ¨èï¼šTyperï¼ˆåŸºäºClickï¼Œç±»å‹å‹å¥½ï¼‰
â”‚
â”œâ”€ ğŸ¢ ä¼ä¸šçº§æ ‡å‡†åŒ–
â”‚   â””â”€ æ¨èï¼šargparseï¼ˆPythonæ ‡å‡†åº“ï¼‰
â”‚
â””â”€ ğŸ”§ å¤æ‚çš„å¤šå‘½ä»¤å·¥å…·
    â””â”€ æ¨èï¼šClickï¼ˆåŠŸèƒ½æœ€å®Œæ•´ï¼‰
```

### 9.3 å®é™…ä»£ç å¯¹æ¯”


**ç›¸åŒåŠŸèƒ½çš„ä¸åŒå®ç°æ–¹å¼**ï¼š

```python
# ========== Click å®ç° ==========
import click

@click.command()
@click.option('--count', default=1, help='é‡å¤æ¬¡æ•°')
@click.argument('name')
def hello_click(count, name):
    """Clickç‰ˆæœ¬çš„é—®å€™ç¨‹åº"""
    for _ in range(count):
        click.echo(f'Hello {name}!')

# ========== Typer å®ç° ==========
import typer

def hello_typer(name: str, count: int = 1):
    """Typerç‰ˆæœ¬çš„é—®å€™ç¨‹åº"""
    for _ in range(count):
        typer.echo(f'Hello {name}!')

# ========== argparse å®ç° ==========
import argparse

def hello_argparse():
    """argparseç‰ˆæœ¬çš„é—®å€™ç¨‹åº"""
    parser = argparse.ArgumentParser(description='é—®å€™ç¨‹åº')
    parser.add_argument('name', help='è¦é—®å€™çš„åå­—')
    parser.add_argument('--count', type=int, default=1, help='é‡å¤æ¬¡æ•°')
    
    args = parser.parse_args()
    for _ in range(args.count):
        print(f'Hello {args.name}!')

# ========== Fire å®ç° ==========
import fire

def hello_fire(name, count=1):
    """Fireç‰ˆæœ¬çš„é—®å€™ç¨‹åº"""
    for _ in range(count):
        print(f'Hello {name}!')

if __name__ == '__main__':
    fire.Fire(hello_fire)
```

### 9.4 æ€§èƒ½å¯¹æ¯”


**âš¡ å¯åŠ¨æ€§èƒ½æµ‹è¯•**ï¼š

| æ¡†æ¶ | **å¯¼å…¥æ—¶é—´** | **é¦–æ¬¡è¿è¡Œ** | **å†…å­˜å ç”¨** |
|------|-------------|-------------|-------------|
| **argparse** | `~1ms` | `~5ms` | `~8MB` |
| **Fire** | `~10ms` | `~15ms` | `~12MB` |
| **Click** | `~15ms` | `~25ms` | `~15MB` |
| **Typer** | `~20ms` | `~30ms` | `~18MB` |

**ğŸ“Š åŠŸèƒ½å®Œæ•´æ€§è¯„åˆ†**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           åŠŸèƒ½å®Œæ•´æ€§å¯¹æ¯”              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Click     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  90%    â”‚
â”‚  Typer     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   85%    â”‚  
â”‚  argparse  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ      70%    â”‚
â”‚  Fire      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ           40%     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ CLIåº“æœ¬è´¨ï¼šå¿«é€Ÿæ„å»ºå‘½ä»¤è¡Œå·¥å…·çš„"è„šæ‰‹æ¶"
ğŸ”¸ Clickç‰¹è‰²ï¼šè£…é¥°å™¨é©±åŠ¨ + ç»„åˆè®¾è®¡ + è‡ªåŠ¨æ–‡æ¡£
ğŸ”¸ è£…é¥°å™¨ç³»ç»Ÿï¼š@command, @group, @option, @argument
ğŸ”¸ å‚æ•°ç±»å‹ï¼šè‡ªåŠ¨éªŒè¯ + ç±»å‹è½¬æ¢ + é”™è¯¯æç¤º
ğŸ”¸ ä¸Šä¸‹æ–‡ç®¡ç†ï¼šå¤šå‘½ä»¤é—´çš„ä¿¡æ¯å…±äº«æœºåˆ¶
ğŸ”¸ æ’ä»¶ç³»ç»Ÿï¼šæ¨¡å—åŒ–æ‰©å±•ï¼ŒæŒ‰éœ€åŠ è½½åŠŸèƒ½
ğŸ”¸ ç¾åŒ–è¾“å‡ºï¼šå½©è‰²æ–‡å­— + è¿›åº¦æ¡ + å¯Œæ–‡æœ¬æ˜¾ç¤º
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ è£…é¥°å™¨çš„æœ¬è´¨ä½œç”¨**
```
è£…é¥°å™¨ = ç»™æ™®é€šå‡½æ•°"è´´æ ‡ç­¾"
è´´ä¸Š@click.command() â†’ å˜æˆCLIå‘½ä»¤
è´´ä¸Š@click.option() â†’ æ·»åŠ å‘½ä»¤è¡Œå‚æ•°
è´´ä¸Š@click.group() â†’ å˜æˆå‘½ä»¤ç»„ç®¡ç†å™¨
```

**ğŸ”¹ å‚æ•°ç±»å‹çš„ä»·å€¼**
```
ç±»å‹ç³»ç»Ÿ = è‡ªåŠ¨"æ•°æ®éªŒè¯å™¨"
ç”¨æˆ·è¾“å…¥é”™è¯¯ â†’ å‹å¥½é”™è¯¯æç¤ºï¼ˆä¸æ˜¯ç¨‹åºå´©æºƒï¼‰
è‡ªåŠ¨ç±»å‹è½¬æ¢ â†’ ä½ ç›´æ¥è·å¾—æ­£ç¡®ç±»å‹çš„æ•°æ®
èŒƒå›´é™åˆ¶ â†’ ç¡®ä¿è¾“å…¥åœ¨åˆç†èŒƒå›´å†…
```

**ğŸ”¹ ä¸Šä¸‹æ–‡çš„åº”ç”¨åœºæ™¯**
```
ä»€ä¹ˆæ—¶å€™éœ€è¦ä¸Šä¸‹æ–‡ï¼š
âœ… å¤šä¸ªå‘½ä»¤éœ€è¦å…±äº«é…ç½®ä¿¡æ¯
âœ… å…¨å±€çŠ¶æ€ç®¡ç†ï¼ˆå¦‚æ•°æ®åº“è¿æ¥ï¼‰
âœ… å‘½ä»¤é—´éœ€è¦ä¼ é€’æ•°æ®
âœ… éœ€è¦ç»Ÿä¸€çš„é”™è¯¯å¤„ç†
```

### 10.3 æœ€ä½³å®è·µæŒ‡å—


**ğŸ¯ CLIå·¥å…·å¼€å‘æµç¨‹**
```
Step 1ï¸âƒ£ ç¡®å®šéœ€æ±‚
â”œâ”€ å•å‘½ä»¤ or å¤šå‘½ä»¤ï¼Ÿ
â”œâ”€ éœ€è¦ä»€ä¹ˆå‚æ•°ï¼Ÿ
â””â”€ ç”¨æˆ·ä½“éªŒè¦æ±‚ï¼Ÿ

Step 2ï¸âƒ£ é€‰æ‹©æ¡†æ¶  
â”œâ”€ å¿«é€ŸåŸå‹ï¼šFire
â”œâ”€ ç°ä»£å¼€å‘ï¼šTyper
â”œâ”€ å¤æ‚å·¥å…·ï¼šClick
â””â”€ ä¼ä¸šæ ‡å‡†ï¼šargparse

Step 3ï¸âƒ£ è®¾è®¡ç»“æ„
â”œâ”€ å‘½ä»¤å±‚æ¬¡è§„åˆ’
â”œâ”€ å‚æ•°ç±»å‹è®¾è®¡
â””â”€ é”™è¯¯å¤„ç†ç­–ç•¥

Step 4ï¸âƒ£ ç¾åŒ–ä½“éªŒ
â”œâ”€ å½©è‰²è¾“å‡º
â”œâ”€ è¿›åº¦æ¡æ˜¾ç¤º
â””â”€ å‹å¥½çš„é”™è¯¯æç¤º
```

**ğŸ’¡ ä»£ç ç»„ç»‡å»ºè®®**
```python
# æ¨èçš„é¡¹ç›®ç»“æ„
my_cli_tool/
â”œâ”€ cli/
â”‚   â”œâ”€ __init__.py
â”‚   â”œâ”€ main.py          # ä¸»å‘½ä»¤ç»„
â”‚   â”œâ”€ commands/        # å­å‘½ä»¤æ¨¡å—
â”‚   â”‚   â”œâ”€ user.py      # ç”¨æˆ·ç®¡ç†å‘½ä»¤
â”‚   â”‚   â””â”€ data.py      # æ•°æ®å¤„ç†å‘½ä»¤
â”‚   â”œâ”€ utils/           # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€ output.py    # å½©è‰²è¾“å‡ºå°è£…
â”‚   â”‚   â””â”€ progress.py  # è¿›åº¦æ¡å°è£…
â”‚   â””â”€ config.py        # é…ç½®ç®¡ç†
â”œâ”€ tests/               # æµ‹è¯•æ–‡ä»¶
â””â”€ setup.py            # å®‰è£…é…ç½®
```

**âš ï¸ å¸¸è§é™·é˜±é¿å…**
```
âŒ è¿‡åº¦ä½¿ç”¨ä»£ç å—å±•ç¤ºç®€å•æ¦‚å¿µ
âŒ å‚æ•°å®šä¹‰è¿‡äºå¤æ‚ï¼Œç”¨æˆ·éš¾ä»¥ç†è§£  
âŒ ç¼ºå°‘é”™è¯¯å¤„ç†ï¼Œç¨‹åºå®¹æ˜“å´©æºƒ
âŒ æ²¡æœ‰è¿›åº¦æç¤ºï¼Œç”¨æˆ·ä½“éªŒå·®
âŒ å¸®åŠ©æ–‡æ¡£ä¸æ¸…æ™°ï¼Œç”¨æˆ·ä¸çŸ¥é“æ€ä¹ˆç”¨

âœ… ç®€æ´æ˜äº†çš„å‚æ•°è®¾è®¡
âœ… å®Œå–„çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º
âœ… æ¸…æ™°çš„å¸®åŠ©æ–‡æ¡£å’Œç¤ºä¾‹
âœ… ç¾è§‚çš„è¾“å‡ºå’Œè¿›åº¦æç¤º
âœ… åˆç†çš„åŠŸèƒ½æ¨¡å—åˆ’åˆ†
```

### 10.4 å­¦ä¹ è·¯å¾„å»ºè®®


**ğŸš€ æ–°æ‰‹å­¦ä¹ è·¯çº¿**
```
Level ğŸŸ¢ å…¥é—¨ï¼ˆ1-2å¤©ï¼‰
â”œâ”€ ç†è§£CLIåº“çš„ä½œç”¨å’Œä»·å€¼
â”œâ”€ æŒæ¡ClickåŸºç¡€è£…é¥°å™¨
â”œâ”€ å­¦ä¼šåŸºç¡€å‚æ•°å®šä¹‰
â””â”€ å®ç°ç¬¬ä¸€ä¸ªç®€å•CLIå·¥å…·

Level ğŸŸ¡ è¿›é˜¶ï¼ˆ3-5å¤©ï¼‰  
â”œâ”€ æŒæ¡å‘½ä»¤ç»„å’ŒåµŒå¥—å‘½ä»¤
â”œâ”€ å­¦ä¼šå„ç§å‚æ•°ç±»å‹ä½¿ç”¨
â”œâ”€ ç†è§£ä¸Šä¸‹æ–‡ç®¡ç†æœºåˆ¶
â””â”€ æ·»åŠ å½©è‰²è¾“å‡ºå’Œè¿›åº¦æ¡

Level ğŸ”´ é«˜çº§ï¼ˆ1-2å‘¨ï¼‰
â”œâ”€ è®¾è®¡å¤æ‚çš„å¤šå‘½ä»¤å·¥å…·
â”œâ”€ å®ç°æ’ä»¶ç³»ç»Ÿ
â”œâ”€ æŒæ¡é”™è¯¯å¤„ç†å’Œæµ‹è¯•
â””â”€ ä¼˜åŒ–ç”¨æˆ·ä½“éªŒå’Œæ€§èƒ½
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
CLIå·¥å…·å¼€å‘å¾ˆç®€å•ï¼Œè£…é¥°å™¨è´´æ ‡ç­¾
å‚æ•°ç±»å‹è‡ªåŠ¨éªŒï¼Œä¸Šä¸‹æ–‡æ¥ä¼ ä¿¡æ¯
å½©è‰²è¾“å‡ºç”¨æˆ·çˆ±ï¼Œè¿›åº¦æ¡æ˜¾ç¤ºå¾ˆè´´å¿ƒ
æ¡†æ¶é€‰æ‹©çœ‹éœ€æ±‚ï¼ŒClickåŠŸèƒ½æœ€é½å…¨
```