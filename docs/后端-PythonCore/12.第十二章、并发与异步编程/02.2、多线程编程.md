---
title: 2ã€å¤šçº¿ç¨‹ç¼–ç¨‹
---
## ğŸ“š ç›®å½•

1. [å¤šçº¿ç¨‹ç¼–ç¨‹åŸºç¡€æ¦‚å¿µ](#1-å¤šçº¿ç¨‹ç¼–ç¨‹åŸºç¡€æ¦‚å¿µ)
2. [threadingæ¨¡å—è¯¦è§£](#2-threadingæ¨¡å—è¯¦è§£)
3. [Threadç±»ä½¿ç”¨è¯¦è§£](#3-Threadç±»ä½¿ç”¨è¯¦è§£)
4. [çº¿ç¨‹åˆ›å»ºä¸å¯åŠ¨](#4-çº¿ç¨‹åˆ›å»ºä¸å¯åŠ¨)
5. [çº¿ç¨‹åŒæ­¥æœºåˆ¶](#5-çº¿ç¨‹åŒæ­¥æœºåˆ¶)
6. [Lockäº’æ–¥é”](#6-Lockäº’æ–¥é”)
7. [RLockå¯é‡å…¥é”](#7-RLockå¯é‡å…¥é”)
8. [Conditionæ¡ä»¶å˜é‡](#8-Conditionæ¡ä»¶å˜é‡)
9. [Semaphoreä¿¡å·é‡](#9-Semaphoreä¿¡å·é‡)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”° å¤šçº¿ç¨‹ç¼–ç¨‹åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯å¤šçº¿ç¨‹ï¼Ÿ


**ç®€å•ç†è§£**ï¼š
```
ç°å®ç”Ÿæ´»ç±»æ¯”ï¼š
ä¸€ä¸ªé¤å…è€æ¿ï¼ˆç¨‹åºï¼‰å¯ä»¥ï¼š
1. è‡ªå·±ä¸€ä¸ªäººï¼šæ¥å®¢â†’åšèœâ†’æ”¶é“¶â†’æ‰“æ‰«ï¼ˆå•çº¿ç¨‹ï¼‰
2. æ‹›å‡ ä¸ªå‘˜å·¥ï¼šåŒæ—¶æ¥å®¢ã€åšèœã€æ”¶é“¶ã€æ‰“æ‰«ï¼ˆå¤šçº¿ç¨‹ï¼‰

å¤šçº¿ç¨‹å°±æ˜¯è®©ç¨‹åºèƒ½åŒæ—¶åšå¤šä»¶äº‹ï¼
```

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
- ğŸ”¸ **è¿›ç¨‹**ï¼šè¿è¡Œä¸­çš„ç¨‹åºï¼Œå°±åƒä¸€å®¶é¤å…
- ğŸ”¸ **çº¿ç¨‹**ï¼šè¿›ç¨‹å†…çš„æ‰§è¡Œå•å…ƒï¼Œå°±åƒé¤å…çš„å‘˜å·¥
- ğŸ”¸ **å¹¶å‘**ï¼šçœ‹èµ·æ¥åŒæ—¶åšå¤šä»¶äº‹ï¼ˆå®é™…ä¸Šå¿«é€Ÿåˆ‡æ¢ï¼‰
- ğŸ”¸ **å¹¶è¡Œ**ï¼šçœŸæ­£åŒæ—¶åšå¤šä»¶äº‹ï¼ˆå¤šæ ¸CPUï¼‰

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦å¤šçº¿ç¨‹ï¼Ÿ


| ä½¿ç”¨åœºæ™¯ | **å•çº¿ç¨‹é—®é¢˜** | **å¤šçº¿ç¨‹è§£å†³æ–¹æ¡ˆ** |
|---------|--------------|-------------------|
| ğŸŒ **ç½‘ç»œä¸‹è½½** | `ä¸‹è½½æ–‡ä»¶æ—¶ç¨‹åºå¡æ­»` | `ä¸€ä¸ªçº¿ç¨‹ä¸‹è½½ï¼Œä¸»çº¿ç¨‹ç»§ç»­å“åº”` |
| ğŸ’¾ **æ–‡ä»¶å¤„ç†** | `è¯»å–å¤§æ–‡ä»¶æ—¶ç•Œé¢å‡æ­»` | `åå°çº¿ç¨‹å¤„ç†ï¼Œç•Œé¢çº¿ç¨‹æ›´æ–°è¿›åº¦` |
| ğŸ® **æ¸¸æˆå¼€å‘** | `è®¡ç®—AIæ—¶æ¸¸æˆå¡é¡¿` | `AIçº¿ç¨‹è®¡ç®—ï¼Œæ¸²æŸ“çº¿ç¨‹ç»˜åˆ¶ç”»é¢` |
| ğŸ“Š **æ•°æ®å¤„ç†** | `å¤„ç†å¤§é‡æ•°æ®æ—¶æ— å“åº”` | `å¤šçº¿ç¨‹å¹¶è¡Œå¤„ç†ï¼Œæé«˜æ•ˆç‡` |

### 1.3 Pythonä¸­çš„çº¿ç¨‹ç‰¹ç‚¹


**é‡è¦è®¤çŸ¥**ï¼š
```
Pythonçš„GILï¼ˆå…¨å±€è§£é‡Šå™¨é”ï¼‰ç‰¹ç‚¹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒPythonä»£ç   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é€‚åˆï¼šI/Oå¯†é›†å‹ä»»åŠ¡ï¼ˆç½‘ç»œã€æ–‡ä»¶ï¼‰    â”‚
â”‚  ä¸é€‚åˆï¼šCPUå¯†é›†å‹ä»»åŠ¡ï¼ˆå¤§é‡è®¡ç®—ï¼‰   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é€šä¿—ç†è§£ï¼š
Pythonå¤šçº¿ç¨‹åƒæ˜¯"è½®æµä½¿ç”¨çš„å¨æˆ¿"
è™½ç„¶æœ‰å¤šä¸ªå¨å¸ˆï¼ˆçº¿ç¨‹ï¼‰ï¼Œä½†å¨æˆ¿ï¼ˆCPUï¼‰åŒæ—¶åªèƒ½è¿›ä¸€ä¸ªäºº
ä½†å½“ä¸€ä¸ªå¨å¸ˆç­‰å¾…é£Ÿæï¼ˆI/Oç­‰å¾…ï¼‰æ—¶ï¼Œå¦ä¸€ä¸ªå¨å¸ˆå¯ä»¥è¿›å»å·¥ä½œ
```

---

## 2. ğŸ“¦ threadingæ¨¡å—è¯¦è§£


### 2.1 threadingæ¨¡å—æ¦‚è¿°


**æ¨¡å—ä½œç”¨**ï¼šPythonæ ‡å‡†åº“ä¸­ä¸“é—¨ç”¨äºå¤šçº¿ç¨‹ç¼–ç¨‹çš„æ¨¡å—

**æ ¸å¿ƒç»„ä»¶**ï¼š
```
threadingæ¨¡å—ä¸»è¦ç»„ä»¶ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Thread     â”‚  çº¿ç¨‹ç±»ï¼ˆæ ¸å¿ƒï¼‰           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Lock       â”‚  äº’æ–¥é”ï¼ˆé˜²æ­¢å†²çªï¼‰       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   RLock      â”‚  å¯é‡å…¥é”ï¼ˆåŒä¸€çº¿ç¨‹å¯å¤šæ¬¡ï¼‰â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Condition    â”‚  æ¡ä»¶å˜é‡ï¼ˆç­‰å¾…æ¡ä»¶ï¼‰     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Semaphore    â”‚  ä¿¡å·é‡ï¼ˆæ§åˆ¶æ•°é‡ï¼‰       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Event      â”‚  äº‹ä»¶ï¼ˆç®€å•é€šçŸ¥æœºåˆ¶ï¼‰     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 åŸºæœ¬å¯¼å…¥å’Œä½¿ç”¨


```python
import threading
import time

# åŸºæœ¬ä¿¡æ¯æŸ¥çœ‹
print(f"å½“å‰æ´»è·ƒçº¿ç¨‹æ•°: {threading.active_count()}")
print(f"å½“å‰çº¿ç¨‹åç§°: {threading.current_thread().name}")
print(f"ä¸»çº¿ç¨‹å¯¹è±¡: {threading.main_thread()}")
```

**å¸¸ç”¨å‡½æ•°è¯´æ˜**ï¼š
- `threading.active_count()` - æŸ¥çœ‹å½“å‰æ´»è·ƒçš„çº¿ç¨‹æ•°é‡
- `threading.current_thread()` - è·å–å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹å¯¹è±¡
- `threading.main_thread()` - è·å–ä¸»çº¿ç¨‹å¯¹è±¡

---

## 3. ğŸ§µ Threadç±»ä½¿ç”¨è¯¦è§£


### 3.1 Threadç±»åŸºæœ¬æ¦‚å¿µ


**Threadç±»å°±åƒæ˜¯"å‘˜å·¥æ‹›è˜æ¨¡æ¿"**ï¼š
```
å®šä¹‰ä¸€ä¸ªçº¿ç¨‹å°±åƒæ‹›è˜ä¸€ä¸ªå‘˜å·¥ï¼š
1. ç¡®å®šå·¥ä½œå†…å®¹ï¼ˆtargetå‡½æ•°ï¼‰
2. æä¾›å·¥ä½œèµ„æ–™ï¼ˆargså‚æ•°ï¼‰
3. ç»™å‘˜å·¥èµ·åå­—ï¼ˆnameå‚æ•°ï¼‰
4. å¼€å§‹å·¥ä½œï¼ˆstartæ–¹æ³•ï¼‰
5. ç­‰å¾…å®Œæˆï¼ˆjoinæ–¹æ³•ï¼‰
```

### 3.2 Threadç±»æ ¸å¿ƒå‚æ•°


| å‚æ•° | **å«ä¹‰** | **ç¤ºä¾‹** |
|------|---------|----------|
| `target` | **è¦æ‰§è¡Œçš„å‡½æ•°** | `target=download_file` |
| `args` | **å‡½æ•°çš„å‚æ•°ï¼ˆå…ƒç»„ï¼‰** | `args=(url, filename)` |
| `kwargs` | **å‡½æ•°çš„å…³é”®å­—å‚æ•°** | `kwargs={'timeout': 30}` |
| `name` | **çº¿ç¨‹åç§°** | `name='ä¸‹è½½çº¿ç¨‹'` |
| `daemon` | **æ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹** | `daemon=True` |

### 3.3 åˆ›å»ºThreadå¯¹è±¡çš„æ–¹æ³•


**æ–¹æ³•ä¸€ï¼šç›´æ¥ä¼ å…¥å‡½æ•°**
```python
import threading
import time

def worker(name, delay):
    """å·¥ä½œå‡½æ•° - æ¨¡æ‹Ÿè€—æ—¶ä»»åŠ¡"""
    print(f"çº¿ç¨‹ {name} å¼€å§‹å·¥ä½œ")
    time.sleep(delay)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
    print(f"çº¿ç¨‹ {name} å·¥ä½œå®Œæˆ")

# åˆ›å»ºçº¿ç¨‹
thread1 = threading.Thread(
    target=worker,           # è¦æ‰§è¡Œçš„å‡½æ•°
    args=("å·¥äºº1", 2),       # å‡½æ•°å‚æ•°
    name="WorkerThread1"     # çº¿ç¨‹åç§°
)
```

**æ–¹æ³•äºŒï¼šç»§æ‰¿Threadç±»**
```python
class WorkerThread(threading.Thread):
    def __init__(self, name, delay):
        super().__init__()
        self.worker_name = name
        self.delay = delay
        self.name = f"Thread-{name}"  # è®¾ç½®çº¿ç¨‹å
    
    def run(self):
        """é‡å†™runæ–¹æ³• - å®šä¹‰çº¿ç¨‹è¦æ‰§è¡Œçš„ä»»åŠ¡"""
        print(f"çº¿ç¨‹ {self.worker_name} å¼€å§‹å·¥ä½œ")
        time.sleep(self.delay)
        print(f"çº¿ç¨‹ {self.worker_name} å·¥ä½œå®Œæˆ")

# åˆ›å»ºçº¿ç¨‹
thread2 = WorkerThread("å·¥äºº2", 3)
```

---

## 4. ğŸš€ çº¿ç¨‹åˆ›å»ºä¸å¯åŠ¨


### 4.1 çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ


```
çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸå›¾ç¤ºï¼š
åˆ›å»º â†’ å°±ç»ª â†’ è¿è¡Œ â†’ é˜»å¡ â†’ ç»ˆæ­¢
 â†“      â†“      â†“      â†“      â†“
New   Ready  Running Blocked Terminated
 â”‚      â”‚      â”‚       â”‚       â”‚
åˆ›å»º   ç­‰å¾…    æ‰§è¡Œ    ç­‰å¾…     å®Œæˆ
å¯¹è±¡   è°ƒåº¦    ä»£ç     èµ„æº     é”€æ¯
```

### 4.2 å¯åŠ¨çº¿ç¨‹çš„å®Œæ•´ç¤ºä¾‹


```python
import threading
import time

def download_task(filename, size):
    """æ¨¡æ‹Ÿæ–‡ä»¶ä¸‹è½½ä»»åŠ¡"""
    print(f"ğŸ”„ å¼€å§‹ä¸‹è½½ {filename} (å¤§å°: {size}MB)")
    
    # æ¨¡æ‹Ÿä¸‹è½½è¿‡ç¨‹
    for i in range(1, 6):
        time.sleep(0.5)  # æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
        progress = i * 20
        print(f"ğŸ“¥ {filename} ä¸‹è½½è¿›åº¦: {progress}%")
    
    print(f"âœ… {filename} ä¸‹è½½å®Œæˆï¼")

def main():
    print("ğŸ¯ å¼€å§‹å¤šçº¿ç¨‹ä¸‹è½½ä»»åŠ¡")
    
    # åˆ›å»ºå¤šä¸ªä¸‹è½½çº¿ç¨‹
    files = [
        ("è§†é¢‘.mp4", 100),
        ("éŸ³ä¹.mp3", 50),
        ("æ–‡æ¡£.pdf", 20)
    ]
    
    threads = []
    
    # åˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹
    for filename, size in files:
        thread = threading.Thread(
            target=download_task,
            args=(filename, size),
            name=f"Download-{filename}"
        )
        threads.append(thread)
        thread.start()  # å¯åŠ¨çº¿ç¨‹
        print(f"ğŸš€ å¯åŠ¨çº¿ç¨‹: {thread.name}")
    
    # ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ
    for thread in threads:
        thread.join()  # ç­‰å¾…çº¿ç¨‹ç»“æŸ
        print(f"ğŸ çº¿ç¨‹ {thread.name} å·²å®Œæˆ")
    
    print("ğŸ‰ æ‰€æœ‰ä¸‹è½½ä»»åŠ¡å®Œæˆï¼")

if __name__ == "__main__":
    main()
```

### 4.3 å…³é”®æ–¹æ³•è¯¦è§£


**ğŸ”¸ start() æ–¹æ³•**
- **ä½œç”¨**ï¼šå¯åŠ¨çº¿ç¨‹ï¼Œå¼€å§‹æ‰§è¡Œrunæ–¹æ³•
- **æ³¨æ„**ï¼šä¸€ä¸ªçº¿ç¨‹å¯¹è±¡åªèƒ½è°ƒç”¨ä¸€æ¬¡start()

**ğŸ”¸ join() æ–¹æ³•**
- **ä½œç”¨**ï¼šç­‰å¾…çº¿ç¨‹æ‰§è¡Œå®Œæˆ
- **å‚æ•°**ï¼š`timeout`è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
- **è¿”å›**ï¼šè¶…æ—¶è¿”å›Noneï¼Œæ­£å¸¸å®Œæˆè¿”å›çº¿ç¨‹å¯¹è±¡

```python
# joinæ–¹æ³•çš„ä½¿ç”¨
thread.join()        # æ— é™ç­‰å¾…ç›´åˆ°çº¿ç¨‹å®Œæˆ
thread.join(5)       # æœ€å¤šç­‰å¾…5ç§’
if thread.is_alive():
    print("çº¿ç¨‹ä»åœ¨è¿è¡Œ")
```

---

## 5. ğŸ”„ çº¿ç¨‹åŒæ­¥æœºåˆ¶


### 5.1 ä¸ºä»€ä¹ˆéœ€è¦çº¿ç¨‹åŒæ­¥ï¼Ÿ


**é—®é¢˜åœºæ™¯**ï¼š
```
é“¶è¡Œå–æ¬¾é—®é¢˜ï¼š
è´¦æˆ·ä½™é¢: 1000å…ƒ

çº¿ç¨‹Aï¼ˆè€å©†ï¼‰: å–500å…ƒ
1. è¯»å–ä½™é¢: 1000
2. è®¡ç®—: 1000 - 500 = 500
3. å†™å…¥ä½™é¢: 500

çº¿ç¨‹Bï¼ˆè€å…¬ï¼‰: å–600å…ƒ  
1. è¯»å–ä½™é¢: 1000  â† åœ¨Aå†™å…¥ä¹‹å‰è¯»å–ï¼
2. è®¡ç®—: 1000 - 600 = 400
3. å†™å…¥ä½™é¢: 400

ç»“æœï¼šè´¦æˆ·è¿˜æœ‰400å…ƒï¼Œä½†å®é™…å–äº†1100å…ƒï¼
```

**é—®é¢˜æœ¬è´¨**ï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å…±äº«èµ„æºå¯¼è‡´æ•°æ®æ··ä¹±

### 5.2 çº¿ç¨‹åŒæ­¥æœºåˆ¶æ¦‚è§ˆ


| åŒæ­¥æœºåˆ¶ | **é€‚ç”¨åœºæ™¯** | **ç‰¹ç‚¹** |
|---------|-------------|----------|
| ğŸ”’ **Lock** | `ä¿æŠ¤å…±äº«èµ„æºï¼Œç¡®ä¿åŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®` | `ç®€å•ç›´æ¥ï¼Œé˜²æ­¢æ•°æ®ç«äº‰` |
| ğŸ”„ **RLock** | `åŒä¸€çº¿ç¨‹éœ€è¦å¤šæ¬¡è·å–é”` | `å¯é‡å…¥ï¼Œé¿å…æ­»é”` |
| â° **Condition** | `çº¿ç¨‹éœ€è¦ç­‰å¾…ç‰¹å®šæ¡ä»¶` | `ç­‰å¾…/é€šçŸ¥æœºåˆ¶` |
| ğŸ« **Semaphore** | `é™åˆ¶åŒæ—¶è®¿é—®èµ„æºçš„çº¿ç¨‹æ•°é‡` | `èµ„æºæ± ç®¡ç†` |
| ğŸ“£ **Event** | `ç®€å•çš„çº¿ç¨‹é—´é€šä¿¡` | `å¼€å…³å¼ä¿¡å·` |

---

## 6. ğŸ”’ Lockäº’æ–¥é”


### 6.1 Lockçš„åŸºæœ¬æ¦‚å¿µ


**Lockå°±åƒå«ç”Ÿé—´çš„é—¨é”**ï¼š
```
ğŸšª å«ç”Ÿé—´é—¨é”è§„åˆ™ï¼š
1. è¿›å»æ—¶é”é—¨ï¼ˆacquireï¼‰
2. å‡ºæ¥æ—¶å¼€é”ï¼ˆreleaseï¼‰
3. å¤–é¢çš„äººç­‰å¾…ï¼ˆé˜»å¡ï¼‰
4. é‡Œé¢çš„äººç”¨å®Œå¼€é”ï¼Œå¤–é¢çš„äººæ‰èƒ½è¿›

Lockäº’æ–¥é”è§„åˆ™ï¼š
1. çº¿ç¨‹è·å–é”ï¼ˆacquireï¼‰
2. æ‰§è¡Œä¸´ç•ŒåŒºä»£ç 
3. é‡Šæ”¾é”ï¼ˆreleaseï¼‰
4. å…¶ä»–çº¿ç¨‹ç­‰å¾…é”å¯ç”¨
```

### 6.2 Lockçš„åŸºæœ¬ä½¿ç”¨


```python
import threading
import time

# åˆ›å»ºé”å¯¹è±¡
lock = threading.Lock()
shared_counter = 0  # å…±äº«å˜é‡

def increment_counter(name):
    """å®‰å…¨åœ°å¢åŠ è®¡æ•°å™¨"""
    global shared_counter
    
    for i in range(5):
        # è·å–é”
        lock.acquire()
        try:
            # ä¸´ç•ŒåŒº - åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‰§è¡Œ
            current = shared_counter
            print(f"çº¿ç¨‹{name}: è¯»å–å€¼ {current}")
            time.sleep(0.1)  # æ¨¡æ‹Ÿå¤„ç†æ—¶é—´
            shared_counter = current + 1
            print(f"çº¿ç¨‹{name}: æ›´æ–°å€¼ {shared_counter}")
        finally:
            # ç¡®ä¿é”è¢«é‡Šæ”¾
            lock.release()
        
        time.sleep(0.1)  # å…¶ä»–æ“ä½œ

def main():
    threads = []
    
    # åˆ›å»ºå¤šä¸ªçº¿ç¨‹
    for i in range(3):
        thread = threading.Thread(
            target=increment_counter,
            args=(f"T{i+1}",)
        )
        threads.append(thread)
        thread.start()
    
    # ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ
    for thread in threads:
        thread.join()
    
    print(f"æœ€ç»ˆè®¡æ•°å™¨å€¼: {shared_counter}")

if __name__ == "__main__":
    main()
```

### 6.3 withè¯­å¥ä¼˜é›…ä½¿ç”¨Lock


```python
import threading

lock = threading.Lock()
shared_resource = []

def safe_operation(name, data):
    """ä½¿ç”¨withè¯­å¥è‡ªåŠ¨ç®¡ç†é”"""
    with lock:  # è‡ªåŠ¨è·å–é”
        # ä¸´ç•ŒåŒºä»£ç 
        print(f"çº¿ç¨‹{name}: å¼€å§‹æ“ä½œ")
        shared_resource.append(data)
        time.sleep(0.1)
        print(f"çº¿ç¨‹{name}: æ“ä½œå®Œæˆï¼Œå½“å‰æ•°æ®: {shared_resource}")
    # è‡ªåŠ¨é‡Šæ”¾é”

# withè¯­å¥çš„ä¼˜åŠ¿ï¼š
# 1. è‡ªåŠ¨è·å–å’Œé‡Šæ”¾é”
# 2. å³ä½¿å‘ç”Ÿå¼‚å¸¸ä¹Ÿä¼šé‡Šæ”¾é”
# 3. ä»£ç æ›´ç®€æ´æ˜“è¯»
```

### 6.4 Lockä½¿ç”¨æ³¨æ„äº‹é¡¹


**âš ï¸ å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ**ï¼š

```python
# âŒ é”™è¯¯ï¼šå¿˜è®°é‡Šæ”¾é”
def bad_example():
    lock.acquire()
    # å¦‚æœè¿™é‡Œå‘ç”Ÿå¼‚å¸¸ï¼Œé”æ°¸è¿œä¸ä¼šè¢«é‡Šæ”¾
    risky_operation()
    lock.release()  # å¯èƒ½æ°¸è¿œæ‰§è¡Œä¸åˆ°

# âœ… æ­£ç¡®ï¼šä½¿ç”¨try-finallyæˆ–withè¯­å¥
def good_example():
    with lock:  # æ¨èæ–¹å¼
        risky_operation()
    
    # æˆ–è€…
    lock.acquire()
    try:
        risky_operation()
    finally:
        lock.release()
```

---

## 7. ğŸ”„ RLockå¯é‡å…¥é”


### 7.1 RLock vs Lockçš„åŒºåˆ«


**é—®é¢˜åœºæ™¯**ï¼š
```
æ™®é€šLockçš„é—®é¢˜ï¼š
class Counter:
    def __init__(self):
        self.lock = threading.Lock()
        self.value = 0
    
    def increment(self):
        with self.lock:
            self.value += 1
    
    def increment_twice(self):
        with self.lock:  # è·å–é”
            self.increment()  # âŒ æ­»é”ï¼è¿™é‡Œåˆè¦è·å–åŒä¸€æŠŠé”
            self.increment()

åŒä¸€ä¸ªçº¿ç¨‹ä¸èƒ½é‡å¤è·å–æ™®é€šé”ï¼
```

### 7.2 RLockè§£å†³é‡å…¥é—®é¢˜


```python
import threading
import time

class SafeCounter:
    def __init__(self):
        self.rlock = threading.RLock()  # ä½¿ç”¨å¯é‡å…¥é”
        self.value = 0
    
    def increment(self):
        """å•æ¬¡å¢åŠ """
        with self.rlock:
            current = self.value
            print(f"  ğŸ“ è¯»å–å½“å‰å€¼: {current}")
            time.sleep(0.1)  # æ¨¡æ‹Ÿå¤„ç†æ—¶é—´
            self.value = current + 1
            print(f"  âœ… å¢åŠ åå€¼: {self.value}")
    
    def increment_twice(self):
        """ä¸¤æ¬¡å¢åŠ  - æ¼”ç¤ºé‡å…¥ç‰¹æ€§"""
        with self.rlock:  # ç¬¬ä¸€æ¬¡è·å–é”
            print("ğŸ”„ å¼€å§‹ä¸¤æ¬¡å¢åŠ æ“ä½œ")
            self.increment()  # âœ… å¯ä»¥å†æ¬¡è·å–é”ï¼ˆé‡å…¥ï¼‰
            self.increment()  # âœ… å¯ä»¥å†æ¬¡è·å–é”ï¼ˆé‡å…¥ï¼‰
            print("ğŸ‰ ä¸¤æ¬¡å¢åŠ æ“ä½œå®Œæˆ")
    
    def get_value(self):
        with self.rlock:
            return self.value

def worker_thread(counter, name):
    """å·¥ä½œçº¿ç¨‹"""
    print(f"ğŸš€ çº¿ç¨‹{name}å¼€å§‹å·¥ä½œ")
    counter.increment_twice()
    print(f"ğŸ çº¿ç¨‹{name}å®Œæˆï¼Œå½“å‰å€¼: {counter.get_value()}")

def main():
    counter = SafeCounter()
    threads = []
    
    # åˆ›å»ºå¤šä¸ªçº¿ç¨‹æµ‹è¯•
    for i in range(3):
        thread = threading.Thread(
            target=worker_thread,
            args=(counter, f"T{i+1}")
        )
        threads.append(thread)
        thread.start()
    
    # ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ
    for thread in threads:
        thread.join()
    
    print(f"ğŸ¯ æœ€ç»ˆè®¡æ•°å™¨å€¼: {counter.get_value()}")

if __name__ == "__main__":
    main()
```

### 7.3 RLockçš„å·¥ä½œåŸç†


```
RLockå†…éƒ¨æœºåˆ¶ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é”æŒæœ‰è€…: Thread-1              â”‚
â”‚ é‡å…¥æ¬¡æ•°: 3                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ acquire() â†’ è®¡æ•°+1              â”‚
â”‚ release() â†’ è®¡æ•°-1              â”‚
â”‚ è®¡æ•°ä¸º0æ—¶ â†’ é”è¢«é‡Šæ”¾             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åŒä¸€çº¿ç¨‹å¯ä»¥å¤šæ¬¡è·å–ï¼Œä½†å¿…é¡»å¯¹åº”é‡Šæ”¾ï¼š
Thread-1: acquire() â†’ è®¡æ•°=1
Thread-1: acquire() â†’ è®¡æ•°=2
Thread-1: acquire() â†’ è®¡æ•°=3
Thread-1: release() â†’ è®¡æ•°=2
Thread-1: release() â†’ è®¡æ•°=1
Thread-1: release() â†’ è®¡æ•°=0 (é”è¢«é‡Šæ”¾)
```

---

## 8. â° Conditionæ¡ä»¶å˜é‡


### 8.1 Conditionçš„åº”ç”¨åœºæ™¯


**ç”Ÿæ´»ç±»æ¯”**ï¼š
```
é¤å…åœºæ™¯ï¼š
ğŸ‘¨â€ğŸ³ å¨å¸ˆï¼šåšå¥½èœåé€šçŸ¥æœåŠ¡å‘˜
ğŸ‘©â€ğŸ’¼ æœåŠ¡å‘˜ï¼šç­‰å¾…å¨å¸ˆå®Œæˆèœå“

ç¨‹åºåœºæ™¯ï¼š
ğŸ“¦ ç”Ÿäº§è€…ï¼šç”Ÿäº§æ•°æ®åé€šçŸ¥æ¶ˆè´¹è€…
ğŸ›ï¸ æ¶ˆè´¹è€…ï¼šç­‰å¾…ç”Ÿäº§è€…ç”Ÿäº§æ•°æ®

Conditionå°±æ˜¯è¿™ç§"ç­‰å¾…-é€šçŸ¥"æœºåˆ¶ï¼
```

### 8.2 ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ç¤ºä¾‹


```python
import threading
import time
import random
from collections import deque

class RestaurantBuffer:
    """é¤å…ç¼“å†²åŒº - å­˜æ”¾åšå¥½çš„èœå“"""
    
    def __init__(self, max_size=5):
        self.buffer = deque()
        self.max_size = max_size
        self.condition = threading.Condition()
    
    def produce_dish(self, dish_name):
        """å¨å¸ˆåšèœï¼ˆç”Ÿäº§è€…ï¼‰"""
        with self.condition:
            # ç­‰å¾…æœ‰ç©ºé—´
            while len(self.buffer) >= self.max_size:
                print(f"ğŸ½ï¸ ç¼“å†²åŒºæ»¡äº†ï¼Œå¨å¸ˆç­‰å¾…...")
                self.condition.wait()  # ç­‰å¾…æ¶ˆè´¹è€…å–èµ°èœå“
            
            # åšèœ
            self.buffer.append(dish_name)
            print(f"ğŸ‘¨â€ğŸ³ å¨å¸ˆåšå¥½äº†: {dish_name}ï¼Œå½“å‰èœå“æ•°: {len(self.buffer)}")
            
            # é€šçŸ¥æœåŠ¡å‘˜
            self.condition.notify()  # å”¤é†’ç­‰å¾…çš„æ¶ˆè´¹è€…
    
    def consume_dish(self):
        """æœåŠ¡å‘˜ä¸Šèœï¼ˆæ¶ˆè´¹è€…ï¼‰"""
        with self.condition:
            # ç­‰å¾…æœ‰èœå“
            while len(self.buffer) == 0:
                print(f"ğŸ¥˜ æ²¡æœ‰èœå“ï¼ŒæœåŠ¡å‘˜ç­‰å¾…...")
                self.condition.wait()  # ç­‰å¾…ç”Ÿäº§è€…åšèœ
            
            # å–èœ
            dish = self.buffer.popleft()
            print(f"ğŸ‘©â€ğŸ’¼ æœåŠ¡å‘˜ä¸Šèœ: {dish}ï¼Œå‰©ä½™èœå“æ•°: {len(self.buffer)}")
            
            # é€šçŸ¥å¨å¸ˆ
            self.condition.notify()  # å”¤é†’ç­‰å¾…çš„ç”Ÿäº§è€…
            return dish

def chef_worker(restaurant, chef_name):
    """å¨å¸ˆçº¿ç¨‹"""
    dishes = ["çº¢çƒ§è‚‰", "ç³–é†‹é±¼", "å®«ä¿é¸¡ä¸", "éº»å©†è±†è…", "å›é”…è‚‰"]
    
    for i in range(3):
        dish = f"{random.choice(dishes)}-{chef_name}"
        restaurant.produce_dish(dish)
        time.sleep(random.uniform(0.5, 1.5))  # åšèœæ—¶é—´

def waiter_worker(restaurant, waiter_name):
    """æœåŠ¡å‘˜çº¿ç¨‹"""
    for i in range(3):
        dish = restaurant.consume_dish()
        print(f"  ğŸ½ï¸ {waiter_name}å°†{dish}é€åˆ°å®¢äººæ¡Œä¸Š")
        time.sleep(random.uniform(0.3, 1.0))  # ä¸Šèœæ—¶é—´

def main():
    restaurant = RestaurantBuffer(max_size=3)
    threads = []
    
    # åˆ›å»ºå¨å¸ˆçº¿ç¨‹
    for i in range(2):
        chef = threading.Thread(
            target=chef_worker,
            args=(restaurant, f"å¨å¸ˆ{i+1}")
        )
        threads.append(chef)
        chef.start()
    
    # åˆ›å»ºæœåŠ¡å‘˜çº¿ç¨‹
    for i in range(2):
        waiter = threading.Thread(
            target=waiter_worker,
            args=(restaurant, f"æœåŠ¡å‘˜{i+1}")
        )
        threads.append(waiter)
        waiter.start()
    
    # ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ
    for thread in threads:
        thread.join()
    
    print("ğŸ‰ é¤å…è¥ä¸šç»“æŸï¼")

if __name__ == "__main__":
    main()
```

### 8.3 Conditionçš„å…³é”®æ–¹æ³•


| æ–¹æ³• | **ä½œç”¨** | **è¯´æ˜** |
|------|---------|----------|
| `wait()` | **ç­‰å¾…æ¡ä»¶** | `é‡Šæ”¾é”å¹¶ç­‰å¾…ï¼Œè¢«å”¤é†’åé‡æ–°è·å–é”` |
| `notify()` | **å”¤é†’ä¸€ä¸ªçº¿ç¨‹** | `å”¤é†’ä¸€ä¸ªç­‰å¾…çš„çº¿ç¨‹` |
| `notify_all()` | **å”¤é†’æ‰€æœ‰çº¿ç¨‹** | `å”¤é†’æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹` |

**âš ï¸ ä½¿ç”¨æ³¨æ„äº‹é¡¹**ï¼š
```python
# âœ… æ­£ç¡®ç”¨æ³•ï¼šåœ¨å¾ªç¯ä¸­æ£€æŸ¥æ¡ä»¶
while not condition_met:
    condition.wait()

# âŒ é”™è¯¯ç”¨æ³•ï¼šç›´æ¥waitå¯èƒ½å¯¼è‡´è™šå‡å”¤é†’
if not condition_met:
    condition.wait()  # å¯èƒ½è¢«è™šå‡å”¤é†’
```

---

## 9. ğŸ« Semaphoreä¿¡å·é‡


### 9.1 Semaphoreçš„åŸºæœ¬æ¦‚å¿µ


**ç”Ÿæ´»ç±»æ¯”**ï¼š
```
åœè½¦åœºç®¡ç†ï¼š
ğŸ…¿ï¸ åœè½¦åœºæœ‰10ä¸ªè½¦ä½ï¼ˆä¿¡å·é‡å€¼=10ï¼‰
ğŸš— æ¯æ¥ä¸€è¾†è½¦ï¼šè½¦ä½-1ï¼ˆacquireï¼‰
ğŸš— æ¯èµ°ä¸€è¾†è½¦ï¼šè½¦ä½+1ï¼ˆreleaseï¼‰
ğŸš« è½¦ä½æ»¡äº†ï¼šæ–°è½¦ç­‰å¾…ï¼ˆé˜»å¡ï¼‰

ç¨‹åºä¸­çš„èµ„æºæ± ç®¡ç†ï¼š
ğŸ’¾ æ•°æ®åº“è¿æ¥æ± ï¼šåŒæ—¶æœ€å¤š20ä¸ªè¿æ¥
ğŸŒ ç½‘ç»œè¯·æ±‚ï¼šåŒæ—¶æœ€å¤š5ä¸ªå¹¶å‘è¯·æ±‚
ğŸ“„ æ–‡ä»¶å¥æŸ„ï¼šåŒæ—¶æœ€å¤šæ‰“å¼€100ä¸ªæ–‡ä»¶
```

### 9.2 ä¿¡å·é‡æ§åˆ¶å¹¶å‘æ•°é‡


```python
import threading
import time
import random

class DownloadManager:
    """ä¸‹è½½ç®¡ç†å™¨ - æ§åˆ¶åŒæ—¶ä¸‹è½½çš„æ•°é‡"""
    
    def __init__(self, max_concurrent=3):
        # åˆ›å»ºä¿¡å·é‡ï¼Œæœ€å¤šå…è®¸3ä¸ªåŒæ—¶ä¸‹è½½
        self.semaphore = threading.Semaphore(max_concurrent)
        self.download_count = 0
        self.lock = threading.Lock()
    
    def download_file(self, filename, size):
        """ä¸‹è½½æ–‡ä»¶"""
        # è·å–ä¸‹è½½èµ„æº
        print(f"â³ {filename} ç­‰å¾…ä¸‹è½½èµ„æº...")
        self.semaphore.acquire()
        
        try:
            # æ›´æ–°ä¸‹è½½è®¡æ•°
            with self.lock:
                self.download_count += 1
                active_downloads = self.download_count
            
            print(f"ğŸš€ å¼€å§‹ä¸‹è½½ {filename} (å½“å‰å¹¶å‘: {active_downloads})")
            
            # æ¨¡æ‹Ÿä¸‹è½½è¿‡ç¨‹
            download_time = random.uniform(2, 5)
            for i in range(5):
                time.sleep(download_time / 5)
                progress = (i + 1) * 20
                print(f"ğŸ“¥ {filename}: {progress}% å®Œæˆ")
            
            print(f"âœ… {filename} ä¸‹è½½å®Œæˆï¼")
            
        finally:
            # é‡Šæ”¾ä¸‹è½½èµ„æº
            with self.lock:
                self.download_count -= 1
            self.semaphore.release()
            print(f"ğŸ”„ {filename} é‡Šæ”¾ä¸‹è½½èµ„æº")

def download_worker(manager, filename, size):
    """ä¸‹è½½å·¥ä½œçº¿ç¨‹"""
    manager.download_file(filename, size)

def main():
    # åˆ›å»ºä¸‹è½½ç®¡ç†å™¨ï¼ˆæœ€å¤š3ä¸ªå¹¶å‘ä¸‹è½½ï¼‰
    manager = DownloadManager(max_concurrent=3)
    
    # æ¨¡æ‹Ÿå¤šä¸ªä¸‹è½½ä»»åŠ¡
    files = [
        ("ç”µå½±1.mp4", 1024),
        ("ç”µå½±2.mp4", 2048),
        ("éŸ³ä¹1.mp3", 128),
        ("éŸ³ä¹2.mp3", 256),
        ("æ–‡æ¡£1.pdf", 64),
        ("å›¾ç‰‡1.jpg", 32),
        ("è½¯ä»¶1.exe", 512),
        ("æ¸¸æˆ1.zip", 4096)
    ]
    
    threads = []
    print(f"ğŸ¯ å¼€å§‹æ‰¹é‡ä¸‹è½½ä»»åŠ¡ï¼ˆæœ€å¤§å¹¶å‘æ•°: 3ï¼‰")
    
    # åˆ›å»ºä¸‹è½½çº¿ç¨‹
    for filename, size in files:
        thread = threading.Thread(
            target=download_worker,
            args=(manager, filename, size)
        )
        threads.append(thread)
        thread.start()
        time.sleep(0.2)  # ç¨å¾®é”™å¼€å¯åŠ¨æ—¶é—´
    
    # ç­‰å¾…æ‰€æœ‰ä¸‹è½½å®Œæˆ
    for thread in threads:
        thread.join()
    
    print("ğŸ‰ æ‰€æœ‰ä¸‹è½½ä»»åŠ¡å®Œæˆï¼")

if __name__ == "__main__":
    main()
```

### 9.3 Semaphore vs Lockçš„åŒºåˆ«


| å¯¹æ¯”é¡¹ | **Lockäº’æ–¥é”** | **Semaphoreä¿¡å·é‡** |
|-------|---------------|-------------------|
| ğŸ”¢ **å…è®¸çº¿ç¨‹æ•°** | `1ä¸ª` | `Nä¸ªï¼ˆå¯é…ç½®ï¼‰` |
| ğŸ¯ **ä½¿ç”¨åœºæ™¯** | `ä¿æŠ¤å…±äº«èµ„æºï¼Œç¡®ä¿ç‹¬å è®¿é—®` | `æ§åˆ¶èµ„æºæ± ï¼Œé™åˆ¶å¹¶å‘æ•°é‡` |
| ğŸ”’ **è·å–æ–¹å¼** | `acquire()ä¸€æ¬¡` | `acquire()å‡å°‘è®¡æ•°` |
| ğŸ”“ **é‡Šæ”¾æ–¹å¼** | `release()ä¸€æ¬¡` | `release()å¢åŠ è®¡æ•°` |
| ğŸ“ **å…¸å‹åº”ç”¨** | `æ•°æ®ç»“æ„ä¿æŠ¤` | `è¿æ¥æ± ã€ä¸‹è½½é™åˆ¶` |

```python
# Lockç¤ºä¾‹ï¼šç¡®ä¿åªæœ‰ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹æ•°æ®
lock = threading.Lock()
with lock:
    shared_data += 1  # åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‰§è¡Œ

# Semaphoreç¤ºä¾‹ï¼šå…è®¸æœ€å¤š3ä¸ªçº¿ç¨‹åŒæ—¶å·¥ä½œ
semaphore = threading.Semaphore(3)
with semaphore:
    do_some_work()  # æœ€å¤š3ä¸ªçº¿ç¨‹èƒ½åŒæ—¶æ‰§è¡Œ
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å¤šçº¿ç¨‹æœ¬è´¨ï¼šè®©ç¨‹åºèƒ½åŒæ—¶åšå¤šä»¶äº‹ï¼Œæé«˜æ•ˆç‡
ğŸ”¸ GILé™åˆ¶ï¼šPythonåŒæ—¶åªæ‰§è¡Œä¸€ä¸ªçº¿ç¨‹ï¼Œé€‚åˆI/Oå¯†é›†å‹ä»»åŠ¡
ğŸ”¸ Threadç±»ï¼šåˆ›å»ºå’Œç®¡ç†çº¿ç¨‹çš„æ ¸å¿ƒå·¥å…·
ğŸ”¸ çº¿ç¨‹åŒæ­¥ï¼šé˜²æ­¢å¤šçº¿ç¨‹è®¿é—®å…±äº«èµ„æºæ—¶å‡ºç°æ•°æ®æ··ä¹±
ğŸ”¸ é”æœºåˆ¶ï¼šæ§åˆ¶çº¿ç¨‹è®¿é—®å…±äº«èµ„æºçš„é¡ºåºå’Œæ•°é‡
```

### 10.2 å„ç§é”çš„é€‰æ‹©æŒ‡å—


**ğŸ”¹ é€‰æ‹©å†³ç­–æ ‘**ï¼š
```
éœ€è¦çº¿ç¨‹åŒæ­¥ï¼Ÿ
â”œâ”€ æ˜¯ â†’ ç»§ç»­é€‰æ‹©é”ç±»å‹
â””â”€ å¦ â†’ ç›´æ¥ä½¿ç”¨Thread

ä¿æŠ¤å…±äº«èµ„æºï¼Ÿ
â”œâ”€ æ˜¯ â†’ ä½¿ç”¨Lockæˆ–RLock
â””â”€ å¦ â†’ è€ƒè™‘å…¶ä»–åŒæ­¥æœºåˆ¶

åŒä¸€çº¿ç¨‹éœ€è¦é‡å¤è·å–é”ï¼Ÿ
â”œâ”€ æ˜¯ â†’ ä½¿ç”¨RLock
â””â”€ å¦ â†’ ä½¿ç”¨Lock

éœ€è¦ç­‰å¾…ç‰¹å®šæ¡ä»¶ï¼Ÿ
â”œâ”€ æ˜¯ â†’ ä½¿ç”¨Condition
â””â”€ å¦ â†’ ç»§ç»­

éœ€è¦é™åˆ¶å¹¶å‘æ•°é‡ï¼Ÿ
â”œâ”€ æ˜¯ â†’ ä½¿ç”¨Semaphore
â””â”€ å¦ â†’ ä½¿ç”¨Eventæˆ–å…¶ä»–æœºåˆ¶
```

### 10.3 å®é™…åº”ç”¨åœºæ™¯æ€»ç»“


| åº”ç”¨åœºæ™¯ | **æ¨èæ–¹æ¡ˆ** | **æ ¸å¿ƒä»£ç ** |
|---------|-------------|-------------|
| ğŸŒ **ç½‘ç»œçˆ¬è™«** | `å¤šçº¿ç¨‹ + ä¿¡å·é‡` | `Semaphore(10)` |
| ğŸ“¥ **æ–‡ä»¶ä¸‹è½½** | `å¤šçº¿ç¨‹ + è¿›åº¦æ›´æ–°` | `Thread + Lock` |
| ğŸ® **æ¸¸æˆå¼€å‘** | `ä¸»çº¿ç¨‹ + åå°çº¿ç¨‹` | `Thread + Event` |
| ğŸ“Š **æ•°æ®å¤„ç†** | `ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼` | `Condition + Queue` |
| ğŸ’¾ **èµ„æºæ± ç®¡ç†** | `ä¿¡å·é‡æ§åˆ¶` | `Semaphore(pool_size)` |

### 10.4 æœ€ä½³å®è·µå’Œæ³¨æ„äº‹é¡¹


**âœ… æ¨èåšæ³•**ï¼š
- ä½¿ç”¨`with`è¯­å¥ç®¡ç†é”ï¼Œç¡®ä¿è‡ªåŠ¨é‡Šæ”¾
- åˆç†è®¾ç½®çº¿ç¨‹æ•°é‡ï¼Œé¿å…è¿‡å¤šçº¿ç¨‹é™ä½æ€§èƒ½
- ä½¿ç”¨`join()`ç­‰å¾…çº¿ç¨‹å®Œæˆï¼Œç¡®ä¿ç¨‹åºæ­£ç¡®ç»“æŸ
- ä¸ºçº¿ç¨‹è®¾ç½®æœ‰æ„ä¹‰çš„åç§°ï¼Œä¾¿äºè°ƒè¯•

**âš ï¸ å¸¸è§é™·é˜±**ï¼š
- å¿˜è®°é‡Šæ”¾é”å¯¼è‡´æ­»é”
- è¿‡åº¦ä½¿ç”¨é”å½±å“å¹¶å‘æ€§èƒ½
- GILé™åˆ¶ä¸‹CPUå¯†é›†å‹ä»»åŠ¡æ•ˆæœä¸ä½³
- çº¿ç¨‹å¼‚å¸¸æœªå¤„ç†å½±å“ç¨‹åºç¨³å®šæ€§

**ğŸ¯ æ€§èƒ½ä¼˜åŒ–å»ºè®®**ï¼š
- I/Oå¯†é›†å‹ä»»åŠ¡ä½¿ç”¨å¤šçº¿ç¨‹
- CPUå¯†é›†å‹ä»»åŠ¡è€ƒè™‘å¤šè¿›ç¨‹
- åˆç†è®¾ç½®ä¿¡å·é‡æ•°é‡
- ä½¿ç”¨çº¿ç¨‹æ± ç®¡ç†çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- å¤šçº¿ç¨‹å¤„ç†I/Oå¥½ï¼ŒCPUå¯†é›†è¦å¤šè¿›ç¨‹
- Lockä¿æŠ¤å…±äº«èµ„æºï¼ŒRLocké‡å…¥ä¸æ­»é”
- Conditionç­‰å¾…åŠ é€šçŸ¥ï¼ŒSemaphoreæ§åˆ¶å¹¶å‘æ•°
- withè¯­å¥ç®¡ç†é”ï¼Œjoinç­‰å¾…çº¿ç¨‹å®ŒæˆåŠŸ