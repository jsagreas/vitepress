---
title: 2ã€å¼‚å¸¸è¯­å¥è¯¦è§£
---
## ğŸ“š ç›®å½•

1. [å¼‚å¸¸å¤„ç†åŸºç¡€æ¦‚å¿µ](#1-å¼‚å¸¸å¤„ç†åŸºç¡€æ¦‚å¿µ)
2. [try-exceptåŸºæœ¬ç»“æ„](#2-try-exceptåŸºæœ¬ç»“æ„)
3. [elseå­å¥çš„ä½¿ç”¨](#3-elseå­å¥çš„ä½¿ç”¨)
4. [finallyå­å¥ä¿è¯æ‰§è¡Œ](#4-finallyå­å¥ä¿è¯æ‰§è¡Œ)
5. [å®Œæ•´çš„å¼‚å¸¸å¤„ç†ç»“æ„](#5-å®Œæ•´çš„å¼‚å¸¸å¤„ç†ç»“æ„)
6. [å¼‚å¸¸å¤„ç†åµŒå¥—](#6-å¼‚å¸¸å¤„ç†åµŒå¥—)
7. [å¼‚å¸¸é‡æ–°æŠ›å‡º](#7-å¼‚å¸¸é‡æ–°æŠ›å‡º)
8. [å¼‚å¸¸é“¾ä¸ä¸Šä¸‹æ–‡](#8-å¼‚å¸¸é“¾ä¸ä¸Šä¸‹æ–‡)
9. [å¼‚å¸¸ä¿¡æ¯ä¿ç•™](#9-å¼‚å¸¸ä¿¡æ¯ä¿ç•™)
10. [å¼‚å¸¸å¤„ç†æ€§èƒ½è€ƒè™‘](#10-å¼‚å¸¸å¤„ç†æ€§èƒ½è€ƒè™‘)
11. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#11-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”¥ å¼‚å¸¸å¤„ç†åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯å¼‚å¸¸


**å¼‚å¸¸**å°±åƒç”Ÿæ´»ä¸­çš„æ„å¤–äº‹ä»¶ï¼Œæ¯”å¦‚ä½ è¦å»é“¶è¡Œå–é’±ï¼Œä½†é“¶è¡Œçªç„¶åœç”µäº†ã€‚åœ¨ç¨‹åºä¸­ï¼Œå¼‚å¸¸å°±æ˜¯ä»£ç è¿è¡Œæ—¶é‡åˆ°çš„"æ„å¤–æƒ…å†µ"ã€‚

```
ç”Ÿæ´»ä¸­çš„ä¾‹å­                    ç¨‹åºä¸­çš„å¼‚å¸¸
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ§ é“¶è¡Œåœç”µæ— æ³•å–é’±        â†’     æ–‡ä»¶ä¸å­˜åœ¨æ— æ³•è¯»å–
ğŸ• æŠ«è¨åº—æ²¡æœ‰ä½ æƒ³è¦çš„å£å‘³   â†’     åˆ—è¡¨ç´¢å¼•è¶…å‡ºèŒƒå›´  
ğŸ“ ç”µè¯å·ç æ‹¨é”™äº†         â†’     é™¤é›¶é”™è¯¯
ğŸš— è·¯ä¸Šé‡åˆ°å µè½¦          â†’     ç½‘ç»œè¿æ¥è¶…æ—¶
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦å¼‚å¸¸å¤„ç†


æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœä½ çš„ç¨‹åºé‡åˆ°é—®é¢˜å°±ç›´æ¥"ç½¢å·¥"ä¸å¹²äº†ï¼Œç”¨æˆ·ä¼šå¤šä¹ˆå›°æ‰°ï¼å¼‚å¸¸å¤„ç†å°±åƒç»™ç¨‹åºé…å¤‡äº†"åº”æ€¥é¢„æ¡ˆ"ã€‚

**ğŸ¯ å¼‚å¸¸å¤„ç†çš„æ ¸å¿ƒä½œç”¨**ï¼š
- **ğŸ›¡ï¸ ä¿æŠ¤ç¨‹åº**ï¼šé˜²æ­¢ç¨‹åºå› ä¸ºå°é—®é¢˜å°±å´©æºƒ
- **ğŸ“ è®°å½•é—®é¢˜**ï¼šå‘Šè¯‰æˆ‘ä»¬åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆ
- **ğŸ”„ ä¼˜é›…å¤„ç†**ï¼šç»™ç”¨æˆ·å‹å¥½çš„æç¤ºè€Œä¸æ˜¯ä¹±ç é”™è¯¯
- **ğŸš€ ç»§ç»­è¿è¡Œ**ï¼šå¤„ç†å®Œé—®é¢˜åç¨‹åºå¯ä»¥ç»§ç»­å·¥ä½œ

### 1.3 Pythonä¸­çš„å¼‚å¸¸ç±»å‹


PythonæŠŠä¸åŒçš„é”™è¯¯åˆ†æˆäº†ä¸åŒçš„"ç±»åˆ«"ï¼Œå°±åƒåŒ»é™¢æŠŠç–¾ç—…åˆ†ç§‘ä¸€æ ·ï¼š

```
å¸¸è§å¼‚å¸¸ç±»å‹è¯´æ˜ï¼š

ValueError     å€¼é”™è¯¯    â†’ æ•°æ®ç±»å‹å¯¹ä½†å€¼ä¸åˆé€‚
TypeError      ç±»å‹é”™è¯¯  â†’ æ•°æ®ç±»å‹æœ¬èº«å°±ä¸å¯¹  
IndexError     ç´¢å¼•é”™è¯¯  â†’ è®¿é—®äº†ä¸å­˜åœ¨çš„ä½ç½®
KeyError       é”®é”™è¯¯    â†’ å­—å…¸ä¸­æ²¡æœ‰è¿™ä¸ªé”®
FileNotFoundError æ–‡ä»¶æœªæ‰¾åˆ° â†’ è¦æ‰“å¼€çš„æ–‡ä»¶ä¸å­˜åœ¨
ZeroDivisionError é™¤é›¶é”™è¯¯ â†’ æ•°å­¦ä¸Šä¸èƒ½é™¤ä»¥0
```

---

## 2. ğŸ¯ try-exceptåŸºæœ¬ç»“æ„


### 2.1 åŸºæœ¬è¯­æ³•ç»“æ„


`try-except`å°±åƒæ˜¯ç»™ä»£ç ç©¿ä¸Š"é˜²æŠ¤æœ"ï¼Œå‘Šè¯‰Pythonï¼š**"è¯•ç€åšè¿™ä»¶äº‹ï¼Œå¦‚æœå‡ºé—®é¢˜äº†ï¼Œå°±è¿™æ ·å¤„ç†"**ã€‚

```python
# åŸºæœ¬ç»“æ„
try:
    # å¯èƒ½å‡ºé”™çš„ä»£ç 
    pass
except å¼‚å¸¸ç±»å‹:
    # å‡ºé”™æ—¶çš„å¤„ç†æ–¹æ¡ˆ
    pass
```

### 2.2 ç®€å•å®ç”¨ç¤ºä¾‹


**åœºæ™¯ï¼šç”¨æˆ·è¾“å…¥å¹´é¾„è®¡ç®—èƒ½å¦æŠ•ç¥¨**

```python
# æ²¡æœ‰å¼‚å¸¸å¤„ç†çš„ç‰ˆæœ¬ï¼ˆå±é™©ï¼ï¼‰
age = int(input("è¯·è¾“å…¥æ‚¨çš„å¹´é¾„: "))  # å¦‚æœç”¨æˆ·è¾“å…¥"abc"å°±å´©æºƒäº†
if age >= 18:
    print("æ‚¨å¯ä»¥æŠ•ç¥¨")
else:
    print("æ‚¨è¿˜ä¸èƒ½æŠ•ç¥¨")

# æœ‰å¼‚å¸¸å¤„ç†çš„ç‰ˆæœ¬ï¼ˆå®‰å…¨ï¼ï¼‰
try:
    age = int(input("è¯·è¾“å…¥æ‚¨çš„å¹´é¾„: "))
    if age >= 18:
        print("æ‚¨å¯ä»¥æŠ•ç¥¨") 
    else:
        print("æ‚¨è¿˜ä¸èƒ½æŠ•ç¥¨")
except ValueError:
    print("è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—å¹´é¾„")
```

### 2.3 æ•è·å¤šç§å¼‚å¸¸


æœ‰æ—¶å€™ä¸€æ®µä»£ç å¯èƒ½é‡åˆ°å¤šç§ä¸åŒçš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†åˆ«å¤„ç†ï¼š

```python
def å®‰å…¨é™¤æ³•(a, b):
    try:
        result = a / b
        return result
    except ZeroDivisionError:
        print("é”™è¯¯ï¼šä¸èƒ½é™¤ä»¥é›¶ï¼")
        return None
    except TypeError:
        print("é”™è¯¯ï¼šè¯·è¾“å…¥æ•°å­—ï¼")  
        return None

# æµ‹è¯•ä¸åŒæƒ…å†µ
print(å®‰å…¨é™¤æ³•(10, 2))    # æ­£å¸¸ï¼š5.0
print(å®‰å…¨é™¤æ³•(10, 0))    # é™¤é›¶é”™è¯¯  
print(å®‰å…¨é™¤æ³•(10, "a"))  # ç±»å‹é”™è¯¯
```

### 2.4 ä¸€æ¬¡æ•è·å¤šä¸ªå¼‚å¸¸


å¦‚æœå¤šä¸ªå¼‚å¸¸éœ€è¦ç›¸åŒçš„å¤„ç†æ–¹å¼ï¼Œå¯ä»¥ä¸€èµ·å†™ï¼š

```python
def è¯»å–æ–‡ä»¶å†…å®¹(filename):
    try:
        with open(filename, 'r', encoding='utf-8') as f:
            content = f.read()
            lines = int(content.split('\n')[0])  # å‡è®¾ç¬¬ä¸€è¡Œæ˜¯æ•°å­—
            return lines
    except (FileNotFoundError, PermissionError, ValueError) as e:
        print(f"æ–‡ä»¶å¤„ç†å¤±è´¥ï¼š{e}")
        return None
```

---

## 3. âœ… elseå­å¥çš„ä½¿ç”¨


### 3.1 elseå­å¥çš„å«ä¹‰


`else`å­å¥æ˜¯Pythonå¼‚å¸¸å¤„ç†ä¸­çš„"æˆåŠŸåº†ç¥"ç¯èŠ‚ã€‚**åªæœ‰å½“tryå—ä¸­æ²¡æœ‰å‘ç”Ÿä»»ä½•å¼‚å¸¸æ—¶ï¼Œelseå—æ‰ä¼šæ‰§è¡Œ**ã€‚

```
try-except-else çš„é€»è¾‘æµç¨‹ï¼š

å°è¯•æ‰§è¡Œä»£ç 
     â†“
   æˆåŠŸäº†å—ï¼Ÿ
   â†™     â†˜
 å¤±è´¥     æˆåŠŸ
  â†“       â†“  
except   else
æ‰§è¡Œ     æ‰§è¡Œ
```

### 3.2 ä¸ºä»€ä¹ˆéœ€è¦elseå­å¥


å¯èƒ½ä½ ä¼šæƒ³ï¼š"ä¸ºä»€ä¹ˆä¸ç›´æ¥æŠŠä»£ç å†™åœ¨tryé‡Œé¢ï¼Ÿ"è¿™æ˜¯ä¸ªå¥½é—®é¢˜ï¼

```python
# æ–¹å¼1ï¼šå…¨éƒ¨æ”¾åœ¨tryä¸­ï¼ˆä¸æ¨èï¼‰
def å¤„ç†æ–‡ä»¶_æ–¹å¼1(filename):
    try:
        f = open(filename, 'r')
        content = f.read()
        f.close()
        
        # è¿™äº›ä»£ç å…¶å®ä¸éœ€è¦å¼‚å¸¸ä¿æŠ¤
        processed = content.upper()
        print("æ–‡ä»¶å¤„ç†å®Œæˆ")
        return processed
    except FileNotFoundError:
        print("æ–‡ä»¶ä¸å­˜åœ¨")
        return None

# æ–¹å¼2ï¼šä½¿ç”¨elseï¼ˆæ¨èï¼‰
def å¤„ç†æ–‡ä»¶_æ–¹å¼2(filename):
    try:
        f = open(filename, 'r')
    except FileNotFoundError:
        print("æ–‡ä»¶ä¸å­˜åœ¨")
        return None
    else:
        # åªæœ‰æ–‡ä»¶æˆåŠŸæ‰“å¼€åæ‰æ‰§è¡Œè¿™äº›
        content = f.read()
        f.close()
        processed = content.upper()
        print("æ–‡ä»¶å¤„ç†å®Œæˆ")
        return processed
```

**ğŸ¯ ä½¿ç”¨elseçš„å¥½å¤„**ï¼š
- **é€»è¾‘æ¸…æ™°**ï¼šæ˜ç¡®åŒºåˆ†"å¯èƒ½å‡ºé”™çš„ä»£ç "å’Œ"è‚¯å®šå®‰å…¨çš„ä»£ç "
- **æ€§èƒ½æ›´å¥½**ï¼šå‡å°‘å¼‚å¸¸æ£€æŸ¥çš„èŒƒå›´
- **æ›´å¥½ç»´æŠ¤**ï¼šä»£ç æ„å›¾æ›´æ˜ç¡®

### 3.3 å®é™…åº”ç”¨åœºæ™¯


```python
def å®‰å…¨è®¡ç®—å™¨():
    try:
        num1 = float(input("è¾“å…¥ç¬¬ä¸€ä¸ªæ•°å­—: "))
        num2 = float(input("è¾“å…¥ç¬¬äºŒä¸ªæ•°å­—: "))
        operation = input("é€‰æ‹©æ“ä½œ (+, -, *, /): ")
    except ValueError:
        print("è¾“å…¥çš„ä¸æ˜¯æœ‰æ•ˆæ•°å­—ï¼")
    else:
        # åªæœ‰è¾“å…¥éƒ½æ­£ç¡®æ—¶æ‰è¿›è¡Œè®¡ç®—
        if operation == '+':
            result = num1 + num2
        elif operation == '-':
            result = num1 - num2
        elif operation == '*':
            result = num1 * num2
        elif operation == '/':
            if num2 != 0:
                result = num1 / num2
            else:
                print("ä¸èƒ½é™¤ä»¥é›¶ï¼")
                return
        else:
            print("ä¸æ”¯æŒçš„æ“ä½œï¼")
            return
            
        print(f"è®¡ç®—ç»“æœ: {result}")
```

---

## 4. ğŸ›¡ï¸ finallyå­å¥ä¿è¯æ‰§è¡Œ


### 4.1 finallyçš„æ ¸å¿ƒç‰¹æ€§


`finally`å°±åƒæ˜¯"æ— è®ºå¦‚ä½•éƒ½è¦åšçš„äº‹æƒ…"ï¼Œä¸ç®¡ç¨‹åºæ˜¯å¦å‡ºé”™ï¼Œfinallyå—é‡Œçš„ä»£ç **ä¸€å®šä¼šæ‰§è¡Œ**ã€‚

```
ä¸åŒæƒ…å†µä¸‹çš„æ‰§è¡Œæµç¨‹ï¼š

æƒ…å†µ1ï¼šæ— å¼‚å¸¸
try â†’ else â†’ finally

æƒ…å†µ2ï¼šæœ‰å¼‚å¸¸ä¸”è¢«æ•è·  
try â†’ except â†’ finally

æƒ…å†µ3ï¼šæœ‰å¼‚å¸¸ä½†æœªè¢«æ•è·
try â†’ finally â†’ ç¨‹åºå´©æºƒ
```

### 4.2 ç»å…¸åº”ç”¨åœºæ™¯


**ğŸ”§ èµ„æºæ¸…ç†**æ˜¯finallyæœ€é‡è¦çš„ç”¨é€”ï¼š

```python
def å¤„ç†æ•°æ®åº“è¿æ¥():
    connection = None
    try:
        print("1. è¿æ¥æ•°æ®åº“...")
        connection = å»ºç«‹æ•°æ®åº“è¿æ¥()  # å‡è®¾è¿™ä¸ªå‡½æ•°å­˜åœ¨
        
        print("2. æ‰§è¡ŒæŸ¥è¯¢...")
        data = connection.query("SELECT * FROM users")
        
        print("3. å¤„ç†æ•°æ®...")
        result = å¤„ç†æ•°æ®(data)  # è¿™é‡Œå¯èƒ½å‡ºé”™
        
    except Exception as e:
        print(f"æ“ä½œå¤±è´¥: {e}")
        result = None
    finally:
        # æ— è®ºæˆåŠŸå¤±è´¥ï¼Œéƒ½è¦å…³é—­è¿æ¥
        if connection:
            print("4. å…³é—­æ•°æ®åº“è¿æ¥...")
            connection.close()
    
    return result
```

### 4.3 æ–‡ä»¶æ“ä½œçš„å®Œæ•´ä¿æŠ¤


```python
def å®‰å…¨æ–‡ä»¶æ“ä½œ(input_file, output_file):
    input_f = None
    output_f = None
    
    try:
        print("æ‰“å¼€è¾“å…¥æ–‡ä»¶...")
        input_f = open(input_file, 'r', encoding='utf-8')
        
        print("æ‰“å¼€è¾“å‡ºæ–‡ä»¶...")  
        output_f = open(output_file, 'w', encoding='utf-8')
        
        print("å¤„ç†æ–‡ä»¶å†…å®¹...")
        for line in input_f:
            # å‡è®¾è¿™é‡Œè¿›è¡Œä¸€äº›å¤æ‚å¤„ç†ï¼Œå¯èƒ½å‡ºé”™
            processed_line = line.upper().strip()
            output_f.write(processed_line + '\n')
            
    except FileNotFoundError:
        print("æ–‡ä»¶ä¸å­˜åœ¨ï¼")
    except PermissionError:
        print("æ²¡æœ‰æ–‡ä»¶è®¿é—®æƒé™ï¼")
    except Exception as e:
        print(f"å¤„ç†è¿‡ç¨‹ä¸­å‡ºé”™: {e}")
    finally:
        # ç¡®ä¿æ–‡ä»¶éƒ½è¢«æ­£ç¡®å…³é—­
        if input_f:
            input_f.close()
            print("è¾“å…¥æ–‡ä»¶å·²å…³é—­")
        if output_f:
            output_f.close()
            print("è¾“å‡ºæ–‡ä»¶å·²å…³é—­")
```

### 4.4 finally vs withè¯­å¥


Pythonæä¾›äº†`with`è¯­å¥æ¥ç®€åŒ–èµ„æºç®¡ç†ï¼š

```python
# ä½¿ç”¨finallyï¼ˆä¼ ç»Ÿæ–¹å¼ï¼‰
def ä¼ ç»Ÿæ–¹å¼(filename):
    f = None
    try:
        f = open(filename, 'r')
        content = f.read()
        return content
    except FileNotFoundError:
        print("æ–‡ä»¶ä¸å­˜åœ¨")
        return None
    finally:
        if f:
            f.close()

# ä½¿ç”¨withï¼ˆæ¨èæ–¹å¼ï¼‰
def ç°ä»£æ–¹å¼(filename):
    try:
        with open(filename, 'r') as f:
            content = f.read()
            return content
    except FileNotFoundError:
        print("æ–‡ä»¶ä¸å­˜åœ¨")  
        return None
    # æ–‡ä»¶ä¼šè‡ªåŠ¨å…³é—­ï¼Œä¸éœ€è¦finally
```

---

## 5. ğŸ—ï¸ å®Œæ•´çš„å¼‚å¸¸å¤„ç†ç»“æ„


### 5.1 æ ‡å‡†çš„å››æ®µå¼ç»“æ„


å®Œæ•´çš„å¼‚å¸¸å¤„ç†å°±åƒä¸€ä¸ªå®Œå¤‡çš„åº”æ€¥é¢„æ¡ˆï¼ŒåŒ…å«äº†æ‰€æœ‰å¯èƒ½çš„æƒ…å†µï¼š

```python
try:
    # 1. å¯èƒ½å‡ºé”™çš„ä»£ç ï¼ˆå¿…éœ€ï¼‰
    pass
except å¼‚å¸¸ç±»å‹:
    # 2. å‡ºé”™æ—¶çš„å¤„ç†ï¼ˆå¿…éœ€ï¼‰ 
    pass
else:
    # 3. æˆåŠŸæ—¶çš„åç»­æ“ä½œï¼ˆå¯é€‰ï¼‰
    pass
finally:
    # 4. æ— è®ºå¦‚ä½•éƒ½è¦åšçš„ï¼ˆå¯é€‰ï¼‰
    pass
```

### 5.2 å®é™…åº”ç”¨ç¤ºä¾‹


```python
def å®Œæ•´çš„æ–‡ä»¶å¤„ç†ç³»ç»Ÿ(filename, backup_filename):
    """
    ä¸€ä¸ªå±•ç¤ºå®Œæ•´å¼‚å¸¸å¤„ç†ç»“æ„çš„æ–‡ä»¶å¤„ç†å‡½æ•°
    """
    success = False
    
    try:
        print("ğŸ”„ å¼€å§‹å¤„ç†æ–‡ä»¶...")
        
        # å°è¯•è¯»å–ä¸»æ–‡ä»¶
        with open(filename, 'r', encoding='utf-8') as f:
            content = f.read()
            
        # éªŒè¯æ–‡ä»¶å†…å®¹
        if len(content.strip()) == 0:
            raise ValueError("æ–‡ä»¶å†…å®¹ä¸ºç©º")
            
        lines_count = len(content.split('\n'))
        
    except FileNotFoundError:
        print("âŒ ä¸»æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°è¯•è¯»å–å¤‡ä»½æ–‡ä»¶...")
        try:
            with open(backup_filename, 'r', encoding='utf-8') as f:
                content = f.read()
                lines_count = len(content.split('\n'))
                print("âœ… æˆåŠŸä»å¤‡ä»½æ–‡ä»¶è¯»å–")
        except FileNotFoundError:
            print("âŒ å¤‡ä»½æ–‡ä»¶ä¹Ÿä¸å­˜åœ¨ï¼")
            return None
            
    except PermissionError:
        print("âŒ æ²¡æœ‰æ–‡ä»¶è¯»å–æƒé™")
        return None
        
    except ValueError as e:
        print(f"âŒ æ–‡ä»¶å†…å®¹é”™è¯¯: {e}")
        return None
        
    else:
        # åªæœ‰æˆåŠŸè¯»å–æ–‡ä»¶åæ‰æ‰§è¡Œ
        print("âœ… æ–‡ä»¶è¯»å–æˆåŠŸï¼")
        success = True
        
        # è¿›è¡Œä¸€äº›åç»­å¤„ç†
        processed_content = content.upper()
        print(f"ğŸ“Š æ–‡ä»¶åŒ…å« {lines_count} è¡Œ")
        
    finally:
        # æ— è®ºæˆåŠŸå¤±è´¥éƒ½æ‰§è¡Œ
        print("ğŸ”š æ–‡ä»¶å¤„ç†æ“ä½œç»“æŸ")
        if success:
            print("ğŸ“ˆ å¤„ç†çŠ¶æ€ï¼šæˆåŠŸ")
        else:
            print("ğŸ“‰ å¤„ç†çŠ¶æ€ï¼šå¤±è´¥")
    
    return processed_content if success else None
```

### 5.3 æ‰§è¡Œé¡ºåºæ¼”ç¤º


è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•ä¾‹å­çœ‹çœ‹å„ä¸ªå­å¥çš„æ‰§è¡Œé¡ºåºï¼š

```python
def æ¼”ç¤ºæ‰§è¡Œé¡ºåº(ä¼šå‡ºé”™=False):
    print("ğŸš€ å‡½æ•°å¼€å§‹æ‰§è¡Œ")
    
    try:
        print("ğŸ“ tryå—: æ‰§è¡Œå¯èƒ½å‡ºé”™çš„ä»£ç ")
        if ä¼šå‡ºé”™:
            raise ValueError("æ•…æ„åˆ¶é€ çš„é”™è¯¯")
        print("ğŸ“ tryå—: ä»£ç æ‰§è¡ŒæˆåŠŸ")
        
    except ValueError as e:
        print(f"âŒ exceptå—: æ•è·åˆ°é”™è¯¯ - {e}")
        
    else:
        print("âœ… elseå—: æ²¡æœ‰å¼‚å¸¸ï¼Œæ‰§è¡ŒæˆåŠŸä»£ç ")
        
    finally:
        print("ğŸ”š finallyå—: æ— è®ºå¦‚ä½•éƒ½ä¼šæ‰§è¡Œ")
    
    print("ğŸ¯ å‡½æ•°æ‰§è¡Œç»“æŸ\n")

# æµ‹è¯•ä¸åŒæƒ…å†µ
print("=== æƒ…å†µ1ï¼šæ— å¼‚å¸¸ ===")
æ¼”ç¤ºæ‰§è¡Œé¡ºåº(ä¼šå‡ºé”™=False)

print("=== æƒ…å†µ2ï¼šæœ‰å¼‚å¸¸ ===") 
æ¼”ç¤ºæ‰§è¡Œé¡ºåº(ä¼šå‡ºé”™=True)
```

**è¾“å‡ºç»“æœåˆ†æ**ï¼š

```
=== æƒ…å†µ1ï¼šæ— å¼‚å¸¸ ===
ğŸš€ å‡½æ•°å¼€å§‹æ‰§è¡Œ
ğŸ“ tryå—: æ‰§è¡Œå¯èƒ½å‡ºé”™çš„ä»£ç   
ğŸ“ tryå—: ä»£ç æ‰§è¡ŒæˆåŠŸ
âœ… elseå—: æ²¡æœ‰å¼‚å¸¸ï¼Œæ‰§è¡ŒæˆåŠŸä»£ç 
ğŸ”š finallyå—: æ— è®ºå¦‚ä½•éƒ½ä¼šæ‰§è¡Œ
ğŸ¯ å‡½æ•°æ‰§è¡Œç»“æŸ

=== æƒ…å†µ2ï¼šæœ‰å¼‚å¸¸ ===
ğŸš€ å‡½æ•°å¼€å§‹æ‰§è¡Œ
ğŸ“ tryå—: æ‰§è¡Œå¯èƒ½å‡ºé”™çš„ä»£ç 
âŒ exceptå—: æ•è·åˆ°é”™è¯¯ - æ•…æ„åˆ¶é€ çš„é”™è¯¯  
ğŸ”š finallyå—: æ— è®ºå¦‚ä½•éƒ½ä¼šæ‰§è¡Œ
ğŸ¯ å‡½æ•°æ‰§è¡Œç»“æŸ
```

---

## 6. ğŸ”„ å¼‚å¸¸å¤„ç†åµŒå¥—


### 6.1 ä»€ä¹ˆæ˜¯å¼‚å¸¸å¤„ç†åµŒå¥—


åµŒå¥—å¼‚å¸¸å¤„ç†å°±åƒ"ä¿„ç½—æ–¯å¥—å¨ƒ"ï¼Œä¸€ä¸ªå¼‚å¸¸å¤„ç†å—é‡Œé¢è¿˜æœ‰å¦ä¸€ä¸ªå¼‚å¸¸å¤„ç†å—ã€‚è¿™åœ¨å¤æ‚çš„ç¨‹åºä¸­å¾ˆå¸¸è§ã€‚

```
åµŒå¥—ç»“æ„ç¤ºæ„ï¼š

å¤–å±‚try:
  â”œâ”€ ä¸€äº›ä»£ç 
  â”œâ”€ å†…å±‚try:
  â”‚   â”œâ”€ æ›´ç»†è‡´çš„æ“ä½œ
  â”‚   â””â”€ å†…å±‚except: å¤„ç†å…·ä½“é”™è¯¯
  â””â”€ å¤–å±‚except: å¤„ç†å¤§çš„é”™è¯¯
```

### 6.2 å®é™…åº”ç”¨åœºæ™¯


```python
def å¤æ‚æ•°æ®å¤„ç†ç³»ç»Ÿ(data_sources):
    """
    å¤„ç†å¤šä¸ªæ•°æ®æºï¼Œæ¯ä¸ªæ•°æ®æºéƒ½å¯èƒ½æœ‰ä¸åŒç±»å‹çš„é—®é¢˜
    """
    processed_results = []
    
    try:
        print("ğŸ”„ å¼€å§‹æ‰¹é‡å¤„ç†æ•°æ®æº...")
        
        for i, source in enumerate(data_sources):
            print(f"\nğŸ“ å¤„ç†ç¬¬ {i+1} ä¸ªæ•°æ®æº: {source}")
            
            try:
                # å†…å±‚å¼‚å¸¸å¤„ç†ï¼šå¤„ç†å•ä¸ªæ•°æ®æº
                print("  ğŸ“– è¯»å–æ•°æ®...")
                with open(source, 'r', encoding='utf-8') as f:
                    raw_data = f.read()
                
                print("  ğŸ” éªŒè¯æ•°æ®æ ¼å¼...")
                if not raw_data.strip():
                    raise ValueError("æ•°æ®æºä¸ºç©º")
                
                try:
                    # æ›´å†…å±‚çš„å¼‚å¸¸å¤„ç†ï¼šå¤„ç†æ•°æ®è½¬æ¢
                    print("  ğŸ”„ è½¬æ¢æ•°æ®æ ¼å¼...")
                    data_lines = raw_data.split('\n')
                    numbers = [float(line.strip()) for line in data_lines if line.strip()]
                    
                    if len(numbers) == 0:
                        raise ValueError("æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„æ•°å­—æ•°æ®")
                        
                except ValueError as e:
                    print(f"  âŒ æ•°æ®è½¬æ¢å¤±è´¥: {e}")
                    # å°è¯•å…¶ä»–æ ¼å¼
                    try:
                        print("  ğŸ”„ å°è¯•å…¶ä»–æ•°æ®æ ¼å¼...")
                        numbers = [float(x) for x in raw_data.split(',') if x.strip().replace('.','').isdigit()]
                        if len(numbers) == 0:
                            raise ValueError("æ‰€æœ‰æ ¼å¼éƒ½å°è¯•å¤±è´¥")
                    except ValueError:
                        print("  âŒ æ‰€æœ‰æ•°æ®æ ¼å¼å°è¯•éƒ½å¤±è´¥ï¼Œè·³è¿‡æ­¤æ•°æ®æº")
                        continue
                
                # å¤„ç†æˆåŠŸçš„æƒ…å†µ
                result = sum(numbers) / len(numbers)  # è®¡ç®—å¹³å‡å€¼
                processed_results.append({
                    'source': source,
                    'average': result,
                    'count': len(numbers)
                })
                print(f"  âœ… å¤„ç†æˆåŠŸï¼Œå¹³å‡å€¼: {result:.2f}")
                
            except FileNotFoundError:
                print(f"  âŒ æ–‡ä»¶ä¸å­˜åœ¨: {source}")
                continue
                
            except PermissionError:
                print(f"  âŒ æ²¡æœ‰æƒé™è®¿é—®: {source}")
                continue
                
            except Exception as e:
                print(f"  âŒ å¤„ç† {source} æ—¶å‘ç”ŸæœªçŸ¥é”™è¯¯: {e}")
                continue
    
    except KeyboardInterrupt:
        print("\nâ›” ç”¨æˆ·ä¸­æ–­äº†å¤„ç†è¿‡ç¨‹")
        return processed_results
        
    except Exception as e:
        print(f"\nâŒ ç³»ç»Ÿçº§é”™è¯¯: {e}")
        return []
    
    finally:
        print(f"\nğŸ“Š å¤„ç†å®Œæˆï¼ŒæˆåŠŸå¤„ç†äº† {len(processed_results)} ä¸ªæ•°æ®æº")
    
    return processed_results
```

### 6.3 åµŒå¥—çš„æœ€ä½³å®è·µ


**ğŸ¯ ä½•æ—¶ä½¿ç”¨åµŒå¥—å¼‚å¸¸å¤„ç†**ï¼š

| åœºæ™¯ | æ˜¯å¦ä½¿ç”¨åµŒå¥— | åŸå›  |
|------|-------------|------|
| ğŸ“ **æ‰¹é‡æ–‡ä»¶å¤„ç†** | âœ… æ¨è | å•ä¸ªæ–‡ä»¶å¤±è´¥ä¸åº”å½±å“æ•´ä½“ |
| ğŸŒ **ç½‘ç»œè¯·æ±‚é‡è¯•** | âœ… æ¨è | ä¸åŒå±‚æ¬¡çš„ç½‘ç»œé”™è¯¯éœ€è¦ä¸åŒå¤„ç† |
| ğŸ”„ **æ•°æ®è½¬æ¢ç®¡é“** | âœ… æ¨è | æ¯ä¸ªæ­¥éª¤éƒ½å¯èƒ½æœ‰ç‰¹å®šé”™è¯¯ |
| ğŸ“ **ç®€å•è®¡ç®—** | âŒ ä¸æ¨è | å¢åŠ å¤æ‚åº¦è€Œæ— æ˜æ˜¾å¥½å¤„ |

```python
def ç½‘ç»œè¯·æ±‚é‡è¯•ç¤ºä¾‹(url, max_retries=3):
    """
    å±•ç¤ºç½‘ç»œè¯·æ±‚çš„åµŒå¥—å¼‚å¸¸å¤„ç†
    """
    import time
    
    try:
        print(f"ğŸŒ å¼€å§‹è¯·æ±‚: {url}")
        
        for attempt in range(max_retries):
            print(f"ğŸ“¡ ç¬¬ {attempt + 1} æ¬¡å°è¯•...")
            
            try:
                # æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚ï¼ˆå®é™…åº”è¯¥ç”¨requestsåº“ï¼‰
                response = æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚(url)  # å‡è®¾è¿™ä¸ªå‡½æ•°å­˜åœ¨
                
                try:
                    # å†…å±‚ï¼šå¤„ç†å“åº”æ•°æ®
                    data = è§£æå“åº”æ•°æ®(response)  # å‡è®¾è¿™ä¸ªå‡½æ•°å­˜åœ¨
                    print("âœ… è¯·æ±‚æˆåŠŸå¹¶è§£æå®Œæˆ")
                    return data
                    
                except ValueError as e:
                    print(f"âš ï¸ æ•°æ®è§£æå¤±è´¥: {e}")
                    if attempt < max_retries - 1:
                        print("ğŸ”„ å°†é‡è¯•è¯·æ±‚...")
                        continue
                    else:
                        raise
                        
            except ConnectionError:
                print("âŒ ç½‘ç»œè¿æ¥å¤±è´¥")
                if attempt < max_retries - 1:
                    wait_time = 2 ** attempt  # æŒ‡æ•°é€€é¿
                    print(f"â° ç­‰å¾… {wait_time} ç§’åé‡è¯•...")
                    time.sleep(wait_time)
                else:
                    print("âŒ å·²è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°")
                    raise
                    
            except TimeoutError:
                print("â° è¯·æ±‚è¶…æ—¶")
                if attempt < max_retries - 1:
                    print("ğŸ”„ é‡è¯•...")
                else:
                    raise
    
    except Exception as e:
        print(f"âŒ è¯·æ±‚å½»åº•å¤±è´¥: {e}")
        return None
```

---

## 7. ğŸš€ å¼‚å¸¸é‡æ–°æŠ›å‡º


### 7.1 ä»€ä¹ˆæ˜¯å¼‚å¸¸é‡æ–°æŠ›å‡º


å¼‚å¸¸é‡æ–°æŠ›å‡ºå°±åƒ"æ¥åŠ›èµ›"ï¼Œå½“å‰å‡½æ•°å¤„ç†äº†ä¸€éƒ¨åˆ†å¼‚å¸¸æƒ…å†µï¼Œä½†è¿˜éœ€è¦è®©ä¸Šå±‚è°ƒç”¨è€…çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆã€‚

```
å¼‚å¸¸é‡æ–°æŠ›å‡ºçš„æµç¨‹ï¼š

ä½å±‚å‡½æ•°å‘ç°é—®é¢˜
      â†“
è®°å½•é”™è¯¯ä¿¡æ¯/æ¸…ç†èµ„æº  
      â†“
é‡æ–°æŠ›å‡ºå¼‚å¸¸ç»™ä¸Šå±‚
      â†“
ä¸Šå±‚å‡½æ•°å†³å®šå¦‚ä½•å¤„ç†
```

### 7.2 åŸºæœ¬çš„é‡æ–°æŠ›å‡º


```python
def åº•å±‚æ•°æ®è¯»å–(filename):
    """
    åº•å±‚å‡½æ•°ï¼šåªè´Ÿè´£è¯»å–æ–‡ä»¶ï¼Œè®°å½•é”™è¯¯
    """
    try:
        print(f"ğŸ“– å°è¯•è¯»å–æ–‡ä»¶: {filename}")
        with open(filename, 'r', encoding='utf-8') as f:
            content = f.read()
        return content
        
    except FileNotFoundError as e:
        print(f"ğŸ“ è®°å½•é”™è¯¯: æ–‡ä»¶ {filename} ä¸å­˜åœ¨")
        # è®°å½•åˆ°æ—¥å¿—ç³»ç»Ÿï¼ˆå‡è®¾ï¼‰
        è®°å½•åˆ°æ—¥å¿—(f"æ–‡ä»¶ä¸å­˜åœ¨: {filename}")
        raise  # é‡æ–°æŠ›å‡ºåŸå§‹å¼‚å¸¸
        
    except PermissionError as e:
        print(f"ğŸ“ è®°å½•é”™è¯¯: æ²¡æœ‰æƒé™è®¿é—® {filename}")
        è®°å½•åˆ°æ—¥å¿—(f"æƒé™é”™è¯¯: {filename}")
        raise  # é‡æ–°æŠ›å‡ºåŸå§‹å¼‚å¸¸

def ä¸Šå±‚ä¸šåŠ¡é€»è¾‘(primary_file, backup_file):
    """
    ä¸Šå±‚å‡½æ•°ï¼šå†³å®šä¸šåŠ¡é€»è¾‘ï¼Œå¦‚ä½•å¤„ç†å„ç§æƒ…å†µ
    """
    try:
        # å°è¯•è¯»å–ä¸»æ–‡ä»¶
        content = åº•å±‚æ•°æ®è¯»å–(primary_file)
        print("âœ… æˆåŠŸè¯»å–ä¸»æ–‡ä»¶")
        return content
        
    except FileNotFoundError:
        print("âš ï¸ ä¸»æ–‡ä»¶è¯»å–å¤±è´¥ï¼Œå°è¯•å¤‡ä»½æ–‡ä»¶...")
        try:
            content = åº•å±‚æ•°æ®è¯»å–(backup_file)
            print("âœ… æˆåŠŸè¯»å–å¤‡ä»½æ–‡ä»¶")
            return content
        except FileNotFoundError:
            print("âŒ ä¸»æ–‡ä»¶å’Œå¤‡ä»½æ–‡ä»¶éƒ½ä¸å­˜åœ¨")
            return None
            
    except PermissionError:
        print("âŒ æƒé™é—®é¢˜ï¼Œæ— æ³•ç»§ç»­")
        return None
```

### 7.3 ä¿®æ”¹åé‡æ–°æŠ›å‡º


æœ‰æ—¶æˆ‘ä»¬éœ€è¦åœ¨é‡æ–°æŠ›å‡ºæ—¶æ·»åŠ æ›´å¤šä¿¡æ¯ï¼š

```python
def æ•°æ®å¤„ç†ç®¡é“(data_list, processor_name):
    """
    æ•°æ®å¤„ç†ç®¡é“ï¼Œä¸ºé”™è¯¯æ·»åŠ ä¸Šä¸‹æ–‡ä¿¡æ¯
    """
    try:
        print(f"ğŸ”„ å¼€å§‹ä½¿ç”¨ {processor_name} å¤„ç†æ•°æ®...")
        
        processed_data = []
        for i, item in enumerate(data_list):
            try:
                # æ¨¡æ‹Ÿå¤æ‚çš„æ•°æ®å¤„ç†
                result = å¤æ‚æ•°æ®å¤„ç†(item)  # å‡è®¾è¿™ä¸ªå‡½æ•°å­˜åœ¨
                processed_data.append(result)
                
            except ValueError as e:
                # æ·»åŠ æ›´å¤šä¸Šä¸‹æ–‡ä¿¡æ¯åé‡æ–°æŠ›å‡º
                error_msg = f"åœ¨å¤„ç†ç¬¬ {i+1} ä¸ªæ•°æ®é¡¹æ—¶å‘ç”Ÿé”™è¯¯ (å¤„ç†å™¨: {processor_name}): {e}"
                print(f"âŒ {error_msg}")
                
                # åˆ›å»ºæ–°çš„å¼‚å¸¸ï¼Œä½†ä¿ç•™åŸå§‹å¼‚å¸¸ä¿¡æ¯
                raise ValueError(error_msg) from e
                
            except Exception as e:
                # æ•è·æ‰€æœ‰å…¶ä»–å¼‚å¸¸ï¼Œæ·»åŠ å¤„ç†ä½ç½®ä¿¡æ¯
                error_msg = f"å¤„ç†å™¨ {processor_name} åœ¨ç¬¬ {i+1} ä¸ªæ•°æ®é¡¹å‘ç”ŸæœªçŸ¥é”™è¯¯"
                print(f"âŒ {error_msg}: {e}")
                raise RuntimeError(error_msg) from e
        
        return processed_data
        
    except Exception as e:
        print(f"âŒ æ•°æ®å¤„ç†ç®¡é“ {processor_name} å®Œå…¨å¤±è´¥")
        # å¯ä»¥é€‰æ‹©é‡æ–°æŠ›å‡ºæˆ–è¿”å›é»˜è®¤å€¼
        raise  # é‡æ–°æŠ›å‡ºï¼Œè®©è°ƒç”¨è€…å†³å®šæ€ä¹ˆåŠ
```

### 7.4 é€‰æ‹©æ€§é‡æ–°æŠ›å‡º


```python
def æ™ºèƒ½æ–‡ä»¶å¤„ç†å™¨(files, å®¹é”™æ¨¡å¼=True):
    """
    æ™ºèƒ½å¤„ç†å™¨ï¼šæ ¹æ®å®¹é”™æ¨¡å¼å†³å®šæ˜¯å¦é‡æ–°æŠ›å‡º
    """
    results = []
    errors = []
    
    for filename in files:
        try:
            print(f"ğŸ“ å¤„ç†æ–‡ä»¶: {filename}")
            result = å¤„ç†å•ä¸ªæ–‡ä»¶(filename)  # å‡è®¾è¿™ä¸ªå‡½æ•°å­˜åœ¨
            results.append(result)
            
        except FileNotFoundError as e:
            error_info = f"æ–‡ä»¶ä¸å­˜åœ¨: {filename}"
            errors.append(error_info)
            
            if not å®¹é”™æ¨¡å¼:
                print(f"âŒ ä¸¥æ ¼æ¨¡å¼ï¼š{error_info}")
                raise  # é‡æ–°æŠ›å‡ºï¼Œç»ˆæ­¢å¤„ç†
            else:
                print(f"âš ï¸ å®¹é”™æ¨¡å¼ï¼šè·³è¿‡ {filename}")
                continue
                
        except Exception as e:
            error_info = f"å¤„ç† {filename} æ—¶å‘ç”Ÿé”™è¯¯: {e}"
            errors.append(error_info)
            
            if not å®¹é”™æ¨¡å¼:
                print(f"âŒ ä¸¥æ ¼æ¨¡å¼ï¼š{error_info}")
                raise
            else:
                print(f"âš ï¸ å®¹é”™æ¨¡å¼ï¼šè·³è¿‡ {filename}")
                continue
    
    # è¿”å›ç»“æœå’Œé”™è¯¯ä¿¡æ¯
    return {
        'results': results,
        'errors': errors,
        'success_count': len(results),
        'error_count': len(errors)
    }
```

---

## 8. ğŸ”— å¼‚å¸¸é“¾ä¸ä¸Šä¸‹æ–‡


### 8.1 å¼‚å¸¸é“¾çš„æ¦‚å¿µ


å¼‚å¸¸é“¾å°±åƒ"é”™è¯¯çš„æ—è°±"ï¼Œè®°å½•äº†é”™è¯¯æ˜¯å¦‚ä½•ä¸€å±‚å±‚ä¼ é€’çš„ã€‚è¿™å¸®åŠ©æˆ‘ä»¬æ‰¾åˆ°é—®é¢˜çš„çœŸæ­£æ ¹æºã€‚

```
å¼‚å¸¸é“¾ç¤ºä¾‹ï¼š

åŸå§‹é—®é¢˜ï¼šç£ç›˜ç©ºé—´ä¸è¶³
     â†“ å¯¼è‡´
æ–‡ä»¶å†™å…¥å¤±è´¥  
     â†“ å¯¼è‡´
æ•°æ®ä¿å­˜å¤±è´¥
     â†“ å¯¼è‡´  
ç”¨æˆ·æ“ä½œå¤±è´¥
```

### 8.2 ä½¿ç”¨raise...fromåˆ›å»ºå¼‚å¸¸é“¾


```python
def ä½çº§å­˜å‚¨æ“ä½œ(data, filename):
    """
    åº•å±‚å­˜å‚¨æ“ä½œ
    """
    try:
        with open(filename, 'w', encoding='utf-8') as f:
            f.write(data)
    except OSError as e:
        # åŸå§‹çš„ç³»ç»Ÿçº§é”™è¯¯
        raise IOError(f"æ— æ³•å†™å…¥æ–‡ä»¶ {filename}") from e

def ä¸­çº§æ•°æ®æœåŠ¡(user_data, user_id):
    """
    ä¸­å±‚æ•°æ®æœåŠ¡  
    """
    try:
        filename = f"user_{user_id}.dat"
        æ•°æ® = åºåˆ—åŒ–ç”¨æˆ·æ•°æ®(user_data)  # å‡è®¾è¿™ä¸ªå‡½æ•°å­˜åœ¨
        ä½çº§å­˜å‚¨æ“ä½œ(æ•°æ®, filename)
    except IOError as e:
        # æ·»åŠ ä¸šåŠ¡å±‚é¢çš„ä¸Šä¸‹æ–‡
        raise RuntimeError(f"ç”¨æˆ· {user_id} çš„æ•°æ®ä¿å­˜å¤±è´¥") from e

def é«˜çº§ç”¨æˆ·æ¥å£(user_info):
    """
    ç”¨æˆ·æ¥å£å±‚
    """
    try:
        user_id = user_info['id']
        ä¸­çº§æ•°æ®æœåŠ¡(user_info, user_id)
        return {"status": "success", "message": "ç”¨æˆ·ä¿¡æ¯ä¿å­˜æˆåŠŸ"}
    except RuntimeError as e:
        # ä¸ºç”¨æˆ·æä¾›å‹å¥½çš„é”™è¯¯ä¿¡æ¯
        print(f"âŒ æ“ä½œå¤±è´¥: {e}")
        
        # æŸ¥çœ‹å®Œæ•´çš„å¼‚å¸¸é“¾
        current = e
        level = 0
        print("\nğŸ” é”™è¯¯è¿½è¸ª:")
        while current:
            indent = "  " * level
            print(f"{indent}â””â”€ {type(current).__name__}: {current}")
            current = current.__cause__  # è·å–ä¸‹ä¸€å±‚åŸå› 
            level += 1
            
        return {"status": "error", "message": "ç³»ç»Ÿæš‚æ—¶æ— æ³•ä¿å­˜ç”¨æˆ·ä¿¡æ¯"}
```

### 8.3 éšå¼å¼‚å¸¸é“¾


å½“åœ¨exceptå—ä¸­æŠ›å‡ºæ–°å¼‚å¸¸æ—¶ï¼ŒPythonä¼šè‡ªåŠ¨åˆ›å»ºå¼‚å¸¸é“¾ï¼š

```python
def æ¼”ç¤ºéšå¼å¼‚å¸¸é“¾():
    """
    æ¼”ç¤ºéšå¼å¼‚å¸¸é“¾çš„å½¢æˆ
    """
    try:
        try:
            # åŸå§‹é”™è¯¯
            result = 10 / 0
        except ZeroDivisionError:
            # åœ¨å¤„ç†è¿‡ç¨‹ä¸­åˆå‘ç”Ÿæ–°é”™è¯¯
            undefined_variable.some_method()  # NameError
            
    except NameError as e:
        print("æ•è·åˆ° NameError")
        print(f"å½“å‰å¼‚å¸¸: {e}")
        print(f"ä¸Šä¸‹æ–‡å¼‚å¸¸: {e.__context__}")  # è‡ªåŠ¨ä¿å­˜çš„ä¸Šä¸€ä¸ªå¼‚å¸¸
        
        # æ‰“å°å®Œæ•´å¼‚å¸¸é“¾
        import traceback
        print("\nå®Œæ•´å¼‚å¸¸é“¾:")
        traceback.print_exc()

# è¿è¡Œæ¼”ç¤º
# æ¼”ç¤ºéšå¼å¼‚å¸¸é“¾()
```

### 8.4 å¼‚å¸¸é“¾çš„å®é™…åº”ç”¨


```python
class ç”¨æˆ·æœåŠ¡å¼‚å¸¸(Exception):
    """è‡ªå®šä¹‰çš„ç”¨æˆ·æœåŠ¡å¼‚å¸¸"""
    pass

class æ•°æ®åº“è¿æ¥å¼‚å¸¸(Exception):
    """è‡ªå®šä¹‰çš„æ•°æ®åº“å¼‚å¸¸"""
    pass

def ç”¨æˆ·æ³¨å†Œç³»ç»Ÿ(username, email, password):
    """
    å®Œæ•´çš„ç”¨æˆ·æ³¨å†Œç³»ç»Ÿï¼Œå±•ç¤ºå¼‚å¸¸é“¾çš„å®é™…åº”ç”¨
    """
    try:
        print(f"ğŸ”„ å¼€å§‹æ³¨å†Œç”¨æˆ·: {username}")
        
        # æ­¥éª¤1ï¼šéªŒè¯è¾“å…¥
        try:
            éªŒè¯ç”¨æˆ·è¾“å…¥(username, email, password)  # å‡è®¾è¿™ä¸ªå‡½æ•°å­˜åœ¨
        except ValueError as e:
            raise ç”¨æˆ·æœåŠ¡å¼‚å¸¸(f"ç”¨æˆ·è¾“å…¥éªŒè¯å¤±è´¥: {username}") from e
        
        # æ­¥éª¤2ï¼šæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²å­˜åœ¨
        try:
            if æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨(username):  # å‡è®¾è¿™ä¸ªå‡½æ•°å­˜åœ¨
                raise ValueError(f"ç”¨æˆ·å {username} å·²è¢«æ³¨å†Œ")
        except ConnectionError as e:
            raise æ•°æ®åº“è¿æ¥å¼‚å¸¸("æ— æ³•è¿æ¥åˆ°ç”¨æˆ·æ•°æ®åº“") from e
        except ValueError as e:
            raise ç”¨æˆ·æœåŠ¡å¼‚å¸¸(f"ç”¨æˆ·é‡å¤æ€§æ£€æŸ¥å¤±è´¥") from e
        
        # æ­¥éª¤3ï¼šåˆ›å»ºç”¨æˆ·
        try:
            user_id = åˆ›å»ºæ–°ç”¨æˆ·(username, email, password)  # å‡è®¾è¿™ä¸ªå‡½æ•°å­˜åœ¨
            print(f"âœ… ç”¨æˆ· {username} æ³¨å†ŒæˆåŠŸï¼ŒID: {user_id}")
            return user_id
        except Exception as e:
            raise ç”¨æˆ·æœåŠ¡å¼‚å¸¸(f"ç”¨æˆ·åˆ›å»ºè¿‡ç¨‹å¤±è´¥") from e
            
    except ç”¨æˆ·æœåŠ¡å¼‚å¸¸ as e:
        print(f"âŒ ç”¨æˆ·æœåŠ¡é”™è¯¯: {e}")
        
        # åˆ†æé”™è¯¯åŸå› 
        åŸå›  = e.__cause__
        if isinstance(åŸå› , ValueError):
            return {"error": "è¾“å…¥ä¿¡æ¯æœ‰è¯¯", "details": str(åŸå› )}
        elif isinstance(åŸå› , ConnectionError):
            return {"error": "ç³»ç»Ÿæš‚æ—¶ä¸å¯ç”¨", "details": "è¯·ç¨åé‡è¯•"}
        else:
            return {"error": "æœªçŸ¥é”™è¯¯", "details": "è¯·è”ç³»ç³»ç»Ÿç®¡ç†å‘˜"}
            
    except Exception as e:
        print(f"âŒ ç³»ç»Ÿçº§é”™è¯¯: {e}")
        return {"error": "ç³»ç»Ÿé”™è¯¯", "details": "è¯·è”ç³»æŠ€æœ¯æ”¯æŒ"}
```

---

## 9. ğŸ’¾ å¼‚å¸¸ä¿¡æ¯ä¿ç•™


### 9.1 ä¸ºä»€ä¹ˆè¦ä¿ç•™å¼‚å¸¸ä¿¡æ¯


å¼‚å¸¸ä¿¡æ¯å°±åƒ"çŠ¯ç½ªç°åœºçš„è¯æ®"ï¼Œå¸®åŠ©æˆ‘ä»¬ç†è§£ç¨‹åºåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆé—®é¢˜ã€‚ä¿ç•™å®Œæ•´çš„å¼‚å¸¸ä¿¡æ¯å¯¹è°ƒè¯•å’Œé—®é¢˜åˆ†æè‡³å…³é‡è¦ã€‚

**ğŸ¯ å¼‚å¸¸ä¿¡æ¯çš„é‡è¦æ€§**ï¼š
- **ğŸ” é—®é¢˜å®šä½**ï¼šå¿«é€Ÿæ‰¾åˆ°é”™è¯¯å‘ç”Ÿçš„ä½ç½®
- **ğŸ“Š é”™è¯¯åˆ†æ**ï¼šäº†è§£é”™è¯¯çš„ç±»å‹å’Œé¢‘ç‡  
- **ğŸ› ï¸ è°ƒè¯•ååŠ©**ï¼šä¸ºå¼€å‘è€…æä¾›è¯¦ç»†çš„é”™è¯¯ä¸Šä¸‹æ–‡
- **ğŸ“ æ—¥å¿—è®°å½•**ï¼šä¸ºç³»ç»Ÿç»´æŠ¤æä¾›å†å²è®°å½•

### 9.2 è·å–è¯¦ç»†å¼‚å¸¸ä¿¡æ¯


```python
import traceback
import sys
from datetime import datetime

def è¯¦ç»†å¼‚å¸¸è®°å½•å™¨(func):
    """
    è£…é¥°å™¨ï¼šè®°å½•å‡½æ•°æ‰§è¡Œä¸­çš„è¯¦ç»†å¼‚å¸¸ä¿¡æ¯
    """
    def wrapper(*args, **kwargs):
        try:
            return func(*args, **kwargs)
        except Exception as e:
            # è·å–å¼‚å¸¸çš„è¯¦ç»†ä¿¡æ¯
            å¼‚å¸¸ç±»å‹ = type(e).__name__
            å¼‚å¸¸æ¶ˆæ¯ = str(e)
            å¼‚å¸¸å‚æ•° = e.args
            
            # è·å–è°ƒç”¨æ ˆä¿¡æ¯
            _, _, tb = sys.exc_info()
            
            print(f"ğŸš¨ å¼‚å¸¸å‘ç”Ÿæ—¶é—´: {datetime.now()}")
            print(f"ğŸ“ å‘ç”Ÿå¼‚å¸¸çš„å‡½æ•°: {func.__name__}")
            print(f"ğŸ·ï¸ å¼‚å¸¸ç±»å‹: {å¼‚å¸¸ç±»å‹}")
            print(f"ğŸ“ å¼‚å¸¸æ¶ˆæ¯: {å¼‚å¸¸æ¶ˆæ¯}")
            print(f"ğŸ“‹ å¼‚å¸¸å‚æ•°: {å¼‚å¸¸å‚æ•°}")
            
            # æ‰“å°è°ƒç”¨æ ˆ
            print("\nğŸ“š è¯¦ç»†è°ƒç”¨æ ˆ:")
            traceback.print_tb(tb)
            
            # é‡æ–°æŠ›å‡ºå¼‚å¸¸
            raise
    
    return wrapper

@è¯¦ç»†å¼‚å¸¸è®°å½•å™¨
def æµ‹è¯•å‡½æ•°(x, y):
    """ç”¨äºæµ‹è¯•å¼‚å¸¸è®°å½•çš„å‡½æ•°"""
    if y == 0:
        raise ValueError("ä¸èƒ½é™¤ä»¥é›¶")
    return x / y

# æµ‹è¯•
# æµ‹è¯•å‡½æ•°(10, 0)
```

### 9.3 å¼‚å¸¸ä¿¡æ¯çš„æ ¼å¼åŒ–ä¿å­˜


```python
import json
import logging
from datetime import datetime

class å¼‚å¸¸ä¿¡æ¯æ”¶é›†å™¨:
    """
    ä¸“é—¨ç”¨äºæ”¶é›†å’Œæ ¼å¼åŒ–å¼‚å¸¸ä¿¡æ¯çš„ç±»
    """
    
    def __init__(self, log_file="error_log.json"):
        self.log_file = log_file
        
        # é…ç½®æ—¥å¿—
        logging.basicConfig(
            level=logging.ERROR,
            format='%(asctime)s - %(levelname)s - %(message)s'
        )
        self.logger = logging.getLogger(__name__)
    
    def æ”¶é›†å¼‚å¸¸ä¿¡æ¯(self, exception, context=None):
        """
        æ”¶é›†å¼‚å¸¸çš„è¯¦ç»†ä¿¡æ¯
        """
        import inspect
        
        # åŸºæœ¬å¼‚å¸¸ä¿¡æ¯
        å¼‚å¸¸ä¿¡æ¯ = {
            "æ—¶é—´": datetime.now().isoformat(),
            "å¼‚å¸¸ç±»å‹": type(exception).__name__,
            "å¼‚å¸¸æ¶ˆæ¯": str(exception),
            "å¼‚å¸¸å‚æ•°": exception.args,
        }
        
        # æ·»åŠ ä¸Šä¸‹æ–‡ä¿¡æ¯
        if context:
            å¼‚å¸¸ä¿¡æ¯["ä¸Šä¸‹æ–‡"] = context
        
        # è·å–è°ƒç”¨æ ˆä¿¡æ¯
        try:
            frame = inspect.currentframe()
            call_stack = []
            
            while frame:
                frame_info = {
                    "æ–‡ä»¶": frame.f_code.co_filename,
                    "å‡½æ•°": frame.f_code.co_name,
                    "è¡Œå·": frame.f_lineno,
                    "å±€éƒ¨å˜é‡": {k: str(v) for k, v in frame.f_locals.items() 
                               if not k.startswith('_')}
                }
                call_stack.append(frame_info)
                frame = frame.f_back
                
            å¼‚å¸¸ä¿¡æ¯["è°ƒç”¨æ ˆ"] = call_stack[:5]  # åªä¿ç•™å‰5å±‚
            
        except Exception:
            å¼‚å¸¸ä¿¡æ¯["è°ƒç”¨æ ˆ"] = "æ— æ³•è·å–è°ƒç”¨æ ˆä¿¡æ¯"
        
        return å¼‚å¸¸ä¿¡æ¯
    
    def ä¿å­˜å¼‚å¸¸ä¿¡æ¯(self, exception, context=None):
        """
        ä¿å­˜å¼‚å¸¸ä¿¡æ¯åˆ°æ–‡ä»¶å’Œæ—¥å¿—
        """
        å¼‚å¸¸ä¿¡æ¯ = self.æ”¶é›†å¼‚å¸¸ä¿¡æ¯(exception, context)
        
        # ä¿å­˜åˆ°JSONæ–‡ä»¶
        try:
            with open(self.log_file, 'a', encoding='utf-8') as f:
                json.dump(å¼‚å¸¸ä¿¡æ¯, f, ensure_ascii=False, indent=2)
                f.write('\n')
        except Exception:
            pass  # é¿å…åœ¨é”™è¯¯å¤„ç†ä¸­å†æ¬¡å‡ºé”™
        
        # è®°å½•åˆ°ç³»ç»Ÿæ—¥å¿—
        self.logger.error(f"å¼‚å¸¸: {å¼‚å¸¸ä¿¡æ¯['å¼‚å¸¸ç±»å‹']} - {å¼‚å¸¸ä¿¡æ¯['å¼‚å¸¸æ¶ˆæ¯']}")
        
        return å¼‚å¸¸ä¿¡æ¯

# ä½¿ç”¨ç¤ºä¾‹
def å¸¦å®Œæ•´å¼‚å¸¸è®°å½•çš„å‡½æ•°(data_list):
    """
    å±•ç¤ºå¦‚ä½•åœ¨å®é™…å‡½æ•°ä¸­ä½¿ç”¨å¼‚å¸¸ä¿¡æ¯æ”¶é›†å™¨
    """
    æ”¶é›†å™¨ = å¼‚å¸¸ä¿¡æ¯æ”¶é›†å™¨()
    
    try:
        print("ğŸ”„ å¼€å§‹å¤„ç†æ•°æ®...")
        
        results = []
        for i, item in enumerate(data_list):
            try:
                # æ¨¡æ‹Ÿå¯èƒ½å‡ºé”™çš„æ•°æ®å¤„ç†
                if isinstance(item, str) and item.isdigit():
                    result = int(item) * 2
                else:
                    raise ValueError(f"æ— æ•ˆçš„æ•°æ®æ ¼å¼: {item}")
                    
                results.append(result)
                
            except Exception as e:
                # è®°å½•å¼‚å¸¸ä½†ç»§ç»­å¤„ç†å…¶ä»–æ•°æ®
                context = {
                    "æ•°æ®ç´¢å¼•": i,
                    "å½“å‰æ•°æ®": item,
                    "å·²å¤„ç†æ•°é‡": len(results)
                }
                
                å¼‚å¸¸ä¿¡æ¯ = æ”¶é›†å™¨.ä¿å­˜å¼‚å¸¸ä¿¡æ¯(e, context)
                print(f"âš ï¸ ç¬¬ {i+1} é¡¹æ•°æ®å¤„ç†å¤±è´¥: {e}")
        
        print(f"âœ… å¤„ç†å®Œæˆï¼ŒæˆåŠŸ {len(results)} é¡¹")
        return results
        
    except Exception as e:
        # è®°å½•è‡´å‘½é”™è¯¯
        context = {
            "å‡½æ•°": "å¸¦å®Œæ•´å¼‚å¸¸è®°å½•çš„å‡½æ•°",
            "è¾“å…¥æ•°æ®": str(data_list)[:100] + "..." if len(str(data_list)) > 100 else str(data_list)
        }
        
        å¼‚å¸¸ä¿¡æ¯ = æ”¶é›†å™¨.ä¿å­˜å¼‚å¸¸ä¿¡æ¯(e, context)
        print(f"âŒ å‡½æ•°æ‰§è¡Œå¤±è´¥: {e}")
        raise
```

### 9.4 å¼‚å¸¸ä¿¡æ¯çš„æŸ¥è¯¢å’Œåˆ†æ


```python
class å¼‚å¸¸åˆ†æå™¨:
    """
    åˆ†æå¼‚å¸¸æ—¥å¿—ï¼Œæä¾›ç»Ÿè®¡å’ŒæŸ¥è¯¢åŠŸèƒ½
    """
    
    def __init__(self, log_file="error_log.json"):
        self.log_file = log_file
    
    def åˆ†æå¼‚å¸¸ç»Ÿè®¡(self, days=7):
        """
        åˆ†ææœ€è¿‘å‡ å¤©çš„å¼‚å¸¸ç»Ÿè®¡
        """
        import json
        from collections import Counter
        from datetime import datetime, timedelta
        
        try:
            with open(self.log_file, 'r', encoding='utf-8') as f:
                lines = f.readlines()
        except FileNotFoundError:
            print("ğŸ“‚ å¼‚å¸¸æ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨")
            return
        
        # è§£æå¼‚å¸¸è®°å½•
        å¼‚å¸¸è®°å½• = []
        for line in lines:
            try:
                record = json.loads(line.strip())
                å¼‚å¸¸è®°å½•.append(record)
            except json.JSONDecodeError:
                continue
        
        # è¿‡æ»¤æœ€è¿‘å‡ å¤©çš„è®°å½•
        cutoff_date = datetime.now() - timedelta(days=days)
        recent_records = [
            record for record in å¼‚å¸¸è®°å½•
            if datetime.fromisoformat(record['æ—¶é—´']) > cutoff_date
        ]
        
        if not recent_records:
            print(f"ğŸ“… æœ€è¿‘ {days} å¤©æ²¡æœ‰å¼‚å¸¸è®°å½•")
            return
        
        # ç»Ÿè®¡åˆ†æ
        print(f"ğŸ“Š æœ€è¿‘ {days} å¤©å¼‚å¸¸ç»Ÿè®¡æŠ¥å‘Š")
        print("=" * 50)
        
        # æŒ‰å¼‚å¸¸ç±»å‹ç»Ÿè®¡
        å¼‚å¸¸ç±»å‹ç»Ÿè®¡ = Counter(record['å¼‚å¸¸ç±»å‹'] for record in recent_records)
        print("\nğŸ·ï¸ å¼‚å¸¸ç±»å‹ç»Ÿè®¡:")
        for å¼‚å¸¸ç±»å‹, æ¬¡æ•° in å¼‚å¸¸ç±»å‹ç»Ÿè®¡.most_common():
            print(f"  {å¼‚å¸¸ç±»å‹}: {æ¬¡æ•°} æ¬¡")
        
        # æŒ‰æ—¥æœŸç»Ÿè®¡
        æ—¥æœŸç»Ÿè®¡ = Counter(
            datetime.fromisoformat(record['æ—¶é—´']).strftime('%Y-%m-%d')
            for record in recent_records
        )
        print("\nğŸ“… æ¯æ—¥å¼‚å¸¸ç»Ÿè®¡:")
        for æ—¥æœŸ, æ¬¡æ•° in sorted(æ—¥æœŸç»Ÿè®¡.items()):
            print(f"  {æ—¥æœŸ}: {æ¬¡æ•°} æ¬¡")
        
        # æœ€é¢‘ç¹çš„é”™è¯¯æ¶ˆæ¯
        æ¶ˆæ¯ç»Ÿè®¡ = Counter(record['å¼‚å¸¸æ¶ˆæ¯'] for record in recent_records)
        print("\nğŸ“ æœ€å¸¸è§çš„é”™è¯¯æ¶ˆæ¯:")
        for æ¶ˆæ¯, æ¬¡æ•° in æ¶ˆæ¯ç»Ÿè®¡.most_common(5):
            print(f"  {æ¬¡æ•°} æ¬¡: {æ¶ˆæ¯[:50]}{'...' if len(æ¶ˆæ¯) > 50 else ''}")
    
    def æŸ¥æ‰¾ç‰¹å®šå¼‚å¸¸(self, å¼‚å¸¸ç±»å‹=None, å…³é”®è¯=None, limit=10):
        """
        æŸ¥æ‰¾ç‰¹å®šç±»å‹æˆ–åŒ…å«å…³é”®è¯çš„å¼‚å¸¸
        """
        import json
        
        try:
            with open(self.log_file, 'r', encoding='utf-8') as f:
                lines = f.readlines()
        except FileNotFoundError:
            print("ğŸ“‚ å¼‚å¸¸æ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨")
            return []
        
        åŒ¹é…è®°å½• = []
        for line in lines:
            try:
                record = json.loads(line.strip())
                
                # æ£€æŸ¥å¼‚å¸¸ç±»å‹
                if å¼‚å¸¸ç±»å‹ and record['å¼‚å¸¸ç±»å‹'] != å¼‚å¸¸ç±»å‹:
                    continue
                
                # æ£€æŸ¥å…³é”®è¯
                if å…³é”®è¯:
                    record_text = json.dumps(record, ensure_ascii=False).lower()
                    if å…³é”®è¯.lower() not in record_text:
                        continue
                
                åŒ¹é…è®°å½•.append(record)
                
                if len(åŒ¹é…è®°å½•) >= limit:
                    break
                    
            except json.JSONDecodeError:
                continue
        
        print(f"ğŸ” æ‰¾åˆ° {len(åŒ¹é…è®°å½•)} æ¡åŒ¹é…è®°å½•:")
        for i, record in enumerate(åŒ¹é…è®°å½•, 1):
            print(f"\n{i}. {record['æ—¶é—´']} - {record['å¼‚å¸¸ç±»å‹']}")
            print(f"   æ¶ˆæ¯: {record['å¼‚å¸¸æ¶ˆæ¯']}")
            if record.get('ä¸Šä¸‹æ–‡'):
                print(f"   ä¸Šä¸‹æ–‡: {record['ä¸Šä¸‹æ–‡']}")
        
        return åŒ¹é…è®°å½•

# ä½¿ç”¨ç¤ºä¾‹
# åˆ†æå™¨ = å¼‚å¸¸åˆ†æå™¨()
# åˆ†æå™¨.åˆ†æå¼‚å¸¸ç»Ÿè®¡(days=30)  # åˆ†ææœ€è¿‘30å¤©çš„å¼‚å¸¸
# åˆ†æå™¨.æŸ¥æ‰¾ç‰¹å®šå¼‚å¸¸(å¼‚å¸¸ç±»å‹="ValueError", limit=5)  # æŸ¥æ‰¾ValueErrorç±»å‹çš„å¼‚å¸¸
```

---

## 10. âš¡ å¼‚å¸¸å¤„ç†æ€§èƒ½è€ƒè™‘


### 10.1 å¼‚å¸¸å¤„ç†çš„æ€§èƒ½å¼€é”€


å¼‚å¸¸å¤„ç†è™½ç„¶å¾ˆæœ‰ç”¨ï¼Œä½†ä¹Ÿæœ‰æ€§èƒ½æˆæœ¬ã€‚å°±åƒå®‰å…¨æªæ–½ä¸€æ ·ï¼Œè¿‡åº¦ä½¿ç”¨ä¼šå½±å“æ•ˆç‡ã€‚

**ğŸ” æ€§èƒ½å¼€é”€æ¥æº**ï¼š
- **ğŸ“š æ ˆå±•å¼€**ï¼šå¯»æ‰¾åˆé€‚çš„exceptå—éœ€è¦éå†è°ƒç”¨æ ˆ
- **ğŸ’¾ å¯¹è±¡åˆ›å»º**ï¼šæ¯ä¸ªå¼‚å¸¸éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œéœ€è¦å†…å­˜åˆ†é…
- **ğŸ”„ æµç¨‹è·³è½¬**ï¼šå¼‚å¸¸ä¼šæ‰“æ–­æ­£å¸¸çš„ä»£ç æ‰§è¡Œæµç¨‹
- **ğŸ“ ä¿¡æ¯æ”¶é›†**ï¼šæ”¶é›†è°ƒç”¨æ ˆå’Œä¸Šä¸‹æ–‡ä¿¡æ¯éœ€è¦æ—¶é—´

### 10.2 æ€§èƒ½æµ‹è¯•å¯¹æ¯”


```python
import time
import statistics

def æ€§èƒ½æµ‹è¯•_æ­£å¸¸æµç¨‹vså¼‚å¸¸æµç¨‹():
    """
    å¯¹æ¯”æ­£å¸¸æµç¨‹å’Œå¼‚å¸¸æµç¨‹çš„æ€§èƒ½å·®å¼‚
    """
    
    def æ­£å¸¸æµç¨‹å¤„ç†(numbers):
        """ä½¿ç”¨æ¡ä»¶åˆ¤æ–­é¿å…å¼‚å¸¸"""
        result = 0
        for num in numbers:
            if isinstance(num, (int, float)) and num != 0:
                result += 10 / num
        return result
    
    def å¼‚å¸¸æµç¨‹å¤„ç†(numbers):
        """ä½¿ç”¨å¼‚å¸¸å¤„ç†"""
        result = 0
        for num in numbers:
            try:
                result += 10 / num
            except (ZeroDivisionError, TypeError):
                pass  # è·³è¿‡æ— æ•ˆæ•°æ®
        return result
    
    # æµ‹è¯•æ•°æ®ï¼šå¤§éƒ¨åˆ†æ˜¯æ­£å¸¸æ•°æ®ï¼Œå°‘é‡å¼‚å¸¸æ•°æ®
    test_data = [1, 2, 3, 4, 5] * 1000 + [0, "abc", None] * 10
    
    # æµ‹è¯•æ­£å¸¸æµç¨‹
    times_normal = []
    for _ in range(100):
        start = time.perf_counter()
        æ­£å¸¸æµç¨‹å¤„ç†(test_data)
        end = time.perf_counter()
        times_normal.append(end - start)
    
    # æµ‹è¯•å¼‚å¸¸æµç¨‹
    times_exception = []
    for _ in range(100):
        start = time.perf_counter()
        å¼‚å¸¸æµç¨‹å¤„ç†(test_data)
        end = time.perf_counter()
        times_exception.append(end - start)
    
    # ç»“æœåˆ†æ
    avg_normal = statistics.mean(times_normal)
    avg_exception = statistics.mean(times_exception)
    
    print("âš¡ æ€§èƒ½æµ‹è¯•ç»“æœ:")
    print(f"ğŸŸ¢ æ­£å¸¸æµç¨‹å¹³å‡è€—æ—¶: {avg_normal:.6f} ç§’")
    print(f"ğŸ”´ å¼‚å¸¸æµç¨‹å¹³å‡è€—æ—¶: {avg_exception:.6f} ç§’")
    print(f"ğŸ“Š æ€§èƒ½å·®å¼‚: {avg_exception/avg_normal:.2f}x (å¼‚å¸¸æµç¨‹æ˜¯æ­£å¸¸æµç¨‹çš„å€æ•°)")

# è¿è¡Œæ€§èƒ½æµ‹è¯•
# æ€§èƒ½æµ‹è¯•_æ­£å¸¸æµç¨‹vså¼‚å¸¸æµç¨‹()
```

### 10.3 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


**ğŸš€ ä¼˜åŒ–åŸåˆ™**ï¼š

| ç­–ç•¥ | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| **ğŸ” é¢„æ£€æŸ¥** | ä½¿ç”¨ifæ¡ä»¶é¢„å…ˆæ£€æŸ¥ï¼Œé¿å…å¼‚å¸¸ | å¼‚å¸¸æƒ…å†µè¾ƒå°‘æ—¶ |
| **ğŸ“Š å¼‚å¸¸ä¼˜å…ˆ** | ç›´æ¥å°è¯•æ“ä½œï¼Œå¤±è´¥æ—¶å¤„ç†å¼‚å¸¸ | å¼‚å¸¸æƒ…å†µè¾ƒå¤šæ—¶ |
| **ğŸ¯ ç²¾ç¡®æ•è·** | åªæ•è·ç‰¹å®šçš„å¼‚å¸¸ç±»å‹ | æ‰€æœ‰æƒ…å†µ |
| **âš¡ å‡å°‘åµŒå¥—** | é¿å…è¿‡æ·±çš„å¼‚å¸¸å¤„ç†åµŒå¥— | å¤æ‚ä¸šåŠ¡é€»è¾‘ |

```python
class é«˜æ€§èƒ½æ•°æ®å¤„ç†å™¨:
    """
    å±•ç¤ºå„ç§æ€§èƒ½ä¼˜åŒ–ç­–ç•¥çš„æ•°æ®å¤„ç†å™¨
    """
    
    def __init__(self):
        self.é”™è¯¯ç»Ÿè®¡ = {"é¢„æ£€æŸ¥é¿å…": 0, "å¼‚å¸¸æ•è·": 0}
    
    def ç­–ç•¥1_é¢„æ£€æŸ¥ä¼˜å…ˆ(self, data_list):
        """
        ç­–ç•¥1ï¼šå¯¹äºå¯é¢„æµ‹çš„é”™è¯¯ï¼Œä½¿ç”¨é¢„æ£€æŸ¥
        é€‚ç”¨ï¼šå¼‚å¸¸æƒ…å†µç›¸å¯¹è¾ƒå°‘çš„åœºæ™¯
        """
        results = []
        
        for item in data_list:
            # é¢„æ£€æŸ¥é¿å…å¼‚å¸¸
            if isinstance(item, (int, float)) and item != 0:
                results.append(10 / item)
                self.é”™è¯¯ç»Ÿè®¡["é¢„æ£€æŸ¥é¿å…"] += 1
            # å¦‚æœçœŸçš„éœ€è¦å¼‚å¸¸å¤„ç†ï¼Œåªå¤„ç†é¢„æœŸå¤–çš„æƒ…å†µ
            elif isinstance(item, str) and item.replace('.', '').replace('-', '').isdigit():
                try:
                    num = float(item)
                    if num != 0:
                        results.append(10 / num)
                except ValueError:
                    self.é”™è¯¯ç»Ÿè®¡["å¼‚å¸¸æ•è·"] += 1
                    pass  # è·³è¿‡æ— æ•ˆæ•°æ®
        
        return results
    
    def ç­–ç•¥2_å¼‚å¸¸ä¼˜å…ˆ(self, data_list):
        """
        ç­–ç•¥2ï¼šå¯¹äºéš¾ä»¥é¢„æ£€æŸ¥çš„æƒ…å†µï¼Œç›´æ¥ä½¿ç”¨å¼‚å¸¸å¤„ç†
        é€‚ç”¨ï¼šå¼‚å¸¸æƒ…å†µè¾ƒå¤šï¼Œæˆ–æ£€æŸ¥æˆæœ¬é«˜çš„åœºæ™¯
        """
        results = []
        
        for item in data_list:
            try:
                # ç›´æ¥å°è¯•æ“ä½œï¼ŒPythonçš„"è¯·æ±‚åŸè°…è€Œéè®¸å¯"å“²å­¦
                if hasattr(item, '__float__'):
                    num = float(item)
                else:
                    num = item
                    
                result = 10 / num
                results.append(result)
                
            except (ZeroDivisionError, TypeError, ValueError):
                self.é”™è¯¯ç»Ÿè®¡["å¼‚å¸¸æ•è·"] += 1
                continue  # è·³è¿‡æ— æ•ˆæ•°æ®
        
        return results
    
    def ç­–ç•¥3_ç²¾ç¡®å¼‚å¸¸æ•è·(self, operations):
        """
        ç­–ç•¥3ï¼šç²¾ç¡®æ•è·ç‰¹å®šå¼‚å¸¸ï¼Œé¿å…æ•è·èŒƒå›´è¿‡å¤§
        """
        results = []
        
        for operation in operations:
            try:
                op_type = operation['type']
                args = operation['args']
                
                if op_type == 'divide':
                    result = args[0] / args[1]
                elif op_type == 'sqrt':
                    result = args[0] ** 0.5
                elif op_type == 'log':
                    import math
                    result = math.log(args[0])
                else:
                    raise ValueError(f"ä¸æ”¯æŒçš„æ“ä½œ: {op_type}")
                
                results.append(result)
                
            except ZeroDivisionError:
                # ç²¾ç¡®å¤„ç†é™¤é›¶é”™è¯¯
                print(f"âš ï¸ é™¤é›¶é”™è¯¯: {operation}")
                results.append(float('inf'))
                
            except ValueError as e:
                # ç²¾ç¡®å¤„ç†å€¼é”™è¯¯
                if "ä¸æ”¯æŒçš„æ“ä½œ" in str(e):
                    print(f"âŒ ä¸æ”¯æŒçš„æ“ä½œ: {operation}")
                else:
                    print(f"âŒ æ•°å€¼é”™è¯¯: {operation}")
                results.append(None)
                
            except KeyError:
                # ç²¾ç¡®å¤„ç†å­—å…¸é”®é”™è¯¯
                print(f"âŒ æ“ä½œæ ¼å¼é”™è¯¯: {operation}")
                results.append(None)
        
        return results
    
    def æ€§èƒ½åŸºå‡†æµ‹è¯•(self, test_data, iterations=1000):
        """
        æµ‹è¯•ä¸åŒç­–ç•¥çš„æ€§èƒ½
        """
        strategies = {
            "é¢„æ£€æŸ¥ä¼˜å…ˆ": self.ç­–ç•¥1_é¢„æ£€æŸ¥ä¼˜å…ˆ,
            "å¼‚å¸¸ä¼˜å…ˆ": self.ç­–ç•¥2_å¼‚å¸¸ä¼˜å…ˆ
        }
        
        results = {}
        
        for name, strategy in strategies.items():
            start_time = time.perf_counter()
            
            for _ in range(iterations):
                strategy(test_data)
            
            end_time = time.perf_counter()
            results[name] = end_time - start_time
        
        print("ğŸ“Š æ€§èƒ½åŸºå‡†æµ‹è¯•ç»“æœ:")
        for name, duration in results.items():
            print(f"  {name}: {duration:.4f} ç§’")
        
        return results
```

### 10.4 å¼‚å¸¸å¤„ç†çš„æœ€ä½³å®è·µ


```python
class å¼‚å¸¸å¤„ç†æœ€ä½³å®è·µç¤ºä¾‹:
    """
    ç»¼åˆå±•ç¤ºå¼‚å¸¸å¤„ç†çš„æœ€ä½³å®è·µ
    """
    
    def __init__(self):
        self.æ€§èƒ½è®¡æ•°å™¨ = {"fast_path": 0, "slow_path": 0}
    
    def æœ€ä½³å®è·µ_æ–‡ä»¶å¤„ç†(self, file_paths):
        """
        æ–‡ä»¶å¤„ç†çš„æœ€ä½³å®è·µ
        """
        successful_files = []
        failed_files = []
        
        for file_path in file_paths:
            try:
                # 1. ä½¿ç”¨withè¯­å¥è‡ªåŠ¨ç®¡ç†èµ„æº
                with open(file_path, 'r', encoding='utf-8') as f:
                    content = f.read()
                
                # 2. é¢„æ£€æŸ¥å¯ä»¥é¿å…çš„é—®é¢˜
                if not content.strip():
                    failed_files.append((file_path, "æ–‡ä»¶ä¸ºç©º"))
                    continue
                
                # 3. åªå¯¹çœŸæ­£éœ€è¦å¼‚å¸¸å¤„ç†çš„éƒ¨åˆ†ä½¿ç”¨try
                try:
                    data = self._parse_content(content)
                    successful_files.append((file_path, data))
                    self.æ€§èƒ½è®¡æ•°å™¨["fast_path"] += 1
                    
                except ValueError as e:
                    # 4. ç²¾ç¡®çš„å¼‚å¸¸ç±»å‹å’Œæœ‰æ„ä¹‰çš„é”™è¯¯ä¿¡æ¯
                    failed_files.append((file_path, f"æ•°æ®æ ¼å¼é”™è¯¯: {e}"))
                    self.æ€§èƒ½è®¡æ•°å™¨["slow_path"] += 1
                
            except FileNotFoundError:
                failed_files.append((file_path, "æ–‡ä»¶ä¸å­˜åœ¨"))
                self.æ€§èƒ½è®¡æ•°å™¨["slow_path"] += 1
                
            except PermissionError:
                failed_files.append((file_path, "æƒé™ä¸è¶³"))
                self.æ€§èƒ½è®¡æ•°å™¨["slow_path"] += 1
                
            # 5. ä¸æ•è·Exceptionï¼Œè®©çœŸæ­£çš„ç¨‹åºé”™è¯¯ä¼ æ’­
        
        return {
            'successful': successful_files,
            'failed': failed_files,
            'performance': self.æ€§èƒ½è®¡æ•°å™¨
        }
    
    def _parse_content(self, content):
        """è§£ææ–‡ä»¶å†…å®¹çš„è¾…åŠ©æ–¹æ³•"""
        # æ¨¡æ‹Ÿæ•°æ®è§£æï¼Œå¯èƒ½æŠ›å‡ºValueError
        lines = content.strip().split('\n')
        return [line.strip() for line in lines if line.strip()]
    
    def æœ€ä½³å®è·µ_ç½‘ç»œè¯·æ±‚(self, urls, timeout=5):
        """
        ç½‘ç»œè¯·æ±‚çš„æœ€ä½³å®è·µ
        """
        import time
        
        results = []
        
        for url in urls:
            # è®°å½•å¼€å§‹æ—¶é—´ç”¨äºè¶…æ—¶åˆ¤æ–­
            start_time = time.time()
            
            try:
                # 1. è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´
                response = self._simulate_request(url, timeout)
                
                # 2. å¿«é€Ÿè·¯å¾„ï¼šæ­£å¸¸æƒ…å†µä¸‹çš„å¤„ç†
                if response.get('status') == 200:
                    results.append({
                        'url': url,
                        'status': 'success',
                        'data': response.get('data'),
                        'duration': time.time() - start_time
                    })
                    self.æ€§èƒ½è®¡æ•°å™¨["fast_path"] += 1
                    continue
                
                # 3. å¤„ç†HTTPé”™è¯¯çŠ¶æ€
                results.append({
                    'url': url,
                    'status': 'http_error',
                    'error': f"HTTP {response.get('status')}",
                    'duration': time.time() - start_time
                })
                
            except TimeoutError:
                # 4. å…·ä½“çš„è¶…æ—¶å¤„ç†
                results.append({
                    'url': url,
                    'status': 'timeout',
                    'error': f'è¯·æ±‚è¶…æ—¶ (>{timeout}s)',
                    'duration': time.time() - start_time
                })
                self.æ€§èƒ½è®¡æ•°å™¨["slow_path"] += 1
                
            except ConnectionError:
                # 5. å…·ä½“çš„è¿æ¥é”™è¯¯å¤„ç†
                results.append({
                    'url': url,
                    'status': 'connection_error',
                    'error': 'ç½‘ç»œè¿æ¥å¤±è´¥',
                    'duration': time.time() - start_time
                })
                self.æ€§èƒ½è®¡æ•°å™¨["slow_path"] += 1
        
        return results
    
    def _simulate_request(self, url, timeout):
        """æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚çš„è¾…åŠ©æ–¹æ³•"""
        import random
        import time
        
        # æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
        delay = random.uniform(0.1, 1.0)
        if delay > timeout:
            raise TimeoutError("è¯·æ±‚è¶…æ—¶")
        
        time.sleep(delay)
        
        # æ¨¡æ‹Ÿä¸åŒçš„å“åº”æƒ…å†µ
        rand = random.random()
        if rand < 0.1:
            raise ConnectionError("ç½‘ç»œè¿æ¥å¤±è´¥")
        elif rand < 0.2:
            return {'status': 404, 'data': None}
        elif rand < 0.3:
            return {'status': 500, 'data': None}
        else:
            return {'status': 200, 'data': f'æ¥è‡ª {url} çš„æ•°æ®'}

# ä½¿ç”¨ç¤ºä¾‹
# å¤„ç†å™¨ = é«˜æ€§èƒ½æ•°æ®å¤„ç†å™¨()
# test_data = [1, 2, 3, 0, "5", "abc", 4.5, None] * 100
# å¤„ç†å™¨.æ€§èƒ½åŸºå‡†æµ‹è¯•(test_data, iterations=100)
```

### 10.5 å¼‚å¸¸å¤„ç†çš„è®¾è®¡æ¨¡å¼


```python
class æ–­è·¯å™¨æ¨¡å¼:
    """
    æ–­è·¯å™¨æ¨¡å¼ï¼šå½“å¼‚å¸¸å‘ç”Ÿé¢‘ç‡è¿‡é«˜æ—¶ï¼Œæš‚æ—¶åœæ­¢æ“ä½œ
    ç±»ä¼¼äºç”µè·¯ä¸­çš„ä¿é™©ä¸ï¼Œé˜²æ­¢ç³»ç»Ÿè¿‡è½½
    """
    
    def __init__(self, failure_threshold=5, recovery_timeout=60):
        self.failure_threshold = failure_threshold  # å¤±è´¥é˜ˆå€¼
        self.recovery_timeout = recovery_timeout    # æ¢å¤ç­‰å¾…æ—¶é—´
        self.failure_count = 0                      # å½“å‰å¤±è´¥æ¬¡æ•°
        self.last_failure_time = None               # æœ€åå¤±è´¥æ—¶é—´
        self.state = "CLOSED"  # CLOSED(æ­£å¸¸), OPEN(æ–­å¼€), HALF_OPEN(åŠå¼€)
    
    def call(self, func, *args, **kwargs):
        """
        æ‰§è¡Œå‡½æ•°è°ƒç”¨ï¼Œå¸¦æ–­è·¯å™¨ä¿æŠ¤
        """
        import time
        
        # æ£€æŸ¥æ–­è·¯å™¨çŠ¶æ€
        if self.state == "OPEN":
            # æ£€æŸ¥æ˜¯å¦å¯ä»¥å°è¯•æ¢å¤
            if time.time() - self.last_failure_time > self.recovery_timeout:
                self.state = "HALF_OPEN"
                print("ğŸ”„ æ–­è·¯å™¨è¿›å…¥åŠå¼€çŠ¶æ€ï¼Œå°è¯•æ¢å¤...")
            else:
                raise Exception("æ–­è·¯å™¨å¼€å¯ï¼Œæ‹’ç»è¯·æ±‚")
        
        try:
            # å°è¯•æ‰§è¡Œå‡½æ•°
            result = func(*args, **kwargs)
            
            # æˆåŠŸæ‰§è¡Œï¼Œé‡ç½®è®¡æ•°å™¨
            if self.state == "HALF_OPEN":
                self.state = "CLOSED"
                print("âœ… æ–­è·¯å™¨å·²æ¢å¤æ­£å¸¸çŠ¶æ€")
            
            self.failure_count = 0
            return result
            
        except Exception as e:
            # è®°å½•å¤±è´¥
            self.failure_count += 1
            self.last_failure_time = time.time()
            
            # æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰“å¼€æ–­è·¯å™¨
            if self.failure_count >= self.failure_threshold:
                self.state = "OPEN"
                print(f"ğŸš¨ æ–­è·¯å™¨æ‰“å¼€ï¼è¿ç»­å¤±è´¥ {self.failure_count} æ¬¡")
            
            raise e

class é‡è¯•æœºåˆ¶:
    """
    é‡è¯•æœºåˆ¶ï¼šè‡ªåŠ¨é‡è¯•å¤±è´¥çš„æ“ä½œ
    """
    
    def __init__(self, max_retries=3, backoff_factor=2):
        self.max_retries = max_retries
        self.backoff_factor = backoff_factor
    
    def retry_on_exception(self, exceptions=(Exception,)):
        """
        è£…é¥°å™¨ï¼šä¸ºå‡½æ•°æ·»åŠ é‡è¯•æœºåˆ¶
        """
        def decorator(func):
            def wrapper(*args, **kwargs):
                import time
                import random
                
                last_exception = None
                
                for attempt in range(self.max_retries + 1):
                    try:
                        return func(*args, **kwargs)
                        
                    except exceptions as e:
                        last_exception = e
                        
                        if attempt == self.max_retries:
                            print(f"âŒ é‡è¯• {self.max_retries} æ¬¡åä»ç„¶å¤±è´¥")
                            raise e
                        
                        # è®¡ç®—ç­‰å¾…æ—¶é—´ï¼ˆæŒ‡æ•°é€€é¿ + éšæœºæŠ–åŠ¨ï¼‰
                        wait_time = (self.backoff_factor ** attempt) + random.uniform(0, 1)
                        print(f"âš ï¸ ç¬¬ {attempt + 1} æ¬¡å°è¯•å¤±è´¥: {e}")
                        print(f"â° ç­‰å¾… {wait_time:.2f} ç§’åé‡è¯•...")
                        time.sleep(wait_time)
                
                raise last_exception
            
            return wrapper
        return decorator

# ä½¿ç”¨è®¾è®¡æ¨¡å¼çš„ç¤ºä¾‹
class å¯é çš„ç½‘ç»œæœåŠ¡:
    """
    ç»“åˆæ–­è·¯å™¨å’Œé‡è¯•æœºåˆ¶çš„å¯é ç½‘ç»œæœåŠ¡
    """
    
    def __init__(self):
        self.æ–­è·¯å™¨ = æ–­è·¯å™¨æ¨¡å¼(failure_threshold=3, recovery_timeout=30)
        self.é‡è¯•å™¨ = é‡è¯•æœºåˆ¶(max_retries=3, backoff_factor=1.5)
    
    @é‡è¯•å™¨.retry_on_exception((ConnectionError, TimeoutError))
    def å¯é çš„APIè°ƒç”¨(self, endpoint, data=None):
        """
        å¸¦é‡è¯•å’Œæ–­è·¯å™¨ä¿æŠ¤çš„APIè°ƒç”¨
        """
        def _actual_api_call():
            # æ¨¡æ‹Ÿå¯èƒ½å¤±è´¥çš„APIè°ƒç”¨
            import random
            if random.random() < 0.3:  # 30%çš„å¤±è´¥ç‡
                if random.random() < 0.5:
                    raise ConnectionError("ç½‘ç»œè¿æ¥å¤±è´¥")
                else:
                    raise TimeoutError("è¯·æ±‚è¶…æ—¶")
            
            return f"æˆåŠŸè°ƒç”¨ {endpoint}ï¼Œæ•°æ®: {data}"
        
        # ä½¿ç”¨æ–­è·¯å™¨ä¿æŠ¤
        return self.æ–­è·¯å™¨.call(_actual_api_call)
    
    def æ‰¹é‡å¤„ç†è¯·æ±‚(self, requests):
        """
        æ‰¹é‡å¤„ç†å¤šä¸ªè¯·æ±‚
        """
        results = []
        
        for i, request in enumerate(requests):
            try:
                print(f"\nğŸ“¡ å¤„ç†è¯·æ±‚ {i+1}/{len(requests)}: {request['endpoint']}")
                result = self.å¯é çš„APIè°ƒç”¨(request['endpoint'], request.get('data'))
                results.append({
                    'request': request,
                    'status': 'success',
                    'result': result
                })
                
            except Exception as e:
                print(f"âŒ è¯·æ±‚å¤±è´¥: {e}")
                results.append({
                    'request': request,
                    'status': 'failed',
                    'error': str(e)
                })
        
        return results

# æµ‹è¯•ç¤ºä¾‹
# æœåŠ¡ = å¯é çš„ç½‘ç»œæœåŠ¡()
# è¯·æ±‚åˆ—è¡¨ = [
#     {'endpoint': '/api/users', 'data': {'page': 1}},
#     {'endpoint': '/api/orders', 'data': {'status': 'pending'}},
#     {'endpoint': '/api/products', 'data': None},
# ] * 3
# 
# ç»“æœ = æœåŠ¡.æ‰¹é‡å¤„ç†è¯·æ±‚(è¯·æ±‚åˆ—è¡¨)
# print(f"\nğŸ“Š å¤„ç†å®Œæˆï¼ŒæˆåŠŸ: {sum(1 for r in ç»“æœ if r['status'] == 'success')} ä¸ª")
```

---

## 11. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 11.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å¼‚å¸¸å¤„ç†æœ¬è´¨ï¼šç¨‹åºé‡åˆ°æ„å¤–æƒ…å†µçš„"åº”æ€¥é¢„æ¡ˆ"
ğŸ”¸ åŸºæœ¬ç»“æ„ï¼štry-except-else-finally çš„å®Œæ•´æµç¨‹
ğŸ”¸ æ‰§è¡Œé¡ºåºï¼štry â†’ except(å¦‚æœæœ‰å¼‚å¸¸) â†’ else(å¦‚æœæ— å¼‚å¸¸) â†’ finally(æ€»æ˜¯æ‰§è¡Œ)
ğŸ”¸ å¼‚å¸¸ä¼ æ’­ï¼šä»åº•å±‚åˆ°ä¸Šå±‚çš„"æ¥åŠ›ä¼ é€’"æœºåˆ¶
ğŸ”¸ æ€§èƒ½è€ƒè™‘ï¼šåˆç†ä½¿ç”¨ï¼Œé¿å…æ€§èƒ½ç“¶é¢ˆ
```

### 11.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä½•æ—¶ä½¿ç”¨å¼‚å¸¸å¤„ç†**
```
é€‚ç”¨åœºæ™¯ï¼š
âœ… æ–‡ä»¶æ“ä½œï¼šæ–‡ä»¶å¯èƒ½ä¸å­˜åœ¨æˆ–æ— æƒé™
âœ… ç½‘ç»œè¯·æ±‚ï¼šè¿æ¥å¯èƒ½è¶…æ—¶æˆ–å¤±è´¥
âœ… æ•°æ®è½¬æ¢ï¼šç”¨æˆ·è¾“å…¥å¯èƒ½æ ¼å¼é”™è¯¯
âœ… èµ„æºç®¡ç†ï¼šéœ€è¦ç¡®ä¿èµ„æºæ­£ç¡®é‡Šæ”¾

ä¸é€‚ç”¨åœºæ™¯ï¼š
âŒ æ­£å¸¸çš„ç¨‹åºé€»è¾‘æ§åˆ¶
âŒ å¯ä»¥ç”¨ç®€å•if-elseå¤„ç†çš„æƒ…å†µ
âŒ é«˜é¢‘æ‰§è¡Œçš„æ€§èƒ½æ•æ„Ÿä»£ç 
```

**ğŸ”¹ å¼‚å¸¸å¤„ç†çš„å±‚æ¬¡æ€è€ƒ**
```
å¼‚å¸¸å¤„ç†çš„ä¸‰ä¸ªå±‚æ¬¡ï¼š

1ï¸âƒ£ æŠ€æœ¯å±‚é¢ï¼šæ•è·å’Œå¤„ç†å…·ä½“çš„æŠ€æœ¯é”™è¯¯
2ï¸âƒ£ ä¸šåŠ¡å±‚é¢ï¼šå°†æŠ€æœ¯é”™è¯¯è½¬æ¢ä¸ºä¸šåŠ¡å«ä¹‰
3ï¸âƒ£ ç”¨æˆ·å±‚é¢ï¼šä¸ºç”¨æˆ·æä¾›å‹å¥½çš„é”™è¯¯æç¤º
```

**ğŸ”¹ æœ€ä½³å®è·µåŸåˆ™**
```
ğŸ¯ ç²¾ç¡®æ•è·ï¼šåªæ•è·ä½ èƒ½å¤„ç†çš„å¼‚å¸¸
ğŸ›¡ï¸ èµ„æºä¿æŠ¤ï¼šä½¿ç”¨finallyæˆ–withç¡®ä¿èµ„æºæ¸…ç†
ğŸ“ ä¿¡æ¯è®°å½•ï¼šä¿ç•™è¶³å¤Ÿçš„å¼‚å¸¸ä¿¡æ¯ç”¨äºè°ƒè¯•
ğŸš€ æ€§èƒ½ä¼˜å…ˆï¼šåœ¨æ€§èƒ½æ•æ„Ÿåœºæ™¯ä¼˜å…ˆä½¿ç”¨é¢„æ£€æŸ¥
ğŸ”„ ä¼˜é›…é™çº§ï¼šå¼‚å¸¸æ—¶æä¾›åˆç†çš„å¤‡é€‰æ–¹æ¡ˆ
```

### 11.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ“Š å¼‚å¸¸å¤„ç†ç­–ç•¥é€‰æ‹©è¡¨**

| åœºæ™¯ç±»å‹ | æ¨èç­–ç•¥ | ç¤ºä¾‹ä»£ç æ¨¡å¼ |
|---------|---------|-------------|
| **ğŸ”¢ æ•°æ®éªŒè¯** | é¢„æ£€æŸ¥ + å¼‚å¸¸å…œåº• | `if isinstance(x, int): ... else: try: int(x)` |
| **ğŸ“ æ–‡ä»¶æ“ä½œ** | å¼‚å¸¸ä¼˜å…ˆ + èµ„æºä¿æŠ¤ | `try: with open(...) except FileNotFoundError:` |
| **ğŸŒ ç½‘ç»œè¯·æ±‚** | é‡è¯• + æ–­è·¯å™¨ + å¼‚å¸¸é“¾ | `@retry try: ... except ConnectionError: ... from e` |
| **ğŸ”„ æ‰¹é‡å¤„ç†** | å®¹é”™ç»§ç»­ + è¯¦ç»†è®°å½• | `for item: try: ... except: log(...); continue` |

**ğŸ“ å­¦ä¹ è¿›é˜¶è·¯å¾„**

```
åˆå­¦é˜¶æ®µï¼š
1. æŒæ¡åŸºæœ¬çš„try-exceptè¯­æ³•
2. ç†è§£å¸¸è§å¼‚å¸¸ç±»å‹
3. å­¦ä¼šä½¿ç”¨finallyæ¸…ç†èµ„æº

è¿›é˜¶é˜¶æ®µï¼š
4. æŒæ¡å¼‚å¸¸é“¾å’Œé‡æ–°æŠ›å‡º
5. ç†è§£æ€§èƒ½å½±å“å’Œä¼˜åŒ–ç­–ç•¥
6. å­¦ä¼šè®¾è®¡å¼‚å¸¸å¤„ç†æ¶æ„

é«˜çº§é˜¶æ®µï¼š
7. å®ç°è‡ªå®šä¹‰å¼‚å¸¸ç±»
8. ä½¿ç”¨è£…é¥°å™¨ç®€åŒ–å¼‚å¸¸å¤„ç†
9. ç»“åˆè®¾è®¡æ¨¡å¼è§£å†³å¤æ‚é—®é¢˜
```

### 11.4 å¸¸è§é™·é˜±ä¸é¿å…æ–¹æ³•


**âš ï¸ å¸¸è§é”™è¯¯æ¨¡å¼**

```python
# âŒ é”™è¯¯ï¼šæ•è·æ‰€æœ‰å¼‚å¸¸
try:
    some_operation()
except:  # å¤ªå®½æ³›äº†ï¼
    pass

# âœ… æ­£ç¡®ï¼šç²¾ç¡®æ•è·
try:
    some_operation()
except (ValueError, TypeError) as e:
    handle_specific_error(e)

# âŒ é”™è¯¯ï¼šå¿½ç•¥å¼‚å¸¸ä¿¡æ¯
try:
    risky_operation()
except Exception:
    print("å‡ºé”™äº†")  # æ²¡æœ‰æœ‰ç”¨ä¿¡æ¯

# âœ… æ­£ç¡®ï¼šä¿ç•™å¼‚å¸¸ä¿¡æ¯
try:
    risky_operation()
except Exception as e:
    logger.error(f"æ“ä½œå¤±è´¥: {e}", exc_info=True)

# âŒ é”™è¯¯ï¼šåœ¨å¾ªç¯ä¸­æ•è·å¼‚å¸¸ä½†æ²¡æœ‰ç»§ç»­
for item in items:
    try:
        process(item)
    except:
        break  # ä¸€ä¸ªå¤±è´¥å°±å…¨éƒ¨åœæ­¢

# âœ… æ­£ç¡®ï¼šå®¹é”™å¤„ç†
for item in items:
    try:
        process(item)
    except Exception as e:
        log_error(f"å¤„ç† {item} å¤±è´¥: {e}")
        continue  # ç»§ç»­å¤„ç†å…¶ä»–é¡¹ç›®
```

### 11.5 è®°å¿†å£è¯€å’Œé€ŸæŸ¥è¡¨


**ğŸ§  è®°å¿†å£è¯€**
```
å¼‚å¸¸å¤„ç†è¦è®°ç‰¢ï¼Œtry-exceptæ˜¯æ³•å®
elseæˆåŠŸæ‰æ‰§è¡Œï¼Œfinallyæ€»æ˜¯è·‘
æ•è·å¼‚å¸¸è¦ç²¾ç¡®ï¼Œä¿¡æ¯ä¿ç•™å¾ˆé‡è¦
æ€§èƒ½å½±å“è¦è€ƒè™‘ï¼Œé¢„æ£€æŸ¥å…ˆæ€è€ƒ
é‡æ–°æŠ›å‡ºåŠ ä¸Šä¸‹æ–‡ï¼Œå¼‚å¸¸é“¾æ¡ä¸èƒ½å°‘
```

**ğŸ“‹ å¿«é€Ÿå‚è€ƒè¡¨**

```
åŸºæœ¬è¯­æ³•ï¼š
try:     # å°è¯•æ‰§è¡Œ
except:  # å¼‚å¸¸å¤„ç†  
else:    # æˆåŠŸæ‰§è¡Œ
finally: # æ€»æ˜¯æ‰§è¡Œ

å¸¸è§å¼‚å¸¸ï¼š
ValueError      â†’ å€¼é”™è¯¯ï¼ˆç±»å‹å¯¹ï¼Œå€¼ä¸å¯¹ï¼‰
TypeError       â†’ ç±»å‹é”™è¯¯ï¼ˆç±»å‹ä¸å¯¹ï¼‰
IndexError      â†’ ç´¢å¼•é”™è¯¯ï¼ˆè¶…å‡ºèŒƒå›´ï¼‰
KeyError        â†’ é”®é”™è¯¯ï¼ˆå­—å…¸é”®ä¸å­˜åœ¨ï¼‰
FileNotFoundError â†’ æ–‡ä»¶ä¸å­˜åœ¨
ZeroDivisionError â†’ é™¤é›¶é”™è¯¯

æ€§èƒ½åŸåˆ™ï¼š
å¼‚å¸¸å°‘ â†’ ç”¨å¼‚å¸¸å¤„ç†
å¼‚å¸¸å¤š â†’ ç”¨é¢„æ£€æŸ¥
ä¸ç¡®å®š â†’ æ€§èƒ½æµ‹è¯•å†³å®š
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- å¼‚å¸¸å¤„ç†æ˜¯Pythonç¨‹åºå¥å£®æ€§çš„åŸºçŸ³
- åˆç†çš„å¼‚å¸¸å¤„ç†è®©ç¨‹åºæ›´å¯é ã€æ›´ç”¨æˆ·å‹å¥½
- æŒæ¡å¼‚å¸¸å¤„ç†ä¸ä»…æ˜¯æŠ€æœ¯æŠ€èƒ½ï¼Œæ›´æ˜¯ç¼–ç¨‹æ€ç»´çš„ä½“ç°
- åœ¨ä¿è¯åŠŸèƒ½æ­£ç¡®çš„å‰æä¸‹ï¼Œè€ƒè™‘æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒçš„å¹³è¡¡