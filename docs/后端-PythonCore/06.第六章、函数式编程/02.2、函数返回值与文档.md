---
title: 2、函数返回值与文档
---
## 📚 目录

1. [函数返回值基础](#1-函数返回值基础)
2. [多返回值技巧](#2-多返回值技巧)
3. [无返回值函数处理](#3-无返回值函数处理)
4. [函数文档字符串](#4-函数文档字符串)
5. [函数注解与类型提示](#5-函数注解与类型提示)
6. [函数签名检查](#6-函数签名检查)
7. [函数帮助信息](#7-函数帮助信息)
8. [函数元信息访问](#8-函数元信息访问)
9. [核心要点总结](#9-核心要点总结)

---

## 1. 🔄 函数返回值基础


### 1.1 return语句是什么


💭 **简单理解**：`return`就像快递员给你送包裹，函数干完活后把结果"送回来"给调用者。

🏷️ **专业术语**：`return语句` = 函数执行完毕后，将结果返回给调用方的语句

```python
# 最简单的返回值示例
def add_numbers(a, b):
    result = a + b
    return result  # 把计算结果返回给调用者

# 调用函数并接收返回值
sum_value = add_numbers(3, 5)
print(sum_value)  # 输出：8
```

### 1.2 return语句的工作机制


🔍 **深入理解**：return做了两件事
1. **终止函数执行**：一旦遇到return，函数立即停止
2. **返回数据**：把return后面的值传递给调用者

```python
def check_age(age):
    if age < 18:
        return "未成年"  # 如果年龄小于18，直接返回，下面的代码不执行
    
    # 只有age >= 18时，才会执行到这里
    return "成年人"

# 测试
print(check_age(15))  # 输出：未成年
print(check_age(25))  # 输出：成年人
```

### 1.3 返回值的数据类型


🌰 **举个例子**：函数可以返回任何Python数据类型，就像商店可以卖任何商品一样。

```python
# 返回数字
def get_price():
    return 99.9

# 返回字符串
def get_name():
    return "张三"

# 返回列表
def get_scores():
    return [85, 92, 78, 96]

# 返回字典
def get_student_info():
    return {"name": "李四", "age": 20, "score": 85}

# 返回布尔值
def is_pass(score):
    return score >= 60
```

---

## 2. 🎯 多返回值技巧


### 2.1 为什么需要多返回值


💭 **思考一下**：有时候一个函数需要告诉你多个结果，比如计算圆形的周长和面积，或者处理数据时既要返回结果又要返回状态。

🌰 **生活例子**：去银行取钱，你希望知道取了多少钱，还剩多少钱，这就是两个返回值。

### 2.2 元组方式返回多个值


📋 **核心机制**：Python用元组（tuple）打包多个值，一次性返回。

```python
import math

def calc_circle(radius):
    """计算圆形的周长和面积"""
    circumference = 2 * math.pi * radius
    area = math.pi * radius ** 2
    return circumference, area  # 返回两个值，自动打包成元组

# 接收多个返回值
c, a = calc_circle(5)  # 自动解包
print(f"周长: {c:.2f}, 面积: {a:.2f}")

# 也可以接收为一个元组
result = calc_circle(5)
print(f"结果元组: {result}")  # (31.42, 78.54)
```

### 2.3 实用的多返回值场景


🛠️ **实际应用**：处理文件操作，同时返回成功状态和数据

```python
def read_user_file(filename):
    """读取用户文件，返回状态和内容"""
    try:
        with open(filename, 'r', encoding='utf-8') as file:
            content = file.read()
            return True, content  # 成功时返回True和内容
    except FileNotFoundError:
        return False, "文件不存在"  # 失败时返回False和错误信息
    except Exception as e:
        return False, f"读取错误: {str(e)}"

# 使用示例
success, data = read_user_file("config.txt")
if success:
    print(f"文件内容: {data}")
else:
    print(f"读取失败: {data}")
```

### 2.4 命名返回值（namedtuple）


💡 **进阶技巧**：使用命名元组让返回值更清晰

```python
from collections import namedtuple

# 定义命名元组
CircleResult = namedtuple('CircleResult', ['circumference', 'area'])

def calc_circle_named(radius):
    """使用命名元组返回圆形计算结果"""
    circumference = 2 * math.pi * radius
    area = math.pi * radius ** 2
    return CircleResult(circumference, area)

# 使用命名返回值
result = calc_circle_named(5)
print(f"周长: {result.circumference:.2f}")  # 通过名称访问
print(f"面积: {result.area:.2f}")
```

---

## 3. ⭕ 无返回值函数处理


### 3.1 什么是无返回值函数


🏷️ **专业术语**：`无返回值函数` = 不需要返回数据给调用者的函数，主要执行操作或产生副作用

🌰 **举个例子**：打印信息、保存文件、发送邮件等操作，重点是"做事情"而不是"返回结果"。

```python
def print_welcome(name):
    """打印欢迎信息 - 无需返回值"""
    print(f"欢迎你，{name}！")
    print("希望你使用愉快！")

# 调用无返回值函数
print_welcome("小明")  # 只执行操作，不获取返回值
```

### 3.2 Python中的None返回值


🔍 **重要概念**：Python中所有函数都有返回值，没有明确return的函数自动返回`None`。

```python
def save_data(data):
    """保存数据到文件"""
    with open("data.txt", "w") as file:
        file.write(str(data))
    # 没有return语句，自动返回None

# 测试返回值
result = save_data("测试数据")
print(f"函数返回值: {result}")  # 输出：None
print(f"返回值类型: {type(result)}")  # 输出：<class 'NoneType'>
```

### 3.3 显式返回None的场景


💭 **为什么这样**：有时我们需要明确表示"没有有效结果"

```python
def find_student(students, name):
    """在学生列表中查找指定学生"""
    for student in students:
        if student['name'] == name:
            return student  # 找到了，返回学生信息
    
    return None  # 没找到，明确返回None

# 使用示例
students = [
    {"name": "张三", "age": 20},
    {"name": "李四", "age": 21}
]

student = find_student(students, "王五")
if student is None:
    print("未找到该学生")
else:
    print(f"找到学生: {student}")
```

### 3.4 检查None返回值的最佳实践


✅ **正确做法**：使用`is None`而不是`== None`

```python
def process_data(data):
    if not data:
        return None
    return data.upper()

# 正确的None检查方式
result = process_data("")
if result is None:  # 推荐写法
    print("处理失败")

# 避免的写法
if result == None:  # 不推荐
    print("处理失败")
```

---

## 4. 📝 函数文档字符串


### 4.1 什么是文档字符串


🏷️ **专业术语**：`文档字符串(docstring)` = 写在函数开头的特殊字符串，用于描述函数的功能、参数和返回值

💭 **简单理解**：就像产品说明书，告诉别人这个函数是干什么的，怎么用。

```python
def calculate_bmi(weight, height):
    """
    计算身体质量指数(BMI)
    
    参数:
        weight (float): 体重，单位为公斤
        height (float): 身高，单位为米
    
    返回:
        float: BMI指数值
    """
    return weight / (height ** 2)
```

### 4.2 文档字符串的写法规范


📋 **标准格式**：遵循Python社区约定的格式

```python
def send_email(to_email, subject, content, cc=None):
    """
    发送电子邮件
    
    这个函数用于发送电子邮件给指定收件人。支持抄送功能。
    
    Args:
        to_email (str): 收件人邮箱地址
        subject (str): 邮件主题
        content (str): 邮件正文内容
        cc (list, optional): 抄送邮箱列表，默认为None
    
    Returns:
        bool: 发送成功返回True，失败返回False
    
    Raises:
        ValueError: 当邮箱地址格式错误时抛出
        ConnectionError: 当网络连接失败时抛出
    
    Example:
        >>> send_email("user@example.com", "问候", "你好！")
        True
    """
    # 函数实现代码...
    return True
```

### 4.3 不同风格的文档字符串


📖 **风格选择**：Google风格（推荐）vs NumPy风格

```python
# Google风格（推荐，简洁清晰）
def divide_numbers(a, b):
    """
    除法运算函数
    
    Args:
        a (float): 被除数
        b (float): 除数，不能为0
    
    Returns:
        float: 除法结果
    
    Raises:
        ZeroDivisionError: 当除数为0时
    """
    if b == 0:
        raise ZeroDivisionError("除数不能为0")
    return a / b

# NumPy风格（适合科学计算）
def calculate_statistics(data):
    """
    计算数据的统计信息
    
    Parameters
    ----------
    data : list of float
        输入的数值数据列表
    
    Returns
    -------
    dict
        包含平均值、最大值、最小值的字典
    """
    return {
        'mean': sum(data) / len(data),
        'max': max(data),
        'min': min(data)
    }
```

### 4.4 访问和使用文档字符串


🔍 **如何查看**：使用`help()`函数或`__doc__`属性

```python
def greet_user(name, greeting="你好"):
    """
    向用户打招呼
    
    Args:
        name (str): 用户姓名
        greeting (str): 问候语，默认为"你好"
    
    Returns:
        str: 完整的问候语句
    """
    return f"{greeting}，{name}！"

# 查看函数文档
print(greet_user.__doc__)  # 直接访问文档字符串
help(greet_user)  # 显示完整帮助信息
```

---

## 5. 🏷️ 函数注解与类型提示


### 5.1 什么是类型提示


🏷️ **专业术语**：`类型提示(Type Hints)` = 在函数定义时标明参数和返回值的数据类型，帮助代码阅读和IDE检查

💭 **为什么需要**：Python是动态类型语言，类型提示让代码更清晰，IDE能提供更好的支持。

```python
# 没有类型提示的函数
def add(a, b):
    return a + b

# 有类型提示的函数
def add_with_hints(a: int, b: int) -> int:
    """带类型提示的加法函数"""
    return a + b
```

### 5.2 基本类型注解语法


📋 **基础语法**：参数类型用冒号，返回值类型用箭头

```python
def basic_types_demo(
    name: str,           # 字符串类型
    age: int,            # 整数类型
    height: float,       # 浮点数类型
    is_student: bool,    # 布尔类型
    scores: list         # 列表类型
) -> dict:               # 返回字典类型
    """基本类型注解示例"""
    return {
        "name": name,
        "age": age,
        "height": height,
        "is_student": is_student,
        "average_score": sum(scores) / len(scores)
    }
```

### 5.3 复杂类型注解


🔍 **进阶用法**：使用typing模块进行复杂类型标注

```python
from typing import List, Dict, Optional, Union, Tuple

def process_student_data(
    students: List[Dict[str, Union[str, int]]],  # 学生信息列表
    filter_age: Optional[int] = None             # 可选的年龄过滤
) -> Tuple[int, List[str]]:                      # 返回元组
    """
    处理学生数据
    
    Args:
        students: 学生信息列表，每个学生是包含姓名和年龄的字典
        filter_age: 可选的年龄过滤条件
    
    Returns:
        tuple: (符合条件的学生数量, 学生姓名列表)
    """
    if filter_age is None:
        valid_students = students
    else:
        valid_students = [s for s in students if s['age'] >= filter_age]
    
    count = len(valid_students)
    names = [s['name'] for s in valid_students]
    
    return count, names

# 使用示例
students_data = [
    {"name": "张三", "age": 20},
    {"name": "李四", "age": 18},
    {"name": "王五", "age": 22}
]

count, names = process_student_data(students_data, filter_age=19)
print(f"符合条件的学生: {count}人, 名单: {names}")
```

### 5.4 类型提示的实际价值


💡 **实际好处**：

| 好处 | 说明 | 示例 |
|------|------|------|
| **代码可读性** | 一眼看出函数期望什么类型 | `def calc(price: float) -> float` |
| **IDE支持** | 自动补全和错误检查 | IDE会提示字符串方法 |
| **类型检查** | 使用mypy等工具检查类型错误 | 发现传错参数类型 |
| **文档作用** | 类型就是最好的文档 | 不用猜参数类型 |

```python
# IDE能提供更好的支持
def format_currency(amount: float, currency: str = "¥") -> str:
    """格式化货币显示"""
    return f"{currency}{amount:.2f}"

# 当你输入amount.时，IDE知道这是float，会提示float的方法
# 当你输入currency.时，IDE知道这是str，会提示字符串方法
```

---

## 6. 🔍 函数签名检查


### 6.1 什么是函数签名


🏷️ **专业术语**：`函数签名(Function Signature)` = 函数的名称、参数列表、参数类型、返回类型等信息的组合

🌰 **简单理解**：就像人的身份证，包含了函数的所有基本信息。

### 6.2 使用inspect模块检查函数


📋 **inspect.signature()的作用**：获取函数的详细参数信息

```python
import inspect
from typing import List, Optional

def example_function(
    name: str,
    age: int,
    scores: List[float],
    city: str = "北京",
    phone: Optional[str] = None
) -> dict:
    """示例函数用于演示签名检查"""
    return {"name": name, "age": age, "city": city}

# 获取函数签名
sig = inspect.signature(example_function)
print(f"函数签名: {sig}")

# 检查参数信息
for param_name, param in sig.parameters.items():
    print(f"参数名: {param_name}")
    print(f"  默认值: {param.default}")
    print(f"  注解: {param.annotation}")
    print(f"  类型: {param.kind}")
    print("---")
```

### 6.3 参数验证和动态调用


🛠️ **实际应用**：在函数调用前验证参数

```python
def validate_and_call(func, **kwargs):
    """验证参数并调用函数"""
    sig = inspect.signature(func)
    
    # 检查必需参数
    for param_name, param in sig.parameters.items():
        if param.default is param.empty and param_name not in kwargs:
            raise ValueError(f"缺少必需参数: {param_name}")
    
    # 检查多余参数
    for kwarg_name in kwargs:
        if kwarg_name not in sig.parameters:
            raise ValueError(f"未知参数: {kwarg_name}")
    
    # 调用函数
    return func(**kwargs)

# 使用示例
try:
    result = validate_and_call(
        example_function,
        name="张三",
        age=25,
        scores=[85.5, 92.0, 78.5]
    )
    print(f"调用成功: {result}")
except ValueError as e:
    print(f"参数错误: {e}")
```

### 6.4 获取函数的详细信息


🔍 **深入了解**：inspect模块的其他有用功能

```python
def analyze_function(func):
    """分析函数的各种信息"""
    print(f"函数名: {func.__name__}")
    print(f"模块: {func.__module__}")
    print(f"文档: {func.__doc__}")
    
    # 获取源代码（如果可用）
    try:
        source = inspect.getsource(func)
        print(f"源代码长度: {len(source)}字符")
    except OSError:
        print("无法获取源代码")
    
    # 检查函数属性
    sig = inspect.signature(func)
    print(f"参数个数: {len(sig.parameters)}")
    print(f"返回值注解: {sig.return_annotation}")

# 分析我们的示例函数
analyze_function(example_function)
```

---

## 7. ❓ 函数帮助信息


### 7.1 内置help()函数的使用


💭 **简单理解**：`help()`就像字典，帮你查函数怎么用

```python
def calculate_interest(
    principal: float,
    rate: float,
    years: int,
    compound: bool = False
) -> float:
    """
    计算利息
    
    Args:
        principal: 本金金额
        rate: 年利率（小数形式，如0.05表示5%）
        years: 投资年数
        compound: 是否复利计算，默认False
    
    Returns:
        计算得出的利息金额
    
    Examples:
        >>> calculate_interest(1000, 0.05, 2)
        100.0
        >>> calculate_interest(1000, 0.05, 2, compound=True)
        102.5
    """
    if compound:
        return principal * ((1 + rate) ** years) - principal
    else:
        return principal * rate * years

# 查看函数帮助
help(calculate_interest)
```

### 7.2 自定义帮助信息


🛠️ **进阶技巧**：为复杂函数提供更详细的帮助

```python
class FunctionHelper:
    """函数帮助工具类"""
    
    @staticmethod
    def show_examples(func):
        """显示函数使用示例"""
        examples = {
            'calculate_interest': [
                "calculate_interest(1000, 0.05, 2)  # 简单利息",
                "calculate_interest(1000, 0.05, 2, compound=True)  # 复利"
            ]
        }
        
        func_name = func.__name__
        if func_name in examples:
            print(f"\n{func_name} 使用示例:")
            for i, example in enumerate(examples[func_name], 1):
                print(f"{i}. {example}")
        else:
            print(f"暂无 {func_name} 的示例")

# 使用自定义帮助
FunctionHelper.show_examples(calculate_interest)
```

### 7.3 交互式帮助系统


💡 **实用工具**：创建交互式的函数查询系统

```python
def interactive_help():
    """交互式函数帮助系统"""
    functions = {
        'calculate_interest': calculate_interest,
        'example_function': example_function
    }
    
    print("可用函数:")
    for name in functions.keys():
        print(f"  - {name}")
    
    while True:
        func_name = input("\n请输入函数名 (输入'quit'退出): ").strip()
        
        if func_name.lower() == 'quit':
            break
        
        if func_name in functions:
            func = functions[func_name]
            print(f"\n=== {func_name} 帮助信息 ===")
            help(func)
        else:
            print(f"未找到函数: {func_name}")

# 运行交互式帮助（示例，实际使用时去掉注释）
# interactive_help()
```

---

## 8. 🔧 函数元信息访问


### 8.1 什么是函数元信息


🏷️ **专业术语**：`函数元信息` = 函数对象本身携带的各种属性和信息，如名称、文档、参数等

🔍 **为什么重要**：了解这些信息有助于动态分析和处理函数

### 8.2 常用的函数属性


📋 **核心属性列表**：

| 属性 | 说明 | 示例 |
|------|------|------|
| `__name__` | 函数名称 | `"my_function"` |
| `__doc__` | 文档字符串 | 函数的说明文档 |
| `__module__` | 所属模块 | `"__main__"` |
| `__annotations__` | 类型注解 | 参数和返回值类型 |
| `__defaults__` | 默认参数值 | 默认参数的元组 |
| `__code__` | 代码对象 | 字节码信息 |

```python
def demo_function(x: int, y: str = "默认值") -> str:
    """这是一个演示函数"""
    return f"{x}: {y}"

# 访问函数元信息
print(f"函数名: {demo_function.__name__}")
print(f"文档: {demo_function.__doc__}")
print(f"模块: {demo_function.__module__}")
print(f"注解: {demo_function.__annotations__}")
print(f"默认值: {demo_function.__defaults__}")
```

### 8.3 代码对象信息


🔍 **深入了解**：通过`__code__`属性获取函数的底层信息

```python
def analyze_code_object(func):
    """分析函数的代码对象"""
    code = func.__code__
    
    print(f"函数名: {code.co_name}")
    print(f"参数个数: {code.co_argcount}")
    print(f"局部变量个数: {code.co_nlocals}")
    print(f"变量名: {code.co_varnames}")
    print(f"文件名: {code.co_filename}")
    print(f"行号: {code.co_firstlineno}")

# 分析我们的演示函数
analyze_code_object(demo_function)
```

### 8.4 函数元信息的实际应用


🛠️ **实际用途**：创建函数注册和管理系统

```python
class FunctionRegistry:
    """函数注册管理器"""
    
    def __init__(self):
        self.functions = {}
    
    def register(self, func):
        """注册函数"""
        self.functions[func.__name__] = {
            'function': func,
            'doc': func.__doc__,
            'annotations': func.__annotations__,
            'module': func.__module__
        }
        return func  # 支持装饰器用法
    
    def get_info(self, name):
        """获取函数信息"""
        if name in self.functions:
            return self.functions[name]
        return None
    
    def list_functions(self):
        """列出所有注册的函数"""
        for name, info in self.functions.items():
            print(f"函数: {name}")
            print(f"  文档: {info['doc']}")
            print(f"  模块: {info['module']}")
            print("---")

# 使用函数注册器
registry = FunctionRegistry()

@registry.register
def add_numbers(a: int, b: int) -> int:
    """加法运算"""
    return a + b

@registry.register
def multiply_numbers(a: int, b: int) -> int:
    """乘法运算"""
    return a * b

# 查看注册的函数
registry.list_functions()
```

---

## 9. 📋 核心要点总结


### 9.1 必须掌握的核心概念


```
🔸 return语句：函数返回结果的关键，既返回值又终止执行
🔸 多返回值：用元组打包多个值，调用时可以解包接收
🔸 None返回值：没有return的函数自动返回None，要正确处理
🔸 文档字符串：函数的说明书，提高代码可读性和维护性
🔸 类型提示：现代Python的重要特性，增强代码质量
🔸 函数签名：函数的"身份证"，包含参数和类型信息
🔸 元信息访问：了解函数的内部属性，用于高级编程
```

### 9.2 关键理解要点


**🔹 return语句的两个作用**
```
1. 返回数据：把结果传递给调用者
2. 终止执行：立即停止函数运行，后面的代码不执行
```

**🔹 何时使用多返回值**
```
适用场景：
- 计算多个相关结果（如圆的周长和面积）
- 返回状态和数据（如成功状态和具体内容）
- 分解复杂计算结果（如统计信息的多个指标）
```

**🔹 文档字符串的价值**
```
三个层次：
- 基础：说明函数做什么
- 进阶：描述参数、返回值、异常
- 专业：包含使用示例和注意事项
```

### 9.3 最佳实践建议


**📝 编写习惯**
- ✅ 每个函数都要有清晰的文档字符串
- ✅ 使用类型提示提高代码质量
- ✅ 合理使用多返回值，避免返回过多值
- ✅ 检查None返回值时使用`is None`

**🚨 常见误区**
- ❌ 忘记处理None返回值导致程序出错
- ❌ 返回值过多导致代码难以理解
- ❌ 不写文档字符串，代码难以维护
- ❌ 类型提示不准确，误导他人

**💡 实用技巧**
- 🎯 使用命名元组让多返回值更清晰
- 🔍 利用inspect模块进行函数分析
- 📖 善用help()函数查看函数信息
- 🛠️ 创建函数注册系统管理复杂项目

### 9.4 学习路径建议


```
初级阶段：
1. 掌握基本的return语句使用
2. 学会写简单的文档字符串
3. 理解None返回值的含义

中级阶段：
1. 熟练使用多返回值技巧
2. 掌握类型提示的基本语法
3. 学会使用help()查看函数信息

高级阶段：
1. 深入理解函数签名检查
2. 利用函数元信息进行动态编程
3. 设计优雅的函数接口和文档系统
```

**核心记忆口诀**：
- return既返回又终止，多值元组最方便
- None检查用is判断，文档类型不能少
- inspect查看真面目，help帮助解疑惑
- 元信息里藏乾坤，掌握进阶路路通