---
title: 3ã€pytestæ¡†æ¶
---
## ğŸ“š ç›®å½•

1. [pytestæ¡†æ¶æ¦‚è¿°](#1-pytestæ¡†æ¶æ¦‚è¿°)
2. [pytestæ¡†æ¶ä¼˜åŠ¿](#2-pytestæ¡†æ¶ä¼˜åŠ¿)
3. [pyteståŸºç¡€ç”¨æ³•](#3-pyteståŸºç¡€ç”¨æ³•)
4. [fixtureæœºåˆ¶è¯¦è§£](#4-fixtureæœºåˆ¶è¯¦è§£)
5. [å‚æ•°åŒ–æµ‹è¯•](#5-å‚æ•°åŒ–æµ‹è¯•)
6. [æ’ä»¶ç³»ç»Ÿ](#6-æ’ä»¶ç³»ç»Ÿ)
7. [æµ‹è¯•é…ç½®æ–‡ä»¶](#7-æµ‹è¯•é…ç½®æ–‡ä»¶)
8. [æµ‹è¯•æŠ¥å‘Šç”Ÿæˆ](#8-æµ‹è¯•æŠ¥å‘Šç”Ÿæˆ)
9. [pytestæœ€ä½³å®è·µ](#9-pytestæœ€ä½³å®è·µ)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ§ª pytestæ¡†æ¶æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯pytest


**ç®€å•ç†è§£**ï¼špytestå°±åƒæ˜¯Pythonä»£ç çš„"ä½“æ£€åŒ»ç”Ÿ"ï¼Œä¸“é—¨ç”¨æ¥æ£€æŸ¥ä½ å†™çš„ä»£ç æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚

**é€šä¿—è§£é‡Š**ï¼š
- æƒ³è±¡ä½ å¼€äº†ä¸€å®¶é¤å…ï¼Œæ¯é“èœåšå¥½åéƒ½è¦å…ˆå°ä¸€å°ï¼Œç¡®ä¿å‘³é“æ­£ç¡®
- pytestå°±æ˜¯å¸®ä½ "å°èœ"çš„å·¥å…·ï¼Œè‡ªåŠ¨æ£€æŸ¥ä»£ç åŠŸèƒ½æ˜¯å¦ç¬¦åˆé¢„æœŸ
- æ¯”æ‰‹åŠ¨æµ‹è¯•å¿«100å€ï¼Œè€Œä¸”ä¸ä¼šæ¼æ‰ä»»ä½•ç»†èŠ‚

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦æµ‹è¯•


**ç°å®ç±»æ¯”**ï¼š
```
ç›–æˆ¿å­ â†’ éœ€è¦è´¨æ£€éªŒæ”¶ â†’ ç¡®ä¿æˆ¿å­å®‰å…¨
å†™ä»£ç  â†’ éœ€è¦æµ‹è¯•éªŒè¯ â†’ ç¡®ä¿åŠŸèƒ½æ­£ç¡®

æ²¡æœ‰æµ‹è¯•çš„ä»£ç å°±åƒï¼š
âŒ æ²¡æœ‰è¯•é©¾å°±ä¹°è½¦
âŒ æ²¡æœ‰è¯•åƒå°±ä¸Šèœ
âŒ æ²¡æœ‰å½©æ’å°±æ¼”å‡º
```

### 1.3 pyteståœ¨Pythonæµ‹è¯•ç”Ÿæ€ä¸­çš„åœ°ä½


```
Pythonæµ‹è¯•å·¥å…·å¯¹æ¯”ï¼š

unittest (Pythonæ ‡å‡†åº“)
â”œâ”€â”€ ä¼˜ç‚¹ï¼šä¸éœ€è¦å®‰è£…ï¼Œå®˜æ–¹æ”¯æŒ
â””â”€â”€ ç¼ºç‚¹ï¼šå†™æ³•å¤æ‚ï¼ŒåŠŸèƒ½æœ‰é™

pytest (ç¬¬ä¸‰æ–¹æ¡†æ¶) â­
â”œâ”€â”€ ä¼˜ç‚¹ï¼šç®€å•æ˜“ç”¨ï¼ŒåŠŸèƒ½å¼ºå¤§
â””â”€â”€ ç¼ºç‚¹ï¼šéœ€è¦é¢å¤–å®‰è£…

nose (å·²åœæ­¢ç»´æŠ¤)
â””â”€â”€ åŸºæœ¬è¢«pytestå–ä»£
```

---

## 2. âš¡ pytestæ¡†æ¶ä¼˜åŠ¿


### 2.1 ç®€æ´çš„æµ‹è¯•å†™æ³•


**å¯¹æ¯”ä¼ ç»Ÿunittest**ï¼š

```python
# unittest å†™æ³•ï¼ˆå¤æ‚ï¼‰
import unittest

class TestCalculator(unittest.TestCase):
    def test_add(self):
        self.assertEqual(2 + 3, 5)
    
    def test_divide(self):
        with self.assertRaises(ZeroDivisionError):
            1 / 0

# pytest å†™æ³•ï¼ˆç®€æ´ï¼‰
def test_add():
    assert 2 + 3 == 5

def test_divide():
    import pytest
    with pytest.raises(ZeroDivisionError):
        1 / 0
```

**ğŸ”¸ å…³é”®å·®å¼‚**ï¼š
- **unittest**ï¼šéœ€è¦ç»§æ‰¿ç±»ï¼Œä½¿ç”¨ç‰¹æ®Šçš„æ–­è¨€æ–¹æ³•
- **pytest**ï¼šæ™®é€šå‡½æ•°å³å¯ï¼Œä½¿ç”¨PythonåŸç”Ÿçš„`assert`è¯­å¥

### 2.2 å¼ºå¤§çš„æ–­è¨€æœºåˆ¶


**æ™ºèƒ½æ–­è¨€ä¿¡æ¯**ï¼š
```python
def test_list_operations():
    expected = [1, 2, 3, 4]
    actual = [1, 2, 3]
    
    assert actual == expected
    # pytestä¼šæ˜¾ç¤ºè¯¦ç»†çš„å·®å¼‚ä¿¡æ¯ï¼š
    # AssertionError: assert [1, 2, 3] == [1, 2, 3, 4]
    # Right contains one more item: 4
```

### 2.3 è‡ªåŠ¨å‘ç°æµ‹è¯•ç”¨ä¾‹


**æµ‹è¯•å‘ç°è§„åˆ™**ï¼š
```
æ–‡ä»¶å‘ç°ï¼š
ğŸ“ é¡¹ç›®ç›®å½•/
  â”œâ”€â”€ test_*.py          â† è‡ªåŠ¨å‘ç°
  â”œâ”€â”€ *_test.py          â† è‡ªåŠ¨å‘ç°
  â””â”€â”€ tests/
      â””â”€â”€ test_something.py â† è‡ªåŠ¨å‘ç°

å‡½æ•°å‘ç°ï¼š
âœ… def test_*()          â† è‡ªåŠ¨å‘ç°
âœ… class Test*:          â† è‡ªåŠ¨å‘ç°
   â””â”€â”€ def test_*()     â† ç±»ä¸­çš„æµ‹è¯•æ–¹æ³•
```

### 2.4 ä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€


| æ’ä»¶ç±»å‹ | **çƒ­é—¨æ’ä»¶** | **ä½œç”¨è¯´æ˜** |
|---------|-------------|-------------|
| ğŸ¯ **è¦†ç›–ç‡** | `pytest-cov` | `æµ‹è¯•è¦†ç›–ç‡ç»Ÿè®¡` |
| ğŸŒ **Webæµ‹è¯•** | `pytest-django` | `Djangoé¡¹ç›®æµ‹è¯•` |
| âš¡ **å¹¶è¡Œæ‰§è¡Œ** | `pytest-xdist` | `å¤šè¿›ç¨‹å¹¶è¡Œæµ‹è¯•` |
| ğŸ“Š **æŠ¥å‘Š** | `pytest-html` | `ç”ŸæˆHTMLæµ‹è¯•æŠ¥å‘Š` |
| ğŸ” **Mock** | `pytest-mock` | `ç®€åŒ–mockæ“ä½œ` |

---

## 3. ğŸš€ pyteståŸºç¡€ç”¨æ³•


### 3.1 å®‰è£…ä¸å¿«é€Ÿå¼€å§‹


**å®‰è£…pytest**ï¼š
```bash
pip install pytest
```

**ç¬¬ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶** `test_basic.py`ï¼š
```python
def add(a, b):
    """ç®€å•çš„åŠ æ³•å‡½æ•°"""
    return a + b

def test_add_positive():
    """æµ‹è¯•æ­£æ•°ç›¸åŠ """
    assert add(2, 3) == 5

def test_add_negative():
    """æµ‹è¯•è´Ÿæ•°ç›¸åŠ """
    assert add(-1, -2) == -3

def test_add_zero():
    """æµ‹è¯•é›¶çš„åŠ æ³•"""
    assert add(5, 0) == 5
```

**è¿è¡Œæµ‹è¯•**ï¼š
```bash
pytest test_basic.py
```

### 3.2 æµ‹è¯•ç»„ç»‡ç»“æ„


**æ¨èçš„é¡¹ç›®ç»“æ„**ï¼š
```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ src/                    # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ calculator.py
â”‚   â””â”€â”€ utils.py
â”œâ”€â”€ tests/                  # æµ‹è¯•ç›®å½•
â”‚   â”œâ”€â”€ conftest.py        # pytesté…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ test_calculator.py
â”‚   â””â”€â”€ test_utils.py
â””â”€â”€ pytest.ini            # å…¨å±€é…ç½®
```

### 3.3 å¸¸ç”¨å‘½ä»¤è¡Œé€‰é¡¹


**å®ç”¨å‘½ä»¤å¤§å…¨**ï¼š
```bash
# åŸºç¡€è¿è¡Œ
pytest                      # è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest test_file.py         # è¿è¡ŒæŒ‡å®šæ–‡ä»¶
pytest -v                   # è¯¦ç»†è¾“å‡ºæ¨¡å¼

# ç­›é€‰æµ‹è¯•
pytest -k "add"            # è¿è¡Œåç§°åŒ…å«"add"çš„æµ‹è¯•
pytest -m "slow"           # è¿è¡Œæ ‡è®°ä¸º"slow"çš„æµ‹è¯•
pytest tests/unit/         # è¿è¡ŒæŒ‡å®šç›®å½•ä¸‹çš„æµ‹è¯•

# è°ƒè¯•æ¨¡å¼
pytest -s                  # æ˜¾ç¤ºprintè¾“å‡º
pytest --pdb              # å¤±è´¥æ—¶è¿›å…¥è°ƒè¯•å™¨
pytest -x                 # ç¬¬ä¸€ä¸ªå¤±è´¥ååœæ­¢

# è¾“å‡ºæ§åˆ¶
pytest --tb=short         # ç®€çŸ­çš„é”™è¯¯ä¿¡æ¯
pytest -q                 # å®‰é™æ¨¡å¼ï¼Œå‡å°‘è¾“å‡º
```

### 3.4 æ–­è¨€çš„è‰ºæœ¯


**åŸºç¡€æ–­è¨€ç”¨æ³•**ï¼š
```python
def test_assertions():
    # ç›¸ç­‰æ€§æ–­è¨€
    assert 2 + 2 == 4
    assert "hello".upper() == "HELLO"
    
    # åŒ…å«å…³ç³»
    assert "test" in "testing"
    assert 3 in [1, 2, 3, 4]
    
    # çœŸå‡å€¼
    assert True
    assert not False
    assert bool([1, 2, 3])  # éç©ºåˆ—è¡¨ä¸ºTrue
    
    # å¼‚å¸¸æ–­è¨€
    import pytest
    with pytest.raises(ValueError):
        int("abc")  # è¿™ä¼šæŠ›å‡ºValueError
    
    # è¿‘ä¼¼ç›¸ç­‰ï¼ˆæµ®ç‚¹æ•°ï¼‰
    assert abs(0.1 + 0.2 - 0.3) < 1e-10
    # æˆ–ä½¿ç”¨pytestçš„approx
    assert 0.1 + 0.2 == pytest.approx(0.3)
```

---

## 4. ğŸ”§ fixtureæœºåˆ¶è¯¦è§£


### 4.1 ä»€ä¹ˆæ˜¯fixture


**ç”Ÿæ´»ç±»æ¯”**ï¼š
```
å¼€è½¦å‰çš„å‡†å¤‡å·¥ä½œï¼š
1. æ£€æŸ¥æ²¹é‡     â† è¿™æ˜¯"fixture"
2. è°ƒæ•´åº§æ¤…     â† è¿™æ˜¯"fixture"  
3. ç³»å®‰å…¨å¸¦     â† è¿™æ˜¯"fixture"
4. å¼€å§‹é©¾é©¶     â† è¿™æ˜¯"æµ‹è¯•"
5. åœè½¦ç†„ç«     â† è¿™æ˜¯"æ¸…ç†"

fixtureå°±æ˜¯æµ‹è¯•å‰çš„"å‡†å¤‡å·¥ä½œ"å’Œæµ‹è¯•åçš„"æ¸…ç†å·¥ä½œ"
```

**æŠ€æœ¯å®šä¹‰**ï¼šfixtureæ˜¯pytestæä¾›çš„ä¸€ç§æœºåˆ¶ï¼Œç”¨äºï¼š
- **ğŸ”¸ å‡†å¤‡æµ‹è¯•æ•°æ®**ï¼šåœ¨æµ‹è¯•è¿è¡Œå‰å‡†å¤‡æ‰€éœ€çš„æ•°æ®å’Œç¯å¢ƒ
- **ğŸ”¸ æä¾›æµ‹è¯•ä¾èµ–**ï¼šä¸ºæµ‹è¯•æä¾›æ•°æ®åº“è¿æ¥ã€æ–‡ä»¶ç­‰èµ„æº
- **ğŸ”¸ æ¸…ç†æµ‹è¯•ç¯å¢ƒ**ï¼šæµ‹è¯•å®Œæˆåè‡ªåŠ¨æ¸…ç†èµ„æº

### 4.2 åŸºç¡€fixtureç”¨æ³•


**ç®€å•fixtureç¤ºä¾‹**ï¼š
```python
import pytest

@pytest.fixture
def sample_data():
    """æä¾›æµ‹è¯•æ•°æ®çš„fixture"""
    return [1, 2, 3, 4, 5]

@pytest.fixture  
def temp_file():
    """åˆ›å»ºä¸´æ—¶æ–‡ä»¶çš„fixture"""
    import tempfile
    import os
    
    # å‡†å¤‡é˜¶æ®µï¼šåˆ›å»ºä¸´æ—¶æ–‡ä»¶
    fd, path = tempfile.mkstemp()
    with os.fdopen(fd, 'w') as f:
        f.write("test content")
    
    yield path  # å°†æ–‡ä»¶è·¯å¾„ä¼ é€’ç»™æµ‹è¯•
    
    # æ¸…ç†é˜¶æ®µï¼šåˆ é™¤ä¸´æ—¶æ–‡ä»¶
    os.unlink(path)

# ä½¿ç”¨fixtureçš„æµ‹è¯•
def test_data_processing(sample_data):
    assert len(sample_data) == 5
    assert sum(sample_data) == 15

def test_file_operations(temp_file):
    with open(temp_file, 'r') as f:
        content = f.read()
        assert content == "test content"
```

### 4.3 fixtureä½œç”¨åŸŸ


**ä½œç”¨åŸŸå¯¹æ¯”è¡¨**ï¼š

| ä½œç”¨åŸŸ | **ç”Ÿå‘½å‘¨æœŸ** | **é€‚ç”¨åœºæ™¯** | **æ€§èƒ½å½±å“** |
|-------|-------------|-------------|-------------|
| ğŸ¯ **function** | `æ¯ä¸ªæµ‹è¯•å‡½æ•°` | `æµ‹è¯•æ•°æ®å‡†å¤‡` | `å¼€é”€å°ï¼Œéš”ç¦»å¥½` |
| ğŸ“ **class** | `æ¯ä¸ªæµ‹è¯•ç±»` | `ç±»çº§åˆ«çš„è®¾ç½®` | `ä¸­ç­‰å¼€é”€` |
| ğŸ“„ **module** | `æ¯ä¸ªæµ‹è¯•æ–‡ä»¶` | `æ¨¡å—çº§åˆ«èµ„æº` | `å¼€é”€è¾ƒå¤§` |
| ğŸ“¦ **package** | `æ¯ä¸ªåŒ…` | `åŒ…çº§åˆ«é…ç½®` | `å¼€é”€å¤§` |
| ğŸŒ **session** | `æ•´ä¸ªæµ‹è¯•ä¼šè¯` | `æ•°æ®åº“è¿æ¥ç­‰` | `å¼€é”€æœ€å¤§` |

**å®é™…åº”ç”¨ç¤ºä¾‹**ï¼š
```python
@pytest.fixture(scope="session")
def database_connection():
    """æ•°æ®åº“è¿æ¥ï¼ˆæ•´ä¸ªæµ‹è¯•ä¼šè¯å…±äº«ï¼‰"""
    conn = create_database_connection()
    yield conn
    conn.close()

@pytest.fixture(scope="module") 
def api_client():
    """APIå®¢æˆ·ç«¯ï¼ˆæ¨¡å—çº§åˆ«å…±äº«ï¼‰"""
    client = APIClient()
    client.authenticate()
    yield client
    client.logout()

@pytest.fixture(scope="function")
def clean_data():
    """æ¯ä¸ªæµ‹è¯•éƒ½é‡æ–°å‡†å¤‡çš„æ•°æ®"""
    return {"users": [], "posts": []}
```

### 4.4 fixtureçš„é«˜çº§ç‰¹æ€§


**è‡ªåŠ¨ä½¿ç”¨fixture**ï¼š
```python
@pytest.fixture(autouse=True)
def setup_logging():
    """è‡ªåŠ¨ä¸ºæ¯ä¸ªæµ‹è¯•è®¾ç½®æ—¥å¿—"""
    import logging
    logging.basicConfig(level=logging.DEBUG)
    print("æµ‹è¯•å¼€å§‹ï¼Œæ—¥å¿—å·²è®¾ç½®")
    yield
    print("æµ‹è¯•ç»“æŸï¼Œæ¸…ç†æ—¥å¿—")

# ä¸éœ€è¦æ˜¾å¼å£°æ˜ï¼Œæ¯ä¸ªæµ‹è¯•éƒ½ä¼šè‡ªåŠ¨ä½¿ç”¨
def test_something():
    assert True  # setup_loggingä¼šè‡ªåŠ¨è¿è¡Œ
```

**å‚æ•°åŒ–fixture**ï¼š
```python
@pytest.fixture(params=['mysql', 'postgresql', 'sqlite'])
def database_type(request):
    """æµ‹è¯•å¤šç§æ•°æ®åº“ç±»å‹"""
    return request.param

def test_database_operations(database_type):
    # è¿™ä¸ªæµ‹è¯•ä¼šè¿è¡Œ3æ¬¡ï¼Œåˆ†åˆ«æµ‹è¯•3ç§æ•°æ®åº“
    print(f"Testing with {database_type}")
    assert database_type in ['mysql', 'postgresql', 'sqlite']
```

---

## 5. ğŸ“Š å‚æ•°åŒ–æµ‹è¯•


### 5.1 å‚æ•°åŒ–æµ‹è¯•çš„æ¦‚å¿µ


**é—®é¢˜åœºæ™¯**ï¼š
```
æµ‹è¯•ä¸€ä¸ªåŠ æ³•å‡½æ•°ï¼Œéœ€è¦æµ‹è¯•å¤šç»„æ•°æ®ï¼š
âŒ é‡å¤å†™æ³•ï¼š
def test_add_1():
    assert add(2, 3) == 5
def test_add_2():
    assert add(-1, 1) == 0
def test_add_3():
    assert add(0, 0) == 0

âœ… å‚æ•°åŒ–å†™æ³•ï¼š
@pytest.mark.parametrize("a,b,expected", [
    (2, 3, 5),
    (-1, 1, 0),
    (0, 0, 0)
])
def test_add(a, b, expected):
    assert add(a, b) == expected
```

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- **ğŸ”¸ å‡å°‘é‡å¤ä»£ç **ï¼šä¸€ä¸ªæµ‹è¯•å‡½æ•°æµ‹è¯•å¤šç»„æ•°æ®
- **ğŸ”¸ æ›´å¥½çš„å¯è¯»æ€§**ï¼šæµ‹è¯•æ•°æ®å’Œé€»è¾‘åˆ†ç¦»
- **ğŸ”¸ æ˜“äºç»´æŠ¤**ï¼šæ·»åŠ æ–°æµ‹è¯•ç”¨ä¾‹åªéœ€ä¿®æ”¹å‚æ•°åˆ—è¡¨

### 5.2 åŸºç¡€å‚æ•°åŒ–ç”¨æ³•


**å•å‚æ•°å‚æ•°åŒ–**ï¼š
```python
@pytest.mark.parametrize("number", [1, 2, 3, 4, 5])
def test_is_positive(number):
    assert number > 0

# ç­‰ä»·äºå†™5ä¸ªç‹¬ç«‹çš„æµ‹è¯•å‡½æ•°
```

**å¤šå‚æ•°å‚æ•°åŒ–**ï¼š
```python
@pytest.mark.parametrize("input_str,expected_length", [
    ("hello", 5),
    ("world", 5),
    ("pytest", 6),
    ("", 0),
    ("a", 1)
])
def test_string_length(input_str, expected_length):
    assert len(input_str) == expected_length
```

### 5.3 é«˜çº§å‚æ•°åŒ–æŠ€å·§


**ä½¿ç”¨pytest.paramæ ‡è®°ç‰¹æ®Šç”¨ä¾‹**ï¼š
```python
@pytest.mark.parametrize("x,y,expected", [
    (2, 3, 5),
    (4, 5, 9),
    pytest.param(1, 0, 1, marks=pytest.mark.xfail),  # é¢„æœŸå¤±è´¥
    pytest.param(10, 20, 30, marks=pytest.mark.skip(reason="æš‚æ—¶è·³è¿‡"))
])
def test_addition_with_special_cases(x, y, expected):
    assert x + y == expected
```

**ç»„åˆå¤šä¸ªå‚æ•°åŒ–**ï¼š
```python
@pytest.mark.parametrize("operation", ["add", "subtract"])
@pytest.mark.parametrize("x,y", [(1, 2), (3, 4), (5, 6)])
def test_calculator_operations(operation, x, y):
    if operation == "add":
        result = x + y
        assert result == x + y
    elif operation == "subtract":
        result = x - y
        assert result == x - y
# è¿™ä¼šç”Ÿæˆ 2 Ã— 3 = 6 ä¸ªæµ‹è¯•ç”¨ä¾‹
```

### 5.4 å‚æ•°åŒ–çš„æœ€ä½³å®è·µ


**æµ‹è¯•æ•°æ®ç»„ç»‡**ï¼š
```python
# å°†æµ‹è¯•æ•°æ®æå–åˆ°å˜é‡ä¸­
VALID_EMAILS = [
    "user@example.com",
    "test.email@domain.co.uk", 
    "user+tag@example.org"
]

INVALID_EMAILS = [
    "invalid-email",
    "@example.com",
    "user@",
    ""
]

@pytest.mark.parametrize("email", VALID_EMAILS)
def test_valid_email_format(email):
    assert is_valid_email(email)

@pytest.mark.parametrize("email", INVALID_EMAILS)  
def test_invalid_email_format(email):
    assert not is_valid_email(email)
```

**ä½¿ç”¨IDå‚æ•°æé«˜å¯è¯»æ€§**ï¼š
```python
@pytest.mark.parametrize("input_data,expected", [
    ({"name": "Alice", "age": 25}, True),
    ({"name": "", "age": 25}, False),
    ({"name": "Bob"}, False),
], ids=["valid_user", "empty_name", "missing_age"])
def test_user_validation(input_data, expected):
    assert validate_user(input_data) == expected
```

---

## 6. ğŸ”Œ æ’ä»¶ç³»ç»Ÿ


### 6.1 æ’ä»¶ç³»ç»Ÿæ¦‚è¿°


**æ’ä»¶çš„ä½œç”¨**ï¼š
```
pytestæ ¸å¿ƒ = æ±½è½¦å¼•æ“ ï¼ˆåŸºç¡€åŠŸèƒ½ï¼‰
æ’ä»¶ç³»ç»Ÿ = æ±½è½¦é…ä»¶ ï¼ˆæ‰©å±•åŠŸèƒ½ï¼‰

ğŸ”§ pytest-cov     = é‡Œç¨‹è¡¨ï¼ˆæµ‹è¯•è¦†ç›–ç‡ï¼‰
ğŸŒ pytest-django  = GPSå¯¼èˆªï¼ˆWebæ¡†æ¶æ”¯æŒï¼‰
âš¡ pytest-xdist   = æ¶¡è½®å¢å‹ï¼ˆå¹¶è¡Œæ‰§è¡Œï¼‰
ğŸ“Š pytest-html    = è¡Œè½¦è®°å½•ä»ªï¼ˆæŠ¥å‘Šç”Ÿæˆï¼‰
```

### 6.2 çƒ­é—¨æ’ä»¶è¯¦è§£


**ğŸ¯ pytest-covï¼ˆè¦†ç›–ç‡ç»Ÿè®¡ï¼‰**

å®‰è£…å’Œä½¿ç”¨ï¼š
```bash
pip install pytest-cov

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pytest --cov=src tests/
pytest --cov=src --cov-report=html tests/  # HTMLæŠ¥å‘Š
```

è¦†ç›–ç‡æŠ¥å‘Šè§£è¯»ï¼š
```
Name                 Stmts   Miss  Cover
----------------------------------------
src/calculator.py       20      2    90%
src/utils.py           15      0   100%
----------------------------------------
TOTAL                  35      2    94%

ğŸ“Š è§£é‡Šï¼š
- Stmts: ä»£ç æ€»è¡Œæ•°
- Miss: æœªè¢«æµ‹è¯•è¦†ç›–çš„è¡Œæ•°  
- Cover: è¦†ç›–ç‡ç™¾åˆ†æ¯”
```

**âš¡ pytest-xdistï¼ˆå¹¶è¡Œæ‰§è¡Œï¼‰**

```bash
pip install pytest-xdist

# ä½¿ç”¨4ä¸ªCPUæ ¸å¿ƒå¹¶è¡Œæ‰§è¡Œ
pytest -n 4

# è‡ªåŠ¨æ£€æµ‹CPUæ ¸å¿ƒæ•°
pytest -n auto
```

**ğŸ“Š pytest-htmlï¼ˆHTMLæŠ¥å‘Šï¼‰**

```bash
pip install pytest-html

# ç”ŸæˆHTMLæŠ¥å‘Š
pytest --html=report.html --self-contained-html
```

### 6.3 ç¼–å†™è‡ªå®šä¹‰æ’ä»¶


**ç®€å•çš„æ’ä»¶ç¤ºä¾‹**ï¼š
```python
# conftest.py ä¸­å®šä¹‰æ’ä»¶
import pytest

@pytest.hookimpl
def pytest_runtest_setup(item):
    """æ¯ä¸ªæµ‹è¯•å¼€å§‹å‰è¿è¡Œ"""
    print(f"\nå¼€å§‹æµ‹è¯•: {item.name}")

@pytest.hookimpl  
def pytest_runtest_teardown(item):
    """æ¯ä¸ªæµ‹è¯•ç»“æŸåè¿è¡Œ"""
    print(f"æµ‹è¯•å®Œæˆ: {item.name}")

# è‡ªå®šä¹‰æ ‡è®°
def pytest_configure(config):
    config.addinivalue_line(
        "markers", "slow: æ ‡è®°ä¸ºæ…¢é€Ÿæµ‹è¯•"
    )
```

**æ ‡è®°ç³»ç»Ÿçš„ä½¿ç”¨**ï¼š
```python
import pytest

@pytest.mark.slow
def test_time_consuming_operation():
    """è¿™æ˜¯ä¸€ä¸ªæ…¢é€Ÿæµ‹è¯•"""
    import time
    time.sleep(2)
    assert True

@pytest.mark.unit
def test_fast_operation():
    """è¿™æ˜¯ä¸€ä¸ªå¿«é€Ÿå•å…ƒæµ‹è¯•"""
    assert 1 + 1 == 2

# åªè¿è¡Œæ…¢é€Ÿæµ‹è¯•
# pytest -m "slow"

# åªè¿è¡Œéæ…¢é€Ÿæµ‹è¯•  
# pytest -m "not slow"
```

---

## 7. âš™ï¸ æµ‹è¯•é…ç½®æ–‡ä»¶


### 7.1 pytest.inié…ç½®æ–‡ä»¶


**é…ç½®æ–‡ä»¶çš„ä½œç”¨**ï¼š
```
pytest.ini = æµ‹è¯•çš„"è®¾ç½®èœå•"
ğŸ”§ è®¾ç½®é»˜è®¤å‚æ•°
ğŸ”§ é…ç½®æµ‹è¯•å‘ç°è§„åˆ™
ğŸ”§ å®šä¹‰è‡ªå®šä¹‰æ ‡è®°
ğŸ”§ è®¾ç½®è¿‡æ»¤è§„åˆ™
```

**åŸºç¡€pytest.iniç¤ºä¾‹**ï¼š
```ini
[tool:pytest]
# æµ‹è¯•æ–‡ä»¶å‘ç°æ¨¡å¼
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# é»˜è®¤å‘½ä»¤è¡Œå‚æ•°
addopts = 
    -v
    --strict-markers
    --tb=short
    --cov=src
    --cov-report=term-missing

# æµ‹è¯•ç›®å½•
testpaths = tests

# è‡ªå®šä¹‰æ ‡è®°
markers =
    slow: æ…¢é€Ÿæµ‹è¯•
    unit: å•å…ƒæµ‹è¯•  
    integration: é›†æˆæµ‹è¯•
    smoke: å†’çƒŸæµ‹è¯•

# æœ€å°ç‰ˆæœ¬è¦æ±‚
minversion = 6.0
```

### 7.2 conftest.pyæ–‡ä»¶


**conftest.pyçš„ç‰¹æ®Šæ€§**ï¼š
```
conftest.py = æµ‹è¯•çš„"é…ç½®ä¸­å¿ƒ"
ğŸ”¸ pytestä¼šè‡ªåŠ¨å‘ç°å’ŒåŠ è½½
ğŸ”¸ å¯ä»¥å®šä¹‰å…±äº«çš„fixture
ğŸ”¸ å¯ä»¥é…ç½®æ’ä»¶å’Œé’©å­
ğŸ”¸ ä½œç”¨åŸŸæ˜¯ç›®å½•çº§åˆ«çš„
```

**é¡¹ç›®çº§åˆ«çš„conftest.py**ï¼š
```python
import pytest
import tempfile
import os

@pytest.fixture(scope="session")
def test_database():
    """æµ‹è¯•æ•°æ®åº“fixture"""
    # åˆ›å»ºæµ‹è¯•æ•°æ®åº“
    db = create_test_database()
    yield db
    # æ¸…ç†æµ‹è¯•æ•°æ®åº“
    db.drop_all_tables()
    db.close()

@pytest.fixture
def temp_directory():
    """ä¸´æ—¶ç›®å½•fixture"""
    temp_dir = tempfile.mkdtemp()
    yield temp_dir
    # æ¸…ç†ä¸´æ—¶ç›®å½•
    import shutil
    shutil.rmtree(temp_dir)

@pytest.fixture(autouse=True)
def setup_test_environment():
    """è‡ªåŠ¨è®¾ç½®æµ‹è¯•ç¯å¢ƒ"""
    os.environ['TESTING'] = 'true'
    yield
    os.environ.pop('TESTING', None)

# è‡ªå®šä¹‰å‘½ä»¤è¡Œé€‰é¡¹
def pytest_addoption(parser):
    parser.addoption(
        "--slow", action="store_true", 
        help="è¿è¡Œæ…¢é€Ÿæµ‹è¯•"
    )

def pytest_configure(config):
    if not config.option.slow:
        # å¦‚æœæ²¡æœ‰æŒ‡å®š--slowï¼Œè·³è¿‡æ…¢é€Ÿæµ‹è¯•
        config.option.markexpr = "not slow"
```

### 7.3 ç¯å¢ƒé…ç½®ç®¡ç†


**å¤šç¯å¢ƒé…ç½®ç¤ºä¾‹**ï¼š
```python
# conftest.py
import pytest
import os

@pytest.fixture(scope="session")
def test_config():
    """æ ¹æ®ç¯å¢ƒå˜é‡è¿”å›é…ç½®"""
    env = os.getenv('TEST_ENV', 'local')
    
    configs = {
        'local': {
            'database_url': 'sqlite:///test.db',
            'api_base_url': 'http://localhost:8000'
        },
        'ci': {
            'database_url': 'postgresql://test:test@db:5432/test',
            'api_base_url': 'http://test-server:8000'
        }
    }
    
    return configs[env]

def test_api_connection(test_config):
    api_url = test_config['api_base_url']
    # ä½¿ç”¨é…ç½®ä¸­çš„APIåœ°å€è¿›è¡Œæµ‹è¯•
    assert api_url is not None
```

---

## 8. ğŸ“ˆ æµ‹è¯•æŠ¥å‘Šç”Ÿæˆ


### 8.1 å†…ç½®æŠ¥å‘Šæ ¼å¼


**å‘½ä»¤è¡ŒæŠ¥å‘Šé€‰é¡¹**ï¼š
```bash
# è¯¦ç»†è¾“å‡º
pytest -v

# ç®€çŸ­è¾“å‡º  
pytest -q

# åªæ˜¾ç¤ºå¤±è´¥ä¿¡æ¯
pytest --tb=short

# ä¸æ˜¾ç¤ºé”™è¯¯å †æ ˆ
pytest --tb=no

# æ˜¾ç¤ºæœ€æ…¢çš„10ä¸ªæµ‹è¯•
pytest --durations=10
```

**è¾“å‡ºç¤ºä¾‹è§£è¯»**ï¼š
```
æµ‹è¯•ç»“æœç¬¦å·å«ä¹‰ï¼š
âœ… .  (ç‚¹å·)     = æµ‹è¯•é€šè¿‡
âŒ F  (F)       = æµ‹è¯•å¤±è´¥ (Failure)
âš ï¸  E  (E)       = æµ‹è¯•é”™è¯¯ (Error)  
â­ï¸  s  (s)       = æµ‹è¯•è·³è¿‡ (Skip)
âš ï¸  x  (x)       = é¢„æœŸå¤±è´¥ä½†å®é™…é€šè¿‡
âŒ X  (X)       = é¢„æœŸå¤±è´¥ä¸”ç¡®å®å¤±è´¥

tests/test_calculator.py::test_add PASSED           [ 25%]
tests/test_calculator.py::test_subtract FAILED      [ 50%]
tests/test_calculator.py::test_multiply PASSED      [ 75%]
tests/test_calculator.py::test_divide ERROR         [100%]
```

### 8.2 HTMLæŠ¥å‘Šç”Ÿæˆ


**å®‰è£…å’Œä½¿ç”¨pytest-html**ï¼š
```bash
pip install pytest-html

# ç”ŸæˆHTMLæŠ¥å‘Š
pytest --html=reports/report.html --self-contained-html
```

**è‡ªå®šä¹‰HTMLæŠ¥å‘Š**ï¼š
```python
# conftest.py
import pytest
from datetime import datetime

@pytest.hookimpl(hookwrapper=True)
def pytest_runtest_makereport(item, call):
    """è‡ªå®šä¹‰æµ‹è¯•æŠ¥å‘Šä¿¡æ¯"""
    outcome = yield
    report = outcome.get_result()
    
    # æ·»åŠ è‡ªå®šä¹‰ä¿¡æ¯åˆ°æŠ¥å‘Š
    if report.when == "call":
        report.test_id = getattr(item, 'test_id', 'N/A')
        report.timestamp = datetime.now().strftime('%Y-%m-%d %H:%M:%S')

def pytest_html_report_title(report):
    """è‡ªå®šä¹‰æŠ¥å‘Šæ ‡é¢˜"""
    report.title = "æˆ‘çš„é¡¹ç›®æµ‹è¯•æŠ¥å‘Š"

def pytest_html_results_summary(prefix, summary, postfix):
    """è‡ªå®šä¹‰ç»“æœæ‘˜è¦"""
    prefix.extend(["<p>é¡¹ç›®: MyProject</p>"])
    prefix.extend([f"<p>æ‰§è¡Œæ—¶é—´: {datetime.now()}</p>"])
```

### 8.3 è¦†ç›–ç‡æŠ¥å‘Š


**ç”Ÿæˆä¸åŒæ ¼å¼çš„è¦†ç›–ç‡æŠ¥å‘Š**ï¼š
```bash
# ç»ˆç«¯æ˜¾ç¤º
pytest --cov=src

# HTMLæ ¼å¼ï¼ˆæ¨èï¼‰
pytest --cov=src --cov-report=html

# XMLæ ¼å¼ï¼ˆCI/CDé›†æˆï¼‰
pytest --cov=src --cov-report=xml

# åŒæ—¶ç”Ÿæˆå¤šç§æ ¼å¼
pytest --cov=src --cov-report=html --cov-report=xml --cov-report=term
```

**è¦†ç›–ç‡é…ç½®æ–‡ä»¶** `.coveragerc`ï¼š
```ini
[run]
source = src
omit = 
    */tests/*
    */venv/*
    */__pycache__/*
    */migrations/*

[report]
exclude_lines =
    pragma: no cover
    def __repr__
    raise AssertionError
    raise NotImplementedError

[html]
directory = htmlcov
```

---

## 9. ğŸ† pytestæœ€ä½³å®è·µ


### 9.1 æµ‹è¯•ä»£ç ç»„ç»‡


**ç›®å½•ç»“æ„æœ€ä½³å®è·µ**ï¼š
```
project/
â”œâ”€â”€ src/                    # æºä»£ç 
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ calculator.py
â”‚   â””â”€â”€ utils.py
â”œâ”€â”€ tests/                  # æµ‹è¯•ä»£ç 
â”‚   â”œâ”€â”€ conftest.py        # å…¨å±€é…ç½®
â”‚   â”œâ”€â”€ unit/              # å•å…ƒæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_calculator.py
â”‚   â”‚   â””â”€â”€ test_utils.py
â”‚   â”œâ”€â”€ integration/       # é›†æˆæµ‹è¯•
â”‚   â”‚   â””â”€â”€ test_api.py
â”‚   â””â”€â”€ fixtures/          # æµ‹è¯•æ•°æ®
â”‚       â””â”€â”€ sample_data.json
â”œâ”€â”€ pytest.ini            # pytesté…ç½®
â””â”€â”€ requirements-test.txt  # æµ‹è¯•ä¾èµ–
```

### 9.2 æµ‹è¯•å‘½åè§„èŒƒ


**å‘½åæœ€ä½³å®è·µ**ï¼š
```python
# âœ… å¥½çš„æµ‹è¯•å‘½å
def test_add_positive_numbers_returns_correct_sum():
    assert add(2, 3) == 5

def test_divide_by_zero_raises_exception():
    with pytest.raises(ZeroDivisionError):
        divide(1, 0)

def test_user_creation_with_valid_email_succeeds():
    user = create_user("test@example.com")
    assert user.email == "test@example.com"

# âŒ ä¸å¥½çš„æµ‹è¯•å‘½å  
def test_1():
    assert add(2, 3) == 5

def test_user():
    user = create_user("test@example.com")
    assert user.email == "test@example.com"
```

**å‘½åè§„èŒƒè¦ç‚¹**ï¼š
- **ğŸ”¸ æè¿°æ€§å¼º**ï¼šä»åå­—å°±èƒ½çŸ¥é“æµ‹è¯•ä»€ä¹ˆ
- **ğŸ”¸ åŒ…å«é¢„æœŸç»“æœ**ï¼šè¯´æ˜æœŸæœ›çš„è¡Œä¸º
- **ğŸ”¸ éµå¾ªæ¨¡å¼**ï¼š`test_<åŠŸèƒ½>_<æ¡ä»¶>_<é¢„æœŸç»“æœ>`

### 9.3 Fixtureè®¾è®¡åŸåˆ™


**Fixtureæœ€ä½³å®è·µ**ï¼š
```python
# âœ… å¥½çš„fixtureè®¾è®¡
@pytest.fixture
def user_data():
    """è¿”å›ç”¨æˆ·æµ‹è¯•æ•°æ®"""
    return {
        "name": "Test User",
        "email": "test@example.com",
        "age": 25
    }

@pytest.fixture
def database_session():
    """æ•°æ®åº“ä¼šè¯fixture"""
    session = create_test_session()
    yield session
    session.rollback()  # æµ‹è¯•åå›æ»š
    session.close()

# âŒ é¿å…çš„fixtureè®¾è®¡
@pytest.fixture
def setup_everything():
    """è¿™ä¸ªfixtureåšäº†å¤ªå¤šäº‹æƒ…"""
    # è®¾ç½®æ•°æ®åº“
    # è®¾ç½®ç”¨æˆ·
    # è®¾ç½®æƒé™
    # è®¾ç½®ç¼“å­˜
    # ... å¤ªå¤æ‚äº†
    pass
```

### 9.4 æ–­è¨€æœ€ä½³å®è·µ


**æ¸…æ™°çš„æ–­è¨€**ï¼š
```python
# âœ… æ¸…æ™°çš„æ–­è¨€
def test_user_creation():
    user = create_user("test@example.com", age=25)
    
    # åˆ†åˆ«æ–­è¨€ä¸åŒå±æ€§
    assert user.email == "test@example.com"
    assert user.age == 25
    assert user.is_active is True
    assert len(user.id) == 36  # UUIDé•¿åº¦

# âŒ æ¨¡ç³Šçš„æ–­è¨€
def test_user_creation_bad():
    user = create_user("test@example.com", age=25)
    # æ–­è¨€å¤ªå®½æ³›ï¼Œä¸çŸ¥é“å…·ä½“å“ªé‡Œå‡ºé”™
    assert user  
```

### 9.5 æ€§èƒ½ä¼˜åŒ–å»ºè®®


**æµ‹è¯•æ€§èƒ½ä¼˜åŒ–ç­–ç•¥**ï¼š

```python
# 1. ä½¿ç”¨é€‚å½“çš„fixtureä½œç”¨åŸŸ
@pytest.fixture(scope="session")  # åªåˆ›å»ºä¸€æ¬¡
def expensive_setup():
    return create_expensive_resource()

# 2. å¹¶è¡Œæ‰§è¡Œæµ‹è¯•
# pytest -n auto

# 3. è·³è¿‡è€—æ—¶çš„é›†æˆæµ‹è¯•ï¼ˆå¼€å‘é˜¶æ®µï¼‰
@pytest.mark.slow
def test_full_integration():
    # è€—æ—¶çš„é›†æˆæµ‹è¯•
    pass

# 4. ä½¿ç”¨mockå‡å°‘å¤–éƒ¨ä¾èµ–
def test_api_call(mocker):
    mock_response = mocker.patch('requests.get')
    mock_response.return_value.json.return_value = {"status": "ok"}
    
    result = api_call()
    assert result["status"] == "ok"
```

**æµ‹è¯•æ‰§è¡Œç­–ç•¥**ï¼š
```bash
# å¼€å‘é˜¶æ®µï¼šåªè¿è¡Œå¿«é€Ÿæµ‹è¯•
pytest -m "not slow"

# æäº¤å‰ï¼šè¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# CI/CDï¼šå¹¶è¡Œæ‰§è¡Œæ‰€æœ‰æµ‹è¯•
pytest -n auto --cov=src --cov-report=xml
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ pytestæ¡†æ¶ï¼šPythonæœ€æµè¡Œçš„æµ‹è¯•æ¡†æ¶ï¼Œç®€æ´å¼ºå¤§
ğŸ”¸ åŸºç¡€ç”¨æ³•ï¼šæ™®é€šå‡½æ•°+assertè¯­å¥å³å¯ç¼–å†™æµ‹è¯•
ğŸ”¸ fixtureæœºåˆ¶ï¼šæµ‹è¯•å‰å‡†å¤‡å’Œæµ‹è¯•åæ¸…ç†çš„æ ¸å¿ƒå·¥å…·
ğŸ”¸ å‚æ•°åŒ–æµ‹è¯•ï¼šä¸€ä¸ªæµ‹è¯•å‡½æ•°æµ‹è¯•å¤šç»„æ•°æ®
ğŸ”¸ æ’ä»¶ç³»ç»Ÿï¼šä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€æ‰©å±•åŠŸèƒ½
ğŸ”¸ é…ç½®ç®¡ç†ï¼špytest.iniå’Œconftest.pyé…ç½®æµ‹è¯•è¡Œä¸º
ğŸ”¸ æŠ¥å‘Šç”Ÿæˆï¼šå¤šç§æ ¼å¼çš„æµ‹è¯•æŠ¥å‘Šå’Œè¦†ç›–ç‡ç»Ÿè®¡
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆé€‰æ‹©pytest**
```
ç®€æ´æ€§ï¼š
- ä¸éœ€è¦ç»§æ‰¿ç±»ï¼Œæ™®é€šå‡½æ•°å³å¯
- ä½¿ç”¨PythonåŸç”Ÿassertï¼Œå­¦ä¹ æˆæœ¬ä½
- è‡ªåŠ¨å‘ç°æµ‹è¯•ï¼Œæ— éœ€æ‰‹åŠ¨æ³¨å†Œ

å¼ºå¤§æ€§ï¼š
- æ™ºèƒ½æ–­è¨€ä¿¡æ¯ï¼Œå¤±è´¥æ—¶æ˜¾ç¤ºè¯¦ç»†å·®å¼‚
- ä¸°å¯Œçš„fixtureç³»ç»Ÿï¼Œçµæ´»å¤„ç†æµ‹è¯•ä¾èµ–
- å‚æ•°åŒ–æµ‹è¯•ï¼Œå‡å°‘é‡å¤ä»£ç 
- å¼ºå¤§çš„æ’ä»¶ç”Ÿæ€ï¼Œæ»¡è¶³å„ç§éœ€æ±‚
```

**ğŸ”¹ fixtureçš„æ ¸å¿ƒä»·å€¼**
```
æµ‹è¯•éš”ç¦»ï¼š
- æ¯ä¸ªæµ‹è¯•ç‹¬ç«‹çš„ç¯å¢ƒ
- é¿å…æµ‹è¯•é—´ç›¸äº’å½±å“
- æ¸…ç†èµ„æºé˜²æ­¢æ³„éœ²

ä»£ç å¤ç”¨ï¼š
- å…±äº«æµ‹è¯•å‡†å¤‡ä»£ç 
- å‡å°‘é‡å¤ï¼Œæé«˜ç»´æŠ¤æ€§
- åˆ†å±‚è®¾è®¡ï¼ŒèŒè´£æ¸…æ™°
```

**ğŸ”¹ æœ€ä½³å®è·µçš„é‡è¦æ€§**
```
å¯ç»´æŠ¤æ€§ï¼š
- æ¸…æ™°çš„å‘½åå’Œç»„ç»‡
- é€‚å½“çš„æµ‹è¯•ç²’åº¦
- è‰¯å¥½çš„æ–‡æ¡£å’Œæ³¨é‡Š

å¯æ‰©å±•æ€§ï¼š
- æ¨¡å—åŒ–çš„æµ‹è¯•è®¾è®¡
- çµæ´»çš„é…ç½®ç®¡ç†
- æ”¯æŒå¤šç¯å¢ƒéƒ¨ç½²
```

### 10.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ å¼€å‘é˜¶æ®µåº”ç”¨**
- **å•å…ƒæµ‹è¯•**ï¼šéªŒè¯å‡½æ•°å’Œç±»çš„æ­£ç¡®æ€§
- **é›†æˆæµ‹è¯•**ï¼šéªŒè¯æ¨¡å—é—´çš„åä½œ
- **å›å½’æµ‹è¯•**ï¼šç¡®ä¿æ–°åŠŸèƒ½ä¸ç ´åç°æœ‰åŠŸèƒ½

**ğŸ¯ å›¢é˜Ÿåä½œä»·å€¼**
- **ä»£ç è´¨é‡ä¿è¯**ï¼šæµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆTDDï¼‰
- **æŒç»­é›†æˆ**ï¼šè‡ªåŠ¨åŒ–æµ‹è¯•æµæ°´çº¿
- **æ–‡æ¡£ä½œç”¨**ï¼šæµ‹è¯•å³æ–‡æ¡£ï¼Œå±•ç¤ºä½¿ç”¨æ–¹å¼

**ğŸ¯ é¡¹ç›®ç»´æŠ¤ä¼˜åŠ¿**
- **é‡æ„ä¿¡å¿ƒ**ï¼šæœ‰æµ‹è¯•ä¿æŠ¤çš„é‡æ„æ›´å®‰å…¨
- **Bugå®šä½**ï¼šå¿«é€Ÿå®šä½å’Œä¿®å¤é—®é¢˜
- **æ€§èƒ½ç›‘æ§**ï¼šé€šè¿‡æµ‹è¯•ç›‘æ§æ€§èƒ½å˜åŒ–

### 10.4 å­¦ä¹ è·¯å¾„å»ºè®®


**ğŸ“š æ–°æ‰‹å­¦ä¹ è·¯å¾„**
```
ç¬¬1é˜¶æ®µï¼šåŸºç¡€å…¥é—¨ï¼ˆ1-2å‘¨ï¼‰
â”œâ”€â”€ å®‰è£…pytestï¼Œç¼–å†™ç¬¬ä¸€ä¸ªæµ‹è¯•
â”œâ”€â”€ æŒæ¡åŸºæœ¬æ–­è¨€å’Œå‘½ä»¤è¡Œä½¿ç”¨
â””â”€â”€ ç†è§£æµ‹è¯•å‘ç°å’Œç»„ç»‡

ç¬¬2é˜¶æ®µï¼šè¿›é˜¶åº”ç”¨ï¼ˆ2-3å‘¨ï¼‰  
â”œâ”€â”€ å­¦ä¼šä½¿ç”¨fixture
â”œâ”€â”€ æŒæ¡å‚æ•°åŒ–æµ‹è¯•
â””â”€â”€ äº†è§£å¸¸ç”¨æ’ä»¶

ç¬¬3é˜¶æ®µï¼šé«˜çº§å®è·µï¼ˆ3-4å‘¨ï¼‰
â”œâ”€â”€ è‡ªå®šä¹‰æ’ä»¶å’Œé’©å­
â”œâ”€â”€ å¤æ‚é¡¹ç›®çš„æµ‹è¯•ç»„ç»‡
â””â”€â”€ CI/CDé›†æˆå’Œæœ€ä½³å®è·µ
```

**ğŸ”§ å®è·µé¡¹ç›®å»ºè®®**
- **ä¸ªäººé¡¹ç›®**ï¼šä¸ºè‡ªå·±çš„é¡¹ç›®æ·»åŠ å®Œæ•´æµ‹è¯•
- **å¼€æºè´¡çŒ®**ï¼šå‚ä¸å¼€æºé¡¹ç›®çš„æµ‹è¯•ç¼–å†™  
- **ä¼ä¸šåº”ç”¨**ï¼šåœ¨å·¥ä½œä¸­æ¨å¹¿æµ‹è¯•æ–‡åŒ–

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
pytestæµ‹è¯•å¾ˆç®€å•ï¼Œ
å‡½æ•°åŠ ä¸Šassertæ–­è¨€ï¼Œ
fixtureå‡†å¤‡æµ‹è¯•ç¯å¢ƒï¼Œ
å‚æ•°åŒ–å‡å°‘é‡å¤ç¹ï¼Œ
æ’ä»¶æ‰©å±•åŠŸèƒ½å¼ºï¼Œ
é…ç½®æ–‡ä»¶ç®¡è§„èŒƒï¼Œ
æŠ¥å‘Šè¦†ç›–ç‡è¦çœ‹ï¼Œ
æœ€ä½³å®è·µæ˜¯å…³é”®ï¼
```