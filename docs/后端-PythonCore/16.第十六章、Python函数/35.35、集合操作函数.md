---
title: 35ã€é›†åˆæ“ä½œå‡½æ•°
---
## ğŸ“š ç›®å½•

1. [collectionsæ¨¡å—æ¦‚è¿°](#1-collectionsæ¨¡å—æ¦‚è¿°)
2. [Counterè®¡æ•°å™¨](#2-Counterè®¡æ•°å™¨)
3. [defaultdicté»˜è®¤å­—å…¸](#3-defaultdicté»˜è®¤å­—å…¸)
4. [dequeåŒç«¯é˜Ÿåˆ—](#4-dequeåŒç«¯é˜Ÿåˆ—)
5. [namedtupleå‘½åå…ƒç»„](#5-namedtupleå‘½åå…ƒç»„)
6. [å®é™…åº”ç”¨åœºæ™¯](#6-å®é™…åº”ç”¨åœºæ™¯)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ“¦ collectionsæ¨¡å—æ¦‚è¿°


### 1.1 collectionsæ˜¯ä»€ä¹ˆ


**ğŸ”¸ ç®€å•ç†è§£**
```
collections = æ”¶é›† + é›†åˆ
å°±åƒä¸€ä¸ªå·¥å…·ç®±ï¼Œè£…ç€å„ç§å¢å¼ºç‰ˆçš„æ•°æ®å®¹å™¨
æ¯”æ™®é€šçš„listã€dictæ›´å¼ºå¤§ã€æ›´å¥½ç”¨
```

**ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦collections**
æƒ³è±¡ä¸€ä¸‹æ—¥å¸¸åœºæ™¯ï¼š
- ğŸ“Š **ç»Ÿè®¡æ•°æ®**ï¼šç»Ÿè®¡æ–‡ç« ä¸­æ¯ä¸ªå•è¯å‡ºç°æ¬¡æ•°
- ğŸ  **åˆ†ç±»æ•´ç†**ï¼šæŠŠå­¦ç”ŸæŒ‰ç­çº§åˆ†ç»„ï¼Œç¼ºå°‘çš„ç­çº§è‡ªåŠ¨åˆ›å»ºç©ºåˆ—è¡¨
- ğŸš€ **é«˜æ•ˆæ“ä½œ**ï¼šéœ€è¦åœ¨åˆ—è¡¨ä¸¤ç«¯é¢‘ç¹æ·»åŠ åˆ é™¤å…ƒç´ 
- ğŸ“‹ **ç»“æ„åŒ–æ•°æ®**ï¼šç”¨åæ ‡(x,y)è¡¨ç¤ºä½ç½®ï¼Œä½†æƒ³é€šè¿‡åå­—è®¿é—®

æ™®é€šçš„æ•°æ®ç±»å‹å¤„ç†è¿™äº›åœºæ™¯æ¯”è¾ƒéº»çƒ¦ï¼Œcollectionsæä¾›äº†ä¸“é—¨çš„å·¥å…·ã€‚

### 1.2 æ ¸å¿ƒç‰¹ç‚¹


```
ğŸ¯ ä¸“ä¸šåŒ–ï¼šæ¯ä¸ªå·¥å…·éƒ½ä¸“é—¨è§£å†³ç‰¹å®šé—®é¢˜
âš¡ é«˜æ•ˆç‡ï¼šæ€§èƒ½æ¯”è‡ªå·±å†™çš„ä»£ç æ›´ä¼˜
ğŸ›¡ï¸ å®‰å…¨æ€§ï¼šå‡å°‘å¸¸è§ç¼–ç¨‹é”™è¯¯
ğŸ“š æ˜“ç”¨æ€§ï¼šæ¥å£ç®€å•ï¼Œå­¦ä¼šå°±èƒ½ç”¨
```

---

## 2. ğŸ“Š Counterè®¡æ•°å™¨


### 2.1 Counteræ˜¯ä»€ä¹ˆ


**ğŸ”¸ ç”Ÿæ´»ä¸­çš„è®¡æ•°å™¨**
```
è¶…å¸‚æ”¶é“¶å°ï¼šå“” - è‹¹æœ+1ï¼Œå“” - é¦™è•‰+1ï¼Œå“” - è‹¹æœ+1
æœ€åç»Ÿè®¡ï¼šè‹¹æœ2ä¸ªï¼Œé¦™è•‰1ä¸ª

Counterå°±æ˜¯è¿™æ ·ä¸€ä¸ªè‡ªåŠ¨è®¡æ•°çš„å·¥å…·
```

**ğŸ’¡ åŸºæœ¬æ¦‚å¿µ**
```python
from collections import Counter

# è‡ªåŠ¨ç»Ÿè®¡æ¯ä¸ªå…ƒç´ å‡ºç°çš„æ¬¡æ•°
fruits = ['apple', 'banana', 'apple', 'orange', 'banana', 'apple']
counter = Counter(fruits)
print(counter)  # Counter({'apple': 3, 'banana': 2, 'orange': 1})
```

### 2.2 Counterçš„å¸¸ç”¨æ–¹æ³•


#### ğŸ”¸ åˆ›å»ºCounterçš„æ–¹å¼


```python
# æ–¹å¼1ï¼šä»åˆ—è¡¨åˆ›å»º
colors = ['red', 'blue', 'red', 'green', 'blue', 'red']
color_count = Counter(colors)

# æ–¹å¼2ï¼šä»å­—ç¬¦ä¸²åˆ›å»º
text = "hello world"
char_count = Counter(text)  # ç»Ÿè®¡æ¯ä¸ªå­—ç¬¦

# æ–¹å¼3ï¼šä»å­—å…¸åˆ›å»º
grade_count = Counter({'A': 5, 'B': 3, 'C': 2})

# æ–¹å¼4ï¼šç©ºCounteråç»­æ·»åŠ 
empty_counter = Counter()
empty_counter['apple'] = 3
```

#### ğŸ”¸ å®ç”¨æ–¹æ³•è¯¦è§£


**ğŸ“ˆ most_common() - æ‰¾å‡ºæœ€å¸¸è§çš„**
```python
fruits = ['apple', 'banana', 'apple', 'orange', 'banana', 'apple']
counter = Counter(fruits)

# æœ€å¸¸è§çš„2ä¸ª
top2 = counter.most_common(2)
print(top2)  # [('apple', 3), ('banana', 2)]

# è·å–æ‰€æœ‰ï¼ŒæŒ‰é¢‘ç‡æ’åº
all_sorted = counter.most_common()
print(all_sorted)  # [('apple', 3), ('banana', 2), ('orange', 1)]
```

**ğŸ§® æ•°å­¦è¿ç®—**
```python
counter1 = Counter(['a', 'b', 'c', 'a'])  # Counter({'a': 2, 'b': 1, 'c': 1})
counter2 = Counter(['a', 'b', 'b'])       # Counter({'a': 1, 'b': 2})

# åŠ æ³•ï¼šåˆå¹¶è®¡æ•°
combined = counter1 + counter2  # Counter({'a': 3, 'b': 3, 'c': 1})

# å‡æ³•ï¼šå‡å»è®¡æ•°ï¼ˆè´Ÿæ•°ä¼šè¢«å¿½ç•¥ï¼‰
difference = counter1 - counter2  # Counter({'c': 1, 'a': 1})

# äº¤é›†ï¼šå–æœ€å°å€¼
intersection = counter1 & counter2  # Counter({'a': 1, 'b': 1})

# å¹¶é›†ï¼šå–æœ€å¤§å€¼
union = counter1 | counter2  # Counter({'a': 2, 'b': 2, 'c': 1})
```

### 2.3 å®é™…åº”ç”¨ç¤ºä¾‹


**ğŸ“ ç»Ÿè®¡æ–‡ç« è¯é¢‘**
```python
def count_words(text):
    # ç®€å•å¤„ç†ï¼šè½¬å°å†™ï¼ŒæŒ‰ç©ºæ ¼åˆ†å‰²
    words = text.lower().split()
    # å»é™¤æ ‡ç‚¹ï¼ˆç®€åŒ–å¤„ç†ï¼‰
    cleaned_words = [word.strip('.,!?;') for word in words]
    
    word_counter = Counter(cleaned_words)
    return word_counter.most_common(10)  # è¿”å›å‰10ä¸ªé«˜é¢‘è¯

text = "Python is great. Python is powerful. I love Python programming."
top_words = count_words(text)
print(top_words)  # [('python', 3), ('is', 2), ...]
```

**ğŸ¯ æˆç»©ç»Ÿè®¡åˆ†æ**
```python
grades = ['A', 'B', 'A', 'C', 'B', 'A', 'A', 'C', 'B']
grade_counter = Counter(grades)

print(f"Aç­‰: {grade_counter['A']}äºº")  # Aç­‰: 4äºº
print(f"æœ€å¤šçš„ç­‰çº§: {grade_counter.most_common(1)[0]}")  # ('A', 4)

# è®¡ç®—ç™¾åˆ†æ¯”
total = sum(grade_counter.values())
for grade, count in grade_counter.items():
    percentage = (count / total) * 100
    print(f"{grade}ç­‰: {percentage:.1f}%")
```

---

## 3. ğŸ  defaultdicté»˜è®¤å­—å…¸


### 3.1 defaultdictè§£å†³ä»€ä¹ˆé—®é¢˜


**ğŸ¤” æ™®é€šå­—å…¸çš„çƒ¦æ¼**
```python
# æŒ‰ç­çº§åˆ†ç»„å­¦ç”Ÿï¼Œæ™®é€šå­—å…¸å¾ˆéº»çƒ¦
students = [('å¼ ä¸‰', '1ç­'), ('æå››', '2ç­'), ('ç‹äº”', '1ç­')]
class_dict = {}

for name, class_name in students:
    if class_name not in class_dict:  # æ¯æ¬¡éƒ½è¦æ£€æŸ¥
        class_dict[class_name] = []   # æ‰‹åŠ¨åˆ›å»ºç©ºåˆ—è¡¨
    class_dict[class_name].append(name)
```

**âœ¨ defaultdictçš„ä¼˜é›…è§£å†³**
```python
from collections import defaultdict

# å‘Šè¯‰defaultdictï¼šå¦‚æœkeyä¸å­˜åœ¨ï¼Œè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªlist
class_dict = defaultdict(list)

for name, class_name in students:
    class_dict[class_name].append(name)  # ä¸ç”¨æ£€æŸ¥ï¼Œè‡ªåŠ¨åˆ›å»ºï¼

print(dict(class_dict))  # {'1ç­': ['å¼ ä¸‰', 'ç‹äº”'], '2ç­': ['æå››']}
```

### 3.2 defaultdictçš„å·¥å‚å‡½æ•°


**ğŸ”¸ å¸¸ç”¨çš„å·¥å‚å‡½æ•°**

```python
# intå·¥å‚ï¼šé»˜è®¤å€¼ä¸º0ï¼Œé€‚åˆè®¡æ•°
count_dict = defaultdict(int)
count_dict['apple'] += 1  # ç¬¬ä¸€æ¬¡è®¿é—®è‡ªåŠ¨ä¸º0ï¼Œç„¶å+1
count_dict['apple'] += 1  # ç°åœ¨æ˜¯2

# listå·¥å‚ï¼šé»˜è®¤å€¼ä¸ºç©ºåˆ—è¡¨ï¼Œé€‚åˆåˆ†ç»„
group_dict = defaultdict(list)
group_dict['fruits'].append('apple')

# setå·¥å‚ï¼šé»˜è®¤å€¼ä¸ºç©ºé›†åˆï¼Œé€‚åˆå»é‡æ”¶é›†
tag_dict = defaultdict(set)
tag_dict['python'].add('programming')
tag_dict['python'].add('language')

# è‡ªå®šä¹‰å·¥å‚å‡½æ•°
def default_value():
    return "æœªçŸ¥"

info_dict = defaultdict(default_value)
print(info_dict['ä¸å­˜åœ¨çš„key'])  # "æœªçŸ¥"
```

### 3.3 å®é™…åº”ç”¨åœºæ™¯


**ğŸ“Š æ•°æ®åˆ†ç»„ç»Ÿè®¡**
```python
# é”€å”®æ•°æ®ï¼š(å•†å“, åœ°åŒº, é”€é‡)
sales_data = [
    ('æ‰‹æœº', 'åŒ—äº¬', 100),
    ('ç”µè„‘', 'ä¸Šæµ·', 80),
    ('æ‰‹æœº', 'ä¸Šæµ·', 120),
    ('ç”µè„‘', 'åŒ—äº¬', 90)
]

# æŒ‰åœ°åŒºç»Ÿè®¡å„å•†å“é”€é‡
region_sales = defaultdict(lambda: defaultdict(int))

for product, region, amount in sales_data:
    region_sales[region][product] += amount

# ç»“æœï¼š{'åŒ—äº¬': {'æ‰‹æœº': 100, 'ç”µè„‘': 90}, 'ä¸Šæµ·': {'ç”µè„‘': 80, 'æ‰‹æœº': 120}}
for region, products in region_sales.items():
    print(f"{region}åœ°åŒº:")
    for product, total in products.items():
        print(f"  {product}: {total}å°")
```

**ğŸŒ ç½‘é¡µé“¾æ¥åˆ†æ**
```python
# åˆ†æå“ªäº›é¡µé¢é“¾æ¥åˆ°å“ªäº›é¡µé¢
links = [
    ('index.html', 'about.html'),
    ('index.html', 'contact.html'),
    ('about.html', 'index.html'),
    ('contact.html', 'index.html')
]

# å…¥é“¾åˆ†æï¼šå“ªäº›é¡µé¢è¢«å…¶ä»–é¡µé¢é“¾æ¥
incoming_links = defaultdict(list)
for source, target in links:
    incoming_links[target].append(source)

print("é¡µé¢å…¥é“¾åˆ†æ:")
for page, sources in incoming_links.items():
    print(f"{page} è¢« {sources} é“¾æ¥")
```

---

## 4. ğŸš€ dequeåŒç«¯é˜Ÿåˆ—


### 4.1 dequeæ˜¯ä»€ä¹ˆ


**ğŸ”¸ ç”Ÿæ´»ä¸­çš„é˜Ÿåˆ—**
```
æ™®é€šé˜Ÿåˆ—ï¼ˆlistï¼‰ï¼š
æ’é˜Ÿä¹°ç¥¨ â†’ [äºº1, äºº2, äºº3, äºº4] â† æ–°äººåªèƒ½ä»åé¢è¿›

åŒç«¯é˜Ÿåˆ—ï¼ˆdequeï¼‰ï¼š
åœ°é“ç«™å° â†’ [äºº1, äºº2, äºº3, äºº4] â† ä¸¤è¾¹éƒ½å¯ä»¥è¿›å‡º
```

**ğŸ’¡ æ€§èƒ½å¯¹æ¯”**
```
listçš„é—®é¢˜ï¼š
- åœ¨å¼€å¤´æ’å…¥/åˆ é™¤å¾ˆæ…¢ O(n)
- åœ¨æœ«å°¾æ“ä½œå¾ˆå¿« O(1)

dequeçš„ä¼˜åŠ¿ï¼š
- ä¸¤ç«¯æ“ä½œéƒ½å¾ˆå¿« O(1)
- ä¸­é—´æ“ä½œç›¸å¯¹è¾ƒæ…¢ O(n)
```

### 4.2 dequeåŸºæœ¬æ“ä½œ


```python
from collections import deque

# åˆ›å»ºdeque
dq = deque([1, 2, 3])
print(dq)  # deque([1, 2, 3])

# å³ç«¯æ“ä½œï¼ˆæœ«å°¾ï¼‰
dq.append(4)        # æœ«å°¾æ·»åŠ 
dq.appendleft(0)    # å¼€å¤´æ·»åŠ 
print(dq)           # deque([0, 1, 2, 3, 4])

# å³ç«¯åˆ é™¤
last = dq.pop()     # åˆ é™¤æœ«å°¾ï¼Œè¿”å›4
first = dq.popleft() # åˆ é™¤å¼€å¤´ï¼Œè¿”å›0
print(dq)           # deque([1, 2, 3])

# æ‰©å±•æ“ä½œ
dq.extend([4, 5])           # å³ç«¯æ‰©å±•
dq.extendleft([0, -1])      # å·¦ç«¯æ‰©å±•ï¼ˆæ³¨æ„é¡ºåºï¼ï¼‰
print(dq)                   # deque([-1, 0, 1, 2, 3, 4, 5])
```

### 4.3 dequeç‰¹æ®ŠåŠŸèƒ½


**ğŸ”„ æ—‹è½¬æ“ä½œ**
```python
dq = deque([1, 2, 3, 4, 5])

# å‘å³æ—‹è½¬2ä½
dq.rotate(2)
print(dq)  # deque([4, 5, 1, 2, 3])

# å‘å·¦æ—‹è½¬3ä½
dq.rotate(-3)
print(dq)  # deque([2, 3, 4, 5, 1])
```

**ğŸ“ é™åˆ¶é•¿åº¦çš„deque**
```python
# æœ€å¤šä¿å­˜3ä¸ªå…ƒç´ çš„æ»‘åŠ¨çª—å£
window = deque(maxlen=3)

for i in range(1, 7):
    window.append(i)
    print(f"æ·»åŠ  {i}: {list(window)}")

# è¾“å‡ºï¼š
# æ·»åŠ  1: [1]
# æ·»åŠ  2: [1, 2]
# æ·»åŠ  3: [1, 2, 3]
# æ·»åŠ  4: [2, 3, 4]  # è‡ªåŠ¨åˆ é™¤æœ€å·¦è¾¹çš„
# æ·»åŠ  5: [3, 4, 5]
# æ·»åŠ  6: [4, 5, 6]
```

### 4.4 å®é™…åº”ç”¨åœºæ™¯


**ğŸ“ˆ æ»‘åŠ¨çª—å£å¹³å‡å€¼**
```python
def moving_average(data, window_size):
    """è®¡ç®—æ»‘åŠ¨å¹³å‡å€¼"""
    window = deque(maxlen=window_size)
    averages = []
    
    for num in data:
        window.append(num)
        if len(window) == window_size:
            avg = sum(window) / window_size
            averages.append(avg)
    
    return averages

prices = [10, 12, 13, 12, 15, 16, 14, 18, 17, 19]
ma3 = moving_average(prices, 3)  # 3æ—¥ç§»åŠ¨å¹³å‡
print(ma3)  # [11.67, 12.33, 13.33, 14.33, 15.0, 16.0, 16.33, 18.0]
```

**ğŸŒ ç½‘é¡µæµè§ˆå†å²**
```python
class BrowserHistory:
    def __init__(self, max_history=10):
        self.history = deque(maxlen=max_history)
        self.current_pos = -1
    
    def visit(self, url):
        """è®¿é—®æ–°é¡µé¢"""
        # å¦‚æœåœ¨å†å²ä¸­é—´ï¼Œæ¸…é™¤åé¢çš„å†å²
        while len(self.history) > self.current_pos + 1:
            self.history.pop()
        
        self.history.append(url)
        self.current_pos = len(self.history) - 1
    
    def back(self):
        """åé€€"""
        if self.current_pos > 0:
            self.current_pos -= 1
            return self.history[self.current_pos]
        return None
    
    def forward(self):
        """å‰è¿›"""
        if self.current_pos < len(self.history) - 1:
            self.current_pos += 1
            return self.history[self.current_pos]
        return None

# ä½¿ç”¨ç¤ºä¾‹
browser = BrowserHistory()
browser.visit("www.google.com")
browser.visit("www.python.org")
browser.visit("www.github.com")

print(browser.back())     # www.python.org
print(browser.back())     # www.google.com
print(browser.forward())  # www.python.org
```

---

## 5. ğŸ“‹ namedtupleå‘½åå…ƒç»„


### 5.1 namedtupleè§£å†³ä»€ä¹ˆé—®é¢˜


**ğŸ¤” æ™®é€šå…ƒç»„çš„å›°æ‰°**
```python
# è¡¨ç¤ºä¸€ä¸ªå­¦ç”Ÿï¼š(å§“å, å¹´é¾„, æˆç»©)
student = ("å¼ ä¸‰", 18, 85)

# å‡ å¤©åçœ‹ä»£ç ï¼Œè°è¿˜è®°å¾—ä½ç½®0æ˜¯ä»€ä¹ˆï¼Ÿ
name = student[0]  # è¿™æ˜¯å§“åï¼Ÿå¹´é¾„ï¼Ÿæˆç»©ï¼Ÿ
age = student[1]   # å®¹æ˜“ææ··
score = student[2]

# å¦‚æœè¦ä¿®æ”¹ç»“æ„ï¼Œæ‰€æœ‰ä»£ç éƒ½è¦æ”¹
```

**âœ¨ namedtupleçš„ä¼˜é›…è§£å†³**
```python
from collections import namedtuple

# å®šä¹‰å­¦ç”Ÿæ•°æ®ç»“æ„
Student = namedtuple('Student', ['name', 'age', 'score'])

# åˆ›å»ºå­¦ç”Ÿå¯¹è±¡
student = Student("å¼ ä¸‰", 18, 85)

# é€šè¿‡åå­—è®¿é—®ï¼Œæ¸…æ™°æ˜äº†
print(student.name)   # å¼ ä¸‰
print(student.age)    # 18
print(student.score)  # 85

# ä»ç„¶å¯ä»¥åƒå…ƒç»„ä¸€æ ·ä½¿ç”¨
print(student[0])     # å¼ ä¸‰ï¼ˆå‘åå…¼å®¹ï¼‰
name, age, score = student  # è§£åŒ…
```

### 5.2 namedtupleçš„ç‰¹ç‚¹


**ğŸ”¸ æ ¸å¿ƒç‰¹æ€§**
```python
Point = namedtuple('Point', ['x', 'y'])
p1 = Point(3, 4)

# 1. ä¸å¯å˜ï¼ˆåƒå…ƒç»„ï¼‰
# p1.x = 5  # é”™è¯¯ï¼ä¸èƒ½ä¿®æ”¹

# 2. æœ‰åå­—çš„å±æ€§è®¿é—®
print(f"åæ ‡: ({p1.x}, {p1.y})")

# 3. ä»ç„¶æ˜¯å…ƒç»„
print(isinstance(p1, tuple))  # True

# 4. æ”¯æŒå…ƒç»„çš„æ‰€æœ‰æ“ä½œ
print(len(p1))      # 2
print(p1[0])        # 3
print(p1 + (5,))    # (3, 4, 5)
```

**ğŸ› ï¸ å®ç”¨æ–¹æ³•**
```python
Person = namedtuple('Person', ['name', 'age', 'city'])
person = Person("æå››", 25, "åŒ—äº¬")

# _replaceï¼šåˆ›å»ºä¿®æ”¹åçš„æ–°å¯¹è±¡
new_person = person._replace(age=26)
print(new_person)  # Person(name='æå››', age=26, city='åŒ—äº¬')

# _asdictï¼šè½¬æ¢ä¸ºå­—å…¸
person_dict = person._asdict()
print(person_dict)  # {'name': 'æå››', 'age': 25, 'city': 'åŒ—äº¬'}

# _fieldsï¼šæŸ¥çœ‹æ‰€æœ‰å­—æ®µ
print(Person._fields)  # ('name', 'age', 'city')

# _makeï¼šä»å¯è¿­ä»£å¯¹è±¡åˆ›å»º
data = ["ç‹äº”", 30, "ä¸Šæµ·"]
new_person = Person._make(data)
print(new_person)  # Person(name='ç‹äº”', age=30, city='ä¸Šæµ·')
```

### 5.3 å®é™…åº”ç”¨åœºæ™¯


**ğŸ“Š æ•°æ®åˆ†æç»“æ„**
```python
# è‚¡ç¥¨æ•°æ®
Stock = namedtuple('Stock', ['symbol', 'price', 'volume', 'change'])

stocks = [
    Stock('AAPL', 150.25, 1000000, 2.5),
    Stock('GOOGL', 2800.50, 500000, -1.2),
    Stock('TSLA', 800.75, 800000, 5.8)
]

# è®¡ç®—æ¶¨å¹…æœ€å¤§çš„è‚¡ç¥¨
best_performer = max(stocks, key=lambda s: s.change)
print(f"æ¶¨å¹…æœ€å¤§: {best_performer.symbol} +{best_performer.change}%")

# è®¡ç®—æ€»æˆäº¤é‡
total_volume = sum(stock.volume for stock in stocks)
print(f"æ€»æˆäº¤é‡: {total_volume:,}")
```

**ğŸ® æ¸¸æˆå¼€å‘**
```python
# æ¸¸æˆä¸­çš„åæ ‡å’Œå‘é‡
Vector2D = namedtuple('Vector2D', ['x', 'y'])
Player = namedtuple('Player', ['name', 'position', 'health', 'level'])

def move_player(player, direction):
    """ç§»åŠ¨ç©å®¶"""
    new_pos = Vector2D(
        player.position.x + direction.x,
        player.position.y + direction.y
    )
    return player._replace(position=new_pos)

# åˆ›å»ºç©å®¶
player = Player("å‹‡è€…", Vector2D(0, 0), 100, 1)
print(f"ç©å®¶ä½ç½®: ({player.position.x}, {player.position.y})")

# ç§»åŠ¨ç©å®¶
move_direction = Vector2D(1, 0)  # å‘å³ç§»åŠ¨
player = move_player(player, move_direction)
print(f"æ–°ä½ç½®: ({player.position.x}, {player.position.y})")
```

**ğŸ“ˆ é…ç½®ç®¡ç†**
```python
# åº”ç”¨é…ç½®
Config = namedtuple('Config', [
    'database_url', 'cache_timeout', 'debug_mode', 'max_connections'
])

# å¼€å‘ç¯å¢ƒé…ç½®
dev_config = Config(
    database_url="sqlite:///dev.db",
    cache_timeout=60,
    debug_mode=True,
    max_connections=10
)

# ç”Ÿäº§ç¯å¢ƒé…ç½®
prod_config = dev_config._replace(
    database_url="postgresql://prod_server/db",
    debug_mode=False,
    max_connections=100
)

def connect_database(config):
    if config.debug_mode:
        print(f"è°ƒè¯•æ¨¡å¼: è¿æ¥ {config.database_url}")
    else:
        print(f"ç”Ÿäº§æ¨¡å¼: è¿æ¥ {config.database_url}")

connect_database(dev_config)   # è°ƒè¯•æ¨¡å¼
connect_database(prod_config)  # ç”Ÿäº§æ¨¡å¼
```

---

## 6. ğŸ¯ å®é™…åº”ç”¨åœºæ™¯


### 6.1 æ–‡æœ¬åˆ†æç³»ç»Ÿ


```python
from collections import Counter, defaultdict, namedtuple

# å®šä¹‰æ•°æ®ç»“æ„
Article = namedtuple('Article', ['title', 'content', 'author', 'category'])
AnalysisResult = namedtuple('AnalysisResult', ['word_freq', 'author_stats', 'category_dist'])

def analyze_articles(articles):
    """åˆ†ææ–‡ç« æ•°æ®"""
    all_words = []
    author_articles = defaultdict(list)
    category_count = Counter()
    
    for article in articles:
        # æ”¶é›†æ‰€æœ‰å•è¯
        words = article.content.lower().split()
        all_words.extend(words)
        
        # æŒ‰ä½œè€…åˆ†ç»„
        author_articles[article.author].append(article.title)
        
        # ç»Ÿè®¡ç±»åˆ«
        category_count[article.category] += 1
    
    # è¯é¢‘åˆ†æ
    word_freq = Counter(all_words).most_common(10)
    
    # ä½œè€…ç»Ÿè®¡
    author_stats = {author: len(articles) for author, articles in author_articles.items()}
    
    return AnalysisResult(word_freq, author_stats, dict(category_count))

# ç¤ºä¾‹æ•°æ®
articles = [
    Article("PythonåŸºç¡€", "python programming language basics", "å¼ ä¸‰", "æŠ€æœ¯"),
    Article("æ•°æ®åˆ†æ", "python data analysis pandas numpy", "æå››", "æŠ€æœ¯"),
    Article("æ—…æ¸¸æ”»ç•¥", "travel guide beautiful places", "å¼ ä¸‰", "ç”Ÿæ´»")
]

result = analyze_articles(articles)
print("é«˜é¢‘è¯æ±‡:", result.word_freq)
print("ä½œè€…ç»Ÿè®¡:", result.author_stats)
print("ç±»åˆ«åˆ†å¸ƒ:", result.category_dist)
```

### 6.2 ç½‘ç«™è®¿é—®æ—¥å¿—åˆ†æ


```python
from collections import Counter, defaultdict, deque
from datetime import datetime

# è®¿é—®æ—¥å¿—åˆ†æå™¨
class WebLogAnalyzer:
    def __init__(self, max_recent_ips=100):
        self.ip_counter = Counter()                    # IPè®¿é—®ç»Ÿè®¡
        self.hourly_visits = defaultdict(int)          # å°æ—¶è®¿é—®é‡
        self.recent_ips = deque(maxlen=max_recent_ips) # æœ€è¿‘è®¿é—®IP
    
    def process_log(self, ip, timestamp, url):
        """å¤„ç†ä¸€æ¡æ—¥å¿—"""
        # ç»Ÿè®¡IPè®¿é—®æ¬¡æ•°
        self.ip_counter[ip] += 1
        
        # è®°å½•æœ€è¿‘è®¿é—®çš„IP
        self.recent_ips.append(ip)
        
        # æŒ‰å°æ—¶ç»Ÿè®¡è®¿é—®é‡
        hour = datetime.fromisoformat(timestamp).hour
        self.hourly_visits[hour] += 1
    
    def get_report(self):
        """ç”Ÿæˆåˆ†ææŠ¥å‘Š"""
        return {
            'top_ips': self.ip_counter.most_common(5),
            'peak_hours': sorted(self.hourly_visits.items(), 
                               key=lambda x: x[1], reverse=True)[:3],
            'recent_unique_ips': len(set(self.recent_ips))
        }

# ä½¿ç”¨ç¤ºä¾‹
analyzer = WebLogAnalyzer()

# æ¨¡æ‹Ÿæ—¥å¿—æ•°æ®
logs = [
    ("192.168.1.1", "2024-01-01T10:30:00", "/index.html"),
    ("192.168.1.2", "2024-01-01T10:31:00", "/about.html"),
    ("192.168.1.1", "2024-01-01T11:15:00", "/contact.html"),
    ("192.168.1.3", "2024-01-01T14:20:00", "/products.html"),
]

for ip, timestamp, url in logs:
    analyzer.process_log(ip, timestamp, url)

report = analyzer.get_report()
print("è®¿é—®åˆ†ææŠ¥å‘Š:")
print(f"çƒ­é—¨IP: {report['top_ips']}")
print(f"é«˜å³°æ—¶æ®µ: {report['peak_hours']}")
print(f"æœ€è¿‘ç‹¬ç«‹IPæ•°: {report['recent_unique_ips']}")
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Counterï¼šè‡ªåŠ¨è®¡æ•°å™¨ï¼Œç»Ÿè®¡å…ƒç´ å‡ºç°æ¬¡æ•°
ğŸ”¸ defaultdictï¼šæ™ºèƒ½å­—å…¸ï¼Œè®¿é—®ä¸å­˜åœ¨çš„keyæ—¶è‡ªåŠ¨åˆ›å»ºé»˜è®¤å€¼
ğŸ”¸ dequeï¼šåŒç«¯é˜Ÿåˆ—ï¼Œä¸¤ç«¯æ“ä½œéƒ½å¾ˆå¿«çš„é˜Ÿåˆ—
ğŸ”¸ namedtupleï¼šå‘½åå…ƒç»„ï¼Œæœ‰åå­—çš„ä¸å¯å˜æ•°æ®ç»“æ„
```

### 7.2 é€‰æ‹©æŒ‡å—


| éœ€æ±‚åœºæ™¯ | **æ¨èå·¥å…·** | **ç†ç”±è¯´æ˜** |
|---------|-------------|-------------|
| ğŸ“Š **ç»Ÿè®¡é¢‘ç‡** | `Counter` | `è‡ªåŠ¨è®¡æ•°ï¼Œæ”¯æŒæ•°å­¦è¿ç®—` |
| ğŸ  **æ•°æ®åˆ†ç»„** | `defaultdict` | `è‡ªåŠ¨åˆ›å»ºé»˜è®¤å€¼ï¼Œé¿å…KeyError` |
| ğŸš€ **ä¸¤ç«¯æ“ä½œ** | `deque` | `ä¸¤ç«¯æ’å…¥åˆ é™¤éƒ½æ˜¯O(1)` |
| ğŸ“‹ **ç»“æ„åŒ–æ•°æ®** | `namedtuple` | `æœ‰åå­—çš„å±æ€§ï¼Œä¸å¯å˜ä¸”é«˜æ•ˆ` |

### 7.3 æ€§èƒ½å¯¹æ¯”


```
æ“ä½œæ•ˆç‡å¯¹æ¯”ï¼š

åˆ—è¡¨å¤´éƒ¨æ’å…¥ï¼š
list.insert(0, x)     â†’ O(n) æ…¢
deque.appendleft(x)   â†’ O(1) å¿«

ç»Ÿè®¡å…ƒç´ é¢‘ç‡ï¼š
æ‰‹åŠ¨ç”¨dictç»Ÿè®¡        â†’ ä»£ç å¤æ‚ï¼Œå®¹æ˜“å‡ºé”™
Counterè‡ªåŠ¨ç»Ÿè®¡       â†’ ç®€å•å¯é ï¼ŒåŠŸèƒ½ä¸°å¯Œ

å­—å…¸é»˜è®¤å€¼ï¼š
if key not in dict:   â†’ æ¯æ¬¡éƒ½è¦æ£€æŸ¥
defaultdict           â†’ è‡ªåŠ¨å¤„ç†ï¼Œä»£ç ç®€æ´

æ•°æ®ç»“æ„è®¿é—®ï¼š
tuple[0], tuple[1]    â†’ ä½ç½®è®¿é—®ï¼Œæ˜“æ··æ·†
namedtuple.name       â†’ åå­—è®¿é—®ï¼Œæ¸…æ™°æ˜äº†
```

### 7.4 æœ€ä½³å®è·µå»ºè®®


**ğŸ¯ ä½¿ç”¨åŸåˆ™**
- **Counter**ï¼šéœ€è¦ç»Ÿè®¡æ—¶çš„é¦–é€‰ï¼Œç‰¹åˆ«æ˜¯æ–‡æœ¬åˆ†æ
- **defaultdict**ï¼šåˆ†ç»„æ•°æ®æ—¶å¿…ç”¨ï¼Œé¿å…KeyError
- **deque**ï¼šéœ€è¦é¢‘ç¹åœ¨ä¸¤ç«¯æ“ä½œæ—¶ä½¿ç”¨
- **namedtuple**ï¼šæ›¿ä»£ç®€å•çš„classï¼Œæé«˜ä»£ç å¯è¯»æ€§

**âš ï¸ æ³¨æ„äº‹é¡¹**
- `namedtuple`æ˜¯ä¸å¯å˜çš„ï¼Œä¿®æ”¹éœ€è¦ç”¨`_replace()`
- `deque`ä¸­é—´æ“ä½œè¾ƒæ…¢ï¼Œä¸»è¦ç”¨äºä¸¤ç«¯
- `defaultdict`çš„å·¥å‚å‡½æ•°è¦é€‰å¯¹ï¼Œ`list`ã€`int`ã€`set`æœ€å¸¸ç”¨
- `Counter`çš„æ•°å­¦è¿ç®—ç»“æœä¼šå¿½ç•¥è´Ÿæ•°å’Œé›¶

**ğŸš€ è¿›é˜¶æŠ€å·§**
- ç»„åˆä½¿ç”¨ï¼š`defaultdict(Counter)`å¯ä»¥åšäºŒç»´ç»Ÿè®¡
- æ€§èƒ½ä¼˜åŒ–ï¼šå¤§é‡æ•°æ®ç”¨`Counter`æ¯”æ‰‹åŠ¨dictå¿«
- ä»£ç å¯è¯»æ€§ï¼šç”¨`namedtuple`è®©æ•°æ®ç»“æ„æ›´æ¸…æ™°
- å†…å­˜æ•ˆç‡ï¼š`deque(maxlen=n)`å®ç°å›ºå®šå¤§å°ç¼“å†²åŒº

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- Counteræ•°é¢‘ç‡ï¼Œmost_commonå¾ˆç»™åŠ›
- defaultdicté˜²KeyErrorï¼Œå·¥å‚å‡½æ•°è¦è®°æ¸…
- dequeä¸¤ç«¯å¿«å¦‚é£ï¼Œä¸­é—´æ“ä½œè¦é¿å…  
- namedtupleæœ‰åå­—ï¼Œä¸å¯å˜ä½†å¾ˆæ¸…æ™°