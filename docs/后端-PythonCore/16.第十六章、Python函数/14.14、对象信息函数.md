---
title: 14、对象信息函数
---
## 📚 目录

1. [对象信息函数概述](#1-对象信息函数概述)
2. [id()函数详解](#2-id函数详解)
3. [hash()函数详解](#3-hash函数详解)
4. [object()函数详解](#4-object函数详解)
5. [实际应用场景](#5-实际应用场景)
6. [核心要点总结](#6-核心要点总结)

---

## 1. 🔍 对象信息函数概述


### 1.1 什么是对象信息函数


在Python中，**对象信息函数**就像是给每个数据都配了一张"身份证"。这些函数能帮我们了解对象的基本信息，比如：
- **身份标识**：这个对象在内存中的"地址"
- **指纹信息**：对象的哈希值（用于快速比较和查找）
- **基础模板**：创建最简单的对象

> 💡 **通俗理解**：就像人有身份证号、指纹一样，Python中的每个对象也都有自己的"身份信息"

### 1.2 为什么需要这些函数


```
实际需求场景：

🔸 判断两个变量是否指向同一个对象
🔸 在字典中快速查找对象
🔸 创建自定义类的基础模板
🔸 调试程序时追踪对象变化
```

### 1.3 三个核心函数对比


| 函数 | **作用** | **返回值** | **常用场景** |
|------|---------|-----------|-------------|
| `id()` | 获取对象内存地址 | 整数（地址） | 判断对象是否相同 |
| `hash()` | 获取对象哈希值 | 整数（哈希值） | 字典键值、集合操作 |
| `object()` | 创建基础对象 | 空对象实例 | 类继承、占位符 |

---

## 2. 🆔 id()函数详解


### 2.1 id()函数的基本概念


**id()函数**就像是给每个对象分配一个"门牌号码"，这个号码在对象的整个生命周期内都不会改变。

> 📍 **核心概念**：`id()`返回的是对象在内存中的唯一标识符

### 2.2 基本语法和使用


```python
# 语法格式
id(object)

# 基础示例
a = 100
b = 100
c = 200

print(f"a的id: {id(a)}")    # 输出：a的id: 140712234567520
print(f"b的id: {id(b)}")    # 输出：b的id: 140712234567520  
print(f"c的id: {id(c)}")    # 输出：c的id: 140712234567840
```

### 2.3 深入理解：对象身份 vs 对象值


**重要概念区分**：
- **对象值相等**：内容一样（用`==`比较）
- **对象身份相同**：是同一个对象（用`is`比较）

```python
# 🔸 小整数缓存机制
a = 5
b = 5
print(f"a == b: {a == b}")        # True（值相等）
print(f"a is b: {a is b}")        # True（是同一个对象）
print(f"id(a) == id(b): {id(a) == id(b)}")  # True

# 🔸 大整数不缓存
x = 1000
y = 1000
print(f"x == y: {x == y}")        # True（值相等）
print(f"x is y: {x is y}")        # False（不是同一个对象）
print(f"id(x) == id(y): {id(x) == id(y)}")  # False
```

> ⚠️ **注意**：Python为了节省内存，会缓存小整数（-5到256）和短字符串

### 2.4 不同数据类型的id特性


```python
# 🔸 列表（可变对象）
list1 = [1, 2, 3]
list2 = [1, 2, 3]
print(f"列表内容相等: {list1 == list2}")     # True
print(f"列表是同一个: {list1 is list2}")     # False
print(f"list1的id: {id(list1)}")
print(f"list2的id: {id(list2)}")

# 🔸 字符串（不可变对象）
str1 = "hello"
str2 = "hello"
print(f"字符串是同一个: {str1 is str2}")     # True（字符串缓存）
print(f"id相同: {id(str1) == id(str2)}")    # True
```

### 2.5 实际应用：追踪对象变化


```python
def track_object_changes():
    """演示如何用id()追踪对象变化"""
    
    # 🔸 不可变对象的"修改"
    num = 10
    original_id = id(num)
    print(f"原始数字10的id: {original_id}")
    
    num = num + 5  # "修改"数字
    new_id = id(num)
    print(f"修改后数字15的id: {new_id}")
    print(f"id是否改变: {original_id != new_id}")  # True
    
    # 🔸 可变对象的修改
    my_list = [1, 2, 3]
    original_list_id = id(my_list)
    print(f"原始列表的id: {original_list_id}")
    
    my_list.append(4)  # 修改列表
    new_list_id = id(my_list)
    print(f"修改后列表的id: {new_list_id}")
    print(f"id是否改变: {original_list_id != new_list_id}")  # False

track_object_changes()
```

---

## 3. #️⃣ hash()函数详解


### 3.1 hash()函数的基本概念


**hash()函数**就像是给对象生成一个"指纹"，这个指纹可以用来快速识别和查找对象。

> 💡 **通俗理解**：哈希值就像是给每个对象算出的一个"特征码"，相同内容的对象有相同的特征码

### 3.2 基本语法和特性


```python
# 语法格式
hash(object)

# 基础示例
print(f"数字的哈希: {hash(42)}")          # 42
print(f"字符串的哈希: {hash('hello')}")    # 2314058222093
print(f"元组的哈希: {hash((1, 2, 3))}")   # 529344067295497451
```

### 3.3 可哈希 vs 不可哈希对象


**核心规则**：只有**不可变对象**才能计算哈希值

```python
# ✅ 可以计算哈希的对象（不可变）
hashable_objects = [
    42,                    # 数字
    "hello",              # 字符串  
    (1, 2, 3),           # 元组
    frozenset([1, 2, 3]) # 冻结集合
]

for obj in hashable_objects:
    print(f"{obj} 的哈希值: {hash(obj)}")

# ❌ 不能计算哈希的对象（可变）
try:
    print(hash([1, 2, 3]))  # 列表
except TypeError as e:
    print(f"列表不能哈希: {e}")

try:
    print(hash({"a": 1}))   # 字典
except TypeError as e:
    print(f"字典不能哈希: {e}")
```

### 3.4 哈希值的重要特性


**哈希值的核心特性**：

```python
# 🔸 特性1：相等的对象有相同的哈希值
a = "python"
b = "python"
print(f"a == b: {a == b}")                    # True
print(f"hash(a) == hash(b): {hash(a) == hash(b)}")  # True

# 🔸 特性2：哈希值在程序运行期间保持不变
text = "hello world"
hash1 = hash(text)
hash2 = hash(text)
print(f"多次计算哈希值相同: {hash1 == hash2}")  # True

# 🔸 特性3：不同对象可能有相同哈希值（哈希冲突）
# 这种情况比较少见，但确实存在
```

### 3.5 哈希值的实际应用


```python
# 🔸 字典键的查找机制
def demo_dict_hash():
    """演示字典如何使用哈希值进行快速查找"""
    
    my_dict = {
        "apple": "苹果",
        "banana": "香蕉", 
        "orange": "橙子"
    }
    
    # 当我们访问 my_dict["apple"] 时：
    # 1. 计算 "apple" 的哈希值
    key_hash = hash("apple")
    print(f"'apple'的哈希值: {key_hash}")
    
    # 2. 根据哈希值快速定位到值
    print(f"字典中的值: {my_dict['apple']}")

demo_dict_hash()

# 🔸 集合的去重机制
def demo_set_hash():
    """演示集合如何使用哈希值去重"""
    
    # 集合自动去重，基于哈希值
    numbers = [1, 2, 2, 3, 3, 3, 4]
    unique_numbers = set(numbers)
    
    print(f"原列表: {numbers}")
    print(f"去重后: {unique_numbers}")
    
    # 每个元素的哈希值
    for num in unique_numbers:
        print(f"数字{num}的哈希值: {hash(num)}")

demo_set_hash()
```

---

## 4. 🎯 object()函数详解


### 4.1 object()函数的基本概念


**object()函数**创建一个最基本的Python对象，就像是一个"空白模板"，没有任何特殊功能。

> 💡 **通俗理解**：`object()`就像是造了一个最简单的"容器"，里面什么都没有，但可以作为其他复杂对象的基础

### 4.2 基本语法和特性


```python
# 语法格式
obj = object()

# 基础示例
empty_obj = object()
print(f"对象类型: {type(empty_obj)}")        # <class 'object'>
print(f"对象id: {id(empty_obj)}")           # 某个内存地址
print(f"对象字符串表示: {empty_obj}")         # <object object at 0x...>
```

### 4.3 object对象的特点


```python
# 🔸 创建两个不同的object实例
obj1 = object()
obj2 = object()

print(f"两个对象相等吗: {obj1 == obj2}")       # False
print(f"两个对象是同一个吗: {obj1 is obj2}")   # False
print(f"obj1的id: {id(obj1)}")
print(f"obj2的id: {id(obj2)}")

# 🔸 object对象的限制
try:
    obj1.name = "test"  # 尝试添加属性
except AttributeError as e:
    print(f"不能添加属性: {e}")

# 🔸 object对象可以哈希
print(f"object对象的哈希值: {hash(obj1)}")
```

### 4.4 object()的实际应用


#### 🔸 作为类继承的基类


```python
# 所有Python类都隐式继承自object
class MyClass:
    def __init__(self, name):
        self.name = name

# 等价于
class MyClassExplicit(object):
    def __init__(self, name):
        self.name = name

# 验证继承关系
my_obj = MyClass("测试")
print(f"是否是object的实例: {isinstance(my_obj, object)}")  # True
```

#### 🔸 作为哨兵值（占位符）


```python
# 🔸 用作默认值的占位符
MISSING = object()  # 创建一个唯一的标记对象

def get_value(dictionary, key, default=MISSING):
    """获取字典值，区分None和未提供默认值的情况"""
    
    if key in dictionary:
        return dictionary[key]
    elif default is MISSING:
        raise KeyError(f"键 '{key}' 不存在，且未提供默认值")
    else:
        return default

# 使用示例
data = {"name": "张三", "age": None}

print(get_value(data, "name"))        # 张三
print(get_value(data, "age"))         # None
print(get_value(data, "city", "未知")) # 未知

try:
    get_value(data, "salary")         # 抛出KeyError
except KeyError as e:
    print(f"错误: {e}")
```

#### 🔸 作为单例模式的实现


```python
class Singleton:
    """简单的单例模式实现"""
    _instance = None
    _sentinel = object()  # 用作内部标记
    
    def __new__(cls):
        if cls._instance is None:
            cls._instance = super().__new__(cls)
        return cls._instance
    
    def __init__(self):
        if not hasattr(self, '_initialized'):
            self._initialized = True
            print("单例对象初始化")

# 测试单例
s1 = Singleton()
s2 = Singleton()
print(f"两个实例是同一个对象: {s1 is s2}")  # True
```

---

## 5. 🚀 实际应用场景


### 5.1 对象比较和跟踪


```python
def compare_objects_demo():
    """演示如何正确比较和跟踪对象"""
    
    # 🔸 场景1：判断变量是否指向同一个对象
    list_a = [1, 2, 3]
    list_b = list_a      # 指向同一个对象
    list_c = [1, 2, 3]   # 创建新对象
    
    print("=== 对象比较 ===")
    print(f"list_a is list_b: {list_a is list_b}")           # True
    print(f"list_a is list_c: {list_a is list_c}")           # False
    print(f"id(list_a) == id(list_b): {id(list_a) == id(list_b)}")  # True
    
    # 🔸 场景2：追踪对象修改
    print("\n=== 修改追踪 ===")
    original_id = id(list_a)
    list_a.append(4)  # 修改原对象
    
    print(f"修改前后id相同: {id(list_a) == original_id}")     # True
    print(f"list_b也被修改: {list_b}")                      # [1, 2, 3, 4]

compare_objects_demo()
```

### 5.2 缓存系统实现


```python
class SimpleCache:
    """使用哈希值实现的简单缓存系统"""
    
    def __init__(self):
        self._cache = {}
    
    def get(self, key):
        """获取缓存值"""
        try:
            key_hash = hash(key)
            if key_hash in self._cache:
                print(f"缓存命中: {key}")
                return self._cache[key_hash]
            else:
                print(f"缓存未命中: {key}")
                return None
        except TypeError:
            print(f"键 {key} 不可哈希，无法缓存")
            return None
    
    def set(self, key, value):
        """设置缓存值"""
        try:
            key_hash = hash(key)
            self._cache[key_hash] = value
            print(f"缓存设置成功: {key} -> {value}")
        except TypeError:
            print(f"键 {key} 不可哈希，无法缓存")

# 使用示例
cache = SimpleCache()

# ✅ 可哈希的键
cache.set("user:123", {"name": "张三", "age": 25})
cache.set((1, 2), "坐标点")

print(cache.get("user:123"))
print(cache.get((1, 2)))

# ❌ 不可哈希的键
cache.set([1, 2, 3], "列表键")  # 失败
```

### 5.3 对象工厂模式


```python
# 使用object()创建特殊标记
UNSET = object()

class ConfigManager:
    """配置管理器，使用object()作为默认值标记"""
    
    def __init__(self):
        self._config = {}
    
    def get(self, key, default=UNSET):
        """获取配置值"""
        if key in self._config:
            return self._config[key]
        elif default is not UNSET:
            return default
        else:
            raise KeyError(f"配置项 '{key}' 不存在")
    
    def set(self, key, value):
        """设置配置值"""
        self._config[key] = value
        print(f"配置设置: {key} = {value}")

# 使用示例
config = ConfigManager()
config.set("debug", True)
config.set("max_connections", 100)

print(f"调试模式: {config.get('debug')}")                    # True
print(f"最大连接: {config.get('max_connections')}")          # 100
print(f"超时时间: {config.get('timeout', 30)}")              # 30（使用默认值）

try:
    config.get('unknown_key')  # 抛出异常
except KeyError as e:
    print(f"错误: {e}")
```

---

## 6. 📋 核心要点总结


### 6.1 必须掌握的核心概念


```
🔸 id()函数：获取对象在内存中的唯一标识符
🔸 hash()函数：获取对象的哈希值，用于快速查找和比较
🔸 object()函数：创建最基础的Python对象
🔸 对象身份 vs 对象值：理解 is 和 == 的区别
🔸 可哈希性：只有不可变对象才能计算哈希值
```

### 6.2 关键理解要点


**🔹 id()函数的应用价值**
```
实际用途：
• 调试时追踪对象变化
• 判断两个变量是否指向同一个对象
• 理解Python的对象管理机制
• 避免意外的对象共享问题
```

**🔹 hash()函数的工作原理**
```
核心机制：
• 字典的快速查找基于哈希值
• 集合的去重机制使用哈希值
• 相等的对象必须有相同的哈希值
• 可变对象不能计算哈希值
```

**🔹 object()函数的特殊作用**
```
主要用途：
• 作为所有类的基类
• 创建唯一的标记对象（哨兵值）
• 实现单例模式和工厂模式
• 作为占位符和默认值标记
```

### 6.3 实际编程指导


**📌 最佳实践**
- **对象比较**：用`is`比较身份，用`==`比较值
- **缓存设计**：利用哈希值实现高效的查找机制
- **默认值处理**：用`object()`创建唯一的标记值
- **调试技巧**：用`id()`追踪对象的生命周期

**⚠️ 常见陷阱**
- 小整数和短字符串会被Python缓存，`is`比较可能给出意外结果
- 可变对象不能作为字典键或放入集合
- `object()`创建的对象不能添加自定义属性

**🎯 学习建议**
- 通过实际例子理解对象身份和值的区别
- 练习使用这些函数解决实际编程问题
- 理解Python内部的对象管理机制

**核心记忆口诀**：
- id查身份，hash算指纹，object做模板
- 身份用is，值用等号，哈希助查找
- 不变才哈希，可变就报错，基类object撑