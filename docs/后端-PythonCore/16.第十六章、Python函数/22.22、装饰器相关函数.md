---
title: 22ã€è£…é¥°å™¨ç›¸å…³å‡½æ•°
---
## ğŸ“š ç›®å½•

1. [è£…é¥°å™¨åŸºç¡€æ¦‚å¿µ](#1-è£…é¥°å™¨åŸºç¡€æ¦‚å¿µ)
2. [property()å±æ€§è£…é¥°å™¨](#2-propertyå±æ€§è£…é¥°å™¨)
3. [staticmethod()é™æ€æ–¹æ³•](#3-staticmethodé™æ€æ–¹æ³•)
4. [classmethod()ç±»æ–¹æ³•](#4-classmethodç±»æ–¹æ³•)
5. [functools.wraps()è£…é¥°å™¨å·¥å…·](#5-functoolswrapsè£…é¥°å™¨å·¥å…·)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ è£…é¥°å™¨åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯è£…é¥°å™¨


**è£…é¥°å™¨å°±åƒç»™å‡½æ•°æˆ–ç±»"ç©¿è¡£æœ"**

æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ªæ™®é€šçš„å‡½æ•°ï¼Œå°±åƒä¸€ä¸ªäººç©¿ç€æ™®é€šè¡£æœã€‚è£…é¥°å™¨å°±åƒæ˜¯ç»™è¿™ä¸ªäººæ¢ä¸Šä¸åŒçš„è¡£æœï¼Œè®©ä»–å…·å¤‡æ–°çš„èƒ½åŠ›æˆ–ç‰¹æ€§ï¼Œä½†äººæœ¬èº«æ²¡æœ‰æ”¹å˜ã€‚

```
æ™®é€šå‡½æ•°ï¼šä¸€ä¸ªä¼šè¯´è¯çš„äºº
åŠ ä¸Šè£…é¥°å™¨ï¼šè¿™ä¸ªäººç°åœ¨è¿˜ä¼šå”±æ­Œã€è·³èˆã€å˜é­”æœ¯

æ ¸å¿ƒç†å¿µï¼š
ğŸ”¸ ä¸æ”¹å˜åŸæœ‰åŠŸèƒ½
ğŸ”¸ å¢åŠ æ–°çš„ç‰¹æ€§
ğŸ”¸ è®©ä»£ç æ›´ç®€æ´ä¼˜é›…
```

### 1.2 è£…é¥°å™¨çš„å·¥ä½œåŸç†


**è£…é¥°å™¨æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª"å‡½æ•°åŒ…è£…å™¨"**

```python
# è¿™å°±æ˜¯è£…é¥°å™¨çš„åŸºæœ¬æ€æƒ³
def my_function():
    print("æˆ‘æ˜¯åŸæ¥çš„åŠŸèƒ½")

# è£…é¥°å™¨å°±æ˜¯åœ¨åŸåŠŸèƒ½åŸºç¡€ä¸ŠåŒ…è£…ä¸€å±‚
def decorated_function():
    print("è£…é¥°å™¨æ·»åŠ çš„åŠŸèƒ½")  # æ–°å¢åŠŸèƒ½
    my_function()              # åŸæœ‰åŠŸèƒ½
    print("è£…é¥°å™¨æ·»åŠ çš„ç»“æŸ")  # æ–°å¢åŠŸèƒ½
```

### 1.3 ä¸ºä»€ä¹ˆéœ€è¦è£…é¥°å™¨


**è§£å†³é‡å¤ä»£ç é—®é¢˜**

```
å¸¸è§åœºæ™¯ï¼š
ğŸ”¸ å¤šä¸ªå‡½æ•°éƒ½éœ€è¦è®°å½•æ‰§è¡Œæ—¶é—´
ğŸ”¸ å¤šä¸ªå‡½æ•°éƒ½éœ€è¦æƒé™æ£€æŸ¥
ğŸ”¸ å¤šä¸ªæ–¹æ³•éƒ½éœ€è¦å‚æ•°éªŒè¯
ğŸ”¸ å¤šä¸ªå±æ€§éƒ½éœ€è¦ç‰¹æ®Šçš„è¯»å†™æ§åˆ¶

è£…é¥°å™¨çš„ä¼˜åŠ¿ï¼š
âœ… ä»£ç å¤ç”¨ï¼šä¸€æ¬¡ç¼–å†™ï¼Œå¤šå¤„ä½¿ç”¨
âœ… ä»£ç æ¸…æ™°ï¼šæ ¸å¿ƒé€»è¾‘ä¸è¾…åŠ©åŠŸèƒ½åˆ†ç¦»
âœ… æ˜“äºç»´æŠ¤ï¼šä¿®æ”¹è£…é¥°å™¨å°±èƒ½å½±å“æ‰€æœ‰ä½¿ç”¨å®ƒçš„åœ°æ–¹
```

---

## 2. ğŸ  property()å±æ€§è£…é¥°å™¨


### 2.1 property()æ˜¯ä»€ä¹ˆ


**æŠŠæ–¹æ³•å˜æˆå±æ€§çš„ç¥å¥‡è£…é¥°å™¨**

åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬è¯´ä¸€ä¸ªäººçš„å¹´é¾„ã€èº«é«˜ã€ä½“é‡ï¼Œè¿™äº›éƒ½æ˜¯å±æ€§ã€‚åœ¨ç¼–ç¨‹ä¸­ï¼Œ`property()`è®©æˆ‘ä»¬å¯ä»¥åƒè®¿é—®å±æ€§ä¸€æ ·è®¿é—®æ–¹æ³•ã€‚

```python
class Person:
    def __init__(self, birth_year):
        self._birth_year = birth_year
    
    @property
    def age(self):
        """å¹´é¾„ä¸æ˜¯ç›´æ¥å­˜å‚¨çš„ï¼Œè€Œæ˜¯è®¡ç®—å‡ºæ¥çš„"""
        import datetime
        current_year = datetime.datetime.now().year
        return current_year - self._birth_year

# ä½¿ç”¨æ—¶å°±åƒè®¿é—®æ™®é€šå±æ€§ä¸€æ ·ç®€å•
person = Person(1990)
print(person.age)  # ä¸éœ€è¦å†™ person.age()ï¼Œç›´æ¥è®¿é—®
```

### 2.2 property()çš„ä¸‰ç§ç”¨æ³•


#### ğŸ”¸ åªè¯»å±æ€§ï¼ˆæœ€å¸¸ç”¨ï¼‰


```python
class Circle:
    def __init__(self, radius):
        self._radius = radius
    
    @property
    def area(self):
        """åœ†çš„é¢ç§¯æ˜¯è®¡ç®—å‡ºæ¥çš„ï¼Œä¸åº”è¯¥è¢«ç›´æ¥ä¿®æ”¹"""
        return 3.14159 * self._radius ** 2
    
    @property 
    def diameter(self):
        """ç›´å¾„æ˜¯åŠå¾„çš„2å€"""
        return self._radius * 2

circle = Circle(5)
print(f"é¢ç§¯ï¼š{circle.area}")      # 78.54
print(f"ç›´å¾„ï¼š{circle.diameter}")  # 10

# è¿™æ ·ä¼šå‡ºé”™ï¼Œå› ä¸ºareaæ˜¯åªè¯»çš„
# circle.area = 100  # AttributeError
```

#### ğŸ”¸ å¯è¯»å†™å±æ€§


```python
class Temperature:
    def __init__(self, celsius=0):
        self._celsius = celsius
    
    @property
    def celsius(self):
        """è·å–æ‘„æ°åº¦"""
        return self._celsius
    
    @celsius.setter
    def celsius(self, value):
        """è®¾ç½®æ‘„æ°åº¦ï¼Œéœ€è¦éªŒè¯èŒƒå›´"""
        if value < -273.15:
            raise ValueError("æ¸©åº¦ä¸èƒ½ä½äºç»å¯¹é›¶åº¦(-273.15Â°C)")
        self._celsius = value
    
    @property
    def fahrenheit(self):
        """è·å–åæ°åº¦ï¼ˆè‡ªåŠ¨è½¬æ¢ï¼‰"""
        return self._celsius * 9/5 + 32
    
    @fahrenheit.setter  
    def fahrenheit(self, value):
        """è®¾ç½®åæ°åº¦ï¼ˆè‡ªåŠ¨è½¬æ¢ä¸ºæ‘„æ°åº¦å­˜å‚¨ï¼‰"""
        self._celsius = (value - 32) * 5/9

# ä½¿ç”¨ç¤ºä¾‹
temp = Temperature()
temp.celsius = 25        # è®¾ç½®æ‘„æ°åº¦
print(temp.fahrenheit)   # 77.0 (è‡ªåŠ¨è½¬æ¢ä¸ºåæ°åº¦)

temp.fahrenheit = 86     # è®¾ç½®åæ°åº¦
print(temp.celsius)      # 30.0 (è‡ªåŠ¨è½¬æ¢ä¸ºæ‘„æ°åº¦)
```

#### ğŸ”¸ å¯åˆ é™¤å±æ€§


```python
class UserAccount:
    def __init__(self, username):
        self._username = username
        self._email = None
    
    @property
    def email(self):
        return self._email
    
    @email.setter
    def email(self, value):
        if '@' not in value:
            raise ValueError("é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
        self._email = value
    
    @email.deleter
    def email(self):
        """åˆ é™¤é‚®ç®±æ—¶çš„æ¸…ç†å·¥ä½œ"""
        print(f"æ­£åœ¨åˆ é™¤ {self._username} çš„é‚®ç®±...")
        self._email = None

user = UserAccount("å¼ ä¸‰")
user.email = "zhangsan@example.com"
print(user.email)  # zhangsan@example.com

del user.email     # è°ƒç”¨åˆ é™¤å™¨
print(user.email)  # None
```

### 2.3 property()çš„å®é™…åº”ç”¨åœºæ™¯


**ğŸ¯ æ•°æ®éªŒè¯å’Œè½¬æ¢**

```python
class BankAccount:
    def __init__(self, initial_balance=0):
        self._balance = initial_balance
    
    @property
    def balance(self):
        """ä½™é¢ï¼ˆåªè¯»ï¼‰"""
        return self._balance
    
    @property
    def balance_yuan(self):
        """ä»¥å…ƒä¸ºå•ä½æ˜¾ç¤ºä½™é¢"""
        return f"Â¥{self._balance:.2f}"
    
    def deposit(self, amount):
        """å­˜æ¬¾"""
        if amount > 0:
            self._balance += amount
    
    def withdraw(self, amount):
        """å–æ¬¾"""
        if 0 < amount <= self._balance:
            self._balance -= amount
            return True
        return False

account = BankAccount(1000.50)
print(account.balance)      # 1000.5
print(account.balance_yuan) # Â¥1000.50
```

---

## 3. âš¡ staticmethod()é™æ€æ–¹æ³•


### 3.1 staticmethod()æ˜¯ä»€ä¹ˆ


**ä¸éœ€è¦ç±»å®ä¾‹å°±èƒ½è°ƒç”¨çš„æ–¹æ³•**

é™æ€æ–¹æ³•å°±åƒæ˜¯æ”¾åœ¨ç±»é‡Œé¢çš„æ™®é€šå‡½æ•°ï¼Œå®ƒä¸éœ€è¦è®¿é—®ç±»çš„ä»»ä½•ä¿¡æ¯ï¼Œä¹Ÿä¸éœ€è¦åˆ›å»ºç±»çš„å®ä¾‹ã€‚å°±åƒå·¥å…·ç®±é‡Œçš„èºä¸åˆ€ï¼Œä½ ä¸éœ€è¦æ‹¥æœ‰æ•´ä¸ªå·¥å…·ç®±æ‰èƒ½ä½¿ç”¨èºä¸åˆ€ã€‚

```python
class MathUtils:
    @staticmethod
    def add(x, y):
        """ç®€å•çš„åŠ æ³•ï¼Œä¸éœ€è¦ç±»çš„ä»»ä½•ä¿¡æ¯"""
        return x + y
    
    @staticmethod
    def is_even(number):
        """åˆ¤æ–­æ˜¯å¦ä¸ºå¶æ•°"""
        return number % 2 == 0

# å¯ä»¥ç›´æ¥é€šè¿‡ç±»åè°ƒç”¨ï¼Œä¸éœ€è¦åˆ›å»ºå®ä¾‹
result = MathUtils.add(5, 3)        # 8
is_even = MathUtils.is_even(10)     # True

# å½“ç„¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®ä¾‹è°ƒç”¨ï¼ˆä½†æ²¡å¿…è¦ï¼‰
utils = MathUtils()
result2 = utils.add(2, 4)           # 6
```

### 3.2 é™æ€æ–¹æ³•çš„ç‰¹ç‚¹


```
é™æ€æ–¹æ³•çš„ç‰¹å¾ï¼š
ğŸ”¸ ä¸èƒ½è®¿é—® selfï¼ˆå®ä¾‹ï¼‰
ğŸ”¸ ä¸èƒ½è®¿é—® clsï¼ˆç±»ï¼‰
ğŸ”¸ å°±åƒæ™®é€šå‡½æ•°ä¸€æ ·å·¥ä½œ
ğŸ”¸ é€šè¿‡ç±»åç›´æ¥è°ƒç”¨
ğŸ”¸ ä¸ç±»é€»è¾‘ç›¸å…³ä½†ç‹¬ç«‹çš„åŠŸèƒ½
```

### 3.3 é™æ€æ–¹æ³•çš„å®é™…åº”ç”¨


**ğŸ› ï¸ å·¥å…·å‡½æ•°é›†åˆ**

```python
class StringUtils:
    @staticmethod
    def is_email(email):
        """éªŒè¯é‚®ç®±æ ¼å¼"""
        return '@' in email and '.' in email
    
    @staticmethod
    def clean_phone(phone):
        """æ¸…ç†ç”µè¯å·ç ä¸­çš„ç‰¹æ®Šå­—ç¬¦"""
        return ''.join(filter(str.isdigit, phone))
    
    @staticmethod
    def format_name(first_name, last_name):
        """æ ¼å¼åŒ–å§“å"""
        return f"{last_name}, {first_name}".title()

# ä½¿ç”¨å·¥å…·å‡½æ•°
email_valid = StringUtils.is_email("test@example.com")  # True
clean_phone = StringUtils.clean_phone("(123) 456-7890") # "1234567890"
formatted = StringUtils.format_name("john", "doe")       # "Doe, John"
```

**ğŸ­ å·¥å‚æ¨¡å¼åº”ç”¨**

```python
class Person:
    def __init__(self, name, age):
        self.name = name
        self.age = age
    
    @staticmethod
    def from_string(person_str):
        """ä»å­—ç¬¦ä¸²åˆ›å»ºPersonå¯¹è±¡"""
        name, age = person_str.split('-')
        return Person(name, int(age))
    
    @staticmethod
    def from_dict(person_dict):
        """ä»å­—å…¸åˆ›å»ºPersonå¯¹è±¡"""
        return Person(person_dict['name'], person_dict['age'])

# å¤šç§åˆ›å»ºæ–¹å¼
person1 = Person("å¼ ä¸‰", 25)                          # æ™®é€šæ–¹å¼
person2 = Person.from_string("æå››-30")               # ä»å­—ç¬¦ä¸²
person3 = Person.from_dict({"name": "ç‹äº”", "age": 35}) # ä»å­—å…¸
```

---

## 4. ğŸ›ï¸ classmethod()ç±»æ–¹æ³•


### 4.1 classmethod()æ˜¯ä»€ä¹ˆ


**èƒ½å¤Ÿè®¿é—®ç±»æœ¬èº«çš„ç‰¹æ®Šæ–¹æ³•**

ç±»æ–¹æ³•å°±åƒæ˜¯ç±»çš„"ç®¡ç†å‘˜"ï¼Œå®ƒå¯ä»¥è®¿é—®å’Œæ“ä½œç±»çš„ä¿¡æ¯ï¼Œä½†ä¸éœ€è¦å…·ä½“çš„å®ä¾‹ã€‚å°±åƒå­¦æ ¡çš„æ•™åŠ¡å¤„ï¼Œå¯ä»¥ç®¡ç†æ•´ä¸ªå­¦æ ¡çš„äº‹åŠ¡ï¼Œä¸éœ€è¦é’ˆå¯¹æŸä¸ªå…·ä½“çš„å­¦ç”Ÿã€‚

```python
class Student:
    school_name = "åŒ—äº¬å¤§å­¦"  # ç±»å˜é‡
    student_count = 0        # å­¦ç”Ÿæ€»æ•°
    
    def __init__(self, name, grade):
        self.name = name
        self.grade = grade
        Student.student_count += 1
    
    @classmethod
    def get_school_info(cls):
        """è·å–å­¦æ ¡ä¿¡æ¯ï¼ˆç±»æ–¹æ³•ï¼‰"""
        return f"å­¦æ ¡ï¼š{cls.school_name}ï¼Œå­¦ç”Ÿæ€»æ•°ï¼š{cls.student_count}"
    
    @classmethod
    def set_school_name(cls, new_name):
        """ä¿®æ”¹å­¦æ ¡åç§°ï¼ˆç±»æ–¹æ³•ï¼‰"""
        cls.school_name = new_name

# ä½¿ç”¨ç±»æ–¹æ³•ï¼ˆä¸éœ€è¦åˆ›å»ºå®ä¾‹ï¼‰
print(Student.get_school_info())  # å­¦æ ¡ï¼šåŒ—äº¬å¤§å­¦ï¼Œå­¦ç”Ÿæ€»æ•°ï¼š0

# åˆ›å»ºä¸€äº›å­¦ç”Ÿ
student1 = Student("å¼ ä¸‰", "ä¸€å¹´çº§")
student2 = Student("æå››", "äºŒå¹´çº§")

print(Student.get_school_info())  # å­¦æ ¡ï¼šåŒ—äº¬å¤§å­¦ï¼Œå­¦ç”Ÿæ€»æ•°ï¼š2

# ä¿®æ”¹å­¦æ ¡åç§°
Student.set_school_name("æ¸…åå¤§å­¦")
print(Student.get_school_info())  # å­¦æ ¡ï¼šæ¸…åå¤§å­¦ï¼Œå­¦ç”Ÿæ€»æ•°ï¼š2
```

### 4.2 ç±»æ–¹æ³•çš„ç‰¹ç‚¹


```
ç±»æ–¹æ³•çš„ç‰¹å¾ï¼š
ğŸ”¸ ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ clsï¼ˆç±»æœ¬èº«ï¼‰
ğŸ”¸ å¯ä»¥è®¿é—®ç±»å˜é‡
ğŸ”¸ å¯ä»¥è°ƒç”¨å…¶ä»–ç±»æ–¹æ³•
ğŸ”¸ é€šå¸¸ç”¨äºæ“ä½œç±»çº§åˆ«çš„æ•°æ®
ğŸ”¸ å¯ä»¥é€šè¿‡ç±»åæˆ–å®ä¾‹è°ƒç”¨
```

### 4.3 ç±»æ–¹æ³•çš„å®é™…åº”ç”¨


**ğŸ­ æ›¿ä»£æ„é€ å‡½æ•°**

```python
class Date:
    def __init__(self, year, month, day):
        self.year = year
        self.month = month  
        self.day = day
    
    @classmethod
    def from_string(cls, date_string):
        """ä»å­—ç¬¦ä¸²åˆ›å»ºæ—¥æœŸï¼š'2023-12-25'"""
        year, month, day = map(int, date_string.split('-'))
        return cls(year, month, day)  # æ³¨æ„ï¼šè¿™é‡Œç”¨clsè€Œä¸æ˜¯Date
    
    @classmethod  
    def today(cls):
        """åˆ›å»ºä»Šå¤©çš„æ—¥æœŸ"""
        import datetime
        today = datetime.date.today()
        return cls(today.year, today.month, today.day)
    
    def __str__(self):
        return f"{self.year}-{self.month:02d}-{self.day:02d}"

# å¤šç§åˆ›å»ºæ–¹å¼
date1 = Date(2023, 12, 25)              # æ™®é€šæ–¹å¼
date2 = Date.from_string("2023-12-25")  # ä»å­—ç¬¦ä¸²
date3 = Date.today()                    # ä»Šå¤©çš„æ—¥æœŸ

print(date1)  # 2023-12-25
print(date2)  # 2023-12-25
print(date3)  # å½“å‰æ—¥æœŸ
```

**ğŸ“Š ç±»çº§åˆ«çš„ç»Ÿè®¡å’Œç®¡ç†**

```python
class DatabaseConnection:
    _instance_count = 0
    _max_connections = 5
    
    def __init__(self, host, port):
        if DatabaseConnection._instance_count >= DatabaseConnection._max_connections:
            raise Exception("è¿æ¥æ•°å·²è¾¾ä¸Šé™")
        
        self.host = host
        self.port = port
        DatabaseConnection._instance_count += 1
    
    @classmethod
    def get_connection_info(cls):
        """è·å–è¿æ¥ç»Ÿè®¡ä¿¡æ¯"""
        return {
            "å½“å‰è¿æ¥æ•°": cls._instance_count,
            "æœ€å¤§è¿æ¥æ•°": cls._max_connections,
            "å‰©ä½™å¯ç”¨è¿æ¥": cls._max_connections - cls._instance_count
        }
    
    @classmethod
    def set_max_connections(cls, max_conn):
        """è®¾ç½®æœ€å¤§è¿æ¥æ•°"""
        cls._max_connections = max_conn
    
    def close(self):
        """å…³é—­è¿æ¥"""
        DatabaseConnection._instance_count -= 1

# åˆ›å»ºè¿æ¥
conn1 = DatabaseConnection("localhost", 5432)
conn2 = DatabaseConnection("192.168.1.1", 5432)

print(DatabaseConnection.get_connection_info())
# {'å½“å‰è¿æ¥æ•°': 2, 'æœ€å¤§è¿æ¥æ•°': 5, 'å‰©ä½™å¯ç”¨è¿æ¥': 3}
```

---

## 5. ğŸ”§ functools.wraps()è£…é¥°å™¨å·¥å…·


### 5.1 functools.wraps()æ˜¯ä»€ä¹ˆ


**è®©è£…é¥°å™¨æ›´å®Œç¾çš„å·¥å…·**

å½“æˆ‘ä»¬åˆ›å»ºè£…é¥°å™¨æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šè¢«è£…é¥°çš„å‡½æ•°ä¼š"å¤±å»èº«ä»½"ã€‚`functools.wraps()`å°±æ˜¯ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼Œå®ƒè®©è£…é¥°åçš„å‡½æ•°ä¿æŒåŸæ¥çš„"èº«ä»½ä¿¡æ¯"ã€‚

```python
import functools

def simple_decorator(func):
    """ä¸€ä¸ªç®€å•çš„è£…é¥°å™¨"""
    def wrapper(*args, **kwargs):
        print("è£…é¥°å™¨æ‰§è¡Œå‰")
        result = func(*args, **kwargs)
        print("è£…é¥°å™¨æ‰§è¡Œå")
        return result
    return wrapper

def better_decorator(func):
    """ä½¿ç”¨wrapsçš„æ›´å¥½è£…é¥°å™¨"""
    @functools.wraps(func)  # è¿™å°±æ˜¯å…³é”®ï¼
    def wrapper(*args, **kwargs):
        print("è£…é¥°å™¨æ‰§è¡Œå‰") 
        result = func(*args, **kwargs)
        print("è£…é¥°å™¨æ‰§è¡Œå")
        return result
    return wrapper

@simple_decorator
def hello_simple():
    """è¿™æ˜¯ä¸€ä¸ªé—®å€™å‡½æ•°"""
    return "Hello!"

@better_decorator  
def hello_better():
    """è¿™æ˜¯ä¸€ä¸ªé—®å€™å‡½æ•°"""
    return "Hello!"

# çœ‹çœ‹åŒºåˆ«
print("ç®€å•è£…é¥°å™¨ï¼š")
print(f"å‡½æ•°åï¼š{hello_simple.__name__}")     # wrapper (å¤±å»äº†åŸå)
print(f"æ–‡æ¡£ï¼š{hello_simple.__doc__}")        # None (å¤±å»äº†æ–‡æ¡£)

print("\nä½¿ç”¨wrapsçš„è£…é¥°å™¨ï¼š")
print(f"å‡½æ•°åï¼š{hello_better.__name__}")     # hello_better (ä¿æŒåŸå)
print(f"æ–‡æ¡£ï¼š{hello_better.__doc__}")        # è¿™æ˜¯ä¸€ä¸ªé—®å€™å‡½æ•° (ä¿æŒæ–‡æ¡£)
```

### 5.2 ä¸ºä»€ä¹ˆéœ€è¦functools.wraps()


**ä¿æŒå‡½æ•°çš„"èº«ä»½è¯"ä¿¡æ¯**

```
æ²¡æœ‰wrapsçš„é—®é¢˜ï¼š
âŒ å‡½æ•°åå˜æˆäº†wrapper
âŒ å‡½æ•°æ–‡æ¡£ä¸¢å¤±
âŒ å…¶ä»–å…ƒä¿¡æ¯ä¸¢å¤±
âŒ è°ƒè¯•å›°éš¾

ä½¿ç”¨wrapsçš„å¥½å¤„ï¼š
âœ… ä¿æŒåŸå‡½æ•°å
âœ… ä¿æŒåŸå‡½æ•°æ–‡æ¡£
âœ… ä¿æŒåŸå‡½æ•°çš„æ‰€æœ‰å…ƒä¿¡æ¯
âœ… ä¾¿äºè°ƒè¯•å’Œæ–‡æ¡£ç”Ÿæˆ
```

### 5.3 å®é™…åº”ç”¨ç¤ºä¾‹


**ğŸ• æ‰§è¡Œæ—¶é—´è®¡ç®—è£…é¥°å™¨**

```python
import functools
import time

def timer(func):
    """è®¡ç®—å‡½æ•°æ‰§è¡Œæ—¶é—´çš„è£…é¥°å™¨"""
    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        start_time = time.time()
        result = func(*args, **kwargs)
        end_time = time.time()
        print(f"{func.__name__} æ‰§è¡Œæ—¶é—´: {end_time - start_time:.4f}ç§’")
        return result
    return wrapper

@timer
def slow_function():
    """ä¸€ä¸ªå¾ˆæ…¢çš„å‡½æ•°"""
    time.sleep(1)
    return "å®Œæˆäº†ï¼"

# å‡½æ•°ä¿¡æ¯å¾—åˆ°ä¿æŒ
print(f"å‡½æ•°åï¼š{slow_function.__name__}")  # slow_function
print(f"æ–‡æ¡£ï¼š{slow_function.__doc__}")    # ä¸€ä¸ªå¾ˆæ…¢çš„å‡½æ•°

result = slow_function()  # slow_function æ‰§è¡Œæ—¶é—´: 1.0012ç§’
```

**ğŸ”’ æƒé™æ£€æŸ¥è£…é¥°å™¨**

```python
import functools

def require_permission(permission):
    """éœ€è¦ç‰¹å®šæƒé™çš„è£…é¥°å™¨"""
    def decorator(func):
        @functools.wraps(func)
        def wrapper(*args, **kwargs):
            # è¿™é‡Œç®€åŒ–äº†æƒé™æ£€æŸ¥é€»è¾‘
            user = kwargs.get('user', {})
            user_permissions = user.get('permissions', [])
            
            if permission in user_permissions:
                return func(*args, **kwargs)
            else:
                return f"æƒé™ä¸è¶³ï¼šéœ€è¦ {permission} æƒé™"
        return wrapper
    return decorator

@require_permission("admin")
def delete_user(user_id, user=None):
    """åˆ é™¤ç”¨æˆ·ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰"""
    return f"ç”¨æˆ· {user_id} å·²åˆ é™¤"

@require_permission("read")
def view_profile(user_id, user=None):
    """æŸ¥çœ‹ç”¨æˆ·èµ„æ–™"""
    return f"æ˜¾ç¤ºç”¨æˆ· {user_id} çš„èµ„æ–™"

# æµ‹è¯•æƒé™
admin_user = {"permissions": ["admin", "read", "write"]}
normal_user = {"permissions": ["read"]}

print(delete_user(123, user=admin_user))   # ç”¨æˆ· 123 å·²åˆ é™¤
print(delete_user(123, user=normal_user))  # æƒé™ä¸è¶³ï¼šéœ€è¦ admin æƒé™
print(view_profile(123, user=normal_user)) # æ˜¾ç¤ºç”¨æˆ· 123 çš„èµ„æ–™
```

### 5.4 è£…é¥°å™¨çš„ç»„åˆä½¿ç”¨


```python
import functools

def log_calls(func):
    """è®°å½•å‡½æ•°è°ƒç”¨çš„è£…é¥°å™¨"""
    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        print(f"è°ƒç”¨å‡½æ•° {func.__name__}")
        return func(*args, **kwargs)
    return wrapper

def validate_positive(func):
    """éªŒè¯å‚æ•°ä¸ºæ­£æ•°çš„è£…é¥°å™¨"""
    @functools.wraps(func)
    def wrapper(x):
        if x <= 0:
            raise ValueError("å‚æ•°å¿…é¡»ä¸ºæ­£æ•°")
        return func(x)
    return wrapper

@log_calls
@validate_positive
def calculate_square(x):
    """è®¡ç®—å¹³æ–¹"""
    return x ** 2

# å¤šä¸ªè£…é¥°å™¨ç»„åˆä½¿ç”¨
try:
    result = calculate_square(5)   # è°ƒç”¨å‡½æ•° calculate_square
    print(f"ç»“æœï¼š{result}")       # ç»“æœï¼š25
    
    calculate_square(-1)           # ValueError: å‚æ•°å¿…é¡»ä¸ºæ­£æ•°
except ValueError as e:
    print(f"é”™è¯¯ï¼š{e}")
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ è£…é¥°å™¨æœ¬è´¨ï¼šå‡½æ•°åŒ…è£…å™¨ï¼Œåœ¨ä¸æ”¹å˜åŸå‡½æ•°çš„åŸºç¡€ä¸Šå¢åŠ åŠŸèƒ½
ğŸ”¸ property()ï¼šæŠŠæ–¹æ³•å˜æˆå±æ€§ï¼Œæ”¯æŒgetterã€setterã€deleter
ğŸ”¸ staticmethod()ï¼šä¸éœ€è¦å®ä¾‹çš„ç±»æ–¹æ³•ï¼Œåƒå·¥å…·å‡½æ•°
ğŸ”¸ classmethod()ï¼šæ“ä½œç±»çº§åˆ«æ•°æ®çš„æ–¹æ³•ï¼Œç¬¬ä¸€å‚æ•°æ˜¯cls
ğŸ”¸ functools.wraps()ï¼šä¿æŒè¢«è£…é¥°å‡½æ•°çš„å…ƒä¿¡æ¯
```

### 6.2 ä½¿ç”¨åœºæ™¯å¯¹æ¯”


| è£…é¥°å™¨ç±»å‹ | **ä½¿ç”¨åœºæ™¯** | **è®¿é—®èƒ½åŠ›** | **è°ƒç”¨æ–¹å¼** |
|-----------|-------------|-------------|-------------|
| **@property** | `å±æ€§åŒ–çš„æ–¹æ³•è°ƒç”¨` | `å®ä¾‹æ•°æ®` | `obj.property` |
| **@staticmethod** | `å·¥å…·å‡½æ•°ã€éªŒè¯å‡½æ•°` | `æ— ç‰¹æ®Šè®¿é—®` | `Class.method()` |
| **@classmethod** | `æ›¿ä»£æ„é€ å™¨ã€ç±»ç®¡ç†` | `ç±»æ•°æ®` | `Class.method()` |
| **@functools.wraps** | `åˆ›å»ºè£…é¥°å™¨æ—¶ä½¿ç”¨` | `ä¿æŒå…ƒä¿¡æ¯` | `è£…é¥°å™¨å†…éƒ¨ä½¿ç”¨` |

### 6.3 é€‰æ‹©æŒ‡å—


**ğŸ¤” ä»€ä¹ˆæ—¶å€™ç”¨property()**
```
âœ… éœ€è¦è®¡ç®—çš„å±æ€§ï¼ˆå¦‚å¹´é¾„ã€é¢ç§¯ï¼‰
âœ… éœ€è¦éªŒè¯çš„å±æ€§è®¾ç½®
âœ… éœ€è¦æ ¼å¼åŒ–çš„æ•°æ®æ˜¾ç¤º
âœ… å±æ€§çš„è¯»å†™éœ€è¦ç‰¹æ®Šé€»è¾‘
```

**ğŸ¤” ä»€ä¹ˆæ—¶å€™ç”¨staticmethod()**
```
âœ… ä¸ç±»ç›¸å…³ä½†ä¸éœ€è¦ç±»æ•°æ®çš„å·¥å…·å‡½æ•°
âœ… éªŒè¯å‡½æ•°ã€è½¬æ¢å‡½æ•°
âœ… å·¥å‚æ–¹æ³•çš„è¾…åŠ©å‡½æ•°
âœ… çº¯åŠŸèƒ½æ€§çš„è®¡ç®—å‡½æ•°
```

**ğŸ¤” ä»€ä¹ˆæ—¶å€™ç”¨classmethod()**
```
âœ… æ›¿ä»£æ„é€ å‡½æ•°ï¼ˆä»ä¸åŒæ•°æ®æºåˆ›å»ºå¯¹è±¡ï¼‰
âœ… ç±»çº§åˆ«çš„ç»Ÿè®¡å’Œç®¡ç†
âœ… éœ€è¦è®¿é—®ç±»å˜é‡çš„æ“ä½œ
âœ… å­ç±»éœ€è¦ä¸åŒè¡Œä¸ºçš„å·¥å‚æ–¹æ³•
```

### 6.4 æœ€ä½³å®è·µå»ºè®®


> ğŸ’¡ **è®°å¿†å£è¯€**
> - propertyè®©æ–¹æ³•åƒå±æ€§
> - staticæ˜¯ç±»ä¸­çš„å·¥å…·ç®±
> - classç®¡ç†ç±»çš„å¤§äº‹åŠ¡
> - wrapsä¿æŒè£…é¥°å™¨çš„å®Œæ•´æ€§

**ğŸ¯ å®è·µè¦ç‚¹**
- **property()**ï¼šä¼˜å…ˆä½¿ç”¨åªè¯»å±æ€§ï¼Œéœ€è¦æ—¶å†æ·»åŠ setter
- **staticmethod()**ï¼šå‡½æ•°ç‹¬ç«‹æ€§å¼ºæ—¶ä½¿ç”¨ï¼Œä¾¿äºæµ‹è¯•
- **classmethod()**ï¼šåˆ›å»ºå¯¹è±¡çš„å¤šç§æ–¹å¼æ—¶ç‰¹åˆ«æœ‰ç”¨
- **functools.wraps()**ï¼šåˆ›å»ºè£…é¥°å™¨æ—¶å¿…é¡»ä½¿ç”¨

**âš ï¸ å¸¸è§é™·é˜±**
- ä¸è¦è¿‡åº¦ä½¿ç”¨property()ï¼Œç®€å•å±æ€§ç›´æ¥ç”¨å°±å¥½
- staticmethod()ä¸­ä¸èƒ½ä½¿ç”¨selfæˆ–cls
- classmethod()çš„ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯cls
- å¿˜è®°ä½¿ç”¨functools.wraps()ä¼šè®©è°ƒè¯•å˜å›°éš¾