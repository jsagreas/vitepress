---
title: 7ã€æ‹·è´æ“ä½œè¯¦è§£
---
## ğŸ“š ç›®å½•

1. [æ‹·è´æ“ä½œåŸºç¡€æ¦‚å¿µ](#1-æ‹·è´æ“ä½œåŸºç¡€æ¦‚å¿µ)
2. [èµ‹å€¼æ“ä½œï¼ˆå¼•ç”¨æ‹·è´ï¼‰](#2-èµ‹å€¼æ“ä½œå¼•ç”¨æ‹·è´)
3. [æµ…æ‹·è´ï¼ˆcopy.copyï¼‰](#3-æµ…æ‹·è´copycopy)
4. [æ·±æ‹·è´ï¼ˆcopy.deepcopyï¼‰](#4-æ·±æ‹·è´copydeeepcopy)
5. [æ‹·è´çš„åº”ç”¨åœºæ™¯](#5-æ‹·è´çš„åº”ç”¨åœºæ™¯)
6. [è‡ªå®šä¹‰æ‹·è´è¡Œä¸º](#6-è‡ªå®šä¹‰æ‹·è´è¡Œä¸º)
7. [æ‹·è´ä¸æ€§èƒ½è€ƒè™‘](#7-æ‹·è´ä¸æ€§èƒ½è€ƒè™‘)
8. [ä¸å¯å˜å¯¹è±¡æ‹·è´ä¼˜åŒ–](#8-ä¸å¯å˜å¯¹è±¡æ‹·è´ä¼˜åŒ–)
9. [æ‹·è´é™·é˜±ä¸æ³¨æ„äº‹é¡¹](#9-æ‹·è´é™·é˜±ä¸æ³¨æ„äº‹é¡¹)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ æ‹·è´æ“ä½œåŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯æ‹·è´æ“ä½œ


**ç®€å•ç†è§£**ï¼šæ‹·è´å°±æ˜¯"å¤åˆ¶"æ•°æ®ï¼Œä½† Python ä¸­çš„æ‹·è´æ¯”æˆ‘ä»¬æƒ³è±¡çš„å¤æ‚å¾ˆå¤šã€‚

```
æƒ³è±¡ä¸€ä¸‹ï¼š
ä½ æœ‰ä¸€ä¸ªç¬”è®°æœ¬ï¼ˆåŸæ•°æ®ï¼‰
ç°åœ¨è¦"å¤åˆ¶"è¿™ä¸ªç¬”è®°æœ¬

æ–¹å¼1ï¼šåªå¤åˆ¶å°é¢ï¼Œå†…å®¹è¿˜æ˜¯åŒä¸€æœ¬ â†’ å¼•ç”¨æ‹·è´
æ–¹å¼2ï¼šå¤åˆ¶å°é¢å’Œç›®å½•ï¼Œä½†å†…å®¹é¡µè¿˜æ˜¯å…±äº« â†’ æµ…æ‹·è´  
æ–¹å¼3ï¼šå®Œå…¨å¤åˆ¶ä¸€æœ¬æ–°ç¬”è®°æœ¬ï¼Œäº’ä¸å½±å“ â†’ æ·±æ‹·è´
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦ç†è§£æ‹·è´


**æ ¸å¿ƒé—®é¢˜**ï¼šPython ä¸­çš„æ•°æ®å­˜å‚¨å’Œå…±äº«æœºåˆ¶

```python
# è¿™ä¸ªä¾‹å­è¯´æ˜ä¸ºä»€ä¹ˆæ‹·è´å¾ˆé‡è¦
original_list = [1, 2, [3, 4]]
new_list = original_list

new_list[0] = 999
print(original_list)  # ç»“æœï¼š[999, 2, [3, 4]]
# ç³Ÿç³•ï¼ä¿®æ”¹ new_list ç«Ÿç„¶å½±å“äº† original_list
```

> ğŸ’¡ **æ–°æ‰‹å¸¸çŠ¯é”™è¯¯**  
> ä»¥ä¸º `new_list = original_list` åˆ›å»ºäº†æ–°åˆ—è¡¨ï¼Œå®é™…ä¸Šåªæ˜¯åˆ›å»ºäº†æ–°çš„"æ ‡ç­¾"æŒ‡å‘åŒä¸€ä¸ªåˆ—è¡¨

### 1.3 ä¸‰ç§æ‹·è´ç±»å‹æ¦‚è§ˆ


| æ‹·è´ç±»å‹ | **æ“ä½œæ–¹å¼** | **å†…å­˜å ç”¨** | **ä¿®æ”¹å½±å“** | **ä½¿ç”¨åœºæ™¯** |
|---------|------------|-------------|-------------|-------------|
| ğŸ·ï¸ **å¼•ç”¨æ‹·è´** | `b = a` | ä¸å¢åŠ  | ç›¸äº’å½±å“ | èŠ‚çœå†…å­˜ï¼Œéœ€è¦åŒæ­¥ä¿®æ”¹ |
| ğŸ“‹ **æµ…æ‹·è´** | `copy.copy(a)` | éƒ¨åˆ†å¢åŠ  | åµŒå¥—æ•°æ®ä¼šå½±å“ | ç®€å•æ•°æ®ç»“æ„çš„ç‹¬ç«‹å‰¯æœ¬ |
| ğŸ“š **æ·±æ‹·è´** | `copy.deepcopy(a)` | å®Œå…¨ç‹¬ç«‹ | å®Œå…¨ä¸å½±å“ | å¤æ‚æ•°æ®ç»“æ„çš„å®Œå…¨ç‹¬ç«‹å‰¯æœ¬ |

---

## 2. ğŸ·ï¸ èµ‹å€¼æ“ä½œï¼ˆå¼•ç”¨æ‹·è´ï¼‰


### 2.1 èµ‹å€¼çš„æœ¬è´¨å«ä¹‰


**é€šä¿—è§£é‡Š**ï¼šèµ‹å€¼æ“ä½œä¸æ˜¯"å¤åˆ¶"ï¼Œè€Œæ˜¯ç»™åŒä¸€ä¸ªå¯¹è±¡è´´ä¸Šæ–°æ ‡ç­¾

```python
# æƒ³è±¡è¿™æ˜¯ä¸€ä¸ªç›’å­ï¼Œé‡Œé¢è£…ç€ [1, 2, 3]
original_box = [1, 2, 3]

# è¿™ä¸æ˜¯å¤åˆ¶ç›’å­ï¼Œè€Œæ˜¯ç»™åŒä¸€ä¸ªç›’å­è´´ä¸Šæ–°æ ‡ç­¾
same_box = original_box

# è¯æ˜å®ƒä»¬æ˜¯åŒä¸€ä¸ªç›’å­
print(id(original_box))  # å†…å­˜åœ°å€ï¼š140234567890
print(id(same_box))      # å†…å­˜åœ°å€ï¼š140234567890ï¼ˆç›¸åŒï¼ï¼‰
print(original_box is same_box)  # Trueï¼Œç¡®å®æ˜¯åŒä¸€ä¸ªå¯¹è±¡
```

### 2.2 å¼•ç”¨æ‹·è´çš„è¡¨ç°


```python
# åˆ›å»ºåŸå§‹æ•°æ®
students = ['å¼ ä¸‰', 'æå››', 'ç‹äº”']
backup_students = students  # è¿™æ˜¯å¼•ç”¨æ‹·è´ï¼Œä¸æ˜¯çœŸæ­£çš„å¤‡ä»½

# ä¿®æ”¹å…¶ä¸­ä¸€ä¸ª
students.append('èµµå…­')

# æŸ¥çœ‹ç»“æœ
print('åŸå§‹åˆ—è¡¨:', students)        # ['å¼ ä¸‰', 'æå››', 'ç‹äº”', 'èµµå…­']
print('å¤‡ä»½åˆ—è¡¨:', backup_students) # ['å¼ ä¸‰', 'æå››', 'ç‹äº”', 'èµµå…­']

# ä¸¤ä¸ªåˆ—è¡¨åŒæ—¶å˜åŒ–äº†ï¼
```

### 2.3 å¼•ç”¨æ‹·è´çš„å†…å­˜æ¨¡å‹


```
å†…å­˜ç¤ºæ„å›¾ï¼š

å˜é‡å        å†…å­˜åœ°å€        å®é™…æ•°æ®
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚students â”‚â”€â”€â†’â”‚0x1001000 â”‚â”€â”€â†’â”‚['å¼ ä¸‰','æå››','ç‹äº”']â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚backup_  â”‚â”€â”€â†’â”‚0x1001000 â”‚   (æŒ‡å‘åŒä¸€ä¸ªåœ°å€)
â”‚students â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¸¤ä¸ªå˜é‡åæŒ‡å‘åŒä¸€å—å†…å­˜åŒºåŸŸ
```

### 2.4 ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å¼•ç”¨æ‹·è´


âœ… **é€‚ç”¨åœºæ™¯**ï¼š
- éœ€è¦å¤šä¸ªå˜é‡åŒæ­¥ä¿®æ”¹åŒä¸€æ•°æ®
- èŠ‚çœå†…å­˜ç©ºé—´ï¼ˆä¸åˆ›å»ºæ–°å¯¹è±¡ï¼‰
- å‡½æ•°å‚æ•°ä¼ é€’ï¼ˆPython çš„é»˜è®¤è¡Œä¸ºï¼‰

âŒ **ä¸é€‚ç”¨åœºæ™¯**ï¼š
- éœ€è¦ç‹¬ç«‹çš„æ•°æ®å‰¯æœ¬
- ä¸å¸Œæœ›ä¿®æ”¹å½±å“åŸæ•°æ®

---

## 3. ğŸ“‹ æµ…æ‹·è´ï¼ˆcopy.copyï¼‰


### 3.1 æµ…æ‹·è´çš„åŸºæœ¬æ¦‚å¿µ


**é€šä¿—ç†è§£**ï¼šæµ…æ‹·è´åˆ›å»ºä¸€ä¸ªæ–°çš„"å®¹å™¨"ï¼Œä½†å®¹å™¨é‡Œçš„å†…å®¹è¿˜æ˜¯å…±äº«çš„

```python
import copy

# åŸå§‹æ•°æ®ï¼ˆäºŒå±‚ç»“æ„ï¼‰
original = [1, 2, [3, 4]]
shallow_copy = copy.copy(original)

# éªŒè¯æ˜¯ä¸åŒçš„å¯¹è±¡
print(id(original))     # 140234567890
print(id(shallow_copy)) # 140234567891ï¼ˆä¸åŒçš„åœ°å€ï¼‰
print(original is shallow_copy)  # False
```

### 3.2 æµ…æ‹·è´çš„å±‚çº§æ•ˆæœ


```python
import copy

# åˆ›å»ºæœ‰åµŒå¥—ç»“æ„çš„æ•°æ®
class_info = {
    'name': 'ä¸‰å¹´çº§ä¸€ç­',
    'teacher': 'å¼ è€å¸ˆ',
    'students': ['å°æ˜', 'å°çº¢', 'å°å']  # è¿™æ˜¯åµŒå¥—çš„åˆ—è¡¨
}

# æµ…æ‹·è´
class_copy = copy.copy(class_info)

# ä¿®æ”¹ç¬¬ä¸€å±‚æ•°æ®
class_copy['name'] = 'ä¸‰å¹´çº§äºŒç­'
print('åŸå§‹:', class_info['name'])    # 'ä¸‰å¹´çº§ä¸€ç­'ï¼ˆæ²¡å˜ï¼‰
print('æ‹·è´:', class_copy['name'])    # 'ä¸‰å¹´çº§äºŒç­'ï¼ˆå˜äº†ï¼‰

# ä¿®æ”¹åµŒå¥—æ•°æ®
class_copy['students'].append('å°åˆš')
print('åŸå§‹å­¦ç”Ÿ:', class_info['students'])    # ['å°æ˜', 'å°çº¢', 'å°å', 'å°åˆš']ï¼ˆå˜äº†ï¼ï¼‰
print('æ‹·è´å­¦ç”Ÿ:', class_copy['students'])    # ['å°æ˜', 'å°çº¢', 'å°å', 'å°åˆš']ï¼ˆä¹Ÿå˜äº†ï¼ï¼‰
```

### 3.3 æµ…æ‹·è´çš„å†…å­˜æ¨¡å‹


```
æµ…æ‹·è´å†…å­˜ç¤ºæ„å›¾ï¼š

åŸå§‹å¯¹è±¡                        æ‹·è´å¯¹è±¡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ class_info  â”‚               â”‚ class_copy  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚name: 'ä¸€ç­' â”‚               â”‚name: 'äºŒç­' â”‚  â† ç‹¬ç«‹çš„
â”‚teacher: ... â”‚               â”‚teacher: ... â”‚  â† ç‹¬ç«‹çš„
â”‚students: â”€â”€â”€â”¼â”€â”€â”            â”‚students: â”€â”€â”€â”¼â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                          
                 â”œâ”€â†’ ['å°æ˜','å°çº¢','å°å'] â† å…±äº«çš„åµŒå¥—å¯¹è±¡
                 â”‚
```

> âš ï¸ **å…³é”®ç†è§£**  
> æµ…æ‹·è´åªå¤åˆ¶äº†"ç¬¬ä¸€å±‚"ï¼ŒåµŒå¥—åœ¨é‡Œé¢çš„å¯¹è±¡ï¼ˆå¦‚åˆ—è¡¨ã€å­—å…¸ï¼‰ä»ç„¶æ˜¯å…±äº«çš„

### 3.4 æµ…æ‹·è´çš„å¤šç§æ–¹æ³•


```python
import copy

original = [1, 2, [3, 4]]

# æ–¹æ³•1ï¼šcopy.copy()
method1 = copy.copy(original)

# æ–¹æ³•2ï¼šåˆ‡ç‰‡ï¼ˆé’ˆå¯¹åºåˆ—ï¼‰
method2 = original[:]

# æ–¹æ³•3ï¼šæ„é€ å‡½æ•°
method3 = list(original)  # åˆ—è¡¨
method4 = dict(original_dict)  # å­—å…¸

# æ–¹æ³•4ï¼šå·¥å‚å‡½æ•°
method5 = list(original)

# éªŒè¯éƒ½æ˜¯æµ…æ‹·è´
original[2].append(5)
print(method1)  # [1, 2, [3, 4, 5]]
print(method2)  # [1, 2, [3, 4, 5]]
print(method3)  # [1, 2, [3, 4, 5]]
```

---

## 4. ğŸ“š æ·±æ‹·è´ï¼ˆcopy.deepcopyï¼‰


### 4.1 æ·±æ‹·è´çš„æ ¸å¿ƒæ¦‚å¿µ


**ç®€å•ç†è§£**ï¼šæ·±æ‹·è´æ˜¯"å®Œå…¨å¤åˆ¶"ï¼Œåˆ›å»ºä¸€ä¸ªä¸åŸå¯¹è±¡å®Œå…¨ç‹¬ç«‹çš„å‰¯æœ¬

```python
import copy

# å¤æ‚çš„åµŒå¥—ç»“æ„
company = {
    'name': 'ç§‘æŠ€å…¬å¸',
    'departments': {
        'æŠ€æœ¯éƒ¨': ['ç¨‹åºå‘˜A', 'ç¨‹åºå‘˜B'],
        'é”€å”®éƒ¨': ['é”€å”®å‘˜A', 'é”€å”®å‘˜B']
    },
    'projects': [
        {'name': 'é¡¹ç›®1', 'members': ['å¼ ä¸‰', 'æå››']},
        {'name': 'é¡¹ç›®2', 'members': ['ç‹äº”', 'èµµå…­']}
    ]
}

# æ·±æ‹·è´
company_backup = copy.deepcopy(company)

# ä¿®æ”¹ä»»ä½•å±‚çº§çš„æ•°æ®
company['name'] = 'æ–°ç§‘æŠ€å…¬å¸'                           # ç¬¬1å±‚ä¿®æ”¹
company['departments']['æŠ€æœ¯éƒ¨'].append('ç¨‹åºå‘˜C')        # ç¬¬2å±‚ä¿®æ”¹  
company['projects'][0]['members'].append('é’±ä¸ƒ')        # ç¬¬3å±‚ä¿®æ”¹

print('=== åŸå§‹å…¬å¸ ===')
print('å…¬å¸å:', company['name'])
print('æŠ€æœ¯éƒ¨:', company['departments']['æŠ€æœ¯éƒ¨'])
print('é¡¹ç›®1æˆå‘˜:', company['projects'][0]['members'])

print('\n=== å¤‡ä»½å…¬å¸ ===')
print('å…¬å¸å:', company_backup['name'])                # æ—§åç§°
print('æŠ€æœ¯éƒ¨:', company_backup['departments']['æŠ€æœ¯éƒ¨']) # æ²¡æœ‰ç¨‹åºå‘˜C
print('é¡¹ç›®1æˆå‘˜:', company_backup['projects'][0]['members'])  # æ²¡æœ‰é’±ä¸ƒ
```

### 4.2 æ·±æ‹·è´çš„é€’å½’ç‰¹æ€§


**å…³é”®ç†è§£**ï¼šæ·±æ‹·è´ä¼š"é€’å½’åœ°"å¤åˆ¶æ‰€æœ‰åµŒå¥—å¯¹è±¡

```
æ·±æ‹·è´è¿‡ç¨‹ï¼š

åŸå§‹å¯¹è±¡
â”œâ”€â”€ ç›´æ¥å±æ€§ â†’ å¤åˆ¶å€¼
â”œâ”€â”€ åµŒå¥—å¯¹è±¡1 â†’ åˆ›å»ºæ–°å¯¹è±¡
â”‚   â”œâ”€â”€ å­å±æ€§1 â†’ å¤åˆ¶å€¼
â”‚   â””â”€â”€ åµŒå¥—å¯¹è±¡2 â†’ åˆ›å»ºæ–°å¯¹è±¡
â”‚       â””â”€â”€ å­å±æ€§2 â†’ å¤åˆ¶å€¼
â””â”€â”€ åµŒå¥—å¯¹è±¡3 â†’ åˆ›å»ºæ–°å¯¹è±¡
    â””â”€â”€ ...ç»§ç»­é€’å½’...

ç»“æœï¼šæ¯ä¸€å±‚éƒ½æ˜¯ç‹¬ç«‹çš„æ–°å¯¹è±¡
```

### 4.3 æ·±æ‹·è´å†…å­˜æ¨¡å‹


```
æ·±æ‹·è´å†…å­˜ç¤ºæ„å›¾ï¼š

åŸå§‹å¯¹è±¡                           æ·±æ‹·è´å¯¹è±¡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    company      â”‚               â”‚ company_backup  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚name: 'ç§‘æŠ€å…¬å¸'   â”‚               â”‚name: 'ç§‘æŠ€å…¬å¸'   â”‚
â”‚departments: â”€â”€â”€â”€â”¼â”€â”€â”            â”‚departments: â”€â”€â”€â”€â”¼â”€â”€â”
â”‚projects: â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”â”‚            â”‚projects: â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
                    â”‚â”‚                                â”‚â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚   departments   â”‚â†â”˜â”‚            â”‚   departments   â”‚â†â”˜â”‚
â”‚æŠ€æœ¯éƒ¨: ['A','B'] â”‚  â”‚            â”‚æŠ€æœ¯éƒ¨: ['A','B'] â”‚  â”‚
â”‚é”€å”®éƒ¨: ['C','D'] â”‚  â”‚            â”‚é”€å”®éƒ¨: ['C','D'] â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                     â”‚                                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    projects     â”‚â†â”€â”˜            â”‚    projects     â”‚â†â”€â”˜
â”‚é¡¹ç›®1: {...}     â”‚               â”‚é¡¹ç›®1: {...}     â”‚
â”‚é¡¹ç›®2: {...}     â”‚               â”‚é¡¹ç›®2: {...}     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å®Œå…¨ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œä»»ä½•ä¿®æ”¹éƒ½ä¸ä¼šç›¸äº’å½±å“
```

### 4.4 æ·±æ‹·è´ä¸å¾ªç¯å¼•ç”¨


Python çš„æ·±æ‹·è´å¾ˆæ™ºèƒ½ï¼Œèƒ½å¤„ç†**å¾ªç¯å¼•ç”¨**é—®é¢˜ï¼š

```python
import copy

# åˆ›å»ºå¾ªç¯å¼•ç”¨çš„ç»“æ„
person_a = {'name': 'å¼ ä¸‰', 'friend': None}
person_b = {'name': 'æå››', 'friend': None}

# å»ºç«‹ç›¸äº’å¼•ç”¨
person_a['friend'] = person_b
person_b['friend'] = person_a

# æ·±æ‹·è´ä¾ç„¶èƒ½æ­£ç¡®å¤„ç†
copied_person_a = copy.deepcopy(person_a)

print(copied_person_a['name'])                    # å¼ ä¸‰
print(copied_person_a['friend']['name'])          # æå››
print(copied_person_a['friend']['friend']['name']) # å¼ ä¸‰

# éªŒè¯æ˜¯ç‹¬ç«‹çš„å¯¹è±¡
print(copied_person_a is person_a)  # False
```

---

## 5. ğŸ¯ æ‹·è´çš„åº”ç”¨åœºæ™¯


### 5.1 æ•°æ®å¤‡ä»½åœºæ™¯


```python
import copy

# æ¸¸æˆå­˜æ¡£ç³»ç»Ÿ
game_state = {
    'player': {
        'name': 'å‹‡è€…',
        'level': 10,
        'inventory': ['å‰‘', 'ç›¾', 'è¯æ°´']
    },
    'progress': {
        'current_stage': 5,
        'completed_quests': ['ä»»åŠ¡1', 'ä»»åŠ¡2']
    }
}

# åˆ›å»ºå­˜æ¡£ï¼ˆéœ€è¦å®Œå…¨ç‹¬ç«‹ï¼‰
save_file = copy.deepcopy(game_state)

# ç©å®¶ç»§ç»­æ¸¸æˆï¼ŒçŠ¶æ€å‘ç”Ÿå˜åŒ–
game_state['player']['level'] = 15
game_state['player']['inventory'].append('é­”æ³•ä¹¦')
game_state['progress']['current_stage'] = 6

# å­˜æ¡£ä¿æŒåŸçŠ¶
print('å½“å‰ç­‰çº§:', game_state['player']['level'])  # 15
print('å­˜æ¡£ç­‰çº§:', save_file['player']['level'])   # 10ï¼ˆä¿æŒä¸å˜ï¼‰
```

### 5.2 å‡½æ•°å‚æ•°ä¿æŠ¤


```python
import copy

def process_data(data_list):
    """
    å¤„ç†æ•°æ®çš„å‡½æ•°ï¼Œä¸åº”è¯¥ä¿®æ”¹åŸå§‹æ•°æ®
    """
    # åˆ›å»ºå‰¯æœ¬è¿›è¡Œå¤„ç†
    working_copy = copy.deepcopy(data_list)
    
    # å®‰å…¨åœ°ä¿®æ”¹å‰¯æœ¬
    for item in working_copy:
        if isinstance(item, dict):
            item['processed'] = True
    
    return working_copy

# åŸå§‹æ•°æ®
original_data = [
    {'id': 1, 'value': 100},
    {'id': 2, 'value': 200}
]

# å¤„ç†æ•°æ®
result = process_data(original_data)

print('åŸå§‹æ•°æ®:', original_data)  # æ²¡æœ‰ 'processed' å­—æ®µ
print('å¤„ç†ç»“æœ:', result)        # æœ‰ 'processed' å­—æ®µ
```

### 5.3 æ¨¡æ¿å’Œé…ç½®åœºæ™¯


```python
import copy

# åŸºç¡€é…ç½®æ¨¡æ¿
base_config = {
    'database': {
        'host': 'localhost',
        'port': 5432,
        'settings': {
            'timeout': 30,
            'pool_size': 10
        }
    },
    'logging': {
        'level': 'INFO',
        'handlers': ['console', 'file']
    }
}

# ä¸ºä¸åŒç¯å¢ƒåˆ›å»ºé…ç½®
dev_config = copy.deepcopy(base_config)
dev_config['database']['host'] = 'dev-server'
dev_config['logging']['level'] = 'DEBUG'

prod_config = copy.deepcopy(base_config)
prod_config['database']['host'] = 'prod-server'
prod_config['database']['settings']['pool_size'] = 50

# æ¨¡æ¿ä¿æŒåŸæ ·ï¼Œå„ç¯å¢ƒé…ç½®ç‹¬ç«‹
print('å¼€å‘ç¯å¢ƒä¸»æœº:', dev_config['database']['host'])   # dev-server
print('ç”Ÿäº§ç¯å¢ƒä¸»æœº:', prod_config['database']['host'])  # prod-server
print('åŸºç¡€æ¨¡æ¿ä¸»æœº:', base_config['database']['host'])  # localhostï¼ˆä¸å˜ï¼‰
```

---

## 6. ğŸ”§ è‡ªå®šä¹‰æ‹·è´è¡Œä¸º


### 6.1 ä¸ºä»€ä¹ˆéœ€è¦è‡ªå®šä¹‰æ‹·è´


**é—®é¢˜åœºæ™¯**ï¼šæœ‰äº›å¯¹è±¡åŒ…å«ä¸åº”è¯¥è¢«æ‹·è´çš„èµ„æºï¼ˆå¦‚æ–‡ä»¶å¥æŸ„ã€ç½‘ç»œè¿æ¥ï¼‰

```python
import copy

class DatabaseConnection:
    def __init__(self, host, port):
        self.host = host
        self.port = port
        self.connection = f"è¿æ¥åˆ° {host}:{port}"  # æ¨¡æ‹Ÿè¿æ¥
        print(f"å»ºç«‹æ•°æ®åº“è¿æ¥: {self.connection}")
    
    def query(self, sql):
        return f"æ‰§è¡ŒæŸ¥è¯¢: {sql}"

# æ™®é€šæ‹·è´çš„é—®é¢˜
original_conn = DatabaseConnection('localhost', 5432)
copied_conn = copy.copy(original_conn)

# ä¸¤ä¸ªå¯¹è±¡å…±äº«åŒä¸€ä¸ªè¿æ¥å­—ç¬¦ä¸²ï¼Œè¿™å¯èƒ½ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„
print(original_conn.connection)  # è¿æ¥åˆ° localhost:5432
print(copied_conn.connection)    # è¿æ¥åˆ° localhost:5432
```

### 6.2 å®ç° `__copy__` æ–¹æ³•


```python
import copy

class SmartDatabaseConnection:
    def __init__(self, host, port):
        self.host = host
        self.port = port
        self.connection = f"è¿æ¥åˆ° {host}:{port}"
        print(f"å»ºç«‹æ•°æ®åº“è¿æ¥: {self.connection}")
    
    def __copy__(self):
        """è‡ªå®šä¹‰æµ…æ‹·è´è¡Œä¸º"""
        print("æ‰§è¡Œè‡ªå®šä¹‰æµ…æ‹·è´")
        # åˆ›å»ºæ–°çš„è¿æ¥ï¼Œè€Œä¸æ˜¯å…±äº«è¿æ¥
        return SmartDatabaseConnection(self.host, self.port)
    
    def __deepcopy__(self, memo):
        """è‡ªå®šä¹‰æ·±æ‹·è´è¡Œä¸º"""
        print("æ‰§è¡Œè‡ªå®šä¹‰æ·±æ‹·è´")
        # memo å‚æ•°ç”¨äºå¤„ç†å¾ªç¯å¼•ç”¨
        return SmartDatabaseConnection(
            copy.deepcopy(self.host, memo),
            copy.deepcopy(self.port, memo)
        )

# æµ‹è¯•è‡ªå®šä¹‰æ‹·è´
original = SmartDatabaseConnection('localhost', 5432)
shallow_copy = copy.copy(original)      # ä¼šè°ƒç”¨ __copy__
deep_copy = copy.deepcopy(original)     # ä¼šè°ƒç”¨ __deepcopy__
```

### 6.3 æ§åˆ¶æ‹·è´çš„å±æ€§


```python
import copy

class ConfigManager:
    def __init__(self, config_name):
        self.config_name = config_name
        self.settings = {'debug': True, 'timeout': 30}
        self._cache = {}  # ç§æœ‰ç¼“å­˜ï¼Œä¸åº”è¯¥è¢«æ‹·è´
        self._secret_key = "secret123"  # æ•æ„Ÿä¿¡æ¯ï¼Œä¸åº”è¯¥è¢«æ‹·è´
    
    def __copy__(self):
        """åªæ‹·è´å¿…è¦çš„å±æ€§"""
        new_obj = ConfigManager(self.config_name)
        new_obj.settings = self.settings.copy()  # æµ…æ‹·è´è®¾ç½®
        # æ³¨æ„ï¼šä¸æ‹·è´ _cache å’Œ _secret_key
        return new_obj
    
    def __deepcopy__(self, memo):
        """æ·±æ‹·è´æ—¶ä¹Ÿåªæ‹·è´å¿…è¦çš„å±æ€§"""
        new_obj = ConfigManager(copy.deepcopy(self.config_name, memo))
        new_obj.settings = copy.deepcopy(self.settings, memo)
        # åŒæ ·ä¸æ‹·è´æ•æ„Ÿä¿¡æ¯
        return new_obj

# æµ‹è¯•
original_config = ConfigManager("app_config")
original_config._cache['key1'] = 'cached_data'

copied_config = copy.deepcopy(original_config)
print('åŸå§‹ç¼“å­˜:', getattr(original_config, '_cache', {}))    # {'key1': 'cached_data'}
print('æ‹·è´ç¼“å­˜:', getattr(copied_config, '_cache', {}))      # {}ï¼ˆç©ºçš„ï¼‰
```

---

## 7. âš¡ æ‹·è´ä¸æ€§èƒ½è€ƒè™‘


### 7.1 æ€§èƒ½å¯¹æ¯”åˆ†æ


```python
import copy
import time

# åˆ›å»ºæµ‹è¯•æ•°æ®
def create_test_data(size):
    return {
        'numbers': list(range(size)),
        'nested': {
            'inner_list': [{'id': i, 'data': f'item_{i}'} for i in range(size)]
        }
    }

# æ€§èƒ½æµ‹è¯•å‡½æ•°
def performance_test(data_size):
    print(f"\n=== æµ‹è¯•æ•°æ®å¤§å°: {data_size} ===")
    test_data = create_test_data(data_size)
    
    # æµ‹è¯•èµ‹å€¼ï¼ˆå¼•ç”¨æ‹·è´ï¼‰
    start_time = time.time()
    for _ in range(1000):
        reference_copy = test_data
    ref_time = time.time() - start_time
    
    # æµ‹è¯•æµ…æ‹·è´
    start_time = time.time()
    for _ in range(1000):
        shallow_copy = copy.copy(test_data)
    shallow_time = time.time() - start_time
    
    # æµ‹è¯•æ·±æ‹·è´
    start_time = time.time()
    for _ in range(100):  # æ·±æ‹·è´æ¯”è¾ƒæ…¢ï¼Œå‡å°‘æµ‹è¯•æ¬¡æ•°
        deep_copy = copy.deepcopy(test_data)
    deep_time = (time.time() - start_time) * 10  # æ¢ç®—æˆ1000æ¬¡çš„æ—¶é—´
    
    print(f"å¼•ç”¨æ‹·è´: {ref_time:.4f}ç§’")
    print(f"æµ…æ‹·è´:   {shallow_time:.4f}ç§’")
    print(f"æ·±æ‹·è´:   {deep_time:.4f}ç§’")
    print(f"æ€§èƒ½æ¯”ä¾‹: å¼•ç”¨ 1 : æµ…æ‹·è´ {shallow_time/ref_time:.0f} : æ·±æ‹·è´ {deep_time/ref_time:.0f}")

# è¿è¡Œæ€§èƒ½æµ‹è¯•
performance_test(100)
performance_test(1000)
```

### 7.2 å†…å­˜ä½¿ç”¨åˆ†æ


```python
import copy
import sys

def analyze_memory_usage():
    # åŸå§‹æ•°æ®
    original_data = {
        'large_list': [i for i in range(10000)],
        'nested_dict': {f'key_{i}': [i] * 100 for i in range(100)}
    }
    
    # ä¸åŒæ‹·è´æ–¹å¼
    reference = original_data
    shallow_copy = copy.copy(original_data)
    deep_copy = copy.deepcopy(original_data)
    
    print("=== å†…å­˜ä½¿ç”¨åˆ†æ ===")
    print(f"åŸå§‹æ•°æ®:   {sys.getsizeof(original_data)} å­—èŠ‚")
    print(f"å¼•ç”¨æ‹·è´:   {sys.getsizeof(reference)} å­—èŠ‚")
    print(f"æµ…æ‹·è´:     {sys.getsizeof(shallow_copy)} å­—èŠ‚")
    print(f"æ·±æ‹·è´:     {sys.getsizeof(deep_copy)} å­—èŠ‚")
    
    # æ£€æŸ¥æ˜¯å¦æ˜¯åŒä¸€å¯¹è±¡
    print(f"\n=== å¯¹è±¡èº«ä»½æ£€æŸ¥ ===")
    print(f"å¼•ç”¨æ˜¯åŒä¸€å¯¹è±¡: {original_data is reference}")
    print(f"æµ…æ‹·è´æ˜¯åŒä¸€å¯¹è±¡: {original_data is shallow_copy}")
    print(f"æ·±æ‹·è´æ˜¯åŒä¸€å¯¹è±¡: {original_data is deep_copy}")
    
    # æ£€æŸ¥åµŒå¥—å¯¹è±¡
    print(f"\n=== åµŒå¥—å¯¹è±¡æ£€æŸ¥ ===")
    print(f"æµ…æ‹·è´çš„åµŒå¥—åˆ—è¡¨æ˜¯åŒä¸€å¯¹è±¡: {original_data['large_list'] is shallow_copy['large_list']}")
    print(f"æ·±æ‹·è´çš„åµŒå¥—åˆ—è¡¨æ˜¯åŒä¸€å¯¹è±¡: {original_data['large_list'] is deep_copy['large_list']}")

analyze_memory_usage()
```

### 7.3 æ€§èƒ½ä¼˜åŒ–å»ºè®®


> ğŸ’¡ **æ€§èƒ½ä¼˜åŒ–åŸåˆ™**

**é€‰æ‹©åˆé€‚çš„æ‹·è´æ–¹å¼**ï¼š
- **ç®€å•æ•°æ®** â†’ ä½¿ç”¨æµ…æ‹·è´
- **åµŒå¥—æ•°æ®éœ€è¦ç‹¬ç«‹** â†’ ä½¿ç”¨æ·±æ‹·è´  
- **åªéœ€è¦å¼•ç”¨** â†’ ä½¿ç”¨èµ‹å€¼
- **é¢‘ç¹æ‹·è´** â†’ è€ƒè™‘é‡æ„è®¾è®¡

**é¿å…ä¸å¿…è¦çš„æ‹·è´**ï¼š
```python
# âŒ ä¸å¥½çš„åšæ³•
def process_list(data):
    data_copy = copy.deepcopy(data)  # æ¯æ¬¡éƒ½æ·±æ‹·è´
    # ... å¤„ç†é€»è¾‘
    return data_copy

# âœ… æ›´å¥½çš„åšæ³•
def process_list(data, modify_original=False):
    if modify_original:
        working_data = data
    else:
        working_data = copy.copy(data)  # æ ¹æ®éœ€è¦é€‰æ‹©æ‹·è´æ·±åº¦
    # ... å¤„ç†é€»è¾‘
    return working_data
```

---

## 8. ğŸ”„ ä¸å¯å˜å¯¹è±¡æ‹·è´ä¼˜åŒ–


### 8.1 ä¸å¯å˜å¯¹è±¡çš„æ‹·è´ç‰¹æ€§


**å…³é”®ç†è§£**ï¼šPython å¯¹ä¸å¯å˜å¯¹è±¡çš„æ‹·è´è¿›è¡Œäº†æ™ºèƒ½ä¼˜åŒ–

```python
import copy

# ä¸å¯å˜å¯¹è±¡æµ‹è¯•
original_tuple = (1, 2, 3)
original_string = "Hello World"
original_number = 42

# æµ…æ‹·è´ä¸å¯å˜å¯¹è±¡
shallow_tuple = copy.copy(original_tuple)
shallow_string = copy.copy(original_string)
shallow_number = copy.copy(original_number)

# æ·±æ‹·è´ä¸å¯å˜å¯¹è±¡
deep_tuple = copy.deepcopy(original_tuple)
deep_string = copy.deepcopy(original_string)
deep_number = copy.deepcopy(original_number)

# æ£€æŸ¥æ˜¯å¦æ˜¯åŒä¸€å¯¹è±¡
print("=== ä¸å¯å˜å¯¹è±¡æ‹·è´ç»“æœ ===")
print(f"å…ƒç»„ - æµ…æ‹·è´æ˜¯åŒä¸€å¯¹è±¡: {original_tuple is shallow_tuple}")    # True
print(f"å…ƒç»„ - æ·±æ‹·è´æ˜¯åŒä¸€å¯¹è±¡: {original_tuple is deep_tuple}")      # True
print(f"å­—ç¬¦ä¸² - æµ…æ‹·è´æ˜¯åŒä¸€å¯¹è±¡: {original_string is shallow_string}")  # True
print(f"æ•°å­— - æµ…æ‹·è´æ˜¯åŒä¸€å¯¹è±¡: {original_number is shallow_number}")    # True
```

> ğŸ’¡ **Python ä¼˜åŒ–æœºåˆ¶**  
> ä¸å¯å˜å¯¹è±¡æ— æ³•ä¿®æ”¹ï¼Œæ‰€ä»¥ Python èªæ˜åœ°è¿”å›åŸå¯¹è±¡çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯åˆ›å»ºæ–°å¯¹è±¡

### 8.2 æ··åˆç»“æ„çš„æ‹·è´è¡Œä¸º


```python
import copy

# åŒ…å«ä¸å¯å˜å’Œå¯å˜å¯¹è±¡çš„æ··åˆç»“æ„
mixed_data = {
    'immutable_str': 'Hello',
    'immutable_tuple': (1, 2, 3),
    'mutable_list': [4, 5, 6],
    'nested': {
        'inner_str': 'World',
        'inner_list': [7, 8, 9]
    }
}

shallow_copy = copy.copy(mixed_data)
deep_copy = copy.deepcopy(mixed_data)

print("=== æ··åˆç»“æ„æ‹·è´åˆ†æ ===")

# æ£€æŸ¥å­—å…¸æœ¬èº«
print(f"å­—å…¸æœ¬èº« - æµ…æ‹·è´: {mixed_data is shallow_copy}")  # False
print(f"å­—å…¸æœ¬èº« - æ·±æ‹·è´: {mixed_data is deep_copy}")    # False

# æ£€æŸ¥ä¸å¯å˜å…ƒç´ ï¼ˆä¼˜åŒ–ï¼šè¿”å›ç›¸åŒå¼•ç”¨ï¼‰
print(f"å­—ç¬¦ä¸² - æµ…æ‹·è´: {mixed_data['immutable_str'] is shallow_copy['immutable_str']}")  # True
print(f"å…ƒç»„ - æ·±æ‹·è´: {mixed_data['immutable_tuple'] is deep_copy['immutable_tuple']}")    # True

# æ£€æŸ¥å¯å˜å…ƒç´ 
print(f"åˆ—è¡¨ - æµ…æ‹·è´: {mixed_data['mutable_list'] is shallow_copy['mutable_list']}")      # Trueï¼ˆæµ…æ‹·è´å…±äº«ï¼‰
print(f"åˆ—è¡¨ - æ·±æ‹·è´: {mixed_data['mutable_list'] is deep_copy['mutable_list']}")          # Falseï¼ˆæ·±æ‹·è´ç‹¬ç«‹ï¼‰
```

### 8.3 è‡ªå®šä¹‰ä¸å¯å˜ç±»çš„æ‹·è´


```python
import copy

class ImmutablePoint:
    """è‡ªå®šä¹‰çš„ä¸å¯å˜ç‚¹ç±»"""
    def __init__(self, x, y):
        self._x = x
        self._y = y
    
    @property
    def x(self):
        return self._x
    
    @property  
    def y(self):
        return self._y
    
    def __copy__(self):
        """ç”±äºå¯¹è±¡ä¸å¯å˜ï¼Œè¿”å›è‡ªèº«å³å¯"""
        return self
    
    def __deepcopy__(self, memo):
        """ç”±äºå¯¹è±¡ä¸å¯å˜ï¼Œè¿”å›è‡ªèº«å³å¯"""
        return self
    
    def __repr__(self):
        return f"Point({self.x}, {self.y})"

# æµ‹è¯•è‡ªå®šä¹‰ä¸å¯å˜å¯¹è±¡
original_point = ImmutablePoint(10, 20)
copied_point = copy.copy(original_point)
deep_copied_point = copy.deepcopy(original_point)

print(f"åŸå§‹ç‚¹: {original_point}")
print(f"æ‹·è´æ˜¯åŒä¸€å¯¹è±¡: {original_point is copied_point}")      # True
print(f"æ·±æ‹·è´æ˜¯åŒä¸€å¯¹è±¡: {original_point is deep_copied_point}") # True
```

---

## 9. âš ï¸ æ‹·è´é™·é˜±ä¸æ³¨æ„äº‹é¡¹


### 9.1 å¸¸è§æ‹·è´é™·é˜±


#### é™·é˜±1ï¼šä»¥ä¸ºèµ‹å€¼æ˜¯æ‹·è´


```python
# âŒ æ–°æ‰‹å¸¸çŠ¯çš„é”™è¯¯
def backup_data(original_list):
    backup = original_list  # è¿™ä¸æ˜¯å¤‡ä»½ï¼
    return backup

data = [1, 2, 3]
backup = backup_data(data)
data.append(4)
print(backup)  # [1, 2, 3, 4] - å¤‡ä»½ä¹Ÿå˜äº†ï¼

# âœ… æ­£ç¡®çš„åšæ³•
def backup_data_correct(original_list):
    backup = copy.copy(original_list)  # çœŸæ­£çš„æ‹·è´
    return backup
```

#### é™·é˜±2ï¼šæµ…æ‹·è´çš„åµŒå¥—å¯¹è±¡é—®é¢˜


```python
# âŒ æµ…æ‹·è´é™·é˜±
students_class_a = {
    'class_name': 'ä¸‰å¹´ä¸€ç­',
    'students': [
        {'name': 'å¼ ä¸‰', 'scores': [85, 90, 88]},
        {'name': 'æå››', 'scores': [92, 87, 95]}
    ]
}

students_class_b = copy.copy(students_class_a)
students_class_b['class_name'] = 'ä¸‰å¹´äºŒç­'  # è¿™ä¸ªä¿®æ”¹æ˜¯ç‹¬ç«‹çš„

# ä½†æ˜¯ä¿®æ”¹åµŒå¥—çš„å­¦ç”Ÿä¿¡æ¯ä¼šå½±å“åŸå§‹æ•°æ®
students_class_b['students'][0]['scores'].append(95)

print('Aç­å¼ ä¸‰æˆç»©:', students_class_a['students'][0]['scores'])  # [85, 90, 88, 95] - è¢«å½±å“äº†ï¼
print('Bç­å¼ ä¸‰æˆç»©:', students_class_b['students'][0]['scores'])  # [85, 90, 88, 95]

# âœ… æ­£ç¡®åšæ³•ï¼šä½¿ç”¨æ·±æ‹·è´
students_class_c = copy.deepcopy(students_class_a)
```

#### é™·é˜±3ï¼šå¿˜è®°å¤„ç†å¾ªç¯å¼•ç”¨


```python
# åˆ›å»ºå¾ªç¯å¼•ç”¨
node_a = {'name': 'A', 'next': None}
node_b = {'name': 'B', 'next': None}
node_a['next'] = node_b
node_b['next'] = node_a  # å¾ªç¯å¼•ç”¨

# âŒ å¦‚æœæ‰‹åŠ¨å®ç°æ‹·è´ï¼Œå¯èƒ½é™·å…¥æ— é™å¾ªç¯
def naive_copy(obj):
    if isinstance(obj, dict):
        result = {}
        for key, value in obj.items():
            result[key] = naive_copy(value)  # é€’å½’è°ƒç”¨
        return result
    return obj

# naive_copy(node_a)  # è¿™ä¼šå¯¼è‡´æ— é™é€’å½’ï¼

# âœ… Python çš„ deepcopy èƒ½æ­£ç¡®å¤„ç†
safe_copy = copy.deepcopy(node_a)
print(safe_copy['name'])                    # A
print(safe_copy['next']['name'])            # B  
print(safe_copy['next']['next']['name'])    # Aï¼ˆæ­£ç¡®çš„å¾ªç¯ï¼‰
```

### 9.2 ç‰¹æ®Šå¯¹è±¡çš„æ‹·è´é—®é¢˜


#### æ–‡ä»¶å¯¹è±¡æ‹·è´


```python
import copy
import io

# æ–‡ä»¶å¯¹è±¡é€šå¸¸ä¸åº”è¯¥è¢«æ‹·è´
file_obj = io.StringIO("Hello World")

try:
    copied_file = copy.copy(file_obj)
    print("æ–‡ä»¶å¯¹è±¡æ‹·è´æˆåŠŸ")
except Exception as e:
    print(f"æ–‡ä»¶å¯¹è±¡æ‹·è´å¤±è´¥: {e}")

# æ­£ç¡®çš„åšæ³•ï¼šé‡æ–°åˆ›å»ºæ–‡ä»¶å¯¹è±¡
def duplicate_file_handle(original_file):
    """æ­£ç¡®åœ°å¤åˆ¶æ–‡ä»¶å¥æŸ„"""
    current_position = original_file.tell()
    original_file.seek(0)
    content = original_file.read()
    original_file.seek(current_position)
    
    new_file = io.StringIO(content)
    new_file.seek(current_position)
    return new_file
```

#### çº¿ç¨‹é”å¯¹è±¡æ‹·è´


```python
import copy
import threading

# çº¿ç¨‹é”ä¸åº”è¯¥è¢«æ‹·è´
lock = threading.Lock()

try:
    copied_lock = copy.copy(lock)
    print("é”å¯¹è±¡æ‹·è´æˆåŠŸ")
except Exception as e:
    print(f"é”å¯¹è±¡æ‹·è´å¤±è´¥: {e}")

# åŒ…å«é”çš„å¯¹è±¡éœ€è¦ç‰¹æ®Šå¤„ç†
class ThreadSafeCounter:
    def __init__(self):
        self.count = 0
        self._lock = threading.Lock()
    
    def __copy__(self):
        new_counter = ThreadSafeCounter()
        new_counter.count = self.count
        # ä¸æ‹·è´é”ï¼Œåˆ›å»ºæ–°çš„é”
        return new_counter
    
    def __deepcopy__(self, memo):
        return self.__copy__()  # æ·±æ‹·è´æ—¶ä½¿ç”¨ç›¸åŒé€»è¾‘
```

### 9.3 æ€§èƒ½é™·é˜±


```python
import copy
import time

# âŒ æ€§èƒ½é™·é˜±ï¼šä¸å¿…è¦çš„æ·±æ‹·è´
def slow_process_data(data_list):
    results = []
    for item in data_list:
        # æ¯æ¬¡å¾ªç¯éƒ½æ·±æ‹·è´ï¼Œéå¸¸ä½æ•ˆ
        item_copy = copy.deepcopy(item)
        item_copy['processed'] = True
        results.append(item_copy)
    return results

# âœ… ä¼˜åŒ–ç‰ˆæœ¬ï¼šå‡å°‘ä¸å¿…è¦çš„æ‹·è´
def fast_process_data(data_list):
    results = []
    for item in data_list:
        # åªæ‹·è´éœ€è¦ä¿®æ”¹çš„éƒ¨åˆ†
        item_copy = item.copy()  # æµ…æ‹·è´è¶³å¤Ÿ
        item_copy['processed'] = True
        results.append(item_copy)
    return results

# æ€§èƒ½å¯¹æ¯”
test_data = [{'id': i, 'data': f'item_{i}'} for i in range(1000)]

start_time = time.time()
slow_result = slow_process_data(test_data)
slow_time = time.time() - start_time

start_time = time.time()
fast_result = fast_process_data(test_data)
fast_time = time.time() - start_time

print(f"æ·±æ‹·è´æ–¹å¼: {slow_time:.4f}ç§’")
print(f"æµ…æ‹·è´æ–¹å¼: {fast_time:.4f}ç§’")
print(f"æ€§èƒ½æå‡: {slow_time/fast_time:.1f}å€")
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ èµ‹å€¼æ“ä½œï¼šåˆ›å»ºæ–°çš„å¼•ç”¨ï¼ŒæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡
ğŸ”¸ æµ…æ‹·è´ï¼šåˆ›å»ºæ–°å®¹å™¨ï¼Œä½†å†…å®¹ä»ç„¶å…±äº«
ğŸ”¸ æ·±æ‹·è´ï¼šé€’å½’åˆ›å»ºå®Œå…¨ç‹¬ç«‹çš„å‰¯æœ¬
ğŸ”¸ æ‹·è´é€‰æ‹©ï¼šæ ¹æ®æ•°æ®ç»“æ„å’Œéœ€æ±‚é€‰æ‹©åˆé€‚çš„æ‹·è´æ–¹å¼
ğŸ”¸ æ€§èƒ½è€ƒè™‘ï¼šæ‹·è´æœ‰æ€§èƒ½å¼€é”€ï¼Œé¿å…ä¸å¿…è¦çš„æ‹·è´
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æ‹·è´çš„æœ¬è´¨å·®å¼‚**
```
å¼•ç”¨æ‹·è´ï¼šä¸¤ä¸ªæ ‡ç­¾ï¼Œä¸€ä¸ªç›’å­
æµ…æ‹·è´ï¼šä¸¤ä¸ªç›’å­ï¼Œå…±äº«å†…å®¹
æ·±æ‹·è´ï¼šä¸¤ä¸ªç›’å­ï¼Œç‹¬ç«‹å†…å®¹
```

**ğŸ”¹ ä½¿ç”¨åœºæ™¯åˆ¤æ–­**
```
éœ€è¦åŒæ­¥ä¿®æ”¹ â†’ ä½¿ç”¨å¼•ç”¨æ‹·è´
éœ€è¦ç‹¬ç«‹çš„ç®€å•å‰¯æœ¬ â†’ ä½¿ç”¨æµ…æ‹·è´  
éœ€è¦å®Œå…¨ç‹¬ç«‹çš„å¤æ‚å‰¯æœ¬ â†’ ä½¿ç”¨æ·±æ‹·è´
```

**ğŸ”¹ å¸¸è§é”™è¯¯é¿å…**
```
âŒ æŠŠèµ‹å€¼å½“ä½œæ‹·è´
âŒ æµ…æ‹·è´æ—¶å¿½ç•¥åµŒå¥—å¯¹è±¡å…±äº«
âŒ ä¸å¿…è¦çš„æ·±æ‹·è´å¯¼è‡´æ€§èƒ½é—®é¢˜
âŒ å¿½ç•¥ç‰¹æ®Šå¯¹è±¡ï¼ˆæ–‡ä»¶ã€é”ï¼‰çš„æ‹·è´é™åˆ¶
```

### 10.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ å®è·µå»ºè®®**ï¼š

1. **æ•°æ®å¤‡ä»½**ï¼šæ ¹æ®æ•°æ®å¤æ‚åº¦é€‰æ‹©æ‹·è´æ·±åº¦
2. **å‡½æ•°å‚æ•°**ï¼šæ˜ç¡®æ˜¯å¦éœ€è¦ä¿æŠ¤åŸæ•°æ®
3. **é…ç½®ç®¡ç†**ï¼šä½¿ç”¨æ·±æ‹·è´åˆ›å»ºç¯å¢ƒé…ç½®
4. **ç¼“å­˜ç³»ç»Ÿ**ï¼šè€ƒè™‘æ‹·è´å¯¹æ€§èƒ½çš„å½±å“
5. **è‡ªå®šä¹‰ç±»**ï¼šå®ç°åˆé€‚çš„æ‹·è´æ–¹æ³•

**ğŸ”§ æ€§èƒ½ä¼˜åŒ–**ï¼š
- ä¼˜å…ˆä½¿ç”¨æµ…æ‹·è´ï¼Œå¿…è¦æ—¶æ‰ç”¨æ·±æ‹·è´
- å¯¹äºä¸å¯å˜å¯¹è±¡ï¼ŒPython ä¼šè‡ªåŠ¨ä¼˜åŒ–
- é¿å…åœ¨å¾ªç¯ä¸­è¿›è¡Œä¸å¿…è¦çš„æ‹·è´
- è€ƒè™‘é‡æ„è®¾è®¡å‡å°‘æ‹·è´éœ€æ±‚

**âš ï¸ æ³¨æ„äº‹é¡¹**ï¼š
- å¾ªç¯å¼•ç”¨ï¼šä½¿ç”¨ Python å†…ç½®çš„ copy æ¨¡å—
- ç‰¹æ®Šå¯¹è±¡ï¼šè‡ªå®šä¹‰æ‹·è´è¡Œä¸º
- å†…å­˜ç®¡ç†ï¼šå¤§å¯¹è±¡æ‹·è´è¦è€ƒè™‘å†…å­˜ä½¿ç”¨
- çº¿ç¨‹å®‰å…¨ï¼šæ‹·è´å…±äº«å¯¹è±¡æ—¶è€ƒè™‘å¹¶å‘é—®é¢˜

### 10.4 å­¦ä¹ æ£€æŸ¥æ¸…å•


- [x] ç†è§£ä¸‰ç§æ‹·è´æ–¹å¼çš„åŒºåˆ«å’Œé€‚ç”¨åœºæ™¯
- [x] èƒ½å¤Ÿè¯†åˆ«ä½•æ—¶ä½¿ç”¨å“ªç§æ‹·è´æ–¹å¼
- [x] æŒæ¡ copy æ¨¡å—çš„åŸºæœ¬ä½¿ç”¨
- [x] äº†è§£è‡ªå®šä¹‰æ‹·è´è¡Œä¸ºçš„å®ç°
- [x] ç†è§£æ‹·è´çš„æ€§èƒ½å½±å“å’Œä¼˜åŒ–ç­–ç•¥
- [x] çŸ¥é“å¸¸è§æ‹·è´é™·é˜±å’Œé¿å…æ–¹æ³•

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
èµ‹å€¼åªæ˜¯è´´æ ‡ç­¾ï¼Œæµ…æ‹·è´æ–°ç›’è£…æ—§è´§
æ·±æ‹·è´é€’å½’å…¨å¤åˆ¶ï¼ŒæŒ‰éœ€é€‰æ‹©è«æµªè´¹
å¾ªç¯å¼•ç”¨äº¤ç»™ Pythonï¼Œç‰¹æ®Šå¯¹è±¡è¦è‡ªå®šä¹‰
æ€§èƒ½ä¼˜åŒ–å¾ˆé‡è¦ï¼Œé¿å…é™·é˜±è¦è®°ç‰¢
```