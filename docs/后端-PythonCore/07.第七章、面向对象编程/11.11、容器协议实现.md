---
title: 11ã€å®¹å™¨åè®®å®ç°
---
## ğŸ“š ç›®å½•

1. [å®¹å™¨åè®®åŸºç¡€æ¦‚å¿µ](#1-å®¹å™¨åè®®åŸºç¡€æ¦‚å¿µ)
2. [ç´¢å¼•è®¿é—®åè®®](#2-ç´¢å¼•è®¿é—®åè®®)
3. [æˆå‘˜æµ‹è¯•ä¸é•¿åº¦åè®®](#3-æˆå‘˜æµ‹è¯•ä¸é•¿åº¦åè®®)
4. [è¿­ä»£åè®®å®ç°](#4-è¿­ä»£åè®®å®ç°)
5. [åºåˆ—åè®®å®Œæ•´å®ç°](#5-åºåˆ—åè®®å®Œæ•´å®ç°)
6. [æ˜ å°„åè®®å®Œæ•´å®ç°](#6-æ˜ å°„åè®®å®Œæ•´å®ç°)
7. [åè®®ç»„åˆä¸æœ€ä½³å®è·µ](#7-åè®®ç»„åˆä¸æœ€ä½³å®è·µ)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ å®¹å™¨åè®®åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯å®¹å™¨åè®®


**ç®€å•ç†è§£**ï¼šå®¹å™¨åè®®å°±æ˜¯è®©ä½ è‡ªå·±å†™çš„ç±»èƒ½å¤Ÿåƒåˆ—è¡¨ã€å­—å…¸ä¸€æ ·ä½¿ç”¨çš„"è§„åˆ™"ã€‚

```
æƒ³è±¡ä¸€ä¸‹ï¼š
- åˆ—è¡¨å¯ä»¥ç”¨ my_list[0] è®¿é—®å…ƒç´ 
- å­—å…¸å¯ä»¥ç”¨ my_dict['key'] è·å–å€¼
- éƒ½å¯ä»¥ç”¨ len() è·å–é•¿åº¦
- éƒ½å¯ä»¥ç”¨ for å¾ªç¯éå†

å®¹å™¨åè®®å°±æ˜¯å‘Šè¯‰Pythonï¼š"æˆ‘çš„ç±»ä¹Ÿæƒ³è¿™æ ·ç”¨ï¼"
```

> ğŸ’¡ **æ ¸å¿ƒæ¦‚å¿µ**ï¼šå®¹å™¨åè®®æ˜¯Pythonä¸­ä¸€ç»„ç‰¹æ®Šæ–¹æ³•ï¼Œè®©è‡ªå®šä¹‰ç±»èƒ½å¤Ÿæ¨¡æ‹Ÿå†…ç½®å®¹å™¨ç±»å‹çš„è¡Œä¸º

### 1.2 å¸¸ç”¨å®¹å™¨åè®®ä¸€è§ˆ


| åè®®æ–¹æ³• | **ä½œç”¨** | **è§¦å‘æ–¹å¼** | **è¿”å›å€¼** |
|---------|---------|-------------|-----------|
| `__getitem__` | ğŸ” è·å–å…ƒç´  | `obj[key]` | å¯¹åº”çš„å€¼ |
| `__setitem__` | âœï¸ è®¾ç½®å…ƒç´  | `obj[key] = value` | None |
| `__delitem__` | ğŸ—‘ï¸ åˆ é™¤å…ƒç´  | `del obj[key]` | None |
| `__contains__` | ğŸ” æˆå‘˜æµ‹è¯• | `key in obj` | True/False |
| `__iter__` | ğŸ”„ è¿­ä»£æ”¯æŒ | `for x in obj` | è¿­ä»£å™¨å¯¹è±¡ |
| `__len__` | ğŸ“ è·å–é•¿åº¦ | `len(obj)` | æ•´æ•° |

### 1.3 ä¸ºä»€ä¹ˆè¦å®ç°å®¹å™¨åè®®


**å®é™…åº”ç”¨åœºæ™¯**ï¼š
- âœ… **è‡ªå®šä¹‰æ•°æ®ç»“æ„**ï¼šå®ç°ç‰¹æ®Šçš„åˆ—è¡¨ã€å­—å…¸
- âœ… **APIåŒ…è£…**ï¼šæŠŠå¤æ‚çš„æ•°æ®åŒ…è£…æˆç®€å•çš„å®¹å™¨æ¥å£
- âœ… **æ•°æ®æ¨¡å‹**ï¼šè®©ä¸šåŠ¡å¯¹è±¡æ”¯æŒæ ‡å‡†æ“ä½œ
- âœ… **æ¡†æ¶å¼€å‘**ï¼šåˆ›å»ºå¯è¿­ä»£çš„é…ç½®ã€è®¾ç½®å¯¹è±¡

---

## 2. ğŸ”‘ ç´¢å¼•è®¿é—®åè®®


### 2.1 __getitem__ ç´¢å¼•è·å–


**ä½œç”¨**ï¼šå½“ä½¿ç”¨ `obj[key]` æ—¶è¢«è°ƒç”¨

```python
class SimpleList:
    def __init__(self):
        self._items = []
    
    def __getitem__(self, index):
        """è·å–æŒ‡å®šç´¢å¼•çš„å…ƒç´ """
        print(f"æ­£åœ¨è·å–ç´¢å¼• {index} çš„å…ƒç´ ")
        return self._items[index]
    
    def append(self, item):
        self._items.append(item)

# ä½¿ç”¨ç¤ºä¾‹
my_list = SimpleList()
my_list.append("è‹¹æœ")
my_list.append("é¦™è•‰")

print(my_list[0])  # è¾“å‡ºï¼šæ­£åœ¨è·å–ç´¢å¼• 0 çš„å…ƒç´  \n è‹¹æœ
print(my_list[1])  # è¾“å‡ºï¼šæ­£åœ¨è·å–ç´¢å¼• 1 çš„å…ƒç´  \n é¦™è•‰
```

> ğŸ’¡ **ç†è§£è¦ç‚¹**ï¼š`__getitem__` å°±åƒæ˜¯ä¸€ä¸ª"å–ä¸œè¥¿"çš„æ–¹æ³•ï¼Œå‘Šè¯‰Pythonå½“æœ‰äººç”¨æ–¹æ‹¬å·å–å€¼æ—¶è¯¥æ€ä¹ˆåŠ

### 2.2 __setitem__ ç´¢å¼•èµ‹å€¼


**ä½œç”¨**ï¼šå½“ä½¿ç”¨ `obj[key] = value` æ—¶è¢«è°ƒç”¨

```python
class SimpleList:
    def __init__(self):
        self._items = []
    
    def __getitem__(self, index):
        return self._items[index]
    
    def __setitem__(self, index, value):
        """è®¾ç½®æŒ‡å®šç´¢å¼•çš„å…ƒç´ """
        print(f"æ­£åœ¨è®¾ç½®ç´¢å¼• {index} ä¸º {value}")
        # å¦‚æœç´¢å¼•è¶…å‡ºèŒƒå›´ï¼Œæ‰©å±•åˆ—è¡¨
        while len(self._items) <= index:
            self._items.append(None)
        self._items[index] = value

# ä½¿ç”¨ç¤ºä¾‹
my_list = SimpleList()
my_list[0] = "ç¬¬ä¸€ä¸ª"    # è¾“å‡ºï¼šæ­£åœ¨è®¾ç½®ç´¢å¼• 0 ä¸º ç¬¬ä¸€ä¸ª
my_list[2] = "ç¬¬ä¸‰ä¸ª"    # è¾“å‡ºï¼šæ­£åœ¨è®¾ç½®ç´¢å¼• 2 ä¸º ç¬¬ä¸‰ä¸ª

print(my_list[0])  # ç¬¬ä¸€ä¸ª
print(my_list[1])  # Noneï¼ˆè‡ªåŠ¨å¡«å……çš„ï¼‰
print(my_list[2])  # ç¬¬ä¸‰ä¸ª
```

### 2.3 __delitem__ ç´¢å¼•åˆ é™¤


**ä½œç”¨**ï¼šå½“ä½¿ç”¨ `del obj[key]` æ—¶è¢«è°ƒç”¨

```python
class SimpleList:
    def __init__(self):
        self._items = []
    
    def __getitem__(self, index):
        return self._items[index]
    
    def __setitem__(self, index, value):
        while len(self._items) <= index:
            self._items.append(None)
        self._items[index] = value
    
    def __delitem__(self, index):
        """åˆ é™¤æŒ‡å®šç´¢å¼•çš„å…ƒç´ """
        print(f"æ­£åœ¨åˆ é™¤ç´¢å¼• {index} çš„å…ƒç´ ")
        del self._items[index]

# ä½¿ç”¨ç¤ºä¾‹
my_list = SimpleList()
my_list[0] = "è¦åˆ é™¤çš„"
my_list[1] = "ä¿ç•™çš„"

del my_list[0]  # è¾“å‡ºï¼šæ­£åœ¨åˆ é™¤ç´¢å¼• 0 çš„å…ƒç´ 
print(my_list[0])  # ç°åœ¨è¾“å‡ºï¼šä¿ç•™çš„ï¼ˆåŸæ¥çš„ç´¢å¼•1å˜æˆäº†ç´¢å¼•0ï¼‰
```

### 2.4 æ”¯æŒåˆ‡ç‰‡æ“ä½œ


```python
class SmartList:
    def __init__(self):
        self._items = []
    
    def __getitem__(self, key):
        """æ”¯æŒç´¢å¼•å’Œåˆ‡ç‰‡"""
        if isinstance(key, slice):
            print(f"æ­£åœ¨åˆ‡ç‰‡ï¼š{key}")
            return self._items[key]
        else:
            print(f"æ­£åœ¨è·å–ç´¢å¼•ï¼š{key}")
            return self._items[key]
    
    def append(self, item):
        self._items.append(item)

# ä½¿ç”¨ç¤ºä¾‹
smart_list = SmartList()
for i in range(5):
    smart_list.append(f"å…ƒç´ {i}")

print(smart_list[1:3])    # åˆ‡ç‰‡æ“ä½œ
print(smart_list[2])      # ç´¢å¼•æ“ä½œ
```

---

## 3. ğŸ” æˆå‘˜æµ‹è¯•ä¸é•¿åº¦åè®®


### 3.1 __contains__ æˆå‘˜æµ‹è¯•


**ä½œç”¨**ï¼šå½“ä½¿ç”¨ `item in obj` æ—¶è¢«è°ƒç”¨

```python
class FruitBasket:
    def __init__(self):
        self.fruits = []
    
    def add_fruit(self, fruit):
        self.fruits.append(fruit)
    
    def __contains__(self, fruit):
        """æ£€æŸ¥æ°´æœæ˜¯å¦åœ¨ç¯®å­é‡Œ"""
        print(f"æ£€æŸ¥ {fruit} æ˜¯å¦åœ¨ç¯®å­é‡Œ...")
        return fruit in self.fruits
    
    def __len__(self):
        """è¿”å›ç¯®å­é‡Œæ°´æœçš„æ•°é‡"""
        return len(self.fruits)

# ä½¿ç”¨ç¤ºä¾‹
basket = FruitBasket()
basket.add_fruit("è‹¹æœ")
basket.add_fruit("é¦™è•‰")

print("è‹¹æœ" in basket)    # Trueï¼Œè¾“å‡ºï¼šæ£€æŸ¥ è‹¹æœ æ˜¯å¦åœ¨ç¯®å­é‡Œ...
print("æ©™å­" in basket)    # Falseï¼Œè¾“å‡ºï¼šæ£€æŸ¥ æ©™å­ æ˜¯å¦åœ¨ç¯®å­é‡Œ...
print(len(basket))        # 2
```

> âš ï¸ **æ³¨æ„**ï¼šå¦‚æœæ²¡æœ‰å®ç° `__contains__`ï¼ŒPythonä¼šè‡ªåŠ¨å°è¯•ç”¨ `__iter__` æˆ– `__getitem__` æ¥å®ç°æˆå‘˜æµ‹è¯•

### 3.2 __len__ é•¿åº¦åè®®


**ä½œç”¨**ï¼šå½“ä½¿ç”¨ `len(obj)` æ—¶è¢«è°ƒç”¨

```python
class WordCounter:
    def __init__(self):
        self._words = {}
    
    def add_word(self, word):
        """æ·»åŠ å•è¯"""
        self._words[word] = self._words.get(word, 0) + 1
    
    def __len__(self):
        """è¿”å›ä¸åŒå•è¯çš„æ•°é‡"""
        return len(self._words)
    
    def __contains__(self, word):
        """æ£€æŸ¥å•è¯æ˜¯å¦å­˜åœ¨"""
        return word in self._words

# ä½¿ç”¨ç¤ºä¾‹
counter = WordCounter()
counter.add_word("hello")
counter.add_word("world")
counter.add_word("hello")  # é‡å¤æ·»åŠ 

print(len(counter))           # 2ï¼ˆä¸¤ä¸ªä¸åŒçš„å•è¯ï¼‰
print("hello" in counter)     # True
print("python" in counter)    # False
```

---

## 4. ğŸ”„ è¿­ä»£åè®®å®ç°


### 4.1 __iter__ è¿­ä»£å™¨åè®®


**ä½œç”¨**ï¼šè®©å¯¹è±¡æ”¯æŒ `for` å¾ªç¯å’Œå…¶ä»–è¿­ä»£æ“ä½œ

```python
class NumberSequence:
    def __init__(self, start, end):
        self.start = start
        self.end = end
    
    def __iter__(self):
        """è¿”å›è¿­ä»£å™¨å¯¹è±¡"""
        print("å¼€å§‹è¿­ä»£...")
        return NumberIterator(self.start, self.end)
    
    def __len__(self):
        return self.end - self.start

class NumberIterator:
    def __init__(self, start, end):
        self.current = start
        self.end = end
    
    def __iter__(self):
        return self
    
    def __next__(self):
        if self.current < self.end:
            value = self.current
            self.current += 1
            return value
        else:
            raise StopIteration

# ä½¿ç”¨ç¤ºä¾‹
sequence = NumberSequence(1, 5)
print(f"åºåˆ—é•¿åº¦ï¼š{len(sequence)}")

for num in sequence:
    print(f"å½“å‰æ•°å­—ï¼š{num}")
# è¾“å‡ºï¼šå¼€å§‹è¿­ä»£...
# å½“å‰æ•°å­—ï¼š1
# å½“å‰æ•°å­—ï¼š2
# å½“å‰æ•°å­—ï¼š3
# å½“å‰æ•°å­—ï¼š4
```

### 4.2 ç®€åŒ–çš„è¿­ä»£å™¨å®ç°


```python
class SimpleRange:
    def __init__(self, start, end):
        self.start = start
        self.end = end
    
    def __iter__(self):
        """ç›´æ¥è¿”å›ç”Ÿæˆå™¨"""
        current = self.start
        while current < self.end:
            yield current
            current += 1
    
    def __len__(self):
        return max(0, self.end - self.start)

# ä½¿ç”¨ç¤ºä¾‹
my_range = SimpleRange(5, 8)
print(list(my_range))  # [5, 6, 7]

# å¯ä»¥å¤šæ¬¡è¿­ä»£
for x in my_range:
    print(f"ç¬¬ä¸€æ¬¡è¿­ä»£ï¼š{x}")

for x in my_range:
    print(f"ç¬¬äºŒæ¬¡è¿­ä»£ï¼š{x}")
```

> ğŸ’¡ **ç”Ÿæˆå™¨ vs è¿­ä»£å™¨ç±»**ï¼šä½¿ç”¨ç”Ÿæˆå™¨ï¼ˆyieldï¼‰æ¯”åˆ›å»ºä¸“é—¨çš„è¿­ä»£å™¨ç±»æ›´ç®€æ´ï¼Œæ¨èåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä½¿ç”¨

---

## 5. ğŸ“‹ åºåˆ—åè®®å®Œæ•´å®ç°


### 5.1 å®Œæ•´çš„è‡ªå®šä¹‰åˆ—è¡¨


```python
class MyList:
    """å®ç°å®Œæ•´åºåˆ—åè®®çš„è‡ªå®šä¹‰åˆ—è¡¨"""
    
    def __init__(self, items=None):
        self._items = list(items) if items else []
    
    def __getitem__(self, key):
        """æ”¯æŒç´¢å¼•å’Œåˆ‡ç‰‡è®¿é—®"""
        if isinstance(key, slice):
            return MyList(self._items[key])  # è¿”å›åŒç±»å‹å¯¹è±¡
        return self._items[key]
    
    def __setitem__(self, key, value):
        """æ”¯æŒç´¢å¼•èµ‹å€¼"""
        if isinstance(key, slice):
            self._items[key] = value
        else:
            self._items[key] = value
    
    def __delitem__(self, key):
        """æ”¯æŒåˆ é™¤"""
        del self._items[key]
    
    def __len__(self):
        """è¿”å›é•¿åº¦"""
        return len(self._items)
    
    def __contains__(self, item):
        """æˆå‘˜æµ‹è¯•"""
        return item in self._items
    
    def __iter__(self):
        """è¿­ä»£æ”¯æŒ"""
        return iter(self._items)
    
    def append(self, item):
        """æ·»åŠ å…ƒç´ """
        self._items.append(item)
    
    def __repr__(self):
        """å­—ç¬¦ä¸²è¡¨ç¤º"""
        return f"MyList({self._items})"

# ä½¿ç”¨ç¤ºä¾‹æ¼”ç¤º
my_list = MyList([1, 2, 3, 4, 5])

# ç´¢å¼•è®¿é—®
print(my_list[0])        # 1
print(my_list[1:3])      # MyList([2, 3])

# ä¿®æ”¹å…ƒç´ 
my_list[0] = "ç¬¬ä¸€ä¸ª"
print(my_list)           # MyList(['ç¬¬ä¸€ä¸ª', 2, 3, 4, 5])

# æˆå‘˜æµ‹è¯•
print(2 in my_list)      # True

# è¿­ä»£
for item in my_list:
    print(f"å…ƒç´ ï¼š{item}")

# é•¿åº¦
print(f"é•¿åº¦ï¼š{len(my_list)}")  # 5
```

### 5.2 åºåˆ—åè®®çš„æœ€å°å®ç°


```python
class MinimalSequence:
    """åºåˆ—åè®®çš„æœ€å°å®ç°"""
    
    def __init__(self, data):
        self._data = list(data)
    
    def __getitem__(self, index):
        """åªå®ç°è¿™ä¸€ä¸ªæ–¹æ³•ï¼ŒPythonä¼šè‡ªåŠ¨æ”¯æŒå¾ˆå¤šæ“ä½œ"""
        return self._data[index]
    
    def __len__(self):
        return len(self._data)

# ä½¿ç”¨ç¤ºä¾‹
seq = MinimalSequence("hello")

# è‡ªåŠ¨æ”¯æŒçš„æ“ä½œ
print(seq[0])           # h
print(len(seq))         # 5
print('e' in seq)       # Trueï¼ˆè‡ªåŠ¨å®ç°ï¼‰
print(list(seq))        # ['h', 'e', 'l', 'l', 'o']ï¼ˆè‡ªåŠ¨æ”¯æŒè¿­ä»£ï¼‰

for char in seq:        # è‡ªåŠ¨æ”¯æŒè¿­ä»£
    print(char)
```

> ğŸ’¡ **ç¥å¥‡ä¹‹å¤„**ï¼šåªè¦å®ç°äº† `__getitem__` å’Œ `__len__`ï¼ŒPythonå°±ä¼šè‡ªåŠ¨è®©ä½ çš„ç±»æ”¯æŒè¿­ä»£ã€æˆå‘˜æµ‹è¯•ç­‰æ“ä½œï¼

---

## 6. ğŸ—ï¸ æ˜ å°„åè®®å®Œæ•´å®ç°


### 6.1 è‡ªå®šä¹‰å­—å…¸ç±»


```python
class MyDict:
    """å®ç°æ˜ å°„åè®®çš„è‡ªå®šä¹‰å­—å…¸"""
    
    def __init__(self):
        self._data = {}
    
    def __getitem__(self, key):
        """è·å–å€¼ï¼Œå¦‚æœé”®ä¸å­˜åœ¨åˆ™æŠ›å‡ºKeyError"""
        if key not in self._data:
            raise KeyError(f"é”® '{key}' ä¸å­˜åœ¨")
        return self._data[key]
    
    def __setitem__(self, key, value):
        """è®¾ç½®é”®å€¼å¯¹"""
        print(f"è®¾ç½® {key} = {value}")
        self._data[key] = value
    
    def __delitem__(self, key):
        """åˆ é™¤é”®å€¼å¯¹"""
        if key not in self._data:
            raise KeyError(f"é”® '{key}' ä¸å­˜åœ¨")
        print(f"åˆ é™¤é”® '{key}'")
        del self._data[key]
    
    def __contains__(self, key):
        """æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨"""
        return key in self._data
    
    def __len__(self):
        """è¿”å›é”®å€¼å¯¹æ•°é‡"""
        return len(self._data)
    
    def __iter__(self):
        """è¿­ä»£æ‰€æœ‰çš„é”®"""
        return iter(self._data)
    
    def keys(self):
        """è¿”å›æ‰€æœ‰é”®"""
        return self._data.keys()
    
    def values(self):
        """è¿”å›æ‰€æœ‰å€¼"""
        return self._data.values()
    
    def items(self):
        """è¿”å›æ‰€æœ‰é”®å€¼å¯¹"""
        return self._data.items()
    
    def __repr__(self):
        return f"MyDict({dict(self._data)})"

# ä½¿ç”¨ç¤ºä¾‹
my_dict = MyDict()

# è®¾ç½®å€¼
my_dict['name'] = 'å¼ ä¸‰'      # è¾“å‡ºï¼šè®¾ç½® name = å¼ ä¸‰
my_dict['age'] = 25          # è¾“å‡ºï¼šè®¾ç½® age = 25

# è·å–å€¼
print(my_dict['name'])       # å¼ ä¸‰

# æˆå‘˜æµ‹è¯•
print('name' in my_dict)     # True

# è¿­ä»£é”®
for key in my_dict:
    print(f"{key}: {my_dict[key]}")

# åˆ é™¤
del my_dict['age']           # è¾“å‡ºï¼šåˆ é™¤é”® 'age'
```

### 6.2 å¸¦é»˜è®¤å€¼çš„æ˜ å°„


```python
class DefaultDict:
    """å¸¦é»˜è®¤å€¼çš„å­—å…¸"""
    
    def __init__(self, default_factory=None):
        self._data = {}
        self._default_factory = default_factory
    
    def __getitem__(self, key):
        if key not in self._data:
            if self._default_factory is None:
                raise KeyError(key)
            # åˆ›å»ºé»˜è®¤å€¼
            self._data[key] = self._default_factory()
        return self._data[key]
    
    def __setitem__(self, key, value):
        self._data[key] = value
    
    def __contains__(self, key):
        return key in self._data
    
    def __len__(self):
        return len(self._data)
    
    def __repr__(self):
        return f"DefaultDict({dict(self._data)})"

# ä½¿ç”¨ç¤ºä¾‹
# åˆ›å»ºé»˜è®¤å€¼ä¸ºç©ºåˆ—è¡¨çš„å­—å…¸
dd = DefaultDict(list)

# å³ä½¿é”®ä¸å­˜åœ¨ï¼Œä¹Ÿä¼šè‡ªåŠ¨åˆ›å»ºç©ºåˆ—è¡¨
dd['fruits'].append('è‹¹æœ')
dd['fruits'].append('é¦™è•‰')
dd['colors'].append('çº¢è‰²')

print(dd)  # DefaultDict({'fruits': ['è‹¹æœ', 'é¦™è•‰'], 'colors': ['çº¢è‰²']})
```

---

## 7. ğŸ¨ åè®®ç»„åˆä¸æœ€ä½³å®è·µ


### 7.1 åè®®ç»„åˆç¤ºä¾‹


```python
class SmartContainer:
    """ç»„åˆå¤šç§åè®®çš„æ™ºèƒ½å®¹å™¨"""
    
    def __init__(self):
        self._items = []
        self._access_count = {}  # è®°å½•è®¿é—®æ¬¡æ•°
    
    def __getitem__(self, index):
        """è·å–å…ƒç´ å¹¶è®°å½•è®¿é—®æ¬¡æ•°"""
        self._access_count[index] = self._access_count.get(index, 0) + 1
        return self._items[index]
    
    def __setitem__(self, index, value):
        """è®¾ç½®å…ƒç´ """
        while len(self._items) <= index:
            self._items.append(None)
        self._items[index] = value
    
    def __len__(self):
        return len(self._items)
    
    def __contains__(self, item):
        return item in self._items
    
    def __iter__(self):
        return iter(self._items)
    
    def get_access_count(self, index):
        """è·å–æŒ‡å®šç´¢å¼•çš„è®¿é—®æ¬¡æ•°"""
        return self._access_count.get(index, 0)
    
    def most_accessed(self):
        """è¿”å›è®¿é—®æ¬¡æ•°æœ€å¤šçš„ç´¢å¼•"""
        if not self._access_count:
            return None
        return max(self._access_count, key=self._access_count.get)

# ä½¿ç”¨ç¤ºä¾‹
container = SmartContainer()
container[0] = "ç¬¬ä¸€ä¸ªå…ƒç´ "
container[1] = "ç¬¬äºŒä¸ªå…ƒç´ "
container[2] = "ç¬¬ä¸‰ä¸ªå…ƒç´ "

# å¤šæ¬¡è®¿é—®ä¸åŒå…ƒç´ 
print(container[0])  # è®¿é—®ç´¢å¼•0
print(container[1])  # è®¿é—®ç´¢å¼•1
print(container[0])  # å†æ¬¡è®¿é—®ç´¢å¼•0

print(f"ç´¢å¼•0è¢«è®¿é—®äº† {container.get_access_count(0)} æ¬¡")  # 2æ¬¡
print(f"æœ€å¸¸è®¿é—®çš„ç´¢å¼•ï¼š{container.most_accessed()}")        # 0
```

### 7.2 é”™è¯¯å¤„ç†æœ€ä½³å®è·µ


```python
class SafeList:
    """å¸¦æœ‰å®Œå–„é”™è¯¯å¤„ç†çš„åˆ—è¡¨"""
    
    def __init__(self, items=None):
        self._items = list(items) if items else []
    
    def __getitem__(self, index):
        try:
            return self._items[index]
        except IndexError:
            raise IndexError(f"ç´¢å¼• {index} è¶…å‡ºèŒƒå›´ [0, {len(self._items)-1}]")
    
    def __setitem__(self, index, value):
        if index < 0:
            # æ”¯æŒè´Ÿç´¢å¼•
            index = len(self._items) + index
        
        if index < 0 or index >= len(self._items):
            raise IndexError(f"ç´¢å¼• {index} è¶…å‡ºèŒƒå›´")
        
        self._items[index] = value
    
    def __len__(self):
        return len(self._items)
    
    def append(self, item):
        self._items.append(item)
    
    def __repr__(self):
        return f"SafeList({self._items})"

# ä½¿ç”¨ç¤ºä¾‹
safe_list = SafeList([1, 2, 3])

try:
    print(safe_list[10])  # ä¼šæŠ›å‡ºå‹å¥½çš„é”™è¯¯ä¿¡æ¯
except IndexError as e:
    print(f"é”™è¯¯ï¼š{e}")

# æ­£å¸¸ä½¿ç”¨
safe_list[-1] = "æœ€åä¸€ä¸ª"  # æ”¯æŒè´Ÿç´¢å¼•
print(safe_list)
```

### 7.3 æ€§èƒ½ä¼˜åŒ–æŠ€å·§


| ä¼˜åŒ–æŠ€å·§ | **è¯´æ˜** | **é€‚ç”¨åœºæ™¯** |
|---------|---------|-------------|
| **æ‡’åŠ è½½** | åªåœ¨éœ€è¦æ—¶æ‰åˆ›å»ºæ•°æ® | å¤§æ•°æ®é›†ã€å¤æ‚è®¡ç®— |
| **ç¼“å­˜ç»“æœ** | ç¼“å­˜è®¡ç®—ç»“æœé¿å…é‡å¤è®¡ç®— | é¢‘ç¹è®¿é—®ç›¸åŒæ•°æ® |
| **æ‰¹é‡æ“ä½œ** | ä¸€æ¬¡å¤„ç†å¤šä¸ªå…ƒç´  | å¤§é‡ä¿®æ”¹æ“ä½œ |
| **ç±»å‹æ£€æŸ¥** | åœ¨æ–¹æ³•å¼€å§‹æ—¶æ£€æŸ¥å‚æ•°ç±»å‹ | æé«˜ä»£ç å¥å£®æ€§ |

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å®¹å™¨åè®®æœ¬è´¨ï¼šè®©è‡ªå®šä¹‰ç±»æ¨¡æ‹Ÿå†…ç½®å®¹å™¨è¡Œä¸ºçš„ç‰¹æ®Šæ–¹æ³•
ğŸ”¸ æ ¸å¿ƒæ–¹æ³•ï¼š__getitem__, __setitem__, __delitem__, __contains__, __iter__, __len__
ğŸ”¸ æœ€å°å®ç°ï¼šåªéœ€ __getitem__ å’Œ __len__ å°±èƒ½è·å¾—å¾ˆå¤šåŠŸèƒ½
ğŸ”¸ åè®®ç»„åˆï¼šå¯ä»¥åŒæ—¶å®ç°å¤šä¸ªåè®®ï¼Œåˆ›å»ºåŠŸèƒ½ä¸°å¯Œçš„å®¹å™¨
ğŸ”¸ é”™è¯¯å¤„ç†ï¼šæä¾›å‹å¥½çš„é”™è¯¯ä¿¡æ¯ï¼Œæé«˜ç”¨æˆ·ä½“éªŒ
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆå«"åè®®"è€Œä¸æ˜¯"æ¥å£"**
```
Pythonçš„é¸­å­ç±»å‹å“²å­¦ï¼š
- ä¸éœ€è¦æ˜¾å¼å£°æ˜å®ç°æŸä¸ªæ¥å£
- åªè¦å®ç°äº†ç›¸åº”çš„æ–¹æ³•ï¼Œå°±å…·å¤‡äº†ç›¸åº”çš„èƒ½åŠ›
- "å¦‚æœå®ƒèµ°èµ·æ¥åƒé¸­å­ï¼Œå«èµ·æ¥åƒé¸­å­ï¼Œé‚£å®ƒå°±æ˜¯é¸­å­"
```

**ğŸ”¹ ä»€ä¹ˆæ—¶å€™éœ€è¦å®ç°å®¹å™¨åè®®**
```
é€‚ç”¨åœºæ™¯ï¼š
âœ… åˆ›å»ºè‡ªå®šä¹‰æ•°æ®ç»“æ„ï¼ˆæ ˆã€é˜Ÿåˆ—ã€æ ‘ç­‰ï¼‰
âœ… åŒ…è£…ç°æœ‰æ•°æ®ï¼Œæä¾›ç‰¹æ®Šè®¿é—®æ–¹å¼
âœ… å®ç°é¢†åŸŸç‰¹å®šçš„å®¹å™¨ï¼ˆå¦‚å­¦ç”Ÿåå†Œã€å•†å“åº“å­˜ï¼‰
âœ… ä¸ºæ¡†æ¶æˆ–åº“æä¾›ç»Ÿä¸€çš„å®¹å™¨æ¥å£

ä¸é€‚ç”¨åœºæ™¯ï¼š
âŒ ç®€å•çš„æ•°æ®å­˜å‚¨ï¼ˆç›´æ¥ç”¨listã€dictæ›´å¥½ï¼‰
âŒ ä¸éœ€è¦å®¹å™¨è¯­ä¹‰çš„ç±»
âŒ æ€§èƒ½è¦æ±‚æé«˜çš„åœºæ™¯ï¼ˆå†…ç½®ç±»å‹æ›´å¿«ï¼‰
```

**ğŸ”¹ å®ç°é¡ºåºå»ºè®®**
```
æ¨èå®ç°é¡ºåºï¼š
1. __len__ å’Œ __getitem__ï¼ˆåŸºç¡€åŠŸèƒ½ï¼‰
2. __iter__ï¼ˆè¿­ä»£æ”¯æŒï¼‰
3. __contains__ï¼ˆæˆå‘˜æµ‹è¯•ï¼‰
4. __setitem__ å’Œ __delitem__ï¼ˆä¿®æ”¹åŠŸèƒ½ï¼‰
5. å…¶ä»–è¾…åŠ©æ–¹æ³•ï¼ˆkeys, values, itemsç­‰ï¼‰
```

### 8.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ æ•™å­¦æ„ä¹‰**
- **ç†è§£Pythoné­”æ³•**ï¼šæ­ç¤ºå†…ç½®ç±»å‹å·¥ä½œåŸç†
- **é¢å‘å¯¹è±¡æ€ç»´**ï¼šå­¦ä¼šè®¾è®¡ç¬¦åˆPythonä¹ æƒ¯çš„ç±»
- **åè®®æ€æƒ³**ï¼šç†è§£æ¥å£è®¾è®¡çš„é‡è¦æ€§

**ğŸ”§ å®ç”¨ä»·å€¼**
- **æ¡†æ¶å¼€å‘**ï¼šåˆ›å»ºå¯è¿­ä»£çš„é…ç½®å¯¹è±¡
- **æ•°æ®å¤„ç†**ï¼šåŒ…è£…å¤æ‚æ•°æ®ç»“æ„
- **APIè®¾è®¡**ï¼šæä¾›ç»Ÿä¸€çš„è®¿é—®æ¥å£

**ğŸš€ è¿›é˜¶æ–¹å‘**
- **ä¸Šä¸‹æ–‡ç®¡ç†å™¨**ï¼š`__enter__` å’Œ `__exit__`
- **æ•°å€¼åè®®**ï¼š`__add__`, `__mul__` ç­‰è¿ç®—ç¬¦é‡è½½
- **æè¿°ç¬¦åè®®**ï¼š`__get__`, `__set__`, `__delete__`

### 8.4 å¸¸è§é™·é˜±ä¸æ³¨æ„äº‹é¡¹


```
âš ï¸ å¸¸è§é”™è¯¯ï¼š
1. å¿˜è®°å®ç° __len__ï¼Œå¯¼è‡´æŸäº›æ“ä½œå¤±è´¥
2. __iter__ è¿”å›selfè€Œä¸æ˜¯æ–°çš„è¿­ä»£å™¨å¯¹è±¡
3. æ²¡æœ‰å¤„ç†ç´¢å¼•è¶Šç•Œçš„æƒ…å†µ
4. __contains__ å®ç°æ•ˆç‡ä½ä¸‹

ğŸ’¡ æœ€ä½³å®è·µï¼š
1. ä¼˜å…ˆå®ç° __getitem__ å’Œ __len__
2. ä½¿ç”¨ç”Ÿæˆå™¨ç®€åŒ– __iter__ å®ç°
3. æä¾›å‹å¥½çš„é”™è¯¯ä¿¡æ¯
4. è€ƒè™‘æ€§èƒ½å½±å“ï¼Œé¿å…ä¸å¿…è¦çš„è®¡ç®—
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- å®¹å™¨åè®®è®©ä½ çš„ç±»åƒå†…ç½®ç±»å‹ä¸€æ ·å¥½ç”¨
- æœ€å°‘å®ç° `__getitem__` å’Œ `__len__` å°±å¾ˆæœ‰ç”¨
- ç”Ÿæˆå™¨æ˜¯å®ç°è¿­ä»£çš„æœ€ç®€å•æ–¹å¼
- è‰¯å¥½çš„é”™è¯¯å¤„ç†è®©ä»£ç æ›´å¥å£®