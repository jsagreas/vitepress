---
title: 24ã€åŒ…åˆå§‹åŒ–å…³é”®å­—
---
## ğŸ“š ç›®å½•

1. [åŒ…åˆå§‹åŒ–æ¦‚è¿°](#1-åŒ…åˆå§‹åŒ–æ¦‚è¿°)
2. [__init__.py åŒ…åˆå§‹åŒ–æ–‡ä»¶](#2-__init__py-åŒ…åˆå§‹åŒ–æ–‡ä»¶)
3. [__main__.py ä¸»å…¥å£æ–‡ä»¶](#3-__main__py-ä¸»å…¥å£æ–‡ä»¶)
4. [if __name__ == '__main__' ä¸»ç¨‹åºåˆ¤æ–­](#4-if-__name__-__main__-ä¸»ç¨‹åºåˆ¤æ–­)
5. [åŒ…ç®¡ç†æœ€ä½³å®è·µ](#5-åŒ…ç®¡ç†æœ€ä½³å®è·µ)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ“¦ åŒ…åˆå§‹åŒ–æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯PythonåŒ…


**ç®€å•ç†è§£**ï¼šPythonåŒ…å°±åƒä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œé‡Œé¢è£…ç€ç›¸å…³çš„Pythonæ–‡ä»¶ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿæ›´å¥½åœ°ç»„ç»‡ä»£ç ã€‚

```
æˆ‘ä»¬çš„é¡¹ç›®ç»“æ„å°±åƒè¿™æ ·ï¼š
myproject/                 â† é¡¹ç›®æ ¹ç›®å½•
â”œâ”€â”€ main.py                â† ä¸»ç¨‹åºæ–‡ä»¶
â”œâ”€â”€ utils/                 â† å·¥å…·åŒ…ç›®å½•
â”‚   â”œâ”€â”€ __init__.py       â† åŒ…åˆå§‹åŒ–æ–‡ä»¶ï¼ˆé‡è¦ï¼ï¼‰
â”‚   â”œâ”€â”€ math_tools.py     â† æ•°å­¦å·¥å…·æ¨¡å—
â”‚   â””â”€â”€ string_tools.py   â† å­—ç¬¦ä¸²å·¥å…·æ¨¡å—
â””â”€â”€ tests/                 â† æµ‹è¯•åŒ…ç›®å½•
    â”œâ”€â”€ __init__.py
    â””â”€â”€ test_utils.py
```

**åŒ…ä¸æ¨¡å—çš„åŒºåˆ«**ï¼š
- **æ¨¡å—**ï¼šä¸€ä¸ªå•ç‹¬çš„`.py`æ–‡ä»¶ï¼Œæ¯”å¦‚`math_tools.py`
- **åŒ…**ï¼šåŒ…å«å¤šä¸ªæ¨¡å—çš„æ–‡ä»¶å¤¹ï¼Œå¿…é¡»æœ‰`__init__.py`æ–‡ä»¶

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦åŒ…ç®¡ç†


**ç°å®åœºæ™¯ç±»æ¯”**ï¼š
- å°±åƒæˆ‘ä»¬æ•´ç†æˆ¿é—´ï¼ŒæŠŠè¡£æœæ”¾è¡£æŸœï¼ŒæŠŠä¹¦æ”¾ä¹¦æ¶
- åŒ…ç®¡ç†è®©ä»£ç æœ‰æ¡ç†ï¼Œç›¸å…³åŠŸèƒ½æ”¾åœ¨ä¸€èµ·
- é¿å…æ–‡ä»¶åå†²çªï¼Œæé«˜ä»£ç å¤ç”¨æ€§

**åŒ…ç®¡ç†çš„å¥½å¤„**ï¼š
```
âœ… ä»£ç ç»„ç»‡æ¸…æ™°ï¼šç›¸å…³åŠŸèƒ½æ¨¡å—æ”¾ä¸€èµ·
âœ… é¿å…å‘½åå†²çªï¼šä¸åŒåŒ…å¯ä»¥æœ‰åŒåæ¨¡å—
âœ… ä¾¿äºå›¢é˜Ÿåä½œï¼šæ¯äººè´Ÿè´£ä¸åŒçš„åŒ…
âœ… æé«˜ä»£ç å¤ç”¨ï¼šåŒ…å¯ä»¥åœ¨å¤šä¸ªé¡¹ç›®ä¸­ä½¿ç”¨
âœ… ç®€åŒ–å¯¼å…¥ç®¡ç†ï¼šç»Ÿä¸€çš„å¯¼å…¥æ¥å£
```

---

## 2. ğŸ”§ __init__.py åŒ…åˆå§‹åŒ–æ–‡ä»¶


### 2.1 __init__.py çš„ä½œç”¨


**æ ¸å¿ƒä½œç”¨**ï¼šå‘Šè¯‰Pythonè¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯ä¸€ä¸ªåŒ…ï¼Œä¸æ˜¯æ™®é€šæ–‡ä»¶å¤¹ã€‚

```
æ²¡æœ‰ __init__.py çš„æ–‡ä»¶å¤¹ï¼š
utils/
â”œâ”€â”€ math_tools.py
â””â”€â”€ string_tools.py
â†“
Pythonä¸è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªåŒ…ï¼Œæ— æ³•ç›´æ¥å¯¼å…¥

æœ‰ __init__.py çš„æ–‡ä»¶å¤¹ï¼š
utils/
â”œâ”€â”€ __init__.py      â† è¿™ä¸ªæ–‡ä»¶è®©æ–‡ä»¶å¤¹å˜æˆåŒ…
â”œâ”€â”€ math_tools.py
â””â”€â”€ string_tools.py
â†“
Pythonè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªåŒ…ï¼Œå¯ä»¥å¯¼å…¥ä½¿ç”¨
```

### 2.2 æœ€ç®€å•çš„ __init__.py


**ç©ºæ–‡ä»¶ä¹Ÿæœ‰ç”¨**ï¼šæœ€ç®€å•çš„`__init__.py`å¯ä»¥æ˜¯ç©ºæ–‡ä»¶ï¼Œåªè¦å­˜åœ¨å°±è¡Œã€‚

```python
# utils/__init__.py
# è¿™æ˜¯ä¸€ä¸ªç©ºçš„__init__.pyæ–‡ä»¶
# ä»…ä»…å­˜åœ¨å°±å¤Ÿäº†ï¼Œè®©è¿™ä¸ªæ–‡ä»¶å¤¹æˆä¸ºåŒ…
```

**ä½¿ç”¨æ•ˆæœ**ï¼š
```python
# main.py
from utils import math_tools     # âœ… å¯ä»¥å¯¼å…¥
from utils.math_tools import add # âœ… å¯ä»¥å¯¼å…¥å…·ä½“å‡½æ•°
```

### 2.3 å¸¦åŠŸèƒ½çš„ __init__.py


**ç®€åŒ–å¯¼å…¥**ï¼šåœ¨`__init__.py`ä¸­å¯¼å…¥å¸¸ç”¨åŠŸèƒ½ï¼Œè®©ä½¿ç”¨æ›´æ–¹ä¾¿ã€‚

```python
# utils/math_tools.py
def add(a, b):
    """ä¸¤æ•°ç›¸åŠ """
    return a + b

def multiply(a, b):
    """ä¸¤æ•°ç›¸ä¹˜"""
    return a * b
```

```python
# utils/string_tools.py
def reverse_string(text):
    """å­—ç¬¦ä¸²åè½¬"""
    return text[::-1]

def capitalize_words(text):
    """é¦–å­—æ¯å¤§å†™"""
    return text.title()
```

```python
# utils/__init__.py
# ä»å­æ¨¡å—å¯¼å…¥å¸¸ç”¨åŠŸèƒ½
from .math_tools import add, multiply
from .string_tools import reverse_string, capitalize_words

# å®šä¹‰åŒ…çš„ç‰ˆæœ¬ä¿¡æ¯
__version__ = "1.0.0"

# å®šä¹‰ __all__ æ§åˆ¶ from utils import * çš„è¡Œä¸º
__all__ = ['add', 'multiply', 'reverse_string', 'capitalize_words']
```

**ç®€åŒ–åçš„ä½¿ç”¨**ï¼š
```python
# main.py
# ç›´æ¥ä»åŒ…å¯¼å…¥ï¼Œä¸éœ€è¦æŒ‡å®šå…·ä½“æ¨¡å—
from utils import add, reverse_string

print(add(3, 5))                    # è¾“å‡º: 8
print(reverse_string("hello"))      # è¾“å‡º: olleh
```

### 2.4 __all__ çš„ä½œç”¨


**æ§åˆ¶å¯¼å…¥è¡Œä¸º**ï¼š`__all__`å®šä¹‰äº†`from package import *`æ—¶å¯¼å…¥ä»€ä¹ˆã€‚

```python
# utils/__init__.py
from .math_tools import add, multiply, divide
from .string_tools import reverse_string

# åªå…è®¸å¯¼å…¥è¿™äº›å‡½æ•°
__all__ = ['add', 'multiply', 'reverse_string']
# divide å‡½æ•°ä¸åœ¨ __all__ ä¸­ï¼Œä¸ä¼šè¢« import * å¯¼å…¥
```

**å¯¹æ¯”æ•ˆæœ**ï¼š
```python
# main.py
from utils import *  # åªå¯¼å…¥ __all__ ä¸­å®šä¹‰çš„å‡½æ•°

print(add(3, 5))           # âœ… æ­£å¸¸å·¥ä½œ
print(reverse_string("hi")) # âœ… æ­£å¸¸å·¥ä½œ
print(divide(10, 2))        # âŒ æŠ¥é”™ï¼šæ²¡æœ‰è¢«å¯¼å…¥
```

### 2.5 åŒ…åˆå§‹åŒ–ä»£ç 


**æ‰§è¡Œåˆå§‹åŒ–é€»è¾‘**ï¼š`__init__.py`ä¸­çš„ä»£ç åœ¨åŒ…è¢«é¦–æ¬¡å¯¼å…¥æ—¶æ‰§è¡Œã€‚

```python
# utils/__init__.py
print("ğŸš€ utilsåŒ…æ­£åœ¨åˆå§‹åŒ–...")

# è®¾ç½®åŒ…çº§åˆ«çš„é…ç½®
PACKAGE_CONFIG = {
    'debug_mode': False,
    'max_workers': 4
}

# æ£€æŸ¥ä¾èµ–
try:
    import numpy
    HAS_NUMPY = True
except ImportError:
    HAS_NUMPY = False
    print("âš ï¸ è­¦å‘Šï¼šnumpyæœªå®‰è£…ï¼ŒæŸäº›åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨")

from .math_tools import add, multiply
from .string_tools import reverse_string

__all__ = ['add', 'multiply', 'reverse_string', 'PACKAGE_CONFIG', 'HAS_NUMPY']
```

**åˆå§‹åŒ–æ¼”ç¤º**ï¼š
```python
# main.py
import utils  # è¿™é‡Œä¼šæ‰“å°åˆå§‹åŒ–ä¿¡æ¯
# è¾“å‡º: ğŸš€ utilsåŒ…æ­£åœ¨åˆå§‹åŒ–...
# è¾“å‡º: âš ï¸ è­¦å‘Šï¼šnumpyæœªå®‰è£…ï¼ŒæŸäº›åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨

print(utils.PACKAGE_CONFIG)  # å¯ä»¥è®¿é—®åŒ…çº§åˆ«é…ç½®
```

---

## 3. ğŸ¯ __main__.py ä¸»å…¥å£æ–‡ä»¶


### 3.1 __main__.py çš„ä½œç”¨


**è®©åŒ…å¯æ‰§è¡Œ**ï¼š`__main__.py`è®©ä¸€ä¸ªåŒ…å¯ä»¥åƒè„šæœ¬ä¸€æ ·ç›´æ¥è¿è¡Œã€‚

```
æ™®é€šåŒ…çš„ä½¿ç”¨æ–¹å¼ï¼š
python -c "import mypackage; mypackage.run()"

æœ‰ __main__.py çš„åŒ…ï¼š
python -m mypackage  â† ç›´æ¥è¿è¡ŒåŒ…
```

### 3.2 åˆ›å»ºå¯æ‰§è¡Œçš„åŒ…


**é¡¹ç›®ç»“æ„**ï¼š
```
calculator/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ __main__.py        â† ä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ operations.py
â””â”€â”€ utils.py
```

**å®ç°å„æ¨¡å—**ï¼š
```python
# calculator/operations.py
def add(a, b):
    return a + b

def subtract(a, b):
    return a - b

def multiply(a, b):
    return a * b

def divide(a, b):
    if b == 0:
        raise ValueError("ä¸èƒ½é™¤ä»¥é›¶")
    return a / b
```

```python
# calculator/__init__.py
from .operations import add, subtract, multiply, divide
__all__ = ['add', 'subtract', 'multiply', 'divide']
```

```python
# calculator/__main__.py
"""
è®¡ç®—å™¨åŒ…çš„ä¸»å…¥å£æ–‡ä»¶
å½“ä½¿ç”¨ python -m calculator æ—¶ä¼šæ‰§è¡Œè¿™ä¸ªæ–‡ä»¶
"""
import sys
from . import add, subtract, multiply, divide

def main():
    """ä¸»å‡½æ•°ï¼šç®€å•çš„è®¡ç®—å™¨ç¨‹åº"""
    print("ğŸ”¢ æ¬¢è¿ä½¿ç”¨Pythonè®¡ç®—å™¨ï¼")
    print("æ”¯æŒçš„æ“ä½œï¼š+ï¼ˆåŠ ï¼‰ã€-ï¼ˆå‡ï¼‰ã€*ï¼ˆä¹˜ï¼‰ã€/ï¼ˆé™¤ï¼‰")
    print("è¾“å…¥ 'quit' é€€å‡ºç¨‹åº")
    
    while True:
        try:
            # è·å–ç”¨æˆ·è¾“å…¥
            expression = input("\nè¯·è¾“å…¥è®¡ç®—è¡¨è¾¾å¼ï¼ˆå¦‚ï¼š5 + 3ï¼‰: ").strip()
            
            if expression.lower() == 'quit':
                print("ğŸ‘‹ å†è§ï¼")
                break
            
            # è§£æè¡¨è¾¾å¼
            parts = expression.split()
            if len(parts) != 3:
                print("âŒ æ ¼å¼é”™è¯¯ï¼è¯·è¾“å…¥ï¼šæ•°å­— æ“ä½œç¬¦ æ•°å­—")
                continue
            
            num1 = float(parts[0])
            operator = parts[1]
            num2 = float(parts[2])
            
            # æ‰§è¡Œè®¡ç®—
            if operator == '+':
                result = add(num1, num2)
            elif operator == '-':
                result = subtract(num1, num2)
            elif operator == '*':
                result = multiply(num1, num2)
            elif operator == '/':
                result = divide(num1, num2)
            else:
                print("âŒ ä¸æ”¯æŒçš„æ“ä½œç¬¦ï¼")
                continue
            
            print(f"âœ… ç»“æœï¼š{num1} {operator} {num2} = {result}")
            
        except ValueError as e:
            print(f"âŒ é”™è¯¯ï¼š{e}")
        except Exception as e:
            print(f"âŒ å‘ç”Ÿé”™è¯¯ï¼š{e}")

# å½“ä½œä¸ºæ¨¡å—è¿è¡Œæ—¶æ‰§è¡Œä¸»å‡½æ•°
if __name__ == '__main__':
    main()
```

**ä½¿ç”¨æ–¹å¼å¯¹æ¯”**ï¼š
```bash
# æ–¹å¼1ï¼šä½œä¸ºæ¨¡å—è¿è¡Œï¼ˆæ¨èï¼‰
python -m calculator

# æ–¹å¼2ï¼šç›´æ¥è¿è¡Œï¼ˆå¦‚æœåŒ…åœ¨Pythonè·¯å¾„ä¸­ï¼‰
python calculator

# æ–¹å¼3ï¼šåœ¨ä»£ç ä¸­å¯¼å…¥ä½¿ç”¨
python -c "from calculator import add; print(add(3, 5))"
```

### 3.3 å‘½ä»¤è¡Œå‚æ•°å¤„ç†


**é«˜çº§ç‰ˆæœ¬**ï¼šæ”¯æŒå‘½ä»¤è¡Œå‚æ•°çš„è®¡ç®—å™¨ã€‚

```python
# calculator/__main__.py
import sys
import argparse
from . import add, subtract, multiply, divide

def create_parser():
    """åˆ›å»ºå‘½ä»¤è¡Œå‚æ•°è§£æå™¨"""
    parser = argparse.ArgumentParser(
        description='Pythonè®¡ç®—å™¨ - æ”¯æŒåŸºæœ¬æ•°å­¦è¿ç®—',
        prog='python -m calculator'
    )
    
    parser.add_argument('num1', type=float, help='ç¬¬ä¸€ä¸ªæ•°å­—')
    parser.add_argument('operator', choices=['+', '-', '*', '/'], 
                       help='è¿ç®—ç¬¦ï¼š+ï¼ˆåŠ ï¼‰ã€-ï¼ˆå‡ï¼‰ã€*ï¼ˆä¹˜ï¼‰ã€/ï¼ˆé™¤ï¼‰')
    parser.add_argument('num2', type=float, help='ç¬¬äºŒä¸ªæ•°å­—')
    parser.add_argument('--precision', '-p', type=int, default=2,
                       help='ç»“æœç²¾åº¦ï¼ˆå°æ•°ä½æ•°ï¼‰ï¼Œé»˜è®¤2ä½')
    
    return parser

def main():
    """ä¸»å‡½æ•°"""
    parser = create_parser()
    
    # å¦‚æœæ²¡æœ‰å‚æ•°ï¼Œå¯åŠ¨äº¤äº’æ¨¡å¼
    if len(sys.argv) == 1:
        interactive_mode()
        return
    
    # è§£æå‘½ä»¤è¡Œå‚æ•°
    try:
        args = parser.parse_args()
    except SystemExit:
        return
    
    # æ‰§è¡Œè®¡ç®—
    try:
        if args.operator == '+':
            result = add(args.num1, args.num2)
        elif args.operator == '-':
            result = subtract(args.num1, args.num2)
        elif args.operator == '*':
            result = multiply(args.num1, args.num2)
        elif args.operator == '/':
            result = divide(args.num1, args.num2)
        
        # æ ¼å¼åŒ–è¾“å‡º
        result = round(result, args.precision)
        print(f"{args.num1} {args.operator} {args.num2} = {result}")
        
    except Exception as e:
        print(f"âŒ è®¡ç®—é”™è¯¯ï¼š{e}", file=sys.stderr)
        sys.exit(1)

def interactive_mode():
    """äº¤äº’æ¨¡å¼ï¼ˆä¹‹å‰çš„ä»£ç ï¼‰"""
    # ... äº¤äº’æ¨¡å¼çš„ä»£ç  ...

if __name__ == '__main__':
    main()
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```bash
# ç›´æ¥è®¡ç®—
python -m calculator 10 + 5
# è¾“å‡º: 10.0 + 5.0 = 15.0

# æŒ‡å®šç²¾åº¦
python -m calculator 10 / 3 --precision 4
# è¾“å‡º: 10.0 / 3.0 = 3.3333

# æŸ¥çœ‹å¸®åŠ©
python -m calculator --help

# äº¤äº’æ¨¡å¼
python -m calculator
```

---

## 4. âš¡ if __name__ == '__main__' ä¸»ç¨‹åºåˆ¤æ–­


### 4.1 ç†è§£ __name__ å˜é‡


**__name__ æ˜¯ä»€ä¹ˆ**ï¼šPythonè‡ªåŠ¨è®¾ç½®çš„ç‰¹æ®Šå˜é‡ï¼Œè¡¨ç¤ºå½“å‰æ¨¡å—çš„åå­—ã€‚

```python
# test_module.py
print(f"å½“å‰æ¨¡å—åï¼š{__name__}")

def say_hello():
    print("Hello from test_module!")

if __name__ == '__main__':
    print("è¿™ä¸ªæ¨¡å—æ­£åœ¨è¢«ç›´æ¥è¿è¡Œ")
    say_hello()
else:
    print("è¿™ä¸ªæ¨¡å—æ­£åœ¨è¢«å¯¼å…¥")
```

**ä¸åŒæ‰§è¡Œæ–¹å¼çš„å¯¹æ¯”**ï¼š
```bash
# ç›´æ¥è¿è¡Œæ–‡ä»¶
python test_module.py
# è¾“å‡º:
# å½“å‰æ¨¡å—åï¼š__main__
# è¿™ä¸ªæ¨¡å—æ­£åœ¨è¢«ç›´æ¥è¿è¡Œ
# Hello from test_module!

# å¯¼å…¥æ¨¡å—
python -c "import test_module"
# è¾“å‡º:
# å½“å‰æ¨¡å—åï¼štest_module
# è¿™ä¸ªæ¨¡å—æ­£åœ¨è¢«å¯¼å…¥
```

### 4.2 ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªåˆ¤æ–­


**é¿å…æ„å¤–æ‰§è¡Œ**ï¼šé˜²æ­¢å¯¼å…¥æ¨¡å—æ—¶æ‰§è¡Œä¸è¯¥æ‰§è¡Œçš„ä»£ç ã€‚

```python
# bad_example.py - ä¸å¥½çš„ä¾‹å­
def useful_function():
    return "è¿™æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„å‡½æ•°"

# è¿™äº›ä»£ç åœ¨å¯¼å…¥æ—¶ä¹Ÿä¼šæ‰§è¡Œï¼
print("å¼€å§‹æ‰§è¡Œç¨‹åº...")
result = useful_function()
print(f"ç»“æœï¼š{result}")
print("ç¨‹åºç»“æŸ")
```

```python
# good_example.py - å¥½çš„ä¾‹å­
def useful_function():
    return "è¿™æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„å‡½æ•°"

def main():
    """ä¸»ç¨‹åºé€»è¾‘"""
    print("å¼€å§‹æ‰§è¡Œç¨‹åº...")
    result = useful_function()
    print(f"ç»“æœï¼š{result}")
    print("ç¨‹åºç»“æŸ")

# åªæœ‰ç›´æ¥è¿è¡Œæ—¶æ‰æ‰§è¡Œä¸»ç¨‹åº
if __name__ == '__main__':
    main()
```

**å¯¹æ¯”æ•ˆæœ**ï¼š
```python
# å¯¼å…¥ bad_example æ—¶
import bad_example  
# è¾“å‡ºï¼šå¼€å§‹æ‰§è¡Œç¨‹åº... ç»“æœï¼šè¿™æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„å‡½æ•° ç¨‹åºç»“æŸ

# å¯¼å…¥ good_example æ—¶
import good_example  
# æ— è¾“å‡ºï¼Œåªå¯¼å…¥å‡½æ•°å®šä¹‰

# ä½†å¯ä»¥æ­£å¸¸ä½¿ç”¨å‡½æ•°
print(good_example.useful_function())  # è¾“å‡ºï¼šè¿™æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„å‡½æ•°
```

### 4.3 å¸¸è§ä½¿ç”¨æ¨¡å¼


**æ¨¡å¼1ï¼šç®€å•è„šæœ¬**
```python
# simple_script.py
def process_data(data):
    """å¤„ç†æ•°æ®çš„å‡½æ•°"""
    return [x * 2 for x in data]

def main():
    """ä¸»ç¨‹åº"""
    numbers = [1, 2, 3, 4, 5]
    result = process_data(numbers)
    print(f"å¤„ç†ç»“æœï¼š{result}")

if __name__ == '__main__':
    main()
```

**æ¨¡å¼2ï¼šæµ‹è¯•ä»£ç **
```python
# math_utils.py
def factorial(n):
    """è®¡ç®—é˜¶ä¹˜"""
    if n < 0:
        raise ValueError("é˜¶ä¹˜ä¸èƒ½è®¡ç®—è´Ÿæ•°")
    if n == 0 or n == 1:
        return 1
    return n * factorial(n - 1)

def fibonacci(n):
    """è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ç¬¬né¡¹"""
    if n < 0:
        raise ValueError("æ–æ³¢é‚£å¥‘æ•°åˆ—ä¸èƒ½è®¡ç®—è´Ÿæ•°")
    if n == 0:
        return 0
    if n == 1:
        return 1
    return fibonacci(n - 1) + fibonacci(n - 2)

# æµ‹è¯•ä»£ç 
if __name__ == '__main__':
    print("ğŸ§ª æµ‹è¯•æ•°å­¦å·¥å…·å‡½æ•°")
    
    # æµ‹è¯•é˜¶ä¹˜
    print("\næµ‹è¯•é˜¶ä¹˜å‡½æ•°ï¼š")
    for i in range(6):
        print(f"{i}! = {factorial(i)}")
    
    # æµ‹è¯•æ–æ³¢é‚£å¥‘
    print("\næµ‹è¯•æ–æ³¢é‚£å¥‘å‡½æ•°ï¼š")
    for i in range(10):
        print(f"fibonacci({i}) = {fibonacci(i)}")
```

**æ¨¡å¼3ï¼šå‘½ä»¤è¡Œå·¥å…·**
```python
# file_processor.py
import sys
import os

def count_lines(filename):
    """è®¡ç®—æ–‡ä»¶è¡Œæ•°"""
    try:
        with open(filename, 'r', encoding='utf-8') as f:
            return len(f.readlines())
    except FileNotFoundError:
        print(f"âŒ æ–‡ä»¶ {filename} ä¸å­˜åœ¨")
        return None
    except Exception as e:
        print(f"âŒ è¯»å–æ–‡ä»¶æ—¶å‡ºé”™ï¼š{e}")
        return None

def main():
    """ä¸»ç¨‹åºï¼šå‘½ä»¤è¡Œæ–‡ä»¶å¤„ç†å·¥å…·"""
    if len(sys.argv) != 2:
        print("ä½¿ç”¨æ–¹æ³•ï¼špython file_processor.py <æ–‡ä»¶å>")
        sys.exit(1)
    
    filename = sys.argv[1]
    if not os.path.isfile(filename):
        print(f"âŒ {filename} ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ–‡ä»¶")
        sys.exit(1)
    
    lines = count_lines(filename)
    if lines is not None:
        print(f"ğŸ“„ æ–‡ä»¶ {filename} å…±æœ‰ {lines} è¡Œ")

if __name__ == '__main__':
    main()
```

### 4.4 åœ¨åŒ…ä¸­çš„ä½¿ç”¨


**åŒ…å†…æ¨¡å—çš„åä½œ**ï¼š
```python
# mypackage/utils.py
def helper_function():
    return "æˆ‘æ˜¯è¾…åŠ©å‡½æ•°"

if __name__ == '__main__':
    # è¿™ä¸ªæ¨¡å—çš„å•ç‹¬æµ‹è¯•
    print("æµ‹è¯• utils.py æ¨¡å—")
    print(helper_function())
```

```python
# mypackage/__main__.py
from .utils import helper_function

def main():
    print("è¿è¡ŒåŒ…çš„ä¸»ç¨‹åº")
    print(helper_function())

if __name__ == '__main__':
    main()
```

**æ‰§è¡Œå¯¹æ¯”**ï¼š
```bash
# æµ‹è¯•å•ä¸ªæ¨¡å—
python mypackage/utils.py
# è¾“å‡ºï¼šæµ‹è¯• utils.py æ¨¡å— æˆ‘æ˜¯è¾…åŠ©å‡½æ•°

# è¿è¡Œæ•´ä¸ªåŒ…
python -m mypackage
# è¾“å‡ºï¼šè¿è¡ŒåŒ…çš„ä¸»ç¨‹åº æˆ‘æ˜¯è¾…åŠ©å‡½æ•°
```

---

## 5. ğŸ›  åŒ…ç®¡ç†æœ€ä½³å®è·µ


### 5.1 åŒ…ç»“æ„è®¾è®¡åŸåˆ™


**æ¸…æ™°çš„å±‚æ¬¡ç»“æ„**ï¼š
```
myproject/
â”œâ”€â”€ README.md              â† é¡¹ç›®è¯´æ˜
â”œâ”€â”€ requirements.txt       â† ä¾èµ–æ¸…å•
â”œâ”€â”€ setup.py              â† åŒ…å®‰è£…é…ç½®
â”œâ”€â”€ mypackage/            â† ä¸»åŒ…ç›®å½•
â”‚   â”œâ”€â”€ __init__.py       â† åŒ…åˆå§‹åŒ–
â”‚   â”œâ”€â”€ __main__.py       â† ä¸»å…¥å£ï¼ˆå¯é€‰ï¼‰
â”‚   â”œâ”€â”€ core/             â† æ ¸å¿ƒåŠŸèƒ½å­åŒ…
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ engine.py
â”‚   â”‚   â””â”€â”€ config.py
â”‚   â”œâ”€â”€ utils/            â† å·¥å…·å­åŒ…
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ helpers.py
â”‚   â”‚   â””â”€â”€ validators.py
â”‚   â””â”€â”€ exceptions.py     â† è‡ªå®šä¹‰å¼‚å¸¸
â”œâ”€â”€ tests/                â† æµ‹è¯•ç›®å½•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ test_core.py
â”‚   â””â”€â”€ test_utils.py
â””â”€â”€ docs/                 â† æ–‡æ¡£ç›®å½•
```

### 5.2 __init__.py æœ€ä½³å®è·µ


**ç²¾å¿ƒè®¾è®¡çš„åŒ…åˆå§‹åŒ–**ï¼š
```python
# mypackage/__init__.py
"""
MyPackage - ä¸€ä¸ªç¤ºä¾‹PythonåŒ…

è¿™ä¸ªåŒ…æä¾›äº†ä»¥ä¸‹åŠŸèƒ½ï¼š
- æ ¸å¿ƒå¼•æ“åŠŸèƒ½
- å®ç”¨å·¥å…·å‡½æ•°
- æ•°æ®éªŒè¯å·¥å…·
"""

# ç‰ˆæœ¬ä¿¡æ¯
__version__ = "1.2.3"
__author__ = "Your Name"
__email__ = "your.email@example.com"

# å¯¼å…¥æ ¸å¿ƒåŠŸèƒ½
from .core.engine import Engine
from .core.config import Config

# å¯¼å…¥å¸¸ç”¨å·¥å…·
from .utils.helpers import format_data, parse_input
from .utils.validators import validate_email, validate_phone

# å¯¼å…¥å¼‚å¸¸ç±»
from .exceptions import MyPackageError, ValidationError

# å®šä¹‰å…¬å…±API
__all__ = [
    # æ ¸å¿ƒç±»
    'Engine', 'Config',
    # å·¥å…·å‡½æ•°
    'format_data', 'parse_input',
    'validate_email', 'validate_phone',
    # å¼‚å¸¸ç±»
    'MyPackageError', 'ValidationError'
]

# åŒ…çº§åˆ«é…ç½®
DEFAULT_CONFIG = {
    'debug': False,
    'timeout': 30,
    'retry_count': 3
}

def get_version():
    """è·å–åŒ…ç‰ˆæœ¬"""
    return __version__

def configure(debug=None, timeout=None, retry_count=None):
    """é…ç½®åŒ…çš„å…¨å±€è®¾ç½®"""
    if debug is not None:
        DEFAULT_CONFIG['debug'] = debug
    if timeout is not None:
        DEFAULT_CONFIG['timeout'] = timeout
    if retry_count is not None:
        DEFAULT_CONFIG['retry_count'] = retry_count
```

### 5.3 å¯¼å…¥ç­–ç•¥


**ç›¸å¯¹å¯¼å…¥ vs ç»å¯¹å¯¼å…¥**ï¼š
```python
# åœ¨åŒ…å†…éƒ¨ä½¿ç”¨ç›¸å¯¹å¯¼å…¥ï¼ˆæ¨èï¼‰
# mypackage/core/engine.py
from ..utils.helpers import format_data  # ç›¸å¯¹å¯¼å…¥
from .config import Config                # åŒçº§ç›¸å¯¹å¯¼å…¥

# é¿å…ä½¿ç”¨ç»å¯¹å¯¼å…¥ï¼ˆé™¤éå¿…è¦ï¼‰
# from mypackage.utils.helpers import format_data  # ç»å¯¹å¯¼å…¥
```

**å»¶è¿Ÿå¯¼å…¥**ï¼š
```python
# mypackage/__init__.py
# å¯¹äºå¤§å‹æˆ–å¯é€‰çš„ä¾èµ–ï¼Œä½¿ç”¨å»¶è¿Ÿå¯¼å…¥
def get_advanced_engine():
    """è·å–é«˜çº§å¼•æ“ï¼ˆéœ€è¦é¢å¤–ä¾èµ–ï¼‰"""
    try:
        from .advanced.engine import AdvancedEngine
        return AdvancedEngine
    except ImportError:
        raise ImportError("é«˜çº§å¼•æ“éœ€è¦å®‰è£…é¢å¤–ä¾èµ–ï¼špip install mypackage[advanced]")

# åªåœ¨ __all__ ä¸­åŒ…å«ç¡®å®šå¯ç”¨çš„åŠŸèƒ½
__all__ = ['Engine', 'Config', 'get_advanced_engine']
```

### 5.4 å‘½åç©ºé—´åŒ…


**ä¼ ç»ŸåŒ… vs å‘½åç©ºé—´åŒ…**ï¼š
```
ä¼ ç»ŸåŒ…ï¼ˆæœ‰ __init__.pyï¼‰ï¼š
company_tools/
â”œâ”€â”€ __init__.py      â† å¿…é¡»æœ‰
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ mysql.py
â””â”€â”€ web/
    â”œâ”€â”€ __init__.py
    â””â”€â”€ flask_utils.py

å‘½åç©ºé—´åŒ…ï¼ˆPython 3.3+ï¼Œæ—  __init__.pyï¼‰ï¼š
company_tools/        â† æ²¡æœ‰ __init__.py
â”œâ”€â”€ database/
â”‚   â””â”€â”€ mysql.py
â””â”€â”€ web/
    â””â”€â”€ flask_utils.py
```

**å‘½åç©ºé—´åŒ…çš„ä½¿ç”¨åœºæ™¯**ï¼š
- å¤šä¸ªå›¢é˜Ÿå¼€å‘ä¸åŒçš„å­åŒ…
- åŒ…çš„éƒ¨åˆ†å¯ä»¥ç‹¬ç«‹å®‰è£…
- é¿å… __init__.py çš„ç»´æŠ¤è´Ÿæ‹…

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ __init__.pyï¼šè®©æ–‡ä»¶å¤¹å˜æˆåŒ…çš„é­”æ³•æ–‡ä»¶
ğŸ”¸ __main__.pyï¼šè®©åŒ…å¯ä»¥ç›´æ¥è¿è¡Œçš„å…¥å£æ–‡ä»¶  
ğŸ”¸ if __name__ == '__main__'ï¼šåŒºåˆ†ç›´æ¥è¿è¡Œå’Œå¯¼å…¥çš„åˆ¤æ–­
ğŸ”¸ __all__ï¼šæ§åˆ¶ from package import * çš„è¡Œä¸º
ğŸ”¸ ç›¸å¯¹å¯¼å…¥ï¼šåŒ…å†…éƒ¨æ¨¡å—é—´çš„å¯¼å…¥æ–¹å¼
```

### 6.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ åŒ…åˆå§‹åŒ–çš„æœ¬è´¨**
```
ç†è§£è¦ç‚¹ï¼š
- __init__.py æ˜¯åŒ…çš„"èº«ä»½è¯"ï¼Œæ²¡æœ‰å®ƒå°±ä¸æ˜¯åŒ…
- å¯ä»¥æ˜¯ç©ºæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥åŒ…å«åˆå§‹åŒ–ä»£ç 
- åœ¨åŒ…è¢«é¦–æ¬¡å¯¼å…¥æ—¶æ‰§è¡Œï¼Œä¸”åªæ‰§è¡Œä¸€æ¬¡
- ç”¨äºè®¾ç½®åŒ…çš„å…¬å…±æ¥å£å’Œé…ç½®
```

**ğŸ”¹ ä¸»ç¨‹åºåˆ¤æ–­çš„æ„ä¹‰**
```
æ ¸å¿ƒä»·å€¼ï¼š
- è®©æ¨¡å—æ—¢å¯ä»¥è¢«å¯¼å…¥ï¼Œåˆå¯ä»¥ç‹¬ç«‹è¿è¡Œ
- é¿å…å¯¼å…¥æ—¶æ‰§è¡Œä¸å¿…è¦çš„ä»£ç 
- æ˜¯Pythonæ¨¡å—åŒ–ç¼–ç¨‹çš„é‡è¦æ¨¡å¼
- ä¾¿äºç¼–å†™æµ‹è¯•å’Œå‘½ä»¤è¡Œå·¥å…·
```

**ğŸ”¹ åŒ…ç®¡ç†çš„æœ€ä½³å®è·µ**
```
è®¾è®¡åŸåˆ™ï¼š
- ç»“æ„æ¸…æ™°ï¼šåŠŸèƒ½åˆ†ç»„ï¼Œå±‚æ¬¡åˆ†æ˜
- æ¥å£ç®€æ´ï¼šé€šè¿‡ __init__.py æä¾›ç®€æ´çš„API
- æ–‡æ¡£é½å…¨ï¼šåŒ…å«å¿…è¦çš„è¯´æ˜å’Œç¤ºä¾‹
- æµ‹è¯•å®Œæ•´ï¼šæ¯ä¸ªæ¨¡å—éƒ½æœ‰å¯¹åº”æµ‹è¯•
```

### 6.3 å®é™…åº”ç”¨åœºæ™¯


| åœºæ™¯ | **ä½¿ç”¨çš„æŠ€æœ¯** | **å…·ä½“åº”ç”¨** |
|------|-------------|-------------|
| ğŸ—ï¸ **é¡¹ç›®ç»„ç»‡** | `__init__.py` | `å¤§å‹é¡¹ç›®çš„æ¨¡å—åŒ–ç®¡ç†` |
| ğŸ› ï¸ **å‘½ä»¤è¡Œå·¥å…·** | `__main__.py` | `åˆ›å»ºå¯æ‰§è¡Œçš„PythonåŒ…` |
| ğŸ§ª **æµ‹è¯•ä»£ç ** | `if __name__ == '__main__'` | `æ¨¡å—è‡ªæµ‹è¯•åŠŸèƒ½` |
| ğŸ“¦ **åº“å¼€å‘** | `__all__` | `æ§åˆ¶åŒ…çš„å…¬å…±API` |
| ğŸ”§ **å·¥å…·è„šæœ¬** | `ä¸»ç¨‹åºåˆ¤æ–­` | `æ—¢å¯å¯¼å…¥åˆå¯è¿è¡Œçš„è„šæœ¬` |

### 6.4 å¸¸è§è¯¯åŒºä¸æ³¨æ„äº‹é¡¹


**âŒ å¸¸è§é”™è¯¯**ï¼š
```python
# é”™è¯¯1ï¼šå¿˜è®° __init__.py
mypackage/
â”œâ”€â”€ module1.py  # æ— æ³•ä½œä¸ºåŒ…å¯¼å…¥
â””â”€â”€ module2.py

# é”™è¯¯2ï¼šåœ¨ __init__.py ä¸­å†™å¤æ‚é€»è¾‘
# __init__.py
import time
print("åˆå§‹åŒ–ä¸­...")
time.sleep(5)  # å¯¼å…¥åŒ…æ—¶ä¼šå¾ˆæ…¢

# é”™è¯¯3ï¼šä¸ä½¿ç”¨ if __name__ == '__main__'
# module.py  
print("è¿™è¡Œä»£ç åœ¨å¯¼å…¥æ—¶ä¹Ÿä¼šæ‰§è¡Œï¼")  # é—®é¢˜ä»£ç 
```

**âœ… æ­£ç¡®åšæ³•**ï¼š
```python
# æ­£ç¡®1ï¼šå¿…é¡»æœ‰ __init__.py
mypackage/
â”œâ”€â”€ __init__.py  # å³ä½¿æ˜¯ç©ºæ–‡ä»¶ä¹Ÿè¦æœ‰
â”œâ”€â”€ module1.py
â””â”€â”€ module2.py

# æ­£ç¡®2ï¼šä¿æŒ __init__.py è½»é‡
# __init__.py
from .module1 import main_function
__all__ = ['main_function']

# æ­£ç¡®3ï¼šä½¿ç”¨ä¸»ç¨‹åºåˆ¤æ–­
# module.py
def useful_function():
    return "result"

if __name__ == '__main__':
    print(useful_function())  # åªåœ¨ç›´æ¥è¿è¡Œæ—¶æ‰§è¡Œ
```

### 6.5 å­¦ä¹ å»ºè®®


**ğŸ¯ å¾ªåºæ¸è¿›çš„å­¦ä¹ è·¯å¾„**ï¼š

1. **ç¬¬ä¸€æ­¥**ï¼šç†è§£ `if __name__ == '__main__'`
   - ä»ç®€å•è„šæœ¬å¼€å§‹ç»ƒä¹ 
   - ç†è§£ç›´æ¥è¿è¡Œå’Œå¯¼å…¥çš„åŒºåˆ«

2. **ç¬¬äºŒæ­¥**ï¼šæŒæ¡ `__init__.py` çš„ä½¿ç”¨
   - åˆ›å»ºç®€å•çš„åŒ…ç»“æ„
   - ç»ƒä¹ ä»åŒ…ä¸­å¯¼å…¥æ¨¡å—

3. **ç¬¬ä¸‰æ­¥**ï¼šå­¦ä¹  `__main__.py` çš„åº”ç”¨
   - åˆ›å»ºå¯æ‰§è¡Œçš„åŒ…
   - æ·»åŠ å‘½ä»¤è¡Œå‚æ•°å¤„ç†

4. **ç¬¬å››æ­¥**ï¼šç»¼åˆåº”ç”¨
   - è®¾è®¡å®Œæ•´çš„åŒ…ç»“æ„
   - å®ç°åŒ…çš„åˆ†å‘å’Œå®‰è£…

**ğŸ’¡ å®è·µé¡¹ç›®å»ºè®®**ï¼š
- åˆ›å»ºä¸€ä¸ªä¸ªäººå·¥å…·åŒ…ï¼ˆæ•°å­¦è®¡ç®—ã€æ–‡ä»¶å¤„ç†ç­‰ï¼‰
- å¼€å‘ä¸€ä¸ªå°å‹å‘½ä»¤è¡Œå·¥å…·
- é‡æ„ç°æœ‰ä»£ç ï¼Œé‡‡ç”¨åŒ…çš„ç»„ç»‡æ–¹å¼

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- initæ–‡ä»¶æ˜¯åŒ…èº«ä»½ï¼Œmainæ–‡ä»¶å¯æ‰§è¡Œ
- nameåˆ¤æ–­åˆ†åœºæ™¯ï¼Œå¯¼å…¥è¿è¡Œè¦åŒºåˆ†
- åŒ…ç®¡ç†è®²å±‚æ¬¡ï¼Œæ¥å£ç®€æ´æœ€é‡è¦