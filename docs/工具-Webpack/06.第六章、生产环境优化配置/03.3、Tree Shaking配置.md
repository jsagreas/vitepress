---
title: 3ã€Tree Shakingé…ç½®
---
## ğŸ“š ç›®å½•

1. [Tree ShakingåŸºæœ¬æ¦‚å¿µ](#1-tree-shakingåŸºæœ¬æ¦‚å¿µ)
2. [å·¥ä½œåŸç†è¯¦è§£](#2-å·¥ä½œåŸç†è¯¦è§£)
3. [é…ç½®å’Œä½¿ç”¨æ–¹æ³•](#3-é…ç½®å’Œä½¿ç”¨æ–¹æ³•)
4. [ç¬¬ä¸‰æ–¹åº“ä¼˜åŒ–](#4-ç¬¬ä¸‰æ–¹åº“ä¼˜åŒ–)
5. [é«˜çº§ä¼˜åŒ–æŠ€å·§](#5-é«˜çº§ä¼˜åŒ–æŠ€å·§)
6. [å®æˆ˜æ¡ˆä¾‹åˆ†æ](#6-å®æˆ˜æ¡ˆä¾‹åˆ†æ)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ³ Tree ShakingåŸºæœ¬æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯Tree Shaking


> **ğŸ’¡ ç®€å•ç†è§£**ï¼šTree Shakingå°±åƒ**æ‘‡æ ‘æ‰å¶å­**ä¸€æ ·ï¼ŒæŠŠä»£ç ä¸­æ²¡ç”¨çš„éƒ¨åˆ†"æ‘‡æ‰"ï¼Œåªä¿ç•™çœŸæ­£éœ€è¦çš„ä»£ç 

**ğŸ”¸ æ ¸å¿ƒä½œç”¨**
```
åŸå§‹ä»£ç åŒ…å«ï¼š
- ä½ ç”¨åˆ°çš„åŠŸèƒ½ âœ…
- ä½ æ²¡ç”¨åˆ°çš„åŠŸèƒ½ âŒ â† è¿™äº›ä¼šè¢«åˆ é™¤
- ç¬¬ä¸‰æ–¹åº“çš„å…¨éƒ¨ä»£ç  âŒ â† åªä¿ç•™ç”¨åˆ°çš„éƒ¨åˆ†

ç»è¿‡Tree Shakingï¼š
- åªä¿ç•™çœŸæ­£ä½¿ç”¨çš„ä»£ç 
- å¤§å¤§å‡å°æ‰“åŒ…æ–‡ä»¶ä½“ç§¯
- æå‡é¡µé¢åŠ è½½é€Ÿåº¦
```

**ğŸ¯ ä¸¾ä¸ªç”Ÿæ´»ä¾‹å­**
```
å°±åƒæ•´ç†è¡£æŸœï¼š
æ—§è¡£æŸœï¼šæ˜¥å¤ç§‹å†¬æ‰€æœ‰è¡£æœéƒ½å¡åœ¨é‡Œé¢ â†’ å¾ˆå ç©ºé—´
æ•´ç†åï¼šåªç•™è¿™ä¸ªå­£èŠ‚è¦ç©¿çš„è¡£æœ â†’ ç©ºé—´åˆ©ç”¨ç‡é«˜

Tree Shakingåšçš„å°±æ˜¯è¿™ä»¶äº‹ï¼
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦Tree Shaking


**ğŸ“Š å®é™…æ•ˆæœå¯¹æ¯”**
```
ä¸ä½¿ç”¨Tree Shakingï¼š
lodashåº“å®Œæ•´å¼•å…¥ï¼š500KB+
å®é™…åªç”¨äº†2ä¸ªå‡½æ•°ï¼šåº”è¯¥åªè¦10KB

ä½¿ç”¨Tree Shakingï¼š
åªæ‰“åŒ…çœŸæ­£ç”¨åˆ°çš„å‡½æ•°ï¼š10KB
ä½“ç§¯å‡å°‘98%ï¼
```

**âš¡ ç›´æ¥å¥½å¤„**
- `ğŸš€ åŠ è½½æ›´å¿«`ï¼šæ–‡ä»¶å°äº†ï¼Œä¸‹è½½è‡ªç„¶å¿«
- `ğŸ’° çœæµé‡`ï¼šç”¨æˆ·æ¶ˆè€—çš„æµé‡æ›´å°‘  
- `ğŸ“± æ›´æµç•…`ï¼šæ‰‹æœºä¸Šè¿è¡Œæ›´é¡ºæ»‘

---

## 2. âš™ï¸ å·¥ä½œåŸç†è¯¦è§£


### 2.1 é™æ€åˆ†æåŸç†


**ğŸ” Tree Shakingçš„"çœ¼ç›"**

Tree Shakingèƒ½å¤Ÿè¯†åˆ«å“ªäº›ä»£ç æ²¡ç”¨ï¼Œé çš„æ˜¯**é™æ€åˆ†æ**ï¼š

```javascript
// utils.js - å·¥å…·å‡½æ•°åº“
export function add(a, b) {
  return a + b;
}

export function multiply(a, b) {  // è¿™ä¸ªå‡½æ•°æ²¡äººç”¨
  return a * b;
}

export function subtract(a, b) {
  return a - b;
}
```

```javascript
// main.js - ä¸»æ–‡ä»¶
import { add, subtract } from './utils.js';

console.log(add(1, 2));      // ç”¨åˆ°äº†add
console.log(subtract(5, 3)); // ç”¨åˆ°äº†subtract
// multiplyå‡½æ•°æ²¡æœ‰è¢«importï¼ŒTree Shakingä¼šåˆ é™¤å®ƒ
```

**ğŸ§  åˆ†æè¿‡ç¨‹**
```
ç¬¬1æ­¥ï¼šæ‰«ææ‰€æœ‰importè¯­å¥ â†’ çŸ¥é“ä½ è¦ç”¨ä»€ä¹ˆ
ç¬¬2æ­¥ï¼šè¿½è¸ªå‡½æ•°è°ƒç”¨é“¾ â†’ çŸ¥é“å“ªäº›çœŸçš„è¢«æ‰§è¡Œ
ç¬¬3æ­¥ï¼šæ ‡è®°æœªä½¿ç”¨ä»£ç  â†’ ç»™"åºŸä»£ç "æ‰“æ ‡ç­¾
ç¬¬4æ­¥ï¼šåˆ é™¤æ— ç”¨ä»£ç  â†’ æŠŠæ ‡è®°çš„ä»£ç ç§»é™¤
```

### 2.2 ES Modulesçš„é‡è¦æ€§


**âš ï¸ é‡è¦æé†’**ï¼šTree Shakingåªå¯¹ESæ¨¡å—æœ‰æ•ˆï¼

```javascript
// âœ… å¯ä»¥Tree Shakingï¼ˆESæ¨¡å—ï¼‰
import { debounce } from 'lodash-es';

// âŒ ä¸èƒ½Tree Shakingï¼ˆCommonJSï¼‰
const _ = require('lodash');
const { debounce } = require('lodash');
```

**ğŸ“ ä¸ºä»€ä¹ˆESæ¨¡å—æ‰è¡Œï¼Ÿ**
```
ESæ¨¡å—ç‰¹ç‚¹ï¼š
- import/exportè¯­æ³•åœ¨ç¼–è¯‘æ—¶å°±èƒ½ç¡®å®š
- æ¨¡å—ä¾èµ–å…³ç³»æ˜¯é™æ€çš„ï¼Œä¸ä¼šè¿è¡Œæ—¶æ”¹å˜
- Webpackå¯ä»¥æå‰åˆ†æå‡ºä¾èµ–å…³ç³»

CommonJSç‰¹ç‚¹ï¼š
- require()æ˜¯è¿è¡Œæ—¶è°ƒç”¨ï¼Œç¼–è¯‘æ—¶ä¸ç¡®å®š
- å¯èƒ½æ ¹æ®æ¡ä»¶åŠ¨æ€requireä¸åŒæ¨¡å—
- Webpackæ— æ³•æå‰ç¡®å®šå“ªäº›ä»£ç ä¼šç”¨åˆ°
```

### 2.3 æ­»ä»£ç æ£€æµ‹æœºåˆ¶


**ğŸ•µï¸ å¦‚ä½•åˆ¤æ–­ä»£ç æ˜¯"æ­»çš„"**

```javascript
// ç¤ºä¾‹ï¼šå“ªäº›ä»£ç ä¼šè¢«è®¤ä¸ºæ˜¯"æ­»ä»£ç "ï¼Ÿ

// 1. å®šä¹‰äº†ä½†ä»æœªè¢«å¼•ç”¨çš„å‡½æ•°
function unusedFunction() {
  return 'nobody calls me';
}

// 2. å¯¼å‡ºäº†ä½†ä»æœªè¢«importçš„å†…å®¹
export const unusedConstant = 'nobody imports me';

// 3. æ¡ä»¶æ°¸è¿œä¸ºfalseçš„ä»£ç å—
if (false) {
  console.log('this will never run');
}

// 4. æ°¸è¿œä¸ä¼šæ‰§è¡Œåˆ°çš„ä»£ç 
function example() {
  return 'early return';
  console.log('unreachable code'); // æ­»ä»£ç 
}
```

---

## 3. ğŸ”§ é…ç½®å’Œä½¿ç”¨æ–¹æ³•


### 3.1 åŸºç¡€é…ç½®è®¾ç½®


**ğŸ“‹ å®Œæ•´é…ç½®ç¤ºä¾‹**

```javascript
// webpack.config.js
module.exports = {
  mode: 'production', // ğŸ”¥ å…³é”®ï¼šå¿…é¡»æ˜¯ç”Ÿäº§æ¨¡å¼
  
  optimization: {
    usedExports: true,     // æ ‡è®°å“ªäº›å¯¼å‡ºè¢«ä½¿ç”¨äº†
    sideEffects: false,    // å‘Šè¯‰webpackæ‰€æœ‰ä»£ç éƒ½æ²¡æœ‰å‰¯ä½œç”¨
    minimize: true,        // å¯ç”¨ä»£ç å‹ç¼©
    minimizer: [
      new TerserPlugin({   // ä»£ç å‹ç¼©æ’ä»¶
        terserOptions: {
          compress: {
            dead_code: true,    // åˆ é™¤æ­»ä»£ç 
            drop_debugger: true, // åˆ é™¤debugger
            drop_console: true,  // åˆ é™¤console.log
          }
        }
      })
    ]
  }
};
```

**ğŸ¯ é…ç½®è§£é‡Š**

| é…ç½®é¡¹ | ä½œç”¨ | ç®€å•ç†è§£ |
|--------|------|----------|
| `mode: 'production'` | å¯ç”¨ç”Ÿäº§æ¨¡å¼ | å‘Šè¯‰webpack"æˆ‘è¦å‘å¸ƒäº†ï¼Œè¯·ä¼˜åŒ–" |
| `usedExports: true` | æ ‡è®°ä½¿ç”¨çš„å¯¼å‡º | ç»™ç”¨åˆ°çš„ä»£ç è´´"æœ‰ç”¨"æ ‡ç­¾ |
| `sideEffects: false` | å£°æ˜æ— å‰¯ä½œç”¨ | å‘Šè¯‰webpack"æ”¾å¿ƒåˆ ï¼Œä¸ä¼šå‡ºé—®é¢˜" |
| `minimize: true` | å¯ç”¨å‹ç¼© | åˆ é™¤ç©ºæ ¼ã€ç®€åŒ–å˜é‡åç­‰ |

### 3.2 sideEffectsè¯¦ç»†é…ç½®


**ğŸ¤” ä»€ä¹ˆæ˜¯å‰¯ä½œç”¨ï¼Ÿ**

```javascript
// æœ‰å‰¯ä½œç”¨çš„ä»£ç ç¤ºä¾‹
import './global-styles.css';  // å¼•å…¥CSSæ–‡ä»¶
import 'polyfills';           // ä¿®æ”¹å…¨å±€å¯¹è±¡

// è¿™äº›ä»£ç è™½ç„¶æ²¡æœ‰returnå€¼ï¼Œä½†ä¼šäº§ç”Ÿ"å‰¯ä½œç”¨"ï¼š
// - ä¿®æ”¹å…¨å±€å˜é‡
// - æ“ä½œDOM
// - å‘é€ç½‘ç»œè¯·æ±‚
// åˆ é™¤å®ƒä»¬ä¼šå¯¼è‡´ç¨‹åºå‡ºé”™ï¼
```

**âš™ï¸ sideEffectsé…ç½®æ–¹æ³•**

```javascript
// package.json - æœ€ç®€å•çš„é…ç½®
{
  "sideEffects": false  // å‘Šè¯‰webpackï¼šæˆ‘çš„ä»£ç éƒ½æ˜¯çº¯å‡½æ•°ï¼Œå¯ä»¥å®‰å…¨åˆ é™¤
}
```

```javascript
// å¦‚æœæœ‰äº›æ–‡ä»¶ç¡®å®æœ‰å‰¯ä½œç”¨ï¼Œè¦æ˜ç¡®æ ‡è®°
{
  "sideEffects": [
    "*.css",                    // æ‰€æœ‰CSSæ–‡ä»¶æœ‰å‰¯ä½œç”¨
    "./src/polyfills.js",       // è¿™ä¸ªæ–‡ä»¶æœ‰å‰¯ä½œç”¨
    "./src/global-setup.js"     // è¿™ä¸ªæ–‡ä»¶æœ‰å‰¯ä½œç”¨
  ]
}
```

**âš ï¸ é…ç½®å»ºè®®**
```
æ–°æ‰‹æ¨èï¼š
1. å…ˆè®¾ç½® "sideEffects": false
2. å¦‚æœå‘ç°é¡µé¢æœ‰é—®é¢˜ï¼Œå†æ·»åŠ å…·ä½“æ–‡ä»¶
3. CSSæ–‡ä»¶é€šå¸¸éƒ½è¦åŠ åˆ°sideEffectsåˆ—è¡¨ä¸­
```

### 3.3 TerserPluginè¯¦ç»†é…ç½®


**ğŸ—œï¸ ä»£ç å‹ç¼©ç¥å™¨**

```javascript
const TerserPlugin = require('terser-webpack-plugin');

module.exports = {
  optimization: {
    minimizer: [
      new TerserPlugin({
        // åŸºç¡€é…ç½®
        parallel: true,          // å¤šçº¿ç¨‹å‹ç¼©ï¼Œæé«˜é€Ÿåº¦
        extractComments: false,  // ä¸æå–æ³¨é‡Šåˆ°å•ç‹¬æ–‡ä»¶
        
        terserOptions: {
          compress: {
            // åˆ é™¤ç±»å‹
            dead_code: true,        // åˆ é™¤ä¸å¯è¾¾ä»£ç 
            drop_console: true,     // åˆ é™¤console.log
            drop_debugger: true,    // åˆ é™¤debuggerè¯­å¥
            pure_funcs: ['console.log'], // æŒ‡å®šè¦åˆ é™¤çš„å‡½æ•°
            
            // ä¼˜åŒ–é€‰é¡¹
            reduce_vars: true,      // ä¼˜åŒ–å˜é‡
            unused: true,          // åˆ é™¤æœªä½¿ç”¨çš„å˜é‡
            conditionals: true,    // ä¼˜åŒ–ifè¯­å¥
            evaluate: true,        // è®¡ç®—å¸¸é‡è¡¨è¾¾å¼
          },
          
          mangle: {
            // å˜é‡åæ··æ·†
            toplevel: true,        // æ··æ·†é¡¶çº§å˜é‡å
            safari10: true,        // è§£å†³Safari 10 bug
          },
          
          format: {
            comments: false,       // åˆ é™¤æ‰€æœ‰æ³¨é‡Š
          }
        }
      })
    ]
  }
};
```

**ğŸ“Š å‹ç¼©æ•ˆæœæ¼”ç¤º**
```javascript
// å‹ç¼©å‰
function calculateTotal(items) {
  let total = 0;
  for (let i = 0; i < items.length; i++) {
    total += items[i].price;
  }
  console.log('Total calculated:', total); // ä¼šè¢«åˆ é™¤
  return total;
}

// å‹ç¼©å
function a(b){let c=0;for(let d=0;d<b.length;d++)c+=b[d].price;return c}
```

---

## 4. ğŸ“¦ ç¬¬ä¸‰æ–¹åº“ä¼˜åŒ–


### 4.1 æŒ‰éœ€å¼•å…¥ç­–ç•¥


**ğŸ¯ lodashä¼˜åŒ–å®æˆ˜**

```javascript
// âŒ é”™è¯¯åšæ³•ï¼šå…¨é‡å¼•å…¥
import _ from 'lodash';          // æ•´ä¸ªlodashåº“ (~500KB)
const result = _.debounce(fn, 300);

// âœ… æ­£ç¡®åšæ³•1ï¼šæŒ‰éœ€å¼•å…¥
import debounce from 'lodash/debounce';  // åªå¼•å…¥debounce (~2KB)
const result = debounce(fn, 300);

// âœ… æ­£ç¡®åšæ³•2ï¼šä½¿ç”¨ESç‰ˆæœ¬
import { debounce } from 'lodash-es';    // æ”¯æŒTree Shaking
const result = debounce(fn, 300);
```

**ğŸ“‹ å¸¸ç”¨åº“çš„Tree Shakingç‰ˆæœ¬**

| åŸå§‹åº“ | Tree Shakingç‰ˆæœ¬ | å®‰è£…å‘½ä»¤ |
|--------|------------------|----------|
| `lodash` | `lodash-es` | `npm install lodash-es` |
| `moment` | `date-fns` | `npm install date-fns` |
| `rxjs` | `rxjs` (æ–°ç‰ˆæœ¬æ”¯æŒ) | `npm install rxjs` |
| `antd` | å†…ç½®æ”¯æŒ | é…ç½®babel-plugin-import |

### 4.2 ç»„ä»¶åº“æŒ‰éœ€å¼•å…¥


**ğŸ¨ Element PlusæŒ‰éœ€å¼•å…¥**

```javascript
// å®‰è£…æŒ‰éœ€å¼•å…¥æ’ä»¶
npm install unplugin-auto-import unplugin-vue-components -D

// vite.config.js æˆ– webpacké…ç½®
import AutoImport from 'unplugin-auto-import/vite'
import Components from 'unplugin-vue-components/vite'
import { ElementPlusResolver } from 'unplugin-vue-components/resolvers'

export default {
  plugins: [
    AutoImport({
      resolvers: [ElementPlusResolver()],
    }),
    Components({
      resolvers: [ElementPlusResolver()],
    }),
  ],
}
```

```vue
<!-- ä½¿ç”¨æ—¶ç›´æ¥å†™ç»„ä»¶ï¼Œè‡ªåŠ¨æŒ‰éœ€å¼•å…¥ -->
<template>
  <el-button>æŒ‰é’®</el-button>  <!-- åªä¼šæ‰“åŒ…buttonç»„ä»¶ -->
  <el-input v-model="text"/>   <!-- åªä¼šæ‰“åŒ…inputç»„ä»¶ -->
</template>
```

### 4.3 æ£€æŸ¥ç¬¬ä¸‰æ–¹åº“æ”¯æŒ


**ğŸ” å¦‚ä½•åˆ¤æ–­åº“æ˜¯å¦æ”¯æŒTree Shaking**

```javascript
// 1. æŸ¥çœ‹package.json
{
  "module": "dist/index.esm.js",  // âœ… æ”¯æŒESæ¨¡å—
  "sideEffects": false            // âœ… å£°æ˜æ— å‰¯ä½œç”¨
}

// 2. æŸ¥çœ‹å¯¼å…¥è¯­æ³•
import { specific } from 'library';     // âœ… å…·åå¯¼å…¥é€šå¸¸æ”¯æŒ
import library from 'library';          // âŒ é»˜è®¤å¯¼å…¥é€šå¸¸ä¸æ”¯æŒ
```

---

## 5. ğŸš€ é«˜çº§ä¼˜åŒ–æŠ€å·§


### 5.1 Scope HoistingæŠ€æœ¯


**ğŸ”— æ¨¡å—æå‡ä¼˜åŒ–**

```javascript
// webpack.config.js
module.exports = {
  optimization: {
    concatenateModules: true,  // å¯ç”¨Scope Hoisting
  }
};
```

**ğŸ“ˆ ä¼˜åŒ–æ•ˆæœæ¼”ç¤º**
```javascript
// ä¼˜åŒ–å‰ï¼šæ¯ä¸ªæ¨¡å—éƒ½æœ‰è‡ªå·±çš„ä½œç”¨åŸŸ
(function(module, exports) {
  // moduleA.js
  exports.value = 42;
})();

(function(module, exports) {
  // moduleB.js  
  const moduleA = require('./moduleA');
  exports.result = moduleA.value * 2;
})();

// ä¼˜åŒ–åï¼šåˆå¹¶åˆ°åŒä¸€ä¸ªä½œç”¨åŸŸ
(function() {
  var value = 42;
  var result = value * 2;
})();
```

**âš¡ å¥½å¤„è¯´æ˜**
- å‡å°‘å‡½æ•°åŒ…è£…ä»£ç 
- æé«˜è¿è¡Œæ—¶æ€§èƒ½
- è¿›ä¸€æ­¥å‡å°æ–‡ä»¶ä½“ç§¯

### 5.2 åŒ…å¤§å°åˆ†æå·¥å…·


**ğŸ“Š webpack-bundle-analyzerä½¿ç”¨**

```bash
# å®‰è£…åˆ†æå·¥å…·
npm install webpack-bundle-analyzer -D
```

```javascript
// webpack.config.js
const BundleAnalyzerPlugin = require('webpack-bundle-analyzer').BundleAnalyzerPlugin;

module.exports = {
  plugins: [
    new BundleAnalyzerPlugin({
      analyzerMode: 'static',        // ç”ŸæˆHTMLæŠ¥å‘Š
      openAnalyzer: true,           // è‡ªåŠ¨æ‰“å¼€æŠ¥å‘Š
      reportFilename: 'bundle-report.html'
    })
  ]
};
```

**ğŸ¯ åˆ†ææŠ¥å‘Šè§£è¯»**
```
æŠ¥å‘Šæ˜¾ç¤ºå†…å®¹ï¼š
ğŸ“¦ æ¯ä¸ªæ¨¡å—çš„å¤§å°å æ¯”
ğŸ¯ å“ªäº›åº“å ç”¨ç©ºé—´æœ€å¤§  
ğŸ” é‡å¤æ‰“åŒ…çš„ä»£ç 
âš¡ ä¼˜åŒ–å»ºè®®å’Œæ–¹å‘

çœ‹æ‡‚æŠ¥å‘Šçš„å…³é”®ï¼š
- å¤§çš„è‰²å— = å ç”¨ç©ºé—´å¤§çš„æ¨¡å—
- ç‚¹å‡»å¯ä»¥æ·±å…¥æŸ¥çœ‹ç»†èŠ‚
- é‡ç‚¹å…³æ³¨æ„å¤–å¤§çš„æ¨¡å—
```

### 5.3 æ„å»ºé€Ÿåº¦ä¼˜åŒ–


**âš¡ åŠ å¿«Tree Shakingå¤„ç†é€Ÿåº¦**

```javascript
module.exports = {
  optimization: {
    // åªåœ¨ç”Ÿäº§ç¯å¢ƒå¯ç”¨å®Œæ•´ä¼˜åŒ–
    usedExports: process.env.NODE_ENV === 'production',
    
    // ä½¿ç”¨ç¼“å­˜
    splitChunks: {
      chunks: 'all',
      cacheGroups: {
        vendor: {
          test: /[\\/]node_modules[\\/]/,
          name: 'vendors',
          chunks: 'all',
        }
      }
    }
  },
  
  // ç¼“å­˜é…ç½®
  cache: {
    type: 'filesystem',           // ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿç¼“å­˜
    buildDependencies: {
      config: [__filename],       // é…ç½®æ–‡ä»¶å˜åŒ–æ—¶é‡æ–°æ„å»º
    }
  }
};
```

---

## 6. ğŸ¯ å®æˆ˜æ¡ˆä¾‹åˆ†æ


### 6.1 çœŸå®é¡¹ç›®ä¼˜åŒ–æ¡ˆä¾‹


**ğŸ“‹ ä¼˜åŒ–å‰åå¯¹æ¯”**

```
ä¼˜åŒ–å‰é¡¹ç›®çŠ¶æ€ï¼š
ğŸ“¦ æ€»åŒ…å¤§å°ï¼š2.5MB
â±ï¸ é¦–é¡µåŠ è½½æ—¶é—´ï¼š8ç§’
ğŸ“Š ä¸»è¦é—®é¢˜ï¼š
   - å®Œæ•´å¼•å…¥lodashï¼š500KB
   - å…¨é‡å¼•å…¥Element UIï¼š800KB
   - æœªå¯ç”¨Tree Shakingï¼šå¤šä½™ä»£ç 300KB
```

**ğŸ”§ ä¼˜åŒ–æ­¥éª¤**

```javascript
// æ­¥éª¤1ï¼šå¯ç”¨Tree ShakingåŸºç¡€é…ç½®
module.exports = {
  mode: 'production',
  optimization: {
    usedExports: true,
    sideEffects: false,
  }
};

// æ­¥éª¤2ï¼šä¿®æ”¹åº“å¼•å…¥æ–¹å¼
// å‰ï¼šimport _ from 'lodash';
// åï¼šimport { debounce, throttle } from 'lodash-es';

// æ­¥éª¤3ï¼šé…ç½®æŒ‰éœ€å¼•å…¥
// Element UIæŒ‰éœ€å¼•å…¥é…ç½®...

// æ­¥éª¤4ï¼šæ·»åŠ ä»£ç å‹ç¼©
// TerserPluginé…ç½®...
```

**ğŸ“Š ä¼˜åŒ–ç»“æœ**
```
ä¼˜åŒ–åé¡¹ç›®çŠ¶æ€ï¼š
ğŸ“¦ æ€»åŒ…å¤§å°ï¼š800KB (å‡å°‘68%)
â±ï¸ é¦–é¡µåŠ è½½æ—¶é—´ï¼š3ç§’ (æå‡62%)
ğŸš€ å…·ä½“æ”¹è¿›ï¼š
   - lodashï¼š500KB â†’ 50KB (å‡å°‘90%)
   - Element UIï¼š800KB â†’ 200KB (å‡å°‘75%)
   - æ­»ä»£ç æ¶ˆé™¤ï¼š300KB â†’ 0KB (å‡å°‘100%)
```

### 6.2 å¸¸è§é—®é¢˜æ’æŸ¥


**ğŸ› Tree Shakingä¸ç”Ÿæ•ˆçš„åŸå› **

```javascript
// é—®é¢˜1ï¼šå¼€å‘æ¨¡å¼ä¸‹ä¸ä¼šå®Œå…¨ç”Ÿæ•ˆ
// âŒ é”™è¯¯
mode: 'development'  // Tree Shakingæ•ˆæœæœ‰é™

// âœ… æ­£ç¡®  
mode: 'production'   // å®Œæ•´çš„Tree Shaking

// é—®é¢˜2ï¼šä½¿ç”¨äº†CommonJSè¯­æ³•
// âŒ é”™è¯¯
const { debounce } = require('lodash');

// âœ… æ­£ç¡®
import { debounce } from 'lodash-es';

// é—®é¢˜3ï¼šå‰¯ä½œç”¨é…ç½®é”™è¯¯
// âŒ é”™è¯¯ï¼šCSSæ–‡ä»¶è¢«åˆ é™¤äº†
"sideEffects": false

// âœ… æ­£ç¡®ï¼šä¿ç•™CSSæ–‡ä»¶
"sideEffects": ["*.css", "*.scss"]
```

**ğŸ” è°ƒè¯•æ£€æŸ¥æ–¹æ³•**

```bash
# 1. æ£€æŸ¥æ„å»ºè¾“å‡º
npm run build -- --verbose

# 2. ä½¿ç”¨åˆ†æå·¥å…·
npx webpack-bundle-analyzer dist/static/js/*.js

# 3. æŸ¥çœ‹ä¼˜åŒ–ä¿¡æ¯
npx webpack --mode=production --optimize-minimize --json > stats.json
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Tree Shakingæœ¬è´¨ï¼šåˆ é™¤é¡¹ç›®ä¸­æœªä½¿ç”¨çš„æ­»ä»£ç 
ğŸ”¸ å·¥ä½œåŸç†ï¼šåŸºäºESæ¨¡å—çš„é™æ€åˆ†æ
ğŸ”¸ é…ç½®è¦ç‚¹ï¼šmodeã€usedExportsã€sideEffectsã€minimize
ğŸ”¸ ç¬¬ä¸‰æ–¹åº“ä¼˜åŒ–ï¼šæŒ‰éœ€å¼•å…¥ã€é€‰æ‹©æ”¯æŒTree Shakingçš„ç‰ˆæœ¬
ğŸ”¸ æ•ˆæœæ£€éªŒï¼šä½¿ç”¨bundleåˆ†æå·¥å…·éªŒè¯ä¼˜åŒ–æ•ˆæœ
```

### 7.2 å…³é”®é…ç½®æ¸…å•


**âœ… Tree Shakingå®Œæ•´é…ç½®æ£€æŸ¥å•**

```javascript
// webpack.config.jsæ£€æŸ¥é¡¹
â˜‘ mode: 'production'                    // ç”Ÿäº§æ¨¡å¼
â˜‘ optimization.usedExports: true        // æ ‡è®°ä½¿ç”¨çš„å¯¼å‡º  
â˜‘ optimization.sideEffects: false       // å£°æ˜æ— å‰¯ä½œç”¨
â˜‘ optimization.minimize: true           // å¯ç”¨å‹ç¼©
â˜‘ TerserPluginé…ç½®                      // ä»£ç å‹ç¼©æ’ä»¶

// package.jsonæ£€æŸ¥é¡¹  
â˜‘ "sideEffects": false æˆ– å…·ä½“æ–‡ä»¶åˆ—è¡¨   // å‰¯ä½œç”¨å£°æ˜
â˜‘ "type": "module" (å¯é€‰)               // ESæ¨¡å—æ”¯æŒ

// ä»£ç æ£€æŸ¥é¡¹
â˜‘ ä½¿ç”¨import/exportè¯­æ³•                 // ESæ¨¡å—è¯­æ³•
â˜‘ é¿å…importæ•´ä¸ªåº“                      // æŒ‰éœ€å¼•å…¥
â˜‘ é€‰æ‹©æ”¯æŒTree Shakingçš„åº“ç‰ˆæœ¬          // åº“é€‰æ‹©
```

### 7.3 å®ç”¨è®°å¿†è¦ç‚¹


**ğŸ¯ Tree Shakingè®°å¿†å£è¯€**
```
ç”Ÿäº§æ¨¡å¼è¦å¼€å¯ï¼ŒESæ¨¡å—æ˜¯åŸºç¡€
æŒ‰éœ€å¼•å…¥ç¬¬ä¸‰æ–¹ï¼Œå‰¯ä½œç”¨è¦æ ‡æ˜
ä»£ç å‹ç¼©é…TerserPluginï¼ŒåŒ…åˆ†ææ¥éªŒè¯
æ­»ä»£ç è‡ªåŠ¨æ¸…ç†ï¼Œé¡¹ç›®ä½“ç§¯å¤§å¹…å‡
```

**âš ï¸ æ–°æ‰‹é¿å‘æŒ‡å—**
```
å¸¸è§é”™è¯¯ï¼š
âŒ å¼€å‘æ¨¡å¼ä¸‹æµ‹è¯•Tree Shakingæ•ˆæœ
âŒ ä½¿ç”¨requireè¯­æ³•å¼•å…¥æ¨¡å—  
âŒ å‰¯ä½œç”¨é…ç½®è¿‡äºæ¿€è¿›å¯¼è‡´CSSè¢«åˆ é™¤
âŒ å¿˜è®°æ£€æŸ¥ç¬¬ä¸‰æ–¹åº“æ˜¯å¦æ”¯æŒTree Shaking

æ­£ç¡®åšæ³•ï¼š
âœ… ç”Ÿäº§æ¨¡å¼ä¸‹éªŒè¯æ•ˆæœ
âœ… ç»Ÿä¸€ä½¿ç”¨ESæ¨¡å—è¯­æ³•
âœ… è°¨æ…é…ç½®sideEffects
âœ… é€‰æ‹©åˆé€‚çš„åº“ç‰ˆæœ¬
```

### 7.4 æ€§èƒ½ä¼˜åŒ–å»ºè®®


**ğŸ“ˆ ä¼˜åŒ–ä¼˜å…ˆçº§æ’åº**

| ä¼˜å…ˆçº§ | ä¼˜åŒ–é¡¹ç›® | é¢„æœŸæ•ˆæœ | å®æ–½éš¾åº¦ |
|--------|----------|----------|----------|
| ğŸ”¥ é«˜ | å¯ç”¨Tree ShakingåŸºç¡€é…ç½® | å‡å°‘20-40% | â­ ç®€å• |
| ğŸ”¥ é«˜ | ç¬¬ä¸‰æ–¹åº“æŒ‰éœ€å¼•å…¥ | å‡å°‘50-80% | â­â­ ä¸­ç­‰ |
| ğŸ”¥ é«˜ | ä»£ç å‹ç¼©ä¼˜åŒ– | å‡å°‘30-50% | â­ ç®€å• |
| ğŸŸ¡ ä¸­ | Scope Hoisting | å‡å°‘5-10% | â­â­ ä¸­ç­‰ |
| ğŸŸ¡ ä¸­ | æ„å»ºç¼“å­˜ä¼˜åŒ– | æå‡æ„å»ºé€Ÿåº¦ | â­â­â­ å¤æ‚ |

**ğŸš€ æ¸è¿›å¼ä¼˜åŒ–ç­–ç•¥**
```
ç¬¬1é˜¶æ®µï¼šåŸºç¡€é…ç½® (1å¤©)
- å¯ç”¨productionæ¨¡å¼
- é…ç½®usedExportså’ŒsideEffects
- æ·»åŠ TerserPlugin

ç¬¬2é˜¶æ®µï¼šåº“ä¼˜åŒ– (2-3å¤©)  
- æ’æŸ¥å¤§ä½“ç§¯ç¬¬ä¸‰æ–¹åº“
- å®æ–½æŒ‰éœ€å¼•å…¥
- æ›´æ¢æ”¯æŒTree Shakingçš„åº“

ç¬¬3é˜¶æ®µï¼šæ·±åº¦ä¼˜åŒ– (1å‘¨)
- å¯ç”¨Scope Hoisting
- ä¼˜åŒ–æ„å»ºé…ç½®
- æŒç»­ç›‘æ§å’Œè°ƒä¼˜
```

**æ ¸å¿ƒç†è§£**ï¼š
- Tree Shakingæ˜¯ç°ä»£å‰ç«¯æ„å»ºçš„æ ‡å‡†åŠŸèƒ½ï¼Œä¸ç”¨åˆ™æµªè´¹
- é…ç½®ç®€å•ä½†æ•ˆæœæ˜¾è‘—ï¼Œæ˜¯æ€§ä»·æ¯”æœ€é«˜çš„ä¼˜åŒ–æ‰‹æ®µ
- ç¬¬ä¸‰æ–¹åº“çš„é€‰æ‹©å’Œä½¿ç”¨æ–¹å¼å¯¹æ•ˆæœå½±å“æœ€å¤§
- éœ€è¦åœ¨å¼€å‘ä½“éªŒå’Œæ„å»ºæ•ˆæœä¹‹é—´æ‰¾åˆ°å¹³è¡¡ç‚¹