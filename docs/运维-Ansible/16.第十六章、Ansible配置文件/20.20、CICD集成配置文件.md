---
title: 20ã€CICDé›†æˆé…ç½®æ–‡ä»¶
---
## ğŸ“š ç›®å½•

1. [CI/CDé›†æˆåŸºç¡€æ¦‚å¿µ](#1-cicdé›†æˆåŸºç¡€æ¦‚å¿µ)
2. [Jenkinsæµæ°´çº¿é›†æˆ](#2-jenkinsæµæ°´çº¿é›†æˆ)
3. [GitLab CIé›†æˆé…ç½®](#3-gitlab-cié›†æˆé…ç½®)
4. [GitHub Actionsé›†æˆ](#4-github-actionsé›†æˆ)
5. [Ansibleç®¡ç†å¹³å°é…ç½®](#5-ansibleç®¡ç†å¹³å°é…ç½®)
6. [Webhookä¸APIé›†æˆ](#6-webhookä¸apié›†æˆ)
7. [é€šçŸ¥ä¸åˆ¶å“ç®¡ç†](#7-é€šçŸ¥ä¸åˆ¶å“ç®¡ç†)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”„ CI/CDé›†æˆåŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯CI/CDä¸Ansibleé›†æˆ


**ğŸ¯ é€šä¿—ç†è§£**
æƒ³è±¡ä½ åœ¨å¼€å‘ä¸€ä¸ªç½‘ç«™åº”ç”¨ï¼Œæ¯æ¬¡ä»£ç æ›´æ–°åéƒ½éœ€è¦ï¼š
- æµ‹è¯•ä»£ç æ˜¯å¦æ­£ç¡®
- æ‰“åŒ…åº”ç”¨ç¨‹åº
- éƒ¨ç½²åˆ°æœåŠ¡å™¨
- é‡å¯ç›¸å…³æœåŠ¡

å¦‚æœæ‰‹åŠ¨æ“ä½œï¼Œä¸ä»…ç¹çè¿˜å®¹æ˜“å‡ºé”™ã€‚**CI/CDé›†æˆ**å°±æ˜¯è®©è¿™ä¸ªè¿‡ç¨‹è‡ªåŠ¨åŒ–ï¼š

```
ä»£ç æäº¤ â†’ è‡ªåŠ¨æµ‹è¯• â†’ è‡ªåŠ¨æ‰“åŒ… â†’ Ansibleè‡ªåŠ¨éƒ¨ç½² â†’ æœåŠ¡ä¸Šçº¿
```

### 1.2 æ ¸å¿ƒæ¦‚å¿µè§£é‡Š


**CI (æŒç»­é›†æˆ)**
- **å«ä¹‰**ï¼šä»£ç ä¸€æäº¤å°±è‡ªåŠ¨è¿›è¡Œæ„å»ºå’Œæµ‹è¯•
- **ä½œç”¨**ï¼šåŠæ—©å‘ç°é—®é¢˜ï¼Œç¡®ä¿ä»£ç è´¨é‡
- **æ¯”å–»**ï¼šåƒå·¥å‚çš„è´¨æ£€æµæ°´çº¿ï¼Œæ¯ä¸ªäº§å“éƒ½è¦æ£€æŸ¥

**CD (æŒç»­éƒ¨ç½²/äº¤ä»˜)**
- **å«ä¹‰**ï¼šé€šè¿‡æµ‹è¯•çš„ä»£ç è‡ªåŠ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
- **ä½œç”¨**ï¼šå¿«é€Ÿã€å®‰å…¨åœ°å‘å¸ƒæ–°åŠŸèƒ½
- **æ¯”å–»**ï¼šåƒå¿«é€’ç³»ç»Ÿï¼ŒåŒ…è£…å¥½çš„å•†å“è‡ªåŠ¨é€åˆ°ç”¨æˆ·æ‰‹ä¸­

### 1.3 Ansibleåœ¨CI/CDä¸­çš„ä½œç”¨


```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CI/CDå¹³å°     â”‚    â”‚    Ansible      â”‚    â”‚   ç›®æ ‡æœåŠ¡å™¨     â”‚
â”‚   (Jenkinsç­‰)   â”‚â”€â”€â”€â†’â”‚   (æ‰§è¡Œéƒ¨ç½²)     â”‚â”€â”€â”€â†’â”‚   (åº”ç”¨è¿è¡Œ)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     è§¦å‘éƒ¨ç½²              æ‰§è¡ŒPlaybook          å®Œæˆéƒ¨ç½²
```

**ğŸ”¸ Ansibleçš„ä¼˜åŠ¿**
- **ç»Ÿä¸€éƒ¨ç½²**ï¼šä¸€å¥—è„šæœ¬ç®¡ç†å¤šå°æœåŠ¡å™¨
- **å¹‚ç­‰æ€§**ï¼šé‡å¤æ‰§è¡Œç»“æœä¸€è‡´ï¼Œå®‰å…¨å¯é 
- **æ— ä»£ç†**ï¼šä¸éœ€è¦åœ¨ç›®æ ‡æœåŠ¡å™¨å®‰è£…é¢å¤–è½¯ä»¶

---

## 2. ğŸš€ Jenkinsæµæ°´çº¿é›†æˆ


### 2.1 Jenkins PipelineåŸºç¡€é…ç½®


**ä»€ä¹ˆæ˜¯Jenkins Pipelineï¼Ÿ**
Jenkins Pipelineå°±åƒä¸€ä¸ª**ç”Ÿäº§æµæ°´çº¿**ï¼Œå®šä¹‰äº†ä»ä»£ç åˆ°éƒ¨ç½²çš„å®Œæ•´è¿‡ç¨‹ã€‚

**ğŸ“‹ åŸºç¡€Pipelineé…ç½®**

```groovy
// Jenkinsfile - å®šä¹‰éƒ¨ç½²æµæ°´çº¿
pipeline {
    agent any
    
    stages {
        stage('æ£€å‡ºä»£ç ') {
            steps {
                git 'https://github.com/your-repo/app.git'
            }
        }
        
        stage('æ„å»ºåº”ç”¨') {
            steps {
                sh 'mvn clean package'
            }
        }
        
        stage('Ansibleéƒ¨ç½²') {
            steps {
                ansiblePlaybook(
                    playbook: 'deploy.yml',
                    inventory: 'inventory/production',
                    credentialsId: 'ansible-ssh-key'
                )
            }
        }
    }
}
```

### 2.2 Jenkinsä¸­çš„Ansibleé…ç½®


**ğŸ”§ Jenkins Ansibleæ’ä»¶é…ç½®**

```yaml
# jenkins-ansible-config.yml
---
- name: Jenkinsé›†æˆAnsibleé…ç½®ç¤ºä¾‹
  hosts: localhost
  vars:
    jenkins_home: "/var/lib/jenkins"
    ansible_config_path: "{{ jenkins_home }}/ansible"
    
  tasks:
    - name: åˆ›å»ºAnsibleé…ç½®ç›®å½•
      file:
        path: "{{ ansible_config_path }}"
        state: directory
        
    - name: é…ç½®Ansibleä¸»æœºæ¸…å•
      copy:
        content: |
          [production]
          web1 ansible_host=192.168.1.10
          web2 ansible_host=192.168.1.11
          
          [staging]  
          test1 ansible_host=192.168.1.20
        dest: "{{ ansible_config_path }}/inventory"
```

### 2.3 Jenkinsç¯å¢ƒå˜é‡é…ç½®


**ğŸŒŸ å…³é”®é…ç½®è¯´æ˜**

| é…ç½®é¡¹ | **ä½œç”¨è¯´æ˜** | **ç¤ºä¾‹å€¼** |
|--------|-------------|-----------|
| `ANSIBLE_HOST_KEY_CHECKING` | **è·³è¿‡SSHå¯†é’¥æ£€æŸ¥** | `False` |
| `ANSIBLE_STDOUT_CALLBACK` | **è¾“å‡ºæ ¼å¼ç¾åŒ–** | `yaml` |
| `ANSIBLE_GATHERING` | **ä¿¡æ¯æ”¶é›†ç­–ç•¥** | `smart` |

```bash
# Jenkinsç¯å¢ƒå˜é‡è®¾ç½®
export ANSIBLE_HOST_KEY_CHECKING=False
export ANSIBLE_STDOUT_CALLBACK=yaml
export ANSIBLE_GATHERING=smart
export ANSIBLE_TIMEOUT=30
```

---

## 3. ğŸ¦Š GitLab CIé›†æˆé…ç½®


### 3.1 GitLab CIåŸºç¡€æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯GitLab CIï¼Ÿ**
GitLab CIæ˜¯GitLabå†…ç½®çš„**è‡ªåŠ¨åŒ–å·¥å…·**ï¼Œå°±åƒç»™ä½ çš„ä»£ç ä»“åº“é…äº†ä¸€ä¸ª**æ™ºèƒ½åŠ©æ‰‹**ï¼Œä»£ç ä¸€æ›´æ–°å°±è‡ªåŠ¨æ‰§è¡Œé¢„å®šçš„ä»»åŠ¡ã€‚

### 3.2 .gitlab-ci.ymlé…ç½®è¯¦è§£


```yaml
# .gitlab-ci.yml - GitLab CIé…ç½®æ–‡ä»¶
stages:
  - test      # æµ‹è¯•é˜¶æ®µ
  - build     # æ„å»ºé˜¶æ®µ  
  - deploy    # éƒ¨ç½²é˜¶æ®µ

variables:
  ANSIBLE_HOST_KEY_CHECKING: "False"
  ANSIBLE_FORCE_COLOR: "True"

# æµ‹è¯•ä»»åŠ¡
test_job:
  stage: test
  script:
    - echo "è¿è¡Œå•å…ƒæµ‹è¯•"
    - npm test
  only:
    - branches  # åªåœ¨åˆ†æ”¯æ¨é€æ—¶æ‰§è¡Œ

# æ„å»ºä»»åŠ¡
build_job:
  stage: build
  script:
    - echo "æ„å»ºåº”ç”¨ç¨‹åº"
    - npm run build
  artifacts:    # ä¿å­˜æ„å»ºäº§ç‰©
    paths:
      - dist/
    expire_in: 1 hour

# Ansibleéƒ¨ç½²ä»»åŠ¡
deploy_production:
  stage: deploy
  image: ansible/ansible:latest  # ä½¿ç”¨Ansibleé•œåƒ
  before_script:
    - eval $(ssh-agent -s)
    - ssh-add <(echo "$SSH_PRIVATE_KEY")
  script:
    - ansible-playbook -i inventory/production deploy.yml
  only:
    - main    # åªåœ¨mainåˆ†æ”¯æ‰§è¡Œç”Ÿäº§éƒ¨ç½²
```

### 3.3 GitLab Runneré…ç½®


**ğŸ”¸ Runneræ³¨å†Œé…ç½®**

```bash
# æ³¨å†ŒGitLab Runner
gitlab-runner register \
  --url "https://gitlab.com/" \
  --registration-token "$RUNNER_TOKEN" \
  --description "ansible-runner" \
  --tag-list "ansible,deploy" \
  --executor "docker"
```

**ğŸ”¸ Runneré…ç½®æ–‡ä»¶**

```toml
# /etc/gitlab-runner/config.toml
[[runners]]
  name = "ansible-deploy-runner"
  url = "https://gitlab.com/"
  token = "your-token"
  executor = "docker"
  [runners.docker]
    image = "ansible/ansible:latest"
    volumes = ["/cache", "/var/run/docker.sock:/var/run/docker.sock"]
```

---

## 4. ğŸ™ GitHub Actionsé›†æˆ


### 4.1 GitHub Actionså·¥ä½œåŸç†


**é€šä¿—è§£é‡Š**
GitHub Actionså°±åƒç»™ä½ çš„GitHubä»“åº“é›‡äº†ä¸€ä¸ª**å…¨èŒåŠ©æ‰‹**ï¼š
- ä»£ç ä¸€æ¨é€ï¼ŒåŠ©æ‰‹å°±å¼€å§‹å·¥ä½œ
- æŒ‰ç…§ä½ å†™çš„"å·¥ä½œæ¸…å•"(workflow)æ‰§è¡Œä»»åŠ¡
- å¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡(å¹¶è¡Œæ‰§è¡Œ)

### 4.2 Workflowé…ç½®æ–‡ä»¶


```yaml
# .github/workflows/deploy.yml
name: Ansibleéƒ¨ç½²å·¥ä½œæµ

on:
  push:
    branches: [ main ]    # mainåˆ†æ”¯æ¨é€æ—¶è§¦å‘
  pull_request:
    branches: [ main ]    # PRæ—¶è§¦å‘

jobs:
  deploy:
    runs-on: ubuntu-latest    # è¿è¡Œç¯å¢ƒ
    
    steps:
    - name: æ£€å‡ºä»£ç 
      uses: actions/checkout@v3
      
    - name: è®¾ç½®Pythonç¯å¢ƒ
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
        
    - name: å®‰è£…Ansible
      run: |
        python -m pip install --upgrade pip
        pip install ansible
        
    - name: é…ç½®SSHå¯†é’¥
      env:
        SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}
      run: |
        mkdir -p ~/.ssh
        echo "$SSH_PRIVATE_KEY" > ~/.ssh/id_rsa
        chmod 600 ~/.ssh/id_rsa
        ssh-keyscan -H your-server.com >> ~/.ssh/known_hosts
        
    - name: æ‰§è¡ŒAnsibleéƒ¨ç½²
      run: |
        ansible-playbook -i inventory/production deploy.yml
```

### 4.3 Secretsç®¡ç†


**ğŸ” æ•æ„Ÿä¿¡æ¯ç®¡ç†**

GitHub Actionsæä¾›äº†**SecretsåŠŸèƒ½**æ¥å®‰å…¨å­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼š

```
ä»“åº“è®¾ç½® â†’ Secrets and variables â†’ Actions â†’ New repository secret
```

**å¸¸ç”¨Secretsé…ç½®**

| Secretåç§° | **ç”¨é€”è¯´æ˜** | **ç¤ºä¾‹å†…å®¹** |
|-----------|-------------|-------------|
| `SSH_PRIVATE_KEY` | **æœåŠ¡å™¨SSHç§é’¥** | `-----BEGIN RSA PRIVATE KEY-----` |
| `ANSIBLE_VAULT_PASSWORD` | **Ansible Vaultå¯†ç ** | `your-vault-password` |
| `DOCKER_PASSWORD` | **Dockerä»“åº“å¯†ç ** | `docker-hub-password` |

---

## 5. ğŸ—ï¸ Ansibleç®¡ç†å¹³å°é…ç½®


### 5.1 AWX/Ansible Toweræ¦‚å¿µ


**ä»€ä¹ˆæ˜¯AWXï¼Ÿ**
AWXæ˜¯Ansibleçš„**Webç®¡ç†ç•Œé¢**ï¼Œå°±åƒç»™å‘½ä»¤è¡Œå·¥å…·åŠ äº†ä¸€ä¸ª**å›¾å½¢åŒ–æ“ä½œå°**ï¼š

```
å‘½ä»¤è¡ŒAnsibleï¼šéœ€è¦è®°ä½å¾ˆå¤šå‘½ä»¤ï¼Œé€‚åˆä¸“å®¶ä½¿ç”¨
AWXç•Œé¢ï¼š    ç‚¹å‡»æŒ‰é’®å°±èƒ½æ“ä½œï¼Œå›¢é˜Ÿåä½œæ›´æ–¹ä¾¿
```

### 5.2 AWXé›†æˆé…ç½®


**ğŸ”§ AWXé¡¹ç›®é…ç½®**

```yaml
# awx-project-config.yml
---
- name: é…ç½®AWXé¡¹ç›®
  hosts: localhost
  vars:
    awx_url: "https://awx.example.com"
    awx_username: "admin"
    awx_password: "{{ vault_awx_password }}"
    
  tasks:
    - name: åˆ›å»ºé¡¹ç›®
      awx.awx.project:
        name: "Webåº”ç”¨éƒ¨ç½²"
        description: "Webåº”ç”¨è‡ªåŠ¨åŒ–éƒ¨ç½²é¡¹ç›®"
        organization: "ITéƒ¨é—¨"
        scm_type: git
        scm_url: "https://github.com/company/ansible-playbooks.git"
        scm_branch: main
        
    - name: åˆ›å»ºæ¸…å•
      awx.awx.inventory:
        name: "ç”Ÿäº§ç¯å¢ƒ"
        description: "ç”Ÿäº§æœåŠ¡å™¨æ¸…å•"
        organization: "ITéƒ¨é—¨"
        
    - name: åˆ›å»ºä½œä¸šæ¨¡æ¿
      awx.awx.job_template:
        name: "éƒ¨ç½²Webåº”ç”¨"
        job_type: run
        project: "Webåº”ç”¨éƒ¨ç½²"
        playbook: "deploy-web.yml"
        inventory: "ç”Ÿäº§ç¯å¢ƒ"
```

### 5.3 Ansible Runneré…ç½®


**ğŸƒâ€â™‚ï¸ RunneråŸºç¡€é…ç½®**

```yaml
# ansible-runner-config.yml
---
runner_settings:
  # å·¥ä½œç›®å½•è®¾ç½®
  project_dir: "/opt/ansible-runner/projects"
  artifact_dir: "/opt/ansible-runner/artifacts"
  
  # æ‰§è¡Œè®¾ç½®
  timeout: 3600        # è¶…æ—¶æ—¶é—´(ç§’)
  verbosity: 2         # è¯¦ç»†è¾“å‡ºçº§åˆ«
  
  # å¹¶å‘è®¾ç½®
  forks: 10           # å¹¶è¡Œæ‰§è¡Œæ•°é‡
  
# ç¯å¢ƒå˜é‡é…ç½®
environment:
  ANSIBLE_HOST_KEY_CHECKING: "False"
  ANSIBLE_STDOUT_CALLBACK: "json"
  PYTHONPATH: "/opt/ansible-runner/lib"
```

---

## 6. ğŸ”— Webhookä¸APIé›†æˆ


### 6.1 Webhooké›†æˆåŸç†


**ä»€ä¹ˆæ˜¯Webhookï¼Ÿ**
Webhookå°±åƒ**é—¨é“ƒç³»ç»Ÿ**ï¼š
- æœ‰äº‹ä»¶å‘ç”Ÿæ—¶(æ¯”å¦‚ä»£ç æäº¤)ï¼Œç³»ç»Ÿä¼š"æŒ‰é—¨é“ƒ"
- AnsibleæœåŠ¡å™¨"å¬åˆ°é—¨é“ƒ"å°±å¼€å§‹æ‰§è¡Œéƒ¨ç½²ä»»åŠ¡
- æ•´ä¸ªè¿‡ç¨‹æ— éœ€äººå·¥å¹²é¢„

**ğŸ”„ Webhookå·¥ä½œæµç¨‹**

```
GitHub/GitLab â†’ æ¨é€ä»£ç  â†’ è§¦å‘Webhook â†’ AnsibleæœåŠ¡å™¨ â†’ æ‰§è¡Œéƒ¨ç½²
     |              |              |              |
   å¼€å‘è€…        ä»£ç å˜æ›´         HTTPè¯·æ±‚       è‡ªåŠ¨éƒ¨ç½²
```

### 6.2 Webhookæ¥æ”¶é…ç½®


```python
# webhook-receiver.py - Webhookæ¥æ”¶æœåŠ¡
from flask import Flask, request
import subprocess
import os

app = Flask(__name__)

@app.route('/webhook', methods=['POST'])
def handle_webhook():
    """å¤„ç†Webhookè¯·æ±‚"""
    
    # éªŒè¯è¯·æ±‚æ¥æº
    if request.headers.get('X-GitHub-Event') == 'push':
        
        # è·å–æ¨é€ä¿¡æ¯
        data = request.json
        branch = data['ref'].split('/')[-1]
        
        # åªåœ¨mainåˆ†æ”¯æ‰§è¡Œéƒ¨ç½²
        if branch == 'main':
            try:
                # æ‰§è¡ŒAnsibleéƒ¨ç½²
                result = subprocess.run([
                    'ansible-playbook', 
                    '-i', 'inventory/production',
                    'deploy.yml'
                ], capture_output=True, text=True)
                
                return f"éƒ¨ç½²æˆåŠŸ: {result.stdout}", 200
                
            except Exception as e:
                return f"éƒ¨ç½²å¤±è´¥: {str(e)}", 500
        
        return "émainåˆ†æ”¯ï¼Œè·³è¿‡éƒ¨ç½²", 200
    
    return "æ— æ•ˆè¯·æ±‚", 400

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=8080)
```

### 6.3 APIé›†æˆé…ç½®


**ğŸ”Œ REST APIè°ƒç”¨ç¤ºä¾‹**

```yaml
# api-integration-playbook.yml
---
- name: APIé›†æˆéƒ¨ç½²ç¤ºä¾‹
  hosts: localhost
  vars:
    api_base_url: "https://api.company.com"
    api_token: "{{ vault_api_token }}"
    
  tasks:
    - name: é€šçŸ¥å¼€å§‹éƒ¨ç½²
      uri:
        url: "{{ api_base_url }}/deployments"
        method: POST
        headers:
          Authorization: "Bearer {{ api_token }}"
          Content-Type: "application/json"
        body_format: json
        body:
          project: "web-app"
          environment: "production"
          status: "started"
          
    - name: æ‰§è¡Œå®é™…éƒ¨ç½²
      include_tasks: deploy-tasks.yml
      
    - name: é€šçŸ¥éƒ¨ç½²å®Œæˆ
      uri:
        url: "{{ api_base_url }}/deployments/{{ deployment_id }}"
        method: PATCH
        headers:
          Authorization: "Bearer {{ api_token }}"
        body_format: json
        body:
          status: "completed"
```

---

## 7. ğŸ“¢ é€šçŸ¥ä¸åˆ¶å“ç®¡ç†


### 7.1 é€šçŸ¥é›†æˆé…ç½®


**ä¸ºä»€ä¹ˆéœ€è¦é€šçŸ¥ï¼Ÿ**
éƒ¨ç½²æ˜¯**å…³é”®æ“ä½œ**ï¼Œå›¢é˜Ÿéœ€è¦åŠæ—¶äº†è§£ï¼š
- âœ… éƒ¨ç½²æˆåŠŸäº†å—ï¼Ÿ
- âŒ å‡ºç°äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ
- ğŸ“Š éƒ¨ç½²ç”¨äº†å¤šé•¿æ—¶é—´ï¼Ÿ

### 7.2 å¤šæ¸ é“é€šçŸ¥é…ç½®


```yaml
# notification-config.yml
---
- name: å¤šæ¸ é“é€šçŸ¥é…ç½®
  hosts: localhost
  vars:
    slack_webhook: "{{ vault_slack_webhook }}"
    email_server: "smtp.company.com"
    
  tasks:
    - name: Slacké€šçŸ¥
      uri:
        url: "{{ slack_webhook }}"
        method: POST
        body_format: json
        body:
          channel: "#deployment"
          username: "Ansible Bot"
          text: |
            ğŸš€ éƒ¨ç½²çŠ¶æ€: {{ deployment_status }}
            ğŸ“¦ åº”ç”¨ç‰ˆæœ¬: {{ app_version }}
            ğŸ• éƒ¨ç½²æ—¶é—´: {{ ansible_date_time.iso8601 }}
            
    - name: é‚®ä»¶é€šçŸ¥
      mail:
        host: "{{ email_server }}"
        port: 587
        to: 
          - "devops@company.com"
          - "dev-team@company.com"
        subject: "éƒ¨ç½²é€šçŸ¥: {{ app_name }}"
        body: |
          éƒ¨ç½²è¯¦æƒ…:
          - åº”ç”¨: {{ app_name }}
          - ç¯å¢ƒ: {{ target_environment }}
          - çŠ¶æ€: {{ deployment_status }}
          - è€—æ—¶: {{ deployment_duration }}
```

### 7.3 åˆ¶å“ç®¡ç†é›†æˆ


**ä»€ä¹ˆæ˜¯åˆ¶å“ç®¡ç†ï¼Ÿ**
åˆ¶å“(Artifact)å°±æ˜¯**æ„å»ºäº§ç‰©**ï¼Œæ¯”å¦‚ï¼š
- ç¼–è¯‘åçš„ç¨‹åºåŒ…
- Dockeré•œåƒ
- é…ç½®æ–‡ä»¶åŒ…

**ğŸ“¦ åˆ¶å“ç®¡ç†é…ç½®**

```yaml
# artifact-management.yml
---
- name: åˆ¶å“ç®¡ç†é›†æˆ
  hosts: localhost
  vars:
    artifactory_url: "https://artifacts.company.com"
    docker_registry: "registry.company.com"
    
  tasks:
    - name: ä¸‹è½½åº”ç”¨åˆ¶å“
      get_url:
        url: "{{ artifactory_url }}/{{ app_name }}/{{ app_version }}.zip"
        dest: "/tmp/{{ app_name }}-{{ app_version }}.zip"
        
    - name: æ‹‰å–Dockeré•œåƒ
      docker_image:
        name: "{{ docker_registry }}/{{ app_name }}"
        tag: "{{ app_version }}"
        source: pull
        
    - name: éƒ¨ç½²åˆ°ç›®æ ‡æœåŠ¡å™¨
      unarchive:
        src: "/tmp/{{ app_name }}-{{ app_version }}.zip"
        dest: "/opt/{{ app_name }}/"
        remote_src: yes
```

**ğŸ¯ åˆ¶å“ç‰ˆæœ¬ç®¡ç†ç­–ç•¥**

| ç¯å¢ƒç±»å‹ | **ç‰ˆæœ¬ç­–ç•¥** | **ç¤ºä¾‹** |
|---------|-------------|---------|
| **å¼€å‘ç¯å¢ƒ** | ä½¿ç”¨æœ€æ–°æ„å»º | `app:latest` |
| **æµ‹è¯•ç¯å¢ƒ** | ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬ | `app:v1.2.3-beta` |  
| **ç”Ÿäº§ç¯å¢ƒ** | ä½¿ç”¨ç¨³å®šç‰ˆæœ¬ | `app:v1.2.3` |

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ CI/CDé›†æˆï¼šè‡ªåŠ¨åŒ–ä»ä»£ç åˆ°éƒ¨ç½²çš„å®Œæ•´æµç¨‹
ğŸ”¸ Jenkins Pipelineï¼šå®šä¹‰éƒ¨ç½²æµæ°´çº¿çš„è„šæœ¬æ–‡ä»¶
ğŸ”¸ GitLab CIï¼šGitLabå†…ç½®çš„è‡ªåŠ¨åŒ–éƒ¨ç½²å·¥å…·
ğŸ”¸ GitHub Actionsï¼šGitHubçš„å·¥ä½œæµè‡ªåŠ¨åŒ–å¹³å°
ğŸ”¸ AWX/Towerï¼šAnsibleçš„Webç®¡ç†ç•Œé¢
ğŸ”¸ Webhookï¼šäº‹ä»¶é©±åŠ¨çš„è‡ªåŠ¨åŒ–è§¦å‘æœºåˆ¶
ğŸ”¸ åˆ¶å“ç®¡ç†ï¼šæ„å»ºäº§ç‰©çš„ç‰ˆæœ¬åŒ–ç®¡ç†
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ é€‰æ‹©åˆé€‚çš„CI/CDå¹³å°**
```
Jenkinsï¼š     åŠŸèƒ½å¼ºå¤§ï¼Œæ’ä»¶ä¸°å¯Œï¼Œé€‚åˆå¤æ‚ä¼ä¸šç¯å¢ƒ
GitLab CIï¼š   ä¸Gité›†æˆç´§å¯†ï¼Œé…ç½®ç®€å•
GitHub Actionsï¼š äº‘ç«¯å…è´¹ï¼Œç¤¾åŒºç”Ÿæ€å¥½
```

**ğŸ”¹ å®‰å…¨é…ç½®è¦ç‚¹**
```
ğŸ” SSHå¯†é’¥ç®¡ç†ï¼š      ä½¿ç”¨ä¸“é—¨çš„éƒ¨ç½²å¯†é’¥ï¼Œå®šæœŸè½®æ¢
ğŸ” æ•æ„Ÿä¿¡æ¯å­˜å‚¨ï¼š     ä½¿ç”¨Secretsæˆ–VaultåŠ å¯†å­˜å‚¨  
ğŸ” æƒé™æœ€å°åŒ–åŸåˆ™ï¼š   åªç»™å¿…è¦çš„è®¿é—®æƒé™
```

**ğŸ”¹ ç›‘æ§ä¸é€šçŸ¥ç­–ç•¥**
```
ğŸ“Š éƒ¨ç½²çŠ¶æ€ç›‘æ§ï¼š     æˆåŠŸ/å¤±è´¥çŠ¶æ€å®æ—¶é€šçŸ¥
ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡ç›‘æ§ï¼š     éƒ¨ç½²è€—æ—¶ã€æˆåŠŸç‡ç»Ÿè®¡
ğŸ” æ—¥å¿—åˆ†æï¼š        è¯¦ç»†çš„éƒ¨ç½²æ—¥å¿—è®°å½•
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ’¡ æ–°æ‰‹å»ºè®®å­¦ä¹ è·¯å¾„**
1. **ä»ç®€å•å¼€å§‹** - å…ˆå­¦ä¼šåŸºç¡€çš„Ansibleéƒ¨ç½²
2. **é€‰æ‹©ä¸€ä¸ªå¹³å°** - æ ¹æ®ç°æœ‰ç¯å¢ƒé€‰æ‹©CI/CDå¹³å°
3. **é€æ­¥é›†æˆ** - ä»æ‰‹åŠ¨è§¦å‘åˆ°è‡ªåŠ¨åŒ–è§¦å‘
4. **å®Œå–„ç›‘æ§** - æ·»åŠ é€šçŸ¥å’Œæ—¥å¿—ç›‘æ§

**ğŸš¨ å¸¸è§é—®é¢˜é¿å…**
- **æƒé™é—®é¢˜** - ç¡®ä¿CI/CDå¹³å°æœ‰è¶³å¤Ÿæƒé™æ‰§è¡ŒAnsible
- **ç½‘ç»œè¿é€š** - æ£€æŸ¥CI/CDå¹³å°åˆ°ç›®æ ‡æœåŠ¡å™¨çš„ç½‘ç»œè¿æ¥
- **å¯†é’¥ç®¡ç†** - å¦¥å–„ä¿ç®¡SSHå¯†é’¥å’ŒAPI Token
- **å›æ»šç­–ç•¥** - å‡†å¤‡éƒ¨ç½²å¤±è´¥æ—¶çš„å›æ»šæ–¹æ¡ˆ

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- CI/CDè‡ªåŠ¨åŒ–ï¼ŒAnsibleæ¥éƒ¨ç½²
- Webhookåšè§¦å‘ï¼ŒAPIæ¥é›†æˆ  
- é€šçŸ¥è¦åŠæ—¶ï¼Œåˆ¶å“è¦ç®¡ç†
- å®‰å…¨ç¬¬ä¸€ä½ï¼Œç›‘æ§ä¸èƒ½ä¸¢