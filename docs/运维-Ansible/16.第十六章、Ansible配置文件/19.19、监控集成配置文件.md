---
title: 19ã€ç›‘æ§é›†æˆé…ç½®æ–‡ä»¶
---
## ğŸ“š ç›®å½•

1. [ç›‘æ§é›†æˆé…ç½®æ¦‚è¿°](#1-ç›‘æ§é›†æˆé…ç½®æ¦‚è¿°)
2. [Prometheusç›‘æ§é…ç½®](#2-Prometheusç›‘æ§é…ç½®)
3. [Grafanaå¯è§†åŒ–é…ç½®](#3-Grafanaå¯è§†åŒ–é…ç½®)
4. [æ—¥å¿—ç›‘æ§ç³»ç»Ÿé›†æˆ](#4-æ—¥å¿—ç›‘æ§ç³»ç»Ÿé›†æˆ)
5. [å‘Šè­¦é€šçŸ¥é…ç½®](#5-å‘Šè­¦é€šçŸ¥é…ç½®)
6. [å›è°ƒæ’ä»¶é…ç½®](#6-å›è°ƒæ’ä»¶é…ç½®)
7. [ç›‘æ§æœ€ä½³å®è·µ](#7-ç›‘æ§æœ€ä½³å®è·µ)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” ç›‘æ§é›†æˆé…ç½®æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯ç›‘æ§é›†æˆé…ç½®


**ç®€å•ç†è§£**ï¼šç›‘æ§é›†æˆé…ç½®å°±æ˜¯è®© Ansible å’Œå„ç§ç›‘æ§ç³»ç»Ÿ"å¯¹è¯"çš„æ¡¥æ¢

```
ç›‘æ§ç³»ç»Ÿçš„ä½œç”¨ï¼š
ğŸ”¸ å®æ—¶è§‚å¯Ÿï¼šç³»ç»Ÿè¿è¡ŒçŠ¶æ€å¦‚ä½•ï¼Ÿ
ğŸ”¸ é—®é¢˜é¢„è­¦ï¼šæœ‰å¼‚å¸¸æƒ…å†µåŠæ—¶é€šçŸ¥
ğŸ”¸ æ€§èƒ½åˆ†æï¼šå“ªé‡Œå¯ä»¥ä¼˜åŒ–ï¼Ÿ
ğŸ”¸ æ•…éšœå®šä½ï¼šå‡ºé—®é¢˜äº†å¿«é€Ÿæ‰¾åˆ°åŸå› 
```

**ä¸ºä»€ä¹ˆéœ€è¦ç›‘æ§é›†æˆ**ï¼š
- **å®æ—¶æŒæ§**ï¼šçŸ¥é“ Ansible ä»»åŠ¡æ‰§è¡Œæƒ…å†µ
- **å¿«é€Ÿå“åº”**ï¼šæœ‰é—®é¢˜ç«‹å³æ”¶åˆ°é€šçŸ¥
- **æ€§èƒ½ä¼˜åŒ–**ï¼šåˆ†æå“ªäº›ä»»åŠ¡è€—æ—¶é•¿
- **æ•…éšœæ’æŸ¥**ï¼šä¿å­˜è¯¦ç»†çš„æ‰§è¡Œæ—¥å¿—

### 1.2 ä¸»æµç›‘æ§ç³»ç»Ÿä»‹ç»


| ç›‘æ§ç³»ç»Ÿ | **ä¸»è¦åŠŸèƒ½** | **é€‚ç”¨åœºæ™¯** | **ç‰¹ç‚¹** |
|---------|-------------|-------------|---------|
| ğŸ¯ **Prometheus** | `æŒ‡æ ‡æ”¶é›†å’Œå­˜å‚¨` | `äº‘åŸç”Ÿç¯å¢ƒ` | `å¼ºå¤§çš„æŸ¥è¯¢è¯­è¨€ï¼Œå¼€æºå…è´¹` |
| ğŸ“Š **Grafana** | `æ•°æ®å¯è§†åŒ–` | `ä»ªè¡¨æ¿å±•ç¤º` | `ç¾è§‚çš„å›¾è¡¨ï¼Œæ”¯æŒå¤šæ•°æ®æº` |
| ğŸ”” **Zabbix** | `ä¼ä¸šçº§ç›‘æ§` | `ä¼ ç»ŸITç¯å¢ƒ` | `åŠŸèƒ½å…¨é¢ï¼Œé…ç½®å¤æ‚` |
| ğŸ“ˆ **Nagios** | `çŠ¶æ€ç›‘æ§` | `åŸºç¡€è®¾æ–½ç›‘æ§` | `å†å²æ‚ ä¹…ï¼Œæ’ä»¶ä¸°å¯Œ` |
| ğŸ“‹ **ELK Stack** | `æ—¥å¿—åˆ†æ` | `æ—¥å¿—é›†ä¸­ç®¡ç†` | `æœç´¢å¼ºå¤§ï¼Œé€‚åˆå¤§æ•°æ®` |

### 1.3 ç›‘æ§é…ç½®çš„æ ¸å¿ƒç†å¿µ


```
æ•°æ®æ”¶é›†å±‚ï¼šAnsible â†’ ç›‘æ§ç³»ç»Ÿ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ansible    â”‚â”€â”€â”€â†’â”‚   ç›‘æ§ç³»ç»Ÿ   â”‚
â”‚  æ‰§è¡Œä»»åŠ¡    â”‚    â”‚   æ”¶é›†æ•°æ®   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‘Šè­¦é€šçŸ¥   â”‚â—„â”€â”€â”€â”‚   æ•°æ®åˆ†æ   â”‚
â”‚   é—®é¢˜æŠ¥è­¦   â”‚    â”‚   å¼‚å¸¸æ£€æµ‹   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ğŸ¯ Prometheusç›‘æ§é…ç½®


### 2.1 Prometheusé…ç½®åŸºç¡€


**ä»€ä¹ˆæ˜¯ Prometheus**ï¼š
> ğŸ’¡ Prometheus å°±åƒä¸€ä¸ªå‹¤åŠ³çš„æ•°æ®æ”¶é›†å‘˜ï¼Œä¸æ–­åœ°å»å„ä¸ªç³»ç»Ÿ"è¯¢é—®"çŠ¶æ€ä¿¡æ¯ï¼Œç„¶åæŠŠè¿™äº›ä¿¡æ¯æ•´ç†å­˜å‚¨èµ·æ¥

**prometheus_config é…ç½®è¯¦è§£**ï¼š

```yaml
# ansible.cfg ä¸­çš„ Prometheus é…ç½®
[defaults]
# å¯ç”¨ Prometheus å›è°ƒæ’ä»¶
callback_plugins = /usr/share/ansible/plugins/callback
callbacks_enabled = prometheus

[callback_prometheus]
# Prometheus æ¨é€ç½‘å…³åœ°å€
prometheus_gateway = http://prometheus-gateway:9091
# ä»»åŠ¡æ ‡ç­¾é…ç½®
job_label = ansible_playbook
# æŒ‡æ ‡å‰ç¼€
metrics_prefix = ansible_
# æ¨é€é—´éš”ï¼ˆç§’ï¼‰
push_interval = 30
```

### 2.2 æŒ‡æ ‡æ”¶é›†é…ç½®è¯¦è§£


**metrics_collection é…ç½®è¯´æ˜**ï¼š

```yaml
# åœ¨ playbook ä¸­å¯ç”¨æŒ‡æ ‡æ”¶é›†
- hosts: all
  vars:
    # æ”¶é›†çš„æŒ‡æ ‡ç±»å‹
    metrics_collection:
      # ä»»åŠ¡æ‰§è¡Œæ—¶é—´
      task_duration: true
      # ä¸»æœºå“åº”æ—¶é—´
      host_response_time: true
      # å¤±è´¥ä»»åŠ¡è®¡æ•°
      failed_tasks: true
      # æˆåŠŸç‡ç»Ÿè®¡
      success_rate: true
```

**è‡ªå®šä¹‰æŒ‡æ ‡ç¤ºä¾‹**ï¼š
```yaml
- name: æ”¶é›†è‡ªå®šä¹‰ä¸šåŠ¡æŒ‡æ ‡
  uri:
    url: "http://{{ prometheus_gateway }}/metrics/job/ansible_custom"
    method: POST
    body: |
      # HELP ansible_deployment_status éƒ¨ç½²çŠ¶æ€
      # TYPE ansible_deployment_status gauge
      ansible_deployment_status{environment="{{ env }}"} {{ deployment_success | int }}
```

### 2.3 Prometheus æŸ¥è¯¢é…ç½®


**å¸¸ç”¨æŸ¥è¯¢è¡¨è¾¾å¼**ï¼š
- `ansible_task_duration_seconds`ï¼šä»»åŠ¡æ‰§è¡Œè€—æ—¶
- `ansible_playbook_runs_total`ï¼šPlaybook æ‰§è¡Œæ¬¡æ•°
- `ansible_failed_tasks_total`ï¼šå¤±è´¥ä»»åŠ¡ç»Ÿè®¡

---

## 3. ğŸ“Š Grafanaå¯è§†åŒ–é…ç½®


### 3.1 GrafanaåŸºç¡€é…ç½®


**ä»€ä¹ˆæ˜¯ Grafana**ï¼š
> ğŸ’¡ å¦‚æœè¯´ Prometheus æ˜¯æ•°æ®æ”¶é›†å‘˜ï¼Œé‚£ä¹ˆ Grafana å°±æ˜¯æ•°æ®çš„"åŒ–å¦†å¸ˆ"ï¼ŒæŠŠæ¯ç‡¥çš„æ•°å­—å˜æˆç›´è§‚å¥½çœ‹çš„å›¾è¡¨

**grafana_config é…ç½®æ–‡ä»¶**ï¼š

```yaml
# Grafana æ•°æ®æºé…ç½®
grafana_config:
  datasources:
    - name: "Ansible Prometheus"
      type: "prometheus"
      url: "http://prometheus:9090"
      access: "proxy"
      is_default: true
      
  # ä»ªè¡¨æ¿é…ç½®
  dashboards:
    - dashboard: "ansible_overview"
      folder: "Ansible Monitoring"
      datasource: "Ansible Prometheus"
```

### 2.2 dashboard_config ä»ªè¡¨æ¿é…ç½®


**æ ¸å¿ƒä»ªè¡¨æ¿é…ç½®**ï¼š

| é¢æ¿ç±»å‹ | **ç›‘æ§å†…å®¹** | **æŸ¥è¯¢è¡¨è¾¾å¼** | **ç”¨é€”** |
|---------|-------------|---------------|---------|
| ğŸ“ˆ **æ—¶é—´åºåˆ—å›¾** | `Playbookæ‰§è¡Œè¶‹åŠ¿` | `rate(ansible_playbook_runs_total[5m])` | `æŸ¥çœ‹æ‰§è¡Œé¢‘ç‡å˜åŒ–` |
| ğŸ“Š **æŸ±çŠ¶å›¾** | `ä»»åŠ¡æˆåŠŸç‡` | `ansible_successful_tasks / ansible_total_tasks * 100` | `å¿«é€Ÿäº†è§£æˆåŠŸç‡` |
| ğŸ”´ **å•å€¼é¢æ¿** | `å¤±è´¥ä»»åŠ¡æ•°` | `ansible_failed_tasks_total` | `çªå‡ºæ˜¾ç¤ºé—®é¢˜` |
| ğŸ“‹ **è¡¨æ ¼** | `ä¸»æœºçŠ¶æ€åˆ—è¡¨` | `ansible_host_reachable` | `è¯¦ç»†ä¸»æœºä¿¡æ¯` |

**ä»ªè¡¨æ¿ JSON é…ç½®ç¤ºä¾‹**ï¼š
```json
{
  "dashboard": {
    "title": "Ansible ç›‘æ§æ¦‚è§ˆ",
    "panels": [
      {
        "title": "ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€",
        "type": "stat",
        "targets": [
          {
            "expr": "sum(ansible_successful_tasks_total)"
          }
        ]
      }
    ]
  }
}
```

---

## 4. ğŸ“‹ æ—¥å¿—ç›‘æ§ç³»ç»Ÿé›†æˆ


### 4.1 ELK Stack é›†æˆé…ç½®


**ä»€ä¹ˆæ˜¯ ELK**ï¼š
> ğŸ’¡ ELK å°±åƒä¸€ä¸ªè¶…çº§å›¾ä¹¦ç®¡ç†å‘˜ï¼ŒæŠŠæ‰€æœ‰çš„æ—¥å¿—"ä¹¦ç±"åˆ†ç±»æ•´ç†ï¼Œè®©ä½ æƒ³æ‰¾ä»€ä¹ˆä¿¡æ¯éƒ½èƒ½å¿«é€Ÿæ‰¾åˆ°

**elk_config é…ç½®è¯¦è§£**ï¼š

```yaml
# ELK é›†æˆé…ç½®
elk_config:
  elasticsearch:
    hosts: ["elasticsearch:9200"]
    index_prefix: "ansible-logs"
    
  logstash:
    input_port: 5044
    codec: "json"
    
  kibana:
    dashboard_import: true
    index_pattern: "ansible-logs-*"
```

### 4.2 æ—¥å¿—æ ¼å¼é…ç½®


**logging_config è¯¦ç»†é…ç½®**ï¼š

```yaml
# ansible.cfg æ—¥å¿—é…ç½®
[defaults]
# æ—¥å¿—æ–‡ä»¶ä½ç½®
log_path = /var/log/ansible/ansible.log
# æ—¥å¿—çº§åˆ«ï¼šDEBUG, INFO, WARNING, ERROR
verbosity = 2

# ç»“æ„åŒ–æ—¥å¿—é…ç½®
[callback_logstash]
server = logstash.example.com
port = 5044
type = ansible
# æ—¥å¿—å­—æ®µé…ç½®
extra_fields = environment,project,version
```

### 4.3 Splunk é›†æˆé…ç½®


**splunk_config é…ç½®è¯´æ˜**ï¼š
```yaml
splunk_config:
  # Splunk HTTP äº‹ä»¶æ”¶é›†å™¨
  hec_endpoint: "https://splunk:8088/services/collector"
  hec_token: "your-hec-token-here"
  
  # ç´¢å¼•é…ç½®
  index: "ansible_logs"
  source: "ansible_playbook"
  sourcetype: "ansible:json"
```

---

## 5. ğŸ”” å‘Šè­¦é€šçŸ¥é…ç½®


### 5.1 å‘Šè­¦è§„åˆ™é…ç½®


**alert_config åŸºç¡€é…ç½®**ï¼š

```yaml
# å‘Šè­¦é…ç½®æ–‡ä»¶
alert_config:
  # å‘Šè­¦è§„åˆ™
  rules:
    - name: "Ansibleä»»åŠ¡å¤±è´¥"
      condition: "ansible_failed_tasks_total > 0"
      severity: "critical"
      duration: "5m"
      
    - name: "Playbookæ‰§è¡Œæ—¶é—´è¿‡é•¿"
      condition: "ansible_task_duration_seconds > 1800"
      severity: "warning"
      duration: "10m"
```

### 5.2 é€šçŸ¥æ¸ é“é…ç½®


**notification_config è¯¦è§£**ï¼š

| é€šçŸ¥æ–¹å¼ | **é…ç½®å‚æ•°** | **ä½¿ç”¨åœºæ™¯** | **ä¼˜åŠ¿** |
|---------|-------------|-------------|---------|
| ğŸ“§ **é‚®ä»¶** | `smtp_server, recipients` | `è¯¦ç»†æŠ¥å‘Šå‘é€` | `ä¿¡æ¯å®Œæ•´ï¼Œæ”¯æŒé™„ä»¶` |
| ğŸ’¬ **é’‰é’‰** | `webhook_url, secret` | `å³æ—¶é€šçŸ¥` | `å“åº”å¿«é€Ÿï¼Œç§»åŠ¨å‹å¥½` |
| ğŸ“± **å¾®ä¿¡** | `corp_id, agent_id` | `ä¼ä¸šå†…éƒ¨é€šçŸ¥` | `è¦†ç›–é¢å¹¿ï¼Œæ˜“æ¥æ”¶` |
| ğŸ”” **Slack** | `webhook_url, channel` | `å›½å¤–å›¢é˜Ÿåä½œ` | `é›†æˆåº¦é«˜ï¼ŒåŠŸèƒ½ä¸°å¯Œ` |

```yaml
notification_config:
  email:
    smtp_server: "smtp.company.com"
    smtp_port: 587
    username: "ansible@company.com"
    password: "{{ vault_email_password }}"
    recipients: ["admin@company.com", "ops@company.com"]
    
  dingtalk:
    webhook_url: "https://oapi.dingtalk.com/robot/send?access_token=xxx"
    secret: "{{ vault_dingtalk_secret }}"
    at_all: false
```

### 5.3 Webhook é…ç½®


**webhook_config å®ç”¨é…ç½®**ï¼š

```yaml
webhook_config:
  endpoints:
    - name: "ops_notification"
      url: "https://ops.company.com/webhook/ansible"
      method: "POST"
      headers:
        Authorization: "Bearer {{ api_token }}"
        Content-Type: "application/json"
      
    - name: "metrics_collector" 
      url: "http://metrics:8080/collect"
      method: "POST"
      timeout: 30
```

---

## 6. ğŸ”Œ å›è°ƒæ’ä»¶é…ç½®


### 6.1 ä»€ä¹ˆæ˜¯å›è°ƒæ’ä»¶


**é€šä¿—è§£é‡Š**ï¼š
> ğŸ’¡ å›è°ƒæ’ä»¶å°±åƒæ˜¯ Ansible çš„"è®°å½•å‘˜"ï¼Œå½“ Ansible æ‰§è¡Œä»»åŠ¡æ—¶ï¼Œæ’ä»¶å°±åœ¨æ—è¾¹è®°å½•ï¼š"ç°åœ¨å¼€å§‹åšä»€ä¹ˆäº†"ã€"åšå®Œäº†ç»“æœå¦‚ä½•"ã€"èŠ±äº†å¤šé•¿æ—¶é—´"

### 6.2 callback_plugins é…ç½®


**å¸¸ç”¨å›è°ƒæ’ä»¶ç±»å‹**ï¼š

```yaml
# ansible.cfg å›è°ƒæ’ä»¶é…ç½®
[defaults]
callback_plugins = /usr/share/ansible/plugins/callback:/custom/callback/plugins

# åŒæ—¶å¯ç”¨å¤šä¸ªå›è°ƒæ’ä»¶
callbacks_enabled = timer,profile_tasks,json,logstash
```

**æ’ä»¶åŠŸèƒ½è¯´æ˜**ï¼š
- **timer**ï¼šæ˜¾ç¤ºæ€»æ‰§è¡Œæ—¶é—´
- **profile_tasks**ï¼šæ˜¾ç¤ºæ¯ä¸ªä»»åŠ¡çš„è€—æ—¶
- **json**ï¼šè¾“å‡º JSON æ ¼å¼çš„ç»“æœ
- **logstash**ï¼šå‘é€æ—¥å¿—åˆ° Logstash

### 6.3 è‡ªå®šä¹‰å›è°ƒæ’ä»¶


**ç®€å•çš„ç›‘æ§å›è°ƒæ’ä»¶**ï¼š
```python
# è‡ªå®šä¹‰å›è°ƒæ’ä»¶ç¤ºä¾‹
from ansible.plugins.callback import CallbackBase
import requests
import json

class CallbackModule(CallbackBase):
    def __init__(self):
        super(CallbackModule, self).__init__()
        self.webhook_url = "http://monitoring:8080/ansible"
    
    def v2_playbook_on_stats(self, stats):
        # å‘é€ç»Ÿè®¡ä¿¡æ¯åˆ°ç›‘æ§ç³»ç»Ÿ
        data = {
            'hosts': len(stats.processed.keys()),
            'ok': len(stats.ok),
            'failed': len(stats.failures),
            'unreachable': len(stats.dark)
        }
        requests.post(self.webhook_url, json=data)
```

---

## 7. ğŸ›¡ï¸ ç›‘æ§æœ€ä½³å®è·µ


### 7.1 APIç«¯ç‚¹é…ç½®


**api_endpoints å®‰å…¨é…ç½®**ï¼š

```yaml
api_endpoints:
  monitoring_api:
    base_url: "https://monitoring.company.com/api/v1"
    authentication:
      type: "bearer_token"
      token: "{{ vault_monitoring_token }}"
    
    endpoints:
      - path: "/ansible/metrics"
        method: "POST"
        rate_limit: 100  # æ¯åˆ†é’Ÿæœ€å¤š100æ¬¡è¯·æ±‚
        
      - path: "/ansible/logs"
        method: "POST" 
        max_payload_size: "10MB"
```

### 7.2 æ•°æ®ä¿ç•™ç­–ç•¥


**retention_policy é…ç½®**ï¼š

| æ•°æ®ç±»å‹ | **ä¿ç•™æ—¶é—´** | **å‹ç¼©ç­–ç•¥** | **æ¸…ç†è§„åˆ™** |
|---------|-------------|-------------|-------------|
| ğŸ“Š **å®æ—¶æŒ‡æ ‡** | `7å¤©` | `1åˆ†é’Ÿç²¾åº¦` | `è‡ªåŠ¨åˆ é™¤æ—§æ•°æ®` |
| ğŸ“ˆ **èšåˆæ•°æ®** | `90å¤©` | `5åˆ†é’Ÿç²¾åº¦` | `æŒ‰æœˆå½’æ¡£` |
| ğŸ“‹ **è¯¦ç»†æ—¥å¿—** | `30å¤©` | `gzipå‹ç¼©` | `æŒ‰å¤§å°è½®è½¬` |
| ğŸš¨ **å‘Šè­¦å†å²** | `1å¹´` | `ä¸å‹ç¼©` | `æ‰‹åŠ¨æ¸…ç†` |

```yaml
retention_policy:
  metrics:
    short_term: "7d"    # è¯¦ç»†æŒ‡æ ‡ä¿ç•™7å¤©
    long_term: "90d"    # èšåˆæ•°æ®ä¿ç•™90å¤©
    
  logs:
    application: "30d"   # åº”ç”¨æ—¥å¿—30å¤©
    security: "1y"      # å®‰å…¨æ—¥å¿—1å¹´
    
  cleanup:
    schedule: "0 2 * * *"  # æ¯å¤©å‡Œæ™¨2ç‚¹æ¸…ç†
    batch_size: 1000       # æ¯æ¬¡å¤„ç†1000æ¡è®°å½•
```

### 7.3 ç›‘æ§é…ç½®æ¨¡æ¿


**å®Œæ•´ç›‘æ§é…ç½®æ¨¡æ¿**ï¼š
```yaml
# ç›‘æ§é›†æˆé…ç½®æ¨¡æ¿
monitoring_integration:
  # åŸºç¡€é…ç½®
  enabled: true
  environment: "{{ ansible_env }}"
  
  # Prometheus é…ç½®
  prometheus:
    endpoint: "http://prometheus:9090"
    push_gateway: "http://pushgateway:9091"
    job_name: "ansible_{{ inventory_hostname }}"
    
  # å‘Šè­¦é…ç½®  
  alerts:
    webhook_url: "{{ monitoring_webhook }}"
    severity_levels: ["critical", "warning", "info"]
    
  # æ—¥å¿—é…ç½®
  logging:
    level: "INFO"
    format: "json"
    destination: "logstash"
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ç›‘æ§é›†æˆæœ¬è´¨ï¼šè®© Ansible å’Œç›‘æ§ç³»ç»ŸååŒå·¥ä½œ
ğŸ”¸ æ•°æ®æµå‘ï¼šAnsible â†’ ç›‘æ§ç³»ç»Ÿ â†’ å¯è§†åŒ– â†’ å‘Šè­¦é€šçŸ¥
ğŸ”¸ å…³é”®ç»„ä»¶ï¼šæ•°æ®æ”¶é›†ã€å­˜å‚¨åˆ†æã€å¯è§†åŒ–å±•ç¤ºã€å‘Šè­¦é€šçŸ¥
ğŸ”¸ é…ç½®é‡ç‚¹ï¼šå›è°ƒæ’ä»¶ã€APIæ¥å£ã€å‘Šè­¦è§„åˆ™ã€ä¿ç•™ç­–ç•¥
ğŸ”¸ æœ€ä½³å®è·µï¼šå®‰å…¨è®¤è¯ã€æ€§èƒ½ä¼˜åŒ–ã€æ•°æ®æ²»ç†ã€æ•…éšœæ¢å¤
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆéœ€è¦ç›‘æ§é›†æˆ**
```
è¿ç»´æŒ‘æˆ˜ï¼š
- ç³»ç»Ÿå¤æ‚ï¼šå¤šå°æœåŠ¡å™¨ã€å¤šä¸ªç¯å¢ƒ
- é—®é¢˜éš¾å®šä½ï¼šå‡ºé”™äº†ä¸çŸ¥é“å“ªé‡Œæœ‰é—®é¢˜
- ç¼ºä¹å¯è§†åŒ–ï¼šçœ‹ä¸åˆ°æ•´ä½“è¿è¡ŒçŠ¶å†µ

ç›‘æ§è§£å†³æ–¹æ¡ˆï¼š
- å®æ—¶æ„ŸçŸ¥ï¼šç«‹å³çŸ¥é“ç³»ç»ŸçŠ¶æ€
- é—®é¢˜é¢„è­¦ï¼šæå‰å‘ç°æ½œåœ¨é£é™©
- å†å²è¿½è¸ªï¼šåˆ†æé—®é¢˜å‘ç”Ÿçš„è¿‡ç¨‹
- æ€§èƒ½ä¼˜åŒ–ï¼šæ‰¾åˆ°ç³»ç»Ÿç“¶é¢ˆæ‰€åœ¨
```

**ğŸ”¹ é…ç½®æ–‡ä»¶çš„æ ¸å¿ƒä½œç”¨**
```
é…ç½®æ–‡ä»¶ä½œç”¨ï¼š
- å‘Šè¯‰ Ansibleï¼šè¦æ”¶é›†ä»€ä¹ˆæ•°æ®
- å‘Šè¯‰ç›‘æ§ç³»ç»Ÿï¼šæ•°æ®ä»å“ªé‡Œæ¥
- å‘Šè¯‰å‘Šè­¦ç³»ç»Ÿï¼šä»€ä¹ˆæƒ…å†µéœ€è¦é€šçŸ¥
- å‘Šè¯‰å­˜å‚¨ç³»ç»Ÿï¼šæ•°æ®ä¿ç•™å¤šé•¿æ—¶é—´
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ç›‘æ§é…ç½®é€‰æ‹©å»ºè®®**ï¼š

```
å°å‹ç¯å¢ƒï¼ˆ<50å°æœåŠ¡å™¨ï¼‰ï¼š
âœ… Prometheus + Grafana
âœ… ç®€å•çš„é‚®ä»¶å‘Šè­¦
âœ… åŸºç¡€æ—¥å¿—æ”¶é›†

ä¸­å‹ç¯å¢ƒï¼ˆ50-500å°æœåŠ¡å™¨ï¼‰ï¼š
âœ… Prometheus + Grafana + AlertManager
âœ… å¤šæ¸ é“å‘Šè­¦ï¼ˆé‚®ä»¶+é’‰é’‰ï¼‰
âœ… ELK æ—¥å¿—åˆ†æ
âœ… è‡ªå®šä¹‰å›è°ƒæ’ä»¶

å¤§å‹ç¯å¢ƒï¼ˆ>500å°æœåŠ¡å™¨ï¼‰ï¼š
âœ… å®Œæ•´ç›‘æ§ä½“ç³»
âœ… å¤šçº§å‘Šè­¦ç­–ç•¥
âœ… åˆ†å¸ƒå¼æ—¥å¿—å­˜å‚¨
âœ… è‡ªåŠ¨åŒ–è¿ç»´æµç¨‹
```

**å¸¸è§é…ç½®é”™è¯¯é¿å…**ï¼š
- âŒ **é…ç½®è¿‡äºå¤æ‚**ï¼šæ–°æ‰‹åº”è¯¥ä»ç®€å•å¼€å§‹
- âŒ **å‘Šè­¦è¿‡äºé¢‘ç¹**ï¼šé¿å…"ç‹¼æ¥äº†"æ•ˆåº”  
- âŒ **æ•°æ®ä¿ç•™è¿‡é•¿**ï¼šæ³¨æ„å­˜å‚¨ç©ºé—´æ¶ˆè€—
- âŒ **æƒé™é…ç½®ä¸å½“**ï¼šç¡®ä¿å®‰å…¨æ€§

### 8.4 å­¦ä¹ è·¯å¾„å»ºè®®


**å¾ªåºæ¸è¿›çš„å­¦ä¹ æ–¹å¼**ï¼š
1. ğŸ¯ **ç¬¬ä¸€æ­¥**ï¼šç†è§£ç›‘æ§çš„ä½œç”¨å’Œä»·å€¼
2. ğŸ”§ **ç¬¬äºŒæ­¥**ï¼šé…ç½®åŸºç¡€çš„ Prometheus ç›‘æ§
3. ğŸ“Š **ç¬¬ä¸‰æ­¥**ï¼šæ·»åŠ  Grafana å¯è§†åŒ–å±•ç¤º
4. ğŸ”” **ç¬¬å››æ­¥**ï¼šè®¾ç½®ç®€å•çš„å‘Šè­¦é€šçŸ¥
5. ğŸ“ˆ **ç¬¬äº”æ­¥**ï¼šé›†æˆæ—¥å¿—åˆ†æç³»ç»Ÿ
6. ğŸš€ **ç¬¬å…­æ­¥**ï¼šä¼˜åŒ–å’Œè‡ªå®šä¹‰ç›‘æ§æ–¹æ¡ˆ

> ğŸ’¡ **è®°å¿†è¦ç‚¹**ï¼šç›‘æ§é…ç½®çš„ç›®çš„æ˜¯"çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆï¼Œé¢„æµ‹å¯èƒ½å‘ç”Ÿä»€ä¹ˆï¼Œå¿«é€Ÿè§£å†³å·²å‘ç”Ÿçš„é—®é¢˜"

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- æ•°æ®æ”¶é›†è¦å…¨é¢ï¼Œå‘Šè­¦é€šçŸ¥è¦åŠæ—¶
- å¯è§†åŒ–å±•ç¤ºè¦ç›´è§‚ï¼Œä¿ç•™ç­–ç•¥è¦åˆç†
- å®‰å…¨è®¤è¯è¦åˆ°ä½ï¼Œæ€§èƒ½ä¼˜åŒ–è¦æŒç»­