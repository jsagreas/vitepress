---
title: 4ã€tags-æ ‡ç­¾ç®¡ç†
---
## ğŸ“š ç›®å½•

1. [Tagsæ ‡ç­¾åŸºç¡€æ¦‚å¿µ](#1-tagsæ ‡ç­¾åŸºç¡€æ¦‚å¿µ)
2. [æ ‡ç­¾å®šä¹‰æ–¹å¼](#2-æ ‡ç­¾å®šä¹‰æ–¹å¼)
3. [é€‰æ‹©æ€§æ‰§è¡Œä»»åŠ¡](#3-é€‰æ‹©æ€§æ‰§è¡Œä»»åŠ¡)
4. [è·³è¿‡æ ‡ç­¾çš„ä½¿ç”¨](#4-è·³è¿‡æ ‡ç­¾çš„ä½¿ç”¨)
5. [æ ‡ç­¾ç»§æ‰¿æœºåˆ¶](#5-æ ‡ç­¾ç»§æ‰¿æœºåˆ¶)
6. [ç‰¹æ®Šæ ‡ç­¾è¯¦è§£](#6-ç‰¹æ®Šæ ‡ç­¾è¯¦è§£)
7. [è°ƒè¯•ä¸­çš„æ ‡ç­¾åº”ç”¨](#7-è°ƒè¯•ä¸­çš„æ ‡ç­¾åº”ç”¨)
8. [ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ](#8-ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ)
9. [æ ‡ç­¾ç®¡ç†ç­–ç•¥](#9-æ ‡ç­¾ç®¡ç†ç­–ç•¥)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ·ï¸ Tagsæ ‡ç­¾åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯Ansibleæ ‡ç­¾


**ğŸ”¸ æ ‡ç­¾çš„æœ¬è´¨ç†è§£**
```
Ansible Tagsï¼ˆæ ‡ç­¾ï¼‰ï¼š
ä¸€ç§ç»™ä»»åŠ¡ã€Roleæˆ–Playæ‰“ä¸Šæ ‡è®°çš„æœºåˆ¶
ç›®çš„ï¼šå®ç°é€‰æ‹©æ€§æ‰§è¡Œï¼Œæé«˜è¿ç»´æ•ˆç‡

å®é™…åº”ç”¨åœºæ™¯ï¼š
- å¤§å‹Playbookä¸­åªæ‰§è¡ŒæŸäº›ç‰¹å®šä»»åŠ¡
- æ ¹æ®ç¯å¢ƒï¼ˆå¼€å‘/æµ‹è¯•/ç”Ÿäº§ï¼‰é€‰æ‹©æ‰§è¡Œå†…å®¹
- è°ƒè¯•æ—¶å¿«é€Ÿå®šä½å’Œè¿è¡Œç‰¹å®šåŠŸèƒ½
- éƒ¨ç½²æµç¨‹ä¸­çš„åˆ†é˜¶æ®µæ‰§è¡Œ
```

**ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦æ ‡ç­¾ç®¡ç†**
```
ä¼ ç»Ÿé—®é¢˜ï¼š
PlaybookåŒ…å«100ä¸ªä»»åŠ¡ï¼Œä½†åªæƒ³æ‰§è¡Œå…¶ä¸­5ä¸ª
æ²¡æœ‰æ ‡ç­¾ï¼šéœ€è¦æ³¨é‡Šæ‰95ä¸ªä»»åŠ¡æˆ–åˆ›å»ºæ–°çš„Playbook

æ ‡ç­¾è§£å†³æ–¹æ¡ˆï¼š
ç»™ä»»åŠ¡æ‰“æ ‡ç­¾ â†’ è¿è¡Œæ—¶æŒ‡å®šæ ‡ç­¾ â†’ åªæ‰§è¡ŒåŒ¹é…çš„ä»»åŠ¡
ä¸€ä¸ªPlaybookï¼Œå¤šç§æ‰§è¡Œæ–¹å¼ï¼Œçµæ´»é«˜æ•ˆ
```

### 1.2 æ ‡ç­¾çš„å·¥ä½œåŸç†


```
æ‰§è¡Œæµç¨‹å›¾è§£ï¼š

Playbookæ‰§è¡Œ    â†’    æ ‡ç­¾è¿‡æ»¤    â†’    ä»»åŠ¡æ‰§è¡Œ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ‰€æœ‰ä»»åŠ¡    â”‚ --> â”‚  åŒ¹é…æ ‡ç­¾    â”‚ --> â”‚  æ‰§è¡Œå­é›†    â”‚
â”‚             â”‚     â”‚             â”‚     â”‚             â”‚
â”‚ Task1: web  â”‚     â”‚åªé€‰æ‹©webç›¸å…³ â”‚     â”‚  Task1     â”‚
â”‚ Task2: db   â”‚     â”‚             â”‚     â”‚  Task5     â”‚
â”‚ Task3: cacheâ”‚ --> â”‚  --tags web â”‚ --> â”‚  Task8     â”‚
â”‚ Task4: log  â”‚     â”‚             â”‚     â”‚             â”‚
â”‚ Task5: web  â”‚     â”‚             â”‚     â”‚ (å…¶ä»–è·³è¿‡)  â”‚
â”‚ Task6: db   â”‚     â”‚             â”‚     â”‚             â”‚
â”‚ Task7: cacheâ”‚     â”‚             â”‚     â”‚             â”‚
â”‚ Task8: web  â”‚     â”‚             â”‚     â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 æ ‡ç­¾çš„ä¼˜åŠ¿å’Œåº”ç”¨ä»·å€¼


**âš¡ æ ¸å¿ƒä¼˜åŠ¿**
```
1. é€‰æ‹©æ€§æ‰§è¡Œ
   âœ… é¿å…é‡å¤æ‰§è¡Œä¸å¿…è¦çš„ä»»åŠ¡
   âœ… èŠ‚çœæ—¶é—´ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤§å‹ç¯å¢ƒä¸­
   
2. çµæ´»éƒ¨ç½²
   âœ… åŒä¸€ä¸ªPlaybookæ”¯æŒä¸åŒçš„æ‰§è¡Œæ¨¡å¼
   âœ… é€‚åº”ä¸åŒç¯å¢ƒå’Œåœºæ™¯éœ€æ±‚

3. è°ƒè¯•ä¾¿åˆ©  
   âœ… å¿«é€Ÿå®šä½å’Œæµ‹è¯•ç‰¹å®šåŠŸèƒ½
   âœ… é—®é¢˜æ’æŸ¥æ—¶ç²¾å‡†æ‰§è¡Œç›¸å…³ä»»åŠ¡

4. åˆ†é˜¶æ®µæ‰§è¡Œ
   âœ… éƒ¨ç½²è¿‡ç¨‹å¯ä»¥åˆ†æ­¥éª¤è¿›è¡Œ
   âœ… å‡ºé—®é¢˜æ—¶æ–¹ä¾¿å›æ»šå’Œä¿®å¤
```

---

## 2. ğŸ“ æ ‡ç­¾å®šä¹‰æ–¹å¼


### 2.1 ä»»åŠ¡çº§åˆ«æ ‡ç­¾å®šä¹‰


**ğŸ”§ åŸºæœ¬è¯­æ³•**
```yaml
# å•ä¸ªæ ‡ç­¾
- name: å®‰è£…Nginx
  yum:
    name: nginx
    state: present
  tags: web

# å¤šä¸ªæ ‡ç­¾ï¼ˆæ•°ç»„å½¢å¼ï¼‰
- name: é…ç½®Nginx
  template:
    src: nginx.conf.j2
    dest: /etc/nginx/nginx.conf
  tags:
    - web
    - config
    - nginx

# å¤šä¸ªæ ‡ç­¾ï¼ˆå­—ç¬¦ä¸²å½¢å¼ï¼‰
- name: å¯åŠ¨NginxæœåŠ¡
  service:
    name: nginx
    state: started
  tags: web,service,nginx
```

**ğŸ¯ å®é™…ç¤ºä¾‹**
```yaml
---
- name: WebæœåŠ¡å™¨éƒ¨ç½²
  hosts: webservers
  tasks:
    - name: å®‰è£…åŸºç¡€è½¯ä»¶åŒ…
      yum:
        name: "{{ item }}"
        state: present
      loop:
        - curl
        - wget
        - vim
      tags:
        - base
        - packages

    - name: å®‰è£…WebæœåŠ¡å™¨
      yum:
        name: nginx
        state: present
      tags:
        - web
        - nginx
        - install

    - name: é…ç½®WebæœåŠ¡å™¨
      template:
        src: nginx.conf.j2
        dest: /etc/nginx/nginx.conf
      tags:
        - web
        - nginx  
        - config
      notify: restart nginx

    - name: å¯åŠ¨WebæœåŠ¡
      service:
        name: nginx
        state: started
        enabled: yes
      tags:
        - web
        - nginx
        - service
```

### 2.2 Playçº§åˆ«æ ‡ç­¾å®šä¹‰


**ğŸ“‹ Playæ ‡ç­¾åº”ç”¨**
```yaml
---
# Playçº§åˆ«çš„æ ‡ç­¾ä¼šåº”ç”¨åˆ°è¯¥Playä¸‹çš„æ‰€æœ‰ä»»åŠ¡
- name: æ•°æ®åº“æœåŠ¡é…ç½®
  hosts: dbservers
  tags:
    - database
    - db
  tasks:
    - name: å®‰è£…MySQL
      yum:
        name: mysql-server
        state: present
      # è¿™ä¸ªä»»åŠ¡è‡ªåŠ¨ç»§æ‰¿ database, db æ ‡ç­¾

    - name: å¯åŠ¨MySQLæœåŠ¡
      service:
        name: mysqld
        state: started
      # è¿™ä¸ªä»»åŠ¡ä¹Ÿè‡ªåŠ¨ç»§æ‰¿ database, db æ ‡ç­¾

- name: WebæœåŠ¡é…ç½®  
  hosts: webservers
  tags: web
  tasks:
    - name: å®‰è£…Apache
      yum:
        name: httpd
        state: present
      # ç»§æ‰¿ web æ ‡ç­¾
```

### 2.3 Roleä¸­çš„æ ‡ç­¾å®šä¹‰


**ğŸ—ï¸ Roleçº§åˆ«æ ‡ç­¾**
```yaml
# åœ¨main.ymlä¸­è°ƒç”¨Roleæ—¶å®šä¹‰æ ‡ç­¾
---
- name: å®Œæ•´çš„LAMPç¯å¢ƒéƒ¨ç½²
  hosts: servers
  roles:
    - role: mysql
      tags:
        - database
        - mysql
        
    - role: php
      tags:
        - web
        - php
        
    - role: apache
      tags:
        - web  
        - apache
```

**ğŸ“‚ Roleå†…éƒ¨ä»»åŠ¡æ ‡ç­¾**
```yaml
# roles/mysql/tasks/main.yml
---
- name: å®‰è£…MySQLè½¯ä»¶åŒ…
  yum:
    name: "{{ mysql_packages }}"
    state: present
  tags:
    - mysql-install
    - packages

- name: é…ç½®MySQL
  template:
    src: my.cnf.j2
    dest: /etc/mysql/my.cnf
  tags:
    - mysql-config
    - config
  notify: restart mysql

- name: åˆ›å»ºæ•°æ®åº“
  mysql_db:
    name: "{{ item }}"
    state: present
  loop: "{{ mysql_databases }}"
  tags:
    - mysql-db
    - database
```

### 2.4 Importå’ŒIncludeçš„æ ‡ç­¾å¤„ç†


**ğŸ”— åŠ¨æ€å¯¼å…¥å’Œé™æ€å¯¼å…¥çš„åŒºåˆ«**
```yaml
# é™æ€å¯¼å…¥ - æ ‡ç­¾åº”ç”¨äºå¯¼å…¥çš„æ‰€æœ‰ä»»åŠ¡
- import_tasks: database.yml
  tags:
    - database
    - critical

# åŠ¨æ€åŒ…å« - æ ‡ç­¾åªåº”ç”¨äºincludeä»»åŠ¡æœ¬èº«
- include_tasks: "{{ ansible_os_family }}.yml"
  tags:
    - os-specific

# å¦‚æœè¦ç»™åŠ¨æ€åŒ…å«çš„ä»»åŠ¡æ‰“æ ‡ç­¾ï¼Œéœ€è¦åœ¨è¢«åŒ…å«æ–‡ä»¶ä¸­å®šä¹‰
```

---

## 3. âš™ï¸ é€‰æ‹©æ€§æ‰§è¡Œä»»åŠ¡


### 3.1 åŸºæœ¬çš„æ ‡ç­¾æ‰§è¡Œ


**ğŸš€ å‘½ä»¤è¡Œå‚æ•°**
```bash
# æ‰§è¡Œç‰¹å®šæ ‡ç­¾çš„ä»»åŠ¡
ansible-playbook site.yml --tags web

# æ‰§è¡Œå¤šä¸ªæ ‡ç­¾
ansible-playbook site.yml --tags "web,database"

# ä½¿ç”¨é€—å·åˆ†éš”æˆ–å¤šæ¬¡ä½¿ç”¨--tags
ansible-playbook site.yml --tags web --tags database
```

**ğŸ“Š æ‰§è¡Œç»“æœå¯¹æ¯”**
```bash
# ä¸ä½¿ç”¨æ ‡ç­¾ - æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡
$ ansible-playbook site.yml
PLAY RECAP =====================================
webserver : ok=15 changed=8  unreachable=0 failed=0

# ä½¿ç”¨webæ ‡ç­¾ - åªæ‰§è¡Œwebç›¸å…³ä»»åŠ¡  
$ ansible-playbook site.yml --tags web
PLAY RECAP =====================================
webserver : ok=5  changed=2  unreachable=0 failed=0
# æ˜æ˜¾å¯çœ‹å‡ºæ‰§è¡Œçš„ä»»åŠ¡æ•°é‡å‡å°‘äº†
```

### 3.2 æ ‡ç­¾çš„ANDå’ŒORé€»è¾‘


**ğŸ” é€»è¾‘å…³ç³»ç†è§£**
```yaml
# ä»»åŠ¡åŒæ—¶æ‹¥æœ‰å¤šä¸ªæ ‡ç­¾
- name: é…ç½®Nginx SSL
  template:
    src: ssl.conf.j2  
    dest: /etc/nginx/ssl.conf
  tags:
    - web
    - ssl
    - security
```

**ğŸ“ æ‰§è¡Œé€»è¾‘**
```bash
# ORé€»è¾‘ï¼šæ»¡è¶³ä»»ä½•ä¸€ä¸ªæ ‡ç­¾å°±æ‰§è¡Œ
ansible-playbook site.yml --tags "web,database"
# æ‰§è¡Œæ ‡ç­¾ä¸ºweb OR databaseçš„ä»»åŠ¡

# å®é™…ä¸Šï¼Œå•ä¸ªä»»åŠ¡çš„å¤šæ ‡ç­¾å†…éƒ¨æ˜¯ORå…³ç³»
# ä¸Šé¢çš„SSLé…ç½®ä»»åŠ¡åœ¨ä»¥ä¸‹æƒ…å†µéƒ½ä¼šæ‰§è¡Œï¼š
--tags web        # åŒ¹é…webæ ‡ç­¾
--tags ssl        # åŒ¹é…sslæ ‡ç­¾  
--tags security   # åŒ¹é…securityæ ‡ç­¾
--tags "web,ssl"  # åŒ¹é…webæˆ–sslæ ‡ç­¾
```

### 3.3 åˆ—å‡ºå¯ç”¨æ ‡ç­¾


**ğŸ“‹ æŸ¥çœ‹Playbookä¸­çš„æ ‡ç­¾**
```bash
# åˆ—å‡ºæ‰€æœ‰æ ‡ç­¾
ansible-playbook site.yml --list-tags

# è¾“å‡ºç¤ºä¾‹
playbook: site.yml
  play #1 (webservers): WebæœåŠ¡å™¨éƒ¨ç½²  TAGS: []
      TASK TAGS: [base, config, nginx, packages, service, web]
  
  play #2 (dbservers): æ•°æ®åº“é…ç½®     TAGS: [database, db]  
      TASK TAGS: [database, db, mysql, service]
```

### 3.4 æ£€æŸ¥å“ªäº›ä»»åŠ¡ä¼šè¢«æ‰§è¡Œ


**ğŸ” ä»»åŠ¡é¢„è§ˆåŠŸèƒ½**
```bash
# åˆ—å‡ºä¼šè¢«æ‰§è¡Œçš„ä»»åŠ¡ï¼ˆä¸çœŸæ­£æ‰§è¡Œï¼‰
ansible-playbook site.yml --tags web --list-tasks

# è¾“å‡ºç¤ºä¾‹
playbook: site.yml
  play #1 (webservers): WebæœåŠ¡å™¨éƒ¨ç½²  TAGS: []
    tasks:
      å®‰è£…WebæœåŠ¡å™¨        TAGS: [install, nginx, web]
      é…ç½®WebæœåŠ¡å™¨        TAGS: [config, nginx, web]  
      å¯åŠ¨WebæœåŠ¡         TAGS: [nginx, service, web]
```

---

## 4. ğŸš« è·³è¿‡æ ‡ç­¾çš„ä½¿ç”¨


### 4.1 skip-tagsåŸºæœ¬ç”¨æ³•


**âŒ æ’é™¤ç‰¹å®šæ ‡ç­¾**
```bash
# æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡ï¼Œä½†è·³è¿‡æ ‡ç­¾ä¸ºdatabaseçš„ä»»åŠ¡
ansible-playbook site.yml --skip-tags database

# è·³è¿‡å¤šä¸ªæ ‡ç­¾
ansible-playbook site.yml --skip-tags "database,backup"

# ç»“åˆä½¿ç”¨tagså’Œskip-tags
ansible-playbook site.yml --tags web --skip-tags ssl
# æ‰§è¡Œwebæ ‡ç­¾çš„ä»»åŠ¡ï¼Œä½†è·³è¿‡åŒæ—¶å¸¦æœ‰sslæ ‡ç­¾çš„ä»»åŠ¡
```

**ğŸ’¡ å®é™…åº”ç”¨åœºæ™¯**
```yaml
---
- name: å®Œæ•´çš„åº”ç”¨éƒ¨ç½²
  hosts: appservers
  tasks:
    - name: å®‰è£…åº”ç”¨
      yum:
        name: myapp
        state: present
      tags:
        - install
        - app

    - name: é…ç½®åº”ç”¨
      template:
        src: app.conf.j2
        dest: /etc/myapp/app.conf
      tags:
        - config
        - app

    - name: æ•°æ®åº“è¿ç§»
      shell: /usr/bin/myapp-migrate
      tags:
        - migrate
        - database
        - dangerous

    - name: å¯åŠ¨åº”ç”¨
      service:
        name: myapp
        state: started
      tags:
        - service
        - app
```

**ğŸ¯ è·³è¿‡å±é™©æ“ä½œ**
```bash
# æ—¥å¸¸éƒ¨ç½²ï¼šè·³è¿‡æ•°æ®åº“è¿ç§»ç­‰å±é™©æ“ä½œ
ansible-playbook app-deploy.yml --skip-tags dangerous

# åªå®‰è£…å’Œé…ç½®ï¼Œè·³è¿‡å¯åŠ¨æœåŠ¡
ansible-playbook app-deploy.yml --skip-tags service

# å¿«é€Ÿæ›´æ–°é…ç½®ï¼Œè·³è¿‡å®‰è£…å’Œè¿ç§»
ansible-playbook app-deploy.yml --tags config --skip-tags install,migrate
```

### 4.2 æ ‡ç­¾ä¼˜å…ˆçº§è§„åˆ™


**âš¡ æ‰§è¡Œä¼˜å…ˆçº§ç†è§£**
```
æ ‡ç­¾è¿‡æ»¤çš„å¤„ç†é¡ºåºï¼š
1. å…ˆåº”ç”¨ --tags è¿‡æ»¤å™¨ï¼ˆåŒ…å«å“ªäº›ï¼‰
2. å†åº”ç”¨ --skip-tags è¿‡æ»¤å™¨ï¼ˆæ’é™¤å“ªäº›ï¼‰  
3. æœ€ç»ˆæ‰§è¡Œå‰©ä½™çš„ä»»åŠ¡

ç¤ºä¾‹ï¼š
ä»»åŠ¡A: tags [web, ssl]
ä»»åŠ¡B: tags [web, config]  
ä»»åŠ¡C: tags [database]

å‘½ä»¤ï¼šansible-playbook --tags web --skip-tags ssl
ç»“æœï¼šåªæ‰§è¡Œä»»åŠ¡B
åˆ†æï¼šä»»åŠ¡Aè¢«skip-tagsæ’é™¤ï¼Œä»»åŠ¡Cä¸åŒ¹é…tagsè¿‡æ»¤
```

---

## 5. ğŸ”— æ ‡ç­¾ç»§æ‰¿æœºåˆ¶


### 5.1 Playåˆ°Taskçš„æ ‡ç­¾ç»§æ‰¿


**ğŸ“‹ ç»§æ‰¿è§„åˆ™**
```yaml
---
- name: WebæœåŠ¡é…ç½®
  hosts: webservers
  tags:
    - web-setup
    - production
  tasks:
    - name: å®‰è£…Nginx  
      yum:
        name: nginx
        state: present
      # è‡ªåŠ¨è·å¾—æ ‡ç­¾ï¼šweb-setup, production

    - name: é…ç½®Nginx
      template:
        src: nginx.conf.j2
        dest: /etc/nginx/nginx.conf
      tags:
        - config
      # æ‹¥æœ‰æ ‡ç­¾ï¼šweb-setup, production, config
```

**ğŸ’¡ ç»§æ‰¿çš„å®é™…å½±å“**
```bash
# æ‰§è¡Œproductionæ ‡ç­¾æ—¶ï¼ŒPlayä¸‹çš„æ‰€æœ‰ä»»åŠ¡éƒ½ä¼šæ‰§è¡Œ
ansible-playbook site.yml --tags production

# å³ä½¿ä»»åŠ¡æ²¡æœ‰æ˜ç¡®å®šä¹‰productionæ ‡ç­¾ï¼Œä¹Ÿä¼šè¢«æ‰§è¡Œ
# å› ä¸ºä»Playçº§åˆ«ç»§æ‰¿äº†è¯¥æ ‡ç­¾
```

### 5.2 Roleæ ‡ç­¾ç»§æ‰¿


**ğŸ—ï¸ Roleçº§åˆ«çš„æ ‡ç­¾ä¼ é€’**
```yaml
# main.yml - è°ƒç”¨Roleæ—¶å®šä¹‰æ ‡ç­¾
---
- name: LAMPæœåŠ¡å™¨è®¾ç½®
  hosts: lampservers  
  roles:
    - role: common
      tags:
        - base
        - common
        
    - role: mysql
      tags:
        - database
        - mysql
        - critical
        
    - role: apache  
      tags:
        - web
        - apache
```

**ğŸ“‚ Roleå†…éƒ¨ä»»åŠ¡ç»§æ‰¿**
```yaml  
# roles/mysql/tasks/main.yml
---
- name: å®‰è£…MySQL
  yum:
    name: mysql-server
    state: present
  # ç»§æ‰¿æ ‡ç­¾ï¼šdatabase, mysql, critical

- name: é…ç½®MySQL
  template:
    src: my.cnf.j2
    dest: /etc/my.cnf
  tags:
    - config
  # æ‹¥æœ‰æ ‡ç­¾ï¼šdatabase, mysql, critical, config
```

### 5.3 Import vs Includeçš„æ ‡ç­¾è¡Œä¸º


**ğŸ”„ é™æ€å¯¼å…¥çš„æ ‡ç­¾å¤„ç†**
```yaml
# main.yml
---
- import_tasks: database.yml
  tags:
    - db-setup
    
# database.ymlä¸­çš„æ‰€æœ‰ä»»åŠ¡éƒ½ä¼šè·å¾—db-setupæ ‡ç­¾
```

**ğŸ”„ åŠ¨æ€åŒ…å«çš„æ ‡ç­¾å¤„ç†**
```yaml
# main.yml  
---
- include_tasks: "{{ item }}.yml"
  loop:
    - mysql
    - redis
  tags:
    - database

# åªæœ‰include_tasksè¿™ä¸ªä»»åŠ¡æœ¬èº«æœ‰databaseæ ‡ç­¾
# mysql.ymlå’Œredis.ymlä¸­çš„ä»»åŠ¡ä¸ä¼šè‡ªåŠ¨è·å¾—databaseæ ‡ç­¾
```

---

## 6. â­ ç‰¹æ®Šæ ‡ç­¾è¯¦è§£


### 6.1 alwaysæ ‡ç­¾


**ğŸ”„ å§‹ç»ˆæ‰§è¡Œæ ‡ç­¾**
```yaml
---
- name: ç³»ç»Ÿç»´æŠ¤ä»»åŠ¡
  hosts: all
  tasks:
    - name: æ£€æŸ¥ç£ç›˜ç©ºé—´
      shell: df -h
      tags:
        - always
        - health-check
      register: disk_usage

    - name: æ¸…ç†ä¸´æ—¶æ–‡ä»¶  
      file:
        path: /tmp/ansible-*
        state: absent
      tags:
        - cleanup

    - name: å®‰è£…è½¯ä»¶åŒ…
      yum:
        name: htop
        state: present
      tags:
        - packages
```

**âœ… alwaysæ ‡ç­¾çš„è¡Œä¸º**
```bash
# å³ä½¿æŒ‡å®šç‰¹å®šæ ‡ç­¾ï¼Œalwaysæ ‡ç­¾çš„ä»»åŠ¡ä»ä¼šæ‰§è¡Œ
ansible-playbook maintenance.yml --tags packages
# ç»“æœï¼šç£ç›˜ç©ºé—´æ£€æŸ¥ä»»åŠ¡ä»ç„¶ä¼šæ‰§è¡Œï¼ˆå› ä¸ºæœ‰alwaysæ ‡ç­¾ï¼‰

# é™¤éæ˜ç¡®è·³è¿‡alwaysæ ‡ç­¾
ansible-playbook maintenance.yml --tags packages --skip-tags always
# ç»“æœï¼šåªæ‰§è¡Œpackagesç›¸å…³ä»»åŠ¡ï¼Œè·³è¿‡ç£ç›˜æ£€æŸ¥
```

### 6.2 neveræ ‡ç­¾


**ğŸš« ä»ä¸è‡ªåŠ¨æ‰§è¡Œæ ‡ç­¾**
```yaml
---
- name: åº”ç”¨ç»´æŠ¤
  hosts: appservers
  tasks:
    - name: æ­£å¸¸çš„åº”ç”¨é‡å¯
      service:
        name: myapp
        state: restarted
      tags:
        - restart
        - app

    - name: å±é™©çš„æ•°æ®åº“é‡å»º
      shell: /usr/bin/rebuild-database.sh
      tags:
        - never
        - dangerous
        - rebuild

    - name: æ¸…ç†æ‰€æœ‰æ—¥å¿—
      shell: rm -rf /var/log/myapp/*
      tags:
        - never
        - cleanup
        - destructive
```

**âš ï¸ neveræ ‡ç­¾çš„è¡Œä¸º**
```bash
# æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡ï¼Œä½†neveræ ‡ç­¾çš„ä»»åŠ¡ä¸ä¼šæ‰§è¡Œ
ansible-playbook app-maintenance.yml
# ç»“æœï¼šåªæ‰§è¡Œåº”ç”¨é‡å¯ï¼Œè·³è¿‡å±é™©æ“ä½œ

# å¿…é¡»æ˜ç¡®æŒ‡å®šneveræ ‡ç­¾æ‰ä¼šæ‰§è¡Œ
ansible-playbook app-maintenance.yml --tags never
# ç»“æœï¼šåªæ‰§è¡Œdangerouså’Œdestructiveæ“ä½œ

# å¯ä»¥ç»„åˆä½¿ç”¨
ansible-playbook app-maintenance.yml --tags "restart,rebuild"
# ç»“æœï¼šæ‰§è¡Œé‡å¯å’Œæ•°æ®åº“é‡å»º
```

### 6.3 taggedå’Œuntaggedæ ‡ç­¾


**ğŸ·ï¸ æ ‡ç­¾çŠ¶æ€è¿‡æ»¤**
```bash
# åªæ‰§è¡Œæœ‰æ ‡ç­¾çš„ä»»åŠ¡
ansible-playbook site.yml --tags tagged

# åªæ‰§è¡Œæ²¡æœ‰æ ‡ç­¾çš„ä»»åŠ¡  
ansible-playbook site.yml --tags untagged

# æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡ï¼ˆç­‰ä»·äºä¸ä½¿ç”¨æ ‡ç­¾è¿‡æ»¤ï¼‰
ansible-playbook site.yml --tags tagged,untagged
```

**ğŸ“ å®é™…åº”ç”¨ç¤ºä¾‹**
```yaml
---
- name: æ··åˆæ ‡ç­¾æµ‹è¯•
  hosts: test
  tasks:
    - name: å®‰è£…åŸºç¡€åŒ…
      yum:
        name: vim
        state: present
      # æ²¡æœ‰æ ‡ç­¾

    - name: é…ç½®SSH
      service:
        name: ssh
        state: started
      tags:
        - security
        - ssh

    - name: åˆ›å»ºç”¨æˆ·
      user:
        name: testuser
      # æ²¡æœ‰æ ‡ç­¾
```

---

## 7. ğŸ› è°ƒè¯•ä¸­çš„æ ‡ç­¾åº”ç”¨


### 7.1 è°ƒè¯•æ ‡ç­¾ç­–ç•¥


**ğŸ”§ è°ƒè¯•ä¸“ç”¨æ ‡ç­¾è®¾è®¡**
```yaml
---
- name: åº”ç”¨éƒ¨ç½²è°ƒè¯•ç‰ˆæœ¬
  hosts: devservers
  tasks:
    - name: ä¸‹è½½åº”ç”¨ä»£ç 
      git:
        repo: https://github.com/company/app.git
        dest: /opt/app
      tags:
        - deploy
        - code
        - debug

    - name: æ˜¾ç¤ºä»£ç ä¿¡æ¯
      debug:
        var: ansible_date_time
      tags:
        - debug
        - info

    - name: æ£€æŸ¥ä¾èµ–
      shell: /opt/app/check-deps.sh
      register: deps_result
      tags:
        - deploy
        - deps
        - debug

    - name: æ˜¾ç¤ºä¾èµ–æ£€æŸ¥ç»“æœ
      debug:
        var: deps_result.stdout_lines
      tags:
        - debug
        - info
        - deps
```

**ğŸ› åˆ†æ­¥éª¤è°ƒè¯•**
```bash
# ç¬¬ä¸€æ­¥ï¼šåªè·å–ä»£ç ï¼Œæ£€æŸ¥æ˜¯å¦æ­£ç¡®
ansible-playbook app-deploy.yml --tags code

# ç¬¬äºŒæ­¥ï¼šæ£€æŸ¥ä¾èµ–ï¼ŒæŸ¥çœ‹è¾“å‡ºä¿¡æ¯
ansible-playbook app-deploy.yml --tags "deps,debug"

# ç¬¬ä¸‰æ­¥ï¼šå®Œæ•´éƒ¨ç½²ä½†æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯
ansible-playbook app-deploy.yml --tags "deploy,debug"

# ç”Ÿäº§ç¯å¢ƒï¼šå»æ‰è°ƒè¯•ä¿¡æ¯
ansible-playbook app-deploy.yml --tags deploy --skip-tags debug
```

### 7.2 æ¡ä»¶è°ƒè¯•æ ‡ç­¾


**ğŸ¯ åŸºäºå˜é‡çš„æ ‡ç­¾æ‰§è¡Œ**
```yaml
---
- name: æ™ºèƒ½è°ƒè¯•éƒ¨ç½²
  hosts: all
  vars:
    debug_mode: "{{ debug | default(false) }}"
    
  tasks:
    - name: å®‰è£…åº”ç”¨
      yum:
        name: myapp
        state: present
      tags:
        - install
        - app

    - name: æ˜¾ç¤ºå®‰è£…è¯¦æƒ…
      debug:
        msg: "åº”ç”¨å·²å®‰è£…åˆ° {{ ansible_pkg_mgr }}"
      tags:
        - debug
        - install
      when: debug_mode|bool

    - name: å¯åŠ¨åº”ç”¨
      service:
        name: myapp
        state: started
      tags:
        - service
        - app

    - name: éªŒè¯æœåŠ¡çŠ¶æ€
      shell: systemctl status myapp
      register: service_status
      tags:
        - debug
        - verify
      when: debug_mode|bool

    - name: æ˜¾ç¤ºæœåŠ¡çŠ¶æ€
      debug:
        var: service_status.stdout_lines
      tags:
        - debug
        - verify
      when: debug_mode|bool
```

**âš™ï¸ çµæ´»çš„è°ƒè¯•æ¨¡å¼**
```bash
# æ™®é€šæ¨¡å¼ï¼šåªå®‰è£…å’Œå¯åŠ¨
ansible-playbook app.yml

# è°ƒè¯•æ¨¡å¼ï¼šåŒ…å«è¯¦ç»†ä¿¡æ¯
ansible-playbook app.yml -e debug=true --tags "install,debug"

# éªŒè¯æ¨¡å¼ï¼šæ£€æŸ¥æœåŠ¡çŠ¶æ€  
ansible-playbook app.yml -e debug=true --tags "verify,debug"
```

---

## 8. ğŸ­ ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ


### 8.1 æ ‡ç­¾å‘½åè§„èŒƒ


**ğŸ“ æ¨èçš„æ ‡ç­¾å‘½åçº¦å®š**
```yaml
# æŒ‰åŠŸèƒ½åˆ†ç±»
tags:
  - install          # å®‰è£…ç±»ä»»åŠ¡
  - config          # é…ç½®ç±»ä»»åŠ¡  
  - service         # æœåŠ¡ç®¡ç†ç±»ä»»åŠ¡
  - security        # å®‰å…¨ç›¸å…³ä»»åŠ¡
  - backup          # å¤‡ä»½ç›¸å…³ä»»åŠ¡

# æŒ‰ç»„ä»¶åˆ†ç±»  
tags:
  - nginx           # WebæœåŠ¡å™¨
  - mysql           # æ•°æ®åº“
  - redis           # ç¼“å­˜
  - app             # åº”ç”¨ç¨‹åº

# æŒ‰ç¯å¢ƒåˆ†ç±»
tags:
  - dev             # å¼€å‘ç¯å¢ƒ
  - test            # æµ‹è¯•ç¯å¢ƒ  
  - prod            # ç”Ÿäº§ç¯å¢ƒ

# æŒ‰ä¼˜å…ˆçº§åˆ†ç±»
tags:
  - critical        # å…³é”®ä»»åŠ¡
  - important       # é‡è¦ä»»åŠ¡
  - optional        # å¯é€‰ä»»åŠ¡
  - maintenance     # ç»´æŠ¤ä»»åŠ¡
```

### 8.2 åˆ†å±‚æ ‡ç­¾ç­–ç•¥


**ğŸ—ï¸ å¤šå±‚æ ‡ç­¾è®¾è®¡**
```yaml
---
- name: ç”Ÿäº§ç¯å¢ƒLAMPéƒ¨ç½²
  hosts: production
  tasks:
    - name: å®‰è£…Apache
      yum:
        name: httpd
        state: present
      tags:
        - lamp          # é¡¹ç›®æ ‡ç­¾
        - web           # æœåŠ¡æ ‡ç­¾  
        - apache        # ç»„ä»¶æ ‡ç­¾
        - install       # åŠŸèƒ½æ ‡ç­¾
        - critical      # ä¼˜å…ˆçº§æ ‡ç­¾

    - name: é…ç½®Apache SSL
      template:
        src: ssl.conf.j2
        dest: /etc/httpd/conf.d/ssl.conf
      tags:
        - lamp
        - web
        - apache
        - config
        - security
        - important

    - name: å®‰è£…PHP
      yum:
        name: "{{ php_packages }}"
        state: present
      tags:
        - lamp
        - web
        - php
        - install
        - critical

    - name: é…ç½®PHP
      template:
        src: php.ini.j2
        dest: /etc/php.ini
      tags:
        - lamp
        - web
        - php
        - config
        - important
```

**ğŸ¯ åˆ†å±‚æ‰§è¡Œç­–ç•¥**
```bash
# æŒ‰é¡¹ç›®æ‰§è¡Œæ•´å¥—LAMP
ansible-playbook lamp.yml --tags lamp

# æŒ‰æœåŠ¡ç±»å‹æ‰§è¡Œ
ansible-playbook lamp.yml --tags web

# æŒ‰åŠŸèƒ½æ‰§è¡Œ  
ansible-playbook lamp.yml --tags install    # åªå®‰è£…
ansible-playbook lamp.yml --tags config     # åªé…ç½®

# æŒ‰ä¼˜å…ˆçº§æ‰§è¡Œ
ansible-playbook lamp.yml --tags critical   # å…³é”®ä»»åŠ¡
ansible-playbook lamp.yml --tags important  # é‡è¦ä»»åŠ¡

# ç»„åˆæ‰§è¡Œ
ansible-playbook lamp.yml --tags "apache,config"  # Apacheé…ç½®
```

### 8.3 ç‰ˆæœ¬å‘å¸ƒçš„æ ‡ç­¾ç­–ç•¥


**ğŸš€ å‘å¸ƒæµç¨‹æ ‡ç­¾åŒ–**
```yaml
---
- name: åº”ç”¨ç‰ˆæœ¬å‘å¸ƒ
  hosts: webservers
  tasks:
    # å‡†å¤‡é˜¶æ®µ
    - name: å¤‡ä»½å½“å‰ç‰ˆæœ¬
      shell: tar -czf /backup/app-$(date +%Y%m%d-%H%M%S).tar.gz /opt/app
      tags:
        - release
        - prepare
        - backup
        - always

    - name: åœæ­¢åº”ç”¨æœåŠ¡
      service:
        name: myapp
        state: stopped
      tags:
        - release
        - prepare  
        - service

    # éƒ¨ç½²é˜¶æ®µ
    - name: ä¸‹è½½æ–°ç‰ˆæœ¬
      get_url:
        url: "{{ app_download_url }}"
        dest: /tmp/app-{{ app_version }}.tar.gz
      tags:
        - release
        - deploy
        - download

    - name: è§£å‹æ–°ç‰ˆæœ¬
      unarchive:
        src: /tmp/app-{{ app_version }}.tar.gz
        dest: /opt/app
        remote_src: yes
      tags:
        - release
        - deploy
        - extract

    - name: æ›´æ–°é…ç½®æ–‡ä»¶
      template:
        src: "{{ item }}.j2"
        dest: "/opt/app/config/{{ item }}"
      loop:
        - app.conf
        - database.conf  
      tags:
        - release
        - deploy
        - config

    # å¯åŠ¨é˜¶æ®µ
    - name: å¯åŠ¨åº”ç”¨æœåŠ¡
      service:
        name: myapp
        state: started
      tags:
        - release
        - start
        - service

    - name: å¥åº·æ£€æŸ¥
      uri:
        url: "http://{{ inventory_hostname }}:8080/health"
        method: GET
      tags:
        - release
        - verify
        - health

    # æ¸…ç†é˜¶æ®µ
    - name: æ¸…ç†ä¸´æ—¶æ–‡ä»¶
      file:
        path: /tmp/app-{{ app_version }}.tar.gz
        state: absent
      tags:
        - release
        - cleanup
        - optional
```

**ğŸ“‹ åˆ†é˜¶æ®µå‘å¸ƒæ‰§è¡Œ**
```bash
# å®Œæ•´å‘å¸ƒæµç¨‹
ansible-playbook release.yml --tags release

# åªæ‰§è¡Œå‡†å¤‡å·¥ä½œ
ansible-playbook release.yml --tags prepare

# åªéƒ¨ç½²ï¼Œä¸åœæ­¢å’Œå¯åŠ¨æœåŠ¡
ansible-playbook release.yml --tags deploy

# å¿«é€Ÿé‡å¯å’ŒéªŒè¯
ansible-playbook release.yml --tags "start,verify"

# ç´§æ€¥æƒ…å†µï¼šè·³è¿‡å¤‡ä»½ç›´æ¥å‘å¸ƒ
ansible-playbook release.yml --tags release --skip-tags backup
```

---

## 9. ğŸ“Š æ ‡ç­¾ç®¡ç†ç­–ç•¥


### 9.1 æ ‡ç­¾æ–‡æ¡£åŒ–


**ğŸ“‹ æ ‡ç­¾ä½¿ç”¨æ–‡æ¡£**
```yaml
# åœ¨Playbookå¼€å¤´æ³¨é‡Šè¯´æ˜æ ‡ç­¾ç”¨é€”
# æ ‡ç­¾è¯´æ˜æ–‡æ¡£
# =====================
# åŠŸèƒ½æ ‡ç­¾:
#   install  - è½¯ä»¶åŒ…å®‰è£…
#   config   - é…ç½®æ–‡ä»¶ç®¡ç†
#   service  - æœåŠ¡ç®¡ç†
#   security - å®‰å…¨é…ç½®
#   backup   - å¤‡ä»½æ“ä½œ
#
# ç»„ä»¶æ ‡ç­¾:
#   web      - WebæœåŠ¡å™¨ç›¸å…³
#   db       - æ•°æ®åº“ç›¸å…³
#   cache    - ç¼“å­˜ç›¸å…³
#
# ç¯å¢ƒæ ‡ç­¾:
#   dev      - å¼€å‘ç¯å¢ƒ
#   test     - æµ‹è¯•ç¯å¢ƒ
#   prod     - ç”Ÿäº§ç¯å¢ƒ
#
# ä½¿ç”¨ç¤ºä¾‹:
#   ansible-playbook site.yml --tags "web,config"
#   ansible-playbook site.yml --tags install --skip-tags security
#
---
- name: ä¼ä¸šçº§Webåº”ç”¨éƒ¨ç½²
  hosts: "{{ target_env | default('all') }}"
  # ... tasks here
```

### 9.2 æ ‡ç­¾ä¸€è‡´æ€§æ£€æŸ¥


**ğŸ” æ ‡ç­¾è§„èŒƒæ£€æŸ¥è„šæœ¬**
```bash
#!/bin/bash
# check-tags.sh - æ£€æŸ¥Playbookæ ‡ç­¾è§„èŒƒ

# å®šä¹‰å…è®¸çš„æ ‡ç­¾åˆ—è¡¨
ALLOWED_TAGS=(
    "install" "config" "service" "security" "backup"
    "web" "db" "cache" "app" 
    "dev" "test" "prod"
    "critical" "important" "optional"
    "always" "never" "debug"
)

# æ£€æŸ¥Playbookä¸­ä½¿ç”¨çš„æ ‡ç­¾
check_playbook_tags() {
    local playbook=$1
    echo "æ£€æŸ¥ $playbook ä¸­çš„æ ‡ç­¾..."
    
    # æå–æ‰€æœ‰æ ‡ç­¾
    grep -r "tags:" $playbook | grep -v "#" | \
    sed 's/.*tags://' | tr -d '[]"' | tr ',' '\n' | \
    sed 's/^[[:space:]]*//' | sed 's/[[:space:]]*$//' | \
    sort | uniq > /tmp/used_tags.txt
    
    # æ£€æŸ¥ä¸è§„èŒƒçš„æ ‡ç­¾
    while IFS= read -r tag; do
        if [[ ! " ${ALLOWED_TAGS[@]} " =~ " ${tag} " ]]; then
            echo "è­¦å‘Š: å‘ç°ä¸è§„èŒƒæ ‡ç­¾ '$tag'"
        fi
    done < /tmp/used_tags.txt
}

# ä½¿ç”¨æ–¹æ³•
check_playbook_tags "$1"
```

### 9.3 åŠ¨æ€æ ‡ç­¾ç”Ÿæˆ


**ğŸ”„ åŸºäºå˜é‡çš„æ ‡ç­¾**
```yaml
---
- name: åŠ¨æ€ç¯å¢ƒéƒ¨ç½²
  hosts: "{{ env }}_servers"
  vars:
    env_tags:
      dev: ["development", "testing", "non-critical"]
      test: ["testing", "staging", "important"]  
      prod: ["production", "critical", "monitored"]
      
  tasks:
    - name: å®‰è£…åº”ç”¨
      yum:
        name: myapp
        state: present
      tags: "{{ ['install', 'app'] + env_tags[env] }}"

    - name: é…ç½®åº”ç”¨
      template:
        src: app.conf.j2
        dest: /etc/myapp/app.conf
      tags: "{{ ['config', 'app'] + env_tags[env] }}"
```

**âš™ï¸ æ™ºèƒ½æ ‡ç­¾é€‰æ‹©**
```bash
# å¼€å‘ç¯å¢ƒéƒ¨ç½²
ansible-playbook dynamic.yml -e env=dev --tags development

# ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²  
ansible-playbook dynamic.yml -e env=prod --tags critical

# è·¨ç¯å¢ƒé€šç”¨æ“ä½œ
ansible-playbook dynamic.yml --tags "install,config"
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ æ ‡ç­¾æœ¬è´¨ï¼šç»™ä»»åŠ¡æ‰“æ ‡è®°ï¼Œå®ç°é€‰æ‹©æ€§æ‰§è¡Œ
ğŸ”¸ å®šä¹‰æ–¹å¼ï¼šä»»åŠ¡çº§ã€Playçº§ã€Roleçº§å¤šå±‚æ ‡ç­¾å®šä¹‰
ğŸ”¸ æ‰§è¡Œæ§åˆ¶ï¼š--tagsåŒ…å«ï¼Œ--skip-tagsæ’é™¤
ğŸ”¸ ç»§æ‰¿æœºåˆ¶ï¼šä¸‹çº§ä»»åŠ¡ç»§æ‰¿ä¸Šçº§æ ‡ç­¾
ğŸ”¸ ç‰¹æ®Šæ ‡ç­¾ï¼šalwaysã€neverã€taggedã€untagged
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æ ‡ç­¾çš„æ ¸å¿ƒä»·å€¼**
```
é€‰æ‹©æ€§æ‰§è¡Œï¼š
- å¤§å‹Playbookä¸­å¿«é€Ÿæ‰§è¡Œç‰¹å®šä»»åŠ¡
- é¿å…ä¸å¿…è¦çš„é‡å¤æ“ä½œ
- æé«˜è¿ç»´æ•ˆç‡å’Œå‡†ç¡®æ€§

çµæ´»éƒ¨ç½²ï¼š
- ä¸€ä¸ªPlaybookæ”¯æŒå¤šç§æ‰§è¡Œæ¨¡å¼
- é€‚åº”ä¸åŒç¯å¢ƒå’Œåœºæ™¯éœ€æ±‚
- åˆ†é˜¶æ®µéƒ¨ç½²å’Œé—®é¢˜æ’æŸ¥

è°ƒè¯•ä¾¿åˆ©ï¼š
- å¿«é€Ÿå®šä½å’Œæµ‹è¯•ç‰¹å®šåŠŸèƒ½
- åˆ†æ­¥éª¤éªŒè¯éƒ¨ç½²è¿‡ç¨‹
- é—®é¢˜æ’æŸ¥æ—¶ç²¾å‡†æ‰§è¡Œ
```

**ğŸ”¹ æ ‡ç­¾ä½¿ç”¨çš„æœ€ä½³å®è·µ**
```
å‘½åè§„èŒƒï¼š
âœ… ä½¿ç”¨æœ‰æ„ä¹‰çš„æ ‡ç­¾åç§°
âœ… ä¿æŒå‘½åä¸€è‡´æ€§
âœ… å»ºç«‹æ ‡ç­¾åˆ†ç±»ä½“ç³»

å±‚æ¬¡è®¾è®¡ï¼š
âœ… åŠŸèƒ½æ ‡ç­¾ + ç»„ä»¶æ ‡ç­¾ + ç¯å¢ƒæ ‡ç­¾
âœ… ä»é€šç”¨åˆ°å…·ä½“çš„å±‚æ¬¡ç»“æ„
âœ… æ”¯æŒçµæ´»çš„ç»„åˆä½¿ç”¨

æ–‡æ¡£ç»´æŠ¤ï¼š
âœ… åœ¨Playbookä¸­æ³¨é‡Šæ ‡ç­¾ç”¨é€”
âœ… ç»´æŠ¤æ ‡ç­¾ä½¿ç”¨è§„èŒƒæ–‡æ¡£
âœ… å®šæœŸæ£€æŸ¥æ ‡ç­¾ä¸€è‡´æ€§
```

### 10.3 å®é™…åº”ç”¨æŒ‡å—


**ğŸ’¡ æ—¥å¸¸è¿ç»´åœºæ™¯**
```
å¿«é€Ÿéƒ¨ç½²ï¼š
ansible-playbook site.yml --tags "install,config"

é…ç½®æ›´æ–°ï¼š  
ansible-playbook site.yml --tags config --skip-tags service

æ•…éšœæ’æŸ¥ï¼š
ansible-playbook debug.yml --tags "verify,debug"

åˆ†é˜¶æ®µå‘å¸ƒï¼š
ansible-playbook release.yml --tags prepare
ansible-playbook release.yml --tags deploy  
ansible-playbook release.yml --tags verify
```

**ğŸ”§ é«˜çº§æŠ€å·§**
```
æ¡ä»¶æ‰§è¡Œï¼š
- ç»“åˆwhenæ¡ä»¶å’Œæ ‡ç­¾å®ç°æ™ºèƒ½æ‰§è¡Œ
- åŸºäºå˜é‡åŠ¨æ€ç”Ÿæˆæ ‡ç­¾
- ç¯å¢ƒæ„ŸçŸ¥çš„æ ‡ç­¾ç­–ç•¥

æ€§èƒ½ä¼˜åŒ–ï¼š
- ä½¿ç”¨æ ‡ç­¾é¿å…ä¸å¿…è¦çš„ä»»åŠ¡æ‰§è¡Œ
- åœ¨å¤§å‹ç¯å¢ƒä¸­æ˜¾è‘—æå‡æ‰§è¡Œé€Ÿåº¦
- å‡å°‘å¯¹ç”Ÿäº§ç¯å¢ƒçš„å½±å“æ—¶é—´

å›¢é˜Ÿåä½œï¼š
- å»ºç«‹æ ‡ç­¾ä½¿ç”¨è§„èŒƒ
- ç»Ÿä¸€æ ‡ç­¾å‘½åçº¦å®š
- æ–‡æ¡£åŒ–æ ‡ç­¾çš„ç”¨é€”å’Œæœ€ä½³å®è·µ
```

### 10.4 å¸¸è§è¯¯åŒºæé†’


```
âŒ é¿å…çš„é”™è¯¯åšæ³•ï¼š
- è¿‡åº¦ä½¿ç”¨æ ‡ç­¾ï¼Œè®©Playbookå˜å¾—å¤æ‚
- æ ‡ç­¾å‘½åä¸è§„èŒƒï¼Œç¼ºä¹ä¸€è‡´æ€§
- æ²¡æœ‰æ–‡æ¡£åŒ–æ ‡ç­¾ç”¨é€”
- å¿½ç•¥æ ‡ç­¾ç»§æ‰¿å…³ç³»

âœ… æ¨èçš„æ­£ç¡®åšæ³•ï¼š
- é€‚åº¦ä½¿ç”¨æ ‡ç­¾ï¼Œä¿æŒç®€æ´æ˜äº†
- å»ºç«‹å¹¶éµå¾ªæ ‡ç­¾å‘½åè§„èŒƒ
- ç»´æŠ¤æ ‡ç­¾ä½¿ç”¨æ–‡æ¡£
- ç†è§£å’Œåˆ©ç”¨æ ‡ç­¾ç»§æ‰¿æœºåˆ¶
```

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- æ ‡ç­¾æ˜¯Ansibleä¸­å®ç°çµæ´»æ‰§è¡Œçš„é‡è¦å·¥å…·
- åˆç†çš„æ ‡ç­¾è®¾è®¡èƒ½æ˜¾è‘—æå‡è¿ç»´æ•ˆç‡
- æ ‡ç­¾ç»§æ‰¿å’Œç‰¹æ®Šæ ‡ç­¾æ˜¯é«˜çº§ç”¨æ³•çš„åŸºç¡€
- ç”Ÿäº§ç¯å¢ƒä¸­éœ€è¦å»ºç«‹æ ‡ç­¾ç®¡ç†è§„èŒƒ