---
title: 2ã€è§’è‰²ç›®å½•ç»“æ„
---
## ğŸ“š ç›®å½•

1. [Rolesè§’è‰²ç³»ç»Ÿæ¦‚è¿°](#1-Rolesè§’è‰²ç³»ç»Ÿæ¦‚è¿°)
2. [æ ‡å‡†ç›®å½•ç»“æ„è¯¦è§£](#2-æ ‡å‡†ç›®å½•ç»“æ„è¯¦è§£)
3. [æ ¸å¿ƒç›®å½•åŠŸèƒ½è¯´æ˜](#3-æ ¸å¿ƒç›®å½•åŠŸèƒ½è¯´æ˜)
4. [ç›®å½•åˆ›å»ºè§„èŒƒä¸æœ€ä½³å®è·µ](#4-ç›®å½•åˆ›å»ºè§„èŒƒä¸æœ€ä½³å®è·µ)
5. [å®é™…åº”ç”¨ç¤ºä¾‹](#5-å®é™…åº”ç”¨ç¤ºä¾‹)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ Rolesè§’è‰²ç³»ç»Ÿæ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯Ansible Roles


**é€šä¿—ç†è§£**ï¼šå¦‚æœè¯´Playbookæ˜¯ä¸€ä¸ªåšèœçš„å®Œæ•´æµç¨‹ï¼Œé‚£ä¹ˆRoleså°±æ˜¯æŠŠè¿™ä¸ªæµç¨‹æ‹†åˆ†æˆä¸€ä¸ªä¸ªç‹¬ç«‹çš„"èœè°±æ¨¡å—"ã€‚æ¯ä¸ªRoleä¸“é—¨è´Ÿè´£ä¸€ä»¶äº‹æƒ…ï¼Œæ¯”å¦‚å®‰è£…WebæœåŠ¡å™¨ã€é…ç½®æ•°æ®åº“ç­‰ã€‚

**æ ¸å¿ƒä½œç”¨**ï¼š
```
ä¼ ç»Ÿæ–¹å¼ï¼šæ‰€æœ‰ä»»åŠ¡å†™åœ¨ä¸€ä¸ªå¤§æ–‡ä»¶é‡Œ
my-playbook.yml (500è¡Œä»£ç ï¼Œéš¾ç»´æŠ¤)

Rolesæ–¹å¼ï¼šæŒ‰åŠŸèƒ½æ‹†åˆ†æˆå°æ¨¡å—
nginx-role/     â† ä¸“é—¨å¤„ç†Nginx
mysql-role/     â† ä¸“é—¨å¤„ç†MySQL  
common-role/    â† å¤„ç†é€šç”¨é…ç½®
```

**ä¸ºä»€ä¹ˆéœ€è¦Roles**ï¼š
- **å¤ç”¨æ€§**ï¼šä¸€æ¬¡ç¼–å†™ï¼Œå¤šå¤„ä½¿ç”¨
- **ç»„ç»‡æ€§**ï¼šä»£ç ç»“æ„æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤
- **åä½œæ€§**ï¼šå›¢é˜Ÿå¯ä»¥åˆ†å·¥å¼€å‘ä¸åŒRole
- **æ ‡å‡†åŒ–**ï¼šç»Ÿä¸€çš„ç›®å½•ç»“æ„å’Œè§„èŒƒ

### 1.2 Roles vs Playbookçš„åŒºåˆ«


```
æ™®é€šPlaybookç»“æ„ï¼š
site.yml
â”œâ”€â”€ æ‰€æœ‰tasksæ··åœ¨ä¸€èµ·
â”œâ”€â”€ æ‰€æœ‰å˜é‡æ··åœ¨ä¸€èµ·  
â””â”€â”€ æ‰€æœ‰æ–‡ä»¶æ··åœ¨ä¸€èµ·

Rolesç»“æ„ï¼š
site.yml
â”œâ”€â”€ roles/
â”‚   â”œâ”€â”€ webserver/    â† ç‹¬ç«‹çš„webæœåŠ¡å™¨é…ç½®
â”‚   â”œâ”€â”€ database/     â† ç‹¬ç«‹çš„æ•°æ®åº“é…ç½®
â”‚   â””â”€â”€ monitoring/   â† ç‹¬ç«‹çš„ç›‘æ§é…ç½®
```

> ğŸ’¡ **æ ¸å¿ƒç†è§£**ï¼šRoleå°±æ˜¯æŠŠç›¸å…³çš„tasksã€å˜é‡ã€æ–‡ä»¶ç­‰æ‰“åŒ…æˆä¸€ä¸ªå¯é‡ç”¨çš„"åŠŸèƒ½åŒ…"

---

## 2. ğŸ“ æ ‡å‡†ç›®å½•ç»“æ„è¯¦è§£


### 2.1 å®Œæ•´çš„Roleç›®å½•ç»“æ„


```
my-role/
â”œâ”€â”€ tasks/              â† ä¸»è¦ä»»åŠ¡ç›®å½•ï¼ˆå¿…é¡»ï¼‰
â”‚   â””â”€â”€ main.yml       â† ä»»åŠ¡å…¥å£æ–‡ä»¶
â”œâ”€â”€ handlers/          â† äº‹ä»¶å¤„ç†å™¨ç›®å½•
â”‚   â””â”€â”€ main.yml       â† å¤„ç†å™¨å®šä¹‰æ–‡ä»¶
â”œâ”€â”€ templates/         â† Jinja2æ¨¡æ¿ç›®å½•
â”‚   â””â”€â”€ config.j2      â† æ¨¡æ¿æ–‡ä»¶
â”œâ”€â”€ files/             â† é™æ€æ–‡ä»¶ç›®å½•
â”‚   â””â”€â”€ script.sh      â† éœ€è¦å¤åˆ¶çš„æ–‡ä»¶
â”œâ”€â”€ vars/              â† è§’è‰²å˜é‡ç›®å½•
â”‚   â””â”€â”€ main.yml       â† å˜é‡å®šä¹‰æ–‡ä»¶
â”œâ”€â”€ defaults/          â† é»˜è®¤å˜é‡ç›®å½•
â”‚   â””â”€â”€ main.yml       â† é»˜è®¤å€¼å®šä¹‰
â”œâ”€â”€ meta/              â† å…ƒæ•°æ®ç›®å½•
â”‚   â””â”€â”€ main.yml       â† è§’è‰²ä¾èµ–å’Œä¿¡æ¯
â””â”€â”€ README.md          â† è¯´æ˜æ–‡æ¡£
```

### 2.2 ç›®å½•ç»“æ„çš„è®¾è®¡ç†å¿µ


**åˆ†ç¦»åŸåˆ™**ï¼š
```
é…ç½® â†’ templates/     (å¯å˜çš„é…ç½®æ–‡ä»¶)
æ–‡ä»¶ â†’ files/         (ä¸å˜çš„é™æ€æ–‡ä»¶)
é€»è¾‘ â†’ tasks/         (æ‰§è¡Œçš„æ“ä½œæ­¥éª¤)
å˜é‡ â†’ vars/defaults/ (é…ç½®å‚æ•°)
```

**åŠ è½½é¡ºåº**ï¼š
1. `defaults/main.yml` - é»˜è®¤å˜é‡ï¼ˆä¼˜å…ˆçº§æœ€ä½ï¼‰
2. `vars/main.yml` - è§’è‰²å˜é‡ï¼ˆä¼˜å…ˆçº§è¾ƒé«˜ï¼‰
3. `tasks/main.yml` - ä¸»è¦ä»»åŠ¡é€»è¾‘
4. `handlers/main.yml` - äº‹ä»¶å“åº”å¤„ç†

---

## 3. ğŸ”§ æ ¸å¿ƒç›®å½•åŠŸèƒ½è¯´æ˜


### 3.1 tasks/ - ä¸»ä»»åŠ¡ç›®å½•


**ä½œç”¨**ï¼šå­˜æ”¾è¿™ä¸ªRoleè¦æ‰§è¡Œçš„æ‰€æœ‰ä»»åŠ¡é€»è¾‘

```yaml
# tasks/main.yml - å…¥å£æ–‡ä»¶ç¤ºä¾‹
---
- name: å®‰è£…Nginx
  yum:
    name: nginx
    state: present

- name: å¯åŠ¨å¹¶å¯ç”¨NginxæœåŠ¡
  service:
    name: nginx
    state: started
    enabled: yes
    
- name: å¤åˆ¶Nginxé…ç½®æ–‡ä»¶
  template:
    src: nginx.conf.j2
    dest: /etc/nginx/nginx.conf
  notify: é‡å¯nginx
```

> ğŸ”‘ **å…³é”®ç†è§£**ï¼štasks/main.ymlæ˜¯Roleçš„"å¤§è„‘"ï¼Œå®šä¹‰äº†è¿™ä¸ªRoleè¦åšä»€ä¹ˆäº‹æƒ…

**ä»»åŠ¡æ‹†åˆ†æŠ€å·§**ï¼š
```yaml
# å¯ä»¥æŠŠå¤§ä»»åŠ¡æ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶
- import_tasks: install.yml    # å®‰è£…ç›¸å…³ä»»åŠ¡
- import_tasks: config.yml     # é…ç½®ç›¸å…³ä»»åŠ¡
- import_tasks: service.yml    # æœåŠ¡ç›¸å…³ä»»åŠ¡
```

### 3.2 handlers/ - å¤„ç†å™¨ç›®å½•


**ä½œç”¨**ï¼šå®šä¹‰å½“æŸäº›ä»»åŠ¡å‘ç”Ÿå˜åŒ–æ—¶è¦æ‰§è¡Œçš„æ“ä½œ

**ç”Ÿæ´»ç±»æ¯”**ï¼šå°±åƒå®¶é‡Œçš„çƒŸé›¾æŠ¥è­¦å™¨ï¼Œåªæœ‰æ£€æµ‹åˆ°çƒŸé›¾ï¼ˆä»»åŠ¡å‘ç”Ÿå˜åŒ–ï¼‰æ—¶æ‰ä¼šå“ï¼ˆæ‰§è¡Œå¤„ç†å™¨ï¼‰

```yaml
# handlers/main.yml ç¤ºä¾‹
---
- name: é‡å¯nginx
  service:
    name: nginx
    state: restarted
    
- name: é‡æ–°åŠ è½½nginxé…ç½®
  service:
    name: nginx
    state: reloaded
```

**ä½¿ç”¨åœºæ™¯**ï¼š
- é…ç½®æ–‡ä»¶æ”¹å˜ â†’ é‡å¯æœåŠ¡
- è¯ä¹¦æ›´æ–° â†’ é‡æ–°åŠ è½½é…ç½®
- ä»£ç éƒ¨ç½² â†’ é‡å¯åº”ç”¨

### 3.3 templates/ - æ¨¡æ¿ç›®å½•


**ä½œç”¨**ï¼šå­˜æ”¾å¯ä»¥æ ¹æ®å˜é‡åŠ¨æ€ç”Ÿæˆå†…å®¹çš„é…ç½®æ–‡ä»¶æ¨¡æ¿

**æ¨¡æ¿ vs é™æ€æ–‡ä»¶çš„åŒºåˆ«**ï¼š
```
é™æ€æ–‡ä»¶ï¼ˆfiles/ï¼‰ï¼š
å†…å®¹å›ºå®šï¼Œç›´æ¥å¤åˆ¶
é€‚ç”¨ï¼šè„šæœ¬æ–‡ä»¶ã€è¯ä¹¦æ–‡ä»¶ç­‰

æ¨¡æ¿æ–‡ä»¶ï¼ˆtemplates/ï¼‰ï¼š  
å†…å®¹å¯å˜ï¼Œæ ¹æ®å˜é‡ç”Ÿæˆ
é€‚ç”¨ï¼šé…ç½®æ–‡ä»¶ã€ç¯å¢ƒç›¸å…³æ–‡ä»¶
```

```jinja2
# templates/nginx.conf.j2 ç¤ºä¾‹
server {
    listen {{ nginx_port | default(80) }};
    server_name {{ server_name }};
    
    location / {
        proxy_pass http://{{ backend_host }}:{{ backend_port }};
    }
}
```

### 3.4 files/ - é™æ€æ–‡ä»¶ç›®å½•


**ä½œç”¨**ï¼šå­˜æ”¾éœ€è¦åŸæ ·å¤åˆ¶åˆ°ç›®æ ‡æœåŠ¡å™¨çš„æ–‡ä»¶

```
files/
â”œâ”€â”€ startup.sh          â† å¯åŠ¨è„šæœ¬
â”œâ”€â”€ ssl/                â† SSLè¯ä¹¦
â”‚   â”œâ”€â”€ server.crt
â”‚   â””â”€â”€ server.key
â””â”€â”€ config/
    â””â”€â”€ app.conf        â† å›ºå®šé…ç½®æ–‡ä»¶
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```yaml
- name: å¤åˆ¶å¯åŠ¨è„šæœ¬
  copy:
    src: startup.sh
    dest: /opt/app/startup.sh
    mode: '0755'
```

### 3.5 vars/ - è§’è‰²å˜é‡ç›®å½•


**ä½œç”¨**ï¼šå®šä¹‰è¿™ä¸ªRoleä¸“ç”¨çš„å˜é‡ï¼Œä¼˜å…ˆçº§è¾ƒé«˜

```yaml
# vars/main.yml ç¤ºä¾‹
---
nginx_version: "1.18"
nginx_user: "nginx"
nginx_worker_processes: "{{ ansible_processor_cores }}"

# å¤æ‚æ•°æ®ç»“æ„
nginx_sites:
  - name: "example.com"
    port: 80
    root: "/var/www/example"
  - name: "api.example.com"  
    port: 8080
    root: "/var/www/api"
```

### 3.6 defaults/ - é»˜è®¤å˜é‡ç›®å½•


**ä½œç”¨**ï¼šå®šä¹‰å˜é‡çš„é»˜è®¤å€¼ï¼Œå¯ä»¥è¢«å¤–éƒ¨è¦†ç›–

```yaml
# defaults/main.yml ç¤ºä¾‹
---
# åŸºæœ¬é…ç½®
nginx_port: 80
nginx_user: nginx
nginx_worker_connections: 1024

# å¯é€‰åŠŸèƒ½å¼€å…³
nginx_ssl_enabled: false
nginx_gzip_enabled: true
nginx_access_log_enabled: true
```

**vars/ vs defaults/ çš„åŒºåˆ«**ï¼š
```
defaults/main.ymlï¼š
- ä¼˜å…ˆçº§æœ€ä½ï¼Œå®¹æ˜“è¢«è¦†ç›–
- ç”¨äºè®¾ç½®"åˆç†çš„é»˜è®¤å€¼"
- è®©Roleå¯ä»¥"å¼€ç®±å³ç”¨"

vars/main.ymlï¼š
- ä¼˜å…ˆçº§è¾ƒé«˜ï¼Œä¸å®¹æ˜“è¢«è¦†ç›–  
- ç”¨äºRoleå†…éƒ¨çš„"å›ºå®šé…ç½®"
- å®šä¹‰Roleè¿è¡Œå¿…é¡»çš„å‚æ•°
```

### 3.7 meta/ - å…ƒæ•°æ®ç›®å½•


**ä½œç”¨**ï¼šå®šä¹‰Roleçš„ä¾èµ–å…³ç³»ã€ä½œè€…ä¿¡æ¯ç­‰å…ƒæ•°æ®

```yaml
# meta/main.yml ç¤ºä¾‹
---
dependencies:
  - role: common            # ä¾èµ–commonè§’è‰²
    vars:
      common_packages:
        - wget
        - curl
        
galaxy_info:
  author: "è¿ç»´å›¢é˜Ÿ"
  description: "Nginx WebæœåŠ¡å™¨é…ç½®"
  company: "å…¬å¸åç§°"
  license: MIT
  min_ansible_version: 2.9
  
  platforms:
    - name: CentOS
      versions:
        - 7
        - 8
```

**ä¾èµ–å…³ç³»è¯´æ˜**ï¼š
```
æ‰§è¡Œé¡ºåºï¼š
1. å…ˆæ‰§è¡Œdependenciesä¸­çš„è§’è‰²
2. å†æ‰§è¡Œå½“å‰è§’è‰²çš„tasks

å®é™…åº”ç”¨ï¼š
webserverè§’è‰²ä¾èµ–commonè§’è‰²
â†’ å…ˆå®‰è£…åŸºç¡€è½¯ä»¶åŒ…(common)
â†’ å†å®‰è£…é…ç½®WebæœåŠ¡(webserver)
```

---

## 4. ğŸ“ ç›®å½•åˆ›å»ºè§„èŒƒä¸æœ€ä½³å®è·µ


### 4.1 åˆ›å»ºRoleçš„æ ‡å‡†æµç¨‹


**æ–¹æ³•ä¸€ï¼šæ‰‹åŠ¨åˆ›å»º**
```bash
mkdir -p my-role/{tasks,handlers,templates,files,vars,defaults,meta}
touch my-role/{tasks,handlers,vars,defaults,meta}/main.yml
```

**æ–¹æ³•äºŒï¼šä½¿ç”¨ansible-galaxyå‘½ä»¤**
```bash
ansible-galaxy init my-role
```

**ç”Ÿæˆçš„ç›®å½•ç»“æ„**ï¼š
```
my-role/
â”œâ”€â”€ README.md
â”œâ”€â”€ defaults/
â”‚   â””â”€â”€ main.yml
â”œâ”€â”€ files/
â”œâ”€â”€ handlers/
â”‚   â””â”€â”€ main.yml
â”œâ”€â”€ meta/
â”‚   â””â”€â”€ main.yml
â”œâ”€â”€ tasks/
â”‚   â””â”€â”€ main.yml
â”œâ”€â”€ templates/
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ inventory
â”‚   â””â”€â”€ test.yml
â””â”€â”€ vars/
    â””â”€â”€ main.yml
```

### 4.2 æ–‡ä»¶å‘½åçº¦å®š


**å¿…é¡»éµå¾ªçš„è§„åˆ™**ï¼š
```
âœ… æ­£ç¡®å‘½åï¼š
tasks/main.yml          â† ä¸»å…¥å£æ–‡ä»¶å¿…é¡»å«main.yml
handlers/main.yml       â† å¤„ç†å™¨å…¥å£æ–‡ä»¶
vars/main.yml          â† å˜é‡å…¥å£æ–‡ä»¶

âŒ é”™è¯¯å‘½åï¼š
tasks/task.yml         â† ä¸ä¼šè¢«è‡ªåŠ¨åŠ è½½
handlers/handler.yml   â† ä¸ä¼šè¢«è‡ªåŠ¨åŠ è½½
```

**å»ºè®®çš„å‘½åè§„èŒƒ**ï¼š
```
æ¨¡æ¿æ–‡ä»¶ï¼š
nginx.conf.j2          â† ä»¥.j2ç»“å°¾
apache.conf.j2

é™æ€æ–‡ä»¶ï¼š
startup.sh             â† ä¿æŒåŸå§‹æ‰©å±•å
config.json
```

### 4.3 Roleè®¾è®¡æœ€ä½³å®è·µ


**å•ä¸€èŒè´£åŸåˆ™**ï¼š
```
âœ… æ¨èï¼š
webserver-role/        â† åªè´Ÿè´£WebæœåŠ¡å™¨
database-role/         â† åªè´Ÿè´£æ•°æ®åº“
monitoring-role/       â† åªè´Ÿè´£ç›‘æ§

âŒ ä¸æ¨èï¼š
everything-role/       â† ä»€ä¹ˆéƒ½åšçš„å¤§æ‚çƒ©
```

**å˜é‡è®¾è®¡åŸåˆ™**ï¼š
```yaml
# defaults/main.yml - æä¾›åˆç†é»˜è®¤å€¼
app_port: 8080
app_user: appuser

# è®©ç”¨æˆ·å¯ä»¥ç®€å•è¦†ç›–
# group_vars/production.yml
app_port: 80
app_user: nginx
```

**æ¨¡å—åŒ–ä»»åŠ¡è®¾è®¡**ï¼š
```yaml
# tasks/main.yml - ä¸»æµç¨‹
- import_tasks: preflight.yml    # é¢„æ£€æŸ¥
- import_tasks: install.yml      # å®‰è£…
- import_tasks: configure.yml    # é…ç½®
- import_tasks: service.yml      # æœåŠ¡ç®¡ç†
```

---

## 5. ğŸš€ å®é™…åº”ç”¨ç¤ºä¾‹


### 5.1 å®Œæ•´çš„nginx-roleç¤ºä¾‹


```
nginx-role/
â”œâ”€â”€ tasks/
â”‚   â””â”€â”€ main.yml
â”œâ”€â”€ handlers/
â”‚   â””â”€â”€ main.yml  
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ nginx.conf.j2
â”œâ”€â”€ defaults/
â”‚   â””â”€â”€ main.yml
â””â”€â”€ meta/
    â””â”€â”€ main.yml
```

**tasks/main.yml**ï¼š
```yaml
---
- name: å®‰è£…Nginx
  package:
    name: nginx
    state: present

- name: ç”ŸæˆNginxé…ç½®æ–‡ä»¶
  template:
    src: nginx.conf.j2
    dest: /etc/nginx/nginx.conf
    backup: yes
  notify: é‡å¯nginx

- name: å¯åŠ¨å¹¶å¯ç”¨Nginx
  service:
    name: nginx
    state: started
    enabled: yes
```

**handlers/main.yml**ï¼š
```yaml
---
- name: é‡å¯nginx
  service:
    name: nginx
    state: restarted
```

**defaults/main.yml**ï¼š
```yaml
---
nginx_port: 80
nginx_user: nginx
nginx_worker_processes: auto
```

### 5.2 åœ¨Playbookä¸­ä½¿ç”¨Role


```yaml
# site.yml
---
- hosts: webservers
  become: yes
  roles:
    - role: nginx-role
      vars:
        nginx_port: 8080        # è¦†ç›–é»˜è®¤ç«¯å£
        nginx_user: www-data    # è¦†ç›–é»˜è®¤ç”¨æˆ·
```

### 5.3 Roleä¹‹é—´çš„ä¾èµ–å…³ç³»


```yaml
# webserver-role/meta/main.yml
---
dependencies:
  - role: common-role           # å…ˆå®‰è£…åŸºç¡€ç»„ä»¶
  - role: firewall-role         # å†é…ç½®é˜²ç«å¢™
    vars:
      firewall_ports:
        - 80
        - 443
```

**æ‰§è¡Œé¡ºåº**ï¼š
```
1. common-role      â† å®‰è£…åŸºç¡€è½¯ä»¶
2. firewall-role    â† é…ç½®é˜²ç«å¢™å¼€æ”¾ç«¯å£
3. webserver-role   â† å®‰è£…é…ç½®WebæœåŠ¡å™¨
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ Roleæœ¬è´¨ï¼šæŠŠç›¸å…³åŠŸèƒ½æ‰“åŒ…æˆå¯é‡ç”¨çš„æ¨¡å—
ğŸ”¸ æ ‡å‡†ç»“æ„ï¼š8ä¸ªæ ¸å¿ƒç›®å½•ï¼Œå„æœ‰ä¸“é—¨ç”¨é€”
ğŸ”¸ å…¥å£æ–‡ä»¶ï¼šæ¯ä¸ªç›®å½•çš„main.ymlæ˜¯é»˜è®¤å…¥å£
ğŸ”¸ å˜é‡å±‚çº§ï¼šdefaults < varsï¼Œç†è§£ä¼˜å…ˆçº§å…³ç³»
ğŸ”¸ ä¾èµ–ç®¡ç†ï¼šé€šè¿‡meta/main.ymlå®šä¹‰è§’è‰²é—´ä¾èµ–
```

### 6.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ç›®å½•åŠŸèƒ½è®°å¿†æ³•**
```
tasks/     â†’ "åšä»€ä¹ˆ"    (æ‰§è¡Œçš„ä»»åŠ¡)
handlers/  â†’ "å‡ºäº‹äº†"    (å¼‚å¸¸æˆ–å˜åŒ–æ—¶çš„å¤„ç†)
templates/ â†’ "ä¼šå˜åŒ–"    (æ ¹æ®ç¯å¢ƒç”Ÿæˆçš„æ–‡ä»¶)
files/     â†’ "ä¸å˜åŒ–"    (åŸæ ·å¤åˆ¶çš„æ–‡ä»¶)
vars/      â†’ "è§’è‰²ä¸“ç”¨"   (Roleå†…éƒ¨å˜é‡)
defaults/  â†’ "å¯è¦†ç›–"    (é»˜è®¤å€¼ï¼Œå¯è¢«å¤–éƒ¨æ”¹å˜)
meta/      â†’ "å…³ç³»ç½‘"    (ä¾èµ–å’Œå…ƒä¿¡æ¯)
```

**ğŸ”¹ ä½•æ—¶ä½¿ç”¨Role**
```
é€‚åˆç”¨Roleï¼š
âœ… åŠŸèƒ½ç›¸å¯¹ç‹¬ç«‹ï¼ˆå¦‚ï¼šå®‰è£…nginxï¼‰
âœ… éœ€è¦åœ¨å¤šä¸ªé¡¹ç›®ä¸­é‡ç”¨
âœ… æœ‰ä¸€å®šçš„å¤æ‚åº¦ï¼ˆè¶…è¿‡5ä¸ªtaskï¼‰
âœ… æœ‰é…ç½®æ–‡ä»¶æ¨¡æ¿éœ€æ±‚

ä¸å¿…ç”¨Roleï¼š
âŒ åªæœ‰1-2ä¸ªç®€å•ä»»åŠ¡
âŒ åªåœ¨ä¸€ä¸ªåœ°æ–¹ä½¿ç”¨
âŒ ä¸´æ—¶æ€§çš„æ“ä½œè„šæœ¬
```

**ğŸ”¹ Roleè®¾è®¡åŸåˆ™**
```
å•ä¸€èŒè´£ï¼šä¸€ä¸ªRoleåªåšä¸€ä»¶äº‹æƒ…
æ ‡å‡†ç»“æ„ï¼šéµå¾ªçº¦å®šçš„ç›®å½•ç»“æ„
åˆç†é»˜è®¤ï¼šdefaults/ä¸­æä¾›å¯ç”¨çš„é»˜è®¤å€¼
æ¸…æ™°æ–‡æ¡£ï¼šREADME.mdè¯´æ˜ç”¨æ³•å’Œå‚æ•°
```

### 6.3 å®é™…åº”ç”¨ä»·å€¼


- **é¡¹ç›®ç®¡ç†**ï¼šå¤§å‹Ansibleé¡¹ç›®çš„ä»£ç ç»„ç»‡åˆ©å™¨
- **å›¢é˜Ÿåä½œ**ï¼šä¸åŒæˆå‘˜å¯ä»¥å¼€å‘ç»´æŠ¤ä¸åŒRole
- **æŒç»­é›†æˆ**ï¼šRoleå¯ä»¥ç‰ˆæœ¬åŒ–ç®¡ç†ï¼Œä¾¿äºCI/CD
- **çŸ¥è¯†å¤ç”¨**ï¼šä¸€æ¬¡ç¼–å†™ï¼Œå¤šä¸ªç¯å¢ƒå’Œé¡¹ç›®å¤ç”¨

**ğŸ”§ å®è·µå»ºè®®**ï¼š
- ä»ç®€å•çš„Roleå¼€å§‹ç»ƒä¹ ï¼ˆå¦‚ï¼šå®‰è£…è½¯ä»¶åŒ…ï¼‰
- é€æ­¥å¢åŠ å¤æ‚åº¦ï¼ˆé…ç½®æ–‡ä»¶ã€æœåŠ¡ç®¡ç†ã€ä¾èµ–å…³ç³»ï¼‰
- å»ºç«‹å›¢é˜Ÿçš„Roleæ ‡å‡†æ¨¡æ¿å’Œæœ€ä½³å®è·µ
- ä½¿ç”¨ansible-galaxyç®¡ç†å’Œåˆ†äº«Role

**æ ¸å¿ƒè®°å¿†**ï¼š
- Roleæ˜¯Ansibleä»£ç å¤ç”¨çš„æ ¸å¿ƒæœºåˆ¶
- æ ‡å‡†ç›®å½•ç»“æ„è®©ä»£ç ç»„ç»‡æ¸…æ™°æ˜“ç»´æŠ¤
- é€šè¿‡å˜é‡å’Œä¾èµ–å®ç°çµæ´»çš„é…ç½®ç®¡ç†
- æŒæ¡Roleæ˜¯ä»Ansibleåˆå­¦è€…è¿›é˜¶çš„å…³é”®ä¸€æ­¥