---
title: 11ã€ä¾èµ–æ³¨å…¥é…ç½®
---
## ğŸ“š ç›®å½•

1. [ä¾èµ–æ³¨å…¥åŸºç¡€æ¦‚å¿µ](#1-ä¾èµ–æ³¨å…¥åŸºç¡€æ¦‚å¿µ)
2. [æ„é€ å™¨å‚æ•°æ³¨å…¥](#2-æ„é€ å™¨å‚æ•°æ³¨å…¥)
3. [å±æ€§è®¾å€¼æ³¨å…¥](#3-å±æ€§è®¾å€¼æ³¨å…¥)
4. [é›†åˆç±»å‹æ³¨å…¥](#4-é›†åˆç±»å‹æ³¨å…¥)
5. [Mapå­—å…¸æ³¨å…¥](#5-mapå­—å…¸æ³¨å…¥)
6. [å¾ªç¯ä¾èµ–å¤„ç†](#6-å¾ªç¯ä¾èµ–å¤„ç†)
7. [æ³¨å…¥ç‚¹é€‰æ‹©ç­–ç•¥](#7-æ³¨å…¥ç‚¹é€‰æ‹©ç­–ç•¥)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ä¾èµ–æ³¨å…¥åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥


**é€šä¿—ç†è§£**ï¼šæƒ³è±¡ä½ è¦åšä¸€é“èœï¼Œä¼ ç»Ÿæ–¹å¼æ˜¯ä½ è‡ªå·±å»ä¹°èœã€æ´—èœã€åˆ‡èœï¼Œè€Œä¾èµ–æ³¨å…¥å°±åƒæœ‰äººæŠŠå‡†å¤‡å¥½çš„é£Ÿæç›´æ¥é€åˆ°ä½ æ‰‹ä¸Šï¼Œä½ åªéœ€è¦çƒ¹é¥ªã€‚

```
ä¼ ç»Ÿæ–¹å¼ï¼ˆè‡ªå·±åˆ›å»ºä¾èµ–ï¼‰ï¼š
public class UserService {
    private UserDao userDao = new UserDao();  // è‡ªå·±newå¯¹è±¡
}

ä¾èµ–æ³¨å…¥æ–¹å¼ï¼ˆåˆ«äººç»™ä½ ä¾èµ–ï¼‰ï¼š
public class UserService {
    private UserDao userDao;  // ç­‰å¾…åˆ«äººæ³¨å…¥
    
    public UserService(UserDao userDao) {
        this.userDao = userDao;  // Springè‡ªåŠ¨ä¼ è¿›æ¥
    }
}
```

**æ ¸å¿ƒä»·å€¼**ï¼š
- **è§£è€¦åˆ**ï¼šä¸ç”¨è‡ªå·±åˆ›å»ºä¾èµ–å¯¹è±¡ï¼Œé™ä½ç±»ä¹‹é—´çš„è€¦åˆ
- **æ˜“æµ‹è¯•**ï¼šå¯ä»¥è½»æ¾æ›¿æ¢ä¾èµ–å¯¹è±¡ï¼Œæ–¹ä¾¿å•å…ƒæµ‹è¯•
- **æ˜“ç»´æŠ¤**ï¼šä¿®æ”¹ä¾èµ–å®ç°ä¸å½±å“ä½¿ç”¨æ–¹ä»£ç 

### 1.2 ä¾èµ–æ³¨å…¥çš„ä¸‰ç§æ–¹å¼


```
ä¾èµ–æ³¨å…¥æ–¹å¼å¯¹æ¯”ï¼š

1. æ„é€ å™¨æ³¨å…¥ï¼ˆæ¨èï¼‰
   â””â”€ é€šè¿‡æ„é€ æ–¹æ³•ä¼ å…¥ä¾èµ–
   â””â”€ ä¿è¯å¯¹è±¡åˆ›å»ºæ—¶ä¾èµ–å°±ç»ª

2. Setteræ³¨å…¥ï¼ˆå¸¸ç”¨ï¼‰
   â””â”€ é€šè¿‡setæ–¹æ³•ä¼ å…¥ä¾èµ–
   â””â”€ ä¾èµ–æ˜¯å¯é€‰çš„åœºæ™¯

3. å­—æ®µæ³¨å…¥ï¼ˆä¸æ¨èï¼‰
   â””â”€ ç›´æ¥åœ¨å­—æ®µä¸Š@Autowired
   â””â”€ ç®€å•ä½†ä¸åˆ©äºæµ‹è¯•
```

---

## 2. ğŸ”§ æ„é€ å™¨å‚æ•°æ³¨å…¥


### 2.1 ä¸ºä»€ä¹ˆæ¨èæ„é€ å™¨æ³¨å…¥


**æ ¸å¿ƒåŸå› **ï¼š
- âœ… **å¼ºåˆ¶ä¾èµ–**ï¼šå¯¹è±¡åˆ›å»ºæ—¶å¿…é¡»æä¾›ä¾èµ–ï¼Œé¿å…ç©ºæŒ‡é’ˆ
- âœ… **ä¸å¯å˜æ€§**ï¼šä¾èµ–æ³¨å…¥åä¸èƒ½ä¿®æ”¹ï¼Œçº¿ç¨‹å®‰å…¨
- âœ… **æ˜“æµ‹è¯•**ï¼šå¯ä»¥ç›´æ¥newå¯¹è±¡ä¼ å‚ï¼Œæ— éœ€Springå®¹å™¨

### 2.2 åŸºæœ¬ä½¿ç”¨æ–¹å¼


**å•ä¸ªå‚æ•°æ³¨å…¥**ï¼š

```java
// æœåŠ¡ç±»ï¼šéœ€è¦ä¸€ä¸ªDaoå¯¹è±¡
@Service
public class UserService {
    private final UserDao userDao;  // finalä¿è¯ä¸å¯å˜
    
    // æ„é€ æ–¹æ³•ï¼šSpringä¼šè‡ªåŠ¨è°ƒç”¨å¹¶ä¼ å…¥UserDao
    public UserService(UserDao userDao) {
        this.userDao = userDao;
    }
}
```

**å¤šä¸ªå‚æ•°æ³¨å…¥**ï¼š

```java
@Service
public class OrderService {
    private final OrderDao orderDao;
    private final UserService userService;
    
    // å¤šä¸ªå‚æ•°ï¼ŒSpringä¼šæŒ‰ç±»å‹åŒ¹é…å¹¶æ³¨å…¥
    public OrderService(OrderDao orderDao, UserService userService) {
        this.orderDao = orderDao;
        this.userService = userService;
    }
}
```

### 2.3 å‚æ•°ç±»å‹åŒ¹é…è§„åˆ™


**åŒ¹é…é¡ºåº**ï¼š

```
Springæ³¨å…¥å‚æ•°çš„æŸ¥æ‰¾é€»è¾‘ï¼š

ç¬¬1æ­¥ï¼šæŒ‰å‚æ•°ç±»å‹æŸ¥æ‰¾
   â””â”€ æ‰¾åˆ°å”¯ä¸€Bean â†’ ç›´æ¥æ³¨å…¥
   â””â”€ æ‰¾åˆ°å¤šä¸ªBean â†’ è¿›å…¥ç¬¬2æ­¥

ç¬¬2æ­¥ï¼šæŒ‰å‚æ•°åç§°åŒ¹é…
   â””â”€ å‚æ•°åä¸Beanåç§°ä¸€è‡´ â†’ æ³¨å…¥è¯¥Bean
   â””â”€ éƒ½ä¸åŒ¹é… â†’ æŠ¥é”™

ç¤ºä¾‹ï¼š
public OrderService(UserDao userDao, UserDao adminDao) {
    // userDaoå‚æ•° â†’ æ‰¾åä¸º"userDao"çš„Bean
    // adminDaoå‚æ•° â†’ æ‰¾åä¸º"adminDao"çš„Bean
}
```

### 2.4 æŒ‡å®šæ³¨å…¥çš„Bean


```java
@Service
public class OrderService {
    private final UserDao userDao;
    
    // ä½¿ç”¨@QualifieræŒ‡å®šBeanåç§°
    public OrderService(@Qualifier("mysqlUserDao") UserDao userDao) {
        this.userDao = userDao;
    }
}
```

**ä½¿ç”¨åœºæ™¯**ï¼š
- æ¥å£æœ‰å¤šä¸ªå®ç°ç±»
- éœ€è¦æ˜ç¡®æŒ‡å®šä½¿ç”¨å“ªä¸ªå®ç°

---

## 3. ğŸ¨ å±æ€§è®¾å€¼æ³¨å…¥


### 3.1 ä»€ä¹ˆæ˜¯Setteræ³¨å…¥


**é€šä¿—ç†è§£**ï¼šå°±æ˜¯é€šè¿‡setæ–¹æ³•ç»™å¯¹è±¡çš„å±æ€§èµ‹å€¼ï¼Œåƒç»™æˆ¿å­å®‰è£…å®¶å…·ï¼Œå¯ä»¥åç»­æ·»åŠ æˆ–æ›´æ¢ã€‚

```java
@Service
public class UserService {
    private UserDao userDao;
    
    // Springä¼šè°ƒç”¨è¿™ä¸ªsetæ–¹æ³•æ³¨å…¥ä¾èµ–
    @Autowired
    public void setUserDao(UserDao userDao) {
        this.userDao = userDao;
    }
}
```

### 3.2 ä¸æ„é€ å™¨æ³¨å…¥çš„åŒºåˆ«


| å¯¹æ¯”ç»´åº¦ | **æ„é€ å™¨æ³¨å…¥** | **Setteræ³¨å…¥** |
|---------|--------------|---------------|
| **ä¾èµ–å¿…éœ€æ€§** | å¼ºåˆ¶ä¾èµ–ï¼Œå¿…é¡»æ³¨å…¥ | å¯é€‰ä¾èµ–ï¼Œå¯ä»¥ä¸ºnull |
| **ä¸å¯å˜æ€§** | æ”¯æŒfinalï¼Œä¸å¯å˜ | æ— æ³•ç”¨finalï¼Œå¯å˜ |
| **å¾ªç¯ä¾èµ–** | æ— æ³•è§£å†³å¾ªç¯ä¾èµ– | å¯ä»¥è§£å†³å¾ªç¯ä¾èµ– |
| **é€‚ç”¨åœºæ™¯** | æ ¸å¿ƒä¾èµ– | å¯é€‰é…ç½® |

### 3.3 Setteræ³¨å…¥çš„å®é™…åº”ç”¨


**å¯é€‰ä¾èµ–åœºæ™¯**ï¼š

```java
@Service
public class EmailService {
    private EmailTemplate template;
    private int retryTimes = 3;  // é»˜è®¤å€¼
    
    // å¯é€‰ï¼šå¦‚æœæœ‰è‡ªå®šä¹‰æ¨¡æ¿å°±æ³¨å…¥ï¼Œæ²¡æœ‰å°±ç”¨é»˜è®¤çš„
    @Autowired(required = false)
    public void setTemplate(EmailTemplate template) {
        this.template = template;
    }
    
    // å¯é€‰ï¼šå¯ä»¥é€šè¿‡é…ç½®ä¿®æ”¹é‡è¯•æ¬¡æ•°
    @Autowired(required = false)
    public void setRetryTimes(@Value("${email.retry:3}") int retryTimes) {
        this.retryTimes = retryTimes;
    }
}
```

**å…³é”®ç‚¹**ï¼š
- `required = false` è¡¨ç¤ºè¿™ä¸ªä¾èµ–æ˜¯å¯é€‰çš„
- é€‚åˆé…ç½®ç±»çš„å±æ€§æ³¨å…¥
- ä¸å½±å“å¯¹è±¡çš„æ ¸å¿ƒåŠŸèƒ½

---

## 4. ğŸ“¦ é›†åˆç±»å‹æ³¨å…¥


### 4.1 ä¸ºä»€ä¹ˆéœ€è¦é›†åˆæ³¨å…¥


**ä¸šåŠ¡åœºæ™¯**ï¼šæœ‰æ—¶å€™ä¸€ä¸ªæ¥å£æœ‰å¤šä¸ªå®ç°ï¼Œæˆ‘ä»¬æƒ³æŠŠæ‰€æœ‰å®ç°éƒ½æ³¨å…¥è¿›æ¥ç»Ÿä¸€å¤„ç†ã€‚

```
ä¸¾ä¾‹ï¼šæ”¯ä»˜ç³»ç»Ÿ
â”œâ”€ PaymentStrategy (æ”¯ä»˜ç­–ç•¥æ¥å£)
    â”œâ”€ AlipayStrategy (æ”¯ä»˜å®æ”¯ä»˜)
    â”œâ”€ WechatPayStrategy (å¾®ä¿¡æ”¯ä»˜)
    â””â”€ BankCardStrategy (é“¶è¡Œå¡æ”¯ä»˜)

éœ€æ±‚ï¼šæŠŠæ‰€æœ‰æ”¯ä»˜ç­–ç•¥éƒ½æ³¨å…¥åˆ°æ”¯ä»˜æœåŠ¡ä¸­
```

### 4.2 Listé›†åˆæ³¨å…¥


```java
// å®šä¹‰ç­–ç•¥æ¥å£
public interface PaymentStrategy {
    void pay(BigDecimal amount);
    String getType();  // è¿”å›æ”¯ä»˜ç±»å‹ï¼šalipayã€wechatç­‰
}

// æ”¯ä»˜æœåŠ¡ï¼šæ³¨å…¥æ‰€æœ‰ç­–ç•¥
@Service
public class PaymentService {
    private final List<PaymentStrategy> strategies;
    
    // Springä¼šæŠŠæ‰€æœ‰PaymentStrategyå®ç°ç±»éƒ½æ³¨å…¥è¿›æ¥
    public PaymentService(List<PaymentStrategy> strategies) {
        this.strategies = strategies;
    }
    
    // æ ¹æ®ç±»å‹é€‰æ‹©ç­–ç•¥
    public void pay(String type, BigDecimal amount) {
        for (PaymentStrategy strategy : strategies) {
            if (strategy.getType().equals(type)) {
                strategy.pay(amount);
                return;
            }
        }
        throw new IllegalArgumentException("ä¸æ”¯æŒçš„æ”¯ä»˜æ–¹å¼ï¼š" + type);
    }
}
```

**æ³¨å…¥æœºåˆ¶**ï¼š
- Springä¼šè‡ªåŠ¨æ‰¾åˆ°æ‰€æœ‰`PaymentStrategy`çš„å®ç°ç±»
- æŠŠå®ƒä»¬ç»„è£…æˆListæ³¨å…¥è¿›æ¥
- **æ³¨å…¥é¡ºåº**ï¼šé»˜è®¤æŒ‰Beanå®šä¹‰é¡ºåºï¼Œå¯ç”¨`@Order`è°ƒæ•´

### 4.3 Seté›†åˆæ³¨å…¥


```java
@Service
public class NotificationService {
    private final Set<MessageSender> senders;
    
    // ä½¿ç”¨Setè‡ªåŠ¨å»é‡
    public NotificationService(Set<MessageSender> senders) {
        this.senders = senders;
    }
    
    // å‘é€ç»™æ‰€æœ‰æ¸ é“
    public void sendToAll(String message) {
        senders.forEach(sender -> sender.send(message));
    }
}
```

**Set vs List**ï¼š
- `Set`ï¼šè‡ªåŠ¨å»é‡ï¼Œæ— åº
- `List`ï¼šå¯é‡å¤ï¼Œæœ‰åº
- æ ¹æ®ä¸šåŠ¡éœ€è¦é€‰æ‹©

### 4.4 æŒ‡å®šæ³¨å…¥é¡ºåº


```java
@Component
@Order(1)  // æ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜
public class AlipayStrategy implements PaymentStrategy {
    // ...
}

@Component
@Order(2)
public class WechatPayStrategy implements PaymentStrategy {
    // ...
}
```

---

## 5. ğŸ—‚ï¸ Mapå­—å…¸æ³¨å…¥


### 5.1 Mapæ³¨å…¥çš„ä¼˜åŠ¿


**ä¸Listå¯¹æ¯”**ï¼š

```
Listæ³¨å…¥çš„é—®é¢˜ï¼š
- éœ€è¦éå†æŸ¥æ‰¾ç›®æ ‡å¯¹è±¡
- æ—¶é—´å¤æ‚åº¦O(n)

Mapæ³¨å…¥çš„ä¼˜åŠ¿ï¼š
- ç›´æ¥é€šè¿‡keyè·å–å¯¹è±¡
- æ—¶é—´å¤æ‚åº¦O(1)
- ä»£ç æ›´ç®€æ´
```

### 5.2 åŸºæœ¬ä½¿ç”¨æ–¹å¼


```java
@Service
public class PaymentService {
    private final Map<String, PaymentStrategy> strategyMap;
    
    // Keyæ˜¯Beançš„åç§°ï¼ŒValueæ˜¯Beanå¯¹è±¡
    public PaymentService(Map<String, PaymentStrategy> strategyMap) {
        this.strategyMap = strategyMap;
    }
    
    // ç›´æ¥é€šè¿‡keyè·å–
    public void pay(String type, BigDecimal amount) {
        PaymentStrategy strategy = strategyMap.get(type + "Strategy");
        if (strategy == null) {
            throw new IllegalArgumentException("ä¸æ”¯æŒçš„æ”¯ä»˜æ–¹å¼");
        }
        strategy.pay(amount);
    }
}
```

**Mapçš„Keyæ¥æº**ï¼š
- é»˜è®¤æ˜¯Beançš„åç§°ï¼ˆç±»åé¦–å­—æ¯å°å†™ï¼‰
- å¯ä»¥é€šè¿‡`@Component("customName")`è‡ªå®šä¹‰

### 5.3 è‡ªå®šä¹‰Mapçš„Key


```java
// æ–¹å¼1ï¼šåœ¨å®ç°ç±»ä¸ŠæŒ‡å®šåç§°
@Component("alipay")
public class AlipayStrategy implements PaymentStrategy {
    // ...
}

@Component("wechat")
public class WechatPayStrategy implements PaymentStrategy {
    // ...
}

// ä½¿ç”¨
strategyMap.get("alipay").pay(amount);
```

### 5.4 å®æˆ˜ï¼šç­–ç•¥æ¨¡å¼ä¼˜åŒ–


**ä¼˜åŒ–å‰ï¼ˆif-elseï¼‰**ï¼š

```java
public void pay(String type, BigDecimal amount) {
    if ("alipay".equals(type)) {
        // æ”¯ä»˜å®æ”¯ä»˜é€»è¾‘
    } else if ("wechat".equals(type)) {
        // å¾®ä¿¡æ”¯ä»˜é€»è¾‘
    } else if ("bankcard".equals(type)) {
        // é“¶è¡Œå¡æ”¯ä»˜é€»è¾‘
    }
    // æ–°å¢æ”¯ä»˜æ–¹å¼éœ€è¦ä¿®æ”¹è¿™é‡Œ âŒ
}
```

**ä¼˜åŒ–åï¼ˆMapæ³¨å…¥ï¼‰**ï¼š

```java
public void pay(String type, BigDecimal amount) {
    strategyMap.get(type).pay(amount);
    // æ–°å¢æ”¯ä»˜æ–¹å¼åªéœ€æ·»åŠ å®ç°ç±» âœ…
}
```

**ä¼˜åŠ¿æ€»ç»“**ï¼š
- âœ… æ¶ˆé™¤if-elseï¼Œç¬¦åˆå¼€é—­åŸåˆ™
- âœ… æ–°å¢ç­–ç•¥æ— éœ€ä¿®æ”¹åŸä»£ç 
- âœ… ä»£ç ç®€æ´æ˜“ç»´æŠ¤

---

## 6. ğŸ”„ å¾ªç¯ä¾èµ–å¤„ç†


### 6.1 ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–


**é€šä¿—ç†è§£**ï¼šä¸¤ä¸ªå¯¹è±¡äº’ç›¸ä¾èµ–å¯¹æ–¹ï¼Œåƒé¸¡ç”Ÿè›‹ã€è›‹ç”Ÿé¸¡çš„é—®é¢˜ã€‚

```
å¾ªç¯ä¾èµ–ç¤ºæ„å›¾ï¼š

åœºæ™¯1ï¼šæ„é€ å™¨å¾ªç¯ä¾èµ–ï¼ˆæ— æ³•è§£å†³ï¼‰
UserService â”€â”€æ„é€ å™¨éœ€è¦â”€â”€> OrderService
     â†‘                           â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€æ„é€ å™¨éœ€è¦â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åœºæ™¯2ï¼šSetterå¾ªç¯ä¾èµ–ï¼ˆå¯ä»¥è§£å†³ï¼‰
UserService â”€â”€setteréœ€è¦â”€â”€> OrderService
     â†‘                          â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€setteréœ€è¦â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 Springå¦‚ä½•è§£å†³å¾ªç¯ä¾èµ–


**ä¸‰çº§ç¼“å­˜æœºåˆ¶**ï¼ˆç®€åŒ–ç†è§£ï¼‰ï¼š

```
Springåˆ›å»ºBeançš„è¿‡ç¨‹ï¼š

ç¬¬1æ­¥ï¼šåˆ›å»ºå¯¹è±¡å®ä¾‹ï¼ˆä»…newï¼Œå±æ€§éƒ½æ˜¯nullï¼‰
   â””â”€ æ”¾å…¥"åŠæˆå“"ç¼“å­˜

ç¬¬2æ­¥ï¼šæ³¨å…¥å±æ€§ä¾èµ–
   â””â”€ å¦‚æœä¾èµ–å¯¹è±¡åœ¨åˆ›å»ºä¸­ï¼Œå…ˆç”¨"åŠæˆå“"

ç¬¬3æ­¥ï¼šåˆå§‹åŒ–å®Œæˆ
   â””â”€ æ”¾å…¥"æˆå“"ç¼“å­˜

ç¤ºä¾‹ï¼š
1. åˆ›å»ºUserServiceå®ä¾‹ â†’ æ”¾å…¥åŠæˆå“ç¼“å­˜
2. æ³¨å…¥OrderService â†’ å‘ç°OrderServiceéœ€è¦UserService
3. ä»åŠæˆå“ç¼“å­˜å–UserService â†’ å…ˆæ³¨å…¥åŠæˆå“
4. OrderServiceåˆ›å»ºå®Œæˆ â†’ å›è¿‡å¤´å®ŒæˆUserService
```

### 6.3 ä¸åŒæ³¨å…¥æ–¹å¼çš„å¾ªç¯ä¾èµ–


| æ³¨å…¥æ–¹å¼ | **èƒ½å¦è§£å†³å¾ªç¯ä¾èµ–** | **åŸå› ** |
|---------|-------------------|---------|
| **æ„é€ å™¨æ³¨å…¥** | âŒ ä¸èƒ½ | å¯¹è±¡åˆ›å»ºæ—¶å°±éœ€è¦ä¾èµ–ï¼Œæ— æ³•æä¾›åŠæˆå“ |
| **Setteræ³¨å…¥** | âœ… èƒ½ | å…ˆåˆ›å»ºå¯¹è±¡ï¼Œåæ³¨å…¥ä¾èµ–ï¼Œå¯ä»¥ç”¨åŠæˆå“ |
| **å­—æ®µæ³¨å…¥** | âœ… èƒ½ | åŸç†åŒSetteræ³¨å…¥ |

### 6.4 å®é™…æ¡ˆä¾‹


**é—®é¢˜ä»£ç **ï¼š

```java
@Service
public class UserService {
    private final OrderService orderService;
    
    // æ„é€ å™¨æ³¨å…¥ â†’ å¾ªç¯ä¾èµ–æŠ¥é”™
    public UserService(OrderService orderService) {
        this.orderService = orderService;
    }
}

@Service
public class OrderService {
    private final UserService userService;
    
    // æ„é€ å™¨æ³¨å…¥ â†’ å¾ªç¯ä¾èµ–æŠ¥é”™
    public OrderService(UserService userService) {
        this.userService = userService;
    }
}
```

**è§£å†³æ–¹æ¡ˆ1ï¼šæ”¹ç”¨Setteræ³¨å…¥**

```java
@Service
public class UserService {
    private OrderService orderService;
    
    @Autowired
    public void setOrderService(OrderService orderService) {
        this.orderService = orderService;
    }
}
```

**è§£å†³æ–¹æ¡ˆ2ï¼šä½¿ç”¨@Lazyå»¶è¿Ÿæ³¨å…¥**

```java
@Service
public class UserService {
    private final OrderService orderService;
    
    // @Lazyï¼šæ³¨å…¥ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼ŒçœŸæ­£ä½¿ç”¨æ—¶æ‰åˆ›å»º
    public UserService(@Lazy OrderService orderService) {
        this.orderService = orderService;
    }
}
```

### 6.5 æœ€ä½³å®è·µå»ºè®®


**é¿å…å¾ªç¯ä¾èµ–çš„è®¾è®¡**ï¼š

```
å¥½çš„è®¾è®¡ï¼šå•å‘ä¾èµ–

UserService â†’ OrderService â†’ OrderDao
ï¼ˆæœåŠ¡å±‚ä¾èµ–Daoå±‚ï¼Œä¸ä¼šåå‘ä¾èµ–ï¼‰

åçš„è®¾è®¡ï¼šå¾ªç¯ä¾èµ–

UserService â†â†’ OrderService
ï¼ˆä¸¤ä¸ªæœåŠ¡äº’ç›¸ä¾èµ–ï¼Œè®¾è®¡æœ‰é—®é¢˜ï¼‰
```

**é‡æ„å»ºè®®**ï¼š
- âœ… æŠ½å–å…¬å…±æœåŠ¡ï¼Œæ‰“ç ´å¾ªç¯
- âœ… ä½¿ç”¨äº‹ä»¶æœºåˆ¶è§£è€¦
- âœ… é‡æ–°å®¡è§†èŒè´£åˆ’åˆ†

---

## 7. ğŸ¯ æ³¨å…¥ç‚¹é€‰æ‹©ç­–ç•¥


### 7.1 ä¸‰ç§æ³¨å…¥æ–¹å¼å¯¹æ¯”


```
æ³¨å…¥æ–¹å¼ç‰¹ç‚¹å¯¹æ¯”ï¼š

æ„é€ å™¨æ³¨å…¥ï¼š
   ä¼˜ç‚¹ï¼šå¼ºåˆ¶ä¾èµ–ã€ä¸å¯å˜ã€æ˜“æµ‹è¯•
   ç¼ºç‚¹ï¼šå‚æ•°å¤šæ—¶ä»£ç è‡ƒè‚¿ã€å¾ªç¯ä¾èµ–æŠ¥é”™
   
Setteræ³¨å…¥ï¼š
   ä¼˜ç‚¹ï¼šå¯é€‰ä¾èµ–ã€è§£å†³å¾ªç¯ä¾èµ–
   ç¼ºç‚¹ï¼šå¯å˜ã€å¯èƒ½å¿˜è®°æ³¨å…¥
   
å­—æ®µæ³¨å…¥ï¼š
   ä¼˜ç‚¹ï¼šä»£ç ç®€æ´
   ç¼ºç‚¹ï¼šéš¾æµ‹è¯•ã€éšè—ä¾èµ–å…³ç³»
```

### 7.2 å®é™…é€‰æ‹©ç­–ç•¥


**æ¨èåšæ³•**ï¼š

```java
@Service
public class OrderService {
    // 1. æ ¸å¿ƒä¾èµ–ç”¨æ„é€ å™¨æ³¨å…¥ï¼ˆå¼ºåˆ¶ã€ä¸å¯å˜ï¼‰
    private final OrderDao orderDao;
    private final UserService userService;
    
    public OrderService(OrderDao orderDao, UserService userService) {
        this.orderDao = orderDao;
        this.userService = userService;
    }
    
    // 2. å¯é€‰é…ç½®ç”¨Setteræ³¨å…¥
    private int timeout = 30;
    
    @Autowired(required = false)
    public void setTimeout(@Value("${order.timeout:30}") int timeout) {
        this.timeout = timeout;
    }
    
    // 3. é¿å…å­—æ®µæ³¨å…¥
    // @Autowired  âŒ ä¸æ¨è
    // private EmailService emailService;
}
```

### 7.3 å…·ä½“åœºæ™¯å»ºè®®


**åœºæ™¯1ï¼šå¿…éœ€çš„ä¸šåŠ¡ä¾èµ–**
```java
// âœ… ä½¿ç”¨æ„é€ å™¨æ³¨å…¥
public class UserService {
    private final UserDao userDao;
    
    public UserService(UserDao userDao) {
        this.userDao = userDao;
    }
}
```

**åœºæ™¯2ï¼šå¯é€‰çš„åŠŸèƒ½æ‰©å±•**
```java
// âœ… ä½¿ç”¨Setteræ³¨å…¥
public class EmailService {
    private EmailTemplate template;
    
    @Autowired(required = false)
    public void setTemplate(EmailTemplate template) {
        this.template = template;
    }
}
```

**åœºæ™¯3ï¼šå¤§é‡ä¾èµ–çš„æƒ…å†µ**
```java
// å‚æ•°å¤ªå¤šæ—¶ï¼Œè€ƒè™‘è®¾è®¡æ˜¯å¦åˆç†
public class OrderService {
    // âŒ å‚æ•°è¿‡å¤šï¼ŒèŒè´£å¯èƒ½ä¸æ¸…æ™°
    public OrderService(OrderDao dao, UserService user, 
                       ProductService product, PayService pay,
                       LogService log, CacheService cache) {
        // ...
    }
}

// âœ… é‡æ„ï¼šæŠ½å–èŒè´£
public class OrderService {
    private final OrderRepository repository;  // åˆå¹¶æ•°æ®è®¿é—®
    private final OrderValidator validator;    // åˆå¹¶æ ¡éªŒé€»è¾‘
    
    public OrderService(OrderRepository repository, 
                       OrderValidator validator) {
        // ...
    }
}
```

### 7.4 å¼€å‘è§„èŒƒå»ºè®®


**å›¢é˜Ÿåä½œè§„èŒƒ**ï¼š

| æ³¨å…¥æ–¹å¼ | **ä½¿ç”¨åœºæ™¯** | **ä»£ç ç¤ºä¾‹** |
|---------|------------|-------------|
| **æ„é€ å™¨** | å¿…éœ€ä¾èµ–ï¼ˆé»˜è®¤ï¼‰ | `public Service(Dao dao)` |
| **Setter** | å¯é€‰ä¾èµ– | `@Autowired(required=false)` |
| **å­—æ®µ** | å°½é‡é¿å… | ä»…ç”¨äºç®€å•æµ‹è¯•ç±» |

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ä¾èµ–æ³¨å…¥æœ¬è´¨ï¼šä¸è‡ªå·±åˆ›å»ºä¾èµ–ï¼Œç”±å®¹å™¨æ³¨å…¥
ğŸ”¸ æ„é€ å™¨æ³¨å…¥ï¼šå¼ºåˆ¶ä¾èµ–ï¼Œæ¨èä½¿ç”¨
ğŸ”¸ Setteræ³¨å…¥ï¼šå¯é€‰ä¾èµ–ï¼Œè§£å†³å¾ªç¯ä¾èµ–
ğŸ”¸ é›†åˆæ³¨å…¥ï¼šList/Setæ³¨å…¥åŒç±»å‹çš„æ‰€æœ‰Bean
ğŸ”¸ Mapæ³¨å…¥ï¼šä»¥Beanåç§°ä¸ºkeyï¼Œå®ç°ç­–ç•¥æ¨¡å¼
ğŸ”¸ å¾ªç¯ä¾èµ–ï¼šæ„é€ å™¨æ— æ³•è§£å†³ï¼ŒSetterå¯ä»¥è§£å†³
ğŸ”¸ æ³¨å…¥é€‰æ‹©ï¼šæ ¸å¿ƒç”¨æ„é€ å™¨ï¼Œå¯é€‰ç”¨Setter
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆæ¨èæ„é€ å™¨æ³¨å…¥**
```
æ ¸å¿ƒåŸå› ï¼š
- åˆ›å»ºå¯¹è±¡æ—¶å°±ç¡®ä¿ä¾èµ–å®Œæ•´
- æ”¯æŒfinalå…³é”®å­—ï¼Œä¿è¯ä¸å¯å˜
- æ— éœ€Springå®¹å™¨å°±èƒ½æµ‹è¯•
- æ˜ç¡®å±•ç¤ºç±»çš„ä¾èµ–å…³ç³»
```

**ğŸ”¹ å¾ªç¯ä¾èµ–çš„æœ¬è´¨é—®é¢˜**
```
æ ¹æœ¬åŸå› ï¼š
- æ„é€ å™¨åˆ›å»ºå¯¹è±¡æ—¶å¿…é¡»æä¾›æ‰€æœ‰ä¾èµ–
- Aéœ€è¦Bï¼ŒBéœ€è¦Aï¼Œè°éƒ½æ— æ³•å…ˆåˆ›å»º

è§£å†³æ€è·¯ï¼š
- å…ˆåˆ›å»ºåŠæˆå“å¯¹è±¡ï¼ˆæ— å±æ€§ï¼‰
- å†æ³¨å…¥ä¾èµ–å®Œæˆå¯¹è±¡
- Setteræ³¨å…¥æ”¯æŒè¿™ä¸ªè¿‡ç¨‹
```

**ğŸ”¹ é›†åˆæ³¨å…¥çš„å®é™…ä»·å€¼**
```
ä¸šåŠ¡åœºæ™¯ï¼š
- å¤šç§æ”¯ä»˜æ–¹å¼ç»Ÿä¸€ç®¡ç†
- å¤šä¸ªæ¶ˆæ¯æ¸ é“æ‰¹é‡å‘é€
- å¤šä¸ªæ•°æ®æºåŠ¨æ€åˆ‡æ¢

æŠ€æœ¯ä¼˜åŠ¿ï¼š
- æ–°å¢å®ç°æ— éœ€ä¿®æ”¹æ³¨å…¥ä»£ç 
- ç¬¦åˆå¼€é—­åŸåˆ™
- æé«˜ä»£ç æ‰©å±•æ€§
```

### 8.3 å®æˆ˜åº”ç”¨å»ºè®®


**ä¾èµ–æ³¨å…¥é…ç½®æ£€æŸ¥æ¸…å•**ï¼š

- â˜‘ï¸ æ ¸å¿ƒä¸šåŠ¡ä¾èµ–ä½¿ç”¨æ„é€ å™¨æ³¨å…¥
- â˜‘ï¸ å¯é€‰é…ç½®ä½¿ç”¨Setteræ³¨å…¥ï¼ŒåŠ `required=false`
- â˜‘ï¸ é¿å…åœ¨ä¸šåŠ¡ä»£ç ä¸­ä½¿ç”¨å­—æ®µæ³¨å…¥
- â˜‘ï¸ å¤šå®ç°ç±»åœºæ™¯è€ƒè™‘List/Mapæ³¨å…¥
- â˜‘ï¸ å‡ºç°å¾ªç¯ä¾èµ–å…ˆæ£€æŸ¥è®¾è®¡æ˜¯å¦åˆç†
- â˜‘ï¸ æ„é€ å™¨å‚æ•°è¶…è¿‡4ä¸ªè€ƒè™‘é‡æ„

**æ€§èƒ½ä¼˜åŒ–æç¤º**ï¼š
```
æ³¨å…¥æ–¹å¼æœ¬èº«å¯¹æ€§èƒ½å½±å“å¾ˆå°ï¼š
- æ³¨å…¥è¿‡ç¨‹å‘ç”Ÿåœ¨åº”ç”¨å¯åŠ¨æ—¶
- è¿è¡Œæ—¶ä¸æ¶‰åŠåå°„æˆ–åŠ¨æ€åˆ›å»º
- é€‰æ‹©åŸåˆ™ä»¥ä»£ç è´¨é‡ä¸ºä¸»
```

**å¸¸è§é”™è¯¯é¿å…**ï¼š
```
âŒ é”™è¯¯1ï¼šæ»¥ç”¨å­—æ®µæ³¨å…¥
   â†’ æ”¹ç”¨æ„é€ å™¨æˆ–Setteræ³¨å…¥

âŒ é”™è¯¯2ï¼šå¾ªç¯ä¾èµ–ç”¨æ„é€ å™¨
   â†’ æ”¹ç”¨Setteræˆ–æ£€æŸ¥è®¾è®¡

âŒ é”™è¯¯3ï¼šæ‰€æœ‰ä¾èµ–éƒ½ç”¨Setter
   â†’ æ ¸å¿ƒä¾èµ–æ”¹ç”¨æ„é€ å™¨

âŒ é”™è¯¯4ï¼šMapæ³¨å…¥ä½†Beanåä¸è§„èŒƒ
   â†’ ç»Ÿä¸€å‘½åè§„åˆ™æˆ–ç”¨@Qualifier
```

### 8.4 å­¦ä¹ è·¯å¾„å»ºè®®


**å­¦ä¹ é¡ºåº**ï¼š
```
ç¬¬1æ­¥ï¼šç†è§£ä¾èµ–æ³¨å…¥çš„ä»·å€¼
   â””â”€ è§£è€¦ã€æ˜“æµ‹è¯•ã€æ˜“ç»´æŠ¤

ç¬¬2æ­¥ï¼šæŒæ¡æ„é€ å™¨æ³¨å…¥ï¼ˆæœ€å¸¸ç”¨ï¼‰
   â””â”€ å¼ºåˆ¶ä¾èµ–ã€ä¸å¯å˜

ç¬¬3æ­¥ï¼šæŒæ¡Setteræ³¨å…¥ï¼ˆå¯é€‰ä¾èµ–ï¼‰
   â””â”€ å¯é€‰é…ç½®ã€å¾ªç¯ä¾èµ–

ç¬¬4æ­¥ï¼šæŒæ¡é›†åˆæ³¨å…¥ï¼ˆå¤šå®ç°ï¼‰
   â””â”€ Listéå†ã€Mapç›´æ¥è·å–

ç¬¬5æ­¥ï¼šç†è§£å¾ªç¯ä¾èµ–åŸç†
   â””â”€ ä¸‰çº§ç¼“å­˜ã€è§£å†³æ–¹æ¡ˆ

ç¬¬6æ­¥ï¼šå½¢æˆè‡ªå·±çš„æ³¨å…¥ç­–ç•¥
   â””â”€ æ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚æ–¹å¼
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- ä¾èµ–æ³¨å…¥è§£è€¦åˆï¼Œå®¹å™¨è´Ÿè´£æ¥ç»„è£…
- æ„é€ å¼ºåˆ¶ä¸å¯å˜ï¼ŒSetterå¯é€‰èƒ½å¾ªç¯
- é›†åˆæ³¨å…¥å¤šå®ç°ï¼ŒMapç­–ç•¥æ›´é«˜æ•ˆ
- å¾ªç¯ä¾èµ–çœ‹æ³¨å…¥ï¼Œæ„é€ ä¸è¡Œç”¨å»¶è¿Ÿ