---
title: 4ã€ApplicationContextæ ¸å¿ƒæ¥å£
---
## ğŸ“š ç›®å½•

1. [ApplicationContextæ˜¯ä»€ä¹ˆ](#1-ApplicationContextæ˜¯ä»€ä¹ˆ)
2. [å®¹å™¨æ¥å£è®¾è®¡](#2-å®¹å™¨æ¥å£è®¾è®¡)
3. [ç”Ÿå‘½å‘¨æœŸç®¡ç†](#3-ç”Ÿå‘½å‘¨æœŸç®¡ç†)
4. [èµ„æºåŠ è½½èƒ½åŠ›](#4-èµ„æºåŠ è½½èƒ½åŠ›)
5. [äº‹ä»¶å‘å¸ƒæœºåˆ¶](#5-äº‹ä»¶å‘å¸ƒæœºåˆ¶)
6. [å›½é™…åŒ–æ”¯æŒ](#6-å›½é™…åŒ–æ”¯æŒ)
7. [ç¯å¢ƒæŠ½è±¡](#7-ç¯å¢ƒæŠ½è±¡)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒŸ ApplicationContextæ˜¯ä»€ä¹ˆ


### 1.1 é€šä¿—ç†è§£


**ç®€å•æ¥è¯´**ï¼šApplicationContextå°±æ˜¯Springçš„"è¶…çº§å®¹å™¨"ï¼Œå®ƒä¸ä»…èƒ½ç®¡ç†Beanï¼ˆJavaå¯¹è±¡ï¼‰ï¼Œè¿˜æä¾›äº†å¾ˆå¤šä¼ä¸šçº§åº”ç”¨éœ€è¦çš„é«˜çº§åŠŸèƒ½ã€‚

```
æ—¥å¸¸ç”Ÿæ´»ç±»æ¯”ï¼š

æ™®é€šå®¹å™¨ï¼ˆBeanFactoryï¼‰= ç®€å•ä»“åº“
- åªè´Ÿè´£å­˜æ”¾å’Œå–å‡ºç‰©å“
- åŠŸèƒ½å•ä¸€ï¼Œå¤Ÿç”¨å°±è¡Œ

ApplicationContext = æ™ºèƒ½ç‰©æµä¸­å¿ƒ
- ä¸ä»…å­˜æ”¾ç‰©å“
- è¿˜èƒ½è‡ªåŠ¨åˆ†ç±»ã€å®šæ—¶é…é€
- æä¾›æ¸©åº¦æ§åˆ¶ã€å®‰å…¨ç›‘æ§
- æ”¯æŒå¤šè¯­è¨€æ ‡ç­¾
- èƒ½å‘é€é€šçŸ¥æ¶ˆæ¯
```

### 1.2 æ ¸å¿ƒå®šä½


**ApplicationContextçš„æœ¬è´¨**ï¼š
- **æ˜¯ä»€ä¹ˆ**ï¼šSpring IoCå®¹å™¨çš„é«˜çº§å®ç°
- **å¹²ä»€ä¹ˆ**ï¼šå…¨æ–¹ä½ç®¡ç†åº”ç”¨ç¨‹åºçš„ç»„ä»¶å’Œé…ç½®
- **ä¸ºä»€ä¹ˆç”¨**ï¼šæä¾›ä¼ä¸šçº§åº”ç”¨æ‰€éœ€çš„å®Œæ•´åŸºç¡€è®¾æ–½

**ğŸ”¸ ä¸BeanFactoryçš„å…³ç³»**
```
BeanFactory (åŸºç¡€å®¹å™¨)
    â†“ ç»§æ‰¿æ‰©å±•
ApplicationContext (é«˜çº§å®¹å™¨)
    â†“ å…·ä½“å®ç°
ClassPathXmlApplicationContext
AnnotationConfigApplicationContext
WebApplicationContext
```

### 1.3 ä¸»è¦åŠŸèƒ½ä¸€è§ˆ


| åŠŸèƒ½ç±»åˆ« | **è¯´æ˜** | **å®é™…ç”¨é€”** |
|---------|---------|-------------|
| ğŸ­ **Beanç®¡ç†** | `åˆ›å»ºã€é…ç½®ã€ç»„è£…Bean` | `åº”ç”¨ç¨‹åºçš„æ ¸å¿ƒå¯¹è±¡ç®¡ç†` |
| ğŸ”„ **ç”Ÿå‘½å‘¨æœŸ** | `æ§åˆ¶Beanä»åˆ›å»ºåˆ°é”€æ¯` | `èµ„æºåˆå§‹åŒ–å’Œæ¸…ç†` |
| ğŸ“ **èµ„æºåŠ è½½** | `ç»Ÿä¸€åŠ è½½å„ç§é…ç½®æ–‡ä»¶` | `é…ç½®æ–‡ä»¶ã€é™æ€èµ„æºè¯»å–` |
| ğŸ“¢ **äº‹ä»¶æœºåˆ¶** | `å‘å¸ƒå’Œç›‘å¬åº”ç”¨äº‹ä»¶` | `ç»„ä»¶é—´è§£è€¦é€šä¿¡` |
| ğŸŒ **å›½é™…åŒ–** | `æ”¯æŒå¤šè¯­è¨€æ¶ˆæ¯` | `å¤šè¯­è¨€åº”ç”¨å¼€å‘` |
| âš™ï¸ **ç¯å¢ƒæŠ½è±¡** | `ç®¡ç†é…ç½®å’Œå±æ€§` | `ä¸åŒç¯å¢ƒé…ç½®åˆ‡æ¢` |

---

## 2. ğŸ—ï¸ å®¹å™¨æ¥å£è®¾è®¡


### 2.1 æ¥å£ç»§æ‰¿ä½“ç³»


**ApplicationContextçš„æ¥å£ç»§æ‰¿å›¾**ï¼š
```
                    BeanFactory (åŸºç¡€Beanå·¥å‚)
                         â†‘
                         |
         +---------------+---------------+
         |               |               |
   ListableBeanFactory  HierarchicalBeanFactory  å…¶ä»–...
         |               |
         +-------+-------+
                 |
        ApplicationContext (åº”ç”¨ä¸Šä¸‹æ–‡)
                 |
         +-------+-------+-------+
         |       |       |       |
    ConfigurableApplicationContext
    WebApplicationContext
    å…¶ä»–å…·ä½“å®ç°...
```

### 2.2 æ ¸å¿ƒæ¥å£èŒè´£


**ğŸ”¸ BeanFactory - åŸºç¡€å·¥å‚**
```
ä½œç”¨ï¼šæä¾›æœ€åŸºæœ¬çš„Beanè·å–èƒ½åŠ›

æ ¸å¿ƒæ–¹æ³•ï¼š
- getBean(String name)           // æ ¹æ®åç§°è·å–Bean
- getBean(Class<T> type)         // æ ¹æ®ç±»å‹è·å–Bean
- containsBean(String name)      // åˆ¤æ–­æ˜¯å¦åŒ…å«Bean
- isSingleton(String name)       // åˆ¤æ–­æ˜¯å¦å•ä¾‹
```

**ğŸ”¸ ListableBeanFactory - å¯åˆ—ä¸¾å·¥å‚**
```
ä½œç”¨ï¼šèƒ½å¤Ÿåˆ—ä¸¾å®¹å™¨ä¸­çš„æ‰€æœ‰Bean

æ ¸å¿ƒèƒ½åŠ›ï¼š
- getBeanDefinitionNames()       // è·å–æ‰€æœ‰Beanåç§°
- getBeansOfType(Class<T> type)  // è·å–æŒ‡å®šç±»å‹çš„æ‰€æœ‰Bean
- getBeanNamesForType()          // è·å–æŒ‡å®šç±»å‹çš„Beanåç§°

å®é™…åº”ç”¨ï¼š
æƒ³çŸ¥é“å®¹å™¨é‡Œæœ‰å“ªäº›Beanï¼Ÿç”¨å®ƒï¼
```

**ğŸ”¸ HierarchicalBeanFactory - å±‚çº§å·¥å‚**
```
ä½œç”¨ï¼šæ”¯æŒçˆ¶å­å®¹å™¨ç»“æ„

æ ¸å¿ƒèƒ½åŠ›ï¼š
- getParentBeanFactory()         // è·å–çˆ¶å®¹å™¨
- containsLocalBean(String name) // ä»…åœ¨å½“å‰å®¹å™¨æŸ¥æ‰¾

å®é™…åº”ç”¨åœºæ™¯ï¼š
çˆ¶å®¹å™¨ï¼šå­˜æ”¾å…¬å…±Beanï¼ˆæ•°æ®æºã€å·¥å…·ç±»ï¼‰
å­å®¹å™¨ï¼šå­˜æ”¾ä¸šåŠ¡Beanï¼ˆControllerã€Serviceï¼‰
```

### 2.3 ApplicationContextç‹¬æœ‰èƒ½åŠ›


**ApplicationContextåœ¨BeanFactoryåŸºç¡€ä¸Šå¢åŠ äº†**ï¼š

```java
// 1. èµ„æºåŠ è½½èƒ½åŠ›
Resource getResource(String location);

// 2. äº‹ä»¶å‘å¸ƒèƒ½åŠ›
void publishEvent(ApplicationEvent event);

// 3. å›½é™…åŒ–èƒ½åŠ›
String getMessage(String code, Object[] args, Locale locale);

// 4. ç¯å¢ƒè®¿é—®èƒ½åŠ›
Environment getEnvironment();

// 5. å¯åŠ¨æ—¶é—´è·å–
long getStartupDate();
```

### 2.4 å¸¸ç”¨å®ç°ç±»


**ğŸ”¸ ä¸‰ç§ä¸»è¦å®ç°æ–¹å¼**

| å®ç°ç±» | **é…ç½®æ–¹å¼** | **é€‚ç”¨åœºæ™¯** | **å¯åŠ¨ç¤ºä¾‹** |
|-------|------------|------------|-------------|
| `ClassPathXmlApplicationContext` | `XMLé…ç½®æ–‡ä»¶` | `ä¼ ç»ŸSpringé¡¹ç›®` | `ä»classpathåŠ è½½é…ç½®` |
| `AnnotationConfigApplicationContext` | `Javaæ³¨è§£é…ç½®` | `çº¯æ³¨è§£é¡¹ç›®` | `åŸºäº@Configurationç±»` |
| `GenericWebApplicationContext` | `Webç¯å¢ƒ` | `Spring MVC/Booté¡¹ç›®` | `Servletå®¹å™¨å¯åŠ¨` |

**ä½¿ç”¨ç¤ºä¾‹å¯¹æ¯”**ï¼š

```java
// æ–¹å¼1ï¼šXMLé…ç½®æ–¹å¼ï¼ˆä¼ ç»Ÿï¼‰
ApplicationContext context = 
    new ClassPathXmlApplicationContext("applicationContext.xml");
UserService userService = context.getBean(UserService.class);

// æ–¹å¼2ï¼šæ³¨è§£é…ç½®æ–¹å¼ï¼ˆç°ä»£ï¼‰
ApplicationContext context = 
    new AnnotationConfigApplicationContext(AppConfig.class);
UserService userService = context.getBean(UserService.class);

// æ–¹å¼3ï¼šSpring Bootæ–¹å¼ï¼ˆæœ€å¸¸ç”¨ï¼‰
@SpringBootApplication
public class Application {
    public static void main(String[] args) {
        ApplicationContext context = 
            SpringApplication.run(Application.class, args);
    }
}
```

---

## 3. ğŸ”„ ç”Ÿå‘½å‘¨æœŸç®¡ç†


### 3.1 ä»€ä¹ˆæ˜¯ç”Ÿå‘½å‘¨æœŸç®¡ç†


**é€šä¿—ç†è§£**ï¼š
```
å°±åƒäººçš„ä¸€ç”Ÿï¼šå‡ºç”Ÿ â†’ æˆé•¿ â†’ å·¥ä½œ â†’ é€€ä¼‘
Beançš„ç”Ÿå‘½å‘¨æœŸï¼šåˆ›å»º â†’ åˆå§‹åŒ– â†’ ä½¿ç”¨ â†’ é”€æ¯

ApplicationContextè´Ÿè´£ç®¡ç†Beançš„æ•´ä¸ª"äººç”Ÿ"
```

### 3.2 Beançš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸ


**ğŸ”¸ ç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾**ï¼š
```
å®¹å™¨å¯åŠ¨
    â†“
è¯»å–é…ç½®ï¼ˆXML/æ³¨è§£ï¼‰
    â†“
å®ä¾‹åŒ–Beanï¼ˆè°ƒç”¨æ„é€ æ–¹æ³•ï¼‰
    â†“
å±æ€§æ³¨å…¥ï¼ˆä¾èµ–æ³¨å…¥ï¼‰
    â†“
BeanNameAware.setBeanName()
    â†“
BeanFactoryAware.setBeanFactory()
    â†“
ApplicationContextAware.setApplicationContext()
    â†“
@PostConstruct æˆ– InitializingBean.afterPropertiesSet()
    â†“
è‡ªå®šä¹‰init-method
    â†“
Beanå¯ä»¥ä½¿ç”¨äº†ï¼
    â†“
å®¹å™¨å…³é—­
    â†“
@PreDestroy æˆ– DisposableBean.destroy()
    â†“
è‡ªå®šä¹‰destroy-method
    â†“
Beanè¢«é”€æ¯
```

### 3.3 ç”Ÿå‘½å‘¨æœŸå›è°ƒæ–¹æ³•


**ğŸ”¸ åˆå§‹åŒ–å›è°ƒï¼ˆä¸‰ç§æ–¹å¼ï¼‰**

**æ–¹å¼1ï¼šä½¿ç”¨@PostConstructæ³¨è§£**ï¼ˆæ¨èâœ…ï¼‰
```java
@Component
public class UserService {
    
    @PostConstruct
    public void init() {
        System.out.println("UserServiceåˆå§‹åŒ–å®Œæˆ");
        // åˆå§‹åŒ–èµ„æºã€å»ºç«‹è¿æ¥ç­‰
    }
}
```

**æ–¹å¼2ï¼šå®ç°InitializingBeanæ¥å£**
```java
@Component
public class UserService implements InitializingBean {
    
    @Override
    public void afterPropertiesSet() {
        System.out.println("å±æ€§è®¾ç½®å®Œæˆåæ‰§è¡Œ");
    }
}
```

**æ–¹å¼3ï¼šXMLé…ç½®init-method**
```xml
<bean id="userService" class="com.example.UserService" 
      init-method="customInit"/>
```

**ğŸ”¸ é”€æ¯å›è°ƒï¼ˆä¸‰ç§æ–¹å¼ï¼‰**

**æ–¹å¼1ï¼šä½¿ç”¨@PreDestroyæ³¨è§£**ï¼ˆæ¨èâœ…ï¼‰
```java
@Component
public class UserService {
    
    @PreDestroy
    public void cleanup() {
        System.out.println("UserServiceå‡†å¤‡é”€æ¯");
        // å…³é—­è¿æ¥ã€é‡Šæ”¾èµ„æºç­‰
    }
}
```

**æ–¹å¼2ï¼šå®ç°DisposableBeanæ¥å£**
```java
@Component
public class UserService implements DisposableBean {
    
    @Override
    public void destroy() {
        System.out.println("Beané”€æ¯å‰æ‰§è¡Œ");
    }
}
```

**æ–¹å¼3ï¼šXMLé…ç½®destroy-method**
```xml
<bean id="userService" class="com.example.UserService" 
      destroy-method="customDestroy"/>
```

### 3.4 Awareæ¥å£æ—


**ä»€ä¹ˆæ˜¯Awareæ¥å£**ï¼š
- **ä½œç”¨**ï¼šè®©Beanèƒ½å¤Ÿæ„ŸçŸ¥åˆ°Springå®¹å™¨çš„å­˜åœ¨
- **æœ¬è´¨**ï¼šå®¹å™¨å›è°ƒæœºåˆ¶ï¼Œè‡ªåŠ¨æ³¨å…¥å®¹å™¨ç›¸å…³å¯¹è±¡

**ğŸ”¸ å¸¸ç”¨Awareæ¥å£**

| Awareæ¥å£ | **æ³¨å…¥å¯¹è±¡** | **ä½¿ç”¨åœºæ™¯** |
|----------|------------|-------------|
| `BeanNameAware` | `Beançš„åç§°` | `éœ€è¦çŸ¥é“è‡ªå·±åœ¨å®¹å™¨ä¸­çš„åå­—` |
| `BeanFactoryAware` | `BeanFactoryå®¹å™¨` | `éœ€è¦è®¿é—®BeanFactory` |
| `ApplicationContextAware` | `ApplicationContextå®¹å™¨` | `éœ€è¦è®¿é—®å®¹å™¨çš„é«˜çº§åŠŸèƒ½` |
| `EnvironmentAware` | `Environmentç¯å¢ƒå¯¹è±¡` | `éœ€è¦è¯»å–é…ç½®å±æ€§` |
| `ResourceLoaderAware` | `ResourceLoaderèµ„æºåŠ è½½å™¨` | `éœ€è¦åŠ è½½å¤–éƒ¨èµ„æº` |

**å®é™…åº”ç”¨ç¤ºä¾‹**ï¼š
```java
@Component
public class MyBean implements ApplicationContextAware {
    
    private ApplicationContext context;
    
    @Override
    public void setApplicationContext(ApplicationContext context) {
        this.context = context;
        System.out.println("å®¹å™¨å·²æ³¨å…¥ï¼Œå¯ä»¥ä½¿ç”¨äº†");
    }
    
    public void doSomething() {
        // ç°åœ¨å¯ä»¥åŠ¨æ€è·å–å…¶ä»–Bean
        UserService service = context.getBean(UserService.class);
    }
}
```

---

## 4. ğŸ“ èµ„æºåŠ è½½èƒ½åŠ›


### 4.1 ä»€ä¹ˆæ˜¯èµ„æºåŠ è½½


**é€šä¿—è§£é‡Š**ï¼š
```
åº”ç”¨ç¨‹åºéœ€è¦è¯»å–å„ç§æ–‡ä»¶ï¼š
- é…ç½®æ–‡ä»¶ï¼ˆ.propertiesã€.ymlï¼‰
- é™æ€èµ„æºï¼ˆå›¾ç‰‡ã€CSSã€JSï¼‰
- æ¨¡æ¿æ–‡ä»¶ï¼ˆHTMLæ¨¡æ¿ï¼‰

ApplicationContextæä¾›ç»Ÿä¸€çš„æ–¹å¼åŠ è½½è¿™äº›èµ„æº
ä¸ç”¨å…³å¿ƒæ–‡ä»¶åœ¨å“ªé‡Œï¼ˆclasspathã€æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œï¼‰
```

### 4.2 Resourceæ¥å£ä½“ç³»


**ğŸ”¸ Resourceç±»å‹**

```
Resource (èµ„æºæŠ½è±¡æ¥å£)
    â†“
    â”œâ”€â”€ ClassPathResource    (classpathä¸‹çš„èµ„æº)
    â”œâ”€â”€ FileSystemResource   (æ–‡ä»¶ç³»ç»Ÿèµ„æº)
    â”œâ”€â”€ UrlResource          (URLèµ„æº)
    â”œâ”€â”€ ServletContextResource (Webèµ„æº)
    â””â”€â”€ ByteArrayResource    (å­—èŠ‚æ•°ç»„èµ„æº)
```

### 4.3 èµ„æºåŠ è½½æ–¹å¼


**ğŸ”¸ ä½¿ç”¨ResourceLoaderåŠ è½½èµ„æº**

```java
@Component
public class ResourceDemo implements ResourceLoaderAware {
    
    private ResourceLoader resourceLoader;
    
    @Override
    public void setResourceLoader(ResourceLoader resourceLoader) {
        this.resourceLoader = resourceLoader;
    }
    
    public void loadResources() {
        // 1. åŠ è½½classpathèµ„æº
        Resource res1 = resourceLoader.getResource("classpath:config.properties");
        
        // 2. åŠ è½½æ–‡ä»¶ç³»ç»Ÿèµ„æº
        Resource res2 = resourceLoader.getResource("file:/data/config.txt");
        
        // 3. åŠ è½½URLèµ„æº
        Resource res3 = resourceLoader.getResource("https://example.com/data.json");
    }
}
```

**ğŸ”¸ èµ„æºè·¯å¾„å‰ç¼€**

| å‰ç¼€ | **è¯´æ˜** | **ç¤ºä¾‹** |
|-----|---------|---------|
| `classpath:` | `ç±»è·¯å¾„ä¸‹çš„èµ„æº` | `classpath:application.properties` |
| `file:` | `æ–‡ä»¶ç³»ç»Ÿèµ„æº` | `file:/var/config/app.yml` |
| `http://` | `ç½‘ç»œèµ„æº` | `http://example.com/data.json` |
| æ— å‰ç¼€ | `ç›¸å¯¹è·¯å¾„æˆ–é»˜è®¤ä½ç½®` | `config.properties` |

### 4.4 å®é™…åº”ç”¨åœºæ™¯


**åœºæ™¯1ï¼šè¯»å–é…ç½®æ–‡ä»¶**
```java
@Component
public class ConfigReader {
    
    @Autowired
    private ResourceLoader resourceLoader;
    
    public Properties loadConfig() throws IOException {
        Resource resource = resourceLoader.getResource("classpath:app.properties");
        Properties props = new Properties();
        props.load(resource.getInputStream());
        return props;
    }
}
```

**åœºæ™¯2ï¼šåŠ è½½æ¨¡æ¿æ–‡ä»¶**
```java
@Service
public class EmailService {
    
    @Autowired
    private ApplicationContext context;
    
    public String loadEmailTemplate() throws IOException {
        Resource template = context.getResource("classpath:templates/email.html");
        return new String(template.getInputStream().readAllBytes());
    }
}
```

---

## 5. ğŸ“¢ äº‹ä»¶å‘å¸ƒæœºåˆ¶


### 5.1 ä»€ä¹ˆæ˜¯äº‹ä»¶æœºåˆ¶


**é€šä¿—ç†è§£**ï¼š
```
å°±åƒå¾®ä¿¡ç¾¤å‘æ¶ˆæ¯ï¼š
- å‘å¸ƒè€…ï¼šå‘é€æ¶ˆæ¯åˆ°ç¾¤é‡Œ
- è®¢é˜…è€…ï¼šè®¾ç½®äº†ç¾¤æ¶ˆæ¯æé†’çš„äººä¼šæ”¶åˆ°é€šçŸ¥
- å®¹å™¨ï¼šå¾®ä¿¡ç¾¤æœ¬èº«

Springäº‹ä»¶æœºåˆ¶å°±æ˜¯å®¹å™¨å†…éƒ¨çš„"æ¶ˆæ¯ç¾¤èŠ"
```

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
- **äº‹ä»¶ï¼ˆEventï¼‰**ï¼šè¦ä¼ æ’­çš„æ¶ˆæ¯å†…å®¹
- **å‘å¸ƒè€…ï¼ˆPublisherï¼‰**ï¼šå‘é€äº‹ä»¶çš„ç»„ä»¶
- **ç›‘å¬å™¨ï¼ˆListenerï¼‰**ï¼šæ¥æ”¶å¹¶å¤„ç†äº‹ä»¶çš„ç»„ä»¶
- **å®¹å™¨**ï¼šè´Ÿè´£äº‹ä»¶çš„ä¼ é€’

### 5.2 äº‹ä»¶æœºåˆ¶ä¸‰è¦ç´ 


**ğŸ”¸ è¦ç´ 1ï¼šå®šä¹‰äº‹ä»¶**

```java
// è‡ªå®šä¹‰äº‹ä»¶éœ€è¦ç»§æ‰¿ApplicationEvent
public class UserRegisterEvent extends ApplicationEvent {
    
    private String username;
    private String email;
    
    public UserRegisterEvent(Object source, String username, String email) {
        super(source);  // sourceæ˜¯äº‹ä»¶æºï¼ˆè°å‘å¸ƒçš„ï¼‰
        this.username = username;
        this.email = email;
    }
    
    // getters...
}
```

**ğŸ”¸ è¦ç´ 2ï¼šå‘å¸ƒäº‹ä»¶**

```java
@Service
public class UserService {
    
    @Autowired
    private ApplicationContext context;
    
    public void register(String username, String email) {
        // 1. æ‰§è¡Œæ³¨å†Œä¸šåŠ¡é€»è¾‘
        System.out.println("ç”¨æˆ·æ³¨å†Œï¼š" + username);
        
        // 2. å‘å¸ƒæ³¨å†ŒæˆåŠŸäº‹ä»¶
        UserRegisterEvent event = new UserRegisterEvent(this, username, email);
        context.publishEvent(event);
    }
}
```

**ğŸ”¸ è¦ç´ 3ï¼šç›‘å¬äº‹ä»¶**

**æ–¹å¼1ï¼šä½¿ç”¨@EventListeneræ³¨è§£**ï¼ˆæ¨èâœ…ï¼‰
```java
@Component
public class EmailNotificationListener {
    
    @EventListener
    public void handleUserRegister(UserRegisterEvent event) {
        System.out.println("å‘é€æ¬¢è¿é‚®ä»¶ç»™ï¼š" + event.getEmail());
        // å‘é€é‚®ä»¶é€»è¾‘
    }
}
```

**æ–¹å¼2ï¼šå®ç°ApplicationListeneræ¥å£**
```java
@Component
public class SmsNotificationListener 
    implements ApplicationListener<UserRegisterEvent> {
    
    @Override
    public void onApplicationEvent(UserRegisterEvent event) {
        System.out.println("å‘é€çŸ­ä¿¡ç»™ï¼š" + event.getUsername());
        // å‘é€çŸ­ä¿¡é€»è¾‘
    }
}
```

### 5.3 å¼‚æ­¥äº‹ä»¶å¤„ç†


**é»˜è®¤æ˜¯åŒæ­¥æ‰§è¡Œçš„**ï¼Œå¯ä»¥é€šè¿‡@Asyncå®ç°å¼‚æ­¥ï¼š

```java
@Configuration
@EnableAsync  // å¼€å¯å¼‚æ­¥æ”¯æŒ
public class AsyncConfig {
    
    @Bean
    public Executor taskExecutor() {
        return new ThreadPoolTaskExecutor();
    }
}

@Component
public class AsyncEventListener {
    
    @Async  // å¼‚æ­¥æ‰§è¡Œ
    @EventListener
    public void handleEvent(UserRegisterEvent event) {
        // å¼‚æ­¥å¤„ç†äº‹ä»¶
    }
}
```

### 5.4 Springå†…ç½®äº‹ä»¶


**ApplicationContextæä¾›çš„æ ‡å‡†äº‹ä»¶**ï¼š

| äº‹ä»¶ | **è§¦å‘æ—¶æœº** | **ç”¨é€”** |
|-----|------------|---------|
| `ContextRefreshedEvent` | `å®¹å™¨åˆå§‹åŒ–æˆ–åˆ·æ–°å®Œæˆ` | `å®¹å™¨å¯åŠ¨åçš„åˆå§‹åŒ–å·¥ä½œ` |
| `ContextStartedEvent` | `å®¹å™¨å¯åŠ¨æ—¶` | `å®¹å™¨å¯åŠ¨åçš„å¤„ç†` |
| `ContextStoppedEvent` | `å®¹å™¨åœæ­¢æ—¶` | `å®¹å™¨åœæ­¢å‰çš„æ¸…ç†` |
| `ContextClosedEvent` | `å®¹å™¨å…³é—­æ—¶` | `å®¹å™¨å…³é—­å‰çš„èµ„æºé‡Šæ”¾` |

**ç›‘å¬å®¹å™¨å¯åŠ¨å®Œæˆ**ï¼š
```java
@Component
public class StartupListener {
    
    @EventListener
    public void onStartup(ContextRefreshedEvent event) {
        System.out.println("å®¹å™¨å¯åŠ¨å®Œæˆï¼Œæ‰§è¡Œåˆå§‹åŒ–ä»»åŠ¡");
        // é¢„åŠ è½½ç¼“å­˜ã€åˆå§‹åŒ–è¿æ¥æ± ç­‰
    }
}
```

---

## 6. ğŸŒ å›½é™…åŒ–æ”¯æŒ


### 6.1 ä»€ä¹ˆæ˜¯å›½é™…åŒ–


**é€šä¿—ç†è§£**ï¼š
```
å›½é™…åŒ–ï¼ˆi18nï¼‰= è®©åº”ç”¨æ”¯æŒå¤šè¯­è¨€

ä¾‹å¦‚ï¼š
ä¸­æ–‡ç”¨æˆ·çœ‹åˆ°ï¼šæ¬¢è¿ä½¿ç”¨
è‹±æ–‡ç”¨æˆ·çœ‹åˆ°ï¼šWelcome
æ—¥æ–‡ç”¨æˆ·çœ‹åˆ°ï¼šã‚ˆã†ã“ã

ApplicationContextèƒ½è‡ªåŠ¨æ ¹æ®ç”¨æˆ·è¯­è¨€ç¯å¢ƒæ˜¾ç¤ºå¯¹åº”æ–‡æœ¬
```

### 6.2 å›½é™…åŒ–é…ç½®æ­¥éª¤


**æ­¥éª¤1ï¼šåˆ›å»ºèµ„æºæ–‡ä»¶**

```
resources/
  â”œâ”€â”€ messages.properties          (é»˜è®¤)
  â”œâ”€â”€ messages_zh_CN.properties    (ä¸­æ–‡)
  â””â”€â”€ messages_en_US.properties    (è‹±æ–‡)
```

**messages_zh_CN.properties**ï¼š
```properties
welcome.message=æ¬¢è¿ä½¿ç”¨ç³»ç»Ÿ
user.login.success=ç™»å½•æˆåŠŸ
user.login.failed=ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯
```

**messages_en_US.properties**ï¼š
```properties
welcome.message=Welcome to the system
user.login.success=Login successful
user.login.failed=Invalid username or password
```

**æ­¥éª¤2ï¼šé…ç½®MessageSource**

```java
@Configuration
public class I18nConfig {
    
    @Bean
    public MessageSource messageSource() {
        ResourceBundleMessageSource source = new ResourceBundleMessageSource();
        source.setBasename("messages");  // èµ„æºæ–‡ä»¶åŸºç¡€å
        source.setDefaultEncoding("UTF-8");
        return source;
    }
}
```

**æ­¥éª¤3ï¼šä½¿ç”¨å›½é™…åŒ–æ¶ˆæ¯**

```java
@Service
public class LoginService {
    
    @Autowired
    private MessageSource messageSource;
    
    public String login(String username, String password) {
        if (authenticate(username, password)) {
            // è·å–å½“å‰è¯­è¨€ç¯å¢ƒçš„æ¶ˆæ¯
            return messageSource.getMessage(
                "user.login.success",   // æ¶ˆæ¯key
                null,                   // å‚æ•°
                Locale.getDefault()     // è¯­è¨€ç¯å¢ƒ
            );
        } else {
            return messageSource.getMessage(
                "user.login.failed", 
                null, 
                Locale.getDefault()
            );
        }
    }
}
```

### 6.3 å¸¦å‚æ•°çš„å›½é™…åŒ–æ¶ˆæ¯


**èµ„æºæ–‡ä»¶**ï¼š
```properties
# messages_zh_CN.properties
welcome.user=æ¬¢è¿æ‚¨ï¼Œ{0}ï¼æ‚¨æœ‰{1}æ¡æ–°æ¶ˆæ¯

# messages_en_US.properties
welcome.user=Welcome, {0}! You have {1} new messages
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```java
String message = messageSource.getMessage(
    "welcome.user",
    new Object[]{"å¼ ä¸‰", 5},  // å‚æ•°æ•°ç»„
    Locale.CHINA
);
// è¾“å‡ºï¼šæ¬¢è¿æ‚¨ï¼Œå¼ ä¸‰ï¼æ‚¨æœ‰5æ¡æ–°æ¶ˆæ¯
```

---

## 7. âš™ï¸ ç¯å¢ƒæŠ½è±¡


### 7.1 ä»€ä¹ˆæ˜¯ç¯å¢ƒæŠ½è±¡


**é€šä¿—ç†è§£**ï¼š
```
ä¸åŒç¯å¢ƒéœ€è¦ä¸åŒé…ç½®ï¼š
- å¼€å‘ç¯å¢ƒï¼šè¿æ¥æµ‹è¯•æ•°æ®åº“
- ç”Ÿäº§ç¯å¢ƒï¼šè¿æ¥æ­£å¼æ•°æ®åº“

Environmentå°±æ˜¯Springæä¾›çš„"ç¯å¢ƒç®¡ç†å™¨"
è‡ªåŠ¨è¯†åˆ«å½“å‰ç¯å¢ƒï¼ŒåŠ è½½å¯¹åº”é…ç½®
```

### 7.2 Environmentæ ¸å¿ƒæ¦‚å¿µ


**ğŸ”¸ EnvironmentåŒ…å«ä¸¤éƒ¨åˆ†**ï¼š

**1. Profilesï¼ˆç¯å¢ƒé…ç½®ï¼‰**
```
ä½œç”¨ï¼šå®šä¹‰ä¸åŒç¯å¢ƒçš„é…ç½®é›†åˆ

ä¾‹å¦‚ï¼š
@Profile("dev")   -> å¼€å‘ç¯å¢ƒ
@Profile("prod")  -> ç”Ÿäº§ç¯å¢ƒ
@Profile("test")  -> æµ‹è¯•ç¯å¢ƒ
```

**2. Propertiesï¼ˆå±æ€§é…ç½®ï¼‰**
```
ä½œç”¨ï¼šç®¡ç†æ‰€æœ‰é…ç½®å±æ€§

æ¥æºï¼š
- application.properties
- ç³»ç»Ÿå±æ€§ï¼ˆSystem.getProperties()ï¼‰
- ç¯å¢ƒå˜é‡ï¼ˆSystem.getenv()ï¼‰
- JNDIå±æ€§
```

### 7.3 Profileä½¿ç”¨


**ğŸ”¸ å®šä¹‰ä¸åŒç¯å¢ƒçš„Bean**

```java
@Configuration
public class DataSourceConfig {
    
    @Bean
    @Profile("dev")  // å¼€å‘ç¯å¢ƒ
    public DataSource devDataSource() {
        return new HikariDataSource() {{
            setJdbcUrl("jdbc:mysql://localhost:3306/dev_db");
            setUsername("dev");
            setPassword("dev123");
        }};
    }
    
    @Bean
    @Profile("prod")  // ç”Ÿäº§ç¯å¢ƒ
    public DataSource prodDataSource() {
        return new HikariDataSource() {{
            setJdbcUrl("jdbc:mysql://prod-server:3306/prod_db");
            setUsername("prod");
            setPassword("prod123");
        }};
    }
}
```

**ğŸ”¸ æ¿€æ´»Profileçš„æ–¹å¼**

**æ–¹å¼1ï¼šé…ç½®æ–‡ä»¶æ¿€æ´»**
```properties
# application.properties
spring.profiles.active=dev
```

**æ–¹å¼2ï¼šå¯åŠ¨å‚æ•°æ¿€æ´»**
```bash
java -jar app.jar --spring.profiles.active=prod
```

**æ–¹å¼3ï¼šä»£ç æ¿€æ´»**
```java
public static void main(String[] args) {
    SpringApplication app = new SpringApplication(Application.class);
    app.setAdditionalProfiles("dev");
    app.run(args);
}
```

### 7.4 å±æ€§è®¿é—®


**ğŸ”¸ è·å–é…ç½®å±æ€§**

```java
@Service
public class ConfigService {
    
    @Autowired
    private Environment env;
    
    public void printConfig() {
        // è·å–å±æ€§å€¼
        String appName = env.getProperty("app.name");
        String port = env.getProperty("server.port", "8080");  // é»˜è®¤å€¼
        
        // è·å–å½“å‰æ¿€æ´»çš„Profile
        String[] profiles = env.getActiveProfiles();
        System.out.println("å½“å‰ç¯å¢ƒï¼š" + Arrays.toString(profiles));
        
        // åˆ¤æ–­Profileæ˜¯å¦æ¿€æ´»
        boolean isDev = env.acceptsProfiles(Profiles.of("dev"));
    }
}
```

**ğŸ”¸ å±æ€§æ¥æºä¼˜å…ˆçº§**ï¼ˆä»é«˜åˆ°ä½ï¼‰

```
1. å‘½ä»¤è¡Œå‚æ•°
   â†“
2. Javaç³»ç»Ÿå±æ€§ï¼ˆSystem.getProperties()ï¼‰
   â†“
3. æ“ä½œç³»ç»Ÿç¯å¢ƒå˜é‡
   â†“
4. application.propertiesé…ç½®æ–‡ä»¶
   â†“
5. é»˜è®¤å±æ€§
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ApplicationContextæœ¬è´¨ï¼šSpringé«˜çº§IoCå®¹å™¨
ğŸ”¸ æ ¸å¿ƒèƒ½åŠ›ï¼šBeanç®¡ç† + ä¼ä¸šçº§åŠŸèƒ½
ğŸ”¸ æ¥å£ä½“ç³»ï¼šç»§æ‰¿BeanFactoryï¼Œæ‰©å±•é«˜çº§åŠŸèƒ½
ğŸ”¸ ç”Ÿå‘½å‘¨æœŸï¼šä»åˆ›å»ºåˆ°é”€æ¯çš„å®Œæ•´ç®¡ç†
ğŸ”¸ èµ„æºåŠ è½½ï¼šç»Ÿä¸€çš„èµ„æºè®¿é—®æŠ½è±¡
ğŸ”¸ äº‹ä»¶æœºåˆ¶ï¼šç»„ä»¶é—´è§£è€¦é€šä¿¡
ğŸ”¸ å›½é™…åŒ–ï¼šå¤šè¯­è¨€æ”¯æŒ
ğŸ”¸ ç¯å¢ƒæŠ½è±¡ï¼šå¤šç¯å¢ƒé…ç½®ç®¡ç†
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ApplicationContext vs BeanFactory**
```
BeanFactoryï¼š
- åŸºç¡€å®¹å™¨ï¼ŒæŒ‰éœ€åŠ è½½Bean
- åŠŸèƒ½ç®€å•ï¼Œé€‚åˆèµ„æºå—é™ç¯å¢ƒ

ApplicationContextï¼š
- é«˜çº§å®¹å™¨ï¼Œå¯åŠ¨æ—¶åŠ è½½æ‰€æœ‰Bean
- åŠŸèƒ½ä¸°å¯Œï¼Œé€‚åˆä¼ä¸šåº”ç”¨
- åŒ…å«BeanFactoryçš„æ‰€æœ‰åŠŸèƒ½
```

**ğŸ”¹ ç”Ÿå‘½å‘¨æœŸç®¡ç†çš„ä»·å€¼**
```
ä¸ºä»€ä¹ˆéœ€è¦ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Ÿ

1. åˆå§‹åŒ–èµ„æºï¼šæ•°æ®åº“è¿æ¥ã€çº¿ç¨‹æ± 
2. æ¸…ç†èµ„æºï¼šå…³é—­è¿æ¥ã€é‡Šæ”¾å†…å­˜
3. ä¾èµ–æ³¨å…¥ï¼šç¡®ä¿ä¾èµ–æŒ‰é¡ºåºåˆ›å»º
4. æ‰©å±•ç‚¹ï¼šåœ¨ç‰¹å®šæ—¶æœºæ‰§è¡Œè‡ªå®šä¹‰é€»è¾‘
```

**ğŸ”¹ äº‹ä»¶æœºåˆ¶çš„åº”ç”¨åœºæ™¯**
```
å…¸å‹åœºæ™¯ï¼š
âœ… ç”¨æˆ·æ³¨å†Œ â†’ å‘é€é‚®ä»¶/çŸ­ä¿¡
âœ… è®¢å•åˆ›å»º â†’ æ‰£å‡åº“å­˜/å‘é€é€šçŸ¥
âœ… å®¹å™¨å¯åŠ¨ â†’ é¢„åŠ è½½ç¼“å­˜/åˆå§‹åŒ–è¿æ¥

ä¼˜åŠ¿ï¼š
- è§£è€¦ï¼šå‘å¸ƒè€…ä¸éœ€è¦çŸ¥é“ç›‘å¬è€…
- çµæ´»ï¼šå¯ä»¥åŠ¨æ€å¢å‡ç›‘å¬å™¨
- å¼‚æ­¥ï¼šæ”¯æŒå¼‚æ­¥å¤„ç†æé«˜æ€§èƒ½
```

### 8.3 å®é™…åº”ç”¨å»ºè®®


**é€‰æ‹©åˆé€‚çš„å®¹å™¨å®ç°**ï¼š
```
XMLé…ç½®é¡¹ç›®ï¼š
â†’ ClassPathXmlApplicationContext

çº¯æ³¨è§£é¡¹ç›®ï¼š
â†’ AnnotationConfigApplicationContext

Spring Booté¡¹ç›®ï¼š
â†’ è‡ªåŠ¨é…ç½®ï¼Œæ— éœ€æ‰‹åŠ¨åˆ›å»º

Webé¡¹ç›®ï¼š
â†’ WebApplicationContext
```

**ç”Ÿå‘½å‘¨æœŸå›è°ƒé€‰æ‹©**ï¼š
```
æ¨èä½¿ç”¨ï¼š
âœ… @PostConstruct / @PreDestroy
   - æ ‡å‡†JSR-250æ³¨è§£
   - ä»£ç æ¸…æ™°ï¼Œæ˜“äºç†è§£

é¿å…ä½¿ç”¨ï¼š
âŒ InitializingBean / DisposableBean
   - ä¸Springè€¦åˆ
   - ä»£ç å¯è¯»æ€§å·®
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
å®¹å™¨ç®¡ç†Beanç”Ÿå‘½ï¼Œèµ„æºåŠ è½½ç»Ÿä¸€é—¨
äº‹ä»¶å‘å¸ƒè§£è€¦åˆï¼Œå›½é™…å¤šè¯­ç¯å¢ƒåˆ†
é«˜çº§åŠŸèƒ½åœ¨Contextï¼Œä¼ä¸šåº”ç”¨å¿…é¡»å­¦
```