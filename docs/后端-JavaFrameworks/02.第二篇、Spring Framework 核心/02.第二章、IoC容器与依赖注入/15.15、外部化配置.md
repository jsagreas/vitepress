---
title: 15ã€å¤–éƒ¨åŒ–é…ç½®
---
## ğŸ“š ç›®å½•

1. [å¤–éƒ¨åŒ–é…ç½®çš„åŸºæœ¬æ¦‚å¿µ](#1-å¤–éƒ¨åŒ–é…ç½®çš„åŸºæœ¬æ¦‚å¿µ)
2. [Environmentæ¥å£è¯¦è§£](#2-Environmentæ¥å£è¯¦è§£)
3. [@PropertySourceæ³¨è§£ä½¿ç”¨](#3-PropertySourceæ³¨è§£ä½¿ç”¨)
4. [PropertySourcesPlaceholderConfigureré…ç½®å™¨](#4-PropertySourcesPlaceholderConfigureré…ç½®å™¨)
5. [å ä½ç¬¦${}è¯­æ³•è¯¦è§£](#5-å ä½ç¬¦è¯­æ³•è¯¦è§£)
6. [é…ç½®ä¼˜å…ˆçº§æœºåˆ¶](#6-é…ç½®ä¼˜å…ˆçº§æœºåˆ¶)
7. [å±æ€§è§£æåŸç†](#7-å±æ€§è§£æåŸç†)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ å¤–éƒ¨åŒ–é…ç½®çš„åŸºæœ¬æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯å¤–éƒ¨åŒ–é…ç½®

ğŸ¯ **ç®€å•ç†è§£**ï¼šæŠŠç¨‹åºä¸­ä¼šå˜åŒ–çš„å€¼å†™åˆ°é…ç½®æ–‡ä»¶é‡Œï¼Œä¸ç”¨æ”¹ä»£ç å°±èƒ½ä¿®æ”¹ç¨‹åºè¡Œä¸º

```
ç”Ÿæ´»ä¸­çš„ç±»æ¯”ï¼š
é¥æ§å™¨è®¾ç½® â†’ ä½ å¯ä»¥è°ƒèŠ‚éŸ³é‡ã€é¢‘é“ï¼Œä¸ç”¨æ‹†å¼€ç”µè§†æœº
å¤–éƒ¨åŒ–é…ç½® â†’ ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œä¸ç”¨é‡æ–°ç¼–è¯‘ç¨‹åº

ä¸ºä»€ä¹ˆéœ€è¦å¤–éƒ¨åŒ–é…ç½®ï¼Ÿ
1. å¼€å‘ç¯å¢ƒç”¨æµ‹è¯•æ•°æ®åº“
2. ç”Ÿäº§ç¯å¢ƒç”¨æ­£å¼æ•°æ®åº“
3. åªéœ€ä¿®æ”¹é…ç½®ï¼Œä»£ç å®Œå…¨ä¸å˜
```

**ğŸ”¸ å¤–éƒ¨åŒ–é…ç½®çš„æ ¸å¿ƒä»·å€¼**
```
ç¯å¢ƒé€‚é…ï¼š
- å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒé…ç½®åˆ†ç¦»
- åŒä¸€å¥—ä»£ç é€‚åº”ä¸åŒç¯å¢ƒ
- é¿å…ç¡¬ç¼–ç å¸¦æ¥çš„ç»´æŠ¤å›°éš¾

çµæ´»æ€§ï¼š
- ä¸é‡å¯åº”ç”¨å³å¯ä¿®æ”¹æŸäº›é…ç½®
- è¿ç»´äººå‘˜å¯ä»¥è°ƒæ•´é…ç½®å‚æ•°
- æ”¯æŒåŠ¨æ€é…ç½®æ›´æ–°

å®‰å…¨æ€§ï¼š
- æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç ã€å¯†é’¥ï¼‰ç‹¬ç«‹å­˜å‚¨
- é…ç½®æ–‡ä»¶å¯ä»¥åŠ å¯†ä¿æŠ¤
- ä»£ç ä»“åº“ä¸åŒ…å«æ•æ„Ÿä¿¡æ¯
```

### 1.2 Springæ”¯æŒçš„é…ç½®æºç±»å‹

**ğŸ“‹ å¤šæ ·åŒ–çš„é…ç½®æ¥æº**

| é…ç½®æºç±»å‹ | **è¯´æ˜** | **ä½¿ç”¨åœºæ™¯** | **ä¼˜å…ˆçº§** |
|----------|---------|-------------|-----------|
| ğŸ”¸ **å‘½ä»¤è¡Œå‚æ•°** | `java -jar app.jar --server.port=9090` | `å¿«é€Ÿä¸´æ—¶è°ƒæ•´` | `æœ€é«˜` |
| ğŸ”¸ **ç³»ç»Ÿå±æ€§** | `System.setProperty("key", "value")` | `JVMçº§åˆ«é…ç½®` | `é«˜` |
| ğŸ”¸ **ç¯å¢ƒå˜é‡** | `export DB_URL=jdbc:mysql://...` | `å®¹å™¨åŒ–éƒ¨ç½²` | `ä¸­é«˜` |
| ğŸ”¸ **é…ç½®æ–‡ä»¶** | `application.properties` | `å¸¸è§„åº”ç”¨é…ç½®` | `ä¸­` |
| ğŸ”¸ **@PropertySource** | `è‡ªå®šä¹‰é…ç½®æ–‡ä»¶` | `æ¨¡å—åŒ–é…ç½®` | `å¯é…ç½®` |

### 1.3 é…ç½®æ–‡ä»¶çš„åŸºæœ¬æ ¼å¼

**ğŸ“ ä¸¤ç§ä¸»æµé…ç½®æ ¼å¼**

```properties
# application.propertiesæ ¼å¼ï¼ˆä¼ ç»Ÿæ ¼å¼ï¼‰
# ç‰¹ç‚¹ï¼šç®€å•ç›´è§‚ï¼Œé”®å€¼å¯¹å½¢å¼

# æ•°æ®åº“é…ç½®
spring.datasource.url=jdbc:mysql://localhost:3306/mydb
spring.datasource.username=root
spring.datasource.password=123456
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# æœåŠ¡å™¨é…ç½®
server.port=8080
server.servlet.context-path=/app
```

```yaml
# application.ymlæ ¼å¼ï¼ˆæ¨èæ ¼å¼ï¼‰
# ç‰¹ç‚¹ï¼šå±‚æ¬¡æ¸…æ™°ï¼Œç»“æ„åŒ–å¼º

# æ•°æ®åº“é…ç½®
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/mydb
    username: root
    password: 123456
    driver-class-name: com.mysql.cj.jdbc.Driver

# æœåŠ¡å™¨é…ç½®
server:
  port: 8080
  servlet:
    context-path: /app
```

**ğŸ’¡ æ ¼å¼é€‰æ‹©å»ºè®®**
```
é€‰æ‹©.propertiesçš„æƒ…å†µï¼š
âœ… é…ç½®é¡¹è¾ƒå°‘ï¼Œç»“æ„ç®€å•
âœ… å›¢é˜Ÿæˆå‘˜æ›´ç†Ÿæ‚‰propertiesæ ¼å¼
âœ… éœ€è¦å…¼å®¹æ—§ç‰ˆæœ¬Spring

é€‰æ‹©.ymlçš„æƒ…å†µï¼š
âœ… é…ç½®é¡¹è¾ƒå¤šï¼Œå±‚æ¬¡å¤æ‚
âœ… éœ€è¦æ›´å¥½çš„å¯è¯»æ€§
âœ… æ”¯æŒå¤æ‚æ•°æ®ç»“æ„ï¼ˆåˆ—è¡¨ã€å¯¹è±¡ï¼‰

å®é™…å»ºè®®ï¼š
- æ–°é¡¹ç›®æ¨èä½¿ç”¨application.yml
- ç®€å•é…ç½®å¯ä»¥ç”¨application.properties
- ä¸¤ç§æ ¼å¼å¯ä»¥æ··ç”¨ï¼ˆä½†ä¸æ¨èï¼‰
```

---

## 2. ğŸŒ Environmentæ¥å£è¯¦è§£


### 2.1 Environmentæ˜¯ä»€ä¹ˆ

ğŸ¯ **æ ¸å¿ƒç†è§£**ï¼šEnvironmentå°±åƒä¸€ä¸ª"é…ç½®ç®¡ç†ä¸­å¿ƒ"ï¼Œè´Ÿè´£ç®¡ç†æ‰€æœ‰é…ç½®ä¿¡æ¯

```
ç”Ÿæ´»ä¸­çš„ç±»æ¯”ï¼š
å›¾ä¹¦ç®¡ç†å‘˜ â†’ çŸ¥é“æ‰€æœ‰ä¹¦åœ¨å“ªï¼Œå¸®ä½ æ‰¾åˆ°éœ€è¦çš„ä¹¦
Environment â†’ ç®¡ç†æ‰€æœ‰é…ç½®æºï¼Œå¸®ä½ æ‰¾åˆ°éœ€è¦çš„é…ç½®

Environmentçš„èŒè´£ï¼š
1. ç»Ÿä¸€ç®¡ç†å„ç§é…ç½®æº
2. æä¾›é…ç½®æŸ¥è¯¢æ¥å£
3. å¤„ç†é…ç½®ä¼˜å…ˆçº§
4. ç®¡ç†Profileæ¿€æ´»
```

### 2.2 Environmentçš„æ ¸å¿ƒåŠŸèƒ½

**ğŸ”§ Environmentæ¥å£çš„ä¸»è¦æ–¹æ³•**

```java
public interface Environment {
    
    // 1. è·å–é…ç½®å±æ€§
    String getProperty(String key);
    String getProperty(String key, String defaultValue);
    <T> T getProperty(String key, Class<T> targetType);
    
    // 2. æ£€æŸ¥é…ç½®æ˜¯å¦å­˜åœ¨
    boolean containsProperty(String key);
    
    // 3. Profileç›¸å…³æ“ä½œ
    String[] getActiveProfiles();      // è·å–æ¿€æ´»çš„Profile
    String[] getDefaultProfiles();     // è·å–é»˜è®¤Profile
    boolean acceptsProfiles(String... profiles);  // æ£€æŸ¥Profileæ˜¯å¦æ¿€æ´»
}
```

### 2.3 Environmentçš„å®é™…ä½¿ç”¨

**ğŸ’» è·å–å’Œä½¿ç”¨Environment**

```java
@Component
public class DatabaseConfig {
    
    // æ–¹å¼1ï¼šç›´æ¥æ³¨å…¥Environmentï¼ˆæœ€å¸¸ç”¨ï¼‰
    @Autowired
    private Environment env;
    
    public void printConfig() {
        // è·å–é…ç½®å€¼
        String dbUrl = env.getProperty("spring.datasource.url");
        Integer port = env.getProperty("server.port", Integer.class);
        
        // è®¾ç½®é»˜è®¤å€¼
        String username = env.getProperty("db.username", "root");
        
        System.out.println("æ•°æ®åº“URL: " + dbUrl);
        System.out.println("æœåŠ¡ç«¯å£: " + port);
    }
}
```

**ğŸ” Environmentçš„é«˜çº§ç”¨æ³•**

```java
@Configuration
public class AdvancedEnvConfig {
    
    @Autowired
    private Environment env;
    
    @Bean
    public DataSource dataSource() {
        // æ ¹æ®æ¿€æ´»çš„Profileå†³å®šé…ç½®
        if (env.acceptsProfiles(Profiles.of("dev"))) {
            // å¼€å‘ç¯å¢ƒé…ç½®
            return createDevDataSource();
        } else if (env.acceptsProfiles(Profiles.of("prod"))) {
            // ç”Ÿäº§ç¯å¢ƒé…ç½®
            return createProdDataSource();
        }
        return createDefaultDataSource();
    }
    
    // ç±»å‹å®‰å…¨çš„å±æ€§è·å–
    public void typeSafeConfig() {
        // è‡ªåŠ¨è½¬æ¢ä¸ºIntegerç±»å‹
        Integer maxConnections = env.getProperty(
            "db.pool.max-size", 
            Integer.class, 
            10  // é»˜è®¤å€¼
        );
        
        // è‡ªåŠ¨è½¬æ¢ä¸ºBooleanç±»å‹
        Boolean useSSL = env.getProperty(
            "db.use-ssl", 
            Boolean.class, 
            false
        );
    }
}
```

### 2.4 Environmentä¸ApplicationContextçš„å…³ç³»

**ğŸ”— å®ƒä»¬å¦‚ä½•ååŒå·¥ä½œ**

```
ApplicationContext (åº”ç”¨ä¸Šä¸‹æ–‡)
        â”‚
        â”œâ”€â”€ æŒæœ‰ Environment å¯¹è±¡
        â”œâ”€â”€ ç®¡ç†æ‰€æœ‰Bean
        â””â”€â”€ æä¾›å„ç§æœåŠ¡

Environment (ç¯å¢ƒæŠ½è±¡)
        â”‚
        â”œâ”€â”€ PropertySources (å±æ€§æºé›†åˆ)
        â”‚   â”œâ”€â”€ å‘½ä»¤è¡Œå‚æ•°
        â”‚   â”œâ”€â”€ ç³»ç»Ÿå±æ€§
        â”‚   â”œâ”€â”€ ç¯å¢ƒå˜é‡
        â”‚   â””â”€â”€ é…ç½®æ–‡ä»¶
        â”‚
        â””â”€â”€ Profiles (æ¿€æ´»çš„é…ç½®æ–‡ä»¶)

å…³ç³»è¯´æ˜ï¼š
- ApplicationContextåŒ…å«Environment
- Environmentç®¡ç†æ‰€æœ‰é…ç½®æº
- é…ç½®æºæŒ‰ä¼˜å…ˆçº§æ’åˆ—
- æ•´ä¸ªåº”ç”¨å…±äº«ä¸€ä¸ªEnvironmentå®ä¾‹
```

---

## 3. ğŸ“ @PropertySourceæ³¨è§£ä½¿ç”¨


### 3.1 @PropertySourceçš„åŸºæœ¬ä½œç”¨

ğŸ¯ **æ ¸å¿ƒåŠŸèƒ½**ï¼šå‘Šè¯‰Springä»å“ªä¸ªé…ç½®æ–‡ä»¶åŠ è½½å±æ€§

```
å·¥ä½œåŸç†ç±»æ¯”ï¼š
@PropertySourceå°±åƒå‘Šè¯‰å›¾ä¹¦ç®¡ç†å‘˜
"è¯·æŠŠæ¶å­ä¸Šçš„ã€Šé…ç½®æ‰‹å†Œã€‹æ‹¿æ¥ï¼Œæˆ‘è¦ç”¨é‡Œé¢çš„ä¿¡æ¯"

å®é™…ä½œç”¨ï¼š
1. æŒ‡å®šé¢å¤–çš„é…ç½®æ–‡ä»¶ä½ç½®
2. å°†é…ç½®åŠ è½½åˆ°Environmentä¸­
3. æ”¯æŒå ä½ç¬¦è§£æ
```

### 3.2 @PropertySourceåŸºç¡€ç”¨æ³•

**ğŸ“ å•ä¸ªé…ç½®æ–‡ä»¶åŠ è½½**

```java
// åŸºç¡€ç”¨æ³•ï¼šåŠ è½½ç±»è·¯å¾„ä¸‹çš„é…ç½®æ–‡ä»¶
@Configuration
@PropertySource("classpath:database.properties")
public class DatabaseConfig {
    
    @Autowired
    private Environment env;
    
    @Bean
    public DataSource dataSource() {
        String url = env.getProperty("db.url");
        String username = env.getProperty("db.username");
        // åˆ›å»ºæ•°æ®æº...
    }
}
```

**é…ç½®æ–‡ä»¶å†…å®¹ç¤ºä¾‹**ï¼š
```properties
# database.properties
db.url=jdbc:mysql://localhost:3306/mydb
db.username=root
db.password=123456
db.pool.max-size=20
```

### 3.3 @PropertySourceé«˜çº§ç‰¹æ€§

**ğŸ”§ å¤šé…ç½®æ–‡ä»¶åŠ è½½**

```java
// åŠ è½½å¤šä¸ªé…ç½®æ–‡ä»¶
@Configuration
@PropertySource({
    "classpath:database.properties",
    "classpath:redis.properties",
    "classpath:mq.properties"
})
public class MultiSourceConfig {
    // æ‰€æœ‰é…ç½®æ–‡ä»¶çš„å±æ€§éƒ½ä¼šè¢«åŠ è½½
}

// ä½¿ç”¨å ä½ç¬¦ï¼ˆæ ¹æ®ç¯å¢ƒåŠ è½½ä¸åŒæ–‡ä»¶ï¼‰
@Configuration
@PropertySource("classpath:application-${spring.profiles.active}.properties")
public class ProfileBasedConfig {
    // å¼€å‘ç¯å¢ƒåŠ è½½ï¼šapplication-dev.properties
    // ç”Ÿäº§ç¯å¢ƒåŠ è½½ï¼šapplication-prod.properties
}
```

**ğŸ¨ @PropertySourceçš„å®Œæ•´å‚æ•°**

```java
@Configuration
@PropertySource(
    value = "classpath:custom.properties",  // é…ç½®æ–‡ä»¶è·¯å¾„
    ignoreResourceNotFound = true,          // æ–‡ä»¶ä¸å­˜åœ¨æ—¶ä¸æŠ¥é”™
    encoding = "UTF-8",                     // æ–‡ä»¶ç¼–ç 
    name = "customConfig"                   // é…ç½®æºåç§°
)
public class CustomConfig {
    // é…ç½®è¯¦è§£ï¼š
    // value: å¿…å¡«ï¼Œé…ç½®æ–‡ä»¶ä½ç½®
    // ignoreResourceNotFound: é»˜è®¤falseï¼Œæ‰¾ä¸åˆ°æ–‡ä»¶ä¼šæŠ¥é”™
    // encoding: é»˜è®¤ä½¿ç”¨ç³»ç»Ÿç¼–ç ï¼Œå»ºè®®æ˜ç¡®æŒ‡å®šUTF-8
    // name: ç»™è¿™ä¸ªé…ç½®æºèµ·ä¸ªåå­—ï¼Œæ–¹ä¾¿è°ƒè¯•
}
```

### 3.4 @PropertySource vs application.properties

**ğŸ“Š ä¸¤è€…çš„åŒºåˆ«ä¸é€‰æ‹©**

```
application.properties/ymlï¼ˆé»˜è®¤é…ç½®ï¼‰ï¼š
ä¼˜ç‚¹ï¼š
âœ… Springè‡ªåŠ¨åŠ è½½ï¼Œæ— éœ€æ³¨è§£
âœ… æ”¯æŒProfileæœºåˆ¶ï¼ˆapplication-dev.ymlï¼‰
âœ… é…ç½®é¡¹æœ‰IDEæç¤ºå’Œæ ¡éªŒ
âœ… æ•´åˆåº¦æœ€å¥½

ç¼ºç‚¹ï¼š
âŒ æ‰€æœ‰é…ç½®æ··åœ¨ä¸€èµ·ï¼Œæ–‡ä»¶å¯èƒ½å¾ˆå¤§
âŒ ä¸é€‚åˆæ¨¡å—åŒ–é…ç½®ç®¡ç†

@PropertySourceï¼ˆè‡ªå®šä¹‰é…ç½®ï¼‰ï¼š
ä¼˜ç‚¹ï¼š
âœ… å¯ä»¥æŒ‰åŠŸèƒ½æ¨¡å—æ‹†åˆ†é…ç½®æ–‡ä»¶
âœ… é…ç½®æ–‡ä»¶ä½ç½®çµæ´»
âœ… é€‚åˆç¬¬ä¸‰æ–¹åº“çš„ç‹¬ç«‹é…ç½®

ç¼ºç‚¹ï¼š
âŒ éœ€è¦æ‰‹åŠ¨æ·»åŠ æ³¨è§£
âŒ ä¼˜å…ˆçº§ä½äºapplication.properties
âŒ ä¸æ”¯æŒYAMLæ ¼å¼ï¼ˆSpring 5.xé™åˆ¶ï¼‰

é€‰æ‹©å»ºè®®ï¼š
1. åº”ç”¨ä¸»é…ç½®ç”¨application.properties/yml
2. æ¨¡å—åŒ–é…ç½®ç”¨@PropertySource
3. æ•æ„Ÿé…ç½®ç”¨ç‹¬ç«‹çš„é…ç½®æ–‡ä»¶
```

---

## 4. âš™ï¸ PropertySourcesPlaceholderConfigureré…ç½®å™¨


### 4.1 é…ç½®å™¨çš„ä½œç”¨

ğŸ¯ **æ ¸å¿ƒåŠŸèƒ½**ï¼šè®©Springèƒ½å¤Ÿè§£æé…ç½®æ–‡ä»¶ä¸­çš„å ä½ç¬¦`${...}`

```
å·¥ä½œåŸç†ç±»æ¯”ï¼š
ç¿»è¯‘å™¨ â†’ æŠŠè‹±æ–‡ç¿»è¯‘æˆä¸­æ–‡
PropertySourcesPlaceholderConfigurer â†’ æŠŠ${db.url}ç¿»è¯‘æˆå®é™…çš„æ•°æ®åº“åœ°å€

ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ
æ²¡æœ‰å®ƒï¼š@Value("${db.url}") åªä¼šå¾—åˆ°å­—ç¬¦ä¸²"${db.url}"
æœ‰äº†å®ƒï¼š@Value("${db.url}") ä¼šå¾—åˆ°å®é™…å€¼"jdbc:mysql://..."
```

### 4.2 é…ç½®å™¨çš„ä½¿ç”¨æ–¹å¼

**ğŸ“ é…ç½®æ–¹å¼å¯¹æ¯”**

```java
// æ–¹å¼1ï¼šä½¿ç”¨@PropertySourceæ—¶è‡ªåŠ¨å¯ç”¨ï¼ˆæ¨èï¼‰
@Configuration
@PropertySource("classpath:database.properties")
public class AutoConfig {
    // Spring Bootä¼šè‡ªåŠ¨é…ç½®PropertySourcesPlaceholderConfigurer
    // æ— éœ€æ‰‹åŠ¨å£°æ˜
    
    @Value("${db.url}")
    private String dbUrl;  // å¯ä»¥ç›´æ¥ä½¿ç”¨å ä½ç¬¦
}

// æ–¹å¼2ï¼šæ‰‹åŠ¨é…ç½®Beanï¼ˆSpringä¼ ç»Ÿæ–¹å¼ï¼‰
@Configuration
public class ManualConfig {
    
    @Bean
    public static PropertySourcesPlaceholderConfigurer placeholderConfigurer() {
        PropertySourcesPlaceholderConfigurer configurer = 
            new PropertySourcesPlaceholderConfigurer();
        
        // å¯é€‰ï¼šè®¾ç½®é…ç½®æ–‡ä»¶ä½ç½®
        configurer.setLocation(
            new ClassPathResource("custom.properties")
        );
        
        // å¯é€‰ï¼šè®¾ç½®å¤šä¸ªé…ç½®æ–‡ä»¶
        configurer.setLocations(
            new ClassPathResource("db.properties"),
            new ClassPathResource("redis.properties")
        );
        
        return configurer;
    }
}
```

**âš ï¸ é‡è¦æç¤º**
```
ä¸ºä»€ä¹ˆå¿…é¡»æ˜¯staticæ–¹æ³•ï¼Ÿ

æ™®é€šBeançš„åˆ›å»ºæ—¶æœºï¼š
1. Springæ‰«æ@Configurationç±»
2. åˆ›å»ºConfigurationå®ä¾‹
3. è°ƒç”¨@Beanæ–¹æ³•åˆ›å»ºBean
4. è§£æ@Valueæ³¨è§£ï¼Œæ³¨å…¥å±æ€§å€¼

static Beançš„åˆ›å»ºæ—¶æœºï¼š
1. Springæ‰«æ@Configurationç±»
2. ç›´æ¥è°ƒç”¨staticæ–¹æ³•åˆ›å»ºBeanï¼ˆä¸éœ€è¦å®ä¾‹åŒ–Configurationï¼‰
3. PropertySourcesPlaceholderConfigureræå‰å°±ç»ª
4. åç»­çš„@Valueè§£ææ‰èƒ½æ­£å¸¸å·¥ä½œ

ç»“è®ºï¼šPropertySourcesPlaceholderConfigurerå¿…é¡»åœ¨
ä»»ä½•éœ€è¦å±æ€§æ³¨å…¥çš„Beanä¹‹å‰åˆ›å»ºï¼Œæ‰€ä»¥ç”¨static
```

### 4.3 é…ç½®å™¨çš„é«˜çº§ç‰¹æ€§

**ğŸ”§ è‡ªå®šä¹‰é…ç½®è§£æè¡Œä¸º**

```java
@Bean
public static PropertySourcesPlaceholderConfigurer advancedConfigurer() {
    PropertySourcesPlaceholderConfigurer configurer = 
        new PropertySourcesPlaceholderConfigurer();
    
    // 1. è®¾ç½®å ä½ç¬¦å‰ç¼€å’Œåç¼€ï¼ˆé»˜è®¤æ˜¯${}ï¼‰
    configurer.setPlaceholderPrefix("#{");
    configurer.setPlaceholderSuffix("}");
    // ç°åœ¨å¯ä»¥ç”¨#{db.url}ä»£æ›¿${db.url}
    
    // 2. è®¾ç½®å€¼åˆ†éš”ç¬¦ï¼ˆé»˜è®¤æ˜¯:ï¼‰
    configurer.setValueSeparator("=");
    // é»˜è®¤å€¼å†™æ³•å˜æˆï¼š${db.url=localhost}
    
    // 3. å¿½ç•¥æ— æ³•è§£æçš„å ä½ç¬¦
    configurer.setIgnoreUnresolvablePlaceholders(true);
    // ${unknown.key}æ‰¾ä¸åˆ°æ—¶ä¸æŠ¥é”™ï¼Œä¿æŒåŸæ ·
    
    // 4. ç©ºå€¼å¤„ç†
    configurer.setNullValue("@null");
    // é…ç½®æ–‡ä»¶ä¸­å†™@nullè¡¨ç¤ºnullå€¼
    
    return configurer;
}
```

---

## 5. ğŸ’² å ä½ç¬¦${}è¯­æ³•è¯¦è§£


### 5.1 åŸºç¡€å ä½ç¬¦è¯­æ³•

ğŸ¯ **è¯­æ³•æ ¼å¼**ï¼š`${é…ç½®é”®å:é»˜è®¤å€¼}`

```java
@Component
public class ConfigDemo {
    
    // åŸºç¡€ç”¨æ³•ï¼šè·å–é…ç½®å€¼
    @Value("${server.port}")
    private int port;
    
    // å¸¦é»˜è®¤å€¼ï¼šé…ç½®ä¸å­˜åœ¨æ—¶ä½¿ç”¨8080
    @Value("${server.port:8080}")
    private int portWithDefault;
    
    // å­—ç¬¦ä¸²é…ç½®
    @Value("${app.name:MyApp}")
    private String appName;
    
    // å¸ƒå°”å€¼é…ç½®
    @Value("${app.debug:false}")
    private boolean debugMode;
}
```

**ğŸ“‹ æ”¯æŒçš„æ•°æ®ç±»å‹**

| ç±»å‹ | **é…ç½®ç¤ºä¾‹** | **Javaä»£ç ** |
|-----|------------|-------------|
| ğŸ”¸ **å­—ç¬¦ä¸²** | `app.name=MyApp` | `@Value("${app.name}")` |
| ğŸ”¸ **æ•´æ•°** | `server.port=8080` | `@Value("${server.port}")` |
| ğŸ”¸ **å¸ƒå°”å€¼** | `app.debug=true` | `@Value("${app.debug}")` |
| ğŸ”¸ **æµ®ç‚¹æ•°** | `rate.value=0.15` | `@Value("${rate.value}")` |
| ğŸ”¸ **åˆ—è¡¨** | `app.tags=java,spring` | `@Value("${app.tags}")` |

### 5.2 é«˜çº§å ä½ç¬¦ç”¨æ³•

**ğŸ¨ å¤æ‚åœºæ™¯çš„å ä½ç¬¦ä½¿ç”¨**

```java
@Component
public class AdvancedPlaceholder {
    
    // 1. åµŒå¥—å ä½ç¬¦
    @Value("${app.${spring.profiles.active}.url}")
    private String dynamicUrl;
    // å¦‚æœspring.profiles.active=dev
    // å®é™…è¯»å–app.dev.url
    
    // 2. å ä½ç¬¦è¡¨è¾¾å¼
    @Value("${db.url:jdbc:mysql://${db.host:localhost}:${db.port:3306}/${db.name}}")
    private String jdbcUrl;
    // é»˜è®¤å€¼ä¸­ä¹Ÿå¯ä»¥åŒ…å«å ä½ç¬¦
    
    // 3. é›†åˆç±»å‹æ³¨å…¥
    @Value("${app.allowed-origins}")
    private List<String> allowedOrigins;
    // é…ç½®ï¼šapp.allowed-origins=http://localhost,http://example.com
    
    // 4. æ•°ç»„æ³¨å…¥
    @Value("${app.admin-emails}")
    private String[] adminEmails;
    
    // 5. Mapæ³¨å…¥ï¼ˆéœ€è¦ç‰¹æ®Šå¤„ç†ï¼‰
    @Value("#{${app.settings}}")
    private Map<String, String> settings;
    // é…ç½®ï¼šapp.settings={key1:'value1',key2:'value2'}
}
```

### 5.3 å ä½ç¬¦åœ¨é…ç½®æ–‡ä»¶ä¸­çš„ä½¿ç”¨

**ğŸ”— é…ç½®æ–‡ä»¶å†…å¼•ç”¨**

```properties
# åŸºç¡€é…ç½®
app.name=MyApplication
app.version=1.0.0

# å¼•ç”¨å…¶ä»–é…ç½®
app.full-name=${app.name} v${app.version}
# ç»“æœï¼šMyApplication v1.0.0

# æ•°æ®åº“é…ç½®å¤ç”¨
db.host=localhost
db.port=3306
db.name=mydb
db.url=jdbc:mysql://${db.host}:${db.port}/${db.name}

# ç¯å¢ƒç›¸å…³é…ç½®
spring.profiles.active=dev
log.file=/logs/${spring.profiles.active}/app.log
# å¼€å‘ç¯å¢ƒï¼š/logs/dev/app.log
# ç”Ÿäº§ç¯å¢ƒï¼š/logs/prod/app.log
```

### 5.4 å ä½ç¬¦è§£ææµç¨‹

**ğŸ” Springå¦‚ä½•è§£æå ä½ç¬¦**

```
è§£ææ­¥éª¤ï¼š
1. å‘ç°å ä½ç¬¦ ${db.url}
   â†“
2. ä»Environmentä¸­æŸ¥æ‰¾"db.url"
   â†“
3. æŒ‰ä¼˜å…ˆçº§æœç´¢å„ä¸ªé…ç½®æº
   - å‘½ä»¤è¡Œå‚æ•°
   - ç³»ç»Ÿå±æ€§
   - ç¯å¢ƒå˜é‡
   - é…ç½®æ–‡ä»¶
   â†“
4. æ‰¾åˆ°é…ç½®å€¼æˆ–ä½¿ç”¨é»˜è®¤å€¼
   â†“
5. é€’å½’è§£æå†…åµŒå ä½ç¬¦
   â†“
6. è¿”å›æœ€ç»ˆè§£æç»“æœ

æ³¨æ„äº‹é¡¹ï¼š
âš ï¸ å¾ªç¯å¼•ç”¨ä¼šå¯¼è‡´é”™è¯¯
   db.url=${db.url}  âŒ é”™è¯¯
   
âš ï¸ ä¸å­˜åœ¨ä¸”æ— é»˜è®¤å€¼ä¼šæŠ¥é”™
   ${unknown.key}    âŒ é”™è¯¯
   ${unknown.key:}   âœ… ä½¿ç”¨ç©ºå­—ç¬¦ä¸²
```

---

## 6. ğŸ† é…ç½®ä¼˜å…ˆçº§æœºåˆ¶


### 6.1 Spring Booté…ç½®ä¼˜å…ˆçº§

ğŸ¯ **ä¼˜å…ˆçº§è§„åˆ™**ï¼šåé¢çš„é…ç½®ä¼šè¦†ç›–å‰é¢çš„é…ç½®

```
ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼š

1. å‘½ä»¤è¡Œå‚æ•°
   java -jar app.jar --server.port=9090
   â””â”€ æœ€é«˜ä¼˜å…ˆçº§ï¼Œé€‚åˆä¸´æ—¶è°ƒæ•´

2. ç³»ç»Ÿå±æ€§ (System.getProperties())
   -Dserver.port=9090
   â””â”€ JVMçº§åˆ«å‚æ•°

3. æ“ä½œç³»ç»Ÿç¯å¢ƒå˜é‡
   export SERVER_PORT=9090
   â””â”€ é€‚åˆå®¹å™¨åŒ–éƒ¨ç½²

4. application-{profile}.properties/yml
   application-prod.properties
   â””â”€ ç¯å¢ƒç‰¹å®šé…ç½®

5. application.properties/yml
   é¡¹ç›®é»˜è®¤é…ç½®æ–‡ä»¶
   â””â”€ åŸºç¡€é…ç½®

6. @PropertySourceæŒ‡å®šçš„é…ç½®æ–‡ä»¶
   è‡ªå®šä¹‰é…ç½®æ–‡ä»¶
   â””â”€ æœ€ä½ä¼˜å…ˆçº§
```

### 6.2 é…ç½®æ–‡ä»¶çš„æœç´¢ä½ç½®

**ğŸ“‚ Spring Booté…ç½®æ–‡ä»¶æœç´¢é¡ºåº**

```
æœç´¢ä½ç½®ï¼ˆä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼‰ï¼š

1. file:./config/        (é¡¹ç›®æ ¹ç›®å½•çš„configå­ç›®å½•)
   â””â”€ /myproject/config/application.yml

2. file:./               (é¡¹ç›®æ ¹ç›®å½•)
   â””â”€ /myproject/application.yml

3. classpath:/config/    (ç±»è·¯å¾„çš„configç›®å½•)
   â””â”€ src/main/resources/config/application.yml

4. classpath:/           (ç±»è·¯å¾„æ ¹ç›®å½•)
   â””â”€ src/main/resources/application.yml

å®é™…åœºæ™¯ï¼š
å¼€å‘æ—¶ï¼šé…ç½®åœ¨ src/main/resources/application.yml
éƒ¨ç½²åï¼šå¯ä»¥åœ¨jaråŒ…åŒçº§ç›®å½•æ”¾application.ymlè¦†ç›–
Dockerï¼šé€šè¿‡æŒ‚è½½/configç›®å½•æä¾›é…ç½®
```

### 6.3 é…ç½®è¦†ç›–å®æˆ˜ç¤ºä¾‹

**ğŸ’¡ å®é™…åœºæ™¯ä¸­çš„é…ç½®è¦†ç›–**

```yaml
# src/main/resources/application.ymlï¼ˆåŸºç¡€é…ç½®ï¼‰
server:
  port: 8080
  
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/dev_db
    username: dev_user
```

```yaml
# src/main/resources/application-prod.ymlï¼ˆç”Ÿäº§é…ç½®ï¼‰
spring:
  datasource:
    url: jdbc:mysql://prod-db:3306/prod_db
    username: prod_user
```

```bash
# å¯åŠ¨å‘½ä»¤ï¼ˆå‘½ä»¤è¡Œè¦†ç›–ï¼‰
java -jar myapp.jar \
  --spring.profiles.active=prod \
  --server.port=9090 \
  --spring.datasource.password=secret123
  
# æœ€ç»ˆç”Ÿæ•ˆçš„é…ç½®ï¼š
# server.port = 9090               (æ¥è‡ªå‘½ä»¤è¡Œ)
# spring.datasource.url = jdbc...prod_db  (æ¥è‡ªprodé…ç½®)
# spring.datasource.username = prod_user  (æ¥è‡ªprodé…ç½®)
# spring.datasource.password = secret123  (æ¥è‡ªå‘½ä»¤è¡Œ)
```

### 6.4 é…ç½®ä¼˜å…ˆçº§çš„å®é™…åº”ç”¨

**ğŸ”§ ä¸åŒç¯å¢ƒçš„é…ç½®ç­–ç•¥**

```
å¼€å‘ç¯å¢ƒç­–ç•¥ï¼š
â”œâ”€â”€ application.yml              # é€šç”¨é…ç½®
â”œâ”€â”€ application-dev.yml          # å¼€å‘ç¯å¢ƒé…ç½®
â””â”€â”€ æœ¬åœ°ä¿®æ”¹ï¼šå‘½ä»¤è¡Œå‚æ•°ä¸´æ—¶è°ƒæ•´

æµ‹è¯•ç¯å¢ƒç­–ç•¥ï¼š
â”œâ”€â”€ application.yml              # é€šç”¨é…ç½®
â”œâ”€â”€ application-test.yml         # æµ‹è¯•ç¯å¢ƒé…ç½®
â””â”€â”€ ç¯å¢ƒå˜é‡ï¼šCI/CDç³»ç»Ÿæ³¨å…¥é…ç½®

ç”Ÿäº§ç¯å¢ƒç­–ç•¥ï¼š
â”œâ”€â”€ application.yml              # é€šç”¨é…ç½®ï¼ˆæ‰“åŒ…åœ¨jarä¸­ï¼‰
â”œâ”€â”€ application-prod.yml         # ç”Ÿäº§é…ç½®ï¼ˆæ‰“åŒ…åœ¨jarä¸­ï¼‰
â”œâ”€â”€ å¤–éƒ¨é…ç½®æ–‡ä»¶ï¼š/config/application.ymlï¼ˆè¦†ç›–æ•æ„Ÿä¿¡æ¯ï¼‰
â””â”€â”€ ç¯å¢ƒå˜é‡ï¼šå®¹å™¨ç¼–æ’ç³»ç»Ÿæ³¨å…¥

ä¼˜åŠ¿åˆ†æï¼š
âœ… æ•æ„Ÿä¿¡æ¯ä¸æäº¤ä»£ç ä»“åº“
âœ… ä¸åŒç¯å¢ƒçµæ´»åˆ‡æ¢
âœ… é…ç½®å˜æ›´ä¸éœ€è¦é‡æ–°æ‰“åŒ…
âœ… æ”¯æŒé…ç½®åŠ å¯†å’Œæƒé™æ§åˆ¶
```

---

## 7. ğŸ”§ å±æ€§è§£æåŸç†


### 7.1 å±æ€§è§£æçš„æ ¸å¿ƒç»„ä»¶

ğŸ¯ **è§£æé“¾è·¯**ï¼šä»é…ç½®æ–‡ä»¶åˆ°Beanå±æ€§çš„å®Œæ•´è¿‡ç¨‹

```
å±æ€§è§£æç»„ä»¶å…³ç³»ï¼š

PropertySource (é…ç½®æº)
    â†“ æä¾›é…ç½®
Environment (ç¯å¢ƒæŠ½è±¡)
    â†“ ç®¡ç†é…ç½®
PropertyResolver (å±æ€§è§£æå™¨)
    â†“ è§£æå ä½ç¬¦
TypeConverter (ç±»å‹è½¬æ¢å™¨)
    â†“ è½¬æ¢ç±»å‹
Bean Property (Beanå±æ€§)
    â†“ æœ€ç»ˆæ³¨å…¥

æ¯ä¸ªç»„ä»¶çš„èŒè´£ï¼š
1. PropertySourceï¼šå°è£…å®é™…çš„é…ç½®æ•°æ®
2. Environmentï¼šç®¡ç†å¤šä¸ªPropertySource
3. PropertyResolverï¼šå¤„ç†å ä½ç¬¦å’Œé»˜è®¤å€¼
4. TypeConverterï¼šå­—ç¬¦ä¸²è½¬æ¢ä¸ºç›®æ ‡ç±»å‹
5. Bean Propertyï¼šæ¥æ”¶æœ€ç»ˆå€¼
```

### 7.2 å±æ€§è§£æçš„è¯¦ç»†æµç¨‹

**ğŸ” ä»@Valueåˆ°å±æ€§å€¼çš„å®Œæ•´è¿‡ç¨‹**

```java
@Component
public class ConfigBean {
    @Value("${app.timeout:30}")
    private int timeout;
}
```

**è§£ææ­¥éª¤åˆ†è§£**ï¼š
```
Step 1: Springæ‰«æåˆ°@Valueæ³¨è§£
   â””â”€ å‘ç°éœ€è¦æ³¨å…¥çš„å±æ€§ï¼štimeout
   
Step 2: è§£æè¡¨è¾¾å¼ "${app.timeout:30}"
   â”œâ”€ æå–å ä½ç¬¦ï¼šapp.timeout
   â”œâ”€ æå–é»˜è®¤å€¼ï¼š30
   â””â”€ æå–ç›®æ ‡ç±»å‹ï¼šint

Step 3: ä»EnvironmentæŸ¥æ‰¾é…ç½®
   â”œâ”€ éå†PropertySourceåˆ—è¡¨
   â”œâ”€ åœ¨æ¯ä¸ªé…ç½®æºä¸­æŸ¥æ‰¾"app.timeout"
   â””â”€ æ‰¾åˆ°åˆ™è¿”å›ï¼Œå¦åˆ™ç»§ç»­

Step 4: å¤„ç†æŸ¥æ‰¾ç»“æœ
   â”œâ”€ æ‰¾åˆ°é…ç½®ï¼šä½¿ç”¨é…ç½®å€¼
   â””â”€ æœªæ‰¾åˆ°ï¼šä½¿ç”¨é»˜è®¤å€¼30

Step 5: ç±»å‹è½¬æ¢
   â”œâ”€ é…ç½®å€¼æ˜¯Stringç±»å‹
   â”œâ”€ ç›®æ ‡ç±»å‹æ˜¯int
   â””â”€ è°ƒç”¨ConversionServiceè½¬æ¢

Step 6: æ³¨å…¥Beanå±æ€§
   â””â”€ å°†è½¬æ¢åçš„å€¼èµ‹ç»™timeoutå­—æ®µ
```

### 7.3 ç±»å‹è½¬æ¢æœºåˆ¶

**ğŸ”„ Springçš„æ™ºèƒ½ç±»å‹è½¬æ¢**

```java
@Component
public class TypeConversionDemo {
    
    // String â†’ Integer
    @Value("${app.max-users:100}")
    private Integer maxUsers;
    
    // String â†’ Boolean
    @Value("${app.enabled:true}")
    private Boolean enabled;
    
    // String â†’ List<String>
    @Value("${app.roles:ADMIN,USER,GUEST}")
    private List<String> roles;
    
    // String â†’ Duration (Spring Bootæ”¯æŒ)
    @Value("${app.timeout:30s}")
    private Duration timeout;
    
    // String â†’ LocalDate
    @Value("${app.start-date:2024-01-01}")
    private LocalDate startDate;
}
```

**æ”¯æŒçš„è½¬æ¢ç±»å‹**ï¼š
```
åŸºæœ¬ç±»å‹ï¼š
âœ… String â†’ int/Integer
âœ… String â†’ long/Long
âœ… String â†’ boolean/Boolean
âœ… String â†’ double/Double

é›†åˆç±»å‹ï¼š
âœ… String â†’ List (é€—å·åˆ†éš”)
âœ… String â†’ Set
âœ… String â†’ Array

æ—¶é—´ç±»å‹ï¼š
âœ… String â†’ Date
âœ… String â†’ LocalDate/LocalDateTime
âœ… String â†’ Duration (å¦‚ï¼š30s, 5m, 2h)

ç‰¹æ®Šç±»å‹ï¼š
âœ… String â†’ URL
âœ… String â†’ File
âœ… String â†’ Enum
âœ… String â†’ è‡ªå®šä¹‰å¯¹è±¡ï¼ˆå®ç°Converterï¼‰
```

### 7.4 é…ç½®ç»‘å®šæœºåˆ¶

**ğŸ”— @ConfigurationProperties vs @Value**

```java
// æ–¹å¼1ï¼š@Valueï¼ˆé€‚åˆå°‘é‡é…ç½®ï¼‰
@Component
public class SimpleConfig {
    @Value("${db.url}")
    private String url;
    
    @Value("${db.username}")
    private String username;
    
    @Value("${db.password}")
    private String password;
}

// æ–¹å¼2ï¼š@ConfigurationPropertiesï¼ˆæ¨èï¼Œé€‚åˆæ‰¹é‡é…ç½®ï¼‰
@Component
@ConfigurationProperties(prefix = "db")
public class DatabaseProperties {
    private String url;
    private String username;
    private String password;
    
    // è‡ªåŠ¨ç»‘å®šï¼Œéœ€è¦æä¾›getter/setter
    // æˆ–ä½¿ç”¨@Data(Lombok)
}
```

**é…ç½®æ–‡ä»¶**ï¼š
```properties
db.url=jdbc:mysql://localhost:3306/mydb
db.username=root
db.password=123456
```

**ä¸¤ç§æ–¹å¼å¯¹æ¯”**ï¼š

| ç‰¹æ€§ | **@Value** | **@ConfigurationProperties** |
|-----|-----------|------------------------------|
| ğŸ”¸ **ä½¿ç”¨åœºæ™¯** | `å•ä¸ªé…ç½®` | `æ‰¹é‡é…ç½®` |
| ğŸ”¸ **ç±»å‹å®‰å…¨** | `éœ€æ‰‹åŠ¨æŒ‡å®š` | `è‡ªåŠ¨ç±»å‹è½¬æ¢` |
| ğŸ”¸ **IDEæ”¯æŒ** | `æ— æç¤º` | `æœ‰æç¤ºå’Œæ ¡éªŒ` |
| ğŸ”¸ **åµŒå¥—é…ç½®** | `ä¸æ”¯æŒ` | `æ”¯æŒå¯¹è±¡åµŒå¥—` |
| ğŸ”¸ **æ¾æ•£ç»‘å®š** | `ä¸æ”¯æŒ` | `æ”¯æŒå¤šç§æ ¼å¼` |
| ğŸ”¸ **éªŒè¯æ”¯æŒ** | `éœ€æ‰‹åŠ¨` | `æ”¯æŒ@Validated` |

**æ¾æ•£ç»‘å®šç¤ºä¾‹**ï¼ˆ@ConfigurationPropertiesæ”¯æŒï¼‰ï¼š
```properties
# ä»¥ä¸‹å››ç§å†™æ³•éƒ½èƒ½ç»‘å®šåˆ°maxUserså­—æ®µ
app.max-users=100        # æ¨èï¼ˆkebab-caseï¼‰
app.maxUsers=100         # é©¼å³°å‘½å
app.max_users=100        # ä¸‹åˆ’çº¿
APP_MAX_USERS=100        # ç¯å¢ƒå˜é‡æ ¼å¼
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å¤–éƒ¨åŒ–é…ç½®ï¼šå°†å¯å˜é…ç½®ä»ä»£ç ä¸­åˆ†ç¦»ï¼Œæ”¯æŒç¯å¢ƒé€‚é…
ğŸ”¸ Environmentï¼šSpringçš„é…ç½®ç®¡ç†ä¸­å¿ƒï¼Œç»Ÿä¸€ç®¡ç†æ‰€æœ‰é…ç½®æº
ğŸ”¸ @PropertySourceï¼šåŠ è½½è‡ªå®šä¹‰é…ç½®æ–‡ä»¶åˆ°Environment
ğŸ”¸ PropertySourcesPlaceholderConfigurerï¼šå ä½ç¬¦è§£æçš„æ ¸å¿ƒé…ç½®å™¨
ğŸ”¸ å ä½ç¬¦è¯­æ³•ï¼š${key:default}ï¼Œæ”¯æŒé»˜è®¤å€¼å’ŒåµŒå¥—
ğŸ”¸ é…ç½®ä¼˜å…ˆçº§ï¼šå‘½ä»¤è¡Œ > ç³»ç»Ÿå±æ€§ > ç¯å¢ƒå˜é‡ > é…ç½®æ–‡ä»¶
ğŸ”¸ å±æ€§è§£æï¼šä»é…ç½®æºåˆ°Beanå±æ€§çš„å®Œæ•´è½¬æ¢è¿‡ç¨‹
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆéœ€è¦å¤–éƒ¨åŒ–é…ç½®**
```
æ ¸å¿ƒä»·å€¼ï¼š
- åŒä¸€å¥—ä»£ç é€‚åº”å¤šç¯å¢ƒï¼ˆå¼€å‘/æµ‹è¯•/ç”Ÿäº§ï¼‰
- é…ç½®å˜æ›´æ— éœ€é‡æ–°ç¼–è¯‘æ‰“åŒ…
- æ•æ„Ÿä¿¡æ¯ç‹¬ç«‹ç®¡ç†ï¼Œæé«˜å®‰å…¨æ€§

å®é™…åœºæ™¯ï¼š
å¼€å‘ç¯å¢ƒï¼šä½¿ç”¨æœ¬åœ°æ•°æ®åº“
æµ‹è¯•ç¯å¢ƒï¼šä½¿ç”¨æµ‹è¯•æ•°æ®åº“
ç”Ÿäº§ç¯å¢ƒï¼šä½¿ç”¨ç”Ÿäº§æ•°æ®åº“
â†’ åªéœ€ä¿®æ”¹é…ç½®ï¼Œä»£ç å®Œå…¨ä¸å˜
```

**ğŸ”¹ é…ç½®æ–‡ä»¶ vs @PropertySource**
```
é€‰æ‹©åŸåˆ™ï¼š
application.yml/propertiesï¼š
âœ… åº”ç”¨ä¸»é…ç½®
âœ… éœ€è¦Profileæ”¯æŒ
âœ… éœ€è¦IDEæ™ºèƒ½æç¤º

@PropertySourceï¼š
âœ… æ¨¡å—åŒ–é…ç½®ç®¡ç†
âœ… ç¬¬ä¸‰æ–¹ç»„ä»¶ç‹¬ç«‹é…ç½®
âœ… é…ç½®æ–‡ä»¶ä½ç½®çµæ´»

å®è·µå»ºè®®ï¼š
- ä¼˜å…ˆä½¿ç”¨application.yml
- å¤æ‚é¡¹ç›®å¯ä»¥é…åˆ@PropertySourceæ¨¡å—åŒ–
- ä¸¤è€…å¯ä»¥å…±å­˜ï¼Œæ³¨æ„ä¼˜å…ˆçº§
```

**ğŸ”¹ å ä½ç¬¦è§£æçš„å·¥ä½œåŸç†**
```
ç†è§£è¦ç‚¹ï¼š
1. å ä½ç¬¦åªæ˜¯"å¼•ç”¨ç¬¦å·"ï¼Œä¸æ˜¯å®é™…å€¼
2. è§£ææ—¶æœºï¼šBeanåˆ›å»ºæ—¶
3. è§£æé¡ºåºï¼šæŒ‰é…ç½®æºä¼˜å…ˆçº§æŸ¥æ‰¾
4. ç±»å‹è½¬æ¢ï¼šè‡ªåŠ¨å®Œæˆå­—ç¬¦ä¸²åˆ°ç›®æ ‡ç±»å‹çš„è½¬æ¢

å¸¸è§è¯¯åŒºï¼š
âŒ ä»¥ä¸ºå ä½ç¬¦åœ¨é…ç½®æ–‡ä»¶ä¸­å°±è¢«è§£æäº†
   å®é™…ï¼šåœ¨Beanæ³¨å…¥æ—¶æ‰è§£æ
   
âŒ ä»¥ä¸ºæ‰€æœ‰ç±»å‹éƒ½èƒ½è‡ªåŠ¨è½¬æ¢
   å®é™…ï¼šéœ€è¦æ³¨å†Œå¯¹åº”çš„Converter
```

**ğŸ”¹ é…ç½®ä¼˜å…ˆçº§çš„å®é™…åº”ç”¨**
```
ç­–ç•¥åˆ†å±‚ï¼š
1. åŸºç¡€é…ç½®ï¼ˆapplication.ymlï¼‰
   - æ‰€æœ‰ç¯å¢ƒé€šç”¨çš„é»˜è®¤é…ç½®
   
2. ç¯å¢ƒé…ç½®ï¼ˆapplication-{profile}.ymlï¼‰
   - ç‰¹å®šç¯å¢ƒçš„é…ç½®è¦†ç›–
   
3. å¤–éƒ¨é…ç½®ï¼ˆè¿è¡Œæ—¶æä¾›ï¼‰
   - æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç ã€å¯†é’¥ï¼‰
   - ç¯å¢ƒç›¸å…³çš„åŠ¨æ€é…ç½®
   
4. å‘½ä»¤è¡Œå‚æ•°ï¼ˆä¸´æ—¶è°ƒæ•´ï¼‰
   - å¿«é€Ÿè°ƒè¯•å’Œé—®é¢˜å®šä½

å¥½å¤„ï¼š
âœ… é…ç½®ç®¡ç†æ¸…æ™°æœ‰åº
âœ… æ•æ„Ÿä¿¡æ¯ä¸æäº¤ä»£ç åº“
âœ… æ”¯æŒçµæ´»çš„é…ç½®è¦†ç›–
```

### 8.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ ä¼ä¸šçº§åº”ç”¨åœºæ™¯**
- **å¾®æœåŠ¡æ¶æ„**ï¼šç»Ÿä¸€é…ç½®ä¸­å¿ƒç®¡ç†ï¼ŒåŠ¨æ€é…ç½®ä¸‹å‘
- **å®¹å™¨åŒ–éƒ¨ç½²**ï¼šé€šè¿‡ç¯å¢ƒå˜é‡å’ŒConfigMapæ³¨å…¥é…ç½®
- **å¤šç¯å¢ƒç®¡ç†**ï¼šå¼€å‘ã€æµ‹è¯•ã€é¢„å‘ã€ç”Ÿäº§ç¯å¢ƒé…ç½®éš”ç¦»
- **é…ç½®åŠ å¯†**ï¼šæ•æ„Ÿé…ç½®åŠ å¯†å­˜å‚¨ï¼Œè¿è¡Œæ—¶è§£å¯†

**ğŸ”§ æœ€ä½³å®è·µå»ºè®®**
- **é…ç½®åˆ†å±‚ç®¡ç†**ï¼šé€šç”¨é…ç½® â†’ ç¯å¢ƒé…ç½® â†’ å¤–éƒ¨é…ç½®
- **æ•æ„Ÿä¿¡æ¯ä¿æŠ¤**ï¼šå¯†ç ã€å¯†é’¥ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–åŠ å¯†é…ç½®
- **é…ç½®æ–‡æ¡£åŒ–**ï¼šä¸ºé‡è¦é…ç½®æ·»åŠ æ³¨é‡Šè¯´æ˜
- **é…ç½®éªŒè¯**ï¼šä½¿ç”¨@Validatedæ ¡éªŒé…ç½®çš„åˆæ³•æ€§

**ğŸ“ˆ å­¦ä¹ è·¯å¾„å»ºè®®**
```
å…¥é—¨é˜¶æ®µï¼š
1. æŒæ¡application.properties/ymlåŸºç¡€ç”¨æ³•
2. ç†è§£@Valueæ³¨å…¥é…ç½®
3. å­¦ä¼šä½¿ç”¨Profileåˆ‡æ¢ç¯å¢ƒ

è¿›é˜¶é˜¶æ®µï¼š
4. æ·±å…¥ç†è§£Environmentå’ŒPropertySource
5. æŒæ¡@ConfigurationPropertiesæ‰¹é‡ç»‘å®š
6. ç†è§£é…ç½®ä¼˜å…ˆçº§å’Œè¦†ç›–æœºåˆ¶

é«˜çº§é˜¶æ®µï¼š
7. è‡ªå®šä¹‰PropertySourceå®ç°
8. é›†æˆé…ç½®ä¸­å¿ƒï¼ˆå¦‚Apolloã€Nacosï¼‰
9. å®ç°é…ç½®åŠ å¯†å’ŒåŠ¨æ€åˆ·æ–°
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- å¤–éƒ¨åŒ–é…ç½®è®©åº”ç”¨é€‚åº”å¤šç¯å¢ƒï¼Œé…ç½®ä¸ä»£ç åˆ†ç¦»
- Environmentæ˜¯é…ç½®ç®¡ç†ä¸­å¿ƒï¼ŒPropertySourceæ˜¯é…ç½®æ¥æº
- å ä½ç¬¦${}å®ç°é…ç½®å¼•ç”¨ï¼Œæ”¯æŒé»˜è®¤å€¼å’ŒåµŒå¥—
- é…ç½®ä¼˜å…ˆçº§å†³å®šæœ€ç»ˆç”Ÿæ•ˆå€¼ï¼Œå‘½ä»¤è¡Œä¼˜å…ˆçº§æœ€é«˜
- @Valueé€‚åˆå°‘é‡é…ç½®ï¼Œ@ConfigurationPropertiesé€‚åˆæ‰¹é‡ç»‘å®š