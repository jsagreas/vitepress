---
title: 6ã€é€šçŸ¥ç±»å‹è¯¦è§£
---
## ğŸ“š ç›®å½•

1. [é€šçŸ¥ï¼ˆAdviceï¼‰æ˜¯ä»€ä¹ˆ](#1-é€šçŸ¥adviceæ˜¯ä»€ä¹ˆ)
2. [å‰ç½®é€šçŸ¥Before](#2-å‰ç½®é€šçŸ¥before)
3. [åç½®é€šçŸ¥After](#3-åç½®é€šçŸ¥after)
4. [è¿”å›é€šçŸ¥AfterReturning](#4-è¿”å›é€šçŸ¥afterreturning)
5. [å¼‚å¸¸é€šçŸ¥AfterThrowing](#5-å¼‚å¸¸é€šçŸ¥afterthrowing)
6. [ç¯ç»•é€šçŸ¥Around](#6-ç¯ç»•é€šçŸ¥around)
7. [é€šçŸ¥ç±»å‹å¯¹æ¯”ä¸é€‰æ‹©](#7-é€šçŸ¥ç±»å‹å¯¹æ¯”ä¸é€‰æ‹©)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ é€šçŸ¥ï¼ˆAdviceï¼‰æ˜¯ä»€ä¹ˆ


### 1.1 é€šä¿—ç†è§£é€šçŸ¥


ğŸ¤” **æ¢å¥è¯è¯´**ï¼šé€šçŸ¥å°±æ˜¯"ä½ æƒ³åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œçš„ä¸åŒæ—¶æœºï¼Œæ’å…¥æ‰§è¡Œçš„é¢å¤–ä»£ç "

```
æƒ³è±¡ä¸€ä¸‹çœ‹ç”µå½±ï¼š
ç›®æ ‡æ–¹æ³• = ç”µå½±æ­£ç‰‡

å‰ç½®é€šçŸ¥ = å¼€åœºå‰çš„å¹¿å‘Š
åç½®é€šçŸ¥ = æ•£åœºåçš„å½©è›‹
è¿”å›é€šçŸ¥ = ç”µå½±æ­£å¸¸ç»“æŸçš„ç‰‡å°¾æ›²
å¼‚å¸¸é€šçŸ¥ = ç”µå½±æ”¾æ˜ æ•…éšœçš„åº”æ€¥å¤„ç†
ç¯ç»•é€šçŸ¥ = åŒ…åœºï¼Œä½ æ§åˆ¶æ•´ä¸ªè§‚å½±æµç¨‹
```

### 1.2 é€šçŸ¥çš„æœ¬è´¨ä½œç”¨


**ğŸ·ï¸ ä¸“ä¸šæœ¯è¯­**ï¼š
- `Adviceï¼ˆé€šçŸ¥ï¼‰` = åˆ‡é¢åœ¨ç‰¹å®šè¿æ¥ç‚¹æ‰§è¡Œçš„åŠ¨ä½œ
- `Join Pointï¼ˆè¿æ¥ç‚¹ï¼‰` = æ–¹æ³•æ‰§è¡Œçš„æŸä¸ªæ—¶åˆ»
- `Pointcutï¼ˆåˆ‡ç‚¹ï¼‰` = å®šä¹‰åœ¨å“ªäº›æ–¹æ³•ä¸Šåº”ç”¨é€šçŸ¥

ğŸ’¡ **æ ¸å¿ƒç†è§£**ï¼š
- é€šçŸ¥ä¸æ˜¯ä¿®æ”¹åŸæ–¹æ³•ï¼Œè€Œæ˜¯åœ¨åŸæ–¹æ³•æ‰§è¡Œçš„ä¸åŒé˜¶æ®µ"æ’å…¥"æ–°åŠŸèƒ½
- é€šçŸ¥è®©ä½ èƒ½åœ¨ä¸æ”¹åŠ¨åŸä»£ç çš„æƒ…å†µä¸‹ï¼Œç»™æ–¹æ³•å¢åŠ é¢å¤–èƒ½åŠ›
- å°±åƒç»™æ±½è½¦åŠ è£…è¡Œè½¦è®°å½•ä»ªï¼Œä¸æ”¹å˜æ±½è½¦æœ¬èº«ï¼Œä½†å¢åŠ äº†è®°å½•åŠŸèƒ½

### 1.3 é€šçŸ¥çš„æ‰§è¡Œæ—¶æœº


```
æ–¹æ³•æ‰§è¡Œçš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸï¼š

å¼€å§‹
 â†“
[å‰ç½®é€šçŸ¥] â† æ–¹æ³•æ‰§è¡Œå‰
 â†“
ç›®æ ‡æ–¹æ³•æ‰§è¡Œ
 â†“
â”œâ”€ æ­£å¸¸è¿”å› â†’ [è¿”å›é€šçŸ¥] â† æ–¹æ³•æˆåŠŸæ‰§è¡Œå
â”‚
â”œâ”€ æŠ›å‡ºå¼‚å¸¸ â†’ [å¼‚å¸¸é€šçŸ¥] â† æ–¹æ³•å‡ºé”™å
 â†“
[åç½®é€šçŸ¥] â† æ— è®ºæˆåŠŸå¤±è´¥éƒ½æ‰§è¡Œ
 â†“
ç»“æŸ

ç‰¹æ®Šçš„ç¯ç»•é€šçŸ¥ï¼š
[ç¯ç»•é€šçŸ¥å¼€å§‹]
    â†“
  ç›®æ ‡æ–¹æ³•
    â†“
[ç¯ç»•é€šçŸ¥ç»“æŸ]
(å®Œå…¨æ§åˆ¶æ–¹æ³•æ‰§è¡Œ)
```

---

## 2. ğŸš€ å‰ç½®é€šçŸ¥Before


### 2.1 ä»€ä¹ˆæ˜¯å‰ç½®é€šçŸ¥


**ğŸ” æ·±å…¥ç†è§£**ï¼šåœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œ**ä¹‹å‰**è¿è¡Œçš„é€šçŸ¥

ğŸŒ° **ä¸¾ä¸ªä¾‹å­**ï¼š
- è¿›å…¥ç”µå½±é™¢å‰çš„å®‰æ£€
- ç™»å½•ç³»ç»Ÿå‰çš„èº«ä»½éªŒè¯
- è½¬è´¦å‰çš„ä½™é¢æ£€æŸ¥
- è®¿é—®æ•°æ®å‰çš„æƒé™æ ¡éªŒ

### 2.2 å‰ç½®é€šçŸ¥çš„ä½¿ç”¨


```java
@Aspect
@Component
public class BeforeAdviceExample {
    
    // åŸºæœ¬ä½¿ç”¨
    @Before("execution(* com.example.service.*.*(..))")
    public void beforeMethod(JoinPoint joinPoint) {
        String methodName = joinPoint.getSignature().getName();
        System.out.println("å‡†å¤‡æ‰§è¡Œæ–¹æ³•: " + methodName);
    }
    
    // è·å–æ–¹æ³•å‚æ•°
    @Before("execution(* com.example.service.UserService.login(..))")
    public void beforeLogin(JoinPoint joinPoint) {
        Object[] args = joinPoint.getArgs();
        System.out.println("ç”¨æˆ·å°è¯•ç™»å½•ï¼Œç”¨æˆ·å: " + args[0]);
    }
}
```

**ğŸ“‹ çŸ¥è¯†æ¸…å•**ï¼š
- âœ… å¯ä»¥è·å–ç›®æ ‡æ–¹æ³•çš„å‚æ•°
- âœ… å¯ä»¥è·å–ç›®æ ‡æ–¹æ³•çš„åç§°å’Œç±»ä¿¡æ¯
- âŒ ä¸èƒ½ä¿®æ”¹æ–¹æ³•çš„å‚æ•°å€¼ï¼ˆåªè¯»ï¼‰
- âŒ ä¸èƒ½é˜»æ­¢æ–¹æ³•æ‰§è¡Œï¼ˆé™¤éæŠ›å¼‚å¸¸ï¼‰

### 2.3 å®é™…åº”ç”¨åœºæ™¯


**ğŸ¢ å®é™…åº”ç”¨**ï¼š

| åœºæ™¯ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **æ—¥å¿—è®°å½•** | è®°å½•æ–¹æ³•è°ƒç”¨ä¿¡æ¯ | è®°å½•ç”¨æˆ·è®¿é—®æ—¥å¿— |
| **æƒé™æ£€æŸ¥** | éªŒè¯ç”¨æˆ·æƒé™ | æ£€æŸ¥æ˜¯å¦æœ‰æ“ä½œæƒé™ |
| **å‚æ•°éªŒè¯** | æ£€æŸ¥è¾“å…¥å‚æ•° | éªŒè¯å‚æ•°æ˜¯å¦åˆæ³• |
| **æ€§èƒ½ç›‘æ§** | è®°å½•å¼€å§‹æ—¶é—´ | ç»Ÿè®¡æ–¹æ³•æ‰§è¡Œæ—¶é•¿ |

```java
// å®æˆ˜ç¤ºä¾‹ï¼šæƒé™æ£€æŸ¥
@Before("@annotation(requiresPermission)")
public void checkPermission(JoinPoint joinPoint, RequiresPermission requiresPermission) {
    String permission = requiresPermission.value();
    // æ£€æŸ¥å½“å‰ç”¨æˆ·æ˜¯å¦æœ‰è¯¥æƒé™
    if (!currentUser.hasPermission(permission)) {
        throw new SecurityException("æ²¡æœ‰æƒé™: " + permission);
    }
}
```

---

## 3. ğŸ”š åç½®é€šçŸ¥After


### 3.1 ä»€ä¹ˆæ˜¯åç½®é€šçŸ¥


**ğŸ” æ·±å…¥ç†è§£**ï¼šåœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œ**ä¹‹å**è¿è¡Œçš„é€šçŸ¥ï¼Œæ— è®ºæ–¹æ³•æˆåŠŸè¿˜æ˜¯å¤±è´¥

ğŸ’­ **æ€è€ƒä¸€ä¸‹**ï¼šä¸ºä»€ä¹ˆå«Afterè€Œä¸æ˜¯AfterSuccessï¼Ÿ
â†’ å› ä¸ºå®ƒåœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¼šæ‰§è¡Œï¼Œå°±åƒJavaçš„finallyå—

ğŸŒ° **ä¸¾ä¸ªä¾‹å­**ï¼š
- å…³é—­æ‰“å¼€çš„æ–‡ä»¶ï¼ˆæ— è®ºè¯»å–æˆåŠŸä¸å¦ï¼‰
- é‡Šæ”¾å ç”¨çš„èµ„æºï¼ˆæ— è®ºä¸šåŠ¡æ˜¯å¦æˆåŠŸï¼‰
- è®°å½•æ–¹æ³•æ‰§è¡Œç»“æŸï¼ˆæ— è®ºç»“æœå¦‚ä½•ï¼‰

### 3.2 åç½®é€šçŸ¥çš„ä½¿ç”¨


```java
@Aspect
@Component
public class AfterAdviceExample {
    
    // åŸºæœ¬ä½¿ç”¨
    @After("execution(* com.example.service.*.*(..))")
    public void afterMethod(JoinPoint joinPoint) {
        System.out.println("æ–¹æ³•æ‰§è¡Œå®Œæ¯•: " + joinPoint.getSignature().getName());
    }
    
    // èµ„æºæ¸…ç†ç¤ºä¾‹
    @After("execution(* com.example.service.FileService.*(..))")
    public void cleanUp() {
        // æ¸…ç†ä¸´æ—¶èµ„æº
        System.out.println("æ¸…ç†ä¸´æ—¶æ–‡ä»¶...");
    }
}
```

**âš ï¸ é‡è¦æé†’**ï¼š
- åç½®é€šçŸ¥**æ— æ³•è·å–**æ–¹æ³•çš„è¿”å›å€¼
- åç½®é€šçŸ¥**æ— æ³•åˆ¤æ–­**æ–¹æ³•æ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥
- å¦‚æœéœ€è¦è¿™äº›ä¿¡æ¯ï¼Œåº”è¯¥ä½¿ç”¨è¿”å›é€šçŸ¥æˆ–å¼‚å¸¸é€šçŸ¥

### 3.3 æ‰§è¡Œæ—¶æœºè¯´æ˜


```
æ–¹æ³•æ­£å¸¸æ‰§è¡Œï¼š
ç›®æ ‡æ–¹æ³• â†’ è¿”å›é€šçŸ¥ â†’ åç½®é€šçŸ¥

æ–¹æ³•å¼‚å¸¸æ‰§è¡Œï¼š
ç›®æ ‡æ–¹æ³• â†’ å¼‚å¸¸é€šçŸ¥ â†’ åç½®é€šçŸ¥

å…³é”®ç‚¹ï¼šåç½®é€šçŸ¥æ€»æ˜¯æœ€åæ‰§è¡Œï¼
```

---

## 4. âœ… è¿”å›é€šçŸ¥AfterReturning


### 4.1 ä»€ä¹ˆæ˜¯è¿”å›é€šçŸ¥


**ğŸ” æ·±å…¥ç†è§£**ï¼šåœ¨ç›®æ ‡æ–¹æ³•**æˆåŠŸæ‰§è¡Œå¹¶è¿”å›ç»“æœå**è¿è¡Œçš„é€šçŸ¥

ğŸ·ï¸ **ä¸“ä¸šæœ¯è¯­**ï¼š`AfterReturning` = æ–¹æ³•æ­£å¸¸è¿”å›æ—¶æ‰§è¡Œçš„é€šçŸ¥

ğŸŒ° **ä¸¾ä¸ªä¾‹å­**ï¼š
- è®¢å•æ”¯ä»˜æˆåŠŸåå‘é€ç¡®è®¤çŸ­ä¿¡
- æ•°æ®ä¿å­˜æˆåŠŸåæ›´æ–°ç¼“å­˜
- æ–‡ä»¶ä¸Šä¼ æˆåŠŸåç”Ÿæˆç¼©ç•¥å›¾

### 4.2 è¿”å›é€šçŸ¥çš„ä½¿ç”¨


```java
@Aspect
@Component
public class AfterReturningAdviceExample {
    
    // åŸºæœ¬ä½¿ç”¨ - è·å–è¿”å›å€¼
    @AfterReturning(
        pointcut = "execution(* com.example.service.UserService.findUser(..))",
        returning = "result"  // æŒ‡å®šè¿”å›å€¼çš„å‚æ•°å
    )
    public void afterReturning(JoinPoint joinPoint, Object result) {
        System.out.println("æ–¹æ³•è¿”å›å€¼: " + result);
    }
    
    // æŒ‡å®šè¿”å›å€¼ç±»å‹
    @AfterReturning(
        pointcut = "execution(* com.example.service.*.save*(..))",
        returning = "user"
    )
    public void afterSaveUser(User user) {
        System.out.println("ä¿å­˜æˆåŠŸï¼Œç”¨æˆ·ID: " + user.getId());
        // æ›´æ–°ç¼“å­˜
        cache.put(user.getId(), user);
    }
}
```

**ğŸ“‹ çŸ¥è¯†æ¸…å•**ï¼š
- âœ… å¯ä»¥è·å–æ–¹æ³•çš„è¿”å›å€¼
- âœ… å¯ä»¥å¯¹è¿”å›å€¼è¿›è¡Œåç»­å¤„ç†
- âœ… åªåœ¨æ–¹æ³•æ­£å¸¸è¿”å›æ—¶æ‰§è¡Œ
- âŒ ä¸èƒ½ä¿®æ”¹è¿”å›å€¼ï¼ˆåªè¯»è®¿é—®ï¼‰
- âŒ æ–¹æ³•æŠ›å¼‚å¸¸æ—¶ä¸ä¼šæ‰§è¡Œ

### 4.3 å®é™…åº”ç”¨åœºæ™¯


**ğŸ› ï¸ å·¥å…·æ¨è**ï¼š

```java
// åœºæ™¯1ï¼šç¼“å­˜æ›´æ–°
@AfterReturning(
    pointcut = "execution(* com.example.service.*Service.update*(..))",
    returning = "result"
)
public void updateCache(Object result) {
    if (result != null) {
        cacheService.refresh(result);
    }
}

// åœºæ™¯2ï¼šæ“ä½œæ—¥å¿—è®°å½•
@AfterReturning(
    pointcut = "@annotation(logOperation)",
    returning = "result"
)
public void logOperation(JoinPoint joinPoint, LogOperation logOperation, Object result) {
    String operation = logOperation.value();
    operationLogService.save(operation, "æˆåŠŸ", result);
}

// åœºæ™¯3ï¼šæ¶ˆæ¯é€šçŸ¥
@AfterReturning(
    pointcut = "execution(* com.example.service.OrderService.createOrder(..))",
    returning = "order"
)
public void notifyOrderCreated(Order order) {
    messageService.sendOrderConfirmation(order);
}
```

---

## 5. âŒ å¼‚å¸¸é€šçŸ¥AfterThrowing


### 5.1 ä»€ä¹ˆæ˜¯å¼‚å¸¸é€šçŸ¥


**ğŸ” æ·±å…¥ç†è§£**ï¼šåœ¨ç›®æ ‡æ–¹æ³•**æŠ›å‡ºå¼‚å¸¸æ—¶**è¿è¡Œçš„é€šçŸ¥

ğŸ’­ **æ€è€ƒä¸€ä¸‹**ï¼šä»€ä¹ˆæ—¶å€™ä¼šæ‰§è¡Œå¼‚å¸¸é€šçŸ¥ï¼Ÿ
â†’ åªæœ‰å½“æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼ˆè€Œä¸æ˜¯æ­£å¸¸è¿”å›ï¼‰æ—¶æ‰ä¼šæ‰§è¡Œ

ğŸŒ° **ä¸¾ä¸ªä¾‹å­**ï¼š
- è½¬è´¦å¤±è´¥æ—¶è®°å½•é”™è¯¯æ—¥å¿—
- æ•°æ®åº“æ“ä½œå¤±è´¥æ—¶å‘é€å‘Šè­¦
- ä¸šåŠ¡å¼‚å¸¸æ—¶å›æ»šæŸäº›æ“ä½œ

### 5.2 å¼‚å¸¸é€šçŸ¥çš„ä½¿ç”¨


```java
@Aspect
@Component
public class AfterThrowingAdviceExample {
    
    // åŸºæœ¬ä½¿ç”¨ - æ•è·ä»»ä½•å¼‚å¸¸
    @AfterThrowing(
        pointcut = "execution(* com.example.service.*.*(..))",
        throwing = "ex"  // æŒ‡å®šå¼‚å¸¸çš„å‚æ•°å
    )
    public void afterThrowing(JoinPoint joinPoint, Exception ex) {
        String methodName = joinPoint.getSignature().getName();
        System.out.println("æ–¹æ³• " + methodName + " æŠ›å‡ºå¼‚å¸¸: " + ex.getMessage());
    }
    
    // æ•è·ç‰¹å®šç±»å‹çš„å¼‚å¸¸
    @AfterThrowing(
        pointcut = "execution(* com.example.service.*.*(..))",
        throwing = "ex"
    )
    public void handleBusinessException(JoinPoint joinPoint, BusinessException ex) {
        // åªå¤„ç†BusinessExceptionåŠå…¶å­ç±»
        System.out.println("ä¸šåŠ¡å¼‚å¸¸: " + ex.getErrorCode());
    }
}
```

**ğŸ“‹ çŸ¥è¯†æ¸…å•**ï¼š
- âœ… å¯ä»¥è·å–æŠ›å‡ºçš„å¼‚å¸¸å¯¹è±¡
- âœ… å¯ä»¥æŒ‡å®šæ•è·çš„å¼‚å¸¸ç±»å‹
- âœ… å¯ä»¥è®°å½•å¼‚å¸¸ä¿¡æ¯æˆ–å‘é€å‘Šè­¦
- âŒ ä¸èƒ½é˜»æ­¢å¼‚å¸¸ç»§ç»­æŠ›å‡º
- âŒ ä¸èƒ½ä¿®æ”¹å¼‚å¸¸ç±»å‹æˆ–ä¿¡æ¯

### 5.3 å®é™…åº”ç”¨åœºæ™¯


**ğŸ¢ å®é™…åº”ç”¨**ï¼š

```java
// åœºæ™¯1ï¼šå¼‚å¸¸æ—¥å¿—è®°å½•
@AfterThrowing(
    pointcut = "execution(* com.example.service.*.*(..))",
    throwing = "ex"
)
public void logException(JoinPoint joinPoint, Exception ex) {
    String className = joinPoint.getTarget().getClass().getName();
    String methodName = joinPoint.getSignature().getName();
    
    logger.error("å¼‚å¸¸å‘ç”Ÿåœ¨ {}.{}: {}", 
        className, methodName, ex.getMessage(), ex);
}

// åœºæ™¯2ï¼šå¼‚å¸¸å‘Šè­¦é€šçŸ¥
@AfterThrowing(
    pointcut = "execution(* com.example.service.PaymentService.*(..))",
    throwing = "ex"
)
public void alertOnPaymentError(JoinPoint joinPoint, Exception ex) {
    // æ”¯ä»˜å¼‚å¸¸ç«‹å³å‘Šè­¦
    alertService.sendAlert("æ”¯ä»˜å¼‚å¸¸", ex.getMessage());
}

// åœºæ™¯3ï¼šå¼‚å¸¸ç»Ÿè®¡
@AfterThrowing(
    pointcut = "execution(* com.example..*(..))",
    throwing = "ex"
)
public void countException(Exception ex) {
    metrics.increment("exception." + ex.getClass().getSimpleName());
}
```

**ğŸš¨ é‡è¦æé†’**ï¼š
- å¼‚å¸¸é€šçŸ¥ä¸ä¼š"åƒæ‰"å¼‚å¸¸ï¼Œå¼‚å¸¸ä»ä¼šç»§ç»­å‘ä¸ŠæŠ›å‡º
- å¦‚æœéœ€è¦å¤„ç†å¼‚å¸¸å¹¶é˜»æ­¢æŠ›å‡ºï¼Œåº”è¯¥ç”¨ç¯ç»•é€šçŸ¥
- å¼‚å¸¸é€šçŸ¥é€‚åˆåšè®°å½•ã€å‘Šè­¦ç­‰è¾…åŠ©æ“ä½œ

---

## 6. ğŸ”„ ç¯ç»•é€šçŸ¥Around


### 6.1 ä»€ä¹ˆæ˜¯ç¯ç»•é€šçŸ¥


**ğŸ” æ·±å…¥ç†è§£**ï¼šç¯ç»•é€šçŸ¥æ˜¯**æœ€å¼ºå¤§**çš„é€šçŸ¥ç±»å‹ï¼Œå®ƒå¯ä»¥å®Œå…¨æ§åˆ¶ç›®æ ‡æ–¹æ³•çš„æ‰§è¡Œ

ğŸ·ï¸ **ä¸“ä¸šæœ¯è¯­**ï¼š
- `Around` = åŒ…å›´ç›®æ ‡æ–¹æ³•æ‰§è¡Œçš„é€šçŸ¥
- `ProceedingJoinPoint` = å¯ä»¥æ§åˆ¶æ–¹æ³•æ‰§è¡Œçš„è¿æ¥ç‚¹

ğŸ’¡ **æ ¸å¿ƒç†è§£**ï¼š
- ç¯ç»•é€šçŸ¥å°±åƒä¸€ä¸ª"ä»£ç†ç®¡å®¶"ï¼Œå®Œå…¨æ§åˆ¶ç›®æ ‡æ–¹æ³•
- å¯ä»¥å†³å®šæ˜¯å¦æ‰§è¡Œç›®æ ‡æ–¹æ³•
- å¯ä»¥åœ¨æ‰§è¡Œå‰ååšä»»ä½•æ“ä½œ
- å¯ä»¥ä¿®æ”¹å‚æ•°å’Œè¿”å›å€¼

```
å…¶ä»–é€šçŸ¥ï¼š
Before â†’ [ç›®æ ‡æ–¹æ³•] â†’ After
      (åªèƒ½åœ¨å‰åæ’å…¥ä»£ç )

ç¯ç»•é€šçŸ¥ï¼š
Around {
    // æ‰§è¡Œå‰çš„é€»è¾‘
    result = ç›®æ ‡æ–¹æ³•.execute()
    // æ‰§è¡Œåçš„é€»è¾‘
    return result
}
(å®Œå…¨æ§åˆ¶æ•´ä¸ªè¿‡ç¨‹)
```

### 6.2 ç¯ç»•é€šçŸ¥çš„ä½¿ç”¨


```java
@Aspect
@Component
public class AroundAdviceExample {
    
    // åŸºæœ¬ä½¿ç”¨
    @Around("execution(* com.example.service.*.*(..))")
    public Object aroundMethod(ProceedingJoinPoint pjp) throws Throwable {
        System.out.println("æ–¹æ³•æ‰§è¡Œå‰...");
        
        // æ‰§è¡Œç›®æ ‡æ–¹æ³•
        Object result = pjp.proceed();
        
        System.out.println("æ–¹æ³•æ‰§è¡Œå...");
        return result;
    }
    
    // ä¿®æ”¹å‚æ•°
    @Around("execution(* com.example.service.*.processData(..))")
    public Object modifyArgs(ProceedingJoinPoint pjp) throws Throwable {
        Object[] args = pjp.getArgs();
        // ä¿®æ”¹å‚æ•°
        args[0] = ((String) args[0]).toUpperCase();
        // ç”¨ä¿®æ”¹åçš„å‚æ•°æ‰§è¡Œæ–¹æ³•
        return pjp.proceed(args);
    }
    
    // ä¿®æ”¹è¿”å›å€¼
    @Around("execution(* com.example.service.*.getData(..))")
    public Object modifyResult(ProceedingJoinPoint pjp) throws Throwable {
        Object result = pjp.proceed();
        // å¯¹è¿”å›å€¼è¿›è¡ŒåŒ…è£…æˆ–ä¿®æ”¹
        return new ResultWrapper(result);
    }
}
```

### 6.3 ProceedingJoinPointè¯¦è§£


**ğŸ”‘ å…³é”®å¯¹è±¡**ï¼š`ProceedingJoinPoint` æ˜¯ç¯ç»•é€šçŸ¥çš„æ ¸å¿ƒ

```java
@Around("execution(* com.example.service.*.*(..))")
public Object around(ProceedingJoinPoint pjp) throws Throwable {
    
    // 1. è·å–æ–¹æ³•ä¿¡æ¯
    String methodName = pjp.getSignature().getName();
    String className = pjp.getTarget().getClass().getName();
    
    // 2. è·å–å‚æ•°
    Object[] args = pjp.getArgs();
    
    // 3. æ‰§è¡Œç›®æ ‡æ–¹æ³•ï¼ˆå¿…é¡»è°ƒç”¨ï¼Œå¦åˆ™ç›®æ ‡æ–¹æ³•ä¸ä¼šæ‰§è¡Œï¼‰
    Object result = pjp.proceed();  // ä½¿ç”¨åŸå§‹å‚æ•°
    // æˆ–
    Object result = pjp.proceed(args);  // ä½¿ç”¨ä¿®æ”¹åçš„å‚æ•°
    
    return result;
}
```

**ğŸ“‹ çŸ¥è¯†æ¸…å•**ï¼š
- âœ… å¿…é¡»æ‰‹åŠ¨è°ƒç”¨ `proceed()` æ‰ä¼šæ‰§è¡Œç›®æ ‡æ–¹æ³•
- âœ… å¯ä»¥ä¸è°ƒç”¨ `proceed()`ï¼Œç›´æ¥è¿”å›å…¶ä»–å€¼
- âœ… å¯ä»¥å¤šæ¬¡è°ƒç”¨ `proceed()`
- âœ… å¯ä»¥æ•è·å¼‚å¸¸å¹¶å¤„ç†
- âœ… å¯ä»¥ä¿®æ”¹å‚æ•°å’Œè¿”å›å€¼

### 6.4 å®é™…åº”ç”¨åœºæ™¯


**ğŸ¢ å®é™…åº”ç”¨**ï¼š

**åœºæ™¯1ï¼šæ€§èƒ½ç›‘æ§**
```java
@Around("execution(* com.example.service.*.*(..))")
public Object measurePerformance(ProceedingJoinPoint pjp) throws Throwable {
    long start = System.currentTimeMillis();
    
    try {
        Object result = pjp.proceed();
        return result;
    } finally {
        long time = System.currentTimeMillis() - start;
        System.out.println(pjp.getSignature() + " æ‰§è¡Œè€—æ—¶: " + time + "ms");
    }
}
```

**åœºæ™¯2ï¼šäº‹åŠ¡æ§åˆ¶**
```java
@Around("@annotation(transactional)")
public Object handleTransaction(ProceedingJoinPoint pjp, Transactional transactional) throws Throwable {
    // å¼€å§‹äº‹åŠ¡
    transactionManager.begin();
    
    try {
        Object result = pjp.proceed();
        // æäº¤äº‹åŠ¡
        transactionManager.commit();
        return result;
    } catch (Exception e) {
        // å›æ»šäº‹åŠ¡
        transactionManager.rollback();
        throw e;
    }
}
```

**åœºæ™¯3ï¼šç¼“å­˜å¤„ç†**
```java
@Around("@annotation(cacheable)")
public Object handleCache(ProceedingJoinPoint pjp, Cacheable cacheable) throws Throwable {
    String key = generateKey(pjp);
    
    // å…ˆæŸ¥ç¼“å­˜
    Object cached = cache.get(key);
    if (cached != null) {
        return cached;
    }
    
    // æ‰§è¡Œæ–¹æ³•
    Object result = pjp.proceed();
    
    // å­˜å…¥ç¼“å­˜
    cache.put(key, result);
    return result;
}
```

**åœºæ™¯4ï¼šé‡è¯•æœºåˆ¶**
```java
@Around("@annotation(retryable)")
public Object retry(ProceedingJoinPoint pjp, Retryable retryable) throws Throwable {
    int maxRetries = retryable.maxRetries();
    int retries = 0;
    
    while (retries < maxRetries) {
        try {
            return pjp.proceed();
        } catch (Exception e) {
            retries++;
            if (retries >= maxRetries) {
                throw e;
            }
            Thread.sleep(retryable.delay());
        }
    }
    return null;
}
```

### 6.5 ç¯ç»•é€šçŸ¥çš„å¼ºå¤§ä¹‹å¤„


**âš¡ å¿«é€Ÿå›é¡¾**ï¼š

| èƒ½åŠ› | è¯´æ˜ | å…¶ä»–é€šçŸ¥èƒ½å¦åšåˆ° |
|------|------|------------------|
| **æ§åˆ¶æ‰§è¡Œ** | å†³å®šæ˜¯å¦æ‰§è¡Œç›®æ ‡æ–¹æ³• | âŒ ä¸èƒ½ |
| **ä¿®æ”¹å‚æ•°** | æ”¹å˜ä¼ å…¥ç›®æ ‡æ–¹æ³•çš„å‚æ•° | âŒ ä¸èƒ½ |
| **ä¿®æ”¹è¿”å›å€¼** | æ”¹å˜æ–¹æ³•çš„è¿”å›ç»“æœ | âŒ ä¸èƒ½ |
| **å¼‚å¸¸å¤„ç†** | æ•è·å¹¶å¤„ç†å¼‚å¸¸ | âŒ ä¸èƒ½é˜»æ­¢å¼‚å¸¸ |
| **å¤šæ¬¡æ‰§è¡Œ** | å¤šæ¬¡è°ƒç”¨ç›®æ ‡æ–¹æ³• | âŒ ä¸èƒ½ |
| **å®Œå…¨æ›¿ä»£** | ä¸æ‰§è¡Œç›®æ ‡æ–¹æ³•ï¼Œè¿”å›å…¶ä»–å€¼ | âŒ ä¸èƒ½ |

**ğŸ¯ æœ€ä½³å®è·µ**ï¼š
- éœ€è¦å®Œå…¨æ§åˆ¶æ–¹æ³•æ‰§è¡Œæ—¶ç”¨ç¯ç»•é€šçŸ¥
- ç®€å•çš„æ—¥å¿—ã€ç›‘æ§ç”¨å‰ç½®/åç½®é€šçŸ¥æ›´æ¸…æ™°
- ç¯ç»•é€šçŸ¥åŠŸèƒ½å¼ºå¤§ä½†ä¹Ÿæ›´å¤æ‚ï¼ŒæŒ‰éœ€é€‰æ‹©

---

## 7. ğŸ“Š é€šçŸ¥ç±»å‹å¯¹æ¯”ä¸é€‰æ‹©


### 7.1 é€šçŸ¥ç±»å‹å¯¹æ¯”è¡¨


| é€šçŸ¥ç±»å‹ | æ‰§è¡Œæ—¶æœº | è·å–è¿”å›å€¼ | è·å–å¼‚å¸¸ | ä¿®æ”¹å‚æ•°/è¿”å›å€¼ | æ§åˆ¶æ‰§è¡Œ | å…¸å‹ç”¨é€” |
|---------|---------|-----------|---------|----------------|---------|---------|
| **@Before** | æ–¹æ³•æ‰§è¡Œå‰ | âŒ | âŒ | âŒ | âŒ | å‚æ•°æ ¡éªŒã€æƒé™æ£€æŸ¥ |
| **@After** | æ–¹æ³•æ‰§è¡Œåï¼ˆæ— è®ºæˆè´¥ï¼‰ | âŒ | âŒ | âŒ | âŒ | èµ„æºæ¸…ç† |
| **@AfterReturning** | æ–¹æ³•æˆåŠŸè¿”å›å | âœ… | âŒ | âŒ | âŒ | ç¼“å­˜æ›´æ–°ã€æ¶ˆæ¯é€šçŸ¥ |
| **@AfterThrowing** | æ–¹æ³•æŠ›å¼‚å¸¸å | âŒ | âœ… | âŒ | âŒ | å¼‚å¸¸æ—¥å¿—ã€å‘Šè­¦ |
| **@Around** | åŒ…å›´æ•´ä¸ªæ–¹æ³• | âœ… | âœ… | âœ… | âœ… | æ€§èƒ½ç›‘æ§ã€äº‹åŠ¡ã€ç¼“å­˜ |

### 7.2 æ‰§è¡Œé¡ºåºè¯´æ˜


**ğŸ”¢ æ­¥éª¤åˆ†è§£**ï¼š

```
æ­£å¸¸æ‰§è¡Œæµç¨‹ï¼š
@Around å¼€å§‹
  â†“
@Before
  â†“
ç›®æ ‡æ–¹æ³•æ‰§è¡Œ
  â†“
@AfterReturning
  â†“
@After
  â†“
@Around ç»“æŸ

å¼‚å¸¸æ‰§è¡Œæµç¨‹ï¼š
@Around å¼€å§‹
  â†“
@Before
  â†“
ç›®æ ‡æ–¹æ³•æ‰§è¡Œï¼ˆæŠ›å¼‚å¸¸ï¼‰
  â†“
@AfterThrowing
  â†“
@After
  â†“
@Around å¼‚å¸¸å¤„ç†
```

### 7.3 é€‰æ‹©æŒ‡å—


**ğŸ¯ å­¦ä¹ ç›®æ ‡**ï¼šæ ¹æ®éœ€æ±‚é€‰æ‹©åˆé€‚çš„é€šçŸ¥ç±»å‹

```
éœ€æ±‚ï¼šåªè®°å½•æ–¹æ³•è°ƒç”¨
â†’ é€‰æ‹©ï¼š@Before

éœ€æ±‚ï¼šæ— è®ºæˆè´¥éƒ½è¦æ¸…ç†èµ„æº
â†’ é€‰æ‹©ï¼š@After

éœ€æ±‚ï¼šæ–¹æ³•æˆåŠŸåæ›´æ–°ç¼“å­˜
â†’ é€‰æ‹©ï¼š@AfterReturning

éœ€æ±‚ï¼šæ•è·å¹¶è®°å½•å¼‚å¸¸
â†’ é€‰æ‹©ï¼š@AfterThrowing

éœ€æ±‚ï¼šè®¡ç®—æ–¹æ³•æ‰§è¡Œæ—¶é—´
â†’ é€‰æ‹©ï¼š@Around

éœ€æ±‚ï¼šå®ç°ç¼“å­˜æœºåˆ¶ï¼ˆæœ‰åˆ™è¿”å›ï¼Œæ— åˆ™æ‰§è¡Œï¼‰
â†’ é€‰æ‹©ï¼š@Around

éœ€æ±‚ï¼šå®ç°é‡è¯•æœºåˆ¶
â†’ é€‰æ‹©ï¼š@Around

éœ€æ±‚ï¼šä¿®æ”¹æ–¹æ³•è¿”å›å€¼
â†’ é€‰æ‹©ï¼š@Around
```

**ğŸ’¡ ä¸€å¥è¯æ€»ç»“**ï¼š
- ç®€å•æ“ä½œç”¨å¯¹åº”çš„ä¸“ç”¨é€šçŸ¥ï¼ˆBefore/Afterç­‰ï¼‰
- å¤æ‚æ§åˆ¶ç”¨ç¯ç»•é€šçŸ¥Around
- èƒ½ç”¨ä¸“ç”¨é€šçŸ¥å°±åˆ«ç”¨ç¯ç»•é€šçŸ¥ï¼ˆä»£ç æ›´æ¸…æ™°ï¼‰

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ é€šçŸ¥æœ¬è´¨ï¼šåœ¨æ–¹æ³•æ‰§è¡Œçš„ä¸åŒæ—¶æœºæ’å…¥é¢å¤–åŠŸèƒ½
ğŸ”¸ äº”ç§ç±»å‹ï¼šBeforeã€Afterã€AfterReturningã€AfterThrowingã€Around
ğŸ”¸ æ ¸å¿ƒå¯¹è±¡ï¼šJoinPointè·å–ä¿¡æ¯ï¼ŒProceedingJoinPointæ§åˆ¶æ‰§è¡Œ
ğŸ”¸ é€‰æ‹©åŸåˆ™ï¼šç®€å•ç”¨ä¸“ç”¨é€šçŸ¥ï¼Œå¤æ‚ç”¨ç¯ç»•é€šçŸ¥
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æ¯ç§é€šçŸ¥çš„æ ¸å¿ƒç‰¹ç‚¹**
```
@Beforeï¼š
- æ–¹æ³•æ‰§è¡Œå‰è¿è¡Œ
- é€‚åˆï¼šéªŒè¯ã€æ£€æŸ¥ã€è®°å½•

@Afterï¼š
- æ–¹æ³•æ‰§è¡Œåä¸€å®šè¿è¡Œï¼ˆæ— è®ºæˆè´¥ï¼‰
- é€‚åˆï¼šèµ„æºæ¸…ç†

@AfterReturningï¼š
- åªåœ¨æ–¹æ³•æ­£å¸¸è¿”å›æ—¶è¿è¡Œ
- å¯ä»¥è·å–è¿”å›å€¼
- é€‚åˆï¼šåç»­å¤„ç†ã€ç¼“å­˜æ›´æ–°

@AfterThrowingï¼š
- åªåœ¨æ–¹æ³•æŠ›å¼‚å¸¸æ—¶è¿è¡Œ
- å¯ä»¥è·å–å¼‚å¸¸å¯¹è±¡
- é€‚åˆï¼šå¼‚å¸¸æ—¥å¿—ã€å‘Šè­¦

@Aroundï¼š
- å®Œå…¨æ§åˆ¶æ–¹æ³•æ‰§è¡Œ
- åŠŸèƒ½æœ€å¼ºå¤§ä½†ä¹Ÿæœ€å¤æ‚
- é€‚åˆï¼šæ€§èƒ½ç›‘æ§ã€äº‹åŠ¡ã€ç¼“å­˜ã€é‡è¯•
```

**ğŸ”¹ ProceedingJoinPoint vs JoinPoint**
```
JoinPointï¼š
- åªèƒ½è·å–æ–¹æ³•ä¿¡æ¯
- ä¸èƒ½æ§åˆ¶æ–¹æ³•æ‰§è¡Œ
- Beforeã€Afterç­‰ä½¿ç”¨

ProceedingJoinPointï¼š
- ç»§æ‰¿è‡ªJoinPoint
- å¯ä»¥æ§åˆ¶æ–¹æ³•æ‰§è¡Œï¼ˆproceedæ–¹æ³•ï¼‰
- åªæœ‰Aroundä½¿ç”¨
```

### 8.3 å®æˆ˜å»ºè®®


**âœ… å·²æŒæ¡**ï¼š
- ç†è§£äº”ç§é€šçŸ¥çš„æ‰§è¡Œæ—¶æœº
- çŸ¥é“æ¯ç§é€šçŸ¥èƒ½åšä»€ä¹ˆã€ä¸èƒ½åšä»€ä¹ˆ
- ä¼šæ ¹æ®éœ€æ±‚é€‰æ‹©åˆé€‚çš„é€šçŸ¥ç±»å‹

**ğŸ”„ éœ€å¤ä¹ **ï¼š
- ç¯ç»•é€šçŸ¥çš„å®Œæ•´ç”¨æ³•
- å„ç§é€šçŸ¥çš„æ‰§è¡Œé¡ºåº
- å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨åœºæ™¯

**ğŸ“ˆ è¿›é˜¶è·¯å¾„**ï¼š
- å­¦ä¹ åˆ‡ç‚¹è¡¨è¾¾å¼çš„é«˜çº§ç”¨æ³•
- äº†è§£é€šçŸ¥çš„ä¼˜å…ˆçº§æ§åˆ¶
- æŒæ¡AOPåœ¨å®é™…é¡¹ç›®ä¸­çš„æœ€ä½³å®è·µ

**ğŸ“ èƒ½åŠ›ç­‰çº§**ï¼š
- â­ åˆçº§ï¼šç†è§£æ¦‚å¿µï¼Œä¼šç”¨åŸºæœ¬é€šçŸ¥
- â­â­ ä¸­çº§ï¼šç†Ÿç»ƒä½¿ç”¨å„ç§é€šçŸ¥ç±»å‹
- â­â­â­ é«˜çº§ï¼šèƒ½è®¾è®¡å¤æ‚çš„AOPæ–¹æ¡ˆ

### 8.4 è®°å¿†æŠ€å·§


**ğŸª è®°å¿†å£è¯€**ï¼š
```
Beforeå‰ç½®å…ˆæ£€æŸ¥ï¼Œ
Afteråç½®å¿…æ¸…ç†ï¼Œ
ReturnæˆåŠŸåšåç»­ï¼Œ
Throwingå¼‚å¸¸è¦å‘Šè­¦ï¼Œ
Aroundç¯ç»•æœ€å…¨èƒ½ï¼Œ
proceedè°ƒç”¨åˆ«å¿˜è®°ï¼
```

**ğŸ”‘ å…³é”®è¯æå–**ï¼š
- `Before` â†’ æ‰§è¡Œå‰ã€éªŒè¯ã€æ£€æŸ¥
- `After` â†’ æ‰§è¡Œåã€æ¸…ç†ã€å¿…æ‰§è¡Œ
- `AfterReturning` â†’ æˆåŠŸã€è¿”å›å€¼ã€åç»­
- `AfterThrowing` â†’ å¼‚å¸¸ã€æ—¥å¿—ã€å‘Šè­¦
- `Around` â†’ æ§åˆ¶ã€å¼ºå¤§ã€proceed

**æ ¸å¿ƒè®°å¿†**ï¼š
- é€šçŸ¥å°±æ˜¯åœ¨æ–¹æ³•æ‰§è¡Œçš„ä¸åŒæ—¶æœºæ’å…¥é¢å¤–ä»£ç 
- JoinPointç”¨æ¥è·å–ä¿¡æ¯ï¼ŒProceedingJoinPointç”¨æ¥æ§åˆ¶æ‰§è¡Œ
- ç®€å•åœºæ™¯ç”¨ä¸“ç”¨é€šçŸ¥ï¼Œå¤æ‚åœºæ™¯ç”¨ç¯ç»•é€šçŸ¥
- Aroundæœ€å¼ºå¤§ä½†ä¹Ÿæœ€å¤æ‚ï¼ŒæŒ‰éœ€é€‰æ‹©æœ€é‡è¦