---
title: 14ã€å¸¸è§é—®é¢˜ä¸é™·é˜±
---
## ğŸ“š ç›®å½•

1. [Springèµ„æºç®¡ç†åŸºç¡€æ¦‚å¿µ](#1-Springèµ„æºç®¡ç†åŸºç¡€æ¦‚å¿µ)
2. [AOPè‡ªè°ƒç”¨å¤±æ•ˆé—®é¢˜è¯¦è§£](#2-AOPè‡ªè°ƒç”¨å¤±æ•ˆé—®é¢˜è¯¦è§£)
3. [CGLIBä»£ç†é™åˆ¶ä¸è§£å†³æ–¹æ¡ˆ](#3-CGLIBä»£ç†é™åˆ¶ä¸è§£å†³æ–¹æ¡ˆ)
4. [Beanæ–¹æ³•è°ƒç”¨ä¸proxyBeanMethods](#4-Beanæ–¹æ³•è°ƒç”¨ä¸proxyBeanMethods)
5. [ä¾èµ–æ³¨å…¥æœ€ä½³å®è·µ](#5-ä¾èµ–æ³¨å…¥æœ€ä½³å®è·µ)
6. [é…ç½®å±æ€§åŠ è½½æœºåˆ¶](#6-é…ç½®å±æ€§åŠ è½½æœºåˆ¶)
7. [èµ„æºè·¯å¾„åŒ¹é…è¯¦è§£](#7-èµ„æºè·¯å¾„åŒ¹é…è¯¦è§£)
8. [å¼‚æ­¥äº‹ä»¶å¤„ç†æœºåˆ¶](#8-å¼‚æ­¥äº‹ä»¶å¤„ç†æœºåˆ¶)
9. [SpELè¡¨è¾¾å¼å®‰å…¨ä¸æ€§èƒ½](#9-SpELè¡¨è¾¾å¼å®‰å…¨ä¸æ€§èƒ½)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒŸ Springèµ„æºç®¡ç†åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯Springèµ„æºç®¡ç†


**ç®€å•ç†è§£**ï¼šSpringèµ„æºç®¡ç†å°±åƒæ˜¯ä¸€ä¸ª"æ™ºèƒ½ç®¡å®¶"ï¼Œå¸®æˆ‘ä»¬ç®¡ç†åº”ç”¨ä¸­çš„å„ç§èµ„æºã€‚

```
ç°å®ç”Ÿæ´»ä¸­çš„ç®¡å®¶ï¼š
- ç®¡ç†å®¶é‡Œçš„ç‰©å“
- çŸ¥é“ä¸œè¥¿æ”¾åœ¨å“ªé‡Œ
- éœ€è¦æ—¶èƒ½å¿«é€Ÿæ‰¾åˆ°
- ç¡®ä¿ç‰©å“ä¸é‡å¤è´­ä¹°

Springèµ„æºç®¡ç†ï¼š
- ç®¡ç†åº”ç”¨ä¸­çš„Beanå¯¹è±¡
- çŸ¥é“æ¯ä¸ªBeançš„ä½ç½®å’ŒçŠ¶æ€
- éœ€è¦æ—¶èƒ½å¿«é€Ÿè·å–
- ç¡®ä¿Beanä¸é‡å¤åˆ›å»º
```

### 1.2 æ ¸å¿ƒç®¡ç†å†…å®¹


**ğŸ“‹ ä¸»è¦ç®¡ç†å¯¹è±¡**
```
ğŸ”¸ Beanç”Ÿå‘½å‘¨æœŸç®¡ç†
â€¢ åˆ›å»ºï¼šä»€ä¹ˆæ—¶å€™åˆ›å»ºBean
â€¢ åˆå§‹åŒ–ï¼šBeanåˆ›å»ºåçš„é…ç½®å·¥ä½œ
â€¢ é”€æ¯ï¼šåº”ç”¨å…³é—­æ—¶çš„æ¸…ç†å·¥ä½œ

ğŸ”¸ ä¾èµ–å…³ç³»ç®¡ç†
â€¢ æ³¨å…¥ï¼šæŠŠéœ€è¦çš„å¯¹è±¡"é€"åˆ°æŒ‡å®šä½ç½®
â€¢ å¾ªç¯ä¾èµ–ï¼šå¤„ç†ç›¸äº’ä¾èµ–çš„æƒ…å†µ
â€¢ ä½œç”¨åŸŸï¼šæ§åˆ¶Beançš„ç”Ÿå­˜èŒƒå›´

ğŸ”¸ é…ç½®èµ„æºç®¡ç†
â€¢ å±æ€§æ–‡ä»¶ï¼šapplication.propertiesç­‰é…ç½®
â€¢ é™æ€èµ„æºï¼šå›¾ç‰‡ã€CSSã€JSç­‰æ–‡ä»¶
â€¢ å¤–éƒ¨é…ç½®ï¼šç¯å¢ƒå˜é‡ã€å‘½ä»¤è¡Œå‚æ•°
```

### 1.3 èµ„æºç®¡ç†çš„ä»·å€¼


**ğŸ’¡ è§£å†³çš„æ ¸å¿ƒé—®é¢˜**
- **å¯¹è±¡åˆ›å»ºå¤æ‚**ï¼šä¸ç”¨æ‰‹åŠ¨newå¯¹è±¡ï¼ŒSpringå¸®ä½ åˆ›å»º
- **ä¾èµ–ç®¡ç†å›°éš¾**ï¼šä¸ç”¨å…³å¿ƒå¯¹è±¡é—´çš„ä¾èµ–å…³ç³»
- **é…ç½®åˆ†æ•£éš¾ç»´æŠ¤**ï¼šç»Ÿä¸€ç®¡ç†æ‰€æœ‰é…ç½®ä¿¡æ¯
- **èµ„æºæµªè´¹**ï¼šé¿å…é‡å¤åˆ›å»ºç›¸åŒå¯¹è±¡

---

## 2. âš ï¸ AOPè‡ªè°ƒç”¨å¤±æ•ˆé—®é¢˜è¯¦è§£


### 2.1 ä»€ä¹ˆæ˜¯è‡ªè°ƒç”¨å¤±æ•ˆ


**é€šä¿—è§£é‡Š**ï¼šå°±åƒå·¦æ‰‹æ‹å³æ‰‹ï¼Œè‡ªå·±è°ƒç”¨è‡ªå·±çš„æ–¹æ³•æ—¶ï¼ŒSpringçš„"å¢å¼ºåŠŸèƒ½"ä¼šå¤±æ•ˆã€‚

```
ç”Ÿæ´»ä¸­çš„ç±»æ¯”ï¼š
ä½ æˆ´äº†ä¸€å‰¯"å¢å¼ºçœ¼é•œ"ï¼Œèƒ½çœ‹åˆ°æ›´å¤šç»†èŠ‚
ä½†å½“ä½ çœ‹è‡ªå·±çš„æ‰‹æ—¶ï¼Œçœ¼é•œä¸èµ·ä½œç”¨
å› ä¸ºçœ¼é•œåªå¯¹"å¤–éƒ¨è§‚å¯Ÿ"æœ‰æ•ˆ

Spring AOPè‡ªè°ƒç”¨å¤±æ•ˆï¼š
Serviceæ–¹æ³•è¢«@Transactionalä¿®é¥°ï¼ˆå¢å¼ºåŠŸèƒ½ï¼‰
ä½†å†…éƒ¨è°ƒç”¨å…¶ä»–æ–¹æ³•æ—¶ï¼Œäº‹åŠ¡åŠŸèƒ½å¤±æ•ˆ
å› ä¸ºAOPåªå¯¹"å¤–éƒ¨è°ƒç”¨"æœ‰æ•ˆ
```

### 2.2 é—®é¢˜æ¼”ç¤º


**âŒ é—®é¢˜ä»£ç ç¤ºä¾‹**
```java
@Service
public class UserService {
    
    @Transactional
    public void createUser(User user) {
        // ä¿å­˜ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
        saveBasicInfo(user);
        
        // è‡ªè°ƒç”¨ - äº‹åŠ¡æ³¨è§£å¤±æ•ˆï¼
        saveUserProfile(user);
    }
    
    @Transactional(rollbackFor = Exception.class)
    public void saveUserProfile(User user) {
        // è¿™ä¸ªæ–¹æ³•çš„äº‹åŠ¡è®¾ç½®ä¸ä¼šç”Ÿæ•ˆ
        // å› ä¸ºæ˜¯å†…éƒ¨è°ƒç”¨ï¼Œæ²¡æœ‰é€šè¿‡Springä»£ç†
        userProfileRepository.save(user.getProfile());
    }
}
```

### 2.3 å¤±æ•ˆåŸå› æ·±åº¦è§£æ


**ğŸ” æŠ€æœ¯åŸç†**
```
Spring AOPå·¥ä½œæœºåˆ¶ï¼š

å¤–éƒ¨è°ƒç”¨æµç¨‹ï¼š
å®¢æˆ·ç«¯ â†’ Springä»£ç†å¯¹è±¡ â†’ å¢å¼ºé€»è¾‘(äº‹åŠ¡) â†’ çœŸå®å¯¹è±¡æ–¹æ³•

å†…éƒ¨è°ƒç”¨æµç¨‹ï¼š
çœŸå®å¯¹è±¡æ–¹æ³•A â†’ ç›´æ¥è°ƒç”¨ â†’ çœŸå®å¯¹è±¡æ–¹æ³•B
               â†‘
          è·³è¿‡äº†ä»£ç†å¯¹è±¡ï¼
```

**ğŸ“Š è°ƒç”¨è·¯å¾„å¯¹æ¯”**

| è°ƒç”¨ç±»å‹ | **è°ƒç”¨è·¯å¾„** | **æ˜¯å¦ç»è¿‡ä»£ç†** | **AOPåŠŸèƒ½** |
|---------|------------|----------------|------------|
| ğŸ”¸ **å¤–éƒ¨è°ƒç”¨** | `Controller â†’ ä»£ç† â†’ Serviceæ–¹æ³•` | `âœ… æ˜¯` | `âœ… ç”Ÿæ•ˆ` |
| ğŸ”¸ **å†…éƒ¨è°ƒç”¨** | `Serviceæ–¹æ³•A â†’ Serviceæ–¹æ³•B` | `âŒ å¦` | `âŒ å¤±æ•ˆ` |

### 2.4 è§£å†³æ–¹æ¡ˆ


**ğŸ› ï¸ æ–¹æ¡ˆä¸€ï¼šæ³¨å…¥è‡ªå·±**
```java
@Service
public class UserService {
    
    // æ³¨å…¥è‡ªå·±çš„ä»£ç†å¯¹è±¡
    @Autowired
    private UserService userService;
    
    @Transactional
    public void createUser(User user) {
        saveBasicInfo(user);
        
        // é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨
        userService.saveUserProfile(user);
    }
    
    @Transactional(rollbackFor = Exception.class)
    public void saveUserProfile(User user) {
        userProfileRepository.save(user.getProfile());
    }
}
```

**ğŸ› ï¸ æ–¹æ¡ˆäºŒï¼šè·å–å½“å‰ä»£ç†**
```java
@Service
public class UserService {
    
    @Transactional
    public void createUser(User user) {
        saveBasicInfo(user);
        
        // è·å–å½“å‰å¯¹è±¡çš„ä»£ç†
        UserService proxy = (UserService) AopContext.currentProxy();
        proxy.saveUserProfile(user);
    }
}
```

**ğŸ› ï¸ æ–¹æ¡ˆä¸‰ï¼šæ–¹æ³•æ‹†åˆ†**
```java
// æœ€ä½³å®è·µï¼šå°†éœ€è¦äº‹åŠ¡çš„æ–¹æ³•æ‹†åˆ†åˆ°ä¸åŒService
@Service
public class UserService {
    
    @Autowired
    private UserProfileService userProfileService;
    
    @Transactional
    public void createUser(User user) {
        saveBasicInfo(user);
        // è°ƒç”¨å…¶ä»–Serviceçš„æ–¹æ³•
        userProfileService.saveUserProfile(user);
    }
}
```

---

## 3. ğŸš« CGLIBä»£ç†é™åˆ¶ä¸è§£å†³æ–¹æ¡ˆ


### 3.1 ä»€ä¹ˆæ˜¯CGLIBä»£ç†


**ç®€å•ç†è§£**ï¼šCGLIBå°±åƒæ˜¯ä¸€ä¸ª"å½±åˆ†èº«æœ¯"ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªç±»çš„"åŠ å¼ºç‰ˆ"å­ç±»ã€‚

```
å¿è€…çš„å½±åˆ†èº«æœ¯ï¼š
- åˆ›å»ºä¸€ä¸ªçœ‹èµ·æ¥ä¸€æ ·çš„åˆ†èº«
- åˆ†èº«æœ‰é¢å¤–çš„èƒ½åŠ›
- ä½†æœ‰äº›é™åˆ¶ï¼ˆæ¯”å¦‚ä¸èƒ½ä½¿ç”¨æŸäº›å¿æœ¯ï¼‰

CGLIBä»£ç†ï¼š
- åˆ›å»ºä¸€ä¸ªç›®æ ‡ç±»çš„å­ç±»
- å­ç±»æœ‰é¢å¤–çš„åŠŸèƒ½ï¼ˆAOPå¢å¼ºï¼‰
- ä½†æœ‰é™åˆ¶ï¼ˆä¸èƒ½ä»£ç†finalæ–¹æ³•ï¼‰
```

### 3.2 finalæ–¹æ³•æ— æ³•ä»£ç†çš„åŸå› 


**ğŸ” æŠ€æœ¯åŸç†**
```
Javaç»§æ‰¿è§„åˆ™ï¼š
- å­ç±»å¯ä»¥é‡å†™çˆ¶ç±»çš„æ™®é€šæ–¹æ³•
- å­ç±»ä¸èƒ½é‡å†™çˆ¶ç±»çš„finalæ–¹æ³•

CGLIBä»£ç†åŸç†ï¼š
- ç”Ÿæˆç›®æ ‡ç±»çš„å­ç±»
- é‡å†™æ–¹æ³•æ¥æ·»åŠ å¢å¼ºé€»è¾‘
- finalæ–¹æ³•æ— æ³•é‡å†™ï¼Œæ‰€ä»¥æ— æ³•ä»£ç†
```

### 3.3 é—®é¢˜æ¼”ç¤º


**âŒ æ— æ³•ä»£ç†çš„æƒ…å†µ**
```java
@Service
public class OrderService {
    
    // finalæ–¹æ³•æ— æ³•è¢«CGLIBä»£ç†
    @Transactional
    public final void processOrder(Order order) {
        // äº‹åŠ¡æ³¨è§£åœ¨finalæ–¹æ³•ä¸Šä¸èµ·ä½œç”¨
        orderRepository.save(order);
        updateInventory(order);
    }
    
    // finalç±»ä¹Ÿæ— æ³•è¢«ä»£ç†
}

final class PaymentService {
    @Transactional
    public void processPayment(Payment payment) {
        // æ•´ä¸ªç±»æ˜¯finalçš„ï¼ŒAOPåŠŸèƒ½éƒ½ä¸ä¼šç”Ÿæ•ˆ
        paymentRepository.save(payment);
    }
}
```

### 3.4 è§£å†³æ–¹æ¡ˆ


**âœ… æ–¹æ¡ˆä¸€ï¼šç§»é™¤finalä¿®é¥°ç¬¦**
```java
@Service
public class OrderService {
    
    // ç§»é™¤finalï¼Œå…è®¸CGLIBä»£ç†
    @Transactional
    public void processOrder(Order order) {
        orderRepository.save(order);
        updateInventory(order);
    }
}
```

**âœ… æ–¹æ¡ˆäºŒï¼šä½¿ç”¨æ¥å£**
```java
// å®šä¹‰æ¥å£
public interface OrderService {
    void processOrder(Order order);
}

// å®ç°ç±»å¯ä»¥æœ‰finalæ–¹æ³•
@Service
public class OrderServiceImpl implements OrderService {
    
    @Override
    @Transactional
    public void processOrder(Order order) {
        // Springä½¿ç”¨JDKä»£ç†ï¼Œä¸å—finalé™åˆ¶
        orderRepository.save(order);
    }
    
    // ç§æœ‰æ–¹æ³•å¯ä»¥æ˜¯finalçš„
    private final void helperMethod() {
        // è¾…åŠ©æ–¹æ³•ä¸éœ€è¦ä»£ç†
    }
}
```

### 3.5 ä»£ç†ç±»å‹é€‰æ‹©


**ğŸ“Š JDKä»£ç† vs CGLIBä»£ç†**

| ç‰¹æ€§ | **JDKä»£ç†** | **CGLIBä»£ç†** |
|------|-----------|-------------|
| ğŸ”¸ **åŸºç¡€è¦æ±‚** | `å¿…é¡»æœ‰æ¥å£` | `ä¸éœ€è¦æ¥å£` |
| ğŸ”¸ **ä»£ç†æ–¹å¼** | `åŸºäºæ¥å£å®ç°` | `åŸºäºç»§æ‰¿å­ç±»` |
| ğŸ”¸ **finalé™åˆ¶** | `æ— é™åˆ¶` | `ä¸èƒ½ä»£ç†final` |
| ğŸ”¸ **æ€§èƒ½** | `è¾ƒå¿«` | `è¾ƒæ…¢` |
| ğŸ”¸ **ä½¿ç”¨åœºæ™¯** | `é¢å‘æ¥å£ç¼–ç¨‹` | `ç›´æ¥ä½¿ç”¨å®ç°ç±»` |

---

## 4. ğŸ”§ Beanæ–¹æ³•è°ƒç”¨ä¸proxyBeanMethods


### 4.1 proxyBeanMethodsæ˜¯ä»€ä¹ˆ


**é€šä¿—è§£é‡Š**ï¼š`proxyBeanMethods`å°±åƒä¸€ä¸ª"å¼€å…³"ï¼Œæ§åˆ¶é…ç½®ç±»ä¸­çš„æ–¹æ³•æ˜¯å¦éœ€è¦è¢«"ç›‘æ§"ã€‚

```
ç”Ÿæ´»ä¸­çš„ç±»æ¯”ï¼š
ä½ åœ¨å·¥å‚é‡Œæœ‰ä¸€ä¸ªåˆ¶ä½œè›‹ç³•çš„é…æ–¹
- proxyBeanMethods = true: æ¯æ¬¡æœ‰äººè¦è›‹ç³•ï¼Œéƒ½æ£€æŸ¥æ˜¯å¦å·²ç»åšè¿‡
- proxyBeanMethods = false: æ¯æ¬¡æœ‰äººè¦è›‹ç³•ï¼Œéƒ½é‡æ–°åˆ¶ä½œ

Springé…ç½®ç±»ï¼š
- proxyBeanMethods = true: @Beanæ–¹æ³•è¢«ä»£ç†ï¼Œä¿è¯å•ä¾‹
- proxyBeanMethods = false: @Beanæ–¹æ³•ä¸è¢«ä»£ç†ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½æ‰§è¡Œ
```

### 4.2 è¯¦ç»†å¯¹æ¯”


**ğŸ“‹ ä¸¤ç§æ¨¡å¼çš„åŒºåˆ«**

```java
// æ¨¡å¼ä¸€ï¼šFullæ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
@Configuration  // ç­‰åŒäº @Configuration(proxyBeanMethods = true)
public class AppConfig {
    
    @Bean
    public DatabaseConnection dbConnection() {
        return new DatabaseConnection();
    }
    
    @Bean
    public UserService userService() {
        // è¿™é‡Œè°ƒç”¨dbConnection()ä¼šè¿”å›åŒä¸€ä¸ªBeanå®ä¾‹
        return new UserService(dbConnection());
    }
    
    @Bean 
    public OrderService orderService() {
        // è¿™é‡Œè°ƒç”¨dbConnection()ä¹Ÿä¼šè¿”å›åŒä¸€ä¸ªBeanå®ä¾‹
        return new OrderService(dbConnection());
    }
}
```

```java
// æ¨¡å¼äºŒï¼šLiteæ¨¡å¼
@Configuration(proxyBeanMethods = false)
public class AppConfig {
    
    @Bean
    public DatabaseConnection dbConnection() {
        return new DatabaseConnection();
    }
    
    @Bean
    public UserService userService() {
        // è¿™é‡Œè°ƒç”¨dbConnection()ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼
        return new UserService(dbConnection());
    }
    
    @Bean 
    public OrderService orderService() {
        // è¿™é‡Œè°ƒç”¨dbConnection()åˆä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼
        return new OrderService(dbConnection());
    }
}
```

### 4.3 ä½¿ç”¨åœºæ™¯åˆ†æ


**ğŸ¯ Fullæ¨¡å¼é€‚ç”¨åœºæ™¯**
```
âœ… Beanä¹‹é—´æœ‰ä¾èµ–å…³ç³»
âœ… éœ€è¦ä¿è¯Beançš„å•ä¾‹ç‰¹æ€§
âœ… é…ç½®ç±»ä¸­æœ‰å¤æ‚çš„Beanå…³ç³»

ç¤ºä¾‹ï¼šæ•°æ®åº“è¿æ¥æ± ã€ç¼“å­˜ç®¡ç†å™¨ç­‰éœ€è¦å•ä¾‹çš„åœºæ™¯
```

**ğŸ¯ Liteæ¨¡å¼é€‚ç”¨åœºæ™¯**
```
âœ… Beanä¹‹é—´ç›¸äº’ç‹¬ç«‹
âœ… è¿½æ±‚å¯åŠ¨æ€§èƒ½
âœ… ç®€å•çš„é…ç½®åœºæ™¯

ç¤ºä¾‹ï¼šç®€å•çš„é…ç½®Beanã€å·¥å…·ç±»Beanç­‰
```

### 4.4 æ€§èƒ½å½±å“


**âš¡ å¯åŠ¨æ€§èƒ½å¯¹æ¯”**
```
Fullæ¨¡å¼ï¼ˆproxyBeanMethods = trueï¼‰:
å¯åŠ¨é˜¶æ®µï¼šéœ€è¦åˆ›å»ºé…ç½®ç±»çš„CGLIBä»£ç† â†’ å¯åŠ¨è¾ƒæ…¢
è¿è¡Œé˜¶æ®µï¼šBeanè°ƒç”¨æœ‰ä»£ç†å¼€é”€ â†’ è¿è¡Œç¨æ…¢

Liteæ¨¡å¼ï¼ˆproxyBeanMethods = falseï¼‰:
å¯åŠ¨é˜¶æ®µï¼šä¸éœ€è¦åˆ›å»ºä»£ç† â†’ å¯åŠ¨æ›´å¿«
è¿è¡Œé˜¶æ®µï¼šç›´æ¥æ–¹æ³•è°ƒç”¨ â†’ è¿è¡Œæ›´å¿«
```

---

## 5. ğŸ’‰ ä¾èµ–æ³¨å…¥æœ€ä½³å®è·µ


### 5.1 æ³¨å…¥æ–¹å¼å¯¹æ¯”


**ğŸ“Š ä¸‰ç§æ³¨å…¥æ–¹å¼**

```java
@Service
public class UserService {
    
    // âŒ å­—æ®µæ³¨å…¥ï¼ˆä¸æ¨èï¼‰
    @Autowired
    private UserRepository userRepository;
    
    // âœ… æ„é€ å™¨æ³¨å…¥ï¼ˆæ¨èï¼‰
    private final UserRepository userRepository;
    private final EmailService emailService;
    
    public UserService(UserRepository userRepository, 
                      EmailService emailService) {
        this.userRepository = userRepository;
        this.emailService = emailService;
    }
    
    // âš ï¸ Setteræ³¨å…¥ï¼ˆç‰¹å®šåœºæ™¯ï¼‰
    private NotificationService notificationService;
    
    @Autowired
    public void setNotificationService(NotificationService service) {
        this.notificationService = service;
    }
}
```

### 5.2 è¿‡åº¦å­—æ®µæ³¨å…¥çš„é—®é¢˜


**ğŸš¨ å¸¸è§é—®é¢˜**
```
é—®é¢˜1ï¼šæµ‹è¯•å›°éš¾
- å­—æ®µæ³¨å…¥çš„ä¾èµ–éš¾ä»¥åœ¨æµ‹è¯•ä¸­æ›¿æ¢
- æ— æ³•åˆ›å»ºç‹¬ç«‹çš„æµ‹è¯•å®ä¾‹

é—®é¢˜2ï¼šéšè—ä¾èµ–
- ç±»çš„ä¾èµ–å…³ç³»ä¸æ˜ç¡®
- å®¹æ˜“é€ æˆè¿‡å¤šä¾èµ–

é—®é¢˜3ï¼šå¾ªç¯ä¾èµ–
- å­—æ®µæ³¨å…¥å®¹æ˜“é€ æˆå¾ªç¯ä¾èµ–
- è¿è¡Œæ—¶æ‰å‘ç°é—®é¢˜
```

### 5.3 å¾ªç¯ä¾èµ–é—®é¢˜è¯¦è§£


**ğŸ”„ ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–**
```
ç®€å•ç†è§£ï¼šAéœ€è¦Bï¼ŒBåˆéœ€è¦Aï¼Œå½¢æˆ"æ­»å¾ªç¯"

å®é™…ä»£ç ï¼š
@Service
public class UserService {
    @Autowired
    private OrderService orderService;  // UserServiceéœ€è¦OrderService
}

@Service 
public class OrderService {
    @Autowired
    private UserService userService;    // OrderServiceéœ€è¦UserService
}

Springåˆ›å»ºBeançš„å›°å¢ƒï¼š
è¦åˆ›å»ºUserService â†’ éœ€è¦OrderService
è¦åˆ›å»ºOrderService â†’ éœ€è¦UserService
é™·å…¥æ— é™å¾ªç¯ï¼
```

### 5.4 å¾ªç¯ä¾èµ–è§£å†³æ–¹æ¡ˆ


**ğŸ› ï¸ æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨@Lazyæ³¨è§£**
```java
@Service
public class UserService {
    
    private final OrderService orderService;
    
    // å»¶è¿Ÿæ³¨å…¥ï¼Œæ‰“ç ´å¾ªç¯
    public UserService(@Lazy OrderService orderService) {
        this.orderService = orderService;
    }
}
```

**ğŸ› ï¸ æ–¹æ¡ˆäºŒï¼šé‡æ–°è®¾è®¡æ¶æ„**
```java
// æå–å…¬å…±æœåŠ¡ï¼Œæ¶ˆé™¤å¾ªç¯ä¾èµ–
@Service
public class BusinessService {
    private final UserRepository userRepository;
    private final OrderRepository orderRepository;
    
    public void processUserOrder(User user, Order order) {
        // ç»Ÿä¸€å¤„ç†ç”¨æˆ·å’Œè®¢å•çš„ä¸šåŠ¡é€»è¾‘
    }
}

@Service
public class UserService {
    private final BusinessService businessService;
}

@Service 
public class OrderService {
    private final BusinessService businessService;
}
```

---

## 6. âš™ï¸ é…ç½®å±æ€§åŠ è½½æœºåˆ¶


### 6.1 @Valueä¸PropertySourceçš„å…³ç³»


**ğŸ” åŠ è½½é¡ºåºç†è§£**
```
æƒ³è±¡ä¸€ä¸ªå›¾ä¹¦ç®¡ç†ç³»ç»Ÿï¼š
1. ç³»ç»Ÿé»˜è®¤é…ç½®ï¼ˆSpring Booté»˜è®¤é…ç½®ï¼‰
2. application.propertiesï¼ˆä¸»é…ç½®æ–‡ä»¶ï¼‰
3. @PropertySourceæŒ‡å®šçš„æ–‡ä»¶
4. ç¯å¢ƒå˜é‡
5. å‘½ä»¤è¡Œå‚æ•°

åé¢çš„é…ç½®ä¼šè¦†ç›–å‰é¢çš„é…ç½®
å°±åƒåæ¥çš„è§„å®šè¦†ç›–æ—§è§„å®š
```

### 6.2 åŠ è½½é¡ºåºé—®é¢˜æ¼”ç¤º


**âŒ é—®é¢˜åœºæ™¯**
```java
// custom.propertiesæ–‡ä»¶å†…å®¹
app.name=CustomApp
app.version=1.0.0

@Configuration
@PropertySource("classpath:custom.properties")  // è¿™ä¸ªæ–‡ä»¶ååŠ è½½
public class AppConfig {
    
    @Value("${app.name:DefaultApp}")  // å¯èƒ½è·å–ä¸åˆ°custom.propertiesä¸­çš„å€¼
    private String appName;
}
```

```properties
# application.propertiesï¼ˆè¿™ä¸ªæ–‡ä»¶å…ˆåŠ è½½ï¼‰
app.name=MainApp
```

### 6.3 æ­£ç¡®çš„é…ç½®æ–¹å¼


**âœ… è§£å†³æ–¹æ¡ˆ**
```java
@Configuration
@PropertySource(value = "classpath:custom.properties", 
               ignoreResourceNotFound = true)
@EnableConfigurationProperties(AppProperties.class)
public class AppConfig {
    
    @Bean
    @ConfigurationProperties(prefix = "app")
    public AppProperties appProperties() {
        return new AppProperties();
    }
}

// ä¸“é—¨çš„é…ç½®ç±»
@ConfigurationProperties(prefix = "app")
@Data
public class AppProperties {
    private String name = "DefaultApp";  // é»˜è®¤å€¼
    private String version = "1.0.0";
}
```

### 6.4 é…ç½®ä¼˜å…ˆçº§è¡¨


**ğŸ“Š Spring Booté…ç½®ä¼˜å…ˆçº§**

| ä¼˜å…ˆçº§ | **é…ç½®æº** | **è¯´æ˜** | **ä½¿ç”¨åœºæ™¯** |
|-------|----------|---------|------------|
| 1 | `å‘½ä»¤è¡Œå‚æ•°` | `--app.name=test` | `ä¸´æ—¶è°ƒè¯•` |
| 2 | `ç¯å¢ƒå˜é‡` | `APP_NAME=prod` | `ç”Ÿäº§ç¯å¢ƒ` |
| 3 | `application-{profile}.properties` | `ç‰¹å®šç¯å¢ƒé…ç½®` | `å¤šç¯å¢ƒéƒ¨ç½²` |
| 4 | `application.properties` | `ä¸»é…ç½®æ–‡ä»¶` | `é€šç”¨é…ç½®` |
| 5 | `@PropertySource` | `è‡ªå®šä¹‰é…ç½®æ–‡ä»¶` | `æ¨¡å—åŒ–é…ç½®` |

---

## 7. ğŸ“ èµ„æºè·¯å¾„åŒ¹é…è¯¦è§£


### 7.1 classpath vs classpath*çš„åŒºåˆ«


**ğŸ” ç®€å•ç†è§£**
```
classpath: â†’ æ‰¾ç¬¬ä¸€ä¸ªåŒ¹é…çš„æ–‡ä»¶
classpath*: â†’ æ‰¾æ‰€æœ‰åŒ¹é…çš„æ–‡ä»¶

ç”Ÿæ´»ç±»æ¯”ï¼š
classpath: å°±åƒåœ¨å›¾ä¹¦é¦†æ‰¾ç¬¬ä¸€æœ¬å«"Springæ•™ç¨‹"çš„ä¹¦
classpath*: å°±åƒåœ¨å›¾ä¹¦é¦†æ‰¾æ‰€æœ‰å«"Springæ•™ç¨‹"çš„ä¹¦
```

### 7.2 è¯¦ç»†å¯¹æ¯”ç¤ºä¾‹


**ğŸ“‹ åŒ¹é…è¡Œä¸ºå·®å¼‚**
```java
// é¡¹ç›®ç»“æ„
src/main/resources/config/app.properties
lib1.jar!/config/app.properties  
lib2.jar!/config/app.properties

// classpath:åŒ¹é…
@PropertySource("classpath:config/app.properties")
// ç»“æœï¼šåªåŠ è½½src/main/resources/config/app.properties

// classpath*:åŒ¹é…
@PropertySource("classpath*:config/app.properties") 
// ç»“æœï¼šåŠ è½½æ‰€æœ‰ä¸‰ä¸ªapp.propertiesæ–‡ä»¶
```

### 7.3 ä½¿ç”¨åœºæ™¯åˆ†æ


**ğŸ¯ classpath:é€‚ç”¨åœºæ™¯**
```
âœ… ç¡®å®šåªæœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶
âœ… éœ€è¦ç²¾ç¡®æ§åˆ¶åŠ è½½é¡ºåº
âœ… æ€§èƒ½è¦æ±‚è¾ƒé«˜ï¼ˆåªæŸ¥æ‰¾ç¬¬ä¸€ä¸ªï¼‰

ç¤ºä¾‹ï¼šä¸»é…ç½®æ–‡ä»¶application.properties
```

**ğŸ¯ classpath*:é€‚ç”¨åœºæ™¯**
```
âœ… éœ€è¦åŠ è½½å¤šä¸ªjaråŒ…ä¸­çš„åŒåæ–‡ä»¶
âœ… æ¨¡å—åŒ–é¡¹ç›®ä¸­çš„é…ç½®åˆå¹¶
âœ… æ’ä»¶åŒ–æ¶æ„

ç¤ºä¾‹ï¼šæ‰€æœ‰æ¨¡å—çš„mybatis-config.xmlæ–‡ä»¶
```

### 7.4 é€šé…ç¬¦åŒ¹é…è§„åˆ™


**ğŸ” åŒ¹é…æ¨¡å¼è¯¦è§£**
```java
// ç²¾ç¡®åŒ¹é…
"classpath:application.properties"

// é€šé…ç¬¦åŒ¹é…
"classpath*:config/*.properties"     // åŒ¹é…configç›®å½•ä¸‹æ‰€æœ‰.propertiesæ–‡ä»¶
"classpath*:**/app-*.xml"           // åŒ¹é…ä»»æ„ç›®å½•ä¸‹app-å¼€å¤´çš„xmlæ–‡ä»¶
"classpath:static/**"               // åŒ¹é…staticç›®å½•åŠå…¶å­ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶
```

---

## 8. ğŸš€ å¼‚æ­¥äº‹ä»¶å¤„ç†æœºåˆ¶


### 8.1 å¼‚æ­¥äº‹ä»¶åŸºæœ¬æ¦‚å¿µ


**ğŸ” ä»€ä¹ˆæ˜¯å¼‚æ­¥äº‹ä»¶**
```
åŒæ­¥äº‹ä»¶å¤„ç†ï¼š
ç”¨æˆ·æ³¨å†Œ â†’ å‘é€é‚®ä»¶ â†’ è®°å½•æ—¥å¿— â†’ è¿”å›ç»“æœ
ï¼ˆæ¯æ­¥éƒ½è¦ç­‰å¾…å®Œæˆï¼‰

å¼‚æ­¥äº‹ä»¶å¤„ç†ï¼š
ç”¨æˆ·æ³¨å†Œ â†’ ç«‹å³è¿”å›ç»“æœ
          â†“
     åå°å¼‚æ­¥æ‰§è¡Œï¼šå‘é€é‚®ä»¶ã€è®°å½•æ—¥å¿—
```

### 8.2 å¼‚æ­¥äº‹ä»¶å®ç°


**ğŸ“ ä»£ç å®ç°ç¤ºä¾‹**
```java
// äº‹ä»¶å®šä¹‰
public class UserRegisteredEvent {
    private final User user;
    private final LocalDateTime timestamp;
    
    public UserRegisteredEvent(User user) {
        this.user = user;
        this.timestamp = LocalDateTime.now();
    }
    // getters...
}

// äº‹ä»¶å‘å¸ƒ
@Service
public class UserService {
    
    @Autowired
    private ApplicationEventPublisher eventPublisher;
    
    public void registerUser(User user) {
        // ä¿å­˜ç”¨æˆ·
        userRepository.save(user);
        
        // å‘å¸ƒäº‹ä»¶ï¼ˆå¼‚æ­¥å¤„ç†ï¼‰
        eventPublisher.publishEvent(new UserRegisteredEvent(user));
    }
}

// äº‹ä»¶ç›‘å¬
@Component
public class UserEventListener {
    
    @Async
    @EventListener
    public void handleUserRegistered(UserRegisteredEvent event) {
        // å¼‚æ­¥å‘é€æ¬¢è¿é‚®ä»¶
        emailService.sendWelcomeEmail(event.getUser());
    }
}
```

### 8.3 çº¿ç¨‹å®‰å…¨é—®é¢˜


**âš ï¸ å¸¸è§çº¿ç¨‹å®‰å…¨é—®é¢˜**
```java
@Component
public class UserEventListener {
    
    // âŒ çº¿ç¨‹ä¸å®‰å…¨ï¼šå¤šä¸ªçº¿ç¨‹å…±äº«å®ä¾‹å˜é‡
    private int processCount = 0;
    
    @Async
    @EventListener 
    public void handleUserRegistered(UserRegisteredEvent event) {
        processCount++;  // å¤šçº¿ç¨‹å¹¶å‘ä¿®æ”¹ï¼Œæ•°æ®ä¸ä¸€è‡´
        processUser(event.getUser());
    }
}
```

**âœ… çº¿ç¨‹å®‰å…¨è§£å†³æ–¹æ¡ˆ**
```java
@Component
public class UserEventListener {
    
    // ä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„è®¡æ•°å™¨
    private final AtomicInteger processCount = new AtomicInteger(0);
    
    @Async
    @EventListener
    public void handleUserRegistered(UserRegisteredEvent event) {
        processCount.incrementAndGet();  // åŸå­æ“ä½œï¼Œçº¿ç¨‹å®‰å…¨
        processUser(event.getUser());
    }
    
    // æˆ–è€…ä½¿ç”¨ThreadLocal
    private final ThreadLocal<String> threadContext = new ThreadLocal<>();
    
    @Async
    @EventListener
    public void handleOrderEvent(OrderEvent event) {
        threadContext.set("processing-" + Thread.currentThread().getName());
        // å¤„ç†ä¸šåŠ¡é€»è¾‘
        threadContext.remove();  // æ¸…ç†ThreadLocal
    }
}
```

### 8.4 äº‹åŠ¡è¾¹ç•Œé—®é¢˜


**ğŸ” äº‹åŠ¡è¾¹ç•Œç†è§£**
```
ä¸»çº¿ç¨‹äº‹åŠ¡ï¼š
å¼€å§‹äº‹åŠ¡ â†’ ä¿å­˜ç”¨æˆ· â†’ å‘å¸ƒäº‹ä»¶ â†’ æäº¤äº‹åŠ¡

å¼‚æ­¥çº¿ç¨‹ï¼š
æ¥æ”¶äº‹ä»¶ â†’ å¼€å§‹æ–°äº‹åŠ¡ â†’ å¤„ç†é€»è¾‘ â†’ æäº¤æ–°äº‹åŠ¡

å…³é”®ç‚¹ï¼šå¼‚æ­¥äº‹ä»¶å¤„ç†è¿è¡Œåœ¨ç‹¬ç«‹çš„äº‹åŠ¡ä¸­ï¼
```

**âŒ äº‹åŠ¡è¾¹ç•Œé—®é¢˜**
```java
@Service
public class UserService {
    
    @Transactional
    public void registerUser(User user) {
        userRepository.save(user);
        
        // å‘å¸ƒå¼‚æ­¥äº‹ä»¶
        eventPublisher.publishEvent(new UserRegisteredEvent(user));
        
        // å¦‚æœè¿™é‡ŒæŠ›å¼‚å¸¸ï¼Œä¸»äº‹åŠ¡å›æ»š
        // ä½†å¼‚æ­¥äº‹ä»¶å¯èƒ½å·²ç»å¼€å§‹å¤„ç†äº†ï¼
        if (someCondition) {
            throw new RuntimeException("Registration failed");
        }
    }
}
```

**âœ… æ­£ç¡®å¤„ç†æ–¹å¼**
```java
@Service
public class UserService {
    
    @Transactional
    public void registerUser(User user) {
        userRepository.save(user);
        // ä¸»äº‹åŠ¡æˆåŠŸæäº¤åå†å‘å¸ƒäº‹ä»¶
    }
    
    // ä½¿ç”¨äº‹åŠ¡äº‹ä»¶ç›‘å¬å™¨
    @TransactionalEventListener(phase = TransactionPhase.AFTER_COMMIT)
    public void handleAfterCommit(UserRegisteredEvent event) {
        // åªæœ‰äº‹åŠ¡æäº¤æˆåŠŸåæ‰æ‰§è¡Œ
        eventPublisher.publishEvent(event);
    }
}
```

---

## 9. ğŸ”’ SpELè¡¨è¾¾å¼å®‰å…¨ä¸æ€§èƒ½


### 9.1 SpELè¡¨è¾¾å¼åŸºç¡€


**ğŸ” ä»€ä¹ˆæ˜¯SpEL**
```
SpEL = Spring Expression Languageï¼ˆSpringè¡¨è¾¾å¼è¯­è¨€ï¼‰

ç®€å•ç†è§£ï¼šä¸€ç§åœ¨Springä¸­åŠ¨æ€è®¡ç®—å€¼çš„"å°è¯­è¨€"

ç”Ÿæ´»ç±»æ¯”ï¼š
å°±åƒExcelå…¬å¼ï¼š=A1+B1*2
SpELè¡¨è¾¾å¼ï¼š#{user.name + ' - ' + user.age}
```

### 9.2 å¸¸è§SpELä½¿ç”¨åœºæ™¯


**ğŸ“ å…¸å‹åº”ç”¨ç¤ºä¾‹**
```java
@Component
public class UserService {
    
    // å±æ€§æ³¨å…¥ä¸­ä½¿ç”¨SpEL
    @Value("#{systemProperties['java.version']}")
    private String javaVersion;
    
    // æ¡ä»¶åˆ¤æ–­
    @ConditionalOnExpression("#{environment['spring.profiles.active'] == 'dev'}")
    @Bean
    public DataSource devDataSource() {
        return new DevDataSource();
    }
    
    // ç¼“å­˜keyåŠ¨æ€ç”Ÿæˆ
    @Cacheable(value = "users", key = "#{#user.id + '-' + #user.department}")
    public User findUser(User user) {
        return userRepository.findById(user.getId());
    }
}
```

### 9.3 SpELå®‰å…¨æ€§é—®é¢˜


**âš ï¸ å®‰å…¨é£é™©ç¤ºä¾‹**
```java
@RestController
public class UserController {
    
    // âŒ å±é™©ï¼šç›´æ¥ä½¿ç”¨ç”¨æˆ·è¾“å…¥æ„é€ SpELè¡¨è¾¾å¼
    @GetMapping("/search")
    public List<User> searchUsers(@RequestParam String filter) {
        // ç”¨æˆ·å¯èƒ½è¾“å…¥æ¶æ„SpELè¡¨è¾¾å¼
        String expression = "#{userService.findByCondition('" + filter + "')}";
        
        SpelExpressionParser parser = new SpelExpressionParser();
        Expression exp = parser.parseExpression(expression);
        
        // æ¶æ„ç”¨æˆ·å¯èƒ½è¾“å…¥ï¼š
        // ')} + T(java.lang.System).exit(1) + #{''
        // å¯¼è‡´ç³»ç»Ÿè¢«æ”»å‡»ï¼
        return (List<User>) exp.getValue();
    }
}
```

**âœ… å®‰å…¨é˜²æŠ¤æªæ–½**
```java
@RestController
public class UserController {
    
    // âœ… å®‰å…¨ï¼šé¢„å®šä¹‰è¡¨è¾¾å¼æ¨¡æ¿
    private static final String SEARCH_EXPRESSION = "#{userService.findByName(#filterName)}";
    
    @GetMapping("/search")
    public List<User> searchUsers(@RequestParam String filterName) {
        SpelExpressionParser parser = new SpelExpressionParser();
        Expression exp = parser.parseExpression(SEARCH_EXPRESSION);
        
        // ä½¿ç”¨æ ‡å‡†ä¸Šä¸‹æ–‡ï¼Œé™åˆ¶å¯è®¿é—®çš„å¯¹è±¡å’Œæ–¹æ³•
        StandardEvaluationContext context = new StandardEvaluationContext();
        context.setVariable("filterName", filterName);  // åªå…è®¸è®¿é—®é¢„å®šä¹‰å˜é‡
        
        return (List<User>) exp.getValue(context);
    }
}
```

### 9.4 SpELæ€§èƒ½ä¼˜åŒ–


**âš¡ æ€§èƒ½é—®é¢˜åˆ†æ**
```java
@Service
public class OrderService {
    
    // âŒ æ€§èƒ½é—®é¢˜ï¼šæ¯æ¬¡éƒ½é‡æ–°è§£æè¡¨è¾¾å¼
    public void processOrder(Order order) {
        SpelExpressionParser parser = new SpelExpressionParser();
        
        for (OrderItem item : order.getItems()) {
            String expression = "#{item.price * item.quantity * 1.1}";
            Expression exp = parser.parseExpression(expression);  // é‡å¤è§£æ
            Double total = exp.getValue(Double.class);
        }
    }
}
```

**âœ… æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ**
```java
@Service
public class OrderService {
    
    // é¢„ç¼–è¯‘è¡¨è¾¾å¼ï¼Œé¿å…é‡å¤è§£æ
    private static final SpelExpressionParser PARSER = new SpelExpressionParser();
    private static final Expression TOTAL_EXPRESSION = 
        PARSER.parseExpression("#{item.price * item.quantity * taxRate}");
    
    public void processOrder(Order order) {
        StandardEvaluationContext context = new StandardEvaluationContext();
        context.setVariable("taxRate", 1.1);
        
        for (OrderItem item : order.getItems()) {
            context.setVariable("item", item);
            Double total = TOTAL_EXPRESSION.getValue(context, Double.class);
        }
    }
}
```

### 9.5 SpELæœ€ä½³å®è·µ


**ğŸ“‹ ä½¿ç”¨å»ºè®®**
```
æ€§èƒ½ä¼˜åŒ–ï¼š
âœ… é¢„ç¼–è¯‘å¸¸ç”¨è¡¨è¾¾å¼
âœ… ç¼“å­˜SpelExpressionParserå®ä¾‹
âœ… é‡ç”¨EvaluationContext

å®‰å…¨è€ƒè™‘ï¼š
âœ… æ°¸è¿œä¸è¦ç›´æ¥ä½¿ç”¨ç”¨æˆ·è¾“å…¥æ„é€ SpELè¡¨è¾¾å¼
âœ… ä½¿ç”¨SimpleEvaluationContexté™åˆ¶è®¿é—®æƒé™
âœ… å®šä¹‰è¡¨è¾¾å¼ç™½åå•

å¯ç»´æŠ¤æ€§ï¼š
âœ… å¤æ‚è¡¨è¾¾å¼æå–ä¸ºå¸¸é‡
âœ… æ·»åŠ è¯¦ç»†æ³¨é‡Šè¯´æ˜è¡¨è¾¾å¼ç”¨é€”
âœ… ç¼–å†™å•å…ƒæµ‹è¯•éªŒè¯è¡¨è¾¾å¼è¡Œä¸º
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„å…³é”®æ¦‚å¿µ


```
ğŸ”¸ AOPè‡ªè°ƒç”¨å¤±æ•ˆï¼šå†…éƒ¨è°ƒç”¨è·³è¿‡ä»£ç†ï¼Œå¢å¼ºåŠŸèƒ½ä¸ç”Ÿæ•ˆ
ğŸ”¸ CGLIBä»£ç†é™åˆ¶ï¼šfinalæ–¹æ³•å’Œç±»æ— æ³•è¢«ä»£ç†
ğŸ”¸ proxyBeanMethodsï¼šæ§åˆ¶@Beanæ–¹æ³•æ˜¯å¦è¢«ä»£ç†
ğŸ”¸ å¾ªç¯ä¾èµ–ï¼šç›¸äº’ä¾èµ–çš„Beanåˆ›å»ºå›°éš¾
ğŸ”¸ é…ç½®åŠ è½½é¡ºåºï¼šååŠ è½½çš„é…ç½®è¦†ç›–å…ˆåŠ è½½çš„é…ç½®
ğŸ”¸ èµ„æºè·¯å¾„åŒ¹é…ï¼šclasspathå’Œclasspath*çš„åŒ¹é…å·®å¼‚
ğŸ”¸ å¼‚æ­¥äº‹ä»¶å¤„ç†ï¼šçº¿ç¨‹å®‰å…¨å’Œäº‹åŠ¡è¾¹ç•Œé—®é¢˜
ğŸ”¸ SpELè¡¨è¾¾å¼ï¼šå®‰å…¨æ€§å’Œæ€§èƒ½è€ƒè™‘
```

### 10.2 å®é™…å¼€å‘å»ºè®®


**ğŸ¯ æœ€ä½³å®è·µchecklist**
```
ä¾èµ–æ³¨å…¥ï¼š
âœ… ä¼˜å…ˆä½¿ç”¨æ„é€ å™¨æ³¨å…¥
âœ… é¿å…è¿‡åº¦å­—æ®µæ³¨å…¥
âœ… åˆç†è®¾è®¡é¿å…å¾ªç¯ä¾èµ–

AOPä½¿ç”¨ï¼š
âœ… äº†è§£è‡ªè°ƒç”¨å¤±æ•ˆé—®é¢˜
âœ… é¿å…åœ¨finalæ–¹æ³•ä¸Šä½¿ç”¨AOPæ³¨è§£
âœ… åˆç†é€‰æ‹©JDKä»£ç†vs CGLIBä»£ç†

é…ç½®ç®¡ç†ï¼š
âœ… ç†è§£é…ç½®åŠ è½½ä¼˜å…ˆçº§
âœ… æ­£ç¡®ä½¿ç”¨@PropertySource
âœ… åˆç†ä½¿ç”¨proxyBeanMethods

äº‹ä»¶å¤„ç†ï¼š
âœ… æ³¨æ„å¼‚æ­¥äº‹ä»¶çš„çº¿ç¨‹å®‰å…¨
âœ… æ­£ç¡®å¤„ç†äº‹åŠ¡è¾¹ç•Œ
âœ… ä½¿ç”¨@TransactionalEventListener

è¡¨è¾¾å¼å®‰å…¨ï¼š
âœ… æ°¸è¿œä¸è¦ä¿¡ä»»ç”¨æˆ·è¾“å…¥çš„SpELè¡¨è¾¾å¼
âœ… é¢„ç¼–è¯‘å¸¸ç”¨è¡¨è¾¾å¼æå‡æ€§èƒ½
âœ… ä½¿ç”¨å—é™çš„EvaluationContext
```

### 10.3 å¸¸è§é—®é¢˜æ’æŸ¥


**ğŸ” é—®é¢˜æ’æŸ¥æŒ‡å—**
```
é—®é¢˜1ï¼šAOPæ³¨è§£ä¸ç”Ÿæ•ˆ
â†’ æ£€æŸ¥æ˜¯å¦ä¸ºè‡ªè°ƒç”¨
â†’ æ£€æŸ¥æ–¹æ³•æ˜¯å¦ä¸ºfinal
â†’ æ£€æŸ¥æ˜¯å¦æ­£ç¡®é…ç½®äº†ä»£ç†

é—®é¢˜2ï¼šé…ç½®å±æ€§è·å–ä¸åˆ°
â†’ æ£€æŸ¥é…ç½®æ–‡ä»¶åŠ è½½é¡ºåº
â†’ æ£€æŸ¥å±æ€§åæ‹¼å†™æ˜¯å¦æ­£ç¡®
â†’ æ£€æŸ¥@PropertySourceè·¯å¾„æ˜¯å¦æ­£ç¡®

é—®é¢˜3ï¼šå¼‚æ­¥äº‹ä»¶å¤„ç†å¼‚å¸¸
â†’ æ£€æŸ¥çº¿ç¨‹å®‰å…¨é—®é¢˜
â†’ æ£€æŸ¥äº‹åŠ¡è¾¹ç•Œå¤„ç†
â†’ æ£€æŸ¥å¼‚å¸¸å¤„ç†æœºåˆ¶

é—®é¢˜4ï¼šåº”ç”¨å¯åŠ¨ç¼“æ…¢
â†’ æ£€æŸ¥æ˜¯å¦è¿‡åº¦ä½¿ç”¨Fullæ¨¡å¼é…ç½®
â†’ æ£€æŸ¥SpELè¡¨è¾¾å¼å¤æ‚åº¦
â†’ æ£€æŸ¥Beanä¾èµ–å…³ç³»å¤æ‚åº¦
```

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- Springèµ„æºç®¡ç†æ˜¯ä¸ª"æ™ºèƒ½ç®¡å®¶"ï¼Œå¸®ä½ ç®¡ç†Beanå’Œé…ç½®
- ä»£ç†æœºåˆ¶æœ‰é™åˆ¶ï¼Œè‡ªè°ƒç”¨å’Œfinalæ–¹æ³•è¦æ³¨æ„
- é…ç½®æœ‰ä¼˜å…ˆçº§ï¼ŒååŠ è½½çš„ä¼šè¦†ç›–å…ˆåŠ è½½çš„
- å¼‚æ­¥å¤„ç†è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨å’Œäº‹åŠ¡è¾¹ç•Œ
- SpELè¡¨è¾¾å¼åŠŸèƒ½å¼ºå¤§ä½†è¦æ³¨æ„å®‰å…¨æ€§å’Œæ€§èƒ½