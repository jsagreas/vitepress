---
title: 10ã€MessageSourceæ¶ˆæ¯æº
---
## ğŸ“š ç›®å½•


1. [MessageSourceåŸºç¡€æ¦‚å¿µ](#1-messagesourceåŸºç¡€æ¦‚å¿µ)
2. [å›½é™…åŒ–i18nå®ç°åŸç†](#2-å›½é™…åŒ–i18nå®ç°åŸç†)
3. [æ¶ˆæ¯å‚æ•°åŒ–é…ç½®](#3-æ¶ˆæ¯å‚æ•°åŒ–é…ç½®)
4. [æ¶ˆæ¯ç»§æ‰¿æœºåˆ¶](#4-æ¶ˆæ¯ç»§æ‰¿æœºåˆ¶)
5. [ç¼“å­˜ç­–ç•¥ä¼˜åŒ–](#5-ç¼“å­˜ç­–ç•¥ä¼˜åŒ–)
6. [ç¼–ç å¤„ç†æ–¹æ¡ˆ](#6-ç¼–ç å¤„ç†æ–¹æ¡ˆ)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

# ğŸ¯ **å­¦ä¹ å¯¼èˆª**


**å‰ç½®çŸ¥è¯†**ï¼šéœ€è¦äº†è§£Spring IoCå®¹å™¨ã€Propertiesé…ç½®æ–‡ä»¶ â†’ **å½“å‰å†…å®¹**ï¼šMessageSourceå›½é™…åŒ– â†’ **åç»­å­¦ä¹ **ï¼šSpringå›½é™…åŒ–æ‹¦æˆªå™¨

â±ï¸ **é¢„è®¡å­¦ä¹ æ—¶é—´**ï¼šæœ¬ç« é¢„è®¡45åˆ†é’Ÿ | å®è·µ30åˆ†é’Ÿ

---

## 1. ğŸŒ MessageSourceåŸºç¡€æ¦‚å¿µ



### 1.1 ä»€ä¹ˆæ˜¯MessageSource



**ğŸ”¸ é€šä¿—ç†è§£**
æƒ³è±¡ä½ å¼€å‘äº†ä¸€ä¸ªç½‘ç«™ï¼Œéœ€è¦æ”¯æŒä¸­æ–‡ã€è‹±æ–‡ã€æ—¥æ–‡ä¸‰ç§è¯­è¨€ï¼š
- **ä¼ ç»Ÿæ–¹å¼**ï¼šåœ¨ä»£ç é‡Œå†™æ­»"æ¬¢è¿å…‰ä¸´"ã€"Welcome"ã€"ã‚ˆã†ã“ã"ï¼Œè¦æ”¹å°±å¾—æ”¹ä»£ç 
- **MessageSourceæ–¹å¼**ï¼šæŠŠæ‰€æœ‰æ–‡å­—æ”¾åœ¨é…ç½®æ–‡ä»¶é‡Œï¼Œç¨‹åºè‡ªåŠ¨æ ¹æ®ç”¨æˆ·è¯­è¨€é€‰æ‹©å¯¹åº”æ–‡å­—

**MessageSourceå°±æ˜¯Springæä¾›çš„"å¤šè¯­è¨€ç¿»è¯‘å®˜"** - å®ƒå¸®ä½ ç®¡ç†ä¸åŒè¯­è¨€çš„æ–‡æœ¬å†…å®¹ã€‚

### 1.2 MessageSourceæ ¸å¿ƒä½œç”¨



```
ğŸ”¹ ç»Ÿä¸€ç®¡ç†æ–‡æœ¬ï¼šæ‰€æœ‰æ˜¾ç¤ºç»™ç”¨æˆ·çš„æ–‡å­—éƒ½é›†ä¸­ç®¡ç†
ğŸ”¹ è‡ªåŠ¨è¯­è¨€åˆ‡æ¢ï¼šæ ¹æ®ç”¨æˆ·è¯­è¨€ç¯å¢ƒè‡ªåŠ¨é€‰æ‹©å¯¹åº”æ–‡æœ¬
ğŸ”¹ å‚æ•°åŒ–æ¶ˆæ¯ï¼šæ”¯æŒåŠ¨æ€å†…å®¹æ›¿æ¢ï¼Œå¦‚"æ¬¢è¿{0}ç™»å½•"
ğŸ”¹ æ¶ˆæ¯å¤ç”¨ï¼šé€šè¿‡ç»§æ‰¿æœºåˆ¶é¿å…é‡å¤é…ç½®
```

### 1.3 MessageSourceæ¥å£ä½“ç³»



**ğŸ“‹ æ ¸å¿ƒæ¥å£**
```java
// Springçš„æ¶ˆæ¯æºé¡¶å±‚æ¥å£
public interface MessageSource {
    // è·å–æ¶ˆæ¯çš„æ ¸å¿ƒæ–¹æ³•
    String getMessage(String code, Object[] args, Locale locale);
    
    // å¸¦é»˜è®¤å€¼çš„è·å–æ–¹æ³•
    String getMessage(String code, Object[] args, 
                     String defaultMessage, Locale locale);
}
```

**ğŸ’¡ æ¥å£æ–¹æ³•è§£é‡Š**
- **code**ï¼šæ¶ˆæ¯çš„å”¯ä¸€æ ‡è¯†ï¼Œåƒ"welcome.message"
- **args**ï¼šè¦å¡«å……åˆ°æ¶ˆæ¯é‡Œçš„åŠ¨æ€å‚æ•°ï¼Œå¦‚ç”¨æˆ·å
- **locale**ï¼šè¯­è¨€ç¯å¢ƒï¼Œå†³å®šç”¨ä¸­æ–‡è¿˜æ˜¯è‹±æ–‡
- **defaultMessage**ï¼šæ‰¾ä¸åˆ°æ¶ˆæ¯æ—¶çš„å¤‡ç”¨æ–‡æœ¬

### 1.4 ä¸‰ç§å¸¸ç”¨å®ç°ç±»



| **å®ç°ç±»** | **ç‰¹ç‚¹** | **é€‚ç”¨åœºæ™¯** | **æ¨èåº¦** |
|-----------|---------|-------------|-----------|
| **ResourceBundleMessageSource** | åŸºäºJDKçš„ResourceBundle | ç®€å•åœºæ™¯ | â­â­â­ |
| **ReloadableResourceBundleMessageSource** | æ”¯æŒçƒ­é‡è½½ | å¼€å‘é˜¶æ®µ | â­â­â­â­ |
| **StaticMessageSource** | å†…å­˜ä¸­ç®¡ç† | æµ‹è¯•ç¯å¢ƒ | â­â­ |

---

## 2. ğŸŒ å›½é™…åŒ–i18nå®ç°åŸç†



### 2.1 ä»€ä¹ˆæ˜¯å›½é™…åŒ–i18n



**ğŸ”¸ i18nå«ä¹‰è§£é‡Š**
- **å…¨ç§°**ï¼šInternationalizationï¼ˆå›½é™…åŒ–ï¼‰
- **ä¸ºä»€ä¹ˆå«i18n**ï¼šå› ä¸ºInternationalizationè¿™ä¸ªå•è¯ï¼Œiå’Œnä¹‹é—´æœ‰18ä¸ªå­—æ¯
- **ä½œç”¨**ï¼šè®©ç¨‹åºèƒ½å¤Ÿé€‚é…ä¸åŒå›½å®¶å’Œåœ°åŒºçš„è¯­è¨€ä¹ æƒ¯

**ğŸ’¡ ç”Ÿæ´»ç±»æ¯”**
å°±åƒéº¦å½“åŠ³åœ¨ä¸­å›½å«"éº¦å½“åŠ³"ï¼Œåœ¨ç¾å›½å«"McDonald's"ï¼Œåœ¨æ—¥æœ¬å«"ãƒã‚¯ãƒ‰ãƒŠãƒ«ãƒ‰" - åŒæ ·çš„ä¸œè¥¿ï¼Œä¸åŒåœ°åŒºç”¨ä¸åŒåå­—ã€‚

### 2.2 å›½é™…åŒ–å·¥ä½œæµç¨‹



**ğŸ“Š å®ç°æµç¨‹å›¾**
```
ç”¨æˆ·è®¿é—®
   â†“
è·å–ç”¨æˆ·è¯­è¨€ç¯å¢ƒ(Locale)
   â†“
æ ¹æ®Localeé€‰æ‹©å¯¹åº”é…ç½®æ–‡ä»¶
   â†“
ä»é…ç½®æ–‡ä»¶è¯»å–æ¶ˆæ¯
   â†“
å±•ç¤ºç»™ç”¨æˆ·
```

### 2.3 Localeè¯­è¨€ç¯å¢ƒ



**ğŸŒ Localeæ ¸å¿ƒæ¦‚å¿µ**
```java
// Localeç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šè¯­è¨€ + å›½å®¶/åœ°åŒº
Locale zhCN = new Locale("zh", "CN");  // ç®€ä½“ä¸­æ–‡-ä¸­å›½
Locale enUS = new Locale("en", "US");  // è‹±è¯­-ç¾å›½
Locale jaJP = new Locale("ja", "JP");  // æ—¥è¯­-æ—¥æœ¬

// ä¹Ÿå¯ä»¥ç”¨é¢„å®šä¹‰å¸¸é‡
Locale.CHINA           // zh_CN
Locale.US              // en_US
Locale.JAPAN           // ja_JP
```

**ğŸ’¡ Localeå‘½åè§„åˆ™**
- **è¯­è¨€ä»£ç **ï¼šå°å†™çš„ISO 639ä»£ç ï¼Œå¦‚zh(ä¸­æ–‡)ã€en(è‹±æ–‡)
- **å›½å®¶ä»£ç **ï¼šå¤§å†™çš„ISO 3166ä»£ç ï¼Œå¦‚CN(ä¸­å›½)ã€US(ç¾å›½)
- **ç»„åˆæ ¼å¼**ï¼šè¯­è¨€_å›½å®¶ï¼Œå¦‚zh_CNã€en_US

### 2.4 é…ç½®æ–‡ä»¶å‘½åè§„èŒƒ



**ğŸ“ èµ„æºæ–‡ä»¶å‘½åæ¨¡å¼**
```
messages.properties           # é»˜è®¤é…ç½®(æ‰¾ä¸åˆ°å…¶ä»–æ—¶ç”¨è¿™ä¸ª)
messages_zh_CN.properties     # ç®€ä½“ä¸­æ–‡
messages_en_US.properties     # ç¾å¼è‹±è¯­
messages_ja_JP.properties     # æ—¥è¯­
```

**ğŸ” æŸ¥æ‰¾ä¼˜å…ˆçº§**
```
å‡è®¾ç”¨æˆ·Localeæ˜¯zh_CNï¼š
1. å…ˆæ‰¾ messages_zh_CN.properties  â† æœ€ä¼˜å…ˆ
2. æ‰¾ä¸åˆ°åˆ™æ‰¾ messages_zh.properties
3. è¿˜æ‰¾ä¸åˆ°å°±ç”¨ messages.properties  â† å…œåº•æ–¹æ¡ˆ
```

### 2.5 å®Œæ•´é…ç½®ç¤ºä¾‹



**ğŸ“ åˆ›å»ºé…ç½®æ–‡ä»¶**
```properties
# messages_zh_CN.properties (ä¸­æ–‡)

welcome.message=æ¬¢è¿å…‰ä¸´
login.success=ç™»å½•æˆåŠŸ
user.greeting=ä½ å¥½ï¼Œ{0}ï¼

# messages_en_US.properties (è‹±æ–‡)

welcome.message=Welcome
login.success=Login Success
user.greeting=Hello, {0}!
```

**ğŸ”§ Springé…ç½®**
```java
@Configuration
public class MessageConfig {
    
    @Bean
    public MessageSource messageSource() {
        ResourceBundleMessageSource source = 
            new ResourceBundleMessageSource();
        
        // è®¾ç½®é…ç½®æ–‡ä»¶åŸºç¡€å(ä¸å«è¯­è¨€åç¼€)
        source.setBasename("messages");
        
        // è®¾ç½®ç¼–ç ï¼Œé˜²æ­¢ä¸­æ–‡ä¹±ç 
        source.setDefaultEncoding("UTF-8");
        
        return source;
    }
}
```

**ğŸ’» ä½¿ç”¨ç¤ºä¾‹**
```java
@Service
public class WelcomeService {
    
    @Autowired
    private MessageSource messageSource;
    
    public String getWelcome(String username, Locale locale) {
        // è·å–æ¬¢è¿æ¶ˆæ¯
        String welcome = messageSource.getMessage(
            "welcome.message",  // æ¶ˆæ¯key
            null,               // æ— å‚æ•°
            locale              // è¯­è¨€ç¯å¢ƒ
        );
        
        // è·å–å¸¦å‚æ•°çš„é—®å€™æ¶ˆæ¯
        String greeting = messageSource.getMessage(
            "user.greeting",
            new Object[]{username},  // ä¼ å…¥ç”¨æˆ·åå‚æ•°
            locale
        );
        
        return welcome + " " + greeting;
    }
}
```

---

## 3. ğŸ”¤ æ¶ˆæ¯å‚æ•°åŒ–é…ç½®



### 3.1 ä¸ºä»€ä¹ˆéœ€è¦å‚æ•°åŒ–



**ğŸ¤” é—®é¢˜åœºæ™¯**
å¦‚æœä¸ç”¨å‚æ•°åŒ–ï¼Œä½ éœ€è¦ä¸ºæ¯ä¸ªç”¨æˆ·å†™ä¸€æ¡æ¶ˆæ¯ï¼š
```properties
# è¿™æ ·å†™å¤ªè ¢äº†

welcome.zhangsan=æ¬¢è¿å¼ ä¸‰ï¼
welcome.lisi=æ¬¢è¿æå››ï¼
welcome.wangwu=æ¬¢è¿ç‹äº”ï¼
# ... æœ‰å¤šå°‘ç”¨æˆ·å°±è¦å†™å¤šå°‘æ¡

```

**âœ… å‚æ•°åŒ–è§£å†³æ–¹æ¡ˆ**
```properties
# åªéœ€è¦ä¸€æ¡é…ç½®

user.welcome=æ¬¢è¿{0}ï¼
```

### 3.2 å‚æ•°å ä½ç¬¦è¯­æ³•



**ğŸ“‹ å ä½ç¬¦è§„åˆ™**
```properties
# {æ•°å­—} è¡¨ç¤ºå‚æ•°ä½ç½®ï¼Œä»0å¼€å§‹


# å•ä¸ªå‚æ•°

message.one=æ¬¢è¿{0}ç™»å½•ç³»ç»Ÿ

# å¤šä¸ªå‚æ•°

message.two={0}åœ¨{1}è´­ä¹°äº†{2}ä»¶å•†å“

# å‚æ•°å¯ä»¥é‡å¤ä½¿ç”¨

message.repeat={0}ä½ å¥½ï¼{0}æ˜¯ä¼šå‘˜å—ï¼Ÿ
```

**ğŸ’» Javaä»£ç ä½¿ç”¨**
```java
// å•å‚æ•°ç¤ºä¾‹
String msg1 = messageSource.getMessage(
    "message.one",
    new Object[]{"å¼ ä¸‰"},  // å‚æ•°æ•°ç»„
    locale
);
// ç»“æœï¼šæ¬¢è¿å¼ ä¸‰ç™»å½•ç³»ç»Ÿ

// å¤šå‚æ•°ç¤ºä¾‹
String msg2 = messageSource.getMessage(
    "message.two",
    new Object[]{"æå››", "2024-09-24", 3},
    locale
);
// ç»“æœï¼šæå››åœ¨2024-09-24è´­ä¹°äº†3ä»¶å•†å“
```

### 3.3 é«˜çº§å‚æ•°æ ¼å¼åŒ–



**ğŸ¨ æ ¼å¼åŒ–é€‰é¡¹**
```properties
# æ—¥æœŸæ ¼å¼åŒ–

order.time=è®¢å•æ—¶é—´ï¼š{0,date,yyyy-MM-dd HH:mm:ss}

# æ•°å­—æ ¼å¼åŒ–

product.price=å•†å“ä»·æ ¼ï¼š{0,number,#.00}å…ƒ

# ç™¾åˆ†æ¯”æ ¼å¼åŒ–

discount.rate=æŠ˜æ‰£ï¼š{0,number,percent}

# è´§å¸æ ¼å¼åŒ–

total.amount=æ€»é‡‘é¢ï¼š{0,number,currency}
```

**ğŸ’¡ æ ¼å¼åŒ–ä»£ç ç¤ºä¾‹**
```java
// æ—¥æœŸå‚æ•°
String orderMsg = messageSource.getMessage(
    "order.time",
    new Object[]{new Date()},
    locale
);

// æ•°å­—å‚æ•°
String priceMsg = messageSource.getMessage(
    "product.price",
    new Object[]{99.5},
    locale
);

// ç™¾åˆ†æ¯”å‚æ•°
String discountMsg = messageSource.getMessage(
    "discount.rate",
    new Object[]{0.15},  // 15%
    locale
);
```

### 3.4 æ¡ä»¶é€‰æ‹©å‚æ•°



**ğŸ”€ Choiceæ ¼å¼**
```properties
# æ ¹æ®æ•°é‡æ˜¾ç¤ºä¸åŒæ–‡æœ¬

cart.items={0,choice,0#è´­ç‰©è½¦æ˜¯ç©ºçš„|1#è´­ç‰©è½¦æœ‰1ä»¶å•†å“|1<è´­ç‰©è½¦æœ‰{0}ä»¶å•†å“}
```

**ğŸ“– Choiceè¯­æ³•è¯´æ˜**
```
{å‚æ•°ä½ç½®,choice,æ¡ä»¶1#æ–‡æœ¬1|æ¡ä»¶2#æ–‡æœ¬2|...}

æ¡ä»¶æ ¼å¼ï¼š
- æ•°å­—#    è¡¨ç¤ºç­‰äºè¯¥æ•°å­—
- æ•°å­—<    è¡¨ç¤ºå¤§äºè¯¥æ•°å­—
- æ•°å­—â‰¤    è¡¨ç¤ºå°äºç­‰äº(ç”¨<=è¡¨ç¤º)
```

**ğŸ’» ä½¿ç”¨ç¤ºä¾‹**
```java
// 0ä»¶å•†å“
String msg0 = messageSource.getMessage(
    "cart.items", 
    new Object[]{0}, 
    locale
);
// ç»“æœï¼šè´­ç‰©è½¦æ˜¯ç©ºçš„

// 1ä»¶å•†å“
String msg1 = messageSource.getMessage(
    "cart.items",
    new Object[]{1},
    locale
);
// ç»“æœï¼šè´­ç‰©è½¦æœ‰1ä»¶å•†å“

// 5ä»¶å•†å“
String msg5 = messageSource.getMessage(
    "cart.items",
    new Object[]{5},
    locale
);
// ç»“æœï¼šè´­ç‰©è½¦æœ‰5ä»¶å•†å“
```

---

## 4. ğŸ”— æ¶ˆæ¯ç»§æ‰¿æœºåˆ¶



### 4.1 ä»€ä¹ˆæ˜¯æ¶ˆæ¯ç»§æ‰¿



**ğŸ”¸ ç»§æ‰¿æ¦‚å¿µè§£é‡Š**
å°±åƒå®¶æ—ç»§æ‰¿é—äº§ï¼Œå­é…ç½®æ–‡ä»¶å¯ä»¥ç»§æ‰¿çˆ¶é…ç½®æ–‡ä»¶çš„å†…å®¹ï¼Œé¿å…é‡å¤ç¼–å†™ç›¸åŒçš„é…ç½®ã€‚

**ğŸ’¡ å®é™…åœºæ™¯**
```
å‡è®¾ä½ æœ‰ä¸€ä¸ªç”µå•†ç½‘ç«™ï¼š
- æ‰€æœ‰é¡µé¢éƒ½ç”¨"ç™»å½•"ã€"é€€å‡º"ç­‰é€šç”¨è¯æ±‡
- ä½†æ¯ä¸ªå›½å®¶çš„è´§å¸ç¬¦å·ä¸åŒ

ä½¿ç”¨ç»§æ‰¿ï¼š
- é€šç”¨è¯æ±‡å†™åœ¨çˆ¶æ–‡ä»¶
- ç‰¹æ®Šå†…å®¹å†™åœ¨å­æ–‡ä»¶
```

### 4.2 é…ç½®æ–‡ä»¶å±‚çº§ç»“æ„



**ğŸ“ æ–‡ä»¶ç»„ç»‡ç¤ºä¾‹**
```
resources/
  i18n/
    common.properties          # å…¬å…±é…ç½®(çˆ¶)
    common_zh_CN.properties    # ä¸­æ–‡å…¬å…±é…ç½®
    common_en_US.properties    # è‹±æ–‡å…¬å…±é…ç½®
    
    business.properties        # ä¸šåŠ¡é…ç½®(å¯ä»¥ç»§æ‰¿common)
    business_zh_CN.properties
    business_en_US.properties
```

### 4.3 ç»§æ‰¿é…ç½®å®ç°



**ğŸ”§ Springé…ç½®å¤šä¸ªæ¶ˆæ¯æº**
```java
@Configuration
public class MessageConfig {
    
    @Bean
    public MessageSource messageSource() {
        ResourceBundleMessageSource source = 
            new ResourceBundleMessageSource();
        
        // è®¾ç½®å¤šä¸ªé…ç½®æ–‡ä»¶ï¼Œåé¢çš„å¯ä»¥è¦†ç›–å‰é¢çš„
        source.setBasenames(
            "i18n/common",      // åŸºç¡€é…ç½®
            "i18n/business"     // ä¸šåŠ¡é…ç½®(ä¼šç»§æ‰¿commonçš„å†…å®¹)
        );
        
        source.setDefaultEncoding("UTF-8");
        return source;
    }
}
```

**ğŸ“ é…ç½®æ–‡ä»¶å†…å®¹**
```properties
# common_zh_CN.properties (å…¬å…±ä¸­æ–‡)

button.login=ç™»å½•
button.logout=é€€å‡º
button.submit=æäº¤

# business_zh_CN.properties (ä¸šåŠ¡ä¸­æ–‡)

# è¿™é‡Œå¯ä»¥ç›´æ¥ç”¨commoné‡Œçš„button.loginç­‰

order.submit=ç‚¹å‡»{button.submit}å®Œæˆè®¢å•
```

### 4.4 æ¶ˆæ¯è¦†ç›–è§„åˆ™



**ğŸ”„ ä¼˜å…ˆçº§è¯´æ˜**
```
æŸ¥æ‰¾é¡ºåº(ä»é«˜åˆ°ä½)ï¼š
1. ä¸šåŠ¡é…ç½®çš„å½“å‰è¯­è¨€æ–‡ä»¶ (business_zh_CN.properties)
2. ä¸šåŠ¡é…ç½®çš„é»˜è®¤æ–‡ä»¶ (business.properties)
3. å…¬å…±é…ç½®çš„å½“å‰è¯­è¨€æ–‡ä»¶ (common_zh_CN.properties)
4. å…¬å…±é…ç½®çš„é»˜è®¤æ–‡ä»¶ (common.properties)
```

**âš ï¸ æ³¨æ„äº‹é¡¹**
> å¦‚æœbusinessé…ç½®ä¸­å®šä¹‰äº†å’Œcommonç›¸åŒçš„keyï¼Œä¼šè¦†ç›–commonçš„å€¼
> è¿™ä¸ªç‰¹æ€§å¯ä»¥ç”¨æ¥åšç‰¹æ®Šåœºæ™¯çš„å®šåˆ¶

---

## 5. ğŸ’¾ ç¼“å­˜ç­–ç•¥ä¼˜åŒ–



### 5.1 ä¸ºä»€ä¹ˆéœ€è¦ç¼“å­˜



**ğŸ¤” æ€§èƒ½é—®é¢˜**
æ¯æ¬¡è·å–æ¶ˆæ¯éƒ½è¦ï¼š
1. è¯»å–é…ç½®æ–‡ä»¶
2. è§£æpropertiesæ ¼å¼
3. æŸ¥æ‰¾å¯¹åº”keyçš„å€¼

å¦‚æœè®¿é—®é‡å¤§ï¼Œä¼šé€ æˆæ€§èƒ½é—®é¢˜ã€‚

**âœ… ç¼“å­˜è§£å†³æ–¹æ¡ˆ**
æŠŠå·²ç»è¯»å–è¿‡çš„æ¶ˆæ¯ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œä¸‹æ¬¡ç›´æ¥ä»å†…å­˜è·å–ã€‚

### 5.2 ä¸¤ç§å®ç°ç±»çš„ç¼“å­˜å·®å¼‚



| **ç‰¹æ€§** | **ResourceBundleMessageSource** | **ReloadableResourceBundleMessageSource** |
|---------|--------------------------------|------------------------------------------|
| **ç¼“å­˜ç­–ç•¥** | JDKè‡ªå¸¦ç¼“å­˜ï¼Œé‡å¯æ‰æ¸…é™¤ | å¯é…ç½®ç¼“å­˜æ—¶é—´ | 
| **çƒ­é‡è½½** | âŒ ä¸æ”¯æŒ | âœ… æ”¯æŒ |
| **æ€§èƒ½** | â­â­â­â­â­ | â­â­â­â­ |
| **é€‚ç”¨åœºæ™¯** | ç”Ÿäº§ç¯å¢ƒ | å¼€å‘/æµ‹è¯•ç¯å¢ƒ |

### 5.3 é…ç½®å¯é‡è½½çš„æ¶ˆæ¯æº



**ğŸ”§ æ”¯æŒçƒ­é‡è½½çš„é…ç½®**
```java
@Configuration
public class MessageConfig {
    
    @Bean
    public MessageSource messageSource() {
        ReloadableResourceBundleMessageSource source = 
            new ReloadableResourceBundleMessageSource();
        
        // é…ç½®æ–‡ä»¶ä½ç½®(æ”¯æŒclasspathå’Œæ–‡ä»¶ç³»ç»Ÿè·¯å¾„)
        source.setBasename("classpath:i18n/messages");
        source.setDefaultEncoding("UTF-8");
        
        // è®¾ç½®ç¼“å­˜æ—¶é—´ï¼š3600ç§’ = 1å°æ—¶
        // -1è¡¨ç¤ºæ°¸ä¹…ç¼“å­˜ï¼Œ0è¡¨ç¤ºä¸ç¼“å­˜
        source.setCacheSeconds(3600);
        
        return source;
    }
}
```

**ğŸ’¡ ç¼“å­˜æ—¶é—´é€‰æ‹©å»ºè®®**
```
å¼€å‘ç¯å¢ƒï¼šè®¾ç½®ä¸º 0 æˆ–è¾ƒå°å€¼(å¦‚5ç§’)
  - ä¿®æ”¹é…ç½®æ–‡ä»¶åç«‹å³ç”Ÿæ•ˆ
  - æ–¹ä¾¿è°ƒè¯•å’Œæµ‹è¯•

ç”Ÿäº§ç¯å¢ƒï¼šè®¾ç½®ä¸ºè¾ƒå¤§å€¼æˆ–-1
  - å‡å°‘æ–‡ä»¶è¯»å–æ¬¡æ•°
  - æå‡æ€§èƒ½
  - éœ€è¦é‡å¯åº”ç”¨æ‰èƒ½æ›´æ–°æ¶ˆæ¯
```

### 5.4 ç¼“å­˜æ¸…é™¤æœºåˆ¶



**ğŸ§¹ æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜**
```java
@Service
public class MessageCacheService {
    
    @Autowired
    private ReloadableResourceBundleMessageSource messageSource;
    
    // æ¸…é™¤æ‰€æœ‰ç¼“å­˜
    public void clearCache() {
        messageSource.clearCache();
        System.out.println("æ¶ˆæ¯ç¼“å­˜å·²æ¸…é™¤");
    }
    
    // æ¸…é™¤ç‰¹å®šLocaleçš„ç¼“å­˜
    public void clearCacheForLocale(Locale locale) {
        messageSource.clearCacheIncludingAncestors();
        System.out.println("å·²æ¸…é™¤" + locale + "çš„æ¶ˆæ¯ç¼“å­˜");
    }
}
```

---

## 6. ğŸ”¤ ç¼–ç å¤„ç†æ–¹æ¡ˆ



### 6.1 ä¸ºä»€ä¹ˆä¼šæœ‰ä¹±ç é—®é¢˜



**ğŸ¤” ä¹±ç äº§ç”ŸåŸå› **
```
é—®é¢˜é“¾æ¡ï¼š
1. Propertiesæ–‡ä»¶é»˜è®¤ä½¿ç”¨ISO-8859-1ç¼–ç 
2. ISO-8859-1ä¸æ”¯æŒä¸­æ–‡å­—ç¬¦
3. ä¸­æ–‡è¢«é”™è¯¯ç¼–ç åå°±å˜æˆä¹±ç 
```

**ğŸ’¡ ç”Ÿæ´»ç±»æ¯”**
å°±åƒç”¨è‹±æ–‡å­—æ¯è¡¨å»æ‹¼å†™ä¸­æ–‡ï¼Œè‚¯å®šæ‹¼ä¸å‡ºæ¥ - è¿™å°±æ˜¯ç¼–ç ä¸åŒ¹é…å¯¼è‡´çš„é—®é¢˜ã€‚

### 6.2 ç¼–ç é—®é¢˜è§£å†³æ–¹æ¡ˆ



**âœ… æ–¹æ¡ˆ1ï¼šè®¾ç½®é»˜è®¤ç¼–ç (æ¨è)**
```java
@Bean
public MessageSource messageSource() {
    ResourceBundleMessageSource source = 
        new ResourceBundleMessageSource();
    
    source.setBasename("messages");
    
    // è®¾ç½®UTF-8ç¼–ç ï¼Œæ”¯æŒä¸­æ–‡
    source.setDefaultEncoding("UTF-8");
    
    return source;
}
```

**âœ… æ–¹æ¡ˆ2ï¼šä½¿ç”¨native2asciiå·¥å…·è½¬æ¢**
```bash
# JDKè‡ªå¸¦çš„å·¥å…·ï¼ŒæŠŠä¸­æ–‡è½¬æˆunicodeç¼–ç 

native2ascii -encoding UTF-8 messages_zh_CN.properties messages_zh_CN_unicode.properties

# è½¬æ¢åçš„æ–‡ä»¶å†…å®¹ç¤ºä¾‹ï¼š

# welcome=\u6b22\u8fce\u5149\u4e34

# (è¿™æ˜¯"æ¬¢è¿å…‰ä¸´"çš„unicodeç¼–ç )

```

**âš ï¸ ä¸¤ç§æ–¹æ¡ˆå¯¹æ¯”**
| **æ–¹æ¡ˆ** | **ä¼˜ç‚¹** | **ç¼ºç‚¹** | **æ¨èåº¦** |
|---------|---------|---------|-----------|
| **è®¾ç½®UTF-8ç¼–ç ** | é…ç½®ç®€å•ï¼Œæ–‡ä»¶å¯è¯» | éœ€è¦Springæ”¯æŒ | â­â­â­â­â­ |
| **native2asciiè½¬æ¢** | å…¼å®¹æ€§å¥½ | æ–‡ä»¶ä¸å¯è¯»ï¼Œç»´æŠ¤å›°éš¾ | â­â­ |

### 6.3 æ–‡ä»¶ç¼–ç æœ€ä½³å®è·µ



**ğŸ“‹ å®Œæ•´ç¼–ç é…ç½®**
```java
@Configuration
public class MessageConfig {
    
    @Bean
    public MessageSource messageSource() {
        ReloadableResourceBundleMessageSource source = 
            new ReloadableResourceBundleMessageSource();
        
        // 1. è®¾ç½®æ–‡ä»¶è·¯å¾„
        source.setBasename("classpath:i18n/messages");
        
        // 2. è®¾ç½®é»˜è®¤ç¼–ç ä¸ºUTF-8
        source.setDefaultEncoding("UTF-8");
        
        // 3. è®¾ç½®æ–‡ä»¶ç¼–ç (å¤„ç†ä¸åŒç³»ç»Ÿçš„æ–‡ä»¶)
        source.setFallbackToSystemLocale(false);
        
        // 4. ç¼“å­˜é…ç½®
        source.setCacheSeconds(3600);
        
        return source;
    }
}
```

**ğŸ’¡ é…ç½®è§£é‡Š**
- **setDefaultEncoding("UTF-8")**ï¼šæŒ‡å®šè¯»å–propertiesæ–‡ä»¶çš„ç¼–ç 
- **setFallbackToSystemLocale(false)**ï¼šæ‰¾ä¸åˆ°å¯¹åº”è¯­è¨€æ—¶ä¸ä½¿ç”¨ç³»ç»Ÿé»˜è®¤è¯­è¨€ï¼Œè€Œæ˜¯ç”¨é»˜è®¤é…ç½®æ–‡ä»¶

### 6.4 IDEAä¸­æ­£ç¡®åˆ›å»ºé…ç½®æ–‡ä»¶



**ğŸ“ IDEAåˆ›å»ºæ­¥éª¤**
```
1. å³é”®é¡¹ç›® â†’ New â†’ Resource Bundle

2. åœ¨å¼¹å‡ºæ¡†ä¸­è®¾ç½®ï¼š
   - Base name: messages
   - Locales: æ·»åŠ zh_CNã€en_USç­‰

3. IDEAä¼šè‡ªåŠ¨åˆ›å»ºï¼š
   messages.properties
   messages_zh_CN.properties
   messages_en_US.properties

4. ç¡®ä¿æ–‡ä»¶ç¼–ç ä¸ºUTF-8ï¼š
   File â†’ Settings â†’ Editor â†’ File Encodings
   - Global Encoding: UTF-8
   - Project Encoding: UTF-8
   - Properties Files: UTF-8
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“



### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ



```
ğŸ”¸ MessageSourceæœ¬è´¨ï¼šSpringæä¾›çš„å¤šè¯­è¨€æ¶ˆæ¯ç®¡ç†å·¥å…·
ğŸ”¸ å›½é™…åŒ–i18nï¼šè®©ç¨‹åºæ”¯æŒå¤šç§è¯­è¨€çš„æŠ€æœ¯
ğŸ”¸ Localeï¼šè¯­è¨€ç¯å¢ƒæ ‡è¯†ï¼Œå†³å®šç”¨å“ªç§è¯­è¨€
ğŸ”¸ å‚æ•°åŒ–æ¶ˆæ¯ï¼šä½¿ç”¨{0}{1}ç­‰å ä½ç¬¦å®ç°åŠ¨æ€å†…å®¹
ğŸ”¸ æ¶ˆæ¯ç»§æ‰¿ï¼šé€šè¿‡å¤šä¸ªé…ç½®æ–‡ä»¶å®ç°é…ç½®å¤ç”¨
ğŸ”¸ ç¼“å­˜ç­–ç•¥ï¼šæå‡æ€§èƒ½çš„å…³é”®æœºåˆ¶
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹



**ğŸ”¹ é…ç½®æ–‡ä»¶å‘½åè§„åˆ™**
```
æ¨¡å¼ï¼šbasename_è¯­è¨€_å›½å®¶.properties

ç¤ºä¾‹ï¼š
messages.properties          â† å…œåº•é…ç½®
messages_zh.properties       â† æ‰€æœ‰ä¸­æ–‡
messages_zh_CN.properties    â† ç®€ä½“ä¸­æ–‡
messages_zh_TW.properties    â† ç¹ä½“ä¸­æ–‡
messages_en.properties       â† æ‰€æœ‰è‹±æ–‡
messages_en_US.properties    â† ç¾å¼è‹±è¯­
messages_en_GB.properties    â† è‹±å¼è‹±è¯­
```

**ğŸ”¹ ä¸¤ç§å®ç°ç±»çš„é€‰æ‹©**
```
ResourceBundleMessageSourceï¼š
âœ… æ€§èƒ½æ›´å¥½(JDKåŸç”Ÿç¼“å­˜)
âœ… é€‚åˆç”Ÿäº§ç¯å¢ƒ
âŒ ä¸æ”¯æŒçƒ­é‡è½½

ReloadableResourceBundleMessageSourceï¼š
âœ… æ”¯æŒçƒ­é‡è½½
âœ… ç¼“å­˜æ—¶é—´å¯æ§
âœ… é€‚åˆå¼€å‘ç¯å¢ƒ
âŒ æ€§èƒ½ç¨ä½
```

**ğŸ”¹ å‚æ•°åŒ–æ¶ˆæ¯æ ¼å¼**
```
åŸºç¡€å ä½ç¬¦ï¼š{0} {1} {2} ...
æ—¥æœŸæ ¼å¼ï¼š{0,date,yyyy-MM-dd}
æ•°å­—æ ¼å¼ï¼š{0,number,#.00}
è´§å¸æ ¼å¼ï¼š{0,number,currency}
ç™¾åˆ†æ¯”ï¼š{0,number,percent}
æ¡ä»¶é€‰æ‹©ï¼š{0,choice,0#æ–‡æœ¬1|1#æ–‡æœ¬2|1<æ–‡æœ¬3}
```

### 7.3 å®é™…åº”ç”¨åœºæ™¯



**ğŸ¯ ç”µå•†ç½‘ç«™ç¤ºä¾‹**
```properties
# ä¸­æ–‡é…ç½®

product.name=å•†å“åç§°
product.price=ä»·æ ¼ï¼šÂ¥{0,number,#.00}
cart.items={0,choice,0#è´­ç‰©è½¦æ˜¯ç©ºçš„|1#è´­ç‰©è½¦æœ‰1ä»¶å•†å“|1<è´­ç‰©è½¦æœ‰{0}ä»¶å•†å“}
order.success=è®¢å•æäº¤æˆåŠŸï¼è®¢å•å·ï¼š{0}

# è‹±æ–‡é…ç½®

product.name=Product Name
product.price=Price: ${0,number,#.00}
cart.items={0,choice,0#Cart is empty|1#1 item in cart|1<{0} items in cart}
order.success=Order submitted successfully! Order ID: {0}
```

**ğŸ’» Controllerä½¿ç”¨**
```java
@RestController
public class ProductController {
    
    @Autowired
    private MessageSource messageSource;
    
    @GetMapping("/product/{id}")
    public String getProduct(@PathVariable Long id, Locale locale) {
        // è·å–å•†å“ä¿¡æ¯
        Product product = productService.getById(id);
        
        // ä½¿ç”¨å›½é™…åŒ–æ¶ˆæ¯
        String priceMsg = messageSource.getMessage(
            "product.price",
            new Object[]{product.getPrice()},
            locale
        );
        
        return product.getName() + " - " + priceMsg;
    }
    
    @GetMapping("/cart")
    public String getCart(Locale locale) {
        int itemCount = cartService.getItemCount();
        
        return messageSource.getMessage(
            "cart.items",
            new Object[]{itemCount},
            locale
        );
    }
}
```

### 7.4 å­¦ä¹ æ£€æŸ¥æ¸…å•



**ğŸ“ çŸ¥è¯†æŒæ¡è‡ªæŸ¥**
- [ ] ç†è§£MessageSourceçš„ä½œç”¨å’Œå·¥ä½œåŸç†
- [ ] æŒæ¡Localeçš„æ¦‚å¿µå’Œä½¿ç”¨æ–¹æ³•
- [ ] èƒ½å¤Ÿåˆ›å»ºå’Œé…ç½®å›½é™…åŒ–èµ„æºæ–‡ä»¶
- [ ] ä¼šä½¿ç”¨å‚æ•°åŒ–æ¶ˆæ¯å’Œå„ç§æ ¼å¼åŒ–
- [ ] ç†è§£æ¶ˆæ¯ç»§æ‰¿æœºåˆ¶
- [ ] çŸ¥é“å¦‚ä½•é€‰æ‹©åˆé€‚çš„ç¼“å­˜ç­–ç•¥
- [ ] èƒ½å¤Ÿè§£å†³ä¸­æ–‡ä¹±ç é—®é¢˜

**ğŸ¯ å®è·µç»ƒä¹ å»ºè®®**
1. åˆ›å»ºä¸€ä¸ªæ”¯æŒä¸­è‹±æ–‡çš„ç™»å½•é¡µé¢
2. å®ç°è´­ç‰©è½¦çš„å¤šè¯­è¨€æç¤ºæ¶ˆæ¯
3. é…ç½®å¸¦æœ‰æ—¥æœŸå’Œé‡‘é¢æ ¼å¼åŒ–çš„è®¢å•ç¡®è®¤æ¶ˆæ¯
4. å°è¯•ä½¿ç”¨æ¶ˆæ¯ç»§æ‰¿ä¼˜åŒ–é…ç½®æ–‡ä»¶ç»“æ„

**ğŸ”‘ æ ¸å¿ƒè®°å¿†å£è¯€**
> MessageSourceç®¡å›½é™…åŒ–ï¼Œé…ç½®æ–‡ä»¶åˆ†è¯­è¨€
> å ä½ç¬¦å·åšå‚æ•°ï¼Œæ ¼å¼åŒ–å†…å®¹å¾ˆçµæ´»
> ç¼“å­˜ç­–ç•¥ææ€§èƒ½ï¼Œç¼–ç è®¾ç½®é˜²ä¹±ç 
> ç»§æ‰¿å¤ç”¨å‡é‡å¤ï¼Œçƒ­åŠ è½½æ–¹ä¾¿è°ƒè¯•

**ğŸ’¡ å»¶ä¼¸å­¦ä¹ æ–¹å‘**
- Spring MVCä¸­çš„LocaleResolver(è¯­è¨€åˆ‡æ¢)
- å‰åç«¯åˆ†ç¦»é¡¹ç›®çš„å›½é™…åŒ–æ–¹æ¡ˆ
- æ•°æ®åº“å­˜å‚¨çš„åŠ¨æ€å›½é™…åŒ–å†…å®¹
- å›½é™…åŒ–ä¸æ—¶åŒºå¤„ç†çš„ç»“åˆ