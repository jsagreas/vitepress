---
title: 6ã€ResourcePatternResolver
---
## ğŸ“š ç›®å½•

1. [ResourcePatternResolveræ˜¯ä»€ä¹ˆ](#1-ResourcePatternResolveræ˜¯ä»€ä¹ˆ)
2. [ä¸ºä»€ä¹ˆéœ€è¦æ¨¡å¼è§£æå™¨](#2-ä¸ºä»€ä¹ˆéœ€è¦æ¨¡å¼è§£æå™¨)
3. [æ ¸å¿ƒæ¥å£ä¸å®ç°](#3-æ ¸å¿ƒæ¥å£ä¸å®ç°)
4. [è·¯å¾„åŒ¹é…è§„åˆ™è¯¦è§£](#4-è·¯å¾„åŒ¹é…è§„åˆ™è¯¦è§£)
5. [æ‰¹é‡èµ„æºåŠ è½½æœºåˆ¶](#5-æ‰¹é‡èµ„æºåŠ è½½æœºåˆ¶)
6. [æ€§èƒ½ä¼˜åŒ–ä¸ç¼“å­˜ç­–ç•¥](#6-æ€§èƒ½ä¼˜åŒ–ä¸ç¼“å­˜ç­–ç•¥)
7. [å®é™…åº”ç”¨åœºæ™¯](#7-å®é™…åº”ç”¨åœºæ™¯)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ResourcePatternResolveræ˜¯ä»€ä¹ˆ


### 1.1 é€šä¿—ç†è§£


**æ—¥å¸¸ç±»æ¯”**ï¼š
```
æƒ³è±¡ä½ åœ¨å›¾ä¹¦é¦†æ‰¾ä¹¦ï¼š

æ™®é€šæ‰¾ä¹¦æ–¹å¼ï¼ˆResourceLoaderï¼‰ï¼š
"æˆ‘è¦ã€Šçº¢æ¥¼æ¢¦ã€‹è¿™æœ¬ä¹¦" â†’ æ‰¾åˆ°ä¸€æœ¬å…·ä½“çš„ä¹¦

æ¨¡å¼æ‰¾ä¹¦æ–¹å¼ï¼ˆResourcePatternResolverï¼‰ï¼š
"æˆ‘è¦æ‰€æœ‰å§“'çº¢'å¼€å¤´çš„ä¹¦" â†’ æ‰¾åˆ°ä¸€æ‰¹ç¬¦åˆæ¡ä»¶çš„ä¹¦
"æˆ‘è¦æ‰€æœ‰å…³äºå¤å…¸æ–‡å­¦çš„ä¹¦" â†’ æ‰¾åˆ°æ•´ä¸ªç±»åˆ«çš„ä¹¦

è¿™å°±æ˜¯æ¨¡å¼è§£æå™¨çš„ä½œç”¨ï¼šç”¨æ¨¡å¼æ‰¹é‡æ‰¾èµ„æºï¼
```

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
> ResourcePatternResolver æ˜¯ Spring æä¾›çš„**æ‰¹é‡èµ„æºåŠ è½½å™¨**ï¼Œå®ƒèƒ½æ ¹æ®**è·¯å¾„æ¨¡å¼**ï¼ˆPatternï¼‰ä¸€æ¬¡æ€§æ‰¾åˆ°**å¤šä¸ªåŒ¹é…çš„èµ„æº**ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä¸€ä¸ªå»æ‰¾ã€‚

### 1.2 æ¥å£å®šä¹‰è§£è¯»


```java
public interface ResourcePatternResolver extends ResourceLoader {
    
    // ç‰¹æ®Šçš„classpathå‰ç¼€ï¼Œè¡¨ç¤º"æ‰€æœ‰åŒ¹é…çš„ç±»è·¯å¾„èµ„æº"
    String CLASSPATH_ALL_URL_PREFIX = "classpath*:";
    
    // æ ¸å¿ƒæ–¹æ³•ï¼šæ ¹æ®ä½ç½®æ¨¡å¼è·å–å¤šä¸ªèµ„æº
    Resource[] getResources(String locationPattern) throws IOException;
}
```

**æ¥å£è§£è¯»**ï¼š
- ğŸ“Œ **ç»§æ‰¿è‡ªResourceLoader**ï¼šæ—¢èƒ½åŠ è½½å•ä¸ªèµ„æºï¼Œä¹Ÿèƒ½æ‰¹é‡åŠ è½½
- ğŸ“Œ **locationPatternå‚æ•°**ï¼šæ”¯æŒé€šé…ç¬¦çš„è·¯å¾„æ¨¡å¼ï¼Œä¸åªæ˜¯å›ºå®šè·¯å¾„
- ğŸ“Œ **è¿”å›Resourceæ•°ç»„**ï¼šä¸€æ¬¡è·å–å¤šä¸ªèµ„æºï¼Œæé«˜æ•ˆç‡
- ğŸ“Œ **ç‰¹æ®Šå‰ç¼€classpath\***ï¼šèƒ½æœç´¢æ‰€æœ‰jaråŒ…é‡Œçš„èµ„æº

---

## 2. ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦æ¨¡å¼è§£æå™¨


### 2.1 å®é™…å¼€å‘ç—›ç‚¹


**åœºæ™¯1ï¼šåŠ è½½é…ç½®æ–‡ä»¶**
```
ä¼ ç»Ÿæ–¹å¼çš„éº»çƒ¦ï¼š
âŒ é…ç½®æ–‡ä»¶åˆ†æ•£åœ¨å¤šä¸ªjaråŒ…
âŒ éœ€è¦ä¸€ä¸ªä¸ªæ‰‹åŠ¨æŒ‡å®šè·¯å¾„
âŒ æ–°å¢é…ç½®æ–‡ä»¶è¦ä¿®æ”¹ä»£ç 

é¡¹ç›®ç»“æ„ï¼š
my-app.jar
  â””â”€â”€ config/app.properties
common-lib.jar
  â””â”€â”€ config/common.properties
db-module.jar
  â””â”€â”€ config/db.properties

ä¼ ç»ŸåŠ è½½æ–¹å¼ï¼ˆResourceLoaderï¼‰ï¼š
éœ€è¦å†™3æ¬¡åŠ è½½ä»£ç ï¼Œåˆ†åˆ«åŠ è½½æ¯ä¸ªé…ç½®æ–‡ä»¶
```

**åœºæ™¯2ï¼šç»„ä»¶æ‰«æ**
```
Springéœ€è¦æ‰¾åˆ°æ‰€æœ‰çš„@Componentç±»ï¼š
my-project/
  â”œâ”€â”€ com/example/controller/
  â”‚   â”œâ”€â”€ UserController.class
  â”‚   â””â”€â”€ OrderController.class
  â”œâ”€â”€ com/example/service/
  â”‚   â”œâ”€â”€ UserService.class
  â”‚   â””â”€â”€ OrderService.class
  â””â”€â”€ ...

å¦‚ä½•ä¸€æ¬¡æ€§æ‰¾åˆ°æ‰€æœ‰çš„ç±»æ–‡ä»¶ï¼Ÿ
â†’ ç”¨æ¨¡å¼è§£æå™¨ï¼
```

### 2.2 æ¨¡å¼è§£æå™¨çš„ä¼˜åŠ¿


| å¯¹æ¯”é¡¹ | **ResourceLoader** | **ResourcePatternResolver** |
|--------|-------------------|----------------------------|
| ğŸ“¦ **åŠ è½½èƒ½åŠ›** | `å•ä¸ªèµ„æº` | `æ‰¹é‡èµ„æº` |
| ğŸ” **è·¯å¾„æ”¯æŒ** | `å›ºå®šè·¯å¾„` | `é€šé…ç¬¦æ¨¡å¼` |
| ğŸ¯ **ä½¿ç”¨åœºæ™¯** | `åŠ è½½ç‰¹å®šé…ç½®æ–‡ä»¶` | `æ‰«ææ‰€æœ‰åŒ¹é…èµ„æº` |
| âš¡ **æ•ˆç‡** | `å¤šæ¬¡è°ƒç”¨` | `ä¸€æ¬¡è°ƒç”¨` |
| ğŸŒ **ä½œç”¨èŒƒå›´** | `å½“å‰ç±»è·¯å¾„` | `æ‰€æœ‰jaråŒ…` |

**æ ¸å¿ƒä»·å€¼**ï¼š
- âœ… **æ‰¹é‡å¤„ç†**ï¼šä¸€æ¬¡æ€§åŠ è½½å¤šä¸ªèµ„æºï¼Œå‡å°‘ä»£ç é‡
- âœ… **çµæ´»åŒ¹é…**ï¼šæ”¯æŒé€šé…ç¬¦ï¼Œé€‚åº”åŠ¨æ€åœºæ™¯
- âœ… **å…¨å±€æœç´¢**ï¼šè·¨jaråŒ…æŸ¥æ‰¾ï¼Œä¸é—æ¼èµ„æº
- âœ… **è‡ªåŠ¨å‘ç°**ï¼šé…åˆç»„ä»¶æ‰«æï¼Œå®ç°è‡ªåŠ¨åŒ–é…ç½®

---

## 3. ğŸ”§ æ ¸å¿ƒæ¥å£ä¸å®ç°


### 3.1 æ¥å£ç»§æ‰¿ä½“ç³»


```
ResourcePatternResolveræ¥å£å±‚æ¬¡ï¼š
                                    
        ResourceLoader              â† åŸºç¡€èµ„æºåŠ è½½å™¨
              â†‘
              |
    ResourcePatternResolver         â† æ¨¡å¼èµ„æºè§£æå™¨
              â†‘
              |
   PathMatchingResourcePatternResolver  â† æœ€å¸¸ç”¨çš„å®ç°ç±»
```

**å…³ç³»è¯´æ˜**ï¼š
- `ResourceLoader`ï¼šåªèƒ½åŠ è½½**å•ä¸ª**èµ„æºï¼Œæ˜¯åŸºç¡€æ¥å£
- `ResourcePatternResolver`ï¼šæ‰©å±•æ”¯æŒ**æ‰¹é‡**èµ„æºåŠ è½½
- `PathMatchingResourcePatternResolver`ï¼šæä¾›**å…·ä½“å®ç°**ï¼Œæ˜¯æˆ‘ä»¬å®é™…ä½¿ç”¨çš„ç±»

### 3.2 PathMatchingResourcePatternResolverè¯¦è§£


è¿™æ˜¯Springæä¾›çš„**æ ‡å‡†å®ç°ç±»**ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„ï¼š

```java
public class PathMatchingResourcePatternResolver 
    implements ResourcePatternResolver {
    
    private final ResourceLoader resourceLoader;  // å†…éƒ¨çš„èµ„æºåŠ è½½å™¨
    private PathMatcher pathMatcher;              // è·¯å¾„åŒ¹é…å™¨
    
    // æ„é€ å™¨ï¼šå¯ä»¥æŒ‡å®šèµ„æºåŠ è½½å™¨
    public PathMatchingResourcePatternResolver() {
        this.resourceLoader = new DefaultResourceLoader();
    }
    
    public PathMatchingResourcePatternResolver(ResourceLoader resourceLoader) {
        this.resourceLoader = resourceLoader;
    }
}
```

**æ ¸å¿ƒç»„ä»¶**ï¼š
- ğŸ”¸ **å†…éƒ¨ResourceLoader**ï¼šå¤ç”¨å•èµ„æºåŠ è½½èƒ½åŠ›
- ğŸ”¸ **PathMatcherè·¯å¾„åŒ¹é…å™¨**ï¼šè´Ÿè´£æ¨¡å¼åŒ¹é…é€»è¾‘ï¼ˆé»˜è®¤æ˜¯Anté£æ ¼ï¼‰
- ğŸ”¸ **çµæ´»æ„é€ **ï¼šå¯ä»¥ä¼ å…¥è‡ªå®šä¹‰çš„ResourceLoader

### 3.3 ä½¿ç”¨ç¤ºä¾‹


```java
// ç¤ºä¾‹1ï¼šåŸºç¡€ç”¨æ³• - åŠ è½½æ‰€æœ‰propertiesæ–‡ä»¶
ResourcePatternResolver resolver = 
    new PathMatchingResourcePatternResolver();

// åŠ è½½classpathä¸‹æ‰€æœ‰çš„propertiesæ–‡ä»¶
Resource[] resources = resolver.getResources("classpath*:*.properties");

for (Resource resource : resources) {
    System.out.println("æ‰¾åˆ°é…ç½®æ–‡ä»¶: " + resource.getFilename());
}
```

```java
// ç¤ºä¾‹2ï¼šSpring Beané…ç½®
@Configuration
public class ResourceConfig {
    
    @Bean
    public ResourcePatternResolver resourcePatternResolver() {
        // Springä¼šè‡ªåŠ¨æ³¨å…¥ResourceLoader
        return new PathMatchingResourcePatternResolver();
    }
    
    @Bean
    public void loadAllConfigs(ResourcePatternResolver resolver) 
        throws IOException {
        // åŠ è½½æ‰€æœ‰æ¨¡å—çš„é…ç½®æ–‡ä»¶
        Resource[] configs = resolver.getResources(
            "classpath*:config/*.properties"
        );
        
        for (Resource config : configs) {
            // å¤„ç†æ¯ä¸ªé…ç½®æ–‡ä»¶
            loadConfig(config);
        }
    }
}
```

**ä»£ç è§£è¯»**ï¼š
- â‘  `classpath*:`ï¼šæœç´¢**æ‰€æœ‰**ç±»è·¯å¾„ï¼ˆåŒ…æ‹¬jaråŒ…ï¼‰
- â‘¡ `*.properties`ï¼šåŒ¹é…æ‰€æœ‰propertiesæ–‡ä»¶
- â‘¢ è¿”å›`Resource[]`æ•°ç»„ï¼šåŒ…å«æ‰€æœ‰æ‰¾åˆ°çš„èµ„æº

---

## 4. ğŸ—ºï¸ è·¯å¾„åŒ¹é…è§„åˆ™è¯¦è§£


### 4.1 è·¯å¾„å‰ç¼€è¯´æ˜


Springæ”¯æŒå¤šç§è·¯å¾„å‰ç¼€ï¼Œæ¯ç§æœ‰ä¸åŒå«ä¹‰ï¼š

| å‰ç¼€ | **å«ä¹‰** | **æœç´¢èŒƒå›´** | **ç¤ºä¾‹** |
|------|---------|------------|---------|
| `classpath:` | `ç±»è·¯å¾„å•ä¸ªèµ„æº` | `å½“å‰é¡¹ç›®çš„classpath` | `classpath:config.xml` |
| `classpath*:` | `ç±»è·¯å¾„æ‰€æœ‰èµ„æº` | `æ‰€æœ‰jaråŒ…çš„classpath` | `classpath*:*.xml` |
| `file:` | `æ–‡ä»¶ç³»ç»Ÿèµ„æº` | `æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ` | `file:/opt/config/app.xml` |
| `http:` | `ç½‘ç»œèµ„æº` | `HTTPåè®®` | `http://example.com/config.xml` |
| æ— å‰ç¼€ | `ç›¸å¯¹è·¯å¾„èµ„æº` | `ä¾èµ–ä¸Šä¸‹æ–‡` | `config/app.xml` |

**å…³é”®åŒºåˆ«**ï¼š
```
classpath: vs classpath*:

å‡è®¾é¡¹ç›®ç»“æ„ï¼š
my-app.jar
  â””â”€â”€ config/app.xml
lib-a.jar
  â””â”€â”€ config/common.xml
lib-b.jar
  â””â”€â”€ config/db.xml

ä½¿ç”¨ classpath:config/*.xml
â†’ åªæ‰¾åˆ° app.xmlï¼ˆä»…å½“å‰é¡¹ç›®ï¼‰

ä½¿ç”¨ classpath*:config/*.xml  
â†’ æ‰¾åˆ° app.xml, common.xml, db.xmlï¼ˆæ‰€æœ‰jaråŒ…ï¼‰
```

### 4.2 é€šé…ç¬¦æ¨¡å¼ï¼ˆAnté£æ ¼ï¼‰


Springä½¿ç”¨**Anté£æ ¼**çš„è·¯å¾„åŒ¹é…ï¼Œæ”¯æŒä¸‰ç§é€šé…ç¬¦ï¼š

**â‘  æ˜Ÿå· `*`ï¼šåŒ¹é…ä»»æ„å­—ç¬¦ï¼ˆä¸åŒ…æ‹¬è·¯å¾„åˆ†éš”ç¬¦ï¼‰**
```
ç¤ºä¾‹è·¯å¾„æ¨¡å¼ï¼š
com/example/*/service/*.class

åŒ¹é…ï¼š
âœ… com/example/user/service/UserService.class
âœ… com/example/order/service/OrderService.class

ä¸åŒ¹é…ï¼š
âŒ com/example/user/dao/UserDao.classï¼ˆdaoä¸æ˜¯serviceï¼‰
âŒ com/example/service/TestService.classï¼ˆç¼ºå°‘ä¸­é—´å±‚çº§ï¼‰
```

**â‘¡ åŒæ˜Ÿå· `**`ï¼šåŒ¹é…ä»»æ„å±‚çº§ç›®å½•**
```
ç¤ºä¾‹è·¯å¾„æ¨¡å¼ï¼š
com/example/**/service/*.class

åŒ¹é…ï¼š
âœ… com/example/service/UserService.classï¼ˆ0å±‚ç›®å½•ï¼‰
âœ… com/example/user/service/OrderService.classï¼ˆ1å±‚ç›®å½•ï¼‰
âœ… com/example/module/user/service/TestService.classï¼ˆ2å±‚ç›®å½•ï¼‰

è¯´æ˜ï¼š** å¯ä»¥åŒ¹é…ä»»æ„æ·±åº¦çš„è·¯å¾„
```

**â‘¢ é—®å· `?`ï¼šåŒ¹é…å•ä¸ªå­—ç¬¦**
```
ç¤ºä¾‹è·¯å¾„æ¨¡å¼ï¼š
application-?.properties

åŒ¹é…ï¼š
âœ… application-a.properties
âœ… application-1.properties

ä¸åŒ¹é…ï¼š
âŒ application-dev.propertiesï¼ˆdevæ˜¯3ä¸ªå­—ç¬¦ï¼‰
âŒ application.propertiesï¼ˆç¼ºå°‘å­—ç¬¦ï¼‰
```

### 4.3 å¸¸ç”¨æ¨¡å¼ç¤ºä¾‹


```java
// æ¨¡å¼1ï¼šåŠ è½½æ‰€æœ‰XMLé…ç½®æ–‡ä»¶
Resource[] xmlFiles = resolver.getResources("classpath*:**/*.xml");
// å«ä¹‰ï¼šæ‰€æœ‰jaråŒ…ä¸­ï¼Œä»»æ„ç›®å½•ä¸‹çš„æ‰€æœ‰XMLæ–‡ä»¶

// æ¨¡å¼2ï¼šåŠ è½½ç‰¹å®šåŒ…ä¸‹çš„æ‰€æœ‰ç±»
Resource[] classes = resolver.getResources(
    "classpath*:com/example/service/**/*.class"
);
// å«ä¹‰ï¼šcom/example/serviceåŒ…åŠå…¶å­åŒ…çš„æ‰€æœ‰classæ–‡ä»¶

// æ¨¡å¼3ï¼šåŠ è½½å¤šç¯å¢ƒé…ç½®
Resource[] configs = resolver.getResources(
    "classpath*:application-*.yml"
);
// å«ä¹‰ï¼šæ‰€æœ‰application-å¼€å¤´çš„ymlæ–‡ä»¶
// åŒ¹é…ï¼šapplication-dev.yml, application-prod.ymlç­‰
```

### 4.4 è·¯å¾„åŒ¹é…ç®—æ³•åŸç†


**åŒ¹é…è¿‡ç¨‹**ï¼š
```
ç”¨æˆ·è¾“å…¥ï¼šclasspath*:com/example/**/service/*.class

ç¬¬1æ­¥ï¼šå‰ç¼€è§£æ
â†’ è¯†åˆ«å‡º classpath*: å‰ç¼€
â†’ ç¡®å®šæœç´¢æ‰€æœ‰ç±»è·¯å¾„

ç¬¬2æ­¥ï¼šè·¯å¾„æ¨¡å¼æå–
â†’ æå–æ¨¡å¼ï¼šcom/example/**/service/*.class

ç¬¬3æ­¥ï¼šæ‰«ææ‰€æœ‰ç±»è·¯å¾„
â†’ éå†å½“å‰é¡¹ç›®classpath
â†’ éå†æ‰€æœ‰ä¾èµ–jaråŒ…

ç¬¬4æ­¥ï¼šæ¨¡å¼åŒ¹é…
å¯¹æ¯ä¸ªæ‰¾åˆ°çš„èµ„æºè·¯å¾„ï¼š
â†’ ç”¨PathMatcherè¿›è¡ŒåŒ¹é…
â†’ ç¬¦åˆæ¨¡å¼åˆ™åŠ å…¥ç»“æœé›†

ç¬¬5æ­¥ï¼šè¿”å›ç»“æœ
â†’ è¿”å›Resource[]æ•°ç»„
```

---

## 5. ğŸ“¦ æ‰¹é‡èµ„æºåŠ è½½æœºåˆ¶


### 5.1 åŠ è½½æµç¨‹è§£æ


```
æ‰¹é‡åŠ è½½çš„å®Œæ•´è¿‡ç¨‹ï¼š

ç”¨æˆ·è°ƒç”¨
    â†“
resolver.getResources("classpath*:config/**/*.xml")
    â†“
[æ­¥éª¤1] è§£æè·¯å¾„æ¨¡å¼
    â”œâ”€ è¯†åˆ«å‰ç¼€ï¼šclasspath*:
    â”œâ”€ æå–æ¨¡å¼ï¼šconfig/**/*.xml
    â””â”€ ç¡®å®šåŒ¹é…å™¨ï¼šAntPathMatcher
    â†“
[æ­¥éª¤2] ç¡®å®šæœç´¢èŒƒå›´
    â”œâ”€ classpath*: â†’ æ‰€æœ‰ç±»è·¯å¾„
    â”œâ”€ è·å–æ‰€æœ‰jaråŒ…ä½ç½®
    â””â”€ è·å–å½“å‰é¡¹ç›®classpath
    â†“
[æ­¥éª¤3] éå†æ‰«æ
    â”œâ”€ æ‰«æjaråŒ…ï¼šlib-a.jar, lib-b.jar...
    â”œâ”€ æ‰«æé¡¹ç›®ç›®å½•ï¼štarget/classes
    â””â”€ æ”¶é›†æ‰€æœ‰å€™é€‰èµ„æº
    â†“
[æ­¥éª¤4] æ¨¡å¼åŒ¹é…è¿‡æ»¤
    â”œâ”€ å¯¹æ¯ä¸ªèµ„æºè·¯å¾„åŒ¹é…æ¨¡å¼
    â”œâ”€ ç¬¦åˆåˆ™ä¿ç•™
    â””â”€ ä¸ç¬¦åˆåˆ™ä¸¢å¼ƒ
    â†“
[æ­¥éª¤5] æ„å»ºResourceå¯¹è±¡
    â”œâ”€ ä¸ºæ¯ä¸ªåŒ¹é…èµ„æºåˆ›å»ºResource
    â””â”€ å°è£…åˆ°Resource[]æ•°ç»„
    â†“
è¿”å›ç»“æœç»™ç”¨æˆ·
```

### 5.2 èµ„æºæŸ¥æ‰¾ç­–ç•¥


**ç­–ç•¥1ï¼šåŸºäºç±»åŠ è½½å™¨æŸ¥æ‰¾**
```java
// Springå†…éƒ¨å®ç°é€»è¾‘ï¼ˆç®€åŒ–ç‰ˆï¼‰
protected Resource[] findAllClassPathResources(String path) {
    Set<Resource> result = new LinkedHashSet<>();
    
    // è·å–æ‰€æœ‰ç±»åŠ è½½å™¨
    ClassLoader[] classLoaders = getClassLoaders();
    
    for (ClassLoader cl : classLoaders) {
        // ç”¨ç±»åŠ è½½å™¨æŸ¥æ‰¾èµ„æº
        Enumeration<URL> urls = cl.getResources(path);
        
        while (urls.hasMoreElements()) {
            URL url = urls.nextElement();
            result.add(convertToResource(url));
        }
    }
    
    return result.toArray(new Resource[0]);
}
```

**ç­–ç•¥2ï¼šåŸºäºæ–‡ä»¶ç³»ç»ŸæŸ¥æ‰¾**
```java
// æ‰«ææ–‡ä»¶ç³»ç»Ÿç›®å½•
protected Set<Resource> doFindPathMatchingFileResources(
    Resource rootDirResource, String subPattern) {
    
    File rootDir = rootDirResource.getFile();
    Set<Resource> result = new LinkedHashSet<>();
    
    // é€’å½’éå†ç›®å½•
    doRetrieveMatchingFiles(rootDir, subPattern, result);
    
    return result;
}
```

### 5.3 èµ„æºå»é‡æœºåˆ¶


**é—®é¢˜**ï¼šåŒä¸€ä¸ªèµ„æºå¯èƒ½åœ¨å¤šä¸ªä½ç½®è¢«æ‰¾åˆ°

```
åœºæ™¯ï¼š
é¡¹ç›®ç»“æ„ï¼š
my-app/target/classes/config/app.xml
my-app.jar!/config/app.xml

ä½¿ç”¨ classpath*:config/*.xml
â†’ å¯èƒ½æ‰¾åˆ°2æ¬¡åŒæ ·çš„æ–‡ä»¶
```

**è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨Setå»é‡
```java
// Springçš„å»é‡é€»è¾‘
Set<Resource> result = new LinkedHashSet<>();  // LinkedHashSetä¿æŒé¡ºåº

// æ·»åŠ èµ„æºæ—¶è‡ªåŠ¨å»é‡
for (Resource resource : foundResources) {
    result.add(resource);  // é‡å¤çš„ä¼šè¢«è‡ªåŠ¨è¿‡æ»¤
}

return result.toArray(new Resource[0]);
```

**å»é‡ä¾æ®**ï¼šResourceå¯¹è±¡çš„equals()æ–¹æ³•
- æ¯”è¾ƒURLæ˜¯å¦ç›¸åŒ
- ç›¸åŒURLçš„èµ„æºè¢«è®¤ä¸ºæ˜¯é‡å¤çš„

---

## 6. âš¡ æ€§èƒ½ä¼˜åŒ–ä¸ç¼“å­˜ç­–ç•¥


### 6.1 æ€§èƒ½è€ƒè™‘å› ç´ 


**å½±å“æ€§èƒ½çš„å…³é”®ç‚¹**ï¼š

â‘  **æ‰«æèŒƒå›´**
```
æ€§èƒ½å¯¹æ¯”ï¼š

classpath:config/*.xml          â† å¿«ï¼ˆä»…å½“å‰é¡¹ç›®ï¼‰
    VS
classpath*:config/**/*.xml      â† æ…¢ï¼ˆæ‰€æœ‰jaråŒ…+é€’å½’ï¼‰

å»ºè®®ï¼š
âœ… èƒ½ç”¨classpath:å°±ä¸ç”¨classpath*:
âœ… å‡å°‘**é€šé…ç¬¦çš„ä½¿ç”¨
âœ… ç¼©å°æ‰«æç›®å½•èŒƒå›´
```

â‘¡ **æ–‡ä»¶æ•°é‡**
```
åœºæ™¯åˆ†æï¼š

é¡¹ç›®Aï¼š10ä¸ªé…ç½®æ–‡ä»¶
é¡¹ç›®Bï¼š1000ä¸ªé…ç½®æ–‡ä»¶

ç›¸åŒæ¨¡å¼ä¸‹ï¼Œé¡¹ç›®Bçš„æ‰«ææ—¶é—´æ˜æ˜¾æ›´é•¿
â†’ åŒ¹é…å’Œè¿‡æ»¤éœ€è¦æ›´å¤šæ—¶é—´
```

â‘¢ **JaråŒ…æ•°é‡**
```
ä¾èµ–å¯¹æ¯”ï¼š

å°é¡¹ç›®ï¼š5ä¸ªjaråŒ…    â†’ æ‰«æå¿«
å¤§é¡¹ç›®ï¼š100ä¸ªjaråŒ…  â†’ æ‰«ææ…¢

æ¯ä¸ªjaråŒ…éƒ½è¦æ‰“å¼€å¹¶éå†
â†’ I/Oæ“ä½œæ˜¯æ€§èƒ½ç“¶é¢ˆ
```

### 6.2 ç¼“å­˜ç­–ç•¥


**Springçš„ç¼“å­˜æœºåˆ¶**ï¼š

```java
public class PathMatchingResourcePatternResolver {
    
    // ç¼“å­˜ï¼šæ¨¡å¼ â†’ èµ„æºæ•°ç»„
    private final Map<String, Resource[]> resourceCache = 
        new ConcurrentHashMap<>();
    
    public Resource[] getResources(String locationPattern) {
        // å…ˆæŸ¥ç¼“å­˜
        Resource[] cached = resourceCache.get(locationPattern);
        if (cached != null) {
            return cached;  // ç¼“å­˜å‘½ä¸­ï¼Œç›´æ¥è¿”å›
        }
        
        // ç¼“å­˜æœªå‘½ä¸­ï¼Œæ‰§è¡ŒæŸ¥æ‰¾
        Resource[] resources = doGetResources(locationPattern);
        
        // å­˜å…¥ç¼“å­˜
        resourceCache.put(locationPattern, resources);
        
        return resources;
    }
}
```

**ç¼“å­˜ç­–ç•¥è¯´æ˜**ï¼š
- ğŸ”¸ **Key**ï¼šè·¯å¾„æ¨¡å¼å­—ç¬¦ä¸²
- ğŸ”¸ **Value**ï¼šæŸ¥æ‰¾åˆ°çš„Resourceæ•°ç»„
- ğŸ”¸ **æœ‰æ•ˆæœŸ**ï¼šåº”ç”¨ç”Ÿå‘½å‘¨æœŸå†…ï¼ˆä¸ä¼šè‡ªåŠ¨å¤±æ•ˆï¼‰
- ğŸ”¸ **æ›´æ–°æ—¶æœº**ï¼šèµ„æºå˜åŒ–æ—¶éœ€æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜

### 6.3 æ€§èƒ½ä¼˜åŒ–å»ºè®®


**æœ€ä½³å®è·µ**ï¼š

```java
// âŒ ä¸æ¨èï¼šèŒƒå›´å¤ªå¤§
Resource[] all = resolver.getResources("classpath*:**/*.*");

// âœ… æ¨èï¼šæ˜ç¡®ç›®å½•å’Œç±»å‹
Resource[] configs = resolver.getResources(
    "classpath*:config/**/*.properties"
);
```

**ä¼˜åŒ–æŠ€å·§æ€»ç»“**ï¼š

| ä¼˜åŒ–ç‚¹ | **ä¸å¥½çš„åšæ³•** | **æ¨èåšæ³•** | **æ€§èƒ½æå‡** |
|-------|--------------|------------|------------|
| ğŸ¯ **å‰ç¼€é€‰æ‹©** | `classpath*:` | `classpath:` | `50%+` |
| ğŸ“ **ç›®å½•èŒƒå›´** | `**/*.*` | `config/**/*.xml` | `80%+` |
| ğŸ” **é€šé…ç¬¦** | `**/**/**/*.class` | `com/example/**/*.class` | `60%+` |
| â° **åŠ è½½æ—¶æœº** | `æ¯æ¬¡ä½¿ç”¨éƒ½åŠ è½½` | `å¯åŠ¨æ—¶åŠ è½½å¹¶ç¼“å­˜` | `90%+` |

**ä»£ç ç¤ºä¾‹**ï¼š
```java
@Configuration
public class PerformanceOptimizedConfig {
    
    private Resource[] cachedResources;  // ç¼“å­˜èµ„æº
    
    @PostConstruct
    public void init() throws IOException {
        ResourcePatternResolver resolver = 
            new PathMatchingResourcePatternResolver();
        
        // å¯åŠ¨æ—¶ä¸€æ¬¡æ€§åŠ è½½
        this.cachedResources = resolver.getResources(
            "classpath:config/*.properties"  // æ˜ç¡®èŒƒå›´
        );
        
        System.out.println("é¢„åŠ è½½é…ç½®æ–‡ä»¶: " + 
            cachedResources.length + "ä¸ª");
    }
    
    public Resource[] getConfigs() {
        return cachedResources;  // ç›´æ¥è¿”å›ç¼“å­˜
    }
}
```

---

## 7. ğŸ¯ å®é™…åº”ç”¨åœºæ™¯


### 7.1 åœºæ™¯1ï¼šå¤šæ¨¡å—é…ç½®åŠ è½½


**éœ€æ±‚**ï¼šå¾®æœåŠ¡é¡¹ç›®ï¼Œæ¯ä¸ªæ¨¡å—æœ‰è‡ªå·±çš„é…ç½®æ–‡ä»¶

```
é¡¹ç›®ç»“æ„ï¼š
microservice-project/
  â”œâ”€â”€ user-service.jar
  â”‚   â””â”€â”€ config/user-config.yml
  â”œâ”€â”€ order-service.jar
  â”‚   â””â”€â”€ config/order-config.yml
  â””â”€â”€ payment-service.jar
      â””â”€â”€ config/payment-config.yml

ç›®æ ‡ï¼šä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰æ¨¡å—é…ç½®
```

**å®ç°ä»£ç **ï¼š
```java
@Configuration
public class MultiModuleConfigLoader {
    
    @Bean
    public List<YamlConfig> loadAllModuleConfigs() throws IOException {
        ResourcePatternResolver resolver = 
            new PathMatchingResourcePatternResolver();
        
        // åŠ è½½æ‰€æœ‰æ¨¡å—çš„é…ç½®
        Resource[] resources = resolver.getResources(
            "classpath*:config/*-config.yml"
        );
        
        List<YamlConfig> configs = new ArrayList<>();
        YamlParser parser = new YamlParser();
        
        for (Resource resource : resources) {
            YamlConfig config = parser.parse(resource.getInputStream());
            configs.add(config);
            
            System.out.println("åŠ è½½æ¨¡å—é…ç½®: " + 
                resource.getFilename());
        }
        
        return configs;
    }
}
```

### 7.2 åœºæ™¯2ï¼šç»„ä»¶è‡ªåŠ¨æ‰«æ


**éœ€æ±‚**ï¼šè‡ªåŠ¨å‘ç°å¹¶æ³¨å†Œæ‰€æœ‰çš„æ’ä»¶ç±»

```java
@Component
public class PluginScanner {
    
    @Autowired
    private ResourcePatternResolver resolver;
    
    public List<Class<?>> scanPlugins(String basePackage) 
        throws Exception {
        
        // æ„å»ºæ‰«æè·¯å¾„
        String pattern = "classpath*:" + 
            basePackage.replace('.', '/') + "/**/*Plugin.class";
        
        Resource[] resources = resolver.getResources(pattern);
        List<Class<?>> pluginClasses = new ArrayList<>();
        
        for (Resource resource : resources) {
            // ä»èµ„æºè·¯å¾„æå–ç±»å
            String className = extractClassName(
                resource.getURL().toString()
            );
            
            Class<?> clazz = Class.forName(className);
            pluginClasses.add(clazz);
        }
        
        return pluginClasses;
    }
}
```

### 7.3 åœºæ™¯3ï¼šå›½é™…åŒ–èµ„æºåŠ è½½


**éœ€æ±‚**ï¼šåŠ è½½æ‰€æœ‰è¯­è¨€çš„å›½é™…åŒ–æ–‡ä»¶

```java
@Configuration
public class I18nResourceLoader {
    
    @Bean
    public MessageSource messageSource() throws IOException {
        ResourcePatternResolver resolver = 
            new PathMatchingResourcePatternResolver();
        
        // åŠ è½½æ‰€æœ‰i18næ–‡ä»¶
        Resource[] resources = resolver.getResources(
            "classpath*:i18n/messages*.properties"
        );
        
        ReloadableResourceBundleMessageSource messageSource = 
            new ReloadableResourceBundleMessageSource();
        
        // æå–basename
        Set<String> basenames = new HashSet<>();
        for (Resource resource : resources) {
            String basename = extractBasename(resource);
            basenames.add(basename);
        }
        
        messageSource.setBasenames(
            basenames.toArray(new String[0])
        );
        
        return messageSource;
    }
}
```

**æ”¯æŒçš„å›½é™…åŒ–æ–‡ä»¶**ï¼š
```
i18n/
  â”œâ”€â”€ messages_zh_CN.properties  â† ä¸­æ–‡
  â”œâ”€â”€ messages_en_US.properties  â† è‹±æ–‡
  â””â”€â”€ messages_ja_JP.properties  â† æ—¥è¯­

æ¨¡å¼ï¼šclasspath*:i18n/messages*.properties
â†’ ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰è¯­è¨€æ–‡ä»¶
```

### 7.4 åœºæ™¯4ï¼šæµ‹è¯•èµ„æºç®¡ç†


**éœ€æ±‚**ï¼šæµ‹è¯•æ—¶åŠ è½½ç‰¹å®šçš„æµ‹è¯•æ•°æ®

```java
@SpringBootTest
public class TestResourceLoader {
    
    @Autowired
    private ResourcePatternResolver resolver;
    
    @BeforeEach
    public void loadTestData() throws IOException {
        // åŠ è½½æ‰€æœ‰æµ‹è¯•SQLè„šæœ¬
        Resource[] sqlScripts = resolver.getResources(
            "classpath:test-data/**/*.sql"
        );
        
        for (Resource script : sqlScripts) {
            executeSqlScript(script);
            System.out.println("æ‰§è¡Œæµ‹è¯•è„šæœ¬: " + 
                script.getFilename());
        }
    }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å…³é”®æ¦‚å¿µå›é¡¾


**ğŸ¯ ResourcePatternResolveræœ¬è´¨**ï¼š
- æ˜¯ResourceLoaderçš„**å¢å¼ºç‰ˆ**ï¼Œæ”¯æŒæ¨¡å¼åŒ¹é…
- èƒ½**æ‰¹é‡åŠ è½½**å¤šä¸ªèµ„æºï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä¸€ä¸ªåŠ è½½
- åŸºäº**é€šé…ç¬¦æ¨¡å¼**ï¼ˆAnté£æ ¼ï¼‰è¿›è¡Œèµ„æºæŸ¥æ‰¾
- Springæ¡†æ¶å†…éƒ¨å¤§é‡ä½¿ç”¨ï¼ˆç»„ä»¶æ‰«æã€é…ç½®åŠ è½½ç­‰ï¼‰

**ğŸ”‘ æ ¸å¿ƒåŠŸèƒ½ä¸‰è¦ç´ **ï¼š
```
â‘  æ¨¡å¼è§£æ
   â†’ ç†è§£å¹¶è§£æè·¯å¾„æ¨¡å¼ï¼ˆclasspath*:ã€**ã€*ç­‰ï¼‰

â‘¡ æ‰¹é‡æŸ¥æ‰¾
   â†’ éå†æ‰€æœ‰å¯èƒ½çš„ä½ç½®ï¼Œæ‰¾åˆ°æ‰€æœ‰åŒ¹é…èµ„æº

â‘¢ èµ„æºå°è£…
   â†’ å°†æ‰¾åˆ°çš„èµ„æºå°è£…æˆResourceå¯¹è±¡æ•°ç»„
```

### 8.2 é‡è¦çŸ¥è¯†ç‚¹


**ğŸ“Œ å¿…é¡»æŒæ¡**ï¼š

â‘  **è·¯å¾„å‰ç¼€å«ä¹‰**
```
classpath:  â†’ å½“å‰é¡¹ç›®ç±»è·¯å¾„
classpath*: â†’ æ‰€æœ‰jaråŒ…ç±»è·¯å¾„
file:       â†’ æ–‡ä»¶ç³»ç»Ÿè·¯å¾„
http:       â†’ ç½‘ç»œèµ„æºè·¯å¾„
```

â‘¡ **é€šé…ç¬¦ä½¿ç”¨**
```
*   â†’ åŒ¹é…ä»»æ„å­—ç¬¦ï¼ˆå•å±‚ç›®å½•ï¼‰
**  â†’ åŒ¹é…ä»»æ„å±‚çº§ç›®å½•
?   â†’ åŒ¹é…å•ä¸ªå­—ç¬¦
```

â‘¢**ä½¿ç”¨åœºæ™¯åˆ¤æ–­**
```
éœ€è¦åŠ è½½å¤šä¸ªèµ„æºï¼Ÿ      â†’ ç”¨ResourcePatternResolver
åªåŠ è½½ä¸€ä¸ªç‰¹å®šèµ„æºï¼Ÿ    â†’ ç”¨ResourceLoaderå°±å¤Ÿäº†
èµ„æºåˆ†æ•£åœ¨å¤šä¸ªjaråŒ…ï¼Ÿ   â†’ å¿…é¡»ç”¨classpath*:å‰ç¼€
```

### 8.3 æ€§èƒ½ä¼˜åŒ–è¦ç‚¹


**âš¡ æ€§èƒ½æœ€ä½³å®è·µ**ï¼š

```java
// âœ… å¥½çš„åšæ³•
resolver.getResources("classpath:config/*.xml");        // æ˜ç¡®èŒƒå›´
resolver.getResources("classpath*:com/example/**/*.class");  // å…·ä½“åŒ…è·¯å¾„

// âŒ é¿å…çš„åšæ³•  
resolver.getResources("classpath*:**/*.*");             // èŒƒå›´å¤ªå¤§
resolver.getResources("file:/**/*.*");                  // æ‰«ææ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿ
```

**ä¼˜åŒ–åŸåˆ™**ï¼š
- ğŸ”¸ ä¼˜å…ˆä½¿ç”¨`classpath:`ï¼Œé™¤éå¿…é¡»è·¨jaråŒ…
- ğŸ”¸ å°½é‡ç¼©å°æ‰«æç›®å½•èŒƒå›´
- ğŸ”¸ å‡å°‘`**`é€šé…ç¬¦çš„ä½¿ç”¨
- ğŸ”¸ å¯åŠ¨æ—¶åŠ è½½å¹¶ç¼“å­˜ï¼Œé¿å…é‡å¤æ‰«æ

### 8.4 å®æˆ˜è®°å¿†å£è¯€


```
ğŸ“ è®°å¿†å£è¯€ï¼š

å•ä¸ªèµ„æºç”¨Loaderï¼Œæ‰¹é‡èµ„æºç”¨Pattern
classpathå½“å‰æ‰¾ï¼Œæ˜Ÿå·å…¨å±€æœ
ä¸€é¢—æ˜ŸåŒ¹é…æ–‡ä»¶ï¼Œä¸¤é¢—æ˜Ÿéå†ç›®å½•
æ€§èƒ½ä¼˜åŒ–è®°ä¸‰ç‚¹ï¼šç¼©å°èŒƒå›´ã€å‡å°‘é€šé…ã€å¯åŠ¨ç¼“å­˜
```

**æ ¸å¿ƒç†è§£**ï¼š
- ResourcePatternResolver = **æ‰¹é‡ç‰ˆ**çš„ResourceLoader
- é€šé…ç¬¦æ¨¡å¼ = è®©ä½ **ä¸€æ¬¡æ‰¾å¤šä¸ª**èµ„æºçš„å…³é”®
- classpath* = æœç´¢**æ‰€æœ‰jaråŒ…**çš„é­”æ³•å‰ç¼€
- æ€§èƒ½ä¼˜åŒ– = å°‘ç”¨é€šé…ç¬¦ + æ˜ç¡®è·¯å¾„ + æå‰ç¼“å­˜

---

## ğŸ“ å­¦ä¹ å»ºè®®


**å¯¹äºæ–°æ‰‹**ï¼š
1. å…ˆç†è§£æ™®é€šçš„ResourceLoader
2. å†å­¦ä¹ æ¨¡å¼åŒ¹é…çš„æ¦‚å¿µ
3. æŒæ¡å¸¸ç”¨çš„è·¯å¾„æ¨¡å¼
4. é€šè¿‡å®é™…é¡¹ç›®ç»ƒä¹ 

**è¿›é˜¶å­¦ä¹ **ï¼š
- ç ”ç©¶PathMatcherçš„åŒ¹é…ç®—æ³•
- äº†è§£ClassLoaderçš„èµ„æºåŠ è½½æœºåˆ¶
- æ·±å…¥Springçš„ç»„ä»¶æ‰«ææºç 
- è‡ªå®šä¹‰ResourcePatternResolverå®ç°

è®°ä½ï¼š**ResourcePatternResolveræ˜¯Springèµ„æºç®¡ç†çš„é«˜çº§å·¥å…·ï¼Œç†è§£å®ƒçš„åŸç†èƒ½å¸®ä½ æ›´å¥½åœ°æŒæ¡Springçš„é…ç½®åŠ è½½å’Œç»„ä»¶æ‰«ææœºåˆ¶**ï¼