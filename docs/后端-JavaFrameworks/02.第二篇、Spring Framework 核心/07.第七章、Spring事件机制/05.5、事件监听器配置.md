---
title: 5ã€äº‹ä»¶ç›‘å¬å™¨é…ç½®
---
## ğŸ“š ç›®å½•

1. [äº‹ä»¶ç›‘å¬å™¨åŸºç¡€æ¦‚å¿µ](#1-äº‹ä»¶ç›‘å¬å™¨åŸºç¡€æ¦‚å¿µ)
2. [ApplicationListeneræ¥å£å®ç°](#2-ApplicationListeneræ¥å£å®ç°)
3. [@EventListeneræ³¨è§£ä½¿ç”¨](#3-EventListeneræ³¨è§£ä½¿ç”¨)
4. [ç›‘å¬å™¨æ³¨å†Œæœºåˆ¶](#4-ç›‘å¬å™¨æ³¨å†Œæœºåˆ¶)
5. [å¼‚æ­¥ç›‘å¬é…ç½®](#5-å¼‚æ­¥ç›‘å¬é…ç½®)
6. [æ¡ä»¶ç›‘å¬å®ç°](#6-æ¡ä»¶ç›‘å¬å®ç°)
7. [ç›‘å¬å™¨æ’åºæ§åˆ¶](#7-ç›‘å¬å™¨æ’åºæ§åˆ¶)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ äº‹ä»¶ç›‘å¬å™¨åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯äº‹ä»¶ç›‘å¬å™¨


**ğŸ”¸ ç”¨ç”Ÿæ´»åœºæ™¯ç†è§£**
```
æƒ³è±¡ä½ åœ¨å’–å•¡åº—ç‚¹å’–å•¡ï¼š
é¡¾å®¢ï¼ˆå‘å¸ƒè€…ï¼‰ â†’ ç‚¹å•ï¼ˆå‘å¸ƒäº‹ä»¶ï¼‰ â†’ å’–å•¡å¸ˆï¼ˆç›‘å¬å™¨ï¼‰æ”¶åˆ°è®¢å•å¼€å§‹åˆ¶ä½œ

Springäº‹ä»¶ç›‘å¬ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ï¼š
æŸä¸ªç»„ä»¶ â†’ å‘ç”ŸæŸä»¶äº‹ â†’ å…¶ä»–ç»„ä»¶è‡ªåŠ¨å“åº”å¤„ç†
```

**ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µ**
- **äº‹ä»¶ï¼ˆEventï¼‰**ï¼šå°±æ˜¯"å‘ç”Ÿäº†ä»€ä¹ˆäº‹"ï¼Œæ¯”å¦‚ç”¨æˆ·æ³¨å†ŒæˆåŠŸã€è®¢å•åˆ›å»ºå®Œæˆ
- **ç›‘å¬å™¨ï¼ˆListenerï¼‰**ï¼šå°±æ˜¯"å¬åˆ°äº‹ä»¶åè¦åšä»€ä¹ˆ"ï¼Œæ¯”å¦‚å‘é€æ¬¢è¿é‚®ä»¶ã€è®°å½•æ—¥å¿—
- **å‘å¸ƒè€…ï¼ˆPublisherï¼‰**ï¼šå°±æ˜¯"é€šçŸ¥å¤§å®¶å‘ç”Ÿäº†ä»€ä¹ˆ"çš„è§’è‰²

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦äº‹ä»¶ç›‘å¬


**ğŸ¯ è§£å†³çš„é—®é¢˜**

**ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜**ï¼š
```
ç”¨æˆ·æ³¨å†ŒæˆåŠŸåéœ€è¦åšçš„äº‹ï¼š
1. å‘é€æ¬¢è¿é‚®ä»¶
2. èµ é€æ–°æ‰‹ç§¯åˆ†
3. è®°å½•æ“ä½œæ—¥å¿—
4. é€šçŸ¥æ¨èç³»ç»Ÿ

å¦‚æœå…¨å†™åœ¨æ³¨å†Œæ–¹æ³•é‡Œ â†’ ä»£ç è‡ƒè‚¿ã€è€¦åˆä¸¥é‡
```

**äº‹ä»¶ç›‘å¬çš„ä¼˜åŠ¿**ï¼š
```
âœ… è§£è€¦ï¼šæ³¨å†Œé€»è¾‘ä¸ç”¨å…³å¿ƒåç»­å¤„ç†
âœ… æ‰©å±•ï¼šæ–°å¢åŠŸèƒ½åªéœ€åŠ ç›‘å¬å™¨ï¼Œä¸æ”¹åŸä»£ç 
âœ… å¼‚æ­¥ï¼šå¯ä»¥å¼‚æ­¥æ‰§è¡Œï¼Œä¸å½±å“ä¸»æµç¨‹
âœ… çµæ´»ï¼šå¯ä»¥æ¡ä»¶ç›‘å¬ã€æ’åºæ‰§è¡Œ
```

### 1.3 äº‹ä»¶ç›‘å¬çš„å·¥ä½œæµç¨‹


**ğŸ”„ å®Œæ•´æµç¨‹å›¾ç¤º**
```
æ­¥éª¤1: å®šä¹‰äº‹ä»¶
   â†“
æ­¥éª¤2: åˆ›å»ºç›‘å¬å™¨ï¼ˆç›‘å¬è¿™ä¸ªäº‹ä»¶ï¼‰
   â†“
æ­¥éª¤3: å‘å¸ƒäº‹ä»¶ï¼ˆæŸå¤„è§¦å‘ï¼‰
   â†“
æ­¥éª¤4: Springè‡ªåŠ¨é€šçŸ¥æ‰€æœ‰ç›‘å¬å™¨
   â†“
æ­¥éª¤5: ç›‘å¬å™¨æ‰§è¡Œå„è‡ªçš„å¤„ç†é€»è¾‘
```

**å®é™…è¿è¡Œç¤ºä¾‹**ï¼š
```
ç”¨æˆ·æ³¨å†ŒæˆåŠŸ â†’ å‘å¸ƒUserRegisterEventäº‹ä»¶
                        â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â†“                  â†“                  â†“
é‚®ä»¶ç›‘å¬å™¨         ç§¯åˆ†ç›‘å¬å™¨         æ—¥å¿—ç›‘å¬å™¨
å‘é€æ¬¢è¿é‚®ä»¶       èµ é€æ–°æ‰‹ç§¯åˆ†       è®°å½•æ³¨å†Œæ—¥å¿—
```

---

## 2. ğŸ“ ApplicationListeneræ¥å£å®ç°


### 2.1 æ¥å£æ–¹å¼çš„åŸºæœ¬æ¦‚å¿µ


**ğŸ”¸ ä»€ä¹ˆæ˜¯ApplicationListener**

è¿™æ˜¯Springæä¾›çš„**æœ€åŸå§‹**çš„ç›‘å¬å™¨å®ç°æ–¹å¼ï¼Œå°±åƒå®ç°ä¸€ä¸ªæ¥å£åˆåŒï¼š
- **åˆåŒå†…å®¹**ï¼šæˆ‘æ‰¿è¯ºç›‘å¬æŸç§ç±»å‹çš„äº‹ä»¶
- **åˆåŒæ¡æ¬¾**ï¼šå½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œæˆ‘ä¼šæ‰§è¡ŒonApplicationEventæ–¹æ³•

### 2.2 æ¥å£å®ç°æ–¹å¼


**ğŸ“‹ åŸºç¡€å®ç°æ­¥éª¤**

```java
// æ­¥éª¤1: å…ˆå®šä¹‰ä¸€ä¸ªäº‹ä»¶ï¼ˆç»§æ‰¿ApplicationEventï¼‰
public class UserRegisterEvent extends ApplicationEvent {
    private String username;
    private String email;
    
    public UserRegisterEvent(Object source, String username, String email) {
        super(source);  // sourceæ˜¯äº‹ä»¶æ¥æº
        this.username = username;
        this.email = email;
    }
    
    // getters...
}

// æ­¥éª¤2: åˆ›å»ºç›‘å¬å™¨ï¼ˆå®ç°ApplicationListeneræ¥å£ï¼‰
@Component  // æ³¨å†Œä¸ºSpring Bean
public class UserRegisterListener implements ApplicationListener<UserRegisterEvent> {
    
    @Override
    public void onApplicationEvent(UserRegisterEvent event) {
        // è¿™é‡Œå†™ç›‘å¬åˆ°äº‹ä»¶åè¦åšçš„äº‹
        System.out.println("æ”¶åˆ°ç”¨æˆ·æ³¨å†Œäº‹ä»¶ï¼š" + event.getUsername());
        // å‘é€æ¬¢è¿é‚®ä»¶
        sendWelcomeEmail(event.getEmail());
    }
    
    private void sendWelcomeEmail(String email) {
        // é‚®ä»¶å‘é€é€»è¾‘
    }
}
```

**ğŸ’¡ å…³é”®ç†è§£ç‚¹**

| æ¦‚å¿µ | é€šä¿—è§£é‡Š | ä»£ç ä½“ç° |
|------|----------|----------|
| **æ³›å‹æŒ‡å®š** | å‘Šè¯‰Springæˆ‘åªç›‘å¬å“ªç§äº‹ä»¶ | `ApplicationListener<UserRegisterEvent>` |
| **æ–¹æ³•å®ç°** | æ”¶åˆ°äº‹ä»¶åå…·ä½“è¦åšä»€ä¹ˆ | `onApplicationEvent(UserRegisterEvent event)` |
| **Beanæ³¨å†Œ** | è®©SpringçŸ¥é“è¿™ä¸ªç›‘å¬å™¨çš„å­˜åœ¨ | `@Component` æ³¨è§£ |

### 2.3 æ¥å£æ–¹å¼çš„ä¼˜ç¼ºç‚¹


**âœ… ä¼˜ç‚¹**ï¼š
- ç±»å‹å®‰å…¨ï¼šæ³›å‹æ˜ç¡®æŒ‡å®šç›‘å¬çš„äº‹ä»¶ç±»å‹
- ç¼–è¯‘æ£€æŸ¥ï¼šå†™é”™äº†ç¼–è¯‘å™¨ä¼šæç¤º
- æ—©æœŸç‰ˆæœ¬å…¼å®¹ï¼šSpring 1.xå°±æœ‰

**âŒ ç¼ºç‚¹**ï¼š
- ä¸€ä¸ªç±»åªèƒ½ç›‘å¬ä¸€ç§äº‹ä»¶ï¼ˆéœ€è¦å¤šä¸ªç›‘å¬å™¨ç±»ï¼‰
- ä»£ç ç›¸å¯¹å•°å—¦
- ä¸å¦‚æ³¨è§£æ–¹å¼çµæ´»

---

## 3. ğŸ¨ @EventListeneræ³¨è§£ä½¿ç”¨


### 3.1 æ³¨è§£æ–¹å¼çš„åŸºæœ¬æ¦‚å¿µ


**ğŸ”¸ @EventListeneræ˜¯ä»€ä¹ˆ**

è¿™æ˜¯**æ›´ç°ä»£ã€æ›´çµæ´»**çš„ç›‘å¬å™¨å®ç°æ–¹å¼ï¼Œä¸éœ€è¦å®ç°æ¥å£ï¼š
- **ç›´æ¥åœ¨æ–¹æ³•ä¸ŠåŠ æ³¨è§£**ï¼šå‘Šè¯‰Springè¿™ä¸ªæ–¹æ³•è¦ç›‘å¬äº‹ä»¶
- **æ–¹æ³•å‚æ•°å°±æ˜¯äº‹ä»¶ç±»å‹**ï¼šSpringè‡ªåŠ¨è¯†åˆ«
- **ä¸€ä¸ªç±»å¯ä»¥æœ‰å¤šä¸ªç›‘å¬æ–¹æ³•**ï¼šæ›´åŠ çµæ´»

### 3.2 åŸºç¡€ä½¿ç”¨æ–¹å¼


**ğŸ“‹ æœ€ç®€å•çš„ç”¨æ³•**

```java
@Component
public class OrderEventListener {
    
    // ç›´æ¥åœ¨æ–¹æ³•ä¸ŠåŠ @EventListeneræ³¨è§£
    @EventListener
    public void handleOrderCreate(OrderCreateEvent event) {
        // å‚æ•°ç±»å‹å°±æ˜¯è¦ç›‘å¬çš„äº‹ä»¶ç±»å‹
        System.out.println("è®¢å•åˆ›å»ºï¼š" + event.getOrderId());
        // å¤„ç†é€»è¾‘...
    }
}
```

**ğŸ¯ ä¸€ä¸ªç±»ç›‘å¬å¤šä¸ªäº‹ä»¶**

```java
@Component
public class UserEventListener {
    
    @EventListener
    public void onUserRegister(UserRegisterEvent event) {
        System.out.println("ç”¨æˆ·æ³¨å†Œï¼š" + event.getUsername());
    }
    
    @EventListener
    public void onUserLogin(UserLoginEvent event) {
        System.out.println("ç”¨æˆ·ç™»å½•ï¼š" + event.getUsername());
    }
    
    @EventListener
    public void onUserLogout(UserLogoutEvent event) {
        System.out.println("ç”¨æˆ·ç™»å‡ºï¼š" + event.getUsername());
    }
}
```

### 3.3 æ³¨è§£çš„é«˜çº§ç”¨æ³•


**ğŸ”¸ ç›‘å¬å¤šç§äº‹ä»¶ï¼ˆä¸€ä¸ªæ–¹æ³•ï¼‰**

```java
@Component
public class NotificationListener {
    
    // classeså±æ€§æŒ‡å®šå¤šä¸ªäº‹ä»¶ç±»å‹
    @EventListener(classes = {UserRegisterEvent.class, UserLoginEvent.class})
    public void sendNotification(ApplicationEvent event) {
        // æ ¹æ®ä¸åŒäº‹ä»¶ç±»å‹åšä¸åŒå¤„ç†
        if (event instanceof UserRegisterEvent) {
            // æ³¨å†Œé€šçŸ¥
        } else if (event instanceof UserLoginEvent) {
            // ç™»å½•é€šçŸ¥
        }
    }
}
```

**ğŸ”¸ è¿”å›å€¼ä½œä¸ºæ–°äº‹ä»¶å‘å¸ƒ**

```java
@Component
public class OrderListener {
    
    @EventListener
    public EmailEvent handleOrderCreate(OrderCreateEvent event) {
        // å¤„ç†è®¢å•åˆ›å»º
        System.out.println("è®¢å•åˆ›å»ºæˆåŠŸ");
        
        // è¿”å›æ–°äº‹ä»¶ï¼ŒSpringä¼šè‡ªåŠ¨å‘å¸ƒ
        return new EmailEvent(this, "å‘é€è®¢å•ç¡®è®¤é‚®ä»¶");
    }
}
```

**æµç¨‹è¯´æ˜**ï¼š
```
OrderCreateEventå‘å¸ƒ
      â†“
OrderListener.handleOrderCreateæ‰§è¡Œ
      â†“
è¿”å›EmailEventå¯¹è±¡
      â†“
Springè‡ªåŠ¨å‘å¸ƒEmailEvent
      â†“
EmailEventçš„ç›‘å¬å™¨è¢«è§¦å‘
```

### 3.4 æ¥å£ vs æ³¨è§£å¯¹æ¯”


| å¯¹æ¯”é¡¹ | **ApplicationListeneræ¥å£** | **@EventListeneræ³¨è§£** |
|--------|----------------------------|----------------------|
| ğŸ¯ **çµæ´»æ€§** | ä¸€ä¸ªç±»åªç›‘å¬ä¸€ç§äº‹ä»¶ | ä¸€ä¸ªç±»å¯ç›‘å¬å¤šç§äº‹ä»¶ |
| ğŸ“ **ä»£ç é‡** | éœ€è¦å®ç°æ¥å£ï¼Œä»£ç å¤š | åªåŠ æ³¨è§£ï¼Œä»£ç ç®€æ´ |
| ğŸ”§ **ç±»å‹å®‰å…¨** | æ³›å‹æŒ‡å®šï¼Œç¼–è¯‘æ£€æŸ¥ | å‚æ•°ç±»å‹ï¼ŒåŒæ ·å®‰å…¨ |
| ğŸš€ **æ¨èåº¦** | ä¸æ¨èï¼ˆæ—§æ–¹å¼ï¼‰ | â­â­â­â­â­ å¼ºçƒˆæ¨è |

---

## 4. ğŸ”§ ç›‘å¬å™¨æ³¨å†Œæœºåˆ¶


### 4.1 Springå¦‚ä½•å‘ç°ç›‘å¬å™¨


**ğŸ”¸ è‡ªåŠ¨æ³¨å†ŒåŸç†**

Springä¼šåœ¨å¯åŠ¨æ—¶è‡ªåŠ¨æ‰«æå’Œæ³¨å†Œç›‘å¬å™¨ï¼š

```
Springå®¹å™¨å¯åŠ¨
      â†“
æ‰«ææ‰€æœ‰Bean
      â†“
æ‰¾åˆ°ApplicationListenerå®ç°ç±» â†’ æ³¨å†Œä¸ºç›‘å¬å™¨
æ‰¾åˆ°@EventListeneræ ‡æ³¨çš„æ–¹æ³• â†’ æ³¨å†Œä¸ºç›‘å¬å™¨
      â†“
å»ºç«‹"äº‹ä»¶ç±»å‹â†’ç›‘å¬å™¨"çš„æ˜ å°„å…³ç³»
      â†“
ç­‰å¾…äº‹ä»¶å‘å¸ƒ
```

### 4.2 æ³¨å†Œæ–¹å¼å¯¹æ¯”


**ğŸ“Š ä¸‰ç§æ³¨å†Œæ–¹å¼**

**æ–¹å¼1ï¼šç»„ä»¶æ‰«æè‡ªåŠ¨æ³¨å†Œï¼ˆæœ€å¸¸ç”¨ï¼‰**
```java
@Component  // è‡ªåŠ¨æ‰«ææ³¨å†Œ
public class UserListener implements ApplicationListener<UserEvent> {
    // ...
}
```

**æ–¹å¼2ï¼šé…ç½®ç±»æ‰‹åŠ¨æ³¨å†Œ**
```java
@Configuration
public class ListenerConfig {
    
    @Bean
    public UserListener userListener() {
        return new UserListener();
    }
}
```

**æ–¹å¼3ï¼šç¼–ç¨‹å¼æ³¨å†Œï¼ˆå¾ˆå°‘ç”¨ï¼‰**
```java
@Component
public class DynamicListenerRegister {
    
    @Autowired
    private ApplicationEventMulticaster multicaster;
    
    public void registerListener() {
        // æ‰‹åŠ¨æ³¨å†Œç›‘å¬å™¨
        multicaster.addApplicationListener(new UserListener());
    }
}
```

### 4.3 ç›‘å¬å™¨ç”Ÿå‘½å‘¨æœŸ


**ğŸ”„ ç”Ÿå‘½å‘¨æœŸæµç¨‹**

```
å®¹å™¨å¯åŠ¨ â†’ åˆ›å»ºç›‘å¬å™¨Bean â†’ æ³¨å†Œåˆ°äº‹ä»¶å¤šæ’­å™¨ â†’ ç­‰å¾…äº‹ä»¶
                                              â†“
å®¹å™¨å…³é—­ â† ç§»é™¤ç›‘å¬å™¨ â† ä¸å†æ¥æ”¶äº‹ä»¶ â† äº‹ä»¶å‘å¸ƒæ—¶è§¦å‘
```

**ğŸ’¡ é‡è¦æé†’**

> **æ³¨æ„**ï¼šç›‘å¬å™¨æ˜¯å•ä¾‹çš„ï¼ˆé»˜è®¤ï¼‰ï¼Œæ•´ä¸ªåº”ç”¨ç”Ÿå‘½å‘¨æœŸåªåˆ›å»ºä¸€æ¬¡
> **æ„å‘³ç€**ï¼šç›‘å¬å™¨æ–¹æ³•ä¼šè¢«å¤šæ¬¡è°ƒç”¨ï¼Œä½†ç›‘å¬å™¨å¯¹è±¡åªæœ‰ä¸€ä¸ª
> **å»ºè®®**ï¼šç›‘å¬å™¨æ–¹æ³•è¦ä¿è¯çº¿ç¨‹å®‰å…¨

---

## 5. âš¡ å¼‚æ­¥ç›‘å¬é…ç½®


### 5.1 ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥ç›‘å¬


**ğŸ”¸ åŒæ­¥ç›‘å¬çš„é—®é¢˜**

```
ç”¨æˆ·æ³¨å†Œè¯·æ±‚
    â†“
ä¿å­˜ç”¨æˆ·ä¿¡æ¯ï¼ˆ100msï¼‰
    â†“
åŒæ­¥æ‰§è¡Œç›‘å¬å™¨ï¼š
  - å‘é€é‚®ä»¶ï¼ˆ2000msï¼‰    â† ç”¨æˆ·è¦ç­‰
  - èµ é€ç§¯åˆ†ï¼ˆ500msï¼‰     â† ç”¨æˆ·è¦ç­‰
  - è®°å½•æ—¥å¿—ï¼ˆ100msï¼‰     â† ç”¨æˆ·è¦ç­‰
    â†“
è¿”å›æ³¨å†ŒæˆåŠŸï¼ˆæ€»å…±2700msï¼‰ â† å¤ªæ…¢äº†ï¼
```

**âœ… å¼‚æ­¥ç›‘å¬çš„ä¼˜åŠ¿**

```
ç”¨æˆ·æ³¨å†Œè¯·æ±‚
    â†“
ä¿å­˜ç”¨æˆ·ä¿¡æ¯ï¼ˆ100msï¼‰
    â†“
è¿”å›æ³¨å†ŒæˆåŠŸï¼ˆ100msï¼‰     â† ç”¨æˆ·ç«‹å³å¾—åˆ°å“åº”
    â†“
å¼‚æ­¥æ‰§è¡Œç›‘å¬å™¨ï¼š
  - å‘é€é‚®ä»¶ï¼ˆ2000msï¼‰    â† åå°æ‰§è¡Œ
  - èµ é€ç§¯åˆ†ï¼ˆ500msï¼‰     â† åå°æ‰§è¡Œ
  - è®°å½•æ—¥å¿—ï¼ˆ100msï¼‰     â† åå°æ‰§è¡Œ
```

### 5.2 å¼‚æ­¥ç›‘å¬å®ç°


**ğŸ“‹ é…ç½®æ­¥éª¤**

**æ­¥éª¤1ï¼šå¼€å¯å¼‚æ­¥æ”¯æŒ**
```java
@Configuration
@EnableAsync  // å¼€å¯Springå¼‚æ­¥åŠŸèƒ½
public class AsyncConfig {
    
    // é…ç½®å¼‚æ­¥æ‰§è¡Œçš„çº¿ç¨‹æ± 
    @Bean
    public Executor taskExecutor() {
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        executor.setCorePoolSize(5);       // æ ¸å¿ƒçº¿ç¨‹æ•°
        executor.setMaxPoolSize(10);       // æœ€å¤§çº¿ç¨‹æ•°
        executor.setQueueCapacity(100);    // é˜Ÿåˆ—å®¹é‡
        executor.setThreadNamePrefix("async-listener-");
        executor.initialize();
        return executor;
    }
}
```

**æ­¥éª¤2ï¼šåœ¨ç›‘å¬æ–¹æ³•ä¸ŠåŠ @Async**
```java
@Component
public class UserEventListener {
    
    @Async  // æ ‡è®°ä¸ºå¼‚æ­¥æ‰§è¡Œ
    @EventListener
    public void sendWelcomeEmail(UserRegisterEvent event) {
        // è¿™ä¸ªæ–¹æ³•ä¼šåœ¨ç‹¬ç«‹çº¿ç¨‹ä¸­æ‰§è¡Œ
        System.out.println("å¼‚æ­¥å‘é€é‚®ä»¶ï¼Œçº¿ç¨‹ï¼š" + Thread.currentThread().getName());
        // é‚®ä»¶å‘é€é€»è¾‘ï¼ˆè€—æ—¶æ“ä½œï¼‰
    }
    
    @Async
    @EventListener
    public void givePoints(UserRegisterEvent event) {
        System.out.println("å¼‚æ­¥èµ é€ç§¯åˆ†ï¼Œçº¿ç¨‹ï¼š" + Thread.currentThread().getName());
        // ç§¯åˆ†å‘æ”¾é€»è¾‘
    }
}
```

### 5.3 åŒæ­¥vså¼‚æ­¥é€‰æ‹©


**ğŸ¯ ä½¿ç”¨åœºæ™¯åˆ¤æ–­**

| åœºæ™¯ç±»å‹ | **ä½¿ç”¨æ–¹å¼** | **åŸå› ** | **ç¤ºä¾‹** |
|----------|-------------|---------|---------|
| ğŸš€ **è€—æ—¶æ“ä½œ** | å¼‚æ­¥ | ä¸å½±å“ä¸»æµç¨‹ | å‘é€é‚®ä»¶ã€æ¨é€æ¶ˆæ¯ |
| ğŸ“Š **æ•°æ®ä¸€è‡´æ€§** | åŒæ­¥ | ä¿è¯é¡ºåºæ‰§è¡Œ | æ‰£å‡åº“å­˜ã€æ›´æ–°è®¢å•çŠ¶æ€ |
| ğŸ“ **æ—¥å¿—è®°å½•** | å¼‚æ­¥ | æå‡æ€§èƒ½ | æ“ä½œæ—¥å¿—ã€è®¿é—®æ—¥å¿— |
| ğŸ’° **é‡‘é¢è®¡ç®—** | åŒæ­¥ | ä¿è¯å‡†ç¡®æ€§ | è®¢å•é‡‘é¢ã€ç§¯åˆ†è®¡ç®— |

**âš ï¸ å¼‚æ­¥æ³¨æ„äº‹é¡¹**

> **äº‹åŠ¡é—®é¢˜**ï¼šå¼‚æ­¥æ–¹æ³•ä¸åœ¨åŸäº‹åŠ¡ä¸­ï¼Œéœ€è¦å¼€å¯æ–°äº‹åŠ¡
> **å¼‚å¸¸å¤„ç†**ï¼šå¼‚æ­¥æ–¹æ³•çš„å¼‚å¸¸ä¸ä¼šä¼ æ’­åˆ°ä¸»çº¿ç¨‹
> **è¿”å›å€¼**ï¼šå¼‚æ­¥æ–¹æ³•çš„è¿”å›å€¼æ— æ³•ç›´æ¥è·å–ï¼ˆå¯ç”¨Futureï¼‰

---

## 6. ğŸ›ï¸ æ¡ä»¶ç›‘å¬å®ç°


### 6.1 ä»€ä¹ˆæ˜¯æ¡ä»¶ç›‘å¬


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µ**

æ¡ä»¶ç›‘å¬å°±æ˜¯"**æœ‰æ¡ä»¶åœ°ç›‘å¬äº‹ä»¶**"ï¼Œä¸æ˜¯æ‰€æœ‰äº‹ä»¶éƒ½å¤„ç†ï¼š
- **åœºæ™¯1**ï¼šåªå¤„ç†VIPç”¨æˆ·çš„æ³¨å†Œäº‹ä»¶
- **åœºæ™¯2**ï¼šåªå¤„ç†é‡‘é¢å¤§äº1000çš„è®¢å•
- **åœºæ™¯3**ï¼šåªåœ¨å·¥ä½œæ—¥å¤„ç†æŸäº›äº‹ä»¶

### 6.2 SpELè¡¨è¾¾å¼æ¡ä»¶


**ğŸ“‹ ä½¿ç”¨conditionå±æ€§**

```java
@Component
public class ConditionalListener {
    
    // æ¡ä»¶1: åªç›‘å¬VIPç”¨æˆ·æ³¨å†Œ
    @EventListener(condition = "#event.userType == 'VIP'")
    public void handleVipRegister(UserRegisterEvent event) {
        System.out.println("VIPç”¨æˆ·æ³¨å†Œï¼š" + event.getUsername());
        // å‘é€VIPä¸“å±ç¤¼åŒ…
    }
    
    // æ¡ä»¶2: åªç›‘å¬å¤§é¢è®¢å•
    @EventListener(condition = "#event.amount > 1000")
    public void handleBigOrder(OrderCreateEvent event) {
        System.out.println("å¤§é¢è®¢å•ï¼š" + event.getAmount());
        // é£æ§å®¡æ ¸
    }
    
    // æ¡ä»¶3: åªåœ¨å·¥ä½œæ—¥å¤„ç†
    @EventListener(condition = "T(java.time.LocalDate).now().dayOfWeek.value < 6")
    public void handleWorkdayEvent(SomeEvent event) {
        System.out.println("å·¥ä½œæ—¥äº‹ä»¶å¤„ç†");
    }
}
```

**ğŸ”‘ SpELè¡¨è¾¾å¼è¯´æ˜**

| è¡¨è¾¾å¼ | **å«ä¹‰** | **ç¤ºä¾‹** |
|--------|---------|---------|
| `#event` | äº‹ä»¶å¯¹è±¡æœ¬èº« | `#event.username` |
| `#event.å±æ€§` | è®¿é—®äº‹ä»¶å±æ€§ | `#event.amount > 100` |
| `T(ç±»å)` | è°ƒç”¨é™æ€æ–¹æ³• | `T(Math).random() > 0.5` |
| `#root.args[0]` | æ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•° | åŒ#event |

### 6.3 ç¼–ç¨‹å¼æ¡ä»¶åˆ¤æ–­


**ğŸ“‹ åœ¨æ–¹æ³•å†…åˆ¤æ–­ï¼ˆæ›´çµæ´»ï¼‰**

```java
@Component
public class FlexibleListener {
    
    @EventListener
    public void handleUserEvent(UserRegisterEvent event) {
        // å¤æ‚æ¡ä»¶åˆ¤æ–­
        if (!shouldHandle(event)) {
            return;  // ä¸æ»¡è¶³æ¡ä»¶ï¼Œç›´æ¥è¿”å›
        }
        
        // æ»¡è¶³æ¡ä»¶ï¼Œæ‰§è¡Œå¤„ç†é€»è¾‘
        System.out.println("å¤„ç†ç”¨æˆ·äº‹ä»¶");
    }
    
    private boolean shouldHandle(UserRegisterEvent event) {
        // å¤æ‚çš„ä¸šåŠ¡åˆ¤æ–­é€»è¾‘
        if (event.getAge() < 18) return false;
        if (event.getRegion().equals("é™åˆ¶åŒºåŸŸ")) return false;
        if (!isBusinessHour()) return false;
        return true;
    }
}
```

**ğŸ¯ ä¸¤ç§æ–¹å¼å¯¹æ¯”**

| æ–¹å¼ | **ä¼˜ç‚¹** | **ç¼ºç‚¹** | **é€‚ç”¨åœºæ™¯** |
|------|---------|---------|-------------|
| **SpELæ¡ä»¶** | ç®€æ´ã€å£°æ˜å¼ | å¤æ‚é€»è¾‘éš¾å†™ | ç®€å•æ¡ä»¶åˆ¤æ–­ |
| **ç¼–ç¨‹åˆ¤æ–­** | çµæ´»ã€æ˜“æµ‹è¯• | ä»£ç å¤šä¸€äº› | å¤æ‚ä¸šåŠ¡é€»è¾‘ |

---

## 7. ğŸ”¢ ç›‘å¬å™¨æ’åºæ§åˆ¶


### 7.1 ä¸ºä»€ä¹ˆéœ€è¦æ’åº


**ğŸ”¸ æ‰§è¡Œé¡ºåºçš„é‡è¦æ€§**

```
ç”¨æˆ·æ³¨å†ŒæˆåŠŸï¼Œéœ€è¦æ‰§è¡Œï¼š
1. å…ˆéªŒè¯ç”¨æˆ·ä¿¡æ¯ â† å¿…é¡»ç¬¬ä¸€ä¸ª
2. åˆ›å»ºç”¨æˆ·è´¦æˆ·   â† å¿…é¡»ç¬¬äºŒä¸ª
3. å‘é€æ¬¢è¿é‚®ä»¶   â† é¡ºåºæ— æ‰€è°“
4. èµ é€æ–°æ‰‹ç§¯åˆ†   â† é¡ºåºæ— æ‰€è°“

å¦‚æœé¡ºåºé”™äº†ï¼šå…ˆå‘é‚®ä»¶ï¼Œè´¦æˆ·è¿˜æ²¡åˆ›å»º â†’ å‡ºé”™ï¼
```

**é»˜è®¤æƒ…å†µ**ï¼šSpringä¸ä¿è¯ç›‘å¬å™¨çš„æ‰§è¡Œé¡ºåº
**éœ€è¦æ’åºæ—¶**ï¼šä½¿ç”¨@Orderæ³¨è§£æ§åˆ¶é¡ºåº

### 7.2 ä½¿ç”¨@Orderæ³¨è§£


**ğŸ“‹ åŸºæœ¬ç”¨æ³•**

```java
@Component
public class OrderedListeners {
    
    // æ•°å­—è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼ˆå…ˆæ‰§è¡Œï¼‰
    @Order(1)  // ç¬¬ä¸€ä¸ªæ‰§è¡Œ
    @EventListener
    public void validateUser(UserRegisterEvent event) {
        System.out.println("1. éªŒè¯ç”¨æˆ·ä¿¡æ¯");
    }
    
    @Order(2)  // ç¬¬äºŒä¸ªæ‰§è¡Œ
    @EventListener
    public void createAccount(UserRegisterEvent event) {
        System.out.println("2. åˆ›å»ºç”¨æˆ·è´¦æˆ·");
    }
    
    @Order(3)  // ç¬¬ä¸‰ä¸ªæ‰§è¡Œ
    @EventListener
    public void sendEmail(UserRegisterEvent event) {
        System.out.println("3. å‘é€æ¬¢è¿é‚®ä»¶");
    }
    
    @Order(4)  // ç¬¬å››ä¸ªæ‰§è¡Œ
    @EventListener
    public void givePoints(UserRegisterEvent event) {
        System.out.println("4. èµ é€æ–°æ‰‹ç§¯åˆ†");
    }
}
```

**ğŸ”¢ æ‰§è¡Œæµç¨‹æ¼”ç¤º**

```
UserRegisterEventå‘å¸ƒ
        â†“
SpringæŒ‰Orderå€¼ä»å°åˆ°å¤§è°ƒç”¨ï¼š
        â†“
Order(1): éªŒè¯ç”¨æˆ·ä¿¡æ¯ âœ…
        â†“
Order(2): åˆ›å»ºç”¨æˆ·è´¦æˆ· âœ…
        â†“
Order(3): å‘é€æ¬¢è¿é‚®ä»¶ âœ…
        â†“
Order(4): èµ é€æ–°æ‰‹ç§¯åˆ† âœ…
```

### 7.3 æ¥å£æ–¹å¼æ’åº


**ğŸ“‹ å®ç°Orderedæ¥å£**

```java
@Component
public class HighPriorityListener 
    implements ApplicationListener<UserEvent>, Ordered {
    
    @Override
    public void onApplicationEvent(UserEvent event) {
        System.out.println("é«˜ä¼˜å…ˆçº§å¤„ç†");
    }
    
    @Override
    public int getOrder() {
        return 1;  // è¿”å›ä¼˜å…ˆçº§æ•°å€¼
    }
}

@Component
public class LowPriorityListener 
    implements ApplicationListener<UserEvent>, Ordered {
    
    @Override
    public void onApplicationEvent(UserEvent event) {
        System.out.println("ä½ä¼˜å…ˆçº§å¤„ç†");
    }
    
    @Override
    public int getOrder() {
        return 100;  // æ•°å€¼å¤§ï¼Œä¼˜å…ˆçº§ä½
    }
}
```

### 7.4 æ’åºè§„åˆ™æ€»ç»“


**ğŸ¯ æ ¸å¿ƒè§„åˆ™**

| è§„åˆ™ | **è¯´æ˜** | **ç¤ºä¾‹** |
|------|---------|---------|
| ğŸ“‰ **æ•°å­—è¶Šå°** | ä¼˜å…ˆçº§è¶Šé«˜ | Order(1) > Order(100) |
| ğŸ”¢ **é»˜è®¤å€¼** | æœ€ä½ä¼˜å…ˆçº§ | Ordered.LOWEST_PRECEDENCE |
| âš–ï¸ **ç›¸åŒå€¼** | é¡ºåºä¸ç¡®å®š | éƒ½æ˜¯Order(10)ï¼Œéšæœºé¡ºåº |
| ğŸš« **å¼‚æ­¥ç›‘å¬** | æ’åºå¯èƒ½å¤±æ•ˆ | å¼‚æ­¥æ‰§è¡Œé¡ºåºä¸ä¿è¯ |

**ğŸ’¡ æœ€ä½³å®è·µå»ºè®®**

```
ä¼˜å…ˆçº§åˆ’åˆ†å»ºè®®ï¼š
â€¢ 1-10ï¼š  æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼ˆéªŒè¯ã€åˆ›å»ºç­‰ï¼‰
â€¢ 11-50ï¼š é‡è¦é™„åŠ åŠŸèƒ½ï¼ˆç§¯åˆ†ã€ç­‰çº§ç­‰ï¼‰
â€¢ 51-99ï¼š ä¸€èˆ¬åŠŸèƒ½ï¼ˆé€šçŸ¥ã€æ—¥å¿—ç­‰ï¼‰
â€¢ 100+ï¼š  æ¬¡è¦åŠŸèƒ½ï¼ˆç»Ÿè®¡ã€åˆ†æç­‰ï¼‰
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ äº‹ä»¶ç›‘å¬ä¸‰è¦ç´ ï¼šäº‹ä»¶ã€ç›‘å¬å™¨ã€å‘å¸ƒè€…
ğŸ”¸ ä¸¤ç§å®ç°æ–¹å¼ï¼šApplicationListeneræ¥å£ vs @EventListeneræ³¨è§£
ğŸ”¸ æ³¨å†Œæœºåˆ¶ï¼šSpringè‡ªåŠ¨æ‰«æå¹¶æ³¨å†Œç›‘å¬å™¨
ğŸ”¸ å¼‚æ­¥ç›‘å¬ï¼š@Asyncæå‡æ€§èƒ½ï¼Œä½†è¦æ³¨æ„äº‹åŠ¡å’Œå¼‚å¸¸
ğŸ”¸ æ¡ä»¶ç›‘å¬ï¼šconditionå±æ€§å®ç°é€‰æ‹©æ€§ç›‘å¬
ğŸ”¸ æ’åºæ§åˆ¶ï¼š@Orderæ³¨è§£æ§åˆ¶æ‰§è¡Œé¡ºåº
```

### 8.2 å®ç°æ–¹å¼é€‰æ‹©æŒ‡å—


**ğŸ¯ æŠ€æœ¯é€‰å‹å†³ç­–æ ‘**

```
éœ€è¦ç›‘å¬äº‹ä»¶ï¼Ÿ
    â†“
å•ä¸ªæ–¹æ³•ç›‘å¬å¤šç§äº‹ä»¶ï¼Ÿ
    â”œâ”€ æ˜¯ â†’ ç”¨@EventListenerï¼ˆæ¨èâ­â­â­â­â­ï¼‰
    â””â”€ å¦ â†’ 
        â†“
    éœ€è¦ç±»å‹å®‰å…¨æ£€æŸ¥ï¼Ÿ
        â”œâ”€ æ˜¯ â†’ ApplicationListeneræ¥å£
        â””â”€ å¦ â†’ @EventListenerï¼ˆæ›´ç®€æ´ï¼‰
```

**ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”æ€»ç»“**

| ç‰¹æ€§ | **æ¥å£æ–¹å¼** | **æ³¨è§£æ–¹å¼** | **æ¨è** |
|------|-------------|-------------|---------|
| ğŸ¯ çµæ´»æ€§ | ä½ | é«˜ | æ³¨è§£ â­â­â­ |
| ğŸ“ ä»£ç é‡ | å¤š | å°‘ | æ³¨è§£ â­â­â­ |
| ğŸ”§ æ˜“ç”¨æ€§ | ä¸€èˆ¬ | ç®€å• | æ³¨è§£ â­â­â­ |
| âš¡ æ€§èƒ½ | ç›¸åŒ | ç›¸åŒ | éƒ½å¯ä»¥ |

### 8.3 å¸¸ç”¨é…ç½®æ¨¡å¼


**ğŸ”¸ æ¨¡å¼1ï¼šåŸºç¡€ç›‘å¬ï¼ˆæœ€å¸¸ç”¨ï¼‰**
```java
@Component
public class BasicListener {
    @EventListener
    public void handle(SomeEvent event) {
        // å¤„ç†é€»è¾‘
    }
}
```

**ğŸ”¸ æ¨¡å¼2ï¼šå¼‚æ­¥ç›‘å¬ï¼ˆè€—æ—¶æ“ä½œï¼‰**
```java
@Component
public class AsyncListener {
    @Async
    @EventListener
    public void handle(SomeEvent event) {
        // å¼‚æ­¥å¤„ç†
    }
}
```

**ğŸ”¸ æ¨¡å¼3ï¼šæ¡ä»¶ç›‘å¬ï¼ˆé€‰æ‹©æ€§å¤„ç†ï¼‰**
```java
@Component
public class ConditionalListener {
    @EventListener(condition = "#event.amount > 1000")
    public void handle(OrderEvent event) {
        // æ¡ä»¶å¤„ç†
    }
}
```

**ğŸ”¸ æ¨¡å¼4ï¼šæœ‰åºç›‘å¬ï¼ˆä¿è¯é¡ºåºï¼‰**
```java
@Component
public class OrderedListener {
    @Order(1)
    @EventListener
    public void handle(SomeEvent event) {
        // æŒ‰é¡ºåºå¤„ç†
    }
}
```

### 8.4 å®é™…åº”ç”¨å»ºè®®


**ğŸ’¡ æœ€ä½³å®è·µæ¸…å•**

âœ… **æ¨èåšæ³•**ï¼š
- ä¼˜å…ˆä½¿ç”¨@EventListeneræ³¨è§£ï¼ˆç®€æ´çµæ´»ï¼‰
- è€—æ—¶æ“ä½œä¸€å¾‹å¼‚æ­¥å¤„ç†
- å…³é”®æµç¨‹ä½¿ç”¨@Orderä¿è¯é¡ºåº
- å¤æ‚æ¡ä»¶ç”¨ç¼–ç¨‹åˆ¤æ–­è€ŒéSpEL
- ç›‘å¬å™¨ä¿æŒå•ä¸€èŒè´£ï¼Œé€»è¾‘ç®€å•

âŒ **é¿å…çš„å‘**ï¼š
- å¼‚æ­¥ç›‘å¬ä¸è¦ä¾èµ–äº‹åŠ¡
- é¿å…ç›‘å¬å™¨ä¹‹é—´äº’ç›¸å‘å¸ƒäº‹ä»¶ï¼ˆå¯èƒ½æ­»å¾ªç¯ï¼‰
- ä¸è¦åœ¨ç›‘å¬å™¨ä¸­æ‰§è¡Œé•¿æ—¶é—´é˜»å¡æ“ä½œ
- æ¡ä»¶è¡¨è¾¾å¼ä¸è¦è¿‡äºå¤æ‚

**ğŸ¯ åº”ç”¨åœºæ™¯æ¨è**

| åœºæ™¯ | **æ¨èæ–¹æ¡ˆ** | **é…ç½®è¦ç‚¹** |
|------|-------------|-------------|
| ğŸ“§ å‘é€é‚®ä»¶ | å¼‚æ­¥ç›‘å¬ | @Async + @EventListener |
| ğŸ“ è®°å½•æ—¥å¿— | å¼‚æ­¥ç›‘å¬ | @Async + ä½ä¼˜å…ˆçº§ |
| ğŸ’° æ‰£å‡åº“å­˜ | åŒæ­¥ç›‘å¬ | @EventListener + @Order(1) |
| ğŸ èµ é€ç§¯åˆ† | å¼‚æ­¥ç›‘å¬ | @Async + conditionæ¡ä»¶ |
| ğŸ”” æ¶ˆæ¯æ¨é€ | å¼‚æ­¥ç›‘å¬ | @Async + ç‹¬ç«‹çº¿ç¨‹æ±  |

### 8.5 æ ¸å¿ƒè®°å¿†å£è¯€


```
ğŸ§  ç›‘å¬å™¨é…ç½®è®°å¿†æ³•ï¼š

æ³¨è§£ä¼˜äºæ¥å£ï¼Œä»£ç ç®€æ´çµæ´»
å¼‚æ­¥å¤„ç†è€—æ—¶ï¼Œä¸»æµç¨‹ä¸é˜»å¡
æ¡ä»¶ç­›é€‰äº‹ä»¶ï¼Œé¿å…æ— æ•ˆæ‰§è¡Œ
æ’åºä¿è¯é¡ºåºï¼Œå…³é”®æµç¨‹å¿…ç”¨
ç›‘å¬å™¨è¦å•çº¯ï¼ŒèŒè´£æ¸…æ™°æ˜ç¡®
```

**ğŸ”‘ å…³é”®çŸ¥è¯†ç‚¹æ£€æŸ¥**

å­¦å®Œæœ¬ç« ï¼Œä½ åº”è¯¥èƒ½å¤Ÿï¼š
- [ ] è¯´å‡ºäº‹ä»¶ç›‘å¬å™¨çš„ä½œç”¨å’Œå·¥ä½œåŸç†
- [ ] ç”¨ä¸¤ç§æ–¹å¼å®ç°ç›‘å¬å™¨
- [ ] é…ç½®å¼‚æ­¥ç›‘å¬æå‡æ€§èƒ½
- [ ] ä½¿ç”¨æ¡ä»¶è¡¨è¾¾å¼è¿‡æ»¤äº‹ä»¶
- [ ] æ§åˆ¶ç›‘å¬å™¨çš„æ‰§è¡Œé¡ºåº
- [ ] åœ¨å®é™…é¡¹ç›®ä¸­åˆç†åº”ç”¨äº‹ä»¶ç›‘å¬

---

**ğŸ“ å­¦ä¹ å»ºè®®**

åˆå­¦è€…å­¦ä¹ è·¯å¾„ï¼š
1. å…ˆç†è§£äº‹ä»¶ç›‘å¬çš„æ¦‚å¿µå’Œä½œç”¨
2. æŒæ¡@EventListeneråŸºç¡€ç”¨æ³•
3. å­¦ä¼šé…ç½®å¼‚æ­¥ç›‘å¬
4. äº†è§£æ¡ä»¶ç›‘å¬å’Œæ’åº
5. é€šè¿‡å®é™…é¡¹ç›®ç»ƒä¹ å·©å›º