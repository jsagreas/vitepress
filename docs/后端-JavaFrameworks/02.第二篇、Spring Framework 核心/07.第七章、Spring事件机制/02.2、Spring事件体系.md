---
title: 2ã€Springäº‹ä»¶ä½“ç³»
---
## ğŸ“š ç›®å½•

1. [Springäº‹ä»¶æœºåˆ¶æ¦‚è¿°](#1-Springäº‹ä»¶æœºåˆ¶æ¦‚è¿°)
2. [ApplicationEventäº‹ä»¶è¯¦è§£](#2-ApplicationEventäº‹ä»¶è¯¦è§£)
3. [ApplicationListenerç›‘å¬å™¨](#3-ApplicationListenerç›‘å¬å™¨)
4. [ApplicationEventPublisherå‘å¸ƒå™¨](#4-ApplicationEventPublisherå‘å¸ƒå™¨)
5. [ApplicationEventMulticasterå¹¿æ’­å™¨](#5-ApplicationEventMulticasterå¹¿æ’­å™¨)
6. [äº‹ä»¶ç»§æ‰¿ä½“ç³»](#6-äº‹ä»¶ç»§æ‰¿ä½“ç³»)
7. [äº‹ä»¶åˆ†ç±»ä¸åº”ç”¨](#7-äº‹ä»¶åˆ†ç±»ä¸åº”ç”¨)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ Springäº‹ä»¶æœºåˆ¶æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯Springäº‹ä»¶æœºåˆ¶

ğŸ¯ **é€šä¿—ç†è§£**ï¼šSpringäº‹ä»¶æœºåˆ¶å°±åƒç°å®ä¸­çš„"é€šçŸ¥ç³»ç»Ÿ"

```
ç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼š
å­¦æ ¡å¹¿æ’­ç³»ç»Ÿ = Springäº‹ä»¶æœºåˆ¶
- å¹¿æ’­å‘˜ï¼ˆå‘å¸ƒè€…ï¼‰ï¼šå‘å¸ƒé€šçŸ¥æ¶ˆæ¯
- å¹¿æ’­å†…å®¹ï¼ˆäº‹ä»¶ï¼‰ï¼šå…·ä½“çš„é€šçŸ¥å†…å®¹
- å¬ä¼—ï¼ˆç›‘å¬å™¨ï¼‰ï¼šæ”¶å¬å¹¿æ’­çš„äºº
- å¹¿æ’­å–‡å­ï¼ˆå¹¿æ’­å™¨ï¼‰ï¼šè´Ÿè´£ä¼ æ’­å£°éŸ³

å½“å¹¿æ’­å‘˜è¯´"æ”¾å­¦äº†"ï¼Œæ‰€æœ‰å¬ä¼—éƒ½ä¼šæ”¶åˆ°è¿™ä¸ªæ¶ˆæ¯å¹¶åšå‡ºå“åº”
```

**ğŸ”¸ äº‹ä»¶æœºåˆ¶çš„æ ¸å¿ƒä»·å€¼**
```
è§£è€¦åˆï¼š
å‘å¸ƒè€…ä¸éœ€è¦çŸ¥é“è°åœ¨ç›‘å¬
ç›‘å¬è€…ä¸éœ€è¦çŸ¥é“è°åœ¨å‘å¸ƒ
åŒæ–¹é€šè¿‡äº‹ä»¶è¿›è¡Œé—´æ¥é€šä¿¡

å¼‚æ­¥å¤„ç†ï¼š
äº‹ä»¶å‘å¸ƒåç«‹å³è¿”å›
ç›‘å¬å™¨å¯ä»¥å¼‚æ­¥å¤„ç†äº‹ä»¶
æé«˜ç³»ç»Ÿå“åº”é€Ÿåº¦

æ‰©å±•æ€§ï¼š
æ–°å¢ç›‘å¬å™¨æ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç 
ä¸€ä¸ªäº‹ä»¶å¯ä»¥è¢«å¤šä¸ªç›‘å¬å™¨å¤„ç†
æ”¯æŒåŠ¨æ€æ·»åŠ åˆ é™¤ç›‘å¬å™¨
```

### 1.2 Springäº‹ä»¶æœºåˆ¶çš„å››å¤§æ ¸å¿ƒç»„ä»¶

**ğŸ“Š ç»„ä»¶å…³ç³»å›¾**

```
Springäº‹ä»¶æœºåˆ¶æ ¸å¿ƒç»„ä»¶ï¼š

       å‘å¸ƒå™¨(Publisher)
            â”‚
            â”‚ å‘å¸ƒ
            â–¼
         äº‹ä»¶(Event) â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                â”‚
            â”‚                â”‚
            â–¼                â–¼
       å¹¿æ’­å™¨(Multicaster)   ç›‘å¬å™¨(Listener)
            â”‚                   â–²
            â”‚                   â”‚
            â””â”€â”€â”€â”€â”€ é€šçŸ¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å·¥ä½œæµç¨‹ï¼š
1. å‘å¸ƒå™¨å‘å¸ƒäº‹ä»¶
2. å¹¿æ’­å™¨æ¥æ”¶äº‹ä»¶
3. å¹¿æ’­å™¨æŸ¥æ‰¾åŒ¹é…çš„ç›‘å¬å™¨
4. é€šçŸ¥æ‰€æœ‰ç›¸å…³ç›‘å¬å™¨
5. ç›‘å¬å™¨æ‰§è¡Œå…·ä½“ä¸šåŠ¡é€»è¾‘
```

**ğŸ”¹ ç»„ä»¶èŒè´£è¯´æ˜**

| ç»„ä»¶ | **ä½œç”¨** | **ç”Ÿæ´»ç±»æ¯”** | **Springæ¥å£** |
|------|---------|------------|---------------|
| ğŸ”¸ **äº‹ä»¶** | `æºå¸¦ä¿¡æ¯` | `é€šçŸ¥å†…å®¹` | `ApplicationEvent` |
| ğŸ”¸ **ç›‘å¬å™¨** | `å¤„ç†äº‹ä»¶` | `å¬ä¼—` | `ApplicationListener` |
| ğŸ”¸ **å‘å¸ƒå™¨** | `å‘é€äº‹ä»¶` | `å¹¿æ’­å‘˜` | `ApplicationEventPublisher` |
| ğŸ”¸ **å¹¿æ’­å™¨** | `åˆ†å‘äº‹ä»¶` | `å¹¿æ’­ç³»ç»Ÿ` | `ApplicationEventMulticaster` |

### 1.3 äº‹ä»¶æœºåˆ¶çš„åº”ç”¨åœºæ™¯

**ğŸ’¡ å®é™…ä¸šåŠ¡åœºæ™¯**

```
åœºæ™¯1ï¼šç”¨æˆ·æ³¨å†Œ
ä¼ ç»Ÿæ–¹å¼ï¼š
æ³¨å†Œ â†’ ä¿å­˜ç”¨æˆ· â†’ å‘é€é‚®ä»¶ â†’ å‘é€çŸ­ä¿¡ â†’ èµ é€ç§¯åˆ†
é—®é¢˜ï¼šä»£ç è€¦åˆï¼Œæµç¨‹ä¸²è¡Œ

äº‹ä»¶æ–¹å¼ï¼š
æ³¨å†Œ â†’ ä¿å­˜ç”¨æˆ· â†’ å‘å¸ƒ"ç”¨æˆ·æ³¨å†Œäº‹ä»¶"
             â†“
    ç›‘å¬å™¨1ï¼šå‘é€æ¬¢è¿é‚®ä»¶
    ç›‘å¬å™¨2ï¼šå‘é€éªŒè¯çŸ­ä¿¡  
    ç›‘å¬å™¨3ï¼šèµ é€æ–°äººç§¯åˆ†
ä¼˜åŠ¿ï¼šè§£è€¦ï¼Œå¯å¹¶è¡Œå¤„ç†

åœºæ™¯2ï¼šè®¢å•æ”¯ä»˜
æ”¯ä»˜æˆåŠŸ â†’ å‘å¸ƒ"æ”¯ä»˜æˆåŠŸäº‹ä»¶"
         â†“
    ç›‘å¬å™¨1ï¼šæ›´æ–°è®¢å•çŠ¶æ€
    ç›‘å¬å™¨2ï¼šæ‰£å‡åº“å­˜
    ç›‘å¬å™¨3ï¼šå¢åŠ ç§¯åˆ†
    ç›‘å¬å™¨4ï¼šå‘é€é€šçŸ¥

åœºæ™¯3ï¼šç³»ç»Ÿç›‘æ§
åº”ç”¨å¯åŠ¨ â†’ å‘å¸ƒ"å¯åŠ¨å®Œæˆäº‹ä»¶"
         â†“
    ç›‘å¬å™¨1ï¼šåˆå§‹åŒ–ç¼“å­˜
    ç›‘å¬å™¨2ï¼šè¿æ¥æ¶ˆæ¯é˜Ÿåˆ—
    ç›‘å¬å™¨3ï¼šå¯åŠ¨å®šæ—¶ä»»åŠ¡
```

---

## 2. ğŸ“ ApplicationEventäº‹ä»¶è¯¦è§£


### 2.1 ApplicationEventåŸºç¡€æ¦‚å¿µ

**ğŸ¯ äº‹ä»¶æ˜¯ä»€ä¹ˆ**

```
ç®€å•ç†è§£ï¼š
äº‹ä»¶å°±æ˜¯ä¸€ä¸ª"æ¶ˆæ¯å¯¹è±¡"ï¼Œç”¨æ¥æºå¸¦ä¿¡æ¯

å°±åƒå¿«é€’åŒ…è£¹ï¼š
- åŒ…è£¹æœ¬èº« = äº‹ä»¶å¯¹è±¡
- åŒ…è£¹å†…å®¹ = äº‹ä»¶æ•°æ®
- æ”¶ä»¶äººä¿¡æ¯ = äº‹ä»¶æº
- ç‰©æµä¿¡æ¯ = æ—¶é—´æˆ³
```

**ğŸ”¸ ApplicationEventæ ¸å¿ƒç‰¹ç‚¹**
```
å¿…é¡»ç»§æ‰¿ApplicationEventï¼š
- Springäº‹ä»¶çš„åŸºç±»
- å¼ºåˆ¶è¦æ±‚æœ‰äº‹ä»¶æº(source)
- è‡ªåŠ¨è®°å½•æ—¶é—´æˆ³

äº‹ä»¶æº(source)ï¼š
- è¡¨ç¤ºäº‹ä»¶çš„å‘å¸ƒè€…
- é€šå¸¸æ˜¯å‘å¸ƒäº‹ä»¶çš„å¯¹è±¡å¼•ç”¨
- å¯ä»¥ä¸ºnullï¼ˆä½†ä¸æ¨èï¼‰

æ—¶é—´æˆ³(timestamp)ï¼š
- äº‹ä»¶å‘ç”Ÿçš„æ—¶é—´
- è‡ªåŠ¨è®°å½•ï¼Œæ— éœ€æ‰‹åŠ¨è®¾ç½®
```

### 2.2 è‡ªå®šä¹‰äº‹ä»¶å®è·µ

**ğŸ“ åˆ›å»ºè‡ªå®šä¹‰äº‹ä»¶çš„æ­¥éª¤**

```java
// æ­¥éª¤1ï¼šå®šä¹‰äº‹ä»¶ç±»ï¼ˆç»§æ‰¿ApplicationEventï¼‰
public class UserRegisterEvent extends ApplicationEvent {
    
    private String username;
    private String email;
    
    // æ„é€ æ–¹æ³•å¿…é¡»è°ƒç”¨superä¼ å…¥äº‹ä»¶æº
    public UserRegisterEvent(Object source, String username, String email) {
        super(source);  // ä¼ å…¥äº‹ä»¶æº
        this.username = username;
        this.email = email;
    }
    
    // getteræ–¹æ³•
    public String getUsername() { return username; }
    public String getEmail() { return email; }
}
```

**ğŸ’¡ äº‹ä»¶è®¾è®¡æœ€ä½³å®è·µ**

```
è®¾è®¡åŸåˆ™ï¼š

1. äº‹ä»¶åº”è¯¥æ˜¯ä¸å¯å˜çš„
   - æ‰€æœ‰å­—æ®µä½¿ç”¨finalä¿®é¥°
   - åªæä¾›getterï¼Œä¸æä¾›setter
   - ä¿è¯äº‹ä»¶åœ¨ä¼ é€’è¿‡ç¨‹ä¸­ä¸è¢«ä¿®æ”¹

2. äº‹ä»¶åº”è¯¥æºå¸¦å¿…è¦ä¿¡æ¯
   - åŒ…å«ç›‘å¬å™¨éœ€è¦çš„æ‰€æœ‰æ•°æ®
   - é¿å…ç›‘å¬å™¨å†å»æŸ¥è¯¢é¢å¤–ä¿¡æ¯
   - æé«˜å¤„ç†æ•ˆç‡

3. äº‹ä»¶å‘½åè¦æœ‰æ„ä¹‰
   - ä½¿ç”¨åŠ¨è¯+åè¯ï¼šUserRegisterEvent
   - è¡¨è¾¾æ¸…æ¥šå‘ç”Ÿäº†ä»€ä¹ˆäº‹
   - è§åçŸ¥æ„

ä¸å¯å˜äº‹ä»¶ç¤ºä¾‹ï¼š
public class OrderPayEvent extends ApplicationEvent {
    private final Long orderId;      // finalä¿®é¥°
    private final BigDecimal amount; // finalä¿®é¥°
    
    public OrderPayEvent(Object source, Long orderId, BigDecimal amount) {
        super(source);
        this.orderId = orderId;
        this.amount = amount;
    }
    
    // åªæœ‰getter
    public Long getOrderId() { return orderId; }
    public BigDecimal getAmount() { return amount; }
}
```

### 2.3 æ³›å‹äº‹ä»¶çš„ä½¿ç”¨

**ğŸ”§ Spring 4.2+æ”¯æŒçš„æ³›å‹äº‹ä»¶**

```java
// ä¸ç»§æ‰¿ApplicationEventçš„æ™®é€šJavaå¯¹è±¡ä¹Ÿå¯ä»¥ä½œä¸ºäº‹ä»¶
public class EmailMessage {
    private String to;
    private String subject;
    private String content;
    
    // æ„é€ æ–¹æ³•å’Œgetter/setter
}

// å‘å¸ƒæ™®é€šå¯¹è±¡ä½œä¸ºäº‹ä»¶ï¼ˆSpringä¼šè‡ªåŠ¨åŒ…è£…ï¼‰
applicationEventPublisher.publishEvent(new EmailMessage(...));

// ç›‘å¬æ³›å‹äº‹ä»¶
@EventListener
public void handleEmailMessage(EmailMessage message) {
    // ç›´æ¥å¤„ç†EmailMessageå¯¹è±¡
    System.out.println("å‘é€é‚®ä»¶ç»™: " + message.getTo());
}
```

**ğŸ”¹ ä¼ ç»Ÿäº‹ä»¶vsæ³›å‹äº‹ä»¶å¯¹æ¯”**

| ç‰¹æ€§ | **ä¼ ç»Ÿäº‹ä»¶** | **æ³›å‹äº‹ä»¶** |
|------|------------|------------|
| ğŸ”¸ **æ˜¯å¦ç»§æ‰¿** | `å¿…é¡»ç»§æ‰¿ApplicationEvent` | `ä¸éœ€è¦ç»§æ‰¿` |
| ğŸ”¸ **äº‹ä»¶æº** | `å¿…é¡»ä¼ å…¥source` | `å¯é€‰ï¼ŒSpringè‡ªåŠ¨å¤„ç†` |
| ğŸ”¸ **ä½¿ç”¨ä¾¿æ·æ€§** | `éœ€è¦å®šä¹‰äº‹ä»¶ç±»` | `ç›´æ¥ä½¿ç”¨ä¸šåŠ¡å¯¹è±¡` |
| ğŸ”¸ **Springç‰ˆæœ¬** | `æ‰€æœ‰ç‰ˆæœ¬æ”¯æŒ` | `4.2+ç‰ˆæœ¬æ”¯æŒ` |

---

## 3. ğŸ‘‚ ApplicationListenerç›‘å¬å™¨


### 3.1 ç›‘å¬å™¨åŸºç¡€æ¦‚å¿µ

**ğŸ¯ ç›‘å¬å™¨çš„ä½œç”¨**

```
ç”Ÿæ´»ç±»æ¯”ï¼š
ç›‘å¬å™¨ = è®¢é˜…å…¬ä¼—å·çš„ç²‰ä¸
- åªå…³æ³¨æ„Ÿå…´è¶£çš„å†…å®¹ï¼ˆäº‹ä»¶ç±»å‹ï¼‰
- æ”¶åˆ°æ¨é€ç«‹å³å“åº”ï¼ˆå¤„ç†äº‹ä»¶ï¼‰
- å¯ä»¥åŒæ—¶è®¢é˜…å¤šä¸ªå…¬ä¼—å·ï¼ˆç›‘å¬å¤šç§äº‹ä»¶ï¼‰

å·¥ä½œåŸç†ï¼š
1. æ³¨å†Œç›‘å¬å™¨åˆ°Springå®¹å™¨
2. æŒ‡å®šç›‘å¬çš„äº‹ä»¶ç±»å‹
3. å½“äº‹ä»¶å‘å¸ƒæ—¶è‡ªåŠ¨è§¦å‘
4. æ‰§è¡Œç›‘å¬å™¨çš„å¤„ç†é€»è¾‘
```

### 3.2 å®ç°ç›‘å¬å™¨çš„ä¸‰ç§æ–¹å¼

**ğŸ“‹ æ–¹å¼å¯¹æ¯”ä¸é€‰æ‹©**

```
æ–¹å¼1ï¼šå®ç°æ¥å£
ä¼˜ç‚¹ï¼šç±»å‹å®‰å…¨ï¼ŒIDEæ”¯æŒå¥½
ç¼ºç‚¹ï¼šä¸€ä¸ªç±»åªèƒ½ç›‘å¬ä¸€ç§äº‹ä»¶

æ–¹å¼2ï¼š@EventListeneræ³¨è§£
ä¼˜ç‚¹ï¼šçµæ´»ï¼Œä¸€ä¸ªç±»å¯ç›‘å¬å¤šç§äº‹ä»¶
ç¼ºç‚¹ï¼šç¼–è¯‘æœŸæ— æ³•æ£€æŸ¥äº‹ä»¶ç±»å‹

æ–¹å¼3ï¼š@TransactionalEventListener
ä¼˜ç‚¹ï¼šå¯ä»¥åœ¨äº‹åŠ¡æäº¤åæ‰§è¡Œ
ç¼ºç‚¹ï¼šåªé€‚ç”¨äºäº‹åŠ¡åœºæ™¯
```

**ğŸ”§ æ–¹å¼1ï¼šå®ç°ApplicationListeneræ¥å£**

```java
@Component
public class UserRegisterListener implements ApplicationListener<UserRegisterEvent> {
    
    @Override
    public void onApplicationEvent(UserRegisterEvent event) {
        // å¤„ç†ç”¨æˆ·æ³¨å†Œäº‹ä»¶
        String username = event.getUsername();
        String email = event.getEmail();
        
        System.out.println("ç”¨æˆ·æ³¨å†ŒæˆåŠŸ: " + username);
        System.out.println("å‘é€æ¬¢è¿é‚®ä»¶åˆ°: " + email);
    }
}

// ä¼˜ç‚¹ï¼šç±»å‹å®‰å…¨ï¼Œæ³›å‹ç¡®ä¿åªæ¥æ”¶UserRegisterEvent
// ç¼ºç‚¹ï¼šæ¯ç§äº‹ä»¶éœ€è¦ä¸€ä¸ªç›‘å¬å™¨ç±»
```

**ğŸ”§ æ–¹å¼2ï¼šä½¿ç”¨@EventListeneræ³¨è§£**

```java
@Component
public class OrderEventHandler {
    
    // ç›‘å¬è®¢å•åˆ›å»ºäº‹ä»¶
    @EventListener
    public void handleOrderCreate(OrderCreateEvent event) {
        System.out.println("è®¢å•åˆ›å»º: " + event.getOrderId());
    }
    
    // ç›‘å¬è®¢å•æ”¯ä»˜äº‹ä»¶
    @EventListener
    public void handleOrderPay(OrderPayEvent event) {
        System.out.println("è®¢å•æ”¯ä»˜: " + event.getOrderId());
    }
    
    // ç›‘å¬å¤šä¸ªäº‹ä»¶ç±»å‹ï¼ˆä½¿ç”¨classeså±æ€§ï¼‰
    @EventListener(classes = {OrderCreateEvent.class, OrderPayEvent.class})
    public void handleOrderEvents(ApplicationEvent event) {
        System.out.println("æ”¶åˆ°è®¢å•äº‹ä»¶: " + event.getClass().getSimpleName());
    }
    
    // æ¡ä»¶ç›‘å¬ï¼ˆä½¿ç”¨SpELè¡¨è¾¾å¼ï¼‰
    @EventListener(condition = "#event.amount > 1000")
    public void handleLargeOrder(OrderPayEvent event) {
        System.out.println("å¤§é¢è®¢å•: " + event.getAmount());
    }
}
```

**ğŸ”§ æ–¹å¼3ï¼šäº‹åŠ¡äº‹ä»¶ç›‘å¬å™¨**

```java
@Component
public class OrderTransactionListener {
    
    // äº‹åŠ¡æäº¤åæ‰§è¡Œï¼ˆé»˜è®¤ï¼‰
    @TransactionalEventListener
    public void handleOrderAfterCommit(OrderPayEvent event) {
        // åªæœ‰äº‹åŠ¡æˆåŠŸæäº¤åæ‰æ‰§è¡Œ
        System.out.println("äº‹åŠ¡æäº¤æˆåŠŸï¼Œå‘é€æ”¯ä»˜æˆåŠŸçŸ­ä¿¡");
    }
    
    // äº‹åŠ¡å›æ»šåæ‰§è¡Œ
    @TransactionalEventListener(phase = TransactionPhase.AFTER_ROLLBACK)
    public void handleOrderAfterRollback(OrderPayEvent event) {
        System.out.println("äº‹åŠ¡å›æ»šï¼Œè®°å½•å¤±è´¥æ—¥å¿—");
    }
    
    // äº‹åŠ¡å®Œæˆåæ‰§è¡Œï¼ˆæ— è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼‰
    @TransactionalEventListener(phase = TransactionPhase.AFTER_COMPLETION)
    public void handleOrderAfterCompletion(OrderPayEvent event) {
        System.out.println("äº‹åŠ¡å®Œæˆï¼Œæ¸…ç†ä¸´æ—¶æ•°æ®");
    }
}
```

### 3.3 ç›‘å¬å™¨æ‰§è¡Œé¡ºåºæ§åˆ¶

**â° å¤šä¸ªç›‘å¬å™¨çš„æ‰§è¡Œé¡ºåº**

```java
// ä½¿ç”¨@Orderæ³¨è§£æ§åˆ¶é¡ºåºï¼ˆæ•°å­—è¶Šå°è¶Šå…ˆæ‰§è¡Œï¼‰
@Component
@Order(1)  // ç¬¬ä¸€ä¸ªæ‰§è¡Œ
public class FirstListener implements ApplicationListener<UserRegisterEvent> {
    @Override
    public void onApplicationEvent(UserRegisterEvent event) {
        System.out.println("1. ä¿å­˜ç”¨æˆ·ä¿¡æ¯");
    }
}

@Component
@Order(2)  // ç¬¬äºŒä¸ªæ‰§è¡Œ
public class SecondListener implements ApplicationListener<UserRegisterEvent> {
    @Override
    public void onApplicationEvent(UserRegisterEvent event) {
        System.out.println("2. å‘é€æ¬¢è¿é‚®ä»¶");
    }
}

@Component
@Order(3)  // ç¬¬ä¸‰ä¸ªæ‰§è¡Œ
public class ThirdListener implements ApplicationListener<UserRegisterEvent> {
    @Override
    public void onApplicationEvent(UserRegisterEvent event) {
        System.out.println("3. èµ é€æ–°äººç§¯åˆ†");
    }
}

// æ³¨è§£æ–¹å¼ä¹Ÿå¯ä»¥ä½¿ç”¨@Order
@Component
public class EmailSender {
    
    @EventListener
    @Order(1)
    public void sendWelcomeEmail(UserRegisterEvent event) {
        System.out.println("å‘é€æ¬¢è¿é‚®ä»¶");
    }
    
    @EventListener
    @Order(2)
    public void sendVerifyEmail(UserRegisterEvent event) {
        System.out.println("å‘é€éªŒè¯é‚®ä»¶");
    }
}
```

**âš¡ å¼‚æ­¥ç›‘å¬å™¨**

```java
// å¯ç”¨å¼‚æ­¥æ”¯æŒ
@Configuration
@EnableAsync
public class AsyncConfig {
    
    @Bean
    public Executor taskExecutor() {
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        executor.setCorePoolSize(5);
        executor.setMaxPoolSize(10);
        executor.setQueueCapacity(25);
        executor.setThreadNamePrefix("event-");
        executor.initialize();
        return executor;
    }
}

// å¼‚æ­¥ç›‘å¬å™¨
@Component
public class AsyncEventListener {
    
    @Async  // æ ‡è®°ä¸ºå¼‚æ­¥
    @EventListener
    public void handleEventAsync(UserRegisterEvent event) {
        // è¿™ä¸ªæ–¹æ³•ä¼šåœ¨ç‹¬ç«‹çº¿ç¨‹ä¸­æ‰§è¡Œ
        System.out.println("å¼‚æ­¥å¤„ç†: " + Thread.currentThread().getName());
        // è€—æ—¶æ“ä½œï¼Œå¦‚å‘é€é‚®ä»¶
        sendEmail(event.getEmail());
    }
}
```

---

## 4. ğŸ“¢ ApplicationEventPublisherå‘å¸ƒå™¨


### 4.1 å‘å¸ƒå™¨åŸºç¡€æ¦‚å¿µ

**ğŸ¯ å‘å¸ƒå™¨çš„ä½œç”¨**

```
ç”Ÿæ´»ç±»æ¯”ï¼š
å‘å¸ƒå™¨ = æ–°é—»å‘å¸ƒä¼šä¸»æŒäºº
- å®£å¸ƒé‡è¦æ¶ˆæ¯ï¼ˆå‘å¸ƒäº‹ä»¶ï¼‰
- ç¡®ä¿æ¶ˆæ¯ä¼ è¾¾ç»™åª’ä½“ï¼ˆç›‘å¬å™¨ï¼‰
- ä¸å…³å¿ƒåª’ä½“å¦‚ä½•æŠ¥é“ï¼ˆè§£è€¦ï¼‰

èŒè´£ï¼š
1. æ¥æ”¶äº‹ä»¶å¯¹è±¡
2. å§”æ‰˜ç»™å¹¿æ’­å™¨å¤„ç†
3. æ”¯æŒåŒæ­¥/å¼‚æ­¥å‘å¸ƒ
```

### 4.2 è·å–å‘å¸ƒå™¨çš„æ–¹å¼

**ğŸ“ ä¸‰ç§è·å–å‘å¸ƒå™¨çš„æ–¹æ³•**

```java
// æ–¹å¼1ï¼šæ³¨å…¥ApplicationEventPublisher
@Service
public class UserService {
    
    @Autowired
    private ApplicationEventPublisher eventPublisher;
    
    public void registerUser(String username, String email) {
        // ä¿å­˜ç”¨æˆ·é€»è¾‘...
        
        // å‘å¸ƒäº‹ä»¶
        UserRegisterEvent event = new UserRegisterEvent(this, username, email);
        eventPublisher.publishEvent(event);
    }
}

// æ–¹å¼2ï¼šæ³¨å…¥ApplicationContextï¼ˆå®ƒå®ç°äº†ApplicationEventPublisherï¼‰
@Service
public class OrderService {
    
    @Autowired
    private ApplicationContext applicationContext;
    
    public void createOrder(Long orderId) {
        // åˆ›å»ºè®¢å•é€»è¾‘...
        
        // é€šè¿‡ApplicationContextå‘å¸ƒäº‹ä»¶
        OrderCreateEvent event = new OrderCreateEvent(this, orderId);
        applicationContext.publishEvent(event);
    }
}

// æ–¹å¼3ï¼šå®ç°ApplicationEventPublisherAwareæ¥å£
@Component
public class EventPublisherHolder implements ApplicationEventPublisherAware {
    
    private ApplicationEventPublisher eventPublisher;
    
    @Override
    public void setApplicationEventPublisher(ApplicationEventPublisher publisher) {
        this.eventPublisher = publisher;
    }
    
    public void publishCustomEvent() {
        eventPublisher.publishEvent(new CustomEvent(this));
    }
}
```

### 4.3 å‘å¸ƒäº‹ä»¶çš„æœ€ä½³å®è·µ

**ğŸ’¡ ä½•æ—¶å‘å¸ƒäº‹ä»¶**

```
é€‚åˆå‘å¸ƒäº‹ä»¶çš„åœºæ™¯ï¼š

1. ä¸šåŠ¡æµç¨‹è§£è€¦
   ç”¨æˆ·æ³¨å†Œ â†’ å‘å¸ƒäº‹ä»¶ â†’ å„ç§åç»­æ“ä½œ
   
2. å¼‚æ­¥å¤„ç†
   è®¢å•æ”¯ä»˜ â†’ å‘å¸ƒäº‹ä»¶ â†’ å¼‚æ­¥å‘é€é€šçŸ¥
   
3. è·¨æ¨¡å—é€šä¿¡
   æ¨¡å—A â†’ å‘å¸ƒäº‹ä»¶ â†’ æ¨¡å—B/Cç›‘å¬
   
4. ç³»ç»Ÿç”Ÿå‘½å‘¨æœŸäº‹ä»¶
   åº”ç”¨å¯åŠ¨ â†’ å‘å¸ƒå¯åŠ¨å®Œæˆäº‹ä»¶
   åº”ç”¨å…³é—­ â†’ å‘å¸ƒå…³é—­äº‹ä»¶

ä¸é€‚åˆçš„åœºæ™¯ï¼š

1. ç®€å•çš„æ–¹æ³•è°ƒç”¨
   å¦‚æœåªæœ‰ä¸€ä¸ªåœ°æ–¹å¤„ç†ï¼Œç›´æ¥è°ƒç”¨æ–¹æ³•å³å¯
   
2. éœ€è¦è¿”å›å€¼çš„åœºæ™¯
   äº‹ä»¶æœºåˆ¶æ˜¯å•å‘çš„ï¼Œä¸æ”¯æŒè¿”å›å€¼
   
3. å¼ºè€¦åˆçš„ä¸šåŠ¡é€»è¾‘
   æ ¸å¿ƒä¸šåŠ¡æµç¨‹ä¸åº”è¯¥ä¾èµ–äº‹ä»¶æœºåˆ¶
```

**ğŸ”§ äº‹ä»¶å‘å¸ƒç¤ºä¾‹**

```java
@Service
public class PaymentService {
    
    @Autowired
    private ApplicationEventPublisher eventPublisher;
    
    @Transactional
    public void processPayment(Long orderId, BigDecimal amount) {
        // 1. å¤„ç†æ”¯ä»˜é€»è¾‘
        boolean paySuccess = doPayment(orderId, amount);
        
        if (paySuccess) {
            // 2. å‘å¸ƒæ”¯ä»˜æˆåŠŸäº‹ä»¶
            OrderPayEvent event = new OrderPayEvent(this, orderId, amount);
            eventPublisher.publishEvent(event);
            
            // 3. ä¹Ÿå¯ä»¥å‘å¸ƒæ™®é€šå¯¹è±¡ï¼ˆSpring 4.2+ï¼‰
            eventPublisher.publishEvent(
                new PaymentNotification(orderId, "æ”¯ä»˜æˆåŠŸ")
            );
        }
    }
    
    // æ‰¹é‡å‘å¸ƒäº‹ä»¶
    public void batchNotify(List<Long> orderIds) {
        orderIds.forEach(orderId -> {
            eventPublisher.publishEvent(
                new OrderNotifyEvent(this, orderId)
            );
        });
    }
}
```

---

## 5. ğŸ“¡ ApplicationEventMulticasterå¹¿æ’­å™¨


### 5.1 å¹¿æ’­å™¨æ ¸å¿ƒæ¦‚å¿µ

**ğŸ¯ å¹¿æ’­å™¨çš„ä½œç”¨**

```
ç”Ÿæ´»ç±»æ¯”ï¼š
å¹¿æ’­å™¨ = é‚®å±€åˆ†æ‹£ç³»ç»Ÿ
- æ¥æ”¶æ‰€æœ‰é‚®ä»¶ï¼ˆäº‹ä»¶ï¼‰
- æ ¹æ®åœ°å€åˆ†ç±»ï¼ˆäº‹ä»¶ç±»å‹ï¼‰
- æ´¾é€ç»™å¯¹åº”æ”¶ä»¶äººï¼ˆç›‘å¬å™¨ï¼‰

æ ¸å¿ƒèŒè´£ï¼š
1. ç®¡ç†æ‰€æœ‰ç›‘å¬å™¨
2. æ¥æ”¶å‘å¸ƒçš„äº‹ä»¶
3. æ‰¾åˆ°åŒ¹é…çš„ç›‘å¬å™¨
4. é€šçŸ¥ç›‘å¬å™¨å¤„ç†äº‹ä»¶
```

**ğŸ”¹ å·¥ä½œæµç¨‹å›¾ç¤º**

```
äº‹ä»¶å‘å¸ƒæµç¨‹ï¼š

å‘å¸ƒå™¨.publishEvent(event)
         â”‚
         â–¼
    å¹¿æ’­å™¨æ¥æ”¶äº‹ä»¶
         â”‚
         â–¼
    éå†æ‰€æœ‰ç›‘å¬å™¨
         â”‚
         â–¼
   æ£€æŸ¥æ˜¯å¦æ”¯æŒæ­¤äº‹ä»¶ç±»å‹
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â–¼         â–¼
  æ”¯æŒ      ä¸æ”¯æŒ
    â”‚         â”‚
    â–¼         â””â”€â†’ è·³è¿‡
 è°ƒç”¨ç›‘å¬å™¨
    â”‚
    â–¼
  å¤„ç†å®Œæˆ
```

### 5.2 è‡ªå®šä¹‰å¹¿æ’­å™¨é…ç½®

**ğŸ”§ å®šåˆ¶å¹¿æ’­å™¨è¡Œä¸º**

```java
@Configuration
public class EventConfig {
    
    // è‡ªå®šä¹‰å¹¿æ’­å™¨Bean
    @Bean
    public ApplicationEventMulticaster applicationEventMulticaster() {
        SimpleApplicationEventMulticaster multicaster = 
            new SimpleApplicationEventMulticaster();
        
        // è®¾ç½®çº¿ç¨‹æ± ï¼Œæ”¯æŒå¼‚æ­¥äº‹ä»¶
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        executor.setCorePoolSize(5);
        executor.setMaxPoolSize(10);
        executor.setQueueCapacity(100);
        executor.setThreadNamePrefix("event-multicaster-");
        executor.initialize();
        
        multicaster.setTaskExecutor(executor);
        
        // è®¾ç½®é”™è¯¯å¤„ç†å™¨
        multicaster.setErrorHandler(t -> {
            System.err.println("äº‹ä»¶å¤„ç†å¼‚å¸¸: " + t.getMessage());
            // å¯ä»¥è®°å½•æ—¥å¿—ã€å‘é€å‘Šè­¦ç­‰
        });
        
        return multicaster;
    }
}
```

**âš¡ åŒæ­¥vså¼‚æ­¥å¹¿æ’­**

```
åŒæ­¥å¹¿æ’­ï¼ˆé»˜è®¤ï¼‰ï¼š
ç‰¹ç‚¹ï¼šæŒ‰é¡ºåºæ‰§è¡Œæ‰€æœ‰ç›‘å¬å™¨
ä¼˜ç‚¹ï¼šå¯ä»¥ä¿è¯æ‰§è¡Œé¡ºåºï¼Œç®€å•å¯é 
ç¼ºç‚¹ï¼šå¦‚æœæŸä¸ªç›‘å¬å™¨è€—æ—¶ï¼Œä¼šé˜»å¡åç»­å¤„ç†

ä½¿ç”¨åœºæ™¯ï¼š
- éœ€è¦ä¿è¯é¡ºåºçš„ä¸šåŠ¡
- ç›‘å¬å™¨æ‰§è¡Œå¿«é€Ÿçš„åœºæ™¯
- éœ€è¦äº‹åŠ¡ä¸€è‡´æ€§çš„æ“ä½œ

å¼‚æ­¥å¹¿æ’­ï¼š
ç‰¹ç‚¹ï¼šæ¯ä¸ªç›‘å¬å™¨åœ¨ç‹¬ç«‹çº¿ç¨‹æ‰§è¡Œ
ä¼˜ç‚¹ï¼šä¸é˜»å¡ä¸»æµç¨‹ï¼Œæé«˜å“åº”é€Ÿåº¦
ç¼ºç‚¹ï¼šæ— æ³•ä¿è¯é¡ºåºï¼Œé”™è¯¯å¤„ç†å¤æ‚

ä½¿ç”¨åœºæ™¯ï¼š
- å‘é€é€šçŸ¥ã€é‚®ä»¶ç­‰IOæ“ä½œ
- è®°å½•æ—¥å¿—ã€ç»Ÿè®¡ç­‰è¾…åŠ©åŠŸèƒ½
- ä¸å½±å“ä¸»æµç¨‹çš„æ“ä½œ
```

### 5.3 å¹¿æ’­å™¨å†…éƒ¨æœºåˆ¶

**ğŸ” å¹¿æ’­å™¨å¦‚ä½•æŸ¥æ‰¾ç›‘å¬å™¨**

```
ç›‘å¬å™¨åŒ¹é…è¿‡ç¨‹ï¼š

1. è·å–äº‹ä»¶ç±»å‹
   Class<?> eventType = event.getClass();

2. éå†æ‰€æœ‰å·²æ³¨å†Œçš„ç›‘å¬å™¨
   for (ApplicationListener listener : listeners) {
       ...
   }

3. æ£€æŸ¥ç›‘å¬å™¨æ˜¯å¦æ”¯æŒæ­¤äº‹ä»¶
   é€šè¿‡æ³›å‹è§£ææˆ–æ³¨è§£åŒ¹é…
   
4. æ”¯æŒçš„ç›‘å¬å™¨åŠ å…¥æ‰§è¡Œåˆ—è¡¨

5. æŒ‰@Orderé¡ºåºæ’åº

6. ä¾æ¬¡è°ƒç”¨ç›‘å¬å™¨

å®é™…æ‰§è¡Œä»£ç é€»è¾‘ï¼š
public void multicastEvent(ApplicationEvent event) {
    // æŸ¥æ‰¾æ”¯æŒæ­¤äº‹ä»¶çš„ç›‘å¬å™¨
    Collection<ApplicationListener<?>> listeners = 
        getApplicationListeners(event);
    
    // ä¾æ¬¡è°ƒç”¨
    for (ApplicationListener listener : listeners) {
        // åŒæ­¥æˆ–å¼‚æ­¥æ‰§è¡Œ
        if (executor != null) {
            executor.execute(() -> invokeListener(listener, event));
        } else {
            invokeListener(listener, event);
        }
    }
}
```

---

## 6. ğŸ”— äº‹ä»¶ç»§æ‰¿ä½“ç³»


### 6.1 äº‹ä»¶ç»§æ‰¿çš„æ¦‚å¿µ

**ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦äº‹ä»¶ç»§æ‰¿**

```
ç”Ÿæ´»ç±»æ¯”ï¼š
åŠ¨ç‰©åˆ†ç±» = äº‹ä»¶åˆ†ç±»
- åŠ¨ç‰©ï¼ˆåŸºç±»äº‹ä»¶ï¼‰
  â”œâ”€ å“ºä¹³åŠ¨ç‰©ï¼ˆå­ç±»äº‹ä»¶ï¼‰
  â”‚  â”œâ”€ çŒ«ï¼ˆå…·ä½“äº‹ä»¶ï¼‰
  â”‚  â””â”€ ç‹—ï¼ˆå…·ä½“äº‹ä»¶ï¼‰
  â””â”€ é¸Ÿç±»ï¼ˆå­ç±»äº‹ä»¶ï¼‰

å¥½å¤„ï¼š
- å¯ä»¥ç›‘å¬æ‰€æœ‰åŠ¨ç‰©
- å¯ä»¥åªç›‘å¬å“ºä¹³åŠ¨ç‰©
- å¯ä»¥ç²¾ç¡®ç›‘å¬çŒ«
```

**ğŸ”¸ äº‹ä»¶ç»§æ‰¿çš„å®é™…åº”ç”¨**

```java
// åŸºç¡€è®¢å•äº‹ä»¶
public abstract class OrderEvent extends ApplicationEvent {
    private final Long orderId;
    
    public OrderEvent(Object source, Long orderId) {
        super(source);
        this.orderId = orderId;
    }
    
    public Long getOrderId() { return orderId; }
}

// å…·ä½“çš„è®¢å•äº‹ä»¶
public class OrderCreateEvent extends OrderEvent {
    public OrderCreateEvent(Object source, Long orderId) {
        super(source, orderId);
    }
}

public class OrderPayEvent extends OrderEvent {
    private final BigDecimal amount;
    
    public OrderPayEvent(Object source, Long orderId, BigDecimal amount) {
        super(source, orderId);
        this.amount = amount;
    }
    
    public BigDecimal getAmount() { return amount; }
}

public class OrderCancelEvent extends OrderEvent {
    private final String reason;
    
    public OrderCancelEvent(Object source, Long orderId, String reason) {
        super(source, orderId);
        this.reason = reason;
    }
    
    public String getReason() { return reason; }
}
```

### 6.2 ç›‘å¬å™¨çš„ç»§æ‰¿åŒ¹é…

**ğŸ“‹ ç›‘å¬çˆ¶ç±»äº‹ä»¶çš„æ•ˆæœ**

```java
// ç›‘å¬æ‰€æœ‰è®¢å•äº‹ä»¶ï¼ˆçˆ¶ç±»ï¼‰
@Component
public class AllOrderEventListener implements ApplicationListener<OrderEvent> {
    
    @Override
    public void onApplicationEvent(OrderEvent event) {
        // å¯ä»¥æ¥æ”¶æ‰€æœ‰OrderEventçš„å­ç±»äº‹ä»¶
        System.out.println("è®¢å•äº‹ä»¶: " + event.getClass().getSimpleName());
        System.out.println("è®¢å•ID: " + event.getOrderId());
        
        // æ ¹æ®å…·ä½“ç±»å‹åšä¸åŒå¤„ç†
        if (event instanceof OrderCreateEvent) {
            System.out.println("è®¢å•åˆ›å»º");
        } else if (event instanceof OrderPayEvent) {
            OrderPayEvent payEvent = (OrderPayEvent) event;
            System.out.println("è®¢å•æ”¯ä»˜: " + payEvent.getAmount());
        } else if (event instanceof OrderCancelEvent) {
            OrderCancelEvent cancelEvent = (OrderCancelEvent) event;
            System.out.println("è®¢å•å–æ¶ˆ: " + cancelEvent.getReason());
        }
    }
}

// åªç›‘å¬ç‰¹å®šçš„è®¢å•äº‹ä»¶
@Component
public class PayEventListener implements ApplicationListener<OrderPayEvent> {
    
    @Override
    public void onApplicationEvent(OrderPayEvent event) {
        // åªæ¥æ”¶OrderPayEvent
        System.out.println("å¤„ç†æ”¯ä»˜: " + event.getAmount());
    }
}
```

**ğŸ’¡ ç»§æ‰¿å±‚æ¬¡è®¾è®¡å»ºè®®**

```
ç»§æ‰¿å±‚æ¬¡è®¾è®¡åŸåˆ™ï¼š

1. ä¸è¦è¿‡æ·±
   æœ€å¤š3å±‚ç»§æ‰¿ï¼ˆApplicationEvent â†’ ä¸šåŠ¡åŸºç±» â†’ å…·ä½“äº‹ä»¶ï¼‰
   
2. æŠ½è±¡åˆç†çš„åŸºç±»
   åŸºç±»åŒ…å«å…¬å…±å±æ€§å’Œè¡Œä¸º
   
3. ä¾¿äºæ‰¹é‡å¤„ç†
   å¯ä»¥ç›‘å¬åŸºç±»å¤„ç†é€šç”¨é€»è¾‘
   
4. ä¿æŒè¯­ä¹‰æ¸…æ™°
   äº‹ä»¶åç§°è¦è¡¨è¾¾æ¸…æ¥šä¸šåŠ¡å«ä¹‰

ç¤ºä¾‹å±‚æ¬¡ç»“æ„ï¼š
ApplicationEventï¼ˆSpringåŸºç±»ï¼‰
    â””â”€ DomainEventï¼ˆé¢†åŸŸäº‹ä»¶åŸºç±»ï¼‰
        â”œâ”€ UserEventï¼ˆç”¨æˆ·ç›¸å…³äº‹ä»¶ï¼‰
        â”‚   â”œâ”€ UserRegisterEvent
        â”‚   â”œâ”€ UserLoginEvent
        â”‚   â””â”€ UserLogoutEvent
        â””â”€ OrderEventï¼ˆè®¢å•ç›¸å…³äº‹ä»¶ï¼‰
            â”œâ”€ OrderCreateEvent
            â”œâ”€ OrderPayEvent
            â””â”€ OrderCancelEvent
```

---

## 7. ğŸ“‚ äº‹ä»¶åˆ†ç±»ä¸åº”ç”¨


### 7.1 Springå†…ç½®äº‹ä»¶

**ğŸ”¸ å®¹å™¨ç”Ÿå‘½å‘¨æœŸäº‹ä»¶**

```java
// 1. ContextRefreshedEvent - å®¹å™¨åˆ·æ–°å®Œæˆ
@Component
public class ApplicationReadyListener {
    
    @EventListener
    public void onContextRefreshed(ContextRefreshedEvent event) {
        System.out.println("Springå®¹å™¨åˆå§‹åŒ–å®Œæˆ");
        // é€‚åˆåšä¸€äº›åˆå§‹åŒ–å·¥ä½œ
        // å¦‚ï¼šåŠ è½½ç¼“å­˜ã€é¢„çƒ­æ•°æ®ç­‰
    }
}

// 2. ContextStartedEvent - å®¹å™¨å¯åŠ¨
@Component
public class ApplicationStartListener {
    
    @EventListener
    public void onContextStarted(ContextStartedEvent event) {
        System.out.println("Springå®¹å™¨å·²å¯åŠ¨");
    }
}

// 3. ContextStoppedEvent - å®¹å™¨åœæ­¢
@Component
public class ApplicationStopListener {
    
    @EventListener
    public void onContextStopped(ContextStoppedEvent event) {
        System.out.println("Springå®¹å™¨å·²åœæ­¢");
        // é€‚åˆåšæ¸…ç†å·¥ä½œ
    }
}

// 4. ContextClosedEvent - å®¹å™¨å…³é—­
@Component
public class ApplicationCloseListener {
    
    @EventListener
    public void onContextClosed(ContextClosedEvent event) {
        System.out.println("Springå®¹å™¨å³å°†å…³é—­");
        // é‡Šæ”¾èµ„æºã€ä¿å­˜çŠ¶æ€ç­‰
    }
}
```

**ğŸ”¹ Spring Bootæ‰©å±•äº‹ä»¶**

```java
// ApplicationStartingEvent - åº”ç”¨å¼€å§‹å¯åŠ¨
@Component
public class StartingListener {
    @EventListener
    public void onStarting(ApplicationStartingEvent event) {
        System.out.println("åº”ç”¨å¼€å§‹å¯åŠ¨");
    }
}

// ApplicationEnvironmentPreparedEvent - ç¯å¢ƒå‡†å¤‡å°±ç»ª
@Component  
public class EnvironmentPreparedListener {
    @EventListener
    public void onEnvironmentPrepared(ApplicationEnvironmentPreparedEvent event) {
        System.out.println("ç¯å¢ƒé…ç½®åŠ è½½å®Œæˆ");
    }
}

// ApplicationReadyEvent - åº”ç”¨å¯åŠ¨å®Œæˆ
@Component
public class ReadyListener {
    @EventListener
    public void onApplicationReady(ApplicationReadyEvent event) {
        System.out.println("åº”ç”¨å¯åŠ¨å®Œæˆï¼Œå¯ä»¥æ¥æ”¶è¯·æ±‚");
    }
}

// ApplicationFailedEvent - åº”ç”¨å¯åŠ¨å¤±è´¥
@Component
public class FailedListener {
    @EventListener
    public void onApplicationFailed(ApplicationFailedEvent event) {
        System.out.println("åº”ç”¨å¯åŠ¨å¤±è´¥");
        System.err.println(event.getException().getMessage());
    }
}
```

### 7.2 ä¸šåŠ¡è‡ªå®šä¹‰äº‹ä»¶åˆ†ç±»

**ğŸ“Š æŒ‰ä¸šåŠ¡é¢†åŸŸåˆ†ç±»**

```
ç”¨æˆ·é¢†åŸŸäº‹ä»¶ï¼š
UserRegisterEvent      - ç”¨æˆ·æ³¨å†Œ
UserLoginEvent         - ç”¨æˆ·ç™»å½•
UserLogoutEvent        - ç”¨æˆ·ç™»å‡º
UserProfileUpdateEvent - ç”¨æˆ·ä¿¡æ¯æ›´æ–°

è®¢å•é¢†åŸŸäº‹ä»¶ï¼š
OrderCreateEvent  - è®¢å•åˆ›å»º
OrderPayEvent     - è®¢å•æ”¯ä»˜
OrderShipEvent    - è®¢å•å‘è´§
OrderReceiveEvent - è®¢å•æ”¶è´§
OrderCancelEvent  - è®¢å•å–æ¶ˆ
OrderRefundEvent  - è®¢å•é€€æ¬¾

å•†å“é¢†åŸŸäº‹ä»¶ï¼š
ProductCreateEvent    - å•†å“åˆ›å»º
ProductUpdateEvent    - å•†å“æ›´æ–°
ProductDeleteEvent    - å•†å“åˆ é™¤
ProductStockChangeEvent - åº“å­˜å˜åŒ–

æ”¯ä»˜é¢†åŸŸäº‹ä»¶ï¼š
PaymentSuccessEvent - æ”¯ä»˜æˆåŠŸ
PaymentFailEvent    - æ”¯ä»˜å¤±è´¥
RefundSuccessEvent  - é€€æ¬¾æˆåŠŸ
RefundFailEvent     - é€€æ¬¾å¤±è´¥
```

### 7.3 äº‹ä»¶åˆ†ç±»çš„æœ€ä½³å®è·µ

**ğŸ’¡ å¦‚ä½•ç»„ç»‡äº‹ä»¶ä»£ç **

```
æ¨èçš„åŒ…ç»“æ„ï¼š

com.example.project
â”œâ”€â”€ event
â”‚   â”œâ”€â”€ base              # åŸºç¡€äº‹ä»¶ç±»
â”‚   â”‚   â””â”€â”€ DomainEvent.java
â”‚   â”œâ”€â”€ user              # ç”¨æˆ·äº‹ä»¶
â”‚   â”‚   â”œâ”€â”€ UserRegisterEvent.java
â”‚   â”‚   â”œâ”€â”€ UserLoginEvent.java
â”‚   â”‚   â””â”€â”€ UserLogoutEvent.java
â”‚   â”œâ”€â”€ order             # è®¢å•äº‹ä»¶
â”‚   â”‚   â”œâ”€â”€ OrderCreateEvent.java
â”‚   â”‚   â”œâ”€â”€ OrderPayEvent.java
â”‚   â”‚   â””â”€â”€ OrderCancelEvent.java
â”‚   â””â”€â”€ listener          # ç›‘å¬å™¨
â”‚       â”œâ”€â”€ UserEventListener.java
â”‚       â”œâ”€â”€ OrderEventListener.java
â”‚       â””â”€â”€ NotificationListener.java
â””â”€â”€ service
    â”œâ”€â”€ UserService.java
    â”œâ”€â”€ OrderService.java
    â””â”€â”€ NotificationService.java

å‘½åè§„èŒƒï¼š
- äº‹ä»¶ç±»ï¼š{åŠ¨ä½œ}{åè¯}Event
  ä¾‹å¦‚ï¼šUserRegisterEventï¼ˆåŠ¨ä½œï¼šæ³¨å†Œï¼Œåè¯ï¼šç”¨æˆ·ï¼‰
  
- ç›‘å¬å™¨ç±»ï¼š{ä¸šåŠ¡}EventListener æˆ– {ä¸šåŠ¡}{åŠ¨ä½œ}Listener
  ä¾‹å¦‚ï¼šUserEventListener æˆ– EmailSendListener
  
- åŒ…åï¼šæŒ‰ä¸šåŠ¡é¢†åŸŸåˆ’åˆ†
  ä¾‹å¦‚ï¼ševent.userã€event.order
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ äº‹ä»¶æœºåˆ¶æœ¬è´¨ï¼šè§‚å¯Ÿè€…æ¨¡å¼çš„Springå®ç°ï¼Œå®ç°å‘å¸ƒè€…ä¸è®¢é˜…è€…è§£è€¦
ğŸ”¸ å››å¤§æ ¸å¿ƒç»„ä»¶ï¼šäº‹ä»¶(Event)ã€ç›‘å¬å™¨(Listener)ã€å‘å¸ƒå™¨(Publisher)ã€å¹¿æ’­å™¨(Multicaster)
ğŸ”¸ äº‹ä»¶å®šä¹‰ï¼šç»§æ‰¿ApplicationEventæˆ–ä½¿ç”¨æ™®é€šPOJOï¼ˆSpring 4.2+ï¼‰
ğŸ”¸ ç›‘å¬å™¨å®ç°ï¼šæ¥å£å®ç°ã€@EventListeneræ³¨è§£ã€@TransactionalEventListener
ğŸ”¸ äº‹ä»¶å‘å¸ƒï¼šé€šè¿‡ApplicationEventPublisher.publishEvent()
ğŸ”¸ äº‹ä»¶ç»§æ‰¿ï¼šå­ç±»äº‹ä»¶å¯ä»¥è¢«ç›‘å¬çˆ¶ç±»çš„ç›‘å¬å™¨æ¥æ”¶
ğŸ”¸ æ‰§è¡Œæ§åˆ¶ï¼š@Orderæ§åˆ¶é¡ºåºã€@Asyncæ”¯æŒå¼‚æ­¥
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ äº‹ä»¶æœºåˆ¶çš„æ ¸å¿ƒä»·å€¼**
```
è§£è€¦ä»·å€¼ï¼š
- å‘å¸ƒè€…ä¸çŸ¥é“è°åœ¨ç›‘å¬
- ç›‘å¬è€…ä¸çŸ¥é“è°åœ¨å‘å¸ƒ
- é€šè¿‡äº‹ä»¶å¯¹è±¡é—´æ¥é€šä¿¡
- æ–°å¢ç›‘å¬å™¨æ— éœ€ä¿®æ”¹å‘å¸ƒä»£ç 

æ‰©å±•æ€§ï¼š
- ä¸€å¯¹å¤šé€šä¿¡æ¨¡å¼
- åŠ¨æ€æ·»åŠ åˆ é™¤ç›‘å¬å™¨
- æ”¯æŒæ¡ä»¶è¿‡æ»¤å’Œä¼˜å…ˆçº§

å®é™…æ”¶ç›Šï¼š
- ä»£ç å¯ç»´æŠ¤æ€§æå‡
- ä¸šåŠ¡é€»è¾‘æ›´æ¸…æ™°
- ç³»ç»Ÿæ›´æ˜“æ‰©å±•
```

**ğŸ”¹ åŒæ­¥vså¼‚æ­¥äº‹ä»¶å¤„ç†**
```
åŒæ­¥å¤„ç†ï¼š
é€‚ç”¨åœºæ™¯ï¼šéœ€è¦é¡ºåºä¿è¯ã€äº‹åŠ¡ä¸€è‡´æ€§è¦æ±‚
å®ç°æ–¹å¼ï¼šé»˜è®¤æ–¹å¼ï¼Œç›‘å¬å™¨æŒ‰é¡ºåºæ‰§è¡Œ
æ³¨æ„äº‹é¡¹ï¼šè€—æ—¶æ“ä½œä¼šé˜»å¡ä¸»æµç¨‹

å¼‚æ­¥å¤„ç†ï¼š
é€‚ç”¨åœºæ™¯ï¼šIOæ“ä½œã€å‘é€é€šçŸ¥ã€æ—¥å¿—è®°å½•
å®ç°æ–¹å¼ï¼š@Asyncæ³¨è§£æˆ–é…ç½®çº¿ç¨‹æ± 
æ³¨æ„äº‹é¡¹ï¼šæ— æ³•ä¿è¯æ‰§è¡Œé¡ºåºã€å¼‚å¸¸å¤„ç†å¤æ‚

é€‰æ‹©åŸåˆ™ï¼š
- æ ¸å¿ƒä¸šåŠ¡ â†’ åŒæ­¥
- è¾…åŠ©åŠŸèƒ½ â†’ å¼‚æ­¥
- éœ€è¦è¿”å›å€¼ â†’ åŒæ­¥
- ä¸å…³å¿ƒç»“æœ â†’ å¼‚æ­¥
```

**ğŸ”¹ äº‹ä»¶ç»§æ‰¿çš„åº”ç”¨åœºæ™¯**
```
ä½•æ—¶ä½¿ç”¨ç»§æ‰¿ï¼š
- å¤šä¸ªäº‹ä»¶æœ‰å…¬å…±å±æ€§
- éœ€è¦ç»Ÿä¸€å¤„ç†ä¸€ç±»äº‹ä»¶
- ä¾¿äºæ‰©å±•æ–°çš„äº‹ä»¶ç±»å‹

è®¾è®¡å»ºè®®ï¼š
- ç»§æ‰¿å±‚æ¬¡ä¸è¦å¤ªæ·±ï¼ˆâ‰¤3å±‚ï¼‰
- åŸºç±»å®šä¹‰å…¬å…±å±æ€§å’Œè¡Œä¸º
- å­ç±»æ·»åŠ ç‰¹æœ‰å±æ€§
- ä¿æŒè¯­ä¹‰æ¸…æ™°

å®é™…æ¡ˆä¾‹ï¼š
åŸºç±»ï¼šOrderEventï¼ˆè®¢å•IDã€æ—¶é—´æˆ³ï¼‰
  â”œâ”€ OrderCreateEventï¼ˆè®¢å•è¯¦æƒ…ï¼‰
  â”œâ”€ OrderPayEventï¼ˆæ”¯ä»˜é‡‘é¢ï¼‰
  â””â”€ OrderCancelEventï¼ˆå–æ¶ˆåŸå› ï¼‰
```

### 8.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ å…¸å‹åº”ç”¨åœºæ™¯**
- **ç”µå•†ç³»ç»Ÿ**ï¼šè®¢å•æµç¨‹è§£è€¦ï¼ˆä¸‹å•â†’æ”¯ä»˜â†’å‘è´§â†’æ”¶è´§ï¼‰
- **ç”¨æˆ·ç³»ç»Ÿ**ï¼šæ³¨å†Œæµç¨‹è§£è€¦ï¼ˆæ³¨å†Œâ†’å‘é‚®ä»¶â†’é€ç§¯åˆ†â†’è®°æ—¥å¿—ï¼‰
- **æ¶ˆæ¯æ¨é€**ï¼šäº‹ä»¶è§¦å‘å¤šæ¸ é“é€šçŸ¥ï¼ˆé‚®ä»¶ã€çŸ­ä¿¡ã€ç«™å†…ä¿¡ï¼‰
- **ç³»ç»Ÿç›‘æ§**ï¼šä¸šåŠ¡äº‹ä»¶è§¦å‘ç›‘æ§å‘Šè­¦å’Œæ—¥å¿—è®°å½•

**ğŸ”§ å¼€å‘å®è·µå»ºè®®**
- **åˆç†æ‹†åˆ†**ï¼šå¤æ‚ä¸šåŠ¡æµç¨‹æ‹†åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹äº‹ä»¶
- **ç»Ÿä¸€ç®¡ç†**ï¼šäº‹ä»¶ç±»æŒ‰ä¸šåŠ¡é¢†åŸŸç»„ç»‡ï¼Œä¾¿äºç»´æŠ¤
- **å¼‚å¸¸å¤„ç†**ï¼šå¼‚æ­¥äº‹ä»¶è¦æœ‰å®Œå–„çš„å¼‚å¸¸å¤„ç†æœºåˆ¶
- **æ€§èƒ½è€ƒè™‘**ï¼šå¤§é‡äº‹ä»¶ä½¿ç”¨çº¿ç¨‹æ± ï¼Œé¿å…èµ„æºè€—å°½

**ğŸ“ˆ è¿›é˜¶å­¦ä¹ æ–¹å‘**
- **äº‹ä»¶æº¯æº**ï¼šEvent Sourcingæ¨¡å¼çš„åº”ç”¨
- **CQRSæ¶æ„**ï¼šç»“åˆå‘½ä»¤æŸ¥è¯¢èŒè´£åˆ†ç¦»
- **åˆ†å¸ƒå¼äº‹ä»¶**ï¼šSpring Cloud Streamäº‹ä»¶é©±åŠ¨
- **äº‹ä»¶æ€»çº¿**ï¼šGuava EventBusã€MBassadorç­‰æ¡†æ¶

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- äº‹ä»¶æœºåˆ¶è§£è€¦åˆï¼Œå‘å¸ƒç›‘å¬å„è‡ªå¿™
- ç»§æ‰¿ä½“ç³»å·§è®¾è®¡ï¼Œçˆ¶ç±»å­ç±»äº’åä½œ
- åŒæ­¥å¼‚æ­¥è¦åˆ†æ¸…ï¼Œä¸šåŠ¡åœºæ™¯é€‰æ–¹å¼
- å››å¤§ç»„ä»¶è¦è®°ç‰¢ï¼ŒSpringå®¹å™¨å¸®ä½ å¿™