---
title: 9ã€æ¡ä»¶äº‹ä»¶ç›‘å¬
---
## ğŸ“š ç›®å½•

1. [æ¡ä»¶äº‹ä»¶ç›‘å¬çš„åŸºæœ¬æ¦‚å¿µ](#1-æ¡ä»¶äº‹ä»¶ç›‘å¬çš„åŸºæœ¬æ¦‚å¿µ)
2. [æ¡ä»¶è¡¨è¾¾å¼è¯¦è§£](#2-æ¡ä»¶è¡¨è¾¾å¼è¯¦è§£)
3. [SpELæ¡ä»¶åˆ¤æ–­æœºåˆ¶](#3-spelæ¡ä»¶åˆ¤æ–­æœºåˆ¶)
4. [é€‰æ‹©æ€§ç›‘å¬ç­–ç•¥](#4-é€‰æ‹©æ€§ç›‘å¬ç­–ç•¥)
5. [åŠ¨æ€è¿‡æ»¤æŠ€æœ¯](#5-åŠ¨æ€è¿‡æ»¤æŠ€æœ¯)
6. [ä¸Šä¸‹æ–‡æ¡ä»¶åº”ç”¨](#6-ä¸Šä¸‹æ–‡æ¡ä»¶åº”ç”¨)
7. [ç¯å¢ƒæ„ŸçŸ¥é…ç½®](#7-ç¯å¢ƒæ„ŸçŸ¥é…ç½®)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ æ¡ä»¶äº‹ä»¶ç›‘å¬çš„åŸºæœ¬æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯æ¡ä»¶äº‹ä»¶ç›‘å¬


**é€šä¿—ç†è§£**ï¼š
æƒ³è±¡ä½ åœ¨ä¸€ä¸ªæ´¾å¯¹ä¸Šï¼Œä¸æ˜¯æ¯ä¸ªäººè¯´è¯ä½ éƒ½è¦å›åº”ã€‚ä½ å¯èƒ½åªå¯¹ç‰¹å®šè¯é¢˜æ„Ÿå…´è¶£ï¼Œæ¯”å¦‚åªå¬å…³äºç¾é£Ÿçš„è®¨è®ºï¼Œå…¶ä»–è¯é¢˜å°±è‡ªåŠ¨è¿‡æ»¤æ‰ã€‚æ¡ä»¶äº‹ä»¶ç›‘å¬å°±æ˜¯è¿™æ ·â€”â€”è®©ç›‘å¬å™¨åªå¤„ç†ç¬¦åˆç‰¹å®šæ¡ä»¶çš„äº‹ä»¶ã€‚

**ä¸“ä¸šå®šä¹‰**ï¼š
æ¡ä»¶äº‹ä»¶ç›‘å¬æ˜¯Springäº‹ä»¶æœºåˆ¶çš„é«˜çº§ç‰¹æ€§ï¼Œå…è®¸ç›‘å¬å™¨æ ¹æ®é¢„å®šä¹‰çš„æ¡ä»¶è¡¨è¾¾å¼ï¼Œ**é€‰æ‹©æ€§åœ°**å“åº”äº‹ä»¶ï¼Œè€Œä¸æ˜¯è¢«åŠ¨æ¥æ”¶æ‰€æœ‰äº‹ä»¶ã€‚

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦æ¡ä»¶ç›‘å¬


**å®é™…é—®é¢˜åœºæ™¯**ï¼š
```
åœºæ™¯ï¼šç”µå•†ç³»ç»Ÿçš„è®¢å•äº‹ä»¶
é—®é¢˜ï¼šè®¢å•åˆ›å»ºäº‹ä»¶ä¼šè§¦å‘å¤šä¸ªç›‘å¬å™¨

æ™®é€šç›‘å¬çš„å›°å¢ƒï¼š
ç›‘å¬å™¨Aï¼šå¤„ç†æ‰€æœ‰è®¢å•ï¼ˆåŒ…æ‹¬æµ‹è¯•è®¢å•ï¼‰âŒ
ç›‘å¬å™¨Bï¼šå¤„ç†æ‰€æœ‰è®¢å•ï¼ˆå³ä½¿é‡‘é¢ä¸º0ï¼‰âŒ  
ç›‘å¬å™¨Cï¼šå¤„ç†æ‰€æœ‰è®¢å•ï¼ˆä¸ç®¡çŠ¶æ€ï¼‰âŒ

ç†æƒ³çš„æ¡ä»¶ç›‘å¬ï¼š
ç›‘å¬å™¨Aï¼šåªå¤„ç†é‡‘é¢>100çš„æ­£å¼è®¢å• âœ…
ç›‘å¬å™¨Bï¼šåªå¤„ç†VIPç”¨æˆ·çš„è®¢å• âœ…
ç›‘å¬å™¨Cï¼šåªå¤„ç†ç‰¹å®šåœ°åŒºçš„è®¢å• âœ…
```

**æ ¸å¿ƒä»·å€¼**ï¼š
- ğŸ¯ **ç²¾å‡†å“åº”** - é¿å…æ— æ•ˆå¤„ç†
- âš¡ **æ€§èƒ½ä¼˜åŒ–** - å‡å°‘ä¸å¿…è¦çš„ä¸šåŠ¡é€»è¾‘æ‰§è¡Œ
- ğŸ”§ **çµæ´»æ§åˆ¶** - æ ¹æ®ä¸šåŠ¡è§„åˆ™åŠ¨æ€è°ƒæ•´

### 1.3 æ¡ä»¶ç›‘å¬çš„å·¥ä½œåŸç†


**æ‰§è¡Œæµç¨‹å›¾ç¤º**ï¼š
```
äº‹ä»¶å‘å¸ƒ
   â†“
Springå®¹å™¨æ¥æ”¶
   â†“
[æ¡ä»¶åˆ¤æ–­] â† è¿™é‡Œæ˜¯å…³é”®ï¼
   â†“
æ¡ä»¶æ»¡è¶³ï¼Ÿ
â”œâ”€ æ˜¯ â†’ æ‰§è¡Œç›‘å¬å™¨é€»è¾‘
â””â”€ å¦ â†’ ç›´æ¥è·³è¿‡ï¼Œä¸æ‰§è¡Œ
```

**ä¸‰ä¸ªæ ¸å¿ƒç¯èŠ‚**ï¼š
1. **æ¡ä»¶å®šä¹‰** - å‘Šè¯‰Springä»€ä¹ˆæƒ…å†µä¸‹æ‰æ‰§è¡Œ
2. **æ¡ä»¶è¯„ä¼°** - Springè‡ªåŠ¨æ£€æŸ¥æ¡ä»¶æ˜¯å¦æ»¡è¶³
3. **é€‰æ‹©æ‰§è¡Œ** - æ»¡è¶³æ¡ä»¶æ‰è°ƒç”¨ç›‘å¬å™¨æ–¹æ³•

---

## 2. ğŸ“ æ¡ä»¶è¡¨è¾¾å¼è¯¦è§£


### 2.1 æ¡ä»¶è¡¨è¾¾å¼çš„åŸºæœ¬ç”¨æ³•


**@EventListenerçš„conditionå±æ€§**ï¼š

```java
// åŸºç¡€ç¤ºä¾‹ï¼šåªå¤„ç†é‡‘é¢å¤§äº100çš„è®¢å•
@EventListener(condition = "#event.amount > 100")
public void handleHighValueOrder(OrderEvent event) {
    System.out.println("å¤„ç†é«˜ä»·å€¼è®¢å•ï¼š" + event.getAmount());
}
```

**å…³é”®è¯­æ³•è¯´æ˜**ï¼š
- `condition = "è¡¨è¾¾å¼"` - å®šä¹‰è¿‡æ»¤æ¡ä»¶
- `#event` - ä»£è¡¨å½“å‰äº‹ä»¶å¯¹è±¡
- `.amount` - è®¿é—®äº‹ä»¶å¯¹è±¡çš„å±æ€§
- `> 100` - åˆ¤æ–­æ¡ä»¶ï¼ˆå¯ä»¥æ˜¯ä»»ä½•å¸ƒå°”è¡¨è¾¾å¼ï¼‰

### 2.2 å¸¸ç”¨æ¡ä»¶è¡¨è¾¾å¼ç±»å‹


| è¡¨è¾¾å¼ç±»å‹ | ç¤ºä¾‹ | è¯´æ˜ |
|---------|------|------|
| **æ•°å€¼æ¯”è¾ƒ** | `#event.amount > 100` | é‡‘é¢ã€æ•°é‡ç­‰æ•°å€¼åˆ¤æ–­ |
| **å­—ç¬¦ä¸²åŒ¹é…** | `#event.type == 'VIP'` | ç±»å‹ã€çŠ¶æ€ç­‰å­—ç¬¦ä¸²åˆ¤æ–­ |
| **å¸ƒå°”åˆ¤æ–­** | `#event.isPaid == true` | ç›´æ¥çš„çœŸå‡åˆ¤æ–­ |
| **ç©ºå€¼æ£€æŸ¥** | `#event.remark != null` | æ£€æŸ¥å±æ€§æ˜¯å¦ä¸ºç©º |
| **é›†åˆåˆ¤æ–­** | `#event.tags.contains('urgent')` | é›†åˆæ˜¯å¦åŒ…å«æŸå…ƒç´  |

### 2.3 å¤åˆæ¡ä»¶è¡¨è¾¾å¼


**é€»è¾‘è¿ç®—ç¬¦ç»„åˆ**ï¼š

```java
// ANDæ¡ä»¶ï¼šåŒæ—¶æ»¡è¶³å¤šä¸ªæ¡ä»¶
@EventListener(condition = "#event.amount > 100 and #event.userType == 'VIP'")
public void handleVIPHighValueOrder(OrderEvent event) {
    // åªå¤„ç†VIPç”¨æˆ·çš„é«˜ä»·å€¼è®¢å•
}

// ORæ¡ä»¶ï¼šæ»¡è¶³ä»»ä¸€æ¡ä»¶å³å¯
@EventListener(condition = "#event.urgent == true or #event.amount > 1000")
public void handlePriorityOrder(OrderEvent event) {
    // å¤„ç†ç´§æ€¥è®¢å•æˆ–è¶…é«˜ä»·å€¼è®¢å•
}

// NOTæ¡ä»¶ï¼šæ’é™¤ç‰¹å®šæƒ…å†µ
@EventListener(condition = "#event.status != 'CANCELLED'")
public void handleNormalOrder(OrderEvent event) {
    // å¤„ç†éå–æ¶ˆçŠ¶æ€çš„è®¢å•
}
```

**ç»„åˆæ¡ä»¶ç¤ºä¾‹**ï¼š
```java
// å¤æ‚ä¸šåŠ¡è§„åˆ™
@EventListener(condition = 
    "(#event.amount > 100 and #event.userType == 'VIP') or " +
    "(#event.amount > 500 and #event.region == 'PREMIUM')")
public void handleSpecialOrder(OrderEvent event) {
    // VIPç”¨æˆ·100å…ƒä»¥ä¸Šè®¢å• æˆ– é«˜ç«¯åœ°åŒº500å…ƒä»¥ä¸Šè®¢å•
}
```

---

## 3. ğŸ” SpELæ¡ä»¶åˆ¤æ–­æœºåˆ¶


### 3.1 SpELæ˜¯ä»€ä¹ˆ


**é€šä¿—è§£é‡Š**ï¼š
SpELï¼ˆSpring Expression Languageï¼‰å°±åƒæ˜¯Springçš„"æ¡ä»¶è¯­å¥ä¸“ç”¨è¯­è¨€"ã€‚ä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¸€ç§**ç®€åŒ–ç‰ˆçš„Javaè¡¨è¾¾å¼**ï¼Œä¸“é—¨ç”¨æ¥å†™åˆ¤æ–­æ¡ä»¶ã€‚

**æ ¸å¿ƒç‰¹ç‚¹**ï¼š
```
æ™®é€šJavaä»£ç ï¼šéœ€è¦å†™å®Œæ•´çš„ifè¯­å¥ã€ç±»å‹è½¬æ¢ç­‰
SpELè¡¨è¾¾å¼ï¼šç›´æ¥å†™æ ¸å¿ƒåˆ¤æ–­é€»è¾‘ï¼ŒSpringè‡ªåŠ¨å¤„ç†

ç¤ºä¾‹å¯¹æ¯”ï¼š
Javaä»£ç ï¼šif (event.getAmount() > 100 && event.getType().equals("VIP"))
SpELè¡¨è¾¾å¼ï¼š#event.amount > 100 and #event.type == 'VIP'
```

### 3.2 SpELåŸºç¡€è¯­æ³•è§„åˆ™


**ğŸ”¸ è®¿é—®å¯¹è±¡å±æ€§**
```java
#event.amount          // è®¿é—®ç®€å•å±æ€§
#event.user.name       // è®¿é—®åµŒå¥—å±æ€§ï¼ˆé“¾å¼è°ƒç”¨ï¼‰
#event.items[0]        // è®¿é—®æ•°ç»„/åˆ—è¡¨å…ƒç´ 
#event.metadata['key'] // è®¿é—®Mapå…ƒç´ 
```

**ğŸ”¸ è°ƒç”¨æ–¹æ³•**
```java
#event.getAmount()              // è°ƒç”¨getteræ–¹æ³•
#event.orderNo.length()         // è°ƒç”¨Stringæ–¹æ³•
#event.items.size()             // è°ƒç”¨é›†åˆæ–¹æ³•
#event.createTime.isAfter(now)  // è°ƒç”¨æ—¥æœŸæ–¹æ³•
```

**ğŸ”¸ è¿ç®—ç¬¦æ”¯æŒ**
```java
// ç®—æœ¯è¿ç®—
#event.amount + #event.discount  // åŠ 
#event.total - #event.paid       // å‡
#event.price * #event.quantity   // ä¹˜
#event.total / #event.count      // é™¤

// æ¯”è¾ƒè¿ç®—
#event.amount > 100   // å¤§äº
#event.amount >= 100  // å¤§äºç­‰äº
#event.amount < 100   // å°äº
#event.amount <= 100  // å°äºç­‰äº
#event.amount == 100  // ç­‰äº
#event.amount != 100  // ä¸ç­‰äº

// é€»è¾‘è¿ç®—
and  // ä¸
or   // æˆ–
not  // é
```

### 3.3 SpELå†…ç½®å¯¹è±¡å’Œå‡½æ•°


**å¯ç”¨çš„å†…ç½®å¯¹è±¡**ï¼š

```java
// #root - ä»£è¡¨æ ¹å¯¹è±¡ï¼ˆé€šå¸¸æ˜¯äº‹ä»¶æœ¬èº«ï¼‰
@EventListener(condition = "#root.source == 'admin'")

// #this - ä»£è¡¨å½“å‰å¯¹è±¡ï¼ˆåŒ#eventï¼‰
@EventListener(condition = "#this.amount > 100")

// ç¯å¢ƒå˜é‡è®¿é—®ï¼ˆåé¢è¯¦ç»†è®²ï¼‰
@EventListener(condition = "@environment.getProperty('order.min.amount') < #event.amount")
```

**å¸¸ç”¨å·¥å…·ç±»æ–¹æ³•**ï¼š

```java
// å­—ç¬¦ä¸²æ“ä½œ
@EventListener(condition = "#event.orderNo.startsWith('VIP')")
@EventListener(condition = "#event.remark.contains('urgent')")
@EventListener(condition = "#event.type.matches('VIP|SVIP')")  // æ­£åˆ™åŒ¹é…

// é›†åˆæ“ä½œ
@EventListener(condition = "#event.tags.isEmpty()")
@EventListener(condition = "#event.items.?[price > 100].size() > 0")  // è¿‡æ»¤é›†åˆ

// ç±»å‹åˆ¤æ–­
@EventListener(condition = "#event.data instanceof T(com.example.VIPOrder)")
```

### 3.4 SpELé«˜çº§ç‰¹æ€§


**ğŸ”¸ å®‰å…¨å¯¼èˆªæ“ä½œç¬¦ï¼ˆ?.ï¼‰**
```java
// é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸
@EventListener(condition = "#event.user?.vipLevel == 'GOLD'")
// å¦‚æœuserä¸ºnullï¼Œæ•´ä¸ªè¡¨è¾¾å¼è¿”å›nullè€Œä¸æ˜¯æŠ›å¼‚å¸¸
```

**ğŸ”¸ ä¸‰å…ƒè¿ç®—ç¬¦**
```java
@EventListener(condition = "#event.amount > 100 ? true : #event.userType == 'VIP'")
// é‡‘é¢å¤§äº100ç›´æ¥é€šè¿‡ï¼Œå¦åˆ™æ£€æŸ¥æ˜¯å¦VIP
```

**ğŸ”¸ é›†åˆè¿‡æ»¤æŠ•å½±**
```java
// è¿‡æ»¤é›†åˆï¼š?.
@EventListener(condition = "#event.items.?[price > 100].size() > 0")
// å«ä¹‰ï¼šè®¢å•ä¸­å­˜åœ¨å•ä»·è¶…è¿‡100çš„å•†å“

// æŠ•å½±é›†åˆï¼š!.
@EventListener(condition = "#event.items.![price].sum() > 500")
// å«ä¹‰ï¼šæ‰€æœ‰å•†å“ä»·æ ¼æ€»å’Œè¶…è¿‡500
```

---

## 4. ğŸ¯ é€‰æ‹©æ€§ç›‘å¬ç­–ç•¥


### 4.1 åŸºäºä¸šåŠ¡è§„åˆ™çš„é€‰æ‹©æ€§ç›‘å¬


**åœºæ™¯1ï¼šæŒ‰è®¢å•çŠ¶æ€åˆ†ç±»å¤„ç†**

```java
// ç›‘å¬å™¨1ï¼šåªå¤„ç†å¾…æ”¯ä»˜è®¢å•
@EventListener(condition = "#event.status == 'PENDING_PAY'")
public void handlePendingPayOrder(OrderEvent event) {
    // å‘é€æ”¯ä»˜æé†’
    sendPaymentReminder(event.getOrderNo());
}

// ç›‘å¬å™¨2ï¼šåªå¤„ç†å·²æ”¯ä»˜è®¢å•
@EventListener(condition = "#event.status == 'PAID'")
public void handlePaidOrder(OrderEvent event) {
    // ç”Ÿæˆå‘è´§å•
    generateShippingOrder(event);
}

// ç›‘å¬å™¨3ï¼šåªå¤„ç†å·²å®Œæˆè®¢å•
@EventListener(condition = "#event.status == 'COMPLETED'")
public void handleCompletedOrder(OrderEvent event) {
    // è®¡ç®—ç§¯åˆ†å¥–åŠ±
    calculateRewardPoints(event);
}
```

**æ¶æ„ä¼˜åŠ¿**ï¼š
```
ä¼ ç»Ÿæ–¹å¼ï¼š
ä¸€ä¸ªç›‘å¬å™¨å†…éƒ¨å†™å¤§é‡if-elseåˆ¤æ–­ âŒ

æ¡ä»¶ç›‘å¬æ–¹å¼ï¼š
å¤šä¸ªç›‘å¬å™¨å„å¸å…¶èŒï¼Œä»£ç æ¸…æ™° âœ…
```

### 4.2 åŸºäºç”¨æˆ·å±æ€§çš„é€‰æ‹©æ€§ç›‘å¬


**åœºæ™¯2ï¼šä¸åŒç”¨æˆ·ç­‰çº§çš„å·®å¼‚åŒ–å¤„ç†**

```java
// VIPç”¨æˆ·ä¸“å±ç›‘å¬
@EventListener(condition = "#event.user.vipLevel in {'GOLD', 'PLATINUM'}")
public void handleVIPUserOrder(OrderEvent event) {
    // VIPä¸“å±ä¼˜æƒ 
    applyVIPDiscount(event);
    // ä¼˜å…ˆé…é€
    prioritizeShipping(event);
}

// æ–°ç”¨æˆ·ä¼˜æƒ ç›‘å¬
@EventListener(condition = "#event.user.isNewUser == true and #event.amount > 50")
public void handleNewUserOrder(OrderEvent event) {
    // æ–°ç”¨æˆ·é¦–å•ä¼˜æƒ 
    applyFirstOrderCoupon(event);
}
```

### 4.3 åŸºäºæ—¶é—´æ¡ä»¶çš„é€‰æ‹©æ€§ç›‘å¬


**åœºæ™¯3ï¼šç‰¹å®šæ—¶é—´æ®µçš„æ´»åŠ¨ç›‘å¬**

```java
// ä½¿ç”¨æ–¹æ³•è°ƒç”¨åˆ¤æ–­æ—¶é—´
@EventListener(condition = "#event.isInPromotionPeriod()")
public void handlePromotionOrder(OrderEvent event) {
    // æ´»åŠ¨æœŸé—´è®¢å•å¤„ç†
    applyPromotionBonus(event);
}

// é…åˆBeanæ–¹æ³•åˆ¤æ–­
@EventListener(condition = "@timeChecker.isBusinessHour()")
public void handleBusinessHourOrder(OrderEvent event) {
    // è¥ä¸šæ—¶é—´å†…çš„è®¢å•å¤„ç†
    processImmediately(event);
}
```

**æ—¶é—´æ£€æŸ¥å·¥å…·ç±»ç¤ºä¾‹**ï¼š
```java
@Component("timeChecker")
public class TimeChecker {
    public boolean isBusinessHour() {
        LocalTime now = LocalTime.now();
        return now.isAfter(LocalTime.of(9, 0)) && 
               now.isBefore(LocalTime.of(18, 0));
    }
    
    public boolean isWeekend() {
        DayOfWeek day = LocalDate.now().getDayOfWeek();
        return day == DayOfWeek.SATURDAY || day == DayOfWeek.SUNDAY;
    }
}
```

### 4.4 é€‰æ‹©æ€§ç›‘å¬çš„æœ€ä½³å®è·µ


**âœ… æ¨èåšæ³•**ï¼š
```
1. æ¡ä»¶è¡¨è¾¾å¼å°½é‡ç®€å•ç›´è§‚
   âœ“ #event.amount > 100
   âœ— #event.items.stream().filter(...).count() > 0

2. å¤æ‚é€»è¾‘æŠ½å–ä¸ºæ–¹æ³•
   âœ“ #event.isEligibleForDiscount()
   âœ— åœ¨conditionä¸­å†™å¤§é‡è®¡ç®—é€»è¾‘

3. ä½¿ç”¨æœ‰æ„ä¹‰çš„æ¡ä»¶ç»„åˆ
   âœ“ #event.isVIP and #event.amount > 100
   âœ— è¿‡äºå¤æ‚çš„åµŒå¥—æ¡ä»¶
```

**âš ï¸ æ³¨æ„äº‹é¡¹**ï¼š
- æ¡ä»¶è¡¨è¾¾å¼åœ¨**æ¯æ¬¡äº‹ä»¶å‘å¸ƒæ—¶**éƒ½ä¼šæ±‚å€¼
- å°½é‡é¿å…åœ¨æ¡ä»¶ä¸­è°ƒç”¨è€—æ—¶æ“ä½œ
- æ¡ä»¶è¡¨è¾¾å¼å¿…é¡»è¿”å›å¸ƒå°”å€¼

---

## 5. ğŸ”„ åŠ¨æ€è¿‡æ»¤æŠ€æœ¯


### 5.1 ä»€ä¹ˆæ˜¯åŠ¨æ€è¿‡æ»¤


**é€šä¿—ç†è§£**ï¼š
é™æ€è¿‡æ»¤å°±åƒå›ºå®šçš„ç­›å­ï¼Œå­”çš„å¤§å°ä¸å˜ã€‚åŠ¨æ€è¿‡æ»¤å°±åƒå¯è°ƒèŠ‚çš„ç­›å­ï¼Œå¯ä»¥æ ¹æ®æƒ…å†µæ”¹å˜ç­›é€‰æ ‡å‡†ã€‚

**æŠ€æœ¯å¯¹æ¯”**ï¼š
```
é™æ€æ¡ä»¶ï¼š
@EventListener(condition = "#event.amount > 100")
é—®é¢˜ï¼šé˜ˆå€¼100å†™æ­»äº†ï¼Œæƒ³æ”¹åªèƒ½é‡æ–°éƒ¨ç½² âŒ

åŠ¨æ€æ¡ä»¶ï¼š
@EventListener(condition = "#event.amount > @configService.getMinAmount()")
ä¼˜åŠ¿ï¼šé˜ˆå€¼å¯ä»¥ä»é…ç½®ä¸­å¿ƒã€æ•°æ®åº“åŠ¨æ€è¯»å– âœ…
```

### 5.2 åŸºäºé…ç½®çš„åŠ¨æ€è¿‡æ»¤


**æ–¹å¼1ï¼šè¯»å–é…ç½®æ–‡ä»¶**

```java
// application.ymlé…ç½®
order:
  min-amount: 100
  vip-levels: GOLD,PLATINUM
  enable-filter: true
```

```java
@Component
public class OrderEventListener {
    
    @Value("${order.min-amount}")
    private int minAmount;
    
    // ä½¿ç”¨é…ç½®å€¼ä½œä¸ºæ¡ä»¶
    @EventListener(condition = "#event.amount > @orderEventListener.minAmount")
    public void handleHighValueOrder(OrderEvent event) {
        // å¤„ç†é«˜ä»·å€¼è®¢å•
    }
    
    // è¯»å–Environment
    @EventListener(condition = 
        "@environment.getProperty('order.enable-filter') == 'true' and #event.amount > 100")
    public void handleWithConfigCheck(OrderEvent event) {
        // å¸¦é…ç½®å¼€å…³çš„å¤„ç†
    }
}
```

**æ–¹å¼2ï¼šä½¿ç”¨é…ç½®Bean**

```java
@Component("filterConfig")
@ConfigurationProperties(prefix = "order.filter")
public class FilterConfig {
    private int minAmount = 100;
    private List<String> allowedRegions = new ArrayList<>();
    private boolean enableVipCheck = true;
    
    // getters and setters
}
```

```java
// åœ¨ç›‘å¬å™¨ä¸­ä½¿ç”¨
@EventListener(condition = "#event.amount > @filterConfig.minAmount")
public void handleConfiguredOrder(OrderEvent event) {
    // ä½¿ç”¨é…ç½®çš„æœ€å°é‡‘é¢ä½œä¸ºè¿‡æ»¤æ¡ä»¶
}

@EventListener(condition = "@filterConfig.allowedRegions.contains(#event.region)")
public void handleRegionalOrder(OrderEvent event) {
    // åªå¤„ç†é…ç½®å…è®¸çš„åœ°åŒºè®¢å•
}
```

### 5.3 åŸºäºä¸šåŠ¡çŠ¶æ€çš„åŠ¨æ€è¿‡æ»¤


**åœºæ™¯ï¼šæ ¹æ®ç³»ç»Ÿè¿è¡ŒçŠ¶æ€åŠ¨æ€è°ƒæ•´**

```java
@Component("systemStatus")
public class SystemStatusChecker {
    
    private volatile boolean maintenanceMode = false;
    private volatile int currentLoad = 0;
    
    public boolean isNotInMaintenance() {
        return !maintenanceMode;
    }
    
    public boolean isLowLoad() {
        return currentLoad < 80; // è´Ÿè½½ä½äº80%
    }
    
    public boolean canProcessOrder(OrderEvent event) {
        // ç»¼åˆåˆ¤æ–­ï¼šéç»´æŠ¤æœŸ ä¸” è´Ÿè½½ä¸é«˜ ä¸” è®¢å•é‡‘é¢åˆç†
        return !maintenanceMode && 
               currentLoad < 80 && 
               event.getAmount() < 10000;
    }
}
```

```java
// åŠ¨æ€ç›‘å¬å™¨
@EventListener(condition = "@systemStatus.canProcessOrder(#event)")
public void handleOrderDynamically(OrderEvent event) {
    // åªåœ¨ç³»ç»ŸçŠ¶æ€è‰¯å¥½æ—¶å¤„ç†è®¢å•
}
```

### 5.4 åŠ¨æ€è¿‡æ»¤çš„å®æˆ˜æŠ€å·§


**ğŸ“‹ åŠ¨æ€è¿‡æ»¤å®ç°æ¨¡å¼**ï¼š

```
æ¨¡å¼1ï¼šé…ç½®ä¸­å¿ƒé©±åŠ¨
config-center â†’ filterConfig â†’ SpEL condition
é€‚ç”¨ï¼šéœ€è¦é¢‘ç¹è°ƒæ•´è§„åˆ™çš„åœºæ™¯

æ¨¡å¼2ï¼šæ•°æ®åº“è§„åˆ™é©±åŠ¨  
database â†’ ruleEngine â†’ SpEL condition
é€‚ç”¨ï¼šå¤æ‚çš„ä¸šåŠ¡è§„åˆ™ç®¡ç†

æ¨¡å¼3ï¼šå®æ—¶çŠ¶æ€é©±åŠ¨
monitor â†’ statusChecker â†’ SpEL condition
é€‚ç”¨ï¼šæ ¹æ®ç³»ç»Ÿè´Ÿè½½åŠ¨æ€è°ƒæ•´
```

**ğŸ’¡ æœ€ä½³å®è·µ**ï¼š
- å°†é¢‘ç¹å˜åŒ–çš„è§„åˆ™æŠ½å–ä¸ºé…ç½®
- ä½¿ç”¨ç¼“å­˜é¿å…æ¯æ¬¡äº‹ä»¶éƒ½æŸ¥è¯¢æ•°æ®åº“
- æä¾›è§„åˆ™å˜æ›´çš„çƒ­æ›´æ–°æœºåˆ¶
- è®°å½•è§„åˆ™å˜æ›´æ—¥å¿—ä¾¿äºè¿½è¸ª

---

## 6. ğŸŒ ä¸Šä¸‹æ–‡æ¡ä»¶åº”ç”¨


### 6.1 ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡æ¡ä»¶


**æ¦‚å¿µè§£é‡Š**ï¼š
ä¸Šä¸‹æ–‡æ¡ä»¶å°±æ˜¯æ ¹æ®**å½“å‰è¿è¡Œç¯å¢ƒ**çš„å„ç§ä¿¡æ¯æ¥å†³å®šæ˜¯å¦æ‰§è¡Œç›‘å¬å™¨ã€‚è¿™äº›ä¿¡æ¯åŒ…æ‹¬ï¼šç³»ç»Ÿç¯å¢ƒã€Springå®¹å™¨çŠ¶æ€ã€çº¿ç¨‹ä¿¡æ¯ã€ä¼šè¯ä¿¡æ¯ç­‰ã€‚

**æ ¸å¿ƒæ€æƒ³**ï¼š
```
æ™®é€šæ¡ä»¶ï¼šåªçœ‹äº‹ä»¶æœ¬èº«çš„æ•°æ®
ä¸Šä¸‹æ–‡æ¡ä»¶ï¼šåŒæ—¶è€ƒè™‘äº‹ä»¶ + è¿è¡Œç¯å¢ƒ
```

### 6.2 è®¿é—®ApplicationContext


**è·å–Springå®¹å™¨ä¿¡æ¯**ï¼š

```java
@Component
public class ContextAwareListener implements ApplicationContextAware {
    
    private ApplicationContext applicationContext;
    
    @Override
    public void setApplicationContext(ApplicationContext context) {
        this.applicationContext = context;
    }
    
    // æ ¹æ®å®¹å™¨ä¸­çš„BeançŠ¶æ€å†³å®šæ˜¯å¦å¤„ç†
    @EventListener(condition = 
        "@contextAwareListener.shouldProcess(#event)")
    public void handleWithContext(OrderEvent event) {
        // åŸºäºä¸Šä¸‹æ–‡çš„å¤„ç†
    }
    
    public boolean shouldProcess(OrderEvent event) {
        // æ£€æŸ¥æ˜¯å¦å­˜åœ¨æŸä¸ªBean
        if (!applicationContext.containsBean("paymentService")) {
            return false;
        }
        
        // è·å–Beanå¹¶æ£€æŸ¥çŠ¶æ€
        PaymentService paymentService = 
            applicationContext.getBean(PaymentService.class);
        return paymentService.isAvailable();
    }
}
```

### 6.3 çº¿ç¨‹ä¸Šä¸‹æ–‡ä¿¡æ¯


**åŸºäºçº¿ç¨‹ä¿¡æ¯çš„è¿‡æ»¤**ï¼š

```java
@Component("threadContext")
public class ThreadContextChecker {
    
    // æ£€æŸ¥å½“å‰çº¿ç¨‹åç§°
    public boolean isMainThread() {
        return Thread.currentThread().getName().contains("main");
    }
    
    // æ£€æŸ¥æ˜¯å¦å¼‚æ­¥çº¿ç¨‹
    public boolean isAsyncThread() {
        return Thread.currentThread().getName().contains("async");
    }
    
    // è·å–çº¿ç¨‹æœ¬åœ°å˜é‡
    private static ThreadLocal<String> currentUser = new ThreadLocal<>();
    
    public boolean isAdminUser() {
        String user = currentUser.get();
        return "admin".equals(user);
    }
}
```

```java
// ä½¿ç”¨çº¿ç¨‹ä¸Šä¸‹æ–‡
@EventListener(condition = "@threadContext.isAsyncThread()")
public void handleInAsyncOnly(OrderEvent event) {
    // åªåœ¨å¼‚æ­¥çº¿ç¨‹ä¸­å¤„ç†
}

@EventListener(condition = "@threadContext.isAdminUser()")
public void handleAdminOperation(OrderEvent event) {
    // åªå¤„ç†ç®¡ç†å‘˜æ“ä½œçš„äº‹ä»¶
}
```

### 6.4 è¯·æ±‚ä¸Šä¸‹æ–‡é›†æˆ


**Webç¯å¢ƒä¸­çš„ä¸Šä¸‹æ–‡æ¡ä»¶**ï¼š

```java
@Component("requestContext")
public class RequestContextChecker {
    
    // æ£€æŸ¥HTTPè¯·æ±‚å¤´
    public boolean hasSpecialHeader() {
        ServletRequestAttributes attrs = 
            (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
        if (attrs != null) {
            HttpServletRequest request = attrs.getRequest();
            return "special".equals(request.getHeader("X-Request-Type"));
        }
        return false;
    }
    
    // æ£€æŸ¥ç”¨æˆ·Session
    public boolean isUserLoggedIn() {
        ServletRequestAttributes attrs = 
            (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
        if (attrs != null) {
            HttpSession session = attrs.getRequest().getSession(false);
            return session != null && session.getAttribute("user") != null;
        }
        return false;
    }
}
```

```java
// Webä¸Šä¸‹æ–‡ç›‘å¬
@EventListener(condition = "@requestContext.isUserLoggedIn() and #event.amount > 100")
public void handleAuthenticatedOrder(OrderEvent event) {
    // åªå¤„ç†å·²ç™»å½•ç”¨æˆ·çš„é«˜ä»·å€¼è®¢å•
}
```

### 6.5 ä¸Šä¸‹æ–‡æ¡ä»¶çš„ç»„åˆåº”ç”¨


**ç»¼åˆåœºæ™¯ç¤ºä¾‹**ï¼š

```java
@Component
public class AdvancedContextListener {
    
    @Autowired
    private Environment environment;
    
    @Autowired
    private ApplicationContext applicationContext;
    
    // å¤æ‚ä¸Šä¸‹æ–‡åˆ¤æ–­æ–¹æ³•
    public boolean canProcessOrder(OrderEvent event) {
        // 1. æ£€æŸ¥ç¯å¢ƒï¼šåªåœ¨ç”Ÿäº§ç¯å¢ƒå¤„ç†é«˜ä»·å€¼è®¢å•
        String profile = environment.getProperty("spring.profiles.active");
        if ("prod".equals(profile) && event.getAmount() < 100) {
            return false;
        }
        
        // 2. æ£€æŸ¥BeançŠ¶æ€ï¼šæ”¯ä»˜æœåŠ¡å¿…é¡»å¯ç”¨
        if (applicationContext.containsBean("paymentService")) {
            PaymentService service = 
                applicationContext.getBean(PaymentService.class);
            if (!service.isAvailable()) {
                return false;
            }
        }
        
        // 3. æ£€æŸ¥çº¿ç¨‹ï¼šéä¸»çº¿ç¨‹æ‰å¤„ç†
        if (Thread.currentThread().getName().contains("main")) {
            return false;
        }
        
        return true;
    }
    
    @EventListener(condition = "@advancedContextListener.canProcessOrder(#event)")
    public void handleWithFullContext(OrderEvent event) {
        // æ»¡è¶³æ‰€æœ‰ä¸Šä¸‹æ–‡æ¡ä»¶åçš„å¤„ç†
    }
}
```

---

## 7. ğŸ”§ ç¯å¢ƒæ„ŸçŸ¥é…ç½®


### 7.1 ä»€ä¹ˆæ˜¯ç¯å¢ƒæ„ŸçŸ¥


**é€šä¿—ç†è§£**ï¼š
å°±åƒäººä¼šæ ¹æ®å¤©æ°”ç©¿è¡£æœä¸€æ ·ï¼Œç¨‹åºä¹Ÿè¦æ ¹æ®è¿è¡Œç¯å¢ƒï¼ˆå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ï¼‰è°ƒæ•´è¡Œä¸ºã€‚ç¯å¢ƒæ„ŸçŸ¥è®©ç›‘å¬å™¨èƒ½å¤Ÿ"å¯Ÿè§‰"è‡ªå·±åœ¨å“ªä¸ªç¯å¢ƒè¿è¡Œï¼Œä»è€Œåšå‡ºä¸åŒçš„å“åº”ã€‚

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
```
å¼€å‘ç¯å¢ƒ (dev)ï¼šå®½æ¾çš„è¿‡æ»¤æ¡ä»¶ï¼Œæ–¹ä¾¿æµ‹è¯•
æµ‹è¯•ç¯å¢ƒ (test)ï¼šæ¨¡æ‹ŸçœŸå®æ¡ä»¶ï¼ŒéªŒè¯é€»è¾‘  
ç”Ÿäº§ç¯å¢ƒ (prod)ï¼šä¸¥æ ¼çš„è¿‡æ»¤æ¡ä»¶ï¼Œä¿è¯è´¨é‡
```

### 7.2 åŸºäºProfileçš„æ¡ä»¶ç›‘å¬


**é…ç½®ä¸åŒç¯å¢ƒ**ï¼š

```yaml
# application-dev.yml (å¼€å‘ç¯å¢ƒ)
order:
  min-amount: 1        # å¼€å‘ç¯å¢ƒï¼š1å…ƒå°±å¤„ç†
  enable-check: false  # å…³é—­ä¸¥æ ¼æ£€æŸ¥

# application-prod.yml (ç”Ÿäº§ç¯å¢ƒ)
order:
  min-amount: 100      # ç”Ÿäº§ç¯å¢ƒï¼šè‡³å°‘100å…ƒ
  enable-check: true   # å¼€å¯ä¸¥æ ¼æ£€æŸ¥
```

**æ–¹å¼1ï¼šç›´æ¥ä½¿ç”¨Profileæ³¨è§£**

```java
// åªåœ¨å¼€å‘ç¯å¢ƒæ¿€æ´»
@Component
@Profile("dev")
public class DevOrderListener {
    
    @EventListener  // å¼€å‘ç¯å¢ƒæ— æ¡ä»¶å¤„ç†æ‰€æœ‰è®¢å•
    public void handleAllOrders(OrderEvent event) {
        log.debug("Devç¯å¢ƒï¼šå¤„ç†è®¢å• {}", event.getOrderNo());
    }
}

// åªåœ¨ç”Ÿäº§ç¯å¢ƒæ¿€æ´»
@Component
@Profile("prod")
public class ProdOrderListener {
    
    @EventListener(condition = "#event.amount > 100")
    public void handleHighValueOrders(OrderEvent event) {
        log.info("Prodç¯å¢ƒï¼šå¤„ç†é«˜ä»·å€¼è®¢å• {}", event.getOrderNo());
    }
}
```

**æ–¹å¼2ï¼šåœ¨æ¡ä»¶è¡¨è¾¾å¼ä¸­æ£€æŸ¥Profile**

```java
@Component
public class EnvironmentAwareListener {
    
    @Autowired
    private Environment environment;
    
    // å¼€å‘ç¯å¢ƒï¼šå¤„ç†æ‰€æœ‰è®¢å•
    // ç”Ÿäº§ç¯å¢ƒï¼šåªå¤„ç†é‡‘é¢>100çš„è®¢å•
    @EventListener(condition = 
        "@environment.acceptsProfiles('dev') or #event.amount > 100")
    public void handleOrder(OrderEvent event) {
        String profile = environment.getProperty("spring.profiles.active");
        log.info("[{}ç¯å¢ƒ] å¤„ç†è®¢å•ï¼š{}", profile, event.getOrderNo());
    }
}
```

### 7.3 åŸºäºå±æ€§çš„ç¯å¢ƒæ„ŸçŸ¥


**ä½¿ç”¨@ConditionalOnProperty**

è™½ç„¶è¿™ä¸ªæ³¨è§£ä¸»è¦ç”¨äºBeanæ¡ä»¶åˆ›å»ºï¼Œä½†æˆ‘ä»¬å¯ä»¥ç»“åˆä½¿ç”¨ï¼š

```java
@Component
@ConditionalOnProperty(name = "order.listener.enabled", havingValue = "true")
public class ConfigurableOrderListener {
    
    @Value("${order.min-amount:100}")
    private int minAmount;
    
    @EventListener(condition = "#event.amount > @configurableOrderListener.minAmount")
    public void handleOrder(OrderEvent event) {
        // ä½¿ç”¨é…ç½®çš„æœ€å°é‡‘é¢ä½œä¸ºæ¡ä»¶
    }
}
```

**åŠ¨æ€è¯»å–ç¯å¢ƒå±æ€§**ï¼š

```java
@Component("envChecker")
public class EnvironmentChecker {
    
    @Autowired
    private Environment environment;
    
    // æ£€æŸ¥æ˜¯å¦ç”Ÿäº§ç¯å¢ƒ
    public boolean isProdEnvironment() {
        return Arrays.asList(environment.getActiveProfiles())
                    .contains("prod");
    }
    
    // æ£€æŸ¥æ˜¯å¦å¯ç”¨è°ƒè¯•æ¨¡å¼
    public boolean isDebugEnabled() {
        return environment.getProperty("app.debug", Boolean.class, false);
    }
    
    // è·å–ç¯å¢ƒç‰¹å®šçš„é˜ˆå€¼
    public int getAmountThreshold() {
        String profile = environment.getProperty("spring.profiles.active", "dev");
        switch (profile) {
            case "prod":
                return 100;
            case "test":
                return 50;
            default:
                return 1;
        }
    }
}
```

```java
// ä½¿ç”¨ç¯å¢ƒæ£€æŸ¥å™¨
@EventListener(condition = "@envChecker.isProdEnvironment() and #event.amount > 100")
public void handleProdOrder(OrderEvent event) {
    // ç”Ÿäº§ç¯å¢ƒçš„ä¸¥æ ¼å¤„ç†
}

@EventListener(condition = "#event.amount > @envChecker.getAmountThreshold()")
public void handleEnvironmentAwareOrder(OrderEvent event) {
    // æ ¹æ®ç¯å¢ƒè‡ªåŠ¨è°ƒæ•´é˜ˆå€¼
}
```

### 7.4 å¤šç¯å¢ƒé…ç½®æœ€ä½³å®è·µ


**ğŸ“‹ é…ç½®ç­–ç•¥è¡¨**ï¼š

| ç¯å¢ƒ | è¿‡æ»¤æ¡ä»¶ | æ—¥å¿—çº§åˆ« | ç‰¹æ®Šå¤„ç† |
|-----|---------|---------|---------|
| **å¼€å‘(dev)** | å®½æ¾ï¼Œæ–¹ä¾¿æµ‹è¯• | DEBUG | æ‰“å°è¯¦ç»†ä¿¡æ¯ |
| **æµ‹è¯•(test)** | ä¸­ç­‰ï¼Œæ¨¡æ‹ŸçœŸå® | INFO | è®°å½•å…³é”®æ­¥éª¤ |
| **ç”Ÿäº§(prod)** | ä¸¥æ ¼ï¼Œä¿è¯è´¨é‡ | WARN/ERROR | åªè®°å½•å¼‚å¸¸ |

**å®æˆ˜é…ç½®ç¤ºä¾‹**ï¼š

```java
@Component
public class MultiEnvListener {
    
    @Autowired
    private Environment env;
    
    // å¼€å‘ç¯å¢ƒï¼šè®°å½•æ‰€æœ‰äº‹ä»¶
    @EventListener(condition = "@environment.acceptsProfiles('dev')")
    public void devLogAllEvents(OrderEvent event) {
        log.debug("[DEV] æ¥æ”¶äº‹ä»¶ï¼š{}", event);
    }
    
    // æµ‹è¯•ç¯å¢ƒï¼šè®°å½•é‡è¦äº‹ä»¶
    @EventListener(condition = 
        "@environment.acceptsProfiles('test') and #event.amount > 50")
    public void testLogImportantEvents(OrderEvent event) {
        log.info("[TEST] é‡è¦äº‹ä»¶ï¼šé‡‘é¢={}", event.getAmount());
    }
    
    // ç”Ÿäº§ç¯å¢ƒï¼šåªè®°å½•é«˜ä»·å€¼äº‹ä»¶
    @EventListener(condition = 
        "@environment.acceptsProfiles('prod') and #event.amount > 100")
    public void prodLogCriticalEvents(OrderEvent event) {
        log.warn("[PROD] é«˜ä»·å€¼è®¢å•ï¼š{}", event.getOrderNo());
    }
}
```

### 7.5 ç¯å¢ƒæ„ŸçŸ¥çš„é«˜çº§æŠ€å·§


**ğŸ¯ æŠ€å·§1ï¼šç¯å¢ƒéš”ç¦»ç­–ç•¥**

```java
// ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ä¸¥æ ¼ç›‘å¬å™¨
@Component
@Profile("prod")
public class StrictOrderListener {
    @EventListener(condition = 
        "#event.amount > 100 and #event.user.isVerified == true")
    public void handle(OrderEvent event) {
        // ä¸¥æ ¼éªŒè¯åå¤„ç†
    }
}

// å¼€å‘ç¯å¢ƒä½¿ç”¨å®½æ¾ç›‘å¬å™¨  
@Component
@Profile("dev")
public class RelaxedOrderListener {
    @EventListener  // æ— æ¡ä»¶å¤„ç†
    public void handle(OrderEvent event) {
        // æ–¹ä¾¿å¼€å‘æµ‹è¯•
    }
}
```

**ğŸ¯ æŠ€å·§2ï¼šæ¡ä»¶ç»„åˆæ¨¡å¼**

```java
@Component("envAwareFilter")
public class EnvironmentAwareFilter {
    
    @Autowired
    private Environment env;
    
    public boolean shouldProcess(OrderEvent event) {
        // è·å–ç¯å¢ƒç‰¹å®šé…ç½®
        String profile = env.getProperty("spring.profiles.active", "dev");
        int threshold = env.getProperty("order.threshold." + profile, 
                                        Integer.class, 0);
        
        // ç¯å¢ƒ + ä¸šåŠ¡è§„åˆ™ç»„åˆåˆ¤æ–­
        return event.getAmount() > threshold && 
               isBusinessRulesMet(event, profile);
    }
    
    private boolean isBusinessRulesMet(OrderEvent event, String profile) {
        switch (profile) {
            case "prod":
                return event.getUser().isVerified();
            case "test":
                return event.getUser().getVipLevel() != null;
            default:
                return true; // å¼€å‘ç¯å¢ƒä¸é™åˆ¶
        }
    }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ¯ æ¡ä»¶äº‹ä»¶ç›‘å¬ï¼šè®©ç›‘å¬å™¨"æŒ‘å‰”"ï¼Œåªå¤„ç†ç¬¦åˆæ¡ä»¶çš„äº‹ä»¶
ğŸ¯ SpELè¡¨è¾¾å¼ï¼šSpringçš„æ¡ä»¶åˆ¤æ–­ä¸“ç”¨è¯­è¨€ï¼Œç®€æ´å¼ºå¤§
ğŸ¯ é€‰æ‹©æ€§ç›‘å¬ï¼šæ ¹æ®ä¸šåŠ¡è§„åˆ™ç²¾å‡†å“åº”ï¼Œæé«˜æ•ˆç‡
ğŸ¯ åŠ¨æ€è¿‡æ»¤ï¼šæ¡ä»¶å¯é…ç½®ã€å¯è°ƒæ•´ï¼Œçµæ´»åº”å¯¹å˜åŒ–
ğŸ¯ ä¸Šä¸‹æ–‡æ„ŸçŸ¥ï¼šç»“åˆè¿è¡Œç¯å¢ƒåšæ™ºèƒ½åˆ¤æ–­
ğŸ¯ ç¯å¢ƒé…ç½®ï¼šä¸åŒç¯å¢ƒä¸åŒç­–ç•¥ï¼Œå¼€å‘ç”Ÿäº§ä¸¤ä¸è¯¯
```

### 8.2 å…³é”®æŠ€æœ¯è¦ç‚¹


**ğŸ”¹ SpELè¡¨è¾¾å¼æ ¸å¿ƒ**
```
è®¿é—®å±æ€§ï¼š#event.amount
è°ƒç”¨æ–¹æ³•ï¼š#event.getTotal()
é€»è¾‘è¿ç®—ï¼šandã€orã€not
æ¯”è¾ƒè¿ç®—ï¼š>ã€<ã€==ã€!=
è®¿é—®Beanï¼š@beanName.method()
å®‰å…¨å¯¼èˆªï¼š#event.user?.name
```

**ğŸ”¹ æ¡ä»¶ç±»å‹é€‰æ‹©**
```
ç®€å•æ¡ä»¶ â†’ ç›´æ¥å†™è¡¨è¾¾å¼ï¼š#event.amount > 100
å¤åˆæ¡ä»¶ â†’ ä½¿ç”¨é€»è¾‘è¿ç®—ï¼š#event.amount > 100 and #event.type == 'VIP'
å¤æ‚æ¡ä»¶ â†’ æŠ½å–ä¸ºæ–¹æ³•ï¼š#event.isEligible()
åŠ¨æ€æ¡ä»¶ â†’ è¯»å–é…ç½®ï¼š#event.amount > @config.threshold
```

**ğŸ”¹ æœ€ä½³å®è·µåŸåˆ™**
```
âœ… æ¡ä»¶è¡¨è¾¾å¼ç®€å•ç›´è§‚ï¼Œé¿å…è¿‡åº¦å¤æ‚
âœ… å¤æ‚é€»è¾‘å°è£…æˆæ–¹æ³•ï¼Œæé«˜å¯è¯»æ€§
âœ… é¢‘ç¹å˜åŒ–çš„è§„åˆ™å¤–éƒ¨åŒ–é…ç½®
âœ… åˆ©ç”¨ç¯å¢ƒProfileå®ç°ç¯å¢ƒéš”ç¦»
âœ… æ³¨æ„æ€§èƒ½ï¼Œé¿å…æ¡ä»¶ä¸­çš„è€—æ—¶æ“ä½œ
```

### 8.3 å®æˆ˜åº”ç”¨æŒ‡å—


**ğŸ“± åº”ç”¨åœºæ™¯é€ŸæŸ¥**

| åœºæ™¯ | æ¡ä»¶ç±»å‹ | ç¤ºä¾‹è¡¨è¾¾å¼ |
|-----|---------|-----------|
| **é‡‘é¢è¿‡æ»¤** | ç®€å•æ•°å€¼ | `#event.amount > 100` |
| **çŠ¶æ€åˆ¤æ–­** | å­—ç¬¦ä¸²æ¯”è¾ƒ | `#event.status == 'PAID'` |
| **ç”¨æˆ·ç­‰çº§** | é›†åˆåŒ…å« | `#event.vipLevel in {'GOLD','PLATINUM'}` |
| **æ—¶é—´é™åˆ¶** | æ–¹æ³•è°ƒç”¨ | `@timeChecker.isBusinessHour()` |
| **å¤šæ¡ä»¶ç»„åˆ** | é€»è¾‘è¿ç®— | `#event.amount > 100 and #event.type == 'VIP'` |
| **åŠ¨æ€è§„åˆ™** | Beanå±æ€§ | `#event.amount > @config.minAmount` |
| **ç¯å¢ƒç›¸å…³** | Profileæ£€æŸ¥ | `@env.acceptsProfiles('prod')` |

### 8.4 å¸¸è§é—®é¢˜ä¸è§£å†³


**â“ é—®é¢˜1ï¼šæ¡ä»¶ä¸ç”Ÿæ•ˆ**
```
åŸå› ï¼šSpELè¡¨è¾¾å¼è¯­æ³•é”™è¯¯
è§£å†³ï¼šæ£€æŸ¥æ‹¼å†™ã€æ‹¬å·åŒ¹é…ã€å¼•ç”¨è·¯å¾„

åŸå› ï¼šæ¡ä»¶è¿”å›éå¸ƒå°”å€¼
è§£å†³ï¼šç¡®ä¿è¡¨è¾¾å¼ç»“æœæ˜¯true/false

åŸå› ï¼šBeanæœªæ­£ç¡®æ³¨å…¥
è§£å†³ï¼šæ£€æŸ¥@Componentæ³¨è§£å’ŒBeanåç§°
```

**â“ é—®é¢˜2ï¼šæ€§èƒ½é—®é¢˜**
```
åŸå› ï¼šæ¡ä»¶ä¸­è°ƒç”¨è€—æ—¶æ–¹æ³•
è§£å†³ï¼šå°†å¤æ‚è®¡ç®—ç§»åˆ°äº‹ä»¶å¯¹è±¡ä¸­é¢„å¤„ç†

åŸå› ï¼šé¢‘ç¹è®¿é—®æ•°æ®åº“/å¤–éƒ¨æœåŠ¡
è§£å†³ï¼šä½¿ç”¨ç¼“å­˜æˆ–å°†ç»“æœå­˜å…¥äº‹ä»¶
```

**â“ é—®é¢˜3ï¼šè°ƒè¯•å›°éš¾**
```
è§£å†³æ–¹æ¡ˆï¼š
1. å¼€å¯DEBUGæ—¥å¿—æŸ¥çœ‹æ¡ä»¶æ±‚å€¼è¿‡ç¨‹
2. åœ¨æ¡ä»¶æ–¹æ³•ä¸­æ·»åŠ æ—¥å¿—è¾“å‡º
3. ä½¿ç”¨æ–­ç‚¹è°ƒè¯•SpELè¡¨è¾¾å¼
```

### 8.5 è¿›é˜¶å­¦ä¹ è·¯å¾„


```
å­¦ä¹ è·¯å¾„ï¼š
1ï¸âƒ£ æŒæ¡åŸºç¡€SpELè¯­æ³• â†’ ç®€å•æ¡ä»¶è¡¨è¾¾å¼
2ï¸âƒ£ å­¦ä¹ é€»è¾‘ç»„åˆ â†’ å¤åˆæ¡ä»¶åˆ¤æ–­  
3ï¸âƒ£ ç†è§£Beanå¼•ç”¨ â†’ åŠ¨æ€æ¡ä»¶é…ç½®
4ï¸âƒ£ ç†Ÿæ‚‰ä¸Šä¸‹æ–‡ â†’ ç¯å¢ƒæ„ŸçŸ¥ç›‘å¬
5ï¸âƒ£ ç»¼åˆåº”ç”¨ â†’ ä¼ä¸šçº§æ¡ä»¶ç­–ç•¥

å®è·µå»ºè®®ï¼š
â€¢ ä»ç®€å•æ¡ä»¶å¼€å§‹ï¼Œé€æ­¥å¢åŠ å¤æ‚åº¦
â€¢ å¤šå†™å•å…ƒæµ‹è¯•éªŒè¯æ¡ä»¶é€»è¾‘
â€¢ å…³æ³¨æ€§èƒ½ï¼Œé¿å…è¿‡åº¦å¤æ‚çš„æ¡ä»¶
â€¢ å»ºç«‹æ¡ä»¶è¡¨è¾¾å¼çš„ä»£ç è§„èŒƒ
```

---

**ğŸ“ å­¦ä¹ æ£€æŸ¥æ¸…å•**ï¼š
- [ ] ç†è§£æ¡ä»¶äº‹ä»¶ç›‘å¬çš„ä½œç”¨å’Œä»·å€¼
- [ ] æŒæ¡SpELåŸºç¡€è¯­æ³•å’Œå¸¸ç”¨æ“ä½œ
- [ ] ä¼šå†™ç®€å•å’Œå¤åˆæ¡ä»¶è¡¨è¾¾å¼
- [ ] ç†è§£å¦‚ä½•å®ç°åŠ¨æ€è¿‡æ»¤
- [ ] çŸ¥é“å¦‚ä½•ä½¿ç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯
- [ ] æŒæ¡ç¯å¢ƒæ„ŸçŸ¥é…ç½®æ–¹æ³•
- [ ] èƒ½å¤Ÿè§£å†³å¸¸è§çš„æ¡ä»¶ç›‘å¬é—®é¢˜

**ğŸ’¡ è®°å¿†å£è¯€**ï¼š
```
æ¡ä»¶ç›‘å¬çœŸçµæ´»ï¼ŒSpELè¡¨è¾¾å¼æ¥å¸®å¿™
ç®€å•æ¡ä»¶çœ‹å±æ€§ï¼Œå¤æ‚é€»è¾‘æŠ½æ–¹æ³•
åŠ¨æ€é…ç½®è¯»Beanå€¼ï¼Œç¯å¢ƒæ„ŸçŸ¥ç”¨Profile
ä¸Šä¸‹æ–‡ä¿¡æ¯å·§åˆ©ç”¨ï¼Œæ€§èƒ½å®‰å…¨è¦è®°ç‰¢
```

---

**ğŸ”— ç›¸å…³ä¸»é¢˜**ï¼š
- å‰ç½®çŸ¥è¯†ï¼šSpringäº‹ä»¶æœºåˆ¶åŸºç¡€
- ç›¸å…³æŠ€æœ¯ï¼šSpELè¡¨è¾¾å¼å®Œæ•´è¯­æ³•
- è¿›é˜¶å­¦ä¹ ï¼šè‡ªå®šä¹‰äº‹ä»¶ç›‘å¬å™¨å·¥å‚
- å®æˆ˜æ¡ˆä¾‹ï¼šä¼ä¸šçº§äº‹ä»¶é©±åŠ¨æ¶æ„è®¾è®¡