---
title: 12ã€Webä½œç”¨åŸŸ
---
## ğŸ“š ç›®å½•

1. [Webä½œç”¨åŸŸæ˜¯ä»€ä¹ˆ](#1-Webä½œç”¨åŸŸæ˜¯ä»€ä¹ˆ)
2. [Requestä½œç”¨åŸŸ](#2-Requestä½œç”¨åŸŸ)
3. [Sessionä½œç”¨åŸŸ](#3-Sessionä½œç”¨åŸŸ)
4. [Applicationä½œç”¨åŸŸ](#4-Applicationä½œç”¨åŸŸ)
5. [WebSocketä½œç”¨åŸŸ](#5-WebSocketä½œç”¨åŸŸ)
6. [ä»£ç†æ¨¡å¼åŸç†](#6-ä»£ç†æ¨¡å¼åŸç†)
7. [ç”Ÿå‘½å‘¨æœŸç»‘å®šæœºåˆ¶](#7-ç”Ÿå‘½å‘¨æœŸç»‘å®šæœºåˆ¶)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ Webä½œç”¨åŸŸæ˜¯ä»€ä¹ˆ


### 1.1 ä»€ä¹ˆæ˜¯Webä½œç”¨åŸŸ


**é€šä¿—ç†è§£**ï¼š
æƒ³è±¡ä½ å»é¤å…åƒé¥­ï¼Œæœ‰ä¸åŒçš„"æœåŠ¡èŒƒå›´"ï¼š
- **ç‚¹èœå•**ï¼šåªåœ¨ä½ è¿™ä¸€æ¬¡ç‚¹é¤æ—¶æœ‰æ•ˆï¼ˆRequestä½œç”¨åŸŸï¼‰
- **ä¼šå‘˜å¡**ï¼šåªè¦ä½ è¿˜åœ¨è¿™å®¶åº—æ¶ˆè´¹å°±æœ‰æ•ˆï¼ˆSessionä½œç”¨åŸŸï¼‰
- **é¤å…èœå•**ï¼šæ‰€æœ‰é¡¾å®¢å…±äº«ï¼Œä¸€ç›´æœ‰æ•ˆï¼ˆApplicationä½œç”¨åŸŸï¼‰

**ä¸“ä¸šå®šä¹‰**ï¼š
Webä½œç”¨åŸŸæ˜¯Springæ¡†æ¶åœ¨Webåº”ç”¨ä¸­ç‰¹æœ‰çš„Beanä½œç”¨åŸŸï¼ŒBeançš„ç”Ÿå‘½å‘¨æœŸä¸HTTPè¯·æ±‚ã€ä¼šè¯ç­‰Webæ¦‚å¿µç»‘å®šã€‚

```
ä¼ ç»Ÿä½œç”¨åŸŸ vs Webä½œç”¨åŸŸï¼š

ä¼ ç»Ÿä½œç”¨åŸŸï¼ˆéWebç¯å¢ƒï¼‰ï¼š
â”œâ”€ singletonï¼šæ•´ä¸ªå®¹å™¨å”¯ä¸€å®ä¾‹
â””â”€ prototypeï¼šæ¯æ¬¡è·å–åˆ›å»ºæ–°å®ä¾‹

Webä½œç”¨åŸŸï¼ˆéœ€è¦Webç¯å¢ƒï¼‰ï¼š
â”œâ”€ requestï¼šæ¯ä¸ªHTTPè¯·æ±‚ç‹¬ç«‹å®ä¾‹
â”œâ”€ sessionï¼šæ¯ä¸ªç”¨æˆ·ä¼šè¯ç‹¬ç«‹å®ä¾‹
â”œâ”€ applicationï¼šæ•´ä¸ªWebåº”ç”¨å”¯ä¸€å®ä¾‹
â””â”€ websocketï¼šæ¯ä¸ªWebSocketè¿æ¥ç‹¬ç«‹å®ä¾‹
```

### 1.2 Webä½œç”¨åŸŸçš„ä½¿ç”¨åœºæ™¯


**æ ¸å¿ƒä»·å€¼**ï¼š
- **æ•°æ®éš”ç¦»**ï¼šä¸åŒç”¨æˆ·ã€ä¸åŒè¯·æ±‚çš„æ•°æ®äº’ä¸å¹²æ‰°
- **èµ„æºä¼˜åŒ–**ï¼šæŒ‰éœ€åˆ›å»ºBeanï¼Œé¿å…å†…å­˜æµªè´¹
- **çŠ¶æ€ç®¡ç†**ï¼šæ–¹ä¾¿ç®¡ç†Webåº”ç”¨çš„çŠ¶æ€ä¿¡æ¯

**å…¸å‹åº”ç”¨**ï¼š
```
ğŸ”¸ Requestä½œç”¨åŸŸ
é€‚ç”¨ï¼šè¡¨å•æ•°æ®ã€è¯·æ±‚å‚æ•°å¤„ç†ã€ä¸´æ—¶è®¡ç®—ç»“æœ

ğŸ”¸ Sessionä½œç”¨åŸŸ
é€‚ç”¨ï¼šç”¨æˆ·ç™»å½•ä¿¡æ¯ã€è´­ç‰©è½¦ã€ç”¨æˆ·åå¥½è®¾ç½®

ğŸ”¸ Applicationä½œç”¨åŸŸ
é€‚ç”¨ï¼šå…¨å±€é…ç½®ã€ç¼“å­˜æ•°æ®ã€å…±äº«èµ„æº

ğŸ”¸ WebSocketä½œç”¨åŸŸ
é€‚ç”¨ï¼šå®æ—¶èŠå¤©ã€æ¨é€é€šçŸ¥ã€åœ¨çº¿åä½œ
```

---

## 2. ğŸ“‹ Requestä½œç”¨åŸŸ


### 2.1 Requestä½œç”¨åŸŸçš„å·¥ä½œåŸç†


**é€šä¿—ç†è§£**ï¼š
å°±åƒä½ å»é“¶è¡ŒåŠç†ä¸šåŠ¡ï¼Œæ¯æ¬¡å–å·éƒ½ä¼šæ‹¿åˆ°ä¸€ä¸ªæ–°çš„å·ç ç‰Œï¼ŒåŠå®Œä¸šåŠ¡å·ç ç‰Œå°±ä½œåºŸäº†ã€‚Requestä½œç”¨åŸŸçš„Beanä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæ¯ä¸ªHTTPè¯·æ±‚éƒ½ä¼šåˆ›å»ºæ–°çš„Beanå®ä¾‹ï¼Œè¯·æ±‚ç»“æŸåBeanå°±é”€æ¯ã€‚

**æŠ€æœ¯åŸç†**ï¼š
```
HTTPè¯·æ±‚ç”Ÿå‘½å‘¨æœŸï¼š

æµè§ˆå™¨å‘èµ·è¯·æ±‚
      â†“
  æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚
      â†“
  åˆ›å»ºRequestä½œç”¨åŸŸBean â† æ­¤æ—¶Beanè¯ç”Ÿ
      â†“
  å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼ˆä½¿ç”¨Beanï¼‰
      â†“
  è¿”å›å“åº”ç»™æµè§ˆå™¨
      â†“
  é”€æ¯Requestä½œç”¨åŸŸBean â† Beanç”Ÿå‘½ç»“æŸ
```

### 2.2 Requestä½œç”¨åŸŸçš„é…ç½®æ–¹å¼


**æ–¹å¼ä¸€ï¼šXMLé…ç½®**
```xml
<!-- å°†Beané…ç½®ä¸ºrequestä½œç”¨åŸŸ -->
<bean id="userForm" class="com.example.UserForm" scope="request"/>
```

**æ–¹å¼äºŒï¼šæ³¨è§£é…ç½®ï¼ˆæ¨èï¼‰**
```java
@Component
@Scope(value = WebApplicationContext.SCOPE_REQUEST, 
       proxyMode = ScopedProxyMode.TARGET_CLASS)
public class UserForm {
    private String username;
    private String email;
    
    // getterå’Œsetteræ–¹æ³•
}
```

> **ğŸ’¡ å…³é”®ç†è§£**ï¼š`proxyMode`å‚æ•°å¾ˆé‡è¦ï¼å®ƒå‘Šè¯‰Springè¦åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œè¿™æ ·singletonä½œç”¨åŸŸçš„Beanæ‰èƒ½å®‰å…¨ä½¿ç”¨requestä½œç”¨åŸŸçš„Beanã€‚

### 2.3 Requestä½œç”¨åŸŸçš„å®é™…åº”ç”¨


**åœºæ™¯ï¼šå¤„ç†ç”¨æˆ·è¡¨å•æäº¤**

```java
// è¡¨å•æ•°æ®Beanï¼ˆæ¯æ¬¡è¯·æ±‚åˆ›å»ºæ–°å®ä¾‹ï¼‰
@Component
@RequestScope  // ç­‰åŒäº @Scope("request")
public class RegisterForm {
    private String username;
    private String password;
    private String email;
    
    public void clear() {
        this.username = null;
        this.password = null;
        this.email = null;
    }
}

// Controllerä½¿ç”¨ï¼ˆsingletonä½œç”¨åŸŸï¼‰
@RestController
public class UserController {
    
    @Autowired
    private RegisterForm registerForm;  // æ³¨å…¥çš„æ˜¯ä»£ç†å¯¹è±¡
    
    @PostMapping("/register")
    public String register() {
        // æ¯æ¬¡è¯·æ±‚registerForméƒ½æ˜¯æ–°çš„å®ä¾‹
        String user = registerForm.getUsername();
        // å¤„ç†æ³¨å†Œé€»è¾‘
        return "æ³¨å†ŒæˆåŠŸï¼š" + user;
    }
}
```

**å·¥ä½œæµç¨‹å›¾ç¤º**ï¼š
```
è¯·æ±‚Aï¼šPOST /register?username=å¼ ä¸‰
    â†“
åˆ›å»ºRegisterFormå®ä¾‹A
    â†“
username = "å¼ ä¸‰"
    â†“
å¤„ç†å®Œæˆï¼Œé”€æ¯å®ä¾‹A

è¯·æ±‚Bï¼šPOST /register?username=æå››
    â†“
åˆ›å»ºRegisterFormå®ä¾‹Bï¼ˆå…¨æ–°å®ä¾‹ï¼‰
    â†“
username = "æå››"
    â†“
å¤„ç†å®Œæˆï¼Œé”€æ¯å®ä¾‹B
```

---

## 3. ğŸ‘¤ Sessionä½œç”¨åŸŸ


### 3.1 Sessionä½œç”¨åŸŸçš„å·¥ä½œåŸç†


**é€šä¿—ç†è§£**ï¼š
å°±åƒä½ å»å›¾ä¹¦é¦†åŠäº†ä¸€å¼ å€Ÿä¹¦è¯ï¼Œåªè¦è¿™å¼ è¯è¿˜æœ‰æ•ˆï¼Œä½ æ¯æ¬¡æ¥éƒ½èƒ½ç”¨å®ƒå€Ÿä¹¦ã€‚ä½†å¦‚æœè¯è¿‡æœŸäº†ï¼ˆSessionè¶…æ—¶ï¼‰ï¼Œå°±éœ€è¦é‡æ–°åŠç†ã€‚Sessionä½œç”¨åŸŸçš„Beanä¹Ÿæ˜¯è¿™æ ·ï¼ŒåŒä¸€ä¸ªç”¨æˆ·åœ¨ä¸€æ¬¡ä¼šè¯æœŸé—´å…±äº«åŒä¸€ä¸ªBeanå®ä¾‹ã€‚

**æŠ€æœ¯åŸç†**ï¼š
```
ç”¨æˆ·ä¼šè¯ç”Ÿå‘½å‘¨æœŸï¼š

ç”¨æˆ·é¦–æ¬¡è®¿é—®
    â†“
åˆ›å»ºSessionï¼ˆåˆ†é…SessionIDï¼‰
    â†“
åˆ›å»ºSessionä½œç”¨åŸŸBean â† Beanè¯ç”Ÿ
    â†“
ç”¨æˆ·ç»§ç»­è®¿é—®ï¼ˆç›¸åŒSessionIDï¼‰
    â†“
å¤ç”¨åŒä¸€ä¸ªBeanå®ä¾‹
    â†“
Sessionè¶…æ—¶æˆ–ç”¨æˆ·é€€å‡º
    â†“
é”€æ¯Bean â† Beanç”Ÿå‘½ç»“æŸ
```

### 3.2 Sessionä½œç”¨åŸŸçš„é…ç½®æ–¹å¼


**æ³¨è§£é…ç½®**ï¼š
```java
@Component
@Scope(value = WebApplicationContext.SCOPE_SESSION, 
       proxyMode = ScopedProxyMode.TARGET_CLASS)
public class ShoppingCart {
    private List<CartItem> items = new ArrayList<>();
    private BigDecimal totalPrice = BigDecimal.ZERO;
    
    public void addItem(CartItem item) {
        items.add(item);
        totalPrice = totalPrice.add(item.getPrice());
    }
    
    public void clear() {
        items.clear();
        totalPrice = BigDecimal.ZERO;
    }
}
```

**ç®€åŒ–å†™æ³•**ï¼š
```java
@Component
@SessionScope  // ç­‰åŒäº @Scope("session")
public class UserPreference {
    private String theme = "light";
    private String language = "zh-CN";
    
    // getterå’Œsetter
}
```

### 3.3 Sessionä½œç”¨åŸŸçš„å®é™…åº”ç”¨


**åœºæ™¯ï¼šè´­ç‰©è½¦ç®¡ç†**

```java
// è´­ç‰©è½¦Beanï¼ˆæ¯ä¸ªç”¨æˆ·ä¼šè¯ä¸€ä¸ªå®ä¾‹ï¼‰
@Component
@SessionScope
public class ShoppingCart {
    private List<Product> products = new ArrayList<>();
    
    public void addProduct(Product product) {
        products.add(product);
    }
    
    public int getProductCount() {
        return products.size();
    }
}

// Controller
@RestController
public class CartController {
    
    @Autowired
    private ShoppingCart cart;  // æ¯ä¸ªç”¨æˆ·æœ‰è‡ªå·±çš„è´­ç‰©è½¦
    
    @PostMapping("/cart/add")
    public String addToCart(@RequestBody Product product) {
        cart.addProduct(product);
        return "å·²æ·»åŠ åˆ°è´­ç‰©è½¦ï¼Œå½“å‰å•†å“æ•°ï¼š" + cart.getProductCount();
    }
}
```

**å¤šç”¨æˆ·éš”ç¦»ç¤ºæ„**ï¼š
```
ç”¨æˆ·Aï¼ˆSessionID=ABC123ï¼‰
    â†“
ShoppingCartå®ä¾‹A
    â”œâ”€ å•†å“1ï¼šè‹¹æœ
    â””â”€ å•†å“2ï¼šé¦™è•‰

ç”¨æˆ·Bï¼ˆSessionID=XYZ789ï¼‰
    â†“
ShoppingCartå®ä¾‹Bï¼ˆç‹¬ç«‹çš„å®ä¾‹ï¼‰
    â”œâ”€ å•†å“1ï¼šç¬”è®°æœ¬
    â””â”€ å•†å“2ï¼šé¼ æ ‡

ä¸¤ä¸ªè´­ç‰©è½¦äº’ä¸å¹²æ‰°ï¼
```

---

## 4. ğŸŒ Applicationä½œç”¨åŸŸ


### 4.1 Applicationä½œç”¨åŸŸçš„å·¥ä½œåŸç†


**é€šä¿—ç†è§£**ï¼š
å°±åƒä¸€ä¸ªå­¦æ ¡çš„å¹¿æ’­ç³»ç»Ÿï¼Œå…¨æ ¡å¸ˆç”Ÿéƒ½èƒ½å¬åˆ°åŒæ ·çš„å¹¿æ’­å†…å®¹ã€‚Applicationä½œç”¨åŸŸçš„Beanåœ¨æ•´ä¸ªWebåº”ç”¨ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œæ‰€æœ‰ç”¨æˆ·å…±äº«ã€‚

**å…³é”®åŒºåˆ«**ï¼š
```
Applicationä½œç”¨åŸŸ vs Singletonä½œç”¨åŸŸï¼š

Applicationä½œç”¨åŸŸï¼š
- ä½œç”¨èŒƒå›´ï¼šæ•´ä¸ªWebåº”ç”¨ï¼ˆServletContextï¼‰
- å­˜å‚¨ä½ç½®ï¼šServletContextå±æ€§ä¸­
- ä½¿ç”¨åœºæ™¯ï¼šWebç¯å¢ƒç‰¹å®šçš„å…¨å±€Bean

Singletonä½œç”¨åŸŸï¼š
- ä½œç”¨èŒƒå›´ï¼šæ•´ä¸ªSpringå®¹å™¨
- å­˜å‚¨ä½ç½®ï¼šSpringå®¹å™¨ä¸­
- ä½¿ç”¨åœºæ™¯ï¼šä»»ä½•Springåº”ç”¨ï¼ˆåŒ…æ‹¬éWebï¼‰
```

### 4.2 Applicationä½œç”¨åŸŸçš„é…ç½®


```java
@Component
@Scope(value = WebApplicationContext.SCOPE_APPLICATION, 
       proxyMode = ScopedProxyMode.TARGET_CLASS)
public class AppConfig {
    private String appName;
    private String version;
    private Map<String, String> settings = new HashMap<>();
    
    public void loadSettings() {
        // åŠ è½½å…¨å±€é…ç½®
    }
}

// ç®€åŒ–å†™æ³•
@Component
@ApplicationScope
public class GlobalCache {
    private Map<String, Object> cache = new ConcurrentHashMap<>();
    
    public void put(String key, Object value) {
        cache.put(key, value);
    }
    
    public Object get(String key) {
        return cache.get(key);
    }
}
```

### 4.3 Applicationä½œç”¨åŸŸçš„ä½¿ç”¨åœºæ™¯


**å…¸å‹åº”ç”¨**ï¼š

| åœºæ™¯ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **å…¨å±€é…ç½®** | åº”ç”¨çº§åˆ«çš„é…ç½®ä¿¡æ¯ | ç³»ç»Ÿå‚æ•°ã€åŠŸèƒ½å¼€å…³ |
| **å…¨å±€ç¼“å­˜** | æ‰€æœ‰ç”¨æˆ·å…±äº«çš„ç¼“å­˜ | å­—å…¸æ•°æ®ã€é…ç½®é¡¹ |
| **ç»Ÿè®¡è®¡æ•°** | åº”ç”¨çº§åˆ«çš„ç»Ÿè®¡ä¿¡æ¯ | è®¿é—®é‡ã€åœ¨çº¿äººæ•° |
| **å…±äº«èµ„æº** | éœ€è¦å…¨å±€å…±äº«çš„èµ„æº | è¿æ¥æ± ã€çº¿ç¨‹æ±  |

**å®é™…ç¤ºä¾‹**ï¼š
```java
@Component
@ApplicationScope
public class VisitorCounter {
    private AtomicLong totalVisits = new AtomicLong(0);
    private AtomicInteger onlineUsers = new AtomicInteger(0);
    
    public void recordVisit() {
        totalVisits.incrementAndGet();
    }
    
    public void userOnline() {
        onlineUsers.incrementAndGet();
    }
    
    public void userOffline() {
        onlineUsers.decrementAndGet();
    }
    
    public long getTotalVisits() {
        return totalVisits.get();
    }
    
    public int getOnlineUsers() {
        return onlineUsers.get();
    }
}
```

---

## 5. ğŸ”Œ WebSocketä½œç”¨åŸŸ


### 5.1 WebSocketä½œç”¨åŸŸçš„å·¥ä½œåŸç†


**é€šä¿—ç†è§£**ï¼š
å°±åƒä½ æ‰“ç”µè¯ï¼Œæ¥é€šåå¯ä»¥æŒç»­å¯¹è¯ï¼Œç›´åˆ°æŒ‚æ–­ç”µè¯ã€‚WebSocketä½œç”¨åŸŸçš„Beanåœ¨WebSocketè¿æ¥å»ºç«‹æ—¶åˆ›å»ºï¼Œè¿æ¥å…³é—­æ—¶é”€æ¯ã€‚

**WebSocketè¿æ¥å‘¨æœŸ**ï¼š
```
å®¢æˆ·ç«¯å‘èµ·WebSocketè¿æ¥
        â†“
    æ¡æ‰‹æˆåŠŸï¼Œå»ºç«‹è¿æ¥
        â†“
åˆ›å»ºWebSocketä½œç”¨åŸŸBean â† Beanè¯ç”Ÿ
        â†“
    æŒç»­é€šä¿¡ï¼ˆæ¶ˆæ¯æ¥å¾€ï¼‰
        â†“
    è¿æ¥å…³é—­ï¼ˆä¸»åŠ¨æˆ–å¼‚å¸¸ï¼‰
        â†“
    é”€æ¯Bean â† Beanç”Ÿå‘½ç»“æŸ
```

### 5.2 WebSocketä½œç”¨åŸŸçš„é…ç½®


```java
@Component
@Scope(scopeName = "websocket", 
       proxyMode = ScopedProxyMode.TARGET_CLASS)
public class ChatSession {
    private String sessionId;
    private String username;
    private List<String> messageHistory = new ArrayList<>();
    
    public void addMessage(String message) {
        messageHistory.add(message);
    }
    
    public List<String> getHistory() {
        return new ArrayList<>(messageHistory);
    }
}
```

### 5.3 WebSocketä½œç”¨åŸŸçš„åº”ç”¨åœºæ™¯


**å…¸å‹åœºæ™¯**ï¼š

ğŸ”¸ **å®æ—¶èŠå¤©**
æ¯ä¸ªWebSocketè¿æ¥ç»´æŠ¤ç‹¬ç«‹çš„èŠå¤©ä¸Šä¸‹æ–‡

ğŸ”¸ **åœ¨çº¿åä½œ**
å¤šäººç¼–è¾‘æ–‡æ¡£ï¼Œæ¯ä¸ªè¿æ¥æœ‰ç‹¬ç«‹çš„ç¼–è¾‘çŠ¶æ€

ğŸ”¸ **å®æ—¶æ¨é€**
è‚¡ç¥¨è¡Œæƒ…æ¨é€ï¼Œæ¯ä¸ªè¿æ¥æœ‰ç‹¬ç«‹çš„è®¢é˜…åˆ—è¡¨

**ç¤ºä¾‹ï¼šèŠå¤©å®¤**
```java
@Controller
public class ChatWebSocketHandler {
    
    @Autowired
    private ChatSession chatSession;  // æ¯ä¸ªWebSocketè¿æ¥ç‹¬ç«‹å®ä¾‹
    
    @MessageMapping("/chat")
    @SendTo("/topic/messages")
    public ChatMessage handleMessage(ChatMessage message) {
        // è®°å½•åˆ°å½“å‰è¿æ¥çš„å†å²
        chatSession.addMessage(message.getContent());
        return message;
    }
}
```

---

## 6. ğŸ”„ ä»£ç†æ¨¡å¼åŸç†


### 6.1 ä¸ºä»€ä¹ˆéœ€è¦ä»£ç†æ¨¡å¼


**é—®é¢˜åœºæ™¯**ï¼š
```
Singletonä½œç”¨åŸŸçš„Controller
        â†“
    æ³¨å…¥
        â†“
Requestä½œç”¨åŸŸçš„Bean

é—®é¢˜ï¼šControlleråªåˆ›å»ºä¸€æ¬¡ï¼Œå¦‚ä½•æ¯æ¬¡è¯·æ±‚ä½¿ç”¨ä¸åŒçš„Beanå®ä¾‹ï¼Ÿ
```

**é€šä¿—ç†è§£**ï¼š
å°±åƒä½ æœ‰ä¸€ä¸ªä¸‡èƒ½é¥æ§å™¨ï¼ˆä»£ç†ï¼‰ï¼Œå®ƒä¸ç›´æ¥æ§åˆ¶ç”µè§†ï¼Œè€Œæ˜¯æ ¹æ®å½“å‰æƒ…å†µæ‰¾åˆ°å¯¹åº”çš„ç”µè§†ï¼ˆçœŸå®Beanï¼‰æ¥æ“ä½œã€‚

### 6.2 ä»£ç†æ¨¡å¼çš„å·¥ä½œåŸç†


**ä»£ç†å¯¹è±¡çš„ä½œç”¨**ï¼š
```
ä»£ç†æ¨¡å¼å·¥ä½œæµç¨‹ï¼š

Controlleræ³¨å…¥
    â†“
è·å¾—ä»£ç†å¯¹è±¡ï¼ˆå›ºå®šä¸å˜ï¼‰
    â†“
æ¯æ¬¡è°ƒç”¨æ–¹æ³•æ—¶
    â†“
ä»£ç†å¯¹è±¡æŸ¥æ‰¾å½“å‰è¯·æ±‚å¯¹åº”çš„çœŸå®Bean
    â†“
å§”æ‰˜ç»™çœŸå®Beanæ‰§è¡Œ
    â†“
è¿”å›ç»“æœ
```

**ä¸¤ç§ä»£ç†æ–¹å¼å¯¹æ¯”**ï¼š

| ä»£ç†æ–¹å¼ | è¯´æ˜ | é€‚ç”¨åœºæ™¯ | ç¤ºä¾‹ |
|----------|------|----------|------|
| **JDKåŠ¨æ€ä»£ç†** | åŸºäºæ¥å£ | Beanæœ‰æ¥å£ | `proxyMode = INTERFACES` |
| **CGLIBä»£ç†** | åŸºäºç±»ç»§æ‰¿ | Beanæ— æ¥å£ | `proxyMode = TARGET_CLASS` |

### 6.3 ä»£ç†æ¨¡å¼çš„é…ç½®


```java
// æ¥å£ä»£ç†
@Component
@Scope(value = "request", 
       proxyMode = ScopedProxyMode.INTERFACES)
public class UserService implements IUserService {
    // å®ç°ä»£ç 
}

// ç±»ä»£ç†ï¼ˆæ›´å¸¸ç”¨ï¼‰
@Component
@Scope(value = "request", 
       proxyMode = ScopedProxyMode.TARGET_CLASS)
public class OrderProcessor {
    // å®ç°ä»£ç 
}
```

> **âš ï¸ æ³¨æ„**ï¼šå¦‚æœä¸é…ç½®`proxyMode`ï¼Œsingleton Beanæ³¨å…¥Webä½œç”¨åŸŸBeanæ—¶ä¼šå‡ºç°é—®é¢˜ï¼

**å†…éƒ¨å®ç°ç¤ºæ„**ï¼š
```
@RestController
public class MyController {
    
    @Autowired
    private UserForm userForm;  // è¿™é‡Œæ³¨å…¥çš„æ˜¯ä»£ç†å¯¹è±¡
    
    public void process() {
        // è°ƒç”¨æ–¹æ³•æ—¶
        userForm.getUsername();
        
        // å®é™…æ‰§è¡Œï¼š
        // 1. ä»£ç†å¯¹è±¡æ‹¦æˆªè°ƒç”¨
        // 2. æ ¹æ®å½“å‰è¯·æ±‚æŸ¥æ‰¾çœŸå®Bean
        // 3. è°ƒç”¨çœŸå®Beançš„æ–¹æ³•
        // 4. è¿”å›ç»“æœ
    }
}
```

---

## 7. â±ï¸ ç”Ÿå‘½å‘¨æœŸç»‘å®šæœºåˆ¶


### 7.1 ç”Ÿå‘½å‘¨æœŸç»‘å®šçš„æœ¬è´¨


**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
Webä½œç”¨åŸŸBeançš„ç”Ÿå‘½å‘¨æœŸä¸ç‰¹å®šçš„Webå¯¹è±¡ç»‘å®šï¼š

```
ä½œç”¨åŸŸç±»å‹ â†’ ç»‘å®šå¯¹è±¡ â†’ ç”Ÿå‘½å‘¨æœŸ

Request    â†’ HttpServletRequest    â†’ è¯·æ±‚å¼€å§‹åˆ°ç»“æŸ
Session    â†’ HttpSession           â†’ ä¼šè¯å¼€å§‹åˆ°è¶…æ—¶
Application â†’ ServletContext       â†’ åº”ç”¨å¯åŠ¨åˆ°å…³é—­
WebSocket  â†’ WebSocketSession      â†’ è¿æ¥å»ºç«‹åˆ°æ–­å¼€
```

### 7.2 ç”Ÿå‘½å‘¨æœŸçš„å…³é”®æ—¶åˆ»


**Beançš„è¯ç”Ÿæ—¶æœº**ï¼š
```java
// Requestä½œç”¨åŸŸ
é¦–æ¬¡è®¿é—®Beanæ—¶åˆ›å»ºï¼ˆæ‡’åŠ è½½ï¼‰
ä¾‹å¦‚ï¼šç¬¬ä¸€æ¬¡è°ƒç”¨ userForm.getUsername()

// Sessionä½œç”¨åŸŸ
é¦–æ¬¡è®¿é—®Beanæ—¶åˆ›å»ºï¼ˆæ‡’åŠ è½½ï¼‰
ä¾‹å¦‚ï¼šç¬¬ä¸€æ¬¡è°ƒç”¨ shoppingCart.addItem()

// Applicationä½œç”¨åŸŸ
åº”ç”¨å¯åŠ¨æ—¶åˆ›å»ºï¼ˆé¥¿æ±‰åŠ è½½ï¼‰
æˆ–é¦–æ¬¡è®¿é—®æ—¶åˆ›å»ºï¼ˆçœ‹é…ç½®ï¼‰
```

**Beançš„é”€æ¯æ—¶æœº**ï¼š

| ä½œç”¨åŸŸ | é”€æ¯è§¦å‘æ¡ä»¶ | ç¤ºä¾‹åœºæ™¯ |
|--------|--------------|----------|
| **Request** | HTTPå“åº”ç»“æŸ | é¡µé¢æ¸²æŸ“å®Œæˆ |
| **Session** | Sessionè¶…æ—¶æˆ–ä¸»åŠ¨å¤±æ•ˆ | ç”¨æˆ·é€€å‡ºç™»å½• |
| **Application** | Webåº”ç”¨å…³é—­ | æœåŠ¡å™¨åœæ­¢ |
| **WebSocket** | è¿æ¥æ–­å¼€ | å®¢æˆ·ç«¯å…³é—­é¡µé¢ |

### 7.3 ç”Ÿå‘½å‘¨æœŸå›è°ƒæ–¹æ³•


**ç›‘å¬Beançš„ç”Ÿå‘½å‘¨æœŸ**ï¼š
```java
@Component
@RequestScope
public class RequestBean {
    
    @PostConstruct
    public void init() {
        System.out.println("Request Bean åˆ›å»ºäº†ï¼");
    }
    
    @PreDestroy
    public void destroy() {
        System.out.println("Request Bean é”€æ¯äº†ï¼");
    }
}
```

**å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸæµç¨‹**ï¼š
```
HTTPè¯·æ±‚åˆ°è¾¾
    â†“
Springæ‹¦æˆªè¯·æ±‚
    â†“
åˆ›å»ºRequestä½œç”¨åŸŸBean
    â†“
è°ƒç”¨ @PostConstruct æ–¹æ³•
    â†“
Beanå¯ç”¨ï¼ˆå¤„ç†ä¸šåŠ¡ï¼‰
    â†“
è¯·æ±‚å¤„ç†å®Œæˆ
    â†“
è°ƒç”¨ @PreDestroy æ–¹æ³•
    â†“
é”€æ¯Bean
    â†“
å“åº”è¿”å›ç»™å®¢æˆ·ç«¯
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 Webä½œç”¨åŸŸå¯¹æ¯”æ€»ç»“


| ä½œç”¨åŸŸ | ç”Ÿå‘½å‘¨æœŸ | ä½¿ç”¨åœºæ™¯ | é…ç½®æ³¨è§£ |
|--------|----------|----------|----------|
| **Request** | ä¸€æ¬¡HTTPè¯·æ±‚ | è¡¨å•æ•°æ®ã€è¯·æ±‚å‚æ•° | `@RequestScope` |
| **Session** | ä¸€æ¬¡ç”¨æˆ·ä¼šè¯ | ç™»å½•ä¿¡æ¯ã€è´­ç‰©è½¦ | `@SessionScope` |
| **Application** | æ•´ä¸ªWebåº”ç”¨ | å…¨å±€é…ç½®ã€ç¼“å­˜ | `@ApplicationScope` |
| **WebSocket** | ä¸€æ¬¡WebSocketè¿æ¥ | å®æ—¶é€šä¿¡ã€æ¨é€ | `@Scope("websocket")` |

### 8.2 å¿…é¡»è®°ä½çš„å…³é”®ç‚¹


**ğŸ”¸ æ ¸å¿ƒæ¦‚å¿µ**ï¼š
- Webä½œç”¨åŸŸæ˜¯Springåœ¨Webç¯å¢ƒçš„ç‰¹æ®ŠBeanä½œç”¨åŸŸ
- Beanç”Ÿå‘½å‘¨æœŸä¸HTTPè¯·æ±‚ã€Sessionç­‰Webå¯¹è±¡ç»‘å®š
- ä¸åŒä½œç”¨åŸŸå®ç°äº†ä¸åŒç²’åº¦çš„Beanéš”ç¦»

**ğŸ”¸ ä»£ç†æ¨¡å¼**ï¼š
- Singleton Beanæ³¨å…¥Webä½œç”¨åŸŸBeanå¿…é¡»ä½¿ç”¨ä»£ç†
- ä»£ç†æ¨¡å¼ä¿è¯æ¯æ¬¡è°ƒç”¨ä½¿ç”¨æ­£ç¡®çš„Beanå®ä¾‹
- ä¸¤ç§ä»£ç†æ–¹å¼ï¼šæ¥å£ä»£ç†ï¼ˆJDKï¼‰å’Œç±»ä»£ç†ï¼ˆCGLIBï¼‰

**ğŸ”¸ ç”Ÿå‘½å‘¨æœŸ**ï¼š
- Beanåˆ›å»ºï¼šé€šå¸¸æ˜¯æ‡’åŠ è½½ï¼ˆé¦–æ¬¡è®¿é—®æ—¶ï¼‰
- Beané”€æ¯ï¼šéšç»‘å®šå¯¹è±¡é”€æ¯è€Œé”€æ¯
- å¯é€šè¿‡`@PostConstruct`å’Œ`@PreDestroy`ç›‘å¬ç”Ÿå‘½å‘¨æœŸ

### 8.3 å®é™…åº”ç”¨å»ºè®®


**âœ… æœ€ä½³å®è·µ**ï¼š
```
1. Requestä½œç”¨åŸŸï¼š
   - é€‚åˆå¤„ç†è¡¨å•ã€è¯·æ±‚å‚æ•°
   - è½»é‡çº§æ•°æ®ï¼Œä¸è¦å­˜å‚¨å¤§å¯¹è±¡

2. Sessionä½œç”¨åŸŸï¼š
   - å­˜å‚¨ç”¨æˆ·çŠ¶æ€ã€åå¥½è®¾ç½®
   - æ³¨æ„Sessionå ç”¨å†…å­˜ï¼Œå®šæœŸæ¸…ç†

3. Applicationä½œç”¨åŸŸï¼š
   - å…¨å±€å…±äº«æ•°æ®ã€é…ç½®ä¿¡æ¯
   - è€ƒè™‘çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼ˆä½¿ç”¨å¹¶å‘å®¹å™¨ï¼‰

4. WebSocketä½œç”¨åŸŸï¼š
   - å®æ—¶é€šä¿¡çš„ä¸Šä¸‹æ–‡ç®¡ç†
   - åŠæ—¶é‡Šæ”¾èµ„æºï¼Œé¿å…å†…å­˜æ³„æ¼
```

**âŒ å¸¸è§è¯¯åŒº**ï¼š
```
è¯¯åŒº1ï¼šå¿˜è®°é…ç½®proxyMode
ç»“æœï¼šSingleton Beanæ— æ³•æ­£ç¡®ä½¿ç”¨Webä½œç”¨åŸŸBean

è¯¯åŒº2ï¼šåœ¨Request Beanä¸­å­˜å‚¨å¤§é‡æ•°æ®
ç»“æœï¼šå†…å­˜å ç”¨é«˜ï¼Œæ€§èƒ½ä¸‹é™

è¯¯åŒº3ï¼šSession Beanä¸è€ƒè™‘åºåˆ—åŒ–
ç»“æœï¼šé›†ç¾¤ç¯å¢ƒSessionå¤åˆ¶å¤±è´¥

è¯¯åŒº4ï¼šApplication Beanä¸è€ƒè™‘å¹¶å‘
ç»“æœï¼šå¤šçº¿ç¨‹è®¿é—®å‡ºç°æ•°æ®ä¸ä¸€è‡´
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
Requestè¯·æ±‚æ¥é”€æ¯ï¼Œ
Sessionä¼šè¯å…±å§‹ç»ˆï¼Œ
Applicationå…¨å±€ç”¨ï¼Œ
WebSocketè¿æ¥å®šï¼Œ
ä»£ç†æ¨¡å¼ä¸èƒ½å¿˜ï¼Œ
ç”Ÿå‘½ç»‘å®šè¦ç†æ¸…ï¼
```

---

**ğŸ’¡ å­¦ä¹ å»ºè®®**ï¼š
1. å…ˆç†è§£Requestå’ŒSessionä½œç”¨åŸŸï¼ˆæœ€å¸¸ç”¨ï¼‰
2. åŠ¨æ‰‹å†™ä»£ç éªŒè¯Beançš„åˆ›å»ºå’Œé”€æ¯
3. ç†è§£ä»£ç†æ¨¡å¼çš„å¿…è¦æ€§å’Œå·¥ä½œåŸç†
4. åœ¨å®é™…é¡¹ç›®ä¸­é€‰æ‹©åˆé€‚çš„ä½œç”¨åŸŸ

é€šè¿‡æŒæ¡Webä½œç”¨åŸŸï¼Œä½ å°±èƒ½åœ¨Spring Webåº”ç”¨ä¸­çµæ´»ç®¡ç†Beançš„ç”Ÿå‘½å‘¨æœŸï¼Œå®ç°æ›´ä¼˜é›…çš„çŠ¶æ€ç®¡ç†ï¼