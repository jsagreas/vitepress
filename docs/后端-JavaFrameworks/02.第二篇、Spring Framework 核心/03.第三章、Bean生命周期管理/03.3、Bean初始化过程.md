---
title: 3ã€Beanåˆå§‹åŒ–è¿‡ç¨‹
---
## ğŸ“š ç›®å½•

1. [Beanåˆå§‹åŒ–æ¦‚è¿°](#1-Beanåˆå§‹åŒ–æ¦‚è¿°)
2. [Awareæ¥å£å›è°ƒæœºåˆ¶](#2-Awareæ¥å£å›è°ƒæœºåˆ¶)
3. [åˆå§‹åŒ–å‰å¤„ç†](#3-åˆå§‹åŒ–å‰å¤„ç†)
4. [åˆå§‹åŒ–å›è°ƒæ‰§è¡Œ](#4-åˆå§‹åŒ–å›è°ƒæ‰§è¡Œ)
5. [åˆå§‹åŒ–åå¤„ç†ä¸ä»£ç†](#5-åˆå§‹åŒ–åå¤„ç†ä¸ä»£ç†)
6. [å®Œæ•´æµç¨‹æ€»ç»“](#6-å®Œæ•´æµç¨‹æ€»ç»“)

---

## 1. ğŸ¯ Beanåˆå§‹åŒ–æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯Beanåˆå§‹åŒ–


**é€šä¿—ç†è§£**ï¼šå°±åƒç»„è£…ä¸€å°ç”µè„‘ï¼Œå…ˆæŠŠç¡¬ä»¶è£…å¥½ï¼ˆå®ä¾‹åŒ–ï¼‰ï¼Œç„¶åè¦å¼€æœºè®¾ç½®ç³»ç»Ÿã€å®‰è£…è½¯ä»¶ï¼ˆåˆå§‹åŒ–ï¼‰ï¼Œæœ€åæ‰èƒ½æ­£å¸¸ä½¿ç”¨ã€‚

```
Beançš„è¯ç”Ÿè¿‡ç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. å®ä¾‹åŒ–   â”‚ â† åˆ›å»ºå¯¹è±¡ï¼ˆnewå‡ºæ¥ï¼‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. å±æ€§èµ‹å€¼ â”‚ â† æ³¨å…¥ä¾èµ–ï¼ˆè£…é…é›¶ä»¶ï¼‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. åˆå§‹åŒ–   â”‚ â† å¼€æœºè®¾ç½®ï¼ˆæœ¬ç« é‡ç‚¹ï¼ï¼‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. ä½¿ç”¨ä¸­   â”‚ â† æ­£å¸¸å·¥ä½œ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5. é”€æ¯     â”‚ â† å…³é—­å›æ”¶
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 åˆå§‹åŒ–é˜¶æ®µçš„æ ¸å¿ƒä»»åŠ¡


**ğŸ”¸ ä¸»è¦åšä»€ä¹ˆ**ï¼š
- è®©Beanæ„ŸçŸ¥åˆ°Springå®¹å™¨ç¯å¢ƒ
- æ‰§è¡Œè‡ªå®šä¹‰çš„åˆå§‹åŒ–é€»è¾‘
- åˆ›å»ºä»£ç†å¯¹è±¡ï¼ˆAOPç­‰åŠŸèƒ½ï¼‰
- æ ‡è®°Beanå·²ç»å‡†å¤‡å¥½å¯ä»¥ä½¿ç”¨

**ç”Ÿæ´»ç±»æ¯”**ï¼š
> ğŸ  **æ–°å‘˜å·¥å…¥èŒæµç¨‹**
> 
> - **Awareå›è°ƒ** = ä»‹ç»å…¬å¸ç¯å¢ƒï¼ˆè¿™æ˜¯ä½ çš„å·¥ä½ã€è¿™æ˜¯è€æ¿ï¼‰
> - **åˆå§‹åŒ–å‰** = å…¥èŒåŸ¹è®­ï¼ˆå­¦ä¹ å…¬å¸åˆ¶åº¦ï¼‰
> - **åˆå§‹åŒ–å›è°ƒ** = å²—ä½åŸ¹è®­ï¼ˆå­¦ä¹ å…·ä½“å·¥ä½œï¼‰
> - **åˆå§‹åŒ–å** = è½¬æ­£è€ƒæ ¸ï¼ˆç¡®è®¤èƒ½èƒœä»»å·¥ä½œï¼‰

---

## 2. ğŸ”Œ Awareæ¥å£å›è°ƒæœºåˆ¶


### 2.1 ä»€ä¹ˆæ˜¯Awareæ¥å£


**é€šä¿—è§£é‡Š**ï¼šAwareçš„æ„æ€æ˜¯"æ„ŸçŸ¥ã€å¯Ÿè§‰"ã€‚å°±åƒä½ æ¬åˆ°æ–°å®¶ï¼Œéœ€è¦çŸ¥é“ç”µé—¸åœ¨å“ªã€æ°´é¾™å¤´åœ¨å“ªä¸€æ ·ï¼ŒBeanä¹Ÿéœ€è¦çŸ¥é“Springå®¹å™¨çš„å„ç§ä¿¡æ¯ã€‚

**æ ¸å¿ƒç›®çš„**ï¼šè®©Beanèƒ½å¤Ÿè·å–Springå®¹å™¨ä¸­çš„èµ„æºå’Œä¿¡æ¯ã€‚

### 2.2 å¸¸ç”¨Awareæ¥å£å®¶æ—


| æ¥å£åç§° | **ä½œç”¨** | **ç”Ÿæ´»ç±»æ¯”** |
|---------|---------|-------------|
| **BeanNameAware** | `è·å–Beançš„åå­—` | `çŸ¥é“è‡ªå·±å«ä»€ä¹ˆ` |
| **BeanFactoryAware** | `è·å–Beanå·¥å‚` | `çŸ¥é“å…¬å¸åœ¨å“ª` |
| **ApplicationContextAware** | `è·å–åº”ç”¨ä¸Šä¸‹æ–‡` | `è·å¾—å…¬å¸é€šè®¯å½•` |
| **EnvironmentAware** | `è·å–ç¯å¢ƒé…ç½®` | `äº†è§£å·¥ä½œç¯å¢ƒå‚æ•°` |
| **ResourceLoaderAware** | `è·å–èµ„æºåŠ è½½å™¨` | `çŸ¥é“æ–‡ä»¶æŸœåœ¨å“ª` |

### 2.3 å®æˆ˜åº”ç”¨ç¤ºä¾‹


**åœºæ™¯**ï¼šä½ çš„Beanéœ€è¦çŸ¥é“è‡ªå·±åœ¨Springå®¹å™¨ä¸­çš„åå­—

```java
@Component
public class UserService implements BeanNameAware {
    
    private String beanName;
    
    // Springä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå‘Šè¯‰ä½ Beançš„åå­—
    @Override
    public void setBeanName(String name) {
        this.beanName = name;
        System.out.println("æˆ‘çš„Beanåå­—æ˜¯: " + name);
    }
    
    public void showInfo() {
        System.out.println("å½“å‰Bean: " + beanName);
    }
}
```

**æ‰§è¡Œæ—¶æœºå›¾**ï¼š
```
Beanåˆ›å»ºæµç¨‹ï¼š
å®ä¾‹åŒ– â†’ å±æ€§æ³¨å…¥ â†’ ã€Awareå›è°ƒã€‘ â†’ åˆå§‹åŒ–å‰ â†’ ...
                      â†‘
                  åœ¨è¿™é‡Œæ‰§è¡Œï¼
                  å‘Šè¯‰Beanç¯å¢ƒä¿¡æ¯
```

### 2.4 å¤šä¸ªAwareçš„æ‰§è¡Œé¡ºåº


**ğŸ”¹ è®°å¿†æŠ€å·§**ï¼šä»å°åˆ°å¤§ã€ä»å†…åˆ°å¤–

```
æ‰§è¡Œé¡ºåºï¼ˆå›ºå®šçš„ï¼‰ï¼š
1. BeanNameAware        â† å…ˆçŸ¥é“è‡ªå·±æ˜¯è°
2. BeanClassLoaderAware â† å†çŸ¥é“ç±»åŠ è½½å™¨
3. BeanFactoryAware     â† ç„¶åçŸ¥é“å·¥å‚
4. EnvironmentAware     â† æ¥ç€çŸ¥é“ç¯å¢ƒ
5. ApplicationContextAware â† æœ€åçŸ¥é“æ•´ä¸ªå®¹å™¨
```

**å®é™…åº”ç”¨å»ºè®®**ï¼š
- ğŸŸ¢ **æ¨èä½¿ç”¨**ï¼š`ApplicationContextAware` - åŠŸèƒ½æœ€å¼ºå¤§ï¼Œèƒ½è·å–å®¹å™¨æ‰€æœ‰ä¿¡æ¯
- ğŸŸ¡ **é€‚åº¦ä½¿ç”¨**ï¼š`BeanNameAware` - è°ƒè¯•å’Œæ—¥å¿—åœºæ™¯
- ğŸ”´ **è°¨æ…ä½¿ç”¨**ï¼š`BeanFactoryAware` - å®¹æ˜“è€¦åˆåº•å±‚å®ç°

---

## 3. âš™ï¸ åˆå§‹åŒ–å‰å¤„ç†


### 3.1 ä»€ä¹ˆæ˜¯åˆå§‹åŒ–å‰å¤„ç†


**é€šä¿—ç†è§£**ï¼šå°±åƒè€ƒè¯•å‰çš„å‡†å¤‡å·¥ä½œ - å‘å·å­ã€å†™åå­—ã€æ£€æŸ¥ç­”é¢˜å¡ã€‚åˆå§‹åŒ–å‰å¤„ç†å°±æ˜¯åœ¨çœŸæ­£åˆå§‹åŒ–ä¹‹å‰åšçš„å‡†å¤‡å·¥ä½œã€‚

**æ ¸å¿ƒæ¥å£**ï¼š`BeanPostProcessor` çš„ `postProcessBeforeInitialization` æ–¹æ³•

### 3.2 BeanPostProcessoræ¥å£è¯¦è§£


```java
public interface BeanPostProcessor {
    
    // åˆå§‹åŒ–ã€å‰ã€‘è°ƒç”¨
    @Nullable
    default Object postProcessBeforeInitialization(Object bean, String beanName) {
        return bean; // è¿”å›å¤„ç†åçš„beanï¼ˆå¯ä»¥æ˜¯ä»£ç†å¯¹è±¡ï¼‰
    }
    
    // åˆå§‹åŒ–ã€åã€‘è°ƒç”¨ï¼ˆä¸‹ä¸€èŠ‚è®²ï¼‰
    @Nullable
    default Object postProcessAfterInitialization(Object bean, String beanName) {
        return bean;
    }
}
```

### 3.3 å…¸å‹åº”ç”¨åœºæ™¯


**åœºæ™¯1ï¼šæ³¨è§£è§£æ** - Springå¦‚ä½•å¤„ç† `@PostConstruct` æ³¨è§£

```java
// Springå†…ç½®çš„å¤„ç†å™¨
public class CommonAnnotationBeanPostProcessor implements BeanPostProcessor {
    
    @Override
    public Object postProcessBeforeInitialization(Object bean, String beanName) {
        // æ£€æŸ¥beanä¸­æ˜¯å¦æœ‰@PostConstructæ³¨è§£çš„æ–¹æ³•
        // å¦‚æœæœ‰ï¼Œå°±è°ƒç”¨è¿™ä¸ªæ–¹æ³•
        return bean;
    }
}
```

**ä½ çš„ä¸šåŠ¡ä»£ç **ï¼š
```java
@Component
public class OrderService {
    
    @PostConstruct  // â† è¿™ä¸ªæ³¨è§£å°±æ˜¯åœ¨åˆå§‹åŒ–å‰å¤„ç†æ—¶è¢«è¯†åˆ«çš„
    public void init() {
        System.out.println("è®¢å•æœåŠ¡åˆå§‹åŒ–ï¼šåŠ è½½é…ç½®...");
    }
}
```

**æ‰§è¡Œæµç¨‹å›¾**ï¼š
```
Awareå›è°ƒå®Œæˆ
    â†“
éå†æ‰€æœ‰BeanPostProcessor
    â†“
æ‰§è¡ŒpostProcessBeforeInitialization
    â†“
å‘ç°@PostConstructæ³¨è§£
    â†“
è°ƒç”¨init()æ–¹æ³•
    â†“
è¿›å…¥ä¸‹ä¸€æ­¥ï¼šåˆå§‹åŒ–å›è°ƒ
```

### 3.4 è‡ªå®šä¹‰åˆå§‹åŒ–å‰å¤„ç†


**å®æˆ˜æ¡ˆä¾‹**ï¼šç»Ÿä¸€ç»™æ‰€æœ‰Beanæ‰“å°åˆ›å»ºæ—¥å¿—

```java
@Component
public class MyBeanLogger implements BeanPostProcessor {
    
    @Override
    public Object postProcessBeforeInitialization(Object bean, String beanName) {
        System.out.println("ã€åˆå§‹åŒ–å‰ã€‘Beanå‡†å¤‡åˆå§‹åŒ–: " + beanName);
        return bean; // å¿…é¡»è¿”å›beanï¼Œå¯ä»¥è¿”å›ä»£ç†å¯¹è±¡
    }
}
```

> âš ï¸ **é‡è¦æç¤º**
> 
> - `BeanPostProcessor` ä¼šä½œç”¨äº**æ‰€æœ‰Bean**
> - è¿”å›å€¼å¯ä»¥æ˜¯åŸBeanï¼Œä¹Ÿå¯ä»¥æ˜¯åŒ…è£…åçš„ä»£ç†å¯¹è±¡
> - å¦‚æœè¿”å›nullï¼Œä¼šå¯¼è‡´Beanåˆå§‹åŒ–å¤±è´¥

---

## 4. ğŸ”§ åˆå§‹åŒ–å›è°ƒæ‰§è¡Œ


### 4.1 åˆå§‹åŒ–å›è°ƒæ˜¯ä»€ä¹ˆ


**é€šä¿—è§£é‡Š**ï¼šå°±æ˜¯ä½ è‡ªå·±å®šä¹‰çš„"å¼€æœºå¯åŠ¨ç¨‹åº"ã€‚Springåˆ›å»ºå¥½Beanåï¼Œä¼šè°ƒç”¨ä½ æŒ‡å®šçš„åˆå§‹åŒ–æ–¹æ³•ã€‚

**ä¸‰ç§å®ç°æ–¹å¼å¯¹æ¯”**ï¼š

| æ–¹å¼ | **ä»£ç ç¤ºä¾‹** | **ä¼˜ç‚¹** | **ç¼ºç‚¹** |
|-----|------------|---------|---------|
| **@PostConstructæ³¨è§£** | `@PostConstruct void init()` | `ç®€å•æ˜“ç”¨ï¼Œæ¨è` | `éœ€è¦JSR-250æ”¯æŒ` |
| **InitializingBeanæ¥å£** | `implements InitializingBean` | `SpringåŸç”Ÿï¼Œæ— éœ€é¢å¤–ä¾èµ–` | `ä»£ç ä¾µå…¥æ€§å¼º` |
| **è‡ªå®šä¹‰init-method** | `@Bean(initMethod="myInit")` | `è§£è€¦ï¼Œé€‚åˆç¬¬ä¸‰æ–¹Bean` | `éœ€è¦é¢å¤–é…ç½®` |

### 4.2 æ–¹å¼ä¸€ï¼š@PostConstructæ³¨è§£ï¼ˆæ¨èï¼‰


```java
@Component
public class CacheService {
    
    private Map<String, Object> cache = new HashMap<>();
    
    @PostConstruct  // â† æœ€ç®€å•ç›´æ¥çš„æ–¹å¼
    public void loadCache() {
        System.out.println("åˆå§‹åŒ–ç¼“å­˜æ•°æ®...");
        cache.put("default", "åˆå§‹å€¼");
    }
}
```

**ä¼˜ç‚¹åˆ†æ**ï¼š
- âœ… ä»£ç ç®€æ´ï¼Œä¸€ä¸ªæ³¨è§£æå®š
- âœ… ç¬¦åˆJavaè§„èŒƒï¼ˆJSR-250ï¼‰
- âœ… å¯ä»¥æœ‰ä»»æ„æ–¹æ³•å
- âœ… å¯ä»¥æŠ›å‡ºå¼‚å¸¸

### 4.3 æ–¹å¼äºŒï¼šInitializingBeanæ¥å£


```java
@Component
public class DatabaseService implements InitializingBean {
    
    @Override
    public void afterPropertiesSet() throws Exception {
        // è¿™ä¸ªæ–¹æ³•åœ¨å±æ€§è®¾ç½®å®Œæˆåè‡ªåŠ¨è°ƒç”¨
        System.out.println("æ•°æ®åº“è¿æ¥æ± åˆå§‹åŒ–...");
    }
}
```

**ä»€ä¹ˆæ—¶å€™ç”¨**ï¼š
- éœ€è¦å¤„ç†å¼‚å¸¸çš„åˆå§‹åŒ–é€»è¾‘
- ä¸æƒ³å¼•å…¥é¢å¤–æ³¨è§£ä¾èµ–
- Springæ¡†æ¶å†…éƒ¨ç»„ä»¶å¼€å‘

### 4.4 æ–¹å¼ä¸‰ï¼šè‡ªå®šä¹‰init-method


```java
@Configuration
public class AppConfig {
    
    @Bean(initMethod = "startup")  // â† æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•å
    public RedisClient redisClient() {
        return new RedisClient();
    }
}

// ç¬¬ä¸‰æ–¹ç±»ï¼ˆä½ æ— æ³•ä¿®æ”¹æºç ï¼‰
public class RedisClient {
    
    public void startup() {  // â† ä¸éœ€è¦æ³¨è§£ï¼Œæ–¹æ³•åå¯¹åº”å³å¯
        System.out.println("Rediså®¢æˆ·ç«¯å¯åŠ¨...");
    }
}
```

**é€‚ç”¨åœºæ™¯**ï¼š
- é›†æˆç¬¬ä¸‰æ–¹åº“ï¼Œæ— æ³•ä¿®æ”¹æºç 
- XMLé…ç½®æ–¹å¼ `<bean init-method="...">`
- éœ€è¦çµæ´»æŒ‡å®šä¸åŒåˆå§‹åŒ–æ–¹æ³•

### 4.5 ä¸‰ç§æ–¹å¼çš„æ‰§è¡Œé¡ºåº


```
å¦‚æœä¸€ä¸ªBeanåŒæ—¶ä½¿ç”¨äº†ä¸‰ç§æ–¹å¼ï¼š

æ‰§è¡Œé¡ºåºï¼ˆå›ºå®šï¼‰ï¼š
1. @PostConstruct          â† æœ€å…ˆæ‰§è¡Œ
2. InitializingBeanæ¥å£    â† å…¶æ¬¡æ‰§è¡Œ
3. è‡ªå®šä¹‰init-method       â† æœ€åæ‰§è¡Œ
```

**å®éªŒéªŒè¯**ï¼š
```java
@Component
public class LifecycleBean implements InitializingBean {
    
    @PostConstruct
    public void postConstruct() {
        System.out.println("1. @PostConstructæ‰§è¡Œ");
    }
    
    @Override
    public void afterPropertiesSet() {
        System.out.println("2. InitializingBeanæ‰§è¡Œ");
    }
    
    public void customInit() {
        System.out.println("3. è‡ªå®šä¹‰init-methodæ‰§è¡Œ");
    }
}

// è¾“å‡ºé¡ºåºï¼š1 â†’ 2 â†’ 3
```

---

## 5. ğŸ¨ åˆå§‹åŒ–åå¤„ç†ä¸ä»£ç†


### 5.1 åˆå§‹åŒ–åå¤„ç†çš„ä½œç”¨


**é€šä¿—ç†è§£**ï¼šåˆå§‹åŒ–åå¤„ç†å°±åƒ"è´¨æ£€ç¯èŠ‚" - Beanå·²ç»å‡†å¤‡å¥½äº†ï¼Œæœ€åæ£€æŸ¥ä¸€éï¼Œå¿…è¦æ—¶åŒ…è£…ä¸€ä¸‹ï¼ˆåˆ›å»ºä»£ç†ï¼‰å†äº¤ç»™ç”¨æˆ·ã€‚

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- å¯¹åˆå§‹åŒ–å®Œæˆçš„Beanåšæœ€åå¤„ç†
- **åˆ›å»ºAOPä»£ç†å¯¹è±¡**ï¼ˆæœ€é‡è¦çš„åº”ç”¨ï¼‰
- å¯¹Beanåšå¢å¼ºæˆ–åŒ…è£…

### 5.2 ä»£ç†å¯¹è±¡åˆ›å»ºåŸç†


**ä»€ä¹ˆæ˜¯ä»£ç†**ï¼š
> ğŸª **ä»£è´­ç±»æ¯”**
> 
> - ä½ æƒ³ä¹°iPhoneï¼ˆåŸå§‹Beanï¼‰
> - ä»£è´­å¸®ä½ ä¹°ï¼ˆä»£ç†å¯¹è±¡ï¼‰
> - ä»£è´­å¯ä»¥éªŒè´§ã€é€€æ¢è´§ï¼ˆå¢å¼ºåŠŸèƒ½ï¼‰
> - ä½ æ‹¿åˆ°çš„æ˜¯ä»£è´­äº¤ç»™ä½ çš„æ‰‹æœºï¼ˆä»£ç†å¯¹è±¡ï¼‰

**Springä¸­çš„ä»£ç†**ï¼š
```
åŸå§‹Beanï¼šUserServiceçš„æ–¹æ³•
    â†“
ä»£ç†å¯¹è±¡ï¼šåŒ…è£…åçš„UserService
    â†“
å¢å¼ºåŠŸèƒ½ï¼šäº‹åŠ¡ã€æ—¥å¿—ã€æƒé™æ£€æŸ¥ç­‰
```

### 5.3 AOPä»£ç†åˆ›å»ºè¿‡ç¨‹


**æ ¸å¿ƒå¤„ç†å™¨**ï¼š`AbstractAutoProxyCreator`

```
åˆå§‹åŒ–åå¤„ç†æµç¨‹ï¼š

1. Beanåˆå§‹åŒ–å®Œæˆ
   â†“
2. æ‰§è¡ŒpostProcessAfterInitialization
   â†“
3. æ£€æŸ¥æ˜¯å¦éœ€è¦AOPä»£ç†
   â†“
4. å¦‚æœéœ€è¦ï¼Œåˆ›å»ºä»£ç†å¯¹è±¡
   â†“
5. è¿”å›ä»£ç†å¯¹è±¡ï¼ˆæ›¿æ¢åŸå§‹Beanï¼‰
```

**å®é™…æ¡ˆä¾‹**ï¼šäº‹åŠ¡ä»£ç†

```java
@Service
public class AccountService {
    
    @Transactional  // â† è¿™ä¸ªæ³¨è§£è§¦å‘ä»£ç†åˆ›å»º
    public void transfer(String from, String to, int amount) {
        // ä¸šåŠ¡é€»è¾‘
    }
}

// Springåœ¨åˆå§‹åŒ–åå¤„ç†æ—¶ï¼š
// 1. å‘ç°@Transactionalæ³¨è§£
// 2. åˆ›å»ºAccountServiceçš„ä»£ç†å¯¹è±¡
// 3. ä»£ç†å¯¹è±¡åœ¨æ–¹æ³•å‰åå¢åŠ äº‹åŠ¡ç®¡ç†
// 4. è¿”å›ä»£ç†å¯¹è±¡æ”¾å…¥å®¹å™¨
```

### 5.4 ä»£ç†åˆ›å»ºæµç¨‹å›¾


```
åˆå§‹åŒ–å›è°ƒå®Œæˆ
    â†“
æ‰§è¡ŒBeanPostProcessor.postProcessAfterInitialization()
    â†“
æ£€æŸ¥æ˜¯å¦æœ‰AOPåˆ‡é¢åŒ¹é…æ­¤Bean
    â†“
    â”œâ”€ æœ‰åŒ¹é… â†’ åˆ›å»ºä»£ç†å¯¹è±¡ â†’ è¿”å›ä»£ç†
    â””â”€ æ— åŒ¹é… â†’ ç›´æ¥è¿”å›åŸå§‹Bean
```

### 5.5 å¦‚ä½•åˆ¤æ–­Beanæ˜¯å¦è¢«ä»£ç†


**æ–¹æ³•1ï¼šç›´æ¥çœ‹ç±»å**
```java
@Autowired
private UserService userService;

public void test() {
    // æ‰“å°ç±»å
    System.out.println(userService.getClass().getName());
    
    // ä»£ç†å¯¹è±¡è¾“å‡ºç±»ä¼¼ï¼š
    // com.example.UserService$$EnhancerBySpringCGLIB$$1a2b3c4d
    
    // åŸå§‹å¯¹è±¡è¾“å‡ºï¼š
    // com.example.UserService
}
```

**æ–¹æ³•2ï¼šä½¿ç”¨AopUtilså·¥å…·ç±»**
```java
import org.springframework.aop.framework.AopUtils;

boolean isProxy = AopUtils.isAopProxy(userService);
boolean isCglibProxy = AopUtils.isCglibProxy(userService);
boolean isJdkProxy = AopUtils.isJdkDynamicProxy(userService);
```

### 5.6 ä¸¤ç§ä»£ç†æ–¹å¼å¯¹æ¯”


| ä»£ç†æ–¹å¼ | **å®ç°åŸç†** | **ä½¿ç”¨æ¡ä»¶** | **ç‰¹ç‚¹** |
|---------|------------|-------------|---------|
| **JDKåŠ¨æ€ä»£ç†** | `åŸºäºæ¥å£çš„ä»£ç†` | `Beanå¿…é¡»å®ç°æ¥å£` | `ç”Ÿæˆæ¥å£çš„å®ç°ç±»` |
| **CGLIBä»£ç†** | `åŸºäºç»§æ‰¿çš„ä»£ç†` | `Beanå¯ä»¥æ˜¯æ™®é€šç±»` | `ç”ŸæˆBeançš„å­ç±»` |

**é€‰æ‹©è§„åˆ™**ï¼š
```
Springè‡ªåŠ¨åˆ¤æ–­ï¼š
â”œâ”€ Beanå®ç°äº†æ¥å£ â†’ ä½¿ç”¨JDKåŠ¨æ€ä»£ç†
â””â”€ Beanæ²¡æœ‰æ¥å£   â†’ ä½¿ç”¨CGLIBä»£ç†

å¼ºåˆ¶ä½¿ç”¨CGLIBï¼š
@EnableAspectJAutoProxy(proxyTargetClass = true)
```

---

## 6. âœ… å®Œæ•´æµç¨‹æ€»ç»“


### 6.1 Beanåˆå§‹åŒ–å®Œæ•´æ—¶åºå›¾


```
Beanåˆ›å»ºå¼€å§‹
    â†“
1. å®ä¾‹åŒ–ï¼ˆnewå¯¹è±¡ï¼‰
    â†“
2. å±æ€§æ³¨å…¥ï¼ˆä¾èµ–æ³¨å…¥ï¼‰
    â†“
3. ã€Awareæ¥å£å›è°ƒã€‘
   â”œâ”€ BeanNameAware
   â”œâ”€ BeanFactoryAware
   â””â”€ ApplicationContextAware
    â†“
4. ã€åˆå§‹åŒ–å‰å¤„ç†ã€‘
   â””â”€ BeanPostProcessor.postProcessBeforeInitialization()
      â””â”€ å¤„ç†@PostConstructæ³¨è§£
    â†“
5. ã€åˆå§‹åŒ–å›è°ƒã€‘
   â”œâ”€ @PostConstructæ–¹æ³•
   â”œâ”€ InitializingBean.afterPropertiesSet()
   â””â”€ è‡ªå®šä¹‰init-method
    â†“
6. ã€åˆå§‹åŒ–åå¤„ç†ã€‘
   â””â”€ BeanPostProcessor.postProcessAfterInitialization()
      â””â”€ AOPä»£ç†åˆ›å»º
    â†“
7. Beanå®Œæˆæ ‡è®°ï¼ˆå¯ä»¥ä½¿ç”¨äº†ï¼‰
    â†“
8. æ”¾å…¥å•ä¾‹æ± 
```

### 6.2 æ ¸å¿ƒçŸ¥è¯†ç‚¹æ£€æŸ¥æ¸…å•


**âœ… å¿…é¡»æŒæ¡**ï¼š
- [ ] ç†è§£Beanåˆå§‹åŒ–çš„6ä¸ªå…³é”®æ­¥éª¤
- [ ] çŸ¥é“Awareæ¥å£çš„ä½œç”¨å’Œå¸¸ç”¨ç±»å‹
- [ ] æŒæ¡ä¸‰ç§åˆå§‹åŒ–å›è°ƒæ–¹å¼åŠä¼˜å…ˆçº§
- [ ] ç†è§£BeanPostProcessorçš„ä¸¤ä¸ªæ–¹æ³•åŒºåˆ«
- [ ] çŸ¥é“AOPä»£ç†åœ¨å“ªä¸ªé˜¶æ®µåˆ›å»º

**ğŸ”¸ é‡è¦æ¦‚å¿µè®°å¿†**ï¼š
```
Awareæ¥å£ = Beanæ„ŸçŸ¥Springç¯å¢ƒ
åˆå§‹åŒ–å‰ = @PostConstructç­‰æ³¨è§£å¤„ç†
åˆå§‹åŒ–ä¸­ = æ‰§è¡Œè‡ªå®šä¹‰åˆå§‹åŒ–é€»è¾‘
åˆå§‹åŒ–å = åˆ›å»ºAOPä»£ç†å¯¹è±¡
```

### 6.3 å®é™…å¼€å‘å»ºè®®


**ğŸŸ¢ æ¨èåšæ³•**ï¼š
1. **åˆå§‹åŒ–æ–¹æ³•é¦–é€‰** `@PostConstruct` - ç®€å•ç›´æ¥
2. **éœ€è¦å®¹å™¨ä¿¡æ¯æ—¶** å®ç°`ApplicationContextAware` 
3. **éœ€è¦AOPåŠŸèƒ½** æ·»åŠ ç›¸åº”æ³¨è§£ï¼ˆ@Transactionalã€@Asyncç­‰ï¼‰

**ğŸŸ¡ æ³¨æ„äº‹é¡¹**ï¼š
- åˆå§‹åŒ–æ–¹æ³•ä¸è¦åšå¤ªé‡çš„æ“ä½œï¼ˆé¿å…å¯åŠ¨æ…¢ï¼‰
- ä»£ç†å¯¹è±¡è°ƒç”¨è‡ªèº«æ–¹æ³•æ—¶AOPä¸ç”Ÿæ•ˆ
- å¾ªç¯ä¾èµ–æ—¶è¦æ³¨æ„åˆå§‹åŒ–é¡ºåº

**ğŸ”´ é¿å…çš„åšæ³•**ï¼š
- ä¸è¦åœ¨æ„é€ å‡½æ•°ä¸­ä½¿ç”¨ä¾èµ–æ³¨å…¥çš„Beanï¼ˆå¯èƒ½è¿˜æ²¡æ³¨å…¥ï¼‰
- ä¸è¦è¿‡åº¦ä½¿ç”¨BeanPostProcessorï¼ˆå½±å“æ‰€æœ‰Beanï¼‰
- ä¸è¦åœ¨åˆå§‹åŒ–æ–¹æ³•ä¸­æŠ›å‡ºå¼‚å¸¸ï¼ˆä¼šå¯¼è‡´å¯åŠ¨å¤±è´¥ï¼‰

### 6.4 é¢è¯•é«˜é¢‘é—®é¢˜


**Q1ï¼šBeançš„åˆå§‹åŒ–å’Œå®ä¾‹åŒ–æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**
```
å®ä¾‹åŒ– = newå¯¹è±¡ï¼ˆåˆ†é…å†…å­˜ï¼‰
åˆå§‹åŒ– = ç»™å¯¹è±¡èµ‹å€¼ã€é…ç½®ï¼ˆè®©å¯¹è±¡å¯ç”¨ï¼‰

ç±»æ¯”ï¼š
å®ä¾‹åŒ– = ç›–å¥½æˆ¿å­
åˆå§‹åŒ– = è£…ä¿®ã€é€šæ°´ç”µã€ä¹°å®¶å…·
```

**Q2ï¼š@PostConstructå’Œinit-methodå“ªä¸ªå…ˆæ‰§è¡Œï¼Ÿ**
```
@PostConstructå…ˆæ‰§è¡Œï¼

å®Œæ•´é¡ºåºï¼š
@PostConstruct â†’ InitializingBean â†’ init-method
```

**Q3ï¼šSpringçš„Beanæ˜¯ä»€ä¹ˆæ—¶å€™åˆ›å»ºä»£ç†çš„ï¼Ÿ**
```
åœ¨åˆå§‹åŒ–ã€åã€‘å¤„ç†é˜¶æ®µï¼

åˆå§‹åŒ–å®Œæˆ â†’ postProcessAfterInitialization â†’ åˆ›å»ºä»£ç†
```

### 6.5 å­¦ä¹ è·¯å¾„å»ºè®®


```
æ–°æ‰‹å­¦ä¹ è·¯å¾„ï¼š
1. ç†è§£Beanç”Ÿå‘½å‘¨æœŸæ•´ä½“æ¦‚å¿µ
   â†“
2. æŒæ¡@PostConstructåŸºæœ¬ç”¨æ³•
   â†“
3. äº†è§£Awareæ¥å£è·å–å®¹å™¨ä¿¡æ¯
   â†“
4. å­¦ä¹ BeanPostProcessoræ‰©å±•æœºåˆ¶
   â†“
5. æ·±å…¥AOPä»£ç†åˆ›å»ºåŸç†

è¿›é˜¶æ–¹å‘ï¼š
â†’ å¾ªç¯ä¾èµ–è§£å†³æœºåˆ¶
â†’ è‡ªå®šä¹‰BeanPostProcessor
â†’ FactoryBeané«˜çº§åº”ç”¨
```

---

## ğŸ¯ æ ¸å¿ƒè¦ç‚¹é€Ÿè®°


**ä¸€å¥è¯æ€»ç»“**ï¼š
> Beanåˆå§‹åŒ–å°±æ˜¯è®©Beanä»"åˆ›å»ºå‡ºæ¥"å˜æˆ"å¯ä»¥ç”¨" - å…ˆæ„ŸçŸ¥ç¯å¢ƒï¼ˆAwareï¼‰ï¼Œå†æ‰§è¡Œåˆå§‹åŒ–é€»è¾‘ï¼Œæœ€ååˆ›å»ºä»£ç†ï¼ˆAOPï¼‰ã€‚

**è®°å¿†å£è¯€**ï¼š
```
å®ä¾‹å±æ€§éƒ½æ³¨å…¥ï¼Œ
Awareæ¥å£å…ˆå›è°ƒï¼Œ
åˆå§‹åŒ–å‰åšå‡†å¤‡ï¼Œ
PostConstructæœ€å…ˆè·‘ï¼Œ
æ¥å£æ–¹æ³•ç´§è·Ÿä¸Šï¼Œ
è‡ªå®šä¹‰çš„æ’æœ€åï¼Œ
åˆå§‹åŒ–åé€ ä»£ç†ï¼Œ
Beanå®Œæˆå¯ä½¿ç”¨ï¼
```

**ğŸ”‘ å…³é”®ç†è§£**ï¼š
- **Aware** = è®©BeançŸ¥é“Springç¯å¢ƒ
- **BeanPostProcessor** = Beançš„"è´¨æ£€å‘˜"å’Œ"åŒ…è£…å·¥"
- **åˆå§‹åŒ–** = æ‰§è¡Œä½ è‡ªå®šä¹‰çš„å‡†å¤‡å·¥ä½œ
- **ä»£ç†** = ç»™Beanç©¿ä¸Š"å¢å¼ºå¤–è¡£"ï¼ˆAOPï¼‰