---
title: 29ã€JTAåˆ†å¸ƒå¼äº‹åŠ¡å®ç°
---
## ğŸ“š ç›®å½•

1. [JTAåˆ†å¸ƒå¼äº‹åŠ¡åŸºç¡€æ¦‚å¿µ](#1-jtaåˆ†å¸ƒå¼äº‹åŠ¡åŸºç¡€æ¦‚å¿µ)
2. [JTAæ ¸å¿ƒè§„èŒƒä¸æ¶æ„](#2-jtaæ ¸å¿ƒè§„èŒƒä¸æ¶æ„)
3. [JtaTransactionManageré…ç½®è¯¦è§£](#3-jtatransactionmanageré…ç½®è¯¦è§£)
4. [ä¸‰å¤§ä¸»æµJTAå®ç°æ–¹æ¡ˆ](#4-ä¸‰å¤§ä¸»æµjtaå®ç°æ–¹æ¡ˆ)
5. [XAæ•°æ®æºé…ç½®å®æˆ˜](#5-xaæ•°æ®æºé…ç½®å®æˆ˜)
6. [å…¨å±€äº‹åŠ¡ç®¡ç†æœºåˆ¶](#6-å…¨å±€äº‹åŠ¡ç®¡ç†æœºåˆ¶)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ JTAåˆ†å¸ƒå¼äº‹åŠ¡åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯JTAåˆ†å¸ƒå¼äº‹åŠ¡


**é€šä¿—ç†è§£**ï¼šæƒ³è±¡ä½ åœ¨ç½‘è´­æ—¶ï¼Œéœ€è¦åŒæ—¶æ“ä½œä¸‰ä»¶äº‹ï¼š
- æ‰£å‡è´¦æˆ·ä½™é¢ï¼ˆé“¶è¡Œæ•°æ®åº“ï¼‰
- å‡å°‘å•†å“åº“å­˜ï¼ˆå•†å“æ•°æ®åº“ï¼‰
- ç”Ÿæˆè®¢å•è®°å½•ï¼ˆè®¢å•æ•°æ®åº“ï¼‰

è¿™ä¸‰ä¸ªæ“ä½œå¿…é¡»**è¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥**ï¼Œä¸èƒ½å‡ºç°æ‰£äº†é’±ä½†æ²¡å‡åº“å­˜çš„æƒ…å†µã€‚è¿™å°±æ˜¯åˆ†å¸ƒå¼äº‹åŠ¡è¦è§£å†³çš„é—®é¢˜ã€‚

**JTAå®šä¹‰**ï¼š
```
JTAï¼ˆJava Transaction APIï¼‰ï¼šJavaäº‹åŠ¡API
ä½œç”¨ï¼šç»Ÿä¸€ç®¡ç†è·¨å¤šä¸ªæ•°æ®æºçš„äº‹åŠ¡æ“ä½œ
ç›®æ ‡ï¼šä¿è¯å¤šä¸ªæ•°æ®åº“æ“ä½œçš„åŸå­æ€§ã€ä¸€è‡´æ€§
```

**ğŸ”¸ æ ¸å¿ƒç‰¹ç‚¹**
- **è·¨æ•°æ®æº**ï¼šå¯ä»¥åŒæ—¶æ“ä½œMySQLã€Oracleã€PostgreSQLç­‰å¤šä¸ªæ•°æ®åº“
- **å…¨å±€åè°ƒ**ï¼šæœ‰ä¸€ä¸ª"æ€»æŒ‡æŒ¥"ç»Ÿä¸€ç®¡ç†æ‰€æœ‰æ•°æ®åº“çš„æäº¤/å›æ»š
- **æ ‡å‡†è§„èŒƒ**ï¼šJavaå®˜æ–¹å®šä¹‰çš„æ ‡å‡†æ¥å£ï¼Œä¸åŒå‚å•†éƒ½è¦éµå®ˆ

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦JTA


**ä¼ ç»Ÿå•æ•°æ®æºäº‹åŠ¡çš„å±€é™**ï¼š

```
åœºæ™¯ï¼šè®¢å•ç³»ç»Ÿ
æ“ä½œæµç¨‹ï¼š
1. æ‰£å‡ç”¨æˆ·ä½™é¢ â†’ æˆåŠŸ âœ“
2. å‡å°‘å•†å“åº“å­˜ â†’ æˆåŠŸ âœ“  
3. åˆ›å»ºè®¢å•è®°å½• â†’ å¤±è´¥ âœ—

é—®é¢˜ï¼š
å‰ä¸¤æ­¥å·²ç»æäº¤ï¼Œç¬¬ä¸‰æ­¥å¤±è´¥äº†æ€ä¹ˆåŠï¼Ÿ
ç”¨æˆ·é’±æ‰£äº†ï¼Œåº“å­˜ä¹Ÿå‡äº†ï¼Œä½†è®¢å•æ²¡ç”Ÿæˆï¼
```

**JTAåˆ†å¸ƒå¼äº‹åŠ¡çš„è§£å†³æ–¹æ¡ˆ**ï¼š

```
å…¨å±€äº‹åŠ¡æ§åˆ¶ï¼š
1. å¼€å¯å…¨å±€äº‹åŠ¡
2. æ‰£å‡ç”¨æˆ·ä½™é¢ï¼ˆæš‚ä¸æäº¤ï¼‰
3. å‡å°‘å•†å“åº“å­˜ï¼ˆæš‚ä¸æäº¤ï¼‰
4. åˆ›å»ºè®¢å•è®°å½•ï¼ˆæš‚ä¸æäº¤ï¼‰
5. æ£€æŸ¥æ‰€æœ‰æ“ä½œéƒ½æˆåŠŸ â†’ ç»Ÿä¸€æäº¤
6. ä»»ä½•ä¸€æ­¥å¤±è´¥ â†’ å…¨éƒ¨å›æ»š

ç»“æœï¼šè¦ä¹ˆå…¨æˆåŠŸï¼Œè¦ä¹ˆå…¨å¤±è´¥ï¼
```

> ğŸ“Œ **æ ¸å¿ƒç†è§£**  
> JTAå°±åƒä¸€ä¸ª"äº‹åŠ¡æ€»ç®¡"ï¼Œå®ƒç¡®ä¿å¤šä¸ªæ•°æ®åº“çš„æ“ä½œè¦ä¹ˆä¸€èµ·æˆåŠŸï¼Œè¦ä¹ˆä¸€èµ·å¤±è´¥ï¼Œä¸ä¼šå‡ºç°"åŠåŠå­"çš„æƒ…å†µã€‚

### 1.3 JTAä¸æ™®é€šäº‹åŠ¡çš„åŒºåˆ«


| ğŸ†š å¯¹æ¯”é¡¹ | **æ™®é€šäº‹åŠ¡** | **JTAåˆ†å¸ƒå¼äº‹åŠ¡** |
|---------|-------------|-----------------|
| **ç®¡ç†èŒƒå›´** | å•ä¸ªæ•°æ®æº | å¤šä¸ªæ•°æ®æº |
| **å®ç°æ–¹å¼** | æ•°æ®åº“æœ¬èº«çš„äº‹åŠ¡ | XAåè®®åè°ƒ |
| **æ€§èƒ½å¼€é”€** | è¾ƒä½ | è¾ƒé«˜ï¼ˆéœ€è¦ä¸¤é˜¶æ®µæäº¤ï¼‰ |
| **ä½¿ç”¨åœºæ™¯** | ç®€å•ä¸šåŠ¡ | è·¨åº“ã€è·¨ç³»ç»Ÿæ“ä½œ |
| **é…ç½®å¤æ‚åº¦** | ç®€å• | å¤æ‚ |

**ğŸŒ± å…¥é—¨çº§ç†è§£**ï¼š
- æ™®é€šäº‹åŠ¡ = ä¸€ä¸ªäººç®¡ç†ä¸€ä¸ªä»“åº“
- JTAåˆ†å¸ƒå¼äº‹åŠ¡ = æ€»ç»ç†åè°ƒå¤šä¸ªä»“åº“

---

## 2. ğŸ“‹ JTAæ ¸å¿ƒè§„èŒƒä¸æ¶æ„


### 2.1 JTAè§„èŒƒçš„ä¸‰å¤§æ ¸å¿ƒæ¥å£


**JTAå®šä¹‰äº†ä¸‰ä¸ªå…³é”®è§’è‰²**ï¼š

```
åˆ†å¸ƒå¼äº‹åŠ¡å‚ä¸è€…ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. äº‹åŠ¡ç®¡ç†å™¨ (Transaction Manager) â”‚
â”‚     - æ€»æŒ‡æŒ¥                        â”‚
â”‚     - åè°ƒæ‰€æœ‰èµ„æº                   â”‚
â”‚     - å†³å®šæäº¤æˆ–å›æ»š                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2. èµ„æºç®¡ç†å™¨ (Resource Manager)    â”‚
â”‚     - æ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰             â”‚
â”‚     - æ‰§è¡Œå…·ä½“çš„æ“ä½œ                 â”‚
â”‚     - å“åº”äº‹åŠ¡ç®¡ç†å™¨çš„æŒ‡ä»¤           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  3. åº”ç”¨ç¨‹åº (Application)           â”‚
â”‚     - ä¸šåŠ¡ä»£ç                       â”‚
â”‚     - å‘èµ·äº‹åŠ¡è¯·æ±‚                  â”‚
â”‚     - è°ƒç”¨èµ„æºç®¡ç†å™¨                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”¸ æ ¸å¿ƒæ¥å£è¯´æ˜**

1. **UserTransactionï¼ˆç”¨æˆ·äº‹åŠ¡ï¼‰**
   - åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ¥å£
   - ç”¨äºå¼€å¯ã€æäº¤ã€å›æ»šäº‹åŠ¡
   - å°±åƒé¥æ§å™¨ï¼Œæ§åˆ¶äº‹åŠ¡çš„å¯åœ

2. **TransactionManagerï¼ˆäº‹åŠ¡ç®¡ç†å™¨ï¼‰**
   - Springæ¡†æ¶ä½¿ç”¨çš„æ¥å£
   - è´Ÿè´£å…¨å±€äº‹åŠ¡çš„åè°ƒ
   - å°±åƒæ€»è°ƒåº¦å‘˜

3. **XAResourceï¼ˆXAèµ„æºï¼‰**
   - æ•°æ®åº“é©±åŠ¨å®ç°çš„æ¥å£
   - æ”¯æŒä¸¤é˜¶æ®µæäº¤åè®®
   - å°±åƒå„ä¸ªä»“åº“çš„ç®¡ç†å‘˜

### 2.2 ä¸¤é˜¶æ®µæäº¤åè®®ï¼ˆ2PCï¼‰


**é€šä¿—è§£é‡Š**ï¼šå°±åƒé›†ä½“æ´»åŠ¨çš„å†³ç­–è¿‡ç¨‹

**é˜¶æ®µä¸€ï¼šå‡†å¤‡é˜¶æ®µï¼ˆæŠ•ç¥¨ï¼‰**
```
äº‹åŠ¡åè°ƒè€…è¯¢é—®ï¼š
åè°ƒè€… â†’ æ•°æ®åº“Aï¼š"ä½ èƒ½å®Œæˆæ“ä½œå—ï¼Ÿ"
æ•°æ®åº“A â†’ åè°ƒè€…ï¼š"å¯ä»¥ï¼æˆ‘å·²å‡†å¤‡å¥½ï¼ˆé”å®šèµ„æºï¼‰"

åè°ƒè€… â†’ æ•°æ®åº“Bï¼š"ä½ èƒ½å®Œæˆæ“ä½œå—ï¼Ÿ"
æ•°æ®åº“B â†’ åè°ƒè€…ï¼š"å¯ä»¥ï¼æˆ‘å·²å‡†å¤‡å¥½ï¼ˆé”å®šèµ„æºï¼‰"

åè°ƒè€… â†’ æ•°æ®åº“Cï¼š"ä½ èƒ½å®Œæˆæ“ä½œå—ï¼Ÿ"
æ•°æ®åº“C â†’ åè°ƒè€…ï¼š"ä¸è¡Œï¼æˆ‘è¿™é‡Œæœ‰é—®é¢˜"
```

**é˜¶æ®µäºŒï¼šæäº¤/å›æ»šé˜¶æ®µï¼ˆæ‰§è¡Œï¼‰**
```
æƒ…å†µ1ï¼šå…¨éƒ¨åŒæ„
åè°ƒè€… â†’ æ‰€æœ‰æ•°æ®åº“ï¼š"å¤§å®¶éƒ½åŒæ„äº†ï¼Œæ­£å¼æäº¤ï¼"
æ‰€æœ‰æ•°æ®åº“ â†’ æ‰§è¡Œæäº¤æ“ä½œ

æƒ…å†µ2ï¼šæœ‰äººåå¯¹
åè°ƒè€… â†’ æ‰€æœ‰æ•°æ®åº“ï¼š"æœ‰äººåå¯¹ï¼Œå…¨éƒ¨å›æ»šï¼"
æ‰€æœ‰æ•°æ®åº“ â†’ æ‰§è¡Œå›æ»šæ“ä½œ
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**  
> ä¸¤é˜¶æ®µæäº¤è™½ç„¶ä¿è¯äº†ä¸€è‡´æ€§ï¼Œä½†ä¹Ÿå¸¦æ¥äº†æ€§èƒ½å¼€é”€ã€‚åœ¨å‡†å¤‡é˜¶æ®µï¼Œæ•°æ®åº“éœ€è¦é”å®šèµ„æºï¼Œå¯èƒ½å¯¼è‡´å…¶ä»–æ“ä½œç­‰å¾…ã€‚

### 2.3 JTAæ¶æ„è¿è¡Œæµç¨‹


```
å®Œæ•´äº‹åŠ¡æµç¨‹ï¼š

åº”ç”¨ç¨‹åº                JTAäº‹åŠ¡ç®¡ç†å™¨           æ•°æ®åº“é›†ç¾¤
   |                         |                    |
   |--[1]å¼€å¯å…¨å±€äº‹åŠ¡-------->|                    |
   |   begin()               |                    |
   |                         |--[2]é€šçŸ¥å„æ•°æ®åº“-->|DB1,DB2,DB3
   |                         |   "å‡†å¤‡äº‹åŠ¡"       |
   |--[3]æ‰§è¡Œä¸šåŠ¡æ“ä½œ-------->|                    |
   |   insert/update         |                    |
   |                         |--[4]é¢„æäº¤æ£€æŸ¥---->|æ‰€æœ‰DB
   |                         |<--[5]è¿”å›çŠ¶æ€------|å‡†å¤‡å°±ç»ª
   |                         |                    |
   |--[6]æäº¤äº‹åŠ¡------------>|                    |
   |   commit()              |--[7]é€šçŸ¥æäº¤------>|æ‰€æœ‰DBæ‰§è¡Œ
   |<--[8]è¿”å›æˆåŠŸ-----------|<--[9]ç¡®è®¤å®Œæˆ------|æäº¤å®Œæˆ
   |                         |                    |
```

**ğŸ” æµç¨‹å…³é”®ç‚¹**ï¼š
1. åº”ç”¨ç¨‹åºé€šè¿‡JTAæ¥å£æ“ä½œï¼Œä¸ç›´æ¥æ¥è§¦æ•°æ®åº“
2. äº‹åŠ¡ç®¡ç†å™¨è´Ÿè´£åè°ƒæ‰€æœ‰æ•°æ®åº“çš„çŠ¶æ€
3. åªæœ‰æ‰€æœ‰æ•°æ®åº“éƒ½å‡†å¤‡å¥½ï¼Œæ‰ä¼šçœŸæ­£æäº¤
4. ä»»ä½•ä¸€ä¸ªç¯èŠ‚å¤±è´¥ï¼Œæ‰€æœ‰æ“ä½œéƒ½ä¼šå›æ»š

---

## 3. ğŸ”§ JtaTransactionManageré…ç½®è¯¦è§£


### 3.1 ä»€ä¹ˆæ˜¯JtaTransactionManager


**é€šä¿—ç†è§£**ï¼šSpringæ¡†æ¶ä¸­ä¸“é—¨ç”¨æ¥ç®¡ç†JTAåˆ†å¸ƒå¼äº‹åŠ¡çš„ç»„ä»¶ï¼Œç›¸å½“äºåˆ†å¸ƒå¼äº‹åŠ¡çš„"å¤§ç®¡å®¶"ã€‚

**ğŸ”¸ æ ¸å¿ƒä½œç”¨**
- æ¡¥æ¥Springäº‹åŠ¡å’ŒJTAè§„èŒƒ
- ç®€åŒ–åˆ†å¸ƒå¼äº‹åŠ¡çš„ä½¿ç”¨
- æä¾›å£°æ˜å¼äº‹åŠ¡æ”¯æŒ

### 3.2 åŸºç¡€é…ç½®æ­¥éª¤


**é…ç½®ä¸‰è¦ç´ **ï¼š

```
JTAé…ç½®å¿…å¤‡ç»„ä»¶ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. JTAäº‹åŠ¡ç®¡ç†å™¨         â”‚ â† JtaTransactionManager
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. XAæ•°æ®æº             â”‚ â† æ”¯æŒåˆ†å¸ƒå¼äº‹åŠ¡çš„æ•°æ®æº
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. JTAå®ç°æ¡†æ¶          â”‚ â† Atomikos/Bitronix/Narayana
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŸºæœ¬é…ç½®ç¤ºä¾‹**ï¼š

```java
@Configuration
@EnableTransactionManagement
public class JtaConfig {
    
    // é…ç½®JTAäº‹åŠ¡ç®¡ç†å™¨ï¼ˆSpringæä¾›çš„æ¡¥æ¥ç»„ä»¶ï¼‰
    @Bean
    public JtaTransactionManager transactionManager(
            UserTransaction userTransaction,
            TransactionManager transactionManager) {
        
        JtaTransactionManager jtaTM = new JtaTransactionManager();
        jtaTM.setUserTransaction(userTransaction);  // ç”¨æˆ·äº‹åŠ¡æ¥å£
        jtaTM.setTransactionManager(transactionManager);  // äº‹åŠ¡ç®¡ç†å™¨
        return jtaTM;
    }
}
```

> ğŸ’¡ **å®ç”¨æŠ€å·§**  
> JtaTransactionManageréœ€è¦ä¸¤ä¸ªæ ¸å¿ƒå‚æ•°ï¼šUserTransactionç”¨äºæ§åˆ¶äº‹åŠ¡ï¼ŒTransactionManagerç”¨äºåè°ƒèµ„æºã€‚è¿™ä¸¤ä¸ªå¯¹è±¡ç”±å…·ä½“çš„JTAå®ç°æ¡†æ¶ï¼ˆå¦‚Atomikosï¼‰æä¾›ã€‚

### 3.3 é…ç½®å±æ€§è¯¦è§£


| é…ç½®é¡¹ | **è¯´æ˜** | **é»˜è®¤å€¼** | **æ¨èè®¾ç½®** |
|-------|---------|-----------|-------------|
| `transactionTimeout` | äº‹åŠ¡è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ | -1ï¼ˆä¸é™åˆ¶ï¼‰ | 30-300ç§’ |
| `allowCustomIsolationLevels` | æ˜¯å¦å…è®¸è‡ªå®šä¹‰éš”ç¦»çº§åˆ« | false | trueï¼ˆçµæ´»æ€§ï¼‰ |
| `autodetectUserTransaction` | è‡ªåŠ¨æ£€æµ‹UserTransaction | true | true |
| `autodetectTransactionManager` | è‡ªåŠ¨æ£€æµ‹TransactionManager | true | true |

**è¶…æ—¶é…ç½®ç¤ºä¾‹**ï¼š

```java
@Bean
public JtaTransactionManager transactionManager() {
    JtaTransactionManager tm = new JtaTransactionManager();
    tm.setDefaultTimeout(60);  // é»˜è®¤60ç§’è¶…æ—¶
    tm.setAllowCustomIsolationLevels(true);  // å…è®¸è®¾ç½®éš”ç¦»çº§åˆ«
    return tm;
}
```

---

## 4. ğŸš€ ä¸‰å¤§ä¸»æµJTAå®ç°æ–¹æ¡ˆ


### 4.1 Atomikosé…ç½®ï¼ˆæœ€æµè¡Œï¼‰


**Atomikosç®€ä»‹**ï¼š
- å¼€æºçš„JTAå®ç°æ¡†æ¶
- è½»é‡çº§ï¼Œæ˜“äºé›†æˆ
- Spring Bootå®˜æ–¹æ¨èæ–¹æ¡ˆ

**ğŸŒ± å¿«é€Ÿä¸Šæ‰‹é…ç½®**ï¼š

**Step 1ï¼šæ·»åŠ ä¾èµ–**
```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-jta-atomikos</artifactId>
</dependency>
```

**Step 2ï¼šé…ç½®æ–‡ä»¶**
```yaml
# application.yml
spring:
  jta:
    atomikos:
      properties:
        # äº‹åŠ¡æ—¥å¿—ç›®å½•ï¼ˆé‡è¦ï¼ç”¨äºå´©æºƒæ¢å¤ï¼‰
        log-base-dir: ./atomikos-logs
        # äº‹åŠ¡è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
        default-jta-timeout: 60000
        # æœ€å¤§æ´»è·ƒäº‹åŠ¡æ•°
        max-actives: 50
```

**Step 3ï¼šé…ç½®XAæ•°æ®æº**
```java
@Configuration
public class AtomikosDataSourceConfig {
    
    // é…ç½®ç¬¬ä¸€ä¸ªXAæ•°æ®æº
    @Bean("orderDataSource")
    public DataSource orderDataSource() {
        AtomikosDataSourceBean ds = new AtomikosDataSourceBean();
        ds.setUniqueResourceName("orderDS");  // å”¯ä¸€æ ‡è¯†
        ds.setXaDataSourceClassName("com.mysql.cj.jdbc.MysqlXADataSource");
        
        Properties props = new Properties();
        props.setProperty("url", "jdbc:mysql://localhost:3306/order_db");
        props.setProperty("user", "root");
        props.setProperty("password", "123456");
        ds.setXaProperties(props);
        
        return ds;
    }
    
    // é…ç½®ç¬¬äºŒä¸ªXAæ•°æ®æº
    @Bean("productDataSource")
    public DataSource productDataSource() {
        AtomikosDataSourceBean ds = new AtomikosDataSourceBean();
        ds.setUniqueResourceName("productDS");
        ds.setXaDataSourceClassName("com.mysql.cj.jdbc.MysqlXADataSource");
        
        Properties props = new Properties();
        props.setProperty("url", "jdbc:mysql://localhost:3306/product_db");
        props.setProperty("user", "root");
        props.setProperty("password", "123456");
        ds.setXaProperties(props);
        
        return ds;
    }
}
```

> ğŸ“Œ **æ ¸å¿ƒæ¦‚å¿µ**  
> `uniqueResourceName`æ˜¯XAæ•°æ®æºçš„å”¯ä¸€æ ‡è¯†ï¼ŒAtomikosé€šè¿‡å®ƒæ¥åŒºåˆ†ä¸åŒçš„æ•°æ®åº“ã€‚æ¯ä¸ªæ•°æ®æºå¿…é¡»æœ‰ä¸åŒçš„åå­—ï¼Œå°±åƒæ¯ä¸ªäººéƒ½æœ‰èº«ä»½è¯å·ä¸€æ ·ã€‚

**Atomikosä¼˜åŠ¿**ï¼š
- âœ… é…ç½®ç®€å•ï¼ŒSpring Bootæ— ç¼é›†æˆ
- âœ… æ€§èƒ½è¾ƒå¥½ï¼Œé€‚åˆä¸­å°è§„æ¨¡åº”ç”¨
- âœ… ç¤¾åŒºæ´»è·ƒï¼Œæ–‡æ¡£é½å…¨

### 4.2 Bitronixé…ç½®ï¼ˆä¼ä¸šçº§ï¼‰


**Bitronixç®€ä»‹**ï¼š
- ä¸“ä¸šçš„å•†ä¸šçº§JTAå®ç°
- æä¾›æ›´å¼ºçš„äº‹åŠ¡æ¢å¤èƒ½åŠ›
- é€‚åˆå¯¹å¯é æ€§è¦æ±‚é«˜çš„åœºæ™¯

**é…ç½®è¦ç‚¹**ï¼š

```java
@Configuration
public class BitronixConfig {
    
    @Bean
    public bitronix.tm.BitronixTransactionManager bitronixTransactionManager() {
        bitronix.tm.Configuration conf = bitronix.tm.TransactionManagerServices.getConfiguration();
        
        // äº‹åŠ¡æ—¥å¿—é…ç½®
        conf.setLogPart1Filename("./bitronix-logs/part1.btm");
        conf.setLogPart2Filename("./bitronix-logs/part2.btm");
        
        // äº‹åŠ¡è¶…æ—¶é…ç½®
        conf.setDefaultTransactionTimeout(60);
        
        return bitronix.tm.TransactionManagerServices.getTransactionManager();
    }
    
    // XAæ•°æ®æºé…ç½®
    @Bean
    public PoolingDataSource bitronixDataSource() {
        PoolingDataSource ds = new PoolingDataSource();
        ds.setUniqueName("bitronixDS");
        ds.setClassName("com.mysql.cj.jdbc.MysqlXADataSource");
        
        ds.getDriverProperties().setProperty("url", 
            "jdbc:mysql://localhost:3306/mydb");
        ds.getDriverProperties().setProperty("user", "root");
        
        // è¿æ¥æ± é…ç½®
        ds.setMinPoolSize(5);
        ds.setMaxPoolSize(20);
        
        return ds;
    }
}
```

**Bitronixç‰¹ç‚¹**ï¼š
- ğŸ”’ æ›´å¼ºçš„æ•…éšœæ¢å¤æœºåˆ¶
- ğŸ“Š è¯¦ç»†çš„äº‹åŠ¡ç›‘æ§èƒ½åŠ›
- ğŸ¢ é€‚åˆå¤§å‹ä¼ä¸šåº”ç”¨

### 4.3 Narayanaé…ç½®ï¼ˆJBosså®˜æ–¹ï¼‰


**Narayanaç®€ä»‹**ï¼š
- Red Hat/JBosså®˜æ–¹JTAå®ç°
- åŠŸèƒ½æœ€å®Œæ•´ï¼Œæ”¯æŒå¤šç§åè®®
- é€‚åˆå¾®æœåŠ¡æ¶æ„

**åŸºæœ¬é…ç½®**ï¼š

```java
@Configuration
public class NarayanaConfig {
    
    @Bean
    public com.arjuna.ats.jta.UserTransaction narayanaUserTransaction() {
        return com.arjuna.ats.jta.UserTransaction.userTransaction();
    }
    
    @Bean
    public com.arjuna.ats.jta.TransactionManager narayanaTransactionManager() {
        return com.arjuna.ats.jta.TransactionManager.transactionManager();
    }
    
    @Bean
    public JtaTransactionManager transactionManager(
            UserTransaction userTransaction,
            TransactionManager transactionManager) {
        
        JtaTransactionManager tm = new JtaTransactionManager();
        tm.setUserTransaction((jakarta.transaction.UserTransaction)userTransaction);
        tm.setTransactionManager((jakarta.transaction.TransactionManager)transactionManager);
        return tm;
    }
}
```

**Narayanaç‰¹è‰²**ï¼š
- ğŸŒ æ”¯æŒåˆ†å¸ƒå¼å¾®æœåŠ¡äº‹åŠ¡
- ğŸ”„ å…¼å®¹å¤šç§äº‹åŠ¡åè®®
- ğŸ¯ é€‚åˆäº‘åŸç”Ÿæ¶æ„

### 4.4 ä¸‰å¤§æ¡†æ¶å¯¹æ¯”


| ğŸ†š æ¡†æ¶ | **æ˜“ç”¨æ€§** | **æ€§èƒ½** | **åŠŸèƒ½** | **é€‚ç”¨åœºæ™¯** |
|---------|----------|---------|---------|-------------|
| **Atomikos** | â­â­â­â­â­ | â­â­â­â­ | â­â­â­ | ä¸­å°å‹åº”ç”¨ï¼Œå¿«é€Ÿå¼€å‘ |
| **Bitronix** | â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | ä¼ä¸šçº§åº”ç”¨ï¼Œé«˜å¯é æ€§ |
| **Narayana** | â­â­â­ | â­â­â­â­ | â­â­â­â­â­ | å¾®æœåŠ¡æ¶æ„ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿ |

> ğŸ’¡ **é€‰æ‹©å»ºè®®**  
> - æ–°æ‰‹å…¥é—¨ï¼šé€‰æ‹©Atomikosï¼Œé…ç½®æœ€ç®€å•
> - ä¼ä¸šé¡¹ç›®ï¼šé€‰æ‹©Bitronixï¼Œç¨³å®šæ€§æœ€å¥½
> - å¾®æœåŠ¡ï¼šé€‰æ‹©Narayanaï¼ŒåŠŸèƒ½æœ€å¼ºå¤§

---

## 5. ğŸ’¾ XAæ•°æ®æºé…ç½®å®æˆ˜


### 5.1 ä»€ä¹ˆæ˜¯XAæ•°æ®æº


**é€šä¿—è§£é‡Š**ï¼š
- æ™®é€šæ•°æ®æº = åªèƒ½è‡ªå·±ç®¡è‡ªå·±çš„äº‹åŠ¡
- XAæ•°æ®æº = å¯ä»¥è¢«"æ€»ç®¡"ç»Ÿä¸€ç®¡ç†çš„æ•°æ®æº

**XAåè®®ä½œç”¨**ï¼š
```
XA = eXtended Architectureï¼ˆæ‰©å±•æ¶æ„ï¼‰
ç›®çš„ï¼šè®©ä¸åŒå‚å•†çš„æ•°æ®åº“éƒ½èƒ½å‚ä¸åˆ†å¸ƒå¼äº‹åŠ¡
åŸç†ï¼šç»Ÿä¸€çš„æ¥å£æ ‡å‡†ï¼Œç±»ä¼¼USBæ¥å£
```

### 5.2 ä¸»æµæ•°æ®åº“çš„XAæ”¯æŒ


**MySQL XAé…ç½®**ï¼š

```java
@Bean
public DataSource mysqlXADataSource() {
    // ä½¿ç”¨MySQLä¸“ç”¨çš„XAæ•°æ®æºç±»
    MysqlXADataSource xaDataSource = new MysqlXADataSource();
    xaDataSource.setUrl("jdbc:mysql://localhost:3306/mydb");
    xaDataSource.setUser("root");
    xaDataSource.setPassword("123456");
    
    // åŒ…è£…ä¸ºAtomikosæ•°æ®æº
    AtomikosDataSourceBean atomikosDS = new AtomikosDataSourceBean();
    atomikosDS.setXaDataSource(xaDataSource);
    atomikosDS.setUniqueResourceName("mysqlXA");
    
    return atomikosDS;
}
```

**PostgreSQL XAé…ç½®**ï¼š

```java
@Bean
public DataSource postgresXADataSource() {
    PGXADataSource xaDataSource = new PGXADataSource();
    xaDataSource.setUrl("jdbc:postgresql://localhost:5432/mydb");
    xaDataSource.setUser("postgres");
    xaDataSource.setPassword("123456");
    
    AtomikosDataSourceBean atomikosDS = new AtomikosDataSourceBean();
    atomikosDS.setXaDataSource(xaDataSource);
    atomikosDS.setUniqueResourceName("pgXA");
    
    return atomikosDS;
}
```

**Oracle XAé…ç½®**ï¼š

```java
@Bean
public DataSource oracleXADataSource() {
    OracleXADataSource xaDataSource = new OracleXADataSource();
    xaDataSource.setURL("jdbc:oracle:thin:@localhost:1521:orcl");
    xaDataSource.setUser("system");
    xaDataSource.setPassword("oracle");
    
    AtomikosDataSourceBean atomikosDS = new AtomikosDataSourceBean();
    atomikosDS.setXaDataSource(xaDataSource);
    atomikosDS.setUniqueResourceName("oracleXA");
    
    return atomikosDS;
}
```

> âš ï¸ **æ•°æ®åº“ç‰ˆæœ¬è¦æ±‚**  
> - MySQL 5.7+ï¼šå®Œæ•´æ”¯æŒXAäº‹åŠ¡
> - PostgreSQL 9.0+ï¼šæ”¯æŒXAåè®®
> - Oracle 10g+ï¼šåŸç”Ÿæ”¯æŒåˆ†å¸ƒå¼äº‹åŠ¡
> - SQL Server 2005+ï¼šæ”¯æŒDTCåˆ†å¸ƒå¼äº‹åŠ¡

### 5.3 XAæ•°æ®æºè¿æ¥æ± é…ç½®


**è¿æ¥æ± å‚æ•°ä¼˜åŒ–**ï¼š

```java
@Bean
public DataSource optimizedXADataSource() {
    AtomikosDataSourceBean ds = new AtomikosDataSourceBean();
    ds.setUniqueResourceName("optimizedDS");
    ds.setXaDataSourceClassName("com.mysql.cj.jdbc.MysqlXADataSource");
    
    // XAæ•°æ®æºå±æ€§
    Properties xaProps = new Properties();
    xaProps.setProperty("url", "jdbc:mysql://localhost:3306/db");
    xaProps.setProperty("user", "root");
    xaProps.setProperty("password", "123456");
    ds.setXaProperties(xaProps);
    
    // è¿æ¥æ± é…ç½®ï¼ˆé‡è¦æ€§èƒ½å‚æ•°ï¼‰
    ds.setMinPoolSize(5);          // æœ€å°è¿æ¥æ•°
    ds.setMaxPoolSize(20);         // æœ€å¤§è¿æ¥æ•°
    ds.setMaxIdleTime(60);         // æœ€å¤§ç©ºé—²æ—¶é—´ï¼ˆç§’ï¼‰
    ds.setBorrowConnectionTimeout(30);  // è·å–è¿æ¥è¶…æ—¶ï¼ˆç§’ï¼‰
    ds.setTestQuery("SELECT 1");   // è¿æ¥æµ‹è¯•æŸ¥è¯¢
    
    return ds;
}
```

**è¿æ¥æ± å‚æ•°å»ºè®®**ï¼š

| å‚æ•° | **è¯´æ˜** | **æ¨èå€¼** |
|------|---------|-----------|
| `minPoolSize` | æœ€å°è¿æ¥æ•° | 5-10 |
| `maxPoolSize` | æœ€å¤§è¿æ¥æ•° | æ ¹æ®å¹¶å‘é‡ï¼Œä¸€èˆ¬20-50 |
| `maxIdleTime` | ç©ºé—²è¿æ¥ä¿æŒæ—¶é—´ | 60ç§’ |
| `borrowConnectionTimeout` | è·å–è¿æ¥è¶…æ—¶ | 30ç§’ |
| `testQuery` | è¿æ¥æœ‰æ•ˆæ€§æ£€æµ‹SQL | SELECT 1 |

### 5.4 å¤šæ•°æ®æºåŠ¨æ€é…ç½®


**é…ç½®æ–‡ä»¶æ–¹å¼**ï¼š

```yaml
# application.yml
spring:
  jta:
    atomikos:
      datasource:
        order:
          unique-resource-name: orderDS
          xa-data-source-class-name: com.mysql.cj.jdbc.MysqlXADataSource
          xa-properties:
            url: jdbc:mysql://localhost:3306/order_db
            user: root
            password: 123456
          min-pool-size: 5
          max-pool-size: 20
        
        product:
          unique-resource-name: productDS
          xa-data-source-class-name: com.mysql.cj.jdbc.MysqlXADataSource
          xa-properties:
            url: jdbc:mysql://localhost:3306/product_db
            user: root
            password: 123456
          min-pool-size: 5
          max-pool-size: 20
```

---

## 6. ğŸ¯ å…¨å±€äº‹åŠ¡ç®¡ç†æœºåˆ¶


### 6.1 å…¨å±€äº‹åŠ¡çš„æ¦‚å¿µ


**é€šä¿—ç†è§£**ï¼š
```
æœ¬åœ°äº‹åŠ¡ = ä¸€ä¸ªäººç®¡ä¸€ä¸ªè´¦æœ¬
å…¨å±€äº‹åŠ¡ = æ€»è´¦æˆ¿ç®¡ç†æ‰€æœ‰è´¦æœ¬

ç¤ºä¾‹åœºæ™¯ï¼š
è½¬è´¦æ“ä½œï¼š
- Aé“¶è¡Œæ‰£æ¬¾ï¼ˆæœ¬åœ°äº‹åŠ¡1ï¼‰
- Bé“¶è¡Œå…¥è´¦ï¼ˆæœ¬åœ°äº‹åŠ¡2ï¼‰
- å…¨å±€äº‹åŠ¡ = ç¡®ä¿ä¸¤ä¸ªæœ¬åœ°äº‹åŠ¡è¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥
```

**å…¨å±€äº‹åŠ¡IDï¼ˆXIDï¼‰**ï¼š
- æ¯ä¸ªå…¨å±€äº‹åŠ¡æœ‰å”¯ä¸€æ ‡è¯†
- æ ¼å¼ï¼š`å…¨å±€äº‹åŠ¡ID.åˆ†æ”¯äº‹åŠ¡ID.èµ„æºæ ‡è¯†`
- ç”¨äºè·Ÿè¸ªå’Œæ¢å¤äº‹åŠ¡

### 6.2 å…¨å±€äº‹åŠ¡çš„ä½¿ç”¨æ–¹å¼


**æ–¹å¼ä¸€ï¼šå£°æ˜å¼äº‹åŠ¡ï¼ˆæ¨èï¼‰**

```java
@Service
public class OrderService {
    
    @Autowired
    private OrderMapper orderMapper;
    
    @Autowired
    private ProductMapper productMapper;
    
    // ä½¿ç”¨@Transactionalæ³¨è§£ï¼Œè‡ªåŠ¨ç®¡ç†å…¨å±€äº‹åŠ¡
    @Transactional
    public void createOrder(Order order) {
        // æ“ä½œ1ï¼šè®¢å•åº“æ’å…¥è®¢å•
        orderMapper.insert(order);
        
        // æ“ä½œ2ï¼šå•†å“åº“å‡åº“å­˜
        productMapper.decreaseStock(order.getProductId(), order.getQuantity());
        
        // å¦‚æœä»»ä½•æ“ä½œå¤±è´¥ï¼Œä¸¤ä¸ªæ•°æ®åº“éƒ½ä¼šå›æ»š
    }
}
```

**æ–¹å¼äºŒï¼šç¼–ç¨‹å¼äº‹åŠ¡ï¼ˆçµæ´»æ§åˆ¶ï¼‰**

```java
@Service
public class OrderService {
    
    @Autowired
    private JtaTransactionManager transactionManager;
    
    public void createOrderProgrammatic(Order order) {
        // æ‰‹åŠ¨å¼€å¯äº‹åŠ¡
        TransactionStatus status = transactionManager.getTransaction(
            new DefaultTransactionDefinition());
        
        try {
            // æ‰§è¡Œä¸šåŠ¡æ“ä½œ
            orderMapper.insert(order);
            productMapper.decreaseStock(order.getProductId(), order.getQuantity());
            
            // æ‰‹åŠ¨æäº¤
            transactionManager.commit(status);
            
        } catch (Exception e) {
            // æ‰‹åŠ¨å›æ»š
            transactionManager.rollback(status);
            throw e;
        }
    }
}
```

> ğŸ’¡ **ä½¿ç”¨å»ºè®®**  
> - ç®€å•åœºæ™¯ï¼šç”¨å£°æ˜å¼äº‹åŠ¡ï¼Œä»£ç ç®€æ´
> - å¤æ‚åœºæ™¯ï¼šç”¨ç¼–ç¨‹å¼äº‹åŠ¡ï¼Œæ§åˆ¶æ›´ç²¾ç»†

### 6.3 å…¨å±€äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º


**äº‹åŠ¡ä¼ æ’­åœºæ™¯**ï¼š

```java
@Service
public class OrderService {
    
    @Transactional
    public void createOrder() {
        // ä¸»äº‹åŠ¡
        orderMapper.insert(order);
        
        // è°ƒç”¨å¦ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•
        logService.saveLog();  // è¿™ä¸ªæ–¹æ³•ä¹Ÿæœ‰@Transactional
    }
}

@Service
public class LogService {
    
    @Transactional(propagation = Propagation.REQUIRES_NEW)
    public void saveLog() {
        // å­äº‹åŠ¡ï¼ˆç‹¬ç«‹çš„å…¨å±€äº‹åŠ¡ï¼‰
        logMapper.insert(log);
    }
}
```

**ä¼ æ’­è¡Œä¸ºå¯¹æ¯”**ï¼š

| ä¼ æ’­ç±»å‹ | **è¯´æ˜** | **ä½¿ç”¨åœºæ™¯** |
|---------|---------|-------------|
| `REQUIRED` | åŠ å…¥ç°æœ‰äº‹åŠ¡ï¼Œæ— åˆ™æ–°å»º | é»˜è®¤é€‰æ‹©ï¼Œå¤§éƒ¨åˆ†åœºæ™¯ |
| `REQUIRES_NEW` | æ€»æ˜¯æ–°å»ºç‹¬ç«‹äº‹åŠ¡ | æ—¥å¿—è®°å½•ï¼Œä¸å—ä¸»äº‹åŠ¡å½±å“ |
| `NESTED` | åµŒå¥—äº‹åŠ¡ï¼Œå¯ç‹¬ç«‹å›æ»š | éƒ¨åˆ†æ“ä½œå¯é€‰å¤±è´¥ |
| `SUPPORTS` | æœ‰äº‹åŠ¡å°±ç”¨ï¼Œæ— äº‹åŠ¡å°±ç®— | æŸ¥è¯¢æ“ä½œ |

### 6.4 å…¨å±€äº‹åŠ¡ç›‘æ§ä¸è°ƒè¯•


**å¼€å¯äº‹åŠ¡æ—¥å¿—**ï¼š

```yaml
# application.yml
logging:
  level:
    com.atomikos: DEBUG  # Atomikosæ—¥å¿—
    org.springframework.transaction: DEBUG  # Springäº‹åŠ¡æ—¥å¿—
    
spring:
  jta:
    atomikos:
      properties:
        # è¯¦ç»†æ—¥å¿—è¾“å‡º
        com.atomikos.icatch.output_dir: ./atomikos-logs
        com.atomikos.icatch.log_base_name: atomikos-tx
```

**äº‹åŠ¡çŠ¶æ€æ£€æŸ¥**ï¼š

```java
@Service
public class TransactionMonitor {
    
    @Autowired
    private JtaTransactionManager transactionManager;
    
    public void checkTransactionStatus() {
        TransactionStatus status = transactionManager.getTransaction(
            new DefaultTransactionDefinition());
        
        // æ£€æŸ¥äº‹åŠ¡çŠ¶æ€
        System.out.println("æ˜¯å¦æ–°äº‹åŠ¡: " + status.isNewTransaction());
        System.out.println("æ˜¯å¦å·²å®Œæˆ: " + status.isCompleted());
        System.out.println("æ˜¯å¦å›æ»š: " + status.isRollbackOnly());
    }
}
```

**å¸¸è§é—®é¢˜æ’æŸ¥**ï¼š

| é—®é¢˜ç°è±¡ | **å¯èƒ½åŸå› ** | **è§£å†³æ–¹æ¡ˆ** |
|---------|------------|-------------|
| äº‹åŠ¡ä¸ç”Ÿæ•ˆ | æ–¹æ³•æœªè¢«ä»£ç† | æ£€æŸ¥@Transactionalæ˜¯å¦åœ¨publicæ–¹æ³•ä¸Š |
| äº‹åŠ¡æäº¤å¤±è´¥ | æ•°æ®åº“ä¸æ”¯æŒXA | ç¡®è®¤æ•°æ®åº“ç‰ˆæœ¬å’ŒXAé…ç½® |
| äº‹åŠ¡è¶…æ—¶ | é»˜è®¤è¶…æ—¶æ—¶é—´å¤ªçŸ­ | å¢åŠ transactionTimeoutè®¾ç½® |
| æ—¥å¿—æ–‡ä»¶è†¨èƒ€ | äº‹åŠ¡æ—¥å¿—æœªæ¸…ç† | é…ç½®æ—¥å¿—æ¸…ç†ç­–ç•¥ |

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ JTAè§„èŒƒï¼šJavaå®˜æ–¹å®šä¹‰çš„åˆ†å¸ƒå¼äº‹åŠ¡APIæ ‡å‡†
ğŸ”¸ ä¸¤é˜¶æ®µæäº¤ï¼šå‡†å¤‡é˜¶æ®µ+æäº¤é˜¶æ®µï¼Œç¡®ä¿å…¨å±€ä¸€è‡´æ€§
ğŸ”¸ XAæ•°æ®æºï¼šæ”¯æŒåˆ†å¸ƒå¼äº‹åŠ¡çš„ç‰¹æ®Šæ•°æ®æº
ğŸ”¸ JtaTransactionManagerï¼šSpringä¸­ç®¡ç†JTAäº‹åŠ¡çš„æ ¸å¿ƒç»„ä»¶
ğŸ”¸ å…¨å±€äº‹åŠ¡ï¼šè·¨å¤šä¸ªæ•°æ®æºçš„ç»Ÿä¸€äº‹åŠ¡æ§åˆ¶
```

### 7.2 ä¸‰å¤§JTAå®ç°æ¡†æ¶å¯¹æ¯”


| æ¡†æ¶ | **ä¼˜åŠ¿** | **åŠ£åŠ¿** | **æœ€ä½³åœºæ™¯** |
|------|---------|---------|-------------|
| **Atomikos** | é…ç½®ç®€å•ï¼ŒSpring Booté›†æˆå¥½ | åŠŸèƒ½ç›¸å¯¹åŸºç¡€ | ä¸­å°å‹åº”ç”¨ï¼Œå¿«é€Ÿå¼€å‘ |
| **Bitronix** | ç¨³å®šæ€§å¼ºï¼Œæ¢å¤èƒ½åŠ›å¥½ | é…ç½®å¤æ‚ | ä¼ä¸šçº§åº”ç”¨ |
| **Narayana** | åŠŸèƒ½å¼ºå¤§ï¼Œæ”¯æŒå¾®æœåŠ¡ | å­¦ä¹ æ›²çº¿é™¡ | åˆ†å¸ƒå¼ç³»ç»Ÿ |

### 7.3 é…ç½®å…³é”®ç‚¹


> ğŸ“Œ **é…ç½®æ£€æŸ¥æ¸…å•**  
> âœ… æ¯ä¸ªXAæ•°æ®æºå¿…é¡»æœ‰å”¯ä¸€çš„resourceName  
> âœ… äº‹åŠ¡æ—¥å¿—ç›®å½•å¿…é¡»å¯å†™ä¸”æœ‰è¶³å¤Ÿç©ºé—´  
> âœ… äº‹åŠ¡è¶…æ—¶æ—¶é—´è¦æ ¹æ®ä¸šåŠ¡è°ƒæ•´  
> âœ… è¿æ¥æ± å‚æ•°è¦æ ¹æ®å¹¶å‘é‡ä¼˜åŒ–  
> âœ… æ•°æ®åº“å¿…é¡»æ”¯æŒXAåè®®

### 7.4 å®é™…åº”ç”¨å»ºè®®


**ğŸŒ± å…¥é—¨é˜¶æ®µ**ï¼š
1. å…ˆç”¨Atomikosï¼Œé…ç½®æœ€ç®€å•
2. ä»å•åº“äº‹åŠ¡è¿‡æ¸¡åˆ°å¤šåº“äº‹åŠ¡
3. ç†è§£ä¸¤é˜¶æ®µæäº¤çš„åŸç†

**ğŸŒ¿ è¿›é˜¶é˜¶æ®µ**ï¼š
1. å­¦ä¹ äº‹åŠ¡ä¼ æ’­è¡Œä¸ºçš„æ§åˆ¶
2. ä¼˜åŒ–è¿æ¥æ± å’Œè¶…æ—¶å‚æ•°
3. æŒæ¡äº‹åŠ¡ç›‘æ§å’Œè°ƒè¯•æ–¹æ³•

**ğŸŒ³ é«˜çº§åº”ç”¨**ï¼š
1. æ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚çš„JTAå®ç°
2. å¤„ç†åˆ†å¸ƒå¼äº‹åŠ¡çš„å¼‚å¸¸æƒ…å†µ
3. åœ¨å¾®æœåŠ¡æ¶æ„ä¸­åº”ç”¨åˆ†å¸ƒå¼äº‹åŠ¡

### 7.5 æ€§èƒ½ä¼˜åŒ–è¦ç‚¹


```
âš¡ æ€§èƒ½æç¤ºï¼š
- é¿å…é•¿äº‹åŠ¡ï¼šå°½å¿«æäº¤ï¼Œå‡å°‘é”å®šæ—¶é—´
- åˆç†è®¾ç½®è¶…æ—¶ï¼šé˜²æ­¢äº‹åŠ¡é•¿æ—¶é—´å ç”¨èµ„æº
- ä¼˜åŒ–è¿æ¥æ± ï¼šæ ¹æ®å¹¶å‘é‡è°ƒæ•´æ± å¤§å°
- ç›‘æ§æ—¥å¿—æ–‡ä»¶ï¼šå®šæœŸæ¸…ç†äº‹åŠ¡æ—¥å¿—

ğŸ”’ å®‰å…¨å»ºè®®ï¼š
- äº‹åŠ¡æ—¥å¿—åŠ å¯†å­˜å‚¨
- å®šæœŸå¤‡ä»½äº‹åŠ¡æ—¥å¿—
- ç›‘æ§å¼‚å¸¸äº‹åŠ¡æ¨¡å¼
```

### 7.6 å¸¸è§è¯¯åŒº


> âš ï¸ **é¿å…è¿™äº›é”™è¯¯**  
> âŒ è¯¯åŒº1ï¼šä»¥ä¸ºJTAä¼šè‡ªåŠ¨æé«˜æ€§èƒ½ï¼ˆå®é™…ä¼šé™ä½ï¼‰  
> âŒ è¯¯åŒº2ï¼šåœ¨å°é¡¹ç›®ä¸­æ»¥ç”¨åˆ†å¸ƒå¼äº‹åŠ¡  
> âŒ è¯¯åŒº3ï¼šå¿½ç•¥æ•°æ®åº“çš„XAæ”¯æŒæ£€æŸ¥  
> âŒ è¯¯åŒº4ï¼šä¸é…ç½®äº‹åŠ¡è¶…æ—¶ï¼Œå¯¼è‡´èµ„æºæ³„æ¼

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
JTAç®¡ç†å¤šæ•°æ®æºï¼ŒXAåè®®æ˜¯åŸºç¡€
ä¸¤é˜¶æ®µæäº¤ä¿ä¸€è‡´ï¼Œäº‹åŠ¡æ—¥å¿—è¦å…³æ³¨
Atomikosæœ€ç®€å•ï¼ŒBitronixæœ€ç¨³å®š
NarayanaåŠŸèƒ½å…¨ï¼ŒæŒ‰éœ€é€‰æ‹©æœ€åˆé€‚
```

---

## ğŸ“ å­¦ä¹ å»ºè®®


**ğŸ“š å­¦ä¹ è·¯çº¿**ï¼š
1. **ç¬¬1å‘¨**ï¼šç†è§£JTAåŸºæœ¬æ¦‚å¿µå’Œä¸¤é˜¶æ®µæäº¤
2. **ç¬¬2å‘¨**ï¼šæŒæ¡Atomikosçš„é…ç½®å’Œä½¿ç”¨
3. **ç¬¬3å‘¨**ï¼šå­¦ä¹ XAæ•°æ®æºé…ç½®å’Œè°ƒè¯•
4. **ç¬¬4å‘¨**ï¼šå®æˆ˜é¡¹ç›®åº”ç”¨å’Œæ€§èƒ½ä¼˜åŒ–

**ğŸ” æ‰©å±•èµ„æº**ï¼š
- JTAå®˜æ–¹è§„èŒƒï¼šJSR 907
- Atomikoså®˜æ–¹æ–‡æ¡£ï¼šatomikos.com
- Springåˆ†å¸ƒå¼äº‹åŠ¡æŒ‡å—ï¼šspring.io/guides

**ğŸ’¼ å®æˆ˜ç»ƒä¹ **ï¼š
- [ ] é…ç½®ä¸€ä¸ªAtomikoså¤šæ•°æ®æºé¡¹ç›®
- [ ] å®ç°è·¨åº“è½¬è´¦åœºæ™¯
- [ ] æ¨¡æ‹Ÿåˆ†å¸ƒå¼äº‹åŠ¡å›æ»š
- [ ] ç›‘æ§å’Œåˆ†æäº‹åŠ¡æ—¥å¿—