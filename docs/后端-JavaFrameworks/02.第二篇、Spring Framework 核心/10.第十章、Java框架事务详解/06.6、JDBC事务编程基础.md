---
title: 6ã€JDBCäº‹åŠ¡ç¼–ç¨‹åŸºç¡€
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯JDBCäº‹åŠ¡](#1-ä»€ä¹ˆæ˜¯JDBCäº‹åŠ¡)
2. [äº‹åŠ¡æ§åˆ¶çš„ä¸‰å¤§æ ¸å¿ƒæ–¹æ³•](#2-äº‹åŠ¡æ§åˆ¶çš„ä¸‰å¤§æ ¸å¿ƒæ–¹æ³•)
3. [JDBCç¼–ç¨‹å¼äº‹åŠ¡å®æˆ˜](#3-JDBCç¼–ç¨‹å¼äº‹åŠ¡å®æˆ˜)
4. [èµ„æºç®¡ç†æœ€ä½³å®è·µ](#4-èµ„æºç®¡ç†æœ€ä½³å®è·µ)
5. [å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ](#5-å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ä»€ä¹ˆæ˜¯JDBCäº‹åŠ¡


### 1.1 é€šä¿—ç†è§£äº‹åŠ¡


ğŸŒ° **ç”Ÿæ´»åœºæ™¯ç±»æ¯”**
```
æƒ³è±¡ä½ å»é“¶è¡Œè½¬è´¦ï¼š
1. ä»ä½ çš„è´¦æˆ·æ‰£æ¬¾1000å…ƒ
2. ç»™å¯¹æ–¹è´¦æˆ·åŠ 1000å…ƒ

è¿™ä¸¤æ­¥å¿…é¡»"è¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥"
- âœ… éƒ½æˆåŠŸï¼šè½¬è´¦å®Œæˆ
- âŒ ä»»ä½•ä¸€æ­¥å¤±è´¥ï¼šå…¨éƒ¨æ’¤é”€ï¼Œé’±è¿˜åœ¨ä½ è´¦æˆ·é‡Œ
```

**è¿™å°±æ˜¯äº‹åŠ¡çš„æœ¬è´¨**ï¼šæŠŠå¤šä¸ªæ“ä½œç»‘å®šæˆä¸€ä¸ªæ•´ä½“ï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§ã€‚

### 1.2 JDBCä¸­çš„äº‹åŠ¡æ˜¯ä»€ä¹ˆ


**ğŸ“‹ æ ¸å¿ƒæ¦‚å¿µ**
- **JDBCäº‹åŠ¡**ï¼šé€šè¿‡Javaä»£ç æ§åˆ¶æ•°æ®åº“çš„äº‹åŠ¡è¡Œä¸º
- **é»˜è®¤è¡Œä¸º**ï¼šæ¯æ¡SQLè¯­å¥æ‰§è¡Œåè‡ªåŠ¨æäº¤ï¼ˆAuto-Commitï¼‰
- **æ‰‹åŠ¨æ§åˆ¶**ï¼šå…³é—­è‡ªåŠ¨æäº¤ï¼Œæ‰‹åŠ¨å†³å®šä½•æ—¶æäº¤æˆ–å›æ»š

**ğŸ”¸ è‡ªåŠ¨æäº¤ vs æ‰‹åŠ¨æ§åˆ¶**
```
è‡ªåŠ¨æäº¤æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰ï¼š
æ‰§è¡ŒSQL1 â†’ ç«‹å³æäº¤ âœ“
æ‰§è¡ŒSQL2 â†’ ç«‹å³æäº¤ âœ“
é—®é¢˜ï¼šæ— æ³•ä¿è¯SQL1å’ŒSQL2çš„æ•´ä½“ä¸€è‡´æ€§

æ‰‹åŠ¨æ§åˆ¶æ¨¡å¼ï¼š
æ‰§è¡ŒSQL1 â†’ æš‚ä¸æäº¤
æ‰§è¡ŒSQL2 â†’ æš‚ä¸æäº¤  
å…¨éƒ¨æˆåŠŸ â†’ ä¸€èµ·æäº¤ âœ“
ä»»ä¸€å¤±è´¥ â†’ å…¨éƒ¨å›æ»š âœ—
```

### 1.3 ä¸ºä»€ä¹ˆéœ€è¦æ‰‹åŠ¨æ§åˆ¶äº‹åŠ¡


**âš ï¸ å®é™…ä¸šåŠ¡åœºæ™¯**

åœºæ™¯1ï¼šç”µå•†ä¸‹å•
```
1. æ‰£å‡åº“å­˜
2. åˆ›å»ºè®¢å•
3. æ‰£å‡ç”¨æˆ·ä½™é¢
4. å¢åŠ ç§¯åˆ†

è¿™4æ­¥å¿…é¡»åŒæ—¶æˆåŠŸæˆ–åŒæ—¶å¤±è´¥ï¼
```

åœºæ™¯2ï¼šé“¶è¡Œè½¬è´¦
```
1. Aè´¦æˆ· -1000å…ƒ
2. Bè´¦æˆ· +1000å…ƒ

å¦‚æœç¬¬1æ­¥æˆåŠŸï¼Œç¬¬2æ­¥å¤±è´¥ â†’ é’±å‡­ç©ºæ¶ˆå¤±äº†ï¼
å¿…é¡»ç”¨äº‹åŠ¡ä¿è¯åŸå­æ€§
```

> ğŸ’¡ **æ ¸å¿ƒç†è§£**  
> JDBCäº‹åŠ¡å°±æ˜¯ç»™ä½ ä¸€ä¸ª"åæ‚”è¯"ï¼Œè®©ä½ èƒ½å¤Ÿæ§åˆ¶å¤šä¸ªSQLæ“ä½œçš„æœ€ç»ˆç»“æœï¼šå…¨éƒ¨ç”Ÿæ•ˆæˆ–å…¨éƒ¨å–æ¶ˆã€‚

---

## 2. ğŸ”§ äº‹åŠ¡æ§åˆ¶çš„ä¸‰å¤§æ ¸å¿ƒæ–¹æ³•


### 2.1 setAutoCommit(false) - å…³é—­è‡ªåŠ¨æäº¤


**ğŸ”¸ æ–¹æ³•å®šä¹‰**
```java
connection.setAutoCommit(false);
```

**ğŸ“‹ ä½œç”¨è¯´æ˜**
- å…³é—­JDBCçš„è‡ªåŠ¨æäº¤æ¨¡å¼
- å¼€å¯æ‰‹åŠ¨äº‹åŠ¡æ§åˆ¶
- å¿…é¡»æ˜¯äº‹åŠ¡æ§åˆ¶çš„ç¬¬ä¸€æ­¥

**ğŸ’¡ é€šä¿—ç†è§£**
```
é»˜è®¤æƒ…å†µï¼šæ¯æ‰§è¡Œä¸€æ¡SQLï¼Œæ•°æ®åº“ç«‹å³ä¿å­˜ï¼ˆè‡ªåŠ¨æäº¤ï¼‰
å…³é—­åï¼šæ‰€æœ‰SQLæš‚æ—¶"ç¼“å­˜"ï¼Œç­‰ä½ è¯´"ç¡®è®¤"æ‰çœŸæ­£ä¿å­˜
```

**ğŸŒ° ç±»æ¯”è¯´æ˜**
```
å°±åƒç¼–è¾‘Wordæ–‡æ¡£ï¼š
- è‡ªåŠ¨æäº¤ï¼šæ¯æ‰“ä¸€ä¸ªå­—å°±è‡ªåŠ¨ä¿å­˜
- æ‰‹åŠ¨æ§åˆ¶ï¼šæ‰“å®Œä¸€æ®µè¯ï¼Œä½ ç‚¹"ä¿å­˜"æ‰çœŸæ­£ä¿å­˜
```

### 2.2 commit() - æäº¤äº‹åŠ¡


**ğŸ”¸ æ–¹æ³•å®šä¹‰**
```java
connection.commit();
```

**ğŸ“‹ ä½œç”¨è¯´æ˜**
- å°†æ‰€æœ‰SQLæ“ä½œæ°¸ä¹…ä¿å­˜åˆ°æ•°æ®åº“
- äº‹åŠ¡æˆåŠŸå®Œæˆçš„æ ‡å¿—
- æäº¤åæ•°æ®ä¸å¯å›æ»š

**ğŸ’¡ æ“ä½œæ—¶æœº**
- æ‰€æœ‰ä¸šåŠ¡SQLæ‰§è¡ŒæˆåŠŸå
- ç¡®è®¤æ•°æ®æ— è¯¯æ—¶
- åœ¨finallyå—ä¹‹å‰

**ğŸ”„ æ‰§è¡Œæµç¨‹**
```
å¼€å§‹äº‹åŠ¡
   â†“
æ‰§è¡ŒSQL1ï¼ˆæš‚å­˜ï¼‰
   â†“
æ‰§è¡ŒSQL2ï¼ˆæš‚å­˜ï¼‰
   â†“
æ‰§è¡ŒSQL3ï¼ˆæš‚å­˜ï¼‰
   â†“
commit() â† è¿™é‡Œæ‰çœŸæ­£å†™å…¥æ•°æ®åº“
   â†“
äº‹åŠ¡ç»“æŸ
```

### 2.3 rollback() - å›æ»šäº‹åŠ¡


**ğŸ”¸ æ–¹æ³•å®šä¹‰**
```java
connection.rollback();
```

**ğŸ“‹ ä½œç”¨è¯´æ˜**
- æ’¤é”€æ‰€æœ‰æœªæäº¤çš„SQLæ“ä½œ
- æ•°æ®æ¢å¤åˆ°äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€
- å¼‚å¸¸å¤„ç†çš„æ ¸å¿ƒæ“ä½œ

**ğŸ’¡ ä½¿ç”¨åœºæ™¯**
- æ•è·åˆ°å¼‚å¸¸æ—¶
- ä¸šåŠ¡é€»è¾‘æ ¡éªŒå¤±è´¥æ—¶
- éœ€è¦æ’¤é”€æ“ä½œæ—¶

**âš ï¸ é‡è¦ç‰¹æ€§**
```
å›æ»šåªèƒ½æ’¤é”€"æœªæäº¤"çš„æ“ä½œ
å·²ç»commit()çš„æ•°æ®æ— æ³•rollback()
```

### 2.4 ä¸‰å¤§æ–¹æ³•åä½œå…³ç³»


**ğŸ”„ æ ‡å‡†äº‹åŠ¡æµç¨‹**
```
Connectionå¯¹è±¡
    â”‚
    â”œâ”€ setAutoCommit(false)  â† ç¬¬1æ­¥ï¼šå¼€å¯æ‰‹åŠ¨æ§åˆ¶
    â”‚
    â”œâ”€ æ‰§è¡Œä¸šåŠ¡SQLæ“ä½œ        â† ç¬¬2æ­¥ï¼šæ‰§è¡Œæ•°æ®åº“æ“ä½œ
    â”‚   - insert/update/delete
    â”‚
    â”œâ”€ commit()              â† ç¬¬3æ­¥ï¼šæˆåŠŸåˆ™æäº¤
    â”‚   OR
    â””â”€ rollback()            â† ç¬¬3æ­¥ï¼šå¤±è´¥åˆ™å›æ»š
```

---

## 3. ğŸ’» JDBCç¼–ç¨‹å¼äº‹åŠ¡å®æˆ˜


### 3.1 åŸºç¡€äº‹åŠ¡ä»£ç ç»“æ„


**ğŸ”¸ æ ‡å‡†æ¨¡æ¿**
```java
Connection conn = null;
try {
    // 1ï¸âƒ£ è·å–æ•°æ®åº“è¿æ¥
    conn = DriverManager.getConnection(url, user, password);
    
    // 2ï¸âƒ£ å…³é—­è‡ªåŠ¨æäº¤ï¼ˆå¼€å¯äº‹åŠ¡ï¼‰
    conn.setAutoCommit(false);
    
    // 3ï¸âƒ£ æ‰§è¡Œä¸šåŠ¡SQL
    // ... æ•°æ®åº“æ“ä½œ ...
    
    // 4ï¸âƒ£ æäº¤äº‹åŠ¡
    conn.commit();
    
} catch (Exception e) {
    // 5ï¸âƒ£ å›æ»šäº‹åŠ¡
    if (conn != null) {
        try {
            conn.rollback();
        } catch (SQLException ex) {
            ex.printStackTrace();
        }
    }
} finally {
    // 6ï¸âƒ£ å…³é—­èµ„æº
    if (conn != null) {
        try {
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}
```

**ğŸ“‹ ä»£ç è§£è¯»**

| æ­¥éª¤ | **ä»£ç ** | **ä½œç”¨** | **å¿…è¦æ€§** |
|-----|---------|---------|-----------|
| 1ï¸âƒ£ | `getConnection()` | `è·å–æ•°æ®åº“è¿æ¥` | `å¿…éœ€` |
| 2ï¸âƒ£ | `setAutoCommit(false)` | `å¼€å¯æ‰‹åŠ¨äº‹åŠ¡` | `å¿…éœ€` |
| 3ï¸âƒ£ | `executeUpdate()` | `æ‰§è¡ŒSQLæ“ä½œ` | `å¿…éœ€` |
| 4ï¸âƒ£ | `commit()` | `æäº¤äº‹åŠ¡` | `å¿…éœ€` |
| 5ï¸âƒ£ | `rollback()` | `å›æ»šäº‹åŠ¡` | `å¼‚å¸¸æ—¶å¿…éœ€` |
| 6ï¸âƒ£ | `close()` | `é‡Šæ”¾èµ„æº` | `å¿…éœ€` |

### 3.2 å®æˆ˜æ¡ˆä¾‹ï¼šé“¶è¡Œè½¬è´¦


**ğŸŒ° ä¸šåŠ¡åœºæ™¯**
```
Aè´¦æˆ·å‘Bè´¦æˆ·è½¬è´¦500å…ƒ
- Aè´¦æˆ·ä½™é¢å‡å°‘500
- Bè´¦æˆ·ä½™é¢å¢åŠ 500
- ä¸¤æ­¥æ“ä½œå¿…é¡»åŒæ—¶æˆåŠŸ
```

**ğŸ’» å®Œæ•´ä»£ç å®ç°**
```java
public void transfer(String fromAccount, String toAccount, double amount) {
    Connection conn = null;
    PreparedStatement ps1 = null;
    PreparedStatement ps2 = null;
    
    try {
        // â‘  è·å–è¿æ¥
        conn = getConnection();
        
        // â‘¡ å¼€å¯äº‹åŠ¡
        conn.setAutoCommit(false);
        
        // â‘¢ æ‰£æ¬¾æ“ä½œ
        String sql1 = "UPDATE account SET balance = balance - ? WHERE account_no = ?";
        ps1 = conn.prepareStatement(sql1);
        ps1.setDouble(1, amount);
        ps1.setString(2, fromAccount);
        ps1.executeUpdate();
        
        // â‘£ åŠ æ¬¾æ“ä½œ
        String sql2 = "UPDATE account SET balance = balance + ? WHERE account_no = ?";
        ps2 = conn.prepareStatement(sql2);
        ps2.setDouble(1, amount);
        ps2.setString(2, toAccount);
        ps2.executeUpdate();
        
        // â‘¤ æäº¤äº‹åŠ¡
        conn.commit();
        System.out.println("è½¬è´¦æˆåŠŸï¼");
        
    } catch (Exception e) {
        // â‘¥ å›æ»šäº‹åŠ¡
        if (conn != null) {
            try {
                conn.rollback();
                System.out.println("è½¬è´¦å¤±è´¥ï¼Œå·²å›æ»šï¼");
            } catch (SQLException ex) {
                ex.printStackTrace();
            }
        }
        e.printStackTrace();
        
    } finally {
        // â‘¦ å…³é—­èµ„æº
        closeResources(ps1, ps2, conn);
    }
}
```

**ğŸ” å…³é”®æ­¥éª¤è¯´æ˜**

æ­¥éª¤â‘¢â‘£ï¼šæ‰§è¡Œä¸¤æ¡SQL
- è¿™ä¸¤æ¡SQLéƒ½åœ¨äº‹åŠ¡ä¸­ï¼Œæš‚æœªæäº¤
- å¦‚æœä¸­é—´å‡ºé”™ï¼Œä¼šè·³åˆ°catchå—

æ­¥éª¤â‘¤ï¼šæäº¤äº‹åŠ¡
- åªæœ‰ä¸¤æ¡SQLéƒ½æˆåŠŸï¼Œæ‰ä¼šæ‰§è¡Œåˆ°è¿™é‡Œ
- `commit()`ä½¿æ‰€æœ‰ä¿®æ”¹æ°¸ä¹…ç”Ÿæ•ˆ

æ­¥éª¤â‘¥ï¼šå¼‚å¸¸å›æ»š
- ä»»ä½•ä¸€æ¡SQLå¤±è´¥ï¼Œéƒ½ä¼šè§¦å‘rollback
- æ•°æ®æ¢å¤åˆ°è½¬è´¦å‰çš„çŠ¶æ€

### 3.3 äº‹åŠ¡æ‰§è¡Œæµç¨‹å›¾è§£


**ğŸ”„ æ­£å¸¸æµç¨‹ï¼ˆè½¬è´¦æˆåŠŸï¼‰**
```
å¼€å§‹
  â”‚
  â”œâ”€ setAutoCommit(false)
  â”‚
  â”œâ”€ Aè´¦æˆ· -500 âœ“
  â”‚
  â”œâ”€ Bè´¦æˆ· +500 âœ“
  â”‚
  â”œâ”€ commit() âœ“
  â”‚
ç»“æŸï¼ˆæ•°æ®å·²ä¿å­˜ï¼‰
```

**ğŸ”„ å¼‚å¸¸æµç¨‹ï¼ˆè½¬è´¦å¤±è´¥ï¼‰**
```
å¼€å§‹
  â”‚
  â”œâ”€ setAutoCommit(false)
  â”‚
  â”œâ”€ Aè´¦æˆ· -500 âœ“
  â”‚
  â”œâ”€ Bè´¦æˆ· +500 âœ— ï¼ˆå‡ºé”™ï¼ï¼‰
  â”‚
  â”œâ”€ rollback() âœ“
  â”‚
ç»“æŸï¼ˆæ•°æ®å·²æ¢å¤ï¼‰
```

> âš ï¸ **æ–°æ‰‹æ˜“é”™ç‚¹**  
> å¦‚æœå¿˜è®°`setAutoCommit(false)`ï¼Œä¸¤æ¡SQLä¼šåˆ†åˆ«è‡ªåŠ¨æäº¤ï¼Œå³ä½¿ç¬¬äºŒæ¡å¤±è´¥ï¼Œç¬¬ä¸€æ¡ä¹Ÿæ— æ³•å›æ»šï¼

---

## 4. ğŸ›¡ï¸ èµ„æºç®¡ç†æœ€ä½³å®è·µ


### 4.1 ä¸ºä»€ä¹ˆè¦å…³é—­èµ„æº


**ğŸ“‹ æ ¸å¿ƒåŸå› **
- æ•°æ®åº“è¿æ¥æ˜¯æœ‰é™èµ„æºï¼ˆé€šå¸¸åªæœ‰å‡ ååˆ°å‡ ç™¾ä¸ªï¼‰
- ä¸å…³é—­ä¼šå¯¼è‡´è¿æ¥æ³„æ¼
- æœ€ç»ˆå¯¼è‡´"æ— å¯ç”¨è¿æ¥"é”™è¯¯

**ğŸŒ° å½¢è±¡æ¯”å–»**
```
æ•°æ®åº“è¿æ¥å°±åƒå›¾ä¹¦é¦†çš„åº§ä½ï¼š
- æ€»å…±åªæœ‰100ä¸ªåº§ä½ï¼ˆè¿æ¥ï¼‰
- ä½ å äº†åº§ä½ä¸é‡Šæ”¾ï¼Œåˆ«äººå°±æ²¡å¾—ç”¨
- æ‰€æœ‰åº§ä½è¢«å æ»¡ï¼Œæ–°æ¥çš„äººåªèƒ½ç­‰å¾…
```

### 4.2 èµ„æºå…³é—­çš„æ ‡å‡†é¡ºåº


**ğŸ“ å…³é—­é¡ºåºåŸåˆ™**
```
ResultSet â†’ PreparedStatement â†’ Connection
ï¼ˆå…ˆå¼€çš„åå…³ï¼Œåå¼€çš„å…ˆå…³ï¼‰
```

**ğŸ’» æ ‡å‡†å…³é—­æ–¹æ³•**
```java
private void closeResources(PreparedStatement ps, Connection conn) {
    // â‘  å…ˆå…³é—­Statement
    if (ps != null) {
        try {
            ps.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
    
    // â‘¡ å†å…³é—­Connection
    if (conn != null) {
        try {
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}
```

### 4.3 JDK 7+ è‡ªåŠ¨èµ„æºç®¡ç†


**ğŸ”¸ try-with-resources è¯­æ³•**
```java
// è‡ªåŠ¨å…³é—­èµ„æºï¼Œæ— éœ€æ‰‹åŠ¨close()
public void transferWithAutoClose(String from, String to, double amount) {
    String sql1 = "UPDATE account SET balance = balance - ? WHERE account_no = ?";
    String sql2 = "UPDATE account SET balance = balance + ? WHERE account_no = ?";
    
    try (Connection conn = getConnection();
         PreparedStatement ps1 = conn.prepareStatement(sql1);
         PreparedStatement ps2 = conn.prepareStatement(sql2)) {
        
        // å¼€å¯äº‹åŠ¡
        conn.setAutoCommit(false);
        
        // æ‰£æ¬¾
        ps1.setDouble(1, amount);
        ps1.setString(2, from);
        ps1.executeUpdate();
        
        // åŠ æ¬¾
        ps2.setDouble(1, amount);
        ps2.setString(2, to);
        ps2.executeUpdate();
        
        // æäº¤
        conn.commit();
        
    } catch (Exception e) {
        e.printStackTrace();
        // æ³¨æ„ï¼šè¿™é‡Œæ— æ³•rollbackï¼Œå› ä¸ºconnå·²è¶…å‡ºä½œç”¨åŸŸ
    }
}
```

**âš ï¸ æ³¨æ„äº‹é¡¹**
- try-with-resourcesä¼šè‡ªåŠ¨å…³é—­èµ„æº
- ä½†åœ¨å¼‚å¸¸æ—¶æ— æ³•æ‰‹åŠ¨rollback
- å®é™…é¡¹ç›®ä¸­éœ€è¦æƒè¡¡ä½¿ç”¨

### 4.4 Connectionçš„äº‹åŠ¡çŠ¶æ€ç®¡ç†


**ğŸ”¸ æ¢å¤è‡ªåŠ¨æäº¤**
```java
try {
    conn.setAutoCommit(false);
    
    // ä¸šåŠ¡æ“ä½œ
    
    conn.commit();
    
} catch (Exception e) {
    conn.rollback();
} finally {
    // æ¢å¤è‡ªåŠ¨æäº¤æ¨¡å¼ï¼ˆå¯é€‰ï¼‰
    if (conn != null) {
        conn.setAutoCommit(true);
        conn.close();
    }
}
```

**ğŸ’¡ ä¸ºä»€ä¹ˆè¦æ¢å¤**
- å¦‚æœè¿æ¥ä¼šè¢«å¤ç”¨ï¼ˆå¦‚è¿æ¥æ± ï¼‰ï¼Œéœ€è¦æ¢å¤é»˜è®¤çŠ¶æ€
- é¿å…å½±å“ä¸‹ä¸€æ¬¡ä½¿ç”¨è¯¥è¿æ¥çš„ä»£ç 

---

## 5. â“ å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


### 5.1 äº‹åŠ¡ä¸ç”Ÿæ•ˆçš„åŸå› 


**ğŸ”¸ é—®é¢˜1ï¼šå¿˜è®°å…³é—­è‡ªåŠ¨æäº¤**
```java
// âŒ é”™è¯¯å†™æ³•
Connection conn = getConnection();
// å¿˜è®° conn.setAutoCommit(false);
executeSQL1();  // è‡ªåŠ¨æäº¤
executeSQL2();  // è‡ªåŠ¨æäº¤
conn.commit();  // æ— æ„ä¹‰
```

**âœ… æ­£ç¡®å†™æ³•**
```java
Connection conn = getConnection();
conn.setAutoCommit(false);  // å¿…é¡»å…³é—­è‡ªåŠ¨æäº¤
executeSQL1();
executeSQL2();
conn.commit();
```

**ğŸ”¸ é—®é¢˜2ï¼šå¼‚å¸¸æ²¡æœ‰æ­£ç¡®å›æ»š**
```java
// âŒ é”™è¯¯å†™æ³•
try {
    conn.setAutoCommit(false);
    executeSQL();
    conn.commit();
} catch (Exception e) {
    // å¿˜è®°rollback
    e.printStackTrace();
}
```

**âœ… æ­£ç¡®å†™æ³•**
```java
try {
    conn.setAutoCommit(false);
    executeSQL();
    conn.commit();
} catch (Exception e) {
    conn.rollback();  // å¿…é¡»å›æ»š
    e.printStackTrace();
}
```

### 5.2 èµ„æºæ³„æ¼é—®é¢˜


**ğŸ”¸ é—®é¢˜ï¼šfinallyä¸­æœªå…³é—­è¿æ¥**
```java
// âŒ å±é™©å†™æ³•
Connection conn = getConnection();
try {
    // ä¸šåŠ¡é€»è¾‘
} catch (Exception e) {
    // å¼‚å¸¸å¤„ç†
}
// è¿æ¥æœªå…³é—­ï¼Œé€ æˆæ³„æ¼ï¼
```

**âœ… å®‰å…¨å†™æ³•**
```java
Connection conn = null;
try {
    conn = getConnection();
    // ä¸šåŠ¡é€»è¾‘
} catch (Exception e) {
    // å¼‚å¸¸å¤„ç†
} finally {
    if (conn != null) {
        conn.close();  // ç¡®ä¿å…³é—­
    }
}
```

### 5.3 å¤šçº¿ç¨‹äº‹åŠ¡é—®é¢˜


**âš ï¸ å…³é”®ç†è§£**
- æ¯ä¸ªçº¿ç¨‹å¿…é¡»ä½¿ç”¨ç‹¬ç«‹çš„Connectionå¯¹è±¡
- ä¸èƒ½å¤šçº¿ç¨‹å…±äº«åŒä¸€ä¸ªConnection
- äº‹åŠ¡æ˜¯åŸºäºConnectionçš„ï¼Œå…±äº«ä¼šå¯¼è‡´äº‹åŠ¡æ··ä¹±

**ğŸ”¸ é”™è¯¯ç¤ºä¾‹**
```java
// âŒ å¤šçº¿ç¨‹å…±äº«Connectionï¼ˆå±é™©ï¼ï¼‰
static Connection conn = getConnection();

public void thread1() {
    conn.setAutoCommit(false);
    // SQLæ“ä½œ
    conn.commit();
}

public void thread2() {
    conn.setAutoCommit(false);
    // SQLæ“ä½œ  
    conn.commit();
}
```

**âœ… æ­£ç¡®åšæ³•**
```java
// âœ… æ¯ä¸ªçº¿ç¨‹ç‹¬ç«‹Connection
public void thread1() {
    Connection conn = getConnection();
    try {
        conn.setAutoCommit(false);
        // SQLæ“ä½œ
        conn.commit();
    } finally {
        conn.close();
    }
}
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„çŸ¥è¯†ç‚¹


**ğŸ”¸ äº‹åŠ¡ä¸‰å¤§æ ¸å¿ƒæ–¹æ³•**
```
setAutoCommit(false)  â†’ å¼€å¯æ‰‹åŠ¨äº‹åŠ¡æ§åˆ¶
commit()             â†’ æäº¤æ‰€æœ‰æ“ä½œ
rollback()           â†’ å›æ»šæ‰€æœ‰æ“ä½œ
```

**ğŸ”¸ æ ‡å‡†äº‹åŠ¡æµç¨‹**
```
1. è·å–Connection
2. å…³é—­è‡ªåŠ¨æäº¤ setAutoCommit(false)
3. æ‰§è¡Œä¸šåŠ¡SQL
4. æˆåŠŸåˆ™commit()ï¼Œå¤±è´¥åˆ™rollback()
5. finallyä¸­å…³é—­èµ„æº
```

**ğŸ”¸ èµ„æºç®¡ç†åŸåˆ™**
```
- å¿…é¡»åœ¨finallyä¸­å…³é—­èµ„æº
- å…³é—­é¡ºåºï¼šResultSet â†’ Statement â†’ Connection
- ä½¿ç”¨try-with-resourceså¯è‡ªåŠ¨å…³é—­
```

### 6.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ’¡ äº‹åŠ¡çš„æœ¬è´¨**
- å°†å¤šä¸ªæ“ä½œç»‘å®šæˆåŸå­å•å…ƒ
- ä¿è¯"å…¨éƒ¨æˆåŠŸ"æˆ–"å…¨éƒ¨å¤±è´¥"
- é€šè¿‡commitå’Œrollbackæ§åˆ¶æœ€ç»ˆç»“æœ

**ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦æ‰‹åŠ¨æ§åˆ¶**
- é»˜è®¤çš„è‡ªåŠ¨æäº¤æ— æ³•ä¿è¯å¤šæ­¥æ“ä½œçš„ä¸€è‡´æ€§
- ä¸šåŠ¡åœºæ™¯å¸¸éœ€è¦å¤šä¸ªSQLååŒå·¥ä½œ
- æ‰‹åŠ¨æ§åˆ¶å¯ä»¥åœ¨å¼‚å¸¸æ—¶æ’¤é”€æ“ä½œ

**ğŸ’¡ å¼‚å¸¸å¤„ç†çš„é‡è¦æ€§**
- å¿…é¡»æ•è·å¼‚å¸¸å¹¶rollback
- ä¸å›æ»šä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´
- finallyä¿è¯èµ„æºä¸€å®šè¢«é‡Šæ”¾

### 6.3 å®æˆ˜åº”ç”¨å»ºè®®


**ğŸ“ é€‚ç”¨åœºæ™¯**
- é“¶è¡Œè½¬è´¦ã€è®¢å•å¤„ç†ç­‰å¤šæ­¥æ“ä½œ
- æ•°æ®ä¸€è‡´æ€§è¦æ±‚é«˜çš„ä¸šåŠ¡
- éœ€è¦åŸå­æ€§ä¿è¯çš„æ“ä½œ

**ğŸ“ æ³¨æ„äº‹é¡¹**
- [ ] ç¡®ä¿setAutoCommit(false)åœ¨ç¬¬ä¸€ä½
- [ ] æ‰€æœ‰SQLæ‰§è¡Œå®Œæ‰commit
- [ ] å¼‚å¸¸æ—¶å¿…é¡»rollback
- [ ] finallyä¸­å¿…é¡»å…³é—­èµ„æº
- [ ] é¿å…å¤šçº¿ç¨‹å…±äº«Connection

**ğŸ“ ä»£ç æ£€æŸ¥æ¸…å•**
- [ ] æ˜¯å¦å…³é—­äº†è‡ªåŠ¨æäº¤ï¼Ÿ
- [ ] æ˜¯å¦åœ¨å¼‚å¸¸æ—¶å›æ»šï¼Ÿ
- [ ] æ˜¯å¦åœ¨finallyä¸­å…³é—­èµ„æºï¼Ÿ
- [ ] æ˜¯å¦æœ‰èµ„æºæ³„æ¼é£é™©ï¼Ÿ
- [ ] æ˜¯å¦æœ‰å¹¶å‘é—®é¢˜ï¼Ÿ

---

**ğŸ§  è®°å¿†å£è¯€**
```
å¼€å¯äº‹åŠ¡å…³è‡ªåŠ¨ï¼Œä¸šåŠ¡SQLç´§è·Ÿä¸Š
æˆåŠŸæäº¤å¤±è´¥æ»šï¼Œèµ„æºé‡Šæ”¾åˆ«é—å¿˜
Connectionæ˜¯å…³é”®ï¼Œåƒä¸‡åˆ«è®©å¤šçº¿ç¨‹
```

**ğŸ¯ å­¦ä¹ å»ºè®®**
1. ç†è§£äº‹åŠ¡çš„ä¸šåŠ¡æ„ä¹‰ï¼ˆä¸ºä»€ä¹ˆéœ€è¦ï¼‰
2. æŒæ¡ä¸‰å¤§æ–¹æ³•çš„ä½¿ç”¨æ—¶æœºï¼ˆæ€ä¹ˆç”¨ï¼‰
3. å®è·µæ ‡å‡†ä»£ç æ¨¡æ¿ï¼ˆåŠ¨æ‰‹ç»ƒï¼‰
4. æ³¨æ„å¼‚å¸¸å¤„ç†å’Œèµ„æºç®¡ç†ï¼ˆé¿å‘ç‚¹ï¼‰