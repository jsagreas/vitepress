---
title: 11ã€å®¹å™¨åŒ–ä¸é•œåƒåˆ†å±‚
---
## ğŸ“š ç›®å½•

1. [å®¹å™¨åŒ–åŸºç¡€æ¦‚å¿µ](#1-å®¹å™¨åŒ–åŸºç¡€æ¦‚å¿µ)
2. [Dockeré•œåƒæ„å»ºè¯¦è§£](#2-Dockeré•œåƒæ„å»ºè¯¦è§£)
3. [Jibæ’ä»¶æ·±åº¦ä½¿ç”¨](#3-Jibæ’ä»¶æ·±åº¦ä½¿ç”¨)
4. [é•œåƒå±‚ä¼˜åŒ–ç­–ç•¥](#4-é•œåƒå±‚ä¼˜åŒ–ç­–ç•¥)
5. [åŸºç¡€é•œåƒé€‰æ‹©ä¸ä¼˜åŒ–](#5-åŸºç¡€é•œåƒé€‰æ‹©ä¸ä¼˜åŒ–)
6. [å¯åŠ¨å‚æ•°ä¼˜åŒ–é…ç½®](#6-å¯åŠ¨å‚æ•°ä¼˜åŒ–é…ç½®)
7. [å®¹å™¨å¥åº·æ£€æŸ¥æœºåˆ¶](#7-å®¹å™¨å¥åº·æ£€æŸ¥æœºåˆ¶)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ³ å®¹å™¨åŒ–åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯å®¹å™¨åŒ–


**ğŸ“¦ å®¹å™¨åŒ–ç®€å•ç†è§£**

å®¹å™¨åŒ–å°±åƒç»™ä½ çš„Spring Bootåº”ç”¨**æ‰“åŒ…è£…ç®±**ï¼ŒæŠŠåº”ç”¨å’Œå®ƒéœ€è¦çš„æ‰€æœ‰ç¯å¢ƒï¼ˆJDKã€é…ç½®æ–‡ä»¶ç­‰ï¼‰éƒ½è£…åˆ°ä¸€ä¸ª"é›†è£…ç®±"é‡Œã€‚è¿™æ ·æ— è®ºä½ æŠŠè¿™ä¸ªç®±å­æ”¾åˆ°å“ªå°æœºå™¨ä¸Šï¼Œåº”ç”¨éƒ½èƒ½æ­£å¸¸è¿è¡Œã€‚

```
ä¼ ç»Ÿéƒ¨ç½²æ–¹å¼ï¼š
ä½ çš„ç”µè„‘ âœ… â†’ æœ‹å‹çš„ç”µè„‘ âŒ (ç¼ºå°‘JDK)
         â†“
éœ€è¦æ‰‹åŠ¨å®‰è£…JDKã€é…ç½®ç¯å¢ƒå˜é‡...

å®¹å™¨åŒ–éƒ¨ç½²ï¼š
ä½ çš„ç”µè„‘ âœ… â†’ æœ‹å‹çš„ç”µè„‘ âœ… (å®¹å™¨åŒ…å«ä¸€åˆ‡)
         â†“  
ä¸€ä¸ªå‘½ä»¤å¯åŠ¨ï¼Œç¯å¢ƒå®Œå…¨ä¸€è‡´
```

### 1.2 ä¸ºä»€ä¹ˆè¦å®¹å™¨åŒ–Spring Boot


**ğŸ¯ æ ¸å¿ƒå¥½å¤„**

- **ğŸ”§ ç¯å¢ƒä¸€è‡´æ€§**ï¼šå¼€å‘ç¯å¢ƒèƒ½è·‘ï¼Œç”Ÿäº§ç¯å¢ƒä¹Ÿèƒ½è·‘
- **ğŸ“¦ éƒ¨ç½²ç®€å•**ï¼šä¸€ä¸ªå‘½ä»¤å°±èƒ½å¯åŠ¨æ•´ä¸ªåº”ç”¨
- **âš–ï¸ èµ„æºéš”ç¦»**ï¼šå¤šä¸ªåº”ç”¨äº’ä¸å½±å“
- **ğŸš€ å¿«é€Ÿæ‰©å±•**ï¼šéœ€è¦æ›´å¤šå®ä¾‹ï¼Ÿå¤åˆ¶ç²˜è´´èˆ¬ç®€å•

> ğŸ’¡ **æ–°æ‰‹ç†è§£**  
> æƒ³è±¡ä¸€ä¸‹ï¼šä½ åšäº†ä¸€é“èœï¼Œå®¹å™¨åŒ–å°±æ˜¯æŠŠèœã€é¤å…·ã€è°ƒæ–™éƒ½æ‰“åŒ…å¥½ï¼Œåˆ«äººæ‹¿åˆ°å°±èƒ½ç›´æ¥äº«ç”¨ï¼Œä¸ç”¨å‡†å¤‡ä»»ä½•ä¸œè¥¿ã€‚

### 1.3 Spring Bootä¸å®¹å™¨çš„å¤©ç„¶å¥‘åˆ


Spring Bootæœ¬èº«å°±æ˜¯"å¼€ç®±å³ç”¨"çš„è®¾è®¡ç†å¿µï¼š
- âœ… å†…åµŒWebæœåŠ¡å™¨ï¼ˆTomcat/Jettyï¼‰
- âœ… è‡ªåŠ¨é…ç½®
- âœ… Fat Jaræ‰“åŒ…æ–¹å¼
- âœ… å¥åº·æ£€æŸ¥ç«¯ç‚¹

è¿™äº›ç‰¹æ€§è®©Spring Bootåº”ç”¨ç‰¹åˆ«é€‚åˆå®¹å™¨åŒ–éƒ¨ç½²ã€‚

---

## 2. ğŸ› ï¸ Dockeré•œåƒæ„å»ºè¯¦è§£


### 2.1 DockerfileåŸºç¡€å†™æ³•


**ğŸ“ æœ€ç®€å•çš„Dockerfile**

```dockerfile
# é€‰æ‹©åŸºç¡€é•œåƒ - å°±åƒé€‰æ‹©æ“ä½œç³»ç»Ÿ
FROM openjdk:11-jre-slim

# å¤åˆ¶jaråŒ…åˆ°å®¹å™¨å†…
COPY target/my-app.jar app.jar

# æš´éœ²ç«¯å£ - å‘Šè¯‰å¤–ç•Œåº”ç”¨ç›‘å¬å“ªä¸ªç«¯å£
EXPOSE 8080

# å¯åŠ¨å‘½ä»¤
ENTRYPOINT ["java", "-jar", "/app.jar"]
```

> ğŸ“š **æ¦‚å¿µè§£é‡Š**  
> - `FROM`ï¼šé€‰æ‹©åŸºç¡€é•œåƒï¼Œå°±åƒè£…ç³»ç»Ÿ
> - `COPY`ï¼šæŠŠæ–‡ä»¶å¤åˆ¶åˆ°å®¹å™¨é‡Œ
> - `EXPOSE`ï¼šå£°æ˜ç«¯å£ï¼ˆä»…å£°æ˜ï¼Œä¸ä¼šè‡ªåŠ¨å¼€æ”¾ï¼‰
> - `ENTRYPOINT`ï¼šå®¹å™¨å¯åŠ¨æ—¶æ‰§è¡Œçš„å‘½ä»¤

### 2.2 æ„å»ºå’Œè¿è¡Œæµç¨‹


**ğŸ”„ å®Œæ•´çš„æ„å»ºéƒ¨ç½²æµç¨‹**

```bash
# ç¬¬1æ­¥ï¼šæ‰“åŒ…Spring Bootåº”ç”¨
./mvnw clean package

# ç¬¬2æ­¥ï¼šæ„å»ºDockeré•œåƒ
docker build -t my-spring-app .

# ç¬¬3æ­¥ï¼šè¿è¡Œå®¹å™¨
docker run -p 8080:8080 my-spring-app
```

**æµç¨‹å›¾ç¤º**

```
æºä»£ç  â†’ Mavenæ‰“åŒ… â†’ Dockeræ„å»º â†’ å®¹å™¨è¿è¡Œ
  â†“           â†“           â†“          â†“
.java     app.jar    dockeré•œåƒ   è¿è¡Œçš„å®¹å™¨
```

### 2.3 å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–


**ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦å¤šé˜¶æ®µæ„å»º**

é—®é¢˜ï¼šå¦‚æœåœ¨å®¹å™¨å†…ç¼–è¯‘ä»£ç ï¼Œä¼šåŒ…å«å¾ˆå¤šæ„å»ºå·¥å…·ï¼ˆMavenã€ç¼–è¯‘å™¨ï¼‰ï¼Œè®©é•œåƒå˜å¾—å¾ˆå¤§ã€‚

è§£å†³ï¼šå¤šé˜¶æ®µæ„å»ºï¼Œç¬¬ä¸€é˜¶æ®µç¼–è¯‘ï¼Œç¬¬äºŒé˜¶æ®µåªä¿ç•™è¿è¡Œæ–‡ä»¶ã€‚

```dockerfile
# ç¬¬ä¸€é˜¶æ®µï¼šç¼–è¯‘é˜¶æ®µ
FROM maven:3.8-openjdk-11 AS builder
WORKDIR /app
COPY pom.xml .
COPY src ./src
RUN mvn clean package -DskipTests

# ç¬¬äºŒé˜¶æ®µï¼šè¿è¡Œé˜¶æ®µ
FROM openjdk:11-jre-slim
COPY --from=builder /app/target/*.jar app.jar
EXPOSE 8080
ENTRYPOINT ["java", "-jar", "/app.jar"]
```

**æ•ˆæœå¯¹æ¯”**

| æ„å»ºæ–¹å¼ | é•œåƒå¤§å° | åŒ…å«å†…å®¹ |
|---------|---------|---------|
| **å•é˜¶æ®µ** | ~800MB | JDK + Maven + æºç  + JaråŒ… |
| **å¤šé˜¶æ®µ** | ~200MB | ä»…JRE + JaråŒ… |

---

## 3. ğŸš€ Jibæ’ä»¶æ·±åº¦ä½¿ç”¨


### 3.1 ä»€ä¹ˆæ˜¯Jibæ’ä»¶


**ğŸ”§ Jibæ’ä»¶çš„æ ¸å¿ƒä»·å€¼**

Jibæ˜¯Googleå¼€å‘çš„å·¥å…·ï¼Œè®©ä½ **ä¸ç”¨å†™Dockerfile**å°±èƒ½æ„å»ºDockeré•œåƒã€‚å®ƒçš„ç†å¿µæ˜¯ï¼šJavaåº”ç”¨çš„å®¹å™¨åŒ–åº”è¯¥åƒä½¿ç”¨Mavenæ’ä»¶ä¸€æ ·ç®€å•ã€‚

**ä¼ ç»Ÿæ–¹å¼ vs Jibæ–¹å¼**

```
ä¼ ç»Ÿæ–¹å¼ï¼šå†™ä»£ç  â†’ å†™Dockerfile â†’ æ„å»ºé•œåƒ â†’ æ¨é€ä»“åº“
Jibæ–¹å¼ï¼š  å†™ä»£ç  â†’ é…ç½®æ’ä»¶ â†’ ä¸€é”®å®Œæˆæ‰€æœ‰æ­¥éª¤
```

### 3.2 Jibæ’ä»¶é…ç½®


**ğŸ“‹ Mavené…ç½®ç¤ºä¾‹**

```xml
<plugin>
    <groupId>com.google.cloud.tools</groupId>
    <artifactId>jib-maven-plugin</artifactId>
    <version>3.3.1</version>
    <configuration>
        <!-- åŸºç¡€é•œåƒ -->
        <from>
            <image>openjdk:11-jre-slim</image>
        </from>
        
        <!-- ç›®æ ‡é•œåƒ -->
        <to>
            <image>my-registry/my-spring-app</image>
            <tags>
                <tag>latest</tag>
                <tag>${project.version}</tag>
            </tags>
        </to>
        
        <!-- å®¹å™¨é…ç½® -->
        <container>
            <ports>
                <port>8080</port>
            </ports>
            <environment>
                <SPRING_PROFILES_ACTIVE>prod</SPRING_PROFILES_ACTIVE>
            </environment>
            <jvmFlags>
                <jvmFlag>-Xmx512m</jvmFlag>
                <jvmFlag>-Xms256m</jvmFlag>
            </jvmFlags>
        </container>
    </configuration>
</plugin>
```

### 3.3 Jibæ„å»ºå‘½ä»¤


**âš¡ å¸¸ç”¨æ„å»ºå‘½ä»¤**

```bash
# æ„å»ºé•œåƒåˆ°æœ¬åœ°Docker
./mvnw jib:dockerBuild

# ç›´æ¥æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼ˆæ¨èï¼‰
./mvnw jib:build

# æ„å»ºåˆ°taræ–‡ä»¶
./mvnw jib:buildTar
```

> ğŸ’¡ **Jibçš„æ™ºèƒ½ä¹‹å¤„**  
> Jibä¸éœ€è¦æœ¬åœ°å®‰è£…Dockerå°±èƒ½æ„å»ºé•œåƒï¼Œå®ƒç›´æ¥æ“ä½œé•œåƒå±‚ï¼Œæ•ˆç‡æ›´é«˜ï¼

### 3.4 Jibçš„åˆ†å±‚ä¼˜åŠ¿


**ğŸ“Š Jibè‡ªåŠ¨åˆ†å±‚ç­–ç•¥**

Jibä¼šæ™ºèƒ½åœ°å°†ä½ çš„åº”ç”¨åˆ†æˆä¸åŒçš„å±‚ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ä½ çš„åº”ç”¨ä»£ç         â”‚ â† ç»å¸¸å˜åŒ–ï¼Œç‹¬ç«‹ä¸€å±‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  
â”‚   é¡¹ç›®ä¾èµ–jaråŒ…      â”‚ â† å¶å°”å˜åŒ–ï¼Œç‹¬ç«‹ä¸€å±‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   èµ„æºæ–‡ä»¶           â”‚ â† å¾ˆå°‘å˜åŒ–ï¼Œç‹¬ç«‹ä¸€å±‚  
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   JREåŸºç¡€ç¯å¢ƒ        â”‚ â† å‡ ä¹ä¸å˜ï¼ŒåŸºç¡€å±‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¥½å¤„**ï¼šæ¯æ¬¡åªé‡æ–°æ„å»ºå˜åŒ–çš„å±‚ï¼Œå¤§å¤§æå‡æ„å»ºé€Ÿåº¦ã€‚

---

## 4. ğŸ”§ é•œåƒå±‚ä¼˜åŒ–ç­–ç•¥


### 4.1 ç†è§£Dockeré•œåƒåˆ†å±‚


**ğŸ“š åˆ†å±‚æ¦‚å¿µé€šä¿—è§£é‡Š**

Dockeré•œåƒå°±åƒåƒå±‚è›‹ç³•ï¼Œæ¯ä¸€å±‚éƒ½æ˜¯åªè¯»çš„ã€‚å½“ä½ ä¿®æ”¹åº”ç”¨ä»£ç æ—¶ï¼Œåªéœ€è¦é‡æ–°"çƒ¤åˆ¶"æœ€ä¸Šé¢é‚£å±‚è›‹ç³•ï¼Œä¸‹é¢çš„å±‚å¯ä»¥é‡å¤ä½¿ç”¨ã€‚

```
é•œåƒæ„å»ºè¿‡ç¨‹ï¼š

ç¬¬1æ¬¡æ„å»ºï¼š
åŸºç¡€å±‚(JRE) â†’ ä¾èµ–å±‚(libs) â†’ åº”ç”¨å±‚(your-code) = å®Œæ•´é•œåƒ

ç¬¬2æ¬¡æ„å»ºï¼ˆåªæ”¹äº†ä»£ç ï¼‰ï¼š
åŸºç¡€å±‚(JRE) âœ“ â†’ ä¾èµ–å±‚(libs) âœ“ â†’ åº”ç”¨å±‚(your-code) âœ—
                                    â†“
                               é‡æ–°æ„å»ºè¿™å±‚å³å¯
```

### 4.2 åˆ†å±‚ä¼˜åŒ–æœ€ä½³å®è·µ


**ğŸ¯ ä¼˜åŒ–åŸåˆ™ï¼šæŠŠå˜åŒ–é¢‘ç‡ç›¸è¿‘çš„æ–‡ä»¶æ”¾åœ¨åŒä¸€å±‚**

```dockerfile
# âŒ ä¸å¥½çš„åšæ³• - æ‰€æœ‰æ–‡ä»¶ä¸€èµ·å¤åˆ¶
COPY . /app/

# âœ… æ›´å¥½çš„åšæ³• - åˆ†å±‚å¤åˆ¶
COPY pom.xml /app/          # ä¾èµ–é…ç½®å±‚
RUN mvn dependency:resolve   # ä¸‹è½½ä¾èµ–å±‚  
COPY src /app/src/          # æºç å±‚
RUN mvn package             # ç¼–è¯‘å±‚
```

### 4.3 ç¼“å­˜åˆ©ç”¨ç­–ç•¥


**âš¡ æ„å»ºç¼“å­˜ä¼˜åŒ–æŠ€å·§**

| æ–‡ä»¶ç±»å‹ | å˜åŒ–é¢‘ç‡ | ä¼˜åŒ–ç­–ç•¥ |
|---------|---------|---------|
| **åŸºç¡€é•œåƒ** | å¾ˆå°‘å˜åŒ– | é€‰æ‹©ç¨³å®šç‰ˆæœ¬ |
| **ç³»ç»Ÿä¾èµ–** | å¾ˆå°‘å˜åŒ– | æ—©æœŸå®‰è£…ï¼Œç‹¬ç«‹å±‚ |
| **é¡¹ç›®ä¾èµ–** | å¶å°”å˜åŒ– | `pom.xml`å…ˆå¤åˆ¶ï¼Œè§¦å‘ä¾èµ–ä¸‹è½½ |
| **åº”ç”¨ä»£ç ** | ç»å¸¸å˜åŒ– | æœ€åå¤„ç†ï¼Œæœ€å°å½±å“ |

> ğŸ“ˆ **ä¼˜åŒ–æ•ˆæœ**  
> åˆç†åˆ†å±‚åï¼Œæ—¥å¸¸å¼€å‘ä¸­çš„é•œåƒæ„å»ºæ—¶é—´å¯ä»¥ä»5åˆ†é’Ÿé™ä½åˆ°30ç§’ï¼

---

## 5. ğŸ—ï¸ åŸºç¡€é•œåƒé€‰æ‹©ä¸ä¼˜åŒ–


### 5.1 åŸºç¡€é•œåƒç±»å‹å¯¹æ¯”


**ğŸ“Š å¸¸è§JavaåŸºç¡€é•œåƒå¯¹æ¯”**

| é•œåƒç±»å‹ | å¤§å° | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|---------|------|------|---------|
| `openjdk:11` | ~600MB | å®Œæ•´JDKç¯å¢ƒ | å¼€å‘ã€è°ƒè¯• |
| `openjdk:11-jre` | ~300MB | ä»…è¿è¡Œæ—¶ | ç”Ÿäº§ç¯å¢ƒ |
| `openjdk:11-jre-slim` | ~200MB | ç²¾ç®€è¿è¡Œæ—¶ | **æ¨èç”Ÿäº§** |
| `eclipse-temurin:11-jre-alpine` | ~170MB | Alpine Linux | æè‡´ç²¾ç®€ |

### 5.2 æœ€å°åŸºç¡€é•œåƒé€‰æ‹©


**ğŸ¯ é€‰æ‹©åŸåˆ™**

```
ç”Ÿäº§ç¯å¢ƒæ¨èï¼š
1. eclipse-temurin:11-jre-alpine  (æœ€å°)
2. openjdk:11-jre-slim           (å¹³è¡¡)
3. amazoncorretto:11             (AWSç¯å¢ƒ)
```

**Alpine vs Debianç³»ç»Ÿå¯¹æ¯”**

```
Alpineä¼˜åŠ¿ï¼š
âœ… ä½“ç§¯å° (5MBåŸºç¡€å¤§å°)
âœ… å®‰å…¨æ€§å¥½
âœ… å¯åŠ¨å¿«

Alpineæ³¨æ„äº‹é¡¹ï¼š
âš ï¸ ä½¿ç”¨musl libcï¼Œå¯èƒ½æœ‰å…¼å®¹æ€§é—®é¢˜
âš ï¸ è°ƒè¯•å·¥å…·è¾ƒå°‘
```

### 5.3 è‡ªå®šä¹‰åŸºç¡€é•œåƒ


**ğŸ”§ åˆ›å»ºé¡¹ç›®ä¸“ç”¨åŸºç¡€é•œåƒ**

```dockerfile
# åŸºç¡€é•œåƒï¼šbase-spring-boot:latest
FROM eclipse-temurin:11-jre-alpine

# æ·»åŠ å¸¸ç”¨å·¥å…·
RUN apk add --no-cache curl netcat-openbsd

# è®¾ç½®æ—¶åŒº
RUN apk add --no-cache tzdata
ENV TZ=Asia/Shanghai

# åˆ›å»ºåº”ç”¨ç”¨æˆ·ï¼ˆå®‰å…¨è€ƒè™‘ï¼‰
RUN addgroup -S spring && adduser -S spring -G spring
USER spring:spring

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app
```

**ä½¿ç”¨è‡ªå®šä¹‰åŸºç¡€é•œåƒ**

```dockerfile
FROM base-spring-boot:latest
COPY app.jar .
ENTRYPOINT ["java", "-jar", "app.jar"]
```

---

## 6. âš¡ å¯åŠ¨å‚æ•°ä¼˜åŒ–é…ç½®


### 6.1 JVMå†…å­˜å‚æ•°è°ƒä¼˜


**ğŸ“Š ç”Ÿäº§ç¯å¢ƒJVMå‚æ•°æ¨¡æ¿**

```bash
# å†…å­˜è®¾ç½®
-Xms512m           # åˆå§‹å †å†…å­˜
-Xmx1024m          # æœ€å¤§å †å†…å­˜  
-XX:MetaspaceSize=128m   # å…ƒç©ºé—´åˆå§‹å¤§å°
-XX:MaxMetaspaceSize=256m # å…ƒç©ºé—´æœ€å¤§å€¼

# åƒåœ¾å›æ”¶è®¾ç½®ï¼ˆJava 11æ¨èG1ï¼‰
-XX:+UseG1GC
-XX:MaxGCPauseMillis=200
-XX:+UseStringDeduplication
```

**å†…å­˜è®¾ç½®ç»éªŒå€¼**

```
å®¹å™¨å†…å­˜é…ç½®å»ºè®®ï¼š
å®¹å™¨æ€»å†…å­˜ = JVMå †å†…å­˜ + å…ƒç©ºé—´ + ç›´æ¥å†…å­˜ + ç³»ç»Ÿå¼€é”€

ä¾‹å¦‚ï¼š
å®¹å™¨ 2GB â†’ JVMå † 1.5GB + å…¶ä»– 0.5GB
å®¹å™¨ 1GB â†’ JVMå † 768MB + å…¶ä»– 256MB
```

### 6.2 å®¹å™¨ç¯å¢ƒä¼˜åŒ–å‚æ•°


**ğŸ³ å®¹å™¨ç‰¹æœ‰çš„JVMå‚æ•°**

```bash
# è®©JVMæ„ŸçŸ¥å®¹å™¨èµ„æºé™åˆ¶
-XX:+UseContainerSupport
-XX:InitialRAMPercentage=50.0
-XX:MaxRAMPercentage=75.0

# éšæœºæ•°ç”Ÿæˆä¼˜åŒ–ï¼ˆé¿å…é˜»å¡ï¼‰
-Djava.security.egd=file:/dev/./urandom

# DNSç¼“å­˜è®¾ç½®
-Djava.net.useSystemProxies=true
```

### 6.3 Spring Bootä¸“ç”¨å‚æ•°


**ğŸƒ åº”ç”¨å±‚é¢çš„ä¼˜åŒ–**

```yaml
# application-prod.yml
server:
  tomcat:
    threads:
      max: 200          # æœ€å¤§çº¿ç¨‹æ•°
      min-spare: 10     # æœ€å°ç©ºé—²çº¿ç¨‹
    connection-timeout: 20000
    accept-count: 100   # ç­‰å¾…é˜Ÿåˆ—é•¿åº¦

spring:
  jpa:
    hibernate:
      ddl-auto: none    # ç”Ÿäº§ç¯å¢ƒå…³é—­è‡ªåŠ¨å»ºè¡¨
    show-sql: false     # å…³é—­SQLæ—¥å¿—
  
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
```

### 6.4 å¯åŠ¨è„šæœ¬æ¨¡æ¿


**ğŸ“ ç”Ÿäº§çº§å¯åŠ¨è„šæœ¬**

```bash
#!/bin/sh
exec java \
  -Xms${JVM_MIN_HEAP:-512m} \
  -Xmx${JVM_MAX_HEAP:-1024m} \
  -XX:+UseContainerSupport \
  -XX:+UseG1GC \
  -Djava.security.egd=file:/dev/./urandom \
  -Dspring.profiles.active=${SPRING_PROFILES_ACTIVE:-prod} \
  -jar /app/app.jar
```

---

## 7. ğŸ¥ å®¹å™¨å¥åº·æ£€æŸ¥æœºåˆ¶


### 7.1 å¥åº·æ£€æŸ¥çš„é‡è¦æ€§


**ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦å¥åº·æ£€æŸ¥**

å¥åº·æ£€æŸ¥å°±åƒç»™åº”ç”¨å®‰æ’"ä½“æ£€"ï¼Œç¡®ä¿åº”ç”¨ä¸ä»…å¯åŠ¨äº†ï¼Œè¿˜èƒ½æ­£å¸¸å·¥ä½œã€‚

```
æ²¡æœ‰å¥åº·æ£€æŸ¥çš„é—®é¢˜ï¼š
åº”ç”¨å¯åŠ¨ âœ… â†’ ä½†å†…éƒ¨æœ‰é”™è¯¯ âŒ â†’ ç”¨æˆ·è®¿é—®å¤±è´¥ âŒ

æœ‰å¥åº·æ£€æŸ¥çš„å¥½å¤„ï¼š
åº”ç”¨å¯åŠ¨ âœ… â†’ å¥åº·æ£€æŸ¥é€šè¿‡ âœ… â†’ ç”¨æˆ·æ­£å¸¸è®¿é—® âœ…
```

### 7.2 Spring Bootå¥åº·æ£€æŸ¥ç«¯ç‚¹


**ğŸ“ Actuatorå¥åº·æ£€æŸ¥é…ç½®**

```yaml
# application.yml
management:
  endpoint:
    health:
      show-details: when-authorized
  endpoints:
    web:
      exposure:
        include: health
  health:
    defaults:
      enabled: true
```

**å¥åº·æ£€æŸ¥å“åº”ç¤ºä¾‹**

```json
// GET /actuator/health
{
  "status": "UP",
  "components": {
    "db": {"status": "UP"},
    "diskSpace": {"status": "UP"}, 
    "ping": {"status": "UP"}
  }
}
```

### 7.3 Dockerå¥åº·æ£€æŸ¥é…ç½®


**ğŸ³ Dockerfileä¸­çš„å¥åº·æ£€æŸ¥**

```dockerfile
HEALTHCHECK --interval=30s --timeout=10s --start-period=60s --retries=3 \
  CMD curl -f http://localhost:8080/actuator/health || exit 1
```

**å‚æ•°è§£é‡Š**

- `--interval=30s`ï¼šæ¯30ç§’æ£€æŸ¥ä¸€æ¬¡
- `--timeout=10s`ï¼šè¶…æ—¶æ—¶é—´10ç§’  
- `--start-period=60s`ï¼šå¯åŠ¨å60ç§’å¼€å§‹æ£€æŸ¥
- `--retries=3`ï¼šè¿ç»­å¤±è´¥3æ¬¡æ‰åˆ¤å®šä¸ºä¸å¥åº·

### 7.4 Kuberneteså°±ç»ªæ¢é’ˆ


**â˜¸ï¸ K8sä¸­çš„å¥åº·æ£€æŸ¥é…ç½®**

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: spring-boot-app
spec:
  template:
    spec:
      containers:
      - name: app
        image: my-spring-app:latest
        ports:
        - containerPort: 8080
        
        # å­˜æ´»æ¢é’ˆï¼šåˆ¤æ–­å®¹å™¨æ˜¯å¦éœ€è¦é‡å¯
        livenessProbe:
          httpGet:
            path: /actuator/health
            port: 8080
          initialDelaySeconds: 60
          periodSeconds: 30
          
        # å°±ç»ªæ¢é’ˆï¼šåˆ¤æ–­å®¹å™¨æ˜¯å¦å¯ä»¥æ¥æ”¶æµé‡  
        readinessProbe:
          httpGet:
            path: /actuator/health/readiness
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 10
```

### 7.5 è‡ªå®šä¹‰å¥åº·æ£€æŸ¥å™¨


**ğŸ”§ ä¸šåŠ¡ç›¸å…³çš„å¥åº·æ£€æŸ¥**

```java
@Component
public class CustomHealthIndicator implements HealthIndicator {
    
    @Autowired
    private ExternalService externalService;
    
    @Override
    public Health health() {
        try {
            // æ£€æŸ¥å¤–éƒ¨ä¾èµ–æ˜¯å¦æ­£å¸¸
            boolean isHealthy = externalService.isAvailable();
            
            if (isHealthy) {
                return Health.up()
                    .withDetail("externalService", "Available")
                    .build();
            } else {
                return Health.down()
                    .withDetail("externalService", "Unavailable")
                    .build();
            }
        } catch (Exception e) {
            return Health.down()
                .withDetail("error", e.getMessage())
                .build();
        }
    }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å®¹å™¨åŒ–æœ¬è´¨ï¼šåº”ç”¨+ç¯å¢ƒçš„å®Œæ•´æ‰“åŒ…ï¼Œå®ç°"ä¸€æ¬¡æ„å»ºï¼Œåˆ°å¤„è¿è¡Œ"
ğŸ”¸ Dockeråˆ†å±‚ï¼šé•œåƒå±‚çš„å¤ç”¨æœºåˆ¶ï¼Œåˆç†åˆ†å±‚æå‡æ„å»ºæ•ˆç‡
ğŸ”¸ Jibä¼˜åŠ¿ï¼šå…Dockerfileçš„æ™ºèƒ½æ„å»ºï¼Œè‡ªåŠ¨ä¼˜åŒ–åˆ†å±‚ç­–ç•¥
ğŸ”¸ åŸºç¡€é•œåƒï¼šé€‰æ‹©åˆé€‚å¤§å°å’ŒåŠŸèƒ½çš„åŸºç¡€é•œåƒï¼Œå¹³è¡¡ä½“ç§¯å’ŒåŠŸèƒ½
ğŸ”¸ å¥åº·æ£€æŸ¥ï¼šç¡®ä¿å®¹å™¨ä¸ä»…å¯åŠ¨ï¼Œè¿˜èƒ½æ­£å¸¸æä¾›æœåŠ¡
```

### 8.2 å…³é”®å®è·µè¦ç‚¹


**ğŸ”¹ é•œåƒæ„å»ºä¼˜åŒ–ç­–ç•¥**
```
åˆ†å±‚åŸåˆ™ï¼š
- å˜åŒ–é¢‘ç‡ä½çš„æ–‡ä»¶æ”¾åœ¨åº•å±‚
- å˜åŒ–é¢‘ç‡é«˜çš„æ–‡ä»¶æ”¾åœ¨é¡¶å±‚
- å……åˆ†åˆ©ç”¨æ„å»ºç¼“å­˜

å¤§å°ä¼˜åŒ–ï¼š
- é€‰æ‹©slimæˆ–alpineåŸºç¡€é•œåƒ
- ä½¿ç”¨å¤šé˜¶æ®µæ„å»º
- æ¸…ç†ä¸å¿…è¦çš„æ–‡ä»¶å’Œä¾èµ–
```

**ğŸ”¹ ç”Ÿäº§ç¯å¢ƒé…ç½®è¦ç‚¹**
```
å®‰å…¨è€ƒè™‘ï¼š
- ä½¿ç”¨érootç”¨æˆ·è¿è¡Œåº”ç”¨
- é™åˆ¶å®¹å™¨æƒé™
- å®šæœŸæ›´æ–°åŸºç¡€é•œåƒ

æ€§èƒ½è°ƒä¼˜ï¼š
- åˆç†è®¾ç½®JVMå†…å­˜å‚æ•°
- å¯ç”¨å®¹å™¨æ„ŸçŸ¥ç‰¹æ€§
- é…ç½®é€‚å½“çš„å¥åº·æ£€æŸ¥é—´éš”
```

### 8.3 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


**â“ é•œåƒå¤ªå¤§æ€ä¹ˆåŠï¼Ÿ**
- âœ… ä½¿ç”¨alpineåŸºç¡€é•œåƒ
- âœ… å¤šé˜¶æ®µæ„å»ºå»é™¤æ„å»ºå·¥å…·
- âœ… æ¸…ç†ç¼“å­˜å’Œä¸´æ—¶æ–‡ä»¶

**â“ åº”ç”¨å¯åŠ¨æ…¢æ€ä¹ˆåŠï¼Ÿ**
- âœ… ä¼˜åŒ–JVMå¯åŠ¨å‚æ•°
- âœ… ä½¿ç”¨åº”ç”¨é¢„çƒ­æœºåˆ¶
- âœ… è°ƒæ•´å¥åº·æ£€æŸ¥æ—¶é—´

**â“ å†…å­˜ä¸å¤Ÿç”¨æ€ä¹ˆåŠï¼Ÿ**
- âœ… æ­£ç¡®é…ç½®å †å†…å­˜å¤§å°
- âœ… ç›‘æ§å…ƒç©ºé—´ä½¿ç”¨æƒ…å†µ
- âœ… ä½¿ç”¨å†…å­˜åˆ†æå·¥å…·å®šä½é—®é¢˜

### 8.4 å­¦ä¹ è·¯å¾„å»ºè®®


**ğŸ“š å…¥é—¨é˜¶æ®µ**
- [x] ç†è§£å®¹å™¨åŒ–æ¦‚å¿µ
- [x] æŒæ¡åŸºç¡€Dockerfileç¼–å†™  
- [x] å­¦ä¼šæ„å»ºå’Œè¿è¡ŒSpring Bootå®¹å™¨

**ğŸš€ è¿›é˜¶é˜¶æ®µ**  
- [ ] æŒæ¡Jibæ’ä»¶ä½¿ç”¨
- [ ] å­¦ä¹ é•œåƒåˆ†å±‚ä¼˜åŒ–
- [ ] é…ç½®ç”Ÿäº§çº§å¯åŠ¨å‚æ•°

**â­ é«˜çº§é˜¶æ®µ**
- [ ] è‡ªå®šä¹‰å¥åº·æ£€æŸ¥å™¨
- [ ] Kubernetesé›†æˆé…ç½®
- [ ] ç›‘æ§å’Œæ—¥å¿—æ”¶é›†

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- å®¹å™¨åŒ–è®©éƒ¨ç½²åƒ"æ¬ç®±å­"ä¸€æ ·ç®€å•
- åˆ†å±‚æ„å»ºæ˜¯æå‡æ•ˆç‡çš„å…³é”®
- Jibè®©Javaå¼€å‘è€…æ— éœ€å­¦Dockerå°±èƒ½æ„å»ºé•œåƒ
- å¥åº·æ£€æŸ¥æ˜¯ç”Ÿäº§ç¯å¢ƒçš„å¿…å¤‡æœºåˆ¶
- åŸºç¡€é•œåƒé€‰æ‹©è¦åœ¨åŠŸèƒ½å’Œå¤§å°é—´å¹³è¡¡