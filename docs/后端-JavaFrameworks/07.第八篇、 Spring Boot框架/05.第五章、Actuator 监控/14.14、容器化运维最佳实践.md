---
title: 14ã€å®¹å™¨åŒ–è¿ç»´æœ€ä½³å®è·µ
---
## ğŸ“š ç›®å½•

1. [Dockeré•œåƒä¼˜åŒ–ç­–ç•¥](#1-Dockeré•œåƒä¼˜åŒ–ç­–ç•¥)
2. [Kubernetesèµ„æºé…é¢ç®¡ç†](#2-Kubernetesèµ„æºé…é¢ç®¡ç†)
3. [æ»šåŠ¨å‘å¸ƒç­–ç•¥è¯¦è§£](#3-æ»šåŠ¨å‘å¸ƒç­–ç•¥è¯¦è§£)
4. [æœåŠ¡ç½‘æ ¼é›†æˆå®è·µ](#4-æœåŠ¡ç½‘æ ¼é›†æˆå®è·µ)
5. [é…ç½®çƒ­æ›´æ–°æœºåˆ¶](#5-é…ç½®çƒ­æ›´æ–°æœºåˆ¶)
6. [æ•…éšœè‡ªæ„ˆæœºåˆ¶è®¾è®¡](#6-æ•…éšœè‡ªæ„ˆæœºåˆ¶è®¾è®¡)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ³ Dockeré•œåƒä¼˜åŒ–ç­–ç•¥


### 1.1 ä¸ºä»€ä¹ˆéœ€è¦é•œåƒä¼˜åŒ–

ğŸ¯ **ç®€å•ç†è§£**ï¼šDockeré•œåƒå°±åƒæ‰“åŒ…å¥½çš„"è½¯ä»¶ç›’å­"ï¼Œä¼˜åŒ–å°±æ˜¯è®©è¿™ä¸ªç›’å­æ›´å°ã€æ›´å¿«ã€æ›´å®‰å…¨

```
æƒ³è±¡ä¸€ä¸‹æ¬å®¶æ‰“åŒ…ï¼š
æ™®é€šæ‰“åŒ…ï¼šä»€ä¹ˆéƒ½å¾€ç®±å­é‡Œå¡ï¼Œç®±å­åˆé‡åˆå¤§
ä¼˜åŒ–æ‰“åŒ…ï¼šåªå¸¦å¿…éœ€å“ï¼Œåˆ†ç±»æ•´ç†ï¼Œè½»ä¾¿é«˜æ•ˆ

Dockeré•œåƒä¹Ÿæ˜¯å¦‚æ­¤ï¼š
æœªä¼˜åŒ–ï¼šåŒ…å«å¾ˆå¤šä¸å¿…è¦çš„æ–‡ä»¶ï¼Œé•œåƒä½“ç§¯å¤§
ä¼˜åŒ–åï¼šåªåŒ…å«è¿è¡Œéœ€è¦çš„å†…å®¹ï¼Œå¯åŠ¨å¿«ã€ä¼ è¾“å¿«
```

**ğŸ”¸ é•œåƒä¼˜åŒ–çš„æ ¸å¿ƒä»·å€¼**
- **å¿«é€Ÿéƒ¨ç½²**ï¼šé•œåƒè¶Šå°ï¼Œä¸‹è½½å’Œå¯åŠ¨è¶Šå¿«
- **èµ„æºèŠ‚çœ**ï¼šå ç”¨æ›´å°‘çš„ç£ç›˜å’Œç½‘ç»œå¸¦å®½  
- **å®‰å…¨æå‡**ï¼šå‡å°‘ä¸å¿…è¦çš„ç»„ä»¶ï¼Œé™ä½å®‰å…¨é£é™©
- **æˆæœ¬é™ä½**ï¼šåœ¨äº‘ç¯å¢ƒä¸­èŠ‚çœå­˜å‚¨å’Œä¼ è¾“è´¹ç”¨

### 1.2 å¤šé˜¶æ®µæ„å»ºæŠ€æœ¯

**ğŸ—ï¸ ä»€ä¹ˆæ˜¯å¤šé˜¶æ®µæ„å»º**

å¤šé˜¶æ®µæ„å»ºå°±åƒå·¥å‚çš„æµæ°´çº¿ä½œä¸šï¼šç¬¬ä¸€é˜¶æ®µè´Ÿè´£"åˆ¶é€ "ï¼Œç¬¬äºŒé˜¶æ®µè´Ÿè´£"åŒ…è£…"ï¼Œæœ€ç»ˆäº§å“åªåŒ…å«å¿…éœ€çš„éƒ¨åˆ†ã€‚

```dockerfile
# ç¬¬ä¸€é˜¶æ®µï¼šæ„å»ºé˜¶æ®µï¼ˆBuilder Stageï¼‰
FROM maven:3.8.4-openjdk-17 AS builder
WORKDIR /app

# åªå¤åˆ¶pom.xmlï¼Œå…ˆä¸‹è½½ä¾èµ–ï¼ˆåˆ©ç”¨Dockerç¼“å­˜ï¼‰
COPY pom.xml .
RUN mvn dependency:go-offline -B

# å¤åˆ¶æºç å¹¶ç¼–è¯‘
COPY src ./src
RUN mvn clean package -DskipTests

# ç¬¬äºŒé˜¶æ®µï¼šè¿è¡Œé˜¶æ®µï¼ˆRuntime Stageï¼‰
FROM openjdk:17-jre-slim
WORKDIR /app

# åˆ›å»ºérootç”¨æˆ·ï¼ˆå®‰å…¨è€ƒè™‘ï¼‰
RUN addgroup --system spring && adduser --system --group spring
USER spring

# åªå¤åˆ¶ç¼–è¯‘å¥½çš„jaræ–‡ä»¶
COPY --from=builder /app/target/*.jar app.jar

# å¥åº·æ£€æŸ¥é…ç½®
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
  CMD curl -f http://localhost:8080/actuator/health || exit 1

EXPOSE 8080
ENTRYPOINT ["java", "-jar", "app.jar"]
```

**ğŸ’¡ å¤šé˜¶æ®µæ„å»ºçš„ä¼˜åŠ¿**
- **ä½“ç§¯å‡å°**ï¼šæœ€ç»ˆé•œåƒä¸åŒ…å«Mavenã€æºç ç­‰æ„å»ºå·¥å…·
- **å®‰å…¨æ€§é«˜**ï¼šè¿è¡Œç¯å¢ƒå¹²å‡€ï¼Œæ”»å‡»é¢å°
- **ç¼“å­˜å‹å¥½**ï¼šåˆç†åˆ©ç”¨Dockerå±‚ç¼“å­˜æœºåˆ¶

### 1.3 é•œåƒå±‚ä¼˜åŒ–æŠ€å·§

**ğŸ“¦ ç†è§£Dockeré•œåƒåˆ†å±‚æœºåˆ¶**

Dockeré•œåƒå°±åƒåƒå±‚è›‹ç³•ï¼Œæ¯ä¸ªæŒ‡ä»¤éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°å±‚ã€‚ä¼˜åŒ–çš„å…³é”®æ˜¯å‡å°‘å±‚æ•°å’Œæ¯å±‚çš„å¤§å°ã€‚

**ğŸ”§ ä¼˜åŒ–æŠ€å·§å®è·µ**

| ä¼˜åŒ–ç­–ç•¥ | **ä¼˜åŒ–å‰** | **ä¼˜åŒ–å** | **æ•ˆæœè¯´æ˜** |
|---------|-----------|-----------|-------------|
| ğŸ”¸ **åˆå¹¶RUNæŒ‡ä»¤** | `å¤šä¸ªRUNå‘½ä»¤` | `å•ä¸ªRUNå‘½ä»¤` | `å‡å°‘é•œåƒå±‚æ•°` |
| ğŸ”¸ **æ¸…ç†ç¼“å­˜** | `ä¿ç•™åŒ…ç®¡ç†ç¼“å­˜` | `åŠæ—¶æ¸…ç†ç¼“å­˜` | `å‡å°‘é•œåƒä½“ç§¯` |
| ğŸ”¸ **é€‰æ‹©åŸºç¡€é•œåƒ** | `ubuntu:latest` | `openjdk:17-jre-slim` | `ä¸“ç”¨é•œåƒæ›´å°` |
| ğŸ”¸ **æ–‡ä»¶å¤åˆ¶é¡ºåº** | `å…ˆå¤åˆ¶æ‰€æœ‰æ–‡ä»¶` | `å…ˆå¤åˆ¶ä¾èµ–æ–‡ä»¶` | `æé«˜ç¼“å­˜æ•ˆç‡` |

```dockerfile
# âŒ æœªä¼˜åŒ–çš„å†™æ³•
FROM ubuntu:20.04
RUN apt-get update
RUN apt-get install -y openjdk-17-jre
RUN apt-get install -y curl
COPY . /app
WORKDIR /app
RUN mvn clean package

# âœ… ä¼˜åŒ–åçš„å†™æ³•
FROM openjdk:17-jre-slim
WORKDIR /app

# åˆå¹¶å‘½ä»¤ï¼ŒåŠæ—¶æ¸…ç†ç¼“å­˜
RUN apt-get update && \
    apt-get install -y --no-install-recommends curl && \
    rm -rf /var/lib/apt/lists/*

# åˆ©ç”¨ç¼“å­˜ï¼šå…ˆå¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY pom.xml .
RUN mvn dependency:go-offline -B

# æœ€åå¤åˆ¶å˜æ›´é¢‘ç¹çš„æºç 
COPY src ./src
RUN mvn clean package -DskipTests && \
    rm -rf ~/.m2/repository
```

### 1.4 å®‰å…¨æ€§ä¼˜åŒ–

**ğŸ›¡ï¸ å®¹å™¨å®‰å…¨æœ€ä½³å®è·µ**

```dockerfile
# å®‰å…¨ä¼˜åŒ–çš„å®Œæ•´ç¤ºä¾‹
FROM openjdk:17-jre-slim

# 1. ä½¿ç”¨érootç”¨æˆ·
RUN groupadd -r appgroup && useradd -r -g appgroup appuser

# 2. åˆ›å»ºåº”ç”¨ç›®å½•å¹¶è®¾ç½®æƒé™
RUN mkdir /app && chown -R appuser:appgroup /app
WORKDIR /app

# 3. åˆ‡æ¢åˆ°érootç”¨æˆ·
USER appuser

# 4. å¤åˆ¶åº”ç”¨æ–‡ä»¶
COPY --chown=appuser:appgroup target/*.jar app.jar

# 5. è®¾ç½®JVMå‚æ•°ä¼˜åŒ–
ENV JAVA_OPTS="-Xmx512m -Xms512m -XX:+UseG1GC -XX:+PrintGCDetails"

# 6. å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=10s --start-period=60s --retries=3 \
  CMD wget --quiet --tries=1 --spider http://localhost:8080/actuator/health || exit 1

EXPOSE 8080
ENTRYPOINT exec java $JAVA_OPTS -jar app.jar
```

**âš ï¸ å®‰å…¨æ³¨æ„äº‹é¡¹**
- **é¿å…ä½¿ç”¨rootç”¨æˆ·**ï¼šé™ä½å®¹å™¨è¢«æ”»å‡»åçš„å½±å“èŒƒå›´
- **åŠæ—¶æ›´æ–°åŸºç¡€é•œåƒ**ï¼šä¿®å¤å·²çŸ¥çš„å®‰å…¨æ¼æ´
- **æœ€å°åŒ–å®‰è£…**ï¼šåªå®‰è£…å¿…éœ€çš„è½¯ä»¶åŒ…
- **æ•æ„Ÿä¿¡æ¯ç®¡ç†**ï¼šä½¿ç”¨Secretè€Œä¸æ˜¯ç¯å¢ƒå˜é‡å­˜å‚¨å¯†ç 

---

## 2. â˜¸ï¸ Kubernetesèµ„æºé…é¢ç®¡ç†


### 2.1 ç†è§£K8sèµ„æºç®¡ç†

ğŸ¯ **ç®€å•ç†è§£**ï¼šKuberneteså°±åƒä¸€ä¸ª"èµ„æºç®¡å®¶"ï¼Œå¸®ä½ åˆç†åˆ†é…æœåŠ¡å™¨çš„CPUã€å†…å­˜ç­‰èµ„æº

```
ç°å®ä¸­çš„èµ„æºç®¡ç†ç±»æ¯”ï¼š
é…’åº—æˆ¿é—´ç®¡ç†ï¼š
- é¢„è®¢æˆ¿é—´æ•°é‡ï¼ˆRequestï¼‰
- æˆ¿é—´æœ€å¤§å®¹é‡ï¼ˆLimitï¼‰
- æ ¹æ®å®¢äººéœ€æ±‚åˆ†é…ä¸åŒç±»å‹æˆ¿é—´

K8sèµ„æºç®¡ç†ï¼š
- åº”ç”¨çš„åŸºæœ¬èµ„æºéœ€æ±‚ï¼ˆRequestï¼‰
- åº”ç”¨çš„æœ€å¤§èµ„æºé™åˆ¶ï¼ˆLimitï¼‰
- æ ¹æ®åº”ç”¨ç‰¹ç‚¹åˆ†é…åˆé€‚çš„èµ„æº
```

### 2.2 èµ„æºé…é¢é…ç½®å®æˆ˜

**ğŸ“Š Spring Bootåº”ç”¨çš„èµ„æºé…ç½®**

```yaml
# deployment.yaml - Spring Bootåº”ç”¨èµ„æºé…ç½®
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-springboot-app
  namespace: production
spec:
  replicas: 3
  selector:
    matchLabels:
      app: my-springboot-app
  template:
    metadata:
      labels:
        app: my-springboot-app
    spec:
      containers:
      - name: app
        image: my-company/springboot-app:v1.0.0
        ports:
        - containerPort: 8080
        
        # èµ„æºè¯·æ±‚å’Œé™åˆ¶é…ç½®
        resources:
          requests:
            memory: "256Mi"    # åŸºæœ¬å†…å­˜éœ€æ±‚
            cpu: "250m"        # åŸºæœ¬CPUéœ€æ±‚ï¼ˆ0.25æ ¸ï¼‰
          limits:
            memory: "512Mi"    # æœ€å¤§å†…å­˜é™åˆ¶
            cpu: "500m"        # æœ€å¤§CPUé™åˆ¶ï¼ˆ0.5æ ¸ï¼‰
        
        # JVMå†…å­˜é…ç½®ä¸å®¹å™¨èµ„æºå¯¹åº”
        env:
        - name: JAVA_OPTS
          value: "-Xmx400m -Xms256m"  # ç•™å‡º100Mç»™ç³»ç»Ÿ
        
        # å¥åº·æ£€æŸ¥é…ç½®
        livenessProbe:
          httpGet:
            path: /actuator/health/liveness
            port: 8080
          initialDelaySeconds: 60
          periodSeconds: 30
          timeoutSeconds: 5
          
        readinessProbe:
          httpGet:
            path: /actuator/health/readiness
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 10
          timeoutSeconds: 3
```

**ğŸ”§ èµ„æºé…é¢è®¾è®¡åŸåˆ™**

ğŸŸ¢ **åŸºç¡€é…ç½®æ¨è**
```
å°å‹Spring Bootåº”ç”¨ï¼š
CPU Request: 100-250m
CPU Limit: 500m-1000m
Memory Request: 256Mi-512Mi  
Memory Limit: 512Mi-1Gi

ä¸­å‹Spring Bootåº”ç”¨ï¼š
CPU Request: 250-500m
CPU Limit: 1000m-2000m
Memory Request: 512Mi-1Gi
Memory Limit: 1Gi-2Gi

å¤§å‹Spring Bootåº”ç”¨ï¼š
CPU Request: 500m-1000m
CPU Limit: 2000m-4000m
Memory Request: 1Gi-2Gi
Memory Limit: 2Gi-4Gi
```

### 2.3 å‘½åç©ºé—´çº§åˆ«èµ„æºç®¡ç†

**ğŸ¢ ä¼ä¸šçº§èµ„æºéš”ç¦»ç­–ç•¥**

```yaml
# namespace-quota.yaml - å‘½åç©ºé—´èµ„æºé…é¢
apiVersion: v1
kind: ResourceQuota
metadata:
  name: production-quota
  namespace: production
spec:
  hard:
    # è®¡ç®—èµ„æºé…é¢
    requests.cpu: "10"        # æ€»CPUè¯·æ±‚ä¸è¶…è¿‡10æ ¸
    requests.memory: 20Gi     # æ€»å†…å­˜è¯·æ±‚ä¸è¶…è¿‡20GB
    limits.cpu: "20"          # æ€»CPUé™åˆ¶ä¸è¶…è¿‡20æ ¸
    limits.memory: 40Gi       # æ€»å†…å­˜é™åˆ¶ä¸è¶…è¿‡40GB
    
    # å¯¹è±¡æ•°é‡é…é¢
    pods: "50"                # æœ€å¤š50ä¸ªPod
    services: "10"            # æœ€å¤š10ä¸ªService
    persistentvolumeclaims: "20"  # æœ€å¤š20ä¸ªPVC
    
    # å­˜å‚¨é…é¢
    requests.storage: 100Gi   # æ€»å­˜å‚¨è¯·æ±‚ä¸è¶…è¿‡100GB

---
# limit-range.yaml - é»˜è®¤èµ„æºé™åˆ¶
apiVersion: v1
kind: LimitRange
metadata:
  name: production-limits
  namespace: production
spec:
  limits:
  # Podçº§åˆ«é™åˆ¶
  - type: Pod
    max:
      cpu: "4"
      memory: "8Gi"
    min:
      cpu: "100m"
      memory: "128Mi"
      
  # Containerçº§åˆ«é™åˆ¶
  - type: Container
    default:              # é»˜è®¤é™åˆ¶
      cpu: "500m"
      memory: "512Mi"
    defaultRequest:       # é»˜è®¤è¯·æ±‚
      cpu: "200m"
      memory: "256Mi"
    max:                 # æœ€å¤§é™åˆ¶
      cpu: "2"
      memory: "4Gi"
    min:                 # æœ€å°é™åˆ¶
      cpu: "100m"
      memory: "128Mi"
```

### 2.4 åŠ¨æ€èµ„æºè°ƒæ•´

**ğŸ”„ åŸºäºè´Ÿè½½çš„è‡ªåŠ¨æ‰©ç¼©å®¹**

```yaml
# hpa.yaml - æ°´å¹³è‡ªåŠ¨æ‰©ç¼©å®¹
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: my-springboot-app-hpa
  namespace: production
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: my-springboot-app
    
  minReplicas: 2              # æœ€å°‘å®ä¾‹æ•°
  maxReplicas: 10             # æœ€å¤šå®ä¾‹æ•°
  
  metrics:
  # CPUä½¿ç”¨ç‡æŒ‡æ ‡
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70   # CPUä½¿ç”¨ç‡è¶…è¿‡70%æ—¶æ‰©å®¹
        
  # å†…å­˜ä½¿ç”¨ç‡æŒ‡æ ‡
  - type: Resource
    resource:
      name: memory
      target:
        type: Utilization
        averageUtilization: 80   # å†…å­˜ä½¿ç”¨ç‡è¶…è¿‡80%æ—¶æ‰©å®¹
        
  # è‡ªå®šä¹‰æŒ‡æ ‡ï¼ˆå¦‚HTTPè¯·æ±‚æ•°ï¼‰
  - type: Pods
    pods:
      metric:
        name: http_requests_per_second
      target:
        type: AverageValue
        averageValue: "100"      # æ¯ç§’è¯·æ±‚æ•°è¶…è¿‡100æ—¶æ‰©å®¹
        
  behavior:                    # æ‰©ç¼©å®¹è¡Œä¸ºæ§åˆ¶
    scaleUp:
      stabilizationWindowSeconds: 60   # æ‰©å®¹ç¨³å®šçª—å£
      policies:
      - type: Percent
        value: 50              # æ¯æ¬¡æœ€å¤šæ‰©å®¹50%
        periodSeconds: 60
    scaleDown:
      stabilizationWindowSeconds: 300  # ç¼©å®¹ç¨³å®šçª—å£
      policies:
      - type: Percent
        value: 10              # æ¯æ¬¡æœ€å¤šç¼©å®¹10%
        periodSeconds: 60
```

**ğŸ’¡ æ‰©ç¼©å®¹æœ€ä½³å®è·µ**
- **é¢„çƒ­æ—¶é—´**ï¼šSpring Bootåº”ç”¨å¯åŠ¨éœ€è¦æ—¶é—´ï¼Œè®¾ç½®åˆç†çš„åˆå§‹å»¶è¿Ÿ
- **ç¨³å®šçª—å£**ï¼šé¿å…é¢‘ç¹çš„æ‰©ç¼©å®¹æ“ä½œ
- **æ¢¯åº¦è°ƒæ•´**ï¼šé¿å…ä¸€æ¬¡æ€§å¤§å¹…è°ƒæ•´å®ä¾‹æ•°
- **å¤šæŒ‡æ ‡ç»“åˆ**ï¼šCPUã€å†…å­˜ã€è‡ªå®šä¹‰ä¸šåŠ¡æŒ‡æ ‡ç»¼åˆè€ƒè™‘

---

## 3. ğŸš€ æ»šåŠ¨å‘å¸ƒç­–ç•¥è¯¦è§£


### 3.1 ä»€ä¹ˆæ˜¯æ»šåŠ¨å‘å¸ƒ

ğŸ¯ **é€šä¿—ç†è§£**ï¼šæ»šåŠ¨å‘å¸ƒå°±åƒ"æ¢è½®èƒä¸åœè½¦"ï¼Œåœ¨ä¸ä¸­æ–­æœåŠ¡çš„æƒ…å†µä¸‹é€æ­¥æ›´æ–°åº”ç”¨

```
ä¼ ç»Ÿå‘å¸ƒ vs æ»šåŠ¨å‘å¸ƒï¼š

ä¼ ç»Ÿå‘å¸ƒï¼ˆåœæœºå‘å¸ƒï¼‰ï¼š
1. åœæ­¢æ‰€æœ‰æœåŠ¡å®ä¾‹
2. éƒ¨ç½²æ–°ç‰ˆæœ¬
3. å¯åŠ¨æ‰€æœ‰å®ä¾‹
4. ç”¨æˆ·åœ¨æ­¤æœŸé—´æ— æ³•è®¿é—®æœåŠ¡

æ»šåŠ¨å‘å¸ƒï¼š
1. å…ˆåœæ­¢éƒ¨åˆ†å®ä¾‹
2. éƒ¨ç½²æ–°ç‰ˆæœ¬åˆ°è¿™äº›å®ä¾‹
3. éªŒè¯æ–°ç‰ˆæœ¬æ­£å¸¸åç»§ç»­æ›´æ–°å…¶ä»–å®ä¾‹
4. æ•´ä¸ªè¿‡ç¨‹ä¸­å§‹ç»ˆæœ‰å®ä¾‹åœ¨æä¾›æœåŠ¡
```

### 3.2 æ»šåŠ¨å‘å¸ƒé…ç½®ç­–ç•¥

**âš™ï¸ Kubernetesæ»šåŠ¨å‘å¸ƒé…ç½®**

```yaml
# rolling-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-springboot-app
spec:
  replicas: 6                    # æ€»å…±6ä¸ªå®ä¾‹
  
  strategy:
    type: RollingUpdate          # æ»šåŠ¨æ›´æ–°ç­–ç•¥
    rollingUpdate:
      maxUnavailable: 1          # æœ€å¤š1ä¸ªå®ä¾‹ä¸å¯ç”¨ï¼ˆ16.7%ï¼‰
      maxSurge: 2                # æœ€å¤šé¢å¤–åˆ›å»º2ä¸ªå®ä¾‹
      
  selector:
    matchLabels:
      app: my-springboot-app
      
  template:
    metadata:
      labels:
        app: my-springboot-app
        version: "v2.0.0"         # æ–°ç‰ˆæœ¬æ ‡ç­¾
    spec:
      containers:
      - name: app
        image: my-company/springboot-app:v2.0.0
        ports:
        - containerPort: 8080
        
        # ä¼˜åŒ–å¯åŠ¨å’Œå…³é—­
        lifecycle:
          preStop:               # ä¼˜é›…å…³é—­
            exec:
              command: ["/bin/sh", "-c", "sleep 15"]
              
        # å°±ç»ªæ€§æ£€æŸ¥ï¼ˆé‡è¦ï¼ï¼‰
        readinessProbe:
          httpGet:
            path: /actuator/health/readiness
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 5
          timeoutSeconds: 3
          successThreshold: 1
          failureThreshold: 3
          
        # å­˜æ´»æ€§æ£€æŸ¥
        livenessProbe:
          httpGet:
            path: /actuator/health/liveness
            port: 8080
          initialDelaySeconds: 60
          periodSeconds: 30
          timeoutSeconds: 5
          failureThreshold: 3

---
# service.yaml - æœåŠ¡é…ç½®
apiVersion: v1
kind: Service
metadata:
  name: my-springboot-app-service
spec:
  selector:
    app: my-springboot-app
  ports:
  - name: http
    port: 80
    targetPort: 8080
  type: ClusterIP
```

### 3.3 å‘å¸ƒè¿‡ç¨‹ç›‘æ§

**ğŸ“Š æ»šåŠ¨å‘å¸ƒçŠ¶æ€ç›‘æ§**

```bash
# ç›‘æ§æ»šåŠ¨å‘å¸ƒè¿‡ç¨‹çš„è„šæœ¬
#!/bin/bash
# monitor-rolling-update.sh

DEPLOYMENT="my-springboot-app"
NAMESPACE="production"

echo "å¼€å§‹ç›‘æ§æ»šåŠ¨å‘å¸ƒ: $DEPLOYMENT"
echo "================================="

# æ˜¾ç¤ºå‘å¸ƒçŠ¶æ€
watch_deployment_status() {
    while true; do
        clear
        echo "=== éƒ¨ç½²çŠ¶æ€ $(date) ==="
        kubectl get deployment $DEPLOYMENT -n $NAMESPACE -o wide
        
        echo -e "\n=== PodçŠ¶æ€ ==="
        kubectl get pods -n $NAMESPACE -l app=$DEPLOYMENT -o wide
        
        echo -e "\n=== å‘å¸ƒå†å² ==="
        kubectl rollout status deployment/$DEPLOYMENT -n $NAMESPACE --timeout=300s
        
        # æ£€æŸ¥æ˜¯å¦å‘å¸ƒå®Œæˆ
        READY_REPLICAS=$(kubectl get deployment $DEPLOYMENT -n $NAMESPACE -o jsonpath='{.status.readyReplicas}')
        DESIRED_REPLICAS=$(kubectl get deployment $DEPLOYMENT -n $NAMESPACE -o jsonpath='{.spec.replicas}')
        
        if [ "$READY_REPLICAS" = "$DESIRED_REPLICAS" ]; then
            echo -e "\nâœ… æ»šåŠ¨å‘å¸ƒå®Œæˆï¼"
            break
        fi
        
        sleep 10
    done
}

# å¥åº·æ£€æŸ¥
health_check() {
    echo "æ‰§è¡Œå¥åº·æ£€æŸ¥..."
    
    # è·å–Serviceçš„ClusterIP
    SERVICE_IP=$(kubectl get service my-springboot-app-service -n $NAMESPACE -o jsonpath='{.spec.clusterIP}')
    
    # æµ‹è¯•åº”ç”¨å“åº”
    kubectl run health-checker --image=curlimages/curl:7.85.0 --rm -i --restart=Never -- \
        curl -f http://$SERVICE_IP/actuator/health
    
    if [ $? -eq 0 ]; then
        echo "âœ… å¥åº·æ£€æŸ¥é€šè¿‡"
    else
        echo "âŒ å¥åº·æ£€æŸ¥å¤±è´¥"
        return 1
    fi
}

# ä¸»æ‰§è¡Œæµç¨‹
main() {
    watch_deployment_status
    health_check
    
    echo "æ»šåŠ¨å‘å¸ƒç›‘æ§å®Œæˆ"
}

main "$@"
```

### 3.4 å‘å¸ƒå›æ»šç­–ç•¥

**ğŸ”„ å¿«é€Ÿå›æ»šæœºåˆ¶**

```bash
# å‘å¸ƒå›æ»šæ“ä½œ

# 1. æŸ¥çœ‹å‘å¸ƒå†å²
kubectl rollout history deployment/my-springboot-app -n production

# è¾“å‡ºç¤ºä¾‹ï¼š
# REVISION  CHANGE-CAUSE
# 1         Initial deployment
# 2         Update to v1.1.0  
# 3         Update to v2.0.0

# 2. æŸ¥çœ‹ç‰¹å®šç‰ˆæœ¬è¯¦æƒ…
kubectl rollout history deployment/my-springboot-app -n production --revision=2

# 3. å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬
kubectl rollout undo deployment/my-springboot-app -n production

# 4. å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬
kubectl rollout undo deployment/my-springboot-app -n production --to-revision=2

# 5. ç›‘æ§å›æ»šè¿‡ç¨‹
kubectl rollout status deployment/my-springboot-app -n production
```

**ğŸ›¡ï¸ è‡ªåŠ¨å›æ»šæœºåˆ¶**
```yaml
# è‡ªåŠ¨å›æ»šé…ç½®ï¼ˆé€šè¿‡Argo Rolloutsï¼‰
apiVersion: argoproj.io/v1alpha1
kind: Rollout
metadata:
  name: my-springboot-app-rollout
spec:
  replicas: 6
  
  strategy:
    blueGreen:              # è“ç»¿å‘å¸ƒç­–ç•¥
      autoPromotionEnabled: false
      scaleDownDelaySeconds: 30
      prePromotionAnalysis:
        templates:
        - templateName: success-rate
        args:
        - name: service-name
          value: my-springboot-app-service
          
      # è‡ªåŠ¨å›æ»šæ¡ä»¶
      abortScaleDownDelaySeconds: 30
      
  # æˆåŠŸç‡åˆ†ææ¨¡æ¿
---
apiVersion: argoproj.io/v1alpha1
kind: AnalysisTemplate
metadata:
  name: success-rate
spec:
  args:
  - name: service-name
  metrics:
  - name: success-rate
    successCondition: result[0] >= 0.95
    interval: 30s
    count: 5
    provider:
      prometheus:
        address: http://prometheus.monitoring.svc.cluster.local:9090
        query: |
          sum(rate(http_requests_total{service="{{args.service-name}}",code!~"5.."}[5m])) /
          sum(rate(http_requests_total{service="{{args.service-name}}"}[5m]))
```

---

## 4. ğŸ•¸ï¸ æœåŠ¡ç½‘æ ¼é›†æˆå®è·µ


### 4.1 ä»€ä¹ˆæ˜¯æœåŠ¡ç½‘æ ¼

ğŸ¯ **ç®€å•ç†è§£**ï¼šæœåŠ¡ç½‘æ ¼å°±åƒåŸå¸‚çš„"äº¤é€šç®¡ç†ç³»ç»Ÿ"ï¼Œè´Ÿè´£ç®¡ç†å¾®æœåŠ¡ä¹‹é—´çš„é€šä¿¡

```
æ²¡æœ‰æœåŠ¡ç½‘æ ¼çš„å¾®æœåŠ¡é€šä¿¡ï¼š
å°±åƒæ²¡æœ‰äº¤é€šä¿¡å·ç¯çš„åå­—è·¯å£
- æœåŠ¡ç›´æ¥ç›¸äº’è°ƒç”¨
- æ¯ä¸ªæœåŠ¡éƒ½è¦è‡ªå·±å¤„ç†é‡è¯•ã€é™æµã€ç›‘æ§ç­‰
- å‡ºç°é—®é¢˜éš¾ä»¥æ’æŸ¥

æœ‰äº†æœåŠ¡ç½‘æ ¼ï¼š
å°±åƒæœ‰äº†æ™ºèƒ½äº¤é€šç®¡ç†ç³»ç»Ÿ
- ç»Ÿä¸€ç®¡ç†æœåŠ¡é—´é€šä¿¡
- æä¾›æµé‡æ§åˆ¶ã€å®‰å…¨ã€ç›‘æ§ç­‰åŠŸèƒ½
- å¯¹åº”ç”¨ä»£ç é€æ˜ï¼Œæ— éœ€ä¿®æ”¹
```

### 4.2 Istioé›†æˆé…ç½®

**ğŸ”§ Spring Bootåº”ç”¨æ¥å…¥Istio**

```yaml
# 1. å¯ç”¨å‘½åç©ºé—´çš„sidecarè‡ªåŠ¨æ³¨å…¥
apiVersion: v1
kind: Namespace
metadata:
  name: production
  labels:
    istio-injection: enabled    # è‡ªåŠ¨æ³¨å…¥sidecarä»£ç†

---
# 2. Spring Bootåº”ç”¨éƒ¨ç½²é…ç½®
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-springboot-app
  namespace: production
spec:
  replicas: 3
  selector:
    matchLabels:
      app: my-springboot-app
      version: v1
  template:
    metadata:
      labels:
        app: my-springboot-app
        version: v1
      annotations:
        # Istioç›¸å…³æ³¨è§£
        sidecar.istio.io/inject: "true"
        sidecar.istio.io/rewriteAppHTTPProbers: "true"
    spec:
      containers:
      - name: app
        image: my-company/springboot-app:v1.0.0
        ports:
        - containerPort: 8080
          name: http
        
        # åº”ç”¨é…ç½®
        env:
        - name: SERVER_PORT
          value: "8080"
        - name: MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE
          value: "health,info,prometheus"
```

**ğŸŒ æœåŠ¡é€šä¿¡é…ç½®**
```yaml
# virtual-service.yaml - è™šæ‹ŸæœåŠ¡é…ç½®
apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: my-springboot-app-vs
  namespace: production
spec:
  hosts:
  - my-springboot-app
  http:
  # é‡‘ä¸é›€å‘å¸ƒé…ç½®
  - match:
    - headers:
        canary:
          exact: "true"
    route:
    - destination:
        host: my-springboot-app
        subset: v2      # æ–°ç‰ˆæœ¬
      weight: 100
      
  # é»˜è®¤æµé‡è·¯ç”±  
  - route:
    - destination:
        host: my-springboot-app
        subset: v1      # å½“å‰ç¨³å®šç‰ˆæœ¬
      weight: 90
    - destination:
        host: my-springboot-app
        subset: v2      # æ–°ç‰ˆæœ¬ï¼ˆ10%æµé‡ï¼‰
      weight: 10
      
  # æ•…éšœæ³¨å…¥ï¼ˆæµ‹è¯•ç”¨ï¼‰
  fault:
    delay:
      fixedDelay: 2s
      percentage:
        value: 0.1      # 10%çš„è¯·æ±‚å»¶è¿Ÿ2ç§’
        
---
# destination-rule.yaml - ç›®æ ‡è§„åˆ™
apiVersion: networking.istio.io/v1beta1
kind: DestinationRule
metadata:
  name: my-springboot-app-dr
  namespace: production
spec:
  host: my-springboot-app
  
  # è´Ÿè½½å‡è¡¡ç­–ç•¥
  trafficPolicy:
    loadBalancer:
      simple: LEAST_CONN    # æœ€å°‘è¿æ¥æ•°è´Ÿè½½å‡è¡¡
    connectionPool:
      tcp:
        maxConnections: 100
      http:
        http1MaxPendingRequests: 50
        maxRequestsPerConnection: 10
        
  # æœåŠ¡å­é›†å®šä¹‰
  subsets:
  - name: v1
    labels:
      version: v1
    trafficPolicy:
      circuitBreaker:
        consecutiveErrors: 5
        interval: 30s
        baseEjectionTime: 30s
        
  - name: v2
    labels:
      version: v2
```

### 4.3 æµé‡ç®¡ç†ç­–ç•¥

**ğŸš¦ æ™ºèƒ½æµé‡æ§åˆ¶**

```yaml
# rate-limit.yaml - é™æµé…ç½®
apiVersion: networking.istio.io/v1beta1
kind: EnvoyFilter
metadata:
  name: rate-limit-filter
  namespace: production
spec:
  workloadSelector:
    labels:
      app: my-springboot-app
  configPatches:
  - applyTo: HTTP_FILTER
    match:
      context: SIDECAR_INBOUND
      listener:
        filterChain:
          filter:
            name: "envoy.filters.network.http_connection_manager"
    patch:
      operation: INSERT_BEFORE
      value:
        name: envoy.filters.http.local_ratelimit
        typed_config:
          "@type": type.googleapis.com/udpa.type.v1.TypedStruct
          type_url: type.googleapis.com/envoy.extensions.filters.http.local_ratelimit.v3.LocalRateLimit
          value:
            stat_prefix: local_rate_limiter
            token_bucket:
              max_tokens: 1000      # æ¡¶å®¹é‡
              tokens_per_fill: 100  # æ¯æ¬¡å¡«å……tokenæ•°
              fill_interval: 1s     # å¡«å……é—´éš”
            filter_enabled:
              runtime_key: local_rate_limit_enabled
              default_value:
                numerator: 100
                denominator: HUNDRED
            filter_enforced:
              runtime_key: local_rate_limit_enforced  
              default_value:
                numerator: 100
                denominator: HUNDRED

---
# timeout-retry.yaml - è¶…æ—¶å’Œé‡è¯•é…ç½®
apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: my-springboot-app-timeout
spec:
  hosts:
  - my-springboot-app
  http:
  - route:
    - destination:
        host: my-springboot-app
    timeout: 10s          # è¯·æ±‚è¶…æ—¶æ—¶é—´
    retries:
      attempts: 3         # é‡è¯•æ¬¡æ•°
      perTryTimeout: 3s   # æ¯æ¬¡é‡è¯•è¶…æ—¶æ—¶é—´
      retryOn: 5xx,reset,connect-failure
```

### 4.4 å®‰å…¨ç­–ç•¥é…ç½®

**ğŸ”’ é›¶ä¿¡ä»»ç½‘ç»œå®‰å…¨**

```yaml
# peer-authentication.yaml - æœåŠ¡é—´è®¤è¯
apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication
metadata:
  name: default
  namespace: production
spec:
  mtls:
    mode: STRICT           # å¼ºåˆ¶mTLSåŠ å¯†

---
# authorization-policy.yaml - è®¿é—®æ§åˆ¶ç­–ç•¥
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: my-springboot-app-policy
  namespace: production
spec:
  selector:
    matchLabels:
      app: my-springboot-app
      
  rules:
  # å…è®¸æ¥è‡ªç½‘å…³çš„HTTPæµé‡
  - from:
    - source:
        principals: ["cluster.local/ns/istio-system/sa/istio-ingressgateway-service-account"]
    to:
    - operation:
        methods: ["GET", "POST"]
        paths: ["/api/*"]
        
  # å…è®¸å¥åº·æ£€æŸ¥
  - from:
    - source: {}
    to:
    - operation:
        methods: ["GET"]
        paths: ["/actuator/health"]
        
  # æ‹’ç»æœªæˆæƒè®¿é—®
  - from:
    - source: {}
    to:
    - operation:
        methods: ["*"]
    when:
    - key: source.ip
      notValues: ["10.0.0.0/8", "172.16.0.0/12", "192.168.0.0/16"]
    action: DENY
```

---

## 5. ğŸ”„ é…ç½®çƒ­æ›´æ–°æœºåˆ¶


### 5.1 ä¸ºä»€ä¹ˆéœ€è¦é…ç½®çƒ­æ›´æ–°

ğŸ¯ **ç®€å•ç†è§£**ï¼šé…ç½®çƒ­æ›´æ–°å°±åƒ"æ¢ç”µæ± ä¸å…³æœº"ï¼Œåœ¨ä¸é‡å¯åº”ç”¨çš„æƒ…å†µä¸‹æ›´æ–°é…ç½®

```
ä¼ ç»Ÿé…ç½®æ›´æ–° vs çƒ­æ›´æ–°ï¼š

ä¼ ç»Ÿæ–¹å¼ï¼š
1. ä¿®æ”¹é…ç½®æ–‡ä»¶
2. é‡æ–°æ‰“åŒ…é•œåƒ
3. é‡æ–°éƒ¨ç½²åº”ç”¨
4. åº”ç”¨é‡å¯ï¼ŒæœåŠ¡ä¸­æ–­å‡ åˆ†é’Ÿ

çƒ­æ›´æ–°æ–¹å¼ï¼š
1. ä¿®æ”¹å¤–éƒ¨é…ç½®
2. åº”ç”¨è‡ªåŠ¨æ„ŸçŸ¥é…ç½®å˜åŒ–
3. å®æ—¶åº”ç”¨æ–°é…ç½®
4. æœåŠ¡ä¸ä¸­æ–­ï¼Œç”¨æˆ·æ— æ„ŸçŸ¥
```

### 5.2 ConfigMapé…ç½®çƒ­æ›´æ–°

**ğŸ“ åŸºäºConfigMapçš„é…ç½®ç®¡ç†**

```yaml
# configmap.yaml - åº”ç”¨é…ç½®
apiVersion: v1
kind: ConfigMap
metadata:
  name: my-springboot-app-config
  namespace: production
data:
  application.yml: |
    server:
      port: 8080
      servlet:
        context-path: /api
    
    spring:
      datasource:
        url: jdbc:mysql://mysql:3306/myapp
        username: ${DB_USERNAME}
        password: ${DB_PASSWORD}
      
      redis:
        host: redis
        port: 6379
        timeout: 3000ms
        
    management:
      endpoints:
        web:
          exposure:
            include: "health,info,prometheus,refresh"
      endpoint:
        health:
          show-details: always
          
    # ä¸šåŠ¡é…ç½®
    app:
      feature:
        enable-new-feature: true
        max-retry-count: 3
        timeout-seconds: 30
      cache:
        ttl-minutes: 60
        max-size: 1000

---
# deployment.yaml - éƒ¨ç½²é…ç½®
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-springboot-app
spec:
  template:
    spec:
      containers:
      - name: app
        image: my-company/springboot-app:v1.0.0
        
        # ç¯å¢ƒå˜é‡
        env:
        - name: DB_USERNAME
          valueFrom:
            secretKeyRef:
              name: db-credentials
              key: username
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              name: db-credentials
              key: password
              
        # æŒ‚è½½ConfigMap
        volumeMounts:
        - name: config-volume
          mountPath: /app/config
          readOnly: true
          
        # JVMå‚æ•°æŒ‡å®šé…ç½®æ–‡ä»¶ä½ç½®
        command: ["java"]
        args: [
          "-jar", 
          "-Dspring.config.location=/app/config/application.yml",
          "-Dspring.cloud.bootstrap.enabled=true",
          "app.jar"
        ]
        
      volumes:
      - name: config-volume
        configMap:
          name: my-springboot-app-config
          items:
          - key: application.yml
            path: application.yml
```

**ğŸ”„ Spring Booté…ç½®åˆ·æ–°æœºåˆ¶**
```java
// é…ç½®ç±» - æ”¯æŒçƒ­æ›´æ–°
@Configuration
@ConfigurationProperties(prefix = "app.feature")
@RefreshScope  // é‡è¦ï¼šå¯ç”¨é…ç½®åˆ·æ–°
@Data
public class FeatureConfig {
    private boolean enableNewFeature = false;
    private int maxRetryCount = 3;
    private int timeoutSeconds = 30;
}

// ä½¿ç”¨é…ç½®çš„æœåŠ¡ç±»
@Service
@RefreshScope  // é‡è¦ï¼šç¡®ä¿é…ç½®æ›´æ–°æ—¶é‡æ–°åˆ›å»ºbean
public class BusinessService {
    
    private final FeatureConfig featureConfig;
    
    public BusinessService(FeatureConfig featureConfig) {
        this.featureConfig = featureConfig;
    }
    
    public void processRequest() {
        if (featureConfig.isEnableNewFeature()) {
            // ä½¿ç”¨æ–°åŠŸèƒ½å¤„ç†
            processWithNewFeature();
        } else {
            // ä½¿ç”¨æ—§åŠŸèƒ½å¤„ç†
            processWithOldFeature();
        }
    }
}

// é…ç½®åˆ·æ–°ç«¯ç‚¹
@RestController
public class ConfigController {
    
    @Autowired
    private RefreshEndpoint refreshEndpoint;
    
    @PostMapping("/admin/refresh")
    public Collection<String> refresh() {
        // æ‰‹åŠ¨è§¦å‘é…ç½®åˆ·æ–°
        return refreshEndpoint.refresh();
    }
}
```

### 5.3 è‡ªåŠ¨é…ç½®åˆ·æ–°å®ç°

**ğŸ¤– åŸºäºæ–‡ä»¶ç›‘æ§çš„è‡ªåŠ¨åˆ·æ–°**

```bash
# config-watcher.sh - é…ç½®æ–‡ä»¶ç›‘æ§è„šæœ¬
#!/bin/bash
CONFIG_PATH="/app/config/application.yml"
REFRESH_URL="http://localhost:8080/actuator/refresh"
CHECK_INTERVAL=5

echo "å¼€å§‹ç›‘æ§é…ç½®æ–‡ä»¶: $CONFIG_PATH"

# è®°å½•åˆå§‹æ–‡ä»¶ä¿®æ”¹æ—¶é—´
LAST_MODIFIED=$(stat -c %Y "$CONFIG_PATH" 2>/dev/null || echo 0)

while true do
    # æ£€æŸ¥æ–‡ä»¶ä¿®æ”¹æ—¶é—´
    CURRENT_MODIFIED=$(stat -c %Y "$CONFIG_PATH" 2>/dev/null || echo 0)
    
    if [ "$CURRENT_MODIFIED" -gt "$LAST_MODIFIED" ]; then
        echo "æ£€æµ‹åˆ°é…ç½®æ–‡ä»¶å˜æ›´ï¼Œè§¦å‘åˆ·æ–°..."
        
        # ç­‰å¾…æ–‡ä»¶å†™å…¥å®Œæˆ
        sleep 2
        
        # è°ƒç”¨Spring Bootåˆ·æ–°ç«¯ç‚¹
        RESPONSE=$(curl -s -X POST "$REFRESH_URL" \
                       -H "Content-Type: application/json" \
                       -w "\n%{http_code}")
        
        HTTP_CODE=$(echo "$RESPONSE" | tail -n1)
        BODY=$(echo "$RESPONSE" | sed '$d')
        
        if [ "$HTTP_CODE" = "200" ]; then
            echo "âœ… é…ç½®åˆ·æ–°æˆåŠŸ: $BODY"
            # å‘é€é€šçŸ¥
            echo "é…ç½®å·²æ›´æ–°: $(date)" | \
                mail -s "åº”ç”¨é…ç½®æ›´æ–°é€šçŸ¥" admin@company.com
        else
            echo "âŒ é…ç½®åˆ·æ–°å¤±è´¥ï¼ŒHTTPçŠ¶æ€ç : $HTTP_CODE"
        fi
        
        LAST_MODIFIED=$CURRENT_MODIFIED
    fi
    
    sleep $CHECK_INTERVAL
done
```

### 5.4 é…ç½®ä¸­å¿ƒé›†æˆ

**ğŸ—ï¸ ä¼ä¸šçº§é…ç½®ä¸­å¿ƒæ–¹æ¡ˆ**

```yaml
# spring-cloud-configé›†æˆ
apiVersion: apps/v1
kind: Deployment
metadata:
  name: config-server
spec:
  replicas: 2
  selector:
    matchLabels:
      app: config-server
  template:
    spec:
      containers:
      - name: config-server
        image: my-company/config-server:v1.0.0
        ports:
        - containerPort: 8888
        env:
        - name: SPRING_PROFILES_ACTIVE
          value: "kubernetes,git"
        - name: SPRING_CLOUD_CONFIG_SERVER_GIT_URI
          value: "https://github.com/company/config-repo.git"
        - name: SPRING_CLOUD_CONFIG_SERVER_GIT_SEARCH_PATHS
          value: "configs/{application}"

---
# å®¢æˆ·ç«¯åº”ç”¨é…ç½®
apiVersion: v1
kind: ConfigMap
metadata:
  name: bootstrap-config
data:
  bootstrap.yml: |
    spring:
      application:
        name: my-springboot-app
      cloud:
        config:
          uri: http://config-server:8888
          profile: production
          label: master
          retry:
            initial-interval: 2000
            max-attempts: 6
            max-interval: 10000
          fail-fast: true
    
    management:
      endpoints:
        web:
          exposure:
            include: "refresh,health,info"
```

**ğŸ“Š é…ç½®æ›´æ–°ç›‘æ§**
```java
// é…ç½®æ›´æ–°äº‹ä»¶ç›‘å¬
@Component
@Slf4j
public class ConfigUpdateListener {
    
    @EventListener
    public void handleRefreshEvent(RefreshScopeRefreshedEvent event) {
        log.info("é…ç½®åˆ·æ–°å®Œæˆï¼Œåˆ·æ–°çš„é…ç½®é¡¹: {}", event.getName());
        
        // è®°å½•é…ç½®å˜æ›´å†å²
        recordConfigChange(event);
        
        // å‘é€ç›‘æ§æŒ‡æ ‡
        sendMetrics(event);
    }
    
    private void recordConfigChange(RefreshScopeRefreshedEvent event) {
        // è®°å½•åˆ°æ•°æ®åº“æˆ–æ—¥å¿—ç³»ç»Ÿ
        ConfigChangeLog changeLog = ConfigChangeLog.builder()
            .timestamp(Instant.now())
            .configName(event.getName())
            .changeType("REFRESH")
            .source(event.getSource().toString())
            .build();
            
        configChangeRepository.save(changeLog);
    }
    
    private void sendMetrics(RefreshScopeRefreshedEvent event) {
        // å‘é€PrometheusæŒ‡æ ‡
        Metrics.counter("config.refresh.count", 
            "config", event.getName())
            .increment();
    }
}
```

---

## 6. ğŸ› ï¸ æ•…éšœè‡ªæ„ˆæœºåˆ¶è®¾è®¡


### 6.1 ç†è§£æ•…éšœè‡ªæ„ˆ

ğŸ¯ **ç®€å•ç†è§£**ï¼šæ•…éšœè‡ªæ„ˆå°±åƒäººä½“çš„"å…ç–«ç³»ç»Ÿ"ï¼Œèƒ½è‡ªåŠ¨è¯†åˆ«å’Œä¿®å¤é—®é¢˜

```
äººä½“å…ç–«ç³»ç»Ÿ vs åº”ç”¨è‡ªæ„ˆç³»ç»Ÿï¼š

äººä½“å…ç–«ï¼š
- è‡ªåŠ¨æ£€æµ‹ç—…æ¯’/ç»†èŒ
- å¯åŠ¨å…ç–«ååº”
- ä¿®å¤å—æŸç»„ç»‡
- è®°å½•å…ç–«è®°å¿†

åº”ç”¨è‡ªæ„ˆï¼š
- è‡ªåŠ¨æ£€æµ‹æ•…éšœ
- è§¦å‘æ¢å¤æœºåˆ¶  
- ä¿®å¤æœåŠ¡çŠ¶æ€
- è®°å½•æ•…éšœä¿¡æ¯
```

### 6.2 å¥åº·æ£€æŸ¥ä¸è‡ªåŠ¨é‡å¯

**ğŸ” å¤šå±‚æ¬¡å¥åº·æ£€æŸ¥æœºåˆ¶**

```yaml
# comprehensive-health-check.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-springboot-app
spec:
  template:
    spec:
      containers:
      - name: app
        image: my-company/springboot-app:v1.0.0
        
        # å¯åŠ¨æ¢é’ˆ - ç¡®ä¿åº”ç”¨å®Œå…¨å¯åŠ¨
        startupProbe:
          httpGet:
            path: /actuator/health/liveness
            port: 8080
          initialDelaySeconds: 30    # å¯åŠ¨å30ç§’å¼€å§‹æ£€æŸ¥
          periodSeconds: 10          # æ¯10ç§’æ£€æŸ¥ä¸€æ¬¡
          timeoutSeconds: 5          # è¶…æ—¶æ—¶é—´5ç§’
          failureThreshold: 30       # å¤±è´¥30æ¬¡æ‰åˆ¤å®šå¯åŠ¨å¤±è´¥
          successThreshold: 1        # æˆåŠŸ1æ¬¡å°±è®¤ä¸ºå¯åŠ¨å®Œæˆ
          
        # å­˜æ´»æ¢é’ˆ - æ£€æŸ¥åº”ç”¨æ˜¯å¦è¿˜æ´»ç€
        livenessProbe:
          httpGet:
            path: /actuator/health/liveness
            port: 8080
            httpHeaders:
            - name: Accept
              value: application/json
          initialDelaySeconds: 60    # å¯åŠ¨å60ç§’å¼€å§‹æ£€æŸ¥
          periodSeconds: 30          # æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡
          timeoutSeconds: 10         # è¶…æ—¶æ—¶é—´10ç§’
          failureThreshold: 3        # è¿ç»­å¤±è´¥3æ¬¡å°±é‡å¯Pod
          successThreshold: 1        # æˆåŠŸ1æ¬¡å°±æ¢å¤æ­£å¸¸
          
        # å°±ç»ªæ¢é’ˆ - æ£€æŸ¥åº”ç”¨æ˜¯å¦å‡†å¤‡å¥½æ¥æ”¶æµé‡
        readinessProbe:
          httpGet:
            path: /actuator/health/readiness
            port: 8080
          initialDelaySeconds: 20    # å¯åŠ¨å20ç§’å¼€å§‹æ£€æŸ¥
          periodSeconds: 5           # æ¯5ç§’æ£€æŸ¥ä¸€æ¬¡
          timeoutSeconds: 3          # è¶…æ—¶æ—¶é—´3ç§’
          failureThreshold: 3        # è¿ç»­å¤±è´¥3æ¬¡å°±ä»è´Ÿè½½å‡è¡¡ä¸­ç§»é™¤
          successThreshold: 1        # æˆåŠŸ1æ¬¡å°±åŠ å…¥è´Ÿè½½å‡è¡¡
          
        # ä¼˜é›…å…³é—­é…ç½®
        lifecycle:
          preStop:
            exec:
              command: ["/bin/sh", "-c", "sleep 15"]
              
        # èµ„æºé™åˆ¶
        resources:
          requests:
            memory: "512Mi"
            cpu: "250m"
          limits:
            memory: "1Gi"
            cpu: "1000m"
```

**ğŸ©º è‡ªå®šä¹‰å¥åº·æ£€æŸ¥å®ç°**
```java
// è‡ªå®šä¹‰å¥åº·æ£€æŸ¥ç»„ä»¶
@Component("customHealthIndicator")
public class CustomHealthIndicator implements HealthIndicator {
    
    private final DataSource dataSource;
    private final RedisTemplate<String, String> redisTemplate;
    
    @Override
    public Health health() {
        Health.Builder status = Health.up();
        
        // æ£€æŸ¥æ•°æ®åº“è¿æ¥
        if (!checkDatabaseHealth()) {
            status.down().withDetail("database", "æ— æ³•è¿æ¥åˆ°æ•°æ®åº“");
        }
        
        // æ£€æŸ¥Redisè¿æ¥
        if (!checkRedisHealth()) {
            status.down().withDetail("redis", "æ— æ³•è¿æ¥åˆ°Redis");
        }
        
        // æ£€æŸ¥å¤–éƒ¨APIä¾èµ–
        if (!checkExternalApiHealth()) {
            status.down().withDetail("external-api", "å¤–éƒ¨APIä¸å¯ç”¨");
        }
        
        // æ£€æŸ¥ç£ç›˜ç©ºé—´
        if (!checkDiskSpace()) {
            status.down().withDetail("disk", "ç£ç›˜ç©ºé—´ä¸è¶³");
        }
        
        return status.build();
    }
    
    private boolean checkDatabaseHealth() {
        try {
            return dataSource.getConnection().isValid(3);
        } catch (Exception e) {
            log.warn("æ•°æ®åº“å¥åº·æ£€æŸ¥å¤±è´¥: {}", e.getMessage());
            return false;
        }
    }
    
    private boolean checkRedisHealth() {
        try {
            String result = redisTemplate.execute((RedisCallback<String>) connection -> {
                return connection.ping();
            });
            return "PONG".equals(result);
        } catch (Exception e) {
            log.warn("Rediså¥åº·æ£€æŸ¥å¤±è´¥: {}", e.getMessage());
            return false;
        }
    }
}

// åˆ†å±‚å¥åº·æ£€æŸ¥é…ç½®
@Configuration
public class HealthConfig {
    
    @Bean
    @Conditional(OnProbeTypeCondition.class)
    public HealthIndicator livenessHealthIndicator(
            @Qualifier("customHealthIndicator") HealthIndicator customHealth) {
        // å­˜æ´»æ£€æŸ¥ï¼šåªæ£€æŸ¥å…³é”®ç»„ä»¶
        return () -> customHealth.health();
    }
    
    @Bean
    @Conditional(OnProbeTypeCondition.class)  
    public HealthIndicator readinessHealthIndicator(
            DataSource dataSource,
            RedisTemplate<String, String> redisTemplate) {
        // å°±ç»ªæ£€æŸ¥ï¼šæ£€æŸ¥æ‰€æœ‰ä¾èµ–
        CompositeHealthContributor.Builder builder = 
            CompositeHealthContributor.builder();
            
        builder.withDetail("db", new DbHealthIndicator(dataSource));
        builder.withDetail("redis", new RedisHealthIndicator(redisTemplate));
        
        return new CompositeHealthIndicator(builder.build());
    }
}
```

### 6.3 Circuit Breakerç†”æ–­æœºåˆ¶

**âš¡ æœåŠ¡è°ƒç”¨ä¿æŠ¤æœºåˆ¶**

```java
// ç†”æ–­å™¨é…ç½®
@Configuration
@EnableCircuitBreaker
public class CircuitBreakerConfig {
    
    @Bean
    public CircuitBreakerFactory circuitBreakerFactory() {
        CircuitBreakerConfigBuilder configBuilder = 
            CircuitBreakerConfigBuilder.create()
                .slidingWindow(100)              // æ»‘åŠ¨çª—å£å¤§å°
                .errorThresholdPercentage(50)    // é”™è¯¯ç‡é˜ˆå€¼50%
                .waitInterval(Duration.ofSeconds(30))  // ç­‰å¾…æ—¶é—´30ç§’
                .permittedCallsInHalfOpenState(10);    // åŠå¼€çŠ¶æ€å…è®¸è°ƒç”¨æ•°
                
        return CircuitBreakerFactory.create(configBuilder.build());
    }
}

// å¤–éƒ¨æœåŠ¡è°ƒç”¨ç±»
@Service
@Slf4j
public class ExternalApiService {
    
    private final CircuitBreaker circuitBreaker;
    private final WebClient webClient;
    
    public ExternalApiService(CircuitBreakerFactory circuitBreakerFactory,
                             WebClient.Builder webClientBuilder) {
        this.circuitBreaker = circuitBreakerFactory.create("external-api");
        this.webClient = webClientBuilder.build();
    }
    
    public String callExternalApi(String param) {
        return circuitBreaker.executeSupplier(() -> {
            // å®é™…çš„å¤–éƒ¨APIè°ƒç”¨
            return webClient.get()
                .uri("/api/data?param={param}", param)
                .retrieve()
                .bodyToMono(String.class)
                .timeout(Duration.ofSeconds(5))
                .block();
        });
    }
    
    // ç†”æ–­é™çº§å¤„ç†
    public String fallbackMethod(String param, Exception ex) {
        log.warn("å¤–éƒ¨APIè°ƒç”¨å¤±è´¥ï¼Œæ‰§è¡Œé™çº§ç­–ç•¥: {}", ex.getMessage());
        
        // è¿”å›ç¼“å­˜æ•°æ®æˆ–é»˜è®¤å€¼
        return getCachedDataOrDefault(param);
    }
    
    private String getCachedDataOrDefault(String param) {
        // ä»ç¼“å­˜è·å–æ•°æ®ï¼Œæˆ–è¿”å›é»˜è®¤å€¼
        return "é»˜è®¤æ•°æ®";
    }
}
```

### 6.4 è‡ªåŠ¨æ‰©ç¼©å®¹ä¸è´Ÿè½½è°ƒèŠ‚

**ğŸ“ˆ åŸºäºæŒ‡æ ‡çš„è‡ªåŠ¨è°ƒèŠ‚æœºåˆ¶**

```yaml
# vertical-pod-autoscaler.yaml - å‚ç›´æ‰©å®¹
apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  name: my-springboot-app-vpa
spec:
  targetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: my-springboot-app
    
  updatePolicy:
    updateMode: "Auto"      # è‡ªåŠ¨æ›´æ–°Podèµ„æº
    
  resourcePolicy:
    containerPolicies:
    - containerName: app
      maxAllowed:           # æœ€å¤§èµ„æºé™åˆ¶
        cpu: "2"
        memory: "4Gi"
      minAllowed:           # æœ€å°èµ„æºé™åˆ¶
        cpu: "100m"
        memory: "256Mi"
      controlledResources: ["cpu", "memory"]

---
# custom-metrics-hpa.yaml - åŸºäºè‡ªå®šä¹‰æŒ‡æ ‡çš„æ°´å¹³æ‰©å®¹
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: my-springboot-app-custom-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: my-springboot-app
    
  minReplicas: 2
  maxReplicas: 20
  
  metrics:
  # JVMå†…å­˜ä½¿ç”¨ç‡
  - type: Pods
    pods:
      metric:
        name: jvm_memory_used_ratio
      target:
        type: AverageValue
        averageValue: "70"    # JVMå†…å­˜ä½¿ç”¨ç‡è¶…è¿‡70%æ‰©å®¹
        
  # HTTPè¯·æ±‚é˜Ÿåˆ—é•¿åº¦
  - type: Pods
    pods:
      metric:
        name: http_request_queue_length
      target:
        type: AverageValue
        averageValue: "30"    # å¹³å‡é˜Ÿåˆ—é•¿åº¦è¶…è¿‡30æ‰©å®¹
        
  # æ•°æ®åº“è¿æ¥æ± ä½¿ç”¨ç‡
  - type: Pods
    pods:
      metric:
        name: db_connection_pool_usage
      target:
        type: AverageValue
        averageValue: "80"    # è¿æ¥æ± ä½¿ç”¨ç‡è¶…è¿‡80%æ‰©å®¹
        
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
      - type: Percent
        value: 100        # æ¯æ¬¡æœ€å¤šæ‰©å®¹100%ï¼ˆç¿»å€ï¼‰
        periodSeconds: 60
      - type: Pods
        value: 5          # æ¯æ¬¡æœ€å¤šå¢åŠ 5ä¸ªPod
        periodSeconds: 60
      selectPolicy: Min   # é€‰æ‹©æœ€å°çš„æ‰©å®¹é‡
      
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
      - type: Percent
        value: 10         # æ¯æ¬¡æœ€å¤šç¼©å®¹10%
        periodSeconds: 60
      selectPolicy: Max   # é€‰æ‹©æœ€å¤§çš„ç¼©å®¹é‡
```

**ğŸ¤– æ™ºèƒ½æ•…éšœæ¢å¤è„šæœ¬**
```bash
#!/bin/bash
# auto-healing.sh - è‡ªåŠ¨æ•…éšœæ¢å¤è„šæœ¬

NAMESPACE="production"
APP_NAME="my-springboot-app"
SLACK_WEBHOOK="https://hooks.slack.com/services/xxx"

# ç›‘æ§åº”ç”¨çŠ¶æ€
monitor_app_health() {
    echo "å¼€å§‹ç›‘æ§åº”ç”¨å¥åº·çŠ¶æ€..."
    
    while true; do
        # æ£€æŸ¥PodçŠ¶æ€
        FAILED_PODS=$(kubectl get pods -n $NAMESPACE -l app=$APP_NAME \
            -o jsonpath='{.items[?(@.status.phase!="Running")].metadata.name}')
        
        if [ ! -z "$FAILED_PODS" ]; then
            echo "å‘ç°å¼‚å¸¸Pod: $FAILED_PODS"
            handle_pod_failures "$FAILED_PODS"
        fi
        
        # æ£€æŸ¥åº”ç”¨å“åº”
        check_app_response
        
        # æ£€æŸ¥èµ„æºä½¿ç”¨æƒ…å†µ
        check_resource_usage
        
        sleep 30
    done
}

# å¤„ç†Podæ•…éšœ
handle_pod_failures() {
    local failed_pods=$1
    
    for pod in $failed_pods; do
        echo "å¤„ç†å¼‚å¸¸Pod: $pod"
        
        # è·å–Podè¯¦ç»†ä¿¡æ¯
        kubectl describe pod $pod -n $NAMESPACE > /tmp/${pod}_describe.txt
        kubectl logs $pod -n $NAMESPACE --tail=100 > /tmp/${pod}_logs.txt
        
        # åˆ¤æ–­æ•…éšœç±»å‹å¹¶å¤„ç†
        if kubectl get pod $pod -n $NAMESPACE -o jsonpath='{.status.phase}' | grep -q "Pending"; then
            echo "Podå¤„äºPendingçŠ¶æ€ï¼Œå¯èƒ½æ˜¯èµ„æºä¸è¶³"
            handle_resource_shortage
        elif kubectl get pod $pod -n $NAMESPACE -o jsonpath='{.status.containerStatuses[0].restartCount}' | awk '{if($1>5) exit 0; exit 1}'; then
            echo "Podé‡å¯æ¬¡æ•°è¿‡å¤šï¼Œå¯èƒ½éœ€è¦äººå·¥ä»‹å…¥"
            send_alert "Pod $pod é‡å¯æ¬¡æ•°è¿‡å¤šï¼Œéœ€è¦äººå·¥æ£€æŸ¥"
        fi
    done
}

# æ£€æŸ¥åº”ç”¨å“åº”
check_app_response() {
    local service_ip=$(kubectl get service $APP_NAME-service -n $NAMESPACE -o jsonpath='{.spec.clusterIP}')
    
    if ! kubectl run health-checker --image=curlimages/curl:7.85.0 --rm -i --restart=Never -- \
         curl -f --max-time 5 http://$service_ip/actuator/health; then
        echo "åº”ç”¨å¥åº·æ£€æŸ¥å¤±è´¥ï¼Œè§¦å‘è‡ªæ„ˆæœºåˆ¶"
        trigger_self_healing
    fi
}

# è§¦å‘è‡ªæ„ˆæœºåˆ¶
trigger_self_healing() {
    echo "å¼€å§‹æ‰§è¡Œè‡ªæ„ˆæ“ä½œ..."
    
    # 1. å°è¯•æ»šåŠ¨é‡å¯
    kubectl rollout restart deployment/$APP_NAME -n $NAMESPACE
    
    # 2. ç­‰å¾…é‡å¯å®Œæˆ
    kubectl rollout status deployment/$APP_NAME -n $NAMESPACE --timeout=300s
    
    # 3. éªŒè¯æ¢å¤çŠ¶æ€
    if check_app_recovery; then
        echo "âœ… è‡ªæ„ˆæˆåŠŸ"
        send_alert "åº”ç”¨ $APP_NAME è‡ªæ„ˆæˆåŠŸ"
    else
        echo "âŒ è‡ªæ„ˆå¤±è´¥ï¼Œéœ€è¦äººå·¥ä»‹å…¥"
        send_alert "åº”ç”¨ $APP_NAME è‡ªæ„ˆå¤±è´¥ï¼Œéœ€è¦äººå·¥ä»‹å…¥"
    fi
}

# å‘é€å‘Šè­¦
send_alert() {
    local message=$1
    
    curl -X POST $SLACK_WEBHOOK \
        -H 'Content-type: application/json' \
        --data "{\"text\":\"ğŸš¨ $message\"}"
        
    # åŒæ—¶è®°å½•åˆ°æ—¥å¿—
    echo "[$(date)] ALERT: $message" >> /var/log/auto-healing.log
}

# ä¸»æ‰§è¡Œå‡½æ•°
main() {
    echo "å¯åŠ¨åº”ç”¨è‡ªæ„ˆç›‘æ§ç³»ç»Ÿ..."
    monitor_app_health
}

main "$@"
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Dockeré•œåƒä¼˜åŒ–ï¼šå¤šé˜¶æ®µæ„å»ºã€å±‚ä¼˜åŒ–ã€å®‰å…¨é…ç½®
ğŸ”¸ K8sèµ„æºç®¡ç†ï¼šRequest/Limité…ç½®ã€é…é¢ç®¡ç†ã€è‡ªåŠ¨æ‰©ç¼©å®¹
ğŸ”¸ æ»šåŠ¨å‘å¸ƒï¼šæ— åœæœºéƒ¨ç½²ã€å¥åº·æ£€æŸ¥ã€å›æ»šæœºåˆ¶
ğŸ”¸ æœåŠ¡ç½‘æ ¼ï¼šæµé‡ç®¡ç†ã€å®‰å…¨ç­–ç•¥ã€å¯è§‚æµ‹æ€§
ğŸ”¸ é…ç½®çƒ­æ›´æ–°ï¼šConfigMapã€Spring Cloud Configã€è‡ªåŠ¨åˆ·æ–°
ğŸ”¸ æ•…éšœè‡ªæ„ˆï¼šå¥åº·æ£€æŸ¥ã€ç†”æ–­æœºåˆ¶ã€è‡ªåŠ¨æ¢å¤
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ å®¹å™¨åŒ–è¿ç»´çš„æ ¸å¿ƒä»·å€¼**
```
æ ‡å‡†åŒ–éƒ¨ç½²ï¼š
- ç¯å¢ƒä¸€è‡´æ€§ï¼šå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒå®Œå…¨ä¸€è‡´
- å¿«é€Ÿéƒ¨ç½²ï¼šé•œåƒåŒ–éƒ¨ç½²ï¼Œå‡ ç§’é’Ÿå¯åŠ¨åº”ç”¨
- ç‰ˆæœ¬ç®¡ç†ï¼šé•œåƒç‰ˆæœ¬åŒ–ï¼Œæ”¯æŒå¿«é€Ÿå›æ»š

èµ„æºé«˜æ•ˆåˆ©ç”¨ï¼š
- åŠ¨æ€è°ƒåº¦ï¼šKubernetesæ™ºèƒ½è°ƒåº¦Podåˆ°æœ€ä¼˜èŠ‚ç‚¹
- å¼¹æ€§ä¼¸ç¼©ï¼šæ ¹æ®è´Ÿè½½è‡ªåŠ¨è°ƒæ•´èµ„æºå’Œå®ä¾‹æ•°
- èµ„æºéš”ç¦»ï¼šæ¯ä¸ªåº”ç”¨ç‹¬ç«‹çš„èµ„æºç©ºé—´

è¿ç»´è‡ªåŠ¨åŒ–ï¼š
- è‡ªæ„ˆèƒ½åŠ›ï¼šæ•…éšœè‡ªåŠ¨æ£€æµ‹å’Œæ¢å¤
- ç›‘æ§å‘Šè­¦ï¼šå®Œæ•´çš„å¯è§‚æµ‹æ€§ä½“ç³»
- é…ç½®ç®¡ç†ï¼šé›†ä¸­åŒ–ã€ç‰ˆæœ¬åŒ–çš„é…ç½®ç®¡ç†
```

**ğŸ”¹ å¾®æœåŠ¡è¿ç»´çš„æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ**
```
æŒ‘æˆ˜1ï¼šæœåŠ¡é—´é€šä¿¡å¤æ‚
è§£å†³ï¼šæœåŠ¡ç½‘æ ¼æä¾›ç»Ÿä¸€çš„é€šä¿¡ç®¡ç†

æŒ‘æˆ˜2ï¼šé…ç½®ç®¡ç†å›°éš¾  
è§£å†³ï¼šé…ç½®ä¸­å¿ƒ+çƒ­æ›´æ–°æœºåˆ¶

æŒ‘æˆ˜3ï¼šæ•…éšœå®šä½å›°éš¾
è§£å†³ï¼šåˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª+é›†ä¸­æ—¥å¿—

æŒ‘æˆ˜4ï¼šç‰ˆæœ¬å‘å¸ƒé£é™©
è§£å†³ï¼šæ»šåŠ¨å‘å¸ƒ+é‡‘ä¸é›€å‘å¸ƒç­–ç•¥
```

**ğŸ”¹ ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ**
```
å®‰å…¨ç¬¬ä¸€ï¼š
- érootç”¨æˆ·è¿è¡Œå®¹å™¨
- å®šæœŸæ›´æ–°åŸºç¡€é•œåƒ
- ç½‘ç»œç­–ç•¥å’Œè®¿é—®æ§åˆ¶

æ€§èƒ½ä¼˜åŒ–ï¼š
- åˆç†çš„èµ„æºé…ç½®
- JVMå‚æ•°è°ƒä¼˜
- è¿æ¥æ± å’Œç¼“å­˜é…ç½®

å¯é æ€§ä¿è¯ï¼š
- å¤šå±‚æ¬¡å¥åº·æ£€æŸ¥
- ä¼˜é›…å¯åŠ¨å’Œå…³é—­
- æ•…éšœå¿«é€Ÿæ¢å¤æœºåˆ¶
```

### 7.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ ä¼ä¸šçº§åº”ç”¨åœºæ™¯**
- **ç”µå•†å¹³å°**ï¼šå¤§ä¿ƒæœŸé—´çš„å¼¹æ€§æ‰©ç¼©å®¹å’Œæµé‡æ²»ç†
- **é‡‘èç³»ç»Ÿ**ï¼šé«˜å¯ç”¨éƒ¨ç½²å’Œæ•…éšœå¿«é€Ÿæ¢å¤
- **åœ¨çº¿æ•™è‚²**ï¼šé…ç½®çƒ­æ›´æ–°æ”¯æŒåŠŸèƒ½å¿«é€Ÿä¸Šçº¿
- **ç‰©è”ç½‘å¹³å°**ï¼šå¾®æœåŠ¡æ¶æ„ä¸‹çš„æœåŠ¡æ²»ç†å’Œç›‘æ§

**ğŸ”§ è¿ç»´æ•ˆç‡æå‡**
- **éƒ¨ç½²æ—¶é—´**ï¼šä»å°æ—¶çº§ç¼©çŸ­åˆ°åˆ†é’Ÿçº§
- **æ•…éšœæ¢å¤**ï¼šä»äººå·¥å¤„ç†åˆ°è‡ªåŠ¨åŒ–æ¢å¤
- **èµ„æºåˆ©ç”¨ç‡**ï¼šæé«˜50%ä»¥ä¸Šçš„èµ„æºåˆ©ç”¨æ•ˆç‡
- **è¿ç»´æˆæœ¬**ï¼šå‡å°‘70%çš„äººå·¥è¿ç»´å·¥ä½œé‡

**ğŸ“ˆ ä¸šåŠ¡ä»·å€¼åˆ›é€ **
- **æœåŠ¡å¯ç”¨æ€§**ï¼š99.9%ä»¥ä¸Šçš„æœåŠ¡å¯ç”¨ç‡
- **å‘å¸ƒé¢‘ç‡**ï¼šæ”¯æŒæ¯æ—¥å¤šæ¬¡å‘å¸ƒ
- **æ•…éšœå½±å“**ï¼šå°†æ•…éšœå½±å“èŒƒå›´æ§åˆ¶åœ¨æœ€å°
- **æˆæœ¬ä¼˜åŒ–**ï¼šäº‘èµ„æºæˆæœ¬é™ä½30%-50%

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- é•œåƒä¼˜åŒ–ä½“ç§¯å°ï¼Œå¤šé˜¶æ„å»ºå®‰å…¨é«˜
- èµ„æºé…é¢è¦åˆç†ï¼Œå¼¹æ€§ä¼¸ç¼©è´Ÿè½½è°ƒ  
- æ»šåŠ¨å‘å¸ƒé›¶åœæœºï¼Œé…ç½®çƒ­æ›´ä¸é‡å¯
- æœåŠ¡ç½‘æ ¼ç®¡é€šä¿¡ï¼Œæ•…éšœè‡ªæ„ˆä¿ç¨³å®š