---
title: 3ã€ç±»å‹å®‰å…¨é…ç½®ä¸æ ¡éªŒ
---
## ğŸ“š ç›®å½•

1. [Spring Booté…ç½®åŸºç¡€æ¦‚å¿µ](#1-Spring-Booté…ç½®åŸºç¡€æ¦‚å¿µ)
2. [é…ç½®æ–‡ä»¶ç±»å‹ä¸ä¼˜å…ˆçº§ä½“ç³»](#2-é…ç½®æ–‡ä»¶ç±»å‹ä¸ä¼˜å…ˆçº§ä½“ç³»)
3. [å¤šç¯å¢ƒé…ç½®ç®¡ç†](#3-å¤šç¯å¢ƒé…ç½®ç®¡ç†)
4. [ç±»å‹å®‰å…¨é…ç½®ä¸æ ¡éªŒ](#4-ç±»å‹å®‰å…¨é…ç½®ä¸æ ¡éªŒ)
5. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#5-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”§ Spring Booté…ç½®åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯é…ç½®ç®¡ç†


**ğŸ“Œ é€šä¿—ç†è§£**
```
æƒ³è±¡ä½ å¼€äº†ä¸€å®¶è¿é”é¤å…ï¼š
â€¢ ä¸åŒåŸå¸‚çš„åˆ†åº—è¥ä¸šæ—¶é—´å¯èƒ½ä¸åŒ
â€¢ èœå“ä»·æ ¼æ ¹æ®å½“åœ°æ¶ˆè´¹æ°´å¹³è°ƒæ•´  
â€¢ é£Ÿæä¾›åº”å•†åœ¨å„åœ°éƒ½ä¸ä¸€æ ·
â€¢ ä½†èœè°±å’Œåˆ¶ä½œæµç¨‹æ˜¯ç»Ÿä¸€çš„

å¾®æœåŠ¡é…ç½®ç®¡ç†å°±åƒè¿™æ ·ï¼š
â€¢ æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä¸å˜ï¼ˆèœè°±ï¼‰
â€¢ è¿è¡Œå‚æ•°å¯ä»¥çµæ´»è°ƒæ•´ï¼ˆè¥ä¸šæ—¶é—´ã€ä»·æ ¼ï¼‰
â€¢ ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒé…ç½®ï¼ˆå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ï¼‰
```

**ğŸ¯ é…ç½®ç®¡ç†çš„æ ¸å¿ƒä»·å€¼**
- **ç¯å¢ƒéš”ç¦»**ï¼šå¼€å‘æ—¶è¿æµ‹è¯•æ•°æ®åº“ï¼Œç”Ÿäº§æ—¶è¿æ­£å¼æ•°æ®åº“
- **çµæ´»è°ƒå‚**ï¼šä¸é‡æ–°æ‰“åŒ…å°±èƒ½è°ƒæ•´è¶…æ—¶æ—¶é—´ã€ç¼“å­˜å¤§å°ç­‰
- **ç»Ÿä¸€ç®¡ç†**ï¼šæ‰€æœ‰é…ç½®é›†ä¸­å­˜æ”¾ï¼Œä¾¿äºç»´æŠ¤
- **å®‰å…¨ä¿æŠ¤**ï¼šæ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç ã€å¯†é’¥ï¼‰ç‹¬ç«‹ç®¡ç†

### 1.2 Spring Bootçš„é…ç½®å“²å­¦


**ğŸ§  è®¾è®¡æ€æƒ³ï¼šçº¦å®šä¼˜äºé…ç½®**
```
ä¼ ç»Ÿåšæ³•ï¼š
æ¯ä¸ªåŠŸèƒ½éƒ½éœ€è¦å¤§é‡XMLé…ç½®æ–‡ä»¶
å¼€å‘è€…éœ€è¦è®°ä½å„ç§é…ç½®è§„åˆ™

Spring Bootåšæ³•ï¼š  
æä¾›åˆç†çš„é»˜è®¤é…ç½®
åªæœ‰ç‰¹æ®Šéœ€æ±‚æ‰éœ€è¦è‡ªå®šä¹‰é…ç½®
```

**ğŸ’¡ é…ç½®çš„ç”Ÿå‘½å‘¨æœŸ**
```
åº”ç”¨å¯åŠ¨æµç¨‹ä¸­çš„é…ç½®åŠ è½½ï¼š

å¯åŠ¨é˜¶æ®µ     â”€â”€â†’    åŠ è½½é…ç½®    â”€â”€â†’    ç»‘å®šåˆ°Bean    â”€â”€â†’    åº”ç”¨è¿è¡Œ
  â†“                   â†“                â†“                â†“
ç¡®å®šç¯å¢ƒ          è¯»å–é…ç½®æ–‡ä»¶      @Valueæ³¨å…¥        ä½¿ç”¨é…ç½®å€¼
æ£€æŸ¥ä¼˜å…ˆçº§        è§£æå ä½ç¬¦        @ConfigurationProperties
```

---

## 2. ğŸ“‚ é…ç½®æ–‡ä»¶ç±»å‹ä¸ä¼˜å…ˆçº§ä½“ç³»


### 2.1 é…ç½®æ–‡ä»¶æ ¼å¼å¯¹æ¯”


**ğŸ“‹ å¸¸ç”¨é…ç½®æ ¼å¼**

| æ ¼å¼ç±»å‹ | **æ–‡ä»¶æ‰©å±•å** | **ç‰¹ç‚¹** | **é€‚ç”¨åœºæ™¯** |
|---------|-------------|----------|-------------|
| ğŸ”¸ **Properties** | `.properties` | `ç®€å•é”®å€¼å¯¹ï¼Œæ˜“è¯»æ˜“å†™` | `ç®€å•é…ç½®é¡¹` |
| ğŸ”¸ **YAML** | `.yml/.yaml` | `å±‚æ¬¡ç»“æ„æ¸…æ™°ï¼Œæ”¯æŒå¤æ‚æ•°æ®` | `å¤æ‚é…ç½®ç»“æ„` |
| ğŸ”¸ **JSON** | `.json` | `æ•°æ®äº¤æ¢æ ‡å‡†æ ¼å¼` | `ä¸å‰ç«¯äº¤äº’é…ç½®` |

**å®é™…é…ç½®ç¤ºä¾‹å¯¹æ¯”ï¼š**
```properties
# application.properties æ ¼å¼
server.port=8080
server.servlet.context-path=/api
database.url=jdbc:mysql://localhost:3306/mydb
database.username=root
database.password=123456
```

```yaml
# application.yml æ ¼å¼ (æ¨è)
server:
  port: 8080
  servlet:
    context-path: /api

database:
  url: jdbc:mysql://localhost:3306/mydb
  username: root
  password: 123456
```

> **ğŸ’¡ ä¸ºä»€ä¹ˆæ¨èYAMLï¼Ÿ**
> - ç»“æ„å±‚æ¬¡æ¸…æ™°ï¼Œé¿å…é‡å¤å‰ç¼€
> - æ”¯æŒåˆ—è¡¨ã€å¯¹è±¡ç­‰å¤æ‚æ•°æ®ç±»å‹
> - å¯è¯»æ€§æ›´å¥½ï¼Œç»´æŠ¤æ›´æ–¹ä¾¿

### 2.2 é…ç½®ä¼˜å…ˆçº§ä½“ç³»


**ğŸ† Spring Booté…ç½®ä¼˜å…ˆçº§ï¼ˆä»é«˜åˆ°ä½ï¼‰**
```
ä¼˜å…ˆçº§æ’åºï¼š

1ï¸âƒ£ å‘½ä»¤è¡Œå‚æ•°
   java -jar app.jar --server.port=9090

2ï¸âƒ£ ç³»ç»Ÿç¯å¢ƒå˜é‡
   export SERVER_PORT=8080

3ï¸âƒ£ application-{profile}.yml
   application-prod.yml (ç”Ÿäº§ç¯å¢ƒä¸“ç”¨)

4ï¸âƒ£ application.yml
   ä¸»é…ç½®æ–‡ä»¶

5ï¸âƒ£ @PropertySourceæ³¨è§£
   è‡ªå®šä¹‰é…ç½®æ–‡ä»¶

6ï¸âƒ£ é»˜è®¤é…ç½®
   Spring Bootå†…ç½®é»˜è®¤å€¼
```

**ğŸ” ä¼˜å…ˆçº§å®æˆ˜ç†è§£**
```yaml
# application.yml (ä¼˜å…ˆçº§ä½)
server:
  port: 8080

# application-prod.yml (ä¼˜å…ˆçº§é«˜)  
server:
  port: 9090

# å¯åŠ¨å‘½ä»¤ (ä¼˜å…ˆçº§æœ€é«˜)
java -jar app.jar --server.port=7777

# æœ€ç»ˆç»“æœï¼šåº”ç”¨è¿è¡Œåœ¨7777ç«¯å£
```

> **ğŸ¯ è®°å¿†æŠ€å·§**
> 
> è¶Š"åé¢"è®¾ç½®çš„ä¼˜å…ˆçº§è¶Šé«˜ï¼š
> - å¯åŠ¨æ—¶çš„å‘½ä»¤è¡Œå‚æ•°ï¼ˆæœ€åè®¾ç½®ï¼‰
> - ç¯å¢ƒå˜é‡ï¼ˆéƒ¨ç½²æ—¶è®¾ç½®ï¼‰  
> - ç‰¹å®šç¯å¢ƒé…ç½®ï¼ˆè¿è¡Œæ—¶ç¡®å®šï¼‰
> - é€šç”¨é…ç½®ï¼ˆå¼€å‘æ—¶å†™æ­»ï¼‰

### 2.3 é…ç½®æ–‡ä»¶ä½ç½®


**ğŸ“ Spring Booté…ç½®æ–‡ä»¶æœç´¢ä½ç½®**
```
æœç´¢é¡ºåºï¼ˆä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼‰ï¼š

1ï¸âƒ£ ./config/              (é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„configæ–‡ä»¶å¤¹)
2ï¸âƒ£ ./                     (é¡¹ç›®æ ¹ç›®å½•)  
3ï¸âƒ£ classpath:/config/      (resources/configç›®å½•)
4ï¸âƒ£ classpath:/            (resourcesæ ¹ç›®å½•)
```

**ğŸ’¼ å®é™…é¡¹ç›®ç»“æ„ç¤ºä¾‹**
```
my-microservice/
â”œâ”€â”€ src/main/resources/
â”‚   â”œâ”€â”€ application.yml              â† åŸºç¡€é…ç½®
â”‚   â”œâ”€â”€ application-dev.yml          â† å¼€å‘ç¯å¢ƒ
â”‚   â”œâ”€â”€ application-test.yml         â† æµ‹è¯•ç¯å¢ƒ
â”‚   â””â”€â”€ application-prod.yml         â† ç”Ÿäº§ç¯å¢ƒ
â”œâ”€â”€ config/
â”‚   â””â”€â”€ application.yml              â† å¤–éƒ¨é…ç½®(ä¼˜å…ˆçº§æ›´é«˜)
â””â”€â”€ target/
    â””â”€â”€ my-microservice.jar
```

---

## 3. ğŸŒ å¤šç¯å¢ƒé…ç½®ç®¡ç†


### 3.1 ç¯å¢ƒæ¦‚å¿µä¸åˆ’åˆ†


**ğŸ¢ å…¸å‹çš„ç¯å¢ƒåˆ’åˆ†**
```
å¼€å‘ç¯å¢ƒ (dev)ï¼š
â€¢ å¼€å‘äººå‘˜æœ¬åœ°ç¯å¢ƒ
â€¢ è¿æ¥å¼€å‘æ•°æ®åº“
â€¢ æ—¥å¿—çº§åˆ«ï¼šDEBUG
â€¢ åŠŸèƒ½å¼€å…³ï¼šå…¨å¼€å¯ä¾¿äºè°ƒè¯•

æµ‹è¯•ç¯å¢ƒ (test)ï¼š  
â€¢ QAå›¢é˜Ÿæµ‹è¯•ç¯å¢ƒ
â€¢ è¿æ¥æµ‹è¯•æ•°æ®åº“
â€¢ æ—¥å¿—çº§åˆ«ï¼šINFO
â€¢ æ¨¡æ‹ŸçœŸå®åœºæ™¯

é¢„å‘å¸ƒç¯å¢ƒ (staging)ï¼š
â€¢ ç”Ÿäº§ç¯å¢ƒçš„é•œåƒ
â€¢ è¿æ¥ç”Ÿäº§æ•°æ®å‰¯æœ¬
â€¢ æœ€åéªŒè¯é˜¶æ®µ

ç”Ÿäº§ç¯å¢ƒ (prod)ï¼š
â€¢ çœŸå®ç”¨æˆ·ä½¿ç”¨
â€¢ è¿æ¥ç”Ÿäº§æ•°æ®åº“  
â€¢ æ—¥å¿—çº§åˆ«ï¼šWARN/ERROR
â€¢ æ€§èƒ½å’Œç¨³å®šæ€§ä¼˜å…ˆ
```

### 3.2 Profileæœºåˆ¶è¯¦è§£


**ğŸ® Profileæ¿€æ´»æ–¹å¼**

**æ–¹å¼ä¸€ï¼šé…ç½®æ–‡ä»¶æ¿€æ´»**
```yaml
# application.yml
spring:
  profiles:
    active: dev  # æ¿€æ´»devç¯å¢ƒé…ç½®
```

**æ–¹å¼äºŒï¼šå‘½ä»¤è¡Œæ¿€æ´»**
```bash
# å¯åŠ¨æ—¶æŒ‡å®šç¯å¢ƒ
java -jar myapp.jar --spring.profiles.active=prod

# åŒæ—¶æ¿€æ´»å¤šä¸ªProfile  
java -jar myapp.jar --spring.profiles.active=prod,redis
```

**æ–¹å¼ä¸‰ï¼šç¯å¢ƒå˜é‡æ¿€æ´»**
```bash
export SPRING_PROFILES_ACTIVE=test
java -jar myapp.jar
```

### 3.3 å¤šç¯å¢ƒé…ç½®å®æˆ˜


**ğŸ“ å®é™…å¤šç¯å¢ƒé…ç½®ç¤ºä¾‹**

**åŸºç¡€é…ç½® (application.yml)**
```yaml
# æ‰€æœ‰ç¯å¢ƒé€šç”¨é…ç½®
spring:
  application:
    name: user-service
  
# é»˜è®¤é…ç½®ï¼Œå¯è¢«ç¯å¢ƒé…ç½®è¦†ç›–
server:
  port: 8080

logging:
  level:
    com.mycompany: INFO
```

**å¼€å‘ç¯å¢ƒ (application-dev.yml)**
```yaml
# å¼€å‘ç¯å¢ƒä¸“ç”¨é…ç½®
server:
  port: 8081  # é¿å…ç«¯å£å†²çª

spring:
  datasource:
    url: jdbc:mysql://localhost:3306/dev_db
    username: dev_user
    password: dev_pass
  
  # å¼€å‘æ—¶è‡ªåŠ¨åˆ›å»ºè¡¨ç»“æ„
  jpa:
    hibernate:
      ddl-auto: create-drop

# å¼€å‘æ—¶æ˜¾ç¤ºè¯¦ç»†æ—¥å¿—
logging:
  level:
    com.mycompany: DEBUG
    org.springframework.web: DEBUG
```

**ç”Ÿäº§ç¯å¢ƒ (application-prod.yml)**
```yaml
# ç”Ÿäº§ç¯å¢ƒä¸“ç”¨é…ç½®
server:
  port: 80

spring:
  datasource:
    url: jdbc:mysql://prod-db:3306/prod_db
    username: ${DB_USERNAME}  # ä»ç¯å¢ƒå˜é‡è¯»å–
    password: ${DB_PASSWORD}
    
  # ç”Ÿäº§ç¯å¢ƒä¸èƒ½è‡ªåŠ¨ä¿®æ”¹è¡¨ç»“æ„  
  jpa:
    hibernate:
      ddl-auto: validate

# ç”Ÿäº§ç¯å¢ƒåªè®°å½•é‡è¦æ—¥å¿—
logging:
  level:
    com.mycompany: WARN
    root: ERROR
```

> **ğŸ”’ å®‰å…¨æé†’**
> 
> ç”Ÿäº§ç¯å¢ƒçš„æ•æ„Ÿä¿¡æ¯ï¼ˆæ•°æ®åº“å¯†ç ã€APIå¯†é’¥ï¼‰åº”è¯¥ï¼š
> - ä½¿ç”¨ç¯å¢ƒå˜é‡ `${DB_PASSWORD}`
> - ä½¿ç”¨å¤–éƒ¨é…ç½®ä¸­å¿ƒ
> - ç»ä¸ç›´æ¥å†™åœ¨é…ç½®æ–‡ä»¶ä¸­

### 3.4 æ¡ä»¶åŒ–é…ç½®


**ğŸ›ï¸ æ ¹æ®Profileæ¡ä»¶åŠ è½½Bean**

```java
@Configuration
public class DatabaseConfig {
    
    // åªåœ¨å¼€å‘ç¯å¢ƒç”Ÿæ•ˆ
    @Bean
    @Profile("dev")
    public DataSource devDataSource() {
        return new EmbeddedDatabaseBuilder()
            .setType(EmbeddedDatabaseType.H2)
            .build();
    }
    
    // åªåœ¨ç”Ÿäº§ç¯å¢ƒç”Ÿæ•ˆ  
    @Bean
    @Profile("prod")
    public DataSource prodDataSource() {
        HikariConfig config = new HikariConfig();
        config.setJdbcUrl("jdbc:mysql://prod-server:3306/db");
        return new HikariDataSource(config);
    }
}
```

**ğŸ“Š Profileç»„åˆä½¿ç”¨**
```yaml
# å¯ä»¥åŒæ—¶æ¿€æ´»å¤šä¸ªProfile
spring:
  profiles:
    active: prod,redis,monitoring

# ä¸åŒProfileè´Ÿè´£ä¸åŒåŠŸèƒ½æ¨¡å—ï¼š
# prod: ç”Ÿäº§ç¯å¢ƒåŸºç¡€é…ç½®
# redis: Redisç¼“å­˜ç›¸å…³é…ç½®  
# monitoring: ç›‘æ§ç›¸å…³é…ç½®
```

---

## 4. ğŸ” ç±»å‹å®‰å…¨é…ç½®ä¸æ ¡éªŒ


### 4.1 ä¼ ç»Ÿ@Valueæ³¨è§£çš„é—®é¢˜


**âŒ ä¼ ç»Ÿæ–¹å¼çš„ç¼ºç‚¹**
```java
// ä½¿ç”¨@Valueæ³¨è§£çš„ä¼ ç»Ÿæ–¹å¼
@Service
public class UserService {
    
    @Value("${app.user.max-age}")
    private int maxAge;              // ç±»å‹ä¸å®‰å…¨
    
    @Value("${app.user.name:defaultUser}")  
    private String defaultName;      // éš¾ä»¥ç®¡ç†
    
    @Value("${app.user.enabled}")
    private boolean enabled;         // æ•£å¸ƒåœ¨å„ä¸ªç±»ä¸­
}
```

**é—®é¢˜åˆ†æï¼š**
- **ç±»å‹ä¸å®‰å…¨**ï¼šé…ç½®é”™è¯¯åªåœ¨è¿è¡Œæ—¶å‘ç°
- **éš¾ä»¥ç®¡ç†**ï¼šé…ç½®åˆ†æ•£åœ¨å„ä¸ªç±»ä¸­
- **æ— æ³•æ ¡éªŒ**ï¼šä¸èƒ½éªŒè¯é…ç½®å€¼çš„åˆæ³•æ€§
- **IDEæ”¯æŒå·®**ï¼šæ²¡æœ‰è‡ªåŠ¨æç¤ºå’Œè¡¥å…¨

### 4.2 @ConfigurationPropertiesç±»å‹å®‰å…¨ç»‘å®š


**âœ… æ¨èçš„ç±»å‹å®‰å…¨æ–¹å¼**

**æ­¥éª¤1ï¼šåˆ›å»ºé…ç½®ç±»**
```java
@ConfigurationProperties(prefix = "app.user")
@Data  // Lombokç”Ÿæˆgetter/setter
@Component
public class UserConfigProperties {
    
    /**
     * ç”¨æˆ·æœ€å¤§å¹´é¾„é™åˆ¶
     */
    private Integer maxAge = 120;
    
    /**
     * é»˜è®¤ç”¨æˆ·å
     */
    private String defaultName = "anonymous";
    
    /**
     * æ˜¯å¦å¯ç”¨ç”¨æˆ·åŠŸèƒ½
     */
    private Boolean enabled = true;
    
    /**
     * ç”¨æˆ·è§’è‰²åˆ—è¡¨
     */
    private List<String> roles = new ArrayList<>();
    
    /**
     * æ•°æ®åº“è¿æ¥é…ç½®
     */
    private DatabaseConfig database = new DatabaseConfig();
    
    @Data
    public static class DatabaseConfig {
        private String url;
        private String username;
        private String password;
        private Integer maxConnections = 10;
    }
}
```

**æ­¥éª¤2ï¼šé…ç½®æ–‡ä»¶**
```yaml
app:
  user:
    max-age: 150
    default-name: "guest"
    enabled: true
    roles:
      - "USER"
      - "ADMIN"
    database:
      url: "jdbc:mysql://localhost:3306/mydb"
      username: "dbuser"  
      password: "dbpass"
      max-connections: 20
```

**æ­¥éª¤3ï¼šä½¿ç”¨é…ç½®**
```java
@Service
public class UserService {
    
    private final UserConfigProperties config;
    
    // æ„é€ å™¨æ³¨å…¥ï¼Œç±»å‹å®‰å…¨
    public UserService(UserConfigProperties config) {
        this.config = config;
    }
    
    public boolean isValidAge(int age) {
        return age >= 0 && age <= config.getMaxAge();
    }
    
    public String getDefaultUserName() {
        return config.getDefaultName();
    }
}
```

### 4.3 é…ç½®æ ¡éªŒæœºåˆ¶


**ğŸ” æ·»åŠ æ ¡éªŒæ³¨è§£**

**æ­¥éª¤1ï¼šæ·»åŠ æ ¡éªŒä¾èµ–**
```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-validation</artifactId>
</dependency>
```

**æ­¥éª¤2ï¼šé…ç½®ç±»æ·»åŠ æ ¡éªŒ**
```java
@ConfigurationProperties(prefix = "app.user")
@Validated  // å¯ç”¨æ ¡éªŒ
@Data
@Component
public class UserConfigProperties {
    
    /**
     * ç”¨æˆ·æœ€å¤§å¹´é¾„ï¼Œå¿…é¡»åœ¨1-150ä¹‹é—´
     */
    @Min(value = 1, message = "æœ€å¤§å¹´é¾„å¿…é¡»å¤§äº0")
    @Max(value = 150, message = "æœ€å¤§å¹´é¾„ä¸èƒ½è¶…è¿‡150")
    @NotNull(message = "æœ€å¤§å¹´é¾„ä¸èƒ½ä¸ºç©º")
    private Integer maxAge;
    
    /**
     * é»˜è®¤ç”¨æˆ·åï¼Œä¸èƒ½ä¸ºç©ºä¸”é•¿åº¦2-20
     */
    @NotBlank(message = "é»˜è®¤ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @Size(min = 2, max = 20, message = "ç”¨æˆ·åé•¿åº¦å¿…é¡»åœ¨2-20ä¹‹é—´")
    private String defaultName;
    
    /**
     * é‚®ç®±æ ¼å¼æ ¡éªŒ
     */
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String adminEmail;
    
    /**
     * è§’è‰²åˆ—è¡¨ä¸èƒ½ä¸ºç©º
     */
    @NotEmpty(message = "è§’è‰²åˆ—è¡¨ä¸èƒ½ä¸ºç©º")
    private List<@NotBlank String> roles;
    
    /**
     * åµŒå¥—å¯¹è±¡æ ¡éªŒ
     */
    @Valid
    @NotNull
    private DatabaseConfig database;
    
    @Data
    public static class DatabaseConfig {
        
        @NotBlank(message = "æ•°æ®åº“URLä¸èƒ½ä¸ºç©º")
        @Pattern(regexp = "jdbc:.*", message = "æ•°æ®åº“URLæ ¼å¼ä¸æ­£ç¡®")
        private String url;
        
        @NotBlank(message = "æ•°æ®åº“ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
        private String username;
        
        @NotBlank(message = "æ•°æ®åº“å¯†ç ä¸èƒ½ä¸ºç©º")
        @Size(min = 6, message = "æ•°æ®åº“å¯†ç è‡³å°‘6ä½")
        private String password;
        
        @Min(value = 1, message = "æœ€å¤§è¿æ¥æ•°è‡³å°‘ä¸º1")
        @Max(value = 100, message = "æœ€å¤§è¿æ¥æ•°ä¸èƒ½è¶…è¿‡100")
        private Integer maxConnections = 10;
    }
}
```

### 4.4 è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™


**ğŸ› ï¸ åˆ›å»ºè‡ªå®šä¹‰æ ¡éªŒæ³¨è§£**

```java
// è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£
@Target({ElementType.FIELD})
@Retention(RetentionPolicy.RUNTIME)
@Constraint(validatedBy = DatabaseUrlValidator.class)
public @interface ValidDatabaseUrl {
    
    String message() default "æ•°æ®åº“URLæ ¼å¼ä¸æ­£ç¡®";
    
    Class<?>[] groups() default {};
    
    Class<? extends Payload>[] payload() default {};
}

// æ ¡éªŒå™¨å®ç°
public class DatabaseUrlValidator implements ConstraintValidator<ValidDatabaseUrl, String> {
    
    private static final List<String> SUPPORTED_DATABASES = 
        Arrays.asList("mysql", "postgresql", "h2", "oracle");
    
    @Override
    public boolean isValid(String url, ConstraintValidatorContext context) {
        if (url == null || url.trim().isEmpty()) {
            return false;
        }
        
        // æ£€æŸ¥æ˜¯å¦æ˜¯æ”¯æŒçš„æ•°æ®åº“ç±»å‹
        return SUPPORTED_DATABASES.stream()
            .anyMatch(db -> url.contains(":" + db + ":"));
    }
}

// ä½¿ç”¨è‡ªå®šä¹‰æ ¡éªŒ
@Data
public static class DatabaseConfig {
    
    @ValidDatabaseUrl(message = "è¯·ä½¿ç”¨æ”¯æŒçš„æ•°æ®åº“ç±»å‹: MySQL, PostgreSQL, H2, Oracle")
    private String url;
}
```

### 4.5 é…ç½®ç»‘å®šå¤±è´¥å¤„ç†


**âš ï¸ ç»‘å®šå¤±è´¥å¤„ç†æœºåˆ¶**

```java
@ConfigurationProperties(prefix = "app.user")
@Validated
@Data
@Component
public class UserConfigProperties {
    
    // è®¾ç½®é»˜è®¤å€¼ï¼Œé¿å…ç»‘å®šå¤±è´¥
    private Integer maxAge = 120;
    
    // ä½¿ç”¨@DefaultValueæ³¨è§£ (Spring Boot 2.2+)
    @DefaultValue("guest")
    private String defaultName;
    
    // å¤æ‚é»˜è®¤å€¼è®¾ç½®
    @PostConstruct
    public void initDefaults() {
        if (roles == null || roles.isEmpty()) {
            roles = Arrays.asList("USER");
        }
    }
}
```

**è‡ªå®šä¹‰ç»‘å®šå¤±è´¥å¤„ç†ï¼š**
```java
@Component
public class ConfigurationBindingFailureHandler {
    
    @EventListener
    public void handleBindingFailure(ApplicationFailedEvent event) {
        Throwable exception = event.getException();
        
        if (exception instanceof BindException) {
            BindException bindException = (BindException) exception;
            
            System.err.println("é…ç½®ç»‘å®šå¤±è´¥è¯¦æƒ…ï¼š");
            bindException.getBindingResult().getAllErrors()
                .forEach(error -> System.err.println("- " + error.getDefaultMessage()));
        }
    }
}
```

**ğŸ“‹ é…ç½®ç»‘å®šæœ€ä½³å®è·µ**
```
âœ… ä½¿ç”¨@ConfigurationPropertiesæ›¿ä»£@Value
âœ… ä¸ºæ‰€æœ‰é…ç½®é¡¹è®¾ç½®åˆç†é»˜è®¤å€¼
âœ… æ·»åŠ @Validatedå’Œæ ¡éªŒæ³¨è§£
âœ… ä½¿ç”¨åµŒå¥—ç±»ç»„ç»‡ç›¸å…³é…ç½®
âœ… ä¸ºé…ç½®ç±»ç¼–å†™å•å…ƒæµ‹è¯•
âœ… åœ¨IDEä¸­å®‰è£…Spring Booté…ç½®æç¤ºæ’ä»¶
```

---

## 5. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 5.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ é…ç½®ç®¡ç†æœ¬è´¨ï¼šå°†å¯å˜å‚æ•°ä»ä»£ç ä¸­åˆ†ç¦»ï¼Œå®ç°ç¯å¢ƒéš”ç¦»
ğŸ”¸ ä¼˜å…ˆçº§ä½“ç³»ï¼šå‘½ä»¤è¡Œ > ç¯å¢ƒå˜é‡ > Profileé…ç½® > é»˜è®¤é…ç½®
ğŸ”¸ å¤šç¯å¢ƒæœºåˆ¶ï¼šé€šè¿‡Profileå®ç°å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒé…ç½®åˆ†ç¦»
ğŸ”¸ ç±»å‹å®‰å…¨é…ç½®ï¼šä½¿ç”¨@ConfigurationPropertiesæ›¿ä»£@Value
ğŸ”¸ é…ç½®æ ¡éªŒï¼šé€šè¿‡@Validatedå’Œæ ¡éªŒæ³¨è§£ç¡®ä¿é…ç½®æ­£ç¡®æ€§
```

### 5.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆéœ€è¦é…ç½®ç®¡ç†**
```
è§£å†³çš„æ ¸å¿ƒé—®é¢˜ï¼š
â€¢ ä¸åŒç¯å¢ƒéœ€è¦ä¸åŒå‚æ•°ï¼ˆæ•°æ®åº“åœ°å€ã€æ—¥å¿—çº§åˆ«ï¼‰
â€¢ è¿è¡Œæ—¶å‚æ•°è°ƒæ•´ä¸éœ€è¦é‡æ–°ç¼–è¯‘ä»£ç   
â€¢ æ•æ„Ÿä¿¡æ¯å®‰å…¨ç®¡ç†ï¼ˆå¯†ç ã€å¯†é’¥ï¼‰
â€¢ å›¢é˜Ÿåä½œä¸­çš„é…ç½®ä¸€è‡´æ€§
```

**ğŸ”¹ é…ç½®ä¼˜å…ˆçº§çš„è®¾è®¡é€»è¾‘**
```
è®¾è®¡åŸåˆ™ï¼šè¶Šæ™šè®¾ç½®çš„ä¼˜å…ˆçº§è¶Šé«˜
â€¢ å¼€å‘æ—¶ï¼šå†™åœ¨é…ç½®æ–‡ä»¶ä¸­
â€¢ éƒ¨ç½²æ—¶ï¼šé€šè¿‡ç¯å¢ƒå˜é‡è°ƒæ•´
â€¢ è¿è¡Œæ—¶ï¼šé€šè¿‡å‘½ä»¤è¡Œå‚æ•°è¦†ç›–

è¿™æ ·è®¾è®¡è®©é…ç½®æ—¢æœ‰é»˜è®¤å€¼ï¼Œåˆèƒ½çµæ´»è°ƒæ•´
```

**ğŸ”¹ ç±»å‹å®‰å…¨é…ç½®çš„ä¼˜åŠ¿**
```
@ConfigurationProperties vs @Valueï¼š
â€¢ ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥ vs è¿è¡Œæ—¶é”™è¯¯
â€¢ é›†ä¸­ç®¡ç†é…ç½® vs åˆ†æ•£åœ¨å„å¤„
â€¢ IDEæ™ºèƒ½æç¤º vs æ‰‹å·¥è¾“å…¥
â€¢ æ”¯æŒå¤æ‚å¯¹è±¡ vs åªæ”¯æŒç®€å•ç±»å‹
â€¢ å¯ä»¥æ ¡éªŒ vs æ— æ³•æ ¡éªŒ
```

### 5.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ å¼€å‘é˜¶æ®µåº”ç”¨**
- **æœ¬åœ°å¼€å‘**ï¼šä½¿ç”¨dev Profileï¼Œè¿æ¥æœ¬åœ°æ•°æ®åº“
- **å›¢é˜Ÿåä½œ**ï¼šç»Ÿä¸€é…ç½®æ ¼å¼ï¼Œé¿å…ç¯å¢ƒå·®å¼‚é—®é¢˜
- **è°ƒè¯•ä¼˜åŒ–**ï¼šé€šè¿‡é…ç½®è°ƒæ•´æ—¥å¿—çº§åˆ«ã€è¶…æ—¶å‚æ•°

**ğŸš€ éƒ¨ç½²è¿ç»´åº”ç”¨**
- **ç¯å¢ƒéƒ¨ç½²**ï¼šä¸€å¥—ä»£ç ï¼Œå¤šå¥—ç¯å¢ƒé…ç½®
- **å‚æ•°è°ƒä¼˜**ï¼šä¸åœæœè°ƒæ•´ç¼“å­˜å¤§å°ã€è¿æ¥æ± å‚æ•°
- **æ•…éšœå¤„ç†**ï¼šå¿«é€Ÿè°ƒæ•´æ—¥å¿—çº§åˆ«å®šä½é—®é¢˜

**ğŸ”§ æœ€ä½³å®è·µå»ºè®®**
```
é…ç½®æ–‡ä»¶ç»„ç»‡ï¼š
â€¢ åŸºç¡€é…ç½®æ”¾åœ¨application.yml
â€¢ ç¯å¢ƒç‰¹å®šé…ç½®æ”¾åœ¨application-{profile}.yml  
â€¢ æ•æ„Ÿé…ç½®é€šè¿‡ç¯å¢ƒå˜é‡ä¼ é€’

é…ç½®ç±»è®¾è®¡ï¼š
â€¢ æŒ‰åŠŸèƒ½æ¨¡å—åˆ†ç»„ï¼ˆdatabaseã€redisã€securityï¼‰
â€¢ è®¾ç½®åˆç†é»˜è®¤å€¼
â€¢ æ·»åŠ å¿…è¦çš„æ ¡éªŒè§„åˆ™
â€¢ ç¼–å†™é…ç½®æ–‡æ¡£å’Œæ³¨é‡Š

éƒ¨ç½²è¿ç»´ï¼š
â€¢ ç”Ÿäº§ç¯å¢ƒä½¿ç”¨å¤–éƒ¨é…ç½®æ–‡ä»¶
â€¢ é…ç½®å˜æ›´è¦æœ‰å®¡æ ¸æµç¨‹
â€¢ å®šæœŸå¤‡ä»½é‡è¦é…ç½®
â€¢ ç›‘æ§é…ç½®æ–‡ä»¶å˜åŒ–
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
ğŸ§  é…ç½®ç®¡ç†ä¸‰è¦ç´ ï¼š
"ä¼˜å…ˆçº§ã€å¤šç¯å¢ƒã€ç±»å‹å®‰å…¨"

ğŸ¯ å®è·µå››æ­¥éª¤ï¼š  
"å»ºç±»ã€å†™é…ç½®ã€åŠ æ ¡éªŒã€æµ‹éªŒè¯"

ğŸ” å®‰å…¨ä¸‰åŸåˆ™ï¼š
"åˆ†ç¦»æ•æ„Ÿã€ç¯å¢ƒå˜é‡ã€æƒé™æ§åˆ¶"
```