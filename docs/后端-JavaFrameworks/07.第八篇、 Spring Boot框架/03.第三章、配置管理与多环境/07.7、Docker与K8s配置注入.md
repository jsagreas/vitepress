---
title: 7ã€Dockerä¸K8sé…ç½®æ³¨å…¥
---
## ğŸ“š ç›®å½•


1. [Dockerä¸K8sé…ç½®æ³¨å…¥åŸºç¡€](#1-Dockerä¸K8sé…ç½®æ³¨å…¥åŸºç¡€)
2. [ç¯å¢ƒå˜é‡é…ç½®æ³¨å…¥](#2-ç¯å¢ƒå˜é‡é…ç½®æ³¨å…¥)
3. [ConfigMapé…ç½®æ˜ å°„](#3-ConfigMapé…ç½®æ˜ å°„)
4. [Secretå¯†é’¥å®‰å…¨æ³¨å…¥](#4-Secretå¯†é’¥å®‰å…¨æ³¨å…¥)
5. [VolumeæŒ‚è½½é…ç½®](#5-VolumeæŒ‚è½½é…ç½®)
6. [ç«¯å£ä¸æ¢é’ˆé…ç½®](#6-ç«¯å£ä¸æ¢é’ˆé…ç½®)
7. [å®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†](#7-å®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

# 1. ğŸ³ Dockerä¸K8sé…ç½®æ³¨å…¥åŸºç¡€



## 1.1 ä»€ä¹ˆæ˜¯é…ç½®æ³¨å…¥



**ç®€å•ç†è§£**ï¼šå°±æ˜¯æŠŠæˆ‘ä»¬çš„åº”ç”¨é…ç½®ï¼ˆæ¯”å¦‚æ•°æ®åº“è¿æ¥ä¿¡æ¯ã€ç«¯å£å·ç­‰ï¼‰ä»å¤–éƒ¨ä¼ é€’ç»™å®¹å™¨å†…çš„ç¨‹åºã€‚

```
ä¼ ç»Ÿæ–¹å¼ï¼šé…ç½®å†™åœ¨ä»£ç é‡Œ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Javaåº”ç”¨ç¨‹åº    â”‚
â”‚ â”œâ”€â”€ application.yml â”‚ â† é…ç½®å†™æ­»åœ¨ä»£ç ä¸­
â”‚ â””â”€â”€ å…¶ä»–ä»£ç      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å®¹å™¨åŒ–æ–¹å¼ï¼šé…ç½®ä»å¤–éƒ¨æ³¨å…¥
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    å¤–éƒ¨é…ç½®      â”‚â”€â”€â”€â–¶â”‚  Javaåº”ç”¨ç¨‹åº    â”‚
â”‚ â€¢ ç¯å¢ƒå˜é‡       â”‚    â”‚ â€¢ åŠ¨æ€è¯»å–é…ç½®   â”‚
â”‚ â€¢ é…ç½®æ–‡ä»¶       â”‚    â”‚ â€¢ ä¸€å¥—ä»£ç å¤šç¯å¢ƒ â”‚
â”‚ â€¢ K8s ConfigMap â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¸ºä»€ä¹ˆè¦é…ç½®æ³¨å…¥ï¼Ÿ**
- ğŸ”¸ **ä¸€å¥—ä»£ç ï¼Œå¤šä¸ªç¯å¢ƒ**ï¼šå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç”¨åŒä¸€å¥—ä»£ç 
- ğŸ”¸ **å®‰å…¨æ€§æ›´å¥½**ï¼šå¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ä¸å†™åœ¨ä»£ç é‡Œ
- ğŸ”¸ **çµæ´»éƒ¨ç½²**ï¼šä¸åŒç¯å¢ƒå¯ä»¥æœ‰ä¸åŒçš„é…ç½®

## 1.2 é…ç½®æ³¨å…¥çš„å‡ ç§æ–¹å¼



| æ–¹å¼ | **é€‚ç”¨åœºæ™¯** | **ä¼˜ç‚¹** | **ç¼ºç‚¹** |
|------|------------|---------|---------|
| ç¯å¢ƒå˜é‡ | `ç®€å•é…ç½®é¡¹` | ä½¿ç”¨ç®€å•ï¼ŒDockeråŸç”Ÿæ”¯æŒ | ä¸é€‚åˆå¤æ‚é…ç½® |
| ConfigMap | `å¤æ‚é…ç½®æ–‡ä»¶` | æ”¯æŒé…ç½®æ–‡ä»¶ï¼ŒK8såŸç”Ÿ | éœ€è¦K8sç¯å¢ƒ |
| Secret | `æ•æ„Ÿä¿¡æ¯` | åŠ å¯†å­˜å‚¨ï¼Œå®‰å…¨æ€§å¥½ | åªèƒ½å­˜å‚¨æ•æ„Ÿæ•°æ® |
| VolumeæŒ‚è½½ | `å¤§é…ç½®æ–‡ä»¶` | æ”¯æŒä»»æ„æ–‡ä»¶ï¼Œçµæ´»æ€§é«˜ | é…ç½®å¤æ‚ |

---

# 2. ğŸŒ ç¯å¢ƒå˜é‡é…ç½®æ³¨å…¥



## 2.1 SPRING_APPLICATION_JSONçš„ä½¿ç”¨



**ä»€ä¹ˆæ˜¯SPRING_APPLICATION_JSONï¼Ÿ**
è¿™æ˜¯Spring Bootæä¾›çš„ä¸€ä¸ªç‰¹æ®Šç¯å¢ƒå˜é‡ï¼Œå¯ä»¥è®©æˆ‘ä»¬ç”¨JSONæ ¼å¼æ¥è®¾ç½®é…ç½®é¡¹ã€‚

**ç®€å•å¯¹æ¯”ç†è§£**ï¼š
```yaml
# ä¼ ç»Ÿapplication.ymlæ–¹å¼

server:
  port: 8080
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/mydb
    username: root
    password: 123456
```

```bash
# ç”¨SPRING_APPLICATION_JSONæ–¹å¼

SPRING_APPLICATION_JSON='{"server.port":8080,"spring.datasource.url":"jdbc:mysql://localhost:3306/mydb","spring.datasource.username":"root","spring.datasource.password":"123456"}'
```

## 2.2 Dockerä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡



**Dockerfileæ–¹å¼**ï¼š
```dockerfile
FROM openjdk:17-jre-slim

# è®¾ç½®å·¥ä½œç›®å½•

WORKDIR /app

# å¤åˆ¶jaråŒ…

COPY target/my-app.jar app.jar

# è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆè¿™ç§æ˜¯é»˜è®¤å€¼ï¼‰

ENV SERVER_PORT=8080
ENV SPRING_PROFILES_ACTIVE=dev

# å¯åŠ¨å‘½ä»¤

ENTRYPOINT ["java", "-jar", "app.jar"]
```

**docker runå‘½ä»¤æ–¹å¼**ï¼š
```bash
# å•ä¸ªç¯å¢ƒå˜é‡

docker run -e SERVER_PORT=9090 -e DB_HOST=mysql-server my-app

# ä½¿ç”¨SPRING_APPLICATION_JSON

docker run -e SPRING_APPLICATION_JSON='{"server.port":9090,"spring.datasource.url":"jdbc:mysql://mysql-server:3306/mydb"}' my-app
```

## 2.3 Spring Bootä¸­è¯»å–ç¯å¢ƒå˜é‡



**Javaåº”ç”¨å¦‚ä½•è¯»å–ï¼Ÿ**
Spring Bootä¼šè‡ªåŠ¨è¯»å–ç¯å¢ƒå˜é‡ï¼Œä½†æœ‰ä¸€äº›è§„åˆ™ï¼š

```yaml
# application.ymlä¸­å¯ä»¥è¿™æ ·å¼•ç”¨ç¯å¢ƒå˜é‡

server:
  port: ${SERVER_PORT:8080}  # å¦‚æœæ²¡æœ‰SERVER_PORTç¯å¢ƒå˜é‡ï¼Œé»˜è®¤8080

spring:
  datasource:
    url: ${DB_URL:jdbc:h2:mem:testdb}
    username: ${DB_USERNAME:sa}
    password: ${DB_PASSWORD:}
```

**ç¯å¢ƒå˜é‡å‘½åè§„åˆ™**ï¼š
- `server.port` â†’ `SERVER_PORT`
- `spring.datasource.url` â†’ `SPRING_DATASOURCE_URL`
- ç”¨ä¸‹åˆ’çº¿æ›¿æ¢ç‚¹å·ï¼Œå…¨å¤§å†™

---

# 3. ğŸ“‹ ConfigMapé…ç½®æ˜ å°„



## 3.1 ä»€ä¹ˆæ˜¯ConfigMap



**é€šä¿—è§£é‡Š**ï¼šConfigMapå°±åƒæ˜¯Kubernetesçš„"é…ç½®æ–‡ä»¶æŸœ"ï¼Œä½ å¯ä»¥æŠŠé…ç½®æ–‡ä»¶æ”¾è¿›å»ï¼Œç„¶åå‘Šè¯‰Podå»è¿™ä¸ªæŸœå­é‡Œæ‹¿é…ç½®ã€‚

```
æ²¡æœ‰ConfigMapçš„æ—¶å€™ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pod1   â”‚  â”‚  Pod2   â”‚  â”‚  Pod3   â”‚
â”‚ é…ç½®A    â”‚  â”‚ é…ç½®A    â”‚  â”‚ é…ç½®A    â”‚  â† æ¯ä¸ªPodéƒ½è¦å•ç‹¬é…ç½®
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æœ‰ConfigMapçš„æ—¶å€™ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pod1   â”‚  â”‚  Pod2   â”‚  â”‚  Pod3   â”‚
â”‚  â†“å¼•ç”¨  â”‚  â”‚  â†“å¼•ç”¨  â”‚  â”‚  â†“å¼•ç”¨  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   ConfigMap     â”‚  â† ç»Ÿä¸€ç®¡ç†é…ç½®
              â”‚    é…ç½®A        â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 3.2 åˆ›å»ºConfigMap



**æ–¹å¼1ï¼šä»æ–‡ä»¶åˆ›å»º**
```bash
# å‡è®¾ä½ æœ‰ä¸€ä¸ªapplication.ymlæ–‡ä»¶

kubectl create configmap app-config --from-file=application.yml
```

**æ–¹å¼2ï¼šä»YAMLå®šä¹‰åˆ›å»º**
```yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
  namespace: default
data:
  application.yml: |
    server:
      port: 8080
    spring:
      datasource:
        url: jdbc:mysql://mysql-service:3306/mydb
        username: myuser
    logging:
      level:
        com.example: DEBUG
  database.properties: |
    db.pool.max=20
    db.timeout=30
```

## 3.3 åœ¨Podä¸­ä½¿ç”¨ConfigMap



**æ–¹å¼1ï¼šä½œä¸ºç¯å¢ƒå˜é‡ä½¿ç”¨**
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: my-app
spec:
  containers:
  - name: app
    image: my-java-app:latest
    envFrom:
    - configMapRef:
        name: app-config  # æŠŠConfigMapä¸­çš„æ‰€æœ‰é”®å€¼å¯¹ä½œä¸ºç¯å¢ƒå˜é‡
```

**æ–¹å¼2ï¼šä½œä¸ºæ–‡ä»¶æŒ‚è½½**
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: my-app
spec:
  containers:
  - name: app
    image: my-java-app:latest
    volumeMounts:
    - name: config-volume
      mountPath: /app/config  # é…ç½®æ–‡ä»¶ä¼šå‡ºç°åœ¨å®¹å™¨çš„è¿™ä¸ªç›®å½•ä¸‹
  volumes:
  - name: config-volume
    configMap:
      name: app-config
```

**æŒ‚è½½åçš„æ•ˆæœ**ï¼š
```
å®¹å™¨å†…éƒ¨æ–‡ä»¶ç»“æ„ï¼š
/app/config/
â”œâ”€â”€ application.yml     â† ConfigMapä¸­çš„application.yml
â””â”€â”€ database.properties â† ConfigMapä¸­çš„database.properties
```

## 3.4 Spring Bootè¯»å–ConfigMapé…ç½®



**å‘Šè¯‰Spring Bootå»å“ªé‡Œæ‰¾é…ç½®æ–‡ä»¶**ï¼š
```bash
# åœ¨å®¹å™¨å¯åŠ¨å‘½ä»¤ä¸­æŒ‡å®šé…ç½®æ–‡ä»¶ä½ç½®

java -jar app.jar --spring.config.location=/app/config/application.yml
```

æˆ–è€…åœ¨application.ymlä¸­è®¾ç½®ï¼š
```yaml
spring:
  config:
    import: "file:/app/config/"
```

---

# 4. ğŸ” Secretå¯†é’¥å®‰å…¨æ³¨å…¥



## 4.1 ä»€ä¹ˆæ˜¯Secret



**ç®€å•ç†è§£**ï¼šSecretå°±æ˜¯ä¸“é—¨å­˜æ”¾æ•æ„Ÿä¿¡æ¯çš„"ä¿é™©ç®±"ï¼Œæ¯”å¦‚æ•°æ®åº“å¯†ç ã€APIå¯†é’¥ç­‰ã€‚å’ŒConfigMapçš„åŒºåˆ«æ˜¯Secretä¼šå¯¹æ•°æ®è¿›è¡Œbase64ç¼–ç ï¼Œæ›´å®‰å…¨ä¸€äº›ã€‚

```
ConfigMapï¼šå­˜æ”¾æ™®é€šé…ç½®
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ConfigMap     â”‚
â”‚ â€¢ æœåŠ¡å™¨ç«¯å£     â”‚
â”‚ â€¢ æ—¥å¿—çº§åˆ«      â”‚  â† è¿™äº›ä¿¡æ¯æ³„éœ²äº†ä¹Ÿä¸è¦ç´§
â”‚ â€¢ ç¼“å­˜é…ç½®      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Secretï¼šå­˜æ”¾æ•æ„Ÿä¿¡æ¯
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Secret       â”‚
â”‚ â€¢ æ•°æ®åº“å¯†ç      â”‚
â”‚ â€¢ APIå¯†é’¥       â”‚  â† è¿™äº›ä¿¡æ¯å¾ˆé‡è¦ï¼Œéœ€è¦ä¿æŠ¤
â”‚ â€¢ è¯ä¹¦æ–‡ä»¶      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 4.2 åˆ›å»ºSecret



**æ–¹å¼1ï¼šå‘½ä»¤è¡Œåˆ›å»º**
```bash
# åˆ›å»ºåŒ…å«æ•°æ®åº“å‡­æ®çš„Secret

kubectl create secret generic db-secret \
  --from-literal=username=myuser \
  --from-literal=password=mypassword \
  --from-literal=database=mydb
```

**æ–¹å¼2ï¼šYAMLæ–‡ä»¶åˆ›å»º**
```yaml
apiVersion: v1
kind: Secret
metadata:
  name: db-secret
type: Opaque
data:
  username: bXl1c2Vy        # myuserçš„base64ç¼–ç 
  password: bXlwYXNzd29yZA==  # mypasswordçš„base64ç¼–ç 
  database: bXlkYg==        # mydbçš„base64ç¼–ç 
```

ğŸ’¡ **å°æç¤º**ï¼šbase64ç¼–ç å¯ä»¥è¿™æ ·ç”Ÿæˆï¼š
```bash
echo -n "myuser" | base64    # è¾“å‡ºï¼šbXl1c2Vy
echo -n "mypassword" | base64 # è¾“å‡ºï¼šbXlwYXNzd29yZA==
```

## 4.3 åœ¨åº”ç”¨ä¸­ä½¿ç”¨Secret



**ä½œä¸ºç¯å¢ƒå˜é‡æ³¨å…¥**ï¼š
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-app
spec:
  template:
    spec:
      containers:
      - name: app
        image: my-java-app:latest
        env:
        - name: DB_USERNAME
          valueFrom:
            secretKeyRef:
              name: db-secret
              key: username
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              name: db-secret
              key: password
```

**åœ¨Spring Bootä¸­ä½¿ç”¨**ï¼š
```yaml
# application.yml

spring:
  datasource:
    url: jdbc:mysql://mysql-service:3306/${DB_DATABASE:mydb}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
```

## 4.4 Secretçš„å®‰å…¨å®è·µ



```
ğŸ”¸ æœ€ä½³å®è·µï¼š
  â”œâ”€ ä¸è¦æŠŠSecretæäº¤åˆ°Gitä»“åº“
  â”œâ”€ ä½¿ç”¨RBACæ§åˆ¶Secretè®¿é—®æƒé™  
  â”œâ”€ å®šæœŸè½®æ¢æ•æ„Ÿä¿¡æ¯
  â””â”€ åœ¨ä¸éœ€è¦æ—¶åˆ é™¤Secret

âš ï¸ æ³¨æ„äº‹é¡¹ï¼š
  â”œâ”€ Secretåªæ˜¯base64ç¼–ç ï¼Œä¸æ˜¯åŠ å¯†
  â”œâ”€ Podä¸­çš„è¿›ç¨‹å¯ä»¥è¯»å–æ‰€æœ‰æŒ‚è½½çš„Secret
  â””â”€ ç½‘ç»œä¼ è¾“æ—¶Secretä»ç„¶éœ€è¦é¢å¤–ä¿æŠ¤
```

---

# 5. ğŸ’¾ VolumeæŒ‚è½½é…ç½®



## 5.1 VolumeæŒ‚è½½çš„æ¦‚å¿µ



**å½¢è±¡æ¯”å–»**ï¼šVolumeæŒ‚è½½å°±åƒæ˜¯ç»™å®¹å™¨"æ’ä¸Šä¸€ä¸ªUç›˜"ï¼Œå®¹å™¨å¯ä»¥ä»Uç›˜é‡Œè¯»å–æ–‡ä»¶ã€‚

```
æ²¡æœ‰VolumeæŒ‚è½½ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     å®¹å™¨        â”‚
â”‚ â”œâ”€â”€ app.jar     â”‚  â† åªèƒ½è®¿é—®å®¹å™¨å†…éƒ¨çš„æ–‡ä»¶
â”‚ â””â”€â”€ å†…ç½®é…ç½®    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æœ‰VolumeæŒ‚è½½ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     å®¹å™¨        â”‚    â”‚   å¤–éƒ¨å­˜å‚¨       â”‚
â”‚ â”œâ”€â”€ app.jar     â”‚    â”‚ â”œâ”€â”€ é…ç½®æ–‡ä»¶A    â”‚
â”‚ â””â”€â”€ /config â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ â”œâ”€â”€ é…ç½®æ–‡ä»¶B    â”‚  â† å¯ä»¥è®¿é—®å¤–éƒ¨æ–‡ä»¶
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â””â”€â”€ å…¶ä»–æ–‡ä»¶    â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 5.2 å¸¸è§çš„Volumeç±»å‹



**emptyDir**ï¼šä¸´æ—¶å­˜å‚¨ï¼ŒPodåˆ é™¤æ—¶æ•°æ®ä¹Ÿåˆ é™¤
```yaml
volumes:
- name: temp-storage
  emptyDir: {}  # ç©ºç›®å½•ï¼Œç±»ä¼¼ä¸´æ—¶æ–‡ä»¶å¤¹
```

**hostPath**ï¼šæŒ‚è½½å®¿ä¸»æœºçš„ç›®å½•
```yaml
volumes:
- name: host-config
  hostPath:
    path: /etc/myapp  # å®¿ä¸»æœºçš„è·¯å¾„
    type: Directory
```

**configMap**ï¼šæŠŠConfigMapä½œä¸ºæ–‡ä»¶æŒ‚è½½
```yaml
volumes:
- name: config-volume
  configMap:
    name: app-config
```

**persistentVolumeClaim**ï¼šæŒä¹…åŒ–å­˜å‚¨
```yaml
volumes:
- name: persistent-storage
  persistentVolumeClaim:
    claimName: my-pvc
```

## 5.3 å®é™…ä½¿ç”¨ç¤ºä¾‹



**å®Œæ•´çš„Deploymenté…ç½®**ï¼š
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-java-app
spec:
  replicas: 2
  selector:
    matchLabels:
      app: my-java-app
  template:
    metadata:
      labels:
        app: my-java-app
    spec:
      containers:
      - name: app
        image: my-java-app:latest
        ports:
        - containerPort: 8080
        volumeMounts:
        - name: app-config          # ConfigMapé…ç½®æ–‡ä»¶
          mountPath: /app/config
        - name: app-secrets         # Secretæ•æ„Ÿä¿¡æ¯
          mountPath: /app/secrets
          readOnly: true
        - name: log-storage         # æ—¥å¿—å­˜å‚¨
          mountPath: /app/logs
      volumes:
      - name: app-config
        configMap:
          name: app-config
      - name: app-secrets
        secret:
          secretName: app-secrets
      - name: log-storage
        emptyDir: {}
```

**å®¹å™¨å†…çš„æ–‡ä»¶ç»“æ„**ï¼š
```
/app/
â”œâ”€â”€ app.jar              â† åº”ç”¨ç¨‹åº
â”œâ”€â”€ config/              â† ConfigMapæŒ‚è½½ç‚¹
â”‚   â”œâ”€â”€ application.yml
â”‚   â””â”€â”€ logback.xml
â”œâ”€â”€ secrets/             â† SecretæŒ‚è½½ç‚¹
â”‚   â”œâ”€â”€ db-password
â”‚   â””â”€â”€ api-key
â””â”€â”€ logs/                â† æ—¥å¿—ç›®å½•
    â””â”€â”€ application.log
```

## 5.4 Spring Bootä¸­ä½¿ç”¨æŒ‚è½½çš„é…ç½®



```yaml
# application.ymlå¯ä»¥è¿™æ ·å¼•ç”¨æŒ‚è½½çš„æ–‡ä»¶

spring:
  config:
    import: 
      - "file:/app/config/"
      - "file:/app/secrets/"
  datasource:
    password: ${file:/app/secrets/db-password}
```

æˆ–è€…åœ¨å¯åŠ¨å‘½ä»¤ä¸­æŒ‡å®šï¼š
```bash
java -jar app.jar \
  --spring.config.location=/app/config/application.yml \
  --spring.datasource.password=$(cat /app/secrets/db-password)
```

---

# 6. ğŸ”Œ ç«¯å£ä¸æ¢é’ˆé…ç½®



## 6.1 ç«¯å£é…ç½®åŸºç¡€



**ä»€ä¹ˆæ˜¯ç«¯å£é…ç½®ï¼Ÿ**
å°±æ˜¯å‘Šè¯‰Kubernetesä½ çš„åº”ç”¨ç›‘å¬å“ªä¸ªç«¯å£ï¼Œä»¥åŠå¦‚ä½•è®¿é—®ä½ çš„åº”ç”¨ã€‚

```
åº”ç”¨å†…éƒ¨ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Javaåº”ç”¨       â”‚
â”‚  ç›‘å¬ç«¯å£:8080   â”‚  â† åº”ç”¨å®é™…ç›‘å¬çš„ç«¯å£
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å®¹å™¨å±‚é¢ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     å®¹å™¨        â”‚
â”‚  æš´éœ²ç«¯å£:8080   â”‚  â† å®¹å™¨æš´éœ²çš„ç«¯å£
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Serviceå±‚é¢ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Service      â”‚
â”‚  å¤–éƒ¨ç«¯å£:80     â”‚  â† å¤–éƒ¨è®¿é—®çš„ç«¯å£
â”‚  ç›®æ ‡ç«¯å£:8080   â”‚  â† è½¬å‘åˆ°å®¹å™¨çš„ç«¯å£
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 6.2 å®Œæ•´çš„ç«¯å£é…ç½®ç¤ºä¾‹



```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-app
spec:
  template:
    spec:
      containers:
      - name: app
        image: my-java-app:latest
        ports:
        - name: http           # ç«¯å£åç§°ï¼ˆå¯é€‰ï¼‰
          containerPort: 8080  # å®¹å™¨å†…åº”ç”¨ç›‘å¬çš„ç«¯å£
          protocol: TCP        # åè®®ç±»å‹
        - name: management
          containerPort: 8081  # ç®¡ç†ç«¯å£ï¼ˆSpring Boot Actuatorï¼‰
          protocol: TCP
---
apiVersion: v1
kind: Service
metadata:
  name: my-app-service
spec:
  selector:
    app: my-app
  ports:
  - name: http
    port: 80          # Serviceçš„ç«¯å£ï¼ˆå¤–éƒ¨è®¿é—®ï¼‰
    targetPort: 8080  # è½¬å‘åˆ°Podçš„ç«¯å£
    protocol: TCP
  - name: management
    port: 8081
    targetPort: 8081
  type: ClusterIP     # æœåŠ¡ç±»å‹
```

## 6.3 å¥åº·æ£€æŸ¥æ¢é’ˆ



**ä¸ºä»€ä¹ˆéœ€è¦æ¢é’ˆï¼Ÿ**
Kuberneteséœ€è¦çŸ¥é“ä½ çš„åº”ç”¨æ˜¯å¦å¥åº·è¿è¡Œï¼Œå¦‚æœåº”ç”¨å‡ºé—®é¢˜äº†ï¼Œå¯ä»¥è‡ªåŠ¨é‡å¯æˆ–è€…åœæ­¢æµé‡è½¬å‘ã€‚

```
æ²¡æœ‰æ¢é’ˆï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Pod         â”‚
â”‚  åº”ç”¨å¡æ­»äº†      â”‚  â† Kubernetesä¸çŸ¥é“åº”ç”¨æœ‰é—®é¢˜
â”‚  ä½†è¿›ç¨‹è¿˜åœ¨      â”‚      ç»§ç»­å‘é€æµé‡ â†’ ç”¨æˆ·è®¿é—®å¤±è´¥
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æœ‰æ¢é’ˆï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Pod         â”‚
â”‚  åº”ç”¨å¡æ­»äº†      â”‚  â† æ¢é’ˆæ£€æµ‹åˆ°é—®é¢˜
â”‚  æ¢é’ˆæ£€æŸ¥å¤±è´¥    â”‚      Kubernetesè‡ªåŠ¨å¤„ç†
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”œâ”€ åœæ­¢å‘é€æµé‡
                        â””â”€ é‡å¯å®¹å™¨
```

**ä¸‰ç§æ¢é’ˆç±»å‹**ï¼š

| æ¢é’ˆç±»å‹ | **ä½œç”¨** | **ä»€ä¹ˆæ—¶å€™ç”¨** |
|---------|---------|---------------|
| `startupProbe` | å¯åŠ¨æ¢é’ˆ | æ£€æŸ¥åº”ç”¨æ˜¯å¦å¯åŠ¨å®Œæˆ |
| `livenessProbe` | å­˜æ´»æ¢é’ˆ | æ£€æŸ¥åº”ç”¨æ˜¯å¦è¿˜æ´»ç€ |
| `readinessProbe` | å°±ç»ªæ¢é’ˆ | æ£€æŸ¥åº”ç”¨æ˜¯å¦å‡†å¤‡å¥½æ¥æ”¶æµé‡ |

## 6.4 æ¢é’ˆé…ç½®ç¤ºä¾‹



```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-app
spec:
  template:
    spec:
      containers:
      - name: app
        image: my-java-app:latest
        ports:
        - containerPort: 8080
        - containerPort: 8081  # management port
        
#        # å¯åŠ¨æ¢é’ˆï¼šåº”ç”¨å¯åŠ¨éœ€è¦æ—¶é—´ï¼Œç»™è¶³å¤Ÿçš„å¯åŠ¨æ—¶é—´
        startupProbe:
          httpGet:
            path: /actuator/health
            port: 8081
          initialDelaySeconds: 30    # 30ç§’åå¼€å§‹æ£€æŸ¥
          periodSeconds: 10          # æ¯10ç§’æ£€æŸ¥ä¸€æ¬¡
          timeoutSeconds: 5          # æ¯æ¬¡æ£€æŸ¥è¶…æ—¶æ—¶é—´
          failureThreshold: 30       # å¤±è´¥30æ¬¡æ‰è®¤ä¸ºå¯åŠ¨å¤±è´¥
        
#        # å­˜æ´»æ¢é’ˆï¼šæ£€æŸ¥åº”ç”¨æ˜¯å¦å¡æ­»
        livenessProbe:
          httpGet:
            path: /actuator/health
            port: 8081
          initialDelaySeconds: 60    # å¯åŠ¨å60ç§’å¼€å§‹æ£€æŸ¥
          periodSeconds: 30          # æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡
          timeoutSeconds: 5
          failureThreshold: 3        # å¤±è´¥3æ¬¡å°±é‡å¯å®¹å™¨
        
#        # å°±ç»ªæ¢é’ˆï¼šæ£€æŸ¥æ˜¯å¦å¯ä»¥æ¥æ”¶æµé‡
        readinessProbe:
          httpGet:
            path: /actuator/health/readiness
            port: 8081
          initialDelaySeconds: 5     # 5ç§’åå¼€å§‹æ£€æŸ¥
          periodSeconds: 5           # æ¯5ç§’æ£€æŸ¥ä¸€æ¬¡
          timeoutSeconds: 3
          failureThreshold: 3        # å¤±è´¥3æ¬¡å°±åœæ­¢å‘é€æµé‡
```

## 6.5 Spring Booté…ç½®æ¢é’ˆç«¯ç‚¹



**æ·»åŠ Actuatorä¾èµ–**ï¼š
```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-actuator</artifactId>
</dependency>
```

**application.ymlé…ç½®**ï¼š
```yaml
management:
  server:
    port: 8081                    # ç®¡ç†ç«¯å£ï¼Œä¸åº”ç”¨ç«¯å£åˆ†ç¦»
  endpoints:
    web:
      exposure:
        include: health,info      # æš´éœ²å¥åº·æ£€æŸ¥ç«¯ç‚¹
  endpoint:
    health:
      show-details: always       # æ˜¾ç¤ºè¯¦ç»†å¥åº·ä¿¡æ¯
  health:
    readinessstate:
      enabled: true              # å¯ç”¨å°±ç»ªçŠ¶æ€æ£€æŸ¥
    livenessstate:
      enabled: true              # å¯ç”¨å­˜æ´»çŠ¶æ€æ£€æŸ¥
```

**æ£€æŸ¥ç«¯ç‚¹**ï¼š
- `/actuator/health` - æ€»ä½“å¥åº·çŠ¶æ€
- `/actuator/health/liveness` - å­˜æ´»æ£€æŸ¥
- `/actuator/health/readiness` - å°±ç»ªæ£€æŸ¥

---

# 7. ğŸ”„ å®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†



## 7.1 ä»€ä¹ˆæ˜¯å®¹å™¨ç”Ÿå‘½å‘¨æœŸ



**ç®€å•ç†è§£**ï¼šå°±åƒäººçš„ç”Ÿè€ç—…æ­»ä¸€æ ·ï¼Œå®¹å™¨ä¹Ÿæœ‰è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸï¼Œä»åˆ›å»ºã€è¿è¡Œã€åˆ°é”€æ¯ã€‚

```
å®¹å™¨ç”Ÿå‘½å‘¨æœŸï¼š
åˆ›å»ºå®¹å™¨ â†’ å¯åŠ¨åº”ç”¨ â†’ è¿è¡ŒæœåŠ¡ â†’ æ¥æ”¶åœæ­¢ä¿¡å· â†’ ä¼˜é›…å…³é—­ â†’ å®¹å™¨é”€æ¯

      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ åˆ›å»º    â”‚â”€â”€â”€â–¶â”‚ è¿è¡Œ    â”‚â”€â”€â”€â–¶â”‚ åœæ­¢    â”‚â”€â”€â”€â–¶â”‚ é”€æ¯    â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚              â”‚              â”‚              â”‚
      æ‰§è¡Œåˆå§‹åŒ–      åº”ç”¨æ­£å¸¸è¿è¡Œ    æ‰§è¡Œæ¸…ç†å·¥ä½œ     èµ„æºå›æ”¶
```

## 7.2 ç”Ÿå‘½å‘¨æœŸé’©å­



**ä»€ä¹ˆæ˜¯ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Ÿ**
å°±æ˜¯åœ¨å®¹å™¨ç”Ÿå‘½å‘¨æœŸçš„ç‰¹å®šæ—¶åˆ»ï¼Œè®©ä½ æ‰§è¡Œä¸€äº›è‡ªå®šä¹‰çš„æ“ä½œã€‚

**ä¸¤ç§é’©å­**ï¼š
- `postStart`ï¼šå®¹å™¨å¯åŠ¨åç«‹å³æ‰§è¡Œ
- `preStop`ï¼šå®¹å™¨åœæ­¢å‰æ‰§è¡Œ

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-app
spec:
  template:
    spec:
      containers:
      - name: app
        image: my-java-app:latest
        
        lifecycle:
          postStart:
            exec:
              command: 
              - /bin/sh
              - -c
              - |
                echo "å®¹å™¨å¯åŠ¨äº†ï¼Œæ‰§è¡Œä¸€äº›åˆå§‹åŒ–å·¥ä½œ"
#                # æ¯”å¦‚ï¼šæ³¨å†Œåˆ°æœåŠ¡å‘ç°ã€é¢„çƒ­ç¼“å­˜ç­‰
                
          preStop:
            exec:
              command:
              - /bin/sh  
              - -c
              - |
                echo "å®¹å™¨å³å°†åœæ­¢ï¼Œæ‰§è¡Œæ¸…ç†å·¥ä½œ"
#                # æ¯”å¦‚ï¼šä¿å­˜çŠ¶æ€ã€é€šçŸ¥å…¶ä»–æœåŠ¡ã€ç­‰å¾…è¯·æ±‚å¤„ç†å®Œæˆ
                sleep 15
```

## 7.3 ä¼˜é›…å…³é—­é…ç½®



**ä»€ä¹ˆæ˜¯ä¼˜é›…å…³é—­ï¼Ÿ**
å°±æ˜¯ç»™åº”ç”¨ä¸€äº›æ—¶é—´æ¥å®Œæˆæ­£åœ¨å¤„ç†çš„è¯·æ±‚ï¼Œè€Œä¸æ˜¯ç›´æ¥"æš´åŠ›"æ€æ­»è¿›ç¨‹ã€‚

```
æ™®é€šå…³é—­ï¼ˆæš´åŠ›å…³é—­ï¼‰ï¼š
è¯·æ±‚å¤„ç†ä¸­ â†’ ç«‹å³æ€æ­»è¿›ç¨‹ â†’ è¯·æ±‚å¤±è´¥ âŒ

ä¼˜é›…å…³é—­ï¼š
è¯·æ±‚å¤„ç†ä¸­ â†’ åœæ­¢æ¥æ”¶æ–°è¯·æ±‚ â†’ ç­‰å¾…ç°æœ‰è¯·æ±‚å®Œæˆ â†’ å…³é—­è¿›ç¨‹ âœ…
```

**Kubernetesé…ç½®**ï¼š
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-app
spec:
  template:
    spec:
      terminationGracePeriodSeconds: 30  # ç»™å®¹å™¨30ç§’æ—¶é—´ä¼˜é›…å…³é—­
      containers:
      - name: app
        image: my-java-app:latest
        
        lifecycle:
          preStop:
            exec:
              command:
              - /bin/sh
              - -c
              - |
#                # å‘Šè¯‰åº”ç”¨å¼€å§‹å…³é—­æµç¨‹
                curl -X POST http://localhost:8081/actuator/shutdown
#                # ç­‰å¾…ä¸€æ®µæ—¶é—´è®©åº”ç”¨å¤„ç†å®Œè¯·æ±‚
                sleep 10
```

**Spring Bootä¼˜é›…å…³é—­é…ç½®**ï¼š
```yaml
# application.yml

server:
  shutdown: graceful                    # å¯ç”¨ä¼˜é›…å…³é—­

spring:
  lifecycle:
    timeout-per-shutdown-phase: 20s     # æ¯ä¸ªå…³é—­é˜¶æ®µçš„è¶…æ—¶æ—¶é—´

management:
  endpoint:
    shutdown:
      enabled: true                     # å¯ç”¨å…³é—­ç«¯ç‚¹
  endpoints:
    web:
      exposure:
        include: shutdown
```

## 7.4 å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ç¤ºä¾‹



```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-java-app
spec:
  replicas: 3
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxUnavailable: 1        # æ»šåŠ¨æ›´æ–°æ—¶æœ€å¤š1ä¸ªPodä¸å¯ç”¨
      maxSurge: 1             # æ»šåŠ¨æ›´æ–°æ—¶æœ€å¤šå¤šåˆ›å»º1ä¸ªPod
  template:
    spec:
      terminationGracePeriodSeconds: 60  # 60ç§’ä¼˜é›…å…³é—­æ—¶é—´
      
      containers:
      - name: app
        image: my-java-app:latest
        
#        # èµ„æºé™åˆ¶
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        
#        # ç«¯å£é…ç½®
        ports:
        - name: http
          containerPort: 8080
        - name: management
          containerPort: 8081
        
#        # ç”Ÿå‘½å‘¨æœŸé’©å­
        lifecycle:
          postStart:
            exec:
              command:
              - /bin/sh
              - -c
              - |
#                # åº”ç”¨å¯åŠ¨åçš„åˆå§‹åŒ–å·¥ä½œ
                echo "åº”ç”¨å¯åŠ¨ï¼Œè¿›è¡Œé¢„çƒ­..."
                curl -s http://localhost:8081/actuator/health || true
                
          preStop:
            httpGet:
              path: /actuator/shutdown
              port: 8081
        
#        # å¥åº·æ£€æŸ¥
        startupProbe:
          httpGet:
            path: /actuator/health
            port: 8081
          initialDelaySeconds: 30
          periodSeconds: 10
          failureThreshold: 30
          
        livenessProbe:
          httpGet:
            path: /actuator/health/liveness
            port: 8081
          initialDelaySeconds: 60
          periodSeconds: 30
          
        readinessProbe:
          httpGet:
            path: /actuator/health/readiness
            port: 8081
          initialDelaySeconds: 10
          periodSeconds: 5
```

## 7.5 æ»šåŠ¨æ›´æ–°ä¸é›¶åœæœºéƒ¨ç½²



**ä»€ä¹ˆæ˜¯æ»šåŠ¨æ›´æ–°ï¼Ÿ**
å°±æ˜¯ä¸€ä¸ªä¸€ä¸ªåœ°æ›¿æ¢è€å®¹å™¨ï¼Œä¿è¯æœåŠ¡ä¸ä¸­æ–­ã€‚

```
æ»šåŠ¨æ›´æ–°è¿‡ç¨‹ï¼ˆå‡è®¾æœ‰3ä¸ªPodï¼‰ï¼š

åˆå§‹çŠ¶æ€ï¼š
[Pod1-v1] [Pod2-v1] [Pod3-v1]  â† éƒ½æ˜¯è€ç‰ˆæœ¬

æ­¥éª¤1ï¼šåˆ›å»ºæ–°Pod
[Pod1-v1] [Pod2-v1] [Pod3-v1] [Pod4-v2]  â† æ–°ç‰ˆæœ¬Podå¯åŠ¨

æ­¥éª¤2ï¼šæ–°Podå°±ç»ªåï¼Œåˆ é™¤ä¸€ä¸ªè€Pod
[Pod2-v1] [Pod3-v1] [Pod4-v2]  â† Pod1è¢«åˆ é™¤

æ­¥éª¤3ï¼šç»§ç»­åˆ›å»ºæ–°Pod
[Pod2-v1] [Pod3-v1] [Pod4-v2] [Pod5-v2]

æ­¥éª¤4ï¼šåˆ é™¤è€Pod
[Pod3-v1] [Pod4-v2] [Pod5-v2]

æœ€ç»ˆçŠ¶æ€ï¼š
[Pod4-v2] [Pod5-v2] [Pod6-v2]  â† å…¨éƒ¨æ˜¯æ–°ç‰ˆæœ¬
```

---

# 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“



## 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ



```
ğŸ”¸ é…ç½®æ³¨å…¥ï¼šæŠŠé…ç½®ä»å¤–éƒ¨ä¼ ç»™å®¹å™¨å†…çš„åº”ç”¨
ğŸ”¸ ç¯å¢ƒå˜é‡ï¼šæœ€ç®€å•çš„é…ç½®æ–¹å¼ï¼Œé€‚åˆç®€å•é…ç½®é¡¹
ğŸ”¸ ConfigMapï¼šå­˜æ”¾é…ç½®æ–‡ä»¶ï¼Œé€‚åˆå¤æ‚é…ç½®
ğŸ”¸ Secretï¼šå­˜æ”¾æ•æ„Ÿä¿¡æ¯ï¼Œéœ€è¦ä¿æŠ¤çš„æ•°æ®
ğŸ”¸ VolumeæŒ‚è½½ï¼šæŠŠå¤–éƒ¨æ–‡ä»¶æŒ‚è½½åˆ°å®¹å™¨å†…éƒ¨
ğŸ”¸ æ¢é’ˆæ£€æŸ¥ï¼šè®©KubernetesçŸ¥é“åº”ç”¨çš„å¥åº·çŠ¶æ€
ğŸ”¸ ç”Ÿå‘½å‘¨æœŸï¼šç®¡ç†å®¹å™¨ä»å¯åŠ¨åˆ°å…³é—­çš„æ•´ä¸ªè¿‡ç¨‹
```

## 8.2 å…³é”®ç†è§£è¦ç‚¹



**ğŸ”¹ é…ç½®ç®¡ç†çš„å±‚æ¬¡**
```
ä»£ç å±‚ï¼šapplication.ymlç­‰é…ç½®æ–‡ä»¶
å®¹å™¨å±‚ï¼šç¯å¢ƒå˜é‡ã€VolumeæŒ‚è½½
ç¼–æ’å±‚ï¼šConfigMapã€Secret
é›†ç¾¤å±‚ï¼šServiceã€Ingressé…ç½®
```

**ğŸ”¹ å®‰å…¨æ€§è€ƒè™‘**
```
æ™®é€šé…ç½® â†’ ConfigMapï¼ˆæ˜æ–‡å­˜å‚¨ï¼‰
æ•æ„Ÿé…ç½® â†’ Secretï¼ˆbase64ç¼–ç ï¼‰
è¶…æ•æ„Ÿé…ç½® â†’ å¤–éƒ¨å¯†é’¥ç®¡ç†ç³»ç»Ÿ
```

**ğŸ”¹ å¥åº·æ£€æŸ¥ç­–ç•¥**
```
å¯åŠ¨æ¢é’ˆï¼šç»™åº”ç”¨è¶³å¤Ÿçš„å¯åŠ¨æ—¶é—´
å­˜æ´»æ¢é’ˆï¼šæ£€æµ‹åº”ç”¨æ˜¯å¦å¡æ­»ï¼Œå¡æ­»å°±é‡å¯
å°±ç»ªæ¢é’ˆï¼šæ£€æµ‹åº”ç”¨æ˜¯å¦å‡†å¤‡å¥½ï¼Œæ²¡å‡†å¤‡å¥½å°±ä¸å‘æµé‡
```

## 8.3 å®é™…åº”ç”¨ä»·å€¼



**ğŸ¯ è§£å†³çš„é—®é¢˜**ï¼š
- âœ… **ç¯å¢ƒä¸€è‡´æ€§**ï¼šä¸€å¥—ä»£ç åœ¨ä¸åŒç¯å¢ƒè¿è¡Œ
- âœ… **é…ç½®å®‰å…¨æ€§**ï¼šæ•æ„Ÿä¿¡æ¯ä¸æš´éœ²åœ¨ä»£ç ä¸­
- âœ… **è¿ç»´æ•ˆç‡**ï¼šé…ç½®ä¿®æ”¹ä¸éœ€è¦é‡æ–°æ„å»ºé•œåƒ
- âœ… **æœåŠ¡å¯é æ€§**ï¼šå¥åº·æ£€æŸ¥ä¿è¯æœåŠ¡è´¨é‡
- âœ… **é›¶åœæœºéƒ¨ç½²**ï¼šæ»šåŠ¨æ›´æ–°ä¿è¯æœåŠ¡è¿ç»­æ€§

**ğŸ”§ æœ€ä½³å®è·µ**ï¼š
```
é…ç½®åˆ†å±‚ï¼š
â”œâ”€ ç¯å¢ƒå˜é‡ï¼šç®€å•é…ç½®ï¼ˆç«¯å£ã€å¼€å…³ï¼‰
â”œâ”€ ConfigMapï¼šå¤æ‚é…ç½®ï¼ˆåº”ç”¨é…ç½®æ–‡ä»¶ï¼‰  
â”œâ”€ Secretï¼šæ•æ„Ÿé…ç½®ï¼ˆå¯†ç ã€è¯ä¹¦ï¼‰
â””â”€ Volumeï¼šå¤§æ–‡ä»¶ï¼ˆæ—¥å¿—ã€æ•°æ®æ–‡ä»¶ï¼‰

æ¢é’ˆé…ç½®ï¼š
â”œâ”€ ç»™startupè¶³å¤Ÿæ—¶é—´ï¼ˆSpring Bootå¯åŠ¨æ…¢ï¼‰
â”œâ”€ livenessæ£€æŸ¥é—´éš”è¦åˆç†ï¼ˆå¤ªé¢‘ç¹æ¶ˆè€—èµ„æºï¼‰
â””â”€ readinessè¦å¿«é€Ÿå“åº”ï¼ˆå½±å“æµé‡è½¬å‘ï¼‰

ç”Ÿå‘½å‘¨æœŸï¼š
â”œâ”€ ä¼˜é›…å…³é—­å¾ˆé‡è¦ï¼ˆé¿å…è¯·æ±‚ä¸¢å¤±ï¼‰
â”œâ”€ èµ„æºé™åˆ¶è¦è®¾ç½®ï¼ˆé¿å…èµ„æºäº‰æŠ¢ï¼‰
â””â”€ æ»šåŠ¨æ›´æ–°ç­–ç•¥ï¼ˆä¿è¯æœåŠ¡å¯ç”¨æ€§ï¼‰
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- é…ç½®å¤–éƒ¨åŒ–ï¼Œå®‰å…¨åˆçµæ´»
- æ¢é’ˆä¿å¥åº·ï¼Œæ•…éšœè‡ªåŠ¨ä¿®
- ç”Ÿå‘½æœ‰å‘¨æœŸï¼Œä¼˜é›…æœ€é‡è¦
- ä¸€å¥—ä»£ç èµ°å¤©ä¸‹ï¼Œå¤šç¯å¢ƒéƒ¨ç½²ä¸ç”¨æ„