---
title: 4ã€æœåŠ¡æ³¨å†Œä¸å‘ç°æœºåˆ¶
---
## ğŸ“š ç›®å½•

1. [æœåŠ¡æ³¨å†Œä¸­å¿ƒæ¦‚å¿µ](#1-æœåŠ¡æ³¨å†Œä¸­å¿ƒæ¦‚å¿µ)
2. [ä¸»æµæ³¨å†Œä¸­å¿ƒå¯¹æ¯”](#2-ä¸»æµæ³¨å†Œä¸­å¿ƒå¯¹æ¯”)
3. [æœåŠ¡å¥åº·æ£€æŸ¥æœºåˆ¶](#3-æœåŠ¡å¥åº·æ£€æŸ¥æœºåˆ¶)
4. [æœåŠ¡ä¸‹çº¿ä¸å‰”é™¤](#4-æœåŠ¡ä¸‹çº¿ä¸å‰”é™¤)
5. [é›†ç¾¤éƒ¨ç½²ç­–ç•¥](#5-é›†ç¾¤éƒ¨ç½²ç­–ç•¥)
6. [æ³¨å†Œä¸­å¿ƒé«˜å¯ç”¨](#6-æ³¨å†Œä¸­å¿ƒé«˜å¯ç”¨)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ“‹ æœåŠ¡æ³¨å†Œä¸­å¿ƒæ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯æœåŠ¡æ³¨å†Œä¸­å¿ƒ


**ğŸ¢ ç”Ÿæ´»ç±»æ¯”**ï¼š
> æƒ³è±¡ä¸€ä¸‹å…¬å¸çš„å‰å°æ¥å¾…å¤„ï¼š
> - æ–°å‘˜å·¥å…¥èŒæ—¶è¦åœ¨å‰å°**ç™»è®°ä¿¡æ¯**ï¼ˆæœåŠ¡æ³¨å†Œï¼‰
> - å…¶ä»–äººæƒ³æ‰¾æŸä¸ªéƒ¨é—¨æ—¶ï¼Œé—®å‰å°**æŸ¥è¯¢ä½ç½®**ï¼ˆæœåŠ¡å‘ç°ï¼‰
> - å‰å°å®šæœŸ**ç¡®è®¤å„éƒ¨é—¨çŠ¶æ€**ï¼ˆå¥åº·æ£€æŸ¥ï¼‰
> - å‘˜å·¥ç¦»èŒæ—¶**æ³¨é”€ç™»è®°**ï¼ˆæœåŠ¡ä¸‹çº¿ï¼‰

**ğŸ”¸ æ ¸å¿ƒå®šä¹‰**
```
æœåŠ¡æ³¨å†Œä¸­å¿ƒ = å¾®æœåŠ¡çš„"ç”µè¯é»„é¡µ" + "å¥åº·ç®¡å®¶"

æ ¸å¿ƒèŒè´£ï¼š
â€¢ æœåŠ¡æ³¨å†Œï¼šæ–°æœåŠ¡å¯åŠ¨æ—¶è‡ªåŠ¨ç™»è®°
â€¢ æœåŠ¡å‘ç°ï¼šå¸®å…¶ä»–æœåŠ¡æ‰¾åˆ°ç›®æ ‡æœåŠ¡
â€¢ å¥åº·æ£€æŸ¥ï¼šç›‘æ§æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
â€¢ æœåŠ¡å‰”é™¤ï¼šè‡ªåŠ¨ç§»é™¤æ•…éšœæœåŠ¡
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡æ³¨å†Œä¸­å¿ƒ


**ğŸš« æ²¡æœ‰æ³¨å†Œä¸­å¿ƒçš„å›°æ‰°**ï¼š
```
ä¼ ç»Ÿå•ä½“åº”ç”¨ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·ç³»ç»Ÿ   â”‚ â† æ‰€æœ‰åŠŸèƒ½éƒ½åœ¨ä¸€ä¸ªåº”ç”¨é‡Œ
â”‚  è®¢å•ç³»ç»Ÿ   â”‚   æœåŠ¡é—´é€šä¿¡å¾ˆç®€å•
â”‚  æ”¯ä»˜ç³»ç»Ÿ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¾®æœåŠ¡æ‹†åˆ†åçš„æ··ä¹±ï¼š
ç”¨æˆ·æœåŠ¡åœ¨ï¼š192.168.1.10:8001
è®¢å•æœåŠ¡åœ¨ï¼š192.168.1.11:8002  
æ”¯ä»˜æœåŠ¡åœ¨ï¼š192.168.1.12:8003

é—®é¢˜æ¥äº†ï¼š
âŒ æœåŠ¡åœ°å€å†™æ­»åœ¨ä»£ç é‡Œï¼Œæ”¹åœ°å€è¦é‡å¯
âŒ æ–°å¢æœåŠ¡å®ä¾‹ï¼Œæ‰€æœ‰è°ƒç”¨æ–¹éƒ½è¦æ”¹é…ç½®
âŒ æœåŠ¡æŒ‚äº†ï¼Œè°ƒç”¨æ–¹è¿˜åœ¨ç»§ç»­è¯·æ±‚æŠ¥é”™
âŒ è´Ÿè½½å‡è¡¡æ‰‹åŠ¨é…ç½®ï¼Œè¿ç»´å¤æ‚
```

**âœ… æœ‰äº†æ³¨å†Œä¸­å¿ƒçš„ä¾¿åˆ©**ï¼š
```
æœåŠ¡æ¶æ„å›¾ï¼š
         æœåŠ¡è°ƒç”¨æ–¹                æ³¨å†Œä¸­å¿ƒ              æœåŠ¡æä¾›æ–¹
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  è®¢å•æœåŠ¡   â”‚â”€â”€â”€â”€â”€æŸ¥è¯¢â”€â”€â”€â”€â†’â”‚ Eureka  â”‚â†â”€æ³¨å†Œâ”€â”€â”€â”€â”€â”‚  ç”¨æˆ·æœåŠ¡   â”‚
    â”‚             â”‚              â”‚         â”‚           â”‚ 8001,8002   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â†‘
                                  å¥åº·æ£€æŸ¥

å¥½å¤„æ˜æ˜¾ï¼š
âœ… æœåŠ¡åœ°å€åŠ¨æ€è·å–ï¼Œæ— éœ€ç¡¬ç¼–ç 
âœ… æœåŠ¡æ‰©å®¹ç¼©å®¹ï¼Œè‡ªåŠ¨æ„ŸçŸ¥
âœ… æœåŠ¡æ•…éšœï¼Œè‡ªåŠ¨å‰”é™¤
âœ… è´Ÿè½½å‡è¡¡ï¼Œè‡ªåŠ¨å®ç°
```

### 1.3 æœåŠ¡æ³¨å†Œå‘ç°çš„å·¥ä½œæµç¨‹


**ğŸ“Š å®Œæ•´æµç¨‹æ—¶åºå›¾**ï¼š
```
æœåŠ¡æä¾›è€…        æ³¨å†Œä¸­å¿ƒ         æœåŠ¡æ¶ˆè´¹è€…
     |               |                |
     |â”€â”€[1]å¯åŠ¨æ—¶æ³¨å†Œâ”€â”€â†’|                |
     |               |                |
     |               |â†â”€[2]æŸ¥è¯¢æœåŠ¡åˆ—è¡¨â”€|
     |               |â”€[3]è¿”å›æœåŠ¡åœ°å€â†’|
     |               |                |
     |â†â”€[4]å®šæœŸå¥åº·æ£€æŸ¥â”€|                |
     |â”€[5]å¥åº·çŠ¶æ€â”€â”€â”€â”€â†’|                |
     |               |                |
     |â”€â”€[6]æœåŠ¡ä¸‹çº¿â”€â”€â”€â†’|                |
     |               |â”€[7]é€šçŸ¥å˜æ›´â”€â”€â”€â†’|

æµç¨‹è¯´æ˜ï¼š
1. æœåŠ¡å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±çš„ä¿¡æ¯
2. æ¶ˆè´¹è€…éœ€è¦è°ƒç”¨æœåŠ¡æ—¶ï¼Œä»æ³¨å†Œä¸­å¿ƒæŸ¥è¯¢
3. æ³¨å†Œä¸­å¿ƒè¿”å›å¥åº·çš„æœåŠ¡å®ä¾‹åˆ—è¡¨
4-5. å®šæœŸå¥åº·æ£€æŸ¥ï¼Œç¡®ä¿æœåŠ¡å¯ç”¨
6-7. æœåŠ¡ä¸‹çº¿æ—¶é€šçŸ¥æ³¨å†Œä¸­å¿ƒï¼Œå¹¶å¹¿æ’­ç»™æ¶ˆè´¹è€…
```

---

## 2. ğŸ”„ ä¸»æµæ³¨å†Œä¸­å¿ƒå¯¹æ¯”


### 2.1 ä¸‰å¤§ä¸»æµæ³¨å†Œä¸­å¿ƒç‰¹ç‚¹


**ğŸ† æ³¨å†Œä¸­å¿ƒå¯¹æ¯”è¡¨**ï¼š

| ç‰¹æ€§å¯¹æ¯” | **Eureka** | **Consul** | **Nacos** |
|---------|-----------|-----------|----------|
| **å¼€å‘å…¬å¸** | `Netflix` | `HashiCorp` | `é˜¿é‡Œå·´å·´` |
| **è¯­è¨€** | `Java` | `Go` | `Java` |
| **CAPç†è®º** | `APï¼ˆå¯ç”¨æ€§ä¼˜å…ˆï¼‰` | `CPï¼ˆä¸€è‡´æ€§ä¼˜å…ˆï¼‰` | `AP+CPå¯é€‰` |
| **å¥åº·æ£€æŸ¥** | `å®¢æˆ·ç«¯å¿ƒè·³` | `å¤šç§æ–¹å¼` | `å¤šç§æ–¹å¼` |
| **ç•Œé¢ç®¡ç†** | `ç®€å•Webç•Œé¢` | `åŠŸèƒ½ä¸°å¯Œ` | `åŠŸèƒ½æœ€å…¨` |
| **é…ç½®ç®¡ç†** | `âŒä¸æ”¯æŒ` | `âœ…æ”¯æŒ` | `âœ…æ”¯æŒ` |
| **å¤šæ•°æ®ä¸­å¿ƒ** | `âŒä¸æ”¯æŒ` | `âœ…åŸç”Ÿæ”¯æŒ` | `âœ…æ”¯æŒ` |

### 2.2 Eurekaè¯¦è§£


**ğŸ”¸ Eurekaçš„ç‰¹ç‚¹**
```
è®¾è®¡ç†å¿µï¼šå®å¯ç”¨é”™ï¼Œä¸å¯ä¸ç”¨
æ ¸å¿ƒæ€æƒ³ï¼šAPï¼ˆé«˜å¯ç”¨ > å¼ºä¸€è‡´æ€§ï¼‰

å·¥ä½œæœºåˆ¶ï¼š
å®¢æˆ·ç«¯ â†’ Eureka Server â†’ å…¶ä»–å®¢æˆ·ç«¯
   â†‘                        â†“
   â””â”€â”€â”€ 30ç§’å¿ƒè·³ç»­çº¦ â†â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¼˜åŠ¿ï¼š
âœ… Spring CloudåŸç”Ÿæ”¯æŒ
âœ… ç®€å•æ˜“ç”¨ï¼Œå¼€ç®±å³ç”¨
âœ… ç½‘ç»œåˆ†åŒºæ—¶ä»ç„¶å¯ç”¨

åŠ£åŠ¿ï¼š
âŒ æ•°æ®æœ€ç»ˆä¸€è‡´æ€§ï¼ˆå¯èƒ½è¯»åˆ°è¿‡æœŸæ•°æ®ï¼‰
âŒ åŠŸèƒ½ç›¸å¯¹ç®€å•
âŒ Netflixå·²åœæ­¢æ›´æ–°
```

**ğŸ’¡ Eurekaçš„è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶**
> **ç”Ÿæ´»ç±»æ¯”**ï¼šå°±åƒæ‰‹æœºä¿¡å·ä¸å¥½æ—¶ï¼Œé€šè®¯å½•ä¸ä¼šåˆ é™¤è”ç³»äºº
> 
> å½“ç½‘ç»œæ•…éšœå¯¼è‡´å¿ƒè·³ä¸¢å¤±æ—¶ï¼ŒEurekaä¸ä¼šç«‹å³åˆ é™¤æœåŠ¡å®ä¾‹
> è€Œæ˜¯è¿›å…¥"ä¿æŠ¤æ¨¡å¼"ï¼Œä¿ç•™æœåŠ¡ä¿¡æ¯ï¼Œé¿å…é›ªå´©æ•ˆåº”

### 2.3 Consulè¯¦è§£


**ğŸ”¸ Consulçš„ç‰¹ç‚¹**
```
è®¾è®¡ç†å¿µï¼šå¼ºä¸€è‡´æ€§ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿ
æ ¸å¿ƒæ€æƒ³ï¼šCPï¼ˆå¼ºä¸€è‡´æ€§ > é«˜å¯ç”¨æ€§ï¼‰

å·¥ä½œæœºåˆ¶ï¼š
åŸºäºRaftç®—æ³•å®ç°åˆ†å¸ƒå¼ä¸€è‡´æ€§
æ”¯æŒå¤šç§å¥åº·æ£€æŸ¥ï¼šHTTPã€TCPã€è„šæœ¬ã€Docker

ä¼˜åŠ¿ï¼š
âœ… åŠŸèƒ½ä¸°å¯Œï¼ˆæœåŠ¡å‘ç°+é…ç½®ç®¡ç†+å¥åº·æ£€æŸ¥ï¼‰
âœ… å¤šæ•°æ®ä¸­å¿ƒæ”¯æŒ
âœ… å®‰å…¨æ€§å¥½ï¼ˆACLæƒé™æ§åˆ¶ï¼‰

åŠ£åŠ¿ï¼š
âŒ å­¦ä¹ æˆæœ¬ç›¸å¯¹è¾ƒé«˜
âŒ ç½‘ç»œåˆ†åŒºæ—¶å¯èƒ½ä¸å¯ç”¨
âŒ å¯¹Javaç”Ÿæ€é›†æˆéœ€è¦é¢å¤–å·¥ä½œ
```

### 2.4 Nacosè¯¦è§£


**ğŸ”¸ Nacosçš„ç‰¹ç‚¹**
```
è®¾è®¡ç†å¿µï¼šä¸€ä¸ªæ›´æ˜“ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°å’Œé…ç½®ç®¡ç†å¹³å°
æ ¸å¿ƒæ€æƒ³ï¼šAP/CPå¯é€‰ï¼ŒåŠŸèƒ½å…¨é¢

ç‰¹è‰²åŠŸèƒ½ï¼š
â€¢ æœåŠ¡å‘ç° + é…ç½®ç®¡ç† + åŠ¨æ€DNSæœåŠ¡
â€¢ å¯è§†åŒ–ç®¡ç†ç•Œé¢
â€¢ å‘½åç©ºé—´éš”ç¦»

ä¼˜åŠ¿ï¼š
âœ… ä¸­æ–‡æ–‡æ¡£å®Œå–„ï¼Œå›½å†…ç”Ÿæ€å¥½
âœ… åŠŸèƒ½æœ€å…¨é¢
âœ… å¯é€‰æ‹©APæˆ–CPæ¨¡å¼

åŠ£åŠ¿ï¼š
âŒ ç›¸å¯¹è¾ƒæ–°ï¼Œç”Ÿæ€ä¸å¦‚Eurekaæˆç†Ÿ
âŒ ä¾èµ–MySQLç­‰å¤–éƒ¨å­˜å‚¨
```

### 2.5 å¦‚ä½•é€‰æ‹©æ³¨å†Œä¸­å¿ƒ


**ğŸ¯ é€‰æ‹©æŒ‡å—**ï¼š

```
é€‰æ‹©Eurekaï¼Œå¦‚æœï¼š
ğŸ”¸ ä½¿ç”¨Spring Cloudå…¨å®¶æ¡¶
ğŸ”¸ å¯¹ä¸€è‡´æ€§è¦æ±‚ä¸é«˜
ğŸ”¸ å¸Œæœ›ç®€å•å¿«é€Ÿä¸Šæ‰‹
ğŸ”¸ å›¢é˜Ÿä»¥Javaä¸ºä¸»

é€‰æ‹©Consulï¼Œå¦‚æœï¼š
ğŸ”¸ éœ€è¦å¼ºä¸€è‡´æ€§
ğŸ”¸ å¤šæ•°æ®ä¸­å¿ƒéƒ¨ç½²
ğŸ”¸ éœ€è¦ä¸°å¯Œçš„å¥åº·æ£€æŸ¥
ğŸ”¸ æŠ€æœ¯æ ˆå¤šæ ·åŒ–

é€‰æ‹©Nacosï¼Œå¦‚æœï¼š
ğŸ”¸ å›½å†…å›¢é˜Ÿï¼Œä¸­æ–‡æ–‡æ¡£å‹å¥½
ğŸ”¸ éœ€è¦é…ç½®ç®¡ç†åŠŸèƒ½
ğŸ”¸ å¯¹ç•Œé¢ç®¡ç†æœ‰è¦æ±‚
ğŸ”¸ å¸Œæœ›åŠŸèƒ½ä¸€ç«™å¼è§£å†³
```

---

## 3. ğŸ’— æœåŠ¡å¥åº·æ£€æŸ¥æœºåˆ¶


### 3.1 ä¸ºä»€ä¹ˆéœ€è¦å¥åº·æ£€æŸ¥


**ğŸ¥ å¥åº·æ£€æŸ¥çš„é‡è¦æ€§**
> **åŒ»ç–—ç±»æ¯”**ï¼šå°±åƒå®šæœŸä½“æ£€ä¸€æ ·
> - **ä¸»åŠ¨æ£€æŸ¥**ï¼šå®šæœŸè¯¢é—®"ä½ è¿˜å¥½å—ï¼Ÿ"
> - **å¼‚å¸¸å‘ç°**ï¼šåŠæ—¶å‘ç°é—®é¢˜æœåŠ¡
> - **è‡ªåŠ¨å¤„ç†**ï¼šå°†"ç”Ÿç—…"çš„æœåŠ¡éš”ç¦»
> - **æ¢å¤ç›‘æ§**ï¼šæœåŠ¡æ¢å¤åé‡æ–°çº³å…¥

**ğŸ”¸ å¥åº·æ£€æŸ¥è§£å†³çš„é—®é¢˜**
```
æ²¡æœ‰å¥åº·æ£€æŸ¥çš„åæœï¼š
ç”¨æˆ·è¯·æ±‚ â†’ è´Ÿè½½å‡è¡¡ â†’ å·²æŒ‚æ‰çš„æœåŠ¡ â†’ è¶…æ—¶æŠ¥é”™ â†’ ç”¨æˆ·ä½“éªŒå·®

æœ‰äº†å¥åº·æ£€æŸ¥ï¼š
ç”¨æˆ·è¯·æ±‚ â†’ è´Ÿè½½å‡è¡¡ â†’ å¥åº·çš„æœåŠ¡ â†’ æ­£å¸¸å“åº” â†’ ç”¨æˆ·ä½“éªŒå¥½
                  â†‘
            è‡ªåŠ¨å‰”é™¤æ•…éšœæœåŠ¡
```

### 3.2 å¸¸è§å¥åº·æ£€æŸ¥æ–¹å¼


**ğŸ“Š å¥åº·æ£€æŸ¥æ–¹å¼å¯¹æ¯”**

| æ£€æŸ¥æ–¹å¼ | **å·¥ä½œåŸç†** | **ä¼˜ç‚¹** | **ç¼ºç‚¹** | **é€‚ç”¨åœºæ™¯** |
|---------|-------------|---------|---------|-------------|
| **å¿ƒè·³æ£€æŸ¥** | `å®¢æˆ·ç«¯å®šæœŸå‘é€å¿ƒè·³` | `ç®€å•è½»é‡` | `ç½‘ç»œé—®é¢˜è¯¯åˆ¤` | `å†…ç½‘ç¯å¢ƒ` |
| **HTTPæ£€æŸ¥** | `GET /healthæ¥å£` | `å¯æ£€æŸ¥åº”ç”¨çŠ¶æ€` | `éœ€è¦æš´éœ²æ¥å£` | `WebæœåŠ¡` |
| **TCPæ£€æŸ¥** | `å°è¯•å»ºç«‹TCPè¿æ¥` | `æ£€æŸ¥ç«¯å£å¯ç”¨æ€§` | `æ— æ³•çŸ¥é“åº”ç”¨çŠ¶æ€` | `åŸºç¡€æœåŠ¡` |
| **è„šæœ¬æ£€æŸ¥** | `æ‰§è¡Œè‡ªå®šä¹‰è„šæœ¬` | `æ£€æŸ¥é€»è¾‘çµæ´»` | `å¤æ‚åº¦é«˜` | `å¤æ‚æ£€æŸ¥éœ€æ±‚` |

### 3.3 Spring Bootå¥åº·æ£€æŸ¥å®ç°


**ğŸ”§ Spring Boot Actuatorå¥åº·ç«¯ç‚¹**

Spring Bootæä¾›äº†å¼€ç®±å³ç”¨çš„å¥åº·æ£€æŸ¥ï¼š

```java
// 1. æ·»åŠ ä¾èµ–å³å¯
// spring-boot-starter-actuator

// 2. é…ç½®æ–‡ä»¶å¼€å¯å¥åº·æ£€æŸ¥
management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: always

// 3. è®¿é—®å¥åº·æ£€æŸ¥ç«¯ç‚¹
// GET http://localhost:8080/actuator/health
```

**ğŸ’¡ å¥åº·æ£€æŸ¥å“åº”ç¤ºä¾‹**
```json
{
  "status": "UP",
  "details": {
    "diskSpace": {
      "status": "UP",
      "details": {
        "total": 250790436864,
        "free": 27635712000,
        "threshold": 10485760
      }
    },
    "db": {
      "status": "UP",
      "details": {
        "database": "MySQL",
        "result": 1,
        "validationQuery": "SELECT 1"
      }
    }
  }
}
```

### 3.4 è‡ªå®šä¹‰å¥åº·æ£€æŸ¥


**ğŸ¯ ä¸šåŠ¡çº§å¥åº·æ£€æŸ¥**

æœ‰æ—¶æˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰å¥åº·æ£€æŸ¥é€»è¾‘ï¼š

```java
@Component
public class CustomHealthIndicator implements HealthIndicator {
    
    @Override
    public Health health() {
        // æ£€æŸ¥ä¸šåŠ¡ç³»ç»ŸçŠ¶æ€
        if (isSystemHealthy()) {
            return Health.up()
                .withDetail("ç³»ç»ŸçŠ¶æ€", "æ­£å¸¸è¿è¡Œ")
                .withDetail("æ´»è·ƒè¿æ¥æ•°", getActiveConnections())
                .build();
        } else {
            return Health.down()
                .withDetail("é”™è¯¯ä¿¡æ¯", "ç³»ç»Ÿç¹å¿™")
                .build();
        }
    }
    
    private boolean isSystemHealthy() {
        // è‡ªå®šä¹‰æ£€æŸ¥é€»è¾‘ï¼š
        // - æ•°æ®åº“è¿æ¥æ˜¯å¦æ­£å¸¸
        // - ç¼“å­˜æ˜¯å¦å¯ç”¨
        // - å¤–éƒ¨APIæ˜¯å¦å¯è¾¾
        // - ç³»ç»Ÿè´Ÿè½½æ˜¯å¦è¿‡é«˜
        return checkDatabase() && checkCache() && checkExternalAPI();
    }
}
```

### 3.5 å¥åº·æ£€æŸ¥æœ€ä½³å®è·µ


**âœ… å¥åº·æ£€æŸ¥é…ç½®å»ºè®®**

```
æ£€æŸ¥é—´éš”è®¾ç½®ï¼š
ğŸ”¸ æ£€æŸ¥é—´éš”ï¼š30ç§’ï¼ˆå¹³è¡¡åŠæ—¶æ€§å’Œæ€§èƒ½ï¼‰
ğŸ”¸ è¶…æ—¶æ—¶é—´ï¼š10ç§’ï¼ˆé¿å…æ…¢å“åº”å½±å“ï¼‰
ğŸ”¸ å¤±è´¥é˜ˆå€¼ï¼šè¿ç»­3æ¬¡å¤±è´¥æ‰å‰”é™¤
ğŸ”¸ æ¢å¤æ£€æŸ¥ï¼šæ¯60ç§’æ£€æŸ¥ä¸€æ¬¡ç¦»çº¿æœåŠ¡

æ£€æŸ¥å†…å®¹å±‚æ¬¡ï¼š
Level 1: è¿›ç¨‹å­˜æ´»ï¼ˆæœ€åŸºç¡€ï¼‰
Level 2: ç«¯å£å¯è¾¾ï¼ˆç½‘ç»œå±‚é¢ï¼‰
Level 3: åº”ç”¨å“åº”ï¼ˆåº”ç”¨å±‚é¢ï¼‰
Level 4: ä¸šåŠ¡å¯ç”¨ï¼ˆä¸šåŠ¡å±‚é¢ï¼‰
```

---

## 4. â¬‡ï¸ æœåŠ¡ä¸‹çº¿ä¸å‰”é™¤


### 4.1 æœåŠ¡ä¸‹çº¿çš„åœºæ™¯


**ğŸ”¸ ä¸»åŠ¨ä¸‹çº¿ vs è¢«åŠ¨å‰”é™¤**

```
ä¸»åŠ¨ä¸‹çº¿ï¼ˆä¼˜é›…ä¸‹çº¿ï¼‰ï¼š
åœºæ™¯ï¼šæœåŠ¡å‡çº§ã€ç»´æŠ¤ã€è¿ç§»
æµç¨‹ï¼šæœåŠ¡ â†’ é€šçŸ¥æ³¨å†Œä¸­å¿ƒ â†’ åœæ­¢æ¥å—æ–°è¯·æ±‚ â†’ å¤„ç†å®Œç°æœ‰è¯·æ±‚ â†’ å…³é—­

è¢«åŠ¨å‰”é™¤ï¼ˆæ•…éšœå‰”é™¤ï¼‰ï¼š
åœºæ™¯ï¼šæœåŠ¡å´©æºƒã€ç½‘ç»œæ•…éšœã€æœºå™¨å®•æœº
æµç¨‹ï¼šå¥åº·æ£€æŸ¥å¤±è´¥ â†’ è¿ç»­è¶…æ—¶ â†’ æ³¨å†Œä¸­å¿ƒå‰”é™¤ â†’ é€šçŸ¥æ¶ˆè´¹è€…

æœåŠ¡ä¸‹çº¿æµç¨‹å›¾ï¼š
æ­£å¸¸ä¸‹çº¿ï¼š
æœåŠ¡å®ä¾‹ â”€â”€é€šçŸ¥â”€â”€â†’ æ³¨å†Œä¸­å¿ƒ â”€â”€å¹¿æ’­â”€â”€â†’ å…¶ä»–æœåŠ¡
    â†“                  â†“              â†“
  åœæ­¢æ¥å—è¯·æ±‚        åˆ é™¤æ³¨å†Œä¿¡æ¯      æ›´æ–°æœåŠ¡åˆ—è¡¨

å¼‚å¸¸å‰”é™¤ï¼š
æœåŠ¡å®ä¾‹ Ã—Ã—å¼‚å¸¸Ã—Ã—    æ³¨å†Œä¸­å¿ƒ â”€â”€å¹¿æ’­â”€â”€â†’ å…¶ä»–æœåŠ¡
    â†“                  â†“              â†“
  æ— æ³•å“åº”            å¥åº·æ£€æŸ¥å¤±è´¥      ç§»é™¤æ•…éšœå®ä¾‹
```

### 4.2 ä¼˜é›…ä¸‹çº¿å®ç°


**ğŸ¯ Spring Bootä¼˜é›…ä¸‹çº¿**

```java
@RestController
public class ShutdownController {
    
    @Autowired
    private DiscoveryClient discoveryClient;
    
    // ä¸‹çº¿å‰çš„å‡†å¤‡å·¥ä½œ
    @PostMapping("/prepare-shutdown")
    public String prepareShutdown() {
        // 1. æ ‡è®°æœåŠ¡ä¸ºä¸‹çº¿çŠ¶æ€ï¼ˆåœæ­¢æ¥å—æ–°è¯·æ±‚ï¼‰
        setServiceStatus("DOWN");
        
        // 2. ç­‰å¾…ç°æœ‰è¯·æ±‚å¤„ç†å®Œæˆ
        waitForRequestsToComplete();
        
        // 3. ä»æ³¨å†Œä¸­å¿ƒæ³¨é”€
        deregisterFromRegistry();
        
        return "æœåŠ¡å‡†å¤‡ä¸‹çº¿å®Œæˆ";
    }
    
    private void setServiceStatus(String status) {
        // è®¾ç½®å¥åº·çŠ¶æ€ä¸ºDOWNï¼Œå¥åº·æ£€æŸ¥ä¼šè¿”å›DOWNçŠ¶æ€
        // æ³¨å†Œä¸­å¿ƒä¼šè‡ªåŠ¨å‰”é™¤DOWNçŠ¶æ€çš„æœåŠ¡
    }
}

// é…ç½®ä¼˜é›…å…³é—­
server:
  shutdown: graceful  # å¼€å¯ä¼˜é›…å…³é—­
spring:
  lifecycle:
    timeout-per-shutdown-phase: 30s  # ç­‰å¾…30ç§’å¤„ç†å®Œè¯·æ±‚
```

### 4.3 æœåŠ¡å‰”é™¤ç­–ç•¥


**âš™ï¸ ä¸åŒæ³¨å†Œä¸­å¿ƒçš„å‰”é™¤ç­–ç•¥**

```
Eurekaå‰”é™¤ç­–ç•¥ï¼š
â€¢ å¿ƒè·³é—´éš”ï¼šé»˜è®¤30ç§’
â€¢ å‰”é™¤æ—¶é—´ï¼š90ç§’æ— å¿ƒè·³åˆ™å‰”é™¤
â€¢ è‡ªæˆ‘ä¿æŠ¤ï¼šç½‘ç»œåˆ†åŒºæ—¶ä¸å‰”é™¤æœåŠ¡

Consulå‰”é™¤ç­–ç•¥ï¼š
â€¢ æ£€æŸ¥é—´éš”ï¼šé»˜è®¤10ç§’
â€¢ å¤±è´¥é˜ˆå€¼ï¼šè¿ç»­3æ¬¡æ£€æŸ¥å¤±è´¥
â€¢ å‰”é™¤æ—¶é—´ï¼šå¤±è´¥åç«‹å³å‰”é™¤

Nacoså‰”é™¤ç­–ç•¥ï¼š
â€¢ å¿ƒè·³é—´éš”ï¼šé»˜è®¤5ç§’
â€¢ å‰”é™¤æ—¶é—´ï¼š15ç§’æ— å¿ƒè·³åˆ™æ ‡è®°ä¸å¥åº·
â€¢ ä¿æŠ¤æœºåˆ¶ï¼šå¯é…ç½®ä¿æŠ¤é˜ˆå€¼
```

### 4.4 å¤„ç†æœåŠ¡å‰”é™¤çš„æœ€ä½³å®è·µ


**ğŸ›¡ï¸ æ¶ˆè´¹ç«¯å®¹é”™å¤„ç†**

å½“æœåŠ¡è¢«å‰”é™¤æ—¶ï¼Œæ¶ˆè´¹ç«¯éœ€è¦æœ‰å®¹é”™æœºåˆ¶ï¼š

```java
@Service
public class UserServiceClient {
    
    @Autowired
    private RestTemplate restTemplate;
    
    @Retryable(value = {Exception.class}, maxAttempts = 3)
    public User getUserById(Long id) {
        try {
            // è°ƒç”¨ç”¨æˆ·æœåŠ¡
            return restTemplate.getForObject(
                "http://user-service/users/" + id, User.class);
        } catch (Exception e) {
            // è®°å½•å¼‚å¸¸ï¼Œè§¦å‘é‡è¯•
            log.warn("è°ƒç”¨ç”¨æˆ·æœåŠ¡å¤±è´¥ï¼Œæ­£åœ¨é‡è¯•: {}", e.getMessage());
            throw e;
        }
    }
    
    @Recover
    public User recover(Exception ex, Long id) {
        // æ‰€æœ‰é‡è¯•éƒ½å¤±è´¥åçš„é™çº§å¤„ç†
        log.error("ç”¨æˆ·æœåŠ¡ä¸å¯ç”¨ï¼Œè¿”å›é»˜è®¤ç”¨æˆ·ä¿¡æ¯");
        return User.builder()
            .id(id)
            .name("é»˜è®¤ç”¨æˆ·")
            .build();
    }
}
```

---

## 5. ğŸ”§ é›†ç¾¤éƒ¨ç½²ç­–ç•¥


### 5.1 ä¸ºä»€ä¹ˆè¦é›†ç¾¤éƒ¨ç½²


**ğŸ¢ é›†ç¾¤éƒ¨ç½²çš„ä»·å€¼**

> **é“¶è¡Œè¥ä¸šå…ç±»æ¯”**ï¼š
> - **å•ç‚¹è¥ä¸šå…**ï¼šåªæœ‰ä¸€ä¸ªè¥ä¸šå…ï¼Œæ’é˜Ÿé•¿ï¼Œæœ‰æ•…éšœå°±å…¨éƒ¨åœä¸š
> - **å¤šç‚¹è¥ä¸šå…**ï¼šå¤šä¸ªè¥ä¸šå…ï¼Œåˆ†æµå®¢æˆ·ï¼Œä¸€ä¸ªåäº†è¿˜æœ‰å…¶ä»–çš„

```
å•æœºæ³¨å†Œä¸­å¿ƒçš„é£é™©ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ³¨å†Œä¸­å¿ƒ   â”‚ â† å•ç‚¹æ•…éšœï¼Œæ•´ä¸ªç³»ç»Ÿç˜«ç—ª
â”‚   Eureka    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†‘
    æ‰€æœ‰æœåŠ¡ä¾èµ–è¿™ä¸€ä¸ªç‚¹

é›†ç¾¤æ³¨å†Œä¸­å¿ƒçš„ä¼˜åŠ¿ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ³¨å†Œä¸­å¿ƒ1  â”‚  â”‚  æ³¨å†Œä¸­å¿ƒ2  â”‚  â”‚  æ³¨å†Œä¸­å¿ƒ3  â”‚
â”‚   Eureka    â”‚â†â†’â”‚   Eureka    â”‚â†â†’â”‚   Eureka    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†‘              â†‘              â†‘
    æœåŠ¡å¯ä»¥è¿æ¥ä»»æ„ä¸€ä¸ªï¼Œäº’ä¸ºå¤‡ä»½
```

### 5.2 Eurekaé›†ç¾¤éƒ¨ç½²


**ğŸ”„ Eurekaé›†ç¾¤é…ç½®**

```yaml
# eureka-server-1 é…ç½®
server:
  port: 8761
spring:
  application:
    name: eureka-server
eureka:
  instance:
    hostname: eureka-server-1
  client:
    service-url:
      defaultZone: http://eureka-server-2:8762/eureka/,http://eureka-server-3:8763/eureka/
    fetch-registry: true
    register-with-eureka: true

# eureka-server-2 é…ç½®  
server:
  port: 8762
spring:
  application:
    name: eureka-server
eureka:
  instance:
    hostname: eureka-server-2  
  client:
    service-url:
      defaultZone: http://eureka-server-1:8761/eureka/,http://eureka-server-3:8763/eureka/

# eureka-server-3 é…ç½®
server:
  port: 8763
spring:
  application:
    name: eureka-server
eureka:
  instance:
    hostname: eureka-server-3
  client:
    service-url:
      defaultZone: http://eureka-server-1:8761/eureka/,http://eureka-server-2:8762/eureka/
```

**ğŸ’¡ é›†ç¾¤éƒ¨ç½²åŸç†**
```
Eurekaé›†ç¾¤åŒæ­¥æœºåˆ¶ï¼š
èŠ‚ç‚¹1 â†â†’ èŠ‚ç‚¹2 â†â†’ èŠ‚ç‚¹3
  â†‘                 â†“
  â””â”€â”€â”€â”€â”€ç›¸äº’åŒæ­¥â”€â”€â”€â”€â”€â”˜

åŒæ­¥å†…å®¹ï¼š
â€¢ æœåŠ¡æ³¨å†Œä¿¡æ¯
â€¢ æœåŠ¡çŠ¶æ€å˜æ›´  
â€¢ å¿ƒè·³ç»­çº¦ä¿¡æ¯

å®¢æˆ·ç«¯é…ç½®ï¼š
spring:
  cloud:
    eureka:
      client:
        service-url:
          defaultZone: http://eureka1:8761/eureka/,http://eureka2:8762/eureka/,http://eureka3:8763/eureka/
```

### 5.3 æœåŠ¡ç«¯é›†ç¾¤æœ€ä½³å®è·µ


**ğŸ—ï¸ é›†ç¾¤æ¶æ„å»ºè®®**

```
ç”Ÿäº§ç¯å¢ƒé›†ç¾¤è§„åˆ’ï¼š

æœ€å°å¯ç”¨é›†ç¾¤ï¼š3èŠ‚ç‚¹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   DC1    â”‚  â”‚   DC2    â”‚  â”‚   DC3    â”‚
â”‚ Eureka-1 â”‚  â”‚ Eureka-2 â”‚  â”‚ Eureka-3 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç½‘ç»œé…ç½®ï¼š
â€¢ å„èŠ‚ç‚¹ä¹‹é—´ç½‘ç»œäº’é€š
â€¢ å®¢æˆ·ç«¯èƒ½è®¿é—®æ‰€æœ‰èŠ‚ç‚¹
â€¢ å»ºè®®è·¨æœºæ¶éƒ¨ç½²ï¼Œé¿å…å•ç‚¹æ•…éšœ

èµ„æºé…ç½®ï¼š
â€¢ CPU: 2æ ¸ä»¥ä¸Š
â€¢ å†…å­˜: 4GBä»¥ä¸Šï¼ˆæ”¯æŒå¤§é‡æœåŠ¡ï¼‰
â€¢ ç£ç›˜: SSDï¼Œä¿è¯IOæ€§èƒ½
â€¢ ç½‘ç»œ: åƒå…†ç½‘å¡
```

### 5.4 å®¢æˆ·ç«¯é›†ç¾¤è¿æ¥ç­–ç•¥


**ğŸ”— å®¢æˆ·ç«¯è¿æ¥ç­–ç•¥**

```java
// å¤šæ³¨å†Œä¸­å¿ƒé…ç½®
@Configuration  
public class EurekaClientConfig {
    
    @Value("${eureka.client.service-url.defaultZone}")
    private String eurekaServerUrl;
    
    // å®¢æˆ·ç«¯ä¼šè‡ªåŠ¨å®ç°æ•…éšœè½¬ç§»
    // å¦‚æœè¿æ¥çš„EurekaæœåŠ¡å™¨æ•…éšœï¼Œä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ª
}

æ•…éšœè½¬ç§»æœºåˆ¶ï¼š
å®¢æˆ·ç«¯ â†’ Eureka-1 (ä¸»)  âœ… æ­£å¸¸è¿æ¥
å®¢æˆ·ç«¯ â†’ Eureka-1 (ä¸»)  âŒ è¿æ¥å¤±è´¥
         â†“ è‡ªåŠ¨åˆ‡æ¢
å®¢æˆ·ç«¯ â†’ Eureka-2 (å¤‡)  âœ… è¿æ¥æˆåŠŸ

è¿æ¥ç­–ç•¥ï¼š
â€¢ éšæœºé€‰æ‹©ä¸€ä¸ªEureka Serverè¿æ¥
â€¢ è¿æ¥å¤±è´¥æ—¶ï¼Œå°è¯•ä¸‹ä¸€ä¸ª
â€¢ æ‰€æœ‰è¿æ¥éƒ½å¤±è´¥æ—¶ï¼Œä½¿ç”¨æœ¬åœ°ç¼“å­˜
â€¢ å®šæœŸé‡è¯•è¿æ¥
```

---

## 6. ğŸ›¡ï¸ æ³¨å†Œä¸­å¿ƒé«˜å¯ç”¨


### 6.1 é«˜å¯ç”¨è®¾è®¡åŸåˆ™


**ğŸ”¸ é«˜å¯ç”¨çš„æ ¸å¿ƒè¦ç´ **

```
é«˜å¯ç”¨çš„å››ä¸ªç»´åº¦ï¼š

å¯ç”¨æ€§(Availability)ï¼š
æœåŠ¡èƒ½å¦æ­£å¸¸æä¾›æœåŠ¡
ç›®æ ‡ï¼š99.9% â†’ æ¯æœˆæ•…éšœæ—¶é—´ < 43åˆ†é’Ÿ

å¯é æ€§(Reliability)ï¼š
æœåŠ¡æ˜¯å¦ç¨³å®šå¯ä¿¡èµ–
æªæ–½ï¼šå†—ä½™å¤‡ä»½ã€æ•…éšœæ¢å¤

å¯æ‰©å±•æ€§(Scalability)ï¼š
æœåŠ¡èƒ½å¦åº”å¯¹å¢é•¿çš„å‹åŠ›
æ–¹æ¡ˆï¼šæ°´å¹³æ‰©å®¹ã€è´Ÿè½½å‡è¡¡

å¯ç»´æŠ¤æ€§(Maintainability)ï¼š
æœåŠ¡èƒ½å¦ä¾¿æ·è¿ç»´ç®¡ç†
è¦æ±‚ï¼šç›‘æ§å®Œå–„ã€æ“ä½œç®€å•
```

### 6.2 æ•°æ®ä¸€è‡´æ€§ä¸å¯ç”¨æ€§æƒè¡¡


**âš–ï¸ CAPå®šç†åœ¨æ³¨å†Œä¸­å¿ƒçš„ä½“ç°**

```
CAPå®šç†çš„é€‰æ‹©ï¼š

ä¸€è‡´æ€§ä¼˜å…ˆ(CP)ï¼š
ä»£è¡¨ï¼šConsul
ç‰¹ç‚¹ï¼šæ•°æ®å¼ºä¸€è‡´ï¼Œç½‘ç»œåˆ†åŒºæ—¶å¯èƒ½ä¸å¯ç”¨
åœºæ™¯ï¼šé‡‘èç³»ç»Ÿç­‰å¯¹æ•°æ®ä¸€è‡´æ€§è¦æ±‚æé«˜çš„åœºæ™¯

å¯ç”¨æ€§ä¼˜å…ˆ(AP)ï¼š
ä»£è¡¨ï¼šEureka  
ç‰¹ç‚¹ï¼šæœåŠ¡é«˜å¯ç”¨ï¼Œæ•°æ®æœ€ç»ˆä¸€è‡´æ€§
åœºæ™¯ï¼šäº’è”ç½‘åº”ç”¨ï¼Œç”¨æˆ·ä½“éªŒä¼˜å…ˆ

å¹³è¡¡æ–¹æ¡ˆï¼š
ä»£è¡¨ï¼šNacos
ç‰¹ç‚¹ï¼šå¯é…ç½®CP/APæ¨¡å¼
åœºæ™¯ï¼šä¸åŒä¸šåŠ¡åœºæ™¯çµæ´»é€‰æ‹©
```

**ğŸ¯ å®é™…æƒè¡¡è€ƒè™‘**
```
é€‰æ‹©CPæ¨¡å¼çš„åœºæ™¯ï¼š
âœ… é…ç½®ç®¡ç†ï¼ˆé…ç½®é”™è¯¯å½±å“ä¸¥é‡ï¼‰
âœ… åˆ†å¸ƒå¼é”ï¼ˆæ•°æ®ä¸€è‡´æ€§å…³é”®ï¼‰  
âœ… é‡‘èäº¤æ˜“ï¼ˆç»å¯¹ä¸èƒ½å‡ºé”™ï¼‰

é€‰æ‹©APæ¨¡å¼çš„åœºæ™¯ï¼š
âœ… æœåŠ¡å‘ç°ï¼ˆçŸ­æš‚ä¸ä¸€è‡´å½±å“æœ‰é™ï¼‰
âœ… è´Ÿè½½å‡è¡¡ï¼ˆå¯ä»¥å®¹å¿éƒ¨åˆ†é”™è¯¯ï¼‰
âœ… é«˜å¹¶å‘ç³»ç»Ÿï¼ˆå¯ç”¨æ€§ä¼˜å…ˆï¼‰
```

### 6.3 ç›‘æ§ä¸å‘Šè­¦ä½“ç³»


**ğŸ“Š æ³¨å†Œä¸­å¿ƒç›‘æ§æŒ‡æ ‡**

```
æ ¸å¿ƒç›‘æ§æŒ‡æ ‡ï¼š

æœåŠ¡å¥åº·åº¦ï¼š
â€¢ æ³¨å†ŒæœåŠ¡æ•°é‡è¶‹åŠ¿
â€¢ å¥åº·/ä¸å¥åº·æœåŠ¡æ¯”ä¾‹
â€¢ æœåŠ¡æ³¨å†Œ/ä¸‹çº¿é¢‘ç‡

ç³»ç»Ÿæ€§èƒ½ï¼š
â€¢ CPUä½¿ç”¨ç‡
â€¢ å†…å­˜ä½¿ç”¨ç‡  
â€¢ ç½‘ç»œè¿æ¥æ•°
â€¢ å“åº”æ—¶é—´

ä¸šåŠ¡æŒ‡æ ‡ï¼š
â€¢ å¿ƒè·³æˆåŠŸç‡
â€¢ æœåŠ¡å‘ç°è¯·æ±‚QPS
â€¢ æ•°æ®åŒæ­¥å»¶è¿Ÿ

å‘Šè­¦è®¾ç½®ï¼š
ğŸ”´ P0: æ³¨å†Œä¸­å¿ƒä¸å¯ç”¨ï¼ˆç«‹å³å‘Šè­¦ï¼‰
ğŸŸ¡ P1: æœåŠ¡å¥åº·åº¦ < 80%ï¼ˆ5åˆ†é’Ÿå‘Šè­¦ï¼‰  
ğŸŸ¢ P2: å“åº”æ—¶é—´ > 1ç§’ï¼ˆ15åˆ†é’Ÿå‘Šè­¦ï¼‰
```

**ğŸ”§ ç›‘æ§å®ç°ç¤ºä¾‹**

```java
// ä½¿ç”¨Micrometerç›‘æ§æ³¨å†Œä¸­å¿ƒçŠ¶æ€
@Component
public class RegistryHealthMetrics {
    
    private final MeterRegistry meterRegistry;
    private final DiscoveryClient discoveryClient;
    
    // å®šæœŸæ”¶é›†å¥åº·åº¦æŒ‡æ ‡
    @Scheduled(fixedRate = 30000)  // æ¯30ç§’é‡‡é›†ä¸€æ¬¡
    public void collectHealthMetrics() {
        List<String> services = discoveryClient.getServices();
        
        // ç»Ÿè®¡æœåŠ¡æ•°é‡
        Gauge.builder("registry.services.count")
            .description("æ³¨å†Œçš„æœåŠ¡æ€»æ•°")
            .register(meterRegistry, services, List::size);
            
        // ç»Ÿè®¡å¥åº·æœåŠ¡æ¯”ä¾‹
        long healthyCount = services.stream()
            .mapToLong(this::getHealthyInstanceCount)
            .sum();
            
        Gauge.builder("registry.services.healthy.ratio")  
            .description("å¥åº·æœåŠ¡æ¯”ä¾‹")
            .register(meterRegistry, healthyCount, this::calculateHealthyRatio);
    }
}
```

### 6.4 å®¹ç¾ä¸æ¢å¤ç­–ç•¥


**ğŸš¨ å®¹ç¾é¢„æ¡ˆ**

```
æ•…éšœç­‰çº§ä¸å¤„ç†ï¼š

Level 1: å•èŠ‚ç‚¹æ•…éšœ
å½±å“ï¼šéƒ¨åˆ†å®¢æˆ·ç«¯è¿æ¥å¼‚å¸¸
å¤„ç†ï¼šå®¢æˆ·ç«¯è‡ªåŠ¨åˆ‡æ¢ï¼Œä¿®å¤æ•…éšœèŠ‚ç‚¹

Level 2: å¤šèŠ‚ç‚¹æ•…éšœ  
å½±å“ï¼šæœåŠ¡å‘ç°èƒ½åŠ›ä¸‹é™
å¤„ç†ï¼šå¯ç”¨å¤‡ç”¨é›†ç¾¤ï¼Œç´§æ€¥æ‰©å®¹

Level 3: æ•´ä¸ªé›†ç¾¤æ•…éšœ
å½±å“ï¼šæ‰€æœ‰æœåŠ¡å‘ç°ä¸å¯ç”¨
å¤„ç†ï¼šå¯åŠ¨åº”æ€¥é¢„æ¡ˆï¼Œä½¿ç”¨æœ¬åœ°ç¼“å­˜

åº”æ€¥æªæ–½ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æœ¬åœ°ç¼“å­˜       â”‚ â† å®¢æˆ·ç«¯ä¿å­˜æœåŠ¡åˆ—è¡¨å‰¯æœ¬
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   é…ç½®æ–‡ä»¶       â”‚ â† é™æ€é…ç½®å…³é”®æœåŠ¡åœ°å€  
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å¤‡ç”¨é›†ç¾¤       â”‚ â† å¼‚åœ°å¤‡ç”¨æ³¨å†Œä¸­å¿ƒ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”„ æ•°æ®æ¢å¤æœºåˆ¶**

```
è‡ªåŠ¨æ¢å¤æµç¨‹ï¼š

1. èŠ‚ç‚¹é‡å¯åè‡ªåŠ¨åŠ å…¥é›†ç¾¤
2. ä»å…¶ä»–èŠ‚ç‚¹åŒæ­¥æœåŠ¡æ³¨å†Œæ•°æ®  
3. é‡æ–°å¼€å§‹å¥åº·æ£€æŸ¥
4. å®¢æˆ·ç«¯é‡æ–°è¿æ¥å¹¶æ›´æ–°ç¼“å­˜

æ‰‹åŠ¨æ¢å¤æ­¥éª¤ï¼š
â€¢ æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
â€¢ éªŒè¯é…ç½®æ–‡ä»¶æ­£ç¡®æ€§
â€¢ æ¸…ç†æ— æ•ˆçš„æ•°æ®æ–‡ä»¶
â€¢ é‡å¯æœåŠ¡å¹¶è§‚å¯Ÿæ—¥å¿—
â€¢ éªŒè¯é›†ç¾¤åŒæ­¥çŠ¶æ€
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æœåŠ¡æ³¨å†Œä¸­å¿ƒ = å¾®æœåŠ¡çš„"é€šè®¯å½•" + "ä½“æ£€ä¸­å¿ƒ"
ğŸ”¸ ä¸»æµé€‰æ‹©ï¼šEureka(ç®€å•)ã€Consul(åŠŸèƒ½å¼º)ã€Nacos(å…¨é¢)  
ğŸ”¸ å¥åº·æ£€æŸ¥ï¼šå¿ƒè·³ã€HTTPã€TCPç­‰å¤šç§æ–¹å¼ç»“åˆä½¿ç”¨
ğŸ”¸ æœåŠ¡å‰”é™¤ï¼šä¼˜é›…ä¸‹çº¿ vs æ•…éšœå‰”é™¤ï¼Œè¦æœ‰å®¹é”™æœºåˆ¶
ğŸ”¸ é›†ç¾¤éƒ¨ç½²ï¼šè‡³å°‘3èŠ‚ç‚¹ï¼Œé¿å…å•ç‚¹æ•…éšœ
ğŸ”¸ é«˜å¯ç”¨ï¼šåœ¨ä¸€è‡´æ€§å’Œå¯ç”¨æ€§é—´åšåˆç†æƒè¡¡
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æœåŠ¡æ³¨å†Œå‘ç°çš„æœ¬è´¨**
```
æ ¸å¿ƒè§£å†³çš„é—®é¢˜ï¼š
â€¢ æœåŠ¡åœ¨å“ªï¼Ÿï¼ˆåœ°å€å‘ç°ï¼‰
â€¢ æœåŠ¡å¥½ä¸å¥½ï¼Ÿï¼ˆå¥åº·çŠ¶æ€ï¼‰  
â€¢ æœåŠ¡å˜äº†æ€ä¹ˆåŠï¼Ÿï¼ˆåŠ¨æ€æ›´æ–°ï¼‰

å®ç°æ–¹å¼ï¼š
æ³¨å†Œ â†’ å‘ç° â†’ è°ƒç”¨ â†’ å¥åº·æ£€æŸ¥ â†’ æ›´æ–°
  â†‘                              â†“
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å½¢æˆé—­ç¯ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”¹ ä¸åŒæ³¨å†Œä¸­å¿ƒçš„é€‰æ‹©é€»è¾‘**
```
æŠ€æœ¯é€‰å‹è€ƒè™‘å› ç´ ï¼š
â€¢ å›¢é˜ŸæŠ€æœ¯æ ˆï¼ˆJavaé€‰Eureka/Nacosï¼‰
â€¢ ä¸€è‡´æ€§è¦æ±‚ï¼ˆå¼ºä¸€è‡´æ€§é€‰Consulï¼‰  
â€¢ åŠŸèƒ½éœ€æ±‚ï¼ˆéœ€è¦é…ç½®ç®¡ç†é€‰Nacos/Consulï¼‰
â€¢ è¿ç»´å¤æ‚åº¦ï¼ˆç®€å•å¿«é€Ÿé€‰Eurekaï¼‰
â€¢ ç”Ÿæ€æˆç†Ÿåº¦ï¼ˆSpring Cloudé€‰Eurekaï¼‰
```

### 7.3 å®é™…åº”ç”¨æŒ‡å¯¼


**âœ… æ¨èçš„å®æ–½æ­¥éª¤**
```
ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©æ³¨å†Œä¸­å¿ƒ
â€¢ è¯„ä¼°å›¢é˜ŸæŠ€æœ¯æ ˆå’Œä¸šåŠ¡éœ€æ±‚
â€¢ æ­å»ºæµ‹è¯•ç¯å¢ƒéªŒè¯åŠŸèƒ½

ç¬¬äºŒæ­¥ï¼šé›†ç¾¤è§„åˆ’
â€¢ è‡³å°‘3èŠ‚ç‚¹éƒ¨ç½²
â€¢ è·¨æœºæ¶/æœºæˆ¿éƒ¨ç½²  
â€¢ é…ç½®ç›‘æ§å‘Šè­¦

ç¬¬ä¸‰æ­¥ï¼šå®¢æˆ·ç«¯é›†æˆ
â€¢ é…ç½®å¤šæ³¨å†Œä¸­å¿ƒåœ°å€
â€¢ å®ç°å¥åº·æ£€æŸ¥ç«¯ç‚¹
â€¢ æ·»åŠ é‡è¯•å’Œé™çº§æœºåˆ¶

ç¬¬å››æ­¥ï¼šè¿ç»´ä¿éšœ  
â€¢ å®Œå–„ç›‘æ§æŒ‡æ ‡
â€¢ åˆ¶å®šåº”æ€¥é¢„æ¡ˆ
â€¢ å®šæœŸæ¼”ç»ƒå®¹ç¾
```

**ğŸ¯ ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ**
```
é…ç½®å»ºè®®ï¼š
â€¢ å¿ƒè·³é—´éš”ï¼š30ç§’ï¼ˆå¹³è¡¡åŠæ—¶æ€§å’Œæ€§èƒ½ï¼‰
â€¢ å¥åº·æ£€æŸ¥ï¼šå¤šå±‚æ¬¡æ£€æŸ¥ï¼ˆè¿›ç¨‹+ç«¯å£+åº”ç”¨+ä¸šåŠ¡ï¼‰
â€¢ è¶…æ—¶é…ç½®ï¼šè¯»å–5ç§’ï¼Œè¿æ¥3ç§’
â€¢ é‡è¯•ç­–ç•¥ï¼š3æ¬¡é‡è¯•ï¼ŒæŒ‡æ•°é€€é¿

ç›‘æ§å»ºè®®ï¼š
â€¢ æœåŠ¡æ³¨å†Œæ•°é‡å’Œå¥åº·åº¦
â€¢ æ³¨å†Œä¸­å¿ƒå“åº”æ—¶é—´å’Œå¯ç”¨æ€§  
â€¢ ç½‘ç»œè¿æ¥æ•°å’Œé”™è¯¯ç‡
â€¢ å®¢æˆ·ç«¯ç¼“å­˜å‘½ä¸­ç‡

å®¹ç¾å»ºè®®ï¼š
â€¢ æœ¬åœ°ç¼“å­˜ä¿åº•ï¼ˆå®¢æˆ·ç«¯ç¼“å­˜æœåŠ¡åˆ—è¡¨ï¼‰
â€¢ é™æ€é…ç½®å…œåº•ï¼ˆå…³é”®æœåŠ¡é…ç½®æ–‡ä»¶ï¼‰
â€¢ å¤šé›†ç¾¤å¤‡ä»½ï¼ˆè·¨åœ°åŸŸéƒ¨ç½²ï¼‰
â€¢ åº”æ€¥é¢„æ¡ˆæ¼”ç»ƒï¼ˆå®šæœŸæ•…éšœæ¼”ç»ƒï¼‰
```

### 7.4 å­¦ä¹ æ£€æŸ¥æ¸…å•


**ğŸ“ è‡ªæˆ‘æ£€æµ‹**ï¼š
- [ ] èƒ½è¯´å‡ºæœåŠ¡æ³¨å†Œä¸­å¿ƒçš„æ ¸å¿ƒä½œç”¨
- [ ] èƒ½æ¯”è¾ƒEurekaã€Consulã€Nacosçš„ç‰¹ç‚¹  
- [ ] èƒ½é…ç½®Spring Bootå¥åº·æ£€æŸ¥ç«¯ç‚¹
- [ ] èƒ½è§£é‡Šä¼˜é›…ä¸‹çº¿çš„é‡è¦æ€§
- [ ] èƒ½è®¾è®¡æ³¨å†Œä¸­å¿ƒé›†ç¾¤æ–¹æ¡ˆ
- [ ] èƒ½åˆ¶å®šé«˜å¯ç”¨ç›‘æ§ç­–ç•¥

**ğŸ¯ ä¸€å¥è¯ç²¾å**ï¼š
æœåŠ¡æ³¨å†Œä¸­å¿ƒå°±åƒåŸå¸‚çš„ç”µè¯é»„é¡µï¼Œå¸®åŠ©å¾®æœåŠ¡ç›¸äº’æ‰¾åˆ°å¯¹æ–¹ï¼Œå¹¶ç¡®ä¿æ‰¾åˆ°çš„éƒ½æ˜¯"è¥ä¸šä¸­"çš„å¥åº·æœåŠ¡

**ğŸ§  è®°å¿†å£è¯€**ï¼š
æ³¨å†Œå‘ç°å¥åº·æŸ¥ï¼Œä¸‹çº¿å‰”é™¤è¦ä¼˜é›…ï¼Œ
é›†ç¾¤éƒ¨ç½²é˜²å•ç‚¹ï¼Œç›‘æ§å‘Šè­¦ä¿é«˜å¯