---
title: 7ã€APIç½‘å…³è®¾è®¡ä¸å®ç°
---
## ğŸ“š ç›®å½•

1. [APIç½‘å…³åŸºç¡€æ¦‚å¿µ](#1-APIç½‘å…³åŸºç¡€æ¦‚å¿µ)
2. [ç½‘å…³æ ¸å¿ƒåŠŸèƒ½](#2-ç½‘å…³æ ¸å¿ƒåŠŸèƒ½)
3. [Spring Cloud Gatewayè¯¦è§£](#3-Spring-Cloud-Gatewayè¯¦è§£)
4. [è·¯ç”±è§„åˆ™é…ç½®](#4-è·¯ç”±è§„åˆ™é…ç½®)
5. [è¿‡æ»¤å™¨é“¾è®¾è®¡](#5-è¿‡æ»¤å™¨é“¾è®¾è®¡)
6. [é™æµä¸ç†”æ–­æœºåˆ¶](#6-é™æµä¸ç†”æ–­æœºåˆ¶)
7. [ç½‘å…³ç›‘æ§å‘Šè­¦](#7-ç½‘å…³ç›‘æ§å‘Šè­¦)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸšª APIç½‘å…³åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯APIç½‘å…³


**ğŸ”¸ ç”Ÿæ´»åŒ–ç†è§£**
æƒ³è±¡ä¸€ä¸‹é…’åº—çš„å‰å°ï¼Œæ‰€æœ‰å®¢äººè¿›å‡ºéƒ½è¦ç»è¿‡å‰å°ï¼š
- **ç»Ÿä¸€å…¥å£**ï¼šä¸ç®¡ä½ è¦å»é¤å…ã€å®¢æˆ¿è¿˜æ˜¯ä¼šè®®å®¤ï¼Œéƒ½ä»å‰å°è¿›
- **èº«ä»½éªŒè¯**ï¼šå‰å°ä¼šæ£€æŸ¥ä½ æ˜¯å¦æ˜¯é…’åº—å®¢äºº
- **è·¯çº¿æŒ‡å¼•**ï¼šå‰å°å‘Šè¯‰ä½ æ€ä¹ˆå»ä½ è¦çš„åœ°æ–¹
- **æœåŠ¡åè°ƒ**ï¼šå¸®ä½ é¢„è®¢é¤å…ã€å«å‡ºç§Ÿè½¦ç­‰

APIç½‘å…³å°±æ˜¯å¾®æœåŠ¡ç³»ç»Ÿçš„"å‰å°"ï¼

**ğŸ’¡ ä¸“ä¸šå®šä¹‰**
```
APIç½‘å…³ï¼ˆAPI Gatewayï¼‰ï¼š
â€¢ ä½œç”¨ï¼šå¾®æœåŠ¡æ¶æ„ä¸­çš„ç»Ÿä¸€å…¥å£ç‚¹
â€¢ èŒè´£ï¼šè·¯ç”±è½¬å‘ã€è®¤è¯é‰´æƒã€é™æµç†”æ–­ã€ç›‘æ§æ—¥å¿—
â€¢ ä½ç½®ï¼šå®¢æˆ·ç«¯ä¸åç«¯æœåŠ¡ä¹‹é—´çš„ä¸­é—´å±‚
â€¢ ç›®æ ‡ï¼šç®€åŒ–å®¢æˆ·ç«¯è°ƒç”¨ï¼Œä¿æŠ¤åç«¯æœåŠ¡
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦APIç½‘å…³


**ğŸ¤” æ²¡æœ‰ç½‘å…³çš„é—®é¢˜**
```
ä¼ ç»Ÿæ–¹å¼çš„ç—›ç‚¹ï¼š

å®¢æˆ·ç«¯é—®é¢˜ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ‰‹æœºAPP   â”‚â”€â”€â”€â”€â”‚  ç”¨æˆ·æœåŠ¡   â”‚
â”‚             â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚             â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             â”‚â”€â”€â”€â”€â”‚  å•†å“æœåŠ¡   â”‚
â”‚             â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚             â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             â”‚â”€â”€â”€â”€â”‚  è®¢å•æœåŠ¡   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç—›ç‚¹ï¼š
âŒ å®¢æˆ·ç«¯è¦è®°ä½æ‰€æœ‰æœåŠ¡åœ°å€
âŒ æ¯ä¸ªæœåŠ¡éƒ½è¦å¤„ç†è®¤è¯é€»è¾‘
âŒ è·¨åŸŸé—®é¢˜éš¾ä»¥ç»Ÿä¸€å¤„ç†
âŒ æœåŠ¡å˜æ›´å½±å“æ‰€æœ‰å®¢æˆ·ç«¯
```

**âœ… ä½¿ç”¨ç½‘å…³çš„ä¼˜åŠ¿**
```
ç½‘å…³æ¶æ„ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ‰‹æœºAPP   â”‚    â”‚             â”‚    â”‚  ç”¨æˆ·æœåŠ¡   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚             â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ç½‘é¡µå‰ç«¯  â”‚â”€â”€â”€â”€â”‚  APIç½‘å…³    â”‚â”€â”€â”€â”€â”‚  å•†å“æœåŠ¡   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚             â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç¬¬ä¸‰æ–¹åº”ç”¨ â”‚    â”‚             â”‚    â”‚  è®¢å•æœåŠ¡   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¼˜åŠ¿ï¼š
âœ… ç»Ÿä¸€å…¥å£ï¼Œç®€åŒ–å®¢æˆ·ç«¯
âœ… é›†ä¸­å¤„ç†è®¤è¯é‰´æƒ
âœ… ç»Ÿä¸€è§£å†³è·¨åŸŸé—®é¢˜
âœ… æœåŠ¡å˜æ›´å¯¹å®¢æˆ·ç«¯é€æ˜
```

---

## 2. âš™ï¸ ç½‘å…³æ ¸å¿ƒåŠŸèƒ½


### 2.1 è·¯ç”±è½¬å‘


**ğŸ”¸ æ ¸å¿ƒä½œç”¨**
æŠŠå®¢æˆ·ç«¯è¯·æ±‚è½¬å‘åˆ°æ­£ç¡®çš„åç«¯æœåŠ¡ï¼Œå°±åƒé‚®å±€åˆ†æ‹£å‘˜æŒ‰åœ°å€åˆ†å‘é‚®ä»¶ã€‚

```
è·¯ç”±ç¤ºä¾‹ï¼š
å®¢æˆ·ç«¯è¯·æ±‚                ç½‘å…³è½¬å‘
/api/user/login    â†’    ç”¨æˆ·æœåŠ¡:8081/login
/api/product/list  â†’    å•†å“æœåŠ¡:8082/list  
/api/order/create  â†’    è®¢å•æœåŠ¡:8083/create
```

**ğŸ’­ é€šä¿—ç†è§£**
> ç½‘å…³åƒæ™ºèƒ½å¿«é€’åˆ†æ‹£ä¸­å¿ƒï¼š
> - çœ‹åŒ…è£¹åœ°å€ï¼ˆè¯·æ±‚è·¯å¾„ï¼‰
> - å†³å®šé€åˆ°å“ªä¸ªç½‘ç‚¹ï¼ˆåç«¯æœåŠ¡ï¼‰
> - è‡ªåŠ¨è½¬å‘è¿‡å»ï¼ˆè·¯ç”±è½¬å‘ï¼‰

### 2.2 è®¤è¯é‰´æƒ


**ğŸ”¸ è®¤è¯ï¼ˆAuthenticationï¼‰**
éªŒè¯"ä½ æ˜¯è°"ï¼Œå°±åƒé—¨å«æ£€æŸ¥èº«ä»½è¯ã€‚

```
è®¤è¯æµç¨‹ï¼š
1. å®¢æˆ·ç«¯è¯·æ±‚æºå¸¦token
2. ç½‘å…³éªŒè¯tokenæœ‰æ•ˆæ€§
3. éªŒè¯é€šè¿‡â†’è½¬å‘è¯·æ±‚
4. éªŒè¯å¤±è´¥â†’è¿”å›401é”™è¯¯
```

**ğŸ”¸ é‰´æƒï¼ˆAuthorizationï¼‰**
éªŒè¯"ä½ èƒ½åšä»€ä¹ˆ"ï¼Œå°±åƒæ£€æŸ¥ä½ æœ‰æ²¡æœ‰è¿›å…¥æŸä¸ªåŒºåŸŸçš„æƒé™ã€‚

```
é‰´æƒç¤ºä¾‹ï¼š
æ™®é€šç”¨æˆ·ï¼šåªèƒ½æŸ¥çœ‹è‡ªå·±çš„è®¢å•
ç®¡ç†å‘˜ï¼š  å¯ä»¥æŸ¥çœ‹æ‰€æœ‰è®¢å•
è¶…çº§ç®¡ç†å‘˜ï¼šå¯ä»¥åˆ é™¤ä»»ä½•è®¢å•
```

### 2.3 é™æµæ§åˆ¶


**ğŸ”¸ ä¸ºä»€ä¹ˆè¦é™æµ**
ä¿æŠ¤åç«¯æœåŠ¡ä¸è¢«è¿‡å¤šè¯·æ±‚å‹å®ï¼Œå°±åƒæ™¯åŒºé™åˆ¶æ¸¸å®¢æ•°é‡ã€‚

```
é™æµç­–ç•¥ï¼š

æŒ‰æ—¶é—´çª—å£ï¼šæ¯ç§’æœ€å¤š100ä¸ªè¯·æ±‚
æŒ‰ç”¨æˆ·ç»´åº¦ï¼šæ¯ä¸ªç”¨æˆ·æ¯åˆ†é’Ÿæœ€å¤š10ä¸ªè¯·æ±‚
æŒ‰IPç»´åº¦ï¼š  æ¯ä¸ªIPæ¯å°æ—¶æœ€å¤š1000ä¸ªè¯·æ±‚
```

**ğŸ’¡ ç”Ÿæ´»åŒ–ç±»æ¯”**
> é™æµåƒé“¶è¡Œçª—å£æ’é˜Ÿï¼š
> - åŒæ—¶åªèƒ½æœåŠ¡å›ºå®šæ•°é‡çš„å®¢æˆ·
> - è¶…è¿‡å®¹é‡çš„å®¢æˆ·éœ€è¦ç­‰å¾…
> - é˜²æ­¢é“¶è¡Œå·¥ä½œäººå‘˜ç´¯å®

### 2.4 ç†”æ–­ä¿æŠ¤


**ğŸ”¸ ç†”æ–­æœºåˆ¶**
å½“åç«¯æœåŠ¡å‡ºé—®é¢˜æ—¶ï¼Œæš‚æ—¶åœæ­¢è°ƒç”¨ï¼Œé¿å…çº§è”æ•…éšœã€‚

```
ç†”æ–­çŠ¶æ€ï¼š

å…³é—­çŠ¶æ€ï¼ˆCLOSEDï¼‰ï¼š
â€¢ æ­£å¸¸è°ƒç”¨åç«¯æœåŠ¡
â€¢ è®°å½•å¤±è´¥æ¬¡æ•°

æ‰“å¼€çŠ¶æ€ï¼ˆOPENï¼‰ï¼š
â€¢ ç›´æ¥è¿”å›å¤±è´¥ï¼Œä¸è°ƒç”¨åç«¯
â€¢ ä¿æŠ¤åç«¯æœåŠ¡æ¢å¤

åŠå¼€çŠ¶æ€ï¼ˆHALF-OPENï¼‰ï¼š
â€¢ å°è¯•å°‘é‡è¯·æ±‚æµ‹è¯•
â€¢ æˆåŠŸâ†’å…³é—­ï¼Œå¤±è´¥â†’é‡æ–°æ‰“å¼€
```

**ğŸ”Œ ç”µè·¯ä¿æŠ¤ç±»æ¯”**
> å°±åƒå®¶é‡Œçš„ä¿é™©ä¸ï¼š
> - ç”µæµè¿‡å¤§æ—¶è‡ªåŠ¨æ–­å¼€ï¼ˆç†”æ–­ï¼‰
> - ä¿æŠ¤æ•´ä¸ªç”µè·¯ä¸è¢«çƒ§åï¼ˆçº§è”ä¿æŠ¤ï¼‰
> - é—®é¢˜è§£å†³åå¯ä»¥é‡æ–°åˆä¸Šï¼ˆæ¢å¤ï¼‰

---

## 3. ğŸŒ Spring Cloud Gatewayè¯¦è§£


### 3.1 Gatewayç®€ä»‹


**ğŸ”¸ æŠ€æœ¯ç‰¹ç‚¹**
```
Spring Cloud Gatewayï¼š
â€¢ åŸºäºï¼šSpring Boot 2.x + Spring WebFlux
â€¢ ç‰¹æ€§ï¼šå“åº”å¼ç¼–ç¨‹ï¼Œé«˜æ€§èƒ½å¼‚æ­¥å¤„ç†
â€¢ ä¼˜åŠ¿ï¼šä¸Springç”Ÿæ€æ— ç¼é›†æˆ
â€¢ æ ¸å¿ƒï¼šRouteï¼ˆè·¯ç”±ï¼‰+ Predicateï¼ˆè°“è¯ï¼‰+ Filterï¼ˆè¿‡æ»¤å™¨ï¼‰
```

**ğŸ—ï¸ æ ¸å¿ƒæ¶æ„**
```
è¯·æ±‚å¤„ç†æµç¨‹ï¼š

å®¢æˆ·ç«¯è¯·æ±‚
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Gatewayæ ¸å¿ƒ   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ è·¯ç”±åŒ¹é…  â”‚ â”‚ â† Predicateåˆ¤æ–­
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ è¿‡æ»¤å™¨é“¾  â”‚ â”‚ â† Filterå¤„ç†
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ä»£ç†è½¬å‘  â”‚ â”‚ â† è½¬å‘åˆ°åç«¯
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
  åç«¯æœåŠ¡
```

### 3.2 æ ¸å¿ƒæ¦‚å¿µè¯¦è§£


**ğŸ”¸ Routeï¼ˆè·¯ç”±ï¼‰**
ä¸€æ¡è·¯ç”±è§„åˆ™ï¼Œå®šä¹‰äº†è¯·æ±‚çš„åŒ¹é…æ¡ä»¶å’Œå¤„ç†æ–¹å¼ã€‚

```
è·¯ç”±ç»„æˆï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Route = ID + ç›®æ ‡URI + è°“è¯ + è¿‡æ»¤å™¨  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¤ºä¾‹ç†è§£ï¼š
IDï¼šuser-serviceï¼ˆè·¯ç”±åç§°ï¼‰
ç›®æ ‡URIï¼šhttp://localhost:8081ï¼ˆè½¬å‘åœ°å€ï¼‰
è°“è¯ï¼šPath=/api/user/**ï¼ˆåŒ¹é…æ¡ä»¶ï¼‰
è¿‡æ»¤å™¨ï¼šAddRequestHeader=X-Gateway, trueï¼ˆé™„åŠ å¤„ç†ï¼‰
```

**ğŸ”¸ Predicateï¼ˆè°“è¯ï¼‰**
è·¯ç”±åŒ¹é…çš„æ¡ä»¶ï¼Œå†³å®šè¿™ä¸ªè¯·æ±‚æ˜¯å¦èµ°è¿™æ¡è·¯ç”±ã€‚

```
å¸¸ç”¨è°“è¯ç±»å‹ï¼š

Pathè°“è¯ï¼š     /api/user/**
Methodè°“è¯ï¼š   GET, POST
Headerè°“è¯ï¼š   X-Request-Id
Timeè°“è¯ï¼š     After, Before, Between
```

**ğŸ”¸ Filterï¼ˆè¿‡æ»¤å™¨ï¼‰**
å¯¹è¯·æ±‚/å“åº”è¿›è¡Œå¤„ç†çš„ç»„ä»¶ï¼Œç±»ä¼¼Webå¼€å‘ä¸­çš„æ‹¦æˆªå™¨ã€‚

```
è¿‡æ»¤å™¨åˆ†ç±»ï¼š

å…¨å±€è¿‡æ»¤å™¨ï¼ˆGlobalFilterï¼‰ï¼š
â€¢ ä½œç”¨äºæ‰€æœ‰è·¯ç”±
â€¢ ä¾‹å¦‚ï¼šè®¤è¯ã€æ—¥å¿—è®°å½•

ç½‘å…³è¿‡æ»¤å™¨ï¼ˆGatewayFilterï¼‰ï¼š
â€¢ ä½œç”¨äºç‰¹å®šè·¯ç”±
â€¢ ä¾‹å¦‚ï¼šè¯·æ±‚å¤´æ·»åŠ ã€è·¯å¾„é‡å†™
```

### 3.3 é¡¹ç›®é›†æˆé…ç½®


**ğŸ“¦ ä¾èµ–å¼•å…¥**
```xml
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-gateway</artifactId>
</dependency>
```

**âš™ï¸ åŸºç¡€é…ç½®**
```yaml
server:
  port: 9999

spring:
  application:
    name: api-gateway
  cloud:
    gateway:
      routes:
        - id: user-service
          uri: http://localhost:8081
          predicates:
            - Path=/api/user/**
          filters:
            - StripPrefix=2  # å»æ‰å‰ç¼€/api/user
```

**ğŸ’¡ é…ç½®è§£è¯»**
> - `id`: è·¯ç”±å”¯ä¸€æ ‡è¯†ï¼Œéšä¾¿èµ·å
> - `uri`: è¦è½¬å‘åˆ°å“ªä¸ªæœåŠ¡
> - `predicates`: ä»€ä¹ˆæ ·çš„è¯·æ±‚èµ°è¿™æ¡è·¯ç”±
> - `filters`: è½¬å‘å‰/åè¦åšä»€ä¹ˆå¤„ç†

---

## 4. ğŸ“‹ è·¯ç”±è§„åˆ™é…ç½®


### 4.1 åŸºæœ¬è·¯ç”±é…ç½®


**ğŸ”¸ é…ç½®æ–‡ä»¶æ–¹å¼**
```yaml
spring:
  cloud:
    gateway:
      routes:
        # ç”¨æˆ·æœåŠ¡è·¯ç”±
        - id: user-route
          uri: http://localhost:8081
          predicates:
            - Path=/api/user/**
          filters:
            - StripPrefix=2
            
        # å•†å“æœåŠ¡è·¯ç”±  
        - id: product-route
          uri: http://localhost:8082
          predicates:
            - Path=/api/product/**
          filters:
            - StripPrefix=2
```

**ğŸ”¸ Javaä»£ç æ–¹å¼**
```java
@Configuration
public class GatewayConfig {
    
    @Bean
    public RouteLocator customRouteLocator(RouteLocatorBuilder builder) {
        return builder.routes()
            .route("user-route", r -> r
                .path("/api/user/**")
                .filters(f -> f.stripPrefix(2))
                .uri("http://localhost:8081"))
            .route("product-route", r -> r
                .path("/api/product/**") 
                .filters(f -> f.stripPrefix(2))
                .uri("http://localhost:8082"))
            .build();
    }
}
```

### 4.2 é«˜çº§è°“è¯é…ç½®


**ğŸ“Š è°“è¯ç±»å‹å¯¹æ¯”è¡¨**

| è°“è¯ç±»å‹ | **ä½œç”¨** | **ç¤ºä¾‹** | **ä½¿ç”¨åœºæ™¯** |
|---------|---------|---------|-------------|
| `Path` | `è·¯å¾„åŒ¹é…` | `/api/**` | `æœ€å¸¸ç”¨çš„è·¯ç”±è§„åˆ™` |
| `Method` | `HTTPæ–¹æ³•` | `GET,POST` | `RESTful APIåŒºåˆ†` |
| `Header` | `è¯·æ±‚å¤´åŒ¹é…` | `X-Version=v1` | `APIç‰ˆæœ¬æ§åˆ¶` |
| `Query` | `æŸ¥è¯¢å‚æ•°` | `version=1` | `å‚æ•°è·¯ç”±` |
| `Host` | `åŸŸååŒ¹é…` | `api.example.com` | `å¤šç§Ÿæˆ·ç³»ç»Ÿ` |

**ğŸ”¸ ç»„åˆè°“è¯ç¤ºä¾‹**
```yaml
routes:
  - id: advanced-route
    uri: http://localhost:8081
    predicates:
      - Path=/api/user/**
      - Method=GET,POST
      - Header=X-Version, v1
      - Query=debug, true
```

**ğŸ’¡ ç†è§£è¦ç‚¹**
> å¤šä¸ªè°“è¯æ˜¯"AND"å…³ç³»ï¼Œå¿…é¡»å…¨éƒ¨æ»¡è¶³æ‰åŒ¹é…

### 4.3 æœåŠ¡å‘ç°é›†æˆ


**ğŸ”¸ ä¸æ³¨å†Œä¸­å¿ƒé›†æˆ**
```yaml
spring:
  cloud:
    gateway:
      discovery:
        locator:
          enabled: true  # å¯ç”¨æœåŠ¡å‘ç°
          lower-case-service-id: true  # æœåŠ¡åå°å†™
      routes:
        - id: user-service
          uri: lb://user-service  # lbè¡¨ç¤ºè´Ÿè½½å‡è¡¡
          predicates:
            - Path=/api/user/**
```

**ğŸ¯ è´Ÿè½½å‡è¡¡ç­–ç•¥**
```
lb://service-name çš„å«ä¹‰ï¼š
â€¢ lb: LoadBalancerçš„ç¼©å†™
â€¢ è‡ªåŠ¨ä»æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡å®ä¾‹
â€¢ æ”¯æŒè½®è¯¢ã€éšæœºç­‰è´Ÿè½½å‡è¡¡ç®—æ³•
â€¢ è‡ªåŠ¨å¤„ç†æœåŠ¡ä¸Šä¸‹çº¿
```

---

## 5. ğŸ”„ è¿‡æ»¤å™¨é“¾è®¾è®¡


### 5.1 è¿‡æ»¤å™¨æ‰§è¡Œæµç¨‹


**ğŸ”¸ æ‰§è¡Œæ—¶æœº**
```
è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåºï¼š

å®¢æˆ·ç«¯è¯·æ±‚
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Preè¿‡æ»¤å™¨    â”‚ â† è¯·æ±‚å‰å¤„ç†
â”‚ (è¯·æ±‚é¢„å¤„ç†)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è·¯ç”±è½¬å‘     â”‚ â† è½¬å‘åˆ°åç«¯æœåŠ¡
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Postè¿‡æ»¤å™¨   â”‚ â† å“åº”åå¤„ç†
â”‚ (å“åº”åå¤„ç†)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
   å®¢æˆ·ç«¯å“åº”
```

### 5.2 å†…ç½®è¿‡æ»¤å™¨è¯¦è§£


**ğŸ“‹ å¸¸ç”¨å†…ç½®è¿‡æ»¤å™¨**

| è¿‡æ»¤å™¨åç§° | **åŠŸèƒ½è¯´æ˜** | **é…ç½®ç¤ºä¾‹** |
|-----------|-------------|-------------|
| `StripPrefix` | `å»é™¤è·¯å¾„å‰ç¼€` | `StripPrefix=2` |
| `AddRequestHeader` | `æ·»åŠ è¯·æ±‚å¤´` | `AddRequestHeader=X-Auth, token` |
| `AddResponseHeader` | `æ·»åŠ å“åº”å¤´` | `AddResponseHeader=X-Gateway, true` |
| `RewritePath` | `é‡å†™è¯·æ±‚è·¯å¾„` | `RewritePath=/api/(?<remaining>.*), /${remaining}` |
| `SetStatus` | `è®¾ç½®å“åº”çŠ¶æ€ç ` | `SetStatus=200` |

**ğŸ”¸ è¿‡æ»¤å™¨é…ç½®ç¤ºä¾‹**
```yaml
routes:
  - id: user-service
    uri: lb://user-service
    predicates:
      - Path=/api/user/**
    filters:
      - StripPrefix=2
      - AddRequestHeader=X-Gateway-Source, api-gateway
      - AddResponseHeader=X-Response-Time, ${responseTime}
      - RewritePath=/api/user/(?<segment>.*), /${segment}
```

### 5.3 è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨


**ğŸ”¸ è®¤è¯è¿‡æ»¤å™¨ç¤ºä¾‹**
```java
@Component
@Slf4j
public class AuthGlobalFilter implements GlobalFilter, Ordered {
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, 
                           GatewayFilterChain chain) {
        ServerHttpRequest request = exchange.getRequest();
        
        // è·å–token
        String token = request.getHeaders().getFirst("Authorization");
        
        if (StringUtils.isEmpty(token)) {
            return unauthorizedResponse(exchange, "ç¼ºå°‘è®¤è¯token");
        }
        
        // éªŒè¯tokenï¼ˆè¿™é‡Œç®€åŒ–å¤„ç†ï¼‰
        if (!validateToken(token)) {
            return unauthorizedResponse(exchange, "tokenæ— æ•ˆ");
        }
        
        // tokenéªŒè¯é€šè¿‡ï¼Œç»§ç»­æ‰§è¡Œ
        return chain.filter(exchange);
    }
    
    @Override
    public int getOrder() {
        return -1;  // ä¼˜å…ˆçº§æœ€é«˜
    }
    
    private Mono<Void> unauthorizedResponse(ServerWebExchange exchange, 
                                          String message) {
        ServerHttpResponse response = exchange.getResponse();
        response.setStatusCode(HttpStatus.UNAUTHORIZED);
        
        String result = "{\"code\":401,\"message\":\"" + message + "\"}";
        DataBuffer buffer = response.bufferFactory()
            .wrap(result.getBytes(StandardCharsets.UTF_8));
        
        return response.writeWith(Mono.just(buffer));
    }
    
    private boolean validateToken(String token) {
        // å®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šè°ƒç”¨è®¤è¯æœåŠ¡éªŒè¯
        return !"invalid-token".equals(token);
    }
}
```

**ğŸ’¡ ä»£ç è§£è¯»**
> - `GlobalFilter`: å…¨å±€è¿‡æ»¤å™¨æ¥å£
> - `Ordered`: æ§åˆ¶è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåº
> - `getOrder()`: è¿”å›å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜
> - `Mono<Void>`: å“åº”å¼ç¼–ç¨‹è¿”å›ç±»å‹

### 5.4 è‡ªå®šä¹‰ç½‘å…³è¿‡æ»¤å™¨å·¥å‚


**ğŸ”¸ æ—¥å¿—è®°å½•è¿‡æ»¤å™¨**
```java
@Component
public class LogGatewayFilterFactory extends 
    AbstractGatewayFilterFactory<LogGatewayFilterFactory.Config> {
    
    public LogGatewayFilterFactory() {
        super(Config.class);
    }
    
    @Override
    public GatewayFilter apply(Config config) {
        return (exchange, chain) -> {
            ServerHttpRequest request = exchange.getRequest();
            
            log.info("è¯·æ±‚è·¯å¾„: {}, è¯·æ±‚æ–¹æ³•: {}", 
                request.getPath(), request.getMethod());
                
            return chain.filter(exchange).then(
                Mono.fromRunnable(() -> {
                    ServerHttpResponse response = exchange.getResponse();
                    log.info("å“åº”çŠ¶æ€ç : {}", response.getStatusCode());
                })
            );
        };
    }
    
    @Data
    public static class Config {
        private boolean enabled = true;
    }
}
```

**âš™ï¸ ä½¿ç”¨é…ç½®**
```yaml
routes:
  - id: user-service
    uri: lb://user-service
    predicates:
      - Path=/api/user/**
    filters:
      - Log=true
```

---

## 6. ğŸš¦ é™æµä¸ç†”æ–­æœºåˆ¶


### 6.1 é™æµæœºåˆ¶å®ç°


**ğŸ”¸ åŸºäºRedisçš„é™æµ**
```xml
<!-- æ·»åŠ é™æµä¾èµ– -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-data-redis-reactive</artifactId>
</dependency>
```

**âš™ï¸ é™æµé…ç½®**
```yaml
spring:
  cloud:
    gateway:
      routes:
        - id: user-service
          uri: lb://user-service
          predicates:
            - Path=/api/user/**
          filters:
            - name: RequestRateLimiter
              args:
                redis-rate-limiter.replenishRate: 10    # æ¯ç§’è¡¥å……10ä¸ªä»¤ç‰Œ
                redis-rate-limiter.burstCapacity: 20    # ä»¤ç‰Œæ¡¶æœ€å¤§å®¹é‡20
                redis-rate-limiter.requestedTokens: 1   # æ¯ä¸ªè¯·æ±‚æ¶ˆè€—1ä¸ªä»¤ç‰Œ
                key-resolver: "#{@userKeyResolver}"     # é™æµkeyè§£æå™¨
```

**ğŸ”¸ é™æµkeyè§£æå™¨**
```java
@Component
public class UserKeyResolver implements KeyResolver {
    
    @Override
    public Mono<String> resolve(ServerWebExchange exchange) {
        // æŒ‰ç”¨æˆ·IDé™æµ
        return exchange.getRequest()
            .getHeaders()
            .getFirst("user-id")
            .map(Mono::just)
            .orElse(Mono.just("anonymous"));
    }
}
```

**ğŸ’¡ ä»¤ç‰Œæ¡¶ç®—æ³•ç†è§£**
> æƒ³è±¡ä¸€ä¸ªæ°´æ¡¶ï¼š
> - å›ºå®šé€Ÿåº¦å¾€æ¡¶é‡ŒåŠ æ°´ï¼ˆreplenishRateï¼‰
> - æ¡¶æœ‰æœ€å¤§å®¹é‡ï¼ˆburstCapacityï¼‰
> - æ¯ä¸ªè¯·æ±‚è¦å–ä¸€æ¯æ°´ï¼ˆrequestedTokensï¼‰
> - æ²¡æ°´äº†å°±é™æµ

### 6.2 ç†”æ–­æœºåˆ¶å®ç°


**ğŸ“¦ é›†æˆHystrix**
```xml
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-netflix-hystrix</artifactId>
</dependency>
```

**âš™ï¸ ç†”æ–­é…ç½®**
```yaml
spring:
  cloud:
    gateway:
      routes:
        - id: user-service
          uri: lb://user-service
          predicates:
            - Path=/api/user/**
          filters:
            - name: Hystrix
              args:
                name: user-service-fallback
                fallbackUri: forward:/fallback/user
```

**ğŸ”¸ ç†”æ–­é™çº§å¤„ç†**
```java
@RestController
@RequestMapping("/fallback")
public class FallbackController {
    
    @RequestMapping("/user")
    public ResponseEntity<String> userFallback() {
        String result = """
            {
                "code": 503,
                "message": "ç”¨æˆ·æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åé‡è¯•",
                "data": null
            }
            """;
        return ResponseEntity.ok(result);
    }
}
```

**ğŸ“Š ç†”æ–­å™¨çŠ¶æ€è½¬æ¢**
```
ç†”æ–­å™¨çŠ¶æ€æœºï¼š

    è¯·æ±‚æˆåŠŸ     å¤±è´¥ç‡ä¸‹é™
CLOSED â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ HALF-OPEN
   â†‘                         â†“
   â”‚                    è¯·æ±‚å¤±è´¥/æˆåŠŸç‡ä½
   â”‚                         â†“
   â””â”€â”€â”€â”€ è¶…æ—¶æ—¶é—´åˆ°è¾¾ â”€â”€â”€â”€ OPEN
              â†‘               â”‚
              â””â”€ å¤±è´¥ç‡è¶…é˜ˆå€¼ â”€â”˜
```

### 6.3 è‡ªå®šä¹‰é™æµç­–ç•¥


**ğŸ”¸ IPé™æµè¿‡æ»¤å™¨**
```java
@Component
@Slf4j
public class IpRateLimitFilter implements GlobalFilter, Ordered {
    
    private final RedisTemplate<String, String> redisTemplate;
    
    // æ¯ä¸ªIPæ¯åˆ†é’Ÿæœ€å¤š100ä¸ªè¯·æ±‚
    private static final int RATE_LIMIT_COUNT = 100;
    private static final int RATE_LIMIT_PERIOD = 60;
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, 
                           GatewayFilterChain chain) {
        
        String clientIp = getClientIp(exchange.getRequest());
        String key = "rate_limit:ip:" + clientIp;
        
        return checkRateLimit(key)
            .flatMap(allowed -> {
                if (!allowed) {
                    return rateLimitResponse(exchange);
                }
                return chain.filter(exchange);
            });
    }
    
    private Mono<Boolean> checkRateLimit(String key) {
        return Mono.fromCallable(() -> {
            String countStr = redisTemplate.opsForValue().get(key);
            int count = countStr != null ? Integer.parseInt(countStr) : 0;
            
            if (count >= RATE_LIMIT_COUNT) {
                return false;
            }
            
            if (count == 0) {
                redisTemplate.opsForValue()
                    .set(key, "1", Duration.ofSeconds(RATE_LIMIT_PERIOD));
            } else {
                redisTemplate.opsForValue().increment(key);
            }
            
            return true;
        });
    }
    
    @Override
    public int getOrder() {
        return -2;  // åœ¨è®¤è¯è¿‡æ»¤å™¨ä¹‹å‰æ‰§è¡Œ
    }
}
```

---

## 7. ğŸ“Š ç½‘å…³ç›‘æ§å‘Šè­¦


### 7.1 ç›‘æ§æŒ‡æ ‡æ”¶é›†


**ğŸ”¸ é›†æˆActuator**
```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-actuator</artifactId>
</dependency>
```

**âš™ï¸ ç›‘æ§é…ç½®**
```yaml
management:
  endpoints:
    web:
      exposure:
        include: "*"  # æš´éœ²æ‰€æœ‰ç›‘æ§ç«¯ç‚¹
  endpoint:
    health:
      show-details: always
    gateway:
      enabled: true  # å¯ç”¨ç½‘å…³ç›‘æ§ç«¯ç‚¹
      
spring:
  cloud:
    gateway:
      metrics:
        enabled: true  # å¯ç”¨æŒ‡æ ‡æ”¶é›†
```

**ğŸ“ˆ å…³é”®ç›‘æ§æŒ‡æ ‡**
```
ç½‘å…³æ ¸å¿ƒæŒ‡æ ‡ï¼š

æ€§èƒ½æŒ‡æ ‡ï¼š
â€¢ gateway_requests_total: æ€»è¯·æ±‚æ•°
â€¢ gateway_request_duration_seconds: è¯·æ±‚è€—æ—¶
â€¢ gateway_requests_per_second: QPS

çŠ¶æ€æŒ‡æ ‡ï¼š  
â€¢ gateway_route_count: è·¯ç”±æ•°é‡
â€¢ gateway_filter_chain_duration: è¿‡æ»¤å™¨é“¾è€—æ—¶

é”™è¯¯æŒ‡æ ‡ï¼š
â€¢ gateway_requests_errors_total: é”™è¯¯è¯·æ±‚æ•°
â€¢ gateway_circuit_breaker_state: ç†”æ–­å™¨çŠ¶æ€
```

### 7.2 è‡ªå®šä¹‰ç›‘æ§æŒ‡æ ‡


**ğŸ”¸ ä¸šåŠ¡ç›‘æ§è¿‡æ»¤å™¨**
```java
@Component
public class MetricsGlobalFilter implements GlobalFilter, Ordered {
    
    private final MeterRegistry meterRegistry;
    private final Counter requestCounter;
    private final Timer requestTimer;
    
    public MetricsGlobalFilter(MeterRegistry meterRegistry) {
        this.meterRegistry = meterRegistry;
        this.requestCounter = Counter.builder("gateway_business_requests")
            .description("ç½‘å…³ä¸šåŠ¡è¯·æ±‚è®¡æ•°")
            .register(meterRegistry);
        this.requestTimer = Timer.builder("gateway_business_request_duration")
            .description("ç½‘å…³ä¸šåŠ¡è¯·æ±‚è€—æ—¶")
            .register(meterRegistry);
    }
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, 
                           GatewayFilterChain chain) {
        
        Timer.Sample sample = Timer.start(meterRegistry);
        
        return chain.filter(exchange)
            .doOnSuccess(aVoid -> {
                requestCounter.increment();
                sample.stop(requestTimer);
            })
            .doOnError(error -> {
                Counter.builder("gateway_business_errors")
                    .tag("error", error.getClass().getSimpleName())
                    .register(meterRegistry)
                    .increment();
            });
    }
    
    @Override
    public int getOrder() {
        return Ordered.HIGHEST_PRECEDENCE + 1;
    }
}
```

### 7.3 æ—¥å¿—ç›‘æ§


**ğŸ”¸ ç»“æ„åŒ–æ—¥å¿—é…ç½®**
```yaml
logging:
  level:
    org.springframework.cloud.gateway: INFO
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level [%X{traceId}] %logger{36} - %msg%n"
    
spring:
  cloud:
    gateway:
      httpclient:
        wiretap: true  # å¯ç”¨è¯·æ±‚/å“åº”æ—¥å¿—
      httpserver:  
        wiretap: true
```

**ğŸ”¸ è¯·æ±‚è¿½è¸ªè¿‡æ»¤å™¨**
```java
@Component
@Slf4j
public class TraceFilter implements GlobalFilter, Ordered {
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, 
                           GatewayFilterChain chain) {
        
        ServerHttpRequest request = exchange.getRequest();
        String traceId = generateTraceId();
        
        // æ·»åŠ è¿½è¸ªIDåˆ°è¯·æ±‚å¤´
        ServerHttpRequest.Builder requestBuilder = request.mutate();
        requestBuilder.header("X-Trace-Id", traceId);
        
        // è®°å½•è¯·æ±‚æ—¥å¿—
        log.info("ç½‘å…³è¯·æ±‚ - TraceId: {}, Path: {}, Method: {}, IP: {}",
            traceId, 
            request.getPath(),
            request.getMethod(),
            getClientIp(request));
        
        return chain.filter(exchange.mutate()
            .request(requestBuilder.build())
            .build())
            .doFinally(signal -> {
                // è®°å½•å“åº”æ—¥å¿—
                ServerHttpResponse response = exchange.getResponse();
                log.info("ç½‘å…³å“åº” - TraceId: {}, Status: {}", 
                    traceId, response.getStatusCode());
            });
    }
    
    private String generateTraceId() {
        return System.currentTimeMillis() + "-" + 
               UUID.randomUUID().toString().substring(0, 8);
    }
    
    @Override
    public int getOrder() {
        return Ordered.HIGHEST_PRECEDENCE;
    }
}
```

### 7.4 å‘Šè­¦é…ç½®


**ğŸ”¸ å‘Šè­¦è§„åˆ™ç¤ºä¾‹**
```yaml
# Prometheuså‘Šè­¦è§„åˆ™
groups:
  - name: api-gateway
    rules:
      - alert: GatewayHighErrorRate
        expr: |
          rate(gateway_requests_errors_total[5m]) / 
          rate(gateway_requests_total[5m]) > 0.05
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "ç½‘å…³é”™è¯¯ç‡è¿‡é«˜"
          description: "ç½‘å…³é”™è¯¯ç‡è¶…è¿‡5%ï¼ŒæŒç»­2åˆ†é’Ÿ"
          
      - alert: GatewayHighLatency  
        expr: |
          histogram_quantile(0.95, 
            rate(gateway_request_duration_seconds_bucket[5m])) > 1
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "ç½‘å…³å“åº”å»¶è¿Ÿè¿‡é«˜"
          description: "ç½‘å…³95%è¯·æ±‚å»¶è¿Ÿè¶…è¿‡1ç§’"
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ APIç½‘å…³æœ¬è´¨ï¼šå¾®æœåŠ¡æ¶æ„çš„ç»Ÿä¸€å…¥å£å’Œæ§åˆ¶ä¸­å¿ƒ
ğŸ”¸ æ ¸å¿ƒåŠŸèƒ½ï¼šè·¯ç”±è½¬å‘ã€è®¤è¯é‰´æƒã€é™æµç†”æ–­ã€ç›‘æ§æ—¥å¿—  
ğŸ”¸ Gatewayç»„ä»¶ï¼šRoute + Predicate + Filterçš„ç»„åˆæ¨¡å¼
ğŸ”¸ è¿‡æ»¤å™¨é“¾ï¼šPreå¤„ç† â†’ è·¯ç”±è½¬å‘ â†’ Postå¤„ç†çš„æ‰§è¡Œæµç¨‹
ğŸ”¸ ä¿æŠ¤æœºåˆ¶ï¼šé™æµé˜²æ­¢è¿‡è½½ï¼Œç†”æ–­é˜²æ­¢çº§è”æ•…éšœ
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ç½‘å…³çš„ä»·å€¼**
```
ç»Ÿä¸€ç®¡ç†ï¼š
â€¢ æ‰€æœ‰å¤–éƒ¨è¯·æ±‚çš„å”¯ä¸€å…¥å£
â€¢ ç»Ÿä¸€å¤„ç†æ¨ªåˆ‡å…³æ³¨ç‚¹
â€¢ ç®€åŒ–å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯äº¤äº’

æœåŠ¡ä¿æŠ¤ï¼š  
â€¢ è®¤è¯é‰´æƒä¿æŠ¤åç«¯å®‰å…¨
â€¢ é™æµç†”æ–­é˜²æ­¢æœåŠ¡è¿‡è½½
â€¢ ç›‘æ§å‘Šè­¦åŠæ—¶å‘ç°é—®é¢˜
```

**ğŸ”¹ æŠ€æœ¯é€‰å‹è€ƒè™‘**
```
Spring Cloud Gateway vs Zuulï¼š
â€¢ GatewayåŸºäºWebFluxï¼Œæ€§èƒ½æ›´å¥½
â€¢ Gatewayä¸Springç”Ÿæ€é›†æˆæ›´ç´§å¯†
â€¢ Gatewayæ”¯æŒå“åº”å¼ç¼–ç¨‹æ¨¡å‹

è‡ªå»º vs äº‘æœåŠ¡ï¼š
â€¢ è‡ªå»ºGatewayï¼šçµæ´»å¯æ§ï¼Œè¿ç»´æˆæœ¬é«˜
â€¢ äº‘æœåŠ¡ï¼ˆå¦‚APIç½‘å…³ï¼‰ï¼šå¼€ç®±å³ç”¨ï¼ŒåŠŸèƒ½ç›¸å¯¹å›ºå®š
```

**ğŸ”¹ æ¶æ„è®¾è®¡åŸåˆ™**
```
é«˜å¯ç”¨è®¾è®¡ï¼š
â€¢ ç½‘å…³é›†ç¾¤éƒ¨ç½²ï¼Œé¿å…å•ç‚¹æ•…éšœ
â€¢ åˆç†è®¾ç½®é™æµé˜ˆå€¼å’Œç†”æ–­å‚æ•°
â€¢ åšå¥½é™çº§é¢„æ¡ˆå’Œé”™è¯¯å¤„ç†

æ€§èƒ½ä¼˜åŒ–ï¼š
â€¢ é€‰æ‹©åˆé€‚çš„è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåº
â€¢ é¿å…åœ¨ç½‘å…³å±‚åšå¤æ‚ä¸šåŠ¡é€»è¾‘
â€¢ åˆç†é…ç½®è¿æ¥æ± å’Œè¶…æ—¶æ—¶é—´
```

### 8.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ ä¸šåŠ¡åœºæ™¯åº”ç”¨**
- **å¾®æœåŠ¡æ²»ç†**ï¼šç»Ÿä¸€è·¯ç”±ã€è®¤è¯ã€ç›‘æ§
- **APIç®¡ç†**ï¼šç‰ˆæœ¬æ§åˆ¶ã€è®¿é—®æ§åˆ¶ã€è®¡è´¹ç»Ÿè®¡
- **ç³»ç»Ÿä¿æŠ¤**ï¼šé™æµç†”æ–­ã€é˜²åˆ·é˜²æ”»å‡»
- **è¿ç»´ç›‘æ§**ï¼šè¯·æ±‚è¿½è¸ªã€æ€§èƒ½ç›‘æ§ã€å‘Šè­¦é€šçŸ¥

**ğŸ”§ å·¥ç¨‹å®è·µè¦ç‚¹**
```
é…ç½®ç®¡ç†ï¼š
â€¢ ä½¿ç”¨é…ç½®ä¸­å¿ƒç®¡ç†è·¯ç”±è§„åˆ™
â€¢ æ”¯æŒåŠ¨æ€æ›´æ–°ï¼Œæ— éœ€é‡å¯
â€¢ åŒºåˆ†ç¯å¢ƒï¼Œéš”ç¦»é…ç½®

å®‰å…¨è€ƒè™‘ï¼š
â€¢ tokenéªŒè¯å’Œç”¨æˆ·æƒé™æ§åˆ¶
â€¢ æ•æ„Ÿä¿¡æ¯è„±æ•å’ŒåŠ å¯†ä¼ è¾“  
â€¢ é˜²æ­¢æ¶æ„æ”»å‡»å’Œå¼‚å¸¸è®¿é—®

æ€§èƒ½ç›‘æ§ï¼š
â€¢ å»ºç«‹å®Œå–„çš„ç›‘æ§æŒ‡æ ‡ä½“ç³»
â€¢ è®¾ç½®åˆç†çš„å‘Šè­¦é˜ˆå€¼
â€¢ å®šæœŸåˆ†ææ€§èƒ½ç“¶é¢ˆå’Œä¼˜åŒ–ç©ºé—´
```

### 8.4 å­¦ä¹ å»ºè®®


**ğŸ“š å­¦ä¹ è·¯å¾„**
```
ç¬¬1é˜¶æ®µï¼šåŸºç¡€ç†è§£
â€¢ ç†è§£ç½‘å…³çš„ä½œç”¨å’Œä»·å€¼
â€¢ æŒæ¡Spring Cloud GatewayåŸºæœ¬é…ç½®
â€¢ å®ç°ç®€å•çš„è·¯ç”±è½¬å‘

ç¬¬2é˜¶æ®µï¼šåŠŸèƒ½å®Œå–„
â€¢ å¼€å‘è®¤è¯é‰´æƒè¿‡æ»¤å™¨
â€¢ å®ç°é™æµå’Œç†”æ–­æœºåˆ¶
â€¢ æ·»åŠ ç›‘æ§å’Œæ—¥å¿—åŠŸèƒ½

ç¬¬3é˜¶æ®µï¼šç”Ÿäº§åº”ç”¨
â€¢ é›†ç¾¤éƒ¨ç½²å’Œè´Ÿè½½å‡è¡¡
â€¢ æ€§èƒ½è°ƒä¼˜å’Œæ•…éšœæ’æŸ¥
â€¢ ä¸å…¶ä»–ç»„ä»¶é›†æˆä¼˜åŒ–
```

**ğŸ” å¸¸è§é—®é¢˜è§£å†³**
- **è·¯ç”±ä¸ç”Ÿæ•ˆ**ï¼šæ£€æŸ¥è°“è¯é…ç½®å’ŒæœåŠ¡æ³¨å†ŒçŠ¶æ€
- **è¿‡æ»¤å™¨å†²çª**ï¼šæ³¨æ„æ‰§è¡Œé¡ºåºå’Œä¼˜å…ˆçº§è®¾ç½®
- **æ€§èƒ½ç“¶é¢ˆ**ï¼šåˆ†æç›‘æ§æŒ‡æ ‡ï¼Œä¼˜åŒ–è¿‡æ»¤å™¨é€»è¾‘
- **ç†”æ–­è¯¯è§¦å‘**ï¼šè°ƒæ•´ç†”æ–­å‚æ•°å’Œå¥åº·æ£€æŸ¥æœºåˆ¶

**æ ¸å¿ƒè®°å¿†**ï¼š
- ç½‘å…³æ˜¯å¾®æœåŠ¡çš„å¤§é—¨ï¼Œç»Ÿä¸€ç®¡ç†è¿›å‡º
- è·¯ç”±è§„åˆ™å†³å®šè¯·æ±‚å»å‘ï¼Œè¿‡æ»¤å™¨å¤„ç†æ¨ªåˆ‡é€»è¾‘
- é™æµç†”æ–­ä¿æŠ¤åç«¯ï¼Œç›‘æ§å‘Šè­¦åŠæ—¶å‘ç°é—®é¢˜
- é…ç½®ç®€å•åŠŸèƒ½å¼ºå¤§ï¼ŒSpringç”Ÿæ€æ— ç¼é›†æˆ