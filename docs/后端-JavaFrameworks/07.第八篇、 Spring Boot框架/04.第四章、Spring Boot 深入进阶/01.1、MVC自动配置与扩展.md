---
title: 1ã€MVCè‡ªåŠ¨é…ç½®ä¸æ‰©å±•
---
## ğŸ“š ç›®å½•

1. [Spring Boot Web starterä¾èµ–è¯¦è§£](#1-spring-boot-web-starterä¾èµ–è¯¦è§£)
2. [DispatcherServletæ ¸å¿ƒé…ç½®](#2-dispatcherservletæ ¸å¿ƒé…ç½®)
3. [æ¶ˆæ¯è½¬æ¢å™¨HttpMessageConverter](#3-æ¶ˆæ¯è½¬æ¢å™¨httpmessageconverter)
4. [CORSè·¨åŸŸé…ç½®è§£å†³æ–¹æ¡ˆ](#4-corsè·¨åŸŸé…ç½®è§£å†³æ–¹æ¡ˆ)
5. [é™æ€èµ„æºå¤„ç†æœºåˆ¶](#5-é™æ€èµ„æºå¤„ç†æœºåˆ¶)
6. [é”™è¯¯é¡µé¢å®šåˆ¶](#6-é”™è¯¯é¡µé¢å®šåˆ¶)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸš€ Spring Boot Web starterä¾èµ–è¯¦è§£


### 1.1 ä»€ä¹ˆæ˜¯spring-boot-starter-web


**ğŸ”¸ ç®€å•ç†è§£**ï¼šå°±åƒä¹°å¥—é¤ä¸€æ ·ï¼Œä¸€ä¸ªä¾èµ–åŒ…å«äº†å¼€å‘Webåº”ç”¨éœ€è¦çš„æ‰€æœ‰ä¸œè¥¿

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
</dependency>
```

**ğŸ’¡ è¿™ä¸ªstarteråˆ°åº•åŒ…å«ä»€ä¹ˆï¼Ÿ**
```
spring-boot-starter-web åŒ…å«çš„æ ¸å¿ƒç»„ä»¶ï¼š

ğŸ“¦ Spring MVCæ¡†æ¶
   â”œâ”€â”€ DispatcherServlet (å‰ç«¯æ§åˆ¶å™¨)
   â”œâ”€â”€ HandlerMapping (è·¯å¾„æ˜ å°„)
   â”œâ”€â”€ ViewResolver (è§†å›¾è§£æå™¨)
   â””â”€â”€ HttpMessageConverter (æ¶ˆæ¯è½¬æ¢å™¨)

ğŸ“¦ åµŒå…¥å¼WebæœåŠ¡å™¨ 
   â””â”€â”€ Tomcat (é»˜è®¤ï¼Œä¹Ÿå¯é€‰Jetty/Undertow)

ğŸ“¦ JSONå¤„ç†
   â””â”€â”€ Jackson (JSONåºåˆ—åŒ–/ååºåˆ—åŒ–)

ğŸ“¦ éªŒè¯æ¡†æ¶
   â””â”€â”€ Hibernate Validator
```

### 1.2 ä¸ºä»€ä¹ˆè¦ç”¨starter


**ä¼ ç»ŸSpring MVCé…ç½® vs Spring Bootï¼š**

**ğŸ˜° ä¼ ç»Ÿæ–¹å¼**ï¼šéœ€è¦æ‰‹åŠ¨é…ç½®Nå¤šä¸œè¥¿
- web.xmlæ–‡ä»¶é…ç½®
- å„ç§XMLé…ç½®æ–‡ä»¶
- ä¾èµ–ç‰ˆæœ¬å†²çªé—®é¢˜
- æœåŠ¡å™¨éƒ¨ç½²é…ç½®

**ğŸ˜Š Spring Bootæ–¹å¼**ï¼šä¸€ä¸ªä¾èµ–æå®š
- é›¶XMLé…ç½®
- è‡ªåŠ¨ç‰ˆæœ¬ç®¡ç†
- å†…åµŒæœåŠ¡å™¨
- å¼€ç®±å³ç”¨

> ğŸ’¡ **æ ¸å¿ƒç†è§£**ï¼šstarterå°±æ˜¯Spring Bootçš„"æ‡’äººåŒ…"ï¼ŒæŠŠå¤æ‚çš„é…ç½®æ‰“åŒ…å¥½ï¼Œè®©ä½ ä¸“æ³¨å†™ä¸šåŠ¡ä»£ç 

### 1.3 starterçš„è‡ªåŠ¨é…ç½®åŸç†


**ğŸ”§ è‡ªåŠ¨é…ç½®çš„é­”æ³•**ï¼š
```
å¯åŠ¨æµç¨‹ï¼š
1. Spring Bootæ‰«æclasspathä¸‹çš„jaråŒ…
2. å‘ç°spring-boot-starter-web
3. è¯»å–META-INF/spring.factoriesæ–‡ä»¶
4. è‡ªåŠ¨åŠ è½½WebMvcAutoConfigurationç­‰é…ç½®ç±»
5. æ ¹æ®æ¡ä»¶æ³¨è§£å†³å®šæ˜¯å¦å¯ç”¨æŸä¸ªé…ç½®
```

**æ¡ä»¶æ³¨è§£ç¤ºä¾‹**ï¼š
```java
@ConditionalOnClass({Servlet.class, DispatcherServlet.class})
@ConditionalOnWebApplication(type = Type.SERVLET)
public class WebMvcAutoConfiguration {
    // åªæœ‰åœ¨ç±»è·¯å¾„ä¸‹æœ‰Servletæ—¶æ‰å¯ç”¨
}
```

---

## 2. ğŸ¯ DispatcherServletæ ¸å¿ƒé…ç½®


### 2.1 ä»€ä¹ˆæ˜¯DispatcherServlet


**ğŸ”¸ ç”Ÿæ´»ç±»æ¯”**ï¼šDispatcherServletå°±åƒé¤å…çš„æœåŠ¡å‘˜æ€»ç®¡

```
å®¢æˆ·è¯·æ±‚ â†’ æ€»ç®¡æ¥å¾… â†’ åˆ†é…ç»™å…·ä½“æœåŠ¡å‘˜ â†’ å¤„ç†å®Œæˆ â†’ æ€»ç®¡ç»Ÿä¸€å›å¤

HTTPè¯·æ±‚ â†’ DispatcherServlet â†’ Controller â†’ ä¸šåŠ¡å¤„ç† â†’ è¿”å›å“åº”
```

**æ ¸å¿ƒä½œç”¨**ï¼š
- ğŸ“¥ **æ¥æ”¶è¯·æ±‚**ï¼šæ‰€æœ‰HTTPè¯·æ±‚çš„ç»Ÿä¸€å…¥å£
- ğŸ¯ **è·¯ç”±åˆ†å‘**ï¼šæ ¹æ®URLæ‰¾åˆ°å¯¹åº”çš„Controller
- ğŸ“¤ **å“åº”å¤„ç†**ï¼šç»Ÿä¸€å¤„ç†è¿”å›ç»“æœ

### 2.2 DispatcherServletçš„å·¥ä½œæµç¨‹


```
è¯·æ±‚å¤„ç†æµç¨‹å›¾ï¼š

å®¢æˆ·ç«¯è¯·æ±‚                     DispatcherServlet                Controller
     |                              |                            |
     |-----[1] HTTPè¯·æ±‚------------>|                            |
     |                              |                            |
     |                              |----[2] æŸ¥æ‰¾Handler-------->|
     |                              |                            |
     |                              |<---[3] è¿”å›Handler---------|
     |                              |                            |
     |                              |----[4] æ‰§è¡ŒController---->|
     |                              |                            |
     |                              |<---[5] è¿”å›ModelAndView----|
     |                              |                            |
     |<----[6] HTTPå“åº”-------------|                            |
```

### 2.3 DispatcherServleté…ç½®è¯¦è§£


**ğŸ“‹ å¸¸ç”¨é…ç½®å±æ€§**ï¼š

| é…ç½®é¡¹ | **é»˜è®¤å€¼** | **ä½œç”¨** | **ä½¿ç”¨åœºæ™¯** |
|--------|-----------|----------|-------------|
| `server.servlet.path` | `/` | è®¾ç½®DispatcherServletæ˜ å°„è·¯å¾„ | APIç‰ˆæœ¬æ§åˆ¶ |
| `spring.mvc.servlet.load-on-startup` | `-1` | è®¾ç½®å¯åŠ¨ä¼˜å…ˆçº§ | æå‡é¦–æ¬¡è®¿é—®é€Ÿåº¦ |
| `spring.mvc.dispatch-options-request` | `true` | å¤„ç†OPTIONSè¯·æ±‚ | CORSè·¨åŸŸåœºæ™¯ |

**å®é™…é…ç½®ç¤ºä¾‹**ï¼š
```properties
# application.properties
server.servlet.path=/api/v1
spring.mvc.servlet.load-on-startup=1
spring.mvc.dispatch-options-request=true
```

**ğŸ¯ é…ç½®æ•ˆæœ**ï¼š
- æ‰€æœ‰Controllerçš„è·¯å¾„å‰éƒ½ä¼šåŠ ä¸Š`/api/v1`
- æœåŠ¡å¯åŠ¨æ—¶å°±åˆå§‹åŒ–DispatcherServletï¼ˆæå‡æ€§èƒ½ï¼‰
- æ”¯æŒCORSçš„é¢„æ£€è¯·æ±‚

### 2.4 å¤šDispatcherServleté…ç½®


**ä½¿ç”¨åœºæ™¯**ï¼šåŒºåˆ†APIå’Œé¡µé¢è¯·æ±‚
```java
@Configuration
public class MultiDispatcherConfig {
    
    // APIä¸“ç”¨çš„DispatcherServlet
    @Bean
    public DispatcherServlet apiDispatcher() {
        return new DispatcherServlet();
    }
    
    @Bean
    public ServletRegistrationBean<DispatcherServlet> apiServletRegistration() {
        ServletRegistrationBean<DispatcherServlet> registration = 
            new ServletRegistrationBean<>(apiDispatcher(), "/api/*");
        registration.setName("api");
        return registration;
    }
}
```

---

## 3. ğŸ”„ æ¶ˆæ¯è½¬æ¢å™¨HttpMessageConverter


### 3.1 ä»€ä¹ˆæ˜¯HttpMessageConverter


**ğŸ”¸ ç”Ÿæ´»ç±»æ¯”**ï¼šå°±åƒç¿»è¯‘å®˜ï¼Œè´Ÿè´£ä¸åŒ"è¯­è¨€"ä¹‹é—´çš„è½¬æ¢

```
å‰ç«¯å‘é€JSON â†’ HttpMessageConverter â†’ Javaå¯¹è±¡
Javaå¯¹è±¡ â†’ HttpMessageConverter â†’ è¿”å›JSONç»™å‰ç«¯
```

**æ ¸å¿ƒèŒè´£**ï¼š
- ğŸ“¥ **è¯·æ±‚è½¬æ¢**ï¼šHTTPè¯·æ±‚ä½“ â†’ Javaå¯¹è±¡ (ååºåˆ—åŒ–)
- ğŸ“¤ **å“åº”è½¬æ¢**ï¼šJavaå¯¹è±¡ â†’ HTTPå“åº”ä½“ (åºåˆ—åŒ–)

### 3.2 å¸¸ç”¨çš„æ¶ˆæ¯è½¬æ¢å™¨


**ğŸ“Š Spring Booté»˜è®¤æä¾›çš„è½¬æ¢å™¨**ï¼š

| è½¬æ¢å™¨ | **å¤„ç†æ ¼å¼** | **ä¼˜å…ˆçº§** | **ä½¿ç”¨åœºæ™¯** |
|--------|-------------|-----------|-------------|
| `MappingJackson2HttpMessageConverter` | JSON | â­â­â­â­â­ | RESTful APIå¼€å‘ |
| `StringHttpMessageConverter` | çº¯æ–‡æœ¬ | â­â­â­ | ç®€å•æ–‡æœ¬å“åº” |
| `ByteArrayHttpMessageConverter` | å­—èŠ‚æ•°ç»„ | â­â­ | æ–‡ä»¶ä¸Šä¼ ä¸‹è½½ |
| `MappingJackson2XmlHttpMessageConverter` | XML | â­â­ | XMLæ•°æ®äº¤æ¢ |

### 3.3 JSONè½¬æ¢å™¨è¯¦è§£


**ğŸ”§ é»˜è®¤é…ç½®å·²ç»å¾ˆå®Œå–„**ï¼š
```java
@RestController
public class UserController {
    
    @PostMapping("/users")
    public User createUser(@RequestBody User user) {
        // @RequestBody: JSON â†’ Userå¯¹è±¡ (è‡ªåŠ¨è½¬æ¢)
        return userService.save(user);
        // è¿”å›: Userå¯¹è±¡ â†’ JSON (è‡ªåŠ¨è½¬æ¢)
    }
}
```

**ğŸ¨ è‡ªå®šä¹‰JSONè½¬æ¢è¡Œä¸º**ï¼š
```java
@Configuration
public class JsonConfig {
    
    @Bean
    @Primary
    public ObjectMapper objectMapper() {
        ObjectMapper mapper = new ObjectMapper();
        // æ—¥æœŸæ ¼å¼åŒ–
        mapper.setDateFormat(new SimpleDateFormat("yyyy-MM-dd HH:mm:ss"));
        // å¿½ç•¥æœªçŸ¥å­—æ®µ
        mapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);
        // ç©ºå€¼å¤„ç†
        mapper.setSerializationInclusion(JsonInclude.Include.NON_NULL);
        return mapper;
    }
}
```

### 3.4 è‡ªå®šä¹‰æ¶ˆæ¯è½¬æ¢å™¨


**ä½¿ç”¨åœºæ™¯**ï¼šå¤„ç†ç‰¹æ®Šæ ¼å¼æ•°æ®
```java
@Component
public class CustomMessageConverter extends AbstractHttpMessageConverter<MyCustomObject> {
    
    public CustomMessageConverter() {
        super(new MediaType("application", "custom"));
    }
    
    @Override
    protected boolean supports(Class<?> clazz) {
        return MyCustomObject.class.isAssignableFrom(clazz);
    }
    
    @Override
    protected MyCustomObject readInternal(Class<? extends MyCustomObject> clazz, 
                                         HttpInputMessage inputMessage) {
        // è‡ªå®šä¹‰ååºåˆ—åŒ–é€»è¾‘
    }
    
    @Override
    protected void writeInternal(MyCustomObject obj, 
                                HttpOutputMessage outputMessage) {
        // è‡ªå®šä¹‰åºåˆ—åŒ–é€»è¾‘
    }
}
```

**æ³¨å†Œè‡ªå®šä¹‰è½¬æ¢å™¨**ï¼š
```java
@Configuration
public class WebConfig implements WebMvcConfigurer {
    
    @Override
    public void configureMessageConverters(List<HttpMessageConverter<?>> converters) {
        converters.add(new CustomMessageConverter());
    }
}
```

---

## 4. ğŸŒ CORSè·¨åŸŸé…ç½®è§£å†³æ–¹æ¡ˆ


### 4.1 ä»€ä¹ˆæ˜¯CORSè·¨åŸŸé—®é¢˜


**ğŸ”¸ ç”Ÿæ´»ç±»æ¯”**ï¼šå°±åƒä¸åŒå°åŒºçš„é—¨ç¦ç³»ç»Ÿï¼ŒAå°åŒºçš„äººä¸èƒ½éšä¾¿è¿›Bå°åŒº

```
æµè§ˆå™¨å®‰å…¨ç­–ç•¥ï¼š
http://localhost:3000 (å‰ç«¯) â†’ http://localhost:8080 (åç«¯) âŒ è¢«é˜»æ­¢
                                                                  
åŸå› ï¼šåè®®ã€åŸŸåã€ç«¯å£ä»»æ„ä¸€ä¸ªä¸åŒå°±ç®—è·¨åŸŸ
```

**å¸¸è§è·¨åŸŸåœºæ™¯**ï¼š
- ğŸŒ **å¼€å‘ç¯å¢ƒ**ï¼šå‰ç«¯3000ç«¯å£ï¼Œåç«¯8080ç«¯å£
- ğŸŒ **ç”Ÿäº§ç¯å¢ƒ**ï¼šå‰ç«¯åŸŸåå’Œåç«¯APIåŸŸåä¸åŒ
- ğŸŒ **CDNéƒ¨ç½²**ï¼šé™æ€èµ„æºå’ŒAPIåˆ†ç¦»éƒ¨ç½²

### 4.2 CORSè§£å†³æ–¹æ¡ˆå¯¹æ¯”


| æ–¹æ¡ˆ | **å¤æ‚åº¦** | **çµæ´»æ€§** | **æ¨èåº¦** | **é€‚ç”¨åœºæ™¯** |
|------|-----------|-----------|-----------|-------------|
| `@CrossOriginæ³¨è§£` | â­ | â­â­ | â­â­â­ | å•ä¸ªController |
| `å…¨å±€CORSé…ç½®` | â­â­ | â­â­â­â­ | â­â­â­â­â­ | æ•´ä¸ªåº”ç”¨ |
| `Nginxä»£ç†` | â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | ç”Ÿäº§ç¯å¢ƒ |

### 4.3 @CrossOriginæ³¨è§£æ–¹å¼


**ğŸ¯ Controllerçº§åˆ«é…ç½®**ï¼š
```java
@RestController
@CrossOrigin(origins = "http://localhost:3000")
public class UserController {
    
    @GetMapping("/users")
    public List<User> getUsers() {
        return userService.findAll();
    }
}
```

**ğŸ¯ æ–¹æ³•çº§åˆ«é…ç½®**ï¼š
```java
@RestController
public class UserController {
    
    @CrossOrigin(
        origins = {"http://localhost:3000", "https://myapp.com"},
        methods = {RequestMethod.GET, RequestMethod.POST},
        maxAge = 3600
    )
    @PostMapping("/users")
    public User createUser(@RequestBody User user) {
        return userService.save(user);
    }
}
```

### 4.4 å…¨å±€CORSé…ç½®ï¼ˆæ¨èï¼‰


**ğŸ† æœ€ä½³å®è·µé…ç½®**ï¼š
```java
@Configuration
public class CorsConfig implements WebMvcConfigurer {
    
    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/api/**")  // åªå¯¹APIè·¯å¾„å¼€æ”¾
                .allowedOrigins("http://localhost:3000", "https://myapp.com")
                .allowedMethods("GET", "POST", "PUT", "DELETE", "OPTIONS")
                .allowedHeaders("*")
                .allowCredentials(true)  // å…è®¸æºå¸¦è®¤è¯ä¿¡æ¯
                .maxAge(3600);  // é¢„æ£€è¯·æ±‚ç¼“å­˜æ—¶é—´
    }
}
```

**ğŸ”§ é…ç½®æ–‡ä»¶æ–¹å¼**ï¼š
```properties
# application.properties
spring.web.cors.allowed-origins=http://localhost:3000,https://myapp.com
spring.web.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
spring.web.cors.allowed-headers=*
spring.web.cors.allow-credentials=true
spring.web.cors.max-age=3600
```

### 4.5 CORSé…ç½®æ³¨æ„äº‹é¡¹


**âš ï¸ å®‰å…¨æ³¨æ„äº‹é¡¹**ï¼š
```java
// âŒ å±é™©ï¼šå…è®¸æ‰€æœ‰åŸŸå
.allowedOrigins("*")

// âœ… å®‰å…¨ï¼šæ˜ç¡®æŒ‡å®šåŸŸå
.allowedOrigins("https://myapp.com", "https://admin.myapp.com")

// âŒ å±é™©ï¼šç”Ÿäº§ç¯å¢ƒä½¿ç”¨é€šé…ç¬¦
.allowedOrigins("*").allowCredentials(true)  // è¿™æ ·é…ç½®ä¼šæŠ¥é”™

// âœ… å®‰å…¨ï¼šç”Ÿäº§ç¯å¢ƒç²¾ç¡®é…ç½®
.allowedOriginPatterns("https://*.mycompany.com")
.allowCredentials(true)
```

**ğŸ“‹ é¢„æ£€è¯·æ±‚å¤„ç†**ï¼š
```
æµè§ˆå™¨å‘é€å¤æ‚è¯·æ±‚æ—¶çš„æµç¨‹ï¼š

1. OPTIONSé¢„æ£€è¯·æ±‚ â†’ æœåŠ¡å™¨æ£€æŸ¥æ˜¯å¦å…è®¸
2. æœåŠ¡å™¨è¿”å›å…è®¸çš„æ–¹æ³•ã€å¤´ä¿¡æ¯ç­‰
3. æµè§ˆå™¨å‘é€å®é™…è¯·æ±‚
4. æœåŠ¡å™¨å¤„ç†å¹¶è¿”å›ç»“æœ
```

---

## 5. ğŸ“ é™æ€èµ„æºå¤„ç†æœºåˆ¶


### 5.1 ä»€ä¹ˆæ˜¯é™æ€èµ„æº


**ğŸ”¸ é™æ€èµ„æº**ï¼šä¸éœ€è¦æœåŠ¡å™¨å¤„ç†ï¼Œç›´æ¥è¿”å›ç»™æµè§ˆå™¨çš„æ–‡ä»¶
- ğŸ“· **å›¾ç‰‡**ï¼šjpg, png, gif, svg
- ğŸ¨ **æ ·å¼**ï¼šcssæ–‡ä»¶  
- âš¡ **è„šæœ¬**ï¼šjsæ–‡ä»¶
- ğŸ“„ **æ–‡æ¡£**ï¼špdf, txtç­‰

### 5.2 Spring Booté»˜è®¤é™æ€èµ„æºè·¯å¾„


**ğŸ“‚ é»˜è®¤èµ„æºç›®å½•æ˜ å°„**ï¼š
```
URLè®¿é—®è·¯å¾„              â†’    å®é™…æ–‡ä»¶ä½ç½®
/static/**              â†’    classpath:/static/
/public/**              â†’    classpath:/public/
/resources/**           â†’    classpath:/resources/
/META-INF/resources/**  â†’    classpath:/META-INF/resources/
```

**ğŸŒ° å®é™…ä¾‹å­**ï¼š
```
é¡¹ç›®ç»“æ„ï¼š
src/main/resources/
â”œâ”€â”€ static/
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â””â”€â”€ app.js
â”‚   â””â”€â”€ images/
â”‚       â””â”€â”€ logo.png
â””â”€â”€ public/
    â””â”€â”€ favicon.ico

è®¿é—®æ–¹å¼ï¼š
http://localhost:8080/css/style.css
http://localhost:8080/js/app.js  
http://localhost:8080/images/logo.png
http://localhost:8080/favicon.ico
```

### 5.3 è‡ªå®šä¹‰é™æ€èµ„æºé…ç½®


**ğŸ”§ ä¿®æ”¹èµ„æºè·¯å¾„æ˜ å°„**ï¼š
```java
@Configuration
public class StaticResourceConfig implements WebMvcConfigurer {
    
    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
        // è‡ªå®šä¹‰æ–‡ä»¶ä¸Šä¼ ç›®å½•
        registry.addResourceHandler("/uploads/**")
                .addResourceLocations("file:///D:/uploads/")
                .setCachePeriod(3600);  // ç¼“å­˜1å°æ—¶
                
        // è‡ªå®šä¹‰é™æ€èµ„æºç›®å½•
        registry.addResourceHandler("/assets/**")
                .addResourceLocations("classpath:/assets/")
                .resourceChain(true)
                .addResolver(new PathResourceResolver());
    }
}
```

**ğŸ“‹ é…ç½®æ–‡ä»¶æ–¹å¼**ï¼š
```properties
# application.properties
# è‡ªå®šä¹‰é™æ€èµ„æºè·¯å¾„
spring.web.resources.static-locations=classpath:/static/,classpath:/public/,file:///D:/files/

# é™æ€èµ„æºURLè·¯å¾„å‰ç¼€
spring.mvc.static-path-pattern=/static/**

# ç¼“å­˜é…ç½®
spring.web.resources.cache.period=3600
spring.web.resources.cache.cachecontrol.max-age=3600
```

### 5.4 é™æ€èµ„æºç‰ˆæœ¬ç®¡ç†


**ğŸš€ è§£å†³æµè§ˆå™¨ç¼“å­˜é—®é¢˜**ï¼š
```java
@Configuration
public class ResourceVersionConfig implements WebMvcConfigurer {
    
    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
        registry.addResourceHandler("/static/**")
                .addResourceLocations("classpath:/static/")
                .resourceChain(true)
                .addResolver(new VersionResourceResolver()
                    .addContentVersionStrategy("/**"));  // åŸºäºå†…å®¹ç”Ÿæˆç‰ˆæœ¬å·
    }
}
```

**é…ç½®æ–‡ä»¶å¯ç”¨ç‰ˆæœ¬æ§åˆ¶**ï¼š
```properties
# å¯ç”¨èµ„æºç‰ˆæœ¬æ§åˆ¶
spring.web.resources.chain.strategy.content.enabled=true
spring.web.resources.chain.strategy.content.paths=/**
```

**ç‰ˆæœ¬æ§åˆ¶æ•ˆæœ**ï¼š
```
åŸå§‹è®¿é—®ï¼š/css/style.css
ç‰ˆæœ¬æ§åˆ¶åï¼š/css/style-d41d8cd98f00b204e9800998ecf8427e.css
```

### 5.5 é™æ€èµ„æºå®‰å…¨é…ç½®


**ğŸ”’ ä¿æŠ¤æ•æ„Ÿç›®å½•**ï¼š
```java
@Configuration
public class SecurityResourceConfig implements WebMvcConfigurer {
    
    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
        // åªå…è®¸ç‰¹å®šæ ¼å¼çš„æ–‡ä»¶è®¿é—®
        registry.addResourceHandler("/images/**")
                .addResourceLocations("classpath:/static/images/")
                .resourceChain(true)
                .addResolver(new PathResourceResolver() {
                    @Override
                    protected Resource getResource(String resourcePath, Resource location) {
                        Resource resource = super.getResource(resourcePath, location);
                        // åªå…è®¸å›¾ç‰‡æ ¼å¼
                        if (resource != null && resourcePath.matches(".*\\.(jpg|jpeg|png|gif|svg)$")) {
                            return resource;
                        }
                        return null;
                    }
                });
    }
}
```

---

## 6. ğŸ¨ é”™è¯¯é¡µé¢å®šåˆ¶


### 6.1 ä»€ä¹ˆæ˜¯é”™è¯¯é¡µé¢


**ğŸ”¸ é”™è¯¯é¡µé¢**ï¼šå½“åº”ç”¨å‡ºç°å¼‚å¸¸æ—¶æ˜¾ç¤ºç»™ç”¨æˆ·çš„å‹å¥½é¡µé¢

```
ç”¨æˆ·ä½“éªŒå¯¹æ¯”ï¼š

âŒ é»˜è®¤é”™è¯¯é¡µé¢ï¼š
Whitelabel Error Page
This application has no explicit mapping for /error...

âœ… è‡ªå®šä¹‰é”™è¯¯é¡µé¢ï¼š
å¾ˆæŠ±æ­‰ï¼Œé¡µé¢å‡ºç°äº†é—®é¢˜
æˆ‘ä»¬æ­£åœ¨åŠªåŠ›ä¿®å¤ï¼Œè¯·ç¨åå†è¯•
```

### 6.2 Spring Booté”™è¯¯å¤„ç†æœºåˆ¶


**ğŸ”§ é”™è¯¯å¤„ç†æµç¨‹**ï¼š
```
å¼‚å¸¸å‘ç”Ÿ â†’ ErrorMvcAutoConfiguration â†’ BasicErrorController â†’ é”™è¯¯è§†å›¾/JSON
```

**ğŸ“‹ é»˜è®¤é”™è¯¯é¡µé¢è·¯å¾„**ï¼š
```
templates/error/
â”œâ”€â”€ 4xx.html    (4å¼€å¤´çš„é”™è¯¯ç )
â”œâ”€â”€ 404.html    (å…·ä½“404é”™è¯¯)  
â”œâ”€â”€ 5xx.html    (5å¼€å¤´çš„é”™è¯¯ç )
â”œâ”€â”€ 500.html    (å…·ä½“500é”™è¯¯)
â””â”€â”€ error.html  (é€šç”¨é”™è¯¯é¡µé¢)
```

### 6.3 è‡ªå®šä¹‰é”™è¯¯é¡µé¢


**ğŸ¨ åˆ›å»ºé”™è¯¯é¡µé¢æ¨¡æ¿**ï¼š

**404.html**ï¼š
```html
<!DOCTYPE html>
<html>
<head>
    <title>é¡µé¢æœªæ‰¾åˆ°</title>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial; text-align: center; padding: 50px; }
        .error-container { max-width: 500px; margin: 0 auto; }
        .error-code { font-size: 72px; color: #ff6b6b; }
        .error-message { font-size: 24px; color: #666; margin: 20px 0; }
    </style>
</head>
<body>
    <div class="error-container">
        <div class="error-code">404</div>
        <div class="error-message">é¡µé¢æ‰¾ä¸åˆ°äº†</div>
        <p>æ‚¨è®¿é—®çš„é¡µé¢ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥URLæ˜¯å¦æ­£ç¡®</p>
        <a href="/">è¿”å›é¦–é¡µ</a>
    </div>
</body>
</html>
```

**500.html**ï¼š
```html
<!DOCTYPE html>
<html>
<head>
    <title>æœåŠ¡å™¨é”™è¯¯</title>
    <meta charset="UTF-8">
</head>
<body>
    <div class="error-container">
        <div class="error-code">500</div>
        <div class="error-message">æœåŠ¡å™¨å†…éƒ¨é”™è¯¯</div>
        <p>æœåŠ¡å™¨é‡åˆ°äº†é—®é¢˜ï¼Œæˆ‘ä»¬æ­£åœ¨åŠªåŠ›ä¿®å¤</p>
        <p>æ—¶é—´ï¼š<span th:text="${timestamp}"></span></p>
        <p>é”™è¯¯IDï¼š<span th:text="${error}"></span></p>
    </div>
</body>
</html>
```

### 6.4 è‡ªå®šä¹‰ErrorController


**ğŸ¯ å®Œå…¨è‡ªå®šä¹‰é”™è¯¯å¤„ç†**ï¼š
```java
@Controller
public class CustomErrorController implements ErrorController {
    
    private final ErrorAttributes errorAttributes;
    
    public CustomErrorController(ErrorAttributes errorAttributes) {
        this.errorAttributes = errorAttributes;
    }
    
    @RequestMapping("/error")
    public String handleError(HttpServletRequest request, Model model) {
        // è·å–é”™è¯¯ä¿¡æ¯
        WebRequest webRequest = new ServletWebRequest(request);
        Map<String, Object> errorMap = errorAttributes.getErrorAttributes(
            webRequest, ErrorAttributeOptions.defaults());
        
        Integer status = (Integer) errorMap.get("status");
        model.addAllAttributes(errorMap);
        
        // æ ¹æ®çŠ¶æ€ç è¿”å›ä¸åŒé¡µé¢
        if (status != null) {
            if (status == 404) {
                return "error/404";
            } else if (status == 500) {
                return "error/500";  
            } else if (status >= 400 && status < 500) {
                return "error/4xx";
            } else if (status >= 500) {
                return "error/5xx";
            }
        }
        
        return "error/error";
    }
}
```

### 6.5 APIé”™è¯¯å¤„ç†


**ğŸ”§ RESTful APIçš„é”™è¯¯å“åº”**ï¼š
```java
@RestControllerAdvice
public class GlobalExceptionHandler {
    
    @ExceptionHandler(ResourceNotFoundException.class)
    @ResponseStatus(HttpStatus.NOT_FOUND)
    public ErrorResponse handleNotFoundException(ResourceNotFoundException ex) {
        return ErrorResponse.builder()
                .code("RESOURCE_NOT_FOUND")
                .message(ex.getMessage())
                .timestamp(LocalDateTime.now())
                .build();
    }
    
    @ExceptionHandler(ValidationException.class)
    @ResponseStatus(HttpStatus.BAD_REQUEST)
    public ErrorResponse handleValidationException(ValidationException ex) {
        return ErrorResponse.builder()
                .code("VALIDATION_ERROR")
                .message("è¯·æ±‚å‚æ•°éªŒè¯å¤±è´¥")
                .details(ex.getErrors())
                .timestamp(LocalDateTime.now())
                .build();
    }
    
    @ExceptionHandler(Exception.class)
    @ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)
    public ErrorResponse handleGenericException(Exception ex) {
        return ErrorResponse.builder()
                .code("INTERNAL_ERROR")
                .message("ç³»ç»Ÿå†…éƒ¨é”™è¯¯")
                .timestamp(LocalDateTime.now())
                .build();
    }
}
```

**ğŸ“‹ ç»Ÿä¸€é”™è¯¯å“åº”æ ¼å¼**ï¼š
```java
@Data
@Builder
public class ErrorResponse {
    private String code;        // é”™è¯¯ç¼–ç 
    private String message;     // é”™è¯¯æè¿°
    private Object details;     // è¯¦ç»†ä¿¡æ¯
    private LocalDateTime timestamp;  // æ—¶é—´æˆ³
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Spring Boot Web Starterï¼šä¸€ç«™å¼Webå¼€å‘è§£å†³æ–¹æ¡ˆ
ğŸ”¸ DispatcherServletï¼šSpring MVCçš„æ ¸å¿ƒè°ƒåº¦å™¨ï¼Œæ‰€æœ‰è¯·æ±‚çš„å…¥å£
ğŸ”¸ HttpMessageConverterï¼šè´Ÿè´£è¯·æ±‚å“åº”çš„æ ¼å¼è½¬æ¢ï¼Œå¦‚JSONè½¬Javaå¯¹è±¡
ğŸ”¸ CORSé…ç½®ï¼šè§£å†³å‰åç«¯åˆ†ç¦»å¼€å‘ä¸­çš„è·¨åŸŸé—®é¢˜
ğŸ”¸ é™æ€èµ„æºå¤„ç†ï¼šç®¡ç†CSSã€JSã€å›¾ç‰‡ç­‰é™æ€æ–‡ä»¶çš„è®¿é—®
ğŸ”¸ é”™è¯¯é¡µé¢å®šåˆ¶ï¼šæä¾›å‹å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œé¿å…æ˜¾ç¤ºæŠ€æœ¯é”™è¯¯ä¿¡æ¯
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä»ä¾èµ–åˆ°é…ç½®çš„ç†è§£**ï¼š
```
ä¾èµ–å±‚é¢ï¼š
spring-boot-starter-web â†’ åŒ…å«æ‰€æœ‰å¿…è¦ç»„ä»¶

é…ç½®å±‚é¢ï¼š
é›¶é…ç½® â†’ è‡ªåŠ¨é…ç½® â†’ è‡ªå®šä¹‰é…ç½®
(å¼€ç®±å³ç”¨) â†’ (æ»¡è¶³å¤§éƒ¨åˆ†éœ€æ±‚) â†’ (ä¸ªæ€§åŒ–å®šåˆ¶)
```

**ğŸ”¹ è¯·æ±‚å¤„ç†çš„å®Œæ•´æµç¨‹**ï¼š
```
HTTPè¯·æ±‚ â†’ DispatcherServlet â†’ HandlerMapping â†’ Controller
         â†“
å“åº”å¤„ç† â† HttpMessageConverter â† ViewResolver â† ä¸šåŠ¡å¤„ç†
```

**ğŸ”¹ é…ç½®ä¼˜å…ˆçº§ç†è§£**ï¼š
```
é«˜ä¼˜å…ˆçº§ï¼šJavaé…ç½®ç±» (@Configuration)
ä¸­ä¼˜å…ˆçº§ï¼šæ³¨è§£é…ç½® (@CrossOriginç­‰)  
ä½ä¼˜å…ˆçº§ï¼šé…ç½®æ–‡ä»¶ (application.properties)

åŸåˆ™ï¼šè¶Šå…·ä½“çš„é…ç½®ä¼˜å…ˆçº§è¶Šé«˜
```

### 7.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ å‰åç«¯åˆ†ç¦»å¼€å‘**ï¼š
- CORSé…ç½®è§£å†³å¼€å‘ç¯å¢ƒè·¨åŸŸé—®é¢˜
- HttpMessageConverterè‡ªåŠ¨å¤„ç†JSONæ•°æ®
- é”™è¯¯å¤„ç†æä¾›ç»Ÿä¸€çš„APIå“åº”æ ¼å¼

**ğŸ¯ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²**ï¼š
- é™æ€èµ„æºç‰ˆæœ¬æ§åˆ¶é¿å…ç¼“å­˜é—®é¢˜
- è‡ªå®šä¹‰é”™è¯¯é¡µé¢æå‡ç”¨æˆ·ä½“éªŒ
- DispatcherServleté…ç½®ä¼˜åŒ–æ€§èƒ½

**ğŸ¯ å›¢é˜Ÿåä½œå¼€å‘**ï¼š
- starterç»Ÿä¸€æŠ€æœ¯æ ˆï¼Œå‡å°‘é…ç½®å·®å¼‚
- å…¨å±€é…ç½®ä¿è¯é¡¹ç›®ä¸€è‡´æ€§
- çº¦å®šä¼˜äºé…ç½®ï¼Œé™ä½å­¦ä¹ æˆæœ¬

### 7.4 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


| é—®é¢˜ | **åŸå› ** | **è§£å†³æ–¹æ¡ˆ** | **é¢„é˜²æªæ–½** |
|------|---------|-------------|-------------|
| è·¨åŸŸè¯·æ±‚å¤±è´¥ | CORSé…ç½®ä¸æ­£ç¡® | æ£€æŸ¥allowed-originsé…ç½® | å¼€å‘ç¯å¢ƒç»Ÿä¸€é…ç½® |
| é™æ€èµ„æº404 | è·¯å¾„é…ç½®é”™è¯¯ | æ£€æŸ¥static-locations | ä½¿ç”¨é»˜è®¤è·¯å¾„è§„èŒƒ |
| JSONè½¬æ¢å¤±è´¥ | å¯¹è±¡åºåˆ—åŒ–é—®é¢˜ | æ·»åŠ é»˜è®¤æ„é€ å‡½æ•° | ä½¿ç”¨æ ‡å‡†JavaBean |
| é”™è¯¯é¡µé¢ä¸ç”Ÿæ•ˆ | æ¨¡æ¿è·¯å¾„ä¸å¯¹ | æ£€æŸ¥templates/errorç›®å½• | éµå¾ªå‘½åçº¦å®š |

### 7.5 è¿›é˜¶å­¦ä¹ è·¯å¾„


**ğŸš€ ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®®**ï¼š
```
åŸºç¡€æŒæ¡åå¯ä»¥æ·±å…¥ï¼š

æ·±åº¦å®šåˆ¶ï¼š
â€¢ è‡ªå®šä¹‰HandlerMapping
â€¢ å®ç°è‡ªå·±çš„MessageConverter
â€¢ æ·±åº¦å®šåˆ¶å¼‚å¸¸å¤„ç†æœºåˆ¶

æ€§èƒ½ä¼˜åŒ–ï¼š
â€¢ é™æ€èµ„æºCDNé›†æˆ  
â€¢ HTTPç¼“å­˜ç­–ç•¥ä¼˜åŒ–
â€¢ å‹ç¼©å’Œåˆå¹¶èµ„æº

å®‰å…¨å¢å¼ºï¼š
â€¢ Spring Securityé›†æˆ
â€¢ APIè®¿é—®æ§åˆ¶
â€¢ é˜²æŠ¤å¸¸è§Webæ”»å‡»
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
ğŸ“ ä¸€ä¸ªstarteråŒ…ä¸‡è±¡ï¼ŒDispatcherServletæ˜¯æ ¸å¿ƒ
ğŸ”„ æ¶ˆæ¯è½¬æ¢JSONä¾¿ï¼Œè·¨åŸŸé…ç½®CORSè¡Œ
ğŸ“ é™æ€èµ„æºæœ‰è·¯å¾„ï¼Œé”™è¯¯é¡µé¢è¦å‹å¥½
ğŸ¯ é…ç½®ä¼˜å…ˆæœ‰å±‚æ¬¡ï¼Œå®è·µå‡ºçœŸçŸ¥æœ€é‡è¦
```

**ğŸ’¡ æ ¸å¿ƒç†è§£**ï¼š
- Spring Boot Webå¼€å‘çš„æœ¬è´¨å°±æ˜¯**çº¦å®šä¼˜äºé…ç½®**
- ç†è§£**è‡ªåŠ¨é…ç½®åŸç†**æ¯”è®°ä½é…ç½®é¡¹æ›´é‡è¦  
- **å®é™…é¡¹ç›®ç»éªŒ**æ˜¯æŒæ¡è¿™äº›çŸ¥è¯†çš„æœ€ä½³é€”å¾„
- **å¾ªåºæ¸è¿›**ï¼šä»ä½¿ç”¨é»˜è®¤é…ç½®å¼€å§‹ï¼Œé€æ­¥æ·±å…¥å®šåˆ¶