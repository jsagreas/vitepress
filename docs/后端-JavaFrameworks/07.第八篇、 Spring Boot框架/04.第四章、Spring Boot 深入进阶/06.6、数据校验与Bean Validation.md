---
title: 6ã€æ•°æ®æ ¡éªŒä¸Bean Validation
---
## ğŸ“š ç›®å½•

1. [æ•°æ®æ ¡éªŒæ¦‚è¿°](#1-æ•°æ®æ ¡éªŒæ¦‚è¿°)
2. [Bean Validationæ ‡å‡†è¯¦è§£](#2-Bean-Validationæ ‡å‡†è¯¦è§£)
3. [@Validä¸@Validatedçš„åŒºåˆ«](#3-Validä¸Validatedçš„åŒºåˆ«)
4. [å†…ç½®æ ¡éªŒæ³¨è§£ä½¿ç”¨](#4-å†…ç½®æ ¡éªŒæ³¨è§£ä½¿ç”¨)
5. [è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£](#5-è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£)
6. [åˆ†ç»„æ ¡éªŒç­–ç•¥](#6-åˆ†ç»„æ ¡éªŒç­–ç•¥)
7. [æ ¡éªŒå¼‚å¸¸ç»Ÿä¸€å¤„ç†](#7-æ ¡éªŒå¼‚å¸¸ç»Ÿä¸€å¤„ç†)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ›¡ï¸ æ•°æ®æ ¡éªŒæ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯æ•°æ®æ ¡éªŒ


**ç®€å•ç†è§£**ï¼šæ•°æ®æ ¡éªŒå°±åƒé—¨å£çš„å®‰æ£€å‘˜ï¼Œè´Ÿè´£æ£€æŸ¥è¿›å…¥ç³»ç»Ÿçš„æ•°æ®æ˜¯å¦ç¬¦åˆè¦æ±‚ã€‚

```
ç°å®ç”Ÿæ´»ç±»æ¯”ï¼š
æœºåœºå®‰æ£€ â†’ æ£€æŸ¥è¡Œææ˜¯å¦ç¬¦åˆè§„å®š
æ•°æ®æ ¡éªŒ â†’ æ£€æŸ¥æ•°æ®æ˜¯å¦ç¬¦åˆä¸šåŠ¡è§„åˆ™

ä¾‹å¦‚ï¼šç”¨æˆ·æ³¨å†Œ
- ç”¨æˆ·åä¸èƒ½ä¸ºç©º âœ“
- é‚®ç®±æ ¼å¼è¦æ­£ç¡® âœ“  
- æ‰‹æœºå·å¿…é¡»11ä½ âœ“
- å¹´é¾„å¿…é¡»å¤§äº0 âœ“
```

**ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®æ ¡éªŒ**ï¼š
- **å®‰å…¨ä¿éšœ**ï¼šé˜²æ­¢æ¶æ„æ•°æ®æ³¨å…¥æ”»å‡»
- **æ•°æ®è´¨é‡**ï¼šç¡®ä¿å­˜å‚¨çš„æ•°æ®ç¬¦åˆä¸šåŠ¡è§„åˆ™
- **ç”¨æˆ·ä½“éªŒ**ï¼šåŠæ—¶ç»™å‡ºå‹å¥½çš„é”™è¯¯æç¤º
- **ç³»ç»Ÿç¨³å®š**ï¼šé¿å…é”™è¯¯æ•°æ®å¯¼è‡´ç¨‹åºå´©æºƒ

### 1.2 æ ¡éªŒçš„å±‚æ¬¡ç»“æ„


```
å‰ç«¯æ ¡éªŒï¼ˆç¬¬ä¸€é“é˜²çº¿ï¼‰
    â†“ JavaScriptè¡¨å•éªŒè¯
    â†“ ç”¨æˆ·ä½“éªŒä¼˜åŒ–

åç«¯æ ¡éªŒï¼ˆæ ¸å¿ƒé˜²çº¿ï¼‰  
    â†“ Controllerå±‚å‚æ•°æ ¡éªŒ
    â†“ Serviceå±‚ä¸šåŠ¡æ ¡éªŒ
    â†“ æ•°æ®åº“çº¦æŸæ ¡éªŒ

ä¸‰é‡é˜²æŠ¤ï¼Œç¡®ä¿æ•°æ®å®‰å…¨ï¼
```

**ğŸ’¡ é‡è¦æé†’**ï¼šå‰ç«¯æ ¡éªŒå¯ä»¥è¢«ç»•è¿‡ï¼Œåç«¯æ ¡éªŒæ‰æ˜¯çœŸæ­£çš„å®‰å…¨ä¿éšœ

---

## 2. ğŸ“‹ Bean Validationæ ‡å‡†è¯¦è§£


### 2.1 JSR-303ä¸JSR-380æ ‡å‡†


**JSR-303**ï¼šJavaè§„èŒƒè¯·æ±‚ï¼Œå®šä¹‰äº†Beanæ ¡éªŒçš„ç¬¬ä¸€ä¸ªæ ‡å‡†
**JSR-380**ï¼šBean Validation 2.0ï¼Œæ˜¯JSR-303çš„å‡çº§ç‰ˆ

```
å‘å±•å†ç¨‹ï¼š
JSR-303 (2009) â†’ Bean Validation 1.0 â†’ åŸºç¡€æ ¡éªŒåŠŸèƒ½
JSR-349 (2013) â†’ Bean Validation 1.1 â†’ å¢å¼ºåŠŸèƒ½  
JSR-380 (2017) â†’ Bean Validation 2.0 â†’ æ”¯æŒJava 8+

å°±åƒæ‰‹æœºç³»ç»Ÿå‡çº§ï¼š
Android 9 â†’ Android 10 â†’ Android 11
åŠŸèƒ½è¶Šæ¥è¶Šå¼ºå¤§ï¼Œä½¿ç”¨æ›´ä¾¿æ·
```

### 2.2 Spring Bootä¸­çš„é›†æˆ


**å¼€ç®±å³ç”¨**ï¼šSpring Bootè‡ªåŠ¨é›†æˆäº†Bean Validation

```xml
<!-- Spring Boot Webå¯åŠ¨å™¨å·²ç»åŒ…å«äº†æ ¡éªŒåŠŸèƒ½ -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
</dependency>

<!-- å¦‚æœéœ€è¦å•ç‹¬ä½¿ç”¨æ ¡éªŒåŠŸèƒ½ -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-validation</artifactId>
</dependency>
```

**æ ¸å¿ƒç»„ä»¶**ï¼š
- **Hibernate Validator**ï¼šæœ€å¸¸ç”¨çš„Bean Validationå®ç°
- **Spring Validation**ï¼šSpringå¯¹æ ¡éªŒçš„æ‰©å±•æ”¯æŒ
- **æ ¡éªŒå™¨å·¥å‚**ï¼šè´Ÿè´£åˆ›å»ºå’Œç®¡ç†æ ¡éªŒå™¨å®ä¾‹

---

## 3. âš–ï¸ @Validä¸@Validatedçš„åŒºåˆ«


### 3.1 åŸºæœ¬æ¦‚å¿µå¯¹æ¯”


| ç‰¹æ€§å¯¹æ¯” | **@Valid** | **@Validated** |
|---------|------------|----------------|
| **æ¥æº** | `JSR-303æ ‡å‡†æ³¨è§£` | `Springæ¡†æ¶æ³¨è§£` |
| **åŠŸèƒ½** | `åŸºç¡€æ ¡éªŒ` | `å¢å¼ºæ ¡éªŒ` |
| **åˆ†ç»„æ”¯æŒ** | `ä¸æ”¯æŒ` | `æ”¯æŒåˆ†ç»„æ ¡éªŒ` |
| **åµŒå¥—æ ¡éªŒ** | `æ”¯æŒ` | `æ”¯æŒ` |
| **é€‚ç”¨åœºæ™¯** | `ç®€å•æ ¡éªŒéœ€æ±‚` | `å¤æ‚æ ¡éªŒåœºæ™¯` |

### 3.2 ä½¿ç”¨ç¤ºä¾‹å¯¹æ¯”


**@ValidåŸºç¡€ç”¨æ³•**ï¼š
```java
@RestController
public class UserController {
    
    @PostMapping("/register")
    public String register(@Valid @RequestBody User user) {
        // @Validä¼šè‡ªåŠ¨æ ¡éªŒUserå¯¹è±¡çš„æ‰€æœ‰æ³¨è§£
        return "æ³¨å†ŒæˆåŠŸ";
    }
}

// ç”¨æˆ·å®ä½“ç±»
public class User {
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    private String username;
    
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")  
    private String email;
    
    // getter/setter...
}
```

**@Validatedå¢å¼ºç”¨æ³•**ï¼š
```java
@RestController
@Validated  // ç±»çº§åˆ«å£°æ˜ï¼Œæ”¯æŒæ–¹æ³•å‚æ•°æ ¡éªŒ
public class UserController {
    
    // åˆ†ç»„æ ¡éªŒï¼šæ³¨å†Œæ—¶çš„æ ¡éªŒè§„åˆ™
    @PostMapping("/register")
    public String register(@Validated(CreateGroup.class) @RequestBody User user) {
        return "æ³¨å†ŒæˆåŠŸ";
    }
    
    // åˆ†ç»„æ ¡éªŒï¼šæ›´æ–°æ—¶çš„æ ¡éªŒè§„åˆ™  
    @PutMapping("/update")
    public String update(@Validated(UpdateGroup.class) @RequestBody User user) {
        return "æ›´æ–°æˆåŠŸ";
    }
    
    // å•ä¸ªå‚æ•°æ ¡éªŒ
    @GetMapping("/user/{id}")
    public User getUser(@PathVariable @Min(value = 1, message = "IDå¿…é¡»å¤§äº0") Long id) {
        return userService.findById(id);
    }
}
```

### 3.3 é€‰æ‹©å»ºè®®


```
ğŸ¯ é€‰æ‹©æŒ‡å—ï¼š

ç®€å•åœºæ™¯ â†’ ä½¿ç”¨@Valid
- åªéœ€è¦åŸºç¡€æ ¡éªŒ
- ä¸éœ€è¦åˆ†ç»„åŠŸèƒ½
- æ ¡éªŒè§„åˆ™æ¯”è¾ƒå›ºå®š

å¤æ‚åœºæ™¯ â†’ ä½¿ç”¨@Validated  
- éœ€è¦åˆ†ç»„æ ¡éªŒ
- ä¸åŒæ¥å£ä¸åŒè§„åˆ™
- éœ€è¦æ ¡éªŒå•ä¸ªå‚æ•°
```

---

## 4. ğŸ”§ å†…ç½®æ ¡éªŒæ³¨è§£ä½¿ç”¨


### 4.1 ç©ºå€¼æ ¡éªŒæ³¨è§£


| æ³¨è§£ | **ä½œç”¨** | **é€‚ç”¨ç±»å‹** | **ä½¿ç”¨åœºæ™¯** |
|------|---------|-------------|-------------|
| `@NotNull` | `ä¸èƒ½ä¸ºnull` | `ä»»ä½•ç±»å‹` | `å¯¹è±¡ä¸èƒ½ä¸ºç©º` |
| `@NotEmpty` | `ä¸èƒ½ä¸ºnullä¸”é•¿åº¦>0` | `å­—ç¬¦ä¸²ã€é›†åˆã€æ•°ç»„` | `é›†åˆä¸èƒ½ä¸ºç©º` |
| `@NotBlank` | `ä¸èƒ½ä¸ºnullä¸”å»ç©ºæ ¼åé•¿åº¦>0` | `å­—ç¬¦ä¸²` | `æ–‡æœ¬ä¸èƒ½ä¸ºç©º` |

**å®é™…ä½¿ç”¨**ï¼š
```java
public class User {
    @NotNull(message = "IDä¸èƒ½ä¸ºç©º")
    private Long id;
    
    @NotEmpty(message = "è§’è‰²åˆ—è¡¨ä¸èƒ½ä¸ºç©º") 
    private List<String> roles;
    
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    private String username;  // æœ€ä¸¥æ ¼çš„å­—ç¬¦ä¸²æ ¡éªŒ
}
```

**ğŸ’¡ è®°å¿†æŠ€å·§**ï¼š
- `@NotNull`ï¼šæœ€å®½æ¾ï¼Œåªè¦ä¸æ˜¯nullå°±è¡Œ
- `@NotEmpty`ï¼šä¸­ç­‰ä¸¥æ ¼ï¼Œä¸èƒ½ä¸ºnullä¹Ÿä¸èƒ½ä¸ºç©º
- `@NotBlank`ï¼šæœ€ä¸¥æ ¼ï¼Œè¿˜ä¸èƒ½å…¨æ˜¯ç©ºæ ¼

### 4.2 æ•°å€¼æ ¡éªŒæ³¨è§£


```java
public class Product {
    @Min(value = 0, message = "ä»·æ ¼ä¸èƒ½ä¸ºè´Ÿæ•°")
    @Max(value = 999999, message = "ä»·æ ¼ä¸èƒ½è¶…è¿‡999999")
    private BigDecimal price;
    
    @DecimalMin(value = "0.0", message = "è¯„åˆ†ä¸èƒ½å°äº0")
    @DecimalMax(value = "5.0", message = "è¯„åˆ†ä¸èƒ½å¤§äº5")  
    private Double rating;
    
    @Positive(message = "åº“å­˜å¿…é¡»æ˜¯æ­£æ•°")
    private Integer stock;
    
    @Range(min = 1, max = 100, message = "æŠ˜æ‰£å¿…é¡»åœ¨1-100ä¹‹é—´")
    private Integer discount;
}
```

### 4.3 å­—ç¬¦ä¸²æ ¡éªŒæ³¨è§£


```java
public class UserInfo {
    @Size(min = 6, max = 20, message = "å¯†ç é•¿åº¦å¿…é¡»åœ¨6-20ä½ä¹‹é—´")
    private String password;
    
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String email;
    
    @Pattern(regexp = "^1[3-9]\\d{9}$", message = "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®")
    private String phone;
    
    @Length(max = 200, message = "ç®€ä»‹ä¸èƒ½è¶…è¿‡200å­—")
    private String description;
}
```

### 4.4 æ—¥æœŸæ—¶é—´æ ¡éªŒæ³¨è§£


```java
public class Event {
    @Past(message = "ç”Ÿæ—¥å¿…é¡»æ˜¯è¿‡å»çš„æ—¥æœŸ")
    private LocalDate birthday;
    
    @Future(message = "æ´»åŠ¨æ—¶é—´å¿…é¡»æ˜¯å°†æ¥çš„æ—¶é—´")
    private LocalDateTime eventTime;
    
    @PastOrPresent(message = "åˆ›å»ºæ—¶é—´ä¸èƒ½æ˜¯æœªæ¥æ—¶é—´")
    private LocalDateTime createTime;
}
```

---

## 5. ğŸ¨ è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£


### 5.1 ä¸ºä»€ä¹ˆéœ€è¦è‡ªå®šä¹‰æ ¡éªŒ


**å†…ç½®æ³¨è§£çš„å±€é™æ€§**ï¼š
```
å†…ç½®æ³¨è§£åªèƒ½å¤„ç†é€šç”¨çš„æ ¡éªŒåœºæ™¯
ä½†ä¸šåŠ¡ä¸­ç»å¸¸æœ‰ç‰¹æ®Šéœ€æ±‚ï¼š
- èº«ä»½è¯å·ç æ ¼å¼æ ¡éªŒ
- é“¶è¡Œå¡å·æ ¡éªŒ  
- ä¸šåŠ¡çŠ¶æ€æ ¡éªŒ
- å¤æ‚çš„ç»„åˆæ¡ä»¶æ ¡éªŒ
```

### 5.2 è‡ªå®šä¹‰æ³¨è§£ä¸‰æ­¥éª¤


**æ­¥éª¤1ï¼šå®šä¹‰æ³¨è§£**
```java
@Target({ElementType.FIELD, ElementType.PARAMETER})
@Retention(RetentionPolicy.RUNTIME)
@Constraint(validatedBy = IdCardValidator.class)  // æŒ‡å®šæ ¡éªŒå™¨
@Documented
public @interface IdCard {
    
    String message() default "èº«ä»½è¯å·ç æ ¼å¼ä¸æ­£ç¡®";
    
    Class<?>[] groups() default {};
    
    Class<? extends Payload>[] payload() default {};
}
```

**æ­¥éª¤2ï¼šå®ç°æ ¡éªŒå™¨**
```java
public class IdCardValidator implements ConstraintValidator<IdCard, String> {
    
    @Override
    public void initialize(IdCard annotation) {
        // åˆå§‹åŒ–æ–¹æ³•ï¼Œå¯ä»¥è·å–æ³¨è§£å‚æ•°
    }
    
    @Override
    public boolean isValid(String value, ConstraintValidatorContext context) {
        if (value == null || value.trim().isEmpty()) {
            return true;  // ç©ºå€¼ç”±@NotBlankç­‰å…¶ä»–æ³¨è§£å¤„ç†
        }
        
        // ç®€åŒ–çš„èº«ä»½è¯æ ¡éªŒé€»è¾‘
        return value.matches("^[1-9]\\d{5}(18|19|([23]\\d))\\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\\d{3}[0-9Xx]$");
    }
}
```

**æ­¥éª¤3ï¼šä½¿ç”¨æ³¨è§£**
```java
public class Person {
    @NotBlank(message = "èº«ä»½è¯å·ä¸èƒ½ä¸ºç©º")
    @IdCard  // ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£
    private String idCard;
    
    @NotBlank(message = "å§“åä¸èƒ½ä¸ºç©º")
    private String name;
}
```

### 5.3 é«˜çº§è‡ªå®šä¹‰æ ¡éªŒ


**å¤åˆæ¡ä»¶æ ¡éªŒ**ï¼š
```java
@Target(ElementType.TYPE)  // æ³¨æ„ï¼šä½œç”¨åœ¨ç±»ä¸Š
@Retention(RetentionPolicy.RUNTIME) 
@Constraint(validatedBy = PasswordMatchValidator.class)
public @interface PasswordMatch {
    String message() default "ä¸¤æ¬¡å¯†ç è¾“å…¥ä¸ä¸€è‡´";
    Class<?>[] groups() default {};
    Class<? extends Payload>[] payload() default {};
}

// æ ¡éªŒå™¨å®ç°
public class PasswordMatchValidator implements ConstraintValidator<PasswordMatch, Object> {
    
    @Override
    public boolean isValid(Object obj, ConstraintValidatorContext context) {
        if (obj instanceof UserRegisterDto) {
            UserRegisterDto dto = (UserRegisterDto) obj;
            return Objects.equals(dto.getPassword(), dto.getConfirmPassword());
        }
        return false;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
@PasswordMatch  // ç±»çº§åˆ«çš„æ ¡éªŒ
public class UserRegisterDto {
    private String password;
    private String confirmPassword;
    // getter/setter...
}
```

---

## 6. ğŸ­ åˆ†ç»„æ ¡éªŒç­–ç•¥


### 6.1 åˆ†ç»„æ ¡éªŒçš„åº”ç”¨åœºæ™¯


**ä¸šåŠ¡èƒŒæ™¯**ï¼šåŒä¸€ä¸ªå®ä½“ç±»åœ¨ä¸åŒæ“ä½œæ—¶éœ€è¦ä¸åŒçš„æ ¡éªŒè§„åˆ™

```
ç”¨æˆ·ç®¡ç†åœºæ™¯ï¼š
åˆ›å»ºç”¨æˆ·ï¼šç”¨æˆ·åã€é‚®ç®±ã€å¯†ç éƒ½å¿…å¡«
æ›´æ–°ç”¨æˆ·ï¼šç”¨æˆ·åã€é‚®ç®±å¿…å¡«ï¼Œå¯†ç å¯é€‰
åˆ é™¤ç”¨æˆ·ï¼šåªéœ€è¦ç”¨æˆ·ID

å¦‚ä½•ç”¨ä¸€ä¸ªUserç±»æ»¡è¶³ä¸‰ç§ä¸åŒçš„æ ¡éªŒéœ€æ±‚ï¼Ÿ
ç­”æ¡ˆï¼šåˆ†ç»„æ ¡éªŒï¼
```

### 6.2 å®šä¹‰æ ¡éªŒåˆ†ç»„


**åˆ›å»ºåˆ†ç»„æ¥å£**ï¼š
```java
// æ ‡è®°æ¥å£ï¼Œç”¨äºåˆ†ç»„
public interface CreateGroup {
}

public interface UpdateGroup {
}

public interface DeleteGroup {
}
```

**åœ¨å®ä½“ç±»ä¸­æŒ‡å®šåˆ†ç»„**ï¼š
```java
public class User {
    
    @NotNull(groups = {UpdateGroup.class, DeleteGroup.class}, message = "æ›´æ–°å’Œåˆ é™¤æ—¶IDä¸èƒ½ä¸ºç©º")
    private Long id;
    
    @NotBlank(groups = {CreateGroup.class, UpdateGroup.class}, message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @Size(min = 3, max = 20, groups = {CreateGroup.class, UpdateGroup.class})
    private String username;
    
    @Email(groups = {CreateGroup.class, UpdateGroup.class}, message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String email;
    
    @NotBlank(groups = CreateGroup.class, message = "åˆ›å»ºæ—¶å¯†ç ä¸èƒ½ä¸ºç©º")
    @Size(min = 6, max = 20, groups = CreateGroup.class, message = "å¯†ç é•¿åº¦6-20ä½")
    private String password;
    
    // getter/setter...
}
```

### 6.3 Controllerä¸­ä½¿ç”¨åˆ†ç»„


```java
@RestController
public class UserController {
    
    @PostMapping("/users")
    public String createUser(@Validated(CreateGroup.class) @RequestBody User user) {
        // åªæ ¡éªŒCreateGroupåˆ†ç»„çš„è§„åˆ™
        // usernameã€emailã€passwordéƒ½ä¼šè¢«æ ¡éªŒ
        // idä¸ä¼šè¢«æ ¡éªŒï¼ˆå› ä¸ºåˆ›å»ºæ—¶ä¸éœ€è¦IDï¼‰
        return "åˆ›å»ºæˆåŠŸ";
    }
    
    @PutMapping("/users")  
    public String updateUser(@Validated(UpdateGroup.class) @RequestBody User user) {
        // åªæ ¡éªŒUpdateGroupåˆ†ç»„çš„è§„åˆ™
        // idã€usernameã€emailä¼šè¢«æ ¡éªŒ  
        // passwordä¸ä¼šè¢«æ ¡éªŒï¼ˆæ›´æ–°æ—¶å¯†ç å¯é€‰ï¼‰
        return "æ›´æ–°æˆåŠŸ";
    }
    
    @DeleteMapping("/users")
    public String deleteUser(@Validated(DeleteGroup.class) @RequestBody User user) {
        // åªæ ¡éªŒDeleteGroupåˆ†ç»„çš„è§„åˆ™
        // åªæœ‰idä¼šè¢«æ ¡éªŒ
        return "åˆ é™¤æˆåŠŸ";
    }
}
```

### 6.4 åˆ†ç»„ç»§æ‰¿


**é«˜çº§æŠ€å·§**ï¼šåˆ†ç»„å¯ä»¥ç»§æ‰¿ï¼Œå®ç°æ›´çµæ´»çš„æ ¡éªŒç­–ç•¥

```java
// åŸºç¡€åˆ†ç»„
public interface BaseGroup {
}

// ç»§æ‰¿åˆ†ç»„
public interface CreateGroup extends BaseGroup {
}

public interface UpdateGroup extends BaseGroup {  
}

public class User {
    // åŸºç¡€æ ¡éªŒï¼šæ‰€æœ‰æ“ä½œéƒ½éœ€è¦
    @NotBlank(groups = BaseGroup.class, message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    private String username;
    
    // ç‰¹æ®Šæ ¡éªŒï¼šåªæœ‰åˆ›å»ºæ—¶éœ€è¦
    @NotBlank(groups = CreateGroup.class, message = "å¯†ç ä¸èƒ½ä¸ºç©º")
    private String password;
}
```

---

## 7. ğŸš¨ æ ¡éªŒå¼‚å¸¸ç»Ÿä¸€å¤„ç†


### 7.1 æ ¡éªŒå¼‚å¸¸çš„ç±»å‹


**Spring Bootä¸­å¸¸è§çš„æ ¡éªŒå¼‚å¸¸**ï¼š

```
MethodArgumentNotValidException
â”œâ”€â”€ @RequestBodyå‚æ•°æ ¡éªŒå¤±è´¥æ—¶æŠ›å‡º
â”œâ”€â”€ åŒ…å«è¯¦ç»†çš„å­—æ®µé”™è¯¯ä¿¡æ¯

ConstraintViolationException  
â”œâ”€â”€ @PathVariableã€@RequestParamå‚æ•°æ ¡éªŒå¤±è´¥
â”œâ”€â”€ éœ€è¦åœ¨Controllerç±»ä¸Šæ·»åŠ @Validated

BindException
â”œâ”€â”€ è¡¨å•æäº¤æ•°æ®æ ¡éªŒå¤±è´¥
â”œâ”€â”€ é€šå¸¸ç”¨äºä¼ ç»Ÿçš„è¡¨å•æäº¤
```

### 7.2 å…¨å±€å¼‚å¸¸å¤„ç†å™¨


```java
@RestControllerAdvice  // å…¨å±€å¼‚å¸¸å¤„ç†
@Slf4j
public class ValidationExceptionHandler {
    
    /**
     * å¤„ç†@RequestBodyå‚æ•°æ ¡éªŒå¼‚å¸¸
     */
    @ExceptionHandler(MethodArgumentNotValidException.class)
    public ResponseEntity<ApiResponse> handleValidationException(MethodArgumentNotValidException ex) {
        log.warn("å‚æ•°æ ¡éªŒå¤±è´¥ï¼š{}", ex.getMessage());
        
        Map<String, String> errors = new HashMap<>();
        
        // æå–æ‰€æœ‰å­—æ®µé”™è¯¯ä¿¡æ¯
        ex.getBindingResult().getFieldErrors().forEach(error -> {
            errors.put(error.getField(), error.getDefaultMessage());
        });
        
        return ResponseEntity.badRequest().body(
            ApiResponse.error("å‚æ•°æ ¡éªŒå¤±è´¥", errors)
        );
    }
    
    /**
     * å¤„ç†@PathVariableã€@RequestParamå‚æ•°æ ¡éªŒå¼‚å¸¸
     */
    @ExceptionHandler(ConstraintViolationException.class)
    public ResponseEntity<ApiResponse> handleConstraintViolationException(ConstraintViolationException ex) {
        log.warn("å‚æ•°çº¦æŸæ ¡éªŒå¤±è´¥ï¼š{}", ex.getMessage());
        
        Map<String, String> errors = new HashMap<>();
        
        ex.getConstraintViolations().forEach(violation -> {
            String propertyPath = violation.getPropertyPath().toString();
            String message = violation.getMessage();
            errors.put(propertyPath, message);
        });
        
        return ResponseEntity.badRequest().body(
            ApiResponse.error("å‚æ•°æ ¡éªŒå¤±è´¥", errors)
        );
    }
}
```

### 7.3 ç»Ÿä¸€å“åº”æ ¼å¼


**å®šä¹‰æ ‡å‡†çš„APIå“åº”æ ¼å¼**ï¼š
```java
public class ApiResponse<T> {
    private boolean success;
    private String message;
    private T data;
    private Map<String, String> errors;
    
    // æˆåŠŸå“åº”
    public static <T> ApiResponse<T> success(T data) {
        ApiResponse<T> response = new ApiResponse<>();
        response.success = true;
        response.message = "æ“ä½œæˆåŠŸ";
        response.data = data;
        return response;
    }
    
    // é”™è¯¯å“åº”  
    public static <T> ApiResponse<T> error(String message, Map<String, String> errors) {
        ApiResponse<T> response = new ApiResponse<>();
        response.success = false;
        response.message = message;
        response.errors = errors;
        return response;
    }
    
    // getter/setter...
}
```

### 7.4 å‹å¥½çš„é”™è¯¯æç¤º


**å‰ç«¯æ”¶åˆ°çš„é”™è¯¯å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "success": false,
  "message": "å‚æ•°æ ¡éªŒå¤±è´¥",
  "data": null,
  "errors": {
    "username": "ç”¨æˆ·åä¸èƒ½ä¸ºç©º",
    "email": "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®", 
    "age": "å¹´é¾„å¿…é¡»åœ¨18-100ä¹‹é—´"
  }
}
```

**å‰ç«¯å¤„ç†ç¤ºä¾‹**ï¼š
```javascript
// å‰ç«¯å¯ä»¥æ ¹æ®errorså­—æ®µæ˜¾ç¤ºå…·ä½“çš„é”™è¯¯ä¿¡æ¯
if (!response.success && response.errors) {
    Object.keys(response.errors).forEach(field => {
        showFieldError(field, response.errors[field]);
    });
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Bean Validationï¼šJavaæ ‡å‡†çš„æ•°æ®æ ¡éªŒæ¡†æ¶ï¼Œç¡®ä¿æ•°æ®å®‰å…¨
ğŸ”¸ @Valid vs @Validatedï¼šåŸºç¡€æ ¡éªŒå’Œå¢å¼ºæ ¡éªŒçš„åŒºåˆ«
ğŸ”¸ å†…ç½®æ³¨è§£ï¼šæŒæ¡å¸¸ç”¨çš„æ ¡éªŒæ³¨è§£ä½¿ç”¨æ–¹æ³•
ğŸ”¸ è‡ªå®šä¹‰æ ¡éªŒï¼šé’ˆå¯¹ä¸šåŠ¡éœ€æ±‚åˆ›å»ºä¸“ç”¨æ ¡éªŒè§„åˆ™
ğŸ”¸ åˆ†ç»„æ ¡éªŒï¼šåŒä¸€å®ä½“ä¸åŒåœºæ™¯çš„çµæ´»æ ¡éªŒç­–ç•¥
ğŸ”¸ å¼‚å¸¸å¤„ç†ï¼šæä¾›å‹å¥½çš„é”™è¯¯æç¤ºï¼Œæå‡ç”¨æˆ·ä½“éªŒ
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æ ¡éªŒçš„æœ¬è´¨æ„ä¹‰**
```
æ•°æ®æ ¡éªŒ = ç³»ç»Ÿçš„å…ç–«ç³»ç»Ÿ
- é˜²æ­¢æ¶æ„æ•°æ®å…¥ä¾µ
- ç¡®ä¿æ•°æ®è´¨é‡
- æå‡ç”¨æˆ·ä½“éªŒ
- ä¿éšœç³»ç»Ÿç¨³å®š
```

**ğŸ”¹ é€‰æ‹©åˆé€‚çš„æ ¡éªŒæ–¹å¼**  
```
ç®€å•åœºæ™¯ï¼š@Valid + å†…ç½®æ³¨è§£
å¤æ‚åœºæ™¯ï¼š@Validated + åˆ†ç»„æ ¡éªŒ
ç‰¹æ®Šéœ€æ±‚ï¼šè‡ªå®šä¹‰æ ¡éªŒæ³¨è§£
ä¸šåŠ¡é€»è¾‘ï¼šServiceå±‚é¢å¤–æ ¡éªŒ
```

**ğŸ”¹ æ ¡éªŒçš„æœ€ä½³å®è·µ**
```
å‰åç«¯åŒé‡æ ¡éªŒï¼šå‰ç«¯æå‡ä½“éªŒï¼Œåç«¯ä¿éšœå®‰å…¨
åˆç†çš„é”™è¯¯æç¤ºï¼šå…·ä½“æ˜ç¡®ï¼Œä¾¿äºç”¨æˆ·ç†è§£  
æ€§èƒ½è€ƒè™‘ï¼šé¿å…è¿‡åº¦å¤æ‚çš„æ ¡éªŒé€»è¾‘
å¯ç»´æŠ¤æ€§ï¼šæ ¡éªŒè§„åˆ™è¦æ¸…æ™°æ˜“æ‡‚
```

### 8.3 å®é™…åº”ç”¨ä»·å€¼


- **å¼€å‘æ•ˆç‡**ï¼šå‡å°‘æ‰‹å·¥ç¼–å†™æ ¡éªŒä»£ç çš„å·¥ä½œé‡
- **ä»£ç è´¨é‡**ï¼šç»Ÿä¸€çš„æ ¡éªŒæ ‡å‡†ï¼Œä»£ç æ›´è§„èŒƒ
- **ç”¨æˆ·ä½“éªŒ**ï¼šåŠæ—¶å‡†ç¡®çš„é”™è¯¯æç¤º
- **ç³»ç»Ÿå®‰å…¨**ï¼šå¤šå±‚æ¬¡çš„æ•°æ®å®‰å…¨é˜²æŠ¤
- **ç»´æŠ¤æˆæœ¬**ï¼šé›†ä¸­çš„æ ¡éªŒé€»è¾‘ï¼Œä¾¿äºåæœŸç»´æŠ¤

**æ ¸å¿ƒè®°å¿†**ï¼š
- æ•°æ®æ ¡éªŒæ˜¯ç³»ç»Ÿå®‰å…¨çš„ç¬¬ä¸€é“é˜²çº¿
- @Validå¤„ç†ç®€å•åœºæ™¯ï¼Œ@Validatedå¤„ç†å¤æ‚åœºæ™¯  
- åˆ†ç»„æ ¡éªŒè§£å†³ä¸åŒä¸šåŠ¡åœºæ™¯çš„æ ¡éªŒéœ€æ±‚
- è‡ªå®šä¹‰æ ¡éªŒæ»¡è¶³ç‰¹æ®Šä¸šåŠ¡è¦æ±‚
- ç»Ÿä¸€å¼‚å¸¸å¤„ç†æå‡ç”¨æˆ·ä½“éªŒ

**å­¦ä¹ å»ºè®®**ï¼š
1. å…ˆæŒæ¡å†…ç½®æ³¨è§£çš„ä½¿ç”¨
2. ç†è§£@Validå’Œ@Validatedçš„åŒºåˆ«
3. å­¦ä¼šè‡ªå®šä¹‰æ ¡éªŒæ³¨è§£
4. æŒæ¡åˆ†ç»„æ ¡éªŒçš„ä½¿ç”¨åœºæ™¯
5. å®ç°ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†æœºåˆ¶