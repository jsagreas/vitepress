---
title: 30ã€è‡ªå®šä¹‰åˆ†é¡µæŸ¥è¯¢
---
## ğŸ“š ç›®å½•

1. [åˆ†é¡µæŸ¥è¯¢åŸºç¡€æ¦‚å¿µ](#1-åˆ†é¡µæŸ¥è¯¢åŸºç¡€æ¦‚å¿µ)
2. [@Paramæ³¨è§£è¯¦è§£](#2-paramæ³¨è§£è¯¦è§£)
3. [IPageå‚æ•°ä¼ é€’æœºåˆ¶](#3-ipageå‚æ•°ä¼ é€’æœºåˆ¶)
4. [Mapperåˆ†é¡µæ–¹æ³•å®æˆ˜](#4-mapperåˆ†é¡µæ–¹æ³•å®æˆ˜)
5. [XMLåˆ†é¡µé…ç½®è¯¦è§£](#5-xmlåˆ†é¡µé…ç½®è¯¦è§£)
6. [è‡ªå®šä¹‰åˆ†é¡µSQLç¼–å†™](#6-è‡ªå®šä¹‰åˆ†é¡µsqlç¼–å†™)
7. [å¤æ‚åˆ†é¡µåœºæ™¯å¤„ç†](#7-å¤æ‚åˆ†é¡µåœºæ™¯å¤„ç†)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ åˆ†é¡µæŸ¥è¯¢åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯åˆ†é¡µæŸ¥è¯¢


**é€šä¿—ç†è§£**ï¼šå°±åƒç¿»ä¹¦ä¸€æ ·ï¼Œä¸€æ¬¡åªçœ‹ä¸€é¡µå†…å®¹

```
ç°å®åœºæ™¯ç±»æ¯”ï¼š

ğŸ“š çœ‹å°è¯´ï¼š
- ä¸€æœ¬500é¡µçš„ä¹¦ï¼Œä¸å¯èƒ½ä¸€æ¬¡çœ‹å®Œ
- æ¯æ¬¡ç¿»å¼€çœ‹10-20é¡µ
- è®°ä½å½“å‰é¡µç ï¼Œä¸‹æ¬¡æ¥ç€çœ‹

ğŸ’» æ•°æ®åˆ†é¡µï¼š
- æ•°æ®åº“æœ‰10ä¸‡æ¡æ•°æ®
- æ¯æ¬¡åªæŸ¥è¯¢10æ¡æ˜¾ç¤º
- ç”¨æˆ·ç‚¹å‡»"ä¸‹ä¸€é¡µ"ç»§ç»­åŠ è½½
```

**ä¸ºä»€ä¹ˆéœ€è¦åˆ†é¡µ**ï¼š
- ğŸš€ **æ€§èƒ½ä¼˜åŒ–**ï¼šä¸€æ¬¡æŸ¥è¯¢å…¨éƒ¨æ•°æ®ä¼šå¾ˆæ…¢
- ğŸ’¾ **èŠ‚çœå†…å­˜**ï¼šé¿å…ä¸€æ¬¡æ€§åŠ è½½å¤§é‡æ•°æ®åˆ°å†…å­˜
- ğŸ¨ **ç”¨æˆ·ä½“éªŒ**ï¼šé¡µé¢å±•ç¤ºæ›´å‹å¥½ï¼ŒåŠ è½½æ›´å¿«

### 1.2 åˆ†é¡µçš„æ ¸å¿ƒå‚æ•°


**å¿…é¡»ç†è§£çš„ä¸¤ä¸ªæ¦‚å¿µ**ï¼š

| å‚æ•°åç§° | **å«ä¹‰è¯´æ˜** | **ä¸¾ä¾‹** |
|---------|------------|---------|
| **é¡µç  (pageNo)** | `ç¬¬å‡ é¡µï¼Œä»1å¼€å§‹` | `ç¬¬3é¡µ` |
| **æ¯é¡µå¤§å° (pageSize)** | `æ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡æ•°æ®` | `æ¯é¡µ10æ¡` |

**è®¡ç®—å…¬å¼**ï¼š
```
æ•°æ®åº“æŸ¥è¯¢çš„èµ·å§‹ä½ç½® = (é¡µç  - 1) Ã— æ¯é¡µå¤§å°

ä¾‹å¦‚ï¼š
ç¬¬1é¡µï¼Œæ¯é¡µ10æ¡ï¼šèµ·å§‹ä½ç½® = (1-1) Ã— 10 = 0
ç¬¬3é¡µï¼Œæ¯é¡µ10æ¡ï¼šèµ·å§‹ä½ç½® = (3-1) Ã— 10 = 20
```

### 1.3 MyBatis-Plusåˆ†é¡µä¼˜åŠ¿


**ä¼ ç»Ÿåˆ†é¡µ vs MyBatis-Plusåˆ†é¡µ**

```
ä¼ ç»Ÿæ–¹å¼çš„ç—›ç‚¹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æ‰‹å†™SQLåˆ†é¡µè¯­å¥           â”‚
â”‚ 2. æ‰‹åŠ¨è®¡ç®—offset           â”‚
â”‚ 3. éœ€è¦é¢å¤–æŸ¥è¯¢æ€»è®°å½•æ•°      â”‚
â”‚ 4. ä¸åŒæ•°æ®åº“è¯­æ³•ä¸åŒ        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ å¤ªéº»çƒ¦äº†ï¼
         
MyBatis-Plusè‡ªåŠ¨å¸®ä½ æå®šï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… è‡ªåŠ¨æ‹¼æ¥åˆ†é¡µSQL           â”‚
â”‚ âœ… è‡ªåŠ¨è®¡ç®—offsetå’Œlimit     â”‚
â”‚ âœ… è‡ªåŠ¨æŸ¥è¯¢æ€»è®°å½•æ•°          â”‚
â”‚ âœ… è‡ªåŠ¨é€‚é…ä¸åŒæ•°æ®åº“        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ğŸ“ @Paramæ³¨è§£è¯¦è§£


### 2.1 @Paramæ³¨è§£æ˜¯ä»€ä¹ˆ


**ç®€å•ç†è§£**ï¼šç»™æ–¹æ³•å‚æ•°èµ·ä¸ª"å¤–å·"ï¼Œè®©XMLæ–‡ä»¶èƒ½è®¤è¯†å®ƒ

```java
// æ²¡ç”¨@Paramçš„æƒ…å†µ
User selectById(Long id);  
// XMLä¸­åªèƒ½ç”¨ #{arg0} æˆ– #{param1}ï¼Œä¸ç›´è§‚

// ä½¿ç”¨@Paramçš„æƒ…å†µ
User selectById(@Param("userId") Long id);
// XMLä¸­å¯ä»¥ç”¨ #{userId}ï¼Œæ¸…æ™°æ˜äº†ï¼
```

### 2.2 ä¸ºä»€ä¹ˆéœ€è¦@Param


**æ ¸å¿ƒåŸå› **ï¼šè®©å‚æ•°åç§°åœ¨XMLä¸­æœ‰æ„ä¹‰

```
æ²¡æœ‰@Paramçš„å°´å°¬ï¼š
æ–¹æ³•ï¼šselectUser(Long id, String name)
XMLï¼š#{arg0} å’Œ #{arg1} â† è°æ˜¯è°ï¼Ÿè®°ä¸ä½ï¼

æœ‰äº†@Paramçš„æ¸…çˆ½ï¼š
æ–¹æ³•ï¼šselectUser(@Param("id") Long id, @Param("name") String name)
XMLï¼š#{id} å’Œ #{name} â† ä¸€ç›®äº†ç„¶ï¼
```

### 2.3 @Paramåœ¨åˆ†é¡µä¸­çš„åº”ç”¨


**å®æˆ˜ç¤ºä¾‹**ï¼š

```java
public interface UserMapper extends BaseMapper<User> {
    
    /**
     * è‡ªå®šä¹‰åˆ†é¡µæŸ¥è¯¢ç”¨æˆ·
     * @param page åˆ†é¡µå¯¹è±¡ï¼ˆMyBatis-Plusæä¾›ï¼‰
     * @param userName ç”¨æˆ·åï¼ˆæˆ‘ä»¬è‡ªå®šä¹‰çš„å‚æ•°ï¼‰
     * @return åˆ†é¡µç»“æœ
     */
    IPage<User> selectUserPage(
        @Param("page") IPage<User> page,  // â† åˆ†é¡µå‚æ•°
        @Param("userName") String userName // â† æŸ¥è¯¢æ¡ä»¶
    );
}
```

**@Paramä½¿ç”¨è§„åˆ™**ï¼š

::: tip ğŸ’¡ ä½¿ç”¨å»ºè®®
- âœ… **å¤šä¸ªå‚æ•°**ï¼šå¿…é¡»ä½¿ç”¨@Param
- âœ… **å‚æ•°åæœ‰æ„ä¹‰**ï¼šæé«˜ä»£ç å¯è¯»æ€§
- âœ… **ä¸XMLä¿æŒä¸€è‡´**ï¼š#{xxx}è¦å’Œ@Param("xxx")å¯¹åº”
- âŒ **å•ä¸ªå‚æ•°**ï¼šå¯ä»¥ä¸ç”¨@Paramï¼ˆä½†å»ºè®®éƒ½ç”¨ï¼‰
:::

---

## 3. ğŸ”„ IPageå‚æ•°ä¼ é€’æœºåˆ¶


### 3.1 IPageæ˜¯ä»€ä¹ˆ


**é€šä¿—è§£é‡Š**ï¼šIPageå°±åƒä¸€ä¸ª"åˆ†é¡µå·¥å…·ç®±"

```
IPageåŒ…å«çš„ä¿¡æ¯ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“„ å½“å‰é¡µæ•°æ®         â”‚ â† recordsï¼ˆæ•°æ®åˆ—è¡¨ï¼‰
â”‚  ğŸ“Š æ€»è®°å½•æ•°           â”‚ â† totalï¼ˆä¸€å…±å¤šå°‘æ¡ï¼‰
â”‚  ğŸ”¢ å½“å‰é¡µç            â”‚ â† currentï¼ˆç¬¬å‡ é¡µï¼‰
â”‚  ğŸ“ æ¯é¡µå¤§å°           â”‚ â† sizeï¼ˆæ¯é¡µå‡ æ¡ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 IPageçš„ä½¿ç”¨æµç¨‹


**å®Œæ•´æµç¨‹å›¾ç¤º**ï¼š

```
Serviceå±‚                  Mapperå±‚                æ•°æ®åº“
   |                         |                       |
   |--[1]åˆ›å»ºIPageå¯¹è±¡------->|                       |
   |   new Page(1, 10)       |                       |
   |                         |                       |
   |--[2]è°ƒç”¨åˆ†é¡µæ–¹æ³•-------->|                       |
   |   selectUserPage()      |                       |
   |                         |                       |
   |                         |--[3]æ‰§è¡ŒSQL---------->|
   |                         |   SELECT * FROM...    |
   |                         |   LIMIT 0, 10         |
   |                         |                       |
   |                         |<--[4]è¿”å›æ•°æ®---------|
   |                         |                       |
   |<--[5]è¿”å›IPageå¯¹è±¡------|                       |
   |   (åŒ…å«æ•°æ®+åˆ†é¡µä¿¡æ¯)    |                       |
```

### 3.3 åˆ›å»ºIPageå¯¹è±¡


**ä¸¤ç§å¸¸ç”¨æ–¹å¼**ï¼š

```java
// æ–¹å¼1ï¼šä½¿ç”¨Pageæ„é€ å™¨ï¼ˆæœ€å¸¸ç”¨ï¼‰
IPage<User> page = new Page<>(1, 10);
// å‚æ•°1ï¼šå½“å‰é¡µç ï¼ˆä»1å¼€å§‹ï¼‰
// å‚æ•°2ï¼šæ¯é¡µå¤§å°

// æ–¹å¼2ï¼šé“¾å¼è°ƒç”¨ï¼ˆæ›´çµæ´»ï¼‰
IPage<User> page = new Page<User>()
    .setCurrent(1)      // è®¾ç½®å½“å‰é¡µ
    .setSize(10)        // è®¾ç½®æ¯é¡µå¤§å°
    .setSearchCount(true); // æ˜¯å¦æŸ¥è¯¢æ€»æ•°ï¼ˆé»˜è®¤trueï¼‰
```

**IPageæ ¸å¿ƒæ–¹æ³•ä¸€è§ˆ**ï¼š

| æ–¹æ³•å | **ä½œç”¨** | **ç¤ºä¾‹** |
|--------|---------|---------|
| `getCurrent()` | `è·å–å½“å‰é¡µç ` | `page.getCurrent()` |
| `getSize()` | `è·å–æ¯é¡µå¤§å°` | `page.getSize()` |
| `getTotal()` | `è·å–æ€»è®°å½•æ•°` | `page.getTotal()` |
| `getRecords()` | `è·å–å½“å‰é¡µæ•°æ®` | `page.getRecords()` |
| `getPages()` | `è·å–æ€»é¡µæ•°` | `page.getPages()` |

---

## 4. ğŸ› ï¸ Mapperåˆ†é¡µæ–¹æ³•å®æˆ˜


### 4.1 åŸºç¡€åˆ†é¡µæ–¹æ³•


**æœ€ç®€å•çš„åˆ†é¡µæŸ¥è¯¢**ï¼š

```java
public interface UserMapper extends BaseMapper<User> {
    
    // æ–¹å¼1ï¼šåªæœ‰åˆ†é¡µå‚æ•°
    IPage<User> selectUserPage(IPage<User> page);
    
    // æ–¹å¼2ï¼šåˆ†é¡µ + å•ä¸ªæ¡ä»¶
    IPage<User> selectByName(
        IPage<User> page, 
        @Param("name") String name
    );
    
    // æ–¹å¼3ï¼šåˆ†é¡µ + å¤šä¸ªæ¡ä»¶
    IPage<User> selectByCondition(
        IPage<User> page,
        @Param("name") String name,
        @Param("age") Integer age
    );
}
```

### 4.2 å‚æ•°ä¼ é€’çš„æ­£ç¡®å§¿åŠ¿


**é‡è¦æç¤º**ï¼šIPageå‚æ•°çš„ä½ç½®å¾ˆå…³é”®ï¼

```java
// âœ… æ­£ç¡®å†™æ³•ï¼šIPageæ”¾åœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä½ç½®
IPage<User> selectUserPage(
    IPage<User> page,           // â† åˆ†é¡µå‚æ•°åœ¨å‰
    @Param("name") String name  // â† ä¸šåŠ¡å‚æ•°åœ¨å
);

// âŒ é”™è¯¯å†™æ³•ï¼šIPageä¸åœ¨ç¬¬ä¸€ä¸ªä½ç½®
IPage<User> selectUserPage(
    @Param("name") String name, // â† ä¸šåŠ¡å‚æ•°åœ¨å‰
    IPage<User> page            // â† åˆ†é¡µå‚æ•°åœ¨åï¼ˆä¼šå‡ºé”™ï¼ï¼‰
);
```

::: warning âš ï¸ æ³¨æ„äº‹é¡¹
MyBatis-Plusçš„åˆ†é¡µæ’ä»¶ä¼šè‡ªåŠ¨è¯†åˆ«æ–¹æ³•ä¸­çš„**ç¬¬ä¸€ä¸ªIPageç±»å‹å‚æ•°**ä½œä¸ºåˆ†é¡µå¯¹è±¡ï¼Œæ‰€ä»¥IPageå¿…é¡»æ”¾åœ¨ç¬¬ä¸€ä¸ªä½ç½®ï¼
:::

### 4.3 Serviceå±‚è°ƒç”¨ç¤ºä¾‹


**å®Œæ•´çš„è°ƒç”¨æµç¨‹**ï¼š

```java
@Service
public class UserServiceImpl implements UserService {
    
    @Autowired
    private UserMapper userMapper;
    
    /**
     * åˆ†é¡µæŸ¥è¯¢ç”¨æˆ·
     */
    public IPage<User> getUserPage(Integer pageNo, Integer pageSize, String name) {
        // ç¬¬1æ­¥ï¼šåˆ›å»ºåˆ†é¡µå¯¹è±¡
        IPage<User> page = new Page<>(pageNo, pageSize);
        
        // ç¬¬2æ­¥ï¼šè°ƒç”¨Mapperæ–¹æ³•
        IPage<User> result = userMapper.selectByName(page, name);
        
        // ç¬¬3æ­¥ï¼šå¤„ç†ç»“æœ
        System.out.println("å½“å‰é¡µç ï¼š" + result.getCurrent());
        System.out.println("æ¯é¡µå¤§å°ï¼š" + result.getSize());
        System.out.println("æ€»è®°å½•æ•°ï¼š" + result.getTotal());
        System.out.println("æ€»é¡µæ•°ï¼š" + result.getPages());
        System.out.println("æ•°æ®åˆ—è¡¨ï¼š" + result.getRecords());
        
        return result;
    }
}
```

---

## 5. ğŸ“„ XMLåˆ†é¡µé…ç½®è¯¦è§£


### 5.1 XMLæ–‡ä»¶ä½ç½®å’Œå‘½å


**æ–‡ä»¶ç»“æ„**ï¼š
```
é¡¹ç›®ç»“æ„ï¼š
src/main/resources
  â””â”€â”€ mapper
      â””â”€â”€ UserMapper.xml  â† XMLæ–‡ä»¶åå’ŒMapperæ¥å£åä¸€è‡´
```

### 5.2 XMLåŸºç¡€é…ç½®


**å®Œæ•´çš„XMLé…ç½®ç¤ºä¾‹**ï¼š

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- namespaceè¦å’ŒMapperæ¥å£å…¨è·¯å¾„ä¸€è‡´ -->
<mapper namespace="com.example.mapper.UserMapper">
    
    <!-- åŸºç¡€åˆ†é¡µæŸ¥è¯¢ -->
    <select id="selectUserPage" resultType="com.example.entity.User">
        SELECT * FROM user
        <!-- MyBatis-Plusä¼šè‡ªåŠ¨åœ¨è¿™é‡Œæ·»åŠ  LIMIT è¯­å¥ -->
    </select>
    
</mapper>
```

### 5.3 å¸¦æ¡ä»¶çš„åˆ†é¡µæŸ¥è¯¢


**åŠ¨æ€SQLå®æˆ˜**ï¼š

```xml
<select id="selectByName" resultType="com.example.entity.User">
    SELECT * FROM user
    WHERE 1=1
    <!-- ä½¿ç”¨@Paramæ³¨è§£æŒ‡å®šçš„å‚æ•°å -->
    <if test="name != null and name != ''">
        AND user_name LIKE CONCAT('%', #{name}, '%')
    </if>
    ORDER BY create_time DESC
    <!-- åˆ†é¡µæ’ä»¶ä¼šè‡ªåŠ¨æ‹¼æ¥ï¼šLIMIT #{offset}, #{size} -->
</select>
```

**å‚æ•°ä½¿ç”¨è¯´æ˜**ï¼š

| XMLä¸­çš„å†™æ³• | **å¯¹åº”Javaæ–¹æ³•** | **è¯´æ˜** |
|------------|-----------------|---------|
| `#{name}` | `@Param("name") String name` | `è·å–nameå‚æ•°çš„å€¼` |
| `#{page.current}` | `IPage<User> page` | `è·å–å½“å‰é¡µç ` |
| `#{page.size}` | `IPage<User> page` | `è·å–æ¯é¡µå¤§å°` |

---

## 6. âœï¸ è‡ªå®šä¹‰åˆ†é¡µSQLç¼–å†™


### 6.1 å¤æ‚æŸ¥è¯¢åˆ†é¡µ


**å¤šè¡¨å…³è”åˆ†é¡µç¤ºä¾‹**ï¼š

```java
// Mapperæ¥å£
public interface UserMapper extends BaseMapper<User> {
    
    /**
     * åˆ†é¡µæŸ¥è¯¢ç”¨æˆ·åŠå…¶è®¢å•ä¿¡æ¯
     */
    IPage<UserOrderVO> selectUserWithOrders(
        IPage<UserOrderVO> page,
        @Param("userName") String userName,
        @Param("startDate") LocalDateTime startDate
    );
}
```

```xml
<!-- UserMapper.xml -->
<select id="selectUserWithOrders" resultType="com.example.vo.UserOrderVO">
    SELECT 
        u.id,
        u.user_name,
        u.email,
        COUNT(o.id) as order_count,
        SUM(o.amount) as total_amount
    FROM user u
    LEFT JOIN orders o ON u.id = o.user_id
    WHERE 1=1
    
    <!-- åŠ¨æ€æ¡ä»¶ -->
    <if test="userName != null and userName != ''">
        AND u.user_name LIKE CONCAT('%', #{userName}, '%')
    </if>
    
    <if test="startDate != null">
        AND o.create_time >= #{startDate}
    </if>
    
    GROUP BY u.id, u.user_name, u.email
    ORDER BY total_amount DESC
    
    <!-- åˆ†é¡µè‡ªåŠ¨æ‹¼æ¥åœ¨è¿™é‡Œ -->
</select>
```

### 6.2 è‡ªå®šä¹‰COUNTæŸ¥è¯¢


**ä¸ºä»€ä¹ˆéœ€è¦è‡ªå®šä¹‰COUNT**ï¼š

```
é»˜è®¤COUNTçš„é—®é¢˜ï¼š
SELECT COUNT(*) FROM (
  SELECT u.*, COUNT(o.id)... 
  FROM user u LEFT JOIN orders o...
  GROUP BY u.id
) â† å­æŸ¥è¯¢COUNTï¼Œæ€§èƒ½å·®ï¼

ä¼˜åŒ–åçš„COUNTï¼š
SELECT COUNT(DISTINCT u.id) 
FROM user u LEFT JOIN orders o...
WHERE... â† ç›´æ¥COUNTï¼Œæ€§èƒ½å¥½ï¼
```

**å®ç°æ–¹å¼**ï¼š

```java
// Mapperæ¥å£
@Select("SELECT COUNT(DISTINCT u.id) FROM user u LEFT JOIN orders o ON u.id = o.user_id WHERE u.user_name LIKE CONCAT('%', #{userName}, '%')")
Long countUserWithOrders(@Param("userName") String userName);

// æˆ–è€…åœ¨XMLä¸­é…ç½®
```

```xml
<!-- è‡ªå®šä¹‰COUNTæŸ¥è¯¢ -->
<select id="countUserWithOrders" resultType="java.lang.Long">
    SELECT COUNT(DISTINCT u.id)
    FROM user u
    LEFT JOIN orders o ON u.id = o.user_id
    WHERE 1=1
    <if test="userName != null and userName != ''">
        AND u.user_name LIKE CONCAT('%', #{userName}, '%')
    </if>
</select>
```

### 6.3 ç¦ç”¨è‡ªåŠ¨COUNT


**åœºæ™¯**ï¼šæœ‰æ—¶å€™ä¸éœ€è¦æŸ¥è¯¢æ€»æ•°ï¼Œæå‡æ€§èƒ½

```java
// æ–¹å¼1ï¼šåœ¨åˆ›å»ºPageæ—¶ç¦ç”¨
IPage<User> page = new Page<User>(1, 10)
    .setSearchCount(false); // â† ä¸æŸ¥è¯¢æ€»æ•°

// æ–¹å¼2ï¼šåœ¨XMLä¸­ä½¿ç”¨ç‰¹æ®Šæ³¨è§£ï¼ˆMyBatis-Plus 3.4.0+ï¼‰
```

```xml
<select id="selectUserPage" resultType="User">
    <!-- å‘Šè¯‰æ’ä»¶ä¸è¦è‡ªåŠ¨COUNT -->
    SELECT * FROM user
    WHERE status = 1
</select>
```

---

## 7. ğŸ¨ å¤æ‚åˆ†é¡µåœºæ™¯å¤„ç†


### 7.1 åˆ†é¡µç»“æœè½¬æ¢


**åœºæ™¯**ï¼šæŸ¥è¯¢å‡ºçš„å®ä½“éœ€è¦è½¬æ¢æˆVOå¯¹è±¡

```java
@Service
public class UserServiceImpl implements UserService {
    
    public IPage<UserVO> getUserVOPage(Integer pageNo, Integer pageSize) {
        // ç¬¬1æ­¥ï¼šåˆ†é¡µæŸ¥è¯¢å®ä½“
        IPage<User> userPage = new Page<>(pageNo, pageSize);
        userPage = userMapper.selectPage(userPage, null);
        
        // ç¬¬2æ­¥ï¼šè½¬æ¢æˆVOå¯¹è±¡
        IPage<UserVO> voPage = userPage.convert(user -> {
            UserVO vo = new UserVO();
            vo.setId(user.getId());
            vo.setName(user.getUserName());
            vo.setEmail(user.getEmail());
            // å¯ä»¥æ·»åŠ é¢å¤–çš„ä¸šåŠ¡é€»è¾‘
            return vo;
        });
        
        return voPage;
    }
}
```

**convertæ–¹æ³•çš„å¥½å¤„**ï¼š
- âœ… ä¿ç•™åˆ†é¡µä¿¡æ¯ï¼ˆæ€»æ•°ã€é¡µç ç­‰ï¼‰
- âœ… åªè½¬æ¢æ•°æ®åˆ—è¡¨
- âœ… æ”¯æŒLambdaè¡¨è¾¾å¼ï¼Œä»£ç ç®€æ´

### 7.2 å¤šæ¡ä»¶åŠ¨æ€åˆ†é¡µ


**çµæ´»çš„æ¡ä»¶æ„é€ **ï¼š

```java
public IPage<User> searchUsers(UserSearchDTO searchDTO) {
    // åˆ›å»ºåˆ†é¡µå¯¹è±¡
    IPage<User> page = new Page<>(
        searchDTO.getPageNo(), 
        searchDTO.getPageSize()
    );
    
    // æ„å»ºæŸ¥è¯¢æ¡ä»¶
    QueryWrapper<User> wrapper = new QueryWrapper<>();
    
    // åŠ¨æ€æ·»åŠ æ¡ä»¶
    wrapper.like(StrUtil.isNotBlank(searchDTO.getName()), 
                 "user_name", searchDTO.getName())
           .eq(searchDTO.getStatus() != null, 
               "status", searchDTO.getStatus())
           .between(searchDTO.getStartDate() != null && 
                   searchDTO.getEndDate() != null,
                   "create_time", 
                   searchDTO.getStartDate(), 
                   searchDTO.getEndDate())
           .orderByDesc("create_time");
    
    return userMapper.selectPage(page, wrapper);
}
```

### 7.3 åˆ†é¡µæ€§èƒ½ä¼˜åŒ–


**ä¼˜åŒ–ç­–ç•¥å¯¹æ¯”**ï¼š

| ä¼˜åŒ–æ–¹å¼ | **å®ç°æ–¹æ³•** | **é€‚ç”¨åœºæ™¯** |
|---------|------------|------------|
| **ç¦ç”¨COUNT** | `setSearchCount(false)` | `ä¸éœ€è¦æ€»æ•°çš„åœºæ™¯` |
| **å»¶è¿ŸCOUNT** | `ç¬¬ä¸€æ¬¡æŸ¥è¯¢åç¼“å­˜æ€»æ•°` | `æ¡ä»¶ä¸å˜çš„è¿ç»­åˆ†é¡µ` |
| **è¦†ç›–ç´¢å¼•** | `SELECTåªæŸ¥è¯¢ç´¢å¼•åˆ—` | `å¤§æ•°æ®é‡æŸ¥è¯¢` |
| **æ¸¸æ ‡åˆ†é¡µ** | `ä½¿ç”¨ä¸Šä¸€é¡µçš„æœ€åID` | `æ— é™æ»šåŠ¨åŠ è½½` |

**æ¸¸æ ‡åˆ†é¡µç¤ºä¾‹**ï¼š

```java
// ä¸ç”¨é¡µç ï¼Œç”¨æœ€åä¸€æ¡è®°å½•çš„ID
public List<User> loadMore(Long lastId, Integer size) {
    QueryWrapper<User> wrapper = new QueryWrapper<>();
    wrapper.gt(lastId != null, "id", lastId)
           .orderByAsc("id")
           .last("LIMIT " + size);
    
    return userMapper.selectList(wrapper);
}
```

### 7.4 åˆ†é¡µæ•°æ®å¯¼å‡º


**åœºæ™¯**ï¼šå¯¼å‡ºå¤§é‡æ•°æ®æ—¶çš„åˆ†é¡µå¤„ç†

```java
public void exportAllUsers() {
    int pageSize = 1000; // æ¯æ¬¡æŸ¥è¯¢1000æ¡
    int pageNo = 1;
    
    while (true) {
        // åˆ†é¡µæŸ¥è¯¢
        IPage<User> page = new Page<>(pageNo, pageSize);
        page = userMapper.selectPage(page, null);
        
        // å¤„ç†å½“å‰é¡µæ•°æ®
        List<User> records = page.getRecords();
        if (records.isEmpty()) {
            break; // æ²¡æ•°æ®äº†ï¼Œç»“æŸå¾ªç¯
        }
        
        // å†™å…¥Excelæˆ–å…¶ä»–æ“ä½œ
        writeToExcel(records);
        
        // ä¸‹ä¸€é¡µ
        pageNo++;
        
        // å·²ç»æ˜¯æœ€åä¸€é¡µï¼Œç»“æŸ
        if (pageNo > page.getPages()) {
            break;
        }
    }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ åˆ†é¡µåŸºç¡€ï¼šé¡µç ã€æ¯é¡µå¤§å°ã€æ€»è®°å½•æ•°ä¸‰è¦ç´ 
ğŸ”¸ @Paramæ³¨è§£ï¼šç»™å‚æ•°èµ·åï¼Œè®©XMLèƒ½è¯†åˆ«
ğŸ”¸ IPageå¯¹è±¡ï¼šMyBatis-Plusçš„åˆ†é¡µå·¥å…·ç®±
ğŸ”¸ å‚æ•°ä½ç½®ï¼šIPageå¿…é¡»æ”¾åœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä½ç½®
ğŸ”¸ è‡ªåŠ¨åˆ†é¡µï¼šæ’ä»¶è‡ªåŠ¨æ‹¼æ¥LIMITè¯­å¥
ğŸ”¸ ç»“æœè½¬æ¢ï¼šä½¿ç”¨convert()æ–¹æ³•è½¬æ¢VO
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ åˆ†é¡µæŸ¥è¯¢çš„å®Œæ•´æµç¨‹**
```
Serviceåˆ›å»ºIPage â†’ Mapperæ¥æ”¶IPage â†’ XMLç¼–å†™SQL â†’ 
æ’ä»¶è‡ªåŠ¨æ‹¼æ¥LIMIT â†’ è¿”å›åˆ†é¡µç»“æœ â†’ Serviceå¤„ç†æ•°æ®
```

**ğŸ”¹ å‚æ•°ä¼ é€’çš„è§„åˆ™**
```
å¿…é¡»è§„åˆ™ï¼š
- IPageæ”¾ç¬¬ä¸€ä¸ªå‚æ•°ä½ç½®
- å…¶ä»–å‚æ•°ç”¨@Paramæ³¨è§£
- XMLä¸­ä½¿ç”¨#{paramName}è·å–å€¼

å¯é€‰ä¼˜åŒ–ï¼š
- ç¦ç”¨COUNTæå‡æ€§èƒ½
- è‡ªå®šä¹‰COUNTä¼˜åŒ–æŸ¥è¯¢
- ä½¿ç”¨convertè½¬æ¢ç»“æœ
```

**ğŸ”¹ å¸¸è§é”™è¯¯é¿å…**
```
âŒ IPageä¸åœ¨ç¬¬ä¸€ä¸ªä½ç½® â†’ åˆ†é¡µå¤±æ•ˆ
âŒ å¿˜è®°@Paramæ³¨è§£ â†’ XMLè·å–ä¸åˆ°å‚æ•°
âŒ XMLçš„namespaceå†™é”™ â†’ æ‰¾ä¸åˆ°æ–¹æ³•
âŒ resultTypeè·¯å¾„é”™è¯¯ â†’ æ•°æ®æ˜ å°„å¤±è´¥
```

### 8.3 å®æˆ˜åº”ç”¨æŒ‡å—


**ğŸ“ å­¦ä¹ æ£€æŸ¥ç‚¹**
- [ ] ç†è§£åˆ†é¡µçš„åŸºæœ¬æ¦‚å¿µå’ŒåŸç†
- [ ] æŒæ¡@Paramæ³¨è§£çš„ä½¿ç”¨åœºæ™¯
- [ ] ç†Ÿç»ƒåˆ›å»ºå’Œä½¿ç”¨IPageå¯¹è±¡
- [ ] èƒ½å¤Ÿç¼–å†™Mapperåˆ†é¡µæ–¹æ³•
- [ ] ä¼šé…ç½®XMLåˆ†é¡µæŸ¥è¯¢
- [ ] æŒæ¡å¤æ‚åœºæ™¯çš„åˆ†é¡µå¤„ç†

**ğŸš€ å¿«é€Ÿä¸Šæ‰‹æ­¥éª¤**
1ï¸âƒ£ ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºIPageå¯¹è±¡æŒ‡å®šé¡µç å’Œå¤§å°
2ï¸âƒ£ ç¬¬äºŒæ­¥ï¼šè°ƒç”¨Mapperçš„åˆ†é¡µæ–¹æ³•
3ï¸âƒ£ ç¬¬ä¸‰æ­¥ï¼šä»IPageä¸­è·å–æ•°æ®å’Œåˆ†é¡µä¿¡æ¯

**ğŸ’¡ å…³é”®è®°å¿†å£è¯€**
> IPageæ”¾ç¬¬ä¸€ï¼Œ@Paramç»™åå­—
> XMLå†™SQLï¼Œæ’ä»¶è‡ªåŠ¨limit
> convertè½¬ç»“æœï¼Œåˆ†é¡µå¾ˆå®¹æ˜“

### 8.4 æ€§èƒ½ä¼˜åŒ–å»ºè®®


**ä¼˜åŒ–ç­–ç•¥**ï¼š
- ğŸ¯ **æ•°æ®é‡å°**ï¼šç›´æ¥åˆ†é¡µå³å¯
- ğŸ¯ **æ•°æ®é‡å¤§**ï¼šç¦ç”¨COUNTæˆ–å»¶è¿ŸCOUNT
- ğŸ¯ **å¯¼å‡ºåœºæ™¯**ï¼šåˆ†æ‰¹æŸ¥è¯¢ï¼Œé¿å…å†…å­˜æº¢å‡º
- ğŸ¯ **æ— é™æ»šåŠ¨**ï¼šä½¿ç”¨æ¸¸æ ‡åˆ†é¡µæ›¿ä»£é¡µç åˆ†é¡µ

**æœ€ä½³å®è·µ**ï¼š
```java
// âœ… æ¨èå†™æ³•ï¼šæ¸…æ™°æ˜äº†
IPage<User> page = new Page<>(pageNo, pageSize);
IPage<UserVO> result = userMapper.selectUserPage(page, condition)
    .convert(user -> {
        // è½¬æ¢é€»è¾‘
        return vo;
    });

// âœ… æ€§èƒ½ä¼˜åŒ–ï¼šä¸éœ€è¦æ€»æ•°æ—¶
page.setSearchCount(false);

// âœ… å¤§æ•°æ®å¯¼å‡ºï¼šåˆ†æ‰¹å¤„ç†
while (hasMore) {
    IPage<User> batchPage = userMapper.selectPage(page, null);
    processBatch(batchPage.getRecords());
    pageNo++;
}
```

---

**å­¦ä¹ å»ºè®®**ï¼š
1. å…ˆç†è§£åˆ†é¡µçš„åŸºæœ¬æ¦‚å¿µï¼Œæƒ³è±¡æˆç¿»ä¹¦çš„è¿‡ç¨‹
2. åŠ¨æ‰‹å®è·µæœ€é‡è¦ï¼Œå†™ä¸€ä¸ªç®€å•çš„åˆ†é¡µåŠŸèƒ½
3. é€æ­¥å°è¯•å¤æ‚åœºæ™¯ï¼Œå¦‚å¤šè¡¨å…³è”ã€åŠ¨æ€æ¡ä»¶ç­‰
4. é‡åˆ°é—®é¢˜æŸ¥çœ‹MyBatis-Pluså®˜æ–¹æ–‡æ¡£

**å¸¸è§é—®é¢˜è‡ªæŸ¥**ï¼š
- åˆ†é¡µä¸ç”Ÿæ•ˆ â†’ æ£€æŸ¥IPageå‚æ•°ä½ç½®
- è·å–ä¸åˆ°å‚æ•° â†’ æ£€æŸ¥@Paramæ³¨è§£
- æ€»æ•°ä¸å‡†ç¡® â†’ æ£€æŸ¥COUNTçš„SQLé€»è¾‘
- æ€§èƒ½æ…¢ â†’ è€ƒè™‘ç¦ç”¨COUNTæˆ–ä¼˜åŒ–ç´¢å¼•

**ä¸‹ä¸€æ­¥å­¦ä¹ **ï¼š
- æ·±å…¥å­¦ä¹ MyBatis-Plusçš„æ¡ä»¶æ„é€ å™¨
- äº†è§£æ•°æ®åº“ç´¢å¼•å¯¹åˆ†é¡µçš„å½±å“
- å­¦ä¹ å‰ç«¯åˆ†é¡µç»„ä»¶çš„å¯¹æ¥æ–¹å¼