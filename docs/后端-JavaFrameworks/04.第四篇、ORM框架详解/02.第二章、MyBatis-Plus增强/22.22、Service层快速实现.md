---
title: 22ã€Serviceå±‚å¿«é€Ÿå®ç°
---
## ğŸ“š ç›®å½•

1. [Serviceå±‚å¢å¼ºæ¦‚è¿°](#1-serviceå±‚å¢å¼ºæ¦‚è¿°)
2. [IServiceæ¥å£è¯¦è§£](#2-iserviceæ¥å£è¯¦è§£)
3. [ServiceImplåŸºç±»ä½¿ç”¨](#3-serviceimplåŸºç±»ä½¿ç”¨)
4. [é€šç”¨CRUDæ–¹æ³•](#4-é€šç”¨crudæ–¹æ³•)
5. [æ‰¹é‡æ“ä½œè¯¦è§£](#5-æ‰¹é‡æ“ä½œè¯¦è§£)
6. [ä¸šåŠ¡é€»è¾‘å°è£…æœ€ä½³å®è·µ](#6-ä¸šåŠ¡é€»è¾‘å°è£…æœ€ä½³å®è·µ)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ Serviceå±‚å¢å¼ºæ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯Serviceå±‚


**é€šä¿—ç†è§£**ï¼šServiceå±‚å°±åƒæ˜¯"ä¸šåŠ¡ç®¡å®¶"
```
æƒ³è±¡ä¸€ä¸ªé¤å…ï¼š
- Mapperå±‚ = å¨æˆ¿ï¼ˆåªè´Ÿè´£åšèœï¼‰
- Serviceå±‚ = æœåŠ¡å‘˜ï¼ˆåè°ƒç‚¹é¤ã€ä¸Šèœã€ç»“è´¦ç­‰ä¸šåŠ¡æµç¨‹ï¼‰
- Controllerå±‚ = æ”¶é“¶å°ï¼ˆæ¥å¾…å®¢æˆ·ï¼‰

Serviceå±‚çš„ä½œç”¨ï¼š
æŠŠå¤šä¸ªç®€å•æ“ä½œç»„åˆæˆå®Œæ•´çš„ä¸šåŠ¡åŠŸèƒ½
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦Serviceå±‚å¢å¼º


**ä¼ ç»Ÿå¼€å‘çš„ç—›ç‚¹**ï¼š
```
âŒ ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜ï¼š
- æ¯ä¸ªServiceéƒ½è¦å†™å¤§é‡é‡å¤çš„å¢åˆ æ”¹æŸ¥ä»£ç 
- æ‰¹é‡æ“ä½œéœ€è¦è‡ªå·±å†™å¾ªç¯å’Œäº‹åŠ¡æ§åˆ¶
- ç®€å•çš„ä¸šåŠ¡é€»è¾‘ä¹Ÿè¦å†™å¾ˆå¤šæ¨¡æ¿ä»£ç 

âœ… MyBatis-Pluså¢å¼ºåï¼š
- æä¾›äº†60å¤šä¸ªå¸¸ç”¨æ–¹æ³•ï¼Œå¼€ç®±å³ç”¨
- è‡ªåŠ¨å¤„ç†æ‰¹é‡æ“ä½œå’Œäº‹åŠ¡
- åªéœ€è¦å…³æ³¨çœŸæ­£çš„ä¸šåŠ¡é€»è¾‘
```

### 1.3 Serviceå±‚å¢å¼ºæ¶æ„


**ä¸‰å±‚ç»“æ„å›¾**ï¼š
```
Controllerå±‚ (æ§åˆ¶å™¨)
    â†“ è°ƒç”¨
Serviceæ¥å£ (IService<User>)
    â†“ å®ç°
Serviceå®ç°ç±» (extends ServiceImpl<UserMapper, User>)
    â†“ ä½¿ç”¨
Mapperå±‚ (BaseMapper<User>)
    â†“ æ“ä½œ
æ•°æ®åº“
```

---

## 2. ğŸ“‹ IServiceæ¥å£è¯¦è§£


### 2.1 IServiceæ¥å£æ˜¯ä»€ä¹ˆ


**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
```
IServiceæ˜¯MyBatis-Plusæä¾›çš„é€šç”¨Serviceæ¥å£
å°±åƒæ˜¯ä¸€ä¸ª"å·¥å…·ç®±"ï¼Œé‡Œé¢é¢„è£…äº†å„ç§å¸¸ç”¨å·¥å…·

ç±»æ¯”ç†è§£ï¼š
æ™®é€šå·¥å…·ç®±ï¼šåªæœ‰åŸºæœ¬çš„é”¤å­ã€èºä¸åˆ€
IServiceå·¥å…·ç®±ï¼šæœ‰60å¤šç§å¸¸ç”¨å·¥å…·ï¼Œåº”æœ‰å°½æœ‰
```

### 2.2 IServiceæ¥å£å®šä¹‰


**åŸºæœ¬ä½¿ç”¨**ï¼š
```java
// 1. å®šä¹‰Serviceæ¥å£ï¼ˆåªéœ€ä¸€è¡Œä»£ç ï¼ï¼‰
public interface UserService extends IService<User> {
    // è‡ªåŠ¨ç»§æ‰¿60å¤šä¸ªæ–¹æ³•ï¼Œæ— éœ€ç¼–å†™
}

// Useræ˜¯ä½ çš„å®ä½“ç±»
// IService<User>ä¸­çš„Useræ˜¯æ³›å‹ï¼ŒæŒ‡å®šæ“ä½œçš„å®ä½“ç±»å‹
```

**å¯¹æ¯”ä¼ ç»Ÿæ–¹å¼**ï¼š
```java
// âŒ ä¼ ç»Ÿæ–¹å¼ï¼šéœ€è¦è‡ªå·±å®šä¹‰æ‰€æœ‰æ–¹æ³•
public interface UserService {
    User getById(Long id);
    List<User> listAll();
    boolean save(User user);
    boolean updateById(User user);
    boolean removeById(Long id);
    // ... è¿˜æœ‰å‡ åä¸ªæ–¹æ³•è¦å†™
}

// âœ… MyBatis-Plusæ–¹å¼ï¼šä¸€è¡Œæå®š
public interface UserService extends IService<User> {
    // å·²ç»æœ‰æ‰€æœ‰æ–¹æ³•äº†ï¼
}
```

### 2.3 IServiceæä¾›çš„æ ¸å¿ƒæ–¹æ³•åˆ†ç±»


| æ–¹æ³•ç±»å‹ | **å…¸å‹æ–¹æ³•** | **ä½œç”¨è¯´æ˜** | **ä½¿ç”¨åœºæ™¯** |
|---------|------------|-------------|-------------|
| ğŸ” **æŸ¥è¯¢å•ä¸ª** | `getById()` | æ ¹æ®IDæŸ¥è¯¢ | æŸ¥çœ‹ç”¨æˆ·è¯¦æƒ… |
| ğŸ“‹ **æŸ¥è¯¢åˆ—è¡¨** | `list()` | æŸ¥è¯¢æ‰€æœ‰è®°å½• | ç”¨æˆ·åˆ—è¡¨å±•ç¤º |
| ğŸ’¾ **ä¿å­˜æ•°æ®** | `save()` | æ’å…¥ä¸€æ¡è®°å½• | ç”¨æˆ·æ³¨å†Œ |
| ğŸ“¦ **æ‰¹é‡ä¿å­˜** | `saveBatch()` | æ‰¹é‡æ’å…¥ | æ‰¹é‡å¯¼å…¥ç”¨æˆ· |
| âœï¸ **æ›´æ–°æ•°æ®** | `updateById()` | æ ¹æ®IDæ›´æ–° | ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ |
| ğŸ—‘ï¸ **åˆ é™¤æ•°æ®** | `removeById()` | æ ¹æ®IDåˆ é™¤ | åˆ é™¤ç”¨æˆ· |
| ğŸ”„ **ä¿å­˜æˆ–æ›´æ–°** | `saveOrUpdate()` | æ™ºèƒ½åˆ¤æ–­ | è¡¨å•æäº¤ |

---

## 3. ğŸ—ï¸ ServiceImplåŸºç±»ä½¿ç”¨


### 3.1 ServiceImplæ˜¯ä»€ä¹ˆ


**é€šä¿—è§£é‡Š**ï¼š
```
ServiceImplå°±åƒæ˜¯ä¸€ä¸ª"å·²è£…ä¿®å¥½çš„æ¯›å¯æˆ¿"
- åŸºç¡€è®¾æ–½éƒ½æœ‰äº†ï¼ˆæ°´ç”µã€å¢™é¢ï¼‰
- ä½ åªéœ€è¦æ·»åŠ å®¶å…·ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰å°±èƒ½ä½

å…·ä½“æ¥è¯´ï¼š
- ServiceImplå®ç°äº†IServiceçš„æ‰€æœ‰60å¤šä¸ªæ–¹æ³•
- ä½ çš„Serviceå®ç°ç±»ç»§æ‰¿å®ƒï¼Œå°±è‡ªåŠ¨æ‹¥æœ‰è¿™äº›æ–¹æ³•
- ä½ åªéœ€è¦å†™è‡ªå·±ç‰¹æ®Šçš„ä¸šåŠ¡é€»è¾‘
```

### 3.2 ServiceImplåŸºæœ¬ä½¿ç”¨


**å®ç°Serviceæ¥å£**ï¼š
```java
// 1. Serviceæ¥å£
public interface UserService extends IService<User> {
    // ç»§æ‰¿IServiceï¼Œè·å¾—é€šç”¨æ–¹æ³•
}

// 2. Serviceå®ç°ç±»ï¼ˆé‡ç‚¹ï¼ï¼‰
@Service
public class UserServiceImpl 
    extends ServiceImpl<UserMapper, User> 
    implements UserService {
    
    // ç»§æ‰¿ServiceImplåï¼š
    // - è‡ªåŠ¨å®ç°äº†UserServiceçš„æ‰€æœ‰æ–¹æ³•
    // - è‡ªåŠ¨æ³¨å…¥äº†UserMapper
    // - å¯ä»¥ç›´æ¥ä½¿ç”¨baseMapperæ“ä½œæ•°æ®åº“
}
```

**å‚æ•°è¯´æ˜å›¾è§£**ï¼š
```
ServiceImpl<UserMapper, User>
            â†‘          â†‘
            |          |
         Mapperç±»   å®ä½“ç±»
         
ç»§æ‰¿å…³ç³»ï¼š
UserServiceImpl â†’ ServiceImpl â†’ IService
```

### 3.3 å®é™…å¼€å‘ç¤ºä¾‹


**å®Œæ•´çš„Serviceå±‚ä»£ç **ï¼š
```java
// å®ä½“ç±»
public class User {
    private Long id;
    private String name;
    private Integer age;
    private String email;
}

// Mapperæ¥å£
public interface UserMapper extends BaseMapper<User> {
}

// Serviceæ¥å£
public interface UserService extends IService<User> {
    // å¯ä»¥æ·»åŠ è‡ªå®šä¹‰æ–¹æ³•
    User findByEmail(String email);
}

// Serviceå®ç°ç±»
@Service
public class UserServiceImpl 
    extends ServiceImpl<UserMapper, User> 
    implements UserService {
    
    // å®ç°è‡ªå®šä¹‰æ–¹æ³•
    @Override
    public User findByEmail(String email) {
        // ä½¿ç”¨ç»§æ‰¿æ¥çš„æ–¹æ³•
        return this.getOne(
            new QueryWrapper<User>()
                .eq("email", email)
        );
    }
}
```

---

## 4. ğŸ”§ é€šç”¨CRUDæ–¹æ³•


### 4.1 ä¿å­˜æ–¹æ³•è¯¦è§£


**save - ä¿å­˜å•æ¡è®°å½•**ï¼š
```java
// åˆ›å»ºç”¨æˆ·å¯¹è±¡
User user = new User();
user.setName("å¼ ä¸‰");
user.setAge(25);
user.setEmail("zhangsan@qq.com");

// ä¿å­˜åˆ°æ•°æ®åº“ï¼ˆä¸€è¡Œä»£ç æå®šï¼ï¼‰
boolean success = userService.save(user);

// ä¿å­˜åï¼Œuserå¯¹è±¡çš„idä¼šè‡ªåŠ¨å¡«å……
System.out.println("æ–°ç”¨æˆ·IDï¼š" + user.getId());
```

**saveOrUpdate - æ™ºèƒ½ä¿å­˜æˆ–æ›´æ–°**ï¼š
```java
User user = new User();
user.setId(1L);  // æœ‰ID
user.setName("æå››");

// è‡ªåŠ¨åˆ¤æ–­ï¼š
// - å¦‚æœIDå­˜åœ¨ä¸”æ•°æ®åº“æœ‰è®°å½• â†’ æ‰§è¡Œæ›´æ–°
// - å¦‚æœIDä¸å­˜åœ¨æˆ–æ•°æ®åº“æ— è®°å½• â†’ æ‰§è¡Œæ’å…¥
userService.saveOrUpdate(user);

ğŸ’¡ é€‚ç”¨åœºæ™¯ï¼šè¡¨å•æäº¤ï¼Œä¸ç¡®å®šæ˜¯æ–°å¢è¿˜æ˜¯ä¿®æ”¹
```

### 4.2 æŸ¥è¯¢æ–¹æ³•è¯¦è§£


**getById - æ ¹æ®IDæŸ¥è¯¢**ï¼š
```java
// æŸ¥è¯¢IDä¸º1çš„ç”¨æˆ·
User user = userService.getById(1L);

// å¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›nullï¼ˆä¸ä¼šæŠ¥é”™ï¼‰
if (user != null) {
    System.out.println("ç”¨æˆ·åï¼š" + user.getName());
}
```

**list - æŸ¥è¯¢æ‰€æœ‰**ï¼š
```java
// æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·
List<User> userList = userService.list();

// æ¡ä»¶æŸ¥è¯¢
List<User> adults = userService.list(
    new QueryWrapper<User>().ge("age", 18)  // å¹´é¾„>=18
);
```

**getOne - æŸ¥è¯¢å•æ¡**ï¼š
```java
// æŸ¥è¯¢é‚®ç®±ä¸ºxxxçš„ç”¨æˆ·ï¼ˆé¢„æœŸåªæœ‰ä¸€ä¸ªï¼‰
User user = userService.getOne(
    new QueryWrapper<User>().eq("email", "zhangsan@qq.com")
);

âš ï¸ æ³¨æ„ï¼šå¦‚æœæŸ¥å‡ºå¤šæ¡ï¼Œä¼šæŠ¥é”™ï¼
å¦‚æœå¯èƒ½æœ‰å¤šæ¡ï¼Œåº”è¯¥ç”¨list()
```

### 4.3 æ›´æ–°æ–¹æ³•è¯¦è§£


**updateById - æ ¹æ®IDæ›´æ–°**ï¼š
```java
User user = new User();
user.setId(1L);
user.setName("ç‹äº”");
user.setAge(30);

// åªæ›´æ–°è®¾ç½®äº†å€¼çš„å­—æ®µ
boolean success = userService.updateById(user);

æ‰§è¡Œçš„SQLï¼š
UPDATE user SET name='ç‹äº”', age=30 WHERE id=1
```

**update - æ¡ä»¶æ›´æ–°**ï¼š
```java
// å°†æ‰€æœ‰å¹´é¾„å°äº18çš„ç”¨æˆ·å¹´é¾„æ”¹ä¸º18
userService.update(
    new UpdateWrapper<User>()
        .set("age", 18)
        .lt("age", 18)
);

ğŸ’¡ é€‚ç”¨åœºæ™¯ï¼šæ‰¹é‡ä¿®æ”¹æŸäº›å­—æ®µ
```

### 4.4 åˆ é™¤æ–¹æ³•è¯¦è§£


**removeById - æ ¹æ®IDåˆ é™¤**ï¼š
```java
// åˆ é™¤IDä¸º1çš„ç”¨æˆ·
boolean success = userService.removeById(1L);

// æ‰¹é‡åˆ é™¤å¤šä¸ªID
List<Long> ids = Arrays.asList(1L, 2L, 3L);
userService.removeByIds(ids);
```

**remove - æ¡ä»¶åˆ é™¤**ï¼š
```java
// åˆ é™¤æ‰€æœ‰å¹´é¾„å¤§äº60çš„ç”¨æˆ·
userService.remove(
    new QueryWrapper<User>().gt("age", 60)
);

âš ï¸ æ…ç”¨ï¼æ²¡æœ‰æ¡ä»¶ä¼šåˆ é™¤å…¨è¡¨
```

---

## 5. ğŸ“¦ æ‰¹é‡æ“ä½œè¯¦è§£


### 5.1 ä¸ºä»€ä¹ˆéœ€è¦æ‰¹é‡æ“ä½œ


**æ€§èƒ½å¯¹æ¯”**ï¼š
```
åœºæ™¯ï¼šä¿å­˜1000ä¸ªç”¨æˆ·

âŒ å¾ªç¯å•ä¸ªä¿å­˜ï¼š
for (User user : userList) {
    userService.save(user);  // æ‰§è¡Œ1000æ¬¡SQL
}
è€—æ—¶ï¼šçº¦10ç§’

âœ… æ‰¹é‡ä¿å­˜ï¼š
userService.saveBatch(userList);  // æ‰§è¡Œ1æ¬¡SQL
è€—æ—¶ï¼šçº¦0.5ç§’

æ€§èƒ½æå‡ï¼š20å€ï¼
```

### 5.2 æ‰¹é‡ä¿å­˜æ–¹æ³•


**saveBatch - æ‰¹é‡æ’å…¥**ï¼š
```java
// å‡†å¤‡æ•°æ®
List<User> userList = new ArrayList<>();
for (int i = 0; i < 1000; i++) {
    User user = new User();
    user.setName("ç”¨æˆ·" + i);
    user.setAge(20 + i % 50);
    userList.add(user);
}

// æ‰¹é‡ä¿å­˜ï¼ˆé»˜è®¤æ¯æ‰¹1000æ¡ï¼‰
userService.saveBatch(userList);

// è‡ªå®šä¹‰æ‰¹æ¬¡å¤§å°
userService.saveBatch(userList, 500);  // æ¯æ‰¹500æ¡
```

**æ‰¹é‡ä¿å­˜çš„åŸç†**ï¼š
```
åˆ†æ‰¹æ‰§è¡Œæµç¨‹ï¼š
1000æ¡æ•°æ®ï¼Œæ¯æ‰¹500æ¡

ç¬¬ä¸€æ‰¹ï¼šINSERT INTO user VALUES (...), (...), ... (500æ¡)
ç¬¬äºŒæ‰¹ï¼šINSERT INTO user VALUES (...), (...), ... (500æ¡)

ä¼˜åŠ¿ï¼š
- å‡å°‘SQLæ‰§è¡Œæ¬¡æ•°
- é¿å…SQLè¿‡é•¿
- è‡ªåŠ¨ç®¡ç†äº‹åŠ¡
```

### 5.3 æ‰¹é‡æ›´æ–°æ–¹æ³•


**updateBatchById - æ‰¹é‡æ›´æ–°**ï¼š
```java
// ä¿®æ”¹å¤šä¸ªç”¨æˆ·çš„ä¿¡æ¯
List<User> userList = new ArrayList<>();

User user1 = new User();
user1.setId(1L);
user1.setName("æ–°åå­—1");
userList.add(user1);

User user2 = new User();
user2.setId(2L);
user2.setName("æ–°åå­—2");
userList.add(user2);

// æ‰¹é‡æ›´æ–°
userService.updateBatchById(userList);

ğŸ’¡ æ³¨æ„ï¼šæ¯ä¸ªå¯¹è±¡å¿…é¡»æœ‰ID
```

### 5.4 æ‰¹é‡åˆ é™¤æ–¹æ³•


**removeByIds - æ‰¹é‡åˆ é™¤**ï¼š
```java
// åˆ é™¤å¤šä¸ªç”¨æˆ·
List<Long> ids = Arrays.asList(1L, 2L, 3L, 4L, 5L);
userService.removeByIds(ids);

æ‰§è¡Œçš„SQLï¼š
DELETE FROM user WHERE id IN (1, 2, 3, 4, 5)
```

### 5.5 æ‰¹é‡æ“ä½œäº‹åŠ¡ç®¡ç†


**è‡ªåŠ¨äº‹åŠ¡æ§åˆ¶**ï¼š
```java
@Service
public class UserServiceImpl extends ServiceImpl<UserMapper, User> 
    implements UserService {
    
    // æ‰¹é‡æ“ä½œè‡ªåŠ¨å¼€å¯äº‹åŠ¡
    public void batchSaveUsers(List<User> users) {
        // saveBatchå†…éƒ¨å·²ç»æœ‰äº‹åŠ¡
        // å¦‚æœä¸­é€”å¤±è´¥ï¼Œä¼šè‡ªåŠ¨å›æ»š
        this.saveBatch(users);
    }
    
    // å¦‚æœéœ€è¦æ›´å¤æ‚çš„äº‹åŠ¡æ§åˆ¶
    @Transactional(rollbackFor = Exception.class)
    public void complexBatchOperation(List<User> users) {
        // ä¿å­˜ç”¨æˆ·
        this.saveBatch(users);
        
        // å…¶ä»–æ“ä½œ...
        // å¦‚æœä»»ä½•åœ°æ–¹å‡ºé”™ï¼Œå…¨éƒ¨å›æ»š
    }
}
```

---

## 6. ğŸ’¼ ä¸šåŠ¡é€»è¾‘å°è£…æœ€ä½³å®è·µ


### 6.1 Serviceå±‚èŒè´£åˆ’åˆ†


**æ¸…æ™°çš„èŒè´£è¾¹ç•Œ**ï¼š
```
Controllerå±‚ï¼š
- æ¥æ”¶è¯·æ±‚å‚æ•°
- è°ƒç”¨Serviceæ–¹æ³•
- è¿”å›å“åº”ç»“æœ
- âŒ ä¸å†™ä¸šåŠ¡é€»è¾‘

Serviceå±‚ï¼š
- ç¼–å†™ä¸šåŠ¡é€»è¾‘
- ç»„åˆå¤šä¸ªæ“ä½œ
- å¤„ç†äº‹åŠ¡
- âœ… æ ¸å¿ƒä¸šåŠ¡åœ¨è¿™é‡Œ

Mapperå±‚ï¼š
- æ•°æ®åº“æ“ä½œ
- âŒ ä¸å†™ä¸šåŠ¡é€»è¾‘
```

### 6.2 ä¸šåŠ¡é€»è¾‘å°è£…ç¤ºä¾‹


**ç”¨æˆ·æ³¨å†Œä¸šåŠ¡**ï¼š
```java
@Service
public class UserServiceImpl extends ServiceImpl<UserMapper, User> 
    implements UserService {
    
    @Transactional
    public boolean registerUser(User user) {
        // 1. æ£€æŸ¥é‚®ç®±æ˜¯å¦å·²å­˜åœ¨
        User existUser = this.getOne(
            new QueryWrapper<User>().eq("email", user.getEmail())
        );
        if (existUser != null) {
            throw new RuntimeException("é‚®ç®±å·²è¢«æ³¨å†Œ");
        }
        
        // 2. å¯†ç åŠ å¯†
        user.setPassword(encryptPassword(user.getPassword()));
        
        // 3. è®¾ç½®é»˜è®¤å€¼
        user.setStatus(1);  // æ­£å¸¸çŠ¶æ€
        user.setCreateTime(LocalDateTime.now());
        
        // 4. ä¿å­˜ç”¨æˆ·
        boolean success = this.save(user);
        
        // 5. å‘é€æ¬¢è¿é‚®ä»¶ï¼ˆç¤ºæ„ï¼‰
        if (success) {
            sendWelcomeEmail(user.getEmail());
        }
        
        return success;
    }
    
    private String encryptPassword(String password) {
        // å¯†ç åŠ å¯†é€»è¾‘
        return password; // ç®€åŒ–ç¤ºä¾‹
    }
    
    private void sendWelcomeEmail(String email) {
        // å‘é€é‚®ä»¶é€»è¾‘
    }
}
```

### 6.3 ç»„åˆæŸ¥è¯¢å°è£…


**å¤æ‚æŸ¥è¯¢ä¸šåŠ¡**ï¼š
```java
@Service
public class UserServiceImpl extends ServiceImpl<UserMapper, User> 
    implements UserService {
    
    // æŸ¥è¯¢æ´»è·ƒç”¨æˆ·ï¼ˆæœ€è¿‘30å¤©ç™»å½•ï¼‰
    public List<User> getActiveUsers() {
        LocalDateTime thirtyDaysAgo = LocalDateTime.now().minusDays(30);
        
        return this.list(
            new QueryWrapper<User>()
                .ge("last_login_time", thirtyDaysAgo)
                .eq("status", 1)
                .orderByDesc("last_login_time")
        );
    }
    
    // åˆ†é¡µæŸ¥è¯¢ç”¨æˆ·
    public IPage<User> getUserPage(int pageNo, int pageSize, String keyword) {
        Page<User> page = new Page<>(pageNo, pageSize);
        
        QueryWrapper<User> wrapper = new QueryWrapper<>();
        if (StringUtils.isNotBlank(keyword)) {
            wrapper.like("name", keyword)
                   .or()
                   .like("email", keyword);
        }
        
        return this.page(page, wrapper);
    }
}
```

### 6.4 ä¸šåŠ¡æ–¹æ³•å‘½åè§„èŒƒ


**æ¸…æ™°çš„æ–¹æ³•å‘½å**ï¼š
```java
public interface UserService extends IService<User> {
    
    // âœ… å¥½çš„å‘½åï¼ˆè§åçŸ¥æ„ï¼‰
    User findByEmail(String email);           // æ ¹æ®é‚®ç®±æŸ¥æ‰¾
    List<User> listActiveUsers();            // åˆ—å‡ºæ´»è·ƒç”¨æˆ·
    boolean registerNewUser(User user);      // æ³¨å†Œæ–°ç”¨æˆ·
    void deactivateUser(Long userId);        // åœç”¨ç”¨æˆ·
    
    // âŒ ä¸å¥½çš„å‘½åï¼ˆæ¨¡ç³Šä¸æ¸…ï¼‰
    User getUser(String str);                // ä¸çŸ¥é“æ ¹æ®ä»€ä¹ˆæŸ¥
    List<User> getList();                    // ä¸çŸ¥é“æŸ¥ä»€ä¹ˆåˆ—è¡¨
    boolean doSomething(User user);          // ä¸çŸ¥é“åšä»€ä¹ˆ
}
```

### 6.5 å¼‚å¸¸å¤„ç†æœ€ä½³å®è·µ


**åˆç†çš„å¼‚å¸¸å¤„ç†**ï¼š
```java
@Service
public class UserServiceImpl extends ServiceImpl<UserMapper, User> 
    implements UserService {
    
    @Transactional(rollbackFor = Exception.class)
    public void transferBalance(Long fromUserId, Long toUserId, BigDecimal amount) {
        // 1. å‚æ•°æ ¡éªŒ
        if (amount.compareTo(BigDecimal.ZERO) <= 0) {
            throw new IllegalArgumentException("è½¬è´¦é‡‘é¢å¿…é¡»å¤§äº0");
        }
        
        // 2. æŸ¥è¯¢è½¬å‡ºç”¨æˆ·
        User fromUser = this.getById(fromUserId);
        if (fromUser == null) {
            throw new RuntimeException("è½¬å‡ºç”¨æˆ·ä¸å­˜åœ¨");
        }
        
        // 3. æ£€æŸ¥ä½™é¢
        if (fromUser.getBalance().compareTo(amount) < 0) {
            throw new RuntimeException("ä½™é¢ä¸è¶³");
        }
        
        // 4. æŸ¥è¯¢è½¬å…¥ç”¨æˆ·
        User toUser = this.getById(toUserId);
        if (toUser == null) {
            throw new RuntimeException("è½¬å…¥ç”¨æˆ·ä¸å­˜åœ¨");
        }
        
        // 5. æ‰§è¡Œè½¬è´¦
        fromUser.setBalance(fromUser.getBalance().subtract(amount));
        toUser.setBalance(toUser.getBalance().add(amount));
        
        // 6. æ‰¹é‡æ›´æ–°
        this.updateBatchById(Arrays.asList(fromUser, toUser));
        
        // 7. è®°å½•æ—¥å¿—ï¼ˆç¤ºæ„ï¼‰
        log.info("ç”¨æˆ·{}å‘ç”¨æˆ·{}è½¬è´¦{}å…ƒ", fromUserId, toUserId, amount);
    }
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


**Serviceå±‚å¢å¼ºä¸‰è¦ç´ **ï¼š
```
ğŸ”¸ IServiceæ¥å£ï¼šé€šç”¨æ–¹æ³•çš„å®šä¹‰ï¼ˆå·¥å…·ç®±ï¼‰
ğŸ”¸ ServiceImplåŸºç±»ï¼šé€šç”¨æ–¹æ³•çš„å®ç°ï¼ˆå·²è£…ä¿®çš„æˆ¿å­ï¼‰
ğŸ”¸ è‡ªå®šä¹‰Serviceå®ç°ï¼šä¸šåŠ¡é€»è¾‘çš„ç¼–å†™ï¼ˆæ·»åŠ å®¶å…·ï¼‰
```

### 7.2 å…³é”®çŸ¥è¯†ç‚¹å›é¡¾


**ğŸ’¡ IServiceæ¥å£**ï¼š
- æä¾›60å¤šä¸ªå¸¸ç”¨æ–¹æ³•
- åŒ…å«å•ä¸ªå’Œæ‰¹é‡CRUDæ“ä½œ
- æ— éœ€è‡ªå·±ç¼–å†™é‡å¤ä»£ç 

**ğŸ’¡ ServiceImplåŸºç±»**ï¼š
- å®ç°äº†IServiceæ‰€æœ‰æ–¹æ³•
- è‡ªåŠ¨æ³¨å…¥Mapper
- æä¾›baseMapperå±æ€§æ“ä½œæ•°æ®åº“

**ğŸ’¡ æ‰¹é‡æ“ä½œ**ï¼š
- `saveBatch()` - æ‰¹é‡æ’å…¥
- `updateBatchById()` - æ‰¹é‡æ›´æ–°
- `removeByIds()` - æ‰¹é‡åˆ é™¤
- è‡ªåŠ¨åˆ†æ‰¹ã€è‡ªåŠ¨äº‹åŠ¡

**ğŸ’¡ ä¸šåŠ¡å°è£…**ï¼š
- ç»„åˆå¤šä¸ªæ“ä½œå®Œæˆä¸šåŠ¡
- æ·»åŠ å‚æ•°æ ¡éªŒå’Œå¼‚å¸¸å¤„ç†
- ä½¿ç”¨@Transactionalæ§åˆ¶äº‹åŠ¡
- æ–¹æ³•å‘½åè¦æ¸…æ™°æ˜äº†

### 7.3 å®é™…åº”ç”¨ä»·å€¼


**å¼€å‘æ•ˆç‡æå‡**ï¼š
```
ä¼ ç»Ÿå¼€å‘ï¼š
- ç¼–å†™Serviceæ¥å£æ–¹æ³•å®šä¹‰ï¼š1å°æ—¶
- ç¼–å†™Serviceå®ç°ç±»æ–¹æ³•ï¼š2å°æ—¶
- ç¼–å†™å•å…ƒæµ‹è¯•ï¼š1å°æ—¶
- æ€»è®¡ï¼š4å°æ—¶

ä½¿ç”¨MyBatis-Plusï¼š
- ç»§æ‰¿IServiceå’ŒServiceImplï¼š5åˆ†é’Ÿ
- ç¼–å†™è‡ªå®šä¹‰ä¸šåŠ¡æ–¹æ³•ï¼š30åˆ†é’Ÿ
- ç¼–å†™å•å…ƒæµ‹è¯•ï¼š30åˆ†é’Ÿ
- æ€»è®¡ï¼š1å°æ—¶

æ•ˆç‡æå‡ï¼š4å€ï¼
```

### 7.4 ä½¿ç”¨å»ºè®®


> ğŸ’¡ **æ–°æ‰‹å»ºè®®**ï¼š
> - å…ˆç”¨å¥½é€šç”¨æ–¹æ³•ï¼Œä¸è¦è‡ªå·±é€ è½®å­
> - ä¸šåŠ¡é€»è¾‘éƒ½å†™åœ¨Serviceå±‚ï¼Œä¸è¦å†™åœ¨Controller
> - æ‰¹é‡æ“ä½œä¼˜å…ˆä½¿ç”¨xxxBatchæ–¹æ³•
> - é‡è¦ä¸šåŠ¡åŠ ä¸Š@Transactionalæ³¨è§£

> âš ï¸ **æ³¨æ„äº‹é¡¹**ï¼š
> - getOne()æŸ¥è¯¢å¤šæ¡ä¼šæŠ¥é”™ï¼Œç¡®å®šå•æ¡å†ç”¨
> - remove()ä¸åŠ æ¡ä»¶ä¼šåˆ å…¨è¡¨ï¼Œå¿…é¡»å°å¿ƒ
> - æ‰¹é‡æ“ä½œæ•°æ®é‡å¤§æ—¶è¦åˆ†æ‰¹ï¼Œé¿å…å†…å­˜æº¢å‡º
> - è‡ªå®šä¹‰SQLå†™åœ¨Mapperå±‚ï¼Œä¸è¦å†™åœ¨Service

> ğŸ”¥ **è¿›é˜¶æŠ€å·§**ï¼š
> - å–„ç”¨Lambdaæ¡ä»¶æ„é€ å™¨ï¼Œä»£ç æ›´ç®€æ´
> - åˆç†ä½¿ç”¨ç¼“å­˜æ³¨è§£æå‡æ€§èƒ½
> - å¤æ‚ä¸šåŠ¡æ‹†åˆ†æˆå¤šä¸ªå°æ–¹æ³•
> - åšå¥½æ—¥å¿—è®°å½•å’Œå¼‚å¸¸å¤„ç†

### 7.5 å­¦ä¹ è·¯å¾„å»ºè®®


**å¾ªåºæ¸è¿›çš„å­¦ä¹ æ­¥éª¤**ï¼š
```
ç¬¬1æ­¥ï¼šæŒæ¡åŸºç¡€
- ç†è§£Serviceå±‚çš„ä½œç”¨
- å­¦ä¼šç»§æ‰¿IServiceå’ŒServiceImpl
- ç†Ÿç»ƒä½¿ç”¨å¸¸ç”¨çš„CRUDæ–¹æ³•

ç¬¬2æ­¥ï¼šæŒæ¡æ‰¹é‡æ“ä½œ
- å­¦ä¼šä½¿ç”¨saveBatchã€updateBatchById
- ç†è§£æ‰¹é‡æ“ä½œçš„æ€§èƒ½ä¼˜åŠ¿
- æŒæ¡äº‹åŠ¡æ§åˆ¶

ç¬¬3æ­¥ï¼šä¸šåŠ¡å°è£…
- å­¦ä¼šç»„åˆå¤šä¸ªæ“ä½œå®Œæˆä¸šåŠ¡
- æ·»åŠ å‚æ•°æ ¡éªŒå’Œå¼‚å¸¸å¤„ç†
- è§„èŒƒæ–¹æ³•å‘½å

ç¬¬4æ­¥ï¼šæ€§èƒ½ä¼˜åŒ–
- ä½¿ç”¨æ‰¹é‡æ“ä½œæ›¿ä»£å¾ªç¯
- åˆç†ä½¿ç”¨ç¼“å­˜
- ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢

ç¬¬5æ­¥ï¼šæœ€ä½³å®è·µ
- åˆ¶å®šå›¢é˜Ÿå¼€å‘è§„èŒƒ
- åšå¥½ä»£ç review
- ç§¯ç´¯ä¸šåŠ¡å°è£…æ¨¡å¼
```

**ğŸ§  è®°å¿†å£è¯€**ï¼š
> Serviceå±‚æ‰¿ä¸šåŠ¡ï¼ŒIServiceå·¥å…·è¶³  
> ServiceImplæ¥ç»§æ‰¿ï¼Œé€šç”¨æ–¹æ³•å…¨éƒ½æœ‰  
> æ‰¹é‡æ“ä½œæ•ˆç‡é«˜ï¼Œäº‹åŠ¡ç®¡ç†ä¸ç”¨æ„  
> ä¸šåŠ¡å°è£…è¦è§„èŒƒï¼Œå¼‚å¸¸å¤„ç†è®°å¿ƒå¤´