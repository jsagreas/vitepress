---
title: 27ã€ æ¡ä»¶æ„é€ ä¸æ‰§è¡Œ
---
## ğŸ“š ç›®å½•

1. [Serviceå±‚å¢å¼ºæ¦‚è¿°](#1-Serviceå±‚å¢å¼ºæ¦‚è¿°)
2. [å•æ¡æŸ¥è¯¢æ–¹æ³•è¯¦è§£](#2-å•æ¡æŸ¥è¯¢æ–¹æ³•è¯¦è§£)
3. [åˆ—è¡¨æŸ¥è¯¢æ–¹æ³•è¯¦è§£](#3-åˆ—è¡¨æŸ¥è¯¢æ–¹æ³•è¯¦è§£)
4. [è®¡æ•°ä¸å­˜åœ¨åˆ¤æ–­](#4-è®¡æ•°ä¸å­˜åœ¨åˆ¤æ–­)
5. [ç»ˆç»“æ“ä½œæ–¹æ³•è¯¦è§£](#5-ç»ˆç»“æ“ä½œæ–¹æ³•è¯¦è§£)
6. [ç»“æœå¤„ç†ç­–ç•¥](#6-ç»“æœå¤„ç†ç­–ç•¥)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ Serviceå±‚å¢å¼ºæ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯Serviceå±‚å¢å¼º


**é€šä¿—ç†è§£**ï¼šMyBatis-Plusä¸ºæˆ‘ä»¬æä¾›äº†ä¸€å¥—å¼€ç®±å³ç”¨çš„Serviceå±‚å·¥å…·ï¼Œè®©ä½ ä¸ç”¨å†™SQLå°±èƒ½å®Œæˆå¸¸è§çš„æ•°æ®åº“æ“ä½œã€‚

```
ä¼ ç»Ÿå¼€å‘æ¨¡å¼ï¼š
Controller â†’ Service â†’ Mapper â†’ æ‰‹å†™SQL
æ¯ä¸ªæŸ¥è¯¢éƒ½è¦å†™ä¸€éSQLè¯­å¥

MyBatis-Pluså¢å¼ºæ¨¡å¼ï¼š
Controller â†’ Serviceï¼ˆç»§æ‰¿IServiceï¼‰ â†’ è‡ªåŠ¨å®ç°å¸¸ç”¨æ–¹æ³•
å¤§éƒ¨åˆ†æ“ä½œä¸éœ€è¦å†™SQLï¼
```

**æ ¸å¿ƒä»·å€¼**ï¼š
- **çœä»£ç **ï¼šä¸ç”¨å†™é‡å¤çš„CRUDæ–¹æ³•
- **çœæ—¶é—´**ï¼šå¸¸ç”¨æŸ¥è¯¢å¼€ç®±å³ç”¨
- **æ˜“ç»´æŠ¤**ï¼šç»Ÿä¸€çš„APIé£æ ¼
- **å°‘å‡ºé”™**ï¼šæ¡†æ¶å¸®ä½ å¤„ç†ç»†èŠ‚

### 1.2 IServiceæ¥å£ä½“ç³»


**ç»“æ„å…³ç³»**ï¼š
```
IService<T>ï¼ˆæ¥å£ï¼‰
    â†“ æä¾›æ–¹æ³•å®šä¹‰
ServiceImpl<M, T>ï¼ˆå®ç°ç±»ï¼‰
    â†“ ä½ çš„Serviceç»§æ‰¿å®ƒ
YourService extends ServiceImpl
    â†“ è‡ªåŠ¨æ‹¥æœ‰å¢å¼ºåŠŸèƒ½
```

**å¿«é€Ÿä¸Šæ‰‹ç¤ºä¾‹**ï¼š
```java
// 1. å®šä¹‰Serviceæ¥å£
public interface UserService extends IService<User> {
    // å¯ä»¥æ·»åŠ è‡ªå®šä¹‰æ–¹æ³•
}

// 2. å®ç°ç±»
@Service
public class UserServiceImpl 
    extends ServiceImpl<UserMapper, User> 
    implements UserService {
    // è‡ªåŠ¨æ‹¥æœ‰æ‰€æœ‰å¢å¼ºæ–¹æ³•ï¼
}

// 3. ä½¿ç”¨
@Autowired
private UserService userService;

// ç›´æ¥è°ƒç”¨ï¼Œæ— éœ€å†™SQL
User user = userService.getById(1);
```

---

## 2. ğŸ” å•æ¡æŸ¥è¯¢æ–¹æ³•è¯¦è§£


### 2.1 getOne - æŸ¥è¯¢å•æ¡è®°å½•


**æ–¹æ³•ç­¾å**ï¼š
```java
T getOne(Wrapper<T> queryWrapper)
T getOne(Wrapper<T> queryWrapper, boolean throwEx)
```

**é€šä¿—è§£é‡Š**ï¼š
- `getOne`å°±æ˜¯"æ‰¾ä¸€æ¡ç¬¦åˆæ¡ä»¶çš„è®°å½•"
- å¦‚æœæ‰¾åˆ°å¤šæ¡ä¼šæŠ¥é”™ï¼ˆé»˜è®¤æƒ…å†µï¼‰
- å¯ä»¥è®¾ç½®`throwEx=false`ä¸æŠ¥é”™ï¼Œåªå–ç¬¬ä¸€æ¡

**å®æˆ˜ç¤ºä¾‹**ï¼š

```java
// â‘  æŸ¥è¯¢åå­—å«"å¼ ä¸‰"çš„ç”¨æˆ·ï¼ˆæœŸæœ›åªæœ‰ä¸€ä¸ªï¼‰
User user = userService.getOne(
    new LambdaQueryWrapper<User>()
        .eq(User::getName, "å¼ ä¸‰")
);

// â‘¡ å¦‚æœå¯èƒ½æœ‰å¤šä¸ªï¼Œåªå–ç¬¬ä¸€ä¸ªï¼ˆä¸æŠ¥é”™ï¼‰
User user = userService.getOne(
    new LambdaQueryWrapper<User>()
        .eq(User::getAge, 18),
    false  // æ‰¾åˆ°å¤šæ¡ä¹Ÿä¸æŠ¥é”™
);
```

**å¸¸è§åœºæ™¯**ï¼š
```
âœ… é€‚åˆç”¨getOneçš„æƒ…å†µï¼š
- æ ¹æ®å”¯ä¸€æ ‡è¯†æŸ¥è¯¢ï¼ˆç”¨æˆ·åã€æ‰‹æœºå·ï¼‰
- ç¡®å®šåªæœ‰ä¸€æ¡ç»“æœçš„æŸ¥è¯¢
- æŸ¥è¯¢æœ€æ–°çš„ä¸€æ¡è®°å½•

âŒ ä¸é€‚åˆgetOneçš„æƒ…å†µï¼š
- å¯èƒ½æœ‰å¤šæ¡ç»“æœï¼ˆç”¨getListï¼‰
- å¯èƒ½æŸ¥ä¸åˆ°æ•°æ®ï¼ˆç”¨getOneä¼šè¿”å›nullï¼‰
```

> ğŸ’¡ **æ–°æ‰‹æç¤º**ï¼šgetOneæŸ¥åˆ°å¤šæ¡æ•°æ®é»˜è®¤ä¼šæŠ¥é”™ï¼å¦‚æœä¸ç¡®å®šæ˜¯å¦å”¯ä¸€ï¼ŒåŠ ä¸Š`false`å‚æ•°æˆ–ç”¨`list`æ–¹æ³•ã€‚

### 2.2 getById - æ ¹æ®IDæŸ¥è¯¢


**æ–¹æ³•è¯´æ˜**ï¼š
```java
T getById(Serializable id)
```

**é€šä¿—è§£é‡Š**ï¼šè¿™æ˜¯æœ€ç®€å•çš„æŸ¥è¯¢æ–¹å¼ï¼Œç›´æ¥æ ¹æ®ä¸»é”®IDæŸ¥æ•°æ®ã€‚

```java
// æŸ¥è¯¢IDä¸º1çš„ç”¨æˆ·
User user = userService.getById(1);

// åˆ¤æ–­æ˜¯å¦æŸ¥åˆ°
if (user != null) {
    System.out.println("æ‰¾åˆ°ç”¨æˆ·ï¼š" + user.getName());
} else {
    System.out.println("ç”¨æˆ·ä¸å­˜åœ¨");
}
```

**å¯¹æ¯”ç†è§£**ï¼š
```
getById(1)  â†’  SELECT * FROM user WHERE id = 1
getOne(æ¡ä»¶) â†’  SELECT * FROM user WHERE æ¡ä»¶ LIMIT 1
```

---

## 3. ğŸ“‹ åˆ—è¡¨æŸ¥è¯¢æ–¹æ³•è¯¦è§£


### 3.1 list - æŸ¥è¯¢åˆ—è¡¨


**æ–¹æ³•ç­¾å**ï¼š
```java
List<T> list()                           // æŸ¥å…¨éƒ¨
List<T> list(Wrapper<T> queryWrapper)    // æŒ‰æ¡ä»¶æŸ¥
```

**é€šä¿—è§£é‡Š**ï¼š
- `list()`å°±æ˜¯"æŸ¥è¯¢å¤šæ¡è®°å½•"
- è¿”å›çš„æ˜¯Listé›†åˆï¼Œå¯èƒ½ä¸ºç©ºä½†ä¸ä¼šæ˜¯null
- æ²¡æœ‰æ¡ä»¶å°±æŸ¥å…¨è¡¨ï¼ˆæ…ç”¨ï¼ï¼‰

**åŸºç¡€ç”¨æ³•**ï¼š

```java
// â‘  æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·ï¼ˆæ…ç”¨ï¼æ•°æ®å¤šä¼šå¾ˆæ…¢ï¼‰
List<User> allUsers = userService.list();

// â‘¡ æŸ¥è¯¢å¹´é¾„å¤§äº18çš„æ‰€æœ‰ç”¨æˆ·
List<User> users = userService.list(
    new LambdaQueryWrapper<User>()
        .gt(User::getAge, 18)
);

// â‘¢ æŸ¥è¯¢æŒ‡å®šéƒ¨é—¨çš„ç”¨æˆ·å¹¶æ’åº
List<User> users = userService.list(
    new LambdaQueryWrapper<User>()
        .eq(User::getDeptId, 10)
        .orderByDesc(User::getCreateTime)
);
```

**ç»“æœåˆ¤æ–­**ï¼š
```java
List<User> users = userService.list(æ¡ä»¶);

// åˆ¤æ–­æ˜¯å¦æœ‰æ•°æ®
if (users.isEmpty()) {
    System.out.println("æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„æ•°æ®");
} else {
    System.out.println("æŸ¥åˆ° " + users.size() + " æ¡æ•°æ®");
}
```

### 3.2 listByIds - æ‰¹é‡IDæŸ¥è¯¢


**æ–¹æ³•è¯´æ˜**ï¼š
```java
List<T> listByIds(Collection<? extends Serializable> idList)
```

**é€šä¿—è§£é‡Š**ï¼šä¸€æ¬¡æŸ¥è¯¢å¤šä¸ªIDçš„è®°å½•ï¼Œæ¯”å¾ªç¯è°ƒç”¨`getById`æ•ˆç‡é«˜å¾—å¤šã€‚

```java
// æŸ¥è¯¢IDä¸º1,2,3çš„ç”¨æˆ·
List<Long> ids = Arrays.asList(1L, 2L, 3L);
List<User> users = userService.listByIds(ids);

// ç­‰åŒäºSQLï¼šSELECT * FROM user WHERE id IN (1,2,3)
```

**æ€§èƒ½å¯¹æ¯”**ï¼š
```
âŒ ä½æ•ˆæ–¹å¼ï¼ˆNæ¬¡æŸ¥è¯¢ï¼‰ï¼š
for (Long id : ids) {
    User user = userService.getById(id);  // æ¯æ¬¡éƒ½æŸ¥æ•°æ®åº“
}

âœ… é«˜æ•ˆæ–¹å¼ï¼ˆ1æ¬¡æŸ¥è¯¢ï¼‰ï¼š
List<User> users = userService.listByIds(ids);
```

### 3.3 listMaps - æŸ¥è¯¢Mapåˆ—è¡¨


**æ–¹æ³•è¯´æ˜**ï¼š
```java
List<Map<String, Object>> listMaps(Wrapper<T> queryWrapper)
```

**é€šä¿—è§£é‡Š**ï¼š
- ä¸æƒ³è¿”å›å®ä½“å¯¹è±¡ï¼Œè€Œæ˜¯è¿”å›Mapï¼ˆé”®å€¼å¯¹ï¼‰
- é€‚åˆåªæŸ¥éƒ¨åˆ†å­—æ®µæˆ–åšæ•°æ®ç»Ÿè®¡

```java
// åªæŸ¥è¯¢ç”¨æˆ·çš„idå’Œname
List<Map<String, Object>> userMaps = userService.listMaps(
    new LambdaQueryWrapper<User>()
        .select(User::getId, User::getName)
        .eq(User::getStatus, 1)
);

// ç»“æœæ ¼å¼ï¼š[{id=1, name="å¼ ä¸‰"}, {id=2, name="æå››"}]
```

**ä½¿ç”¨åœºæ™¯**ï¼š
```
âœ… é€‚åˆç”¨listMapsï¼š
- åªéœ€è¦éƒ¨åˆ†å­—æ®µ
- å‰ç«¯éœ€è¦çš„æ ¼å¼å°±æ˜¯é”®å€¼å¯¹
- åšæ•°æ®ç»Ÿè®¡å’Œæ±‡æ€»

âŒ ä¸é€‚åˆlistMapsï¼š
- éœ€è¦å®Œæ•´çš„å®ä½“å¯¹è±¡
- è¦è°ƒç”¨å®ä½“çš„æ–¹æ³•
```

---

## 4. ğŸ”¢ è®¡æ•°ä¸å­˜åœ¨åˆ¤æ–­


### 4.1 count - ç»Ÿè®¡æ•°é‡


**æ–¹æ³•ç­¾å**ï¼š
```java
long count()                          // ç»Ÿè®¡å…¨éƒ¨
long count(Wrapper<T> queryWrapper)   // æŒ‰æ¡ä»¶ç»Ÿè®¡
```

**é€šä¿—è§£é‡Š**ï¼š
- `count`å°±æ˜¯"æ•°ä¸€æ•°æœ‰å¤šå°‘æ¡"
- è¿”å›æ•°å­—ï¼Œæ•ˆç‡æ¯”æŸ¥å‡ºæ¥å†ç®—`.size()`é«˜å¾ˆå¤š
- åªç»Ÿè®¡æ•°é‡ï¼Œä¸è¿”å›å…·ä½“æ•°æ®

**å®æˆ˜ç¤ºä¾‹**ï¼š

```java
// â‘  ç»Ÿè®¡æ€»ç”¨æˆ·æ•°
long total = userService.count();

// â‘¡ ç»Ÿè®¡æˆå¹´ç”¨æˆ·æ•°é‡
long adultCount = userService.count(
    new LambdaQueryWrapper<User>()
        .ge(User::getAge, 18)
);

// â‘¢ ç»Ÿè®¡ä»Šæ—¥æ–°å¢ç”¨æˆ·
long todayCount = userService.count(
    new LambdaQueryWrapper<User>()
        .ge(User::getCreateTime, LocalDate.now())
);
```

**æ€§èƒ½å¯¹æ¯”**ï¼š
```
âŒ ä½æ•ˆæ–¹å¼ï¼š
List<User> users = userService.list(æ¡ä»¶);
int count = users.size();  // æŸ¥å‡ºæ‰€æœ‰æ•°æ®å†è®¡æ•°

âœ… é«˜æ•ˆæ–¹å¼ï¼š
long count = userService.count(æ¡ä»¶);  // ç›´æ¥COUNTç»Ÿè®¡
```

> âš¡ **æ€§èƒ½æç¤º**ï¼šåªéœ€è¦æ•°é‡æ—¶ï¼Œæ°¸è¿œç”¨`count()`è€Œä¸æ˜¯`list().size()`

### 4.2 exists - åˆ¤æ–­æ˜¯å¦å­˜åœ¨


**æ–¹æ³•è¯´æ˜**ï¼š
```java
boolean exists(Wrapper<T> queryWrapper)
```

**é€šä¿—è§£é‡Š**ï¼š
- åˆ¤æ–­"æ˜¯å¦å­˜åœ¨ç¬¦åˆæ¡ä»¶çš„æ•°æ®"
- è¿”å›true/false
- æ¯”countæ›´é«˜æ•ˆï¼ŒæŸ¥åˆ°ä¸€æ¡å°±åœæ­¢

```java
// åˆ¤æ–­ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
boolean exists = userService.exists(
    new LambdaQueryWrapper<User>()
        .eq(User::getUsername, "admin")
);

if (exists) {
    throw new BusinessException("ç”¨æˆ·åå·²å­˜åœ¨");
}
```

**ä¸‰ç§åˆ¤æ–­æ–¹å¼å¯¹æ¯”**ï¼š

| æ–¹æ³• | è¿”å›å€¼ | æ•ˆç‡ | é€‚ç”¨åœºæ™¯ |
|------|--------|------|---------|
| `count() > 0` | `æ•°å­—` | ä¸­ç­‰ | éœ€è¦çŸ¥é“å…·ä½“æ•°é‡ |
| `exists()` | `true/false` | **æœ€é«˜** | åªåˆ¤æ–­æœ‰æ²¡æœ‰ |
| `list().isEmpty()` | `true/false` | æœ€ä½ | **ä¸æ¨è** |

```java
// â‘  éœ€è¦æ•°é‡ï¼šç”¨count
long count = userService.count(æ¡ä»¶);
if (count > 10) { ... }

// â‘¡ åªåˆ¤æ–­å­˜åœ¨ï¼šç”¨exists
boolean exists = userService.exists(æ¡ä»¶);
if (exists) { ... }

// â‘¢ æ—¢è¦åˆ¤æ–­åˆè¦æ•°æ®ï¼šç”¨list
List<User> users = userService.list(æ¡ä»¶);
if (!users.isEmpty()) {
    // ä½¿ç”¨usersæ•°æ®
}
```

---

## 5. ğŸ¯ ç»ˆç»“æ“ä½œæ–¹æ³•è¯¦è§£


### 5.1 ä»€ä¹ˆæ˜¯ç»ˆç»“æ“ä½œ


**é€šä¿—ç†è§£**ï¼š
```
æ„å»ºæ¡ä»¶ â†’ æ‰§è¡ŒæŸ¥è¯¢ â†’ å¾—åˆ°ç»“æœ
   â†“          â†“          â†“
  Wrapper   ç»ˆç»“æ–¹æ³•   è¿”å›æ•°æ®
```

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
- **æ„é€ é˜¶æ®µ**ï¼šç”¨`LambdaQueryWrapper`ç»„è£…æŸ¥è¯¢æ¡ä»¶
- **ç»ˆç»“é˜¶æ®µ**ï¼šè°ƒç”¨`one()`ã€`list()`ç­‰æ–¹æ³•çœŸæ­£æ‰§è¡ŒæŸ¥è¯¢
- **ç»“æœé˜¶æ®µ**ï¼šå¾—åˆ°è¿”å›çš„æ•°æ®

### 5.2 å¸¸ç”¨ç»ˆç»“æ–¹æ³•æ±‡æ€»


**æŸ¥è¯¢ç±»ç»ˆç»“æ–¹æ³•**ï¼š

```
ç»ˆç»“æ–¹æ³•æµç¨‹å›¾ï¼š

Wrapperæ¡ä»¶æ„é€ 
     â†“
ç»ˆç»“æ–¹æ³•é€‰æ‹©ï¼š
     â”œâ”€â†’ one()      â†’ å•æ¡æ•°æ®ï¼ˆTï¼‰
     â”œâ”€â†’ list()     â†’ åˆ—è¡¨æ•°æ®ï¼ˆList<T>ï¼‰
     â”œâ”€â†’ count()    â†’ æ•°é‡ç»Ÿè®¡ï¼ˆlongï¼‰
     â”œâ”€â†’ exists()   â†’ å­˜åœ¨åˆ¤æ–­ï¼ˆbooleanï¼‰
     â””â”€â†’ page()     â†’ åˆ†é¡µæ•°æ®ï¼ˆPage<T>ï¼‰
```

**æ–¹æ³•å¯¹æ¯”è¡¨**ï¼š

| ç»ˆç»“æ–¹æ³• | è¿”å›ç±»å‹ | è¯´æ˜ | å…¸å‹åœºæ™¯ |
|---------|---------|------|---------|
| **one()** | `T` | å•æ¡è®°å½• | è¯¦æƒ…æŸ¥è¯¢ |
| **list()** | `List<T>` | å¤šæ¡è®°å½• | åˆ—è¡¨å±•ç¤º |
| **count()** | `long` | ç»Ÿè®¡æ•°é‡ | æ•°é‡ç»Ÿè®¡ |
| **exists()** | `boolean` | æ˜¯å¦å­˜åœ¨ | éªŒè¯åˆ¤æ–­ |
| **page()** | `Page<T>` | åˆ†é¡µæ•°æ® | åˆ†é¡µæŸ¥è¯¢ |
| **listMaps()** | `List<Map>` | Mapåˆ—è¡¨ | éƒ¨åˆ†å­—æ®µ |

### 5.3 é“¾å¼è°ƒç”¨ç¤ºä¾‹


**æµå¼å†™æ³•**ï¼š
```java
// æŸ¥è¯¢ â†’ åˆ¤æ–­ â†’ å¤„ç†ï¼ˆä¸€æ°”å‘µæˆï¼‰
Optional.ofNullable(
    userService.getOne(
        new LambdaQueryWrapper<User>()
            .eq(User::getUsername, username)
            .eq(User::getStatus, 1)
    )
).orElseThrow(() -> new BusinessException("ç”¨æˆ·ä¸å­˜åœ¨"));
```

**åˆ†æ­¥å†™æ³•**ï¼ˆæ¨èæ–°æ‰‹ï¼‰ï¼š
```java
// 1. æ„å»ºæ¡ä»¶
LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();
wrapper.eq(User::getUsername, username)
       .eq(User::getStatus, 1);

// 2. æ‰§è¡ŒæŸ¥è¯¢ï¼ˆç»ˆç»“æ“ä½œï¼‰
User user = userService.getOne(wrapper);

// 3. ç»“æœå¤„ç†
if (user == null) {
    throw new BusinessException("ç”¨æˆ·ä¸å­˜åœ¨");
}
```

> ğŸ’¡ **æ–°æ‰‹å»ºè®®**ï¼šå…ˆç”¨åˆ†æ­¥å†™æ³•ç†æ¸…æ€è·¯ï¼Œç†Ÿç»ƒåå†ç”¨é“¾å¼è°ƒç”¨ã€‚

---

## 6. ğŸ“Š ç»“æœå¤„ç†ç­–ç•¥


### 6.1 ç©ºå€¼å¤„ç†


**Nullå®‰å…¨å¤„ç†**ï¼š

```java
// âŒ å®¹æ˜“ç©ºæŒ‡é’ˆ
User user = userService.getById(id);
String name = user.getName();  // userå¯èƒ½æ˜¯nullï¼

// âœ… æ–¹æ¡ˆ1ï¼šä¼ ç»Ÿåˆ¤æ–­
User user = userService.getById(id);
if (user != null) {
    String name = user.getName();
}

// âœ… æ–¹æ¡ˆ2ï¼šOptionalåŒ…è£…
String name = Optional.ofNullable(userService.getById(id))
    .map(User::getName)
    .orElse("æœªçŸ¥ç”¨æˆ·");

// âœ… æ–¹æ¡ˆ3ï¼šé»˜è®¤å€¼å¤„ç†
User user = Optional.ofNullable(userService.getById(id))
    .orElseGet(() -> {
        User defaultUser = new User();
        defaultUser.setName("æ¸¸å®¢");
        return defaultUser;
    });
```

**Listç©ºé›†åˆå¤„ç†**ï¼š

```java
// list()æ–¹æ³•è¿”å›ç©ºé›†åˆï¼Œä¸ä¼šè¿”å›null
List<User> users = userService.list(æ¡ä»¶);

// å®‰å…¨çš„åˆ¤æ–­æ–¹å¼
if (users.isEmpty()) {
    return Collections.emptyList();
}

// æˆ–ä½¿ç”¨å·¥å…·ç±»
if (CollUtil.isEmpty(users)) {
    // å¤„ç†ç©ºåˆ—è¡¨æƒ…å†µ
}
```

### 6.2 å¼‚å¸¸å¤„ç†ç­–ç•¥


**åˆ†å±‚å¤„ç†åŸåˆ™**ï¼š

```
Controllerå±‚
    â†“ æ•è·ä¸šåŠ¡å¼‚å¸¸ï¼Œè¿”å›å‹å¥½æç¤º
Serviceå±‚  
    â†“ æŠ›å‡ºä¸šåŠ¡å¼‚å¸¸ï¼Œä¸è¦åæ‰é”™è¯¯
Mapperå±‚
    â†“ æ¡†æ¶è‡ªåŠ¨å¤„ç†SQLå¼‚å¸¸
```

**å®æˆ˜ç¤ºä¾‹**ï¼š

```java
// Serviceå±‚ï¼šæ˜ç¡®çš„å¼‚å¸¸æŠ›å‡º
public User getUserByUsername(String username) {
    User user = this.getOne(
        new LambdaQueryWrapper<User>()
            .eq(User::getUsername, username)
    );
    
    if (user == null) {
        throw new BusinessException("ç”¨æˆ·ä¸å­˜åœ¨");
    }
    
    if (user.getStatus() == 0) {
        throw new BusinessException("ç”¨æˆ·å·²è¢«ç¦ç”¨");
    }
    
    return user;
}

// Controllerå±‚ï¼šç»Ÿä¸€å¼‚å¸¸å¤„ç†
@RestControllerAdvice
public class GlobalExceptionHandler {
    
    @ExceptionHandler(BusinessException.class)
    public Result handleBusinessException(BusinessException e) {
        return Result.fail(e.getMessage());
    }
}
```

### 6.3 æ•°æ®è½¬æ¢å¤„ç†


**å®ä½“è½¬DTO/VO**ï¼š

```java
// â‘  æ‰‹åŠ¨è½¬æ¢
User user = userService.getById(id);
UserVO userVO = new UserVO();
userVO.setId(user.getId());
userVO.setName(user.getName());
// ... å…¶ä»–å­—æ®µ

// â‘¡ ä½¿ç”¨å·¥å…·ç±»ï¼ˆæ¨èï¼‰
User user = userService.getById(id);
UserVO userVO = BeanUtil.copyProperties(user, UserVO.class);

// â‘¢ æ‰¹é‡è½¬æ¢
List<User> users = userService.list();
List<UserVO> userVOList = users.stream()
    .map(user -> BeanUtil.copyProperties(user, UserVO.class))
    .collect(Collectors.toList());
```

**è„±æ•å¤„ç†**ï¼š

```java
// æŸ¥è¯¢åè„±æ•å¤„ç†
User user = userService.getById(id);

// æ‰‹æœºå·è„±æ•ï¼š138****5678
user.setPhone(DesensitizedUtil.mobilePhone(user.getPhone()));

// èº«ä»½è¯è„±æ•ï¼š110***********1234
user.setIdCard(DesensitizedUtil.idCardNum(user.getIdCard(), 3, 4));
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ–¹æ³•


```
ğŸ”¸ å•æ¡æŸ¥è¯¢ï¼šgetOne() / getById()
ğŸ”¸ åˆ—è¡¨æŸ¥è¯¢ï¼šlist() / listByIds() / listMaps()
ğŸ”¸ ç»Ÿè®¡åˆ¤æ–­ï¼šcount() / exists()
ğŸ”¸ ç»ˆç»“æ“ä½œï¼šç†è§£æŸ¥è¯¢çš„å®Œæ•´æµç¨‹
ğŸ”¸ ç»“æœå¤„ç†ï¼šç©ºå€¼ã€å¼‚å¸¸ã€è½¬æ¢ä¸‰å¤§å¤„ç†
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ç»ˆç»“æ–¹æ³•çš„æœ¬è´¨**
```
Wrapperåªæ˜¯æ¡ä»¶æ„é€ å™¨ï¼Œä¸ä¼šæŸ¥è¯¢æ•°æ®åº“
è°ƒç”¨one/list/countç­‰ç»ˆç»“æ–¹æ³•æ‰çœŸæ­£æ‰§è¡ŒSQL
å°±åƒå¼€æªï¼šWrapperæ˜¯ç„å‡†ï¼Œç»ˆç»“æ–¹æ³•æ˜¯æ‰£æ‰³æœº
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–åŸåˆ™**
```
åªè¦æ•°é‡ â†’ count() 
åªåˆ¤æ–­å­˜åœ¨ â†’ exists()
åªè¦éƒ¨åˆ†å­—æ®µ â†’ listMaps() + select()
æ‰¹é‡æŸ¥è¯¢ â†’ listByIds()
åˆ†é¡µæ•°æ® â†’ page()
```

**ğŸ”¹ ç©ºå€¼å¤„ç†ä¹ æƒ¯**
```
getOneå¯èƒ½è¿”å›null â†’ å¿…é¡»åˆ¤ç©º
getByIdå¯èƒ½è¿”å›null â†’ å¿…é¡»åˆ¤ç©º
listè¿”å›ç©ºé›†åˆ â†’ ä¸ä¼šnullä½†å¯èƒ½empty
countè¿”å›0 â†’ æ°¸è¿œä¸ä¼šnull
```

### 7.3 å®æˆ˜æœ€ä½³å®è·µ


**â‘  æ–¹æ³•é€‰æ‹©å†³ç­–æ ‘**ï¼š

```
éœ€è¦æŸ¥è¯¢æ•°æ®ï¼Ÿ
    â”œâ”€ Yes â†’ è¦å‡ æ¡ï¼Ÿ
    â”‚         â”œâ”€ 1æ¡ â†’ getOne() / getById()
    â”‚         â””â”€ å¤šæ¡ â†’ list() / listByIds()
    â”‚
    â””â”€ No â†’ è¦ä»€ä¹ˆä¿¡æ¯ï¼Ÿ
              â”œâ”€ æ•°é‡ â†’ count()
              â””â”€ å­˜åœ¨æ€§ â†’ exists()
```

**â‘¡ ä»£ç è§„èŒƒå»ºè®®**ï¼š

```java
// âœ… æ¨èï¼šæ¡ä»¶æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤
LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();
wrapper.eq(User::getStatus, 1)
       .ge(User::getAge, 18)
       .orderByDesc(User::getCreateTime);
List<User> users = userService.list(wrapper);

// âŒ ä¸æ¨èï¼šé“¾å¼è¿‡é•¿ï¼Œéš¾ä»¥é˜…è¯»
List<User> users = userService.list(new LambdaQueryWrapper<User>()
    .eq(User::getStatus, 1).ge(User::getAge, 18)
    .orderByDesc(User::getCreateTime));
```

**â‘¢ å¼‚å¸¸å¤„ç†è§„èŒƒ**ï¼š

```java
// Serviceå±‚æ˜ç¡®æŠ›å‡º
public User getRequiredUser(Long id) {
    return Optional.ofNullable(getById(id))
        .orElseThrow(() -> new BusinessException("ç”¨æˆ·ä¸å­˜åœ¨"));
}

// Controllerå±‚ç»Ÿä¸€å¤„ç†
@GetMapping("/{id}")
public Result<UserVO> getUser(@PathVariable Long id) {
    User user = userService.getRequiredUser(id);
    return Result.success(BeanUtil.copyProperties(user, UserVO.class));
}
```

### 7.4 å­¦ä¹ è·¯å¾„å»ºè®®


**â‘  å…¥é—¨é˜¶æ®µï¼ˆæŒæ¡åŸºç¡€ï¼‰**ï¼š
- ç†Ÿç»ƒä½¿ç”¨getByIdã€listç­‰åŸºç¡€æ–¹æ³•
- ç†è§£Wrapperæ¡ä»¶æ„é€ 
- æŒæ¡åŸºæœ¬çš„ç©ºå€¼åˆ¤æ–­

**â‘¡ è¿›é˜¶é˜¶æ®µï¼ˆæå‡æ•ˆç‡ï¼‰**ï¼š
- ä½¿ç”¨existsã€countä¼˜åŒ–æ€§èƒ½
- æŒæ¡listMapsåšå­—æ®µç­›é€‰
- å­¦ä¼šæ‰¹é‡æ“ä½œlistByIds

**â‘¢ ç²¾é€šé˜¶æ®µï¼ˆæœ€ä½³å®è·µï¼‰**ï¼š
- çµæ´»ç»„åˆå„ç§æŸ¥è¯¢æ–¹æ³•
- ä¼˜é›…å¤„ç†å¼‚å¸¸å’Œç©ºå€¼
- å°è£…é€šç”¨çš„æŸ¥è¯¢æ¨¡æ¿

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- æŸ¥å•æ¡ç”¨getOneï¼ŒæŸ¥åˆ—è¡¨ç”¨list
- è¦æ•°é‡ç”¨countï¼Œåˆ¤å­˜åœ¨ç”¨exists  
- ç»ˆç»“æ–¹æ³•æ‰æ‰§è¡Œï¼Œæ¡ä»¶æ„é€ è¦æ¸…æ™°
- ç©ºå€¼å¼‚å¸¸è¦å¤„ç†ï¼Œæ€§èƒ½ä¼˜åŒ–è®°å¿ƒé‡Œ