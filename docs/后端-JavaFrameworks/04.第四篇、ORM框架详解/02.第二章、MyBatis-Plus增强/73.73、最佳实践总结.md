---
title: 73ã€æœ€ä½³å®è·µæ€»ç»“
---
## ğŸ“š ç›®å½•


1. [ä»£ç ç»„ç»‡ç»“æ„è§„èŒƒ](#1-ä»£ç ç»„ç»‡ç»“æ„è§„èŒƒ)
2. [å‘½åçº¦å®šæ ‡å‡†](#2-å‘½åçº¦å®šæ ‡å‡†)
3. [æ€§èƒ½ä¼˜åŒ–å»ºè®®](#3-æ€§èƒ½ä¼˜åŒ–å»ºè®®)
4. [å®‰å…¨ä½¿ç”¨æŒ‡å¯¼](#4-å®‰å…¨ä½¿ç”¨æŒ‡å¯¼)
5. [å›¢é˜Ÿåä½œè§„èŒƒ](#5-å›¢é˜Ÿåä½œè§„èŒƒ)
6. [ä»£ç å®¡æŸ¥è¦ç‚¹](#6-ä»£ç å®¡æŸ¥è¦ç‚¹)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ“ ä»£ç ç»„ç»‡ç»“æ„è§„èŒƒ



### 1.1 é¡¹ç›®åˆ†å±‚æ¶æ„



**æ ‡å‡†ä¸‰å±‚æ¶æ„**ï¼šå°±åƒç›–æˆ¿å­ä¸€æ ·ï¼Œæ¯ä¸€å±‚éƒ½æœ‰è‡ªå·±çš„èŒè´£

```
é¡¹ç›®ç»“æ„ç¤ºæ„å›¾ï¼š

src/main/java/com/example/
â”œâ”€â”€ controller/          â† æ§åˆ¶å±‚ï¼šæ¥æ”¶è¯·æ±‚ï¼Œå°±åƒå‰å°æ¥å¾…å‘˜
â”‚   â””â”€â”€ UserController.java
â”œâ”€â”€ service/            â† ä¸šåŠ¡å±‚ï¼šå¤„ç†é€»è¾‘ï¼Œå°±åƒç»ç†å¤„ç†ä¸šåŠ¡
â”‚   â”œâ”€â”€ UserService.java
â”‚   â””â”€â”€ impl/
â”‚       â””â”€â”€ UserServiceImpl.java
â”œâ”€â”€ mapper/             â† æ•°æ®è®¿é—®å±‚ï¼šæ“ä½œæ•°æ®åº“ï¼Œå°±åƒä»“åº“ç®¡ç†å‘˜
â”‚   â””â”€â”€ UserMapper.java
â”œâ”€â”€ entity/             â† å®ä½“ç±»ï¼šæ•°æ®æ¨¡å‹ï¼Œå°±åƒå•†å“ç›®å½•
â”‚   â””â”€â”€ User.java
â”œâ”€â”€ dto/                â† æ•°æ®ä¼ è¾“å¯¹è±¡ï¼šå‰åç«¯äº¤äº’ç”¨
â”‚   â””â”€â”€ UserDTO.java
â””â”€â”€ vo/                 â† è§†å›¾å¯¹è±¡ï¼šè¿”å›ç»™å‰ç«¯çš„æ•°æ®
    â””â”€â”€ UserVO.java
```

**ğŸ”¸ å„å±‚èŒè´£è¯´æ˜**

```
ğŸ¯ Controllerå±‚ï¼ˆæ§åˆ¶å™¨ï¼‰- è¯·æ±‚çš„æ¥å¾…å‘˜
ä½œç”¨ï¼šæ¥æ”¶HTTPè¯·æ±‚ï¼Œè°ƒç”¨Serviceï¼Œè¿”å›ç»“æœ
åŸåˆ™ï¼šåªåšå‚æ•°æ ¡éªŒå’Œè°ƒç”¨ï¼Œä¸å†™ä¸šåŠ¡é€»è¾‘

ç¤ºä¾‹ç†è§£ï¼š
å°±åƒé¤å…æœåŠ¡å‘˜ï¼Œåªè´Ÿè´£ç‚¹èœå’Œä¸Šèœï¼Œä¸è´Ÿè´£åšèœ

ğŸ¯ Serviceå±‚ï¼ˆæœåŠ¡å±‚ï¼‰- ä¸šåŠ¡çš„å¤„ç†è€…
ä½œç”¨ï¼šç¼–å†™ä¸šåŠ¡é€»è¾‘ï¼Œäº‹åŠ¡æ§åˆ¶
åŸåˆ™ï¼šä¸€ä¸ªServiceå¯¹åº”ä¸€å—ä¸šåŠ¡åŠŸèƒ½

ç¤ºä¾‹ç†è§£ï¼š
å°±åƒå¨å¸ˆï¼Œè´Ÿè´£æŠŠå„ç§é£Ÿæï¼ˆæ•°æ®ï¼‰åŠ å·¥æˆèœå“ï¼ˆä¸šåŠ¡ç»“æœï¼‰

ğŸ¯ Mapperå±‚ï¼ˆæ•°æ®è®¿é—®å±‚ï¼‰- æ•°æ®çš„æ¬è¿å·¥
ä½œç”¨ï¼šç›´æ¥æ“ä½œæ•°æ®åº“ï¼Œæ‰§è¡ŒSQL
åŸåˆ™ï¼šåªåšæ•°æ®åº“æ“ä½œï¼Œä¸å†™ä¸šåŠ¡é€»è¾‘

ç¤ºä¾‹ç†è§£ï¼š
å°±åƒä»“åº“ç®¡ç†å‘˜ï¼Œåªè´Ÿè´£å­˜å–è´§ç‰©ï¼Œä¸ç®¡è´§ç‰©æ€ä¹ˆç”¨
```

### 1.2 å®ä½“ç±»ç»„ç»‡è§„èŒƒ



**å®ä½“ç±»çš„ä¸‰å…„å¼Ÿ**ï¼šEntityã€DTOã€VO

```java
// â‘  Entity - æ•°æ®åº“å®ä½“ï¼ˆå’Œæ•°æ®åº“è¡¨ä¸€ä¸€å¯¹åº”ï¼‰
@TableName("t_user")
public class User {
    @TableId(type = IdType.AUTO)
    private Long id;
    
    private String username;
    private String password;  // åŒ…å«æ•æ„Ÿä¿¡æ¯
    private Integer age;
    
    @TableField(fill = FieldFill.INSERT)
    private LocalDateTime createTime;
}

// â‘¡ DTO - æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆæ¥æ”¶å‰ç«¯ä¼ æ¥çš„æ•°æ®ï¼‰
public class UserDTO {
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    private String username;
    
    @NotBlank(message = "å¯†ç ä¸èƒ½ä¸ºç©º")
    private String password;
    
    @Min(value = 1, message = "å¹´é¾„å¿…é¡»å¤§äº0")
    private Integer age;
}

// â‘¢ VO - è§†å›¾å¯¹è±¡ï¼ˆè¿”å›ç»™å‰ç«¯çš„æ•°æ®ï¼‰
public class UserVO {
    private Long id;
    private String username;
    private Integer age;
    // æ³¨æ„ï¼šæ²¡æœ‰passwordå­—æ®µï¼Œä¿æŠ¤æ•æ„Ÿä¿¡æ¯
    private String createTime;  // æ ¼å¼åŒ–åçš„æ—¶é—´
}
```

**ğŸ’¡ ä¸ºä»€ä¹ˆè¦åˆ†ä¸‰ä¸ªç±»ï¼Ÿ**

```
é€šä¿—ç†è§£ï¼š

Entityï¼ˆå®ä½“ï¼‰= æ•°æ®åº“çš„é•œåƒ
- å®Œå…¨æŒ‰ç…§æ•°æ®åº“è¡¨ç»“æ„å®šä¹‰
- åŒ…å«æ‰€æœ‰å­—æ®µï¼ŒåŒ…æ‹¬æ•æ„Ÿä¿¡æ¯
- ç¤ºä¾‹ï¼šUserè¡¨æœ‰ä»€ä¹ˆå­—æ®µï¼ŒEntityå°±æœ‰ä»€ä¹ˆå±æ€§

DTOï¼ˆä¼ è¾“å¯¹è±¡ï¼‰= å‰ç«¯ä¼ ç»™åç«¯çš„æ•°æ®
- åªåŒ…å«éœ€è¦æ¥æ”¶çš„å­—æ®µ
- å¸¦æœ‰æ ¡éªŒè§„åˆ™
- ç¤ºä¾‹ï¼šç”¨æˆ·æ³¨å†Œæ—¶ï¼Œå‰ç«¯åªä¼ ç”¨æˆ·åã€å¯†ç ã€å¹´é¾„

VOï¼ˆè§†å›¾å¯¹è±¡ï¼‰= åç«¯è¿”å›ç»™å‰ç«¯çš„æ•°æ®
- åªåŒ…å«éœ€è¦å±•ç¤ºçš„å­—æ®µ
- éšè—æ•æ„Ÿä¿¡æ¯
- æ•°æ®æ ¼å¼åŒ–ï¼ˆå¦‚æ—¶é—´æ ¼å¼è½¬æ¢ï¼‰
- ç¤ºä¾‹ï¼šè¿”å›ç”¨æˆ·ä¿¡æ¯æ—¶ï¼Œä¸è¿”å›å¯†ç 

å®é™…åº”ç”¨æµç¨‹ï¼š
å‰ç«¯ --[UserDTO]--> Controller --[User]--> Service --[User]--> Mapper --> æ•°æ®åº“
æ•°æ®åº“ --> Mapper --[User]--> Service --[UserVO]--> Controller --> å‰ç«¯
```

### 1.3 é…ç½®æ–‡ä»¶ç»„ç»‡



**é…ç½®æ–‡ä»¶çš„å±‚çº§ç®¡ç†**

```yaml
# application.ymlï¼ˆä¸»é…ç½®æ–‡ä»¶ï¼‰

spring:
  profiles:
    active: dev  # æ¿€æ´»å¼€å‘ç¯å¢ƒé…ç½®

# application-dev.ymlï¼ˆå¼€å‘ç¯å¢ƒï¼‰

mybatis-plus:
  configuration:
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl  # æ‰“å°SQL
  global-config:
    db-config:
      logic-delete-value: 1
      logic-not-delete-value: 0

# application-prod.ymlï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

mybatis-plus:
  configuration:
    log-impl: org.apache.ibatis.logging.slf4j.Slf4jImpl  # åªè®°å½•åˆ°æ—¥å¿—
  global-config:
    db-config:
      logic-delete-value: 1
      logic-not-delete-value: 0
```

**ğŸ”¸ é…ç½®åˆ†ç¦»çš„å¥½å¤„**

| é…ç½®æ–¹å¼ | **å¼€å‘ç¯å¢ƒ** | **ç”Ÿäº§ç¯å¢ƒ** |
|---------|------------|------------|
| `SQLæ—¥å¿—` | `æ§åˆ¶å°æ‰“å°ï¼Œæ–¹ä¾¿è°ƒè¯•` | `åªè®°å½•åˆ°æ–‡ä»¶ï¼Œä¸å½±å“æ€§èƒ½` |
| `æ•°æ®åº“åœ°å€` | `æœ¬åœ°æ•°æ®åº“localhost` | `ç”Ÿäº§æ•°æ®åº“IP` |
| `è¿æ¥æ± å¤§å°` | `å°è¿æ¥æ± èŠ‚çœèµ„æº` | `å¤§è¿æ¥æ± æ”¯æŒé«˜å¹¶å‘` |

---

## 2. ğŸ·ï¸ å‘½åçº¦å®šæ ‡å‡†



### 2.1 ç±»å‘½åè§„èŒƒ



**ç»Ÿä¸€çš„å‘½åé£æ ¼è®©ä»£ç ä¸€ç›®äº†ç„¶**

```java
// âœ… æ­£ç¡®ç¤ºä¾‹
@RestController
@RequestMapping("/user")
public class UserController {  // Controllerç»“å°¾
}

public interface UserService {  // Serviceç»“å°¾
}

@Service
public class UserServiceImpl implements UserService {  // Implç»“å°¾è¡¨ç¤ºå®ç°ç±»
}

@Mapper
public interface UserMapper extends BaseMapper<User> {  // Mapperç»“å°¾
}

// âŒ é”™è¯¯ç¤ºä¾‹
public class User_Controller { }  // ä¸è¦ç”¨ä¸‹åˆ’çº¿
public class userService { }      // é¦–å­—æ¯è¦å¤§å†™
public class UserBiz { }          // ä¸è¦ç”¨ç¼©å†™æˆ–éæ ‡å‡†åç¼€
```

**ğŸ“‹ å‘½åè§„åˆ™æ€»ç»“**

```
Controllerç±»ï¼š  XxxController
Serviceæ¥å£ï¼š   XxxService  
Serviceå®ç°ï¼š   XxxServiceImpl
Mapperæ¥å£ï¼š    XxxMapper
å®ä½“ç±»ï¼š        Xxxï¼ˆç®€æ´æ˜äº†ï¼Œä¸åŠ åç¼€ï¼‰
DTOç±»ï¼š         XxxDTO
VOç±»ï¼š          XxxVO

è®°å¿†å£è¯€ï¼š
è§åçŸ¥æ„æ˜¯å…³é”®ï¼Œåç¼€ç»Ÿä¸€å¥½åˆ†è¾¨
é©¼å³°å‘½åè¦è§„èŒƒï¼Œç¼©å†™ç®€ç§°è¦å°‘ç”¨
```

### 2.2 æ–¹æ³•å‘½åè§„èŒƒ



**æ–¹æ³•åè¦åƒè¯´è¯ä¸€æ ·è‡ªç„¶**

```java
public interface UserService {
    // âœ… å¢åˆ æ”¹æŸ¥æ ‡å‡†å‘½å
    boolean save(User user);              // ä¿å­˜å•ä¸ª
    boolean saveBatch(List<User> list);   // æ‰¹é‡ä¿å­˜
    
    boolean removeById(Long id);          // æ ¹æ®IDåˆ é™¤
    boolean removeByIds(List<Long> ids);  // æ‰¹é‡åˆ é™¤
    
    boolean updateById(User user);        // æ ¹æ®IDæ›´æ–°
    
    User getById(Long id);                // æ ¹æ®IDæŸ¥è¯¢å•ä¸ª
    List<User> listByIds(List<Long> ids); // æ ¹æ®IDåˆ—è¡¨æŸ¥è¯¢
    
    // âœ… ä¸šåŠ¡æ–¹æ³•å‘½å
    boolean registerUser(UserDTO dto);           // æ³¨å†Œç”¨æˆ·
    UserVO getUserInfo(Long userId);             // è·å–ç”¨æˆ·ä¿¡æ¯
    boolean changePassword(Long id, String pwd); // ä¿®æ”¹å¯†ç 
    List<UserVO> searchUsers(String keyword);    // æœç´¢ç”¨æˆ·
    
    // âŒ é”™è¯¯ç¤ºä¾‹
    boolean add(User user);           // ä¸å¤Ÿæ˜ç¡®
    User get(Long id);                // å¤ªç®€å•
    void doSomething();               // å®Œå…¨ä¸çŸ¥é“å¹²ä»€ä¹ˆ
    boolean update_user(User user);   // ä¸è¦ç”¨ä¸‹åˆ’çº¿
}
```

**ğŸ”¸ æ–¹æ³•å‘½åçš„åŠ¨è¯å‰ç¼€**

```
å¸¸ç”¨åŠ¨è¯å‰ç¼€åŠå«ä¹‰ï¼š

save/add     â†’ ä¿å­˜/æ·»åŠ æ•°æ®
remove/delete â†’ åˆ é™¤æ•°æ®  
update/modify â†’ æ›´æ–°/ä¿®æ”¹æ•°æ®
get/query     â†’ æŸ¥è¯¢å•ä¸ªæ•°æ®
list/find     â†’ æŸ¥è¯¢åˆ—è¡¨æ•°æ®
count         â†’ ç»Ÿè®¡æ•°é‡
exist/has     â†’ åˆ¤æ–­æ˜¯å¦å­˜åœ¨
check/verify  â†’ æ ¡éªŒ
register      â†’ æ³¨å†Œ
login         â†’ ç™»å½•

ç¤ºä¾‹ç†è§£ï¼š
getUserById      â†’ æ ¹æ®IDè·å–ç”¨æˆ·
listUsersByAge   â†’ æ ¹æ®å¹´é¾„åˆ—å‡ºç”¨æˆ·
countActiveUsers â†’ ç»Ÿè®¡æ´»è·ƒç”¨æˆ·æ•°é‡
existsByUsername â†’ æ ¹æ®ç”¨æˆ·ååˆ¤æ–­æ˜¯å¦å­˜åœ¨
```

### 2.3 æ•°æ®åº“å­—æ®µå‘½å



**æ•°æ®åº“å‘½åè¦ç»Ÿä¸€è§„èŒƒ**

```sql
-- âœ… æ­£ç¡®ç¤ºä¾‹ï¼ˆä¸‹åˆ’çº¿å‘½åæ³•ï¼‰
CREATE TABLE t_user (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
    user_name VARCHAR(50) COMMENT 'ç”¨æˆ·å',
    real_name VARCHAR(50) COMMENT 'çœŸå®å§“å',
    phone_number VARCHAR(20) COMMENT 'æ‰‹æœºå·',
    is_deleted TINYINT DEFAULT 0 COMMENT 'é€»è¾‘åˆ é™¤(0æœªåˆ é™¤ 1å·²åˆ é™¤)',
    create_time DATETIME COMMENT 'åˆ›å»ºæ—¶é—´',
    update_time DATETIME COMMENT 'æ›´æ–°æ—¶é—´'
) COMMENT 'ç”¨æˆ·è¡¨';

-- âŒ é”™è¯¯ç¤ºä¾‹
CREATE TABLE User (              -- è¡¨åä¸è¦ç”¨å¤§å†™
    ID int,                      -- å­—æ®µåä¸è¦ç”¨å¤§å†™
    UserName varchar(50),        -- ä¸è¦ç”¨é©¼å³°
    phone_Number varchar(20),    -- ä¸è¦æ··ç”¨
    createTime datetime          -- è¦ç»Ÿä¸€é£æ ¼
);
```

**ğŸ“Š å‘½åæ˜ å°„å…³ç³»**

| æ•°æ®åº“å­—æ®µ | **Javaå±æ€§** | **è¯´æ˜** |
|-----------|------------|---------|
| `user_name` | `userName` | `ä¸‹åˆ’çº¿è½¬é©¼å³°ï¼ˆè‡ªåŠ¨æ˜ å°„ï¼‰` |
| `is_deleted` | `isDeleted` | `å¸ƒå°”ç±»å‹ç”¨iså‰ç¼€` |
| `create_time` | `createTime` | `æ—¶é—´å­—æ®µç”¨timeåç¼€` |

---

## 3. âš¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®



### 3.1 åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–



**å¤§æ•°æ®é‡æŸ¥è¯¢è¦åˆ†é¡µï¼Œé¿å…ä¸€æ¬¡æŸ¥å¤ªå¤š**

```java
// âœ… æ­£ç¡®ï¼šä½¿ç”¨åˆ†é¡µæŸ¥è¯¢
public IPage<UserVO> getUserList(int pageNum, int pageSize) {
    Page<User> page = new Page<>(pageNum, pageSize);
    
    // æ–¹å¼1ï¼šç®€å•åˆ†é¡µ
    IPage<User> userPage = userMapper.selectPage(page, null);
    
    // æ–¹å¼2ï¼šå¸¦æ¡ä»¶åˆ†é¡µ
    QueryWrapper<User> wrapper = new QueryWrapper<>();
    wrapper.eq("is_deleted", 0)
           .orderByDesc("create_time");
    IPage<User> userPage = userMapper.selectPage(page, wrapper);
    
    // è½¬æ¢ä¸ºVOè¿”å›
    return userPage.convert(this::convertToVO);
}

// âŒ é”™è¯¯ï¼šä¸€æ¬¡æŸ¥è¯¢æ‰€æœ‰æ•°æ®
public List<UserVO> getAllUsers() {
    List<User> list = userMapper.selectList(null); // å¯èƒ½æœ‰å‡ ä¸‡æ¡æ•°æ®ï¼
    return list.stream()
              .map(this::convertToVO)
              .collect(Collectors.toList());
}
```

**ğŸ’¡ åˆ†é¡µæŸ¥è¯¢çš„æ€§èƒ½å¯¹æ¯”**

```
åœºæ™¯ï¼šæŸ¥è¯¢10ä¸‡æ¡ç”¨æˆ·æ•°æ®

ä¸åˆ†é¡µæŸ¥è¯¢ï¼š
- å†…å­˜å ç”¨ï¼šçº¦100MBï¼ˆå…¨éƒ¨åŠ è½½åˆ°å†…å­˜ï¼‰
- æŸ¥è¯¢æ—¶é—´ï¼š5-10ç§’
- æ•°æ®ä¼ è¾“ï¼š100MBç½‘ç»œä¼ è¾“
- å‰ç«¯æ¸²æŸ“ï¼šæµè§ˆå™¨å¡æ­»

åˆ†é¡µæŸ¥è¯¢ï¼ˆæ¯é¡µ20æ¡ï¼‰ï¼š
- å†…å­˜å ç”¨ï¼šçº¦20KBï¼ˆåªåŠ è½½å½“å‰é¡µï¼‰
- æŸ¥è¯¢æ—¶é—´ï¼š0.1ç§’ä»¥å†…
- æ•°æ®ä¼ è¾“ï¼š20KBç½‘ç»œä¼ è¾“  
- å‰ç«¯æ¸²æŸ“ï¼šæµç•…æ˜¾ç¤º

ç»“è®ºï¼šæ•°æ®é‡å¤§æ—¶ï¼Œå¿…é¡»åˆ†é¡µï¼
```

### 3.2 æ‰¹é‡æ“ä½œä¼˜åŒ–



**æ‰¹é‡å¤„ç†æ¯”å¾ªç¯å•ä¸ªå¤„ç†å¿«å¾ˆå¤š**

```java
// âœ… æ­£ç¡®ï¼šæ‰¹é‡ä¿å­˜
public boolean batchSaveUsers(List<UserDTO> dtoList) {
    List<User> userList = dtoList.stream()
            .map(this::convertToEntity)
            .collect(Collectors.toList());
    
    // æ‰¹é‡æ’å…¥ï¼Œä¸€æ¡SQLæå®š
    return userService.saveBatch(userList);
}

// âŒ é”™è¯¯ï¼šå¾ªç¯å•ä¸ªä¿å­˜
public boolean saveUsersOneByOne(List<UserDTO> dtoList) {
    for (UserDTO dto : dtoList) {
        User user = convertToEntity(dto);
        userService.save(user);  // æ¯æ¬¡éƒ½æ‰§è¡Œä¸€æ¡INSERTè¯­å¥
    }
    return true;
}
```

**ğŸ“ˆ æ€§èƒ½å¯¹æ¯”æ•°æ®**

```
æ’å…¥1000æ¡æ•°æ®çš„æ€§èƒ½å¯¹æ¯”ï¼š

å¾ªç¯å•ä¸ªæ’å…¥ï¼š
- æ‰§è¡Œ1000æ¡INSERTè¯­å¥
- è€—æ—¶ï¼šçº¦10ç§’
- æ•°æ®åº“è¿æ¥ï¼šå»ºç«‹1000æ¬¡

æ‰¹é‡æ’å…¥ï¼š
- æ‰§è¡Œ1æ¡æ‰¹é‡INSERTè¯­å¥  
- è€—æ—¶ï¼šçº¦0.5ç§’
- æ•°æ®åº“è¿æ¥ï¼šå»ºç«‹1æ¬¡

æ€§èƒ½æå‡ï¼š20å€ï¼

è®°å¿†è¦ç‚¹ï¼š
èƒ½æ‰¹é‡å°±æ‰¹é‡ï¼Œé¿å…å¾ªç¯æ•°æ®åº“æ“ä½œ
```

### 3.3 ç´¢å¼•ä½¿ç”¨ä¼˜åŒ–



**æŸ¥è¯¢æ¡ä»¶è¦ç”¨ç´¢å¼•å­—æ®µï¼Œä¸ç„¶ä¼šå¾ˆæ…¢**

```java
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ç´¢å¼•å­—æ®µæŸ¥è¯¢
public User findByUsername(String username) {
    // usernameå­—æ®µå»ºæœ‰ç´¢å¼•
    QueryWrapper<User> wrapper = new QueryWrapper<>();
    wrapper.eq("username", username);  // èµ°ç´¢å¼•ï¼Œé€Ÿåº¦å¿«
    return userMapper.selectOne(wrapper);
}

// âŒ é”™è¯¯ï¼šæ¨¡ç³ŠæŸ¥è¯¢å¯èƒ½ä¸èµ°ç´¢å¼•
public List<User> findByNameLike(String name) {
    QueryWrapper<User> wrapper = new QueryWrapper<>();
    wrapper.like("real_name", "%" + name + "%");  // å‰åéƒ½æœ‰%ï¼Œä¸èµ°ç´¢å¼•
    return userMapper.selectList(wrapper);
}

// âœ… æ”¹è¿›ï¼šå‰ç¼€åŒ¹é…å¯ä»¥èµ°ç´¢å¼•
public List<User> findByNamePrefix(String name) {
    QueryWrapper<User> wrapper = new QueryWrapper<>();
    wrapper.likeRight("real_name", name);  // åªæœ‰å³è¾¹%ï¼Œå¯ä»¥èµ°ç´¢å¼•
    return userMapper.selectList(wrapper);
}
```

**ğŸ” ç´¢å¼•ä½¿ç”¨è§„åˆ™**

```
èµ°ç´¢å¼•ï¼ˆå¿«ï¼‰ï¼š
âœ… username = 'zhangsan'           ç²¾ç¡®åŒ¹é…
âœ… age > 18                        èŒƒå›´æŸ¥è¯¢
âœ… name LIKE 'zhang%'              å‰ç¼€åŒ¹é…
âœ… id IN (1,2,3)                   INæŸ¥è¯¢

ä¸èµ°ç´¢å¼•ï¼ˆæ…¢ï¼‰ï¼š
âŒ name LIKE '%zhang%'             å‰åéƒ½æœ‰%
âŒ YEAR(create_time) = 2024        å¯¹å­—æ®µä½¿ç”¨å‡½æ•°
âŒ age + 1 > 18                    å¯¹å­—æ®µè¿›è¡Œè®¡ç®—
âŒ name != 'zhangsan'              ä¸ç­‰äºæŸ¥è¯¢

ä¼˜åŒ–å»ºè®®ï¼š
1. ç»å¸¸æŸ¥è¯¢çš„å­—æ®µè¦å»ºç´¢å¼•
2. æŸ¥è¯¢æ¡ä»¶å°½é‡ç”¨ç´¢å¼•å­—æ®µ
3. é¿å…å¯¹ç´¢å¼•å­—æ®µä½¿ç”¨å‡½æ•°æˆ–è¿ç®—
```

---

## 4. ğŸ”’ å®‰å…¨ä½¿ç”¨æŒ‡å¯¼



### 4.1 SQLæ³¨å…¥é˜²æŠ¤



**æ°¸è¿œä¸è¦ç›´æ¥æ‹¼æ¥SQLï¼Œè¦ç”¨å‚æ•°åŒ–æŸ¥è¯¢**

```java
// âŒ å±é™©ï¼šå­—ç¬¦ä¸²æ‹¼æ¥SQLï¼ˆå®¹æ˜“SQLæ³¨å…¥ï¼‰
public User findByUsernameUnsafe(String username) {
    // å¦‚æœusername = "' OR '1'='1"ï¼Œå°±ä¼šæŸ¥å‡ºæ‰€æœ‰æ•°æ®ï¼
    String sql = "SELECT * FROM t_user WHERE username = '" + username + "'";
    // éå¸¸å±é™©ï¼
}

// âœ… å®‰å…¨ï¼šä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
public User findByUsernameSafe(String username) {
    QueryWrapper<User> wrapper = new QueryWrapper<>();
    wrapper.eq("username", username);  // MyBatis-Plusä¼šè‡ªåŠ¨é˜²æ³¨å…¥
    return userMapper.selectOne(wrapper);
}

// âœ… å®‰å…¨ï¼šä½¿ç”¨LambdaQueryWrapperï¼ˆæ›´å®‰å…¨ï¼‰
public User findByUsernameBetter(String username) {
    LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();
    wrapper.eq(User::getUsername, username);  // ç±»å‹å®‰å…¨
    return userMapper.selectOne(wrapper);
}
```

**ğŸ’‰ SQLæ³¨å…¥æ”»å‡»ç¤ºä¾‹**

```
æ­£å¸¸æŸ¥è¯¢ï¼š
SELECT * FROM t_user WHERE username = 'zhangsan'
â†’ æŸ¥è¯¢ç”¨æˆ·åä¸ºzhangsançš„ç”¨æˆ·

SQLæ³¨å…¥æ”»å‡»ï¼š
è¾“å…¥ï¼š' OR '1'='1
æ‹¼æ¥åçš„SQLï¼š
SELECT * FROM t_user WHERE username = '' OR '1'='1'
â†’ æ¡ä»¶æ°¸è¿œä¸ºçœŸï¼ŒæŸ¥å‡ºæ‰€æœ‰ç”¨æˆ·æ•°æ®ï¼

é˜²æŠ¤æªæ–½ï¼š
ä½¿ç”¨MyBatis-Plusçš„Wrapperï¼Œè‡ªåŠ¨è¿›è¡Œå‚æ•°è½¬ä¹‰
æ°¸è¿œä¸è¦æ‰‹åŠ¨æ‹¼æ¥SQLè¯­å¥
```

### 4.2 æ•æ„Ÿä¿¡æ¯å¤„ç†



**å¯†ç ã€æ‰‹æœºå·ç­‰æ•æ„Ÿä¿¡æ¯è¦åŠ å¯†å­˜å‚¨**

```java
// âœ… æ­£ç¡®ï¼šå¯†ç åŠ å¯†å­˜å‚¨
@Service
public class UserServiceImpl implements UserService {
    
    @Autowired
    private PasswordEncoder passwordEncoder; // Spring Securityæä¾›
    
    // æ³¨å†Œæ—¶åŠ å¯†å¯†ç 
    public boolean register(UserDTO dto) {
        User user = new User();
        user.setUsername(dto.getUsername());
        // åŠ å¯†åå­˜å‚¨
        user.setPassword(passwordEncoder.encode(dto.getPassword()));
        return save(user);
    }
    
    // ç™»å½•æ—¶éªŒè¯å¯†ç 
    public boolean login(String username, String password) {
        User user = getOne(new QueryWrapper<User>()
                .eq("username", username));
        
        if (user == null) {
            return false;
        }
        
        // éªŒè¯åŠ å¯†å¯†ç 
        return passwordEncoder.matches(password, user.getPassword());
    }
}

// âœ… è¿”å›æ•°æ®æ—¶éšè—æ•æ„Ÿä¿¡æ¯
public UserVO getUserInfo(Long id) {
    User user = getById(id);
    UserVO vo = new UserVO();
    vo.setId(user.getId());
    vo.setUsername(user.getUsername());
    // ä¸è®¾ç½®passwordå­—æ®µï¼Œå‰ç«¯æ”¶ä¸åˆ°å¯†ç 
    vo.setPhone(maskPhone(user.getPhone())); // æ‰‹æœºå·æ‰“ç 
    return vo;
}

// æ‰‹æœºå·æ‰“ç 
private String maskPhone(String phone) {
    if (phone == null || phone.length() != 11) {
        return phone;
    }
    // 138****5678
    return phone.substring(0, 3) + "****" + phone.substring(7);
}
```

**ğŸ” æ•æ„Ÿä¿¡æ¯å¤„ç†è§„åˆ™**

```
å­˜å‚¨è§„åˆ™ï¼š
å¯†ç  â†’ BCryptåŠ å¯†å­˜å‚¨ï¼Œä¸å¯é€†
æ‰‹æœºå· â†’ å¯é€‰æ‹©åŠ å¯†æˆ–æ˜æ–‡ï¼ˆæ ¹æ®ä¸šåŠ¡éœ€æ±‚ï¼‰
èº«ä»½è¯ â†’ åŠ å¯†å­˜å‚¨
é“¶è¡Œå¡å· â†’ åŠ å¯†å­˜å‚¨

å±•ç¤ºè§„åˆ™ï¼š
å¯†ç  â†’ æ°¸è¿œä¸è¿”å›ç»™å‰ç«¯
æ‰‹æœºå· â†’ æ‰“ç æ˜¾ç¤ºï¼ˆ138****5678ï¼‰
èº«ä»½è¯ â†’ æ‰“ç æ˜¾ç¤ºï¼ˆ110***********123ï¼‰
é“¶è¡Œå¡å· â†’ åªæ˜¾ç¤ºå4ä½

ä¼ è¾“è§„åˆ™ï¼š
ä½¿ç”¨HTTPSåŠ å¯†ä¼ è¾“
æ•æ„Ÿæ¥å£éœ€è¦tokenéªŒè¯
```

### 4.3 æƒé™æ§åˆ¶



**ä¸æ˜¯æ‰€æœ‰äººéƒ½èƒ½æ“ä½œæ‰€æœ‰æ•°æ®**

```java
// âœ… æ­£ç¡®ï¼šæ£€æŸ¥æƒé™
@Service
public class UserServiceImpl implements UserService {
    
    // åªèƒ½ä¿®æ”¹è‡ªå·±çš„ä¿¡æ¯
    public boolean updateUserInfo(Long userId, UserDTO dto, Long currentUserId) {
        // æ£€æŸ¥æƒé™ï¼šåªèƒ½æ”¹è‡ªå·±çš„
        if (!userId.equals(currentUserId)) {
            throw new BusinessException("æ— æƒé™ä¿®æ”¹ä»–äººä¿¡æ¯");
        }
        
        User user = getById(userId);
        if (user == null) {
            throw new BusinessException("ç”¨æˆ·ä¸å­˜åœ¨");
        }
        
        // æ›´æ–°ä¿¡æ¯
        user.setRealName(dto.getRealName());
        return updateById(user);
    }
    
    // åªæœ‰ç®¡ç†å‘˜èƒ½åˆ é™¤ç”¨æˆ·
    public boolean deleteUser(Long userId, String currentUserRole) {
        if (!"ADMIN".equals(currentUserRole)) {
            throw new BusinessException("åªæœ‰ç®¡ç†å‘˜å¯ä»¥åˆ é™¤ç”¨æˆ·");
        }
        return removeById(userId);
    }
}
```

**ğŸ›¡ï¸ æƒé™æ§åˆ¶è¦ç‚¹**

```
æ•°æ®æƒé™ï¼š
âœ… ç”¨æˆ·åªèƒ½çœ‹è‡ªå·±çš„æ•°æ®
âœ… ç®¡ç†å‘˜å¯ä»¥çœ‹æ‰€æœ‰æ•°æ®
âœ… éƒ¨é—¨ä¸»ç®¡å¯ä»¥çœ‹æœ¬éƒ¨é—¨æ•°æ®

æ“ä½œæƒé™ï¼š
âœ… æ™®é€šç”¨æˆ·ï¼šåªèƒ½æŸ¥è¯¢
âœ… ç¼–è¾‘äººå‘˜ï¼šå¯ä»¥å¢åˆ æ”¹æŸ¥
âœ… ç®¡ç†å‘˜ï¼šæ‰€æœ‰æƒé™

æŠ€æœ¯å®ç°ï¼š
æ–¹å¼1ï¼šä»£ç ä¸­æ‰‹åŠ¨åˆ¤æ–­ï¼ˆifåˆ¤æ–­ï¼‰
æ–¹å¼2ï¼šä½¿ç”¨Spring Security
æ–¹å¼3ï¼šä½¿ç”¨Shiroæ¡†æ¶
æ–¹å¼4ï¼šè‡ªå®šä¹‰æ³¨è§£+AOP
```

---

## 5. ğŸ‘¥ å›¢é˜Ÿåä½œè§„èŒƒ



### 5.1 ä»£ç æ³¨é‡Šè§„èŒƒ



**å¥½çš„æ³¨é‡Šå°±åƒè·¯æ ‡ï¼Œè®©åˆ«äººçœ‹æ‡‚ä½ çš„ä»£ç **

```java
/**
 * ç”¨æˆ·æœåŠ¡å®ç°ç±»
 * 
 * @author å¼ ä¸‰
 * @since 2024-01-20
 */
@Service
public class UserServiceImpl implements UserService {
    
    /**
     * æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ç”¨æˆ·
     * 
     * @param username ç”¨æˆ·åï¼ˆä¸èƒ½ä¸ºç©ºï¼‰
     * @return ç”¨æˆ·ä¿¡æ¯ï¼Œå¦‚æœä¸å­˜åœ¨è¿”å›null
     */
    public User findByUsername(String username) {
        Assert.hasText(username, "ç”¨æˆ·åä¸èƒ½ä¸ºç©º");
        
        LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();
        wrapper.eq(User::getUsername, username)
               .eq(User::getIsDeleted, 0); // æŸ¥è¯¢æœªåˆ é™¤çš„ç”¨æˆ·
        
        return userMapper.selectOne(wrapper);
    }
    
    /**
     * æ‰¹é‡å¯¼å…¥ç”¨æˆ·
     * 
     * æ³¨æ„äº‹é¡¹ï¼š
     * 1. æ¯æ¬¡æœ€å¤šå¯¼å…¥1000æ¡æ•°æ®
     * 2. é‡å¤ç”¨æˆ·åä¼šè‡ªåŠ¨è·³è¿‡
     * 3. å¯¼å…¥å¤±è´¥ä¼šæŠ›å‡ºå¼‚å¸¸
     * 
     * @param userList ç”¨æˆ·åˆ—è¡¨
     * @return æˆåŠŸå¯¼å…¥çš„æ•°é‡
     * @throws BusinessException å½“æ•°æ®é‡è¶…è¿‡1000æ—¶
     */
    @Transactional
    public int batchImport(List<UserDTO> userList) {
        // å‚æ•°æ ¡éªŒ
        if (userList == null || userList.isEmpty()) {
            return 0;
        }
        
        if (userList.size() > 1000) {
            throw new BusinessException("å•æ¬¡æœ€å¤šå¯¼å…¥1000æ¡æ•°æ®");
        }
        
        // TODO: å®ç°å¯¼å…¥é€»è¾‘
        return 0;
    }
}
```

**ğŸ“ æ³¨é‡Šè§„èŒƒè¦ç‚¹**

```
ç±»æ³¨é‡Šï¼š
âœ… è¯´æ˜ç±»çš„ä½œç”¨
âœ… æ ‡æ³¨ä½œè€…å’Œåˆ›å»ºæ—¶é—´
âœ… é‡è¦çš„ä¸šåŠ¡è¯´æ˜

æ–¹æ³•æ³¨é‡Šï¼š
âœ… è¯´æ˜æ–¹æ³•çš„åŠŸèƒ½
âœ… å‚æ•°è¯´æ˜ï¼ˆ@paramï¼‰
âœ… è¿”å›å€¼è¯´æ˜ï¼ˆ@returnï¼‰
âœ… å¯èƒ½çš„å¼‚å¸¸ï¼ˆ@throwsï¼‰
âœ… æ³¨æ„äº‹é¡¹

ä»£ç æ³¨é‡Šï¼š
âœ… å¤æ‚é€»è¾‘è¦æ³¨é‡Š
âœ… é­”æ³•æ•°å­—è¦è¯´æ˜
âœ… ä¸´æ—¶æ–¹æ¡ˆè¦æ ‡è®°TODO
âœ… å·²çŸ¥é—®é¢˜è¦æ ‡è®°FIXME

ä¸è¦å†™çš„æ³¨é‡Šï¼š
âŒ åºŸè¯æ³¨é‡Šï¼ˆå¦‚ï¼š// å®šä¹‰å˜é‡ï¼‰
âŒ è¿‡æ—¶çš„æ³¨é‡Šï¼ˆä»£ç æ”¹äº†æ³¨é‡Šæ²¡æ”¹ï¼‰
âŒ æ³¨é‡Šä»£ç ï¼ˆè¦åˆ å°±åˆ å¹²å‡€ï¼‰
```

### 5.2 å¼‚å¸¸å¤„ç†è§„èŒƒ



**ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†è®©é”™è¯¯æ›´å®¹æ˜“å®šä½**

```java
// âœ… æ­£ç¡®ï¼šç»Ÿä¸€å¼‚å¸¸å¤„ç†
@RestControllerAdvice
public class GlobalExceptionHandler {
    
    /**
     * ä¸šåŠ¡å¼‚å¸¸å¤„ç†
     */
    @ExceptionHandler(BusinessException.class)
    public Result handleBusinessException(BusinessException e) {
        log.error("ä¸šåŠ¡å¼‚å¸¸ï¼š{}", e.getMessage());
        return Result.error(e.getMessage());
    }
    
    /**
     * å‚æ•°æ ¡éªŒå¼‚å¸¸
     */
    @ExceptionHandler(MethodArgumentNotValidException.class)
    public Result handleValidException(MethodArgumentNotValidException e) {
        String message = e.getBindingResult()
                .getFieldError()
                .getDefaultMessage();
        log.error("å‚æ•°æ ¡éªŒå¤±è´¥ï¼š{}", message);
        return Result.error("å‚æ•°é”™è¯¯ï¼š" + message);
    }
    
    /**
     * æ•°æ®åº“å¼‚å¸¸
     */
    @ExceptionHandler(DataAccessException.class)
    public Result handleDataException(DataAccessException e) {
        log.error("æ•°æ®åº“å¼‚å¸¸", e);
        return Result.error("æ•°æ®æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•");
    }
}

// ä¸šåŠ¡ä»£ç ä¸­æŠ›å‡ºå¼‚å¸¸
@Service
public class UserServiceImpl implements UserService {
    
    public UserVO getUserInfo(Long id) {
        User user = getById(id);
        
        // âœ… æ­£ç¡®ï¼šæŠ›å‡ºä¸šåŠ¡å¼‚å¸¸
        if (user == null) {
            throw new BusinessException("ç”¨æˆ·ä¸å­˜åœ¨");
        }
        
        if (user.getIsDeleted() == 1) {
            throw new BusinessException("ç”¨æˆ·å·²è¢«åˆ é™¤");
        }
        
        return convertToVO(user);
    }
}
```

**âš ï¸ å¼‚å¸¸å¤„ç†å±‚çº§**

```
å¼‚å¸¸å¤„ç†çš„ä¸‰ä¸ªå±‚æ¬¡ï¼š

ç¬¬1å±‚ï¼šControllerå±‚
- åªæ•è·å¼‚å¸¸ï¼Œä¸å¤„ç†
- ç»Ÿä¸€è¿”å›é”™è¯¯ä¿¡æ¯ç»™å‰ç«¯
- ç¤ºä¾‹ï¼šGlobalExceptionHandler

ç¬¬2å±‚ï¼šServiceå±‚  
- å¤„ç†ä¸šåŠ¡å¼‚å¸¸
- æŠ›å‡ºæœ‰æ„ä¹‰çš„å¼‚å¸¸
- ç¤ºä¾‹ï¼šthrow new BusinessException("ç”¨æˆ·ä¸å­˜åœ¨")

ç¬¬3å±‚ï¼šMapperå±‚
- ä¸å¤„ç†å¼‚å¸¸ï¼Œå‘ä¸ŠæŠ›
- è®©ä¸Šå±‚å†³å®šå¦‚ä½•å¤„ç†

è®°å¿†å£è¯€ï¼š
ServiceæŠ›å¼‚å¸¸ï¼ŒControlleræ¥å¤„ç†
å¼‚å¸¸è¦æ˜ç¡®ï¼Œæ–¹ä¾¿å¿«å®šä½
```

### 5.3 æ—¥å¿—è§„èŒƒ



**åˆç†çš„æ—¥å¿—æ˜¯æ’æŸ¥é—®é¢˜çš„åˆ©å™¨**

```java
@Service
@Slf4j  // Lombokæ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆlogå¯¹è±¡
public class UserServiceImpl implements UserService {
    
    public boolean updateUser(Long id, UserDTO dto) {
        // è®°å½•æ–¹æ³•å…¥å£
        log.info("å¼€å§‹æ›´æ–°ç”¨æˆ·ï¼Œid={}, dto={}", id, dto);
        
        try {
            User user = getById(id);
            if (user == null) {
                log.warn("ç”¨æˆ·ä¸å­˜åœ¨ï¼Œid={}", id);
                throw new BusinessException("ç”¨æˆ·ä¸å­˜åœ¨");
            }
            
            // è®°å½•å…³é”®æ“ä½œ
            log.info("æ›´æ–°ç”¨æˆ·ä¿¡æ¯ï¼Œæ—§å€¼={}, æ–°å€¼={}", user, dto);
            
            BeanUtils.copyProperties(dto, user);
            boolean result = updateById(user);
            
            // è®°å½•æ–¹æ³•ç»“æœ
            log.info("ç”¨æˆ·æ›´æ–°å®Œæˆï¼Œid={}, result={}", id, result);
            return result;
            
        } catch (Exception e) {
            // è®°å½•å¼‚å¸¸
            log.error("æ›´æ–°ç”¨æˆ·å¤±è´¥ï¼Œid={}, dto={}", id, dto, e);
            throw e;
        }
    }
}
```

**ğŸ“Š æ—¥å¿—çº§åˆ«ä½¿ç”¨è§„èŒƒ**

| çº§åˆ« | **ä½¿ç”¨åœºæ™¯** | **ç¤ºä¾‹** |
|-----|------------|---------|
| `ERROR` | `ç³»ç»Ÿé”™è¯¯ã€å¼‚å¸¸` | `log.error("æ•°æ®åº“è¿æ¥å¤±è´¥", e)` |
| `WARN` | `è­¦å‘Šä¿¡æ¯ã€ä¸šåŠ¡å¼‚å¸¸` | `log.warn("ç”¨æˆ·ä¸å­˜åœ¨ï¼Œid={}", id)` |
| `INFO` | `å…³é”®ä¸šåŠ¡æ“ä½œ` | `log.info("ç”¨æˆ·ç™»å½•æˆåŠŸï¼Œusername={}", name)` |
| `DEBUG` | `è°ƒè¯•ä¿¡æ¯` | `log.debug("æŸ¥è¯¢å‚æ•°ï¼š{}", params)` |

```
æ—¥å¿—è®°å½•åŸåˆ™ï¼š

âœ… è¦è®°å½•çš„ï¼š
- æ–¹æ³•å…¥å£å’Œå‡ºå£ï¼ˆINFOï¼‰
- å…³é”®ä¸šåŠ¡æ“ä½œï¼ˆINFOï¼‰
- å¼‚å¸¸ä¿¡æ¯ï¼ˆERRORï¼‰
- è­¦å‘Šä¿¡æ¯ï¼ˆWARNï¼‰

âŒ ä¸è¦è®°å½•çš„ï¼š
- å¾ªç¯ä¸­æ‰“æ—¥å¿—ï¼ˆæ€§èƒ½æ€æ‰‹ï¼‰
- æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç ã€èº«ä»½è¯ï¼‰
- è¿‡äºè¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

æ—¥å¿—æ ¼å¼è§„èŒƒï¼š
log.info("æ“ä½œè¯´æ˜ï¼Œå‚æ•°1={}, å‚æ•°2={}", param1, param2);
          â†‘                    â†‘
       æ¸…æ™°çš„è¯´æ˜          å‚æ•°å ä½ç¬¦ï¼ˆä¸è¦æ‹¼æ¥å­—ç¬¦ä¸²ï¼‰
```

---

## 6. ğŸ” ä»£ç å®¡æŸ¥è¦ç‚¹



### 6.1 åŠŸèƒ½æ£€æŸ¥æ¸…å•



**ä»£ç å®¡æŸ¥çš„æ ¸å¿ƒè¦ç‚¹**

```
åŠŸèƒ½æ£€æŸ¥ï¼ˆå¿…æŸ¥é¡¹ï¼‰ï¼š

âœ… åŸºæœ¬åŠŸèƒ½
â–¡ æ˜¯å¦å®ç°äº†éœ€æ±‚çš„æ‰€æœ‰åŠŸèƒ½ï¼Ÿ
â–¡ è¾¹ç•Œæ¡ä»¶æ˜¯å¦å¤„ç†ï¼Ÿ
â–¡ å¼‚å¸¸æƒ…å†µæ˜¯å¦å¤„ç†ï¼Ÿ

âœ… æ•°æ®æ ¡éªŒ
â–¡ å‚æ•°æ˜¯å¦éƒ½æ ¡éªŒäº†ï¼Ÿ
â–¡ ç©ºå€¼æ˜¯å¦å¤„ç†äº†ï¼Ÿ
â–¡ æ•°æ®èŒƒå›´æ˜¯å¦æ£€æŸ¥äº†ï¼Ÿ

âœ… ä¸šåŠ¡é€»è¾‘
â–¡ ä¸šåŠ¡æµç¨‹æ˜¯å¦æ­£ç¡®ï¼Ÿ
â–¡ æƒé™æ§åˆ¶æ˜¯å¦å®Œå–„ï¼Ÿ
â–¡ äº‹åŠ¡ç®¡ç†æ˜¯å¦åˆç†ï¼Ÿ

ç¤ºä¾‹ä»£ç å®¡æŸ¥ï¼š
```

```java
// å®¡æŸ¥ç¤ºä¾‹
public boolean deleteUser(Long id) {
    // âŒ é—®é¢˜1ï¼šæ²¡æœ‰æ£€æŸ¥idæ˜¯å¦ä¸ºnull
    // âŒ é—®é¢˜2ï¼šæ²¡æœ‰æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨
    // âŒ é—®é¢˜3ï¼šæ²¡æœ‰æƒé™æ§åˆ¶
    // âŒ é—®é¢˜4ï¼šç‰©ç†åˆ é™¤ï¼Œåº”è¯¥ç”¨é€»è¾‘åˆ é™¤
    return userMapper.deleteById(id) > 0;
}

// âœ… æ”¹è¿›å
public boolean deleteUser(Long id, Long currentUserId) {
    // âœ… å‚æ•°æ ¡éªŒ
    Assert.notNull(id, "ç”¨æˆ·IDä¸èƒ½ä¸ºç©º");
    
    // âœ… æ•°æ®å­˜åœ¨æ€§æ£€æŸ¥
    User user = getById(id);
    if (user == null) {
        throw new BusinessException("ç”¨æˆ·ä¸å­˜åœ¨");
    }
    
    // âœ… æƒé™æ£€æŸ¥
    if (!id.equals(currentUserId)) {
        throw new BusinessException("åªèƒ½åˆ é™¤è‡ªå·±çš„è´¦å·");
    }
    
    // âœ… é€»è¾‘åˆ é™¤
    user.setIsDeleted(1);
    return updateById(user);
}
```

### 6.2 æ€§èƒ½æ£€æŸ¥æ¸…å•



**æ€§èƒ½ç›¸å…³çš„å®¡æŸ¥è¦ç‚¹**

```
æ€§èƒ½æ£€æŸ¥æ¸…å•ï¼š

âœ… SQLæŸ¥è¯¢
â–¡ æ˜¯å¦æœ‰N+1æŸ¥è¯¢é—®é¢˜ï¼Ÿ
â–¡ æ˜¯å¦ä½¿ç”¨äº†åˆ†é¡µï¼Ÿ
â–¡ æŸ¥è¯¢æ¡ä»¶æ˜¯å¦ä½¿ç”¨ç´¢å¼•ï¼Ÿ
â–¡ æ˜¯å¦æŸ¥è¯¢äº†ä¸éœ€è¦çš„å­—æ®µï¼Ÿ

âœ… å¾ªç¯æ“ä½œ
â–¡ å¾ªç¯ä¸­æ˜¯å¦æœ‰æ•°æ®åº“æ“ä½œï¼Ÿ
â–¡ æ˜¯å¦å¯ä»¥æ”¹ä¸ºæ‰¹é‡æ“ä½œï¼Ÿ
â–¡ å¾ªç¯æ¬¡æ•°æ˜¯å¦å¯æ§ï¼Ÿ

âœ… ç¼“å­˜ä½¿ç”¨
â–¡ çƒ­ç‚¹æ•°æ®æ˜¯å¦ä½¿ç”¨ç¼“å­˜ï¼Ÿ
â–¡ ç¼“å­˜æ˜¯å¦è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Ÿ
â–¡ ç¼“å­˜æ›´æ–°ç­–ç•¥æ˜¯å¦åˆç†ï¼Ÿ
```

**æ€§èƒ½é—®é¢˜ç¤ºä¾‹å¯¹æ¯”**

```java
// âŒ æ€§èƒ½é—®é¢˜ï¼šN+1æŸ¥è¯¢
public List<OrderVO> getOrderList() {
    List<Order> orders = orderMapper.selectList(null);
    
    return orders.stream().map(order -> {
        // é—®é¢˜ï¼šæ¯ä¸ªè®¢å•éƒ½æŸ¥ä¸€æ¬¡ç”¨æˆ·ï¼Œ100ä¸ªè®¢å•å°±æŸ¥100æ¬¡ï¼
        User user = userMapper.selectById(order.getUserId());
        
        OrderVO vo = new OrderVO();
        vo.setOrderId(order.getId());
        vo.setUserName(user.getUsername());
        return vo;
    }).collect(Collectors.toList());
}

// âœ… æ€§èƒ½ä¼˜åŒ–ï¼šä¸€æ¬¡æ€§æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·
public List<OrderVO> getOrderListOptimized() {
    List<Order> orders = orderMapper.selectList(null);
    
    // æ”¶é›†æ‰€æœ‰ç”¨æˆ·ID
    Set<Long> userIds = orders.stream()
            .map(Order::getUserId)
            .collect(Collectors.toSet());
    
    // ä¸€æ¬¡æ€§æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·
    List<User> users = userMapper.selectBatchIds(userIds);
    Map<Long, User> userMap = users.stream()
            .collect(Collectors.toMap(User::getId, u -> u));
    
    // ç»„è£…æ•°æ®
    return orders.stream().map(order -> {
        User user = userMap.get(order.getUserId());
        
        OrderVO vo = new OrderVO();
        vo.setOrderId(order.getId());
        vo.setUserName(user != null ? user.getUsername() : "");
        return vo;
    }).collect(Collectors.toList());
}
```

### 6.3 å®‰å…¨æ£€æŸ¥æ¸…å•



**å®‰å…¨ç›¸å…³çš„å®¡æŸ¥è¦ç‚¹**

```
å®‰å…¨æ£€æŸ¥æ¸…å•ï¼š

âœ… SQLå®‰å…¨
â–¡ æ˜¯å¦æœ‰SQLæ³¨å…¥é£é™©ï¼Ÿ
â–¡ æ˜¯å¦ä½¿ç”¨äº†å‚æ•°åŒ–æŸ¥è¯¢ï¼Ÿ
â–¡ åŠ¨æ€SQLæ˜¯å¦å®‰å…¨ï¼Ÿ

âœ… æ•°æ®å®‰å…¨
â–¡ æ•æ„Ÿä¿¡æ¯æ˜¯å¦åŠ å¯†ï¼Ÿ
â–¡ å¯†ç æ˜¯å¦æ˜æ–‡å­˜å‚¨ï¼Ÿ
â–¡ è¿”å›æ•°æ®æ˜¯å¦åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Ÿ

âœ… æƒé™å®‰å…¨
â–¡ æ˜¯å¦æ£€æŸ¥äº†æ“ä½œæƒé™ï¼Ÿ
â–¡ æ˜¯å¦éªŒè¯äº†æ•°æ®æ‰€å±æƒï¼Ÿ
â–¡ æ¥å£æ˜¯å¦éœ€è¦ç™»å½•ï¼Ÿ

å®¡æŸ¥ç¤ºä¾‹ï¼š
```

```java
// âŒ å®‰å…¨é—®é¢˜
@GetMapping("/user/{id}")
public User getUser(@PathVariable Long id) {
    // é—®é¢˜1ï¼šæ²¡æœ‰æƒé™æ£€æŸ¥ï¼Œä»»ä½•äººéƒ½èƒ½æŸ¥ä»»ä½•ç”¨æˆ·
    // é—®é¢˜2ï¼šè¿”å›äº†å¯†ç å­—æ®µ
    return userService.getById(id);
}

// âœ… å®‰å…¨æ”¹è¿›
@GetMapping("/user/{id}")
public UserVO getUser(@PathVariable Long id, 
                      @RequestHeader("Authorization") String token) {
    // âœ… éªŒè¯ç™»å½•
    Long currentUserId = JwtUtils.getUserId(token);
    
    // âœ… æƒé™æ£€æŸ¥ï¼šåªèƒ½æŸ¥è‡ªå·±çš„
    if (!id.equals(currentUserId)) {
        throw new BusinessException("æ— æƒé™æŸ¥çœ‹");
    }
    
    // âœ… è¿”å›VOï¼Œä¸åŒ…å«å¯†ç 
    return userService.getUserVO(id);
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“



### 7.1 å¿…é¡»æŒæ¡çš„è§„èŒƒ



**ğŸ¯ ä»£ç ç»„ç»‡è§„èŒƒ**
```
ä¸‰å±‚æ¶æ„è¦åˆ†æ¸…ï¼š
Controller â†’ æ¥æ”¶è¯·æ±‚
Service â†’ å¤„ç†ä¸šåŠ¡  
Mapper â†’ æ“ä½œæ•°æ®åº“

å®ä½“ç±»è¦åˆ†ç¦»ï¼š
Entity â†’ æ•°æ®åº“æ˜ å°„
DTO â†’ æ¥æ”¶å‚æ•°
VO â†’ è¿”å›æ•°æ®
```

**ğŸ·ï¸ å‘½åè§„èŒƒ**
```
ç±»åï¼šXxxControllerã€XxxServiceã€XxxMapper
æ–¹æ³•ï¼šsaveã€removeã€updateã€getã€list
æ•°æ®åº“ï¼šä¸‹åˆ’çº¿å‘½åï¼ˆuser_nameï¼‰
Javaï¼šé©¼å³°å‘½åï¼ˆuserNameï¼‰
```

**âš¡ æ€§èƒ½ä¼˜åŒ–**
```
âœ… å¤§æ•°æ®é‡å¿…é¡»åˆ†é¡µ
âœ… æ‰¹é‡æ“ä½œä»£æ›¿å¾ªç¯
âœ… æŸ¥è¯¢æ¡ä»¶ä½¿ç”¨ç´¢å¼•
âœ… é¿å…N+1æŸ¥è¯¢é—®é¢˜
```

**ğŸ”’ å®‰å…¨è§„èŒƒ**
```
âœ… ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢é˜²æ³¨å…¥
âœ… æ•æ„Ÿä¿¡æ¯åŠ å¯†å­˜å‚¨
âœ… æ“ä½œå‰æ£€æŸ¥æƒé™
âœ… è¿”å›æ•°æ®éšè—æ•æ„Ÿå­—æ®µ
```

### 7.2 å›¢é˜Ÿåä½œè¦ç‚¹



**ğŸ“ æ³¨é‡Šè§„èŒƒ**
```
ç±»æ³¨é‡Šï¼šè¯´æ˜ä½œç”¨ã€ä½œè€…ã€æ—¶é—´
æ–¹æ³•æ³¨é‡Šï¼šåŠŸèƒ½ã€å‚æ•°ã€è¿”å›å€¼ã€å¼‚å¸¸
ä»£ç æ³¨é‡Šï¼šå¤æ‚é€»è¾‘ã€æ³¨æ„äº‹é¡¹
```

**âš ï¸ å¼‚å¸¸å¤„ç†**
```
Serviceå±‚ï¼šæŠ›å‡ºä¸šåŠ¡å¼‚å¸¸
Controllerå±‚ï¼šç»Ÿä¸€å¤„ç†å¼‚å¸¸
å¼‚å¸¸ä¿¡æ¯ï¼šæ¸…æ™°ã€æœ‰æ„ä¹‰
```

**ğŸ“Š æ—¥å¿—è§„èŒƒ**
```
ERRORï¼šç³»ç»Ÿé”™è¯¯
WARNï¼šè­¦å‘Šä¿¡æ¯
INFOï¼šå…³é”®æ“ä½œ
DEBUGï¼šè°ƒè¯•ä¿¡æ¯
```

### 7.3 ä»£ç å®¡æŸ¥è¦ç‚¹



**æ£€æŸ¥æ¸…å•**
```
åŠŸèƒ½æ£€æŸ¥ï¼š
âœ… åŠŸèƒ½å®Œæ•´æ€§
âœ… å‚æ•°æ ¡éªŒ
âœ… å¼‚å¸¸å¤„ç†

æ€§èƒ½æ£€æŸ¥ï¼š
âœ… SQLä¼˜åŒ–
âœ… åˆ†é¡µä½¿ç”¨
âœ… æ‰¹é‡æ“ä½œ

å®‰å…¨æ£€æŸ¥ï¼š
âœ… SQLæ³¨å…¥
âœ… æƒé™æ§åˆ¶
âœ… æ•æ„Ÿä¿¡æ¯
```

**ğŸ’¡ è®°å¿†å£è¯€**
```
ä»£ç è§„èŒƒè¦éµå®ˆï¼Œå‘½åç»Ÿä¸€å¥½ç»´æŠ¤
æ€§èƒ½ä¼˜åŒ–æ˜¯å…³é”®ï¼Œå®‰å…¨æ„è¯†è®°å¿ƒé—´
æ³¨é‡Šæ—¥å¿—è¦æ¸…æ™°ï¼Œå¼‚å¸¸å¤„ç†è¦å®Œå–„
å›¢é˜Ÿåä½œé è§„èŒƒï¼Œä»£ç å®¡æŸ¥ä¿è´¨é‡
```

---

# ğŸ“ å­¦ä¹ å»ºè®®



## å®è·µè¦ç‚¹



1. **å¾ªåºæ¸è¿›**ï¼šå…ˆæŒæ¡åŸºæœ¬è§„èŒƒï¼Œå†æ·±å…¥ä¼˜åŒ–æŠ€å·§
2. **å®æˆ˜æ¼”ç»ƒ**ï¼šåœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨è¿™äº›è§„èŒƒ
3. **æŒç»­æ”¹è¿›**ï¼šæ ¹æ®é¡¹ç›®ç»éªŒä¸æ–­ä¼˜åŒ–è§„èŒƒ
4. **å›¢é˜Ÿå…±è¯†**ï¼šä¸å›¢é˜Ÿæˆå‘˜è¾¾æˆä¸€è‡´çš„è§„èŒƒæ ‡å‡†

## è¿›é˜¶æ–¹å‘



- æ·±å…¥å­¦ä¹ MyBatis-Plusæ’ä»¶å¼€å‘
- æŒæ¡åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„æ•°æ®ä¸€è‡´æ€§
- å­¦ä¹ å¾®æœåŠ¡æ¶æ„ä¸­çš„æ•°æ®è®¿é—®è§„èŒƒ
- ç ”ç©¶é«˜å¹¶å‘åœºæ™¯ä¸‹çš„æ€§èƒ½ä¼˜åŒ–

**æ ¸å¿ƒç†å¿µ**ï¼šå¥½çš„ä»£ç è§„èŒƒä¸æ˜¯é™åˆ¶ï¼Œè€Œæ˜¯æå‡å›¢é˜Ÿæ•ˆç‡çš„å·¥å…·ï¼