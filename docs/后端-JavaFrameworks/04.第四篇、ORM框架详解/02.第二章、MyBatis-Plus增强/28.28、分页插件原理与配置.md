---
title: 28ã€åˆ†é¡µæ’ä»¶åŸç†ä¸é…ç½®
---
## ğŸ“š ç›®å½•

1. [åˆ†é¡µæ’ä»¶åŸç†ä¸é…ç½®](#1-åˆ†é¡µæ’ä»¶åŸç†ä¸é…ç½®)
2. [åˆ†é¡µæ‹¦æˆªæœºåˆ¶è¯¦è§£](#2-åˆ†é¡µæ‹¦æˆªæœºåˆ¶è¯¦è§£)
3. [SQLé‡å†™åŸç†](#3-SQLé‡å†™åŸç†)
4. [æ’ä»¶é“¾é…ç½®ä¸ä¼˜åŒ–](#4-æ’ä»¶é“¾é…ç½®ä¸ä¼˜åŒ–)
5. [å¤šæ•°æ®åº“æ”¯æŒ](#5-å¤šæ•°æ®åº“æ”¯æŒ)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ“„ åˆ†é¡µæ’ä»¶åŸç†ä¸é…ç½®


### 1.1 ä»€ä¹ˆæ˜¯åˆ†é¡µæ’ä»¶ï¼Ÿ


**ğŸ”¸ é€šä¿—ç†è§£**
> æƒ³è±¡ä½ åœ¨æ·˜å®è´­ç‰©ï¼Œæœç´¢"æ‰‹æœº"ä¼šæœ‰å‡ ä¸‡ä¸ªç»“æœã€‚å¦‚æœä¸€æ¬¡æ€§å…¨éƒ¨æ˜¾ç¤ºï¼Œé¡µé¢ä¼šå¡æ­»ã€‚æ‰€ä»¥æ·˜å®æ¯æ¬¡åªæ˜¾ç¤º20ä¸ªå•†å“ï¼Œç‚¹å‡»"ä¸‹ä¸€é¡µ"å†æ˜¾ç¤ºä¸‹20ä¸ªã€‚è¿™å°±æ˜¯**åˆ†é¡µ**ã€‚

åœ¨æ•°æ®åº“æŸ¥è¯¢ä¸­ï¼Œåˆ†é¡µæ’ä»¶å¸®æˆ‘ä»¬è‡ªåŠ¨åšä¸¤ä»¶äº‹ï¼š
1. **åªæŸ¥éœ€è¦çš„é‚£å‡ æ¡æ•°æ®**ï¼ˆæ¯”å¦‚ç¬¬11-20æ¡ï¼‰
2. **ç»Ÿè®¡æ€»å…±æœ‰å¤šå°‘æ¡æ•°æ®**ï¼ˆç”¨äºæ˜¾ç¤ºæ€»é¡µæ•°ï¼‰

**ğŸ”§ æŠ€æœ¯å®šä¹‰**
```
åˆ†é¡µæ’ä»¶ = MyBatisæ‹¦æˆªå™¨ + SQLæ”¹å†™å™¨
ä½œç”¨ï¼šè‡ªåŠ¨åœ¨åŸå§‹SQLä¸Šæ·»åŠ åˆ†é¡µé€»è¾‘
å¥½å¤„ï¼šå¼€å‘è€…æ— éœ€æ‰‹å†™å¤æ‚çš„åˆ†é¡µSQL
```

### 1.2 æ ¸å¿ƒç»„ä»¶ï¼šPaginationInnerInterceptor


**ğŸ“¦ ç»„ä»¶ç»“æ„**

```
MyBatis-Plusåˆ†é¡µä½“ç³»ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MybatisPlusInterceptor    â”‚ â† æ‹¦æˆªå™¨å®¹å™¨
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ PaginationInner     â”‚   â”‚ â† åˆ†é¡µæ‹¦æˆªå™¨
â”‚  â”‚ Interceptor         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
   æ‹¦æˆªSQLæ‰§è¡Œ
        â†“
   è‡ªåŠ¨æ”¹å†™SQL
        â†“
   è¿”å›åˆ†é¡µç»“æœ
```

**ğŸ’¡ å·¥ä½œæµç¨‹**
```
ç”¨æˆ·è¯·æ±‚ç¬¬2é¡µæ•°æ®ï¼ˆæ¯é¡µ10æ¡ï¼‰
        â†“
åŸå§‹SQL: SELECT * FROM user WHERE age > 18
        â†“
æ‹¦æˆªå™¨è‡ªåŠ¨æ”¹å†™ï¼š
  COUNT: SELECT COUNT(*) FROM user WHERE age > 18
  DATA:  SELECT * FROM user WHERE age > 18 LIMIT 10 OFFSET 10
        â†“
è¿”å›ï¼š{æ€»æ•°ï¼š50, å½“å‰é¡µæ•°æ®ï¼š[ç”¨æˆ·11-20]}
```

### 1.3 åŸºç¡€é…ç½®


**ğŸ”§ é…ç½®æ­¥éª¤**

```java
@Configuration
public class MybatisPlusConfig {
    
    /**
     * åˆ†é¡µæ’ä»¶é…ç½®
     * ä½œç”¨ï¼šè®©MyBatis-Plusæ”¯æŒè‡ªåŠ¨åˆ†é¡µ
     */
    @Bean
    public MybatisPlusInterceptor mybatisPlusInterceptor() {
        // 1. åˆ›å»ºæ‹¦æˆªå™¨å®¹å™¨
        MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();
        
        // 2. åˆ›å»ºåˆ†é¡µæ‹¦æˆªå™¨
        PaginationInnerInterceptor paginationInterceptor = 
            new PaginationInnerInterceptor();
        
        // 3. è®¾ç½®æ•°æ®åº“ç±»å‹ï¼ˆå‘Šè¯‰æ’ä»¶ç”¨ä»€ä¹ˆæ•°æ®åº“æ–¹è¨€ï¼‰
        paginationInterceptor.setDbType(DbType.MYSQL);
        
        // 4. è®¾ç½®æœ€å¤§å•é¡µé™åˆ¶ï¼ˆé˜²æ­¢ä¸€æ¬¡æŸ¥è¯¢å¤ªå¤šæ•°æ®ï¼‰
        paginationInterceptor.setMaxLimit(500L);
        
        // 5. å¼€å¯countä¼˜åŒ–ï¼ˆæ™ºèƒ½åˆ¤æ–­æ˜¯å¦éœ€è¦countæŸ¥è¯¢ï¼‰
        paginationInterceptor.setOptimizeJoin(true);
        
        // 6. æ·»åŠ åˆ°æ‹¦æˆªå™¨é“¾
        interceptor.addInnerInterceptor(paginationInterceptor);
        
        return interceptor;
    }
}
```

**ğŸ“‹ é…ç½®å‚æ•°è¯´æ˜**

| å‚æ•° | ä½œç”¨ | ç¤ºä¾‹å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `dbType` | æ•°æ®åº“ç±»å‹ | `DbType.MYSQL` | ä¸åŒæ•°æ®åº“åˆ†é¡µè¯­æ³•ä¸åŒ |
| `maxLimit` | å•é¡µæœ€å¤§æ¡æ•° | `500L` | é˜²æ­¢å†…å­˜æº¢å‡º |
| `optimizeJoin` | countä¼˜åŒ– | `true` | ç®€åŒ–count SQLæå‡æ€§èƒ½ |
| `overflow` | è¶…é¡µå¤„ç† | `false` | è¶…è¿‡æ€»é¡µæ•°æ—¶çš„å¤„ç†æ–¹å¼ |

**ğŸ¯ å®é™…ä½¿ç”¨ç¤ºä¾‹**

```java
@Service
public class UserService {
    
    @Autowired
    private UserMapper userMapper;
    
    /**
     * åˆ†é¡µæŸ¥è¯¢ç”¨æˆ·
     * @param pageNum ç¬¬å‡ é¡µï¼ˆä»1å¼€å§‹ï¼‰
     * @param pageSize æ¯é¡µå¤šå°‘æ¡
     */
    public IPage<User> getUsersByPage(int pageNum, int pageSize) {
        // 1. åˆ›å»ºåˆ†é¡µå¯¹è±¡ï¼ˆå‘Šè¯‰è¦æŸ¥ç¬¬å‡ é¡µï¼Œæ¯é¡µå‡ æ¡ï¼‰
        Page<User> page = new Page<>(pageNum, pageSize);
        
        // 2. æ‰§è¡ŒæŸ¥è¯¢ï¼ˆæ’ä»¶è‡ªåŠ¨å¤„ç†åˆ†é¡µï¼‰
        IPage<User> result = userMapper.selectPage(
            page,
            Wrappers.<User>lambdaQuery()
                .gt(User::getAge, 18)  // å¹´é¾„å¤§äº18
                .orderByDesc(User::getCreateTime)  // æŒ‰åˆ›å»ºæ—¶é—´é™åº
        );
        
        // 3. è¿”å›ç»“æœ
        return result;
        // result.getTotal() - æ€»è®°å½•æ•°
        // result.getRecords() - å½“å‰é¡µæ•°æ®
        // result.getPages() - æ€»é¡µæ•°
    }
}
```

---

## 2. ğŸ”„ åˆ†é¡µæ‹¦æˆªæœºåˆ¶è¯¦è§£


### 2.1 æ‹¦æˆªå™¨å·¥ä½œåŸç†


**ğŸ”¸ ä»€ä¹ˆæ˜¯æ‹¦æˆªå™¨ï¼Ÿ**

> æ‹¦æˆªå™¨å°±åƒæœºåœºå®‰æ£€ï¼Œæ¯ä¸ªSQLåœ¨æ‰§è¡Œå‰éƒ½è¦"è¿‡ä¸€éå®‰æ£€"ã€‚åˆ†é¡µæ‹¦æˆªå™¨çš„å·¥ä½œå°±æ˜¯ï¼š
> 1. æ£€æŸ¥è¿™æ¡SQLæ˜¯å¦éœ€è¦åˆ†é¡µ
> 2. å¦‚æœéœ€è¦ï¼Œå°±ç»™å®ƒ"åŠ¨æ‰‹æœ¯"ï¼ˆæ”¹å†™SQLï¼‰
> 3. æ”¾è¡Œæ‰§è¡Œæ–°çš„SQL

**âš™ï¸ æ‹¦æˆªæµç¨‹å›¾**

```
ç”¨æˆ·è°ƒç”¨ selectPage()
        â†“
MyBatiså‡†å¤‡æ‰§è¡ŒSQL
        â†“
[æ‹¦æˆªå™¨æ‹¦æˆª] â† åœ¨è¿™é‡ŒåŠ¨æ‰‹è„šï¼
        â†“
åˆ¤æ–­ï¼šæ˜¯å¦éœ€è¦åˆ†é¡µï¼Ÿ
   â”œâ”€â†’ å¦ â†’ ç›´æ¥æ‰§è¡ŒåŸSQL
   â””â”€â†’ æ˜¯ â†’ æ‰§è¡Œä¸‹åˆ—æ­¥éª¤
        â†“
æ­¥éª¤1: æ‰§è¡ŒcountæŸ¥è¯¢ï¼ˆç»Ÿè®¡æ€»æ•°ï¼‰
   SELECT COUNT(*) FROM ...
        â†“
æ­¥éª¤2: æ”¹å†™åŸSQLæ·»åŠ åˆ†é¡µ
   SELECT * FROM ... LIMIT x OFFSET y
        â†“
æ­¥éª¤3: æ‰§è¡Œåˆ†é¡µSQLè·å–æ•°æ®
        â†“
æ­¥éª¤4: å°è£…ç»“æœï¼ˆæ€»æ•°+æ•°æ®ï¼‰
        â†“
è¿”å›ç»™ç”¨æˆ·
```

### 2.2 æ‹¦æˆªå™¨ç”Ÿå‘½å‘¨æœŸ


**ğŸ” æ‰§è¡Œæ—¶æœº**

```java
// MyBatisæ‰§è¡Œæµç¨‹ï¼ˆç®€åŒ–ç‰ˆï¼‰
1. è§£æSQLè¯­å¥
2. åˆ›å»ºæ‰§è¡Œå™¨
3. ã€æ‹¦æˆªç‚¹1ã€‘å‡†å¤‡æ‰§è¡Œå‰ â† åˆ†é¡µæ‹¦æˆªå™¨åœ¨è¿™é‡Œå·¥ä½œ
4. æ‰§è¡ŒSQL
5. ã€æ‹¦æˆªç‚¹2ã€‘ç»“æœå¤„ç†
6. è¿”å›ç»“æœ
```

**ğŸ’¡ å…³é”®ç†è§£**

`#æ ¸å¿ƒæ¦‚å¿µ` `#æ‹¦æˆªæ—¶æœº` `#SQLæ”¹å†™`

æ‹¦æˆªå™¨çš„æ ¸å¿ƒï¼š
- **æ‹¦æˆªæ—¶æœº**ï¼šSQLæ‰§è¡Œä¹‹å‰
- **æ‹¦æˆªå¯¹è±¡**ï¼šMappedStatementï¼ˆSQLé…ç½®ä¿¡æ¯ï¼‰
- **æ”¹å†™å†…å®¹**ï¼šåŸå§‹SQL â†’ count SQL + åˆ†é¡µSQL

### 2.3 æ‹¦æˆªå™¨é…ç½®ç»†èŠ‚


**ğŸ”§ é«˜çº§é…ç½®é€‰é¡¹**

```java
PaginationInnerInterceptor paginationInterceptor = 
    new PaginationInnerInterceptor();

// ã€é…ç½®1ã€‘æ•°æ®åº“æ–¹è¨€
paginationInterceptor.setDbType(DbType.MYSQL);
// ä¸ºä»€ä¹ˆè¦è®¾ç½®ï¼Ÿ
// MySQL: LIMIT 10 OFFSET 20
// Oracle: ROWNUM
// PostgreSQL: LIMIT 10 OFFSET 20
// ä¸åŒæ•°æ®åº“è¯­æ³•ä¸åŒï¼

// ã€é…ç½®2ã€‘æº¢å‡ºå¤„ç†
paginationInterceptor.setOverflow(false);
// åœºæ™¯ï¼šæ€»å…±5é¡µï¼Œç”¨æˆ·è¯·æ±‚ç¬¬10é¡µ
// false: è¿”å›ç©ºç»“æœ
// true: è¿”å›ç¬¬1é¡µ

// ã€é…ç½®3ã€‘countä¼˜åŒ–
paginationInterceptor.setOptimizeJoin(true);
// ä¼˜åŒ–å‰: SELECT COUNT(*) FROM user LEFT JOIN dept ON ...
// ä¼˜åŒ–å: SELECT COUNT(*) FROM user
// å»æ‰ä¸å¿…è¦çš„JOINæå‡æ€§èƒ½

// ã€é…ç½®4ã€‘æœ€å¤§é™åˆ¶
paginationInterceptor.setMaxLimit(1000L);
// é˜²æ­¢ï¼šSELECT * FROM user LIMIT 999999999
// ä¿æŠ¤æ•°æ®åº“ï¼Œé¿å…ä¸€æ¬¡æŸ¥è¯¢è¿‡å¤šæ•°æ®
```

**âš ï¸ å¸¸è§é…ç½®é—®é¢˜**

```markdown
âŒ **é—®é¢˜1ï¼šåˆ†é¡µä¸ç”Ÿæ•ˆ**
åŸå› ï¼šæ²¡æœ‰é…ç½®æ‹¦æˆªå™¨æˆ–é…ç½®é¡ºåºé”™è¯¯
è§£å†³ï¼šç¡®ä¿MybatisPlusInterceptorå·²æ³¨å†Œä¸ºBean

âŒ **é—®é¢˜2ï¼šcountæŸ¥è¯¢æ…¢**
åŸå› ï¼šå¤æ‚JOINå¯¼è‡´countæ€§èƒ½å·®
è§£å†³ï¼šå¼€å¯optimizeJoinæˆ–æ‰‹åŠ¨ä¼˜åŒ–count SQL

âŒ **é—®é¢˜3ï¼šè¶…é¡µè¿”å›å¼‚å¸¸æ•°æ®**
åŸå› ï¼šoverflowè®¾ç½®ä¸å½“
è§£å†³ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚è®¾ç½®overflowå‚æ•°
```

---

## 3. ğŸ”¨ SQLé‡å†™åŸç†


### 3.1 ä»€ä¹ˆæ˜¯SQLé‡å†™ï¼Ÿ


**ğŸ”¸ ç”Ÿæ´»åŒ–ç†è§£**

> ä½ å»é¤å…ç‚¹èœè¯´"æ¥ä»½å®«ä¿é¸¡ä¸"ï¼ŒæœåŠ¡å‘˜è®°ä¸‹äº†ã€‚ä½†å¨æˆ¿éœ€è¦çš„æ˜¯è¯¦ç»†åšæ³•ï¼š"å…ˆåˆ‡é¸¡è‚‰ï¼Œå†ç‚’èŠ±ç”Ÿ..."ã€‚æœåŠ¡å‘˜æŠŠä½ çš„ç®€å•éœ€æ±‚"ç¿»è¯‘"æˆå¨æˆ¿èƒ½æ‡‚çš„è¯¦ç»†æ­¥éª¤ï¼Œè¿™å°±æ˜¯**é‡å†™**ã€‚

SQLé‡å†™åŒç†ï¼š
- **ä½ å†™çš„**ï¼š`SELECT * FROM user`ï¼ˆç®€å•æŸ¥è¯¢ï¼‰
- **å®é™…æ‰§è¡Œ**ï¼š`SELECT * FROM user LIMIT 10 OFFSET 0`ï¼ˆå¸¦åˆ†é¡µï¼‰

### 3.2 é‡å†™è¿‡ç¨‹è¯¦è§£


**ğŸ“ é‡å†™æ­¥éª¤æ‹†è§£**

```
åŸå§‹SQLï¼š
SELECT id, name, age FROM user WHERE age > 18 ORDER BY age DESC

ç¬¬ä¸€æ­¥ï¼šç”Ÿæˆcount SQL
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
SELECT COUNT(*) FROM (
    SELECT id, name, age FROM user WHERE age > 18
) AS total

ä¼˜åŒ–åï¼ˆå¼€å¯optimizeJoinï¼‰ï¼š
SELECT COUNT(*) FROM user WHERE age > 18

ç¬¬äºŒæ­¥ï¼šç”Ÿæˆåˆ†é¡µSQL
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
åŸSQLåŸºç¡€ä¸Šæ·»åŠ åˆ†é¡µï¼š
SELECT id, name, age FROM user 
WHERE age > 18 
ORDER BY age DESC
LIMIT 10 OFFSET 20  â† æ–°å¢çš„åˆ†é¡µéƒ¨åˆ†

è¯´æ˜ï¼š
- LIMIT 10: å–10æ¡æ•°æ®
- OFFSET 20: è·³è¿‡å‰20æ¡ï¼ˆç¬¬3é¡µçš„èµ·å§‹ä½ç½®ï¼‰
```

**ğŸ¯ ä¸åŒæ•°æ®åº“çš„é‡å†™æ–¹å¼**

| æ•°æ®åº“ | åˆ†é¡µè¯­æ³• | ç¤ºä¾‹ |
|--------|----------|------|
| **MySQL** | `LIMIT x OFFSET y` | `LIMIT 10 OFFSET 20` |
| **Oracle** | `ROWNUM` | `WHERE ROWNUM BETWEEN 21 AND 30` |
| **PostgreSQL** | `LIMIT x OFFSET y` | `LIMIT 10 OFFSET 20` |
| **SQL Server** | `OFFSET FETCH` | `OFFSET 20 ROWS FETCH NEXT 10 ROWS ONLY` |

### 3.3 é‡å†™ä¼˜åŒ–ç­–ç•¥


**âš¡ Countä¼˜åŒ–åŸç†**

```sql
-- ã€æœªä¼˜åŒ–ã€‘å¤æ‚çš„countæŸ¥è¯¢
SELECT COUNT(*) 
FROM user u
LEFT JOIN dept d ON u.dept_id = d.id
LEFT JOIN role r ON u.role_id = r.id
WHERE u.age > 18

-- ã€ä¼˜åŒ–åã€‘å»æ‰ä¸å¿…è¦çš„JOIN
SELECT COUNT(*) 
FROM user u
WHERE u.age > 18

-- ä¸ºä»€ä¹ˆèƒ½å»æ‰JOINï¼Ÿ
-- å› ä¸ºcountåªå…³å¿ƒè¡Œæ•°ï¼Œä¸å…³å¿ƒJOINçš„å­—æ®µ
-- åªè¦WHEREæ¡ä»¶ä¸æ¶‰åŠJOINè¡¨å³å¯ä¼˜åŒ–
```

**ğŸ’¡ ä¼˜åŒ–å¼€å…³é…ç½®**

```java
// æ–¹å¼1ï¼šå…¨å±€å¼€å¯countä¼˜åŒ–
paginationInterceptor.setOptimizeJoin(true);

// æ–¹å¼2ï¼šç‰¹å®šæŸ¥è¯¢å…³é—­ä¼˜åŒ–
@Select("SELECT * FROM user LEFT JOIN dept ...")
@InterceptorIgnore(tenantLine = "true")  // å¿½ç•¥æŸäº›æ‹¦æˆªå™¨
IPage<User> selectUserWithDept(Page<?> page);
```

**ğŸ“Š æ€§èƒ½å¯¹æ¯”**

```markdown
åœºæ™¯ï¼š10ä¸‡ç”¨æˆ·æ•°æ®ï¼Œå¤æ‚3è¡¨JOINæŸ¥è¯¢

æœªä¼˜åŒ–countï¼š
æ‰§è¡Œæ—¶é—´ï¼š~2000ms
æ‰«æè¡Œæ•°ï¼š300,000è¡Œ

ä¼˜åŒ–åcountï¼š
æ‰§è¡Œæ—¶é—´ï¼š~50ms  âš¡ æå‡40å€
æ‰«æè¡Œæ•°ï¼š100,000è¡Œ
```

---

## 4. ğŸ”— æ’ä»¶é“¾é…ç½®ä¸ä¼˜åŒ–


### 4.1 ä»€ä¹ˆæ˜¯æ’ä»¶é“¾ï¼Ÿ


**ğŸ”¸ é€šä¿—ç†è§£**

> æ’ä»¶é“¾å°±åƒå·¥å‚æµæ°´çº¿ï¼Œæ¯ä¸ªæ’ä»¶æ˜¯ä¸€é“å·¥åºï¼š
> - **æ’ä»¶1ï¼ˆåˆ†é¡µï¼‰**ï¼šç»™å•†å“è´´æ ‡ç­¾
> - **æ’ä»¶2ï¼ˆå¤šç§Ÿæˆ·ï¼‰**ï¼šæ£€æŸ¥å•†å“å½’å±
> - **æ’ä»¶3ï¼ˆæ€§èƒ½ç›‘æ§ï¼‰**ï¼šè®°å½•ç”Ÿäº§æ—¶é—´
> 
> SQLå°±æ˜¯å•†å“ï¼Œä¾æ¬¡ç»è¿‡æ¯é“å·¥åºå¤„ç†ã€‚

**ğŸ—ï¸ æ’ä»¶é“¾ç»“æ„**

```
SQLæ‰§è¡Œæµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŸå§‹SQL    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Interceptor æ’ä»¶å®¹å™¨    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ’ä»¶1ï¼šåˆ†é¡µæ‹¦æˆª      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â†“               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ’ä»¶2ï¼šå¤šç§Ÿæˆ·éš”ç¦»    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â†“               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ’ä»¶3ï¼šSQLæ€§èƒ½ç›‘æ§   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœ€ç»ˆSQL    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 å¤šæ’ä»¶é…ç½®


**ğŸ”§ å®Œæ•´é…ç½®ç¤ºä¾‹**

```java
@Configuration
public class MybatisPlusConfig {
    
    @Bean
    public MybatisPlusInterceptor mybatisPlusInterceptor() {
        MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();
        
        // ã€æ’ä»¶1ã€‘åˆ†é¡µæ’ä»¶
        PaginationInnerInterceptor pageInterceptor = 
            new PaginationInnerInterceptor(DbType.MYSQL);
        pageInterceptor.setMaxLimit(500L);
        interceptor.addInnerInterceptor(pageInterceptor);
        
        // ã€æ’ä»¶2ã€‘å¤šç§Ÿæˆ·æ’ä»¶ï¼ˆSaaSç³»ç»Ÿå¸¸ç”¨ï¼‰
        TenantLineInnerInterceptor tenantInterceptor = 
            new TenantLineInnerInterceptor();
        tenantInterceptor.setTenantLineHandler(new TenantLineHandler() {
            @Override
            public Expression getTenantId() {
                // ä»å½“å‰ä¸Šä¸‹æ–‡è·å–ç§Ÿæˆ·ID
                return new LongValue(TenantContext.getTenantId());
            }
            
            @Override
            public String getTenantIdColumn() {
                return "tenant_id";  // ç§Ÿæˆ·IDå­—æ®µå
            }
        });
        interceptor.addInnerInterceptor(tenantInterceptor);
        
        // ã€æ’ä»¶3ã€‘ä¹è§‚é”æ’ä»¶
        OptimisticLockerInnerInterceptor optimisticInterceptor = 
            new OptimisticLockerInnerInterceptor();
        interceptor.addInnerInterceptor(optimisticInterceptor);
        
        // ã€æ’ä»¶4ã€‘é˜²å…¨è¡¨æ›´æ–°åˆ é™¤æ’ä»¶
        BlockAttackInnerInterceptor blockInterceptor = 
            new BlockAttackInnerInterceptor();
        interceptor.addInnerInterceptor(blockInterceptor);
        
        return interceptor;
    }
}
```

### 4.3 æ’ä»¶æ‰§è¡Œé¡ºåº


**âš ï¸ é¡ºåºå¾ˆé‡è¦ï¼**

```markdown
é”™è¯¯é¡ºåºç¤ºä¾‹ï¼š
1. å¤šç§Ÿæˆ·æ’ä»¶ï¼šWHERE tenant_id = 1
2. åˆ†é¡µæ’ä»¶ï¼š   LIMIT 10 OFFSET 0

ç»“æœSQLï¼š
SELECT * FROM user WHERE tenant_id = 1 LIMIT 10 OFFSET 0
é—®é¢˜ï¼šæ²¡æœ‰countæŸ¥è¯¢ï¼

æ­£ç¡®é¡ºåºï¼š
1. åˆ†é¡µæ’ä»¶ï¼ˆå…ˆæ‰§è¡Œcountï¼Œå†åˆ†é¡µï¼‰
2. å¤šç§Ÿæˆ·æ’ä»¶ï¼ˆåœ¨åˆ†é¡µåŸºç¡€ä¸Šæ·»åŠ ç§Ÿæˆ·è¿‡æ»¤ï¼‰

ç»“æœSQLï¼š
Count: SELECT COUNT(*) FROM user WHERE tenant_id = 1
Data:  SELECT * FROM user WHERE tenant_id = 1 LIMIT 10 OFFSET 0
```

**ğŸ“‹ æ¨èé¡ºåº**

```java
// 1ï¸âƒ£ åˆ†é¡µæ’ä»¶ï¼ˆç¬¬ä¸€ä½ï¼Œç¡®ä¿countæ­£ç¡®ï¼‰
interceptor.addInnerInterceptor(paginationInterceptor);

// 2ï¸âƒ£ å¤šç§Ÿæˆ·æ’ä»¶ï¼ˆæ•°æ®éš”ç¦»ï¼‰
interceptor.addInnerInterceptor(tenantInterceptor);

// 3ï¸âƒ£ åŠ¨æ€è¡¨åæ’ä»¶ï¼ˆåˆ†è¡¨é€»è¾‘ï¼‰
interceptor.addInnerInterceptor(dynamicTableNameInterceptor);

// 4ï¸âƒ£ ä¹è§‚é”æ’ä»¶ï¼ˆæ›´æ–°æ§åˆ¶ï¼‰
interceptor.addInnerInterceptor(optimisticLockerInterceptor);

// 5ï¸âƒ£ é˜²å…¨è¡¨æ“ä½œæ’ä»¶ï¼ˆå®‰å…¨ä¿æŠ¤ï¼‰
interceptor.addInnerInterceptor(blockAttackInterceptor);
```

### 4.4 æ€§èƒ½ä¼˜åŒ–å»ºè®®


**âš¡ ä¼˜åŒ–ç­–ç•¥**

```markdown
âœ… **ç­–ç•¥1ï¼šæŒ‰éœ€åŠ è½½æ’ä»¶**
åªæ·»åŠ ä¸šåŠ¡çœŸæ­£éœ€è¦çš„æ’ä»¶ï¼Œé¿å…ä¸å¿…è¦çš„æ€§èƒ½æŸè€—

âœ… **ç­–ç•¥2ï¼šåˆç†é…ç½®ç¼“å­˜**
MyBatisäºŒçº§ç¼“å­˜ + Redisç¼“å­˜åˆ†é¡µç»“æœ

âœ… **ç­–ç•¥3ï¼šSQLä¼˜åŒ–**
â€¢ é¿å…SELECT * ï¼ˆåªæŸ¥éœ€è¦çš„å­—æ®µï¼‰
â€¢ æ·»åŠ åˆé€‚çš„ç´¢å¼•
â€¢ é¿å…æ·±åº¦åˆ†é¡µï¼ˆOFFSETå¤ªå¤§ï¼‰

âœ… **ç­–ç•¥4ï¼šcountæŸ¥è¯¢ä¼˜åŒ–**
â€¢ å¼€å¯optimizeJoin
â€¢ å¤æ‚æŸ¥è¯¢æ‰‹å†™countSql
â€¢ ä½¿ç”¨è¿‘ä¼¼countï¼ˆå…è®¸è¯¯å·®æ—¶ï¼‰
```

---

## 5. ğŸŒ å¤šæ•°æ®åº“æ”¯æŒ


### 5.1 æ•°æ®åº“ç±»å‹é…ç½®


**ğŸ”¸ æ”¯æŒçš„æ•°æ®åº“**

MyBatis-Plusæ”¯æŒçš„ä¸»æµæ•°æ®åº“ï¼š

| æ•°æ®åº“ | DbTypeæšä¸¾ | ç‰ˆæœ¬è¦æ±‚ |
|--------|-----------|----------|
| MySQL | `DbType.MYSQL` | 5.6+ |
| MariaDB | `DbType.MARIADB` | 10.0+ |
| Oracle | `DbType.ORACLE` | 11g+ |
| PostgreSQL | `DbType.POSTGRE_SQL` | 9.4+ |
| SQL Server | `DbType.SQL_SERVER` | 2012+ |
| DB2 | `DbType.DB2` | 10+ |
| H2 | `DbType.H2` | 1.4+ |

**ğŸ”§ é…ç½®æ–¹å¼**

```java
// æ–¹å¼1ï¼šæ‰‹åŠ¨æŒ‡å®šæ•°æ®åº“ç±»å‹
PaginationInnerInterceptor interceptor = 
    new PaginationInnerInterceptor(DbType.MYSQL);

// æ–¹å¼2ï¼šè‡ªåŠ¨è¯†åˆ«ï¼ˆä»æ•°æ®æºæ¨æ–­ï¼‰
PaginationInnerInterceptor interceptor = 
    new PaginationInnerInterceptor();
// æ’ä»¶ä¼šè‡ªåŠ¨ä»JDBC URLè¯†åˆ«æ•°æ®åº“ç±»å‹
```

### 5.2 ä¸åŒæ•°æ®åº“çš„åˆ†é¡µå®ç°


**ğŸ“ å„æ•°æ®åº“åˆ†é¡µSQLå¯¹æ¯”**

```sql
-- ã€MySQL / PostgreSQLã€‘
SELECT * FROM user 
WHERE age > 18 
ORDER BY id 
LIMIT 10 OFFSET 20;

-- ã€Oracle 12c+ã€‘
SELECT * FROM user 
WHERE age > 18 
ORDER BY id 
OFFSET 20 ROWS FETCH NEXT 10 ROWS ONLY;

-- ã€Oracle 11gã€‘ä½¿ç”¨ROWNUM
SELECT * FROM (
    SELECT a.*, ROWNUM rn FROM (
        SELECT * FROM user WHERE age > 18 ORDER BY id
    ) a WHERE ROWNUM <= 30
) WHERE rn > 20;

-- ã€SQL Server 2012+ã€‘
SELECT * FROM user 
WHERE age > 18 
ORDER BY id 
OFFSET 20 ROWS FETCH NEXT 10 ROWS ONLY;

-- ã€SQL Server 2008ã€‘ä½¿ç”¨ROW_NUMBER()
SELECT * FROM (
    SELECT *, ROW_NUMBER() OVER(ORDER BY id) AS rn 
    FROM user WHERE age > 18
) t WHERE rn BETWEEN 21 AND 30;
```

### 5.3 å¤šæ•°æ®æºåœºæ™¯é…ç½®


**ğŸ”„ åŠ¨æ€æ•°æ®æºåˆ†é¡µ**

```java
@Configuration
public class MultiDataSourceConfig {
    
    /**
     * ä¸»æ•°æ®æºï¼ˆMySQLï¼‰
     */
    @Bean
    @Primary
    public DataSource masterDataSource() {
        return DataSourceBuilder.create()
            .url("jdbc:mysql://localhost:3306/db_master")
            .build();
    }
    
    /**
     * ä»æ•°æ®æºï¼ˆPostgreSQLï¼‰
     */
    @Bean
    public DataSource slaveDataSource() {
        return DataSourceBuilder.create()
            .url("jdbc:postgresql://localhost:5432/db_slave")
            .build();
    }
    
    /**
     * åŠ¨æ€æ•°æ®æº
     */
    @Bean
    public DataSource dynamicDataSource() {
        Map<Object, Object> targetDataSources = new HashMap<>();
        targetDataSources.put("master", masterDataSource());
        targetDataSources.put("slave", slaveDataSource());
        
        DynamicDataSource dataSource = new DynamicDataSource();
        dataSource.setTargetDataSources(targetDataSources);
        dataSource.setDefaultTargetDataSource(masterDataSource());
        return dataSource;
    }
    
    /**
     * åˆ†é¡µæ’ä»¶ï¼ˆè‡ªåŠ¨é€‚é…æ•°æ®åº“ç±»å‹ï¼‰
     */
    @Bean
    public MybatisPlusInterceptor interceptor() {
        MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();
        
        // ä¸æŒ‡å®šDbTypeï¼Œè®©æ’ä»¶è‡ªåŠ¨è¯†åˆ«
        PaginationInnerInterceptor pageInterceptor = 
            new PaginationInnerInterceptor();
        pageInterceptor.setMaxLimit(500L);
        
        interceptor.addInnerInterceptor(pageInterceptor);
        return interceptor;
    }
}
```

**ğŸ’¡ è‡ªåŠ¨è¯†åˆ«åŸç†**

```
æ’ä»¶å¦‚ä½•è¯†åˆ«æ•°æ®åº“ç±»å‹ï¼Ÿ

1. è·å–æ•°æ®æºè¿æ¥
   â†“
2. è¯»å–JDBC URL
   jdbc:mysql://localhost:3306/db
   â†“
3. è§£æåè®®éƒ¨åˆ†ï¼ˆmysqlï¼‰
   â†“
4. åŒ¹é…å¯¹åº”çš„DbType
   â†“
5. ä½¿ç”¨å¯¹åº”çš„SQLæ–¹è¨€
```

### 5.4 æ•°æ®åº“å…¼å®¹æ€§æ³¨æ„äº‹é¡¹


**âš ï¸ å¸¸è§é—®é¢˜**

```markdown
âŒ **é—®é¢˜1ï¼šOracleæ·±åº¦åˆ†é¡µæ…¢**
åŸå› ï¼šROWNUMæ–¹å¼éœ€è¦å…¨è¡¨æ‰«æ
è§£å†³ï¼š
â€¢ ä½¿ç”¨æ¸¸æ ‡åˆ†é¡µ
â€¢ é™åˆ¶æœ€å¤§é¡µç 
â€¢ ä½¿ç”¨OFFSET FETCHï¼ˆ12c+ï¼‰

âŒ **é—®é¢˜2ï¼šSQL Serveræ’åºé—®é¢˜**
åŸå› ï¼šOFFSETå¿…é¡»é…åˆORDER BY
è§£å†³ï¼šç¡®ä¿åˆ†é¡µæŸ¥è¯¢éƒ½æœ‰ORDER BY

âŒ **é—®é¢˜3ï¼šPostgreSQLå¤§æ•°æ®é‡countæ…¢**
åŸå› ï¼šcount(*)å…¨è¡¨æ‰«æ
è§£å†³ï¼š
â€¢ ä½¿ç”¨ç»Ÿè®¡è¡¨è®°å½•æ€»æ•°
â€¢ ä¼°ç®—è¡Œæ•°ï¼šSELECT reltuples FROM pg_class
â€¢ åˆ†æ®µcount

âŒ **é—®é¢˜4ï¼šMySQL LIMITæ€§èƒ½ä¸‹é™**
åŸå› ï¼šOFFSETè¿‡å¤§ï¼Œéœ€è¦è·³è¿‡å¤§é‡è¡Œ
è§£å†³ï¼š
â€¢ ä½¿ç”¨æ¸¸æ ‡åˆ†é¡µï¼ˆWHERE id > last_idï¼‰
â€¢ é™åˆ¶æœ€å¤§é¡µæ•°
â€¢ ä½¿ç”¨å»¶è¿Ÿå…³è”ä¼˜åŒ–
```

**âœ… æœ€ä½³å®è·µ**

```java
// ã€å®è·µ1ã€‘é™åˆ¶æ·±åº¦åˆ†é¡µ
paginationInterceptor.setMaxLimit(500L);  // å•é¡µæœ€å¤š500æ¡
// ä¸šåŠ¡å±‚é™åˆ¶æœ€å¤§é¡µæ•°
if (pageNum > 100) {
    throw new BusinessException("ä¸æ”¯æŒè¶…è¿‡100é¡µ");
}

// ã€å®è·µ2ã€‘countä¼˜åŒ–
paginationInterceptor.setOptimizeJoin(true);
// æˆ–æ‰‹åŠ¨æŒ‡å®šcountSql
@Select("SELECT COUNT(*) FROM user WHERE status = 1")
Long countActiveUsers();

// ã€å®è·µ3ã€‘ä½¿ç”¨æ¸¸æ ‡åˆ†é¡µ
// é€‚åˆå¤§æ•°æ®é‡åœºæ™¯
public List<User> getCursorPage(Long lastId, int size) {
    return userMapper.selectList(
        Wrappers.<User>lambdaQuery()
            .gt(User::getId, lastId)  // æ¸¸æ ‡ä½ç½®
            .orderByAsc(User::getId)
            .last("LIMIT " + size)
    );
}
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```markdown
ğŸ”¸ åˆ†é¡µæ’ä»¶æœ¬è´¨ï¼šMyBatisæ‹¦æˆªå™¨ + SQLæ”¹å†™å™¨
ğŸ”¸ å·¥ä½œåŸç†ï¼šæ‹¦æˆªSQL â†’ ç”Ÿæˆcount â†’ æ”¹å†™åˆ†é¡µ â†’ è¿”å›ç»“æœ
ğŸ”¸ æ ¸å¿ƒç»„ä»¶ï¼šPaginationInnerInterceptor
ğŸ”¸ é…ç½®è¦ç‚¹ï¼šDbTypeã€maxLimitã€optimizeJoin
ğŸ”¸ æ’ä»¶é¡ºåºï¼šåˆ†é¡µåœ¨å‰ï¼Œå…¶ä»–åœ¨å
```

### 6.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆéœ€è¦åˆ†é¡µæ’ä»¶ï¼Ÿ**
```
æ‰‹åŠ¨åˆ†é¡µçš„ç—›ç‚¹ï¼š
âŒ æ¯ä¸ªæŸ¥è¯¢éƒ½è¦å†™LIMIT
âŒ æ‰‹åŠ¨è®¡ç®—OFFSET
âŒ å•ç‹¬å†™countæŸ¥è¯¢
âŒ ä¸åŒæ•°æ®åº“è¯­æ³•ä¸åŒ

ä½¿ç”¨æ’ä»¶åï¼š
âœ… è‡ªåŠ¨å¤„ç†åˆ†é¡µé€»è¾‘
âœ… è‡ªåŠ¨countç»Ÿè®¡
âœ… è‡ªåŠ¨é€‚é…æ•°æ®åº“
âœ… æ€§èƒ½è‡ªåŠ¨ä¼˜åŒ–
```

**ğŸ”¹ SQLé‡å†™çš„æ ¸å¿ƒé€»è¾‘**
```
åŸå§‹SQLï¼šSELECT * FROM user WHERE age > 18

é‡å†™ä¸ºä¸¤æ¡SQLï¼š
1. COUNTæŸ¥è¯¢ï¼š
   SELECT COUNT(*) FROM user WHERE age > 18
   ä½œç”¨ï¼šè·å–æ€»è®°å½•æ•°

2. åˆ†é¡µæŸ¥è¯¢ï¼š
   SELECT * FROM user WHERE age > 18 LIMIT 10 OFFSET 0
   ä½œç”¨ï¼šè·å–å½“å‰é¡µæ•°æ®
```

**ğŸ”¹ æ’ä»¶é“¾æ‰§è¡Œæœºåˆ¶**
```
å¤šä¸ªæ’ä»¶çš„æ‰§è¡Œé¡ºåºï¼š
SQL â†’ æ’ä»¶1 â†’ æ’ä»¶2 â†’ æ’ä»¶3 â†’ æœ€ç»ˆSQL

é¡ºåºå½±å“ç»“æœï¼š
é”™è¯¯ï¼šåˆ†é¡µååŠ ç§Ÿæˆ· â†’ counté”™è¯¯
æ­£ç¡®ï¼šåˆ†é¡µåœ¨æœ€å‰é¢ â†’ countå‡†ç¡®
```

### 6.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ’¼ ä¸šåŠ¡åœºæ™¯åº”ç”¨**
- **åˆ—è¡¨æŸ¥è¯¢**ï¼šå•†å“åˆ—è¡¨ã€è®¢å•åˆ—è¡¨ã€ç”¨æˆ·åˆ—è¡¨
- **æœç´¢ç»“æœ**ï¼šå…¨æ–‡æ£€ç´¢ã€æ¡ä»¶ç­›é€‰
- **æ•°æ®å¯¼å‡º**ï¼šåˆ†æ‰¹å¯¼å‡ºå¤§é‡æ•°æ®
- **æŠ¥è¡¨å±•ç¤º**ï¼šç»Ÿè®¡æ•°æ®åˆ†é¡µå±•ç¤º

**ğŸ”§ æ€§èƒ½ä¼˜åŒ–å®è·µ**
- **countä¼˜åŒ–**ï¼šå»é™¤ä¸å¿…è¦çš„JOIN
- **æ·±åº¦åˆ†é¡µ**ï¼šä½¿ç”¨æ¸¸æ ‡æ›¿ä»£OFFSET
- **ç¼“å­˜ç­–ç•¥**ï¼šç¼“å­˜countç»“æœ
- **ç´¢å¼•ä¼˜åŒ–**ï¼šORDER BYå­—æ®µåŠ ç´¢å¼•

### 6.4 å¸¸è§é—®é¢˜é€ŸæŸ¥


| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| åˆ†é¡µä¸ç”Ÿæ•ˆ | æœªé…ç½®æ‹¦æˆªå™¨ | æ£€æŸ¥@Beané…ç½® |
| countæŸ¥è¯¢æ…¢ | å¤æ‚JOIN | å¼€å¯optimizeJoin |
| æ·±åº¦åˆ†é¡µæ…¢ | OFFSETè¿‡å¤§ | ä½¿ç”¨æ¸¸æ ‡åˆ†é¡µ |
| è¶…é¡µæ— æ•°æ® | overflow=false | è®¾ç½®overflow=true |
| å¤šæ•°æ®æºé”™è¯¯ | DbTypeå†™æ­» | ä½¿ç”¨è‡ªåŠ¨è¯†åˆ« |

### 6.5 å­¦ä¹ æ£€æŸ¥æ¸…å•


**âœ… åŸºç¡€æŒæ¡**
- [ ] ç†è§£åˆ†é¡µæ’ä»¶çš„ä½œç”¨å’ŒåŸç†
- [ ] ä¼šé…ç½®PaginationInnerInterceptor
- [ ] ç†è§£SQLé‡å†™æœºåˆ¶
- [ ] æŒæ¡åŸºæœ¬çš„åˆ†é¡µæŸ¥è¯¢

**âœ… è¿›é˜¶åº”ç”¨**
- [ ] é…ç½®å¤šæ’ä»¶é“¾
- [ ] ä¼˜åŒ–countæŸ¥è¯¢æ€§èƒ½
- [ ] å¤„ç†æ·±åº¦åˆ†é¡µé—®é¢˜
- [ ] å¤šæ•°æ®æºåˆ†é¡µé…ç½®

**âœ… é«˜çº§ä¼˜åŒ–**
- [ ] æ¸¸æ ‡åˆ†é¡µå®ç°
- [ ] è‡ªå®šä¹‰åˆ†é¡µç­–ç•¥
- [ ] åˆ†é¡µç¼“å­˜æ–¹æ¡ˆ
- [ ] æ€§èƒ½ç›‘æ§ä¸è°ƒä¼˜

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
åˆ†é¡µæ’ä»¶æ‹¦æˆªå™¨ï¼ŒSQLæ”¹å†™è‡ªåŠ¨åŒ–
CountæŸ¥è¯¢å…ˆæ‰§è¡Œï¼Œåˆ†é¡µæ•°æ®åè·å–
æ’ä»¶é¡ºåºæœ‰è®²ç©¶ï¼Œåˆ†é¡µå¿…é¡»æ’ç¬¬ä¸€
å¤šåº“æ”¯æŒèƒ½è‡ªé€‚ï¼Œæ€§èƒ½ä¼˜åŒ–æœ‰ç­–ç•¥
```

---

**ğŸ¯ ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®®**

1. **å®è·µæ“ä½œ**ï¼šåœ¨é¡¹ç›®ä¸­é…ç½®åˆ†é¡µæ’ä»¶
2. **æ€§èƒ½æµ‹è¯•**ï¼šå¯¹æ¯”ä¼˜åŒ–å‰åçš„æ€§èƒ½å·®å¼‚
3. **æ·±å…¥æºç **ï¼šé˜…è¯»PaginationInnerInterceptoræºç 
4. **æ‰©å±•å­¦ä¹ **ï¼šäº†è§£å…¶ä»–æ‹¦æˆªå™¨çš„å®ç°åŸç†