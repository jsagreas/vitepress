---
title: 56ã€SQLæ³¨å…¥é˜²æŠ¤
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯SQLæ³¨å…¥](#1-ä»€ä¹ˆæ˜¯SQLæ³¨å…¥)
2. [MyBatis-Plusçš„å®‰å…¨æœºåˆ¶](#2-MyBatis-Plusçš„å®‰å…¨æœºåˆ¶)
3. [å‚æ•°åŒ–æŸ¥è¯¢çš„æ­£ç¡®ä½¿ç”¨](#3-å‚æ•°åŒ–æŸ¥è¯¢çš„æ­£ç¡®ä½¿ç”¨)
4. [Wrapperæ¡ä»¶æ„é€ å™¨å®‰å…¨å®è·µ](#4-Wrapperæ¡ä»¶æ„é€ å™¨å®‰å…¨å®è·µ)
5. [ç‰¹æ®Šå­—ç¬¦å¤„ç†ä¸è½¬ä¹‰](#5-ç‰¹æ®Šå­—ç¬¦å¤„ç†ä¸è½¬ä¹‰)
6. [ç™½åå•æœºåˆ¶è®¾è®¡](#6-ç™½åå•æœºåˆ¶è®¾è®¡)
7. [è¾“å…¥å‚æ•°æ ¡éªŒç­–ç•¥](#7-è¾“å…¥å‚æ•°æ ¡éªŒç­–ç•¥)
8. [å®‰å…¨ç¼–ç è§„èŒƒä¸æœ€ä½³å®è·µ](#8-å®‰å…¨ç¼–ç è§„èŒƒä¸æœ€ä½³å®è·µ)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”’ ä»€ä¹ˆæ˜¯SQLæ³¨å…¥


### 1.1 æ¦‚å¿µç†è§£


SQLæ³¨å…¥ï¼Œç®€å•æ¥è¯´å°±æ˜¯**åäººé€šè¿‡è¾“å…¥æ¡†å·å·å¡è¿›æ¶æ„çš„SQLä»£ç ï¼Œè®©ä½ çš„æ•°æ®åº“æ‰§è¡Œäº†ä¸è¯¥æ‰§è¡Œçš„æ“ä½œ**ã€‚

ğŸŒ° **ç”Ÿæ´»ç±»æ¯”**ï¼šå°±åƒä½ ç‚¹å¤–å–æ—¶ï¼Œåœ¨"å¤‡æ³¨"é‡Œå†™"å†é€ä¸¤ä»½"ï¼Œç»“æœå•†å®¶çœŸçš„ç»™ä½ å¤šé€äº†ä¸¤ä»½â€”â€”è¿™å°±æ˜¯åˆ©ç”¨äº†ç³»ç»Ÿçš„æ¼æ´ã€‚

**ğŸ”¸ æ”»å‡»åŸç†ç¤ºæ„**
```
æ­£å¸¸æŸ¥è¯¢æµç¨‹ï¼š
ç”¨æˆ·è¾“å…¥: "å¼ ä¸‰"
SQLè¯­å¥: SELECT * FROM user WHERE name = 'å¼ ä¸‰'
ç»“æœ: æŸ¥åˆ°å¼ ä¸‰çš„ä¿¡æ¯ âœ…

æ¶æ„æ³¨å…¥æµç¨‹ï¼š
ç”¨æˆ·è¾“å…¥: "å¼ ä¸‰' OR '1'='1"
SQLè¯­å¥: SELECT * FROM user WHERE name = 'å¼ ä¸‰' OR '1'='1'
ç»“æœ: æŸ¥åˆ°æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯ï¼âŒ
```

### 1.2 å¸¸è§æ³¨å…¥åœºæ™¯


**ğŸ”¸ åœºæ™¯1ï¼šç™»å½•ç»•è¿‡**
```java
// âŒ å±é™©å†™æ³•ï¼ˆç›´æ¥æ‹¼æ¥SQLï¼‰
String username = request.getParameter("username"); // è¾“å…¥: admin' OR '1'='1
String sql = "SELECT * FROM user WHERE username = '" + username + "'";
// å®é™…æ‰§è¡Œ: SELECT * FROM user WHERE username = 'admin' OR '1'='1'
// ç»“æœï¼šä¸éœ€è¦å¯†ç å°±èƒ½ç™»å½•ï¼
```

**ğŸ”¸ åœºæ™¯2ï¼šæ•°æ®æ³„éœ²**
```java
// âŒ å±é™©å†™æ³•
String keyword = request.getParameter("keyword"); // è¾“å…¥: ' UNION SELECT password FROM admin--
String sql = "SELECT * FROM article WHERE title LIKE '%" + keyword + "%'";
// å®é™…æ‰§è¡Œ: SELECT * FROM article WHERE title LIKE '%' UNION SELECT password FROM admin--%'
// ç»“æœï¼šé»‘å®¢æ‹¿åˆ°äº†ç®¡ç†å‘˜å¯†ç ï¼
```

**ğŸ”¸ åœºæ™¯3ï¼šæ•°æ®åˆ é™¤**
```java
// âŒ å±é™©å†™æ³•
String userId = request.getParameter("id"); // è¾“å…¥: 1; DROP TABLE user--
String sql = "DELETE FROM cart WHERE user_id = " + userId;
// å®é™…æ‰§è¡Œ: DELETE FROM cart WHERE user_id = 1; DROP TABLE user--
// ç»“æœï¼šæ•´ä¸ªç”¨æˆ·è¡¨è¢«åˆ é™¤ï¼
```

### 1.3 å±å®³ç¨‹åº¦åˆ†æ


| å±å®³ç±»å‹ | **å…·ä½“å½±å“** | **ä¸¥é‡ç­‰çº§** | **çœŸå®æ¡ˆä¾‹** |
|---------|------------|------------|-------------|
| ğŸ”´ **æ•°æ®æ³„éœ²** | `ç”¨æˆ·ä¿¡æ¯ã€å¯†ç ã€å•†ä¸šæœºå¯†` | `æé«˜` | `æŸç”µå•†å¹³å°åƒä¸‡ç”¨æˆ·æ•°æ®æ³„éœ²` |
| ğŸ”´ **æ•°æ®ç¯¡æ”¹** | `è®¢å•é‡‘é¢ã€æƒé™ç­‰çº§` | `æé«˜` | `æŸæ¸¸æˆå¹³å°è¢«åˆ·è£…å¤‡` |
| ğŸ”´ **æ•°æ®åˆ é™¤** | `æ ¸å¿ƒä¸šåŠ¡æ•°æ®ä¸¢å¤±` | `è‡´å‘½` | `æŸå…¬å¸æ•°æ®åº“è¢«æ¸…ç©º` |
| ğŸŸ¡ **æƒé™æå‡** | `æ™®é€šç”¨æˆ·å˜ç®¡ç†å‘˜` | `é«˜` | `æŸè®ºå›è¢«å…¥ä¾µè·å–ç®¡ç†æƒ` |

---

## 2. ğŸ›¡ï¸ MyBatis-Plusçš„å®‰å…¨æœºåˆ¶


### 2.1 æ¡†æ¶å†…ç½®é˜²æŠ¤


MyBatis-Plusé»˜è®¤å°±å¸®ä½ åšäº†å¾ˆå¤šå®‰å…¨é˜²æŠ¤ï¼Œ**åªè¦ä½ æŒ‰æ­£ç¡®æ–¹å¼ä½¿ç”¨ï¼ŒåŸºæœ¬ä¸ä¼šå‡ºé—®é¢˜**ã€‚

**ğŸ”¸ æ ¸å¿ƒé˜²æŠ¤æœºåˆ¶**

```
ç”¨æˆ·è¾“å…¥ â†’ å‚æ•°é¢„å¤„ç† â†’ å‚æ•°ç»‘å®š â†’ SQLæ‰§è¡Œ
              â†“
         è‡ªåŠ¨è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦
         é˜²æ­¢SQLä»£ç æ³¨å…¥
```

**ğŸ’¡ å·¥ä½œåŸç†**
```
ä¼ ç»Ÿæ‹¼æ¥ï¼ˆå±é™©ï¼‰ï¼š
"SELECT * FROM user WHERE name = '" + name + "'"
â†“ å¦‚æœnameæ˜¯æ¶æ„ä»£ç ï¼Œç›´æ¥è¢«æ‰§è¡Œ

MyBatis-Plusï¼ˆå®‰å…¨ï¼‰ï¼š
"SELECT * FROM user WHERE name = ?"
â†“ ?å¤„çš„å†…å®¹ä¼šè¢«å½“ä½œ"çº¯æ•°æ®"å¤„ç†ï¼Œä¸ä¼šå½“ä½œSQLä»£ç 
```

### 2.2 é¢„ç¼–è¯‘æœºåˆ¶è¯¦è§£


**ğŸ”¹ ä»€ä¹ˆæ˜¯é¢„ç¼–è¯‘ï¼Ÿ**

å°±åƒåšé¥­æ—¶å…ˆæŠŠèœè°±ï¼ˆSQLæ¨¡æ¿ï¼‰å‡†å¤‡å¥½ï¼Œé£Ÿæï¼ˆç”¨æˆ·è¾“å…¥ï¼‰åé¢å†æ”¾è¿›å»ï¼Œ**èœè°±ä¸ä¼šå› ä¸ºé£Ÿæè€Œæ”¹å˜**ã€‚

```
æ­¥éª¤1: å‡†å¤‡SQLæ¨¡æ¿
SELECT * FROM user WHERE id = ? AND status = ?
                           â†‘              â†‘
                         å ä½ç¬¦          å ä½ç¬¦

æ­¥éª¤2: ç»‘å®šå‚æ•°ï¼ˆMyBatis-Plusè‡ªåŠ¨å®Œæˆï¼‰
? â†’ 123 ï¼ˆç”¨æˆ·IDï¼‰
? â†’ "active" ï¼ˆçŠ¶æ€ï¼‰

æ­¥éª¤3: æ‰§è¡ŒSQL
å‚æ•°ä¼šè¢«å½“ä½œ"çº¯æ–‡æœ¬æ•°æ®"ï¼Œä¸ä¼šè¢«å½“ä½œSQLä»£ç æ‰§è¡Œ
```

**ğŸ”¸ è‡ªåŠ¨é˜²æŠ¤ç¤ºä¾‹**
```java
// âœ… å®‰å…¨å†™æ³•ï¼ˆMyBatis-Plusè‡ªåŠ¨é˜²æŠ¤ï¼‰
LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();
wrapper.eq(User::getName, "å¼ ä¸‰' OR '1'='1");

// å®é™…æ‰§è¡Œçš„SQLï¼š
// SELECT * FROM user WHERE name = ?
// å‚æ•°å€¼: "å¼ ä¸‰' OR '1'='1" ï¼ˆè¢«å½“ä½œæ™®é€šå­—ç¬¦ä¸²ï¼‰
// æŸ¥è¯¢ç»“æœ: æ‰¾ä¸åˆ°è¿™ä¸ªå¥‡æ€ªåå­—çš„ç”¨æˆ·ï¼ˆå®‰å…¨ï¼ï¼‰
```

### 2.3 ä¸‰å±‚é˜²æŠ¤ä½“ç³»


```
ç¬¬ä¸€å±‚ï¼šå‚æ•°åŒ–æŸ¥è¯¢ï¼ˆé¢„ç¼–è¯‘ï¼‰
   â†“
æ‰€æœ‰ç”¨æˆ·è¾“å…¥éƒ½ä¸ä¼šç›´æ¥æ‹¼æ¥åˆ°SQLä¸­

ç¬¬äºŒå±‚ï¼šç±»å‹æ£€æŸ¥
   â†“  
å‚æ•°ç±»å‹å¿…é¡»åŒ¹é…ï¼ˆæ•°å­—å°±æ˜¯æ•°å­—ï¼Œå­—ç¬¦ä¸²å°±æ˜¯å­—ç¬¦ä¸²ï¼‰

ç¬¬ä¸‰å±‚ï¼šæ¡†æ¶æ ¡éªŒ
   â†“
MyBatis-Plusä¼šæ£€æŸ¥SQLè¯­æ³•çš„åˆæ³•æ€§
```

---

## 3. âœ… å‚æ•°åŒ–æŸ¥è¯¢çš„æ­£ç¡®ä½¿ç”¨


### 3.1 åŸºç¡€CRUDæ“ä½œ


**ğŸ”¸ å•ä¸ªæ¡ä»¶æŸ¥è¯¢**
```java
// âœ… æ­£ç¡®ï¼šä½¿ç”¨Lambdaè¡¨è¾¾å¼ï¼ˆå®Œå…¨å®‰å…¨ï¼‰
LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();
wrapper.eq(User::getUsername, username); // è‡ªåŠ¨å‚æ•°åŒ–
User user = userMapper.selectOne(wrapper);

// âœ… æ­£ç¡®ï¼šä½¿ç”¨æ™®é€šWrapper
QueryWrapper<User> wrapper = new QueryWrapper<>();
wrapper.eq("username", username); // å­—æ®µåç”¨å­—ç¬¦ä¸²ï¼Œå€¼è‡ªåŠ¨å‚æ•°åŒ–
```

**ğŸ”¸ å¤šä¸ªæ¡ä»¶ç»„åˆ**
```java
// âœ… æ­£ç¡®ï¼šé“¾å¼è°ƒç”¨ï¼ˆæ¯ä¸ªå‚æ•°éƒ½å®‰å…¨ï¼‰
LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();
wrapper.eq(User::getStatus, status)        // å‚æ•°åŒ–
       .ge(User::getAge, minAge)           // å‚æ•°åŒ–
       .like(User::getName, keyword);      // å‚æ•°åŒ–ï¼ˆæ¨¡ç³ŠæŸ¥è¯¢ä¹Ÿå®‰å…¨ï¼‰
       
List<User> users = userMapper.selectList(wrapper);
```

### 3.2 åŠ¨æ€SQLåœºæ™¯


**ğŸ”¸ æ¡ä»¶é€‰æ‹©æ€§æ·»åŠ **
```java
// âœ… æ­£ç¡®ï¼šæ ¹æ®æ¡ä»¶åŠ¨æ€æ„å»ºï¼ˆå®‰å…¨ï¼‰
LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();

// åªæœ‰usernameä¸ä¸ºç©ºæ—¶æ‰æ·»åŠ æ¡ä»¶
wrapper.eq(StringUtils.isNotBlank(username), User::getUsername, username);

// åªæœ‰å¹´é¾„èŒƒå›´æœ‰æ•ˆæ—¶æ‰æ·»åŠ 
wrapper.between(minAge != null && maxAge != null, User::getAge, minAge, maxAge);

// ç­‰ä»·äºä¼ ç»Ÿå†™æ³•ï¼Œä½†æ›´ç®€æ´å®‰å…¨
```

**ğŸ”¸ å¤æ‚ä¸šåŠ¡é€»è¾‘**
```java
// âœ… æ­£ç¡®ï¼šä½¿ç”¨and/oråˆ†ç»„ï¼ˆæ¡ç†æ¸…æ™°åˆå®‰å…¨ï¼‰
LambdaQueryWrapper<Order> wrapper = new LambdaQueryWrapper<>();
wrapper.eq(Order::getUserId, userId)
       .and(w -> w.eq(Order::getStatus, "å·²æ”¯ä»˜")
                  .or()
                  .eq(Order::getStatus, "å·²å‘è´§"));

// ç”ŸæˆSQL: WHERE user_id = ? AND (status = ? OR status = ?)
// æ‰€æœ‰?éƒ½æ˜¯å‚æ•°åŒ–çš„ï¼Œå®Œå…¨å®‰å…¨
```

### 3.3 ç‰¹æ®Šåœºæ™¯å¤„ç†


**ğŸ”¸ INæŸ¥è¯¢ï¼ˆå¤šä¸ªå€¼ï¼‰**
```java
// âœ… æ­£ç¡®ï¼šä½¿ç”¨inæ–¹æ³•ï¼ˆé›†åˆå‚æ•°è‡ªåŠ¨å¤„ç†ï¼‰
List<Long> userIds = Arrays.asList(1L, 2L, 3L);
LambdaQueryWrapper<Order> wrapper = new LambdaQueryWrapper<>();
wrapper.in(Order::getUserId, userIds);

// ç”ŸæˆSQL: WHERE user_id IN (?, ?, ?)
// æ¯ä¸ª?éƒ½å¯¹åº”ä¸€ä¸ªå‚æ•°ï¼Œå®‰å…¨
```

**ğŸ”¸ LIKEæ¨¡ç³ŠæŸ¥è¯¢**
```java
// âœ… æ­£ç¡®ï¼šMyBatis-Plusè‡ªåŠ¨å¤„ç†é€šé…ç¬¦
String keyword = request.getParameter("keyword");
LambdaQueryWrapper<Article> wrapper = new LambdaQueryWrapper<>();
wrapper.like(Article::getTitle, keyword); // æ¡†æ¶è‡ªåŠ¨æ·»åŠ %ï¼Œå‚æ•°åŒ–

// âœ… ä¹Ÿå¯ä»¥æ˜ç¡®æŒ‡å®šæ¨¡ç³Šä½ç½®
wrapper.likeRight(Article::getTitle, keyword);  // keyword%
wrapper.likeLeft(Article::getTitle, keyword);   // %keyword
```

---

## 4. ğŸ” Wrapperæ¡ä»¶æ„é€ å™¨å®‰å…¨å®è·µ


### 4.1 å®‰å…¨çš„å­—æ®µå¼•ç”¨


**ğŸ”¸ æ¨èæ–¹å¼å¯¹æ¯”**

| æ–¹å¼ | **ä»£ç ç¤ºä¾‹** | **å®‰å…¨æ€§** | **æ¨èåº¦** | **è¯´æ˜** |
|-----|------------|----------|----------|----------|
| â­ **Lambdaè¡¨è¾¾å¼** | `wrapper.eq(User::getName, value)` | `æœ€é«˜` | `â­â­â­â­â­` | `ç¼–è¯‘æœŸæ£€æŸ¥ï¼Œæ— æ³•æ³¨å…¥` |
| âœ… **å­—ç¬¦ä¸²å­—æ®µå** | `wrapper.eq("name", value)` | `é«˜` | `â­â­â­â­` | `å­—æ®µåå†™æ­»ï¼Œå€¼å‚æ•°åŒ–` |
| âš ï¸ **åŠ¨æ€å­—æ®µå** | `wrapper.eq(fieldName, value)` | `ä¸­` | `â­â­â­` | `éœ€é…åˆç™½åå•éªŒè¯` |
| âŒ **SQLç‰‡æ®µ** | `wrapper.apply(sqlSegment)` | `ä½` | `â­` | `æ…ç”¨ï¼Œæ˜“å‡ºé”™` |

**ğŸ”¸ æœ€å®‰å…¨å†™æ³•ï¼ˆLambdaï¼‰**
```java
// âœ… æ¨èï¼šä½¿ç”¨æ–¹æ³•å¼•ç”¨ï¼ˆ100%å®‰å…¨ï¼‰
LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();
wrapper.eq(User::getName, userName)           // å­—æ®µååœ¨ç¼–è¯‘æ—¶ç¡®å®š
       .eq(User::getStatus, userStatus)       // ä¸å¯èƒ½è¢«æ³¨å…¥
       .ge(User::getCreateTime, startTime);   // ç±»å‹è‡ªåŠ¨åŒ¹é…
```

### 4.2 å±é™©æ“ä½œè¯†åˆ«


**ğŸ”¸ applyæ–¹æ³•çš„é£é™©**
```java
// âŒ å±é™©ï¼šç›´æ¥æ‹¼æ¥SQLç‰‡æ®µ
String condition = request.getParameter("condition");
wrapper.apply(condition); // å¦‚æœconditionæ˜¯æ¶æ„SQLï¼Œç›´æ¥æ‰§è¡Œï¼

// âŒ å±é™©ç¤ºä¾‹
String input = "1=1 OR id IN (SELECT id FROM admin)";
wrapper.apply(input); // æ•´ä¸ªSQLéƒ½è¢«æ”¹å˜äº†ï¼

// âœ… å®‰å…¨æ›¿ä»£æ–¹æ¡ˆ
if ("vip".equals(userType)) {
    wrapper.eq(User::getVipLevel, level); // ç”¨æ­£å¸¸æ–¹æ³•æ›¿ä»£apply
}
```

**ğŸ”¸ lastæ–¹æ³•çš„éšæ‚£**
```java
// âŒ å±é™©ï¼šåœ¨SQLæœ«å°¾è¿½åŠ å†…å®¹
String orderBy = request.getParameter("orderBy");
wrapper.last("ORDER BY " + orderBy); // å¯èƒ½è¢«æ³¨å…¥

// âœ… å®‰å…¨å†™æ³•ï¼šä½¿ç”¨æ¡†æ¶æä¾›çš„æ’åºæ–¹æ³•
wrapper.orderByDesc(User::getCreateTime);
wrapper.orderByAsc(User::getAge);

// å¦‚æœå¿…é¡»åŠ¨æ€æ’åºï¼Œä½¿ç”¨ç™½åå•
String orderBy = validateOrderBy(request.getParameter("orderBy"));
wrapper.orderBy(true, isAsc, orderBy);
```

### 4.3 å®‰å…¨æ„å»ºæŠ€å·§


**ğŸ”¸ ä½¿ç”¨æ¡ä»¶ç»„åˆ**
```java
// âœ… å®‰å…¨ï¼šæ¸…æ™°çš„ä¸šåŠ¡é€»è¾‘è¡¨è¾¾
LambdaQueryWrapper<Product> wrapper = new LambdaQueryWrapper<>();

// åœºæ™¯ï¼šæŸ¥è¯¢ç‰¹å®šåˆ†ç±»ä¸‹çš„çƒ­é—¨å•†å“
wrapper.eq(Product::getCategoryId, categoryId)
       .and(w -> w.ge(Product::getSales, 1000)
                  .or()
                  .ge(Product::getViewCount, 10000))
       .eq(Product::getStatus, "ä¸Šæ¶");

// ç”Ÿæˆçš„SQLé€»è¾‘æ¸…æ™°ï¼Œå‚æ•°å…¨éƒ¨å®‰å…¨
```

**ğŸ”¸ åµŒå¥—æ¡ä»¶å¤„ç†**
```java
// âœ… å®‰å…¨ï¼šå¤æ‚åµŒå¥—æ¡ä»¶
LambdaQueryWrapper<Order> wrapper = new LambdaQueryWrapper<>();

wrapper.nested(w -> 
    w.eq(Order::getPayStatus, "å·²æ”¯ä»˜")
     .eq(Order::getShipStatus, "æœªå‘è´§")
).or().nested(w ->
    w.eq(Order::getPayStatus, "å¾…æ”¯ä»˜")
     .lt(Order::getCreateTime, deadlineTime)
);

// é€»è¾‘ï¼š(å·²æ”¯ä»˜ä¸”æœªå‘è´§) OR (å¾…æ”¯ä»˜ä¸”è¶…æ—¶)
// æ‰€æœ‰å‚æ•°éƒ½æ˜¯å®‰å…¨çš„
```

---

## 5. ğŸ› ï¸ ç‰¹æ®Šå­—ç¬¦å¤„ç†ä¸è½¬ä¹‰


### 5.1 é€šé…ç¬¦å®‰å…¨å¤„ç†


**ğŸ”¸ LIKEæŸ¥è¯¢ä¸­çš„ç‰¹æ®Šå­—ç¬¦**

åœ¨æ•°æ®åº“ä¸­ï¼Œ`%`å’Œ`_`æ˜¯é€šé…ç¬¦ï¼Œæœ‰ç‰¹æ®Šå«ä¹‰ï¼š
- `%` ä»£è¡¨ä»»æ„å¤šä¸ªå­—ç¬¦
- `_` ä»£è¡¨å•ä¸ªå­—ç¬¦

```java
// åœºæ™¯ï¼šç”¨æˆ·æœç´¢"30%æŠ˜æ‰£"è¿™ä¸ªå…³é”®è¯
String keyword = "30%æŠ˜æ‰£";

// âŒ ç›´æ¥ä½¿ç”¨ä¼šæœ‰é—®é¢˜
wrapper.like(Product::getName, keyword);
// å®é™…åŒ¹é…ï¼š30ã€ä»»æ„å­—ç¬¦ã€‘æŠ˜æ‰£ï¼ˆ%è¢«å½“é€šé…ç¬¦äº†ï¼‰

// âœ… æ­£ç¡®ï¼šè½¬ä¹‰ç‰¹æ®Šå­—ç¬¦
String safeKeyword = keyword.replace("%", "\\%")
                            .replace("_", "\\_");
wrapper.like(Product::getName, safeKeyword);
// ç°åœ¨ä¼šç²¾ç¡®åŒ¹é…"30%æŠ˜æ‰£"è¿™ä¸ªæ–‡æœ¬
```

**ğŸ”¸ å°è£…è½¬ä¹‰å·¥å…·æ–¹æ³•**
```java
/**
 * LIKEæŸ¥è¯¢å…³é”®è¯å®‰å…¨å¤„ç†
 */
public class SqlUtils {
    
    public static String escapeLike(String keyword) {
        if (StringUtils.isBlank(keyword)) {
            return keyword;
        }
        // è½¬ä¹‰MySQLä¸­çš„ç‰¹æ®Šå­—ç¬¦
        return keyword.replace("\\", "\\\\")  // å…ˆè½¬ä¹‰åæ–œæ 
                     .replace("%", "\\%")     // è½¬ä¹‰ç™¾åˆ†å·
                     .replace("_", "\\_");    // è½¬ä¹‰ä¸‹åˆ’çº¿
    }
}

// ä½¿ç”¨ç¤ºä¾‹
String userInput = request.getParameter("keyword");
String safeKeyword = SqlUtils.escapeLike(userInput);
wrapper.like(Article::getTitle, safeKeyword);
```

### 5.2 å…¶ä»–ç‰¹æ®Šå­—ç¬¦åœºæ™¯


**ğŸ”¸ å•å¼•å·å¤„ç†**
```java
// MyBatis-Plusä¼šè‡ªåŠ¨å¤„ç†å•å¼•å·ï¼Œæ— éœ€æ‰‹åŠ¨è½¬ä¹‰
String name = "O'Neal"; // åŒ…å«å•å¼•å·çš„åå­—

// âœ… ç›´æ¥ä½¿ç”¨å³å¯ï¼ˆæ¡†æ¶è‡ªåŠ¨è½¬ä¹‰ï¼‰
wrapper.eq(User::getName, name);
// å®é™…æ‰§è¡Œï¼šWHERE name = 'O''Neal'ï¼ˆå•å¼•å·è¢«è‡ªåŠ¨è½¬ä¹‰ï¼‰
```

**ğŸ”¸ åæ–œæ å¤„ç†**
```java
// Windowsè·¯å¾„åŒ…å«åæ–œæ 
String filePath = "C:\\Users\\Documents\\file.txt";

// âœ… MyBatis-Pluså‚æ•°åŒ–æŸ¥è¯¢è‡ªåŠ¨å¤„ç†
wrapper.eq(FileRecord::getPath, filePath);
// å­˜å‚¨æ—¶ä¼šæ­£ç¡®ä¿å­˜åæ–œæ 
```

### 5.3 æ­£åˆ™è¡¨è¾¾å¼åœºæ™¯


```java
// åœºæ™¯ï¼šéœ€è¦ç”¨æ­£åˆ™åŒ¹é…æ‰‹æœºå·
String phonePattern = "^1[3-9]\\d{9}$";

// âœ… ä½¿ç”¨applyæ—¶è¦æ ¼å¤–å°å¿ƒï¼ˆå¿…é¡»æ˜¯å†™æ­»çš„æ¨¡å¼ï¼‰
wrapper.apply("phone REGEXP {0}", phonePattern);

// âš ï¸ æ›´å®‰å…¨çš„åšæ³•ï¼šåœ¨åº”ç”¨å±‚éªŒè¯
if (Pattern.matches("^1[3-9]\\d{9}$", phoneInput)) {
    wrapper.eq(User::getPhone, phoneInput); // éªŒè¯é€šè¿‡åç”¨ç²¾ç¡®åŒ¹é…
}
```

---

## 6. ğŸ“‹ ç™½åå•æœºåˆ¶è®¾è®¡


### 6.1 ä»€ä¹ˆæ˜¯ç™½åå•æœºåˆ¶


**ğŸ’¡ é€šä¿—ç†è§£**ï¼šå°±åƒé—¨å«æ£€æŸ¥èº«ä»½è¯ï¼Œåªæœ‰åå•ä¸Šçš„äººæ‰èƒ½è¿›æ¥ã€‚åœ¨SQLä¸­ï¼Œåªå…è®¸ä½¿ç”¨é¢„å®šä¹‰çš„ã€å®‰å…¨çš„å€¼ã€‚

**ğŸ”¸ å·¥ä½œåŸç†**
```
ç”¨æˆ·è¾“å…¥ â†’ æ£€æŸ¥æ˜¯å¦åœ¨ç™½åå•ä¸­ â†’ æ˜¯ï¼šä½¿ç”¨ / å¦ï¼šæ‹’ç»
              â†“
         é¢„å®šä¹‰çš„å®‰å…¨å€¼åˆ—è¡¨
```

### 6.2 åŠ¨æ€å­—æ®µåç™½åå•


**ğŸ”¸ åœºæ™¯ï¼šç”¨æˆ·å¯é€‰æ‹©æ’åºå­—æ®µ**
```java
/**
 * è®¢å•æ’åºå­—æ®µç™½åå•
 */
public class OrderSortValidator {
    
    // å®šä¹‰å…è®¸æ’åºçš„å­—æ®µ
    private static final Set<String> ALLOWED_SORT_FIELDS = new HashSet<>(Arrays.asList(
        "create_time",
        "update_time", 
        "total_amount",
        "order_no"
    ));
    
    /**
     * éªŒè¯æ’åºå­—æ®µæ˜¯å¦åˆæ³•
     */
    public static String validateSortField(String field) {
        if (!ALLOWED_SORT_FIELDS.contains(field)) {
            throw new IllegalArgumentException("éæ³•çš„æ’åºå­—æ®µ: " + field);
        }
        return field;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
String sortField = request.getParameter("sortBy");
String validField = OrderSortValidator.validateSortField(sortField);

LambdaQueryWrapper<Order> wrapper = new LambdaQueryWrapper<>();
wrapper.orderByDesc(validField); // åªæœ‰ç™½åå•ä¸­çš„å­—æ®µæ‰èƒ½ä½¿ç”¨
```

**ğŸ”¸ æ›´ä¼˜é›…çš„æšä¸¾å®ç°**
```java
/**
 * æ’åºå­—æ®µæšä¸¾ï¼ˆç±»å‹å®‰å…¨ï¼‰
 */
public enum OrderSortField {
    CREATE_TIME("create_time", "åˆ›å»ºæ—¶é—´"),
    TOTAL_AMOUNT("total_amount", "è®¢å•é‡‘é¢"),
    ORDER_NO("order_no", "è®¢å•å·");
    
    private final String column;
    private final String desc;
    
    OrderSortField(String column, String desc) {
        this.column = column;
        this.desc = desc;
    }
    
    public String getColumn() {
        return column;
    }
    
    // æ ¹æ®å‰ç«¯ä¼ å€¼è·å–æšä¸¾
    public static OrderSortField fromValue(String value) {
        for (OrderSortField field : values()) {
            if (field.name().equalsIgnoreCase(value)) {
                return field;
            }
        }
        throw new IllegalArgumentException("ä¸æ”¯æŒçš„æ’åºå­—æ®µ");
    }
}

// ä½¿ç”¨ç¤ºä¾‹
String sortParam = request.getParameter("sortBy");
OrderSortField sortField = OrderSortField.fromValue(sortParam);
wrapper.orderByDesc(sortField.getColumn()); // ç»å¯¹å®‰å…¨
```

### 6.3 æ“ä½œç¬¦ç™½åå•


**ğŸ”¸ åœºæ™¯ï¼šç”¨æˆ·å¯é€‰æ‹©æŸ¥è¯¢æ¡ä»¶ç±»å‹**
```java
/**
 * æŸ¥è¯¢æ¡ä»¶æ“ä½œç¬¦ç™½åå•
 */
public class QueryOperatorValidator {
    
    public enum Operator {
        EQ("eq", "ç­‰äº"),
        NE("ne", "ä¸ç­‰äº"),
        GT("gt", "å¤§äº"),
        GE("ge", "å¤§äºç­‰äº"),
        LT("lt", "å°äº"),
        LE("le", "å°äºç­‰äº"),
        LIKE("like", "æ¨¡ç³ŠåŒ¹é…");
        
        private final String code;
        private final String desc;
        
        Operator(String code, String desc) {
            this.code = code;
            this.desc = desc;
        }
        
        public static Operator fromCode(String code) {
            for (Operator op : values()) {
                if (op.code.equals(code)) {
                    return op;
                }
            }
            throw new IllegalArgumentException("ä¸æ”¯æŒçš„æ“ä½œç¬¦: " + code);
        }
    }
    
    /**
     * æ ¹æ®æ“ä½œç¬¦æ„å»ºæ¡ä»¶
     */
    public static <T> void applyCondition(LambdaQueryWrapper<T> wrapper,
                                         SFunction<T, ?> column,
                                         String operator,
                                         Object value) {
        Operator op = Operator.fromCode(operator);
        
        switch (op) {
            case EQ:
                wrapper.eq(column, value);
                break;
            case GT:
                wrapper.gt(column, value);
                break;
            case LIKE:
                wrapper.like(column, value);
                break;
            // ... å…¶ä»–æ“ä½œç¬¦
        }
    }
}

// ä½¿ç”¨ç¤ºä¾‹
String operator = request.getParameter("operator"); // å‰ç«¯ä¼ "eq"æˆ–"gt"ç­‰
Object value = request.getParameter("value");

QueryOperatorValidator.applyCondition(
    wrapper, 
    User::getAge, 
    operator,  // åªæ¥å—ç™½åå•ä¸­çš„æ“ä½œç¬¦
    value
);
```

### 6.4 å€¼åŸŸç™½åå•


**ğŸ”¸ åœºæ™¯ï¼šçŠ¶æ€å­—æ®µåªèƒ½æ˜¯ç‰¹å®šå€¼**
```java
/**
 * è®¢å•çŠ¶æ€ç™½åå•
 */
public enum OrderStatus {
    PENDING("pending", "å¾…æ”¯ä»˜"),
    PAID("paid", "å·²æ”¯ä»˜"),
    SHIPPED("shipped", "å·²å‘è´§"),
    COMPLETED("completed", "å·²å®Œæˆ");
    
    private final String code;
    private final String desc;
    
    // ... æ„é€ å™¨ã€getterçœç•¥
    
    public static OrderStatus fromCode(String code) {
        for (OrderStatus status : values()) {
            if (status.code.equals(code)) {
                return status;
            }
        }
        throw new IllegalArgumentException("éæ³•çš„è®¢å•çŠ¶æ€");
    }
}

// ä½¿ç”¨ç¤ºä¾‹
String statusParam = request.getParameter("status");
OrderStatus validStatus = OrderStatus.fromCode(statusParam);

wrapper.eq(Order::getStatus, validStatus.getCode()); // åªèƒ½æ˜¯æšä¸¾ä¸­çš„å€¼
```

---

## 7. âœ”ï¸ è¾“å…¥å‚æ•°æ ¡éªŒç­–ç•¥


### 7.1 æ•°æ®ç±»å‹æ ¡éªŒ


**ğŸ”¸ ä½¿ç”¨JSR303/Hibernate Validator**
```java
/**
 * ç”¨æˆ·æŸ¥è¯¢è¯·æ±‚DTO
 */
public class UserQueryDTO {
    
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @Size(min = 2, max = 20, message = "ç”¨æˆ·åé•¿åº¦2-20")
    @Pattern(regexp = "^[a-zA-Z0-9_]+$", message = "ç”¨æˆ·ååªèƒ½åŒ…å«å­—æ¯æ•°å­—ä¸‹åˆ’çº¿")
    private String username;
    
    @Min(value = 0, message = "å¹´é¾„ä¸èƒ½å°äº0")
    @Max(value = 150, message = "å¹´é¾„ä¸èƒ½å¤§äº150")
    private Integer age;
    
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String email;
    
    // getter/setterçœç•¥
}

// Controllerä¸­ä½¿ç”¨
@PostMapping("/user/query")
public Result queryUser(@Validated @RequestBody UserQueryDTO dto) {
    // å‚æ•°è‡ªåŠ¨æ ¡éªŒï¼Œä¸åˆæ³•ä¼šæŠ›å‡ºå¼‚å¸¸
    LambdaQueryWrapper<User> wrapper = new LambdaQueryWrapper<>();
    wrapper.eq(User::getUsername, dto.getUsername())
           .eq(dto.getAge() != null, User::getAge, dto.getAge());
    
    return Result.success(userMapper.selectList(wrapper));
}
```

### 7.2 é•¿åº¦é™åˆ¶æ ¡éªŒ


**ğŸ”¸ é˜²æ­¢è¶…é•¿è¾“å…¥**
```java
public class InputValidator {
    
    /**
     * æ ¡éªŒå­—ç¬¦ä¸²é•¿åº¦
     */
    public static String validateLength(String input, int maxLength) {
        if (input == null) {
            return null;
        }
        if (input.length() > maxLength) {
            throw new IllegalArgumentException(
                String.format("è¾“å…¥é•¿åº¦è¶…é™ï¼Œæœ€å¤§%då­—ç¬¦", maxLength)
            );
        }
        return input;
    }
    
    /**
     * æ ¡éªŒé›†åˆå¤§å°
     */
    public static <T> List<T> validateListSize(List<T> list, int maxSize) {
        if (list != null && list.size() > maxSize) {
            throw new IllegalArgumentException(
                String.format("åˆ—è¡¨å…ƒç´ è¶…é™ï¼Œæœ€å¤š%dä¸ª", maxSize)
            );
        }
        return list;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
String keyword = request.getParameter("keyword");
keyword = InputValidator.validateLength(keyword, 50); // æœ€å¤š50å­—ç¬¦

List<Long> ids = request.getParameterValues("ids");
ids = InputValidator.validateListSize(ids, 100); // æœ€å¤š100ä¸ªID
```

### 7.3 ä¸šåŠ¡è§„åˆ™æ ¡éªŒ


**ğŸ”¸ è‡ªå®šä¹‰æ ¡éªŒé€»è¾‘**
```java
/**
 * æŸ¥è¯¢æ¡ä»¶æ ¡éªŒå™¨
 */
public class QueryValidator {
    
    /**
     * æ ¡éªŒæ—¥æœŸèŒƒå›´
     */
    public static void validateDateRange(LocalDateTime start, LocalDateTime end) {
        if (start != null && end != null) {
            if (start.isAfter(end)) {
                throw new IllegalArgumentException("å¼€å§‹æ—¶é—´ä¸èƒ½æ™šäºç»“æŸæ—¶é—´");
            }
            
            // é˜²æ­¢æŸ¥è¯¢èŒƒå›´è¿‡å¤§
            long days = ChronoUnit.DAYS.between(start, end);
            if (days > 365) {
                throw new IllegalArgumentException("æŸ¥è¯¢èŒƒå›´ä¸èƒ½è¶…è¿‡1å¹´");
            }
        }
    }
    
    /**
     * æ ¡éªŒä»·æ ¼èŒƒå›´
     */
    public static void validatePriceRange(BigDecimal minPrice, BigDecimal maxPrice) {
        if (minPrice != null && minPrice.compareTo(BigDecimal.ZERO) < 0) {
            throw new IllegalArgumentException("æœ€ä½ä»·æ ¼ä¸èƒ½ä¸ºè´Ÿæ•°");
        }
        
        if (maxPrice != null && minPrice != null 
            && maxPrice.compareTo(minPrice) < 0) {
            throw new IllegalArgumentException("æœ€é«˜ä»·æ ¼ä¸èƒ½ä½äºæœ€ä½ä»·æ ¼");
        }
    }
}

// ä½¿ç”¨ç¤ºä¾‹
LocalDateTime startTime = dto.getStartTime();
LocalDateTime endTime = dto.getEndTime();
QueryValidator.validateDateRange(startTime, endTime);

wrapper.between(startTime != null && endTime != null, 
                Order::getCreateTime, startTime, endTime);
```

### 7.4 SQLå…³é”®å­—è¿‡æ»¤


**ğŸ”¸ æ£€æµ‹å±é™©è¾“å…¥**
```java
public class SqlKeywordFilter {
    
    // SQLå±é™©å…³é”®å­—åˆ—è¡¨
    private static final Set<String> DANGEROUS_KEYWORDS = new HashSet<>(Arrays.asList(
        "DROP", "DELETE", "TRUNCATE", "EXEC", "EXECUTE",
        "SCRIPT", "UNION", "INSERT", "UPDATE", "ALTER"
    ));
    
    /**
     * æ£€æµ‹è¾“å…¥æ˜¯å¦åŒ…å«SQLå…³é”®å­—
     */
    public static void checkSqlKeyword(String input) {
        if (StringUtils.isBlank(input)) {
            return;
        }
        
        String upperInput = input.toUpperCase();
        for (String keyword : DANGEROUS_KEYWORDS) {
            if (upperInput.contains(keyword)) {
                throw new SecurityException(
                    "è¾“å…¥åŒ…å«éæ³•å…³é”®å­—: " + keyword
                );
            }
        }
    }
}

// ä½¿ç”¨ç¤ºä¾‹ï¼ˆä»…åœ¨å¿…è¦æ—¶ä½¿ç”¨ï¼Œæ­£å¸¸å‚æ•°åŒ–æŸ¥è¯¢æ— éœ€æ­¤æ­¥éª¤ï¼‰
String userInput = request.getParameter("input");
SqlKeywordFilter.checkSqlKeyword(userInput);
```

---

## 8. ğŸ“ å®‰å…¨ç¼–ç è§„èŒƒä¸æœ€ä½³å®è·µ


### 8.1 å¼€å‘è§„èŒƒæ¸…å•


**âœ… å¿…é¡»éµå®ˆçš„è§„åˆ™**

- [x] **ä¼˜å…ˆä½¿ç”¨Lambdaæ–¹å¼**æ„å»ºæŸ¥è¯¢æ¡ä»¶
- [x] **æ‰€æœ‰ç”¨æˆ·è¾“å…¥å¿…é¡»å‚æ•°åŒ–**ï¼Œç¦æ­¢å­—ç¬¦ä¸²æ‹¼æ¥SQL
- [x] **åŠ¨æ€å­—æ®µåå¿…é¡»ä½¿ç”¨ç™½åå•**éªŒè¯
- [x] **ç¦æ­¢ä½¿ç”¨applyæ–¹æ³•**æ‹¼æ¥ç”¨æˆ·è¾“å…¥
- [x] **LIKEæŸ¥è¯¢éœ€è½¬ä¹‰**ç‰¹æ®Šå­—ç¬¦ï¼ˆ%ã€_ï¼‰
- [x] **è¾“å…¥å‚æ•°å¿…é¡»æ ¡éªŒ**ç±»å‹ã€é•¿åº¦ã€æ ¼å¼
- [x] **æ•æ„Ÿæ“ä½œæ·»åŠ æ—¥å¿—**è®°å½•ï¼ˆåˆ é™¤ã€ä¿®æ”¹æƒé™ç­‰ï¼‰

### 8.2 ä»£ç å®¡æŸ¥è¦ç‚¹


**ğŸ” é‡ç‚¹æ£€æŸ¥é¡¹**

```java
// âŒ å±é™©ä»£ç ç‰¹å¾
1. Stringæ‹¼æ¥æ„å»ºSQL
   "SELECT * FROM user WHERE name = '" + name + "'"

2. apply/lastæ–¹æ³•ä½¿ç”¨ç”¨æˆ·è¾“å…¥
   wrapper.apply(userInput)
   wrapper.last("LIMIT " + userLimit)

3. æœªç»éªŒè¯çš„åŠ¨æ€å­—æ®µ
   wrapper.orderBy(userField)

4. ç¼ºå°‘å‚æ•°æ ¡éªŒ
   wrapper.eq(User::getId, request.getParameter("id")) // æœªæ ¡éªŒç±»å‹

// âœ… å®‰å…¨ä»£ç ç‰¹å¾  
1. ä½¿ç”¨Lambdaè¡¨è¾¾å¼
   wrapper.eq(User::getName, name)

2. å‚æ•°ç»è¿‡éªŒè¯
   Long id = validator.validateId(request.getParameter("id"))

3. å­—æ®µä½¿ç”¨ç™½åå•
   String field = SortFieldEnum.fromCode(sortBy).getColumn()
```

### 8.3 å¸¸è§é”™è¯¯é¿å…


**ğŸ”¸ é”™è¯¯1ï¼šè¿‡åº¦ä¿¡ä»»å‰ç«¯ä¼ å€¼**
```java
// âŒ é”™è¯¯ç¤ºä¾‹
String orderBy = request.getParameter("orderBy");
wrapper.orderByDesc(orderBy); // å‰ç«¯å¯èƒ½ä¼ æ¶æ„å­—æ®µå

// âœ… æ­£ç¡®åšæ³•
String orderBy = request.getParameter("orderBy");
if ("createTime".equals(orderBy)) {
    wrapper.orderByDesc(User::getCreateTime);
} else if ("age".equals(orderBy)) {
    wrapper.orderByDesc(User::getAge);
} else {
    // é»˜è®¤æ’åº
    wrapper.orderByDesc(User::getId);
}
```

**ğŸ”¸ é”™è¯¯2ï¼šå¿½ç•¥ç©ºå€¼æ ¡éªŒ**
```java
// âŒ å¯èƒ½å‡ºé”™
String status = request.getParameter("status");
wrapper.eq(User::getStatus, status); // statuså¯èƒ½ä¸ºnull

// âœ… å®‰å…¨å¤„ç†
String status = request.getParameter("status");
wrapper.eq(StringUtils.isNotBlank(status), User::getStatus, status);
```

**ğŸ”¸ é”™è¯¯3ï¼šç±»å‹è½¬æ¢æœªéªŒè¯**
```java
// âŒ å¯èƒ½æŠ›å¼‚å¸¸
Long userId = Long.parseLong(request.getParameter("userId"));

// âœ… å®‰å…¨è½¬æ¢
String userIdStr = request.getParameter("userId");
Long userId = null;
try {
    if (StringUtils.isNotBlank(userIdStr)) {
        userId = Long.parseLong(userIdStr);
    }
} catch (NumberFormatException e) {
    throw new IllegalArgumentException("ç”¨æˆ·IDæ ¼å¼é”™è¯¯");
}
```

### 8.4 å®‰å…¨å·¥å…·ç±»å°è£…


**ğŸ”¸ é€šç”¨æŸ¥è¯¢æ„å»ºå™¨**
```java
public class SafeQueryBuilder {
    
    /**
     * å®‰å…¨çš„åˆ†é¡µæŸ¥è¯¢æ„å»º
     */
    public static <T> Page<T> buildSafePage(Integer current, Integer size) {
        // é™åˆ¶åˆ†é¡µå‚æ•°èŒƒå›´
        int safeCurrent = Math.max(1, Optional.ofNullable(current).orElse(1));
        int safeSize = Math.min(100, Math.max(10, Optional.ofNullable(size).orElse(10)));
        
        return new Page<>(safeCurrent, safeSize);
    }
    
    /**
     * å®‰å…¨çš„æ—¥æœŸèŒƒå›´æ¡ä»¶
     */
    public static <T> void addDateRange(LambdaQueryWrapper<T> wrapper,
                                       SFunction<T, ?> column,
                                       LocalDateTime start,
                                       LocalDateTime end) {
        // æ ¡éªŒæ—¥æœŸèŒƒå›´
        if (start != null && end != null && start.isAfter(end)) {
            throw new IllegalArgumentException("å¼€å§‹æ—¶é—´ä¸èƒ½æ™šäºç»“æŸæ—¶é—´");
        }
        
        wrapper.ge(start != null, column, start)
               .le(end != null, column, end);
    }
    
    /**
     * å®‰å…¨çš„å…³é”®å­—æœç´¢
     */
    public static <T> void addKeywordSearch(LambdaQueryWrapper<T> wrapper,
                                           List<SFunction<T, ?>> columns,
                                           String keyword) {
        if (StringUtils.isBlank(keyword)) {
            return;
        }
        
        // è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦
        String safeKeyword = keyword.replace("%", "\\%")
                                   .replace("_", "\\_");
        
        // å¤šå­—æ®µæ¨¡ç³Šæœç´¢
        wrapper.and(w -> {
            for (int i = 0; i < columns.size(); i++) {
                if (i > 0) {
                    w.or();
                }
                w.like(columns.get(i), safeKeyword);
            }
        });
    }
}
```

### 8.5 ä¼ä¸šçº§é…ç½®å»ºè®®


**ğŸ”¸ MyBatis-Pluså®‰å…¨é…ç½®**
```yaml
mybatis-plus:
  configuration:
#    # å¼€å¯SQLæ—¥å¿—ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
    
  global-config:
#    # å¼€å¯SQLæ€§èƒ½åˆ†æï¼ˆå¼€å‘ç¯å¢ƒï¼‰
    sql-injector: com.baomidou.mybatisplus.core.injector.DefaultSqlInjector
    
    db-config:
#      # é€»è¾‘åˆ é™¤é…ç½®ï¼ˆå®‰å…¨åˆ é™¤ï¼‰
      logic-delete-field: deleted
      logic-delete-value: 1
      logic-not-delete-value: 0
```

**ğŸ”¸ SQLå®¡è®¡é…ç½®**
```java
@Component
public class SqlAuditInterceptor implements Interceptor {
    
    @Override
    public Object intercept(Invocation invocation) throws Throwable {
        // è·å–SQLè¯­å¥
        MappedStatement ms = (MappedStatement) invocation.getArgs()[0];
        Object parameter = invocation.getArgs()[1];
        
        BoundSql boundSql = ms.getBoundSql(parameter);
        String sql = boundSql.getSql();
        
        // æ£€æµ‹é«˜å±æ“ä½œ
        if (sql.toUpperCase().contains("DROP") 
            || sql.toUpperCase().contains("TRUNCATE")) {
            log.error("æ£€æµ‹åˆ°é«˜å±SQL: {}", sql);
            throw new SecurityException("ç¦æ­¢æ‰§è¡Œé«˜å±SQLæ“ä½œ");
        }
        
        return invocation.proceed();
    }
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å®‰å…¨é˜²æŠ¤è¦ç‚¹


**ğŸ”¸ ä¸‰ä¸ªæ ¸å¿ƒåŸåˆ™**

1. **å‚æ•°åŒ–æŸ¥è¯¢ä¼˜å…ˆ** - æ°¸è¿œä¸è¦æ‹¼æ¥ç”¨æˆ·è¾“å…¥åˆ°SQLä¸­
2. **ç™½åå•éªŒè¯å¿…é¡»** - åŠ¨æ€å­—æ®µã€æ“ä½œç¬¦å¿…é¡»éªŒè¯
3. **å¤šå±‚é˜²æŠ¤ä¿éšœ** - å‚æ•°æ ¡éªŒã€ç±»å‹æ£€æŸ¥ã€æ—¥å¿—å®¡è®¡

### 9.2 å…³é”®çŸ¥è¯†ç‚¹


```
ğŸ”¸ SQLæ³¨å…¥æœ¬è´¨ï¼šç”¨æˆ·è¾“å…¥è¢«å½“ä½œSQLä»£ç æ‰§è¡Œ
ğŸ”¸ MyBatis-Plusé˜²æŠ¤ï¼šé¢„ç¼–è¯‘ã€å‚æ•°ç»‘å®šã€è‡ªåŠ¨è½¬ä¹‰
ğŸ”¸ Lambdaæœ€å®‰å…¨ï¼šç¼–è¯‘æœŸæ£€æŸ¥ï¼Œå®Œå…¨é¿å…æ³¨å…¥
ğŸ”¸ ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰ï¼šLIKEæŸ¥è¯¢éœ€è¦æ‰‹åŠ¨è½¬ä¹‰%å’Œ_
ğŸ”¸ ç™½åå•æœºåˆ¶ï¼šå­—æ®µåã€æ“ä½œç¬¦ã€çŠ¶æ€å€¼éƒ½è¦éªŒè¯
ğŸ”¸ è¾“å…¥æ ¡éªŒï¼šç±»å‹ã€é•¿åº¦ã€æ ¼å¼ã€ä¸šåŠ¡è§„åˆ™å…¨é¢æ£€æŸ¥
```

### 9.3 å®è·µæ£€æŸ¥æ¸…å•


**å¼€å‘é˜¶æ®µ**
- [ ] æ‰€æœ‰æŸ¥è¯¢ä½¿ç”¨Lambdaæˆ–å‚æ•°åŒ–
- [ ] åŠ¨æ€å­—æ®µä½¿ç”¨æšä¸¾æˆ–ç™½åå•
- [ ] LIKEæŸ¥è¯¢è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦
- [ ] å‚æ•°æ·»åŠ JSR303æ ¡éªŒ

**ä»£ç å®¡æŸ¥**
- [ ] æ£€æŸ¥æ˜¯å¦å­˜åœ¨å­—ç¬¦ä¸²æ‹¼æ¥SQL
- [ ] æ£€æŸ¥apply/lastæ–¹æ³•ä½¿ç”¨
- [ ] æ£€æŸ¥æ˜¯å¦ç¼ºå°‘å‚æ•°éªŒè¯
- [ ] æ£€æŸ¥æ•æ„Ÿæ“ä½œæ—¥å¿—

**ä¸Šçº¿å‰**
- [ ] è¿›è¡ŒSQLæ³¨å…¥å®‰å…¨æµ‹è¯•
- [ ] é…ç½®SQLå®¡è®¡æ‹¦æˆªå™¨
- [ ] å¼€å¯æ…¢SQLç›‘æ§
- [ ] å‡†å¤‡å®‰å…¨äº‹ä»¶åº”æ€¥é¢„æ¡ˆ

### 9.4 è®°å¿†å£è¯€


```
ğŸ§  SQLæ³¨å…¥é˜²æŠ¤å£è¯€ï¼š
å‚æ•°åŒ–æŸ¥è¯¢æ˜¯æ ¹æœ¬ï¼Œ
Lambdaæ–¹å¼æœ€å®‰å…¨ï¼Œ
åŠ¨æ€å­—æ®µéœ€ç™½åå•ï¼Œ
ç‰¹æ®Šå­—ç¬¦è¦è½¬ä¹‰ï¼Œ
è¾“å…¥æ ¡éªŒä¸èƒ½çœï¼Œ
ä»£ç å®¡æŸ¥è¦ä¸¥æ ¼ï¼
```

---

> ğŸ’¡ **æ ¸å¿ƒç†å¿µ**  
> å®‰å…¨ä¸æ˜¯ä¸€æ¬¡æ€§çš„å·¥ä½œï¼Œè€Œæ˜¯è´¯ç©¿æ•´ä¸ªå¼€å‘è¿‡ç¨‹çš„ä¹ æƒ¯ã€‚MyBatis-Plusæä¾›äº†å¾ˆå¥½çš„å®‰å…¨æœºåˆ¶ï¼Œä½†æœ€ç»ˆè¿˜æ˜¯è¦é å¼€å‘è€…æ­£ç¡®ä½¿ç”¨ã€‚è®°ä½ï¼š**æ°¸è¿œä¸è¦ç›¸ä¿¡ç”¨æˆ·çš„è¾“å…¥ï¼Œæ‰€æœ‰å¤–éƒ¨æ•°æ®éƒ½è¦ç»è¿‡éªŒè¯å’Œå¤„ç†**ã€‚

> ğŸš€ **æœ€ä½³å®è·µ**  
> åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå»ºè®®å°†è¿™äº›å®‰å…¨æªæ–½å°è£…æˆå·¥å…·ç±»å’ŒåŸºç¡€ç»„ä»¶ï¼Œè®©å›¢é˜Ÿæˆå‘˜é»˜è®¤å°±ä½¿ç”¨å®‰å…¨çš„æ–¹å¼å¼€å‘ï¼Œè€Œä¸æ˜¯ä¾èµ–æ¯ä¸ªäººçš„å®‰å…¨æ„è¯†ã€‚å®‰å…¨åº”è¯¥æˆä¸ºæ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯é¢å¤–çš„è´Ÿæ‹…ã€‚