---
title: 36ã€CriteriaæŸ¥è¯¢å…¥é—¨
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯Criteria API](#1-ä»€ä¹ˆæ˜¯criteria-api)
2. [æ ¸å¿ƒç»„ä»¶è¯¦è§£](#2-æ ¸å¿ƒç»„ä»¶è¯¦è§£)
3. [åŸºç¡€æŸ¥è¯¢æ“ä½œ](#3-åŸºç¡€æŸ¥è¯¢æ“ä½œ)
4. [åŠ¨æ€æ¡ä»¶æ„å»º](#4-åŠ¨æ€æ¡ä»¶æ„å»º)
5. [ç±»å‹å®‰å…¨çš„ä¼˜åŠ¿](#5-ç±»å‹å®‰å…¨çš„ä¼˜åŠ¿)
6. [å®æˆ˜åº”ç”¨åœºæ™¯](#6-å®æˆ˜åº”ç”¨åœºæ™¯)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ä»€ä¹ˆæ˜¯Criteria API


### 1.1 é€šä¿—ç†è§£Criteria API


**ç”¨å¤§ç™½è¯è¯´ï¼šCriteria APIå°±æ˜¯ç”¨Javaä»£ç æ¥å†™æŸ¥è¯¢æ¡ä»¶çš„å·¥å…·**

```
ä¼ ç»ŸSQLæŸ¥è¯¢çš„é—®é¢˜ï¼š
SELECT * FROM user WHERE age > 18 AND status = 'ACTIVE'
â†‘ è¿™æ˜¯å­—ç¬¦ä¸²ï¼Œå†™é”™äº†åªèƒ½è¿è¡Œæ—¶æ‰çŸ¥é“

Criteria APIçš„æ–¹å¼ï¼š
ç”¨Javaä»£ç æ¥æè¿°è¿™ä¸ªæŸ¥è¯¢æ¡ä»¶
å†™é”™äº†ç¼–è¯‘å™¨ç«‹åˆ»å°±èƒ½å‘ç°ï¼
```

**ç”Ÿæ´»åŒ–ç±»æ¯”**ï¼š
```
æƒ³è±¡ä½ å»é¤å…ç‚¹èœï¼š

æ–¹å¼1 - SQLæŸ¥è¯¢ï¼ˆå­—ç¬¦ä¸²æ–¹å¼ï¼‰ï¼š
ä½ è¯´ï¼š"ç»™æˆ‘æ¥ä»½è¥¿çº¢æŸ¿ç‚’é¸¡è›‹ï¼Œä¸è¦è‘±"
â†‘ å¦‚æœè¯´é”™äº†ï¼ˆæ¯”å¦‚"è¥¿çº¢æŸ¿ç‚’é¸¡è›‹è›‹"ï¼‰ï¼ŒæœåŠ¡å‘˜ç«¯ä¸Šæ¥æ‰å‘ç°ä¸å¯¹

æ–¹å¼2 - Criteria APIï¼ˆä»£ç æ–¹å¼ï¼‰ï¼š
ä½ ç”¨èœå•å‹¾é€‰ï¼š
â˜‘ è¥¿çº¢æŸ¿ç‚’é¸¡è›‹
â˜‘ å»è‘±
â†‘ èœå•ä¸Šæ²¡æœ‰çš„èœä½ æ ¹æœ¬å‹¾ä¸äº†ï¼Œä¸ä¼šç‚¹é”™ï¼
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦Criteria API


**æ ¸å¿ƒä»·å€¼ï¼š** è®©æŸ¥è¯¢æ›´å®‰å…¨ã€æ›´çµæ´»

| å¯¹æ¯”ç»´åº¦ | **ä¼ ç»Ÿå­—ç¬¦ä¸²æŸ¥è¯¢(JPQL)** | **Criteria API** |
|---------|----------------------|-----------------|
| ğŸ” é”™è¯¯æ£€æµ‹ | `è¿è¡Œæ—¶æ‰å‘ç°é”™è¯¯` | `ç¼–è¯‘æ—¶ç«‹å³å‘ç°` |
| ğŸ”§ åŠ¨æ€æŸ¥è¯¢ | `æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œå®¹æ˜“å‡ºé”™` | `é“¾å¼è°ƒç”¨ï¼Œæ¸…æ™°æ˜“æ‡‚` |
| ğŸ“ IDEæ”¯æŒ | `æ²¡æœ‰ä»£ç æç¤º` | `è‡ªåŠ¨è¡¥å…¨ã€é‡æ„å®‰å…¨` |
| ğŸ›¡ï¸ SQLæ³¨å…¥ | `éœ€è¦æ‰‹åŠ¨é˜²æŠ¤` | `å¤©ç„¶é˜²æ­¢æ³¨å…¥` |
| ğŸ“š ç»´æŠ¤æ€§ | `å­—ç¬¦ä¸²éš¾ä»¥é‡æ„` | `ç±»å‹å®‰å…¨ï¼Œæ˜“ç»´æŠ¤` |

**å®é™…åœºæ™¯ä¸¾ä¾‹ï¼š**
```
éœ€æ±‚ï¼šæ ¹æ®ç”¨æˆ·è¾“å…¥çš„æ¡ä»¶åŠ¨æ€æœç´¢å•†å“

ä¼ ç»ŸJPQLæ–¹å¼çš„ç—›ç‚¹ï¼š
String jpql = "SELECT p FROM Product p WHERE 1=1";
if (name != null) {
    jpql += " AND p.name LIKE '%" + name + "%'";  // å®¹æ˜“SQLæ³¨å…¥ï¼
}
if (minPrice != null) {
    jpql += " AND p.price >= " + minPrice;  // å­—ç¬¦ä¸²æ‹¼æ¥æ˜“å‡ºé”™
}
// ä»£ç æ··ä¹±ï¼Œéš¾ä»¥ç»´æŠ¤

Criteria APIçš„ä¼˜é›…æ–¹å¼ï¼š
åªéœ€è¦ç”¨ifåˆ¤æ–­ï¼ŒåŠ¨æ€æ·»åŠ æ¡ä»¶å³å¯ï¼Œå®‰å…¨åˆæ¸…æ™°ï¼
```

### 1.3 CriteriaæŸ¥è¯¢çš„æ ¸å¿ƒç‰¹ç‚¹


**ğŸ”¸ ç±»å‹å®‰å…¨ï¼ˆType-Safeï¼‰**
```
ä»€ä¹ˆæ˜¯ç±»å‹å®‰å…¨ï¼Ÿ
ç®€å•è¯´å°±æ˜¯ï¼šç¼–è¯‘å™¨å¸®ä½ æ£€æŸ¥ç±»å‹æ˜¯å¦æ­£ç¡®

é”™è¯¯ç¤ºä¾‹ï¼ˆå­—ç¬¦ä¸²æŸ¥è¯¢ï¼‰ï¼š
query("SELECT u FROM User u WHERE u.age = 'abc'")  
// ageæ˜¯æ•°å­—ï¼Œå´å†™æˆå­—ç¬¦ä¸²ï¼Œè¿è¡Œæ‰æŠ¥é”™

æ­£ç¡®ç¤ºä¾‹ï¼ˆCriteriaï¼‰ï¼š
root.get("age").in(18, 25, 30)  
// å¦‚æœä¼ å…¥å­—ç¬¦ä¸²ï¼Œç¼–è¯‘å™¨ç«‹åˆ»æŠ¥é”™
```

**ğŸ”¸ ç¼–è¯‘æ—¶æ£€æŸ¥ï¼ˆCompile-Time Checkï¼‰**
```
ä¼ ç»Ÿæ–¹å¼ï¼š
String jpql = "SELECT u FROM Usr u";  // è¡¨åæ‹¼å†™é”™è¯¯ï¼
// âŒ ç¼–è¯‘é€šè¿‡ï¼Œè¿è¡Œæ—¶æ‰ç‚¸

Criteriaæ–¹å¼ï¼š
CriteriaQuery<User> query = cb.createQuery(User.class);
Root<User> root = query.from(User.class);
// âœ… Userç±»ä¸å­˜åœ¨æˆ–æ‹¼å†™é”™è¯¯ï¼Œç«‹å³ç¼–è¯‘å¤±è´¥
```

**ğŸ”¸ åŠ¨æ€æŸ¥è¯¢ä¼˜åŠ¿**
```
åœºæ™¯ï¼šç”µå•†ç½‘ç«™çš„å•†å“æœç´¢
ç”¨æˆ·å¯èƒ½è¾“å…¥ï¼š
- åªè¾“å…¥ç±»åˆ«
- åªè¾“å…¥ä»·æ ¼åŒºé—´
- åŒæ—¶è¾“å…¥ç±»åˆ«å’Œä»·æ ¼
- ä¸€ä¸ªéƒ½ä¸è¾“å…¥

Criteria APIå¯ä»¥ä¼˜é›…åœ°å¤„ç†æ‰€æœ‰æƒ…å†µï¼š
List<Predicate> conditions = new ArrayList<>();
if (category != null) {
    conditions.add(cb.equal(root.get("category"), category));
}
if (minPrice != null) {
    conditions.add(cb.ge(root.get("price"), minPrice));
}
query.where(conditions.toArray(new Predicate[0]));

æ¸…æ™°ã€å®‰å…¨ã€æ˜“ç»´æŠ¤ï¼
```

---

## 2. ğŸ§© æ ¸å¿ƒç»„ä»¶è¯¦è§£


### 2.1 CriteriaBuilder - æŸ¥è¯¢æ„å»ºå™¨


**ğŸ”¸ æ˜¯ä»€ä¹ˆï¼Ÿ**
```
CriteriaBuilderæ˜¯æŸ¥è¯¢çš„"å·¥å…·ç®±"
é‡Œé¢æœ‰å„ç§æ„å»ºæŸ¥è¯¢æ¡ä»¶çš„å·¥å…·æ–¹æ³•

å°±åƒæœ¨åŒ çš„å·¥å…·ç®±ï¼š
- éœ€è¦é”¯å­æ—¶ï¼Œæ‹¿å‡ºæ¥ç”¨
- éœ€è¦é”¤å­æ—¶ï¼Œæ‹¿å‡ºæ¥ç”¨
- éœ€è¦é’‰å­æ—¶ï¼Œæ‹¿å‡ºæ¥ç”¨
```

**ğŸ”¸ æ€ä¹ˆè·å–ï¼Ÿ**
```java
// ä»EntityManagerè·å–
CriteriaBuilder cb = entityManager.getCriteriaBuilder();
```

**ğŸ”¸ ä¸»è¦åŠŸèƒ½åˆ†ç±»**

**â‘  åˆ›å»ºæŸ¥è¯¢å¯¹è±¡**
```java
// åˆ›å»ºæŸ¥è¯¢ï¼ˆæŒ‡å®šè¿”å›ç±»å‹ï¼‰
CriteriaQuery<User> query = cb.createQuery(User.class);

// åˆ›å»ºç»Ÿè®¡æŸ¥è¯¢
CriteriaQuery<Long> countQuery = cb.createQuery(Long.class);
```

**â‘¡ æ„å»ºæŸ¥è¯¢æ¡ä»¶**
```java
// ç­‰äº
cb.equal(root.get("name"), "å¼ ä¸‰")

// æ¨¡ç³ŠæŸ¥è¯¢
cb.like(root.get("name"), "%å¼ %")

// å¤§äº/å°äº
cb.gt(root.get("age"), 18)      // å¤§äº
cb.ge(root.get("age"), 18)      // å¤§äºç­‰äº
cb.lt(root.get("age"), 60)      // å°äº

// èŒƒå›´æŸ¥è¯¢
cb.between(root.get("age"), 18, 60)
```

**â‘¢ é€»è¾‘ç»„åˆ**
```java
// ANDç»„åˆ
Predicate condition1 = cb.equal(root.get("status"), "ACTIVE");
Predicate condition2 = cb.gt(root.get("age"), 18);
query.where(cb.and(condition1, condition2));

// ORç»„åˆ  
query.where(cb.or(condition1, condition2));

// NOTå–å
query.where(cb.not(condition1));
```

### 2.2 CriteriaQuery - æŸ¥è¯¢å¯¹è±¡


**ğŸ”¸ æ˜¯ä»€ä¹ˆï¼Ÿ**
```
CriteriaQueryä»£è¡¨ä¸€ä¸ªå®Œæ•´çš„æŸ¥è¯¢
ç›¸å½“äºSQLè¯­å¥çš„å®Œæ•´æè¿°

SQL: SELECT u FROM User u WHERE u.age > 18
     â†“ å¯¹åº”
CriteriaQuery<User> å¯¹è±¡
```

**ğŸ”¸ æ ¸å¿ƒæ–¹æ³•**

**â‘  select() - æŒ‡å®šæŸ¥è¯¢å†…å®¹**
```java
// æŸ¥è¯¢æ•´ä¸ªå®ä½“
query.select(root);

// æŸ¥è¯¢ç‰¹å®šå­—æ®µ
query.select(root.get("name"));

// æŸ¥è¯¢å¤šä¸ªå­—æ®µï¼ˆéœ€è¦æ„é€ å™¨ï¼‰
query.multiselect(root.get("id"), root.get("name"));
```

**â‘¡ from() - æŒ‡å®šæŸ¥è¯¢è¡¨**
```java
// ä»Userè¡¨æŸ¥è¯¢
Root<User> root = query.from(User.class);
```

**â‘¢ where() - æŒ‡å®šæŸ¥è¯¢æ¡ä»¶**
```java
// å•ä¸ªæ¡ä»¶
query.where(cb.equal(root.get("status"), "ACTIVE"));

// å¤šä¸ªæ¡ä»¶
query.where(condition1, condition2);  // é»˜è®¤ANDå…³ç³»
```

**â‘£ orderBy() - æ’åº**
```java
// å‡åº
query.orderBy(cb.asc(root.get("createTime")));

// é™åº
query.orderBy(cb.desc(root.get("createTime")));
```

### 2.3 Root - æŸ¥è¯¢æ ¹å¯¹è±¡


**ğŸ”¸ æ˜¯ä»€ä¹ˆï¼Ÿ**
```
Rootä»£è¡¨æŸ¥è¯¢çš„èµ·ç‚¹ï¼ˆæ ¹å®ä½“ï¼‰

SQL: SELECT u FROM User u
                      â†‘
                    è¿™ä¸ªuå°±æ˜¯Root

Rootå°±æ˜¯ç»™è¡¨èµ·ä¸ªåˆ«åï¼Œæ–¹ä¾¿å¼•ç”¨å­—æ®µ
```

**ğŸ”¸ æ ¸å¿ƒç”¨æ³•**

**â‘  get() - è·å–å­—æ®µ**
```java
// è·å–ç®€å•å­—æ®µ
root.get("name")
root.get("age")

// è·å–å…³è”å¯¹è±¡çš„å­—æ®µ
root.get("department").get("name")  // éƒ¨é—¨åç§°
```

**â‘¡ join() - å…³è”æŸ¥è¯¢**
```java
// å†…è¿æ¥
Join<User, Department> deptJoin = root.join("department");

// å·¦è¿æ¥
Join<User, Department> deptJoin = root.join("department", JoinType.LEFT);

// ä½¿ç”¨è¿æ¥åçš„å¯¹è±¡
deptJoin.get("name")  // éƒ¨é—¨åç§°
```

**â‘¢ fetch() - é¢„åŠ è½½**
```java
// è§£å†³N+1é—®é¢˜
root.fetch("department");  // åŒæ—¶åŠ è½½éƒ¨é—¨ä¿¡æ¯
```

### 2.4 Predicate - æŸ¥è¯¢æ¡ä»¶è°“è¯


**ğŸ”¸ æ˜¯ä»€ä¹ˆï¼Ÿ**
```
Predicateå°±æ˜¯"æ¡ä»¶"çš„æ„æ€
ä¸€ä¸ªPredicateä»£è¡¨ä¸€ä¸ªæŸ¥è¯¢æ¡ä»¶

æ¯”å¦‚ï¼š
- age > 18 æ˜¯ä¸€ä¸ªPredicate
- name = 'å¼ ä¸‰' æ˜¯ä¸€ä¸ªPredicate
- status = 'ACTIVE' æ˜¯ä¸€ä¸ªPredicate
```

**ğŸ”¸ æ¡ä»¶ç»„åˆæ–¹å¼**

```java
// æ–¹å¼1ï¼šç›´æ¥åœ¨whereä¸­ç»„åˆ
Predicate p1 = cb.equal(root.get("status"), "ACTIVE");
Predicate p2 = cb.gt(root.get("age"), 18);
query.where(p1, p2);  // ANDå…³ç³»

// æ–¹å¼2ï¼šä½¿ç”¨ListåŠ¨æ€ç»„åˆï¼ˆæ¨èï¼‰
List<Predicate> predicates = new ArrayList<>();
if (name != null) {
    predicates.add(cb.equal(root.get("name"), name));
}
if (minAge != null) {
    predicates.add(cb.ge(root.get("age"), minAge));
}
query.where(predicates.toArray(new Predicate[0]));
```

### 2.5 ç»„ä»¶åä½œæµç¨‹å›¾


```
æŸ¥è¯¢æ„å»ºæµç¨‹ï¼š

   å¼€å§‹
    â†“
[1] è·å–CriteriaBuilder
    cb = entityManager.getCriteriaBuilder()
    â†“
[2] åˆ›å»ºCriteriaQuery
    query = cb.createQuery(User.class)
    â†“
[3] åˆ›å»ºRootæ ¹å¯¹è±¡
    root = query.from(User.class)
    â†“
[4] æ„å»ºPredicateæ¡ä»¶
    condition = cb.equal(root.get("status"), "ACTIVE")
    â†“
[5] è®¾ç½®æŸ¥è¯¢æ¡ä»¶
    query.where(condition)
    â†“
[6] æ‰§è¡ŒæŸ¥è¯¢
    List<User> result = em.createQuery(query).getResultList()
    â†“
   ç»“æŸ
```

---

## 3. ğŸ”¨ åŸºç¡€æŸ¥è¯¢æ“ä½œ


### 3.1 ç®€å•æŸ¥è¯¢ç¤ºä¾‹


**åœºæ™¯ï¼šæŸ¥è¯¢æ‰€æœ‰æ¿€æ´»çŠ¶æ€çš„ç”¨æˆ·**

```java
// å®Œæ•´çš„æŸ¥è¯¢æµç¨‹
public List<User> findActiveUsers() {
    // 1. è·å–æ„å»ºå™¨
    CriteriaBuilder cb = entityManager.getCriteriaBuilder();
    
    // 2. åˆ›å»ºæŸ¥è¯¢å¯¹è±¡
    CriteriaQuery<User> query = cb.createQuery(User.class);
    
    // 3. æŒ‡å®šæŸ¥è¯¢çš„è¡¨ï¼ˆRootï¼‰
    Root<User> root = query.from(User.class);
    
    // 4. æ„å»ºæŸ¥è¯¢æ¡ä»¶
    Predicate condition = cb.equal(root.get("status"), "ACTIVE");
    
    // 5. è®¾ç½®æ¡ä»¶åˆ°æŸ¥è¯¢
    query.select(root).where(condition);
    
    // 6. æ‰§è¡Œå¹¶è¿”å›ç»“æœ
    return entityManager.createQuery(query).getResultList();
}
```

**ç­‰ä»·çš„SQLï¼š**
```sql
SELECT * FROM user WHERE status = 'ACTIVE'
```

### 3.2 æ¡ä»¶æŸ¥è¯¢è¯¦è§£


**ğŸ”¸ ç­‰å€¼æŸ¥è¯¢**
```java
// ç²¾ç¡®åŒ¹é…
cb.equal(root.get("name"), "å¼ ä¸‰")
cb.equal(root.get("age"), 25)

// ä¸ç­‰äº
cb.notEqual(root.get("status"), "DELETED")
```

**ğŸ”¸ æ¨¡ç³ŠæŸ¥è¯¢**
```java
// åŒ…å«ï¼ˆ%keyword%ï¼‰
cb.like(root.get("name"), "%" + keyword + "%")

// ä»¥...å¼€å¤´ï¼ˆkeyword%ï¼‰
cb.like(root.get("name"), keyword + "%")

// ä»¥...ç»“å°¾ï¼ˆ%keywordï¼‰
cb.like(root.get("name"), "%" + keyword)

// ä¸åŒºåˆ†å¤§å°å†™çš„æ¨¡ç³ŠæŸ¥è¯¢
cb.like(cb.lower(root.get("name")), "%" + keyword.toLowerCase() + "%")
```

**ğŸ”¸ èŒƒå›´æŸ¥è¯¢**
```java
// æ•°å€¼èŒƒå›´
cb.between(root.get("age"), 18, 60)         // 18 <= age <= 60
cb.gt(root.get("salary"), 5000)             // salary > 5000
cb.ge(root.get("salary"), 5000)             // salary >= 5000
cb.lt(root.get("salary"), 10000)            // salary < 10000
cb.le(root.get("salary"), 10000)            // salary <= 10000

// æ—¥æœŸèŒƒå›´
cb.between(root.get("createTime"), startDate, endDate)
```

**ğŸ”¸ é›†åˆæŸ¥è¯¢**
```java
// INæŸ¥è¯¢
List<String> cities = Arrays.asList("åŒ—äº¬", "ä¸Šæµ·", "æ·±åœ³");
root.get("city").in(cities)

// NOT IN
cb.not(root.get("city").in(cities))
```

**ğŸ”¸ NULLå€¼åˆ¤æ–­**
```java
// æ˜¯å¦ä¸ºç©º
cb.isNull(root.get("email"))

// æ˜¯å¦ä¸ä¸ºç©º
cb.isNotNull(root.get("phone"))
```

### 3.3 æ’åºä¸åˆ†é¡µ


**ğŸ”¸ æ’åº**
```java
// å•å­—æ®µæ’åº
query.orderBy(cb.asc(root.get("age")));          // å‡åº
query.orderBy(cb.desc(root.get("createTime")));  // é™åº

// å¤šå­—æ®µæ’åº
query.orderBy(
    cb.desc(root.get("level")),      // å…ˆæŒ‰ç­‰çº§é™åº
    cb.asc(root.get("createTime"))   // å†æŒ‰æ—¶é—´å‡åº
);
```

**ğŸ”¸ åˆ†é¡µæŸ¥è¯¢**
```java
public List<User> findUsersByPage(int page, int size) {
    CriteriaBuilder cb = entityManager.getCriteriaBuilder();
    CriteriaQuery<User> query = cb.createQuery(User.class);
    Root<User> root = query.from(User.class);
    
    query.select(root);
    
    // æ‰§è¡Œåˆ†é¡µ
    return entityManager.createQuery(query)
        .setFirstResult(page * size)  // èµ·å§‹ä½ç½®
        .setMaxResults(size)           // æ¯é¡µæ•°é‡
        .getResultList();
}
```

### 3.4 èšåˆæŸ¥è¯¢


**ğŸ”¸ ç»Ÿè®¡æ•°é‡**
```java
// æŸ¥è¯¢æ€»æ•°
CriteriaQuery<Long> countQuery = cb.createQuery(Long.class);
Root<User> root = countQuery.from(User.class);
countQuery.select(cb.count(root));

Long total = entityManager.createQuery(countQuery).getSingleResult();
```

**ğŸ”¸ æ±‚å’Œã€å¹³å‡å€¼ã€æœ€å¤§æœ€å°å€¼**
```java
// æ±‚å’Œ
countQuery.select(cb.sum(root.get("salary")));

// å¹³å‡å€¼
countQuery.select(cb.avg(root.get("age")));

// æœ€å¤§å€¼
countQuery.select(cb.max(root.get("score")));

// æœ€å°å€¼
countQuery.select(cb.min(root.get("price")));
```

---

## 4. âš¡ åŠ¨æ€æ¡ä»¶æ„å»º


### 4.1 ä¸ºä»€ä¹ˆéœ€è¦åŠ¨æ€æŸ¥è¯¢


**å®é™…åœºæ™¯ï¼šå•†å“æœç´¢åŠŸèƒ½**
```
ç”¨æˆ·å¯èƒ½çš„è¾“å…¥ç»„åˆï¼š
â–¡ åªè¾“å…¥å•†å“åç§°
â–¡ åªé€‰æ‹©ä»·æ ¼åŒºé—´  
â–¡ åªé€‰æ‹©åˆ†ç±»
â–¡ åç§° + ä»·æ ¼
â–¡ åç§° + åˆ†ç±»
â–¡ ä»·æ ¼ + åˆ†ç±»
â–¡ åç§° + ä»·æ ¼ + åˆ†ç±»
â–¡ ä»€ä¹ˆéƒ½ä¸è¾“å…¥ï¼ˆæ˜¾ç¤ºå…¨éƒ¨ï¼‰

ä¼ ç»Ÿæ–¹å¼ï¼šéœ€è¦å†™8ä¸ªä¸åŒçš„æŸ¥è¯¢æ–¹æ³•
åŠ¨æ€æŸ¥è¯¢ï¼šä¸€ä¸ªæ–¹æ³•æå®šæ‰€æœ‰æƒ…å†µï¼
```

### 4.2 åŠ¨æ€æŸ¥è¯¢çš„æ ¸å¿ƒæ€è·¯


**ğŸ¯ æ ¸å¿ƒåŸç†ï¼šç”¨Listæ”¶é›†æ¡ä»¶ï¼Œæœ€åç»Ÿä¸€åº”ç”¨**

```
æ€è·¯æ­¥éª¤ï¼š
1. åˆ›å»ºä¸€ä¸ªç©ºçš„æ¡ä»¶åˆ—è¡¨
2. æ ¹æ®ç”¨æˆ·è¾“å…¥ï¼ŒåŠ¨æ€æ·»åŠ æ¡ä»¶
3. æŠŠæ‰€æœ‰æ¡ä»¶ç»„åˆæˆæŸ¥è¯¢
4. æ‰§è¡ŒæŸ¥è¯¢

å°±åƒç‚¹å¤–å–ï¼š
1. å…ˆæ‹¿ä¸ªç©ºé¤ç›’
2. é¡¾å®¢è¯´è¦ä»€ä¹ˆå°±åŠ ä»€ä¹ˆ
3. æœ€åæ‰“åŒ…é€å‡º
```

### 4.3 åŠ¨æ€æŸ¥è¯¢å®æˆ˜ç¤ºä¾‹


**å®Œæ•´ç¤ºä¾‹ï¼šå•†å“æœç´¢**

```java
public List<Product> searchProducts(String name, 
                                    BigDecimal minPrice, 
                                    BigDecimal maxPrice,
                                    String category) {
    
    CriteriaBuilder cb = entityManager.getCriteriaBuilder();
    CriteriaQuery<Product> query = cb.createQuery(Product.class);
    Root<Product> root = query.from(Product.class);
    
    // â­ æ ¸å¿ƒï¼šåˆ›å»ºæ¡ä»¶åˆ—è¡¨
    List<Predicate> predicates = new ArrayList<>();
    
    // æ ¹æ®è¾“å…¥åŠ¨æ€æ·»åŠ æ¡ä»¶
    if (name != null && !name.trim().isEmpty()) {
        predicates.add(
            cb.like(root.get("name"), "%" + name + "%")
        );
    }
    
    if (minPrice != null) {
        predicates.add(
            cb.ge(root.get("price"), minPrice)
        );
    }
    
    if (maxPrice != null) {
        predicates.add(
            cb.le(root.get("price"), maxPrice)
        );
    }
    
    if (category != null && !category.trim().isEmpty()) {
        predicates.add(
            cb.equal(root.get("category"), category)
        );
    }
    
    // åº”ç”¨æ‰€æœ‰æ¡ä»¶ï¼ˆANDå…³ç³»ï¼‰
    if (!predicates.isEmpty()) {
        query.where(predicates.toArray(new Predicate[0]));
    }
    
    // æ’åº
    query.orderBy(cb.desc(root.get("createTime")));
    
    return entityManager.createQuery(query).getResultList();
}
```

**è°ƒç”¨ç¤ºä¾‹ï¼š**
```java
// åªæœç´¢åç§°
searchProducts("æ‰‹æœº", null, null, null);
// SQL: WHERE name LIKE '%æ‰‹æœº%'

// åªæœç´¢ä»·æ ¼
searchProducts(null, 1000, 5000, null);
// SQL: WHERE price >= 1000 AND price <= 5000

// ç»„åˆæœç´¢
searchProducts("æ‰‹æœº", 1000, 5000, "ç”µå­äº§å“");
// SQL: WHERE name LIKE '%æ‰‹æœº%' 
//      AND price >= 1000 
//      AND price <= 5000 
//      AND category = 'ç”µå­äº§å“'
```

### 4.4 ORæ¡ä»¶çš„åŠ¨æ€æ„å»º


**åœºæ™¯ï¼šæœç´¢åç§°æˆ–æè¿°åŒ…å«å…³é”®è¯**

```java
public List<Product> searchByKeyword(String keyword) {
    CriteriaBuilder cb = entityManager.getCriteriaBuilder();
    CriteriaQuery<Product> query = cb.createQuery(Product.class);
    Root<Product> root = query.from(Product.class);
    
    if (keyword != null && !keyword.trim().isEmpty()) {
        // åˆ›å»ºORæ¡ä»¶ï¼šåç§°æˆ–æè¿°åŒ…å«å…³é”®è¯
        Predicate nameLike = cb.like(root.get("name"), "%" + keyword + "%");
        Predicate descLike = cb.like(root.get("description"), "%" + keyword + "%");
        
        query.where(cb.or(nameLike, descLike));
    }
    
    return entityManager.createQuery(query).getResultList();
}
```

**ç­‰ä»·SQLï¼š**
```sql
SELECT * FROM product 
WHERE name LIKE '%å…³é”®è¯%' OR description LIKE '%å…³é”®è¯%'
```

### 4.5 å¤æ‚æ¡ä»¶ç»„åˆ


**åœºæ™¯ï¼š(æ¡ä»¶A AND æ¡ä»¶B) OR (æ¡ä»¶C AND æ¡ä»¶D)**

```java
// (name = 'æ‰‹æœº' AND price < 2000) OR (category = 'ç‰¹ä»·' AND stock > 0)

Predicate condition1 = cb.and(
    cb.equal(root.get("name"), "æ‰‹æœº"),
    cb.lt(root.get("price"), 2000)
);

Predicate condition2 = cb.and(
    cb.equal(root.get("category"), "ç‰¹ä»·"),
    cb.gt(root.get("stock"), 0)
);

query.where(cb.or(condition1, condition2));
```

---

## 5. ğŸ›¡ï¸ ç±»å‹å®‰å…¨çš„ä¼˜åŠ¿


### 5.1 ä»€ä¹ˆæ˜¯ç±»å‹å®‰å…¨


**é€šä¿—è§£é‡Šï¼š**
```
ç±»å‹å®‰å…¨ = ç¼–è¯‘å™¨å¸®ä½ æ£€æŸ¥ç±»å‹æ˜¯å¦åŒ¹é…

ç”Ÿæ´»ä¾‹å­ï¼š
- ä¸å®‰å…¨ï¼šä½ è¯´"ç»™æˆ‘æ‹¿ä¸ªä¸œè¥¿"ï¼ˆä»€ä¹ˆä¸œè¥¿ï¼Ÿä¸æ˜ç¡®ï¼‰
- å®‰å…¨ï¼šä½ è¯´"ç»™æˆ‘æ‹¿ä¸ªè‹¹æœ"ï¼ˆæ˜ç¡®æ˜¯è‹¹æœï¼Œæ‹¿é”™äº†ç«‹åˆ»å‘ç°ï¼‰

ä»£ç ä¾‹å­ï¼š
- ä¸å®‰å…¨ï¼šquery("WHERE age = 'abc'")  // ageæ˜¯æ•°å­—ï¼Œå†™æˆå­—ç¬¦ä¸²
- å®‰å…¨ï¼šcb.equal(root.get("age"), 18)  // ç±»å‹ä¸å¯¹ç¼–è¯‘å™¨æŠ¥é”™
```

### 5.2 ç¼–è¯‘æ—¶æ£€æŸ¥çš„ä»·å€¼


**å¯¹æ¯”æ¼”ç¤ºï¼š**

**âŒ å­—ç¬¦ä¸²æŸ¥è¯¢ï¼ˆè¿è¡Œæ—¶æ‰å‘ç°é”™è¯¯ï¼‰**
```java
// å­—æ®µåæ‹¼å†™é”™è¯¯
String jpql = "SELECT u FROM User u WHERE u.nmae = ?1";  // nameæ‹¼æˆnmae
Query query = em.createQuery(jpql);
query.setParameter(1, "å¼ ä¸‰");
query.getResultList();  // ğŸ’¥ è¿è¡Œæ—¶æŠ¥é”™ï¼
```

**âœ… CriteriaæŸ¥è¯¢ï¼ˆç¼–è¯‘æ—¶ç«‹å³å‘ç°ï¼‰**
```java
CriteriaBuilder cb = em.getCriteriaBuilder();
CriteriaQuery<User> query = cb.createQuery(User.class);
Root<User> root = query.from(User.class);

query.where(cb.equal(root.get("nmae"), "å¼ ä¸‰"));  
// IDEç«‹åˆ»æ ‡çº¢ï¼Œç¼–è¯‘å¤±è´¥ï¼Œä¸å¯èƒ½è¿è¡Œï¼
```

### 5.3 IDEæ™ºèƒ½æç¤º


**ğŸ”¸ è‡ªåŠ¨è¡¥å…¨**
```java
Root<User> root = query.from(User.class);

// è¾“å…¥ root.get("  IDEä¼šæç¤ºUserç±»çš„æ‰€æœ‰å­—æ®µï¼š
//   - id
//   - name
//   - age
//   - email
//   - status
//   ...

// é€‰æ‹©åè‡ªåŠ¨è¡¥å…¨ï¼Œä¸ä¼šæ‹¼é”™ï¼
```

**ğŸ”¸ é‡æ„å®‰å…¨**
```java
// åœºæ™¯ï¼šæŠŠUserç±»çš„å­—æ®µ userName æ”¹åä¸º fullName

å­—ç¬¦ä¸²æŸ¥è¯¢ï¼š
query("SELECT u FROM User u WHERE u.userName = ?1")
// âŒ æ”¹ååè¿™é‡Œä¸ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œè¿è¡Œæ—¶æŠ¥é”™

CriteriaæŸ¥è¯¢ï¼š
cb.equal(root.get("userName"), name)
// âœ… IDEä¼šæç¤º"å­—æ®µä¸å­˜åœ¨"ï¼Œç«‹å³ä¿®æ­£
```

### 5.4 é˜²æ­¢SQLæ³¨å…¥


**ğŸ”¸ å­—ç¬¦ä¸²æ‹¼æ¥çš„é£é™©**
```java
// âŒ å±é™©ï¼å¯èƒ½è¢«æ³¨å…¥
String name = request.getParameter("name");
String jpql = "SELECT u FROM User u WHERE u.name = '" + name + "'";
// å¦‚æœname = "' OR '1'='1"
// SQLå˜æˆ: WHERE u.name = '' OR '1'='1'  (æŸ¥å‡ºæ‰€æœ‰æ•°æ®ï¼)
```

**ğŸ”¸ Criteriaå¤©ç„¶é˜²æ³¨å…¥**
```java
// âœ… å®‰å…¨ï¼å‚æ•°åŒ–æŸ¥è¯¢
String name = request.getParameter("name");
cb.equal(root.get("name"), name)
// æ— è®ºnameæ˜¯ä»€ä¹ˆå€¼ï¼Œéƒ½ä½œä¸ºå‚æ•°å¤„ç†ï¼Œä¸ä¼šæ‹¼æ¥åˆ°SQL
```

### 5.5 ç±»å‹å®‰å…¨æ€»ç»“


| ä¼˜åŠ¿é¡¹ | **å­—ç¬¦ä¸²æŸ¥è¯¢** | **Criteria API** |
|--------|--------------|-----------------|
| ğŸ” é”™è¯¯å‘ç°æ—¶æœº | `è¿è¡Œæ—¶` | `ç¼–è¯‘æ—¶` |
| ğŸ’¡ IDEæç¤º | `æ— ` | `è‡ªåŠ¨è¡¥å…¨ã€é”™è¯¯æç¤º` |
| ğŸ”„ é‡æ„æ”¯æŒ | `æ‰‹åŠ¨æŸ¥æ‰¾æ›¿æ¢` | `è‡ªåŠ¨é‡æ„` |
| ğŸ›¡ï¸ SQLæ³¨å…¥ | `éœ€æ‰‹åŠ¨é˜²æŠ¤` | `è‡ªåŠ¨é˜²æŠ¤` |
| ğŸ“š å­¦ä¹ æˆæœ¬ | `ä½` | `ä¸­ç­‰` |
| ğŸ¯ æ¨èåœºæ™¯ | `ç®€å•å›ºå®šæŸ¥è¯¢` | `å¤æ‚åŠ¨æ€æŸ¥è¯¢` |

---

## 6. ğŸª å®æˆ˜åº”ç”¨åœºæ™¯


### 6.1 åœºæ™¯1ï¼šç”¨æˆ·ç®¡ç†ç³»ç»Ÿæœç´¢


**éœ€æ±‚ï¼šæ”¯æŒå¤šæ¡ä»¶ç»„åˆæœç´¢ç”¨æˆ·**
- å§“åæ¨¡ç³ŠæŸ¥è¯¢
- å¹´é¾„èŒƒå›´
- éƒ¨é—¨é€‰æ‹©
- çŠ¶æ€ç­›é€‰

```java
public List<User> searchUsers(String name, 
                              Integer minAge, 
                              Integer maxAge,
                              Long deptId, 
                              String status) {
    
    CriteriaBuilder cb = em.getCriteriaBuilder();
    CriteriaQuery<User> query = cb.createQuery(User.class);
    Root<User> root = query.from(User.class);
    
    List<Predicate> predicates = new ArrayList<>();
    
    // å§“åæ¨¡ç³ŠæŸ¥è¯¢
    if (name != null && !name.isEmpty()) {
        predicates.add(
            cb.like(root.get("name"), "%" + name + "%")
        );
    }
    
    // å¹´é¾„èŒƒå›´
    if (minAge != null) {
        predicates.add(cb.ge(root.get("age"), minAge));
    }
    if (maxAge != null) {
        predicates.add(cb.le(root.get("age"), maxAge));
    }
    
    // éƒ¨é—¨ç­›é€‰ï¼ˆå…³è”æŸ¥è¯¢ï¼‰
    if (deptId != null) {
        predicates.add(
            cb.equal(root.get("department").get("id"), deptId)
        );
    }
    
    // çŠ¶æ€ç­›é€‰
    if (status != null) {
        predicates.add(cb.equal(root.get("status"), status));
    }
    
    query.where(predicates.toArray(new Predicate[0]));
    query.orderBy(cb.desc(root.get("createTime")));
    
    return em.createQuery(query).getResultList();
}
```

### 6.2 åœºæ™¯2ï¼šè®¢å•ç»Ÿè®¡æŸ¥è¯¢


**éœ€æ±‚ï¼šç»Ÿè®¡æŒ‡å®šæ—¶é—´èŒƒå›´å†…çš„è®¢å•æ•°æ®**

```java
public OrderStatistics getOrderStats(Date startDate, Date endDate) {
    CriteriaBuilder cb = em.getCriteriaBuilder();
    CriteriaQuery<Object[]> query = cb.createQuery(Object[].class);
    Root<Order> root = query.from(Order.class);
    
    // æ„å»ºæ—¶é—´èŒƒå›´æ¡ä»¶
    Predicate datePredicate = cb.between(
        root.get("createTime"), 
        startDate, 
        endDate
    );
    
    // æŸ¥è¯¢ï¼šæ€»è®¢å•æ•°ã€æ€»é‡‘é¢ã€å¹³å‡é‡‘é¢
    query.multiselect(
        cb.count(root),                    // æ€»è®¢å•æ•°
        cb.sum(root.get("totalAmount")),   // æ€»é‡‘é¢
        cb.avg(root.get("totalAmount"))    // å¹³å‡é‡‘é¢
    ).where(datePredicate);
    
    Object[] result = em.createQuery(query).getSingleResult();
    
    return new OrderStatistics(
        (Long) result[0],           // è®¢å•æ•°
        (BigDecimal) result[1],     // æ€»é‡‘é¢
        (Double) result[2]          // å¹³å‡é‡‘é¢
    );
}
```

### 6.3 åœºæ™¯3ï¼šåˆ†é¡µæŸ¥è¯¢å°è£…


**é€šç”¨åˆ†é¡µå·¥å…·**

```java
public class CriteriaPage<T> {
    
    public PageResult<T> findByPage(
            Class<T> entityClass,
            List<Predicate> predicates,
            int page, 
            int size) {
        
        CriteriaBuilder cb = em.getCriteriaBuilder();
        
        // æŸ¥è¯¢æ•°æ®
        CriteriaQuery<T> dataQuery = cb.createQuery(entityClass);
        Root<T> root = dataQuery.from(entityClass);
        
        if (predicates != null && !predicates.isEmpty()) {
            dataQuery.where(predicates.toArray(new Predicate[0]));
        }
        
        List<T> data = em.createQuery(dataQuery)
            .setFirstResult(page * size)
            .setMaxResults(size)
            .getResultList();
        
        // æŸ¥è¯¢æ€»æ•°
        CriteriaQuery<Long> countQuery = cb.createQuery(Long.class);
        Root<T> countRoot = countQuery.from(entityClass);
        countQuery.select(cb.count(countRoot));
        
        if (predicates != null && !predicates.isEmpty()) {
            countQuery.where(predicates.toArray(new Predicate[0]));
        }
        
        Long total = em.createQuery(countQuery).getSingleResult();
        
        return new PageResult<>(data, total, page, size);
    }
}
```

### 6.4 åœºæ™¯4ï¼šå¤æ‚å…³è”æŸ¥è¯¢


**éœ€æ±‚ï¼šæŸ¥è¯¢ç”¨æˆ·åŠå…¶è®¢å•ä¿¡æ¯ï¼ˆé¿å…N+1é—®é¢˜ï¼‰**

```java
public List<User> findUsersWithOrders(String city) {
    CriteriaBuilder cb = em.getCriteriaBuilder();
    CriteriaQuery<User> query = cb.createQuery(User.class);
    Root<User> root = query.from(User.class);
    
    // ğŸ”¥ å…³é”®ï¼šä½¿ç”¨fetché¢„åŠ è½½è®¢å•ï¼Œé¿å…N+1é—®é¢˜
    root.fetch("orders", JoinType.LEFT);
    
    // æ·»åŠ æŸ¥è¯¢æ¡ä»¶
    if (city != null) {
        query.where(cb.equal(root.get("city"), city));
    }
    
    // å»é‡ï¼ˆå› ä¸ºLEFT JOINå¯èƒ½äº§ç”Ÿé‡å¤ï¼‰
    query.distinct(true);
    
    return em.createQuery(query).getResultList();
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ¯ å››å¤§æ ¸å¿ƒç»„ä»¶**
```
CriteriaBuilder  â†’ å·¥å…·ç®±ï¼ˆæä¾›å„ç§æ„å»ºæ–¹æ³•ï¼‰
CriteriaQuery    â†’ æŸ¥è¯¢å¯¹è±¡ï¼ˆå®Œæ•´çš„æŸ¥è¯¢æè¿°ï¼‰
Root            â†’ æ ¹å¯¹è±¡ï¼ˆæŸ¥è¯¢çš„èµ·ç‚¹ï¼‰
Predicate       â†’ æ¡ä»¶è°“è¯ï¼ˆWHEREåé¢çš„æ¡ä»¶ï¼‰
```

**ğŸ¯ Criteria APIçš„æ ¸å¿ƒä»·å€¼**
```
âœ… ç±»å‹å®‰å…¨ï¼šç¼–è¯‘æ—¶æ£€æŸ¥ï¼Œå‡å°‘é”™è¯¯
âœ… åŠ¨æ€æŸ¥è¯¢ï¼šæ ¹æ®æ¡ä»¶çµæ´»ç»„åˆ
âœ… é˜²SQLæ³¨å…¥ï¼šè‡ªåŠ¨å‚æ•°åŒ–
âœ… IDEå‹å¥½ï¼šè‡ªåŠ¨è¡¥å…¨ã€é‡æ„å®‰å…¨
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä»€ä¹ˆæ—¶å€™ç”¨Criteria**
```
æ¨èä½¿ç”¨ï¼š
â–¡ åŠ¨æ€æ¡ä»¶æŸ¥è¯¢ï¼ˆæ¡ä»¶ä¸å›ºå®šï¼‰
â–¡ å¤æ‚æŸ¥è¯¢é€»è¾‘ï¼ˆå¤šè¡¨å…³è”ã€å­æŸ¥è¯¢ï¼‰
â–¡ éœ€è¦ç±»å‹å®‰å…¨ä¿éšœ
â–¡ æŸ¥è¯¢æ¡ä»¶éœ€è¦ç¼–ç¨‹æ§åˆ¶

ä¸æ¨èä½¿ç”¨ï¼š
â–¡ ç®€å•å›ºå®šæŸ¥è¯¢ï¼ˆç”¨@Queryæ›´ç®€æ´ï¼‰
â–¡ å›¢é˜Ÿä¸ç†Ÿæ‚‰Criteriaï¼ˆå­¦ä¹ æˆæœ¬ï¼‰
```

**ğŸ”¹ åŠ¨æ€æŸ¥è¯¢çš„æ ¸å¿ƒæ€è·¯**
```java
// è®°ä½è¿™ä¸ªæ¨¡å¼ï¼š
List<Predicate> predicates = new ArrayList<>();

if (æ¡ä»¶1å­˜åœ¨) {
    predicates.add(æ„å»ºæ¡ä»¶1);
}
if (æ¡ä»¶2å­˜åœ¨) {
    predicates.add(æ„å»ºæ¡ä»¶2);
}

query.where(predicates.toArray(new Predicate[0]));
```

**ğŸ”¹ å¸¸è§æ¡ä»¶æ„å»º**
```java
ç­‰äºï¼š      cb.equal(field, value)
æ¨¡ç³Šï¼š      cb.like(field, "%value%")
å¤§äºï¼š      cb.gt(field, value) / cb.ge(field, value)
å°äºï¼š      cb.lt(field, value) / cb.le(field, value)
èŒƒå›´ï¼š      cb.between(field, min, max)
åŒ…å«ï¼š      field.in(list)
ä¸ºç©ºï¼š      cb.isNull(field) / cb.isNotNull(field)
ç»„åˆï¼š      cb.and(p1, p2) / cb.or(p1, p2)
```

### 7.3 å®æˆ˜å»ºè®®


**ğŸ“ æœ€ä½³å®è·µ**
```
1. ä¼˜å…ˆè€ƒè™‘å¯è¯»æ€§
   - åˆç†å‘½åå˜é‡
   - é€‚å½“æ·»åŠ æ³¨é‡Š
   - å¤æ‚é€»è¾‘æ‹†åˆ†æ–¹æ³•

2. æ€§èƒ½ä¼˜åŒ–
   - ä½¿ç”¨fetché¿å…N+1
   - åªæŸ¥è¯¢éœ€è¦çš„å­—æ®µ
   - åˆç†ä½¿ç”¨åˆ†é¡µ

3. ä»£ç å¤ç”¨
   - å°è£…é€šç”¨çš„æŸ¥è¯¢æ¡ä»¶
   - æå–åˆ†é¡µæŸ¥è¯¢å·¥å…·
   - å»ºç«‹æŸ¥è¯¢æ¨¡æ¿

4. å›¢é˜Ÿåä½œ
   - ç»Ÿä¸€ä»£ç é£æ ¼
   - ç¼–å†™æ¸…æ™°æ–‡æ¡£
   - åšå¥½å•å…ƒæµ‹è¯•
```

**âš ï¸ å¸¸è§é™·é˜±**
```
âŒ å¿˜è®°ç±»å‹è½¬æ¢
   cb.sum() è¿”å›çš„æ˜¯Numberï¼Œéœ€è¦è½¬æ¢æˆå…·ä½“ç±»å‹

âŒ å­—æ®µåå†™é”™
   root.get("nmae") // æ‹¼å†™é”™è¯¯
   å»ºè®®ä½¿ç”¨å…ƒæ¨¡å‹ï¼šroot.get(User_.name)

âŒ å¿½ç•¥NULLå€¼å¤„ç†
   æŸ¥è¯¢å‰æ£€æŸ¥å‚æ•°æ˜¯å¦ä¸ºnull

âŒ å…³è”æŸ¥è¯¢å¿˜è®°å»é‡
   ä½¿ç”¨fetchæ—¶è®°å¾—distinct(true)
```

### 7.4 å­¦ä¹ è·¯å¾„å»ºè®®


**ğŸ“š å¾ªåºæ¸è¿›**
```
ç¬¬1æ­¥ï¼šæŒæ¡åŸºç¡€æŸ¥è¯¢
      â†“ ç®€å•æ¡ä»¶ã€æ’åºã€åˆ†é¡µ
      
ç¬¬2æ­¥ï¼šç†è§£åŠ¨æ€æŸ¥è¯¢
      â†“ æ¡ä»¶ç»„åˆã€Listæ”¶é›†
      
ç¬¬3æ­¥ï¼šå¤„ç†å¤æ‚åœºæ™¯
      â†“ å…³è”æŸ¥è¯¢ã€èšåˆç»Ÿè®¡
      
ç¬¬4æ­¥ï¼šæ€§èƒ½ä¼˜åŒ–
      â†“ fetché¢„åŠ è½½ã€æŸ¥è¯¢ä¼˜åŒ–
      
ç¬¬5æ­¥ï¼šå·¥ç¨‹å®è·µ
      â†“ å°è£…å·¥å…·ã€å›¢é˜Ÿè§„èŒƒ
```

**ğŸ¯ æ ¸å¿ƒè®°å¿†å£è¯€**
```
Builderé€ å·¥å…·ï¼ŒQueryæ˜¯è“å›¾
Rootå®šèµ·ç‚¹ï¼ŒPredicateåŠ æ¡ä»¶
åŠ¨æ€ç”¨Listæ”¶ï¼Œå®‰å…¨é ç¼–è¯‘
æŸ¥è¯¢æ›´çµæ´»ï¼Œç»´æŠ¤æ›´è½»æ¾
```