---
title: 22ã€å•è¡¨ç­–ç•¥SINGLE_TABLE
---
## ğŸ“š ç›®å½•

1. [ä¸ºä»€ä¹ˆéœ€è¦ç»§æ‰¿æ˜ å°„](#1-ä¸ºä»€ä¹ˆéœ€è¦ç»§æ‰¿æ˜ å°„)
2. [å•è¡¨ç»§æ‰¿ç­–ç•¥æ ¸å¿ƒæ¦‚å¿µ](#2-å•è¡¨ç»§æ‰¿ç­–ç•¥æ ¸å¿ƒæ¦‚å¿µ)
3. [@Inheritanceæ³¨è§£è¯¦è§£](#3-inheritanceæ³¨è§£è¯¦è§£)
4. [é‰´åˆ«å™¨æœºåˆ¶](#4-é‰´åˆ«å™¨æœºåˆ¶)
5. [å®Œæ•´å®æˆ˜æ¡ˆä¾‹](#5-å®Œæ•´å®æˆ˜æ¡ˆä¾‹)
6. [æ€§èƒ½ä¼˜åŠ¿ä¸é€‚ç”¨åœºæ™¯](#6-æ€§èƒ½ä¼˜åŠ¿ä¸é€‚ç”¨åœºæ™¯)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦ç»§æ‰¿æ˜ å°„


### 1.1 ç°å®ä¸šåŠ¡åœºæ™¯


**é—®é¢˜å¼•å…¥**ï¼šå‡è®¾ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç”µå•†ç³»ç»Ÿçš„æ”¯ä»˜æ¨¡å—

```
ä¸šåŠ¡éœ€æ±‚ï¼š
æ”¯ä»˜æ–¹å¼æœ‰å¤šç§ï¼š
â”œâ”€ ä¿¡ç”¨å¡æ”¯ä»˜ï¼ˆéœ€è¦å­˜å‚¨ï¼šå¡å·ã€æœ‰æ•ˆæœŸã€CVVç ï¼‰
â”œâ”€ æ”¯ä»˜å®æ”¯ä»˜ï¼ˆéœ€è¦å­˜å‚¨ï¼šæ”¯ä»˜å®è´¦å·ã€å®åä¿¡æ¯ï¼‰
â””â”€ å¾®ä¿¡æ”¯ä»˜ï¼ˆéœ€è¦å­˜å‚¨ï¼šå¾®ä¿¡OpenIDã€ç»‘å®šæ‰‹æœºï¼‰

å…±åŒå±æ€§ï¼š
- æ”¯ä»˜é‡‘é¢
- æ”¯ä»˜æ—¶é—´
- è®¢å•å·
- æ”¯ä»˜çŠ¶æ€
```

**ä¼ ç»Ÿåšæ³•çš„é—®é¢˜**ï¼š
```
æ–¹æ¡ˆ1ï¼šå»ºç«‹3å¼ ç‹¬ç«‹è¡¨
Payment_CreditCardã€Payment_Alipayã€Payment_WeChat
âŒ é—®é¢˜ï¼šæŸ¥è¯¢æ‰€æœ‰æ”¯ä»˜è®°å½•éœ€è¦UNIONä¸‰å¼ è¡¨ï¼Œæ€§èƒ½å·®

æ–¹æ¡ˆ2ï¼šå»ºç«‹ä¸€å¼ è¶…å¤§è¡¨åŒ…å«æ‰€æœ‰å­—æ®µ
Payment (id, amount, card_no, alipay_account, wechat_openid...)
âŒ é—®é¢˜ï¼šå¤§é‡ç©ºå­—æ®µæµªè´¹ç©ºé—´ï¼Œå­—æ®µå†—ä½™æ··ä¹±

æ–¹æ¡ˆ3ï¼šä½¿ç”¨ç»§æ‰¿æ˜ å°„ âœ…
ä¸€å¼ è¡¨å­˜å‚¨æ‰€æœ‰æ”¯ä»˜è®°å½•ï¼Œç”¨ç±»å‹å­—æ®µåŒºåˆ†ä¸åŒæ”¯ä»˜æ–¹å¼
```

### 1.2 é¢å‘å¯¹è±¡ä¸å…³ç³»æ•°æ®åº“çš„çŸ›ç›¾


**æ ¸å¿ƒçŸ›ç›¾**ï¼š
```
Javaä¸–ç•Œï¼ˆé¢å‘å¯¹è±¡ï¼‰ï¼š
public abstract class Payment { }        â† çˆ¶ç±»
public class CreditCardPayment extends Payment { }  â† å­ç±»
public class AlipayPayment extends Payment { }

æ•°æ®åº“ä¸–ç•Œï¼ˆå…³ç³»æ¨¡å‹ï¼‰ï¼š
è¡¨ä¹‹é—´æ²¡æœ‰"ç»§æ‰¿"æ¦‚å¿µï¼Œåªæœ‰å…³è”å…³ç³»ï¼ˆå¤–é”®ï¼‰
```

**JPAç»§æ‰¿æ˜ å°„çš„ä½œç”¨**ï¼š
> ğŸ’¡ **æœ¬è´¨**ï¼šJPAæä¾›äº†ä¸‰ç§ç­–ç•¥ï¼Œå°†Javaçš„ç±»ç»§æ‰¿å…³ç³»æ˜ å°„åˆ°æ•°æ®åº“è¡¨ç»“æ„ä¸­

---

## 2. ğŸ¯ å•è¡¨ç»§æ‰¿ç­–ç•¥æ ¸å¿ƒæ¦‚å¿µ


### 2.1 ä»€ä¹ˆæ˜¯å•è¡¨ç»§æ‰¿ç­–ç•¥


**ç›´è§‚ç†è§£**ï¼š
```
æ‰€æœ‰å­ç±»çš„æ•°æ®éƒ½å­˜åœ¨åŒä¸€å¼ è¡¨ä¸­ï¼Œç”¨ä¸€ä¸ª"ç±»å‹æ ‡è¯†åˆ—"æ¥åŒºåˆ†ä¸åŒçš„å­ç±»

Javaç±»ç»“æ„ï¼š                    æ•°æ®åº“è¡¨ç»“æ„ï¼š
   Payment                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”œâ”€ CreditCard     ====>    â”‚   payment (å•è¡¨)     â”‚
   â”œâ”€ Alipay                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â””â”€ WeChat                  â”‚ id                  â”‚
                              â”‚ amount              â”‚
                              â”‚ payment_type â† ç±»å‹åˆ— â”‚
                              â”‚ card_no             â”‚
                              â”‚ alipay_account      â”‚
                              â”‚ wechat_openid       â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®ç‰¹ç‚¹**ï¼š
- **ä¸€å¼ è¡¨**ï¼šçˆ¶ç±»å’Œæ‰€æœ‰å­ç±»æ•°æ®å­˜åœ¨åŒä¸€å¼ è¡¨
- **é‰´åˆ«å™¨åˆ—**ï¼šç”¨ç‰¹æ®Šå­—æ®µæ ‡è¯†å…·ä½“æ˜¯å“ªä¸ªå­ç±»
- **å­—æ®µåˆå¹¶**ï¼šæ‰€æœ‰å­ç±»çš„å­—æ®µéƒ½åœ¨è¿™å¼ è¡¨ä¸­

### 2.2 é‰´åˆ«å™¨ï¼ˆDiscriminatorï¼‰æœºåˆ¶


**ä»€ä¹ˆæ˜¯é‰´åˆ«å™¨**ï¼š
> é‰´åˆ«å™¨å°±åƒå•†å“çš„"åˆ†ç±»æ ‡ç­¾"ï¼Œå‘Šè¯‰JPAè¿™æ¡è®°å½•å¯¹åº”çš„æ˜¯å“ªä¸ªå­ç±»

```
å®é™…æ•°æ®ç¤ºä¾‹ï¼š

id  | amount | payment_type | card_no        | alipay_account | wechat_openid
----|--------|--------------|----------------|----------------|---------------
1   | 100.00 | CREDIT_CARD  | 6222***1234    | NULL           | NULL
2   | 50.00  | ALIPAY       | NULL           | user@ali.com   | NULL  
3   | 80.00  | WECHAT       | NULL           | NULL           | ox3kF2x...

é‰´åˆ«å™¨åˆ—ï¼špayment_type
- CREDIT_CARD â†’ å¯¹åº” CreditCardPayment ç±»
- ALIPAY â†’ å¯¹åº” AlipayPayment ç±»
- WECHAT â†’ å¯¹åº” WeChatPayment ç±»
```

---

## 3. ğŸ“ @Inheritanceæ³¨è§£è¯¦è§£


### 3.1 æ³¨è§£åŸºæœ¬ç”¨æ³•


**æ ¸å¿ƒæ³¨è§£**ï¼š
```java
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
```

**ä¸‰ä¸ªå…³é”®å‚æ•°**ï¼š

| å‚æ•°å | å«ä¹‰ | å¯é€‰å€¼ |
|--------|------|--------|
| `strategy` | ç»§æ‰¿ç­–ç•¥ç±»å‹ | `SINGLE_TABLE` / `JOINED` / `TABLE_PER_CLASS` |
| - | - | **æœ¬èŠ‚è®²SINGLE_TABLE** |

### 3.2 çˆ¶ç±»å®ä½“å®šä¹‰


```java
@Entity
@Table(name = "payment")
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)  // â† å•è¡¨ç­–ç•¥
public abstract class Payment {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @Column(nullable = false)
    private BigDecimal amount;  // æ”¯ä»˜é‡‘é¢
    
    @Column(name = "order_no", nullable = false)
    private String orderNo;     // è®¢å•å·
    
    @Column(name = "created_at")
    private LocalDateTime createdAt;  // åˆ›å»ºæ—¶é—´
    
    // getter/setterçœç•¥
}
```

**ä»£ç è§£æ**ï¼š
- `@Entity`ï¼šå£°æ˜è¿™æ˜¯JPAå®ä½“
- `abstract class`ï¼šçˆ¶ç±»é€šå¸¸è®¾ä¸ºæŠ½è±¡ç±»ï¼Œä¸ç›´æ¥å®ä¾‹åŒ–
- `@Inheritance(strategy = InheritanceType.SINGLE_TABLE)`ï¼šæŒ‡å®šä½¿ç”¨å•è¡¨ç­–ç•¥
- çˆ¶ç±»ä¸­å®šä¹‰**æ‰€æœ‰å­ç±»å…±æœ‰çš„å­—æ®µ**

---

## 4. ğŸ·ï¸ é‰´åˆ«å™¨æœºåˆ¶


### 4.1 @DiscriminatorColumn - å®šä¹‰é‰´åˆ«å™¨åˆ—


**ä½œç”¨**ï¼šåœ¨çˆ¶ç±»ä¸Šå®šä¹‰ç”¨äºåŒºåˆ†å­ç±»çš„åˆ—

```java
@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(
    name = "payment_type",           // â† æ•°æ®åº“åˆ—å
    discriminatorType = DiscriminatorType.STRING,  // â† æ•°æ®ç±»å‹
    length = 20                      // â† å­—ç¬¦ä¸²é•¿åº¦ï¼ˆå¯é€‰ï¼‰
)
public abstract class Payment {
    // ...
}
```

**å‚æ•°è¯¦è§£**ï¼š

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `name` | é‰´åˆ«å™¨åˆ—åœ¨æ•°æ®åº“ä¸­çš„å­—æ®µå | `"payment_type"` |
| `discriminatorType` | é‰´åˆ«å™¨å€¼çš„æ•°æ®ç±»å‹ | `STRING` / `INTEGER` / `CHAR` |
| `length` | å­—ç¬¦ä¸²ç±»å‹æ—¶çš„æœ€å¤§é•¿åº¦ | `20` |

> ğŸ’¡ **æç¤º**ï¼šå¦‚æœä¸å†™`@DiscriminatorColumn`ï¼ŒJPAä¼šè‡ªåŠ¨åˆ›å»ºåä¸º`DTYPE`çš„åˆ—

### 4.2 @DiscriminatorValue - å®šä¹‰é‰´åˆ«å™¨å€¼


**ä½œç”¨**ï¼šåœ¨å­ç±»ä¸ŠæŒ‡å®šè¯¥å­ç±»å¯¹åº”çš„é‰´åˆ«å™¨å€¼

```java
// ä¿¡ç”¨å¡æ”¯ä»˜å­ç±»
@Entity
@DiscriminatorValue("CREDIT_CARD")  // â† è¿™ä¸ªç±»çš„æ ‡è¯†å€¼
public class CreditCardPayment extends Payment {
    
    @Column(name = "card_no")
    private String cardNo;          // å¡å·
    
    @Column(name = "expire_date")
    private String expireDate;      // æœ‰æ•ˆæœŸ
    
    private String cvv;             // CVVç 
}

// æ”¯ä»˜å®æ”¯ä»˜å­ç±»
@Entity
@DiscriminatorValue("ALIPAY")
public class AlipayPayment extends Payment {
    
    @Column(name = "alipay_account")
    private String alipayAccount;   // æ”¯ä»˜å®è´¦å·
    
    @Column(name = "real_name")
    private String realName;        // å®åä¿¡æ¯
}

// å¾®ä¿¡æ”¯ä»˜å­ç±»
@Entity
@DiscriminatorValue("WECHAT")
public class WeChatPayment extends Payment {
    
    @Column(name = "wechat_openid")
    private String wechatOpenId;    // å¾®ä¿¡OpenID
    
    @Column(name = "phone_number")
    private String phoneNumber;     // ç»‘å®šæ‰‹æœº
}
```

**å·¥ä½œåŸç†**ï¼š
```
æ’å…¥æ•°æ®æ—¶ï¼š
JPAè‡ªåŠ¨åœ¨payment_typeåˆ—å¡«å…¥å¯¹åº”çš„é‰´åˆ«å™¨å€¼
new CreditCardPayment() â†’ payment_type = 'CREDIT_CARD'

æŸ¥è¯¢æ•°æ®æ—¶ï¼š
JPAæ ¹æ®payment_typeåˆ—çš„å€¼ï¼Œè‡ªåŠ¨åˆ›å»ºå¯¹åº”çš„å­ç±»å¯¹è±¡
payment_type = 'ALIPAY' â†’ è¿”å› AlipayPayment å¯¹è±¡
```

---

## 5. ğŸ’» å®Œæ•´å®æˆ˜æ¡ˆä¾‹


### 5.1 æ•°æ®åº“è¡¨ç»“æ„


**å•è¡¨å­˜å‚¨æ‰€æœ‰æ”¯ä»˜ç±»å‹**ï¼š
```sql
CREATE TABLE payment (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    payment_type VARCHAR(20) NOT NULL,    -- é‰´åˆ«å™¨åˆ—
    amount DECIMAL(10,2) NOT NULL,
    order_no VARCHAR(50) NOT NULL,
    created_at DATETIME,
    
    -- ä¿¡ç”¨å¡æ”¯ä»˜ä¸“å±å­—æ®µ
    card_no VARCHAR(20),
    expire_date VARCHAR(7),
    cvv VARCHAR(4),
    
    -- æ”¯ä»˜å®æ”¯ä»˜ä¸“å±å­—æ®µ
    alipay_account VARCHAR(50),
    real_name VARCHAR(20),
    
    -- å¾®ä¿¡æ”¯ä»˜ä¸“å±å­—æ®µ
    wechat_openid VARCHAR(50),
    phone_number VARCHAR(15)
);
```

### 5.2 Repositoryæ¥å£å®šä¹‰


```java
public interface PaymentRepository extends JpaRepository<Payment, Long> {
    
    // æŸ¥è¯¢æ‰€æœ‰æ”¯ä»˜è®°å½•ï¼ˆè‡ªåŠ¨è¯†åˆ«å­ç±»ï¼‰
    List<Payment> findAll();
    
    // æ ¹æ®è®¢å•å·æŸ¥è¯¢
    Payment findByOrderNo(String orderNo);
    
    // æŸ¥è¯¢æŒ‡å®šç±»å‹çš„æ”¯ä»˜è®°å½•
    List<Payment> findByOrderNoContaining(String keyword);
}
```

### 5.3 ä¸šåŠ¡ä»£ç ç¤ºä¾‹


**ä¿å­˜ä¸åŒç±»å‹çš„æ”¯ä»˜è®°å½•**ï¼š
```java
@Service
public class PaymentService {
    
    @Autowired
    private PaymentRepository paymentRepository;
    
    // ä¿å­˜ä¿¡ç”¨å¡æ”¯ä»˜
    public void saveCreditCardPayment() {
        CreditCardPayment payment = new CreditCardPayment();
        payment.setAmount(new BigDecimal("100.00"));
        payment.setOrderNo("ORD20231201001");
        payment.setCardNo("6222021234567890");
        payment.setExpireDate("12/25");
        payment.setCvv("123");
        payment.setCreatedAt(LocalDateTime.now());
        
        paymentRepository.save(payment);
        // JPAè‡ªåŠ¨åœ¨payment_typeåˆ—å¡«å…¥ 'CREDIT_CARD'
    }
    
    // ä¿å­˜æ”¯ä»˜å®æ”¯ä»˜
    public void saveAlipayPayment() {
        AlipayPayment payment = new AlipayPayment();
        payment.setAmount(new BigDecimal("50.00"));
        payment.setOrderNo("ORD20231201002");
        payment.setAlipayAccount("user@alipay.com");
        payment.setRealName("å¼ ä¸‰");
        payment.setCreatedAt(LocalDateTime.now());
        
        paymentRepository.save(payment);
        // JPAè‡ªåŠ¨åœ¨payment_typeåˆ—å¡«å…¥ 'ALIPAY'
    }
}
```

**æŸ¥è¯¢å¹¶å¤„ç†ä¸åŒç±»å‹**ï¼š
```java
public void processPayments() {
    List<Payment> payments = paymentRepository.findAll();
    
    for (Payment payment : payments) {
        // ä½¿ç”¨ instanceof åˆ¤æ–­å…·ä½“ç±»å‹
        if (payment instanceof CreditCardPayment) {
            CreditCardPayment cc = (CreditCardPayment) payment;
            System.out.println("ä¿¡ç”¨å¡æ”¯ä»˜ï¼š" + cc.getCardNo());
            
        } else if (payment instanceof AlipayPayment) {
            AlipayPayment alipay = (AlipayPayment) payment;
            System.out.println("æ”¯ä»˜å®æ”¯ä»˜ï¼š" + alipay.getRealName());
            
        } else if (payment instanceof WeChatPayment) {
            WeChatPayment wechat = (WeChatPayment) payment;
            System.out.println("å¾®ä¿¡æ”¯ä»˜ï¼š" + wechat.getPhoneNumber());
        }
    }
}
```

### 5.4 æ‰§è¡Œæµç¨‹å›¾ç¤º


```
ä¿å­˜æµç¨‹ï¼š
å¼€å‘è€…ä»£ç                     JPAæ¡†æ¶                      æ•°æ®åº“
    |                          |                            |
    |--new CreditCardPayment--->|                            |
    |  è®¾ç½®é‡‘é¢ã€å¡å·ç­‰          |                            |
    |                          |                            |
    |--save()------------------>|--è¯†åˆ«ä¸ºCreditCardPayment--->|
    |                          |--è®¾ç½®payment_type='CREDIT_CARD'|
    |                          |--ç»„è£…INSERT SQL------------>|
    |                          |                            |--å†™å…¥å•è¡¨payment
    |<----------------------------|<----------------------------|
    
æŸ¥è¯¢æµç¨‹ï¼š
å¼€å‘è€…ä»£ç                     JPAæ¡†æ¶                      æ•°æ®åº“
    |                          |                            |
    |--findAll()--------------->|--æ‰§è¡ŒSELECT * FROM payment->|
    |                          |                            |--è¿”å›æ‰€æœ‰è¡Œ
    |                          |<----------------------------|
    |                          |                            |
    |                          |--è¯»å–payment_typeåˆ—-------->|
    |                          |  'CREDIT_CARD' â†’ new CreditCardPayment()
    |                          |  'ALIPAY' â†’ new AlipayPayment()
    |                          |                            |
    |<--List<Payment>-----------|                            |
```

---

## 6. âš–ï¸ æ€§èƒ½ä¼˜åŠ¿ä¸é€‚ç”¨åœºæ™¯


### 6.1 å•è¡¨ç­–ç•¥çš„æ€§èƒ½ä¼˜ç‚¹


**ğŸš€ æŸ¥è¯¢æ€§èƒ½ä¼˜åŠ¿**ï¼š

| ä¼˜åŠ¿ç‚¹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| **æ— éœ€JOIN** | æ‰€æœ‰æ•°æ®åœ¨ä¸€å¼ è¡¨ï¼ŒæŸ¥è¯¢é€Ÿåº¦å¿« | `SELECT * FROM payment` ä¸€å¥æå®š |
| **ç´¢å¼•é«˜æ•ˆ** | å¯ä»¥åœ¨å•è¡¨ä¸Šå»ºç«‹ç´¢å¼• | `CREATE INDEX idx_order ON payment(order_no)` |
| **å¤šæ€æŸ¥è¯¢ç®€å•** | æŸ¥è¯¢æ‰€æœ‰å­ç±»ä¸éœ€è¦UNION | `paymentRepository.findAll()` |

**å¯¹æ¯”å…¶ä»–ç­–ç•¥**ï¼š
```
JOINEDç­–ç•¥ï¼ˆå¤šè¡¨ï¼‰ï¼š
SELECT * FROM payment p
LEFT JOIN credit_card_payment cc ON p.id = cc.id
LEFT JOIN alipay_payment ap ON p.id = ap.id
LEFT JOIN wechat_payment wp ON p.id = wp.id
âŒ éœ€è¦å¤šæ¬¡JOINï¼Œæ€§èƒ½è¾ƒå·®

SINGLE_TABLEç­–ç•¥ï¼ˆå•è¡¨ï¼‰ï¼š
SELECT * FROM payment
âœ… ä¸€æ¬¡æŸ¥è¯¢å®Œæˆï¼Œæ€§èƒ½æœ€ä¼˜
```

### 6.2 ç¨€ç–åˆ—é—®é¢˜


**ä»€ä¹ˆæ˜¯ç¨€ç–åˆ—**ï¼š
> ç”±äºä¸åŒå­ç±»çš„ä¸“å±å­—æ®µå­˜åœ¨åŒä¸€å¼ è¡¨ï¼Œä¼šå¯¼è‡´å¤§é‡å­—æ®µä¸ºNULL

**é—®é¢˜ç¤ºä¾‹**ï¼š
```
paymentè¡¨æ•°æ®ï¼š

id | payment_type | card_no      | alipay_account | wechat_openid
---|--------------|--------------|----------------|---------------
1  | CREDIT_CARD  | 6222***1234  | NULL          | NULL
2  | ALIPAY       | NULL         | user@ali.com  | NULL
3  | WECHAT       | NULL         | NULL          | ox3kF2x...

é—®é¢˜åˆ†æï¼š
- æ¯è¡Œæ•°æ®éƒ½æœ‰2/3çš„å­—æ®µä¸ºNULL
- æµªè´¹å­˜å‚¨ç©ºé—´
- ä½†å¯¹æŸ¥è¯¢æ€§èƒ½å½±å“ä¸å¤§ï¼ˆæ•°æ®åº“ä¼šä¼˜åŒ–NULLå­˜å‚¨ï¼‰
```

**ä½•æ—¶ç¨€ç–åˆ—é—®é¢˜ä¸¥é‡**ï¼š
- âŒ å­ç±»ä¸“å±å­—æ®µå¾ˆå¤šï¼ˆ>10ä¸ªï¼‰
- âŒ å­ç±»å·®å¼‚å¾ˆå¤§
- âŒ æŸäº›å­—æ®µæ˜¯å¤§å¯¹è±¡ï¼ˆTEXTã€BLOBï¼‰

**è§£å†³å»ºè®®**ï¼š
```
è½»åº¦å·®å¼‚ï¼šâœ… ç»§ç»­ä½¿ç”¨å•è¡¨ç­–ç•¥
ä¸­åº¦å·®å¼‚ï¼šè€ƒè™‘ JOINED ç­–ç•¥ï¼ˆæ¯ä¸ªå­ç±»ä¸€å¼ è¡¨ï¼‰
é‡åº¦å·®å¼‚ï¼šè€ƒè™‘ TABLE_PER_CLASS ç­–ç•¥ï¼ˆçˆ¶ç±»å’Œå­ç±»å„è‡ªç‹¬ç«‹è¡¨ï¼‰
```

### 6.3 é€‚ç”¨åœºæ™¯åˆ¤æ–­


**âœ… é€‚åˆä½¿ç”¨å•è¡¨ç­–ç•¥çš„åœºæ™¯**ï¼š

```
åœºæ™¯1ï¼šå­ç±»å·®å¼‚å°
ä¾‹ï¼šUser â†’ VipUserã€NormalUser
å…±æœ‰å­—æ®µï¼šå§“åã€é‚®ç®±ã€å¯†ç ...
ä¸“å±å­—æ®µï¼šVIPç­‰çº§ã€ç§¯åˆ†ï¼ˆåªå¤š2-3ä¸ªå­—æ®µï¼‰

åœºæ™¯2ï¼šæŸ¥è¯¢é¢‘ç¹
ä¾‹ï¼šå•†å“åˆ†ç±» â†’ ç”µå­äº§å“ã€å›¾ä¹¦ã€æœè£…
éœ€è¦ç»å¸¸æŸ¥è¯¢"æ‰€æœ‰å•†å“"ï¼Œå•è¡¨æ€§èƒ½æœ€ä¼˜

åœºæ™¯3ï¼šæ€§èƒ½ä¼˜å…ˆ
ä¾‹ï¼šæ—¥å¿—ç³»ç»Ÿ â†’ æ“ä½œæ—¥å¿—ã€é”™è¯¯æ—¥å¿—ã€è®¿é—®æ—¥å¿—
å†™å…¥å’ŒæŸ¥è¯¢éƒ½è¦æ±‚é«˜æ€§èƒ½
```

**âŒ ä¸é€‚åˆå•è¡¨ç­–ç•¥çš„åœºæ™¯**ï¼š

```
åœºæ™¯1ï¼šå­ç±»å­—æ®µå·®å¼‚å·¨å¤§
ä¾‹ï¼šå¤šåª’ä½“ â†’ å›¾ç‰‡ï¼ˆå°ºå¯¸ã€åˆ†è¾¨ç‡ï¼‰ã€è§†é¢‘ï¼ˆæ—¶é•¿ã€ç ç‡ã€å­—å¹•ï¼‰ã€éŸ³é¢‘ï¼ˆé‡‡æ ·ç‡ã€å£°é“ï¼‰
å·®å¼‚å­—æ®µè¶…è¿‡15ä¸ªï¼Œç¨€ç–åˆ—ä¸¥é‡

åœºæ™¯2ï¼šå­ç±»ç‹¬ç«‹æ“ä½œå¤š
ä¾‹ï¼šè®¢å•ç³»ç»Ÿ â†’ æ™®é€šè®¢å•ã€é¢„å”®è®¢å•ã€å›¢è´­è®¢å•
éœ€è¦ç»å¸¸åªæŸ¥è¯¢æŸä¸€ç§è®¢å•ç±»å‹

åœºæ™¯3ï¼šå­˜åœ¨å¤§å­—æ®µ
ä¾‹ï¼šæ–‡ç«  â†’ æ™®é€šæ–‡ç« ã€å¯Œæ–‡æœ¬æ–‡ç« ï¼ˆcontentå­—æ®µTEXTç±»å‹ï¼‰
å¤§å­—æ®µå¯¼è‡´å•è¡¨è‡ƒè‚¿
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ¦‚å¿µ


```
ğŸ”¸ å•è¡¨ç»§æ‰¿ç­–ç•¥ï¼šæ‰€æœ‰å­ç±»æ•°æ®å­˜åœ¨åŒä¸€å¼ è¡¨
ğŸ”¸ é‰´åˆ«å™¨åˆ—ï¼šç”¨ç‰¹æ®Šå­—æ®µï¼ˆå¦‚payment_typeï¼‰åŒºåˆ†ä¸åŒå­ç±»
ğŸ”¸ @Inheritanceï¼šåœ¨çˆ¶ç±»ä¸Šå£°æ˜ç»§æ‰¿ç­–ç•¥
ğŸ”¸ @DiscriminatorColumnï¼šå®šä¹‰é‰´åˆ«å™¨åˆ—åå’Œç±»å‹
ğŸ”¸ @DiscriminatorValueï¼šåœ¨å­ç±»ä¸ŠæŒ‡å®šé‰´åˆ«å™¨å€¼
```

### 7.2 å…³é”®æ³¨è§£å¯¹ç…§è¡¨


| æ³¨è§£ | ä½ç½® | ä½œç”¨ | ç¤ºä¾‹ |
|------|------|------|------|
| `@Inheritance` | çˆ¶ç±» | å£°æ˜ç»§æ‰¿ç­–ç•¥ | `@Inheritance(strategy = SINGLE_TABLE)` |
| `@DiscriminatorColumn` | çˆ¶ç±» | å®šä¹‰é‰´åˆ«å™¨åˆ— | `@DiscriminatorColumn(name = "type")` |
| `@DiscriminatorValue` | å­ç±» | æŒ‡å®šå­ç±»æ ‡è¯†å€¼ | `@DiscriminatorValue("CREDIT_CARD")` |

### 7.3 ä¼˜ç¼ºç‚¹å¯¹æ¯”


**âœ… ä¼˜ç‚¹**ï¼š
- æŸ¥è¯¢æ€§èƒ½æœ€ä¼˜ï¼ˆæ— éœ€JOINï¼‰
- å¤šæ€æŸ¥è¯¢ç®€å•
- ç´¢å¼•æ•ˆç‡é«˜
- ä»£ç ç»“æ„æ¸…æ™°

**âŒ ç¼ºç‚¹**ï¼š
- ç¨€ç–åˆ—æµªè´¹ç©ºé—´
- å­—æ®µçº¦æŸéš¾å®ç°ï¼ˆå­ç±»å­—æ®µä¸èƒ½NOT NULLï¼‰
- è¡¨ç»“æ„ä¸ç›´è§‚
- å­ç±»å·®å¼‚å¤§æ—¶ä¸é€‚ç”¨

### 7.4 å®æˆ˜è®°å¿†å£è¯€


> ğŸ§  **è®°å¿†è¦è¯€**ï¼š
> 
> å•è¡¨ç»§æ‰¿ä¸€å¼ è¡¨ï¼Œé‰´åˆ«å™¨åˆ—åˆ†å­ç±»  
> çˆ¶ç±»å£°æ˜Inheritanceï¼Œå­ç±»æ ‡æ³¨Valueå€¼  
> æŸ¥è¯¢å¿«é€Ÿæ— éœ€JOINï¼Œç¨€ç–åˆ—é—®é¢˜éœ€æ³¨æ„  
> å·®å¼‚å°æ—¶ç”¨å•è¡¨ï¼Œå·®å¼‚å¤§æ—¶é€‰å…¶ä»–

### 7.5 å¸¸è§é—®é¢˜é€ŸæŸ¥


**Q1ï¼šä¸å†™`@DiscriminatorColumn`ä¼šæ€æ ·ï¼Ÿ**
> Aï¼šJPAè‡ªåŠ¨åˆ›å»ºåä¸º`DTYPE`çš„VARCHARåˆ—ä½œä¸ºé‰´åˆ«å™¨

**Q2ï¼šé‰´åˆ«å™¨åˆ—å¯ä»¥æ˜¯æ•°å­—å—ï¼Ÿ**
> Aï¼šå¯ä»¥ï¼Œè®¾ç½®`discriminatorType = DiscriminatorType.INTEGER`

**Q3ï¼šå­ç±»å¯ä»¥ä¸å†™`@DiscriminatorValue`å—ï¼Ÿ**
> Aï¼šå¯ä»¥ï¼ŒJPAä¼šç”¨ç±»åä½œä¸ºé»˜è®¤å€¼

**Q4ï¼šå¦‚ä½•æŸ¥è¯¢æŒ‡å®šå­ç±»çš„æ•°æ®ï¼Ÿ**
> Aï¼šå®šä¹‰å­ç±»ä¸“å±Repositoryï¼Œä¾‹å¦‚`CreditCardPaymentRepository`

**Q5ï¼šå•è¡¨ç­–ç•¥çš„æ€§èƒ½ç“¶é¢ˆåœ¨å“ªï¼Ÿ**
> Aï¼šè¡¨å­—æ®µè¿‡å¤šï¼ˆ>50ä¸ªï¼‰æ—¶ï¼Œç´¢å¼•æ•ˆç‡ä¸‹é™ï¼Œæ­¤æ—¶åº”è€ƒè™‘å…¶ä»–ç­–ç•¥

---

**ğŸ¯ ä¸‹ä¸€æ­¥å­¦ä¹ æ–¹å‘**ï¼š
- ğŸ“– [4.2 è”åˆè¡¨ç»§æ‰¿ç­–ç•¥JOINED](./è”åˆè¡¨ç­–ç•¥JOINED.md)
- ğŸ“– [4.3 æ¯ç±»ä¸€è¡¨ç­–ç•¥TABLE_PER_CLASS](./æ¯ç±»ä¸€è¡¨ç­–ç•¥.md)
- ğŸ“– [4.4 ç»§æ‰¿ç­–ç•¥å¯¹æ¯”ä¸é€‰æ‹©](./ç»§æ‰¿ç­–ç•¥å¯¹æ¯”.md)