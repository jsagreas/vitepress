---
title: 47ã€æ–¹æ³•å‘½åæŸ¥è¯¢å†™æ³•é€ŸæŸ¥
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯æ–¹æ³•å‘½åæŸ¥è¯¢](#1-ä»€ä¹ˆæ˜¯æ–¹æ³•å‘½åæŸ¥è¯¢)
2. [åŸºç¡€æŸ¥è¯¢å‰ç¼€](#2-åŸºç¡€æŸ¥è¯¢å‰ç¼€)
3. [æ¡ä»¶å…³é”®å­—è¯¦è§£](#3-æ¡ä»¶å…³é”®å­—è¯¦è§£)
4. [é€»è¾‘è¿æ¥ç¬¦](#4-é€»è¾‘è¿æ¥ç¬¦)
5. [æ’åºä¸é™åˆ¶](#5-æ’åºä¸é™åˆ¶)
6. [å®æˆ˜åº”ç”¨åœºæ™¯](#6-å®æˆ˜åº”ç”¨åœºæ™¯)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ä»€ä¹ˆæ˜¯æ–¹æ³•å‘½åæŸ¥è¯¢


### 1.1 é€šä¿—ç†è§£


**ä»€ä¹ˆæ˜¯æ–¹æ³•å‘½åæŸ¥è¯¢ï¼Ÿ**
å°±åƒç»™æ–¹æ³•èµ·ä¸ª"ä¼šè¯´è¯çš„åå­—"ï¼ŒSpring Data JPAå°±èƒ½è‡ªåŠ¨å¸®ä½ å†™SQLï¼

```
ä¼ ç»Ÿåšæ³•ï¼šéœ€è¦æ‰‹å†™SQL
@Query("SELECT u FROM User u WHERE u.name = ?1")
User findUserByName(String name);

æ–¹æ³•å‘½åæŸ¥è¯¢ï¼šåªéœ€è¦æŒ‰è§„åˆ™èµ·åå­—
User findByName(String name);  // Springè‡ªåŠ¨ç”ŸæˆSQLï¼
```

**æ ¸å¿ƒæ€æƒ³**ï¼š
```
æ–¹æ³•å = æŸ¥è¯¢æ„å›¾çš„è‡ªç„¶è¯­è¨€æè¿°

findBy + å±æ€§å + æ¡ä»¶ = è‡ªåŠ¨ç”ŸæˆSQL
  â†“        â†“       â†“
æŸ¥è¯¢    å­—æ®µ    è¿‡æ»¤æ¡ä»¶
```

### 1.2 ä¸ºä»€ä¹ˆè¦ç”¨æ–¹æ³•å‘½åæŸ¥è¯¢


**ä¼˜åŠ¿å¯¹æ¯”**ï¼š

| å¯¹æ¯”é¡¹ | ä¼ ç»ŸSQLæ–¹å¼ | æ–¹æ³•å‘½åæŸ¥è¯¢ |
|--------|-------------|--------------|
| **ç¼–ç é‡** | éœ€è¦å†™å®Œæ•´SQLè¯­å¥ | åªéœ€å®šä¹‰æ–¹æ³•å |
| **é”™è¯¯ç‡** | SQLè¯­æ³•å¯èƒ½å‡ºé”™ | ç¼–è¯‘æœŸæ£€æŸ¥ï¼Œç±»å‹å®‰å…¨ |
| **ç»´æŠ¤æ€§** | SQLå­—ç¬¦ä¸²éš¾ç»´æŠ¤ | æ–¹æ³•åå³æ–‡æ¡£ |
| **å­¦ä¹ æˆæœ¬** | éœ€è¦ç†Ÿæ‚‰JPQL/SQL | è®°ä½å‘½åè§„åˆ™å³å¯ |

**ç”Ÿæ´»ç±»æ¯”**ï¼š
```
â”Œâ”€ ç†è§£ç±»æ¯” â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å°±åƒç‚¹å¤–å–ï¼š              â”‚
â”‚                          â”‚
â”‚ ä¼ ç»Ÿæ–¹å¼ï¼šè¯¦ç»†æè¿°æ¯ä¸ªæ­¥éª¤ â”‚
â”‚ "å…ˆå»XXåº—ï¼Œç‚¹ä¸€ä»½å®«ä¿é¸¡ä¸ï¼Œ â”‚
â”‚  è¦å¾®è¾£ï¼Œå¤šåŠ èŠ±ç”Ÿç±³..."    â”‚
â”‚                          â”‚
â”‚ æ–¹æ³•å‘½åï¼šç›´æ¥è¯´éœ€æ±‚      â”‚
â”‚ "æ¥ä»½å®«ä¿é¸¡ä¸å¾®è¾£"        â”‚
â”‚ â†’ ç³»ç»Ÿè‡ªåŠ¨å¤„ç†ç»†èŠ‚        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 é€‚ç”¨åœºæ™¯


**âœ… é€‚åˆä½¿ç”¨çš„æƒ…å†µ**ï¼š
- ç®€å•çš„å•è¡¨æŸ¥è¯¢
- å¸¸è§çš„CRUDæ“ä½œ
- æ¡ä»¶ä¸è¶…è¿‡3-4ä¸ª
- æŸ¥è¯¢é€»è¾‘å›ºå®šä¸å˜

**âŒ ä¸é€‚åˆçš„æƒ…å†µ**ï¼š
- å¤æ‚çš„å¤šè¡¨å…³è”
- åŠ¨æ€æ¡ä»¶ç»„åˆ
- éœ€è¦ä¼˜åŒ–çš„å¤æ‚SQL
- åŒ…å«å­æŸ¥è¯¢æˆ–èšåˆå‡½æ•°

---

## 2. ğŸ“ åŸºç¡€æŸ¥è¯¢å‰ç¼€


### 2.1 æŸ¥è¯¢ç±»å‰ç¼€ï¼ˆfind/get/read/queryï¼‰


**æ ¸å¿ƒç†è§£**ï¼šè¿™å››ä¸ªå‰ç¼€ä½œç”¨å®Œå…¨ç›¸åŒï¼Œåªæ˜¯è¯­ä¹‰ä¸åŒ

```java
// ä»¥ä¸‹å››ç§å†™æ³•æ•ˆæœä¸€æ¨¡ä¸€æ ·ï¼Œé€‰ä½ å–œæ¬¢çš„ç”¨
User findByEmail(String email);
User getByEmail(String email);
User readByEmail(String email);
User queryByEmail(String email);

// Springç”Ÿæˆçš„SQLéƒ½æ˜¯ï¼š
// SELECT * FROM user WHERE email = ?
```

**ğŸ’¡ å‘½åå»ºè®®**ï¼š
```
findBy   - æœ€å¸¸ç”¨ï¼Œé€šç”¨æŸ¥è¯¢
getBy    - è·å–å•ä¸ªå¯¹è±¡æ—¶ç”¨
readBy   - åªè¯»æŸ¥è¯¢æ—¶ç”¨
queryBy  - å¼ºè°ƒæŸ¥è¯¢è¯­ä¹‰æ—¶ç”¨

å»ºè®®ï¼šç»Ÿä¸€ä½¿ç”¨findByï¼Œå›¢é˜Ÿé£æ ¼ä¸€è‡´
```

### 2.2 å­˜åœ¨æ€§æ£€æŸ¥ï¼ˆexistsï¼‰


**ä½œç”¨**ï¼šåˆ¤æ–­ç¬¦åˆæ¡ä»¶çš„æ•°æ®æ˜¯å¦å­˜åœ¨ï¼Œè¿”å›true/false

```java
// æ£€æŸ¥é‚®ç®±æ˜¯å¦å·²æ³¨å†Œ
boolean existsByEmail(String email);
// SQL: SELECT COUNT(*) > 0 FROM user WHERE email = ?

// æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å­˜åœ¨
boolean existsByUsername(String username);
```

**å®é™…åº”ç”¨**ï¼š
```java
// æ³¨å†Œæ—¶æ£€æŸ¥é‚®ç®±æ˜¯å¦é‡å¤
public void register(User user) {
    if (userRepository.existsByEmail(user.getEmail())) {
        throw new RuntimeException("é‚®ç®±å·²è¢«æ³¨å†Œ");
    }
    userRepository.save(user);
}
```

**ğŸ” æ€§èƒ½å¯¹æ¯”**ï¼š
```
æ–¹å¼1ï¼šæŸ¥è¯¢ååˆ¤æ–­ï¼ˆä¸æ¨èï¼‰
User user = findByEmail(email);
if (user != null) { ... }
// é—®é¢˜ï¼šè¿”å›å®Œæ•´å¯¹è±¡ï¼Œæµªè´¹å†…å­˜

æ–¹å¼2ï¼šexistsByï¼ˆæ¨èï¼‰
if (existsByEmail(email)) { ... }
// ä¼˜åŠ¿ï¼šåªè¿”å›booleanï¼Œé«˜æ•ˆ
```

### 2.3 è®¡æ•°æŸ¥è¯¢ï¼ˆcountï¼‰


**ä½œç”¨**ï¼šç»Ÿè®¡ç¬¦åˆæ¡ä»¶çš„è®°å½•æ•°é‡ï¼Œè¿”å›longç±»å‹

```java
// ç»Ÿè®¡æŸä¸ªçŠ¶æ€çš„ç”¨æˆ·æ•°
long countByStatus(String status);
// SQL: SELECT COUNT(*) FROM user WHERE status = ?

// ç»Ÿè®¡å¹´é¾„å¤§äº18çš„ç”¨æˆ·
long countByAgeGreaterThan(int age);
// SQL: SELECT COUNT(*) FROM user WHERE age > ?
```

**åº”ç”¨åœºæ™¯**ï¼š
```java
// åˆ†é¡µå‰è·å–æ€»æ•°
long total = userRepository.countByStatus("ACTIVE");
int pageSize = 10;
int totalPages = (int) Math.ceil(total / (double) pageSize);

// æ•°æ®ç»Ÿè®¡
long newUsers = userRepository.countByCreateTimeBetween(
    startDate, endDate
);
```

### 2.4 åˆ é™¤æ“ä½œï¼ˆdelete/removeï¼‰


**ä½œç”¨**ï¼šæ ¹æ®æ¡ä»¶åˆ é™¤æ•°æ®

```java
// åˆ é™¤æŸä¸ªçŠ¶æ€çš„ç”¨æˆ·
@Transactional  // åˆ é™¤æ“ä½œå¿…é¡»åŠ äº‹åŠ¡ï¼
void deleteByStatus(String status);
// SQL: DELETE FROM user WHERE status = ?

// ä¹Ÿå¯ä»¥ç”¨removeï¼ˆæ•ˆæœç›¸åŒï¼‰
@Transactional
void removeByStatus(String status);
```

**âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹**ï¼š

```
å¿…é¡»åŠ @Transactionalï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âŒ é”™è¯¯å†™æ³•                 â”‚
â”‚ void deleteByStatus(String) â”‚
â”‚ â†’ è¿è¡Œæ—¶æŠ¥é”™ï¼              â”‚
â”‚                             â”‚
â”‚ âœ… æ­£ç¡®å†™æ³•                 â”‚
â”‚ @Transactional              â”‚
â”‚ void deleteByStatus(String) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è¿”å›å€¼é€‰æ‹©**ï¼š
```java
// ä¸éœ€è¦è¿”å›å€¼
@Transactional
void deleteByStatus(String status);

// è¿”å›åˆ é™¤çš„æ•°é‡
@Transactional
long deleteByStatus(String status);

// è¿”å›åˆ é™¤çš„å®ä½“åˆ—è¡¨
@Transactional
List<User> deleteByStatus(String status);
```

---

## 3. ğŸ” æ¡ä»¶å…³é”®å­—è¯¦è§£


### 3.1 ç›¸ç­‰ä¸ä¸ç­‰ï¼ˆIs/Equals/Notï¼‰


**åŸºç¡€ç”¨æ³•**ï¼š

```java
// ç²¾ç¡®åŒ¹é…ï¼ˆä¸‰ç§å†™æ³•ç­‰æ•ˆï¼‰
User findByName(String name);           // æ¨èï¼šç®€æ´
User findByNameIs(String name);         // æ˜ç¡®è¯­ä¹‰
User findByNameEquals(String name);     // æœ€æ¸…æ™°

// SQLéƒ½æ˜¯ï¼šWHERE name = ?
```

**ä¸ç­‰äº**ï¼š
```java
// æŸ¥æ‰¾çŠ¶æ€ä¸æ˜¯DELETEDçš„ç”¨æˆ·
List<User> findByStatusNot(String status);
// SQL: WHERE status != ?

// ä¹Ÿå¯ä»¥ç”¨IsNot
List<User> findByStatusIsNot(String status);
```

**nullå€¼å¤„ç†**ï¼š
```java
// æŸ¥æ‰¾é‚®ç®±ä¸ºç©ºçš„ç”¨æˆ·
List<User> findByEmailIsNull();
// SQL: WHERE email IS NULL

// æŸ¥æ‰¾é‚®ç®±ä¸ä¸ºç©ºçš„ç”¨æˆ·  
List<User> findByEmailIsNotNull();
// SQL: WHERE email IS NOT NULL
```

### 3.2 èŒƒå›´æŸ¥è¯¢ï¼ˆBetween/LessThan/GreaterThanï¼‰


**æ•°å€¼èŒƒå›´**ï¼š

```java
// å¹´é¾„åœ¨18-60ä¹‹é—´
List<User> findByAgeBetween(int start, int end);
// SQL: WHERE age BETWEEN ? AND ?

// å¹´é¾„å°äº18
List<User> findByAgeLessThan(int age);
// SQL: WHERE age < ?

// å¹´é¾„å°äºç­‰äº18
List<User> findByAgeLessThanEqual(int age);
// SQL: WHERE age <= ?

// å¹´é¾„å¤§äº18
List<User> findByAgeGreaterThan(int age);
// SQL: WHERE age > ?

// å¹´é¾„å¤§äºç­‰äº18
List<User> findByAgeGreaterThanEqual(int age);
// SQL: WHERE age >= ?
```

**æ—¥æœŸèŒƒå›´**ï¼š
```java
// æŸ¥è¯¢æŸä¸ªæ—¶é—´æ®µçš„è®¢å•
List<Order> findByCreateTimeBetween(
    LocalDateTime start, 
    LocalDateTime end
);

// æŸ¥è¯¢ä»Šå¤©ä¹‹å‰åˆ›å»ºçš„
List<Order> findByCreateTimeBefore(LocalDateTime date);

// æŸ¥è¯¢ä»Šå¤©ä¹‹ååˆ›å»ºçš„
List<Order> findByCreateTimeAfter(LocalDateTime date);
```

**ğŸ’¡ å®é™…åº”ç”¨**ï¼š
```java
// è·å–æœ¬æœˆæ–°ç”¨æˆ·
LocalDateTime monthStart = LocalDateTime.now()
    .withDayOfMonth(1)
    .withHour(0).withMinute(0).withSecond(0);
    
List<User> newUsers = userRepository
    .findByCreateTimeAfter(monthStart);
```

### 3.3 æ¨¡ç³ŠæŸ¥è¯¢ï¼ˆLike/Containing/StartingWith/EndingWithï¼‰


**å››ç§æ¨¡ç³ŠåŒ¹é…æ–¹å¼**ï¼š

```java
// 1. Likeï¼šéœ€è¦è‡ªå·±åŠ é€šé…ç¬¦%
List<User> findByNameLike(String pattern);
// è°ƒç”¨ï¼šfindByNameLike("%å¼ %")
// SQL: WHERE name LIKE ?

// 2. Containingï¼šè‡ªåŠ¨å‰ååŠ %ï¼ˆæœ€å¸¸ç”¨ï¼‰
List<User> findByNameContaining(String keyword);
// è°ƒç”¨ï¼šfindByNameContaining("å¼ ")
// SQL: WHERE name LIKE %?%

// 3. StartingWithï¼šè‡ªåŠ¨åé¢åŠ %
List<User> findByNameStartingWith(String prefix);
// è°ƒç”¨ï¼šfindByNameStartingWith("å¼ ")
// SQL: WHERE name LIKE ?%

// 4. EndingWithï¼šè‡ªåŠ¨å‰é¢åŠ %
List<User> findByNameEndingWith(String suffix);
// è°ƒç”¨ï¼šfindByNameEndingWith("ä¸‰")
// SQL: WHERE name LIKE %?
```

**é€‰æ‹©å»ºè®®**ï¼š
```
â”Œâ”€ ä½¿ç”¨åœºæ™¯ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Containing   â†’ æœç´¢æ¡†      â”‚
â”‚ StartingWith â†’ å§“æ°ç­›é€‰    â”‚
â”‚ EndingWith   â†’ åç¼€åŒ¹é…    â”‚
â”‚ Like         â†’ å¤æ‚æ¨¡å¼    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®é™…ç¤ºä¾‹**ï¼š
```java
// æœç´¢åŠŸèƒ½ï¼šç”¨æˆ·è¾“å…¥"å¼ ä¸‰"
List<User> findByNameContaining("å¼ ä¸‰");
// èƒ½åŒ¹é…ï¼šå¼ ä¸‰ã€å¼ ä¸‰ä¸°ã€å°å¼ ä¸‰

// å§“æ°ç­›é€‰ï¼šæŸ¥æ‰¾å§“å¼ çš„
List<User> findByNameStartingWith("å¼ ");
// èƒ½åŒ¹é…ï¼šå¼ ä¸‰ã€å¼ é£ã€å¼ æ— å¿Œ

// é‚®ç®±åŸŸåç­›é€‰ï¼šæŸ¥æ‰¾QQé‚®ç®±
List<User> findByEmailEndingWith("@qq.com");
```

### 3.4 é›†åˆæŸ¥è¯¢ï¼ˆIn/NotInï¼‰


**InæŸ¥è¯¢**ï¼šå­—æ®µå€¼åœ¨ç»™å®šé›†åˆä¸­

```java
// æŸ¥è¯¢æŒ‡å®šçŠ¶æ€çš„ç”¨æˆ·
List<User> findByStatusIn(Collection<String> statuses);

// è°ƒç”¨ç¤ºä¾‹
List<String> activeStatuses = Arrays.asList(
    "ACTIVE", "PREMIUM", "VIP"
);
List<User> users = userRepository
    .findByStatusIn(activeStatuses);
// SQL: WHERE status IN ('ACTIVE', 'PREMIUM', 'VIP')
```

**NotInæŸ¥è¯¢**ï¼šå­—æ®µå€¼ä¸åœ¨ç»™å®šé›†åˆä¸­

```java
// æ’é™¤æŸäº›çŠ¶æ€
List<User> findByStatusNotIn(Collection<String> statuses);

// ç¤ºä¾‹ï¼šæŸ¥è¯¢éç¦ç”¨ç”¨æˆ·
List<String> excludeStatuses = Arrays.asList(
    "BANNED", "DELETED", "SUSPENDED"
);
List<User> validUsers = userRepository
    .findByStatusNotIn(excludeStatuses);
```

**ğŸ¯ åº”ç”¨åœºæ™¯**ï¼š
```java
// æ‰¹é‡IDæŸ¥è¯¢
List<Long> ids = Arrays.asList(1L, 2L, 3L, 4L, 5L);
List<User> users = userRepository.findByIdIn(ids);

// å¤šé€‰ç­›é€‰ï¼ˆå¦‚å‰ç«¯å¤šé€‰æ¡†ï¼‰
List<String> selectedRoles = getSelectedRoles();
List<User> users = userRepository
    .findByRoleIn(selectedRoles);
```

### 3.5 å¸ƒå°”å€¼æŸ¥è¯¢ï¼ˆTrue/Falseï¼‰


```java
// æŸ¥è¯¢å·²æ¿€æ´»çš„ç”¨æˆ·
List<User> findByActiveTrue();
// SQL: WHERE active = true

// æŸ¥è¯¢æœªæ¿€æ´»çš„ç”¨æˆ·
List<User> findByActiveFalse();
// SQL: WHERE active = false

// ä¹Ÿå¯ä»¥ç›´æ¥ä¼ å‚æ•°
List<User> findByActive(boolean active);
```

---

## 4. ğŸ”— é€»è¾‘è¿æ¥ç¬¦


### 4.1 Andè¿æ¥ï¼ˆä¸ï¼‰


**åŸºæœ¬ç”¨æ³•**ï¼šå¤šä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³

```java
// ä¸¤ä¸ªæ¡ä»¶
User findByNameAndEmail(String name, String email);
// SQL: WHERE name = ? AND email = ?

// ä¸‰ä¸ªæ¡ä»¶
List<User> findByNameAndEmailAndStatus(
    String name, 
    String email, 
    String status
);
// SQL: WHERE name = ? AND email = ? AND status = ?
```

**æ··åˆæ¡ä»¶**ï¼š
```java
// ç»„åˆä¸åŒç±»å‹æ¡ä»¶
List<User> findByNameContainingAndAgeGreaterThan(
    String keyword, 
    int age
);
// SQL: WHERE name LIKE %?% AND age > ?

// èŒƒå›´+çŠ¶æ€
List<Order> findByCreateTimeBetweenAndStatus(
    LocalDateTime start,
    LocalDateTime end,
    String status
);
// SQL: WHERE create_time BETWEEN ? AND ? AND status = ?
```

### 4.2 Orè¿æ¥ï¼ˆæˆ–ï¼‰


**åŸºæœ¬ç”¨æ³•**ï¼šæ»¡è¶³ä»»ä¸€æ¡ä»¶å³å¯

```java
// å§“åæˆ–é‚®ç®±åŒ¹é…
List<User> findByNameOrEmail(String name, String email);
// SQL: WHERE name = ? OR email = ?

// å¤šä¸ªçŠ¶æ€
List<User> findByStatusOrRole(String status, String role);
// SQL: WHERE status = ? OR role = ?
```

**âš ï¸ å¤æ‚Oræ¡ä»¶çš„é™åˆ¶**ï¼š
```
ä¸æ”¯æŒï¼š(A AND B) OR (C AND D)
è¿™ç§å¤æ‚é€»è¾‘éœ€è¦ç”¨@Query

æ”¯æŒï¼šA OR B OR C
ç®€å•çš„å¹³çº§Orå¯ä»¥
```

### 4.3 Andä¸Oræ··åˆä½¿ç”¨


```java
// ç¤ºä¾‹ï¼šæŸ¥æ‰¾VIPç”¨æˆ·æˆ–å¹´é¾„å¤§äº30çš„æ´»è·ƒç”¨æˆ·
// âŒ è¿™æ ·å†™ä¸è¡Œï¼ˆä¼˜å…ˆçº§é—®é¢˜ï¼‰
// findByRoleOrAgeGreaterThanAndActive

// âœ… æ­£ç¡®åšæ³•ï¼šç”¨@Query
@Query("SELECT u FROM User u WHERE " +
       "u.role = 'VIP' OR (u.age > 30 AND u.active = true)")
List<User> findVipOrActiveAdults();
```

**è§„åˆ™æ€»ç»“**ï¼š
```
ç®€å•è§„åˆ™ï¼š
1. çº¯Andè¿æ¥ â†’ ç›´æ¥ç”¨æ–¹æ³•å‘½å
2. çº¯Orè¿æ¥ â†’ ç›´æ¥ç”¨æ–¹æ³•å‘½å  
3. Andå’ŒOræ··åˆ â†’ ç”¨@Query

è®°å¿†å£è¯€ï¼š
"åŒçº§è¿æ¥ç”¨å‘½åï¼Œæ··åˆé€»è¾‘ç”¨æ³¨è§£"
```

---

## 5. ğŸ“Š æ’åºä¸é™åˆ¶


### 5.1 OrderByæ’åº


**åŸºç¡€æ’åº**ï¼š

```java
// æŒ‰å¹´é¾„å‡åº
List<User> findByStatusOrderByAgeAsc(String status);
// SQL: WHERE status = ? ORDER BY age ASC

// æŒ‰å¹´é¾„é™åº
List<User> findByStatusOrderByAgeDesc(String status);
// SQL: WHERE status = ? ORDER BY age DESC
```

**å¤šå­—æ®µæ’åº**ï¼š
```java
// å…ˆæŒ‰å¹´é¾„é™åºï¼Œå†æŒ‰å§“åå‡åº
List<User> findByStatusOrderByAgeDescNameAsc(String status);
// SQL: WHERE status = ? ORDER BY age DESC, name ASC

// å…ˆæŒ‰åˆ›å»ºæ—¶é—´é™åºï¼Œå†æŒ‰IDå‡åº
List<Order> findByStatusOrderByCreateTimeDescIdAsc(
    String status
);
```

**åŠ¨æ€æ’åºï¼ˆæ¨èï¼‰**ï¼š
```java
// æ–¹æ³•æ¥æ”¶Sortå‚æ•°ï¼Œæ›´çµæ´»
List<User> findByStatus(String status, Sort sort);

// è°ƒç”¨ç¤ºä¾‹
// æŒ‰å¹´é¾„é™åº
Sort sort1 = Sort.by(Sort.Direction.DESC, "age");
List<User> users1 = userRepository.findByStatus("ACTIVE", sort1);

// å¤šå­—æ®µæ’åº
Sort sort2 = Sort.by(
    Sort.Order.desc("age"),
    Sort.Order.asc("name")
);
List<User> users2 = userRepository.findByStatus("ACTIVE", sort2);
```

### 5.2 é™åˆ¶ç»“æœæ•°é‡ï¼ˆTop/Firstï¼‰


**å–å‰Næ¡**ï¼š

```java
// Topå’ŒFirstæ•ˆæœå®Œå…¨ç›¸åŒ
User findFirstByOrderByAgeDesc();      // å–1æ¡
User findTopByOrderByAgeDesc();        // å–1æ¡

// å–å‰10æ¡ï¼ˆä¸¤ç§å†™æ³•ï¼‰
List<User> findTop10ByOrderByAgeDesc();
List<User> findFirst10ByOrderByAgeDesc();

// å¸¦æ¡ä»¶çš„Top
List<User> findTop5ByStatusOrderByCreateTimeDesc(
    String status
);
```

**åº”ç”¨åœºæ™¯**ï¼š
```java
// è·å–æœ€æ–°æ³¨å†Œçš„10ä¸ªç”¨æˆ·
List<User> newUsers = userRepository
    .findTop10ByOrderByCreateTimeDesc();

// è·å–å¹´é¾„æœ€å¤§çš„ç”¨æˆ·
User oldest = userRepository
    .findFirstByOrderByAgeDesc();

// è·å–æŸä¸ªåˆ†ç±»ä¸‹æœ€çƒ­é—¨çš„5ç¯‡æ–‡ç« 
List<Article> hotArticles = articleRepository
    .findTop5ByCategoryOrderByViewCountDesc(category);
```

**ğŸ” Top vs LimitåŒºåˆ«**ï¼š
```
Top/Firstï¼š
- å†™åœ¨æ–¹æ³•åä¸­
- å›ºå®šæ•°é‡
- ç®€å•ç›´è§‚

Pageableï¼š
- ä½œä¸ºå‚æ•°ä¼ å…¥
- åŠ¨æ€æ•°é‡
- æ›´çµæ´»
```

### 5.3 åˆ†é¡µæŸ¥è¯¢ï¼ˆPageableï¼‰


**åŸºç¡€åˆ†é¡µ**ï¼š

```java
// è¿”å›Pageå¯¹è±¡ï¼ˆåŒ…å«åˆ†é¡µä¿¡æ¯ï¼‰
Page<User> findByStatus(String status, Pageable pageable);

// è¿”å›Listï¼ˆåªè¦æ•°æ®ï¼Œä¸è¦åˆ†é¡µä¿¡æ¯ï¼‰
List<User> findByStatus(String status, Pageable pageable);
```

**å®Œæ•´åˆ†é¡µç¤ºä¾‹**ï¼š
```java
// ç¬¬ä¸€é¡µï¼Œæ¯é¡µ10æ¡ï¼ŒæŒ‰å¹´é¾„é™åº
Pageable pageable = PageRequest.of(
    0,                                    // é¡µç ï¼ˆä»0å¼€å§‹ï¼‰
    10,                                   // æ¯é¡µæ•°é‡
    Sort.by(Sort.Direction.DESC, "age")  // æ’åº
);

Page<User> page = userRepository.findByStatus("ACTIVE", pageable);

// è·å–åˆ†é¡µä¿¡æ¯
long total = page.getTotalElements();     // æ€»è®°å½•æ•°
int totalPages = page.getTotalPages();    // æ€»é¡µæ•°
List<User> users = page.getContent();     // å½“å‰é¡µæ•°æ®
boolean hasNext = page.hasNext();         // æ˜¯å¦æœ‰ä¸‹ä¸€é¡µ
```

**å‰ç«¯åˆ†é¡µäº¤äº’**ï¼š
```java
// å¤„ç†å‰ç«¯åˆ†é¡µè¯·æ±‚
public Page<User> getUserPage(int page, int size, String status) {
    Pageable pageable = PageRequest.of(
        page - 1,  // å‰ç«¯é¡µç ä»1å¼€å§‹ï¼Œéœ€è¦å‡1
        size,
        Sort.by("createTime").descending()
    );
    
    return userRepository.findByStatus(status, pageable);
}
```

---

## 6. ğŸ’¼ å®æˆ˜åº”ç”¨åœºæ™¯


### 6.1 ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ


```java
public interface UserRepository extends JpaRepository<User, Long> {
    
    // ç™»å½•éªŒè¯
    User findByUsernameAndPassword(String username, String password);
    
    // é‚®ç®±æ³¨å†Œæ£€æŸ¥
    boolean existsByEmail(String email);
    
    // ç”¨æˆ·æœç´¢ï¼ˆæ”¯æŒæ¨¡ç³ŠæŸ¥è¯¢ï¼‰
    List<User> findByUsernameContainingOrEmailContaining(
        String keyword1, 
        String keyword2
    );
    
    // æŒ‰çŠ¶æ€ç»Ÿè®¡
    long countByStatus(String status);
    
    // è·å–æ´»è·ƒç”¨æˆ·ï¼ˆåˆ†é¡µï¼‰
    Page<User> findByStatusAndActiveTrue(
        String status, 
        Pageable pageable
    );
    
    // æ‰¹é‡æŸ¥è¯¢
    List<User> findByIdIn(List<Long> ids);
    
    // åˆ é™¤è¿‡æœŸç”¨æˆ·
    @Transactional
    long deleteByLastLoginTimeBefore(LocalDateTime date);
}
```

### 6.2 å•†å“ç®¡ç†ç³»ç»Ÿ


```java
public interface ProductRepository 
    extends JpaRepository<Product, Long> {
    
    // ä»·æ ¼åŒºé—´æŸ¥è¯¢
    List<Product> findByPriceBetween(
        BigDecimal minPrice, 
        BigDecimal maxPrice
    );
    
    // åˆ†ç±»æŸ¥è¯¢ï¼ˆå¸¦æ’åºï¼‰
    List<Product> findByCategoryOrderBySalesDesc(String category);
    
    // çƒ­é—¨å•†å“ï¼ˆé”€é‡å‰10ï¼‰
    List<Product> findTop10ByOrderBySalesDesc();
    
    // æœç´¢åŠŸèƒ½
    List<Product> findByNameContainingOrDescriptionContaining(
        String keyword1, 
        String keyword2
    );
    
    // åº“å­˜ä¸è¶³å•†å“
    List<Product> findByStockLessThan(int threshold);
    
    // æ–°å“æŸ¥è¯¢
    List<Product> findByCreateTimeAfter(LocalDateTime date);
    
    // ç‰¹å®šå“ç‰Œå’Œä»·æ ¼åŒºé—´
    List<Product> findByBrandAndPriceBetween(
        String brand,
        BigDecimal minPrice,
        BigDecimal maxPrice
    );
}
```

### 6.3 è®¢å•ç®¡ç†ç³»ç»Ÿ


```java
public interface OrderRepository 
    extends JpaRepository<Order, Long> {
    
    // ç”¨æˆ·è®¢å•åˆ—è¡¨
    Page<Order> findByUserIdOrderByCreateTimeDesc(
        Long userId, 
        Pageable pageable
    );
    
    // è®¢å•ç»Ÿè®¡
    long countByStatusAndCreateTimeBetween(
        String status,
        LocalDateTime start,
        LocalDateTime end
    );
    
    // å¾…æ”¯ä»˜è®¢å•
    List<Order> findByStatusAndCreateTimeBefore(
        String status,
        LocalDateTime deadline
    );
    
    // æ‰¹é‡çŠ¶æ€æ›´æ–°
    @Transactional
    List<Order> deleteByStatusAndCreateTimeBefore(
        String status,
        LocalDateTime date
    );
    
    // è®¢å•æœç´¢
    List<Order> findByOrderNoContainingOrUserNameContaining(
        String orderNo,
        String userName
    );
}
```

### 6.4 å¸¸è§ä¸šåŠ¡åœºæ™¯é€ŸæŸ¥


| ä¸šåŠ¡éœ€æ±‚ | æ–¹æ³•å‘½å |
|---------|---------|
| **æ³¨å†Œæ£€æŸ¥** | `existsByEmail(String email)` |
| **ç™»å½•éªŒè¯** | `findByUsernameAndPassword(String u, String p)` |
| **æœç´¢åŠŸèƒ½** | `findByNameContaining(String keyword)` |
| **æ•°æ®ç»Ÿè®¡** | `countByStatus(String status)` |
| **è·å–æœ€æ–°** | `findTop10ByOrderByCreateTimeDesc()` |
| **ä»·æ ¼ç­›é€‰** | `findByPriceBetween(BigDecimal min, BigDecimal max)` |
| **æ‰¹é‡æŸ¥è¯¢** | `findByIdIn(List<Long> ids)` |
| **å®šæ—¶æ¸…ç†** | `deleteByCreateTimeBefore(LocalDateTime date)` |

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å‘½åè§„åˆ™é€Ÿè®°


**ğŸ¯ æ–¹æ³•åå…¬å¼**ï¼š
```
[å‰ç¼€] + By + [æ¡ä»¶] + [è¿æ¥è¯] + [æ¡ä»¶] + [æ’åº] + [é™åˆ¶]
  â†“         â†“          â†“          â†“       â†“
æŸ¥è¯¢ç±»å‹   å­—æ®µ      And/Or     å…¶ä»–å­—æ®µ  OrderBy  Top/First
```

**å¸¸ç”¨å‰ç¼€**ï¼š
- `find/get/read/query` â†’ æŸ¥è¯¢æ•°æ®
- `exists` â†’ æ£€æŸ¥å­˜åœ¨æ€§ï¼ˆè¿”å›booleanï¼‰
- `count` â†’ ç»Ÿè®¡æ•°é‡ï¼ˆè¿”å›longï¼‰
- `delete/remove` â†’ åˆ é™¤æ•°æ®ï¼ˆéœ€@Transactionalï¼‰

**æ¡ä»¶å…³é”®å­—**ï¼š
- ç›¸ç­‰ï¼š`Is/Equals` æˆ–ç›´æ¥çœç•¥
- ä¸ç­‰ï¼š`Not/IsNot`
- èŒƒå›´ï¼š`Between/LessThan/GreaterThan`
- æ¨¡ç³Šï¼š`Like/Containing/StartingWith/EndingWith`
- é›†åˆï¼š`In/NotIn`
- ç©ºå€¼ï¼š`IsNull/IsNotNull`

### 7.2 ä½¿ç”¨å»ºè®®


**âœ… æ¨èåšæ³•**ï¼š
```
1. ç®€å•æŸ¥è¯¢ä¼˜å…ˆç”¨æ–¹æ³•å‘½å
   - æ¡ä»¶ä¸è¶…è¿‡3ä¸ª
   - é€»è¾‘ç®€å•æ¸…æ™°
   
2. ç»Ÿä¸€å‘½åé£æ ¼
   - å»ºè®®ç»Ÿä¸€ç”¨findBy
   - å›¢é˜Ÿä¿æŒä¸€è‡´

3. åˆç†ä½¿ç”¨åŠ¨æ€å‚æ•°
   - SortåŠ¨æ€æ’åº
   - Pageableåˆ†é¡µæŸ¥è¯¢
   
4. å…³é”®æ“ä½œåŠ æ³¨è§£
   - åˆ é™¤æ“ä½œåŠ @Transactional
   - å¤æ‚æŸ¥è¯¢åŠ @Query
```

**âŒ é¿å…çš„åšæ³•**ï¼š
```
1. æ–¹æ³•åè¿‡é•¿
   - è¶…è¿‡5ä¸ªæ¡ä»¶ç”¨@Query
   
2. å¤æ‚é€»è¾‘
   - åµŒå¥—Orç”¨@Query
   - å­æŸ¥è¯¢ç”¨@Query
   
3. æ€§èƒ½é—®é¢˜
   - æ¨¡ç³ŠæŸ¥è¯¢æ³¨æ„ç´¢å¼•
   - å¤§æ•°æ®é‡ç”¨åˆ†é¡µ
```

### 7.3 å­¦ä¹ è·¯çº¿å›¾


```
ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€æŸ¥è¯¢
â”œâ”€ findByåŸºç¡€ç”¨æ³•
â”œâ”€ exists/countä½¿ç”¨
â””â”€ ç®€å•æ¡ä»¶ç»„åˆ

ç¬¬äºŒé˜¶æ®µï¼šé«˜çº§ç‰¹æ€§  
â”œâ”€ æ’åºOrderBy
â”œâ”€ é™åˆ¶Top/First
â””â”€ åˆ†é¡µPageable

ç¬¬ä¸‰é˜¶æ®µï¼šå®æˆ˜åº”ç”¨
â”œâ”€ ä¸šåŠ¡åœºæ™¯åˆ†æ
â”œâ”€ æ€§èƒ½ä¼˜åŒ–è€ƒè™‘
â””â”€ ä½•æ—¶ç”¨@Query
```

### 7.4 å…³é”®è®°å¿†ç‚¹


**ğŸ§  æ ¸å¿ƒè®°å¿†**ï¼š
```
æ–¹æ³•å = æŸ¥è¯¢çš„è‡ªç„¶è¯­è¨€æè¿°
å‘½åè§„èŒƒ = SQLæ¡ä»¶çš„ç¿»è¯‘
å‚æ•°é¡ºåº = æ–¹æ³•åå‡ºç°é¡ºåº

å£è¯€ï¼š
"è§åçŸ¥æ„å†™æ–¹æ³•ï¼ŒSpringè‡ªåŠ¨ç”ŸæˆSQL"
```

**ğŸ”‘ å¿…ä¼šå…³é”®å­—**ï¼š
- **æŸ¥è¯¢**ï¼šfindBy, getBy
- **æ£€æŸ¥**ï¼šexistsBy
- **ç»Ÿè®¡**ï¼šcountBy
- **åˆ é™¤**ï¼šdeleteBy + @Transactional
- **é€»è¾‘**ï¼šAnd, Or
- **æ¡ä»¶**ï¼šBetween, Like, In
- **æ’åº**ï¼šOrderBy, Asc, Desc
- **é™åˆ¶**ï¼šTop, First
- **åˆ†é¡µ**ï¼šPageable

---

**ğŸ’¡ å­¦ä¹ å»ºè®®**ï¼š
1. å…ˆæŒæ¡åŸºç¡€å‰ç¼€å’Œå¸¸ç”¨æ¡ä»¶
2. å¤šç»ƒä¹ å®é™…ä¸šåŠ¡åœºæ™¯
3. é‡åˆ°å¤æ‚æŸ¥è¯¢åŠæ—¶ç”¨@Query
4. æ³¨æ„æ€§èƒ½ä¼˜åŒ–å’Œç´¢å¼•ä½¿ç”¨

**ğŸ¯ ä¸‹ä¸€æ­¥å­¦ä¹ **ï¼š
- @Queryè‡ªå®šä¹‰æŸ¥è¯¢
- SpecificationåŠ¨æ€æŸ¥è¯¢
- QueryDSLç±»å‹å®‰å…¨æŸ¥è¯¢