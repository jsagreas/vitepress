---
title: 25ã€MappedSuperclassä»£ç å¤ç”¨
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯æ˜ å°„è¶…ç±»](#1-ä»€ä¹ˆæ˜¯æ˜ å°„è¶…ç±»)
2. [åŸºæœ¬ä½¿ç”¨åœºæ™¯](#2-åŸºæœ¬ä½¿ç”¨åœºæ™¯)
3. [æ ¸å¿ƒç‰¹æ€§ä¸é™åˆ¶](#3-æ ¸å¿ƒç‰¹æ€§ä¸é™åˆ¶)
4. [å®æˆ˜åº”ç”¨æ¨¡å¼](#4-å®æˆ˜åº”ç”¨æ¨¡å¼)
5. [æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹](#5-æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ä»€ä¹ˆæ˜¯æ˜ å°„è¶…ç±»


### 1.1 é—®é¢˜å¼•å…¥ï¼šé‡å¤ä»£ç çš„çƒ¦æ¼


**åœºæ™¯è¿˜åŸ**ï¼š
```
å‡è®¾ä½ åœ¨åšä¸€ä¸ªç”µå•†ç³»ç»Ÿï¼Œæœ‰å¾ˆå¤šå®ä½“ç±»ï¼š

ç”¨æˆ·è¡¨ï¼ˆUserï¼‰      è®¢å•è¡¨ï¼ˆOrderï¼‰     å•†å“è¡¨ï¼ˆProductï¼‰
- id               - id                - id
- username         - orderNo           - productName
- password         - amount            - price
- createTime       - createTime        - createTime
- updateTime       - updateTime        - updateTime
- createBy         - createBy          - createBy
- updateBy         - updateBy          - updateBy

å‘ç°äº†å—ï¼Ÿæ¯ä¸ªè¡¨éƒ½æœ‰ï¼šidã€åˆ›å»ºæ—¶é—´ã€æ›´æ–°æ—¶é—´ã€åˆ›å»ºäººã€ä¿®æ”¹äºº
è¿™äº›å­—æ®µè¦åœ¨æ¯ä¸ªå®ä½“ç±»é‡Œé‡å¤å†™ä¸€éï¼Œå¤ªéº»çƒ¦äº†ï¼
```

**ä¼ ç»Ÿåšæ³•çš„é—®é¢˜**ï¼š
```java
// æ¯ä¸ªå®ä½“éƒ½è¦é‡å¤å®šä¹‰è¿™äº›å­—æ®µ
@Entity
public class User {
    @Id
    private Long id;
    private String username;
    private String password;
    
    // é‡å¤çš„å®¡è®¡å­—æ®µ
    private LocalDateTime createTime;
    private LocalDateTime updateTime;
    private String createBy;
    private String updateBy;
}

@Entity
public class Order {
    @Id
    private Long id;
    private String orderNo;
    
    // åˆé‡å¤ä¸€éï¼
    private LocalDateTime createTime;
    private LocalDateTime updateTime;
    private String createBy;
    private String updateBy;
}
```

> ğŸ’¡ **æ ¸å¿ƒé—®é¢˜**ï¼šè¿™äº›å…¬å…±å­—æ®µåœ¨æ¯ä¸ªå®ä½“ä¸­é‡å¤å®šä¹‰ï¼Œè¿åäº†DRYåŸåˆ™ï¼ˆDon't Repeat Yourselfï¼‰

### 1.2 @MappedSuperclass æ˜¯ä»€ä¹ˆ


**é€šä¿—è§£é‡Š**ï¼š
```
@MappedSuperclass å°±åƒæ˜¯ä¸€ä¸ª"å­—æ®µæ¨¡æ¿"

æƒ³è±¡ä½ æ˜¯è£…ä¿®å…¬å¸ï¼š
- æ¯ä¸ªæˆ¿å­éƒ½æœ‰ï¼šé—¨ã€çª—ã€åœ°æ¿ã€å¢™å£ï¼ˆå…¬å…±éƒ¨åˆ†ï¼‰
- ä¸åŒæˆ¿å­æœ‰ï¼šå§å®¤ã€ä¹¦æˆ¿ã€å®¢å…ï¼ˆä¸ªæ€§åŒ–éƒ¨åˆ†ï¼‰

@MappedSuperclass å°±æ˜¯"å…¬å…±éƒ¨åˆ†çš„æ¨¡æ¿"
- æŠŠé—¨ã€çª—ã€åœ°æ¿ã€å¢™å£å®šä¹‰ä¸€æ¬¡
- æ¯ä¸ªæˆ¿å­ç»§æ‰¿è¿™ä¸ªæ¨¡æ¿ï¼Œå†åŠ è‡ªå·±çš„ç‰¹è‰²

è¿™æ ·å°±ä¸ç”¨æ¯ä¸ªæˆ¿å­éƒ½é‡æ–°å®šä¹‰é—¨çª—äº†ï¼
```

**æ­£å¼å®šä¹‰**ï¼š
```
@MappedSuperclass æ˜¯ä¸€ä¸ªJPAæ³¨è§£ï¼Œç”¨äºï¼š
âœ… å®šä¹‰å…¬å…±å­—æ®µçš„çˆ¶ç±»
âœ… è®©å¤šä¸ªå®ä½“ç±»ç»§æ‰¿è¿™äº›å­—æ®µ
âœ… å®ç°å­—æ®µå¤ç”¨ï¼Œå‡å°‘é‡å¤ä»£ç 

å…³é”®ç‰¹ç‚¹ï¼š
ğŸ”¸ æœ¬èº«ä¸æ˜¯å®ä½“ç±»ï¼ˆä¸å¯¹åº”æ•°æ®åº“è¡¨ï¼‰
ğŸ”¸ åªæä¾›å­—æ®µå®šä¹‰ç»™å­ç±»ç»§æ‰¿
ğŸ”¸ çˆ¶ç±»çš„å­—æ®µä¼šåˆå¹¶åˆ°å­ç±»çš„è¡¨ä¸­
```

### 1.3 å·¥ä½œåŸç†å›¾ç¤º


**ç»§æ‰¿å…³ç³»ç»“æ„**ï¼š
```
           @MappedSuperclass
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   BaseEntity     â”‚  â† çˆ¶ç±»ï¼ˆéå®ä½“ï¼‰
         â”‚  - id            â”‚
         â”‚  - createTime    â”‚
         â”‚  - updateTime    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â–²
                 â”‚ ç»§æ‰¿
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚
    @Entity           @Entity
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  User   â”‚       â”‚  Order  â”‚  â† å­ç±»ï¼ˆå®ä½“ï¼‰
  â”‚ç»§æ‰¿æ‰€æœ‰  â”‚       â”‚ç»§æ‰¿æ‰€æœ‰  â”‚
  â”‚çˆ¶ç±»å­—æ®µ  â”‚       â”‚çˆ¶ç±»å­—æ®µ  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ•°æ®åº“è¡¨ç»“æ„**ï¼š
```
Userè¡¨ç»“æ„ï¼š              Orderè¡¨ç»“æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id           â”‚â†â”€ç»§æ‰¿   â”‚ id           â”‚â†â”€ç»§æ‰¿
â”‚ createTime   â”‚â†â”€ç»§æ‰¿   â”‚ createTime   â”‚â†â”€ç»§æ‰¿
â”‚ updateTime   â”‚â†â”€ç»§æ‰¿   â”‚ updateTime   â”‚â†â”€ç»§æ‰¿
â”‚ username     â”‚         â”‚ orderNo      â”‚
â”‚ password     â”‚         â”‚ amount       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ³¨æ„ï¼šBaseEntity ä¸ä¼šç”Ÿæˆè¡¨ï¼
```

---

## 2. ğŸ› ï¸ åŸºæœ¬ä½¿ç”¨åœºæ™¯


### 2.1 åˆ›å»ºæ˜ å°„è¶…ç±»


**æ­¥éª¤1ï¼šå®šä¹‰åŸºç¡€å®ä½“ç±»**
```java
@MappedSuperclass  // å…³é”®æ³¨è§£ï¼šå£°æ˜è¿™æ˜¯ä¸€ä¸ªæ˜ å°„è¶…ç±»
public abstract class BaseEntity {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    private LocalDateTime createTime;
    
    private LocalDateTime updateTime;
    
    // getterå’Œsetteræ–¹æ³•
}
```

> ğŸ”´ **å¿…é¡»æŒæ¡**ï¼š
> - `@MappedSuperclass` å£°æ˜è¿™æ˜¯å…¬å…±å­—æ®µçš„çˆ¶ç±»
> - é€šå¸¸å®šä¹‰ä¸º `abstract`ï¼ˆæŠ½è±¡ç±»ï¼‰ï¼Œå› ä¸ºä¸éœ€è¦ç›´æ¥å®ä¾‹åŒ–
> - çˆ¶ç±»æœ¬èº«ä¸éœ€è¦ `@Entity` æ³¨è§£

**æ­¥éª¤2ï¼šå­ç±»ç»§æ‰¿ä½¿ç”¨**
```java
@Entity
@Table(name = "t_user")
public class User extends BaseEntity {  // ç»§æ‰¿BaseEntity
    
    private String username;
    private String password;
    private String email;
    
    // è‡ªåŠ¨æ‹¥æœ‰äº† idã€createTimeã€updateTime
}

@Entity
@Table(name = "t_order")
public class Order extends BaseEntity {  // ç»§æ‰¿BaseEntity
    
    private String orderNo;
    private BigDecimal amount;
    
    // åŒæ ·è‡ªåŠ¨æ‹¥æœ‰äº† idã€createTimeã€updateTime
}
```

**å¯¹æ¯”æ•ˆæœ**ï¼š
```
ä½¿ç”¨å‰ï¼šæ¯ä¸ªå®ä½“éƒ½è¦å†™ idã€createTimeã€updateTime
Userç±»ï¼š   50è¡Œä»£ç 
Orderç±»ï¼š  50è¡Œä»£ç 
Productç±»ï¼š50è¡Œä»£ç 
æ€»è®¡ï¼š150è¡Œä»£ç 

ä½¿ç”¨åï¼šåªåœ¨çˆ¶ç±»å†™ä¸€æ¬¡
BaseEntityï¼š 30è¡Œä»£ç 
Userç±»ï¼š     20è¡Œä»£ç 
Orderç±»ï¼š    20è¡Œä»£ç 
Productç±»ï¼š  20è¡Œä»£ç 
æ€»è®¡ï¼š90è¡Œä»£ç ï¼ŒèŠ‚çœ40%ï¼
```

### 2.2 å¸¸è§åº”ç”¨åœºæ™¯


**åœºæ™¯1ï¼šå®¡è®¡å­—æ®µï¼ˆæœ€å¸¸ç”¨ï¼‰**
```java
@MappedSuperclass
public abstract class AuditEntity {
    
    // è°åˆ›å»ºçš„
    @Column(name = "create_by", length = 50)
    private String createBy;
    
    // ä»€ä¹ˆæ—¶å€™åˆ›å»ºçš„
    @Column(name = "create_time")
    private LocalDateTime createTime;
    
    // è°æœ€åä¿®æ”¹çš„
    @Column(name = "update_by", length = 50)
    private String updateBy;
    
    // ä»€ä¹ˆæ—¶å€™æœ€åä¿®æ”¹çš„
    @Column(name = "update_time")
    private LocalDateTime updateTime;
}
```

> ğŸ’¡ **ä¸ºä»€ä¹ˆå«å®¡è®¡å­—æ®µ**ï¼š
> - è®°å½•æ•°æ®çš„"æ¥é¾™å»è„‰"
> - è¿½è¸ªè°åœ¨ä»€ä¹ˆæ—¶å€™åšäº†ä»€ä¹ˆæ“ä½œ
> - åƒæ—¥è®°æœ¬ä¸€æ ·ï¼Œè®°å½•æ•°æ®çš„å†å²

**åœºæ™¯2ï¼šé€»è¾‘åˆ é™¤å­—æ®µ**
```java
@MappedSuperclass
public abstract class SoftDeleteEntity extends AuditEntity {
    
    // æ˜¯å¦åˆ é™¤ï¼š0-æœªåˆ é™¤ï¼Œ1-å·²åˆ é™¤
    @Column(name = "is_deleted")
    private Integer deleted = 0;
    
    // åˆ é™¤æ—¶é—´
    @Column(name = "delete_time")
    private LocalDateTime deleteTime;
}
```

**åœºæ™¯3ï¼šå¤šç§Ÿæˆ·å­—æ®µ**
```java
@MappedSuperclass
public abstract class TenantEntity extends AuditEntity {
    
    // ç§Ÿæˆ·IDï¼ˆå“ªä¸ªå…¬å¸çš„æ•°æ®ï¼‰
    @Column(name = "tenant_id")
    private Long tenantId;
}
```

**å®é™…ä½¿ç”¨ç¤ºä¾‹**ï¼š
```java
@Entity
@Table(name = "t_product")
public class Product extends SoftDeleteEntity {
    
    private String productName;
    private BigDecimal price;
    
    // è‡ªåŠ¨æ‹¥æœ‰ï¼š
    // - idï¼ˆæ¥è‡ªBaseEntityï¼‰
    // - createBy, createTime, updateBy, updateTimeï¼ˆæ¥è‡ªAuditEntityï¼‰
    // - deleted, deleteTimeï¼ˆæ¥è‡ªSoftDeleteEntityï¼‰
}
```

**å­—æ®µç»§æ‰¿å±‚æ¬¡å›¾**ï¼š
```
       BaseEntity
            â†“
     (id, createTime, updateTime)
            â†“
       AuditEntity
            â†“
  (createBy, updateBy, createTime, updateTime)
            â†“
    SoftDeleteEntity
            â†“
     (deleted, deleteTime)
            â†“
        Product
            â†“
  (productName, price + æ‰€æœ‰çˆ¶ç±»å­—æ®µ)
```

---

## 3. âš™ï¸ æ ¸å¿ƒç‰¹æ€§ä¸é™åˆ¶


### 3.1 æ ¸å¿ƒç‰¹æ€§è¯´æ˜


**ç‰¹æ€§1ï¼šå­—æ®µåˆå¹¶æœºåˆ¶**
```
çˆ¶ç±»å­—æ®µ + å­ç±»å­—æ®µ = å®Œæ•´è¡¨ç»“æ„

ç¤ºä¾‹ï¼š
BaseEntityå­—æ®µï¼šid, createTime, updateTime
Userå­—æ®µï¼š      username, password

æœ€ç»ˆUserè¡¨ï¼š   id, createTime, updateTime, username, password
```

**ç‰¹æ€§2ï¼šå­—æ®µå¯ä»¥è¢«è¦†ç›–**
```java
@MappedSuperclass
public abstract class BaseEntity {
    @Id
    private Long id;  // çˆ¶ç±»å®šä¹‰
}

@Entity
public class User extends BaseEntity {
    
    // å¯ä»¥é‡æ–°å®šä¹‰è¦†ç›–çˆ¶ç±»çš„å­—æ®µé…ç½®
    @Id
    @Column(name = "user_id")  // æ”¹å˜åˆ—å
    private Long id;
}
```

**ç‰¹æ€§3ï¼šæ”¯æŒJPAæ‰€æœ‰æ³¨è§£**
```java
@MappedSuperclass
public abstract class BaseEntity {
    
    // å¯ä»¥ä½¿ç”¨@Column
    @Column(name = "created_at", nullable = false)
    private LocalDateTime createTime;
    
    // å¯ä»¥ä½¿ç”¨@Temporal
    @Temporal(TemporalType.TIMESTAMP)
    private Date updateTime;
    
    // å¯ä»¥ä½¿ç”¨éªŒè¯æ³¨è§£
    @NotNull
    @Size(max = 50)
    private String createBy;
}
```

### 3.2 é‡è¦é™åˆ¶è¯´æ˜


**é™åˆ¶1ï¼šä¸èƒ½è¢«æŸ¥è¯¢ï¼ˆæœ€é‡è¦çš„é™åˆ¶ï¼‰**
```java
@MappedSuperclass
public abstract class BaseEntity {
    @Id
    private Long id;
}

// âŒ é”™è¯¯ï¼ä¸èƒ½ç›´æ¥æŸ¥è¯¢çˆ¶ç±»
entityManager.find(BaseEntity.class, 1L);  // æŠ¥é”™ï¼

// âŒ é”™è¯¯ï¼ä¸èƒ½ç”¨çˆ¶ç±»åšJPQLæŸ¥è¯¢
entityManager.createQuery("SELECT b FROM BaseEntity b");  // æŠ¥é”™ï¼

// âœ… æ­£ç¡®ï¼åªèƒ½æŸ¥è¯¢å­ç±»
entityManager.find(User.class, 1L);  // OK
entityManager.createQuery("SELECT u FROM User u");  // OK
```

> âš ï¸ **æ˜“é”™é‡ç‚¹**ï¼š
> - @MappedSuperclass åªæ˜¯"å­—æ®µæ¨¡æ¿"
> - å®ƒæœ¬èº«ä¸æ˜¯å®ä½“ï¼Œæ²¡æœ‰å¯¹åº”çš„è¡¨
> - åªèƒ½æŸ¥è¯¢ç»§æ‰¿å®ƒçš„å­ç±»

**é™åˆ¶2ï¼šä¸èƒ½å»ºç«‹å…³è”å…³ç³»**
```java
@MappedSuperclass
public abstract class BaseEntity {
    @Id
    private Long id;
}

@Entity
public class Order {
    
    // âŒ é”™è¯¯ï¼ä¸èƒ½å…³è”åˆ°@MappedSuperclass
    @ManyToOne
    private BaseEntity creator;  // ç¼–è¯‘æŠ¥é”™ï¼
    
    // âœ… æ­£ç¡®ï¼å…³è”åˆ°å…·ä½“çš„å®ä½“ç±»
    @ManyToOne
    private User creator;  // OK
}
```

**é™åˆ¶3ï¼šä¸èƒ½ä½¿ç”¨ç»§æ‰¿ç­–ç•¥**
```java
// âŒ é”™è¯¯ï¼@MappedSuperclassä¸æ”¯æŒç»§æ‰¿ç­–ç•¥
@MappedSuperclass
@Inheritance(strategy = InheritanceType.JOINED)  // æ— æ•ˆï¼
public abstract class BaseEntity {
    @Id
    private Long id;
}

// âœ… å¦‚æœéœ€è¦ç»§æ‰¿ç­–ç•¥ï¼Œåº”è¯¥ç”¨@Entity
@Entity
@Inheritance(strategy = InheritanceType.JOINED)
public abstract class BaseEntity {
    @Id
    private Long id;
}
```

### 3.3 ä¸@Entityç»§æ‰¿çš„å¯¹æ¯”


| å¯¹æ¯”é¡¹ | @MappedSuperclass | @EntityæŠ½è±¡ç±» |
|--------|-------------------|---------------|
| **æ˜¯å¦ç”Ÿæˆè¡¨** | âŒ ä¸ç”Ÿæˆ | âœ… å¯èƒ½ç”Ÿæˆï¼ˆå–å†³äºç»§æ‰¿ç­–ç•¥ï¼‰ |
| **èƒ½å¦æŸ¥è¯¢** | âŒ ä¸èƒ½ | âœ… å¯ä»¥ |
| **èƒ½å¦å»ºç«‹å…³è”** | âŒ ä¸èƒ½ | âœ… å¯ä»¥ |
| **ç»§æ‰¿ç­–ç•¥** | âŒ ä¸æ”¯æŒ | âœ… æ”¯æŒ |
| **ä½¿ç”¨åœºæ™¯** | çº¯ç²¹çš„å­—æ®µå¤ç”¨ | ä¸šåŠ¡ç»§æ‰¿å…³ç³» |
| **æ€§èƒ½å¼€é”€** | æ— é¢å¤–å¼€é”€ | å¯èƒ½æœ‰é¢å¤–å¼€é”€ |

**é€‰æ‹©å»ºè®®**ï¼š
```
ç”¨@MappedSuperclassçš„åœºæ™¯ï¼š
âœ… åªæ˜¯ä¸ºäº†å¤ç”¨å­—æ®µï¼ˆå¦‚å®¡è®¡å­—æ®µï¼‰
âœ… çˆ¶ç±»ä¸éœ€è¦è¢«æŸ¥è¯¢
âœ… çˆ¶ç±»ä¸å‚ä¸ä¸šåŠ¡é€»è¾‘
âœ… è¿½æ±‚ç®€å•å’Œæ€§èƒ½

ç”¨@EntityæŠ½è±¡ç±»çš„åœºæ™¯ï¼š
âœ… çˆ¶ç±»æœ¬èº«æœ‰ä¸šåŠ¡æ„ä¹‰
âœ… éœ€è¦é€šè¿‡çˆ¶ç±»æŸ¥è¯¢æ‰€æœ‰å­ç±»
âœ… éœ€è¦çˆ¶ç±»ä½œä¸ºå…³è”å¯¹è±¡
âœ… éœ€è¦å¤šæ€æŸ¥è¯¢
```

---

## 4. ğŸš€ å®æˆ˜åº”ç”¨æ¨¡å¼


### 4.1 æ ‡å‡†å®¡è®¡å®ä½“æ¨¡å¼


**å®Œæ•´çš„å®¡è®¡åŸºç±»è®¾è®¡**ï¼š
```java
@MappedSuperclass
public abstract class BaseEntity implements Serializable {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @Column(name = "create_time", updatable = false)
    private LocalDateTime createTime;
    
    @Column(name = "create_by", length = 50, updatable = false)
    private String createBy;
    
    @Column(name = "update_time")
    private LocalDateTime updateTime;
    
    @Column(name = "update_by", length = 50)
    private String updateBy;
    
    // ä¿å­˜å‰è‡ªåŠ¨å¡«å……åˆ›å»ºä¿¡æ¯
    @PrePersist
    protected void onCreate() {
        this.createTime = LocalDateTime.now();
        this.createBy = getCurrentUser();  // è·å–å½“å‰ç™»å½•ç”¨æˆ·
    }
    
    // æ›´æ–°å‰è‡ªåŠ¨å¡«å……ä¿®æ”¹ä¿¡æ¯
    @PreUpdate
    protected void onUpdate() {
        this.updateTime = LocalDateTime.now();
        this.updateBy = getCurrentUser();
    }
    
    // å·¥å…·æ–¹æ³•ï¼šè·å–å½“å‰ç”¨æˆ·ï¼ˆéœ€è¦è‡ªå·±å®ç°ï¼‰
    private String getCurrentUser() {
        // ä»Spring Securityæˆ–è‡ªå·±çš„ä¸Šä¸‹æ–‡è·å–
        return "system";  // ç¤ºä¾‹
    }
}
```

> ğŸ’¡ **æ ¸å¿ƒäº®ç‚¹**ï¼š
> - `@PrePersist`ï¼šä¿å­˜å‰è‡ªåŠ¨å¡«å……åˆ›å»ºä¿¡æ¯
> - `@PreUpdate`ï¼šæ›´æ–°å‰è‡ªåŠ¨å¡«å……ä¿®æ”¹ä¿¡æ¯
> - `updatable = false`ï¼šåˆ›å»ºä¿¡æ¯ä¸å…è®¸ä¿®æ”¹

**ä¸šåŠ¡å®ä½“ä½¿ç”¨**ï¼š
```java
@Entity
@Table(name = "t_user")
public class User extends BaseEntity {
    
    private String username;
    private String email;
    
    // ä¿å­˜æ•°æ®æ—¶ï¼Œè‡ªåŠ¨å¡«å……å®¡è®¡å­—æ®µ
}

// ä½¿ç”¨ç¤ºä¾‹
User user = new User();
user.setUsername("å¼ ä¸‰");
user.setEmail("zhangsan@example.com");

userRepository.save(user);  
// è‡ªåŠ¨è®¾ç½®ï¼šcreateTime=å½“å‰æ—¶é—´, createBy=å½“å‰ç”¨æˆ·
```

### 4.2 é€»è¾‘åˆ é™¤æ¨¡å¼


**æ”¯æŒé€»è¾‘åˆ é™¤çš„åŸºç±»**ï¼š
```java
@MappedSuperclass
public abstract class SoftDeleteEntity extends BaseEntity {
    
    // åˆ é™¤æ ‡è®°ï¼š0-æœªåˆ é™¤ï¼Œ1-å·²åˆ é™¤
    @Column(name = "deleted")
    private Boolean deleted = false;
    
    // åˆ é™¤æ—¶é—´
    @Column(name = "delete_time")
    private LocalDateTime deleteTime;
    
    // åˆ é™¤äºº
    @Column(name = "delete_by", length = 50)
    private String deleteBy;
    
    // é€»è¾‘åˆ é™¤æ–¹æ³•
    public void markAsDeleted() {
        this.deleted = true;
        this.deleteTime = LocalDateTime.now();
        this.deleteBy = getCurrentUser();
    }
    
    // åˆ¤æ–­æ˜¯å¦å·²åˆ é™¤
    public boolean isDeleted() {
        return deleted != null && deleted;
    }
}
```

**é…åˆJPAæŸ¥è¯¢è¿‡æ»¤**ï¼š
```java
@Entity
@Table(name = "t_product")
@Where(clause = "deleted = false")  // è‡ªåŠ¨è¿‡æ»¤å·²åˆ é™¤æ•°æ®
public class Product extends SoftDeleteEntity {
    
    private String productName;
    private BigDecimal price;
}

// ä½¿ç”¨ç¤ºä¾‹
Product product = productRepository.findById(1L).get();

// é€»è¾‘åˆ é™¤ï¼ˆä¸æ˜¯çœŸåˆ é™¤ï¼‰
product.markAsDeleted();
productRepository.save(product);

// åç»­æŸ¥è¯¢ä¼šè‡ªåŠ¨è¿‡æ»¤æ‰è¿™æ¡æ•°æ®
List<Product> products = productRepository.findAll();  
// ä¸åŒ…å«å·²åˆ é™¤çš„æ•°æ®
```

### 4.3 å¤šç§Ÿæˆ·æ¨¡å¼


**å¤šç§Ÿæˆ·åŸºç±»è®¾è®¡**ï¼š
```java
@MappedSuperclass
public abstract class TenantEntity extends BaseEntity {
    
    // ç§Ÿæˆ·ID
    @Column(name = "tenant_id", nullable = false)
    private Long tenantId;
    
    @PrePersist
    protected void setTenantId() {
        if (this.tenantId == null) {
            this.tenantId = getCurrentTenantId();
        }
    }
    
    private Long getCurrentTenantId() {
        // ä»ä¸Šä¸‹æ–‡è·å–å½“å‰ç§Ÿæˆ·ID
        return TenantContext.getCurrentTenantId();
    }
}
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```java
@Entity
@Table(name = "t_order")
public class Order extends TenantEntity {
    
    private String orderNo;
    private BigDecimal amount;
}

// ä¿å­˜æ—¶è‡ªåŠ¨å…³è”ç§Ÿæˆ·
Order order = new Order();
order.setOrderNo("ORD123");
order.setAmount(new BigDecimal("99.99"));

orderRepository.save(order);  
// è‡ªåŠ¨è®¾ç½® tenantId = å½“å‰ç™»å½•ç”¨æˆ·çš„ç§Ÿæˆ·ID
```

### 4.4 ç‰ˆæœ¬æ§åˆ¶æ¨¡å¼


**å¸¦ç‰ˆæœ¬å·çš„åŸºç±»**ï¼š
```java
@MappedSuperclass
public abstract class VersionedEntity extends BaseEntity {
    
    // ç‰ˆæœ¬å·ï¼ˆä¹è§‚é”ï¼‰
    @Version
    @Column(name = "version")
    private Integer version;
    
    // æ•°æ®ç‰ˆæœ¬æè¿°
    @Column(name = "version_desc")
    private String versionDesc;
}
```

**é˜²æ­¢å¹¶å‘ä¿®æ”¹**ï¼š
```java
@Entity
public class Product extends VersionedEntity {
    private String productName;
    private BigDecimal price;
}

// åœºæ™¯ï¼šä¸¤ä¸ªç”¨æˆ·åŒæ—¶ä¿®æ”¹åŒä¸€å•†å“
// ç”¨æˆ·Aè¯»å–å•†å“
Product productA = productRepository.findById(1L).get();
// version = 1

// ç”¨æˆ·Bä¹Ÿè¯»å–åŒä¸€å•†å“
Product productB = productRepository.findById(1L).get();
// version = 1

// ç”¨æˆ·Aå…ˆä¿å­˜
productA.setPrice(new BigDecimal("100"));
productRepository.save(productA);  
// version è‡ªåŠ¨å˜æˆ 2

// ç”¨æˆ·Båä¿å­˜
productB.setPrice(new BigDecimal("90"));
productRepository.save(productB);  
// æŠ›å‡ºOptimisticLockExceptionï¼å› ä¸ºversionä¸åŒ¹é…
```

---

## 5. ğŸ’¡ æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹


### 5.1 è®¾è®¡åŸåˆ™


**åŸåˆ™1ï¼šå•ä¸€èŒè´£**
```java
// âœ… å¥½çš„è®¾è®¡ï¼šèŒè´£æ¸…æ™°
@MappedSuperclass
public abstract class IdEntity {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
}

@MappedSuperclass
public abstract class AuditEntity extends IdEntity {
    private LocalDateTime createTime;
    private String createBy;
}

@MappedSuperclass
public abstract class SoftDeleteEntity extends AuditEntity {
    private Boolean deleted;
}

// âŒ ä¸å¥½çš„è®¾è®¡ï¼šå…¨éƒ¨å¡ä¸€èµ·
@MappedSuperclass
public abstract class SuperEntity {
    private Long id;
    private LocalDateTime createTime;
    private String createBy;
    private Boolean deleted;
    private Long tenantId;
    private Integer version;
    // å¤ªå¤šäº†ï¼èŒè´£ä¸æ¸…æ™°
}
```

**åŸåˆ™2ï¼šåˆç†çš„ç»§æ‰¿å±‚æ¬¡**
```
å»ºè®®ï¼šä¸è¶…è¿‡3å±‚ç»§æ‰¿

åˆç†çš„ç»“æ„ï¼š
BaseEntity (id)
    â†“
AuditEntity (å®¡è®¡å­—æ®µ)
    â†“
SoftDeleteEntity (é€»è¾‘åˆ é™¤)
    â†“
å…·ä½“ä¸šåŠ¡å®ä½“

è¿‡æ·±çš„ç»§æ‰¿ï¼š
BaseEntity â†’ AuditEntity â†’ TenantEntity 
â†’ VersionEntity â†’ SoftDeleteEntity â†’ ä¸šåŠ¡å®ä½“
ï¼ˆå¤ªå¤æ‚äº†ï¼ï¼‰
```

### 5.2 å¸¸è§é™·é˜±ä¸è§£å†³


**é™·é˜±1ï¼šå­—æ®µåå†²çª**
```java
@MappedSuperclass
public abstract class BaseEntity {
    private String name;  // çˆ¶ç±»æœ‰nameå­—æ®µ
}

@Entity
public class User extends BaseEntity {
    private String name;  // å­ç±»ä¹Ÿå®šä¹‰äº†name
    
    // é—®é¢˜ï¼šä¼šæœ‰ä¸¤ä¸ªnameå­—æ®µï¼
    // è§£å†³ï¼šä½¿ç”¨ä¸åŒçš„å­—æ®µåï¼Œæˆ–ç”¨@AttributeOverride
}

// æ­£ç¡®åšæ³•ï¼šé‡å‘½åçˆ¶ç±»å­—æ®µ
@Entity
@AttributeOverride(
    name = "name",
    column = @Column(name = "entity_name")
)
public class User extends BaseEntity {
    @Column(name = "user_name")
    private String name;
}
```

**é™·é˜±2ï¼šå¿˜è®°çˆ¶ç±»æœ‰äº‹åŠ¡æ–¹æ³•**
```java
@MappedSuperclass
public abstract class BaseEntity {
    
    @PrePersist
    protected void onCreate() {
        System.out.println("çˆ¶ç±»çš„PrePersist");
    }
}

@Entity
public class User extends BaseEntity {
    
    @PrePersist
    protected void setDefaultValues() {
        System.out.println("å­ç±»çš„PrePersist");
    }
    
    // é—®é¢˜ï¼šçˆ¶ç±»çš„@PrePersistä¸ä¼šæ‰§è¡Œï¼
    // è§£å†³ï¼šåœ¨å­ç±»æ–¹æ³•ä¸­è°ƒç”¨super.onCreate()
}

// æ­£ç¡®åšæ³•
@PrePersist
protected void setDefaultValues() {
    super.onCreate();  // å…ˆè°ƒç”¨çˆ¶ç±»æ–¹æ³•
    System.out.println("å­ç±»çš„PrePersist");
}
```

**é™·é˜±3ï¼šæŸ¥è¯¢æ—¶å¿˜è®°è¿‡æ»¤**
```java
@MappedSuperclass
public abstract class SoftDeleteEntity {
    private Boolean deleted = false;
}

@Entity
public class Product extends SoftDeleteEntity {
    private String name;
}

// âŒ å¿˜è®°è¿‡æ»¤deletedå­—æ®µ
List<Product> products = productRepository.findAll();
// åŒ…å«äº†å·²åˆ é™¤çš„æ•°æ®ï¼

// âœ… æ–¹æ¡ˆ1ï¼šåœ¨å®ä½“ç±»åŠ @Whereæ³¨è§£
@Entity
@Where(clause = "deleted = false")
public class Product extends SoftDeleteEntity {
    private String name;
}

// âœ… æ–¹æ¡ˆ2ï¼šåœ¨Repositoryä¸­å®šä¹‰æŸ¥è¯¢æ–¹æ³•
public interface ProductRepository extends JpaRepository<Product, Long> {
    List<Product> findByDeletedFalse();
}
```

### 5.3 æ€§èƒ½ä¼˜åŒ–å»ºè®®


**ä¼˜åŒ–1ï¼šç´¢å¼•ç­–ç•¥**
```java
@MappedSuperclass
public abstract class BaseEntity {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    // ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µæ·»åŠ ç´¢å¼•
    @Column(name = "create_time")
    @Index(name = "idx_create_time")  // æ·»åŠ ç´¢å¼•
    private LocalDateTime createTime;
}
```

**ä¼˜åŒ–2ï¼šå»¶è¿ŸåŠ è½½**
```java
@MappedSuperclass
public abstract class BaseEntity {
    
    // å¤§å­—æ®µä½¿ç”¨å»¶è¿ŸåŠ è½½
    @Lob
    @Basic(fetch = FetchType.LAZY)
    @Column(name = "remark")
    private String remark;
}
```

### 5.4 å®ç”¨å·¥å…·æ–¹æ³•


**æ·»åŠ ä¾¿æ·æ–¹æ³•**ï¼š
```java
@MappedSuperclass
public abstract class BaseEntity {
    
    @Id
    private Long id;
    
    // åˆ¤æ–­æ˜¯å¦æ–°å»ºå®ä½“
    public boolean isNew() {
        return this.id == null;
    }
    
    // è·å–å®ä½“æ ‡è¯†
    public String getEntityId() {
        return getClass().getSimpleName() + ":" + id;
    }
    
    // å®ä½“å…‹éš†ï¼ˆä¸åŒ…æ‹¬IDï¼‰
    public abstract BaseEntity cloneWithoutId();
}
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


ğŸ”´ **å¿…é¡»æŒæ¡**ï¼š
- `@MappedSuperclass` æ˜¯å­—æ®µå¤ç”¨çš„æ¨¡æ¿ï¼Œæœ¬èº«ä¸æ˜¯å®ä½“
- çˆ¶ç±»å­—æ®µä¼šåˆå¹¶åˆ°å­ç±»çš„è¡¨ä¸­
- ä¸èƒ½æŸ¥è¯¢çˆ¶ç±»ï¼Œåªèƒ½æŸ¥è¯¢å­ç±»
- ä¸èƒ½å»ºç«‹å…³è”å…³ç³»åˆ°çˆ¶ç±»

ğŸŸ¡ **å»ºè®®äº†è§£**ï¼š
- é…åˆ `@PrePersist`ã€`@PreUpdate` è‡ªåŠ¨å¡«å……
- ä½¿ç”¨ `@AttributeOverride` è¦†ç›–çˆ¶ç±»å­—æ®µé…ç½®
- å®¡è®¡å­—æ®µã€é€»è¾‘åˆ é™¤ã€å¤šç§Ÿæˆ·ç­‰å…¸å‹æ¨¡å¼

ğŸŸ¢ **æ‹“å±•çŸ¥è¯†**ï¼š
- ä¸ `@Entity` ç»§æ‰¿çš„åŒºåˆ«
- å¤šå±‚ç»§æ‰¿çš„è®¾è®¡åŸåˆ™
- æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 6.2 å…³é”®ç†è§£è¦ç‚¹


**æ ¸å¿ƒç‰¹æ€§**ï¼š
```
âœ… å­—æ®µå¤ç”¨ï¼šå…¬å…±å­—æ®µå®šä¹‰ä¸€æ¬¡ï¼Œå¤šå¤„ä½¿ç”¨
âœ… ä¸ç”Ÿæˆè¡¨ï¼šçˆ¶ç±»æœ¬èº«ä¸å¯¹åº”æ•°æ®åº“è¡¨
âœ… å­—æ®µåˆå¹¶ï¼šçˆ¶ç±»å­—æ®µ + å­ç±»å­—æ®µ = å®Œæ•´è¡¨
âœ… æ”¯æŒJPAæ³¨è§£ï¼š@Columnã€@PrePersistç­‰éƒ½å¯ç”¨
```

**é‡è¦é™åˆ¶**ï¼š
```
âŒ ä¸èƒ½æŸ¥è¯¢ï¼šæ— æ³•å¯¹çˆ¶ç±»æ‰§è¡ŒæŸ¥è¯¢æ“ä½œ
âŒ ä¸èƒ½å…³è”ï¼šä¸èƒ½ä½œä¸º@ManyToOneçš„ç›®æ ‡
âŒ æ— ç»§æ‰¿ç­–ç•¥ï¼šä¸æ”¯æŒ@Inheritanceæ³¨è§£
```

**ä½¿ç”¨åœºæ™¯**ï¼š
```
1ï¸âƒ£ å®¡è®¡å­—æ®µï¼ˆcreateTimeã€updateTimeç­‰ï¼‰
2ï¸âƒ£ é€»è¾‘åˆ é™¤å­—æ®µï¼ˆdeletedã€deleteTimeç­‰ï¼‰
3ï¸âƒ£ å¤šç§Ÿæˆ·å­—æ®µï¼ˆtenantIdï¼‰
4ï¸âƒ£ ç‰ˆæœ¬æ§åˆ¶å­—æ®µï¼ˆversionï¼‰
5ï¸âƒ£ æ‰€æœ‰å®ä½“çš„å…¬å…±å­—æ®µ
```

### 6.3 å®æˆ˜æ£€æŸ¥æ¸…å•


**âœ… æœ¬èŠ‚æ£€æŸ¥æ¸…å•**ï¼š
- [ ] èƒ½è¯´å‡º @MappedSuperclass çš„ä½œç”¨
- [ ] ç†è§£ä¸ºä»€ä¹ˆçˆ¶ç±»ä¸èƒ½è¢«æŸ¥è¯¢
- [ ] èƒ½è®¾è®¡å®¡è®¡å­—æ®µçš„åŸºç±»
- [ ] çŸ¥é“å¦‚ä½•é…åˆ @PrePersist ä½¿ç”¨
- [ ] ç†è§£ä¸ @Entity ç»§æ‰¿çš„åŒºåˆ«

**ğŸ“Š æŒæ¡åº¦è‡ªè¯„**ï¼š
- æ¦‚å¿µç†è§£ï¼šâ­â­â­â­â­ (5/5)
- å®é™…åº”ç”¨ï¼šâ­â­â­â­â˜† (4/5)
- é—®é¢˜æ’æŸ¥ï¼šâ­â­â­â˜†â˜† (3/5)

### 6.4 ä¸€å¥è¯ç²¾å


> ğŸ¯ **æ ¸å¿ƒè®°å¿†**ï¼š
> 
> @MappedSuperclass å°±åƒ"å­—æ®µæ¨¡æ¿"ï¼Œå®šä¹‰ä¸€æ¬¡å¤šå¤„ç»§æ‰¿ï¼Œ
> ä¸ç”Ÿæˆè¡¨ä¸èƒ½æŸ¥ï¼Œåªä¸ºå­—æ®µå¤ç”¨è€Œç”Ÿã€‚

**è®°å¿†å£è¯€**ï¼š
```
æ˜ å°„è¶…ç±»ä½œæ¨¡æ¿ï¼Œå…¬å…±å­—æ®µå®šä¹‰å®ƒ
æœ¬èº«ä¸æ˜¯å®ä½“ç±»ï¼Œå­ç±»ç»§æ‰¿å…¨éƒ½æœ‰
å®¡è®¡å­—æ®µæœ€å¸¸ç”¨ï¼Œåˆ›å»ºä¿®æ”¹éƒ½è®°å½•
é€»è¾‘åˆ é™¤é…åˆå¥½ï¼Œå¤šç§Ÿæˆ·ä¹Ÿèƒ½æ
ä¸èƒ½æŸ¥è¯¢è¦è®°ç‰¢ï¼Œå…³è”å…³ç³»ä¹Ÿä¸è¦
å­—æ®µå¤ç”¨ç¬¬ä¸€é€‰ï¼Œä»£ç ç®€æ´åˆé«˜æ•ˆ
```

**å¿«é€Ÿå†³ç­–æ ‘**ï¼š
```
éœ€è¦å¤ç”¨å­—æ®µï¼Ÿ
    â†“
   æ˜¯ â†’ å­—æ®µæœ‰ä¸šåŠ¡æ„ä¹‰ï¼Ÿ
           â†“               â†“
          å¦              æ˜¯
           â†“               â†“
    @MappedSuperclass  @Entityç»§æ‰¿
    ï¼ˆçº¯ç²¹å­—æ®µå¤ç”¨ï¼‰   ï¼ˆä¸šåŠ¡ç»§æ‰¿ï¼‰
```

### 6.5 å¸¸è§é—®é¢˜FAQ


**Q1ï¼š@MappedSuperclass å’Œ @Entity ç»§æ‰¿æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**
```
@MappedSuperclassï¼š
- çº¯ç²¹å­—æ®µå¤ç”¨ï¼Œä¸æ˜¯å®ä½“
- ä¸ç”Ÿæˆè¡¨ï¼Œä¸èƒ½æŸ¥è¯¢
- é€‚åˆå…¬å…±å­—æ®µï¼ˆå¦‚å®¡è®¡å­—æ®µï¼‰

@Entity ç»§æ‰¿ï¼š
- ä¸šåŠ¡æ„ä¹‰çš„ç»§æ‰¿ï¼Œæ˜¯å®ä½“
- ç”Ÿæˆè¡¨ï¼Œå¯ä»¥æŸ¥è¯¢
- é€‚åˆæœ‰ä¸šåŠ¡å…³ç³»çš„ç»§æ‰¿
```

**Q2ï¼šèƒ½ä¸èƒ½åŒæ—¶ä½¿ç”¨å¤šä¸ªçˆ¶ç±»ï¼Ÿ**
```
âŒ Javaä¸æ”¯æŒå¤šç»§æ‰¿ï¼Œåªèƒ½ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»

âœ… è§£å†³æ–¹æ¡ˆï¼š
- è®¾è®¡åˆç†çš„ç»§æ‰¿å±‚æ¬¡
- æˆ–ä½¿ç”¨æ¥å£+é»˜è®¤æ–¹æ³•
- æˆ–ä½¿ç”¨ç»„åˆä»£æ›¿ç»§æ‰¿
```

**Q3ï¼š@PrePersist åœ¨çˆ¶ç±»å’Œå­ç±»éƒ½æœ‰ï¼Œå“ªä¸ªä¼šæ‰§è¡Œï¼Ÿ**
```
âš ï¸ éƒ½ä¼šæ‰§è¡Œï¼Œä½†é¡ºåºæ˜¯ï¼š
1. å…ˆæ‰§è¡Œçˆ¶ç±»çš„ @PrePersist
2. å†æ‰§è¡Œå­ç±»çš„ @PrePersist

ğŸ’¡ å¦‚æœå­ç±»è¦†ç›–äº†æ–¹æ³•ï¼Œè®°å¾—è°ƒç”¨ super.æ–¹æ³•å()
```

**Q4ï¼šå¦‚ä½•è®©å­ç±»çš„æŸä¸ªå­—æ®µä¸ç»§æ‰¿çˆ¶ç±»çš„é…ç½®ï¼Ÿ**
```java
// ä½¿ç”¨ @AttributeOverride
@Entity
@AttributeOverride(
    name = "createTime",
    column = @Column(name = "user_create_time", nullable = true)
)
public class User extends BaseEntity {
    // createTime å­—æ®µçš„é…ç½®è¢«è¦†ç›–äº†
}
```

**Q5ï¼šé€»è¾‘åˆ é™¤åæŸ¥è¯¢è¿˜èƒ½æŸ¥åˆ°æ•°æ®æ€ä¹ˆåŠï¼Ÿ**
```java
// æ–¹æ¡ˆ1ï¼šåœ¨å®ä½“ç±»æ·»åŠ  @Where æ³¨è§£
@Entity
@Where(clause = "deleted = false")
public class Product extends SoftDeleteEntity {
    // æŸ¥è¯¢æ—¶è‡ªåŠ¨è¿‡æ»¤ deleted = true çš„æ•°æ®
}

// æ–¹æ¡ˆ2ï¼šåœ¨ Repository ä¸­å®šä¹‰æ–¹æ³•
List<Product> findByDeletedFalse();

// æ–¹æ¡ˆ3ï¼šä½¿ç”¨ @SQLDelete è‡ªå®šä¹‰åˆ é™¤é€»è¾‘
@Entity
@SQLDelete(sql = "UPDATE product SET deleted = true WHERE id = ?")
public class Product extends SoftDeleteEntity {
    // è°ƒç”¨ delete() æ—¶æ‰§è¡Œæ›´æ–°è€ŒéçœŸåˆ é™¤
}
```

---

## ğŸ“ å­¦ä¹ è·¯å¾„å»ºè®®


**åˆå­¦è€…è·¯çº¿**ï¼š
```
ç¬¬1æ­¥ï¼šç†è§£ @MappedSuperclass çš„åŸºæœ¬æ¦‚å¿µ
       â†“
ç¬¬2æ­¥ï¼šåˆ›å»ºç®€å•çš„å®¡è®¡å­—æ®µåŸºç±»
       â†“
ç¬¬3æ­¥ï¼šåœ¨ä¸šåŠ¡å®ä½“ä¸­ä½¿ç”¨ç»§æ‰¿
       â†“
ç¬¬4æ­¥ï¼šé…åˆ @PrePersist å®ç°è‡ªåŠ¨å¡«å……
       â†“
ç¬¬5æ­¥ï¼šç†è§£ä¸ @Entity ç»§æ‰¿çš„åŒºåˆ«
```

**è¿›é˜¶å­¦ä¹ **ï¼š
```
ç¬¬6æ­¥ï¼šå®ç°é€»è¾‘åˆ é™¤æ¨¡å¼
       â†“
ç¬¬7æ­¥ï¼šå¤šç§Ÿæˆ·å­—æ®µè®¾è®¡
       â†“
ç¬¬8æ­¥ï¼šç‰ˆæœ¬æ§åˆ¶ä¸ä¹è§‚é”
       â†“
ç¬¬9æ­¥ï¼šè§£å†³å®é™…é¡¹ç›®ä¸­çš„é—®é¢˜
       â†“
ç¬¬10æ­¥ï¼šæ€§èƒ½ä¼˜åŒ–å’Œæœ€ä½³å®è·µ
```

**å®æˆ˜æ¼”ç»ƒ**ï¼š
```
ğŸ§ª ç»ƒä¹ 1ï¼šè®¾è®¡ä¸€ä¸ªåŒ…å«å®¡è®¡å­—æ®µçš„åŸºç±»
ğŸ§ª ç»ƒä¹ 2ï¼šå®ç°é€»è¾‘åˆ é™¤åŠŸèƒ½
ğŸ§ª ç»ƒä¹ 3ï¼šè§£å†³å­—æ®µåå†²çªé—®é¢˜
ğŸ§ª ç»ƒä¹ 4ï¼šå¯¹æ¯” @MappedSuperclass å’Œ @Entity ç»§æ‰¿çš„æ€§èƒ½
ğŸ§ª ç»ƒä¹ 5ï¼šåœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨æ‰€å­¦çŸ¥è¯†
```

---

## ğŸ“š ç›¸å…³çŸ¥è¯†é“¾æ¥


**å‰ç½®çŸ¥è¯†**ï¼š
- JPA å®ä½“ç±»åŸºç¡€
- Java ç»§æ‰¿æœºåˆ¶
- æ•°æ®åº“è¡¨è®¾è®¡åŸåˆ™

**åç»­å­¦ä¹ **ï¼š
- JPA ç»§æ‰¿æ˜ å°„ç­–ç•¥ï¼ˆSINGLE_TABLEã€JOINEDã€TABLE_PER_CLASSï¼‰
- å®ä½“ç”Ÿå‘½å‘¨æœŸå›è°ƒï¼ˆ@PrePersistã€@PostLoad ç­‰ï¼‰
- JPA å®¡è®¡åŠŸèƒ½ï¼ˆSpring Data JPA Auditingï¼‰
- ä¹è§‚é”ä¸æ‚²è§‚é”

**æ‹“å±•é˜…è¯»**ï¼š
- ã€ŠJava Persistence with Hibernateã€‹
- ã€ŠSpring Data JPA ä»å…¥é—¨åˆ°ç²¾é€šã€‹
- JPA å®˜æ–¹æ–‡æ¡£

---

## ğŸ¯ æ€»ç»“


**æ ¸å¿ƒè¦ç‚¹å›é¡¾**ï¼š

1ï¸âƒ£ **@MappedSuperclass æ˜¯ä»€ä¹ˆ**ï¼š
- å­—æ®µå¤ç”¨çš„æ¨¡æ¿ï¼Œä¸æ˜¯å®ä½“ç±»
- çˆ¶ç±»å­—æ®µåˆå¹¶åˆ°å­ç±»è¡¨ä¸­
- æœ¬èº«ä¸ç”Ÿæˆè¡¨ï¼Œä¸èƒ½è¢«æŸ¥è¯¢

2ï¸âƒ£ **æ ¸å¿ƒä½¿ç”¨åœºæ™¯**ï¼š
- å®¡è®¡å­—æ®µï¼ˆåˆ›å»ºæ—¶é—´ã€ä¿®æ”¹æ—¶é—´ç­‰ï¼‰
- é€»è¾‘åˆ é™¤å­—æ®µ
- å¤šç§Ÿæˆ·å­—æ®µ
- ç‰ˆæœ¬æ§åˆ¶å­—æ®µ

3ï¸âƒ£ **é‡è¦é™åˆ¶**ï¼š
- ä¸èƒ½æŸ¥è¯¢çˆ¶ç±»
- ä¸èƒ½å»ºç«‹å…³è”åˆ°çˆ¶ç±»
- ä¸æ”¯æŒç»§æ‰¿ç­–ç•¥

4ï¸âƒ£ **æœ€ä½³å®è·µ**ï¼š
- å•ä¸€èŒè´£åŸåˆ™
- åˆç†çš„ç»§æ‰¿å±‚æ¬¡ï¼ˆä¸è¶…è¿‡3å±‚ï¼‰
- é…åˆ @PrePersist/@PreUpdate è‡ªåŠ¨å¡«å……
- é¿å…å­—æ®µåå†²çª

5ï¸âƒ£ **ä¸ @Entity ç»§æ‰¿çš„é€‰æ‹©**ï¼š
- çº¯å­—æ®µå¤ç”¨ â†’ @MappedSuperclass
- ä¸šåŠ¡ç»§æ‰¿å…³ç³» â†’ @Entity ç»§æ‰¿

**æœ€åçš„è¯**ï¼š

@MappedSuperclass æ˜¯ JPA ä¸­éå¸¸å®ç”¨çš„ç‰¹æ€§ï¼Œå®ƒè®©æˆ‘ä»¬èƒ½å¤Ÿä¼˜é›…åœ°å¤ç”¨å…¬å…±å­—æ®µï¼Œé¿å…ä»£ç é‡å¤ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œåˆç†ä½¿ç”¨ @MappedSuperclass å¯ä»¥ï¼š

âœ… æé«˜ä»£ç å¤ç”¨ç‡
âœ… å‡å°‘é‡å¤ä»£ç 
âœ… ç»Ÿä¸€ç®¡ç†å…¬å…±å­—æ®µ
âœ… ç®€åŒ–å®ä½“ç±»è®¾è®¡

è®°ä½ï¼š**@MappedSuperclass å°±åƒä¸€ä¸ªå­—æ®µæ¨¡æ¿ï¼Œå®šä¹‰ä¸€æ¬¡ï¼Œåˆ°å¤„ç»§æ‰¿ï¼**