---
title: 7ã€å¤åˆä¸»é”®æ˜ å°„
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯å¤åˆä¸»é”®](#1-ä»€ä¹ˆæ˜¯å¤åˆä¸»é”®)
2. [å¤åˆä¸»é”®çš„ä¸¤ç§å®ç°æ–¹å¼](#2-å¤åˆä¸»é”®çš„ä¸¤ç§å®ç°æ–¹å¼)
3. [IdClassæ–¹å¼è¯¦è§£](#3-IdClassæ–¹å¼è¯¦è§£)
4. [EmbeddedIdæ–¹å¼è¯¦è§£](#4-EmbeddedIdæ–¹å¼è¯¦è§£)
5. [ä¸¤ç§æ–¹å¼çš„å¯¹æ¯”é€‰æ‹©](#5-ä¸¤ç§æ–¹å¼çš„å¯¹æ¯”é€‰æ‹©)
6. [å¤åˆä¸»é”®çš„æŸ¥è¯¢æ“ä½œ](#6-å¤åˆä¸»é”®çš„æŸ¥è¯¢æ“ä½œ)
7. [å®æˆ˜æœ€ä½³å®è·µ](#7-å®æˆ˜æœ€ä½³å®è·µ)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”‘ ä»€ä¹ˆæ˜¯å¤åˆä¸»é”®


### 1.1 å¤åˆä¸»é”®çš„æ¦‚å¿µ


**é€šä¿—ç†è§£**ï¼šæƒ³è±¡ä¸€ä¸ªå­¦ç”Ÿé€‰è¯¾ç³»ç»Ÿï¼Œæ¯ä¸ªå­¦ç”Ÿå¯ä»¥é€‰å¤šé—¨è¯¾ï¼Œæ¯é—¨è¯¾ä¹Ÿæœ‰å¤šä¸ªå­¦ç”Ÿé€‰ã€‚é‚£ä¹ˆå¦‚ä½•å”¯ä¸€æ ‡è¯†ä¸€æ¡é€‰è¯¾è®°å½•å‘¢ï¼Ÿ

```
å•ä¸€ä¸»é”®çš„è¡¨ï¼ˆå­¦ç”Ÿè¡¨ï¼‰ï¼š
å­¦ç”ŸID    å§“å      ç­çº§
001      å¼ ä¸‰      ä¸€ç­     â† å­¦ç”ŸIDå°±èƒ½å”¯ä¸€ç¡®å®šä¸€ä¸ªå­¦ç”Ÿ
002      æå››      äºŒç­

å¤åˆä¸»é”®çš„è¡¨ï¼ˆé€‰è¯¾è¡¨ï¼‰ï¼š
å­¦ç”ŸID    è¯¾ç¨‹ID    æˆç»©      â† éœ€è¦"å­¦ç”ŸID + è¯¾ç¨‹ID"æ‰èƒ½ç¡®å®šä¸€æ¡è®°å½•
001      Math      90
001      English   85       
002      Math      88
```

**æ ¸å¿ƒå®šä¹‰**ï¼š
```
å¤åˆä¸»é”® = ç”±å¤šä¸ªå­—æ®µç»„åˆè€Œæˆçš„ä¸»é”®
ç”¨é€”ï¼šå½“å•ä¸ªå­—æ®µæ— æ³•å”¯ä¸€æ ‡è¯†ä¸€æ¡è®°å½•æ—¶ä½¿ç”¨
ç‰¹ç‚¹ï¼šå¤šä¸ªå­—æ®µè”åˆèµ·æ¥æ‰èƒ½ä¿è¯å”¯ä¸€æ€§
```

### 1.2 ä»€ä¹ˆæ—¶å€™éœ€è¦å¤åˆä¸»é”®


**å…¸å‹åº”ç”¨åœºæ™¯**ï¼š

| åœºæ™¯ | å¤åˆä¸»é”®ç»„æˆ | ä¸ºä»€ä¹ˆéœ€è¦ |
|------|------------|-----------|
| ğŸ“š **å­¦ç”Ÿé€‰è¯¾** | `å­¦ç”ŸID + è¯¾ç¨‹ID` | åŒä¸€å­¦ç”Ÿå¯é€‰å¤šé—¨è¯¾ï¼ŒåŒä¸€è¯¾ç¨‹æœ‰å¤šä¸ªå­¦ç”Ÿ |
| ğŸ›’ **è®¢å•æ˜ç»†** | `è®¢å•ID + å•†å“ID` | ä¸€ä¸ªè®¢å•åŒ…å«å¤šä¸ªå•†å“ |
| ğŸ“… **æ’ç­è¡¨** | `å‘˜å·¥ID + æ—¥æœŸ` | ä¸€ä¸ªå‘˜å·¥æ¯å¤©ä¸€æ¡æ’ç­è®°å½• |
| ğŸ¢ **éƒ¨é—¨èŒä½** | `éƒ¨é—¨ID + èŒä½ID` | åŒä¸€èŒä½å¯èƒ½åœ¨å¤šä¸ªéƒ¨é—¨ï¼ŒåŒä¸€éƒ¨é—¨æœ‰å¤šä¸ªèŒä½ |

**åˆ¤æ–­æ ‡å‡†**ï¼š
```
âœ… éœ€è¦å¤åˆä¸»é”®çš„æƒ…å†µï¼š
â€¢ ä¸šåŠ¡ä¸Šéœ€è¦å¤šä¸ªå­—æ®µæ‰èƒ½ç¡®å®šå”¯ä¸€æ€§
â€¢ è¡¨ç¤ºçš„æ˜¯ä¸¤ä¸ªæˆ–å¤šä¸ªå®ä½“ä¹‹é—´çš„å…³ç³»
â€¢ æ²¡æœ‰è‡ªç„¶çš„å•ä¸€æ ‡è¯†å­—æ®µ

âŒ ä¸éœ€è¦å¤åˆä¸»é”®çš„æƒ…å†µï¼š
â€¢ æœ‰æ˜ç¡®çš„ä¸šåŠ¡å”¯ä¸€IDï¼ˆå¦‚ç”¨æˆ·IDã€è®¢å•å·ï¼‰
â€¢ å¯ä»¥ç”¨è‡ªå¢IDæˆ–UUIDä½œä¸ºä¸»é”®
â€¢ ä¸ºäº†ç®€åŒ–è®¾è®¡ï¼Œå¯ä»¥æ·»åŠ ä»£ç†ä¸»é”®
```

### 1.3 å¤åˆä¸»é”® vs æ™®é€šä¸»é”®


```
æ™®é€šä¸»é”®çš„å®ä½“ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Student   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)     â”‚ â† å•ä¸ªå­—æ®µä½œä¸ºä¸»é”®
â”‚ name        â”‚
â”‚ age         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¤åˆä¸»é”®çš„å®ä½“ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  StudentCourse  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ studentId (PK1) â”‚ â† ä¸¤ä¸ªå­—æ®µ
â”‚ courseId  (PK2) â”‚ â† è”åˆä½œä¸ºä¸»é”®
â”‚ score           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ğŸ¯ å¤åˆä¸»é”®çš„ä¸¤ç§å®ç°æ–¹å¼


JPAæä¾›äº†ä¸¤ç§æ–¹å¼æ¥å®ç°å¤åˆä¸»é”®ï¼Œå®ƒä»¬çš„ç›®çš„ç›¸åŒï¼Œä½†å†™æ³•å’Œä½¿ç”¨åœºæ™¯æœ‰æ‰€ä¸åŒã€‚

### 2.1 ä¸¤ç§æ–¹å¼æ¦‚è§ˆ


```
æ–¹å¼ä¸€ï¼š@IdClassï¼ˆå¤–éƒ¨ä¸»é”®ç±»ï¼‰
ç‰¹ç‚¹ï¼šä¸»é”®å­—æ®µç›´æ¥å†™åœ¨å®ä½“ç±»ä¸­
é€‚ç”¨ï¼šå­—æ®µè¾ƒå°‘ï¼Œé€»è¾‘ç®€å•çš„åœºæ™¯

     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ IdClassç±»     â”‚ â† å•ç‹¬å®šä¹‰ä¸»é”®ç±»
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚ studentId    â”‚
     â”‚ courseId     â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†‘
            â”‚ å¼•ç”¨
            â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ å®ä½“ç±»        â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚ studentId    â”‚ â† å­—æ®µç›´æ¥åœ¨å®ä½“ç±»ä¸­
     â”‚ courseId     â”‚
     â”‚ score        â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ–¹å¼äºŒï¼š@EmbeddedIdï¼ˆåµŒå…¥å¼ä¸»é”®ï¼‰
ç‰¹ç‚¹ï¼šä¸»é”®å­—æ®µå°è£…åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­
é€‚ç”¨ï¼šå­—æ®µè¾ƒå¤šï¼Œéœ€è¦å¤ç”¨ä¸»é”®é€»è¾‘

     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ Embeddableç±» â”‚ â† å¯åµŒå…¥çš„ä¸»é”®ç±»
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚ studentId    â”‚
     â”‚ courseId     â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†‘
            â”‚ åµŒå…¥
            â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ å®ä½“ç±»        â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚ id (å¤åˆå¯¹è±¡) â”‚ â† ä¸»é”®æ˜¯ä¸€ä¸ªå¯¹è±¡
     â”‚ score        â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ä¸¤ç§æ–¹å¼çš„æ ¸å¿ƒåŒºåˆ«


| ç‰¹æ€§ | @IdClass | @EmbeddedId |
|------|----------|-------------|
| **ä¸»é”®ä½ç½®** | å­—æ®µç›´æ¥åœ¨å®ä½“ç±»ä¸­ | å­—æ®µå°è£…åœ¨ç‹¬ç«‹ç±»ä¸­ |
| **è®¿é—®æ–¹å¼** | `entity.getStudentId()` | `entity.getId().getStudentId()` |
| **ä»£ç ç®€æ´åº¦** | å®ä½“ç±»å­—æ®µå¤šä¸€äº› | å®ä½“ç±»æ›´ç®€æ´ |
| **æŸ¥è¯¢ä¾¿åˆ©æ€§** | å¯ç›´æ¥ç”¨å­—æ®µæŸ¥è¯¢ | éœ€è¦é€šè¿‡å¤åˆå¯¹è±¡ |
| **å¤ç”¨æ€§** | è¾ƒå·® | è¾ƒå¥½ï¼ˆä¸»é”®ç±»å¯å¤ç”¨ï¼‰ |

---

## 3. ğŸ“ IdClassæ–¹å¼è¯¦è§£


### 3.1 IdClassçš„åŸºæœ¬ç»“æ„


**ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸»é”®ç±»**

ä¸»é”®ç±»éœ€è¦æ»¡è¶³ç‰¹å®šè¦æ±‚ï¼š

```java
// ä¸»é”®ç±»ï¼ˆå¿…é¡»æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼‰
public class StudentCourseId implements Serializable {
    
    private Long studentId;  // â‘  å­—æ®µåå¿…é¡»ä¸å®ä½“ç±»ä¸€è‡´
    private Long courseId;   // â‘¡ å­—æ®µç±»å‹å¿…é¡»ä¸å®ä½“ç±»ä¸€è‡´
    
    // â‘¢ å¿…é¡»æœ‰æ— å‚æ„é€ å™¨
    public StudentCourseId() {}
    
    // â‘£ å¿…é¡»æœ‰æœ‰å‚æ„é€ å™¨ï¼ˆæ–¹ä¾¿åˆ›å»ºï¼‰
    public StudentCourseId(Long studentId, Long courseId) {
        this.studentId = studentId;
        this.courseId = courseId;
    }
    
    // â‘¤ å¿…é¡»å®ç°equalsæ–¹æ³•ï¼ˆç”¨äºä¸»é”®æ¯”è¾ƒï¼‰
    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        StudentCourseId that = (StudentCourseId) o;
        return Objects.equals(studentId, that.studentId) &&
               Objects.equals(courseId, that.courseId);
    }
    
    // â‘¥ å¿…é¡»å®ç°hashCodeæ–¹æ³•ï¼ˆç”¨äºå“ˆå¸Œå­˜å‚¨ï¼‰
    @Override
    public int hashCode() {
        return Objects.hash(studentId, courseId);
    }
    
    // getterå’Œsetterçœç•¥...
}
```

> ğŸ’¡ **ä¸ºä»€ä¹ˆè¦å®ç°Serializableï¼Ÿ**  
> å› ä¸ºä¸»é”®å¯èƒ½éœ€è¦åœ¨ç½‘ç»œä¼ è¾“æˆ–ç¼“å­˜ä¸­ä½¿ç”¨ï¼Œå®ç°åºåˆ—åŒ–æ¥å£æ˜¯JPAè§„èŒƒçš„è¦æ±‚ã€‚

> ğŸ¯ **ä¸ºä»€ä¹ˆå¿…é¡»é‡å†™equalså’ŒhashCodeï¼Ÿ**  
> JPAéœ€è¦é€šè¿‡è¿™ä¸¤ä¸ªæ–¹æ³•æ¥åˆ¤æ–­ä¸¤ä¸ªå®ä½“æ˜¯å¦ç›¸åŒï¼Œæ¯”å¦‚åœ¨ç¼“å­˜ã€é›†åˆæ“ä½œä¸­ã€‚

**ç¬¬äºŒæ­¥ï¼šåˆ›å»ºå®ä½“ç±»**

```java
@Entity
@Table(name = "student_course")
@IdClass(StudentCourseId.class)  // æŒ‡å®šä½¿ç”¨å“ªä¸ªä¸»é”®ç±»
public class StudentCourse {
    
    @Id  // æ ‡è®°ä¸ºä¸»é”®å­—æ®µ
    @Column(name = "student_id")
    private Long studentId;
    
    @Id  // æ ‡è®°ä¸ºä¸»é”®å­—æ®µ
    @Column(name = "course_id")
    private Long courseId;
    
    @Column(name = "score")
    private Integer score;
    
    @Column(name = "enroll_date")
    private LocalDate enrollDate;
    
    // æ„é€ å™¨ã€getterå’Œsetterçœç•¥...
}
```

### 3.2 IdClassçš„ä½¿ç”¨ç¤ºä¾‹


**ä¿å­˜æ•°æ®ï¼š**

```java
// åˆ›å»ºå®ä½“å¯¹è±¡
StudentCourse sc = new StudentCourse();
sc.setStudentId(1001L);
sc.setCourseId(2001L);
sc.setScore(90);
sc.setEnrollDate(LocalDate.now());

// ç›´æ¥ä¿å­˜
entityManager.persist(sc);
```

**æ ¹æ®ä¸»é”®æŸ¥è¯¢ï¼š**

```java
// æ–¹å¼1ï¼šä½¿ç”¨ä¸»é”®ç±»å¯¹è±¡æŸ¥è¯¢
StudentCourseId id = new StudentCourseId(1001L, 2001L);
StudentCourse sc = entityManager.find(StudentCourse.class, id);

// æ–¹å¼2ï¼šä½¿ç”¨å•ä¸ªå­—æ®µæ¡ä»¶æŸ¥è¯¢
String jpql = "SELECT sc FROM StudentCourse sc " +
              "WHERE sc.studentId = :sid AND sc.courseId = :cid";
StudentCourse sc = entityManager.createQuery(jpql, StudentCourse.class)
    .setParameter("sid", 1001L)
    .setParameter("cid", 2001L)
    .getSingleResult();
```

### 3.3 IdClassçš„ä¼˜ç¼ºç‚¹åˆ†æ


**âœ… ä¼˜ç‚¹ï¼š**
```
â€¢ å­—æ®µç›´æ¥æš´éœ²åœ¨å®ä½“ç±»ï¼Œè®¿é—®æ–¹ä¾¿
â€¢ æŸ¥è¯¢æ—¶å¯ä»¥ç›´æ¥ä½¿ç”¨å­—æ®µå
â€¢ é€‚åˆå­—æ®µè¾ƒå°‘çš„ç®€å•åœºæ™¯
â€¢ ä»£ç ç›´è§‚ï¼Œæ–°æ‰‹å®¹æ˜“ç†è§£
```

**âŒ ç¼ºç‚¹ï¼š**
```
â€¢ å®ä½“ç±»å­—æ®µå˜å¤šï¼Œæœ‰é‡å¤æ„Ÿ
â€¢ ä¸»é”®ç±»å­—æ®µå¿…é¡»å’Œå®ä½“ç±»å®Œå…¨ä¸€è‡´
â€¢ ä¿®æ”¹å­—æ®µåéœ€è¦åŒæ­¥ä¿®æ”¹ä¸¤ä¸ªç±»
â€¢ ä¸»é”®é€»è¾‘æ— æ³•å¤ç”¨åˆ°å…¶ä»–å®ä½“
```

---

## 4. ğŸ¨ EmbeddedIdæ–¹å¼è¯¦è§£


### 4.1 EmbeddedIdçš„åŸºæœ¬ç»“æ„


**ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå¯åµŒå…¥çš„ä¸»é”®ç±»**

```java
@Embeddable  // æ ‡è®°ä¸ºå¯åµŒå…¥ç±»
public class StudentCourseId implements Serializable {
    
    @Column(name = "student_id")  // å¯ä»¥åœ¨è¿™é‡Œé…ç½®åˆ—ä¿¡æ¯
    private Long studentId;
    
    @Column(name = "course_id")
    private Long courseId;
    
    // æ— å‚æ„é€ å™¨
    public StudentCourseId() {}
    
    // æœ‰å‚æ„é€ å™¨
    public StudentCourseId(Long studentId, Long courseId) {
        this.studentId = studentId;
        this.courseId = courseId;
    }
    
    // equalså’ŒhashCodeæ–¹æ³•ï¼ˆä¸IdClassç›¸åŒï¼‰
    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        StudentCourseId that = (StudentCourseId) o;
        return Objects.equals(studentId, that.studentId) &&
               Objects.equals(courseId, that.courseId);
    }
    
    @Override
    public int hashCode() {
        return Objects.hash(studentId, courseId);
    }
    
    // getterå’Œsetterçœç•¥...
}
```

> ğŸ“ **@Embeddableçš„å«ä¹‰**ï¼š  
> è¿™ä¸ªæ³¨è§£å‘Šè¯‰JPAï¼š"è¿™ä¸ªç±»çš„å­—æ®µå¯ä»¥åµŒå…¥åˆ°å…¶ä»–å®ä½“ç±»ä¸­ä½¿ç”¨"ã€‚

**ç¬¬äºŒæ­¥ï¼šåˆ›å»ºå®ä½“ç±»**

```java
@Entity
@Table(name = "student_course")
public class StudentCourse {
    
    @EmbeddedId  // åµŒå…¥å¼ä¸»é”®
    private StudentCourseId id;  // ä¸»é”®æ˜¯ä¸€ä¸ªå¯¹è±¡
    
    @Column(name = "score")
    private Integer score;
    
    @Column(name = "enroll_date")
    private LocalDate enrollDate;
    
    // æ„é€ å™¨ã€getterå’Œsetterçœç•¥...
}
```

### 4.2 EmbeddedIdçš„ä½¿ç”¨ç¤ºä¾‹


**ä¿å­˜æ•°æ®ï¼š**

```java
// å…ˆåˆ›å»ºä¸»é”®å¯¹è±¡
StudentCourseId id = new StudentCourseId(1001L, 2001L);

// åˆ›å»ºå®ä½“å¯¹è±¡
StudentCourse sc = new StudentCourse();
sc.setId(id);  // è®¾ç½®ä¸»é”®å¯¹è±¡
sc.setScore(90);
sc.setEnrollDate(LocalDate.now());

// ä¿å­˜
entityManager.persist(sc);
```

**æ ¹æ®ä¸»é”®æŸ¥è¯¢ï¼š**

```java
// æ–¹å¼1ï¼šä½¿ç”¨ä¸»é”®å¯¹è±¡ç›´æ¥æŸ¥è¯¢
StudentCourseId id = new StudentCourseId(1001L, 2001L);
StudentCourse sc = entityManager.find(StudentCourse.class, id);

// æ–¹å¼2ï¼šé€šè¿‡ä¸»é”®å¯¹è±¡çš„å­—æ®µæŸ¥è¯¢
String jpql = "SELECT sc FROM StudentCourse sc " +
              "WHERE sc.id.studentId = :sid AND sc.id.courseId = :cid";
StudentCourse sc = entityManager.createQuery(jpql, StudentCourse.class)
    .setParameter("sid", 1001L)
    .setParameter("cid", 2001L)
    .getSingleResult();
```

### 4.3 è®¿é—®ä¸»é”®å­—æ®µçš„æ–¹å¼


```java
StudentCourse sc = entityManager.find(StudentCourse.class, id);

// è®¿é—®ä¸»é”®å­—æ®µï¼ˆéœ€è¦é€šè¿‡idå¯¹è±¡ï¼‰
Long studentId = sc.getId().getStudentId();
Long courseId = sc.getId().getCourseId();

// è®¿é—®æ™®é€šå­—æ®µ
Integer score = sc.getScore();
```

### 4.4 EmbeddedIdçš„ä¼˜ç¼ºç‚¹åˆ†æ


**âœ… ä¼˜ç‚¹ï¼š**
```
â€¢ å®ä½“ç±»æ›´ç®€æ´ï¼Œä¸»é”®å°è£…åœ¨å¯¹è±¡ä¸­
â€¢ ä¸»é”®ç±»å¯ä»¥åœ¨å¤šä¸ªå®ä½“ä¸­å¤ç”¨
â€¢ åˆ—ä¿¡æ¯å¯ä»¥é›†ä¸­åœ¨ä¸»é”®ç±»ä¸­é…ç½®
â€¢ é¢å‘å¯¹è±¡è®¾è®¡æ›´æ¸…æ™°
â€¢ é€‚åˆä¸»é”®å­—æ®µè¾ƒå¤šçš„åœºæ™¯
```

**âŒ ç¼ºç‚¹ï¼š**
```
â€¢ è®¿é—®ä¸»é”®å­—æ®µéœ€è¦å¤šä¸€å±‚è°ƒç”¨
â€¢ JPQLæŸ¥è¯¢æ—¶è·¯å¾„æ›´é•¿
â€¢ å¯¹æ–°æ‰‹æ¥è¯´ç†è§£æˆæœ¬ç¨é«˜
```

---

## 5. âš–ï¸ ä¸¤ç§æ–¹å¼çš„å¯¹æ¯”é€‰æ‹©


### 5.1 è¯¦ç»†å¯¹æ¯”è¡¨æ ¼


| å¯¹æ¯”ç»´åº¦ | @IdClass | @EmbeddedId | æ¨èåœºæ™¯ |
|---------|----------|-------------|---------|
| **ä»£ç ç»“æ„** | å­—æ®µç›´æ¥åœ¨å®ä½“ç±» | å­—æ®µå°è£…åœ¨ä¸»é”®ç±» | ç®€å•ç”¨IdClass |
| **å­—æ®µè®¿é—®** | `entity.getStudentId()` | `entity.getId().getStudentId()` | éœ€è¦é¢‘ç¹è®¿é—®ç”¨IdClass |
| **JPQLæŸ¥è¯¢** | `WHERE e.studentId = ?` | `WHERE e.id.studentId = ?` | æŸ¥è¯¢å¤šç”¨IdClass |
| **ä¸»é”®å¤ç”¨** | ä¸ä¾¿å¤ç”¨ | ä¾¿äºå¤ç”¨ | éœ€è¦å¤ç”¨ç”¨EmbeddedId |
| **å­—æ®µæ•°é‡** | 2-3ä¸ªå­—æ®µ | 3ä¸ªä»¥ä¸Šå­—æ®µ | å­—æ®µå¤šç”¨EmbeddedId |
| **åˆ—é…ç½®** | åœ¨å®ä½“ç±»é…ç½® | åœ¨ä¸»é”®ç±»é…ç½® | é…ç½®å¤æ‚ç”¨EmbeddedId |
| **æ–°æ‰‹å‹å¥½** | â­â­â­â­â­ | â­â­â­â­ | æ–°æ‰‹å»ºè®®IdClass |

### 5.2 é€‰æ‹©å†³ç­–æ ‘


```
å¼€å§‹é€‰æ‹©å¤åˆä¸»é”®å®ç°æ–¹å¼
    |
    â”œâ”€â†’ ä¸»é”®å­—æ®µæ•°é‡ <= 2 ä¸ªï¼Ÿ
    |        |
    |        â”œâ”€â†’ æ˜¯ â†’ ä½¿ç”¨ @IdClass
    |        â””â”€â†’ å¦ â†’ ç»§ç»­åˆ¤æ–­
    |
    â”œâ”€â†’ éœ€è¦åœ¨å¤šä¸ªå®ä½“ä¸­å¤ç”¨ä¸»é”®ï¼Ÿ
    |        |
    |        â”œâ”€â†’ æ˜¯ â†’ ä½¿ç”¨ @EmbeddedId
    |        â””â”€â†’ å¦ â†’ ç»§ç»­åˆ¤æ–­
    |
    â”œâ”€â†’ éœ€è¦é¢‘ç¹é€šè¿‡ä¸»é”®å­—æ®µæŸ¥è¯¢ï¼Ÿ
    |        |
    |        â”œâ”€â†’ æ˜¯ â†’ ä½¿ç”¨ @IdClass
    |        â””â”€â†’ å¦ â†’ ä½¿ç”¨ @EmbeddedId
    |
    â””â”€â†’ å€¾å‘é¢å‘å¯¹è±¡è®¾è®¡ï¼Ÿ
             |
             â”œâ”€â†’ æ˜¯ â†’ ä½¿ç”¨ @EmbeddedId
             â””â”€â†’ å¦ â†’ ä½¿ç”¨ @IdClass
```

### 5.3 å®é™…é¡¹ç›®å»ºè®®


**ğŸ¯ IdClassé€‚ç”¨åœºæ™¯ï¼š**
```
âœ… å­¦ç”Ÿé€‰è¯¾ç³»ç»Ÿï¼ˆstudentId + courseIdï¼‰
âœ… è®¢å•å•†å“æ˜ç»†ï¼ˆorderId + productIdï¼‰
âœ… ç”¨æˆ·è§’è‰²å…³è”ï¼ˆuserId + roleIdï¼‰
âœ… éƒ¨é—¨å‘˜å·¥å…³ç³»ï¼ˆdeptId + empIdï¼‰

ç‰¹ç‚¹ï¼šå…³è”å…³ç³»ç®€å•ï¼Œå­—æ®µå°‘ï¼ŒæŸ¥è¯¢é¢‘ç¹
```

**ğŸ¯ EmbeddedIdé€‚ç”¨åœºæ™¯ï¼š**
```
âœ… ç‰©æµè·Ÿè¸ªè®°å½•ï¼ˆè¿å•å· + ç«™ç‚¹ID + æ—¶é—´æˆ³ï¼‰
âœ… è€ƒè¯•æˆç»©è®°å½•ï¼ˆè€ƒè¯•ID + è€ƒç”ŸID + ç§‘ç›®IDï¼‰
âœ… å¤šç»´æ•°æ®ç»Ÿè®¡ï¼ˆå¹´ + æœˆ + åŒºåŸŸ + äº§å“ï¼‰
âœ… å¤æ‚ä¸šåŠ¡ä¸»é”®ï¼ˆéœ€è¦å¤ç”¨æˆ–å°è£…é€»è¾‘ï¼‰

ç‰¹ç‚¹ï¼šå­—æ®µå¤šï¼Œæœ‰å¤ç”¨éœ€æ±‚ï¼Œå°è£…æ€§è¦æ±‚é«˜
```

---

## 6. ğŸ” å¤åˆä¸»é”®çš„æŸ¥è¯¢æ“ä½œ


### 6.1 åŸºæœ¬æŸ¥è¯¢æ–¹æ³•


**é€šè¿‡ä¸»é”®å¯¹è±¡æŸ¥è¯¢ï¼š**

```java
// IdClassæ–¹å¼
StudentCourseId id = new StudentCourseId(1001L, 2001L);
StudentCourse sc = entityManager.find(StudentCourse.class, id);

// EmbeddedIdæ–¹å¼ï¼ˆå®Œå…¨ç›¸åŒï¼‰
StudentCourseId id = new StudentCourseId(1001L, 2001L);
StudentCourse sc = entityManager.find(StudentCourse.class, id);
```

### 6.2 JPQLæ¡ä»¶æŸ¥è¯¢


**IdClassæ–¹å¼çš„JPQLï¼š**

```java
// æŸ¥è¯¢æŸä¸ªå­¦ç”Ÿçš„æ‰€æœ‰é€‰è¯¾
String jpql = "SELECT sc FROM StudentCourse sc WHERE sc.studentId = :sid";
List<StudentCourse> courses = entityManager
    .createQuery(jpql, StudentCourse.class)
    .setParameter("sid", 1001L)
    .getResultList();

// æŸ¥è¯¢æŸé—¨è¯¾ç¨‹çš„æ‰€æœ‰å­¦ç”Ÿ
jpql = "SELECT sc FROM StudentCourse sc WHERE sc.courseId = :cid";
List<StudentCourse> students = entityManager
    .createQuery(jpql, StudentCourse.class)
    .setParameter("cid", 2001L)
    .getResultList();

// å¤šæ¡ä»¶ç»„åˆæŸ¥è¯¢
jpql = "SELECT sc FROM StudentCourse sc " +
       "WHERE sc.studentId = :sid AND sc.score >= :minScore";
List<StudentCourse> result = entityManager
    .createQuery(jpql, StudentCourse.class)
    .setParameter("sid", 1001L)
    .setParameter("minScore", 80)
    .getResultList();
```

**EmbeddedIdæ–¹å¼çš„JPQLï¼š**

```java
// æ³¨æ„ï¼šéœ€è¦é€šè¿‡ id. æ¥è®¿é—®ä¸»é”®å­—æ®µ
String jpql = "SELECT sc FROM StudentCourse sc WHERE sc.id.studentId = :sid";
List<StudentCourse> courses = entityManager
    .createQuery(jpql, StudentCourse.class)
    .setParameter("sid", 1001L)
    .getResultList();

// å¤šæ¡ä»¶æŸ¥è¯¢
jpql = "SELECT sc FROM StudentCourse sc " +
       "WHERE sc.id.studentId = :sid AND sc.id.courseId = :cid";
StudentCourse sc = entityManager
    .createQuery(jpql, StudentCourse.class)
    .setParameter("sid", 1001L)
    .setParameter("cid", 2001L)
    .getSingleResult();
```

### 6.3 Criteria APIæŸ¥è¯¢


**IdClassæ–¹å¼ï¼š**

```java
CriteriaBuilder cb = entityManager.getCriteriaBuilder();
CriteriaQuery<StudentCourse> cq = cb.createQuery(StudentCourse.class);
Root<StudentCourse> root = cq.from(StudentCourse.class);

// ç›´æ¥ä½¿ç”¨å­—æ®µå
cq.where(
    cb.equal(root.get("studentId"), 1001L),
    cb.equal(root.get("courseId"), 2001L)
);

StudentCourse result = entityManager.createQuery(cq).getSingleResult();
```

**EmbeddedIdæ–¹å¼ï¼š**

```java
CriteriaBuilder cb = entityManager.getCriteriaBuilder();
CriteriaQuery<StudentCourse> cq = cb.createQuery(StudentCourse.class);
Root<StudentCourse> root = cq.from(StudentCourse.class);

// éœ€è¦é€šè¿‡idè·¯å¾„è®¿é—®
cq.where(
    cb.equal(root.get("id").get("studentId"), 1001L),
    cb.equal(root.get("id").get("courseId"), 2001L)
);

StudentCourse result = entityManager.createQuery(cq).getSingleResult();
```

### 6.4 Spring Data JPAæŸ¥è¯¢æ–¹æ³•


**Repositoryæ¥å£å®šä¹‰ï¼š**

```java
// IdClassæ–¹å¼çš„Repository
public interface StudentCourseRepository 
    extends JpaRepository<StudentCourse, StudentCourseId> {
    
    // æ–¹æ³•åæŸ¥è¯¢ï¼ˆç›´æ¥ä½¿ç”¨å­—æ®µåï¼‰
    List<StudentCourse> findByStudentId(Long studentId);
    
    List<StudentCourse> findByCourseId(Long courseId);
    
    StudentCourse findByStudentIdAndCourseId(Long studentId, Long courseId);
    
    // @QueryæŸ¥è¯¢
    @Query("SELECT sc FROM StudentCourse sc WHERE sc.studentId = ?1")
    List<StudentCourse> findStudentCourses(Long studentId);
}

// EmbeddedIdæ–¹å¼çš„Repository
public interface StudentCourseRepository 
    extends JpaRepository<StudentCourse, StudentCourseId> {
    
    // æ–¹æ³•åæŸ¥è¯¢ï¼ˆé€šè¿‡id.å­—æ®µåï¼‰
    List<StudentCourse> findByIdStudentId(Long studentId);
    
    List<StudentCourse> findByIdCourseId(Long courseId);
    
    // @QueryæŸ¥è¯¢
    @Query("SELECT sc FROM StudentCourse sc WHERE sc.id.studentId = ?1")
    List<StudentCourse> findStudentCourses(Long studentId);
}
```

---

## 7. ğŸ’¼ å®æˆ˜æœ€ä½³å®è·µ


### 7.1 equalså’ŒhashCodeçš„æ­£ç¡®å®ç°


**ä¸ºä»€ä¹ˆå¿…é¡»æ­£ç¡®å®ç°è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Ÿ**

```
JPAä½¿ç”¨åœºæ™¯ï¼š
â€¢ å®ä½“å¯¹è±¡æ”¾å…¥Seté›†åˆæ—¶éœ€è¦hashCode
â€¢ åˆ¤æ–­ä¸¤ä¸ªå®ä½“æ˜¯å¦ç›¸åŒéœ€è¦equals
â€¢ ä¸€çº§ç¼“å­˜åˆ¤æ–­å®ä½“æ˜¯å¦å·²å­˜åœ¨éœ€è¦equals
â€¢ å»¶è¿ŸåŠ è½½çš„ä»£ç†å¯¹è±¡æ¯”è¾ƒéœ€è¦equals
```

**æ ‡å‡†å®ç°æ¨¡æ¿ï¼š**

```java
@Override
public boolean equals(Object o) {
    // 1. æ£€æŸ¥æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡
    if (this == o) return true;
    
    // 2. æ£€æŸ¥æ˜¯å¦ä¸ºnullå’Œç±»å‹æ˜¯å¦ç›¸åŒ
    if (o == null || getClass() != o.getClass()) return false;
    
    // 3. å¼ºåˆ¶ç±»å‹è½¬æ¢
    StudentCourseId that = (StudentCourseId) o;
    
    // 4. æ¯”è¾ƒæ‰€æœ‰ä¸»é”®å­—æ®µ
    return Objects.equals(studentId, that.studentId) &&
           Objects.equals(courseId, that.courseId);
}

@Override
public int hashCode() {
    // ä½¿ç”¨æ‰€æœ‰ä¸»é”®å­—æ®µè®¡ç®—hashå€¼
    return Objects.hash(studentId, courseId);
}
```

> âš ï¸ **å¸¸è§é”™è¯¯**ï¼š  
> å¿˜è®°å®ç°è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œæˆ–è€…åªå®ç°å…¶ä¸­ä¸€ä¸ªï¼Œä¼šå¯¼è‡´é›†åˆæ“ä½œå¼‚å¸¸ã€‚

### 7.2 ä¸»é”®å­—æ®µçš„é€‰æ‹©åŸåˆ™


**âœ… å¥½çš„ä¸»é”®å­—æ®µï¼š**
```
â€¢ ä¸šåŠ¡ä¸Šç¡®å®éœ€è¦è”åˆæ‰èƒ½å”¯ä¸€
â€¢ å­—æ®µå€¼ç¨³å®šï¼Œä¸ä¼šé¢‘ç¹ä¿®æ”¹
â€¢ å­—æ®µæœ‰ä¸šåŠ¡å«ä¹‰ï¼Œä¾¿äºç†è§£
â€¢ å­—æ®µæ•°é‡é€‚ä¸­ï¼ˆ2-4ä¸ªï¼‰
```

**âŒ é¿å…çš„ä¸»é”®å­—æ®µï¼š**
```
â€¢ å¯èƒ½ä¸ºnullçš„å­—æ®µ
â€¢ ä¼šè¢«ä¿®æ”¹çš„å­—æ®µ
â€¢ è¿‡é•¿çš„å­—ç¬¦ä¸²å­—æ®µ
â€¢ ä¸šåŠ¡å«ä¹‰ä¸æ˜ç¡®çš„å­—æ®µ
```

### 7.3 æ€§èƒ½ä¼˜åŒ–å»ºè®®


**ç´¢å¼•ä¼˜åŒ–ï¼š**

```java
@Entity
@Table(
    name = "student_course",
    indexes = {
        // ä¸ºå¤åˆä¸»é”®åˆ›å»ºç´¢å¼•ï¼ˆæ•°æ®åº“ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œä½†å¯ä»¥æ˜¾å¼å£°æ˜ï¼‰
        @Index(name = "idx_student_course", columnList = "student_id, course_id"),
        // ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µåˆ›å»ºç´¢å¼•
        @Index(name = "idx_student", columnList = "student_id")
    }
)
public class StudentCourse {
    // ...
}
```

**æŸ¥è¯¢ä¼˜åŒ–ï¼š**

```java
// âœ… å¥½çš„åšæ³•ï¼šä½¿ç”¨ä¸»é”®å¯¹è±¡ç›´æ¥æŸ¥è¯¢
StudentCourseId id = new StudentCourseId(1001L, 2001L);
StudentCourse sc = entityManager.find(StudentCourse.class, id);

// âŒ é¿å…çš„åšæ³•ï¼šæ¯æ¬¡éƒ½ç”¨JPQLæŸ¥è¯¢
String jpql = "SELECT sc FROM StudentCourse sc WHERE sc.studentId = ?1 AND sc.courseId = ?2";
// è¿™æ ·ä¼šè·³è¿‡ä¸€çº§ç¼“å­˜ï¼Œæ€§èƒ½è¾ƒå·®
```

### 7.4 å…³è”å…³ç³»å¤„ç†


**å¤åˆä¸»é”®å®ä½“çš„å…³è”ï¼š**

```java
@Entity
public class StudentCourse {
    
    @EmbeddedId
    private StudentCourseId id;
    
    // é€šè¿‡ä¸»é”®å­—æ®µå»ºç«‹å…³è”
    @ManyToOne
    @MapsId("studentId")  // æ˜ å°„åˆ°ä¸»é”®çš„studentIdå­—æ®µ
    @JoinColumn(name = "student_id")
    private Student student;
    
    @ManyToOne
    @MapsId("courseId")  // æ˜ å°„åˆ°ä¸»é”®çš„courseIdå­—æ®µ
    @JoinColumn(name = "course_id")
    private Course course;
    
    private Integer score;
}
```

> ğŸ’¡ **@MapsIdçš„ä½œç”¨**ï¼š  
> å‘Šè¯‰JPAï¼š"è¿™ä¸ªå…³è”å…³ç³»çš„å¤–é”®ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸»é”®çš„ä¸€éƒ¨åˆ†"ã€‚

### 7.5 å¸¸è§é™·é˜±ä¸è§£å†³æ–¹æ¡ˆ


**é™·é˜±1ï¼šä¸»é”®å­—æ®µå‘½åä¸ä¸€è‡´**

```java
// âŒ é”™è¯¯ç¤ºä¾‹
@IdClass(StudentCourseId.class)
public class StudentCourse {
    @Id
    private Long stuId;  // å­—æ®µåä¸ä¸»é”®ç±»ä¸ä¸€è‡´ï¼
    
    @Id
    private Long courseId;
}

public class StudentCourseId {
    private Long studentId;  // ä¸å®ä½“ç±»å­—æ®µåä¸åŒ¹é…
    private Long courseId;
}

// âœ… æ­£ç¡®ç¤ºä¾‹ï¼šå­—æ®µåå®Œå…¨ä¸€è‡´
```

**é™·é˜±2ï¼šå¿˜è®°å®ç°Serializable**

```java
// âŒ é”™è¯¯
public class StudentCourseId {
    // ç¼ºå°‘ implements Serializable
}

// âœ… æ­£ç¡®
public class StudentCourseId implements Serializable {
    private static final long serialVersionUID = 1L;
    // ...
}
```

**é™·é˜±3ï¼šä¸»é”®å­—æ®µä¸ºnull**

```java
// âŒ é”™è¯¯ï¼šä¿å­˜æ—¶ä¸»é”®å­—æ®µä¸ºnull
StudentCourse sc = new StudentCourse();
sc.setScore(90);  // å¿˜è®°è®¾ç½®ä¸»é”®å­—æ®µ
entityManager.persist(sc);  // ä¼šæŠ¥é”™ï¼

// âœ… æ­£ç¡®ï¼šç¡®ä¿ä¸»é”®å­—æ®µæœ‰å€¼
StudentCourseId id = new StudentCourseId(1001L, 2001L);
StudentCourse sc = new StudentCourse();
sc.setId(id);
sc.setScore(90);
entityManager.persist(sc);
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å¤åˆä¸»é”®ï¼šç”±å¤šä¸ªå­—æ®µç»„åˆè€Œæˆçš„ä¸»é”®ï¼Œç”¨äºå”¯ä¸€æ ‡è¯†è®°å½•
ğŸ”¸ @IdClassï¼šä¸»é”®å­—æ®µç›´æ¥åœ¨å®ä½“ç±»ä¸­ï¼Œé€‚åˆç®€å•åœºæ™¯
ğŸ”¸ @EmbeddedIdï¼šä¸»é”®å­—æ®µå°è£…åœ¨å¯¹è±¡ä¸­ï¼Œé€‚åˆå¤æ‚åœºæ™¯
ğŸ”¸ equals/hashCodeï¼šä¸»é”®ç±»å¿…é¡»æ­£ç¡®å®ç°è¿™ä¸¤ä¸ªæ–¹æ³•
ğŸ”¸ Serializableï¼šä¸»é”®ç±»å¿…é¡»å®ç°åºåˆ—åŒ–æ¥å£
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ é€‰æ‹©å¤åˆä¸»é”®çš„æ—¶æœº**
```
åˆ¤æ–­æ ‡å‡†ï¼š
â€¢ å•ä¸ªå­—æ®µæ— æ³•å”¯ä¸€æ ‡è¯†è®°å½•
â€¢ è¡¨ç¤ºå®ä½“é—´çš„å¤šå¯¹å¤šå…³ç³»
â€¢ ä¸šåŠ¡ä¸Šç¡®å®éœ€è¦è”åˆä¸»é”®

æ›¿ä»£æ–¹æ¡ˆï¼š
â€¢ å¯ä»¥è€ƒè™‘ä½¿ç”¨ä»£ç†ä¸»é”®ï¼ˆè‡ªå¢IDï¼‰+ å”¯ä¸€ç´¢å¼•
â€¢ ç®€åŒ–è®¾è®¡ï¼Œé™ä½å¤æ‚åº¦
```

**ğŸ”¹ IdClass vs EmbeddedIdçš„é€‰æ‹©**
```
IdClassä¼˜å…ˆåœºæ™¯ï¼š
â€¢ ä¸»é”®å­—æ®µ <= 3ä¸ª
â€¢ éœ€è¦é¢‘ç¹å•ç‹¬è®¿é—®ä¸»é”®å­—æ®µ
â€¢ å›¢é˜Ÿæˆå‘˜æ˜¯JPAæ–°æ‰‹

EmbeddedIdä¼˜å…ˆåœºæ™¯ï¼š
â€¢ ä¸»é”®å­—æ®µ > 3ä¸ª
â€¢ ä¸»é”®é€»è¾‘éœ€è¦åœ¨å¤šå¤„å¤ç”¨
â€¢ è¿½æ±‚æ›´å¥½çš„é¢å‘å¯¹è±¡è®¾è®¡
```

**ğŸ”¹ equalså’ŒhashCodeçš„é‡è¦æ€§**
```
ä½œç”¨èŒƒå›´ï¼š
â€¢ JPAä¸€çº§ç¼“å­˜çš„å®ä½“åˆ¤æ–­
â€¢ å®ä½“æ”¾å…¥Setã€Mapç­‰é›†åˆ
â€¢ å»¶è¿ŸåŠ è½½ä»£ç†å¯¹è±¡çš„æ¯”è¾ƒ

å®ç°åŸåˆ™ï¼š
â€¢ å¿…é¡»åŒæ—¶å®ç°ä¸¤ä¸ªæ–¹æ³•
â€¢ åªæ¯”è¾ƒä¸»é”®å­—æ®µ
â€¢ ä½¿ç”¨Objectså·¥å…·ç±»ç®€åŒ–ä»£ç 
```

### 8.3 å®é™…åº”ç”¨å»ºè®®


**è®¾è®¡å»ºè®®**ï¼š
```
âœ… ä¼˜å…ˆè€ƒè™‘å•ä¸€ä¸»é”® + å”¯ä¸€ç´¢å¼•
âœ… ç¡®å®éœ€è¦å¤åˆä¸»é”®æ—¶æ‰ä½¿ç”¨
âœ… é€‰æ‹©åˆé€‚çš„å®ç°æ–¹å¼ï¼ˆIdClassæˆ–EmbeddedIdï¼‰
âœ… ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µå»ºç«‹ç´¢å¼•
âœ… æ–‡æ¡£ä¸­è¯´æ˜ä¸»é”®è®¾è®¡çš„ä¸šåŠ¡å«ä¹‰
```

**ä»£ç è§„èŒƒ**ï¼š
```
âœ… ä¸»é”®ç±»å¿…é¡»å®ç°Serializable
âœ… ä¸»é”®ç±»å¿…é¡»æœ‰æ— å‚æ„é€ å™¨
âœ… ä¸»é”®ç±»å¿…é¡»æ­£ç¡®å®ç°equalså’ŒhashCode
âœ… å­—æ®µå‘½åè¦ä¸å®ä½“ç±»ä¿æŒä¸€è‡´ï¼ˆIdClassï¼‰
âœ… ä¸»é”®å­—æ®µä½¿ç”¨ä¸å¯å˜ç±»å‹ï¼ˆLongã€Stringç­‰ï¼‰
```

**æ€§èƒ½è€ƒè™‘**ï¼š
```
â€¢ å¤åˆä¸»é”®ç´¢å¼•è‡ªåŠ¨åˆ›å»ºï¼Œä½†è¦éªŒè¯
â€¢ ä¼˜å…ˆä½¿ç”¨ä¸»é”®å¯¹è±¡æŸ¥è¯¢ï¼Œåˆ©ç”¨ä¸€çº§ç¼“å­˜
â€¢ é¿å…åœ¨ä¸»é”®ä¸­ä½¿ç”¨è¿‡é•¿çš„å­—ç¬¦ä¸²
â€¢ ä¸»é”®å­—æ®µæ•°é‡æ§åˆ¶åœ¨2-4ä¸ªä¸ºå®œ
```

### 8.4 å­¦ä¹ è·¯çº¿å»ºè®®


```
ç¬¬ä¸€é˜¶æ®µï¼šç†è§£æ¦‚å¿µ
â””â”€â†’ ä»€ä¹ˆæ˜¯å¤åˆä¸»é”®ï¼Œä¸ºä»€ä¹ˆéœ€è¦

ç¬¬äºŒé˜¶æ®µï¼šæŒæ¡åŸºç¡€
â””â”€â†’ IdClassåŸºæœ¬ç”¨æ³•
â””â”€â†’ EmbeddedIdåŸºæœ¬ç”¨æ³•

ç¬¬ä¸‰é˜¶æ®µï¼šæ·±å…¥åº”ç”¨
â””â”€â†’ æŸ¥è¯¢æ“ä½œï¼ˆJPQLã€Criteriaï¼‰
â””â”€â†’ å…³è”å…³ç³»å¤„ç†

ç¬¬å››é˜¶æ®µï¼šæœ€ä½³å®è·µ
â””â”€â†’ equals/hashCodeå®ç°
â””â”€â†’ æ€§èƒ½ä¼˜åŒ–æŠ€å·§
â””â”€â†’ å¸¸è§é™·é˜±è§„é¿
```

### 8.5 å¿«é€Ÿè®°å¿†å£è¯€


```
å¤åˆä¸»é”®ä¸¤ç§é€‰ï¼ŒIdClasså’ŒEmbedded
å­—æ®µå°‘æ—¶ç”¨IdClassï¼Œè®¿é—®æ–¹ä¾¿æŸ¥è¯¢å¿«
å­—æ®µå¤šæ—¶Embeddedï¼Œå°è£…å¤ç”¨æ›´ä¼˜é›…
equalså’Œhashåˆ«å¿˜è®°ï¼Œåºåˆ—åŒ–æ¥å£è¦å®ç°
ä¸»é”®ç¨³å®šä¸å¯å˜ï¼Œä¸šåŠ¡å«ä¹‰è¦æ˜ç¡®
```

---

> ğŸ“š **å»¶ä¼¸å­¦ä¹ **ï¼š
> - ä¸‹ä¸€ç« ï¼šå…³è”å…³ç³»æ˜ å°„ï¼ˆä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹å¤šï¼‰
> - ç›¸å…³ä¸»é¢˜ï¼šä¸»é”®ç”Ÿæˆç­–ç•¥ã€è‡ªç„¶ä¸»é”® vs ä»£ç†ä¸»é”®
> - è¿›é˜¶å†…å®¹ï¼šå¤åˆä¸»é”®åœ¨ç»§æ‰¿æ˜ å°„ä¸­çš„ä½¿ç”¨