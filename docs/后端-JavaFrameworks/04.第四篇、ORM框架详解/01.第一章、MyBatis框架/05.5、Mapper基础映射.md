---
title: 5ã€MapperåŸºç¡€æ˜ å°„
---
## ğŸ“š ç›®å½•

1. [Mapperæ˜ å°„å™¨æ˜¯ä»€ä¹ˆ](#1-Mapperæ˜ å°„å™¨æ˜¯ä»€ä¹ˆ)
2. [XMLæ˜ å°„æ–‡ä»¶ç»“æ„](#2-XMLæ˜ å°„æ–‡ä»¶ç»“æ„)
3. [å‘½åç©ºé—´namespace](#3-å‘½åç©ºé—´namespace)
4. [å››å¤§åŸºæœ¬æ“ä½œè¯­å¥](#4-å››å¤§åŸºæœ¬æ“ä½œè¯­å¥)
5. [å‚æ•°ä¼ é€’ä¸ç±»å‹](#5-å‚æ•°ä¼ é€’ä¸ç±»å‹)
6. [è¿”å›å€¼å¤„ç†](#6-è¿”å›å€¼å¤„ç†)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ Mapperæ˜ å°„å™¨æ˜¯ä»€ä¹ˆ


### 1.1 ä¸ºä»€ä¹ˆéœ€è¦Mapper


**ä¼ ç»ŸJDBCå¼€å‘çš„ç—›ç‚¹**ï¼š
```
ä¼ ç»Ÿæ–¹å¼å†™SQLä»£ç ï¼š
1. æ‰‹åŠ¨æ‹¼æ¥SQLå­—ç¬¦ä¸² â†’ å®¹æ˜“å‡ºé”™
2. å‚æ•°éœ€è¦æ‰‹åŠ¨è®¾ç½® â†’ ä»£ç ç¹ç
3. ç»“æœé›†éœ€è¦æ‰‹åŠ¨å°è£… â†’ é‡å¤åŠ³åŠ¨
4. SQLå’ŒJavaä»£ç æ··åœ¨ä¸€èµ· â†’ éš¾ä»¥ç»´æŠ¤
```

**Mapperæ˜ å°„å™¨çš„ä½œç”¨**ï¼š
> **ğŸ’¡ æ ¸å¿ƒç†è§£**ï¼šMapperå°±åƒæ˜¯ä¸€ä¸ª"ç¿»è¯‘å®˜"ï¼Œå®ƒå¸®ä½ æŠŠJavaæ–¹æ³•è°ƒç”¨ç¿»è¯‘æˆSQLè¯­å¥ï¼Œå†æŠŠæ•°æ®åº“è¿”å›çš„ç»“æœç¿»è¯‘æˆJavaå¯¹è±¡ã€‚

```
ä½ è°ƒç”¨Javaæ–¹æ³•             Mapperç¿»è¯‘              æ‰§è¡ŒSQLæŸ¥è¯¢
   â†“                         â†“                        â†“
userMapper.getUserById(1) â†’ SELECT * FROM user    â†’ è¿”å›Userå¯¹è±¡
                             WHERE id = 1
```

### 1.2 Mapperçš„ä¸¤ç§å½¢å¼


**ğŸ”¸ XMLæ˜ å°„æ–‡ä»¶**ï¼ˆæœ¬ç« é‡ç‚¹ï¼‰
```
ä¼˜ç‚¹ï¼šSQLå’ŒJavaä»£ç åˆ†ç¦»ï¼Œå¤æ‚SQLæ›´æ¸…æ™°
é€‚ç”¨ï¼šå¤æ‚æŸ¥è¯¢ã€åŠ¨æ€SQLã€å›¢é˜Ÿåä½œ
```

**ğŸ”¸ æ³¨è§£æ–¹å¼**
```
ä¼˜ç‚¹ï¼šç®€æ´ï¼Œé€‚åˆç®€å•SQL
é€‚ç”¨ï¼šç®€å•CRUDæ“ä½œ
```

> **ğŸ“ æ–°æ‰‹å»ºè®®**ï¼šå…ˆå­¦XMLæ–¹å¼ï¼Œå› ä¸ºå®ƒèƒ½è®©ä½ æ¸…æ¥šçœ‹åˆ°SQLæ˜¯æ€ä¹ˆå†™çš„ï¼Œç†è§£äº†åŸç†åå†å­¦æ³¨è§£ä¼šå¾ˆå®¹æ˜“ã€‚

---

## 2. ğŸ“„ XMLæ˜ å°„æ–‡ä»¶ç»“æ„


### 2.1 åŸºæœ¬æ–‡ä»¶ç»“æ„


**å®Œæ•´çš„Mapper XMLæ–‡ä»¶é•¿è¿™æ ·**ï¼š

```xml
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.mapper.UserMapper">
  
  <!-- è¿™é‡Œå†™å„ç§SQLè¯­å¥ -->
  <select id="getUserById" resultType="User">
    SELECT * FROM user WHERE id = #{id}
  </select>
  
</mapper>
```

**ğŸ”¸ æ–‡ä»¶ç»“æ„è§£æ**ï¼š

```
æ–‡ä»¶ç»„æˆï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ XMLå£°æ˜ï¼ˆå›ºå®šæ ¼å¼ï¼‰           â”‚ â† å‘Šè¯‰ç³»ç»Ÿè¿™æ˜¯XMLæ–‡ä»¶
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DOCTYPEå£°æ˜ï¼ˆå›ºå®šæ ¼å¼ï¼‰       â”‚ â† å®šä¹‰æ–‡ä»¶è§„èŒƒ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ <mapper>æ ¹æ ‡ç­¾               â”‚ â† æ•´ä¸ªæ˜ å°„æ–‡ä»¶çš„å®¹å™¨
â”‚  â”œâ”€ namespaceå±æ€§            â”‚ â† æŒ‡å®šå¯¹åº”çš„Mapperæ¥å£
â”‚  â”œâ”€ <select>æŸ¥è¯¢è¯­å¥         â”‚ â† å„ç§SQLæ“ä½œ
â”‚  â”œâ”€ <insert>æ’å…¥è¯­å¥         â”‚
â”‚  â”œâ”€ <update>æ›´æ–°è¯­å¥         â”‚
â”‚  â””â”€ <delete>åˆ é™¤è¯­å¥         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æ–‡ä»¶ä½ç½®è§„èŒƒ


**ğŸ“ æ ‡å‡†ç›®å½•ç»“æ„**ï¼š
```
src/main/resources/
  â””â”€â”€ mapper/              â† Mapper XMLæ–‡ä»¶å¤¹
      â”œâ”€â”€ UserMapper.xml   â† ç”¨æˆ·ç›¸å…³SQL
      â”œâ”€â”€ OrderMapper.xml  â† è®¢å•ç›¸å…³SQL
      â””â”€â”€ ProductMapper.xml â† å•†å“ç›¸å…³SQL

src/main/java/
  â””â”€â”€ com/example/mapper/  â† Mapperæ¥å£æ–‡ä»¶å¤¹
      â”œâ”€â”€ UserMapper.java
      â”œâ”€â”€ OrderMapper.java
      â””â”€â”€ ProductMapper.java
```

> **âš ï¸ é‡è¦æé†’**ï¼šXMLæ–‡ä»¶åå»ºè®®å’Œæ¥å£åä¿æŒä¸€è‡´ï¼Œæ¯”å¦‚`UserMapper.java`å¯¹åº”`UserMapper.xml`ï¼Œè¿™æ ·æ›´å®¹æ˜“ç®¡ç†ã€‚

---

## 3. ğŸ”— å‘½åç©ºé—´namespace


### 3.1 namespaceæ˜¯ä»€ä¹ˆ


**ğŸ¯ é€šä¿—ç†è§£**ï¼š
- namespaceå°±åƒæ˜¯**é—¨ç‰Œå·**ï¼Œå‘Šè¯‰MyBatisè¿™ä¸ªXMLæ–‡ä»¶æ˜¯ç»™å“ªä¸ªæ¥å£ç”¨çš„
- å®ƒæŠŠXMLæ–‡ä»¶å’ŒJavaæ¥å£**ç»‘å®š**åœ¨ä¸€èµ·

```xml
<!-- XMLæ–‡ä»¶ä¸­ -->
<mapper namespace="com.example.mapper.UserMapper">
  <select id="getUserById" resultType="User">
    SELECT * FROM user WHERE id = #{id}
  </select>
</mapper>
```

```java
// Javaæ¥å£ä¸­
package com.example.mapper;

public interface UserMapper {
    User getUserById(Integer id);  // æ–¹æ³•åå¯¹åº”XMLä¸­çš„id
}
```

**ç»‘å®šå…³ç³»å›¾**ï¼š
```
Javaæ¥å£                    XMLæ˜ å°„æ–‡ä»¶
â”€â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
com.example.mapper          namespace="com.example.mapper.UserMapper"
    .UserMapper    â†â”€â”€â”€â”€ç»‘å®šâ”€â”€â”€â”€â†’    â†“
        â†“                          <select id="getUserById">
    getUserById()  â†â”€â”€â”€â”€å¯¹åº”â”€â”€â”€â”€â†’      SQLè¯­å¥
```

### 3.2 namespaceçš„ä½œç”¨


**ğŸ”¸ ä½œç”¨ä¸€ï¼šå”¯ä¸€æ ‡è¯†**
```
å…¨å±€å”¯ä¸€å®šä½SQLè¯­å¥ï¼š
com.example.mapper.UserMapper.getUserById
     â†“                â†“             â†“
   åŒ…å            æ¥å£å         æ–¹æ³•å
```

**ğŸ”¸ ä½œç”¨äºŒï¼šæ¥å£ç»‘å®š**
```
æœ‰äº†namespaceï¼ŒMyBatisæ‰çŸ¥é“ï¼š
- è°ƒç”¨getUserById()æ–¹æ³•æ—¶
- è¦å»æ‰§è¡Œå“ªä¸ªXMLæ–‡ä»¶é‡Œçš„
- å“ªä¸€æ¡SQLè¯­å¥
```

> **ğŸ’¡ è®°å¿†æŠ€å·§**ï¼šæŠŠnamespaceæƒ³è±¡æˆ"å¿«é€’åœ°å€"ï¼ŒMyBatisæ ¹æ®è¿™ä¸ªåœ°å€æ‰¾åˆ°å¯¹åº”çš„SQLè¯­å¥å¹¶æ‰§è¡Œã€‚

---

## 4. âš™ï¸ å››å¤§åŸºæœ¬æ“ä½œè¯­å¥


### 4.1 SELECTæŸ¥è¯¢è¯­å¥


**ğŸ”¸ åŸºæœ¬ç”¨æ³•**ï¼š

```xml
<select id="getUserById" parameterType="int" resultType="User">
  SELECT id, username, email FROM user WHERE id = #{id}
</select>
```

**å±æ€§è¯´æ˜**ï¼š

| å±æ€§ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `id` | âœ… | æ–¹æ³•åï¼Œå¿…é¡»å’Œæ¥å£æ–¹æ³•ä¸€è‡´ | `getUserById` |
| `parameterType` | âŒ | å‚æ•°ç±»å‹ï¼Œå¯çœç•¥ï¼ˆè‡ªåŠ¨æ¨æ–­ï¼‰ | `int` / `User` |
| `resultType` | âœ… | è¿”å›å€¼ç±»å‹ | `User` / `java.lang.String` |

**ğŸ¯ å®é™…åº”ç”¨ç¤ºä¾‹**ï¼š

```xml
<!-- 1. æŸ¥è¯¢å•ä¸ªç”¨æˆ· -->
<select id="getUserById" resultType="User">
  SELECT * FROM user WHERE id = #{id}
</select>

<!-- 2. æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ· -->
<select id="getAllUsers" resultType="User">
  SELECT * FROM user
</select>

<!-- 3. æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ -->
<select id="getUserByName" resultType="User">
  SELECT * FROM user WHERE username = #{username}
</select>
```

### 4.2 INSERTæ’å…¥è¯­å¥


**ğŸ”¸ åŸºæœ¬ç”¨æ³•**ï¼š

```xml
<insert id="insertUser" parameterType="User">
  INSERT INTO user (username, email, age) 
  VALUES (#{username}, #{email}, #{age})
</insert>
```

**ğŸ¯ è·å–è‡ªå¢ä¸»é”®**ï¼š

```xml
<!-- useGeneratedKeysï¼šä½¿ç”¨æ•°æ®åº“è‡ªå¢ä¸»é”® -->
<!-- keyPropertyï¼šæŠŠä¸»é”®å€¼è®¾ç½®åˆ°Userå¯¹è±¡çš„idå±æ€§ -->
<insert id="insertUser" parameterType="User" 
        useGeneratedKeys="true" keyProperty="id">
  INSERT INTO user (username, email, age) 
  VALUES (#{username}, #{email}, #{age})
</insert>
```

**æ•ˆæœæ¼”ç¤º**ï¼š
```java
User user = new User();
user.setUsername("å¼ ä¸‰");
user.setEmail("zhangsan@qq.com");
user.setAge(25);

userMapper.insertUser(user);  // æ’å…¥å
System.out.println(user.getId());  // è‡ªåŠ¨è·å¾—äº†æ•°æ®åº“ç”Ÿæˆçš„IDï¼Œæ¯”å¦‚ï¼š1001
```

> **ğŸ’¡ æ–°æ‰‹æç¤º**ï¼š`useGeneratedKeys="true"`å¾ˆé‡è¦ï¼åŠ ä¸Šå®ƒåï¼Œæ’å…¥æ•°æ®æ—¶MyBatisä¼šè‡ªåŠ¨æŠŠæ•°æ®åº“ç”Ÿæˆçš„IDå¡«å›åˆ°å¯¹è±¡é‡Œã€‚

### 4.3 UPDATEæ›´æ–°è¯­å¥


**ğŸ”¸ åŸºæœ¬ç”¨æ³•**ï¼š

```xml
<update id="updateUser" parameterType="User">
  UPDATE user 
  SET username = #{username}, 
      email = #{email}, 
      age = #{age}
  WHERE id = #{id}
</update>
```

**ğŸ¯ å®é™…åº”ç”¨ç¤ºä¾‹**ï¼š

```xml
<!-- 1. æ›´æ–°æ•´ä¸ªç”¨æˆ·ä¿¡æ¯ -->
<update id="updateUser" parameterType="User">
  UPDATE user 
  SET username = #{username}, email = #{email}, age = #{age}
  WHERE id = #{id}
</update>

<!-- 2. åªæ›´æ–°ç”¨æˆ·å -->
<update id="updateUsername">
  UPDATE user SET username = #{username} WHERE id = #{id}
</update>

<!-- 3. æ‰¹é‡æ›´æ–°å¹´é¾„ -->
<update id="updateAgeByRange">
  UPDATE user SET age = age + 1 
  WHERE age BETWEEN #{minAge} AND #{maxAge}
</update>
```

### 4.4 DELETEåˆ é™¤è¯­å¥


**ğŸ”¸ åŸºæœ¬ç”¨æ³•**ï¼š

```xml
<delete id="deleteUser" parameterType="int">
  DELETE FROM user WHERE id = #{id}
</delete>
```

**ğŸ¯ å®é™…åº”ç”¨ç¤ºä¾‹**ï¼š

```xml
<!-- 1. æ ¹æ®IDåˆ é™¤ -->
<delete id="deleteUserById">
  DELETE FROM user WHERE id = #{id}
</delete>

<!-- 2. æ ¹æ®ç”¨æˆ·ååˆ é™¤ -->
<delete id="deleteUserByName">
  DELETE FROM user WHERE username = #{username}
</delete>

<!-- 3. åˆ é™¤æ‰€æœ‰ï¼ˆå±é™©æ“ä½œï¼‰ -->
<delete id="deleteAllUsers">
  DELETE FROM user
</delete>
```

**ğŸ“‹ å››å¤§æ“ä½œå¯¹æ¯”è¡¨**ï¼š

| æ“ä½œ | æ ‡ç­¾ | å¿…å¤‡å±æ€§ | è¿”å›å€¼ | å¸¸ç”¨åœºæ™¯ |
|------|------|----------|--------|----------|
| **æŸ¥è¯¢** | `<select>` | `id`ã€`resultType` | å¯¹è±¡/é›†åˆ | è·å–æ•°æ® |
| **æ’å…¥** | `<insert>` | `id` | å½±å“è¡Œæ•° | æ–°å¢æ•°æ® |
| **æ›´æ–°** | `<update>` | `id` | å½±å“è¡Œæ•° | ä¿®æ”¹æ•°æ® |
| **åˆ é™¤** | `<delete>` | `id` | å½±å“è¡Œæ•° | åˆ é™¤æ•°æ® |

---

## 5. ğŸ“¥ å‚æ•°ä¼ é€’ä¸ç±»å‹


### 5.1 å•ä¸ªåŸºæœ¬å‚æ•°


**ğŸ”¸ åœºæ™¯**ï¼šæ–¹æ³•åªæœ‰ä¸€ä¸ªç®€å•å‚æ•°

```java
// Javaæ¥å£
User getUserById(Integer id);
String getUsernameById(int id);
```

```xml
<!-- XMLæ˜ å°„ï¼šå‚æ•°ç”¨ #{ä»»æ„åç§°} æ¥æ”¶ -->
<select id="getUserById" resultType="User">
  SELECT * FROM user WHERE id = #{id}
  <!-- #{id}ã€#{value}ã€#{abc} éƒ½å¯ä»¥ï¼Œä½†å»ºè®®ç”¨æœ‰æ„ä¹‰çš„åå­— -->
</select>
```

> **ğŸ’¡ æ–°æ‰‹æç¤º**ï¼šå•ä¸ªåŸºæœ¬å‚æ•°æ—¶ï¼Œ`#{}`é‡Œå†™ä»€ä¹ˆåå­—éƒ½è¡Œï¼Œä½†ä¸ºäº†ä»£ç å¯è¯»æ€§ï¼Œå»ºè®®å†™æˆå’Œå‚æ•°åä¸€è‡´ã€‚

### 5.2 å¤šä¸ªåŸºæœ¬å‚æ•°


**ğŸ”¸ åœºæ™¯**ï¼šæ–¹æ³•æœ‰å¤šä¸ªç®€å•å‚æ•°

```java
// Javaæ¥å£
User login(String username, String password);
```

**æ–¹å¼ä¸€ï¼šä½¿ç”¨@Paramæ³¨è§£**ï¼ˆæ¨èï¼‰
```java
User login(@Param("username") String username, 
           @Param("password") String password);
```

```xml
<select id="login" resultType="User">
  SELECT * FROM user 
  WHERE username = #{username} AND password = #{password}
</select>
```

**æ–¹å¼äºŒï¼šä½¿ç”¨é»˜è®¤åç§°**ï¼ˆä¸æ¨èï¼‰
```xml
<!-- MyBatisé»˜è®¤å‚æ•°åï¼šparam1, param2, param3... -->
<select id="login" resultType="User">
  SELECT * FROM user 
  WHERE username = #{param1} AND password = #{param2}
</select>
```

> **âš ï¸ é‡è¦**ï¼šå¤šä¸ªå‚æ•°æ—¶å¼ºçƒˆå»ºè®®ä½¿ç”¨`@Param`æ³¨è§£ï¼Œè¿™æ ·XMLä¸­çš„å‚æ•°åæ›´æ¸…æ™°æ˜“æ‡‚ã€‚

### 5.3 å¯¹è±¡å‚æ•°


**ğŸ”¸ åœºæ™¯**ï¼šå‚æ•°æ˜¯ä¸€ä¸ªJavaå¯¹è±¡

```java
// Javaæ¥å£
int insertUser(User user);
int updateUser(User user);
```

```xml
<!-- #{å±æ€§å} ç›´æ¥å–å¯¹è±¡çš„å±æ€§å€¼ -->
<insert id="insertUser" parameterType="User">
  INSERT INTO user (username, email, age) 
  VALUES (#{username}, #{email}, #{age})
</insert>

<update id="updateUser">
  UPDATE user 
  SET username = #{username}, email = #{email}
  WHERE id = #{id}
</update>
```

**å‚æ•°å–å€¼è§„åˆ™**ï¼š
```
Userå¯¹è±¡ç»“æ„ï¼š           XMLä¸­å–å€¼ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         
â”‚ User        â”‚         #{id}       â†’ è°ƒç”¨user.getId()
â”‚  - id       â”‚  â†â”€â”€â”€   #{username} â†’ è°ƒç”¨user.getUsername()
â”‚  - username â”‚  â†â”€â”€â”€   #{email}    â†’ è°ƒç”¨user.getEmail()
â”‚  - email    â”‚  â†â”€â”€â”€   #{age}      â†’ è°ƒç”¨user.getAge()
â”‚  - age      â”‚         
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         
```

> **ğŸ’¡ è®°å¿†æŠ€å·§**ï¼šå¯¹è±¡å‚æ•°æ—¶ï¼Œ`#{å±æ€§å}`å®é™…ä¸Šæ˜¯è°ƒç”¨å¯¹è±¡çš„`getæ–¹æ³•`æ¥è·å–å€¼ã€‚

### 5.4 Mapå‚æ•°


**ğŸ”¸ åœºæ™¯**ï¼šå‚æ•°ä¸å›ºå®šï¼Œä½¿ç”¨Mapä¼ é€’

```java
// Javaæ¥å£
List<User> searchUsers(Map<String, Object> params);
```

```xml
<!-- #{keyå} ä»Mapä¸­å–å€¼ -->
<select id="searchUsers" resultType="User">
  SELECT * FROM user 
  WHERE age > #{minAge} 
    AND email LIKE #{emailPattern}
</select>
```

```java
// ä½¿ç”¨ç¤ºä¾‹
Map<String, Object> params = new HashMap<>();
params.put("minAge", 18);
params.put("emailPattern", "%@qq.com%");
List<User> users = userMapper.searchUsers(params);
```

**ğŸ“Š å‚æ•°ä¼ é€’æ–¹å¼å¯¹æ¯”**ï¼š

| æ–¹å¼ | ä½¿ç”¨åœºæ™¯ | ä¼˜ç‚¹ | ç¼ºç‚¹ | æ¨èåº¦ |
|------|----------|------|------|--------|
| **å•ä¸ªåŸºæœ¬å‚æ•°** | åªæœ‰1ä¸ªå‚æ•° | ç®€å•ç›´æ¥ | åªèƒ½ä¼ 1ä¸ªå€¼ | â­â­â­â­â­ |
| **@Paramæ³¨è§£** | å¤šä¸ªåŸºæœ¬å‚æ•° | å‚æ•°åæ¸…æ™° | éœ€è¦å†™æ³¨è§£ | â­â­â­â­â­ |
| **å¯¹è±¡å‚æ•°** | å‚æ•°å±äºåŒä¸€å®ä½“ | è¯­ä¹‰æ¸…æ™° | éœ€è¦åˆ›å»ºç±» | â­â­â­â­â­ |
| **Mapå‚æ•°** | å‚æ•°ä¸å›ºå®š | çµæ´» | ç±»å‹ä¸å®‰å…¨ | â­â­â­ |

---

## 6. ğŸ“¤ è¿”å›å€¼å¤„ç†


### 6.1 åŸºæœ¬ç±»å‹è¿”å›å€¼


**ğŸ”¸ åœºæ™¯**ï¼šè¿”å›ç®€å•æ•°æ®ç±»å‹

```java
// Javaæ¥å£
int getUserCount();              // è¿”å›æ•°é‡
String getUsernameById(int id);  // è¿”å›å­—ç¬¦ä¸²
Integer getMaxAge();             // è¿”å›å¹´é¾„
```

```xml
<!-- resultTypeå¡«å†™å¯¹åº”çš„Javaç±»å‹ -->
<select id="getUserCount" resultType="int">
  SELECT COUNT(*) FROM user
</select>

<select id="getUsernameById" resultType="string">
  SELECT username FROM user WHERE id = #{id}
</select>

<select id="getMaxAge" resultType="integer">
  SELECT MAX(age) FROM user
</select>
```

**å¸¸ç”¨åŸºæœ¬ç±»å‹**ï¼š
```
Javaç±»å‹          resultTypeå†™æ³•
â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
int/Integer  â†’   int æˆ– integer
long/Long    â†’   long
double/Double â†’  double
String       â†’   string
boolean      â†’   boolean
```

### 6.2 å¯¹è±¡ç±»å‹è¿”å›å€¼


**ğŸ”¸ åœºæ™¯**ï¼šè¿”å›å•ä¸ªå®ä½“å¯¹è±¡

```java
// Javaæ¥å£
User getUserById(int id);
```

```xml
<!-- resultTypeå†™å®ä½“ç±»çš„å…¨è·¯å¾„æˆ–åˆ«å -->
<select id="getUserById" resultType="com.example.entity.User">
  SELECT id, username, email, age FROM user WHERE id = #{id}
</select>

<!-- å¦‚æœé…ç½®äº†åˆ«åï¼Œå¯ä»¥ç®€å†™ -->
<select id="getUserById" resultType="User">
  SELECT id, username, email, age FROM user WHERE id = #{id}
</select>
```

**ğŸ¯ å­—æ®µè‡ªåŠ¨æ˜ å°„**ï¼š
```
æ•°æ®åº“å­—æ®µ          Javaå¯¹è±¡å±æ€§
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
id          â†’     user.setId()
username    â†’     user.setUsername()
email       â†’     user.setEmail()
age         â†’     user.setAge()

å‰æï¼šå­—æ®µåå’Œå±æ€§åä¸€è‡´ï¼ˆå¿½ç•¥å¤§å°å†™ï¼‰
```

> **ğŸ’¡ æ–°æ‰‹æç¤º**ï¼šMyBatisä¼šè‡ªåŠ¨æŠŠæŸ¥è¯¢ç»“æœçš„æ¯ä¸€åˆ—å€¼ï¼Œè®¾ç½®åˆ°å¯¹è±¡å¯¹åº”çš„å±æ€§ä¸­ã€‚å‰ææ˜¯åˆ—åå’Œå±æ€§åè¦å¯¹åº”ä¸Šã€‚

### 6.3 é›†åˆç±»å‹è¿”å›å€¼


**ğŸ”¸ åœºæ™¯**ï¼šè¿”å›å¤šæ¡è®°å½•

```java
// Javaæ¥å£ - è¿”å›Listé›†åˆ
List<User> getAllUsers();
List<User> getUsersByAge(int age);
```

```xml
<!-- resultTypeå†™é›†åˆå…ƒç´ çš„ç±»å‹ï¼Œä¸æ˜¯Listï¼ -->
<select id="getAllUsers" resultType="User">
  SELECT * FROM user
</select>

<select id="getUsersByAge" resultType="User">
  SELECT * FROM user WHERE age = #{age}
</select>
```

**âš ï¸ é‡è¦ç†è§£**ï¼š
```
é”™è¯¯å†™æ³• âŒï¼š
<select id="getAllUsers" resultType="java.util.List">
  <!-- MyBatisä¸çŸ¥é“Listé‡Œè£…ä»€ä¹ˆç±»å‹ -->
</select>

æ­£ç¡®å†™æ³• âœ…ï¼š
<select id="getAllUsers" resultType="User">
  <!-- å‘Šè¯‰MyBatisï¼šæŸ¥è¯¢ç»“æœçš„æ¯ä¸€è¡Œéƒ½å°è£…æˆUserå¯¹è±¡ -->
  <!-- MyBatisè‡ªåŠ¨æŠŠå¤šä¸ªUserå¯¹è±¡è£…è¿›Listè¿”å› -->
</select>
```

### 6.4 Mapç±»å‹è¿”å›å€¼


**ğŸ”¸ åœºæ™¯ä¸€**ï¼šè¿”å›å•æ¡è®°å½•ä¸ºMap

```java
// Javaæ¥å£
Map<String, Object> getUserMapById(int id);
```

```xml
<!-- resultType="map" æŠŠä¸€è¡Œè®°å½•è½¬æˆMap -->
<select id="getUserMapById" resultType="map">
  SELECT id, username, email FROM user WHERE id = #{id}
</select>
```

**è¿”å›ç»“æœç¤ºä¾‹**ï¼š
```java
// è¿”å›çš„Mapå†…å®¹ï¼š
{
  "id": 1,
  "username": "å¼ ä¸‰",
  "email": "zhangsan@qq.com"
}
// keyæ˜¯åˆ—åï¼Œvalueæ˜¯åˆ—å€¼
```

**ğŸ”¸ åœºæ™¯äºŒ**ï¼šè¿”å›å¤šæ¡è®°å½•ä¸ºMapé›†åˆ

```java
// @MapKeyæŒ‡å®šç”¨å“ªä¸ªå­—æ®µä½œä¸ºMapçš„key
@MapKey("id")
Map<Integer, User> getUserMap();
```

```xml
<select id="getUserMap" resultType="User">
  SELECT * FROM user
</select>
```

**è¿”å›ç»“æœç¤ºä¾‹**ï¼š
```java
// è¿”å›çš„Mapç»“æ„ï¼š
{
  1: User(id=1, username="å¼ ä¸‰", ...),
  2: User(id=2, username="æå››", ...),
  3: User(id=3, username="ç‹äº”", ...)
}
// keyæ˜¯idï¼Œvalueæ˜¯Userå¯¹è±¡
```

**ğŸ“‹ è¿”å›å€¼ç±»å‹æ€»ç»“è¡¨**ï¼š

| è¿”å›ç±»å‹ | resultTypeå†™æ³• | é€‚ç”¨åœºæ™¯ | ç¤ºä¾‹ |
|----------|---------------|----------|------|
| **åŸºæœ¬ç±»å‹** | `int`ã€`string`ç­‰ | ç»Ÿè®¡ã€å•å€¼æŸ¥è¯¢ | æŸ¥è¯¢æ€»æ•° |
| **å¯¹è±¡** | å®ä½“ç±»å…¨åæˆ–åˆ«å | å•æ¡è®°å½• | æ ¹æ®IDæŸ¥ç”¨æˆ· |
| **List** | é›†åˆå…ƒç´ ç±»å‹ | å¤šæ¡è®°å½• | æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ· |
| **Map** | `map` | åŠ¨æ€å­—æ®µ | ç»Ÿè®¡æŠ¥è¡¨ |

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Mapperæ˜ å°„å™¨ï¼šJavaæ–¹æ³•å’ŒSQLè¯­å¥çš„æ¡¥æ¢ï¼Œå®ç°è‡ªåŠ¨è½¬æ¢
ğŸ”¸ XMLæ˜ å°„æ–‡ä»¶ï¼šä¸“é—¨å­˜æ”¾SQLè¯­å¥çš„XMLæ–‡ä»¶
ğŸ”¸ namespaceï¼šæŠŠXMLæ–‡ä»¶å’ŒJavaæ¥å£ç»‘å®šçš„"èº«ä»½è¯"
ğŸ”¸ å››å¤§æ ‡ç­¾ï¼š<select>æŸ¥ã€<insert>å¢ã€<update>æ”¹ã€<delete>åˆ 
ğŸ”¸ å‚æ•°ä¼ é€’ï¼š#{å‚æ•°å}æ¥æ”¶å‚æ•°ï¼Œæ”¯æŒå¤šç§æ–¹å¼
ğŸ”¸ è¿”å›å€¼å¤„ç†ï¼šresultTypeæŒ‡å®šè¿”å›ç±»å‹ï¼Œè‡ªåŠ¨å°è£…ç»“æœ
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ Mapperå·¥ä½œæµç¨‹**ï¼š
```
ç¬¬ä¸€æ­¥ï¼šè°ƒç”¨æ¥å£æ–¹æ³•
   â†“
ç¬¬äºŒæ­¥ï¼šé€šè¿‡namespaceæ‰¾åˆ°å¯¹åº”çš„XMLæ–‡ä»¶
   â†“
ç¬¬ä¸‰æ­¥ï¼šé€šè¿‡æ–¹æ³•åæ‰¾åˆ°å¯¹åº”çš„SQLæ ‡ç­¾ï¼ˆidåŒ¹é…ï¼‰
   â†“
ç¬¬å››æ­¥ï¼šæŠŠå‚æ•°ä¼ å…¥SQLï¼Œæ‰§è¡ŒæŸ¥è¯¢
   â†“
ç¬¬äº”æ­¥ï¼šæŠŠç»“æœæŒ‰resultTypeå°è£…è¿”å›
```

**ğŸ”¹ å‚æ•°ä¼ é€’æ ¸å¿ƒ**ï¼š
```
å•ä¸ªå‚æ•°ï¼š#{ä»»æ„å} éƒ½å¯ä»¥æ¥æ”¶
å¤šä¸ªå‚æ•°ï¼šå¿…é¡»ç”¨@Paramæ³¨è§£æŒ‡å®šåç§°
å¯¹è±¡å‚æ•°ï¼š#{å±æ€§å} è‡ªåŠ¨è°ƒç”¨getæ–¹æ³•
Mapå‚æ•°ï¼š #{keyå} ä»Mapå–å€¼
```

**ğŸ”¹ è¿”å›å€¼å¤„ç†æ ¸å¿ƒ**ï¼š
```
åŸºæœ¬ç±»å‹ï¼šç›´æ¥å†™ç±»å‹åï¼Œå¦‚ intã€string
å¯¹è±¡ç±»å‹ï¼šå†™å®ä½“ç±»åï¼ŒMyBatisè‡ªåŠ¨å°è£…
é›†åˆç±»å‹ï¼šå†™é›†åˆå…ƒç´ ç±»å‹ï¼ŒMyBatisè‡ªåŠ¨è£…List
Mapç±»å‹ï¼š å†™mapï¼ŒæŠŠç»“æœè½¬æˆé”®å€¼å¯¹
```

### 7.3 æ–°æ‰‹å¸¸è§é—®é¢˜


**â“ é—®é¢˜1ï¼šnamespaceå†™é”™äº†æ€ä¹ˆåŠï¼Ÿ**
```
ç—‡çŠ¶ï¼šè°ƒç”¨æ–¹æ³•æ—¶æŠ¥é”™"æ‰¾ä¸åˆ°å¯¹åº”çš„SQLè¯­å¥"
è§£å†³ï¼šæ£€æŸ¥namespaceæ˜¯å¦å’Œæ¥å£çš„å…¨é™å®šåå®Œå…¨ä¸€è‡´
```

**â“ é—®é¢˜2ï¼šå¤šä¸ªå‚æ•°ä¸ç”¨@Paramä¼šæ€æ ·ï¼Ÿ**
```
ç—‡çŠ¶ï¼šXMLä¸­ #{username} æ‰¾ä¸åˆ°å‚æ•°
è§£å†³ï¼šç»™æ¯ä¸ªå‚æ•°åŠ  @Param("å‚æ•°å") æ³¨è§£
```

**â“ é—®é¢˜3ï¼šè¿”å›Listæ—¶resultTypeæ€ä¹ˆå†™ï¼Ÿ**
```
é”™è¯¯ï¼šresultType="List"  âŒ
æ­£ç¡®ï¼šresultType="User"  âœ…
è®°ä½ï¼šå†™é›†åˆå…ƒç´ çš„ç±»å‹ï¼Œä¸æ˜¯é›†åˆæœ¬èº«
```

**â“ é—®é¢˜4ï¼šå­—æ®µåå’Œå±æ€§åä¸ä¸€è‡´æ€ä¹ˆåŠï¼Ÿ**
```
åœºæ™¯ï¼šæ•°æ®åº“å­—æ®µ user_nameï¼ŒJavaå±æ€§ userName
æ–¹æ¡ˆ1ï¼šSQLä¸­èµ·åˆ«å
  SELECT user_name AS userName FROM user
æ–¹æ¡ˆ2ï¼šä½¿ç”¨resultMapï¼ˆåç»­ç« èŠ‚å­¦ä¹ ï¼‰
```

### 7.4 å®æˆ˜å»ºè®®


**âœ… å¼€å‘è§„èŒƒ**ï¼š
- XMLæ–‡ä»¶å’Œæ¥å£æ–‡ä»¶å‘½åä¿æŒä¸€è‡´
- namespaceå†™å®Œæ•´çš„åŒ…å+æ¥å£å
- å¤šå‚æ•°å¿…é¡»ç”¨@Paramæ³¨è§£
- SQLè¯­å¥è¦æ ¼å¼åŒ–ï¼Œä¾¿äºé˜…è¯»

**âœ… è°ƒè¯•æŠ€å·§**ï¼š
- å¼€å¯MyBatisæ—¥å¿—ï¼ŒæŸ¥çœ‹å®é™…æ‰§è¡Œçš„SQL
- å…ˆåœ¨æ•°æ®åº“å·¥å…·ä¸­æµ‹è¯•SQLæ˜¯å¦æ­£ç¡®
- æ£€æŸ¥è¿”å›å€¼ç±»å‹å’Œå®é™…æŸ¥è¯¢ç»“æœæ˜¯å¦åŒ¹é…

**âœ… å­¦ä¹ è·¯å¾„**ï¼š
1. å…ˆæŒæ¡åŸºæœ¬çš„CRUDæ“ä½œ
2. ç†Ÿæ‚‰å„ç§å‚æ•°ä¼ é€’æ–¹å¼
3. ç†è§£è¿”å›å€¼è‡ªåŠ¨å°è£…æœºåˆ¶
4. ä¸ºå­¦ä¹ åŠ¨æ€SQLæ‰“å¥½åŸºç¡€

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
Mapperæ˜ å°„æœ‰é—¨é“ï¼Œnamespaceç»‘å®šä¸èƒ½å°‘
å››å¤§æ ‡ç­¾è®°å¿ƒé—´ï¼Œå¢åˆ æ”¹æŸ¥å„æœ‰ä¸“
å‚æ•°ä¼ é€’çµæ´»ç”¨ï¼Œè¿”å›å°è£…è‡ªåŠ¨è½¬
å¤šç»ƒå¤šå†™å¤šè°ƒè¯•ï¼ŒMyBatisæŠ€èƒ½æ­¥æ­¥é«˜
```