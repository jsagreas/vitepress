---
title: 4、MyBatis全局配置文件
---
## 📚 目录


1. [全局配置文件是什么](#1-全局配置文件是什么)
2. [configuration根标签](#2-configuration根标签)
3. [properties属性配置](#3-properties属性配置)
4. [settings全局设置](#4-settings全局设置)
5. [typeAliases类型别名](#5-typeAliases类型别名)
6. [typeHandlers类型处理器](#6-typeHandlers类型处理器)
7. [objectFactory对象工厂](#7-objectFactory对象工厂)
8. [plugins插件配置](#8-plugins插件配置)
9. [environments环境配置](#9-environments环境配置)
10. [databaseIdProvider数据库厂商标识](#10-databaseIdProvider数据库厂商标识)
11. [mappers映射器配置](#11-mappers映射器配置)
12. [核心要点总结](#12-核心要点总结)

---

## 1. 📄 全局配置文件是什么



### 1.1 核心概念理解



**🔸 什么是全局配置文件**
```
简单理解：
MyBatis的"总开关"和"设置面板"，就像手机的系统设置一样
所有MyBatis的行为都由这个文件控制

文件名通常叫：mybatis-config.xml
位置：src/main/resources目录下
```

**💡 为什么需要它**
```
类比理解：
就像开车前要调整座椅、后视镜、空调一样
MyBatis运行前也需要知道：
• 连接哪个数据库？（环境配置）
• 怎么处理数据？（类型处理）
• 有哪些SQL语句？（映射器配置）
• 要不要打印日志？（全局设置）
```

### 1.2 配置文件的作用



**🎯 主要功能**
| 功能 | 通俗解释 | 实际作用 |
|------|---------|---------|
| **连接数据库** | 告诉MyBatis去哪找数据 | 配置数据源、账号密码 |
| **定义规则** | 设置MyBatis的工作方式 | 是否开启缓存、驼峰命名等 |
| **简化代码** | 给长名字起别名 | 类型别名配置 |
| **扩展功能** | 安装插件增强能力 | 分页插件、性能监控等 |

---

## 2. 🏗️ configuration根标签



### 2.1 基本结构认识



**📋 整体框架**
```
mybatis-config.xml 的基本骨架：

<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE configuration 
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-config.dtd">
  
<configuration>
  <!-- 所有配置都写在这里面 -->
</configuration>
```

**🔸 关键理解**
```
configuration = 配置的根容器
就像一个大箱子，其他所有配置都装在里面
顺序很重要！各个子标签必须按规定顺序写
```

### 2.2 配置顺序规则



**⚠️ 重要：标签必须按这个顺序写**
```
正确的顺序：
<configuration>
  1️⃣ properties      → 属性配置
  2️⃣ settings         → 全局设置  
  3️⃣ typeAliases      → 类型别名
  4️⃣ typeHandlers     → 类型处理器
  5️⃣ objectFactory    → 对象工厂
  6️⃣ plugins          → 插件
  7️⃣ environments     → 环境配置
  8️⃣ databaseIdProvider → 数据库厂商标识
  9️⃣ mappers          → 映射器
</configuration>

顺序错了会报错！就像穿衣服要先穿内衣再穿外套
```

---

## 3. 🔧 properties属性配置



### 3.1 作用和用途



**🔸 核心概念**
```
properties = 属性配置 = 变量定义

通俗理解：
就像定义变量一样，先定义好值，后面直接用变量名
避免重复写相同的内容
```

**💡 实际应用场景**
```
常见用法：
• 数据库连接信息（账号、密码、地址）
• 文件路径配置
• 系统参数设置

好处：
修改配置只需改一个地方，不用到处找
```

### 3.2 三种配置方式



**方式1️⃣：直接在XML中定义**
```xml
<properties>
  <property name="driver" value="com.mysql.jdbc.Driver"/>
  <property name="url" value="jdbc:mysql://localhost:3306/mydb"/>
  <property name="username" value="root"/>
  <property name="password" value="123456"/>
</properties>

<!-- 后面使用 -->
<dataSource type="POOLED">
  <property name="driver" value="${driver}"/>
  <property name="url" value="${url}"/>
</dataSource>
```

**方式2️⃣：引用外部properties文件**
```xml
<!-- 先引用外部文件 -->
<properties resource="db.properties"/>

<!-- db.properties文件内容：
jdbc.driver=com.mysql.jdbc.Driver
jdbc.url=jdbc:mysql://localhost:3306/mydb
jdbc.username=root
jdbc.password=123456
-->

<!-- 使用 -->
<property name="driver" value="${jdbc.driver}"/>
```

**方式3️⃣：混合使用（优先级）**
```
优先级顺序（从高到低）：
1. 代码中传入的参数（最高）
2. properties标签内的property
3. resource引用的文件（最低）

记忆：越靠近代码的优先级越高
```

---

## 4. ⚙️ settings全局设置



### 4.1 核心概念



**🔸 什么是settings**
```
settings = 全局设置 = MyBatis的"系统偏好设置"

通俗理解：
就像手机设置里的开关选项
• 要不要自动更新？
• 要不要省电模式？
• 要不要显示通知？

MyBatis也有这样的开关
```

### 4.2 常用重要设置



**📋 核心配置项**

| 设置名 | 含义解释 | 推荐值 | 作用说明 |
|--------|---------|--------|---------|
| `cacheEnabled` | 缓存开关 | `true` | 开启二级缓存，提升查询速度 |
| `lazyLoadingEnabled` | 懒加载开关 | `false` | 关联查询时延迟加载 |
| `mapUnderscoreToCamelCase` | 驼峰命名转换 | `true` | 数据库字段`user_name`自动映射到`userName` |
| `logImpl` | 日志实现 | `STDOUT_LOGGING` | 控制台打印SQL，方便调试 |
| `defaultExecutorType` | 执行器类型 | `SIMPLE` | 普通执行器 |

**💻 配置示例**
```xml
<settings>
  <!-- 开启驼峰命名自动映射 -->
  <setting name="mapUnderscoreToCamelCase" value="true"/>
  
  <!-- 打印SQL到控制台 -->
  <setting name="logImpl" value="STDOUT_LOGGING"/>
  
  <!-- 开启二级缓存 -->
  <setting name="cacheEnabled" value="true"/>
</settings>
```

### 4.3 重点设置详解



**🎯 mapUnderscoreToCamelCase（驼峰映射）**
```
问题场景：
数据库字段：user_name, create_time
Java属性：  userName, createTime
怎么对应？

解决方案：
开启驼峰映射后，MyBatis自动转换
user_name  → userName
create_time → createTime

<setting name="mapUnderscoreToCamelCase" value="true"/>
```

**🎯 logImpl（日志实现）**
```
常用日志选项：
• STDOUT_LOGGING  → 控制台打印（学习调试用）
• LOG4J          → 使用Log4j日志框架
• SLF4J          → 使用SLF4J日志框架

新手推荐：
<setting name="logImpl" value="STDOUT_LOGGING"/>
能看到执行的SQL语句，方便学习
```

---

## 5. 🏷️ typeAliases类型别名



### 5.1 为什么需要别名



**🔸 问题场景**
```
不用别名的痛苦：
每次写实体类都要写完整路径

<select id="getUser" resultType="com.example.entity.User">
  SELECT * FROM user
</select>

<select id="getOrder" resultType="com.example.entity.Order">
  SELECT * FROM order  
</select>

太长了！写到手酸！
```

**✅ 使用别名的好处**
```
定义别名后：

<select id="getUser" resultType="User">
  SELECT * FROM user
</select>

简洁明了！只写类名就行
```

### 5.2 两种定义方式



**方式1️⃣：单个类别名**
```xml
<typeAliases>
  <!-- 给单个类定义别名 -->
  <typeAlias type="com.example.entity.User" alias="User"/>
  <typeAlias type="com.example.entity.Order" alias="Order"/>
</typeAliases>

使用：
<select id="getUser" resultType="User">
```

**方式2️⃣：包扫描（推荐）**
```xml
<typeAliases>
  <!-- 扫描整个包，自动注册别名 -->
  <package name="com.example.entity"/>
</typeAliases>

规则：
类名就是别名（首字母大小写都行）
User类 → 别名：User 或 user
Order类 → 别名：Order 或 order
```

**🎯 使用注解自定义别名**
```java
// 在实体类上使用@Alias注解
@Alias("usr")
public class User {
    private Long id;
    private String name;
}

XML中使用：
<select id="getUser" resultType="usr">
```

### 5.3 内置别名



**📋 MyBatis预定义的别名**
```
基本类型：
int → _int
long → _long
boolean → _boolean

包装类型：
Integer → int
Long → long
Boolean → boolean
String → string

集合类型：
ArrayList → arraylist
HashMap → hashmap
```

---

## 6. 🔄 typeHandlers类型处理器



### 6.1 核心概念



**🔸 什么是类型处理器**
```
typeHandlers = 类型处理器 = 数据类型的"翻译官"

通俗理解：
Java和数据库说的"语言"不一样
需要翻译官在中间转换

Java: String类型
  ↕️  (类型处理器翻译)
数据库: VARCHAR类型
```

**💡 工作场景**
```
场景1：存入数据库
Java对象 → 类型处理器 → 数据库字段
User.name(String) → TypeHandler → VARCHAR

场景2：查询数据
数据库字段 → 类型处理器 → Java对象  
VARCHAR → TypeHandler → User.name(String)
```

### 6.2 何时需要自定义



**🎯 常见使用场景**

```
场景1：枚举类型处理
数据库存：1, 2, 3
Java用：  MALE, FEMALE, UNKNOWN

场景2：JSON字段
数据库存：{"name":"张三","age":20}
Java用：  User对象

场景3：加密解密
数据库存：加密后的密码
Java用：  明文密码

场景4：日期格式
数据库存：时间戳
Java用：  LocalDateTime对象
```

**💻 简单示例**
```xml
<typeHandlers>
  <!-- 注册自定义类型处理器 -->
  <typeHandler handler="com.example.handler.MyTypeHandler"/>
  
  <!-- 或扫描包 -->
  <package name="com.example.handler"/>
</typeHandlers>
```

### 6.3 理解要点



> 💡 **新手提示**
> 
> 大多数情况下不需要自定义类型处理器
> MyBatis内置了常用类型的处理器
> 只有特殊需求时才需要自己写

---

## 7. 🏭 objectFactory对象工厂



### 7.1 核心概念



**🔸 什么是对象工厂**
```
objectFactory = 对象工厂 = 对象的"生产车间"

通俗理解：
MyBatis查询数据后要创建Java对象
对象工厂负责"制造"这些对象

默认工厂：
使用无参构造方法创建对象
new User();
```

**💡 工作流程**
```
查询流程：
1. 执行SQL查询
2. 得到结果集
3. objectFactory创建空对象
4. 填充属性值
5. 返回完整对象

   SQL查询
      ↓
   ResultSet
      ↓
  objectFactory (创建对象)
      ↓
   填充属性
      ↓
   返回对象
```

### 7.2 使用场景



**🎯 何时需要自定义**
```
默认够用：
90%的情况用默认工厂就行

需要自定义的场景：
• 对象创建需要特殊逻辑
• 需要依赖注入
• 使用工厂模式创建对象
• 创建时需要额外初始化
```

**💻 配置方式**
```xml
<objectFactory type="com.example.factory.MyObjectFactory">
  <!-- 可以传入参数 -->
  <property name="someProperty" value="100"/>
</objectFactory>
```

> ⚠️ **新手提示**
> 
> 这是高级特性，初学者用默认的就够了
> 不配置这个标签，MyBatis用默认工厂

---

## 8. 🔌 plugins插件配置



### 8.1 核心概念



**🔸 什么是插件**
```
plugins = 插件 = MyBatis的"外挂程序"

通俗理解：
就像给浏览器安装扩展插件
给MyBatis增加额外功能

核心功能：
拦截MyBatis的执行流程
在特定时机做额外处理
```

**💡 插件能做什么**
```
常见功能：
• 分页功能（PageHelper）
• 性能监控（打印SQL执行时间）
• 数据权限控制
• SQL美化输出
• 自动填充字段（createTime等）
```

### 8.2 插件配置方式



**📋 配置步骤**
```
步骤1️⃣：引入插件依赖
步骤2️⃣：在配置文件中注册
步骤3️⃣：使用插件功能
```

**💻 分页插件示例（PageHelper）**
```xml
<plugins>
  <!-- 配置分页插件 -->
  <plugin interceptor="com.github.pagehelper.PageInterceptor">
    <!-- 设置数据库类型 -->
    <property name="helperDialect" value="mysql"/>
    <!-- 分页合理化 -->
    <property name="reasonable" value="true"/>
  </plugin>
</plugins>
```

### 8.3 常用插件介绍



**🔥 PageHelper（分页插件）**
```
作用：自动处理分页SQL
不用自己写LIMIT语句

使用示例：
// 查询第1页，每页10条
PageHelper.startPage(1, 10);
List<User> users = userMapper.selectAll();

// PageHelper自动加上：
// LIMIT 0, 10
```

**🔥 MyBatis-Plus插件**
```
功能更强大的插件集合：
• 自动分页
• 性能分析
• 乐观锁
• SQL注入过滤
```

> 💡 **学习建议**
> 
> 初学阶段先学会基本使用
> 分页插件是必学的
> 其他插件用到再深入

---

## 9. 🌍 environments环境配置



### 9.1 核心概念



**🔸 什么是环境配置**
```
environments = 环境配置 = 不同场景的数据库连接

通俗理解：
开发时连测试库
上线时连生产库
需要配置多个环境，随时切换
```

**💡 环境的组成**
```
一个环境包含：
1. 事务管理器（怎么管理事务）
2. 数据源配置（连哪个数据库）

          环境配置
         /        \
   事务管理器    数据源
     (怎么管事务) (连哪个库)
```

### 9.2 配置结构详解



**📋 完整配置示例**
```xml
<!-- default：指定默认使用哪个环境 -->
<environments default="development">
  
  <!-- 开发环境 -->
  <environment id="development">
    <!-- 事务管理器：JDBC方式 -->
    <transactionManager type="JDBC"/>
    
    <!-- 数据源：连接池方式 -->
    <dataSource type="POOLED">
      <property name="driver" value="${jdbc.driver}"/>
      <property name="url" value="${jdbc.url}"/>
      <property name="username" value="${jdbc.username}"/>
      <property name="password" value="${jdbc.password}"/>
    </dataSource>
  </environment>
  
  <!-- 生产环境 -->
  <environment id="production">
    <transactionManager type="JDBC"/>
    <dataSource type="POOLED">
      <property name="driver" value="${prod.driver}"/>
      <property name="url" value="${prod.url}"/>
      <property name="username" value="${prod.username}"/>
      <property name="password" value="${prod.password}"/>
    </dataSource>
  </environment>
  
</environments>
```

**🔸 关键属性说明**
| 属性 | 含义 | 示例 |
|------|------|------|
| `default` | 默认使用哪个环境 | `development` |
| `id` | 环境的唯一标识 | `development`、`production` |

### 9.3 事务管理器类型



**🔸 两种类型对比**

```
类型1️⃣：JDBC
<transactionManager type="JDBC"/>

含义：使用JDBC的事务管理
特点：需要手动提交事务
适用：单独使用MyBatis

类型2️⃣：MANAGED  
<transactionManager type="MANAGED"/>

含义：交给容器管理（如Spring）
特点：自动管理事务
适用：整合Spring框架
```

**💡 选择建议**
```
单独使用MyBatis → JDBC
整合Spring框架  → MANAGED（或者让Spring接管）
```

### 9.4 数据源类型详解



**🔸 三种数据源类型**

**类型1️⃣：UNPOOLED（不使用连接池）**
```xml
<dataSource type="UNPOOLED">
  <!-- 每次请求都创建新连接 -->
  <!-- 用完就关闭 -->
  <!-- 性能差，不推荐 -->
</dataSource>

特点：
• 每次查询创建新连接
• 用完立即关闭
• 性能低
• 仅用于测试
```

**类型2️⃣：POOLED（连接池）⭐推荐**
```xml
<dataSource type="POOLED">
  <!-- 使用连接池复用连接 -->
  <property name="poolMaximumActiveConnections" value="20"/>
  <property name="poolMaximumIdleConnections" value="10"/>
</dataSource>

特点：
• 预先创建连接放在池中
• 需要时从池中取
• 用完放回池中复用
• 性能高，推荐使用

连接池配置参数：
poolMaximumActiveConnections  → 最大活动连接数
poolMaximumIdleConnections    → 最大空闲连接数
poolMaximumCheckoutTime       → 最长取出时间
```

**类型3️⃣：JNDI（企业级）**
```xml
<dataSource type="JNDI">
  <!-- 使用服务器提供的数据源 -->
  <property name="data_source" value="java:comp/env/jdbc/mydb"/>
</dataSource>

特点：
• 使用应用服务器的数据源
• Tomcat、WebLogic等提供
• 企业级应用使用
```

**🎯 选择建议**
```
学习阶段   → POOLED（连接池）
生产环境   → POOLED 或 JNDI
性能测试   → UNPOOLED（看差距）
```

### 9.5 环境切换方式



**🔸 切换方法**
```xml
<!-- 方法1：修改default属性 -->
<environments default="development">  ← 改成production
  <environment id="development">...</environment>
  <environment id="production">...</environment>
</environments>

<!-- 方法2：代码中指定 -->
SqlSessionFactory factory = new SqlSessionFactoryBuilder()
    .build(inputStream, "production");  // 指定环境ID
```

---

## 10. 🏢 databaseIdProvider数据库厂商标识



### 10.1 核心概念



**🔸 什么是数据库厂商标识**
```
databaseIdProvider = 数据库厂商标识 = 识别用的是哪种数据库

问题场景：
同一个项目可能部署到不同数据库
• MySQL
• Oracle  
• SQL Server

SQL语法可能不同，需要区分
```

**💡 为什么需要它**
```
不同数据库的SQL差异：

MySQL分页：
LIMIT 10

Oracle分页：
ROWNUM <= 10

SQL Server分页：
TOP 10

需要识别数据库类型，使用对应SQL
```

### 10.2 配置方式



**📋 基础配置**
```xml
<databaseIdProvider type="DB_VENDOR">
  <!-- 配置数据库厂商别名 -->
  <property name="MySQL" value="mysql"/>
  <property name="Oracle" value="oracle"/>
  <property name="SQL Server" value="sqlserver"/>
</databaseIdProvider>
```

**💻 在SQL映射中使用**
```xml
<!-- MySQL版本 -->
<select id="getUsers" resultType="User" databaseId="mysql">
  SELECT * FROM user LIMIT #{offset}, #{pageSize}
</select>

<!-- Oracle版本 -->
<select id="getUsers" resultType="User" databaseId="oracle">
  SELECT * FROM user WHERE ROWNUM <= #{pageSize}
</select>

<!-- SQL Server版本 -->
<select id="getUsers" resultType="User" databaseId="sqlserver">
  SELECT TOP #{pageSize} * FROM user
</select>
```

### 10.3 工作原理



**🔍 识别过程**
```
步骤1️⃣：MyBatis获取数据库连接
步骤2️⃣：读取数据库元数据
步骤3️⃣：获取数据库产品名称
步骤4️⃣：匹配配置的别名
步骤5️⃣：设置databaseId

执行SQL时：
优先执行匹配databaseId的SQL
没有匹配的就执行通用SQL
```

> 💡 **使用建议**
> 
> 如果项目只用一种数据库，不需要配置
> 多数据库支持时才需要
> 新手项目一般用不到

---

## 11. 🗺️ mappers映射器配置



### 11.1 核心概念



**🔸 什么是映射器**
```
mappers = 映射器配置 = 告诉MyBatis去哪找SQL语句

通俗理解：
SQL语句写在XML文件或注解中
需要告诉MyBatis这些文件在哪
就像告诉快递员收货地址
```

**💡 映射器的作用**
```
核心功能：
1. 指定SQL映射文件位置
2. 注册Mapper接口
3. 建立接口和SQL的映射关系

      Mapper接口           SQL映射文件
    (UserMapper.java) ← → (UserMapper.xml)
           ↑
      mappers配置（建立关联）
```

### 11.2 四种配置方式



**方式1️⃣：使用resource引入**
```xml
<mappers>
  <!-- 相对于classpath的路径 -->
  <mapper resource="mapper/UserMapper.xml"/>
  <mapper resource="mapper/OrderMapper.xml"/>
</mappers>

特点：
✅ 明确指定文件位置
✅ 适合少量映射文件
❌ 文件多了配置麻烦
```

**方式2️⃣：使用url引入（少用）**
```xml
<mappers>
  <!-- 使用完整路径 -->
  <mapper url="file:///D:/project/mapper/UserMapper.xml"/>
</mappers>

特点：
✅ 可以引用任意位置文件
❌ 移植性差
❌ 基本不用
```

**方式3️⃣：使用class注册接口**
```xml
<mappers>
  <!-- 注册Mapper接口 -->
  <mapper class="com.example.mapper.UserMapper"/>
  <mapper class="com.example.mapper.OrderMapper"/>
</mappers>

要求：
⚠️ 接口和XML文件同名
⚠️ 接口和XML在同一目录
或者使用注解写SQL
```

**方式4️⃣：包扫描（推荐）⭐**
```xml
<mappers>
  <!-- 扫描整个包 -->
  <package name="com.example.mapper"/>
</mappers>

特点：
✅ 自动扫描包下所有Mapper
✅ 新增Mapper自动识别
✅ 配置最简单
✅ 最常用方式

要求：
⚠️ 接口和XML同名
⚠️ 接口和XML在同一路径
```

### 11.3 目录结构要求



**🔸 使用包扫描时的目录规范**

```
项目结构：

src/main/java
└── com/example/mapper
    ├── UserMapper.java      ← 接口
    └── OrderMapper.java

src/main/resources  
└── com/example/mapper       ← 注意：要建相同的包路径
    ├── UserMapper.xml       ← XML文件
    └── OrderMapper.xml

配置：
<mappers>
  <package name="com.example.mapper"/>
</mappers>

关键点：
• resources下也要建包路径
• 接口名 = XML文件名
• 包名要一致
```

**💡 常见错误**
```
❌ 错误1：XML文件放在resources根目录
resources
  └── UserMapper.xml  (错误位置)

✅ 正确：建立对应包结构  
resources
  └── com/example/mapper
      └── UserMapper.xml

❌ 错误2：接口和XML名称不一致
UserMapper.java
UserDao.xml  (名称不同)

✅ 正确：名称保持一致
UserMapper.java
UserMapper.xml
```

### 11.4 配置方式选择



**🎯 实际应用建议**

| 场景 | 推荐方式 | 原因 |
|------|---------|------|
| **小项目** | resource逐个引入 | 文件少，明确清晰 |
| **大项目** | 包扫描 | 自动识别，维护方便 |
| **使用注解SQL** | class注册 | 不需要XML文件 |
| **混合方式** | 包扫描 + resource | 灵活配置 |

```xml
<!-- 推荐配置：包扫描为主 -->
<mappers>
  <!-- 扫描主要的Mapper包 -->
  <package name="com.example.mapper"/>
  
  <!-- 特殊的单独引入 -->
  <mapper resource="special/SpecialMapper.xml"/>
</mappers>
```

---

## 12. 📋 核心要点总结



### 12.1 配置文件整体结构



**🔸 完整配置模板**
```xml
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-config.dtd">

<configuration>
  <!-- 1. 引入外部属性文件 -->
  <properties resource="db.properties"/>
  
  <!-- 2. 全局设置 -->
  <settings>
    <setting name="mapUnderscoreToCamelCase" value="true"/>
    <setting name="logImpl" value="STDOUT_LOGGING"/>
  </settings>
  
  <!-- 3. 类型别名 -->
  <typeAliases>
    <package name="com.example.entity"/>
  </typeAliases>
  
  <!-- 4. 类型处理器（可选） -->
  <!-- <typeHandlers>
    <package name="com.example.handler"/>
  </typeHandlers> -->
  
  <!-- 5. 对象工厂（可选） -->
  <!-- <objectFactory type="..."/> -->
  
  <!-- 6. 插件 -->
  <plugins>
    <plugin interceptor="com.github.pagehelper.PageInterceptor"/>
  </plugins>
  
  <!-- 7. 环境配置 -->
  <environments default="development">
    <environment id="development">
      <transactionManager type="JDBC"/>
      <dataSource type="POOLED">
        <property name="driver" value="${jdbc.driver}"/>
        <property name="url" value="${jdbc.url}"/>
        <property name="username" value="${jdbc.username}"/>
        <property name="password" value="${jdbc.password}"/>
      </dataSource>
    </environment>
  </environments>
  
  <!-- 8. 数据库厂商标识（可选） -->
  <!-- <databaseIdProvider type="DB_VENDOR"/> -->
  
  <!-- 9. 映射器 -->
  <mappers>
    <package name="com.example.mapper"/>
  </mappers>
  
</configuration>
```

### 12.2 必须掌握的配置



**🔥 新手必会配置（重要程度排序）**

```
1️⃣ mappers（最重要）
   └─ 不配置找不到SQL，项目运行不了

2️⃣ environments  
   └─ 不配置连不上数据库

3️⃣ settings
   └─ 影响功能和开发体验
   
4️⃣ typeAliases
   └─ 简化代码编写

5️⃣ properties
   └─ 方便配置管理

6️⃣ plugins
   └─ 扩展功能（分页必用）

后面的看需要再学：
typeHandlers、objectFactory、databaseIdProvider
```

### 12.3 常用最佳配置



**✨ 推荐配置（直接用）**

```xml
<configuration>
  <!-- 引入数据库配置 -->
  <properties resource="db.properties"/>
  
  <!-- 核心设置 -->
  <settings>
    <!-- 驼峰映射：数据库user_name → Java userName -->
    <setting name="mapUnderscoreToCamelCase" value="true"/>
    
    <!-- 打印SQL日志 -->
    <setting name="logImpl" value="STDOUT_LOGGING"/>
    
    <!-- 开启二级缓存 -->
    <setting name="cacheEnabled" value="true"/>
    
    <!-- 懒加载总开关 -->
    <setting name="lazyLoadingEnabled" value="true"/>
    
    <!-- 按需加载 -->
    <setting name="aggressiveLazyLoading" value="false"/>
  </settings>
  
  <!-- 类型别名：自动扫描 -->
  <typeAliases>
    <package name="com.example.entity"/>
  </typeAliases>
  
  <!-- 分页插件 -->
  <plugins>
    <plugin interceptor="com.github.pagehelper.PageInterceptor">
      <property name="helperDialect" value="mysql"/>
      <property name="reasonable" value="true"/>
    </plugin>
  </plugins>
  
  <!-- 环境配置 -->
  <environments default="development">
    <environment id="development">
      <transactionManager type="JDBC"/>
      <dataSource type="POOLED">
        <property name="driver" value="${jdbc.driver}"/>
        <property name="url" value="${jdbc.url}"/>
        <property name="username" value="${jdbc.username}"/>
        <property name="password" value="${jdbc.password}"/>
        <!-- 连接池配置 -->
        <property name="poolMaximumActiveConnections" value="20"/>
        <property name="poolMaximumIdleConnections" value="10"/>
      </dataSource>
    </environment>
  </environments>
  
  <!-- 映射器：包扫描 -->
  <mappers>
    <package name="com.example.mapper"/>
  </mappers>
</configuration>
```

### 12.4 配置顺序记忆口诀



```
🧠 记忆口诀：

配置顺序要记牢，写错位置会报错
属性设置别名先，处理工厂插件连
环境标识映射器，按序配置不会乱

详细版：
properties   → 属性配置
settings     → 全局设置
typeAliases  → 类型别名
typeHandlers → 类型处理
objectFactory → 对象工厂
plugins      → 插件配置
environments → 环境配置
databaseId   → 数据库标识
mappers      → 映射器
```

### 12.5 常见问题排查



**❓ 常见错误和解决方案**

| 错误现象 | 可能原因 | 解决方法 |
|---------|---------|---------|
| `找不到Mapper` | mappers配置错误 | 检查包扫描路径 |
| `标签顺序错误` | 配置顺序不对 | 按规定顺序排列 |
| `连接数据库失败` | environments配置错误 | 检查数据库连接信息 |
| `SQL日志不显示` | logImpl未配置 | 添加日志设置 |
| `驼峰映射不生效` | settings未开启 | 开启mapUnderscoreToCamelCase |

**🔍 调试技巧**
```
1️⃣ 开启SQL日志
   <setting name="logImpl" value="STDOUT_LOGGING"/>
   
2️⃣ 检查配置文件加载
   确认mybatis-config.xml在resources下
   
3️⃣ 验证Mapper注册
   启动时查看日志，看有没有加载Mapper
   
4️⃣ 测试数据库连接
   先用JDBC测试能否连接数据库
```

---

# 🎯 学习建议



## 📖 学习路径


```
第1步：理解配置文件的作用
     ↓
第2步：掌握必须配置（environments、mappers）
     ↓
第3步：学会常用配置（settings、typeAliases）  
     ↓
第4步：了解扩展配置（plugins、typeHandlers）
     ↓
第5步：实战练习，自己搭建配置
```

## 💡 记忆重点


- **配置顺序**：必须按规定顺序，记住口诀
- **必会标签**：environments、mappers、settings
- **常用设置**：驼峰映射、日志打印、类型别名
- **目录规范**：Mapper接口和XML要对应

## 🛠️ 实践建议


```
1. 准备一个模板配置文件
2. 每次新项目复制修改
3. 根据需要添加插件
4. 养成写注释的习惯
5. 不同环境用不同配置文件
```