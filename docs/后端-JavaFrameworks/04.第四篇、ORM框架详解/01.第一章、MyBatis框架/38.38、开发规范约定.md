---
title: 38ã€å¼€å‘è§„èŒƒçº¦å®š
---
## ğŸ“š ç›®å½•


1. [å¼€å‘è§„èŒƒçš„é‡è¦æ€§](#1-å¼€å‘è§„èŒƒçš„é‡è¦æ€§)
2. [é¡¹ç›®ç»“æ„è§„èŒƒ](#2-é¡¹ç›®ç»“æ„è§„èŒƒ)
3. [å‘½åè§„åˆ™çº¦å®š](#3-å‘½åè§„åˆ™çº¦å®š)
4. [Mapperæ–‡ä»¶è§„èŒƒ](#4-Mapperæ–‡ä»¶è§„èŒƒ)
5. [SQLç¼–å†™è§„èŒƒ](#5-SQLç¼–å†™è§„èŒƒ)
6. [æ³¨é‡Šè§„èŒƒè¦æ±‚](#6-æ³¨é‡Šè§„èŒƒè¦æ±‚)
7. [å¼‚å¸¸å¤„ç†è§„èŒƒ](#7-å¼‚å¸¸å¤„ç†è§„èŒƒ)
8. [æ—¥å¿—è®°å½•è§„èŒƒ](#8-æ—¥å¿—è®°å½•è§„èŒƒ)
9. [æµ‹è¯•è§„èŒƒè¦æ±‚](#9-æµ‹è¯•è§„èŒƒè¦æ±‚)
10. [ä»£ç å®¡æŸ¥æ ‡å‡†](#10-ä»£ç å®¡æŸ¥æ ‡å‡†)
11. [æ–‡æ¡£ç¼–å†™è§„èŒƒ](#11-æ–‡æ¡£ç¼–å†™è§„èŒƒ)
12. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#12-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ å¼€å‘è§„èŒƒçš„é‡è¦æ€§



### 1.1 ä¸ºä»€ä¹ˆéœ€è¦å¼€å‘è§„èŒƒ



**é€šä¿—ç†è§£**ï¼šå°±åƒå†™å­—è¦æœ‰è§„èŒƒä¸€æ ·ï¼Œä»£ç ä¹Ÿéœ€è¦ç»Ÿä¸€çš„"ä¹¦å†™æ ¼å¼"

```
æ²¡æœ‰è§„èŒƒçš„é¡¹ç›®ï¼š
- æ¯ä¸ªäººå†™æ³•ä¸ä¸€æ ·ï¼Œåƒ"å¤©ä¹¦"
- æ¥æ‰‹åˆ«äººä»£ç çœ‹ä¸æ‡‚
- å‡ºé—®é¢˜æ‰¾ä¸åˆ°åŸå› 
- å›¢é˜Ÿåä½œæ•ˆç‡ä½

æœ‰è§„èŒƒçš„é¡¹ç›®ï¼š
- ä»£ç æ•´é½åˆ’ä¸€ï¼Œå®¹æ˜“çœ‹æ‡‚
- æ–°äººå¿«é€Ÿä¸Šæ‰‹
- é—®é¢˜å¿«é€Ÿå®šä½
- å›¢é˜Ÿé…åˆé»˜å¥‘
```

> ğŸ’¡ **æ–°æ‰‹æç¤º**  
> è§„èŒƒå°±åƒäº¤é€šè§„åˆ™ï¼Œå¤§å®¶éƒ½éµå®ˆæ‰èƒ½ä¿è¯é¡¹ç›®é¡ºåˆ©è¿›è¡Œ

### 1.2 è§„èŒƒå¸¦æ¥çš„å¥½å¤„



| æ–¹é¢ | **æ²¡æœ‰è§„èŒƒ** | **æœ‰è§„èŒƒ** | **æ”¶ç›Š** |
|------|------------|----------|---------|
| ğŸ“– **ä»£ç å¯è¯»æ€§** | `éš¾ä»¥ç†è§£` | `æ¸…æ™°æ˜äº†` | `é™ä½å­¦ä¹ æˆæœ¬` |
| ğŸ”§ **ç»´æŠ¤éš¾åº¦** | `æ”¹åŠ¨å›°éš¾` | `è½»æ¾ç»´æŠ¤` | `èŠ‚çœæ—¶é—´ç²¾åŠ›` |
| ğŸ› **Bugæ’æŸ¥** | `éš¾ä»¥å®šä½` | `å¿«é€Ÿæ‰¾åˆ°` | `æå‡å¼€å‘æ•ˆç‡` |
| ğŸ‘¥ **å›¢é˜Ÿåä½œ** | `æ²Ÿé€šæˆæœ¬é«˜` | `é…åˆé¡ºç•…` | `æé«˜ç”Ÿäº§åŠ›` |
| ğŸ“ˆ **é¡¹ç›®è´¨é‡** | `å‚å·®ä¸é½` | `ç¨³å®šå¯é ` | `ç”¨æˆ·æ»¡æ„åº¦é«˜` |

---

## 2. ğŸ“ é¡¹ç›®ç»“æ„è§„èŒƒ



### 2.1 æ ‡å‡†ç›®å½•ç»“æ„



**é€šä¿—è§£é‡Š**ï¼šå°±åƒæ•´ç†æˆ¿é—´ï¼Œä¸åŒçš„ä¸œè¥¿æ”¾åœ¨ä¸åŒçš„åœ°æ–¹

```
é¡¹ç›®æ ¹ç›®å½•
â”œâ”€â”€ src/main/java/           â† Javaä»£ç å­˜æ”¾å¤„
â”‚   â””â”€â”€ com/example/
â”‚       â”œâ”€â”€ controller/      â† æ§åˆ¶å™¨å±‚ï¼ˆæ¥æ”¶è¯·æ±‚ï¼‰
â”‚       â”œâ”€â”€ service/         â† ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆå¤„ç†ä¸šåŠ¡ï¼‰
â”‚       â”‚   â””â”€â”€ impl/        â† ä¸šåŠ¡å®ç°ç±»
â”‚       â”œâ”€â”€ mapper/          â† Mapperæ¥å£ï¼ˆæ•°æ®è®¿é—®ï¼‰
â”‚       â””â”€â”€ entity/          â† å®ä½“ç±»ï¼ˆå¯¹åº”æ•°æ®åº“è¡¨ï¼‰
â”‚
â”œâ”€â”€ src/main/resources/      â† é…ç½®æ–‡ä»¶å­˜æ”¾å¤„
â”‚   â”œâ”€â”€ mapper/              â† Mapper XMLæ–‡ä»¶
â”‚   â”œâ”€â”€ application.yml      â† ä¸»é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ logback.xml          â† æ—¥å¿—é…ç½®
â”‚
â””â”€â”€ src/test/java/           â† æµ‹è¯•ä»£ç 
    â””â”€â”€ com/example/
        â””â”€â”€ mapper/          â† Mapperæµ‹è¯•
```

> ğŸ¯ **æ ¸å¿ƒåŸåˆ™**  
> åˆ†å±‚æ¸…æ™°ï¼ŒèŒè´£æ˜ç¡®ï¼Œä¸€ä¸ªæ–‡ä»¶åªåšä¸€ä»¶äº‹

### 2.2 å„å±‚èŒè´£è¯´æ˜



**Controllerå±‚ï¼ˆæ§åˆ¶å™¨ï¼‰**
```
ä½œç”¨ï¼šæ¥æ”¶ç”¨æˆ·è¯·æ±‚ï¼Œè¿”å›å¤„ç†ç»“æœ
æ¯”å–»ï¼šå°±åƒé¤å…æœåŠ¡å‘˜ï¼Œæ¥æ”¶å®¢äººç‚¹é¤ï¼Œé€ä¸Šèœå“

èŒè´£ï¼š
âœ… æ¥æ”¶HTTPè¯·æ±‚
âœ… å‚æ•°æ ¡éªŒ
âœ… è°ƒç”¨Serviceå¤„ç†ä¸šåŠ¡
âœ… è¿”å›å“åº”ç»“æœ

âŒ ä¸åº”è¯¥ï¼šå†™ä¸šåŠ¡é€»è¾‘ã€ç›´æ¥æ“ä½œæ•°æ®åº“
```

**Serviceå±‚ï¼ˆä¸šåŠ¡å±‚ï¼‰**
```
ä½œç”¨ï¼šå¤„ç†å…·ä½“çš„ä¸šåŠ¡é€»è¾‘
æ¯”å–»ï¼šå°±åƒé¤å…å¨å¸ˆï¼ŒæŒ‰ç…§èœè°±åšèœ

èŒè´£ï¼š
âœ… ç¼–å†™ä¸šåŠ¡é€»è¾‘
âœ… äº‹åŠ¡ç®¡ç†
âœ… è°ƒç”¨Mapperæ“ä½œæ•°æ®
âœ… æ•°æ®ç»„è£…å’Œè½¬æ¢

âŒ ä¸åº”è¯¥ï¼šæ¥æ”¶HTTPè¯·æ±‚ã€å†™SQLè¯­å¥
```

**Mapperå±‚ï¼ˆæ•°æ®è®¿é—®ï¼‰**
```
ä½œç”¨ï¼šè´Ÿè´£ä¸æ•°æ®åº“äº¤äº’
æ¯”å–»ï¼šå°±åƒä»“åº“ç®¡ç†å‘˜ï¼Œè´Ÿè´£å­˜å–è´§ç‰©

èŒè´£ï¼š
âœ… å®šä¹‰SQLæ“ä½œæ–¹æ³•
âœ… å‚æ•°æ˜ å°„
âœ… ç»“æœæ˜ å°„

âŒ ä¸åº”è¯¥ï¼šå†™ä¸šåŠ¡é€»è¾‘ã€å¤„ç†äº‹åŠ¡
```

### 2.3 åŒ…å‘½åè§„èŒƒ



```
âœ… æ¨èå‘½åï¼š
com.å…¬å¸å.é¡¹ç›®å.æ¨¡å—å

ç¤ºä¾‹ï¼š
com.example.shop.user      ï¼ˆç”¨æˆ·æ¨¡å—ï¼‰
com.example.shop.order     ï¼ˆè®¢å•æ¨¡å—ï¼‰
com.example.shop.product   ï¼ˆå•†å“æ¨¡å—ï¼‰

âŒ é”™è¯¯å‘½åï¼š
com.test                   ï¼ˆå¤ªç®€å•ï¼‰
org.my.project.hello       ï¼ˆå±‚æ¬¡æ··ä¹±ï¼‰
```

---

## 3. ğŸ·ï¸ å‘½åè§„åˆ™çº¦å®š



### 3.1 å®ä½“ç±»å‘½å



**åŸºæœ¬è§„åˆ™**ï¼šä½¿ç”¨åè¯ï¼Œé¦–å­—æ¯å¤§å†™ï¼Œé©¼å³°å‘½å

```java
// âœ… æ­£ç¡®ç¤ºä¾‹
public class User {              // ç”¨æˆ·å®ä½“
    private Long userId;          // ç”¨æˆ·ID
    private String userName;      // ç”¨æˆ·å
    private Date createTime;      // åˆ›å»ºæ—¶é—´
}

public class OrderInfo {          // è®¢å•ä¿¡æ¯
    private Long orderId;
    private BigDecimal orderAmount;
}

// âŒ é”™è¯¯ç¤ºä¾‹
public class user {               // é¦–å­—æ¯åº”å¤§å†™
public class UserData {           // ä¸è¦åŠ Dataåç¼€
public class T_User {             // ä¸è¦åŠ ä¸‹åˆ’çº¿
```

> ğŸ’¡ **å‘½åæŠ€å·§**  
> å®ä½“ç±»åå¯¹åº”æ•°æ®åº“è¡¨åï¼Œå±æ€§åå¯¹åº”å­—æ®µåï¼ˆé©¼å³°è½¬ä¸‹åˆ’çº¿ï¼‰

### 3.2 Mapperæ¥å£å‘½å



**åŸºæœ¬è§„åˆ™**ï¼šå®ä½“å + Mapper

```java
// âœ… æ­£ç¡®ç¤ºä¾‹
public interface UserMapper {
    User selectById(Long id);
    int insert(User user);
    int updateById(User user);
    int deleteById(Long id);
}

public interface OrderMapper {
    // è®¢å•ç›¸å…³æ“ä½œ
}

// âŒ é”™è¯¯ç¤ºä¾‹
public interface UserDao {         // åº”è¯¥ç”¨Mapperåç¼€
public interface IUserMapper {     // ä¸è¦åŠ Iå‰ç¼€
public interface UserMapperImpl {  // æ¥å£ä¸åŠ Impl
```

### 3.3 æ–¹æ³•å‘½åè§„èŒƒ



**CRUDæ“ä½œå‘½å**

| æ“ä½œç±»å‹ | **æ–¹æ³•å‰ç¼€** | **ç¤ºä¾‹** | **è¯´æ˜** |
|---------|-----------|---------|---------|
| ğŸ” **æŸ¥è¯¢å•ä¸ª** | `select`/`get`/`find` | `selectById(Long id)` | `æ ¹æ®IDæŸ¥è¯¢` |
| ğŸ“‹ **æŸ¥è¯¢åˆ—è¡¨** | `selectList`/`list` | `selectListByStatus(Integer status)` | `æ¡ä»¶æŸ¥è¯¢åˆ—è¡¨` |
| â• **æ–°å¢** | `insert`/`add`/`save` | `insert(User user)` | `æ’å…¥è®°å½•` |
| âœï¸ **ä¿®æ”¹** | `update`/`modify` | `updateById(User user)` | `æ›´æ–°è®°å½•` |
| âŒ **åˆ é™¤** | `delete`/`remove` | `deleteById(Long id)` | `åˆ é™¤è®°å½•` |
| ğŸ”¢ **ç»Ÿè®¡** | `count` | `countByStatus(Integer status)` | `ç»Ÿè®¡æ•°é‡` |

**å¤æ‚æŸ¥è¯¢å‘½åç¤ºä¾‹**
```java
// æŒ‰æ¡ä»¶æŸ¥è¯¢
List<User> selectByCondition(UserQuery query);

// åˆ†é¡µæŸ¥è¯¢
List<User> selectPageList(Integer pageNum, Integer pageSize);

// æ‰¹é‡æ“ä½œ
int insertBatch(List<User> users);
int deleteBatch(List<Long> ids);

// å…³è”æŸ¥è¯¢
User selectWithDetails(Long id);
List<Order> selectOrdersWithItems(Long orderId);
```

### 3.4 å˜é‡å‘½åè§„èŒƒ



```java
// âœ… æ­£ç¡®çš„å˜é‡å‘½å
Long userId;                 // ç”¨æˆ·ID
String userName;             // ç”¨æˆ·å
List<User> userList;         // ç”¨æˆ·åˆ—è¡¨
Map<Long, User> userMap;     // ç”¨æˆ·æ˜ å°„

// å¸ƒå°”ç±»å‹ç”¨is/haså¼€å¤´
Boolean isActive;            // æ˜¯å¦æ¿€æ´»
Boolean hasPermission;       // æ˜¯å¦æœ‰æƒé™

// å¸¸é‡å…¨å¤§å†™ï¼Œä¸‹åˆ’çº¿åˆ†éš”
public static final Integer MAX_PAGE_SIZE = 100;
public static final String DEFAULT_STATUS = "ACTIVE";

// âŒ é”™è¯¯çš„å‘½å
String s;                    // å¤ªç®€çŸ­
List list1;                  // æ— æ„ä¹‰çš„æ•°å­—
Map m;                       // ç¼©å†™ä¸æ¸…æ™°
Boolean flag;                // ä¸çŸ¥é“è¡¨ç¤ºä»€ä¹ˆ
```

---

## 4. ğŸ“„ Mapperæ–‡ä»¶è§„èŒƒ



### 4.1 æ–‡ä»¶ç»„ç»‡ç»“æ„



**Mapper XMLæ–‡ä»¶å¤´éƒ¨è§„èŒƒ**

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- namespaceå¿…é¡»æ˜¯å¯¹åº”Mapperæ¥å£çš„å…¨é™å®šå -->
<mapper namespace="com.example.mapper.UserMapper">
    
    <!-- 1. resultMapå®šä¹‰åŒº -->
    <!-- 2. sqlç‰‡æ®µå®šä¹‰åŒº -->
    <!-- 3. å¢åˆ æ”¹æŸ¥è¯­å¥åŒº -->
    
</mapper>
```

### 4.2 ResultMapè§„èŒƒ



**åŸºç¡€æ˜ å°„**
```xml
<!-- åŸºç¡€ç»“æœæ˜ å°„ï¼šå­—æ®µåä¸å±æ€§åä¸ä¸€è‡´æ—¶ä½¿ç”¨ -->
<resultMap id="BaseResultMap" type="User">
    <!-- ä¸»é”®æ˜ å°„ -->
    <id column="user_id" property="userId"/>
    
    <!-- æ™®é€šå­—æ®µæ˜ å°„ -->
    <result column="user_name" property="userName"/>
    <result column="email" property="email"/>
    <result column="create_time" property="createTime"/>
</resultMap>
```

**å…³è”æ˜ å°„**
```xml
<!-- ä¸€å¯¹ä¸€å…³è”ï¼šç”¨æˆ·å’Œç”¨æˆ·è¯¦æƒ… -->
<resultMap id="UserWithDetailMap" type="User">
    <id column="user_id" property="userId"/>
    <result column="user_name" property="userName"/>
    
    <!-- associationï¼šä¸€å¯¹ä¸€å…³è” -->
    <association property="userDetail" javaType="UserDetail">
        <id column="detail_id" property="detailId"/>
        <result column="address" property="address"/>
        <result column="phone" property="phone"/>
    </association>
</resultMap>

<!-- ä¸€å¯¹å¤šå…³è”ï¼šè®¢å•å’Œè®¢å•é¡¹ -->
<resultMap id="OrderWithItemsMap" type="Order">
    <id column="order_id" property="orderId"/>
    <result column="order_no" property="orderNo"/>
    
    <!-- collectionï¼šä¸€å¯¹å¤šå…³è” -->
    <collection property="orderItems" ofType="OrderItem">
        <id column="item_id" property="itemId"/>
        <result column="product_name" property="productName"/>
        <result column="quantity" property="quantity"/>
    </collection>
</resultMap>
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**  
> ResultMapçš„idè¦è§åçŸ¥æ„ï¼Œå…³è”æŸ¥è¯¢å¯èƒ½å½±å“æ€§èƒ½ï¼Œè°¨æ…ä½¿ç”¨

### 4.3 SQLç‰‡æ®µè§„èŒƒ



**é€šç”¨å­—æ®µå®šä¹‰**
```xml
<!-- åŸºç¡€å­—æ®µåˆ—è¡¨ -->
<sql id="Base_Column_List">
    user_id, user_name, email, phone, 
    status, create_time, update_time
</sql>

<!-- æ¡ä»¶æŸ¥è¯¢å­—æ®µ -->
<sql id="Query_Where_Clause">
    <where>
        <if test="userName != null and userName != ''">
            AND user_name LIKE CONCAT('%', #{userName}, '%')
        </if>
        <if test="status != null">
            AND status = #{status}
        </if>
        <if test="startTime != null">
            AND create_time &gt;= #{startTime}
        </if>
        <if test="endTime != null">
            AND create_time &lt;= #{endTime}
        </if>
    </where>
</sql>

<!-- ä½¿ç”¨sqlç‰‡æ®µ -->
<select id="selectByCondition" resultMap="BaseResultMap">
    SELECT 
        <include refid="Base_Column_List"/>
    FROM user
    <include refid="Query_Where_Clause"/>
    ORDER BY create_time DESC
</select>
```

> ğŸ’¡ **æœ€ä½³å®è·µ**  
> SQLç‰‡æ®µæé«˜å¤ç”¨æ€§ï¼Œä½†ä¸è¦è¿‡åº¦æ‹†åˆ†ï¼Œä¿æŒå¯è¯»æ€§

### 4.4 è¯­å¥æ ‡ç­¾è§„èŒƒ



**æŸ¥è¯¢è¯­å¥**
```xml
<!-- å•ä¸ªæŸ¥è¯¢ï¼šä½¿ç”¨resultMapæˆ–resultType -->
<select id="selectById" resultMap="BaseResultMap">
    SELECT 
        <include refid="Base_Column_List"/>
    FROM user
    WHERE user_id = #{userId}
</select>

<!-- åˆ—è¡¨æŸ¥è¯¢ï¼šè¿”å›List -->
<select id="selectList" resultMap="BaseResultMap">
    SELECT 
        <include refid="Base_Column_List"/>
    FROM user
    WHERE status = #{status}
    ORDER BY create_time DESC
</select>
```

**æ’å…¥è¯­å¥**
```xml
<!-- æ’å…¥å¹¶è¿”å›ä¸»é”® -->
<insert id="insert" useGeneratedKeys="true" keyProperty="userId">
    INSERT INTO user (
        user_name, email, phone, status, create_time
    ) VALUES (
#        #{userName}, #{email}, #{phone}, #{status}, NOW()
    )
</insert>

<!-- æ‰¹é‡æ’å…¥ -->
<insert id="insertBatch">
    INSERT INTO user (user_name, email, status)
    VALUES
    <foreach collection="list" item="user" separator=",">
        (#{user.userName}, #{user.email}, #{user.status})
    </foreach>
</insert>
```

**æ›´æ–°å’Œåˆ é™¤è¯­å¥**
```xml
<!-- é€‰æ‹©æ€§æ›´æ–°ï¼šåªæ›´æ–°éç©ºå­—æ®µ -->
<update id="updateSelective">
    UPDATE user
    <set>
        <if test="userName != null">user_name = #{userName},</if>
        <if test="email != null">email = #{email},</if>
        <if test="status != null">status = #{status},</if>
        update_time = NOW()
    </set>
    WHERE user_id = #{userId}
</update>

<!-- é€»è¾‘åˆ é™¤ -->
<update id="deleteById">
    UPDATE user 
    SET status = 0, update_time = NOW()
    WHERE user_id = #{userId}
</update>
```

---

## 5. ğŸ’¾ SQLç¼–å†™è§„èŒƒ



### 5.1 SQLæ ¼å¼åŒ–è§„èŒƒ



**åŸºæœ¬æ ¼å¼è¦æ±‚**

```xml
<!-- âœ… æ¨èï¼šæ ¼å¼æ¸…æ™°ï¼Œæ˜“äºé˜…è¯» -->
<select id="selectUserOrders" resultMap="OrderMap">
    SELECT 
        o.order_id,
        o.order_no,
        o.total_amount,
        u.user_name,
        u.email
    FROM orders o
    LEFT JOIN user u ON o.user_id = u.user_id
    WHERE o.status = #{status}
        AND o.create_time >= #{startTime}
    ORDER BY o.create_time DESC
    LIMIT #{offset}, #{limit}
</select>

<!-- âŒ ä¸æ¨èï¼šæ ¼å¼æ··ä¹±ï¼Œéš¾ä»¥é˜…è¯» -->
<select id="selectUserOrders" resultMap="OrderMap">
SELECT o.order_id,o.order_no,o.total_amount,u.user_name FROM orders o LEFT JOIN user u ON o.user_id=u.user_id WHERE o.status=#{status} AND o.create_time>=#{startTime} ORDER BY o.create_time DESC
</select>
```

> ğŸ¯ **æ ¼å¼åŒ–åŸåˆ™**  
> å…³é”®å­—å¤§å†™ã€å­—æ®µåˆ†è¡Œã€é€»è¾‘ç¼©è¿›ã€æ¡ä»¶å¯¹é½

### 5.2 æ€§èƒ½ä¼˜åŒ–è§„èŒƒ



**é¿å…å…¨è¡¨æ‰«æ**
```xml
<!-- âœ… æ­£ç¡®ï¼šä½¿ç”¨ç´¢å¼•å­—æ®µ -->
<select id="selectByUserId" resultMap="BaseResultMap">
    SELECT * FROM user
    WHERE user_id = #{userId}  <!-- user_idæ˜¯ä¸»é”®ï¼Œæœ‰ç´¢å¼• -->
</select>

<!-- âŒ é”™è¯¯ï¼šæ¨¡ç³ŠæŸ¥è¯¢å‰ç¼€é€šé… -->
<select id="selectByName" resultMap="BaseResultMap">
    SELECT * FROM user
    WHERE user_name LIKE '%${name}%'  <!-- å‰ç¼€%å¯¼è‡´ç´¢å¼•å¤±æ•ˆ -->
</select>

<!-- âœ… æ”¹è¿›ï¼šåç¼€æ¨¡ç³ŠæŸ¥è¯¢ -->
<select id="selectByName" resultMap="BaseResultMap">
    SELECT * FROM user
    WHERE user_name LIKE CONCAT(#{name}, '%')  <!-- å¯ä»¥ä½¿ç”¨ç´¢å¼• -->
</select>
```

**æŸ¥è¯¢å­—æ®µæ˜ç¡®åŒ–**
```xml
<!-- âœ… æ¨èï¼šæ˜ç¡®åˆ—å‡ºéœ€è¦çš„å­—æ®µ -->
<select id="selectUserInfo" resultType="User">
    SELECT 
        user_id,
        user_name,
        email
    FROM user
    WHERE user_id = #{userId}
</select>

<!-- âŒ ä¸æ¨èï¼šä½¿ç”¨SELECT * -->
<select id="selectUserInfo" resultType="User">
    SELECT * FROM user  <!-- æŸ¥è¯¢äº†ä¸éœ€è¦çš„å­—æ®µï¼Œæµªè´¹èµ„æº -->
    WHERE user_id = #{userId}
</select>
```

**åˆ†é¡µæŸ¥è¯¢è§„èŒƒ**
```xml
<!-- ä½¿ç”¨LIMITåˆ†é¡µ -->
<select id="selectPageList" resultMap="BaseResultMap">
    SELECT 
        <include refid="Base_Column_List"/>
    FROM user
    WHERE status = 1
    ORDER BY create_time DESC
    LIMIT #{offset}, #{pageSize}
</select>

<!-- å¤§æ•°æ®é‡åˆ†é¡µä¼˜åŒ–ï¼šä½¿ç”¨å­æŸ¥è¯¢ -->
<select id="selectLargePageList" resultMap="BaseResultMap">
    SELECT 
        <include refid="Base_Column_List"/>
    FROM user
    WHERE user_id >= (
        SELECT user_id 
        FROM user 
        WHERE status = 1
        ORDER BY user_id 
        LIMIT #{offset}, 1
    )
    AND status = 1
    ORDER BY user_id
    LIMIT #{pageSize}
</select>
```

### 5.3 åŠ¨æ€SQLè§„èŒƒ



**ifæ ‡ç­¾ä½¿ç”¨**
```xml
<!-- æ¡ä»¶åˆ¤æ–­è¦å®Œæ•´ -->
<select id="selectByCondition" resultMap="BaseResultMap">
    SELECT * FROM user
    <where>
        <!-- âœ… å®Œæ•´çš„ç©ºå€¼åˆ¤æ–­ -->
        <if test="userName != null and userName != ''">
            AND user_name = #{userName}
        </if>
        
        <!-- æ•°å­—ç±»å‹åˆ¤æ–­ -->
        <if test="status != null">
            AND status = #{status}
        </if>
        
        <!-- é›†åˆåˆ¤æ–­ -->
        <if test="userIds != null and userIds.size() > 0">
            AND user_id IN
            <foreach collection="userIds" item="id" open="(" close=")" separator=",">
#                #{id}
            </foreach>
        </if>
    </where>
</select>
```

**chooseæ ‡ç­¾ä½¿ç”¨**
```xml
<!-- å¤šæ¡ä»¶é€‰æ‹©ï¼šç±»ä¼¼Javaçš„switch -->
<select id="selectByType" resultMap="BaseResultMap">
    SELECT * FROM user
    <where>
        <choose>
            <!-- ç¬¬ä¸€ä¸ªæ¡ä»¶ -->
            <when test="type == 1">
                AND user_type = 'VIP'
            </when>
            <!-- ç¬¬äºŒä¸ªæ¡ä»¶ -->
            <when test="type == 2">
                AND user_type = 'NORMAL'
            </when>
            <!-- é»˜è®¤æ¡ä»¶ -->
            <otherwise>
                AND user_type = 'GUEST'
            </otherwise>
        </choose>
    </where>
</select>
```

### 5.4 ç‰¹æ®Šå­—ç¬¦å¤„ç†



**XMLç‰¹æ®Šå­—ç¬¦è½¬ä¹‰**

| å­—ç¬¦ | **è½¬ä¹‰å†™æ³•** | **è¯´æ˜** |
|-----|-----------|---------|
| `<` | `&lt;` | `å°äºå·` |
| `>` | `&gt;` | `å¤§äºå·` |
| `&` | `&amp;` | `ä¸ç¬¦å·` |
| `'` | `&apos;` | `å•å¼•å·` |
| `"` | `&quot;` | `åŒå¼•å·` |

```xml
<!-- æ–¹å¼1ï¼šä½¿ç”¨è½¬ä¹‰å­—ç¬¦ -->
<select id="selectByAge" resultMap="BaseResultMap">
    SELECT * FROM user
    WHERE age &gt; #{minAge}
        AND age &lt; #{maxAge}
</select>

<!-- æ–¹å¼2ï¼šä½¿ç”¨CDATAæ ‡ç­¾ï¼ˆæ¨èï¼‰ -->
<select id="selectByAge" resultMap="BaseResultMap">
    SELECT * FROM user
    <![CDATA[
        WHERE age > #{minAge}
            AND age < #{maxAge}
    ]]>
</select>
```

---

## 6. ğŸ“ æ³¨é‡Šè§„èŒƒè¦æ±‚



### 6.1 ç±»æ³¨é‡Šè§„èŒƒ



```java
/**
 * ç”¨æˆ·ä¿¡æ¯Mapperæ¥å£
 * 
 * <p>è´Ÿè´£ç”¨æˆ·è¡¨çš„æ•°æ®è®¿é—®æ“ä½œ</p>
 * 
 * @author å¼ ä¸‰
 * @date 2025-09-23
 * @version 1.0
 */
public interface UserMapper {
    // æ–¹æ³•å®šä¹‰...
}

/**
 * ç”¨æˆ·å®ä½“ç±»
 * 
 * <p>å¯¹åº”æ•°æ®åº“è¡¨ï¼šuser</p>
 * 
 * @author æå››
 * @date 2025-09-23
 */
public class User {
    // å­—æ®µå®šä¹‰...
}
```

> ğŸ’¡ **æ³¨é‡Šå†…å®¹**  
> è¯´æ˜ç±»çš„ä½œç”¨ã€å¯¹åº”çš„æ•°æ®åº“è¡¨ã€ä½œè€…å’Œæ—¥æœŸ

### 6.2 æ–¹æ³•æ³¨é‡Šè§„èŒƒ



```java
/**
 * æ ¹æ®ç”¨æˆ·IDæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯
 * 
 * @param userId ç”¨æˆ·IDï¼Œä¸èƒ½ä¸ºç©º
 * @return ç”¨æˆ·ä¿¡æ¯ï¼Œä¸å­˜åœ¨æ—¶è¿”å›null
 */
User selectById(@Param("userId") Long userId);

/**
 * åˆ†é¡µæŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨
 * 
 * @param pageNum é¡µç ï¼Œä»1å¼€å§‹
 * @param pageSize æ¯é¡µæ•°é‡ï¼Œå»ºè®®10-100
 * @return ç”¨æˆ·åˆ—è¡¨ï¼Œå¯èƒ½ä¸ºç©ºé›†åˆ
 */
List<User> selectPageList(@Param("pageNum") Integer pageNum, 
                          @Param("pageSize") Integer pageSize);

/**
 * æ‰¹é‡æ’å…¥ç”¨æˆ·
 * 
 * @param users ç”¨æˆ·åˆ—è¡¨ï¼Œä¸èƒ½ä¸ºç©º
 * @return æ’å…¥æˆåŠŸçš„è®°å½•æ•°
 * @throws IllegalArgumentException å¦‚æœåˆ—è¡¨ä¸ºç©º
 */
int insertBatch(@Param("users") List<User> users);
```

### 6.3 XMLæ³¨é‡Šè§„èŒƒ



```xml
<!-- ================================ -->
<!--        ç”¨æˆ·åŸºç¡€ä¿¡æ¯æŸ¥è¯¢           -->
<!-- ================================ -->

<!-- åŸºç¡€å­—æ®µåˆ—è¡¨ -->
<sql id="Base_Column_List">
    user_id, user_name, email, phone
</sql>

<!-- 
    æ ¹æ®ç”¨æˆ·IDæŸ¥è¯¢
    å‚æ•°ï¼šuserId - ç”¨æˆ·ID
    è¿”å›ï¼šç”¨æˆ·ä¿¡æ¯å¯¹è±¡
-->
<select id="selectById" resultMap="BaseResultMap">
    SELECT <include refid="Base_Column_List"/>
    FROM user
    WHERE user_id = #{userId}
</select>

<!-- ================================ -->
<!--        å¤æ‚æ¡ä»¶æŸ¥è¯¢              -->
<!-- ================================ -->

<!-- 
    å¤šæ¡ä»¶æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨
    åŠŸèƒ½ï¼šæ”¯æŒç”¨æˆ·åã€çŠ¶æ€ã€æ—¶é—´èŒƒå›´ç­‰æ¡ä»¶
    æ³¨æ„ï¼šæ‰€æœ‰æ¡ä»¶éƒ½æ˜¯å¯é€‰çš„
-->
<select id="selectByCondition" resultMap="BaseResultMap">
    SELECT * FROM user
    <where>
        <!-- ç”¨æˆ·åæ¨¡ç³ŠæŸ¥è¯¢ -->
        <if test="userName != null and userName != ''">
            AND user_name LIKE CONCAT('%', #{userName}, '%')
        </if>
        <!-- çŠ¶æ€ç²¾ç¡®åŒ¹é… -->
        <if test="status != null">
            AND status = #{status}
        </if>
    </where>
</select>
```

> âš ï¸ **æ³¨æ„**  
> å¤æ‚SQLè¦å†™æ¸…æ¥šé€»è¾‘ï¼Œæ–¹ä¾¿åç»­ç»´æŠ¤

### 6.4 å­—æ®µæ³¨é‡Šè§„èŒƒ



```java
/**
 * ç”¨æˆ·ä¿¡æ¯å®ä½“ç±»
 */
public class User {
    
    /** ç”¨æˆ·IDï¼ˆä¸»é”®ï¼‰ */
    private Long userId;
    
    /** ç”¨æˆ·åï¼ˆå”¯ä¸€ï¼‰ */
    private String userName;
    
    /** é‚®ç®±åœ°å€ */
    private String email;
    
    /** æ‰‹æœºå·ç  */
    private String phone;
    
    /** 
     * ç”¨æˆ·çŠ¶æ€
     * 0-ç¦ç”¨ 1-æ­£å¸¸ 2-é”å®š
     */
    private Integer status;
    
    /** åˆ›å»ºæ—¶é—´ */
    private Date createTime;
    
    /** æœ€åæ›´æ–°æ—¶é—´ */
    private Date updateTime;
}
```

---

## 7. ğŸš¨ å¼‚å¸¸å¤„ç†è§„èŒƒ



### 7.1 å¼‚å¸¸åˆ†ç±»å¤„ç†



**é€šä¿—ç†è§£**ï¼šå°±åƒçœ‹ç—…åˆ†ç§‘å®¤ï¼Œä¸åŒé—®é¢˜ç”¨ä¸åŒæ–¹æ³•å¤„ç†

```
ç³»ç»Ÿå¼‚å¸¸ï¼šç¨‹åºbugã€ç½‘ç»œä¸­æ–­ç­‰
  â†’ è®°å½•è¯¦ç»†æ—¥å¿—ï¼Œè¿”å›å‹å¥½æç¤º

ä¸šåŠ¡å¼‚å¸¸ï¼šç”¨æˆ·åé‡å¤ã€ä½™é¢ä¸è¶³ç­‰
  â†’ æ˜ç¡®æç¤ºç”¨æˆ·ï¼Œå¼•å¯¼æ“ä½œ

å‚æ•°å¼‚å¸¸ï¼šå¿…å¡«é¡¹ä¸ºç©ºã€æ ¼å¼é”™è¯¯ç­‰
  â†’ æç¤ºå…·ä½“å“ªé‡Œé”™äº†
```

### 7.2 Serviceå±‚å¼‚å¸¸å¤„ç†



```java
@Service
public class UserServiceImpl implements UserService {
    
    @Autowired
    private UserMapper userMapper;
    
    /**
     * åˆ›å»ºç”¨æˆ·
     */
    @Override
    public Long createUser(User user) {
        // 1. å‚æ•°æ ¡éªŒ
        if (user == null || user.getUserName() == null) {
            throw new IllegalArgumentException("ç”¨æˆ·ä¿¡æ¯ä¸èƒ½ä¸ºç©º");
        }
        
        // 2. ä¸šåŠ¡æ ¡éªŒï¼šç”¨æˆ·åæ˜¯å¦é‡å¤
        User existUser = userMapper.selectByUserName(user.getUserName());
        if (existUser != null) {
            throw new BusinessException("ç”¨æˆ·åå·²å­˜åœ¨");
        }
        
        // 3. æ‰§è¡Œæ’å…¥
        try {
            userMapper.insert(user);
            return user.getUserId();
        } catch (Exception e) {
            // è®°å½•å¼‚å¸¸æ—¥å¿—
            log.error("åˆ›å»ºç”¨æˆ·å¤±è´¥ï¼Œç”¨æˆ·åï¼š{}", user.getUserName(), e);
            throw new SystemException("ç³»ç»Ÿå¼‚å¸¸ï¼Œè¯·ç¨åé‡è¯•");
        }
    }
    
    /**
     * æ›´æ–°ç”¨æˆ·ä¿¡æ¯
     */
    @Override
    @Transactional(rollbackFor = Exception.class)
    public void updateUser(User user) {
        // 1. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨
        User dbUser = userMapper.selectById(user.getUserId());
        if (dbUser == null) {
            throw new BusinessException("ç”¨æˆ·ä¸å­˜åœ¨");
        }
        
        // 2. æ‰§è¡Œæ›´æ–°
        int rows = userMapper.updateById(user);
        if (rows == 0) {
            throw new SystemException("æ›´æ–°å¤±è´¥");
        }
    }
}
```

> ğŸ’¡ **å¼‚å¸¸å¤„ç†åŸåˆ™**  
> - æ˜ç¡®å¼‚å¸¸ç±»å‹ï¼Œä¸è¦æ•è·åä¸å¤„ç†
> - è®°å½•å…³é”®ä¿¡æ¯ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥
> - ç»™ç”¨æˆ·å‹å¥½æç¤ºï¼Œä¸æš´éœ²ç³»ç»Ÿç»†èŠ‚

### 7.3 è‡ªå®šä¹‰å¼‚å¸¸ç±»



```java
/**
 * ä¸šåŠ¡å¼‚å¸¸ï¼šç”¨æˆ·æ“ä½œé”™è¯¯
 */
public class BusinessException extends RuntimeException {
    
    private String code;  // é”™è¯¯ç 
    
    public BusinessException(String message) {
        super(message);
    }
    
    public BusinessException(String code, String message) {
        super(message);
        this.code = code;
    }
}

/**
 * ç³»ç»Ÿå¼‚å¸¸ï¼šç¨‹åºå†…éƒ¨é”™è¯¯
 */
public class SystemException extends RuntimeException {
    
    public SystemException(String message) {
        super(message);
    }
    
    public SystemException(String message, Throwable cause) {
        super(message, cause);
    }
}

/**
 * æ•°æ®è®¿é—®å¼‚å¸¸ï¼šæ•°æ®åº“æ“ä½œå¤±è´¥
 */
public class DataAccessException extends RuntimeException {
    
    public DataAccessException(String message, Throwable cause) {
        super(message, cause);
    }
}
```

### 7.4 å…¨å±€å¼‚å¸¸å¤„ç†



```java
/**
 * å…¨å±€å¼‚å¸¸å¤„ç†å™¨
 */
@RestControllerAdvice
@Slf4j
public class GlobalExceptionHandler {
    
    /**
     * ä¸šåŠ¡å¼‚å¸¸å¤„ç†
     */
    @ExceptionHandler(BusinessException.class)
    public Result handleBusinessException(BusinessException e) {
        log.warn("ä¸šåŠ¡å¼‚å¸¸ï¼š{}", e.getMessage());
        return Result.fail(e.getMessage());
    }
    
    /**
     * å‚æ•°å¼‚å¸¸å¤„ç†
     */
    @ExceptionHandler(IllegalArgumentException.class)
    public Result handleIllegalArgument(IllegalArgumentException e) {
        log.warn("å‚æ•°å¼‚å¸¸ï¼š{}", e.getMessage());
        return Result.fail("å‚æ•°é”™è¯¯ï¼š" + e.getMessage());
    }
    
    /**
     * ç³»ç»Ÿå¼‚å¸¸å¤„ç†
     */
    @ExceptionHandler(Exception.class)
    public Result handleException(Exception e) {
        log.error("ç³»ç»Ÿå¼‚å¸¸", e);
        return Result.fail("ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åé‡è¯•");
    }
}
```

---

## 8. ğŸ“Š æ—¥å¿—è®°å½•è§„èŒƒ



### 8.1 æ—¥å¿—çº§åˆ«ä½¿ç”¨



**é€šä¿—ç†è§£**ï¼šæ—¥å¿—å°±åƒè®°æ—¥è®°ï¼Œä¸åŒé‡è¦ç¨‹åº¦ç”¨ä¸åŒçº§åˆ«

```
çº§åˆ«è¯´æ˜ï¼š
ERROR   - ä¸¥é‡é”™è¯¯ï¼Œéœ€è¦ç«‹å³å¤„ç†
WARN    - è­¦å‘Šä¿¡æ¯ï¼Œå¯èƒ½æœ‰é—®é¢˜
INFO    - é‡è¦ä¿¡æ¯ï¼Œå…³é”®æ“ä½œè®°å½•
DEBUG   - è°ƒè¯•ä¿¡æ¯ï¼Œå¼€å‘æ—¶ä½¿ç”¨
TRACE   - è¯¦ç»†è¿½è¸ªï¼Œå¾ˆå°‘ä½¿ç”¨
```

**ä½¿ç”¨åœºæ™¯å¯¹ç…§è¡¨**

| çº§åˆ« | **ä½¿ç”¨åœºæ™¯** | **ç¤ºä¾‹** |
|-----|-----------|---------|
| `ERROR` | `ç³»ç»Ÿé”™è¯¯ã€å¼‚å¸¸æƒ…å†µ` | `æ•°æ®åº“è¿æ¥å¤±è´¥ã€ç©ºæŒ‡é’ˆå¼‚å¸¸` |
| `WARN` | `æ½œåœ¨é—®é¢˜ã€ä¸ç¬¦åˆé¢„æœŸ` | `ç¼“å­˜æœªå‘½ä¸­ã€å‚æ•°å¯ç–‘` |
| `INFO` | `å…³é”®æ“ä½œã€ä¸šåŠ¡æµç¨‹` | `ç”¨æˆ·ç™»å½•ã€è®¢å•åˆ›å»º` |
| `DEBUG` | `è°ƒè¯•ä¿¡æ¯ã€è¯¦ç»†è¿‡ç¨‹` | `SQLè¯­å¥ã€æ–¹æ³•å‚æ•°` |

### 8.2 æ—¥å¿—è®°å½•è§„èŒƒ



```java
@Service
@Slf4j
public class UserServiceImpl implements UserService {
    
    @Override
    public User login(String userName, String password) {
        // INFOï¼šè®°å½•å…³é”®ä¸šåŠ¡æ“ä½œ
        log.info("ç”¨æˆ·ç™»å½•ï¼Œç”¨æˆ·åï¼š{}", userName);
        
        // DEBUGï¼šè®°å½•è¯¦ç»†è°ƒè¯•ä¿¡æ¯
        log.debug("æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼ŒSQLå‚æ•°ï¼šuserName={}", userName);
        
        User user = userMapper.selectByUserName(userName);
        
        if (user == null) {
            // WARNï¼šè­¦å‘Šå¯ç–‘æ“ä½œ
            log.warn("ç™»å½•å¤±è´¥ï¼Œç”¨æˆ·ä¸å­˜åœ¨ï¼š{}", userName);
            throw new BusinessException("ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯");
        }
        
        if (!user.getPassword().equals(password)) {
            // WARNï¼šè®°å½•ç™»å½•å¤±è´¥
            log.warn("ç™»å½•å¤±è´¥ï¼Œå¯†ç é”™è¯¯ï¼Œç”¨æˆ·ï¼š{}", userName);
            throw new BusinessException("ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯");
        }
        
        // INFOï¼šè®°å½•æˆåŠŸç»“æœ
        log.info("ç”¨æˆ·ç™»å½•æˆåŠŸï¼ŒIDï¼š{}", user.getUserId());
        return user;
    }
    
    @Override
    public void createOrder(Order order) {
        try {
            // INFOï¼šè®°å½•ä¸šåŠ¡å¼€å§‹
            log.info("åˆ›å»ºè®¢å•ï¼Œç”¨æˆ·IDï¼š{}ï¼Œé‡‘é¢ï¼š{}", 
                    order.getUserId(), order.getAmount());
            
            // æ‰§è¡Œä¸šåŠ¡é€»è¾‘
            orderMapper.insert(order);
            
            // INFOï¼šè®°å½•ä¸šåŠ¡å®Œæˆ
            log.info("è®¢å•åˆ›å»ºæˆåŠŸï¼Œè®¢å•å·ï¼š{}", order.getOrderNo());
            
        } catch (Exception e) {
            // ERRORï¼šè®°å½•å¼‚å¸¸ä¿¡æ¯
            log.error("åˆ›å»ºè®¢å•å¤±è´¥ï¼Œç”¨æˆ·IDï¼š{}", order.getUserId(), e);
            throw new SystemException("è®¢å•åˆ›å»ºå¤±è´¥", e);
        }
    }
}
```

> ğŸ¯ **æ—¥å¿—è®°å½•åŸåˆ™**  
> - å…³é”®æ“ä½œå¿…é¡»è®°å½•ï¼ˆç™»å½•ã€æ”¯ä»˜ã€ä¿®æ”¹ç­‰ï¼‰
> - å¼‚å¸¸å¿…é¡»è®°å½•å®Œæ•´å †æ ˆ
> - æ•æ„Ÿä¿¡æ¯ä¸è®°å½•ï¼ˆå¯†ç ã€èº«ä»½è¯ç­‰ï¼‰
- æ—¥å¿—ä¿¡æ¯è¦æœ‰ä¸Šä¸‹æ–‡ï¼Œä¾¿äºé—®é¢˜å®šä½

### 8.3 æ—¥å¿—æ ¼å¼è§„èŒƒ



```java
// âœ… æ¨èï¼šä½¿ç”¨å ä½ç¬¦ï¼Œæ¸…æ™°æ˜äº†
log.info("ç”¨æˆ·ç™»å½•æˆåŠŸï¼Œç”¨æˆ·IDï¼š{}ï¼Œç™»å½•IPï¼š{}", userId, ip);
log.error("æŸ¥è¯¢ç”¨æˆ·å¤±è´¥ï¼ŒIDï¼š{}", userId, exception);

// âŒ ä¸æ¨èï¼šå­—ç¬¦ä¸²æ‹¼æ¥
log.info("ç”¨æˆ·ç™»å½•æˆåŠŸï¼Œç”¨æˆ·IDï¼š" + userId + "ï¼Œç™»å½•IPï¼š" + ip);

// âœ… æ¨èï¼šè®°å½•æ–¹æ³•è°ƒç”¨ä¿¡æ¯
log.debug("è°ƒç”¨æ–¹æ³•ï¼š{}ï¼Œå‚æ•°ï¼š{}", "selectById", userId);

// âœ… æ¨èï¼šè®°å½•SQLæ‰§è¡Œä¿¡æ¯
log.debug("æ‰§è¡ŒSQLï¼š{}ï¼Œå‚æ•°ï¼š{}", sql, params);

// âŒ ä¸æ¨èï¼šæ•æ„Ÿä¿¡æ¯è®°å½•
log.info("ç”¨æˆ·å¯†ç ï¼š{}", password);  // ä¸è¦è®°å½•å¯†ç 
log.info("èº«ä»½è¯å·ï¼š{}", idCard);    // ä¸è¦è®°å½•èº«ä»½è¯
```

### 8.4 MyBatis SQLæ—¥å¿—é…ç½®



**application.ymlé…ç½®**
```yaml
# MyBatisæ—¥å¿—é…ç½®

mybatis:
  configuration:
#    # å¼€å¯SQLæ—¥å¿—ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
    
# Logbackæ—¥å¿—é…ç½®

logging:
  level:
#    # Mapperæ¥å£æ—¥å¿—çº§åˆ«
    com.example.mapper: DEBUG
#    # MyBatisæ¡†æ¶æ—¥å¿—
    org.apache.ibatis: INFO
#    # SQLæ‰§è¡Œæ—¥å¿—
    org.mybatis.spring: DEBUG
```

**SQLæ—¥å¿—è¾“å‡ºç¤ºä¾‹**
```
DEBUG - ==>  Preparing: SELECT * FROM user WHERE user_id = ?
DEBUG - ==> Parameters: 123(Long)
DEBUG - <==      Total: 1
DEBUG - <==    Columns: user_id, user_name, email
DEBUG - <==        Row: 123, å¼ ä¸‰, zhangsan@example.com
```

---

## 9. ğŸ§ª æµ‹è¯•è§„èŒƒè¦æ±‚



### 9.1 å•å…ƒæµ‹è¯•è§„èŒƒ



**æµ‹è¯•ç±»å‘½å**ï¼š`è¢«æµ‹è¯•ç±»å + Test`

```java
/**
 * UserMapperå•å…ƒæµ‹è¯•
 */
@SpringBootTest
@Slf4j
public class UserMapperTest {
    
    @Autowired
    private UserMapper userMapper;
    
    /**
     * æµ‹è¯•æ–¹æ³•å‘½åï¼štest + æ–¹æ³•å + æµ‹è¯•åœºæ™¯
     */
    @Test
    public void testInsert_success() {
        // 1. å‡†å¤‡æµ‹è¯•æ•°æ®
        User user = new User();
        user.setUserName("æµ‹è¯•ç”¨æˆ·");
        user.setEmail("test@example.com");
        user.setStatus(1);
        
        // 2. æ‰§è¡Œæµ‹è¯•æ–¹æ³•
        int rows = userMapper.insert(user);
        
        // 3. éªŒè¯ç»“æœ
        assertEquals(1, rows);
        assertNotNull(user.getUserId());
        
        log.info("æ’å…¥æˆåŠŸï¼Œç”¨æˆ·IDï¼š{}", user.getUserId());
    }
    
    @Test
    public void testSelectById_exists() {
        // æŸ¥è¯¢å­˜åœ¨çš„ç”¨æˆ·
        User user = userMapper.selectById(1L);
        
        assertNotNull(user);
        assertEquals("å¼ ä¸‰", user.getUserName());
    }
    
    @Test
    public void testSelectById_notExists() {
        // æŸ¥è¯¢ä¸å­˜åœ¨çš„ç”¨æˆ·
        User user = userMapper.selectById(99999L);
        
        assertNull(user);
    }
}
```

> ğŸ’¡ **æµ‹è¯•ç¼–å†™åŸåˆ™**  
> ä¸€ä¸ªæ–¹æ³•æµ‹è¯•ä¸€ä¸ªåœºæ™¯ï¼ŒæˆåŠŸå’Œå¤±è´¥éƒ½è¦æµ‹è¯•

### 9.2 æµ‹è¯•æ•°æ®å‡†å¤‡



```java
@SpringBootTest
public class OrderMapperTest {
    
    @Autowired
    private OrderMapper orderMapper;
    
    /**
     * æ¯ä¸ªæµ‹è¯•å‰æ‰§è¡Œï¼šå‡†å¤‡æµ‹è¯•æ•°æ®
     */
    @BeforeEach
    public void setUp() {
        // æ¸…ç†æµ‹è¯•æ•°æ®
        orderMapper.deleteTestData();
        
        // æ’å…¥æµ‹è¯•æ•°æ®
        Order order = new Order();
        order.setOrderNo("TEST001");
        order.setUserId(1L);
        order.setAmount(new BigDecimal("100.00"));
        orderMapper.insert(order);
    }
    
    /**
     * æ¯ä¸ªæµ‹è¯•åæ‰§è¡Œï¼šæ¸…ç†æµ‹è¯•æ•°æ®
     */
    @AfterEach
    public void tearDown() {
        // åˆ é™¤æµ‹è¯•æ•°æ®
        orderMapper.deleteTestData();
    }
    
    @Test
    public void testSelectByOrderNo() {
        Order order = orderMapper.selectByOrderNo("TEST001");
        
        assertNotNull(order);
        assertEquals(1L, order.getUserId());
    }
}
```

### 9.3 æµ‹è¯•è¦†ç›–è¦æ±‚



**åŸºæœ¬è¦†ç›–æ ‡å‡†**

```
âœ… å¿…é¡»æµ‹è¯•çš„åœºæ™¯ï¼š
- æ­£å¸¸æµç¨‹ï¼šæ­£ç¡®å‚æ•°ï¼Œè¿”å›é¢„æœŸç»“æœ
- è¾¹ç•Œæ¡ä»¶ï¼šç©ºå€¼ã€é›¶å€¼ã€æœ€å¤§å€¼ç­‰
- å¼‚å¸¸æƒ…å†µï¼šé”™è¯¯å‚æ•°ã€æ•°æ®ä¸å­˜åœ¨ç­‰

âœ… CRUDæ“ä½œæµ‹è¯•æ¸…å•ï¼š
â–¡ insert    - æ’å…¥æˆåŠŸã€é‡å¤æ’å…¥
â–¡ update    - æ›´æ–°æˆåŠŸã€è®°å½•ä¸å­˜åœ¨
â–¡ delete    - åˆ é™¤æˆåŠŸã€è®°å½•ä¸å­˜åœ¨
â–¡ select    - æŸ¥è¯¢æˆåŠŸã€æŸ¥è¯¢ä¸ºç©º
â–¡ æ‰¹é‡æ“ä½œ  - æ‰¹é‡æˆåŠŸã€éƒ¨åˆ†å¤±è´¥
â–¡ æ¡ä»¶æŸ¥è¯¢  - å¤šæ¡ä»¶ç»„åˆã€ç©ºæ¡ä»¶
```

**ç¤ºä¾‹ï¼šå®Œæ•´æµ‹è¯•åœºæ™¯**
```java
@Test
public void testUpdateUser() {
    // åœºæ™¯1ï¼šæ­£å¸¸æ›´æ–°
    User user = new User();
    user.setUserId(1L);
    user.setUserName("æ–°åå­—");
    int rows = userMapper.updateById(user);
    assertEquals(1, rows);
    
    // åœºæ™¯2ï¼šç”¨æˆ·ä¸å­˜åœ¨
    user.setUserId(99999L);
    rows = userMapper.updateById(user);
    assertEquals(0, rows);
    
    // åœºæ™¯3ï¼šç©ºå‚æ•°
    assertThrows(Exception.class, () -> {
        userMapper.updateById(null);
    });
}
```

---

## 10. ğŸ” ä»£ç å®¡æŸ¥æ ‡å‡†



### 10.1 å®¡æŸ¥æ¸…å•



**åŠŸèƒ½æ­£ç¡®æ€§å®¡æŸ¥**
```
âœ… åŠŸèƒ½æ£€æŸ¥ï¼š
â–¡ ä¸šåŠ¡é€»è¾‘æ˜¯å¦æ­£ç¡®
â–¡ è¾¹ç•Œæ¡ä»¶æ˜¯å¦å¤„ç†
â–¡ å¼‚å¸¸æƒ…å†µæ˜¯å¦è€ƒè™‘
â–¡ æ•°æ®ä¸€è‡´æ€§æ˜¯å¦ä¿è¯

âœ… SQLæ£€æŸ¥ï¼š
â–¡ SQLè¯­å¥æ˜¯å¦æ­£ç¡®
â–¡ æ˜¯å¦ä½¿ç”¨äº†ç´¢å¼•
â–¡ æ˜¯å¦æœ‰SQLæ³¨å…¥é£é™©
â–¡ æ˜¯å¦æœ‰æ€§èƒ½é—®é¢˜
```

**ä»£ç è§„èŒƒå®¡æŸ¥**
```
âœ… å‘½åè§„èŒƒï¼š
â–¡ ç±»åã€æ–¹æ³•åæ˜¯å¦è§„èŒƒ
â–¡ å˜é‡åæ˜¯å¦æœ‰æ„ä¹‰
â–¡ å¸¸é‡æ˜¯å¦å¤§å†™

âœ… æ³¨é‡Šè§„èŒƒï¼š
â–¡ ç±»æ³¨é‡Šæ˜¯å¦å®Œæ•´
â–¡ æ–¹æ³•æ³¨é‡Šæ˜¯å¦æ¸…æ¥š
â–¡ å¤æ‚é€»è¾‘æ˜¯å¦æœ‰è¯´æ˜

âœ… æ ¼å¼è§„èŒƒï¼š
â–¡ ç¼©è¿›æ˜¯å¦ç»Ÿä¸€
â–¡ ä»£ç æ˜¯å¦æ•´æ´
â–¡ æ˜¯å¦æœ‰æ— ç”¨ä»£ç 
```

### 10.2 å¸¸è§é—®é¢˜æ£€æŸ¥



**SQLç›¸å…³é—®é¢˜**
```java
// âŒ é—®é¢˜1ï¼šSQLæ³¨å…¥é£é™©
<select id="selectByName">
    SELECT * FROM user 
    WHERE user_name = '${userName}'  <!-- ä¸å®‰å…¨ï¼ -->
</select>

// âœ… æ­£ç¡®ï¼šä½¿ç”¨#{}
<select id="selectByName">
    SELECT * FROM user 
    WHERE user_name = #{userName}
</select>

// âŒ é—®é¢˜2ï¼šN+1æŸ¥è¯¢é—®é¢˜
public List<OrderVO> getOrders() {
    List<Order> orders = orderMapper.selectAll();
    for (Order order : orders) {
        // æ¯æ¬¡å¾ªç¯éƒ½æŸ¥è¯¢ä¸€æ¬¡ï¼Œæ€§èƒ½å·®
        List<OrderItem> items = orderItemMapper.selectByOrderId(order.getId());
        order.setItems(items);
    }
    return orders;
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨å…³è”æŸ¥è¯¢
<select id="selectOrdersWithItems" resultMap="OrderWithItemsMap">
    SELECT 
        o.*, 
        i.*
    FROM orders o
    LEFT JOIN order_item i ON o.order_id = i.order_id
</select>
```

**äº‹åŠ¡ç›¸å…³é—®é¢˜**
```java
// âŒ é—®é¢˜ï¼šäº‹åŠ¡èŒƒå›´ä¸å½“
@Transactional
public void processOrder(Order order) {
    // é•¿æ—¶é—´æ“ä½œï¼Œå ç”¨è¿æ¥
    orderMapper.insert(order);
    
    // è°ƒç”¨å¤–éƒ¨æœåŠ¡ï¼Œå¯èƒ½å¾ˆæ…¢
    paymentService.pay(order);  
    
    // å‘é€é‚®ä»¶ï¼Œå¯èƒ½å¤±è´¥
    emailService.send(order);
}

// âœ… æ­£ç¡®ï¼šäº‹åŠ¡åªåŒ…å«æ•°æ®åº“æ“ä½œ
@Transactional
public void saveOrder(Order order) {
    orderMapper.insert(order);
    orderDetailMapper.insertBatch(order.getDetails());
}

public void processOrder(Order order) {
    // äº‹åŠ¡æ–¹æ³•
    saveOrder(order);
    
    // éäº‹åŠ¡æ“ä½œ
    try {
        paymentService.pay(order);
        emailService.send(order);
    } catch (Exception e) {
        log.error("åç»­å¤„ç†å¤±è´¥", e);
    }
}
```

### 10.3 å®¡æŸ¥å·¥å…·ä½¿ç”¨



**ä»£ç æ£€æŸ¥å·¥å…·**
```
æ¨èå·¥å…·ï¼š
- SonarQube     â†’ ä»£ç è´¨é‡åˆ†æ
- Alibaba Code Guidelines  â†’ é˜¿é‡Œå·´å·´è§„èŒƒæ£€æŸ¥  
- PMD           â†’ ä»£ç ç¼ºé™·æ£€æµ‹
- FindBugs      â†’ BugæŸ¥æ‰¾å·¥å…·
```

**ä½¿ç”¨ç¤ºä¾‹**
```xml
<!-- Mavenæ’ä»¶é…ç½® -->
<plugin>
    <groupId>org.sonarsource.scanner.maven</groupId>
    <artifactId>sonar-maven-plugin</artifactId>
    <version>3.9.1</version>
</plugin>

<!-- æ‰§è¡Œæ£€æŸ¥ -->
mvn sonar:sonar
```

---

## 11. ğŸ“– æ–‡æ¡£ç¼–å†™è§„èŒƒ



### 11.1 æ¥å£æ–‡æ¡£è§„èŒƒ



**Mapperæ¥å£æ–‡æ¡£æ¨¡æ¿**

```java
/**
 * ç”¨æˆ·ä¿¡æ¯æ•°æ®è®¿é—®æ¥å£
 * 
 * <p>æä¾›ç”¨æˆ·ä¿¡æ¯çš„å¢åˆ æ”¹æŸ¥æ“ä½œ</p>
 * 
 * <h3>åŠŸèƒ½åˆ—è¡¨ï¼š</h3>
 * <ul>
 *   <li>ç”¨æˆ·æŸ¥è¯¢ï¼šæ”¯æŒIDæŸ¥è¯¢ã€æ¡ä»¶æŸ¥è¯¢ã€åˆ†é¡µæŸ¥è¯¢</li>
 *   <li>ç”¨æˆ·æ–°å¢ï¼šå•ä¸ªæ–°å¢ã€æ‰¹é‡æ–°å¢</li>
 *   <li>ç”¨æˆ·ä¿®æ”¹ï¼šå…¨é‡æ›´æ–°ã€é€‰æ‹©æ›´æ–°</li>
 *   <li>ç”¨æˆ·åˆ é™¤ï¼šé€»è¾‘åˆ é™¤</li>
 * </ul>
 * 
 * <h3>æ³¨æ„äº‹é¡¹ï¼š</h3>
 * <ul>
 *   <li>åˆ é™¤æ“ä½œä¸ºé€»è¾‘åˆ é™¤ï¼Œä¸ç‰©ç†åˆ é™¤æ•°æ®</li>
 *   <li>ç”¨æˆ·åå¿…é¡»å”¯ä¸€</li>
 *   <li>åˆ†é¡µæŸ¥è¯¢æœ€å¤§æ”¯æŒ100æ¡/é¡µ</li>
 * </ul>
 * 
 * @author å¼€å‘è€…å§“å
 * @date 2025-09-23
 * @version 1.0
 * @see User
 */
public interface UserMapper {
    // æ–¹æ³•å®šä¹‰...
}
```

### 11.2 SQLæ–‡æ¡£è§„èŒƒ



**å¤æ‚SQLè¯´æ˜æ–‡æ¡£**

```xml
<!-- 
========================================
åŠŸèƒ½ï¼šç”¨æˆ·è®¢å•ç»Ÿè®¡æŸ¥è¯¢
è¯´æ˜ï¼šæŸ¥è¯¢æ¯ä¸ªç”¨æˆ·çš„è®¢å•æ•°é‡ã€æ€»é‡‘é¢ç­‰ç»Ÿè®¡ä¿¡æ¯
å‚æ•°ï¼š
  - startTime: å¼€å§‹æ—¶é—´ï¼ˆå¯é€‰ï¼‰
  - endTime: ç»“æŸæ—¶é—´ï¼ˆå¯é€‰ï¼‰
  - userIds: ç”¨æˆ·IDåˆ—è¡¨ï¼ˆå¯é€‰ï¼‰
è¿”å›ï¼š
  - userId: ç”¨æˆ·ID
  - orderCount: è®¢å•æ•°é‡
  - totalAmount: è®¢å•æ€»é‡‘é¢
  - avgAmount: å¹³å‡è®¢å•é‡‘é¢
æ€§èƒ½ï¼š
  - ä½¿ç”¨äº†user_idå’Œcreate_timeç´¢å¼•
  - å»ºè®®æ—¶é—´èŒƒå›´ä¸è¶…è¿‡1å¹´
  - ç”¨æˆ·æ•°é‡ä¸è¶…è¿‡1000
æ›´æ–°è®°å½•ï¼š
  - 2025-09-20: åˆå§‹ç‰ˆæœ¬
  - 2025-09-23: å¢åŠ å¹³å‡é‡‘é¢ç»Ÿè®¡
========================================
-->
<select id="selectUserOrderStats" resultType="UserOrderStats">
    SELECT 
        u.user_id,
        COUNT(o.order_id) as order_count,
        COALESCE(SUM(o.total_amount), 0) as total_amount,
        COALESCE(AVG(o.total_amount), 0) as avg_amount
    FROM user u
    LEFT JOIN orders o ON u.user_id = o.user_id
    <where>
        <if test="startTime != null">
            AND o.create_time >= #{startTime}
        </if>
        <if test="endTime != null">
            AND o.create_time &lt;= #{endTime}
        </if>
        <if test="userIds != null and userIds.size() > 0">
            AND u.user_id IN
            <foreach collection="userIds" item="id" open="(" close=")" separator=",">
#                #{id}
            </foreach>
        </if>
    </where>
    GROUP BY u.user_id
    ORDER BY total_amount DESC
</select>
```

### 11.3 å˜æ›´è®°å½•æ–‡æ¡£



**CHANGELOG.mdç¤ºä¾‹**

```markdown
# å˜æ›´è®°å½•


# [1.2.0] - 2025-09-23



## æ–°å¢


- æ–°å¢ç”¨æˆ·æ‰¹é‡å¯¼å…¥åŠŸèƒ½
- æ–°å¢è®¢å•ç»Ÿè®¡æŸ¥è¯¢æ¥å£

## ä¿®æ”¹


- ä¼˜åŒ–ç”¨æˆ·æŸ¥è¯¢æ€§èƒ½ï¼Œæ·»åŠ ç´¢å¼•
- ä¿®æ”¹è®¢å•çŠ¶æ€æšä¸¾å€¼

## ä¿®å¤


- ä¿®å¤åˆ†é¡µæŸ¥è¯¢æ€»æ•°ä¸å‡†ç¡®çš„é—®é¢˜
- ä¿®å¤æ‰¹é‡åˆ é™¤äº‹åŠ¡å›æ»šå¤±è´¥

## åºŸå¼ƒ


- åºŸå¼ƒæ—§ç‰ˆç”¨æˆ·æŸ¥è¯¢æ¥å£ï¼ˆv1.0ï¼‰

# [1.1.0] - 2025-09-15



## æ–°å¢


- æ–°å¢ç”¨æˆ·è§’è‰²å…³è”æŸ¥è¯¢
- æ–°å¢è®¢å•è¯¦æƒ…å…³è”æŸ¥è¯¢
```

### 11.4 æ•°æ®åº“æ–‡æ¡£è§„èŒƒ



**è¡¨ç»“æ„æ–‡æ¡£**

```markdown
# ç”¨æˆ·è¡¨ï¼ˆuserï¼‰


# è¡¨è¯´æ˜


å­˜å‚¨ç³»ç»Ÿç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯

# å­—æ®µè¯´æ˜



| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸ç©º | é»˜è®¤å€¼ | è¯´æ˜ | å¤‡æ³¨ |
|-------|------|-----|-------|--------|------|------|
| user_id | BIGINT | - | å¦ | è‡ªå¢ | ç”¨æˆ·ID | ä¸»é”® |
| user_name | VARCHAR | 50 | å¦ | - | ç”¨æˆ·å | å”¯ä¸€ç´¢å¼• |
| email | VARCHAR | 100 | æ˜¯ | - | é‚®ç®± | - |
| phone | VARCHAR | 20 | æ˜¯ | - | æ‰‹æœºå· | - |
| status | TINYINT | - | å¦ | 1 | çŠ¶æ€ | 0-ç¦ç”¨ 1-æ­£å¸¸ |
| create_time | DATETIME | - | å¦ | NOW() | åˆ›å»ºæ—¶é—´ | - |
| update_time | DATETIME | - | å¦ | NOW() | æ›´æ–°æ—¶é—´ | è‡ªåŠ¨æ›´æ–° |

# ç´¢å¼•è¯´æ˜



| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|-------|------|------|------|
| PRIMARY | ä¸»é”® | user_id | - |
| uk_user_name | å”¯ä¸€ | user_name | ç”¨æˆ·åå”¯ä¸€ |
| idx_status | æ™®é€š | status | çŠ¶æ€æŸ¥è¯¢ |
| idx_create_time | æ™®é€š | create_time | æ—¶é—´èŒƒå›´æŸ¥è¯¢ |

# ä½¿ç”¨è¯´æ˜


- ç”¨æˆ·åå¿…é¡»å”¯ä¸€
- åˆ é™¤ä¸ºé€»è¾‘åˆ é™¤ï¼ˆstatus=0ï¼‰
- create_timeå’Œupdate_timeè‡ªåŠ¨ç»´æŠ¤
```

---

## 12. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“



### 12.1 å¿…é¡»æŒæ¡çš„è§„èŒƒè¦ç‚¹



> ğŸ¯ **é¡¹ç›®ç»“æ„è§„èŒƒ**  
> åˆ†å±‚æ¸…æ™°ï¼šControlleræ¥æ”¶è¯·æ±‚ â†’ Serviceå¤„ç†ä¸šåŠ¡ â†’ Mapperè®¿é—®æ•°æ®  
> åŒ…å‘½åè§„èŒƒï¼šcom.å…¬å¸.é¡¹ç›®.æ¨¡å—ï¼Œå±‚æ¬¡åˆ†æ˜

> ğŸ·ï¸ **å‘½åè§„åˆ™çº¦å®š**  
> å®ä½“ç±»ï¼šé¦–å­—æ¯å¤§å†™é©¼å³°ï¼Œå¯¹åº”è¡¨å  
> Mapperæ¥å£ï¼šå®ä½“å+Mapper  
> æ–¹æ³•å‘½åï¼šselect/insert/update/delete + æè¿°

> ğŸ“„ **Mapperæ–‡ä»¶è§„èŒƒ**  
> namespaceå¿…é¡»æ˜¯æ¥å£å…¨é™å®šå  
> ä½¿ç”¨ResultMapå¤„ç†å¤æ‚æ˜ å°„  
> SQLç‰‡æ®µæé«˜å¤ç”¨æ€§

> ğŸ’¾ **SQLç¼–å†™è§„èŒƒ**  
> å…³é”®å­—å¤§å†™ï¼Œæ ¼å¼æ¸…æ™°  
> æ˜ç¡®åˆ—å‡ºå­—æ®µï¼Œé¿å…SELECT *  
> ä½¿ç”¨#{}é˜²æ­¢SQLæ³¨å…¥  
> ç´¢å¼•å­—æ®µä½œä¸ºæŸ¥è¯¢æ¡ä»¶

> ğŸ“ **æ³¨é‡Šè§„èŒƒ**  
> ç±»ã€æ–¹æ³•éƒ½è¦æœ‰å®Œæ•´æ³¨é‡Š  
> å¤æ‚é€»è¾‘å¿…é¡»è¯´æ˜  
> å‚æ•°å’Œè¿”å›å€¼è¦æè¿°æ¸…æ¥š

> ğŸš¨ **å¼‚å¸¸å¤„ç†**  
> æ˜ç¡®å¼‚å¸¸ç±»å‹  
> è®°å½•å®Œæ•´æ—¥å¿—  
> ç»™ç”¨æˆ·å‹å¥½æç¤º

> ğŸ“Š **æ—¥å¿—è®°å½•**  
> ERRORè®°å½•é”™è¯¯  
> WARNè®°å½•è­¦å‘Š  
> INFOè®°å½•å…³é”®æ“ä½œ  
> DEBUGè®°å½•è°ƒè¯•ä¿¡æ¯

> ğŸ§ª **æµ‹è¯•è§„èŒƒ**  
> æ¯ä¸ªæ–¹æ³•éƒ½è¦æµ‹è¯•  
> æ­£å¸¸å’Œå¼‚å¸¸éƒ½è¦è¦†ç›–  
> æµ‹è¯•æ•°æ®è¦å‡†å¤‡å’Œæ¸…ç†

> ğŸ” **ä»£ç å®¡æŸ¥**  
> æ£€æŸ¥åŠŸèƒ½æ­£ç¡®æ€§  
> æ£€æŸ¥ä»£ç è§„èŒƒ  
> æ£€æŸ¥æ€§èƒ½é—®é¢˜  
> ä½¿ç”¨å·¥å…·è¾…åŠ©

> ğŸ“– **æ–‡æ¡£ç¼–å†™**  
> æ¥å£æ–‡æ¡£è¦å®Œæ•´  
> å¤æ‚SQLè¦è¯´æ˜  
> å˜æ›´è¦æœ‰è®°å½•  
> è¡¨ç»“æ„è¦ç»´æŠ¤

### 12.2 å¼€å‘è§„èŒƒæ£€æŸ¥æ¸…å•



**æ—¥å¸¸å¼€å‘æ£€æŸ¥**
```
âœ… ä»£ç æäº¤å‰ï¼š
â–¡ ä»£ç æ ¼å¼æ˜¯å¦è§„èŒƒ
â–¡ å‘½åæ˜¯å¦ç¬¦åˆçº¦å®š
â–¡ æ³¨é‡Šæ˜¯å¦å®Œæ•´
â–¡ æ˜¯å¦æœ‰æ— ç”¨ä»£ç 
â–¡ æ˜¯å¦é€šè¿‡ç¼–è¯‘
â–¡ å•å…ƒæµ‹è¯•æ˜¯å¦é€šè¿‡

âœ… SQLç¼–å†™æ£€æŸ¥ï¼š
â–¡ æ˜¯å¦ä½¿ç”¨äº†#{}
â–¡ æ˜¯å¦æœ‰SQLæ³¨å…¥é£é™©
â–¡ æ˜¯å¦ä½¿ç”¨äº†ç´¢å¼•
â–¡ æ˜¯å¦æœ‰æ€§èƒ½é—®é¢˜
â–¡ æ ¼å¼æ˜¯å¦æ¸…æ™°

âœ… å¼‚å¸¸å¤„ç†æ£€æŸ¥ï¼š
â–¡ æ˜¯å¦æ•è·äº†å¼‚å¸¸
â–¡ æ˜¯å¦è®°å½•äº†æ—¥å¿—
â–¡ æ˜¯å¦ç»™å‡ºå‹å¥½æç¤º
â–¡ äº‹åŠ¡æ˜¯å¦æ­£ç¡®

âœ… æµ‹è¯•æ£€æŸ¥ï¼š
â–¡ æ˜¯å¦ç¼–å†™äº†æµ‹è¯•
â–¡ æµ‹è¯•è¦†ç›–æ˜¯å¦å®Œæ•´
â–¡ è¾¹ç•Œæƒ…å†µæ˜¯å¦æµ‹è¯•
```

### 12.3 æ–°æ‰‹å¸¸è§é—®é¢˜



**é—®é¢˜1ï¼šå‘½åä¸è§„èŒƒ**
```java
// âŒ é”™è¯¯
public interface userMapper { }  // é¦–å­—æ¯åº”å¤§å†™
String s;                         // å˜é‡åæ— æ„ä¹‰

// âœ… æ­£ç¡®
public interface UserMapper { }
String userName;
```

**é—®é¢˜2ï¼šSQLæ³¨å…¥é£é™©**
```xml
<!-- âŒ é”™è¯¯ï¼šä½¿ç”¨${} -->
WHERE user_name = '${name}'

<!-- âœ… æ­£ç¡®ï¼šä½¿ç”¨#{} -->
WHERE user_name = #{name}
```

**é—®é¢˜3ï¼šäº‹åŠ¡ä½¿ç”¨ä¸å½“**
```java
// âŒ é”™è¯¯ï¼šäº‹åŠ¡ä¸­è°ƒç”¨å¤–éƒ¨æœåŠ¡
@Transactional
public void processOrder(Order order) {
    orderMapper.insert(order);
    externalService.call();  // å¤–éƒ¨è°ƒç”¨åœ¨äº‹åŠ¡ä¸­
}

// âœ… æ­£ç¡®ï¼šäº‹åŠ¡åªåŒ…å«æ•°æ®åº“æ“ä½œ
@Transactional
public void saveOrder(Order order) {
    orderMapper.insert(order);
}

public void processOrder(Order order) {
    saveOrder(order);
    externalService.call();
}
```

**é—®é¢˜4ï¼šå¼‚å¸¸å¤„ç†ä¸å½“**
```java
// âŒ é”™è¯¯ï¼šæ•è·åä¸å¤„ç†
try {
    userMapper.insert(user);
} catch (Exception e) {
    // ç©ºcatchï¼Œåæ‰å¼‚å¸¸
}

// âœ… æ­£ç¡®ï¼šè®°å½•æ—¥å¿—å¹¶å¤„ç†
try {
    userMapper.insert(user);
} catch (Exception e) {
    log.error("æ’å…¥ç”¨æˆ·å¤±è´¥", e);
    throw new SystemException("æ“ä½œå¤±è´¥");
}
```

### 12.4 æœ€ä½³å®è·µå»ºè®®



**å›¢é˜Ÿåä½œ**
```
1. ç»Ÿä¸€ä½¿ç”¨ä»£ç æ ¼å¼åŒ–å·¥å…·ï¼ˆå¦‚IDEAæ ¼å¼åŒ–ï¼‰
2. æäº¤ä»£ç å‰å¿…é¡»è‡ªæµ‹
3. é‡è¦åŠŸèƒ½è¦æœ‰Code Review
4. å®šæœŸæ•´ç†å’Œæ›´æ–°æ–‡æ¡£
5. éµå¾ªå›¢é˜Ÿçº¦å®šçš„è§„èŒƒ
```

**æ€§èƒ½ä¼˜åŒ–**
```
1. åˆç†ä½¿ç”¨ç´¢å¼•
2. é¿å…N+1æŸ¥è¯¢é—®é¢˜
3. å¤§æ‰¹é‡æ“ä½œåˆ†æ‰¹å¤„ç†
4. ä½¿ç”¨ç¼“å­˜å‡å°‘æ•°æ®åº“è®¿é—®
5. å®šæœŸæ£€æŸ¥æ…¢SQL
```

**ä»£ç è´¨é‡**
```
1. ä¿æŒä»£ç ç®€æ´æ˜“è¯»
2. ä¸€ä¸ªæ–¹æ³•åªåšä¸€ä»¶äº‹
3. é¿å…è¿‡æ·±çš„åµŒå¥—
4. åŠæ—¶é‡æ„åä»£ç 
5. ç¼–å†™å¿…è¦çš„æµ‹è¯•
```

---

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
åˆ†å±‚æ¸…æ™°èŒè´£æ˜ï¼Œå‘½åè§„èŒƒè¦ç»Ÿä¸€
SQLè§„èŒƒé˜²æ³¨å…¥ï¼Œå¼‚å¸¸å¤„ç†è¦å®Œæ•´
æ—¥å¿—è®°å½•åŠ©æ’æŸ¥ï¼Œæµ‹è¯•è¦†ç›–ä¿è´¨é‡
ä»£ç å®¡æŸ¥æ‰¾é—®é¢˜ï¼Œæ–‡æ¡£å®Œå–„å¥½ç»´æŠ¤
è§„èŒƒæ‰§è¡Œé åšæŒï¼Œå›¢é˜Ÿåä½œå‡ºæ•ˆç›Š
```