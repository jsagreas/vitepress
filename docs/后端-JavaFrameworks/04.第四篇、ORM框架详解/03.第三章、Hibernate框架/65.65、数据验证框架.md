---
title: 65ã€æ•°æ®éªŒè¯æ¡†æ¶
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯æ•°æ®éªŒè¯](#1-ä»€ä¹ˆæ˜¯æ•°æ®éªŒè¯)
2. [Bean Validationè§„èŒƒåŸºç¡€](#2-Bean-Validationè§„èŒƒåŸºç¡€)
3. [Hibernate Validatorå®ç°](#3-Hibernate-Validatorå®ç°)
4. [å¸¸ç”¨éªŒè¯æ³¨è§£è¯¦è§£](#4-å¸¸ç”¨éªŒè¯æ³¨è§£è¯¦è§£)
5. [éªŒè¯ç»„Groups](#5-éªŒè¯ç»„Groups)
6. [éªŒè¯é¡ºåºæ§åˆ¶](#6-éªŒè¯é¡ºåºæ§åˆ¶)
7. [è‡ªå®šä¹‰éªŒè¯å™¨](#7-è‡ªå®šä¹‰éªŒè¯å™¨)
8. [å®æˆ˜åº”ç”¨åœºæ™¯](#8-å®æˆ˜åº”ç”¨åœºæ™¯)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ä»€ä¹ˆæ˜¯æ•°æ®éªŒè¯


### 1.1 ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®éªŒè¯


**ç°å®é—®é¢˜**ï¼šæƒ³è±¡ä½ å¼€å‘ä¸€ä¸ªç”¨æˆ·æ³¨å†ŒåŠŸèƒ½

```
ç”¨æˆ·æäº¤æ³¨å†Œä¿¡æ¯ï¼š
- ç”¨æˆ·åï¼šç©ºç™½
- é‚®ç®±ï¼šabcï¼ˆä¸æ˜¯é‚®ç®±æ ¼å¼ï¼‰
- å¹´é¾„ï¼š-5å²
- æ‰‹æœºï¼š12345ï¼ˆå·ç ä¸å®Œæ•´ï¼‰

é—®é¢˜æ¥äº†ï¼š
âŒ è¿™äº›æ•°æ®èƒ½ç›´æ¥å­˜å…¥æ•°æ®åº“å—ï¼Ÿ
âŒ ä¸‡ä¸€å­˜è¿›å»äº†ï¼Œåç»­ä¸šåŠ¡é€»è¾‘ä¼šå‡ºä»€ä¹ˆé—®é¢˜ï¼Ÿ
âŒ æ¯ä¸ªåœ°æ–¹éƒ½å†™ifåˆ¤æ–­ï¼Ÿä»£ç ä¼šä¸ä¼šå¾ˆä¹±ï¼Ÿ
```

**æ•°æ®éªŒè¯çš„æœ¬è´¨**ï¼šåœ¨æ•°æ®è¿›å…¥ç³»ç»Ÿä¹‹å‰ï¼Œå…ˆæ£€æŸ¥å®ƒæ˜¯å¦ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ï¼Œä¸åˆæ ¼å°±æ‹’ç»ã€‚

### 1.2 ä¼ ç»ŸéªŒè¯æ–¹å¼çš„é—®é¢˜


**æ²¡æœ‰éªŒè¯æ¡†æ¶æ—¶çš„ä»£ç **ï¼š

```java
// åˆ°å¤„éƒ½æ˜¯è¿™æ ·çš„åˆ¤æ–­ä»£ç ï¼Œé‡å¤ä¸”éš¾ç»´æŠ¤
public void registerUser(User user) {
    if (user.getUsername() == null || user.getUsername().isEmpty()) {
        throw new Exception("ç”¨æˆ·åä¸èƒ½ä¸ºç©º");
    }
    if (user.getAge() < 0 || user.getAge() > 150) {
        throw new Exception("å¹´é¾„ä¸åˆæ³•");
    }
    if (!user.getEmail().contains("@")) {
        throw new Exception("é‚®ç®±æ ¼å¼é”™è¯¯");
    }
    // ... è¿˜æœ‰å¾ˆå¤šåˆ¤æ–­
}
```

**é—®é¢˜åˆ†æ**ï¼š
```
ğŸ”´ ä»£ç é‡å¤ï¼šæ¯ä¸ªæ–¹æ³•éƒ½è¦å†™ç±»ä¼¼çš„åˆ¤æ–­
ğŸ”´ ç»´æŠ¤å›°éš¾ï¼šéªŒè¯è§„åˆ™æ”¹äº†ï¼Œè¦åˆ°å¤„æ”¹ä»£ç 
ğŸ”´ ä¸å¤Ÿç›´è§‚ï¼šçœ‹ä¸å‡ºè¿™ä¸ªå­—æ®µåˆ°åº•æœ‰ä»€ä¹ˆè¦æ±‚
ğŸ”´ å®¹æ˜“é—æ¼ï¼šå¯èƒ½å¿˜è®°åœ¨æŸäº›åœ°æ–¹éªŒè¯
```

### 1.3 éªŒè¯æ¡†æ¶çš„ä¼˜åŠ¿


**ä½¿ç”¨éªŒè¯æ¡†æ¶å**ï¼š

```java
public class User {
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    private String username;
    
    @Min(value = 0, message = "å¹´é¾„ä¸èƒ½å°äº0")
    @Max(value = 150, message = "å¹´é¾„ä¸èƒ½å¤§äº150")
    private Integer age;
    
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String email;
}

// ä½¿ç”¨æ—¶åªéœ€ä¸€è¡Œä»£ç 
@Valid
public void registerUser(@Valid User user) {
    // æ•°æ®å·²ç»éªŒè¯é€šè¿‡ï¼Œå¯ä»¥å®‰å…¨ä½¿ç”¨
}
```

**ä¼˜åŠ¿å¯¹æ¯”è¡¨**ï¼š

| å¯¹æ¯”é¡¹ | ä¼ ç»Ÿæ–¹å¼ | éªŒè¯æ¡†æ¶ |
|--------|---------|---------|
| **ä»£ç é‡** | å¤§é‡é‡å¤çš„ifåˆ¤æ–­ | ä¸€ä¸ªæ³¨è§£æå®š |
| **å¯è¯»æ€§** | åˆ†æ•£åœ¨ä»£ç å„å¤„ | ç›´æ¥åœ¨å­—æ®µä¸Šå£°æ˜ |
| **ç»´æŠ¤æ€§** | ä¿®æ”¹ä¸€å¤„è¦æ”¹å¤šå¤„ | ä¿®æ”¹æ³¨è§£å³å¯ |
| **å¤ç”¨æ€§** | éš¾ä»¥å¤ç”¨ | éªŒè¯è§„åˆ™è‡ªåŠ¨å¤ç”¨ |

---

## 2. ğŸ“– Bean Validationè§„èŒƒåŸºç¡€


### 2.1 ä»€ä¹ˆæ˜¯JSR-303è§„èŒƒ


**é€šä¿—ç†è§£**ï¼šJSR-303å°±åƒæ˜¯ä¸€ä»½"æ•°æ®éªŒè¯çš„å›½å®¶æ ‡å‡†"

```
ç±»æ¯”ç”Ÿæ´»åœºæ™¯ï¼š

ç”µå™¨æ’å¤´æ ‡å‡†ï¼ˆå›½å®¶æ ‡å‡†ï¼‰
â”œâ”€â”€ å®šä¹‰äº†æ’å¤´çš„å½¢çŠ¶ã€å¤§å°
â”œâ”€â”€ å„ä¸ªå‚å•†æŒ‰è¿™ä¸ªæ ‡å‡†ç”Ÿäº§
â””â”€â”€ ä¿è¯ä¸åŒå“ç‰Œçš„ç”µå™¨èƒ½äº’ç›¸å…¼å®¹

JSR-303éªŒè¯è§„èŒƒï¼ˆJavaæ ‡å‡†ï¼‰
â”œâ”€â”€ å®šä¹‰äº†å¦‚ä½•éªŒè¯æ•°æ®
â”œâ”€â”€ å„ä¸ªæ¡†æ¶æŒ‰è¿™ä¸ªæ ‡å‡†å®ç°
â””â”€â”€ ä¿è¯éªŒè¯é€»è¾‘å¯ä»¥åœ¨ä¸åŒæ¡†æ¶é—´é€šç”¨
```

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
- **JSR-303**ï¼š2009å¹´å‘å¸ƒçš„éªŒè¯è§„èŒƒ1.0ç‰ˆæœ¬
- **JSR-349**ï¼š2013å¹´å‘å¸ƒçš„éªŒè¯è§„èŒƒ1.1ç‰ˆæœ¬  
- **JSR-380**ï¼š2017å¹´å‘å¸ƒçš„éªŒè¯è§„èŒƒ2.0ç‰ˆæœ¬

> ğŸ’¡ **å°è´´å£«**ï¼šJSRæ˜¯"Java Specification Request"çš„ç¼©å†™ï¼Œå°±æ˜¯Javaè§„èŒƒææ¡ˆçš„æ„æ€ã€‚

### 2.2 è§„èŒƒå®šä¹‰çš„æ ¸å¿ƒå†…å®¹


**è§„èŒƒè§„å®šäº†ä»€ä¹ˆ**ï¼š

```
1ï¸âƒ£ éªŒè¯æ³¨è§£çš„æ ‡å‡†
   @NotNullã€@Sizeã€@Minã€@Maxç­‰åŸºç¡€æ³¨è§£
   
2ï¸âƒ£ éªŒè¯çš„è§¦å‘æ–¹å¼
   æ–¹æ³•å‚æ•°éªŒè¯ã€å¯¹è±¡éªŒè¯ç­‰
   
3ï¸âƒ£ éªŒè¯ç»“æœçš„å¤„ç†
   å¦‚ä½•è¿”å›é”™è¯¯ä¿¡æ¯ã€é”™è¯¯ç ç­‰
   
4ï¸âƒ£ æ‰©å±•æœºåˆ¶
   å¦‚ä½•è‡ªå®šä¹‰éªŒè¯è§„åˆ™
```

### 2.3 è§„èŒƒä¸å®ç°çš„å…³ç³»


**æ¦‚å¿µå›¾ç¤º**ï¼š

```
                  JSR-303è§„èŒƒï¼ˆæ ‡å‡†æ¥å£ï¼‰
                         â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                â†“                â†“
  Hibernate Validator  Apache BVal   å…¶ä»–å®ç°
   ï¼ˆæœ€æµè¡Œçš„å®ç°ï¼‰    ï¼ˆå¦ä¸€ä¸ªå®ç°ï¼‰
```

**é€šä¿—è§£é‡Š**ï¼š
- **è§„èŒƒ**ï¼šåªå®šä¹‰"åº”è¯¥æ€ä¹ˆåš"ï¼Œä¸æä¾›å…·ä½“ä»£ç 
- **å®ç°**ï¼šæŒ‰ç…§è§„èŒƒçš„è¦æ±‚ï¼Œç¼–å†™çœŸæ­£èƒ½ç”¨çš„ä»£ç 
- **Hibernate Validator**ï¼šç›®å‰æœ€æµè¡Œã€åŠŸèƒ½æœ€å¼ºçš„å®ç°

> âš ï¸ **æ³¨æ„**ï¼šHibernate Validatorä¸ä»…å®ç°äº†æ ‡å‡†è§„èŒƒï¼Œè¿˜æä¾›äº†å¾ˆå¤šé¢å¤–çš„å¢å¼ºåŠŸèƒ½ã€‚

---

## 3. ğŸ”§ Hibernate Validatorå®ç°


### 3.1 ä»€ä¹ˆæ˜¯Hibernate Validator


**ç®€å•ç†è§£**ï¼šå®ƒæ˜¯JSR-303è§„èŒƒçš„"å‚è€ƒç­”æ¡ˆ"ï¼Œä¹Ÿæ˜¯åŠŸèƒ½æœ€å¼ºå¤§çš„å®ç°ã€‚

```
å…³ç³»ç±»æ¯”ï¼š

è§„èŒƒï¼ˆInterfaceï¼‰      å®ç°ï¼ˆImplementationï¼‰
    â†“                        â†“
Listæ¥å£          â†’      ArrayListç±»
                 â†’      LinkedListç±»

Bean Validationè§„èŒƒ  â†’  Hibernate Validator
```

**æ ¸å¿ƒç‰¹ç‚¹**ï¼š
- âœ… å®Œæ•´å®ç°äº†Bean Validation 2.0è§„èŒƒ
- âœ… æä¾›äº†ä¸°å¯Œçš„æ‰©å±•æ³¨è§£
- âœ… æ€§èƒ½ä¼˜ç§€ï¼Œè¢«å¹¿æ³›ä½¿ç”¨
- âœ… Spring Booté»˜è®¤é›†æˆ

### 3.2 å¿«é€Ÿä¸Šæ‰‹é…ç½®


**Mavenä¾èµ–é…ç½®**ï¼š

```xml
<!-- Spring Booté¡¹ç›®è‡ªåŠ¨åŒ…å«ï¼Œæ— éœ€æ‰‹åŠ¨æ·»åŠ  -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-validation</artifactId>
</dependency>

<!-- å¦‚æœæ˜¯æ™®é€šJavaé¡¹ç›® -->
<dependency>
    <groupId>org.hibernate.validator</groupId>
    <artifactId>hibernate-validator</artifactId>
    <version>7.0.5.Final</version>
</dependency>
```

**åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹**ï¼š

```java
// 1. åœ¨å®ä½“ç±»ä¸Šæ·»åŠ éªŒè¯æ³¨è§£
public class User {
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    private String username;
    
    @Email(message = "é‚®ç®±æ ¼å¼é”™è¯¯")
    private String email;
}

// 2. åœ¨Controllerä¸­è§¦å‘éªŒè¯
@RestController
public class UserController {
    
    @PostMapping("/register")
    public String register(@Valid @RequestBody User user) {
        // @Validæ³¨è§£ä¼šè‡ªåŠ¨è§¦å‘éªŒè¯
        return "æ³¨å†ŒæˆåŠŸ";
    }
}
```

### 3.3 éªŒè¯å·¥ä½œæµç¨‹


**éªŒè¯æ‰§è¡Œæµç¨‹å›¾**ï¼š

```
å®¢æˆ·ç«¯æäº¤æ•°æ®
      â†“
Springæ¥æ”¶è¯·æ±‚
      â†“
å‘ç°@Validæ³¨è§£
      â†“
Hibernate Validatorå¼€å§‹å·¥ä½œ
      â†“
æ£€æŸ¥æ‰€æœ‰éªŒè¯æ³¨è§£
      â†“
   éªŒè¯é€šè¿‡ï¼Ÿ
   â†™      â†˜
 Yes       No
  â†“         â†“
æ‰§è¡Œæ–¹æ³•   æŠ›å‡ºå¼‚å¸¸
          â†“
      è¿”å›é”™è¯¯ä¿¡æ¯
```

**é€šä¿—è§£é‡Šè¿‡ç¨‹**ï¼š

```
æ­¥éª¤1ï¼šSpringçœ‹åˆ°@Validï¼ŒçŸ¥é“è¦éªŒè¯æ•°æ®
æ­¥éª¤2ï¼šè°ƒç”¨Hibernate Validatorè¿›è¡ŒéªŒè¯
æ­¥éª¤3ï¼šValidatoré€ä¸ªæ£€æŸ¥æ³¨è§£è§„åˆ™
æ­¥éª¤4ï¼šæœ‰ä¸€ä¸ªä¸é€šè¿‡å°±æŠ¥é”™ï¼Œå…¨éƒ¨é€šè¿‡æ‰ç»§ç»­
```

---

## 4. ğŸ“ å¸¸ç”¨éªŒè¯æ³¨è§£è¯¦è§£


### 4.1 ç©ºå€¼éªŒè¯æ³¨è§£


**@NotNullã€@NotEmptyã€@NotBlankçš„åŒºåˆ«**ï¼š

```java
// ä¸‰ä¸ªæ³¨è§£çš„åŒºåˆ«ç¤ºä¾‹
public class Demo {
    @NotNull    // ä¸èƒ½æ˜¯nullï¼Œä½†å¯ä»¥æ˜¯ç©ºå­—ç¬¦ä¸²""
    private String field1;
    
    @NotEmpty   // ä¸èƒ½æ˜¯nullï¼Œä¹Ÿä¸èƒ½æ˜¯ç©ºå­—ç¬¦ä¸²""ï¼Œä½†å¯ä»¥æ˜¯ç©ºæ ¼"  "
    private String field2;
    
    @NotBlank   // ä¸èƒ½æ˜¯nullã€ç©ºå­—ç¬¦ä¸²""ã€ç©ºæ ¼"  "ï¼ˆæœ€ä¸¥æ ¼ï¼‰
    private String field3;
}
```

**å¯¹æ¯”æµ‹è¯•è¡¨**ï¼š

| å€¼ | @NotNull | @NotEmpty | @NotBlank |
|----|----------|-----------|-----------|
| `null` | âŒ ä¸é€šè¿‡ | âŒ ä¸é€šè¿‡ | âŒ ä¸é€šè¿‡ |
| `""` | âœ… é€šè¿‡ | âŒ ä¸é€šè¿‡ | âŒ ä¸é€šè¿‡ |
| `"  "` | âœ… é€šè¿‡ | âœ… é€šè¿‡ | âŒ ä¸é€šè¿‡ |
| `"abc"` | âœ… é€šè¿‡ | âœ… é€šè¿‡ | âœ… é€šè¿‡ |

**ä½¿ç”¨å»ºè®®**ï¼š
```
ğŸ’¡ å­—ç¬¦ä¸²éªŒè¯ï¼šä¼˜å…ˆä½¿ç”¨@NotBlankï¼ˆæœ€ä¸¥æ ¼ï¼‰
ğŸ’¡ é›†åˆéªŒè¯ï¼šä½¿ç”¨@NotEmpty
ğŸ’¡ å¯¹è±¡éªŒè¯ï¼šä½¿ç”¨@NotNull
```

### 4.2 æ•°å€¼èŒƒå›´éªŒè¯


**å¸¸ç”¨æ•°å€¼éªŒè¯æ³¨è§£**ï¼š

```java
public class Product {
    @Min(value = 0, message = "ä»·æ ¼ä¸èƒ½ä¸ºè´Ÿæ•°")
    private BigDecimal price;
    
    @Max(value = 100, message = "æŠ˜æ‰£ä¸èƒ½è¶…è¿‡100%")
    private Integer discount;
    
    @DecimalMin(value = "0.01", message = "é‡‘é¢æœ€å°0.01")
    private BigDecimal amount;
    
    @DecimalMax(value = "999999.99", message = "é‡‘é¢è¶…è¿‡é™åˆ¶")
    private BigDecimal maxAmount;
    
    @Positive  // å¿…é¡»æ˜¯æ­£æ•°ï¼ˆå¤§äº0ï¼‰
    private Integer stock;
    
    @PositiveOrZero  // æ­£æ•°æˆ–0
    private Integer sales;
}
```

**æ³¨è§£é€‰æ‹©æŒ‡å—**ï¼š

```
æ•´æ•°éªŒè¯ï¼š
â”œâ”€â”€ @Min/@Max        â†’ é€‚ç”¨äºIntegerã€Long
â””â”€â”€ @Positive        â†’ å¿«é€ŸéªŒè¯æ­£æ•°

å°æ•°éªŒè¯ï¼š
â”œâ”€â”€ @DecimalMin/@DecimalMax  â†’ é€‚ç”¨äºBigDecimal
â””â”€â”€ æ”¯æŒå­—ç¬¦ä¸²å½¢å¼çš„ç²¾ç¡®å€¼
```

### 4.3 å­—ç¬¦ä¸²æ ¼å¼éªŒè¯


**å¸¸è§å­—ç¬¦ä¸²éªŒè¯**ï¼š

```java
public class UserInfo {
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String email;
    
    @Pattern(regexp = "^1[3-9]\\d{9}$", message = "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®")
    private String phone;
    
    @Size(min = 6, max = 20, message = "å¯†ç é•¿åº¦å¿…é¡»åœ¨6-20ä¹‹é—´")
    private String password;
    
    @Length(min = 2, max = 10, message = "å§“åé•¿åº¦2-10ä¸ªå­—ç¬¦")
    private String name;  // Hibernate Validatoræ‰©å±•æ³¨è§£
    
    @URL(message = "ç½‘å€æ ¼å¼ä¸æ­£ç¡®")
    private String website;
}
```

**@Size vs @Length åŒºåˆ«**ï¼š

```
@Sizeï¼š
â”œâ”€â”€ JSR-303æ ‡å‡†æ³¨è§£
â”œâ”€â”€ å¯ç”¨äºå­—ç¬¦ä¸²ã€é›†åˆã€æ•°ç»„ã€Map
â””â”€â”€ éªŒè¯å…ƒç´ ä¸ªæ•°

@Lengthï¼š
â”œâ”€â”€ Hibernate Validatoræ‰©å±•æ³¨è§£
â”œâ”€â”€ åªèƒ½ç”¨äºå­—ç¬¦ä¸²
â””â”€â”€ ä¸“é—¨éªŒè¯å­—ç¬¦ä¸²é•¿åº¦
```

### 4.4 æ—¥æœŸæ—¶é—´éªŒè¯


**æ—¶é—´ç›¸å…³éªŒè¯**ï¼š

```java
public class Event {
    @Past(message = "å‡ºç”Ÿæ—¥æœŸå¿…é¡»æ˜¯è¿‡å»çš„æ—¶é—´")
    private LocalDate birthday;
    
    @Future(message = "æ´»åŠ¨æ—¶é—´å¿…é¡»æ˜¯æœªæ¥çš„æ—¶é—´")
    private LocalDateTime eventTime;
    
    @PastOrPresent  // è¿‡å»æˆ–ç°åœ¨
    private LocalDate orderDate;
    
    @FutureOrPresent  // æœªæ¥æˆ–ç°åœ¨
    private LocalDate deadline;
}
```

### 4.5 é›†åˆå’Œæ•°ç»„éªŒè¯


**é›†åˆéªŒè¯ç¤ºä¾‹**ï¼š

```java
public class Order {
    @NotEmpty(message = "è®¢å•å•†å“ä¸èƒ½ä¸ºç©º")
    @Size(min = 1, max = 20, message = "è®¢å•å•†å“æ•°é‡1-20ä»¶")
    private List<OrderItem> items;
    
    @Valid  // éªŒè¯é›†åˆä¸­æ¯ä¸ªå…ƒç´ 
    private List<Address> addresses;
}
```

**æ ¸å¿ƒè¦ç‚¹**ï¼š
```
âš¡ @NotEmptyï¼šéªŒè¯é›†åˆä¸ä¸ºç©º
âš¡ @Sizeï¼šéªŒè¯é›†åˆå…ƒç´ ä¸ªæ•°
âš¡ @Validï¼šéªŒè¯é›†åˆä¸­æ¯ä¸ªå¯¹è±¡çš„å±æ€§
```

---

## 5. ğŸ‘¥ éªŒè¯ç»„Groups


### 5.1 ä¸ºä»€ä¹ˆéœ€è¦éªŒè¯ç»„


**ç°å®åœºæ™¯**ï¼šåŒä¸€ä¸ªUserå¯¹è±¡ï¼Œåœ¨ä¸åŒåœºæ™¯ä¸‹éªŒè¯è§„åˆ™ä¸åŒ

```
åœºæ™¯å¯¹æ¯”ï¼š

ğŸ“ ç”¨æˆ·æ³¨å†Œæ—¶ï¼š
   â”œâ”€â”€ ç”¨æˆ·åï¼šå¿…å¡«
   â”œâ”€â”€ å¯†ç ï¼šå¿…å¡«
   â””â”€â”€ IDï¼šä¸éœ€è¦ï¼ˆç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆï¼‰

âœï¸ ç”¨æˆ·æ›´æ–°æ—¶ï¼š
   â”œâ”€â”€ ç”¨æˆ·åï¼šé€‰å¡«ï¼ˆå¯èƒ½ä¸æ”¹ï¼‰
   â”œâ”€â”€ å¯†ç ï¼šé€‰å¡«ï¼ˆå¯èƒ½ä¸æ”¹ï¼‰
   â””â”€â”€ IDï¼šå¿…å¡«ï¼ˆè¦çŸ¥é“æ”¹è°ï¼‰
```

**é—®é¢˜**ï¼šå¦‚æœåªç”¨ä¸€å¥—éªŒè¯è§„åˆ™ï¼Œæ€ä¹ˆåŒºåˆ†è¿™ä¸¤ç§æƒ…å†µï¼Ÿ

### 5.2 éªŒè¯ç»„çš„åŸºæœ¬ç”¨æ³•


**å®šä¹‰éªŒè¯ç»„æ¥å£**ï¼š

```java
// 1. å®šä¹‰éªŒè¯ç»„æ ‡è®°æ¥å£ï¼ˆç©ºæ¥å£å³å¯ï¼‰
public interface CreateGroup {}
public interface UpdateGroup {}

// 2. åœ¨æ³¨è§£ä¸­æŒ‡å®šæ‰€å±ç»„
public class User {
    @NotNull(groups = UpdateGroup.class, message = "æ›´æ–°æ—¶IDå¿…å¡«")
    private Long id;
    
    @NotBlank(groups = CreateGroup.class, message = "æ³¨å†Œæ—¶ç”¨æˆ·åå¿…å¡«")
    private String username;
    
    @NotBlank(groups = {CreateGroup.class, UpdateGroup.class}, 
              message = "é‚®ç®±å¿…å¡«")
    private String email;
}
```

**ä½¿ç”¨éªŒè¯ç»„**ï¼š

```java
@RestController
public class UserController {
    
    // æ³¨å†Œæ—¶ä½¿ç”¨CreateGroupéªŒè¯è§„åˆ™
    @PostMapping("/register")
    public String create(@Validated(CreateGroup.class) @RequestBody User user) {
        return "æ³¨å†ŒæˆåŠŸ";
    }
    
    // æ›´æ–°æ—¶ä½¿ç”¨UpdateGroupéªŒè¯è§„åˆ™
    @PutMapping("/update")
    public String update(@Validated(UpdateGroup.class) @RequestBody User user) {
        return "æ›´æ–°æˆåŠŸ";
    }
}
```

**æ³¨è§£å¯¹æ¯”**ï¼š

```
@Validï¼š
â”œâ”€â”€ éªŒè¯æ‰€æœ‰è§„åˆ™ï¼ˆä¸åŒºåˆ†ç»„ï¼‰
â””â”€â”€ æ— æ³•æŒ‡å®šéªŒè¯ç»„

@Validatedï¼š
â”œâ”€â”€ å¯ä»¥æŒ‡å®šéªŒè¯ç»„
â”œâ”€â”€ Springæä¾›çš„æ³¨è§£
â””â”€â”€ åŠŸèƒ½æ›´å¼ºå¤§
```

### 5.3 ç»„ç»§æ‰¿æœºåˆ¶


**éªŒè¯ç»„çš„ç»§æ‰¿å…³ç³»**ï¼š

```java
// å®šä¹‰ç»„çš„ç»§æ‰¿å…³ç³»
public interface BaseGroup {}

public interface CreateGroup extends BaseGroup {}

public interface UpdateGroup extends BaseGroup {}

// ä½¿ç”¨ç»§æ‰¿çš„ç»„
public class User {
    @NotNull(groups = BaseGroup.class)  // æ‰€æœ‰ç»„éƒ½ä¼šéªŒè¯
    private String email;
    
    @NotNull(groups = CreateGroup.class)  // åªåœ¨åˆ›å»ºæ—¶éªŒè¯
    private String password;
}
```

**ç»§æ‰¿å…³ç³»å›¾**ï¼š

```
              BaseGroup
             /         \
      CreateGroup    UpdateGroup
            
éªŒè¯CreateGroupæ—¶ï¼š
â””â”€â”€ ä¼šåŒæ—¶éªŒè¯BaseGroupå’ŒCreateGroupçš„è§„åˆ™

éªŒè¯UpdateGroupæ—¶ï¼š
â””â”€â”€ ä¼šåŒæ—¶éªŒè¯BaseGroupå’ŒUpdateGroupçš„è§„åˆ™
```

### 5.4 é»˜è®¤ç»„Default


**ä¸æŒ‡å®šç»„æ—¶çš„è¡Œä¸º**ï¼š

```java
public class User {
    @NotBlank  // æ²¡æœ‰æŒ‡å®šgroupsï¼Œå±äºDefaultç»„
    private String username;
    
    @NotNull(groups = CreateGroup.class)  // å±äºCreateGroup
    private String password;
}
```

**éªŒè¯è¡Œä¸º**ï¼š

```
ä½¿ç”¨@Validï¼š
â””â”€â”€ åªéªŒè¯Defaultç»„ï¼ˆusernameï¼‰

ä½¿ç”¨@Validated(CreateGroup.class)ï¼š
â””â”€â”€ åªéªŒè¯CreateGroupç»„ï¼ˆpasswordï¼‰

ä½¿ç”¨@Validated({Default.class, CreateGroup.class})ï¼š
â””â”€â”€ éªŒè¯ä¸¤ä¸ªç»„çš„è§„åˆ™
```

---

## 6. ğŸ”¢ éªŒè¯é¡ºåºæ§åˆ¶


### 6.1 ä¸ºä»€ä¹ˆéœ€è¦æ§åˆ¶éªŒè¯é¡ºåº


**åœºæ™¯è¯´æ˜**ï¼šæœ‰äº›éªŒè¯åº”è¯¥å…ˆæ‰§è¡Œï¼Œæœ‰äº›åæ‰§è¡Œ

```
ç”¨æˆ·æ³¨å†ŒéªŒè¯é¡ºåºï¼š

ç¬¬1æ­¥ï¼šåŸºç¡€éªŒè¯ï¼ˆå­—æ®µä¸èƒ½ä¸ºç©ºï¼‰
      â†“
ç¬¬2æ­¥ï¼šæ ¼å¼éªŒè¯ï¼ˆé‚®ç®±æ ¼å¼ã€æ‰‹æœºæ ¼å¼ï¼‰
      â†“
ç¬¬3æ­¥ï¼šä¸šåŠ¡éªŒè¯ï¼ˆç”¨æˆ·åæ˜¯å¦é‡å¤ï¼‰

ä¸ºä»€ä¹ˆè¦åˆ†æ­¥éª¤ï¼Ÿ
â””â”€â”€ å¦‚æœç”¨æˆ·åéƒ½æ˜¯ç©ºçš„ï¼Œè¿˜éœ€è¦æŸ¥æ•°æ®åº“éªŒè¯é‡å¤å—ï¼Ÿ
```

### 6.2 ä½¿ç”¨@GroupSequenceæ§åˆ¶é¡ºåº


**å®šä¹‰éªŒè¯é¡ºåº**ï¼š

```java
// 1. å®šä¹‰éªŒè¯ç»„
public interface First {}
public interface Second {}
public interface Third {}

// 2. å®šä¹‰éªŒè¯é¡ºåº
@GroupSequence({First.class, Second.class, Third.class})
public interface OrderedValidation {}

// 3. åœ¨å®ä½“ç±»ä¸­ä½¿ç”¨
public class User {
    @NotBlank(groups = First.class)
    private String username;
    
    @Email(groups = Second.class)
    private String email;
    
    @AssertTrue(groups = Third.class)
    private boolean checkUsernameDuplicate() {
        // ä¸šåŠ¡éªŒè¯ï¼šæ£€æŸ¥ç”¨æˆ·åæ˜¯å¦é‡å¤
        return !isDuplicate(username);
    }
}
```

**ä½¿ç”¨é¡ºåºéªŒè¯**ï¼š

```java
@PostMapping("/register")
public String register(@Validated(OrderedValidation.class) @RequestBody User user) {
    return "æ³¨å†ŒæˆåŠŸ";
}
```

### 6.3 éªŒè¯çŸ­è·¯æœºåˆ¶


**å·¥ä½œåŸç†**ï¼š

```
é¡ºåºéªŒè¯çš„çŸ­è·¯è§„åˆ™ï¼š

Step1ï¼šFirstç»„éªŒè¯
       â†“
     é€šè¿‡ï¼Ÿ
    /     \
   No      Yes
   â†“        â†“
 è¿”å›é”™è¯¯  Step2ï¼šSecondç»„éªŒè¯
              â†“
            é€šè¿‡ï¼Ÿ
           /     \
          No      Yes
          â†“        â†“
        è¿”å›é”™è¯¯   Step3ï¼šThirdç»„éªŒè¯
```

**é€šä¿—è§£é‡Š**ï¼š
- ç¬¬ä¸€ç»„æœ‰é”™è¯¯ï¼Œç«‹å³è¿”å›ï¼Œä¸æ£€æŸ¥åé¢çš„ç»„
- æ¯ç»„éªŒè¯é€šè¿‡åï¼Œæ‰è¿›è¡Œä¸‹ä¸€ç»„éªŒè¯
- ç±»ä¼¼"å…³å¡æ¸¸æˆ"ï¼Œä¸€å…³æ²¡è¿‡å°±Game Over

### 6.4 å®æˆ˜ç¤ºä¾‹


**å®Œæ•´çš„æ³¨å†ŒéªŒè¯æµç¨‹**ï¼š

```java
// å®šä¹‰éªŒè¯ç»„å’Œé¡ºåº
public interface BasicCheck {}
public interface FormatCheck {}
public interface BusinessCheck {}

@GroupSequence({BasicCheck.class, FormatCheck.class, BusinessCheck.class})
public interface RegisterValidation {}

// å®ä½“ç±»
public class RegisterRequest {
    @NotBlank(groups = BasicCheck.class, message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @Size(min = 3, max = 20, groups = FormatCheck.class, message = "ç”¨æˆ·åé•¿åº¦3-20")
    private String username;
    
    @NotBlank(groups = BasicCheck.class, message = "é‚®ç®±ä¸èƒ½ä¸ºç©º")
    @Email(groups = FormatCheck.class, message = "é‚®ç®±æ ¼å¼é”™è¯¯")
    private String email;
    
    @AssertTrue(groups = BusinessCheck.class, message = "ç”¨æˆ·åå·²å­˜åœ¨")
    private boolean isUsernameAvailable() {
        // åªæœ‰å‰é¢éªŒè¯é€šè¿‡ï¼Œæ‰ä¼šæ‰§è¡Œè¿™ä¸ªæ–¹æ³•
        return userService.checkUsername(username);
    }
}
```

---

## 7. ğŸ› ï¸ è‡ªå®šä¹‰éªŒè¯å™¨


### 7.1 ä¸ºä»€ä¹ˆéœ€è¦è‡ªå®šä¹‰éªŒè¯å™¨


**æ ‡å‡†æ³¨è§£æ— æ³•æ»¡è¶³çš„åœºæ™¯**ï¼š

```
ä¸šåŠ¡åœºæ™¯ç¤ºä¾‹ï¼š

âŒ æ ‡å‡†æ³¨è§£æ— æ³•å®ç°ï¼š
   â”œâ”€â”€ éªŒè¯èº«ä»½è¯å·æ ¼å¼
   â”œâ”€â”€ éªŒè¯é“¶è¡Œå¡å·
   â”œâ”€â”€ éªŒè¯ä¸¤ä¸ªå­—æ®µçš„ç»„åˆé€»è¾‘
   â””â”€â”€ è°ƒç”¨å¤–éƒ¨æ¥å£éªŒè¯

âœ… è‡ªå®šä¹‰éªŒè¯å™¨å¯ä»¥åšåˆ°
```

### 7.2 è‡ªå®šä¹‰éªŒè¯æ³¨è§£çš„æ­¥éª¤


**å®Œæ•´å®ç°æµç¨‹**ï¼š

**æ­¥éª¤1ï¼šåˆ›å»ºè‡ªå®šä¹‰æ³¨è§£**

```java
@Target({ElementType.FIELD})  // å¯ä»¥ç”¨åœ¨å­—æ®µä¸Š
@Retention(RetentionPolicy.RUNTIME)  // è¿è¡Œæ—¶æœ‰æ•ˆ
@Constraint(validatedBy = IdCardValidator.class)  // æŒ‡å®šéªŒè¯å™¨
public @interface IdCard {
    // é”™è¯¯æ¶ˆæ¯
    String message() default "èº«ä»½è¯å·æ ¼å¼ä¸æ­£ç¡®";
    
    // éªŒè¯ç»„
    Class<?>[] groups() default {};
    
    // è´Ÿè½½ï¼ˆå¾ˆå°‘ç”¨ï¼Œå›ºå®šå†™æ³•ï¼‰
    Class<? extends Payload>[] payload() default {};
}
```

**æ­¥éª¤2ï¼šå®ç°éªŒè¯å™¨**

```java
public class IdCardValidator implements ConstraintValidator<IdCard, String> {
    
    @Override
    public void initialize(IdCard annotation) {
        // åˆå§‹åŒ–æ–¹æ³•ï¼Œå¯ä»¥è·å–æ³¨è§£çš„å‚æ•°
    }
    
    @Override
    public boolean isValid(String value, ConstraintValidatorContext context) {
        // éªŒè¯é€»è¾‘
        if (value == null || value.isEmpty()) {
            return true;  // nullå€¼ç”±@NotNullå¤„ç†
        }
        
        // ç®€åŒ–çš„èº«ä»½è¯éªŒè¯ï¼ˆå®é™…è¦æ›´å¤æ‚ï¼‰
        return value.matches("^[1-9]\\d{5}(18|19|20)\\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\\d|3[01])\\d{3}[0-9Xx]$");
    }
}
```

**æ­¥éª¤3ï¼šä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£**

```java
public class Person {
    @IdCard(message = "è¯·è¾“å…¥æ­£ç¡®çš„èº«ä»½è¯å·")
    private String idCard;
}
```

### 7.3 å¸¦å‚æ•°çš„è‡ªå®šä¹‰éªŒè¯å™¨


**æ”¯æŒé…ç½®å‚æ•°çš„éªŒè¯å™¨**ï¼š

```java
// 1. æ³¨è§£ä¸­å®šä¹‰å‚æ•°
@Target({ElementType.FIELD})
@Retention(RetentionPolicy.RUNTIME)
@Constraint(validatedBy = EnumValidator.class)
public @interface EnumValue {
    String message() default "ä¸åœ¨å…è®¸çš„æšä¸¾å€¼èŒƒå›´å†…";
    Class<?>[] groups() default {};
    Class<? extends Payload>[] payload() default {};
    
    // è‡ªå®šä¹‰å‚æ•°ï¼šå…è®¸çš„æšä¸¾å€¼
    String[] values() default {};
}

// 2. éªŒè¯å™¨ä¸­ä½¿ç”¨å‚æ•°
public class EnumValidator implements ConstraintValidator<EnumValue, String> {
    private String[] values;
    
    @Override
    public void initialize(EnumValue annotation) {
        this.values = annotation.values();  // è·å–æ³¨è§£å‚æ•°
    }
    
    @Override
    public boolean isValid(String value, ConstraintValidatorContext context) {
        if (value == null) {
            return true;
        }
        return Arrays.asList(values).contains(value);
    }
}

// 3. ä½¿ç”¨æ—¶ä¼ å…¥å‚æ•°
public class Order {
    @EnumValue(values = {"pending", "paid", "shipped"}, 
               message = "è®¢å•çŠ¶æ€åªèƒ½æ˜¯pendingã€paidæˆ–shipped")
    private String status;
}
```

### 7.4 ç±»çº§åˆ«çš„è‡ªå®šä¹‰éªŒè¯


**éªŒè¯å¤šä¸ªå­—æ®µçš„ç»„åˆé€»è¾‘**ï¼š

```java
// 1. å®šä¹‰ç±»çº§åˆ«çš„æ³¨è§£
@Target({ElementType.TYPE})  // ç”¨åœ¨ç±»ä¸Š
@Retention(RetentionPolicy.RUNTIME)
@Constraint(validatedBy = PasswordMatchValidator.class)
public @interface PasswordMatch {
    String message() default "ä¸¤æ¬¡å¯†ç è¾“å…¥ä¸ä¸€è‡´";
    Class<?>[] groups() default {};
    Class<? extends Payload>[] payload() default {};
}

// 2. éªŒè¯å™¨å®ç°
public class PasswordMatchValidator implements ConstraintValidator<PasswordMatch, Object> {
    
    @Override
    public boolean isValid(Object obj, ConstraintValidatorContext context) {
        // é€šè¿‡åå°„è·å–å­—æ®µå€¼
        try {
            Field passwordField = obj.getClass().getDeclaredField("password");
            Field confirmField = obj.getClass().getDeclaredField("confirmPassword");
            
            passwordField.setAccessible(true);
            confirmField.setAccessible(true);
            
            String password = (String) passwordField.get(obj);
            String confirm = (String) confirmField.get(obj);
            
            return password != null && password.equals(confirm);
        } catch (Exception e) {
            return false;
        }
    }
}

// 3. åœ¨ç±»ä¸Šä½¿ç”¨
@PasswordMatch  // éªŒè¯æ•´ä¸ªç±»
public class RegisterRequest {
    private String password;
    private String confirmPassword;
}
```

---

## 8. ğŸ’¼ å®æˆ˜åº”ç”¨åœºæ™¯


### 8.1 Controllerå±‚éªŒè¯


**RESTful APIçš„éªŒè¯å®è·µ**ï¼š

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    // æ–°å¢ç”¨æˆ·
    @PostMapping
    public ResponseEntity<?> createUser(@Valid @RequestBody User user) {
        // @Validè§¦å‘éªŒè¯ï¼ŒéªŒè¯å¤±è´¥ä¼šè‡ªåŠ¨æŠ›å¼‚å¸¸
        userService.save(user);
        return ResponseEntity.ok("åˆ›å»ºæˆåŠŸ");
    }
    
    // æ›´æ–°ç”¨æˆ·
    @PutMapping("/{id}")
    public ResponseEntity<?> updateUser(
            @PathVariable Long id,
            @Validated(UpdateGroup.class) @RequestBody User user) {
        userService.update(id, user);
        return ResponseEntity.ok("æ›´æ–°æˆåŠŸ");
    }
    
    // éªŒè¯è·¯å¾„å‚æ•°
    @GetMapping("/{id}")
    public ResponseEntity<?> getUser(
            @PathVariable @Min(1) Long id) {  // éªŒè¯è·¯å¾„å‚æ•°
        User user = userService.findById(id);
        return ResponseEntity.ok(user);
    }
}
```

### 8.2 å…¨å±€å¼‚å¸¸å¤„ç†


**ç»Ÿä¸€å¤„ç†éªŒè¯å¼‚å¸¸**ï¼š

```java
@RestControllerAdvice
public class GlobalExceptionHandler {
    
    // å¤„ç†@ValidéªŒè¯å¤±è´¥çš„å¼‚å¸¸
    @ExceptionHandler(MethodArgumentNotValidException.class)
    public ResponseEntity<?> handleValidationException(MethodArgumentNotValidException ex) {
        // è·å–æ‰€æœ‰éªŒè¯é”™è¯¯
        Map<String, String> errors = new HashMap<>();
        ex.getBindingResult().getFieldErrors().forEach(error -> {
            errors.put(error.getField(), error.getDefaultMessage());
        });
        
        return ResponseEntity.badRequest().body(errors);
    }
    
    // å¤„ç†@ValidatedéªŒè¯å¤±è´¥çš„å¼‚å¸¸
    @ExceptionHandler(ConstraintViolationException.class)
    public ResponseEntity<?> handleConstraintViolation(ConstraintViolationException ex) {
        Set<String> errors = new HashSet<>();
        ex.getConstraintViolations().forEach(violation -> {
            errors.add(violation.getMessage());
        });
        
        return ResponseEntity.badRequest().body(errors);
    }
}
```

**è¿”å›ç»“æœç¤ºä¾‹**ï¼š

```json
// éªŒè¯å¤±è´¥æ—¶çš„å“åº”
{
    "username": "ç”¨æˆ·åä¸èƒ½ä¸ºç©º",
    "email": "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®",
    "age": "å¹´é¾„å¿…é¡»å¤§äº0"
}
```

### 8.3 Serviceå±‚éªŒè¯


**åœ¨ä¸šåŠ¡å±‚ä¹Ÿå¯ä»¥ä½¿ç”¨éªŒè¯**ï¼š

```java
@Service
@Validated  // åœ¨ç±»ä¸ŠåŠ @Validated
public class UserService {
    
    // æ–¹æ³•å‚æ•°éªŒè¯
    public void updateEmail(@NotBlank @Email String email, @Min(1) Long userId) {
        // å‚æ•°ä¼šè‡ªåŠ¨éªŒè¯
    }
    
    // è¿”å›å€¼éªŒè¯
    @NotNull
    public User findUser(Long id) {
        // å¦‚æœè¿”å›nullï¼Œä¼šæŠ›å‡ºå¼‚å¸¸
        return userRepository.findById(id).orElse(null);
    }
}
```

### 8.4 åµŒå¥—å¯¹è±¡éªŒè¯


**çº§è”éªŒè¯å¤æ‚å¯¹è±¡**ï¼š

```java
public class Order {
    @NotNull
    private Long orderId;
    
    @Valid  // éªŒè¯åµŒå¥—çš„ç”¨æˆ·å¯¹è±¡
    @NotNull
    private User user;
    
    @Valid  // éªŒè¯é›†åˆä¸­çš„æ¯ä¸ªå•†å“
    @NotEmpty
    private List<OrderItem> items;
}

public class OrderItem {
    @NotNull
    private Long productId;
    
    @Positive
    private Integer quantity;
}
```

**éªŒè¯æµç¨‹**ï¼š

```
éªŒè¯Orderå¯¹è±¡
    â”œâ”€â”€ éªŒè¯orderId
    â”œâ”€â”€ éªŒè¯userï¼ˆå› ä¸ºæœ‰@Validï¼‰
    â”‚   â”œâ”€â”€ éªŒè¯user.username
    â”‚   â””â”€â”€ éªŒè¯user.email
    â””â”€â”€ éªŒè¯itemsåˆ—è¡¨ï¼ˆå› ä¸ºæœ‰@Validï¼‰
        â”œâ”€â”€ éªŒè¯items[0].productId
        â”œâ”€â”€ éªŒè¯items[0].quantity
        â””â”€â”€ ...
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æ•°æ®éªŒè¯æœ¬è´¨ï¼šåœ¨æ•°æ®è¿›å…¥ç³»ç»Ÿå‰è¿›è¡Œæ‹¦æˆªæ£€æŸ¥
ğŸ”¸ JSR-303è§„èŒƒï¼šJavaçš„éªŒè¯æ ‡å‡†ï¼Œå®šä¹‰äº†éªŒè¯çš„æ¥å£å’Œè§„åˆ™
ğŸ”¸ Hibernate Validatorï¼šæœ€æµè¡Œçš„éªŒè¯æ¡†æ¶å®ç°
ğŸ”¸ éªŒè¯æ³¨è§£ï¼šç”¨æ³¨è§£å£°æ˜éªŒè¯è§„åˆ™ï¼Œä»£ç ç®€æ´æ¸…æ™°
ğŸ”¸ éªŒè¯ç»„ï¼šåŒä¸€å¯¹è±¡åœ¨ä¸åŒåœºæ™¯ä½¿ç”¨ä¸åŒéªŒè¯è§„åˆ™
ğŸ”¸ éªŒè¯é¡ºåºï¼šæ§åˆ¶éªŒè¯æ‰§è¡Œçš„å…ˆåé¡ºåº
ğŸ”¸ è‡ªå®šä¹‰éªŒè¯ï¼šæ‰©å±•æ¡†æ¶ï¼Œå®ç°ä¸šåŠ¡ç‰¹å®šçš„éªŒè¯é€»è¾‘
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ éªŒè¯æ—¶æœºçš„é€‰æ‹©**ï¼š

```
Controllerå±‚éªŒè¯ï¼ˆæ¨èï¼‰ï¼š
â”œâ”€â”€ éªŒè¯å‰ç«¯ä¼ å…¥çš„å‚æ•°
â”œâ”€â”€ ä½¿ç”¨@Validæˆ–@Validated
â””â”€â”€ ç¬¬ä¸€é“é˜²çº¿

Serviceå±‚éªŒè¯ï¼š
â”œâ”€â”€ éªŒè¯ä¸šåŠ¡é€»è¾‘çš„å‚æ•°
â”œâ”€â”€ ç±»ä¸ŠåŠ @Validated
â””â”€â”€ ç¬¬äºŒé“é˜²çº¿

ä¸¤å±‚éªŒè¯ç»“åˆä½¿ç”¨æœ€å®‰å…¨
```

**ğŸ”¹ @Valid vs @Validated**ï¼š

| ç‰¹æ€§ | @Valid | @Validated |
|------|--------|-----------|
| **æ¥æº** | JSR-303æ ‡å‡† | Springæä¾› |
| **éªŒè¯ç»„** | ä¸æ”¯æŒ | æ”¯æŒ |
| **åµŒå¥—éªŒè¯** | æ”¯æŒ | æ”¯æŒ |
| **æ–¹æ³•çº§åˆ«** | ä¸æ”¯æŒ | æ”¯æŒ |
| **ä½¿ç”¨åœºæ™¯** | ç®€å•éªŒè¯ | éœ€è¦åˆ†ç»„æ—¶ |

**ğŸ”¹ å¸¸ç”¨æ³¨è§£é€ŸæŸ¥**ï¼š

```
ç©ºå€¼éªŒè¯ï¼š
â”œâ”€â”€ @NotNull      â†’ å¯¹è±¡ä¸èƒ½ä¸ºnull
â”œâ”€â”€ @NotEmpty     â†’ å­—ç¬¦ä¸²/é›†åˆä¸èƒ½ä¸ºç©º
â””â”€â”€ @NotBlank     â†’ å­—ç¬¦ä¸²ä¸èƒ½ä¸ºç©ºç™½ï¼ˆæœ€ä¸¥æ ¼ï¼‰

æ•°å€¼éªŒè¯ï¼š
â”œâ”€â”€ @Min/@Max     â†’ æ•´æ•°èŒƒå›´
â”œâ”€â”€ @Positive     â†’ æ­£æ•°
â””â”€â”€ @DecimalMin/@DecimalMax â†’ å°æ•°èŒƒå›´

æ ¼å¼éªŒè¯ï¼š
â”œâ”€â”€ @Email        â†’ é‚®ç®±æ ¼å¼
â”œâ”€â”€ @Pattern      â†’ æ­£åˆ™è¡¨è¾¾å¼
â””â”€â”€ @Size         â†’ é•¿åº¦/ä¸ªæ•°

æ—¶é—´éªŒè¯ï¼š
â”œâ”€â”€ @Past         â†’ è¿‡å»æ—¶é—´
â””â”€â”€ @Future       â†’ æœªæ¥æ—¶é—´
```

### 9.3 å®æˆ˜æœ€ä½³å®è·µ


**âœ… æ¨èåšæ³•**ï¼š

```java
// 1. é”™è¯¯æ¶ˆæ¯ä½¿ç”¨å›½é™…åŒ–
@NotBlank(message = "{user.username.notblank}")
private String username;

// 2. ä½¿ç”¨éªŒè¯ç»„ç®¡ç†å¤æ‚åœºæ™¯
@Validated(CreateGroup.class)

// 3. å…¨å±€å¼‚å¸¸å¤„ç†ç»Ÿä¸€è¿”å›æ ¼å¼
@RestControllerAdviceå¤„ç†æ‰€æœ‰éªŒè¯å¼‚å¸¸

// 4. å¤æ‚éªŒè¯ä½¿ç”¨è‡ªå®šä¹‰éªŒè¯å™¨
@IdCardè‡ªå®šä¹‰éªŒè¯èº«ä»½è¯

// 5. åµŒå¥—å¯¹è±¡è®°å¾—åŠ @Valid
@Valid
private Address address;
```

**âŒ å¸¸è§é”™è¯¯**ï¼š

```java
// é”™è¯¯1ï¼šå¿˜è®°åŠ @Valid/@Validated
public void save(User user) {  // ä¸ä¼šè§¦å‘éªŒè¯ï¼
    
// é”™è¯¯2ï¼šé›†åˆå…ƒç´ å¿˜è®°åŠ @Valid
private List<Item> items;  // ä¸ä¼šéªŒè¯Itemå†…éƒ¨å­—æ®µ

// é”™è¯¯3ï¼šåœ¨éSpringç®¡ç†çš„ç±»ä¸­ä½¿ç”¨
public class MyClass {  // æ™®é€šç±»ï¼ŒéªŒè¯ä¸ç”Ÿæ•ˆ
    @NotNull
    private String field;
}
```

### 9.4 å­¦ä¹ æ£€éªŒæ¸…å•


**è‡ªæˆ‘æ£€æµ‹**ï¼š

- [ ] ç†è§£ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®éªŒè¯æ¡†æ¶
- [ ] èƒ½åŒºåˆ†JSR-303è§„èŒƒå’ŒHibernate Validatorå®ç°
- [ ] æŒæ¡å¸¸ç”¨éªŒè¯æ³¨è§£çš„ä½¿ç”¨
- [ ] ç†è§£éªŒè¯ç»„çš„æ¦‚å¿µå’Œä½¿ç”¨åœºæ™¯
- [ ] ä¼šæ§åˆ¶éªŒè¯é¡ºåº
- [ ] èƒ½ç¼–å†™è‡ªå®šä¹‰éªŒè¯å™¨
- [ ] èƒ½å¤„ç†éªŒè¯å¼‚å¸¸å¹¶è¿”å›å‹å¥½çš„é”™è¯¯ä¿¡æ¯
- [ ] ç†è§£@Validå’Œ@Validatedçš„åŒºåˆ«

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
æ•°æ®éªŒè¯å¾ˆé‡è¦ï¼Œæ³¨è§£å£°æ˜è§„åˆ™å¥½
ç©ºå€¼æ ¼å¼æ•°å€¼å…¨ï¼Œé‚®ç®±æ‰‹æœºæ­£åˆ™å¦™
éªŒè¯åˆ†ç»„åœºæ™¯åˆ†ï¼Œå…ˆåé¡ºåºè¦è®°ç‰¢
è‡ªå®šä¹‰æ³¨è§£ä¸éš¾å†™ï¼Œå¼‚å¸¸å¤„ç†ç»Ÿä¸€æŠ›
```