---
title: 35ã€CriteriaåŸºç¡€æ“ä½œ
---
## ğŸ“š ç›®å½•

1. [CriteriaæŸ¥è¯¢æ¦‚è¿°](#1-CriteriaæŸ¥è¯¢æ¦‚è¿°)
2. [Criteriaå¯¹è±¡åˆ›å»º](#2-Criteriaå¯¹è±¡åˆ›å»º)
3. [Restrictionsé™åˆ¶æ¡ä»¶](#3-Restrictionsé™åˆ¶æ¡ä»¶)
4. [åŠ¨æ€æŸ¥è¯¢æ„å»º](#4-åŠ¨æ€æŸ¥è¯¢æ„å»º)
5. [ç±»å‹å®‰å…¨æŸ¥è¯¢](#5-ç±»å‹å®‰å…¨æŸ¥è¯¢)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” CriteriaæŸ¥è¯¢æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯CriteriaæŸ¥è¯¢


**é€šä¿—ç†è§£**ï¼š
CriteriaæŸ¥è¯¢å°±åƒæ˜¯ç”¨"æ­ç§¯æœ¨"çš„æ–¹å¼æ¥æ„å»ºæŸ¥è¯¢æ¡ä»¶ï¼Œä¸ç”¨å†™SQLè¯­å¥ï¼Œè€Œæ˜¯ç”¨Javaä»£ç ä¸€æ­¥æ­¥ç»„è£…æŸ¥è¯¢æ¡ä»¶ã€‚

```
ä¼ ç»ŸSQLå†™æ³•ï¼š
SELECT * FROM user WHERE age > 18 AND name LIKE '%å¼ %'

Criteriaå†™æ³•ï¼ˆæ­ç§¯æœ¨ï¼‰ï¼š
ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæŸ¥è¯¢å¯¹è±¡
ç¬¬äºŒæ­¥ï¼šæ·»åŠ å¹´é¾„æ¡ä»¶ age > 18
ç¬¬ä¸‰æ­¥ï¼šæ·»åŠ å§“åæ¡ä»¶ nameåŒ…å«"å¼ "
ç¬¬å››æ­¥ï¼šæ‰§è¡ŒæŸ¥è¯¢
```

**ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦Criteria**ï¼š
- **åŠ¨æ€æŸ¥è¯¢åœºæ™¯**ï¼šæŸ¥è¯¢æ¡ä»¶ä¸å›ºå®šï¼Œéœ€è¦æ ¹æ®ç”¨æˆ·è¾“å…¥åŠ¨æ€ç»„è£…
- **ç±»å‹å®‰å…¨**ï¼šç¼–è¯‘æœŸå°±èƒ½å‘ç°é”™è¯¯ï¼Œä¸ç”¨ç­‰åˆ°è¿è¡Œæ—¶
- **é¢å‘å¯¹è±¡**ï¼šç”¨Javaå¯¹è±¡è€Œä¸æ˜¯å­—ç¬¦ä¸²æ‹¼æ¥SQL
- **å¯ç»´æŠ¤æ€§**ï¼šä»£ç æ›´æ¸…æ™°ï¼Œä¸å®¹æ˜“å‡ºé”™

### 1.2 Criteria vs HQL vs SQLå¯¹æ¯”


```
ç”¨æˆ·æœç´¢åœºæ™¯ï¼šæ ¹æ®å§“åã€å¹´é¾„ã€åŸå¸‚æœç´¢ç”¨æˆ·
æ¡ä»¶ä¸å›ºå®šï¼šç”¨æˆ·å¯èƒ½åªè¾“å…¥å§“åï¼Œæˆ–åªè¾“å…¥å¹´é¾„ï¼Œæˆ–ç»„åˆè¾“å…¥

âŒ ä¼ ç»ŸSQLæ‹¼æ¥ï¼ˆå®¹æ˜“å‡ºé”™ï¼‰ï¼š
String sql = "SELECT * FROM user WHERE 1=1";
if (name != null) sql += " AND name LIKE '%" + name + "%'";
if (age != null) sql += " AND age = " + age;
// é—®é¢˜ï¼šSQLæ³¨å…¥é£é™©ã€å­—ç¬¦ä¸²æ‹¼æ¥æ··ä¹±

âš ï¸ HQLåŠ¨æ€æ‹¼æ¥ï¼ˆç¨å¥½ä½†ä»ç¹çï¼‰ï¼š
String hql = "FROM User WHERE 1=1";
if (name != null) hql += " AND name LIKE :name";
if (age != null) hql += " AND age = :age";
// é—®é¢˜ï¼šä»éœ€å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œä¸å¤Ÿä¼˜é›…

âœ… Criteriaæ–¹å¼ï¼ˆæ¨èï¼‰ï¼š
Criteria criteria = session.createCriteria(User.class);
if (name != null) criteria.add(Restrictions.like("name", "%" + name + "%"));
if (age != null) criteria.add(Restrictions.eq("age", age));
List<User> users = criteria.list();
// ä¼˜åŠ¿ï¼šæ¸…æ™°ã€å®‰å…¨ã€æ˜“ç»´æŠ¤
```

| æŸ¥è¯¢æ–¹å¼ | **ä¼˜ç‚¹** | **ç¼ºç‚¹** | **é€‚ç”¨åœºæ™¯** |
|---------|---------|---------|-------------|
| ğŸ’¾ **åŸç”ŸSQL** | `æ•°æ®åº“ç‰¹æ€§æ”¯æŒå¥½` | `æ•°æ®åº“ä¾èµ–å¼ºï¼ŒSQLæ³¨å…¥é£é™©` | `å¤æ‚æŸ¥è¯¢ã€æ€§èƒ½è¦æ±‚é«˜` |
| ğŸ“ **HQL** | `é¢å‘å¯¹è±¡ï¼Œæ•°æ®åº“æ— å…³` | `åŠ¨æ€æŸ¥è¯¢éœ€å­—ç¬¦ä¸²æ‹¼æ¥` | `å›ºå®šæ¡ä»¶æŸ¥è¯¢` |
| ğŸ”§ **Criteria** | `ç±»å‹å®‰å…¨ï¼ŒåŠ¨æ€æŸ¥è¯¢å¼º` | `å¤æ‚æŸ¥è¯¢è¡¨è¾¾èƒ½åŠ›æœ‰é™` | `æ¡ä»¶ä¸å›ºå®šçš„æŸ¥è¯¢` |

---

## 2. ğŸ› ï¸ Criteriaå¯¹è±¡åˆ›å»º


### 2.1 åŸºæœ¬åˆ›å»ºæ–¹å¼


**é€šä¿—è¯´æ˜**ï¼š
åˆ›å»ºCriteriaå°±åƒå¼€å¯ä¸€ä¸ª"æŸ¥è¯¢å·¥ä½œå°"ï¼Œä½ è¦å‘Šè¯‰Hibernateï¼š"æˆ‘è¦æŸ¥è¯¢å“ªå¼ è¡¨ï¼ˆå“ªä¸ªå®ä½“ç±»ï¼‰"ã€‚

```java
// ğŸ“Œ æœ€åŸºæœ¬çš„åˆ›å»ºæ–¹å¼
Session session = sessionFactory.openSession();
Criteria criteria = session.createCriteria(User.class);

// ç­‰ä»·SQLç†è§£ï¼š
// SELECT * FROM user  ï¼ˆè¿˜æ²¡åŠ ä»»ä½•æ¡ä»¶ï¼‰
```

**ğŸ’¡ å®ä½“ç±»ç¤ºä¾‹**ï¼š
```java
// Userå®ä½“ç±»ï¼ˆæ˜ å°„åˆ°æ•°æ®åº“userè¡¨ï¼‰
@Entity
@Table(name = "user")
public class User {
    @Id
    private Long id;
    private String name;
    private Integer age;
    private String city;
    
    // getter/setterçœç•¥
}
```

### 2.2 å¸¦åˆ«ååˆ›å»ºï¼ˆå…³è”æŸ¥è¯¢ç”¨ï¼‰


**é€šä¿—ç†è§£**ï¼š
å½“ä½ éœ€è¦æŸ¥è¯¢å¤šä¸ªè¡¨ï¼ˆå¤šä¸ªå®ä½“ï¼‰çš„æ•°æ®æ—¶ï¼Œç»™æ¯ä¸ªè¡¨èµ·ä¸ª"å¤–å·"ï¼Œæ–¹ä¾¿åŒºåˆ†ã€‚

```java
// ğŸ“Œ ç»™ä¸»è¡¨èµ·åˆ«å
Criteria criteria = session.createCriteria(User.class, "u");

// æ·»åŠ å…³è”è¡¨æŸ¥è¯¢
criteria.createAlias("u.orders", "o");  // å…³è”è®¢å•è¡¨ï¼Œåˆ«åä¸ºo

// ç­‰ä»·SQLç†è§£ï¼š
// SELECT * FROM user u
// LEFT JOIN orders o ON u.id = o.user_id
```

**ğŸ” å®é™…åœºæ™¯ç¤ºä¾‹**ï¼š
```java
// åœºæ™¯ï¼šæŸ¥è¯¢"è´­ä¹°è¿‡å•†å“çš„ç”¨æˆ·"
Criteria criteria = session.createCriteria(User.class, "u");
criteria.createAlias("u.orders", "o");  // å…³è”è®¢å•
criteria.add(Restrictions.isNotNull("o.id"));  // è®¢å•IDä¸ä¸ºç©º

// äººè¯ç¿»è¯‘ï¼š
// ç»™æˆ‘æ‰¾å‡ºæœ‰è®¢å•è®°å½•çš„ç”¨æˆ·
```

### 2.3 åˆ›å»ºæ–¹å¼å¯¹æ¯”


```
åœºæ™¯ä¸€ï¼šæŸ¥è¯¢å•è¡¨æ•°æ®
â†’ ä½¿ç”¨ï¼šsession.createCriteria(User.class)
â†’ é€‚åˆï¼šç®€å•æŸ¥è¯¢ï¼Œä¸æ¶‰åŠå…³è”

åœºæ™¯äºŒï¼šéœ€è¦å…³è”å…¶ä»–è¡¨
â†’ ä½¿ç”¨ï¼šsession.createCriteria(User.class, "åˆ«å")
â†’ é€‚åˆï¼šå¤æ‚æŸ¥è¯¢ï¼Œå¤šè¡¨å…³è”

åœºæ™¯ä¸‰ï¼šå­æŸ¥è¯¢æˆ–å¤æ‚æ¡ä»¶
â†’ ä½¿ç”¨ï¼šDetachedCriteriaï¼ˆåé¢ç« èŠ‚è®²ï¼‰
â†’ é€‚åˆï¼šéœ€è¦åœ¨Serviceå±‚æ„å»ºæŸ¥è¯¢
```

---

## 3. ğŸ¯ Restrictionsé™åˆ¶æ¡ä»¶


### 3.1 Restrictionsæ˜¯ä»€ä¹ˆ


**é€šä¿—ç†è§£**ï¼š
Restrictionså°±æ˜¯"æ¡ä»¶å·¥å…·ç®±"ï¼Œé‡Œé¢è£…äº†å„ç§æŸ¥è¯¢æ¡ä»¶ï¼ˆç­‰äºã€å¤§äºã€æ¨¡ç³ŠæŸ¥è¯¢ç­‰ï¼‰ï¼Œä½ éœ€è¦ä»€ä¹ˆæ¡ä»¶å°±ä»å·¥å…·ç®±é‡Œæ‹¿ä»€ä¹ˆã€‚

```
Restrictionså·¥å…·ç®±ï¼š
ğŸ“¦ eq()      â†’ ç­‰äºï¼ˆequalï¼‰
ğŸ“¦ ne()      â†’ ä¸ç­‰äºï¼ˆnot equalï¼‰
ğŸ“¦ gt()      â†’ å¤§äºï¼ˆgreater thanï¼‰
ğŸ“¦ lt()      â†’ å°äºï¼ˆless thanï¼‰
ğŸ“¦ like()    â†’ æ¨¡ç³ŠæŸ¥è¯¢
ğŸ“¦ between() â†’ èŒƒå›´æŸ¥è¯¢
ğŸ“¦ isNull()  â†’ ä¸ºç©º
ğŸ“¦ in()      â†’ åŒ…å«äº
... è¿˜æœ‰æ›´å¤š
```

### 3.2 å¸¸ç”¨æ¡ä»¶è¯¦è§£


#### ğŸ”¸ ç­‰å€¼æ¡ä»¶ï¼ˆeqï¼‰


**äººè¯è¯´æ˜**ï¼šæŸ¥æ‰¾æŸä¸ªå­—æ®µ**å®Œå…¨ç­‰äº**æŒ‡å®šå€¼çš„æ•°æ®

```java
// æŸ¥è¯¢å¹´é¾„ç­‰äº18çš„ç”¨æˆ·
criteria.add(Restrictions.eq("age", 18));

// ç­‰ä»·SQLï¼š
// WHERE age = 18

// å®é™…ä½¿ç”¨ï¼š
List<User> users = criteria.list();
// ç»“æœï¼šæ‰€æœ‰18å²çš„ç”¨æˆ·
```

#### ğŸ”¸ ä¸ç­‰å€¼æ¡ä»¶ï¼ˆneï¼‰


```java
// æŸ¥è¯¢åŸå¸‚ä¸æ˜¯åŒ—äº¬çš„ç”¨æˆ·
criteria.add(Restrictions.ne("city", "åŒ—äº¬"));

// ç­‰ä»·SQLï¼š
// WHERE city != 'åŒ—äº¬'
```

#### ğŸ”¸ æ¯”è¾ƒæ¡ä»¶ï¼ˆgt/lt/ge/leï¼‰


**è®°å¿†æŠ€å·§**ï¼š
- `gt` = **g**reater **t**hanï¼ˆå¤§äºï¼‰
- `lt` = **l**ess **t**hanï¼ˆå°äºï¼‰
- `ge` = **g**reater or **e**qualï¼ˆå¤§äºç­‰äºï¼‰
- `le` = **l**ess or **e**qualï¼ˆå°äºç­‰äºï¼‰

```java
// æŸ¥è¯¢å¹´é¾„å¤§äº18çš„ç”¨æˆ·
criteria.add(Restrictions.gt("age", 18));
// SQL: WHERE age > 18

// æŸ¥è¯¢å¹´é¾„å°äºç­‰äº30çš„ç”¨æˆ·
criteria.add(Restrictions.le("age", 30));
// SQL: WHERE age <= 30

// ç»„åˆä½¿ç”¨ï¼šæŸ¥è¯¢18-30å²çš„ç”¨æˆ·
criteria.add(Restrictions.ge("age", 18));
criteria.add(Restrictions.le("age", 30));
// SQL: WHERE age >= 18 AND age <= 30
```

#### ğŸ”¸ æ¨¡ç³ŠæŸ¥è¯¢ï¼ˆlikeï¼‰


**é€šä¿—è¯´æ˜**ï¼šæŸ¥æ‰¾**åŒ…å«**æŸäº›å­—ç¬¦çš„æ•°æ®ï¼Œç±»ä¼¼"æœç´¢æ¡†"åŠŸèƒ½

```java
// æŸ¥è¯¢å§“ååŒ…å«"å¼ "çš„ç”¨æˆ·
criteria.add(Restrictions.like("name", "%å¼ %"));
// SQL: WHERE name LIKE '%å¼ %'

// æŸ¥è¯¢å§“åä»¥"æ"å¼€å¤´çš„ç”¨æˆ·
criteria.add(Restrictions.like("name", "æ%"));
// SQL: WHERE name LIKE 'æ%'

// æŸ¥è¯¢å§“åä»¥"æ˜"ç»“å°¾çš„ç”¨æˆ·
criteria.add(Restrictions.like("name", "%æ˜"));
// SQL: WHERE name LIKE '%æ˜'
```

**ğŸ’¡ æ¨¡ç³ŠæŸ¥è¯¢æŠ€å·§**ï¼š
```
%å¼ %  â†’ åŒ…å«"å¼ "      â†’ å¼ ä¸‰ã€å°å¼ ã€å¼ å­¦å‹
å¼ %   â†’ ä»¥"å¼ "å¼€å¤´    â†’ å¼ ä¸‰ã€å¼ ä¼Ÿ
%å¼    â†’ ä»¥"å¼ "ç»“å°¾    â†’ å°å¼ ã€è€å¼ 
```

#### ğŸ”¸ èŒƒå›´æŸ¥è¯¢ï¼ˆbetweenï¼‰


```java
// æŸ¥è¯¢å¹´é¾„åœ¨18åˆ°30ä¹‹é—´çš„ç”¨æˆ·
criteria.add(Restrictions.between("age", 18, 30));

// ç­‰ä»·SQLï¼š
// WHERE age BETWEEN 18 AND 30
// ç­‰åŒäºï¼šWHERE age >= 18 AND age <= 30
```

#### ğŸ”¸ åŒ…å«æŸ¥è¯¢ï¼ˆinï¼‰


**åœºæ™¯è¯´æ˜**ï¼šæŸ¥è¯¢å­—æ®µå€¼åœ¨æŒ‡å®šåˆ—è¡¨ä¸­çš„æ•°æ®

```java
// æŸ¥è¯¢åŸå¸‚æ˜¯åŒ—äº¬ã€ä¸Šæµ·ã€å¹¿å·çš„ç”¨æˆ·
List<String> cities = Arrays.asList("åŒ—äº¬", "ä¸Šæµ·", "å¹¿å·");
criteria.add(Restrictions.in("city", cities));

// ç­‰ä»·SQLï¼š
// WHERE city IN ('åŒ—äº¬', 'ä¸Šæµ·', 'å¹¿å·')
```

#### ğŸ”¸ ç©ºå€¼åˆ¤æ–­ï¼ˆisNull/isNotNullï¼‰


```java
// æŸ¥è¯¢æ²¡æœ‰å¡«å†™åŸå¸‚çš„ç”¨æˆ·
criteria.add(Restrictions.isNull("city"));
// SQL: WHERE city IS NULL

// æŸ¥è¯¢å·²å¡«å†™åŸå¸‚çš„ç”¨æˆ·
criteria.add(Restrictions.isNotNull("city"));
// SQL: WHERE city IS NOT NULL
```

### 3.3 æ¡ä»¶ç»„åˆï¼ˆAND/ORï¼‰


**é€šä¿—ç†è§£**ï¼š
- **ANDï¼ˆä¸”ï¼‰**ï¼šæ‰€æœ‰æ¡ä»¶éƒ½è¦æ»¡è¶³
- **ORï¼ˆæˆ–ï¼‰**ï¼šæ»¡è¶³å…¶ä¸­ä¸€ä¸ªæ¡ä»¶å³å¯

```java
// âœ… ANDç»„åˆï¼šå¹´é¾„å¤§äº18 ä¸” åŸå¸‚æ˜¯åŒ—äº¬
Criteria criteria = session.createCriteria(User.class);
criteria.add(Restrictions.gt("age", 18));        // æ¡ä»¶1
criteria.add(Restrictions.eq("city", "åŒ—äº¬"));    // æ¡ä»¶2
// é»˜è®¤æ˜¯ANDå…³ç³»
// SQL: WHERE age > 18 AND city = 'åŒ—äº¬'

// âœ… ORç»„åˆï¼šå¹´é¾„å¤§äº18 æˆ– åŸå¸‚æ˜¯åŒ—äº¬
Criteria criteria = session.createCriteria(User.class);
Criterion condition = Restrictions.or(
    Restrictions.gt("age", 18),
    Restrictions.eq("city", "åŒ—äº¬")
);
criteria.add(condition);
// SQL: WHERE age > 18 OR city = 'åŒ—äº¬'
```

**ğŸ”¥ å¤æ‚ç»„åˆç¤ºä¾‹**ï¼š
```java
// åœºæ™¯ï¼šæŸ¥è¯¢"(å¹´é¾„>18ä¸”åŸå¸‚æ˜¯åŒ—äº¬) æˆ– (å§“ååŒ…å«å¼ )"
Criterion condition = Restrictions.or(
    Restrictions.and(
        Restrictions.gt("age", 18),
        Restrictions.eq("city", "åŒ—äº¬")
    ),
    Restrictions.like("name", "%å¼ %")
);
criteria.add(condition);

// SQLç†è§£ï¼š
// WHERE (age > 18 AND city = 'åŒ—äº¬') OR name LIKE '%å¼ %'
```

---

## 4. ğŸ”„ åŠ¨æ€æŸ¥è¯¢æ„å»º


### 4.1 ä¸ºä»€ä¹ˆéœ€è¦åŠ¨æ€æŸ¥è¯¢


**å®é™…åœºæ™¯**ï¼š
ç”¨æˆ·åœ¨æœç´¢æ¡†è¾“å…¥æ¡ä»¶ï¼Œå¯èƒ½åªè¾“å…¥å§“åï¼Œå¯èƒ½åªè¾“å…¥å¹´é¾„ï¼Œä¹Ÿå¯èƒ½ä¸¤è€…éƒ½è¾“å…¥ã€‚æŸ¥è¯¢æ¡ä»¶æ˜¯**ä¸ç¡®å®šçš„**ï¼Œéœ€è¦æ ¹æ®ç”¨æˆ·è¾“å…¥**åŠ¨æ€ç»„è£…**ã€‚

```
æœç´¢ç•Œé¢ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å§“åï¼š[        ]        â”‚  â† ç”¨æˆ·å¯èƒ½å¡«ï¼Œå¯èƒ½ä¸å¡«
â”‚ å¹´é¾„ï¼š[        ]        â”‚  â† ç”¨æˆ·å¯èƒ½å¡«ï¼Œå¯èƒ½ä¸å¡«
â”‚ åŸå¸‚ï¼š[        ]        â”‚  â† ç”¨æˆ·å¯èƒ½å¡«ï¼Œå¯èƒ½ä¸å¡«
â”‚        [æœç´¢]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é—®é¢˜ï¼šå¦‚ä½•æ ¹æ®ç”¨æˆ·å®é™…å¡«å†™çš„å†…å®¹ç”ŸæˆæŸ¥è¯¢ï¼Ÿ
```

### 4.2 åŠ¨æ€æŸ¥è¯¢å®ç°æ–¹å¼


```java
// ğŸ“Œ æ¥æ”¶ç”¨æˆ·è¾“å…¥å‚æ•°
public List<User> searchUsers(String name, Integer age, String city) {
    Session session = sessionFactory.openSession();
    Criteria criteria = session.createCriteria(User.class);
    
    // âœ… åŠ¨æ€æ·»åŠ æ¡ä»¶ï¼šç”¨æˆ·è¾“å…¥äº†ä»€ä¹ˆå°±æŸ¥ä»€ä¹ˆ
    if (name != null && !name.isEmpty()) {
        criteria.add(Restrictions.like("name", "%" + name + "%"));
    }
    
    if (age != null) {
        criteria.add(Restrictions.eq("age", age));
    }
    
    if (city != null && !city.isEmpty()) {
        criteria.add(Restrictions.eq("city", city));
    }
    
    return criteria.list();
}
```

**ğŸ’¡ æ‰§è¡Œæµç¨‹æ¼”ç¤º**ï¼š
```
åœºæ™¯1ï¼šç”¨æˆ·åªè¾“å…¥å§“å"å¼ ä¸‰"
â†’ ç”Ÿæˆæ¡ä»¶ï¼šWHERE name LIKE '%å¼ ä¸‰%'

åœºæ™¯2ï¼šç”¨æˆ·åªè¾“å…¥å¹´é¾„18
â†’ ç”Ÿæˆæ¡ä»¶ï¼šWHERE age = 18

åœºæ™¯3ï¼šç”¨æˆ·è¾“å…¥å§“å"å¼ ä¸‰"å’Œå¹´é¾„18
â†’ ç”Ÿæˆæ¡ä»¶ï¼šWHERE name LIKE '%å¼ ä¸‰%' AND age = 18

åœºæ™¯4ï¼šç”¨æˆ·ä»€ä¹ˆéƒ½ä¸è¾“å…¥
â†’ ç”Ÿæˆæ¡ä»¶ï¼šæ— æ¡ä»¶ï¼ŒæŸ¥è¯¢æ‰€æœ‰æ•°æ®
```

### 4.3 åŠ¨æ€æ’åºä¸åˆ†é¡µ


```java
// ğŸ“Œ åŠ¨æ€æ’åºç¤ºä¾‹
public List<User> searchWithSort(String name, String sortField, String sortOrder) {
    Criteria criteria = session.createCriteria(User.class);
    
    // æ¡ä»¶æŸ¥è¯¢
    if (name != null) {
        criteria.add(Restrictions.like("name", "%" + name + "%"));
    }
    
    // åŠ¨æ€æ’åº
    if (sortField != null) {
        if ("asc".equals(sortOrder)) {
            criteria.addOrder(Order.asc(sortField));   // å‡åº
        } else {
            criteria.addOrder(Order.desc(sortField));  // é™åº
        }
    }
    
    return criteria.list();
}

// ä½¿ç”¨ç¤ºä¾‹ï¼š
// æŒ‰å¹´é¾„å‡åºï¼šsearchWithSort("å¼ ", "age", "asc")
// æŒ‰å§“åé™åºï¼šsearchWithSort("å¼ ", "name", "desc")
```

**ğŸ”¸ åˆ†é¡µæŸ¥è¯¢**ï¼š
```java
// ç¬¬ä¸€é¡µï¼Œæ¯é¡µ10æ¡
criteria.setFirstResult(0);   // ä»ç¬¬0æ¡å¼€å§‹
criteria.setMaxResults(10);   // å–10æ¡

// ç¬¬äºŒé¡µï¼Œæ¯é¡µ10æ¡
criteria.setFirstResult(10);  // ä»ç¬¬10æ¡å¼€å§‹
criteria.setMaxResults(10);   // å–10æ¡

// é€šç”¨åˆ†é¡µè®¡ç®—ï¼š
int pageNum = 2;   // ç¬¬å‡ é¡µ
int pageSize = 10; // æ¯é¡µæ¡æ•°
criteria.setFirstResult((pageNum - 1) * pageSize);
criteria.setMaxResults(pageSize);
```

---

## 5. ğŸ›¡ï¸ ç±»å‹å®‰å…¨æŸ¥è¯¢


### 5.1 ä»€ä¹ˆæ˜¯ç±»å‹å®‰å…¨


**é€šä¿—ç†è§£**ï¼š
ç±»å‹å®‰å…¨å°±æ˜¯"ç¼–è¯‘æœŸå°±èƒ½å‘ç°é”™è¯¯"ï¼Œä¸ç”¨ç­‰åˆ°ç¨‹åºè¿è¡Œæ—¶æ‰æŠ¥é”™ã€‚

```java
// âŒ å­—ç¬¦ä¸²æ–¹å¼ï¼ˆä¸å®‰å…¨ï¼‰ï¼š
criteria.add(Restrictions.eq("agee", 18));  // å±æ€§åæ‹¼å†™é”™è¯¯
// é—®é¢˜ï¼šç¼–è¯‘é€šè¿‡ï¼Œè¿è¡Œæ—¶æ‰æŠ¥é”™

// âœ… ç±»å‹å®‰å…¨æ–¹å¼ï¼š
// ä½¿ç”¨IDEä¼šè‡ªåŠ¨æç¤ºï¼Œæ‹¼å†™é”™è¯¯ç«‹å³å‘ç°
```

### 5.2 å±æ€§åå¸¸é‡åŒ–


**æœ€ä½³å®è·µ**ï¼šæŠŠå±æ€§åå®šä¹‰æˆå¸¸é‡ï¼Œé¿å…æ‹¼å†™é”™è¯¯

```java
// ğŸ“Œ å®šä¹‰å±æ€§åå¸¸é‡
public class UserFields {
    public static final String NAME = "name";
    public static final String AGE = "age";
    public static final String CITY = "city";
}

// ä½¿ç”¨æ—¶ï¼š
criteria.add(Restrictions.eq(UserFields.AGE, 18));
criteria.add(Restrictions.like(UserFields.NAME, "%å¼ %"));

// ä¼˜åŠ¿ï¼š
// âœ… IDEè‡ªåŠ¨æç¤º
// âœ… æ‹¼å†™é”™è¯¯ç¼–è¯‘æœŸå‘ç°
// âœ… ä»£ç å¯è¯»æ€§å¼º
```

### 5.3 JPA Metamodelæ–¹å¼ï¼ˆé«˜çº§ï¼‰


**è¯´æ˜**ï¼šè¿™æ˜¯JPAæä¾›çš„ç±»å‹å®‰å…¨æ–¹æ¡ˆï¼ŒHibernateå®Œå…¨æ”¯æŒ

```java
// Userå®ä½“å…ƒæ¨¡å‹ç±»ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
@StaticMetamodel(User.class)
public class User_ {
    public static volatile SingularAttribute<User, Long> id;
    public static volatile SingularAttribute<User, String> name;
    public static volatile SingularAttribute<User, Integer> age;
}

// ä½¿ç”¨å…ƒæ¨¡å‹ï¼š
CriteriaBuilder cb = session.getCriteriaBuilder();
CriteriaQuery<User> query = cb.createQuery(User.class);
Root<User> root = query.from(User.class);

// ç±»å‹å®‰å…¨çš„æ¡ä»¶ï¼š
query.where(cb.equal(root.get(User_.age), 18));
// å¦‚æœUser_ä¸å­˜åœ¨ageå±æ€§ï¼Œç¼–è¯‘ç›´æ¥æŠ¥é”™
```

### 5.4 ç±»å‹å®‰å…¨çš„ä»·å€¼


```
ä¼ ç»Ÿå­—ç¬¦ä¸²æ–¹å¼çš„é—®é¢˜ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ "agee" (æ‹¼å†™é”™è¯¯)        â”‚ â†’ ç¼–è¯‘é€šè¿‡ âœ…
â”‚ è¿è¡Œæ—¶æŠ¥é”™ âŒ            â”‚ â†’ ç”¨æˆ·çœ‹åˆ°é”™è¯¯é¡µé¢
â”‚ éš¾ä»¥è°ƒè¯•                â”‚ â†’ æµªè´¹æ—¶é—´
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç±»å‹å®‰å…¨æ–¹å¼çš„ä¼˜åŠ¿ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User_.agee (ä¸å­˜åœ¨)      â”‚ â†’ ç¼–è¯‘æŠ¥é”™ âŒ
â”‚ å¼€å‘æ—¶ç«‹å³å‘ç°           â”‚ â†’ é©¬ä¸Šä¿®æ­£
â”‚ ç”Ÿäº§ç¯å¢ƒé›¶é£é™©           â”‚ â†’ ç”¨æˆ·ä½“éªŒå¥½
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Criteriaæœ¬è´¨ï¼šé¢å‘å¯¹è±¡çš„æŸ¥è¯¢æ„å»ºå·¥å…·
ğŸ”¸ Restrictionsï¼šæ¡ä»¶å·¥å…·ç®±ï¼Œæä¾›å„ç§æŸ¥è¯¢æ¡ä»¶
ğŸ”¸ åŠ¨æ€æŸ¥è¯¢ï¼šæ ¹æ®å®é™…æƒ…å†µçµæ´»ç»„è£…æ¡ä»¶
ğŸ”¸ ç±»å‹å®‰å…¨ï¼šç¼–è¯‘æœŸå‘ç°é”™è¯¯ï¼Œé™ä½é£é™©
ğŸ”¸ é€‚ç”¨åœºæ™¯ï¼šæ¡ä»¶ä¸å›ºå®šçš„æŸ¥è¯¢åœºæ™¯
```

### 6.2 Criteriaä½¿ç”¨æµç¨‹


```
æ­¥éª¤1ï¼šåˆ›å»ºSession
   â†“
æ­¥éª¤2ï¼šåˆ›å»ºCriteriaå¯¹è±¡
   â†“
æ­¥éª¤3ï¼šæ·»åŠ æŸ¥è¯¢æ¡ä»¶ï¼ˆRestrictionsï¼‰
   â†“
æ­¥éª¤4ï¼šè®¾ç½®æ’åº/åˆ†é¡µï¼ˆå¯é€‰ï¼‰
   â†“
æ­¥éª¤5ï¼šæ‰§è¡ŒæŸ¥è¯¢ï¼ˆlist/uniqueResultï¼‰
   â†“
æ­¥éª¤6ï¼šå…³é—­Session
```

### 6.3 å¸¸ç”¨Restrictionsé€ŸæŸ¥


| æ–¹æ³• | **å«ä¹‰** | **ç¤ºä¾‹** | **SQLç­‰ä»·** |
|-----|---------|---------|-----------|
| `eq()` | ç­‰äº | `Restrictions.eq("age", 18)` | `WHERE age = 18` |
| `ne()` | ä¸ç­‰äº | `Restrictions.ne("city", "åŒ—äº¬")` | `WHERE city != 'åŒ—äº¬'` |
| `gt()` | å¤§äº | `Restrictions.gt("age", 18)` | `WHERE age > 18` |
| `lt()` | å°äº | `Restrictions.lt("age", 30)` | `WHERE age < 30` |
| `ge()` | å¤§äºç­‰äº | `Restrictions.ge("age", 18)` | `WHERE age >= 18` |
| `le()` | å°äºç­‰äº | `Restrictions.le("age", 30)` | `WHERE age <= 30` |
| `like()` | æ¨¡ç³ŠæŸ¥è¯¢ | `Restrictions.like("name", "%å¼ %")` | `WHERE name LIKE '%å¼ %'` |
| `between()` | èŒƒå›´ | `Restrictions.between("age", 18, 30)` | `WHERE age BETWEEN 18 AND 30` |
| `in()` | åŒ…å« | `Restrictions.in("city", list)` | `WHERE city IN (...)` |
| `isNull()` | ä¸ºç©º | `Restrictions.isNull("city")` | `WHERE city IS NULL` |
| `isNotNull()` | ä¸ä¸ºç©º | `Restrictions.isNotNull("city")` | `WHERE city IS NOT NULL` |

### 6.4 å®æˆ˜æŠ€å·§


> ğŸ’¡ **æŠ€å·§1**ï¼šä¼˜å…ˆä½¿ç”¨Criteriaå¤„ç†åŠ¨æ€æŸ¥è¯¢
> - æ¡ä»¶ä¸å›ºå®šæ—¶ï¼ŒCriteriaæ¯”HQLæ‹¼æ¥æ›´å®‰å…¨
> - é¿å…å­—ç¬¦ä¸²æ‹¼æ¥å¸¦æ¥çš„SQLæ³¨å…¥é£é™©

> âš ï¸ **æŠ€å·§2**ï¼šå¤æ‚æŸ¥è¯¢è€ƒè™‘HQLæˆ–SQL
> - Criteriaé€‚åˆç®€å•åˆ°ä¸­ç­‰å¤æ‚åº¦æŸ¥è¯¢
> - è¶…å¤æ‚çš„ç»Ÿè®¡åˆ†æï¼Œç”¨HQLæˆ–åŸç”ŸSQLæ›´æ¸…æ™°

> ğŸ”¥ **æŠ€å·§3**ï¼šå–„ç”¨å±æ€§å¸¸é‡
> - å®šä¹‰å±æ€§åå¸¸é‡ï¼Œé¿å…ç¡¬ç¼–ç å­—ç¬¦ä¸²
> - æé«˜ä»£ç å¯ç»´æŠ¤æ€§å’Œç±»å‹å®‰å…¨æ€§

> âœ… **æŠ€å·§4**ï¼šåˆç†ä½¿ç”¨åˆ†é¡µ
> - å¤§æ•°æ®é‡æŸ¥è¯¢å¿…é¡»åˆ†é¡µ
> - `setFirstResult()` + `setMaxResults()` å®ç°åˆ†é¡µ

### 6.5 å­¦ä¹ è·¯å¾„å»ºè®®


```
ç¬¬ä¸€é˜¶æ®µï¼šæŒæ¡åŸºç¡€
â”œâ”€ ç†è§£Criteriaçš„ä½œç”¨å’Œä¼˜åŠ¿
â”œâ”€ ç†Ÿç»ƒä½¿ç”¨Restrictionså¸¸ç”¨æ¡ä»¶
â””â”€ èƒ½å®ç°ç®€å•çš„åŠ¨æ€æŸ¥è¯¢

ç¬¬äºŒé˜¶æ®µï¼šæ·±å…¥åº”ç”¨
â”œâ”€ æŒæ¡æ¡ä»¶ç»„åˆï¼ˆAND/ORï¼‰
â”œâ”€ å®ç°å¤æ‚çš„åŠ¨æ€æŸ¥è¯¢
â””â”€ ç†è§£ç±»å‹å®‰å…¨çš„ä»·å€¼

ç¬¬ä¸‰é˜¶æ®µï¼šé«˜çº§æŠ€å·§
â”œâ”€ æŒæ¡å…³è”æŸ¥è¯¢ï¼ˆä¸‹ä¸€ç« ï¼‰
â”œâ”€ ä½¿ç”¨æŠ•å½±å’Œèšåˆï¼ˆä¸‹ä¸€ç« ï¼‰
â””â”€ æ€§èƒ½ä¼˜åŒ–æŠ€å·§
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- Criteria = æ­ç§¯æœ¨å¼æŸ¥è¯¢ï¼Œæ¡ä»¶åŠ¨æ€ç»„è£…
- Restrictions = æ¡ä»¶å·¥å…·ç®±ï¼ŒæŒ‰éœ€å–ç”¨
- ç±»å‹å®‰å…¨ = ç¼–è¯‘æœŸå‘ç°é”™è¯¯ï¼Œç”Ÿäº§ç¯å¢ƒæ›´ç¨³å®š
- åŠ¨æ€æŸ¥è¯¢ = Criteriaçš„æ ¸å¿ƒä»·å€¼æ‰€åœ¨