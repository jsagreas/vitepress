---
title: 18ã€è”åˆå­ç±»æ˜ å°„
---
## ğŸ“š ç›®å½•

1. [è”åˆå­ç±»æ˜ å°„æ¦‚è¿°](#1-è”åˆå­ç±»æ˜ å°„æ¦‚è¿°)
2. [æ ¸å¿ƒæ³¨è§£è¯¦è§£](#2-æ ¸å¿ƒæ³¨è§£è¯¦è§£)
3. [è¡¨ç»“æ„è®¾è®¡](#3-è¡¨ç»“æ„è®¾è®¡)
4. [ä»£ç å®ç°è¯¦è§£](#4-ä»£ç å®ç°è¯¦è§£)
5. [æŸ¥è¯¢ä¸æ€§èƒ½](#5-æŸ¥è¯¢ä¸æ€§èƒ½)
6. [é€‚ç”¨åœºæ™¯åˆ†æ](#6-é€‚ç”¨åœºæ™¯åˆ†æ)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ è”åˆå­ç±»æ˜ å°„æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯è”åˆå­ç±»æ˜ å°„


**é€šä¿—ç†è§£**ï¼šå°±åƒä½ æŠŠä¸€ä¸ªå®Œæ•´çš„ä¿¡æ¯æ‹†åˆ†æˆ"å…¬å…±éƒ¨åˆ†"å’Œ"ä¸“å±éƒ¨åˆ†"åˆ†åˆ«å­˜å‚¨ã€‚

```
ç°å®ä¾‹å­ç†è§£ï¼š
å‘˜å·¥ä¿¡æ¯ç®¡ç† â†’ 
  æ‰€æœ‰å‘˜å·¥éƒ½æœ‰ï¼šå·¥å·ã€å§“åã€å…¥èŒæ—¥æœŸï¼ˆå…¬å…±ä¿¡æ¯ï¼‰
  ç¨‹åºå‘˜è¿˜æœ‰ï¼šç¼–ç¨‹è¯­è¨€ã€é¡¹ç›®ç»éªŒï¼ˆä¸“å±ä¿¡æ¯ï¼‰
  è®¾è®¡å¸ˆè¿˜æœ‰ï¼šè®¾è®¡å·¥å…·ã€ä½œå“é›†ï¼ˆä¸“å±ä¿¡æ¯ï¼‰

è”åˆå­ç±»ç­–ç•¥ï¼š
  employeeè¡¨ â†’ å­˜å…¬å…±ä¿¡æ¯
  programmerè¡¨ â†’ å­˜ç¨‹åºå‘˜ä¸“å±ä¿¡æ¯ï¼ˆé€šè¿‡å·¥å·å…³è”ï¼‰
  designerè¡¨ â†’ å­˜è®¾è®¡å¸ˆä¸“å±ä¿¡æ¯ï¼ˆé€šè¿‡å·¥å·å…³è”ï¼‰
```

**ğŸ’¡ æ ¸å¿ƒæ€æƒ³**
```
ä¸€ä¸ªç»§æ‰¿ä½“ç³» = å¤šä¸ªè¡¨
â€¢ çˆ¶ç±» â†’ å•ç‹¬ä¸€å¼ è¡¨ï¼ˆå­˜å…¬å…±å±æ€§ï¼‰
â€¢ æ¯ä¸ªå­ç±» â†’ å•ç‹¬ä¸€å¼ è¡¨ï¼ˆå­˜ç‰¹æœ‰å±æ€§ï¼‰
â€¢ è¡¨ä¹‹é—´é€šè¿‡ä¸»é”®å…³è”

ç±»æ¯”ç†è§£ï¼š
å°±åƒæ‹¼å›¾ï¼Œçˆ¶ç±»è¡¨æ˜¯åº•æ¿ï¼Œå­ç±»è¡¨æ˜¯å„è‡ªçš„ä¸“å±æ‹¼å›¾å—
```

### 1.2 ä¸å…¶ä»–ç­–ç•¥çš„å¯¹æ¯”


**ğŸ“Š ä¸‰ç§ç»§æ‰¿ç­–ç•¥å¯¹æ¯”**

| ç­–ç•¥ç±»å‹ | è¡¨ç»“æ„ | æ•°æ®å†—ä½™ | æŸ¥è¯¢æ€§èƒ½ | æ‰©å±•æ€§ |
|---------|--------|---------|---------|--------|
| **å•è¡¨ç­–ç•¥** | `1ä¸ªè¡¨` | `é«˜ï¼ˆå¾ˆå¤šnullï¼‰` | `æœ€å¿«` | `å·®` |
| **è”åˆå­ç±»** | `N+1ä¸ªè¡¨` | `æ— ` | `ä¸­ç­‰` | `å¥½` |
| **æ¯ç±»ä¸€è¡¨** | `Nä¸ªè¡¨` | `æœ‰ï¼ˆé‡å¤å±æ€§ï¼‰` | `æœ€æ…¢` | `æœ€å¥½` |

**ğŸ” å½¢è±¡å¯¹æ¯”**
```
å•è¡¨ç­–ç•¥ï¼ˆSINGLE_TABLEï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  employeeï¼ˆä¸€å¼ å¤§è¡¨ï¼‰            â”‚
â”‚  id | name | type | lang | tool â”‚
â”‚  1  | å¼ ä¸‰ | P    | Java | null â”‚ â† ç¨‹åºå‘˜çš„toolæ˜¯null
â”‚  2  | æå›› | D    | null | PS   â”‚ â† è®¾è®¡å¸ˆçš„langæ˜¯null
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ä¼˜ç‚¹ï¼šæŸ¥è¯¢å¿«  ç¼ºç‚¹ï¼šæµªè´¹ç©ºé—´

è”åˆå­ç±»ï¼ˆJOINEDï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  employee    â”‚      â”‚  programmer    â”‚
â”‚  id | name   â”‚â†â”€â”€â”€â”€â†’â”‚  id | language â”‚
â”‚  1  | å¼ ä¸‰   â”‚      â”‚  1  | Java     â”‚
â”‚  2  | æå››   â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚  designer      â”‚
                      â”‚  id | tool     â”‚
                      â”‚  2  | PS       â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ä¼˜ç‚¹ï¼šè§„èŒƒåŒ–  ç¼ºç‚¹ï¼šéœ€è¦å…³è”æŸ¥è¯¢

æ¯ç±»ä¸€è¡¨ï¼ˆTABLE_PER_CLASSï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  programmer        â”‚  â”‚  designer         â”‚
â”‚  id|name|language  â”‚  â”‚  id|name|tool     â”‚
â”‚  1 |å¼ ä¸‰|Java      â”‚  â”‚  2 |æå››|PS       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ä¼˜ç‚¹ï¼šç‹¬ç«‹æ€§å¼º  ç¼ºç‚¹ï¼šnameç­‰å­—æ®µé‡å¤å­˜å‚¨
```

---

## 2. ğŸ”§ æ ¸å¿ƒæ³¨è§£è¯¦è§£


### 2.1 @Inheritanceæ³¨è§£


**ğŸ“ åŸºæœ¬è¯­æ³•**
```java
@Inheritance(strategy = InheritanceType.JOINED)
```

**ğŸ¯ ä½œç”¨è¯´æ˜**
- æ ‡æ³¨åœ¨**çˆ¶ç±»**ä¸Š
- å‘Šè¯‰Hibernateï¼š"æˆ‘è¦ç”¨è”åˆå­ç±»ç­–ç•¥"
- `JOINED`çš„æ„æ€ï¼šå­ç±»è¡¨é€šè¿‡ä¸»é”®**JOINï¼ˆå…³è”ï¼‰**çˆ¶ç±»è¡¨

**ğŸ’¡ é€šä¿—ç†è§£**
```
@Inheritanceå°±åƒä¸€ä¸ª"ç­–ç•¥è¯´æ˜ä¹¦"
å‘Šè¯‰Hibernateï¼š
"å˜¿ï¼Œè¿™ä¸ªç»§æ‰¿ä½“ç³»è¦ç”¨ä»€ä¹ˆæ–¹å¼å­˜åˆ°æ•°æ®åº“ï¼Ÿ"
JOINEDçš„å›ç­”æ˜¯ï¼š"åˆ†å¼€å­˜ï¼Œä½†é€šè¿‡IDè¿èµ·æ¥"
```

### 2.2 @PrimaryKeyJoinColumnæ³¨è§£


**ğŸ“ åŸºæœ¬è¯­æ³•**
```java
@PrimaryKeyJoinColumn(name = "employee_id")
```

**ğŸ¯ å‚æ•°è¯´æ˜**

| å‚æ•° | å«ä¹‰ | ç¤ºä¾‹ | è¯´æ˜ |
|-----|------|------|------|
| `name` | `å­è¡¨å¤–é”®åˆ—å` | `"employee_id"` | `æŒ‡å®šå­è¡¨ä¸­å…³è”çˆ¶è¡¨çš„åˆ—å` |
| `referencedColumnName` | `çˆ¶è¡¨ä¸»é”®åˆ—å` | `"id"` | `é»˜è®¤æ˜¯çˆ¶è¡¨ä¸»é”®ï¼Œä¸€èˆ¬ä¸ç”¨å†™` |

**ğŸ’¡ é€šä¿—ç†è§£**
```
è¿™ä¸ªæ³¨è§£çš„ä½œç”¨ï¼š
å°±åƒç»™å­è¡¨é…ä¸€æŠŠ"é’¥åŒ™"ï¼Œè¿™æŠŠé’¥åŒ™èƒ½æ‰“å¼€çˆ¶è¡¨å¯¹åº”çš„æ•°æ®

å®é™…å«ä¹‰ï¼š
programmerè¡¨ä¸­çš„employee_id = employeeè¡¨ä¸­çš„id
è¿™æ ·å°±èƒ½æŠŠæ•°æ®"æ‹¼"åœ¨ä¸€èµ·äº†
```

**ğŸ” æœ‰æ— æ­¤æ³¨è§£çš„åŒºåˆ«**
```
ä¸å†™@PrimaryKeyJoinColumnï¼š
programmerè¡¨
â”œâ”€ idï¼ˆä¸»é”®ï¼Œä¹Ÿæ˜¯å¤–é”®ï¼Œé»˜è®¤åå­—ï¼‰
â””â”€ language

å†™äº†@PrimaryKeyJoinColumn(name = "employee_id")ï¼š
programmerè¡¨  
â”œâ”€ employee_idï¼ˆä¸»é”®ï¼Œä¹Ÿæ˜¯å¤–é”®ï¼Œè‡ªå®šä¹‰åå­—ï¼‰
â””â”€ language

åŒºåˆ«ï¼šå°±æ˜¯å¤–é”®åˆ—çš„åå­—ä¸åŒè€Œå·²
ä¸å†™çš„è¯é»˜è®¤å«idï¼Œå†™äº†å°±å«ä½ æŒ‡å®šçš„åå­—
```

---

## 3. ğŸ—„ï¸ è¡¨ç»“æ„è®¾è®¡


### 3.1 å®ä½“ç±»è®¾è®¡


**çˆ¶ç±»å®ä½“**
```java
@Entity
@Table(name = "employee")
@Inheritance(strategy = InheritanceType.JOINED)
public class Employee {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    private String name;           // å§“åï¼ˆæ‰€æœ‰å‘˜å·¥éƒ½æœ‰ï¼‰
    private LocalDate hireDate;    // å…¥èŒæ—¥æœŸï¼ˆæ‰€æœ‰å‘˜å·¥éƒ½æœ‰ï¼‰
    
    // getter/setterçœç•¥
}
```

**å­ç±»å®ä½“1ï¼šç¨‹åºå‘˜**
```java
@Entity
@Table(name = "programmer")
@PrimaryKeyJoinColumn(name = "employee_id")
public class Programmer extends Employee {
    private String programmingLanguage;  // ç¼–ç¨‹è¯­è¨€ï¼ˆç¨‹åºå‘˜ç‰¹æœ‰ï¼‰
    private Integer yearsOfExperience;   // å·¥ä½œå¹´é™ï¼ˆç¨‹åºå‘˜ç‰¹æœ‰ï¼‰
    
    // getter/setterçœç•¥
}
```

**å­ç±»å®ä½“2ï¼šè®¾è®¡å¸ˆ**
```java
@Entity
@Table(name = "designer")
@PrimaryKeyJoinColumn(name = "employee_id")
public class Designer extends Employee {
    private String designTool;     // è®¾è®¡å·¥å…·ï¼ˆè®¾è®¡å¸ˆç‰¹æœ‰ï¼‰
    private String portfolio;      // ä½œå“é›†é“¾æ¥ï¼ˆè®¾è®¡å¸ˆç‰¹æœ‰ï¼‰
    
    // getter/setterçœç•¥
}
```

### 3.2 ç”Ÿæˆçš„è¡¨ç»“æ„


**ğŸ“Š å®é™…æ•°æ®åº“è¡¨**
```sql
-- çˆ¶è¡¨ï¼šå­˜å‚¨å…¬å…±ä¿¡æ¯
CREATE TABLE employee (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100),
    hire_date DATE
);

-- å­è¡¨1ï¼šå­˜å‚¨ç¨‹åºå‘˜ç‰¹æœ‰ä¿¡æ¯
CREATE TABLE programmer (
    employee_id BIGINT PRIMARY KEY,           -- ä¸»é”®åŒæ—¶ä¹Ÿæ˜¯å¤–é”®
    programming_language VARCHAR(50),
    years_of_experience INT,
    FOREIGN KEY (employee_id) REFERENCES employee(id)
);

-- å­è¡¨2ï¼šå­˜å‚¨è®¾è®¡å¸ˆç‰¹æœ‰ä¿¡æ¯
CREATE TABLE designer (
    employee_id BIGINT PRIMARY KEY,           -- ä¸»é”®åŒæ—¶ä¹Ÿæ˜¯å¤–é”®
    design_tool VARCHAR(50),
    portfolio VARCHAR(255),
    FOREIGN KEY (employee_id) REFERENCES employee(id)
);
```

**ğŸ” è¡¨å…³ç³»å›¾è§£**
```
employeeï¼ˆçˆ¶è¡¨ï¼‰
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚  name   â”‚ hire_date  â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1  â”‚ å¼ ä¸‰    â”‚ 2023-01-01 â”‚ â†â”€â”
â”‚ 2  â”‚ æå››    â”‚ 2023-02-01 â”‚   â”‚
â”‚ 3  â”‚ ç‹äº”    â”‚ 2023-03-01 â”‚ â†â”€â”¼â”€â”
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
                                â”‚ â”‚
programmerï¼ˆå­è¡¨ï¼‰              â”‚ â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ employee_id â”‚ language â”‚        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚      1      â”‚   Java   â”‚        â”‚
â”‚      2      â”‚  Python  â”‚        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
                                  â”‚
designerï¼ˆå­è¡¨ï¼‰                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ employee_id â”‚   tool   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      3      â”‚    PS    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ID=1çš„æ•°æ®ï¼šåœ¨employeeå’Œprogrammeréƒ½æœ‰è®°å½•
ID=2çš„æ•°æ®ï¼šåœ¨employeeå’Œprogrammeréƒ½æœ‰è®°å½•  
ID=3çš„æ•°æ®ï¼šåœ¨employeeå’Œdesigneréƒ½æœ‰è®°å½•
```

### 3.3 æ•°æ®å­˜å‚¨æµç¨‹


**ğŸ’¾ ä¿å­˜ä¸€ä¸ªç¨‹åºå‘˜çš„è¿‡ç¨‹**
```java
// 1. åˆ›å»ºç¨‹åºå‘˜å¯¹è±¡
Programmer programmer = new Programmer();
programmer.setName("å¼ ä¸‰");              // çˆ¶ç±»å±æ€§
programmer.setHireDate(LocalDate.now()); // çˆ¶ç±»å±æ€§
programmer.setProgrammingLanguage("Java"); // å­ç±»å±æ€§
programmer.setYearsOfExperience(5);      // å­ç±»å±æ€§

// 2. Hibernateæ‰§è¡Œçš„SQLï¼ˆä¸¤æ¡INSERTï¼‰
em.persist(programmer);

// SQL1: å…ˆæ’å…¥çˆ¶è¡¨
INSERT INTO employee (name, hire_date) VALUES ('å¼ ä¸‰', '2023-01-01');
-- å‡è®¾ç”Ÿæˆçš„id=1

// SQL2: å†æ’å…¥å­è¡¨ï¼ˆç”¨åŒæ ·çš„idï¼‰
INSERT INTO programmer (employee_id, programming_language, years_of_experience) 
VALUES (1, 'Java', 5);
```

**ğŸ“– è¯»å–æµç¨‹**
```
æŸ¥è¯¢æ—¶Hibernateä¼šè‡ªåŠ¨JOINï¼š
SELECT e.id, e.name, e.hire_date, p.programming_language, p.years_of_experience
FROM employee e 
INNER JOIN programmer p ON e.id = p.employee_id
WHERE e.id = 1;

ä¸€æ¡SQLå°±èƒ½æ‹¿åˆ°å®Œæ•´æ•°æ®ï¼
```

---

## 4. ğŸ’» ä»£ç å®ç°è¯¦è§£


### 4.1 å®Œæ•´å®ä½“ç±»ç¤ºä¾‹


```java
// ==================== çˆ¶ç±» ====================
@Entity
@Table(name = "employee")
@Inheritance(strategy = InheritanceType.JOINED)
public class Employee {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @Column(nullable = false, length = 100)
    private String name;
    
    @Column(name = "hire_date")
    private LocalDate hireDate;
    
    // æ„é€ å™¨
    public Employee() {}
    
    public Employee(String name, LocalDate hireDate) {
        this.name = name;
        this.hireDate = hireDate;
    }
    
    // getter/setterçœç•¥...
}

// ==================== å­ç±»ï¼šç¨‹åºå‘˜ ====================
@Entity
@Table(name = "programmer")
@PrimaryKeyJoinColumn(name = "employee_id")  // è‡ªå®šä¹‰å¤–é”®å
public class Programmer extends Employee {
    
    @Column(name = "programming_language", length = 50)
    private String programmingLanguage;
    
    @Column(name = "years_of_experience")
    private Integer yearsOfExperience;
    
    // æ„é€ å™¨
    public Programmer() {}
    
    public Programmer(String name, LocalDate hireDate, 
                     String language, Integer experience) {
        super(name, hireDate);
        this.programmingLanguage = language;
        this.yearsOfExperience = experience;
    }
    
    // getter/setterçœç•¥...
}

// ==================== å­ç±»ï¼šè®¾è®¡å¸ˆ ====================
@Entity
@Table(name = "designer")
@PrimaryKeyJoinColumn(name = "employee_id")
public class Designer extends Employee {
    
    @Column(name = "design_tool", length = 50)
    private String designTool;
    
    @Column(length = 255)
    private String portfolio;
    
    // æ„é€ å™¨
    public Programmer() {}
    
    public Designer(String name, LocalDate hireDate, 
                   String tool, String portfolio) {
        super(name, hireDate);
        this.designTool = tool;
        this.portfolio = portfolio;
    }
    
    // getter/setterçœç•¥...
}
```

### 4.2 CRUDæ“ä½œç¤ºä¾‹


**ä¿å­˜æ“ä½œ**
```java
// ä¿å­˜ç¨‹åºå‘˜
Programmer programmer = new Programmer(
    "å¼ ä¸‰",
    LocalDate.of(2023, 1, 1),
    "Java",
    5
);
entityManager.persist(programmer);
// ç»“æœï¼šemployeeè¡¨å’Œprogrammerè¡¨å„æ’å…¥ä¸€æ¡è®°å½•

// ä¿å­˜è®¾è®¡å¸ˆ
Designer designer = new Designer(
    "æå››", 
    LocalDate.of(2023, 2, 1),
    "Photoshop",
    "http://portfolio.com/lisi"
);
entityManager.persist(designer);
// ç»“æœï¼šemployeeè¡¨å’Œdesignerè¡¨å„æ’å…¥ä¸€æ¡è®°å½•
```

**æŸ¥è¯¢æ“ä½œ**
```java
// 1. é€šè¿‡IDæŸ¥è¯¢å…·ä½“å­ç±»
Programmer p = entityManager.find(Programmer.class, 1L);
// SQL: SELECT ... FROM employee e INNER JOIN programmer p ON ...

// 2. æŸ¥è¯¢çˆ¶ç±»ï¼ˆä¼šæŸ¥å‡ºæ‰€æœ‰å­ç±»ï¼‰
List<Employee> allEmployees = entityManager
    .createQuery("SELECT e FROM Employee e", Employee.class)
    .getResultList();
// è¿™ä¸ªåˆ—è¡¨é‡Œæ—¢æœ‰Programmerå¯¹è±¡ï¼Œä¹Ÿæœ‰Designerå¯¹è±¡

// 3. åªæŸ¥è¯¢æŸç§å­ç±»
List<Programmer> programmers = entityManager
    .createQuery("SELECT p FROM Programmer p", Programmer.class)
    .getResultList();
// åªè¿”å›ç¨‹åºå‘˜
```

**æ›´æ–°æ“ä½œ**
```java
Programmer p = entityManager.find(Programmer.class, 1L);
p.setProgrammingLanguage("Python");  // ä¿®æ”¹å­ç±»å±æ€§
p.setName("å¼ ä¸‰ä¸°");                 // ä¿®æ”¹çˆ¶ç±»å±æ€§
// æäº¤æ—¶Hibernateä¼šæ›´æ–°ä¸¤å¼ è¡¨
```

---

## 5. âš¡ æŸ¥è¯¢ä¸æ€§èƒ½


### 5.1 æŸ¥è¯¢æœºåˆ¶åˆ†æ


**ğŸ” Hibernateç”Ÿæˆçš„SQL**

```java
// Javaä»£ç 
Programmer p = entityManager.find(Programmer.class, 1L);

// Hibernateç”Ÿæˆçš„SQL
SELECT 
    e.id,
    e.name,
    e.hire_date,
    p.programming_language,
    p.years_of_experience
FROM employee e
INNER JOIN programmer p ON e.id = p.employee_id
WHERE e.id = 1;
```

**ğŸ’¡ æŸ¥è¯¢ç‰¹ç‚¹**
```
âœ… ä¼˜ç‚¹ï¼š
â€¢ è‡ªåŠ¨JOINå…³è”ï¼Œä¸€æ¡SQLè·å–å®Œæ•´æ•°æ®
â€¢ ä¸ä¼šæœ‰NULLå€¼æµªè´¹ï¼ˆæ¯ä¸ªè¡¨åªå­˜æœ‰æ„ä¹‰çš„æ•°æ®ï¼‰
â€¢ æ•°æ®è§„èŒƒåŒ–ï¼Œç¬¦åˆæ•°æ®åº“è®¾è®¡åŸåˆ™

âš ï¸ ç¼ºç‚¹ï¼š
â€¢ éœ€è¦JOINæ“ä½œï¼Œæ¯”å•è¡¨æŸ¥è¯¢æ…¢
â€¢ æŸ¥è¯¢çˆ¶ç±»æ—¶ä¼šJOINæ‰€æœ‰å­ç±»è¡¨
â€¢ è¡¨è¶Šå¤šï¼ŒJOINè¶Šå¤æ‚
```

### 5.2 æ€§èƒ½å¯¹æ¯”


**ğŸ“Š æŸ¥è¯¢æ€§èƒ½å¯¹æ¯”**

| æ“ä½œç±»å‹ | å•è¡¨ç­–ç•¥ | è”åˆå­ç±» | æ¯ç±»ä¸€è¡¨ |
|---------|---------|---------|---------|
| `æŸ¥è¯¢å•ä¸ªå¯¹è±¡` | `â­â­â­â­â­ æœ€å¿«` | `â­â­â­â­ éœ€è¦JOIN` | `â­â­â­ å•è¡¨æŸ¥è¯¢` |
| `æŸ¥è¯¢æ‰€æœ‰å¯¹è±¡` | `â­â­â­â­â­ ä¸€æ¡SQL` | `â­â­â­ å¤šæ¬¡JOIN` | `â­â­ UNIONæŸ¥è¯¢` |
| `å¤šæ€æŸ¥è¯¢` | `â­â­â­â­â­ WHEREæ¡ä»¶` | `â­â­â­â­ JOINè¿‡æ»¤` | `â­â­ åˆ†åˆ«æŸ¥è¯¢` |

**ğŸ¯ æ€§èƒ½ä¼˜åŒ–å»ºè®®**

```java
// âœ… å¥½çš„åšæ³•ï¼šæ˜ç¡®æŸ¥è¯¢å­ç±»
List<Programmer> programmers = em
    .createQuery("SELECT p FROM Programmer p", Programmer.class)
    .getResultList();
// åªJOIN programmerè¡¨

// âŒ é¿å…ï¼šæŸ¥è¯¢çˆ¶ç±»å†åˆ¤æ–­ç±»å‹
List<Employee> all = em
    .createQuery("SELECT e FROM Employee e", Employee.class)
    .getResultList();
// ä¼šJOINæ‰€æœ‰å­ç±»è¡¨ï¼ˆprogrammerã€designerç­‰ï¼‰

for (Employee e : all) {
    if (e instanceof Programmer) {  // ä¸æ¨èè¿™æ ·è¿‡æ»¤
        // ...
    }
}
```

### 5.3 ç´¢å¼•ä¼˜åŒ–


**ğŸ“Œ ç´¢å¼•å»ºè®®**
```sql
-- çˆ¶è¡¨ä¸»é”®è‡ªåŠ¨æœ‰ç´¢å¼•
CREATE INDEX idx_employee_name ON employee(name);

-- å­è¡¨å¤–é”®è¦å»ºç´¢å¼•ï¼ˆåŠ é€ŸJOINï¼‰
CREATE INDEX idx_programmer_employee ON programmer(employee_id);
CREATE INDEX idx_designer_employee ON designer(employee_id);

-- å¸¸ç”¨æŸ¥è¯¢å­—æ®µå»ºç´¢å¼•
CREATE INDEX idx_programmer_language ON programmer(programming_language);
```

---

## 6. ğŸ¯ é€‚ç”¨åœºæ™¯åˆ†æ


### 6.1 é€‚åˆä½¿ç”¨çš„æƒ…å†µ


**âœ… æ¨èåœºæ™¯**
```
1ï¸âƒ£ å­ç±»ç‰¹æœ‰å±æ€§å¤š
   - ç¨‹åºå‘˜æœ‰å¾ˆå¤šä¸“å±å­—æ®µï¼ˆè¯­è¨€ã€æ¡†æ¶ã€è¯ä¹¦ç­‰ï¼‰
   - è®¾è®¡å¸ˆæœ‰å¾ˆå¤šä¸“å±å­—æ®µï¼ˆå·¥å…·ã€é£æ ¼ã€ä½œå“ç­‰ï¼‰
   
2ï¸âƒ£ æ•°æ®è§„èŒƒæ€§è¦æ±‚é«˜
   - é“¶è¡Œç³»ç»Ÿã€æ”¿åºœç³»ç»Ÿç­‰
   - ä¸å…è®¸æœ‰å¤§é‡NULLå€¼
   
3ï¸âƒ£ å­ç±»ç»å¸¸ç‹¬ç«‹æŸ¥è¯¢
   - ç»å¸¸åªæŸ¥ç¨‹åºå‘˜ï¼Œæˆ–åªæŸ¥è®¾è®¡å¸ˆ
   - å¾ˆå°‘éœ€è¦æ··åˆæŸ¥è¯¢
   
4ï¸âƒ£ æœªæ¥å¯èƒ½æ·»åŠ å­ç±»
   - ç³»ç»Ÿè®¾è®¡æ—¶å°±è€ƒè™‘æ‰©å±•æ€§
   - å¯èƒ½å¢åŠ ç»ç†ã€å®ä¹ ç”Ÿç­‰ç±»å‹
```

**ğŸ“‹ å®é™…æ¡ˆä¾‹**
```
æ¡ˆä¾‹1ï¼šå‘˜å·¥ç®¡ç†ç³»ç»Ÿ
Employeeï¼ˆå‘˜å·¥ï¼‰
â”œâ”€ FullTimeEmployeeï¼ˆå…¨èŒå‘˜å·¥ï¼‰- æœ‰ç¤¾ä¿ã€å…¬ç§¯é‡‘ç­‰å­—æ®µ
â”œâ”€ PartTimeEmployeeï¼ˆå…¼èŒå‘˜å·¥ï¼‰- æœ‰å°æ—¶å·¥èµ„ã€å·¥ä½œæ—¶æ®µç­‰å­—æ®µ
â””â”€ Internï¼ˆå®ä¹ ç”Ÿï¼‰- æœ‰å­¦æ ¡ã€å¯¼å¸ˆç­‰å­—æ®µ

æ¡ˆä¾‹2ï¼šè®¢å•ç³»ç»Ÿ  
Orderï¼ˆè®¢å•ï¼‰
â”œâ”€ OnlineOrderï¼ˆçº¿ä¸Šè®¢å•ï¼‰- æœ‰æ”¯ä»˜æ–¹å¼ã€ä¼˜æƒ åˆ¸ç­‰
â”œâ”€ OfflineOrderï¼ˆçº¿ä¸‹è®¢å•ï¼‰- æœ‰é—¨åº—ã€é”€å”®å‘˜ç­‰
â””â”€ WholesaleOrderï¼ˆæ‰¹å‘è®¢å•ï¼‰- æœ‰æŠ˜æ‰£ç‡ã€æˆä¿¡ç­‰
```

### 6.2 ä¸é€‚åˆä½¿ç”¨çš„æƒ…å†µ


**âŒ ä¸æ¨èåœºæ™¯**
```
1ï¸âƒ£ å­ç±»å±æ€§å¾ˆå°‘
   - å¦‚æœæ¯ä¸ªå­ç±»åªæœ‰1-2ä¸ªç‰¹æ®Šå­—æ®µ
   - ç”¨å•è¡¨ç­–ç•¥å°±å¤Ÿäº†ï¼Œä¸éœ€è¦æ‹†åˆ†
   
2ï¸âƒ£ ç»å¸¸éœ€è¦å¤šæ€æŸ¥è¯¢
   - æ€»æ˜¯è¦"æŸ¥å‡ºæ‰€æœ‰å‘˜å·¥"
   - JOINæˆæœ¬ä¼šå¾ˆé«˜
   
3ï¸âƒ£ æ€§èƒ½è¦æ±‚æé«˜
   - é«˜å¹¶å‘ç³»ç»Ÿ
   - æŸ¥è¯¢é€Ÿåº¦æ˜¯ç¬¬ä¸€è¦åŠ¡
   
4ï¸âƒ£ ç»§æ‰¿å±‚æ¬¡å¤ªæ·±
   - Employee â†’ Manager â†’ SeniorManager â†’ Director
   - ä¼šäº§ç”Ÿå¾ˆå¤šJOINï¼Œæ€§èƒ½å·®
```

### 6.3 ç­–ç•¥é€‰æ‹©å†³ç­–æ ‘


```
å¼€å§‹é€‰æ‹©ç»§æ‰¿ç­–ç•¥
    |
    â”œâ”€ å­ç±»å±æ€§å¤šå—ï¼Ÿ
    |   â”œâ”€ æ˜¯ â†’ è€ƒè™‘JOINEDæˆ–TABLE_PER_CLASS
    |   â””â”€ å¦ â†’ ç”¨SINGLE_TABLEï¼ˆå•è¡¨è¶³å¤Ÿï¼‰
    |
    â”œâ”€ æ•°æ®è§„èŒƒè¦æ±‚ä¸¥æ ¼å—ï¼Ÿ
    |   â”œâ”€ æ˜¯ â†’ é€‰JOINEDï¼ˆä¸å…è®¸NULLï¼‰
    |   â””â”€ å¦ â†’ å¯ä»¥ç”¨SINGLE_TABLE
    |
    â”œâ”€ æ€§èƒ½è¦æ±‚é«˜å—ï¼Ÿ
    |   â”œâ”€ æ˜¯ â†’ ç”¨SINGLE_TABLEï¼ˆæœ€å¿«ï¼‰
    |   â””â”€ å¦ â†’ JOINEDæˆ–TABLE_PER_CLASSéƒ½å¯ä»¥
    |
    â””â”€ ç»å¸¸å¤šæ€æŸ¥è¯¢å—ï¼Ÿ
        â”œâ”€ æ˜¯ â†’ é¿å…TABLE_PER_CLASS
        â””â”€ å¦ â†’ ä¸‰ç§ç­–ç•¥éƒ½å¯è€ƒè™‘
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ¦‚å¿µ


```
ğŸ”¸ è”åˆå­ç±»ç­–ç•¥æœ¬è´¨ï¼š
   ä¸€ä¸ªç»§æ‰¿ä½“ç³» â†’ å¤šä¸ªè¡¨ï¼Œé€šè¿‡ä¸»é”®å…³è”
   çˆ¶ç±»è¡¨å­˜å…¬å…±å±æ€§ï¼Œå­ç±»è¡¨å­˜ç‰¹æœ‰å±æ€§

ğŸ”¸ æ ¸å¿ƒæ³¨è§£ï¼š
   @Inheritance(strategy = InheritanceType.JOINED)  â†’ çˆ¶ç±»ä¸Š
   @PrimaryKeyJoinColumn(name = "xxx_id")          â†’ å­ç±»ä¸Š

ğŸ”¸ è¡¨å…³ç³»ï¼š
   å­è¡¨çš„ä¸»é”® = çˆ¶è¡¨çš„å¤–é”®ï¼ˆä¸€ä¸ªå­—æ®µä¸¤ä¸ªä½œç”¨ï¼‰
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸å•è¡¨ç­–ç•¥çš„åŒºåˆ«**
```
å•è¡¨ç­–ç•¥ï¼š
æ‰€æœ‰æ•°æ®æŒ¤åœ¨ä¸€å¼ è¡¨ â†’ ç®€å•ä½†æœ‰NULLæµªè´¹

è”åˆå­ç±»ç­–ç•¥ï¼š
æ•°æ®åˆ†å¼€å­˜ â†’ è§„èŒƒä½†éœ€è¦JOIN
```

**ğŸ”¹ @PrimaryKeyJoinColumnçš„ä½œç”¨**
```
ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†æ¨èå†™ï¼š
â€¢ ä¸å†™ï¼šå¤–é”®åˆ—é»˜è®¤å«idï¼ˆå®¹æ˜“æ··æ·†ï¼‰
â€¢ å†™äº†ï¼šå¤–é”®åˆ—å«employee_idï¼ˆè¯­ä¹‰æ¸…æ™°ï¼‰
```

**ğŸ”¹ æŸ¥è¯¢æ€§èƒ½è€ƒè™‘**
```
æ˜ç¡®æŸ¥è¯¢å­ç±» â†’ æ€§èƒ½å¥½ï¼ˆåªJOINéœ€è¦çš„è¡¨ï¼‰
æŸ¥è¯¢çˆ¶ç±» â†’ æ€§èƒ½å·®ï¼ˆJOINæ‰€æœ‰å­ç±»è¡¨ï¼‰

å»ºè®®ï¼šå°½é‡å†™å…·ä½“çš„æŸ¥è¯¢ï¼Œé¿å…å¤šæ€æŸ¥è¯¢
```

### 7.3 å®æˆ˜æ³¨æ„äº‹é¡¹


**âš ï¸ å¸¸è§é—®é¢˜**
```
é—®é¢˜1ï¼šä¸ºä»€ä¹ˆä¿å­˜ä¸€ä¸ªå¯¹è±¡è¦æ‰§è¡Œä¸¤æ¡INSERTï¼Ÿ
ç­”ï¼šå› ä¸ºæ•°æ®åˆ†ä¸¤å¼ è¡¨å­˜ï¼Œå¿…é¡»å„æ’ä¸€æ¡

é—®é¢˜2ï¼šå¦‚ä½•çŸ¥é“ä¸€æ¡employeeè®°å½•å¯¹åº”å“ªä¸ªå­ç±»ï¼Ÿ
ç­”ï¼šHibernateä¼šè‡ªåŠ¨å¤„ç†ï¼ŒæŸ¥è¯¢æ—¶ä¼šJOINæ­£ç¡®çš„è¡¨

é—®é¢˜3ï¼šå¯ä»¥ä¸ç”¨@PrimaryKeyJoinColumnå—ï¼Ÿ
ç­”ï¼šå¯ä»¥ï¼Œä½†æ¨èç”¨ï¼Œè®©å¤–é”®åˆ—åæ›´æ¸…æ™°
```

**ğŸ’¡ æœ€ä½³å®è·µ**
```
âœ… DOï¼ˆæ¨èåšæ³•ï¼‰ï¼š
â€¢ å­ç±»å±æ€§å¤šæ—¶é€‰ç”¨æ­¤ç­–ç•¥
â€¢ ç»™å¤–é”®åˆ—èµ·æœ‰æ„ä¹‰çš„åå­—
â€¢ åœ¨å¤–é”®åˆ—ä¸Šå»ºç´¢å¼•
â€¢ æ˜ç¡®æŸ¥è¯¢å…·ä½“å­ç±»

âŒ DON'Tï¼ˆé¿å…åšæ³•ï¼‰ï¼š
â€¢ ç»§æ‰¿å±‚æ¬¡ä¸è¦å¤ªæ·±ï¼ˆæœ€å¤š2-3å±‚ï¼‰
â€¢ ä¸è¦é¢‘ç¹å¤šæ€æŸ¥è¯¢çˆ¶ç±»
â€¢ å­ç±»å±æ€§å°‘æ—¶ä¸è¦ç”¨è¿™ä¸ªç­–ç•¥
```

### 7.4 ä¸€å¥è¯æ€»ç»“


**æ ¸å¿ƒè®°å¿†**ï¼š
> è”åˆå­ç±»ç­–ç•¥ = çˆ¶ç±»ä¸€å¼ è¡¨ + æ¯ä¸ªå­ç±»ä¸€å¼ è¡¨ï¼Œé€šè¿‡ä¸»é”®ä¸²èµ·æ¥ã€‚é€‚åˆå­ç±»å±æ€§å¤šã€æ•°æ®è¦è§„èŒƒçš„åœºæ™¯ï¼Œä½†æŸ¥è¯¢æ—¶è¦JOINï¼Œæ€§èƒ½æ¯”å•è¡¨ç­–ç•¥å·®ä¸€äº›ã€‚

**å®ç”¨å£è¯€**ï¼š
```
å…¬å…±å±æ€§çˆ¶è¡¨å­˜ï¼Œ
ç‰¹æœ‰å±æ€§å­è¡¨åˆ†ï¼Œ
ä¸»é”®å¤–é”®æ˜¯ä¸€ä½“ï¼Œ
JOINå…³è”å–å®Œæ•´ã€‚
```