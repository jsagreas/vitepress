---
title: 2ã€Hibernateå…¨è‡ªåŠ¨ORM
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯Hibernateï¼Ÿ](#1-ä»€ä¹ˆæ˜¯Hibernate)
2. [JPAè§„èŒƒä¸Hibernateå…³ç³»](#2-JPAè§„èŒƒä¸Hibernateå…³ç³»)
3. [å®ä½“æ˜ å°„æ ¸å¿ƒæ¦‚å¿µ](#3-å®ä½“æ˜ å°„æ ¸å¿ƒæ¦‚å¿µ)
4. [æ³¨è§£é…ç½®è¯¦è§£](#4-æ³¨è§£é…ç½®è¯¦è§£)
5. [HQLæŸ¥è¯¢è¯­è¨€](#5-HQLæŸ¥è¯¢è¯­è¨€)
6. [CriteriaæŸ¥è¯¢](#6-CriteriaæŸ¥è¯¢)
7. [åŠ è½½ç­–ç•¥ï¼šå»¶è¿Ÿä¸æ€¥åˆ‡](#7-åŠ è½½ç­–ç•¥å»¶è¿Ÿä¸æ€¥åˆ‡)
8. [çº§è”æ“ä½œç®¡ç†](#8-çº§è”æ“ä½œç®¡ç†)
9. [ç¼“å­˜æœºåˆ¶è¯¦è§£](#9-ç¼“å­˜æœºåˆ¶è¯¦è§£)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ä»€ä¹ˆæ˜¯Hibernateï¼Ÿ


### 1.1 ä»é—®é¢˜è¯´èµ·

æƒ³è±¡ä¸€ä¸‹ï¼Œä½ åœ¨å†™Javaç¨‹åºæ—¶éœ€è¦ä¿å­˜ç”¨æˆ·ä¿¡æ¯åˆ°æ•°æ®åº“ï¼š

```
ä¼ ç»ŸJDBCæ–¹å¼çš„ç—›è‹¦ï¼š
1. æ‰‹å†™SQLè¯­å¥ï¼šINSERT INTO user (name, age) VALUES (?, ?)
2. è®¾ç½®å‚æ•°ï¼špstmt.setString(1, "å¼ ä¸‰"); pstmt.setInt(2, 25);
3. å¤„ç†ç»“æœé›†ï¼šwhile(rs.next()) { user.setName(rs.getString("name")); }
4. ç®¡ç†è¿æ¥ï¼šæ‰“å¼€ã€å…³é—­ã€å¼‚å¸¸å¤„ç†...

æ¯ä¸ªè¡¨éƒ½è¦é‡å¤è¿™äº›å·¥ä½œï¼
```

**Hibernateçš„è§£å†³æ–¹æ¡ˆ**ï¼š
> Hibernateå°±åƒä¸€ä¸ª**æ™ºèƒ½ç¿»è¯‘å®˜**ï¼Œå®ƒèƒ½è‡ªåŠ¨æŠŠJavaå¯¹è±¡è½¬æ¢æˆæ•°æ®åº“è®°å½•ï¼ŒæŠŠæ•°æ®åº“è®°å½•è½¬æ¢æˆJavaå¯¹è±¡ï¼Œè®©ä½ ä¸“æ³¨ä¸šåŠ¡é€»è¾‘è€Œä¸ç”¨å†™å¤æ‚çš„SQLã€‚

### 1.2 ORMæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ

**ORM = Object-Relational Mappingï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰**

```
ç®€å•ç†è§£ï¼š
Javaå¯¹è±¡ â†â†’ æ•°æ®åº“è¡¨
 å±æ€§    â†â†’   å­—æ®µ
 å¯¹è±¡    â†â†’   è®°å½•

æ¯”å¦‚ï¼š
Userå¯¹è±¡{name="å¼ ä¸‰", age=25} â†â†’ userè¡¨ä¸­çš„ä¸€è¡Œè®°å½•
```

**ä¸ºä»€ä¹ˆå«"å…¨è‡ªåŠ¨"ï¼Ÿ**
- **è‡ªåŠ¨å»ºè¡¨**ï¼šæ ¹æ®Javaç±»è‡ªåŠ¨åˆ›å»ºæ•°æ®åº“è¡¨
- **è‡ªåŠ¨æ˜ å°„**ï¼šå¯¹è±¡å±æ€§è‡ªåŠ¨å¯¹åº”è¡¨å­—æ®µ  
- **è‡ªåŠ¨SQL**ï¼šå¢åˆ æ”¹æŸ¥çš„SQLè¯­å¥è‡ªåŠ¨ç”Ÿæˆ
- **è‡ªåŠ¨ç±»å‹è½¬æ¢**ï¼šJavaç±»å‹å’Œæ•°æ®åº“ç±»å‹è‡ªåŠ¨è½¬æ¢

---

## 2. ğŸ“‹ JPAè§„èŒƒä¸Hibernateå…³ç³»


### 2.1 ä»€ä¹ˆæ˜¯JPAè§„èŒƒï¼Ÿ

**JPA = Java Persistence APIï¼ˆJavaæŒä¹…åŒ–æ¥å£ï¼‰**

```
é€šä¿—ç†è§£ï¼š
JPAå°±æ˜¯Sunå…¬å¸åˆ¶å®šçš„"æ¸¸æˆè§„åˆ™"
- å®šä¹‰äº†ORMæ¡†æ¶åº”è¯¥æ€ä¹ˆåš
- å°±åƒæ±½è½¦çš„å›½é™…æ ‡å‡†ï¼Œè§„å®šäº†æ–¹å‘ç›˜ã€åˆ¹è½¦çš„ä½ç½®
- ä½†JPAåªæ˜¯è§„èŒƒï¼Œä¸æ˜¯å…·ä½“å®ç°

å…³ç³»å›¾ç¤ºï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   JPAè§„èŒƒ        â”‚ â† åˆ¶å®šæ ‡å‡†å’Œæ¥å£
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Hibernate     â”‚ â† å…·ä½“å®ç°ï¼ˆæœ€æµè¡Œï¼‰
â”‚   EclipseLink   â”‚ â† å…¶ä»–å®ç°
â”‚   OpenJPA       â”‚ â† å…¶ä»–å®ç°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ä¸ºä»€ä¹ˆå­¦Hibernateå°±ç­‰äºå­¦JPAï¼Ÿ

**é‡è¦æ¦‚å¿µ**ï¼šHibernateæ—¢æ˜¯JPAçš„å®ç°ï¼Œä¹Ÿæ˜¯JPAè§„èŒƒçš„ä¸»è¦æ¨åŠ¨è€…

```
å¥½å¤„ï¼š
âœ… å­¦ä¼šHibernate = æŒæ¡JPAæ ‡å‡†
âœ… ä»£ç ç¬¦åˆæ ‡å‡†ï¼Œæ›´å®¹æ˜“ç»´æŠ¤
âœ… å¯ä»¥æ— ç—›åˆ‡æ¢åˆ°å…¶ä»–JPAå®ç°
âœ… æ‰¾å·¥ä½œæ—¶JPAç»éªŒæ›´å—æ¬¢è¿

å®é™…å¼€å‘ä¸­ï¼š
- ç”¨JPAæ³¨è§£å†™ä»£ç 
- ç”¨Hibernateåšåº•å±‚å®ç°
- æ—¢æ ‡å‡†åˆå¼ºå¤§
```

### 2.3 ç‰ˆæœ¬å…³ç³»è¯´æ˜

| JPAç‰ˆæœ¬ | Hibernateç‰ˆæœ¬ | **ä¸»è¦ç‰¹æ€§** |
|---------|---------------|-------------|
| **JPA 1.0** | `Hibernate 3.2+` | `åŸºç¡€ORMåŠŸèƒ½` |
| **JPA 2.0** | `Hibernate 3.5+` | `CriteriaæŸ¥è¯¢ï¼ŒäºŒçº§ç¼“å­˜` |
| **JPA 2.1** | `Hibernate 4.3+` | `å­˜å‚¨è¿‡ç¨‹ï¼Œæ‰¹é‡æ“ä½œ` |
| **JPA 2.2** | `Hibernate 5.3+` | `æµå¼æŸ¥è¯¢ï¼ŒCDIé›†æˆ` |
| **JPA 3.0** | `Hibernate 6.0+` | `æ”¯æŒJava 11+ï¼Œæ–°ç‰¹æ€§` |

---

## 3. ğŸ—ï¸ å®ä½“æ˜ å°„æ ¸å¿ƒæ¦‚å¿µ


### 3.1 ä»€ä¹ˆæ˜¯å®ä½“æ˜ å°„ï¼Ÿ

**å®ä½“ï¼ˆEntityï¼‰**ï¼šå°±æ˜¯å¯¹åº”æ•°æ®åº“è¡¨çš„Javaç±»

```
æ•°æ®åº“è¡¨ userï¼š            Javaå®ä½“ç±» Userï¼š
+----+--------+-----+      public class User {
| id | name   | age |          private Long id;
+----+--------+-----+          private String name;
| 1  | å¼ ä¸‰   | 25  |          private Integer age;
| 2  | æå››   | 30  |      }
+----+--------+-----+
```

**æ˜ å°„è§„åˆ™**ï¼š
- **ç±»å** â†’ **è¡¨å**ï¼šUserç±» â†’ userè¡¨
- **å±æ€§** â†’ **å­—æ®µ**ï¼šnameå±æ€§ â†’ nameå­—æ®µ  
- **å¯¹è±¡** â†’ **è®°å½•**ï¼šUserå¯¹è±¡ â†’ è¡¨ä¸­ä¸€è¡Œ

### 3.2 åŸºæœ¬å®ä½“ç±»ç¤ºä¾‹

```java
// æœ€ç®€å•çš„å®ä½“ç±»
@Entity                    // å‘Šè¯‰Hibernateè¿™æ˜¯ä¸ªå®ä½“ç±»
@Table(name = "tb_user")   // æŒ‡å®šå¯¹åº”çš„è¡¨åï¼ˆå¯é€‰ï¼‰
public class User {
    
    @Id                    // ä¸»é”®å­—æ®µ
    @GeneratedValue(strategy = GenerationType.IDENTITY) // è‡ªå¢ä¸»é”®
    private Long id;
    
    @Column(name = "user_name")  // æŒ‡å®šå­—æ®µåï¼ˆå¯é€‰ï¼‰
    private String name;
    
    private Integer age;   // ä¸åŠ æ³¨è§£ï¼Œé»˜è®¤æ˜ å°„åŒåå­—æ®µ
    
    // å¿…é¡»æœ‰æ— å‚æ„é€ æ–¹æ³•
    public User() {}
    
    // getterå’Œsetteræ–¹æ³•...
}
```

### 3.3 æ˜ å°„è§„åˆ™è¯¦è§£

```
é»˜è®¤æ˜ å°„ç­–ç•¥ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Javaå‘½å       â”‚   æ•°æ®åº“å‘½å      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   User           â”‚   user           â”‚
â”‚   UserProfile    â”‚   user_profile   â”‚
â”‚   userName       â”‚   user_name      â”‚
â”‚   createTime     â”‚   create_time    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é©¼å³°å‘½åè‡ªåŠ¨è½¬æ¢ä¸ºä¸‹åˆ’çº¿å‘½åï¼
```

**å¸¸ç”¨å­—æ®µç±»å‹æ˜ å°„**ï¼š
| **Javaç±»å‹** | **æ•°æ®åº“ç±»å‹** | **è¯´æ˜** |
|-------------|---------------|---------|
| `String` | `VARCHAR` | å­—ç¬¦ä¸² |
| `Integer/int` | `INT` | æ•´æ•° |
| `Long/long` | `BIGINT` | é•¿æ•´æ•° |
| `Double/double` | `DOUBLE` | æµ®ç‚¹æ•° |
| `Boolean/boolean` | `TINYINT/BIT` | å¸ƒå°”å€¼ |
| `Date` | `DATETIME` | æ—¥æœŸæ—¶é—´ |
| `LocalDateTime` | `DATETIME` | æ–°æ—¥æœŸAPI |

---

## 4. ğŸ“ æ³¨è§£é…ç½®è¯¦è§£


### 4.1 æ ¸å¿ƒæ³¨è§£è¯´æ˜


**@Entity** - å®ä½“ç±»æ ‡è®°
```java
@Entity
public class User {
    // è¿™ä¸ªæ³¨è§£å‘Šè¯‰Hibernateï¼šè¿™ä¸ªç±»å¯¹åº”æ•°æ®åº“ä¸­çš„ä¸€å¼ è¡¨
}
```

**@Table** - è¡¨ä¿¡æ¯é…ç½®
```java
@Entity
@Table(name = "tb_user",           // è¡¨å
       schema = "test_db",         // æ•°æ®åº“schema
       indexes = {@Index(name = "idx_name", columnList = "name")}) // ç´¢å¼•
public class User {
    // å¯ä»¥æŒ‡å®šè¡¨çš„è¯¦ç»†ä¿¡æ¯
}
```

### 4.2 ä¸»é”®ç›¸å…³æ³¨è§£


**@Id** - ä¸»é”®æ ‡è¯†
```java
@Id
private Long id;  // æ¯ä¸ªå®ä½“å¿…é¡»æœ‰ä¸»é”®
```

**@GeneratedValue** - ä¸»é”®ç”Ÿæˆç­–ç•¥
```java
// è‡ªå¢ä¸»é”®ï¼ˆæ¨èï¼‰
@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
private Long id;

// UUIDä¸»é”®
@Id
@GeneratedValue(strategy = GenerationType.AUTO)
private String id;

// åºåˆ—ä¸»é”®ï¼ˆOracleç­‰ï¼‰
@Id
@GeneratedValue(strategy = GenerationType.SEQUENCE, 
                generator = "user_seq")
private Long id;
```

### 4.3 å­—æ®µæ˜ å°„æ³¨è§£


**@Column** - å­—æ®µè¯¦ç»†é…ç½®
```java
@Column(name = "user_name",        // æ•°æ®åº“å­—æ®µå
        length = 50,               // å­—æ®µé•¿åº¦
        nullable = false,          // ä¸èƒ½ä¸ºç©º
        unique = true)             // å”¯ä¸€çº¦æŸ
private String name;

// å¤§æ–‡æœ¬å­—æ®µ
@Column(columnDefinition = "TEXT")
private String description;
```

### 4.4 ç‰¹æ®Šå­—æ®µæ³¨è§£


**@Temporal** - æ—¥æœŸå­—æ®µé…ç½®
```java
// åªä¿å­˜æ—¥æœŸéƒ¨åˆ†
@Temporal(TemporalType.DATE)
private Date birthDate;

// åªä¿å­˜æ—¶é—´éƒ¨åˆ†  
@Temporal(TemporalType.TIME)
private Date loginTime;

// ä¿å­˜æ—¥æœŸå’Œæ—¶é—´
@Temporal(TemporalType.TIMESTAMP)
private Date createTime;
```

**@Transient** - å¿½ç•¥å­—æ®µ
```java
@Transient
private String password;  // è¿™ä¸ªå­—æ®µä¸ä¼šä¿å­˜åˆ°æ•°æ®åº“
```

**@Enumerated** - æšä¸¾ç±»å‹
```java
public enum Gender {
    MALE, FEMALE
}

// ä¿å­˜æšä¸¾çš„åç§°ï¼ˆæ¨èï¼‰
@Enumerated(EnumType.STRING)
private Gender gender;

// ä¿å­˜æšä¸¾çš„åºå·
@Enumerated(EnumType.ORDINAL)  
private Gender gender;
```

---

## 5. ğŸ” HQLæŸ¥è¯¢è¯­è¨€


### 5.1 ä»€ä¹ˆæ˜¯HQLï¼Ÿ

**HQL = Hibernate Query Languageï¼ˆHibernateæŸ¥è¯¢è¯­è¨€ï¼‰**

```
HQLçš„ç‰¹ç‚¹ï¼š
âœ… é¢å‘å¯¹è±¡ï¼šæŸ¥è¯¢çš„æ˜¯Javaå¯¹è±¡ï¼Œä¸æ˜¯æ•°æ®åº“è¡¨
âœ… è‡ªåŠ¨ç¿»è¯‘ï¼šHQLä¼šè‡ªåŠ¨ç¿»è¯‘æˆå¯¹åº”æ•°æ®åº“çš„SQL
âœ… ç±»å‹å®‰å…¨ï¼šç¼–è¯‘æ—¶å°±èƒ½å‘ç°é”™è¯¯
âœ… æ˜“äºç»´æŠ¤ï¼šä¿®æ”¹å®ä½“ç±»ï¼ŒHQLè‡ªåŠ¨é€‚é…

SQL vs HQLå¯¹æ¯”ï¼š
SQLï¼š  SELECT * FROM tb_user WHERE age > 18
HQLï¼š  FROM User WHERE age > 18
```

### 5.2 åŸºæœ¬æŸ¥è¯¢è¯­æ³•


**ç®€å•æŸ¥è¯¢**
```java
// æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·
String hql = "FROM User";
Query<User> query = session.createQuery(hql, User.class);
List<User> users = query.list();

// æ¡ä»¶æŸ¥è¯¢
String hql = "FROM User WHERE age > :age";
Query<User> query = session.createQuery(hql, User.class);
query.setParameter("age", 18);
List<User> users = query.list();

// æŸ¥è¯¢ç‰¹å®šå­—æ®µ
String hql = "SELECT u.name, u.age FROM User u";
List<Object[]> results = session.createQuery(hql).list();
```

### 5.3 å¸¸ç”¨HQLè¯­å¥


**WHEREæ¡ä»¶æŸ¥è¯¢**
```java
// ç­‰å€¼æŸ¥è¯¢
"FROM User WHERE name = 'å¼ ä¸‰'"

// æ¨¡ç³ŠæŸ¥è¯¢
"FROM User WHERE name LIKE '%å¼ %'"

// èŒƒå›´æŸ¥è¯¢
"FROM User WHERE age BETWEEN 18 AND 65"

// ç©ºå€¼æŸ¥è¯¢
"FROM User WHERE email IS NOT NULL"

// é›†åˆæŸ¥è¯¢
"FROM User WHERE age IN (18, 25, 30)"
```

**æ’åºå’Œåˆ†é¡µ**
```java
// æ’åº
"FROM User ORDER BY age DESC, name ASC"

// åˆ†é¡µï¼ˆéœ€è¦ç»“åˆQueryå¯¹è±¡ï¼‰
String hql = "FROM User ORDER BY id";
Query<User> query = session.createQuery(hql, User.class);
query.setFirstResult(0);    // èµ·å§‹ä½ç½®
query.setMaxResults(10);    // æ¯é¡µæ•°é‡
List<User> users = query.list();
```

### 5.4 èšåˆå‡½æ•°æŸ¥è¯¢

```java
// ç»Ÿè®¡è®°å½•æ•°
"SELECT COUNT(*) FROM User"

// æ±‚å’Œã€å¹³å‡å€¼ã€æœ€å¤§æœ€å°å€¼
"SELECT SUM(age), AVG(age), MAX(age), MIN(age) FROM User"

// åˆ†ç»„æŸ¥è¯¢
"SELECT u.department, COUNT(*) FROM User u GROUP BY u.department"

// åˆ†ç»„è¿‡æ»¤
"SELECT u.department, COUNT(*) FROM User u GROUP BY u.department HAVING COUNT(*) > 5"
```

---

## 6. ğŸ“Š CriteriaæŸ¥è¯¢


### 6.1 ä»€ä¹ˆæ˜¯CriteriaæŸ¥è¯¢ï¼Ÿ

**CriteriaæŸ¥è¯¢**ï¼šä¸€ç§å®Œå…¨é¢å‘å¯¹è±¡çš„æŸ¥è¯¢æ–¹å¼ï¼Œç”¨Javaä»£ç æ„å»ºæŸ¥è¯¢æ¡ä»¶

```
HQL vs Criteriaå¯¹æ¯”ï¼š

HQLæ–¹å¼ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼š
"FROM User WHERE age > 18 AND name LIKE '%å¼ %'"
- å®¹æ˜“å†™é”™ï¼Œç¼–è¯‘æ—¶å‘ç°ä¸äº†é—®é¢˜
- åŠ¨æ€æ¡ä»¶æ‹¼æ¥æ¯”è¾ƒéº»çƒ¦

Criteriaæ–¹å¼ï¼ˆå¯¹è±¡ï¼‰ï¼š
CriteriaBuilder cb = session.getCriteriaBuilder();
CriteriaQuery<User> cq = cb.createQuery(User.class);
Root<User> root = cq.from(User.class);
cq.where(
    cb.and(
        cb.gt(root.get("age"), 18),
        cb.like(root.get("name"), "%å¼ %")
    )
);
- ç±»å‹å®‰å…¨ï¼Œç¼–è¯‘æ—¶æ£€æŸ¥
- åŠ¨æ€æ¡ä»¶å¾ˆå®¹æ˜“å¤„ç†
```

### 6.2 åŸºæœ¬CriteriaæŸ¥è¯¢

```java
// è·å–CriteriaBuilder
CriteriaBuilder cb = session.getCriteriaBuilder();

// åˆ›å»ºæŸ¥è¯¢å¯¹è±¡
CriteriaQuery<User> cq = cb.createQuery(User.class);

// æŒ‡å®šæŸ¥è¯¢çš„æ ¹å®ä½“
Root<User> root = cq.from(User.class);

// æ·»åŠ æŸ¥è¯¢æ¡ä»¶
cq.where(cb.equal(root.get("name"), "å¼ ä¸‰"));

// æ‰§è¡ŒæŸ¥è¯¢
Query<User> query = session.createQuery(cq);
List<User> users = query.getResultList();
```

### 6.3 å¸¸ç”¨æ¡ä»¶æ„å»º

```java
CriteriaBuilder cb = session.getCriteriaBuilder();
CriteriaQuery<User> cq = cb.createQuery(User.class);
Root<User> root = cq.from(User.class);

// ç­‰å€¼æ¡ä»¶
Predicate p1 = cb.equal(root.get("name"), "å¼ ä¸‰");

// å¤§å°æ¯”è¾ƒ
Predicate p2 = cb.gt(root.get("age"), 18);          // age > 18
Predicate p3 = cb.lt(root.get("age"), 65);          // age < 65
Predicate p4 = cb.between(root.get("age"), 18, 65); // age BETWEEN 18 AND 65

// æ¨¡ç³ŠæŸ¥è¯¢
Predicate p5 = cb.like(root.get("name"), "%å¼ %");

// ç©ºå€¼åˆ¤æ–­
Predicate p6 = cb.isNotNull(root.get("email"));

// é›†åˆæ¡ä»¶
Predicate p7 = root.get("age").in(18, 25, 30);

// ç»„åˆæ¡ä»¶
cq.where(cb.and(p1, p2));  // ANDæ¡ä»¶
cq.where(cb.or(p1, p2));   // ORæ¡ä»¶
```

### 6.4 åŠ¨æ€æŸ¥è¯¢ç¤ºä¾‹

```java
public List<User> findUsers(String name, Integer minAge, Integer maxAge) {
    CriteriaBuilder cb = session.getCriteriaBuilder();
    CriteriaQuery<User> cq = cb.createQuery(User.class);
    Root<User> root = cq.from(User.class);
    
    List<Predicate> predicates = new ArrayList<>();
    
    // åŠ¨æ€æ·»åŠ æ¡ä»¶
    if (name != null && !name.isEmpty()) {
        predicates.add(cb.like(root.get("name"), "%" + name + "%"));
    }
    
    if (minAge != null) {
        predicates.add(cb.ge(root.get("age"), minAge));
    }
    
    if (maxAge != null) {
        predicates.add(cb.le(root.get("age"), maxAge));
    }
    
    // ç»„åˆæ‰€æœ‰æ¡ä»¶
    if (!predicates.isEmpty()) {
        cq.where(predicates.toArray(new Predicate[0]));
    }
    
    return session.createQuery(cq).getResultList();
}
```

---

## 7. âš¡ åŠ è½½ç­–ç•¥ï¼šå»¶è¿Ÿä¸æ€¥åˆ‡


### 7.1 ä»€ä¹ˆæ˜¯åŠ è½½ç­–ç•¥ï¼Ÿ

æƒ³è±¡ä½ è¦æŸ¥çœ‹ä¸€ä¸ªç”¨æˆ·çš„ä¿¡æ¯ï¼Œè¿™ä¸ªç”¨æˆ·å±äºæŸä¸ªéƒ¨é—¨ï¼š

```
ç”¨æˆ·è¡¨ Userï¼š                éƒ¨é—¨è¡¨ Departmentï¼š
+----+--------+-------------+    +----+-----------+
| id | name   | dept_id     |    | id | name      |
+----+--------+-------------+    +----+-----------+
| 1  | å¼ ä¸‰   | 101         |    | 101| ç ”å‘éƒ¨    |
+----+--------+-------------+    +----+-----------+

é—®é¢˜ï¼šæŸ¥è¯¢ç”¨æˆ·æ—¶ï¼Œæ˜¯å¦éœ€è¦ç«‹å³æŸ¥è¯¢éƒ¨é—¨ä¿¡æ¯ï¼Ÿ
```

**ä¸¤ç§åŠ è½½ç­–ç•¥**ï¼š
- **æ€¥åˆ‡åŠ è½½ï¼ˆEAGERï¼‰**ï¼šç«‹å³æŸ¥è¯¢å…³è”æ•°æ®
- **å»¶è¿ŸåŠ è½½ï¼ˆLAZYï¼‰**ï¼šéœ€è¦æ—¶æ‰æŸ¥è¯¢å…³è”æ•°æ®

### 7.2 å»¶è¿ŸåŠ è½½è¯¦è§£


**ä»€ä¹ˆæ˜¯å»¶è¿ŸåŠ è½½ï¼Ÿ**
> å»¶è¿ŸåŠ è½½å°±åƒ"æŒ‰éœ€å–è´§"ï¼Œåªæœ‰çœŸæ­£ä½¿ç”¨å…³è”å¯¹è±¡æ—¶ï¼Œæ‰å»æ•°æ®åº“æŸ¥è¯¢

```java
@Entity
public class User {
    @Id
    private Long id;
    private String name;
    
    // å»¶è¿ŸåŠ è½½éƒ¨é—¨ä¿¡æ¯
    @ManyToOne(fetch = FetchType.LAZY)
    private Department department;
}

// ä½¿ç”¨ç¤ºä¾‹
User user = session.get(User.class, 1L);
System.out.println(user.getName());        // åªæŸ¥è¯¢ç”¨æˆ·è¡¨ï¼Œä¸æŸ¥éƒ¨é—¨

System.out.println(user.getDepartment().getName()); // è¿™æ—¶æ‰æŸ¥è¯¢éƒ¨é—¨è¡¨
```

**å»¶è¿ŸåŠ è½½çš„SQLæ‰§è¡Œ**ï¼š
```sql
-- ç¬¬ä¸€æ­¥ï¼šåªæŸ¥ç”¨æˆ·
SELECT id, name, dept_id FROM user WHERE id = 1;

-- ç¬¬äºŒæ­¥ï¼šä½¿ç”¨éƒ¨é—¨ä¿¡æ¯æ—¶æ‰æ‰§è¡Œ
SELECT id, name FROM department WHERE id = 101;
```

### 7.3 æ€¥åˆ‡åŠ è½½è¯¦è§£


**ä»€ä¹ˆæ˜¯æ€¥åˆ‡åŠ è½½ï¼Ÿ**
> æ€¥åˆ‡åŠ è½½å°±åƒ"ä¸€æ¬¡æ€§æ‰“åŒ…"ï¼ŒæŸ¥è¯¢ä¸»å¯¹è±¡æ—¶ç«‹å³æŸ¥è¯¢æ‰€æœ‰å…³è”å¯¹è±¡

```java
@Entity
public class User {
    @Id
    private Long id;
    private String name;
    
    // æ€¥åˆ‡åŠ è½½éƒ¨é—¨ä¿¡æ¯
    @ManyToOne(fetch = FetchType.EAGER)
    private Department department;
}

// ä½¿ç”¨ç¤ºä¾‹
User user = session.get(User.class, 1L);  // ç«‹å³æŸ¥è¯¢ç”¨æˆ·å’Œéƒ¨é—¨
System.out.println(user.getName());       // éƒ¨é—¨ä¿¡æ¯å·²ç»åœ¨å†…å­˜ä¸­äº†
```

**æ€¥åˆ‡åŠ è½½çš„SQLæ‰§è¡Œ**ï¼š
```sql
-- ä¸€æ¬¡æ€§æŸ¥è¯¢ï¼ˆä½¿ç”¨JOINï¼‰
SELECT u.id, u.name, u.dept_id, d.id, d.name 
FROM user u 
LEFT JOIN department d ON u.dept_id = d.id 
WHERE u.id = 1;
```

### 7.4 å¦‚ä½•é€‰æ‹©åŠ è½½ç­–ç•¥ï¼Ÿ


```
é€‰æ‹©æŒ‡å—ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ä½¿ç”¨åœºæ™¯       â”‚   æ¨èç­–ç•¥       â”‚   åŸå›           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç»å¸¸ä¸€èµ·ä½¿ç”¨     â”‚   EAGER         â”‚ å‡å°‘SQLæ¬¡æ•°     â”‚
â”‚ å¾ˆå°‘ä½¿ç”¨å…³è”æ•°æ® â”‚   LAZY          â”‚ èŠ‚çœå†…å­˜å’Œæ€§èƒ½  â”‚
â”‚ æ‰¹é‡æŸ¥è¯¢åœºæ™¯     â”‚   LAZY + æ‰‹åŠ¨   â”‚ é¿å…N+1é—®é¢˜     â”‚
â”‚ åˆ—è¡¨å±•ç¤º         â”‚   LAZY          â”‚ ä¸éœ€è¦è¯¦ç»†ä¿¡æ¯  â”‚
â”‚ è¯¦æƒ…é¡µé¢         â”‚   EAGER         â”‚ éœ€è¦å®Œæ•´ä¿¡æ¯    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**âš ï¸ N+1é—®é¢˜è­¦å‘Š**ï¼š
```java
// å±é™©çš„ä»£ç ï¼
List<User> users = session.createQuery("FROM User", User.class).list();
for (User user : users) {
    System.out.println(user.getDepartment().getName()); // æ¯ä¸ªç”¨æˆ·éƒ½æŸ¥ä¸€æ¬¡éƒ¨é—¨ï¼
}

// è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨JOIN FETCH
List<User> users = session.createQuery(
    "FROM User u JOIN FETCH u.department", User.class
).list();
```

---

## 8. ğŸ”— çº§è”æ“ä½œç®¡ç†


### 8.1 ä»€ä¹ˆæ˜¯çº§è”æ“ä½œï¼Ÿ

**çº§è”æ“ä½œ**ï¼šå½“å¯¹ä¸»å¯¹è±¡è¿›è¡Œæ“ä½œæ—¶ï¼Œè‡ªåŠ¨å¯¹å…³è”å¯¹è±¡æ‰§è¡Œç›¸åº”æ“ä½œ

```
ç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼š
åˆ é™¤ä¸€ä¸ªéƒ¨é—¨æ—¶ï¼Œæ˜¯å¦è¦åˆ é™¤éƒ¨é—¨ä¸‹çš„æ‰€æœ‰å‘˜å·¥ï¼Ÿ
ä¿å­˜ä¸€ä¸ªè®¢å•æ—¶ï¼Œæ˜¯å¦è¦è‡ªåŠ¨ä¿å­˜è®¢å•ä¸­çš„å•†å“æ˜ç»†ï¼Ÿ

è¿™å°±æ˜¯çº§è”æ“ä½œè¦è§£å†³çš„é—®é¢˜ï¼
```

### 8.2 çº§è”ç±»å‹è¯¦è§£


**CascadeType.PERSIST** - çº§è”ä¿å­˜
```java
@Entity
public class Department {
    @OneToMany(cascade = CascadeType.PERSIST)
    private List<User> users;
}

// ä¿å­˜éƒ¨é—¨æ—¶ï¼Œè‡ªåŠ¨ä¿å­˜æ‰€æœ‰ç”¨æˆ·
Department dept = new Department("ç ”å‘éƒ¨");
dept.addUser(new User("å¼ ä¸‰"));
dept.addUser(new User("æå››"));

session.save(dept);  // è‡ªåŠ¨ä¿å­˜éƒ¨é—¨å’Œ2ä¸ªç”¨æˆ·
```

**CascadeType.REMOVE** - çº§è”åˆ é™¤
```java
@Entity  
public class User {
    @OneToMany(cascade = CascadeType.REMOVE)
    private List<Order> orders;
}

// åˆ é™¤ç”¨æˆ·æ—¶ï¼Œè‡ªåŠ¨åˆ é™¤ç”¨æˆ·çš„æ‰€æœ‰è®¢å•
User user = session.get(User.class, 1L);
session.delete(user);  // ç”¨æˆ·å’Œå…¶æ‰€æœ‰è®¢å•éƒ½è¢«åˆ é™¤
```

### 8.3 çº§è”ç±»å‹å¯¹ç…§è¡¨


| **çº§è”ç±»å‹** | **æ“ä½œ** | **è¯´æ˜** | **ä½¿ç”¨åœºæ™¯** |
|-------------|----------|----------|-------------|
| `PERSIST` | ä¿å­˜ | ä¿å­˜ä¸»å¯¹è±¡æ—¶ä¿å­˜å…³è”å¯¹è±¡ | è®¢å•-è®¢å•æ˜ç»† |
| `REMOVE` | åˆ é™¤ | åˆ é™¤ä¸»å¯¹è±¡æ—¶åˆ é™¤å…³è”å¯¹è±¡ | ç”¨æˆ·-ç”¨æˆ·èµ„æ–™ |
| `MERGE` | åˆå¹¶ | åˆå¹¶ä¸»å¯¹è±¡æ—¶åˆå¹¶å…³è”å¯¹è±¡ | æ•°æ®æ›´æ–° |
| `REFRESH` | åˆ·æ–° | åˆ·æ–°ä¸»å¯¹è±¡æ—¶åˆ·æ–°å…³è”å¯¹è±¡ | æ•°æ®åŒæ­¥ |
| `DETACH` | åˆ†ç¦» | åˆ†ç¦»ä¸»å¯¹è±¡æ—¶åˆ†ç¦»å…³è”å¯¹è±¡ | ç¼“å­˜ç®¡ç† |
| `ALL` | å…¨éƒ¨ | åŒ…å«ä»¥ä¸Šæ‰€æœ‰æ“ä½œ | å¼ºå…³è”å…³ç³» |

### 8.4 çº§è”æ“ä½œæœ€ä½³å®è·µ


**çˆ¶å­å…³ç³»**ï¼ˆä¸€å¯¹å¤šï¼‰
```java
@Entity
public class Blog {
    @OneToMany(cascade = CascadeType.ALL, 
               mappedBy = "blog",
               orphanRemoval = true)  // å­¤å„¿åˆ é™¤
    private List<Comment> comments;
    
    // ä¾¿äºç®¡ç†çš„æ–¹æ³•
    public void addComment(Comment comment) {
        comments.add(comment);
        comment.setBlog(this);
    }
}

@Entity  
public class Comment {
    @ManyToOne
    private Blog blog;
}
```

**âš ï¸ çº§è”æ“ä½œæ³¨æ„äº‹é¡¹**ï¼š
```
å®‰å…¨æé†’ï¼š
âŒ ä¸è¦åœ¨å¤šå¯¹å¤šå…³ç³»ä¸­ä½¿ç”¨REMOVEçº§è”
âŒ è°¨æ…ä½¿ç”¨ALLçº§è”ï¼Œå¯èƒ½å¯¼è‡´æ„å¤–åˆ é™¤
âœ… ä¼˜å…ˆä½¿ç”¨å…·ä½“çš„çº§è”ç±»å‹
âœ… æµ‹è¯•çº§è”æ“ä½œçš„å®é™…æ•ˆæœ
âœ… è€ƒè™‘æ•°æ®åº“å¤–é”®çº¦æŸ
```

---

## 9. ğŸ’¾ ç¼“å­˜æœºåˆ¶è¯¦è§£


### 9.1 ä¸ºä»€ä¹ˆéœ€è¦ç¼“å­˜ï¼Ÿ

```
æ²¡æœ‰ç¼“å­˜çš„é—®é¢˜ï¼š
1. æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ â†’ è®¿é—®æ•°æ®åº“
2. å†æ¬¡æŸ¥è¯¢åŒä¸€ç”¨æˆ· â†’ åˆè®¿é—®æ•°æ®åº“
3. é‡å¤æŸ¥è¯¢ â†’ æ•°æ®åº“å‹åŠ›å¤§ï¼Œå“åº”æ…¢

æœ‰äº†ç¼“å­˜ï¼š
1. ç¬¬ä¸€æ¬¡æŸ¥è¯¢ â†’ è®¿é—®æ•°æ®åº“ â†’ å­˜å…¥ç¼“å­˜
2. å†æ¬¡æŸ¥è¯¢ â†’ ç›´æ¥ä»ç¼“å­˜è·å– â†’ ç§’è¿”å›
3. å¤§å¹…æå‡æ€§èƒ½ï¼
```

### 9.2 ä¸€çº§ç¼“å­˜ï¼ˆSessionç¼“å­˜ï¼‰


**ä»€ä¹ˆæ˜¯ä¸€çº§ç¼“å­˜ï¼Ÿ**
> ä¸€çº§ç¼“å­˜æ˜¯Sessionçº§åˆ«çš„ç¼“å­˜ï¼ŒåŒä¸€ä¸ªSessionä¸­çš„ç›¸åŒæŸ¥è¯¢ä¼šå¤ç”¨ç»“æœ

```java
Session session = sessionFactory.openSession();

// ç¬¬ä¸€æ¬¡æŸ¥è¯¢ï¼Œè®¿é—®æ•°æ®åº“
User user1 = session.get(User.class, 1L);

// ç¬¬äºŒæ¬¡æŸ¥è¯¢ï¼Œä»ç¼“å­˜è·å–ï¼Œä¸è®¿é—®æ•°æ®åº“
User user2 = session.get(User.class, 1L);

System.out.println(user1 == user2);  // trueï¼Œæ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼

session.close();  // Sessionå…³é—­ï¼Œä¸€çº§ç¼“å­˜æ¸…ç©º
```

**ä¸€çº§ç¼“å­˜çš„ç‰¹ç‚¹**ï¼š
```
âœ… è‡ªåŠ¨å¯ç”¨ï¼Œæ— éœ€é…ç½®
âœ… Sessionçº§åˆ«ï¼Œçº¿ç¨‹å®‰å…¨
âœ… é¿å…é‡å¤æŸ¥è¯¢
âŒ ç”Ÿå‘½å‘¨æœŸçŸ­ï¼ˆSessionç»“æŸå³å¤±æ•ˆï¼‰
âŒ æ— æ³•è·¨Sessionå…±äº«
```

### 9.3 äºŒçº§ç¼“å­˜ï¼ˆSessionFactoryç¼“å­˜ï¼‰


**ä»€ä¹ˆæ˜¯äºŒçº§ç¼“å­˜ï¼Ÿ**
> äºŒçº§ç¼“å­˜æ˜¯åº”ç”¨çº§åˆ«çš„ç¼“å­˜ï¼Œå¯ä»¥è·¨Sessionå…±äº«æ•°æ®

```
ç¼“å­˜å±‚çº§ç»“æ„ï¼š
åº”ç”¨ç¨‹åº
    â†“
Sessionï¼ˆä¸€çº§ç¼“å­˜ï¼‰
    â†“
SessionFactoryï¼ˆäºŒçº§ç¼“å­˜ï¼‰  â† å¯é…ç½®ï¼Œè·¨Sessionå…±äº«
    â†“
æ•°æ®åº“
```

**äºŒçº§ç¼“å­˜é…ç½®**ï¼š
```java
// 1. åœ¨hibernate.cfg.xmlä¸­å¯ç”¨
<property name="hibernate.cache.use_second_level_cache">true</property>
<property name="hibernate.cache.region.factory_class">
    org.hibernate.cache.ehcache.EhCacheRegionFactory
</property>

// 2. åœ¨å®ä½“ç±»ä¸Šæ·»åŠ æ³¨è§£
@Entity
@Cache(usage = CacheConcurrencyStrategy.READ_WRITE)
public class User {
    // ...
}

// 3. ä½¿ç”¨ç¼“å­˜
Session session1 = sessionFactory.openSession();
User user1 = session1.get(User.class, 1L);  // æŸ¥æ•°æ®åº“ï¼Œå­˜å…¥äºŒçº§ç¼“å­˜
session1.close();

Session session2 = sessionFactory.openSession();
User user2 = session2.get(User.class, 1L);  // ä»äºŒçº§ç¼“å­˜è·å–ï¼
```

### 9.4 æŸ¥è¯¢ç¼“å­˜


**ä»€ä¹ˆæ˜¯æŸ¥è¯¢ç¼“å­˜ï¼Ÿ**
> æŸ¥è¯¢ç¼“å­˜å¯ä»¥ç¼“å­˜HQL/CriteriaæŸ¥è¯¢çš„ç»“æœåˆ—è¡¨

```java
// å¯ç”¨æŸ¥è¯¢ç¼“å­˜
<property name="hibernate.cache.use_query_cache">true</property>

// ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜
Query<User> query = session.createQuery("FROM User WHERE age > 18", User.class);
query.setCacheable(true);           // å¯ç”¨æŸ¥è¯¢ç¼“å­˜
query.setCacheRegion("userCache");  // æŒ‡å®šç¼“å­˜åŒºåŸŸï¼ˆå¯é€‰ï¼‰
List<User> users = query.list();

// ç›¸åŒæŸ¥è¯¢ä¼šä»ç¼“å­˜è·å–
Query<User> query2 = session.createQuery("FROM User WHERE age > 18", User.class);
query2.setCacheable(true);
List<User> users2 = query2.list();  // ä»æŸ¥è¯¢ç¼“å­˜è·å–
```

### 9.5 ç¼“å­˜ç­–ç•¥å¯¹æ¯”


| **ç¼“å­˜ç±»å‹** | **ä½œç”¨èŒƒå›´** | **ç”Ÿå‘½å‘¨æœŸ** | **é€‚ç”¨åœºæ™¯** |
|-------------|-------------|-------------|-------------|
| **ä¸€çº§ç¼“å­˜** | `Sessionçº§åˆ«` | `Sessionå­˜åœ¨æœŸé—´` | `åŒSessionå†…é‡å¤æŸ¥è¯¢` |
| **äºŒçº§ç¼“å­˜** | `SessionFactoryçº§åˆ«` | `åº”ç”¨è¿è¡ŒæœŸé—´` | `è·¨Sessionçš„çƒ­ç‚¹æ•°æ®` |
| **æŸ¥è¯¢ç¼“å­˜** | `SessionFactoryçº§åˆ«` | `åº”ç”¨è¿è¡ŒæœŸé—´` | `é‡å¤çš„å¤æ‚æŸ¥è¯¢` |

**ç¼“å­˜ä½¿ç”¨å»ºè®®**ï¼š
```
æ¨èä½¿ç”¨ï¼š
âœ… è¯»å¤šå†™å°‘çš„æ•°æ®ï¼ˆå¦‚é…ç½®ä¿¡æ¯ã€å­—å…¸æ•°æ®ï¼‰
âœ… ç›¸å¯¹ç¨³å®šçš„æ•°æ®ï¼ˆå¦‚ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ï¼‰
âœ… æŸ¥è¯¢é¢‘ç¹çš„æ•°æ®

è°¨æ…ä½¿ç”¨ï¼š
âš ï¸ ç»å¸¸å˜åŒ–çš„æ•°æ®
âš ï¸ å¤§æ•°æ®é‡çš„æŸ¥è¯¢ç»“æœ
âš ï¸ åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„æ•°æ®ä¸€è‡´æ€§è¦æ±‚
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ¯ Hibernateæœ¬è´¨ï¼šJavaå¯¹è±¡ä¸æ•°æ®åº“è¡¨ä¹‹é—´çš„æ™ºèƒ½ç¿»è¯‘å®˜
ğŸ¯ JPAè§„èŒƒï¼šæ ‡å‡†åŒ–çš„ORMæ¥å£ï¼ŒHibernateæ˜¯æœ€æµè¡Œçš„å®ç°
ğŸ¯ å®ä½“æ˜ å°„ï¼š@Entity + @Id æ˜¯æœ€åŸºæœ¬çš„æ˜ å°„ç»„åˆ
ğŸ¯ æ³¨è§£é…ç½®ï¼šå£°æ˜å¼é…ç½®ï¼Œç®€å•ç›´è§‚
ğŸ¯ HQLæŸ¥è¯¢ï¼šé¢å‘å¯¹è±¡çš„æŸ¥è¯¢è¯­è¨€ï¼Œè‡ªåŠ¨ç¿»è¯‘æˆSQL
ğŸ¯ CriteriaæŸ¥è¯¢ï¼šç±»å‹å®‰å…¨çš„åŠ¨æ€æŸ¥è¯¢æ„å»ºæ–¹å¼
ğŸ¯ åŠ è½½ç­–ç•¥ï¼šLAZYå»¶è¿ŸåŠ è½½ vs EAGERæ€¥åˆ‡åŠ è½½
ğŸ¯ çº§è”æ“ä½œï¼šä¸»å¯¹è±¡æ“ä½œæ—¶è‡ªåŠ¨æ“ä½œå…³è”å¯¹è±¡
ğŸ¯ ç¼“å­˜æœºåˆ¶ï¼šä¸€çº§ç¼“å­˜è‡ªåŠ¨å¼€å¯ï¼ŒäºŒçº§ç¼“å­˜éœ€è¦é…ç½®
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ORMçš„æ ¸å¿ƒä»·å€¼**
```
è§£å†³é—®é¢˜ï¼š
- æ¶ˆé™¤é‡å¤çš„JDBCä»£ç 
- å¯¹è±¡å’Œå…³ç³»æ•°æ®çš„é˜»æŠ—å¤±é…
- å¤æ‚SQLçš„ç»´æŠ¤é—®é¢˜

å¸¦æ¥æ”¶ç›Šï¼š
- æé«˜å¼€å‘æ•ˆç‡
- é™ä½ç»´æŠ¤æˆæœ¬  
- æ›´å¥½çš„é¢å‘å¯¹è±¡ç¼–ç¨‹
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–å…³é”®ç‚¹**
```
æŸ¥è¯¢ä¼˜åŒ–ï¼š
- åˆç†ä½¿ç”¨å»¶è¿ŸåŠ è½½é¿å…N+1é—®é¢˜
- ä½¿ç”¨JOIN FETCHè§£å†³å…³è”æŸ¥è¯¢
- CriteriaæŸ¥è¯¢æ„å»ºå¤æ‚åŠ¨æ€æ¡ä»¶

ç¼“å­˜ä¼˜åŒ–ï¼š
- ä¸€çº§ç¼“å­˜è‡ªåŠ¨ä¼˜åŒ–Sessionå†…æŸ¥è¯¢
- äºŒçº§ç¼“å­˜ä¼˜åŒ–è·¨Sessionçš„çƒ­ç‚¹æ•°æ®
- æŸ¥è¯¢ç¼“å­˜ä¼˜åŒ–é‡å¤çš„å¤æ‚æŸ¥è¯¢
```

**ğŸ”¹ æœ€ä½³å®è·µè¦ç‚¹**
```
å®ä½“è®¾è®¡ï¼š
- åˆç†è®¾è®¡å®ä½“å…³ç³»
- è°¨æ…ä½¿ç”¨çº§è”æ“ä½œ
- é€‰æ‹©åˆé€‚çš„åŠ è½½ç­–ç•¥

æŸ¥è¯¢ç¼–å†™ï¼š
- ä¼˜å…ˆä½¿ç”¨HQLï¼Œå¤æ‚åŠ¨æ€æŸ¥è¯¢ç”¨Criteria
- æ³¨æ„SQLæ‰§è¡Œæ¬¡æ•°å’Œæ€§èƒ½
- åˆç†ä½¿ç”¨ç¼“å­˜æœºåˆ¶
```

### 10.3 å­¦ä¹ è·¯å¾„å»ºè®®


**ğŸš€ æ–°æ‰‹å­¦ä¹ é¡ºåº**ï¼š
1. **åŸºç¡€æ¦‚å¿µ** â†’ ç†è§£ORMå’ŒHibernateçš„ä½œç”¨
2. **å®ä½“æ˜ å°„** â†’ æŒæ¡@Entityã€@Idç­‰åŸºç¡€æ³¨è§£  
3. **åŸºæœ¬æ“ä½œ** â†’ å¢åˆ æ”¹æŸ¥çš„åŸºæœ¬ç”¨æ³•
4. **HQLæŸ¥è¯¢** â†’ é¢å‘å¯¹è±¡çš„æŸ¥è¯¢è¯­è¨€
5. **å…³è”å…³ç³»** â†’ ä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹å¤š
6. **é«˜çº§ç‰¹æ€§** â†’ ç¼“å­˜ã€çº§è”ã€åŠ è½½ç­–ç•¥

**ğŸ’¡ å®è·µå»ºè®®**ï¼š
- ä»ç®€å•çš„å•è¡¨æ“ä½œå¼€å§‹
- é€æ­¥å¢åŠ å…³è”å…³ç³»çš„å¤æ‚åº¦
- å…³æ³¨SQLæ‰§è¡Œæƒ…å†µå’Œæ€§èƒ½è¡¨ç°
- ç»“åˆSpringæ¡†æ¶è¿›è¡Œå®é™…é¡¹ç›®å¼€å‘

**æ ¸å¿ƒè®°å¿†**ï¼š
- Hibernateè®©Javaå¯¹è±¡å’Œæ•°æ®åº“è¡¨è‡ªåŠ¨äº’è½¬
- æ³¨è§£é…ç½®ç®€å•ç›´è§‚ï¼ŒHQLæŸ¥è¯¢é¢å‘å¯¹è±¡
- ç¼“å­˜æå‡æ€§èƒ½ï¼ŒåŠ è½½ç­–ç•¥æ§åˆ¶å…³è”æŸ¥è¯¢
- çº§è”æ“ä½œè¦è°¨æ…ï¼Œé¿å…æ„å¤–çš„æ•°æ®æ“ä½œ