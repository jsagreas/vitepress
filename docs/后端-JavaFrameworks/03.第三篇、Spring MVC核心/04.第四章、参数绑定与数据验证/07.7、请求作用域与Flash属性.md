---
title: 7ã€è¯·æ±‚ä½œç”¨åŸŸä¸Flashå±æ€§
---
## ğŸ“š ç›®å½•

1. [ä½œç”¨åŸŸæ¦‚å¿µåŸºç¡€](#1-ä½œç”¨åŸŸæ¦‚å¿µåŸºç¡€)
2. [è¯·æ±‚ä½œç”¨åŸŸè¯¦è§£](#2-è¯·æ±‚ä½œç”¨åŸŸè¯¦è§£)
3. [Flashå±æ€§æœºåˆ¶](#3-Flashå±æ€§æœºåˆ¶)
4. [RedirectAttributesè¯¦è§£](#4-RedirectAttributesè¯¦è§£)
5. [é‡å®šå‘æ•°æ®ä¼ é€’](#5-é‡å®šå‘æ•°æ®ä¼ é€’)
6. [ä½œç”¨åŸŸç”Ÿå‘½å‘¨æœŸ](#6-ä½œç”¨åŸŸç”Ÿå‘½å‘¨æœŸ)
7. [å®æˆ˜åº”ç”¨åœºæ™¯](#7-å®æˆ˜åº”ç”¨åœºæ™¯)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ä½œç”¨åŸŸæ¦‚å¿µåŸºç¡€


### 1.1 ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸ


**é€šä¿—ç†è§£**ï¼šä½œç”¨åŸŸå°±åƒæ˜¯æ•°æ®çš„"ç”Ÿå­˜ç©ºé—´"å’Œ"æœ‰æ•ˆæœŸ"

```
ç°å®ç±»æ¯”ï¼š
å¿«é€’åŒ…è£¹ â†’ æ•°æ®
åŒ…è£¹å­˜æ”¾ä½ç½® â†’ ä½œç”¨åŸŸ
åŒ…è£¹ä¿å­˜æ—¶é—´ â†’ ç”Ÿå‘½å‘¨æœŸ

ğŸ”¸ æ”¾åœ¨é—¨å£ï¼ˆRequestä½œç”¨åŸŸï¼‰â†’ åªåœ¨è¿™æ¬¡é€è´§æœ‰æ•ˆï¼Œæ‹¿èµ°å°±æ²¡äº†
ğŸ”¸ æ”¾åœ¨å®¶é‡Œï¼ˆSessionä½œç”¨åŸŸï¼‰â†’ ä½ åœ¨å®¶æœŸé—´ä¸€ç›´æœ‰æ•ˆ
ğŸ”¸ æ”¾åœ¨ä»“åº“ï¼ˆApplicationä½œç”¨åŸŸï¼‰â†’ æ‰€æœ‰äººéƒ½èƒ½è®¿é—®ï¼Œé•¿æœŸæœ‰æ•ˆ
```

### 1.2 Webåº”ç”¨ä¸­çš„ä¸‰å¤§ä½œç”¨åŸŸ


**æ ¸å¿ƒä½œç”¨åŸŸå¯¹æ¯”**

| ä½œç”¨åŸŸç±»å‹ | **ç”Ÿå‘½å‘¨æœŸ** | **ä½œç”¨èŒƒå›´** | **å…¸å‹ç”¨é€”** |
|---------|------------|------------|------------|
| ğŸ”µ **Request** | `ä¸€æ¬¡è¯·æ±‚æœŸé—´` | `å½“å‰è¯·æ±‚` | `è¯·æ±‚å‚æ•°ã€ä¸´æ—¶æ•°æ®` |
| ğŸŸ¢ **Session** | `ç”¨æˆ·ä¼šè¯æœŸé—´` | `å•ä¸ªç”¨æˆ·` | `ç”¨æˆ·ç™»å½•ä¿¡æ¯ã€è´­ç‰©è½¦` |
| ğŸŸ  **Application** | `åº”ç”¨å¯åŠ¨åˆ°å…³é—­` | `æ‰€æœ‰ç”¨æˆ·` | `å…¨å±€é…ç½®ã€è®¡æ•°å™¨` |

### 1.3 ä½œç”¨åŸŸçš„ç”Ÿå‘½å‘¨æœŸå›¾ç¤º


```
ç”¨æˆ·è®¿é—®æµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         åº”ç”¨å¯åŠ¨ï¼ˆApplicationå¼€å§‹ï¼‰       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚    ç”¨æˆ·ç™»å½•ï¼ˆSessionå¼€å§‹ï¼‰          â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  å‘èµ·è¯·æ±‚ï¼ˆRequestå¼€å§‹ï¼‰     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â†’ å¤„ç†è¯·æ±‚                  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â†’ è¿”å›å“åº”ï¼ˆRequestç»“æŸï¼‰   â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  å†æ¬¡è¯·æ±‚ï¼ˆæ–°Requestï¼‰       â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚    ç”¨æˆ·é€€å‡ºï¼ˆSessionç»“æŸï¼‰         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         åº”ç”¨å…³é—­ï¼ˆApplicationç»“æŸï¼‰      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”¸ å…³é”®ç†è§£**
- Requestæœ€çŸ­å‘½ - ä¸€æ¬¡è¯·æ±‚å°±é”€æ¯
- Sessionä¸­ç­‰å‘½ - ç”¨æˆ·åœ¨çº¿æœŸé—´æœ‰æ•ˆ
- Applicationæœ€é•¿å‘½ - åº”ç”¨è¿è¡ŒæœŸé—´ä¸€ç›´å­˜åœ¨

---

## 2. ğŸ“‹ è¯·æ±‚ä½œç”¨åŸŸè¯¦è§£


### 2.1 Requestä½œç”¨åŸŸçš„æœ¬è´¨


**ä»€ä¹ˆæ˜¯Requestä½œç”¨åŸŸ**
> Requestä½œç”¨åŸŸå°±æ˜¯è¿™æ¬¡HTTPè¯·æ±‚çš„"ä¸´æ—¶è®°äº‹æœ¬"ï¼Œè¯·æ±‚å¤„ç†å®Œå°±æ’•æ‰äº†

**ç”Ÿå‘½å‘¨æœŸç‰¹ç‚¹**
```
è¯·æ±‚å¼€å§‹ â†’ åˆ›å»ºRequestå¯¹è±¡ â†’ å­˜å‚¨æ•°æ® â†’ å“åº”è¿”å› â†’ é”€æ¯æ•°æ®

æ—¶é—´è·¨åº¦ï¼šé€šå¸¸åªæœ‰å‡ æ¯«ç§’åˆ°å‡ ç§’
```

### 2.2 @RequestScopeæ³¨è§£


**åŸºæœ¬ä½¿ç”¨æ–¹å¼**

```java
@Controller
@RequestMapping("/user")
public class UserController {
    
    // æ–¹å¼1ï¼šåœ¨æ–¹æ³•å‚æ•°ä¸­ç›´æ¥ä½¿ç”¨
    @GetMapping("/info")
    public String getUserInfo(Model model) {
        // Modelæœ¬èº«å°±æ˜¯Requestä½œç”¨åŸŸ
        model.addAttribute("username", "å¼ ä¸‰");
        model.addAttribute("age", 25);
        return "user-info";  // è½¬å‘åˆ°é¡µé¢ï¼Œæ•°æ®ä¾ç„¶å­˜åœ¨
    }
    
    // æ–¹å¼2ï¼šä½¿ç”¨@RequestScopeæ ‡è®°Bean
    @Bean
    @RequestScope
    public UserData requestUserData() {
        return new UserData();
        // è¿™ä¸ªBeanåœ¨æ¯æ¬¡è¯·æ±‚æ—¶åˆ›å»ºï¼Œè¯·æ±‚ç»“æŸæ—¶é”€æ¯
    }
}
```

**ğŸ”¸ é‡ç‚¹ç†è§£**
- `Model`ã€`ModelMap`ã€`ModelAndView` éƒ½æ˜¯æ“ä½œRequestä½œç”¨åŸŸ
- æ•°æ®åªåœ¨**è½¬å‘ï¼ˆforwardï¼‰**æ—¶æœ‰æ•ˆ
- **é‡å®šå‘ï¼ˆredirectï¼‰**ä¼šä¸¢å¤±æ•°æ®

### 2.3 Requestä½œç”¨åŸŸçš„æ•°æ®ä¼ é€’


**è½¬å‘ vs é‡å®šå‘çš„åŒºåˆ«**

| å¯¹æ¯”é¡¹ | **è½¬å‘(Forward)** | **é‡å®šå‘(Redirect)** |
|-------|------------------|---------------------|
| ğŸ“ URLå˜åŒ– | `ä¸å˜` | `ä¼šå˜` |
| ğŸ”¢ è¯·æ±‚æ¬¡æ•° | `1æ¬¡` | `2æ¬¡` |
| ğŸ’¾ Requestæ•°æ® | `ä¿ç•™` | `ä¸¢å¤±` |
| ğŸ¯ ä½¿ç”¨åœºæ™¯ | `å†…éƒ¨è·³è½¬` | `å¤–éƒ¨è·³è½¬ã€é˜²æ­¢é‡å¤æäº¤` |

**å›¾ç¤ºè¯´æ˜**

```
è½¬å‘æµç¨‹ï¼ˆæ•°æ®ä¿ç•™ï¼‰ï¼š
å®¢æˆ·ç«¯                    æœåŠ¡å™¨
  |                        |
  |--[1]è¯·æ±‚ /a ---------->|
  |                   [å¤„ç†è¯·æ±‚A]
  |                   [å­˜å…¥Request]
  |                   [è½¬å‘åˆ° /b]
  |                   [å¤„ç†è¯·æ±‚B]
  |                   [è¯»å–Request]
  |<--[2]å“åº”é¡µé¢B---------|
  
  ç‰¹ç‚¹ï¼šåªæœ‰1æ¬¡è¯·æ±‚ï¼ŒRequestæ•°æ®ä¸€ç›´å­˜åœ¨ âœ…

é‡å®šå‘æµç¨‹ï¼ˆæ•°æ®ä¸¢å¤±ï¼‰ï¼š
å®¢æˆ·ç«¯                    æœåŠ¡å™¨
  |                        |
  |--[1]è¯·æ±‚ /a ---------->|
  |                   [å¤„ç†è¯·æ±‚A]
  |                   [å­˜å…¥Request]
  |<--[2]è¿”å›302è·³è½¬-------|
  |                        |
  |--[3]è¯·æ±‚ /b ---------->|
  |                   [æ–°çš„Request]
  |                   [æ—§æ•°æ®å·²ä¸¢å¤±] âŒ
  |<--[4]å“åº”é¡µé¢B---------|
  
  ç‰¹ç‚¹ï¼š2æ¬¡è¯·æ±‚ï¼Œç¬¬äºŒæ¬¡æ˜¯æ–°Requestï¼Œæ•°æ®ä¸¢å¤±
```

### 2.4 Requestä½œç”¨åŸŸå®æˆ˜ç¤ºä¾‹


**åœºæ™¯**ï¼šç”¨æˆ·æäº¤è¡¨å•åæ˜¾ç¤ºç»“æœ

```java
@Controller
public class FormController {
    
    // è¡¨å•æäº¤å¤„ç†
    @PostMapping("/submit")
    public String submitForm(
        @RequestParam String name,
        @RequestParam int age,
        Model model
    ) {
        // æ•°æ®éªŒè¯
        if (age < 18) {
            model.addAttribute("error", "å¹´é¾„å¿…é¡»å¤§äº18å²");
            return "form";  // è½¬å‘å›è¡¨å•é¡µï¼Œé”™è¯¯ä¿¡æ¯ä¿ç•™
        }
        
        // å¤„ç†æˆåŠŸ
        model.addAttribute("name", name);
        model.addAttribute("age", age);
        return "success";  // è½¬å‘åˆ°æˆåŠŸé¡µï¼Œæ•°æ®ä¿ç•™
    }
}
```

**ğŸ¯ ä½¿ç”¨å»ºè®®**
- âœ… é€‚ç”¨ï¼šé¡µé¢é—´çš„è½¬å‘ã€é”™è¯¯ä¿¡æ¯å±•ç¤º
- âŒ ä¸é€‚ç”¨ï¼šé‡å®šå‘ã€éœ€è¦æŒä¹…åŒ–çš„æ•°æ®

---

## 3. âš¡ Flashå±æ€§æœºåˆ¶


### 3.1 ä¸ºä»€ä¹ˆéœ€è¦Flashå±æ€§


**é—®é¢˜åœºæ™¯**ï¼šé‡å®šå‘æ—¶å¦‚ä½•ä¼ é€’æ•°æ®ï¼Ÿ

> **çŸ›ç›¾ç‚¹**ï¼š
> - Requestä½œç”¨åŸŸï¼šæ•°æ®åœ¨é‡å®šå‘æ—¶ä¼šä¸¢å¤± âŒ
> - Sessionä½œç”¨åŸŸï¼šæ•°æ®ä¼šä¿ç•™å¤ªä¹…ï¼Œå®¹æ˜“æ··ä¹± âŒ
> - **Flashå±æ€§**ï¼šå®Œç¾è§£å†³ï¼Œç”¨å®Œå³é”€æ¯ âœ…

**Flashå±æ€§çš„ç‰¹ç‚¹**

```
Flash = "é—ªç°" + "é—ªè¿‡"

ğŸ”¸ å­˜æ´»æ—¶é—´ï¼šä¸¤æ¬¡è¯·æ±‚ä¹‹é—´
ğŸ”¸ å­˜å‚¨ä½ç½®ï¼šä¸´æ—¶ä¿å­˜åœ¨Sessionä¸­
ğŸ”¸ æ¸…é™¤æ—¶æœºï¼šè¢«è¯»å–ä¸€æ¬¡åè‡ªåŠ¨é”€æ¯
```

### 3.2 Flashå±æ€§çš„å·¥ä½œåŸç†


**åº•å±‚æœºåˆ¶å›¾ç¤º**

```
è¯·æ±‚1ï¼ˆå­˜å…¥Flashï¼‰      ä¸­è½¬Session       è¯·æ±‚2ï¼ˆè¯»å–Flashï¼‰
     |                     |                    |
     |--[å­˜å…¥Flashæ•°æ®]---->|                    |
     |               [ä¸´æ—¶ä¿å­˜åœ¨Session]         |
     |<--[è¿”å›é‡å®šå‘]-------|                    |
     |                     |                    |
     |                     |<--[è¯»å–Flashæ•°æ®]--|
     |                     |--[è¿”å›æ•°æ®]------->|
     |                     |--[è‡ªåŠ¨é”€æ¯]------->|
```

**ğŸ”¸ æ ¸å¿ƒç†è§£**
1. Flashæ•°æ®**å€Ÿç”¨**Sessionå­˜å‚¨
2. åªåœ¨**ä¸‹ä¸€æ¬¡è¯·æ±‚**æœ‰æ•ˆ
3. è¯»å–å**è‡ªåŠ¨æ¸…é™¤**ï¼Œä¸æ±¡æŸ“Session

### 3.3 Flashå±æ€§çš„ç”Ÿå‘½å‘¨æœŸ


**å®Œæ•´ç”Ÿå‘½å‘¨æœŸ**

| é˜¶æ®µ | **æ“ä½œ** | **æ•°æ®çŠ¶æ€** |
|-----|---------|------------|
| â‘  å­˜å…¥ | `addFlashAttribute()` | `ä¿å­˜åˆ°Flashå­˜å‚¨åŒº` |
| â‘¡ é‡å®šå‘ | `redirect:/target` | `æ•°æ®è½¬ç§»åˆ°Session` |
| â‘¢ æ–°è¯·æ±‚ | `GET /target` | `ä»Sessionå–å‡ºFlash` |
| â‘£ è¯»å– | `Modelè‡ªåŠ¨è·å–` | `æ•°æ®å¯ç”¨` |
| â‘¤ æ¸…é™¤ | `è¯·æ±‚ç»“æŸ` | `è‡ªåŠ¨é”€æ¯` |

**å¯¹æ¯”æ™®é€šSession**

```
æ™®é€šSessionæ•°æ®ï¼š
å­˜å…¥ â†’ ä¸€ç›´å­˜åœ¨ â†’ æ‰‹åŠ¨åˆ é™¤ â†’ é”€æ¯
é—®é¢˜ï¼šå®¹æ˜“å¿˜è®°åˆ é™¤ï¼Œé€ æˆå†…å­˜æ³„æ¼

Flashå±æ€§ï¼š
å­˜å…¥ â†’ é‡å®šå‘ä¿ç•™ â†’ è‡ªåŠ¨è¯»å– â†’ è‡ªåŠ¨é”€æ¯
ä¼˜åŠ¿ï¼šç”¨å®Œå³é”€æ¯ï¼Œä¸éœ€è¦æ‰‹åŠ¨ç®¡ç† âœ…
```

---

## 4. ğŸ”§ RedirectAttributesè¯¦è§£


### 4.1 RedirectAttributesæ˜¯ä»€ä¹ˆ


**å®šä¹‰**ï¼šä¸“é—¨ç”¨äºé‡å®šå‘æ—¶ä¼ é€’æ•°æ®çš„å·¥å…·ç±»

> **ç±»æ¯”ç†è§£**ï¼š
> - Modelï¼šæ™®é€šå¿«é€’ï¼ˆè½¬å‘ä¸“ç”¨ï¼‰
> - RedirectAttributesï¼šé¡ºä¸°å¿«é€’ï¼ˆé‡å®šå‘ä¸“ç”¨ï¼‰

**æ ¸å¿ƒåŠŸèƒ½**

```
RedirectAttributes æä¾›ä¸¤ç§ä¼ é€’æ–¹å¼ï¼š

1ï¸âƒ£ addFlashAttribute()  â†’ Flashå±æ€§ï¼ˆæ¨èï¼‰
   - æ•°æ®ä¸ä¼šæš´éœ²åœ¨URLä¸­
   - æ”¯æŒä»»ä½•å¯¹è±¡ç±»å‹
   - è‡ªåŠ¨ç®¡ç†ç”Ÿå‘½å‘¨æœŸ

2ï¸âƒ£ addAttribute()  â†’ URLå‚æ•°ï¼ˆç®€å•æ•°æ®ï¼‰
   - æ•°æ®æ‹¼æ¥åœ¨URLåé¢
   - åªæ”¯æŒåŸºæœ¬ç±»å‹
   - ä¼šæš´éœ²åœ¨åœ°å€æ 
```

### 4.2 ä¸¤ç§ä¼ é€’æ–¹å¼å¯¹æ¯”


**æ–¹å¼å¯¹æ¯”è¡¨**

| å¯¹æ¯”é¡¹ | **addFlashAttribute** | **addAttribute** |
|-------|----------------------|------------------|
| ğŸ”’ å®‰å…¨æ€§ | `é«˜ï¼ˆä¸å¯è§ï¼‰` | `ä½ï¼ˆURLå¯è§ï¼‰` |
| ğŸ“¦ æ•°æ®ç±»å‹ | `ä»»æ„å¯¹è±¡` | `åŸºæœ¬ç±»å‹/å­—ç¬¦ä¸²` |
| ğŸ“Š æ•°æ®é‡ | `æ— é™åˆ¶` | `å—URLé•¿åº¦é™åˆ¶` |
| â™»ï¸ ç”Ÿå‘½å‘¨æœŸ | `è‡ªåŠ¨é”€æ¯` | `URLå‚æ•°æ°¸ä¹…` |
| ğŸ¯ é€‚ç”¨åœºæ™¯ | `å¤æ‚å¯¹è±¡ã€æ•æ„Ÿä¿¡æ¯` | `ç®€å•æ ‡è¯†ã€é¡µç ` |

**ä»£ç ç¤ºä¾‹å¯¹æ¯”**

```java
@Controller
public class RedirectController {
    
    @PostMapping("/save")
    public String saveUser(
        @RequestParam String username,
        RedirectAttributes redirectAttributes
    ) {
        // æ–¹å¼1ï¼šFlashå±æ€§ï¼ˆæ¨èç”¨äºå¤æ‚å¯¹è±¡ï¼‰
        User user = new User(username, 25);
        redirectAttributes.addFlashAttribute("user", user);
        redirectAttributes.addFlashAttribute("message", "ä¿å­˜æˆåŠŸ");
        
        // æ–¹å¼2ï¼šURLå‚æ•°ï¼ˆç”¨äºç®€å•æ•°æ®ï¼‰
        redirectAttributes.addAttribute("id", 123);
        
        return "redirect:/result";
        // å®é™…è·³è½¬ï¼š/result?id=123
        // userå’Œmessageé€šè¿‡Flashä¼ é€’ï¼Œä¸åœ¨URLä¸­
    }
    
    @GetMapping("/result")
    public String showResult(
        @RequestParam Long id,  // ä»URLè·å–
        @ModelAttribute("user") User user,  // ä»Flashè·å–
        Model model
    ) {
        // Flashæ•°æ®å·²è‡ªåŠ¨æ³¨å…¥Model
        String message = (String) model.asMap().get("message");
        return "result-page";
    }
}
```

### 4.3 RedirectAttributesæœ€ä½³å®è·µ


**âœ… æ¨èåšæ³•**

```java
// åœºæ™¯1ï¼šè¡¨å•æäº¤æˆåŠŸåé‡å®šå‘
@PostMapping("/create")
public String createOrder(Order order, RedirectAttributes attr) {
    orderService.save(order);
    
    // æˆåŠŸæ¶ˆæ¯ç”¨Flash
    attr.addFlashAttribute("successMsg", "è®¢å•åˆ›å»ºæˆåŠŸ");
    attr.addFlashAttribute("order", order);
    
    // è®¢å•IDç”¨URLå‚æ•°ï¼ˆå¯ä»¥è¢«æ”¶è—/åˆ†äº«ï¼‰
    attr.addAttribute("orderId", order.getId());
    
    return "redirect:/order/detail";
}

// åœºæ™¯2ï¼šéªŒè¯å¤±è´¥è¿”å›è¡¨å•
@PostMapping("/register")
public String register(UserForm form, RedirectAttributes attr) {
    if (userService.existsUsername(form.getUsername())) {
        // é”™è¯¯ä¿¡æ¯å’Œè¡¨å•æ•°æ®ç”¨Flash
        attr.addFlashAttribute("errorMsg", "ç”¨æˆ·åå·²å­˜åœ¨");
        attr.addFlashAttribute("formData", form);
        return "redirect:/register";  // é‡å®šå‘å›æ³¨å†Œé¡µ
    }
    // ... æ³¨å†Œé€»è¾‘
}
```

**âŒ é”™è¯¯åšæ³•**

```java
// é”™è¯¯1ï¼šæ•æ„Ÿä¿¡æ¯ç”¨URLå‚æ•°
attr.addAttribute("password", "123456");  // âŒ å¯†ç æš´éœ²åœ¨URL
attr.addFlashAttribute("password", "123456");  // âœ… å®‰å…¨

// é”™è¯¯2ï¼šå¤§å¯¹è±¡ç”¨URLå‚æ•°
attr.addAttribute("userList", list);  // âŒ æ— æ³•ä¼ é€’
attr.addFlashAttribute("userList", list);  // âœ… æ­£ç¡®

// é”™è¯¯3ï¼šå¿˜è®°ä½¿ç”¨RedirectAttributes
public String save(Model model) {
    model.addAttribute("msg", "æˆåŠŸ");  // âŒ é‡å®šå‘ä¼šä¸¢å¤±
    return "redirect:/result";
}
```

---

## 5. ğŸš€ é‡å®šå‘æ•°æ®ä¼ é€’


### 5.1 ä¸ºä»€ä¹ˆéœ€è¦é‡å®šå‘ä¼ é€’æ•°æ®


**å®é™…åœºæ™¯åˆ†æ**

```
åœºæ™¯1ï¼šé˜²æ­¢è¡¨å•é‡å¤æäº¤
ç”¨æˆ·æäº¤è®¢å• â†’ å¤„ç†æˆåŠŸ â†’ é‡å®šå‘åˆ°è®¢å•è¯¦æƒ…
é—®é¢˜ï¼šè®¢å•ä¿¡æ¯å¦‚ä½•ä¼ é€’åˆ°è¯¦æƒ…é¡µï¼Ÿ

åœºæ™¯2ï¼šæ“ä½œæˆåŠŸæç¤º
ç”¨æˆ·åˆ é™¤æ–‡ç«  â†’ é‡å®šå‘åˆ°åˆ—è¡¨é¡µ â†’ æ˜¾ç¤º"åˆ é™¤æˆåŠŸ"
é—®é¢˜ï¼šæç¤ºä¿¡æ¯å¦‚ä½•è·¨é‡å®šå‘ä¼ é€’ï¼Ÿ

åœºæ™¯3ï¼šè¡¨å•éªŒè¯é”™è¯¯
ç”¨æˆ·æ³¨å†Œ â†’ éªŒè¯å¤±è´¥ â†’ é‡å®šå‘å›è¡¨å• â†’ æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
é—®é¢˜ï¼šé”™è¯¯ä¿¡æ¯å’Œè¡¨å•æ•°æ®å¦‚ä½•å›å¡«ï¼Ÿ
```

### 5.2 æ•°æ®ä¼ é€’çš„ä¸‰ç§æ–¹å¼


**æ–¹å¼å¯¹æ¯”**

| æ–¹å¼ | **å®ç°æ–¹æ³•** | **ä¼˜ç‚¹** | **ç¼ºç‚¹** | **é€‚ç”¨åœºæ™¯** |
|-----|------------|---------|---------|------------|
| ğŸ”µ **URLå‚æ•°** | `addAttribute()` | `ç®€å•ç›´æ¥` | `æš´éœ²æ•°æ®ã€é•¿åº¦é™åˆ¶` | `å…¬å¼€çš„IDã€é¡µç ` |
| ğŸŸ¢ **Flashå±æ€§** | `addFlashAttribute()` | `å®‰å…¨ã€çµæ´»` | `ä¾èµ–Session` | `å¤æ‚å¯¹è±¡ã€æ•æ„Ÿä¿¡æ¯` |
| ğŸŸ  **Sessionæ‰‹åŠ¨ç®¡ç†** | `session.setAttribute()` | `æ•°æ®æŒä¹…` | `éœ€æ‰‹åŠ¨æ¸…é™¤` | `éœ€è¦è·¨å¤šæ¬¡è¯·æ±‚çš„æ•°æ®` |

### 5.3 å®Œæ•´ç¤ºä¾‹ï¼šç”¨æˆ·æ³¨å†Œæµç¨‹


**åœºæ™¯**ï¼šæ³¨å†Œå¤±è´¥åé‡å®šå‘ï¼Œä¿ç•™è¡¨å•æ•°æ®å’Œé”™è¯¯ä¿¡æ¯

```java
@Controller
@RequestMapping("/user")
public class UserRegisterController {
    
    // æ˜¾ç¤ºæ³¨å†Œè¡¨å•
    @GetMapping("/register")
    public String showRegisterForm(Model model) {
        // ä»Flashä¸­è·å–å›å¡«æ•°æ®ï¼ˆå¦‚æœæœ‰ï¼‰
        if (!model.containsAttribute("userForm")) {
            model.addAttribute("userForm", new UserForm());
        }
        // errorMsgä¹Ÿä¼šè‡ªåŠ¨ä»Flashæ³¨å…¥åˆ°Model
        return "register";
    }
    
    // å¤„ç†æ³¨å†Œæäº¤
    @PostMapping("/register")
    public String register(
        @Valid UserForm form,
        BindingResult result,
        RedirectAttributes redirectAttr
    ) {
        // æ•°æ®éªŒè¯å¤±è´¥
        if (result.hasErrors()) {
            // ä½¿ç”¨Flashä¼ é€’é”™è¯¯ä¿¡æ¯å’Œè¡¨å•æ•°æ®
            redirectAttr.addFlashAttribute("userForm", form);
            redirectAttr.addFlashAttribute("errorMsg", "è¡¨å•éªŒè¯å¤±è´¥");
            redirectAttr.addFlashAttribute("errors", result.getAllErrors());
            return "redirect:/user/register";  // é‡å®šå‘å›æ³¨å†Œé¡µ
        }
        
        // ä¸šåŠ¡éªŒè¯
        if (userService.existsUsername(form.getUsername())) {
            redirectAttr.addFlashAttribute("userForm", form);
            redirectAttr.addFlashAttribute("errorMsg", "ç”¨æˆ·åå·²å­˜åœ¨");
            return "redirect:/user/register";
        }
        
        // æ³¨å†ŒæˆåŠŸ
        User user = userService.register(form);
        redirectAttr.addFlashAttribute("successMsg", "æ³¨å†ŒæˆåŠŸï¼Œè¯·ç™»å½•");
        redirectAttr.addAttribute("username", user.getUsername());  // URLå‚æ•°
        return "redirect:/login";
    }
}
```

**å‰ç«¯é¡µé¢æ¥æ”¶ï¼ˆThymeleafç¤ºä¾‹ï¼‰**

```html
<!-- register.html -->
<form th:action="@{/user/register}" method="post">
    <!-- æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼ˆæ¥è‡ªFlashï¼‰ -->
    <div th:if="${errorMsg}" class="alert alert-danger">
        <span th:text="${errorMsg}"></span>
    </div>
    
    <!-- è¡¨å•å›å¡«ï¼ˆæ¥è‡ªFlashï¼‰ -->
    <input type="text" 
           th:value="${userForm?.username}" 
           name="username" />
    
    <input type="email" 
           th:value="${userForm?.email}" 
           name="email" />
    
    <button type="submit">æ³¨å†Œ</button>
</form>
```

### 5.4 é‡å®šå‘ä¼ é€’çš„æµç¨‹å›¾


```
ç”¨æˆ·æäº¤è¡¨å•
     |
     â†“
[éªŒè¯æ•°æ®]
     |
     â†“
  éªŒè¯å¤±è´¥ï¼Ÿ
   /     \
 æ˜¯       å¦
 â†“        â†“
å­˜å…¥Flash  å­˜å…¥Flash
é”™è¯¯ä¿¡æ¯    æˆåŠŸä¿¡æ¯
è¡¨å•æ•°æ®
 â†“        â†“
é‡å®šå‘     é‡å®šå‘
æ³¨å†Œé¡µ     ç™»å½•é¡µ
 â†“        â†“
Flashè‡ªåŠ¨   Flashè‡ªåŠ¨
æ³¨å…¥Model  æ³¨å…¥Model
 â†“        â†“
é¡µé¢æ˜¾ç¤º   é¡µé¢æ˜¾ç¤º
é”™è¯¯+å›å¡«  æˆåŠŸæç¤º
```

---

## 6. â° ä½œç”¨åŸŸç”Ÿå‘½å‘¨æœŸ


### 6.1 Requestä½œç”¨åŸŸç”Ÿå‘½å‘¨æœŸ


**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**

```
â‘ åˆ›å»ºé˜¶æ®µ
   â†“
ç”¨æˆ·å‘èµ·HTTPè¯·æ±‚
   â†“
Servletå®¹å™¨åˆ›å»ºRequestå¯¹è±¡
   â†“
â‘¡ä½¿ç”¨é˜¶æ®µ
   â†“
Controllerå¤„ç†è¯·æ±‚
   â†“
å‘Requestå­˜å…¥æ•°æ®ï¼ˆModelï¼‰
   â†“
è½¬å‘åˆ°JSP/Thymeleaf
   â†“
é¡µé¢è¯»å–Requestæ•°æ®
   â†“
â‘¢é”€æ¯é˜¶æ®µ
   â†“
å“åº”è¿”å›ç»™å®¢æˆ·ç«¯
   â†“
Requestå¯¹è±¡è¢«é”€æ¯
   â†“
æ•°æ®å…¨éƒ¨æ¸…ç©º
```

**æ—¶é—´è·¨åº¦**ï¼šå‡ æ¯«ç§’~å‡ ç§’

### 6.2 Sessionä½œç”¨åŸŸç”Ÿå‘½å‘¨æœŸ


**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**

```
â‘ åˆ›å»ºé˜¶æ®µ
   â†“
ç”¨æˆ·é¦–æ¬¡è®¿é—®
   â†“
æœåŠ¡å™¨åˆ›å»ºSessionå¯¹è±¡
   â†“
ç”ŸæˆSessionIDï¼ˆJSESSIONIDï¼‰
   â†“
â‘¡ä½¿ç”¨é˜¶æ®µ
   â†“
ç”¨æˆ·å¤šæ¬¡è¯·æ±‚
   â†“
é€šè¿‡SessionIDè¯†åˆ«ç”¨æˆ·
   â†“
å­˜å–Sessionæ•°æ®
   â†“
â‘¢è¶…æ—¶æ£€æµ‹
   â†“
30åˆ†é’Ÿæ— æ´»åŠ¨ï¼ˆé»˜è®¤ï¼‰
   â†“
â‘£é”€æ¯é˜¶æ®µ
   â†“
è¶…æ—¶/æ‰‹åŠ¨é”€æ¯/æœåŠ¡å™¨å…³é—­
   â†“
Sessionæ•°æ®æ¸…ç©º
```

**æ—¶é—´è·¨åº¦**ï¼šå‡ åˆ†é’Ÿ~å‡ å°æ—¶

### 6.3 Flashå±æ€§ç”Ÿå‘½å‘¨æœŸ


**å®Œæ•´ç”Ÿå‘½å‘¨æœŸ**

```
è¯·æ±‚1ï¼šå­˜å…¥é˜¶æ®µ
   â†“
è°ƒç”¨addFlashAttribute()
   â†“
æ•°æ®å­˜å…¥Flashä¸´æ—¶åŒº
   â†“
è¿”å›é‡å®šå‘å“åº”ï¼ˆ302ï¼‰
   â†“
Flashæ•°æ®è½¬ç§»åˆ°Session
   â†“
[ä¸­é—´çŠ¶æ€ï¼šæ•°æ®åœ¨Sessionä¸­ç­‰å¾…]
   â†“
è¯·æ±‚2ï¼šè¯»å–é˜¶æ®µ
   â†“
æµè§ˆå™¨å‘èµ·æ–°è¯·æ±‚
   â†“
Springæ£€æµ‹åˆ°Flashæ•°æ®
   â†“
è‡ªåŠ¨æ³¨å…¥åˆ°Model
   â†“
Controller/é¡µé¢ä½¿ç”¨æ•°æ®
   â†“
è¯·æ±‚å¤„ç†å®Œæˆ
   â†“
Flashæ•°æ®è‡ªåŠ¨é”€æ¯
```

**æ—¶é—´è·¨åº¦**ï¼šä¸¤æ¬¡è¯·æ±‚ä¹‹é—´ï¼ˆé€šå¸¸1ç§’å†…ï¼‰

### 6.4 ä¸‰å¤§ä½œç”¨åŸŸå¯¹æ¯”å›¾


```
ç”Ÿå‘½å‘¨æœŸå¯¹æ¯”ï¼š

Request:   [è¯·æ±‚]â”€â”€â”€â†’[å“åº”]  é”€æ¯ âœ—
           â†‘_______â†‘
            å‡ æ¯«ç§’

Flash:     [è¯·æ±‚1]â”€â†’[é‡å®šå‘]â”€â†’[è¯·æ±‚2]  é”€æ¯ âœ—
           â†‘__________________â†‘
                 1ç§’å†…

Session:   [ç™»å½•]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[é€€å‡º]  é”€æ¯ âœ—
           â†‘________________________â†‘
                å‡ åˆ†é’Ÿ~å‡ å°æ—¶

Application: [å¯åŠ¨]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[å…³é—­]  é”€æ¯ âœ—
             â†‘____________________â†‘
                 åº”ç”¨æ•´ä¸ªè¿è¡ŒæœŸ
```

---

## 7. ğŸ¯ å®æˆ˜åº”ç”¨åœºæ™¯


### 7.1 åœºæ™¯1ï¼šè¡¨å•éªŒè¯å¤±è´¥å›å¡«


**éœ€æ±‚**ï¼šè¡¨å•æäº¤å¤±è´¥åï¼Œæ•°æ®å›å¡«+æ˜¾ç¤ºé”™è¯¯

```java
@Controller
public class ProductController {
    
    @PostMapping("/product/add")
    public String addProduct(
        @Valid ProductForm form,
        BindingResult result,
        RedirectAttributes redirectAttr
    ) {
        if (result.hasErrors()) {
            // âœ… ä½¿ç”¨Flashä¿å­˜è¡¨å•æ•°æ®
            redirectAttr.addFlashAttribute("productForm", form);
            
            // âœ… ä½¿ç”¨Flashä¿å­˜é”™è¯¯ä¿¡æ¯
            Map<String, String> errors = new HashMap<>();
            result.getFieldErrors().forEach(error -> 
                errors.put(error.getField(), error.getDefaultMessage())
            );
            redirectAttr.addFlashAttribute("errors", errors);
            
            return "redirect:/product/add";
        }
        
        productService.save(form);
        redirectAttr.addFlashAttribute("successMsg", "æ·»åŠ æˆåŠŸ");
        return "redirect:/product/list";
    }
}
```

**ğŸ’¡ å…³é”®ç‚¹**
- è¡¨å•æ•°æ®ç”¨Flashï¼Œé¿å…ä¸¢å¤±
- é”™è¯¯ä¿¡æ¯ç”¨Flashï¼Œç²¾ç¡®æ˜¾ç¤º
- é‡å®šå‘é˜²æ­¢åˆ·æ–°é‡å¤æäº¤

### 7.2 åœºæ™¯2ï¼šæ“ä½œæˆåŠŸæç¤º


**éœ€æ±‚**ï¼šåˆ é™¤æˆåŠŸåæ˜¾ç¤ºæç¤ºä¿¡æ¯

```java
@Controller
@RequestMapping("/article")
public class ArticleController {
    
    @PostMapping("/delete/{id}")
    public String deleteArticle(
        @PathVariable Long id,
        RedirectAttributes redirectAttr
    ) {
        Article article = articleService.findById(id);
        articleService.delete(id);
        
        // âœ… æç¤ºä¿¡æ¯ç”¨Flashï¼ˆä¸€æ¬¡æ€§æ˜¾ç¤ºï¼‰
        redirectAttr.addFlashAttribute("alertType", "success");
        redirectAttr.addFlashAttribute("alertMsg", 
            "æ–‡ç« ã€Š" + article.getTitle() + "ã€‹å·²åˆ é™¤");
        
        return "redirect:/article/list";
    }
    
    @GetMapping("/list")
    public String listArticles(Model model) {
        // Flashæ•°æ®è‡ªåŠ¨æ³¨å…¥Model
        // alertType å’Œ alertMsg å¯ä»¥ç›´æ¥åœ¨é¡µé¢ä½¿ç”¨
        List<Article> articles = articleService.findAll();
        model.addAttribute("articles", articles);
        return "article-list";
    }
}
```

**å‰ç«¯æç¤ºæ¡†ï¼ˆè‡ªåŠ¨æ˜¾ç¤ºåæ¶ˆå¤±ï¼‰**

```html
<!-- article-list.html -->
<div th:if="${alertMsg}" 
     th:class="'alert alert-' + ${alertType}"
     th:text="${alertMsg}">
</div>

<script>
// 3ç§’åè‡ªåŠ¨éšè—æç¤º
setTimeout(() => {
    document.querySelector('.alert')?.remove();
}, 3000);
</script>
```

### 7.3 åœºæ™¯3ï¼šè´­ç‰©è½¦æµç¨‹


**éœ€æ±‚**ï¼šåŠ å…¥è´­ç‰©è½¦åé‡å®šå‘ï¼Œæ˜¾ç¤ºè´­ç‰©è½¦æ•°é‡

```java
@Controller
public class CartController {
    
    @PostMapping("/cart/add")
    public String addToCart(
        @RequestParam Long productId,
        @RequestParam int quantity,
        RedirectAttributes redirectAttr,
        HttpSession session
    ) {
        // ä»Sessionè·å–è´­ç‰©è½¦ï¼ˆSessionä½œç”¨åŸŸï¼‰
        Cart cart = (Cart) session.getAttribute("cart");
        if (cart == null) {
            cart = new Cart();
            session.setAttribute("cart", cart);
        }
        
        // æ·»åŠ å•†å“
        Product product = productService.findById(productId);
        cart.addItem(product, quantity);
        
        // âœ… Flashæ˜¾ç¤ºæç¤ºä¿¡æ¯
        redirectAttr.addFlashAttribute("cartMsg", 
            "å·²æ·»åŠ  " + quantity + " ä»¶å•†å“åˆ°è´­ç‰©è½¦");
        
        // âœ… URLå‚æ•°ä¼ é€’å•†å“IDï¼ˆå¯åˆ†äº«ï¼‰
        redirectAttr.addAttribute("productId", productId);
        
        return "redirect:/product/detail";
    }
}
```

**ä½œç”¨åŸŸé€‰æ‹©åŸåˆ™**

| æ•°æ®ç±»å‹ | **é€‰æ‹©çš„ä½œç”¨åŸŸ** | **åŸå› ** |
|---------|---------------|---------|
| ğŸ›’ è´­ç‰©è½¦æ•°æ® | `Session` | `éœ€è¦è·¨å¤šæ¬¡è¯·æ±‚ä¿ç•™` |
| ğŸ’¬ æ“ä½œæç¤º | `Flash` | `ä¸€æ¬¡æ€§æ˜¾ç¤º` |
| ğŸ”— å•†å“ID | `URLå‚æ•°` | `å¯åˆ†äº«ã€å¯æ”¶è—` |
| ğŸ“„ é¡µé¢ä¸´æ—¶æ•°æ® | `Request` | `ä»…å½“å‰é¡µé¢ä½¿ç”¨` |

### 7.4 åœºæ™¯4ï¼šå¤šæ­¥éª¤è¡¨å•


**éœ€æ±‚**ï¼šåˆ†æ­¥å¡«å†™è¡¨å•ï¼Œæœ€åç»Ÿä¸€æäº¤

```java
@Controller
@SessionAttributes("wizardForm")  // Sessionå­˜å‚¨è¡¨å•
public class WizardController {
    
    // æ­¥éª¤1ï¼šåŸºæœ¬ä¿¡æ¯
    @GetMapping("/wizard/step1")
    public String step1(Model model) {
        if (!model.containsAttribute("wizardForm")) {
            model.addAttribute("wizardForm", new WizardForm());
        }
        return "wizard-step1";
    }
    
    @PostMapping("/wizard/step1")
    public String saveStep1(
        @ModelAttribute("wizardForm") WizardForm form,
        RedirectAttributes redirectAttr
    ) {
        // âœ… Sessionè‡ªåŠ¨ä¿å­˜wizardForm
        // âœ… Flashä¼ é€’æ­¥éª¤æç¤º
        redirectAttr.addFlashAttribute("stepMsg", "æ­¥éª¤1å®Œæˆ");
        return "redirect:/wizard/step2";
    }
    
    // æ­¥éª¤2ï¼šè¯¦ç»†ä¿¡æ¯
    @PostMapping("/wizard/step2")
    public String saveStep2(
        @ModelAttribute("wizardForm") WizardForm form,
        RedirectAttributes redirectAttr
    ) {
        redirectAttr.addFlashAttribute("stepMsg", "æ­¥éª¤2å®Œæˆ");
        return "redirect:/wizard/step3";
    }
    
    // æœ€ç»ˆæäº¤
    @PostMapping("/wizard/submit")
    public String submitWizard(
        @ModelAttribute("wizardForm") WizardForm form,
        RedirectAttributes redirectAttr,
        SessionStatus sessionStatus
    ) {
        // ä¿å­˜æ•°æ®
        wizardService.save(form);
        
        // âœ… æ¸…é™¤Sessionä¸­çš„è¡¨å•æ•°æ®
        sessionStatus.setComplete();
        
        redirectAttr.addFlashAttribute("successMsg", "æäº¤æˆåŠŸ");
        return "redirect:/wizard/success";
    }
}
```

**æµç¨‹å›¾**

```
æ­¥éª¤1é¡µé¢
   â†“ [æäº¤]
ä¿å­˜åˆ°Session
   â†“ [é‡å®šå‘]
æ­¥éª¤2é¡µé¢ï¼ˆè¯»å–Sessionï¼‰
   â†“ [æäº¤]
æ›´æ–°Session
   â†“ [é‡å®šå‘]
æ­¥éª¤3é¡µé¢ï¼ˆè¯»å–Sessionï¼‰
   â†“ [æäº¤]
æœ€ç»ˆä¿å­˜
æ¸…é™¤Session
   â†“ [é‡å®šå‘]
æˆåŠŸé¡µé¢ï¼ˆFlashæç¤ºï¼‰
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ä½œç”¨åŸŸæœ¬è´¨ï¼šæ•°æ®çš„ç”Ÿå­˜ç©ºé—´å’Œæœ‰æ•ˆæœŸ
ğŸ”¸ Requestä½œç”¨åŸŸï¼šä¸€æ¬¡è¯·æ±‚æœŸé—´æœ‰æ•ˆï¼Œè½¬å‘ä¿ç•™ï¼Œé‡å®šå‘ä¸¢å¤±
ğŸ”¸ Flashå±æ€§ï¼šé‡å®šå‘ä¸“ç”¨ï¼Œç”¨å®Œå³é”€æ¯ï¼Œä¸æ±¡æŸ“Session
ğŸ”¸ RedirectAttributesï¼šé‡å®šå‘ä¼ é€’æ•°æ®çš„ä¸“ç”¨å·¥å…·
ğŸ”¸ ç”Ÿå‘½å‘¨æœŸï¼šRequest < Flash < Session < Application
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä½œç”¨åŸŸé€‰æ‹©åŸåˆ™**

```
é€‰æ‹©Requestçš„æƒ…å†µï¼š
âœ… é¡µé¢é—´è½¬å‘ï¼ˆforwardï¼‰
âœ… ä¸´æ—¶æ•°æ®ï¼Œä¸éœ€è¦è·¨è¯·æ±‚
âœ… é”™è¯¯ä¿¡æ¯æ˜¾ç¤ºï¼ˆè½¬å‘å›è¡¨å•ï¼‰

é€‰æ‹©Flashçš„æƒ…å†µï¼š
âœ… é‡å®šå‘åæ˜¾ç¤ºæç¤ºä¿¡æ¯
âœ… è¡¨å•éªŒè¯å¤±è´¥æ•°æ®å›å¡«
âœ… æ“ä½œæˆåŠŸçš„ä¸€æ¬¡æ€§æç¤º

é€‰æ‹©Sessionçš„æƒ…å†µï¼š
âœ… ç”¨æˆ·ç™»å½•ä¿¡æ¯
âœ… è´­ç‰©è½¦æ•°æ®
âœ… å¤šæ­¥éª¤è¡¨å•çš„ä¸­é—´æ•°æ®
```

**ğŸ”¹ è½¬å‘ä¸é‡å®šå‘çš„é€‰æ‹©**

| åœºæ™¯ | **é€‰æ‹©** | **æ•°æ®ä¼ é€’æ–¹å¼** |
|-----|---------|---------------|
| ğŸ“„ æ˜¾ç¤ºè¡¨å•éªŒè¯é”™è¯¯ | `è½¬å‘` | `Requestï¼ˆModelï¼‰` |
| âœ… æ“ä½œæˆåŠŸè·³è½¬åˆ—è¡¨ | `é‡å®šå‘` | `Flash` |
| ğŸ”„ é˜²æ­¢è¡¨å•é‡å¤æäº¤ | `é‡å®šå‘` | `Flash` |
| ğŸ“Š åŒä¸€æ§åˆ¶å™¨å†…è·³è½¬ | `è½¬å‘` | `Request` |

**ğŸ”¹ RedirectAttributesä¸¤ç§æ–¹æ³•åŒºåˆ«**

```
addFlashAttribute()ï¼š
â€¢ æ•°æ®ä¸åœ¨URLä¸­ï¼Œå®‰å…¨
â€¢ æ”¯æŒä»»æ„å¯¹è±¡ç±»å‹
â€¢ è‡ªåŠ¨ç®¡ç†ç”Ÿå‘½å‘¨æœŸ
â€¢ é€‚åˆï¼šå¤æ‚å¯¹è±¡ã€æ•æ„Ÿä¿¡æ¯

addAttribute()ï¼š
â€¢ æ•°æ®æ‹¼æ¥åœ¨URLä¸­ï¼Œå¯è§
â€¢ åªæ”¯æŒåŸºæœ¬ç±»å‹
â€¢ æ°¸ä¹…å­˜åœ¨äºURL
â€¢ é€‚åˆï¼šå…¬å¼€IDã€é¡µç ã€æŸ¥è¯¢å‚æ•°
```

### 8.3 æœ€ä½³å®è·µå»ºè®®


**âœ… æ¨èåšæ³•**

```java
// 1. é‡å®šå‘å¿…ç”¨RedirectAttributes
@PostMapping("/save")
public String save(RedirectAttributes attr) {
    attr.addFlashAttribute("msg", "æˆåŠŸ");  // âœ…
    return "redirect:/list";
}

// 2. Flashä¼ é€’å¤æ‚å¯¹è±¡
attr.addFlashAttribute("user", userObject);  // âœ…
attr.addAttribute("user", userObject);  // âŒ æ— æ³•ä¼ é€’

// 3. URLå‚æ•°ä¼ é€’å…¬å¼€æ ‡è¯†
attr.addAttribute("id", 123);  // âœ… å¯åˆ†äº«çš„é“¾æ¥
attr.addFlashAttribute("id", 123);  // âŒ ç”¨æˆ·åˆ·æ–°ä¼šä¸¢å¤±

// 4. Sessionæ•°æ®åŠæ—¶æ¸…ç†
sessionStatus.setComplete();  // âœ… ç”¨å®Œå°±æ¸…
```

**âŒ é¿å…çš„é”™è¯¯**

```java
// é”™è¯¯1ï¼šé‡å®šå‘ç”¨Modelä¼ é€’æ•°æ®
public String save(Model model) {
    model.addAttribute("msg", "æˆåŠŸ");  // âŒ ä¼šä¸¢å¤±
    return "redirect:/list";
}

// é”™è¯¯2ï¼šæ•æ„Ÿä¿¡æ¯ç”¨URLå‚æ•°
attr.addAttribute("password", pwd);  // âŒ URLæš´éœ²
attr.addFlashAttribute("password", pwd);  // âœ… å®‰å…¨

// é”™è¯¯3ï¼šFlashæ•°æ®ä¸ä¼šè‡ªåŠ¨æ¸…é™¤çš„è¯¯è§£
// Flashæ•°æ®è¯»å–ä¸€æ¬¡åè‡ªåŠ¨é”€æ¯ï¼Œæ— éœ€æ‰‹åŠ¨æ¸…é™¤ âœ…
```

### 8.4 è®°å¿†å£è¯€


```
ä½œç”¨åŸŸé€‰æ‹©è®°å¿ƒé—´ï¼Œ
Requestè½¬å‘Flashé‡å®šå‘ï¼Œ
Sessionè·¨è¯·æ±‚è¦è°¨æ…ï¼Œ
ç”¨å®Œè®°å¾—æ¸…ç†å®Œã€‚

é‡å®šå‘æ•°æ®æ€ä¹ˆä¼ ï¼Ÿ
RedirectAttributesæ¥å¸®å¿™ï¼Œ
Flashå±æ€§æœ€å®‰å…¨ï¼Œ
URLå‚æ•°è¦å…¬å¼€ã€‚

ä¸‰å¤§ä½œç”¨åŸŸç”Ÿå‘½æœŸï¼Œ
Requestæœ€çŸ­Flashä¸­é—´ï¼Œ
Sessionéœ€è¦æ‰‹åŠ¨ç®¡ï¼Œ
åˆç†ä½¿ç”¨ä¸æ··ä¹±ã€‚
```

### 8.5 å®é™…åº”ç”¨æ£€æŸ¥æ¸…å•


**âœ“ æ•°æ®ä¼ é€’æ£€æŸ¥**
- [ ] æ˜¯è½¬å‘è¿˜æ˜¯é‡å®šå‘ï¼Ÿ
- [ ] æ•°æ®æ˜¯å¦éœ€è¦è·¨è¯·æ±‚ï¼Ÿ
- [ ] æ•°æ®æ˜¯å¦æ•æ„Ÿä¸èƒ½æš´éœ²ï¼Ÿ
- [ ] æ˜¯å¦éœ€è¦è‡ªåŠ¨æ¸…ç†ï¼Ÿ

**âœ“ ä½œç”¨åŸŸé€‰æ‹©æ£€æŸ¥**
- [ ] Requestï¼šä»…å½“å‰è¯·æ±‚ä½¿ç”¨ï¼Ÿ
- [ ] Flashï¼šé‡å®šå‘ä¸€æ¬¡æ€§ä½¿ç”¨ï¼Ÿ
- [ ] Sessionï¼šå¤šæ¬¡è¯·æ±‚å…±äº«ï¼Ÿ
- [ ] æ˜¯å¦åŠæ—¶æ¸…ç†Sessionï¼Ÿ

**âœ“ ä»£ç è´¨é‡æ£€æŸ¥**
- [ ] é‡å®šå‘æ˜¯å¦ç”¨RedirectAttributesï¼Ÿ
- [ ] å¤æ‚å¯¹è±¡æ˜¯å¦ç”¨Flashï¼Ÿ
- [ ] URLå‚æ•°æ˜¯å¦åªä¼ å…¬å¼€æ•°æ®ï¼Ÿ
- [ ] Sessionæ•°æ®æ˜¯å¦æ‰‹åŠ¨æ¸…ç†ï¼Ÿ