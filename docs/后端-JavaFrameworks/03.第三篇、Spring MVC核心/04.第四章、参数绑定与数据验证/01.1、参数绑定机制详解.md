---
title: 1ã€å‚æ•°ç»‘å®šæœºåˆ¶è¯¦è§£
---
## ğŸ“š ç›®å½•

1. [è¯·æ±‚å‚æ•°ç»‘å®šæœºåˆ¶](#1-è¯·æ±‚å‚æ•°ç»‘å®šæœºåˆ¶)
2. [æ ¸å¿ƒæ³¨è§£è¯¦è§£](#2-æ ¸å¿ƒæ³¨è§£è¯¦è§£)
3. [å‚æ•°ç±»å‹è½¬æ¢](#3-å‚æ•°ç±»å‹è½¬æ¢)
4. [æ•°æ®éªŒè¯æœºåˆ¶](#4-æ•°æ®éªŒè¯æœºåˆ¶)
5. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#5-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”— è¯·æ±‚å‚æ•°ç»‘å®šæœºåˆ¶


### 1.1 ä»€ä¹ˆæ˜¯å‚æ•°ç»‘å®š


**é€šä¿—ç†è§£**ï¼šå°±åƒå¿«é€’å‘˜é€åŒ…è£¹ï¼Œéœ€è¦çŸ¥é“æ”¶ä»¶äººå§“åã€åœ°å€ã€ç”µè¯ã€‚Spring MVC çš„å‚æ•°ç»‘å®šå°±æ˜¯æŠŠæµè§ˆå™¨å‘æ¥çš„æ•°æ®ï¼ˆç”¨æˆ·è¾“å…¥ã€URLå‚æ•°ç­‰ï¼‰è‡ªåŠ¨"é€åˆ°"ä½ çš„æ–¹æ³•å‚æ•°é‡Œã€‚

```
ç”¨æˆ·åœ¨æµè§ˆå™¨æ“ä½œï¼š
è¾“å…¥ç½‘å€ï¼šhttp://localhost:8080/user/123?name=å¼ ä¸‰
ç‚¹å‡»æäº¤è¡¨å•ï¼š{ username: "admin", password: "123456" }

Spring MVC è‡ªåŠ¨å¤„ç†ï¼š
â†“ è¯†åˆ«è¯·æ±‚
â†“ æå–å‚æ•°
â†“ è½¬æ¢ç±»å‹
â†“ ç»‘å®šåˆ°æ–¹æ³•å‚æ•°

ä½ çš„ä»£ç ç›´æ¥ä½¿ç”¨ï¼š
public String getUser(Long id, String name) {
    // id = 123, name = "å¼ ä¸‰" å·²ç»å‡†å¤‡å¥½äº†
}
```

**æ ¸å¿ƒä»·å€¼**ï¼š
- ğŸ¯ **è‡ªåŠ¨åŒ–**ï¼šä¸ç”¨æ‰‹åŠ¨è·å–å‚æ•°ï¼ŒSpring è‡ªåŠ¨å¸®ä½ æå®š
- ğŸ”„ **ç±»å‹è½¬æ¢**ï¼šå­—ç¬¦ä¸²è‡ªåŠ¨è½¬æˆæ•°å­—ã€æ—¥æœŸç­‰ç±»å‹
- âœ… **ç®€åŒ–ä»£ç **ï¼šä»åå‡ è¡Œä»£ç ç®€åŒ–åˆ°ä¸€ä¸ªæ³¨è§£

### 1.2 å‚æ•°ç»‘å®šçš„å·¥ä½œåŸç†


**Spring MVC å†…éƒ¨å¤„ç†æµç¨‹**ï¼š

```
æµè§ˆå™¨è¯·æ±‚                    Spring MVC å¤„ç†                    ä½ çš„æ–¹æ³•
     |                              |                              |
[å‘é€HTTPè¯·æ±‚]                 [1.æ¥æ”¶è¯·æ±‚]                          |
     |                              |                              |
GET /user?id=1        ------>  [2.è§£æè¯·æ±‚å‚æ•°]                      |
                                    |                              |
                              [3.æŸ¥æ‰¾å¯¹åº”æ–¹æ³•]                        |
                                    |                              |
                              [4.åŒ¹é…æ³¨è§£è§„åˆ™]                        |
                              (@RequestParamç­‰)                    |
                                    |                              |
                              [5.ç±»å‹è½¬æ¢]                           |
                              (String â†’ Long)                     |
                                    |                              |
                              [6.è°ƒç”¨æ–¹æ³•]  ------->  public String getUser(Long id)
                                    |                              |
                              [7.è¿”å›ç»“æœ]  <-------       return "user";
```

**ğŸ”¸ è‡ªåŠ¨ç»‘å®šçš„å‰ææ¡ä»¶**ï¼š
- å‚æ•°ååŒ¹é…ï¼šæ–¹æ³•å‚æ•°åè¦å’Œè¯·æ±‚å‚æ•°åä¸€è‡´
- ç±»å‹å…¼å®¹ï¼šèƒ½å¤Ÿè¿›è¡Œç±»å‹è½¬æ¢ï¼ˆå¦‚ String â†’ Integerï¼‰
- è®¿é—®æƒé™ï¼šå‚æ•°æœ‰å¯¹åº”çš„ setter æ–¹æ³•ï¼ˆå¯¹äºå¯¹è±¡ç»‘å®šï¼‰

---

## 2. ğŸ·ï¸ æ ¸å¿ƒæ³¨è§£è¯¦è§£


### 2.1 @RequestParam - è·å–è¯·æ±‚å‚æ•°


**ä½œç”¨**ï¼šä» URL æŸ¥è¯¢å‚æ•°æˆ–è¡¨å•æ•°æ®ä¸­è·å–å€¼

**é€‚ç”¨åœºæ™¯**ï¼š`?id=123&name=å¼ ä¸‰` è¿™æ ·çš„å‚æ•°

#### ğŸ”¸ åŸºæœ¬ç”¨æ³•


```java
// è¯·æ±‚ï¼šGET /user?id=123
@GetMapping("/user")
public String getUser(@RequestParam Long id) {
    return "ç”¨æˆ·IDï¼š" + id;
}
```

**é€šä¿—è§£é‡Š**ï¼š`@RequestParam` å°±åƒå‘Šè¯‰ Springï¼š"å»è¯·æ±‚å‚æ•°é‡Œæ‰¾åå« id çš„å€¼ï¼Œç»™æˆ‘è½¬æˆ Long ç±»å‹"

#### ğŸ”¸ æ ¸å¿ƒå±æ€§é…ç½®


| å±æ€§ | è¯´æ˜ | ç¤ºä¾‹ | é»˜è®¤å€¼ |
|------|------|------|--------|
| `value/name` | æŒ‡å®šå‚æ•°å | `@RequestParam("userId")` | å‚æ•°å˜é‡å |
| `required` | æ˜¯å¦å¿…éœ€ | `@RequestParam(required=false)` | `true` |
| `defaultValue` | é»˜è®¤å€¼ | `@RequestParam(defaultValue="1")` | æ—  |

**å®é™…åº”ç”¨ç¤ºä¾‹**ï¼š

```java
// âœ… å‚æ•°åä¸ä¸€è‡´æ—¶æŒ‡å®šæ˜ å°„
// è¯·æ±‚ï¼š/search?keyword=Java
@GetMapping("/search")
public String search(@RequestParam("keyword") String searchText) {
    return "æœç´¢ï¼š" + searchText;
}

// âœ… å¯é€‰å‚æ•°è®¾ç½®
// è¯·æ±‚ï¼š/list æˆ– /list?page=2 éƒ½å¯ä»¥
@GetMapping("/list")
public String list(@RequestParam(required = false, defaultValue = "1") Integer page) {
    return "ç¬¬ " + page + " é¡µ";
}

// âœ… å¤šä¸ªå‚æ•°ç»„åˆ
// è¯·æ±‚ï¼š/filter?status=active&sort=time
@GetMapping("/filter")
public String filter(
    @RequestParam String status,
    @RequestParam(defaultValue = "id") String sort
) {
    return "çŠ¶æ€ï¼š" + status + "ï¼Œæ’åºï¼š" + sort;
}
```

#### âš ï¸ å¸¸è§é—®é¢˜


**é—®é¢˜1ï¼šå‚æ•°ä¸å­˜åœ¨ä¼šæ€æ ·ï¼Ÿ**
```java
// required=trueï¼ˆé»˜è®¤ï¼‰ï¼Œå‚æ•°ä¸å­˜åœ¨ â†’ 400 é”™è¯¯
@RequestParam String name

// required=falseï¼Œå‚æ•°ä¸å­˜åœ¨ â†’ name = null
@RequestParam(required=false) String name

// æœ‰é»˜è®¤å€¼ï¼Œå‚æ•°ä¸å­˜åœ¨ â†’ name = "åŒ¿å"
@RequestParam(defaultValue="åŒ¿å") String name
```

**é—®é¢˜2ï¼šä»€ä¹ˆæ—¶å€™å¯ä»¥çœç•¥ @RequestParamï¼Ÿ**
```java
// ç®€å•ç±»å‹å‚æ•°ï¼Œä¸”å‚æ•°åä¸€è‡´æ—¶å¯çœç•¥
public String test(String name, Integer age) {
    // Spring ä¼šè‡ªåŠ¨å°è¯•ç»‘å®š
}

// âš ï¸ ä½†æœ€å¥½ä¸è¦çœç•¥ï¼Œæ˜ç¡®æ€§æ›´å¼º
```

---

### 2.2 @PathVariable - è·å–è·¯å¾„å˜é‡


**ä½œç”¨**ï¼šä» URL è·¯å¾„ä¸­è·å–å€¼

**é€‚ç”¨åœºæ™¯**ï¼šRESTful é£æ ¼çš„ URLï¼Œå¦‚ `/user/123`ã€`/order/2024/05`

#### ğŸ”¸ åŸºæœ¬ç”¨æ³•


```java
// è¯·æ±‚ï¼šGET /user/123
@GetMapping("/user/{id}")
public String getUser(@PathVariable Long id) {
    return "ç”¨æˆ·IDï¼š" + id;
}
```

**é€šä¿—ç†è§£**ï¼šURL è·¯å¾„é‡Œçš„ `{id}` å°±åƒä¸€ä¸ªå ä½ç¬¦ï¼Œå®é™…è¯·æ±‚æ—¶ `123` ä¼šè‡ªåŠ¨å¡«è¿›å»ï¼Œç„¶åç»‘å®šåˆ°æ–¹æ³•å‚æ•°

#### ğŸ”¸ RESTful é£æ ¼è®¾è®¡å¯¹æ¯”


```
ä¼ ç»Ÿé£æ ¼ URLï¼š
GET  /getUserById?id=123        æŸ¥è¯¢ç”¨æˆ·
POST /createUser                 åˆ›å»ºç”¨æˆ·
POST /updateUser?id=123         æ›´æ–°ç”¨æˆ·
POST /deleteUser?id=123         åˆ é™¤ç”¨æˆ·

RESTful é£æ ¼ URLï¼š
GET    /user/123                 æŸ¥è¯¢ç”¨æˆ·
POST   /user                     åˆ›å»ºç”¨æˆ·
PUT    /user/123                 æ›´æ–°ç”¨æˆ·
DELETE /user/123                 åˆ é™¤ç”¨æˆ·
```

#### ğŸ”¸ å¤šä¸ªè·¯å¾„å˜é‡


```java
// è¯·æ±‚ï¼šGET /order/2024/05/15
@GetMapping("/order/{year}/{month}/{day}")
public String getOrder(
    @PathVariable Integer year,
    @PathVariable Integer month,
    @PathVariable Integer day
) {
    return year + "å¹´" + month + "æœˆ" + day + "æ—¥è®¢å•";
}

// è¯·æ±‚ï¼šGET /user/123/posts/456
@GetMapping("/user/{userId}/posts/{postId}")
public String getUserPost(
    @PathVariable Long userId,
    @PathVariable Long postId
) {
    return "ç”¨æˆ·" + userId + "çš„å¸–å­" + postId;
}
```

#### ğŸ”¸ è·¯å¾„å˜é‡åä¸ä¸€è‡´


```java
// URL ä¸­æ˜¯ uidï¼Œä½†æ–¹æ³•å‚æ•°æƒ³ç”¨ userId
@GetMapping("/user/{uid}")
public String getUser(@PathVariable("uid") Long userId) {
    return "ç”¨æˆ·IDï¼š" + userId;
}
```

#### ğŸ’¡ @PathVariable vs @RequestParam


| å¯¹æ¯”é¡¹ | @PathVariable | @RequestParam |
|--------|---------------|---------------|
| **ä½ç½®** | URLè·¯å¾„ä¸­ `/user/123` | URLå‚æ•°ä¸­ `/user?id=123` |
| **é£æ ¼** | RESTfulé£æ ¼ | ä¼ ç»Ÿé£æ ¼ |
| **å¿…éœ€æ€§** | è·¯å¾„ä¸€éƒ¨åˆ†ï¼Œå¿…éœ€ | å¯é€‰ï¼Œå¯è®¾é»˜è®¤å€¼ |
| **é€‚ç”¨åœºæ™¯** | èµ„æºå®šä½ | æ¡ä»¶ç­›é€‰ã€åˆ†é¡µ |

**ä½¿ç”¨å»ºè®®**ï¼š
- ğŸ¯ **èµ„æºæ ‡è¯†**ç”¨ `@PathVariable`ï¼š`/user/123`ã€`/product/456`
- ğŸ¯ **æŸ¥è¯¢æ¡ä»¶**ç”¨ `@RequestParam`ï¼š`/list?page=1&size=10&sort=time`

---

### 2.3 @RequestHeader - è·å–è¯·æ±‚å¤´


**ä½œç”¨**ï¼šä» HTTP è¯·æ±‚å¤´ä¸­è·å–ä¿¡æ¯

**é€‚ç”¨åœºæ™¯**ï¼šéœ€è¦è·å–æµè§ˆå™¨ä¿¡æ¯ã€æˆæƒä»¤ç‰Œã€è‡ªå®šä¹‰å¤´ä¿¡æ¯ç­‰

#### ğŸ”¸ å¸¸è§è¯·æ±‚å¤´è·å–


```java
// è·å–ç”¨æˆ·ä»£ç†ä¿¡æ¯ï¼ˆæµè§ˆå™¨ç±»å‹ï¼‰
@GetMapping("/info")
public String getInfo(@RequestHeader("User-Agent") String userAgent) {
    return "æµè§ˆå™¨ï¼š" + userAgent;
}

// è·å–æˆæƒä»¤ç‰Œ
@GetMapping("/secure")
public String secure(@RequestHeader("Authorization") String token) {
    return "ä»¤ç‰Œï¼š" + token;
}

// å¯é€‰è¯·æ±‚å¤´
@GetMapping("/test")
public String test(
    @RequestHeader(value = "Custom-Header", required = false) String custom
) {
    return custom != null ? custom : "æ²¡æœ‰è‡ªå®šä¹‰å¤´";
}
```

#### ğŸ”¸ è¯·æ±‚å¤´è¯¦è§£


**å¸¸è§ HTTP è¯·æ±‚å¤´**ï¼š

| è¯·æ±‚å¤´ | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|--------|
| `User-Agent` | æµè§ˆå™¨æ ‡è¯† | `Mozilla/5.0 (Windows NT 10.0)...` |
| `Authorization` | æˆæƒä¿¡æ¯ | `Bearer eyJhbGci...` |
| `Content-Type` | å†…å®¹ç±»å‹ | `application/json` |
| `Accept` | å¯æ¥å—ç±»å‹ | `text/html` |
| `Cookie` | Cookieä¿¡æ¯ | `sessionId=abc123` |

#### ğŸ’¡ å®é™…åº”ç”¨åœºæ™¯


```java
// åœºæ™¯1ï¼šæ ¹æ®è®¾å¤‡ç±»å‹è¿”å›ä¸åŒé¡µé¢
@GetMapping("/home")
public String home(@RequestHeader("User-Agent") String ua) {
    if (ua.contains("Mobile")) {
        return "mobile-home";  // æ‰‹æœºé¡µé¢
    }
    return "pc-home";  // ç”µè„‘é¡µé¢
}

// åœºæ™¯2ï¼šAPI è®¤è¯
@GetMapping("/api/data")
public Result getData(@RequestHeader("Authorization") String token) {
    if (!tokenService.validate(token)) {
        throw new UnauthorizedException("æ— æ•ˆä»¤ç‰Œ");
    }
    return Result.success(data);
}
```

---

### 2.4 @CookieValue - è·å– Cookie


**ä½œç”¨**ï¼šä» Cookie ä¸­è·å–å€¼

**é€‚ç”¨åœºæ™¯**ï¼šè¯»å–ç”¨æˆ·åå¥½è®¾ç½®ã€ä¼šè¯æ ‡è¯†ç­‰

#### ğŸ”¸ åŸºæœ¬ç”¨æ³•


```java
// è·å– Cookie å€¼
@GetMapping("/preference")
public String getPreference(@CookieValue("theme") String theme) {
    return "ä¸»é¢˜è®¾ç½®ï¼š" + theme;
}

// å¯é€‰ Cookie
@GetMapping("/lang")
public String getLang(
    @CookieValue(value = "language", defaultValue = "zh-CN") String lang
) {
    return "è¯­è¨€ï¼š" + lang;
}
```

#### ğŸ”¸ Cookie ä¸ Session çš„å…³ç³»


```
æµè§ˆå™¨                          æœåŠ¡å™¨
   |                               |
   |--[1]é¦–æ¬¡è¯·æ±‚---------------->|
   |                               |
   |<-[2]è¿”å› Set-Cookie:JSESSIONID=xxx
   |                               |
   |--[3]åç»­è¯·æ±‚(å¸¦Cookie)------->|
   |   Cookie: JSESSIONID=xxx      |
   |                               |
   |<-[4]é€šè¿‡Cookieè¯†åˆ«ç”¨æˆ·--------|
```

**é€šä¿—è§£é‡Š**ï¼š
- **Cookie**ï¼šå­˜åœ¨æµè§ˆå™¨é‡Œçš„å°çº¸æ¡ï¼Œè®°å½•ä¸€äº›ä¿¡æ¯
- **Session**ï¼šæœåŠ¡å™¨ä¸Šçš„ä¼šè¯æ•°æ®ï¼Œé€šè¿‡ Cookie ä¸­çš„ SessionID å…³è”
- **@CookieValue**ï¼šä»å°çº¸æ¡ä¸Šè¯»å–ä¿¡æ¯

---

## 3. ğŸ”„ å‚æ•°ç±»å‹è½¬æ¢


### 3.1 è‡ªåŠ¨ç±»å‹è½¬æ¢æœºåˆ¶


**Spring MVC å†…ç½®è½¬æ¢å™¨**ï¼š

| æºç±»å‹ | ç›®æ ‡ç±»å‹ | ç¤ºä¾‹ |
|--------|---------|------|
| `String` | `Integer/Long` | `"123"` â†’ `123` |
| `String` | `Boolean` | `"true"` â†’ `true` |
| `String` | `Date` | `"2024-01-01"` â†’ `Dateå¯¹è±¡` |
| `String` | `Enum` | `"ACTIVE"` â†’ `Status.ACTIVE` |
| `String` | æ•°ç»„ | `"1,2,3"` â†’ `[1,2,3]` |

#### ğŸ”¸ åŸºæœ¬ç±»å‹è½¬æ¢


```java
// String â†’ Integer
@GetMapping("/age")
public String age(@RequestParam Integer age) {
    // è¯·æ±‚ï¼š/age?age=25
    // age è‡ªåŠ¨è½¬ä¸º Integer ç±»å‹
    return "å¹´é¾„ï¼š" + age;
}

// String â†’ Boolean
@GetMapping("/status")
public String status(@RequestParam Boolean active) {
    // è¯·æ±‚ï¼š/status?active=true
    // "true" / "false" / "1" / "0" éƒ½èƒ½è¯†åˆ«
    return active ? "æ¿€æ´»" : "æœªæ¿€æ´»";
}

// String â†’ Dateï¼ˆéœ€è¦é…ç½®æ ¼å¼ï¼‰
@GetMapping("/date")
public String date(
    @RequestParam 
    @DateTimeFormat(pattern = "yyyy-MM-dd") 
    Date birthday
) {
    // è¯·æ±‚ï¼š/date?birthday=2024-01-01
    return "ç”Ÿæ—¥ï¼š" + birthday;
}
```

#### ğŸ”¸ æ•°ç»„å’Œé›†åˆè½¬æ¢


```java
// æ¥æ”¶å¤šä¸ªåŒåå‚æ•°ä¸ºæ•°ç»„
// è¯·æ±‚ï¼š/tags?tag=Java&tag=Spring&tag=MySQL
@GetMapping("/tags")
public String tags(@RequestParam String[] tag) {
    return "æ ‡ç­¾ï¼š" + Arrays.toString(tag);
    // è¾“å‡ºï¼šæ ‡ç­¾ï¼š[Java, Spring, MySQL]
}

// æ¥æ”¶ä¸º List
@GetMapping("/ids")
public String ids(@RequestParam List<Long> id) {
    // è¯·æ±‚ï¼š/ids?id=1&id=2&id=3
    return "IDåˆ—è¡¨ï¼š" + id;
}
```

#### ğŸ”¸ å¯¹è±¡è‡ªåŠ¨ç»‘å®š


```java
// è¯·æ±‚å‚æ•°è‡ªåŠ¨ç»‘å®šåˆ°å¯¹è±¡
// è¯·æ±‚ï¼š/register?username=admin&password=123456&age=25
@PostMapping("/register")
public String register(User user) {
    // Spring è‡ªåŠ¨åˆ›å»º User å¯¹è±¡å¹¶è®¾ç½®å±æ€§
    // user.username = "admin"
    // user.password = "123456"
    // user.age = 25
    return "æ³¨å†Œç”¨æˆ·ï¼š" + user.getUsername();
}

// User ç±»
public class User {
    private String username;
    private String password;
    private Integer age;
    // getter å’Œ setter å¿…é¡»æœ‰
}
```

**å¯¹è±¡ç»‘å®šè§„åˆ™**ï¼š
- âœ… å‚æ•°åå¿…é¡»ä¸å¯¹è±¡å±æ€§åä¸€è‡´
- âœ… å¯¹è±¡å¿…é¡»æœ‰æ— å‚æ„é€ æ–¹æ³•
- âœ… å±æ€§å¿…é¡»æœ‰ setter æ–¹æ³•

### 3.2 è‡ªå®šä¹‰ç±»å‹è½¬æ¢å™¨


**ä¸ºä»€ä¹ˆéœ€è¦è‡ªå®šä¹‰è½¬æ¢å™¨**ï¼šSpring å†…ç½®è½¬æ¢å™¨ä¸èƒ½å¤„ç†æ‰€æœ‰æƒ…å†µ

#### ğŸ”¸ åˆ›å»ºè‡ªå®šä¹‰è½¬æ¢å™¨


```java
// åœºæ™¯ï¼šå°†å­—ç¬¦ä¸²è½¬ä¸ºè‡ªå®šä¹‰å¯¹è±¡
// è¯·æ±‚æ ¼å¼ï¼š/product?info=iPhone,9999,Apple

// 1. å®šä¹‰è½¬æ¢å™¨
public class StringToProductConverter implements Converter<String, Product> {
    
    @Override
    public Product convert(String source) {
        // source = "iPhone,9999,Apple"
        String[] parts = source.split(",");
        
        Product product = new Product();
        product.setName(parts[0]);
        product.setPrice(new BigDecimal(parts[1]));
        product.setBrand(parts[2]);
        
        return product;
    }
}

// 2. æ³¨å†Œè½¬æ¢å™¨
@Configuration
public class WebConfig implements WebMvcConfigurer {
    
    @Override
    public void addFormatters(FormatterRegistry registry) {
        registry.addConverter(new StringToProductConverter());
    }
}

// 3. ä½¿ç”¨è½¬æ¢å™¨
@GetMapping("/product")
public String product(@RequestParam Product info) {
    return "å•†å“ï¼š" + info.getName() + "ï¼Œä»·æ ¼ï¼š" + info.getPrice();
}
```

#### âš ï¸ ç±»å‹è½¬æ¢å¤±è´¥å¤„ç†


```java
// è½¬æ¢å¤±è´¥ä¼šæŠ›å‡ºå¼‚å¸¸
// è¯·æ±‚ï¼š/age?age=abc ï¼ˆabc æ— æ³•è½¬ä¸º Integerï¼‰

// å…¨å±€å¼‚å¸¸å¤„ç†
@ControllerAdvice
public class GlobalExceptionHandler {
    
    @ExceptionHandler(MethodArgumentTypeMismatchException.class)
    public ResponseEntity<String> handleTypeMismatch(
        MethodArgumentTypeMismatchException ex
    ) {
        String message = String.format(
            "å‚æ•° '%s' çš„å€¼ '%s' æ— æ³•è½¬æ¢ä¸º %s ç±»å‹",
            ex.getName(),
            ex.getValue(),
            ex.getRequiredType().getSimpleName()
        );
        return ResponseEntity.badRequest().body(message);
    }
}
```

---

## 4. âœ… æ•°æ®éªŒè¯æœºåˆ¶


### 4.1 ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®éªŒè¯


**é€šä¿—ç†è§£**ï¼šå°±åƒé—¨å«æ£€æŸ¥èº«ä»½è¯ï¼Œè¦ç¡®ä¿è¿›æ¥çš„æ•°æ®ç¬¦åˆè¦æ±‚

**éªŒè¯çš„å¿…è¦æ€§**ï¼š
- ğŸ”’ **å®‰å…¨æ€§**ï¼šé˜²æ­¢æ¶æ„æ•°æ®ï¼ˆSQLæ³¨å…¥ã€XSSæ”»å‡»ï¼‰
- âœ… **å®Œæ•´æ€§**ï¼šç¡®ä¿å¿…éœ€å­—æ®µä¸ä¸ºç©º
- ğŸ“ **è§„èŒƒæ€§**ï¼šç¡®ä¿æ•°æ®æ ¼å¼æ­£ç¡®ï¼ˆé‚®ç®±ã€æ‰‹æœºå·ï¼‰
- ğŸ’¼ **ä¸šåŠ¡æ€§**ï¼šç¬¦åˆä¸šåŠ¡è§„åˆ™ï¼ˆå¹´é¾„èŒƒå›´ã€ä»·æ ¼é™åˆ¶ï¼‰

### 4.2 JSR-303 éªŒè¯æ³¨è§£


**å¸¸ç”¨éªŒè¯æ³¨è§£**ï¼š

| æ³¨è§£ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `@NotNull` | ä¸èƒ½ä¸º null | `@NotNull String name` |
| `@NotEmpty` | ä¸èƒ½ä¸ºç©ºï¼ˆé•¿åº¦>0ï¼‰ | `@NotEmpty String email` |
| `@NotBlank` | ä¸èƒ½ä¸ºç©ºç™½ï¼ˆå»æ‰ç©ºæ ¼åé•¿åº¦>0ï¼‰ | `@NotBlank String username` |
| `@Size` | é•¿åº¦é™åˆ¶ | `@Size(min=6, max=20)` |
| `@Min/@Max` | æ•°å€¼èŒƒå›´ | `@Min(18) Integer age` |
| `@Email` | é‚®ç®±æ ¼å¼ | `@Email String email` |
| `@Pattern` | æ­£åˆ™åŒ¹é… | `@Pattern(regexp="^1[3-9]\\d{9}$")` |

#### ğŸ”¸ åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹


```java
// 1. åœ¨å®ä½“ç±»ä¸Šæ·»åŠ éªŒè¯æ³¨è§£
public class UserDTO {
    
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @Size(min = 3, max = 20, message = "ç”¨æˆ·åé•¿åº¦å¿…é¡»åœ¨3-20ä¹‹é—´")
    private String username;
    
    @NotBlank(message = "å¯†ç ä¸èƒ½ä¸ºç©º")
    @Size(min = 6, message = "å¯†ç è‡³å°‘6ä½")
    private String password;
    
    @Min(value = 18, message = "å¹´é¾„å¿…é¡»å¤§äº18å²")
    @Max(value = 100, message = "å¹´é¾„å¿…é¡»å°äº100å²")
    private Integer age;
    
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String email;
    
    @Pattern(regexp = "^1[3-9]\\d{9}$", message = "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®")
    private String phone;
    
    // getter å’Œ setter
}

// 2. åœ¨ Controller ä¸­ä½¿ç”¨ @Valid è§¦å‘éªŒè¯
@PostMapping("/register")
public Result register(@Valid @RequestBody UserDTO user, BindingResult result) {
    
    // å¦‚æœéªŒè¯å¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯ä¼šå­˜å…¥ BindingResult
    if (result.hasErrors()) {
        // è·å–ç¬¬ä¸€ä¸ªé”™è¯¯æ¶ˆæ¯
        String errorMsg = result.getFieldError().getDefaultMessage();
        return Result.error(errorMsg);
    }
    
    // éªŒè¯é€šè¿‡ï¼Œæ‰§è¡Œä¸šåŠ¡é€»è¾‘
    userService.register(user);
    return Result.success("æ³¨å†ŒæˆåŠŸ");
}
```

#### ğŸ”¸ @NotNull vs @NotEmpty vs @NotBlank


```java
// ä¸‰è€…åŒºåˆ«å¯¹æ¯”
public class Demo {
    
    @NotNull    // âœ… ä¸èƒ½æ˜¯ null    âŒ ä½†å¯ä»¥æ˜¯ ""
    private String field1;
    
    @NotEmpty   // âœ… ä¸èƒ½æ˜¯ null    âœ… ä¸èƒ½æ˜¯ ""    âŒ ä½†å¯ä»¥æ˜¯ "  "
    private String field2;
    
    @NotBlank   // âœ… ä¸èƒ½æ˜¯ null    âœ… ä¸èƒ½æ˜¯ ""    âœ… ä¸èƒ½æ˜¯ "  "ï¼ˆä¼štrimï¼‰
    private String field3;
}

// éªŒè¯ç»“æœå¯¹æ¯”ï¼š
String test1 = null;     // @NotNull âŒ  @NotEmpty âŒ  @NotBlank âŒ
String test2 = "";       // @NotNull âœ…  @NotEmpty âŒ  @NotBlank âŒ
String test3 = "  ";     // @NotNull âœ…  @NotEmpty âœ…  @NotBlank âŒ
String test4 = "abc";    // @NotNull âœ…  @NotEmpty âœ…  @NotBlank âœ…
```

**ä½¿ç”¨å»ºè®®**ï¼š
- ğŸ¯ å­—ç¬¦ä¸²é€šå¸¸ç”¨ `@NotBlank`ï¼ˆæœ€ä¸¥æ ¼ï¼‰
- ğŸ¯ é›†åˆç”¨ `@NotEmpty`
- ğŸ¯ å…¶ä»–å¯¹è±¡ç”¨ `@NotNull`

### 4.3 è‡ªå®šä¹‰éªŒè¯æ³¨è§£


**åœºæ™¯**ï¼šå†…ç½®æ³¨è§£æ— æ³•æ»¡è¶³ä¸šåŠ¡éœ€æ±‚æ—¶

#### ğŸ”¸ åˆ›å»ºè‡ªå®šä¹‰éªŒè¯


```java
// 1. å®šä¹‰æ³¨è§£
@Target({ElementType.FIELD})
@Retention(RetentionPolicy.RUNTIME)
@Constraint(validatedBy = IdCardValidator.class)
public @interface IdCard {
    
    String message() default "èº«ä»½è¯å·æ ¼å¼ä¸æ­£ç¡®";
    
    Class<?>[] groups() default {};
    
    Class<? extends Payload>[] payload() default {};
}

// 2. å®ç°éªŒè¯å™¨
public class IdCardValidator implements ConstraintValidator<IdCard, String> {
    
    @Override
    public boolean isValid(String value, ConstraintValidatorContext context) {
        if (value == null || value.isEmpty()) {
            return true;  // ç©ºå€¼ç”± @NotBlank å¤„ç†
        }
        
        // ç®€åŒ–çš„èº«ä»½è¯éªŒè¯é€»è¾‘
        if (value.length() != 18) {
            return false;
        }
        
        // å®é™…åº”è¯¥éªŒè¯ï¼šçœä»½ä»£ç ã€å‡ºç”Ÿæ—¥æœŸã€æ ¡éªŒç ç­‰
        return value.matches("^\\d{17}[0-9Xx]$");
    }
}

// 3. ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£
public class UserDTO {
    
    @NotBlank(message = "èº«ä»½è¯å·ä¸èƒ½ä¸ºç©º")
    @IdCard(message = "èº«ä»½è¯å·æ ¼å¼ä¸æ­£ç¡®")
    private String idCard;
}
```

### 4.4 åˆ†ç»„éªŒè¯


**åœºæ™¯**ï¼šåŒä¸€ä¸ªå¯¹è±¡åœ¨ä¸åŒåœºæ™¯ä¸‹éªŒè¯è§„åˆ™ä¸åŒ

```java
// 1. å®šä¹‰éªŒè¯åˆ†ç»„æ¥å£
public interface CreateGroup {}
public interface UpdateGroup {}

// 2. åœ¨å­—æ®µä¸ŠæŒ‡å®šåˆ†ç»„
public class UserDTO {
    
    // IDï¼šåˆ›å»ºæ—¶ä¸éœ€è¦ï¼Œæ›´æ–°æ—¶å¿…éœ€
    @NotNull(groups = UpdateGroup.class, message = "æ›´æ–°æ—¶IDä¸èƒ½ä¸ºç©º")
    private Long id;
    
    // ç”¨æˆ·åï¼šåˆ›å»ºå’Œæ›´æ–°éƒ½éœ€è¦
    @NotBlank(groups = {CreateGroup.class, UpdateGroup.class})
    private String username;
    
    // å¯†ç ï¼šåªåœ¨åˆ›å»ºæ—¶å¿…éœ€
    @NotBlank(groups = CreateGroup.class, message = "å¯†ç ä¸èƒ½ä¸ºç©º")
    private String password;
}

// 3. åœ¨ Controller ä¸­æŒ‡å®šéªŒè¯åˆ†ç»„
@PostMapping("/user")
public Result create(@Validated(CreateGroup.class) @RequestBody UserDTO user) {
    // åªéªŒè¯ CreateGroup ç»„çš„è§„åˆ™
    return Result.success();
}

@PutMapping("/user")
public Result update(@Validated(UpdateGroup.class) @RequestBody UserDTO user) {
    // åªéªŒè¯ UpdateGroup ç»„çš„è§„åˆ™
    return Result.success();
}
```

### 4.5 å…¨å±€éªŒè¯å¼‚å¸¸å¤„ç†


```java
@ControllerAdvice
public class ValidationExceptionHandler {
    
    // å¤„ç† @Valid éªŒè¯å¤±è´¥
    @ExceptionHandler(MethodArgumentNotValidException.class)
    public ResponseEntity<Map<String, String>> handleValidationException(
        MethodArgumentNotValidException ex
    ) {
        Map<String, String> errors = new HashMap<>();
        
        // è·å–æ‰€æœ‰éªŒè¯é”™è¯¯
        ex.getBindingResult().getFieldErrors().forEach(error -> {
            errors.put(error.getField(), error.getDefaultMessage());
        });
        
        return ResponseEntity.badRequest().body(errors);
    }
    
    // å¤„ç† @Validated éªŒè¯å¤±è´¥
    @ExceptionHandler(ConstraintViolationException.class)
    public ResponseEntity<List<String>> handleConstraintViolation(
        ConstraintViolationException ex
    ) {
        List<String> errors = ex.getConstraintViolations()
            .stream()
            .map(ConstraintViolation::getMessage)
            .collect(Collectors.toList());
            
        return ResponseEntity.badRequest().body(errors);
    }
}
```

---

## 5. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 5.1 å‚æ•°ç»‘å®šæ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ @RequestParamï¼šä» URL å‚æ•°è·å–å€¼ (?id=123)
ğŸ”¸ @PathVariableï¼šä» URL è·¯å¾„è·å–å€¼ (/user/123)
ğŸ”¸ @RequestHeaderï¼šä»è¯·æ±‚å¤´è·å–å€¼ (Authorization: Bearer xxx)
ğŸ”¸ @CookieValueï¼šä» Cookie è·å–å€¼ (theme=dark)
```

### 5.2 å¿…é¡»æŒæ¡çš„çŸ¥è¯†ç‚¹


**ğŸ”¹ å‚æ•°ç»‘å®šæœºåˆ¶**
- Spring MVC è‡ªåŠ¨å°†è¯·æ±‚æ•°æ®ç»‘å®šåˆ°æ–¹æ³•å‚æ•°
- æ”¯æŒåŸºæœ¬ç±»å‹ã€å¯¹è±¡ã€æ•°ç»„ã€é›†åˆç­‰
- é€šè¿‡æ³¨è§£ç²¾ç¡®æ§åˆ¶ç»‘å®šè§„åˆ™

**ğŸ”¹ ç±»å‹è½¬æ¢**
- å†…ç½®è½¬æ¢å™¨å¤„ç†å¸¸è§ç±»å‹è½¬æ¢
- å¯è‡ªå®šä¹‰è½¬æ¢å™¨å¤„ç†ç‰¹æ®Šéœ€æ±‚
- è½¬æ¢å¤±è´¥éœ€è¦å¼‚å¸¸å¤„ç†

**ğŸ”¹ æ•°æ®éªŒè¯**
- ä½¿ç”¨ JSR-303 æ³¨è§£è¿›è¡ŒéªŒè¯
- @Valid è§¦å‘éªŒè¯ï¼ŒBindingResult è·å–ç»“æœ
- æ”¯æŒè‡ªå®šä¹‰éªŒè¯æ³¨è§£å’Œåˆ†ç»„éªŒè¯

### 5.3 å®é™…å¼€å‘å»ºè®®


**âœ… æœ€ä½³å®è·µ**ï¼š
1. **å‚æ•°ç»‘å®š**ï¼šä¼˜å…ˆä½¿ç”¨ @RequestParam å’Œ @PathVariableï¼Œæ˜ç¡®å‚æ•°æ¥æº
2. **RESTful è®¾è®¡**ï¼šèµ„æºæ ‡è¯†ç”¨è·¯å¾„å‚æ•°ï¼ŒæŸ¥è¯¢æ¡ä»¶ç”¨è¯·æ±‚å‚æ•°
3. **æ•°æ®éªŒè¯**ï¼šå‰ç«¯éªŒè¯+åç«¯éªŒè¯ï¼ŒåŒé‡ä¿éšœ
4. **å¼‚å¸¸å¤„ç†**ï¼šç»Ÿä¸€å¤„ç†éªŒè¯å¼‚å¸¸ï¼Œè¿”å›å‹å¥½é”™è¯¯ä¿¡æ¯
5. **DTO è®¾è®¡**ï¼šä½¿ç”¨ä¸“é—¨çš„ DTO ç±»æ¥æ”¶å‚æ•°ï¼Œä¸è¦ç›´æ¥ç”¨å®ä½“ç±»

**âš ï¸ æ³¨æ„äº‹é¡¹**ï¼š
- required=true æ—¶å‚æ•°ä¸å­˜åœ¨ä¼šæŠ¥é”™ï¼Œå»ºè®®è®¾ç½® defaultValue
- @PathVariable çš„å‚æ•°æ˜¯ URL ä¸€éƒ¨åˆ†ï¼Œæ— æ³•è®¾ç½® required=false
- å¯¹è±¡ç»‘å®šæ—¶å¿…é¡»æœ‰ setter æ–¹æ³•
- éªŒè¯æ³¨è§£è¦åŠ åœ¨å­—æ®µä¸Šï¼Œ@Valid è¦åŠ åœ¨å‚æ•°ä¸Š

**ğŸ¯ è®°å¿†å£è¯€**ï¼š
```
å‚æ•°ç»‘å®šå››å¤§å°†ï¼Œ
RequestParam é—®å·åé¢è—ï¼Œ
PathVariable è·¯å¾„ä¸­å¤®ï¼Œ
RequestHeader å¤´é‡Œæ‰¾ï¼Œ
CookieValue Cookie ä¸Šã€‚

éªŒè¯æ³¨è§£åˆ«å¿˜åŠ ï¼Œ
NotBlank æœ€ä¸¥æ ¼ï¼Œ
Valid è§¦å‘éªŒè¯æŸ¥ï¼Œ
BindingResult é”™è¯¯æ‹¿ã€‚
```