---
title: 4ã€è¯·æ±‚æ¡ä»¶é™å®šä¸è¿‡æ»¤
---
## ğŸ“š ç›®å½•

1. [è¯·æ±‚æ¡ä»¶é™å®šæ¦‚è¿°](#1-è¯·æ±‚æ¡ä»¶é™å®šæ¦‚è¿°)
2. [è¯·æ±‚æ–¹æ³•é™å®š](#2-è¯·æ±‚æ–¹æ³•é™å®š)
3. [è¯·æ±‚å¤´æ¡ä»¶é™å®š](#3-è¯·æ±‚å¤´æ¡ä»¶é™å®š)
4. [è¯·æ±‚å‚æ•°æ¡ä»¶é™å®š](#4-è¯·æ±‚å‚æ•°æ¡ä»¶é™å®š)
5. [Content-Typeé™å®šï¼ˆconsumesï¼‰](#5-content-typeé™å®šconsumes)
6. [Accepté™å®šï¼ˆproducesï¼‰](#6-accepté™å®šproduces)
7. [ç»¼åˆåº”ç”¨ä¸æœ€ä½³å®è·µ](#7-ç»¼åˆåº”ç”¨ä¸æœ€ä½³å®è·µ)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ è¯·æ±‚æ¡ä»¶é™å®šæ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯è¯·æ±‚æ¡ä»¶é™å®š


**é€šä¿—ç†è§£**ï¼š
æƒ³è±¡ä½ å¼€äº†ä¸€å®¶é¤å…ï¼Œä¸æ˜¯æ‰€æœ‰é¡¾å®¢çš„æ‰€æœ‰è¦æ±‚ä½ éƒ½èƒ½æ»¡è¶³ã€‚æ¯”å¦‚ï¼š
- æœ‰çš„é¡¾å®¢åªèƒ½ä¸­åˆæ¥ï¼ˆ**æ—¶é—´é™åˆ¶**ï¼‰
- æœ‰çš„é¡¾å®¢è¦åƒç´ é£Ÿï¼ˆ**èœå“ç±»å‹é™åˆ¶**ï¼‰  
- æœ‰çš„é¡¾å®¢è¦æ±‚æ‰“åŒ…å¸¦èµ°ï¼ˆ**æœåŠ¡æ–¹å¼é™åˆ¶**ï¼‰

Spring MVC çš„è¯·æ±‚æ¡ä»¶é™å®šå°±æ˜¯è¿™ä¸ªé“ç† â€”â€” **è®©ä½ çš„æ§åˆ¶å™¨æ–¹æ³•åªå¤„ç†ç¬¦åˆç‰¹å®šæ¡ä»¶çš„è¯·æ±‚**ã€‚

```
å‰ç«¯å‘é€è¯·æ±‚ â†’ Spring MVCæ£€æŸ¥æ¡ä»¶ â†’ ç¬¦åˆæ¡ä»¶ï¼Ÿ
                                      â†“
                            YES: æ‰§è¡Œå¯¹åº”æ–¹æ³•
                            NO:  è¿”å›404æˆ–405é”™è¯¯
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦è¯·æ±‚æ¡ä»¶é™å®š


**å®é™…åœºæ™¯ç†è§£**ï¼š

```java
// ä¸åŠ é™å®šçš„é—®é¢˜ï¼šæ‰€æœ‰è¯·æ±‚éƒ½ä¼šè¿›æ¥
@RequestMapping("/user")
public String handleUser() {
    // GETè¯·æ±‚è¦æŸ¥è¯¢ç”¨æˆ·
    // POSTè¯·æ±‚è¦åˆ›å»ºç”¨æˆ·
    // DELETEè¯·æ±‚è¦åˆ é™¤ç”¨æˆ·
    // å…¨æ··åœ¨ä¸€èµ·ï¼Œå¾ˆéš¾å¤„ç†ï¼
}

// åŠ é™å®šåï¼šæ¸…æ™°æ˜ç¡®
@GetMapping("/user")     // åªå¤„ç†æŸ¥è¯¢
@PostMapping("/user")    // åªå¤„ç†åˆ›å»º
@DeleteMapping("/user")  // åªå¤„ç†åˆ é™¤
```

**æ ¸å¿ƒä»·å€¼**ï¼š
- âœ… **èŒè´£æ¸…æ™°**ï¼šä¸€ä¸ªæ–¹æ³•åªå¹²ä¸€ä»¶äº‹
- âœ… **é¿å…æ··ä¹±**ï¼šä¸åŒæ“ä½œåˆ†å¼€å¤„ç†
- âœ… **ç¬¦åˆè§„èŒƒ**ï¼šéµå¾ªRESTfulè®¾è®¡é£æ ¼
- âœ… **æé«˜å®‰å…¨**ï¼šé™åˆ¶éæ³•è¯·æ±‚

### 1.3 è¯·æ±‚æ¡ä»¶çš„åˆ†ç±»


```
è¯·æ±‚æ¡ä»¶é™å®šçš„å…­å¤§ç»´åº¦ï¼š

1. è¯·æ±‚æ–¹æ³• (method)      â†’ GETã€POSTã€PUTã€DELETEç­‰
2. è¯·æ±‚å¤´ (headers)       â†’ å¿…é¡»åŒ…å«æŸäº›è¯·æ±‚å¤´
3. è¯·æ±‚å‚æ•° (params)      â†’ å¿…é¡»åŒ…å«æŸäº›å‚æ•°
4. Content-Type (consumes) â†’ è¯·æ±‚ä½“çš„æ•°æ®æ ¼å¼
5. Accept (produces)      â†’ å“åº”ä½“çš„æ•°æ®æ ¼å¼
6. è·¯å¾„å‚æ•° (path)        â†’ URLä¸­çš„åŠ¨æ€å‚æ•°
```

---

## 2. ğŸ”„ è¯·æ±‚æ–¹æ³•é™å®š


### 2.1 ä»€ä¹ˆæ˜¯è¯·æ±‚æ–¹æ³•


**ç”Ÿæ´»ç±»æ¯”**ï¼š
å°±åƒä½ ç»™åˆ«äººå‘æ¶ˆæ¯ï¼Œå¯ä»¥é€‰æ‹©ä¸åŒçš„æ–¹å¼ï¼š
- **æ‰“ç”µè¯**ï¼ˆGETï¼‰ï¼šé—®é—®é¢˜ã€è·å–ä¿¡æ¯
- **å‘é‚®ä»¶**ï¼ˆPOSTï¼‰ï¼šæäº¤èµ„æ–™ã€åˆ›å»ºå†…å®¹
- **å‘çŸ­ä¿¡ä¿®æ”¹é€šçŸ¥**ï¼ˆPUTï¼‰ï¼šæ›´æ–°ä¿¡æ¯
- **æ’•æ‰ä¾¿ç­¾**ï¼ˆDELETEï¼‰ï¼šåˆ é™¤å†…å®¹

HTTPè¯·æ±‚æ–¹æ³•å°±æ˜¯å‘Šè¯‰æœåŠ¡å™¨ï¼š**æˆ‘æƒ³åšä»€ä¹ˆæ“ä½œ**ã€‚

### 2.2 å¸¸ç”¨è¯·æ±‚æ–¹æ³•è¯¦è§£


| è¯·æ±‚æ–¹æ³• | ä½œç”¨è¯´æ˜ | ç”Ÿæ´»ç±»æ¯” | æ˜¯å¦å¹‚ç­‰ |
|---------|---------|---------|---------|
| **GET** | `è·å–èµ„æº` | çœ‹ä¹¦ï¼ˆä¸æ”¹å˜å†…å®¹ï¼‰ | âœ… æ˜¯ |
| **POST** | `åˆ›å»ºèµ„æº` | å†™æ–°æ—¥è®° | âŒ å¦ |
| **PUT** | `å®Œæ•´æ›´æ–°èµ„æº` | é‡å†™æ•´ç¯‡æ—¥è®° | âœ… æ˜¯ |
| **PATCH** | `éƒ¨åˆ†æ›´æ–°èµ„æº` | ä¿®æ”¹æ—¥è®°ä¸­çš„ä¸€æ®µ | âŒ å¦ |
| **DELETE** | `åˆ é™¤èµ„æº` | æ’•æ‰æ—¥è®°é¡µ | âœ… æ˜¯ |

**å¹‚ç­‰æ€§è§£é‡Š**ï¼šå¤šæ¬¡æ‰§è¡ŒåŒæ ·çš„æ“ä½œï¼Œç»“æœä¸€æ ·
- GETæŸ¥è¯¢10æ¬¡ = æŸ¥è¯¢1æ¬¡ï¼ˆç»“æœç›¸åŒï¼‰âœ…
- POSTåˆ›å»º10æ¬¡ = åˆ›å»º10æ¡è®°å½•ï¼ˆç»“æœä¸åŒï¼‰âŒ

### 2.3 æ–¹æ³•é™å®šçš„ä¸‰ç§å†™æ³•


**æ–¹å¼ä¸€ï¼šä½¿ç”¨ method å±æ€§**
```java
@RequestMapping(value = "/user", method = RequestMethod.GET)
public String getUser() {
    return "æŸ¥è¯¢ç”¨æˆ·";
}

@RequestMapping(value = "/user", method = RequestMethod.POST)
public String createUser() {
    return "åˆ›å»ºç”¨æˆ·";
}
```

**æ–¹å¼äºŒï¼šä½¿ç”¨ç»„åˆæ³¨è§£ï¼ˆæ¨èï¼‰**
```java
@GetMapping("/user")     // ç­‰ä»·äº @RequestMapping(method = GET)
public String getUser() {
    return "æŸ¥è¯¢ç”¨æˆ·";
}

@PostMapping("/user")    // ç­‰ä»·äº @RequestMapping(method = POST)
public String createUser() {
    return "åˆ›å»ºç”¨æˆ·";
}

@PutMapping("/user")     // æ›´æ–°
@DeleteMapping("/user")  // åˆ é™¤
@PatchMapping("/user")   // éƒ¨åˆ†æ›´æ–°
```

**æ–¹å¼ä¸‰ï¼šé™å®šå¤šä¸ªæ–¹æ³•**
```java
// åŒæ—¶æ¥å— GET å’Œ POST è¯·æ±‚
@RequestMapping(value = "/user", 
    method = {RequestMethod.GET, RequestMethod.POST})
public String handleUser() {
    return "å¤„ç†ç”¨æˆ·è¯·æ±‚";
}
```

### 2.4 å®é™…åº”ç”¨ç¤ºä¾‹


**RESTfulé£æ ¼çš„ç”¨æˆ·ç®¡ç†**ï¼š
```java
@RestController
@RequestMapping("/users")
public class UserController {
    
    // æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·ï¼šGET /users
    @GetMapping
    public List<User> listUsers() {
        return userService.findAll();
    }
    
    // æŸ¥è¯¢å•ä¸ªç”¨æˆ·ï¼šGET /users/1
    @GetMapping("/{id}")
    public User getUser(@PathVariable Long id) {
        return userService.findById(id);
    }
    
    // åˆ›å»ºç”¨æˆ·ï¼šPOST /users
    @PostMapping
    public User createUser(@RequestBody User user) {
        return userService.save(user);
    }
    
    // æ›´æ–°ç”¨æˆ·ï¼šPUT /users/1
    @PutMapping("/{id}")
    public User updateUser(@PathVariable Long id, @RequestBody User user) {
        return userService.update(id, user);
    }
    
    // åˆ é™¤ç”¨æˆ·ï¼šDELETE /users/1
    @DeleteMapping("/{id}")
    public void deleteUser(@PathVariable Long id) {
        userService.delete(id);
    }
}
```

**è¯·æ±‚å¤„ç†æµç¨‹**ï¼š
```
å®¢æˆ·ç«¯è¯·æ±‚: DELETE /users/123
           â†“
Spring MVC: æ£€æŸ¥è¯·æ±‚æ–¹æ³•æ˜¯DELETE âœ“
           â†“
Spring MVC: åŒ¹é…åˆ° deleteUser() æ–¹æ³•
           â†“
æ‰§è¡Œåˆ é™¤æ“ä½œ: userService.delete(123)
```

### 2.5 æ–¹æ³•ä¸åŒ¹é…çš„é”™è¯¯å¤„ç†


**é”™è¯¯ç¤ºä¾‹**ï¼š
```java
@GetMapping("/user")
public String getUser() {
    return "æŸ¥è¯¢";
}

// å¦‚æœç”¨POSTè¯·æ±‚è®¿é—® /user
// ç»“æœï¼šHTTP 405 Method Not Allowed
```

**å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
```javascript
// æ­£ç¡®è°ƒç”¨
fetch('/user', { method: 'GET' })  // âœ… æˆåŠŸ

// é”™è¯¯è°ƒç”¨
fetch('/user', { method: 'POST' }) // âŒ 405é”™è¯¯
```

---

## 3. ğŸ“‹ è¯·æ±‚å¤´æ¡ä»¶é™å®š


### 3.1 ä»€ä¹ˆæ˜¯è¯·æ±‚å¤´


**é€šä¿—è§£é‡Š**ï¼š
è¯·æ±‚å¤´å°±åƒæ˜¯**ä¿¡å°ä¸Šçš„å¤‡æ³¨ä¿¡æ¯**ï¼š
- æ”¶ä»¶äººåœ°å€ï¼ˆHostï¼‰
- å¯„ä»¶äººä¿¡æ¯ï¼ˆUser-Agentï¼‰
- ä¿¡ä»¶ç±»å‹ï¼ˆContent-Typeï¼‰
- é‡è¦ç¨‹åº¦ï¼ˆPriorityï¼‰

```
HTTPè¯·æ±‚ç»“æ„ï¼š
GET /user HTTP/1.1              â† è¯·æ±‚è¡Œ
Host: example.com               â† è¯·æ±‚å¤´
Content-Type: application/json  â† è¯·æ±‚å¤´
Authorization: Bearer xxx       â† è¯·æ±‚å¤´
                                â† ç©ºè¡Œ
{"name": "å¼ ä¸‰"}                â† è¯·æ±‚ä½“
```

### 3.2 è¯·æ±‚å¤´é™å®šè¯­æ³•


**åŸºæœ¬ç”¨æ³•**ï¼š
```java
// å¿…é¡»åŒ…å« X-Custom-Header è¯·æ±‚å¤´
@GetMapping(value = "/api/data", 
    headers = "X-Custom-Header")
public String getData() {
    return "éœ€è¦è‡ªå®šä¹‰è¯·æ±‚å¤´";
}

// è¯·æ±‚å¤´å¿…é¡»ç­‰äºç‰¹å®šå€¼
@GetMapping(value = "/api/data", 
    headers = "X-API-Version=2.0")
public String getDataV2() {
    return "APIç‰ˆæœ¬2.0çš„æ•°æ®";
}

// è¯·æ±‚å¤´ä¸èƒ½ç­‰äºæŸå€¼
@GetMapping(value = "/api/data", 
    headers = "X-Debug!=true")
public String getNormalData() {
    return "éè°ƒè¯•æ¨¡å¼æ•°æ®";
}
```

### 3.3 å¸¸è§è¯·æ±‚å¤´é™å®šåœºæ™¯


**åœºæ™¯ä¸€ï¼šAPIç‰ˆæœ¬æ§åˆ¶**
```java
@RestController
@RequestMapping("/api")
public class ApiController {
    
    // æ—§ç‰ˆæœ¬APIï¼šè¦æ±‚ç‰ˆæœ¬å¤´ä¸º1.0
    @GetMapping(value = "/users", headers = "API-Version=1.0")
    public List<UserV1> getUsersV1() {
        return userService.findAllV1();
    }
    
    // æ–°ç‰ˆæœ¬APIï¼šè¦æ±‚ç‰ˆæœ¬å¤´ä¸º2.0
    @GetMapping(value = "/users", headers = "API-Version=2.0")
    public List<UserV2> getUsersV2() {
        return userService.findAllV2();
    }
}
```

**å‰ç«¯è°ƒç”¨**ï¼š
```javascript
// è°ƒç”¨æ—§ç‰ˆAPI
fetch('/api/users', {
    headers: { 'API-Version': '1.0' }
})

// è°ƒç”¨æ–°ç‰ˆAPI
fetch('/api/users', {
    headers: { 'API-Version': '2.0' }
})
```

**åœºæ™¯äºŒï¼šç§»åŠ¨ç«¯ä¸Webç«¯åŒºåˆ†**
```java
// åªå¤„ç†æ¥è‡ªç§»åŠ¨ç«¯çš„è¯·æ±‚
@GetMapping(value = "/data", 
    headers = "X-Platform=mobile")
public MobileResponse getMobileData() {
    return new MobileResponse("ç§»åŠ¨ç«¯ä¼˜åŒ–æ•°æ®");
}

// åªå¤„ç†æ¥è‡ªWebç«¯çš„è¯·æ±‚
@GetMapping(value = "/data", 
    headers = "X-Platform=web")
public WebResponse getWebData() {
    return new WebResponse("Webç«¯å®Œæ•´æ•°æ®");
}
```

**åœºæ™¯ä¸‰ï¼šè°ƒè¯•æ¨¡å¼æ§åˆ¶**
```java
// ç”Ÿäº§æ¨¡å¼ï¼šä¸èƒ½æœ‰è°ƒè¯•å¤´
@GetMapping(value = "/secure", 
    headers = "!X-Debug-Mode")
public String getSecureData() {
    return "ç”Ÿäº§ç¯å¢ƒæ•°æ®";
}

// è°ƒè¯•æ¨¡å¼ï¼šå¿…é¡»æœ‰è°ƒè¯•å¤´
@GetMapping(value = "/debug", 
    headers = "X-Debug-Mode=true")
public String getDebugInfo() {
    return "è°ƒè¯•ä¿¡æ¯ï¼ˆä»…å¼€å‘ç¯å¢ƒï¼‰";
}
```

### 3.4 å¤šä¸ªè¯·æ±‚å¤´æ¡ä»¶


**ç»„åˆä½¿ç”¨**ï¼š
```java
// å¿…é¡»åŒæ—¶æ»¡è¶³å¤šä¸ªè¯·æ±‚å¤´æ¡ä»¶
@PostMapping(value = "/vip/action", 
    headers = {
        "X-User-Level=VIP",      // å¿…é¡»æ˜¯VIPç”¨æˆ·
        "X-Auth-Token",          // å¿…é¡»æœ‰è®¤è¯ä»¤ç‰Œ
        "X-API-Version=2.0"      // å¿…é¡»æ˜¯2.0ç‰ˆæœ¬
    })
public String vipAction() {
    return "VIPä¸“å±åŠŸèƒ½";
}
```

**è¯·æ±‚å¤´æ£€æŸ¥æµç¨‹**ï¼š
```
æ¥æ”¶è¯·æ±‚ â†’ æ£€æŸ¥X-User-Level=VIP? 
          â†“
       æ£€æŸ¥X-Auth-Tokenå­˜åœ¨?
          â†“
       æ£€æŸ¥X-API-Version=2.0?
          â†“
    å…¨éƒ¨æ»¡è¶³ â†’ æ‰§è¡Œæ–¹æ³•
    ä»»ä¸€ä¸æ»¡è¶³ â†’ è¿”å›404
```

---

## 4. ğŸ” è¯·æ±‚å‚æ•°æ¡ä»¶é™å®š


### 4.1 ä»€ä¹ˆæ˜¯è¯·æ±‚å‚æ•°


**ç”Ÿæ´»ç±»æ¯”**ï¼š
å°±åƒä½ åœ¨ç½‘ä¸Šè´­ç‰©æ—¶çš„ç­›é€‰æ¡ä»¶ï¼š
- ä»·æ ¼èŒƒå›´ï¼š`price=100-500`
- å“ç‰Œï¼š`brand=Apple`
- æ˜¯å¦åŒ…é‚®ï¼š`freeShipping=true`

```
URLä¸­çš„å‚æ•°ç¤ºä¾‹ï¼š
https://shop.com/products?category=phone&price=3000&brand=Apple
                         â†‘
                    è¿™äº›å°±æ˜¯è¯·æ±‚å‚æ•°
```

### 4.2 å‚æ•°é™å®šè¯­æ³•è¯¦è§£


**åŸºæœ¬è¯­æ³•**ï¼š
```java
// å¿…é¡»åŒ…å«æŸä¸ªå‚æ•°ï¼ˆä¸ç®¡å€¼æ˜¯ä»€ä¹ˆï¼‰
@GetMapping(value = "/search", params = "keyword")

// å‚æ•°å¿…é¡»ç­‰äºç‰¹å®šå€¼
@GetMapping(value = "/search", params = "type=advanced")

// å‚æ•°ä¸èƒ½ç­‰äºæŸä¸ªå€¼
@GetMapping(value = "/search", params = "safe!=false")

// å‚æ•°å¿…é¡»ä¸å­˜åœ¨
@GetMapping(value = "/search", params = "!debug")
```

### 4.3 å®é™…åº”ç”¨åœºæ™¯


**åœºæ™¯ä¸€ï¼šæœç´¢åŠŸèƒ½çš„åŒºåˆ†**
```java
@Controller
@RequestMapping("/search")
public class SearchController {
    
    // æ™®é€šæœç´¢ï¼šåªéœ€è¦å…³é”®è¯
    @GetMapping(params = "keyword")
    public String simpleSearch(@RequestParam String keyword) {
        // æ‰§è¡Œç®€å•æœç´¢
        return "searchResult";
    }
    
    // é«˜çº§æœç´¢ï¼šéœ€è¦type=advancedå‚æ•°
    @GetMapping(params = {"keyword", "type=advanced"})
    public String advancedSearch(
        @RequestParam String keyword,
        @RequestParam String category,
        @RequestParam String priceRange) {
        // æ‰§è¡Œé«˜çº§æœç´¢
        return "advancedSearchResult";
    }
}
```

**URLå¯¹æ¯”**ï¼š
```
æ™®é€šæœç´¢ï¼š/search?keyword=æ‰‹æœº
         â†“
         è°ƒç”¨ simpleSearch()

é«˜çº§æœç´¢ï¼š/search?keyword=æ‰‹æœº&type=advanced&category=ç”µå­&priceRange=1000-5000
         â†“
         è°ƒç”¨ advancedSearch()
```

**åœºæ™¯äºŒï¼šåˆ†é¡µä¸æ’åº**
```java
// é»˜è®¤åˆ—è¡¨ï¼šä¸å¸¦æ’åºå‚æ•°
@GetMapping(value = "/products", params = "!sort")
public List<Product> getDefaultList() {
    return productService.findAll(); // é»˜è®¤æ’åº
}

// ä»·æ ¼æ’åºï¼šå¸¦sort=priceå‚æ•°
@GetMapping(value = "/products", params = "sort=price")
public List<Product> getPriceSortedList() {
    return productService.findAllOrderByPrice();
}

// é”€é‡æ’åºï¼šå¸¦sort=saleså‚æ•°
@GetMapping(value = "/products", params = "sort=sales")
public List<Product> getSalesSortedList() {
    return productService.findAllOrderBySales();
}
```

**åœºæ™¯ä¸‰ï¼šåŠŸèƒ½å¼€å…³æ§åˆ¶**
```java
// ç”Ÿäº§ç¯å¢ƒï¼šä¸å…è®¸debugå‚æ•°
@GetMapping(value = "/data", params = "!debug")
public Data getNormalData() {
    return dataService.getData();
}

// è°ƒè¯•ç¯å¢ƒï¼šéœ€è¦debug=trueå‚æ•°
@GetMapping(value = "/data", params = "debug=true")
public DetailedData getDebugData() {
    return dataService.getDetailedData(); // è¿”å›è¯¦ç»†è°ƒè¯•ä¿¡æ¯
}
```

### 4.4 å‚æ•°æ¡ä»¶ç»„åˆ


**å¤æ‚æ¡ä»¶ç¤ºä¾‹**ï¼š
```java
@GetMapping(value = "/report", 
    params = {
        "year",              // å¿…é¡»æœ‰yearå‚æ•°
        "month",             // å¿…é¡»æœ‰monthå‚æ•°
        "format=pdf",        // formatå¿…é¡»æ˜¯pdf
        "!draft"             // ä¸èƒ½æœ‰draftå‚æ•°ï¼ˆæ­£å¼ç‰ˆï¼‰
    })
public ResponseEntity<byte[]> generateReport(
    @RequestParam int year,
    @RequestParam int month) {
    // ç”ŸæˆPDFæ ¼å¼çš„æ­£å¼æŠ¥è¡¨
    return reportService.generatePDF(year, month);
}
```

**å‚æ•°æ£€æŸ¥æµç¨‹**ï¼š
```
è¯·æ±‚: /report?year=2024&month=9&format=pdf
      â†“
æ£€æŸ¥: yearå­˜åœ¨? âœ“
      monthå­˜åœ¨? âœ“
      format=pdf? âœ“
      draftä¸å­˜åœ¨? âœ“
      â†“
æ‰§è¡Œ: generateReport(2024, 9)
```

### 4.5 å‚æ•°é™å®š vs å‚æ•°æ ¡éªŒ


**åŒºåˆ«ç†è§£**ï¼š
```java
// paramsé™å®šï¼šå†³å®šæ˜¯å¦åŒ¹é…è¿™ä¸ªæ–¹æ³•
@GetMapping(value = "/user", params = "id")
public User getUser(@RequestParam Long id) {
    // å¦‚æœURLä¸­æ²¡æœ‰idå‚æ•°ï¼Œè¿™ä¸ªæ–¹æ³•æ ¹æœ¬ä¸ä¼šè¢«è°ƒç”¨ï¼ˆ404é”™è¯¯ï¼‰
    return userService.findById(id);
}

// å‚æ•°æ ¡éªŒï¼šæ–¹æ³•å·²åŒ¹é…ï¼Œæ£€æŸ¥å‚æ•°å€¼æ˜¯å¦åˆæ³•
@GetMapping("/user")
public User getUser(@RequestParam @Min(1) Long id) {
    // idå‚æ•°å­˜åœ¨ï¼Œä½†å€¼å°äº1æ—¶ä¼šæŠ›å‡ºæ ¡éªŒå¼‚å¸¸ï¼ˆ400é”™è¯¯ï¼‰
    return userService.findById(id);
}
```

---

## 5. ğŸ“¤ Content-Typeé™å®šï¼ˆconsumesï¼‰


### 5.1 ä»€ä¹ˆæ˜¯Content-Type


**é€šä¿—ç†è§£**ï¼š
Content-Typeå°±æ˜¯å‘Šè¯‰æœåŠ¡å™¨ï¼š**æˆ‘å‘ç»™ä½ çš„æ•°æ®æ˜¯ä»€ä¹ˆæ ¼å¼çš„**

ç”Ÿæ´»ç±»æ¯”ï¼š
- å‘é‚®ä»¶é™„ä»¶ï¼šè¿™æ˜¯Wordæ–‡æ¡£ã€PDFæ–‡æ¡£ã€è¿˜æ˜¯å›¾ç‰‡ï¼Ÿ
- å¯„å¿«é€’ï¼šè¿™æ˜¯æ˜“ç¢å“ã€é£Ÿå“ã€è¿˜æ˜¯è¡£æœï¼Ÿ

```
è¯·æ±‚ç¤ºä¾‹ï¼š
POST /api/user HTTP/1.1
Content-Type: application/json    â† å‘Šè¯‰æœåŠ¡å™¨ï¼šæˆ‘å‘çš„æ˜¯JSONæ ¼å¼

{"name": "å¼ ä¸‰", "age": 25}
```

### 5.2 consumeså±æ€§è¯¦è§£


**åŸºæœ¬ç”¨æ³•**ï¼š
```java
// åªæ¥æ”¶JSONæ ¼å¼çš„è¯·æ±‚
@PostMapping(value = "/user", 
    consumes = "application/json")
public User createUser(@RequestBody User user) {
    return userService.save(user);
}

// åªæ¥æ”¶è¡¨å•æ ¼å¼çš„è¯·æ±‚
@PostMapping(value = "/user", 
    consumes = "application/x-www-form-urlencoded")
public User createUserFromForm(User user) {
    return userService.save(user);
}

// åªæ¥æ”¶XMLæ ¼å¼çš„è¯·æ±‚
@PostMapping(value = "/user", 
    consumes = "application/xml")
public User createUserFromXml(@RequestBody User user) {
    return userService.save(user);
}
```

### 5.3 å¸¸è§Content-Typeç±»å‹


| Content-Type | è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|-------------|------|---------|
| `application/json` | JSONæ ¼å¼ | å‰åç«¯åˆ†ç¦»ã€APIæ¥å£ |
| `application/x-www-form-urlencoded` | è¡¨å•æ ¼å¼ | ä¼ ç»Ÿè¡¨å•æäº¤ |
| `multipart/form-data` | å¤šéƒ¨åˆ†è¡¨å• | æ–‡ä»¶ä¸Šä¼  |
| `application/xml` | XMLæ ¼å¼ | é…ç½®æ–‡ä»¶ã€æ—§ç³»ç»Ÿå¯¹æ¥ |
| `text/plain` | çº¯æ–‡æœ¬ | ç®€å•æ–‡æœ¬ä¼ è¾“ |

### 5.4 å®é™…åº”ç”¨åœºæ™¯


**åœºæ™¯ä¸€ï¼šåŒä¸€æ¥å£æ”¯æŒå¤šç§æ ¼å¼**
```java
@RestController
@RequestMapping("/api/user")
public class UserController {
    
    // æ¥æ”¶JSONæ ¼å¼
    @PostMapping(consumes = "application/json")
    public User createFromJson(@RequestBody User user) {
        System.out.println("å¤„ç†JSONæ ¼å¼çš„ç”¨æˆ·æ•°æ®");
        return userService.save(user);
    }
    
    // æ¥æ”¶XMLæ ¼å¼
    @PostMapping(consumes = "application/xml")
    public User createFromXml(@RequestBody User user) {
        System.out.println("å¤„ç†XMLæ ¼å¼çš„ç”¨æˆ·æ•°æ®");
        return userService.save(user);
    }
    
    // æ¥æ”¶è¡¨å•æ ¼å¼
    @PostMapping(consumes = "application/x-www-form-urlencoded")
    public User createFromForm(User user) {
        System.out.println("å¤„ç†è¡¨å•æ ¼å¼çš„ç”¨æˆ·æ•°æ®");
        return userService.save(user);
    }
}
```

**å‰ç«¯è°ƒç”¨ç¤ºä¾‹**ï¼š
```javascript
// å‘é€JSONæ ¼å¼
fetch('/api/user', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ name: 'å¼ ä¸‰', age: 25 })
})
// â†’ åŒ¹é…åˆ° createFromJson() æ–¹æ³•

// å‘é€è¡¨å•æ ¼å¼
fetch('/api/user', {
    method: 'POST',
    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
    body: 'name=å¼ ä¸‰&age=25'
})
// â†’ åŒ¹é…åˆ° createFromForm() æ–¹æ³•
```

**åœºæ™¯äºŒï¼šæ–‡ä»¶ä¸Šä¼ **
```java
// åªæ¥æ”¶æ–‡ä»¶ä¸Šä¼ è¯·æ±‚
@PostMapping(value = "/upload", 
    consumes = "multipart/form-data")
public String uploadFile(@RequestParam("file") MultipartFile file) {
    if (file.isEmpty()) {
        return "æ–‡ä»¶ä¸ºç©º";
    }
    // ä¿å­˜æ–‡ä»¶
    String fileName = file.getOriginalFilename();
    // ... ä¿å­˜é€»è¾‘
    return "ä¸Šä¼ æˆåŠŸï¼š" + fileName;
}
```

**HTMLè¡¨å•**ï¼š
```html
<!-- æ–‡ä»¶ä¸Šä¼ è¡¨å•å¿…é¡»è®¾ç½® enctype -->
<form action="/upload" method="post" enctype="multipart/form-data">
    <input type="file" name="file">
    <button type="submit">ä¸Šä¼ </button>
</form>
```

### 5.5 å¤šç§æ ¼å¼æ”¯æŒ


**åŒæ—¶æ¥æ”¶å¤šç§æ ¼å¼**ï¼š
```java
@PostMapping(value = "/data", 
    consumes = {"application/json", "application/xml"})
public Response processData(@RequestBody Data data) {
    // å¯ä»¥å¤„ç†JSONæˆ–XMLæ ¼å¼çš„æ•°æ®
    return new Response("å¤„ç†æˆåŠŸ");
}
```

**è¯·æ±‚åŒ¹é…é€»è¾‘**ï¼š
```
å®¢æˆ·ç«¯è¯·æ±‚: Content-Type: application/json
           â†“
Springæ£€æŸ¥: consumesåŒ…å«application/json? âœ“
           â†“
æ‰§è¡Œæ–¹æ³•: processData()

å®¢æˆ·ç«¯è¯·æ±‚: Content-Type: text/plain
           â†“
Springæ£€æŸ¥: consumesåŒ…å«text/plain? âœ—
           â†“
è¿”å›é”™è¯¯: 415 Unsupported Media Type
```

---

## 6. ğŸ“¥ Accepté™å®šï¼ˆproducesï¼‰


### 6.1 ä»€ä¹ˆæ˜¯Accept


**é€šä¿—ç†è§£**ï¼š
Acceptè¯·æ±‚å¤´æ˜¯å®¢æˆ·ç«¯å‘Šè¯‰æœåŠ¡å™¨ï¼š**æˆ‘å¸Œæœ›ä½ è¿”å›ä»€ä¹ˆæ ¼å¼çš„æ•°æ®ç»™æˆ‘**

ç”Ÿæ´»ç±»æ¯”ï¼š
- ä½ å»é¤å…ç‚¹é¤ï¼šæˆ‘è¦ä¸­é¤/è¥¿é¤/æ—¥æ–™
- ä½ å»ç”µå½±é™¢ï¼šæˆ‘è¦2D/3D/IMAXæ ¼å¼

```
è¯·æ±‚ç¤ºä¾‹ï¼š
GET /api/user HTTP/1.1
Accept: application/json    â† å®¢æˆ·ç«¯è¯´ï¼šæˆ‘å¸Œæœ›å¾—åˆ°JSONæ ¼å¼çš„å“åº”
```

### 6.2 produceså±æ€§è¯¦è§£


**åŸºæœ¬ç”¨æ³•**ï¼š
```java
// åªè¿”å›JSONæ ¼å¼
@GetMapping(value = "/user", 
    produces = "application/json")
public User getUserJson() {
    return new User("å¼ ä¸‰", 25);
}

// åªè¿”å›XMLæ ¼å¼
@GetMapping(value = "/user", 
    produces = "application/xml")
public User getUserXml() {
    return new User("å¼ ä¸‰", 25);
}

// åªè¿”å›çº¯æ–‡æœ¬
@GetMapping(value = "/user", 
    produces = "text/plain")
public String getUserText() {
    return "å§“åï¼šå¼ ä¸‰ï¼Œå¹´é¾„ï¼š25";
}
```

### 6.3 å†…å®¹åå•†æœºåˆ¶


**ä»€ä¹ˆæ˜¯å†…å®¹åå•†**ï¼š
æ ¹æ®å®¢æˆ·ç«¯çš„Acceptå¤´ï¼Œè‡ªåŠ¨é€‰æ‹©åˆé€‚çš„å“åº”æ ¼å¼

```
å®¢æˆ·ç«¯è¯·æ±‚æµç¨‹ï¼š

è¯·æ±‚: GET /user
      Accept: application/json
      â†“
æœåŠ¡å™¨æ£€æŸ¥: producesåŒ…å«application/json?
      â†“
      YES â†’ è¿”å›JSONæ ¼å¼æ•°æ®
      NO  â†’ è¿”å›406 Not Acceptable
```

**å®é™…ç¤ºä¾‹**ï¼š
```java
@RestController
@RequestMapping("/api/user")
public class UserController {
    
    // æ”¯æŒè¿”å›JSON
    @GetMapping(produces = "application/json")
    public User getUserJson() {
        return new User("å¼ ä¸‰", 25);
        // è‡ªåŠ¨åºåˆ—åŒ–ä¸º: {"name":"å¼ ä¸‰","age":25}
    }
    
    // æ”¯æŒè¿”å›XML
    @GetMapping(produces = "application/xml")
    public User getUserXml() {
        return new User("å¼ ä¸‰", 25);
        // è‡ªåŠ¨åºåˆ—åŒ–ä¸º: <User><name>å¼ ä¸‰</name><age>25</age></User>
    }
    
    // æ”¯æŒè¿”å›çº¯æ–‡æœ¬
    @GetMapping(produces = "text/plain;charset=UTF-8")
    public String getUserText() {
        return "ç”¨æˆ·ä¿¡æ¯ï¼šå¼ ä¸‰ï¼Œ25å²";
    }
}
```

### 6.4 å¤šæ ¼å¼å“åº”æ”¯æŒ


**åŒæ—¶æ”¯æŒå¤šç§æ ¼å¼**ï¼š
```java
@GetMapping(value = "/user", 
    produces = {"application/json", "application/xml"})
public User getUser() {
    return new User("å¼ ä¸‰", 25);
}
```

**è¯·æ±‚å¤„ç†ç¤ºä¾‹**ï¼š
```javascript
// è¯·æ±‚JSONæ ¼å¼
fetch('/api/user', {
    headers: { 'Accept': 'application/json' }
})
.then(res => res.json())
.then(data => console.log(data)) // {name: "å¼ ä¸‰", age: 25}

// è¯·æ±‚XMLæ ¼å¼
fetch('/api/user', {
    headers: { 'Accept': 'application/xml' }
})
.then(res => res.text())
.then(data => console.log(data)) // <User><name>å¼ ä¸‰</name>...</User>
```

### 6.5 å­—ç¬¦ç¼–ç è®¾ç½®


**æŒ‡å®šå“åº”ç¼–ç **ï¼š
```java
// è¿”å›UTF-8ç¼–ç çš„JSON
@GetMapping(produces = "application/json;charset=UTF-8")
public User getUser() {
    return new User("å¼ ä¸‰", 25); // ä¸­æ–‡æ­£ç¡®æ˜¾ç¤º
}

// è¿”å›UTF-8ç¼–ç çš„HTML
@GetMapping(produces = "text/html;charset=UTF-8")
public String getUserHtml() {
    return "<h1>ç”¨æˆ·ï¼šå¼ ä¸‰</h1>"; // ä¸­æ–‡æ­£ç¡®æ˜¾ç¤º
}
```

### 6.6 å®é™…åº”ç”¨åœºæ™¯


**åœºæ™¯ä¸€ï¼šAPIç‰ˆæœ¬åŒ–å“åº”**
```java
// V1ç‰ˆæœ¬ï¼šè¿”å›ç®€å•JSON
@GetMapping(value = "/user/{id}", 
    produces = "application/vnd.company.v1+json")
public UserV1 getUserV1(@PathVariable Long id) {
    return new UserV1(id, "å¼ ä¸‰");
}

// V2ç‰ˆæœ¬ï¼šè¿”å›è¯¦ç»†JSON
@GetMapping(value = "/user/{id}", 
    produces = "application/vnd.company.v2+json")
public UserV2 getUserV2(@PathVariable Long id) {
    return new UserV2(id, "å¼ ä¸‰", "zhangsan@example.com", 25);
}
```

**åœºæ™¯äºŒï¼šå¯¼å‡ºåŠŸèƒ½**
```java
// å¯¼å‡ºJSON
@GetMapping(value = "/export/users", 
    produces = "application/json")
public List<User> exportJson() {
    return userService.findAll();
}

// å¯¼å‡ºCSV
@GetMapping(value = "/export/users", 
    produces = "text/csv")
public String exportCsv() {
    return "å§“å,å¹´é¾„\nå¼ ä¸‰,25\næå››,30";
}

// å¯¼å‡ºExcel
@GetMapping(value = "/export/users", 
    produces = "application/vnd.ms-excel")
public ResponseEntity<byte[]> exportExcel() {
    byte[] excelData = excelService.generateExcel();
    return ResponseEntity.ok()
        .header("Content-Disposition", "attachment; filename=users.xlsx")
        .body(excelData);
}
```

---

## 7. ğŸ”— ç»¼åˆåº”ç”¨ä¸æœ€ä½³å®è·µ


### 7.1 å¤šæ¡ä»¶ç»„åˆä½¿ç”¨


**å®Œæ•´çš„RESTfulæ¥å£ç¤ºä¾‹**ï¼š
```java
@RestController
@RequestMapping("/api/v1/products")
public class ProductController {
    
    // åˆ›å»ºå•†å“ï¼šPOSTè¯·æ±‚ + JSONæ ¼å¼ + è¿”å›JSON
    @PostMapping(
        consumes = "application/json",
        produces = "application/json;charset=UTF-8")
    public Product createProduct(@RequestBody Product product) {
        return productService.save(product);
    }
    
    // æŸ¥è¯¢å•†å“åˆ—è¡¨ï¼šGETè¯·æ±‚ + æ”¯æŒåˆ†é¡µå‚æ•° + è¿”å›JSON
    @GetMapping(
        params = {"page", "size"},
        produces = "application/json;charset=UTF-8")
    public PageResult<Product> getProducts(
        @RequestParam int page,
        @RequestParam int size) {
        return productService.findByPage(page, size);
    }
    
    // VIPç”¨æˆ·ä¸“å±æ¥å£ï¼šéœ€è¦ç‰¹å®šè¯·æ±‚å¤´
    @GetMapping(
        value = "/vip",
        headers = "X-User-Level=VIP",
        produces = "application/json;charset=UTF-8")
    public List<Product> getVipProducts() {
        return productService.findVipProducts();
    }
    
    // æ‰¹é‡æ“ä½œï¼šPUTè¯·æ±‚ + JSONæ ¼å¼ + éœ€è¦ç®¡ç†å‘˜æƒé™
    @PutMapping(
        value = "/batch",
        consumes = "application/json",
        headers = "X-Admin-Token",
        produces = "application/json;charset=UTF-8")
    public BatchResult updateBatch(@RequestBody List<Product> products) {
        return productService.updateBatch(products);
    }
}
```

### 7.2 æ¡ä»¶é™å®šçš„ä¼˜å…ˆçº§


**åŒ¹é…ä¼˜å…ˆçº§è§„åˆ™**ï¼š
```
1. è·¯å¾„åŒ¹é…ï¼ˆæœ€å…·ä½“çš„è·¯å¾„ä¼˜å…ˆï¼‰
   /user/1 > /user/* > /*

2. è¯·æ±‚æ–¹æ³•ï¼ˆæ˜ç¡®æŒ‡å®šä¼˜å…ˆäºä¸æŒ‡å®šï¼‰
   @PostMapping > @RequestMapping

3. å‚æ•°æ¡ä»¶ï¼ˆæœ‰å‚æ•°é™åˆ¶ä¼˜å…ˆï¼‰
   params = "id" > æ— params

4. è¯·æ±‚å¤´æ¡ä»¶ï¼ˆæœ‰è¯·æ±‚å¤´é™åˆ¶ä¼˜å…ˆï¼‰
   headers = "X-Version" > æ— headers

5. åª’ä½“ç±»å‹ï¼ˆæ˜ç¡®ç±»å‹ä¼˜å…ˆï¼‰
   produces = "application/json" > æ— produces
```

**ç¤ºä¾‹è¯´æ˜**ï¼š
```java
// æ–¹æ³•1ï¼šæœ€å…·ä½“
@GetMapping(value = "/user", 
    params = "id", 
    headers = "X-Version=2.0")
public User getV2User(@RequestParam Long id) { }

// æ–¹æ³•2ï¼šè¾ƒå…·ä½“
@GetMapping(value = "/user", params = "id")
public User getUser(@RequestParam Long id) { }

// æ–¹æ³•3ï¼šæœ€å®½æ³›
@GetMapping("/user")
public List<User> getAllUsers() { }

// è¯·æ±‚: GET /user?id=1 ä¸” X-Version=2.0
// â†’ åŒ¹é…æ–¹æ³•1

// è¯·æ±‚: GET /user?id=1 ä¸”æ— ç‰ˆæœ¬å¤´
// â†’ åŒ¹é…æ–¹æ³•2

// è¯·æ±‚: GET /user æ— å‚æ•°
// â†’ åŒ¹é…æ–¹æ³•3
```

### 7.3 æœ€ä½³å®è·µå»ºè®®


**å®è·µä¸€ï¼šç»Ÿä¸€çš„æ¥å£é£æ ¼**
```java
@RestController
@RequestMapping(value = "/api/v1", 
    produces = "application/json;charset=UTF-8")
public class BaseController {
    
    // ç±»çº§åˆ«ç»Ÿä¸€è®¾ç½®producesï¼Œæ–¹æ³•ç»§æ‰¿æ­¤è®¾ç½®
    
    @GetMapping("/users")
    public List<User> getUsers() { }
    
    @PostMapping(value = "/users", 
        consumes = "application/json")
    public User createUser(@RequestBody User user) { }
}
```

**å®è·µäºŒï¼šå¼‚å¸¸æƒ…å†µçš„å¤„ç†**
```java
@RestControllerAdvice
public class GlobalExceptionHandler {
    
    // å¤„ç†Content-Typeä¸åŒ¹é…ï¼ˆ415é”™è¯¯ï¼‰
    @ExceptionHandler(HttpMediaTypeNotSupportedException.class)
    public ErrorResponse handleMediaTypeError(
        HttpMediaTypeNotSupportedException ex) {
        return new ErrorResponse(
            "ä¸æ”¯æŒçš„Content-Typeï¼š" + ex.getContentType(),
            "è¯·ä½¿ç”¨application/jsonæ ¼å¼"
        );
    }
    
    // å¤„ç†Acceptä¸åŒ¹é…ï¼ˆ406é”™è¯¯ï¼‰
    @ExceptionHandler(HttpMediaTypeNotAcceptableException.class)
    public ErrorResponse handleAcceptError(
        HttpMediaTypeNotAcceptableException ex) {
        return new ErrorResponse(
            "ä¸æ”¯æŒçš„Acceptç±»å‹",
            "è¯·ä½¿ç”¨application/json"
        );
    }
    
    // å¤„ç†è¯·æ±‚æ–¹æ³•ä¸åŒ¹é…ï¼ˆ405é”™è¯¯ï¼‰
    @ExceptionHandler(HttpRequestMethodNotSupportedException.class)
    public ErrorResponse handleMethodError(
        HttpRequestMethodNotSupportedException ex) {
        return new ErrorResponse(
            "ä¸æ”¯æŒçš„è¯·æ±‚æ–¹æ³•ï¼š" + ex.getMethod(),
            "æ”¯æŒçš„æ–¹æ³•ï¼š" + String.join(",", ex.getSupportedMethods())
        );
    }
}
```

### 7.4 å¸¸è§é”™è¯¯ä¸è§£å†³


**é”™è¯¯ä¸€ï¼š415 Unsupported Media Type**
```java
// é—®é¢˜ä»£ç 
@PostMapping(consumes = "application/json")
public User create(@RequestBody User user) { }

// å‰ç«¯é”™è¯¯è°ƒç”¨
fetch('/user', {
    method: 'POST',
    body: JSON.stringify(user)  // âŒ å¿˜è®°è®¾ç½®Content-Type
})

// æ­£ç¡®è°ƒç”¨
fetch('/user', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' }, // âœ…
    body: JSON.stringify(user)
})
```

**é”™è¯¯äºŒï¼š406 Not Acceptable**
```java
// é—®é¢˜ä»£ç 
@GetMapping(produces = "application/json")
public User get() { }

// å‰ç«¯é”™è¯¯è°ƒç”¨
fetch('/user', {
    headers: { 'Accept': 'text/html' }  // âŒ Acceptç±»å‹ä¸åŒ¹é…
})

// æ­£ç¡®è°ƒç”¨
fetch('/user', {
    headers: { 'Accept': 'application/json' }  // âœ…
})
```

**é”™è¯¯ä¸‰ï¼š404 Not Foundï¼ˆå‚æ•°æ¡ä»¶ä¸åŒ¹é…ï¼‰**
```java
// è¦æ±‚å¿…é¡»æœ‰idå‚æ•°
@GetMapping(value = "/user", params = "id")
public User get(@RequestParam Long id) { }

// é”™è¯¯è®¿é—®: /user ï¼ˆæ²¡æœ‰idå‚æ•°ï¼‰
// â†’ 404 Not Found

// æ­£ç¡®è®¿é—®: /user?id=1
// â†’ æˆåŠŸåŒ¹é…
```

### 7.5 è°ƒè¯•æŠ€å·§


**æŠ€å·§ä¸€ï¼šæŸ¥çœ‹åŒ¹é…çš„å¤„ç†å™¨**
```java
@GetMapping("/debug")
public String debug(HttpServletRequest request) {
    // æ‰“å°è¯·æ±‚ä¿¡æ¯
    System.out.println("Method: " + request.getMethod());
    System.out.println("Content-Type: " + request.getContentType());
    System.out.println("Accept: " + request.getHeader("Accept"));
    
    // æ‰“å°æ‰€æœ‰è¯·æ±‚å¤´
    request.getHeaderNames().asIterator()
        .forEachRemaining(name -> 
            System.out.println(name + ": " + request.getHeader(name))
        );
    
    return "è°ƒè¯•ä¿¡æ¯å·²æ‰“å°åˆ°æ§åˆ¶å°";
}
```

**æŠ€å·§äºŒï¼šä½¿ç”¨æ—¥å¿—è®°å½•**
```java
@RestController
@Slf4j
public class UserController {
    
    @PostMapping(value = "/user", 
        consumes = "application/json",
        produces = "application/json")
    public User create(@RequestBody User user, 
                      HttpServletRequest request) {
        // è®°å½•è¯·æ±‚ä¿¡æ¯
        log.info("æ”¶åˆ°åˆ›å»ºç”¨æˆ·è¯·æ±‚");
        log.info("Content-Type: {}", request.getContentType());
        log.info("ç”¨æˆ·æ•°æ®: {}", user);
        
        return userService.save(user);
    }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ¯ è¯·æ±‚æ¡ä»¶é™å®šçš„å…­å¤§ç»´åº¦ï¼š

1. è¯·æ±‚æ–¹æ³• (method)     â†’ å†³å®šæ“ä½œç±»å‹ï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰
2. è¯·æ±‚å¤´ (headers)      â†’ é™„åŠ æ¡ä»¶ï¼ˆç‰ˆæœ¬ã€å¹³å°ç­‰ï¼‰
3. è¯·æ±‚å‚æ•° (params)     â†’ URLå‚æ•°æ¡ä»¶
4. Content-Type (consumes) â†’ è¯·æ±‚ä½“æ ¼å¼é™å®š
5. Accept (produces)      â†’ å“åº”ä½“æ ¼å¼é™å®š
6. è·¯å¾„å‚æ•° (path)        â†’ URLè·¯å¾„æ¨¡å¼
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**æ ¸å¿ƒåŸåˆ™**ï¼š
- âœ… **èŒè´£å•ä¸€**ï¼šä¸€ä¸ªæ–¹æ³•åªå¤„ç†ä¸€ç§è¯·æ±‚
- âœ… **æ¡ä»¶æ˜ç¡®**ï¼šè®©è¯·æ±‚åŒ¹é…è§„åˆ™æ¸…æ™°å¯è¯»
- âœ… **é”™è¯¯å‹å¥½**ï¼šä¸åŒ¹é…æ—¶è¿”å›æœ‰æ„ä¹‰çš„é”™è¯¯ä¿¡æ¯
- âœ… **RESTfulè§„èŒƒ**ï¼šéµå¾ªREST APIè®¾è®¡åŸåˆ™

**å¸¸ç”¨ç»„åˆæ¨¡å¼**ï¼š
```java
// æ¨¡å¼1ï¼šRESTfulæ ‡å‡†CRUD
@GetMapping(produces = "application/json")     // æŸ¥è¯¢
@PostMapping(consumes = "application/json")    // åˆ›å»º
@PutMapping(consumes = "application/json")     // æ›´æ–°
@DeleteMapping                                  // åˆ é™¤

// æ¨¡å¼2ï¼šç‰ˆæœ¬æ§åˆ¶
@GetMapping(headers = "API-Version=1.0")       // V1æ¥å£
@GetMapping(headers = "API-Version=2.0")       // V2æ¥å£

// æ¨¡å¼3ï¼šå¤šæ ¼å¼æ”¯æŒ
@GetMapping(produces = {"application/json", "application/xml"})
```

### 8.3 å®é™…åº”ç”¨è®°å¿†ç‚¹


**è¯·æ±‚æ–¹æ³•é€‰æ‹©å£è¯€**ï¼š
```
æŸ¥è¯¢ç”¨GETï¼Œåˆ›å»ºç”¨POST
å®Œæ•´æ›´æ–°PUTï¼Œéƒ¨åˆ†ç”¨PATCH
åˆ é™¤ç”¨DELETEï¼Œæäº¤ç”¨POST
å¹‚ç­‰æ“ä½œè¦è®°ç‰¢ï¼Œå¤šæ¬¡æ‰§è¡Œç»“æœåŒ
```

**Content-Typeå¸¸ç”¨å€¼**ï¼š
```
application/json          â†’ JSONæ•°æ®ï¼ˆæœ€å¸¸ç”¨ï¼‰
application/x-www-form-urlencoded â†’ è¡¨å•æ•°æ®
multipart/form-data      â†’ æ–‡ä»¶ä¸Šä¼ 
application/xml          â†’ XMLæ•°æ®
text/plain               â†’ çº¯æ–‡æœ¬
```

**HTTPé”™è¯¯ç è®°å¿†**ï¼š
```
400 Bad Request          â†’ è¯·æ±‚å‚æ•°é”™è¯¯
404 Not Found           â†’ è·¯å¾„æˆ–æ¡ä»¶ä¸åŒ¹é…
405 Method Not Allowed  â†’ è¯·æ±‚æ–¹æ³•ä¸å…è®¸
406 Not Acceptable      â†’ Acceptç±»å‹ä¸æ”¯æŒ
415 Unsupported Media   â†’ Content-Typeä¸æ”¯æŒ
```

### 8.4 å­¦ä¹ å»ºè®®


**æ–°æ‰‹å­¦ä¹ è·¯å¾„**ï¼š
```
ç¬¬ä¸€æ­¥ï¼šæŒæ¡åŸºæœ¬çš„@GetMappingã€@PostMapping
       â†“
ç¬¬äºŒæ­¥ï¼šç†è§£consumeså’Œproducesçš„åŒºåˆ«
       â†“
ç¬¬ä¸‰æ­¥ï¼šå­¦ä¼šä½¿ç”¨paramså’Œheadersåšæ¡ä»¶é™å®š
       â†“
ç¬¬å››æ­¥ï¼šç»¼åˆè¿ç”¨ï¼Œè®¾è®¡RESTfulæ¥å£
       â†“
ç¬¬äº”æ­¥ï¼šå¤„ç†å¼‚å¸¸ï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒ
```

**è°ƒè¯•å»ºè®®**ï¼š
- ğŸ”¸ ä½¿ç”¨Postmanç­‰å·¥å…·æµ‹è¯•æ¥å£
- ğŸ”¸ å¼€å¯Spring MVCçš„æ—¥å¿—è®°å½•è¯·æ±‚ä¿¡æ¯
- ğŸ”¸ å–„ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹è¯·æ±‚å¤´
- ğŸ”¸ ç¼–å†™å•å…ƒæµ‹è¯•éªŒè¯å„ç§æ¡ä»¶ç»„åˆ

**æ³¨æ„äº‹é¡¹**ï¼š
- âš ï¸ ä¸è¦è¿‡åº¦é™å®šæ¡ä»¶ï¼ˆå½±å“çµæ´»æ€§ï¼‰
- âš ï¸ ç»Ÿä¸€å›¢é˜Ÿçš„æ¥å£è®¾è®¡è§„èŒƒ
- âš ï¸ è®°å¾—å¤„ç†æ¡ä»¶ä¸åŒ¹é…çš„å¼‚å¸¸æƒ…å†µ
- âš ï¸ æ–‡æ¡£åŒ–æ¯ä¸ªæ¥å£çš„é™å®šæ¡ä»¶

---

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
è¯·æ±‚æ¡ä»¶å…­å¤§ç±»ï¼Œæ–¹æ³•å¤´å‚åª’ä½“å‹
RESTfulè®¾è®¡è¦è§„èŒƒï¼Œå¢åˆ æ”¹æŸ¥åˆ†å¾—æ¸…
Contentå‘Šè¯‰æˆ‘å‘å•¥ï¼ŒAcceptæœŸå¾…ä½ è¿”å•¥
æ¡ä»¶ç»„åˆè¦åˆç†ï¼Œå¼‚å¸¸å¤„ç†åˆ«å¿˜è®°
```