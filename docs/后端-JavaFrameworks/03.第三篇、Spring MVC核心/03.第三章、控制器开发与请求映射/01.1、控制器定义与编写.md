---
title: 1ã€æ§åˆ¶å™¨å®šä¹‰ä¸ç¼–å†™
---
## ğŸ“š ç›®å½•

1. [æ§åˆ¶å™¨æ˜¯ä»€ä¹ˆ](#1-æ§åˆ¶å™¨æ˜¯ä»€ä¹ˆ)
2. [@Controlleræ³¨è§£è¯¦è§£](#2-controlleræ³¨è§£è¯¦è§£)
3. [@RestControlleræ³¨è§£è¯¦è§£](#3-restcontrolleræ³¨è§£è¯¦è§£)
4. [Beanæ³¨å†Œä¸ç»„ä»¶æ‰«æ](#4-beanæ³¨å†Œä¸ç»„ä»¶æ‰«æ)
5. [æ§åˆ¶å™¨ç”Ÿå‘½å‘¨æœŸ](#5-æ§åˆ¶å™¨ç”Ÿå‘½å‘¨æœŸ)
6. [å•ä¾‹æ¨¡å¼ä¸çº¿ç¨‹å®‰å…¨](#6-å•ä¾‹æ¨¡å¼ä¸çº¿ç¨‹å®‰å…¨)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ æ§åˆ¶å™¨æ˜¯ä»€ä¹ˆ


### 1.1 æ§åˆ¶å™¨çš„é€šä¿—ç†è§£


> ğŸ’¡ **ç”Ÿæ´»æ¯”å–»**ï¼šæ§åˆ¶å™¨å°±åƒé¤å…çš„æœåŠ¡å‘˜
> - å®¢æˆ·ï¼ˆæµè§ˆå™¨ï¼‰ç‚¹èœï¼ˆå‘é€è¯·æ±‚ï¼‰
> - æœåŠ¡å‘˜ï¼ˆæ§åˆ¶å™¨ï¼‰æ¥æ”¶ç‚¹èœå•
> - æœåŠ¡å‘˜é€šçŸ¥å¨æˆ¿ï¼ˆä¸šåŠ¡å±‚ï¼‰åšèœ
> - åšå¥½åæœåŠ¡å‘˜æŠŠèœç«¯ç»™å®¢æˆ·ï¼ˆè¿”å›å“åº”ï¼‰

**æ ¸å¿ƒä½œç”¨**ï¼š
```
ç”¨æˆ·è¯·æ±‚ â†’ æ§åˆ¶å™¨æ¥æ”¶ â†’ è°ƒç”¨ä¸šåŠ¡é€»è¾‘ â†’ è¿”å›ç»“æœ

æ§åˆ¶å™¨æ˜¯è¿æ¥"ç”¨æˆ·"å’Œ"ä¸šåŠ¡é€»è¾‘"çš„æ¡¥æ¢
```

### 1.2 åœ¨Spring MVCä¸­çš„ä½ç½®


```
æµè§ˆå™¨å‘é€è¯·æ±‚
     â†“
DispatcherServletï¼ˆå‰ç«¯æ§åˆ¶å™¨ï¼ŒSpringè‡ªåŠ¨é…ç½®ï¼‰
     â†“
æ‰¾åˆ°å¯¹åº”çš„Controllerï¼ˆæˆ‘ä»¬ç¼–å†™çš„æ§åˆ¶å™¨ï¼‰
     â†“
Controllerè°ƒç”¨Serviceï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰
     â†“
è¿”å›ç»“æœç»™æµè§ˆå™¨
```

**é‡è¦ç†è§£**ï¼š
- ğŸ”¸ æ§åˆ¶å™¨ä¸å†™ä¸šåŠ¡é€»è¾‘ï¼Œåªè´Ÿè´£æ¥æ”¶è¯·æ±‚å’Œè¿”å›å“åº”
- ğŸ”¸ çœŸæ­£çš„ä¸šåŠ¡å¤„ç†åœ¨Serviceå±‚å®Œæˆ
- ğŸ”¸ æ§åˆ¶å™¨å°±æ˜¯ä¸€ä¸ª"è¯·æ±‚åˆ†å‘å‘˜"

---

## 2. ğŸ“ @Controlleræ³¨è§£è¯¦è§£


### 2.1 ä»€ä¹ˆæ˜¯@Controller


> ğŸ“– **é€šä¿—è§£é‡Š**ï¼š@Controlleræ˜¯ä¸€ä¸ªæ ‡è®°ï¼Œå‘Šè¯‰Spring"è¿™ä¸ªç±»æ˜¯ç”¨æ¥å¤„ç†ç½‘ç»œè¯·æ±‚çš„"

**åŸºç¡€ç¤ºä¾‹**ï¼š
```java
@Controller  // è¿™ä¸ªæ³¨è§£æ ‡è®°è¿™æ˜¯ä¸€ä¸ªæ§åˆ¶å™¨
public class UserController {
    
    @RequestMapping("/hello")  // å¤„ç†/helloè¯·æ±‚
    public String sayHello() {
        return "hello";  // è¿”å›è§†å›¾åç§°
    }
}
```

### 2.2 @Controllerçš„å·¥ä½œåŸç†


```
Springå¯åŠ¨æ—¶çš„å·¥ä½œæµç¨‹ï¼š

1. æ‰«ææ‰€æœ‰ç±»
   â†“
2. å‘ç°@Controlleræ³¨è§£
   â†“
3. åˆ›å»ºè¿™ä¸ªç±»çš„å¯¹è±¡ï¼ˆBeanï¼‰
   â†“
4. æ”¾å…¥å®¹å™¨ç®¡ç†
   â†“
5. å½“è¯·æ±‚æ¥ä¸´æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨å¯¹åº”æ–¹æ³•
```

### 2.3 è¿”å›è§†å›¾ï¼ˆé¡µé¢ï¼‰


**@Controllerçš„ç‰¹ç‚¹**ï¼šè¿”å›çš„å­—ç¬¦ä¸²ä¼šè¢«å½“ä½œ"è§†å›¾åç§°"

```java
@Controller
public class PageController {
    
    @RequestMapping("/index")
    public String toIndexPage() {
        return "index";  
        // è¿™é‡Œçš„"index"ä¸æ˜¯æ™®é€šå­—ç¬¦ä¸²
        // Springä¼šæ‰¾åˆ° index.html æˆ– index.jsp é¡µé¢
    }
}
```

**è§†å›¾è§£æè¿‡ç¨‹**ï¼š
```
return "index"
   â†“
è§†å›¾è§£æå™¨å¤„ç†
   â†“
æ‰¾åˆ°å®é™…é¡µé¢æ–‡ä»¶ï¼š/templates/index.html
   â†“
æ¸²æŸ“é¡µé¢è¿”å›ç»™æµè§ˆå™¨
```

### 2.4 ä½•æ—¶ä½¿ç”¨@Controller


âœ… **é€‚ç”¨åœºæ™¯**ï¼š
- éœ€è¦è¿”å›HTMLé¡µé¢æ—¶
- ä¼ ç»Ÿçš„Webåº”ç”¨ï¼ˆæ¨¡æ¿å¼•æ“ï¼‰
- éœ€è¦é¡µé¢è·³è½¬çš„åœºæ™¯

```java
@Controller
public class WebController {
    
    // åœºæ™¯1ï¼šè¿”å›ç™»å½•é¡µé¢
    @GetMapping("/login")
    public String loginPage() {
        return "login";  // è¿”å›login.htmlé¡µé¢
    }
    
    // åœºæ™¯2ï¼šå¤„ç†è¡¨å•æäº¤åè·³è½¬
    @PostMapping("/register")
    public String register(User user) {
        // å¤„ç†æ³¨å†Œé€»è¾‘...
        return "redirect:/success";  // é‡å®šå‘åˆ°æˆåŠŸé¡µé¢
    }
}
```

---

## 3. ğŸš€ @RestControlleræ³¨è§£è¯¦è§£


### 3.1 ä»€ä¹ˆæ˜¯@RestController


> ğŸ’¡ **å…³é”®ç†è§£**ï¼š@RestController = @Controller + @ResponseBody
> - ä¸è¿”å›é¡µé¢ï¼Œç›´æ¥è¿”å›æ•°æ®
> - æ•°æ®è‡ªåŠ¨è½¬æˆJSONæ ¼å¼
> - ä¸“é—¨ç”¨äºå‰åç«¯åˆ†ç¦»é¡¹ç›®

**å¯¹æ¯”ç†è§£**ï¼š

| æ³¨è§£ | è¿”å›å†…å®¹ | ä½¿ç”¨åœºæ™¯ |
|------|---------|---------|
| `@Controller` | **é¡µé¢è§†å›¾** | ä¼ ç»ŸWebåº”ç”¨ |
| `@RestController` | **JSONæ•°æ®** | å‰åç«¯åˆ†ç¦»ã€APIæ¥å£ |

### 3.2 åŸºç¡€ä½¿ç”¨ç¤ºä¾‹


```java
@RestController  // æ³¨æ„è¿™é‡Œç”¨çš„æ˜¯RestController
public class UserApiController {
    
    @GetMapping("/api/user/{id}")
    public User getUser(@PathVariable Long id) {
        User user = new User(id, "å¼ ä¸‰", 25);
        return user;  
        // è¿”å›çš„Userå¯¹è±¡ä¼šè‡ªåŠ¨è½¬æˆJSON
        // {"id":1,"name":"å¼ ä¸‰","age":25}
    }
}
```

### 3.3 å†…éƒ¨å·¥ä½œåŸç†


```
æ–¹æ³•è¿”å›å¯¹è±¡
    â†“
@RestControllerè‡ªåŠ¨æ·»åŠ @ResponseBody
    â†“
HttpMessageConverterè½¬æ¢å™¨ä»‹å…¥
    â†“
å¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²
    â†“
è®¾ç½®Content-Type: application/json
    â†“
è¿”å›ç»™æµè§ˆå™¨
```

### 3.4 @Controller + @ResponseBodyçš„ç­‰ä»·å†™æ³•


**ä¼ ç»Ÿå†™æ³•**ï¼ˆä¸æ¨èï¼‰ï¼š
```java
@Controller  // ä½¿ç”¨Controller
public class UserController {
    
    @GetMapping("/api/user/{id}")
    @ResponseBody  // æ¯ä¸ªæ–¹æ³•éƒ½è¦åŠ è¿™ä¸ªæ³¨è§£
    public User getUser(@PathVariable Long id) {
        return new User(id, "å¼ ä¸‰", 25);
    }
    
    @GetMapping("/api/users")
    @ResponseBody  // æ¯ä¸ªæ–¹æ³•éƒ½è¦åŠ 
    public List<User> getUsers() {
        return Arrays.asList(/*...*/);
    }
}
```

**æ¨èå†™æ³•**ï¼ˆç®€æ´ï¼‰ï¼š
```java
@RestController  // ç›´æ¥ç”¨è¿™ä¸ªï¼Œç±»ä¸­æ‰€æœ‰æ–¹æ³•è‡ªåŠ¨è¿”å›JSON
public class UserController {
    
    @GetMapping("/api/user/{id}")
    public User getUser(@PathVariable Long id) {
        return new User(id, "å¼ ä¸‰", 25);
    }
    
    @GetMapping("/api/users")
    public List<User> getUsers() {
        return Arrays.asList(/*...*/);
    }
}
```

### 3.5 ä½•æ—¶ä½¿ç”¨@RestController


âœ… **é€‚ç”¨åœºæ™¯**ï¼š
- **å‰åç«¯åˆ†ç¦»é¡¹ç›®**ï¼ˆVueã€Reactç­‰å‰ç«¯æ¡†æ¶ï¼‰
- **æä¾›APIæ¥å£**ï¼ˆç§»åŠ¨ç«¯è°ƒç”¨ï¼‰
- **å¾®æœåŠ¡ä¹‹é—´é€šä¿¡**

```java
@RestController
@RequestMapping("/api")  // ç»Ÿä¸€APIå‰ç¼€
public class ProductController {
    
    // åœºæ™¯1ï¼šè¿”å›JSONæ•°æ®ç»™å‰ç«¯
    @GetMapping("/products")
    public List<Product> getProducts() {
        return productService.findAll();
    }
    
    // åœºæ™¯2ï¼šæ¥æ”¶JSONï¼Œè¿”å›JSON
    @PostMapping("/product")
    public Result addProduct(@RequestBody Product product) {
        productService.save(product);
        return Result.success("æ·»åŠ æˆåŠŸ");
    }
}
```

---

## 4. ğŸ”§ Beanæ³¨å†Œä¸ç»„ä»¶æ‰«æ


### 4.1 ä»€ä¹ˆæ˜¯Beanæ³¨å†Œ


> ğŸ“– **é€šä¿—ç†è§£**ï¼šBeanå°±æ˜¯Springå®¹å™¨ç®¡ç†çš„å¯¹è±¡
> - ä¸ç”¨æˆ‘ä»¬æ‰‹åŠ¨newå¯¹è±¡
> - Springè‡ªåŠ¨åˆ›å»ºå’Œç®¡ç†
> - éœ€è¦æ—¶ç›´æ¥æ³¨å…¥ä½¿ç”¨

**Beanæ³¨å†Œè¿‡ç¨‹ç¤ºæ„**ï¼š
```
åº”ç”¨å¯åŠ¨
   â†“
Springæ‰«æå¸¦æœ‰æ³¨è§£çš„ç±»
   â†“
åˆ›å»ºå¯¹è±¡å®ä¾‹
   â†“
å­˜å…¥Springå®¹å™¨ï¼ˆIOCå®¹å™¨ï¼‰
   â†“
å¯ä»¥éšæ—¶å–ç”¨
```

### 4.2 ç»„ä»¶æ‰«ææœºåˆ¶


**é»˜è®¤æ‰«æè§„åˆ™**ï¼š
```
å¯åŠ¨ç±»æ‰€åœ¨åŒ…
    â””â”€â”€ com.example.demo
         â”œâ”€â”€ DemoApplication.java (å¯åŠ¨ç±»)
         â”œâ”€â”€ controller (ä¼šæ‰«æ) âœ“
         â”œâ”€â”€ service (ä¼šæ‰«æ) âœ“
         â””â”€â”€ mapper (ä¼šæ‰«æ) âœ“

å…¶ä»–åŒ…
    â””â”€â”€ com.other.package (ä¸ä¼šæ‰«æ) âœ—
```

**å¯åŠ¨ç±»çš„å…³é”®æ³¨è§£**ï¼š
```java
@SpringBootApplication  // è¿™ä¸ªæ³¨è§£åŒ…å«äº†æ‰«æåŠŸèƒ½
public class DemoApplication {
    public static void main(String[] args) {
        SpringApplication.run(DemoApplication.class, args);
    }
}
```

### 4.3 @Controlleræ³¨å†Œæµç¨‹


**å®Œæ•´æµç¨‹å›¾**ï¼š
```
ç¬¬ä¸€æ­¥ï¼šç¼–å†™æ§åˆ¶å™¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  @Controller           â”‚
â”‚  public class UserCtrl â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
ç¬¬äºŒæ­¥ï¼šSpringå¯åŠ¨æ‰«æ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‘ç°@Controlleræ³¨è§£    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºBean
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åˆ›å»ºUserCtrlå¯¹è±¡       â”‚
â”‚  é»˜è®¤åç§°ï¼šuserCtrl     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
ç¬¬å››æ­¥ï¼šå­˜å…¥å®¹å™¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  IOCå®¹å™¨               â”‚
â”‚  â”œâ”€ userCtrl           â”‚
â”‚  â”œâ”€ productCtrl        â”‚
â”‚  â””â”€ ...å…¶ä»–Bean        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 è‡ªå®šä¹‰Beanåç§°


```java
// é»˜è®¤åç§°ï¼šuserControllerï¼ˆé¦–å­—æ¯å°å†™ï¼‰
@Controller
public class UserController {
}

// è‡ªå®šä¹‰åç§°ï¼šmyUserCtrl
@Controller("myUserCtrl")
public class UserController {
}
```

### 4.5 è‡ªå®šä¹‰æ‰«æè·¯å¾„


```java
@SpringBootApplication
@ComponentScan(basePackages = {
    "com.example.demo",      // é»˜è®¤åŒ…
    "com.other.controller"   // é¢å¤–æ‰«æçš„åŒ…
})
public class DemoApplication {
}
```

> âš ï¸ **æ³¨æ„**ï¼šä¸€èˆ¬æƒ…å†µä¸‹ä¸éœ€è¦è‡ªå®šä¹‰æ‰«æè·¯å¾„ï¼Œéµå¾ªé»˜è®¤è§„åˆ™å³å¯

---

## 5. â±ï¸ æ§åˆ¶å™¨ç”Ÿå‘½å‘¨æœŸ


### 5.1 ç”Ÿå‘½å‘¨æœŸæ¦‚è¿°


> ğŸ’¡ **å…³é”®ç†è§£**ï¼šæ§åˆ¶å™¨ä»åˆ›å»ºåˆ°é”€æ¯çš„å®Œæ•´è¿‡ç¨‹

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**ï¼š
```
1. å®ä¾‹åŒ–ï¼ˆåˆ›å»ºå¯¹è±¡ï¼‰
   â†“
2. å±æ€§æ³¨å…¥ï¼ˆä¾èµ–æ³¨å…¥ï¼‰
   â†“
3. åˆå§‹åŒ–ï¼ˆå¯é€‰çš„åˆå§‹åŒ–æ–¹æ³•ï¼‰
   â†“
4. ä½¿ç”¨é˜¶æ®µï¼ˆå¤„ç†è¯·æ±‚ï¼‰
   â†“
5. é”€æ¯ï¼ˆåº”ç”¨å…³é—­æ—¶ï¼‰
```

### 5.2 åˆ›å»ºæ—¶æœº


**é»˜è®¤æƒ…å†µ**ï¼šSpringå®¹å™¨å¯åŠ¨æ—¶åˆ›å»º

```java
@RestController
public class DemoController {
    
    // æ„é€ æ–¹æ³•ï¼Œåˆ›å»ºæ—¶æ‰§è¡Œ
    public DemoController() {
        System.out.println("DemoController è¢«åˆ›å»ºäº†ï¼");
        // è¿™å¥è¯åœ¨åº”ç”¨å¯åŠ¨æ—¶å°±ä¼šæ‰“å°
    }
}
```

**è§‚å¯Ÿåˆ›å»ºæ—¶æœº**ï¼š
```
å¯åŠ¨Spring Bootåº”ç”¨
   â†“
æ§åˆ¶å°è¾“å‡ºï¼šDemoController è¢«åˆ›å»ºäº†ï¼
   â†“
åº”ç”¨å¯åŠ¨å®Œæˆ
   â†“
æ§åˆ¶å™¨å·²ç»åœ¨å®¹å™¨ä¸­ï¼Œç­‰å¾…å¤„ç†è¯·æ±‚
```

### 5.3 åˆå§‹åŒ–æ–¹æ³•


```java
@RestController
public class UserController {
    
    private UserService userService;
    
    // æ–¹å¼1ï¼šæ„é€ æ–¹æ³•æ³¨å…¥ï¼ˆæ¨èï¼‰
    public UserController(UserService userService) {
        this.userService = userService;
        System.out.println("æ§åˆ¶å™¨åˆ›å»ºï¼Œä¾èµ–æ³¨å…¥å®Œæˆ");
    }
    
    // æ–¹å¼2ï¼šä½¿ç”¨@PostConstructï¼ˆåˆå§‹åŒ–æ–¹æ³•ï¼‰
    @PostConstruct
    public void init() {
        System.out.println("æ§åˆ¶å™¨åˆå§‹åŒ–å®Œæˆï¼Œå¯ä»¥åšä¸€äº›å‡†å¤‡å·¥ä½œ");
        // ä¾‹å¦‚ï¼šåŠ è½½é…ç½®ã€é¢„çƒ­ç¼“å­˜ç­‰
    }
    
    // æ–¹å¼3ï¼šé”€æ¯å‰æ‰§è¡Œ
    @PreDestroy
    public void destroy() {
        System.out.println("æ§åˆ¶å™¨å³å°†é”€æ¯ï¼Œæ¸…ç†èµ„æº");
    }
}
```

**æ‰§è¡Œé¡ºåº**ï¼š
```
1. æ„é€ æ–¹æ³• â†’ "æ§åˆ¶å™¨åˆ›å»ºï¼Œä¾èµ–æ³¨å…¥å®Œæˆ"
2. @PostConstruct â†’ "æ§åˆ¶å™¨åˆå§‹åŒ–å®Œæˆ..."
3. å¤„ç†è¯·æ±‚ï¼ˆä½¿ç”¨é˜¶æ®µï¼‰
4. @PreDestroy â†’ "æ§åˆ¶å™¨å³å°†é”€æ¯..." ï¼ˆåº”ç”¨å…³é—­æ—¶ï¼‰
```

### 5.4 æ‡’åŠ è½½æ–¹å¼


```java
@RestController
@Lazy  // æ‡’åŠ è½½ï¼šç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶æ‰åˆ›å»º
public class LazyController {
    
    public LazyController() {
        System.out.println("LazyController è¢«åˆ›å»ºäº†ï¼");
        // è¿™å¥è¯åœ¨ç¬¬ä¸€æ¬¡è®¿é—®è¯¥æ§åˆ¶å™¨æ—¶æ‰æ‰“å°
    }
}
```

**å¯¹æ¯”ç†è§£**ï¼š

| åŠ è½½æ–¹å¼ | åˆ›å»ºæ—¶æœº | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|---------|---------|------|------|
| **é»˜è®¤ï¼ˆé¥¿æ±‰ï¼‰** | å¯åŠ¨æ—¶åˆ›å»º | å¯åŠ¨åå“åº”å¿« | å¯åŠ¨ç¨æ…¢ |
| **æ‡’åŠ è½½** | é¦–æ¬¡ä½¿ç”¨æ—¶åˆ›å»º | å¯åŠ¨å¿« | é¦–æ¬¡è¯·æ±‚æ…¢ |

---

## 6. ğŸ”’ å•ä¾‹æ¨¡å¼ä¸çº¿ç¨‹å®‰å…¨


### 6.1 ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼


> ğŸ“– **é€šä¿—è§£é‡Š**ï¼šæ•´ä¸ªåº”ç”¨ä¸­ï¼Œä¸€ä¸ªæ§åˆ¶å™¨ç±»åªåˆ›å»ºä¸€ä¸ªå¯¹è±¡
> - ä¸ç®¡å¤šå°‘ä¸ªç”¨æˆ·è®¿é—®
> - ä¸ç®¡å¤šå°‘ä¸ªè¯·æ±‚è¿‡æ¥
> - éƒ½æ˜¯åŒä¸€ä¸ªæ§åˆ¶å™¨å¯¹è±¡åœ¨å¤„ç†

**å•ä¾‹ç¤ºæ„å›¾**ï¼š
```
ç”¨æˆ·Aè¯·æ±‚ â†’ 
ç”¨æˆ·Bè¯·æ±‚ â†’  åŒä¸€ä¸ªUserControllerå¯¹è±¡å¤„ç†
ç”¨æˆ·Cè¯·æ±‚ â†’ 
ç”¨æˆ·Dè¯·æ±‚ â†’
```

### 6.2 éªŒè¯å•ä¾‹


```java
@RestController
public class SingletonController {
    
    public SingletonController() {
        System.out.println("æ§åˆ¶å™¨åˆ›å»ºï¼ŒhashCode: " + this.hashCode());
    }
    
    @GetMapping("/test")
    public String test() {
        return "å½“å‰å¯¹è±¡ï¼š" + this.hashCode();
    }
}
```

**è®¿é—®éªŒè¯**ï¼š
```
ç¬¬1æ¬¡è®¿é—® /test â†’ è¿”å›ï¼šå½“å‰å¯¹è±¡ï¼š123456789
ç¬¬2æ¬¡è®¿é—® /test â†’ è¿”å›ï¼šå½“å‰å¯¹è±¡ï¼š123456789  (ç›¸åŒ)
ç¬¬3æ¬¡è®¿é—® /test â†’ è¿”å›ï¼šå½“å‰å¯¹è±¡ï¼š123456789  (ç›¸åŒ)

ç»“è®ºï¼šå§‹ç»ˆæ˜¯åŒä¸€ä¸ªå¯¹è±¡
```

### 6.3 ä¸ºä»€ä¹ˆè¦ç”¨å•ä¾‹


**ä¼˜ç‚¹**ï¼š
- âœ… **èŠ‚çœå†…å­˜**ï¼šåªåˆ›å»ºä¸€ä¸ªå¯¹è±¡
- âœ… **æé«˜æ€§èƒ½**ï¼šé¿å…é‡å¤åˆ›å»ºé”€æ¯
- âœ… **ä¾¿äºç®¡ç†**ï¼šç»Ÿä¸€ç»´æŠ¤

**å•ä¾‹çš„å†…å­˜å¯¹æ¯”**ï¼š
```
éå•ä¾‹æ¨¡å¼ï¼ˆå‡è®¾ï¼‰ï¼š
è¯·æ±‚1 â†’ åˆ›å»ºå¯¹è±¡A â†’ å¤„ç† â†’ é”€æ¯
è¯·æ±‚2 â†’ åˆ›å»ºå¯¹è±¡B â†’ å¤„ç† â†’ é”€æ¯
è¯·æ±‚3 â†’ åˆ›å»ºå¯¹è±¡C â†’ å¤„ç† â†’ é”€æ¯
å†…å­˜å ç”¨ï¼š3ä¸ªå¯¹è±¡çš„ç©ºé—´

å•ä¾‹æ¨¡å¼ï¼ˆå®é™…ï¼‰ï¼š
è¯·æ±‚1 â†’ 
è¯·æ±‚2 â†’  ä½¿ç”¨åŒä¸€ä¸ªå¯¹è±¡A â†’ å¤„ç†
è¯·æ±‚3 â†’ 
å†…å­˜å ç”¨ï¼š1ä¸ªå¯¹è±¡çš„ç©ºé—´
```

### 6.4 çº¿ç¨‹å®‰å…¨é—®é¢˜


> âš ï¸ **é‡è¦è­¦å‘Š**ï¼šå•ä¾‹æ§åˆ¶å™¨åœ¨å¤šçº¿ç¨‹ä¸‹å¯èƒ½å‡ºé—®é¢˜ï¼

**é—®é¢˜ç¤ºä¾‹ï¼ˆé”™è¯¯å†™æ³•ï¼‰**ï¼š
```java
@RestController
public class UnsafeController {
    
    private int count = 0;  // âŒ æˆå‘˜å˜é‡ï¼Œå¤šçº¿ç¨‹ä¸å®‰å…¨ï¼
    
    @GetMapping("/count")
    public int getCount() {
        count++;  // å¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹ï¼Œä¼šå‡ºé”™
        return count;
    }
}
```

**é—®é¢˜åˆ†æ**ï¼š
```
çº¿ç¨‹Aæ‰§è¡Œï¼šè¯»å–count=0 â†’ åŠ 1 â†’ count=1
çº¿ç¨‹Bæ‰§è¡Œï¼šè¯»å–count=0 â†’ åŠ 1 â†’ count=1  (æœŸæœ›æ˜¯2ï¼Œå®é™…æ˜¯1)
ç»“æœï¼šæ•°æ®é”™ä¹±
```

### 6.5 çº¿ç¨‹å®‰å…¨çš„æ­£ç¡®å†™æ³•


**æ–¹æ¡ˆ1ï¼šä¸ç”¨æˆå‘˜å˜é‡ï¼ˆæ¨èï¼‰**
```java
@RestController
public class SafeController {
    
    @GetMapping("/process")
    public String process(String data) {
        // ä½¿ç”¨å±€éƒ¨å˜é‡ï¼Œçº¿ç¨‹å®‰å…¨
        String result = data.toUpperCase();
        return result;
    }
}
```

**æ–¹æ¡ˆ2ï¼šæˆå‘˜å˜é‡ä½¿ç”¨æ— çŠ¶æ€å¯¹è±¡**
```java
@RestController
public class SafeController2 {
    
    @Autowired
    private UserService userService;  // âœ“ Serviceé€šå¸¸æ˜¯æ— çŠ¶æ€çš„ï¼Œå®‰å…¨
    
    @GetMapping("/user/{id}")
    public User getUser(@PathVariable Long id) {
        return userService.findById(id);
    }
}
```

**æ–¹æ¡ˆ3ï¼šéœ€è¦çŠ¶æ€æ—¶ä½¿ç”¨å±€éƒ¨å˜é‡**
```java
@RestController
public class SafeController3 {
    
    @GetMapping("/calculate")
    public int calculate(int num) {
        int temp = num;  // å±€éƒ¨å˜é‡ï¼Œæ¯ä¸ªçº¿ç¨‹ç‹¬ç«‹
        temp = temp * 2;
        return temp;
    }
}
```

**æ–¹æ¡ˆ4ï¼šä½¿ç”¨ThreadLocalï¼ˆé«˜çº§ï¼‰**
```java
@RestController
public class ThreadLocalController {
    
    private ThreadLocal<Integer> count = ThreadLocal.withInitial(() -> 0);
    
    @GetMapping("/count")
    public int getCount() {
        int value = count.get();
        count.set(value + 1);
        return count.get();
        // æ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±ç‹¬ç«‹çš„countå‰¯æœ¬
    }
}
```

### 6.6 çº¿ç¨‹å®‰å…¨æœ€ä½³å®è·µ


âœ… **æ¨èåšæ³•**ï¼š
- æ§åˆ¶å™¨ä¸ä¿å­˜çŠ¶æ€ï¼ˆæ— çŠ¶æ€ï¼‰
- ä¸ä½¿ç”¨æˆå‘˜å˜é‡å­˜å‚¨è¯·æ±‚ç›¸å…³æ•°æ®
- è¯·æ±‚æ•°æ®é€šè¿‡å‚æ•°ä¼ é€’
- Serviceå±‚å¯¹è±¡å¯ä»¥ä½œä¸ºæˆå‘˜å˜é‡ï¼ˆé€šå¸¸æ— çŠ¶æ€ï¼‰

âŒ **é¿å…åšæ³•**ï¼š
```java
// âŒ é”™è¯¯ç¤ºä¾‹
@RestController
public class BadController {
    private User currentUser;  // å¤šçº¿ç¨‹ä¼šç›¸äº’è¦†ç›–
    private List<String> tempList = new ArrayList<>();  // å¤šçº¿ç¨‹ä¸å®‰å…¨
}

// âœ“ æ­£ç¡®ç¤ºä¾‹
@RestController
public class GoodController {
    @Autowired
    private UserService userService;  // å¯ä»¥ï¼ŒServiceæ— çŠ¶æ€
    
    @GetMapping("/user")
    public User getUser(Long userId) {
        User user = userService.findById(userId);  // å±€éƒ¨å˜é‡ï¼Œå®‰å…¨
        return user;
    }
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æ§åˆ¶å™¨ï¼šå¤„ç†è¯·æ±‚çš„å…¥å£ï¼Œä¸å†™ä¸šåŠ¡é€»è¾‘
ğŸ”¸ @Controllerï¼šè¿”å›è§†å›¾é¡µé¢ï¼Œç”¨äºä¼ ç»ŸWebåº”ç”¨
ğŸ”¸ @RestControllerï¼šè¿”å›JSONæ•°æ®ï¼Œç”¨äºå‰åç«¯åˆ†ç¦»
ğŸ”¸ Beanæ³¨å†Œï¼šSpringè‡ªåŠ¨åˆ›å»ºå’Œç®¡ç†å¯¹è±¡
ğŸ”¸ ç»„ä»¶æ‰«æï¼šè‡ªåŠ¨å‘ç°å’Œæ³¨å†Œå¸¦æ³¨è§£çš„ç±»
ğŸ”¸ ç”Ÿå‘½å‘¨æœŸï¼šåˆ›å»ºâ†’åˆå§‹åŒ–â†’ä½¿ç”¨â†’é”€æ¯
ğŸ”¸ å•ä¾‹æ¨¡å¼ï¼šä¸€ä¸ªç±»åªåˆ›å»ºä¸€ä¸ªå¯¹è±¡
ğŸ”¸ çº¿ç¨‹å®‰å…¨ï¼šå•ä¾‹ä¸‹é¿å…ä½¿ç”¨æˆå‘˜å˜é‡ä¿å­˜çŠ¶æ€
```

### 7.2 ä¸¤ä¸ªæ³¨è§£çš„é€‰æ‹©


| åœºæ™¯ | ä½¿ç”¨æ³¨è§£ | åŸå›  |
|------|---------|------|
| è¿”å›HTMLé¡µé¢ | `@Controller` | è¿”å›å€¼æ˜¯è§†å›¾åç§° |
| è¿”å›JSONæ•°æ® | `@RestController` | è‡ªåŠ¨è½¬æ¢ä¸ºJSON |
| å‰åç«¯åˆ†ç¦»é¡¹ç›® | `@RestController` | æä¾›APIæ¥å£ |
| ä¼ ç»ŸSSMé¡¹ç›® | `@Controller` | ç»“åˆJSP/Thymeleaf |

### 7.3 çº¿ç¨‹å®‰å…¨è®°å¿†è¦ç‚¹


**ç®€å•åˆ¤æ–­è§„åˆ™**ï¼š
```
æ§åˆ¶å™¨æˆå‘˜å˜é‡ â†’ å¤šçº¿ç¨‹å…±äº« â†’ å¯èƒ½ä¸å®‰å…¨
æ–¹æ³•å±€éƒ¨å˜é‡ â†’ çº¿ç¨‹ç‹¬ç«‹ â†’ å®‰å…¨
```

**å®‰å…¨å†™æ³•å£è¯€**ï¼š
- æ§åˆ¶å™¨æ— çŠ¶æ€ï¼Œæˆå‘˜ä¸å­˜æ•°æ®
- è¯·æ±‚å‚æ•°ä¼ ï¼Œå±€éƒ¨å˜é‡ä½³
- Serviceå¯æ³¨å…¥ï¼Œé€šå¸¸éƒ½æ— çŠ¶æ€
- éœ€è¦è®°çŠ¶æ€ï¼ŒThreadLocalå¸®å¿™

### 7.4 å®é™…å¼€å‘å»ºè®®


1. **å‰åç«¯åˆ†ç¦»é¡¹ç›®**ï¼šç»Ÿä¸€ä½¿ç”¨ `@RestController`
2. **ä¼ ç»Ÿé¡¹ç›®**ï¼šä½¿ç”¨ `@Controller` + æ¨¡æ¿å¼•æ“
3. **æ··åˆé¡¹ç›®**ï¼šæŒ‰æ¥å£ç±»å‹åˆ†åˆ«ä½¿ç”¨
4. **çº¿ç¨‹å®‰å…¨**ï¼šæ§åˆ¶å™¨ä¿æŒæ— çŠ¶æ€è®¾è®¡

**æ ‡å‡†æ§åˆ¶å™¨æ¨¡æ¿**ï¼š
```java
@RestController
@RequestMapping("/api/user")
public class UserController {
    
    @Autowired
    private UserService userService;  // æ³¨å…¥Service
    
    @GetMapping("/{id}")
    public User getUser(@PathVariable Long id) {
        return userService.findById(id);  // è°ƒç”¨ä¸šåŠ¡é€»è¾‘
    }
}
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- æ§åˆ¶å™¨æ˜¯è¯·æ±‚çš„æ¥å¾…å‘˜ï¼Œä¸å¹²æ´»åªåˆ†é…ä»»åŠ¡
- @Controllerè¿”å›é¡µé¢ï¼Œ@RestControllerè¿”å›æ•°æ®
- å•ä¾‹æ¨¡å¼çœå†…å­˜ï¼Œä½†è¦æ³¨æ„çº¿ç¨‹å®‰å…¨
- æ§åˆ¶å™¨ä¸å­˜çŠ¶æ€ï¼Œå±€éƒ¨å˜é‡æœ€å®‰å…¨