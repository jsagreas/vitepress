---
title: 3ã€Spring MVCä¸Springæ•´åˆ
---
## ğŸ“š ç›®å½•

1. [Spring MVCä¸Springçš„å…³ç³»](#1-Spring-MVCä¸Springçš„å…³ç³»)
2. [IoCå®¹å™¨é›†æˆåŸç†](#2-IoCå®¹å™¨é›†æˆåŸç†)
3. [ä¾èµ–æ³¨å…¥åœ¨MVCä¸­çš„åº”ç”¨](#3-ä¾èµ–æ³¨å…¥åœ¨MVCä¸­çš„åº”ç”¨)
4. [AOPåˆ‡é¢æ”¯æŒ](#4-AOPåˆ‡é¢æ”¯æŒ)
5. [Beanç”Ÿå‘½å‘¨æœŸç®¡ç†](#5-Beanç”Ÿå‘½å‘¨æœŸç®¡ç†)
6. [é…ç½®æ–¹å¼è¯¦è§£](#6-é…ç½®æ–¹å¼è¯¦è§£)
7. [æ³¨è§£é©±åŠ¨å¼€å‘](#7-æ³¨è§£é©±åŠ¨å¼€å‘)
8. [æ¨¡å—è§£è€¦å®è·µ](#8-æ¨¡å—è§£è€¦å®è·µ)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ Spring MVCä¸Springçš„å…³ç³»


### 1.1 å®ƒä»¬æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ


**é€šä¿—ç†è§£ï¼š**
æƒ³è±¡Springæ˜¯ä¸€ä¸ªå¤§å‹**å·¥å…·ç®±**ï¼Œé‡Œé¢æœ‰å„ç§å·¥å…·ï¼ˆåŠŸèƒ½æ¨¡å—ï¼‰ã€‚Spring MVCå°±æ˜¯è¿™ä¸ªå·¥å…·ç®±é‡Œä¸“é—¨ç”¨æ¥**å¤„ç†ç½‘é¡µè¯·æ±‚**çš„é‚£ä¸€å¥—å·¥å…·ã€‚

```
ğŸ¢ Springå…¨å®¶æ¡¶
â”œâ”€â”€ ğŸ”§ Spring Core (æ ¸å¿ƒå®¹å™¨ - å·¥å…·ç®±æœ¬ä½“)
â”œâ”€â”€ ğŸŒ Spring MVC (Webå±‚ - å¤„ç†ç½‘é¡µè¯·æ±‚)
â”œâ”€â”€ ğŸ—„ï¸ Spring Data (æ•°æ®å±‚ - æ“ä½œæ•°æ®åº“)
â”œâ”€â”€ ğŸ”’ Spring Security (å®‰å…¨å±‚ - æƒé™æ§åˆ¶)
â””â”€â”€ â˜ï¸ Spring Cloud (äº‘æœåŠ¡ - å¾®æœåŠ¡)
```

**ä¸“ä¸šå®šä¹‰ï¼š**
- **Spring Framework**ï¼šæä¾›IoCå®¹å™¨ã€AOPã€äº‹åŠ¡ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½çš„åŸºç¡€æ¡†æ¶
- **Spring MVC**ï¼šåŸºäºSpringæ ¸å¿ƒçš„Webå±‚æ¡†æ¶ï¼Œä¸“æ³¨äºå¤„ç†HTTPè¯·æ±‚å’Œå“åº”

### 1.2 ä¾èµ–å…³ç³»å›¾ç¤º


```
        ç”¨æˆ·æµè§ˆå™¨
            â†“ HTTPè¯·æ±‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  Spring MVCå±‚   â”‚ â† å¤„ç†Webè¯·æ±‚
     â”‚  (æ§åˆ¶å™¨/è§†å›¾)   â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“ è°ƒç”¨
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  Spring Coreå±‚  â”‚ â† ç®¡ç†å¯¹è±¡å’Œä¾èµ–
     â”‚  (IoCå®¹å™¨/AOP)  â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“ æ“ä½œ
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚    æ•°æ®è®¿é—®å±‚    â”‚ â† æ•°æ®åº“äº¤äº’
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> ğŸ’¡ **æ–°æ‰‹æç¤º**
> 
> Spring MVC **ä¸èƒ½**å•ç‹¬ä½¿ç”¨ï¼Œå¿…é¡»ä¾èµ–Spring Coreã€‚å°±åƒæ±½è½¦çš„æ–¹å‘ç›˜ä¸èƒ½ç¦»å¼€è½¦èº«ä¸€æ ·ã€‚

### 1.3 ä¸ºä»€ä¹ˆè¦æ•´åˆï¼Ÿ


**ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿å¯¹æ¯”**

| æ•´åˆå‰çš„é—®é¢˜ | æ•´åˆåçš„è§£å†³æ–¹æ¡ˆ | å®é™…å¥½å¤„ |
|------------|----------------|---------|
| å¯¹è±¡åˆ›å»ºæ··ä¹± | IoCå®¹å™¨ç»Ÿä¸€ç®¡ç† | ä»£ç æ›´æ•´æ´ |
| åŠŸèƒ½ä»£ç é‡å¤ | AOPç»Ÿä¸€å¤„ç† | å‡å°‘å†—ä½™ |
| é…ç½®åˆ†æ•£éš¾æ‰¾ | ç»Ÿä¸€é…ç½®å…¥å£ | ç»´æŠ¤æ›´ç®€å• |
| æ¨¡å—è€¦åˆä¸¥é‡ | ä¾èµ–æ³¨å…¥è§£è€¦ | æ‰©å±•æ›´çµæ´» |

---

## 2. ğŸ”§ IoCå®¹å™¨é›†æˆåŸç†


### 2.1 ä»€ä¹ˆæ˜¯IoCå®¹å™¨ï¼Ÿ


**ğŸ­ å½¢è±¡æ¯”å–»ï¼šå¯¹è±¡å·¥å‚**

ä¼ ç»Ÿå¼€å‘å°±åƒ**è‡ªå·±åšé¥­**ï¼š
```
æˆ‘æƒ³åƒé¥­ â†’ æˆ‘ä¹°èœ â†’ æˆ‘æ´—èœ â†’ æˆ‘ç‚’èœ â†’ æˆ‘åƒé¥­
(éœ€è¦è‡ªå·±åˆ›å»ºå¯¹è±¡ã€ç®¡ç†ä¾èµ–å…³ç³»)
```

IoCå®¹å™¨å°±åƒ**å¤–å–å¹³å°**ï¼š
```
æˆ‘æƒ³åƒé¥­ â†’ å‘Šè¯‰å¤–å–å¹³å° â†’ å¤–å–é€åˆ° â†’ æˆ‘åƒé¥­
(åªéœ€å£°æ˜éœ€è¦ä»€ä¹ˆï¼Œå®¹å™¨è‡ªåŠ¨æä¾›)
```

**ğŸ“‹ ä¸“ä¸šè§£é‡Šï¼š**
- **IoC** = Inversion of Controlï¼ˆæ§åˆ¶åè½¬ï¼‰
- **ä½œç”¨**ï¼šæŠŠå¯¹è±¡çš„åˆ›å»ºã€ç®¡ç†ã€é”€æ¯æƒé™äº¤ç»™Springå®¹å™¨
- **å¥½å¤„**ï¼šå¼€å‘è€…åªç®¡ä½¿ç”¨ï¼Œä¸ç®¡åˆ›å»º

### 2.2 Spring MVCä¸­çš„ä¸¤ä¸ªå®¹å™¨


**ğŸ—ï¸ çˆ¶å­å®¹å™¨ç»“æ„**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Root WebApplicationContext     â”‚ â† çˆ¶å®¹å™¨
â”‚     (Springæ ¹å®¹å™¨ - ContextLoaderListenerå¯åŠ¨)â”‚
â”‚                                     â”‚
â”‚  ğŸ“¦ Serviceå±‚Bean                   â”‚
â”‚  ğŸ“¦ DAOå±‚Bean                       â”‚
â”‚  ğŸ“¦ æ•°æ®æºBean                       â”‚
â”‚  ğŸ“¦ äº‹åŠ¡ç®¡ç†å™¨                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†‘ å¯ä»¥è®¿é—®çˆ¶å®¹å™¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     WebApplicationContext           â”‚ â† å­å®¹å™¨
â”‚    (Spring MVCå®¹å™¨ - DispatcherServletå¯åŠ¨)â”‚
â”‚                                     â”‚
â”‚  ğŸŒ Controllerå±‚Bean                â”‚
â”‚  ğŸ¨ è§†å›¾è§£æå™¨                       â”‚
â”‚  ğŸ”§ å¤„ç†å™¨æ˜ å°„å™¨                     â”‚
â”‚  âš™ï¸ æ‹¦æˆªå™¨                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> âš ï¸ **é‡è¦è§„åˆ™**
> 
> - å­å®¹å™¨ï¼ˆMVCï¼‰å¯ä»¥è®¿é—®çˆ¶å®¹å™¨ï¼ˆSpringï¼‰çš„Bean
> - çˆ¶å®¹å™¨**ä¸èƒ½**è®¿é—®å­å®¹å™¨çš„Bean
> - Controllerå¯ä»¥æ³¨å…¥Serviceï¼Œä½†Service**ä¸èƒ½**æ³¨å…¥Controller

### 2.3 å®¹å™¨å¯åŠ¨æ—¶åºå›¾


```
WebæœåŠ¡å™¨å¯åŠ¨
      â†“
  [1] åŠ è½½web.xmlé…ç½®
      â†“
  [2] ContextLoaderListenerç›‘å¬å™¨å¯åŠ¨
      â†“
  [3] åˆ›å»ºRoot WebApplicationContext (çˆ¶å®¹å™¨)
      â†“ 
  [4] æ‰«æå¹¶æ³¨å†ŒService/DAOç­‰Bean
      â†“
  [5] DispatcherServletåˆå§‹åŒ–
      â†“
  [6] åˆ›å»ºWebApplicationContext (å­å®¹å™¨)
      â†“
  [7] æ‰«æå¹¶æ³¨å†ŒControllerç­‰Bean
      â†“
  [8] åˆå§‹åŒ–MVCç»„ä»¶(å¤„ç†å™¨æ˜ å°„å™¨/è§†å›¾è§£æå™¨ç­‰)
      â†“
  [9] åº”ç”¨å¯åŠ¨å®Œæˆï¼Œç­‰å¾…è¯·æ±‚
```

### 2.4 å®é™…é…ç½®ç¤ºä¾‹


**ğŸ“ web.xmlæ ¸å¿ƒé…ç½®**

```xml
<!-- ç¬¬ä¸€æ­¥ï¼šé…ç½®Springæ ¹å®¹å™¨ -->
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>classpath:applicationContext.xml</param-value>
</context-param>

<!-- å¯åŠ¨Springå®¹å™¨çš„ç›‘å¬å™¨ -->
<listener>
    <listener-class>
        org.springframework.web.context.ContextLoaderListener
    </listener-class>
</listener>

<!-- ç¬¬äºŒæ­¥ï¼šé…ç½®Spring MVCå‰ç«¯æ§åˆ¶å™¨ -->
<servlet>
    <servlet-name>dispatcherServlet</servlet-name>
    <servlet-class>
        org.springframework.web.servlet.DispatcherServlet
    </servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>classpath:spring-mvc.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>
```

---

## 3. ğŸ’‰ ä¾èµ–æ³¨å…¥åœ¨MVCä¸­çš„åº”ç”¨


### 3.1 ä¾èµ–æ³¨å…¥æ˜¯ä»€ä¹ˆï¼Ÿ


**ğŸ”Œ ç”Ÿæ´»ä¸­çš„ä¾‹å­**

ä¸ç”¨ä¾èµ–æ³¨å…¥ = **ç¡¬è¿æ¥**ï¼š
```
ç”µè„‘ä¸»æœº â† ç›´æ¥ç„Šæ­» â† æ˜¾ç¤ºå™¨
(æ¢æ˜¾ç¤ºå™¨éœ€è¦æ‹†ä¸»æœºï¼Œè€¦åˆä¸¥é‡)
```

ä½¿ç”¨ä¾èµ–æ³¨å…¥ = **æ’åº§æ¥å£**ï¼š
```
ç”µè„‘ä¸»æœº â† HDMIçº¿ â† æ˜¾ç¤ºå™¨
(æ¢æ˜¾ç¤ºå™¨åªéœ€æ‹”æ’çº¿ï¼Œçµæ´»æ–¹ä¾¿)
```

**ğŸ“š ä¸“ä¸šæœ¯è¯­ï¼š**
- **DI** = Dependency Injectionï¼ˆä¾èµ–æ³¨å…¥ï¼‰
- **ç›®çš„**ï¼šå¯¹è±¡ä¹‹é—´ä¸ç›´æ¥åˆ›å»ºä¾èµ–ï¼Œç”±å®¹å™¨è‡ªåŠ¨æ³¨å…¥
- **æœ¬è´¨**ï¼šé€šè¿‡æ„é€ å™¨ã€Setteræˆ–å­—æ®µï¼ŒæŠŠä¾èµ–å¯¹è±¡"æ³¨å…¥"è¿›æ¥

### 3.2 MVCä¸‰å±‚æ¶æ„çš„ä¾èµ–å…³ç³»


```
Controllerå±‚ (æ§åˆ¶å™¨)
    â†“ æ³¨å…¥
Serviceå±‚ (ä¸šåŠ¡é€»è¾‘)
    â†“ æ³¨å…¥  
DAOå±‚ (æ•°æ®è®¿é—®)
    â†“ æ³¨å…¥
DataSource (æ•°æ®æº)
```

**ğŸ¯ å®é™…æ¡ˆä¾‹ï¼šç”¨æˆ·ç™»å½•æµç¨‹**

```java
// 1. Controllerå±‚ - æ¥æ”¶è¯·æ±‚
@Controller
public class UserController {
    
    @Autowired  // â† è‡ªåŠ¨æ³¨å…¥Service
    private UserService userService;
    
    @RequestMapping("/login")
    public String login(String username, String password) {
        boolean success = userService.login(username, password);
        return success ? "success" : "fail";
    }
}

// 2. Serviceå±‚ - ä¸šåŠ¡é€»è¾‘
@Service
public class UserService {
    
    @Autowired  // â† è‡ªåŠ¨æ³¨å…¥DAO
    private UserDao userDao;
    
    public boolean login(String username, String password) {
        User user = userDao.findByUsername(username);
        return user != null && user.getPassword().equals(password);
    }
}

// 3. DAOå±‚ - æ•°æ®è®¿é—®
@Repository
public class UserDao {
    
    @Autowired  // â† è‡ªåŠ¨æ³¨å…¥JDBCæ¨¡æ¿
    private JdbcTemplate jdbcTemplate;
    
    public User findByUsername(String username) {
        // æŸ¥è¯¢æ•°æ®åº“...
    }
}
```

### 3.3 ä¸‰ç§æ³¨å…¥æ–¹å¼å¯¹æ¯”


| æ³¨å…¥æ–¹å¼ | ä»£ç ç¤ºä¾‹ | é€‚ç”¨åœºæ™¯ | ä¼˜ç¼ºç‚¹ |
|---------|---------|---------|--------|
| **æ„é€ å™¨æ³¨å…¥** | `public UserController(UserService service)` | å¿…éœ€ä¾èµ– | âœ… å¼ºåˆ¶ä¾èµ–<br>âŒ å‚æ•°å¤šæ—¶å¤æ‚ |
| **Setteræ³¨å…¥** | `public void setUserService(UserService service)` | å¯é€‰ä¾èµ– | âœ… çµæ´»å¯é€‰<br>âŒ å¯èƒ½å¿˜è®°è®¾ç½® |
| **å­—æ®µæ³¨å…¥** | `@Autowired private UserService service;` | å¿«é€Ÿå¼€å‘ | âœ… ç®€æ´æ–¹ä¾¿<br>âŒ éš¾ä»¥å•å…ƒæµ‹è¯• |

> ğŸ’¡ **æœ€ä½³å®è·µå»ºè®®**
> 
> - å¿…éœ€çš„ä¾èµ– â†’ ç”¨**æ„é€ å™¨æ³¨å…¥**
> - å¯é€‰çš„ä¾èµ– â†’ ç”¨**Setteræ³¨å…¥**  
> - å¿«é€ŸåŸå‹å¼€å‘ â†’ ç”¨**å­—æ®µæ³¨å…¥**

---

## 4. ğŸ­ AOPåˆ‡é¢æ”¯æŒ


### 4.1 ä»€ä¹ˆæ˜¯AOPï¼Ÿ


**ğŸ° åˆ‡è›‹ç³•çš„æ¯”å–»**

ä¼ ç»Ÿç¼–ç¨‹ = **é€å—å¤„ç†**ï¼š
```
è›‹ç³•å—1 â†’ åŠ å¥¶æ²¹ â†’ æ’’ç³–ç²‰ â†’ æ”¾æ¨±æ¡ƒ
è›‹ç³•å—2 â†’ åŠ å¥¶æ²¹ â†’ æ’’ç³–ç²‰ â†’ æ”¾æ¨±æ¡ƒ  (é‡å¤ä»£ç ï¼)
è›‹ç³•å—3 â†’ åŠ å¥¶æ²¹ â†’ æ’’ç³–ç²‰ â†’ æ”¾æ¨±æ¡ƒ
```

AOPç¼–ç¨‹ = **æ¨ªå‘åˆ‡ä¸€åˆ€**ï¼š
```
         åŠ å¥¶æ²¹å±‚ (ä¸€æ¬¡å¤„ç†æ‰€æœ‰)
            â†“
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ è›‹ç³•å—1    â”‚
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
      â”‚ è›‹ç³•å—2    â”‚  â† æ¨ªåˆ‡é¢ç»Ÿä¸€å¤„ç†
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
      â”‚ è›‹ç³•å—3    â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ“š ä¸“ä¸šå®šä¹‰ï¼š**
- **AOP** = Aspect Oriented Programmingï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰
- **ä½œç”¨**ï¼šæŠŠé‡å¤çš„æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆå¦‚æ—¥å¿—ã€äº‹åŠ¡ï¼‰æŠ½å–å‡ºæ¥ç»Ÿä¸€å¤„ç†
- **å¥½å¤„**ï¼šé¿å…ä»£ç é‡å¤ï¼Œä¸šåŠ¡é€»è¾‘æ›´æ¸…æ™°

### 4.2 Spring MVCä¸­çš„AOPåº”ç”¨åœºæ™¯


**ğŸ” å¸¸è§åˆ‡é¢åŠŸèƒ½**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Controller â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â†“
  ã€æƒé™æ£€æŸ¥åˆ‡é¢ã€‘ â† ç»Ÿä¸€éªŒè¯ç”¨æˆ·æƒé™
      â†“
  ã€æ—¥å¿—è®°å½•åˆ‡é¢ã€‘ â† ç»Ÿä¸€è®°å½•æ“ä½œæ—¥å¿—
      â†“  
  ã€æ€§èƒ½ç›‘æ§åˆ‡é¢ã€‘ â† ç»Ÿä¸€ç›‘æ§æ‰§è¡Œæ—¶é—´
      â†“
  ã€å¼‚å¸¸å¤„ç†åˆ‡é¢ã€‘ â† ç»Ÿä¸€å¤„ç†å¼‚å¸¸
      â†“
  ã€äº‹åŠ¡ç®¡ç†åˆ‡é¢ã€‘ â† ç»Ÿä¸€æ§åˆ¶äº‹åŠ¡
      â†“
  ä¸šåŠ¡æ–¹æ³•æ‰§è¡Œ
```

### 4.3 å®æˆ˜æ¡ˆä¾‹ï¼šControlleræ—¥å¿—åˆ‡é¢


**åœºæ™¯ï¼š** è‡ªåŠ¨è®°å½•æ‰€æœ‰Controlleræ–¹æ³•çš„è°ƒç”¨æ—¥å¿—

```java
@Aspect  // å£°æ˜è¿™æ˜¯ä¸€ä¸ªåˆ‡é¢
@Component
public class ControllerLogAspect {
    
    private static final Logger log = LoggerFactory.getLogger(ControllerLogAspect.class);
    
    // å®šä¹‰åˆ‡å…¥ç‚¹ï¼šæ‰€æœ‰Controllerå±‚çš„æ–¹æ³•
    @Pointcut("execution(* com.example.controller.*.*(..))")
    public void controllerMethods() {}
    
    // æ–¹æ³•æ‰§è¡Œå‰
    @Before("controllerMethods()")
    public void logBefore(JoinPoint joinPoint) {
        String methodName = joinPoint.getSignature().getName();
        Object[] args = joinPoint.getArgs();
        log.info("è°ƒç”¨æ–¹æ³•: {}, å‚æ•°: {}", methodName, args);
    }
    
    // æ–¹æ³•æ‰§è¡Œå
    @AfterReturning(pointcut = "controllerMethods()", returning = "result")
    public void logAfter(JoinPoint joinPoint, Object result) {
        String methodName = joinPoint.getSignature().getName();
        log.info("æ–¹æ³•: {} æ‰§è¡ŒæˆåŠŸ, è¿”å›å€¼: {}", methodName, result);
    }
    
    // å¼‚å¸¸å¤„ç†
    @AfterThrowing(pointcut = "controllerMethods()", throwing = "ex")
    public void logException(JoinPoint joinPoint, Exception ex) {
        String methodName = joinPoint.getSignature().getName();
        log.error("æ–¹æ³•: {} æ‰§è¡Œå¼‚å¸¸: {}", methodName, ex.getMessage());
    }
}
```

**ğŸ“Š æ‰§è¡Œæµç¨‹å›¾**

```
å®¢æˆ·ç«¯è¯·æ±‚
    â†“
DispatcherServletæ¥æ”¶
    â†“
ã€@Beforeåˆ‡é¢ã€‘ â†’ è®°å½•è¯·æ±‚å¼€å§‹æ—¥å¿—
    â†“
Controlleræ–¹æ³•æ‰§è¡Œ
    â†“ (æ­£å¸¸)          â†“ (å¼‚å¸¸)
ã€@AfterReturningã€‘  ã€@AfterThrowingã€‘
 è®°å½•æˆåŠŸæ—¥å¿—         è®°å½•å¼‚å¸¸æ—¥å¿—
    â†“                  â†“
è¿”å›å“åº”              è¿”å›é”™è¯¯é¡µé¢
```

### 4.4 AOPæ ¸å¿ƒæ¦‚å¿µé€Ÿè®°


| æ¦‚å¿µ | é€šä¿—ç†è§£ | ä»£ç æ³¨è§£ |
|------|---------|---------|
| **åˆ‡é¢(Aspect)** | åšä»€ä¹ˆäº‹çš„å·¥å…· | `@Aspect` |
| **åˆ‡å…¥ç‚¹(Pointcut)** | åœ¨å“ªé‡Œåš | `@Pointcut` |
| **é€šçŸ¥(Advice)** | ä»€ä¹ˆæ—¶å€™åš | `@Before/@After` |
| **è¿æ¥ç‚¹(JoinPoint)** | å…·ä½“çš„æ–¹æ³•è°ƒç”¨ç‚¹ | æ–¹æ³•å‚æ•° |

---

## 5. ğŸ”„ Beanç”Ÿå‘½å‘¨æœŸç®¡ç†


### 5.1 Beançš„ä¸€ç”Ÿï¼ˆç”Ÿå‘½å‘¨æœŸï¼‰


**ğŸ‘¶ Beanä»å‡ºç”Ÿåˆ°æ­»äº¡çš„å®Œæ•´è¿‡ç¨‹**

```
ğŸ“… Beanç”Ÿå‘½å‘¨æœŸæ—¶é—´çº¿

â”œâ”€ ğŸ£ å®ä¾‹åŒ–é˜¶æ®µ
â”‚   â””â”€ Springå®¹å™¨è¯»å–é…ç½® â†’ åå°„åˆ›å»ºBeanå¯¹è±¡
â”‚
â”œâ”€ ğŸ’‰ ä¾èµ–æ³¨å…¥é˜¶æ®µ  
â”‚   â””â”€ æ³¨å…¥å±æ€§å€¼ â†’ æ³¨å…¥ä¾èµ–å¯¹è±¡
â”‚
â”œâ”€ ğŸ”§ åˆå§‹åŒ–é˜¶æ®µ
â”‚   â”œâ”€ æ£€æŸ¥Awareæ¥å£ (BeanNameAware/ApplicationContextAware)
â”‚   â”œâ”€ æ‰§è¡ŒBeanPostProcessorå‰ç½®å¤„ç†
â”‚   â”œâ”€ è°ƒç”¨@PostConstructæ–¹æ³•
â”‚   â”œâ”€ è°ƒç”¨InitializingBean.afterPropertiesSet()
â”‚   â”œâ”€ è°ƒç”¨è‡ªå®šä¹‰init-method
â”‚   â””â”€ æ‰§è¡ŒBeanPostProcessoråç½®å¤„ç†
â”‚
â”œâ”€ âœ… ä½¿ç”¨é˜¶æ®µ
â”‚   â””â”€ Beanå·²å°±ç»ªï¼Œå¯ä»¥è¢«è°ƒç”¨
â”‚
â””â”€ ğŸ’€ é”€æ¯é˜¶æ®µ
    â”œâ”€ è°ƒç”¨@PreDestroyæ–¹æ³•
    â”œâ”€ è°ƒç”¨DisposableBean.destroy()
    â””â”€ è°ƒç”¨è‡ªå®šä¹‰destroy-method
```

### 5.2 å®æˆ˜æ¡ˆä¾‹ï¼šè‡ªå®šä¹‰ç”Ÿå‘½å‘¨æœŸ


```java
@Component
public class UserService implements InitializingBean, DisposableBean {
    
    private UserDao userDao;
    
    // 1ï¸âƒ£ æ„é€ å™¨ - å®ä¾‹åŒ–
    public UserService() {
        System.out.println("1. UserService æ„é€ å™¨æ‰§è¡Œ");
    }
    
    // 2ï¸âƒ£ ä¾èµ–æ³¨å…¥
    @Autowired
    public void setUserDao(UserDao userDao) {
        this.userDao = userDao;
        System.out.println("2. æ³¨å…¥ UserDao ä¾èµ–");
    }
    
    // 3ï¸âƒ£ åˆå§‹åŒ–æ–¹æ³•1 - @PostConstruct
    @PostConstruct
    public void init1() {
        System.out.println("3. @PostConstruct åˆå§‹åŒ–æ–¹æ³•æ‰§è¡Œ");
    }
    
    // 4ï¸âƒ£ åˆå§‹åŒ–æ–¹æ³•2 - InitializingBeanæ¥å£
    @Override
    public void afterPropertiesSet() throws Exception {
        System.out.println("4. InitializingBean.afterPropertiesSet() æ‰§è¡Œ");
    }
    
    // 5ï¸âƒ£ ä¸šåŠ¡æ–¹æ³• - ä½¿ç”¨é˜¶æ®µ
    public void doSomething() {
        System.out.println("5. æ‰§è¡Œä¸šåŠ¡æ–¹æ³•");
    }
    
    // 6ï¸âƒ£ é”€æ¯æ–¹æ³•1 - @PreDestroy
    @PreDestroy
    public void cleanup1() {
        System.out.println("6. @PreDestroy é”€æ¯æ–¹æ³•æ‰§è¡Œ");
    }
    
    // 7ï¸âƒ£ é”€æ¯æ–¹æ³•2 - DisposableBeanæ¥å£
    @Override
    public void destroy() throws Exception {
        System.out.println("7. DisposableBean.destroy() æ‰§è¡Œ");
    }
}
```

**ğŸ–¥ï¸ æ§åˆ¶å°è¾“å‡ºé¡ºåº**

```
1. UserService æ„é€ å™¨æ‰§è¡Œ
2. æ³¨å…¥ UserDao ä¾èµ–
3. @PostConstruct åˆå§‹åŒ–æ–¹æ³•æ‰§è¡Œ
4. InitializingBean.afterPropertiesSet() æ‰§è¡Œ
5. æ‰§è¡Œä¸šåŠ¡æ–¹æ³•
...åº”ç”¨è¿è¡Œä¸­...
6. @PreDestroy é”€æ¯æ–¹æ³•æ‰§è¡Œ
7. DisposableBean.destroy() æ‰§è¡Œ
```

### 5.3 Beanä½œç”¨åŸŸå¯¹æ¯”


| ä½œç”¨åŸŸ | è¯´æ˜ | ç”Ÿå‘½å‘¨æœŸ | ä½¿ç”¨åœºæ™¯ |
|-------|------|---------|---------|
| `singleton` | å•ä¾‹æ¨¡å¼ | å®¹å™¨å¯åŠ¨â†’å®¹å™¨å…³é—­ | æ— çŠ¶æ€Beanï¼ˆé»˜è®¤ï¼‰ |
| `prototype` | åŸå‹æ¨¡å¼ | æ¯æ¬¡è·å–â†’æ‰‹åŠ¨é”€æ¯ | æœ‰çŠ¶æ€Bean |
| `request` | è¯·æ±‚ä½œç”¨åŸŸ | è¯·æ±‚å¼€å§‹â†’è¯·æ±‚ç»“æŸ | Webè¯·æ±‚ç›¸å…³æ•°æ® |
| `session` | ä¼šè¯ä½œç”¨åŸŸ | ä¼šè¯åˆ›å»ºâ†’ä¼šè¯é”€æ¯ | ç”¨æˆ·ä¼šè¯ä¿¡æ¯ |

> âš ï¸ **æ–°æ‰‹æ˜“é”™ç‚¹**
> 
> - `singleton`æ˜¯**é»˜è®¤ä½œç”¨åŸŸ**ï¼Œæ•´ä¸ªåº”ç”¨å…±äº«ä¸€ä¸ªå®ä¾‹
> - `prototype`æ¯æ¬¡è·å–éƒ½æ˜¯**æ–°å®ä¾‹**ï¼ŒSpringä¸è´Ÿè´£é”€æ¯
> - Webä½œç”¨åŸŸåªèƒ½åœ¨Spring MVCç¯å¢ƒä½¿ç”¨

---

## 6. âš™ï¸ é…ç½®æ–¹å¼è¯¦è§£


### 6.1 ä¸‰ç§é…ç½®æ–¹å¼å¯¹æ¯”


**ğŸ”§ é…ç½®æ–¹å¼æ¼”è¿›å²**

```
2004å¹´ â†’ XMLé…ç½®æ—¶ä»£
         â””â”€ å¤§é‡XMLæ–‡ä»¶ï¼Œé…ç½®ç¹ç

2009å¹´ â†’ æ³¨è§£é…ç½®æ—¶ä»£  
         â””â”€ @Component/@Serviceç­‰æ³¨è§£

2014å¹´ â†’ Javaé…ç½®æ—¶ä»£
         â””â”€ @Configurationç±»ï¼Œé›¶XML
```

### 6.2 XMLé…ç½®æ–¹å¼


**ğŸ“„ applicationContext.xmlç¤ºä¾‹**

```xml
<!-- å¼€å¯ç»„ä»¶æ‰«æ -->
<context:component-scan base-package="com.example.service"/>

<!-- é…ç½®æ•°æ®æº -->
<bean id="dataSource" class="com.alibaba.druid.pool.DruidDataSource">
    <property name="driverClassName" value="com.mysql.jdbc.Driver"/>
    <property name="url" value="jdbc:mysql://localhost:3306/test"/>
    <property name="username" value="root"/>
    <property name="password" value="123456"/>
</bean>

<!-- é…ç½®äº‹åŠ¡ç®¡ç†å™¨ -->
<bean id="transactionManager" 
      class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
    <property name="dataSource" ref="dataSource"/>
</bean>

<!-- å¼€å¯äº‹åŠ¡æ³¨è§£ -->
<tx:annotation-driven transaction-manager="transactionManager"/>
```

**âœ… ä¼˜ç‚¹ï¼š** é…ç½®é›†ä¸­ï¼Œæ˜“äºæŸ¥æ‰¾å’Œä¿®æ”¹  
**âŒ ç¼ºç‚¹ï¼š** æ–‡ä»¶å†—é•¿ï¼Œç±»å‹ä¸å®‰å…¨

### 6.3 æ³¨è§£é…ç½®æ–¹å¼


**ğŸ·ï¸ æ ¸å¿ƒæ³¨è§£æ¸…å•**

```
ğŸ“¦ ç»„ä»¶æ‰«ææ³¨è§£
â”œâ”€ @Component     é€šç”¨ç»„ä»¶
â”œâ”€ @Controller    æ§åˆ¶å±‚ç»„ä»¶
â”œâ”€ @Service       æœåŠ¡å±‚ç»„ä»¶
â””â”€ @Repository    æ•°æ®è®¿é—®å±‚ç»„ä»¶

ğŸ’‰ ä¾èµ–æ³¨å…¥æ³¨è§£  
â”œâ”€ @Autowired     æŒ‰ç±»å‹è‡ªåŠ¨è£…é…
â”œâ”€ @Qualifier     æŒ‡å®šBeanåç§°
â”œâ”€ @Resource      æŒ‰åç§°è‡ªåŠ¨è£…é…
â””â”€ @Value         æ³¨å…¥é…ç½®å€¼

âš™ï¸ é…ç½®ç›¸å…³æ³¨è§£
â”œâ”€ @Configuration é…ç½®ç±»
â”œâ”€ @Bean          å®šä¹‰Bean
â”œâ”€ @PropertySource åŠ è½½å±æ€§æ–‡ä»¶
â””â”€ @ComponentScan ç»„ä»¶æ‰«æ
```

**ğŸ’» å®é™…ä»£ç ç¤ºä¾‹**

```java
// Serviceå±‚ä½¿ç”¨æ³¨è§£
@Service  // å£°æ˜ä¸ºServiceç»„ä»¶
@Transactional  // å¯ç”¨äº‹åŠ¡ç®¡ç†
public class UserService {
    
    @Autowired  // è‡ªåŠ¨æ³¨å…¥
    private UserDao userDao;
    
    @Value("${user.default.role}")  // æ³¨å…¥é…ç½®å€¼
    private String defaultRole;
    
    public void saveUser(User user) {
        user.setRole(defaultRole);
        userDao.save(user);
    }
}
```

### 6.4 Javaé…ç½®æ–¹å¼ï¼ˆç°ä»£æ¨èï¼‰


**â˜• é…ç½®ç±»ç¤ºä¾‹**

```java
@Configuration  // å£°æ˜è¿™æ˜¯é…ç½®ç±»
@ComponentScan("com.example")  // ç»„ä»¶æ‰«æ
@EnableTransactionManagement  // å¯ç”¨äº‹åŠ¡
@PropertySource("classpath:application.properties")  // åŠ è½½é…ç½®
public class AppConfig {
    
    @Value("${db.url}")
    private String dbUrl;
    
    // å®šä¹‰æ•°æ®æºBean
    @Bean
    public DataSource dataSource() {
        DruidDataSource ds = new DruidDataSource();
        ds.setUrl(dbUrl);
        ds.setUsername("root");
        ds.setPassword("123456");
        return ds;
    }
    
    // å®šä¹‰äº‹åŠ¡ç®¡ç†å™¨Bean
    @Bean
    public PlatformTransactionManager transactionManager(DataSource dataSource) {
        return new DataSourceTransactionManager(dataSource);
    }
}
```

**ğŸ“Š ä¸‰ç§é…ç½®æ–¹å¼å¯¹æ¯”**

| å¯¹æ¯”é¡¹ | XMLé…ç½® | æ³¨è§£é…ç½® | Javaé…ç½® |
|-------|---------|---------|---------|
| **ç±»å‹å®‰å…¨** | âŒ å¦ | âš ï¸ éƒ¨åˆ† | âœ… æ˜¯ |
| **é‡æ„å‹å¥½** | âŒ å¦ | âœ… æ˜¯ | âœ… æ˜¯ |
| **é…ç½®é›†ä¸­** | âœ… æ˜¯ | âŒ å¦ | âœ… æ˜¯ |
| **å­¦ä¹ éš¾åº¦** | â­â­â­ | â­â­ | â­â­â­â­ |
| **æ¨èæŒ‡æ•°** | â­â­ | â­â­â­â­ | â­â­â­â­â­ |

---

## 7. ğŸ¯ æ³¨è§£é©±åŠ¨å¼€å‘


### 7.1 ä»€ä¹ˆæ˜¯æ³¨è§£é©±åŠ¨ï¼Ÿ


**ğŸ”– æ³¨è§£çš„æœ¬è´¨**

ä¼ ç»Ÿå¼€å‘ = **è¯´æ˜ä¹¦ç¼–ç¨‹**ï¼š
```
ç¬¬ä¸€æ­¥ï¼šæ‰“å¼€XMLæ–‡ä»¶
ç¬¬äºŒæ­¥ï¼šæ‰¾åˆ°Beanå®šä¹‰
ç¬¬ä¸‰æ­¥ï¼šä¿®æ”¹é…ç½®
ç¬¬å››æ­¥ï¼šé‡å¯åº”ç”¨
```

æ³¨è§£é©±åŠ¨ = **è´´æ ‡ç­¾ç¼–ç¨‹**ï¼š
```
åœ¨ç±»ä¸Šè´´ä¸ª @Service æ ‡ç­¾ â†’ Springè‡ªåŠ¨è¯†åˆ«
åœ¨å­—æ®µä¸Šè´´ä¸ª @Autowired æ ‡ç­¾ â†’ è‡ªåŠ¨æ³¨å…¥ä¾èµ–
```

> ğŸ’¡ **æ ¸å¿ƒæ€æƒ³**
> 
> æ³¨è§£å°±æ˜¯ç»™ä»£ç è´´ä¸Š**ç‰¹æ®Šæ ‡è®°**ï¼Œæ¡†æ¶çœ‹åˆ°æ ‡è®°åè‡ªåŠ¨å¤„ç†

### 7.2 Spring MVCæ ¸å¿ƒæ³¨è§£è¯¦è§£


**ğŸŒ Controllerå±‚æ³¨è§£**

```java
@Controller  // æ ‡è®°ä¸ºæ§åˆ¶å™¨ç»„ä»¶
@RequestMapping("/user")  // ç±»çº§åˆ«è·¯å¾„æ˜ å°„
public class UserController {
    
    // å¤„ç†GETè¯·æ±‚
    @GetMapping("/list")  
    public String list(Model model) {
        // ...
    }
    
    // å¤„ç†POSTè¯·æ±‚  
    @PostMapping("/save")
    public String save(@RequestParam String username,  // æ¥æ”¶è¡¨å•å‚æ•°
                       @RequestParam String password) {
        // ...
    }
    
    // RESTfulé£æ ¼
    @GetMapping("/detail/{id}")
    public String detail(@PathVariable Long id,  // æ¥æ”¶è·¯å¾„å‚æ•°
                         Model model) {
        // ...
    }
    
    // æ¥æ”¶JSONæ•°æ®
    @PostMapping("/api/save")
    @ResponseBody  // è¿”å›JSON
    public Result saveUser(@RequestBody User user) {  // æ¥æ”¶JSON
        // ...
    }
}
```

**ğŸ“‹ å¸¸ç”¨æ³¨è§£é€ŸæŸ¥è¡¨**

| æ³¨è§£ | ä½œç”¨ | ç¤ºä¾‹ |
|------|------|------|
| `@RequestMapping` | é€šç”¨è¯·æ±‚æ˜ å°„ | `@RequestMapping("/user")` |
| `@GetMapping` | GETè¯·æ±‚æ˜ å°„ | `@GetMapping("/list")` |
| `@PostMapping` | POSTè¯·æ±‚æ˜ å°„ | `@PostMapping("/save")` |
| `@RequestParam` | æ¥æ”¶è¯·æ±‚å‚æ•° | `@RequestParam("id") Long id` |
| `@PathVariable` | æ¥æ”¶è·¯å¾„å‚æ•° | `@PathVariable("id") Long id` |
| `@RequestBody` | æ¥æ”¶JSONæ•°æ® | `@RequestBody User user` |
| `@ResponseBody` | è¿”å›JSONæ•°æ® | æ–¹æ³•ä¸Šæ·»åŠ  |

### 7.3 å‚æ•°ç»‘å®šæ³¨è§£å¯¹æ¯”


**ğŸ“¥ å››ç§å‚æ•°æ¥æ”¶æ–¹å¼**

```java
@Controller
public class ParamController {
    
    // 1ï¸âƒ£ è¡¨å•å‚æ•°ï¼š?username=admin&age=20
    @GetMapping("/param1")
    public String method1(@RequestParam String username,
                          @RequestParam(defaultValue = "18") int age) {
        return "param1";
    }
    
    // 2ï¸âƒ£ è·¯å¾„å‚æ•°ï¼š/user/123
    @GetMapping("/user/{id}")
    public String method2(@PathVariable Long id) {
        return "param2";
    }
    
    // 3ï¸âƒ£ å¯¹è±¡ç»‘å®šï¼šè‡ªåŠ¨å°è£…è¡¨å•åˆ°å¯¹è±¡
    @PostMapping("/save")
    public String method3(User user) {  // å­—æ®µåéœ€åŒ¹é…
        return "param3";
    }
    
    // 4ï¸âƒ£ JSONæ•°æ®ï¼šContent-Type: application/json
    @PostMapping("/api/save")
    @ResponseBody
    public String method4(@RequestBody User user) {
        return "param4";
    }
}
```

**ğŸ” å‚æ•°æ¥æºå¯¹æ¯”å›¾**

```
å®¢æˆ·ç«¯è¯·æ±‚æ–¹å¼              å¯¹åº”æ³¨è§£
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ?id=1&name=Tom  â”‚ â†’ @RequestParam
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  /user/123      â”‚ â†’ @PathVariable  
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <form>...</form>â”‚ â†’ å¯¹è±¡è‡ªåŠ¨ç»‘å®š
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ {"id":1,"name"} â”‚ â†’ @RequestBody
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.4 å…¨æ³¨è§£é…ç½®å®æˆ˜


**ğŸ—ï¸ é›¶XMLé…ç½®çš„Spring MVC**

```java
// 1ï¸âƒ£ Webåˆå§‹åŒ–é…ç½®ï¼ˆæ›¿ä»£web.xmlï¼‰
public class WebAppInitializer implements WebApplicationInitializer {
    
    @Override
    public void onStartup(ServletContext servletContext) {
        // åˆ›å»ºSpringå®¹å™¨
        AnnotationConfigWebApplicationContext rootContext = 
            new AnnotationConfigWebApplicationContext();
        rootContext.register(RootConfig.class);
        
        // åˆ›å»ºSpring MVCå®¹å™¨
        AnnotationConfigWebApplicationContext mvcContext = 
            new AnnotationConfigWebApplicationContext();
        mvcContext.register(WebMvcConfig.class);
        
        // æ³¨å†ŒDispatcherServlet
        DispatcherServlet servlet = new DispatcherServlet(mvcContext);
        ServletRegistration.Dynamic registration = 
            servletContext.addServlet("dispatcherServlet", servlet);
        registration.setLoadOnStartup(1);
        registration.addMapping("/");
    }
}

// 2ï¸âƒ£ Springæ ¹é…ç½®
@Configuration
@ComponentScan(basePackages = "com.example.service")
public class RootConfig {
    // Serviceå±‚é…ç½®
}

// 3ï¸âƒ£ Spring MVCé…ç½®
@Configuration
@EnableWebMvc
@ComponentScan(basePackages = "com.example.controller")
public class WebMvcConfig implements WebMvcConfigurer {
    
    // è§†å›¾è§£æå™¨
    @Bean
    public ViewResolver viewResolver() {
        InternalResourceViewResolver resolver = new InternalResourceViewResolver();
        resolver.setPrefix("/WEB-INF/views/");
        resolver.setSuffix(".jsp");
        return resolver;
    }
    
    // é™æ€èµ„æºå¤„ç†
    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
        registry.addResourceHandler("/static/**")
                .addResourceLocations("/static/");
    }
}
```

---

## 8. ğŸ”Œ æ¨¡å—è§£è€¦å®è·µ


### 8.1 ä»€ä¹ˆæ˜¯æ¨¡å—è§£è€¦ï¼Ÿ


**ğŸ”— è€¦åˆ vs è§£è€¦å¯¹æ¯”**

**é«˜è€¦åˆï¼ˆä¸å¥½çš„è®¾è®¡ï¼‰ï¼š**
```java
public class UserController {
    // ç›´æ¥newå¯¹è±¡ï¼Œå¼ºä¾èµ–
    private UserService userService = new UserServiceImpl();
    private LogService logService = new LogServiceImpl();
}
```
âŒ é—®é¢˜ï¼šæ¢å®ç°ç±»éœ€è¦æ”¹ä»£ç ï¼Œæµ‹è¯•å›°éš¾

**ä½è€¦åˆï¼ˆå¥½çš„è®¾è®¡ï¼‰ï¼š**
```java
@Controller
public class UserController {
    @Autowired  // ä¾èµ–æ¥å£ï¼Œä¸ä¾èµ–å®ç°
    private UserService userService;
    
    @Autowired
    private LogService logService;
}
```
âœ… ä¼˜ç‚¹ï¼šæ¢å®ç°ç±»ä¸æ”¹ä»£ç ï¼Œæ˜“äºæµ‹è¯•

### 8.2 åˆ†å±‚è§£è€¦æ¶æ„


**ğŸ—ï¸ æ ‡å‡†ä¸‰å±‚æ¶æ„**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Controller å±‚                â”‚
â”‚      (åªè´Ÿè´£è¯·æ±‚å“åº”)                â”‚
â”‚  ğŸš« ä¸å†™ä¸šåŠ¡é€»è¾‘                    â”‚
â”‚  ğŸš« ä¸ç›´æ¥è®¿é—®æ•°æ®åº“                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ è°ƒç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Service å±‚                  â”‚
â”‚       (æ ¸å¿ƒä¸šåŠ¡é€»è¾‘)                 â”‚
â”‚  âœ… äº‹åŠ¡æ§åˆ¶                        â”‚
â”‚  âœ… ä¸šåŠ¡è§„åˆ™                        â”‚
â”‚  ğŸš« ä¸å¤„ç†HTTPè¯·æ±‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ è°ƒç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           DAO å±‚                     â”‚
â”‚        (æ•°æ®è®¿é—®)                    â”‚
â”‚  âœ… æ•°æ®åº“æ“ä½œ                      â”‚
â”‚  ğŸš« ä¸å†™ä¸šåŠ¡é€»è¾‘                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.3 æ¥å£è§£è€¦å®æˆ˜


**ğŸ“‚ é¡¹ç›®ç»“æ„è®¾è®¡**

```
com.example
â”œâ”€â”€ controller          (æ§åˆ¶å±‚)
â”‚   â””â”€â”€ UserController.java
â”‚
â”œâ”€â”€ service            (æœåŠ¡å±‚æ¥å£)
â”‚   â””â”€â”€ UserService.java
â”‚
â”œâ”€â”€ service.impl       (æœåŠ¡å±‚å®ç°)
â”‚   â””â”€â”€ UserServiceImpl.java
â”‚
â”œâ”€â”€ dao                (æ•°æ®è®¿é—®æ¥å£)
â”‚   â””â”€â”€ UserDao.java
â”‚
â””â”€â”€ dao.impl           (æ•°æ®è®¿é—®å®ç°)
    â””â”€â”€ UserDaoImpl.java
```

**ğŸ’» ä»£ç å®ç°**

```java
// 1ï¸âƒ£ Controllerå±‚ï¼šä¾èµ–Serviceæ¥å£
@Controller
@RequestMapping("/user")
public class UserController {
    
    @Autowired
    private UserService userService;  // ä¾èµ–æ¥å£
    
    @PostMapping("/register")
    public String register(User user) {
        userService.register(user);
        return "success";
    }
}

// 2ï¸âƒ£ Serviceæ¥å£ï¼šå®šä¹‰ä¸šåŠ¡æ–¹æ³•
public interface UserService {
    void register(User user);
    User login(String username, String password);
}

// 3ï¸âƒ£ Serviceå®ç°ï¼šä¾èµ–DAOæ¥å£
@Service
@Transactional
public class UserServiceImpl implements UserService {
    
    @Autowired
    private UserDao userDao;  // ä¾èµ–æ¥å£
    
    @Override
    public void register(User user) {
        // ä¸šåŠ¡é€»è¾‘
        userDao.save(user);
    }
    
    @Override
    public User login(String username, String password) {
        User user = userDao.findByUsername(username);
        if (user != null && user.getPassword().equals(password)) {
            return user;
        }
        return null;
    }
}

// 4ï¸âƒ£ DAOæ¥å£ï¼šå®šä¹‰æ•°æ®æ“ä½œ
public interface UserDao {
    void save(User user);
    User findByUsername(String username);
}

// 5ï¸âƒ£ DAOå®ç°
@Repository
public class UserDaoImpl implements UserDao {
    
    @Autowired
    private JdbcTemplate jdbcTemplate;
    
    @Override
    public void save(User user) {
        String sql = "INSERT INTO user(username, password) VALUES(?, ?)";
        jdbcTemplate.update(sql, user.getUsername(), user.getPassword());
    }
    
    @Override
    public User findByUsername(String username) {
        String sql = "SELECT * FROM user WHERE username = ?";
        return jdbcTemplate.queryForObject(sql, new BeanPropertyRowMapper<>(User.class), username);
    }
}
```

### 8.4 è§£è€¦çš„å¥½å¤„


**ğŸ¯ äº”å¤§ä¼˜åŠ¿**

| ä¼˜åŠ¿ | è¯´æ˜ | å®é™…ä¾‹å­ |
|------|------|---------|
| **æ˜“äºæ›¿æ¢** | æ¢å®ç°ä¸æ”¹è°ƒç”¨ä»£ç  | MySQL â†’ Oracleåªéœ€æ¢DAOå®ç° |
| **ä¾¿äºæµ‹è¯•** | å¯ä»¥Mockæ¥å£è¿›è¡Œå•å…ƒæµ‹è¯• | æµ‹è¯•Serviceæ—¶Mock DAO |
| **èŒè´£æ¸…æ™°** | æ¯å±‚åªåšè‡ªå·±çš„äº‹ | Controllerä¸å†™SQL |
| **å›¢é˜Ÿåä½œ** | æ¥å£ç¡®å®šåå¹¶è¡Œå¼€å‘ | å‰ç«¯å’Œåç«¯åŒæ—¶å¼€å‘ |
| **æ˜“äºç»´æŠ¤** | ä¿®æ”¹å½±å“èŒƒå›´å° | æ”¹DAOä¸å½±å“Service |

**ğŸ§ª å•å…ƒæµ‹è¯•ç¤ºä¾‹**

```java
@RunWith(SpringRunner.class)
@ContextConfiguration(classes = AppConfig.class)
public class UserServiceTest {
    
    @Autowired
    private UserService userService;
    
    @MockBean  // Mock DAOå±‚ï¼Œä¸ä¾èµ–æ•°æ®åº“
    private UserDao userDao;
    
    @Test
    public void testRegister() {
        // æ¨¡æ‹ŸDAOè¡Œä¸º
        Mockito.when(userDao.findByUsername("admin"))
               .thenReturn(null);
        
        // æµ‹è¯•Service
        User user = new User("admin", "123456");
        userService.register(user);
        
        // éªŒè¯DAOæ–¹æ³•è¢«è°ƒç”¨
        Mockito.verify(userDao).save(user);
    }
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Spring MVCä¾èµ–Spring Coreï¼Œä¸èƒ½ç‹¬ç«‹ä½¿ç”¨
ğŸ”¸ çˆ¶å­å®¹å™¨ï¼šRootå®¹å™¨(Service/DAO) + Webå®¹å™¨(Controller)
ğŸ”¸ ä¾èµ–æ³¨å…¥ï¼šé€šè¿‡@Autowiredè‡ªåŠ¨è£…é…ï¼Œå®ç°è§£è€¦
ğŸ”¸ AOPåˆ‡é¢ï¼šæ¨ªåˆ‡å…³æ³¨ç‚¹ç»Ÿä¸€å¤„ç†ï¼ˆæ—¥å¿—/äº‹åŠ¡/æƒé™ï¼‰
ğŸ”¸ Beanç”Ÿå‘½å‘¨æœŸï¼šå®ä¾‹åŒ– â†’ æ³¨å…¥ â†’ åˆå§‹åŒ– â†’ ä½¿ç”¨ â†’ é”€æ¯
ğŸ”¸ é…ç½®æ–¹å¼ï¼šXMLé…ç½® â†’ æ³¨è§£é…ç½® â†’ Javaé…ç½®ï¼ˆæ¨èï¼‰
ğŸ”¸ æ³¨è§£é©±åŠ¨ï¼š@Controller/@Service/@Autowiredç­‰æ ¸å¿ƒæ³¨è§£
ğŸ”¸ æ¨¡å—è§£è€¦ï¼šä¾èµ–æ¥å£ä¸ä¾èµ–å®ç°ï¼Œåˆ†å±‚æ¶æ„
```

### 9.2 æ•´åˆå…³ç³»é€Ÿè®°å›¾


```
            Spring MVCæ•´åˆå…¨æ™¯å›¾
                    
      ğŸŒ Webå±‚ï¼ˆSpring MVCå­å®¹å™¨ï¼‰
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  @Controller                â”‚
      â”‚  @RequestMapping            â”‚
      â”‚  @Autowired                 â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“ ä¾èµ–æ³¨å…¥
      ğŸ”§ ä¸šåŠ¡å±‚ï¼ˆSpringæ ¹å®¹å™¨ï¼‰
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  @Service                   â”‚
      â”‚  @Transactional             â”‚
      â”‚  @Autowired                 â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“ ä¾èµ–æ³¨å…¥
      ğŸ—„ï¸ æ•°æ®å±‚ï¼ˆSpringæ ¹å®¹å™¨ï¼‰
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  @Repository                â”‚
      â”‚  @Autowired                 â”‚
      â”‚  JdbcTemplate/MyBatis       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    
      ğŸ­ AOPåˆ‡é¢æ¨ªå‘ç»‡å…¥
      â†â”¼â†’ æ—¥å¿—/äº‹åŠ¡/æƒé™/å¼‚å¸¸
```

### 9.3 å­¦ä¹ è·¯çº¿å»ºè®®


**ğŸ“š åˆ†æ­¥éª¤å­¦ä¹ è®¡åˆ’**

```
ç¬¬1é˜¶æ®µï¼šç†è§£IoCå®¹å™¨ â±ï¸ 2å¤©
â”œâ”€ âœ… ç†è§£ä¾èµ–æ³¨å…¥æ¦‚å¿µ
â”œâ”€ âœ… æŒæ¡@Autowiredä½¿ç”¨
â””â”€ âœ… äº†è§£Beanç”Ÿå‘½å‘¨æœŸ

ç¬¬2é˜¶æ®µï¼šæŒæ¡é…ç½®æ–¹å¼ â±ï¸ 3å¤©  
â”œâ”€ âœ… å­¦ä¹ XMLé…ç½®
â”œâ”€ âœ… æŒæ¡æ³¨è§£é…ç½®
â””â”€ âœ… ç†Ÿæ‚‰Javaé…ç½®

ç¬¬3é˜¶æ®µï¼šå®è·µåˆ†å±‚æ¶æ„ â±ï¸ 3å¤©
â”œâ”€ âœ… è®¾è®¡ä¸‰å±‚ç»“æ„
â”œâ”€ âœ… æ¥å£è§£è€¦å®è·µ
â””â”€ âœ… å•å…ƒæµ‹è¯•ç¼–å†™

ç¬¬4é˜¶æ®µï¼šåº”ç”¨AOPåˆ‡é¢ â±ï¸ 2å¤©
â”œâ”€ âœ… ç†è§£AOPæ¦‚å¿µ
â”œâ”€ âœ… ç¼–å†™æ—¥å¿—åˆ‡é¢
â””â”€ âœ… åº”ç”¨äº‹åŠ¡ç®¡ç†
```

### 9.4 å¸¸è§é—®é¢˜Q&A


> **Q1: çˆ¶å­å®¹å™¨æœ‰ä»€ä¹ˆç”¨ï¼Ÿ**
> 
> A: å®ç°èŒè´£åˆ†ç¦»ã€‚çˆ¶å®¹å™¨ç®¡Service/DAOï¼Œå­å®¹å™¨ç®¡Controllerã€‚çˆ¶å®¹å™¨çš„Beanå¯ä»¥åœ¨æ•´ä¸ªåº”ç”¨å…±äº«ï¼Œå­å®¹å™¨çš„Beanåªåœ¨Webå±‚ä½¿ç”¨ã€‚

> **Q2: @AutowiredæŒ‰ä»€ä¹ˆè§„åˆ™æ³¨å…¥ï¼Ÿ**
> 
> A: å…ˆæŒ‰**ç±»å‹**åŒ¹é…ï¼Œå¦‚æœæœ‰å¤šä¸ªåŒç±»å‹Beanï¼Œå†æŒ‰**åç§°**åŒ¹é…ã€‚å¯ä»¥ç”¨`@Qualifier("beanName")`æŒ‡å®šåç§°ã€‚

> **Q3: ä»€ä¹ˆæ—¶å€™ç”¨æ„é€ å™¨æ³¨å…¥ï¼Ÿ**
> 
> A: å½“ä¾èµ–æ˜¯**å¿…éœ€çš„**ã€**ä¸èƒ½ä¸ºnull**æ—¶ç”¨æ„é€ å™¨æ³¨å…¥ã€‚ä¾‹å¦‚Serviceå¿…é¡»æœ‰DAOæ‰èƒ½å·¥ä½œã€‚

> **Q4: å¦‚ä½•é¿å…å¾ªç¯ä¾èµ–ï¼Ÿ**
> 
> A: 
> - âœ… ä½¿ç”¨Setteræ³¨å…¥ä»£æ›¿æ„é€ å™¨æ³¨å…¥
> - âœ… é‡æ–°è®¾è®¡ç±»ï¼Œæ¶ˆé™¤å¾ªç¯ä¾èµ–
> - âœ… ä½¿ç”¨`@Lazy`å»¶è¿ŸåŠ è½½

> **Q5: æ³¨è§£é…ç½®å’ŒXMLé…ç½®èƒ½æ··ç”¨å—ï¼Ÿ**
> 
> A: å¯ä»¥ï¼ä½¿ç”¨`<context:component-scan>`å¼€å¯æ³¨è§£æ‰«æï¼ŒåŒæ—¶åœ¨XMLä¸­é…ç½®å°‘é‡Beanã€‚ç°ä»£é¡¹ç›®æ¨èå…¨æ³¨è§£ã€‚

### 9.5 å®æˆ˜æ£€æŸ¥æ¸…å•


**ğŸ¯ è‡ªæˆ‘æ£€æµ‹é¢˜**

- [ ] èƒ½ç”»å‡ºSpring MVCçš„çˆ¶å­å®¹å™¨ç»“æ„å›¾å—ï¼Ÿ
- [ ] èƒ½è¯´å‡ºBeanç”Ÿå‘½å‘¨æœŸçš„7ä¸ªé˜¶æ®µå—ï¼Ÿ
- [ ] èƒ½å†™å‡ºä¸€ä¸ªå®Œæ•´çš„ä¸‰å±‚æ¶æ„æ¡ˆä¾‹å—ï¼Ÿ
- [ ] èƒ½ç‹¬ç«‹é…ç½®ä¸€ä¸ªAOPæ—¥å¿—åˆ‡é¢å—ï¼Ÿ
- [ ] èƒ½ç”¨Javaé…ç½®æ–¹å¼æ›¿ä»£web.xmlå—ï¼Ÿ
- [ ] èƒ½è§£é‡Š@RequestBodyå’Œ@RequestParamçš„åŒºåˆ«å—ï¼Ÿ

**ğŸ’ª è¿›é˜¶ç»ƒä¹ **

1. **å®æˆ˜ä»»åŠ¡1ï¼š** æ­å»ºç”¨æˆ·ç®¡ç†ç³»ç»Ÿï¼ˆç™»å½•/æ³¨å†Œ/åˆ—è¡¨ï¼‰
   - ä½¿ç”¨å…¨æ³¨è§£é…ç½®
   - å®ç°ä¸‰å±‚æ¶æ„
   - æ·»åŠ æ—¥å¿—åˆ‡é¢

2. **å®æˆ˜ä»»åŠ¡2ï¼š** å®ç°ç»Ÿä¸€å¼‚å¸¸å¤„ç†
   - ä½¿ç”¨`@ControllerAdvice`
   - æ•è·ä¸šåŠ¡å¼‚å¸¸
   - è¿”å›å‹å¥½æç¤º

3. **å®æˆ˜ä»»åŠ¡3ï¼š** å®ç°æƒé™æ‹¦æˆªå™¨
   - ç»§æ‰¿`HandlerInterceptor`
   - æ ¡éªŒç”¨æˆ·ç™»å½•çŠ¶æ€
   - æ‹¦æˆªæœªæˆæƒè¯·æ±‚

---

> ğŸ“ **å­¦ä¹ å»ºè®®**
> 
> Spring MVCä¸Springçš„æ•´åˆæ˜¯**åŸºç¡€ä¸­çš„åŸºç¡€**ï¼Œç†è§£äº†è¿™éƒ¨åˆ†ï¼Œåç»­å­¦ä¹ Spring Bootã€Spring Cloudéƒ½ä¼šè½»æ¾å¾ˆå¤šã€‚å»ºè®®ï¼š
> - ğŸ“ åŠ¨æ‰‹æ•²ä»£ç ï¼Œä¸è¦åªçœ‹
> - ğŸ” ç†è§£åŸç†æ¯”è®°APIæ›´é‡è¦  
> - ğŸ—ï¸ ä»ç®€å•é¡¹ç›®å¼€å§‹å®è·µ
> - ğŸ› é‡åˆ°é—®é¢˜å…ˆçœ‹å¼‚å¸¸æ ˆä¿¡æ¯

**è®°å¿†å£è¯€ï¼š**
```
ä¸¤ä¸ªå®¹å™¨çˆ¶å’Œå­ï¼ŒServiceæ”¾çˆ¶Controllerå­ï¼›
ä¾èµ–æ³¨å…¥IoCç®¡ï¼ŒAOPåˆ‡é¢æ¨ªå‘ç©¿ï¼›
Beanç”Ÿå‘½æœ‰å‘¨æœŸï¼Œé…ç½®æ–¹å¼ä¸‰é€‰ä¸€ï¼›
æ³¨è§£é©±åŠ¨å¼€å‘å¿«ï¼Œæ¥å£è§£è€¦æ˜“ç»´æŠ¤ï¼
```