---
title: 1ã€Webå®‰å…¨åŸºç¡€é˜²æŠ¤
---
## ğŸ“š ç›®å½•

1. [Webå®‰å…¨æ¦‚è¿°](#1-webå®‰å…¨æ¦‚è¿°)
2. [XSSè·¨ç«™è„šæœ¬æ”»å‡»é˜²æŠ¤](#2-xssè·¨ç«™è„šæœ¬æ”»å‡»é˜²æŠ¤)
3. [CSRFè·¨ç«™è¯·æ±‚ä¼ªé€ é˜²æŠ¤](#3-csrfè·¨ç«™è¯·æ±‚ä¼ªé€ é˜²æŠ¤)
4. [SQLæ³¨å…¥æ”»å‡»é˜²æŠ¤](#4-sqlæ³¨å…¥æ”»å‡»é˜²æŠ¤)
5. [æ–‡ä»¶ä¸Šä¼ å®‰å…¨](#5-æ–‡ä»¶ä¸Šä¼ å®‰å…¨)
6. [å‚æ•°éªŒè¯ä¸è¾“å…¥è¿‡æ»¤](#6-å‚æ•°éªŒè¯ä¸è¾“å…¥è¿‡æ»¤)
7. [è¾“å‡ºç¼–ç ä¸å®‰å…¨å“åº”](#7-è¾“å‡ºç¼–ç ä¸å®‰å…¨å“åº”)
8. [å®‰å…¨å¤´é…ç½®](#8-å®‰å…¨å¤´é…ç½®)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ›¡ï¸ Webå®‰å…¨æ¦‚è¿°


### 1.1 ä¸ºä»€ä¹ˆè¦é‡è§†Webå®‰å…¨


**ğŸ’¡ é€šä¿—ç†è§£**ï¼š
æƒ³è±¡ä½ çš„Webåº”ç”¨æ˜¯ä¸€æ ‹æˆ¿å­ï¼Œç”¨æˆ·é€šè¿‡æµè§ˆå™¨è®¿é—®å°±åƒæ˜¯æ¥è®¿çš„å®¢äººã€‚å¦‚æœæ²¡æœ‰å®‰å…¨é˜²æŠ¤ï¼Œå°±åƒæˆ¿å­æ²¡æœ‰é—¨é”ã€çª—æˆ·å¤§å¼€ï¼Œåäººå¯ä»¥éšæ„è¿›å…¥ã€æç ´åã€å·ä¸œè¥¿ã€‚

**ğŸ¯ å¸¸è§çš„å®‰å…¨å¨èƒ**ï¼š

```
ç°å®åœºæ™¯ç±»æ¯”                    Webå®‰å…¨å¨èƒ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
å°å·å†’å……ä½ çš„æœ‹å‹éª—å¼€é—¨      â†’  CSRFæ”»å‡»ï¼ˆä¼ªé€ è¯·æ±‚ï¼‰
åäººåœ¨ä½ å®¶å¢™ä¸Šæ¶‚é¸¦          â†’  XSSæ”»å‡»ï¼ˆæ¶æ„è„šæœ¬ï¼‰
é€šè¿‡çª—æˆ·å·çœ‹ä½ çš„ä¿¡æ¯        â†’  SQLæ³¨å…¥ï¼ˆæ•°æ®æ³„éœ²ï¼‰
ä¸Šä¼ æœ‰æ¯’çš„ç¤¼ç‰©              â†’  æ¶æ„æ–‡ä»¶ä¸Šä¼ 
```

### 1.2 å®‰å…¨é˜²æŠ¤çš„æ ¸å¿ƒåŸåˆ™


**ğŸ” ä¸‰å¤§åŸºæœ¬åŸåˆ™**ï¼š

1ï¸âƒ£ **æ°¸è¿œä¸è¦ä¿¡ä»»ç”¨æˆ·è¾“å…¥**
```
âŒ é”™è¯¯æƒ³æ³•ï¼š"ç”¨æˆ·ä¸ä¼šæ•…æ„è¾“å…¥åä¸œè¥¿"
âœ… æ­£ç¡®åšæ³•ï¼šæ‰€æœ‰è¾“å…¥éƒ½è¦éªŒè¯ã€è¿‡æ»¤ã€è½¬ä¹‰
```

2ï¸âƒ£ **æœ€å°æƒé™åŸåˆ™**
```
åªç»™å¿…è¦çš„æƒé™ï¼Œä¸å¤šç»™
å°±åƒé“¶è¡ŒæŸœå‘˜åªèƒ½æ“ä½œå­˜å–æ¬¾ï¼Œä¸èƒ½ä¿®æ”¹ç³»ç»Ÿ
```

3ï¸âƒ£ **çºµæ·±é˜²å¾¡**
```
å¤šå±‚é˜²æŠ¤ï¼Œä¸€å±‚å¤±æ•ˆè¿˜æœ‰å…¶ä»–å±‚ä¿æŠ¤
åƒåŸå ¡æœ‰æŠ¤åŸæ²³ã€åŸå¢™ã€å®ˆå«å¤šé‡é˜²çº¿
```

### 1.3 Spring MVCå®‰å…¨é˜²æŠ¤ä½“ç³»


**ğŸ—ï¸ é˜²æŠ¤æ¶æ„å›¾**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            æµè§ˆå™¨ï¼ˆç”¨æˆ·ç«¯ï¼‰                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚      å‰ç«¯é˜²æŠ¤å±‚                  â”‚
    â”‚  - è¾“å…¥éªŒè¯                      â”‚
    â”‚  - CSRF Token                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    Spring MVCæ§åˆ¶å™¨å±‚            â”‚
    â”‚  - å‚æ•°éªŒè¯ @Valid               â”‚
    â”‚  - é˜²æŠ¤æ³¨è§£                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚      ä¸šåŠ¡é€»è¾‘å±‚                  â”‚
    â”‚  - æƒé™æ£€æŸ¥                      â”‚
    â”‚  - æ•°æ®è¿‡æ»¤                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚      æ•°æ®è®¿é—®å±‚                  â”‚
    â”‚  - å‚æ•°åŒ–æŸ¥è¯¢                    â”‚
    â”‚  - ORMé˜²æ³¨å…¥                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ğŸ’‰ XSSè·¨ç«™è„šæœ¬æ”»å‡»é˜²æŠ¤


### 2.1 ä»€ä¹ˆæ˜¯XSSæ”»å‡»


**ğŸ“– æ¦‚å¿µç†è§£**ï¼š
XSSï¼ˆCross-Site Scriptingï¼‰å°±åƒæœ‰äººåœ¨ä½ çš„ç½‘é¡µé‡Œå·å·è—äº†ä¸€æ®µæ¶æ„ä»£ç ï¼Œå½“å…¶ä»–ç”¨æˆ·è®¿é—®æ—¶ï¼Œè¿™æ®µä»£ç ä¼šåœ¨ä»–ä»¬çš„æµè§ˆå™¨é‡Œæ‰§è¡Œï¼Œçªƒå–ä¿¡æ¯æˆ–åšåäº‹ã€‚

**ğŸ­ ç”Ÿæ´»åœºæ™¯ç±»æ¯”**ï¼š
```
æƒ³è±¡ä¸€ä¸ªç•™è¨€æ¿ï¼š
æ­£å¸¸ç”¨æˆ·ç•™è¨€ï¼š"ä»Šå¤©å¤©æ°”çœŸå¥½"
æ¶æ„ç”¨æˆ·ç•™è¨€ï¼š<script>å·å–ä½ çš„Cookie</script>

å½“åˆ«äººçœ‹åˆ°è¿™æ¡ç•™è¨€æ—¶ï¼Œæ¶æ„ä»£ç å°±ä¼šæ‰§è¡Œ
å°±åƒæœ‰äººåœ¨å…¬å‘Šæ¿ä¸Šè´´äº†ä¸ªæœ‰æ¯’çš„çº¸æ¡
```

### 2.2 XSSæ”»å‡»çš„ç±»å‹


**ğŸ” ä¸‰ç§å¸¸è§ç±»å‹**ï¼š

| ç±»å‹ | æè¿° | å±å®³ç¤ºä¾‹ |
|------|------|----------|
| **åå°„å‹XSS** | æ¶æ„ä»£ç åœ¨URLä¸­ï¼Œç«‹å³æ‰§è¡Œ | `é’“é±¼é“¾æ¥ï¼šhttp://xxx.com?name=<script>alert(1)</script>` |
| **å­˜å‚¨å‹XSS** | æ¶æ„ä»£ç å­˜å‚¨åœ¨æ•°æ®åº“ï¼Œå½±å“æ‰€æœ‰è®¿é—®è€… | `è®ºå›è¯„è®ºä¸­æ’å…¥æ¶æ„è„šæœ¬` |
| **DOMå‹XSS** | é€šè¿‡ä¿®æ”¹é¡µé¢DOMç»“æ„æ‰§è¡Œ | `åŠ¨æ€ç”ŸæˆHTMLæ—¶æ’å…¥æ¶æ„ä»£ç ` |

### 2.3 Spring MVCä¸­çš„XSSé˜²æŠ¤


**ğŸ›¡ï¸ æ–¹æ³•ä¸€ï¼šè¾“å‡ºè½¬ä¹‰ï¼ˆæœ€å¸¸ç”¨ï¼‰**

```java
@Controller
public class UserController {
    
    @GetMapping("/user/info")
    public String showUserInfo(@RequestParam String username, Model model) {
        // âŒ å±é™©å†™æ³•ï¼šç›´æ¥è¾“å‡ºç”¨æˆ·è¾“å…¥
        // model.addAttribute("name", username);
        
        // âœ… å®‰å…¨å†™æ³•ï¼šSpringä¼šè‡ªåŠ¨è½¬ä¹‰
        model.addAttribute("name", username);
        return "userInfo";
    }
}
```

**å‰ç«¯é¡µé¢ï¼ˆThymeleafï¼‰**ï¼š
```html
<!-- âœ… è‡ªåŠ¨è½¬ä¹‰ï¼Œå®‰å…¨ -->
<p th:text="${name}">ç”¨æˆ·å</p>

<!-- âŒ ä¸è½¬ä¹‰ï¼Œå±é™©ï¼ -->
<p th:utext="${name}">ç”¨æˆ·å</p>
```

**ğŸ’¡ ç†è§£è½¬ä¹‰**ï¼š
```
ç”¨æˆ·è¾“å…¥ï¼š<script>alert('XSS')</script>
è‡ªåŠ¨è½¬ä¹‰åï¼š&lt;script&gt;alert('XSS')&lt;/script&gt;

æµè§ˆå™¨æ˜¾ç¤ºï¼š<script>alert('XSS')</script>ï¼ˆçº¯æ–‡æœ¬ï¼Œä¸æ‰§è¡Œï¼‰
```

**ğŸ›¡ï¸ æ–¹æ³•äºŒï¼šå†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆCSPï¼‰**

```java
@Configuration
public class SecurityConfig {
    
    @Bean
    public FilterRegistrationBean<ContentSecurityPolicyFilter> cspFilter() {
        FilterRegistrationBean<ContentSecurityPolicyFilter> registration = 
            new FilterRegistrationBean<>();
        registration.setFilter(new ContentSecurityPolicyFilter());
        registration.addUrlPatterns("/*");
        return registration;
    }
}

// è‡ªå®šä¹‰CSPè¿‡æ»¤å™¨
public class ContentSecurityPolicyFilter implements Filter {
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                         FilterChain chain) throws IOException, ServletException {
        HttpServletResponse httpResponse = (HttpServletResponse) response;
        // è®¾ç½®å†…å®¹å®‰å…¨ç­–ç•¥
        httpResponse.setHeader("Content-Security-Policy", 
            "default-src 'self'; script-src 'self' 'unsafe-inline'");
        chain.doFilter(request, response);
    }
}
```

**ğŸ›¡ï¸ æ–¹æ³•ä¸‰ï¼šè¾“å…¥è¿‡æ»¤å·¥å…·ç±»**

```java
public class XssUtils {
    
    /**
     * æ¸…ç†HTMLæ ‡ç­¾ï¼ˆç®€å•ç‰ˆï¼‰
     */
    public static String cleanHtml(String input) {
        if (input == null) return null;
        
        // ç§»é™¤æ‰€æœ‰HTMLæ ‡ç­¾
        return input.replaceAll("<[^>]*>", "")
                   .replaceAll("&", "&amp;")
                   .replaceAll("<", "&lt;")
                   .replaceAll(">", "&gt;")
                   .replaceAll("\"", "&quot;")
                   .replaceAll("'", "&#x27;");
    }
    
    /**
     * ä½¿ç”¨Jsoupåº“æ¸…ç†ï¼ˆæ¨èï¼‰
     */
    public static String cleanWithJsoup(String input) {
        // åªå…è®¸å®‰å…¨çš„HTMLæ ‡ç­¾
        Whitelist whitelist = Whitelist.relaxed();
        return Jsoup.clean(input, whitelist);
    }
}
```

### 2.4 XSSé˜²æŠ¤æœ€ä½³å®è·µ


**âœ… é˜²æŠ¤æ¸…å•**ï¼š
- [x] å¯¹æ‰€æœ‰ç”¨æˆ·è¾“å…¥è¿›è¡ŒHTMLè½¬ä¹‰
- [x] ä½¿ç”¨æ¨¡æ¿å¼•æ“çš„è‡ªåŠ¨è½¬ä¹‰åŠŸèƒ½
- [x] è®¾ç½®Content-Security-Policyå¤´
- [x] é¿å…ä½¿ç”¨`innerHTML`ç›´æ¥æ’å…¥ç”¨æˆ·æ•°æ®
- [x] å¯¹å¯Œæ–‡æœ¬ç¼–è¾‘å™¨å†…å®¹ä½¿ç”¨ç™½åå•è¿‡æ»¤

**âš ï¸ å¸¸è§è¯¯åŒº**ï¼š
```
âŒ è¯¯åŒº1ï¼š"æˆ‘åªå…è®¸è‹±æ–‡å’Œæ•°å­—ï¼Œä¸ä¼šæœ‰XSS"
   â†’ ç¼–ç ç»•è¿‡ï¼š%3Cscript%3E ä¹Ÿèƒ½æ‰§è¡Œ

âŒ è¯¯åŒº2ï¼š"æˆ‘ç”¨äº†æ­£åˆ™è¿‡æ»¤scriptæ ‡ç­¾å°±å®‰å…¨äº†"
   â†’ å¯ä»¥ç”¨<img onerror=alert(1)>ç­‰å…¶ä»–æ ‡ç­¾

âœ… æ­£ç¡®åšæ³•ï¼šä½¿ç”¨æˆç†Ÿçš„HTMLæ¸…ç†åº“ï¼ˆå¦‚Jsoupï¼‰+ è¾“å‡ºè½¬ä¹‰
```

---

## 3. ğŸ£ CSRFè·¨ç«™è¯·æ±‚ä¼ªé€ é˜²æŠ¤


### 3.1 ä»€ä¹ˆæ˜¯CSRFæ”»å‡»


**ğŸ“– æ¦‚å¿µç†è§£**ï¼š
CSRFï¼ˆCross-Site Request Forgeryï¼‰å°±åƒæœ‰äººå†’å……ä½ ç»™é“¶è¡Œæ‰“ç”µè¯è½¬è´¦ã€‚æ”»å‡»è€…åˆ©ç”¨ä½ å·²ç»ç™»å½•çš„èº«ä»½ï¼Œåœ¨ä½ ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å‘èµ·æ¶æ„è¯·æ±‚ã€‚

**ğŸ­ ç”Ÿæ´»åœºæ™¯ç±»æ¯”**ï¼š
```
åœºæ™¯ï¼šä½ ç™»å½•äº†ç½‘ä¸Šé“¶è¡Œï¼ˆæµè§ˆå™¨æœ‰ç™»å½•å‡­è¯Cookieï¼‰
      åŒæ—¶åˆæ‰“å¼€äº†æ¶æ„ç½‘ç«™

æ¶æ„ç½‘ç«™åšäº†ä»€ä¹ˆï¼š
1. å®ƒçŸ¥é“é“¶è¡Œè½¬è´¦çš„æ¥å£åœ°å€
2. å®ƒæ„é€ äº†ä¸€ä¸ªè½¬è´¦è¯·æ±‚ï¼Œæ”¶æ¬¾äººæ˜¯æ”»å‡»è€…
3. åˆ©ç”¨ä½ æµè§ˆå™¨é‡Œçš„Cookieï¼Œæ‚„æ‚„å‘èµ·è½¬è´¦è¯·æ±‚
4. é“¶è¡Œè®¤ä¸ºæ˜¯ä½ æœ¬äººæ“ä½œï¼Œæ‰§è¡Œäº†è½¬è´¦

å°±åƒæœ‰äººå·ç”¨ä½ çš„æ‰‹æœºç»™éª—å­è½¬è´¦
```

### 3.2 CSRFæ”»å‡»åŸç†å›¾


```
ç”¨æˆ·æµè§ˆå™¨
    â”‚
    â”‚ 1ï¸âƒ£ ç™»å½•æ­£å¸¸ç½‘ç«™
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                â”‚
    â”‚ 2ï¸âƒ£ è·å¾—ç™»å½•å‡­è¯(Cookie)        â”‚
    â”‚                                â–¼
    â”‚                        æ­£å¸¸ç½‘ç«™æœåŠ¡å™¨
    â”‚                        (å·²è®¤è¯ç”¨æˆ·)
    â”‚
    â”‚ 3ï¸âƒ£ è®¿é—®æ¶æ„ç½‘ç«™
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                â”‚
    â”‚ 4ï¸âƒ£ æ¶æ„ç½‘ç«™è¿”å›ä¼ªé€ è¯·æ±‚        â”‚
    â”‚    <img src="æ­£å¸¸ç½‘ç«™/è½¬è´¦?     â–¼
    â”‚         amount=1000&to=hacker"> æ¶æ„ç½‘ç«™
    â”‚
    â”‚ 5ï¸âƒ£ æµè§ˆå™¨è‡ªåŠ¨å‘é€è¯·æ±‚+Cookie
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                     â–¼
                             æ­£å¸¸ç½‘ç«™æœåŠ¡å™¨
                             (è¯¯è®¤ä¸ºæ˜¯ç”¨æˆ·æ“ä½œ)
```

### 3.3 Spring MVCçš„CSRFé˜²æŠ¤


**ğŸ›¡ï¸ æ–¹æ³•ä¸€ï¼šSpring Security CSRFä¿æŠ¤ï¼ˆæ¨èï¼‰**

**æ­¥éª¤1ï¼šå¯ç”¨CSRFä¿æŠ¤**
```java
@Configuration
@EnableWebSecurity
public class SecurityConfig extends WebSecurityConfigurerAdapter {
    
    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http
            .csrf()
                .csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse())
            .and()
            .authorizeRequests()
                .anyRequest().authenticated();
    }
}
```

**æ­¥éª¤2ï¼šå‰ç«¯è¡¨å•æ·»åŠ Token**
```html
<!-- Thymeleafè‡ªåŠ¨æ·»åŠ CSRF Token -->
<form th:action="@{/transfer}" method="post">
    <input type="hidden" th:name="${_csrf.parameterName}" 
           th:value="${_csrf.token}"/>
    <input name="amount" placeholder="é‡‘é¢"/>
    <button type="submit">è½¬è´¦</button>
</form>
```

**æ­¥éª¤3ï¼šAjaxè¯·æ±‚æºå¸¦Token**
```javascript
// ä»Cookieè¯»å–Token
function getCsrfToken() {
    return document.cookie
        .split('; ')
        .find(row => row.startsWith('XSRF-TOKEN='))
        ?.split('=')[1];
}

// å‘é€è¯·æ±‚æ—¶æºå¸¦Token
fetch('/api/transfer', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'X-XSRF-TOKEN': getCsrfToken()  // å…³é”®ï¼šæºå¸¦Token
    },
    body: JSON.stringify({ amount: 1000, to: 'user123' })
});
```

**ğŸ›¡ï¸ æ–¹æ³•äºŒï¼šè‡ªå®šä¹‰CSRFé˜²æŠ¤**

```java
@Component
public class CsrfInterceptor implements HandlerInterceptor {
    
    @Override
    public boolean preHandle(HttpServletRequest request, 
                            HttpServletResponse response, 
                            Object handler) throws Exception {
        
        // åªéªŒè¯POST/PUT/DELETEç­‰ä¿®æ”¹æ“ä½œ
        if ("POST".equals(request.getMethod()) || 
            "PUT".equals(request.getMethod()) ||
            "DELETE".equals(request.getMethod())) {
            
            String sessionToken = (String) request.getSession()
                                                  .getAttribute("CSRF_TOKEN");
            String requestToken = request.getHeader("X-CSRF-TOKEN");
            
            // å¯¹æ¯”Tokenæ˜¯å¦ä¸€è‡´
            if (sessionToken == null || !sessionToken.equals(requestToken)) {
                response.setStatus(HttpServletResponse.SC_FORBIDDEN);
                response.getWriter().write("CSRFéªŒè¯å¤±è´¥");
                return false;  // é˜»æ­¢è¯·æ±‚
            }
        }
        return true;
    }
}
```

### 3.4 CSRFé˜²æŠ¤åŸç†è§£æ


**ğŸ”‘ æ ¸å¿ƒåŸç†**ï¼š
```
ä¸ºä»€ä¹ˆCSRF Tokenèƒ½é˜²æŠ¤ï¼Ÿ

1ï¸âƒ£ Tokenå­˜å‚¨åœ¨æœåŠ¡å™¨Sessionæˆ–Cookieä¸­
2ï¸âƒ£ æ¯æ¬¡è¯·æ±‚å¿…é¡»æºå¸¦æ­£ç¡®çš„Token
3ï¸âƒ£ æ¶æ„ç½‘ç«™æ— æ³•è¯»å–å…¶ä»–ç½‘ç«™çš„Cookie/Session
4ï¸âƒ£ æ‰€ä»¥æ¶æ„ç½‘ç«™æ— æ³•æ„é€ åˆæ³•çš„Token

å°±åƒé“¶è¡Œè½¬è´¦éœ€è¦åŠ¨æ€éªŒè¯ç 
æ”»å‡»è€…çŸ¥é“ä½ çš„è´¦å·ï¼Œä½†æ‹¿ä¸åˆ°éªŒè¯ç 
```

**ğŸ“Š å®‰å…¨æ€§å¯¹æ¯”**ï¼š

| é˜²æŠ¤æ–¹æ¡ˆ | å®‰å…¨æ€§ | ä½¿ç”¨éš¾åº¦ | é€‚ç”¨åœºæ™¯ |
|---------|--------|---------|---------|
| **Spring Security CSRF** | â­â­â­â­â­ | â­â­â˜†â˜†â˜† | `æ¨èç”¨äºæ‰€æœ‰åœºæ™¯` |
| **åŒé‡CookieéªŒè¯** | â­â­â­â­â˜† | â­â­â­â˜†â˜† | `ç®€å•APIåº”ç”¨` |
| **éªŒè¯Refererå¤´** | â­â­â˜†â˜†â˜† | â­â˜†â˜†â˜†â˜† | `ä¸æ¨èï¼Œæ˜“è¢«ç»•è¿‡` |
| **è‡ªå®šä¹‰Token** | â­â­â­â­â˜† | â­â­â­â­â˜† | `ç‰¹æ®Šéœ€æ±‚åœºæ™¯` |

---

## 4. ğŸ’Š SQLæ³¨å…¥æ”»å‡»é˜²æŠ¤


### 4.1 ä»€ä¹ˆæ˜¯SQLæ³¨å…¥


**ğŸ“– æ¦‚å¿µç†è§£**ï¼š
SQLæ³¨å…¥å°±åƒä½ è·Ÿæ•°æ®åº“è¯´è¯æ—¶ï¼Œæœ‰äººå·å·ç¯¡æ”¹äº†ä½ çš„è¯ï¼Œè®©æ•°æ®åº“æ‰§è¡Œäº†ä½ ä¸æƒ³æ‰§è¡Œçš„å‘½ä»¤ã€‚

**ğŸ­ ç”Ÿæ´»åœºæ™¯ç±»æ¯”**ï¼š
```
åœºæ™¯ï¼šä½ å»å›¾ä¹¦é¦†æŸ¥ä¹¦

æ­£å¸¸å¯¹è¯ï¼š
ä½ ï¼š"è¯·å¸®æˆ‘æ‰¾ã€ŠJavaç¼–ç¨‹ã€‹è¿™æœ¬ä¹¦"
ç®¡ç†å‘˜ï¼šåœ¨æ•°æ®åº“æŸ¥è¯¢ â†’ æ‰¾åˆ°ä¹¦ â†’ ç»™ä½ 

SQLæ³¨å…¥æ”»å‡»ï¼š
ä½ ï¼š"è¯·å¸®æˆ‘æ‰¾ã€ŠJavaç¼–ç¨‹' OR '1'='1ã€‹è¿™æœ¬ä¹¦"
ç®¡ç†å‘˜ï¼šåœ¨æ•°æ®åº“æŸ¥è¯¢ â†’ æŸ¥è¯¢å˜æˆï¼š
        WHERE bookName = 'Javaç¼–ç¨‹' OR '1'='1'
        â†’ '1'='1'æ°¸è¿œä¸ºçœŸ â†’ è¿”å›æ‰€æœ‰ä¹¦ï¼

å°±åƒæœ‰äººé€šè¿‡è¯´è¯æŠ€å·§ï¼Œéª—ç®¡ç†å‘˜æŠŠæ‰€æœ‰ä¹¦éƒ½ç»™ä»–
```

### 4.2 SQLæ³¨å…¥çš„å±å®³ç¤ºä¾‹


**âŒ å±é™©çš„ä»£ç ç¤ºä¾‹**ï¼š

```java
@GetMapping("/user/login")
public String login(@RequestParam String username, 
                   @RequestParam String password) {
    
    // âŒ æåº¦å±é™©ï¼šç›´æ¥æ‹¼æ¥SQL
    String sql = "SELECT * FROM users WHERE username='" + username + 
                 "' AND password='" + password + "'";
    
    // æ‰§è¡ŒSQL...
}
```

**ğŸš¨ æ”»å‡»åœºæ™¯**ï¼š
```
æ­£å¸¸ç”¨æˆ·è¾“å…¥ï¼š
username: admin
password: 123456
å®é™…SQL: SELECT * FROM users WHERE username='admin' AND password='123456'

æ¶æ„ç”¨æˆ·è¾“å…¥ï¼š
username: admin' OR '1'='1
password: éšä¾¿è¾“å…¥
å®é™…SQL: SELECT * FROM users WHERE username='admin' OR '1'='1' AND password='xxx'
         â†“
         WHEREæ¡ä»¶æ°¸è¿œä¸ºçœŸï¼Œç»•è¿‡å¯†ç éªŒè¯ï¼

æ›´å±é™©çš„è¾“å…¥ï¼š
username: admin'; DROP TABLE users; --
å®é™…SQL: SELECT * FROM users WHERE username='admin'; DROP TABLE users; --'
         â†“
         åˆ é™¤æ•´ä¸ªç”¨æˆ·è¡¨ï¼
```

### 4.3 Spring MVCé˜²SQLæ³¨å…¥


**ğŸ›¡ï¸ æ–¹æ³•ä¸€ï¼šä½¿ç”¨JdbcTemplateå‚æ•°åŒ–æŸ¥è¯¢**

```java
@Repository
public class UserDao {
    
    @Autowired
    private JdbcTemplate jdbcTemplate;
    
    // âœ… å®‰å…¨å†™æ³•ï¼šä½¿ç”¨?å ä½ç¬¦
    public User findByUsername(String username) {
        String sql = "SELECT * FROM users WHERE username = ?";
        return jdbcTemplate.queryForObject(sql, 
            new BeanPropertyRowMapper<>(User.class), 
            username);  // å‚æ•°ä¼šè‡ªåŠ¨è½¬ä¹‰
    }
    
    // âœ… å®‰å…¨å†™æ³•ï¼šä½¿ç”¨å‘½åå‚æ•°
    public User login(String username, String password) {
        String sql = "SELECT * FROM users WHERE username = :username " +
                     "AND password = :password";
        
        MapSqlParameterSource params = new MapSqlParameterSource();
        params.addValue("username", username);
        params.addValue("password", password);
        
        NamedParameterJdbcTemplate namedTemplate = 
            new NamedParameterJdbcTemplate(jdbcTemplate);
        
        return namedTemplate.queryForObject(sql, params, 
            new BeanPropertyRowMapper<>(User.class));
    }
}
```

**ğŸ›¡ï¸ æ–¹æ³•äºŒï¼šä½¿ç”¨MyBatisé˜²æ³¨å…¥**

```xml
<!-- âœ… å®‰å…¨å†™æ³•ï¼šä½¿ç”¨#{} -->
<select id="findByUsername" resultType="User">
    SELECT * FROM users WHERE username = #{username}
</select>

<!-- âŒ å±é™©å†™æ³•ï¼šä½¿ç”¨${} ä¼šç›´æ¥æ‹¼æ¥ -->
<select id="findByUsernameDangerous" resultType="User">
    SELECT * FROM users WHERE username = '${username}'
</select>

<!-- âœ… åŠ¨æ€æ’åºæ—¶çš„å®‰å…¨åšæ³• -->
<select id="listUsers" resultType="User">
    SELECT * FROM users
    <where>
        <if test="orderBy != null">
            ORDER BY 
            <choose>
                <when test="orderBy == 'name'">username</when>
                <when test="orderBy == 'date'">create_time</when>
                <otherwise>id</otherwise>
            </choose>
        </if>
    </where>
</select>
```

**ğŸ›¡ï¸ æ–¹æ³•ä¸‰ï¼šä½¿ç”¨JPA/Hibernate**

```java
@Repository
public interface UserRepository extends JpaRepository<User, Long> {
    
    // âœ… å®‰å…¨ï¼šSpring Dataè‡ªåŠ¨å‚æ•°åŒ–
    User findByUsername(String username);
    
    // âœ… å®‰å…¨ï¼šJPQLå‚æ•°åŒ–æŸ¥è¯¢
    @Query("SELECT u FROM User u WHERE u.username = :username AND u.password = :password")
    User login(@Param("username") String username, 
               @Param("password") String password);
    
    // âœ… å®‰å…¨ï¼šåŸç”ŸSQLå‚æ•°åŒ–
    @Query(value = "SELECT * FROM users WHERE username = ?1", nativeQuery = true)
    User findByUsernameNative(String username);
}
```

### 4.4 SQLæ³¨å…¥é˜²æŠ¤åŸç†


**ğŸ” å‚æ•°åŒ–æŸ¥è¯¢çš„é˜²æŠ¤åŸç†**ï¼š

```
ä¸å®‰å…¨çš„æ‹¼æ¥ï¼š
"SELECT * FROM users WHERE username='" + input + "'"
â†’ ç”¨æˆ·è¾“å…¥ç›´æ¥è¿›å…¥SQLè¯­å¥
â†’ æ¶æ„SQLä¼šè¢«æ‰§è¡Œ

å‚æ•°åŒ–æŸ¥è¯¢ï¼š
"SELECT * FROM users WHERE username=?"
â†’ SQLç»“æ„å…ˆç¡®å®š
â†’ å‚æ•°å•ç‹¬ä¼ é€’ï¼Œä½œä¸ºçº¯æ•°æ®
â†’ æ•°æ®åº“ä¼šè‡ªåŠ¨è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦
â†’ æ¶æ„SQLè¢«å½“ä½œæ™®é€šå­—ç¬¦ä¸²

å°±åƒå¡«ç©ºé¢˜å’Œé—®ç­”é¢˜çš„åŒºåˆ«ï¼š
å¡«ç©ºé¢˜ï¼šç»“æ„å›ºå®šï¼Œåªå¡«æ•°æ® â†’ å®‰å…¨
é—®ç­”é¢˜ï¼šè‡ªç”±å‘æŒ¥ï¼Œå¯ä»¥æ”¹é¢˜ç›® â†’ å±é™©
```

**âœ… é˜²æŠ¤æœ€ä½³å®è·µ**ï¼š
- [x] æ°¸è¿œä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼ˆ`?`æˆ–`#{}`ï¼‰
- [x] é¿å…ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥SQL
- [x] å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œç™½åå•éªŒè¯
- [x] ä½¿ç”¨ORMæ¡†æ¶çš„å®‰å…¨API
- [x] å®šæœŸè¿›è¡ŒSQLæ³¨å…¥å®‰å…¨æ‰«æ

---

## 5. ğŸ“ æ–‡ä»¶ä¸Šä¼ å®‰å…¨


### 5.1 æ–‡ä»¶ä¸Šä¼ çš„å®‰å…¨é£é™©


**ğŸš¨ å¸¸è§æ”»å‡»æ–¹å¼**ï¼š

```
é£é™©ç±»å‹              æ”»å‡»ç¤ºä¾‹                     å±å®³
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ¶æ„æ–‡ä»¶ä¸Šä¼       ä¸Šä¼ webshell.jsp          â†’ è·å–æœåŠ¡å™¨æ§åˆ¶æƒ
æ–‡ä»¶åæ³¨å…¥        ä¸Šä¼ ../../../etc/passwd   â†’ è¦†ç›–ç³»ç»Ÿæ–‡ä»¶
å¤§æ–‡ä»¶æ”»å‡»        ä¸Šä¼ 10GBæ–‡ä»¶              â†’ è€—å°½ç£ç›˜ç©ºé—´
ç—…æ¯’æœ¨é©¬          ä¸Šä¼ ç—…æ¯’.exe              â†’ æ„ŸæŸ“æœåŠ¡å™¨
```

### 5.2 Spring MVCæ–‡ä»¶ä¸Šä¼ é…ç½®


**ğŸ“ åŸºç¡€é…ç½®**ï¼š

```java
@Configuration
public class FileUploadConfig {
    
    @Bean
    public MultipartResolver multipartResolver() {
        CommonsMultipartResolver resolver = new CommonsMultipartResolver();
        
        // é™åˆ¶æ€»ä¸Šä¼ å¤§å° 10MB
        resolver.setMaxUploadSize(10 * 1024 * 1024);
        
        // é™åˆ¶å•ä¸ªæ–‡ä»¶å¤§å° 5MB
        resolver.setMaxUploadSizePerFile(5 * 1024 * 1024);
        
        // è®¾ç½®ç¼–ç 
        resolver.setDefaultEncoding("UTF-8");
        
        return resolver;
    }
}
```

### 5.3 å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ å®ç°


**ğŸ›¡ï¸ å®Œæ•´çš„å®‰å…¨ä¸Šä¼ ç¤ºä¾‹**ï¼š

```java
@Controller
public class FileUploadController {
    
    // å…è®¸çš„æ–‡ä»¶ç±»å‹ç™½åå•
    private static final Set<String> ALLOWED_EXTENSIONS = 
        Set.of("jpg", "jpeg", "png", "gif", "pdf", "doc", "docx");
    
    // å…è®¸çš„MIMEç±»å‹
    private static final Set<String> ALLOWED_MIME_TYPES = 
        Set.of("image/jpeg", "image/png", "image/gif", 
               "application/pdf", "application/msword");
    
    @PostMapping("/upload")
    public ResponseEntity<String> uploadFile(
            @RequestParam("file") MultipartFile file) {
        
        // 1ï¸âƒ£ æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸ºç©º
        if (file.isEmpty()) {
            return ResponseEntity.badRequest().body("æ–‡ä»¶ä¸èƒ½ä¸ºç©º");
        }
        
        // 2ï¸âƒ£ æ£€æŸ¥æ–‡ä»¶å¤§å°
        if (file.getSize() > 5 * 1024 * 1024) {  // 5MB
            return ResponseEntity.badRequest().body("æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡5MB");
        }
        
        // 3ï¸âƒ£ éªŒè¯æ–‡ä»¶æ‰©å±•å
        String originalFilename = file.getOriginalFilename();
        String extension = getFileExtension(originalFilename);
        
        if (!ALLOWED_EXTENSIONS.contains(extension.toLowerCase())) {
            return ResponseEntity.badRequest()
                .body("ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹ï¼š" + extension);
        }
        
        // 4ï¸âƒ£ éªŒè¯MIMEç±»å‹
        String mimeType = file.getContentType();
        if (!ALLOWED_MIME_TYPES.contains(mimeType)) {
            return ResponseEntity.badRequest()
                .body("ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ï¼š" + mimeType);
        }
        
        // 5ï¸âƒ£ ç”Ÿæˆå®‰å…¨çš„æ–‡ä»¶åï¼ˆé˜²æ­¢è·¯å¾„éå†ï¼‰
        String safeFilename = generateSafeFilename(originalFilename);
        
        // 6ï¸âƒ£ ç—…æ¯’æ‰«æï¼ˆå¯é€‰ï¼Œä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼‰
        if (containsVirus(file)) {
            return ResponseEntity.badRequest().body("æ–‡ä»¶åŒ…å«æ¶æ„å†…å®¹");
        }
        
        // 7ï¸âƒ£ ä¿å­˜æ–‡ä»¶
        try {
            Path uploadPath = Paths.get("uploads").toAbsolutePath();
            Files.createDirectories(uploadPath);
            
            Path filePath = uploadPath.resolve(safeFilename);
            Files.copy(file.getInputStream(), filePath, 
                      StandardCopyOption.REPLACE_EXISTING);
            
            return ResponseEntity.ok("æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼š" + safeFilename);
            
        } catch (IOException e) {
            return ResponseEntity.status(500).body("æ–‡ä»¶ä¿å­˜å¤±è´¥");
        }
    }
    
    /**
     * ç”Ÿæˆå®‰å…¨çš„æ–‡ä»¶å
     */
    private String generateSafeFilename(String originalFilename) {
        // ç§»é™¤è·¯å¾„ä¿¡æ¯
        String filename = Paths.get(originalFilename).getFileName().toString();
        
        // ç”ŸæˆUUIDé¿å…é‡åå’Œè·¯å¾„éå†
        String uuid = UUID.randomUUID().toString();
        String extension = getFileExtension(filename);
        
        return uuid + "." + extension;
    }
    
    /**
     * è·å–æ–‡ä»¶æ‰©å±•å
     */
    private String getFileExtension(String filename) {
        int lastDot = filename.lastIndexOf('.');
        return lastDot > 0 ? filename.substring(lastDot + 1) : "";
    }
    
    /**
     * ç—…æ¯’æ‰«æï¼ˆç¤ºä¾‹ï¼‰
     */
    private boolean containsVirus(MultipartFile file) {
        // è¿™é‡Œå¯ä»¥é›†æˆClamAVç­‰æ€æ¯’è½¯ä»¶
        // ç®€å•ç¤ºä¾‹ï¼šæ£€æŸ¥æ–‡ä»¶å†…å®¹å…³é”®å­—
        try {
            String content = new String(file.getBytes());
            return content.contains("<script>") || 
                   content.contains("<?php");
        } catch (IOException e) {
            return true;  // æ— æ³•è¯»å–è§†ä¸ºæœ‰é£é™©
        }
    }
}
```

### 5.4 æ–‡ä»¶ä¸Šä¼ å®‰å…¨é…ç½®


**ğŸ”’ Web.xmlæˆ–Spring Booté…ç½®**ï¼š

```java
// application.yml
spring:
  servlet:
    multipart:
      enabled: true
      max-file-size: 5MB        # å•ä¸ªæ–‡ä»¶å¤§å°é™åˆ¶
      max-request-size: 10MB    # æ€»è¯·æ±‚å¤§å°é™åˆ¶
      file-size-threshold: 2KB  # æ–‡ä»¶å†™å…¥ç£ç›˜çš„é˜ˆå€¼
```

**ğŸ›¡ï¸ æ–‡ä»¶å­˜å‚¨å®‰å…¨å»ºè®®**ï¼š

```
âœ… æ¨èåšæ³•ï¼š
1. ä¸Šä¼ æ–‡ä»¶å­˜å‚¨åœ¨Webæ ¹ç›®å½•ä¹‹å¤–
2. ä½¿ç”¨UUIDé‡å‘½åï¼Œéšè—çœŸå®æ–‡ä»¶å
3. è®¾ç½®åˆç†çš„æ–‡ä»¶æƒé™ï¼ˆåªè¯»ï¼‰
4. å®šæœŸæ¸…ç†ä¸´æ—¶æ–‡ä»¶
5. å¯¹ä¸Šä¼ ç›®å½•ç¦ç”¨è„šæœ¬æ‰§è¡Œæƒé™

âŒ å±é™©åšæ³•ï¼š
1. ç›´æ¥ä½¿ç”¨ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶å
2. å…è®¸ä¸Šä¼ åˆ°Webæ ¹ç›®å½•
3. ä¸é™åˆ¶æ–‡ä»¶ç±»å‹
4. ä¸æ£€æŸ¥æ–‡ä»¶å†…å®¹
```

---

## 6. âœ… å‚æ•°éªŒè¯ä¸è¾“å…¥è¿‡æ»¤


### 6.1 ä¸ºä»€ä¹ˆéœ€è¦å‚æ•°éªŒè¯


**ğŸ’¡ ç†è§£å‚æ•°éªŒè¯**ï¼š
å°±åƒæœºåœºå®‰æ£€ï¼Œä¸æ˜¯æ¯ä¸ªäººéƒ½èƒ½ç›´æ¥è¿›å…¥ï¼Œå¿…é¡»æ£€æŸ¥èº«ä»½ã€è¡Œæã€‚åŒæ ·ï¼Œä¸æ˜¯æ‰€æœ‰è¾“å…¥éƒ½èƒ½ç›´æ¥è¿›å…¥ç³»ç»Ÿï¼Œå¿…é¡»éªŒè¯åˆæ³•æ€§ã€‚

### 6.2 ä½¿ç”¨Hibernate ValidatoréªŒè¯


**ğŸ“ å®ä½“ç±»éªŒè¯æ³¨è§£**ï¼š

```java
public class UserRegisterDTO {
    
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @Size(min = 3, max = 20, message = "ç”¨æˆ·åé•¿åº¦3-20å­—ç¬¦")
    @Pattern(regexp = "^[a-zA-Z0-9_]+$", message = "ç”¨æˆ·ååªèƒ½åŒ…å«å­—æ¯æ•°å­—ä¸‹åˆ’çº¿")
    private String username;
    
    @NotBlank(message = "å¯†ç ä¸èƒ½ä¸ºç©º")
    @Size(min = 6, max = 20, message = "å¯†ç é•¿åº¦6-20å­—ç¬¦")
    private String password;
    
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    @NotBlank(message = "é‚®ç®±ä¸èƒ½ä¸ºç©º")
    private String email;
    
    @Min(value = 1, message = "å¹´é¾„å¿…é¡»å¤§äº0")
    @Max(value = 150, message = "å¹´é¾„å¿…é¡»å°äº150")
    private Integer age;
    
    @Pattern(regexp = "^1[3-9]\\d{9}$", message = "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®")
    private String phone;
    
    // getter/setter...
}
```

**ğŸ¯ Controllerä¸­ä½¿ç”¨éªŒè¯**ï¼š

```java
@RestController
@RequestMapping("/api/user")
public class UserController {
    
    @PostMapping("/register")
    public ResponseEntity<?> register(
            @Valid @RequestBody UserRegisterDTO dto,
            BindingResult result) {  // æ¥æ”¶éªŒè¯ç»“æœ
        
        // æ£€æŸ¥éªŒè¯æ˜¯å¦é€šè¿‡
        if (result.hasErrors()) {
            // æ”¶é›†æ‰€æœ‰é”™è¯¯ä¿¡æ¯
            List<String> errors = result.getAllErrors()
                .stream()
                .map(error -> error.getDefaultMessage())
                .collect(Collectors.toList());
            
            return ResponseEntity.badRequest().body(errors);
        }
        
        // éªŒè¯é€šè¿‡ï¼Œå¤„ç†æ³¨å†Œé€»è¾‘
        userService.register(dto);
        return ResponseEntity.ok("æ³¨å†ŒæˆåŠŸ");
    }
}
```

### 6.3 è‡ªå®šä¹‰éªŒè¯æ³¨è§£


**ğŸ”§ åˆ›å»ºè‡ªå®šä¹‰éªŒè¯æ³¨è§£**ï¼š

```java
// 1. å®šä¹‰æ³¨è§£
@Target({ElementType.FIELD, ElementType.PARAMETER})
@Retention(RetentionPolicy.RUNTIME)
@Constraint(validatedBy = IdCardValidator.class)
public @interface ValidIdCard {
    String message() default "èº«ä»½è¯å·æ ¼å¼ä¸æ­£ç¡®";
    Class<?>[] groups() default {};
    Class<? extends Payload>[] payload() default {};
}

// 2. å®ç°éªŒè¯å™¨
public class IdCardValidator implements ConstraintValidator<ValidIdCard, String> {
    
    @Override
    public boolean isValid(String value, ConstraintValidatorContext context) {
        if (value == null || value.isEmpty()) {
            return true;  // ç©ºå€¼ç”±@NotBlankå¤„ç†
        }
        
        // èº«ä»½è¯å·éªŒè¯é€»è¾‘
        if (value.length() != 18) {
            return false;
        }
        
        // éªŒè¯æ ¼å¼ï¼šå‰17ä½æ•°å­— + æœ€å1ä½æ•°å­—æˆ–X
        return value.matches("^\\d{17}[\\dXx]$");
    }
}

// 3. ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£
public class UserDTO {
    @ValidIdCard(message = "è¯·è¾“å…¥æ­£ç¡®çš„èº«ä»½è¯å·")
    private String idCard;
}
```

### 6.4 è¾“å…¥è¿‡æ»¤ä¸æ¸…ç†


**ğŸ§¹ é€šç”¨è¾“å…¥æ¸…ç†å·¥å…·**ï¼š

```java
@Component
public class InputSanitizer {
    
    /**
     * æ¸…ç†å­—ç¬¦ä¸²ï¼šç§»é™¤ç‰¹æ®Šå­—ç¬¦
     */
    public String sanitizeString(String input) {
        if (input == null) return null;
        
        return input.trim()
                   .replaceAll("[<>\"']", "")  // ç§»é™¤å±é™©å­—ç¬¦
                   .replaceAll("\\s+", " ");   // è§„èŒƒåŒ–ç©ºç™½
    }
    
    /**
     * éªŒè¯å¹¶æ¸…ç†æ•°å­—
     */
    public Integer sanitizeInteger(String input, int min, int max) {
        try {
            int value = Integer.parseInt(input.trim());
            if (value < min || value > max) {
                throw new IllegalArgumentException("æ•°å€¼è¶…å‡ºèŒƒå›´");
            }
            return value;
        } catch (NumberFormatException e) {
            throw new IllegalArgumentException("æ— æ•ˆçš„æ•°å­—æ ¼å¼");
        }
    }
    
    /**
     * URLç™½åå•éªŒè¯
     */
    public boolean isValidUrl(String url) {
        if (url == null) return false;
        
        // åªå…è®¸httpå’Œhttpsåè®®
        return url.matches("^https?://[\\w.-]+(:\\d+)?(/.*)?$");
    }
    
    /**
     * è·¯å¾„éå†é˜²æŠ¤
     */
    public String sanitizePath(String path) {
        if (path == null) return null;
        
        // ç§»é™¤..å’Œ./ç­‰è·¯å¾„éå†å­—ç¬¦
        return path.replaceAll("\\.\\.", "")
                  .replaceAll("\\./", "")
                  .replaceAll("//+", "/");
    }
}
```

### 6.5 å…¨å±€å‚æ•°éªŒè¯


**ğŸŒ å…¨å±€éªŒè¯æ‹¦æˆªå™¨**ï¼š

```java
@ControllerAdvice
public class GlobalValidationHandler {
    
    /**
     * å¤„ç†@ValidéªŒè¯å¤±è´¥
     */
    @ExceptionHandler(MethodArgumentNotValidException.class)
    public ResponseEntity<?> handleValidationException(
            MethodArgumentNotValidException ex) {
        
        Map<String, String> errors = new HashMap<>();
        ex.getBindingResult().getFieldErrors().forEach(error -> {
            errors.put(error.getField(), error.getDefaultMessage());
        });
        
        return ResponseEntity.badRequest().body(errors);
    }
    
    /**
     * å¤„ç†@RequestParaméªŒè¯å¤±è´¥
     */
    @ExceptionHandler(ConstraintViolationException.class)
    public ResponseEntity<?> handleConstraintViolation(
            ConstraintViolationException ex) {
        
        List<String> errors = ex.getConstraintViolations()
            .stream()
            .map(violation -> violation.getMessage())
            .collect(Collectors.toList());
        
        return ResponseEntity.badRequest().body(errors);
    }
}
```

**âœ… éªŒè¯æœ€ä½³å®è·µ**ï¼š
- [x] å‰ç«¯éªŒè¯ + åç«¯éªŒè¯ï¼ˆåŒé‡ä¿éšœï¼‰
- [x] ä½¿ç”¨@Validæ³¨è§£è‡ªåŠ¨éªŒè¯
- [x] ç™½åå•éªŒè¯ä¼˜äºé»‘åå•
- [x] éªŒè¯å¤±è´¥è¿”å›æ˜ç¡®çš„é”™è¯¯ä¿¡æ¯
- [x] æ•æ„Ÿæ“ä½œå¢åŠ äºŒæ¬¡éªŒè¯

---

## 7. ğŸ” è¾“å‡ºç¼–ç ä¸å®‰å…¨å“åº”


### 7.1 ä¸ºä»€ä¹ˆéœ€è¦è¾“å‡ºç¼–ç 


**ğŸ’¡ æ¦‚å¿µç†è§£**ï¼š
è¾“å‡ºç¼–ç å°±åƒç»™å±é™©ç‰©å“è´´æ ‡ç­¾ï¼Œè®©æµè§ˆå™¨çŸ¥é“"è¿™æ˜¯æ™®é€šæ–‡æœ¬ï¼Œä¸è¦å½“æˆä»£ç æ‰§è¡Œ"ã€‚

**ğŸ­ åœºæ™¯ç¤ºä¾‹**ï¼š
```
ç”¨æˆ·è¾“å…¥ï¼š<script>alert('XSS')</script>

ä¸ç¼–ç ç›´æ¥è¾“å‡ºï¼š
æµè§ˆå™¨çœ‹åˆ°ï¼š<script>alert('XSS')</script>
æµè§ˆå™¨æ‰§è¡Œï¼šå¼¹å‡ºè­¦å‘Šæ¡†ï¼ˆXSSæ”»å‡»æˆåŠŸï¼‰

ç¼–ç åè¾“å‡ºï¼š
æµè§ˆå™¨çœ‹åˆ°ï¼š&lt;script&gt;alert('XSS')&lt;/script&gt;
æµè§ˆå™¨æ˜¾ç¤ºï¼š<script>alert('XSS')</script>ï¼ˆçº¯æ–‡æœ¬ï¼‰
```

### 7.2 ä¸åŒåœºæ™¯çš„ç¼–ç æ–¹å¼


**ğŸ“Š ç¼–ç æ–¹å¼å¯¹æ¯”**ï¼š

| è¾“å‡ºåœºæ™¯ | ç¼–ç æ–¹å¼ | ç¤ºä¾‹ |
|---------|---------|------|
| **HTMLå†…å®¹** | HTMLå®ä½“ç¼–ç  | `< â†’ &lt;` |
| **HTMLå±æ€§** | HTMLå±æ€§ç¼–ç  | `" â†’ &quot;` |
| **JavaScript** | JavaScriptç¼–ç  | `' â†’ \'` |
| **URLå‚æ•°** | URLç¼–ç  | `ç©ºæ ¼ â†’ %20` |
| **CSS** | CSSç¼–ç  | `< â†’ \3c` |

### 7.3 Spring MVCè¾“å‡ºç¼–ç 


**ğŸ›¡ï¸ Thymeleafè‡ªåŠ¨ç¼–ç **ï¼š

```html
<!-- âœ… è‡ªåŠ¨HTMLç¼–ç ï¼ˆé»˜è®¤ï¼‰ -->
<p th:text="${userInput}">ç”¨æˆ·è¾“å…¥</p>
<!-- è¾“å…¥ï¼š<script>alert(1)</script> -->
<!-- è¾“å‡ºï¼š&lt;script&gt;alert(1)&lt;/script&gt; -->

<!-- âœ… åœ¨å±æ€§ä¸­è‡ªåŠ¨ç¼–ç  -->
<input type="text" th:value="${userInput}" />
<!-- è¾“å…¥ï¼š"><script>alert(1)</script> -->
<!-- è¾“å‡ºï¼š&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt; -->

<!-- âœ… JavaScriptä¸­çš„ç¼–ç  -->
<script th:inline="javascript">
    var data = /*[[${userInput}]]*/ '';
    // Thymeleafä¼šè‡ªåŠ¨JavaScriptç¼–ç 
</script>

<!-- âŒ ä¸ç¼–ç è¾“å‡ºï¼ˆå±é™©ï¼ï¼‰ -->
<p th:utext="${userInput}">ç”¨æˆ·è¾“å…¥</p>
<!-- åªåœ¨ç¡®å®šå†…å®¹å®‰å…¨æ—¶ä½¿ç”¨ -->
```

**ğŸ”§ æ‰‹åŠ¨ç¼–ç å·¥å…·ç±»**ï¼š

```java
@Component
public class OutputEncoder {
    
    /**
     * HTMLç¼–ç 
     */
    public static String htmlEncode(String input) {
        if (input == null) return null;
        
        return input.replace("&", "&amp;")
                   .replace("<", "&lt;")
                   .replace(">", "&gt;")
                   .replace("\"", "&quot;")
                   .replace("'", "&#x27;");
    }
    
    /**
     * JavaScriptç¼–ç 
     */
    public static String jsEncode(String input) {
        if (input == null) return null;
        
        StringBuilder encoded = new StringBuilder();
        for (char c : input.toCharArray()) {
            if (c == '\'') {
                encoded.append("\\'");
            } else if (c == '\"') {
                encoded.append("\\\"");
            } else if (c == '\\') {
                encoded.append("\\\\");
            } else if (c == '\n') {
                encoded.append("\\n");
            } else {
                encoded.append(c);
            }
        }
        return encoded.toString();
    }
    
    /**
     * URLç¼–ç 
     */
    public static String urlEncode(String input) {
        try {
            return URLEncoder.encode(input, "UTF-8");
        } catch (UnsupportedEncodingException e) {
            return input;
        }
    }
}
```

### 7.4 å®‰å…¨çš„å“åº”å¤´è®¾ç½®


**ğŸ”’ HTTPå®‰å…¨å“åº”å¤´**ï¼š

```java
@Configuration
public class SecurityHeaderConfig {
    
    @Bean
    public FilterRegistrationBean<SecurityHeaderFilter> securityHeaderFilter() {
        FilterRegistrationBean<SecurityHeaderFilter> registration = 
            new FilterRegistrationBean<>();
        registration.setFilter(new SecurityHeaderFilter());
        registration.addUrlPatterns("/*");
        return registration;
    }
}

public class SecurityHeaderFilter implements Filter {
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                         FilterChain chain) throws IOException, ServletException {
        
        HttpServletResponse httpResponse = (HttpServletResponse) response;
        
        // 1ï¸âƒ£ é˜²æ­¢ç‚¹å‡»åŠ«æŒ
        httpResponse.setHeader("X-Frame-Options", "DENY");
        
        // 2ï¸âƒ£ é˜²æ­¢MIMEç±»å‹å—…æ¢
        httpResponse.setHeader("X-Content-Type-Options", "nosniff");
        
        // 3ï¸âƒ£ XSSä¿æŠ¤
        httpResponse.setHeader("X-XSS-Protection", "1; mode=block");
        
        // 4ï¸âƒ£ å¼ºåˆ¶HTTPS
        httpResponse.setHeader("Strict-Transport-Security", 
            "max-age=31536000; includeSubDomains");
        
        // 5ï¸âƒ£ å†…å®¹å®‰å…¨ç­–ç•¥
        httpResponse.setHeader("Content-Security-Policy", 
            "default-src 'self'; script-src 'self' 'unsafe-inline'");
        
        // 6ï¸âƒ£ å¼•ç”¨ç­–ç•¥
        httpResponse.setHeader("Referrer-Policy", "strict-origin-when-cross-origin");
        
        chain.doFilter(request, response);
    }
}
```

**ğŸ“‹ å®‰å…¨å“åº”å¤´è¯´æ˜**ï¼š

```
ğŸ”¹ X-Frame-Options: DENY
   â†’ é˜²æ­¢é¡µé¢è¢«åµŒå…¥iframeï¼Œé¿å…ç‚¹å‡»åŠ«æŒ

ğŸ”¹ X-Content-Type-Options: nosniff
   â†’ ç¦æ­¢æµè§ˆå™¨MIMEç±»å‹å—…æ¢ï¼Œé˜²æ­¢XSS

ğŸ”¹ X-XSS-Protection: 1; mode=block
   â†’ å¯ç”¨æµè§ˆå™¨XSSè¿‡æ»¤å™¨

ğŸ”¹ Strict-Transport-Security
   â†’ å¼ºåˆ¶ä½¿ç”¨HTTPSï¼Œé˜²æ­¢ä¸­é—´äººæ”»å‡»

ğŸ”¹ Content-Security-Policy
   â†’ é™åˆ¶èµ„æºåŠ è½½æ¥æºï¼Œé˜²æ­¢XSS

ğŸ”¹ Referrer-Policy
   â†’ æ§åˆ¶Refererä¿¡æ¯æ³„éœ²
```

---

## 8. ğŸ”§ å®‰å…¨å¤´é…ç½®


### 8.1 å®Œæ•´çš„å®‰å…¨å¤´é…ç½®


**ğŸ›¡ï¸ Spring Securityé›†æˆæ–¹å¼**ï¼š

```java
@Configuration
@EnableWebSecurity
public class WebSecurityConfig extends WebSecurityConfigurerAdapter {
    
    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http
            // å®‰å…¨å¤´é…ç½®
            .headers()
                .frameOptions().deny()                    // é˜²ç‚¹å‡»åŠ«æŒ
                .contentTypeOptions().and()               // é˜²MIMEå—…æ¢
                .xssProtection().and()                    // XSSä¿æŠ¤
                .httpStrictTransportSecurity()            // HSTS
                    .maxAgeInSeconds(31536000)
                    .includeSubDomains(true)
                    .and()
                .contentSecurityPolicy(                   // CSPç­–ç•¥
                    "default-src 'self'; " +
                    "script-src 'self' 'unsafe-inline'; " +
                    "style-src 'self' 'unsafe-inline'"
                )
                .and()
            .and()
            
            // å…¶ä»–å®‰å…¨é…ç½®
            .csrf().and()
            .authorizeRequests()
                .anyRequest().authenticated();
    }
}
```

### 8.2 è‡ªå®šä¹‰å®‰å…¨å¤´è¿‡æ»¤å™¨


**ğŸ”§ çµæ´»çš„å®‰å…¨å¤´é…ç½®**ï¼š

```java
@Component
public class CustomSecurityHeaderFilter extends OncePerRequestFilter {
    
    @Override
    protected void doFilterInternal(HttpServletRequest request,
                                   HttpServletResponse response,
                                   FilterChain filterChain) 
            throws ServletException, IOException {
        
        // åŸºç¡€å®‰å…¨å¤´
        addSecurityHeaders(response);
        
        // æ ¹æ®è·¯å¾„å®šåˆ¶CSPç­–ç•¥
        String path = request.getRequestURI();
        if (path.startsWith("/admin")) {
            // ç®¡ç†åå°ï¼šæ›´ä¸¥æ ¼çš„CSP
            response.setHeader("Content-Security-Policy", 
                "default-src 'self'; script-src 'self'");
        } else if (path.startsWith("/api")) {
            // APIæ¥å£ï¼šç¦ç”¨æ¡†æ¶åµŒå…¥
            response.setHeader("X-Frame-Options", "DENY");
        }
        
        filterChain.doFilter(request, response);
    }
    
    private void addSecurityHeaders(HttpServletResponse response) {
        // é˜²æ­¢ç‚¹å‡»åŠ«æŒ
        response.setHeader("X-Frame-Options", "SAMEORIGIN");
        
        // é˜²æ­¢MIMEå—…æ¢
        response.setHeader("X-Content-Type-Options", "nosniff");
        
        // XSSä¿æŠ¤
        response.setHeader("X-XSS-Protection", "1; mode=block");
        
        // ç¦ç”¨ç¼“å­˜æ•æ„Ÿé¡µé¢
        response.setHeader("Cache-Control", 
            "no-cache, no-store, must-revalidate");
        response.setHeader("Pragma", "no-cache");
        response.setHeader("Expires", "0");
        
        // æƒé™ç­–ç•¥
        response.setHeader("Permissions-Policy", 
            "geolocation=(), microphone=(), camera=()");
    }
}
```

### 8.3 å®‰å…¨å¤´æœ€ä½³å®è·µ


**âœ… æ¨èé…ç½®ç»„åˆ**ï¼š

```
ç”Ÿäº§ç¯å¢ƒæ¨èé…ç½®ï¼š

ğŸ“ å¼ºåˆ¶HTTPSï¼š
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload

ğŸ“ é˜²ç‚¹å‡»åŠ«æŒï¼š
X-Frame-Options: DENY
ï¼ˆæˆ– SAMEORIGINï¼Œå¦‚æœéœ€è¦å†…éƒ¨åµŒå…¥ï¼‰

ğŸ“ é˜²MIMEå—…æ¢ï¼š
X-Content-Type-Options: nosniff

ğŸ“ XSSä¿æŠ¤ï¼š
X-XSS-Protection: 1; mode=block

ğŸ“ CSPç­–ç•¥ï¼ˆæ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´ï¼‰ï¼š
Content-Security-Policy: 
  default-src 'self';
  script-src 'self' https://cdn.trusted.com;
  style-src 'self' 'unsafe-inline';
  img-src 'self' data: https:;
  font-src 'self';
  connect-src 'self';
  frame-ancestors 'none';

ğŸ“ å¼•ç”¨ç­–ç•¥ï¼š
Referrer-Policy: strict-origin-when-cross-origin

ğŸ“ æƒé™ç­–ç•¥ï¼š
Permissions-Policy: 
  geolocation=(), 
  microphone=(), 
  camera=()
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„å®‰å…¨æ¦‚å¿µ


**ğŸ” å®‰å…¨é˜²æŠ¤æ ¸å¿ƒ**ï¼š
```
ğŸ”¹ XSSé˜²æŠ¤ = è¾“å…¥éªŒè¯ + è¾“å‡ºç¼–ç  + CSP
ğŸ”¹ CSRFé˜²æŠ¤ = TokenéªŒè¯ + SameSite Cookie
ğŸ”¹ SQLæ³¨å…¥é˜²æŠ¤ = å‚æ•°åŒ–æŸ¥è¯¢ + ORMæ¡†æ¶
ğŸ”¹ æ–‡ä»¶ä¸Šä¼ å®‰å…¨ = ç±»å‹éªŒè¯ + å¤§å°é™åˆ¶ + å®‰å…¨å­˜å‚¨
ğŸ”¹ å‚æ•°éªŒè¯ = @Validæ³¨è§£ + è‡ªå®šä¹‰éªŒè¯å™¨
ğŸ”¹ è¾“å‡ºç¼–ç  = æ¨¡æ¿å¼•æ“è‡ªåŠ¨ç¼–ç  + æ‰‹åŠ¨ç¼–ç 
ğŸ”¹ å®‰å…¨å¤´ = å¤šå±‚é˜²æŠ¤ + æœ€ä½³é…ç½®
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ’¡ æ ¸å¿ƒåŸåˆ™è®°å¿†**ï¼š

```
1ï¸âƒ£ æ°¸è¿œä¸è¦ä¿¡ä»»ç”¨æˆ·è¾“å…¥
   â†’ æ‰€æœ‰è¾“å…¥éƒ½è¦éªŒè¯ã€è¿‡æ»¤ã€è½¬ä¹‰

2ï¸âƒ£ çºµæ·±é˜²å¾¡ç­–ç•¥
   â†’ å¤šå±‚é˜²æŠ¤ï¼Œä¸ä¾èµ–å•ä¸€é˜²çº¿

3ï¸âƒ£ æœ€å°æƒé™åŸåˆ™
   â†’ åªç»™å¿…è¦çš„æƒé™ï¼Œå‡å°‘æ”»å‡»é¢

4ï¸âƒ£ å®‰å…¨å¼€å‘ç”Ÿå‘½å‘¨æœŸ
   â†’ è®¾è®¡â†’å¼€å‘â†’æµ‹è¯•â†’éƒ¨ç½²ï¼Œæ¯ä¸ªç¯èŠ‚éƒ½è¦è€ƒè™‘å®‰å…¨
```

### 9.3 å®‰å…¨æ£€æŸ¥æ¸…å•


**âœ… ä¸Šçº¿å‰å¿…æŸ¥é¡¹**ï¼š

- [ ] **XSSé˜²æŠ¤**
  - [ ] æ‰€æœ‰ç”¨æˆ·è¾“å…¥å·²è½¬ä¹‰
  - [ ] ä½¿ç”¨æ¨¡æ¿å¼•æ“è‡ªåŠ¨ç¼–ç 
  - [ ] é…ç½®CSPç­–ç•¥
  
- [ ] **CSRFé˜²æŠ¤**
  - [ ] æ‰€æœ‰POST/PUT/DELETEè¯·æ±‚éªŒè¯Token
  - [ ] Cookieè®¾ç½®SameSiteå±æ€§
  
- [ ] **SQLæ³¨å…¥é˜²æŠ¤**
  - [ ] ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
  - [ ] é¿å…å­—ç¬¦ä¸²æ‹¼æ¥SQL
  
- [ ] **æ–‡ä»¶ä¸Šä¼ **
  - [ ] éªŒè¯æ–‡ä»¶ç±»å‹å’Œå¤§å°
  - [ ] é‡å‘½åæ–‡ä»¶é¿å…è¦†ç›–
  - [ ] å­˜å‚¨åœ¨Webç›®å½•å¤–
  
- [ ] **å‚æ•°éªŒè¯**
  - [ ] å…³é”®å‚æ•°ä½¿ç”¨@ValidéªŒè¯
  - [ ] è‡ªå®šä¹‰å¤æ‚éªŒè¯é€»è¾‘
  
- [ ] **å®‰å…¨å“åº”å¤´**
  - [ ] X-Frame-Optionså·²è®¾ç½®
  - [ ] X-Content-Type-Optionså·²è®¾ç½®
  - [ ] CSPç­–ç•¥å·²é…ç½®

### 9.4 å®æˆ˜åº”ç”¨å»ºè®®


**ğŸ¯ å¼€å‘ä¸­çš„å®è·µ**ï¼š

```
é˜¶æ®µ1ï¼šéœ€æ±‚åˆ†æ
â†’ è¯†åˆ«å®‰å…¨é£é™©ç‚¹
â†’ è®¾è®¡å®‰å…¨é˜²æŠ¤æ–¹æ¡ˆ

é˜¶æ®µ2ï¼šç¼–ç å®ç°
â†’ ä½¿ç”¨å®‰å…¨çš„APIå’Œæ¡†æ¶
â†’ éµå¾ªå®‰å…¨ç¼–ç è§„èŒƒ

é˜¶æ®µ3ï¼šæµ‹è¯•éªŒè¯
â†’ è¿›è¡Œå®‰å…¨æµ‹è¯•ï¼ˆæ¸—é€æµ‹è¯•ï¼‰
â†’ ä½¿ç”¨OWASP ZAPç­‰å·¥å…·æ‰«æ

é˜¶æ®µ4ï¼šéƒ¨ç½²ä¸Šçº¿
â†’ é…ç½®ç”Ÿäº§ç¯å¢ƒå®‰å…¨å‚æ•°
â†’ å¯ç”¨æ‰€æœ‰å®‰å…¨é˜²æŠ¤æªæ–½

é˜¶æ®µ5ï¼šæŒç»­ç›‘æ§
â†’ è®°å½•å®‰å…¨æ—¥å¿—
â†’ åŠæ—¶æ›´æ–°å®‰å…¨è¡¥ä¸
```

**ğŸ”¥ å¸¸è§è¯¯åŒºé¿å…**ï¼š

```
âŒ è¯¯åŒº1ï¼š"æˆ‘çš„åº”ç”¨å¾ˆå°ï¼Œä¸ä¼šè¢«æ”»å‡»"
âœ… æ­£ç¡®ï¼šå†å°çš„åº”ç”¨ä¹Ÿè¦åšåŸºæœ¬é˜²æŠ¤

âŒ è¯¯åŒº2ï¼š"å‰ç«¯éªŒè¯å°±å¤Ÿäº†"
âœ… æ­£ç¡®ï¼šå‰ç«¯éªŒè¯å¯ç»•è¿‡ï¼Œåç«¯éªŒè¯å¿…ä¸å¯å°‘

âŒ è¯¯åŒº3ï¼š"ç”¨äº†æ¡†æ¶å°±å®‰å…¨äº†"
âœ… æ­£ç¡®ï¼šæ¡†æ¶æä¾›å·¥å…·ï¼Œè¿˜éœ€æ­£ç¡®ä½¿ç”¨

âŒ è¯¯åŒº4ï¼š"å®‰å…¨æ˜¯ä¸Šçº¿å‰æ‰è€ƒè™‘çš„"
âœ… æ­£ç¡®ï¼šä»è®¾è®¡é˜¶æ®µå°±è¦è€ƒè™‘å®‰å…¨
```

**ğŸš€ è¿›é˜¶å­¦ä¹ è·¯å¾„**ï¼š

```
åŸºç¡€é˜¶æ®µ â†’ ç†è§£æœ¬ç« æ‰€æœ‰é˜²æŠ¤æœºåˆ¶
  â†“
å®è·µé˜¶æ®µ â†’ åœ¨é¡¹ç›®ä¸­åº”ç”¨è¿™äº›æŠ€æœ¯
  â†“
è¿›é˜¶é˜¶æ®µ â†’ å­¦ä¹ Spring Securityæ·±å…¥é…ç½®
  â†“
ä¸“å®¶é˜¶æ®µ â†’ ç ”ç©¶OWASP Top 10ï¼Œè¿›è¡Œå®‰å…¨å®¡è®¡
```

---

**ğŸ“ å­¦ä¹ å»ºè®®**ï¼š

1. **åŠ¨æ‰‹å®è·µ**ï¼šæ­å»ºæµ‹è¯•ç¯å¢ƒï¼Œå°è¯•å„ç§æ”»å‡»å’Œé˜²æŠ¤
2. **é˜…è¯»å®˜æ–¹æ–‡æ¡£**ï¼šSpring Securityã€OWASPæ–‡æ¡£
3. **å…³æ³¨å®‰å…¨åŠ¨æ€**ï¼šå®šæœŸæŸ¥çœ‹å®‰å…¨æ¼æ´å…¬å‘Š
4. **å‚ä¸å®‰å…¨ç¤¾åŒº**ï¼šäº¤æµç»éªŒï¼Œå­¦ä¹ æœ€ä½³å®è·µ

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
ç”¨æˆ·è¾“å…¥ä¸å¯ä¿¡ï¼ŒéªŒè¯è¿‡æ»¤åŠ è½¬ä¹‰
SQLæ³¨å…¥ç”¨å‚æ•°ï¼ŒCSRFè¦æœ‰Tokenå€¼
æ–‡ä»¶ä¸Šä¼ è¦è°¨æ…ï¼Œç±»å‹å¤§å°éƒ½é™åˆ¶
è¾“å‡ºç¼–ç é˜²XSSï¼Œå®‰å…¨å¤´é…å…¨æ–¹ä½
```