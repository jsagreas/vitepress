---
title: 2ã€è‡ªå®šä¹‰å±æ€§ç¼–è¾‘å™¨
---
## ğŸ“š ç›®å½•

1. [è‡ªå®šä¹‰ç¼–è¾‘å™¨æ¦‚è¿°](#1-è‡ªå®šä¹‰ç¼–è¾‘å™¨æ¦‚è¿°)
2. [PropertyEditoræ ¸å¿ƒæ¦‚å¿µ](#2-PropertyEditoræ ¸å¿ƒæ¦‚å¿µ)
3. [è‡ªå®šä¹‰ç¼–è¾‘å™¨å®ç°](#3-è‡ªå®šä¹‰ç¼–è¾‘å™¨å®ç°)
4. [ç¼–è¾‘å™¨æ³¨å†Œæ–¹å¼](#4-ç¼–è¾‘å™¨æ³¨å†Œæ–¹å¼)
5. [InitBinderæ³¨è§£è¯¦è§£](#5-InitBinderæ³¨è§£è¯¦è§£)
6. [WebDataBinderå·¥ä½œæœºåˆ¶](#6-WebDataBinderå·¥ä½œæœºåˆ¶)
7. [å…¨å±€ä¸å±€éƒ¨ç¼–è¾‘å™¨](#7-å…¨å±€ä¸å±€éƒ¨ç¼–è¾‘å™¨)
8. [ç¼–è¾‘å™¨ä¼˜å…ˆçº§è§„åˆ™](#8-ç¼–è¾‘å™¨ä¼˜å…ˆçº§è§„åˆ™)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ è‡ªå®šä¹‰ç¼–è¾‘å™¨æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯è‡ªå®šä¹‰ç¼–è¾‘å™¨


**é€šä¿—ç†è§£**ï¼š
æƒ³è±¡ä½ åœ¨ç½‘ä¸Šå¡«è¡¨å•ï¼Œè¾“å…¥çš„éƒ½æ˜¯æ–‡å­—ï¼Œä½†åå°éœ€è¦çš„å¯èƒ½æ˜¯æ—¥æœŸã€é‡‘é¢ã€å¯¹è±¡ç­‰å„ç§ç±»å‹ã€‚è‡ªå®šä¹‰ç¼–è¾‘å™¨å°±åƒä¸€ä¸ª"ç¿»è¯‘å®˜"ï¼ŒæŠŠç”¨æˆ·è¾“å…¥çš„æ–‡å­—è½¬æ¢æˆç¨‹åºéœ€è¦çš„æ ¼å¼ã€‚

```
ç”¨æˆ·è¾“å…¥ï¼š"2025-01-15"  â†’  [è‡ªå®šä¹‰ç¼–è¾‘å™¨]  â†’  Dateå¯¹è±¡
ç”¨æˆ·è¾“å…¥ï¼š"100.5"       â†’  [è‡ªå®šä¹‰ç¼–è¾‘å™¨]  â†’  BigDecimalå¯¹è±¡
ç”¨æˆ·è¾“å…¥ï¼š"1,2,3"       â†’  [è‡ªå®šä¹‰ç¼–è¾‘å™¨]  â†’  List<Integer>å¯¹è±¡
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦è‡ªå®šä¹‰ç¼–è¾‘å™¨


**å®é™…é—®é¢˜åœºæ™¯**ï¼š

> ğŸ’¡ **åœºæ™¯ä¸€ï¼šæ—¥æœŸæ ¼å¼è½¬æ¢**
> 
> å‰ç«¯ä¼ æ¥å­—ç¬¦ä¸² `"2025-01-15"`ï¼Œåç«¯éœ€è¦ `Date` å¯¹è±¡ï¼ŒSpringé»˜è®¤è½¬æ¢å¯èƒ½å¤±è´¥

> ğŸ’¡ **åœºæ™¯äºŒï¼šç‰¹æ®Šå¯¹è±¡ç»‘å®š**
> 
> å‰ç«¯ä¼ æ¥ç”¨æˆ·ID `"1001"`ï¼Œåç«¯éœ€è¦å®Œæ•´çš„ `User` å¯¹è±¡ï¼ˆéœ€è¦ä»æ•°æ®åº“æŸ¥è¯¢ï¼‰

> ğŸ’¡ **åœºæ™¯ä¸‰ï¼šè‡ªå®šä¹‰æ ¼å¼è§£æ**
> 
> å‰ç«¯ä¼ æ¥ `"100,200,300"`ï¼Œåç«¯éœ€è¦ `List<Integer>`

**è§£å†³æ–¹æ¡ˆå¯¹æ¯”**ï¼š

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|----------|
| **æ‰‹åŠ¨è½¬æ¢** | çµæ´»æ§åˆ¶ | ä»£ç é‡å¤ï¼Œç»´æŠ¤å›°éš¾ | ä¸€æ¬¡æ€§è½¬æ¢ |
| **è‡ªå®šä¹‰ç¼–è¾‘å™¨** | è‡ªåŠ¨è½¬æ¢ï¼Œå¤ç”¨æ€§å¼º | éœ€è¦ç†è§£æœºåˆ¶ | é¢‘ç¹ä½¿ç”¨çš„ç±»å‹è½¬æ¢ |
| **@DateTimeFormat** | ç®€å•æ˜“ç”¨ | åŠŸèƒ½æœ‰é™ | ç®€å•æ—¥æœŸè½¬æ¢ |

---

## 2. ğŸ”§ PropertyEditoræ ¸å¿ƒæ¦‚å¿µ


### 2.1 PropertyEditoræ˜¯ä»€ä¹ˆ


**ä¸“ä¸šå®šä¹‰**ï¼š
PropertyEditorï¼ˆå±æ€§ç¼–è¾‘å™¨ï¼‰æ˜¯Javaæ ‡å‡†æ¥å£ï¼Œç”¨äºåœ¨å­—ç¬¦ä¸²å’Œå¯¹è±¡ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚

**é€šä¿—ç†è§£**ï¼š
å°±åƒä¸€ä¸ª"åŒå‘ç¿»è¯‘å™¨"ï¼Œå¯ä»¥æŠŠå­—ç¬¦ä¸²å˜æˆå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æŠŠå¯¹è±¡å˜æˆå­—ç¬¦ä¸²ã€‚

```
PropertyEditoræ¥å£çš„æ ¸å¿ƒæ–¹æ³•ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     PropertyEditor æ¥å£          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ setAsText(String text)          â”‚ â† å­—ç¬¦ä¸² â†’ å¯¹è±¡
â”‚ String getAsText()              â”‚ â† å¯¹è±¡ â†’ å­—ç¬¦ä¸²
â”‚ setValue(Object value)          â”‚ â† è®¾ç½®å¯¹è±¡å€¼
â”‚ Object getValue()               â”‚ â† è·å–å¯¹è±¡å€¼
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 PropertyEditorå·¥ä½œåŸç†


**è½¬æ¢æµç¨‹å›¾ç¤º**ï¼š

```
è¯·æ±‚å‚æ•°ç»‘å®šæµç¨‹ï¼š

ç”¨æˆ·è¯·æ±‚
   â†“
ã€å‚æ•°ï¼š"2025-01-15"ã€‘
   â†“
Spring MVC æ¥æ”¶
   â†“
è°ƒç”¨ PropertyEditor.setAsText("2025-01-15")
   â†“
å†…éƒ¨è½¬æ¢é€»è¾‘
   â†“
è°ƒç”¨ setValue(dateObject)
   â†“
ã€è¿”å› Date å¯¹è±¡ã€‘
   â†“
ç»‘å®šåˆ° Controller æ–¹æ³•å‚æ•°
```

### 2.3 Springå†…ç½®çš„ç¼–è¾‘å™¨


Springå·²ç»å†…ç½®äº†ä¸€äº›å¸¸ç”¨ç¼–è¾‘å™¨ï¼š

| ç¼–è¾‘å™¨ç±» | å¤„ç†ç±»å‹ | è½¬æ¢ç¤ºä¾‹ |
|---------|---------|----------|
| `StringEditor` | String | å»é™¤é¦–å°¾ç©ºæ ¼ |
| `CustomNumberEditor` | Numberç±»å‹ | `"100"` â†’ `Integer(100)` |
| `CustomBooleanEditor` | Boolean | `"true"` â†’ `true` |
| `CustomDateEditor` | Date | `"2025-01-15"` â†’ Dateå¯¹è±¡ |
| `URLEditor` | URL | `"http://xxx"` â†’ URLå¯¹è±¡ |

> âš ï¸ **æ³¨æ„**ï¼šSpringå†…ç½®ç¼–è¾‘å™¨æœ‰é™ï¼Œæ— æ³•æ»¡è¶³æ‰€æœ‰ä¸šåŠ¡éœ€æ±‚ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆéœ€è¦è‡ªå®šä¹‰

---

## 3. ğŸ› ï¸ è‡ªå®šä¹‰ç¼–è¾‘å™¨å®ç°


### 3.1 å®ç°æ–¹å¼é€‰æ‹©


**ä¸¤ç§å®ç°æ–¹å¼å¯¹æ¯”**ï¼š

```
æ–¹å¼ä¸€ï¼šå®ç° PropertyEditor æ¥å£ï¼ˆä¸æ¨èï¼‰
â”œâ”€ éœ€è¦å®ç°æ‰€æœ‰æ–¹æ³•
â”œâ”€ ä»£ç é‡å¤§
â””â”€ å®¹æ˜“å‡ºé”™

æ–¹å¼äºŒï¼šç»§æ‰¿ PropertyEditorSupport ç±»ï¼ˆæ¨èï¼‰âœ…
â”œâ”€ åªéœ€é‡å†™æ ¸å¿ƒæ–¹æ³•
â”œâ”€ ä»£ç ç®€æ´
â””â”€ ä¸æ˜“å‡ºé”™
```

> ğŸ’¡ **å°è´´å£«**ï¼šPropertyEditorSupportå·²ç»å®ç°äº†PropertyEditoræ¥å£çš„é»˜è®¤é€»è¾‘ï¼Œæˆ‘ä»¬åªéœ€è¦é‡å†™è½¬æ¢æ–¹æ³•

### 3.2 æ—¥æœŸç¼–è¾‘å™¨å®ä¾‹


**éœ€æ±‚åœºæ™¯**ï¼šå°† `"yyyy-MM-dd"` æ ¼å¼å­—ç¬¦ä¸²è½¬ä¸ºDateå¯¹è±¡

```java
import java.beans.PropertyEditorSupport;
import java.text.SimpleDateFormat;
import java.util.Date;

/**
 * è‡ªå®šä¹‰æ—¥æœŸç¼–è¾‘å™¨
 * åŠŸèƒ½ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºDateå¯¹è±¡
 */
public class CustomDateEditor extends PropertyEditorSupport {
    
    private String datePattern;  // æ—¥æœŸæ ¼å¼
    
    public CustomDateEditor(String datePattern) {
        this.datePattern = datePattern;
    }
    
    /**
     * æ ¸å¿ƒæ–¹æ³•ï¼šå­—ç¬¦ä¸² â†’ å¯¹è±¡
     * @param text å‰ç«¯ä¼ æ¥çš„å­—ç¬¦ä¸²
     */
    @Override
    public void setAsText(String text) {
        try {
            SimpleDateFormat sdf = new SimpleDateFormat(datePattern);
            Date date = sdf.parse(text);  // è§£æå­—ç¬¦ä¸²
            setValue(date);  // è®¾ç½®è½¬æ¢åçš„å¯¹è±¡
        } catch (Exception e) {
            setValue(null);  // è§£æå¤±è´¥è¿”å›null
        }
    }
    
    /**
     * å¯¹è±¡ â†’ å­—ç¬¦ä¸²ï¼ˆéå¿…éœ€ï¼Œçœ‹éœ€æ±‚ï¼‰
     */
    @Override
    public String getAsText() {
        Date date = (Date) getValue();
        if (date == null) return "";
        SimpleDateFormat sdf = new SimpleDateFormat(datePattern);
        return sdf.format(date);
    }
}
```

**ä»£ç è§£æ**ï¼š

- **`setAsText(String text)`**ï¼šè¿™æ˜¯æœ€æ ¸å¿ƒçš„æ–¹æ³•
  - æ¥æ”¶å‰ç«¯ä¼ æ¥çš„å­—ç¬¦ä¸²å‚æ•°
  - å†…éƒ¨è¿›è¡Œæ ¼å¼è½¬æ¢
  - è°ƒç”¨ `setValue()` ä¿å­˜è½¬æ¢åçš„å¯¹è±¡

- **`getAsText()`**ï¼šå¯é€‰æ–¹æ³•
  - ç”¨äºå°†å¯¹è±¡è½¬å›å­—ç¬¦ä¸²
  - å¸¸ç”¨äºè¡¨å•å›æ˜¾

### 3.3 å¯¹è±¡ç¼–è¾‘å™¨å®ä¾‹


**éœ€æ±‚åœºæ™¯**ï¼šå‰ç«¯ä¼ ç”¨æˆ·IDï¼Œåç«¯éœ€è¦å®Œæ•´Userå¯¹è±¡

```java
import java.beans.PropertyEditorSupport;

/**
 * è‡ªå®šä¹‰ç”¨æˆ·ç¼–è¾‘å™¨
 * åŠŸèƒ½ï¼šæ ¹æ®IDæŸ¥è¯¢Userå¯¹è±¡
 */
public class UserEditor extends PropertyEditorSupport {
    
    private UserService userService;  // ç”¨æˆ·æœåŠ¡
    
    public UserEditor(UserService userService) {
        this.userService = userService;
    }
    
    @Override
    public void setAsText(String text) {
        if (text == null || text.isEmpty()) {
            setValue(null);
            return;
        }
        
        try {
            Long userId = Long.parseLong(text);  // è§£æID
            User user = userService.getUserById(userId);  // æŸ¥è¯¢ç”¨æˆ·
            setValue(user);  // è®¾ç½®Userå¯¹è±¡
        } catch (Exception e) {
            setValue(null);
        }
    }
}
```

**ä½¿ç”¨åœºæ™¯ç¤ºä¾‹**ï¼š

```java
// Controlleræ¥æ”¶å‚æ•°
@PostMapping("/saveOrder")
public String saveOrder(Order order) {
    // order.getUser() è‡ªåŠ¨æ˜¯å®Œæ•´çš„Userå¯¹è±¡ï¼Œè€Œä¸æ˜¯IDå­—ç¬¦ä¸²
    return "success";
}
```

---

## 4. ğŸ“ ç¼–è¾‘å™¨æ³¨å†Œæ–¹å¼


### 4.1 æ³¨å†Œæ–¹å¼æ¦‚è§ˆ


Spring MVCæä¾›äº†ä¸‰ç§ç¼–è¾‘å™¨æ³¨å†Œæ–¹å¼ï¼š

```
ç¼–è¾‘å™¨æ³¨å†Œæ–¹å¼ï¼š
â”œâ”€ å±€éƒ¨æ³¨å†Œï¼ˆ@InitBinderï¼‰      â† æœ€å¸¸ç”¨ âœ…
â”œâ”€ å…¨å±€æ³¨å†Œï¼ˆWebBindingInitializerï¼‰
â””â”€ é…ç½®æ–‡ä»¶æ³¨å†Œï¼ˆè¾ƒå°‘ç”¨ï¼‰
```

### 4.2 å±€éƒ¨æ³¨å†Œè¯¦è§£


**ä½¿ç”¨åœºæ™¯**ï¼šæŸä¸ªControlleréœ€è¦ç‰¹å®šçš„ç¼–è¾‘å™¨

```java
@Controller
public class UserController {
    
    @Autowired
    private UserService userService;
    
    /**
     * å±€éƒ¨ç¼–è¾‘å™¨æ³¨å†Œ
     * åªå¯¹å½“å‰Controlleræœ‰æ•ˆ
     */
    @InitBinder
    public void initBinder(WebDataBinder binder) {
        // æ³¨å†Œæ—¥æœŸç¼–è¾‘å™¨
        binder.registerCustomEditor(
            Date.class, 
            new CustomDateEditor("yyyy-MM-dd")
        );
        
        // æ³¨å†Œç”¨æˆ·ç¼–è¾‘å™¨
        binder.registerCustomEditor(
            User.class, 
            new UserEditor(userService)
        );
    }
    
    // æ­¤Controllerçš„æ‰€æœ‰æ–¹æ³•éƒ½å¯ä»¥ä½¿ç”¨ä¸Šè¿°ç¼–è¾‘å™¨
    @GetMapping("/test")
    public String test(Date createDate, User user) {
        // createDate å’Œ user ä¼šè‡ªåŠ¨è½¬æ¢
        return "success";
    }
}
```

**å…³é”®ç‚¹è¯´æ˜**ï¼š

- `@InitBinder`ï¼šæ ‡è®°è¿™æ˜¯ç¼–è¾‘å™¨æ³¨å†Œæ–¹æ³•
- `WebDataBinder`ï¼šæ•°æ®ç»‘å®šå™¨ï¼Œè´Ÿè´£æ³¨å†Œç¼–è¾‘å™¨
- `registerCustomEditor(Class, PropertyEditor)`ï¼šæ³¨å†Œç¼–è¾‘å™¨çš„æ–¹æ³•

### 4.3 å…¨å±€æ³¨å†Œè¯¦è§£


**ä½¿ç”¨åœºæ™¯**ï¼šæ‰€æœ‰Controlleréƒ½éœ€è¦æŸäº›ç¼–è¾‘å™¨

```java
import org.springframework.web.bind.WebDataBinder;
import org.springframework.web.bind.support.WebBindingInitializer;

/**
 * å…¨å±€ç¼–è¾‘å™¨é…ç½®
 */
public class GlobalBindingInitializer implements WebBindingInitializer {
    
    @Override
    public void initBinder(WebDataBinder binder) {
        // æ³¨å†Œå…¨å±€æ—¥æœŸç¼–è¾‘å™¨
        binder.registerCustomEditor(
            Date.class, 
            new CustomDateEditor("yyyy-MM-dd")
        );
    }
}
```

**é…ç½®åˆ°Spring MVC**ï¼š

```java
@Configuration
public class WebMvcConfig implements WebMvcConfigurer {
    
    @Override
    public void addFormatters(FormatterRegistry registry) {
        // é…ç½®å…¨å±€ç¼–è¾‘å™¨åˆå§‹åŒ–å™¨
        registry.addFormatterForFieldType(
            Date.class, 
            new DateFormatter("yyyy-MM-dd")
        );
    }
}
```

> ğŸ’¡ **é€‰æ‹©å»ºè®®**ï¼š
> - é€šç”¨ç±»å‹ï¼ˆå¦‚Dateï¼‰â†’ ä½¿ç”¨å…¨å±€æ³¨å†Œ
> - ç‰¹å®šä¸šåŠ¡ç±»å‹ï¼ˆå¦‚Userï¼‰â†’ ä½¿ç”¨å±€éƒ¨æ³¨å†Œ

---

## 5. ğŸ¯ InitBinderæ³¨è§£è¯¦è§£


### 5.1 InitBinderä½œç”¨åŸŸ


**@InitBinderçš„ä¸‰ç§ä½œç”¨èŒƒå›´**ï¼š

```java
// 1ï¸âƒ£ å½“å‰Controlleræœ‰æ•ˆ
@Controller
public class UserController {
    @InitBinder
    public void init(WebDataBinder binder) {
        // åªå¯¹UserControlleræœ‰æ•ˆ
    }
}

// 2ï¸âƒ£ æŒ‡å®šControlleræœ‰æ•ˆ
@ControllerAdvice(assignableTypes = {UserController.class, OrderController.class})
public class CustomBinderAdvice {
    @InitBinder
    public void init(WebDataBinder binder) {
        // å¯¹UserControllerå’ŒOrderControlleræœ‰æ•ˆ
    }
}

// 3ï¸âƒ£ å…¨å±€æœ‰æ•ˆ
@ControllerAdvice
public class GlobalBinderAdvice {
    @InitBinder
    public void init(WebDataBinder binder) {
        // å¯¹æ‰€æœ‰Controlleræœ‰æ•ˆ
    }
}
```

### 5.2 InitBinderå‚æ•°è¯¦è§£


**@InitBinderæ–¹æ³•æ”¯æŒçš„å‚æ•°**ï¼š

| å‚æ•°ç±»å‹ | è¯´æ˜ | ä½¿ç”¨ç¤ºä¾‹ |
|---------|------|----------|
| `WebDataBinder` | æ•°æ®ç»‘å®šå™¨ï¼ˆå¿…éœ€ï¼‰ | æ³¨å†Œç¼–è¾‘å™¨ |
| `HttpServletRequest` | è¯·æ±‚å¯¹è±¡ | è·å–è¯·æ±‚ä¿¡æ¯ |
| `@PathVariable` | è·¯å¾„å˜é‡ | æ ¹æ®è·¯å¾„å‚æ•°å†³å®šç¼–è¾‘å™¨ |

```java
@InitBinder
public void init(
    WebDataBinder binder,
    HttpServletRequest request,
    @PathVariable(required = false) String type
) {
    // å¯ä»¥æ ¹æ®è¯·æ±‚ä¿¡æ¯åŠ¨æ€æ³¨å†Œç¼–è¾‘å™¨
    if ("date".equals(type)) {
        binder.registerCustomEditor(Date.class, new CustomDateEditor("yyyy-MM-dd"));
    }
}
```

### 5.3 InitBinderé«˜çº§ç”¨æ³•


**ç»‘å®šæŒ‡å®šå±æ€§**ï¼š

```java
@InitBinder("user")  // åªå¯¹åä¸ºuserçš„å‚æ•°ç”Ÿæ•ˆ
public void initUser(WebDataBinder binder) {
    binder.registerCustomEditor(Date.class, new CustomDateEditor("yyyy-MM-dd"));
}

@InitBinder("order")  // åªå¯¹åä¸ºorderçš„å‚æ•°ç”Ÿæ•ˆ
public void initOrder(WebDataBinder binder) {
    binder.registerCustomEditor(Date.class, new CustomDateEditor("yyyy/MM/dd"));
}

// ä½¿ç”¨ç¤ºä¾‹
@PostMapping("/test")
public String test(
    @ModelAttribute("user") User user,    // ä½¿ç”¨ yyyy-MM-dd æ ¼å¼
    @ModelAttribute("order") Order order  // ä½¿ç”¨ yyyy/MM/dd æ ¼å¼
) {
    return "success";
}
```

---

## 6. âš™ï¸ WebDataBinderå·¥ä½œæœºåˆ¶


### 6.1 WebDataBinderæ˜¯ä»€ä¹ˆ


**é€šä¿—ç†è§£**ï¼š
WebDataBinderï¼ˆWebæ•°æ®ç»‘å®šå™¨ï¼‰æ˜¯Spring MVCçš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£å°†è¯·æ±‚å‚æ•°ç»‘å®šåˆ°æ–¹æ³•å‚æ•°ä¸Šã€‚

**å·¥ä½œæµç¨‹å›¾**ï¼š

```
è¯·æ±‚å¤„ç†æµç¨‹ï¼š

HTTPè¯·æ±‚
   â†“
ã€å‚æ•°ï¼šname=å¼ ä¸‰&age=20&birthday=2000-01-01ã€‘
   â†“
Spring MVC æ‹¦æˆª
   â†“
åˆ›å»º WebDataBinder
   â†“
æ‰§è¡Œ @InitBinder æ–¹æ³•ï¼ˆæ³¨å†Œç¼–è¾‘å™¨ï¼‰
   â†“
ä½¿ç”¨ç¼–è¾‘å™¨è½¬æ¢å‚æ•°
   â†“
ã€ç»‘å®šåˆ°æ–¹æ³•å‚æ•°ï¼šUser(name=å¼ ä¸‰, age=20, birthday=Dateå¯¹è±¡)ã€‘
   â†“
è°ƒç”¨ Controller æ–¹æ³•
```

### 6.2 WebDataBinderæ ¸å¿ƒæ–¹æ³•


**å¸¸ç”¨æ–¹æ³•è¯´æ˜**ï¼š

```java
@InitBinder
public void init(WebDataBinder binder) {
    // 1. æ³¨å†Œè‡ªå®šä¹‰ç¼–è¾‘å™¨
    binder.registerCustomEditor(Date.class, new CustomDateEditor("yyyy-MM-dd"));
    
    // 2. è®¾ç½®å…è®¸çš„å­—æ®µ
    binder.setAllowedFields("name", "age", "email");
    
    // 3. è®¾ç½®ç¦æ­¢çš„å­—æ®µï¼ˆå®‰å…¨é˜²æŠ¤ï¼‰
    binder.setDisallowedFields("id", "password");
    
    // 4. è®¾ç½®å¿…å¡«å­—æ®µ
    binder.setRequiredFields("name", "email");
    
    // 5. è®¾ç½®å­—æ®µé»˜è®¤å€¼
    binder.setEmptyValue("status", "0");
}
```

> âš ï¸ **å®‰å…¨æç¤º**ï¼šä½¿ç”¨ `setDisallowedFields` å¯ä»¥é˜²æ­¢æ¶æ„å‚æ•°ç»‘å®š

### 6.3 ç»‘å®šç»“æœéªŒè¯


```java
@PostMapping("/save")
public String save(
    @Valid User user,
    BindingResult result  // ç»‘å®šç»“æœ
) {
    if (result.hasErrors()) {
        // è·å–ç»‘å®šé”™è¯¯
        List<ObjectError> errors = result.getAllErrors();
        for (ObjectError error : errors) {
            System.out.println(error.getDefaultMessage());
        }
        return "error";
    }
    return "success";
}
```

---

## 7. ğŸŒ å…¨å±€ä¸å±€éƒ¨ç¼–è¾‘å™¨


### 7.1 ä½œç”¨èŒƒå›´å¯¹æ¯”


```
ç¼–è¾‘å™¨ä½œç”¨èŒƒå›´å±‚çº§ï¼š

å…¨å±€èŒƒå›´
â”œâ”€ WebBindingInitializeré…ç½®
â”œâ”€ @ControllerAdvice + @InitBinder
â””â”€ å¯¹æ‰€æœ‰Controllerç”Ÿæ•ˆ

å±€éƒ¨èŒƒå›´
â”œâ”€ Controllerå†… @InitBinder
â””â”€ åªå¯¹å½“å‰Controllerç”Ÿæ•ˆ

æ–¹æ³•èŒƒå›´
â”œâ”€ @InitBinder("å‚æ•°å")
â””â”€ åªå¯¹æŒ‡å®šå‚æ•°ç”Ÿæ•ˆ
```

### 7.2 å…¨å±€ç¼–è¾‘å™¨å®ç°


**æ–¹å¼ä¸€ï¼šå®ç°WebBindingInitializer**

```java
@Component
public class GlobalBindingInitializer implements WebBindingInitializer {
    
    @Override
    public void initBinder(WebDataBinder binder) {
        // å…¨å±€æ—¥æœŸæ ¼å¼
        binder.registerCustomEditor(
            Date.class, 
            new CustomDateEditor("yyyy-MM-dd HH:mm:ss")
        );
    }
}

// é…ç½®åˆ°Spring MVC
@Configuration
public class WebConfig extends WebMvcConfigurerAdapter {
    
    @Autowired
    private GlobalBindingInitializer globalBindingInitializer;
    
    @Override
    public void configureMessageConverters(List<HttpMessageConverter<?>> converters) {
        // é…ç½®å…¨å±€ç»‘å®šåˆå§‹åŒ–å™¨
        RequestMappingHandlerAdapter adapter = new RequestMappingHandlerAdapter();
        adapter.setWebBindingInitializer(globalBindingInitializer);
    }
}
```

**æ–¹å¼äºŒï¼šä½¿ç”¨@ControllerAdvice**ï¼ˆæ¨èï¼‰

```java
@ControllerAdvice
public class GlobalEditorConfig {
    
    @InitBinder
    public void initBinder(WebDataBinder binder) {
        // å…¨å±€ç”Ÿæ•ˆçš„ç¼–è¾‘å™¨
        binder.registerCustomEditor(
            Date.class, 
            new CustomDateEditor("yyyy-MM-dd")
        );
    }
}
```

### 7.3 å±€éƒ¨ç¼–è¾‘å™¨å®ç°


```java
@Controller
public class OrderController {
    
    @InitBinder
    public void init(WebDataBinder binder) {
        // è®¢å•æ¨¡å—ç‰¹æ®Šæ—¥æœŸæ ¼å¼
        binder.registerCustomEditor(
            Date.class, 
            new CustomDateEditor("yyyy/MM/dd")
        );
    }
}
```

### 7.4 ä½¿ç”¨å»ºè®®


| åœºæ™¯ | æ¨èæ–¹å¼ | ç†ç”± |
|------|---------|------|
| **é€šç”¨ç±»å‹è½¬æ¢** | å…¨å±€ç¼–è¾‘å™¨ | é¿å…é‡å¤é…ç½® |
| **ç‰¹å®šæ¨¡å—éœ€æ±‚** | å±€éƒ¨ç¼–è¾‘å™¨ | çµæ´»æ€§é«˜ |
| **ä¸´æ—¶ç‰¹æ®Šå¤„ç†** | æ–¹æ³•çº§ç¼–è¾‘å™¨ | å½±å“èŒƒå›´æœ€å° |

---

## 8. ğŸ” ç¼–è¾‘å™¨ä¼˜å…ˆçº§è§„åˆ™


### 8.1 ä¼˜å…ˆçº§å±‚æ¬¡


**ç¼–è¾‘å™¨ç”Ÿæ•ˆä¼˜å…ˆçº§**ï¼ˆä»é«˜åˆ°ä½ï¼‰ï¼š

```
ä¼˜å…ˆçº§é¡ºåºï¼ˆæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼‰ï¼š

1ï¸âƒ£ æ–¹æ³•çº§ç¼–è¾‘å™¨
   â””â”€ @InitBinder("å‚æ•°å")
   
2ï¸âƒ£ Controllerçº§ç¼–è¾‘å™¨
   â””â”€ Controllerå†… @InitBinder
   
3ï¸âƒ£ ControllerAdviceçº§ç¼–è¾‘å™¨
   â””â”€ @ControllerAdvice + @InitBinder
   
4ï¸âƒ£ å…¨å±€ç¼–è¾‘å™¨
   â””â”€ WebBindingInitializer

5ï¸âƒ£ Springé»˜è®¤ç¼–è¾‘å™¨
   â””â”€ å†…ç½®ç¼–è¾‘å™¨
```

### 8.2 ä¼˜å…ˆçº§éªŒè¯ç¤ºä¾‹


```java
// å…¨å±€é…ç½®
@ControllerAdvice
public class GlobalConfig {
    @InitBinder
    public void init(WebDataBinder binder) {
        System.out.println("å…¨å±€ç¼–è¾‘å™¨");
        binder.registerCustomEditor(Date.class, new CustomDateEditor("yyyy-MM-dd"));
    }
}

// Controlleré…ç½®
@Controller
public class TestController {
    
    @InitBinder
    public void init(WebDataBinder binder) {
        System.out.println("Controllerç¼–è¾‘å™¨");
        binder.registerCustomEditor(Date.class, new CustomDateEditor("yyyy/MM/dd"));
    }
    
    @InitBinder("user")
    public void initUser(WebDataBinder binder) {
        System.out.println("æ–¹æ³•çº§ç¼–è¾‘å™¨");
        binder.registerCustomEditor(Date.class, new CustomDateEditor("yyyyMMdd"));
    }
    
    @GetMapping("/test")
    public String test(
        @ModelAttribute("user") User user,  // ä½¿ç”¨ yyyyMMdd
        @ModelAttribute("order") Order order  // ä½¿ç”¨ yyyy/MM/dd
    ) {
        return "success";
    }
}
```

**æ‰§è¡Œç»“æœ**ï¼š
```
å…¨å±€ç¼–è¾‘å™¨
Controllerç¼–è¾‘å™¨  
æ–¹æ³•çº§ç¼–è¾‘å™¨      â† userå‚æ•°ä½¿ç”¨è¿™ä¸ª
Controllerç¼–è¾‘å™¨  â† orderå‚æ•°ä½¿ç”¨è¿™ä¸ª
```

### 8.3 åŒç±»å‹ç¼–è¾‘å™¨è¦†ç›–


```java
@InitBinder
public void init(WebDataBinder binder) {
    // å…ˆæ³¨å†Œçš„ä¼šè¢«åæ³¨å†Œçš„è¦†ç›–
    binder.registerCustomEditor(Date.class, new CustomDateEditor("yyyy-MM-dd"));
    binder.registerCustomEditor(Date.class, new CustomDateEditor("yyyy/MM/dd"));
    // æœ€ç»ˆä½¿ç”¨ yyyy/MM/dd æ ¼å¼ âœ…
}
```

> ğŸ’¡ **è®°å¿†æŠ€å·§**ï¼šèŒƒå›´è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å…³é”®æ¦‚å¿µå›é¡¾


**ğŸ”¸ PropertyEditoræ ¸å¿ƒ**ï¼š
```
ä½œç”¨ï¼šå­—ç¬¦ä¸² â†” å¯¹è±¡ çš„è½¬æ¢å™¨
å®ç°ï¼šç»§æ‰¿PropertyEditorSupport
æ ¸å¿ƒæ–¹æ³•ï¼šsetAsText(String) å’Œ getAsText()
```

**ğŸ”¸ ç¼–è¾‘å™¨æ³¨å†Œæ–¹å¼**ï¼š
```
å±€éƒ¨æ³¨å†Œï¼š@InitBinderï¼ˆæ¨èï¼‰
å…¨å±€æ³¨å†Œï¼š@ControllerAdvice + @InitBinder
é…ç½®æ³¨å†Œï¼šWebBindingInitializer
```

**ğŸ”¸ WebDataBinderåŠŸèƒ½**ï¼š
```
1. æ³¨å†Œç¼–è¾‘å™¨
2. è®¾ç½®å…è®¸/ç¦æ­¢å­—æ®µ
3. è®¾ç½®å¿…å¡«å­—æ®µ
4. è®¾ç½®é»˜è®¤å€¼
```

### 9.2 å®ç”¨æŠ€å·§æ€»ç»“


**âœ… æœ€ä½³å®è·µ**ï¼š

1. **é€šç”¨ç±»å‹ç”¨å…¨å±€ç¼–è¾‘å™¨**
   ```java
   @ControllerAdvice
   public class GlobalConfig {
       @InitBinder
       public void init(WebDataBinder binder) {
           binder.registerCustomEditor(Date.class, ...);
       }
   }
   ```

2. **ç‰¹æ®Šä¸šåŠ¡ç”¨å±€éƒ¨ç¼–è¾‘å™¨**
   ```java
   @Controller
   public class OrderController {
       @InitBinder
       public void init(WebDataBinder binder) {
           binder.registerCustomEditor(Order.class, ...);
       }
   }
   ```

3. **å®‰å…¨é˜²æŠ¤è®¾ç½®**
   ```java
   @InitBinder
   public void init(WebDataBinder binder) {
       binder.setDisallowedFields("id", "password");
   }
   ```

**âš ï¸ å¸¸è§é™·é˜±**ï¼š

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| ç¼–è¾‘å™¨ä¸ç”Ÿæ•ˆ | ä¼˜å…ˆçº§è¢«è¦†ç›– | æ£€æŸ¥æ˜¯å¦æœ‰æ›´é«˜ä¼˜å…ˆçº§çš„ç¼–è¾‘å™¨ |
| è½¬æ¢å¤±è´¥ | æ ¼å¼ä¸åŒ¹é… | åœ¨setAsTextä¸­æ·»åŠ å¼‚å¸¸å¤„ç† |
| å®‰å…¨æ¼æ´ | æœªé™åˆ¶å­—æ®µ | ä½¿ç”¨setDisallowedFields |

### 9.3 å­¦ä¹ è·¯çº¿å»ºè®®


```
å­¦ä¹ è¿›åº¦ï¼š
â”œâ”€ 1ï¸âƒ£ ç†è§£PropertyEditoræ¦‚å¿µ
â”œâ”€ 2ï¸âƒ£ æŒæ¡è‡ªå®šä¹‰ç¼–è¾‘å™¨å®ç°
â”œâ”€ 3ï¸âƒ£ ç†Ÿæ‚‰@InitBinderæ³¨å†Œæ–¹å¼
â”œâ”€ 4ï¸âƒ£ äº†è§£WebDataBinderåŠŸèƒ½
â”œâ”€ 5ï¸âƒ£ æŒæ¡ä¼˜å…ˆçº§è§„åˆ™
â””â”€ 6ï¸âƒ£ å®æˆ˜é¡¹ç›®åº”ç”¨

å®æˆ˜å»ºè®®ï¼š
âœ… ä»ç®€å•çš„æ—¥æœŸè½¬æ¢å¼€å§‹
âœ… é€æ­¥å®ç°å¤æ‚å¯¹è±¡è½¬æ¢
âœ… æ³¨æ„å®‰å…¨å­—æ®µè¿‡æ»¤
âœ… åˆç†é€‰æ‹©æ³¨å†Œæ–¹å¼
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
ç¼–è¾‘å™¨æœ¬è´¨åšè½¬æ¢ï¼Œå­—ç¬¦å¯¹è±¡ä¸¤ç›¸æ¢
ç»§æ‰¿Supportæœ€ç®€å•ï¼ŒsetAsTextæ˜¯å…³é”®
InitBinderæ¥æ³¨å†Œï¼Œå…¨å±€å±€éƒ¨çœ‹éœ€æ±‚
ä¼˜å…ˆçº§åˆ«è¦è®°ç‰¢ï¼ŒèŒƒå›´è¶Šå°çº§åˆ«é«˜
å®‰å…¨å­—æ®µè¦è¿‡æ»¤ï¼ŒDisallowedFieldsé˜²æ¼æ´
```