---
title: 5ã€HTTPçŠ¶æ€ç ä¸å“åº”å¤„ç†
---
## ğŸ“š ç›®å½•

1. [HTTPçŠ¶æ€ç åŸºç¡€æ¦‚å¿µ](#1-HTTPçŠ¶æ€ç åŸºç¡€æ¦‚å¿µ)
2. [å¸¸ç”¨HTTPçŠ¶æ€ç è¯¦è§£](#2-å¸¸ç”¨HTTPçŠ¶æ€ç è¯¦è§£)
3. [ResponseEntityå“åº”å®ä½“](#3-ResponseEntityå“åº”å®ä½“)
4. [ResponseStatusæ³¨è§£](#4-ResponseStatusæ³¨è§£)
5. [å“åº”å¤´è®¾ç½®ä¸æ“ä½œ](#5-å“åº”å¤´è®¾ç½®ä¸æ“ä½œ)
6. [è‡ªå®šä¹‰çŠ¶æ€ç å¤„ç†](#6-è‡ªå®šä¹‰çŠ¶æ€ç å¤„ç†)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ HTTPçŠ¶æ€ç åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯HTTPçŠ¶æ€ç 


**é€šä¿—ç†è§£ï¼š**
```
HTTPçŠ¶æ€ç å°±åƒå¿«é€’çš„é…é€çŠ¶æ€ï¼š

ğŸ“¦ 200 OK           â†’ å¿«é€’å·²é€è¾¾ï¼ˆæˆåŠŸï¼‰
ğŸš« 404 Not Found    â†’ æ‰¾ä¸åˆ°æ”¶è´§åœ°å€ï¼ˆèµ„æºä¸å­˜åœ¨ï¼‰
â›” 403 Forbidden    â†’ ç¦æ­¢è¿›å…¥å°åŒºï¼ˆæ²¡æƒé™ï¼‰
âŒ 500 Server Error â†’ å¿«é€’ç«™å‡ºæ•…éšœäº†ï¼ˆæœåŠ¡å™¨é”™è¯¯ï¼‰
```

**ä¸“ä¸šå®šä¹‰ï¼š**
- HTTPçŠ¶æ€ç æ˜¯**æœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯çš„ä¸‰ä½æ•°å­—ä»£ç **
- ç”¨äºå‘ŠçŸ¥å®¢æˆ·ç«¯**è¯·æ±‚å¤„ç†çš„ç»“æœ**
- åˆ†ä¸º5å¤§ç±»ï¼Œæ¯ç±»ä»£è¡¨ä¸åŒçš„å“åº”ç±»å‹

### 1.2 çŠ¶æ€ç çš„äº”å¤§åˆ†ç±»


```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1xx  ä¿¡æ¯å“åº”  â†’  æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œç»§ç»­å¤„ç†  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2xx  æˆåŠŸå“åº”  â†’  è¯·æ±‚æˆåŠŸå¤„ç†           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  3xx  é‡å®šå‘    â†’  éœ€è¦è¿›ä¸€æ­¥æ“ä½œå®Œæˆè¯·æ±‚  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  4xx  å®¢æˆ·ç«¯é”™è¯¯ â†’  è¯·æ±‚æœ‰è¯¯æˆ–æ— æ³•å®Œæˆ    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  5xx  æœåŠ¡å™¨é”™è¯¯ â†’  æœåŠ¡å™¨å¤„ç†å¤±è´¥        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è®°å¿†æŠ€å·§ï¼š**
- **2å¼€å¤´** = æˆåŠŸäº† âœ…
- **4å¼€å¤´** = ä½ çš„é—®é¢˜ï¼ˆå®¢æˆ·ç«¯ï¼‰âŒ
- **5å¼€å¤´** = æˆ‘çš„é—®é¢˜ï¼ˆæœåŠ¡å™¨ï¼‰âš ï¸

---

## 2. ğŸ“Š å¸¸ç”¨HTTPçŠ¶æ€ç è¯¦è§£


### 2.1 æˆåŠŸå“åº”ï¼ˆ2xxç³»åˆ—ï¼‰


#### âœ… 200 OK - è¯·æ±‚æˆåŠŸ


**å«ä¹‰ï¼š** æœ€å¸¸è§çš„æˆåŠŸçŠ¶æ€ï¼Œè¡¨ç¤ºè¯·æ±‚å·²æˆåŠŸå¤„ç†

```java
@GetMapping("/users/{id}")
public User getUser(@PathVariable Long id) {
    return userService.findById(id);  // é»˜è®¤è¿”å›200
}
```

**ä½¿ç”¨åœºæ™¯ï¼š**
- æŸ¥è¯¢æ•°æ®æˆåŠŸ
- æ›´æ–°æ•°æ®æˆåŠŸ
- é€šç”¨çš„æˆåŠŸå“åº”

#### âœ… 201 Created - èµ„æºå·²åˆ›å»º


**å«ä¹‰ï¼š** è¯·æ±‚æˆåŠŸï¼Œå¹¶ä¸”åˆ›å»ºäº†æ–°èµ„æºï¼ˆé€šå¸¸ç”¨äºPOSTè¯·æ±‚ï¼‰

```java
@PostMapping("/users")
@ResponseStatus(HttpStatus.CREATED)  // è¿”å›201
public User createUser(@RequestBody User user) {
    return userService.save(user);
}
```

**ä½¿ç”¨åœºæ™¯ï¼š**
- åˆ›å»ºæ–°ç”¨æˆ·
- æ·»åŠ æ–°æ–‡ç« 
- ä¸Šä¼ æ–°æ–‡ä»¶

#### âœ… 204 No Content - æ— å†…å®¹


**å«ä¹‰ï¼š** è¯·æ±‚æˆåŠŸï¼Œä½†ä¸è¿”å›ä»»ä½•å†…å®¹

```java
@DeleteMapping("/users/{id}")
@ResponseStatus(HttpStatus.NO_CONTENT)  // è¿”å›204
public void deleteUser(@PathVariable Long id) {
    userService.delete(id);
}
```

**ä½¿ç”¨åœºæ™¯ï¼š**
- åˆ é™¤æ“ä½œ
- æ›´æ–°æ“ä½œï¼ˆä¸éœ€è¦è¿”å›æ•°æ®ï¼‰

### 2.2 å®¢æˆ·ç«¯é”™è¯¯ï¼ˆ4xxç³»åˆ—ï¼‰


#### âŒ 400 Bad Request - è¯·æ±‚é”™è¯¯


**å«ä¹‰ï¼š** å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯

```java
@PostMapping("/users")
public ResponseEntity<?> createUser(@RequestBody User user) {
    if (user.getAge() < 0) {
        return ResponseEntity
            .status(HttpStatus.BAD_REQUEST)
            .body("å¹´é¾„ä¸èƒ½ä¸ºè´Ÿæ•°");
    }
    return ResponseEntity.ok(userService.save(user));
}
```

**å¸¸è§åŸå› ï¼š**
- å‚æ•°æ ¼å¼é”™è¯¯ï¼ˆå¦‚ï¼šå¹´é¾„ä¼ äº†è´Ÿæ•°ï¼‰
- JSONæ ¼å¼ä¸æ­£ç¡®
- å¿…å¡«å­—æ®µç¼ºå¤±

#### âŒ 401 Unauthorized - æœªè®¤è¯


**å«ä¹‰ï¼š** éœ€è¦èº«ä»½éªŒè¯ï¼Œç”¨æˆ·æœªç™»å½•æˆ–ç™»å½•å¤±è´¥

```java
@GetMapping("/profile")
public ResponseEntity<?> getProfile() {
    if (!isLoggedIn()) {
        return ResponseEntity
            .status(HttpStatus.UNAUTHORIZED)
            .body("è¯·å…ˆç™»å½•");
    }
    return ResponseEntity.ok(currentUser);
}
```

**ä½¿ç”¨åœºæ™¯ï¼š**
- è®¿é—®éœ€è¦ç™»å½•çš„é¡µé¢
- tokenè¿‡æœŸæˆ–æ— æ•ˆ

#### â›” 403 Forbidden - ç¦æ­¢è®¿é—®


**å«ä¹‰ï¼š** æœåŠ¡å™¨ç†è§£è¯·æ±‚ï¼Œä½†æ‹’ç»æ‰§è¡Œï¼ˆæœ‰èº«ä»½ï¼Œä½†æƒé™ä¸å¤Ÿï¼‰

```java
@DeleteMapping("/admin/users/{id}")
public ResponseEntity<?> deleteUser(@PathVariable Long id) {
    if (!currentUser.isAdmin()) {
        return ResponseEntity
            .status(HttpStatus.FORBIDDEN)
            .body("åªæœ‰ç®¡ç†å‘˜å¯ä»¥åˆ é™¤ç”¨æˆ·");
    }
    userService.delete(id);
    return ResponseEntity.noContent().build();
}
```

**401 vs 403 çš„åŒºåˆ«ï¼š**
```
401: ä½ æ˜¯è°ï¼Ÿï¼ˆèº«ä»½éªŒè¯å¤±è´¥ï¼‰â†’ éœ€è¦ç™»å½•
403: æˆ‘çŸ¥é“ä½ æ˜¯è°ï¼Œä½†ä½ ä¸èƒ½åšè¿™ä¸ªï¼ˆæƒé™ä¸è¶³ï¼‰â†’ éœ€è¦æ›´é«˜æƒé™
```

#### ğŸ” 404 Not Found - èµ„æºä¸å­˜åœ¨


**å«ä¹‰ï¼š** è¯·æ±‚çš„èµ„æºåœ¨æœåŠ¡å™¨ä¸Šä¸å­˜åœ¨

```java
@GetMapping("/users/{id}")
public ResponseEntity<?> getUser(@PathVariable Long id) {
    User user = userService.findById(id);
    if (user == null) {
        return ResponseEntity
            .status(HttpStatus.NOT_FOUND)
            .body("ç”¨æˆ·ä¸å­˜åœ¨");
    }
    return ResponseEntity.ok(user);
}
```

**ä½¿ç”¨åœºæ™¯ï¼š**
- æŸ¥è¯¢ä¸å­˜åœ¨çš„æ•°æ®
- è®¿é—®ä¸å­˜åœ¨çš„é¡µé¢

### 2.3 æœåŠ¡å™¨é”™è¯¯ï¼ˆ5xxç³»åˆ—ï¼‰


#### ğŸ’¥ 500 Internal Server Error - æœåŠ¡å™¨é”™è¯¯


**å«ä¹‰ï¼š** æœåŠ¡å™¨å†…éƒ¨å‘ç”Ÿé”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚

```java
@GetMapping("/process")
public ResponseEntity<?> processData() {
    try {
        return ResponseEntity.ok(complexService.process());
    } catch (Exception e) {
        log.error("å¤„ç†å¤±è´¥", e);
        return ResponseEntity
            .status(HttpStatus.INTERNAL_SERVER_ERROR)
            .body("æœåŠ¡å™¨å¤„ç†å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•");
    }
}
```

**å¸¸è§åŸå› ï¼š**
- ç©ºæŒ‡é’ˆå¼‚å¸¸
- æ•°æ®åº“è¿æ¥å¤±è´¥
- æœªå¤„ç†çš„å¼‚å¸¸

#### ğŸ”§ 503 Service Unavailable - æœåŠ¡ä¸å¯ç”¨


**å«ä¹‰ï¼š** æœåŠ¡å™¨æš‚æ—¶æ— æ³•å¤„ç†è¯·æ±‚ï¼ˆé€šå¸¸æ˜¯ç»´æŠ¤æˆ–è¿‡è½½ï¼‰

```java
@GetMapping("/api/data")
public ResponseEntity<?> getData() {
    if (systemService.isUnderMaintenance()) {
        return ResponseEntity
            .status(HttpStatus.SERVICE_UNAVAILABLE)
            .header("Retry-After", "3600")  // 1å°æ—¶åé‡è¯•
            .body("ç³»ç»Ÿç»´æŠ¤ä¸­");
    }
    return ResponseEntity.ok(dataService.getData());
}
```

### 2.4 å¸¸ç”¨çŠ¶æ€ç é€ŸæŸ¥è¡¨


| çŠ¶æ€ç  | è‹±æ–‡è¯´æ˜ | ä¸­æ–‡å«ä¹‰ | ä½¿ç”¨åœºæ™¯ |
|--------|----------|----------|----------|
| **2xx æˆåŠŸ** ||||
| 200 | OK | è¯·æ±‚æˆåŠŸ | æŸ¥è¯¢ã€æ›´æ–°æˆåŠŸ |
| 201 | Created | å·²åˆ›å»º | POSTåˆ›å»ºèµ„æº |
| 204 | No Content | æ— å†…å®¹ | DELETEåˆ é™¤æˆåŠŸ |
| **4xx å®¢æˆ·ç«¯é”™è¯¯** ||||
| 400 | Bad Request | è¯·æ±‚é”™è¯¯ | å‚æ•°æ ¼å¼é”™è¯¯ |
| 401 | Unauthorized | æœªè®¤è¯ | éœ€è¦ç™»å½• |
| 403 | Forbidden | ç¦æ­¢è®¿é—® | æƒé™ä¸è¶³ |
| 404 | Not Found | æœªæ‰¾åˆ° | èµ„æºä¸å­˜åœ¨ |
| **5xx æœåŠ¡å™¨é”™è¯¯** ||||
| 500 | Internal Server Error | æœåŠ¡å™¨é”™è¯¯ | ç¨‹åºå¼‚å¸¸ |
| 503 | Service Unavailable | æœåŠ¡ä¸å¯ç”¨ | ç³»ç»Ÿç»´æŠ¤ |

---

## 3. ğŸ“¦ ResponseEntityå“åº”å®ä½“


### 3.1 ä»€ä¹ˆæ˜¯ResponseEntity


**é€šä¿—ç†è§£ï¼š**
```
ResponseEntity å°±åƒä¸€ä¸ªå®Œæ•´çš„å¿«é€’åŒ…è£¹ï¼š

ğŸ“¦ åŒ…è£¹æœ¬èº«    â†’  ResponseEntityå¯¹è±¡
ğŸ“„ åŒ…è£¹å†…å®¹    â†’  bodyï¼ˆè¿”å›çš„æ•°æ®ï¼‰
ğŸ·ï¸  å¿«é€’å•å·   â†’  headersï¼ˆå“åº”å¤´ï¼‰
âœ… é…é€çŠ¶æ€    â†’  statusï¼ˆçŠ¶æ€ç ï¼‰
```

**ä¸“ä¸šå®šä¹‰ï¼š**
- `ResponseEntity`æ˜¯Springæä¾›çš„**HTTPå“åº”å°è£…ç±»**
- å¯ä»¥**å®Œå…¨æ§åˆ¶HTTPå“åº”**çš„ä¸‰å¤§è¦ç´ ï¼šçŠ¶æ€ç ã€å“åº”å¤´ã€å“åº”ä½“
- æ¯”ç›´æ¥è¿”å›å¯¹è±¡æ›´çµæ´»

### 3.2 ResponseEntityåŸºæœ¬ç”¨æ³•


#### ğŸ”¹ è¿”å›æˆåŠŸæ•°æ®


```java
@GetMapping("/users/{id}")
public ResponseEntity<User> getUser(@PathVariable Long id) {
    User user = userService.findById(id);
    
    // æ–¹å¼1ï¼šä½¿ç”¨ok()æ–¹æ³•
    return ResponseEntity.ok(user);
    
    // æ–¹å¼2ï¼šä½¿ç”¨ok().body()
    return ResponseEntity.ok().body(user);
    
    // æ–¹å¼3ï¼šå®Œæ•´å†™æ³•
    return new ResponseEntity<>(user, HttpStatus.OK);
}
```

#### ğŸ”¹ è¿”å›é”™è¯¯å“åº”


```java
@GetMapping("/users/{id}")
public ResponseEntity<?> getUser(@PathVariable Long id) {
    User user = userService.findById(id);
    
    if (user == null) {
        // è¿”å›404é”™è¯¯
        return ResponseEntity
            .status(HttpStatus.NOT_FOUND)
            .body("ç”¨æˆ·ID:" + id + " ä¸å­˜åœ¨");
    }
    
    return ResponseEntity.ok(user);
}
```

### 3.3 ResponseEntityå¸¸ç”¨æ–¹æ³•


#### ğŸ“‹ å¿«æ·æ–¹æ³•æ€»è§ˆ


| æ–¹æ³• | çŠ¶æ€ç  | è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|------|--------|------|----------|
| `ok()` | 200 | æˆåŠŸ | æŸ¥è¯¢æˆåŠŸ |
| `created()` | 201 | å·²åˆ›å»º | åˆ›å»ºèµ„æº |
| `accepted()` | 202 | å·²æ¥å— | å¼‚æ­¥å¤„ç† |
| `noContent()` | 204 | æ— å†…å®¹ | åˆ é™¤æˆåŠŸ |
| `badRequest()` | 400 | è¯·æ±‚é”™è¯¯ | å‚æ•°é”™è¯¯ |
| `notFound()` | 404 | æœªæ‰¾åˆ° | èµ„æºä¸å­˜åœ¨ |

#### ğŸ”¹ åˆ›å»ºèµ„æºè¿”å›201


```java
@PostMapping("/users")
public ResponseEntity<User> createUser(@RequestBody User user) {
    User savedUser = userService.save(user);
    
    // æ–¹å¼1ï¼šç®€å•è¿”å›
    return ResponseEntity
        .status(HttpStatus.CREATED)
        .body(savedUser);
    
    // æ–¹å¼2ï¼šå¸¦Locationå¤´ï¼ˆRESTfulæœ€ä½³å®è·µï¼‰
    URI location = ServletUriComponentsBuilder
        .fromCurrentRequest()
        .path("/{id}")
        .buildAndExpand(savedUser.getId())
        .toUri();
        
    return ResponseEntity
        .created(location)  // è‡ªåŠ¨è®¾ç½®Locationå“åº”å¤´
        .body(savedUser);
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```http
HTTP/1.1 201 Created
Location: http://localhost:8080/users/123
Content-Type: application/json

{
  "id": 123,
  "name": "å¼ ä¸‰"
}
```

#### ğŸ”¹ æ— å†…å®¹è¿”å›204


```java
@DeleteMapping("/users/{id}")
public ResponseEntity<Void> deleteUser(@PathVariable Long id) {
    userService.delete(id);
    
    // åˆ é™¤æˆåŠŸï¼Œä¸è¿”å›ä»»ä½•å†…å®¹
    return ResponseEntity.noContent().build();
}
```

### 3.4 ResponseEntityé«˜çº§ç”¨æ³•


#### ğŸ”¹ è®¾ç½®å“åº”å¤´


```java
@GetMapping("/download/{filename}")
public ResponseEntity<byte[]> downloadFile(@PathVariable String filename) {
    byte[] fileContent = fileService.getFile(filename);
    
    return ResponseEntity.ok()
        // è®¾ç½®Content-Type
        .contentType(MediaType.APPLICATION_OCTET_STREAM)
        // è®¾ç½®Content-Dispositionï¼ˆä¸‹è½½æ–‡ä»¶åï¼‰
        .header(HttpHeaders.CONTENT_DISPOSITION, 
                "attachment; filename=\"" + filename + "\"")
        // è®¾ç½®ç¼“å­˜æ§åˆ¶
        .header(HttpHeaders.CACHE_CONTROL, "no-cache")
        .body(fileContent);
}
```

#### ğŸ”¹ æ¡ä»¶è¿”å›ä¸åŒå“åº”


```java
@GetMapping("/users/{id}")
public ResponseEntity<?> getUser(@PathVariable Long id) {
    User user = userService.findById(id);
    
    // æƒ…å†µ1ï¼šç”¨æˆ·ä¸å­˜åœ¨
    if (user == null) {
        return ResponseEntity
            .status(HttpStatus.NOT_FOUND)
            .body(Map.of("error", "ç”¨æˆ·ä¸å­˜åœ¨"));
    }
    
    // æƒ…å†µ2ï¼šç”¨æˆ·è¢«ç¦ç”¨
    if (!user.isActive()) {
        return ResponseEntity
            .status(HttpStatus.FORBIDDEN)
            .body(Map.of("error", "ç”¨æˆ·å·²è¢«ç¦ç”¨"));
    }
    
    // æƒ…å†µ3ï¼šæ­£å¸¸è¿”å›
    return ResponseEntity.ok(user);
}
```

---

## 4. ğŸ·ï¸ @ResponseStatusæ³¨è§£


### 4.1 ä»€ä¹ˆæ˜¯@ResponseStatus


**é€šä¿—ç†è§£ï¼š**
```
@ResponseStatus å°±åƒç»™æ–¹æ³•è´´æ ‡ç­¾ï¼š

æ™®é€šæ–¹æ³•    â†’  é»˜è®¤è¿”å›200
è´´ä¸Šæ ‡ç­¾    â†’  @ResponseStatus(201) è¿”å›201
å¼‚å¸¸è´´æ ‡ç­¾  â†’  æŠ›å‡ºæ—¶è‡ªåŠ¨è¿”å›æŒ‡å®šçŠ¶æ€ç 
```

**ä¸“ä¸šå®šä¹‰ï¼š**
- ç”¨äº**æ–¹æ³•æˆ–å¼‚å¸¸ç±»**ä¸Šçš„æ³¨è§£
- å¯ä»¥**ç›´æ¥æŒ‡å®šè¿”å›çš„çŠ¶æ€ç **
- ç®€åŒ–ä»£ç ï¼Œä¸éœ€è¦æ‰‹åŠ¨è®¾ç½®ResponseEntity

### 4.2 åœ¨æ–¹æ³•ä¸Šä½¿ç”¨


#### ğŸ”¹ åŸºæœ¬ç”¨æ³•


```java
// åˆ›å»ºèµ„æºè¿”å›201
@PostMapping("/users")
@ResponseStatus(HttpStatus.CREATED)
public User createUser(@RequestBody User user) {
    return userService.save(user);
}

// åˆ é™¤èµ„æºè¿”å›204
@DeleteMapping("/users/{id}")
@ResponseStatus(HttpStatus.NO_CONTENT)
public void deleteUser(@PathVariable Long id) {
    userService.delete(id);
}
```

#### ğŸ”¹ å¸¦åŸå› æè¿°


```java
@DeleteMapping("/users/{id}")
@ResponseStatus(
    value = HttpStatus.NO_CONTENT,
    reason = "ç”¨æˆ·åˆ é™¤æˆåŠŸ"
)
public void deleteUser(@PathVariable Long id) {
    userService.delete(id);
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```http
HTTP/1.1 204 No Content
X-Reason: ç”¨æˆ·åˆ é™¤æˆåŠŸ
```

### 4.3 åœ¨å¼‚å¸¸ç±»ä¸Šä½¿ç”¨


#### ğŸ”¹ è‡ªå®šä¹‰å¼‚å¸¸ç±»


```java
// èµ„æºä¸å­˜åœ¨å¼‚å¸¸
@ResponseStatus(
    value = HttpStatus.NOT_FOUND,
    reason = "è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨"
)
public class ResourceNotFoundException extends RuntimeException {
    
    public ResourceNotFoundException(String message) {
        super(message);
    }
}

// æƒé™ä¸è¶³å¼‚å¸¸
@ResponseStatus(
    value = HttpStatus.FORBIDDEN,
    reason = "æƒé™ä¸è¶³"
)
public class PermissionDeniedException extends RuntimeException {
    
    public PermissionDeniedException(String message) {
        super(message);
    }
}
```

#### ğŸ”¹ ä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸


```java
@GetMapping("/users/{id}")
public User getUser(@PathVariable Long id) {
    User user = userService.findById(id);
    
    if (user == null) {
        // æŠ›å‡ºå¼‚å¸¸ï¼Œè‡ªåŠ¨è¿”å›404
        throw new ResourceNotFoundException("ç”¨æˆ·ID:" + id + "ä¸å­˜åœ¨");
    }
    
    return user;
}

@DeleteMapping("/admin/users/{id}")
public void deleteUser(@PathVariable Long id) {
    if (!currentUser.isAdmin()) {
        // æŠ›å‡ºå¼‚å¸¸ï¼Œè‡ªåŠ¨è¿”å›403
        throw new PermissionDeniedException("åªæœ‰ç®¡ç†å‘˜å¯ä»¥åˆ é™¤ç”¨æˆ·");
    }
    
    userService.delete(id);
}
```

### 4.4 ResponseStatus vs ResponseEntity


**å¯¹æ¯”åˆ†æï¼š**

| ç‰¹æ€§ | @ResponseStatus | ResponseEntity |
|------|----------------|----------------|
| **çµæ´»æ€§** | å›ºå®šçŠ¶æ€ç  | åŠ¨æ€æ§åˆ¶ |
| **å“åº”å¤´** | ä¸æ”¯æŒ | å®Œå…¨æ§åˆ¶ |
| **å“åº”ä½“** | è‡ªåŠ¨åºåˆ—åŒ– | å®Œå…¨æ§åˆ¶ |
| **ä½¿ç”¨åœºæ™¯** | ç®€å•å›ºå®šå“åº” | å¤æ‚å“åº” |
| **ä»£ç ç®€æ´** | â­â­â­â­â­ | â­â­â­ |

**é€‰æ‹©å»ºè®®ï¼š**
```
âœ… ä½¿ç”¨ @ResponseStatusï¼š
- çŠ¶æ€ç å›ºå®šï¼ˆå¦‚åˆ›å»º201ã€åˆ é™¤204ï¼‰
- ä¸éœ€è¦è®¾ç½®å“åº”å¤´
- å¼‚å¸¸å¤„ç†

âœ… ä½¿ç”¨ ResponseEntityï¼š
- éœ€è¦åŠ¨æ€çŠ¶æ€ç 
- éœ€è¦è®¾ç½®å“åº”å¤´
- éœ€è¦æ¡ä»¶è¿”å›ä¸åŒå“åº”
```

---

## 5. ğŸ“¡ å“åº”å¤´è®¾ç½®ä¸æ“ä½œ


### 5.1 ä»€ä¹ˆæ˜¯HTTPå“åº”å¤´


**é€šä¿—ç†è§£ï¼š**
```
HTTPå“åº”å¤´å°±åƒå¿«é€’åŒ…è£¹ä¸Šçš„æ ‡ç­¾ï¼š

ğŸ“¦ Content-Type      â†’  åŒ…è£¹ç±»å‹ï¼ˆæ–‡ä»¶/å›¾ç‰‡/JSONï¼‰
ğŸ“ Content-Length    â†’  åŒ…è£¹å¤§å°
ğŸ”’ Cache-Control     â†’  æ˜¯å¦å¯ä»¥å­˜å‚¨
ğŸ“ Location          â†’  æ–°èµ„æºçš„åœ°å€
ğŸª Set-Cookie        â†’  è®¾ç½®æµè§ˆå™¨Cookie
```

**ä¸“ä¸šå®šä¹‰ï¼š**
- å“åº”å¤´æ˜¯**æœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯çš„å…ƒæ•°æ®**
- åŒ…å«å…³äºå“åº”çš„**é¢å¤–ä¿¡æ¯**
- ä¸æ˜¯å®é™…çš„å“åº”å†…å®¹

### 5.2 å¸¸ç”¨å“åº”å¤´


#### ğŸ“‹ æ ¸å¿ƒå“åº”å¤´è¯´æ˜


| å“åº”å¤´ | ä½œç”¨ | ç¤ºä¾‹å€¼ |
|--------|------|--------|
| **Content-Type** | å“åº”å†…å®¹ç±»å‹ | `application/json` |
| **Content-Length** | å“åº”ä½“é•¿åº¦ | `1024` |
| **Cache-Control** | ç¼“å­˜æ§åˆ¶ | `no-cache` |
| **Location** | èµ„æºä½ç½® | `/users/123` |
| **Set-Cookie** | è®¾ç½®Cookie | `token=abc123` |
| **Access-Control-Allow-Origin** | è·¨åŸŸæ§åˆ¶ | `*` |

### 5.3 ä½¿ç”¨ResponseEntityè®¾ç½®å“åº”å¤´


#### ğŸ”¹ è®¾ç½®Content-Type


```java
@GetMapping("/json")
public ResponseEntity<User> getJson() {
    User user = new User("å¼ ä¸‰", 25);
    
    return ResponseEntity.ok()
        .contentType(MediaType.APPLICATION_JSON)
        .body(user);
}

@GetMapping("/xml")
public ResponseEntity<User> getXml() {
    User user = new User("å¼ ä¸‰", 25);
    
    return ResponseEntity.ok()
        .contentType(MediaType.APPLICATION_XML)
        .body(user);
}
```

#### ğŸ”¹ è®¾ç½®ç¼“å­˜æ§åˆ¶


```java
@GetMapping("/static/data")
public ResponseEntity<String> getStaticData() {
    String data = "è¿™æ˜¯é™æ€æ•°æ®";
    
    return ResponseEntity.ok()
        // ç¼“å­˜1å°æ—¶
        .cacheControl(CacheControl.maxAge(1, TimeUnit.HOURS))
        .body(data);
}

@GetMapping("/dynamic/data")
public ResponseEntity<String> getDynamicData() {
    String data = "è¿™æ˜¯åŠ¨æ€æ•°æ®";
    
    return ResponseEntity.ok()
        // ç¦æ­¢ç¼“å­˜
        .cacheControl(CacheControl.noCache())
        .body(data);
}
```

#### ğŸ”¹ è®¾ç½®è‡ªå®šä¹‰å“åº”å¤´


```java
@GetMapping("/custom")
public ResponseEntity<String> customHeaders() {
    return ResponseEntity.ok()
        // å•ä¸ªå“åº”å¤´
        .header("X-Custom-Header", "CustomValue")
        // å¤šä¸ªåŒåå“åº”å¤´
        .header("X-Multi-Value", "Value1")
        .header("X-Multi-Value", "Value2")
        // ä½¿ç”¨HttpHeaderså¯¹è±¡
        .headers(headers -> {
            headers.add("X-Request-ID", UUID.randomUUID().toString());
            headers.add("X-Response-Time", System.currentTimeMillis() + "");
        })
        .body("å“åº”æ•°æ®");
}
```

### 5.4 ä½¿ç”¨@RequestHeaderè¯»å–è¯·æ±‚å¤´


```java
@GetMapping("/echo")
public ResponseEntity<Map<String, String>> echoHeaders(
    @RequestHeader("User-Agent") String userAgent,
    @RequestHeader(value = "X-Custom", required = false) String custom
) {
    Map<String, String> response = new HashMap<>();
    response.put("userAgent", userAgent);
    response.put("custom", custom);
    
    return ResponseEntity.ok()
        .header("X-Echo-Back", "Header received")
        .body(response);
}
```

### 5.5 æ–‡ä»¶ä¸‹è½½å“åº”å¤´è®¾ç½®


```java
@GetMapping("/download/{filename}")
public ResponseEntity<Resource> downloadFile(@PathVariable String filename) {
    Resource file = fileService.loadFile(filename);
    
    return ResponseEntity.ok()
        // è®¾ç½®ä¸ºä¸‹è½½ç±»å‹
        .contentType(MediaType.APPLICATION_OCTET_STREAM)
        // è®¾ç½®ä¸‹è½½æ–‡ä»¶åï¼ˆä¸­æ–‡éœ€è¦ç¼–ç ï¼‰
        .header(HttpHeaders.CONTENT_DISPOSITION,
                "attachment; filename=\"" + 
                URLEncoder.encode(filename, StandardCharsets.UTF_8) + "\"")
        // è®¾ç½®æ–‡ä»¶å¤§å°
        .contentLength(file.contentLength())
        .body(file);
}
```

---

## 6. ğŸ¨ è‡ªå®šä¹‰çŠ¶æ€ç å¤„ç†


### 6.1 å…¨å±€å¼‚å¸¸å¤„ç†å™¨


**é€šä¿—ç†è§£ï¼š**
```
å…¨å±€å¼‚å¸¸å¤„ç†å™¨å°±åƒä¸€ä¸ªç»Ÿä¸€çš„é”™è¯¯å¤„ç†ä¸­å¿ƒï¼š

å„ä¸ªController  â†’  å‘ç”Ÿå¼‚å¸¸
    â†“
å¼‚å¸¸å¤„ç†å™¨      â†’  ç»Ÿä¸€å¤„ç†
    â†“
è¿”å›ç»Ÿä¸€æ ¼å¼    â†’  å‰ç«¯æ¥æ”¶
```

#### ğŸ”¹ åˆ›å»ºå…¨å±€å¼‚å¸¸å¤„ç†å™¨


```java
@RestControllerAdvice
public class GlobalExceptionHandler {
    
    // å¤„ç†èµ„æºä¸å­˜åœ¨
    @ExceptionHandler(ResourceNotFoundException.class)
    public ResponseEntity<?> handleNotFound(ResourceNotFoundException e) {
        Map<String, Object> error = new HashMap<>();
        error.put("error", "NOT_FOUND");
        error.put("message", e.getMessage());
        error.put("timestamp", System.currentTimeMillis());
        
        return ResponseEntity
            .status(HttpStatus.NOT_FOUND)
            .body(error);
    }
    
    // å¤„ç†å‚æ•°éªŒè¯å¤±è´¥
    @ExceptionHandler(MethodArgumentNotValidException.class)
    public ResponseEntity<?> handleValidation(MethodArgumentNotValidException e) {
        Map<String, Object> error = new HashMap<>();
        error.put("error", "VALIDATION_FAILED");
        
        // æ”¶é›†æ‰€æœ‰éªŒè¯é”™è¯¯
        List<String> errors = e.getBindingResult()
            .getFieldErrors()
            .stream()
            .map(err -> err.getField() + ": " + err.getDefaultMessage())
            .collect(Collectors.toList());
            
        error.put("details", errors);
        
        return ResponseEntity
            .status(HttpStatus.BAD_REQUEST)
            .body(error);
    }
    
    // å¤„ç†æƒé™ä¸è¶³
    @ExceptionHandler(AccessDeniedException.class)
    public ResponseEntity<?> handleAccessDenied(AccessDeniedException e) {
        return ResponseEntity
            .status(HttpStatus.FORBIDDEN)
            .body(Map.of(
                "error", "FORBIDDEN",
                "message", "æƒé™ä¸è¶³"
            ));
    }
    
    // å¤„ç†å…¶ä»–æ‰€æœ‰å¼‚å¸¸
    @ExceptionHandler(Exception.class)
    public ResponseEntity<?> handleGeneral(Exception e) {
        log.error("æœªå¤„ç†çš„å¼‚å¸¸", e);
        
        return ResponseEntity
            .status(HttpStatus.INTERNAL_SERVER_ERROR)
            .body(Map.of(
                "error", "INTERNAL_ERROR",
                "message", "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯"
            ));
    }
}
```

### 6.2 ç»Ÿä¸€å“åº”æ ¼å¼


#### ğŸ”¹ å®šä¹‰å“åº”åŒ…è£…ç±»


```java
public class ApiResponse<T> {
    private int code;           // ä¸šåŠ¡çŠ¶æ€ç 
    private String message;     // æç¤ºä¿¡æ¯
    private T data;            // å®é™…æ•°æ®
    private Long timestamp;    // æ—¶é—´æˆ³
    
    // æˆåŠŸå“åº”
    public static <T> ApiResponse<T> success(T data) {
        ApiResponse<T> response = new ApiResponse<>();
        response.code = 0;
        response.message = "success";
        response.data = data;
        response.timestamp = System.currentTimeMillis();
        return response;
    }
    
    // å¤±è´¥å“åº”
    public static <T> ApiResponse<T> error(int code, String message) {
        ApiResponse<T> response = new ApiResponse<>();
        response.code = code;
        response.message = message;
        response.timestamp = System.currentTimeMillis();
        return response;
    }
    
    // getter/setter...
}
```

#### ğŸ”¹ ä½¿ç”¨ç»Ÿä¸€å“åº”æ ¼å¼


```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    // æˆåŠŸè¿”å›æ•°æ®
    @GetMapping("/{id}")
    public ResponseEntity<ApiResponse<User>> getUser(@PathVariable Long id) {
        User user = userService.findById(id);
        
        if (user == null) {
            return ResponseEntity
                .status(HttpStatus.NOT_FOUND)
                .body(ApiResponse.error(404, "ç”¨æˆ·ä¸å­˜åœ¨"));
        }
        
        return ResponseEntity.ok(ApiResponse.success(user));
    }
    
    // åˆ›å»ºæˆåŠŸ
    @PostMapping
    public ResponseEntity<ApiResponse<User>> createUser(@RequestBody User user) {
        User saved = userService.save(user);
        
        return ResponseEntity
            .status(HttpStatus.CREATED)
            .body(ApiResponse.success(saved));
    }
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
// æˆåŠŸå“åº”
{
  "code": 0,
  "message": "success",
  "data": {
    "id": 1,
    "name": "å¼ ä¸‰"
  },
  "timestamp": 1632825600000
}

// å¤±è´¥å“åº”
{
  "code": 404,
  "message": "ç”¨æˆ·ä¸å­˜åœ¨",
  "data": null,
  "timestamp": 1632825600000
}
```

### 6.3 è‡ªå®šä¹‰ä¸šåŠ¡çŠ¶æ€ç 


#### ğŸ”¹ å®šä¹‰ä¸šåŠ¡çŠ¶æ€ç æšä¸¾


```java
public enum BusinessCode {
    SUCCESS(0, "æ“ä½œæˆåŠŸ"),
    
    // å®¢æˆ·ç«¯é”™è¯¯ 1xxx
    INVALID_PARAM(1001, "å‚æ•°é”™è¯¯"),
    RESOURCE_NOT_FOUND(1002, "èµ„æºä¸å­˜åœ¨"),
    DUPLICATE_DATA(1003, "æ•°æ®é‡å¤"),
    
    // è®¤è¯æˆæƒé”™è¯¯ 2xxx
    UNAUTHORIZED(2001, "æœªç™»å½•"),
    FORBIDDEN(2002, "æƒé™ä¸è¶³"),
    TOKEN_EXPIRED(2003, "ç™»å½•å·²è¿‡æœŸ"),
    
    // ä¸šåŠ¡é”™è¯¯ 3xxx
    BALANCE_INSUFFICIENT(3001, "ä½™é¢ä¸è¶³"),
    ORDER_EXPIRED(3002, "è®¢å•å·²è¿‡æœŸ"),
    
    // æœåŠ¡å™¨é”™è¯¯ 5xxx
    SYSTEM_ERROR(5000, "ç³»ç»Ÿé”™è¯¯");
    
    private final int code;
    private final String message;
    
    BusinessCode(int code, String message) {
        this.code = code;
        this.message = message;
    }
    
    // getter...
}
```

#### ğŸ”¹ ä½¿ç”¨ä¸šåŠ¡çŠ¶æ€ç 


```java
@RestController
public class PaymentController {
    
    @PostMapping("/pay")
    public ResponseEntity<?> pay(@RequestBody PaymentRequest request) {
        // æ£€æŸ¥ä½™é¢
        if (accountService.getBalance() < request.getAmount()) {
            return ResponseEntity
                .status(HttpStatus.BAD_REQUEST)
                .body(ApiResponse.error(
                    BusinessCode.BALANCE_INSUFFICIENT.getCode(),
                    BusinessCode.BALANCE_INSUFFICIENT.getMessage()
                ));
        }
        
        // æ‰§è¡Œæ”¯ä»˜
        Payment payment = paymentService.process(request);
        
        return ResponseEntity.ok(ApiResponse.success(payment));
    }
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 HTTPçŠ¶æ€ç è®°å¿†è¦ç‚¹


```
âœ… æˆåŠŸå“åº”ï¼ˆ2xxï¼‰ï¼š
200 â†’ æ™®é€šæˆåŠŸ
201 â†’ åˆ›å»ºæˆåŠŸï¼ˆPOSTï¼‰
204 â†’ æ— å†…å®¹æˆåŠŸï¼ˆDELETEï¼‰

âŒ å®¢æˆ·ç«¯é”™è¯¯ï¼ˆ4xxï¼‰ï¼š
400 â†’ è¯·æ±‚å‚æ•°é”™è¯¯
401 â†’ æœªç™»å½•ï¼ˆéœ€è¦è®¤è¯ï¼‰
403 â†’ å·²ç™»å½•ä½†æƒé™ä¸è¶³
404 â†’ èµ„æºä¸å­˜åœ¨

âš ï¸ æœåŠ¡å™¨é”™è¯¯ï¼ˆ5xxï¼‰ï¼š
500 â†’ æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
503 â†’ æœåŠ¡ä¸å¯ç”¨ï¼ˆç»´æŠ¤ä¸­ï¼‰
```

### 7.2 å“åº”å¤„ç†ä¸‰å¤§å·¥å…·


| å·¥å…· | ç‰¹ç‚¹ | ä½¿ç”¨åœºæ™¯ |
|------|------|----------|
| **ResponseEntity** | å®Œå…¨æ§åˆ¶å“åº” | éœ€è¦åŠ¨æ€çŠ¶æ€ç ã€è®¾ç½®å“åº”å¤´ |
| **@ResponseStatus** | ç®€å•å›ºå®š | å›ºå®šçŠ¶æ€ç ã€å¼‚å¸¸ç±» |
| **å…¨å±€å¼‚å¸¸å¤„ç†** | ç»Ÿä¸€å¤„ç† | å¼‚å¸¸ç»Ÿä¸€å“åº”æ ¼å¼ |

### 7.3 æœ€ä½³å®è·µå»ºè®®


**âœ… æ¨èåšæ³•ï¼š**

1. **RESTfulé£æ ¼ä½¿ç”¨åˆé€‚çŠ¶æ€ç **
   - POSTåˆ›å»º â†’ è¿”å›201
   - DELETEåˆ é™¤ â†’ è¿”å›204
   - èµ„æºä¸å­˜åœ¨ â†’ è¿”å›404

2. **å¼‚å¸¸å¤„ç†ä½¿ç”¨å…¨å±€å¤„ç†å™¨**
   ```java
   @RestControllerAdvice
   public class GlobalExceptionHandler {
       // ç»Ÿä¸€å¤„ç†å„ç±»å¼‚å¸¸
   }
   ```

3. **ç»Ÿä¸€å“åº”æ ¼å¼**
   ```java
   {
       "code": 0,
       "message": "success",
       "data": {...}
   }
   ```

4. **æ–‡ä»¶ä¸‹è½½è®¾ç½®æ­£ç¡®å“åº”å¤´**
   ```java
   .contentType(MediaType.APPLICATION_OCTET_STREAM)
   .header(HttpHeaders.CONTENT_DISPOSITION, "attachment; filename=...")
   ```

**âŒ é¿å…çš„åšæ³•ï¼š**
- æ‰€æœ‰è¯·æ±‚éƒ½è¿”å›200ï¼ˆå³ä½¿å¤±è´¥ï¼‰
- å¼‚å¸¸ä¿¡æ¯ç›´æ¥è¿”å›ç»™å‰ç«¯
- ä¸è®¾ç½®Content-Type
- å“åº”æ ¼å¼ä¸ç»Ÿä¸€

### 7.4 å¿«é€Ÿå†³ç­–æŒ‡å—


```
éœ€è¦è¿”å›çŠ¶æ€ç ï¼Ÿ
  â”œâ”€ å›ºå®šçŠ¶æ€ç  â†’ ä½¿ç”¨ @ResponseStatus
  â””â”€ åŠ¨æ€çŠ¶æ€ç  â†’ ä½¿ç”¨ ResponseEntity

éœ€è¦è®¾ç½®å“åº”å¤´ï¼Ÿ
  â””â”€ ä½¿ç”¨ ResponseEntity

éœ€è¦å¼‚å¸¸å¤„ç†ï¼Ÿ
  â”œâ”€ å•ä¸ªå¼‚å¸¸ â†’ @ExceptionHandler
  â””â”€ å…¨å±€å¤„ç† â†’ @RestControllerAdvice

éœ€è¦ç»Ÿä¸€æ ¼å¼ï¼Ÿ
  â””â”€ å®šä¹‰ ApiResponse åŒ…è£…ç±»
```

**æ ¸å¿ƒè®°å¿†å£è¯€ï¼š**
```
2xxæˆåŠŸç¬‘ï¼Œ4xxå®¢æˆ·æ‰¾ï¼Œ5xxæœåŠ¡å€’
ResponseEntityå…¨æ§åˆ¶ï¼ŒResponseStatusç®€å•å¥½
å…¨å±€å¼‚å¸¸ç»Ÿä¸€æŠ“ï¼Œå“åº”æ ¼å¼è¦è§„èŒƒ
```