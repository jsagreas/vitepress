---
title: 5ã€è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†ä½“ç³»
---
## ğŸ“š ç›®å½•


1. [å¼‚å¸¸å¤„ç†åŸºç¡€æ¦‚å¿µ](#1-å¼‚å¸¸å¤„ç†åŸºç¡€æ¦‚å¿µ)
2. [è‡ªå®šä¹‰å¼‚å¸¸ç±»è®¾è®¡](#2-è‡ªå®šä¹‰å¼‚å¸¸ç±»è®¾è®¡)
3. [ä¸šåŠ¡å¼‚å¸¸ä½“ç³»æ„å»º](#3-ä¸šåŠ¡å¼‚å¸¸ä½“ç³»æ„å»º)
4. [å¼‚å¸¸ç ç»Ÿä¸€å®šä¹‰](#4-å¼‚å¸¸ç ç»Ÿä¸€å®šä¹‰)
5. [é”™è¯¯ä¿¡æ¯å›½é™…åŒ–](#5-é”™è¯¯ä¿¡æ¯å›½é™…åŒ–)
6. [å¼‚å¸¸å¤„ç†é“¾æœºåˆ¶](#6-å¼‚å¸¸å¤„ç†é“¾æœºåˆ¶)
7. [å¼‚å¸¸è½¬æ¢ä¸åŒ…è£…](#7-å¼‚å¸¸è½¬æ¢ä¸åŒ…è£…)
8. [å †æ ˆä¿¡æ¯æ§åˆ¶](#8-å †æ ˆä¿¡æ¯æ§åˆ¶)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

# ğŸ¯ **å­¦ä¹ å¯¼èˆª**


**å‰ç½®çŸ¥è¯†**ï¼šéœ€è¦äº†è§£Javaå¼‚å¸¸åŸºç¡€ã€Spring MVCåŸºæœ¬ä½¿ç”¨ â†’ **å½“å‰å†…å®¹** â†’ **åç»­å­¦ä¹ **ï¼šå…¨å±€å¼‚å¸¸å¤„ç†ã€RESTfulæ¥å£è§„èŒƒ

â±ï¸ **é¢„è®¡å­¦ä¹ æ—¶é—´**ï¼šæœ¬ç« çº¦45åˆ†é’Ÿ | å®è·µç»ƒä¹ 30åˆ†é’Ÿ

---

## 1. ğŸ”° å¼‚å¸¸å¤„ç†åŸºç¡€æ¦‚å¿µ



### 1.1 ä»€ä¹ˆæ˜¯è‡ªå®šä¹‰å¼‚å¸¸



**ğŸ”¸ é€šä¿—ç†è§£**
```
å°±åƒç»™é”™è¯¯èµ·ä¸ª"ä¸“ä¸šåå­—"

ç”Ÿæ´»åœºæ™¯ï¼š
- ä¸è¯´"å‡ºé”™äº†" â†’ è€Œæ˜¯è¯´"æ”¯ä»˜å¤±è´¥"ã€"åº“å­˜ä¸è¶³"
- ä¸è¯´"åäº†"   â†’ è€Œæ˜¯è¯´"ç½‘ç»œè¶…æ—¶"ã€"å‚æ•°é”™è¯¯"

ç¼–ç¨‹ä¸­ï¼š
ç³»ç»Ÿé»˜è®¤å¼‚å¸¸ï¼š"RuntimeException" - å¤ªç¬¼ç»Ÿ
è‡ªå®šä¹‰å¼‚å¸¸ï¼š"OrderNotFoundException" - ä¸€çœ‹å°±æ‡‚
```

**ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦è‡ªå®šä¹‰å¼‚å¸¸**
```
é—®é¢˜åœºæ™¯ï¼š
ç”¨æˆ·ä¸‹å•å¤±è´¥ â†’ ç³»ç»ŸæŠ›å‡º NullPointerException
âŒ å‰ç«¯æ”¶åˆ°ï¼š500é”™è¯¯
âŒ ç”¨æˆ·çœ‹åˆ°ï¼šç³»ç»Ÿå¼‚å¸¸
âŒ å®¢æœé—®é¢˜ï¼šä¸çŸ¥é“å…·ä½“åŸå› 

ä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸ï¼š
ç”¨æˆ·ä¸‹å•å¤±è´¥ â†’ ç³»ç»ŸæŠ›å‡º InsufficientStockException
âœ… å‰ç«¯æ”¶åˆ°ï¼šåº“å­˜ä¸è¶³
âœ… ç”¨æˆ·çœ‹åˆ°ï¼šå•†å“å·²å”®ç½„
âœ… å®¢æœçŸ¥é“ï¼šè¡¥è´§æé†’
```

### 1.2 å¼‚å¸¸çš„åˆ†ç±»



**ğŸ“Š å¼‚å¸¸ä½“ç³»å¯¹æ¯”**

| **å¼‚å¸¸ç±»å‹** | **å«ä¹‰** | **ä½¿ç”¨åœºæ™¯** | **æ˜¯å¦éœ€è¦æ•è·** |
|-------------|---------|-------------|----------------|
| **æ£€æŸ¥å‹å¼‚å¸¸** | ç¼–è¯‘æœŸå¿…é¡»å¤„ç† | æ–‡ä»¶æ“ä½œã€ç½‘ç»œè¯·æ±‚ | å¿…é¡»try-catch |
| **è¿è¡Œæ—¶å¼‚å¸¸** | è¿è¡ŒæœŸå¯èƒ½å‘ç”Ÿ | ä¸šåŠ¡é€»è¾‘é”™è¯¯ | å¯ä»¥ä¸æ•è· |
| **è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸** | ä¸šåŠ¡è§„åˆ™è¿å | åº“å­˜ä¸è¶³ã€æƒé™ä¸å¤Ÿ | ç»Ÿä¸€å¤„ç† |

**ğŸ¯ å¼‚å¸¸ä½¿ç”¨åŸåˆ™**
```
æ£€æŸ¥å‹å¼‚å¸¸(Checked)ï¼š
- ç»§æ‰¿Exception
- å¤–éƒ¨å› ç´ å¯¼è‡´ï¼Œå¦‚æ–‡ä»¶ä¸å­˜åœ¨
- è°ƒç”¨æ–¹å¿…é¡»æ˜¾å¼å¤„ç†

è¿è¡Œæ—¶å¼‚å¸¸(Unchecked)ï¼š
- ç»§æ‰¿RuntimeException
- ç¨‹åºé€»è¾‘é”™è¯¯ï¼Œå¦‚ç©ºæŒ‡é’ˆ
- ä¸å¼ºåˆ¶æ•è·

è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ï¼š
âœ… å»ºè®®ç»§æ‰¿RuntimeException
âœ… ä¸šåŠ¡å±‚ç›´æ¥æŠ›å‡º
âœ… å…¨å±€ç»Ÿä¸€æ•è·å¤„ç†
```

---

## 2. ğŸ—ï¸ è‡ªå®šä¹‰å¼‚å¸¸ç±»è®¾è®¡



### 2.1 åŸºç¡€å¼‚å¸¸ç±»



**ğŸ”§ æ ¸å¿ƒè®¾è®¡æ€è·¯**
```
åŸºç¡€å¼‚å¸¸ç±»çš„ä½œç”¨ï¼š
1. å®šä¹‰ç»Ÿä¸€çš„å¼‚å¸¸ç»“æ„
2. æºå¸¦é”™è¯¯ç å’Œé”™è¯¯ä¿¡æ¯
3. æ”¯æŒå¼‚å¸¸é“¾ä¼ é€’
4. ä¾¿äºå…¨å±€ç»Ÿä¸€å¤„ç†
```

**ğŸ’» åŸºç¡€å¼‚å¸¸ç±»å®ç°**
```java
/**
 * åŸºç¡€ä¸šåŠ¡å¼‚å¸¸ç±»
 * æ‰€æœ‰ä¸šåŠ¡å¼‚å¸¸çš„çˆ¶ç±»
 */
public class BaseException extends RuntimeException {
    
    // é”™è¯¯ç ï¼ˆç”¨äºå®šä½é—®é¢˜ï¼‰
    private String errorCode;
    
    // é”™è¯¯ä¿¡æ¯ï¼ˆç”¨äºæ˜¾ç¤ºï¼‰
    private String errorMessage;
    
    // æ„é€ æ–¹æ³•1ï¼šåªä¼ é”™è¯¯ä¿¡æ¯
    public BaseException(String message) {
        super(message);
        this.errorMessage = message;
    }
    
    // æ„é€ æ–¹æ³•2ï¼šä¼ é”™è¯¯ç å’Œé”™è¯¯ä¿¡æ¯
    public BaseException(String errorCode, String message) {
        super(message);
        this.errorCode = errorCode;
        this.errorMessage = message;
    }
    
    // æ„é€ æ–¹æ³•3ï¼šæ”¯æŒå¼‚å¸¸é“¾ï¼ˆä¿ç•™åŸå§‹å¼‚å¸¸ä¿¡æ¯ï¼‰
    public BaseException(String errorCode, String message, Throwable cause) {
        super(message, cause);
        this.errorCode = errorCode;
        this.errorMessage = message;
    }
    
    // Getteræ–¹æ³•
    public String getErrorCode() {
        return errorCode;
    }
    
    public String getErrorMessage() {
        return errorMessage;
    }
}
```

### 2.2 å¼‚å¸¸ç±»è®¾è®¡è¦ç‚¹



**ğŸ“ è®¾è®¡åŸåˆ™**
```
âœ… å‘½åæ¸…æ™°ï¼šXxxExceptionï¼Œä¸€çœ‹å°±æ‡‚
âœ… ç»§æ‰¿åˆç†ï¼šä¸šåŠ¡å¼‚å¸¸ç»§æ‰¿RuntimeException
âœ… ä¿¡æ¯å®Œæ•´ï¼šåŒ…å«é”™è¯¯ç ã€é”™è¯¯ä¿¡æ¯ã€åŸå› 
âœ… ä¾¿äºæ‰©å±•ï¼šé¢„ç•™æ‰©å±•å­—æ®µ
```

**âš ï¸ å¸¸è§è®¾è®¡è¯¯åŒº**

| **é”™è¯¯åšæ³•** | **æ­£ç¡®åšæ³•** | **åŸå› è¯´æ˜** |
|-------------|-------------|-------------|
| `throw new Exception("é”™è¯¯")` | `throw new OrderException("E1001", "è®¢å•ä¸å­˜åœ¨")` | ä¿¡æ¯ä¸æ˜ç¡® |
| `å¼‚å¸¸ç±»è¿‡å¤š` | `åˆç†åˆ†ç±»ï¼Œé€‚åº¦ç»†åŒ–` | éš¾ä»¥ç»´æŠ¤ |
| `ä¸è®°å½•åŸå§‹å¼‚å¸¸` | `ä¿ç•™causeå‚æ•°` | ä¸¢å¤±é”™è¯¯çº¿ç´¢ |

---

## 3. ğŸ¯ ä¸šåŠ¡å¼‚å¸¸ä½“ç³»æ„å»º



### 3.1 æŒ‰ä¸šåŠ¡æ¨¡å—åˆ’åˆ†



**ğŸ¢ æ¨¡å—åŒ–å¼‚å¸¸è®¾è®¡**
```
æŒ‰ä¸šåŠ¡é¢†åŸŸåˆ†ç±»ï¼š
è®¢å•æ¨¡å—ï¼šOrderException
ç”¨æˆ·æ¨¡å—ï¼šUserException
æ”¯ä»˜æ¨¡å—ï¼šPaymentException
åº“å­˜æ¨¡å—ï¼šStockException
```

**ğŸ“¦ è®¢å•æ¨¡å—å¼‚å¸¸ç¤ºä¾‹**
```java
/**
 * è®¢å•ç›¸å…³å¼‚å¸¸
 */
public class OrderException extends BaseException {
    
    public OrderException(String message) {
        super("ORDER_ERROR", message);
    }
    
    public OrderException(String errorCode, String message) {
        super(errorCode, message);
    }
}

// å…·ä½“çš„è®¢å•å¼‚å¸¸
public class OrderNotFoundException extends OrderException {
    public OrderNotFoundException(Long orderId) {
        super("ORDER_NOT_FOUND", "è®¢å•ä¸å­˜åœ¨ï¼š" + orderId);
    }
}

public class OrderCancelledException extends OrderException {
    public OrderCancelledException(String orderNo) {
        super("ORDER_CANCELLED", "è®¢å•å·²å–æ¶ˆï¼š" + orderNo);
    }
}
```

### 3.2 æŒ‰å¼‚å¸¸ç±»å‹åˆ’åˆ†



**ğŸ” åŠŸèƒ½ç»´åº¦åˆ†ç±»**
```
å‚æ•°å¼‚å¸¸ï¼šParamException
æƒé™å¼‚å¸¸ï¼šPermissionException
ä¸šåŠ¡å¼‚å¸¸ï¼šBusinessException
ç³»ç»Ÿå¼‚å¸¸ï¼šSystemException
```

**ğŸ’» å‚æ•°å¼‚å¸¸ç¤ºä¾‹**
```java
/**
 * å‚æ•°æ ¡éªŒå¼‚å¸¸
 */
public class ParamException extends BaseException {
    
    // å“ªä¸ªå­—æ®µå‡ºé”™
    private String fieldName;
    
    public ParamException(String fieldName, String message) {
        super("PARAM_ERROR", message);
        this.fieldName = fieldName;
    }
    
    // ä¾¿æ·æ–¹æ³•ï¼šå‚æ•°ä¸ºç©º
    public static ParamException requiredParam(String fieldName) {
        return new ParamException(fieldName, fieldName + "ä¸èƒ½ä¸ºç©º");
    }
    
    // ä¾¿æ·æ–¹æ³•ï¼šå‚æ•°æ ¼å¼é”™è¯¯
    public static ParamException invalidFormat(String fieldName) {
        return new ParamException(fieldName, fieldName + "æ ¼å¼ä¸æ­£ç¡®");
    }
    
    public String getFieldName() {
        return fieldName;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
if (userId == null) {
    throw ParamException.requiredParam("userId");
}
```

### 3.3 å¼‚å¸¸å±‚æ¬¡ç»“æ„



**ğŸŒ³ å¼‚å¸¸ä½“ç³»æ ‘çŠ¶å›¾**
```
BaseException (åŸºç¡€å¼‚å¸¸)
â”œâ”€â”€ BusinessException (ä¸šåŠ¡å¼‚å¸¸)
â”‚   â”œâ”€â”€ OrderException (è®¢å•å¼‚å¸¸)
â”‚   â”‚   â”œâ”€â”€ OrderNotFoundException
â”‚   â”‚   â””â”€â”€ OrderCancelledException
â”‚   â”œâ”€â”€ UserException (ç”¨æˆ·å¼‚å¸¸)
â”‚   â”‚   â”œâ”€â”€ UserNotFoundException
â”‚   â”‚   â””â”€â”€ UserLockedException
â”‚   â””â”€â”€ PaymentException (æ”¯ä»˜å¼‚å¸¸)
â”‚       â”œâ”€â”€ InsufficientBalanceException
â”‚       â””â”€â”€ PaymentTimeoutException
â”œâ”€â”€ ParamException (å‚æ•°å¼‚å¸¸)
â””â”€â”€ SystemException (ç³»ç»Ÿå¼‚å¸¸)
    â”œâ”€â”€ DatabaseException
    â””â”€â”€ NetworkException
```

---

## 4. ğŸ”¢ å¼‚å¸¸ç ç»Ÿä¸€å®šä¹‰



### 4.1 å¼‚å¸¸ç è®¾è®¡è§„èŒƒ



**ğŸ“‹ å¼‚å¸¸ç ç»“æ„**
```
å¼‚å¸¸ç æ ¼å¼ï¼šå­—æ¯ + æ•°å­—ï¼ˆ6-8ä½ï¼‰
ç¤ºä¾‹ï¼š
- ORD001ï¼šè®¢å•æ¨¡å—001å·é”™è¯¯
- USR002ï¼šç”¨æˆ·æ¨¡å—002å·é”™è¯¯
- PAY003ï¼šæ”¯ä»˜æ¨¡å—003å·é”™è¯¯

åˆ†æ®µå«ä¹‰ï¼š
[æ¨¡å—ä»£ç ][é”™è¯¯ç±»å‹][é”™è¯¯åºå·]
  ORD        01         001
  â†“          â†“          â†“
  è®¢å•      ä¸šåŠ¡é”™è¯¯    ç¬¬1ä¸ª
```

**ğŸ¨ é”™è¯¯ç åˆ†ç±»ç¤ºä¾‹**

| **æ¨¡å—** | **å‰ç¼€** | **é”™è¯¯ç±»å‹** | **ç¤ºä¾‹é”™è¯¯ç ** | **å«ä¹‰** |
|---------|---------|------------|--------------|---------|
| **è®¢å•** | ORD | 01-ä¸šåŠ¡ / 02-ç³»ç»Ÿ | ORD01001 | è®¢å•ä¸å­˜åœ¨ |
| **ç”¨æˆ·** | USR | 01-ä¸šåŠ¡ / 02-ç³»ç»Ÿ | USR01001 | ç”¨æˆ·æœªç™»å½• |
| **æ”¯ä»˜** | PAY | 01-ä¸šåŠ¡ / 02-ç³»ç»Ÿ | PAY01001 | ä½™é¢ä¸è¶³ |

### 4.2 é”™è¯¯ç å¸¸é‡ç®¡ç†



**ğŸ”§ æšä¸¾ç±»å®šä¹‰é”™è¯¯ç **
```java
/**
 * è®¢å•å¼‚å¸¸ç 
 */
public enum OrderErrorCode {
    
    ORDER_NOT_FOUND("ORD01001", "è®¢å•ä¸å­˜åœ¨"),
    ORDER_CANCELLED("ORD01002", "è®¢å•å·²å–æ¶ˆ"),
    ORDER_PAID("ORD01003", "è®¢å•å·²æ”¯ä»˜"),
    STOCK_INSUFFICIENT("ORD01004", "åº“å­˜ä¸è¶³"),
    
    ORDER_CREATE_FAILED("ORD02001", "è®¢å•åˆ›å»ºå¤±è´¥"),
    ORDER_UPDATE_FAILED("ORD02002", "è®¢å•æ›´æ–°å¤±è´¥");
    
    private final String code;
    private final String message;
    
    OrderErrorCode(String code, String message) {
        this.code = code;
        this.message = message;
    }
    
    public String getCode() {
        return code;
    }
    
    public String getMessage() {
        return message;
    }
}

// ä½¿ç”¨æšä¸¾æŠ›å‡ºå¼‚å¸¸
throw new OrderException(
    OrderErrorCode.ORDER_NOT_FOUND.getCode(),
    OrderErrorCode.ORDER_NOT_FOUND.getMessage()
);
```

### 4.3 é”™è¯¯ç é›†ä¸­ç®¡ç†



**ğŸ“¦ ç»Ÿä¸€é”™è¯¯ç æ¥å£**
```java
/**
 * é”™è¯¯ç æ¥å£
 * æ‰€æœ‰é”™è¯¯ç æšä¸¾å®ç°æ­¤æ¥å£
 */
public interface ErrorCode {
    String getCode();
    String getMessage();
}

// é€šç”¨é”™è¯¯ç 
public enum CommonErrorCode implements ErrorCode {
    SUCCESS("00000", "æˆåŠŸ"),
    SYSTEM_ERROR("99999", "ç³»ç»Ÿå¼‚å¸¸"),
    PARAM_ERROR("10001", "å‚æ•°é”™è¯¯"),
    UNAUTHORIZED("10002", "æœªæˆæƒ"),
    FORBIDDEN("10003", "æ— æƒé™");
    
    private final String code;
    private final String message;
    
    CommonErrorCode(String code, String message) {
        this.code = code;
        this.message = message;
    }
    
    @Override
    public String getCode() { return code; }
    
    @Override
    public String getMessage() { return message; }
}
```

---

## 5. ğŸŒ é”™è¯¯ä¿¡æ¯å›½é™…åŒ–



### 5.1 å›½é™…åŒ–é…ç½®



**ğŸ—‚ï¸ èµ„æºæ–‡ä»¶å‡†å¤‡**
```
é¡¹ç›®ç»“æ„ï¼š
resources/
â”œâ”€â”€ i18n/
â”‚   â”œâ”€â”€ messages_zh_CN.properties  # ä¸­æ–‡
â”‚   â”œâ”€â”€ messages_en_US.properties  # è‹±æ–‡
â”‚   â””â”€â”€ messages_ja_JP.properties  # æ—¥æ–‡
```

**ğŸ“ ä¸­æ–‡èµ„æºæ–‡ä»¶ï¼ˆmessages_zh_CN.propertiesï¼‰**
```properties
# è®¢å•ç›¸å…³

order.not.found=è®¢å•ä¸å­˜åœ¨ï¼š{0}
order.cancelled=è®¢å•å·²å–æ¶ˆ
order.stock.insufficient=åº“å­˜ä¸è¶³ï¼Œå½“å‰åº“å­˜ï¼š{0}

# ç”¨æˆ·ç›¸å…³

user.not.found=ç”¨æˆ·ä¸å­˜åœ¨
user.locked=è´¦æˆ·å·²é”å®š
user.password.error=å¯†ç é”™è¯¯

# æ”¯ä»˜ç›¸å…³

payment.balance.insufficient=ä½™é¢ä¸è¶³ï¼Œå½“å‰ä½™é¢ï¼š{0}
payment.timeout=æ”¯ä»˜è¶…æ—¶
```

**ğŸ“ è‹±æ–‡èµ„æºæ–‡ä»¶ï¼ˆmessages_en_US.propertiesï¼‰**
```properties
# Order

order.not.found=Order not found: {0}
order.cancelled=Order has been cancelled
order.stock.insufficient=Insufficient stock, current: {0}

# User

user.not.found=User not found
user.locked=Account locked
user.password.error=Incorrect password

# Payment

payment.balance.insufficient=Insufficient balance, current: {0}
payment.timeout=Payment timeout
```

### 5.2 å›½é™…åŒ–å·¥å…·ç±»



**ğŸ”§ æ¶ˆæ¯å›½é™…åŒ–å·¥å…·**
```java
@Component
public class MessageUtils {
    
    @Autowired
    private MessageSource messageSource;
    
    /**
     * è·å–å›½é™…åŒ–æ¶ˆæ¯
     * @param code æ¶ˆæ¯é”®
     * @param args å‚æ•°
     * @return å›½é™…åŒ–åçš„æ¶ˆæ¯
     */
    public String getMessage(String code, Object... args) {
        // è·å–å½“å‰è¯·æ±‚çš„è¯­è¨€ç¯å¢ƒ
        Locale locale = LocaleContextHolder.getLocale();
        return messageSource.getMessage(code, args, locale);
    }
    
    /**
     * è·å–å›½é™…åŒ–æ¶ˆæ¯ï¼ˆå¸¦é»˜è®¤å€¼ï¼‰
     */
    public String getMessage(String code, String defaultMsg, Object... args) {
        Locale locale = LocaleContextHolder.getLocale();
        return messageSource.getMessage(code, args, defaultMsg, locale);
    }
}
```

### 5.3 å¼‚å¸¸ä¸­ä½¿ç”¨å›½é™…åŒ–



**ğŸ’» å›½é™…åŒ–å¼‚å¸¸ç¤ºä¾‹**
```java
public class I18nException extends BaseException {
    
    // æ¶ˆæ¯keyï¼ˆç”¨äºå›½é™…åŒ–ï¼‰
    private String messageKey;
    
    // æ¶ˆæ¯å‚æ•°
    private Object[] args;
    
    public I18nException(String errorCode, String messageKey, Object... args) {
        super(errorCode, messageKey);
        this.messageKey = messageKey;
        this.args = args;
    }
    
    // Getteræ–¹æ³•
    public String getMessageKey() {
        return messageKey;
    }
    
    public Object[] getArgs() {
        return args;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
if (stock < quantity) {
    throw new I18nException(
        "ORD01004",
        "order.stock.insufficient",
        stock  // å‚æ•°ï¼šå½“å‰åº“å­˜æ•°
    );
}

// å…¨å±€å¼‚å¸¸å¤„ç†å™¨ä¸­è·å–å›½é™…åŒ–æ¶ˆæ¯
@ExceptionHandler(I18nException.class)
public Result handleI18nException(I18nException e) {
    String message = messageUtils.getMessage(
        e.getMessageKey(), 
        e.getArgs()
    );
    return Result.error(e.getErrorCode(), message);
}
```

---

## 6. ğŸ”— å¼‚å¸¸å¤„ç†é“¾æœºåˆ¶



### 6.1 å¼‚å¸¸å¤„ç†é“¾æ¦‚å¿µ



**ğŸ”¸ ä»€ä¹ˆæ˜¯å¼‚å¸¸å¤„ç†é“¾**
```
å°±åƒ"å¤šå±‚ä¿é™©"æœºåˆ¶

åœºæ™¯ï¼šè°ƒç”¨ç¬¬ä¸‰æ–¹æ”¯ä»˜æ¥å£
1. ç¬¬ä¸‰æ–¹æŠ›å‡ºï¼šSocketTimeoutException
2. æ”¯ä»˜æœåŠ¡æ•è·å¹¶åŒ…è£…ï¼šPaymentException
3. è®¢å•æœåŠ¡æ•è·å¹¶è®°å½•ï¼šOrderException
4. æ§åˆ¶å™¨ç»Ÿä¸€å¤„ç†ï¼šè¿”å›å‹å¥½æç¤º

å¥½å¤„ï¼š
- æ¯å±‚åªå¤„ç†è‡ªå·±å…³å¿ƒçš„å¼‚å¸¸
- é€å±‚æ·»åŠ ä¸šåŠ¡ä¿¡æ¯
- ä¿ç•™å®Œæ•´çš„å¼‚å¸¸é“¾è·¯
```

### 6.2 å¼‚å¸¸é“¾ä¼ é€’ç¤ºä¾‹



**ğŸ”„ å¼‚å¸¸ä¼ é€’æµç¨‹**
```
åº•å±‚å¼‚å¸¸ â†’ ä¸šåŠ¡å¼‚å¸¸ â†’ å…¨å±€å¤„ç†

å®é™…ä»£ç æµç¨‹ï¼š
æ•°æ®åº“å±‚ï¼šSQLException
    â†“ (æ•è·å¹¶åŒ…è£…)
DAOå±‚ï¼šDatabaseException
    â†“ (æ•è·å¹¶åŒ…è£…)
Serviceå±‚ï¼šBusinessException
    â†“ (æ•è·å¹¶åŒ…è£…)
Controllerå±‚ï¼šç»Ÿä¸€å¼‚å¸¸å¤„ç†
```

**ğŸ’» å¼‚å¸¸é“¾ä»£ç ç¤ºä¾‹**
```java
// DAOå±‚
public Order getOrderById(Long id) {
    try {
        return jdbcTemplate.queryForObject(sql, mapper, id);
    } catch (EmptyResultDataAccessException e) {
        // æ•°æ®åº“å¼‚å¸¸è½¬æ¢ä¸ºä¸šåŠ¡å¼‚å¸¸
        throw new OrderNotFoundException(id, e);
    }
}

// Serviceå±‚
public OrderDTO getOrder(Long id) {
    try {
        Order order = orderDao.getOrderById(id);
        return convert(order);
    } catch (OrderNotFoundException e) {
        // æ·»åŠ ä¸šåŠ¡ä¸Šä¸‹æ–‡ä¿¡æ¯
        log.error("è·å–è®¢å•å¤±è´¥ï¼Œè®¢å•IDï¼š{}", id, e);
        throw new BusinessException("ORDER_GET_FAILED", 
            "è·å–è®¢å•ä¿¡æ¯å¤±è´¥", e);
    }
}

// Controllerå±‚ï¼šå…¨å±€å¼‚å¸¸å¤„ç†å™¨ç»Ÿä¸€æ•è·
@ExceptionHandler(BusinessException.class)
public Result handleBusinessException(BusinessException e) {
    // è®°å½•å®Œæ•´å¼‚å¸¸é“¾
    log.error("ä¸šåŠ¡å¼‚å¸¸ï¼š{}", e.getMessage(), e);
    return Result.error(e.getErrorCode(), e.getMessage());
}
```

### 6.3 å¼‚å¸¸é“¾æœ€ä½³å®è·µ



**âœ… æ­£ç¡®çš„å¼‚å¸¸ä¼ é€’**
```java
// âœ… ä¿ç•™åŸå§‹å¼‚å¸¸
throw new BusinessException("å¤„ç†å¤±è´¥", originalException);

// âœ… æ·»åŠ ä¸Šä¸‹æ–‡ä¿¡æ¯
throw new OrderException("è®¢å•å¤„ç†å¤±è´¥ï¼šè®¢å•å·=" + orderNo, e);

// âœ… é€å±‚æ·»åŠ ä¸šåŠ¡å«ä¹‰
catch (IOException e) {
    throw new FileUploadException("æ–‡ä»¶ä¸Šä¼ å¤±è´¥", e);
}
```

**âŒ é”™è¯¯çš„å¼‚å¸¸å¤„ç†**
```java
// âŒ åæ‰å¼‚å¸¸ï¼Œä¸æŠ›å‡ºä¹Ÿä¸è®°å½•
catch (Exception e) {
    // ä»€ä¹ˆéƒ½ä¸åš
}

// âŒ ä¸¢å¤±åŸå§‹å¼‚å¸¸ä¿¡æ¯
catch (SQLException e) {
    throw new BusinessException("æ•°æ®åº“é”™è¯¯");  // æ²¡ä¼ e
}

// âŒ æ•è·ååˆæŠ›å‡ºç›¸åŒå¼‚å¸¸
catch (IOException e) {
    log.error("é”™è¯¯", e);
    throw e;  // æ²¡æœ‰å¢åŠ æ–°ä¿¡æ¯ï¼Œå¤šæ­¤ä¸€ä¸¾
}
```

---

## 7. ğŸ”„ å¼‚å¸¸è½¬æ¢ä¸åŒ…è£…



### 7.1 ä¸ºä»€ä¹ˆéœ€è¦å¼‚å¸¸è½¬æ¢



**ğŸ¤” å¼‚å¸¸è½¬æ¢çš„æ„ä¹‰**
```
åº•å±‚æŠ€æœ¯å¼‚å¸¸ â†’ ä¸šåŠ¡å¼‚å¸¸

ä¸è½¬æ¢çš„é—®é¢˜ï¼š
âŒ SQLExceptionæš´éœ²ç»™ç”¨æˆ· - ç”¨æˆ·çœ‹ä¸æ‡‚
âŒ NullPointerException - ä¸çŸ¥é“å“ªé‡Œç©ºäº†
âŒ æŠ€æœ¯ç»†èŠ‚æ³„éœ² - å®‰å…¨é£é™©

è½¬æ¢åçš„å¥½å¤„ï¼š
âœ… OrderNotFoundException - ä¸€ç›®äº†ç„¶
âœ… éšè—æŠ€æœ¯ç»†èŠ‚
âœ… ç»Ÿä¸€çš„é”™è¯¯ç å’Œæç¤º
```

### 7.2 å¸¸è§å¼‚å¸¸è½¬æ¢åœºæ™¯



**ğŸ“Š è½¬æ¢æ˜ å°„è¡¨**

| **åŸå§‹å¼‚å¸¸** | **è½¬æ¢å** | **ä½¿ç”¨åœºæ™¯** |
|-------------|-----------|-------------|
| `SQLException` | `DatabaseException` | æ•°æ®åº“æ“ä½œå¤±è´¥ |
| `IOException` | `FileException` | æ–‡ä»¶è¯»å†™å¤±è´¥ |
| `HttpClientException` | `RemoteCallException` | è¿œç¨‹è°ƒç”¨å¤±è´¥ |
| `JsonProcessingException` | `DataFormatException` | JSONè§£æå¤±è´¥ |

**ğŸ’» å¼‚å¸¸è½¬æ¢å·¥å…·ç±»**
```java
public class ExceptionConverter {
    
    /**
     * å°†åº•å±‚å¼‚å¸¸è½¬æ¢ä¸ºä¸šåŠ¡å¼‚å¸¸
     */
    public static BusinessException convert(Exception e) {
        
        // å·²ç»æ˜¯ä¸šåŠ¡å¼‚å¸¸ï¼Œç›´æ¥è¿”å›
        if (e instanceof BusinessException) {
            return (BusinessException) e;
        }
        
        // æ ¹æ®å¼‚å¸¸ç±»å‹è½¬æ¢
        if (e instanceof SQLException) {
            return new DatabaseException("æ•°æ®åº“æ“ä½œå¤±è´¥", e);
        }
        
        if (e instanceof IOException) {
            return new SystemException("IOæ“ä½œå¤±è´¥", e);
        }
        
        if (e instanceof NullPointerException) {
            return new SystemException("ç©ºæŒ‡é’ˆå¼‚å¸¸", e);
        }
        
        // æœªçŸ¥å¼‚å¸¸ï¼ŒåŒ…è£…ä¸ºç³»ç»Ÿå¼‚å¸¸
        return new SystemException("ç³»ç»Ÿå¼‚å¸¸", e);
    }
}

// ä½¿ç”¨ç¤ºä¾‹
try {
    // è°ƒç”¨åº•å±‚æ–¹æ³•
    jdbcTemplate.update(sql, params);
} catch (Exception e) {
    // ç»Ÿä¸€è½¬æ¢
    throw ExceptionConverter.convert(e);
}
```

### 7.3 å¼‚å¸¸åŒ…è£…ç­–ç•¥



**ğŸ¯ åˆ†å±‚åŒ…è£…åŸåˆ™**
```
DAOå±‚ï¼š  æŠ€æœ¯å¼‚å¸¸ â†’ DAOå¼‚å¸¸
Serviceå±‚ï¼šDAOå¼‚å¸¸ â†’ ä¸šåŠ¡å¼‚å¸¸
Controllerå±‚ï¼šä¸šåŠ¡å¼‚å¸¸ â†’ å“åº”å¯¹è±¡

ç¤ºä¾‹ï¼š
æ•°æ®åº“è¿æ¥è¶…æ—¶ï¼ˆåº•å±‚ï¼‰
  â†“
DatabaseTimeoutExceptionï¼ˆDAOå±‚ï¼‰
  â†“
OrderCreateExceptionï¼ˆServiceå±‚ï¼‰
  â†“
{"code": "ORD02001", "msg": "è®¢å•åˆ›å»ºå¤±è´¥"}ï¼ˆControllerå±‚ï¼‰
```

---

## 8. ğŸ“ å †æ ˆä¿¡æ¯æ§åˆ¶



### 8.1 å †æ ˆä¿¡æ¯çš„ä½œç”¨



**ğŸ” å †æ ˆä¿¡æ¯åŒ…å«ä»€ä¹ˆ**
```
å¼‚å¸¸å †æ ˆï¼š
- å¼‚å¸¸ç±»å‹ï¼šOrderNotFoundException
- é”™è¯¯ä¿¡æ¯ï¼šè®¢å•ä¸å­˜åœ¨ï¼š123456
- å‘ç”Ÿä½ç½®ï¼šOrderService.java:45
- è°ƒç”¨é“¾è·¯ï¼šController â†’ Service â†’ DAO

ä½œç”¨ï¼š
âœ… å¿«é€Ÿå®šä½é—®é¢˜ä»£ç ä½ç½®
âœ… äº†è§£å¼‚å¸¸ä¼ é€’è·¯å¾„
âœ… æ’æŸ¥å¤æ‚é—®é¢˜çš„çº¿ç´¢
```

**âš ï¸ å †æ ˆä¿¡æ¯çš„é—®é¢˜**
```
é—®é¢˜1ï¼šæ€§èƒ½å¼€é”€
- ç”Ÿæˆå †æ ˆä¿¡æ¯æ¶ˆè€—CPU
- å¤§é‡å¼‚å¸¸å½±å“æ€§èƒ½

é—®é¢˜2ï¼šä¿¡æ¯æ³„éœ²
- æš´éœ²ä»£ç ç»“æ„
- æ³„éœ²æœåŠ¡å™¨è·¯å¾„
- å®‰å…¨é£é™©

é—®é¢˜3ï¼šæ—¥å¿—è¿‡å¤§
- å †æ ˆä¿¡æ¯å†—é•¿
- å ç”¨å­˜å‚¨ç©ºé—´
```

### 8.2 å †æ ˆä¿¡æ¯ä¼˜åŒ–



**ğŸ¯ æŒ‰ç¯å¢ƒæ§åˆ¶å †æ ˆ**
```java
public class OptimizedException extends RuntimeException {
    
    // æ˜¯å¦å¡«å……å †æ ˆä¿¡æ¯
    private boolean stackTraceEnabled = true;
    
    public OptimizedException(String message) {
        super(message);
        // ç”Ÿäº§ç¯å¢ƒç¦ç”¨å †æ ˆ
        if ("prod".equals(getEnvironment())) {
            stackTraceEnabled = false;
        }
    }
    
    @Override
    public synchronized Throwable fillInStackTrace() {
        // ä¸å¡«å……å †æ ˆï¼Œæå‡æ€§èƒ½
        return stackTraceEnabled ? super.fillInStackTrace() : this;
    }
    
    private String getEnvironment() {
        // è·å–å½“å‰ç¯å¢ƒé…ç½®
        return System.getProperty("app.env", "dev");
    }
}
```

### 8.3 å †æ ˆä¿¡æ¯æ ¼å¼åŒ–



**ğŸ“‹ ç®€åŒ–å †æ ˆè¾“å‡º**
```java
public class StackTraceUtils {
    
    /**
     * è·å–ç®€åŒ–çš„å †æ ˆä¿¡æ¯ï¼ˆåªä¿ç•™å…³é”®è¡Œï¼‰
     */
    public static String getSimpleStackTrace(Throwable e) {
        StringBuilder sb = new StringBuilder();
        sb.append(e.getClass().getName())
          .append(": ")
          .append(e.getMessage())
          .append("\n");
        
        // åªä¿ç•™é¡¹ç›®ç›¸å…³çš„å †æ ˆ
        StackTraceElement[] traces = e.getStackTrace();
        for (StackTraceElement trace : traces) {
            // åªè®°å½•é¡¹ç›®åŒ…ä¸‹çš„ä»£ç 
            if (trace.getClassName().startsWith("com.myapp")) {
                sb.append("  at ")
                  .append(trace.toString())
                  .append("\n");
            }
        }
        return sb.toString();
    }
    
    /**
     * è·å–æ ¹æœ¬åŸå› 
     */
    public static Throwable getRootCause(Throwable e) {
        Throwable cause = e;
        while (cause.getCause() != null) {
            cause = cause.getCause();
        }
        return cause;
    }
}

// æ—¥å¿—è®°å½•æ—¶ä½¿ç”¨
log.error("å¼‚å¸¸ä¿¡æ¯ï¼š{}", StackTraceUtils.getSimpleStackTrace(e));
```

**ğŸ”§ å…¨å±€å¼‚å¸¸å¤„ç†ä¸­çš„å †æ ˆæ§åˆ¶**
```java
@RestControllerAdvice
public class GlobalExceptionHandler {
    
    @Value("${app.exception.show-stack:false}")
    private boolean showStackTrace;
    
    @ExceptionHandler(Exception.class)
    public Result handleException(Exception e) {
        
        // è®°å½•å®Œæ•´æ—¥å¿—
        log.error("ç³»ç»Ÿå¼‚å¸¸", e);
        
        // è¿”å›ç»™å‰ç«¯çš„ä¿¡æ¯
        String message = e.getMessage();
        
        // å¼€å‘ç¯å¢ƒè¿”å›å †æ ˆï¼Œç”Ÿäº§ç¯å¢ƒä¸è¿”å›
        if (showStackTrace) {
            return Result.error("SYSTEM_ERROR", message, 
                StackTraceUtils.getSimpleStackTrace(e));
        } else {
            return Result.error("SYSTEM_ERROR", "ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•");
        }
    }
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“



### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ



```
ğŸ”¸ è‡ªå®šä¹‰å¼‚å¸¸ï¼šç»™é”™è¯¯èµ·ä¸“ä¸šåå­—ï¼Œä¾¿äºå®šä½å’Œå¤„ç†
ğŸ”¸ å¼‚å¸¸ä½“ç³»ï¼šæŒ‰ä¸šåŠ¡æ¨¡å—æˆ–åŠŸèƒ½ç±»å‹åˆ†å±‚è®¾è®¡
ğŸ”¸ é”™è¯¯ç ï¼šç»Ÿä¸€ç¼–ç è§„èŒƒï¼Œä¾¿äºé—®é¢˜è¿½è¸ª
ğŸ”¸ å›½é™…åŒ–ï¼šæ”¯æŒå¤šè¯­è¨€ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
ğŸ”¸ å¼‚å¸¸é“¾ï¼šä¿ç•™å®Œæ•´çš„é”™è¯¯ä¼ é€’è·¯å¾„
ğŸ”¸ å¼‚å¸¸è½¬æ¢ï¼šæŠ€æœ¯å¼‚å¸¸è½¬ä¸šåŠ¡å¼‚å¸¸ï¼Œéšè—åº•å±‚ç»†èŠ‚
ğŸ”¸ å †æ ˆæ§åˆ¶ï¼šå¼€å‘ç¯å¢ƒè¯¦ç»†ï¼Œç”Ÿäº§ç¯å¢ƒç®€åŒ–
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹



**ğŸ”¹ è‡ªå®šä¹‰å¼‚å¸¸çš„æœ¬è´¨**
```
ç³»ç»Ÿé»˜è®¤å¼‚å¸¸ï¼š
- å¤ªæŠ€æœ¯åŒ–ï¼Œç”¨æˆ·çœ‹ä¸æ‡‚
- ä¿¡æ¯ä¸å¤Ÿï¼Œæ’æŸ¥å›°éš¾
- å¤„ç†æ–¹å¼å•ä¸€

è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ï¼š
- æºå¸¦ä¸šåŠ¡å«ä¹‰ï¼ˆè®¢å•ä¸å­˜åœ¨ï¼‰
- åŒ…å«é”™è¯¯ç ï¼ˆORD01001ï¼‰
- æ”¯æŒå›½é™…åŒ–ï¼ˆä¸­è‹±æ–‡åˆ‡æ¢ï¼‰
- ä¾¿äºç»Ÿä¸€å¤„ç†
```

**ğŸ”¹ å¼‚å¸¸è®¾è®¡åŸåˆ™**
```
æ¸…æ™°æ€§åŸåˆ™ï¼š
- å¼‚å¸¸åç§°è¦è§åçŸ¥æ„
- é”™è¯¯ä¿¡æ¯è¦å‡†ç¡®å…·ä½“
- ä¸è¦ç”¨æ¨¡ç³Šçš„Exception

å±‚æ¬¡æ€§åŸåˆ™ï¼š
- åŸºç¡€å¼‚å¸¸ä½œä¸ºçˆ¶ç±»
- ä¸šåŠ¡å¼‚å¸¸æŒ‰æ¨¡å—åˆ’åˆ†
- é¿å…è¿‡åº¦ç»†åˆ†

å®ç”¨æ€§åŸåˆ™ï¼š
- æ»¡è¶³ä¸šåŠ¡éœ€æ±‚å³å¯
- ä¸è¦ä¸ºäº†è®¾è®¡è€Œè®¾è®¡
- ä¿æŒç®€å•å¯ç»´æŠ¤
```

### 9.3 å®é™…åº”ç”¨åœºæ™¯



**ğŸ¯ ç”µå•†ç³»ç»Ÿå¼‚å¸¸ä½“ç³»**
```
BaseException
â”œâ”€â”€ OrderException
â”‚   â”œâ”€â”€ OrderNotFoundException (è®¢å•ä¸å­˜åœ¨)
â”‚   â”œâ”€â”€ OrderCancelledException (è®¢å•å·²å–æ¶ˆ)
â”‚   â””â”€â”€ StockInsufficientException (åº“å­˜ä¸è¶³)
â”œâ”€â”€ UserException
â”‚   â”œâ”€â”€ UserNotFoundException (ç”¨æˆ·ä¸å­˜åœ¨)
â”‚   â””â”€â”€ UserLockedException (è´¦æˆ·é”å®š)
â””â”€â”€ PaymentException
    â”œâ”€â”€ BalanceInsufficientException (ä½™é¢ä¸è¶³)
    â””â”€â”€ PaymentTimeoutException (æ”¯ä»˜è¶…æ—¶)
```

**ğŸ’¡ å®æˆ˜æŠ€å·§**
```
å¼‚å¸¸æŠ›å‡ºï¼š
âœ… ä¸šåŠ¡è§„åˆ™è¿å â†’ æŠ›è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸
âœ… æºå¸¦ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆè®¢å•å·ã€ç”¨æˆ·IDç­‰ï¼‰
âœ… é€‰æ‹©åˆé€‚çš„é”™è¯¯ç 

å¼‚å¸¸å¤„ç†ï¼š
âœ… å…¨å±€ç»Ÿä¸€æ•è·å¤„ç†
âœ… è®°å½•è¯¦ç»†æ—¥å¿—ä¾¿äºæ’æŸ¥
âœ… è¿”å›å‹å¥½æç¤ºç»™å‰ç«¯

å¼‚å¸¸ä¼˜åŒ–ï¼š
âœ… é«˜é¢‘å¼‚å¸¸ç¦ç”¨å †æ ˆç”Ÿæˆ
âœ… æŒ‰ç¯å¢ƒæ§åˆ¶ä¿¡æ¯è¯¦ç»†åº¦
âœ… ä½¿ç”¨å¼‚å¸¸ç¼“å­˜å‡å°‘åˆ›å»º
```

### 9.4 å­¦ä¹ æ£€æŸ¥æ¸…å•



**ğŸ“ çŸ¥è¯†ç‚¹è‡ªæŸ¥**
- [ ] ç†è§£ä¸ºä»€ä¹ˆéœ€è¦è‡ªå®šä¹‰å¼‚å¸¸
- [ ] ä¼šè®¾è®¡åŸºç¡€å¼‚å¸¸ç±»
- [ ] æŒæ¡å¼‚å¸¸ä½“ç³»åˆ†å±‚åŸåˆ™
- [ ] èƒ½å¤Ÿå®šä¹‰ç»Ÿä¸€çš„é”™è¯¯ç 
- [ ] äº†è§£å¼‚å¸¸å›½é™…åŒ–å®ç°
- [ ] ç†è§£å¼‚å¸¸é“¾ä¼ é€’æœºåˆ¶
- [ ] ä¼šè¿›è¡Œå¼‚å¸¸è½¬æ¢å’ŒåŒ…è£…
- [ ] çŸ¥é“å¦‚ä½•æ§åˆ¶å †æ ˆä¿¡æ¯

**ğŸ”‘ æ ¸å¿ƒè®°å¿†å£è¯€**
> è‡ªå®šä¹‰å¼‚å¸¸åˆ†å±‚æ¬¡ï¼Œé”™è¯¯ç è¦ç»Ÿä¸€
> å›½é™…åŒ–æ”¯æŒå¤šè¯­è¨€ï¼Œå¼‚å¸¸é“¾ä¿ç•™ä¿¡æ¯
> è½¬æ¢åŒ…è£…éšç»†èŠ‚ï¼Œå †æ ˆæ§åˆ¶çœ‹ç¯å¢ƒ

**ğŸ’¡ å»¶ä¼¸å­¦ä¹ å»ºè®®**
- å­¦ä¹ Spring Bootçš„å…¨å±€å¼‚å¸¸å¤„ç†
- äº†è§£RESTful APIçš„é”™è¯¯å“åº”è§„èŒƒ
- ç ”ç©¶åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼‚å¸¸å¤„ç†ç­–ç•¥
- æŒæ¡æ—¥å¿—æ¡†æ¶çš„å¼‚å¸¸è®°å½•æœ€ä½³å®è·µ