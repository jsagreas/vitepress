---
title: 5ã€å‰åç«¯æ•°æ®äº¤äº’
---
## ğŸ“š ç›®å½•

1. [RESTful APIè®¾è®¡è§„èŒƒ](#1-RESTful-APIè®¾è®¡è§„èŒƒ)
2. [ç»Ÿä¸€å“åº”æ ¼å¼è®¾è®¡](#2-ç»Ÿä¸€å“åº”æ ¼å¼è®¾è®¡)
3. [é”™è¯¯ç è§„èŒƒå®šä¹‰](#3-é”™è¯¯ç è§„èŒƒå®šä¹‰)
4. [æ¥å£æ–‡æ¡£ç”Ÿæˆä¸ç®¡ç†](#4-æ¥å£æ–‡æ¡£ç”Ÿæˆä¸ç®¡ç†)
5. [è·¨åŸŸè¯·æ±‚å¤„ç†æ–¹æ¡ˆ](#5-è·¨åŸŸè¯·æ±‚å¤„ç†æ–¹æ¡ˆ)
6. [æ–‡ä»¶ä¸Šä¼ æ¥å£å®ç°](#6-æ–‡ä»¶ä¸Šä¼ æ¥å£å®ç°)
7. [æ–‡ä»¶ä¸‹è½½æ¥å£å®ç°](#7-æ–‡ä»¶ä¸‹è½½æ¥å£å®ç°)
8. [å®æ—¶æ•°æ®æ¨é€æŠ€æœ¯](#8-å®æ—¶æ•°æ®æ¨é€æŠ€æœ¯)
9. [æ¥å£ç‰ˆæœ¬ç®¡ç†ç­–ç•¥](#9-æ¥å£ç‰ˆæœ¬ç®¡ç†ç­–ç•¥)
10. [æ¥å£å®‰å…¨è®¤è¯æœºåˆ¶](#10-æ¥å£å®‰å…¨è®¤è¯æœºåˆ¶)
11. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#11-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ RESTful APIè®¾è®¡è§„èŒƒ


### 1.1 ä»€ä¹ˆæ˜¯RESTful API


**é€šä¿—ç†è§£**ï¼š
æƒ³è±¡ä½ å»é¤å…ç‚¹èœï¼Œä½ éœ€è¦å‘Šè¯‰æœåŠ¡å‘˜"æˆ‘è¦ä»€ä¹ˆ"å’Œ"å¯¹è¿™ä¸ªèœåšä»€ä¹ˆæ“ä½œ"ã€‚RESTful APIå°±åƒæ˜¯å‰ç«¯å’Œåç«¯ä¹‹é—´çš„"ç‚¹èœå•"ï¼Œè§„å®šäº†æ€ä¹ˆè¯·æ±‚æ•°æ®ã€æ€ä¹ˆæ“ä½œæ•°æ®ã€‚

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
- **REST** = Representational State Transferï¼ˆè¡¨ç°å±‚çŠ¶æ€è½¬ç§»ï¼‰
- æœ¬è´¨ï¼šç”¨URLè¡¨ç¤ºèµ„æºï¼Œç”¨HTTPæ–¹æ³•è¡¨ç¤ºæ“ä½œ
- ç›®çš„ï¼šè®©æ¥å£è®¾è®¡æ›´è§„èŒƒã€æ›´æ˜“æ‡‚

### 1.2 RESTfulè®¾è®¡çš„æ ¸å¿ƒåŸåˆ™


**ğŸ”¸ åŸåˆ™ä¸€ï¼šèµ„æºå¯¼å‘çš„URLè®¾è®¡**

```
âŒ ä¸å¥½çš„è®¾è®¡ï¼š
/getUserInfo?id=1        ï¼ˆåŠ¨è¯åŒ–URLï¼‰
/deleteUser?id=1         ï¼ˆæ··ä¹±çš„å‘½åï¼‰
/api/user_list           ï¼ˆä¸ç»Ÿä¸€çš„é£æ ¼ï¼‰

âœ… RESTfulè®¾è®¡ï¼š
GET    /users/1          ï¼ˆè·å–ç”¨æˆ·ï¼‰
DELETE /users/1          ï¼ˆåˆ é™¤ç”¨æˆ·ï¼‰
GET    /users            ï¼ˆè·å–ç”¨æˆ·åˆ—è¡¨ï¼‰
```

**æ ¸å¿ƒè¦ç‚¹**ï¼š
- URLåªåŒ…å«åè¯ï¼ˆèµ„æºï¼‰ï¼Œä¸åŒ…å«åŠ¨è¯
- ç”¨å¤æ•°å½¢å¼è¡¨ç¤ºé›†åˆï¼š`/users` è€Œä¸æ˜¯ `/user`
- é€šè¿‡HTTPæ–¹æ³•è¡¨è¾¾æ“ä½œæ„å›¾

**ğŸ”¸ åŸåˆ™äºŒï¼šHTTPæ–¹æ³•çš„æ­£ç¡®ä½¿ç”¨**

| HTTPæ–¹æ³• | æ“ä½œå«ä¹‰ | å®é™…ä¾‹å­ | è¿”å›ç»“æœ |
|---------|---------|---------|---------|
| **GET** | æŸ¥è¯¢èµ„æº | `GET /users/1` | è¿”å›ç”¨æˆ·è¯¦æƒ… |
| **POST** | åˆ›å»ºèµ„æº | `POST /users` | è¿”å›æ–°ç”¨æˆ·ä¿¡æ¯ |
| **PUT** | å®Œæ•´æ›´æ–° | `PUT /users/1` | è¿”å›æ›´æ–°åçš„ç”¨æˆ· |
| **PATCH** | éƒ¨åˆ†æ›´æ–° | `PATCH /users/1` | è¿”å›æ›´æ–°åçš„ç”¨æˆ· |
| **DELETE** | åˆ é™¤èµ„æº | `DELETE /users/1` | è¿”å›åˆ é™¤çŠ¶æ€ |

**å®é™…åº”ç”¨åœºæ™¯**ï¼š
```
ğŸ“± ç”¨æˆ·ç®¡ç†æ¨¡å—ï¼š
GET    /users              # è·å–æ‰€æœ‰ç”¨æˆ·åˆ—è¡¨
GET    /users/1            # è·å–IDä¸º1çš„ç”¨æˆ·è¯¦æƒ…
POST   /users              # åˆ›å»ºæ–°ç”¨æˆ·
PUT    /users/1            # å®Œæ•´æ›´æ–°ç”¨æˆ·ä¿¡æ¯
PATCH  /users/1            # åªæ›´æ–°ç”¨æˆ·çš„æŸäº›å­—æ®µï¼ˆå¦‚åªæ”¹æ‰‹æœºå·ï¼‰
DELETE /users/1            # åˆ é™¤ç”¨æˆ·

ğŸ›’ è®¢å•ç®¡ç†æ¨¡å—ï¼š
GET    /orders             # è·å–è®¢å•åˆ—è¡¨
GET    /orders/123         # è·å–è®¢å•è¯¦æƒ…
POST   /orders             # åˆ›å»ºæ–°è®¢å•
PUT    /orders/123/status  # æ›´æ–°è®¢å•çŠ¶æ€
DELETE /orders/123         # å–æ¶ˆè®¢å•
```

### 1.3 URLè®¾è®¡æœ€ä½³å®è·µ


**ğŸ”¹ å±‚çº§å…³ç³»è¡¨ç¤º**

```
è¡¨ç¤ºèµ„æºé—´çš„åŒ…å«å…³ç³»ï¼š
GET /users/1/orders           # è·å–ç”¨æˆ·1çš„æ‰€æœ‰è®¢å•
GET /users/1/orders/100       # è·å–ç”¨æˆ·1çš„è®¢å•100
GET /classes/5/students       # è·å–ç­çº§5çš„æ‰€æœ‰å­¦ç”Ÿ
```

**ğŸ”¹ æŸ¥è¯¢å‚æ•°çš„ä½¿ç”¨**

```
ç”¨äºç­›é€‰ã€æ’åºã€åˆ†é¡µï¼š
GET /users?role=admin              # ç­›é€‰ï¼šè·å–ç®¡ç†å‘˜ç”¨æˆ·
GET /users?page=1&size=10          # åˆ†é¡µï¼šç¬¬1é¡µï¼Œæ¯é¡µ10æ¡
GET /users?sort=createdTime,desc   # æ’åºï¼šæŒ‰åˆ›å»ºæ—¶é—´å€’åº
GET /products?category=phone&brand=apple  # å¤šæ¡ä»¶ç­›é€‰
```

**ğŸ”¹ ç‰ˆæœ¬æ§åˆ¶**

```
ä¸‰ç§å¸¸è§æ–¹å¼ï¼š

æ–¹å¼1ï¼šURLè·¯å¾„ç‰ˆæœ¬
/api/v1/users
/api/v2/users

æ–¹å¼2ï¼šè¯·æ±‚å¤´ç‰ˆæœ¬
GET /users
Headers: API-Version: 1

æ–¹å¼3ï¼šå‚æ•°ç‰ˆæœ¬
/users?version=1
```

### 1.4 Controllerå±‚å®ç°ç¤ºä¾‹


**åŸºç¡€ç¤ºä¾‹**ï¼š

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    @Autowired
    private UserService userService;
    
    // è·å–ç”¨æˆ·åˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µå’Œç­›é€‰ï¼‰
    @GetMapping
    public Result getUserList(
        @RequestParam(defaultValue = "1") Integer page,
        @RequestParam(defaultValue = "10") Integer size,
        @RequestParam(required = false) String role
    ) {
        // æ ¹æ®å‚æ•°æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨
        PageInfo<User> users = userService.getUserList(page, size, role);
        return Result.success(users);
    }
    
    // è·å–å•ä¸ªç”¨æˆ·è¯¦æƒ…
    @GetMapping("/{id}")
    public Result getUserById(@PathVariable Long id) {
        User user = userService.getUserById(id);
        return Result.success(user);
    }
    
    // åˆ›å»ºæ–°ç”¨æˆ·
    @PostMapping
    public Result createUser(@RequestBody User user) {
        User newUser = userService.createUser(user);
        return Result.success(newUser);
    }
    
    // æ›´æ–°ç”¨æˆ·ä¿¡æ¯
    @PutMapping("/{id}")
    public Result updateUser(
        @PathVariable Long id, 
        @RequestBody User user
    ) {
        user.setId(id);
        User updatedUser = userService.updateUser(user);
        return Result.success(updatedUser);
    }
    
    // åˆ é™¤ç”¨æˆ·
    @DeleteMapping("/{id}")
    public Result deleteUser(@PathVariable Long id) {
        userService.deleteUser(id);
        return Result.success("åˆ é™¤æˆåŠŸ");
    }
}
```

**ğŸ’¡ å…³é”®ç‚¹è§£é‡Š**ï¼š
- `@RestController` = `@Controller` + `@ResponseBody`ï¼Œè‡ªåŠ¨å°†è¿”å›å€¼è½¬JSON
- `@RequestMapping` å®šä¹‰åŸºç¡€è·¯å¾„
- `@PathVariable` è·å–URLè·¯å¾„ä¸­çš„å‚æ•°ï¼ˆå¦‚ `/users/1` ä¸­çš„1ï¼‰
- `@RequestParam` è·å–æŸ¥è¯¢å‚æ•°ï¼ˆå¦‚ `?page=1` ä¸­çš„pageï¼‰
- `@RequestBody` æ¥æ”¶JSONæ ¼å¼çš„è¯·æ±‚ä½“

---

## 2. ğŸ“¦ ç»Ÿä¸€å“åº”æ ¼å¼è®¾è®¡


### 2.1 ä¸ºä»€ä¹ˆéœ€è¦ç»Ÿä¸€å“åº”æ ¼å¼


**é—®é¢˜åœºæ™¯**ï¼š
```
ä¸ç»Ÿä¸€çš„å“åº”æ ¼å¼ä¼šå¯¼è‡´ï¼š
âŒ å‰ç«¯ï¼š"è¿™ä¸ªæ¥å£è¿”å›çš„æ•°æ®æ ¼å¼åˆå˜äº†ï¼Ÿ"
âŒ åç«¯Aï¼šè¿”å› { "data": {...} }
âŒ åç«¯Bï¼šè¿”å› { "result": {...} }
âŒ åç«¯Cï¼šè¿”å› { "success": true, "info": {...} }
```

**ç»Ÿä¸€åçš„å¥½å¤„**ï¼š
```
âœ… å‰ç«¯å¯ä»¥ç”¨ç»Ÿä¸€çš„æ–¹å¼å¤„ç†æ‰€æœ‰æ¥å£å“åº”
âœ… é”™è¯¯å¤„ç†æ›´è§„èŒƒ
âœ… ä»£ç å¤ç”¨æ€§æ›´é«˜
âœ… å›¢é˜Ÿåä½œæ›´é¡ºç•…
```

### 2.2 å“åº”æ ¼å¼è®¾è®¡


**æ ‡å‡†å“åº”ç»“æ„**ï¼š

```
{
    "code": 200,           // ä¸šåŠ¡çŠ¶æ€ç 
    "message": "æ“ä½œæˆåŠŸ",  // æç¤ºä¿¡æ¯
    "data": {...},         // å®é™…æ•°æ®
    "timestamp": 1234567890 // å“åº”æ—¶é—´æˆ³ï¼ˆå¯é€‰ï¼‰
}
```

**ğŸ”¸ å­—æ®µè¯´æ˜**ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|-----|------|------|------|
| **code** | Integer | ä¸šåŠ¡çŠ¶æ€ç  | 200æˆåŠŸ, 400å‚æ•°é”™è¯¯ |
| **message** | String | ç»™ç”¨æˆ·çœ‹çš„æç¤ºä¿¡æ¯ | "ç™»å½•æˆåŠŸ" |
| **data** | Object | å®é™…ä¸šåŠ¡æ•°æ® | ç”¨æˆ·ä¿¡æ¯ã€åˆ—è¡¨æ•°æ®ç­‰ |
| **timestamp** | Long | å“åº”æ—¶é—´æˆ³ | 1695456789000 |

### 2.3 Resultå·¥å…·ç±»å®ç°


```java
@Data
public class Result<T> {
    private Integer code;      // çŠ¶æ€ç 
    private String message;    // æç¤ºä¿¡æ¯
    private T data;           // æ•°æ®
    private Long timestamp;   // æ—¶é—´æˆ³
    
    // æˆåŠŸå“åº”ï¼ˆå¸¦æ•°æ®ï¼‰
    public static <T> Result<T> success(T data) {
        Result<T> result = new Result<>();
        result.setCode(200);
        result.setMessage("æ“ä½œæˆåŠŸ");
        result.setData(data);
        result.setTimestamp(System.currentTimeMillis());
        return result;
    }
    
    // æˆåŠŸå“åº”ï¼ˆæ— æ•°æ®ï¼‰
    public static <T> Result<T> success(String message) {
        Result<T> result = new Result<>();
        result.setCode(200);
        result.setMessage(message);
        result.setTimestamp(System.currentTimeMillis());
        return result;
    }
    
    // å¤±è´¥å“åº”
    public static <T> Result<T> error(Integer code, String message) {
        Result<T> result = new Result<>();
        result.setCode(code);
        result.setMessage(message);
        result.setTimestamp(System.currentTimeMillis());
        return result;
    }
}
```

### 2.4 å®é™…ä½¿ç”¨ç¤ºä¾‹


**âœ… æˆåŠŸåœºæ™¯**ï¼š

```java
// åœºæ™¯1ï¼šè¿”å›å•ä¸ªå¯¹è±¡
@GetMapping("/{id}")
public Result<User> getUser(@PathVariable Long id) {
    User user = userService.getUser(id);
    return Result.success(user);
}
// å“åº”ï¼š{"code":200,"message":"æ“ä½œæˆåŠŸ","data":{"id":1,"name":"å¼ ä¸‰"}}

// åœºæ™¯2ï¼šè¿”å›åˆ—è¡¨
@GetMapping
public Result<List<User>> getUserList() {
    List<User> users = userService.getUserList();
    return Result.success(users);
}

// åœºæ™¯3ï¼šè¿”å›åˆ†é¡µæ•°æ®
@GetMapping("/page")
public Result<PageInfo<User>> getUserPage() {
    PageInfo<User> pageInfo = userService.getUserPage();
    return Result.success(pageInfo);
}

// åœºæ™¯4ï¼šæ“ä½œæˆåŠŸï¼Œæ— è¿”å›æ•°æ®
@DeleteMapping("/{id}")
public Result deleteUser(@PathVariable Long id) {
    userService.deleteUser(id);
    return Result.success("åˆ é™¤æˆåŠŸ");
}
```

**âŒ å¤±è´¥åœºæ™¯**ï¼š

```java
// å‚æ•°æ ¡éªŒå¤±è´¥
if (StringUtils.isEmpty(user.getName())) {
    return Result.error(400, "ç”¨æˆ·åä¸èƒ½ä¸ºç©º");
}

// ä¸šåŠ¡é€»è¾‘é”™è¯¯
if (userService.exists(username)) {
    return Result.error(400, "ç”¨æˆ·åå·²å­˜åœ¨");
}

// æƒé™ä¸è¶³
if (!hasPermission(userId)) {
    return Result.error(403, "æ— æƒé™è®¿é—®");
}
```

---

## 3. ğŸ”¢ é”™è¯¯ç è§„èŒƒå®šä¹‰


### 3.1 é”™è¯¯ç è®¾è®¡åŸåˆ™


**ä¸ºä»€ä¹ˆéœ€è¦é”™è¯¯ç **ï¼š
```
åœºæ™¯å¯¹æ¯”ï¼š
âŒ å«ç³Šçš„æç¤ºï¼š"æ“ä½œå¤±è´¥"ï¼ˆç”¨æˆ·æ‡µäº†ï¼Œå¼€å‘ä¹Ÿæ‡µäº†ï¼‰
âœ… æ˜ç¡®çš„é”™è¯¯ç ï¼š40001 - ç”¨æˆ·åå·²å­˜åœ¨ï¼ˆä¸€çœ‹å°±æ‡‚ï¼‰
```

**è®¾è®¡åŸåˆ™**ï¼š
- ğŸ“ **åˆ†ç±»æ¸…æ™°**ï¼šä¸åŒç±»å‹é”™è¯¯ç”¨ä¸åŒåŒºé—´
- ğŸ“ **è§ç çŸ¥æ„**ï¼šçœ‹åˆ°é”™è¯¯ç å°±çŸ¥é“å¤§æ¦‚é—®é¢˜
- ğŸ“ **ä¾¿äºå®šä½**ï¼šå¿«é€Ÿæ‰¾åˆ°é—®é¢˜æ ¹æº

### 3.2 é”™è¯¯ç åˆ†ç±»ä½“ç³»


**ğŸ”¸ HTTPçŠ¶æ€ç  + ä¸šåŠ¡é”™è¯¯ç ç»“åˆ**

```
é”™è¯¯ç ç»“æ„ï¼šXYZZ
â”œâ”€â”€ Xï¼šé”™è¯¯ç±»å‹ï¼ˆ1ä½ï¼‰
â”‚   â”œâ”€â”€ 2ï¼šæˆåŠŸ
â”‚   â”œâ”€â”€ 4ï¼šå®¢æˆ·ç«¯é”™è¯¯
â”‚   â””â”€â”€ 5ï¼šæœåŠ¡ç«¯é”™è¯¯
â”œâ”€â”€ YZï¼šå…·ä½“ä¸šåŠ¡æ¨¡å—ï¼ˆ2ä½ï¼‰
â”‚   â”œâ”€â”€ 00ï¼šé€šç”¨
â”‚   â”œâ”€â”€ 01ï¼šç”¨æˆ·æ¨¡å—
â”‚   â”œâ”€â”€ 02ï¼šè®¢å•æ¨¡å—
â”‚   â””â”€â”€ 03ï¼šå•†å“æ¨¡å—
â””â”€â”€ ZZï¼šå…·ä½“é”™è¯¯ï¼ˆ2ä½ï¼‰
```

**å¸¸ç”¨é”™è¯¯ç å®šä¹‰**ï¼š

```java
public class ErrorCode {
    
    // ===== æˆåŠŸçŠ¶æ€ =====
    public static final int SUCCESS = 200;
    
    // ===== å®¢æˆ·ç«¯é”™è¯¯ 4xxx =====
    // é€šç”¨é”™è¯¯ 400x
    public static final int BAD_REQUEST = 4000;      // è¯·æ±‚å‚æ•°é”™è¯¯
    public static final int UNAUTHORIZED = 4001;     // æœªç™»å½•
    public static final int FORBIDDEN = 4003;        // æ— æƒé™
    public static final int NOT_FOUND = 4004;        // èµ„æºä¸å­˜åœ¨
    
    // ç”¨æˆ·æ¨¡å— 401x
    public static final int USER_NOT_EXIST = 4010;   // ç”¨æˆ·ä¸å­˜åœ¨
    public static final int USER_EXIST = 4011;       // ç”¨æˆ·å·²å­˜åœ¨
    public static final int PASSWORD_ERROR = 4012;   // å¯†ç é”™è¯¯
    public static final int ACCOUNT_DISABLED = 4013; // è´¦å·è¢«ç¦ç”¨
    
    // è®¢å•æ¨¡å— 402x
    public static final int ORDER_NOT_FOUND = 4020;  // è®¢å•ä¸å­˜åœ¨
    public static final int ORDER_PAID = 4021;       // è®¢å•å·²æ”¯ä»˜
    public static final int STOCK_NOT_ENOUGH = 4022; // åº“å­˜ä¸è¶³
    
    // ===== æœåŠ¡ç«¯é”™è¯¯ 5xxx =====
    public static final int SERVER_ERROR = 5000;     // æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
    public static final int DATABASE_ERROR = 5001;   // æ•°æ®åº“é”™è¯¯
    public static final int THIRD_PARTY_ERROR = 5002; // ç¬¬ä¸‰æ–¹æœåŠ¡é”™è¯¯
}
```

### 3.3 ErrorCodeæšä¸¾ç±»è®¾è®¡


```java
@Getter
public enum ErrorCodeEnum {
    
    // æˆåŠŸ
    SUCCESS(200, "æ“ä½œæˆåŠŸ"),
    
    // é€šç”¨é”™è¯¯
    BAD_REQUEST(4000, "è¯·æ±‚å‚æ•°é”™è¯¯"),
    UNAUTHORIZED(4001, "æœªç™»å½•æˆ–ç™»å½•å·²è¿‡æœŸ"),
    FORBIDDEN(4003, "æ— æƒé™è®¿é—®"),
    NOT_FOUND(4004, "è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨"),
    
    // ç”¨æˆ·æ¨¡å—
    USER_NOT_EXIST(4010, "ç”¨æˆ·ä¸å­˜åœ¨"),
    USER_EXIST(4011, "ç”¨æˆ·åå·²è¢«ä½¿ç”¨"),
    PASSWORD_ERROR(4012, "å¯†ç é”™è¯¯"),
    
    // æœåŠ¡å™¨é”™è¯¯
    SERVER_ERROR(5000, "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•");
    
    private final Integer code;
    private final String message;
    
    ErrorCodeEnum(Integer code, String message) {
        this.code = code;
        this.message = message;
    }
}
```

**ä½¿ç”¨æ–¹å¼**ï¼š

```java
// æ–¹å¼1ï¼šç›´æ¥ä½¿ç”¨æšä¸¾
if (user == null) {
    return Result.error(
        ErrorCodeEnum.USER_NOT_EXIST.getCode(),
        ErrorCodeEnum.USER_NOT_EXIST.getMessage()
    );
}

// æ–¹å¼2ï¼šå°è£…ç®€åŒ–
public static <T> Result<T> error(ErrorCodeEnum errorCode) {
    return Result.error(errorCode.getCode(), errorCode.getMessage());
}

// ä½¿ç”¨
return Result.error(ErrorCodeEnum.USER_NOT_EXIST);
```

---

## 4. ğŸ“ æ¥å£æ–‡æ¡£ç”Ÿæˆä¸ç®¡ç†


### 4.1 ä¸ºä»€ä¹ˆéœ€è¦æ¥å£æ–‡æ¡£


**ç—›ç‚¹åœºæ™¯**ï¼š
```
æ²¡æœ‰æ–‡æ¡£çš„åæœï¼š
ğŸ˜­ å‰ç«¯ï¼š"è¿™ä¸ªæ¥å£æ€ä¹ˆè°ƒç”¨ï¼Ÿå‚æ•°æ˜¯ä»€ä¹ˆï¼Ÿ"
ğŸ˜­ åç«¯ï¼š"æˆ‘ä¸Šå‘¨å†™çš„ï¼Œå¿˜è®°äº†..."
ğŸ˜­ æµ‹è¯•ï¼š"æ¥å£æ–‡æ¡£åœ¨å“ªï¼Ÿæˆ‘æ€ä¹ˆæµ‹ï¼Ÿ"
ğŸ˜­ æ–°äººï¼š"å®Œå…¨ä¸çŸ¥é“ä»å“ªå¼€å§‹..."
```

**æœ‰äº†æ–‡æ¡£å**ï¼š
```
âœ… æ¥å£ä¿¡æ¯ä¸€ç›®äº†ç„¶
âœ… å‰åç«¯åä½œæ›´é¡ºç•…
âœ… å¯ä»¥ç›´æ¥åœ¨çº¿æµ‹è¯•
âœ… è‡ªåŠ¨ç”Ÿæˆï¼Œçœæ—¶çœåŠ›
```

### 4.2 Swagger/Knife4jé›†æˆ


**ğŸ”¸ ä¾èµ–é…ç½®**ï¼š

```xml
<!-- Knife4jï¼ˆSwaggerå¢å¼ºç‰ˆï¼Œç•Œé¢æ›´ç¾è§‚ï¼‰ -->
<dependency>
    <groupId>com.github.xiaoymin</groupId>
    <artifactId>knife4j-spring-boot-starter</artifactId>
    <version>3.0.3</version>
</dependency>
```

**ğŸ”¸ é…ç½®ç±»**ï¼š

```java
@Configuration
@EnableOpenApi
public class Knife4jConfig {
    
    @Bean
    public Docket docket() {
        return new Docket(DocumentationType.OAS_30)
            .apiInfo(apiInfo())
            .select()
            .apis(RequestHandlerSelectors.basePackage("com.example.controller"))
            .paths(PathSelectors.any())
            .build();
    }
    
    private ApiInfo apiInfo() {
        return new ApiInfoBuilder()
            .title("æˆ‘çš„é¡¹ç›®APIæ–‡æ¡£")
            .description("å‰åç«¯äº¤äº’æ¥å£æ–‡æ¡£")
            .version("1.0")
            .contact(new Contact("å¼€å‘å›¢é˜Ÿ", "", "dev@example.com"))
            .build();
    }
}
```

### 4.3 æ¥å£æ–‡æ¡£æ³¨è§£ä½¿ç”¨


**Controllerå±‚æ³¨è§£**ï¼š

```java
@RestController
@RequestMapping("/api/users")
@Api(tags = "ç”¨æˆ·ç®¡ç†")  // æ¨¡å—è¯´æ˜
public class UserController {
    
    @GetMapping("/{id}")
    @ApiOperation("æ ¹æ®IDè·å–ç”¨æˆ·è¯¦æƒ…")  // æ¥å£è¯´æ˜
    @ApiImplicitParam(name = "id", value = "ç”¨æˆ·ID", required = true)
    public Result<User> getUser(@PathVariable Long id) {
        return Result.success(userService.getUser(id));
    }
    
    @PostMapping
    @ApiOperation("åˆ›å»ºæ–°ç”¨æˆ·")
    public Result<User> createUser(@RequestBody User user) {
        return Result.success(userService.createUser(user));
    }
}
```

**å®ä½“ç±»æ³¨è§£**ï¼š

```java
@Data
@ApiModel("ç”¨æˆ·ä¿¡æ¯")
public class User {
    
    @ApiModelProperty("ç”¨æˆ·ID")
    private Long id;
    
    @ApiModelProperty(value = "ç”¨æˆ·å", required = true, example = "zhangsan")
    private String username;
    
    @ApiModelProperty(value = "é‚®ç®±", example = "zhangsan@example.com")
    private String email;
    
    @ApiModelProperty("ç”¨æˆ·çŠ¶æ€ï¼š0-ç¦ç”¨ï¼Œ1-å¯ç”¨")
    private Integer status;
}
```

**ğŸ’¡ è®¿é—®æ–¹å¼**ï¼š
```
å¯åŠ¨é¡¹ç›®åè®¿é—®ï¼š
http://localhost:8080/doc.html

å¯ä»¥ï¼š
âœ… æŸ¥çœ‹æ‰€æœ‰æ¥å£åˆ—è¡¨
âœ… æŸ¥çœ‹æ¥å£è¯¦ç»†å‚æ•°
âœ… åœ¨çº¿è°ƒè¯•æ¥å£
âœ… æŸ¥çœ‹è¿”å›æ•°æ®æ ¼å¼
```

---

## 5. ğŸŒ è·¨åŸŸè¯·æ±‚å¤„ç†æ–¹æ¡ˆ


### 5.1 ä»€ä¹ˆæ˜¯è·¨åŸŸé—®é¢˜


**é€šä¿—ç†è§£**ï¼š
```
æƒ³è±¡ä½ åœ¨å®¶é‡Œï¼ˆhttp://localhost:3000ï¼‰
æƒ³å»æœ‹å‹å®¶æ‹¿ä¸œè¥¿ï¼ˆhttp://localhost:8080ï¼‰
æµè§ˆå™¨è¯´ï¼š"ä¸è¡Œï¼ä¸åŒåœ°æ–¹ä¸èƒ½éšä¾¿æ‹¿ä¸œè¥¿ï¼"

è¿™å°±æ˜¯è·¨åŸŸé™åˆ¶ â€”â€” æµè§ˆå™¨çš„å®‰å…¨æœºåˆ¶
```

**è·¨åŸŸåœºæ™¯**ï¼š
```
å‰ç«¯åœ°å€ï¼šhttp://localhost:3000
åç«¯åœ°å€ï¼šhttp://localhost:8080
        â†“
åè®®ã€åŸŸåã€ç«¯å£ ä»»ä½•ä¸€ä¸ªä¸åŒ = è·¨åŸŸ

âŒ http://localhost:3000  â†’  https://localhost:3000  (åè®®ä¸åŒ)
âŒ http://localhost:3000  â†’  http://127.0.0.1:3000   (åŸŸåä¸åŒ)
âŒ http://localhost:3000  â†’  http://localhost:8080   (ç«¯å£ä¸åŒ)
```

### 5.2 CORSè·¨åŸŸè§£å†³æ–¹æ¡ˆ


**ğŸ”¸ æ–¹æ¡ˆä¸€ï¼šå…¨å±€é…ç½®ç±»**

```java
@Configuration
public class CorsConfig implements WebMvcConfigurer {
    
    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/**")  // å¯¹æ‰€æœ‰æ¥å£ç”Ÿæ•ˆ
            .allowedOrigins("http://localhost:3000")  // å…è®¸çš„å‰ç«¯åœ°å€
            .allowedMethods("GET", "POST", "PUT", "DELETE")  // å…è®¸çš„æ–¹æ³•
            .allowedHeaders("*")  // å…è®¸çš„è¯·æ±‚å¤´
            .allowCredentials(true)  // å…è®¸æºå¸¦cookie
            .maxAge(3600);  // é¢„æ£€è¯·æ±‚çš„æœ‰æ•ˆæœŸï¼ˆç§’ï¼‰
    }
}
```

**ğŸ”¸ æ–¹æ¡ˆäºŒï¼šæ³¨è§£æ–¹å¼**

```java
@RestController
@RequestMapping("/api/users")
@CrossOrigin(origins = "http://localhost:3000")  // å•ä¸ªControllerå…è®¸è·¨åŸŸ
public class UserController {
    // ...
}
```

**ğŸ”¸ æ–¹æ¡ˆä¸‰ï¼šè¿‡æ»¤å™¨æ–¹å¼**

```java
@Component
public class CorsFilter implements Filter {
    
    @Override
    public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) 
            throws IOException, ServletException {
        
        HttpServletResponse response = (HttpServletResponse) res;
        HttpServletRequest request = (HttpServletRequest) req;
        
        // è®¾ç½®å…è®¸è·¨åŸŸçš„å“åº”å¤´
        response.setHeader("Access-Control-Allow-Origin", request.getHeader("Origin"));
        response.setHeader("Access-Control-Allow-Methods", "POST, GET, PUT, DELETE");
        response.setHeader("Access-Control-Max-Age", "3600");
        response.setHeader("Access-Control-Allow-Headers", "Content-Type, Authorization");
        response.setHeader("Access-Control-Allow-Credentials", "true");
        
        // å¦‚æœæ˜¯é¢„æ£€è¯·æ±‚ï¼Œç›´æ¥è¿”å›
        if ("OPTIONS".equals(request.getMethod())) {
            response.setStatus(HttpServletResponse.SC_OK);
            return;
        }
        
        chain.doFilter(req, res);
    }
}
```

**ğŸ’¡ é…ç½®å»ºè®®**ï¼š
```
å¼€å‘ç¯å¢ƒï¼šå…è®¸æ‰€æœ‰æ¥æºï¼ˆ.allowedOrigins("*")ï¼‰
ç”Ÿäº§ç¯å¢ƒï¼šåªå…è®¸ç‰¹å®šåŸŸåï¼ˆ.allowedOrigins("https://www.example.com")ï¼‰
```

---

## 6. ğŸ“¤ æ–‡ä»¶ä¸Šä¼ æ¥å£å®ç°


### 6.1 æ–‡ä»¶ä¸Šä¼ åŸºç¡€


**åº”ç”¨åœºæ™¯**ï¼š
```
ğŸ“· ç”¨æˆ·ä¸Šä¼ å¤´åƒ
ğŸ“„ ä¸Šä¼ èº«ä»½è¯ç…§ç‰‡
ğŸ“ ä¸Šä¼ Excelæ‰¹é‡å¯¼å…¥æ•°æ®
ğŸ“¹ ä¸Šä¼ è§†é¢‘ã€éŸ³é¢‘æ–‡ä»¶
```

**æ ¸å¿ƒæµç¨‹**ï¼š
```
å‰ç«¯é€‰æ‹©æ–‡ä»¶ â†’ å‘é€åˆ°åç«¯ â†’ ä¿å­˜åˆ°æœåŠ¡å™¨ â†’ è¿”å›æ–‡ä»¶è®¿é—®è·¯å¾„
```

### 6.2 å•æ–‡ä»¶ä¸Šä¼ å®ç°


```java
@RestController
@RequestMapping("/api/file")
public class FileController {
    
    @Value("${file.upload-path}")  // é…ç½®æ–‡ä»¶ä¸­å®šä¹‰ä¸Šä¼ è·¯å¾„
    private String uploadPath;
    
    @PostMapping("/upload")
    public Result<String> uploadFile(@RequestParam("file") MultipartFile file) {
        
        // 1. æ ¡éªŒæ–‡ä»¶
        if (file.isEmpty()) {
            return Result.error(4000, "è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶");
        }
        
        // 2. æ ¡éªŒæ–‡ä»¶å¤§å°ï¼ˆå¦‚é™åˆ¶5MBï¼‰
        long maxSize = 5 * 1024 * 1024;
        if (file.getSize() > maxSize) {
            return Result.error(4000, "æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡5MB");
        }
        
        // 3. æ ¡éªŒæ–‡ä»¶ç±»å‹
        String contentType = file.getContentType();
        if (!contentType.startsWith("image/")) {
            return Result.error(4000, "åªèƒ½ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶");
        }
        
        try {
            // 4. ç”Ÿæˆå”¯ä¸€æ–‡ä»¶åï¼ˆé¿å…é‡åï¼‰
            String originalFilename = file.getOriginalFilename();
            String suffix = originalFilename.substring(originalFilename.lastIndexOf("."));
            String fileName = UUID.randomUUID().toString() + suffix;
            
            // 5. æŒ‰æ—¥æœŸåˆ›å»ºæ–‡ä»¶å¤¹ï¼ˆä¾¿äºç®¡ç†ï¼‰
            String datePath = LocalDate.now().format(DateTimeFormatter.ofPattern("yyyy/MM/dd"));
            String dirPath = uploadPath + "/" + datePath;
            File dir = new File(dirPath);
            if (!dir.exists()) {
                dir.mkdirs();
            }
            
            // 6. ä¿å­˜æ–‡ä»¶
            String filePath = dirPath + "/" + fileName;
            file.transferTo(new File(filePath));
            
            // 7. è¿”å›è®¿é—®è·¯å¾„
            String url = "/uploads/" + datePath + "/" + fileName;
            return Result.success(url);
            
        } catch (IOException e) {
            return Result.error(5000, "æ–‡ä»¶ä¸Šä¼ å¤±è´¥");
        }
    }
}
```

**é…ç½®æ–‡ä»¶è®¾ç½®**ï¼š

```yaml
# application.yml
spring:
  servlet:
    multipart:
      max-file-size: 10MB      # å•ä¸ªæ–‡ä»¶å¤§å°é™åˆ¶
      max-request-size: 50MB   # æ€»è¯·æ±‚å¤§å°é™åˆ¶

file:
  upload-path: /data/uploads   # æ–‡ä»¶å­˜å‚¨è·¯å¾„
```

### 6.3 å¤šæ–‡ä»¶ä¸Šä¼ 


```java
@PostMapping("/upload-multiple")
public Result<List<String>> uploadMultiple(@RequestParam("files") MultipartFile[] files) {
    
    List<String> urls = new ArrayList<>();
    
    for (MultipartFile file : files) {
        // å¯¹æ¯ä¸ªæ–‡ä»¶æ‰§è¡Œä¸Šä¼ é€»è¾‘
        String url = saveFile(file);
        urls.add(url);
    }
    
    return Result.success(urls);
}
```

### 6.4 å‰ç«¯è°ƒç”¨ç¤ºä¾‹


```javascript
// å•æ–‡ä»¶ä¸Šä¼ 
const formData = new FormData();
formData.append('file', fileInput.files[0]);

axios.post('/api/file/upload', formData, {
    headers: { 'Content-Type': 'multipart/form-data' }
}).then(res => {
    console.log('æ–‡ä»¶è·¯å¾„ï¼š', res.data.data);
});

// å¤šæ–‡ä»¶ä¸Šä¼ 
const formData = new FormData();
for (let file of fileInput.files) {
    formData.append('files', file);
}

axios.post('/api/file/upload-multiple', formData)
    .then(res => {
        console.log('æ–‡ä»¶è·¯å¾„åˆ—è¡¨ï¼š', res.data.data);
    });
```

---

## 7. ğŸ“¥ æ–‡ä»¶ä¸‹è½½æ¥å£å®ç°


### 7.1 æ–‡ä»¶ä¸‹è½½åœºæ™¯


**å¸¸è§éœ€æ±‚**ï¼š
```
ğŸ“Š å¯¼å‡ºExcelæŠ¥è¡¨
ğŸ“„ ä¸‹è½½PDFæ–‡æ¡£
ğŸ–¼ï¸ ä¸‹è½½å›¾ç‰‡èµ„æº
ğŸ“¦ ä¸‹è½½å‹ç¼©åŒ…
```

### 7.2 æ–‡ä»¶ä¸‹è½½å®ç°


**æ–¹å¼ä¸€ï¼šç›´æ¥ä¸‹è½½æœ¬åœ°æ–‡ä»¶**

```java
@GetMapping("/download")
public void downloadFile(
    @RequestParam String fileName,
    HttpServletResponse response
) throws IOException {
    
    // 1. æ–‡ä»¶è·¯å¾„
    String filePath = uploadPath + "/" + fileName;
    File file = new File(filePath);
    
    if (!file.exists()) {
        response.setStatus(404);
        response.getWriter().write("æ–‡ä»¶ä¸å­˜åœ¨");
        return;
    }
    
    // 2. è®¾ç½®å“åº”å¤´
    response.setContentType("application/octet-stream");  // äºŒè¿›åˆ¶æµ
    response.setHeader("Content-Disposition", 
        "attachment;filename=" + URLEncoder.encode(fileName, "UTF-8"));
    
    // 3. è¯»å–æ–‡ä»¶å¹¶å†™å…¥å“åº”
    try (FileInputStream fis = new FileInputStream(file);
         OutputStream os = response.getOutputStream()) {
        
        byte[] buffer = new byte[1024];
        int len;
        while ((len = fis.read(buffer)) != -1) {
            os.write(buffer, 0, len);
        }
        os.flush();
    }
}
```

**æ–¹å¼äºŒï¼šResponseEntityæ–¹å¼**

```java
@GetMapping("/download/{fileName}")
public ResponseEntity<Resource> downloadFile(@PathVariable String fileName) {
    
    try {
        // 1. åŠ è½½æ–‡ä»¶èµ„æº
        Path filePath = Paths.get(uploadPath).resolve(fileName);
        Resource resource = new UrlResource(filePath.toUri());
        
        if (!resource.exists()) {
            return ResponseEntity.notFound().build();
        }
        
        // 2. è®¾ç½®å“åº”å¤´å¹¶è¿”å›
        return ResponseEntity.ok()
            .header(HttpHeaders.CONTENT_DISPOSITION, 
                "attachment; filename=\"" + resource.getFilename() + "\"")
            .body(resource);
            
    } catch (MalformedURLException e) {
        return ResponseEntity.badRequest().build();
    }
}
```

### 7.3 Excelå¯¼å‡ºç¤ºä¾‹


```java
@GetMapping("/export/users")
public void exportUsers(HttpServletResponse response) throws IOException {
    
    // 1. æŸ¥è¯¢æ•°æ®
    List<User> users = userService.getAllUsers();
    
    // 2. åˆ›å»ºExcelå·¥ä½œç°¿ï¼ˆä½¿ç”¨EasyExcelï¼‰
    response.setContentType("application/vnd.ms-excel");
    response.setHeader("Content-Disposition", 
        "attachment;filename=" + URLEncoder.encode("ç”¨æˆ·åˆ—è¡¨.xlsx", "UTF-8"));
    
    // 3. å†™å…¥Excel
    EasyExcel.write(response.getOutputStream(), User.class)
        .sheet("ç”¨æˆ·åˆ—è¡¨")
        .doWrite(users);
}
```

---

## 8. ğŸ”„ å®æ—¶æ•°æ®æ¨é€æŠ€æœ¯


### 8.1 å®æ—¶æ¨é€çš„åº”ç”¨åœºæ™¯


**ä¸ºä»€ä¹ˆéœ€è¦å®æ—¶æ¨é€**ï¼š
```
ä¼ ç»Ÿæ–¹å¼ï¼ˆè½®è¯¢ï¼‰ï¼šå‰ç«¯æ¯ç§’è¯·æ±‚ä¸€æ¬¡"æœ‰æ–°æ¶ˆæ¯å—ï¼Ÿ"
               â†“ é—®é¢˜ï¼šæµªè´¹èµ„æºã€å»¶è¿Ÿé«˜

å®æ—¶æ¨é€ï¼š     æœåŠ¡å™¨ä¸»åŠ¨å‘Šè¯‰å‰ç«¯"æœ‰æ–°æ¶ˆæ¯äº†ï¼"
               â†“ å¥½å¤„ï¼šå®æ—¶æ€§é«˜ã€çœèµ„æº
```

**å…¸å‹åº”ç”¨**ï¼š
```
ğŸ’¬ å³æ—¶èŠå¤©æ¶ˆæ¯
ğŸ“¢ ç³»ç»Ÿé€šçŸ¥æ¨é€
ğŸ“Š å®æ—¶æ•°æ®çœ‹æ¿
ğŸ® åœ¨çº¿æ¸¸æˆåŒæ­¥
```

### 8.2 WebSocketå®ç°


**ğŸ”¸ ä¾èµ–é…ç½®**ï¼š

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-websocket</artifactId>
</dependency>
```

**ğŸ”¸ WebSocketé…ç½®**ï¼š

```java
@Configuration
@EnableWebSocket
public class WebSocketConfig implements WebSocketConfigurer {
    
    @Override
    public void registerWebSocketHandlers(WebSocketHandlerRegistry registry) {
        registry.addHandler(new MyWebSocketHandler(), "/ws/message")
            .setAllowedOrigins("*");  // å…è®¸è·¨åŸŸ
    }
}
```

**ğŸ”¸ WebSocketå¤„ç†å™¨**ï¼š

```java
@Component
public class MyWebSocketHandler extends TextWebSocketHandler {
    
    // å­˜å‚¨æ‰€æœ‰è¿æ¥çš„ç”¨æˆ·
    private static final Map<String, WebSocketSession> sessions = new ConcurrentHashMap<>();
    
    // è¿æ¥å»ºç«‹
    @Override
    public void afterConnectionEstablished(WebSocketSession session) {
        String userId = getUserId(session);  // ä»sessionè·å–ç”¨æˆ·ID
        sessions.put(userId, session);
        System.out.println("ç”¨æˆ·è¿æ¥ï¼š" + userId);
    }
    
    // æ¥æ”¶æ¶ˆæ¯
    @Override
    protected void handleTextMessage(WebSocketSession session, TextMessage message) {
        String payload = message.getPayload();
        System.out.println("æ”¶åˆ°æ¶ˆæ¯ï¼š" + payload);
        
        // å¤„ç†æ¶ˆæ¯å¹¶å›å¤
        sendMessage(session, "æœåŠ¡å™¨æ”¶åˆ°ï¼š" + payload);
    }
    
    // è¿æ¥å…³é—­
    @Override
    public void afterConnectionClosed(WebSocketSession session, CloseStatus status) {
        String userId = getUserId(session);
        sessions.remove(userId);
        System.out.println("ç”¨æˆ·æ–­å¼€ï¼š" + userId);
    }
    
    // å‘é€æ¶ˆæ¯ç»™æŒ‡å®šç”¨æˆ·
    public static void sendMessageToUser(String userId, String message) {
        WebSocketSession session = sessions.get(userId);
        if (session != null && session.isOpen()) {
            try {
                session.sendMessage(new TextMessage(message));
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
    
    // å¹¿æ’­æ¶ˆæ¯ç»™æ‰€æœ‰ç”¨æˆ·
    public static void broadcast(String message) {
        sessions.values().forEach(session -> {
            try {
                session.sendMessage(new TextMessage(message));
            } catch (IOException e) {
                e.printStackTrace();
            }
        });
    }
}
```

**ğŸ”¸ å‰ç«¯è¿æ¥ç¤ºä¾‹**ï¼š

```javascript
// å»ºç«‹WebSocketè¿æ¥
const ws = new WebSocket('ws://localhost:8080/ws/message');

// è¿æ¥æˆåŠŸ
ws.onopen = () => {
    console.log('WebSocketè¿æ¥æˆåŠŸ');
    ws.send('Hello Server');
};

// æ¥æ”¶æ¶ˆæ¯
ws.onmessage = (event) => {
    console.log('æ”¶åˆ°æ¶ˆæ¯ï¼š', event.data);
};

// è¿æ¥å…³é—­
ws.onclose = () => {
    console.log('WebSocketè¿æ¥å…³é—­');
};

// å‘é€æ¶ˆæ¯
function sendMessage(msg) {
    ws.send(msg);
}
```

### 8.3 SSEï¼ˆServer-Sent Eventsï¼‰æ–¹æ¡ˆ


**é€‚ç”¨åœºæ™¯**ï¼šå•å‘æ¨é€ï¼ˆæœåŠ¡å™¨â†’å®¢æˆ·ç«¯ï¼‰

```java
@GetMapping(value = "/sse/notifications", produces = MediaType.TEXT_EVENT_STREAM_VALUE)
public SseEmitter notifications() {
    
    SseEmitter emitter = new SseEmitter();
    
    // å¼‚æ­¥å‘é€æ•°æ®
    executor.execute(() -> {
        try {
            for (int i = 0; i < 10; i++) {
                emitter.send("é€šçŸ¥ " + i);
                Thread.sleep(1000);
            }
            emitter.complete();
        } catch (Exception e) {
            emitter.completeWithError(e);
        }
    });
    
    return emitter;
}
```

**å‰ç«¯æ¥æ”¶**ï¼š

```javascript
const eventSource = new EventSource('/sse/notifications');

eventSource.onmessage = (event) => {
    console.log('æ”¶åˆ°æ¨é€ï¼š', event.data);
};
```

---

## 9. ğŸ”– æ¥å£ç‰ˆæœ¬ç®¡ç†ç­–ç•¥


### 9.1 ä¸ºä»€ä¹ˆéœ€è¦ç‰ˆæœ¬ç®¡ç†


**é—®é¢˜åœºæ™¯**ï¼š
```
è€ç‰ˆæœ¬APPï¼šè°ƒç”¨ /api/users æ¥å£ï¼Œè¿”å›æ ¼å¼A
æ–°ç‰ˆæœ¬APPï¼šéœ€è¦æ›´å¤šå­—æ®µï¼Œè¿”å›æ ¼å¼B

å¦‚æœç›´æ¥ä¿®æ”¹æ¥å£ï¼š
âŒ è€ç‰ˆæœ¬APPæŠ¥é”™å´©æºƒ
âŒ ç”¨æˆ·ä½“éªŒæå·®
```

**ç‰ˆæœ¬ç®¡ç†çš„å¥½å¤„**ï¼š
```
âœ… æ–°è€ç‰ˆæœ¬å…±å­˜
âœ… å¹³æ»‘å‡çº§è¿‡æ¸¡
âœ… çµæ´»æ§åˆ¶åºŸå¼ƒ
```

### 9.2 ç‰ˆæœ¬ç®¡ç†æ–¹æ¡ˆ


**ğŸ”¸ æ–¹æ¡ˆä¸€ï¼šURLè·¯å¾„ç‰ˆæœ¬**

```java
// V1ç‰ˆæœ¬
@RestController
@RequestMapping("/api/v1/users")
public class UserV1Controller {
    
    @GetMapping("/{id}")
    public Result<UserV1DTO> getUser(@PathVariable Long id) {
        // è¿”å›V1æ ¼å¼æ•°æ®
    }
}

// V2ç‰ˆæœ¬
@RestController
@RequestMapping("/api/v2/users")
public class UserV2Controller {
    
    @GetMapping("/{id}")
    public Result<UserV2DTO> getUser(@PathVariable Long id) {
        // è¿”å›V2æ ¼å¼æ•°æ®ï¼ˆå­—æ®µæ›´å¤šï¼‰
    }
}
```

**ä¼˜ç‚¹**ï¼šç›´è§‚æ˜“æ‡‚ï¼ŒURLä¸€çœ¼çœ‹å‡ºç‰ˆæœ¬
**ç¼ºç‚¹**ï¼šå¯èƒ½å¯¼è‡´ä»£ç é‡å¤

**ğŸ”¸ æ–¹æ¡ˆäºŒï¼šè¯·æ±‚å¤´ç‰ˆæœ¬**

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    @GetMapping(value = "/{id}", headers = "API-Version=1")
    public Result<UserV1DTO> getUserV1(@PathVariable Long id) {
        // V1é€»è¾‘
    }
    
    @GetMapping(value = "/{id}", headers = "API-Version=2")
    public Result<UserV2DTO> getUserV2(@PathVariable Long id) {
        // V2é€»è¾‘
    }
}
```

**å‰ç«¯è°ƒç”¨**ï¼š
```javascript
axios.get('/api/users/1', {
    headers: { 'API-Version': '2' }
});
```

**ğŸ”¸ æ–¹æ¡ˆä¸‰ï¼šå‚æ•°ç‰ˆæœ¬**

```java
@GetMapping("/{id}")
public Result getUser(
    @PathVariable Long id,
    @RequestParam(defaultValue = "1") Integer version
) {
    if (version == 1) {
        return Result.success(userService.getUserV1(id));
    } else if (version == 2) {
        return Result.success(userService.getUserV2(id));
    }
    return Result.error(4000, "ä¸æ”¯æŒçš„ç‰ˆæœ¬");
}
```

### 9.3 ç‰ˆæœ¬åºŸå¼ƒç­–ç•¥


```java
@Deprecated  // æ ‡è®°ä¸ºå·²åºŸå¼ƒ
@GetMapping("/old-api")
@ApiOperation(value = "æ—§æ¥å£", notes = "å·²åºŸå¼ƒï¼Œè¯·ä½¿ç”¨/new-api")
public Result oldApi() {
    // è®°å½•è­¦å‘Šæ—¥å¿—
    log.warn("è°ƒç”¨äº†å·²åºŸå¼ƒçš„æ¥å£ï¼š/old-api");
    
    // è®¾ç½®å“åº”å¤´æç¤º
    response.setHeader("Warning", "299 - æ­¤æ¥å£å·²åºŸå¼ƒï¼Œå°†äº2024-12-31ä¸‹çº¿");
    
    return Result.success("æ•°æ®");
}
```

---

## 10. ğŸ”’ æ¥å£å®‰å…¨è®¤è¯æœºåˆ¶


### 10.1 ä¸ºä»€ä¹ˆéœ€è¦æ¥å£å®‰å…¨


**å®‰å…¨é£é™©**ï¼š
```
âŒ æœªç™»å½•ç”¨æˆ·è®¿é—®æ•æ„Ÿæ¥å£
âŒ æ¶æ„ç”¨æˆ·ç¯¡æ”¹æ•°æ®
âŒ æ¥å£è¢«æ¶æ„åˆ·é‡
âŒ æ•°æ®è¢«ä¸­é—´äººçªƒå–
```

**å®‰å…¨éœ€æ±‚**ï¼š
```
âœ… èº«ä»½è®¤è¯ï¼šç¡®è®¤"ä½ æ˜¯è°"
âœ… æƒé™æ§åˆ¶ï¼šç¡®è®¤"ä½ èƒ½å¹²ä»€ä¹ˆ"
âœ… é˜²é‡æ”¾ï¼šé˜²æ­¢è¯·æ±‚è¢«é‡å¤åˆ©ç”¨
âœ… æ•°æ®åŠ å¯†ï¼šé˜²æ­¢æ•°æ®æ³„éœ²
```

### 10.2 JWTè®¤è¯æ–¹æ¡ˆ


**ğŸ”¸ JWTæ˜¯ä»€ä¹ˆ**ï¼š
```
JWT = JSON Web Token
æœ¬è´¨ï¼šä¸€ä¸²åŠ å¯†çš„å­—ç¬¦ä¸²ï¼ŒåŒ…å«ç”¨æˆ·ä¿¡æ¯

ç»“æ„ï¼šHeader.Payload.Signature
      å¤´éƒ¨   è½½è·    ç­¾å
```

**ğŸ”¸ è®¤è¯æµç¨‹**ï¼š

```
ç™»å½•æµç¨‹ï¼š
ç”¨æˆ·ç™»å½• â†’ éªŒè¯è´¦å·å¯†ç  â†’ ç”ŸæˆJWT â†’ è¿”å›ç»™å‰ç«¯
                                      â†“
                            å‰ç«¯å­˜å‚¨åœ¨localStorage

è®¿é—®æ¥å£æµç¨‹ï¼š
å‰ç«¯è¯·æ±‚ â†’ æºå¸¦JWT â†’ åç«¯éªŒè¯JWT â†’ è§£æç”¨æˆ·ä¿¡æ¯ â†’ è¿”å›æ•°æ®
```

**ğŸ”¸ ä¾èµ–é…ç½®**ï¼š

```xml
<dependency>
    <groupId>io.jsonwebtoken</groupId>
    <artifactId>jjwt</artifactId>
    <version>0.9.1</version>
</dependency>
```

**ğŸ”¸ JWTå·¥å…·ç±»**ï¼š

```java
@Component
public class JwtUtil {
    
    @Value("${jwt.secret}")
    private String secret;  // å¯†é’¥
    
    @Value("${jwt.expiration}")
    private Long expiration;  // è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰
    
    // ç”ŸæˆToken
    public String generateToken(Long userId, String username) {
        Date now = new Date();
        Date expiryDate = new Date(now.getTime() + expiration * 1000);
        
        return Jwts.builder()
            .setSubject(String.valueOf(userId))  // ç”¨æˆ·ID
            .claim("username", username)          // è‡ªå®šä¹‰æ•°æ®
            .setIssuedAt(now)                    // ç­¾å‘æ—¶é—´
            .setExpiration(expiryDate)           // è¿‡æœŸæ—¶é—´
            .signWith(SignatureAlgorithm.HS512, secret)  // ç­¾åç®—æ³•
            .compact();
    }
    
    // è§£æTokenè·å–ç”¨æˆ·ID
    public Long getUserIdFromToken(String token) {
        Claims claims = Jwts.parser()
            .setSigningKey(secret)
            .parseClaimsJws(token)
            .getBody();
        return Long.parseLong(claims.getSubject());
    }
    
    // éªŒè¯Tokenæ˜¯å¦æœ‰æ•ˆ
    public boolean validateToken(String token) {
        try {
            Jwts.parser().setSigningKey(secret).parseClaimsJws(token);
            return true;
        } catch (Exception e) {
            return false;
        }
    }
}
```

**ğŸ”¸ ç™»å½•æ¥å£**ï¼š

```java
@PostMapping("/login")
public Result<String> login(@RequestBody LoginDTO loginDTO) {
    
    // 1. éªŒè¯è´¦å·å¯†ç 
    User user = userService.login(loginDTO.getUsername(), loginDTO.getPassword());
    if (user == null) {
        return Result.error(4012, "è´¦å·æˆ–å¯†ç é”™è¯¯");
    }
    
    // 2. ç”ŸæˆToken
    String token = jwtUtil.generateToken(user.getId(), user.getUsername());
    
    // 3. è¿”å›Token
    return Result.success(token);
}
```

**ğŸ”¸ è®¤è¯æ‹¦æˆªå™¨**ï¼š

```java
@Component
public class JwtInterceptor implements HandlerInterceptor {
    
    @Autowired
    private JwtUtil jwtUtil;
    
    @Override
    public boolean preHandle(HttpServletRequest request, 
                            HttpServletResponse response, 
                            Object handler) {
        
        // 1. ä»è¯·æ±‚å¤´è·å–Token
        String token = request.getHeader("Authorization");
        if (token != null && token.startsWith("Bearer ")) {
            token = token.substring(7);
        }
        
        // 2. éªŒè¯Token
        if (token == null || !jwtUtil.validateToken(token)) {
            response.setStatus(401);
            return false;
        }
        
        // 3. è§£æç”¨æˆ·ä¿¡æ¯ï¼Œå­˜å…¥è¯·æ±‚å±æ€§
        Long userId = jwtUtil.getUserIdFromToken(token);
        request.setAttribute("userId", userId);
        
        return true;
    }
}
```

**ğŸ”¸ é…ç½®æ‹¦æˆªå™¨**ï¼š

```java
@Configuration
public class WebConfig implements WebMvcConfigurer {
    
    @Autowired
    private JwtInterceptor jwtInterceptor;
    
    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        registry.addInterceptor(jwtInterceptor)
            .addPathPatterns("/api/**")          // æ‹¦æˆªæ‰€æœ‰æ¥å£
            .excludePathPatterns("/api/login")   // æ’é™¤ç™»å½•æ¥å£
            .excludePathPatterns("/api/register");
    }
}
```

**ğŸ”¸ å‰ç«¯ä½¿ç”¨**ï¼š

```javascript
// ç™»å½•åä¿å­˜Token
axios.post('/api/login', { username, password })
    .then(res => {
        localStorage.setItem('token', res.data.data);
    });

// è¯·æ±‚æ—¶æºå¸¦Token
axios.get('/api/users', {
    headers: {
        'Authorization': 'Bearer ' + localStorage.getItem('token')
    }
});

// æˆ–è€…é…ç½®axiosæ‹¦æˆªå™¨ï¼Œè‡ªåŠ¨æ·»åŠ Token
axios.interceptors.request.use(config => {
    const token = localStorage.getItem('token');
    if (token) {
        config.headers.Authorization = 'Bearer ' + token;
    }
    return config;
});
```

---

## 11. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 11.1 å‰åç«¯äº¤äº’æ ¸å¿ƒçŸ¥è¯†å›¾è°±


```
å‰åç«¯äº¤äº’ä½“ç³»
    â”œâ”€â”€ æ¥å£è®¾è®¡è§„èŒƒ
    â”‚   â”œâ”€â”€ RESTfulé£æ ¼ï¼ˆèµ„æº+HTTPæ–¹æ³•ï¼‰
    â”‚   â”œâ”€â”€ ç»Ÿä¸€å“åº”æ ¼å¼ï¼ˆcode+message+dataï¼‰
    â”‚   â””â”€â”€ é”™è¯¯ç ä½“ç³»ï¼ˆåˆ†ç±»æ¸…æ™°ã€ä¾¿äºå®šä½ï¼‰
    â”‚
    â”œâ”€â”€ æ–‡æ¡£ä¸è°ƒè¯•
    â”‚   â”œâ”€â”€ Swagger/Knife4jï¼ˆè‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£ï¼‰
    â”‚   â””â”€â”€ åœ¨çº¿æµ‹è¯•ï¼ˆæé«˜å¼€å‘æ•ˆç‡ï¼‰
    â”‚
    â”œâ”€â”€ å¸¸è§é—®é¢˜å¤„ç†
    â”‚   â”œâ”€â”€ è·¨åŸŸï¼ˆCORSé…ç½®ï¼‰
    â”‚   â”œâ”€â”€ æ–‡ä»¶ä¸Šä¼ ï¼ˆMultipartFileï¼‰
    â”‚   â””â”€â”€ æ–‡ä»¶ä¸‹è½½ï¼ˆResponseEntityï¼‰
    â”‚
    â”œâ”€â”€ å®æ—¶é€šä¿¡
    â”‚   â”œâ”€â”€ WebSocketï¼ˆåŒå‘é€šä¿¡ï¼‰
    â”‚   â””â”€â”€ SSEï¼ˆå•å‘æ¨é€ï¼‰
    â”‚
    â””â”€â”€ æ¥å£ç®¡ç†
        â”œâ”€â”€ ç‰ˆæœ¬ç®¡ç†ï¼ˆURL/Header/å‚æ•°ï¼‰
        â””â”€â”€ å®‰å…¨è®¤è¯ï¼ˆJWT Tokenï¼‰
```

### 11.2 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒè¦ç‚¹


**ğŸ”¸ RESTfulè®¾è®¡åŸåˆ™**ï¼š
```
âœ… URLè¡¨ç¤ºèµ„æºï¼ˆåè¯ï¼‰ï¼ŒHTTPæ–¹æ³•è¡¨ç¤ºæ“ä½œï¼ˆåŠ¨è¯ï¼‰
âœ… ä½¿ç”¨å¤æ•°å½¢å¼ï¼š/users è€Œä¸æ˜¯ /user
âœ… åˆç†ä½¿ç”¨HTTPçŠ¶æ€ç ï¼š200æˆåŠŸã€404æœªæ‰¾åˆ°ã€500æœåŠ¡å™¨é”™è¯¯
âœ… æŸ¥è¯¢å‚æ•°ç”¨äºç­›é€‰ã€åˆ†é¡µã€æ’åº
```

**ğŸ”¸ ç»Ÿä¸€å“åº”æ ¼å¼**ï¼š
```java
{
    "code": 200,
    "message": "æ“ä½œæˆåŠŸ",
    "data": { ... },
    "timestamp": 1695456789000
}

å¥½å¤„ï¼š
âœ… å‰ç«¯ç»Ÿä¸€å¤„ç†é€»è¾‘
âœ… é”™è¯¯æç¤ºè§„èŒƒ
âœ… ä¾¿äºè°ƒè¯•å’Œå®šä½é—®é¢˜
```

**ğŸ”¸ è·¨åŸŸé—®é¢˜è§£å†³**ï¼š
```
åŸå› ï¼šæµè§ˆå™¨çš„åŒæºç­–ç•¥é™åˆ¶
è§£å†³ï¼šCORSé…ç½®ï¼ˆå…è®¸ç‰¹å®šæ¥æºè®¿é—®ï¼‰
æ³¨æ„ï¼šç”Ÿäº§ç¯å¢ƒä¸è¦ç”¨ allowedOrigins("*")
```

**ğŸ”¸ æ–‡ä»¶ä¸Šä¼ ä¸‹è½½**ï¼š
```
ä¸Šä¼ ï¼šMultipartFileæ¥æ”¶ â†’ æ ¡éªŒ â†’ ç”Ÿæˆå”¯ä¸€æ–‡ä»¶å â†’ ä¿å­˜
ä¸‹è½½ï¼šè¯»å–æ–‡ä»¶ â†’ è®¾ç½®å“åº”å¤´ â†’ å†™å…¥å“åº”æµ
æ³¨æ„ï¼šæ–‡ä»¶å¤§å°é™åˆ¶ã€ç±»å‹æ ¡éªŒã€å­˜å‚¨è·¯å¾„è§„åˆ’
```

**ğŸ”¸ æ¥å£å®‰å…¨**ï¼š
```
JWTè®¤è¯æµç¨‹ï¼š
ç™»å½• â†’ ç”ŸæˆToken â†’ å‰ç«¯å­˜å‚¨ â†’ è¯·æ±‚æºå¸¦Token â†’ åç«¯éªŒè¯

ä¼˜ç‚¹ï¼šæ— çŠ¶æ€ã€å¯æ‰©å±•ã€è·¨åŸŸå‹å¥½
æ³¨æ„ï¼šTokenè¿‡æœŸæ—¶é—´ã€å¯†é’¥å®‰å…¨ã€åˆ·æ–°æœºåˆ¶
```

### 11.3 å®é™…å¼€å‘å»ºè®®


**ğŸ’¡ æ¥å£è®¾è®¡å»ºè®®**ï¼š
```
1. è®¾è®¡å‰å…ˆå®šä¹‰å¥½é”™è¯¯ç ä½“ç³»
2. ä½¿ç”¨Swaggerç”Ÿæˆæ–‡æ¡£ï¼Œå‡å°‘æ²Ÿé€šæˆæœ¬
3. æ¥å£å“åº”æ ¼å¼ä»é¡¹ç›®åˆæœŸå°±ç»Ÿä¸€
4. é‡è¦æ¥å£åšå¥½ç‰ˆæœ¬ç®¡ç†ï¼Œé¿å…ç ´åæ€§å˜æ›´
```

**ğŸ’¡ å®‰å…¨é˜²æŠ¤å»ºè®®**ï¼š
```
1. æ•æ„Ÿæ¥å£å¿…é¡»åšè®¤è¯å’Œæƒé™æ§åˆ¶
2. æ¥å£åšå¥½é™æµï¼Œé˜²æ­¢æ¶æ„åˆ·é‡
3. é‡è¦æ•°æ®ä¼ è¾“ä½¿ç”¨HTTPSåŠ å¯†
4. ä¸è¦åœ¨å‰ç«¯æš´éœ²æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†é’¥ã€Tokenç­‰ï¼‰
```

**ğŸ’¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®**ï¼š
```
1. åˆç†ä½¿ç”¨ç¼“å­˜å‡å°‘æ•°æ®åº“å‹åŠ›
2. å¤§æ–‡ä»¶ä¸Šä¼ è€ƒè™‘åˆ†ç‰‡ä¸Šä¼ 
3. æ¥å£å“åº”æ•°æ®åšåˆ†é¡µï¼Œé¿å…ä¸€æ¬¡è¿”å›è¿‡å¤šæ•°æ®
4. é™æ€èµ„æºä½¿ç”¨CDNåŠ é€Ÿ
```

**ğŸ’¡ å¼€å‘è°ƒè¯•æŠ€å·§**ï¼š
```
1. ä½¿ç”¨Postman/Apifoxæµ‹è¯•æ¥å£
2. æŸ¥çœ‹æµè§ˆå™¨Networké¢æ¿åˆ†æè¯·æ±‚
3. åç«¯æ‰“å°è¯·æ±‚æ—¥å¿—ä¾¿äºå®šä½é—®é¢˜
4. ä½¿ç”¨æ¥å£æ–‡æ¡£å·¥å…·åœ¨çº¿è°ƒè¯•
```

### 11.4 å­¦ä¹ æ£€æŸ¥æ¸…å•


**âœ… åŸºç¡€çŸ¥è¯†æ£€æŸ¥**ï¼š
- [ ] èƒ½è¯´å‡ºRESTfulçš„æ ¸å¿ƒè®¾è®¡åŸåˆ™
- [ ] ç†è§£HTTPæ–¹æ³•çš„ä½¿ç”¨åœºæ™¯
- [ ] èƒ½è®¾è®¡åˆç†çš„URLç»“æ„
- [ ] ç†è§£ç»Ÿä¸€å“åº”æ ¼å¼çš„æ„ä¹‰

**âœ… å®è·µèƒ½åŠ›æ£€æŸ¥**ï¼š
- [ ] èƒ½ç‹¬ç«‹å®ç°CRUDæ¥å£
- [ ] èƒ½å¤„ç†è·¨åŸŸé—®é¢˜
- [ ] èƒ½å®ç°æ–‡ä»¶ä¸Šä¼ ä¸‹è½½
- [ ] èƒ½é›†æˆSwaggerç”Ÿæˆæ¥å£æ–‡æ¡£

**âœ… è¿›é˜¶èƒ½åŠ›æ£€æŸ¥**ï¼š
- [ ] èƒ½è®¾è®¡åˆç†çš„é”™è¯¯ç ä½“ç³»
- [ ] èƒ½å®ç°JWTè®¤è¯æœºåˆ¶
- [ ] èƒ½å®ç°WebSocketå®æ—¶é€šä¿¡
- [ ] èƒ½åšå¥½æ¥å£ç‰ˆæœ¬ç®¡ç†

**ğŸ¯ ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®®**ï¼š
1. æ·±å…¥å­¦ä¹ Spring Securityå®‰å…¨æ¡†æ¶
2. äº†è§£æ¥å£é™æµå’Œé˜²åˆ·æœºåˆ¶
3. å­¦ä¹ æ¥å£ç›‘æ§å’Œæ—¥å¿—åˆ†æ
4. å®è·µå¾®æœåŠ¡æ¶æ„ä¸‹çš„æ¥å£è®¾è®¡

---

**ğŸ”‘ æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
RESTfulè®¾è®¡èµ„æºåŒ–ï¼ŒHTTPæ–¹æ³•è¦ç”¨å¯¹
ç»Ÿä¸€æ ¼å¼å¥½å¤„å¤šï¼Œé”™è¯¯ç è¦åˆ†ç±»æ¸…
è·¨åŸŸé…ç½®CORSæå®š,æ–‡ä»¶ä¸Šä¼ è¦æ ¡éªŒ
Tokenè®¤è¯ä¿å®‰å…¨,æ–‡æ¡£å·¥å…·çœäººåŠ›
ç‰ˆæœ¬ç®¡ç†è¦è§„åˆ’,å®æ—¶æ¨é€ç”¨WebSocket
```