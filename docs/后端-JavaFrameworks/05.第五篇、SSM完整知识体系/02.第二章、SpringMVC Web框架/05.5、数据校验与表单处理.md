---
title: 5ã€æ•°æ®æ ¡éªŒä¸è¡¨å•å¤„ç†
---
## ğŸ“š ç›®å½•

1. [æ•°æ®æ ¡éªŒæ˜¯ä»€ä¹ˆ](#1-æ•°æ®æ ¡éªŒæ˜¯ä»€ä¹ˆ)
2. [JSR303è§„èŒƒè¯¦è§£](#2-JSR303è§„èŒƒè¯¦è§£)
3. [Hibernate Validatoræ¡†æ¶](#3-Hibernate-Validatoræ¡†æ¶)
4. [æ ¡éªŒæ³¨è§£è¯¦è§£](#4-æ ¡éªŒæ³¨è§£è¯¦è§£)
5. [åˆ†ç»„æ ¡éªŒç­–ç•¥](#5-åˆ†ç»„æ ¡éªŒç­–ç•¥)
6. [æ ¡éªŒç»“æœå¤„ç†](#6-æ ¡éªŒç»“æœå¤„ç†)
7. [è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£](#7-è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£)
8. [å®æˆ˜åº”ç”¨åœºæ™¯](#8-å®æˆ˜åº”ç”¨åœºæ™¯)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ æ•°æ®æ ¡éªŒæ˜¯ä»€ä¹ˆ


### 1.1 ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®æ ¡éªŒ


**ç”Ÿæ´»ä¸­çš„ä¾‹å­**ï¼š
```
ä½ åœ¨ç½‘ä¸Šæ³¨å†Œè´¦å·æ—¶ï¼š
â€¢ ç”¨æˆ·åä¸èƒ½ä¸ºç©º â†’ æ•°æ®æ ¡éªŒ
â€¢ å¯†ç è‡³å°‘8ä½ â†’ æ•°æ®æ ¡éªŒ
â€¢ é‚®ç®±æ ¼å¼å¿…é¡»æ­£ç¡® â†’ æ•°æ®æ ¡éªŒ
â€¢ å¹´é¾„å¿…é¡»18-100å² â†’ æ•°æ®æ ¡éªŒ

è¿™äº›æ£€æŸ¥å°±æ˜¯"æ•°æ®æ ¡éªŒ"
```

> ğŸ’¡ **æ ¸å¿ƒæ¦‚å¿µ**
>
> æ•°æ®æ ¡éªŒå°±æ˜¯æ£€æŸ¥ç”¨æˆ·è¾“å…¥çš„æ•°æ®æ˜¯å¦ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚
> 
> **ä½œç”¨**ï¼šé˜²æ­¢è„æ•°æ®è¿›å…¥ç³»ç»Ÿï¼Œä¿è¯æ•°æ®è´¨é‡

### 1.2 ä¼ ç»Ÿæ ¡éªŒçš„ç—›ç‚¹


**æ²¡æœ‰æ ¡éªŒæ¡†æ¶ä¹‹å‰çš„åšæ³•**ï¼š

```java
// âŒ ä¼ ç»Ÿå†™æ³•ï¼šä»£ç åˆè‡­åˆé•¿
@PostMapping("/register")
public String register(User user) {
    // æ£€æŸ¥ç”¨æˆ·å
    if (user.getName() == null || user.getName().isEmpty()) {
        return "ç”¨æˆ·åä¸èƒ½ä¸ºç©º";
    }
    if (user.getName().length() < 3 || user.getName().length() > 20) {
        return "ç”¨æˆ·åé•¿åº¦3-20ä½";
    }
    
    // æ£€æŸ¥å¹´é¾„
    if (user.getAge() == null) {
        return "å¹´é¾„ä¸èƒ½ä¸ºç©º";
    }
    if (user.getAge() < 18 || user.getAge() > 100) {
        return "å¹´é¾„å¿…é¡»18-100å²";
    }
    
    // æ£€æŸ¥é‚®ç®±...
    // è¿˜æœ‰åå‡ ä¸ªå­—æ®µè¦æ£€æŸ¥...
    // ä»£ç å¤ªå¤šäº†ï¼
}
```

**é—®é¢˜åœ¨å“ª**ï¼š
- ğŸ”¸ ä»£ç é‡å¤ï¼Œæ¯ä¸ªæ¥å£éƒ½è¦å†™
- ğŸ”¸ ç»´æŠ¤å›°éš¾ï¼Œæ”¹è§„åˆ™è¦åˆ°å¤„æ”¹
- ğŸ”¸ å®¹æ˜“é—æ¼ï¼Œå¿˜è®°æ£€æŸ¥æŸä¸ªå­—æ®µ
- ğŸ”¸ ä»£ç è‡ƒè‚¿ï¼Œçœ‹èµ·æ¥å¾ˆä¹±

### 1.3 ä½¿ç”¨æ ¡éªŒæ¡†æ¶åçš„ä¼˜é›…å†™æ³•


```java
// âœ… ä½¿ç”¨æ ¡éªŒæ¡†æ¶ï¼šç®€æ´ä¼˜é›…
public class User {
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @Size(min = 3, max = 20, message = "ç”¨æˆ·åé•¿åº¦3-20ä½")
    private String name;
    
    @NotNull(message = "å¹´é¾„ä¸èƒ½ä¸ºç©º")
    @Min(value = 18, message = "å¹´é¾„æœ€å°18å²")
    @Max(value = 100, message = "å¹´é¾„æœ€å¤§100å²")
    private Integer age;
    
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String email;
}

@PostMapping("/register")
public String register(@Valid User user, BindingResult result) {
    if (result.hasErrors()) {
        return "æ ¡éªŒå¤±è´¥";
    }
    // æ ¡éªŒé€šè¿‡ï¼Œå¤„ç†ä¸šåŠ¡é€»è¾‘
}
```

**ä¼˜åŠ¿**ï¼š
- âœ… è§„åˆ™å†™åœ¨å®ä½“ç±»ä¸Šï¼Œä¸€ç›®äº†ç„¶
- âœ… æ³¨è§£è‡ªåŠ¨æ ¡éªŒï¼Œä¸ç”¨å†™ifåˆ¤æ–­
- âœ… ç»Ÿä¸€ç®¡ç†ï¼Œä¿®æ”¹æ–¹ä¾¿
- âœ… ä»£ç ç®€æ´ï¼Œé€»è¾‘æ¸…æ™°

---

## 2. ğŸ“‹ JSR303è§„èŒƒè¯¦è§£


### 2.1 ä»€ä¹ˆæ˜¯JSR303


> ğŸ’¡ **é€šä¿—è§£é‡Š**
>
> JSR303å°±æ˜¯Javaå®˜æ–¹åˆ¶å®šçš„"æ•°æ®æ ¡éªŒæ ‡å‡†"
> 
> å°±åƒå›½å®¶åˆ¶å®šçš„"äº§å“è´¨é‡æ ‡å‡†"ä¸€æ ·ï¼Œå¤§å®¶éƒ½æŒ‰è¿™ä¸ªæ ‡å‡†æ¥åš

**JSRæ˜¯ä»€ä¹ˆ**ï¼š
```
JSR = Java Specification Requestï¼ˆJavaè§„èŒƒææ¡ˆï¼‰
JSR303 = ç¬¬303å·Javaè§„èŒƒï¼Œä¸“é—¨å®šä¹‰æ•°æ®æ ¡éªŒæ ‡å‡†

æ¯”å¦‚ï¼š
JSR303è§„å®šäº† â†’ @NotNull æ³¨è§£çš„ä½œç”¨
         â†’ @Size æ³¨è§£çš„ç”¨æ³•
         â†’ æ ¡éªŒå¤±è´¥æ—¶è¯¥è¿”å›ä»€ä¹ˆä¿¡æ¯
```

### 2.2 JSR303çš„æ ¸å¿ƒå†…å®¹


**è§„èŒƒå®šä¹‰äº†ä¸‰å¤§å†…å®¹**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. æ ‡å‡†æ ¡éªŒæ³¨è§£                 â”‚
â”‚     @NotNull, @Size, @Min...    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2. æ ¡éªŒæ¥å£è§„èŒƒ                 â”‚
â”‚     Validator, ConstraintViolationâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  3. é”™è¯¯ä¿¡æ¯æ ‡å‡†                 â”‚
â”‚     ValidationMessages.propertiesâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¸¸ç”¨æ ‡å‡†æ³¨è§£**ï¼š

| æ³¨è§£ | ä½œç”¨ | é€‚ç”¨ç±»å‹ |
|------|------|---------|
| `@NotNull` | ä¸èƒ½ä¸ºnull | ä»»ä½•ç±»å‹ |
| `@Size` | é•¿åº¦/å¤§å°é™åˆ¶ | å­—ç¬¦ä¸²ã€é›†åˆã€æ•°ç»„ |
| `@Min` | æœ€å°å€¼ | æ•°å­—ç±»å‹ |
| `@Max` | æœ€å¤§å€¼ | æ•°å­—ç±»å‹ |
| `@Pattern` | æ­£åˆ™è¡¨è¾¾å¼ | å­—ç¬¦ä¸² |

### 2.3 JSR303ä¸å®ç°çš„å…³ç³»


```
           JSR303è§„èŒƒï¼ˆæ¥å£æ ‡å‡†ï¼‰
                   â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â†“                             â†“
Hibernate Validator          Apache BVal
ï¼ˆæœ€å¸¸ç”¨çš„å®ç°ï¼‰              ï¼ˆå¦ä¸€ç§å®ç°ï¼‰
```

> ğŸ“Œ **ç±»æ¯”ç†è§£**
>
> - JSR303 = USBæ¥å£æ ‡å‡†ï¼ˆè§„å®šäº†å½¢çŠ¶ã€ç”µå‹ã€åè®®ï¼‰
> - Hibernate Validator = æŸå“ç‰Œçš„USBè®¾å¤‡ï¼ˆæŒ‰æ ‡å‡†å®ç°ï¼‰
> - ä½ çš„ä»£ç  = ç”µè„‘ï¼ˆæ’ä¸Šå°±èƒ½ç”¨ï¼‰

---

## 3. ğŸ”§ Hibernate Validatoræ¡†æ¶


### 3.1 ä»€ä¹ˆæ˜¯Hibernate Validator


> ğŸ’¡ **æ ¸å¿ƒæ¦‚å¿µ**
>
> Hibernate Validatoræ˜¯JSR303è§„èŒƒæœ€æµè¡Œçš„å®ç°æ¡†æ¶
> 
> å®ƒä¸ä»…å®ç°äº†æ ‡å‡†æ³¨è§£ï¼Œè¿˜æ‰©å±•äº†å¾ˆå¤šå®ç”¨åŠŸèƒ½

**ä¸ºä»€ä¹ˆé€‰å®ƒ**ï¼š
- â­ åŠŸèƒ½æœ€å®Œå–„ï¼Œæ³¨è§£æœ€ä¸°å¯Œ
- â­ Springé»˜è®¤é›†æˆï¼Œå¼€ç®±å³ç”¨
- â­ æ€§èƒ½ä¼˜ç§€ï¼Œç¨³å®šå¯é 
- â­ ç¤¾åŒºæ´»è·ƒï¼Œæ–‡æ¡£é½å…¨

### 3.2 å¿«é€Ÿä¸Šæ‰‹é…ç½®


**ç¬¬ä¸€æ­¥ï¼šæ·»åŠ ä¾èµ–**

```xml
<!-- SpringBooté¡¹ç›®è‡ªåŠ¨åŒ…å«ï¼Œæ— éœ€æ‰‹åŠ¨æ·»åŠ  -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-validation</artifactId>
</dependency>

<!-- éSpringBooté¡¹ç›®éœ€è¦æ‰‹åŠ¨æ·»åŠ  -->
<dependency>
    <groupId>org.hibernate.validator</groupId>
    <artifactId>hibernate-validator</artifactId>
    <version>6.2.0.Final</version>
</dependency>
```

**ç¬¬äºŒæ­¥ï¼šå®ä½“ç±»æ·»åŠ æ³¨è§£**

```java
public class User {
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    private String username;
    
    @NotNull(message = "å¹´é¾„ä¸èƒ½ä¸ºç©º")
    private Integer age;
}
```

**ç¬¬ä¸‰æ­¥ï¼šæ§åˆ¶å™¨å¯ç”¨æ ¡éªŒ**

```java
@PostMapping("/save")
public String save(@Valid User user) {
    // @Validæ³¨è§£å¯ç”¨æ ¡éªŒ
    return "success";
}
```

### 3.3 Hibernate Validatoræ‰©å±•æ³¨è§£


**é™¤äº†æ ‡å‡†æ³¨è§£ï¼Œè¿˜æä¾›äº†**ï¼š

| æ‰©å±•æ³¨è§£ | ä½œç”¨ | ç¤ºä¾‹ |
|---------|------|------|
| `@Email` | é‚®ç®±æ ¼å¼ | `user@example.com` |
| `@URL` | ç½‘å€æ ¼å¼ | `https://www.baidu.com` |
| `@CreditCardNumber` | ä¿¡ç”¨å¡å· | `4111111111111111` |
| `@Length` | å­—ç¬¦ä¸²é•¿åº¦ | `@Length(min=3, max=10)` |
| `@Range` | æ•°å€¼èŒƒå›´ | `@Range(min=1, max=100)` |

---

## 4. ğŸ“ æ ¡éªŒæ³¨è§£è¯¦è§£


### 4.1 éç©ºæ ¡éªŒä¸‰å…„å¼Ÿ


**@NotNullã€@NotEmptyã€@NotBlankçš„åŒºåˆ«**ï¼š

```java
// æµ‹è¯•æ•°æ®
String str1 = null;        // nullå€¼
String str2 = "";          // ç©ºå­—ç¬¦ä¸²
String str3 = "   ";       // ç©ºç™½å­—ç¬¦ä¸²
String str4 = "hello";     // æ­£å¸¸å€¼

// @NotNullï¼šåªæ£€æŸ¥æ˜¯å¦ä¸ºnull
@NotNull
private String field;
// âœ… str2ã€str3ã€str4 é€šè¿‡
// âŒ str1 ä¸é€šè¿‡

// @NotEmptyï¼šæ£€æŸ¥nullå’Œç©ºå­—ç¬¦ä¸²
@NotEmpty
private String field;
// âœ… str3ã€str4 é€šè¿‡
// âŒ str1ã€str2 ä¸é€šè¿‡

// @NotBlankï¼šæ£€æŸ¥nullã€ç©ºå­—ç¬¦ä¸²ã€ç©ºç™½å­—ç¬¦ä¸²
@NotBlank
private String field;
// âœ… str4 é€šè¿‡
// âŒ str1ã€str2ã€str3 ä¸é€šè¿‡
```

> ğŸ¯ **é€‰æ‹©å»ºè®®**
>
> - **æ™®é€šå¯¹è±¡** â†’ ç”¨ `@NotNull`
> - **é›†åˆ/æ•°ç»„** â†’ ç”¨ `@NotEmpty`
> - **å­—ç¬¦ä¸²** â†’ ç”¨ `@NotBlank`ï¼ˆæœ€ä¸¥æ ¼ï¼‰

**å®æˆ˜ç¤ºä¾‹**ï¼š

```java
public class User {
    // ç”¨æˆ·åï¼šå­—ç¬¦ä¸²ç”¨@NotBlank
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    private String username;
    
    // ç”Ÿæ—¥ï¼šæ—¥æœŸç”¨@NotNull
    @NotNull(message = "ç”Ÿæ—¥ä¸èƒ½ä¸ºç©º")
    private Date birthday;
    
    // çˆ±å¥½ï¼šé›†åˆç”¨@NotEmpty
    @NotEmpty(message = "è‡³å°‘é€‰æ‹©ä¸€ä¸ªçˆ±å¥½")
    private List<String> hobbies;
}
```

### 4.2 é•¿åº¦å’Œå¤§å°æ ¡éªŒ


**@Sizeæ³¨è§£è¯¦è§£**ï¼š

```java
public class Product {
    // å­—ç¬¦ä¸²é•¿åº¦
    @Size(min = 3, max = 20, message = "å•†å“åç§°3-20ä¸ªå­—ç¬¦")
    private String name;
    
    // é›†åˆå¤§å°
    @Size(min = 1, max = 5, message = "æœ€å¤šé€‰æ‹©5å¼ å›¾ç‰‡")
    private List<String> images;
    
    // æ•°ç»„å¤§å°
    @Size(min = 1, message = "è‡³å°‘é€‰æ‹©ä¸€ä¸ªåˆ†ç±»")
    private String[] categories;
}
```

**é€‚ç”¨åœºæ™¯å¯¹ç…§è¡¨**ï¼š

| æ•°æ®ç±»å‹ | æ£€æŸ¥å†…å®¹ | ç¤ºä¾‹ |
|---------|---------|------|
| `String` | å­—ç¬¦ä¸²é•¿åº¦ | `@Size(min=3, max=10)` |
| `List/Set` | é›†åˆå…ƒç´ ä¸ªæ•° | `@Size(min=1, max=5)` |
| `æ•°ç»„` | æ•°ç»„å…ƒç´ ä¸ªæ•° | `@Size(min=1)` |
| `Map` | Mapé”®å€¼å¯¹ä¸ªæ•° | `@Size(max=10)` |

### 4.3 æ•°å€¼èŒƒå›´æ ¡éªŒ


**@Minå’Œ@Maxæ³¨è§£**ï¼š

```java
public class Order {
    // å¹´é¾„é™åˆ¶
    @Min(value = 18, message = "å¿…é¡»å¹´æ»¡18å²")
    @Max(value = 100, message = "å¹´é¾„ä¸èƒ½è¶…è¿‡100å²")
    private Integer age;
    
    // å•†å“æ•°é‡
    @Min(value = 1, message = "è‡³å°‘è´­ä¹°1ä»¶")
    @Max(value = 999, message = "æœ€å¤šè´­ä¹°999ä»¶")
    private Integer quantity;
    
    // ä»·æ ¼èŒƒå›´
    @Min(value = 0, message = "ä»·æ ¼ä¸èƒ½ä¸ºè´Ÿæ•°")
    private BigDecimal price;
}
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**
>
> - `@Min`/`@Max` åªèƒ½ç”¨äºæ•°å€¼ç±»å‹
> - æ”¯æŒï¼šIntegerã€Longã€BigDecimalç­‰
> - ä¸æ”¯æŒï¼šStringã€Dateç­‰

### 4.4 æ­£åˆ™è¡¨è¾¾å¼æ ¡éªŒ


**@Patternæ³¨è§£è¯¦è§£**ï¼š

```java
public class UserForm {
    // æ‰‹æœºå·æ ¡éªŒ
    @Pattern(regexp = "^1[3-9]\\d{9}$", 
             message = "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®")
    private String phone;
    
    // èº«ä»½è¯å·æ ¡éªŒ
    @Pattern(regexp = "^[1-9]\\d{5}(18|19|20)\\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\\d|3[01])\\d{3}[0-9Xx]$",
             message = "èº«ä»½è¯å·æ ¼å¼ä¸æ­£ç¡®")
    private String idCard;
    
    // é‚®æ”¿ç¼–ç 
    @Pattern(regexp = "^\\d{6}$", 
             message = "é‚®æ”¿ç¼–ç å¿…é¡»æ˜¯6ä½æ•°å­—")
    private String zipCode;
}
```

**å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼é€ŸæŸ¥**ï¼š

| æ ¡éªŒå†…å®¹ | æ­£åˆ™è¡¨è¾¾å¼ | è¯´æ˜ |
|---------|-----------|------|
| æ‰‹æœºå· | `^1[3-9]\d{9}$` | 1å¼€å¤´11ä½æ•°å­— |
| é‚®ç®± | `^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$` | æ ‡å‡†é‚®ç®±æ ¼å¼ |
| ç”¨æˆ·å | `^[a-zA-Z0-9_]{3,16}$` | å­—æ¯æ•°å­—ä¸‹åˆ’çº¿3-16ä½ |
| å¯†ç  | `^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$` | è‡³å°‘8ä½å«å¤§å°å†™å’Œæ•°å­— |

### 4.5 é‚®ç®±æ ¡éªŒ


**@Emailæ³¨è§£ä½¿ç”¨**ï¼š

```java
public class Contact {
    // åŸºæœ¬ç”¨æ³•
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String email;
    
    // è‡ªå®šä¹‰æ­£åˆ™ï¼ˆæ›´ä¸¥æ ¼ï¼‰
    @Email(regexp = "^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\\.[a-zA-Z0-9_-]+)+$",
           message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String strictEmail;
}
```

> ğŸ’¡ **@Email vs @Pattern**
>
> - `@Email`ï¼šä¸“é—¨æ ¡éªŒé‚®ç®±ï¼Œè¯­ä¹‰æ¸…æ™°
> - `@Pattern`ï¼šé€šç”¨æ­£åˆ™ï¼Œæ›´çµæ´»
> - å»ºè®®ï¼šé‚®ç®±ç”¨`@Email`ï¼Œå…¶ä»–ç”¨`@Pattern`

---

## 5. ğŸ¯ æ ¡éªŒæ³¨è§£è¯¦ç»†ä½¿ç”¨


### 5.1 @Validå’Œ@Validatedçš„åŒºåˆ«


**ä¸¤ä¸ªæ³¨è§£çš„å¯¹æ¯”**ï¼š

```
@Validï¼ˆæ ‡å‡†JSR303æ³¨è§£ï¼‰
    â†“
â€¢ æ¥è‡ªjavax.validationåŒ…
â€¢ æ”¯æŒåµŒå¥—æ ¡éªŒ
â€¢ ä¸æ”¯æŒåˆ†ç»„æ ¡éªŒ
â€¢ ç”¨åœ¨æ–¹æ³•å‚æ•°ã€å­—æ®µä¸Š

@Validatedï¼ˆSpringæ‰©å±•æ³¨è§£ï¼‰
    â†“
â€¢ æ¥è‡ªSpringæ¡†æ¶
â€¢ æ”¯æŒåˆ†ç»„æ ¡éªŒ
â€¢ ä¸æ”¯æŒåµŒå¥—æ ¡éªŒï¼ˆéœ€é…åˆ@Validï¼‰
â€¢ ç”¨åœ¨ç±»ã€æ–¹æ³•å‚æ•°ä¸Š
```

**å®æˆ˜ç¤ºä¾‹**ï¼š

```java
// @Validï¼šé€‚åˆåµŒå¥—å¯¹è±¡æ ¡éªŒ
public class User {
    @NotBlank
    private String name;
    
    @Valid  // åµŒå¥—æ ¡éªŒ
    private Address address;
}

// @Validatedï¼šé€‚åˆåˆ†ç»„æ ¡éªŒ
@PostMapping("/save")
public String save(@Validated(AddGroup.class) User user) {
    // åªæ ¡éªŒAddGroupåˆ†ç»„çš„è§„åˆ™
}
```

> ğŸ¯ **é€‰æ‹©å»ºè®®**
>
> - æœ‰åµŒå¥—å¯¹è±¡ â†’ ç”¨ `@Valid`
> - éœ€è¦åˆ†ç»„ â†’ ç”¨ `@Validated`
> - ä¸¤è€…ç»“åˆ â†’ `@Validated` + `@Valid`åµŒå¥—

### 5.2 BindingResultç»“æœç»‘å®š


**ä»€ä¹ˆæ˜¯BindingResult**ï¼š

> ğŸ’¡ **æ ¸å¿ƒæ¦‚å¿µ**
>
> BindingResultæ˜¯Springæä¾›çš„æ ¡éªŒç»“æœå®¹å™¨
> 
> å®ƒä¼šè‡ªåŠ¨æ¥æ”¶æ ¡éªŒå¤±è´¥çš„æ‰€æœ‰é”™è¯¯ä¿¡æ¯

**åŸºæœ¬ç”¨æ³•**ï¼š

```java
@PostMapping("/register")
public String register(@Valid User user, BindingResult result) {
    
    // 1. æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯
    if (result.hasErrors()) {
        
        // 2. è·å–æ‰€æœ‰é”™è¯¯ä¿¡æ¯
        List<FieldError> errors = result.getFieldErrors();
        
        // 3. éå†é”™è¯¯
        for (FieldError error : errors) {
            System.out.println(error.getField() + ": " + error.getDefaultMessage());
        }
        
        return "error";
    }
    
    // æ ¡éªŒé€šè¿‡ï¼Œå¤„ç†ä¸šåŠ¡
    return "success";
}
```

**è·å–é”™è¯¯çš„å¤šç§æ–¹å¼**ï¼š

```java
// æ–¹å¼1: è·å–æ‰€æœ‰å­—æ®µé”™è¯¯
List<FieldError> fieldErrors = result.getFieldErrors();

// æ–¹å¼2: è·å–ç‰¹å®šå­—æ®µé”™è¯¯
FieldError nameError = result.getFieldError("name");

// æ–¹å¼3: è·å–æ‰€æœ‰é”™è¯¯ï¼ˆåŒ…æ‹¬å…¨å±€é”™è¯¯ï¼‰
List<ObjectError> allErrors = result.getAllErrors();

// æ–¹å¼4: è·å–é”™è¯¯æ•°é‡
int errorCount = result.getErrorCount();
```

> âš ï¸ **é‡è¦è§„åˆ™**
>
> BindingResultå¿…é¡»ç´§è·Ÿåœ¨@Validå‚æ•°åé¢
>
> ```java
> // âœ… æ­£ç¡®å†™æ³•
> public String method(@Valid User user, BindingResult result)
> 
> // âŒ é”™è¯¯å†™æ³•
> public String method(@Valid User user, String name, BindingResult result)
> ```

### 5.3 ä¼˜é›…çš„é”™è¯¯å¤„ç†æ–¹å¼


**æ–¹å¼ä¸€ï¼šè¿”å›ç»Ÿä¸€é”™è¯¯æ ¼å¼**

```java
@PostMapping("/save")
public Result save(@Valid User user, BindingResult result) {
    if (result.hasErrors()) {
        // æå–æ‰€æœ‰é”™è¯¯ä¿¡æ¯
        Map<String, String> errors = new HashMap<>();
        result.getFieldErrors().forEach(error -> {
            errors.put(error.getField(), error.getDefaultMessage());
        });
        
        return Result.error("æ ¡éªŒå¤±è´¥", errors);
    }
    
    return Result.success();
}
```

**æ–¹å¼äºŒï¼šåªè¿”å›ç¬¬ä¸€ä¸ªé”™è¯¯**

```java
@PostMapping("/save")
public Result save(@Valid User user, BindingResult result) {
    if (result.hasErrors()) {
        String errorMsg = result.getFieldError().getDefaultMessage();
        return Result.error(errorMsg);
    }
    
    return Result.success();
}
```

**æ–¹å¼ä¸‰ï¼šå…¨å±€å¼‚å¸¸å¤„ç†ï¼ˆæ¨èï¼‰**

```java
@RestControllerAdvice
public class GlobalExceptionHandler {
    
    @ExceptionHandler(MethodArgumentNotValidException.class)
    public Result handleValidException(MethodArgumentNotValidException e) {
        BindingResult result = e.getBindingResult();
        
        Map<String, String> errors = new HashMap<>();
        result.getFieldErrors().forEach(error -> {
            errors.put(error.getField(), error.getDefaultMessage());
        });
        
        return Result.error("å‚æ•°æ ¡éªŒå¤±è´¥", errors);
    }
}

// æ§åˆ¶å™¨ç®€åŒ–ä¸ºï¼š
@PostMapping("/save")
public Result save(@Valid User user) {
    // ä¸ç”¨å†™BindingResultï¼Œå¼‚å¸¸è‡ªåŠ¨å¤„ç†
    return Result.success();
}
```

---

## 6. ğŸ”„ åˆ†ç»„æ ¡éªŒç­–ç•¥


### 6.1 ä¸ºä»€ä¹ˆéœ€è¦åˆ†ç»„æ ¡éªŒ


**å®é™…åœºæ™¯**ï¼š

```
ç”¨æˆ·æ³¨å†Œæ—¶ï¼š
â€¢ ç”¨æˆ·åå¿…å¡«
â€¢ å¯†ç å¿…å¡«
â€¢ é‚®ç®±å¿…å¡«

ç”¨æˆ·æ›´æ–°èµ„æ–™æ—¶ï¼š
â€¢ ç”¨æˆ·IDå¿…å¡«ï¼ˆæ³¨å†Œæ—¶æ²¡æœ‰ï¼‰
â€¢ ç”¨æˆ·åé€‰å¡«ï¼ˆå…è®¸ä¸æ”¹ï¼‰
â€¢ é‚®ç®±é€‰å¡«

åŒä¸€ä¸ªUserå®ä½“ï¼Œä¸åŒåœºæ™¯è§„åˆ™ä¸åŒï¼
```

> ğŸ’¡ **æ ¸å¿ƒæ¦‚å¿µ**
>
> åˆ†ç»„æ ¡éªŒå°±æ˜¯ï¼šåŒä¸€ä¸ªå­—æ®µï¼Œåœ¨ä¸åŒåœºæ™¯ä¸‹åº”ç”¨ä¸åŒçš„æ ¡éªŒè§„åˆ™

### 6.2 å®šä¹‰æ ¡éªŒåˆ†ç»„


**ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºåˆ†ç»„æ¥å£**

```java
// å®šä¹‰åˆ†ç»„æ¥å£ï¼ˆç©ºæ¥å£å³å¯ï¼‰
public interface AddGroup { }      // æ·»åŠ åˆ†ç»„
public interface UpdateGroup { }   // æ›´æ–°åˆ†ç»„
public interface DeleteGroup { }   // åˆ é™¤åˆ†ç»„
```

**ç¬¬äºŒæ­¥ï¼šå®ä½“ç±»æŒ‡å®šåˆ†ç»„**

```java
public class User {
    // idï¼šåªåœ¨æ›´æ–°æ—¶å¿…å¡«
    @NotNull(message = "ç”¨æˆ·IDä¸èƒ½ä¸ºç©º", groups = {UpdateGroup.class})
    private Long id;
    
    // ç”¨æˆ·åï¼šæ·»åŠ å’Œæ›´æ–°éƒ½å¿…å¡«
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º", groups = {AddGroup.class, UpdateGroup.class})
    private String username;
    
    // å¯†ç ï¼šåªåœ¨æ·»åŠ æ—¶å¿…å¡«
    @NotBlank(message = "å¯†ç ä¸èƒ½ä¸ºç©º", groups = {AddGroup.class})
    private String password;
    
    // é‚®ç®±ï¼šæ·»åŠ æ—¶å¿…å¡«ï¼Œæ›´æ–°æ—¶é€‰å¡«
    @NotBlank(message = "é‚®ç®±ä¸èƒ½ä¸ºç©º", groups = {AddGroup.class})
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®", groups = {AddGroup.class, UpdateGroup.class})
    private String email;
}
```

**ç¬¬ä¸‰æ­¥ï¼šæ§åˆ¶å™¨åº”ç”¨åˆ†ç»„**

```java
// æ·»åŠ ç”¨æˆ·ï¼šä½¿ç”¨AddGroupæ ¡éªŒ
@PostMapping("/add")
public Result add(@Validated(AddGroup.class) User user) {
    // åªæ ¡éªŒAddGroupåˆ†ç»„çš„è§„åˆ™
    return Result.success();
}

// æ›´æ–°ç”¨æˆ·ï¼šä½¿ç”¨UpdateGroupæ ¡éªŒ
@PostMapping("/update")
public Result update(@Validated(UpdateGroup.class) User user) {
    // åªæ ¡éªŒUpdateGroupåˆ†ç»„çš„è§„åˆ™
    return Result.success();
}
```

### 6.3 åˆ†ç»„æ ¡éªŒæ‰§è¡Œæµç¨‹


```
å®¢æˆ·ç«¯è¯·æ±‚
    â†“
@Validated(AddGroup.class)
    â†“
æ‰«æUserç±»ä¸­æ‰€æœ‰å­—æ®µ
    â†“
åªæ ¡éªŒgroupsåŒ…å«AddGroupçš„æ³¨è§£
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ @NotNull(groups={UpdateGroup})  â”‚ â†’ è·³è¿‡
â”‚ @NotBlank(groups={AddGroup})    â”‚ â†’ æ ¡éªŒ âœ“
â”‚ @Email(groups={AddGroup})       â”‚ â†’ æ ¡éªŒ âœ“
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
è¿”å›æ ¡éªŒç»“æœ
```

### 6.4 é«˜çº§åˆ†ç»„æŠ€å·§


**åˆ†ç»„ç»§æ‰¿**ï¼š

```java
// å®šä¹‰åŸºç¡€åˆ†ç»„
public interface BaseGroup { }

// ç»§æ‰¿åˆ†ç»„
public interface AddGroup extends BaseGroup { }
public interface UpdateGroup extends BaseGroup { }

// ä½¿ç”¨
public class User {
    // åœ¨æ‰€æœ‰ç»§æ‰¿BaseGroupçš„åˆ†ç»„ä¸­éƒ½ç”Ÿæ•ˆ
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º", groups = {BaseGroup.class})
    private String username;
}
```

**é»˜è®¤åˆ†ç»„**ï¼š

```java
public class User {
    // ä¸æŒ‡å®šgroupsï¼Œå±äºDefaultåˆ†ç»„
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    private String username;
    
    // æŒ‡å®šåˆ†ç»„åï¼Œä¸å†å±äºDefaultåˆ†ç»„
    @NotBlank(message = "å¯†ç ä¸èƒ½ä¸ºç©º", groups = {AddGroup.class})
    private String password;
}

// ä½¿ç”¨Defaultåˆ†ç»„
@PostMapping("/save")
public Result save(@Validated User user) {
    // ç­‰åŒäº @Validated(Default.class)
    // åªæ ¡éªŒæ²¡æœ‰æŒ‡å®šgroupsçš„å­—æ®µ
}
```

---

## 7. ğŸ› ï¸ è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£


### 7.1 ä¸ºä»€ä¹ˆéœ€è¦è‡ªå®šä¹‰


**åœºæ™¯ç¤ºä¾‹**ï¼š

```
ä¸šåŠ¡éœ€æ±‚ï¼š
â€¢ æ ¡éªŒæ‰‹æœºå·æ˜¯å¦å·²æ³¨å†Œ
â€¢ æ ¡éªŒç”¨æˆ·åæ˜¯å¦åŒ…å«æ•æ„Ÿè¯
â€¢ æ ¡éªŒè®¢å•çŠ¶æ€æ˜¯å¦å¯ä»¥ä¿®æ”¹

è¿™äº›è§„åˆ™ï¼š
âŒ æ ‡å‡†æ³¨è§£åšä¸åˆ°ï¼ˆéœ€è¦æŸ¥æ•°æ®åº“ï¼‰
âŒ @Patternæ­£åˆ™è§£å†³ä¸äº†ï¼ˆéœ€è¦ä¸šåŠ¡é€»è¾‘ï¼‰
âœ… éœ€è¦è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£
```

### 7.2 åˆ›å»ºè‡ªå®šä¹‰æ³¨è§£ä¸‰æ­¥éª¤


**ç¬¬ä¸€æ­¥ï¼šå®šä¹‰æ³¨è§£**

```java
@Target({ElementType.FIELD, ElementType.PARAMETER})  // ç”¨åœ¨å“ª
@Retention(RetentionPolicy.RUNTIME)                   // ä½•æ—¶ç”Ÿæ•ˆ
@Constraint(validatedBy = PhoneValidator.class)       // æ ¡éªŒå™¨æ˜¯è°
public @interface Phone {
    
    // é”™è¯¯æç¤ºä¿¡æ¯
    String message() default "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®";
    
    // åˆ†ç»„
    Class<?>[] groups() default {};
    
    // è´Ÿè½½ï¼ˆäº†è§£å³å¯ï¼‰
    Class<? extends Payload>[] payload() default {};
}
```

**ç¬¬äºŒæ­¥ï¼šå®ç°æ ¡éªŒå™¨**

```java
public class PhoneValidator implements ConstraintValidator<Phone, String> {
    
    // åˆå§‹åŒ–æ–¹æ³•ï¼ˆå¯ä»¥è·å–æ³¨è§£å‚æ•°ï¼‰
    @Override
    public void initialize(Phone phone) {
        // å¯ä»¥åœ¨è¿™é‡Œè·å–æ³¨è§£çš„é…ç½®
    }
    
    // æ ¡éªŒé€»è¾‘
    @Override
    public boolean isValid(String value, ConstraintValidatorContext context) {
        // valueå°±æ˜¯è¦æ ¡éªŒçš„å­—æ®µå€¼
        
        // å…è®¸ä¸ºç©ºï¼ˆç©ºå€¼äº¤ç»™@NotBlankå¤„ç†ï¼‰
        if (value == null || value.isEmpty()) {
            return true;
        }
        
        // æ‰‹æœºå·æ­£åˆ™æ ¡éªŒ
        String regex = "^1[3-9]\\d{9}$";
        return value.matches(regex);
    }
}
```

**ç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨æ³¨è§£**

```java
public class User {
    @Phone(message = "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®")
    private String phone;
}
```

### 7.3 å¸¦å‚æ•°çš„è‡ªå®šä¹‰æ³¨è§£


**å®šä¹‰å¯é…ç½®çš„æ³¨è§£**ï¼š

```java
@Constraint(validatedBy = SensitiveWordValidator.class)
public @interface NoSensitiveWord {
    
    String message() default "åŒ…å«æ•æ„Ÿè¯";
    
    // è‡ªå®šä¹‰å‚æ•°ï¼šæ•æ„Ÿè¯åˆ—è¡¨
    String[] words() default {};
    
    Class<?>[] groups() default {};
    Class<? extends Payload>[] payload() default {};
}
```

**å®ç°æ ¡éªŒå™¨**ï¼š

```java
public class SensitiveWordValidator 
    implements ConstraintValidator<NoSensitiveWord, String> {
    
    private String[] sensitiveWords;
    
    @Override
    public void initialize(NoSensitiveWord annotation) {
        // è·å–æ³¨è§£å‚æ•°
        this.sensitiveWords = annotation.words();
    }
    
    @Override
    public boolean isValid(String value, ConstraintValidatorContext context) {
        if (value == null) {
            return true;
        }
        
        // æ£€æŸ¥æ˜¯å¦åŒ…å«æ•æ„Ÿè¯
        for (String word : sensitiveWords) {
            if (value.contains(word)) {
                return false;
            }
        }
        
        return true;
    }
}
```

**ä½¿ç”¨å¸¦å‚æ•°çš„æ³¨è§£**ï¼š

```java
public class Comment {
    @NoSensitiveWord(
        words = {"å¹¿å‘Š", "è‰²æƒ…", "æš´åŠ›"},
        message = "è¯„è®ºåŒ…å«æ•æ„Ÿè¯"
    )
    private String content;
}
```

### 7.4 å¤æ‚ä¸šåŠ¡æ ¡éªŒ


**æ ¡éªŒæ•°æ®åº“å”¯ä¸€æ€§**ï¼š

```java
// å®šä¹‰æ³¨è§£
@Constraint(validatedBy = UniqueUsernameValidator.class)
public @interface UniqueUsername {
    String message() default "ç”¨æˆ·åå·²å­˜åœ¨";
    Class<?>[] groups() default {};
    Class<? extends Payload>[] payload() default {};
}

// å®ç°æ ¡éªŒå™¨ï¼ˆéœ€è¦æ³¨å…¥Serviceï¼‰
@Component
public class UniqueUsernameValidator 
    implements ConstraintValidator<UniqueUsername, String> {
    
    @Autowired
    private UserService userService;
    
    @Override
    public boolean isValid(String username, ConstraintValidatorContext context) {
        if (username == null) {
            return true;
        }
        
        // æŸ¥è¯¢æ•°æ®åº“
        User user = userService.findByUsername(username);
        return user == null;  // ä¸å­˜åœ¨åˆ™é€šè¿‡
    }
}

// ä½¿ç”¨
public class User {
    @UniqueUsername(message = "ç”¨æˆ·åå·²è¢«å ç”¨")
    private String username;
}
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**
>
> 1. æ ¡éªŒå™¨éœ€è¦åŠ `@Component`æ‰èƒ½æ³¨å…¥å…¶ä»–Bean
> 2. æŸ¥è¯¢æ•°æ®åº“ä¼šå½±å“æ€§èƒ½ï¼Œæ…ç”¨
> 3. è€ƒè™‘ç¼“å­˜ä¼˜åŒ–

---

## 8. ğŸ¬ å®æˆ˜åº”ç”¨åœºæ™¯


### 8.1 ç”¨æˆ·æ³¨å†Œå®Œæ•´ç¤ºä¾‹


**å®ä½“ç±»å®šä¹‰**ï¼š

```java
public class RegisterForm {
    
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @Size(min = 3, max = 20, message = "ç”¨æˆ·å3-20ä¸ªå­—ç¬¦")
    @Pattern(regexp = "^[a-zA-Z0-9_]+$", message = "ç”¨æˆ·ååªèƒ½åŒ…å«å­—æ¯æ•°å­—ä¸‹åˆ’çº¿")
    private String username;
    
    @NotBlank(message = "å¯†ç ä¸èƒ½ä¸ºç©º")
    @Size(min = 6, max = 20, message = "å¯†ç 6-20ä¸ªå­—ç¬¦")
    private String password;
    
    @NotBlank(message = "ç¡®è®¤å¯†ç ä¸èƒ½ä¸ºç©º")
    private String confirmPassword;
    
    @NotBlank(message = "é‚®ç®±ä¸èƒ½ä¸ºç©º")
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String email;
    
    @NotBlank(message = "æ‰‹æœºå·ä¸èƒ½ä¸ºç©º")
    @Pattern(regexp = "^1[3-9]\\d{9}$", message = "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®")
    private String phone;
    
    @NotNull(message = "è¯·åŒæ„æœåŠ¡æ¡æ¬¾")
    @AssertTrue(message = "å¿…é¡»åŒæ„æœåŠ¡æ¡æ¬¾")
    private Boolean agree;
}
```

**æ§åˆ¶å™¨å¤„ç†**ï¼š

```java
@RestController
@RequestMapping("/user")
public class UserController {
    
    @PostMapping("/register")
    public Result register(@Valid RegisterForm form, BindingResult result) {
        
        // 1. æ ¡éªŒæ³¨è§£è§„åˆ™
        if (result.hasErrors()) {
            String error = result.getFieldError().getDefaultMessage();
            return Result.error(error);
        }
        
        // 2. ä¸šåŠ¡æ ¡éªŒï¼šä¸¤æ¬¡å¯†ç æ˜¯å¦ä¸€è‡´
        if (!form.getPassword().equals(form.getConfirmPassword())) {
            return Result.error("ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´");
        }
        
        // 3. ä¸šåŠ¡æ ¡éªŒï¼šç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
        if (userService.existsByUsername(form.getUsername())) {
            return Result.error("ç”¨æˆ·åå·²å­˜åœ¨");
        }
        
        // 4. æ‰§è¡Œæ³¨å†Œé€»è¾‘
        userService.register(form);
        
        return Result.success("æ³¨å†ŒæˆåŠŸ");
    }
}
```

### 8.2 åˆ†ç»„æ ¡éªŒå®æˆ˜


**è®¢å•å®ä½“**ï¼š

```java
// å®šä¹‰åˆ†ç»„
public interface CreateOrder { }
public interface PayOrder { }
public interface CancelOrder { }

public class Order {
    
    // æ”¯ä»˜æ—¶éœ€è¦è®¢å•ID
    @NotNull(message = "è®¢å•IDä¸èƒ½ä¸ºç©º", groups = {PayOrder.class, CancelOrder.class})
    private Long orderId;
    
    // åˆ›å»ºè®¢å•æ—¶éœ€è¦å•†å“ID
    @NotNull(message = "å•†å“IDä¸èƒ½ä¸ºç©º", groups = {CreateOrder.class})
    private Long productId;
    
    // åˆ›å»ºè®¢å•æ—¶éœ€è¦æ•°é‡
    @NotNull(message = "æ•°é‡ä¸èƒ½ä¸ºç©º", groups = {CreateOrder.class})
    @Min(value = 1, message = "æ•°é‡è‡³å°‘ä¸º1", groups = {CreateOrder.class})
    private Integer quantity;
    
    // æ”¯ä»˜æ—¶éœ€è¦æ”¯ä»˜æ–¹å¼
    @NotBlank(message = "è¯·é€‰æ‹©æ”¯ä»˜æ–¹å¼", groups = {PayOrder.class})
    private String payMethod;
}
```

**æ§åˆ¶å™¨åˆ†ç»„ä½¿ç”¨**ï¼š

```java
@RestController
@RequestMapping("/order")
public class OrderController {
    
    // åˆ›å»ºè®¢å•
    @PostMapping("/create")
    public Result create(@Validated(CreateOrder.class) Order order) {
        // åªæ ¡éªŒproductIdå’Œquantity
        return Result.success();
    }
    
    // æ”¯ä»˜è®¢å•
    @PostMapping("/pay")
    public Result pay(@Validated(PayOrder.class) Order order) {
        // åªæ ¡éªŒorderIdå’ŒpayMethod
        return Result.success();
    }
    
    // å–æ¶ˆè®¢å•
    @PostMapping("/cancel")
    public Result cancel(@Validated(CancelOrder.class) Order order) {
        // åªæ ¡éªŒorderId
        return Result.success();
    }
}
```

### 8.3 åµŒå¥—å¯¹è±¡æ ¡éªŒ


**åµŒå¥—å®ä½“å®šä¹‰**ï¼š

```java
public class Order {
    
    @NotNull(message = "æ”¶è´§åœ°å€ä¸èƒ½ä¸ºç©º")
    @Valid  // å¿…é¡»åŠ @Validæ‰èƒ½æ ¡éªŒåµŒå¥—å¯¹è±¡
    private Address address;
    
    @NotEmpty(message = "è‡³å°‘è¦æœ‰ä¸€ä»¶å•†å“")
    @Valid  // é›†åˆä¸­çš„å¯¹è±¡ä¹Ÿè¦æ ¡éªŒ
    private List<OrderItem> items;
}

public class Address {
    
    @NotBlank(message = "æ”¶è´§äººä¸èƒ½ä¸ºç©º")
    private String receiver;
    
    @NotBlank(message = "æ‰‹æœºå·ä¸èƒ½ä¸ºç©º")
    @Pattern(regexp = "^1[3-9]\\d{9}$", message = "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®")
    private String phone;
    
    @NotBlank(message = "è¯¦ç»†åœ°å€ä¸èƒ½ä¸ºç©º")
    private String detail;
}

public class OrderItem {
    
    @NotNull(message = "å•†å“IDä¸èƒ½ä¸ºç©º")
    private Long productId;
    
    @NotNull(message = "æ•°é‡ä¸èƒ½ä¸ºç©º")
    @Min(value = 1, message = "æ•°é‡è‡³å°‘ä¸º1")
    private Integer quantity;
}
```

**æ§åˆ¶å™¨ä½¿ç”¨**ï¼š

```java
@PostMapping("/submit")
public Result submit(@Valid Order order, BindingResult result) {
    if (result.hasErrors()) {
        // åµŒå¥—å¯¹è±¡çš„é”™è¯¯ä¹Ÿä¼šåœ¨è¿™é‡Œ
        String error = result.getFieldError().getDefaultMessage();
        return Result.error(error);
    }
    
    return Result.success();
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æ•°æ®æ ¡éªŒæœ¬è´¨ï¼šæ£€æŸ¥ç”¨æˆ·è¾“å…¥æ˜¯å¦ç¬¦åˆè¦æ±‚
ğŸ”¸ JSR303è§„èŒƒï¼šJavaå®˜æ–¹çš„æ ¡éªŒæ ‡å‡†
ğŸ”¸ Hibernate Validatorï¼šæœ€æµè¡Œçš„å®ç°æ¡†æ¶
ğŸ”¸ @Valid vs @Validatedï¼šå‰è€…æ”¯æŒåµŒå¥—ï¼Œåè€…æ”¯æŒåˆ†ç»„
ğŸ”¸ BindingResultï¼šæ¥æ”¶æ ¡éªŒç»“æœçš„å®¹å™¨
```

### 9.2 å¸¸ç”¨æ³¨è§£é€ŸæŸ¥è¡¨


| åˆ†ç±» | æ³¨è§£ | ä½œç”¨ | é€‚ç”¨ç±»å‹ |
|------|------|------|---------|
| **éç©º** | `@NotNull` | ä¸èƒ½ä¸ºnull | ä»»ä½•ç±»å‹ |
|  | `@NotEmpty` | ä¸èƒ½ä¸ºnullå’Œç©º | å­—ç¬¦ä¸²ã€é›†åˆã€æ•°ç»„ |
|  | `@NotBlank` | ä¸èƒ½ä¸ºnullã€ç©ºã€ç©ºç™½ | å­—ç¬¦ä¸² |
| **é•¿åº¦** | `@Size` | é•¿åº¦/å¤§å°é™åˆ¶ | å­—ç¬¦ä¸²ã€é›†åˆã€æ•°ç»„ |
|  | `@Length` | å­—ç¬¦ä¸²é•¿åº¦ | å­—ç¬¦ä¸² |
| **æ•°å€¼** | `@Min` | æœ€å°å€¼ | æ•°å­— |
|  | `@Max` | æœ€å¤§å€¼ | æ•°å­— |
|  | `@Range` | èŒƒå›´ | æ•°å­— |
| **æ ¼å¼** | `@Pattern` | æ­£åˆ™è¡¨è¾¾å¼ | å­—ç¬¦ä¸² |
|  | `@Email` | é‚®ç®±æ ¼å¼ | å­—ç¬¦ä¸² |
|  | `@URL` | ç½‘å€æ ¼å¼ | å­—ç¬¦ä¸² |

### 9.3 åˆ†ç»„æ ¡éªŒå…³é”®ç‚¹


**åˆ†ç»„çš„ä¸‰ä¸ªæ­¥éª¤**ï¼š

```
ç¬¬ä¸€æ­¥ï¼šå®šä¹‰åˆ†ç»„æ¥å£
    â†“
public interface AddGroup { }

ç¬¬äºŒæ­¥ï¼šæ³¨è§£æŒ‡å®šåˆ†ç»„
    â†“
@NotNull(groups = {AddGroup.class})

ç¬¬ä¸‰æ­¥ï¼šæ§åˆ¶å™¨åº”ç”¨åˆ†ç»„
    â†“
@Validated(AddGroup.class)
```

> ğŸ’¡ **è®°å¿†å£è¯€**
>
> å®šä¹‰æ¥å£å®šåˆ†ç»„ï¼Œæ³¨è§£æŒ‡å®šå“ªä¸ªç”¨
> æ§åˆ¶å™¨ä¸Šæ¥å£°æ˜ï¼Œæƒ³ç”¨å“ªç»„ç”¨å“ªç»„

### 9.4 è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£è¦ç‚¹


**åˆ›å»ºæµç¨‹**ï¼š

```
1. å®šä¹‰æ³¨è§£
   @Constraint(validatedBy = XXXValidator.class)
   
2. å®ç°æ ¡éªŒå™¨
   implements ConstraintValidator<æ³¨è§£, å­—æ®µç±»å‹>
   
3. é‡å†™isValidæ–¹æ³•
   return true/false;
   
4. ä½¿ç”¨æ³¨è§£
   @è‡ªå®šä¹‰æ³¨è§£
```

### 9.5 å®æˆ˜æœ€ä½³å®è·µ


**æ ¡éªŒå±‚æ¬¡åˆ’åˆ†**ï¼š

```
ç¬¬ä¸€å±‚ï¼šæ³¨è§£æ ¡éªŒï¼ˆæ ¼å¼ã€é•¿åº¦ã€èŒƒå›´ï¼‰
    â†“
@NotBlank, @Size, @Pattern
è‡ªåŠ¨æ ¡éªŒï¼Œå¿«é€Ÿå¤±è´¥

ç¬¬äºŒå±‚ï¼šä¸šåŠ¡æ ¡éªŒï¼ˆå”¯ä¸€æ€§ã€çŠ¶æ€æ£€æŸ¥ï¼‰
    â†“
if (userService.exists(username)) {
    return error;
}
éœ€è¦æŸ¥è¯¢æ•°æ®åº“ï¼Œæ€§èƒ½å½±å“

ç¬¬ä¸‰å±‚ï¼šæƒé™æ ¡éªŒï¼ˆæ˜¯å¦æœ‰æ“ä½œæƒé™ï¼‰
    â†“
if (!hasPermission(user, order)) {
    return error;
}
æ¶‰åŠå¤æ‚ä¸šåŠ¡é€»è¾‘
```

> ğŸ¯ **ä¼˜åŒ–å»ºè®®**
>
> - èƒ½ç”¨æ³¨è§£å°±ä¸å†™ä»£ç 
> - ä¼˜å…ˆæ ¼å¼æ ¡éªŒï¼Œå†ä¸šåŠ¡æ ¡éªŒ
> - å…¨å±€å¼‚å¸¸å¤„ç†ç»Ÿä¸€è¿”å›
> - åˆ†ç»„æ ¡éªŒåº”å¯¹å¤æ‚åœºæ™¯

### 9.6 å¸¸è§é—®é¢˜è§£å†³


**é—®é¢˜1ï¼šæ ¡éªŒä¸ç”Ÿæ•ˆ**
```
âœ… æ£€æŸ¥æ˜¯å¦æ·»åŠ @Validæˆ–@Validated
âœ… æ£€æŸ¥æ˜¯å¦å¯¼å…¥æ­£ç¡®çš„åŒ…
âœ… æ£€æŸ¥SpringBootç‰ˆæœ¬ï¼ˆ2.3+éœ€æ‰‹åŠ¨å¼•å…¥validationä¾èµ–ï¼‰
```

**é—®é¢˜2ï¼šåµŒå¥—å¯¹è±¡ä¸æ ¡éªŒ**
```
âœ… åµŒå¥—å¯¹è±¡å­—æ®µä¸ŠåŠ @Valid
âœ… é›†åˆä¸­çš„å¯¹è±¡ä¹Ÿè¦åŠ @Valid
```

**é—®é¢˜3ï¼šåˆ†ç»„ä¸ç”Ÿæ•ˆ**
```
âœ… ç¡®è®¤ä½¿ç”¨@Validatedè€Œé@Valid
âœ… æ£€æŸ¥groupsé…ç½®æ˜¯å¦æ­£ç¡®
âœ… æœªæŒ‡å®šgroupsçš„æ³¨è§£å±äºDefaultåˆ†ç»„
```

**é—®é¢˜4ï¼šè‡ªå®šä¹‰æ ¡éªŒå™¨æ³¨å…¥å¤±è´¥**
```
âœ… æ ¡éªŒå™¨ç±»åŠ @Componentæ³¨è§£
âœ… ç¡®ä¿åœ¨Springæ‰«æåŒ…è·¯å¾„ä¸‹
```

---

## ğŸ“ å­¦ä¹ å»ºè®®


**æ–°æ‰‹å­¦ä¹ è·¯å¾„**ï¼š

```
ç¬¬1æ­¥ï¼šæŒæ¡åŸºç¡€æ³¨è§£
    â†“
@NotNull, @NotBlank, @Size, @Min, @Max

ç¬¬2æ­¥ï¼šç†è§£@Validå’ŒBindingResult
    â†“
å¦‚ä½•å¯ç”¨æ ¡éªŒï¼Œå¦‚ä½•è·å–é”™è¯¯

ç¬¬3æ­¥ï¼šå­¦ä¹ åˆ†ç»„æ ¡éªŒ
    â†“
åŒä¸€å®ä½“ä¸åŒåœºæ™¯çš„æ ¡éªŒè§„åˆ™

ç¬¬4æ­¥ï¼šæŒæ¡è‡ªå®šä¹‰æ³¨è§£
    â†“
å¤„ç†å¤æ‚ä¸šåŠ¡æ ¡éªŒéœ€æ±‚

ç¬¬5æ­¥ï¼šå…¨å±€å¼‚å¸¸å¤„ç†
    â†“
ç»Ÿä¸€é”™è¯¯è¿”å›æ ¼å¼
```

**å®æˆ˜ç»ƒä¹ å»ºè®®**ï¼š
- âœ… ä»ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½å¼€å§‹ç»ƒä¹ 
- âœ… å°è¯•ç”¨åˆ†ç»„æ ¡éªŒå®ç°å¢åˆ æ”¹åœºæ™¯
- âœ… è‡ªå·±å†™ä¸€ä¸ªæ‰‹æœºå·æ ¡éªŒæ³¨è§£
- âœ… å®ç°å…¨å±€å¼‚å¸¸å¤„ç†å™¨

---

**æ ¸å¿ƒè®°å¿†**ï¼š
- æ ¡éªŒæ¡†æ¶è®©æ•°æ®æ£€æŸ¥å˜ç®€å•ï¼Œæ³¨è§£ä¸€å†™è§„åˆ™å…¨
- ä¸‰å…„å¼ŸNotNullã€NotEmptyã€NotBlankè¦åˆ†æ¸…
- Validå¯ç”¨æ ¡éªŒï¼ŒValidatedæ”¯æŒåˆ†ç»„
- BindingResultç´§è·Ÿå‚æ•°ï¼Œé”™è¯¯ä¿¡æ¯å…¨æ”¶é›†
- è‡ªå®šä¹‰æ³¨è§£ä¸‰æ­¥èµ°ï¼Œå®šä¹‰å®ç°å†ä½¿ç”¨