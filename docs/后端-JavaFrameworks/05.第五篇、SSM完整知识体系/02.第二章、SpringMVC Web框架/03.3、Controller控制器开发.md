---
title: 3ã€Controlleræ§åˆ¶å™¨å¼€å‘
---
## ğŸ“š ç›®å½•

1. [æ§åˆ¶å™¨åŸºç¡€æ¦‚å¿µ](#1-æ§åˆ¶å™¨åŸºç¡€æ¦‚å¿µ)
2. [æ§åˆ¶å™¨æ³¨è§£è¯¦è§£](#2-æ§åˆ¶å™¨æ³¨è§£è¯¦è§£)
3. [æ§åˆ¶å™¨æ–¹æ³•å¼€å‘](#3-æ§åˆ¶å™¨æ–¹æ³•å¼€å‘)
4. [æ–¹æ³•å‚æ•°ç»‘å®š](#4-æ–¹æ³•å‚æ•°ç»‘å®š)
5. [æ–¹æ³•è¿”å›å€¼å¤„ç†](#5-æ–¹æ³•è¿”å›å€¼å¤„ç†)
6. [æ•°æ®ä¼ é€’æ–¹å¼](#6-æ•°æ®ä¼ é€’æ–¹å¼)
7. [é‡å®šå‘ä¼ å€¼](#7-é‡å®šå‘ä¼ å€¼)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ æ§åˆ¶å™¨åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯æ§åˆ¶å™¨


**é€šä¿—ç†è§£**ï¼šæ§åˆ¶å™¨å°±åƒæ˜¯é¤å…çš„æœåŠ¡å‘˜

```
ç”¨æˆ·è®¿é—®ç½‘é¡µçš„è¿‡ç¨‹ï¼š

ç”¨æˆ·(é¡¾å®¢) â†’ å‘é€è¯·æ±‚(ç‚¹èœ) â†’ æ§åˆ¶å™¨(æœåŠ¡å‘˜) â†’ å¤„ç†ä¸šåŠ¡(åå¨åšèœ) â†’ è¿”å›ç»“æœ(ä¸Šèœ)

æ§åˆ¶å™¨çš„èŒè´£ï¼š
â€¢ æ¥æ”¶ç”¨æˆ·çš„è¯·æ±‚
â€¢ è°ƒç”¨ä¸šåŠ¡é€»è¾‘å¤„ç†
â€¢ æŠŠå¤„ç†ç»“æœè¿”å›ç»™ç”¨æˆ·
```

**æ ¸å¿ƒä½œç”¨**ï¼š
```
ğŸ”¸ æ¥æ”¶è¯·æ±‚ï¼šæ¥æ”¶æµè§ˆå™¨å‘æ¥çš„å„ç§è¯·æ±‚
ğŸ”¸ å¤„ç†æ•°æ®ï¼šè·å–è¯·æ±‚å‚æ•°ï¼Œè°ƒç”¨ä¸šåŠ¡å±‚
ğŸ”¸ è¿”å›å“åº”ï¼šæŠŠå¤„ç†ç»“æœè¿”å›ç»™æµè§ˆå™¨
```

### 1.2 æ§åˆ¶å™¨åœ¨é¡¹ç›®ä¸­çš„ä½ç½®


```
æµè§ˆå™¨
   â†“
ã€æ§åˆ¶å±‚ Controllerã€‘ â† æˆ‘ä»¬ç°åœ¨å­¦çš„
   â†“
ã€ä¸šåŠ¡å±‚ Serviceã€‘
   â†“
ã€æ•°æ®å±‚ Daoã€‘
   â†“
æ•°æ®åº“
```

**ä¸ºä»€ä¹ˆå«"æ§åˆ¶å™¨"**ï¼š
- å®ƒæ§åˆ¶ç€æ•´ä¸ªè¯·æ±‚çš„æµç¨‹
- å°±åƒäº¤é€šæŒ‡æŒ¥å‘˜ï¼ŒæŒ‡æŒ¥æ•°æ®æµå‘
- å†³å®šè°ƒç”¨å“ªä¸ªä¸šåŠ¡æ–¹æ³•ï¼Œè¿”å›ä»€ä¹ˆç»“æœ

---

## 2. ğŸ“Œ æ§åˆ¶å™¨æ³¨è§£è¯¦è§£


### 2.1 @Controlleræ³¨è§£


**æ¦‚å¿µè¯´æ˜**ï¼šå‘Šè¯‰Springè¿™æ˜¯ä¸€ä¸ªæ§åˆ¶å™¨ç±»ï¼Œä¸“é—¨ç”¨æ¥å¤„ç†ç½‘é¡µè¯·æ±‚

```java
// åŸºç¡€ç”¨æ³•
@Controller  // â† è¿™ä¸ªæ³¨è§£æ ‡è®°è¿™æ˜¯æ§åˆ¶å™¨
public class UserController {
    
    @RequestMapping("/user/list")
    public String userList() {
        return "user/list";  // è¿”å›é¡µé¢åç§°
    }
}
```

**å·¥ä½œåŸç†**ï¼š
```
Springå¯åŠ¨æ—¶çš„è¿‡ç¨‹ï¼š

1. æ‰«æåˆ°@Controlleræ³¨è§£
2. æŠŠè¿™ä¸ªç±»æ³¨å†Œä¸ºBean
3. ç›‘å¬è¿™ä¸ªç±»ä¸­çš„@RequestMapping
4. å½“è¯·æ±‚æ¥äº†ï¼Œå°±è°ƒç”¨å¯¹åº”æ–¹æ³•
```

**å®é™…æ•ˆæœ**ï¼š
- ç”¨æˆ·è®¿é—®ï¼š`http://localhost:8080/user/list`
- Springæ‰¾åˆ°è¿™ä¸ªæ–¹æ³•æ‰§è¡Œ
- è¿”å›`user/list.jsp`é¡µé¢ç»™ç”¨æˆ·

### 2.2 @RestControlleræ³¨è§£


**æ¦‚å¿µè¯´æ˜**ï¼šä¸“é—¨ç”¨äºè¿”å›JSONæ•°æ®çš„æ§åˆ¶å™¨ï¼Œä¸è¿”å›é¡µé¢

```java
@RestController  // â† è¿”å›æ•°æ®ï¼Œä¸æ˜¯é¡µé¢
public class UserApiController {
    
    @GetMapping("/api/user/{id}")
    public User getUser(@PathVariable Long id) {
        User user = new User(1L, "å¼ ä¸‰", 25);
        return user;  // ç›´æ¥è¿”å›å¯¹è±¡ï¼Œè‡ªåŠ¨è½¬æˆJSON
    }
}
```

**ä¸¤è€…çš„æœ¬è´¨åŒºåˆ«**ï¼š

| æ³¨è§£ | **è¿”å›å†…å®¹** | **ä½¿ç”¨åœºæ™¯** | **å®é™…æ•ˆæœ** |
|------|------------|------------|------------|
| `@Controller` | è¿”å›é¡µé¢åç§° | ä¼ ç»Ÿç½‘é¡µå¼€å‘ | è·³è½¬åˆ°JSP/HTMLé¡µé¢ |
| `@RestController` | è¿”å›æ•°æ®(JSON) | å‰åç«¯åˆ†ç¦»å¼€å‘ | è¿”å›JSONç»™å‰ç«¯ |

**é€šä¿—å¯¹æ¯”**ï¼š
```
@Controllerï¼š
ç”¨æˆ·è¯·æ±‚ â†’ æ§åˆ¶å™¨ â†’ è¿”å›"success.jsp" â†’ æµè§ˆå™¨æ˜¾ç¤ºé¡µé¢

@RestControllerï¼š
å‰ç«¯è¯·æ±‚ â†’ æ§åˆ¶å™¨ â†’ è¿”å›{"name":"å¼ ä¸‰"} â†’ å‰ç«¯ç”¨æ•°æ®æ¸²æŸ“é¡µé¢
```

**@RestControllerçš„æœ¬è´¨**ï¼š
```java
// @RestController ç­‰åŒäºï¼š
@Controller
@ResponseBody  // åŠ äº†è¿™ä¸ªï¼Œè¿”å›å€¼å°±å˜æˆæ•°æ®è€Œä¸æ˜¯é¡µé¢å
public class UserApiController {
    // ...
}
```

---

## 3. ğŸ”§ æ§åˆ¶å™¨æ–¹æ³•å¼€å‘


### 3.1 æ§åˆ¶å™¨æ–¹æ³•çš„å®šä¹‰è§„åˆ™


**åŸºæœ¬æ ¼å¼**ï¼š
```java
@Controller
public class UserController {
    
    // è®¿é—®ä¿®é¥°ç¬¦ è¿”å›å€¼ æ–¹æ³•å(å‚æ•°åˆ—è¡¨)
    public String login(String username, String password) {
        // å¤„ç†ç™»å½•é€»è¾‘
        return "success";
    }
}
```

**æ ¸å¿ƒè§„åˆ™**ï¼š

```
âœ… è®¿é—®ä¿®é¥°ç¬¦ï¼šé€šå¸¸ç”¨public
âœ… è¿”å›å€¼ï¼šå¯ä»¥æ˜¯Stringã€voidã€å¯¹è±¡ã€Mapç­‰
âœ… æ–¹æ³•åï¼šè‡ªå·±å®šä¹‰ï¼Œè§åçŸ¥æ„å³å¯
âœ… å‚æ•°ï¼šSpringä¼šè‡ªåŠ¨æ³¨å…¥ï¼Œéå¸¸çµæ´»
```

### 3.2 å¸¸è§çš„æ–¹æ³•å®šä¹‰ç¤ºä¾‹


**ç¤ºä¾‹1ï¼šæ— å‚æ•°æ–¹æ³•**
```java
@GetMapping("/home")
public String home() {
    return "home";  // è¿”å›homeé¡µé¢
}
```

**ç¤ºä¾‹2ï¼šå¸¦å‚æ•°æ–¹æ³•**
```java
@PostMapping("/login")
public String login(String username, String password) {
    // usernameå’Œpasswordä¼šè‡ªåŠ¨æ¥æ”¶è¡¨å•æ•°æ®
    if ("admin".equals(username) && "123456".equals(password)) {
        return "success";
    }
    return "login";
}
```

**ç¤ºä¾‹3ï¼šè¿”å›JSONæ•°æ®**
```java
@RestController
public class UserApiController {
    
    @GetMapping("/api/users")
    public List<User> getUsers() {
        // è¿”å›çš„Listä¼šè‡ªåŠ¨è½¬æˆJSONæ•°ç»„
        return userService.findAll();
    }
}
```

---

## 4. ğŸ”— æ–¹æ³•å‚æ•°ç»‘å®š


### 4.1 ä»€ä¹ˆæ˜¯å‚æ•°ç»‘å®š


**é€šä¿—è§£é‡Š**ï¼šå°±æ˜¯æŠŠæµè§ˆå™¨ä¼ æ¥çš„æ•°æ®ï¼Œè‡ªåŠ¨æ”¾åˆ°æ–¹æ³•å‚æ•°é‡Œ

```
ç”¨æˆ·åœ¨é¡µé¢å¡«å†™è¡¨å•ï¼š
ç”¨æˆ·åï¼šadmin
å¯†ç ï¼š123456

æäº¤å â†’ SpringMVCè‡ªåŠ¨æŠŠè¿™äº›å€¼ â†’ ä¼ ç»™æ–¹æ³•å‚æ•°

public String login(String username, String password) {
    // username = "admin"
    // password = "123456"
}
```

### 4.2 åŸºæœ¬æ•°æ®ç±»å‹ç»‘å®š


```java
// è¯·æ±‚ï¼š/search?keyword=æ‰‹æœº&page=1&size=10
@GetMapping("/search")
public String search(String keyword, int page, int size) {
    // keyword = "æ‰‹æœº"
    // page = 1
    // size = 10
    return "search";
}
```

**æ³¨æ„äº‹é¡¹**ï¼š
```
âš ï¸ å‚æ•°åè¦å’Œè¯·æ±‚å‚æ•°åä¸€è‡´
âš ï¸ intç±»å‹å¦‚æœæ²¡ä¼ å€¼ä¼šæŠ¥é”™ï¼Œå»ºè®®ç”¨Integer
âš ï¸ Stringç±»å‹æ²¡ä¼ å€¼ä¼šæ˜¯null
```

### 4.3 å¯¹è±¡ç»‘å®šï¼ˆé‡è¦ï¼‰


**è¡¨å•æ•°æ®è‡ªåŠ¨å°è£…æˆå¯¹è±¡**ï¼š

```java
// ç”¨æˆ·å®ä½“ç±»
public class User {
    private String username;
    private String password;
    private Integer age;
    // getterå’Œsetter...
}

// æ§åˆ¶å™¨æ–¹æ³•
@PostMapping("/register")
public String register(User user) {
    // Springè‡ªåŠ¨æŠŠè¡¨å•æ•°æ®å°è£…æˆUserå¯¹è±¡
    // user.getUsername() = è¡¨å•ä¸­çš„username
    // user.getPassword() = è¡¨å•ä¸­çš„password
    // user.getAge() = è¡¨å•ä¸­çš„age
    
    userService.save(user);
    return "success";
}
```

**ç»‘å®šåŸç†**ï¼š
```
1. Springçœ‹åˆ°Userå‚æ•°
2. åˆ›å»ºä¸€ä¸ªUserå¯¹è±¡
3. ä»è¯·æ±‚ä¸­æ‰¾usernameã€passwordã€age
4. è°ƒç”¨setUsername()ã€setPassword()ã€setAge()èµ‹å€¼
5. æŠŠå¡«å……å¥½çš„å¯¹è±¡ä¼ ç»™æ–¹æ³•
```

### 4.4 æ•°ç»„å’Œé›†åˆç»‘å®š


**æ¥æ”¶å¤šä¸ªåŒåå‚æ•°**ï¼š
```java
// è¯·æ±‚ï¼š/delete?ids=1&ids=2&ids=3
@PostMapping("/delete")
public String delete(Long[] ids) {
    // ids = [1, 2, 3]
    for (Long id : ids) {
        userService.deleteById(id);
    }
    return "success";
}
```

**æ¥æ”¶Listé›†åˆ**ï¼š
```java
// éœ€è¦ç”¨@RequestParamç»‘å®š
@PostMapping("/batch")
public String batch(@RequestParam List<Long> ids) {
    // ids = [1, 2, 3]
    return "success";
}
```

---

## 5. ğŸ“¤ æ–¹æ³•è¿”å›å€¼å¤„ç†


### 5.1 è¿”å›å€¼çš„ä¸‰ç§ç±»å‹


**ç±»å‹å¯¹æ¯”è¡¨**ï¼š

| è¿”å›å€¼ç±»å‹ | **è¿”å›å†…å®¹** | **å®é™…æ•ˆæœ** | **ä½¿ç”¨åœºæ™¯** |
|-----------|------------|------------|------------|
| `String` | é¡µé¢åç§° | è·³è½¬åˆ°å¯¹åº”é¡µé¢ | ä¼ ç»ŸMVCæ¨¡å¼ |
| `void` | æ— è¿”å›å€¼ | è‡ªå·±å¤„ç†å“åº” | æ–‡ä»¶ä¸‹è½½ç­‰ç‰¹æ®Šåœºæ™¯ |
| `å¯¹è±¡/Map` | æ•°æ® | è‡ªåŠ¨è½¬JSONè¿”å› | å‰åç«¯åˆ†ç¦»API |

### 5.2 è¿”å›String - é¡µé¢è·³è½¬


```java
@Controller
public class PageController {
    
    // è¿”å›é¡µé¢åç§°
    @GetMapping("/toLogin")
    public String toLogin() {
        return "login";  // è·³è½¬åˆ° /WEB-INF/views/login.jsp
    }
    
    // è½¬å‘
    @GetMapping("/forward")
    public String forward() {
        return "forward:/user/list";  // è½¬å‘åˆ°/user/list
    }
    
    // é‡å®šå‘
    @GetMapping("/redirect")
    public String redirect() {
        return "redirect:/home";  // é‡å®šå‘åˆ°/home
    }
}
```

**ä¸‰ç§è·³è½¬æ–¹å¼çš„åŒºåˆ«**ï¼š
```
é¡µé¢è·³è½¬ï¼š
return "login" â†’ ä½¿ç”¨è§†å›¾è§£æå™¨ â†’ /WEB-INF/views/login.jsp

è½¬å‘(forward)ï¼š
return "forward:/user/list" â†’ æœåŠ¡å™¨å†…éƒ¨è·³è½¬ï¼Œåœ°å€æ ä¸å˜

é‡å®šå‘(redirect)ï¼š
return "redirect:/home" â†’ æµè§ˆå™¨é‡æ–°è¯·æ±‚ï¼Œåœ°å€æ æ”¹å˜
```

### 5.3 è¿”å›void - è‡ªå®šä¹‰å“åº”


```java
@Controller
public class FileController {
    
    @GetMapping("/download")
    public void download(HttpServletResponse response) {
        try {
            // è®¾ç½®å“åº”å¤´
            response.setContentType("application/octet-stream");
            response.setHeader("Content-Disposition", "attachment;filename=test.txt");
            
            // å†™å‡ºæ–‡ä»¶å†…å®¹
            PrintWriter out = response.getWriter();
            out.write("Hello World");
            out.flush();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

### 5.4 è¿”å›å¯¹è±¡ - JSONæ•°æ®


```java
@RestController
public class UserApiController {
    
    @GetMapping("/api/user/{id}")
    public User getUser(@PathVariable Long id) {
        User user = new User(id, "å¼ ä¸‰", 25);
        return user;  
        // è‡ªåŠ¨è½¬æ¢æˆï¼š{"id":1,"name":"å¼ ä¸‰","age":25}
    }
    
    @GetMapping("/api/users")
    public List<User> getUsers() {
        return userService.findAll();
        // è‡ªåŠ¨è½¬æ¢æˆï¼š[{...}, {...}, {...}]
    }
}
```

---

## 6. ğŸ”„ æ•°æ®ä¼ é€’æ–¹å¼


### 6.1 HttpServletRequestå¯¹è±¡


**æ¦‚å¿µè¯´æ˜**ï¼šä»£è¡¨å®¢æˆ·ç«¯å‘æ¥çš„HTTPè¯·æ±‚ï¼ŒåŒ…å«è¯·æ±‚çš„æ‰€æœ‰ä¿¡æ¯

```java
@Controller
public class RequestController {
    
    @GetMapping("/info")
    public String info(HttpServletRequest request) {
        // è·å–è¯·æ±‚å‚æ•°
        String name = request.getParameter("name");
        
        // è·å–è¯·æ±‚å¤´
        String userAgent = request.getHeader("User-Agent");
        
        // è·å–è¯·æ±‚è·¯å¾„
        String uri = request.getRequestURI();
        
        // å­˜å‚¨æ•°æ®åˆ°requeståŸŸ
        request.setAttribute("message", "Hello");
        
        return "info";
    }
}
```

**å¸¸ç”¨æ–¹æ³•æ€»ç»“**ï¼š
```
è·å–æ•°æ®ï¼š
â€¢ getParameter("name") - è·å–è¯·æ±‚å‚æ•°
â€¢ getHeader("åç§°") - è·å–è¯·æ±‚å¤´
â€¢ getRequestURI() - è·å–è¯·æ±‚è·¯å¾„

å­˜å‚¨æ•°æ®ï¼š
â€¢ setAttribute("key", value) - å­˜æ•°æ®
â€¢ getAttribute("key") - å–æ•°æ®
```

### 6.2 HttpServletResponseå¯¹è±¡


**æ¦‚å¿µè¯´æ˜**ï¼šä»£è¡¨æœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯çš„HTTPå“åº”

```java
@Controller
public class ResponseController {
    
    @GetMapping("/json")
    public void writeJson(HttpServletResponse response) throws IOException {
        // è®¾ç½®å“åº”ç±»å‹
        response.setContentType("application/json;charset=UTF-8");
        
        // å†™å‡ºJSONæ•°æ®
        PrintWriter out = response.getWriter();
        out.write("{\"status\":\"success\"}");
        out.flush();
    }
}
```

**å¸¸ç”¨æ–¹æ³•**ï¼š
```
è®¾ç½®å“åº”ï¼š
â€¢ setContentType() - è®¾ç½®å“åº”ç±»å‹
â€¢ setHeader() - è®¾ç½®å“åº”å¤´
â€¢ setStatus() - è®¾ç½®çŠ¶æ€ç 

è¾“å‡ºæ•°æ®ï¼š
â€¢ getWriter() - è·å–å­—ç¬¦æµ
â€¢ getOutputStream() - è·å–å­—èŠ‚æµ
```

### 6.3 Modelæ•°æ®ä¼ é€’


**æ¦‚å¿µè¯´æ˜**ï¼šModelæ˜¯SpringMVCæä¾›çš„æ•°æ®å®¹å™¨ï¼Œä¸“é—¨ç”¨æ¥å‘é¡µé¢ä¼ é€’æ•°æ®

```java
@Controller
public class UserController {
    
    @GetMapping("/user/detail")
    public String detail(Long id, Model model) {
        // æŸ¥è¯¢ç”¨æˆ·
        User user = userService.findById(id);
        
        // æŠŠæ•°æ®æ”¾åˆ°Modelä¸­
        model.addAttribute("user", user);
        model.addAttribute("title", "ç”¨æˆ·è¯¦æƒ…");
        
        return "user/detail";  // JSPé¡µé¢å¯ä»¥ç”¨${user.name}å–å€¼
    }
}
```

**åœ¨é¡µé¢ä¸­ä½¿ç”¨**ï¼š
```jsp
<!-- detail.jsp -->
<h1>${title}</h1>
<p>ç”¨æˆ·åï¼š${user.name}</p>
<p>å¹´é¾„ï¼š${user.age}</p>
```

**Modelçš„ç‰¹ç‚¹**ï¼š
```
âœ… ç®€å•æ–¹ä¾¿ï¼Œä¸“é—¨ä¸ºè§†å›¾ä¼ å€¼è®¾è®¡
âœ… è‡ªåŠ¨æ”¾åˆ°requeståŸŸä¸­
âœ… é¡µé¢å¯ä»¥ç›´æ¥ç”¨ELè¡¨è¾¾å¼å–å€¼
```

### 6.4 ModelAndViewè§†å›¾æ¨¡å‹


**æ¦‚å¿µè¯´æ˜**ï¼šæ—¢èƒ½å­˜æ•°æ®ï¼Œåˆèƒ½æŒ‡å®šè§†å›¾ï¼Œæ˜¯Modelå’ŒViewçš„ç»„åˆ

```java
@Controller
public class ProductController {
    
    @GetMapping("/product/list")
    public ModelAndView list() {
        // åˆ›å»ºModelAndViewå¯¹è±¡
        ModelAndView mv = new ModelAndView();
        
        // æ·»åŠ æ•°æ®
        List<Product> products = productService.findAll();
        mv.addObject("products", products);
        mv.addObject("total", products.size());
        
        // è®¾ç½®è§†å›¾åç§°
        mv.setViewName("product/list");
        
        return mv;
    }
}
```

**å¯¹æ¯”ä¸‰ç§ä¼ å€¼æ–¹å¼**ï¼š

```
Modelï¼š
åªä¼ æ•°æ®ï¼Œè§†å›¾åç”±returnè¯­å¥æŒ‡å®š
é€‚åˆï¼šå¤§å¤šæ•°æƒ…å†µ

ModelAndViewï¼š
æ•°æ®å’Œè§†å›¾ä¸€èµ·æŒ‡å®š
é€‚åˆï¼šéœ€è¦æ ¹æ®ä¸šåŠ¡åŠ¨æ€é€‰æ‹©è§†å›¾

Requestï¼š
åŸå§‹æ–¹å¼ï¼ŒåŠŸèƒ½æœ€å…¨ä½†ä¸å¤Ÿä¼˜é›…
é€‚åˆï¼šç‰¹æ®Šéœ€æ±‚
```

---

## 7. ğŸ”€ é‡å®šå‘ä¼ å€¼


### 7.1 é‡å®šå‘çš„é—®é¢˜


**æ ¸å¿ƒé—®é¢˜**ï¼šé‡å®šå‘ä¼šä¸¢å¤±æ•°æ®

```java
// âŒ é”™è¯¯ç¤ºä¾‹ï¼šæ•°æ®ä¼šä¸¢å¤±
@PostMapping("/save")
public String save(User user, Model model) {
    userService.save(user);
    model.addAttribute("message", "ä¿å­˜æˆåŠŸ");  // â† è¿™ä¸ªæ•°æ®ä¼šä¸¢å¤±ï¼
    return "redirect:/user/list";
}
```

**ä¸ºä»€ä¹ˆä¼šä¸¢å¤±**ï¼š
```
é‡å®šå‘çš„è¿‡ç¨‹ï¼š

1. æµè§ˆå™¨è¯·æ±‚ /save
2. æœåŠ¡å™¨è¿”å›302çŠ¶æ€ç å’Œæ–°åœ°å€ /user/list
3. æµè§ˆå™¨é‡æ–°è¯·æ±‚ /user/listï¼ˆè¿™æ˜¯æ–°è¯·æ±‚ï¼ï¼‰
4. Modelä¸­çš„æ•°æ®åœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚ä¸­ï¼Œæ–°è¯·æ±‚æ‹¿ä¸åˆ°
```

### 7.2 RedirectAttributesè§£å†³æ–¹æ¡ˆ


**æ¦‚å¿µè¯´æ˜**ï¼šä¸“é—¨ä¸ºé‡å®šå‘ä¼ å€¼è®¾è®¡çš„ç±»

```java
@Controller
public class UserController {
    
    @PostMapping("/save")
    public String save(User user, RedirectAttributes attr) {
        userService.save(user);
        
        // é€šè¿‡RedirectAttributesä¼ å€¼
        attr.addFlashAttribute("message", "ä¿å­˜æˆåŠŸ");
        attr.addFlashAttribute("user", user);
        
        return "redirect:/user/list";
    }
    
    @GetMapping("/user/list")
    public String list(Model model) {
        // å¯ä»¥è·å–åˆ°messageå’Œuser
        // ${message} å’Œ ${user} åœ¨é¡µé¢å¯ç”¨
        return "user/list";
    }
}
```

### 7.3 ä¸¤ç§ä¼ å€¼æ–¹å¼


**addFlashAttribute vs addAttribute**ï¼š

```java
@PostMapping("/save")
public String save(User user, RedirectAttributes attr) {
    
    // æ–¹å¼1ï¼šaddFlashAttributeï¼ˆæ¨èï¼‰
    attr.addFlashAttribute("message", "ä¿å­˜æˆåŠŸ");
    // ä¼˜ç‚¹ï¼šä¸ä¼šæ˜¾ç¤ºåœ¨URLä¸Šï¼Œæ”¯æŒä»»ä½•å¯¹è±¡
    // æ•ˆæœï¼š/user/listï¼ˆåœ°å€æ å¹²å‡€ï¼‰
    
    // æ–¹å¼2ï¼šaddAttribute
    attr.addAttribute("id", user.getId());
    // ä¼˜ç‚¹ï¼šç®€å•ç›´æ¥
    // æ•ˆæœï¼š/user/list?id=1ï¼ˆå‚æ•°æ˜¾ç¤ºåœ¨URLä¸Šï¼‰
    
    return "redirect:/user/list";
}
```

**ä½¿ç”¨åœºæ™¯å¯¹æ¯”**ï¼š

| æ–¹æ³• | **ä¼ é€’æ–¹å¼** | **URLæ˜¾ç¤º** | **é€‚ç”¨åœºæ™¯** |
|------|------------|-----------|------------|
| `addFlashAttribute` | Sessionä¸´æ—¶å­˜å‚¨ | ä¸æ˜¾ç¤º | æç¤ºä¿¡æ¯ã€å¯¹è±¡æ•°æ® |
| `addAttribute` | URLå‚æ•° | æ˜¾ç¤º | ç®€å•çš„idã€çŠ¶æ€ç  |

**å®é™…åº”ç”¨ç¤ºä¾‹**ï¼š
```java
// åˆ é™¤ç”¨æˆ·åé‡å®šå‘
@PostMapping("/delete")
public String delete(Long id, RedirectAttributes attr) {
    userService.deleteById(id);
    
    // ä¼ é€’æç¤ºä¿¡æ¯ï¼ˆä¸æ˜¾ç¤ºåœ¨URLï¼‰
    attr.addFlashAttribute("message", "åˆ é™¤æˆåŠŸ");
    attr.addFlashAttribute("type", "success");
    
    return "redirect:/user/list";
}

// åˆ—è¡¨é¡µé¢æ¥æ”¶
@GetMapping("/user/list")
public String list() {
    // é¡µé¢ç”¨ ${message} å’Œ ${type} æ˜¾ç¤ºæç¤ºæ¡†
    return "user/list";
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æ§åˆ¶å™¨æœ¬è´¨ï¼šå¤„ç†è¯·æ±‚çš„ä¸­è½¬ç«™ï¼Œè¿æ¥ç”¨æˆ·å’Œä¸šåŠ¡
ğŸ”¸ ä¸¤ä¸ªæ ¸å¿ƒæ³¨è§£ï¼š@Controllerè¿”å›é¡µé¢ï¼Œ@RestControllerè¿”å›æ•°æ®
ğŸ”¸ å‚æ•°ç»‘å®šï¼šSpringè‡ªåŠ¨æŠŠè¯·æ±‚æ•°æ®å¡«å……åˆ°æ–¹æ³•å‚æ•°
ğŸ”¸ è¿”å›å€¼ç±»å‹ï¼šStringè·³è½¬é¡µé¢ï¼Œå¯¹è±¡è¿”å›JSON
ğŸ”¸ æ•°æ®ä¼ é€’ï¼šModelä¼ æ•°æ®ï¼ŒRedirectAttributesè§£å†³é‡å®šå‘ä¼ å€¼
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ @Controller vs @RestControllerçš„é€‰æ‹©**
```
å¼€å‘ç½‘é¡µé¡¹ç›® â†’ ç”¨@Controller
å¼€å‘APIæ¥å£ â†’ ç”¨@RestController

è®°å¿†æŠ€å·§ï¼š
Rest = è¿”å›æ•°æ®
Controller = è¿”å›é¡µé¢
```

**ğŸ”¹ å‚æ•°ç»‘å®šçš„è‡ªåŠ¨åŒ–**
```
åªè¦å‚æ•°åå’Œè¯·æ±‚å‚æ•°åä¸€è‡´ï¼š
â€¢ åŸºæœ¬ç±»å‹è‡ªåŠ¨è½¬æ¢
â€¢ å¯¹è±¡è‡ªåŠ¨å°è£…
â€¢ æ•°ç»„è‡ªåŠ¨æ¥æ”¶å¤šå€¼

ä¸ç”¨æ‰‹åŠ¨getParameter()ï¼ŒSpringéƒ½å¸®ä½ åšäº†ï¼
```

**ğŸ”¹ æ•°æ®ä¼ é€’çš„ä¸‰ç§åœºæ™¯**
```
åœºæ™¯1ï¼šè½¬å‘æˆ–æ™®é€šè·³è½¬
â†’ ç”¨Modelæˆ–ModelAndView

åœºæ™¯2ï¼šé‡å®šå‘
â†’ ç”¨RedirectAttributes

åœºæ™¯3ï¼šè¿”å›JSON
â†’ ç›´æ¥returnå¯¹è±¡
```

### 8.3 å®é™…å¼€å‘å»ºè®®


**ä»£ç è§„èŒƒ**ï¼š
```java
// âœ… æ¨èå†™æ³•
@RestController
@RequestMapping("/api/user")
public class UserApiController {
    
    @Autowired
    private UserService userService;
    
    @GetMapping("/{id}")
    public User getUser(@PathVariable Long id) {
        return userService.findById(id);
    }
}

// æ¸…æ™°æ˜äº†ï¼š
// 1. ç±»ä¸ŠåŠ @RestControllerï¼Œè¿”å›JSON
// 2. @RequestMappingç»Ÿä¸€è·¯å¾„å‰ç¼€
// 3. æ–¹æ³•èŒè´£å•ä¸€
```

**å¸¸è§è¯¯åŒºé¿å…**ï¼š
```
âŒ è¯¯åŒº1ï¼š@Controllerä¸‹è¿”å›å¯¹è±¡æœŸæœ›è¿”å›JSON
   æ­£ç¡®ï¼šè¦ç”¨@RestControlleræˆ–åŠ @ResponseBody

âŒ è¯¯åŒº2ï¼šé‡å®šå‘ç”¨Modelä¼ æ•°æ®
   æ­£ç¡®ï¼šè¦ç”¨RedirectAttributes

âŒ è¯¯åŒº3ï¼šå‚æ•°åå’Œè¯·æ±‚å‚æ•°åä¸ä¸€è‡´
   æ­£ç¡®ï¼šç¡®ä¿ä¸€è‡´ï¼Œæˆ–ç”¨@RequestParamæŒ‡å®š
```

### 8.4 å­¦ä¹ è·¯å¾„å»ºè®®


**åˆå­¦è€…ä¸‰æ­¥èµ°**ï¼š
```
ç¬¬1æ­¥ï¼šæŒæ¡@Controllerï¼Œå­¦ä¼šæ¥æ”¶å‚æ•°å’Œè¿”å›é¡µé¢
ç¬¬2æ­¥ï¼šç†è§£@RestControllerï¼Œå­¦ä¼šè¿”å›JSONæ•°æ®
ç¬¬3æ­¥ï¼šæŒæ¡æ•°æ®ä¼ é€’ï¼Œç‰¹åˆ«æ˜¯é‡å®šå‘ä¼ å€¼

å®è·µå»ºè®®ï¼š
æ¯ä¸ªçŸ¥è¯†ç‚¹å†™ä¸€ä¸ªå°demoéªŒè¯ï¼Œæ¯”çœ‹åéæ–‡æ¡£ç®¡ç”¨ï¼
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
æ§åˆ¶å™¨å¤„ç†è¯·æ±‚ï¼Œæ³¨è§£æ ‡è¯†å¾ˆé‡è¦
å‚æ•°ç»‘å®šè¦è‡ªåŠ¨ï¼Œè¿”å›ç±»å‹åˆ†æ¸…æ¥š
Modelä¼ å€¼åˆ°é¡µé¢ï¼Œé‡å®šå‘ç”¨Attributes
å‰ååˆ†ç¦»ç”¨RestControllerï¼Œè¿”å›JSONæ•°æ®æ›´æ¸…æ™°
```