---
title: 6ã€SpringMVCæ ¸å¿ƒ
---
## ğŸ“š ç›®å½•å¯¼èˆª

1. [è¯·æ±‚æ˜ å°„ä¸å‚æ•°ç»‘å®š](#1-è¯·æ±‚æ˜ å°„ä¸å‚æ•°ç»‘å®š)
2. [æ•°æ®æ ¡éªŒä¸å¼‚å¸¸å¤„ç†](#2-æ•°æ®æ ¡éªŒä¸å¼‚å¸¸å¤„ç†)
3. [æ‹¦æˆªå™¨ä¸è·¨åŸŸå¤„ç†](#3-æ‹¦æˆªå™¨ä¸è·¨åŸŸå¤„ç†)
4. [RESTful APIè®¾è®¡](#4-restful-apiè®¾è®¡)
5. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#5-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ è¯·æ±‚æ˜ å°„ä¸å‚æ•°ç»‘å®š


### 1.1 ä»€ä¹ˆæ˜¯è¯·æ±‚æ˜ å°„


ğŸŒ° **ç”Ÿæ´»ç±»æ¯”**: æƒ³è±¡ä½ åœ¨é¤å…ç‚¹é¤ï¼ŒæœåŠ¡å‘˜æŠŠä½ çš„è®¢å•ï¼ˆè¯·æ±‚ï¼‰é€åˆ°å¯¹åº”çš„å¨å¸ˆï¼ˆå¤„ç†æ–¹æ³•ï¼‰é‚£é‡Œã€‚è¯·æ±‚æ˜ å°„å°±æ˜¯è¿™ä¸ª"é€å•"çš„è¿‡ç¨‹ã€‚

**æ ¸å¿ƒæ¦‚å¿µ**: è¯·æ±‚æ˜ å°„å°±æ˜¯æŠŠæµè§ˆå™¨å‘æ¥çš„è¯·æ±‚ï¼ˆæ¯”å¦‚è®¿é—®æŸä¸ªç½‘å€ï¼‰å’Œåç«¯çš„å¤„ç†æ–¹æ³•å…³è”èµ·æ¥ã€‚

```
ç”¨æˆ·è®¿é—®ï¼šhttp://localhost:8080/user/list
         â†“
SpringMVCè‡ªåŠ¨æ‰¾åˆ°ï¼šUserControllerçš„list()æ–¹æ³•
         â†“
æ‰§è¡Œæ–¹æ³•å¹¶è¿”å›ç»“æœ
```

### 1.2 @RequestMappingæ³¨è§£è¯¦è§£


**ğŸ”¸ åŸºç¡€ç”¨æ³•**: è¿™æ˜¯SpringMVCæœ€æ ¸å¿ƒçš„æ³¨è§£ï¼Œå‘Šè¯‰æ¡†æ¶"å“ªä¸ªè¯·æ±‚è¯¥æ‰¾å“ªä¸ªæ–¹æ³•"

```java
@Controller
@RequestMapping("/user")  // ç±»çº§åˆ«ï¼šæ‰€æœ‰æ–¹æ³•çš„å…¬å…±å‰ç¼€
public class UserController {
    
    // æ–¹æ³•çº§åˆ«ï¼šå…·ä½“çš„è·¯å¾„
    @RequestMapping("/list")
    public String getUserList() {
        // å¤„ç† /user/list è¯·æ±‚
        return "userList";
    }
}
```

**ğŸ”¸ è¯·æ±‚æ–¹å¼é™å®š**: ä¸åŒçš„æ“ä½œç”¨ä¸åŒçš„HTTPæ–¹æ³•

| HTTPæ–¹æ³• | **ä½œç”¨è¯´æ˜** | **å®é™…ä¾‹å­** | **æ³¨è§£å†™æ³•** |
|---------|------------|------------|------------|
| ğŸŸ¢ **GET** | `æŸ¥è¯¢æ•°æ®` | `æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨` | `@GetMapping` |
| ğŸ”µ **POST** | `æäº¤æ•°æ®` | `æ³¨å†Œæ–°ç”¨æˆ·` | `@PostMapping` |
| ğŸŸ¡ **PUT** | `æ›´æ–°æ•°æ®` | `ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯` | `@PutMapping` |
| ğŸ”´ **DELETE** | `åˆ é™¤æ•°æ®` | `åˆ é™¤ç”¨æˆ·` | `@DeleteMapping` |

```java
@RestController
@RequestMapping("/user")
public class UserController {
    
    // GETè¯·æ±‚ï¼šæŸ¥è¯¢ç”¨æˆ·
    @GetMapping("/{id}")
    public User getUser(@PathVariable Long id) {
        return userService.getById(id);
    }
    
    // POSTè¯·æ±‚ï¼šæ–°å¢ç”¨æˆ·
    @PostMapping
    public String addUser(@RequestBody User user) {
        userService.save(user);
        return "æ·»åŠ æˆåŠŸ";
    }
}
```

### 1.3 å‚æ•°ç»‘å®šçš„æ–¹å¼


#### 1.3.1 è·¯å¾„å‚æ•° @PathVariable


ğŸ’¡ **ç†è§£è¦ç‚¹**: æŠŠç½‘å€çš„ä¸€éƒ¨åˆ†å½“ä½œå‚æ•°ä½¿ç”¨

```
è¯·æ±‚URLï¼š/user/123
æå–å‚æ•°ï¼šid = 123
```

```java
// è®¿é—® /user/100 å°±èƒ½è·å–IDä¸º100çš„ç”¨æˆ·
@GetMapping("/user/{id}")
public User getUser(@PathVariable Long id) {
    // idä¼šè‡ªåŠ¨ç­‰äº100
    return userService.getById(id);
}

// å¤šä¸ªè·¯å¾„å‚æ•°
@GetMapping("/order/{userId}/{orderId}")
public Order getOrder(
    @PathVariable Long userId,
    @PathVariable Long orderId
) {
    return orderService.get(userId, orderId);
}
```

#### 1.3.2 æŸ¥è¯¢å‚æ•° @RequestParam


ğŸ’¡ **ç†è§£è¦ç‚¹**: å¤„ç†URLåé¢è·Ÿçš„å‚æ•°ï¼ˆ?å·åé¢çš„éƒ¨åˆ†ï¼‰

```
è¯·æ±‚URLï¼š/user/search?name=å¼ ä¸‰&age=20
æå–å‚æ•°ï¼šname="å¼ ä¸‰", age=20
```

```java
@GetMapping("/search")
public List<User> search(
    @RequestParam String name,           // å¿…å¡«å‚æ•°
    @RequestParam(required = false) Integer age  // å¯é€‰å‚æ•°
) {
    return userService.search(name, age);
}

// è®¾ç½®é»˜è®¤å€¼
@GetMapping("/list")
public List<User> list(
    @RequestParam(defaultValue = "1") int page,
    @RequestParam(defaultValue = "10") int size
) {
    return userService.page(page, size);
}
```

#### 1.3.3 è¯·æ±‚ä½“å‚æ•° @RequestBody


ğŸ’¡ **ç†è§£è¦ç‚¹**: æ¥æ”¶å‰ç«¯å‘é€çš„JSONæ•°æ®

```
å‰ç«¯å‘é€JSONï¼š
{
  "name": "å¼ ä¸‰",
  "age": 20,
  "email": "zhangsan@qq.com"
}

åç«¯è‡ªåŠ¨è½¬æ¢æˆUserå¯¹è±¡
```

```java
@PostMapping("/register")
public String register(@RequestBody User user) {
    // userå¯¹è±¡å·²ç»åŒ…å«äº†å‰ç«¯å‘é€çš„æ‰€æœ‰æ•°æ®
    System.out.println(user.getName());  // å¼ ä¸‰
    System.out.println(user.getAge());   // 20
    userService.save(user);
    return "æ³¨å†ŒæˆåŠŸ";
}
```

#### 1.3.4 è¯·æ±‚å¤´å‚æ•° @RequestHeader


ğŸ’¡ **ç†è§£è¦ç‚¹**: è·å–HTTPè¯·æ±‚å¤´çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚tokenã€è®¾å¤‡ä¿¡æ¯ç­‰ï¼‰

```java
@GetMapping("/info")
public String getUserInfo(
    @RequestHeader("Authorization") String token,
    @RequestHeader(value = "User-Agent", required = false) String userAgent
) {
    // éªŒè¯token
    if (tokenService.validate(token)) {
        return "ç”¨æˆ·ä¿¡æ¯";
    }
    return "æœªæˆæƒ";
}
```

### 1.4 å‚æ•°ç»‘å®šå®æˆ˜æŠ€å·§


**ğŸ”¸ å¯¹è±¡è‡ªåŠ¨ç»‘å®š**: è¡¨å•å‚æ•°è‡ªåŠ¨å¡«å……åˆ°å¯¹è±¡

```java
// å‰ç«¯è¡¨å•ï¼šname=å¼ ä¸‰&age=20&email=zhangsan@qq.com
@PostMapping("/update")
public String update(User user) {
    // SpringMVCè‡ªåŠ¨æŠŠè¡¨å•æ•°æ®å¡«å……åˆ°userå¯¹è±¡
    // ä¸éœ€è¦ä¸€ä¸ªä¸ªå–å‚æ•°
    userService.update(user);
    return "æ›´æ–°æˆåŠŸ";
}
```

**ğŸ”¸ æ—¥æœŸæ ¼å¼å¤„ç†**: å‰ç«¯ä¼ æ¥çš„æ—¥æœŸå­—ç¬¦ä¸²è½¬æ¢æˆDateå¯¹è±¡

```java
public class User {
    private String name;
    
    // æŒ‡å®šæ—¥æœŸæ ¼å¼
    @DateTimeFormat(pattern = "yyyy-MM-dd")
    private Date birthday;
}

// å‰ç«¯ä¼ : birthday=2000-01-01
// åç«¯è‡ªåŠ¨è½¬æ¢æˆDateå¯¹è±¡
```

**ğŸ”¸ æ•°ç»„å’Œé›†åˆå‚æ•°**

```java
// æ¥æ”¶å¤šä¸ªIDï¼š/delete?ids=1&ids=2&ids=3
@DeleteMapping("/delete")
public String batchDelete(@RequestParam List<Long> ids) {
    userService.removeByIds(ids);
    return "æ‰¹é‡åˆ é™¤æˆåŠŸ";
}
```

---

## 2. âœ… æ•°æ®æ ¡éªŒä¸å¼‚å¸¸å¤„ç†


### 2.1 ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®æ ¡éªŒ


âš ï¸ **ç°å®é—®é¢˜**: 
- ç”¨æˆ·å¯èƒ½è¾“å…¥éæ³•æ•°æ®ï¼šå¹´é¾„å¡«å†™-1å²ã€é‚®ç®±æ ¼å¼é”™è¯¯
- æ¶æ„ç”¨æˆ·å¯èƒ½æ³¨å…¥æ”»å‡»ä»£ç 
- å‰ç«¯æ ¡éªŒå¯ä»¥è¢«ç»•è¿‡ï¼Œåç«¯å¿…é¡»å†æ¬¡æ ¡éªŒ

ğŸ¯ **è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨Java Bean Validationè¿›è¡Œç»Ÿä¸€æ ¡éªŒ

### 2.2 å¸¸ç”¨æ ¡éªŒæ³¨è§£


| æ³¨è§£ | **ä½œç”¨** | **ä½¿ç”¨åœºæ™¯** | **ç¤ºä¾‹** |
|------|---------|------------|---------|
| `@NotNull` | `ä¸èƒ½ä¸ºnull` | `å¿…å¡«å­—æ®µ` | `ç”¨æˆ·ID` |
| `@NotEmpty` | `ä¸èƒ½ä¸ºç©º` | `å­—ç¬¦ä¸²ã€é›†åˆ` | `ç”¨æˆ·å` |
| `@NotBlank` | `ä¸èƒ½ä¸ºç©ºç™½` | `å»é™¤ç©ºæ ¼åä¸èƒ½ä¸ºç©º` | `çœŸå®å§“å` |
| `@Size` | `é•¿åº¦é™åˆ¶` | `å­—ç¬¦ä¸²ã€é›†åˆé•¿åº¦` | `å¯†ç 6-20ä½` |
| `@Min/@Max` | `æ•°å€¼èŒƒå›´` | `å¹´é¾„ã€ä»·æ ¼ç­‰` | `å¹´é¾„0-150` |
| `@Email` | `é‚®ç®±æ ¼å¼` | `ç”µå­é‚®ç®±` | `user@qq.com` |
| `@Pattern` | `æ­£åˆ™åŒ¹é…` | `æ‰‹æœºå·ã€èº«ä»½è¯` | `11ä½æ‰‹æœºå·` |

### 2.3 æ•°æ®æ ¡éªŒå®æˆ˜


**ğŸ”¸ æ­¥éª¤ä¸€: åœ¨å®ä½“ç±»ä¸Šæ·»åŠ æ ¡éªŒæ³¨è§£**

```java
public class UserDTO {
    
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @Size(min = 3, max = 20, message = "ç”¨æˆ·åé•¿åº¦3-20ä½")
    private String username;
    
    @NotBlank(message = "å¯†ç ä¸èƒ½ä¸ºç©º")
    @Pattern(regexp = "^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d).{6,}$", 
             message = "å¯†ç è‡³å°‘6ä½ï¼ŒåŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—")
    private String password;
    
    @NotNull(message = "å¹´é¾„ä¸èƒ½ä¸ºç©º")
    @Min(value = 0, message = "å¹´é¾„ä¸èƒ½å°äº0")
    @Max(value = 150, message = "å¹´é¾„ä¸èƒ½å¤§äº150")
    private Integer age;
    
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String email;
}
```

**ğŸ”¸ æ­¥éª¤äºŒ: åœ¨Controlleræ–¹æ³•ä¸­å¯ç”¨æ ¡éªŒ**

```java
@RestController
@RequestMapping("/user")
public class UserController {
    
    // @Valid æˆ– @Validated å¯ç”¨æ ¡éªŒ
    // BindingResult æ¥æ”¶æ ¡éªŒç»“æœ
    @PostMapping("/register")
    public String register(@Valid @RequestBody UserDTO user, 
                          BindingResult result) {
        
        // å¦‚æœæ ¡éªŒå¤±è´¥
        if (result.hasErrors()) {
            // è·å–ç¬¬ä¸€ä¸ªé”™è¯¯ä¿¡æ¯
            String errorMsg = result.getFieldError().getDefaultMessage();
            return "æ ¡éªŒå¤±è´¥: " + errorMsg;
        }
        
        userService.register(user);
        return "æ³¨å†ŒæˆåŠŸ";
    }
}
```

### 2.4 å…¨å±€å¼‚å¸¸å¤„ç†


ğŸ’¡ **æ ¸å¿ƒæ€æƒ³**: æŠŠæ‰€æœ‰å¼‚å¸¸ç»Ÿä¸€åœ¨ä¸€ä¸ªåœ°æ–¹å¤„ç†ï¼Œä¸ç”¨åœ¨æ¯ä¸ªæ–¹æ³•é‡Œå†™try-catch

**ğŸ”¸ åˆ›å»ºå…¨å±€å¼‚å¸¸å¤„ç†å™¨**

```java
@RestControllerAdvice  // å…¨å±€å¼‚å¸¸å¤„ç†æ³¨è§£
public class GlobalExceptionHandler {
    
    // å¤„ç†å‚æ•°æ ¡éªŒå¼‚å¸¸
    @ExceptionHandler(MethodArgumentNotValidException.class)
    public Result handleValidException(MethodArgumentNotValidException e) {
        String errorMsg = e.getBindingResult()
                          .getFieldError()
                          .getDefaultMessage();
        return Result.error("å‚æ•°æ ¡éªŒå¤±è´¥: " + errorMsg);
    }
    
    // å¤„ç†ä¸šåŠ¡å¼‚å¸¸
    @ExceptionHandler(BusinessException.class)
    public Result handleBusinessException(BusinessException e) {
        return Result.error(e.getMessage());
    }
    
    // å¤„ç†æ‰€æœ‰å…¶ä»–å¼‚å¸¸
    @ExceptionHandler(Exception.class)
    public Result handleException(Exception e) {
        e.printStackTrace();
        return Result.error("ç³»ç»Ÿå¼‚å¸¸ï¼Œè¯·è”ç³»ç®¡ç†å‘˜");
    }
}
```

**ğŸ”¸ ç»Ÿä¸€è¿”å›ç»“æœå°è£…**

```java
public class Result<T> {
    private Integer code;    // çŠ¶æ€ç 
    private String message;  // æç¤ºä¿¡æ¯
    private T data;         // è¿”å›æ•°æ®
    
    public static <T> Result<T> success(T data) {
        Result<T> result = new Result<>();
        result.setCode(200);
        result.setMessage("æˆåŠŸ");
        result.setData(data);
        return result;
    }
    
    public static Result error(String message) {
        Result result = new Result();
        result.setCode(500);
        result.setMessage(message);
        return result;
    }
}
```

**ğŸ”¸ ä½¿ç”¨æ•ˆæœ**

```
å¼‚å¸¸å‘ç”Ÿæµç¨‹ï¼š

Controlleræ–¹æ³•æŠ›å‡ºå¼‚å¸¸
         â†“
å…¨å±€å¼‚å¸¸å¤„ç†å™¨æ•è·
         â†“
è¿”å›ç»Ÿä¸€æ ¼å¼çš„é”™è¯¯ä¿¡æ¯
         â†“
å‰ç«¯æ”¶åˆ°å‹å¥½çš„æç¤º
```

---

## 3. ğŸ” æ‹¦æˆªå™¨ä¸è·¨åŸŸå¤„ç†


### 3.1 ä»€ä¹ˆæ˜¯æ‹¦æˆªå™¨


ğŸŒ° **ç”Ÿæ´»ç±»æ¯”**: æ‹¦æˆªå™¨å°±åƒå…¬å¸é—¨å£çš„ä¿å®‰ï¼Œåœ¨ä½ è¿›å…¥åŠå…¬åŒºä¹‹å‰è¦éªŒè¯ä½ çš„å·¥ç‰Œã€‚

**æ ¸å¿ƒæ¦‚å¿µ**: æ‹¦æˆªå™¨åœ¨è¯·æ±‚åˆ°è¾¾Controllerä¹‹å‰/ä¹‹åæ‰§è¡Œä¸€äº›é€šç”¨æ“ä½œ

```
è¯·æ±‚æµç¨‹ï¼š

æµè§ˆå™¨è¯·æ±‚ 
   â†“
æ‹¦æˆªå™¨preHandle (è¯·æ±‚å‰)
   â†“
Controlleræ–¹æ³•
   â†“
æ‹¦æˆªå™¨postHandle (è¯·æ±‚å)
   â†“
è¿”å›å“åº”
```

### 3.2 æ‹¦æˆªå™¨çš„å®ç°æ­¥éª¤


**ğŸ”¸ æ­¥éª¤ä¸€: åˆ›å»ºæ‹¦æˆªå™¨ç±»**

```java
public class LoginInterceptor implements HandlerInterceptor {
    
    // è¯·æ±‚å¤„ç†å‰æ‰§è¡Œ
    @Override
    public boolean preHandle(HttpServletRequest request, 
                           HttpServletResponse response, 
                           Object handler) {
        
        // ä»è¯·æ±‚å¤´è·å–token
        String token = request.getHeader("Authorization");
        
        // éªŒè¯token
        if (token == null || !tokenService.validate(token)) {
            response.setStatus(401);
            return false;  // è¿”å›falseï¼Œæ‹¦æˆªè¯·æ±‚ï¼Œä¸æ‰§è¡ŒController
        }
        
        return true;  // è¿”å›trueï¼Œæ”¾è¡Œè¯·æ±‚
    }
    
    // è¯·æ±‚å¤„ç†åæ‰§è¡Œï¼ˆControlleræ–¹æ³•æ‰§è¡Œåï¼‰
    @Override
    public void postHandle(HttpServletRequest request, 
                          HttpServletResponse response, 
                          Object handler, 
                          ModelAndView modelAndView) {
        // è®°å½•æ—¥å¿—ã€ä¿®æ”¹å“åº”ç­‰
        System.out.println("è¯·æ±‚å¤„ç†å®Œæˆ");
    }
    
    // è¯·æ±‚å®Œæˆåæ‰§è¡Œï¼ˆè§†å›¾æ¸²æŸ“åï¼‰
    @Override
    public void afterCompletion(HttpServletRequest request, 
                               HttpServletResponse response, 
                               Object handler, 
                               Exception ex) {
        // èµ„æºæ¸…ç†ã€æ€§èƒ½ç»Ÿè®¡ç­‰
    }
}
```

**ğŸ”¸ æ­¥éª¤äºŒ: æ³¨å†Œæ‹¦æˆªå™¨**

```java
@Configuration
public class WebConfig implements WebMvcConfigurer {
    
    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        registry.addInterceptor(new LoginInterceptor())
                .addPathPatterns("/**")           // æ‹¦æˆªæ‰€æœ‰è¯·æ±‚
                .excludePathPatterns(             // æ’é™¤è¿™äº›è·¯å¾„
                    "/user/login",
                    "/user/register",
                    "/static/**"
                );
    }
}
```

### 3.3 æ‹¦æˆªå™¨çš„åº”ç”¨åœºæ™¯


**ğŸ¯ å¸¸è§ç”¨é€”**

| åœºæ™¯ | **è¯´æ˜** | **å®ç°æ–¹å¼** |
|------|---------|------------|
| ğŸ” **ç™»å½•éªŒè¯** | `æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»å½•` | `éªŒè¯tokenæˆ–session` |
| ğŸ“ **æ—¥å¿—è®°å½•** | `è®°å½•è¯·æ±‚ä¿¡æ¯` | `è®°å½•URLã€å‚æ•°ã€è€—æ—¶` |
| ğŸ”‘ **æƒé™æ§åˆ¶** | `æ£€æŸ¥ç”¨æˆ·æƒé™` | `éªŒè¯è§’è‰²å’Œæƒé™` |
| â±ï¸ **æ€§èƒ½ç›‘æ§** | `ç»Ÿè®¡æ¥å£è€—æ—¶` | `è®°å½•å¼€å§‹å’Œç»“æŸæ—¶é—´` |

**ç¤ºä¾‹: æ—¥å¿—æ‹¦æˆªå™¨**

```java
public class LogInterceptor implements HandlerInterceptor {
    
    @Override
    public boolean preHandle(HttpServletRequest request, 
                           HttpServletResponse response, 
                           Object handler) {
        
        // è®°å½•è¯·æ±‚å¼€å§‹æ—¶é—´
        long startTime = System.currentTimeMillis();
        request.setAttribute("startTime", startTime);
        
        // è®°å½•è¯·æ±‚ä¿¡æ¯
        System.out.println("è¯·æ±‚URL: " + request.getRequestURI());
        System.out.println("è¯·æ±‚æ–¹æ³•: " + request.getMethod());
        
        return true;
    }
    
    @Override
    public void afterCompletion(HttpServletRequest request, 
                               HttpServletResponse response, 
                               Object handler, 
                               Exception ex) {
        
        // è®¡ç®—è€—æ—¶
        long startTime = (Long) request.getAttribute("startTime");
        long endTime = System.currentTimeMillis();
        
        System.out.println("è¯·æ±‚è€—æ—¶: " + (endTime - startTime) + "ms");
    }
}
```

### 3.4 è·¨åŸŸé—®é¢˜ä¸è§£å†³


**ğŸ”¸ ä»€ä¹ˆæ˜¯è·¨åŸŸ**

ğŸ’¡ **é€šä¿—ç†è§£**: æµè§ˆå™¨çš„å®‰å…¨æœºåˆ¶ï¼Œä¸å…è®¸ç½‘é¡µè®¿é—®ä¸åŒåŸŸå/ç«¯å£çš„æ¥å£

```
å‰ç«¯åœ°å€ï¼šhttp://localhost:3000
åç«¯åœ°å€ï¼šhttp://localhost:8080

è¿™å°±æ˜¯è·¨åŸŸï¼æµè§ˆå™¨é»˜è®¤ä¼šæ‹¦æˆªè¯·æ±‚
```

**ğŸ”¸ è·¨åŸŸé”™è¯¯æç¤º**

```
Access to XMLHttpRequest at 'http://localhost:8080/user/list' 
from origin 'http://localhost:3000' has been blocked by CORS policy
```

**ğŸ”¸ è§£å†³æ–¹æ¡ˆä¸€: å…¨å±€é…ç½®**

```java
@Configuration
public class CorsConfig implements WebMvcConfigurer {
    
    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/**")              // æ‰€æœ‰æ¥å£
                .allowedOrigins("*")            // å…è®¸æ‰€æœ‰æ¥æº
                .allowedMethods("*")            // å…è®¸æ‰€æœ‰æ–¹æ³•
                .allowedHeaders("*")            // å…è®¸æ‰€æœ‰è¯·æ±‚å¤´
                .allowCredentials(true)         // å…è®¸æºå¸¦cookie
                .maxAge(3600);                  // é¢„æ£€è¯·æ±‚ç¼“å­˜æ—¶é—´
    }
}
```

**ğŸ”¸ è§£å†³æ–¹æ¡ˆäºŒ: æ³¨è§£æ–¹å¼**

```java
@RestController
@CrossOrigin  // å…è®¸è·¨åŸŸ
public class UserController {
    
    @GetMapping("/list")
    public List<User> list() {
        return userService.list();
    }
}
```

---

## 4. ğŸš€ RESTful APIè®¾è®¡


### 4.1 ä»€ä¹ˆæ˜¯RESTful


ğŸ’¡ **é€šä¿—ç†è§£**: RESTfulæ˜¯ä¸€ç§è®¾è®¡é£æ ¼ï¼Œè®©APIæ¥å£æ›´è§„èŒƒã€æ›´æ˜“ç†è§£

**æ ¸å¿ƒåŸåˆ™**: 
- ç”¨URLå®šä½èµ„æºï¼ˆåè¯ï¼‰
- ç”¨HTTPæ–¹æ³•è¡¨ç¤ºæ“ä½œï¼ˆåŠ¨è¯ï¼‰
- è¿”å›æ ‡å‡†çš„HTTPçŠ¶æ€ç 

### 4.2 RESTful vs ä¼ ç»ŸAPIå¯¹æ¯”


**ğŸ”¸ ä¼ ç»ŸAPIè®¾è®¡**

```
è·å–ç”¨æˆ·åˆ—è¡¨ï¼šGET  /getUserList
è·å–å•ä¸ªç”¨æˆ·ï¼šGET  /getUser?id=1
æ–°å¢ç”¨æˆ·ï¼š    POST /addUser
ä¿®æ”¹ç”¨æˆ·ï¼š    POST /updateUser
åˆ é™¤ç”¨æˆ·ï¼š    POST /deleteUser
```

**ğŸ”¸ RESTful APIè®¾è®¡**

```
è·å–ç”¨æˆ·åˆ—è¡¨ï¼šGET    /users
è·å–å•ä¸ªç”¨æˆ·ï¼šGET    /users/1
æ–°å¢ç”¨æˆ·ï¼š    POST   /users
ä¿®æ”¹ç”¨æˆ·ï¼š    PUT    /users/1
åˆ é™¤ç”¨æˆ·ï¼š    DELETE /users/1
```

### 4.3 RESTfulè®¾è®¡è§„èŒƒ


**ğŸ”¸ URLè®¾è®¡åŸåˆ™**

| è§„èŒƒ | **è¯´æ˜** | **æ­£ç¡®ç¤ºä¾‹** | **é”™è¯¯ç¤ºä¾‹** |
|------|---------|------------|------------|
| âœ… **ç”¨åè¯** | `URLè¡¨ç¤ºèµ„æº` | `/users` | `/getUsers` |
| âœ… **ç”¨å¤æ•°** | `èµ„æºç”¨å¤æ•°å½¢å¼` | `/users/1` | `/user/1` |
| âœ… **åµŒå¥—å…³ç³»** | `ä½“ç°èµ„æºå…³ç³»` | `/users/1/orders` | `/getUserOrders?id=1` |
| âœ… **å°å†™å­—æ¯** | `URLå…¨éƒ¨å°å†™` | `/user-orders` | `/UserOrders` |

**ğŸ”¸ HTTPæ–¹æ³•ä½¿ç”¨**

```
GET     æŸ¥è¯¢èµ„æºï¼ˆå®‰å…¨ã€å¹‚ç­‰ï¼‰
POST    åˆ›å»ºèµ„æº
PUT     å®Œæ•´æ›´æ–°èµ„æºï¼ˆå¹‚ç­‰ï¼‰
PATCH   éƒ¨åˆ†æ›´æ–°èµ„æº
DELETE  åˆ é™¤èµ„æºï¼ˆå¹‚ç­‰ï¼‰
```

> ğŸ’¡ **å¹‚ç­‰æ€§è¯´æ˜**  
> å¹‚ç­‰ï¼šå¤šæ¬¡æ‰§è¡Œç»“æœç›¸åŒã€‚æ¯”å¦‚åˆ é™¤ID=1çš„ç”¨æˆ·ï¼Œåˆ 1æ¬¡å’Œåˆ 10æ¬¡ç»“æœä¸€æ ·

### 4.4 RESTful APIå®æˆ˜ç¤ºä¾‹


**ğŸ”¸ ç”¨æˆ·èµ„æºçš„å®Œæ•´API**

```java
@RestController
@RequestMapping("/users")
public class UserController {
    
    // æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µã€æœç´¢ï¼‰
    @GetMapping
    public Result<Page<User>> list(
        @RequestParam(defaultValue = "1") int page,
        @RequestParam(defaultValue = "10") int size,
        @RequestParam(required = false) String keyword
    ) {
        Page<User> userPage = userService.page(page, size, keyword);
        return Result.success(userPage);
    }
    
    // æŸ¥è¯¢å•ä¸ªç”¨æˆ·
    @GetMapping("/{id}")
    public Result<User> getById(@PathVariable Long id) {
        User user = userService.getById(id);
        return Result.success(user);
    }
    
    // æ–°å¢ç”¨æˆ·
    @PostMapping
    public Result<String> add(@Valid @RequestBody UserDTO userDTO) {
        userService.save(userDTO);
        return Result.success("åˆ›å»ºæˆåŠŸ");
    }
    
    // å®Œæ•´æ›´æ–°ç”¨æˆ·
    @PutMapping("/{id}")
    public Result<String> update(
        @PathVariable Long id,
        @Valid @RequestBody UserDTO userDTO
    ) {
        userService.updateById(id, userDTO);
        return Result.success("æ›´æ–°æˆåŠŸ");
    }
    
    // éƒ¨åˆ†æ›´æ–°ç”¨æˆ·ï¼ˆåªæ›´æ–°ä¼ å…¥çš„å­—æ®µï¼‰
    @PatchMapping("/{id}")
    public Result<String> patch(
        @PathVariable Long id,
        @RequestBody Map<String, Object> updates
    ) {
        userService.patchUpdate(id, updates);
        return Result.success("æ›´æ–°æˆåŠŸ");
    }
    
    // åˆ é™¤ç”¨æˆ·
    @DeleteMapping("/{id}")
    public Result<String> delete(@PathVariable Long id) {
        userService.removeById(id);
        return Result.success("åˆ é™¤æˆåŠŸ");
    }
    
    // æ‰¹é‡åˆ é™¤
    @DeleteMapping
    public Result<String> batchDelete(@RequestBody List<Long> ids) {
        userService.removeByIds(ids);
        return Result.success("æ‰¹é‡åˆ é™¤æˆåŠŸ");
    }
}
```

**ğŸ”¸ åµŒå¥—èµ„æºç¤ºä¾‹**

```java
// è·å–æŸä¸ªç”¨æˆ·çš„æ‰€æœ‰è®¢å•
@GetMapping("/users/{userId}/orders")
public Result<List<Order>> getUserOrders(@PathVariable Long userId) {
    List<Order> orders = orderService.getByUserId(userId);
    return Result.success(orders);
}

// è·å–æŸä¸ªç”¨æˆ·çš„æŸä¸ªè®¢å•
@GetMapping("/users/{userId}/orders/{orderId}")
public Result<Order> getOrder(
    @PathVariable Long userId,
    @PathVariable Long orderId
) {
    Order order = orderService.getByUserAndOrder(userId, orderId);
    return Result.success(order);
}
```

### 4.5 HTTPçŠ¶æ€ç ä½¿ç”¨è§„èŒƒ


| çŠ¶æ€ç  | **å«ä¹‰** | **ä½¿ç”¨åœºæ™¯** |
|-------|---------|------------|
| `200` | æˆåŠŸ | `GET/PUT/PATCHæˆåŠŸ` |
| `201` | å·²åˆ›å»º | `POSTåˆ›å»ºæˆåŠŸ` |
| `204` | æ— å†…å®¹ | `DELETEæˆåŠŸï¼ˆæ— è¿”å›ï¼‰` |
| `400` | è¯·æ±‚é”™è¯¯ | `å‚æ•°æ ¡éªŒå¤±è´¥` |
| `401` | æœªè®¤è¯ | `æœªç™»å½•` |
| `403` | ç¦æ­¢è®¿é—® | `æ— æƒé™` |
| `404` | æœªæ‰¾åˆ° | `èµ„æºä¸å­˜åœ¨` |
| `500` | æœåŠ¡å™¨é”™è¯¯ | `ç³»ç»Ÿå¼‚å¸¸` |

**ä½¿ç”¨ç¤ºä¾‹**

```java
@GetMapping("/{id}")
public ResponseEntity<User> getById(@PathVariable Long id) {
    User user = userService.getById(id);
    if (user == null) {
        return ResponseEntity.status(404).build();  // è¿”å›404
    }
    return ResponseEntity.ok(user);  // è¿”å›200
}

@PostMapping
public ResponseEntity<String> add(@Valid @RequestBody UserDTO userDTO) {
    userService.save(userDTO);
    return ResponseEntity.status(201).body("åˆ›å»ºæˆåŠŸ");  // è¿”å›201
}
```

---

## 5. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 5.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒçŸ¥è¯†


**ğŸ”¸ è¯·æ±‚æ˜ å°„ä¸å‚æ•°ç»‘å®š**
```
âœ… @RequestMappingåŠå…¶è¡ç”Ÿæ³¨è§£çš„ä½¿ç”¨
âœ… @PathVariableã€@RequestParamã€@RequestBodyçš„åŒºåˆ«
âœ… ä¸åŒåœºæ™¯ä¸‹é€‰æ‹©åˆé€‚çš„å‚æ•°ç»‘å®šæ–¹å¼
âœ… æ—¥æœŸã€æ•°ç»„ã€å¯¹è±¡ç­‰ç‰¹æ®Šç±»å‹çš„å‚æ•°å¤„ç†
```

**ğŸ”¸ æ•°æ®æ ¡éªŒä¸å¼‚å¸¸å¤„ç†**
```
âœ… å¸¸ç”¨æ ¡éªŒæ³¨è§£ï¼š@NotNullã€@Sizeã€@Emailç­‰
âœ… @Validå¯ç”¨æ ¡éªŒï¼ŒBindingResultæ¥æ”¶ç»“æœ
âœ… @RestControllerAdviceå…¨å±€å¼‚å¸¸å¤„ç†
âœ… ç»Ÿä¸€è¿”å›ç»“æœå°è£…
```

**ğŸ”¸ æ‹¦æˆªå™¨ä¸è·¨åŸŸå¤„ç†**
```
âœ… HandlerInterceptorä¸‰ä¸ªæ–¹æ³•çš„æ‰§è¡Œæ—¶æœº
âœ… æ‹¦æˆªå™¨çš„æ³¨å†Œå’Œè·¯å¾„é…ç½®
âœ… è·¨åŸŸé—®é¢˜çš„åŸå› å’Œè§£å†³æ–¹æ¡ˆ
âœ… æ‹¦æˆªå™¨åœ¨ç™»å½•éªŒè¯ã€æ—¥å¿—è®°å½•ä¸­çš„åº”ç”¨
```

**ğŸ”¸ RESTful APIè®¾è®¡**
```
âœ… RESTfulæ ¸å¿ƒåŸåˆ™ï¼šèµ„æºå®šä½+HTTPæ–¹æ³•
âœ… URLè®¾è®¡è§„èŒƒï¼šåè¯ã€å¤æ•°ã€å°å†™ã€åµŒå¥—
âœ… HTTPæ–¹æ³•çš„æ­£ç¡®ä½¿ç”¨ï¼šGETã€POSTã€PUTã€DELETE
âœ… æ ‡å‡†HTTPçŠ¶æ€ç çš„è¿”å›
```

### 5.2 å­¦ä¹ è·¯å¾„å»ºè®®


```
ğŸ—ºï¸ æ¨èå­¦ä¹ é¡ºåºï¼š

åŸºç¡€æ˜ å°„ â”€â”€â–¶ å‚æ•°ç»‘å®š â”€â”€â–¶ æ•°æ®æ ¡éªŒ â”€â”€â–¶ å¼‚å¸¸å¤„ç†
    â”‚           â”‚          â”‚          â”‚
    â–¼           â–¼          â–¼          â–¼
  æŒæ¡æ³¨è§£    ç†è§£åœºæ™¯    ä¿è¯å®‰å…¨    ä¼˜é›…å¤„ç†
    
    â†“
    
æ‹¦æˆªå™¨ â”€â”€â–¶ è·¨åŸŸå¤„ç† â”€â”€â–¶ RESTfulè®¾è®¡ â”€â”€â–¶ ç»¼åˆå®æˆ˜
   â”‚          â”‚           â”‚            â”‚
   â–¼          â–¼           â–¼            â–¼
 é€šç”¨é€»è¾‘   è§£å†³é—®é¢˜    è§„èŒƒæ¥å£     é¡¹ç›®åº”ç”¨
```

### 5.3 å®æˆ˜æŠ€å·§æ¸…å•


**ğŸ¯ å¼€å‘ä¸­çš„æœ€ä½³å®è·µ**

- [ ] ç»Ÿä¸€ä½¿ç”¨RESTfulé£æ ¼è®¾è®¡API
- [ ] æ‰€æœ‰æ¥å£éƒ½è¦è¿›è¡Œå‚æ•°æ ¡éªŒ
- [ ] ä½¿ç”¨å…¨å±€å¼‚å¸¸å¤„ç†å™¨ç»Ÿä¸€å¤„ç†å¼‚å¸¸
- [ ] æ•æ„Ÿæ¥å£ä½¿ç”¨æ‹¦æˆªå™¨è¿›è¡Œæƒé™æ§åˆ¶
- [ ] å‰åç«¯åˆ†ç¦»é¡¹ç›®å¿…é¡»é…ç½®è·¨åŸŸ
- [ ] è¿”å›ç»“æœä½¿ç”¨ç»Ÿä¸€çš„æ•°æ®æ ¼å¼
- [ ] åˆç†ä½¿ç”¨HTTPçŠ¶æ€ç 
- [ ] æ¥å£è¦å†™æ¸…æ¥šæ³¨é‡Šï¼ˆSwaggeræ›´ä½³ï¼‰

### 5.4 å¸¸è§é—®é¢˜é€ŸæŸ¥


**â“ å¦‚ä½•é€‰æ‹©å‚æ•°æ¥æ”¶æ–¹å¼ï¼Ÿ**
- å•ä¸ªç®€å•å‚æ•° â†’ `@RequestParam`
- URLè·¯å¾„ä¸­çš„å‚æ•° â†’ `@PathVariable`  
- JSONæ ¼å¼çš„å¤æ‚å¯¹è±¡ â†’ `@RequestBody`
- è¯·æ±‚å¤´ä¿¡æ¯ â†’ `@RequestHeader`

**â“ æ‹¦æˆªå™¨å’Œè¿‡æ»¤å™¨çš„åŒºåˆ«ï¼Ÿ**
- æ‹¦æˆªå™¨ï¼šåŸºäºSpringï¼Œå¯ä»¥è·å–Controllerä¿¡æ¯ï¼Œæ›´çµæ´»
- è¿‡æ»¤å™¨ï¼šåŸºäºServletï¼Œæ›´åº•å±‚ï¼Œåœ¨æ‹¦æˆªå™¨ä¹‹å‰æ‰§è¡Œ

**â“ PUTå’ŒPATCHçš„åŒºåˆ«ï¼Ÿ**
- PUTï¼šå®Œæ•´æ›´æ–°ï¼Œéœ€è¦ä¼ æ‰€æœ‰å­—æ®µ
- PATCHï¼šéƒ¨åˆ†æ›´æ–°ï¼Œåªä¼ è¦ä¿®æ”¹çš„å­—æ®µ

**â“ å¦‚ä½•è§£å†³è·¨åŸŸé—®é¢˜ï¼Ÿ**
- åç«¯é…ç½®CORSï¼ˆæ¨èï¼‰
- ä½¿ç”¨Nginxåå‘ä»£ç†
- JSONPï¼ˆå·²è¿‡æ—¶ï¼‰

---

ğŸ§  **è®°å¿†å£è¯€**
```
è¯·æ±‚æ˜ å°„æ‰¾æ–¹æ³•ï¼Œå‚æ•°ç»‘å®šæœ‰æŠ€å·§
æ•°æ®æ ¡éªŒä¿å®‰å…¨ï¼Œå¼‚å¸¸å¤„ç†è¦ä¼˜é›…
æ‹¦æˆªå™¨ä¸­åŠ é€»è¾‘ï¼Œè·¨åŸŸé…ç½®è§£çƒ¦æ¼
RESTfulè®¾è®¡è§„èŒƒåŒ–ï¼ŒçŠ¶æ€ç è¦ç”¨å¯¹å·
```

â±ï¸ **é¢„è®¡å­¦ä¹ æ—¶é—´**: 8-10å°æ—¶  
ğŸ“– **å‰ç½®çŸ¥è¯†**: SpringåŸºç¡€ã€HTTPåè®®  
ğŸ¯ **å­¦ä¹ ç›®æ ‡**: æŒæ¡SpringMVCæ ¸å¿ƒç‰¹æ€§ï¼Œèƒ½å¤Ÿç‹¬ç«‹å¼€å‘RESTful API