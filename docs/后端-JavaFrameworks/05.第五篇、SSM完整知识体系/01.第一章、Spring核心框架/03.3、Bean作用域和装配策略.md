---
title: 3ã€Beanä½œç”¨åŸŸå’Œè£…é…ç­–ç•¥
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯Beanä½œç”¨åŸŸ](#1-ä»€ä¹ˆæ˜¯Beanä½œç”¨åŸŸ)
2. [äº”å¤§ä½œç”¨åŸŸè¯¦è§£](#2-äº”å¤§ä½œç”¨åŸŸè¯¦è§£)
3. [è‡ªåŠ¨è£…é…ç­–ç•¥](#3-è‡ªåŠ¨è£…é…ç­–ç•¥)
4. [æ³¨è§£å¼è£…é…è¯¦è§£](#4-æ³¨è§£å¼è£…é…è¯¦è§£)
5. [è£…é…å†²çªè§£å†³æ–¹æ¡ˆ](#5-è£…é…å†²çªè§£å†³æ–¹æ¡ˆ)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ä»€ä¹ˆæ˜¯Beanä½œç”¨åŸŸ


### 1.1 é€šä¿—ç†è§£Beanä½œç”¨åŸŸ


**ğŸ¤” æ—¥å¸¸ç”Ÿæ´»ç±»æ¯”**
```
æƒ³è±¡ä¸€ä¸‹ä½ å»å¥¶èŒ¶åº—ç‚¹å•ï¼š

singletonï¼ˆå•ä¾‹ï¼‰æ¨¡å¼ = å¥¶èŒ¶åº—çš„åº—é•¿
- æ•´ä¸ªåº—åªæœ‰ä¸€ä¸ªåº—é•¿
- æ‰€æœ‰é¡¾å®¢éƒ½æ‰¾è¿™ä¸ªåº—é•¿ä¸‹å•
- åº—é•¿ä¸€ç›´åœ¨ï¼Œä¸ä¼šæ¢äºº

prototypeï¼ˆåŸå‹ï¼‰æ¨¡å¼ = æ¯æ¯å¥¶èŒ¶
- æ¯æ¬¡ç‚¹å•éƒ½åšä¸€æ¯æ–°çš„
- ä½ çš„å¥¶èŒ¶å’Œåˆ«äººçš„æ˜¯ç‹¬ç«‹çš„
- å–å®Œå°±æ²¡äº†ï¼Œä¸ä¼šé‡å¤ä½¿ç”¨
```

**ğŸ“‹ å®˜æ–¹å®šä¹‰**
> Beanä½œç”¨åŸŸï¼ˆScopeï¼‰å†³å®šäº†Springå®¹å™¨å¦‚ä½•åˆ›å»ºå’Œç®¡ç†Beanå®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸã€‚ç®€å•è¯´ï¼Œå°±æ˜¯**"è¿™ä¸ªå¯¹è±¡è¦åˆ›å»ºå‡ ä¸ªï¼Ÿä»€ä¹ˆæ—¶å€™åˆ›å»ºï¼Ÿç”¨å¤šä¹…ï¼Ÿ"**

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦ä½œç”¨åŸŸ


**å®é™…åº”ç”¨åœºæ™¯å¯¹æ¯”**

| åœºæ™¯ | é€‚åˆçš„ä½œç”¨åŸŸ | åŸå› è¯´æ˜ |
|------|-------------|---------|
| ğŸ“Š **æ•°æ®åº“è¿æ¥æ± ** | `singleton` | å…¨å±€å…±äº«ï¼Œé¿å…é‡å¤åˆ›å»ºè¿æ¥ |
| ğŸ›’ **ç”¨æˆ·è´­ç‰©è½¦** | `session` | æ¯ä¸ªç”¨æˆ·ç‹¬äº«ï¼Œä¼šè¯æœŸé—´ä¿æŒ |
| ğŸ“ **è¡¨å•æ•°æ®å¯¹è±¡** | `request` | ä¸€æ¬¡è¯·æ±‚å¤„ç†å®Œå°±é”€æ¯ |
| ğŸ”§ **å·¥å…·ç±»å¯¹è±¡** | `singleton` | æ— çŠ¶æ€ï¼Œå¯ä»¥å…¨å±€å¤ç”¨ |
| ğŸ“¦ **ä¸´æ—¶æ•°æ®ä¼ è¾“å¯¹è±¡** | `prototype` | æ¯æ¬¡ä½¿ç”¨éƒ½è¦å…¨æ–°çš„å®ä¾‹ |

---

## 2. ğŸ” äº”å¤§ä½œç”¨åŸŸè¯¦è§£


### 2.1 singleton - å•ä¾‹æ¨¡å¼ â­â­â­â­â­


**ğŸ¯ æ ¸å¿ƒç‰¹ç‚¹**
```
åˆ›å»ºæ—¶æœºï¼šSpringå®¹å™¨å¯åŠ¨æ—¶åˆ›å»ºï¼ˆé»˜è®¤ï¼‰
å®ä¾‹æ•°é‡ï¼šæ•´ä¸ªåº”ç”¨åªæœ‰ä¸€ä¸ªå®ä¾‹
ç”Ÿå‘½å‘¨æœŸï¼šä¸Springå®¹å™¨åŒç”Ÿå…±æ­»
çº¿ç¨‹å®‰å…¨ï¼šéœ€è¦è‡ªå·±ä¿è¯ï¼ˆä¸è‡ªåŠ¨ä¿è¯ï¼‰
ä½¿ç”¨é¢‘ç‡ï¼šâ˜…â˜…â˜…â˜…â˜… æœ€å¸¸ç”¨ï¼Œé»˜è®¤ä½œç”¨åŸŸ
```

**ğŸ’¡ é…ç½®æ–¹å¼å¯¹æ¯”**

XMLé…ç½®æ–¹å¼ï¼š
```xml
<!-- é»˜è®¤å°±æ˜¯singletonï¼Œå¯ä»¥ä¸å†™scope -->
<bean id="userService" class="com.example.UserService"/>

<!-- æ˜¾å¼æŒ‡å®šsingleton -->
<bean id="userService" class="com.example.UserService" scope="singleton"/>
```

æ³¨è§£é…ç½®æ–¹å¼ï¼š
```java
@Component  // é»˜è®¤å°±æ˜¯singleton
@Scope("singleton")  // æ˜¾å¼å£°æ˜
public class UserService {
    // ä¸šåŠ¡ä»£ç 
}
```

**ğŸ” å·¥ä½œåŸç†å›¾è§£**
```
Springå®¹å™¨å¯åŠ¨
    â†“
åˆ›å»ºUserServiceå®ä¾‹
    â†“
å­˜å…¥Springå®¹å™¨çš„å•ä¾‹æ± 
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Springå•ä¾‹æ± (ç¼“å­˜)      â”‚
â”‚  userService: 0x1A2B3C  â”‚ â† å”¯ä¸€å®ä¾‹
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“          â†“          â†“
è¯·æ±‚Aè·å–    è¯·æ±‚Bè·å–    è¯·æ±‚Cè·å–
    â†“          â†“          â†“
  åŒä¸€ä¸ªå¯¹è±¡ 0x1A2B3C (å…±äº«)
```

**âš ï¸ æ³¨æ„äº‹é¡¹**

> **è­¦å‘Š**ï¼šsingleton Beanä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼
> 
> - âœ… **é€‚åˆ**ï¼šå·¥å…·ç±»ã€DAOã€Serviceç­‰**æ— çŠ¶æ€å¯¹è±¡**
> - âŒ **ä¸é€‚åˆ**ï¼šåŒ…å«ç”¨æˆ·æ•°æ®ç­‰**æœ‰çŠ¶æ€å¯¹è±¡**

**å®æˆ˜æ¡ˆä¾‹ï¼šçº¿ç¨‹å®‰å…¨é—®é¢˜**
```java
// âŒ é”™è¯¯ç¤ºä¾‹ï¼šå•ä¾‹Beanä¸­ä½¿ç”¨æˆå‘˜å˜é‡å­˜å‚¨ç”¨æˆ·æ•°æ®
@Service
public class UserService {
    private User currentUser;  // å±é™©ï¼å¤šçº¿ç¨‹å…±äº«
    
    public void processUser(User user) {
        this.currentUser = user;  // çº¿ç¨‹Aå’ŒBä¼šäº’ç›¸è¦†ç›–
        // ä¸šåŠ¡å¤„ç†...
    }
}

// âœ… æ­£ç¡®ç¤ºä¾‹ï¼šä½¿ç”¨å±€éƒ¨å˜é‡æˆ–ThreadLocal
@Service
public class UserService {
    public void processUser(User user) {
        User localUser = user;  // å±€éƒ¨å˜é‡ï¼Œçº¿ç¨‹å®‰å…¨
        // ä¸šåŠ¡å¤„ç†...
    }
}
```

---

### 2.2 prototype - åŸå‹æ¨¡å¼ â­â­â­â­


**ğŸ¯ æ ¸å¿ƒç‰¹ç‚¹**
```
åˆ›å»ºæ—¶æœºï¼šæ¯æ¬¡getBean()æ—¶åˆ›å»º
å®ä¾‹æ•°é‡ï¼šè°ƒç”¨å‡ æ¬¡åˆ›å»ºå‡ ä¸ª
ç”Ÿå‘½å‘¨æœŸï¼šSpringä¸è´Ÿè´£é”€æ¯
çº¿ç¨‹å®‰å…¨ï¼šæ¯ä¸ªçº¿ç¨‹ç‹¬ç«‹å®ä¾‹ï¼Œå¤©ç„¶å®‰å…¨
ä½¿ç”¨é¢‘ç‡ï¼šâ˜…â˜…â˜…â˜…â˜† ç‰¹å®šåœºæ™¯ä½¿ç”¨
```

**ğŸ’¡ é…ç½®æ–¹å¼**

XMLé…ç½®ï¼š
```xml
<bean id="orderForm" class="com.example.OrderForm" scope="prototype"/>
```

æ³¨è§£é…ç½®ï¼š
```java
@Component
@Scope("prototype")  // æˆ– @Scope(ConfigurableBeanFactory.SCOPE_PROTOTYPE)
public class OrderForm {
    private String orderId;
    private List<Item> items = new ArrayList<>();
}
```

**ğŸ” å·¥ä½œåŸç†å¯¹æ¯”**

```
singletonæ¨¡å¼ï¼š
getBean("orderForm") â†’ è¿”å›ç¼“å­˜çš„å®ä¾‹A
getBean("orderForm") â†’ è¿”å›ç¼“å­˜çš„å®ä¾‹A (åŒä¸€ä¸ª)
getBean("orderForm") â†’ è¿”å›ç¼“å­˜çš„å®ä¾‹A (åŒä¸€ä¸ª)

prototypeæ¨¡å¼ï¼š
getBean("orderForm") â†’ æ–°å»ºå®ä¾‹A
getBean("orderForm") â†’ æ–°å»ºå®ä¾‹B (å…¨æ–°çš„)
getBean("orderForm") â†’ æ–°å»ºå®ä¾‹C (å…¨æ–°çš„)
```

**ğŸ“Š å†…å­˜ç®¡ç†å¯¹æ¯”**

| å¯¹æ¯”é¡¹ | singleton | prototype |
|--------|-----------|-----------|
| ğŸ­ **åˆ›å»ºæˆæœ¬** | åªåˆ›å»ºä¸€æ¬¡ï¼Œæˆæœ¬ä½ | æ¯æ¬¡åˆ›å»ºï¼Œæˆæœ¬é«˜ |
| ğŸ’¾ **å†…å­˜å ç”¨** | å›ºå®šå ç”¨ | éšä½¿ç”¨é‡å¢é•¿ |
| ğŸ—‘ï¸ **é”€æ¯ç®¡ç†** | Springè‡ªåŠ¨é”€æ¯ | éœ€è¦æ‰‹åŠ¨ç®¡ç† |
| ğŸ”„ **åƒåœ¾å›æ”¶** | å®¹å™¨å…³é—­æ—¶å›æ”¶ | ä¸å†å¼•ç”¨æ—¶å›æ”¶ |

**âš ï¸ é‡è¦è­¦å‘Š**

> **æ³¨æ„**ï¼šprototype Beançš„é”€æ¯æ–¹æ³•ä¸ä¼šè¢«Springè°ƒç”¨ï¼
>
> ```java
> @Component
> @Scope("prototype")
> public class TempResource {
>     @PreDestroy
>     public void cleanup() {
>         // âŒ è¿™ä¸ªæ–¹æ³•ä¸ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ï¼
>         // éœ€è¦æ‰‹åŠ¨è°ƒç”¨æˆ–ä½¿ç”¨try-with-resources
>     }
> }
> ```

---

### 2.3 request - è¯·æ±‚ä½œç”¨åŸŸ ğŸŒ


**ğŸ¯ æ ¸å¿ƒç‰¹ç‚¹**
```
è¿è¡Œç¯å¢ƒï¼šä»…Webåº”ç”¨æœ‰æ•ˆ
åˆ›å»ºæ—¶æœºï¼šæ¯ä¸ªHTTPè¯·æ±‚åˆ›å»ºä¸€ä¸ªå®ä¾‹
å®ä¾‹æ•°é‡ï¼šä¸€ä¸ªè¯·æ±‚ä¸€ä¸ªå®ä¾‹
ç”Ÿå‘½å‘¨æœŸï¼šè¯·æ±‚ç»“æŸåé”€æ¯
å…¸å‹åœºæ™¯ï¼šè¡¨å•æ•°æ®ã€è¯·æ±‚å‚æ•°å°è£…
```

**ğŸ’¡ é€šä¿—ç†è§£**
```
å‡è®¾ä½ åœ¨ç½‘ä¸Šè´­ç‰©ï¼š

ç”¨æˆ·Aå‘èµ·è¯·æ±‚ â†’ åˆ›å»ºrequestBean_A
  - æŸ¥çœ‹å•†å“
  - åŠ å…¥è´­ç‰©è½¦
  - æäº¤è®¢å•
è¯·æ±‚ç»“æŸ â†’ requestBean_Aé”€æ¯

ç”¨æˆ·Bå‘èµ·è¯·æ±‚ â†’ åˆ›å»ºrequestBean_B (å…¨æ–°çš„)
  - æŸ¥çœ‹å•†å“
  - ...
è¯·æ±‚ç»“æŸ â†’ requestBean_Bé”€æ¯

ä¸¤ä¸ªç”¨æˆ·çš„æ•°æ®å®Œå…¨éš”ç¦»ï¼
```

**ğŸ”§ é…ç½®æ–¹å¼**

XMLé…ç½®ï¼š
```xml
<!-- éœ€è¦åœ¨web.xmlä¸­é…ç½®RequestContextListener -->
<bean id="loginForm" class="com.example.LoginForm" scope="request"/>
```

æ³¨è§£é…ç½®ï¼š
```java
@Component
@Scope(value = WebApplicationContext.SCOPE_REQUEST)
// æˆ–ç®€å†™ï¼š@RequestScope
public class LoginForm {
    private String username;
    private String password;
    
    // getter/setter...
}
```

**ğŸ“‹ Webé…ç½®è¦æ±‚**

åœ¨ `web.xml` ä¸­æ·»åŠ ç›‘å¬å™¨ï¼š
```xml
<listener>
    <listener-class>
        org.springframework.web.context.request.RequestContextListener
    </listener-class>
</listener>
```

æˆ–åœ¨SpringBootä¸­è‡ªåŠ¨é…ç½®ï¼ˆæ— éœ€æ‰‹åŠ¨é…ç½®ï¼‰

**ğŸ”„ è¯·æ±‚å¤„ç†æµç¨‹**

```
æµè§ˆå™¨                  Tomcat                    Springå®¹å™¨
  |                       |                          |
  |--[1]å‘é€HTTPè¯·æ±‚----->|                          |
  |    /login            |                          |
  |                      |--[2]åˆ›å»ºrequestå¯¹è±¡----->|
  |                      |                          |åˆ›å»ºLoginFormå®ä¾‹
  |                      |                          |ç»‘å®šåˆ°request
  |                      |<--[3]è¿”å›LoginFormå®ä¾‹---|
  |                      |                          |
  |                      |--[4]å¤„ç†ä¸šåŠ¡é€»è¾‘-------->|
  |                      |                          |
  |<--[5]è¿”å›å“åº”é¡µé¢----|                          |
  |                      |                          |
  |                      |--[6]è¯·æ±‚ç»“æŸ------------>|é”€æ¯LoginForm
```

---

### 2.4 session - ä¼šè¯ä½œç”¨åŸŸ ğŸ‘¤


**ğŸ¯ æ ¸å¿ƒç‰¹ç‚¹**
```
è¿è¡Œç¯å¢ƒï¼šä»…Webåº”ç”¨æœ‰æ•ˆ
åˆ›å»ºæ—¶æœºï¼šæ¯ä¸ªHTTP Sessionåˆ›å»ºä¸€ä¸ªå®ä¾‹
å®ä¾‹æ•°é‡ï¼šä¸€ä¸ªç”¨æˆ·ä¼šè¯ä¸€ä¸ªå®ä¾‹
ç”Ÿå‘½å‘¨æœŸï¼šä¼šè¯è¶…æ—¶æˆ–æ‰‹åŠ¨é”€æ¯
å…¸å‹åœºæ™¯ï¼šç”¨æˆ·ç™»å½•ä¿¡æ¯ã€è´­ç‰©è½¦æ•°æ®
```

**ğŸ’¡ ç”Ÿæ´»åŒ–ç†è§£**
```
ä½ å»é“¶è¡ŒåŠä¸šåŠ¡ï¼š

æ­¥éª¤1ï¼šå–å·æ’é˜Ÿ â†’ åˆ›å»ºsessionï¼ˆä¼šè¯å¼€å§‹ï¼‰
æ­¥éª¤2ï¼šåŠç†ä¸šåŠ¡ â†’ sessionä¸­å­˜å‚¨ä½ çš„ä¿¡æ¯
  - æŸ¥è¯¢ä½™é¢
  - è½¬è´¦
  - æ‰“å°æµæ°´
æ­¥éª¤3ï¼šä¸šåŠ¡åŠå®Œç¦»å¼€ â†’ sessioné”€æ¯

æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼ŒæŸœå‘˜çŸ¥é“ä½ æ˜¯è°ï¼Œä½ çš„ä¸šåŠ¡æ•°æ®ä¸€ç›´ä¿æŒã€‚
å…¶ä»–å®¢æˆ·çš„sessionä¸ä½ å®Œå…¨ç‹¬ç«‹ã€‚
```

**ğŸ”§ é…ç½®æ–¹å¼**

æ³¨è§£é…ç½®ï¼ˆæ¨èï¼‰ï¼š
```java
@Component
@Scope(value = WebApplicationContext.SCOPE_SESSION)
// æˆ–ç®€å†™ï¼š@SessionScope
public class ShoppingCart {
    private List<Product> items = new ArrayList<>();
    private BigDecimal totalPrice = BigDecimal.ZERO;
    
    public void addItem(Product product) {
        items.add(product);
        totalPrice = totalPrice.add(product.getPrice());
    }
}
```

XMLé…ç½®ï¼š
```xml
<bean id="shoppingCart" class="com.example.ShoppingCart" scope="session"/>
```

**ğŸ“Š Sessionç”Ÿå‘½å‘¨æœŸç®¡ç†**

| åˆ›å»ºæ—¶æœº | é”€æ¯æ—¶æœº | å…¸å‹åœºæ™¯ |
|----------|----------|----------|
| ç”¨æˆ·é¦–æ¬¡è®¿é—® | ä¼šè¯è¶…æ—¶ï¼ˆé»˜è®¤30åˆ†é’Ÿï¼‰ | ç”¨æˆ·ç™»å½•ä¿¡æ¯ |
| ç¬¬ä¸€æ¬¡è·å–Bean | ç”¨æˆ·ä¸»åŠ¨ç™»å‡º | è´­ç‰©è½¦æ•°æ® |
| HTTP Sessionåˆ›å»ºæ—¶ | æœåŠ¡å™¨é‡å¯ | ç”¨æˆ·åå¥½è®¾ç½® |

**âš ï¸ æ³¨æ„äº‹é¡¹**

> **æç¤º**ï¼šSessionä½œç”¨åŸŸçš„Beanéœ€è¦æ³¨æ„å†…å­˜å ç”¨
>
> - åŒæ—¶åœ¨çº¿ç”¨æˆ·è¶Šå¤šï¼Œå ç”¨å†…å­˜è¶Šå¤§
> - åŠæ—¶æ¸…ç†ä¸éœ€è¦çš„Sessionæ•°æ®
> - è®¾ç½®åˆç†çš„Sessionè¶…æ—¶æ—¶é—´

**å®æˆ˜ç¤ºä¾‹ï¼šç”¨æˆ·è´­ç‰©è½¦**

```java
@Controller
public class ShoppingController {
    
    @Autowired
    private ShoppingCart cart;  // æ³¨å…¥sessionä½œç”¨åŸŸçš„Bean
    
    @GetMapping("/addToCart")
    public String addToCart(@RequestParam Long productId) {
        Product product = productService.findById(productId);
        cart.addItem(product);  // æ·»åŠ åˆ°å½“å‰ç”¨æˆ·çš„è´­ç‰©è½¦
        return "redirect:/cart";
    }
    
    @GetMapping("/cart")
    public String viewCart(Model model) {
        model.addAttribute("items", cart.getItems());
        model.addAttribute("total", cart.getTotalPrice());
        return "cart";  // æ˜¾ç¤ºå½“å‰ç”¨æˆ·çš„è´­ç‰©è½¦
    }
}
```

---

### 2.5 application - åº”ç”¨ä½œç”¨åŸŸ ğŸŒ


**ğŸ¯ æ ¸å¿ƒç‰¹ç‚¹**
```
è¿è¡Œç¯å¢ƒï¼šä»…Webåº”ç”¨æœ‰æ•ˆ
åˆ›å»ºæ—¶æœºï¼šServletContextåˆ›å»ºæ—¶
å®ä¾‹æ•°é‡ï¼šæ•´ä¸ªWebåº”ç”¨ä¸€ä¸ªå®ä¾‹
ç”Ÿå‘½å‘¨æœŸï¼šåº”ç”¨å…³é—­æ—¶é”€æ¯
å…¸å‹åœºæ™¯ï¼šå…¨å±€é…ç½®ã€åº”ç”¨çº§åˆ«ç¼“å­˜
```

**ğŸ’¡ ä¸singletonçš„åŒºåˆ«**

```
applicationä½œç”¨åŸŸï¼š
Webåº”ç”¨A â†’ åˆ›å»ºBean_A (ServletContextçº§åˆ«)
Webåº”ç”¨B â†’ åˆ›å»ºBean_B (ServletContextçº§åˆ«)
åŒä¸€ä¸ªåº”ç”¨å†…å…¨å±€å…±äº«

singletonä½œç”¨åŸŸï¼š
Springå®¹å™¨1 â†’ åˆ›å»ºBean_1 (Springå®¹å™¨çº§åˆ«)
Springå®¹å™¨2 â†’ åˆ›å»ºBean_2 (Springå®¹å™¨çº§åˆ«)
åŒä¸€ä¸ªSpringå®¹å™¨å†…å…¨å±€å…±äº«

å…³é”®åŒºåˆ«ï¼š
- ä¸€ä¸ªWebåº”ç”¨å¯èƒ½æœ‰å¤šä¸ªSpringå®¹å™¨ï¼ˆå¦‚çˆ¶å­å®¹å™¨ï¼‰
- æ­¤æ—¶applicationä½œç”¨åŸŸä¼šè·¨å®¹å™¨å…±äº«
- singletonåªåœ¨å•ä¸ªSpringå®¹å™¨å†…å…±äº«
```

**ğŸ”§ é…ç½®æ–¹å¼**

```java
@Component
@Scope(value = WebApplicationContext.SCOPE_APPLICATION)
// æˆ–ç®€å†™ï¼š@ApplicationScope
public class AppConfiguration {
    private Map<String, String> settings = new HashMap<>();
    
    @PostConstruct
    public void init() {
        // åŠ è½½å…¨å±€é…ç½®
        settings.put("appName", "ç”µå•†å¹³å°");
        settings.put("version", "1.0.0");
    }
}
```

**ğŸ“Š ä½œç”¨åŸŸèŒƒå›´å¯¹æ¯”å›¾**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ServletContext (åº”ç”¨)           â”‚ â† applicationä½œç”¨åŸŸ
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚      Springå®¹å™¨1 (çˆ¶å®¹å™¨)          â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚    singleton Bean A          â”‚  â”‚  â”‚ â† singletonä½œç”¨åŸŸ
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  Springå®¹å™¨2 (å­å®¹å™¨MVC)     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  singleton Bean B    â”‚     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

application Beanï¼šæ•´ä¸ªServletContextå…±äº«ï¼ˆæœ€å¤§èŒƒå›´ï¼‰
singleton Beanï¼šå•ä¸ªSpringå®¹å™¨å†…å…±äº«ï¼ˆå®¹å™¨çº§åˆ«ï¼‰
```

**ä½¿ç”¨åœºæ™¯å¯¹æ¯”**

| ä½œç”¨åŸŸ | ä½¿ç”¨åœºæ™¯ | ä¸¾ä¾‹ |
|--------|----------|------|
| `application` | å…¨å±€é…ç½®ã€è·¨å®¹å™¨å…±äº« | ç³»ç»Ÿå‚æ•°é…ç½®ã€åº”ç”¨ä¿¡æ¯ |
| `singleton` | å®¹å™¨å†…å…±äº«ã€å¸¸è§„Bean | Serviceã€DAOã€å·¥å…·ç±» |

---

## 3. ğŸ”§ è‡ªåŠ¨è£…é…ç­–ç•¥


### 3.1 ä»€ä¹ˆæ˜¯è‡ªåŠ¨è£…é…


**ğŸ¤” ç”Ÿæ´»ç±»æ¯”**
```
ä¼ ç»Ÿæ‰‹åŠ¨è£…é… = è‡ªå·±ç»„è£…å®¶å…·
- éœ€è¦æ˜ç¡®æŒ‡å®šæ¯ä¸ªé›¶ä»¶
- èºä¸Aæ‹§åˆ°å­”ä½1
- èºä¸Bæ‹§åˆ°å­”ä½2
- è´¹æ—¶è´¹åŠ›ä½†ç²¾ç¡®

è‡ªåŠ¨è£…é… = å®œå®¶è‡ªåŠ¨ç»„è£…æœåŠ¡
- å‘Šè¯‰ç³»ç»Ÿéœ€è¦ä»€ä¹ˆ
- ç³»ç»Ÿè‡ªåŠ¨æ‰¾åˆ°åˆé€‚çš„é›¶ä»¶
- è‡ªåŠ¨å®Œæˆç»„è£…
- çœæ—¶çœåŠ›ä½†å¯èƒ½æœ‰æ­§ä¹‰
```

**ğŸ“‹ å®˜æ–¹å®šä¹‰**
> è‡ªåŠ¨è£…é…ï¼ˆAutowiringï¼‰ï¼šSpringå®¹å™¨è‡ªåŠ¨ä¸ºBeanæ³¨å…¥ä¾èµ–å¯¹è±¡ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½® `<property>` æˆ– `@Autowired`

### 3.2 byName - æŒ‰åç§°è£…é…


**ğŸ¯ å·¥ä½œåŸç†**
```
è£…é…è§„åˆ™ï¼šæ ¹æ®Beançš„å±æ€§åæŸ¥æ‰¾åŒåçš„Beanè¿›è¡Œæ³¨å…¥

åŒ¹é…è¿‡ç¨‹ï¼š
1. Beanæœ‰ä¸ªå±æ€§å« userDao
2. Springå®¹å™¨æŸ¥æ‰¾id="userDao"çš„Bean
3. æ‰¾åˆ°åˆ™æ³¨å…¥ï¼Œæ‰¾ä¸åˆ°åˆ™ä¸ºnull
```

**ğŸ’¡ XMLé…ç½®ç¤ºä¾‹**

```xml
<!-- å®šä¹‰DAOå±‚Beanï¼Œidä¸ºuserDao -->
<bean id="userDao" class="com.example.UserDaoImpl"/>

<!-- Serviceå±‚Beanï¼Œè‡ªåŠ¨è£…é… -->
<bean id="userService" class="com.example.UserServiceImpl" autowire="byName">
    <!-- 
    Springä¼šè‡ªåŠ¨æ‰¾ï¼š
    - å±æ€§å userDao â†’ æŸ¥æ‰¾id="userDao"çš„Bean
    - å±æ€§å orderDao â†’ æŸ¥æ‰¾id="orderDao"çš„Bean
    -->
</bean>
```

**å¯¹åº”çš„Javaç±»**

```java
public class UserServiceImpl {
    private UserDao userDao;  // å±æ€§åå¿…é¡»æ˜¯userDao
    
    // å¿…é¡»æä¾›setteræ–¹æ³•
    public void setUserDao(UserDao userDao) {
        this.userDao = userDao;
    }
}
```

**âš ï¸ æ³¨æ„äº‹é¡¹**

> **é‡è¦**ï¼šbyNameè£…é…çš„ä¸‰ä¸ªè¦æ±‚
> 
> 1. âœ… Beançš„å±æ€§å = è¦æ³¨å…¥Beançš„id
> 2. âœ… å¿…é¡»æä¾›setteræ–¹æ³•
> 3. âœ… å¦‚æœæ‰¾ä¸åˆ°åŒåBeanï¼Œå±æ€§ä¸ºnullï¼ˆä¸æŠ¥é”™ï¼‰

**ğŸ“Š è£…é…æˆåŠŸä¸å¤±è´¥å¯¹æ¯”**

```
âœ… æˆåŠŸæ¡ˆä¾‹ï¼š
å±æ€§åï¼šuserDao
Bean IDï¼šuserDao
ç»“æœï¼šæˆåŠŸæ³¨å…¥ âœ“

âŒ å¤±è´¥æ¡ˆä¾‹1ï¼š
å±æ€§åï¼šuserDao
Bean IDï¼šuserDaoImpl  (åå­—ä¸åŒ¹é…)
ç»“æœï¼šæ³¨å…¥null âœ—

âŒ å¤±è´¥æ¡ˆä¾‹2ï¼š
å±æ€§åï¼šuserDao
æ²¡æœ‰setteræ–¹æ³•
ç»“æœï¼šæ— æ³•æ³¨å…¥ âœ—
```

---

### 3.3 byType - æŒ‰ç±»å‹è£…é… â­


**ğŸ¯ å·¥ä½œåŸç†**
```
è£…é…è§„åˆ™ï¼šæ ¹æ®Beançš„å±æ€§ç±»å‹æŸ¥æ‰¾åŒ¹é…çš„Beanè¿›è¡Œæ³¨å…¥

åŒ¹é…è¿‡ç¨‹ï¼š
1. Beanæœ‰ä¸ªå±æ€§ç±»å‹æ˜¯ UserDao
2. Springå®¹å™¨æŸ¥æ‰¾ç±»å‹ä¸ºUserDaoçš„Bean
3. æ‰¾åˆ°1ä¸ªåˆ™æ³¨å…¥ï¼Œæ‰¾åˆ°å¤šä¸ªåˆ™æŠ¥é”™ï¼Œæ‰¾ä¸åˆ°åˆ™ä¸ºnull
```

**ğŸ’¡ XMLé…ç½®ç¤ºä¾‹**

```xml
<!-- å®šä¹‰DAOå®ç°ç±» -->
<bean id="abc" class="com.example.UserDaoImpl"/>
<!-- idéšä¾¿èµ·ï¼Œä¸å½±å“è£…é… -->

<!-- Serviceå±‚Beanï¼ŒæŒ‰ç±»å‹è‡ªåŠ¨è£…é… -->
<bean id="userService" class="com.example.UserServiceImpl" autowire="byType">
    <!-- Springä¼šæŸ¥æ‰¾ç±»å‹ä¸ºUserDaoçš„Beanå¹¶æ³¨å…¥ -->
</bean>
```

**ğŸ“Š è£…é…ç»“æœå¯¹æ¯”**

| æƒ…å†µ | å®¹å™¨ä¸­UserDaoç±»å‹Beanæ•°é‡ | è£…é…ç»“æœ |
|------|--------------------------|----------|
| âœ… **æ­£å¸¸** | 1ä¸ª | æˆåŠŸæ³¨å…¥ |
| âŒ **å†²çª** | 2ä¸ªæˆ–æ›´å¤š | æŠ›å‡º`NoUniqueBeanDefinitionException` |
| âš ï¸ **ç¼ºå¤±** | 0ä¸ª | å±æ€§ä¸ºnull |

**ğŸ” ç±»å‹åŒ¹é…è§„åˆ™**

```
æ¥å£ä¸å®ç°ç±»å…³ç³»ï¼š

UserDao (æ¥å£)
    â†‘
    | implements
    |
UserDaoImpl (å®ç°ç±»)

SpringæŸ¥æ‰¾é€»è¾‘ï¼š
1. æŸ¥æ‰¾ç±»å‹ä¸ºUserDaoçš„Bean
2. UserDaoImplå®ç°äº†UserDaoæ¥å£
3. ç±»å‹åŒ¹é… âœ“ å¯ä»¥æ³¨å…¥

åŒæ ·é€‚ç”¨äºï¼š
- çˆ¶ç±»ä¸å­ç±»
- æŠ½è±¡ç±»ä¸å®ç°ç±»
```

**âš ï¸ å¤šä¸ªå€™é€‰Beané—®é¢˜**

```xml
<!-- âŒ è¿™æ ·é…ç½®ä¼šæŠ¥é”™ -->
<bean id="userDao1" class="com.example.UserDaoImpl"/>
<bean id="userDao2" class="com.example.UserDaoImpl"/>

<bean id="userService" class="com.example.UserServiceImpl" autowire="byType"/>
<!-- 
é”™è¯¯ï¼šæ‰¾åˆ°2ä¸ªUserDaoç±»å‹çš„Bean
å¼‚å¸¸ï¼šNoUniqueBeanDefinitionException: expected single matching bean but found 2
-->

<!-- âœ… è§£å†³æ–¹æ¡ˆ1ï¼šä½¿ç”¨primaryæ ‡è®°ä¸»è¦å€™é€‰è€… -->
<bean id="userDao1" class="com.example.UserDaoImpl" primary="true"/>
<bean id="userDao2" class="com.example.UserDaoImpl"/>

<!-- âœ… è§£å†³æ–¹æ¡ˆ2ï¼šæ”¹ç”¨byNameè£…é… -->
<bean id="userService" class="com.example.UserServiceImpl" autowire="byName"/>
```

---

### 3.4 constructor - æ„é€ å™¨è£…é…


**ğŸ¯ å·¥ä½œåŸç†**
```
è£…é…è§„åˆ™ï¼šé€šè¿‡æ„é€ å™¨å‚æ•°ç±»å‹æŸ¥æ‰¾åŒ¹é…çš„Bean

åŒ¹é…è¿‡ç¨‹ï¼š
1. åˆ†ææ„é€ å™¨çš„å‚æ•°ç±»å‹
2. åœ¨å®¹å™¨ä¸­æŸ¥æ‰¾åŒ¹é…ç±»å‹çš„Bean
3. è°ƒç”¨æ„é€ å™¨å®Œæˆæ³¨å…¥
```

**ğŸ’¡ é…ç½®ç¤ºä¾‹**

```xml
<bean id="userDao" class="com.example.UserDaoImpl"/>

<bean id="userService" class="com.example.UserServiceImpl" autowire="constructor">
    <!-- Springä¼šï¼š
    1. æŸ¥æ‰¾UserServiceImplçš„æ„é€ å™¨
    2. åˆ†æå‚æ•°ç±»å‹ï¼ˆUserDaoï¼‰
    3. æŸ¥æ‰¾UserDaoç±»å‹çš„Bean
    4. è°ƒç”¨æ„é€ å™¨æ³¨å…¥
    -->
</bean>
```

**å¯¹åº”çš„Javaç±»**

```java
public class UserServiceImpl {
    private final UserDao userDao;  // ä½¿ç”¨finalï¼Œå¿…é¡»æ„é€ å™¨æ³¨å…¥
    
    // æ„é€ å™¨ï¼ˆSpringä¼šè‡ªåŠ¨è°ƒç”¨ï¼‰
    public UserServiceImpl(UserDao userDao) {
        this.userDao = userDao;
    }
}
```

**ğŸ“Š ä¸byTypeå¯¹æ¯”**

| å¯¹æ¯”é¡¹ | byType | constructor |
|--------|--------|-------------|
| æ³¨å…¥æ–¹å¼ | setteræ–¹æ³• | æ„é€ å™¨ |
| æ˜¯å¦éœ€è¦setter | âœ… å¿…é¡» | âŒ ä¸éœ€è¦ |
| èƒ½å¦ç”¨finalä¿®é¥° | âŒ ä¸èƒ½ | âœ… å¯ä»¥ |
| ä¾èµ–æ˜¯å¦å¯é€‰ | âœ… å¯é€‰ï¼ˆå¯ä¸ºnullï¼‰ | âŒ å¿…é€‰ï¼ˆæ„é€ å™¨å¿…ä¼ ï¼‰ |
| é€‚ç”¨åœºæ™¯ | å¯é€‰ä¾èµ– | å¿…éœ€ä¾èµ– |

**ğŸ” æ„é€ å™¨é€‰æ‹©è§„åˆ™**

```java
// å¤šä¸ªæ„é€ å™¨çš„æƒ…å†µ
public class UserServiceImpl {
    private UserDao userDao;
    private OrderDao orderDao;
    
    // æ„é€ å™¨1ï¼š1ä¸ªå‚æ•°
    public UserServiceImpl(UserDao userDao) {
        this.userDao = userDao;
    }
    
    // æ„é€ å™¨2ï¼š2ä¸ªå‚æ•°
    public UserServiceImpl(UserDao userDao, OrderDao orderDao) {
        this.userDao = userDao;
        this.orderDao = orderDao;
    }
}

Springé€‰æ‹©ç­–ç•¥ï¼š
1. ä¼˜å…ˆé€‰æ‹©å‚æ•°æœ€å¤šçš„æ„é€ å™¨
2. å°è¯•åŒ¹é…æ‰€æœ‰å‚æ•°ç±»å‹
3. å¦‚æœåŒ¹é…å¤±è´¥ï¼Œå°è¯•å‚æ•°å°‘çš„æ„é€ å™¨
4. å¦‚æœéƒ½å¤±è´¥ï¼ŒæŠ›å‡ºå¼‚å¸¸
```

---

## 4. ğŸ“Œ æ³¨è§£å¼è£…é…è¯¦è§£


### 4.1 @Autowired - SpringåŸç”Ÿæ³¨è§£ â­â­â­â­â­


**ğŸ¯ æ ¸å¿ƒç‰¹ç‚¹**
```
æ¥æºï¼šSpringæ¡†æ¶æä¾›
é»˜è®¤ç­–ç•¥ï¼šæŒ‰ç±»å‹ï¼ˆbyTypeï¼‰è£…é…
å¿…éœ€æ€§ï¼šé»˜è®¤required=trueï¼ˆæ‰¾ä¸åˆ°ä¼šæŠ¥é”™ï¼‰
è£…é…ä½ç½®ï¼šå­—æ®µã€setterã€æ„é€ å™¨ã€æ–¹æ³•å‚æ•°
ä½¿ç”¨é¢‘ç‡ï¼šâ˜…â˜…â˜…â˜…â˜… æœ€å¸¸ç”¨
```

**ğŸ’¡ ä¸‰ç§ä½¿ç”¨æ–¹å¼**

**æ–¹å¼1ï¼šå­—æ®µæ³¨å…¥ï¼ˆæœ€ç®€æ´ï¼‰**
```java
@Service
public class UserService {
    
    @Autowired
    private UserDao userDao;  // ç›´æ¥æ³¨å…¥å­—æ®µï¼Œæ— éœ€setter
    
    public void saveUser(User user) {
        userDao.save(user);
    }
}
```

**æ–¹å¼2ï¼šsetteræ³¨å…¥ï¼ˆä¼ ç»Ÿæ–¹å¼ï¼‰**
```java
@Service
public class UserService {
    private UserDao userDao;
    
    @Autowired
    public void setUserDao(UserDao userDao) {
        this.userDao = userDao;
    }
}
```

**æ–¹å¼3ï¼šæ„é€ å™¨æ³¨å…¥ï¼ˆæ¨èæ–¹å¼ï¼‰** â­
```java
@Service
public class UserService {
    private final UserDao userDao;  // å¯ä»¥ç”¨final
    
    @Autowired  // Spring 4.3+å¯çœç•¥ï¼Œå•æ„é€ å™¨è‡ªåŠ¨æ³¨å…¥
    public UserService(UserDao userDao) {
        this.userDao = userDao;
    }
}
```

**ğŸ“Š ä¸‰ç§æ–¹å¼å¯¹æ¯”**

| æ³¨å…¥æ–¹å¼ | ä¼˜ç‚¹ | ç¼ºç‚¹ | æ¨èåº¦ |
|----------|------|------|--------|
| ğŸ”¹ **å­—æ®µæ³¨å…¥** | ä»£ç ç®€æ´ï¼Œä½¿ç”¨æ–¹ä¾¿ | æ— æ³•ç”¨finalï¼Œä¸åˆ©äºæµ‹è¯• | â­â­â­ |
| ğŸ”¹ **setteræ³¨å…¥** | ä¾èµ–å¯é€‰ï¼Œå¯ä»¥ä¿®æ”¹ | ä»£ç å†—é•¿ï¼Œä¾èµ–å¯å˜ | â­â­ |
| ğŸ”¹ **æ„é€ å™¨æ³¨å…¥** | ä¾èµ–ä¸å¯å˜ï¼Œåˆ©äºæµ‹è¯• | å‚æ•°å¤šæ—¶ç•¥æ˜¾å†—é•¿ | â­â­â­â­â­ |

**âš ï¸ requiredå±æ€§è¯¦è§£**

```java
@Service
public class UserService {
    
    // required=trueï¼ˆé»˜è®¤ï¼‰ï¼šæ‰¾ä¸åˆ°Beanä¼šæŠ¥é”™
    @Autowired
    private UserDao userDao;  // å¿…é¡»æ³¨å…¥
    
    // required=falseï¼šæ‰¾ä¸åˆ°Beanä¸æŠ¥é”™ï¼Œå€¼ä¸ºnull
    @Autowired(required = false)
    private OrderDao orderDao;  // å¯é€‰æ³¨å…¥
    
    public void doSomething() {
        userDao.findAll();  // è‚¯å®šä¸ä¸ºnull
        
        if (orderDao != null) {  // éœ€è¦åˆ¤ç©º
            orderDao.findAll();
        }
    }
}
```

**ğŸ” ç±»å‹å†²çªå¤„ç†ç¤ºä¾‹**

```java
// åœºæ™¯ï¼šå®¹å™¨ä¸­æœ‰å¤šä¸ªUserDaoå®ç°ç±»

@Repository
public class UserDaoImpl implements UserDao { }

@Repository  
public class UserDaoImpl2 implements UserDao { }

// âŒ ç›´æ¥æ³¨å…¥ä¼šæŠ¥é”™
@Service
public class UserService {
    @Autowired
    private UserDao userDao;  // é”™è¯¯ï¼šæ‰¾åˆ°2ä¸ªå€™é€‰Bean
}

// âœ… è§£å†³æ–¹æ¡ˆï¼šé…åˆ@QualifieræŒ‡å®šBeanåç§°ï¼ˆè§ä¸‹èŠ‚ï¼‰
```

---

### 4.2 @Resource - JDKæ ‡å‡†æ³¨è§£


**ğŸ¯ æ ¸å¿ƒç‰¹ç‚¹**
```
æ¥æºï¼šJDKæä¾›ï¼ˆjavax.annotation.Resourceï¼‰
é»˜è®¤ç­–ç•¥ï¼šå…ˆæŒ‰åç§°ï¼ˆbyNameï¼‰ï¼Œå†æŒ‰ç±»å‹ï¼ˆbyTypeï¼‰
å¿…éœ€æ€§ï¼šé»˜è®¤å¿…éœ€ï¼Œæ‰¾ä¸åˆ°ä¼šæŠ¥é”™
è£…é…ä½ç½®ï¼šå­—æ®µã€setteræ–¹æ³•
ä½¿ç”¨é¢‘ç‡ï¼šâ˜…â˜…â˜…â˜…â˜† å¸¸ç”¨
```

**ğŸ’¡ ä¸¤ç§ä½¿ç”¨æ–¹å¼**

**æ–¹å¼1ï¼šä¸æŒ‡å®šnameï¼ˆå…ˆåç§°åç±»å‹ï¼‰**
```java
@Service
public class UserService {
    
    @Resource  // 1.å…ˆæ‰¾åä¸ºuserDaoçš„Bean  2.æ‰¾ä¸åˆ°å†æ‰¾UserDaoç±»å‹
    private UserDao userDao;
}
```

**æ–¹å¼2ï¼šæŒ‡å®šnameï¼ˆå¼ºåˆ¶æŒ‰åç§°ï¼‰**
```java
@Service  
public class UserService {
    
    @Resource(name = "userDaoImpl")  // å¼ºåˆ¶ä½¿ç”¨idä¸ºuserDaoImplçš„Bean
    private UserDao userDao;
}
```

**ğŸ“Š è£…é…é€»è¾‘æµç¨‹**

```
@Resourceè£…é…æµç¨‹ï¼š

æ­¥éª¤1ï¼šæ£€æŸ¥æ˜¯å¦æŒ‡å®šnameå±æ€§
   â†“ Yes                    â†“ No
æŒ‰nameæŸ¥æ‰¾Bean          æŒ‰å­—æ®µåæŸ¥æ‰¾Bean
   â†“                          â†“
æ‰¾åˆ°ï¼Ÿâ†’ æ³¨å…¥          æ‰¾åˆ°ï¼Ÿâ†’ æ³¨å…¥
   â†“ æ²¡æ‰¾åˆ°                  â†“ æ²¡æ‰¾åˆ°
æŒ‰ç±»å‹æŸ¥æ‰¾              æŒ‰ç±»å‹æŸ¥æ‰¾
   â†“                          â†“
æ‰¾åˆ°1ä¸ªï¼Ÿâ†’ æ³¨å…¥        æ‰¾åˆ°1ä¸ªï¼Ÿâ†’ æ³¨å…¥
æ‰¾åˆ°å¤šä¸ªï¼Ÿâ†’ æŠ¥é”™        æ‰¾åˆ°å¤šä¸ªï¼Ÿâ†’ æŠ¥é”™
æ‰¾åˆ°0ä¸ªï¼Ÿâ†’ æŠ¥é”™         æ‰¾åˆ°0ä¸ªï¼Ÿâ†’ æŠ¥é”™
```

**ğŸ” ä¸@Autowiredå¯¹æ¯”**

| å¯¹æ¯”é¡¹ | @Autowired | @Resource |
|--------|-----------|-----------|
| ğŸ“¦ **æ¥æº** | Springæ¡†æ¶ | JDKæ ‡å‡† |
| ğŸ¯ **é»˜è®¤ç­–ç•¥** | æŒ‰ç±»å‹ï¼ˆbyTypeï¼‰ | å…ˆåç§°åç±»å‹ |
| ğŸ”§ **æŒ‡å®šBean** | é…åˆ`@Qualifier` | ä½¿ç”¨`name`å±æ€§ |
| ğŸ“ **æ³¨å…¥ä½ç½®** | å­—æ®µ/setter/æ„é€ å™¨ | å­—æ®µ/setter |
| âš™ï¸ **å¯é€‰æ³¨å…¥** | `required=false` | ä¸æ”¯æŒ |
| ğŸŒ **è·¨å¹³å°** | ä»…Spring | æ ‡å‡†æ³¨è§£ï¼Œè·¨æ¡†æ¶ |

**ğŸ’¡ å®æˆ˜ä½¿ç”¨å»ºè®®**

```java
// æ¨èå†™æ³•1ï¼šä½¿ç”¨@Autowiredï¼ˆSpringé¡¹ç›®æ ‡å‡†ï¼‰
@Service
public class UserService {
    @Autowired
    private UserDao userDao;
}

// æ¨èå†™æ³•2ï¼šä½¿ç”¨@Resourceï¼ˆéœ€è¦æŒ‰åç§°æ³¨å…¥æ—¶ï¼‰
@Service
public class UserService {
    @Resource(name = "userDaoImpl")  // æ˜ç¡®æŒ‡å®šBean
    private UserDao userDao;
}

// ä¸æ¨èï¼šæ··ç”¨ä¸¤ç§æ³¨è§£
@Service
public class UserService {
    @Autowired
    private UserDao userDao;
    
    @Resource
    private OrderDao orderDao;  // ä¸è¦æ··ç”¨ï¼Œä¿æŒä¸€è‡´
}
```

---

### 4.3 @Qualifier - é™å®šç¬¦æ³¨è§£


**ğŸ¯ ä½œç”¨è¯´æ˜**
```
åŠŸèƒ½ï¼šé…åˆ@Autowiredä½¿ç”¨ï¼Œç²¾ç¡®æŒ‡å®šè¦æ³¨å…¥çš„Bean
åœºæ™¯ï¼šå½“å®¹å™¨ä¸­æœ‰å¤šä¸ªåŒç±»å‹Beanæ—¶ï¼Œæ˜ç¡®é€‰æ‹©å“ªä¸€ä¸ª
ä½ç½®ï¼šä¸@Autowiredä¸€èµ·ä½¿ç”¨
```

**ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹**

**åœºæ™¯è®¾å®šï¼šä¸¤ä¸ªUserDaoå®ç°**
```java
@Repository("userDaoMysql")  // Beanåç§°ï¼šuserDaoMysql
public class UserDaoMysqlImpl implements UserDao {
    public void save(User user) {
        System.out.println("ä¿å­˜åˆ°MySQLæ•°æ®åº“");
    }
}

@Repository("userDaoOracle")  // Beanåç§°ï¼šuserDaoOracle
public class UserDaoOracleImpl implements UserDao {
    public void save(User user) {
        System.out.println("ä¿å­˜åˆ°Oracleæ•°æ®åº“");
    }
}
```

**ä½¿ç”¨@QualifieræŒ‡å®šæ³¨å…¥**
```java
@Service
public class UserService {
    
    // æ–¹å¼1ï¼šå­—æ®µæ³¨å…¥ + @Qualifier
    @Autowired
    @Qualifier("userDaoMysql")  // æ˜ç¡®ä½¿ç”¨MySQLå®ç°
    private UserDao userDao;
    
    // æ–¹å¼2ï¼šæ„é€ å™¨æ³¨å…¥ + @Qualifier
    private final UserDao mysqlDao;
    private final UserDao oracleDao;
    
    @Autowired
    public UserService(
            @Qualifier("userDaoMysql") UserDao mysqlDao,
            @Qualifier("userDaoOracle") UserDao oracleDao) {
        this.mysqlDao = mysqlDao;
        this.oracleDao = oracleDao;
    }
}
```

**ğŸ“Š é—®é¢˜è§£å†³å¯¹æ¯”**

```
é—®é¢˜ï¼šå®¹å™¨ä¸­æœ‰userDaoMysqlå’ŒuserDaoOracleä¸¤ä¸ªBean

âŒ ä¸ä½¿ç”¨@Qualifierï¼š
@Autowired
private UserDao userDao;
â†’ æŠ¥é”™ï¼šNoUniqueBeanDefinitionException

âœ… ä½¿ç”¨@Qualifierï¼š
@Autowired
@Qualifier("userDaoMysql")
private UserDao userDao;
â†’ æˆåŠŸæ³¨å…¥MySQLå®ç°

âœ… æ›¿ä»£æ–¹æ¡ˆï¼šä½¿ç”¨@Resource
@Resource(name = "userDaoMysql")
private UserDao userDao;
â†’ ä¹Ÿèƒ½æˆåŠŸæ³¨å…¥
```

**âš ï¸ æ³¨æ„äº‹é¡¹**

> **æç¤º**ï¼š@Qualifierçš„å€¼å¿…é¡»ä¸Beançš„åç§°å®Œå…¨ä¸€è‡´
> 
> ```java
> @Repository("userDao")  // Beanåç§°
> public class UserDaoImpl implements UserDao { }
> 
> // âœ… æ­£ç¡®
> @Qualifier("userDao")  // åç§°åŒ¹é…
> 
> // âŒ é”™è¯¯  
> @Qualifier("UserDao")   // å¤§å°å†™ä¸ä¸€è‡´
> @Qualifier("userDaoImpl")  // ä¸æ˜¯Beanåç§°
> ```

---

### 4.4 @Primary - ä¸»è¦å€™é€‰è€… â­


**ğŸ¯ ä½œç”¨è¯´æ˜**
```
åŠŸèƒ½ï¼šæ ‡è®°æŸä¸ªBeanä¸ºä¸»è¦å€™é€‰è€…
åœºæ™¯ï¼šæœ‰å¤šä¸ªåŒç±»å‹Beanæ—¶ï¼Œä¼˜å…ˆæ³¨å…¥è¢«@Primaryæ ‡è®°çš„
ä½ç½®ï¼šåŠ åœ¨Beanå®šä¹‰ä¸Šï¼ˆ@Componentã€@Beanç­‰ï¼‰
ä¼˜å…ˆçº§ï¼šä½äº@Qualifierï¼ˆ@Qualifierçš„é€‰æ‹©ä¼˜å…ˆï¼‰
```

**ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹**

```java
// MySQLå®ç°ï¼ˆä¸»è¦å€™é€‰è€…ï¼‰
@Repository
@Primary  // æ ‡è®°ä¸ºä¸»è¦å€™é€‰è€…
public class UserDaoMysqlImpl implements UserDao {
    public void save(User user) {
        System.out.println("ä¿å­˜åˆ°MySQL");
    }
}

// Oracleå®ç°ï¼ˆå¤‡ç”¨ï¼‰
@Repository
public class UserDaoOracleImpl implements UserDao {
    public void save(User user) {
        System.out.println("ä¿å­˜åˆ°Oracle");
    }
}

// Serviceå±‚æ³¨å…¥
@Service
public class UserService {
    
    @Autowired  // æ— éœ€@Qualifierï¼Œè‡ªåŠ¨æ³¨å…¥@Primaryæ ‡è®°çš„Bean
    private UserDao userDao;  // æ³¨å…¥çš„æ˜¯UserDaoMysqlImpl
    
    public void saveUser(User user) {
        userDao.save(user);  // è¾“å‡ºï¼šä¿å­˜åˆ°MySQL
    }
}
```

**ğŸ” ä¼˜å…ˆçº§è§„åˆ™**

```
æ³¨å…¥ä¼˜å…ˆçº§ï¼ˆä»é«˜åˆ°ä½ï¼‰ï¼š

1. @Qualifieræ˜ç¡®æŒ‡å®š
   @Autowired
   @Qualifier("userDaoOracle")  â† æœ€é«˜ä¼˜å…ˆçº§
   private UserDao userDao;
   ç»“æœï¼šæ— è®º@Primaryåœ¨å“ªï¼Œéƒ½æ³¨å…¥Oracleå®ç°

2. @Primaryæ ‡è®°
   @Autowired  
   private UserDao userDao;  â† @Primaryç”Ÿæ•ˆ
   ç»“æœï¼šæ³¨å…¥æ ‡è®°@Primaryçš„Bean

3. æŒ‰ç±»å‹åŒ¹é…
   åªæœ‰ä¸€ä¸ªå€™é€‰Beanæ—¶è‡ªåŠ¨æ³¨å…¥
   ç»“æœï¼šæ³¨å…¥å”¯ä¸€çš„å®ç°ç±»

4. æŠ¥é”™
   å¤šä¸ªå€™é€‰Beanä¸”æ— @Primaryå’Œ@Qualifier
   ç»“æœï¼šNoUniqueBeanDefinitionException
```

**ğŸ“Š ä½¿ç”¨åœºæ™¯å¯¹æ¯”**

| åœºæ™¯ | ä½¿ç”¨æ–¹æ¡ˆ | ç¤ºä¾‹ |
|------|----------|------|
| ğŸ¯ **å›ºå®šä½¿ç”¨æŸä¸ªå®ç°** | `@Qualifier` | æ”¯ä»˜æœåŠ¡å›ºå®šç”¨æ”¯ä»˜å® |
| ğŸŒŸ **æœ‰é»˜è®¤å®ç°** | `@Primary` | é»˜è®¤ç”¨MySQLï¼Œç‰¹æ®Šæƒ…å†µç”¨Oracle |
| ğŸ”„ **éœ€è¦åˆ‡æ¢å®ç°** | é…ç½®æ–‡ä»¶+`@ConditionalOnProperty` | æ ¹æ®ç¯å¢ƒåˆ‡æ¢æ•°æ®æº |

**âš ï¸ æœ€ä½³å®è·µ**

```java
// âœ… æ¨èï¼šæ˜ç¡®çš„å‘½å + @Primary
@Repository
@Primary
public class DefaultUserDao implements UserDao { }  // é»˜è®¤å®ç°

@Repository("oracleUserDao")
public class OracleUserDao implements UserDao { }  // Oracleå®ç°

// ä½¿ç”¨æ—¶ï¼š
@Autowired
private UserDao userDao;  // è‡ªåŠ¨ç”¨é»˜è®¤å®ç°

@Autowired
@Qualifier("oracleUserDao")  
private UserDao oracleDao;  // æ˜ç¡®ç”¨Oracleå®ç°

// âŒ ä¸æ¨èï¼šå¤šä¸ª@Primary
@Repository
@Primary
public class UserDaoImpl1 implements UserDao { }

@Repository  
@Primary  // é”™è¯¯ï¼šä¸èƒ½æœ‰å¤šä¸ª@Primary
public class UserDaoImpl2 implements UserDao { }
```

---

## 5. ğŸ”€ è£…é…å†²çªè§£å†³æ–¹æ¡ˆ


### 5.1 å¸¸è§å†²çªåœºæ™¯


**ğŸ¯ åœºæ™¯1ï¼šæ‰¾åˆ°å¤šä¸ªå€™é€‰Bean**

```
é”™è¯¯ä¿¡æ¯ï¼š
NoUniqueBeanDefinitionException: No qualifying bean of type 
'com.example.UserDao' available: expected single matching bean 
but found 2: userDaoMysql, userDaoOracle
```

**è§£å†³æ–¹æ¡ˆå¯¹æ¯”**

| æ–¹æ¡ˆ | ä»£ç ç¤ºä¾‹ | é€‚ç”¨åœºæ™¯ |
|------|----------|----------|
| ğŸ”¹ **ä½¿ç”¨@Primary** | `@Primary`<br>`@Repository` | æœ‰æ˜ç¡®çš„é»˜è®¤å®ç° |
| ğŸ”¹ **ä½¿ç”¨@Qualifier** | `@Autowired`<br>`@Qualifier("userDaoMysql")` | æ˜ç¡®çŸ¥é“è¦ç”¨å“ªä¸ª |
| ğŸ”¹ **ä½¿ç”¨@Resource** | `@Resource(name="userDaoMysql")` | æŒ‰åç§°æ³¨å…¥ |
| ğŸ”¹ **æ„é€ å™¨æ³¨å…¥å¤šä¸ª** | æ„é€ å™¨å‚æ•° + `@Qualifier` | éœ€è¦åŒæ—¶ä½¿ç”¨å¤šä¸ªå®ç° |

**ğŸ¯ åœºæ™¯2ï¼šæ‰¾ä¸åˆ°å€™é€‰Bean**

```
é”™è¯¯ä¿¡æ¯ï¼š
NoSuchBeanDefinitionException: No qualifying bean of type 
'com.example.UserDao' available
```

**è§£å†³æ–¹æ¡ˆ**

```java
// æ–¹æ¡ˆ1ï¼šè®¾ç½®ä¸ºå¯é€‰æ³¨å…¥
@Autowired(required = false)
private UserDao userDao;  // æ‰¾ä¸åˆ°æ—¶ä¸ºnull

// æ–¹æ¡ˆ2ï¼šä½¿ç”¨OptionalåŒ…è£…
@Autowired
private Optional<UserDao> userDao;  // æ‰¾ä¸åˆ°æ—¶ä¸ºOptional.empty()

// æ–¹æ¡ˆ3ï¼šæ£€æŸ¥Beanæ˜¯å¦æ­£ç¡®æ³¨å†Œ
@Repository  // ç¡®ä¿æœ‰è¿™ä¸ªæ³¨è§£
public class UserDaoImpl implements UserDao { }

// æ–¹æ¡ˆ4ï¼šæ£€æŸ¥åŒ…æ‰«æè·¯å¾„
@ComponentScan("com.example")  // ç¡®ä¿æ‰«æåˆ°Beanæ‰€åœ¨åŒ…
```

---

### 5.2 å¾ªç¯ä¾èµ–é—®é¢˜


**ğŸ¯ ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–**

```
å¾ªç¯ä¾èµ–ç¤ºä¾‹ï¼š

ServiceA â†’ ä¾èµ– â†’ ServiceB
   â†‘                  â†“
   â””â”€â”€â”€â”€â”€â”€ä¾èµ–â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç»“æœï¼šåˆ›å»ºAéœ€è¦Bï¼Œåˆ›å»ºBéœ€è¦Aï¼Œæ­»å¾ªç¯ï¼
```

**ğŸ’¡ ä¸‰ç§å¾ªç¯ä¾èµ–æƒ…å†µ**

**æƒ…å†µ1ï¼šæ„é€ å™¨å¾ªç¯ä¾èµ–ï¼ˆæ— æ³•è§£å†³ï¼‰âŒ**
```java
@Service
public class ServiceA {
    @Autowired
    public ServiceA(ServiceB serviceB) { }  // éœ€è¦B
}

@Service
public class ServiceB {
    @Autowired  
    public ServiceB(ServiceA serviceA) { }  // éœ€è¦A
}

// ç»“æœï¼šå¯åŠ¨æŠ¥é”™
// BeanCurrentlyInCreationException: æ­£åœ¨åˆ›å»ºä¸­çš„Beanä¾èµ–
```

**æƒ…å†µ2ï¼šsetterå¾ªç¯ä¾èµ–ï¼ˆå¯ä»¥è§£å†³ï¼‰âœ…**
```java
@Service
public class ServiceA {
    @Autowired
    private ServiceB serviceB;  // setteræ³¨å…¥
}

@Service
public class ServiceB {
    @Autowired
    private ServiceA serviceA;  // setteræ³¨å…¥
}

// ç»“æœï¼šæ­£å¸¸è¿è¡Œ
// Springé€šè¿‡ä¸‰çº§ç¼“å­˜è§£å†³å¾ªç¯ä¾èµ–
```

**æƒ…å†µ3ï¼šprototypeå¾ªç¯ä¾èµ–ï¼ˆæ— æ³•è§£å†³ï¼‰âŒ**
```java
@Service
@Scope("prototype")
public class ServiceA {
    @Autowired
    private ServiceB serviceB;
}

@Service
@Scope("prototype")
public class ServiceB {
    @Autowired
    private ServiceA serviceA;
}

// ç»“æœï¼šè¿è¡Œæ—¶æŠ¥é”™
// prototypeæ— æ³•åˆ©ç”¨ç¼“å­˜ï¼Œæ¯æ¬¡éƒ½åˆ›å»ºæ–°å®ä¾‹
```

**ğŸ“Š å¾ªç¯ä¾èµ–è§£å†³èƒ½åŠ›å¯¹æ¯”**

| Beanä½œç”¨åŸŸ | æ³¨å…¥æ–¹å¼ | èƒ½å¦è§£å†³ | åŸå›  |
|-----------|----------|---------|------|
| singleton | setter | âœ… å¯ä»¥ | åˆ©ç”¨ä¸‰çº§ç¼“å­˜ |
| singleton | æ„é€ å™¨ | âŒ ä¸å¯ä»¥ | åˆ›å»ºæ—¶å°±éœ€è¦ä¾èµ– |
| prototype | setter | âŒ ä¸å¯ä»¥ | æ— æ³•ç¼“å­˜ |
| prototype | æ„é€ å™¨ | âŒ ä¸å¯ä»¥ | æ— æ³•ç¼“å­˜ |

**ğŸ”§ è§£å†³æ–¹æ¡ˆ**

**æ–¹æ¡ˆ1ï¼šä½¿ç”¨@Lazyå»¶è¿ŸåŠ è½½**
```java
@Service
public class ServiceA {
    @Autowired
    @Lazy  // å»¶è¿ŸåŠ è½½ï¼Œåˆ›å»ºä»£ç†å¯¹è±¡
    private ServiceB serviceB;
}

@Service
public class ServiceB {
    @Autowired
    private ServiceA serviceA;
}

// åŸç†ï¼šServiceAå…ˆåˆ›å»ºï¼ŒserviceBæ˜¯ä»£ç†ï¼ŒçœŸæ­£ä½¿ç”¨æ—¶æ‰åˆ›å»ºServiceB
```

**æ–¹æ¡ˆ2ï¼šé‡æ„ä»£ç æ¶ˆé™¤å¾ªç¯ä¾èµ–ï¼ˆæœ€ä½³ï¼‰â­**
```java
// æŠ½å–å…¬å…±ä¾èµ–åˆ°ç¬¬ä¸‰ä¸ªç±»
@Service
public class CommonService {
    public void doCommon() { }
}

@Service
public class ServiceA {
    @Autowired
    private CommonService commonService;  // ä¸å†ä¾èµ–B
}

@Service
public class ServiceB {
    @Autowired
    private CommonService commonService;  // ä¸å†ä¾èµ–A
}
```

**æ–¹æ¡ˆ3ï¼šä½¿ç”¨@PostConstructåˆå§‹åŒ–**
```java
@Service
public class ServiceA {
    private ServiceB serviceB;
    
    @Autowired
    public void setServiceB(ServiceB serviceB) {
        this.serviceB = serviceB;
    }
    
    @PostConstruct  // Beanåˆ›å»ºåæ‰§è¡Œ
    public void init() {
        // æ­¤æ—¶ServiceBå·²ç»æ³¨å…¥å®Œæˆ
        serviceB.doSomething();
    }
}
```

---

### 5.3 è£…é…æœ€ä½³å®è·µ


**ğŸ“‹ æ¨èçš„è£…é…æ–¹å¼æ’åº**

```
1ï¸âƒ£ æ„é€ å™¨æ³¨å…¥ï¼ˆé¦–é€‰ï¼‰â­â­â­â­â­
   - ä¾èµ–ä¸å¯å˜ï¼ˆfinalï¼‰
   - ä¾èµ–å¿…éœ€
   - åˆ©äºå•å…ƒæµ‹è¯•

2ï¸âƒ£ setteræ³¨å…¥ï¼ˆå¯é€‰ä¾èµ–ï¼‰â­â­â­â­
   - ä¾èµ–å¯é€‰
   - éœ€è¦ä¿®æ”¹ä¾èµ–

3ï¸âƒ£ å­—æ®µæ³¨å…¥ï¼ˆç®€å•åœºæ™¯ï¼‰â­â­â­
   - ä»£ç ç®€æ´
   - å¿«é€Ÿå¼€å‘
```

**âœ… æœ€ä½³å®è·µä»£ç æ¨¡æ¿**

```java
@Service
public class UserService {
    
    // 1. å¿…éœ€ä¾èµ–ï¼šæ„é€ å™¨æ³¨å…¥ + final
    private final UserDao userDao;
    private final CacheService cacheService;
    
    @Autowired  // Spring 4.3+å•æ„é€ å™¨å¯çœç•¥
    public UserService(UserDao userDao, CacheService cacheService) {
        this.userDao = userDao;
        this.cacheService = cacheService;
    }
    
    // 2. å¯é€‰ä¾èµ–ï¼šsetteræ³¨å…¥
    private EmailService emailService;
    
    @Autowired(required = false)
    public void setEmailService(EmailService emailService) {
        this.emailService = emailService;
    }
    
    // 3. ä¸šåŠ¡æ–¹æ³•
    public void saveUser(User user) {
        userDao.save(user);
        cacheService.put(user.getId(), user);
        
        if (emailService != null) {  // å¯é€‰ä¾èµ–éœ€åˆ¤ç©º
            emailService.sendWelcome(user.getEmail());
        }
    }
}
```

**âš ï¸ å¸¸è§è¯¯åŒºé¿å…**

```java
// âŒ è¯¯åŒº1ï¼šè¿‡åº¦ä½¿ç”¨å­—æ®µæ³¨å…¥
@Autowired
private UserDao userDao;  // æ— æ³•ç”¨finalï¼Œä¸åˆ©äºæµ‹è¯•

// âœ… æ”¹è¿›ï¼šä½¿ç”¨æ„é€ å™¨æ³¨å…¥
private final UserDao userDao;
@Autowired
public UserService(UserDao userDao) {
    this.userDao = userDao;
}

// âŒ è¯¯åŒº2ï¼šæ··ç”¨@Autowiredå’Œ@Resource
@Autowired
private UserDao userDao;
@Resource
private OrderDao orderDao;  // ä¸è¦æ··ç”¨

// âœ… æ”¹è¿›ï¼šä¿æŒä¸€è‡´
@Autowired
private UserDao userDao;
@Autowired
private OrderDao orderDao;

// âŒ è¯¯åŒº3ï¼šå¾ªç¯ä¾èµ–ç”¨æ„é€ å™¨
@Autowired
public ServiceA(ServiceB serviceB) { }

// âœ… æ”¹è¿›ï¼šé‡æ„æ¶ˆé™¤å¾ªç¯ä¾èµ–
@Autowired
private CommonService commonService;
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Beanä½œç”¨åŸŸï¼šå†³å®šBeançš„åˆ›å»ºæ—¶æœºã€æ•°é‡å’Œç”Ÿå‘½å‘¨æœŸ
   - singletonï¼šå®¹å™¨çº§å•ä¾‹ï¼Œé»˜è®¤ä½œç”¨åŸŸ â­
   - prototypeï¼šæ¯æ¬¡è·å–åˆ›å»ºæ–°å®ä¾‹
   - requestï¼šHTTPè¯·æ±‚çº§åˆ«ï¼ˆWebï¼‰
   - sessionï¼šHTTPä¼šè¯çº§åˆ«ï¼ˆWebï¼‰
   - applicationï¼šServletContextçº§åˆ«ï¼ˆWebï¼‰

ğŸ”¸ è‡ªåŠ¨è£…é…ï¼šSpringè‡ªåŠ¨æ³¨å…¥ä¾èµ–çš„æœºåˆ¶
   - byNameï¼šæŒ‰Beanåç§°åŒ¹é…
   - byTypeï¼šæŒ‰Beanç±»å‹åŒ¹é… â­
   - constructorï¼šé€šè¿‡æ„é€ å™¨æ³¨å…¥

ğŸ”¸ æ³¨è§£è£…é…ï¼šåŸºäºæ³¨è§£çš„ä¾èµ–æ³¨å…¥
   - @Autowiredï¼šSpringåŸç”Ÿï¼ŒæŒ‰ç±»å‹ â­â­â­â­â­
   - @Resourceï¼šJDKæ ‡å‡†ï¼Œå…ˆåç§°åç±»å‹
   - @Qualifierï¼šæŒ‡å®šå…·ä½“Bean
   - @Primaryï¼šæ ‡è®°ä¸»è¦å€™é€‰è€…
```

### 6.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä½œç”¨åŸŸé€‰æ‹©åŸåˆ™**
```
æ— çŠ¶æ€å¯¹è±¡ï¼ˆå·¥å…·ç±»ã€Serviceã€DAOï¼‰
   â†’ ä½¿ç”¨ singleton
   â†’ å…¨å±€å…±äº«ï¼ŒèŠ‚çœå†…å­˜

æœ‰çŠ¶æ€å¯¹è±¡ï¼ˆè¡¨å•æ•°æ®ã€ä¸´æ—¶å¯¹è±¡ï¼‰
   â†’ ä½¿ç”¨ prototype
   â†’ æ¯æ¬¡ç‹¬ç«‹ï¼Œé¿å…æ•°æ®æ··ä¹±

Webå±‚å¯¹è±¡
   â†’ requestï¼šè¯·æ±‚å‚æ•°å¯¹è±¡
   â†’ sessionï¼šç”¨æˆ·ä¼šè¯æ•°æ®
   â†’ applicationï¼šå…¨å±€é…ç½®
```

**ğŸ”¹ è£…é…æ–¹å¼é€‰æ‹©åŸåˆ™**
```
ä¾èµ–å¿…éœ€ä¸”ä¸å¯å˜
   â†’ æ„é€ å™¨æ³¨å…¥ + final
   â†’ æœ€å®‰å…¨ã€æœ€å¯é  â­

ä¾èµ–å¯é€‰æˆ–éœ€è¦ä¿®æ”¹
   â†’ setteræ³¨å…¥
   â†’ çµæ´»ä½†è¦æ³¨æ„null

å¿«é€Ÿå¼€å‘åŸå‹
   â†’ å­—æ®µæ³¨å…¥
   â†’ ç®€æ´ä½†ä¸å¤Ÿä¼˜é›…
```

**ğŸ”¹ å†²çªè§£å†³æ€è·¯**
```
å¤šä¸ªå€™é€‰Beanï¼š
   â†’ æ–¹æ¡ˆ1ï¼š@Primaryæ ‡è®°é»˜è®¤
   â†’ æ–¹æ¡ˆ2ï¼š@Qualifierç²¾ç¡®æŒ‡å®š
   â†’ æ–¹æ¡ˆ3ï¼š@ResourceæŒ‰åç§°

å¾ªç¯ä¾èµ–ï¼š
   â†’ æœ€ä½³ï¼šé‡æ„ä»£ç æ¶ˆé™¤å¾ªç¯
   â†’ ä¸´æ—¶ï¼š@Lazyå»¶è¿ŸåŠ è½½
   â†’ ç¦æ­¢ï¼šæ„é€ å™¨å¾ªç¯ä¾èµ–
```

### 6.3 å®æˆ˜åº”ç”¨å»ºè®®


**ğŸ“Œ ä½œç”¨åŸŸå®æˆ˜**
- **Controllerå±‚**ï¼šsingletonï¼ˆæ— çŠ¶æ€ï¼Œå¤„ç†è¯·æ±‚ï¼‰
- **Serviceå±‚**ï¼šsingletonï¼ˆä¸šåŠ¡é€»è¾‘ï¼Œæ— çŠ¶æ€ï¼‰
- **DAOå±‚**ï¼šsingletonï¼ˆæ•°æ®è®¿é—®ï¼Œæ— çŠ¶æ€ï¼‰
- **è¡¨å•å¯¹è±¡**ï¼šprototypeæˆ–requestï¼ˆç”¨æˆ·æ•°æ®ï¼Œæœ‰çŠ¶æ€ï¼‰
- **è´­ç‰©è½¦**ï¼šsessionï¼ˆä¼šè¯æ•°æ®ï¼Œç”¨æˆ·ç‹¬äº«ï¼‰

**ğŸ“Œ è£…é…å®æˆ˜**
- **æ ¸å¿ƒä¾èµ–**ï¼šæ„é€ å™¨æ³¨å…¥ï¼Œç¡®ä¿å¿…éœ€
- **å¯é€‰æœåŠ¡**ï¼šsetteræ³¨å…¥ + `required=false`
- **ç®€å•é¡¹ç›®**ï¼šå­—æ®µæ³¨å…¥ï¼Œå¿«é€Ÿå¼€å‘
- **å¤šå®ç°ç±»**ï¼š`@Primary` + `@Qualifier`ç»„åˆ

**ğŸ“Œ æ€§èƒ½ä¼˜åŒ–**
- singleton Beané¿å…å­˜å‚¨ç”¨æˆ·æ•°æ®
- prototype BeanåŠæ—¶é‡Šæ”¾ï¼Œé¿å…å†…å­˜æ³„æ¼  
- åˆç†ä½¿ç”¨æ‡’åŠ è½½å‡å°‘å¯åŠ¨æ—¶é—´
- é¿å…å¾ªç¯ä¾èµ–ï¼Œä¿æŒæ¶æ„æ¸…æ™°

**ğŸ§  è®°å¿†å£è¯€**
```
å•ä¾‹é»˜è®¤å…¨å±€ç”¨ï¼ŒåŸå‹æ¯æ¬¡éƒ½åˆ›æ–°
è¯·æ±‚ä¼šè¯åº”ç”¨åŸŸï¼ŒWebå¼€å‘è¦åˆ†æ¸…

æŒ‰åæŒ‰ç±»æ„é€ å™¨ï¼Œè‡ªåŠ¨è£…é…ä¸‰æ–¹å¼
æ³¨è§£è£…é…æ›´æ–¹ä¾¿ï¼ŒAutowiredæœ€å¸¸ç”¨

ä¾èµ–å†²çªè«æ…Œå¼ ï¼ŒPrimaryå’ŒQualifier
å¾ªç¯ä¾èµ–è¦é¿å…ï¼Œé‡æ„ä»£ç æ˜¯æ­£é“
```