---
title: 2ã€Beançš„ç”Ÿå‘½å‘¨æœŸè¯¦è§£
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯Beanç”Ÿå‘½å‘¨æœŸ](#1-ä»€ä¹ˆæ˜¯Beanç”Ÿå‘½å‘¨æœŸ)
2. [Beançš„å››å¤§é˜¶æ®µ](#2-Beançš„å››å¤§é˜¶æ®µ)
3. [åˆå§‹åŒ–çš„ä¸‰ç§æ–¹å¼](#3-åˆå§‹åŒ–çš„ä¸‰ç§æ–¹å¼)
4. [é”€æ¯çš„ä¸‰ç§æ–¹å¼](#4-é”€æ¯çš„ä¸‰ç§æ–¹å¼)
5. [Beanå¤„ç†å™¨æ‰©å±•](#5-Beanå¤„ç†å™¨æ‰©å±•)
6. [å®Œæ•´ç”Ÿå‘½å‘¨æœŸæµç¨‹](#6-å®Œæ•´ç”Ÿå‘½å‘¨æœŸæµç¨‹)
7. [å®é™…åº”ç”¨åœºæ™¯](#7-å®é™…åº”ç”¨åœºæ™¯)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ± ä»€ä¹ˆæ˜¯Beanç”Ÿå‘½å‘¨æœŸ


### 1.1 é€šä¿—ç†è§£Beanç”Ÿå‘½å‘¨æœŸ


**ç®€å•æ¥è¯´**ï¼šBeanç”Ÿå‘½å‘¨æœŸå°±åƒä¸€ä¸ªäººä»å‡ºç”Ÿåˆ°æ­»äº¡çš„è¿‡ç¨‹ã€‚

```
äººçš„ä¸€ç”Ÿï¼šå‡ºç”Ÿ â†’ æˆé•¿ â†’ å·¥ä½œ â†’ é€€ä¼‘
Beançš„ä¸€ç”Ÿï¼šåˆ›å»º â†’ åˆå§‹åŒ– â†’ ä½¿ç”¨ â†’ é”€æ¯
```

**ä¸ºä»€ä¹ˆè¦äº†è§£ç”Ÿå‘½å‘¨æœŸï¼Ÿ**
- ğŸ¯ æƒ³åœ¨Beanåˆ›å»ºæ—¶åšäº›å‡†å¤‡å·¥ä½œï¼ˆæ¯”å¦‚æ‰“å¼€æ•°æ®åº“è¿æ¥ï¼‰
- ğŸ¯ æƒ³åœ¨Beané”€æ¯å‰åšäº›æ¸…ç†å·¥ä½œï¼ˆæ¯”å¦‚å…³é—­è¿æ¥é‡Šæ”¾èµ„æºï¼‰
- ğŸ¯ æƒ³åœ¨ç‰¹å®šæ—¶æœºæ’å…¥è‡ªå·±çš„é€»è¾‘

### 1.2 ä»€ä¹ˆæ˜¯Bean


**é€šä¿—è§£é‡Š**ï¼šBeanå°±æ˜¯Springå®¹å™¨å¸®æˆ‘ä»¬ç®¡ç†çš„å¯¹è±¡

```java
// æ™®é€šå¯¹è±¡ï¼šæˆ‘ä»¬è‡ªå·±newå‡ºæ¥çš„
UserService service = new UserService();

// Spring Beanï¼šäº¤ç»™Springå®¹å™¨ç®¡ç†çš„å¯¹è±¡
@Component
public class UserService {
    // Springä¼šè‡ªåŠ¨åˆ›å»ºè¿™ä¸ªå¯¹è±¡
}
```

**Beançš„å¥½å¤„**ï¼š
- âœ… ä¸ç”¨è‡ªå·±newå¯¹è±¡ï¼ŒSpringå¸®æˆ‘ä»¬åˆ›å»º
- âœ… ä¸ç”¨æ‹…å¿ƒå¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼ŒSpringè‡ªåŠ¨æ³¨å…¥
- âœ… å¯ä»¥æ–¹ä¾¿åœ°ç®¡ç†å¯¹è±¡çš„åˆ›å»ºå’Œé”€æ¯

---

## 2. ğŸ”„ Beançš„å››å¤§é˜¶æ®µ


Beançš„ä¸€ç”Ÿåˆ†ä¸ºå››ä¸ªä¸»è¦é˜¶æ®µï¼Œå°±åƒç›–æˆ¿å­ä¸€æ ·ï¼š

```
é˜¶æ®µ1ï¼šå®ä¾‹åŒ–     â†’ æ‰“åœ°åŸºï¼ˆåˆ›å»ºå¯¹è±¡ï¼‰
é˜¶æ®µ2ï¼šåˆå§‹åŒ–     â†’ è£…ä¿®ï¼ˆé…ç½®å¯¹è±¡ï¼‰
é˜¶æ®µ3ï¼šä½¿ç”¨       â†’ å…¥ä½ï¼ˆä½¿ç”¨å¯¹è±¡ï¼‰
é˜¶æ®µ4ï¼šé”€æ¯       â†’ æ‹†è¿ï¼ˆæ¸…ç†èµ„æºï¼‰
```

### 2.1 å®ä¾‹åŒ–é˜¶æ®µ `[åˆ›å»ºå¯¹è±¡]`


**å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ**
Springæ ¹æ®é…ç½®ä¿¡æ¯åˆ›å»ºBeanå¯¹è±¡ï¼Œå°±åƒæ­æˆ¿å­çš„æ¡†æ¶ã€‚

```java
@Component
public class UserService {
    private String name;
    
    // 1. Springé¦–å…ˆè°ƒç”¨æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡
    public UserService() {
        System.out.println("é˜¶æ®µ1ï¼šå¯¹è±¡è¢«åˆ›å»ºäº†");
    }
}
```

**è¿™ä¸ªé˜¶æ®µåšçš„äº‹**ï¼š
- ğŸ”¸ è°ƒç”¨æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡
- ğŸ”¸ åˆ†é…å†…å­˜ç©ºé—´
- ğŸ”¸ ä½†æ­¤æ—¶å¯¹è±¡è¿˜æ˜¯"åŠæˆå“"ï¼Œå±æ€§è¿˜æ²¡èµ‹å€¼

### 2.2 åˆå§‹åŒ–é˜¶æ®µ `[é…ç½®å¯¹è±¡]`


**å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ**
ç»™Beanè®¾ç½®å±æ€§å€¼ï¼Œæ‰§è¡Œåˆå§‹åŒ–æ–¹æ³•ï¼Œå°±åƒç»™æˆ¿å­è£…ä¿®ã€‚

```java
@Component
public class UserService {
    @Value("${user.name}")
    private String name;  // 2. Springæ³¨å…¥å±æ€§å€¼
    
    @PostConstruct
    public void init() {
        System.out.println("é˜¶æ®µ2ï¼šå¯¹è±¡åˆå§‹åŒ–å®Œæˆï¼Œname=" + name);
    }
}
```

**è¿™ä¸ªé˜¶æ®µåšçš„äº‹**ï¼š
- ğŸ”¸ æ³¨å…¥ä¾èµ–ï¼ˆ@Autowiredçš„å±æ€§ï¼‰
- ğŸ”¸ æ³¨å…¥é…ç½®å€¼ï¼ˆ@Valueçš„å±æ€§ï¼‰
- ğŸ”¸ æ‰§è¡Œåˆå§‹åŒ–æ–¹æ³•ï¼ˆåé¢è¯¦ç»†è®²ï¼‰

### 2.3 ä½¿ç”¨é˜¶æ®µ `[æ­£å¸¸å·¥ä½œ]`


**å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ**
Beanå·²ç»å‡†å¤‡å¥½äº†ï¼Œå¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œå°±åƒä½è¿›è£…ä¿®å¥½çš„æˆ¿å­ã€‚

```java
@RestController
public class UserController {
    @Autowired
    private UserService userService;  // 3. ä½¿ç”¨å®Œå…¨åˆå§‹åŒ–å¥½çš„Bean
    
    @GetMapping("/user")
    public String getUser() {
        return userService.findUser();  // æ­£å¸¸è°ƒç”¨æ–¹æ³•
    }
}
```

**è¿™ä¸ªé˜¶æ®µçš„ç‰¹ç‚¹**ï¼š
- âœ… Beanå·²ç»å®Œå…¨å¯ç”¨
- âœ… æ‰€æœ‰ä¾èµ–éƒ½å·²æ³¨å…¥
- âœ… å¯ä»¥è¢«å…¶ä»–Beanä½¿ç”¨

### 2.4 é”€æ¯é˜¶æ®µ `[æ¸…ç†èµ„æº]`


**å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ**
Springå®¹å™¨å…³é—­æ—¶ï¼Œé”€æ¯Beanå¹¶é‡Šæ”¾èµ„æºï¼Œå°±åƒæ‹†æˆ¿å­ã€‚

```java
@Component
public class DatabaseService {
    private Connection connection;
    
    @PreDestroy
    public void cleanup() {
        System.out.println("é˜¶æ®µ4ï¼šå‡†å¤‡é”€æ¯ï¼Œå…³é—­æ•°æ®åº“è¿æ¥");
        if (connection != null) {
            connection.close();  // é‡Šæ”¾èµ„æº
        }
    }
}
```

**è¿™ä¸ªé˜¶æ®µåšçš„äº‹**ï¼š
- ğŸ”¸ æ‰§è¡Œé”€æ¯æ–¹æ³•
- ğŸ”¸ é‡Šæ”¾å ç”¨çš„èµ„æº
- ğŸ”¸ å…³é—­æ–‡ä»¶ã€æ•°æ®åº“è¿æ¥ç­‰

---

## 3. ğŸ¯ åˆå§‹åŒ–çš„ä¸‰ç§æ–¹å¼


Springæä¾›äº†ä¸‰ç§æ–¹å¼æ¥æ‰§è¡Œåˆå§‹åŒ–é€»è¾‘ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©ï¼š

### 3.1 æ–¹å¼ä¸€ï¼š@PostConstructæ³¨è§£ â­â­â­


**æ¨èæŒ‡æ•°**ï¼šæœ€å¸¸ç”¨ï¼Œæœ€ç®€å•ï¼

```java
@Component
public class EmailService {
    
    @PostConstruct  // åœ¨å¯¹è±¡åˆ›å»ºå¹¶æ³¨å…¥ä¾èµ–åè‡ªåŠ¨æ‰§è¡Œ
    public void init() {
        System.out.println("é‚®ä»¶æœåŠ¡åˆå§‹åŒ–ï¼šè¿æ¥é‚®ä»¶æœåŠ¡å™¨");
    }
}
```

**ç‰¹ç‚¹è¯´æ˜**ï¼š
- âœ… ä½¿ç”¨ç®€å•ï¼ŒåŠ ä¸ªæ³¨è§£å°±è¡Œ
- âœ… æ ‡å‡†çš„Javaæ³¨è§£ï¼ˆjavax.annotationåŒ…ï¼‰
- âœ… æ‰§è¡Œæ—¶æœºï¼šå±æ€§æ³¨å…¥å®Œæˆå

### 3.2 æ–¹å¼äºŒï¼šå®ç°InitializingBeanæ¥å£ â­â­


**æ¨èæŒ‡æ•°**ï¼šæ¯”è¾ƒå¸¸ç”¨ï¼ŒSpringä¸“ç”¨

```java
@Component
public class CacheService implements InitializingBean {
    
    @Override
    public void afterPropertiesSet() throws Exception {
        System.out.println("ç¼“å­˜æœåŠ¡åˆå§‹åŒ–ï¼šåŠ è½½ç¼“å­˜æ•°æ®");
    }
}
```

**ç‰¹ç‚¹è¯´æ˜**ï¼š
- âœ… Springæ¡†æ¶æä¾›çš„æ¥å£
- âœ… æ–¹æ³•åå›ºå®šï¼šafterPropertiesSet
- âš ï¸ ä»£ç ä¸Springè€¦åˆ

### 3.3 æ–¹å¼ä¸‰ï¼šè‡ªå®šä¹‰åˆå§‹åŒ–æ–¹æ³• â­


**æ¨èæŒ‡æ•°**ï¼šçµæ´»ä½†ä¸å¸¸ç”¨

```java
@Component
public class FileService {
    
    // æ–¹æ³•åå¯ä»¥éšä¾¿èµ·
    public void setupFileSystem() {
        System.out.println("æ–‡ä»¶æœåŠ¡åˆå§‹åŒ–ï¼šåˆ›å»ºä¸´æ—¶ç›®å½•");
    }
}

// åœ¨é…ç½®ç±»ä¸­æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•
@Configuration
public class AppConfig {
    @Bean(initMethod = "setupFileSystem")
    public FileService fileService() {
        return new FileService();
    }
}
```

**ç‰¹ç‚¹è¯´æ˜**ï¼š
- âœ… æ–¹æ³•åå¯ä»¥è‡ªå®šä¹‰
- âœ… ä¸Springè§£è€¦
- âš ï¸ éœ€è¦é¢å¤–é…ç½®

### 3.4 ä¸‰ç§æ–¹å¼å¯¹æ¯”


| æ–¹å¼ | **ä½¿ç”¨éš¾åº¦** | **æ¨èç¨‹åº¦** | **é€‚ç”¨åœºæ™¯** |
|------|------------|------------|------------|
| @PostConstruct | ç®€å• | â­â­â­ | æ—¥å¸¸å¼€å‘é¦–é€‰ |
| InitializingBean | ä¸€èˆ¬ | â­â­ | Springé¡¹ç›®ä¸“ç”¨ |
| è‡ªå®šä¹‰æ–¹æ³• | å¤æ‚ | â­ | éœ€è¦è§£è€¦çš„åœºæ™¯ |

### 3.5 æ‰§è¡Œé¡ºåºé—®é¢˜


**å¦‚æœä¸‰ç§æ–¹å¼åŒæ—¶ä½¿ç”¨ï¼Œæ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·çš„ï¼š**

```
1. æ„é€ æ–¹æ³•           â†’ åˆ›å»ºå¯¹è±¡
2. ä¾èµ–æ³¨å…¥           â†’ æ³¨å…¥å±æ€§
3. @PostConstruct    â†’ ç¬¬ä¸€ä¸ªæ‰§è¡Œ
4. afterPropertiesSet â†’ ç¬¬äºŒä¸ªæ‰§è¡Œ  
5. è‡ªå®šä¹‰initæ–¹æ³•     â†’ ç¬¬ä¸‰ä¸ªæ‰§è¡Œ
```

**å®é™…ä¾‹å­**ï¼š

```java
@Component
public class OrderService implements InitializingBean {
    
    public OrderService() {
        System.out.println("1. æ„é€ æ–¹æ³•æ‰§è¡Œ");
    }
    
    @PostConstruct
    public void postConstruct() {
        System.out.println("3. @PostConstructæ‰§è¡Œ");
    }
    
    @Override
    public void afterPropertiesSet() {
        System.out.println("4. afterPropertiesSetæ‰§è¡Œ");
    }
    
    public void customInit() {
        System.out.println("5. è‡ªå®šä¹‰initæ–¹æ³•æ‰§è¡Œ");
    }
}
```

---

## 4. ğŸ’¥ é”€æ¯çš„ä¸‰ç§æ–¹å¼


Beané”€æ¯æ—¶ä¹Ÿæœ‰ä¸‰ç§æ–¹å¼ï¼Œè·Ÿåˆå§‹åŒ–ä¸€ä¸€å¯¹åº”ï¼š

### 4.1 æ–¹å¼ä¸€ï¼š@PreDestroyæ³¨è§£ â­â­â­


**æœ€å¸¸ç”¨çš„é”€æ¯æ–¹å¼**

```java
@Component
public class DatabaseService {
    private Connection connection;
    
    @PreDestroy  // å®¹å™¨å…³é—­å‰è‡ªåŠ¨æ‰§è¡Œ
    public void cleanup() {
        System.out.println("å…³é—­æ•°æ®åº“è¿æ¥");
        if (connection != null) {
            connection.close();
        }
    }
}
```

**ä½¿ç”¨åœºæ™¯**ï¼š
- ğŸ¯ å…³é—­æ•°æ®åº“è¿æ¥
- ğŸ¯ é‡Šæ”¾æ–‡ä»¶å¥æŸ„
- ğŸ¯ åœæ­¢å®šæ—¶ä»»åŠ¡

### 4.2 æ–¹å¼äºŒï¼šå®ç°DisposableBeanæ¥å£ â­â­


**Springä¸“ç”¨çš„é”€æ¯æ¥å£**

```java
@Component
public class ThreadPoolService implements DisposableBean {
    private ExecutorService executor;
    
    @Override
    public void destroy() throws Exception {
        System.out.println("å…³é—­çº¿ç¨‹æ± ");
        if (executor != null) {
            executor.shutdown();
        }
    }
}
```

### 4.3 æ–¹å¼ä¸‰ï¼šè‡ªå®šä¹‰é”€æ¯æ–¹æ³• â­


**çµæ´»çš„é”€æ¯é…ç½®**

```java
@Component
public class CacheService {
    
    public void clearCache() {
        System.out.println("æ¸…ç©ºç¼“å­˜æ•°æ®");
    }
}

@Configuration
public class AppConfig {
    @Bean(destroyMethod = "clearCache")
    public CacheService cacheService() {
        return new CacheService();
    }
}
```

### 4.4 é”€æ¯æ‰§è¡Œé¡ºåº


**ä¸‰ç§æ–¹å¼åŒæ—¶å­˜åœ¨æ—¶çš„æ‰§è¡Œé¡ºåº**ï¼š

```
1. @PreDestroy        â†’ ç¬¬ä¸€ä¸ªæ‰§è¡Œ
2. destroy()æ–¹æ³•      â†’ ç¬¬äºŒä¸ªæ‰§è¡Œ
3. è‡ªå®šä¹‰destroyæ–¹æ³•  â†’ ç¬¬ä¸‰ä¸ªæ‰§è¡Œ
```

---

## 5. ğŸ”§ Beanå¤„ç†å™¨æ‰©å±•


### 5.1 ä»€ä¹ˆæ˜¯BeanPostProcessor


**é€šä¿—è§£é‡Š**ï¼šBeanPostProcessorå°±åƒæ˜¯"BeanåŠ å·¥å‚"ï¼Œåœ¨Beanåˆå§‹åŒ–å‰åæ’å…¥è‡ªå®šä¹‰é€»è¾‘ã€‚

```
Beanåˆå§‹åŒ–æµç¨‹ï¼š
  åˆ›å»ºå¯¹è±¡ 
    â†“
  æ³¨å…¥ä¾èµ–
    â†“
[BeanPostProcessorå‰ç½®å¤„ç†]  â† ä½ å¯ä»¥åœ¨è¿™é‡Œåšæ‰‹è„š
    â†“
  åˆå§‹åŒ–æ–¹æ³•
    â†“
[BeanPostProcessoråç½®å¤„ç†]  â† ä½ ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œåšæ‰‹è„š
    â†“
  Beanå¯ç”¨
```

### 5.2 å®é™…åº”ç”¨ç¤ºä¾‹


**åœºæ™¯ï¼šç»™æ‰€æœ‰Serviceæ·»åŠ æ—¥å¿—åŠŸèƒ½**

```java
@Component
public class LogBeanPostProcessor implements BeanPostProcessor {
    
    // åˆå§‹åŒ–ä¹‹å‰æ‰§è¡Œ
    @Override
    public Object postProcessBeforeInitialization(Object bean, String beanName) {
        if (beanName.endsWith("Service")) {
            System.out.println("å‡†å¤‡åˆå§‹åŒ–ï¼š" + beanName);
        }
        return bean;
    }
    
    // åˆå§‹åŒ–ä¹‹åæ‰§è¡Œ
    @Override
    public Object postProcessAfterInitialization(Object bean, String beanName) {
        if (beanName.endsWith("Service")) {
            System.out.println("åˆå§‹åŒ–å®Œæˆï¼š" + beanName);
        }
        return bean;
    }
}
```

**åº”ç”¨åœºæ™¯**ï¼š
- ğŸ¯ AOPä»£ç†å¯¹è±¡åˆ›å»º
- ğŸ¯ ç»Ÿä¸€æ·»åŠ æ—¥å¿—
- ğŸ¯ æ€§èƒ½ç›‘æ§
- ğŸ¯ å®‰å…¨æ£€æŸ¥

### 5.3 å¤„ç†å™¨çš„å¼ºå¤§ä¹‹å¤„


**ä¾‹å­ï¼šè‡ªåŠ¨ç»™Beanæ·»åŠ æ–¹æ³•æ‰§è¡Œæ—¶é—´ç»Ÿè®¡**

```java
@Component
public class TimingBeanPostProcessor implements BeanPostProcessor {
    
    @Override
    public Object postProcessAfterInitialization(Object bean, String beanName) {
        // å¯ä»¥è¿”å›åŸå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥è¿”å›ä»£ç†å¯¹è±¡
        if (needTiming(beanName)) {
            return createTimingProxy(bean);  // åˆ›å»ºä»£ç†æ·»åŠ è®¡æ—¶åŠŸèƒ½
        }
        return bean;
    }
}
```

---

## 6. ğŸ”„ å®Œæ•´ç”Ÿå‘½å‘¨æœŸæµç¨‹


### 6.1 æµç¨‹å›¾ç¤º


```
å¼€å§‹
 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. å®ä¾‹åŒ–Bean               â”‚
â”‚  è°ƒç”¨æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. è®¾ç½®å¯¹è±¡å±æ€§             â”‚
â”‚  @Autowired æ³¨å…¥ä¾èµ–         â”‚
â”‚  @Value æ³¨å…¥é…ç½®å€¼           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. BeanPostProcessorå‰ç½®    â”‚
â”‚  postProcessBeforeInit()    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. åˆå§‹åŒ–                   â”‚
â”‚  @PostConstruct             â”‚
â”‚  afterPropertiesSet()       â”‚
â”‚  è‡ªå®šä¹‰initæ–¹æ³•              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. BeanPostProcessoråç½®    â”‚
â”‚  postProcessAfterInit()     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6. Beanå¯ä»¥ä½¿ç”¨äº†           â”‚
â”‚  æ‰§è¡Œä¸šåŠ¡é€»è¾‘                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â†“
å®¹å™¨å…³é—­
 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  7. é”€æ¯Bean                 â”‚
â”‚  @PreDestroy                â”‚
â”‚  destroy()                  â”‚
â”‚  è‡ªå®šä¹‰destroyæ–¹æ³•           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â†“
ç»“æŸ
```

### 6.2 å®Œæ•´ç¤ºä¾‹ä»£ç 


```java
@Component
public class CompleteLifecycleBean implements InitializingBean, DisposableBean {
    
    private String name;
    
    // æ­¥éª¤1ï¼šæ„é€ æ–¹æ³•
    public CompleteLifecycleBean() {
        System.out.println("1. æ„é€ æ–¹æ³•ï¼šå¯¹è±¡è¢«åˆ›å»º");
    }
    
    // æ­¥éª¤2ï¼šä¾èµ–æ³¨å…¥
    @Autowired
    public void setName(@Value("${bean.name}") String name) {
        this.name = name;
        System.out.println("2. ä¾èµ–æ³¨å…¥ï¼šname = " + name);
    }
    
    // æ­¥éª¤4.1ï¼š@PostConstruct
    @PostConstruct
    public void postConstruct() {
        System.out.println("4.1 @PostConstructï¼šæ‰§è¡Œåˆå§‹åŒ–");
    }
    
    // æ­¥éª¤4.2ï¼šInitializingBeanæ¥å£
    @Override
    public void afterPropertiesSet() {
        System.out.println("4.2 afterPropertiesSetï¼šå±æ€§è®¾ç½®å®Œæˆ");
    }
    
    // æ­¥éª¤7.1ï¼š@PreDestroy
    @PreDestroy
    public void preDestroy() {
        System.out.println("7.1 @PreDestroyï¼šå‡†å¤‡é”€æ¯");
    }
    
    // æ­¥éª¤7.2ï¼šDisposableBeanæ¥å£
    @Override
    public void destroy() {
        System.out.println("7.2 destroyï¼šæ‰§è¡Œé”€æ¯");
    }
}
```

**è¿è¡Œç»“æœ**ï¼š

```
1. æ„é€ æ–¹æ³•ï¼šå¯¹è±¡è¢«åˆ›å»º
2. ä¾èµ–æ³¨å…¥ï¼šname = testBean
3. BeanPostProcessorå‰ç½®å¤„ç†
4.1 @PostConstructï¼šæ‰§è¡Œåˆå§‹åŒ–
4.2 afterPropertiesSetï¼šå±æ€§è®¾ç½®å®Œæˆ
5. BeanPostProcessoråç½®å¤„ç†
6. Beanæ­£åœ¨è¢«ä½¿ç”¨...
7.1 @PreDestroyï¼šå‡†å¤‡é”€æ¯
7.2 destroyï¼šæ‰§è¡Œé”€æ¯
```

---

## 7. ğŸ¯ å®é™…åº”ç”¨åœºæ™¯


### 7.1 æ•°æ®åº“è¿æ¥ç®¡ç†


**åœºæ™¯**ï¼šåœ¨Beanåˆ›å»ºæ—¶æ‰“å¼€è¿æ¥ï¼Œé”€æ¯æ—¶å…³é—­è¿æ¥

```java
@Component
public class DatabaseService {
    
    private DataSource dataSource;
    private Connection connection;
    
    @Autowired
    public void setDataSource(DataSource dataSource) {
        this.dataSource = dataSource;
    }
    
    @PostConstruct
    public void openConnection() {
        try {
            connection = dataSource.getConnection();
            System.out.println("âœ… æ•°æ®åº“è¿æ¥å·²æ‰“å¼€");
        } catch (SQLException e) {
            System.err.println("âŒ è¿æ¥å¤±è´¥ï¼š" + e.getMessage());
        }
    }
    
    @PreDestroy
    public void closeConnection() {
        if (connection != null) {
            try {
                connection.close();
                System.out.println("âœ… æ•°æ®åº“è¿æ¥å·²å…³é—­");
            } catch (SQLException e) {
                System.err.println("âŒ å…³é—­å¤±è´¥ï¼š" + e.getMessage());
            }
        }
    }
}
```

### 7.2 ç¼“å­˜é¢„åŠ è½½


**åœºæ™¯**ï¼šåº”ç”¨å¯åŠ¨æ—¶åŠ è½½ç¼“å­˜æ•°æ®

```java
@Component
public class CacheService {
    
    private Map<String, Object> cache = new HashMap<>();
    
    @PostConstruct
    public void loadCache() {
        System.out.println("å¼€å§‹åŠ è½½ç¼“å­˜æ•°æ®...");
        // ä»æ•°æ®åº“åŠ è½½çƒ­ç‚¹æ•°æ®åˆ°å†…å­˜
        cache.put("config", loadConfigFromDB());
        cache.put("hotData", loadHotDataFromDB());
        System.out.println("ç¼“å­˜åŠ è½½å®Œæˆï¼Œå…±" + cache.size() + "æ¡æ•°æ®");
    }
    
    @PreDestroy
    public void saveCache() {
        System.out.println("ä¿å­˜ç¼“å­˜æ•°æ®åˆ°ç£ç›˜...");
        // å°†å†…å­˜æ•°æ®æŒä¹…åŒ–
        saveCacheToDisk(cache);
    }
}
```

### 7.3 å®šæ—¶ä»»åŠ¡ç®¡ç†


**åœºæ™¯**ï¼šå¯åŠ¨å®šæ—¶ä»»åŠ¡ï¼Œå…³é—­æ—¶åœæ­¢

```java
@Component
public class ScheduledTaskService {
    
    private ScheduledExecutorService scheduler;
    
    @PostConstruct
    public void startTask() {
        scheduler = Executors.newScheduledThreadPool(1);
        scheduler.scheduleAtFixedRate(() -> {
            System.out.println("æ‰§è¡Œå®šæ—¶ä»»åŠ¡ï¼š" + new Date());
        }, 0, 1, TimeUnit.MINUTES);
        System.out.println("âœ… å®šæ—¶ä»»åŠ¡å·²å¯åŠ¨");
    }
    
    @PreDestroy
    public void stopTask() {
        if (scheduler != null) {
            scheduler.shutdown();
            System.out.println("âœ… å®šæ—¶ä»»åŠ¡å·²åœæ­¢");
        }
    }
}
```

### 7.4 æ–‡ä»¶èµ„æºç®¡ç†


**åœºæ™¯**ï¼šåˆå§‹åŒ–æ—¶åˆ›å»ºä¸´æ—¶ç›®å½•ï¼Œé”€æ¯æ—¶æ¸…ç†

```java
@Component
public class FileService {
    
    private Path tempDir;
    
    @PostConstruct
    public void createTempDir() throws IOException {
        tempDir = Files.createTempDirectory("app-temp-");
        System.out.println("âœ… ä¸´æ—¶ç›®å½•å·²åˆ›å»ºï¼š" + tempDir);
    }
    
    @PreDestroy
    public void cleanupTempDir() throws IOException {
        if (tempDir != null && Files.exists(tempDir)) {
            Files.walk(tempDir)
                .sorted((a, b) -> -a.compareTo(b))  // å€’åºåˆ é™¤
                .forEach(path -> {
                    try {
                        Files.delete(path);
                    } catch (IOException e) {
                        e.printStackTrace();
                    }
                });
            System.out.println("âœ… ä¸´æ—¶ç›®å½•å·²æ¸…ç†");
        }
    }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Beanç”Ÿå‘½å‘¨æœŸï¼šåˆ›å»º â†’ åˆå§‹åŒ– â†’ ä½¿ç”¨ â†’ é”€æ¯
ğŸ”¸ åˆå§‹åŒ–ä¸‰ç§æ–¹å¼ï¼š@PostConstruct > InitializingBean > è‡ªå®šä¹‰æ–¹æ³•
ğŸ”¸ é”€æ¯ä¸‰ç§æ–¹å¼ï¼š@PreDestroy > DisposableBean > è‡ªå®šä¹‰æ–¹æ³•
ğŸ”¸ BeanPostProcessorï¼šåœ¨åˆå§‹åŒ–å‰åæ’å…¥è‡ªå®šä¹‰é€»è¾‘
ğŸ”¸ æ‰§è¡Œé¡ºåºï¼šæ„é€  â†’ æ³¨å…¥ â†’ å‰ç½®å¤„ç† â†’ åˆå§‹åŒ– â†’ åç½®å¤„ç† â†’ ä½¿ç”¨ â†’ é”€æ¯
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆéœ€è¦ç”Ÿå‘½å‘¨æœŸç®¡ç†**
- åœ¨åˆé€‚çš„æ—¶æœºåˆå§‹åŒ–èµ„æºï¼ˆæ•°æ®åº“è¿æ¥ã€ç¼“å­˜ï¼‰
- åœ¨Beané”€æ¯å‰é‡Šæ”¾èµ„æºï¼ˆå…³é—­è¿æ¥ã€åœæ­¢çº¿ç¨‹ï¼‰
- ç»Ÿä¸€ç®¡ç†Beançš„åˆ›å»ºå’Œé”€æ¯é€»è¾‘

**ğŸ”¹ ä¸‰ç§åˆå§‹åŒ–æ–¹å¼å¦‚ä½•é€‰æ‹©**

| åœºæ™¯ | æ¨èæ–¹å¼ | åŸå›  |
|------|---------|------|
| æ—¥å¸¸å¼€å‘ | @PostConstruct | ç®€å•æ–¹ä¾¿ |
| Springé¡¹ç›® | InitializingBean | æ¡†æ¶è§„èŒƒ |
| éœ€è¦è§£è€¦ | è‡ªå®šä¹‰æ–¹æ³• | ä¸æ¡†æ¶æ— å…³ |

**ğŸ”¹ BeanPostProcessorçš„ä½œç”¨**
- å¯ä»¥åœ¨æ‰€æœ‰Beanåˆå§‹åŒ–å‰ååšç»Ÿä¸€å¤„ç†
- Springçš„AOPã€äº‹åŠ¡ç­‰åŠŸèƒ½éƒ½æ˜¯åŸºäºæ­¤å®ç°
- å¯ä»¥è¿”å›åŸBeanï¼Œä¹Ÿå¯ä»¥è¿”å›ä»£ç†å¯¹è±¡

### 8.3 å®é™…å¼€å‘å»ºè®®


**âœ… æ¨èåšæ³•**ï¼š
- ä½¿ç”¨@PostConstructåšåˆå§‹åŒ–
- ä½¿ç”¨@PreDestroyåšæ¸…ç†
- ä¿æŒåˆå§‹åŒ–æ–¹æ³•ç®€å•ï¼Œä¸è¦æœ‰å¤æ‚é€»è¾‘
- é”€æ¯æ–¹æ³•è¦å¤„ç†å¼‚å¸¸ï¼Œé¿å…å½±å“å…¶ä»–Bean

**âŒ é¿å…è¸©å‘**ï¼š
- ä¸è¦åœ¨æ„é€ æ–¹æ³•ä¸­è®¿é—®æ³¨å…¥çš„ä¾èµ–ï¼ˆæ­¤æ—¶è¿˜æ²¡æ³¨å…¥ï¼‰
- åˆå§‹åŒ–æ–¹æ³•ä¸è¦æŠ›å‡ºå¼‚å¸¸ï¼ˆä¼šå¯¼è‡´Beanåˆ›å»ºå¤±è´¥ï¼‰
- é”€æ¯æ–¹æ³•è¦åŠ å¼‚å¸¸å¤„ç†ï¼ˆé¿å…èµ„æºæ³„æ¼ï¼‰

**è®°å¿†å£è¯€**ï¼š
```
Beanç”Ÿå‘½å››é˜¶æ®µï¼Œåˆ›å»ºåˆå§‹ç”¨é”€æ¯
æ³¨è§£æ–¹å¼æœ€ç®€å•ï¼ŒPostConstructæ¥åˆå§‹
PreDestroyåšæ¸…ç†ï¼Œèµ„æºé‡Šæ”¾è¦ç‰¢è®°
å¤„ç†å™¨å¾ˆå¼ºå¤§ï¼Œå‰åæ’å…¥è‡ªå®šä¹‰
```

### 8.4 å­¦ä¹ æ£€æŸ¥æ¸…å•


- [ ] ç†è§£Beanç”Ÿå‘½å‘¨æœŸçš„å››ä¸ªé˜¶æ®µ
- [ ] æŒæ¡ä¸‰ç§åˆå§‹åŒ–æ–¹å¼çš„ä½¿ç”¨
- [ ] æŒæ¡ä¸‰ç§é”€æ¯æ–¹å¼çš„ä½¿ç”¨
- [ ] äº†è§£BeanPostProcessorçš„ä½œç”¨
- [ ] èƒ½å¤Ÿå†™å‡ºå®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸç¤ºä¾‹
- [ ] çŸ¥é“å®é™…å¼€å‘ä¸­çš„åº”ç”¨åœºæ™¯