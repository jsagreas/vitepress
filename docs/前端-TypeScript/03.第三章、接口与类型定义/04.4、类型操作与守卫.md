---
title: 4ã€ç±»å‹æ“ä½œä¸å®ˆå«
---
## ğŸ“š ç›®å½•

1. [ç±»å‹æ“ä½œç¬¦è¯¦è§£](#1-ç±»å‹æ“ä½œç¬¦è¯¦è§£)
2. [ç±»å‹å®ˆå«æœºåˆ¶](#2-ç±»å‹å®ˆå«æœºåˆ¶)
3. [ç±»å‹æ–­è¨€ä¸éç©ºå¤„ç†](#3-ç±»å‹æ–­è¨€ä¸éç©ºå¤„ç†)
4. [å®æˆ˜åº”ç”¨åœºæ™¯](#4-å®æˆ˜åº”ç”¨åœºæ™¯)
5. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#5-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”§ ç±»å‹æ“ä½œç¬¦è¯¦è§£


### 1.1 keyof æ“ä½œç¬¦ï¼šè·å–å¯¹è±¡é”®çš„è”åˆç±»å‹


**ğŸ”¸ ä»€ä¹ˆæ˜¯ keyof**
```typescript
// keyof å°±åƒä¸€ä¸ª"é’¥åŒ™æ”¶é›†å™¨"ï¼ŒæŠŠå¯¹è±¡çš„æ‰€æœ‰å±æ€§åå˜æˆç±»å‹
interface User {
  name: string;
  age: number;
  email: string;
}

type UserKeys = keyof User;  // "name" | "age" | "email"
```

**ğŸ’¡ é€šä¿—ç†è§£**ï¼š
- `keyof` å°±æ˜¯æŠŠå¯¹è±¡çš„æ‰€æœ‰**å±æ€§å**æå–å‡ºæ¥ï¼Œç»„æˆä¸€ä¸ªè”åˆç±»å‹
- å°±åƒä»ä¸€å †é’¥åŒ™ä¸­æŠŠæ‰€æœ‰é’¥åŒ™çš„åå­—åˆ—å‡ºæ¥

**ğŸ¯ å®é™…åº”ç”¨åœºæ™¯**
```typescript
// åœºæ™¯1ï¼šåŠ¨æ€è®¿é—®å¯¹è±¡å±æ€§
function getValue<T, K extends keyof T>(obj: T, key: K): T[K] {
  return obj[key];
}

const user = { name: "å¼ ä¸‰", age: 25, email: "zhangsan@qq.com" };
const userName = getValue(user, "name");    // string ç±»å‹
const userAge = getValue(user, "age");      // number ç±»å‹
// const invalid = getValue(user, "height"); // æŠ¥é”™ï¼height ä¸å­˜åœ¨

// åœºæ™¯2ï¼šå¯¹è±¡å±æ€§éå†
function printUserInfo<T>(obj: T) {
  const keys = Object.keys(obj) as Array<keyof T>;
  keys.forEach(key => {
    console.log(`${String(key)}: ${obj[key]}`);
  });
}
```

### 1.2 typeof æ“ä½œç¬¦ï¼šè·å–å˜é‡çš„ç±»å‹


**ğŸ”¸ typeof çš„ä¸¤ç§ç”¨æ³•**
```typescript
// 1. JavaScript ä¸­çš„ typeofï¼ˆè¿è¡Œæ—¶ï¼‰
console.log(typeof "hello");  // "string"

// 2. TypeScript ä¸­çš„ typeofï¼ˆç¼–è¯‘æ—¶ï¼‰
const config = {
  apiUrl: "https://api.example.com",
  timeout: 5000,
  retries: 3
};

type Config = typeof config;
// ç­‰ä»·äºï¼š
// type Config = {
//   apiUrl: string;
//   timeout: number;
//   retries: number;
// }
```

**ğŸ’¡ å®é™…åº”ç”¨**
```typescript
// ä»ç°æœ‰å˜é‡æ¨å¯¼ç±»å‹ï¼Œé¿å…é‡å¤å®šä¹‰
const defaultSettings = {
  theme: "dark" as const,
  fontSize: 14,
  autoSave: true
};

type Settings = typeof defaultSettings;

// å‡½æ•°ç±»å‹æ¨å¯¼
function createUser(name: string, age: number) {
  return { name, age, id: Math.random() };
}

type CreateUserFunction = typeof createUser;
type UserResult = ReturnType<typeof createUser>;  // { name: string; age: number; id: number }
```

### 1.3 in æ“ä½œç¬¦ï¼šå±æ€§æ£€æŸ¥ä¸ç±»å‹ç¼©å°


**ğŸ”¸ in æ“ä½œç¬¦çš„ä½œç”¨**
```typescript
// æ£€æŸ¥å¯¹è±¡æ˜¯å¦åŒ…å«æŸä¸ªå±æ€§
interface Cat {
  name: string;
  meow: () => void;
}

interface Dog {
  name: string;
  bark: () => void;
}

type Pet = Cat | Dog;

function handlePet(pet: Pet) {
  if ("meow" in pet) {
    // TypeScript çŸ¥é“è¿™é‡Œ pet æ˜¯ Cat ç±»å‹
    pet.meow();  // å®‰å…¨è°ƒç”¨
  } else {
    // TypeScript çŸ¥é“è¿™é‡Œ pet æ˜¯ Dog ç±»å‹
    pet.bark();  // å®‰å…¨è°ƒç”¨
  }
}
```

**ğŸ“Š æ˜ å°„ç±»å‹ä¸­çš„ in æ“ä½œç¬¦**
```typescript
// éå†è”åˆç±»å‹åˆ›å»ºæ–°ç±»å‹
type Optional<T> = {
  [K in keyof T]?: T[K];  // å°†æ‰€æœ‰å±æ€§å˜ä¸ºå¯é€‰
};

type PartialUser = Optional<User>;
// ç»“æœï¼š
// {
//   name?: string;
//   age?: number;
//   email?: string;
// }
```

---

## 2. ğŸ›¡ï¸ ç±»å‹å®ˆå«æœºåˆ¶


### 2.1 typeof ç±»å‹å®ˆå«ï¼šåŸºç¡€ç±»å‹æ£€æŸ¥


**ğŸ”¸ åŸºæœ¬ç”¨æ³•**
```typescript
function processValue(value: string | number) {
  if (typeof value === "string") {
    // è¿™é‡Œ TypeScript çŸ¥é“ value æ˜¯ string
    console.log(value.toUpperCase());  // å¯ä»¥å®‰å…¨è°ƒç”¨å­—ç¬¦ä¸²æ–¹æ³•
  } else {
    // è¿™é‡Œ TypeScript çŸ¥é“ value æ˜¯ number
    console.log(value.toFixed(2));     // å¯ä»¥å®‰å…¨è°ƒç”¨æ•°å­—æ–¹æ³•
  }
}
```

**ğŸ’¡ å¸¸è§çš„ typeof æ£€æŸ¥**
```typescript
function smartProcess(input: unknown) {
  if (typeof input === "string") {
    return input.length;           // string æ“ä½œ
  }
  if (typeof input === "number") {
    return input * 2;              // number æ“ä½œ
  }
  if (typeof input === "boolean") {
    return input ? 1 : 0;          // boolean æ“ä½œ
  }
  return null;  // å…¶ä»–ç±»å‹
}
```

### 2.2 instanceof ç±»å‹å®ˆå«ï¼šå®ä¾‹ç±»å‹æ£€æŸ¥


**ğŸ”¸ æ£€æŸ¥å¯¹è±¡æ˜¯å¦ä¸ºç‰¹å®šç±»çš„å®ä¾‹**
```typescript
class Car {
  drive() {
    console.log("è½¦å­åœ¨è¡Œé©¶");
  }
}

class Plane {
  fly() {
    console.log("é£æœºåœ¨é£è¡Œ");
  }
}

function operate(vehicle: Car | Plane) {
  if (vehicle instanceof Car) {
    vehicle.drive();  // å®‰å…¨è°ƒç”¨ Car çš„æ–¹æ³•
  } else {
    vehicle.fly();    // å®‰å…¨è°ƒç”¨ Plane çš„æ–¹æ³•
  }
}
```

**ğŸŒŸ å†…ç½®å¯¹è±¡æ£€æŸ¥**
```typescript
function handleInput(input: unknown) {
  if (input instanceof Date) {
    console.log(input.getFullYear());  // Date æ–¹æ³•
  } else if (input instanceof Array) {
    console.log(input.length);         // Array æ–¹æ³•
  } else if (input instanceof Error) {
    console.log(input.message);        // Error æ–¹æ³•
  }
}
```

### 2.3 è‡ªå®šä¹‰ç±»å‹å®ˆå«ï¼šç²¾ç¡®ç±»å‹åˆ¤æ–­


**ğŸ”¸ ä½¿ç”¨ is å…³é”®å­—å®šä¹‰ç±»å‹è°“è¯**
```typescript
// è‡ªå®šä¹‰å®ˆå«å‡½æ•°
interface Fish {
  swim: () => void;
}

interface Bird {
  fly: () => void;
}

// ç±»å‹è°“è¯å‡½æ•°ï¼šå‚æ•°å is ç±»å‹å
function isFish(animal: Fish | Bird): animal is Fish {
  return 'swim' in animal;
}

function handleAnimal(animal: Fish | Bird) {
  if (isFish(animal)) {
    animal.swim();  // TypeScript ç¡®è®¤è¿™æ˜¯ Fish
  } else {
    animal.fly();   // TypeScript ç¡®è®¤è¿™æ˜¯ Bird
  }
}
```

**ğŸ“‹ å®ç”¨çš„è‡ªå®šä¹‰å®ˆå«**
```typescript
// æ£€æŸ¥æ˜¯å¦ä¸ºéç©ºå€¼
function isNotNull<T>(value: T | null | undefined): value is T {
  return value !== null && value !== undefined;
}

// æ£€æŸ¥æ˜¯å¦ä¸ºå­—ç¬¦ä¸²æ•°ç»„
function isStringArray(value: unknown): value is string[] {
  return Array.isArray(value) && value.every(item => typeof item === "string");
}

// ä½¿ç”¨ç¤ºä¾‹
const data: unknown = ["hello", "world"];
if (isStringArray(data)) {
  // è¿™é‡Œ data è¢«ç¡®è®¤ä¸º string[] ç±»å‹
  data.forEach(str => console.log(str.toUpperCase()));
}
```

---

## 3. âš¡ ç±»å‹æ–­è¨€ä¸éç©ºå¤„ç†


### 3.1 ç±»å‹æ–­è¨€ï¼šas è¯­æ³•


**ğŸ”¸ ä»€ä¹ˆæ—¶å€™éœ€è¦ç±»å‹æ–­è¨€**
```typescript
// å½“ä½ æ¯” TypeScript æ›´äº†è§£ç±»å‹æ—¶ä½¿ç”¨
const canvas = document.getElementById("canvas") as HTMLCanvasElement;
// getElementById è¿”å› HTMLElement | nullï¼Œä½†ä½ ç¡®å®šå®ƒæ˜¯ canvas

// API è¿”å›çš„æ•°æ®
const userData = JSON.parse(jsonString) as User;
// JSON.parse è¿”å› anyï¼Œä½†ä½ çŸ¥é“å®ƒæ˜¯ User ç±»å‹
```

**âš ï¸ ç±»å‹æ–­è¨€çš„æ³¨æ„äº‹é¡¹**
```typescript
// âœ… å®‰å…¨çš„æ–­è¨€ï¼ˆç±»å‹å…¼å®¹ï¼‰
const someValue: unknown = "hello world";
const strLength = (someValue as string).length;

// âŒ å±é™©çš„æ–­è¨€ï¼ˆå¯èƒ½å‡ºé”™ï¼‰
const num: number = 42;
// const str = num as string;  // ç¼–è¯‘é”™è¯¯ï¼number å’Œ string ä¸å…¼å®¹

// åŒé‡æ–­è¨€ï¼ˆä¸æ¨èï¼Œé™¤éä¸‡ä¸å¾—å·²ï¼‰
const force = (num as unknown) as string;  // å…ˆè½¬ä¸º unknown å†è½¬ä¸ºç›®æ ‡ç±»å‹
```

**ğŸ¯ å®é™…åº”ç”¨åœºæ™¯**
```typescript
// DOM æ“ä½œä¸­çš„ç±»å‹æ–­è¨€
const form = document.querySelector("#userForm") as HTMLFormElement;
const input = form.querySelector("input[name='email']") as HTMLInputElement;

// äº‹ä»¶å¤„ç†ä¸­çš„æ–­è¨€
function handleSubmit(event: Event) {
  const target = event.target as HTMLFormElement;
  const formData = new FormData(target);
}
```

### 3.2 éç©ºæ–­è¨€ï¼š! æ“ä½œç¬¦


**ğŸ”¸ å‘Šè¯‰ TypeScript "æˆ‘ç¡®å®šè¿™ä¸æ˜¯ null/undefined"**
```typescript
// å‡½æ•°å¯èƒ½è¿”å› nullï¼Œä½†ä½ ç¡®å®šåœ¨æŸä¸ªä¸Šä¸‹æ–‡ä¸­ä¸ä¼šæ˜¯ null
function findUser(id: string): User | null {
  // ... æŸ¥æ‰¾é€»è¾‘
  return null;  // ç¤ºä¾‹
}

const userId = "123";
const user = findUser(userId)!;  // å‘Šè¯‰ TSï¼šæˆ‘ç¡®å®šè¿™ä¸æ˜¯ null
console.log(user.name);  // ä¸ä¼šæœ‰ç±»å‹é”™è¯¯
```

**ğŸ’¡ å¸¸è§ä½¿ç”¨åœºæ™¯**
```typescript
// 1. æ•°ç»„è®¿é—®
const numbers = [1, 2, 3, 4, 5];
const firstItem = numbers[0]!;  // ç¡®å®šæ•°ç»„ä¸ä¸ºç©º

// 2. DOM æŸ¥è¯¢
const button = document.querySelector("#submitBtn")!;  // ç¡®å®šå…ƒç´ å­˜åœ¨
button.addEventListener("click", handleClick);

// 3. å¯¹è±¡å±æ€§è®¿é—®
interface Config {
  database?: {
    host: string;
    port: number;
  };
}

const config: Config = getConfig();
// åœ¨æŸäº›æƒ…å†µä¸‹ä½ ç¡®å®š database å­˜åœ¨
const dbHost = config.database!.host;
```

**âš ï¸ ä½¿ç”¨éç©ºæ–­è¨€çš„æ³¨æ„äº‹é¡¹**
```typescript
// è°¨æ…ä½¿ç”¨ï¼å¦‚æœåˆ¤æ–­é”™è¯¯ä¼šå¯¼è‡´è¿è¡Œæ—¶é”™è¯¯
const users: User[] = [];
// const firstUser = users[0]!;  // å±é™©ï¼æ•°ç»„å¯èƒ½ä¸ºç©º
// console.log(firstUser.name);   // è¿è¡Œæ—¶é”™è¯¯

// æ›´å®‰å…¨çš„å†™æ³•
const firstUser = users[0];
if (firstUser) {
  console.log(firstUser.name);  // å®‰å…¨
}
```

---

## 4. ğŸš€ å®æˆ˜åº”ç”¨åœºæ™¯


### 4.1 API æ•°æ®å¤„ç†


```typescript
// API å“åº”å¤„ç†
interface ApiResponse<T> {
  success: boolean;
  data?: T;
  error?: string;
}

function isSuccessResponse<T>(response: ApiResponse<T>): response is ApiResponse<T> & { data: T } {
  return response.success && response.data !== undefined;
}

async function fetchUserData(id: string) {
  const response: ApiResponse<User> = await fetch(`/api/users/${id}`).then(r => r.json());
  
  if (isSuccessResponse(response)) {
    // è¿™é‡Œ response.data ç¡®å®šå­˜åœ¨ä¸”ä¸º User ç±»å‹
    console.log(response.data.name);
  } else {
    console.error(response.error || "æœªçŸ¥é”™è¯¯");
  }
}
```

### 4.2 è¡¨å•æ•°æ®éªŒè¯


```typescript
// è¡¨å•æ•°æ®ç±»å‹å®ˆå«
interface LoginForm {
  username: string;
  password: string;
}

function isValidLoginForm(data: any): data is LoginForm {
  return typeof data === "object" &&
         typeof data.username === "string" &&
         typeof data.password === "string" &&
         data.username.length > 0 &&
         data.password.length > 0;
}

function handleLogin(formData: unknown) {
  if (isValidLoginForm(formData)) {
    // å®‰å…¨è®¿é—® formData.username å’Œ formData.password
    console.log(`ç”¨æˆ· ${formData.username} æ­£åœ¨ç™»å½•`);
  } else {
    throw new Error("è¡¨å•æ•°æ®æ ¼å¼é”™è¯¯");
  }
}
```

### 4.3 åŠ¨æ€é…ç½®å¤„ç†


```typescript
// é…ç½®å¯¹è±¡çš„ç±»å‹æ“ä½œ
const defaultConfig = {
  theme: "light",
  language: "zh-CN",
  notifications: true,
  autoSave: false
} as const;

type ConfigKey = keyof typeof defaultConfig;
type ConfigValue<K extends ConfigKey> = typeof defaultConfig[K];

// ç±»å‹å®‰å…¨çš„é…ç½®æ›´æ–°å‡½æ•°
function updateConfig<K extends ConfigKey>(
  key: K, 
  value: ConfigValue<K>
): void {
  // æ›´æ–°é…ç½®é€»è¾‘
  console.log(`æ›´æ–°é…ç½® ${key} ä¸º ${value}`);
}

// ä½¿ç”¨æ—¶æœ‰å®Œæ•´çš„ç±»å‹æ£€æŸ¥
updateConfig("theme", "dark");        // âœ… æ­£ç¡®
updateConfig("language", "en-US");    // âœ… æ­£ç¡®
// updateConfig("theme", "blue");     // âŒ é”™è¯¯ï¼šblue ä¸æ˜¯æœ‰æ•ˆçš„ä¸»é¢˜
```

---

## 5. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 5.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ keyofï¼šè·å–å¯¹è±¡é”®çš„è”åˆç±»å‹ï¼Œå¸¸ç”¨äºæ³›å‹çº¦æŸ
ğŸ”¸ typeofï¼šè·å–å˜é‡ç±»å‹ï¼Œé¿å…é‡å¤ç±»å‹å®šä¹‰
ğŸ”¸ in æ“ä½œç¬¦ï¼šå±æ€§æ£€æŸ¥å’Œç±»å‹ç¼©å°çš„åˆ©å™¨
ğŸ”¸ ç±»å‹å®ˆå«ï¼šè¿è¡Œæ—¶ç±»å‹æ£€æŸ¥ï¼Œè®©ä»£ç æ›´å®‰å…¨
ğŸ”¸ ç±»å‹æ–­è¨€ï¼šå½“ä½ æ¯” TS æ›´äº†è§£ç±»å‹æ—¶ä½¿ç”¨
ğŸ”¸ éç©ºæ–­è¨€ï¼šç¡®å®šå€¼ä¸ä¸º null/undefined æ—¶ä½¿ç”¨
```

### 5.2 å®ç”¨æŠ€å·§è®°å¿†


**ğŸ”¹ é€‰æ‹©åˆé€‚çš„ç±»å‹æ“ä½œæ–¹å¼**
```
åŸºç¡€ç±»å‹æ£€æŸ¥ â†’ ä½¿ç”¨ typeof å®ˆå«
å¯¹è±¡å®ä¾‹æ£€æŸ¥ â†’ ä½¿ç”¨ instanceof å®ˆå«
å¤æ‚é€»è¾‘æ£€æŸ¥ â†’ è‡ªå®šä¹‰ç±»å‹å®ˆå«å‡½æ•°
ç¡®å®šç±»å‹è½¬æ¢ â†’ ä½¿ç”¨ as æ–­è¨€
ç¡®å®šéç©ºå€¼ â†’ ä½¿ç”¨ ! éç©ºæ–­è¨€
```

**ğŸ”¹ å®‰å…¨ä½¿ç”¨åŸåˆ™**
```
ç±»å‹å®ˆå« > ç±»å‹æ–­è¨€ > éç©ºæ–­è¨€
èƒ½ç”¨å®ˆå«å°±ä¸ç”¨æ–­è¨€ï¼Œèƒ½ç”¨æ–­è¨€å°±ä¸ç”¨ any
å¤šåšè¿è¡Œæ—¶æ£€æŸ¥ï¼Œå°‘åšå¼ºåˆ¶è½¬æ¢
```

### 5.3 å¸¸è§ä½¿ç”¨æ¨¡å¼


| åœºæ™¯ | æ¨èæ–¹æ¡ˆ | ç¤ºä¾‹ |
|------|---------|------|
| **åŸºç¡€ç±»å‹åˆ¤æ–­** | `typeof å®ˆå«` | `typeof value === "string"` |
| **å¯¹è±¡å®ä¾‹åˆ¤æ–­** | `instanceof å®ˆå«` | `obj instanceof Array` |
| **å±æ€§å­˜åœ¨åˆ¤æ–­** | `in æ“ä½œç¬¦` | `"prop" in obj` |
| **å¤æ‚ç±»å‹åˆ¤æ–­** | `è‡ªå®šä¹‰å®ˆå«` | `function isUser(obj): obj is User` |
| **DOM å…ƒç´ è½¬æ¢** | `as æ–­è¨€` | `element as HTMLInputElement` |
| **ç¡®å®šéç©º** | `! æ–­è¨€` | `array[0]!` |

### 5.4 æœ€ä½³å®è·µ


**âœ… æ¨èåšæ³•**
- ä¼˜å…ˆä½¿ç”¨ç±»å‹å®ˆå«è¿›è¡Œç±»å‹ç¼©å°
- ç»“åˆ `keyof` å’Œæ³›å‹åˆ›å»ºç±»å‹å®‰å…¨çš„å·¥å…·å‡½æ•°
- ä¸ºå¤æ‚çš„ç±»å‹åˆ¤æ–­ç¼–å†™è‡ªå®šä¹‰å®ˆå«å‡½æ•°
- åœ¨ç¡®å®šå®‰å…¨çš„æƒ…å†µä¸‹ä½¿ç”¨ç±»å‹æ–­è¨€

**âŒ é¿å…çš„åšæ³•**
- è¿‡åº¦ä½¿ç”¨ç±»å‹æ–­è¨€ï¼Œç»•è¿‡ç±»å‹æ£€æŸ¥
- åœ¨ä¸ç¡®å®šçš„æƒ…å†µä¸‹ä½¿ç”¨éç©ºæ–­è¨€
- å¿½è§†è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥ï¼Œåªä¾èµ–ç¼–è¯‘æ—¶ç±»å‹

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- keyof å–é”®åï¼Œtypeof å–ç±»å‹
- in æŸ¥å±æ€§ï¼Œå®ˆå«ä¿å®‰å…¨
- æ–­è¨€éœ€è°¨æ…ï¼Œéç©ºè¦ç¡®å®š
- ç±»å‹æ“ä½œå¥½ï¼Œä»£ç è´¨é‡é«˜