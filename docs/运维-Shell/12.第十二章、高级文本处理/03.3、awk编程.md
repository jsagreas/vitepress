---
title: 3ã€awkç¼–ç¨‹
---
## ğŸ“š ç›®å½•

1. [awkåŸºç¡€æ¦‚å¿µä¸å·¥ä½œåŸç†](#1-awkåŸºç¡€æ¦‚å¿µä¸å·¥ä½œåŸç†)
2. [å†…ç½®å˜é‡è¯¦è§£](#2-å†…ç½®å˜é‡è¯¦è§£)
3. [å­—æ®µè®¿é—®ä¸å¤„ç†](#3-å­—æ®µè®¿é—®ä¸å¤„ç†)
4. [æ¨¡å¼åŒ¹é…æœºåˆ¶](#4-æ¨¡å¼åŒ¹é…æœºåˆ¶)
5. [æ¡ä»¶åˆ¤æ–­ä¸å¾ªç¯æ§åˆ¶](#5-æ¡ä»¶åˆ¤æ–­ä¸å¾ªç¯æ§åˆ¶)
6. [æ•°ç»„çš„ä½¿ç”¨æŠ€å·§](#6-æ•°ç»„çš„ä½¿ç”¨æŠ€å·§)
7. [å†…ç½®å‡½æ•°åº”ç”¨](#7-å†…ç½®å‡½æ•°åº”ç”¨)
8. [æ•°å€¼è®¡ç®—ä¸ç»Ÿè®¡åˆ†æ](#8-æ•°å€¼è®¡ç®—ä¸ç»Ÿè®¡åˆ†æ)
9. [ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°](#9-ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°)
10. [awkä¸å…¶ä»–å·¥å…·é…åˆ](#10-awkä¸å…¶ä»–å·¥å…·é…åˆ)
11. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#11-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ awkåŸºç¡€æ¦‚å¿µä¸å·¥ä½œåŸç†


### 1.1 ä»€ä¹ˆæ˜¯awk


**awk**æ˜¯ä¸€ç§å¼ºå¤§çš„æ–‡æœ¬å¤„ç†å·¥å…·ï¼Œä¸“é—¨ç”¨äºå¤„ç†ç»“æ„åŒ–æ•°æ®ã€‚å®ƒçš„åå­—æ¥æºäºä¸‰ä½åˆ›å§‹äººçš„å§“æ°é¦–å­—æ¯ï¼š**A**hoã€**W**einbergerã€**K**ernighanã€‚

ğŸŒ° **ç®€å•ç†è§£**ï¼šæŠŠawkæƒ³è±¡æˆä¸€ä¸ªèªæ˜çš„æ–‡ä»¶åŠ©æ‰‹ï¼Œå®ƒèƒ½å¤Ÿé€è¡Œè¯»å–æ–‡ä»¶ï¼ŒæŒ‰ç…§ä½ çš„æŒ‡ä»¤å¯¹æ¯ä¸€è¡Œè¿›è¡Œå¤„ç†ï¼Œå°±åƒä¸€ä¸ªè‡ªåŠ¨åŒ–çš„æ•°æ®åˆ†æå‘˜ã€‚

### 1.2 awkçš„æ ¸å¿ƒå·¥ä½œåŸç†


**ğŸ”¸ æ¨¡å¼-åŠ¨ä½œæ¶æ„**

awkçš„å·¥ä½œæ–¹å¼éµå¾ª **"æ¨¡å¼-åŠ¨ä½œ"** çš„æ¶æ„ï¼š
```
æ¨¡å¼ { åŠ¨ä½œ }
```

**é€šä¿—è§£é‡Š**ï¼š
- **æ¨¡å¼ï¼ˆPatternï¼‰**ï¼šç›¸å½“äº"æ¡ä»¶"ï¼Œå‘Šè¯‰awkä»€ä¹ˆæ—¶å€™æ‰§è¡ŒåŠ¨ä½œ
- **åŠ¨ä½œï¼ˆActionï¼‰**ï¼šç›¸å½“äº"æŒ‡ä»¤"ï¼Œå‘Šè¯‰awkå…·ä½“è¦åšä»€ä¹ˆ

```bash
# åŸºæœ¬è¯­æ³•ç»“æ„
awk 'pattern { action }' filename
```

### 1.3 awkçš„å¤„ç†æµç¨‹


```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¯»å–ä¸€è¡Œ    â”‚â”€â”€â”€â–¶â”‚  åŒ¹é…æ¨¡å¼    â”‚â”€â”€â”€â–¶â”‚  æ‰§è¡ŒåŠ¨ä½œ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              é‡å¤å¤„ç†ä¸‹ä¸€è¡Œ
```

**ğŸ”¸ å¤„ç†æ­¥éª¤è¯¦è§£**ï¼š
1. **é€è¡Œè¯»å–**ï¼šawkä»æ–‡ä»¶ä¸­è¯»å–ä¸€è¡Œæ•°æ®
2. **æ¨¡å¼åŒ¹é…**ï¼šæ£€æŸ¥å½“å‰è¡Œæ˜¯å¦ç¬¦åˆæŒ‡å®šçš„æ¨¡å¼
3. **æ‰§è¡ŒåŠ¨ä½œ**ï¼šå¦‚æœåŒ¹é…ï¼Œå°±æ‰§è¡Œç›¸åº”çš„åŠ¨ä½œ
4. **ç»§ç»­å¾ªç¯**ï¼šå¤„ç†ä¸‹ä¸€è¡Œï¼Œé‡å¤ä¸Šè¿°è¿‡ç¨‹

### 1.4 ç¬¬ä¸€ä¸ªawkç¨‹åº


**ğŸš€ å¿«é€Ÿå…¥é—¨ç¤ºä¾‹**

å‡è®¾æœ‰ä¸€ä¸ªå­¦ç”Ÿæˆç»©æ–‡ä»¶ `students.txt`ï¼š
```
å¼ ä¸‰ 90 85 88
æå›› 78 92 86
ç‹äº” 85 79 91
```

```bash
# æ‰“å°æ‰€æœ‰å­¦ç”Ÿä¿¡æ¯
awk '{ print }' students.txt
```

**è§£é‡Šè¯´æ˜**ï¼š
- `{ print }`ï¼šè¿™æ˜¯åŠ¨ä½œéƒ¨åˆ†ï¼Œ`print` è¡¨ç¤ºæ‰“å°æ•´è¡Œ
- æ²¡æœ‰æŒ‡å®šæ¨¡å¼ï¼Œè¡¨ç¤ºå¯¹æ‰€æœ‰è¡Œéƒ½æ‰§è¡Œè¿™ä¸ªåŠ¨ä½œ
- ç›¸å½“äº `cat` å‘½ä»¤çš„æ•ˆæœ

---

## 2. ğŸ“Š å†…ç½®å˜é‡è¯¦è§£


### 2.1 å­—æ®µç›¸å…³å˜é‡


**ğŸ”¸ NFï¼ˆNumber of Fieldsï¼‰- å­—æ®µæ•°é‡**

`NF` è¡¨ç¤ºå½“å‰è¡Œæœ‰å¤šå°‘ä¸ªå­—æ®µï¼ˆç”¨ç©ºæ ¼æˆ–æŒ‡å®šåˆ†éš”ç¬¦åˆ†å‰²ï¼‰ã€‚

```bash
# æŸ¥çœ‹æ¯è¡Œçš„å­—æ®µæ•°é‡
awk '{ print "ç¬¬" NR "è¡Œæœ‰" NF "ä¸ªå­—æ®µ" }' students.txt
```

**ğŸ”¸ å­—æ®µè®¿é—®å˜é‡**
- `$0`ï¼šæ•´ä¸ªå½“å‰è¡Œ
- `$1`ï¼šç¬¬ä¸€ä¸ªå­—æ®µ
- `$2`ï¼šç¬¬äºŒä¸ªå­—æ®µ
- `$NF`ï¼šæœ€åä¸€ä¸ªå­—æ®µï¼ˆæœ€å¸¸ç”¨çš„æŠ€å·§ï¼‰

```bash
# åªæ‰“å°å§“åå’Œæ€»æˆç»©ï¼ˆå‡è®¾æœ€åä¸€ä¸ªå­—æ®µæ˜¯æ€»æˆç»©ï¼‰
awk '{ print $1, $NF }' students.txt
```

### 2.2 è¡Œå¤„ç†å˜é‡


**ğŸ”¸ NRï¼ˆNumber of Recordsï¼‰- è¡Œå·**

`NR` è¡¨ç¤ºå½“å‰å¤„ç†çš„è¡Œå·ï¼Œä»1å¼€å§‹è®¡æ•°ã€‚

```bash
# ç»™æ¯è¡ŒåŠ ä¸Šè¡Œå·
awk '{ print NR ": " $0 }' students.txt
```

### 2.3 åˆ†éš”ç¬¦æ§åˆ¶å˜é‡


**ğŸ”¸ FSï¼ˆField Separatorï¼‰- è¾“å…¥å­—æ®µåˆ†éš”ç¬¦**

`FS` å®šä¹‰å¦‚ä½•åˆ†å‰²å­—æ®µï¼Œé»˜è®¤æ˜¯ç©ºæ ¼å’Œåˆ¶è¡¨ç¬¦ã€‚

```bash
# å¤„ç†CSVæ–‡ä»¶ï¼ˆé€—å·åˆ†éš”ï¼‰
awk 'BEGIN { FS="," } { print $1, $3 }' data.csv
```

**ğŸ”¸ RSï¼ˆRecord Separatorï¼‰- è¾“å…¥è®°å½•åˆ†éš”ç¬¦**

`RS` å®šä¹‰å¦‚ä½•åˆ†å‰²è®°å½•ï¼ˆè¡Œï¼‰ï¼Œé»˜è®¤æ˜¯æ¢è¡Œç¬¦ã€‚

**ğŸ”¸ OFSï¼ˆOutput Field Separatorï¼‰- è¾“å‡ºå­—æ®µåˆ†éš”ç¬¦**

`OFS` å®šä¹‰è¾“å‡ºæ—¶å­—æ®µä¹‹é—´çš„åˆ†éš”ç¬¦ï¼Œé»˜è®¤æ˜¯ç©ºæ ¼ã€‚

```bash
# ç”¨åˆ¶è¡¨ç¬¦åˆ†éš”è¾“å‡º
awk 'BEGIN { OFS="\t" } { print $1, $2, $3 }' students.txt
```

**ğŸ”¸ ORSï¼ˆOutput Record Separatorï¼‰- è¾“å‡ºè®°å½•åˆ†éš”ç¬¦**

`ORS` å®šä¹‰è¾“å‡ºæ—¶è®°å½•ä¹‹é—´çš„åˆ†éš”ç¬¦ï¼Œé»˜è®¤æ˜¯æ¢è¡Œç¬¦ã€‚

### 2.4 å†…ç½®å˜é‡é€ŸæŸ¥è¡¨


| å˜é‡ | **å«ä¹‰** | **é»˜è®¤å€¼** | **å¸¸ç”¨åœºæ™¯** |
|------|---------|-----------|-------------|
| `NF` | **å­—æ®µæ•°é‡** | `è‡ªåŠ¨è®¡ç®—` | `æ£€æŸ¥æ•°æ®æ ¼å¼å®Œæ•´æ€§` |
| `NR` | **å½“å‰è¡Œå·** | `è‡ªåŠ¨é€’å¢` | `æ·»åŠ è¡Œå·ã€ç»Ÿè®¡è¡Œæ•°` |
| `$0` | **æ•´è¡Œå†…å®¹** | `å½“å‰è¡Œ` | `æ‰“å°å®Œæ•´è®°å½•` |
| `$1,$2...` | **æŒ‡å®šå­—æ®µ** | `æŒ‰åˆ†éš”ç¬¦åˆ‡åˆ†` | `æå–ç‰¹å®šåˆ—æ•°æ®` |
| `FS` | **è¾“å…¥åˆ†éš”ç¬¦** | `ç©ºæ ¼/åˆ¶è¡¨ç¬¦` | `å¤„ç†CSVã€TSVæ–‡ä»¶` |
| `OFS` | **è¾“å‡ºåˆ†éš”ç¬¦** | `ç©ºæ ¼` | `æ ¼å¼åŒ–è¾“å‡º` |

---

## 3. ğŸ”§ å­—æ®µè®¿é—®ä¸å¤„ç†


### 3.1 åŸºæœ¬å­—æ®µè®¿é—®


**å­—æ®µç¼–å·ä»1å¼€å§‹**ï¼Œè¿™ç‚¹å’Œæ•°ç»„ä¸åŒï¼š

```bash
# å‡è®¾æ•°æ®ï¼šå¼ ä¸‰ 90 85 88
awk '{ 
    print "å§“åï¼š" $1
    print "æ•°å­¦ï¼š" $2  
    print "è‹±è¯­ï¼š" $3
    print "è¯­æ–‡ï¼š" $4
}' students.txt
```

### 3.2 åŠ¨æ€å­—æ®µè®¿é—®


**ğŸ”¸ ä½¿ç”¨$NFè®¿é—®æœ€åä¸€ä¸ªå­—æ®µ**

è¿™æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„æŠ€å·§ï¼Œå½“ä½ ä¸çŸ¥é“æœ‰å¤šå°‘åˆ—æ—¶ï¼š

```bash
# æ‰“å°å§“åå’Œæœ€åä¸€ä¸ªæˆç»©
awk '{ print $1 "çš„æœ€åä¸€é—¨æˆç»©ï¼š" $NF }' students.txt
```

**ğŸ”¸ å€’æ•°ç¬¬äºŒä¸ªå­—æ®µï¼š$(NF-1)**

```bash
# æ‰“å°å€’æ•°ç¬¬äºŒä¸ªå­—æ®µ
awk '{ print "å€’æ•°ç¬¬äºŒä¸ªå­—æ®µï¼š" $(NF-1) }' students.txt
```

### 3.3 å­—æ®µä¿®æ”¹ä¸é‡ç»„


**ğŸ”¸ ä¿®æ”¹å­—æ®µå†…å®¹**

```bash
# å°†æ‰€æœ‰å§“åæ”¹ä¸º"å­¦ç”Ÿ"
awk '{ $1="å­¦ç”Ÿ"; print }' students.txt
```

**ğŸ”¸ é‡æ–°æ’åˆ—å­—æ®µ**

```bash
# æ”¹å˜å­—æ®µé¡ºåºï¼šæˆç»©åœ¨å‰ï¼Œå§“ååœ¨å
awk '{ print $2, $3, $4, $1 }' students.txt
```

### 3.4 å­—æ®µå¤„ç†å®ç”¨æ¡ˆä¾‹


**ğŸ“‹ å¤„ç†æ—¥å¿—æ–‡ä»¶**

å‡è®¾Apacheè®¿é—®æ—¥å¿—æ ¼å¼ï¼š
```
192.168.1.1 - - [10/Oct/2023:13:55:36] "GET /index.html" 200 1024
```

```bash
# æå–IPåœ°å€å’Œè®¿é—®çš„é¡µé¢
awk '{ print "IP:", $1, "é¡µé¢:", $7 }' access.log
```

**ğŸ“Š å¤„ç†CSVæ•°æ®**

```bash
# å¤„ç†é€—å·åˆ†éš”çš„æ•°æ®
echo "å¼ ä¸‰,90,85,88" | awk -F',' '{ print $1 "çš„å¹³å‡åˆ†:", ($2+$3+$4)/3 }'
```

---

## 4. ğŸ­ æ¨¡å¼åŒ¹é…æœºåˆ¶


### 4.1 æ¨¡å¼åŒ¹é…çš„ä¸‰ç§ç±»å‹


**ğŸ”¸ BEGINæ¨¡å¼ - å¼€å§‹å¤„ç†å‰**

`BEGIN` æ¨¡å¼åœ¨å¤„ç†ä»»ä½•è¾“å…¥è¡Œä¹‹å‰æ‰§è¡Œï¼Œé€šå¸¸ç”¨äºåˆå§‹åŒ–æ“ä½œï¼š

```bash
# åœ¨å¤„ç†å‰è¾“å‡ºè¡¨å¤´
awk 'BEGIN { print "å­¦ç”Ÿæˆç»©ç»Ÿè®¡æŠ¥å‘Š"; print "==================" }
     { print $1, $2 }' students.txt
```

**ğŸ”¸ ENDæ¨¡å¼ - å¤„ç†å®Œæˆå**

`END` æ¨¡å¼åœ¨å¤„ç†å®Œæ‰€æœ‰è¾“å…¥è¡Œä¹‹åæ‰§è¡Œï¼Œé€šå¸¸ç”¨äºæ±‡æ€»ç»Ÿè®¡ï¼š

```bash
# ç»Ÿè®¡æ€»è¡Œæ•°
awk 'END { print "æ€»å…±æœ‰", NR, "ä¸ªå­¦ç”Ÿ" }' students.txt
```

**ğŸ”¸ æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ - æ¡ä»¶åŒ¹é…**

ä½¿ç”¨ `/pattern/` æ ¼å¼è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼š

```bash
# åªå¤„ç†åŒ…å«"å¼ "çš„è¡Œ
awk '/å¼ / { print "æ‰¾åˆ°å§“å¼ çš„å­¦ç”Ÿï¼š" $0 }' students.txt
```

### 4.2 å¤åˆæ¨¡å¼ä½¿ç”¨


**ğŸ”¸ å®Œæ•´çš„å¤„ç†æµç¨‹**

```bash
awk '
BEGIN { 
    print "å¼€å§‹å¤„ç†å­¦ç”Ÿæ•°æ®..."
    total = 0
}
/å¼ / { 
    print "å¤„ç†å­¦ç”Ÿï¼š" $1
    total++
}
END { 
    print "å…±å¤„ç†äº†", total, "ä¸ªå§“å¼ çš„å­¦ç”Ÿ"
}' students.txt
```

### 4.3 æ¡ä»¶è¡¨è¾¾å¼æ¨¡å¼


**ğŸ”¸ æ•°å€¼æ¯”è¾ƒ**

```bash
# æ•°å­¦æˆç»©å¤§äº85åˆ†çš„å­¦ç”Ÿ
awk '$2 > 85 { print $1 "æ•°å­¦æˆç»©ä¼˜ç§€ï¼š" $2 }' students.txt
```

**ğŸ”¸ å­—ç¬¦ä¸²åŒ¹é…**

```bash
# å§“åç­‰äºç‰¹å®šå€¼
awk '$1 == "å¼ ä¸‰" { print "æ‰¾åˆ°äº†å¼ ä¸‰ï¼Œæˆç»©ï¼š" $2, $3, $4 }' students.txt
```

**ğŸ”¸ å¤šæ¡ä»¶ç»„åˆ**

```bash
# æ•°å­¦æˆç»©å¤§äº80ä¸”è‹±è¯­æˆç»©å¤§äº80
awk '$2 > 80 && $3 > 80 { print $1 "åŒç§‘ä¼˜ç§€" }' students.txt
```

### 4.4 æ¨¡å¼åŒ¹é…å®ç”¨æŠ€å·§


| æ¨¡å¼ç±»å‹ | **è¯­æ³•** | **ä½¿ç”¨åœºæ™¯** | **ç¤ºä¾‹** |
|---------|----------|-------------|----------|
| **æ­£åˆ™åŒ¹é…** | `/pattern/` | `æŸ¥æ‰¾ç‰¹å®šå†…å®¹` | `/error/ { print }` |
| **æ•°å€¼æ¯”è¾ƒ** | `$n > value` | `ç­›é€‰æ•°å€¼æ¡ä»¶` | `$3 > 90 { print }` |
| **å­—ç¬¦ä¸²æ¯”è¾ƒ** | `$n == "string"` | `ç²¾ç¡®åŒ¹é…` | `$1 == "admin" { print }` |
| **èŒƒå›´åŒ¹é…** | `/start/,/end/` | `å¤„ç†åŒºé—´å†…å®¹` | `/BEGIN/,/END/ { print }` |

---

## 5. ğŸ”„ æ¡ä»¶åˆ¤æ–­ä¸å¾ªç¯æ§åˆ¶


### 5.1 æ¡ä»¶åˆ¤æ–­ - ifè¯­å¥


**ğŸ”¸ åŸºæœ¬ifè¯­å¥**

```bash
# æ ¹æ®æˆç»©ç»™å‡ºç­‰çº§è¯„ä»·
awk '{ 
    if ($2 >= 90) 
        print $1 "æ•°å­¦æˆç»©ï¼šä¼˜ç§€"
    else if ($2 >= 80) 
        print $1 "æ•°å­¦æˆç»©ï¼šè‰¯å¥½"
    else if ($2 >= 60)
        print $1 "æ•°å­¦æˆç»©ï¼šåŠæ ¼"
    else
        print $1 "æ•°å­¦æˆç»©ï¼šä¸åŠæ ¼"
}' students.txt
```

**ğŸ”¸ å¤šæ¡ä»¶åˆ¤æ–­**

```bash
# åˆ¤æ–­æ˜¯å¦å…¨ç§‘åŠæ ¼
awk '{ 
    if ($2 >= 60 && $3 >= 60 && $4 >= 60)
        print $1 "å…¨ç§‘åŠæ ¼"
    else
        print $1 "æœ‰ç§‘ç›®ä¸åŠæ ¼"
}' students.txt
```

### 5.2 å¾ªç¯æ§åˆ¶ - forè¯­å¥


**ğŸ”¸ Cé£æ ¼forå¾ªç¯**

```bash
# è®¡ç®—æ¯ä¸ªå­¦ç”Ÿçš„æ€»åˆ†ï¼ˆå‡è®¾æœ‰3é—¨è¯¾ç¨‹ï¼‰
awk '{ 
    total = 0
    for (i = 2; i <= 4; i++) {
        total += $i
    }
    print $1 "æ€»åˆ†ï¼š" total
}' students.txt
```

**ğŸ”¸ éå†æ•°ç»„çš„forå¾ªç¯**

```bash
# ç»Ÿè®¡æ¯ä¸ªåˆ†æ•°æ®µçš„äººæ•°
awk '{ 
    score = ($2 + $3 + $4) / 3
    if (score >= 90) grade["ä¼˜ç§€"]++
    else if (score >= 80) grade["è‰¯å¥½"]++
    else if (score >= 60) grade["åŠæ ¼"]++
    else grade["ä¸åŠæ ¼"]++
} 
END {
    for (level in grade) {
        print level ":", grade[level] "äºº"
    }
}' students.txt
```

### 5.3 å¾ªç¯æ§åˆ¶ - whileè¯­å¥


**ğŸ”¸ åŸºæœ¬whileå¾ªç¯**

```bash
# ä½¿ç”¨whileè®¡ç®—é˜¶ä¹˜
awk 'BEGIN { 
    n = 5
    factorial = 1
    i = 1
    while (i <= n) {
        factorial *= i
        i++
    }
    print n "! =", factorial
}'
```

### 5.4 å¾ªç¯æ§åˆ¶å…³é”®å­—


**ğŸ”¸ breakå’Œcontinue**

```bash
# æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸åŠæ ¼çš„æˆç»©å°±åœæ­¢
awk '{ 
    for (i = 2; i <= NF; i++) {
        if ($i < 60) {
            print $1 "ç¬¬" (i-1) "é—¨è¯¾ç¨‹ä¸åŠæ ¼ï¼š" $i
            break
        }
    }
}' students.txt
```

---

## 6. ğŸ“š æ•°ç»„çš„ä½¿ç”¨æŠ€å·§


### 6.1 å…³è”æ•°ç»„åŸºç¡€


awkä¸­çš„æ•°ç»„éƒ½æ˜¯**å…³è”æ•°ç»„**ï¼ˆä¹Ÿå«å“ˆå¸Œè¡¨ï¼‰ï¼Œå¯ä»¥ç”¨å­—ç¬¦ä¸²ä½œä¸ºç´¢å¼•ã€‚

ğŸŒ° **ç®€å•ç†è§£**ï¼šå…³è”æ•°ç»„å°±åƒä¸€ä¸ªæ ‡ç­¾ç›’å­ï¼Œä½ å¯ä»¥ç»™æ¯ä¸ªç›’å­è´´ä¸Šä¸åŒçš„æ ‡ç­¾ï¼ˆç´¢å¼•ï¼‰ï¼Œç„¶åå¾€é‡Œé¢æ”¾ä¸œè¥¿ï¼ˆå€¼ï¼‰ã€‚

**ğŸ”¸ æ•°ç»„çš„åŸºæœ¬æ“ä½œ**

```bash
# ç»Ÿè®¡æ¯ä¸ªå§“æ°å‡ºç°çš„æ¬¡æ•°
awk '{ 
    surname = substr($1, 1, 1)  # æå–å§“æ°ï¼ˆç¬¬ä¸€ä¸ªå­—ç¬¦ï¼‰
    count[surname]++            # è®¡æ•°å¢åŠ 
} 
END {
    for (s in count) {
        print "å§“" s "çš„å­¦ç”Ÿæœ‰", count[s], "äºº"
    }
}' students.txt
```

### 6.2 æ•°ç»„å®ç”¨æ¡ˆä¾‹


**ğŸ”¸ ç»Ÿè®¡è¯é¢‘**

```bash
# ç»Ÿè®¡æ–‡ä»¶ä¸­æ¯ä¸ªå•è¯å‡ºç°çš„æ¬¡æ•°
awk '{ 
    for (i = 1; i <= NF; i++) {
        words[$i]++
    }
} 
END {
    for (word in words) {
        print word ":", words[word]
    }
}' textfile.txt
```

**ğŸ”¸ å­˜å‚¨å’ŒæŸ¥æ‰¾**

```bash
# å°†å­¦ç”Ÿä¿¡æ¯å­˜å‚¨åœ¨æ•°ç»„ä¸­ï¼ŒæŒ‰éœ€æŸ¥è¯¢
awk '
BEGIN { 
    students["å¼ ä¸‰"] = "90,85,88"
    students["æå››"] = "78,92,86"
    
    # æŸ¥è¯¢ç‰¹å®šå­¦ç”Ÿ
    if ("å¼ ä¸‰" in students) {
        print "å¼ ä¸‰çš„æˆç»©ï¼š" students["å¼ ä¸‰"]
    }
}'
```

### 6.3 å¤šç»´æ•°ç»„æ¨¡æ‹Ÿ


è™½ç„¶awkä¸ç›´æ¥æ”¯æŒå¤šç»´æ•°ç»„ï¼Œä½†å¯ä»¥ç”¨åˆ†éš”ç¬¦æ¥æ¨¡æ‹Ÿï¼š

```bash
# æ¨¡æ‹ŸäºŒç»´æ•°ç»„ï¼šå­¦ç”Ÿ[å§“å,ç§‘ç›®] = æˆç»©
awk '{ 
    scores[$1,"æ•°å­¦"] = $2
    scores[$1,"è‹±è¯­"] = $3
    scores[$1,"è¯­æ–‡"] = $4
} 
END {
    # æŸ¥è¯¢å¼ ä¸‰çš„æ•°å­¦æˆç»©
    print "å¼ ä¸‰æ•°å­¦æˆç»©ï¼š" scores["å¼ ä¸‰","æ•°å­¦"]
}' students.txt
```

### 6.4 æ•°ç»„æ“ä½œæŠ€å·§


**ğŸ”¸ åˆ é™¤æ•°ç»„å…ƒç´ **

```bash
# åˆ é™¤æ•°ç»„ä¸­çš„ç‰¹å®šå…ƒç´ 
awk 'BEGIN {
    arr["a"] = 1
    arr["b"] = 2
    delete arr["a"]  # åˆ é™¤é”®ä¸º"a"çš„å…ƒç´ 
    
    for (key in arr) {
        print key, arr[key]
    }
}'
```

**ğŸ”¸ æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨**

```bash
# ä½¿ç”¨ in æ“ä½œç¬¦æ£€æŸ¥
awk 'BEGIN {
    arr["name"] = "å¼ ä¸‰"
    
    if ("name" in arr) {
        print "æ‰¾åˆ°äº†ï¼š" arr["name"]
    }
}'
```

---

## 7. ğŸ› ï¸ å†…ç½®å‡½æ•°åº”ç”¨


### 7.1 å­—ç¬¦ä¸²å¤„ç†å‡½æ•°


**ğŸ”¸ length() - å­—ç¬¦ä¸²é•¿åº¦**

```bash
# æ£€æŸ¥å§“åé•¿åº¦
awk '{ 
    name_len = length($1)
    if (name_len > 2) {
        print $1 "æ˜¯å¤å§“ï¼Œé•¿åº¦ï¼š" name_len
    }
}' students.txt
```

**ğŸ”¸ substr() - å­—ç¬¦ä¸²æˆªå–**

è¯­æ³•ï¼š`substr(string, start, length)`

```bash
# æå–å§“æ°ï¼ˆç¬¬ä¸€ä¸ªå­—ç¬¦ï¼‰
awk '{ print "å§“æ°ï¼š" substr($1, 1, 1) }' students.txt

# æå–åå­—ï¼ˆç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹ï¼‰
awk '{ print "åå­—ï¼š" substr($1, 2) }' students.txt
```

**ğŸ”¸ gsub() - å…¨å±€æ›¿æ¢**

è¯­æ³•ï¼š`gsub(regex, replacement, target)`

```bash
# å°†æ‰€æœ‰çš„"å¼ "æ›¿æ¢ä¸º"ç‹"
awk '{ gsub(/å¼ /, "ç‹", $1); print }' students.txt
```

**ğŸ”¸ sub() - å•æ¬¡æ›¿æ¢**

```bash
# åªæ›¿æ¢ç¬¬ä¸€ä¸ªåŒ¹é…çš„å†…å®¹
awk '{ sub(/å¼ /, "ç‹", $1); print }' students.txt
```

### 7.2 æ•°å­¦å‡½æ•°


**ğŸ”¸ å¸¸ç”¨æ•°å­¦å‡½æ•°**

```bash
# ä½¿ç”¨å„ç§æ•°å­¦å‡½æ•°
awk '{ 
    avg = ($2 + $3 + $4) / 3
    print $1 "å¹³å‡åˆ†ï¼š" avg
    print "å››èˆäº”å…¥ï¼š" int(avg + 0.5)
    print "å‘ä¸‹å–æ•´ï¼š" int(avg)
    print "å¹³æ–¹æ ¹ï¼š" sqrt(avg)
}' students.txt
```

### 7.3 å‡½æ•°ä½¿ç”¨é€ŸæŸ¥è¡¨


| å‡½æ•° | **åŠŸèƒ½** | **è¯­æ³•ç¤ºä¾‹** | **è¿”å›å€¼** |
|------|---------|-------------|-----------|
| `length(s)` | **å­—ç¬¦ä¸²é•¿åº¦** | `length("hello")` | `5` |
| `substr(s,i,n)` | **å­—ç¬¦ä¸²æˆªå–** | `substr("hello",2,3)` | `"ell"` |
| `gsub(r,s,t)` | **å…¨å±€æ›¿æ¢** | `gsub(/a/,"A",$0)` | `æ›¿æ¢æ¬¡æ•°` |
| `sub(r,s,t)` | **å•æ¬¡æ›¿æ¢** | `sub(/a/,"A",$0)` | `1æˆ–0` |
| `int(x)` | **å–æ•´æ•°éƒ¨åˆ†** | `int(3.8)` | `3` |
| `sqrt(x)` | **å¹³æ–¹æ ¹** | `sqrt(16)` | `4` |

---

## 8. ğŸ§® æ•°å€¼è®¡ç®—ä¸ç»Ÿè®¡åˆ†æ


### 8.1 åŸºæœ¬æ•°å­¦è¿ç®—


**ğŸ”¸ å››åˆ™è¿ç®—å’Œæ±‚å¹³å‡å€¼**

```bash
# è®¡ç®—æ¯ä¸ªå­¦ç”Ÿçš„æ€»åˆ†å’Œå¹³å‡åˆ†
awk '{ 
    total = $2 + $3 + $4
    avg = total / 3
    print $1 "æ€»åˆ†ï¼š" total "ï¼Œå¹³å‡åˆ†ï¼š" avg
}' students.txt
```

### 8.2 ç»Ÿè®¡åˆ†æ


**ğŸ”¸ æ±‚æœ€å¤§å€¼ã€æœ€å°å€¼**

```bash
# æ‰¾å‡ºæ•°å­¦æˆç»©æœ€é«˜åˆ†å’Œæœ€ä½åˆ†
awk '
BEGIN { max = 0; min = 999 }
{ 
    if ($2 > max) max = $2
    if ($2 < min) min = $2
}
END { 
    print "æ•°å­¦æœ€é«˜åˆ†ï¼š" max
    print "æ•°å­¦æœ€ä½åˆ†ï¼š" min
}' students.txt
```

**ğŸ”¸ ç´¯è®¡ç»Ÿè®¡**

```bash
# ç»Ÿè®¡å…¨ç­æ€»åˆ†å’Œå¹³å‡åˆ†
awk '{ 
    sum += ($2 + $3 + $4)
    count++
} 
END { 
    print "å…¨ç­æ€»åˆ†ï¼š" sum
    print "å…¨ç­å¹³å‡åˆ†ï¼š" sum / (count * 3)
}' students.txt
```

### 8.3 å¤æ‚ç»Ÿè®¡æ¡ˆä¾‹


**ğŸ”¸ æˆç»©åˆ†å¸ƒç»Ÿè®¡**

```bash
# ç»Ÿè®¡å„åˆ†æ•°æ®µçš„äººæ•°åˆ†å¸ƒ
awk '{ 
    avg = ($2 + $3 + $4) / 3
    if (avg >= 90) excellent++
    else if (avg >= 80) good++
    else if (avg >= 70) medium++
    else if (avg >= 60) pass++
    else fail++
    total++
} 
END {
    print "æˆç»©åˆ†å¸ƒç»Ÿè®¡ï¼š"
    print "ä¼˜ç§€(90+):", excellent "äºº (" int(excellent/total*100) "%)"
    print "è‰¯å¥½(80-89):", good "äºº (" int(good/total*100) "%)"
    print "ä¸­ç­‰(70-79):", medium "äºº (" int(medium/total*100) "%)"
    print "åŠæ ¼(60-69):", pass "äºº (" int(pass/total*100) "%)"
    print "ä¸åŠæ ¼(<60):", fail "äºº (" int(fail/total*100) "%)"
}' students.txt
```

---

## 9. ğŸ”§ ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°


### 9.1 å‡½æ•°å®šä¹‰è¯­æ³•


åœ¨awkä¸­å¯ä»¥å®šä¹‰è‡ªå·±çš„å‡½æ•°æ¥é‡ç”¨ä»£ç ï¼š

```bash
# å®šä¹‰è®¡ç®—å¹³å‡å€¼çš„å‡½æ•°
awk '
function average(a, b, c) {
    return (a + b + c) / 3
}

{ 
    avg = average($2, $3, $4)
    print $1 "çš„å¹³å‡åˆ†ï¼š" avg
}' students.txt
```

### 9.2 å‡½æ•°å‚æ•°å’Œè¿”å›å€¼


**ğŸ”¸ å¸¦å‚æ•°çš„å‡½æ•°**

```bash
# å®šä¹‰æˆç»©ç­‰çº§åˆ¤æ–­å‡½æ•°
awk '
function get_grade(score) {
    if (score >= 90) return "ä¼˜ç§€"
    else if (score >= 80) return "è‰¯å¥½"
    else if (score >= 60) return "åŠæ ¼"
    else return "ä¸åŠæ ¼"
}

{ 
    print $1 "æ•°å­¦æˆç»©ç­‰çº§ï¼š" get_grade($2)
}' students.txt
```

### 9.3 å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡


```bash
# æ¼”ç¤ºå±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡
awk '
function process_scores(s1, s2, s3,    local_sum, local_avg) {
    # å‡½æ•°å‚æ•°åçš„å˜é‡æ˜¯å±€éƒ¨å˜é‡
    local_sum = s1 + s2 + s3
    local_avg = local_sum / 3
    global_count++  # å…¨å±€å˜é‡
    return local_avg
}

BEGIN { global_count = 0 }
{ 
    avg = process_scores($2, $3, $4)
    print $1 "å¹³å‡åˆ†ï¼š" avg
}
END {
    print "å…±å¤„ç†äº†", global_count, "ä¸ªå­¦ç”Ÿ"
}' students.txt
```

---

## 10. ğŸ”— awkä¸å…¶ä»–å·¥å…·é…åˆ


### 10.1 ä¸ç®¡é“çš„é…åˆä½¿ç”¨


**ğŸ”¸ é¢„å¤„ç†æ•°æ®åç”¨awkåˆ†æ**

```bash
# å…ˆæ’åºå†ç”¨awkå¤„ç†
sort students.txt | awk '{ print NR ".", $0 }'

# å…ˆè¿‡æ»¤å†ç»Ÿè®¡
grep "å¼ " students.txt | awk '{ count++ } END { print "å§“å¼ çš„å­¦ç”Ÿæœ‰", count, "äºº" }'
```

### 10.2 ä¸å…¶ä»–å‘½ä»¤çš„ç»„åˆ


**ğŸ”¸ å¤„ç†å‘½ä»¤è¾“å‡º**

```bash
# åˆ†æpså‘½ä»¤çš„è¾“å‡º
ps aux | awk '$3 > 1.0 { print $2, $11, $3"%" }' | head -10

# åˆ†æç£ç›˜ä½¿ç”¨æƒ…å†µ
df -h | awk '$5 > "50%" { print $6 "ç›®å½•ä½¿ç”¨ç‡è¿‡é«˜ï¼š" $5 }'
```

### 10.3 å¤æ‚æ•°æ®å¤„ç†æµæ°´çº¿


```bash
# ç»¼åˆä½¿ç”¨å¤šä¸ªå·¥å…·å¤„ç†æ—¥å¿—
cat access.log | \
grep "GET" | \
awk '{ print $1, $7 }' | \
sort | \
uniq -c | \
sort -nr | \
head -10
```

**è§£é‡Šè¯´æ˜**ï¼š
1. `cat access.log`ï¼šè¯»å–æ—¥å¿—æ–‡ä»¶
2. `grep "GET"`ï¼šè¿‡æ»¤GETè¯·æ±‚
3. `awk '{ print $1, $7 }'`ï¼šæå–IPå’Œè¯·æ±‚è·¯å¾„
4. `sort`ï¼šæ’åº
5. `uniq -c`ï¼šç»Ÿè®¡é‡å¤æ¬¡æ•°
6. `sort -nr`ï¼šæŒ‰æ•°é‡å€’åºæ’åˆ—
7. `head -10`ï¼šå–å‰10æ¡

---

## 11. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 11.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å·¥ä½œåŸç†ï¼šæ¨¡å¼-åŠ¨ä½œæ¶æ„ï¼Œé€è¡Œå¤„ç†æ–‡æœ¬æ•°æ®
ğŸ”¸ å†…ç½®å˜é‡ï¼šNF(å­—æ®µæ•°)ã€NR(è¡Œå·)ã€FS(åˆ†éš”ç¬¦)ã€$1/$2/$NF(å­—æ®µè®¿é—®)
ğŸ”¸ æ¨¡å¼åŒ¹é…ï¼šBEGIN/ENDã€æ­£åˆ™è¡¨è¾¾å¼ã€æ¡ä»¶è¡¨è¾¾å¼ä¸‰ç§æ¨¡å¼
ğŸ”¸ ç¨‹åºç»“æ„ï¼šæ¡ä»¶åˆ¤æ–­(if)ã€å¾ªç¯æ§åˆ¶(for/while)ã€å‡½æ•°å®šä¹‰
ğŸ”¸ æ•°ç»„ä½¿ç”¨ï¼šå…³è”æ•°ç»„ç»Ÿè®¡ã€å­˜å‚¨ã€æŸ¥æ‰¾æ•°æ®
ğŸ”¸ å†…ç½®å‡½æ•°ï¼šå­—ç¬¦ä¸²å¤„ç†(length/substr/gsub)ã€æ•°å­¦è®¡ç®—(int/sqrt)
```

### 11.2 å®ç”¨æŠ€å·§è®°å¿†è¦ç‚¹


**ğŸ”¹ å¿«é€Ÿä¸Šæ‰‹å£è¯€**
```
awkçœ‹æ–‡ä»¶é€è¡Œæ‰«ï¼Œæ¨¡å¼åŠ¨ä½œè¦é…å…¨
å­—æ®µç”¨$æ•°å­—è®¿é—®ï¼ŒNF NRæœ€å¸¸è§
BEGINåˆå§‹ENDç»“å°¾ï¼Œä¸­é—´å¤„ç†æ˜¯å…³é”®
æ•°ç»„ç»Ÿè®¡æœ€æ–¹ä¾¿ï¼Œå‡½æ•°è®©ä»£ç æ›´ç®€ç»ƒ
```

**ğŸ”¹ å¸¸ç”¨åœºæ™¯å¯¹åº”**
- **æ•°æ®æå–**ï¼šä½¿ç”¨å­—æ®µè®¿é—® `$1, $2, $NF`
- **æ¡ä»¶è¿‡æ»¤**ï¼šä½¿ç”¨æ¨¡å¼åŒ¹é… `$3 > 80 { ... }`
- **ç»Ÿè®¡åˆ†æ**ï¼šä½¿ç”¨æ•°ç»„å’ŒENDå—è¿›è¡Œæ±‡æ€»
- **æ ¼å¼è½¬æ¢**ï¼šä¿®æ”¹OFSã€ORSç­‰è¾“å‡ºæ ¼å¼
- **å¤æ‚å¤„ç†**ï¼šç»“åˆå‡½æ•°å’Œå¾ªç¯å®ç°ç®—æ³•

### 11.3 å­¦ä¹ è¿›é˜¶è·¯å¾„


**ğŸ¯ å­¦ä¹ å»ºè®®**
1. **ğŸ”° å…¥é—¨é˜¶æ®µ**ï¼šæŒæ¡åŸºæœ¬è¯­æ³•å’Œå†…ç½®å˜é‡
2. **ğŸ”¸ è¿›é˜¶é˜¶æ®µ**ï¼šç†Ÿç»ƒä½¿ç”¨æ¨¡å¼åŒ¹é…å’Œæ•°ç»„
3. **â­ é«˜çº§é˜¶æ®µ**ï¼šç¼–å†™è‡ªå®šä¹‰å‡½æ•°å’Œå¤æ‚è„šæœ¬
4. **ğŸ† ä¸“å®¶é˜¶æ®µ**ï¼šä¸å…¶ä»–å·¥å…·ç»„åˆè§£å†³å®é™…é—®é¢˜

> ğŸ’¡ **å­¦ä¹ æç¤º**  
> awkçš„å¼ºå¤§åœ¨äºå…¶ç®€æ´æ€§å’Œçµæ´»æ€§ã€‚ä»ç®€å•çš„å­—æ®µæå–å¼€å§‹ï¼Œé€æ­¥æŒæ¡æ¨¡å¼åŒ¹é…å’Œæ•°ç»„ä½¿ç”¨ï¼Œæœ€ç»ˆèƒ½å¤Ÿå¤„ç†å¤æ‚çš„æ–‡æœ¬åˆ†æä»»åŠ¡ã€‚

> ğŸš€ **å®è·µå»ºè®®**  
> å¤šç»ƒä¹ å¤„ç†å®é™…çš„æ•°æ®æ–‡ä»¶ï¼Œå¦‚æ—¥å¿—åˆ†æã€CSVå¤„ç†ã€ç³»ç»Ÿç›‘æ§è¾“å‡ºç­‰ï¼Œåœ¨å®é™…åº”ç”¨ä¸­æå‡æŠ€èƒ½ã€‚

**æ ¸å¿ƒè®°å¿†**ï¼š
- awk = æ¨¡å¼åŒ¹é… + å­—æ®µå¤„ç† + æ•°ç»„ç»Ÿè®¡ + å†…ç½®å‡½æ•°
- æŒæ¡å†…ç½®å˜é‡æ˜¯åŸºç¡€ï¼Œå–„ç”¨æ•°ç»„æ˜¯è¿›é˜¶ï¼Œç¼–å†™å‡½æ•°æ˜¯é«˜çº§
- ä¸å…¶ä»–Shellå·¥å…·é…åˆä½¿ç”¨ï¼Œå‘æŒ¥æœ€å¤§æ•ˆç”¨