---
title: 3ã€è¿œç¨‹è®¿é—®
---
## ğŸ“š ç›®å½•

1. [SSHåŸºç¡€æ¦‚å¿µä¸åŸç†](#1-SSHåŸºç¡€æ¦‚å¿µä¸åŸç†)
2. [SSHè¿æ¥ä¸è®¤è¯æ–¹å¼](#2-SSHè¿æ¥ä¸è®¤è¯æ–¹å¼)
3. [SSHå¯†é’¥è®¤è¯è¯¦è§£](#3-SSHå¯†é’¥è®¤è¯è¯¦è§£)
4. [æ–‡ä»¶ä¼ è¾“å·¥å…·è¯¦è§£](#4-æ–‡ä»¶ä¼ è¾“å·¥å…·è¯¦è§£)
5. [SSHé…ç½®æ–‡ä»¶é«˜çº§åº”ç”¨](#5-SSHé…ç½®æ–‡ä»¶é«˜çº§åº”ç”¨)
6. [SSHéš§é“ä¸ç«¯å£è½¬å‘](#6-SSHéš§é“ä¸ç«¯å£è½¬å‘)
7. [è¿œç¨‹å‘½ä»¤æ‰§è¡ŒæŠ€å·§](#7-è¿œç¨‹å‘½ä»¤æ‰§è¡ŒæŠ€å·§)
8. [æ‰¹é‡SSHæ“ä½œå®è·µ](#8-æ‰¹é‡SSHæ“ä½œå®è·µ)
9. [SSHä»£ç†å’Œå¯†é’¥ç®¡ç†](#9-SSHä»£ç†å’Œå¯†é’¥ç®¡ç†)
10. [è‡ªåŠ¨åŒ–SSHæ“ä½œè„šæœ¬](#10-è‡ªåŠ¨åŒ–SSHæ“ä½œè„šæœ¬)
11. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#11-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” SSHåŸºç¡€æ¦‚å¿µä¸åŸç†


### 1.1 ä»€ä¹ˆæ˜¯SSH

**SSH**ï¼ˆSecure Shellï¼‰å°±æ˜¯**å®‰å…¨çš„è¿œç¨‹ç™»å½•å·¥å…·**ï¼Œå¯ä»¥æŠŠå®ƒç†è§£ä¸º"ç½‘ç»œç‰ˆçš„ç»ˆç«¯"ã€‚

> **ğŸ“– é€šä¿—ç†è§£**  
> æƒ³è±¡ä¸€ä¸‹ï¼ŒSSHå°±åƒæ˜¯ä½ åœ¨å®¶é‡Œé€šè¿‡ç”µè¯é¥æ§åŠå…¬å®¤çš„ç”µè„‘ã€‚ä½ åœ¨å®¶é‡Œæ•²å‘½ä»¤ï¼ŒåŠå…¬å®¤çš„ç”µè„‘å°±ä¼šæ‰§è¡Œï¼Œè€Œä¸”é€šè¯å†…å®¹æ˜¯åŠ å¯†çš„ï¼Œåˆ«äººå·å¬ä¸åˆ°ã€‚

**ğŸ”¸ SSHè§£å†³çš„æ ¸å¿ƒé—®é¢˜**
- **è¿œç¨‹æ§åˆ¶** - åœ¨Aç”µè„‘ä¸Šæ“ä½œBç”µè„‘
- **å®‰å…¨ä¼ è¾“** - æ‰€æœ‰æ•°æ®éƒ½åŠ å¯†ä¼ è¾“
- **èº«ä»½éªŒè¯** - ç¡®ä¿åªæœ‰æˆæƒç”¨æˆ·èƒ½è¿æ¥

### 1.2 SSHå·¥ä½œåŸç†ç®€ä»‹


```
æœ¬åœ°ç”µè„‘                          è¿œç¨‹æœåŠ¡å™¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     åŠ å¯†é€šé“      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SSHå®¢æˆ·ç«¯  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  SSHæœåŠ¡ç«¯  â”‚
â”‚ (sshå‘½ä»¤)   â”‚     å®‰å…¨ä¼ è¾“      â”‚ (sshdè¿›ç¨‹)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å·¥ä½œæµç¨‹**ï¼š
1. å®¢æˆ·ç«¯å‘èµ·è¿æ¥è¯·æ±‚
2. æœåŠ¡ç«¯è¿”å›å…¬é’¥ä¿¡æ¯
3. åŒæ–¹åå•†åŠ å¯†ç®—æ³•
4. å»ºç«‹åŠ å¯†é€šé“
5. ç”¨æˆ·èº«ä»½éªŒè¯
6. å¼€å§‹å®‰å…¨é€šä¿¡

### 1.3 SSHçš„ä¼˜åŠ¿ç‰¹ç‚¹


| ç‰¹æ€§ | **è¯´æ˜** | **å®é™…æ„ä¹‰** |
|------|----------|-------------|
| ğŸ”’ **åŠ å¯†ä¼ è¾“** | `æ‰€æœ‰æ•°æ®éƒ½ç»è¿‡åŠ å¯†` | `é˜²æ­¢ç½‘ç»œçªƒå¬å’Œç¯¡æ”¹` |
| ğŸ”‘ **å¤šç§è®¤è¯** | `å¯†ç ã€å¯†é’¥ã€åŒå› å­è®¤è¯` | `çµæ´»çš„å®‰å…¨ç­–ç•¥` |
| âš¡ **è½»é‡é«˜æ•ˆ** | `å ç”¨èµ„æºå°‘ï¼Œå“åº”å¿«` | `é€‚åˆå„ç§ç½‘ç»œç¯å¢ƒ` |
| ğŸŒ **è·¨å¹³å°** | `æ”¯æŒLinuxã€Windowsã€macOS` | `é€šç”¨æ€§å¼º` |

---

## 2. ğŸšª SSHè¿æ¥ä¸è®¤è¯æ–¹å¼


### 2.1 åŸºæœ¬SSHè¿æ¥å‘½ä»¤


**åŸºç¡€è¿æ¥è¯­æ³•**ï¼š
```bash
ssh [é€‰é¡¹] [ç”¨æˆ·å@]ä¸»æœºå
```

**ğŸ”¸ å¸¸ç”¨è¿æ¥ç¤ºä¾‹**
```bash
# åŸºæœ¬è¿æ¥ï¼ˆä½¿ç”¨å½“å‰ç”¨æˆ·åï¼‰
ssh 192.168.1.100

# æŒ‡å®šç”¨æˆ·åè¿æ¥
ssh root@192.168.1.100

# æŒ‡å®šç«¯å£è¿æ¥
ssh -p 2222 user@example.com

# ä½¿ç”¨ä¸»æœºåˆ«åè¿æ¥
ssh myserver
```

### 2.2 SSHè®¤è¯æ–¹å¼è¯¦è§£


#### ğŸ” å¯†ç è®¤è¯ï¼ˆæœ€ç®€å•ï¼‰

è¿™æ˜¯æœ€åŸºç¡€çš„è®¤è¯æ–¹å¼ï¼Œå°±åƒå¹³æ—¶ç™»å½•ç½‘ç«™è¾“å…¥å¯†ç ä¸€æ ·ã€‚

```bash
# å¯†ç è®¤è¯è¿æ¥
ssh user@192.168.1.100
# ç³»ç»Ÿä¼šæç¤ºï¼šuser@192.168.1.100's password:
# è¾“å…¥å¯†ç å³å¯ç™»å½•
```

**ä¼˜ç‚¹**ï¼šç®€å•æ˜“ç”¨ï¼Œæ— éœ€é¢å¤–é…ç½®  
**ç¼ºç‚¹**ï¼šå®‰å…¨æ€§ç›¸å¯¹è¾ƒä½ï¼Œå®¹æ˜“è¢«æš´åŠ›ç ´è§£

#### ğŸ”‘ å…¬ç§é’¥è®¤è¯ï¼ˆæ¨èï¼‰

è¿™ç§æ–¹å¼å°±åƒæ˜¯"ç”µå­é’¥åŒ™"ï¼Œæ›´å®‰å…¨ä¹Ÿæ›´æ–¹ä¾¿ã€‚

**è®¤è¯åŸç†**ï¼š
```
ä½ çš„ç”µè„‘                     è¿œç¨‹æœåŠ¡å™¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç§é’¥ğŸ”‘   â”‚                â”‚  å…¬é’¥ğŸ—ï¸   â”‚
â”‚ (ä¿å¯†çš„)  â”‚â”€â”€â”€åŠ å¯†æ•°æ®â”€â”€â”€â”€â–ºâ”‚ (å…¬å¼€çš„)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 é¦–æ¬¡è¿æ¥çš„å®‰å…¨æç¤º


ç¬¬ä¸€æ¬¡è¿æ¥æ–°æœåŠ¡å™¨æ—¶ï¼Œä¼šçœ‹åˆ°è¿™æ ·çš„æç¤ºï¼š

```
The authenticity of host '192.168.1.100' can't be established.
RSA key fingerprint is SHA256:xxx...
Are you sure you want to continue connecting (yes/no)?
```

**ğŸ”¸ è¿™ä¸ªæç¤ºçš„å«ä¹‰**
- ç³»ç»Ÿåœ¨ç¡®è®¤è¿™å°æœåŠ¡å™¨çš„èº«ä»½
- ç±»ä¼¼äº"ä½ ç¡®å®šè¦ä¿¡ä»»è¿™å°ç”µè„‘å—ï¼Ÿ"
- è¾“å…¥`yes`åä¼šè®°ä½è¿™å°æœåŠ¡å™¨çš„"æŒ‡çº¹"

> **âš ï¸ å®‰å…¨æé†’**  
> åªæœ‰åœ¨ç¡®è®¤æ˜¯æ­£ç¡®çš„æœåŠ¡å™¨æ—¶æ‰è¾“å…¥yesï¼Œé¿å…ä¸­é—´äººæ”»å‡»ã€‚

---

## 3. ğŸ”‘ SSHå¯†é’¥è®¤è¯è¯¦è§£


### 3.1 SSHå¯†é’¥çš„æœ¬è´¨ç†è§£


**å¯†é’¥è®¤è¯å°±åƒæ˜¯ä¸€æŠŠç‰¹æ®Šçš„é’¥åŒ™**ï¼š
- **ç§é’¥** = ä½ å£è¢‹é‡Œçš„é’¥åŒ™ï¼ˆç»å¯¹ä¸èƒ½ç»™åˆ«äººï¼‰
- **å…¬é’¥** = é—¨ä¸Šçš„é”ï¼ˆå¯ä»¥å‘Šè¯‰åˆ«äººï¼‰
- **è®¤è¯è¿‡ç¨‹** = ç”¨ä½ çš„é’¥åŒ™å¼€é”

### 3.2 ç”ŸæˆSSHå¯†é’¥å¯¹


**ç”Ÿæˆå¯†é’¥å‘½ä»¤**ï¼š
```bash
# ç”ŸæˆRSAå¯†é’¥å¯¹ï¼ˆæ¨è2048ä½æˆ–æ›´é«˜ï¼‰
ssh-keygen -t rsa -b 2048

# ç”Ÿæˆæ›´å®‰å…¨çš„Ed25519å¯†é’¥å¯¹
ssh-keygen -t ed25519
```

**ğŸ”¸ ç”Ÿæˆè¿‡ç¨‹è¯¦è§£**
```bash
$ ssh-keygen -t rsa -b 2048
Generating public/private rsa key pair.
Enter file in which to save the key (/home/user/.ssh/id_rsa): [ç›´æ¥å›è½¦]
Enter passphrase (empty for no passphrase): [å¯é€‰ï¼šè¾“å…¥å¯†ç çŸ­è¯­]
Enter same passphrase again: [å†æ¬¡ç¡®è®¤]
```

**ç”Ÿæˆçš„æ–‡ä»¶**ï¼š
- `~/.ssh/id_rsa` - **ç§é’¥æ–‡ä»¶**ï¼ˆä¿å¯†ï¼‰
- `~/.ssh/id_rsa.pub` - **å…¬é’¥æ–‡ä»¶**ï¼ˆå¯åˆ†äº«ï¼‰

### 3.3 éƒ¨ç½²å…¬é’¥åˆ°è¿œç¨‹æœåŠ¡å™¨


#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ssh-copy-idï¼ˆæ¨èï¼‰

```bash
# è‡ªåŠ¨éƒ¨ç½²å…¬é’¥
ssh-copy-id user@192.168.1.100

# æŒ‡å®šå…¬é’¥æ–‡ä»¶
ssh-copy-id -i ~/.ssh/id_rsa.pub user@192.168.1.100
```

#### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨å¤åˆ¶ï¼ˆé€šç”¨æ–¹æ³•ï¼‰

```bash
# æŸ¥çœ‹å…¬é’¥å†…å®¹
cat ~/.ssh/id_rsa.pub

# æ‰‹åŠ¨ç™»å½•æœåŠ¡å™¨ï¼Œå°†å…¬é’¥æ·»åŠ åˆ°authorized_keys
mkdir -p ~/.ssh
echo "å…¬é’¥å†…å®¹" >> ~/.ssh/authorized_keys
chmod 600 ~/.ssh/authorized_keys
chmod 700 ~/.ssh
```

### 3.4 å¯†é’¥è®¤è¯çš„å®‰å…¨é…ç½®


**ğŸ”¸ å¯†é’¥æ–‡ä»¶æƒé™è®¾ç½®**
```bash
# è®¾ç½®æ­£ç¡®çš„æ–‡ä»¶æƒé™
chmod 700 ~/.ssh
chmod 600 ~/.ssh/id_rsa
chmod 644 ~/.ssh/id_rsa.pub
chmod 600 ~/.ssh/authorized_keys
```

**æ–‡ä»¶æƒé™å«ä¹‰**ï¼š
- `700` = åªæœ‰æ–‡ä»¶æ‰€æœ‰è€…èƒ½è¯»å†™æ‰§è¡Œ
- `600` = åªæœ‰æ–‡ä»¶æ‰€æœ‰è€…èƒ½è¯»å†™
- `644` = æ‰€æœ‰è€…è¯»å†™ï¼Œå…¶ä»–äººåªè¯»

---

## 4. ğŸ“ æ–‡ä»¶ä¼ è¾“å·¥å…·è¯¦è§£


### 4.1 scpå‘½ä»¤è¯¦è§£


**scp**ï¼ˆSecure Copyï¼‰å°±æ˜¯"å®‰å…¨çš„æ–‡ä»¶å¤åˆ¶å·¥å…·"ï¼Œå¯ä»¥ç†è§£ä¸º**ç½‘ç»œç‰ˆçš„cpå‘½ä»¤**ã€‚

#### åŸºæœ¬è¯­æ³•å’Œä½¿ç”¨

```bash
# åŸºæœ¬è¯­æ³•
scp [é€‰é¡¹] æºæ–‡ä»¶ ç›®æ ‡ä½ç½®
```

**ğŸ”¸ å¸¸ç”¨æ–‡ä»¶ä¼ è¾“ç¤ºä¾‹**
```bash
# ä¸Šä¼ æ–‡ä»¶åˆ°è¿œç¨‹æœåŠ¡å™¨
scp file.txt user@192.168.1.100:/home/user/

# ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°
scp user@192.168.1.100:/home/user/file.txt ./

# é€’å½’å¤åˆ¶ç›®å½•
scp -r local_dir/ user@192.168.1.100:/remote/path/

# ä¿æŒæ–‡ä»¶å±æ€§
scp -p file.txt user@192.168.1.100:/home/user/
```

**å¸¸ç”¨é€‰é¡¹è¯´æ˜**ï¼š
- `-r` = é€’å½’å¤åˆ¶ï¼ˆå¤åˆ¶ç›®å½•æ—¶å¿…éœ€ï¼‰
- `-p` = ä¿æŒæ–‡ä»¶æ—¶é—´æˆ³å’Œæƒé™
- `-P` = æŒ‡å®šç«¯å£å·ï¼ˆæ³¨æ„æ˜¯å¤§å†™Pï¼‰
- `-v` = æ˜¾ç¤ºè¯¦ç»†è¿‡ç¨‹

### 4.2 rsyncåŒæ­¥å·¥å…·


**rsync**æ˜¯**å¢é‡åŒæ­¥å·¥å…·**ï¼Œå°±åƒ"æ™ºèƒ½çš„æ–‡ä»¶å¤åˆ¶å™¨"ï¼Œåªä¼ è¾“æœ‰å˜åŒ–çš„éƒ¨åˆ†ã€‚

#### rsyncåŸºæœ¬ç”¨æ³•

```bash
# åŸºæœ¬åŒæ­¥è¯­æ³•
rsync [é€‰é¡¹] æºç›®å½• ç›®æ ‡ç›®å½•
```

**ğŸ”¸ æ ¸å¿ƒé€‰é¡¹ç»„åˆ**
```bash
# -aï¼šå½’æ¡£æ¨¡å¼ï¼ˆä¿æŒæ‰€æœ‰å±æ€§ï¼‰
# -vï¼šæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
# -zï¼šå‹ç¼©ä¼ è¾“
rsync -avz source/ user@server:/destination/

# --deleteï¼šåˆ é™¤ç›®æ ‡ç›®å½•ä¸­å¤šä½™çš„æ–‡ä»¶
rsync -avz --delete source/ user@server:/destination/
```

**é€‰é¡¹å«ä¹‰è¯¦è§£**ï¼š
- `-a` (archive) = å½’æ¡£æ¨¡å¼ï¼Œç­‰äº -rlptgoD
- `-v` (verbose) = æ˜¾ç¤ºä¼ è¾“è¿‡ç¨‹
- `-z` (compress) = å‹ç¼©æ•°æ®ä¼ è¾“
- `--delete` = åˆ é™¤ç›®æ ‡ä¸­æºæ²¡æœ‰çš„æ–‡ä»¶

#### rsyncå®ç”¨åœºæ™¯

```bash
# ç½‘ç«™å¤‡ä»½åŒæ­¥
rsync -avz --delete /var/www/ backup@server:/backup/www/

# æ’é™¤ç‰¹å®šæ–‡ä»¶
rsync -avz --exclude="*.log" source/ user@server:/dest/

# é™åˆ¶ä¼ è¾“å¸¦å®½ï¼ˆKB/sï¼‰
rsync -avz --bwlimit=1000 source/ user@server:/dest/
```

### 4.3 scp vs rsyncé€‰æ‹©æŒ‡å—


| åœºæ™¯ | **æ¨èå·¥å…·** | **åŸå› ** |
|------|-------------|----------|
| ğŸ—‚ï¸ **é¦–æ¬¡ä¼ è¾“å¤§é‡æ–‡ä»¶** | `rsync` | `å¢é‡ä¼ è¾“ï¼Œæ–­ç‚¹ç»­ä¼ ` |
| ğŸ“„ **å¶å°”ä¼ è¾“å•ä¸ªæ–‡ä»¶** | `scp` | `ç®€å•ç›´æ¥ï¼Œå‘½ä»¤çŸ­` |
| ğŸ”„ **å®šæœŸåŒæ­¥ç›®å½•** | `rsync` | `åªä¼ è¾“å˜åŒ–çš„æ–‡ä»¶` |
| ğŸ“¦ **ä¿æŒç›®å½•ç»“æ„åŒæ­¥** | `rsync --delete` | `åˆ é™¤å¤šä½™æ–‡ä»¶` |

---

## 5. âš™ï¸ SSHé…ç½®æ–‡ä»¶é«˜çº§åº”ç”¨


### 5.1 SSHå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶


SSHé…ç½®æ–‡ä»¶å°±åƒæ˜¯"è¿æ¥æœåŠ¡å™¨çš„é€šè®¯å½•"ï¼Œå¯ä»¥ä¸ºæ¯ä¸ªæœåŠ¡å™¨è®¾ç½®åˆ«åå’Œå‚æ•°ã€‚

**é…ç½®æ–‡ä»¶ä½ç½®**ï¼š`~/.ssh/config`

### 5.2 åŸºç¡€é…ç½®ç¤ºä¾‹


```bash
# åˆ›å»ºæˆ–ç¼–è¾‘é…ç½®æ–‡ä»¶
vim ~/.ssh/config
```

**ğŸ”¸ åŸºæœ¬é…ç½®æ ¼å¼**
```
# å¼€å‘æœåŠ¡å™¨é…ç½®
Host devserver
    HostName 192.168.1.100
    User root
    Port 22
    IdentityFile ~/.ssh/id_rsa

# ç”Ÿäº§æœåŠ¡å™¨é…ç½®
Host prodserver
    HostName prod.example.com
    User admin
    Port 2222
    IdentityFile ~/.ssh/prod_key
```

**é…ç½®åçš„ä½¿ç”¨**ï¼š
```bash
# ä¸ç”¨è®°ä½å¤æ‚çš„IPå’Œå‚æ•°
ssh devserver

# ç­‰ä»·äº
ssh -i ~/.ssh/id_rsa -p 22 root@192.168.1.100
```

### 5.3 é«˜çº§é…ç½®é€‰é¡¹


#### è¿æ¥ä¼˜åŒ–é…ç½®

```
Host *
    # ä¿æŒè¿æ¥æ´»è·ƒ
    ServerAliveInterval 60
    ServerAliveCountMax 3
    
    # è¿æ¥å¤ç”¨
    ControlMaster auto
    ControlPath ~/.ssh/sockets/%r@%h-%p
    ControlPersist 600
    
    # å¿«é€Ÿè¿æ¥
    Compression yes
    TCPKeepAlive yes
```

**é€‰é¡¹è¯´æ˜**ï¼š
- `ServerAliveInterval` = æ¯60ç§’å‘é€ä¿æ´»ä¿¡å·
- `ControlMaster` = è¿æ¥å¤ç”¨ï¼Œæé«˜åç»­è¿æ¥é€Ÿåº¦
- `ControlPersist` = ä¿æŒè¿æ¥600ç§’

#### å®‰å…¨é…ç½®é€‰é¡¹

```
Host sensitive-server
    HostName sensitive.example.com
    User admin
    
    # å®‰å…¨é€‰é¡¹
    PasswordAuthentication no
    PubkeyAuthentication yes
    ForwardAgent no
    ForwardX11 no
    
    # åªå…è®¸ç‰¹å®šçš„åŠ å¯†ç®—æ³•
    Ciphers aes256-gcm@openssh.com,aes256-ctr
```

### 5.4 é€šé…ç¬¦å’Œæ¡ä»¶é…ç½®


```
# é€šé…ç¬¦åŒ¹é…
Host *.example.com
    User admin
    IdentityFile ~/.ssh/company_key

# è·³æ¿æœºé…ç½®
Host internal-server
    HostName 10.0.0.100
    ProxyJump bastion.example.com
    User developer
```

---

## 6. ğŸš‡ SSHéš§é“ä¸ç«¯å£è½¬å‘


### 6.1 SSHéš§é“åŸºæœ¬æ¦‚å¿µ


**SSHéš§é“**å°±åƒæ˜¯åœ¨ä¸¤å°ç”µè„‘ä¹‹é—´æŒ–äº†ä¸€æ¡"åœ°ä¸‹é€šé“"ï¼Œè®©æ•°æ®å¯ä»¥å®‰å…¨åœ°é€šè¿‡è¿™æ¡é€šé“ä¼ è¾“ã€‚

```
ä½ çš„ç”µè„‘          SSHéš§é“           è¿œç¨‹æœåŠ¡å™¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    ===============    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚æœ¬åœ°åº”ç”¨ â”‚â—„â”€â”€â”€  åŠ å¯†é€šé“  â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚è¿œç¨‹æœåŠ¡ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    ===============    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 æœ¬åœ°ç«¯å£è½¬å‘ï¼ˆLocal Port Forwardingï¼‰


**ç”¨é€”**ï¼šæŠŠè¿œç¨‹æœåŠ¡å™¨çš„ç«¯å£"æ˜ å°„"åˆ°æœ¬åœ°ï¼Œå°±åƒè¿œç¨‹æœåŠ¡åœ¨æœ¬åœ°è¿è¡Œä¸€æ ·ã€‚

#### åŸºæœ¬è¯­æ³•

```bash
ssh -L æœ¬åœ°ç«¯å£:ç›®æ ‡ä¸»æœº:ç›®æ ‡ç«¯å£ ç”¨æˆ·@è·³æ¿æœº
```

**ğŸ”¸ å®ç”¨ç¤ºä¾‹**
```bash
# è®¿é—®è¿œç¨‹æ•°æ®åº“
ssh -L 3306:localhost:3306 user@dbserver
# ç°åœ¨è®¿é—®æœ¬åœ°3306ç«¯å£å°±æ˜¯è®¿é—®è¿œç¨‹æ•°æ®åº“

# é€šè¿‡è·³æ¿æœºè®¿é—®å†…ç½‘æœåŠ¡
ssh -L 8080:internal.server:80 user@bastion
# æµè§ˆå™¨è®¿é—®localhost:8080å°±æ˜¯è®¿é—®å†…ç½‘æœåŠ¡å™¨çš„80ç«¯å£
```

**åº”ç”¨åœºæ™¯**ï¼š
- è®¿é—®è¿œç¨‹æ•°æ®åº“
- é€šè¿‡è·³æ¿æœºè®¿é—®å†…ç½‘æœåŠ¡
- ç»•è¿‡é˜²ç«å¢™é™åˆ¶

### 6.3 è¿œç¨‹ç«¯å£è½¬å‘ï¼ˆRemote Port Forwardingï¼‰


**ç”¨é€”**ï¼šæŠŠæœ¬åœ°æœåŠ¡"æš´éœ²"ç»™è¿œç¨‹æœåŠ¡å™¨ï¼Œè®©è¿œç¨‹å¯ä»¥è®¿é—®æœ¬åœ°æœåŠ¡ã€‚

```bash
# åŸºæœ¬è¯­æ³•
ssh -R è¿œç¨‹ç«¯å£:æœ¬åœ°ä¸»æœº:æœ¬åœ°ç«¯å£ ç”¨æˆ·@è¿œç¨‹æœåŠ¡å™¨
```

**ğŸ”¸ å®ç”¨ç¤ºä¾‹**
```bash
# è®©è¿œç¨‹æœåŠ¡å™¨è®¿é—®æœ¬åœ°WebæœåŠ¡
ssh -R 8080:localhost:3000 user@server
# è¿œç¨‹æœåŠ¡å™¨è®¿é—®localhost:8080å°±æ˜¯è®¿é—®ä½ æœ¬åœ°çš„3000ç«¯å£

# åå‘SSHè¿æ¥ï¼ˆå†…ç½‘ç©¿é€ï¼‰
ssh -R 2222:localhost:22 user@publicserver
# åœ¨å…¬ç½‘æœåŠ¡å™¨ä¸Šå¯ä»¥é€šè¿‡localhost:2222è¿æ¥åˆ°ä½ çš„å†…ç½‘æœºå™¨
```

### 6.4 åŠ¨æ€ç«¯å£è½¬å‘ï¼ˆSOCKSä»£ç†ï¼‰


**ç”¨é€”**ï¼šåˆ›å»ºä¸€ä¸ªSOCKSä»£ç†ï¼Œè®©æ‰€æœ‰ç½‘ç»œæµé‡éƒ½é€šè¿‡SSHæœåŠ¡å™¨ä¸­è½¬ã€‚

```bash
# åˆ›å»ºSOCKSä»£ç†
ssh -D 1080 user@server

# åå°è¿è¡Œ
ssh -D 1080 -f -N user@server
```

**ä½¿ç”¨æ–¹æ³•**ï¼š
- åœ¨æµè§ˆå™¨ä¸­è®¾ç½®SOCKSä»£ç†ï¼š`localhost:1080`
- æ‰€æœ‰ç½‘é¡µè®¿é—®éƒ½ä¼šé€šè¿‡SSHæœåŠ¡å™¨

**å¸¸ç”¨é€‰é¡¹**ï¼š
- `-f` = åå°è¿è¡Œ
- `-N` = ä¸æ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œåªå»ºç«‹éš§é“

---

## 7. ğŸ¯ è¿œç¨‹å‘½ä»¤æ‰§è¡ŒæŠ€å·§


### 7.1 å•æ¬¡è¿œç¨‹å‘½ä»¤æ‰§è¡Œ


**åŸºæœ¬è¯­æ³•**ï¼š
```bash
ssh user@server 'è¿œç¨‹å‘½ä»¤'
```

**ğŸ”¸ å®ç”¨ç¤ºä¾‹**
```bash
# æŸ¥çœ‹è¿œç¨‹æœåŠ¡å™¨çŠ¶æ€
ssh root@server 'uptime'

# æ‰§è¡Œå¤šä¸ªå‘½ä»¤
ssh root@server 'cd /var/log && tail -f messages'

# è·å–è¿œç¨‹ä¿¡æ¯å¹¶åœ¨æœ¬åœ°å¤„ç†
ssh root@server 'ps aux' | grep nginx
```

### 7.2 äº¤äº’å¼vséäº¤äº’å¼å‘½ä»¤


#### éäº¤äº’å¼å‘½ä»¤ï¼ˆæ¨èï¼‰

```bash
# é€‚åˆè„šæœ¬åŒ–çš„å‘½ä»¤
ssh server 'systemctl status nginx'
ssh server 'df -h'
ssh server 'free -m'
```

#### éœ€è¦äº¤äº’çš„å‘½ä»¤å¤„ç†

```bash
# ä½¿ç”¨-té€‰é¡¹åˆ†é…ç»ˆç«¯
ssh -t server 'sudo systemctl restart nginx'

# æˆ–ä½¿ç”¨here document
ssh server << 'EOF'
sudo systemctl stop nginx
sudo systemctl start nginx
sudo systemctl status nginx
EOF
```

### 7.3 è¿œç¨‹è„šæœ¬æ‰§è¡ŒæŠ€å·§


#### æ‰§è¡Œæœ¬åœ°è„šæœ¬åˆ°è¿œç¨‹

```bash
# æ–¹æ³•ä¸€ï¼šç®¡é“ä¼ è¾“
cat local_script.sh | ssh server 'bash -s'

# æ–¹æ³•äºŒï¼šå…ˆä¼ è¾“åæ‰§è¡Œ
scp local_script.sh server:/tmp/
ssh server 'bash /tmp/local_script.sh'

# æ–¹æ³•ä¸‰ï¼šä¸€æ¡å‘½ä»¤å®Œæˆ
ssh server 'bash -s' < local_script.sh
```

#### ä¼ é€’å‚æ•°ç»™è¿œç¨‹è„šæœ¬

```bash
# ç»™è¿œç¨‹è„šæœ¬ä¼ é€’å‚æ•°
ssh server 'bash -s arg1 arg2' < local_script.sh

# æˆ–è€…
cat script.sh | ssh server 'bash -s -- arg1 arg2'
```

### 7.4 è¿œç¨‹å‘½ä»¤è¾“å‡ºå¤„ç†


```bash
# æ•è·è¿œç¨‹å‘½ä»¤è¾“å‡º
REMOTE_OUTPUT=$(ssh server 'hostname && uptime')
echo "è¿œç¨‹æœåŠ¡å™¨ä¿¡æ¯: $REMOTE_OUTPUT"

# åˆ¤æ–­è¿œç¨‹å‘½ä»¤æ‰§è¡Œç»“æœ
if ssh server 'systemctl is-active nginx >/dev/null'; then
    echo "Nginxè¿è¡Œæ­£å¸¸"
else
    echo "Nginxæœªè¿è¡Œ"
fi
```

---

## 8. ğŸ”„ æ‰¹é‡SSHæ“ä½œå®è·µ


### 8.1 ä¼ ç»Ÿæ‰¹é‡æ“ä½œæ–¹æ³•


#### ä½¿ç”¨å¾ªç¯æ‰¹é‡æ“ä½œ

```bash
#!/bin/bash
# æœåŠ¡å™¨åˆ—è¡¨
SERVERS="
192.168.1.100
192.168.1.101  
192.168.1.102
"

# æ‰¹é‡æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
for server in $SERVERS; do
    echo "æ£€æŸ¥æœåŠ¡å™¨: $server"
    ssh root@$server 'hostname && uptime'
    echo "------------------------"
done
```

#### å¹¶è¡Œæ‰§è¡Œä¼˜åŒ–

```bash
#!/bin/bash
# å¹¶è¡Œæ‰§è¡Œæ‰¹é‡å‘½ä»¤
SERVERS="server1 server2 server3"

for server in $SERVERS; do
    {
        echo "å¤„ç†æœåŠ¡å™¨: $server"
        ssh $server 'your_command_here'
    } &
done

# ç­‰å¾…æ‰€æœ‰åå°ä»»åŠ¡å®Œæˆ
wait
echo "æ‰€æœ‰æœåŠ¡å™¨å¤„ç†å®Œæˆ"
```

### 8.2 psshå·¥å…·ç®€ä»‹


**pssh**ï¼ˆParallel SSHï¼‰æ˜¯**å¹¶è¡ŒSSHæ‰§è¡Œå·¥å…·**ï¼Œå¯ä»¥åŒæ—¶åœ¨å¤šå°æœåŠ¡å™¨ä¸Šæ‰§è¡Œå‘½ä»¤ã€‚

#### å®‰è£…pssh

```bash
# CentOS/RHEL
yum install pssh

# Ubuntu/Debian  
apt-get install pssh

# macOS
brew install pssh
```

#### psshåŸºæœ¬ä½¿ç”¨

```bash
# åˆ›å»ºæœåŠ¡å™¨åˆ—è¡¨æ–‡ä»¶
echo "root@192.168.1.100" > servers.txt
echo "root@192.168.1.101" >> servers.txt
echo "root@192.168.1.102" >> servers.txt

# å¹¶è¡Œæ‰§è¡Œå‘½ä»¤
pssh -h servers.txt -l root 'uptime'

# å¹¶è¡Œä¼ è¾“æ–‡ä»¶
pscp -h servers.txt local_file.txt /tmp/
```

### 8.3 Ansibleç®€ä»‹


**Ansible**æ˜¯**å¼ºå¤§çš„è‡ªåŠ¨åŒ–è¿ç»´å·¥å…·**ï¼Œå¯ä»¥ç†è§£ä¸º"è¶…çº§æ‰¹é‡æ“ä½œå™¨"ã€‚

#### AnsibleåŸºæœ¬æ¦‚å¿µ

- **Inventory** = æœåŠ¡å™¨æ¸…å•ï¼ˆå‘Šè¯‰Ansibleç®¡ç†å“ªäº›æœåŠ¡å™¨ï¼‰
- **Playbook** = æ“ä½œå‰§æœ¬ï¼ˆå‘Šè¯‰Ansibleåšä»€ä¹ˆï¼‰
- **Module** = åŠŸèƒ½æ¨¡å—ï¼ˆAnsibleçš„å„ç§åŠŸèƒ½ç»„ä»¶ï¼‰

#### ç®€å•ä½¿ç”¨ç¤ºä¾‹

```bash
# å®‰è£…Ansible
pip install ansible

# åˆ›å»ºinventoryæ–‡ä»¶
echo "[webservers]" > inventory
echo "192.168.1.100" >> inventory
echo "192.168.1.101" >> inventory

# æ‰¹é‡æ‰§è¡Œå‘½ä»¤
ansible webservers -i inventory -m shell -a 'uptime'

# æ‰¹é‡å¤åˆ¶æ–‡ä»¶
ansible webservers -i inventory -m copy -a 'src=file.txt dest=/tmp/'
```

---

## 9. ğŸ” SSHä»£ç†å’Œå¯†é’¥ç®¡ç†


### 9.1 SSH Agentæ¦‚å¿µ


**SSH Agent**å°±åƒæ˜¯"å¯†é’¥ç®¡å®¶"ï¼Œå¸®ä½ ç®¡ç†å’Œè®°ä½æ‰€æœ‰çš„SSHå¯†é’¥ï¼Œè¿™æ ·å°±ä¸ç”¨æ¯æ¬¡éƒ½è¾“å…¥å¯†ç çŸ­è¯­äº†ã€‚

### 9.2 SSH AgentåŸºæœ¬ä½¿ç”¨


#### å¯åŠ¨SSH Agent

```bash
# å¯åŠ¨ssh-agent
eval "$(ssh-agent -s)"

# æŸ¥çœ‹agentæ˜¯å¦è¿è¡Œ
echo $SSH_AUTH_SOCK
```

#### æ·»åŠ å¯†é’¥åˆ°Agent

```bash
# æ·»åŠ é»˜è®¤å¯†é’¥
ssh-add

# æ·»åŠ ç‰¹å®šå¯†é’¥
ssh-add ~/.ssh/id_rsa
ssh-add ~/.ssh/company_key

# æŸ¥çœ‹å·²åŠ è½½çš„å¯†é’¥
ssh-add -l

# åˆ é™¤æ‰€æœ‰å¯†é’¥
ssh-add -D
```

### 9.3 å¯†é’¥ç®¡ç†æœ€ä½³å®è·µ


#### ä¸åŒç”¨é€”ä½¿ç”¨ä¸åŒå¯†é’¥

```bash
# ä¸ªäººé¡¹ç›®å¯†é’¥
ssh-keygen -t ed25519 -f ~/.ssh/personal_key -C "personal@email.com"

# å·¥ä½œé¡¹ç›®å¯†é’¥  
ssh-keygen -t ed25519 -f ~/.ssh/work_key -C "work@company.com"

# GitHubä¸“ç”¨å¯†é’¥
ssh-keygen -t ed25519 -f ~/.ssh/github_key -C "github@email.com"
```

#### é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šå¯†é’¥

```
# ~/.ssh/config
Host github.com
    HostName github.com
    User git
    IdentityFile ~/.ssh/github_key

Host work-server
    HostName work.company.com
    User developer
    IdentityFile ~/.ssh/work_key
```

### 9.4 å¯†é’¥å®‰å…¨ç®¡ç†


#### å¯†é’¥å¤‡ä»½ç­–ç•¥

```bash
# åˆ›å»ºå¯†é’¥å¤‡ä»½ç›®å½•
mkdir -p ~/ssh_backup/$(date +%Y-%m-%d)

# å¤‡ä»½æ‰€æœ‰å¯†é’¥
cp ~/.ssh/id_* ~/ssh_backup/$(date +%Y-%m-%d)/

# åŠ å¯†å¤‡ä»½
tar -czf ssh_keys_backup.tar.gz ~/.ssh/
gpg -c ssh_keys_backup.tar.gz
```

#### å®šæœŸè½®æ¢å¯†é’¥

```bash
#!/bin/bash
# å¯†é’¥è½®æ¢è„šæœ¬ç¤ºä¾‹
OLD_KEY=~/.ssh/id_rsa
NEW_KEY=~/.ssh/id_rsa_new

# ç”Ÿæˆæ–°å¯†é’¥
ssh-keygen -t ed25519 -f $NEW_KEY

# éƒ¨ç½²æ–°å…¬é’¥åˆ°æ‰€æœ‰æœåŠ¡å™¨
for server in $(cat server_list.txt); do
    ssh-copy-id -i ${NEW_KEY}.pub $server
done

echo "æ–°å¯†é’¥å·²éƒ¨ç½²ï¼Œè¯·æµ‹è¯•ååˆ é™¤æ—§å¯†é’¥"
```

---

## 10. ğŸ¤– è‡ªåŠ¨åŒ–SSHæ“ä½œè„šæœ¬


### 10.1 æœåŠ¡å™¨å¥åº·æ£€æŸ¥è„šæœ¬


```bash
#!/bin/bash
# æœåŠ¡å™¨å¥åº·æ£€æŸ¥è„šæœ¬

SERVERS_FILE="servers.txt"
LOG_FILE="health_check_$(date +%Y%m%d_%H%M%S).log"

check_server() {
    local server=$1
    echo "æ£€æŸ¥æœåŠ¡å™¨: $server" | tee -a $LOG_FILE
    
    # SSHè¿æ¥æµ‹è¯•
    if timeout 10 ssh -o ConnectTimeout=5 $server 'echo "SSHè¿æ¥æ­£å¸¸"' &>/dev/null; then
        echo "  âœ… SSHè¿æ¥: æ­£å¸¸" | tee -a $LOG_FILE
        
        # ç³»ç»Ÿè´Ÿè½½æ£€æŸ¥
        LOAD=$(ssh $server 'uptime | awk -F"load average:" {print $2}' | cut -d, -f1 | xargs)
        echo "  ğŸ“Š ç³»ç»Ÿè´Ÿè½½: $LOAD" | tee -a $LOG_FILE
        
        # ç£ç›˜ä½¿ç”¨æ£€æŸ¥
        DISK_USAGE=$(ssh $server 'df -h / | tail -1 | awk {print $5}' | tr -d %)
        if [ $DISK_USAGE -gt 80 ]; then
            echo "  âš ï¸  ç£ç›˜ä½¿ç”¨: ${DISK_USAGE}% (è­¦å‘Š)" | tee -a $LOG_FILE
        else
            echo "  ğŸ’¾ ç£ç›˜ä½¿ç”¨: ${DISK_USAGE}% (æ­£å¸¸)" | tee -a $LOG_FILE
        fi
        
        # å†…å­˜ä½¿ç”¨æ£€æŸ¥
        MEMORY=$(ssh $server 'free | grep Mem | awk {printf "%.1f", $3/$2 * 100.0}')
        echo "  ğŸ§  å†…å­˜ä½¿ç”¨: ${MEMORY}%" | tee -a $LOG_FILE
        
    else
        echo "  âŒ SSHè¿æ¥: å¤±è´¥" | tee -a $LOG_FILE
    fi
    echo "------------------------" | tee -a $LOG_FILE
}

# ä¸»ç¨‹åº
echo "=== æœåŠ¡å™¨å¥åº·æ£€æŸ¥å¼€å§‹ ===" | tee $LOG_FILE
echo "æ£€æŸ¥æ—¶é—´: $(date)" | tee -a $LOG_FILE
echo | tee -a $LOG_FILE

while read -r server; do
    [[ $server =~ ^#.*$ ]] && continue  # è·³è¿‡æ³¨é‡Šè¡Œ
    [[ -z "$server" ]] && continue      # è·³è¿‡ç©ºè¡Œ
    check_server $server
done < $SERVERS_FILE

echo "=== æ£€æŸ¥å®Œæˆ ===" | tee -a $LOG_FILE
echo "è¯¦ç»†æ—¥å¿—: $LOG_FILE"
```

### 10.2 æ‰¹é‡éƒ¨ç½²è„šæœ¬


```bash
#!/bin/bash
# æ‰¹é‡éƒ¨ç½²è„šæœ¬

SERVERS_FILE="deploy_servers.txt"
LOCAL_FILES="deploy_files.txt"
REMOTE_DIR="/opt/application/"

deploy_to_server() {
    local server=$1
    echo "éƒ¨ç½²åˆ°æœåŠ¡å™¨: $server"
    
    # åˆ›å»ºè¿œç¨‹ç›®å½•
    ssh $server "mkdir -p $REMOTE_DIR"
    
    # ä¸Šä¼ æ–‡ä»¶
    while read -r file; do
        if [[ -f "$file" ]]; then
            echo "  ä¸Šä¼ æ–‡ä»¶: $file"
            scp "$file" $server:$REMOTE_DIR
        fi
    done < $LOCAL_FILES
    
    # æ‰§è¡Œè¿œç¨‹éƒ¨ç½²è„šæœ¬
    if ssh $server "test -f ${REMOTE_DIR}deploy.sh"; then
        echo "  æ‰§è¡Œéƒ¨ç½²è„šæœ¬"
        ssh $server "cd $REMOTE_DIR && bash deploy.sh"
    fi
    
    echo "  æœåŠ¡å™¨ $server éƒ¨ç½²å®Œæˆ"
}

# ä¸»ç¨‹åº
echo "=== å¼€å§‹æ‰¹é‡éƒ¨ç½² ==="
while read -r server; do
    [[ $server =~ ^#.*$ ]] && continue
    [[ -z "$server" ]] && continue
    deploy_to_server $server
done < $SERVERS_FILE

echo "=== éƒ¨ç½²å®Œæˆ ==="
```

### 10.3 è‡ªåŠ¨åŒ–å¤‡ä»½è„šæœ¬


```bash
#!/bin/bash
# è‡ªåŠ¨åŒ–å¤‡ä»½è„šæœ¬

BACKUP_LIST="backup_config.txt"
BACKUP_ROOT="/backup/$(date +%Y/%m/%d)"
LOG_FILE="backup_$(date +%Y%m%d).log"

backup_server() {
    local server=$1
    local source_path=$2
    local backup_name=$3
    
    echo "å¤‡ä»½æœåŠ¡å™¨: $server, è·¯å¾„: $source_path" | tee -a $LOG_FILE
    
    # åˆ›å»ºæœ¬åœ°å¤‡ä»½ç›®å½•
    local local_backup_dir="$BACKUP_ROOT/$backup_name"
    mkdir -p "$local_backup_dir"
    
    # ä½¿ç”¨rsyncåŒæ­¥å¤‡ä»½
    if rsync -avz --delete $server:$source_path/ $local_backup_dir/; then
        echo "  âœ… å¤‡ä»½æˆåŠŸ: $local_backup_dir" | tee -a $LOG_FILE
        
        # åˆ›å»ºå¤‡ä»½è¯´æ˜æ–‡ä»¶
        cat > "$local_backup_dir/backup_info.txt" << EOF
å¤‡ä»½æœåŠ¡å™¨: $server
æºè·¯å¾„: $source_path  
å¤‡ä»½æ—¶é—´: $(date)
å¤‡ä»½å¤§å°: $(du -sh $local_backup_dir | cut -f1)
EOF
        
    else
        echo "  âŒ å¤‡ä»½å¤±è´¥: $server:$source_path" | tee -a $LOG_FILE
    fi
}

# ä¸»ç¨‹åº
echo "=== è‡ªåŠ¨å¤‡ä»½å¼€å§‹ ===" | tee $LOG_FILE

# è¯»å–å¤‡ä»½é…ç½®æ–‡ä»¶æ ¼å¼ï¼šserver:source_path:backup_name
while IFS=':' read -r server source_path backup_name; do
    [[ $server =~ ^#.*$ ]] && continue
    [[ -z "$server" ]] && continue
    backup_server "$server" "$source_path" "$backup_name"
done < $BACKUP_LIST

echo "=== å¤‡ä»½å®Œæˆ ===" | tee -a $LOG_FILE
```

---

## 11. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 11.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ â­â­â­


```
ğŸ”¸ SSHåŸºç¡€ï¼šå®‰å…¨è¿œç¨‹ç™»å½•åè®®ï¼Œç½‘ç»œç‰ˆç»ˆç«¯
ğŸ”¸ è®¤è¯æ–¹å¼ï¼šå¯†ç è®¤è¯ï¼ˆç®€å•ï¼‰vs å¯†é’¥è®¤è¯ï¼ˆå®‰å…¨ï¼‰
ğŸ”¸ å¯†é’¥åŸç†ï¼šå…¬é’¥ï¼ˆé”ï¼‰+ ç§é’¥ï¼ˆé’¥åŒ™ï¼‰çš„é…å¯¹æœºåˆ¶
ğŸ”¸ æ–‡ä»¶ä¼ è¾“ï¼šscpï¼ˆç®€å•å¤åˆ¶ï¼‰vs rsyncï¼ˆæ™ºèƒ½åŒæ­¥ï¼‰
ğŸ”¸ é…ç½®æ–‡ä»¶ï¼š~/.ssh/config æœåŠ¡å™¨è¿æ¥é€šè®¯å½•
ğŸ”¸ ç«¯å£è½¬å‘ï¼šæœ¬åœ°ã€è¿œç¨‹ã€åŠ¨æ€ä¸‰ç§éš§é“æ¨¡å¼
ğŸ”¸ è¿œç¨‹æ‰§è¡Œï¼šå•æ¬¡å‘½ä»¤ vs æ‰¹é‡æ“ä½œçš„æŠ€å·§
```

### 11.2 å…³é”®å‘½ä»¤é€ŸæŸ¥è¡¨


| **æ“ä½œç±»å‹** | **å¸¸ç”¨å‘½ä»¤** | **ä½œç”¨è¯´æ˜** |
|-------------|-------------|-------------|
| ğŸ” **åŸºç¡€è¿æ¥** | `ssh user@server` | `åŸºæœ¬è¿œç¨‹ç™»å½•` |
| ğŸ”‘ **å¯†é’¥ç”Ÿæˆ** | `ssh-keygen -t ed25519` | `ç”ŸæˆSSHå¯†é’¥å¯¹` |
| ğŸ“¤ **å¯†é’¥éƒ¨ç½²** | `ssh-copy-id user@server` | `éƒ¨ç½²å…¬é’¥åˆ°æœåŠ¡å™¨` |
| ğŸ“ **æ–‡ä»¶ä¸Šä¼ ** | `scp file.txt user@server:/path/` | `ä¸Šä¼ æ–‡ä»¶åˆ°è¿œç¨‹` |
| ğŸ“¥ **æ–‡ä»¶ä¸‹è½½** | `scp user@server:/file.txt ./` | `ä¸‹è½½è¿œç¨‹æ–‡ä»¶` |
| ğŸ”„ **ç›®å½•åŒæ­¥** | `rsync -avz src/ user@server:/dst/` | `åŒæ­¥ç›®å½•åˆ°è¿œç¨‹` |
| ğŸš‡ **æœ¬åœ°è½¬å‘** | `ssh -L 8080:localhost:80 server` | `è¿œç¨‹ç«¯å£æ˜ å°„åˆ°æœ¬åœ°` |
| ğŸ¯ **è¿œç¨‹å‘½ä»¤** | `ssh server 'command'` | `æ‰§è¡Œè¿œç¨‹å‘½ä»¤` |

### 11.3 å®‰å…¨æœ€ä½³å®è·µ ğŸ›¡ï¸


**ğŸ”¸ è®¤è¯å®‰å…¨**
- ä¼˜å…ˆä½¿ç”¨**å¯†é’¥è®¤è¯**ï¼Œé¿å…å¯†ç æš´åŠ›ç ´è§£
- ä¸ºä¸åŒç”¨é€”ç”Ÿæˆ**ç‹¬ç«‹å¯†é’¥**ï¼Œé™ä½é£é™©
- è®¾ç½®**å¯†é’¥å¯†ç çŸ­è¯­**ï¼Œå¢åŠ å®‰å…¨å±‚æ¬¡
- å®šæœŸ**è½®æ¢å¯†é’¥**ï¼Œä¿æŒå®‰å…¨æ€§

**ğŸ”¸ è¿æ¥å®‰å…¨**  
- ä¿®æ”¹SSH**é»˜è®¤ç«¯å£**ï¼ˆ22â†’å…¶ä»–ç«¯å£ï¼‰
- ç¦ç”¨**rootç›´æ¥ç™»å½•**ï¼Œä½¿ç”¨æ™®é€šç”¨æˆ·+sudo
- é…ç½®**é˜²ç«å¢™è§„åˆ™**ï¼Œé™åˆ¶SSHè®¿é—®æ¥æº
- å¯ç”¨**å¤±è´¥æ¬¡æ•°é™åˆ¶**ï¼Œé˜²æ­¢æš´åŠ›ç ´è§£

**ğŸ”¸ æ–‡ä»¶æƒé™**
```bash
chmod 700 ~/.ssh          # SSHç›®å½•æƒé™
chmod 600 ~/.ssh/id_rsa   # ç§é’¥æ–‡ä»¶æƒé™  
chmod 644 ~/.ssh/id_rsa.pub  # å…¬é’¥æ–‡ä»¶æƒé™
chmod 600 ~/.ssh/authorized_keys  # æˆæƒæ–‡ä»¶æƒé™
```

### 11.4 å®é™…åº”ç”¨åœºæ™¯æŒ‡å—


**ğŸ¯ é€‰æ‹©åˆé€‚çš„å·¥å…·**

| **ä½¿ç”¨åœºæ™¯** | **æ¨èå·¥å…·** | **ç†ç”±** |
|-------------|-------------|----------|
| ğŸ“± **æ—¥å¸¸è¿ç»´ç™»å½•** | `ssh + é…ç½®æ–‡ä»¶` | `å¿«é€Ÿä¾¿æ·ï¼Œåˆ«åç®¡ç†` |
| ğŸ“‚ **å•æ¬¡æ–‡ä»¶ä¼ è¾“** | `scp` | `ç®€å•ç›´æ¥ï¼Œä¸€æ¡å‘½ä»¤æå®š` |
| ğŸ”„ **å®šæœŸæ•°æ®åŒæ­¥** | `rsync` | `å¢é‡ä¼ è¾“ï¼ŒèŠ‚çœå¸¦å®½` |
| ğŸŒ **è®¿é—®å†…ç½‘æœåŠ¡** | `SSHéš§é“` | `å®‰å…¨ç©¿é€é˜²ç«å¢™` |
| âš™ï¸ **æ‰¹é‡æœåŠ¡å™¨ç®¡ç†** | `pssh/ansible` | `å¹¶è¡Œæ‰§è¡Œï¼Œæé«˜æ•ˆç‡` |
| ğŸ¤– **è‡ªåŠ¨åŒ–è¿ç»´** | `shellè„šæœ¬ + SSH` | `å®šåˆ¶åŒ–ç¨‹åº¦é«˜` |

**ğŸ”§ å¸¸è§é—®é¢˜è§£å†³**

```
é—®é¢˜ï¼šSSHè¿æ¥è¶…æ—¶
è§£å†³ï¼šæ£€æŸ¥ç½‘ç»œã€é˜²ç«å¢™ã€SSHæœåŠ¡çŠ¶æ€

é—®é¢˜ï¼šå¯†é’¥è®¤è¯å¤±è´¥  
è§£å†³ï¼šæ£€æŸ¥æ–‡ä»¶æƒé™ã€å…¬é’¥å†…å®¹ã€authorized_keys

é—®é¢˜ï¼šè¿æ¥é€Ÿåº¦æ…¢
è§£å†³ï¼šå¯ç”¨è¿æ¥å¤ç”¨ã€å‹ç¼©ä¼ è¾“ã€ä¼˜åŒ–é…ç½®

é—®é¢˜ï¼šæ‰¹é‡æ“ä½œæ•ˆç‡ä½
è§£å†³ï¼šä½¿ç”¨psshå¹¶è¡Œæ‰§è¡Œæˆ–ç¼–å†™å¹¶å‘è„šæœ¬
```

### 11.5 å­¦ä¹ è¿›é˜¶è·¯å¾„


**ğŸš€ è¿›é˜¶å­¦ä¹ å»ºè®®**

1. **åŸºç¡€æŒæ¡** â˜…â˜…â˜…
   - SSHè¿æ¥å’Œå¯†é’¥è®¤è¯
   - scp/rsyncæ–‡ä»¶ä¼ è¾“
   - åŸºæœ¬é…ç½®æ–‡ä»¶ä½¿ç”¨

2. **ä¸­çº§åº”ç”¨** â˜…â˜…â˜†
   - SSHéš§é“å’Œç«¯å£è½¬å‘
   - æ‰¹é‡æ“ä½œå’Œè„šæœ¬ç¼–å†™
   - SSH Agentå’Œå¯†é’¥ç®¡ç†

3. **é«˜çº§è¿ç»´** â˜…â˜†â˜†
   - Ansibleè‡ªåŠ¨åŒ–è¿ç»´
   - å¤æ‚ç½‘ç»œç¯å¢ƒé…ç½®
   - å®‰å…¨åŠ å›ºå’Œå®¡è®¡

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- SSH = å®‰å…¨è¿œç¨‹æ“ä½œçš„ä¸‡èƒ½å·¥å…·
- å¯†é’¥è®¤è¯ > å¯†ç è®¤è¯ï¼Œå®‰å…¨æ€§ç¬¬ä¸€
- é…ç½®æ–‡ä»¶æ˜¯æ•ˆç‡ç¥å™¨ï¼Œå¿…é¡»æŒæ¡
- éš§é“æŠ€æœ¯è§£å†³ç½‘ç»œé™åˆ¶é—®é¢˜
- æ‰¹é‡æ“ä½œæå‡è¿ç»´æ•ˆç‡
- è„šæœ¬è‡ªåŠ¨åŒ–æ˜¯é«˜çº§è¿ç»´çš„æ ‡å¿—