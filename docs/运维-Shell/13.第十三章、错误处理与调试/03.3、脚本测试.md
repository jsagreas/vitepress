---
title: 3ã€è„šæœ¬æµ‹è¯•
---
## ğŸ“š ç›®å½•

1. [è„šæœ¬è¯­æ³•æ£€æŸ¥](#1-è„šæœ¬è¯­æ³•æ£€æŸ¥)
2. [å•å…ƒæµ‹è¯•åŸºç¡€](#2-å•å…ƒæµ‹è¯•åŸºç¡€)
3. [æµ‹è¯•ç”¨ä¾‹è®¾è®¡](#3-æµ‹è¯•ç”¨ä¾‹è®¾è®¡)
4. [è¾¹ç•Œæ¡ä»¶æµ‹è¯•](#4-è¾¹ç•Œæ¡ä»¶æµ‹è¯•)
5. [æ€§èƒ½æµ‹è¯•å®è·µ](#5-æ€§èƒ½æµ‹è¯•å®è·µ)
6. [è‡ªåŠ¨åŒ–æµ‹è¯•æµç¨‹](#6-è‡ªåŠ¨åŒ–æµ‹è¯•æµç¨‹)
7. [æµ‹è¯•æ¡†æ¶åº”ç”¨](#7-æµ‹è¯•æ¡†æ¶åº”ç”¨)
8. [æŒç»­é›†æˆå®è·µ](#8-æŒç»­é›†æˆå®è·µ)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” è„šæœ¬è¯­æ³•æ£€æŸ¥


### 1.1 ä»€ä¹ˆæ˜¯è¯­æ³•æ£€æŸ¥


**è¯­æ³•æ£€æŸ¥**å°±æ˜¯åœ¨ä¸å®é™…æ‰§è¡Œè„šæœ¬çš„æƒ…å†µä¸‹ï¼Œæ£€æŸ¥è„šæœ¬æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯çš„è¿‡ç¨‹ã€‚è¿™å°±åƒå†™ä½œæ–‡å‰å…ˆæ£€æŸ¥è¯­æ³•å’Œæ‹¼å†™é”™è¯¯ä¸€æ ·ã€‚

> ğŸ’¡ **æ ¸å¿ƒæ¦‚å¿µ**ï¼šè¯­æ³•æ£€æŸ¥èƒ½å¸®æˆ‘ä»¬åœ¨è„šæœ¬è¿è¡Œå‰å‘ç°æ½œåœ¨é—®é¢˜ï¼Œé¿å…ç”Ÿäº§ç¯å¢ƒå‡ºé”™

### 1.2 bash -n è¯­æ³•æ£€æŸ¥


**`bash -n`** æ˜¯æœ€å¸¸ç”¨çš„è¯­æ³•æ£€æŸ¥å·¥å…·ï¼Œ`-n` å‚æ•°è¡¨ç¤º"no execution"ï¼Œå³åªæ£€æŸ¥ä¸æ‰§è¡Œã€‚

```bash
# åŸºæœ¬è¯­æ³•æ£€æŸ¥
bash -n script.sh

# æ£€æŸ¥å¤šä¸ªè„šæœ¬
bash -n *.sh
```

**å®é™…åº”ç”¨ç¤ºä¾‹**ï¼š

```bash
# åˆ›å»ºä¸€ä¸ªæœ‰è¯­æ³•é”™è¯¯çš„è„šæœ¬
cat > test_error.sh << 'EOF'
#!/bin/bash
echo "Hello World"
if [ $1 = "test" ]  # ç¼ºå°‘ then
    echo "This is test"
fi
EOF

# è¯­æ³•æ£€æŸ¥
bash -n test_error.sh
# è¾“å‡ºï¼štest_error.sh: line 4: syntax error near unexpected token `echo'
```

### 1.3 å…¶ä»–è¯­æ³•æ£€æŸ¥å·¥å…·


```
è¯­æ³•æ£€æŸ¥å·¥å…·å¯¹æ¯”ï¼š

å·¥å…·åç§°        æ£€æŸ¥èƒ½åŠ›             ç‰¹ç‚¹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
bash -n        åŸºç¡€è¯­æ³•é”™è¯¯         å†…ç½®ï¼Œå¿«é€Ÿ
shellcheck     æ·±åº¦é™æ€åˆ†æ         ä¸“ä¸šï¼Œå…¨é¢
sh -n          POSIXå…¼å®¹æ£€æŸ¥        æ ‡å‡†åŒ–
```

**ShellCheck é«˜çº§æ£€æŸ¥**ï¼š

```bash
# å®‰è£… shellcheckï¼ˆä»¥Ubuntuä¸ºä¾‹ï¼‰
sudo apt install shellcheck

# æ£€æŸ¥è„šæœ¬
shellcheck script.sh

# æŒ‡å®šshellç±»å‹æ£€æŸ¥
shellcheck -s bash script.sh
```

### 1.4 è¯­æ³•æ£€æŸ¥æœ€ä½³å®è·µ


> âš ï¸ **é‡è¦æé†’**ï¼šè¯­æ³•æ£€æŸ¥åªèƒ½å‘ç°è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½å‘ç°é€»è¾‘é”™è¯¯

**æ£€æŸ¥æµç¨‹å›¾**ï¼š
```
ç¼–å†™è„šæœ¬ â†’ è¯­æ³•æ£€æŸ¥ â†’ ä¿®å¤é”™è¯¯ â†’ åŠŸèƒ½æµ‹è¯• â†’ éƒ¨ç½²ä½¿ç”¨
    â†‘         â†“
    â””â”€â”€â”€ å‘ç°é”™è¯¯ â†â”€â”˜
```

**å®ç”¨æ£€æŸ¥è„šæœ¬**ï¼š

```bash
#!/bin/bash
# æ‰¹é‡è¯­æ³•æ£€æŸ¥å·¥å…·

check_syntax() {
    local script_dir=${1:-.}
    local error_count=0
    
    echo "ğŸ” å¼€å§‹æ£€æŸ¥ $script_dir ç›®å½•ä¸‹çš„è„šæœ¬..."
    
    for script in "$script_dir"/*.sh; do
        if [[ -f "$script" ]]; then
            echo -n "æ£€æŸ¥ $script ... "
            if bash -n "$script" 2>/dev/null; then
                echo "âœ… é€šè¿‡"
            else
                echo "âŒ è¯­æ³•é”™è¯¯"
                bash -n "$script"
                ((error_count++))
            fi
        fi
    done
    
    echo "æ£€æŸ¥å®Œæˆï¼Œå‘ç° $error_count ä¸ªé”™è¯¯è„šæœ¬"
}

check_syntax "$1"
```

---

## 2. ğŸ§ª å•å…ƒæµ‹è¯•åŸºç¡€


### 2.1 ä»€ä¹ˆæ˜¯å•å…ƒæµ‹è¯•


**å•å…ƒæµ‹è¯•**æ˜¯å¯¹è„šæœ¬ä¸­æœ€å°å¯æµ‹è¯•å•å…ƒï¼ˆé€šå¸¸æ˜¯å‡½æ•°ï¼‰è¿›è¡ŒéªŒè¯çš„è¿‡ç¨‹ã€‚å°±åƒæ£€æŸ¥æ±½è½¦çš„æ¯ä¸ªé›¶ä»¶æ˜¯å¦æ­£å¸¸å·¥ä½œä¸€æ ·ã€‚

> ğŸ“– **æ¦‚å¿µè§£é‡Š**ï¼šå•å…ƒæµ‹è¯•å…³æ³¨çš„æ˜¯"è¿™ä¸ªå‡½æ•°è¾“å…¥Aï¼Œæ˜¯å¦è¾“å‡ºB"

### 2.2 Shellä¸­çš„å•å…ƒæµ‹è¯•æ€ç»´


**ä¼ ç»Ÿç¼–ç¨‹ vs Shellè„šæœ¬æµ‹è¯•**ï¼š

```
ä¼ ç»Ÿå•å…ƒæµ‹è¯•              Shellå•å…ƒæµ‹è¯•
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æµ‹è¯•ç±»/æ–¹æ³•              æµ‹è¯•å‡½æ•°/å‘½ä»¤
æ–­è¨€ç»“æœ                 æ£€æŸ¥è¿”å›å€¼/è¾“å‡º
æ¨¡æ‹Ÿå¯¹è±¡                 æ¨¡æ‹Ÿå‘½ä»¤/æ–‡ä»¶
```

### 2.3 ç®€å•çš„å•å…ƒæµ‹è¯•å®ç°


**åŸºç¡€æµ‹è¯•æ¡†æ¶**ï¼š

```bash
#!/bin/bash
# ç®€å•çš„æµ‹è¯•æ¡†æ¶

# æµ‹è¯•è®¡æ•°å™¨
TEST_COUNT=0
PASS_COUNT=0
FAIL_COUNT=0

# æ–­è¨€å‡½æ•°
assert_equal() {
    local expected="$1"
    local actual="$2"
    local test_name="${3:-Test}"
    
    ((TEST_COUNT++))
    
    if [[ "$expected" == "$actual" ]]; then
        echo "âœ… PASS: $test_name"
        ((PASS_COUNT++))
    else
        echo "âŒ FAIL: $test_name"
        echo "   æœŸæœ›: $expected"
        echo "   å®é™…: $actual"
        ((FAIL_COUNT++))
    fi
}

# æµ‹è¯•æŠ¥å‘Š
test_report() {
    echo ""
    echo "ğŸ“Š æµ‹è¯•æŠ¥å‘Š"
    echo "æ€»è®¡: $TEST_COUNT"
    echo "é€šè¿‡: $PASS_COUNT"
    echo "å¤±è´¥: $FAIL_COUNT"
    
    if [[ $FAIL_COUNT -eq 0 ]]; then
        echo "ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼"
        return 0
    else
        echo "âš ï¸ æœ‰ $FAIL_COUNT ä¸ªæµ‹è¯•å¤±è´¥"
        return 1
    fi
}
```

### 2.4 å®é™…æµ‹è¯•ç¤ºä¾‹


**è¢«æµ‹è¯•çš„å‡½æ•°**ï¼š

```bash
# è®¡ç®—å™¨å‡½æ•°
calculator() {
    local operation="$1"
    local num1="$2"
    local num2="$3"
    
    case "$operation" in
        "add") echo $((num1 + num2)) ;;
        "sub") echo $((num1 - num2)) ;;
        "mul") echo $((num1 * num2)) ;;
        "div") 
            if [[ $num2 -eq 0 ]]; then
                echo "Error: Division by zero" >&2
                return 1
            fi
            echo $((num1 / num2))
            ;;
        *) echo "Error: Unknown operation" >&2; return 1 ;;
    esac
}
```

**å¯¹åº”çš„æµ‹è¯•**ï¼š

```bash
#!/bin/bash
# æµ‹è¯•è®¡ç®—å™¨å‡½æ•°

source ./calculator.sh  # å¼•å…¥è¢«æµ‹è¯•çš„å‡½æ•°
source ./test_framework.sh  # å¼•å…¥æµ‹è¯•æ¡†æ¶

# æµ‹è¯•åŠ æ³•
result=$(calculator add 5 3)
assert_equal "8" "$result" "åŠ æ³•æµ‹è¯•"

# æµ‹è¯•å‡æ³•
result=$(calculator sub 10 4)
assert_equal "6" "$result" "å‡æ³•æµ‹è¯•"

# æµ‹è¯•é™¤é›¶é”™è¯¯
calculator div 5 0 2>/dev/null
assert_equal "1" "$?" "é™¤é›¶é”™è¯¯æµ‹è¯•"

# ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
test_report
```

---

## 3. ğŸ“‹ æµ‹è¯•ç”¨ä¾‹è®¾è®¡


### 3.1 ä»€ä¹ˆæ˜¯æµ‹è¯•ç”¨ä¾‹


**æµ‹è¯•ç”¨ä¾‹**æ˜¯ä¸ºäº†éªŒè¯è„šæœ¬åŠŸèƒ½è€Œè®¾è®¡çš„å…·ä½“æµ‹è¯•åœºæ™¯ã€‚å°±åƒè€ƒè¯•é¢˜ç›®ä¸€æ ·ï¼Œæ¯ä¸ªç”¨ä¾‹éƒ½æœ‰æ˜ç¡®çš„è¾“å…¥å’ŒæœŸæœ›è¾“å‡ºã€‚

> ğŸ¯ **è®¾è®¡åŸåˆ™**ï¼šå¥½çš„æµ‹è¯•ç”¨ä¾‹åº”è¯¥è¦†ç›–æ­£å¸¸æƒ…å†µã€å¼‚å¸¸æƒ…å†µå’Œè¾¹ç•Œæƒ…å†µ

### 3.2 æµ‹è¯•ç”¨ä¾‹è®¾è®¡ç­–ç•¥


**æµ‹è¯•ç±»å‹åˆ†ç±»**ï¼š

```
æ­£å‘æµ‹è¯•ç”¨ä¾‹          åå‘æµ‹è¯•ç”¨ä¾‹          è¾¹ç•Œæµ‹è¯•ç”¨ä¾‹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ“ æ­£ç¡®è¾“å…¥           âœ— é”™è¯¯è¾“å…¥           ğŸ”„ ä¸´ç•Œå€¼è¾“å…¥
âœ“ æ ‡å‡†æµç¨‹           âœ— å¼‚å¸¸æµç¨‹           ğŸ”„ æœ€å¤§/æœ€å°å€¼
âœ“ é¢„æœŸç»“æœ           âœ— é”™è¯¯å¤„ç†           ğŸ”„ ç©ºå€¼/ç‰¹æ®Šå­—ç¬¦
```

### 3.3 æ–‡ä»¶æ“ä½œæµ‹è¯•ç”¨ä¾‹è®¾è®¡


**è¢«æµ‹è¯•è„šæœ¬**ï¼š

```bash
#!/bin/bash
# æ–‡ä»¶ç®¡ç†è„šæœ¬

file_manager() {
    local action="$1"
    local filename="$2"
    
    case "$action" in
        "create")
            if [[ -z "$filename" ]]; then
                echo "Error: æ–‡ä»¶åä¸èƒ½ä¸ºç©º" >&2
                return 1
            fi
            touch "$filename" && echo "æ–‡ä»¶ $filename åˆ›å»ºæˆåŠŸ"
            ;;
        "delete")
            if [[ ! -f "$filename" ]]; then
                echo "Error: æ–‡ä»¶ä¸å­˜åœ¨" >&2
                return 1
            fi
            rm "$filename" && echo "æ–‡ä»¶ $filename åˆ é™¤æˆåŠŸ"
            ;;
        "check")
            [[ -f "$filename" ]] && echo "å­˜åœ¨" || echo "ä¸å­˜åœ¨"
            ;;
    esac
}
```

**å®Œæ•´æµ‹è¯•ç”¨ä¾‹**ï¼š

```bash
#!/bin/bash
# æ–‡ä»¶ç®¡ç†æµ‹è¯•ç”¨ä¾‹

source ./file_manager.sh
source ./test_framework.sh

# å‡†å¤‡æµ‹è¯•ç¯å¢ƒ
setup_test() {
    TEST_DIR="/tmp/shell_test_$$"
    mkdir -p "$TEST_DIR"
    cd "$TEST_DIR"
    echo "ğŸ—ï¸ æµ‹è¯•ç¯å¢ƒå‡†å¤‡å®Œæˆ: $TEST_DIR"
}

# æ¸…ç†æµ‹è¯•ç¯å¢ƒ
teardown_test() {
    cd /
    rm -rf "$TEST_DIR"
    echo "ğŸ§¹ æµ‹è¯•ç¯å¢ƒæ¸…ç†å®Œæˆ"
}

# æµ‹è¯•ç”¨ä¾‹1ï¼šæ­£å¸¸åˆ›å»ºæ–‡ä»¶
test_create_file() {
    local result=$(file_manager create "test.txt")
    assert_equal "æ–‡ä»¶ test.txt åˆ›å»ºæˆåŠŸ" "$result" "åˆ›å»ºæ–‡ä»¶æµ‹è¯•"
    
    # éªŒè¯æ–‡ä»¶ç¡®å®å­˜åœ¨
    [[ -f "test.txt" ]]
    assert_equal "0" "$?" "æ–‡ä»¶å­˜åœ¨æ€§éªŒè¯"
}

# æµ‹è¯•ç”¨ä¾‹2ï¼šç©ºæ–‡ä»¶åé”™è¯¯å¤„ç†
test_empty_filename() {
    file_manager create "" 2>/dev/null
    assert_equal "1" "$?" "ç©ºæ–‡ä»¶åé”™è¯¯å¤„ç†"
}

# æµ‹è¯•ç”¨ä¾‹3ï¼šåˆ é™¤ä¸å­˜åœ¨çš„æ–‡ä»¶
test_delete_nonexistent() {
    file_manager delete "nonexistent.txt" 2>/dev/null
    assert_equal "1" "$?" "åˆ é™¤ä¸å­˜åœ¨æ–‡ä»¶æµ‹è¯•"
}

# æ‰§è¡Œæµ‹è¯•
main() {
    setup_test
    
    echo "ğŸ§ª å¼€å§‹æ‰§è¡Œæ–‡ä»¶ç®¡ç†æµ‹è¯•ç”¨ä¾‹"
    test_create_file
    test_empty_filename  
    test_delete_nonexistent
    
    test_report
    teardown_test
}

main "$@"
```

### 3.4 æµ‹è¯•ç”¨ä¾‹æ–‡æ¡£åŒ–


**æµ‹è¯•ç”¨ä¾‹æ¨¡æ¿**ï¼š

```
æµ‹è¯•ç”¨ä¾‹ID: TC001
æµ‹è¯•åç§°: æ–‡ä»¶åˆ›å»ºåŠŸèƒ½æµ‹è¯•
å‰ç½®æ¡ä»¶: æµ‹è¯•ç›®å½•å­˜åœ¨ä¸”å¯å†™
æµ‹è¯•æ­¥éª¤: 
  1. è°ƒç”¨ file_manager create "test.txt"
  2. æ£€æŸ¥è¿”å›ä¿¡æ¯
  3. éªŒè¯æ–‡ä»¶æ˜¯å¦åˆ›å»º
æœŸæœ›ç»“æœ: 
  - è¿”å›æˆåŠŸä¿¡æ¯
  - æ–‡ä»¶è¢«æˆåŠŸåˆ›å»º
æµ‹è¯•ä¼˜å…ˆçº§: é«˜
```

---

## 4. ğŸ¯ è¾¹ç•Œæ¡ä»¶æµ‹è¯•


### 4.1 ä»€ä¹ˆæ˜¯è¾¹ç•Œæ¡ä»¶


**è¾¹ç•Œæ¡ä»¶**æ˜¯æŒ‡ç¨‹åºåœ¨å¤„ç†è¾“å…¥æ—¶çš„ä¸´ç•Œæƒ…å†µï¼Œæ¯”å¦‚æœ€å¤§å€¼ã€æœ€å°å€¼ã€ç©ºå€¼ç­‰ã€‚è¿™äº›å¾€å¾€æ˜¯æœ€å®¹æ˜“å‡ºé”™çš„åœ°æ–¹ã€‚

> âš ï¸ **ä¸ºä»€ä¹ˆé‡è¦**ï¼šå¤§å¤šæ•°ç¨‹åºé”™è¯¯éƒ½å‘ç”Ÿåœ¨è¾¹ç•Œæ¡ä»¶ä¸Š

### 4.2 å¸¸è§è¾¹ç•Œæ¡ä»¶ç±»å‹


**æ•°å€¼è¾¹ç•Œæ¡ä»¶**ï¼š

```
ç±»å‹              è¾¹ç•Œå€¼ç¤ºä¾‹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ•´æ•°èŒƒå›´          0, -1, 1, æœ€å¤§æ•´æ•°
å­—ç¬¦ä¸²é•¿åº¦        ç©ºå­—ç¬¦ä¸², å•å­—ç¬¦, æœ€å¤§é•¿åº¦
æ•°ç»„å¤§å°          ç©ºæ•°ç»„, å•å…ƒç´ , æ»¡å®¹é‡
æ–‡ä»¶å¤§å°          ç©ºæ–‡ä»¶, å•å­—èŠ‚, æœ€å¤§æ–‡ä»¶
```

### 4.3 æ•°å€¼è¾¹ç•Œæµ‹è¯•ç¤ºä¾‹


**è¢«æµ‹è¯•å‡½æ•°**ï¼š

```bash
#!/bin/bash
# å¹´é¾„éªŒè¯å‡½æ•°

validate_age() {
    local age="$1"
    
    # æ£€æŸ¥æ˜¯å¦ä¸ºæ•°å­—
    if [[ ! "$age" =~ ^[0-9]+$ ]]; then
        echo "Error: å¹´é¾„å¿…é¡»æ˜¯æ•°å­—" >&2
        return 1
    fi
    
    # å¹´é¾„èŒƒå›´æ£€æŸ¥
    if [[ $age -lt 0 ]]; then
        echo "Error: å¹´é¾„ä¸èƒ½ä¸ºè´Ÿæ•°" >&2
        return 1
    elif [[ $age -gt 150 ]]; then
        echo "Error: å¹´é¾„ä¸èƒ½è¶…è¿‡150å²" >&2
        return 1
    elif [[ $age -eq 0 ]]; then
        echo "å©´å„¿"
    elif [[ $age -lt 18 ]]; then
        echo "æœªæˆå¹´äºº"
    elif [[ $age -lt 65 ]]; then
        echo "æˆå¹´äºº"
    else
        echo "è€å¹´äºº"
    fi
}
```

**è¾¹ç•Œæµ‹è¯•ç”¨ä¾‹**ï¼š

```bash
#!/bin/bash
# å¹´é¾„éªŒè¯è¾¹ç•Œæµ‹è¯•

source ./validate_age.sh
source ./test_framework.sh

# è¾¹ç•Œå€¼æµ‹è¯•
test_age_boundaries() {
    echo "ğŸ¯ è¾¹ç•Œæ¡ä»¶æµ‹è¯•"
    
    # æµ‹è¯•è´Ÿæ•°è¾¹ç•Œ
    validate_age "-1" 2>/dev/null
    assert_equal "1" "$?" "è´Ÿæ•°è¾¹ç•Œæµ‹è¯•"
    
    # æµ‹è¯•é›¶å€¼è¾¹ç•Œ
    result=$(validate_age "0")
    assert_equal "å©´å„¿" "$result" "é›¶å€¼è¾¹ç•Œæµ‹è¯•"
    
    # æµ‹è¯•æˆå¹´ä¸´ç•Œå€¼
    result=$(validate_age "17")
    assert_equal "æœªæˆå¹´äºº" "$result" "17å²è¾¹ç•Œæµ‹è¯•"
    
    result=$(validate_age "18")
    assert_equal "æˆå¹´äºº" "$result" "18å²è¾¹ç•Œæµ‹è¯•"
    
    # æµ‹è¯•è€å¹´ä¸´ç•Œå€¼
    result=$(validate_age "64")
    assert_equal "æˆå¹´äºº" "$result" "64å²è¾¹ç•Œæµ‹è¯•"
    
    result=$(validate_age "65")
    assert_equal "è€å¹´äºº" "$result" "65å²è¾¹ç•Œæµ‹è¯•"
    
    # æµ‹è¯•æœ€å¤§å€¼è¾¹ç•Œ
    result=$(validate_age "150")
    assert_equal "è€å¹´äºº" "$result" "150å²è¾¹ç•Œæµ‹è¯•"
    
    validate_age "151" 2>/dev/null
    assert_equal "1" "$?" "è¶…é™è¾¹ç•Œæµ‹è¯•"
}

# ç‰¹æ®Šè¾“å…¥æµ‹è¯•
test_special_inputs() {
    echo "ğŸ” ç‰¹æ®Šè¾“å…¥æµ‹è¯•"
    
    # ç©ºè¾“å…¥
    validate_age "" 2>/dev/null
    assert_equal "1" "$?" "ç©ºè¾“å…¥æµ‹è¯•"
    
    # éæ•°å­—è¾“å…¥
    validate_age "abc" 2>/dev/null
    assert_equal "1" "$?" "éæ•°å­—è¾“å…¥æµ‹è¯•"
    
    # åŒ…å«å­—æ¯çš„æ•°å­—
    validate_age "18a" 2>/dev/null
    assert_equal "1" "$?" "æ··åˆè¾“å…¥æµ‹è¯•"
}

main() {
    echo "ğŸ§ª å¼€å§‹è¾¹ç•Œæ¡ä»¶æµ‹è¯•"
    test_age_boundaries
    test_special_inputs
    test_report
}

main "$@"
```

### 4.4 æ–‡ä»¶æ“ä½œè¾¹ç•Œæµ‹è¯•


**æ–‡ä»¶è¾¹ç•Œæµ‹è¯•åœºæ™¯**ï¼š

```bash
#!/bin/bash
# æ–‡ä»¶æ“ä½œè¾¹ç•Œæµ‹è¯•

test_file_boundaries() {
    local test_dir="/tmp/boundary_test_$$"
    mkdir -p "$test_dir"
    cd "$test_dir"
    
    echo "ğŸ“ æ–‡ä»¶è¾¹ç•Œæ¡ä»¶æµ‹è¯•"
    
    # æµ‹è¯•ç©ºæ–‡ä»¶
    touch empty_file
    file_size=$(wc -c < empty_file)
    assert_equal "0" "$file_size" "ç©ºæ–‡ä»¶æµ‹è¯•"
    
    # æµ‹è¯•å•å­—ç¬¦æ–‡ä»¶
    echo -n "A" > single_char_file
    file_size=$(wc -c < single_char_file)
    assert_equal "1" "$file_size" "å•å­—ç¬¦æ–‡ä»¶æµ‹è¯•"
    
    # æµ‹è¯•é•¿æ–‡ä»¶åï¼ˆé€šå¸¸é™åˆ¶255å­—ç¬¦ï¼‰
    long_name=$(printf 'a%.0s' {1..250})
    touch "$long_name" 2>/dev/null
    assert_equal "0" "$?" "é•¿æ–‡ä»¶åæµ‹è¯•"
    
    # æµ‹è¯•ç‰¹æ®Šå­—ç¬¦æ–‡ä»¶å
    special_name="file with spaces & symbols!@#"
    touch "$special_name" 2>/dev/null
    assert_equal "0" "$?" "ç‰¹æ®Šå­—ç¬¦æ–‡ä»¶åæµ‹è¯•"
    
    # æ¸…ç†
    cd / && rm -rf "$test_dir"
}
```

---

## 5. ğŸš€ æ€§èƒ½æµ‹è¯•å®è·µ


### 5.1 ä»€ä¹ˆæ˜¯æ€§èƒ½æµ‹è¯•


**æ€§èƒ½æµ‹è¯•**æ˜¯è¯„ä¼°è„šæœ¬åœ¨ä¸åŒè´Ÿè½½ä¸‹çš„æ‰§è¡Œæ•ˆç‡ï¼ŒåŒ…æ‹¬æ‰§è¡Œæ—¶é—´ã€èµ„æºæ¶ˆè€—ç­‰æŒ‡æ ‡ã€‚

> ğŸ“Š **å…³é”®æŒ‡æ ‡**ï¼šæ‰§è¡Œæ—¶é—´ã€å†…å­˜ä½¿ç”¨ã€CPUä½¿ç”¨ç‡ã€I/Oæ“ä½œæ¬¡æ•°

### 5.2 æ—¶é—´æ€§èƒ½æµ‹è¯•


**åŸºç¡€è®¡æ—¶æ–¹æ³•**ï¼š

```bash
#!/bin/bash
# æ€§èƒ½æµ‹è¯•å·¥å…·é›†

# ç²¾ç¡®è®¡æ—¶å‡½æ•°
benchmark() {
    local test_name="$1"
    local command="$2"
    local iterations="${3:-1}"
    
    echo "â±ï¸ æ€§èƒ½æµ‹è¯•: $test_name (æ‰§è¡Œ $iterations æ¬¡)"
    
    local start_time=$(date +%s.%N)
    
    for ((i=1; i<=iterations; i++)); do
        eval "$command" >/dev/null 2>&1
    done
    
    local end_time=$(date +%s.%N)
    local duration=$(echo "$end_time - $start_time" | bc)
    local avg_time=$(echo "scale=6; $duration / $iterations" | bc)
    
    printf "æ€»è€—æ—¶: %.6f ç§’\n" "$duration"
    printf "å¹³å‡è€—æ—¶: %.6f ç§’\n" "$avg_time"
    echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
}
```

**å®é™…æ€§èƒ½æµ‹è¯•ç¤ºä¾‹**ï¼š

```bash
#!/bin/bash
# æ–‡ä»¶å¤„ç†æ€§èƒ½æµ‹è¯•

source ./performance_tools.sh

# åˆ›å»ºæµ‹è¯•æ•°æ®
create_test_data() {
    local size="$1"
    echo "ğŸ“ åˆ›å»º $size è¡Œæµ‹è¯•æ•°æ®..."
    
    seq 1 "$size" | awk '{print "line_" $1 "_" rand()}' > test_data.txt
}

# æµ‹è¯•ä¸åŒçš„æ–‡ä»¶å¤„ç†æ–¹æ³•
test_file_processing() {
    echo "ğŸ”¬ æ–‡ä»¶å¤„ç†æ€§èƒ½å¯¹æ¯”æµ‹è¯•"
    
    # åˆ›å»ºæµ‹è¯•æ•°æ®
    create_test_data 10000
    
    # æ–¹æ³•1ï¼šä½¿ç”¨whileå¾ªç¯è¯»å–
    method1() {
        local count=0
        while IFS= read -r line; do
            ((count++))
        done < test_data.txt
        echo "$count"
    }
    
    # æ–¹æ³•2ï¼šä½¿ç”¨wcå‘½ä»¤
    method2() {
        wc -l < test_data.txt
    }
    
    # æ–¹æ³•3ï¼šä½¿ç”¨awk
    method3() {
        awk 'END{print NR}' test_data.txt
    }
    
    # æ€§èƒ½å¯¹æ¯”
    benchmark "Whileå¾ªç¯è¯»å–" "method1" 5
    benchmark "WCå‘½ä»¤è®¡æ•°" "method2" 5  
    benchmark "AWKç»Ÿè®¡" "method3" 5
    
    # æ¸…ç†æµ‹è¯•æ•°æ®
    rm -f test_data.txt
}
```

### 5.3 å†…å­˜å’Œèµ„æºç›‘æ§


**èµ„æºç›‘æ§è„šæœ¬**ï¼š

```bash
#!/bin/bash
# èµ„æºä½¿ç”¨ç›‘æ§

monitor_resources() {
    local script_to_monitor="$1"
    local output_file="resource_usage.log"
    
    echo "ğŸ“Š å¼€å§‹ç›‘æ§èµ„æºä½¿ç”¨æƒ…å†µ"
    echo "æ—¶é—´,CPU%,å†…å­˜MB,è¿›ç¨‹æ•°" > "$output_file"
    
    # åå°è¿è¡Œè¢«ç›‘æ§è„šæœ¬
    bash "$script_to_monitor" &
    local pid=$!
    
    # ç›‘æ§èµ„æºä½¿ç”¨
    while kill -0 $pid 2>/dev/null; do
        local timestamp=$(date '+%H:%M:%S')
        local cpu_usage=$(ps -p $pid -o %cpu --no-headers 2>/dev/null || echo "0")
        local mem_usage=$(ps -p $pid -o rss --no-headers 2>/dev/null || echo "0")
        local mem_mb=$((mem_usage / 1024))
        local proc_count=$(pgrep -P $pid | wc -l)
        
        echo "$timestamp,$cpu_usage,$mem_mb,$proc_count" >> "$output_file"
        sleep 1
    done
    
    echo "ğŸ“ˆ èµ„æºç›‘æ§å®Œæˆï¼Œç»“æœä¿å­˜åˆ° $output_file"
}
```

### 5.4 æ€§èƒ½åŸºå‡†æµ‹è¯•


**ç³»ç»Ÿæ€§èƒ½åŸºå‡†**ï¼š

```bash
#!/bin/bash
# ç³»ç»Ÿæ€§èƒ½åŸºå‡†æµ‹è¯•

performance_benchmark() {
    echo "ğŸ Shellè„šæœ¬æ€§èƒ½åŸºå‡†æµ‹è¯•"
    
    # CPUå¯†é›†å‹æµ‹è¯•
    cpu_intensive_test() {
        local result=0
        for ((i=1; i<=100000; i++)); do
            result=$((result + i))
        done
        echo $result
    }
    
    # I/Oå¯†é›†å‹æµ‹è¯•  
    io_intensive_test() {
        local temp_file="/tmp/io_test_$$"
        for ((i=1; i<=1000; i++)); do
            echo "æµ‹è¯•æ•°æ®è¡Œ $i" >> "$temp_file"
        done
        wc -l < "$temp_file"
        rm -f "$temp_file"
    }
    
    # å†…å­˜åˆ†é…æµ‹è¯•
    memory_test() {
        local big_array=()
        for ((i=1; i<=10000; i++)); do
            big_array[$i]="æ•°æ®é¡¹_$i"
        done
        echo ${#big_array[@]}
    }
    
    # æ‰§è¡ŒåŸºå‡†æµ‹è¯•
    benchmark "CPUå¯†é›†å‹æ“ä½œ" "cpu_intensive_test" 3
    benchmark "I/Oå¯†é›†å‹æ“ä½œ" "io_intensive_test" 3  
    benchmark "å†…å­˜åˆ†é…æ“ä½œ" "memory_test" 3
}
```

---

## 6. ğŸ”„ è‡ªåŠ¨åŒ–æµ‹è¯•æµç¨‹


### 6.1 è‡ªåŠ¨åŒ–æµ‹è¯•çš„ä»·å€¼


**è‡ªåŠ¨åŒ–æµ‹è¯•**è®©æˆ‘ä»¬èƒ½å¤Ÿå¿«é€Ÿã€ä¸€è‡´åœ°æ‰§è¡Œæ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ï¼ŒåŠæ—¶å‘ç°é—®é¢˜ã€‚å°±åƒå·¥å‚çš„è´¨æ£€æµæ°´çº¿ä¸€æ ·ã€‚

> ğŸ¯ **æ ¸å¿ƒä¼˜åŠ¿**ï¼šæé«˜æ•ˆç‡ã€å‡å°‘äººä¸ºé”™è¯¯ã€æ”¯æŒæŒç»­é›†æˆ

### 6.2 æµ‹è¯•è‡ªåŠ¨åŒ–æ¶æ„


**æµ‹è¯•æµç¨‹å›¾**ï¼š
```
ä»£ç æäº¤ â†’ è‡ªåŠ¨è§¦å‘ â†’ è¯­æ³•æ£€æŸ¥ â†’ å•å…ƒæµ‹è¯• â†’ é›†æˆæµ‹è¯• â†’ æŠ¥å‘Šç”Ÿæˆ
    â†‘                                                         â†“
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å‘ç°é—®é¢˜ï¼Œä¿®å¤åé‡æ–°æäº¤ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬


**å®Œæ•´çš„è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬**ï¼š

```bash
#!/bin/bash
# è‡ªåŠ¨åŒ–æµ‹è¯•ä¸»æ§è„šæœ¬

# é…ç½®å˜é‡
PROJECT_ROOT=$(dirname "$0")
TEST_DIR="$PROJECT_ROOT/tests"
REPORT_DIR="$PROJECT_ROOT/reports"
LOG_FILE="$REPORT_DIR/test_$(date +%Y%m%d_%H%M%S).log"

# åˆ›å»ºæŠ¥å‘Šç›®å½•
mkdir -p "$REPORT_DIR"

# æ—¥å¿—è®°å½•å‡½æ•°
log() {
    local level="$1"
    local message="$2"
    local timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    echo "[$timestamp] [$level] $message" | tee -a "$LOG_FILE"
}

# æ‰§è¡Œè¯­æ³•æ£€æŸ¥
run_syntax_check() {
    log "INFO" "ğŸ” å¼€å§‹è¯­æ³•æ£€æŸ¥..."
    local error_count=0
    
    for script in "$PROJECT_ROOT"/*.sh; do
        if [[ -f "$script" ]]; then
            if ! bash -n "$script" 2>/dev/null; then
                log "ERROR" "è¯­æ³•é”™è¯¯: $script"
                bash -n "$script" 2>&1 | tee -a "$LOG_FILE"
                ((error_count++))
            else
                log "INFO" "è¯­æ³•æ£€æŸ¥é€šè¿‡: $script"
            fi
        fi
    done
    
    if [[ $error_count -eq 0 ]]; then
        log "INFO" "âœ… æ‰€æœ‰è„šæœ¬è¯­æ³•æ£€æŸ¥é€šè¿‡"
        return 0
    else
        log "ERROR" "âŒ å‘ç° $error_count ä¸ªè¯­æ³•é”™è¯¯"
        return 1
    fi
}

# æ‰§è¡Œå•å…ƒæµ‹è¯•
run_unit_tests() {
    log "INFO" "ğŸ§ª å¼€å§‹å•å…ƒæµ‹è¯•..."
    local total_tests=0
    local passed_tests=0
    local failed_tests=0
    
    if [[ -d "$TEST_DIR" ]]; then
        for test_file in "$TEST_DIR"/test_*.sh; do
            if [[ -f "$test_file" ]]; then
                log "INFO" "æ‰§è¡Œæµ‹è¯•: $test_file"
                if bash "$test_file" >> "$LOG_FILE" 2>&1; then
                    log "INFO" "âœ… æµ‹è¯•é€šè¿‡: $test_file"
                    ((passed_tests++))
                else
                    log "ERROR" "âŒ æµ‹è¯•å¤±è´¥: $test_file"
                    ((failed_tests++))
                fi
                ((total_tests++))
            fi
        done
    fi
    
    log "INFO" "å•å…ƒæµ‹è¯•å®Œæˆ - æ€»è®¡:$total_tests é€šè¿‡:$passed_tests å¤±è´¥:$failed_tests"
    return $failed_tests
}

# æ‰§è¡Œæ€§èƒ½æµ‹è¯•
run_performance_tests() {
    log "INFO" "ğŸš€ å¼€å§‹æ€§èƒ½æµ‹è¯•..."
    
    if [[ -f "$PROJECT_ROOT/performance_test.sh" ]]; then
        log "INFO" "æ‰§è¡Œæ€§èƒ½æµ‹è¯•å¥—ä»¶"
        bash "$PROJECT_ROOT/performance_test.sh" >> "$LOG_FILE" 2>&1
        log "INFO" "æ€§èƒ½æµ‹è¯•å®Œæˆ"
    else
        log "WARN" "æœªæ‰¾åˆ°æ€§èƒ½æµ‹è¯•è„šæœ¬ï¼Œè·³è¿‡æ€§èƒ½æµ‹è¯•"
    fi
}

# ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
generate_report() {
    local syntax_result=$1
    local unit_result=$2
    local report_file="$REPORT_DIR/test_report_$(date +%Y%m%d_%H%M%S).html"
    
    log "INFO" "ğŸ“Š ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š: $report_file"
    
    cat > "$report_file" << EOF
<!DOCTYPE html>
<html>
<head>
    <title>Shellè„šæœ¬æµ‹è¯•æŠ¥å‘Š</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { color: #333; border-bottom: 2px solid #ddd; }
        .pass { color: green; font-weight: bold; }
        .fail { color: red; font-weight: bold; }
        .section { margin: 20px 0; padding: 10px; background: #f5f5f5; }
        pre { background: #eee; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ§ª Shellè„šæœ¬è‡ªåŠ¨åŒ–æµ‹è¯•æŠ¥å‘Š</h1>
        <p>ç”Ÿæˆæ—¶é—´: $(date)</p>
    </div>
    
    <div class="section">
        <h2>ğŸ“‹ æµ‹è¯•æ¦‚è§ˆ</h2>
        <p>è¯­æ³•æ£€æŸ¥: $([ $syntax_result -eq 0 ] && echo '<span class="pass">PASS</span>' || echo '<span class="fail">FAIL</span>')</p>
        <p>å•å…ƒæµ‹è¯•: $([ $unit_result -eq 0 ] && echo '<span class="pass">PASS</span>' || echo '<span class="fail">FAIL</span>')</p>
    </div>
    
    <div class="section">
        <h2>ğŸ“„ è¯¦ç»†æ—¥å¿—</h2>
        <pre>$(cat "$LOG_FILE")</pre>
    </div>
</body>
</html>
EOF
    
    log "INFO" "âœ… æµ‹è¯•æŠ¥å‘Šç”Ÿæˆå®Œæˆ"
}

# ä¸»å‡½æ•°
main() {
    log "INFO" "ğŸš€ å¼€å§‹è‡ªåŠ¨åŒ–æµ‹è¯•æµç¨‹"
    
    # æ‰§è¡Œå„é¡¹æµ‹è¯•
    run_syntax_check
    local syntax_result=$?
    
    run_unit_tests  
    local unit_result=$?
    
    run_performance_tests
    
    # ç”ŸæˆæŠ¥å‘Š
    generate_report $syntax_result $unit_result
    
    # è¿”å›æ€»ä½“ç»“æœ
    local total_errors=$((syntax_result + unit_result))
    
    if [[ $total_errors -eq 0 ]]; then
        log "INFO" "ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼"
        return 0
    else
        log "ERROR" "âš ï¸ æµ‹è¯•å‘ç° $total_errors ä¸ªé—®é¢˜"
        return 1
    fi
}

# æ‰§è¡Œä¸»å‡½æ•°
main "$@"
```

---

## 7. ğŸ› ï¸ æµ‹è¯•æ¡†æ¶åº”ç”¨


### 7.1 æµè¡Œçš„Shellæµ‹è¯•æ¡†æ¶


**ä¸»æµæµ‹è¯•æ¡†æ¶å¯¹æ¯”**ï¼š

```
æ¡†æ¶åç§°      ç‰¹ç‚¹                    é€‚ç”¨åœºæ™¯
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Bats          ç®€å•æ˜“ç”¨ï¼Œç±»ä¼¼RSpec     å•å…ƒæµ‹è¯•
shUnit2       xUnité£æ ¼ï¼ŒåŠŸèƒ½å…¨é¢     ä¼ä¸šçº§æµ‹è¯•
Roundup       æç®€è®¾è®¡                å¿«é€Ÿæµ‹è¯•
ShellSpec     BDDé£æ ¼ï¼Œç°ä»£åŒ–         è¡Œä¸ºé©±åŠ¨å¼€å‘
```

### 7.2 Batsæµ‹è¯•æ¡†æ¶å®è·µ


**Batså®‰è£…å’ŒåŸºæœ¬ä½¿ç”¨**ï¼š

```bash
# å®‰è£…Batsï¼ˆä»¥Ubuntuä¸ºä¾‹ï¼‰
sudo apt install bats

# æˆ–è€…ä»GitHubå®‰è£…æœ€æ–°ç‰ˆ
git clone https://github.com/bats-core/bats-core.git
cd bats-core
sudo ./install.sh /usr/local
```

**Batsæµ‹è¯•ç¤ºä¾‹**ï¼š

```bash
#!/usr/bin/env bats
# calculator_test.bats

# è®¾ç½®å’Œæ¸…ç†
setup() {
    # æ¯ä¸ªæµ‹è¯•å‰æ‰§è¡Œ
    load 'test_helper'
    export CALCULATOR_SCRIPT="$BATS_TEST_DIRNAME/../calculator.sh"
}

teardown() {
    # æ¯ä¸ªæµ‹è¯•åæ‰§è¡Œ
    unset CALCULATOR_SCRIPT
}

# æµ‹è¯•ç”¨ä¾‹
@test "åŠ æ³•è®¡ç®—æ­£ç¡®" {
    result="$(bash $CALCULATOR_SCRIPT add 5 3)"
    [ "$result" = "8" ]
}

@test "å‡æ³•è®¡ç®—æ­£ç¡®" {  
    result="$(bash $CALCULATOR_SCRIPT sub 10 4)"
    [ "$result" = "6" ]
}

@test "é™¤é›¶é”™è¯¯å¤„ç†" {
    run bash $CALCULATOR_SCRIPT div 5 0
    [ "$status" -eq 1 ]
    [[ "$output" == *"Division by zero"* ]]
}

@test "æ— æ•ˆæ“ä½œé”™è¯¯å¤„ç†" {
    run bash $CALCULATOR_SCRIPT invalid 1 2  
    [ "$status" -eq 1 ]
    [[ "$output" == *"Unknown operation"* ]]
}
```

**è¿è¡ŒBatsæµ‹è¯•**ï¼š

```bash
# è¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶
bats calculator_test.bats

# è¿è¡Œç›®å½•ä¸‹æ‰€æœ‰æµ‹è¯•
bats tests/

# è¯¦ç»†è¾“å‡º
bats --verbose calculator_test.bats

# è¾“å‡ºæ ¼å¼åŒ–
bats --formatter junit calculator_test.bats > test_results.xml
```

### 7.3 shUnit2æ¡†æ¶åº”ç”¨


**shUnit2æµ‹è¯•ç¤ºä¾‹**ï¼š

```bash
#!/bin/bash
# shunit2_test.sh

# åŠ è½½è¢«æµ‹è¯•çš„è„šæœ¬
source ./calculator.sh

# æµ‹è¯•ç”¨ä¾‹å‡½æ•°
testAddition() {
    result=$(calculator add 5 3)
    assertEquals "åŠ æ³•æµ‹è¯•å¤±è´¥" "8" "$result"
}

testSubtraction() {
    result=$(calculator sub 10 4)  
    assertEquals "å‡æ³•æµ‹è¯•å¤±è´¥" "6" "$result"
}

testDivisionByZero() {
    calculator div 5 0 2>/dev/null
    assertNotEquals "é™¤é›¶åº”è¯¥è¿”å›é”™è¯¯" "0" "$?"
}

# è®¾ç½®å’Œæ¸…ç†å‡½æ•°
setUp() {
    # æ¯ä¸ªæµ‹è¯•å‰æ‰§è¡Œ
    echo "å‡†å¤‡æµ‹è¯•ç¯å¢ƒ"
}

tearDown() {
    # æ¯ä¸ªæµ‹è¯•åæ‰§è¡Œ  
    echo "æ¸…ç†æµ‹è¯•ç¯å¢ƒ"
}

# åŠ è½½shUnit2æ¡†æ¶
source /usr/share/shunit2/shunit2
```

---

## 8. ğŸ”„ æŒç»­é›†æˆå®è·µ


### 8.1 ä»€ä¹ˆæ˜¯æŒç»­é›†æˆ


**æŒç»­é›†æˆï¼ˆCIï¼‰**æ˜¯ä¸€ç§å¼€å‘å®è·µï¼Œå¼€å‘è€…é¢‘ç¹åœ°å°†ä»£ç é›†æˆåˆ°ä¸»åˆ†æ”¯ï¼Œæ¯æ¬¡é›†æˆéƒ½é€šè¿‡è‡ªåŠ¨åŒ–æµ‹è¯•éªŒè¯ã€‚

> ğŸ”„ **æ ¸å¿ƒç†å¿µ**ï¼šæ—©å‘ç°ã€æ—©ä¿®å¤ã€å¿«é€Ÿåé¦ˆ

### 8.2 CIæµç¨‹è®¾è®¡


**å…¸å‹CIæµç¨‹**ï¼š
```
ä»£ç æäº¤ â†’ è§¦å‘CI â†’ ç¯å¢ƒå‡†å¤‡ â†’ æµ‹è¯•æ‰§è¡Œ â†’ ç»“æœé€šçŸ¥ â†’ éƒ¨ç½²å†³ç­–
    â†‘                                              â†“
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æµ‹è¯•å¤±è´¥ï¼Œé˜»æ­¢åˆå¹¶ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.3 GitHub Actionsé…ç½®


**GitHub Actionså·¥ä½œæµé…ç½®**ï¼š

```yaml
# .github/workflows/shell-test.yml
name: Shell Scripts CI

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ æ£€å‡ºä»£ç 
      uses: actions/checkout@v3
      
    - name: ğŸ”§ è®¾ç½®æµ‹è¯•ç¯å¢ƒ
      run: |
        sudo apt-get update
        sudo apt-get install -y bats shellcheck
        
    - name: ğŸ” è¯­æ³•æ£€æŸ¥
      run: |
        echo "æ‰§è¡Œè¯­æ³•æ£€æŸ¥..."
        find . -name "*.sh" -exec bash -n {} \;
        
    - name: ğŸ“Š é™æ€åˆ†æ
      run: |
        echo "æ‰§è¡ŒShellChecké™æ€åˆ†æ..."
        find . -name "*.sh" -exec shellcheck {} \;
        
    - name: ğŸ§ª å•å…ƒæµ‹è¯•
      run: |
        echo "æ‰§è¡Œå•å…ƒæµ‹è¯•..."
        if [ -d "tests" ]; then
          bats tests/
        fi
        
    - name: ğŸš€ æ€§èƒ½æµ‹è¯•
      run: |
        echo "æ‰§è¡Œæ€§èƒ½æµ‹è¯•..."
        if [ -f "performance_test.sh" ]; then
          bash performance_test.sh
        fi
        
    - name: ğŸ“‹ ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
      if: always()
      run: |
        echo "ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š..."
        mkdir -p reports
        echo "æµ‹è¯•å®Œæˆæ—¶é—´: $(date)" > reports/summary.txt
        
    - name: ğŸ“¤ ä¸Šä¼ æµ‹è¯•æŠ¥å‘Š
      if: always()
      uses: actions/upload-artifact@v3
      with:
        name: test-reports
        path: reports/
```

### 8.4 è‡ªåŠ¨åŒ–éƒ¨ç½²é›†æˆ


**éƒ¨ç½²è„šæœ¬ç¤ºä¾‹**ï¼š

```bash
#!/bin/bash
# deploy.sh - è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬

DEPLOY_ENV="${1:-staging}"
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
LOG_FILE="/tmp/deploy_$(date +%Y%m%d_%H%M%S).log"

# æ—¥å¿—è®°å½•
log() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $*" | tee -a "$LOG_FILE"
}

# é¢„éƒ¨ç½²æ£€æŸ¥
pre_deploy_check() {
    log "ğŸ“‹ å¼€å§‹é¢„éƒ¨ç½²æ£€æŸ¥..."
    
    # è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
    if ! bash "$SCRIPT_DIR/automated_test.sh"; then
        log "âŒ æµ‹è¯•å¤±è´¥ï¼Œåœæ­¢éƒ¨ç½²"
        return 1
    fi
    
    # æ£€æŸ¥éƒ¨ç½²ç¯å¢ƒ
    if [[ "$DEPLOY_ENV" == "production" ]]; then
        log "ğŸš¨ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ï¼Œéœ€è¦é¢å¤–ç¡®è®¤"
        read -p "ç¡®è®¤éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼Ÿ(yes/no): " confirm
        if [[ "$confirm" != "yes" ]]; then
            log "âŒ ç”¨æˆ·å–æ¶ˆéƒ¨ç½²"
            return 1
        fi
    fi
    
    log "âœ… é¢„éƒ¨ç½²æ£€æŸ¥é€šè¿‡"
    return 0
}

# æ‰§è¡Œéƒ¨ç½²
do_deploy() {
    log "ğŸš€ å¼€å§‹éƒ¨ç½²åˆ° $DEPLOY_ENV ç¯å¢ƒ..."
    
    case "$DEPLOY_ENV" in
        "staging")
            # éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ
            rsync -av --exclude='.git' . staging-server:/opt/scripts/
            ;;
        "production")  
            # éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
            rsync -av --exclude='.git' . prod-server:/opt/scripts/
            ;;
        *)
            log "âŒ æœªçŸ¥éƒ¨ç½²ç¯å¢ƒ: $DEPLOY_ENV"
            return 1
            ;;
    esac
    
    log "âœ… éƒ¨ç½²å®Œæˆ"
}

# éƒ¨ç½²åéªŒè¯
post_deploy_verify() {
    log "ğŸ” å¼€å§‹éƒ¨ç½²åéªŒè¯..."
    
    # è¿™é‡Œå¯ä»¥æ·»åŠ éƒ¨ç½²åçš„å¥åº·æ£€æŸ¥
    # æ¯”å¦‚æ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£å¸¸å¯åŠ¨ï¼Œæ¥å£æ˜¯å¦å“åº”ç­‰
    
    log "âœ… éƒ¨ç½²éªŒè¯å®Œæˆ"
}

# ä¸»å‡½æ•°
main() {
    log "ğŸš€ å¼€å§‹è‡ªåŠ¨åŒ–éƒ¨ç½²æµç¨‹"
    
    if pre_deploy_check && do_deploy && post_deploy_verify; then
        log "ğŸ‰ éƒ¨ç½²æˆåŠŸå®Œæˆ"
        return 0
    else
        log "ğŸ’¥ éƒ¨ç½²è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯"
        return 1
    fi
}

main "$@"
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æµ‹è¯•æ¦‚å¿µ


```
ğŸ”¸ è¯­æ³•æ£€æŸ¥ï¼šä½¿ç”¨ bash -n åœ¨æ‰§è¡Œå‰å‘ç°è¯­æ³•é”™è¯¯
ğŸ”¸ å•å…ƒæµ‹è¯•ï¼šé’ˆå¯¹å‡½æ•°å’Œæ¨¡å—çš„ç‹¬ç«‹æµ‹è¯•
ğŸ”¸ è¾¹ç•Œæµ‹è¯•ï¼šéªŒè¯æç«¯æ¡ä»¶å’Œä¸´ç•Œå€¼å¤„ç†
ğŸ”¸ æ€§èƒ½æµ‹è¯•ï¼šè¯„ä¼°è„šæœ¬æ‰§è¡Œæ•ˆç‡å’Œèµ„æºä½¿ç”¨
ğŸ”¸ è‡ªåŠ¨åŒ–æµ‹è¯•ï¼šæ„å»ºå¯é‡å¤æ‰§è¡Œçš„æµ‹è¯•æµç¨‹
ğŸ”¸ æŒç»­é›†æˆï¼šå°†æµ‹è¯•é›†æˆåˆ°å¼€å‘å·¥ä½œæµä¸­
```

### 9.2 æµ‹è¯•æœ€ä½³å®è·µ


> ğŸ’¡ **æ ¸å¿ƒåŸåˆ™**ï¼šæµ‹è¯•é©±åŠ¨å¼€å‘ï¼Œå…ˆå†™æµ‹è¯•å†å†™ä»£ç 

**æµ‹è¯•è¦†ç›–ç­–ç•¥**ï¼š
```
æ­£å¸¸è·¯å¾„æµ‹è¯•     å¼‚å¸¸è·¯å¾„æµ‹è¯•     è¾¹ç•Œæ¡ä»¶æµ‹è¯•
      â†“              â†“              â†“
   åŸºæœ¬åŠŸèƒ½      é”™è¯¯å¤„ç†      æç«¯æƒ…å†µ
   æ ‡å‡†è¾“å…¥      æ— æ•ˆè¾“å…¥      ç©ºå€¼/æœ€å€¼
   é¢„æœŸç»“æœ      å¼‚å¸¸å¤„ç†      è¾¹ç•Œè¡Œä¸º
```

### 9.3 å®ç”¨æµ‹è¯•æ£€æŸ¥æ¸…å•


**æµ‹è¯•å‰æ£€æŸ¥**ï¼š
- âœ… è¯­æ³•æ£€æŸ¥é€šè¿‡
- âœ… æµ‹è¯•ç¯å¢ƒå‡†å¤‡å°±ç»ª  
- âœ… æµ‹è¯•æ•°æ®å·²å‡†å¤‡
- âœ… é¢„æœŸç»“æœæ˜ç¡®å®šä¹‰

**æµ‹è¯•æ‰§è¡Œ**ï¼š
- âœ… æ­£å¸¸åŠŸèƒ½æµ‹è¯•
- âœ… å¼‚å¸¸æƒ…å†µå¤„ç†
- âœ… è¾¹ç•Œæ¡ä»¶éªŒè¯
- âœ… æ€§èƒ½æŒ‡æ ‡æµ‹é‡

**æµ‹è¯•åéªŒè¯**ï¼š
- âœ… æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹æ‰§è¡Œ
- âœ… æµ‹è¯•ç»“æœè®°å½•å®Œæ•´
- âœ… å¤±è´¥åŸå› åˆ†ææ¸…æ¥š
- âœ… ä¿®å¤æªæ–½æ˜ç¡®å¯è¡Œ

### 9.4 å¸¸è§æµ‹è¯•é™·é˜±


> âš ï¸ **é¿å…è¿™äº›å¸¸è§é”™è¯¯**

**æµ‹è¯•è®¾è®¡é™·é˜±**ï¼š
- âŒ åªæµ‹è¯•æ­£å¸¸æƒ…å†µï¼Œå¿½ç•¥å¼‚å¸¸å¤„ç†
- âŒ æµ‹è¯•ç”¨ä¾‹è¦†ç›–ä¸å…¨é¢
- âŒ æµ‹è¯•æ•°æ®ä¸å¤ŸçœŸå®
- âŒ å¿½ç•¥ç¯å¢ƒå·®å¼‚å½±å“

**è‡ªåŠ¨åŒ–é™·é˜±**ï¼š
- âŒ è¿‡åº¦ä¾èµ–è‡ªåŠ¨åŒ–ï¼Œå¿½ç•¥æ‰‹å·¥æµ‹è¯•
- âŒ æµ‹è¯•è„šæœ¬æœ¬èº«æœ‰bug
- âŒ æµ‹è¯•ç¯å¢ƒä¸ç”Ÿäº§ç¯å¢ƒå·®å¼‚å¤ªå¤§
- âŒ æµ‹è¯•ç»“æœè§£è¯»é”™è¯¯

### 9.5 è¿›é˜¶å­¦ä¹ å»ºè®®


**å­¦ä¹ è·¯å¾„**ï¼š
```
åŸºç¡€è¯­æ³•æ£€æŸ¥ â†’ å•å…ƒæµ‹è¯• â†’ é›†æˆæµ‹è¯• â†’ æ€§èƒ½æµ‹è¯• â†’ è‡ªåŠ¨åŒ–CI/CD
      â†“           â†“          â†“          â†“           â†“
   æŒæ¡å·¥å…·    æµ‹è¯•æ€ç»´    ç³»ç»Ÿæ€ç»´    æ€§èƒ½æ„è¯†    å·¥ç¨‹åŒ–æ€ç»´
```

**æ¨èå®è·µé¡¹ç›®**ï¼š
- ğŸ¯ ä¸ºç°æœ‰è„šæœ¬æ·»åŠ å®Œæ•´æµ‹è¯•å¥—ä»¶
- ğŸ”§ æ­å»ºæœ¬åœ°CI/CDæµ‹è¯•ç¯å¢ƒ  
- ğŸ“Š å¼€å‘æ€§èƒ½ç›‘æ§å’ŒæŠ¥è­¦ç³»ç»Ÿ
- ğŸš€ é›†æˆæµ‹è¯•åˆ°å›¢é˜Ÿå¼€å‘æµç¨‹

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- æµ‹è¯•æ˜¯è´¨é‡ä¿è¯çš„åŸºç¡€ï¼Œä¸æ˜¯å¯æœ‰å¯æ— çš„è£…é¥°
- å¥½çš„æµ‹è¯•åº”è¯¥å¿«é€Ÿã€å¯é ã€æ˜“ç»´æŠ¤
- è‡ªåŠ¨åŒ–æµ‹è¯•é‡Šæ”¾äººåŠ›ï¼Œä½†ä¸èƒ½å®Œå…¨æ›¿ä»£äººå·¥åˆ¤æ–­
- æŒç»­é›†æˆè®©é—®é¢˜æ—©æš´éœ²ã€æ—©è§£å†³
- æµ‹è¯•ä¸ä»…éªŒè¯åŠŸèƒ½ï¼Œæ›´é‡è¦çš„æ˜¯å»ºç«‹ä¿¡å¿ƒ