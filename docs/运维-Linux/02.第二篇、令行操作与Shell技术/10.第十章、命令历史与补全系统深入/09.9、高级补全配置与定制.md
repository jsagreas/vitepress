---
title: 9ã€é«˜çº§è¡¥å…¨é…ç½®ä¸å®šåˆ¶
---
## ğŸ“š ç›®å½•

1. [è¡¥å…¨ç³»ç»Ÿæ¶æ„æ¦‚è¿°](#1-è¡¥å…¨ç³»ç»Ÿæ¶æ„æ¦‚è¿°)
2. [.inputrcæ–‡ä»¶æ·±åº¦é…ç½®](#2-inputrcæ–‡ä»¶æ·±åº¦é…ç½®)
3. [readlineé…ç½®é€‰é¡¹è¯¦è§£](#3-readlineé…ç½®é€‰é¡¹è¯¦è§£)
4. [è¡¥å…¨æ˜¾ç¤ºæ ·å¼å®šåˆ¶](#4-è¡¥å…¨æ˜¾ç¤ºæ ·å¼å®šåˆ¶)
5. [è¡¥å…¨è¡Œä¸ºå¾®è°ƒå‚æ•°](#5-è¡¥å…¨è¡Œä¸ºå¾®è°ƒå‚æ•°)
6. [æ¡ä»¶è¡¥å…¨è§„åˆ™è®¾ç½®](#6-æ¡ä»¶è¡¥å…¨è§„åˆ™è®¾ç½®)
7. [åŠ¨æ€è¡¥å…¨å†…å®¹ç”Ÿæˆ](#7-åŠ¨æ€è¡¥å…¨å†…å®¹ç”Ÿæˆ)
8. [è¡¥å…¨å†²çªè§£å†³ç­–ç•¥](#8-è¡¥å…¨å†²çªè§£å†³ç­–ç•¥)
9. [è·¨Shellè¡¥å…¨å…¼å®¹æ€§](#9-è·¨Shellè¡¥å…¨å…¼å®¹æ€§)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ—ï¸ è¡¥å…¨ç³»ç»Ÿæ¶æ„æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯å‘½ä»¤è¡¥å…¨ç³»ç»Ÿ


**ç®€å•ç†è§£**ï¼šè¡¥å…¨ç³»ç»Ÿå°±åƒä½ æ‰“å­—æ—¶çš„"æ™ºèƒ½æç¤ºåŠ©æ‰‹"ï¼Œå½“ä½ è¾“å…¥ä¸€åŠå‘½ä»¤æ—¶ï¼ŒæŒ‰`Tab`é”®å°±èƒ½è‡ªåŠ¨å¸®ä½ è¡¥å…¨å‰©ä¸‹çš„å†…å®¹ã€‚

```
ç”¨æˆ·ä½“éªŒå¯¹æ¯”ï¼š

æ²¡æœ‰è¡¥å…¨ç³»ç»Ÿï¼š
$ cd /usr/local/bin/my-very-long-program-name â† éœ€è¦å…¨éƒ¨æ‰‹æ‰“

æœ‰è¡¥å…¨ç³»ç»Ÿï¼š
$ cd /usr/lo[Tab] â†’ è‡ªåŠ¨å˜æˆ $ cd /usr/local/
$ cd /usr/local/bi[Tab] â†’ è‡ªåŠ¨å˜æˆ $ cd /usr/local/bin/
$ cd /usr/local/bin/my[Tab] â†’ æ˜¾ç¤ºæ‰€æœ‰ä»¥"my"å¼€å¤´çš„é€‰é¡¹
```

### 1.2 è¡¥å…¨ç³»ç»Ÿçš„æ ¸å¿ƒç»„ä»¶


```
Linuxè¡¥å…¨ç³»ç»Ÿæ¶æ„å›¾ï¼š

ç”¨æˆ·è¾“å…¥
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Shellå‰ç«¯     â”‚ â† bashã€zshã€fishç­‰
â”‚  (æ”¶é›†ç”¨æˆ·è¾“å…¥)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Readlineåº“     â”‚ â† å¤„ç†é”®ç›˜è¾“å…¥ã€å…‰æ ‡ç§»åŠ¨
â”‚ (.inputrcé…ç½®)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¡¥å…¨è§„åˆ™å¼•æ“   â”‚ â† å†³å®šå¦‚ä½•è¡¥å…¨
â”‚ (bash-completion)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ–‡ä»¶ç³»ç»Ÿ/å‘½ä»¤  â”‚ â† å®é™…çš„æ–‡ä»¶ã€å‘½ä»¤ã€é€‰é¡¹
â”‚   (æ•°æ®æº)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å„ç»„ä»¶ä½œç”¨**ï¼š
- **Shellå‰ç«¯**ï¼šä½ ç”¨çš„å‘½ä»¤è¡Œç•Œé¢ï¼ˆbashã€zshç­‰ï¼‰
- **Readlineåº“**ï¼šè´Ÿè´£å¤„ç†ä½ çš„é”®ç›˜è¾“å…¥ï¼ŒåŒ…æ‹¬Tabé”®
- **è¡¥å…¨è§„åˆ™å¼•æ“**ï¼šå†³å®šä»€ä¹ˆæƒ…å†µä¸‹è¡¥å…¨ä»€ä¹ˆå†…å®¹
- **æ•°æ®æº**ï¼šå®é™…å­˜åœ¨çš„æ–‡ä»¶ã€å‘½ä»¤ã€é€‰é¡¹ç­‰

---

## 2. âš™ï¸ .inputrcæ–‡ä»¶æ·±åº¦é…ç½®


### 2.1 .inputrcæ–‡ä»¶æ˜¯ä»€ä¹ˆ


**é€šä¿—è§£é‡Š**ï¼š`.inputrc`å°±åƒæ˜¯ä½ é”®ç›˜çš„"ä½¿ç”¨è¯´æ˜ä¹¦"ï¼Œå‘Šè¯‰ç³»ç»Ÿå½“ä½ æŒ‰ä¸‹æŸä¸ªé”®æ—¶åº”è¯¥åšä»€ä¹ˆååº”ã€‚

```
æ–‡ä»¶ä½ç½®å’Œä¼˜å…ˆçº§ï¼š

ç³»ç»Ÿçº§é…ç½®ï¼š/etc/inputrc        â† å½±å“æ‰€æœ‰ç”¨æˆ·
ç”¨æˆ·çº§é…ç½®ï¼š~/.inputrc          â† åªå½±å“å½“å‰ç”¨æˆ·
             â†‘ ä¼˜å…ˆçº§æ›´é«˜ï¼Œä¼šè¦†ç›–ç³»ç»Ÿé…ç½®
```

### 2.2 åŸºç¡€è¯­æ³•ç»“æ„


```bash
# ~/.inputrc æ–‡ä»¶ç¤ºä¾‹

# æ³¨é‡Šç”¨#å·å¼€å¤´
# åŸºæœ¬è¯­æ³•ï¼šé”®ç»‘å®š åŠŸèƒ½

# Tabé”®è¡¥å…¨è®¾ç½®
Tab: complete

# è®©è¡¥å…¨å¿½ç•¥å¤§å°å†™
set completion-ignore-case on

# æ¡ä»¶è®¾ç½®ï¼ˆåªåœ¨bashä¸­ç”Ÿæ•ˆï¼‰
$if Bash
    # è¿™é‡Œçš„è®¾ç½®åªå¯¹bashæœ‰æ•ˆ
$endif
```

**è¯­æ³•è¦ç‚¹**ï¼š
- `#` å¼€å¤´çš„æ˜¯æ³¨é‡Š
- `é”®å: åŠŸèƒ½` æ˜¯é”®ç»‘å®šè¯­æ³•
- `set é€‰é¡¹å å€¼` æ˜¯å…¨å±€è®¾ç½®
- `$if` å¯ä»¥è®¾ç½®æ¡ä»¶æ€§é…ç½®

### 2.3 å¸¸ç”¨é”®ç»‘å®šé…ç½®


```bash
# ~/.inputrc å®ç”¨é…ç½®

# === è¡¥å…¨ç›¸å…³ ===
# Tabé”®æ™ºèƒ½è¡¥å…¨
Tab: complete
# Shift+Tab æ˜¾ç¤ºæ‰€æœ‰å¯èƒ½çš„è¡¥å…¨
"\e[Z": menu-complete

# === å†å²è®°å½• ===
# ä¸Šä¸‹ç®­å¤´æœç´¢å†å²
"\e[A": history-search-backward
"\e[B": history-search-forward

# === ç¼–è¾‘å¿«æ·é”® ===
# Ctrl+å·¦ç®­å¤´ï¼šè·³åˆ°å‰ä¸€ä¸ªå•è¯
"\e[1;5D": backward-word
# Ctrl+å³ç®­å¤´ï¼šè·³åˆ°ä¸‹ä¸€ä¸ªå•è¯
"\e[1;5C": forward-word

# === å®ç”¨åŠŸèƒ½ ===
# Alt+. æ’å…¥ä¸Šä¸€æ¡å‘½ä»¤çš„æœ€åä¸€ä¸ªå‚æ•°
"\e.": yank-last-arg
```

**æŒ‰é”®è¡¨ç¤ºæ³•è¯´æ˜**ï¼š
- `\e` ä»£è¡¨Escapeé”®ï¼ˆæˆ–Alté”®ï¼‰
- `\C-` ä»£è¡¨Ctrlé”®ï¼ˆå¦‚`\C-a`è¡¨ç¤ºCtrl+Aï¼‰
- `[A`ã€`[B`ç­‰ä»£è¡¨æ–¹å‘é”®çš„è½¬ä¹‰åºåˆ—

---

## 3. ğŸ”§ readlineé…ç½®é€‰é¡¹è¯¦è§£


### 3.1 è¡¥å…¨è¡Œä¸ºæ§åˆ¶é€‰é¡¹


```bash
# ~/.inputrc è¡¥å…¨è¡Œä¸ºé…ç½®

# === åŸºç¡€è¡¥å…¨é€‰é¡¹ ===
# å¿½ç•¥å¤§å°å†™ï¼ˆæ¨èå¼€å¯ï¼‰
set completion-ignore-case on

# æŠŠè¿å­—ç¬¦å’Œä¸‹åˆ’çº¿çœ‹ä½œç›¸åŒï¼ˆæ¨èï¼‰
set completion-map-case on

# è‡ªåŠ¨è¡¥å…¨ä¸åŒºåˆ†ä¸‹åˆ’çº¿å’Œè¿å­—ç¬¦
# ä¾‹å¦‚ï¼šmy-file å’Œ my_file ä¼šè¢«è§†ä¸ºç›¸åŒ
set completion-map-case on

# === è¡¥å…¨æ˜¾ç¤ºé€‰é¡¹ ===
# è¶…è¿‡è¿™ä¸ªæ•°é‡çš„è¡¥å…¨é€‰é¡¹æ—¶è¯¢é—®ç”¨æˆ·
set completion-query-items 200

# è¡¥å…¨æ—¶æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
set show-all-if-unmodified on

# ç«‹å³æ˜¾ç¤ºè¡¥å…¨ï¼Œä¸éœ€è¦æŒ‰ä¸¤æ¬¡Tab
set show-all-if-ambiguous on
```

### 3.2 è¡¥å…¨æ˜¾ç¤ºç¾åŒ–é€‰é¡¹


```bash
# === è§†è§‰ç¾åŒ–é…ç½® ===
# åœ¨è¡¥å…¨åˆ—è¡¨ä¸­ç»™ä¸åŒç±»å‹çš„æ–‡ä»¶æ·»åŠ é¢œè‰²
set colored-stats on

# åœ¨è¡¥å…¨é€‰é¡¹åæ˜¾ç¤ºæ–‡ä»¶ç±»å‹æ ‡è¯†ç¬¦
# ç›®å½•åé¢æ˜¾ç¤º/ï¼Œå¯æ‰§è¡Œæ–‡ä»¶åé¢æ˜¾ç¤º*ç­‰
set visible-stats on

# åœ¨è¡¥å…¨æ—¶è‡ªåŠ¨æ·»åŠ æ–‡ä»¶ç±»å‹åç¼€
# ç›®å½•è‡ªåŠ¨åŠ /ï¼Œç¬¦å·é“¾æ¥åŠ @ç­‰
set mark-directories on
set mark-symlinked-directories on

# è¡¥å…¨åˆ—è¡¨æŒ‰åˆ—æ˜¾ç¤ºï¼ˆæ›´æ•´é½ï¼‰
set print-completions-horizontally off
```

**æ•ˆæœå¯¹æ¯”**ï¼š
```
# æ²¡æœ‰ç¾åŒ–çš„è¡¥å…¨æ˜¾ç¤ºï¼š
file1 file2 directory1 script.sh

# ç¾åŒ–åçš„è¡¥å…¨æ˜¾ç¤ºï¼š
file1        file2        
directory1/  script.sh*
executable*  symlink@
```

### 3.3 ç¼–è¾‘è¡Œä¸ºé…ç½®


```bash
# === ç¼–è¾‘å¢å¼ºé…ç½® ===
# Viæ¨¡å¼ç¼–è¾‘ï¼ˆå¯é€‰ï¼Œé»˜è®¤æ˜¯emacsæ¨¡å¼ï¼‰
# set editing-mode vi

# å“é“ƒè®¾ç½®ï¼ˆå»ºè®®å…³é—­ï¼‰
set bell-style none

# å½“æ²¡æœ‰åŒ¹é…æ—¶ä¸å“é“ƒ
set match-hidden-files off

# å…è®¸8ä½å­—ç¬¦è¾“å…¥ï¼ˆæ”¯æŒä¸­æ–‡ç­‰ï¼‰
set input-meta on
set output-meta on
set convert-meta off
```

---

## 4. ğŸ¨ è¡¥å…¨æ˜¾ç¤ºæ ·å¼å®šåˆ¶


### 4.1 è¡¥å…¨èœå•æ ·å¼é…ç½®


```bash
# ~/.inputrc èœå•æ ·å¼é…ç½®

# === èœå•è¡Œä¸º ===
# å¯ç”¨èœå•å¼è¡¥å…¨ï¼ˆå¯ä»¥ç”¨æ–¹å‘é”®é€‰æ‹©ï¼‰
set menu-complete-display-prefix on

# åœ¨èœå•è¡¥å…¨æ—¶æ˜¾ç¤ºå…¬å…±å‰ç¼€
set completion-prefix-display-length 2

# === é¢œè‰²é…ç½® ===
# è®¾ç½®è¡¥å…¨æ—¶çš„é¢œè‰²æ–¹æ¡ˆ
set colored-completion-prefix on

# åŒ¹é…çš„æ–‡æœ¬é«˜äº®æ˜¾ç¤º
set completion-display-width -1
```

### 4.2 è‡ªå®šä¹‰è¡¥å…¨æ˜¾ç¤ºæ ¼å¼


```bash
# åˆ›å»ºè‡ªå®šä¹‰è¡¥å…¨å‡½æ•°
# ~/.bashrc ä¸­æ·»åŠ ï¼š

# è‡ªå®šä¹‰lså‘½ä»¤çš„è¡¥å…¨æ˜¾ç¤º
_custom_ls_complete() {
    local cur="${COMP_WORDS[COMP_CWORD]}"
    
    # è·å–å½“å‰ç›®å½•çš„æ–‡ä»¶åˆ—è¡¨
    COMPREPLY=($(compgen -f -- "$cur"))
    
    # ä¸ºæ¯ä¸ªæ–‡ä»¶æ·»åŠ è¯¦ç»†ä¿¡æ¯
    local i=0
    for file in "${COMPREPLY[@]}"; do
        if [[ -d "$file" ]]; then
            COMPREPLY[i]="$file/"
        elif [[ -x "$file" ]]; then
            COMPREPLY[i]="$file*"
        fi
        ((i++))
    done
}

# ç»‘å®šåˆ°lså‘½ä»¤
complete -F _custom_ls_complete ls
```

### 4.3 è¡¥å…¨æç¤ºä¿¡æ¯å®šåˆ¶


```bash
# ~/.inputrc æç¤ºä¿¡æ¯é…ç½®

# æ˜¾ç¤ºè¡¥å…¨åŒ¹é…çš„æ•°é‡
set completion-query-items 50

# è‡ªå®šä¹‰è¯¢é—®æ¶ˆæ¯
# å½“è¡¥å…¨é€‰é¡¹å¤ªå¤šæ—¶çš„æç¤ºä¿¡æ¯
set completion-display-width 80
```

**å®é™…æ•ˆæœ**ï¼š
```
$ ls [Tab]
Display all 156 possibilities? (y or n)  â† è‡ªå®šä¹‰çš„è¯¢é—®æ¶ˆæ¯
```

---

## 5. âš¡ è¡¥å…¨è¡Œä¸ºå¾®è°ƒå‚æ•°


### 5.1 è¡¥å…¨è§¦å‘æ¡ä»¶è®¾ç½®


```bash
# ~/.inputrc è§¦å‘æ¡ä»¶é…ç½®

# === è§¦å‘æ—¶æœºæ§åˆ¶ ===
# ç¬¬ä¸€æ¬¡Tabå°±æ˜¾ç¤ºæ‰€æœ‰å¯èƒ½çš„è¡¥å…¨
set show-all-if-ambiguous on

# å¦‚æœæ²¡æœ‰ä»»ä½•è¡¥å…¨ï¼Œç›´æ¥æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶
set show-all-if-unmodified on

# === è¡¥å…¨èŒƒå›´æ§åˆ¶ ===
# åŒ…å«éšè—æ–‡ä»¶ï¼ˆä»¥.å¼€å¤´çš„æ–‡ä»¶ï¼‰
set match-hidden-files on

# è¡¥å…¨æ—¶è·³è¿‡å¤‡ä»½æ–‡ä»¶ï¼ˆä»¥~ç»“å°¾çš„æ–‡ä»¶ï¼‰
set skip-completed-text on
```

### 5.2 è¡¥å…¨æ€§èƒ½ä¼˜åŒ–è®¾ç½®


```bash
# === æ€§èƒ½ä¼˜åŒ–é…ç½® ===
# é™åˆ¶è¡¥å…¨é€‰é¡¹çš„æœ€å¤§æ•°é‡ï¼ˆé¿å…å¡é¡¿ï¼‰
set completion-query-items 100

# å¯ç”¨å¢é‡æœç´¢ï¼ˆè¾“å…¥æ—¶å®æ—¶è¿‡æ»¤ï¼‰
set incremental-search on

# å†å²æœç´¢ä¼˜åŒ–
set history-search-caseless on
```

**æ€§èƒ½å½±å“è¯´æ˜**ï¼š
```
å¤§ç›®å½•ä¸­çš„è¡¥å…¨å¯¹æ¯”ï¼š

æœªä¼˜åŒ–ï¼šls /usr/bin/[Tab]  â† å¯èƒ½éœ€è¦3-5ç§’æ˜¾ç¤ºæ‰€æœ‰ç»“æœ
å·²ä¼˜åŒ–ï¼šls /usr/bin/[Tab]  â† 1ç§’å†…æ˜¾ç¤ºå‰100ä¸ªç»“æœï¼Œè¯¢é—®æ˜¯å¦æ˜¾ç¤ºæ›´å¤š
```

### 5.3 è¡¥å…¨å‡†ç¡®åº¦è°ƒæ•´


```bash
# === å‡†ç¡®åº¦vsä¾¿åˆ©æ€§å¹³è¡¡ ===
# æ¨¡ç³ŠåŒ¹é…ï¼šå…è®¸ä¸€äº›æ‹¼å†™é”™è¯¯
set completion-ignore-case on
set completion-map-case on

# æ™ºèƒ½è¡¥å…¨ï¼šæ ¹æ®ä¸Šä¸‹æ–‡è°ƒæ•´è¡¥å…¨å†…å®¹
set expand-tilde on          # è‡ªåŠ¨å±•å¼€ ~ ä¸ºç”¨æˆ·ä¸»ç›®å½•
set mark-directories on      # ç›®å½•åè‡ªåŠ¨æ·»åŠ  /
```

---

## 6. ğŸ”€ æ¡ä»¶è¡¥å…¨è§„åˆ™è®¾ç½®


### 6.1 åŸºäºShellçš„æ¡ä»¶é…ç½®


```bash
# ~/.inputrc æ¡ä»¶é…ç½®ç¤ºä¾‹

# === Bashç‰¹æœ‰é…ç½® ===
$if Bash
    # Bashä¸“ç”¨çš„è¡¥å…¨å¢å¼º
    set completion-ignore-case on
    set show-all-if-ambiguous on
    
    # Bashå†å²æœç´¢å¢å¼º
    "\e[A": history-search-backward
    "\e[B": history-search-forward
$endif

# === Zshç‰¹æœ‰é…ç½® ===
$if Zsh
    # Zshæœ‰è‡ªå·±çš„è¡¥å…¨ç³»ç»Ÿï¼Œè¿™é‡Œé…ç½®åŸºç¡€readlineè¡Œä¸º
    set editing-mode emacs
$endif

# === é€šç”¨é…ç½®ï¼ˆæ‰€æœ‰Shellï¼‰ ===
$if mode=emacs
    # Emacsæ¨¡å¼ä¸‹çš„é”®ç»‘å®š
    "\C-p": history-search-backward
    "\C-n": history-search-forward
$endif
```

### 6.2 åŸºäºç»ˆç«¯ç±»å‹çš„æ¡ä»¶é…ç½®


```bash
# === ä¸åŒç»ˆç«¯çš„å·®å¼‚åŒ–é…ç½® ===
$if term=xterm
    # xtermç»ˆç«¯ç‰¹æœ‰é…ç½®
    set meta-flag on
    set input-meta on
    set output-meta on
$endif

$if term=screen
    # screen/tmuxç¯å¢ƒä¸­çš„ç‰¹æ®Šé…ç½®
    set bell-style none
$endif
```

### 6.3 åŸºäºç”¨æˆ·è§’è‰²çš„æ¡ä»¶é…ç½®


```bash
# ~/.inputrc ç”¨æˆ·è§’è‰²é…ç½®

# æ£€æŸ¥æ˜¯å¦ä¸ºrootç”¨æˆ·
$if mode=root
    # rootç”¨æˆ·çš„å®‰å…¨æ€§é…ç½®
    set completion-query-items 20  # é™åˆ¶æ˜¾ç¤ºæ•°é‡
    set bell-style visible         # ä½¿ç”¨è§†è§‰æç¤ºè€Œä¸æ˜¯å£°éŸ³
$endif
```

---

## 7. ğŸš€ åŠ¨æ€è¡¥å…¨å†…å®¹ç”Ÿæˆ


### 7.1 è‡ªå®šä¹‰è¡¥å…¨å‡½æ•°åŸºç¡€


**ä»€ä¹ˆæ˜¯åŠ¨æ€è¡¥å…¨**ï¼šå°±æ˜¯æ ¹æ®å½“å‰çš„å‘½ä»¤å’Œä¸Šä¸‹æ–‡ï¼Œå®æ—¶ç”Ÿæˆè¡¥å…¨å†…å®¹çš„åŠŸèƒ½ã€‚

```bash
# ~/.bashrc ä¸­å®šä¹‰è‡ªå®šä¹‰è¡¥å…¨å‡½æ•°

# ç®€å•ç¤ºä¾‹ï¼šä¸ºmycommandå‘½ä»¤æ·»åŠ è¡¥å…¨
_mycommand_complete() {
    local cur prev words cword
    
    # è·å–å½“å‰è¡¥å…¨çš„ç›¸å…³ä¿¡æ¯
    cur="${COMP_WORDS[COMP_CWORD]}"     # å½“å‰æ­£åœ¨è¾“å…¥çš„è¯
    prev="${COMP_WORDS[COMP_CWORD-1]}"  # å‰ä¸€ä¸ªè¯
    
    # æ ¹æ®å‰ä¸€ä¸ªå‚æ•°å†³å®šè¡¥å…¨å†…å®¹
    case "$prev" in
        --file)
            # å¦‚æœå‰é¢æ˜¯--fileï¼Œå°±è¡¥å…¨æ–‡ä»¶å
            COMPREPLY=($(compgen -f -- "$cur"))
            ;;
        --user)
            # å¦‚æœå‰é¢æ˜¯--userï¼Œå°±è¡¥å…¨ç”¨æˆ·å
            COMPREPLY=($(compgen -u -- "$cur"))
            ;;
        *)
            # é»˜è®¤æƒ…å†µä¸‹è¡¥å…¨é€‰é¡¹
            COMPREPLY=($(compgen -W "--file --user --help" -- "$cur"))
            ;;
    esac
}

# å°†è¡¥å…¨å‡½æ•°ç»‘å®šåˆ°å‘½ä»¤
complete -F _mycommand_complete mycommand
```

### 7.2 é«˜çº§åŠ¨æ€è¡¥å…¨ç¤ºä¾‹


```bash
# ä¸ºgitå‘½ä»¤åˆ›å»ºå¢å¼ºè¡¥å…¨
_git_enhanced_complete() {
    local cur prev words cword
    cur="${COMP_WORDS[COMP_CWORD]}"
    prev="${COMP_WORDS[COMP_CWORD-1]}"
    
    # gitå­å‘½ä»¤åˆ—è¡¨
    local git_commands="add commit push pull clone branch checkout merge status log"
    
    # å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè¡¥å…¨gitå­å‘½ä»¤
    if [[ $COMP_CWORD -eq 1 ]]; then
        COMPREPLY=($(compgen -W "$git_commands" -- "$cur"))
        return
    fi
    
    # æ ¹æ®ä¸åŒçš„gitå­å‘½ä»¤æä¾›ä¸åŒçš„è¡¥å…¨
    case "${COMP_WORDS[1]}" in
        checkout|branch)
            # è¡¥å…¨åˆ†æ”¯å
            local branches=$(git branch --format='%(refname:short)' 2>/dev/null)
            COMPREPLY=($(compgen -W "$branches" -- "$cur"))
            ;;
        add|rm)
            # è¡¥å…¨æ–‡ä»¶å
            COMPREPLY=($(compgen -f -- "$cur"))
            ;;
        *)
            # é»˜è®¤æ–‡ä»¶è¡¥å…¨
            COMPREPLY=($(compgen -f -- "$cur"))
            ;;
    esac
}

# ç»‘å®šåˆ°gitå‘½ä»¤
complete -F _git_enhanced_complete git
```

### 7.3 è¡¥å…¨å†…å®¹çš„åŠ¨æ€ç”Ÿæˆç­–ç•¥


```bash
# ä»é…ç½®æ–‡ä»¶åŠ¨æ€è¯»å–è¡¥å…¨é€‰é¡¹
_config_based_complete() {
    local cur="${COMP_WORDS[COMP_CWORD]}"
    local config_file="$HOME/.myapp_config"
    
    # ä»é…ç½®æ–‡ä»¶ä¸­æå–å¯ç”¨é€‰é¡¹
    if [[ -f "$config_file" ]]; then
        local options=$(grep -E '^[a-zA-Z]' "$config_file" | cut -d'=' -f1)
        COMPREPLY=($(compgen -W "$options" -- "$cur"))
    else
        # å¦‚æœé…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæä¾›é»˜è®¤é€‰é¡¹
        COMPREPLY=($(compgen -W "help version config" -- "$cur"))
    fi
}
```

**åŠ¨æ€è¡¥å…¨çš„ä¼˜åŠ¿**ï¼š
```
é™æ€è¡¥å…¨ï¼šå›ºå®šçš„é€‰é¡¹åˆ—è¡¨
mycommand [Tab] â†’ --help --version --file

åŠ¨æ€è¡¥å…¨ï¼šæ ¹æ®ä¸Šä¸‹æ–‡å˜åŒ–
mycommand --file [Tab] â†’ æ˜¾ç¤ºæ–‡ä»¶åˆ—è¡¨
mycommand --user [Tab] â†’ æ˜¾ç¤ºç”¨æˆ·åˆ—è¡¨
```

---

## 8. ğŸ”§ è¡¥å…¨å†²çªè§£å†³ç­–ç•¥


### 8.1 å¸¸è§è¡¥å…¨å†²çªç±»å‹


**ä»€ä¹ˆæ˜¯è¡¥å…¨å†²çª**ï¼šå½“å¤šä¸ªç¨‹åºæˆ–é…ç½®éƒ½æƒ³ä¸ºåŒä¸€ä¸ªå‘½ä»¤æä¾›è¡¥å…¨æ—¶ï¼Œå°±ä¼šå‘ç”Ÿå†²çªã€‚

```bash
# å†²çªç¤ºä¾‹æƒ…å†µï¼š
# ç³»ç»Ÿé»˜è®¤: ls [Tab] â†’ è¡¥å…¨æ–‡ä»¶å
# è‡ªå®šä¹‰1:  ls [Tab] â†’ è¡¥å…¨æ–‡ä»¶åå¹¶æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯  
# è‡ªå®šä¹‰2:  ls [Tab] â†’ åªè¡¥å…¨ç›®å½•å

# ç»“æœï¼šå¯èƒ½å¯¼è‡´è¡¥å…¨åŠŸèƒ½å¼‚å¸¸æˆ–ä¸å·¥ä½œ
```

### 8.2 å†²çªæ£€æµ‹ä¸è¯Šæ–­


```bash
# æ£€æŸ¥å½“å‰å‘½ä»¤çš„è¡¥å…¨è®¾ç½®
complete -p ls

# è¾“å‡ºç¤ºä¾‹ï¼š
# complete -F _longopt ls

# æ£€æŸ¥æ˜¯å¦æœ‰å¤šé‡å®šä¹‰
complete -p | grep ls

# æŸ¥çœ‹æ‰€æœ‰è¡¥å…¨å‡½æ•°
declare -F | grep complete
```

**è¯Šæ–­æ­¥éª¤**ï¼š
```
1. æ£€æŸ¥å‘½ä»¤ï¼šcomplete -p å‘½ä»¤å
2. æŸ¥çœ‹å‡½æ•°ï¼šdeclare -F | grep å‘½ä»¤å
3. æµ‹è¯•è¡¥å…¨ï¼šå‘½ä»¤ [Tab] çœ‹æ˜¯å¦æ­£å¸¸å·¥ä½œ
4. æŸ¥çœ‹æ—¥å¿—ï¼šå¯èƒ½çš„é”™è¯¯ä¿¡æ¯
```

### 8.3 å†²çªè§£å†³æ–¹æ¡ˆ


```bash
# ~/.bashrc å†²çªè§£å†³é…ç½®

# === æ–¹æ¡ˆ1ï¼šä¼˜å…ˆçº§æ§åˆ¶ ===
# å–æ¶ˆä¹‹å‰çš„è¡¥å…¨å®šä¹‰
complete -r ls  # åˆ é™¤lså‘½ä»¤çš„æ‰€æœ‰è¡¥å…¨è§„åˆ™

# é‡æ–°å®šä¹‰è¡¥å…¨
complete -F _my_ls_complete ls

# === æ–¹æ¡ˆ2ï¼šæ¡ä»¶æ€§è¡¥å…¨ ===
# åªæœ‰åœ¨ç‰¹å®šæ¡ä»¶ä¸‹æ‰å¯ç”¨è‡ªå®šä¹‰è¡¥å…¨
if [[ -n "$MY_CUSTOM_COMPLETION" ]]; then
    complete -F _my_custom_complete mycommand
else
    # ä½¿ç”¨é»˜è®¤è¡¥å…¨
    complete -o default mycommand
fi

# === æ–¹æ¡ˆ3ï¼šè¡¥å…¨é“¾ ===
# å…ˆå°è¯•è‡ªå®šä¹‰è¡¥å…¨ï¼Œå¦‚æœæ²¡æœ‰ç»“æœå†ç”¨é»˜è®¤è¡¥å…¨
_fallback_complete() {
    # å…ˆå°è¯•è‡ªå®šä¹‰è¡¥å…¨
    _my_custom_complete "$@"
    
    # å¦‚æœæ²¡æœ‰ç»“æœï¼Œä½¿ç”¨é»˜è®¤è¡¥å…¨
    if [[ ${#COMPREPLY[@]} -eq 0 ]]; then
        compopt -o default
    fi
}

complete -F _fallback_complete mycommand
```

### 8.4 è¡¥å…¨ä¼˜å…ˆçº§ç®¡ç†


```bash
# === è¡¥å…¨åŠ è½½é¡ºåºæ§åˆ¶ ===
# ~/.bashrc ä¸­çš„åŠ è½½ç­–ç•¥

# 1. å…ˆåŠ è½½ç³»ç»Ÿé»˜è®¤è¡¥å…¨
if [[ -f /etc/bash_completion ]]; then
    source /etc/bash_completion
fi

# 2. å†åŠ è½½ç”¨æˆ·è‡ªå®šä¹‰è¡¥å…¨
if [[ -d ~/.bash_completion.d ]]; then
    for completion in ~/.bash_completion.d/*; do
        [[ -r "$completion" ]] && source "$completion"
    done
fi

# 3. æœ€ååŠ è½½ä¸´æ—¶è¡¥å…¨è¦†ç›–
if [[ -f ~/.bash_completion_override ]]; then
    source ~/.bash_completion_override
fi
```

---

## 9. ğŸŒ è·¨Shellè¡¥å…¨å…¼å®¹æ€§


### 9.1 ä¸åŒShellçš„è¡¥å…¨ç³»ç»Ÿå·®å¼‚


**å„Shellè¡¥å…¨ç‰¹ç‚¹å¯¹æ¯”**ï¼š

| Shell | **è¡¥å…¨ç³»ç»Ÿ** | **é…ç½®æ–‡ä»¶** | **ç‰¹ç‚¹** |
|-------|-------------|-------------|----------|
| **Bash** | bash-completion + readline | ~/.inputrc, ~/.bashrc | åŸºç¡€ä½†ç¨³å®šï¼Œå¹¿æ³›æ”¯æŒ |
| **Zsh** | zsh-completions | ~/.zshrc | åŠŸèƒ½æœ€å¼ºå¤§ï¼Œé«˜åº¦å¯å®šåˆ¶ |
| **Fish** | å†…ç½®æ™ºèƒ½è¡¥å…¨ | ~/.config/fish/ | å¼€ç®±å³ç”¨ï¼Œè‡ªåŠ¨å­¦ä¹  |
| **Tcsh** | tcsh-complete | ~/.tcshrc | åŸºç¡€åŠŸèƒ½ï¼Œè¾ƒå°‘ä½¿ç”¨ |

### 9.2 é€šç”¨è¡¥å…¨é…ç½®ç­–ç•¥


```bash
# ~/.profile é€šç”¨é…ç½®ï¼ˆæ‰€æœ‰Shelléƒ½ä¼šåŠ è½½ï¼‰

# æ£€æµ‹å½“å‰ä½¿ç”¨çš„Shell
detect_shell() {
    if [[ -n "$BASH_VERSION" ]]; then
        echo "bash"
    elif [[ -n "$ZSH_VERSION" ]]; then
        echo "zsh"
    elif [[ -n "$FISH_VERSION" ]]; then
        echo "fish"
    else
        echo "unknown"
    fi
}

# æ ¹æ®Shellç±»å‹åŠ è½½ç›¸åº”é…ç½®
current_shell=$(detect_shell)
case "$current_shell" in
    bash)
        [[ -f ~/.bash_completion ]] && source ~/.bash_completion
        ;;
    zsh)
        # Zshè‡ªåŠ¨åŠ è½½è¡¥å…¨ç³»ç»Ÿ
        autoload -U compinit && compinit
        ;;
    fish)
        # Fishæœ‰å†…ç½®çš„è¡¥å…¨ç³»ç»Ÿ
        ;;
esac
```

### 9.3 Bashåˆ°Zshçš„è¡¥å…¨è¿ç§»


```bash
# ~/.zshrc Bashè¡¥å…¨å…¼å®¹é…ç½®

# å¯ç”¨bashè¡¥å…¨å…¼å®¹æ¨¡å¼
autoload -U bashcompinit
bashcompinit

# åŠ è½½bashè¡¥å…¨è„šæœ¬
if [[ -f /etc/bash_completion ]]; then
    source /etc/bash_completion
fi

# åŠ è½½ç”¨æˆ·çš„bashè¡¥å…¨
for completion in ~/.bash_completion.d/*; do
    [[ -r "$completion" ]] && source "$completion"
done

# Zshç‰¹æœ‰çš„è¡¥å…¨å¢å¼º
setopt COMPLETE_IN_WORD    # åœ¨å•è¯ä¸­é—´ä¹Ÿèƒ½è¡¥å…¨
setopt AUTO_MENU           # å¤šæ¬¡Tabè‡ªåŠ¨è¿›å…¥èœå•é€‰æ‹©
setopt AUTO_LIST           # è‡ªåŠ¨æ˜¾ç¤ºè¡¥å…¨åˆ—è¡¨
```

### 9.4 è·¨Shellè¡¥å…¨è„šæœ¬ç¼–å†™


```bash
# é€šç”¨è¡¥å…¨è„šæœ¬æ¨¡æ¿
# æ–‡ä»¶ï¼š~/.completion_universal.sh

# æ£€æµ‹Shellç±»å‹å¹¶æä¾›ç›¸åº”çš„è¡¥å…¨
_universal_complete() {
    local cur words cword
    
    # æ ¹æ®Shellç±»å‹è·å–è¡¥å…¨ä¸Šä¸‹æ–‡
    if [[ -n "$BASH_VERSION" ]]; then
        # Bashæ–¹å¼
        cur="${COMP_WORDS[COMP_CWORD]}"
        words=("${COMP_WORDS[@]}")
        cword=$COMP_CWORD
    elif [[ -n "$ZSH_VERSION" ]]; then
        # Zshæ–¹å¼
        cur="$words[CURRENT]"
        cword=$CURRENT
    fi
    
    # ç»Ÿä¸€çš„è¡¥å…¨é€»è¾‘
    local options="--help --version --config --debug"
    
    # ç”Ÿæˆè¡¥å…¨ç»“æœ
    if [[ -n "$BASH_VERSION" ]]; then
        COMPREPLY=($(compgen -W "$options" -- "$cur"))
    elif [[ -n "$ZSH_VERSION" ]]; then
        _describe 'options' options
    fi
}

# æ ¹æ®Shellç±»å‹æ³¨å†Œè¡¥å…¨
if [[ -n "$BASH_VERSION" ]]; then
    complete -F _universal_complete mycommand
elif [[ -n "$ZSH_VERSION" ]]; then
    compdef _universal_complete mycommand
fi
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ .inputrcæ–‡ä»¶ï¼šæ§åˆ¶é”®ç›˜è¾“å…¥å’Œè¡¥å…¨è¡Œä¸ºçš„é…ç½®æ–‡ä»¶
ğŸ”¸ readlineé€‰é¡¹ï¼šå½±å“è¡¥å…¨æ˜¾ç¤ºå’Œäº¤äº’æ–¹å¼çš„å‚æ•°è®¾ç½®
ğŸ”¸ åŠ¨æ€è¡¥å…¨ï¼šæ ¹æ®ä¸Šä¸‹æ–‡å®æ—¶ç”Ÿæˆè¡¥å…¨å†…å®¹çš„æŠ€æœ¯
ğŸ”¸ è¡¥å…¨å†²çªï¼šå¤šä¸ªè¡¥å…¨è§„åˆ™å†²çªæ—¶çš„è¯Šæ–­å’Œè§£å†³æ–¹æ³•
ğŸ”¸ è·¨Shellå…¼å®¹ï¼šåœ¨ä¸åŒShellä¹‹é—´ä¿æŒè¡¥å…¨åŠŸèƒ½ä¸€è‡´æ€§
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ è¡¥å…¨ç³»ç»Ÿçš„å·¥ä½œæµç¨‹**
```
ç”¨æˆ·æŒ‰Tab â†’ Shellæ£€æµ‹è¾“å…¥ â†’ Readlineå¤„ç† â†’ 
è¡¥å…¨å¼•æ“åŒ¹é… â†’ æ˜¾ç¤ºç»“æœ â†’ ç”¨æˆ·é€‰æ‹©
```

**ğŸ”¹ é…ç½®ä¼˜å…ˆçº§å…³ç³»**
```
ç”¨æˆ·é…ç½® > ç³»ç»Ÿé…ç½®
Shellç‰¹å®š > é€šç”¨é…ç½®  
ååŠ è½½ > å…ˆåŠ è½½
```

**ğŸ”¹ æ€§èƒ½ä¸åŠŸèƒ½çš„å¹³è¡¡**
```
è¡¥å…¨é€‰é¡¹æ•°é‡ â†” å“åº”é€Ÿåº¦
åŒ¹é…ç²¾ç¡®åº¦ â†” ä½¿ç”¨ä¾¿åˆ©æ€§
åŠŸèƒ½ä¸°å¯Œåº¦ â†” é…ç½®å¤æ‚åº¦
```

### 10.3 å®é™…åº”ç”¨å»ºè®®


**ğŸ¯ åˆå­¦è€…æ¨èé…ç½®**
```bash
# ~/.inputrc åŸºç¡€é…ç½®
set completion-ignore-case on
set show-all-if-ambiguous on
set colored-stats on
set visible-stats on
Tab: complete
```

**ğŸ¯ é«˜çº§ç”¨æˆ·ä¼˜åŒ–é…ç½®**
```bash
# æ€§èƒ½ä¼˜åŒ– + åŠŸèƒ½å¢å¼º
set completion-query-items 100
set menu-complete-display-prefix on
set completion-prefix-display-length 2
set incremental-search on
```

**ğŸ¯ è·¨å¹³å°å…¼å®¹ç­–ç•¥**
- ä½¿ç”¨é€šç”¨çš„readlineé€‰é¡¹
- é¿å…Shellç‰¹æœ‰çš„é«˜çº§ç‰¹æ€§
- æä¾›å¤šç§Shellçš„å¤‡é€‰æ–¹æ¡ˆ
- å®šæœŸæµ‹è¯•ä¸åŒç¯å¢ƒä¸‹çš„è¡¨ç°

**ğŸ¯ æ•…éšœæ’æŸ¥æ€è·¯**
1. **è¡¥å…¨ä¸å·¥ä½œ**ï¼šæ£€æŸ¥completeå‘½ä»¤è®¾ç½®
2. **è¡¥å…¨å¤ªæ…¢**ï¼šå‡å°‘completion-query-itemsæ•°é‡
3. **è¡¥å…¨å†²çª**ï¼šä½¿ç”¨complete -ræ¸…é™¤åé‡æ–°è®¾ç½®
4. **è·¨Shellé—®é¢˜**ï¼šæ£€æŸ¥Shellæ£€æµ‹é€»è¾‘

**æ ¸å¿ƒè®°å¿†**ï¼š
- è¡¥å…¨é…ç½®è®©å‘½ä»¤è¡Œæ›´é«˜æ•ˆä¾¿æ·
- .inputrcæ§åˆ¶é”®ç›˜è¡Œä¸ºå’Œæ˜¾ç¤ºæ ·å¼
- åŠ¨æ€è¡¥å…¨æ ¹æ®ä¸Šä¸‹æ–‡æ™ºèƒ½æç¤ºå†…å®¹
- è§£å†³å†²çªè¦ç†æ¸…ä¼˜å…ˆçº§å’ŒåŠ è½½é¡ºåº
- è·¨Shellå…¼å®¹éœ€è¦æ£€æµ‹å’Œé€‚é…ä¸åŒç¯å¢ƒ