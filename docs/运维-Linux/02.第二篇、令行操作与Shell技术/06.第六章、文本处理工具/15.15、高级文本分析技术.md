---
title: 15ã€é«˜çº§æ–‡æœ¬åˆ†ææŠ€æœ¯
---
## ğŸ“š ç›®å½•

1. [è¯é¢‘ç»Ÿè®¡ä¸åˆ†ææŠ€æœ¯](#1-è¯é¢‘ç»Ÿè®¡ä¸åˆ†ææŠ€æœ¯)
2. [æ–‡æœ¬å»é‡ä¸ç›¸ä¼¼åº¦åˆ†æ](#2-æ–‡æœ¬å»é‡ä¸ç›¸ä¼¼åº¦åˆ†æ)
3. [æ—¥å¿—æ¨¡å¼è¯†åˆ«æŠ€æœ¯](#3-æ—¥å¿—æ¨¡å¼è¯†åˆ«æŠ€æœ¯)
4. [æ€§èƒ½æ•°æ®æå–åˆ†æ](#4-æ€§èƒ½æ•°æ®æå–åˆ†æ)
5. [é…ç½®æ–‡ä»¶è§£ææŠ€æœ¯](#5-é…ç½®æ–‡ä»¶è§£ææŠ€æœ¯)
6. [é”™è¯¯ä¿¡æ¯è¿‡æ»¤æŠ€æœ¯](#6-é”™è¯¯ä¿¡æ¯è¿‡æ»¤æŠ€æœ¯)
7. [æ•°æ®é‡‡æ ·æŠ€æœ¯](#7-æ•°æ®é‡‡æ ·æŠ€æœ¯)
8. [æ‰¹é‡æ–‡æœ¬å¤„ç†æŠ€æœ¯](#8-æ‰¹é‡æ–‡æœ¬å¤„ç†æŠ€æœ¯)
9. [è‡ªåŠ¨åŒ–æŠ¥å‘Šç”Ÿæˆ](#9-è‡ªåŠ¨åŒ–æŠ¥å‘Šç”Ÿæˆ)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ“Š è¯é¢‘ç»Ÿè®¡ä¸åˆ†ææŠ€æœ¯


### 1.1 ä»€ä¹ˆæ˜¯è¯é¢‘ç»Ÿè®¡


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µ**ï¼š
è¯é¢‘ç»Ÿè®¡å°±æ˜¯**ç»Ÿè®¡æ–‡æœ¬ä¸­æ¯ä¸ªå•è¯å‡ºç°çš„æ¬¡æ•°**ï¼Œå°±åƒç»Ÿè®¡ç­çº§é‡Œæ¯ä¸ªåŒå­¦çš„å‡ºå‹¤æ¬¡æ•°ä¸€æ ·ã€‚è¿™åœ¨åˆ†ææ—¥å¿—æ–‡ä»¶ã€ç”¨æˆ·è¡Œä¸ºã€ç³»ç»Ÿç›‘æ§ç­‰åœºæ™¯ä¸­éå¸¸æœ‰ç”¨ã€‚

```
å®é™…åº”ç”¨åœºæ™¯ï¼š
ğŸ“ æ—¥å¿—åˆ†æ - ç»Ÿè®¡æœ€é¢‘ç¹çš„é”™è¯¯ç±»å‹
ğŸ“ˆ è®¿é—®ç»Ÿè®¡ - åˆ†æç”¨æˆ·æœ€å¸¸è®¿é—®çš„é¡µé¢
ğŸ” å…³é”®è¯æå– - æ‰¾å‡ºæ–‡æ¡£ä¸­çš„æ ¸å¿ƒè¯æ±‡
```

### 1.2 åŸºç¡€è¯é¢‘ç»Ÿè®¡


**ğŸ’¡ æ ¸å¿ƒæ€è·¯**ï¼šæŠŠæ–‡æœ¬æ‹†åˆ†æˆå•è¯ï¼Œç„¶åç»Ÿè®¡æ¯ä¸ªå•è¯çš„å‡ºç°æ¬¡æ•°

```bash
# æœ€ç®€å•çš„è¯é¢‘ç»Ÿè®¡
cat access.log | grep "GET" | awk '{print $7}' | sort | uniq -c | sort -nr

# è§£é‡Šæ¯ä¸€æ­¥ï¼š
# 1. cat access.log        - è¯»å–æ—¥å¿—æ–‡ä»¶
# 2. grep "GET"           - ç­›é€‰GETè¯·æ±‚
# 3. awk '{print $7}'     - æå–URLéƒ¨åˆ†
# 4. sort                 - æ’åºï¼ˆç›¸åŒçš„æŒ¨åœ¨ä¸€èµ·ï¼‰
# 5. uniq -c              - ç»Ÿè®¡é‡å¤æ¬¡æ•°
# 6. sort -nr             - æŒ‰æ•°é‡ä»å¤§åˆ°å°æ’åº
```

**ğŸ“ˆ è¾“å‡ºç¤ºä¾‹**ï¼š
```
    245 /index.html
    156 /login.php
     89 /api/users
     67 /contact.html
     34 /admin/
```

### 1.3 é«˜çº§è¯é¢‘åˆ†æ


**ğŸš€ æ›´å¤æ‚çš„è¯é¢‘ç»Ÿè®¡**ï¼š

```bash
# ç»Ÿè®¡æ—¥å¿—ä¸­IPåœ°å€çš„è®¿é—®é¢‘ç‡
awk '{count[$1]++} END {for (ip in count) print count[ip], ip}' access.log | sort -nr | head -10

# ç»Ÿè®¡ç”¨æˆ·ä»£ç†ï¼ˆæµè§ˆå™¨ï¼‰ä½¿ç”¨æƒ…å†µ
awk -F'"' '{print $6}' access.log | sort | uniq -c | sort -nr | head -5
```

**âš™ï¸ è‡ªå®šä¹‰è¯é¢‘åˆ†æè„šæœ¬**ï¼š
```bash
#!/bin/bash
# word_freq.sh - æ™ºèƒ½è¯é¢‘ç»Ÿè®¡å·¥å…·

file="$1"
min_length="${2:-3}"  # æœ€å°å•è¯é•¿åº¦ï¼Œé»˜è®¤3

echo "ğŸ” åˆ†ææ–‡ä»¶: $file"
echo "ğŸ“ æœ€å°å•è¯é•¿åº¦: $min_length"
echo "=================="

# æå–å•è¯ï¼Œè¿‡æ»¤çŸ­è¯ï¼Œç»Ÿè®¡é¢‘ç‡
cat "$file" | \
tr '[:upper:]' '[:lower:]' | \
tr -cs '[:alpha:]' '\n' | \
awk "length >= $min_length" | \
sort | uniq -c | sort -nr | head -20
```

**ğŸ“Š è¯é¢‘å¯è§†åŒ–ï¼ˆç®€å•ç‰ˆï¼‰**ï¼š
```bash
# ç”¨æ˜Ÿå·æ˜¾ç¤ºè¯é¢‘
word_freq.sh log.txt | awk '{
    count = $1; word = $2
    stars = ""
    for(i=1; i<=count/10; i++) stars = stars "*"
    printf "%-15s %5d %s\n", word, count, stars
}'
```

### 1.4 å¤šç»´åº¦è¯é¢‘åˆ†æ


**ğŸ¯ æŒ‰æ—¶é—´æ®µç»Ÿè®¡**ï¼š
```bash
# æŒ‰å°æ—¶ç»Ÿè®¡è®¿é—®é¢‘ç‡
awk '{
    time = substr($4, 14, 2)  # æå–å°æ—¶
    count[time]++
} 
END {
    for (hour in count) 
        printf "%02d:00 - %3dæ¬¡è®¿é—®\n", hour, count[hour]
}' access.log | sort
```

**ğŸ”„ äº¤å‰åˆ†æ**ï¼š
```bash
# åŒæ—¶ç»Ÿè®¡çŠ¶æ€ç å’Œè¯·æ±‚æ–¹æ³•
awk '{
    key = $6 " " $9  # æ–¹æ³• + çŠ¶æ€ç 
    count[key]++
} 
END {
    for (combo in count) 
        print count[combo], combo
}' access.log | sort -nr
```

---

## 2. ğŸ”„ æ–‡æœ¬å»é‡ä¸ç›¸ä¼¼åº¦åˆ†æ


### 2.1 æ–‡æœ¬å»é‡åŸºç¡€


**ğŸ”¸ ä»€ä¹ˆæ˜¯æ–‡æœ¬å»é‡**ï¼š
å°±æ˜¯æŠŠæ–‡æœ¬ä¸­**é‡å¤çš„å†…å®¹æ‰¾å‡ºæ¥å¹¶åˆ é™¤**ï¼Œå°±åƒæ•´ç†ç…§ç‰‡æ—¶åˆ é™¤é‡å¤ç…§ç‰‡ä¸€æ ·ã€‚

```
å¸¸è§åº”ç”¨åœºæ™¯ï¼š
ğŸ“‹ æ—¥å¿—æ¸…ç† - åˆ é™¤é‡å¤çš„é”™è¯¯ä¿¡æ¯
ğŸ“„ æ•°æ®æ¸…æ´— - å»é™¤é‡å¤çš„è®°å½•
ğŸ“§ é‚®ä»¶è¿‡æ»¤ - è¯†åˆ«é‡å¤å‘é€çš„é‚®ä»¶
```

### 2.2 å®Œå…¨åŒ¹é…å»é‡


**ğŸ’¡ æœ€ç®€å•çš„å»é‡**ï¼š
```bash
# åŸºç¡€å»é‡ï¼ˆå®Œå…¨ç›¸åŒçš„è¡Œï¼‰
sort file.txt | uniq

# æ˜¾ç¤ºé‡å¤è¡Œçš„æ•°é‡
sort file.txt | uniq -c

# åªæ˜¾ç¤ºé‡å¤çš„è¡Œ
sort file.txt | uniq -d

# åªæ˜¾ç¤ºä¸é‡å¤çš„è¡Œ
sort file.txt | uniq -u
```

**ğŸ“Š å»é‡ç»Ÿè®¡åˆ†æ**ï¼š
```bash
# åˆ†æé‡å¤æƒ…å†µ
analyze_duplicates() {
    local file="$1"
    echo "ğŸ“„ æ–‡ä»¶: $file"
    echo "ğŸ“Š æ€»è¡Œæ•°: $(wc -l < $file)"
    echo "ğŸ”„ å”¯ä¸€è¡Œæ•°: $(sort $file | uniq | wc -l)"
    echo "â™»ï¸  é‡å¤è¡Œæ•°: $(sort $file | uniq -d | wc -l)"
    echo "=================="
    sort "$file" | uniq -c | sort -nr | head -5
}
```

### 2.3 æ¨¡ç³ŠåŒ¹é…å»é‡


**ğŸ¯ åŸºäºç›¸ä¼¼åº¦çš„å»é‡**ï¼š

```bash
# å¿½ç•¥å¤§å°å†™çš„å»é‡
sort file.txt | uniq -i

# å¿½ç•¥å‰é¢ç©ºæ ¼çš„å»é‡
sort file.txt | uniq -f 1  # è·³è¿‡ç¬¬1ä¸ªå­—æ®µ

# åªæ¯”è¾ƒå‰Nä¸ªå­—ç¬¦
sort file.txt | uniq -w 10  # åªæ¯”è¾ƒå‰10ä¸ªå­—ç¬¦
```

**ğŸ”§ è‡ªå®šä¹‰ç›¸ä¼¼åº¦å»é‡**ï¼š
```bash
#!/bin/bash
# similar_dedup.sh - æ™ºèƒ½ç›¸ä¼¼æ–‡æœ¬å»é‡

similarity_dedup() {
    local file="$1"
    local threshold="${2:-80}"  # ç›¸ä¼¼åº¦é˜ˆå€¼ï¼ˆç™¾åˆ†æ¯”ï¼‰
    
    echo "ğŸ” æ‰§è¡Œç›¸ä¼¼åº¦å»é‡..."
    echo "ğŸ“Š ç›¸ä¼¼åº¦é˜ˆå€¼: ${threshold}%"
    
    # ç®€åŒ–ç‰ˆï¼šåŸºäºå•è¯æ•°é‡çš„ç›¸ä¼¼åº¦
    awk -v threshold="$threshold" '
    {
        # è®¡ç®—å•è¯æ•°
        word_count = NF
        line = $0
        
        # ä¸å·²æœ‰è¡Œæ¯”è¾ƒ
        similar = 0
        for (existing in lines) {
            existing_count = word_counts[existing]
            common = 0
            
            # ç®€å•çš„å•è¯é‡å è®¡ç®—
            if (word_count > 0 && existing_count > 0) {
                similarity = (common * 2 * 100) / (word_count + existing_count)
                if (similarity >= threshold) {
                    similar = 1
                    break
                }
            }
        }
        
        # å¦‚æœä¸ç›¸ä¼¼ï¼Œä¿ç•™è¿™è¡Œ
        if (!similar) {
            lines[NR] = line
            word_counts[NR] = word_count
            print line
        }
    }' "$file"
}
```

### 2.4 æ–‡ä»¶çº§åˆ«å»é‡


**ğŸ“ æ‰¹é‡æ–‡ä»¶å»é‡**ï¼š
```bash
# æŸ¥æ‰¾é‡å¤æ–‡ä»¶ï¼ˆåŸºäºå†…å®¹ï¼‰
find . -type f -exec md5sum {} + | sort | uniq -d -w32

# æŸ¥æ‰¾ç›¸åŒå¤§å°çš„æ–‡ä»¶
find . -type f -printf "%s %p\n" | sort -n | uniq -d -w10
```

---

## 3. ğŸ” æ—¥å¿—æ¨¡å¼è¯†åˆ«æŠ€æœ¯


### 3.1 ä»€ä¹ˆæ˜¯æ—¥å¿—æ¨¡å¼è¯†åˆ«


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µ**ï¼š
æ—¥å¿—æ¨¡å¼è¯†åˆ«å°±æ˜¯**ä»å¤§é‡æ—¥å¿—ä¸­æ‰¾å‡ºè§„å¾‹æ€§çš„å†…å®¹**ï¼Œå°±åƒåŒ»ç”Ÿä»ç—‡çŠ¶ä¸­è¯Šæ–­ç–¾ç—…ä¸€æ ·ï¼Œå¸®åŠ©æˆ‘ä»¬å¿«é€Ÿå®šä½é—®é¢˜ã€‚

```
å…¸å‹åº”ç”¨åœºæ™¯ï¼š
ğŸš¨ æ•…éšœé¢„è­¦ - è¯†åˆ«å¼‚å¸¸è®¿é—®æ¨¡å¼
ğŸ“Š æ€§èƒ½ç›‘æ§ - å‘ç°å“åº”æ—¶é—´å¼‚å¸¸
ğŸ”’ å®‰å…¨åˆ†æ - æ£€æµ‹æ”»å‡»è¡Œä¸ºæ¨¡å¼
```

### 3.2 åŸºç¡€æ¨¡å¼è¯†åˆ«


**ğŸ’¡ ç®€å•æ¨¡å¼åŒ¹é…**ï¼š
```bash
# è¯†åˆ«é”™è¯¯æ¨¡å¼
grep -E "(ERROR|FATAL|CRITICAL)" app.log | head -10

# è¯†åˆ«IPè®¿é—®æ¨¡å¼
grep -oE '\b([0-9]{1,3}\.){3}[0-9]{1,3}\b' access.log | sort | uniq -c | sort -nr
```

**ğŸ”„ æ—¶é—´æ¨¡å¼åˆ†æ**ï¼š
```bash
# åˆ†æè®¿é—®æ—¶é—´æ¨¡å¼
awk '{
    # æå–æ—¶é—´æˆ³å¹¶è½¬æ¢ä¸ºå°æ—¶
    if (match($0, /\[([^]]+)\]/, time_match)) {
        time_str = time_match[1]
        # æå–å°æ—¶
        if (match(time_str, /[0-9]+:([0-9]+):/, hour_match)) {
            hour = hour_match[1]
            hours[hour]++
        }
    }
}
END {
    print "â° å°æ—¶è®¿é—®åˆ†å¸ƒï¼š"
    for (h in hours) {
        printf "%02d:00 ", h
        for (i=1; i<=hours[h]/100; i++) printf "â–ˆ"
        printf " (%d)\n", hours[h]
    }
}' access.log
```

### 3.3 å¼‚å¸¸æ¨¡å¼æ£€æµ‹


**âš ï¸ è‡ªåŠ¨å¼‚å¸¸æ£€æµ‹**ï¼š
```bash
#!/bin/bash
# anomaly_detector.sh - æ—¥å¿—å¼‚å¸¸æ¨¡å¼æ£€æµ‹

detect_anomalies() {
    local logfile="$1"
    local threshold="${2:-3}"  # æ ‡å‡†å·®å€æ•°
    
    echo "ğŸ” æ£€æµ‹æ—¥å¿—å¼‚å¸¸æ¨¡å¼..."
    echo "ğŸ“Š å¼‚å¸¸é˜ˆå€¼: ${threshold}Ïƒ"
    echo "=================="
    
    # æŒ‰åˆ†é’Ÿç»Ÿè®¡è¯·æ±‚æ•°
    awk '{
        # æå–æ—¶é—´ï¼ˆå‡è®¾æ ¼å¼ï¼š[dd/Mon/yyyy:hh:mm:ss]
        if (match($0, /\[([^:]+):([0-9]+):([0-9]+)/, time_parts)) {
            minute = time_parts[1] ":" time_parts[2]
            count[minute]++
        }
    }
    END {
        # è®¡ç®—å¹³å‡å€¼å’Œæ ‡å‡†å·®
        sum = 0; n = 0
        for (minute in count) {
            sum += count[minute]
            n++
        }
        
        if (n > 0) {
            avg = sum / n
            
            # è®¡ç®—æ ‡å‡†å·®
            sq_sum = 0
            for (minute in count) {
                sq_sum += (count[minute] - avg) ^ 2
            }
            stddev = sqrt(sq_sum / n)
            
            printf "ğŸ“Š å¹³å‡è¯·æ±‚æ•°/åˆ†é’Ÿ: %.2f\n", avg
            printf "ğŸ“ˆ æ ‡å‡†å·®: %.2f\n", stddev
            printf "ğŸš¨ å¼‚å¸¸æ—¶é—´ç‚¹:\n"
            
            # æ‰¾å‡ºå¼‚å¸¸ç‚¹
            for (minute in count) {
                deviation = (count[minute] - avg) / stddev
                if (deviation > '$threshold' || deviation < -'$threshold') {
                    printf "%s: %dè¯·æ±‚ (%.2fÏƒ)\n", minute, count[minute], deviation
                }
            }
        }
    }' "$logfile"
}
```

### 3.4 å¤æ‚æ¨¡å¼è¯†åˆ«


**ğŸ¯ å¤šç»´åº¦æ¨¡å¼åˆ†æ**ï¼š
```bash
# è¯†åˆ«æ”»å‡»æ¨¡å¼
analyze_attack_patterns() {
    local logfile="$1"
    
    echo "ğŸ›¡ï¸ å®‰å…¨å¨èƒæ¨¡å¼åˆ†æ"
    echo "=================="
    
    # SQLæ³¨å…¥æ£€æµ‹
    echo "ğŸ’‰ æ½œåœ¨SQLæ³¨å…¥:"
    grep -i "union.*select\|drop.*table\|exec.*sp_" "$logfile" | \
    awk '{print $1, $7}' | sort | uniq -c | sort -nr | head -5
    
    # æš´åŠ›ç ´è§£æ£€æµ‹
    echo -e "\nğŸ”“ æš´åŠ›ç ´è§£å°è¯•:"
    grep " 401 \| 403 " "$logfile" | \
    awk '{print $1}' | sort | uniq -c | \
    awk '$1 >= 10 {print $1, $2}' | sort -nr
    
    # å¼‚å¸¸User-Agent
    echo -e "\nğŸ¤– å¯ç–‘User-Agent:"
    awk -F'"' '$6 ~ /bot|crawler|scanner/ {print $6}' "$logfile" | \
    sort | uniq -c | sort -nr | head -5
}
```

---

## 4. âš¡ æ€§èƒ½æ•°æ®æå–åˆ†æ


### 4.1 æ€§èƒ½æ•°æ®æå–åŸºç¡€


**ğŸ”¸ ä»€ä¹ˆæ˜¯æ€§èƒ½æ•°æ®æå–**ï¼š
å°±æ˜¯ä»æ—¥å¿—ã€ç›‘æ§æ–‡ä»¶ä¸­**æå–å…³é”®çš„æ€§èƒ½æŒ‡æ ‡**ï¼Œæ¯”å¦‚å“åº”æ—¶é—´ã€å†…å­˜ä½¿ç”¨ç‡ç­‰ï¼Œå°±åƒä»ä½“æ£€æŠ¥å‘Šä¸­æå–å…³é”®å¥åº·æŒ‡æ ‡ã€‚

```
å¸¸è§æ€§èƒ½æŒ‡æ ‡ï¼š
â±ï¸ å“åº”æ—¶é—´ - ç³»ç»Ÿå¤„ç†è¯·æ±‚çš„é€Ÿåº¦
ğŸ’¾ å†…å­˜ä½¿ç”¨ - ç³»ç»Ÿå†…å­˜å ç”¨æƒ…å†µ
ğŸ”„ CPUè´Ÿè½½ - å¤„ç†å™¨å·¥ä½œå¼ºåº¦
ğŸŒ ç½‘ç»œæµé‡ - æ•°æ®ä¼ è¾“é‡
```

### 4.2 å“åº”æ—¶é—´åˆ†æ


**ğŸ“Š åŸºç¡€å“åº”æ—¶é—´æå–**ï¼š
```bash
# ä»Apacheæ—¥å¿—æå–å“åº”æ—¶é—´ï¼ˆå‡è®¾æœ€åä¸€åˆ—æ˜¯å“åº”æ—¶é—´ï¼‰
awk '{print $NF}' access.log | grep -E '^[0-9]+$' | sort -n > response_times.txt

# è®¡ç®—å“åº”æ—¶é—´ç»Ÿè®¡
analyze_response_time() {
    local logfile="$1"
    
    echo "â±ï¸ å“åº”æ—¶é—´åˆ†ææŠ¥å‘Š"
    echo "=================="
    
    awk '{
        if ($NF ~ /^[0-9]+$/) {
            times[NR] = $NF
            sum += $NF
            count++
        }
    }
    END {
        if (count > 0) {
            # è®¡ç®—åŸºæœ¬ç»Ÿè®¡
            avg = sum / count
            
            # æ’åºæ‰¾ä¸­ä½æ•°å’Œç™¾åˆ†ä½
            n = asort(times)
            median = (n % 2) ? times[(n+1)/2] : (times[n/2] + times[n/2+1]) / 2
            p95 = times[int(n * 0.95)]
            p99 = times[int(n * 0.99)]
            
            printf "ğŸ“Š è¯·æ±‚æ€»æ•°: %d\n", count
            printf "âš¡ å¹³å‡å“åº”æ—¶é—´: %.2f ms\n", avg
            printf "ğŸ“ ä¸­ä½æ•°: %.0f ms\n", median
            printf "ğŸ“ˆ 95%%ç™¾åˆ†ä½: %.0f ms\n", p95
            printf "ğŸ”¥ 99%%ç™¾åˆ†ä½: %.0f ms\n", p99
            printf "âš ï¸ æœ€å¤§å“åº”æ—¶é—´: %.0f ms\n", times[n]
        }
    }' "$logfile"
}
```

### 4.3 ç³»ç»Ÿæ€§èƒ½ç›‘æ§æ•°æ®æå–


**ğŸ–¥ï¸ CPUå’Œå†…å­˜æ•°æ®æå–**ï¼š
```bash
# ä»topè¾“å‡ºä¸­æå–CPUå’Œå†…å­˜ä¿¡æ¯
extract_system_metrics() {
    local logfile="$1"
    
    echo "ğŸ–¥ï¸ ç³»ç»Ÿæ€§èƒ½æ•°æ®æå–"
    echo "=================="
    
    # æå–CPUä½¿ç”¨ç‡
    echo "ğŸ’» CPUä½¿ç”¨ç‡è¶‹åŠ¿:"
    grep "Cpu(s)" "$logfile" | \
    sed 's/.*: *\([0-9.]*\)%us.*/\1/' | \
    awk '{
        sum += $1; count++; 
        if ($1 > max) max = $1
        if (min == "" || $1 < min) min = $1
    } 
    END {
        if (count > 0) {
            printf "å¹³å‡: %.1f%% | æœ€é«˜: %.1f%% | æœ€ä½: %.1f%%\n", sum/count, max, min
        }
    }'
    
    # æå–å†…å­˜ä½¿ç”¨ç‡
    echo -e "\nğŸ’¾ å†…å­˜ä½¿ç”¨è¶‹åŠ¿:"
    grep "KiB Mem" "$logfile" | \
    awk '{
        total = $4; used = $8
        if (total > 0) {
            usage = (used / total) * 100
            printf "%.1f%% ", usage
            count++; sum += usage
        }
    } 
    END {
        if (count > 0) printf "\nå¹³å‡å†…å­˜ä½¿ç”¨ç‡: %.1f%%\n", sum/count
    }'
}
```

### 4.4 ç½‘ç»œæ€§èƒ½åˆ†æ


**ğŸŒ ç½‘ç»œæµé‡æ•°æ®æå–**ï¼š
```bash
# åˆ†æç½‘ç»œè®¿é—®æ¨¡å¼
analyze_network_performance() {
    local logfile="$1"
    
    echo "ğŸŒ ç½‘ç»œæ€§èƒ½åˆ†æ"
    echo "=================="
    
    # åˆ†æè¯·æ±‚å¤§å°åˆ†å¸ƒ
    echo "ğŸ“Š è¯·æ±‚å¤§å°åˆ†å¸ƒ:"
    awk '{
        size = $10  # å‡è®¾ç¬¬10åˆ—æ˜¯å“åº”å¤§å°
        if (size ~ /^[0-9]+$/) {
            if (size < 1024) small++
            else if (size < 10240) medium++
            else if (size < 102400) large++
            else huge++
            total_size += size
            count++
        }
    }
    END {
        if (count > 0) {
            printf "ğŸ”¹ å°æ–‡ä»¶ (<1KB): %d (%.1f%%)\n", small, small*100/count
            printf "ğŸ”¸ ä¸­ç­‰æ–‡ä»¶ (1-10KB): %d (%.1f%%)\n", medium, medium*100/count  
            printf "ğŸ”¶ å¤§æ–‡ä»¶ (10-100KB): %d (%.1f%%)\n", large, large*100/count
            printf "ğŸ”º è¶…å¤§æ–‡ä»¶ (>100KB): %d (%.1f%%)\n", huge, huge*100/count
            printf "ğŸ“ˆ å¹³å‡æ–‡ä»¶å¤§å°: %.2f KB\n", total_size/count/1024
        }
    }' "$logfile"
    
    # åˆ†æå¸¦å®½ä½¿ç”¨
    echo -e "\nğŸš€ å¸¦å®½ä½¿ç”¨åˆ†æ:"
    awk '{
        if ($10 ~ /^[0-9]+$/ && $4 ~ /\[([^]]+)\]/) {
            # æŒ‰åˆ†é’Ÿç»Ÿè®¡æµé‡
            minute = substr($4, 2, 16)  # æå–åˆ°åˆ†é’Ÿ
            bandwidth[minute] += $10
        }
    }
    END {
        max_bandwidth = 0
        for (minute in bandwidth) {
            kb_per_min = bandwidth[minute] / 1024
            if (kb_per_min > max_bandwidth) max_bandwidth = kb_per_min
        }
        printf "å³°å€¼å¸¦å®½: %.2f KB/åˆ†é’Ÿ\n", max_bandwidth
    }' "$logfile"
}
```

---

## 5. âš™ï¸ é…ç½®æ–‡ä»¶è§£ææŠ€æœ¯


### 5.1 é…ç½®æ–‡ä»¶è§£æåŸºç¡€


**ğŸ”¸ ä»€ä¹ˆæ˜¯é…ç½®æ–‡ä»¶è§£æ**ï¼š
å°±æ˜¯ä»å„ç§é…ç½®æ–‡ä»¶ä¸­**æå–æœ‰ç”¨çš„è®¾ç½®ä¿¡æ¯**ï¼Œå°±åƒä»è¯´æ˜ä¹¦ä¸­æ‰¾åˆ°éœ€è¦çš„å‚æ•°è®¾ç½®ä¸€æ ·ã€‚

```
å¸¸è§é…ç½®æ–‡ä»¶æ ¼å¼ï¼š
ğŸ“„ INIæ ¼å¼ - Windowsé£æ ¼é…ç½®
ğŸ”§ YAMLæ ¼å¼ - ç°ä»£åº”ç”¨é…ç½®
âš™ï¸ JSONæ ¼å¼ - APIå’ŒWebé…ç½®
ğŸ“ Properties - Javaåº”ç”¨é…ç½®
```

### 5.2 INIæ ¼å¼é…ç½®è§£æ


**ğŸ“„ INIæ–‡ä»¶è§£æ**ï¼š
```bash
# parse_ini.sh - INIé…ç½®æ–‡ä»¶è§£æå™¨
parse_ini() {
    local ini_file="$1"
    local section="$2"
    local key="$3"
    
    if [[ -n "$section" && -n "$key" ]]; then
        # è·å–ç‰¹å®šé…ç½®å€¼
        awk -F '=' -v section="[$section]" -v key="$key" '
        $0 == section { in_section = 1; next }
        /^\[/ { in_section = 0 }
        in_section && $1 ~ "^"key"$" { 
            gsub(/^[ \t]+|[ \t]+$/, "", $2)
            print $2 
        }' "$ini_file"
    else
        # æ˜¾ç¤ºæ•´ä¸ªæ–‡ä»¶ç»“æ„
        echo "ğŸ“‹ é…ç½®æ–‡ä»¶ç»“æ„: $ini_file"
        echo "=================="
        
        awk '
        /^\[.*\]$/ { 
            section = $0
            gsub(/\[|\]/, "", section)
            printf "\nğŸ”§ [%s]\n", section
            next
        }
        /^[^#;]/ && /=/ {
            split($0, pair, "=")
            key = pair[1]; value = pair[2]
            gsub(/^[ \t]+|[ \t]+$/, "", key)
            gsub(/^[ \t]+|[ \t]+$/, "", value)
            printf "   %-20s = %s\n", key, value
        }' "$ini_file"
    fi
}

# ä½¿ç”¨ç¤ºä¾‹
# parse_ini config.ini database host  # è·å–æ•°æ®åº“ä¸»æœºè®¾ç½®
# parse_ini config.ini                # æ˜¾ç¤ºæ‰€æœ‰é…ç½®
```

### 5.3 YAMLæ–‡ä»¶è§£æ


**ğŸ“Š ç®€å•YAMLè§£æ**ï¼š
```bash
# ç®€å•çš„YAMLå€¼æå–ï¼ˆé€‚ç”¨äºç®€å•ç»“æ„ï¼‰
get_yaml_value() {
    local yaml_file="$1"
    local key="$2"
    
    # å¤„ç†ç®€å•çš„key: valueæ ¼å¼
    awk -F': ' -v key="$key" '$1 == key {print $2}' "$yaml_file" | \
    sed 's/^["'"'"']//; s/["'"'"']$//'  # å»æ‰å¼•å·
}

# åˆ†æYAMLæ–‡ä»¶ç»“æ„
analyze_yaml_structure() {
    local yaml_file="$1"
    
    echo "ğŸ“Š YAMLæ–‡ä»¶ç»“æ„åˆ†æ"
    echo "=================="
    
    awk '
    /^[^ #].*:/ {
        level = 0
        indent = ""
        printf "%sğŸ”§ %s\n", indent, $0
    }
    /^  [^ ].*:/ {
        level = 1  
        indent = "  "
        printf "%sğŸ”¸ %s\n", indent, $0
    }
    /^    [^ ].*:/ {
        level = 2
        indent = "    "
        printf "%sğŸ”¹ %s\n", indent, $0
    }' "$yaml_file"
}
```

### 5.4 JSONé…ç½®è§£æ


**ğŸ”„ JSONæ•°æ®æå–ï¼ˆä¸ä½¿ç”¨jqçš„æƒ…å†µï¼‰**ï¼š
```bash
# ç®€å•JSONè§£æï¼ˆåŸºç¡€ç‰ˆï¼‰
extract_json_field() {
    local json_file="$1"
    local field="$2"
    
    grep -o "\"$field\"[[:space:]]*:[[:space:]]*\"[^\"]*\"" "$json_file" | \
    cut -d'"' -f4
}

# JSONç»“æ„åˆ†æ
analyze_json_config() {
    local json_file="$1"
    
    echo "ğŸ“„ JSONé…ç½®åˆ†æ"
    echo "=================="
    
    # æå–æ‰€æœ‰é”®å
    echo "ğŸ”‘ å‘ç°çš„é…ç½®é¡¹:"
    grep -o '"[^"]*"[[:space:]]*:' "$json_file" | \
    sed 's/[": ]//g' | sort | uniq | \
    while read key; do
        value=$(extract_json_field "$json_file" "$key")
        printf "   %-20s = %s\n" "$key" "$value"
    done
}
```

### 5.5 æ‰¹é‡é…ç½®æ–‡ä»¶å¤„ç†


**ğŸ“ é…ç½®æ–‡ä»¶æ‰¹é‡åˆ†æ**ï¼š
```bash
# æ‰¹é‡é…ç½®æ–‡ä»¶æ£€æŸ¥
check_configs() {
    local config_dir="$1"
    
    echo "ğŸ” æ‰¹é‡é…ç½®æ£€æŸ¥: $config_dir"
    echo "=================="
    
    find "$config_dir" -type f \( -name "*.conf" -o -name "*.cfg" -o -name "*.ini" \) | \
    while read config_file; do
        echo "ğŸ“„ æ£€æŸ¥æ–‡ä»¶: $(basename $config_file)"
        
        # æ£€æŸ¥è¯­æ³•é”™è¯¯
        if grep -q "^[^#=]*=[^=]*=" "$config_file"; then
            echo "   âš ï¸  å¯èƒ½çš„è¯­æ³•é”™è¯¯ï¼ˆå¤šä¸ªç­‰å·ï¼‰"
        fi
        
        # æ£€æŸ¥ç©ºå€¼é…ç½®
        if grep -q "^[^#]*=\s*$" "$config_file"; then
            echo "   ğŸ”¹ å‘ç°ç©ºå€¼é…ç½®:"
            grep "^[^#]*=\s*$" "$config_file" | head -3
        fi
        
        # ç»Ÿè®¡é…ç½®é¡¹æ•°é‡
        config_count=$(grep -c "^[^#]*=" "$config_file")
        echo "   ğŸ“Š é…ç½®é¡¹æ•°é‡: $config_count"
        echo ""
    done
}
```

---

## 6. ğŸš¨ é”™è¯¯ä¿¡æ¯è¿‡æ»¤æŠ€æœ¯


### 6.1 é”™è¯¯ä¿¡æ¯è¿‡æ»¤åŸºç¡€


**ğŸ”¸ ä»€ä¹ˆæ˜¯é”™è¯¯ä¿¡æ¯è¿‡æ»¤**ï¼š
å°±æ˜¯ä»å¤§é‡æ—¥å¿—ä¸­**å¿«é€Ÿæ‰¾åˆ°çœŸæ­£é‡è¦çš„é”™è¯¯ä¿¡æ¯**ï¼Œå°±åƒåœ¨å™ªéŸ³ä¸­æ‰¾åˆ°é‡è¦ä¿¡å·ä¸€æ ·ã€‚

```
é”™è¯¯çº§åˆ«åˆ†ç±»ï¼š
ğŸ”¥ FATAL - è‡´å‘½é”™è¯¯ï¼Œç³»ç»Ÿæ— æ³•ç»§ç»­
âŒ ERROR - æ™®é€šé”™è¯¯ï¼Œå½±å“åŠŸèƒ½
âš ï¸  WARN  - è­¦å‘Šä¿¡æ¯ï¼Œéœ€è¦æ³¨æ„
â„¹ï¸  INFO  - ä¸€èˆ¬ä¿¡æ¯ï¼Œæ­£å¸¸è¿è¡Œ
```

### 6.2 åŸºç¡€é”™è¯¯è¿‡æ»¤


**ğŸ” ç®€å•é”™è¯¯æå–**ï¼š
```bash
# æå–æ‰€æœ‰é”™è¯¯ä¿¡æ¯
grep -i "error\|fatal\|critical\|exception" app.log

# æŒ‰é”™è¯¯çº§åˆ«åˆ†ç±»
filter_by_level() {
    local logfile="$1"
    
    echo "ğŸš¨ é”™è¯¯ä¿¡æ¯åˆ†ç±»ç»Ÿè®¡"
    echo "=================="
    
    echo "ğŸ”¥ è‡´å‘½é”™è¯¯ (FATAL):"
    grep -i "fatal\|critical" "$logfile" | wc -l | \
    awk '{printf "   å‘ç° %d æ¡è‡´å‘½é”™è¯¯\n", $1}'
    
    echo "âŒ ä¸€èˆ¬é”™è¯¯ (ERROR):"
    grep -i "error" "$logfile" | grep -vi "fatal\|critical" | wc -l | \
    awk '{printf "   å‘ç° %d æ¡ä¸€èˆ¬é”™è¯¯\n", $1}'
    
    echo "âš ï¸  è­¦å‘Šä¿¡æ¯ (WARN):"
    grep -i "warn\|warning" "$logfile" | wc -l | \
    awk '{printf "   å‘ç° %d æ¡è­¦å‘Šä¿¡æ¯\n", $1}'
}
```

### 6.3 æ™ºèƒ½é”™è¯¯åˆ†æ


**ğŸ§  é”™è¯¯æ¨¡å¼è¯†åˆ«**ï¼š
```bash
# æ™ºèƒ½é”™è¯¯åˆ†æå™¨
analyze_errors() {
    local logfile="$1"
    local time_window="${2:-60}"  # æ—¶é—´çª—å£ï¼ˆåˆ†é’Ÿï¼‰
    
    echo "ğŸ” æ™ºèƒ½é”™è¯¯åˆ†æ"
    echo "æ—¶é—´çª—å£: ${time_window}åˆ†é’Ÿ"
    echo "=================="
    
    # é”™è¯¯é¢‘ç‡åˆ†æ
    echo "ğŸ“Š é”™è¯¯é¢‘ç‡åˆ†æ:"
    grep -i "error\|exception\|fatal" "$logfile" | \
    awk '{
        # æå–æ—¶é—´æˆ³ï¼ˆå‡è®¾æ ¼å¼ï¼š2024-01-01 12:30:45ï¼‰
        if (match($0, /[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}/, time_match)) {
            minute = time_match[0]
            gsub(/:[0-9]{2}$/, "", minute)  # å»æ‰ç§’ï¼ŒæŒ‰åˆ†é’Ÿç»Ÿè®¡
            error_count[minute]++
        }
    }
    END {
        # æ‰¾å‡ºé”™è¯¯é«˜å³°æ—¶æ®µ
        max_errors = 0
        for (minute in error_count) {
            if (error_count[minute] > max_errors) {
                max_errors = error_count[minute]
                peak_time = minute
            }
        }
        
        if (max_errors > 0) {
            printf "ğŸ”¥ é”™è¯¯é«˜å³°æ—¶æ®µ: %s (%dæ¡é”™è¯¯)\n", peak_time, max_errors
            
            # æ˜¾ç¤ºé”™è¯¯é¢‘ç‡è¶…è¿‡é˜ˆå€¼çš„æ—¶æ®µ
            printf "\nâš ï¸  å¼‚å¸¸æ—¶æ®µ (>5æ¡é”™è¯¯/åˆ†é’Ÿ):\n"
            for (minute in error_count) {
                if (error_count[minute] > 5) {
                    printf "   %s: %dæ¡\n", minute, error_count[minute]
                }
            }
        }
    }'
}
```

### 6.4 é”™è¯¯ä¿¡æ¯èšåˆ


**ğŸ“‹ ç›¸ä¼¼é”™è¯¯å½’ç±»**ï¼š
```bash
# é”™è¯¯ä¿¡æ¯èšåˆåˆ†æ
group_similar_errors() {
    local logfile="$1"
    
    echo "ğŸ“‹ é”™è¯¯ä¿¡æ¯èšåˆåˆ†æ"
    echo "=================="
    
    # æå–é”™è¯¯ä¿¡æ¯å¹¶ç®€åŒ–ï¼ˆå»æ‰å˜é‡éƒ¨åˆ†ï¼‰
    grep -i "error\|exception" "$logfile" | \
    sed 's/[0-9]\{4\}-[0-9]\{2\}-[0-9]\{2\} [0-9]\{2\}:[0-9]\{2\}:[0-9]\{2\}//g' | \
    sed 's/[0-9]\+/XXX/g' | \
    sed 's/[a-fA-F0-9]\{8\}-[a-fA-F0-9]\{4\}-[a-fA-F0-9]\{4\}-[a-fA-F0-9]\{4\}-[a-fA-F0-9]\{12\}/UUID/g' | \
    sort | uniq -c | sort -nr | head -10 | \
    awk '{
        count = $1
        $1 = ""  # å»æ‰è®¡æ•°
        error_msg = substr($0, 2)  # å»æ‰å‰å¯¼ç©ºæ ¼
        printf "%3dæ¬¡ | %s\n", count, substr(error_msg, 1, 80)
    }'
}
```

### 6.5 é”™è¯¯æŠ¥å‘Šç”Ÿæˆ


**ğŸ“Š è‡ªåŠ¨é”™è¯¯æŠ¥å‘Š**ï¼š
```bash
# ç”Ÿæˆé”™è¯¯æŠ¥å‘Š
generate_error_report() {
    local logfile="$1"
    local output_file="${2:-error_report.txt}"
    
    {
        echo "ğŸš¨ é”™è¯¯åˆ†ææŠ¥å‘Š"
        echo "ç”Ÿæˆæ—¶é—´: $(date)"
        echo "æ—¥å¿—æ–‡ä»¶: $logfile"
        echo "=================================="
        echo ""
        
        # é”™è¯¯æ€»è§ˆ
        echo "ğŸ“Š é”™è¯¯æ€»è§ˆ:"
        total_errors=$(grep -i "error\|fatal\|exception" "$logfile" | wc -l)
        echo "   æ€»é”™è¯¯æ•°: $total_errors"
        
        # æŒ‰ç±»å‹ç»Ÿè®¡
        echo ""
        echo "ğŸ“ˆ æŒ‰ç±»å‹ç»Ÿè®¡:"
        echo "   æ•°æ®åº“é”™è¯¯: $(grep -i "database\|sql\|connection" "$logfile" | wc -l)"
        echo "   ç½‘ç»œé”™è¯¯: $(grep -i "network\|timeout\|connection" "$logfile" | wc -l)"
        echo "   æƒé™é”™è¯¯: $(grep -i "permission\|access\|denied" "$logfile" | wc -l)"
        echo "   å†…å­˜é”™è¯¯: $(grep -i "memory\|heap\|outofmemory" "$logfile" | wc -l)"
        
        # æœ€é¢‘ç¹çš„é”™è¯¯
        echo ""
        echo "ğŸ”¥ æœ€é¢‘ç¹çš„é”™è¯¯:"
        group_similar_errors "$logfile" | head -5
        
        # é”™è¯¯æ—¶é—´åˆ†å¸ƒ
        echo ""
        echo "â° é”™è¯¯æ—¶é—´åˆ†å¸ƒ:"
        analyze_errors "$logfile"
        
    } > "$output_file"
    
    echo "ğŸ“„ é”™è¯¯æŠ¥å‘Šå·²ç”Ÿæˆ: $output_file"
}
```

---

## 7. ğŸ² æ•°æ®é‡‡æ ·æŠ€æœ¯


### 7.1 æ•°æ®é‡‡æ ·åŸºç¡€


**ğŸ”¸ ä»€ä¹ˆæ˜¯æ•°æ®é‡‡æ ·**ï¼š
å°±æ˜¯ä»å¤§é‡æ•°æ®ä¸­**é€‰å–æœ‰ä»£è¡¨æ€§çš„ä¸€éƒ¨åˆ†**è¿›è¡Œåˆ†æï¼Œå°±åƒæ°‘è°ƒä¸­é€‰æ‹©æ ·æœ¬äººç¾¤ä¸€æ ·ï¼Œæ—¢èŠ‚çœæ—¶é—´åˆèƒ½å¾—åˆ°æœ‰ç”¨ä¿¡æ¯ã€‚

```
é‡‡æ ·çš„å¥½å¤„ï¼š
âš¡ æé«˜å¤„ç†é€Ÿåº¦ - åˆ†æå°æ•°æ®é›†æ›´å¿«
ğŸ’¾ èŠ‚çœå­˜å‚¨ç©ºé—´ - åªä¿ç•™å¿…è¦æ•°æ®
ğŸ¯ ä¿æŒä»£è¡¨æ€§ - æ ·æœ¬èƒ½åæ˜ æ•´ä½“æƒ…å†µ
```

### 7.2 éšæœºé‡‡æ ·æŠ€æœ¯


**ğŸ² åŸºç¡€éšæœºé‡‡æ ·**ï¼š
```bash
# éšæœºé‡‡æ ·æŒ‡å®šè¡Œæ•°
random_sample() {
    local input_file="$1"
    local sample_size="${2:-1000}"
    
    total_lines=$(wc -l < "$input_file")
    
    if (( sample_size >= total_lines )); then
        echo "ğŸ“Š æ–‡ä»¶è¡Œæ•°å°äºé‡‡æ ·æ•°ï¼Œè¿”å›å…¨éƒ¨å†…å®¹"
        cat "$input_file"
    else
        echo "ğŸ² ä» $total_lines è¡Œä¸­éšæœºé‡‡æ · $sample_size è¡Œ"
        shuf -n "$sample_size" "$input_file"
    fi
}

# æŒ‰æ¯”ä¾‹é‡‡æ ·
percentage_sample() {
    local input_file="$1"
    local percentage="${2:-10}"  # é»˜è®¤é‡‡æ ·10%
    
    echo "ğŸ“Š æŒ‰ ${percentage}% æ¯”ä¾‹é‡‡æ ·"
    
    # ä½¿ç”¨awkå®ç°ç™¾åˆ†æ¯”é‡‡æ ·
    awk -v percent="$percentage" '
    BEGIN { srand(); threshold = percent/100 }
    rand() < threshold { print }
    ' "$input_file"
}
```

### 7.3 æ—¶é—´çª—å£é‡‡æ ·


**â° åŸºäºæ—¶é—´çš„é‡‡æ ·**ï¼š
```bash
# æ—¶é—´çª—å£é‡‡æ ·
time_window_sample() {
    local logfile="$1"
    local interval="${2:-300}"  # æ—¶é—´é—´éš”ï¼ˆç§’ï¼‰
    
    echo "â° æ—¶é—´çª—å£é‡‡æ ·ï¼Œé—´éš”: ${interval}ç§’"
    echo "=================="
    
    awk -v interval="$interval" '
    BEGIN {
        last_time = 0
    }
    {
        # æå–æ—¶é—´æˆ³ï¼ˆå‡è®¾æ ¼å¼ï¼š[dd/Mon/yyyy:hh:mm:ss +0000]ï¼‰
        if (match($0, /\[([^]]+)\]/, time_match)) {
            time_str = time_match[1]
            
            # ç®€åŒ–ï¼šåªæå–å°æ—¶å’Œåˆ†é’Ÿè½¬æ¢ä¸ºç§’æ•°
            if (match(time_str, /([0-9]+):([0-9]+):([0-9]+)/, time_parts)) {
                current_seconds = time_parts[1]*3600 + time_parts[2]*60 + time_parts[3]
                
                if (current_seconds - last_time >= interval || last_time == 0) {
                    print
                    last_time = current_seconds
                }
            }
        }
    }' "$logfile"
}

# æ¯å°æ—¶é‡‡æ ·
hourly_sample() {
    local logfile="$1"
    
    echo "ğŸ“… æ¯å°æ—¶é‡‡æ ·ï¼ˆå–æ¯å°æ—¶ç¬¬ä¸€æ¡è®°å½•ï¼‰"
    
    awk '
    {
        # æå–å°æ—¶ä¿¡æ¯
        if (match($0, /[0-9]{2}:([0-9]{2}):/, hour_match)) {
            hour = hour_match[1]
            if (!seen[hour]) {
                seen[hour] = 1
                print
            }
        }
    }' "$logfile"
}
```

### 7.4 åˆ†å±‚é‡‡æ ·


**ğŸ¯ åˆ†å±‚æŠ½æ ·æŠ€æœ¯**ï¼š
```bash
# æŒ‰çŠ¶æ€ç åˆ†å±‚é‡‡æ ·
stratified_sample() {
    local logfile="$1"
    local samples_per_group="${2:-100}"
    
    echo "ğŸ¯ æŒ‰HTTPçŠ¶æ€ç åˆ†å±‚é‡‡æ ·"
    echo "æ¯ç»„é‡‡æ ·: $samples_per_group æ¡"
    echo "=================="
    
    # åˆ›å»ºä¸´æ—¶ç›®å½•
    temp_dir=$(mktemp -d)
    
    # æŒ‰çŠ¶æ€ç åˆ†ç»„
    awk '{
        status = $9  # å‡è®¾ç¬¬9åˆ—æ˜¯çŠ¶æ€ç 
        if (status ~ /^[0-9]+$/) {
            file = "'$temp_dir'/status_" status ".txt"
            print >> file
        }
    }' "$logfile"
    
    # ä»æ¯ç»„ä¸­é‡‡æ ·
    for status_file in "$temp_dir"/status_*.txt; do
        if [[ -f "$status_file" ]]; then
            status=$(basename "$status_file" .txt | cut -d'_' -f2)
            echo "ğŸ“Š çŠ¶æ€ç  $status:"
            
            total=$(wc -l < "$status_file")
            echo "   æ€»æ•°: $total"
            
            if (( total > samples_per_group )); then
                echo "   é‡‡æ ·: $samples_per_group"
                shuf -n "$samples_per_group" "$status_file"
            else
                echo "   å…¨éƒ¨: $total"
                cat "$status_file"
            fi
            echo ""
        fi
    done
    
    # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
    rm -rf "$temp_dir"
}
```

### 7.5 è‡ªé€‚åº”é‡‡æ ·


**ğŸ§  æ™ºèƒ½é‡‡æ ·ç®—æ³•**ï¼š
```bash
# è‡ªé€‚åº”é‡‡æ ·ï¼ˆæ ¹æ®æ•°æ®ç‰¹å¾è°ƒæ•´é‡‡æ ·ç‡ï¼‰
adaptive_sample() {
    local logfile="$1"
    local base_rate="${2:-0.1}"  # åŸºç¡€é‡‡æ ·ç‡
    
    echo "ğŸ§  è‡ªé€‚åº”é‡‡æ ·åˆ†æ"
    echo "åŸºç¡€é‡‡æ ·ç‡: $(echo "$base_rate * 100" | bc)%"
    echo "=================="
    
    awk -v base_rate="$base_rate" '
    BEGIN { 
        srand()
        error_boost = 5.0    # é”™è¯¯è®°å½•æå‡å€æ•°
        normal_rate = base_rate
    }
    {
        # æ ¹æ®å†…å®¹è°ƒæ•´é‡‡æ ·ç‡
        sample_rate = normal_rate
        
        # é”™è¯¯æ—¥å¿—æé«˜é‡‡æ ·ç‡
        if (tolower($0) ~ /error|fatal|exception|critical/) {
            sample_rate = base_rate * error_boost
            if (sample_rate > 1.0) sample_rate = 1.0
        }
        
        # 4xx/5xxçŠ¶æ€ç æé«˜é‡‡æ ·ç‡  
        if ($9 ~ /^[45][0-9][0-9]$/) {
            sample_rate = base_rate * 3.0
            if (sample_rate > 1.0) sample_rate = 1.0
        }
        
        # æ‰§è¡Œé‡‡æ ·
        if (rand() < sample_rate) {
            print
        }
    }' "$logfile"
}
```

---

## 8. ğŸ“ æ‰¹é‡æ–‡æœ¬å¤„ç†æŠ€æœ¯


### 8.1 æ‰¹é‡æ–‡æœ¬å¤„ç†åŸºç¡€


**ğŸ”¸ ä»€ä¹ˆæ˜¯æ‰¹é‡æ–‡æœ¬å¤„ç†**ï¼š
å°±æ˜¯**åŒæ—¶å¤„ç†å¤šä¸ªæ–‡æœ¬æ–‡ä»¶**ï¼Œå°±åƒç”¨æ´—è¡£æœºåŒæ—¶æ´—å¤šä»¶è¡£æœä¸€æ ·ï¼Œæé«˜å·¥ä½œæ•ˆç‡ã€‚

```
å¸¸è§åº”ç”¨åœºæ™¯ï¼š
ğŸ“ æ—¥å¿—å½’æ¡£ - å¤„ç†å¤šå¤©çš„æ—¥å¿—æ–‡ä»¶
ğŸ”„ æ ¼å¼è½¬æ¢ - æ‰¹é‡è½¬æ¢æ–‡ä»¶æ ¼å¼
ğŸ“Š æ•°æ®èšåˆ - åˆå¹¶å¤šä¸ªæ•°æ®æº
ğŸ§¹ æ•°æ®æ¸…ç† - æ‰¹é‡æ¸…ç†æ— ç”¨ä¿¡æ¯
```

### 8.2 åŸºç¡€æ‰¹é‡å¤„ç†


**ğŸ“‚ ç®€å•æ‰¹é‡æ“ä½œ**ï¼š
```bash
# æ‰¹é‡æ–‡ä»¶ç»Ÿè®¡
batch_file_stats() {
    local directory="$1"
    local pattern="${2:-*.log}"
    
    echo "ğŸ“Š æ‰¹é‡æ–‡ä»¶ç»Ÿè®¡: $directory/$pattern"
    echo "=================================="
    
    find "$directory" -name "$pattern" -type f | while read file; do
        lines=$(wc -l < "$file")
        size=$(du -h "$file" | cut -f1)
        modified=$(stat -c %y "$file" | cut -d' ' -f1)
        
        printf "%-30s | %8sè¡Œ | %6s | %s\n" \
            "$(basename "$file")" "$lines" "$size" "$modified"
    done | sort -k4
}

# æ‰¹é‡å†…å®¹æœç´¢
batch_search() {
    local directory="$1"
    local pattern="$2"
    local search_term="$3"
    
    echo "ğŸ” æ‰¹é‡æœç´¢: '$search_term' åœ¨ $directory/$pattern"
    echo "=================================="
    
    find "$directory" -name "$pattern" -type f -exec grep -l "$search_term" {} \; | \
    while read file; do
        count=$(grep -c "$search_term" "$file")
        echo "ğŸ“„ $file: å‘ç° $count å¤„åŒ¹é…"
        
        # æ˜¾ç¤ºå‰3ä¸ªåŒ¹é…è¡Œ
        grep -n "$search_term" "$file" | head -3 | \
        sed 's/^/   /'
        echo ""
    done
}
```

### 8.3 å¹¶è¡Œæ‰¹é‡å¤„ç†


**âš¡ å¹¶è¡Œå¤„ç†åŠ é€Ÿ**ï¼š
```bash
# å¹¶è¡Œæ–‡æœ¬å¤„ç†
parallel_process() {
    local directory="$1"
    local pattern="$2"
    local operation="$3"
    local max_jobs="${4:-4}"  # æœ€å¤§å¹¶è¡Œä»»åŠ¡æ•°
    
    echo "âš¡ å¹¶è¡Œå¤„ç†: $max_jobs ä¸ªå¹¶è¡Œä»»åŠ¡"
    echo "æ“ä½œ: $operation"
    echo "=================================="
    
    # åˆ›å»ºä»»åŠ¡åˆ—è¡¨
    find "$directory" -name "$pattern" -type f > /tmp/file_list.txt
    
    # å¹¶è¡Œå¤„ç†å‡½æ•°
    process_single_file() {
        local file="$1"
        local op="$2"
        
        case "$op" in
            "wordcount")
                wc -w "$file" | awk '{printf "%s: %d words\n", "'$file'", $1}'
                ;;
            "linecount")
                wc -l "$file" | awk '{printf "%s: %d lines\n", "'$file'", $1}'
                ;;
            "compress")
                gzip -c "$file" > "${file}.gz"
                echo "å‹ç¼©å®Œæˆ: ${file}.gz"
                ;;
            *)
                echo "æœªçŸ¥æ“ä½œ: $op"
                ;;
        esac
    }
    
    # å¯¼å‡ºå‡½æ•°ä¾›å¹¶è¡Œä½¿ç”¨
    export -f process_single_file
    
    # ä½¿ç”¨xargså®ç°å¹¶è¡Œå¤„ç†
    cat /tmp/file_list.txt | \
    xargs -I {} -P "$max_jobs" bash -c 'process_single_file "$1" "$2"' _ {} "$operation"
    
    rm -f /tmp/file_list.txt
}
```

### 8.4 æ‰¹é‡æ•°æ®èšåˆ


**ğŸ“Š å¤šæ–‡ä»¶æ•°æ®åˆå¹¶**ï¼š
```bash
# æ—¥å¿—æ•°æ®èšåˆåˆ†æ
aggregate_logs() {
    local log_dir="$1"
    local output_file="${2:-aggregate_report.txt}"
    
    echo "ğŸ“Š æ‰¹é‡æ—¥å¿—èšåˆåˆ†æ"
    echo "è¾“å‡ºæ–‡ä»¶: $output_file"
    echo "=================================="
    
    {
        echo "ğŸ“‹ æ—¥å¿—èšåˆæŠ¥å‘Š"
        echo "ç”Ÿæˆæ—¶é—´: $(date)"
        echo "æ—¥å¿—ç›®å½•: $log_dir"
        echo "=================================="
        echo ""
        
        # æ€»ä½“ç»Ÿè®¡
        echo "ğŸ“ˆ æ€»ä½“ç»Ÿè®¡:"
        total_files=$(find "$log_dir" -name "*.log" -type f | wc -l)
        total_lines=$(find "$log_dir" -name "*.log" -type f -exec wc -l {} + | tail -1 | awk '{print $1}')
        echo "   æ—¥å¿—æ–‡ä»¶æ•°: $total_files"
        echo "   æ€»è¡Œæ•°: $total_lines"
        echo ""
        
        # é”™è¯¯ç»Ÿè®¡
        echo "ğŸš¨ é”™è¯¯ç»Ÿè®¡:"
        find "$log_dir" -name "*.log" -type f -exec grep -h -i "error\|fatal" {} \; | \
        wc -l | awk '{print "   æ€»é”™è¯¯æ•°: " $1}'
        echo ""
        
        # è®¿é—®ç»Ÿè®¡ï¼ˆå‡è®¾æ˜¯webæ—¥å¿—ï¼‰
        echo "ğŸŒ è®¿é—®ç»Ÿè®¡:"
        find "$log_dir" -name "*.log" -type f -exec grep -h " GET \| POST " {} \; | \
        awk '{count[$6]++} END {
            for (method in count) 
                printf "   %s: %dæ¬¡\n", method, count[method]
        }' | sort -k2 -nr
        echo ""
        
        # IPç»Ÿè®¡
        echo "ğŸ” çƒ­é—¨IP (å‰10):"
        find "$log_dir" -name "*.log" -type f -exec awk '{print $1}' {} \; | \
        sort | uniq -c | sort -nr | head -10 | \
        awk '{printf "   %15s: %dæ¬¡è®¿é—®\n", $2, $1}'
        
    } > "$output_file"
    
    echo "âœ… èšåˆæŠ¥å‘Šç”Ÿæˆå®Œæˆ: $output_file"
}
```

### 8.5 æ‰¹é‡æ–‡ä»¶è½¬æ¢


**ğŸ”„ æ ¼å¼æ‰¹é‡è½¬æ¢**ï¼š
```bash
# æ‰¹é‡æ—¥å¿—æ ¼å¼è½¬æ¢
batch_convert_logs() {
    local source_dir="$1"
    local target_dir="$2"
    local source_format="${3:-apache}"
    local target_format="${4:-json}"
    
    echo "ğŸ”„ æ‰¹é‡æ—¥å¿—æ ¼å¼è½¬æ¢"
    echo "æºç›®å½•: $source_dir ($source_format)"
    echo "ç›®æ ‡ç›®å½•: $target_dir ($target_format)"
    echo "=================================="
    
    # åˆ›å»ºç›®æ ‡ç›®å½•
    mkdir -p "$target_dir"
    
    find "$source_dir" -name "*.log" -type f | while read source_file; do
        filename=$(basename "$source_file" .log)
        target_file="$target_dir/${filename}.${target_format}"
        
        echo "ğŸ”„ è½¬æ¢: $filename"
        
        case "$source_format-$target_format" in
            "apache-json")
                # Apacheæ—¥å¿—è½¬JSON
                awk '{
                    printf "{"
                    printf "\"ip\":\"%s\",", $1
                    printf "\"method\":\"%s\",", $6
                    printf "\"url\":\"%s\",", $7
                    printf "\"status\":%s,", $9
                    printf "\"size\":%s", $10
                    printf "}\n"
                }' "$source_file" > "$target_file"
                ;;
            "apache-csv")
                # Apacheæ—¥å¿—è½¬CSV
                echo "IP,Method,URL,Status,Size" > "$target_file"
                awk '{
                    gsub(/[",]/, "", $7)  # æ¸…ç†URLä¸­çš„å¼•å·å’Œé€—å·
                    printf "%s,%s,%s,%s,%s\n", $1, $6, $7, $9, $10
                }' "$source_file" >> "$target_file"
                ;;
            *)
                echo "   âš ï¸  ä¸æ”¯æŒçš„è½¬æ¢: $source_format -> $target_format"
                continue
                ;;
        esac
        
        echo "   âœ… å®Œæˆ: $target_file"
    done
}
```

---

## 9. ğŸ“Š è‡ªåŠ¨åŒ–æŠ¥å‘Šç”Ÿæˆ


### 9.1 è‡ªåŠ¨åŒ–æŠ¥å‘ŠåŸºç¡€


**ğŸ”¸ ä»€ä¹ˆæ˜¯è‡ªåŠ¨åŒ–æŠ¥å‘Š**ï¼š
å°±æ˜¯**è®©ç³»ç»Ÿè‡ªåŠ¨åˆ†ææ•°æ®å¹¶ç”Ÿæˆæ ¼å¼åŒ–çš„æŠ¥å‘Š**ï¼Œå°±åƒè®©æœºå™¨äººå¸®ä½ å†™å·¥ä½œæ€»ç»“ä¸€æ ·ï¼Œçœæ—¶çœåŠ›ã€‚

```
æŠ¥å‘Šçš„ä»·å€¼ï¼š
ğŸ“Š æ•°æ®å¯è§†åŒ– - è®©æ•°å­—æ›´å®¹æ˜“ç†è§£
â° å®šæœŸç›‘æ§ - åŠæ—¶å‘ç°é—®é¢˜è¶‹åŠ¿
ğŸ“§ è‡ªåŠ¨é€šçŸ¥ - é‡è¦ä¿¡æ¯ä¸»åŠ¨æ¨é€
ğŸ“ˆ å†³ç­–æ”¯æŒ - ä¸ºç®¡ç†æä¾›æ•°æ®ä¾æ®
```

### 9.2 åŸºç¡€HTMLæŠ¥å‘Šç”Ÿæˆ


**ğŸ“„ ç”ŸæˆHTMLæ ¼å¼æŠ¥å‘Š**ï¼š
```bash
# HTMLæŠ¥å‘Šç”Ÿæˆå™¨
generate_html_report() {
    local data_source="$1"
    local report_title="${2:-ç³»ç»Ÿåˆ†ææŠ¥å‘Š}"
    local output_file="${3:-report.html}"
    
    echo "ğŸ“Š ç”ŸæˆHTMLæŠ¥å‘Š: $output_file"
    
    # åˆ›å»ºHTMLæŠ¥å‘Š
    cat > "$output_file" << EOF
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>$report_title</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; background-color: #f5f5f5; }
        .container { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        h2 { color: #34495e; margin-top: 30px; }
        .metric { background: #ecf0f1; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .error { background: #ffebee; border-left: 4px solid #f44336; }
        .warning { background: #fff3e0; border-left: 4px solid #ff9800; }
        .success { background: #e8f5e8; border-left: 4px solid #4caf50; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background-color: #f8f9fa; font-weight: bold; }
        .chart { background: #f8f9fa; padding: 20px; margin: 20px 0; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>$report_title</h1>
        <p><strong>ç”Ÿæˆæ—¶é—´:</strong> $(date '+%Y-%m-%d %H:%M:%S')</p>
        <p><strong>æ•°æ®æº:</strong> $data_source</p>
        
        <h2>ğŸ“Š æ ¸å¿ƒæŒ‡æ ‡</h2>
EOF
    
    # æ·»åŠ æ•°æ®åˆ†æå†…å®¹
    add_analysis_content "$data_source" >> "$output_file"
    
    # ç»“æŸHTML
    cat >> "$output_file" << EOF
    </div>
</body>
</html>
EOF
    
    echo "âœ… HTMLæŠ¥å‘Šç”Ÿæˆå®Œæˆ: $output_file"
}

# æ·»åŠ åˆ†æå†…å®¹
add_analysis_content() {
    local data_source="$1"
    
    # åŸºæœ¬ç»Ÿè®¡
    echo '<div class="metric success">'
    echo "<h3>ğŸ“ˆ åŸºæœ¬ç»Ÿè®¡</h3>"
    echo "<p>æ€»è®°å½•æ•°: $(wc -l < "$data_source")</p>"
    echo "<p>æ–‡ä»¶å¤§å°: $(du -h "$data_source" | cut -f1)</p>"
    echo "</div>"
    
    # é”™è¯¯åˆ†æ
    error_count=$(grep -c -i "error\|fatal" "$data_source" 2>/dev/null || echo "0")
    if (( error_count > 0 )); then
        echo '<div class="metric error">'
        echo "<h3>ğŸš¨ é”™è¯¯ä¿¡æ¯</h3>"
        echo "<p>å‘ç° $error_count æ¡é”™è¯¯è®°å½•</p>"
        echo "</div>"
    fi
    
    # ç”Ÿæˆç®€å•çš„è¡¨æ ¼
    echo "<h2>ğŸ“‹ è¯¦ç»†æ•°æ®</h2>"
    echo "<table>"
    echo "<tr><th>åºå·</th><th>æ—¶é—´</th><th>å†…å®¹æ‘˜è¦</th></tr>"
    
    head -10 "$data_source" | nl | while IFS=$'\t' read num line; do
        # ç®€å•çš„å†…å®¹æ‘˜è¦ï¼ˆå‰50å­—ç¬¦ï¼‰
        summary=$(echo "$line" | cut -c1-50)
        # å°è¯•æå–æ—¶é—´æˆ³
        timestamp=$(echo "$line" | grep -o '[0-9]\{4\}-[0-9]\{2\}-[0-9]\{2\} [0-9]\{2\}:[0-9]\{2\}:[0-9]\{2\}' | head -1)
        if [[ -z "$timestamp" ]]; then
            timestamp="æœªè¯†åˆ«"
        fi
        echo "<tr><td>$num</td><td>$timestamp</td><td>$summary...</td></tr>"
    done
    
    echo "</table>"
}
```

### 9.3 å®šæœŸæŠ¥å‘Šç”Ÿæˆ


**â° å®šæ—¶æŠ¥å‘Šç³»ç»Ÿ**ï¼š
```bash
# å®šæœŸæŠ¥å‘Šç”Ÿæˆè„šæœ¬
setup_scheduled_reports() {
    local log_dir="$1"
    local report_dir="${2:-/var/reports}"
    local email="${3:-admin@example.com}"
    
    echo "â° è®¾ç½®å®šæœŸæŠ¥å‘Šç³»ç»Ÿ"
    echo "æ—¥å¿—ç›®å½•: $log_dir"
    echo "æŠ¥å‘Šç›®å½•: $report_dir"
    echo "=================================="
    
    # åˆ›å»ºæŠ¥å‘Šç›®å½•
    mkdir -p "$report_dir"
    
    # åˆ›å»ºæ—¥æŠ¥ç”Ÿæˆè„šæœ¬
    cat > "$report_dir/generate_daily_report.sh" << 'EOF'
#!/bin/bash
# æ—¥æŠ¥ç”Ÿæˆè„šæœ¬

LOG_DIR="$1"
REPORT_DIR="$2"
EMAIL="$3"
DATE=$(date '+%Y-%m-%d')

echo "ğŸ“Š ç”Ÿæˆ $DATE æ—¥æŠ¥..."

# åˆ†ææ˜¨å¤©çš„æ—¥å¿—
yesterday=$(date -d "yesterday" '+%Y-%m-%d')
daily_log="$LOG_DIR/access_${yesterday}.log"

if [[ -f "$daily_log" ]]; then
    # ç”ŸæˆæŠ¥å‘Š
    report_file="$REPORT_DIR/daily_report_${DATE}.html"
    
    {
        echo "<!DOCTYPE html><html><head><title>æ—¥æŠ¥ $DATE</title>"
        echo "<style>body{font-family:Arial;margin:40px;} .metric{background:#f0f0f0;padding:10px;margin:10px 0;}</style></head><body>"
        echo "<h1>ğŸ“Š ç³»ç»Ÿæ—¥æŠ¥ - $DATE</h1>"
        
        # è®¿é—®ç»Ÿè®¡
        echo "<div class='metric'>"
        echo "<h2>ğŸŒ è®¿é—®ç»Ÿè®¡</h2>"
        echo "<p>æ€»è®¿é—®é‡: $(wc -l < "$daily_log")</p>"
        echo "<p>ç‹¬ç«‹IPæ•°: $(awk '{print $1}' "$daily_log" | sort | uniq | wc -l)</p>"
        echo "</div>"
        
        # é”™è¯¯ç»Ÿè®¡
        echo "<div class='metric'>"
        echo "<h2>ğŸš¨ é”™è¯¯ç»Ÿè®¡</h2>"
        error_count=$(grep -c " 404 \| 500 \| 503 " "$daily_log" || echo "0")
        echo "<p>é”™è¯¯è¯·æ±‚æ•°: $error_count</p>"
        echo "</div>"
        
        # çƒ­é—¨é¡µé¢
        echo "<div class='metric'>"
        echo "<h2>ğŸ”¥ çƒ­é—¨é¡µé¢ (å‰5)</h2>"
        echo "<ul>"
        awk '{print $7}' "$daily_log" | sort | uniq -c | sort -nr | head -5 | \
        while read count url; do
            echo "<li>$url - $count æ¬¡è®¿é—®</li>"
        done
        echo "</ul>"
        echo "</div>"
        
        echo "</body></html>"
    } > "$report_file"
    
    echo "âœ… æ—¥æŠ¥ç”Ÿæˆå®Œæˆ: $report_file"
    
    # å‘é€é‚®ä»¶ï¼ˆå¦‚æœé…ç½®äº†ï¼‰
    if command -v mail >/dev/null 2>&1 && [[ -n "$EMAIL" ]]; then
        {
            echo "æ—¥æŠ¥å·²ç”Ÿæˆï¼Œè¯·æŸ¥çœ‹é™„ä»¶ã€‚"
            echo ""
            echo "ç®€è¦ç»Ÿè®¡ï¼š"
            echo "è®¿é—®é‡: $(wc -l < "$daily_log")"
            echo "é”™è¯¯æ•°: $(grep -c " 404 \| 500 \| 503 " "$daily_log" || echo "0")"
        } | mail -s "ç³»ç»Ÿæ—¥æŠ¥ $DATE" -a "$report_file" "$EMAIL"
        echo "ğŸ“§ æ—¥æŠ¥å·²å‘é€è‡³: $EMAIL"
    fi
else
    echo "âš ï¸  æœªæ‰¾åˆ°æ˜¨å¤©çš„æ—¥å¿—æ–‡ä»¶: $daily_log"
fi
EOF
    
    chmod +x "$report_dir/generate_daily_report.sh"
    
    # æ·»åŠ åˆ°crontabï¼ˆæ¯å¤©æ—©ä¸Š8ç‚¹ç”ŸæˆæŠ¥å‘Šï¼‰
    echo "ğŸ“… æ·»åŠ å®šæ—¶ä»»åŠ¡..."
    echo "0 8 * * * $report_dir/generate_daily_report.sh $log_dir $report_dir $email" | crontab -
    
    echo "âœ… å®šæœŸæŠ¥å‘Šç³»ç»Ÿè®¾ç½®å®Œæˆ"
    echo "ğŸ“§ å°†åœ¨æ¯å¤©8:00è‡ªåŠ¨ç”Ÿæˆå¹¶å‘é€æ—¥æŠ¥"
}
```

### 9.4 äº¤äº’å¼æŠ¥å‘Šä»ªè¡¨æ¿


**ğŸ“Š ç®€å•çš„æ–‡æœ¬ä»ªè¡¨æ¿**ï¼š
```bash
# å®æ—¶ç›‘æ§ä»ªè¡¨æ¿
live_dashboard() {
    local log_file="$1"
    local refresh_interval="${2:-5}"
    
    while true; do
        clear
        echo "â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ"
        echo "          ğŸ–¥ï¸  å®æ—¶ç›‘æ§ä»ªè¡¨æ¿          "
        echo "â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ"
        echo "æ›´æ–°æ—¶é—´: $(date '+%H:%M:%S')"
        echo "åˆ·æ–°é—´éš”: ${refresh_interval}ç§’"
        echo "=========================================="
        
        # å®æ—¶ç»Ÿè®¡
        echo "ğŸ“Š å®æ—¶ç»Ÿè®¡ï¼š"
        echo "   æ€»è®°å½•æ•°: $(wc -l < "$log_file")"
        echo "   æ–‡ä»¶å¤§å°: $(du -h "$log_file" | cut -f1)"
        
        # æœ€è¿‘1åˆ†é’Ÿçš„æ´»åŠ¨
        echo ""
        echo "âš¡ æœ€è¿‘1åˆ†é’Ÿæ´»åŠ¨ï¼š"
        recent_lines=$(tail -100 "$log_file" | grep "$(date '+%H:%M')" | wc -l)
        echo "   æ–°å¢è®°å½•: $recent_lines"
        
        # é”™è¯¯ç›‘æ§
        echo ""
        echo "ğŸš¨ é”™è¯¯ç›‘æ§ï¼š"
        recent_errors=$(tail -1000 "$log_file" | grep -c -i "error\|fatal\|critical" || echo "0")
        echo "   æœ€è¿‘é”™è¯¯æ•°: $recent_errors"
        
        # ç³»ç»Ÿè´Ÿè½½ï¼ˆå¦‚æœå¯ç”¨ï¼‰
        if command -v uptime >/dev/null 2>&1; then
            echo ""
            echo "ğŸ–¥ï¸ ç³»ç»Ÿè´Ÿè½½ï¼š"
            uptime | awk '{print "   è´Ÿè½½: " $(NF-2) " " $(NF-1) " " $NF}'
        fi
        
        # TOP 5 æ´»è·ƒIP
        echo ""
        echo "ğŸŒ TOP 5 æ´»è·ƒIP (æœ€è¿‘1000è¡Œ)ï¼š"
        tail -1000 "$log_file" | awk '{print $1}' | sort | uniq -c | sort -nr | head -5 | \
        while read count ip; do
            printf "   %-15s: %dæ¬¡\n" "$ip" "$count"
        done
        
        echo "=========================================="
        echo "æŒ‰ Ctrl+C é€€å‡ºç›‘æ§"
        
        sleep "$refresh_interval"
    done
}
```

### 9.5 æŠ¥å‘Šæ¨¡æ¿ç³»ç»Ÿ


**ğŸ“‹ å¯å¤ç”¨çš„æŠ¥å‘Šæ¨¡æ¿**ï¼š
```bash
# æŠ¥å‘Šæ¨¡æ¿ç”Ÿæˆå™¨
create_report_template() {
    local template_name="$1"
    local template_dir="${2:-/etc/report_templates}"
    
    mkdir -p "$template_dir"
    
    case "$template_name" in
        "web_analytics")
            cat > "$template_dir/web_analytics.template" << 'EOF'
# Webè®¿é—®åˆ†ææŠ¥å‘Šæ¨¡æ¿
TITLE="Webè®¿é—®åˆ†ææŠ¥å‘Š"
SECTIONS="overview,traffic,errors,performance,security"

[overview]
name="æ€»è§ˆ"
queries="total_requests,unique_ips,date_range"

[traffic]  
name="æµé‡åˆ†æ"
queries="hourly_distribution,top_pages,referrers"

[errors]
name="é”™è¯¯åˆ†æ" 
queries="error_count,error_types,error_ips"

[performance]
name="æ€§èƒ½åˆ†æ"
queries="response_times,slow_requests,bandwidth"

[security]
name="å®‰å…¨åˆ†æ"
queries="suspicious_ips,attack_patterns,blocked_requests"
EOF
            ;;
            
        "system_health")
            cat > "$template_dir/system_health.template" << 'EOF'
# ç³»ç»Ÿå¥åº·æŠ¥å‘Šæ¨¡æ¿
TITLE="ç³»ç»Ÿå¥åº·æ£€æŸ¥æŠ¥å‘Š"
SECTIONS="resources,processes,network,storage"

[resources]
name="èµ„æºä½¿ç”¨"
queries="cpu_usage,memory_usage,load_average"

[processes]
name="è¿›ç¨‹çŠ¶æ€"
queries="process_count,zombie_processes,high_cpu_processes"

[network]
name="ç½‘ç»œçŠ¶æ€"
queries="connections,bandwidth_usage,packet_loss"

[storage]
name="å­˜å‚¨çŠ¶æ€"
queries="disk_usage,inode_usage,io_stats"
EOF
            ;;
            
        *)
            echo "âŒ æœªçŸ¥æ¨¡æ¿ç±»å‹: $template_name"
            echo "å¯ç”¨æ¨¡æ¿: web_analytics, system_health"
            return 1
            ;;
    esac
    
    echo "âœ… æŠ¥å‘Šæ¨¡æ¿å·²åˆ›å»º: $template_dir/$template_name.template"
}

# ä½¿ç”¨æ¨¡æ¿ç”ŸæˆæŠ¥å‘Š
generate_from_template() {
    local template_file="$1"
    local data_source="$2"
    local output_file="$3"
    
    echo "ğŸ“‹ ä½¿ç”¨æ¨¡æ¿ç”ŸæˆæŠ¥å‘Š"
    echo "æ¨¡æ¿: $template_file"
    echo "æ•°æ®æº: $data_source"
    echo "è¾“å‡º: $output_file"
    echo "=================================="
    
    # è¯»å–æ¨¡æ¿é…ç½®
    source "$template_file"
    
    # å¼€å§‹ç”ŸæˆHTMLæŠ¥å‘Š
    cat > "$output_file" << EOF
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>$TITLE</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; margin: 0; background: #f5f7fa; }
        .container { max-width: 1200px; margin: 20px auto; background: white; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; text-align: center; }
        .section { padding: 30px; border-bottom: 1px solid #eee; }
        .metric-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 20px 0; }
        .metric-card { background: #f8f9ff; padding: 20px; border-radius: 8px; border-left: 4px solid #667eea; }
        .metric-value { font-size: 2em; font-weight: bold; color: #333; }
        .metric-label { color: #666; font-size: 0.9em; margin-top: 5px; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th { background: #f1f3f4; padding: 12px; text-align: left; border-bottom: 2px solid #ddd; }
        td { padding: 10px 12px; border-bottom: 1px solid #eee; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>$TITLE</h1>
            <p>ç”Ÿæˆæ—¶é—´: $(date '+%Y-%m-%d %H:%M:%S')</p>
        </div>
EOF
    
    # æ ¹æ®æ¨¡æ¿ç”Ÿæˆå„ä¸ªsection
    IFS=',' read -ra SECTION_LIST <<< "$SECTIONS"
    for section in "${SECTION_LIST[@]}"; do
        generate_section "$section" "$data_source" >> "$output_file"
    done
    
    # ç»“æŸHTML
    echo "    </div></body></html>" >> "$output_file"
    
    echo "âœ… æŠ¥å‘Šç”Ÿæˆå®Œæˆ: $output_file"
}

# ç”ŸæˆæŠ¥å‘Šsection
generate_section() {
    local section_name="$1"
    local data_source="$2"
    
    # ä»æ¨¡æ¿ä¸­è¯»å–sectioné…ç½®ï¼ˆç®€åŒ–ç‰ˆï¼‰
    section_title=$(grep "name=" "$template_file" | grep -A5 "\[$section_name\]" | grep "name=" | cut -d'"' -f2)
    
    echo "        <div class='section'>"
    echo "            <h2>$section_title</h2>"
    
    case "$section_name" in
        "overview")
            echo "            <div class='metric-grid'>"
            echo "                <div class='metric-card'>"
            echo "                    <div class='metric-value'>$(wc -l < "$data_source")</div>"
            echo "                    <div class='metric-label'>æ€»è¯·æ±‚æ•°</div>"
            echo "                </div>"
            echo "                <div class='metric-card'>"
            echo "                    <div class='metric-value'>$(awk '{print $1}' "$data_source" | sort | uniq | wc -l)</div>"
            echo "                    <div class='metric-label'>ç‹¬ç«‹IPæ•°</div>"
            echo "                </div>"
            echo "            </div>"
            ;;
        "traffic")
            echo "            <h3>çƒ­é—¨é¡µé¢</h3>"
            echo "            <table>"
            echo "                <tr><th>é¡µé¢</th><th>è®¿é—®æ¬¡æ•°</th><th>å æ¯”</th></tr>"
            total=$(wc -l < "$data_source")
            awk '{print $7}' "$data_source" | sort | uniq -c | sort -nr | head -10 | \
            while read count url; do
                percentage=$(awk "BEGIN {printf \"%.1f\", $count*100/$total}")
                echo "                <tr><td>$url</td><td>$count</td><td>${percentage}%</td></tr>"
            done
            echo "            </table>"
            ;;
        "errors")
            error_count=$(grep -c " 404 \| 500 \| 503 " "$data_source" 2>/dev/null || echo "0")
            echo "            <div class='metric-card'>"
            echo "                <div class='metric-value'>$error_count</div>"
            echo "                <div class='metric-label'>é”™è¯¯è¯·æ±‚æ•°</div>"
            echo "            </div>"
            ;;
    esac
    
    echo "        </div>"
}
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæŠ€èƒ½


```
ğŸ¯ **è¯é¢‘ç»Ÿè®¡æ ¸å¿ƒ**ï¼š
â€¢ sort + uniq -c + sort -nr æ˜¯åŸºç¡€ç»„åˆ
â€¢ awkç»Ÿè®¡æ›´çµæ´»ï¼Œæ”¯æŒå¤æ‚æ¡ä»¶
â€¢ æ­£åˆ™è¡¨è¾¾å¼é…åˆå¯ä»¥ç²¾ç¡®æå–

ğŸ”„ **æ–‡æœ¬å»é‡è¦ç‚¹**ï¼š
â€¢ uniqåªèƒ½å¤„ç†ç›¸é‚»é‡å¤è¡Œï¼Œéœ€å…ˆsort
â€¢ å®Œå…¨åŒ¹é…vsæ¨¡ç³ŠåŒ¹é…è¦åŒºåˆ†ä½¿ç”¨åœºæ™¯
â€¢ å¤§æ–‡ä»¶å»é‡è€ƒè™‘å†…å­˜å’Œæ€§èƒ½é—®é¢˜

ğŸ” **æ¨¡å¼è¯†åˆ«å…³é”®**ï¼š
â€¢ æ—¶é—´æ¨¡å¼åˆ†æå¯¹æ•…éšœè¯Šæ–­å¾ˆé‡è¦
â€¢ å¼‚å¸¸æ£€æµ‹è¦è®¾ç½®åˆç†çš„é˜ˆå€¼
â€¢ å¤šç»´åº¦åˆ†ææ¯”å•ä¸€æŒ‡æ ‡æ›´å‡†ç¡®

âš¡ **æ€§èƒ½æ•°æ®æå–**ï¼š
â€¢ å“åº”æ—¶é—´åˆ†æè¦çœ‹å¹³å‡å€¼ã€ä¸­ä½æ•°ã€ç™¾åˆ†ä½
â€¢ ç³»ç»Ÿæ€§èƒ½è¦ç»¼åˆCPUã€å†…å­˜ã€ç½‘ç»œã€IO
â€¢ è¶‹åŠ¿åˆ†ææ¯”å•ç‚¹æ•°æ®æ›´æœ‰ä»·å€¼
```

### 10.2 å®ç”¨æŠ€å·§è®°å¿†


**ğŸ’¡ å¸¸ç”¨å‘½ä»¤ç»„åˆ**ï¼š
```bash
# è¯é¢‘ç»Ÿè®¡ä¸‡èƒ½å…¬å¼
cat file | æå–å­—æ®µ | sort | uniq -c | sort -nr

# æ—¶é—´çª—å£åˆ†ææ¨¡æ¿  
awk '{æ—¶é—´æå–; count[æ—¶é—´]++} END {è¾“å‡ºç»Ÿè®¡}'

# é”™è¯¯è¿‡æ»¤ç»å…¸ç»„åˆ
grep -E "(ERROR|FATAL|CRITICAL)" | awk 'åˆ†æä»£ç '

# æ€§èƒ½æ•°æ®æå–å¥—è·¯
awk '{sum+=$å­—æ®µ; count++} END {print "å¹³å‡:", sum/count}'
```

### 10.3 è§£å†³é—®é¢˜çš„æ€è·¯


**ğŸ¯ åˆ†æé—®é¢˜çš„æ­¥éª¤**ï¼š

```
ç¬¬1æ­¥ï¼šç†è§£æ•°æ®ç»“æ„
â€¢ æŸ¥çœ‹æ–‡ä»¶æ ¼å¼å’Œå­—æ®µå«ä¹‰
â€¢ ç¡®å®šæ—¶é—´æˆ³æ ¼å¼å’Œä½ç½®
â€¢ äº†è§£æ•°æ®é‡çº§å’Œæ–‡ä»¶å¤§å°

ç¬¬2æ­¥ï¼šé€‰æ‹©åˆé€‚å·¥å…·
â€¢ å°æ–‡ä»¶ç”¨åŸºç¡€å‘½ä»¤ç»„åˆ
â€¢ å¤§æ–‡ä»¶è€ƒè™‘æµå¼å¤„ç†
â€¢ å¤æ‚é€»è¾‘ç”¨awkç¼–ç¨‹

ç¬¬3æ­¥ï¼šè®¾è®¡å¤„ç†æµç¨‹
â€¢ æ•°æ®æå– â†’ æ•°æ®æ¸…æ´— â†’ æ•°æ®åˆ†æ â†’ ç»“æœè¾“å‡º
â€¢ æ¯ä¸€æ­¥éƒ½è¦è€ƒè™‘å®¹é”™å¤„ç†
â€¢ ä¸­é—´ç»“æœè¦èƒ½éªŒè¯æ­£ç¡®æ€§

ç¬¬4æ­¥ï¼šä¼˜åŒ–å’Œè‡ªåŠ¨åŒ–
â€¢ ç¼–å†™å¯é‡ç”¨çš„è„šæœ¬
â€¢ æ·»åŠ å‚æ•°æ”¯æŒä¸åŒåœºæ™¯
â€¢ è€ƒè™‘å®šæœŸæ‰§è¡Œå’ŒæŠ¥å‘Šç”Ÿæˆ
```

### 10.4 å¸¸è§åº”ç”¨åœºæ™¯


| åœºæ™¯ç±»å‹ | **ä¸»è¦æŠ€æœ¯** | **å…³é”®ç‚¹** | **è¾“å‡ºç»“æœ** |
|---------|-------------|-----------|-------------|
| ğŸŒ **Webæ—¥å¿—åˆ†æ** | `è¯é¢‘ç»Ÿè®¡` `æ€§èƒ½æå–` | IPã€URLã€çŠ¶æ€ç åˆ†æ | è®¿é—®æŠ¥å‘Šã€å¼‚å¸¸æŠ¥è­¦ |
| ğŸš¨ **æ•…éšœæ’æŸ¥** | `é”™è¯¯è¿‡æ»¤` `æ¨¡å¼è¯†åˆ«` | æ—¶é—´å…³è”ã€é”™è¯¯èšåˆ | æ•…éšœåŸå› ã€å½±å“èŒƒå›´ |
| ğŸ“Š **ä¸šåŠ¡åˆ†æ** | `æ•°æ®é‡‡æ ·` `æ‰¹é‡å¤„ç†` | ç”¨æˆ·è¡Œä¸ºã€è½¬åŒ–æ¼æ–— | ä¸šåŠ¡æŠ¥è¡¨ã€è¶‹åŠ¿åˆ†æ |
| ğŸ”§ **ç³»ç»Ÿç›‘æ§** | `è‡ªåŠ¨åŒ–æŠ¥å‘Š` `å®æ—¶åˆ†æ` | æ€§èƒ½æŒ‡æ ‡ã€èµ„æºä½¿ç”¨ | ç›‘æ§ä»ªè¡¨æ¿ã€é¢„è­¦ |

### 10.5 å­¦ä¹ å»ºè®®


**ğŸ“š è¿›é˜¶å­¦ä¹ è·¯çº¿**ï¼š

```
ğŸŸ¢ **åŸºç¡€é˜¶æ®µ** (1-2å‘¨)ï¼š
â€¢ ç†Ÿç»ƒæŒæ¡grepã€sedã€awkã€sortã€uniqåŸºç¡€ç”¨æ³•
â€¢ ç†è§£æ­£åˆ™è¡¨è¾¾å¼åœ¨æ–‡æœ¬å¤„ç†ä¸­çš„åº”ç”¨
â€¢ ç»ƒä¹ ç®€å•çš„è¯é¢‘ç»Ÿè®¡å’Œæ•°æ®æå–

ğŸŸ¡ **è¿›é˜¶é˜¶æ®µ** (3-4å‘¨)ï¼š
â€¢ å­¦ä¹ å¤æ‚çš„awkç¼–ç¨‹æŠ€å·§
â€¢ æŒæ¡å¤šæ–‡ä»¶æ‰¹é‡å¤„ç†æ–¹æ³•
â€¢ ç†è§£æ€§èƒ½ä¼˜åŒ–çš„åŸºæœ¬åŸåˆ™

ğŸ”´ **é«˜çº§é˜¶æ®µ** (æŒç»­)ï¼š
â€¢ è‡ªåŠ¨åŒ–è„šæœ¬å¼€å‘å’Œç»´æŠ¤
â€¢ å¤§æ•°æ®å¤„ç†ä¼˜åŒ–æŠ€å·§
â€¢ ä¸å…¶ä»–å·¥å…·(Pythonã€æ•°æ®åº“)çš„é›†æˆ
```

**âš ï¸ å¸¸è§é™·é˜±æé†’**ï¼š
```
å†…å­˜ä½¿ç”¨ï¼šå¤§æ–‡ä»¶å¤„ç†è¦è€ƒè™‘å†…å­˜é™åˆ¶
å­—ç¬¦ç¼–ç ï¼šä¸­æ–‡æ—¥å¿—è¦æ³¨æ„ç¼–ç é—®é¢˜  
æ—¶é—´æ ¼å¼ï¼šä¸åŒç³»ç»Ÿæ—¶é—´æ ¼å¼å¯èƒ½ä¸åŒ
ç©ºå€¼å¤„ç†ï¼šå­—æ®µä¸ºç©ºæ—¶è„šæœ¬å¯èƒ½å‡ºé”™
æƒé™é—®é¢˜ï¼šæ—¥å¿—æ–‡ä»¶å¯èƒ½éœ€è¦ç‰¹æ®Šæƒé™
```

### 10.6 å®æˆ˜é¡¹ç›®å»ºè®®


**ğŸš€ ç»ƒä¹ é¡¹ç›®æ¨è**ï¼š

1. **æ—¥å¿—ç›‘æ§ç³»ç»Ÿ** - å®æ—¶åˆ†æWebè®¿é—®æ—¥å¿—
2. **æ€§èƒ½æŠ¥å‘Šå·¥å…·** - å®šæœŸç”Ÿæˆç³»ç»Ÿæ€§èƒ½æŠ¥å‘Š  
3. **é”™è¯¯é¢„è­¦ç³»ç»Ÿ** - è‡ªåŠ¨æ£€æµ‹å’ŒæŠ¥å‘Šç³»ç»Ÿå¼‚å¸¸
4. **æ•°æ®æ¸…æ´—å·¥å…·** - æ‰¹é‡å¤„ç†å’Œæ ‡å‡†åŒ–æ—¥å¿—æ ¼å¼
5. **ç”¨æˆ·è¡Œä¸ºåˆ†æ** - ä»è®¿é—®æ—¥å¿—ä¸­æå–ç”¨æˆ·è¡Œä¸ºæ¨¡å¼

æ¯ä¸ªé¡¹ç›®éƒ½è¦åŒ…å«ï¼šæ•°æ®è¾“å…¥ã€å¤„ç†é€»è¾‘ã€ç»“æœè¾“å‡ºã€é”™è¯¯å¤„ç†ã€ä½¿ç”¨æ–‡æ¡£ã€‚

**æ ¸å¿ƒè®°å¿†**ï¼š
- æ–‡æœ¬åˆ†æé‡åœ¨ç†è§£æ•°æ®ç»“æ„å’Œä¸šåŠ¡éœ€æ±‚
- å·¥å…·é€‰æ‹©è¦å¹³è¡¡åŠŸèƒ½éœ€æ±‚å’Œæ€§èƒ½è¦æ±‚  
- è‡ªåŠ¨åŒ–å’Œå¯é‡ç”¨æ€§æ˜¯æå‡æ•ˆç‡çš„å…³é”®
- å®é™…é—®é¢˜é©±åŠ¨å­¦ä¹ ï¼Œè¾¹ç”¨è¾¹å­¦æ•ˆæœæœ€å¥½