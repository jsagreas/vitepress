---
title: 12ã€å®‰å…¨ä¸è¾“å…¥éªŒè¯
---
## ğŸ“š ç›®å½•

1. [è¾“å…¥æ•°æ®éªŒè¯åŸºç¡€](#1-è¾“å…¥æ•°æ®éªŒè¯åŸºç¡€)
2. [SQLæ³¨å…¥é˜²æŠ¤æ­£åˆ™](#2-SQLæ³¨å…¥é˜²æŠ¤æ­£åˆ™)
3. [XSSæ”»å‡»æ¨¡å¼è¯†åˆ«](#3-XSSæ”»å‡»æ¨¡å¼è¯†åˆ«)
4. [å¯†ç å¼ºåº¦éªŒè¯](#4-å¯†ç å¼ºåº¦éªŒè¯)
5. [æ–‡ä»¶è·¯å¾„å®‰å…¨æ£€æŸ¥](#5-æ–‡ä»¶è·¯å¾„å®‰å…¨æ£€æŸ¥)
6. [å‘½ä»¤æ³¨å…¥é˜²æŠ¤](#6-å‘½ä»¤æ³¨å…¥é˜²æŠ¤)
7. [æ¶æ„æ¨¡å¼é»‘åå•](#7-æ¶æ„æ¨¡å¼é»‘åå•)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ›¡ï¸ è¾“å…¥æ•°æ®éªŒè¯åŸºç¡€


### 1.1 ä»€ä¹ˆæ˜¯è¾“å…¥éªŒè¯


**ç®€å•ç†è§£**ï¼šè¾“å…¥éªŒè¯å°±åƒæ˜¯é—¨å«ï¼Œæ£€æŸ¥è¿›å…¥ç³»ç»Ÿçš„æ¯ä¸€ä¸ªæ•°æ®æ˜¯å¦"å®‰å…¨åˆæ³•"

```
ç”¨æˆ·è¾“å…¥ â†’ éªŒè¯æ£€æŸ¥ â†’ ç³»ç»Ÿå¤„ç†
    â†“         â†“         â†“
  ä»»ä½•å†…å®¹   æ­£åˆ™åŒ¹é…   å®‰å…¨æ•°æ®
```

**ä¸ºä»€ä¹ˆéœ€è¦éªŒè¯**ï¼š
- **é˜²æ­¢æ”»å‡»** - æ¶æ„ç”¨æˆ·å¯èƒ½è¾“å…¥å±é™©ä»£ç 
- **ç¡®ä¿æ ¼å¼** - ä¿è¯æ•°æ®ç¬¦åˆé¢„æœŸæ ¼å¼
- **ç³»ç»Ÿç¨³å®š** - é¿å…æ„å¤–è¾“å…¥å¯¼è‡´ç³»ç»Ÿå´©æºƒ

### 1.2 è¾“å…¥éªŒè¯çš„åŸºæœ¬åŸåˆ™


**ğŸ”¸ ç™½åå•åŸåˆ™ï¼ˆæ¨èï¼‰**
```bash
# åªå…è®¸å­—æ¯å’Œæ•°å­—
echo "abc123" | grep -P '^[a-zA-Z0-9]+$'
# åŒ¹é…ï¼šabc123 âœ…
# ä¸åŒ¹é…ï¼šabc@123 âŒ
```

**ğŸ”¸ é»‘åå•åŸåˆ™ï¼ˆè¡¥å……ï¼‰**
```bash
# æ‹’ç»åŒ…å«ç‰¹æ®Šå­—ç¬¦
echo "normal_text" | grep -vP '[<>&"'\'']'
# ä¸åŒ…å«ï¼š< > & " ' ç­‰å±é™©å­—ç¬¦
```

### 1.3 å¸¸è§éªŒè¯åœºæ™¯


| éªŒè¯ç±»å‹ | **ç”¨é€”** | **ç¤ºä¾‹** |
|---------|---------|---------|
| ğŸ“§ **é‚®ç®±** | `ç”¨æˆ·æ³¨å†Œ` | `user@domain.com` |
| ğŸ”¢ **æ‰‹æœºå·** | `èº«ä»½éªŒè¯` | `13800138000` |
| ğŸ†” **ç”¨æˆ·å** | `è´¦æˆ·åˆ›å»º` | `user_name123` |
| ğŸŒ **URL** | `é“¾æ¥éªŒè¯` | `https://example.com` |
| ğŸ“… **æ—¥æœŸ** | `æ—¶é—´è¾“å…¥` | `2025-09-13` |

---

## 2. ğŸš« SQLæ³¨å…¥é˜²æŠ¤æ­£åˆ™


### 2.1 ä»€ä¹ˆæ˜¯SQLæ³¨å…¥


**é€šä¿—è§£é‡Š**ï¼šå°±åƒæœ‰äººåœ¨ä½ çš„è´­ç‰©æ¸…å•åé¢å·å·åŠ äº†"æŠŠé’±åŒ…ä¹Ÿç»™æˆ‘"

```
æ­£å¸¸æŸ¥è¯¢ï¼šSELECT * FROM users WHERE name = 'admin'
æ³¨å…¥æ”»å‡»ï¼šSELECT * FROM users WHERE name = 'admin'; DROP TABLE users;--'
```

### 2.2 å¸¸è§SQLæ³¨å…¥æ¨¡å¼è¯†åˆ«


**ğŸ”¸ æ£€æµ‹SQLå…³é”®è¯**
```bash
# æ£€æµ‹å±é™©çš„SQLå…³é”®è¯
cat input.txt | grep -iP '\b(select|insert|update|delete|drop|union|exec|script)\b'

# ç¤ºä¾‹ï¼šæ£€æµ‹è¾“å…¥æ˜¯å¦åŒ…å«SQLæ“ä½œ
echo "'; DROP TABLE users;--" | grep -iP '\b(drop|delete|truncate)\b'
# è¾“å‡ºï¼šDROP
```

**ğŸ”¸ æ£€æµ‹SQLæ³¨é‡Šç¬¦å·**
```bash
# æ£€æµ‹SQLæ³¨é‡Šæ¨¡å¼
grep -P '(--|#|/\*|\*/|;)' suspicious_input.txt

# å¸¸è§æ³¨å…¥å°è¯•ï¼š
# admin'-- 
# admin'#
# admin'/*comment*/
```

**ğŸ”¸ æ£€æµ‹å¼•å·é—­åˆæ”»å‡»**
```bash
# æ£€æµ‹ä¸åŒ¹é…çš„å¼•å·
echo "admin'; DROP--" | grep -P "['\"]\s*;\s*\w+"
# åŒ¹é…ï¼šå¼•å·åè·Ÿåˆ†å·å’ŒSQLå…³é”®è¯
```

### 2.3 SQLè¾“å…¥è¿‡æ»¤æ­£åˆ™


**ğŸ›¡ï¸ ç”¨æˆ·åå®‰å…¨éªŒè¯**
```bash
# åªå…è®¸å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿
username="user_name123"
if echo "$username" | grep -qP '^[a-zA-Z0-9_]{3,20}$'; then
    echo "ç”¨æˆ·åæ ¼å¼æ­£ç¡® âœ…"
else
    echo "ç”¨æˆ·ååŒ…å«éæ³•å­—ç¬¦ âŒ"
fi
```

**ğŸ›¡ï¸ æ•°å­—IDéªŒè¯**
```bash
# ç¡®ä¿IDåªæ˜¯çº¯æ•°å­—
user_id="12345"
if echo "$user_id" | grep -qP '^\d+$'; then
    echo "IDæ ¼å¼æ­£ç¡® âœ…"
else
    echo "IDå¿…é¡»ä¸ºæ•°å­— âŒ"
fi
```

---

## 3. ğŸ•¸ï¸ XSSæ”»å‡»æ¨¡å¼è¯†åˆ«


### 3.1 ä»€ä¹ˆæ˜¯XSSæ”»å‡»


**ç®€å•ç†è§£**ï¼šå°±åƒæœ‰äººåœ¨ä½ çš„ç½‘é¡µé‡Œå·å·è—äº†ä¸€ä¸ªæ¶æ„ç¨‹åº

```
æ­£å¸¸å†…å®¹ï¼š<p>Hello World</p>
XSSæ”»å‡»ï¼š<script>alert('è¢«æ”»å‡»äº†!')</script>
```

### 3.2 XSSæ”»å‡»æ¨¡å¼æ£€æµ‹


**ğŸ”¸ æ£€æµ‹HTMLæ ‡ç­¾**
```bash
# æ£€æµ‹æ½œåœ¨çš„HTML/JavaScriptæ ‡ç­¾
echo '<script>alert("xss")</script>' | grep -iP '<(script|iframe|object|embed|form)[^>]*>'

# æ£€æµ‹æ‰€æœ‰HTMLæ ‡ç­¾
grep -P '<[^>]+>' user_input.txt
```

**ğŸ”¸ æ£€æµ‹JavaScriptå‡½æ•°è°ƒç”¨**
```bash
# æ£€æµ‹å±é™©çš„JavaScriptå‡½æ•°
cat input.txt | grep -iP '\b(alert|eval|document\.|window\.|location\.)\b'

# ç¤ºä¾‹è¾“å…¥æ£€æµ‹
echo "javascript:alert('xss')" | grep -iP 'javascript\s*:'
# åŒ¹é…ï¼šjavascript: åè®®
```

**ğŸ”¸ æ£€æµ‹äº‹ä»¶å¤„ç†å™¨**
```bash
# æ£€æµ‹HTMLäº‹ä»¶å±æ€§
echo '<img src="x" onerror="alert(1)">' | grep -iP '\bon\w+\s*='

# å¸¸è§äº‹ä»¶ï¼šonclick, onload, onerror, onmouseover
```

### 3.3 XSSé˜²æŠ¤è¿‡æ»¤


**ğŸ›¡ï¸ HTMLæ ‡ç­¾ç™½åå•**
```bash
# åªå…è®¸å®‰å…¨çš„HTMLæ ‡ç­¾
safe_tags="^<(p|br|strong|em|u|i|b)(/?)>$"
echo "<p>å®‰å…¨å†…å®¹</p>" | grep -P "$safe_tags"
```

**ğŸ›¡ï¸ ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰æ£€æŸ¥**
```bash
# æ£€æŸ¥æ˜¯å¦åŒ…å«æœªè½¬ä¹‰çš„å±é™©å­—ç¬¦
dangerous_chars='[<>&"'\'']'
if echo "$user_input" | grep -qP "$dangerous_chars"; then
    echo "åŒ…å«éœ€è¦è½¬ä¹‰çš„å­—ç¬¦ âš ï¸"
fi
```

---

## 4. ğŸ” å¯†ç å¼ºåº¦éªŒè¯


### 4.1 å¯†ç å¼ºåº¦åŸºæœ¬è¦æ±‚


**ä»€ä¹ˆæ˜¯å¼ºå¯†ç **ï¼šå°±åƒä¸€æŠŠå¤æ‚çš„é”ï¼Œæœ‰å¤šç§ä¸åŒçš„"é½¿"

```
å¼±å¯†ç ï¼š123456, password, admin
å¼ºå¯†ç ï¼šMyP@ssw0rd2025!
```

### 4.2 å¯†ç å¤æ‚åº¦æ£€æµ‹


**ğŸ”¸ åŸºæœ¬é•¿åº¦æ£€æŸ¥**
```bash
# æ£€æŸ¥å¯†ç é•¿åº¦ï¼ˆè‡³å°‘8ä½ï¼‰
password="MyPassword123"
if echo "$password" | grep -qP '.{8,}'; then
    echo "å¯†ç é•¿åº¦ç¬¦åˆè¦æ±‚ âœ…"
fi
```

**ğŸ”¸ å­—ç¬¦ç±»å‹æ£€æŸ¥**
```bash
# æ£€æŸ¥æ˜¯å¦åŒ…å«å¤§å†™å­—æ¯
echo "$password" | grep -qP '[A-Z]' && echo "åŒ…å«å¤§å†™å­—æ¯ âœ…"

# æ£€æŸ¥æ˜¯å¦åŒ…å«å°å†™å­—æ¯  
echo "$password" | grep -qP '[a-z]' && echo "åŒ…å«å°å†™å­—æ¯ âœ…"

# æ£€æŸ¥æ˜¯å¦åŒ…å«æ•°å­—
echo "$password" | grep -qP '[0-9]' && echo "åŒ…å«æ•°å­— âœ…"

# æ£€æŸ¥æ˜¯å¦åŒ…å«ç‰¹æ®Šå­—ç¬¦
echo "$password" | grep -qP '[!@#$%^&*(),.?":{}|<>]' && echo "åŒ…å«ç‰¹æ®Šå­—ç¬¦ âœ…"
```

### 4.3 å®Œæ•´å¯†ç éªŒè¯å‡½æ•°


**ğŸ”§ å¯†ç å¼ºåº¦éªŒè¯è„šæœ¬**
```bash
#!/bin/bash
check_password_strength() {
    local password="$1"
    local score=0
    
    # é•¿åº¦æ£€æŸ¥
    if echo "$password" | grep -qP '.{8,}'; then
        ((score++))
        echo "[âœ…] é•¿åº¦åˆæ ¼ï¼ˆâ‰¥8ä½ï¼‰"
    else
        echo "[âŒ] å¯†ç å¤ªçŸ­ï¼ˆ<8ä½ï¼‰"
    fi
    
    # å¤§å†™å­—æ¯
    if echo "$password" | grep -qP '[A-Z]'; then
        ((score++))
        echo "[âœ…] åŒ…å«å¤§å†™å­—æ¯"
    else
        echo "[âŒ] ç¼ºå°‘å¤§å†™å­—æ¯"
    fi
    
    # å°å†™å­—æ¯
    if echo "$password" | grep -qP '[a-z]'; then
        ((score++))
        echo "[âœ…] åŒ…å«å°å†™å­—æ¯"
    else
        echo "[âŒ] ç¼ºå°‘å°å†™å­—æ¯"
    fi
    
    # æ•°å­—
    if echo "$password" | grep -qP '[0-9]'; then
        ((score++))
        echo "[âœ…] åŒ…å«æ•°å­—"
    else
        echo "[âŒ] ç¼ºå°‘æ•°å­—"
    fi
    
    # ç‰¹æ®Šå­—ç¬¦
    if echo "$password" | grep -qP '[!@#$%^&*(),.?":{}|<>]'; then
        ((score++))
        echo "[âœ…] åŒ…å«ç‰¹æ®Šå­—ç¬¦"
    else
        echo "[âŒ] ç¼ºå°‘ç‰¹æ®Šå­—ç¬¦"
    fi
    
    # å¼ºåº¦è¯„ä¼°
    case $score in
        5) echo "ğŸ”’ å¯†ç å¼ºåº¦ï¼šæå¼º" ;;
        4) echo "ğŸ” å¯†ç å¼ºåº¦ï¼šå¼º" ;;
        3) echo "ğŸ”“ å¯†ç å¼ºåº¦ï¼šä¸­ç­‰" ;;
        *) echo "âŒ å¯†ç å¼ºåº¦ï¼šå¼±" ;;
    esac
}

# æµ‹è¯•å¯†ç 
check_password_strength "MyP@ssw0rd2025"
```

---

## 5. ğŸ“ æ–‡ä»¶è·¯å¾„å®‰å…¨æ£€æŸ¥


### 5.1 è·¯å¾„éå†æ”»å‡»


**ä»€ä¹ˆæ˜¯è·¯å¾„éå†**ï¼šå°±åƒæœ‰äººç”¨ç‰¹æ®Šæ–¹æ³•"ç¿»å¢™"è¿›å…¥ä¸è¯¥è¿›å…¥çš„ç›®å½•

```
æ­£å¸¸è·¯å¾„ï¼š/home/user/documents/file.txt
æ”»å‡»è·¯å¾„ï¼š../../../etc/passwd
```

### 5.2 å±é™©è·¯å¾„æ¨¡å¼æ£€æµ‹


**ğŸ”¸ æ£€æµ‹ç›®å½•éå†**
```bash
# æ£€æµ‹ ../ æ¨¡å¼ï¼ˆç›®å½•éå†ï¼‰
echo "../../../etc/passwd" | grep -P '\.\./|\.\.\\'

# æ£€æµ‹ç¼–ç åçš„éå†
echo "%2e%2e%2f" | grep -iP '(%2e|%2f|%5c)'
```

**ğŸ”¸ æ£€æµ‹ç»å¯¹è·¯å¾„è®¿é—®**
```bash
# æ£€æµ‹è¯•å›¾è®¿é—®ç³»ç»Ÿæ•æ„Ÿç›®å½•
sensitive_paths='/etc/|/proc/|/sys/|/dev/|/var/log/'
echo "/etc/passwd" | grep -P "$sensitive_paths"
```

**ğŸ”¸ æ£€æµ‹ç©ºå­—èŠ‚æ³¨å…¥**
```bash
# æ£€æµ‹ç©ºå­—èŠ‚ï¼ˆç”¨äºç»•è¿‡æ‰©å±•åæ£€æŸ¥ï¼‰
echo "file.txt%00.php" | grep -P '%00|\\x00|\0'
```

### 5.3 å®‰å…¨è·¯å¾„éªŒè¯


**ğŸ›¡ï¸ æ–‡ä»¶åå®‰å…¨æ£€æŸ¥**
```bash
validate_filename() {
    local filename="$1"
    
    # æ£€æŸ¥æ–‡ä»¶åæ˜¯å¦åŒ…å«å±é™©å­—ç¬¦
    if echo "$filename" | grep -qP '[/\\:*?"<>|]'; then
        echo "æ–‡ä»¶ååŒ…å«éæ³•å­—ç¬¦ âŒ"
        return 1
    fi
    
    # æ£€æŸ¥æ˜¯å¦ä¸ºä¿ç•™åç§°
    if echo "$filename" | grep -iqP '^(con|prn|aux|nul|com[1-9]|lpt[1-9])(\.|$)'; then
        echo "æ–‡ä»¶åä¸ºç³»ç»Ÿä¿ç•™åç§° âŒ"
        return 1
    fi
    
    # æ£€æŸ¥æ–‡ä»¶åé•¿åº¦
    if [ ${#filename} -gt 255 ]; then
        echo "æ–‡ä»¶åè¿‡é•¿ âŒ"
        return 1
    fi
    
    echo "æ–‡ä»¶ååˆæ³• âœ…"
    return 0
}

# æµ‹è¯•
validate_filename "document.txt"  # åˆæ³•
validate_filename "../secret"     # éæ³•
```

---

## 6. ğŸ’‰ å‘½ä»¤æ³¨å…¥é˜²æŠ¤


### 6.1 ä»€ä¹ˆæ˜¯å‘½ä»¤æ³¨å…¥


**é€šä¿—è§£é‡Š**ï¼šå°±åƒæœ‰äººåœ¨ä½ çš„å‘½ä»¤åé¢å·å·åŠ äº†å…¶ä»–å‘½ä»¤

```
æ­£å¸¸å‘½ä»¤ï¼šls /home/user
æ³¨å…¥æ”»å‡»ï¼šls /home/user; rm -rf /
```

### 6.2 å‘½ä»¤æ³¨å…¥æ¨¡å¼æ£€æµ‹


**ğŸ”¸ æ£€æµ‹å‘½ä»¤åˆ†éš”ç¬¦**
```bash
# æ£€æµ‹å‘½ä»¤è¿æ¥ç¬¦
echo "ls; rm -rf /" | grep -P '[;&|`$()]'

# å¸¸è§åˆ†éš”ç¬¦ï¼š
# ;  (å‘½ä»¤åˆ†éš”)
# |  (ç®¡é“)  
# && (æ¡ä»¶æ‰§è¡Œ)
# || (æˆ–æ‰§è¡Œ)
# `  (åå¼•å·æ‰§è¡Œ)
```

**ğŸ”¸ æ£€æµ‹å±é™©å‘½ä»¤**
```bash
# æ£€æµ‹ç³»ç»Ÿå±é™©å‘½ä»¤
dangerous_cmds='\b(rm|dd|mkfs|fdisk|kill|shutdown|reboot|passwd|su|sudo)\b'
echo "rm -rf /" | grep -iP "$dangerous_cmds"
```

**ğŸ”¸ æ£€æµ‹é‡å®šå‘æ“ä½œ**
```bash
# æ£€æµ‹æ–‡ä»¶é‡å®šå‘
echo "echo data > /etc/passwd" | grep -P '[<>]+'
```

### 6.3 å‘½ä»¤å‚æ•°å®‰å…¨éªŒè¯


**ğŸ›¡ï¸ å®‰å…¨å‚æ•°éªŒè¯**
```bash
validate_command_arg() {
    local arg="$1"
    
    # åªå…è®¸å­—æ¯æ•°å­—å’Œå®‰å…¨å­—ç¬¦
    if echo "$arg" | grep -qP '^[a-zA-Z0-9._/-]+$'; then
        echo "å‚æ•°å®‰å…¨ âœ…"
        return 0
    else
        echo "å‚æ•°åŒ…å«å±é™©å­—ç¬¦ âŒ"
        return 1
    fi
}

# å®‰å…¨çš„æ–‡ä»¶æ“ä½œ
safe_file_op() {
    local operation="$1"
    local filename="$2"
    
    # éªŒè¯æ“ä½œç±»å‹
    if ! echo "$operation" | grep -qP '^(read|list|stat)$'; then
        echo "ä¸å…è®¸çš„æ“ä½œ: $operation"
        return 1
    fi
    
    # éªŒè¯æ–‡ä»¶å
    if ! validate_command_arg "$filename"; then
        return 1
    fi
    
    case "$operation" in
        "read") cat "$filename" ;;
        "list") ls -l "$filename" ;;
        "stat") stat "$filename" ;;
    esac
}
```

---

## 7. ğŸ“‹ æ¶æ„æ¨¡å¼é»‘åå•


### 7.1 æ„å»ºæ¶æ„æ¨¡å¼åº“


**ğŸ”¸ Webæ”»å‡»æ¨¡å¼**
```bash
# Webæ”»å‡»ç‰¹å¾åº“
web_attacks=(
    '<script[^>]*>'           # XSSè„šæœ¬æ ‡ç­¾
    'javascript:'             # JavaScriptåè®®
    'vbscript:'              # VBScriptåè®®
    'on\w+\s*='              # HTMLäº‹ä»¶å¤„ç†å™¨
    'eval\s*\('              # JavaScript evalå‡½æ•°
    'expression\s*\('        # CSSè¡¨è¾¾å¼
)

# æ£€æµ‹å‡½æ•°
check_web_attack() {
    local input="$1"
    for pattern in "${web_attacks[@]}"; do
        if echo "$input" | grep -iqP "$pattern"; then
            echo "æ£€æµ‹åˆ°Webæ”»å‡»æ¨¡å¼: $pattern"
            return 1
        fi
    done
    echo "è¾“å…¥å®‰å…¨"
    return 0
}
```

**ğŸ”¸ ç³»ç»Ÿæ”»å‡»æ¨¡å¼**
```bash
# ç³»ç»Ÿæ”»å‡»ç‰¹å¾åº“
system_attacks=(
    '\.\./+'                 # ç›®å½•éå†
    '/etc/passwd'            # ç³»ç»Ÿæ–‡ä»¶è®¿é—®
    '/proc/'                 # ç³»ç»Ÿè¿›ç¨‹ä¿¡æ¯
    'rm\s+-rf'              # å±é™©åˆ é™¤å‘½ä»¤
    'chmod\s+777'           # å±é™©æƒé™ä¿®æ”¹
    'wget\s+http'           # ä¸‹è½½æ¶æ„æ–‡ä»¶
    'curl\s+.*\|\s*sh'      # æ‰§è¡Œè¿œç¨‹è„šæœ¬
)
```

### 7.2 å®æ—¶ç›‘æ§è„šæœ¬


**ğŸ”§ å®‰å…¨ç›‘æ§å·¥å…·**
```bash
#!/bin/bash
# å®æ—¶è¾“å…¥å®‰å…¨ç›‘æ§

monitor_input() {
    local logfile="/var/log/security_monitor.log"
    
    while read -r line; do
        timestamp=$(date "+%Y-%m-%d %H:%M:%S")
        
        # æ£€æŸ¥SQLæ³¨å…¥
        if echo "$line" | grep -iqP '\b(select|insert|update|delete|drop|union)\b.*[;\'"]'; then
            echo "[$timestamp] SQLæ³¨å…¥å°è¯•: $line" >> "$logfile"
            echo "ğŸš¨ æ£€æµ‹åˆ°SQLæ³¨å…¥å°è¯•"
        fi
        
        # æ£€æŸ¥XSS
        if echo "$line" | grep -iqP '<(script|iframe|object)[^>]*>'; then
            echo "[$timestamp] XSSæ”»å‡»å°è¯•: $line" >> "$logfile"
            echo "ğŸš¨ æ£€æµ‹åˆ°XSSæ”»å‡»å°è¯•"
        fi
        
        # æ£€æŸ¥å‘½ä»¤æ³¨å…¥
        if echo "$line" | grep -qP '[;&|`$()]'; then
            echo "[$timestamp] å‘½ä»¤æ³¨å…¥å°è¯•: $line" >> "$logfile"
            echo "ğŸš¨ æ£€æµ‹åˆ°å‘½ä»¤æ³¨å…¥å°è¯•"
        fi
        
        # æ£€æŸ¥è·¯å¾„éå†
        if echo "$line" | grep -qP '\.\./'; then
            echo "[$timestamp] è·¯å¾„éå†å°è¯•: $line" >> "$logfile"
            echo "ğŸš¨ æ£€æµ‹åˆ°è·¯å¾„éå†å°è¯•"
        fi
        
    done
}

# å¯åŠ¨ç›‘æ§
echo "å¼€å§‹å®‰å…¨ç›‘æ§..."
monitor_input
```

### 7.3 ç»¼åˆå®‰å…¨æ£€æŸ¥å‡½æ•°


**ğŸ›¡ï¸ ä¸‡èƒ½å®‰å…¨æ£€æŸ¥**
```bash
comprehensive_security_check() {
    local input="$1"
    local check_type="$2"  # web, sql, cmd, file
    local danger_score=0
    
    echo "ğŸ” å¼€å§‹å®‰å…¨æ£€æŸ¥: $check_type"
    echo "ğŸ“ æ£€æŸ¥å†…å®¹: ${input:0:50}..."
    
    case "$check_type" in
        "web")
            # Webå®‰å…¨æ£€æŸ¥
            echo "$input" | grep -iqP '<script[^>]*>' && ((danger_score+=3))
            echo "$input" | grep -iqP 'javascript:' && ((danger_score+=2))
            echo "$input" | grep -iqP 'on\w+\s*=' && ((danger_score+=2))
            ;;
        "sql") 
            # SQLå®‰å…¨æ£€æŸ¥
            echo "$input" | grep -iqP '\b(drop|delete|truncate)\b' && ((danger_score+=3))
            echo "$input" | grep -iqP '[\'"];.*--' && ((danger_score+=2))
            echo "$input" | grep -iqP '\bunion\b.*\bselect\b' && ((danger_score+=3))
            ;;
        "cmd")
            # å‘½ä»¤å®‰å…¨æ£€æŸ¥  
            echo "$input" | grep -qP '[;&|`$()]' && ((danger_score+=2))
            echo "$input" | grep -iqP '\b(rm|dd|mkfs)\b' && ((danger_score+=3))
            ;;
        "file")
            # æ–‡ä»¶å®‰å…¨æ£€æŸ¥
            echo "$input" | grep -qP '\.\./+' && ((danger_score+=2))
            echo "$input" | grep -qP '/etc/|/proc/' && ((danger_score+=3))
            ;;
    esac
    
    # è¯„ä¼°å±é™©ç­‰çº§
    if [ $danger_score -eq 0 ]; then
        echo "âœ… å®‰å…¨æ£€æŸ¥é€šè¿‡"
        return 0
    elif [ $danger_score -le 2 ]; then
        echo "âš ï¸  å‘ç°å¯ç–‘å†…å®¹ (å±é™©ç­‰çº§: $danger_score)"
        return 1
    else
        echo "ğŸš¨ å‘ç°é«˜å±å†…å®¹ (å±é™©ç­‰çº§: $danger_score)"
        return 2
    fi
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„å®‰å…¨æ¦‚å¿µ


```
ğŸ”¸ è¾“å…¥éªŒè¯ï¼šæ‰€æœ‰å¤–éƒ¨è¾“å…¥éƒ½ä¸å¯ä¿¡ï¼Œå¿…é¡»éªŒè¯
ğŸ”¸ ç™½åå•ä¼˜äºé»‘åå•ï¼šæ˜ç¡®å…è®¸ä»€ä¹ˆï¼Œè€Œä¸æ˜¯ç¦æ­¢ä»€ä¹ˆ  
ğŸ”¸ æ·±åº¦é˜²æŠ¤ï¼šå¤šå±‚éªŒè¯ï¼Œä¸ä¾èµ–å•ä¸€æ£€æŸ¥
ğŸ”¸ å®æ—¶ç›‘æ§ï¼šæŒç»­æ£€æµ‹å’Œè®°å½•å¯ç–‘æ´»åŠ¨
ğŸ”¸ æœ€å°æƒé™ï¼šåªç»™å¿…è¦çš„æœ€å°æƒé™
```

### 8.2 å…³é”®æ­£åˆ™æ¨¡å¼è®°å¿†


**ğŸ”¹ SQLæ³¨å…¥æ£€æµ‹**
```bash
# å±é™©SQLå…³é”®è¯
'\b(select|insert|update|delete|drop|union|exec)\b'

# SQLæ³¨é‡Šæ¨¡å¼  
'(--|#|/\*|\*/)'

# å¼•å·é—­åˆæ”»å‡»
'[\'\"]\s*;\s*\w+'
```

**ğŸ”¹ XSSæ”»å‡»æ£€æµ‹** 
```bash
# HTMLæ ‡ç­¾æ£€æµ‹
'<(script|iframe|object|embed)[^>]*>'

# JavaScriptåè®®
'javascript\s*:'

# äº‹ä»¶å¤„ç†å™¨
'\bon\w+\s*='
```

**ğŸ”¹ è·¯å¾„éå†æ£€æµ‹**
```bash
# ç›®å½•éå†
'\.\./|\.\.\\'

# ç¼–ç éå†
'(%2e|%2f|%5c)'

# ç³»ç»Ÿè·¯å¾„
'/etc/|/proc/|/sys/|/dev/'
```

### 8.3 å®é™…åº”ç”¨å»ºè®®


**ğŸ“ å®‰å…¨æ£€æŸ¥æ¸…å•**
- [ ] **è¾“å…¥é•¿åº¦é™åˆ¶** - é˜²æ­¢ç¼“å†²åŒºæº¢å‡º
- [ ] **å­—ç¬¦ç±»å‹éªŒè¯** - åªå…è®¸é¢„æœŸå­—ç¬¦
- [ ] **æ ¼å¼æ¨¡å¼åŒ¹é…** - ç¡®ä¿ç¬¦åˆé¢„æœŸæ ¼å¼  
- [ ] **å±é™©æ¨¡å¼æ£€æµ‹** - è¯†åˆ«å·²çŸ¥æ”»å‡»æ¨¡å¼
- [ ] **ç¼–ç è§„èŒƒåŒ–** - é˜²æ­¢ç¼–ç ç»•è¿‡
- [ ] **æ—¥å¿—è®°å½•** - è®°å½•æ‰€æœ‰æ£€æŸ¥ç»“æœ

**ğŸ”§ å®æ–½åŸåˆ™**
```
1. éªŒè¯åœ¨å‰ç«¯ï¼Œè¿‡æ»¤åœ¨åç«¯
2. è®°å½•æ‰€æœ‰å¯ç–‘è¾“å…¥
3. å®šæœŸæ›´æ–°æ”»å‡»æ¨¡å¼åº“
4. æµ‹è¯•éªŒè¯è§„åˆ™çš„æœ‰æ•ˆæ€§
5. å¹³è¡¡å®‰å…¨æ€§ä¸å¯ç”¨æ€§
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- æ°¸è¿œä¸è¦ç›¸ä¿¡ç”¨æˆ·è¾“å…¥
- æ­£åˆ™è¡¨è¾¾å¼æ˜¯é˜²æŠ¤çš„ç¬¬ä¸€é“é˜²çº¿
- å®‰å…¨æ˜¯ä¸€ä¸ªæŒç»­çš„è¿‡ç¨‹ï¼Œä¸æ˜¯ä¸€æ¬¡æ€§ä»»åŠ¡
- å¤šå±‚é˜²æŠ¤æ¯”å•ä¸€æ£€æŸ¥æ›´å¯é 