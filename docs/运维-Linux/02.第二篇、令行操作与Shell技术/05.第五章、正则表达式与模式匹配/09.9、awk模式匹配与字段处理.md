---
title: 9ã€awkæ¨¡å¼åŒ¹é…ä¸å­—æ®µå¤„ç†
---
## ğŸ“š ç›®å½•

1. [awkåŸºç¡€æ¦‚å¿µä¸å·¥ä½œåŸç†](#1-awkåŸºç¡€æ¦‚å¿µä¸å·¥ä½œåŸç†)
2. [æ¨¡å¼åŒ¹é…åŸºç¡€è¯­æ³•](#2-æ¨¡å¼åŒ¹é…åŸºç¡€è¯­æ³•)
3. [å­—æ®µåˆ†éš”ç¬¦ä¸å­—æ®µæ“ä½œ](#3-å­—æ®µåˆ†éš”ç¬¦ä¸å­—æ®µæ“ä½œ)
4. [æ­£åˆ™åŒ¹é…æ“ä½œç¬¦è¯¦è§£](#4-æ­£åˆ™åŒ¹é…æ“ä½œç¬¦è¯¦è§£)
5. [å­—æ®µæ­£åˆ™åŒ¹é…æŠ€å·§](#5-å­—æ®µæ­£åˆ™åŒ¹é…æŠ€å·§)
6. [å­—ç¬¦ä¸²å¤„ç†å‡½æ•°](#6-å­—ç¬¦ä¸²å¤„ç†å‡½æ•°)
7. [å®é™…åº”ç”¨æ¡ˆä¾‹](#7-å®é™…åº”ç”¨æ¡ˆä¾‹)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”§ awkåŸºç¡€æ¦‚å¿µä¸å·¥ä½œåŸç†


### 1.1 ä»€ä¹ˆæ˜¯awk


**ğŸ¯ ä¸€å¥è¯ç†è§£**
> awkå°±åƒExcelçš„å‘½ä»¤è¡Œç‰ˆæœ¬ï¼Œä¸“é—¨å¤„ç†æœ‰è§„å¾‹çš„æ–‡æœ¬æ•°æ®ï¼Œç‰¹åˆ«æ“…é•¿æŒ‰åˆ—æ“ä½œ

**ğŸ’¡ ç”Ÿæ´»ç±»æ¯”**
```
æƒ³è±¡ä½ åœ¨æ•´ç†ä¸€å¼ å­¦ç”Ÿæˆç»©è¡¨ï¼š
å§“å    æ•°å­¦    è‹±è¯­    æ€»åˆ†
å¼ ä¸‰    85      92      177
æå››    78      89      167
ç‹äº”    95      87      182

awkå°±åƒä¸€ä¸ªå¾ˆèªæ˜çš„åŠ©æ‰‹ï¼Œèƒ½å¤Ÿï¼š
- è‡ªåŠ¨è¯†åˆ«æ¯ä¸€åˆ—ï¼ˆå­—æ®µï¼‰
- æ ¹æ®æ¡ä»¶ç­›é€‰è¡Œ
- å¯¹ç‰¹å®šåˆ—è¿›è¡Œè®¡ç®—
- é‡æ–°æ ¼å¼åŒ–è¾“å‡º
```

### 1.2 awkçš„å·¥ä½œæµç¨‹


**ğŸ“Š å¤„ç†æµç¨‹å›¾**
```
è¾“å…¥æ–‡æœ¬
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¯»å–ä¸€è¡Œæ•°æ®   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æŒ‰åˆ†éš”ç¬¦åˆ†å‰²   â”‚  â† é»˜è®¤æ˜¯ç©ºæ ¼/åˆ¶è¡¨ç¬¦
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ¨¡å¼åŒ¹é…æ£€æŸ¥   â”‚  â† /pattern/ æˆ–æ¡ä»¶
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ‰§è¡Œç›¸åº”åŠ¨ä½œ   â”‚  â† {action}
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è¾“å‡ºå¤„ç†ç»“æœ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
å¤„ç†ä¸‹ä¸€è¡Œï¼ˆå¾ªç¯ï¼‰
```

### 1.3 awkåŸºæœ¬è¯­æ³•ç»“æ„


**ğŸ”¸ æ ‡å‡†æ ¼å¼**
```bash
awk 'pattern { action }' filename
awk '/æ¨¡å¼/ { åŠ¨ä½œ }' æ–‡ä»¶å
```

**ğŸ”¸ åŸºæœ¬æ¦‚å¿µè§£é‡Š**
- **æ¨¡å¼(pattern)**ï¼šä»€ä¹ˆæƒ…å†µä¸‹æ‰§è¡ŒåŠ¨ä½œï¼ˆç±»ä¼¼ifæ¡ä»¶ï¼‰
- **åŠ¨ä½œ(action)**ï¼šè¦æ‰§è¡Œçš„æ“ä½œï¼ˆç±»ä¼¼thenåé¢çš„å†…å®¹ï¼‰
- **å­—æ®µ(field)**ï¼šä¸€è¡Œä¸­è¢«åˆ†éš”ç¬¦åˆ†å¼€çš„æ¯ä¸€éƒ¨åˆ†

---

## 2. ğŸ¯ æ¨¡å¼åŒ¹é…åŸºç¡€è¯­æ³•


### 2.1 /pattern/è¯­æ³•è¯¦è§£


**ğŸ’­ æ ¸å¿ƒç†è§£**
> `/pattern/`å°±åƒä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œåªæœ‰åŒ¹é…çš„è¡Œæ‰ä¼šè¢«å¤„ç†

**ğŸ“ åŸºæœ¬ç”¨æ³•**
```bash
# åŒ¹é…åŒ…å«"error"çš„è¡Œ
awk '/error/' log.txt

# åŒ¹é…ä»¥æ•°å­—å¼€å¤´çš„è¡Œ  
awk '/^[0-9]/' data.txt

# åŒ¹é…ä»¥.txtç»“å°¾çš„è¡Œ
awk '/\.txt$/' filelist.txt
```

### 2.2 æ¨¡å¼ç±»å‹è¯¦è§£


#### ğŸ” æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼

```bash
# åŒ¹é…é‚®ç®±åœ°å€
awk '/[a-zA-Z0-9]+@[a-zA-Z0-9]+\.[a-zA-Z]{2,}/' contacts.txt

# åŒ¹é…IPåœ°å€æ ¼å¼
awk '/^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$/' network.log
```

#### ğŸ¯ æ¡ä»¶è¡¨è¾¾å¼æ¨¡å¼

```bash
# ç¬¬ä¸‰åˆ—å¤§äº100çš„è¡Œ
awk '$3 > 100' scores.txt

# ç¬¬ä¸€åˆ—ç­‰äº"admin"çš„è¡Œ
awk '$1 == "admin"' users.txt

# è¡Œå·æ˜¯å¶æ•°çš„è¡Œ
awk 'NR % 2 == 0' data.txt
```

#### ğŸ”— ç»„åˆæ¨¡å¼

```bash
# æ—¢è¦åŒ¹é…æ¨¡å¼ï¼Œåˆè¦æ»¡è¶³æ¡ä»¶
awk '/success/ && $2 > 50' log.txt

# æˆ–å…³ç³»ï¼šæ»¡è¶³ä»»ä¸€æ¡ä»¶
awk '/error/ || /warning/' log.txt
```

### 2.3 ç‰¹æ®Šæ¨¡å¼


**ğŸ”¸ BEGINå’ŒENDæ¨¡å¼**
```bash
awk 'BEGIN { print "å¼€å§‹å¤„ç†" } { print $1 } END { print "å¤„ç†å®Œæˆ" }' data.txt
```

ğŸ’¡ **ç†è§£è¦ç‚¹**ï¼š
- `BEGIN`ï¼šåœ¨å¤„ç†ä»»ä½•è¡Œä¹‹å‰æ‰§è¡Œ
- `END`ï¼šåœ¨å¤„ç†å®Œæ‰€æœ‰è¡Œä¹‹åæ‰§è¡Œ
- ä¸­é—´éƒ¨åˆ†ï¼šå¯¹æ¯ä¸€è¡Œéƒ½æ‰§è¡Œ

---

## 3. ğŸ“Š å­—æ®µåˆ†éš”ç¬¦ä¸å­—æ®µæ“ä½œ


### 3.1 å­—æ®µåˆ†éš”ç¬¦ï¼ˆFSï¼‰æ·±å…¥ç†è§£


**ğŸ  ç”Ÿæ´»ç±»æ¯”**
> å­—æ®µåˆ†éš”ç¬¦å°±åƒåˆ‡è›‹ç³•çš„åˆ€ï¼Œå†³å®šäº†æ•°æ®æ€ä¹ˆåˆ†å‰²

**ğŸ“‹ é»˜è®¤åˆ†éš”ç¬¦è¡Œä¸º**
```
è¾“å…¥ï¼šå¼ ä¸‰    85    92    177
è‡ªåŠ¨åˆ†å‰²ä¸ºï¼š
$0 = "å¼ ä¸‰    85    92    177"  (æ•´è¡Œ)
$1 = "å¼ ä¸‰"                     (ç¬¬1ä¸ªå­—æ®µ)
$2 = "85"                       (ç¬¬2ä¸ªå­—æ®µ)  
$3 = "92"                       (ç¬¬3ä¸ªå­—æ®µ)
$4 = "177"                      (ç¬¬4ä¸ªå­—æ®µ)
NF = 4                          (å­—æ®µæ€»æ•°)
```

### 3.2 è®¾ç½®è‡ªå®šä¹‰åˆ†éš”ç¬¦


#### ğŸ”§ å‘½ä»¤è¡Œè®¾ç½®

```bash
# ä½¿ç”¨å†’å·ä½œåˆ†éš”ç¬¦
awk -F':' '{ print $1, $3 }' /etc/passwd

# ä½¿ç”¨é€—å·ä½œåˆ†éš”ç¬¦ï¼ˆå¤„ç†CSVï¼‰
awk -F',' '{ print $2 }' data.csv
```

#### ğŸ“ è„šæœ¬å†…è®¾ç½®

```bash
# åœ¨BEGINä¸­è®¾ç½®
awk 'BEGIN { FS=":" } { print $1, $3 }' /etc/passwd

# å¤„ç†å¤šç§åˆ†éš”ç¬¦
awk 'BEGIN { FS="[,;:]" } { print $1, $2 }' mixed_data.txt
```

### 3.3 å­—æ®µæ“ä½œæŠ€å·§


**ğŸ¯ å­—æ®µè®¿é—®å’Œä¿®æ”¹**
```bash
# è®¿é—®æœ€åä¸€ä¸ªå­—æ®µ
awk '{ print $NF }' data.txt

# è®¿é—®å€’æ•°ç¬¬äºŒä¸ªå­—æ®µ  
awk '{ print $(NF-1) }' data.txt

# ä¿®æ”¹å­—æ®µå€¼
awk '{ $2 = $2 * 1.1; print }' scores.txt
```

**ğŸ“Š å­—æ®µç»Ÿè®¡ç¤ºä¾‹**
```bash
# ç»Ÿè®¡å­—æ®µæ•°é‡
awk '{ if(NF > max) max = NF } END { print "æœ€å¤§å­—æ®µæ•°:", max }' data.txt

# æ‰“å°å­—æ®µæ•°ä¸ç­‰äº3çš„è¡Œ
awk 'NF != 3 { print "å¼‚å¸¸è¡Œ:", $0 }' data.txt
```

---

## 4. ğŸ” æ­£åˆ™åŒ¹é…æ“ä½œç¬¦è¯¦è§£


### 4.1 åŒ¹é…æ“ä½œç¬¦ ~ å’Œ !~


**ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µ**
- `~`ï¼šåŒ¹é…æ“ä½œç¬¦ï¼Œç±»ä¼¼"åŒ…å«"
- `!~`ï¼šä¸åŒ¹é…æ“ä½œç¬¦ï¼Œç±»ä¼¼"ä¸åŒ…å«"

**ğŸ”¸ åŸºæœ¬è¯­æ³•**
```bash
å­—æ®µ ~ /æ­£åˆ™è¡¨è¾¾å¼/     # åŒ¹é…
å­—æ®µ !~ /æ­£åˆ™è¡¨è¾¾å¼/    # ä¸åŒ¹é…
```

### 4.2 å®é™…åº”ç”¨ç¤ºä¾‹


#### âœ… åŒ¹é…æ“ä½œç¬¦åº”ç”¨

```bash
# ç¬¬ä¸€ä¸ªå­—æ®µåŒ…å«æ•°å­—
awk '$1 ~ /[0-9]/' userlist.txt

# ä»»æ„å­—æ®µåŒ…å«é‚®ç®±æ ¼å¼
awk '$0 ~ /@.*\.com/' contacts.txt

# ç¬¬ä¸‰åˆ—åŒ¹é…ç‰¹å®šæ¨¡å¼
awk '$3 ~ /^admin/' log.txt
```

#### âŒ ä¸åŒ¹é…æ“ä½œç¬¦åº”ç”¨  

```bash
# æ’é™¤æ³¨é‡Šè¡Œï¼ˆä¸ä»¥#å¼€å¤´ï¼‰
awk '$0 !~ /^#/' config.txt

# ç¬¬äºŒåˆ—ä¸åŒ…å«"test"
awk '$2 !~ /test/' data.txt

# æ’é™¤ç©ºè¡Œæˆ–åªæœ‰ç©ºç™½çš„è¡Œ
awk '$0 !~ /^[ \t]*$/' file.txt
```

### 4.3 é«˜çº§åŒ¹é…æŠ€å·§


**ğŸ¯ æ¡ä»¶ç»„åˆ**
```bash
# å¤šæ¡ä»¶åŒ¹é…
awk '$1 ~ /^user/ && $3 ~ /[0-9]+$/' accounts.txt

# å¤æ‚æ¨¡å¼åŒ¹é…
awk '{ 
    if ($1 ~ /^admin/ || $2 ~ /root/) 
        print "ç‰¹æƒç”¨æˆ·:", $0 
}' users.txt
```

---

## 5. ğŸª å­—æ®µæ­£åˆ™åŒ¹é…æŠ€å·§


### 5.1 ç²¾ç¡®å­—æ®µåŒ¹é…


**ğŸ“‹ å¸¸ç”¨å­—æ®µåŒ¹é…æ¨¡å¼**

| åŒ¹é…éœ€æ±‚ | è¯­æ³•ç¤ºä¾‹ | è¯´æ˜ |
|---------|----------|------|
| ğŸ” **æ•°å­—å­—æ®µ** | `$2 ~ /^[0-9]+$/` | ç¬¬2åˆ—å®Œå…¨æ˜¯æ•°å­— |
| ğŸ“§ **é‚®ç®±å­—æ®µ** | `$3 ~ /@.*\./` | ç¬¬3åˆ—åŒ…å«é‚®ç®±æ ¼å¼ |
| ğŸ“… **æ—¥æœŸå­—æ®µ** | `$1 ~ /^[0-9]{4}-[0-9]{2}-[0-9]{2}$/` | ç¬¬1åˆ—æ˜¯æ—¥æœŸæ ¼å¼ |
| ğŸ”¤ **çº¯å­—æ¯** | `$1 ~ /^[a-zA-Z]+$/` | ç¬¬1åˆ—åªåŒ…å«å­—æ¯ |

### 5.2 å®æˆ˜åŒ¹é…ç¤ºä¾‹


#### ğŸ“Š æ—¥å¿—åˆ†æåœºæ™¯

```bash
# ç¤ºä¾‹æ—¥å¿—æ ¼å¼ï¼šæ—¶é—´æˆ³ çº§åˆ« æ¶ˆæ¯
# 2023-12-01 ERROR è¿æ¥å¤±è´¥
# 2023-12-01 INFO ç³»ç»Ÿå¯åŠ¨

# åŒ¹é…ERRORçº§åˆ«çš„æ—¥å¿—
awk '$2 ~ /ERROR/' system.log

# åŒ¹é…ä»Šå¤©çš„æ—¥å¿—ï¼ˆå‡è®¾ä»Šå¤©æ˜¯2023-12-01ï¼‰
awk '$1 ~ /^2023-12-01/' system.log

# åŒ¹é…åŒ…å«IPåœ°å€çš„æ¶ˆæ¯å­—æ®µ
awk '$3 ~ /[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/' network.log
```

#### ğŸ’° æ•°æ®å¤„ç†åœºæ™¯

```bash
# ç¤ºä¾‹æ•°æ®ï¼šå§“å éƒ¨é—¨ è–ªèµ„
# å¼ ä¸‰ æŠ€æœ¯éƒ¨ 8500
# æå›› å¸‚åœºéƒ¨ 7200

# è–ªèµ„å­—æ®µæ˜¯5ä½æ•°çš„å‘˜å·¥
awk '$3 ~ /^[0-9]{5}$/' salary.txt

# éƒ¨é—¨å­—æ®µä»¥"æŠ€æœ¯"å¼€å¤´
awk '$2 ~ /^æŠ€æœ¯/' employee.txt

# å§“åå­—æ®µæ˜¯ä¸¤ä¸ªå­—çš„ä¸­æ–‡å
awk '$1 ~ /^[ä¸€-é¾¥]{2}$/' names.txt
```

### 5.3 å­—æ®µå†…å®¹éªŒè¯


**âœ… æ•°æ®æ ¡éªŒç¤ºä¾‹**
```bash
# æ£€æŸ¥CSVæ–‡ä»¶ä¸­çš„é‚®ç®±åˆ—æ˜¯å¦åˆæ³•
awk -F',' '$3 !~ /@.*\./ { print "é‚®ç®±æ ¼å¼é”™è¯¯:", NR, $3 }' contacts.csv

# æ£€æŸ¥æ•°å€¼å­—æ®µæ˜¯å¦ä¸ºç©ºæˆ–éæ•°å­—
awk '$2 !~ /^[0-9]+$/ { print "ç¬¬2åˆ—æ•°æ®å¼‚å¸¸:", NR, $2 }' numbers.txt

# éªŒè¯æ—¥æœŸæ ¼å¼
awk '$1 !~ /^[0-9]{4}-[0-9]{2}-[0-9]{2}$/ { print "æ—¥æœŸæ ¼å¼é”™è¯¯:", $1 }' dates.txt
```

---

## 6. ğŸ› ï¸ å­—ç¬¦ä¸²å¤„ç†å‡½æ•°


### 6.1 match()å‡½æ•°è¯¦è§£


**ğŸ’¡ å‡½æ•°ç”¨é€”**
> match()å‡½æ•°æ‰¾åˆ°åŒ¹é…çš„ä½ç½®ï¼Œè¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…çš„èµ·å§‹ä½ç½®

**ğŸ”¸ åŸºæœ¬è¯­æ³•**
```bash
match(string, regexp)
# è¿”å›å€¼ï¼šåŒ¹é…çš„ä½ç½®ï¼ˆä»1å¼€å§‹ï¼‰ï¼Œæ²¡æ‰¾åˆ°è¿”å›0
```

**ğŸ“ å®é™…åº”ç”¨**
```bash
# æŸ¥æ‰¾é‚®ç®±çš„ä½ç½®
awk '{ pos = match($0, /@.*\.com/); if(pos > 0) print "é‚®ç®±ä½ç½®:", pos }' text.txt

# æå–åŒ¹é…çš„å†…å®¹
awk '{ 
    if(match($0, /[0-9]+/)) {
        print "æ‰¾åˆ°æ•°å­—ï¼Œä½ç½®:", RSTART, "é•¿åº¦:", RLENGTH
    }
}' data.txt
```

### 6.2 gsub()å’Œsub()å‡½æ•°è¯¦è§£


**ğŸ”„ æ›¿æ¢æ“ä½œå¯¹æ¯”**
- **sub()**ï¼šåªæ›¿æ¢ç¬¬ä¸€ä¸ªåŒ¹é…
- **gsub()**ï¼šæ›¿æ¢æ‰€æœ‰åŒ¹é…ï¼ˆglobal substituteï¼‰

**ğŸ  ç”Ÿæ´»ç±»æ¯”**
> sub()åƒåªæ”¹ç¬¬ä¸€ä¸ªé”™å­—ï¼Œgsub()åƒå…¨æ–‡æŸ¥æ‰¾æ›¿æ¢

#### ğŸ”§ sub()å‡½æ•°åº”ç”¨

```bash
# è¯­æ³•ï¼šsub(regexp, replacement, target)

# å°†ç¬¬ä¸€ä¸ªæ•°å­—æ›¿æ¢ä¸º"X"
awk '{ sub(/[0-9]/, "X"); print }' data.txt

# æ›¿æ¢ç¬¬ä¸€åˆ—çš„ç‰¹å®šå†…å®¹
awk '{ sub(/old/, "new", $1); print }' file.txt

# å»æ‰è¡Œé¦–çš„ç©ºç™½
awk '{ sub(/^[ \t]+/, ""); print }' messy.txt
```

#### ğŸ”„ gsub()å‡½æ•°åº”ç”¨

```bash
# å°†æ‰€æœ‰æ•°å­—æ›¿æ¢ä¸º"*"
awk '{ gsub(/[0-9]/, "*"); print }' data.txt

# å°†æ‰€æœ‰ç©ºç™½æ›¿æ¢ä¸ºå•ä¸ªç©ºæ ¼
awk '{ gsub(/[ \t]+/, " "); print }' file.txt

# åˆ é™¤æ‰€æœ‰ç‰¹æ®Šå­—ç¬¦
awk '{ gsub(/[^a-zA-Z0-9 ]/, ""); print }' text.txt
```

### 6.3 split()å‡½æ•°è¯¦è§£


**âœ‚ï¸ å­—ç¬¦ä¸²åˆ†å‰²**
> split()åƒæŠŠä¸€æ ¹ç»³å­æŒ‰æ ‡è®°åˆ‡æˆå¤šæ®µ

**ğŸ”¸ åŸºæœ¬è¯­æ³•**
```bash
split(string, array, separator)
# è¿”å›ï¼šåˆ†å‰²åçš„æ®µæ•°
```

**ğŸ“Š å®ç”¨ç¤ºä¾‹**
```bash
# åˆ†å‰²è·¯å¾„
awk '{ 
    n = split($1, parts, "/"); 
    print "æ–‡ä»¶å:", parts[n] 
}' paths.txt

# åˆ†å‰²æ—¥æœŸ
awk '{ 
    split($1, date_parts, "-"); 
    print "å¹´:", date_parts[1], "æœˆ:", date_parts[2], "æ—¥:", date_parts[3]
}' dates.txt

# å¤„ç†å¤æ‚åˆ†éš”ç¬¦
awk '{ 
    n = split($0, fields, /[,;:]/); 
    for(i=1; i<=n; i++) print i":", fields[i]
}' mixed_data.txt
```

---

## 7. ğŸš€ å®é™…åº”ç”¨æ¡ˆä¾‹


### 7.1 æ—¥å¿—æ–‡ä»¶åˆ†æ


**ğŸ“‹ åœºæ™¯æè¿°**
> åˆ†æApacheè®¿é—®æ—¥å¿—ï¼Œæå–æœ‰ç”¨ä¿¡æ¯

```bash
# ç¤ºä¾‹æ—¥å¿—æ ¼å¼
# 192.168.1.100 - - [01/Dec/2023:10:00:00] "GET /index.html HTTP/1.1" 200 1024

# æå–è®¿é—®å¤±è´¥çš„è¯·æ±‚ï¼ˆçŠ¶æ€ç 4xxæˆ–5xxï¼‰
awk '$7 ~ /^[45][0-9]{2}/ { print $1, $6, $7 }' access.log

# ç»Ÿè®¡ä¸åŒIPçš„è®¿é—®æ¬¡æ•°
awk '{ ip_count[$1]++ } END { 
    for(ip in ip_count) 
        print ip, ip_count[ip] 
}' access.log

# æå–è®¿é—®çš„æ–‡ä»¶ç±»å‹
awk '{ 
    if(match($6, /\.[a-zA-Z]+/)) {
        ext = substr($6, RSTART+1, RLENGTH-1)
        file_types[ext]++
    }
} END {
    for(type in file_types) 
        print type, file_types[type]
}' access.log
```

### 7.2 CSVæ•°æ®å¤„ç†


**ğŸ’¼ å®æˆ˜åœºæ™¯ï¼šå‘˜å·¥è–ªèµ„åˆ†æ**

```bash
# CSVæ ¼å¼ï¼šå§“å,éƒ¨é—¨,è–ªèµ„,å…¥èŒæ—¥æœŸ
# å¼ ä¸‰,æŠ€æœ¯éƒ¨,8500,2022-03-15
# æå››,å¸‚åœºéƒ¨,7200,2021-08-20

# è®¡ç®—å„éƒ¨é—¨å¹³å‡è–ªèµ„
awk -F',' '
NR > 1 {  # è·³è¿‡è¡¨å¤´
    dept_total[$2] += $3
    dept_count[$2]++
} 
END {
    for(dept in dept_total) {
        avg = dept_total[dept] / dept_count[dept]
        printf "%s: %.2f\n", dept, avg
    }
}' employee.csv

# æ‰¾å‡ºè–ªèµ„å¼‚å¸¸çš„è®°å½•ï¼ˆç©ºå€¼æˆ–éæ•°å­—ï¼‰
awk -F',' '$3 !~ /^[0-9]+$/ { 
    print "è–ªèµ„æ•°æ®å¼‚å¸¸ - è¡Œå·:" NR ", å§“å:" $1 ", è–ªèµ„:" $3 
}' employee.csv

# æŒ‰å…¥èŒå¹´ä»½åˆ†ç»„ç»Ÿè®¡
awk -F',' '
NR > 1 {
    if(match($4, /^[0-9]{4}/)) {
        year = substr($4, RSTART, 4)
        year_count[year]++
    }
}
END {
    print "å…¥èŒå¹´ä»½ç»Ÿè®¡:"
    for(year in year_count) 
        print year"å¹´: "year_count[year]"äºº"
}' employee.csv
```

### 7.3 é…ç½®æ–‡ä»¶å¤„ç†


**âš™ï¸ é…ç½®æ–‡ä»¶æ¸…ç†å’ŒéªŒè¯**

```bash
# å¤„ç†é…ç½®æ–‡ä»¶ï¼Œå»é™¤æ³¨é‡Šå’Œç©ºè¡Œ
awk '
# è·³è¿‡æ³¨é‡Šè¡Œå’Œç©ºè¡Œ
$0 !~ /^[ \t]*#/ && $0 !~ /^[ \t]*$/ {
    # å»é™¤è¡Œå°¾æ³¨é‡Š
    gsub(/#.*$/, "")
    # å»é™¤é¦–å°¾ç©ºç™½  
    gsub(/^[ \t]+|[ \t]+$/, "")
    if(length($0) > 0) print
}' config.conf

# éªŒè¯é…ç½®é¡¹æ ¼å¼
awk '
$0 ~ /=/ {
    if($0 !~ /^[a-zA-Z_][a-zA-Z0-9_]*[ \t]*=[ \t]*[^ \t]/) {
        print "é…ç½®æ ¼å¼é”™è¯¯ - è¡Œå·:" NR ", å†…å®¹:" $0
    }
}' app.conf
```

### 7.4 ç½‘ç»œæ•°æ®åˆ†æ


**ğŸŒ ç½‘ç»œè¿æ¥çŠ¶æ€åˆ†æ**

```bash
# åˆ†ænetstatè¾“å‡º
netstat -an | awk '
# åŒ¹é…TCPè¿æ¥è¡Œ
$1 ~ /tcp/ {
    # æå–çŠ¶æ€å­—æ®µï¼ˆé€šå¸¸æ˜¯æœ€åä¸€ä¸ªå­—æ®µï¼‰
    state = $NF
    state_count[state]++
    
    # åˆ†ææœ¬åœ°ç«¯å£
    if(match($4, /:([0-9]+)$/, port_match)) {
        local_port = port_match[1]
        port_count[local_port]++
    }
}
END {
    print "=== è¿æ¥çŠ¶æ€ç»Ÿè®¡ ==="
    for(state in state_count) {
        printf "%-12s: %d\n", state, state_count[state]
    }
    
    print "\n=== çƒ­é—¨ç«¯å£ TOP 5 ==="
    # ç®€å•æ’åºæ˜¾ç¤ºå‰5ä¸ª
    n = 0
    for(port in port_count) {
        ports[++n] = port_count[port] " " port
    }
    # è¿™é‡Œç®€åŒ–å¤„ç†ï¼Œå®é™…é¡¹ç›®ä¸­å¯èƒ½éœ€è¦æ›´å¤æ‚çš„æ’åº
}' 
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ awkå·¥ä½œåŸç†ï¼šé€è¡Œè¯»å–â†’å­—æ®µåˆ†å‰²â†’æ¨¡å¼åŒ¹é…â†’æ‰§è¡ŒåŠ¨ä½œ
ğŸ”¸ æ¨¡å¼åŒ¹é…è¯­æ³•ï¼š/pattern/ç”¨äºæ­£åˆ™åŒ¹é…ï¼Œæ¡ä»¶è¡¨è¾¾å¼ç”¨äºé€»è¾‘åˆ¤æ–­
ğŸ”¸ å­—æ®µåˆ†éš”ç¬¦ï¼šFSå˜é‡æ§åˆ¶å¦‚ä½•åˆ†å‰²å­—æ®µï¼Œ$1,$2...è®¿é—®å„å­—æ®µ
ğŸ”¸ æ­£åˆ™æ“ä½œç¬¦ï¼š~åŒ¹é…ï¼Œ!~ä¸åŒ¹é…ï¼Œç”¨äºå­—æ®µå†…å®¹æ£€æŸ¥
ğŸ”¸ å¤„ç†å‡½æ•°ï¼šmatch()æŸ¥æ‰¾ä½ç½®ï¼Œsub()/gsub()æ›¿æ¢ï¼Œsplit()åˆ†å‰²
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ awkçš„ä¼˜åŠ¿åœºæ™¯**
```
æœ€é€‚åˆå¤„ç†ï¼š
âœ… æœ‰è§„å¾‹çš„æ–‡æœ¬æ•°æ®ï¼ˆæ—¥å¿—ã€CSVã€é…ç½®æ–‡ä»¶ï¼‰
âœ… æŒ‰åˆ—æ“ä½œçš„éœ€æ±‚ï¼ˆç»Ÿè®¡ã€è¿‡æ»¤ã€æ ¼å¼è½¬æ¢ï¼‰
âœ… å¿«é€Ÿæ•°æ®åˆ†æï¼ˆæ— éœ€å¤æ‚ç¼–ç¨‹ï¼‰

ä¸å¤ªé€‚åˆï¼š
âŒ éç»“æ„åŒ–çš„è‡ªç”±æ–‡æœ¬
âŒ å¤æ‚çš„æ•°æ®å¤„ç†é€»è¾‘
âŒ éœ€è¦å¤æ‚æ•°æ®ç»“æ„çš„åœºæ™¯
```

**ğŸ”¹ æ¨¡å¼åŒ¹é…çš„æ€ç»´æ–¹å¼**
```
æ€è€ƒé¡ºåºï¼š
1. ç¡®å®šå¤„ç†ç›®æ ‡ï¼ˆè¦æ‰¾ä»€ä¹ˆï¼Ÿè¦åšä»€ä¹ˆï¼Ÿï¼‰
2. åˆ†ææ•°æ®ç»“æ„ï¼ˆå­—æ®µåˆ†å¸ƒã€åˆ†éš”ç¬¦ï¼‰
3. è®¾è®¡åŒ¹é…æ¨¡å¼ï¼ˆæ­£åˆ™è¡¨è¾¾å¼æˆ–æ¡ä»¶ï¼‰
4. ç¼–å†™å¤„ç†åŠ¨ä½œï¼ˆæ‰“å°ã€è®¡ç®—ã€ç»Ÿè®¡ï¼‰
```

**ğŸ”¹ å­—æ®µæ“ä½œçš„æ ¸å¿ƒæŠ€å·§**
```
è®°ä½è¿™äº›ï¼š
- $0æ˜¯æ•´è¡Œï¼Œ$1æ˜¯ç¬¬1ä¸ªå­—æ®µï¼Œ$NFæ˜¯æœ€åå­—æ®µ
- NFæ˜¯å­—æ®µæ€»æ•°ï¼ŒNRæ˜¯è¡Œå·
- å­—æ®µå¯ä»¥ä¿®æ”¹ï¼š$2 = "new_value"
- åˆ†éš”ç¬¦å½±å“å­—æ®µåˆ’åˆ†ï¼š-FæŒ‡å®šæˆ–FSå˜é‡è®¾ç½®
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ å­¦ä¹ è·¯å¾„å»ºè®®**
```
ç¬¬1æ­¥ï¼šæŒæ¡åŸºæœ¬è¯­æ³•
- ç†è§£ awk 'pattern { action }' ç»“æ„
- ç»ƒä¹ ç®€å•çš„å­—æ®µè®¿é—®å’Œæ‰“å°

ç¬¬2æ­¥ï¼šç†Ÿæ‚‰æ¨¡å¼åŒ¹é…  
- æŒæ¡ /regex/ æ­£åˆ™åŒ¹é…
- å­¦ä¼šæ¡ä»¶è¡¨è¾¾å¼åŒ¹é…

ç¬¬3æ­¥ï¼šæŒæ¡å­—ç¬¦ä¸²å‡½æ•°
- é‡ç‚¹ç»ƒä¹  gsub(), split(), match()
- ç»“åˆå®é™…æ•°æ®è¿›è¡Œæ“ä½œ

ç¬¬4æ­¥ï¼šç»¼åˆåº”ç”¨
- å¤„ç†çœŸå®çš„æ—¥å¿—æ–‡ä»¶
- åˆ†æCSVæ•°æ®
- ç¼–å†™å¤æ‚çš„æ•°æ®å¤„ç†è„šæœ¬
```

**ğŸ”§ è°ƒè¯•æŠ€å·§**
```
å¸¸ç”¨è°ƒè¯•æ–¹æ³•ï¼š
1. å…ˆç”¨ç®€å•çš„æ‰“å°æµ‹è¯•ï¼šawk '{ print NF, $0 }'
2. é€æ­¥å¢åŠ å¤æ‚åº¦ï¼Œç¡®ä¿æ¯ä¸€æ­¥éƒ½æ­£ç¡®
3. ç”¨å°æ•°æ®é›†æµ‹è¯•ï¼ŒéªŒè¯é€»è¾‘æ­£ç¡®æ€§
4. æ³¨æ„å­—æ®µç¼–å·ä»1å¼€å§‹ï¼Œä¸æ˜¯0
```

**ğŸ’¡ æœ€ä½³å®è·µ**
```
ç¼–å†™awkè„šæœ¬æ—¶ï¼š
- å…ˆåˆ†ææ•°æ®æ ¼å¼ï¼Œç¡®å®šåˆ†éš”ç¬¦
- ç”¨BEGINè®¾ç½®åˆå§‹å˜é‡ï¼ŒENDè¾“å‡ºæ±‡æ€»ç»“æœ
- å¯¹äºå¤æ‚é€»è¾‘ï¼Œè€ƒè™‘åˆ†æ­¥éª¤å¤„ç†
- æ·»åŠ é€‚å½“çš„é”™è¯¯æ£€æŸ¥å’Œå¼‚å¸¸å¤„ç†
- æµ‹è¯•è¾¹ç•Œæƒ…å†µï¼ˆç©ºè¡Œã€æ ¼å¼å¼‚å¸¸ç­‰ï¼‰
```

### 8.4 è®°å¿†è¦ç‚¹


**ğŸ¯ ä¸€å¥è¯æ€»ç»“**
> awkæ˜¯æŒ‰è¡ŒæŒ‰åˆ—å¤„ç†ç»“æ„åŒ–æ–‡æœ¬çš„ç¥å™¨ï¼Œæ¨¡å¼åŒ¹é…å†³å®šå¤„ç†å“ªäº›è¡Œï¼Œå­—æ®µæ“ä½œå†³å®šå¤„ç†å“ªäº›åˆ—

**ğŸ“Œ å¿…èƒŒè¯­æ³•**
```bash
awk 'pattern { action }' file          # åŸºæœ¬ç»“æ„
awk -F'åˆ†éš”ç¬¦' '{ åŠ¨ä½œ }' file          # è‡ªå®šä¹‰åˆ†éš”ç¬¦
awk '$å­—æ®µ ~ /æ­£åˆ™/' file                # å­—æ®µæ­£åˆ™åŒ¹é…
awk 'BEGIN{åˆå§‹åŒ–} {å¤„ç†} END{æ±‡æ€»}' file # å®Œæ•´ç»“æ„
```

**ğŸ”‘ æ ¸å¿ƒå˜é‡è®°å¿†**
- `$0` - æ•´è¡Œå†…å®¹  
- `$1,$2...` - å„ä¸ªå­—æ®µ
- `NF` - å­—æ®µæ•°é‡
- `NR` - è¡Œå·  
- `FS` - å­—æ®µåˆ†éš”ç¬¦

**ğŸ’­ å®ç”¨è®°å¿†å£è¯€**
> "awkæŒ‰è¡Œèµ°ï¼Œå­—æ®µåˆ†å¾—å¥½ï¼Œæ¨¡å¼æ¥ç­›é€‰ï¼Œå‡½æ•°å·§å¤„ç†ï¼Œæ—¥å¿—åˆ†æç‹"