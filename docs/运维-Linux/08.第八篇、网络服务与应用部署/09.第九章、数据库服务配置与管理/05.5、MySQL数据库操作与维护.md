---
title: 5、MySQL数据库操作与维护
---
## 📚 目录

1. [数据库创建删除与字符集](#1-数据库创建删除与字符集)
2. [表空间与存储引擎选择](#2-表空间与存储引擎选择)
3. [数据导入导出操作](#3-数据导入导出操作)
4. [索引创建与优化分析](#4-索引创建与优化分析)
5. [表维护与修复操作](#5-表维护与修复操作)
6. [二进制日志管理](#6-二进制日志管理)
7. [慢查询日志分析](#7-慢查询日志分析)
8. [数据库状态查看](#8-数据库状态查看)
9. [连接数与进程管理](#9-连接数与进程管理)
10. [核心要点总结](#10-核心要点总结)

---

## 1. 🗄️ 数据库创建删除与字符集


### 1.1 数据库基本操作概念


**💡 什么是数据库**
数据库就像一个大仓库，专门存放我们的数据。在MySQL中，一个数据库就是一个独立的数据存储空间，里面可以放很多张表。

**🎯 字符集的重要性**
字符集决定了数据库能存储什么样的文字。比如：
- `utf8mb4`：能存储中文、英文、emoji表情等
- `latin1`：只能存储英文字母和数字

### 1.2 创建数据库


**基本语法结构**
```sql
CREATE DATABASE 数据库名 
CHARACTER SET 字符集 
COLLATE 排序规则;
```

**实用示例**
```sql
-- 创建支持中文的数据库
CREATE DATABASE myapp 
CHARACTER SET utf8mb4 
COLLATE utf8mb4_unicode_ci;

-- 创建简单数据库（使用默认设置）
CREATE DATABASE testdb;
```

**🔸 字符集选择建议**

| 字符集 | **适用场景** | **优缺点** |
|--------|-------------|-----------|
| `utf8mb4` | 现代应用，支持emoji | ✅ 完整Unicode支持 ❌ 占用空间稍大 |
| `utf8` | 老项目兼容 | ✅ 兼容性好 ❌ 不支持4字节字符 |
| `latin1` | 纯英文应用 | ✅ 节省空间 ❌ 不支持中文 |

### 1.3 删除数据库


**⚠️ 危险操作提醒**
删除数据库会永久丢失所有数据，操作前务必备份！

```sql
-- 安全删除（先检查是否存在）
DROP DATABASE IF EXISTS myapp;

-- 直接删除
DROP DATABASE testdb;
```

**🛡️ 安全操作流程**
```bash
# 1. 先备份数据库
mysqldump -u root -p myapp > myapp_backup.sql

# 2. 确认备份文件
ls -lh myapp_backup.sql

# 3. 删除数据库
mysql -u root -p -e "DROP DATABASE myapp;"
```

### 1.4 查看数据库信息


```sql
-- 查看所有数据库
SHOW DATABASES;

-- 查看当前使用的数据库
SELECT DATABASE();

-- 查看数据库字符集信息
SHOW CREATE DATABASE myapp;

-- 查看数据库大小
SELECT 
    schema_name AS '数据库名',
    ROUND(SUM(data_length + index_length) / 1024 / 1024, 2) AS '大小(MB)'
FROM information_schema.tables 
WHERE schema_name = 'myapp';
```

---

## 2. 💾 表空间与存储引擎选择


### 2.1 存储引擎概念解析


**📖 什么是存储引擎**
存储引擎就像汽车的发动机，决定了数据怎么存储和读取。不同的引擎有不同的特点和用途。

**🎯 主要存储引擎对比**

```
MyISAM引擎特点：
┌─────────────────┐
│  读取速度快     │ ← 适合读多写少的场景
├─────────────────┤
│  不支持事务     │ ← 数据一致性要求不高
├─────────────────┤
│  表级锁定       │ ← 并发写入性能差
└─────────────────┘

InnoDB引擎特点：
┌─────────────────┐
│  支持事务       │ ← 保证数据一致性
├─────────────────┤
│  行级锁定       │ ← 并发性能好
├─────────────────┤
│  外键约束       │ ← 数据完整性强
└─────────────────┘
```

### 2.2 存储引擎选择指南


**🔸 InnoDB引擎（推荐）**
适用场景：
- 🏦 **金融系统**：需要事务保证
- 🛒 **电商平台**：高并发读写
- 📝 **内容管理**：数据完整性要求高

**🔸 MyISAM引擎**
适用场景：
- 📊 **数据仓库**：大量读取，少量写入
- 📈 **报表系统**：历史数据查询
- 🔍 **全文检索**：文本搜索功能

### 2.3 创建表时指定存储引擎


```sql
-- 创建InnoDB表（推荐）
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) NOT NULL,
    email VARCHAR(100)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 创建MyISAM表
CREATE TABLE logs (
    id INT PRIMARY KEY AUTO_INCREMENT,
    log_time TIMESTAMP,
    message TEXT
) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4;
```

### 2.4 修改存储引擎


```sql
-- 查看表的存储引擎
SHOW CREATE TABLE users;

-- 修改存储引擎
ALTER TABLE users ENGINE=InnoDB;

-- 批量查看所有表的存储引擎
SELECT table_name, engine 
FROM information_schema.tables 
WHERE table_schema = 'myapp';
```

---

## 3. 📤 数据导入导出操作


### 3.1 数据导出概念


**💡 什么是数据导出**
数据导出就是把数据库里的数据"搬出来"，保存成文件。就像把书架上的书打包装箱一样。

**🎯 导出的作用**
- **备份数据**：防止数据丢失
- **迁移数据**：换服务器时搬家
- **共享数据**：给别人使用数据

### 3.2 使用mysqldump导出数据


**基本导出语法**
```bash
mysqldump -u用户名 -p密码 选项 数据库名 > 文件名.sql
```

**常用导出示例**
```bash
# 导出整个数据库
mysqldump -u root -p myapp > myapp_backup.sql

# 导出指定表
mysqldump -u root -p myapp users orders > tables_backup.sql

# 导出数据结构（不含数据）
mysqldump -u root -p --no-data myapp > structure_only.sql

# 导出数据（不含结构）
mysqldump -u root -p --no-create-info myapp > data_only.sql
```

**🔧 实用导出选项**
```bash
# 完整备份（包含创建数据库语句）
mysqldump -u root -p --databases myapp > full_backup.sql

# 压缩导出（节省空间）
mysqldump -u root -p myapp | gzip > myapp_backup.sql.gz

# 导出时显示进度
mysqldump -u root -p --single-transaction --routines --triggers myapp > backup.sql
```

### 3.3 数据导入操作


**基本导入方法**
```bash
# 导入SQL文件
mysql -u root -p myapp < myapp_backup.sql

# 在MySQL命令行中导入
mysql> source /path/to/backup.sql;

# 解压后导入
gunzip < myapp_backup.sql.gz | mysql -u root -p myapp
```

**使用mysqlimport导入数据**
```bash
# 导入CSV文件（需要对应的表已存在）
mysqlimport -u root -p --fields-terminated-by=',' myapp users.csv

# 导入时忽略重复记录
mysqlimport -u root -p --ignore myapp users.csv
```

### 3.4 导入导出最佳实践


**📋 导出检查清单**
- ☑️ 确认导出内容完整
- ☑️ 检查文件大小合理
- ☑️ 验证文件可以正常打开
- ☑️ 测试导入到临时数据库

**⚡ 性能优化技巧**
```bash
# 大数据库导出优化
mysqldump -u root -p --single-transaction --quick --lock-tables=false myapp > backup.sql

# 并行导入提速
mysql -u root -p --init-command="SET SESSION FOREIGN_KEY_CHECKS=0;" myapp < backup.sql
```

---

## 4. 🚀 索引创建与优化分析


### 4.1 索引概念理解


**📖 什么是索引**
索引就像书的目录，帮我们快速找到想要的内容。没有索引，数据库就要一行行地翻找数据，有了索引就能直接跳到对应位置。

**🎯 索引的作用机制**
```
无索引查找过程：
数据表: [1][2][3][4][5][6][7][8][9][10]
查找5:   ↑  ↑  ↑  ↑  ✓ 需要查找5次

有索引查找过程：
索引树:     [5]
          /     \
       [2]       [8]
      /   \     /   \
    [1]   [3] [6]   [9]
查找5:    直接定位 ✓ 只需要2-3次
```

### 4.2 索引类型详解


**🔸 主键索引（PRIMARY KEY）**
```sql
-- 创建表时指定主键
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50)
);

-- 后添加主键
ALTER TABLE users ADD PRIMARY KEY (id);
```

**🔸 唯一索引（UNIQUE）**
```sql
-- 创建唯一索引
CREATE UNIQUE INDEX idx_username ON users(username);

-- 或者在创建表时指定
CREATE TABLE users (
    id INT PRIMARY KEY,
    username VARCHAR(50) UNIQUE
);
```

**🔸 普通索引（INDEX）**
```sql
-- 单列索引
CREATE INDEX idx_email ON users(email);

-- 复合索引（多列索引）
CREATE INDEX idx_name_age ON users(name, age);

-- 查看表的所有索引
SHOW INDEX FROM users;
```

### 4.3 索引使用策略


**✅ 什么时候需要创建索引**
- 🔍 **经常用于查询的列**：WHERE条件中的字段
- 🔗 **连接查询的列**：JOIN操作中的关联字段
- 📊 **排序的列**：ORDER BY中的字段
- 👥 **分组的列**：GROUP BY中的字段

**❌ 什么时候不要创建索引**
- 📝 **频繁更新的表**：插入、删除操作多
- 🔢 **数据量很小的表**：全表扫描更快
- 🎯 **选择性低的列**：性别这种只有两个值的字段

### 4.4 索引优化分析


**查看查询执行计划**
```sql
-- 分析查询性能
EXPLAIN SELECT * FROM users WHERE username = 'john';

-- 分析结果解读
-- type: 访问类型（const > eq_ref > ref > range > index > ALL）
-- key: 使用的索引
-- rows: 扫描的行数
-- Extra: 额外信息
```

**索引使用情况监控**
```sql
-- 查看索引使用统计
SELECT 
    TABLE_SCHEMA as '数据库',
    TABLE_NAME as '表名',
    INDEX_NAME as '索引名',
    CARDINALITY as '基数'
FROM information_schema.STATISTICS 
WHERE TABLE_SCHEMA = 'myapp';

-- 查找未使用的索引
SELECT 
    object_schema,
    object_name,
    index_name
FROM performance_schema.table_io_waits_summary_by_index_usage 
WHERE index_name IS NOT NULL
AND count_star = 0;
```

---

## 5. 🔧 表维护与修复操作


### 5.1 表维护的必要性


**💡 为什么需要维护表**
就像汽车需要保养，数据库表也需要定期维护。长期使用后，表可能出现：
- 📊 **数据碎片**：删除数据后留下空洞
- 🐛 **索引混乱**：索引指向错误位置
- 💾 **空间浪费**：实际数据少但占用空间大

### 5.2 表检查操作


```sql
-- 检查表的完整性
CHECK TABLE users;

-- 快速检查（只检查索引）
CHECK TABLE users FAST;

-- 详细检查
CHECK TABLE users EXTENDED;

-- 检查多个表
CHECK TABLE users, orders, products;
```

**检查结果解读**
```
Table     Op    Msg_type  Msg_text
users   check   status    OK        ← 表正常
orders  check   error     表损坏    ← 需要修复
```

### 5.3 表修复操作


```sql
-- 修复表
REPAIR TABLE users;

-- 快速修复
REPAIR TABLE users QUICK;

-- 扩展修复（更彻底但更慢）
REPAIR TABLE users EXTENDED;

-- 使用索引修复
REPAIR TABLE users USE_FRM;
```

**🚨 修复注意事项**
- 修复前先备份数据
- 修复过程中表不可用
- 大表修复可能需要很长时间

### 5.4 表优化操作


```sql
-- 优化表（整理碎片，重建索引）
OPTIMIZE TABLE users;

-- 分析表（更新索引统计信息）
ANALYZE TABLE users;

-- 批量优化多个表
OPTIMIZE TABLE users, orders, products;
```

**表空间回收示例**
```sql
-- 查看表占用空间
SELECT 
    table_name AS '表名',
    ROUND(((data_length + index_length) / 1024 / 1024), 2) AS '大小(MB)',
    ROUND((data_free / 1024 / 1024), 2) AS '碎片(MB)'
FROM information_schema.tables 
WHERE table_schema = 'myapp'
ORDER BY data_free DESC;
```

---

## 6. 📝 二进制日志管理


### 6.1 二进制日志概念


**💡 什么是二进制日志（Binlog）**
二进制日志就像数据库的"监控录像"，记录了所有对数据的修改操作。有了它，我们可以：
- 🔄 **数据恢复**：回到某个时间点的状态
- 🔄 **主从复制**：同步数据到其他服务器

### 6.2 启用二进制日志


**配置文件设置**
```ini
# 在/etc/mysql/mysql.conf.d/mysqld.cnf中添加
[mysqld]
log-bin = /var/log/mysql/mysql-bin
server-id = 1
binlog_format = ROW
expire_logs_days = 7
max_binlog_size = 100M
```

**重启MySQL服务**
```bash
sudo systemctl restart mysql
```

### 6.3 查看二进制日志


```sql
-- 查看二进制日志状态
SHOW VARIABLES LIKE 'log_bin';

-- 查看所有二进制日志文件
SHOW BINARY LOGS;

-- 查看当前使用的日志文件
SHOW MASTER STATUS;

-- 查看日志内容
SHOW BINLOG EVENTS IN 'mysql-bin.000001';
```

**使用mysqlbinlog工具**
```bash
# 查看二进制日志内容
mysqlbinlog /var/log/mysql/mysql-bin.000001

# 按时间范围查看
mysqlbinlog --start-datetime="2025-01-16 10:00:00" \
           --stop-datetime="2025-01-16 12:00:00" \
           /var/log/mysql/mysql-bin.000001

# 按位置查看
mysqlbinlog --start-position=4 --stop-position=1000 \
           /var/log/mysql/mysql-bin.000001
```

### 6.4 二进制日志维护


**手动切换日志文件**
```sql
-- 创建新的日志文件
FLUSH LOGS;

-- 删除指定日志文件之前的所有日志
PURGE BINARY LOGS TO 'mysql-bin.000010';

-- 删除指定日期之前的日志
PURGE BINARY LOGS BEFORE '2025-01-10 00:00:00';
```

**自动清理配置**
```sql
-- 设置日志保留天数
SET GLOBAL expire_logs_days = 7;

-- 设置单个日志文件最大大小
SET GLOBAL max_binlog_size = 1073741824; -- 1GB
```

---

## 7. 🐌 慢查询日志分析


### 7.1 慢查询日志概念


**💡 什么是慢查询**
慢查询就是执行时间太长的SQL语句。就像排队买票，有人办事特别慢，会影响后面所有人的体验。

**🎯 慢查询的危害**
- ⏰ **响应变慢**：用户等待时间长
- 💾 **资源占用**：消耗CPU和内存
- 🔒 **锁等待**：阻塞其他操作

### 7.2 启用慢查询日志


**配置文件设置**
```ini
# 在/etc/mysql/mysql.conf.d/mysqld.cnf中添加
[mysqld]
slow_query_log = 1
slow_query_log_file = /var/log/mysql/slow.log
long_query_time = 2
log_queries_not_using_indexes = 1
```

**动态启用**
```sql
-- 启用慢查询日志
SET GLOBAL slow_query_log = 'ON';

-- 设置慢查询时间阈值（秒）
SET GLOBAL long_query_time = 2;

-- 记录未使用索引的查询
SET GLOBAL log_queries_not_using_indexes = 'ON';
```

### 7.3 分析慢查询日志


**查看慢查询配置**
```sql
-- 查看慢查询相关配置
SHOW VARIABLES LIKE '%slow%';
SHOW VARIABLES LIKE 'long_query_time';

-- 查看慢查询统计
SHOW GLOBAL STATUS LIKE '%slow%';
```

**使用mysqldumpslow分析**
```bash
# 分析慢查询日志
mysqldumpslow /var/log/mysql/slow.log

# 显示最慢的10个查询
mysqldumpslow -s t -t 10 /var/log/mysql/slow.log

# 显示查询次数最多的10个
mysqldumpslow -s c -t 10 /var/log/mysql/slow.log

# 显示平均时间最长的10个
mysqldumpslow -s at -t 10 /var/log/mysql/slow.log
```

### 7.4 慢查询优化策略


**🔍 识别问题查询**
```sql
-- 查看当前正在执行的慢查询
SELECT 
    ID,
    USER,
    HOST,
    DB,
    COMMAND,
    TIME,
    STATE,
    INFO
FROM information_schema.PROCESSLIST 
WHERE TIME > 30 AND COMMAND != 'Sleep';
```

**⚡ 常见优化方法**
- 🎯 **添加索引**：为WHERE条件创建合适索引
- 🔄 **重写查询**：避免复杂的子查询
- 📊 **分页限制**：使用LIMIT限制结果数量
- 🗂️ **分表分库**：拆分大表减少查询压力

---

## 8. 📊 数据库状态查看


### 8.1 实时状态监控


**基本状态查看**
```sql
-- 查看MySQL版本和运行时间
SELECT VERSION(), NOW();
SHOW STATUS LIKE 'Uptime';

-- 查看连接数统计
SHOW STATUS LIKE 'Connections';
SHOW STATUS LIKE 'Threads_connected';
SHOW STATUS LIKE 'Max_used_connections';
```

**性能关键指标**
```sql
-- 查询缓存命中率
SHOW STATUS LIKE 'Qcache%';

-- 表锁等待情况
SHOW STATUS LIKE 'Table_locks%';

-- InnoDB缓冲池状态
SHOW STATUS LIKE 'Innodb_buffer_pool%';
```

### 8.2 系统变量查看


```sql
-- 查看所有系统变量
SHOW VARIABLES;

-- 查看特定变量
SHOW VARIABLES LIKE 'max_connections';
SHOW VARIABLES LIKE 'innodb%';

-- 查看字符集设置
SHOW VARIABLES LIKE 'character%';
SHOW VARIABLES LIKE 'collation%';
```

### 8.3 数据库大小统计


```sql
-- 查看所有数据库大小
SELECT 
    table_schema AS '数据库',
    ROUND(SUM(data_length + index_length) / 1024 / 1024, 2) AS '大小(MB)'
FROM information_schema.tables 
GROUP BY table_schema
ORDER BY SUM(data_length + index_length) DESC;

-- 查看指定数据库的表大小
SELECT 
    table_name AS '表名',
    ROUND(((data_length + index_length) / 1024 / 1024), 2) AS '大小(MB)',
    table_rows AS '行数'
FROM information_schema.tables 
WHERE table_schema = 'myapp'
ORDER BY (data_length + index_length) DESC;
```

### 8.4 性能监控脚本


**简单监控脚本**
```bash
#!/bin/bash
# mysql_monitor.sh

echo "=== MySQL状态监控 ==="
echo "时间: $(date)"

# 连接数
mysql -u root -p"$MYSQL_PASSWORD" -e "
SELECT 
    '当前连接数' as 指标,
    VARIABLE_VALUE as 数值
FROM information_schema.GLOBAL_STATUS 
WHERE VARIABLE_NAME = 'Threads_connected'
UNION ALL
SELECT 
    '最大连接数',
    VARIABLE_VALUE
FROM information_schema.GLOBAL_VARIABLES 
WHERE VARIABLE_NAME = 'max_connections';
"

# 查询处理情况
mysql -u root -p"$MYSQL_PASSWORD" -e "
SHOW STATUS LIKE 'Com_select';
SHOW STATUS LIKE 'Com_insert';
SHOW STATUS LIKE 'Com_update';
SHOW STATUS LIKE 'Com_delete';
"
```

---

## 9. 🔌 连接数与进程管理


### 9.1 连接管理概念


**💡 什么是数据库连接**
数据库连接就像电话线，应用程序通过它与数据库"通话"。连接太多会造成拥堵，连接太少会影响效率。

**🎯 连接数限制的作用**
- 🛡️ **保护系统**：防止连接过多导致系统崩溃
- ⚡ **性能优化**：合理分配系统资源
- 🔒 **安全控制**：限制异常连接

### 9.2 查看连接状态


```sql
-- 查看当前所有连接
SHOW PROCESSLIST;

-- 查看完整的连接信息
SHOW FULL PROCESSLIST;

-- 查看连接数统计
SHOW STATUS LIKE '%connection%';

-- 查看最大连接数设置
SHOW VARIABLES LIKE 'max_connections';
```

**连接信息详解**
```
Id: 连接ID（用于kill进程）
User: 连接用户
Host: 来源主机
db: 使用的数据库
Command: 当前命令类型
Time: 执行时间（秒）
State: 连接状态
Info: 执行的SQL语句
```

### 9.3 连接数配置


**修改最大连接数**
```sql
-- 临时修改（重启后失效）
SET GLOBAL max_connections = 1000;

-- 查看修改结果
SHOW VARIABLES LIKE 'max_connections';
```

**永久修改（配置文件）**
```ini
# 在/etc/mysql/mysql.conf.d/mysqld.cnf中添加
[mysqld]
max_connections = 1000
max_user_connections = 50
max_connect_errors = 10
```

### 9.4 进程管理操作


**终止指定连接**
```sql
-- 查看问题连接
SELECT 
    ID,
    USER,
    HOST,
    TIME,
    STATE,
    INFO
FROM information_schema.PROCESSLIST 
WHERE TIME > 300  -- 运行超过5分钟的查询
AND COMMAND != 'Sleep';

-- 终止指定连接
KILL 123;  -- 123是连接ID

-- 强制终止
KILL QUERY 123;  -- 只终止查询，保留连接
```

**批量清理空闲连接**
```bash
#!/bin/bash
# kill_idle_connections.sh

# 获取空闲超过1小时的连接ID
IDLE_IDS=$(mysql -u root -p"$MYSQL_PASSWORD" -e "
SELECT GROUP_CONCAT(ID SEPARATOR ',') 
FROM information_schema.PROCESSLIST 
WHERE COMMAND = 'Sleep' AND TIME > 3600;
" -s -N)

# 批量终止空闲连接
if [ ! -z "$IDLE_IDS" ]; then
    echo "终止空闲连接: $IDLE_IDS"
    mysql -u root -p"$MYSQL_PASSWORD" -e "
    SET @ids = '$IDLE_IDS';
    SET @sql = CONCAT('KILL ', REPLACE(@ids, ',', '; KILL '), ';');
    PREPARE stmt FROM @sql;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
    "
fi
```

### 9.5 连接池最佳实践


**🎯 连接池配置建议**
- 💻 **小型应用**：最大连接数 100-200
- 🏢 **中型应用**：最大连接数 300-500  
- 🏭 **大型应用**：最大连接数 800-1000

**⚡ 优化策略**
```sql
-- 监控连接使用率
SELECT 
    VARIABLE_VALUE as current_connections
FROM information_schema.GLOBAL_STATUS 
WHERE VARIABLE_NAME = 'Threads_connected';

-- 如果使用率持续超过80%，考虑增加连接数
-- 如果使用率长期很低，可以减少连接数
```

---

## 10. 📋 核心要点总结


### 10.1 必须掌握的核心操作


```
🔸 数据库管理：创建、删除、字符集设置
🔸 存储引擎：InnoDB与MyISAM选择，性能特点
🔸 数据备份：mysqldump导出，mysql导入
🔸 索引优化：创建策略，性能分析，维护方法
🔸 表维护：检查、修复、优化操作
🔸 日志管理：二进制日志、慢查询日志配置
🔸 状态监控：连接数、性能指标、进程管理
```

### 10.2 关键理解要点


**🔹 数据库字符集的重要性**
```
选择原则：
- 现代应用统一使用utf8mb4
- 排序规则选择utf8mb4_unicode_ci
- 避免混用不同字符集造成乱码
```

**🔹 存储引擎选择策略**
```
InnoDB适用：事务要求、高并发、数据完整性
MyISAM适用：读多写少、全文检索、历史数据
Memory适用：临时数据、缓存表、会话存储
```

**🔹 索引使用的平衡点**
```
索引收益：查询速度提升、排序优化
索引成本：存储空间、更新性能下降
优化原则：为常用查询创建，避免过度索引
```

### 10.3 日常运维检查清单


**📅 每日检查**
- ☑️ 检查MySQL服务状态
- ☑️ 监控连接数使用情况
- ☑️ 查看慢查询日志
- ☑️ 检查磁盘空间使用

**📅 每周检查**
- ☑️ 备份数据库
- ☑️ 分析表碎片情况
- ☑️ 清理过期日志文件
- ☑️ 检查索引使用效率

**📅 每月检查**
- ☑️ 优化大表结构
- ☑️ 更新表统计信息
- ☑️ 检查配置参数合理性
- ☑️ 制定容量规划

### 10.4 故障排查思路


**🚨 常见问题定位**
```
连接问题排查：
1. 检查max_connections设置
2. 查看当前连接数
3. 分析连接来源和状态
4. 检查网络连通性

性能问题排查：
1. 分析慢查询日志
2. 检查索引使用情况
3. 监控系统资源使用
4. 优化SQL语句

数据问题排查：
1. 检查表完整性
2. 验证数据一致性
3. 分析错误日志
4. 恢复备份数据
```

**🔧 应急处理流程**
```
服务异常时：
1. 立即检查服务状态
2. 查看错误日志信息
3. 尝试重启服务
4. 联系相关人员

数据异常时：
1. 停止写入操作
2. 评估影响范围
3. 从备份恢复数据
4. 分析原因并修复
```

### 10.5 安全和性能建议


**🛡️ 安全配置要点**
- 🔐 **用户权限**：最小权限原则，定期审核账户
- 📝 **日志记录**：启用所有重要操作日志
- 🔒 **网络安全**：限制访问IP，使用SSL连接
- 💾 **数据备份**：定期备份，验证备份有效性

**⚡ 性能优化要点**
- 📊 **索引策略**：合理创建，定期分析使用情况
- 🔧 **参数调优**：根据业务特点调整配置参数
- 📈 **监控告警**：建立完善的监控和告警机制
- 🗂️ **架构优化**：读写分离，分库分表

**核心记忆**：
- MySQL操作重在实践，备份先于一切操作
- 索引是查询性能的关键，但要避免过度创建
- 日志是故障排查的重要依据，要合理配置保留
- 连接数管理关系系统稳定，需要持续监控优化