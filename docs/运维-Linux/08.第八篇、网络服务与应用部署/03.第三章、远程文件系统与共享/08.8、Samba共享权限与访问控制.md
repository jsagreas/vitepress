---
title: 8ã€Sambaå…±äº«æƒé™ä¸è®¿é—®æ§åˆ¶
---
## ğŸ“š ç›®å½•

1. [Sambaæƒé™ä½“ç³»æ¦‚è¿°](#1-sambaæƒé™ä½“ç³»æ¦‚è¿°)
2. [å…±äº«çº§åˆ«æƒé™é…ç½®](#2-å…±äº«çº§åˆ«æƒé™é…ç½®)
3. [æ–‡ä»¶ç³»ç»Ÿæƒé™ä¸Sambaæƒé™å…³ç³»](#3-æ–‡ä»¶ç³»ç»Ÿæƒé™ä¸sambaæƒé™å…³ç³»)
4. [è®¿é—®æ§åˆ¶åˆ—è¡¨è®¾ç½®](#4-è®¿é—®æ§åˆ¶åˆ—è¡¨è®¾ç½®)
5. [é«˜çº§è®¿é—®æ§åˆ¶ç­–ç•¥](#5-é«˜çº§è®¿é—®æ§åˆ¶ç­–ç•¥)
6. [æƒé™ç»§æ‰¿ä¸å®‰å…¨é…ç½®](#6-æƒé™ç»§æ‰¿ä¸å®‰å…¨é…ç½®)
7. [å®é™…åº”ç”¨åœºæ™¯é…ç½®](#7-å®é™…åº”ç”¨åœºæ™¯é…ç½®)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” Sambaæƒé™ä½“ç³»æ¦‚è¿°


### 1.1 Sambaæƒé™æ˜¯ä»€ä¹ˆ


**ç®€å•ç†è§£**ï¼šSambaæƒé™å°±åƒæ˜¯ç»™ä½ å®¶å¤§é—¨å’Œæˆ¿é—´è£…äº†ä¸¤å¥—é”
- **ç¬¬ä¸€å¥—é”**ï¼šSambaè‡ªå·±çš„æƒé™æ§åˆ¶ï¼ˆè°èƒ½è¿›é—¨ï¼‰
- **ç¬¬äºŒå¥—é”**ï¼šLinuxæ–‡ä»¶ç³»ç»Ÿæƒé™ï¼ˆè¿›é—¨åèƒ½åšä»€ä¹ˆï¼‰

```
è®¿é—®æµç¨‹ï¼š
ç”¨æˆ·è¯·æ±‚ â†’ Sambaæƒé™æ£€æŸ¥ â†’ æ–‡ä»¶ç³»ç»Ÿæƒé™æ£€æŸ¥ â†’ æœ€ç»ˆæ“ä½œ
   â†“           â†“               â†“              â†“
å®¢æˆ·ç«¯     å…±äº«è®¿é—®æƒé™      æ–‡ä»¶è¯»å†™æƒé™     å®é™…æ–‡ä»¶æ“ä½œ
```

### 1.2 åŒé‡æƒé™æœºåˆ¶


**ä¸ºä»€ä¹ˆéœ€è¦ä¸¤å¥—æƒé™**ï¼š
- **ç½‘ç»œè®¿é—®æ§åˆ¶**ï¼šæ§åˆ¶è°èƒ½é€šè¿‡ç½‘ç»œè®¿é—®å…±äº«
- **æ–‡ä»¶æ“ä½œæ§åˆ¶**ï¼šæ§åˆ¶è®¿é—®è€…èƒ½å¯¹æ–‡ä»¶åšä»€ä¹ˆæ“ä½œ

```
æƒé™å±‚æ¬¡å›¾ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç½‘ç»œå®¢æˆ·ç«¯     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
    â”‚ Sambaæƒé™ â”‚ â† ç¬¬ä¸€å±‚ï¼šç½‘ç»œè®¿é—®æ§åˆ¶
    â”‚   æ£€æŸ¥    â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
          â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
    â”‚Linuxæ–‡ä»¶  â”‚ â† ç¬¬äºŒå±‚ï¼šæ–‡ä»¶ç³»ç»Ÿæƒé™
    â”‚ç³»ç»Ÿæƒé™   â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
          â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
    â”‚ å®é™…æ“ä½œ  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 æƒé™é…ç½®æ–‡ä»¶ç»“æ„


**ä¸»è¦é…ç½®æ–‡ä»¶**ï¼š`/etc/samba/smb.conf`

```ini
# å…¨å±€é…ç½®æ®µ
[global]
    workgroup = WORKGROUP
    security = user
    
# å…±äº«é…ç½®æ®µ
[å…±äº«åç§°]
    path = /å…±äº«è·¯å¾„
    æƒé™é…ç½®é¡¹ = å€¼
```

---

## 2. âš™ï¸ å…±äº«çº§åˆ«æƒé™é…ç½®


### 2.1 åŸºæœ¬å…±äº«æƒé™é¡¹


**æ ¸å¿ƒæƒé™é…ç½®é¡¹**ï¼š

| é…ç½®é¡¹ | å«ä¹‰ | ç¤ºä¾‹å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `valid users` | **å…è®¸è®¿é—®çš„ç”¨æˆ·** | `user1,user2` | åªæœ‰è¿™äº›ç”¨æˆ·èƒ½è®¿é—® |
| `invalid users` | **ç¦æ­¢è®¿é—®çš„ç”¨æˆ·** | `guest,nobody` | è¿™äº›ç”¨æˆ·è¢«æ‹’ç»è®¿é—® |
| `read only` | **æ˜¯å¦åªè¯»** | `yes/no` | yes=åªè¯»ï¼Œno=å¯å†™ |
| `writable` | **æ˜¯å¦å¯å†™** | `yes/no` | ä¸read onlyç›¸å |
| `browseable` | **æ˜¯å¦å¯æµè§ˆ** | `yes/no` | æ˜¯å¦åœ¨ç½‘ç»œé‚»å±…ä¸­æ˜¾ç¤º |

### 2.2 åªè¯»å†™å…¥æƒé™æ§åˆ¶


**åœºæ™¯1ï¼šå®Œå…¨åªè¯»å…±äº«**
```ini
[documents]
    comment = æ–‡æ¡£èµ„æ–™ï¼ˆåªè¯»ï¼‰
    path = /srv/documents
    read only = yes          # æ‰€æœ‰ç”¨æˆ·åªèƒ½è¯»
    valid users = @staff     # åªæœ‰staffç»„æˆå‘˜å¯ä»¥è®¿é—®
    browseable = yes
```

**åœºæ™¯2ï¼šè¯»å†™åˆ†ç¦»æ§åˆ¶**
```ini
[projects]
    comment = é¡¹ç›®æ–‡ä»¶å¤¹
    path = /srv/projects
    read only = no           # é»˜è®¤å¯å†™
    read list = guest,intern # è¿™äº›ç”¨æˆ·åªèƒ½è¯»
    write list = manager,dev # è¿™äº›ç”¨æˆ·å¯ä»¥å†™
    valid users = @staff     # æ‰€æœ‰staffç»„æˆå‘˜éƒ½èƒ½è®¿é—®
```

**åœºæ™¯3ï¼šç®¡ç†å‘˜å®Œå…¨æ§åˆ¶**
```ini
[admin-files]
    comment = ç®¡ç†å‘˜æ–‡ä»¶
    path = /srv/admin
    admin users = root,admin # ç®¡ç†å‘˜ç”¨æˆ·ï¼ˆç»•è¿‡æ‰€æœ‰æƒé™æ£€æŸ¥ï¼‰
    valid users = @admin     # åªæœ‰adminç»„å¯ä»¥è®¿é—®
    create mask = 0755       # æ–°å»ºæ–‡ä»¶æƒé™
    directory mask = 0755    # æ–°å»ºç›®å½•æƒé™
```

### 2.3 éšè—å…±äº«é…ç½®æ–¹æ³•


**ä»€ä¹ˆæ˜¯éšè—å…±äº«**ï¼šä¸åœ¨ç½‘ç»œé‚»å±…ä¸­æ˜¾ç¤ºï¼Œä½†çŸ¥é“åå­—çš„ç”¨æˆ·å¯ä»¥ç›´æ¥è®¿é—®

```ini
[secret-share]
    comment = éšè—çš„å…±äº«æ–‡ä»¶å¤¹
    path = /srv/secret
    browseable = no          # å…³é”®ï¼šä¸æ˜¾ç¤ºåœ¨æµè§ˆåˆ—è¡¨ä¸­
    valid users = admin,manager
    writable = yes
```

**è®¿é—®éšè—å…±äº«**ï¼š
```bash
# Windowsè®¿é—®æ–¹å¼
\\æœåŠ¡å™¨IP\secret-share

# Linuxè®¿é—®æ–¹å¼
smbclient //æœåŠ¡å™¨IP/secret-share -U ç”¨æˆ·å
```

---

## 3. ğŸ”— æ–‡ä»¶ç³»ç»Ÿæƒé™ä¸Sambaæƒé™å…³ç³»


### 3.1 æƒé™æ£€æŸ¥é¡ºåº


**é‡è¦åŸåˆ™**ï¼šä¸¤å¥—æƒé™éƒ½è¦é€šè¿‡ï¼Œå–**æœ€ä¸¥æ ¼**çš„é‚£ä¸ª

```
æƒé™æ£€æŸ¥æµç¨‹ï¼š
1. Sambaæƒé™æ£€æŸ¥ â†’ ç”¨æˆ·æ˜¯å¦å…è®¸è®¿é—®å…±äº«ï¼Ÿ
2. æ–‡ä»¶ç³»ç»Ÿæƒé™æ£€æŸ¥ â†’ ç”¨æˆ·å¯¹æ–‡ä»¶æ˜¯å¦æœ‰æ“ä½œæƒé™ï¼Ÿ
3. æœ€ç»ˆæƒé™ = min(Sambaæƒé™, æ–‡ä»¶ç³»ç»Ÿæƒé™)
```

### 3.2 å®é™…æ¡ˆä¾‹åˆ†æ


**æ¡ˆä¾‹ï¼šç”¨æˆ·æ— æ³•å†™å…¥æ–‡ä»¶**

```bash
# Sambaé…ç½®
[test-share]
    path = /srv/test
    writable = yes           # Sambaå…è®¸å†™å…¥
    valid users = john

# æ–‡ä»¶ç³»ç»Ÿæƒé™
$ ls -ld /srv/test
drwxr-xr-x 2 root root 4096 Jan 15 10:00 /srv/test
#     â†‘
#   å…¶ä»–ç”¨æˆ·åªæœ‰è¯»æƒé™ï¼Œjohnæ— æ³•å†™å…¥ï¼
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ–¹æ³•1ï¼šæ”¹å˜ç›®å½•æ‰€æœ‰è€…
sudo chown john:john /srv/test

# æ–¹æ³•2ï¼šç»™å…¶ä»–ç”¨æˆ·å†™æƒé™ï¼ˆä¸æ¨èï¼‰
sudo chmod 777 /srv/test

# æ–¹æ³•3ï¼šä½¿ç”¨ç»„æƒé™ï¼ˆæ¨èï¼‰
sudo chgrp sambashare /srv/test
sudo chmod g+w /srv/test
sudo usermod -a -G sambashare john
```

### 3.3 æƒé™æ˜ å°„æœºåˆ¶


**Sambaç”¨æˆ·ä¸ç³»ç»Ÿç”¨æˆ·æ˜ å°„**ï¼š

```
Windowsç”¨æˆ· â†’ Sambaç”¨æˆ· â†’ Linuxç³»ç»Ÿç”¨æˆ· â†’ æ–‡ä»¶ç³»ç»Ÿæƒé™
    â†“            â†“           â†“            â†“
  john      sambaå¯†ç     ç³»ç»Ÿç”¨æˆ·john    /etc/passwd
```

**æŸ¥çœ‹ç”¨æˆ·æ˜ å°„**ï¼š
```bash
# æŸ¥çœ‹Sambaç”¨æˆ·åˆ—è¡¨
sudo pdbedit -L

# æŸ¥çœ‹ç‰¹å®šç”¨æˆ·ä¿¡æ¯
sudo pdbedit -u john -v
```

---

## 4. ğŸ“‹ è®¿é—®æ§åˆ¶åˆ—è¡¨è®¾ç½®


### 4.1 IPåœ°å€è®¿é—®é™åˆ¶


**æŒ‰IPåœ°å€æ§åˆ¶è®¿é—®**ï¼š

```ini
[secure-data]
    comment = å®‰å…¨æ•°æ®ï¼ˆIPé™åˆ¶ï¼‰
    path = /srv/secure
    
    # åªå…è®¸ç‰¹å®šIPè®¿é—®
    hosts allow = 192.168.1.10, 192.168.1.20
    
    # æˆ–è€…å…è®¸æ•´ä¸ªç½‘æ®µ
    hosts allow = 192.168.1.0/24
    
    # ç¦æ­¢ç‰¹å®šIP
    hosts deny = 192.168.1.100
    
    # é»˜è®¤ç­–ç•¥
    hosts allow = 192.168.1.0/24
    hosts deny = ALL          # æ‹’ç»å…¶ä»–æ‰€æœ‰IP
```

**å¤æ‚IPæ§åˆ¶ç¤ºä¾‹**ï¼š
```ini
[office-files]
    path = /srv/office
    # å…è®¸åŠå…¬å®¤ç½‘æ®µå’ŒVPNç½‘æ®µ
    hosts allow = 192.168.1.0/24, 10.0.0.0/8
    # ä½†æ’é™¤è®¿å®¢ç½‘ç»œ
    hosts deny = 192.168.1.200/29
    valid users = @employees
```

### 4.2 ç”¨æˆ·ç»„è®¿é—®æ§åˆ¶


**åŸºäºç”¨æˆ·ç»„çš„ç²¾ç»†æ§åˆ¶**ï¼š

```ini
[department-share]
    comment = éƒ¨é—¨å…±äº«æ–‡ä»¶å¤¹
    path = /srv/departments/%g  # %gä¼šè¢«æ›¿æ¢ä¸ºç”¨æˆ·çš„ä¸»ç»„å
    
    # ç»„çº§åˆ«è®¿é—®æ§åˆ¶
    valid users = @sales, @marketing, @dev
    invalid users = @interns    # å®ä¹ ç”Ÿä¸èƒ½è®¿é—®
    
    # ä¸åŒç»„çš„ä¸åŒæƒé™
    read list = @sales         # é”€å”®ç»„åªè¯»
    write list = @dev          # å¼€å‘ç»„å¯å†™
    admin users = @managers    # ç®¡ç†ç»„å®Œå…¨æ§åˆ¶
```

**åˆ›å»ºå’Œç®¡ç†ç”¨æˆ·ç»„**ï¼š
```bash
# åˆ›å»ºSambaç”¨æˆ·ç»„
sudo groupadd sales
sudo groupadd dev
sudo groupadd managers

# å°†ç”¨æˆ·åŠ å…¥ç»„
sudo usermod -a -G sales alice
sudo usermod -a -G dev bob
sudo usermod -a -G managers charlie

# æŸ¥çœ‹ç”¨æˆ·æ‰€å±ç»„
groups alice
id alice
```

### 4.3 æ—¶é—´å’Œä¼šè¯æ§åˆ¶


**åŸºäºæ—¶é—´çš„è®¿é—®æ§åˆ¶**ï¼š
```ini
[time-limited]
    comment = é™æ—¶è®¿é—®å…±äº«
    path = /srv/temp
    
    # è‡ªå®šä¹‰è„šæœ¬æ§åˆ¶è®¿é—®æ—¶é—´
    preexec = /scripts/check_time.sh %u %I
    # %u = ç”¨æˆ·å, %I = å®¢æˆ·ç«¯IP
```

**ä¼šè¯é™åˆ¶é…ç½®**ï¼š
```ini
[global]
    # é™åˆ¶æ¯ä¸ªç”¨æˆ·çš„å¹¶å‘è¿æ¥æ•°
    max connections = 5
    
    # ç©ºé—²è¶…æ—¶ï¼ˆç§’ï¼‰
    deadtime = 30
```

---

## 5. ğŸ›¡ï¸ é«˜çº§è®¿é—®æ§åˆ¶ç­–ç•¥


### 5.1 åŠ¨æ€æƒé™æ§åˆ¶


**åŸºäºè·¯å¾„çš„åŠ¨æ€æƒé™**ï¼š
```ini
[user-homes]
    comment = ç”¨æˆ·ä¸ªäººç›®å½•
    path = /home/%u           # %uè‡ªåŠ¨æ›¿æ¢ä¸ºç”¨æˆ·å
    valid users = %u          # åªæœ‰ç›®å½•æ‰€æœ‰è€…èƒ½è®¿é—®
    writable = yes
    browseable = no          # ä¸æ˜¾ç¤ºåœ¨å…±äº«åˆ—è¡¨ä¸­
```

**æŒ‰æ–‡ä»¶ç±»å‹çš„è®¿é—®æ§åˆ¶**ï¼š
```ini
[media-share]
    comment = å¤šåª’ä½“æ–‡ä»¶
    path = /srv/media
    
    # ç¦æ­¢ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶
    veto files = /*.exe/*.bat/*.com/*.cmd/
    
    # åˆ é™¤è¢«å¦å†³çš„æ–‡ä»¶
    delete veto files = yes
    
    # éšè—ç‰¹å®šæ–‡ä»¶
    hide files = /.*Thumbs.db*/
```

### 5.2 æƒé™ç»§æ‰¿é…ç½®


**ç›®å½•æƒé™ç»§æ‰¿è®¾ç½®**ï¼š
```ini
[project-data]
    comment = é¡¹ç›®æ•°æ®ï¼ˆæƒé™ç»§æ‰¿ï¼‰
    path = /srv/projects
    
    # æ–°å»ºæ–‡ä»¶çš„æƒé™æ©ç 
    create mask = 0664        # rw-rw-r--
    force create mode = 0644  # å¼ºåˆ¶è®¾ç½®çš„ä½
    
    # æ–°å»ºç›®å½•çš„æƒé™æ©ç   
    directory mask = 0775     # rwxrwxr-x
    force directory mode = 0755 # å¼ºåˆ¶è®¾ç½®çš„ä½
    
    # ç»§æ‰¿çˆ¶ç›®å½•çš„ç”¨æˆ·å’Œç»„
    inherit acls = yes
    inherit permissions = yes
```

**æƒé™æ©ç è§£é‡Š**ï¼š
```
create mask = 0664
    â†“
0664 = 110 110 100 (äºŒè¿›åˆ¶)
       â†“   â†“   â†“
     æ‰€æœ‰è€… ç»„ å…¶ä»–
     rw-   rw- r--

force create mode = 0644
å¼ºåˆ¶æ–°æ–‡ä»¶è‡³å°‘æœ‰644æƒé™ï¼ˆrw-r--r--ï¼‰
```

### 5.3 å®‰å…¨å¢å¼ºé…ç½®


**åŸºæœ¬å®‰å…¨è®¾ç½®**ï¼š
```ini
[secure-share]
    comment = é«˜å®‰å…¨çº§åˆ«å…±äº«
    path = /srv/secure
    
    # å®‰å…¨ç›¸å…³é…ç½®
    guest ok = no            # ç¦æ­¢åŒ¿åè®¿é—®
    public = no              # ä¸å…¬å¼€
    
    # æ—¥å¿—è®°å½•
    log level = 3
    max log size = 1000
    
    # åŠ å¯†è¿æ¥
    smb encrypt = required   # è¦æ±‚åŠ å¯†è¿æ¥
    
    # ç¦ç”¨æ—§åè®®
    min protocol = SMB2
```

---

## 6. ğŸ”„ æƒé™ç»§æ‰¿ä¸å®‰å…¨é…ç½®


### 6.1 ACLæƒé™ç»§æ‰¿


**ä»€ä¹ˆæ˜¯ACLæƒé™ç»§æ‰¿**ï¼šå­ç›®å½•å’Œæ–‡ä»¶è‡ªåŠ¨è·å¾—çˆ¶ç›®å½•çš„æƒé™è®¾ç½®

```bash
# å¯ç”¨ACLæ”¯æŒ
sudo mount -o remount,acl /srv

# è®¾ç½®é»˜è®¤ACLæƒé™
sudo setfacl -d -m u:john:rwx /srv/projects
sudo setfacl -d -m g:dev:r-x /srv/projects

# æŸ¥çœ‹ACLæƒé™
getfacl /srv/projects
```

**Sambaä¸­çš„ACLç»§æ‰¿é…ç½®**ï¼š
```ini
[projects-acl]
    comment = ACLæƒé™ç»§æ‰¿ç¤ºä¾‹
    path = /srv/projects
    
    # å¯ç”¨ACLç»§æ‰¿
    inherit acls = yes
    inherit permissions = yes
    inherit owner = yes
    
    # æ˜ å°„ACLåˆ°DOSå±æ€§
    map acl inherit = yes
    store dos attributes = yes
```

### 6.2 Windowsé£æ ¼æƒé™æ˜ å°„


**DOSå±æ€§æ˜ å°„**ï¼š
```ini
[windows-style]
    comment = Windowsé£æ ¼æƒé™
    path = /srv/winshare
    
    # DOSå±æ€§æ˜ å°„
    map archive = yes        # å­˜æ¡£å±æ€§
    map hidden = yes         # éšè—å±æ€§  
    map readonly = yes       # åªè¯»å±æ€§
    map system = yes         # ç³»ç»Ÿå±æ€§
    
    # æ‰©å±•å±æ€§å­˜å‚¨
    ea support = yes
    store dos attributes = yes
```

### 6.3 å®¡è®¡å’Œæ—¥å¿—é…ç½®


**è®¿é—®å®¡è®¡é…ç½®**ï¼š
```ini
[audited-share]
    comment = å®¡è®¡å…±äº«
    path = /srv/audit
    
    # è¯¦ç»†æ—¥å¿—è®°å½•
    log level = 3
    log file = /var/log/samba/audit-%m.log
    max log size = 10000
    
    # VFSå®¡è®¡æ¨¡å—
    vfs objects = full_audit
    full_audit:prefix = %u|%I|%S
    full_audit:success = open,write,rename,unlink,mkdir,rmdir
    full_audit:failure = all
```

**æŸ¥çœ‹å®¡è®¡æ—¥å¿—**ï¼š
```bash
# æŸ¥çœ‹ç‰¹å®šç”¨æˆ·çš„æ“ä½œæ—¥å¿—
sudo grep "john" /var/log/samba/audit-*.log

# å®æ—¶ç›‘æ§è®¿é—®
sudo tail -f /var/log/samba/log.smbd
```

---

## 7. ğŸ¯ å®é™…åº”ç”¨åœºæ™¯é…ç½®


### 7.1 ä¼ä¸šéƒ¨é—¨å…±äº«æ–¹æ¡ˆ


**å¤šéƒ¨é—¨è®¿é—®æ§åˆ¶**ï¼š
```ini
# é”€å”®éƒ¨é—¨å…±äº«
[sales]
    comment = é”€å”®éƒ¨é—¨æ–‡ä»¶
    path = /srv/departments/sales
    valid users = @sales, @managers
    read list = @sales
    write list = @managers
    admin users = @sales-admin
    create mask = 0664
    directory mask = 0775

# ç ”å‘éƒ¨é—¨å…±äº«  
[development]
    comment = ç ”å‘éƒ¨é—¨æ–‡ä»¶
    path = /srv/departments/dev
    valid users = @developers, @managers
    writable = yes
    admin users = @dev-lead
    # ç¦æ­¢ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶åˆ°æºç ç›®å½•
    veto files = /*.exe/*.dll/*.so/
    
# å…¬å…±æ–‡æ¡£åŒº
[public-docs]
    comment = å…¬å…±æ–‡æ¡£
    path = /srv/public
    guest ok = yes           # å…è®¸åŒ¿åè®¿é—®
    read only = yes          # åªè¯»
    browseable = yes
```

### 7.2 å®¶åº­NASæƒé™é…ç½®


**å®¶åº­æˆå‘˜æƒé™æ§åˆ¶**ï¼š
```ini
# å®¶åº­ç…§ç‰‡å…±äº«
[family-photos]
    comment = å®¶åº­ç…§ç‰‡
    path = /srv/photos
    valid users = dad,mom,@kids
    read list = @kids        # å­©å­åªèƒ½çœ‹
    write list = dad,mom     # çˆ¶æ¯å¯ä»¥ä¸Šä¼ 
    
    # æŒ‰å¹´ä»½è‡ªåŠ¨åˆ›å»ºç›®å½•
    root preexec = mkdir -p /srv/photos/%Y
    
# ä¸ªäººæ–‡ä»¶å¤¹
[personal]
    comment = ä¸ªäººæ–‡ä»¶å¤¹
    path = /srv/personal/%u
    valid users = %u
    writable = yes
    browseable = no
    
# åª’ä½“ä¸­å¿ƒ
[media]
    comment = å½±éŸ³æ–‡ä»¶
    path = /srv/media
    guest ok = yes
    read only = yes
    # åªå…è®¸åª’ä½“æ–‡ä»¶æ ¼å¼
    veto files = /*.exe/*.doc/*.pdf/
```

### 7.3 å¼€å‘å›¢é˜Ÿåä½œé…ç½®


**ä»£ç ä»“åº“å…±äº«**ï¼š
```ini
[git-repos]
    comment = Gitä»£ç ä»“åº“
    path = /srv/git
    valid users = @developers
    writable = yes
    
    # ä¿æŠ¤å…³é”®æ–‡ä»¶
    veto files = /.git/config/id_rsa/
    
    # è„šæœ¬é’©å­
    preexec = /scripts/git-access-log.sh %u %I
    
[build-artifacts]
    comment = æ„å»ºäº§ç‰©
    path = /srv/builds
    read list = @developers, @testers
    write list = @build-server
    admin users = @devops
    
    # è‡ªåŠ¨æ¸…ç†æ—§æ–‡ä»¶
    postexec = /scripts/cleanup-old-builds.sh
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ åŒé‡æƒé™æœºåˆ¶ï¼šSambaæƒé™ + Linuxæ–‡ä»¶ç³»ç»Ÿæƒé™
ğŸ”¸ æƒé™æ£€æŸ¥é¡ºåºï¼šç½‘ç»œè®¿é—® â†’ æ–‡ä»¶æ“ä½œ â†’ æœ€ç»ˆæƒé™
ğŸ”¸ åŸºæœ¬æƒé™é¡¹ï¼švalid users, read only, writable, browseable
ğŸ”¸ è®¿é—®æ§åˆ¶ï¼šIPé™åˆ¶, ç”¨æˆ·ç»„æ§åˆ¶, æ—¶é—´é™åˆ¶
ğŸ”¸ æƒé™ç»§æ‰¿ï¼šACLç»§æ‰¿, ç›®å½•æƒé™æ©ç è®¾ç½®
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æƒé™ç”Ÿæ•ˆåŸåˆ™**
```
æœ€ç»ˆæƒé™ = min(Sambaæƒé™, æ–‡ä»¶ç³»ç»Ÿæƒé™)
- ä¸¤å¥—æƒé™éƒ½è¦æ£€æŸ¥
- å–æœ€ä¸¥æ ¼çš„é™åˆ¶
- ä»»ä½•ä¸€ä¸ªæ‹’ç»éƒ½æ— æ³•è®¿é—®
```

**ğŸ”¹ ç”¨æˆ·æ˜ å°„æµç¨‹**  
```
Windowsç”¨æˆ· â†’ Sambaè®¤è¯ â†’ Linuxç”¨æˆ· â†’ æ–‡ä»¶æƒé™
æ¯ä¸€æ­¥éƒ½è¦é…ç½®æ­£ç¡®æ‰èƒ½æ­£å¸¸å·¥ä½œ
```

**ğŸ”¹ éšè—å…±äº«çš„ä½œç”¨**
```
- ä¸åœ¨ç½‘ç»œé‚»å±…æ˜¾ç¤º
- æé«˜å®‰å…¨æ€§ï¼ˆå®‰å…¨é€šè¿‡éšè”½ï¼‰
- éœ€è¦çŸ¥é“ç¡®åˆ‡å…±äº«åæ‰èƒ½è®¿é—®
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**æƒé™é…ç½®æœ€ä½³å®è·µ**ï¼š
- âœ… **æœ€å°æƒé™åŸåˆ™**ï¼šåªç»™å¿…éœ€çš„æœ€å°æƒé™
- âœ… **ç»„æƒé™ç®¡ç†**ï¼šé€šè¿‡ç»„è€Œä¸æ˜¯ä¸ªäººåˆ†é…æƒé™  
- âœ… **åˆ†å±‚æ§åˆ¶**ï¼šç½‘ç»œè®¿é—® + æ–‡ä»¶ç³»ç»ŸåŒé‡ä¿æŠ¤
- âœ… **å®¡è®¡æ—¥å¿—**ï¼šè®°å½•é‡è¦æ“ä½œä¾¿äºè¿½è¸ª
- âœ… **å®šæœŸæ£€æŸ¥**ï¼šå®šæœŸå®¡æŸ¥æƒé™é…ç½®

**å¸¸è§é—®é¢˜æ’æŸ¥**ï¼š
```bash
# æ£€æŸ¥Sambaé…ç½®è¯­æ³•
sudo testparm

# æŸ¥çœ‹å…±äº«æƒé™
sudo smbclient -L localhost -U%

# æµ‹è¯•ç”¨æˆ·è®¿é—®
sudo smbclient //localhost/å…±äº«å -U ç”¨æˆ·å

# æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿæƒé™
ls -la /å…±äº«è·¯å¾„
getfacl /å…±äº«è·¯å¾„
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- Sambaæƒé™æ§åˆ¶è°èƒ½è¿›é—¨ï¼Œæ–‡ä»¶æƒé™æ§åˆ¶è¿›é—¨åèƒ½åšä»€ä¹ˆ
- é…ç½®æƒé™è¦è€ƒè™‘ç½‘ç»œå®‰å…¨å’Œæ–‡ä»¶å®‰å…¨ä¸¤ä¸ªå±‚é¢
- æƒé™ç»§æ‰¿å’ŒACLè®©å¤æ‚æƒé™ç®¡ç†å˜å¾—ç®€å•
- éšè—å…±äº«ã€IPé™åˆ¶ã€æ—¶é—´æ§åˆ¶æä¾›å¤šå±‚å®‰å…¨é˜²æŠ¤