---
title: 3ã€SSHå¯†é’¥è®¤è¯ä½“ç³»
---
## ğŸ“š ç›®å½•

1. [SSHå¯†é’¥è®¤è¯åŸºç¡€æ¦‚å¿µ](#1-SSHå¯†é’¥è®¤è¯åŸºç¡€æ¦‚å¿µ)
2. [å…¬é’¥ç§é’¥åŠ å¯†åŸç†](#2-å…¬é’¥ç§é’¥åŠ å¯†åŸç†)
3. [å¯†é’¥ç”Ÿæˆä¸ssh-keygenå‘½ä»¤](#3-å¯†é’¥ç”Ÿæˆä¸ssh-keygenå‘½ä»¤)
4. [å¯†é’¥ç±»å‹é€‰æ‹©ä¸å¯¹æ¯”](#4-å¯†é’¥ç±»å‹é€‰æ‹©ä¸å¯¹æ¯”)
5. [å¯†é’¥éƒ¨ç½²ä¸ssh-copy-id](#5-å¯†é’¥éƒ¨ç½²ä¸ssh-copy-id)
6. [authorized_keysæ–‡ä»¶ç®¡ç†](#6-authorized_keysæ–‡ä»¶ç®¡ç†)
7. [å¯†é’¥æƒé™å®‰å…¨é…ç½®](#7-å¯†é’¥æƒé™å®‰å…¨é…ç½®)
8. [å¯†é’¥passphraseç®¡ç†](#8-å¯†é’¥passphraseç®¡ç†)
9. [å¤šå¯†é’¥ç¯å¢ƒé…ç½®](#9-å¤šå¯†é’¥ç¯å¢ƒé…ç½®)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” SSHå¯†é’¥è®¤è¯åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯SSHå¯†é’¥è®¤è¯


**ç®€å•ç†è§£**ï¼šSSHå¯†é’¥è®¤è¯å°±åƒæ˜¯ç»™ä½ å®¶é—¨ä¸Šè£…äº†ä¸€æŠŠç‰¹æ®Šçš„é”ï¼Œåªæœ‰æ‹¿ç€é…å¥—é’¥åŒ™çš„äººæ‰èƒ½è¿›æ¥ï¼Œè€Œä¸”è¿™æŠŠé’¥åŒ™æ˜¯ç‹¬ä¸€æ— äºŒçš„ã€‚

> **ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µ**
> 
> SSHå¯†é’¥è®¤è¯æ˜¯ä¸€ç§æ¯”å¯†ç æ›´å®‰å…¨çš„è¿œç¨‹ç™»å½•æ–¹å¼ï¼Œé€šè¿‡ä¸€å¯¹æ•°å­¦ä¸Šç›¸å…³çš„å¯†é’¥ï¼ˆå…¬é’¥å’Œç§é’¥ï¼‰æ¥è¯æ˜èº«ä»½ï¼Œæ— éœ€æ¯æ¬¡è¾“å…¥å¯†ç ã€‚

**ä¸å¯†ç è®¤è¯çš„å¯¹æ¯”ï¼š**
```
ä¼ ç»Ÿå¯†ç è®¤è¯ï¼š
ç”¨æˆ·è¾“å…¥å¯†ç  â†’ æœåŠ¡å™¨éªŒè¯ â†’ å…è®¸/æ‹’ç»ç™»å½•
é—®é¢˜ï¼šå¯†ç å¯èƒ½è¢«çŒœæµ‹ã€çªƒå–ã€æš´åŠ›ç ´è§£

å¯†é’¥è®¤è¯ï¼š
å®¢æˆ·ç«¯ç”¨ç§é’¥ç­¾å â†’ æœåŠ¡å™¨ç”¨å…¬é’¥éªŒè¯ â†’ å…è®¸/æ‹’ç»ç™»å½•
ä¼˜åŠ¿ï¼šæ•°å­¦ä¸Šå‡ ä¹ä¸å¯ç ´è§£ï¼Œæ— éœ€è®°å¿†å¤æ‚å¯†ç 
```

### 1.2 SSHå¯†é’¥è®¤è¯çš„å·¥ä½œæµç¨‹


```
SSHå¯†é’¥è®¤è¯è¿‡ç¨‹ï¼š

å®¢æˆ·ç«¯                     æœåŠ¡å™¨
   |                          |
   |--[1]è¿æ¥è¯·æ±‚------------>|
   |                          |
   |<-[2]éšæœºè´¨è¯¢æ•°æ®---------|
   |                          |
   |--[3]ç§é’¥ç­¾åçš„å“åº”------>|
   |                          |
   |<-[4]éªŒè¯æˆåŠŸï¼Œå…è®¸ç™»å½•---|
   |                          |
```

**è¯¦ç»†æ­¥éª¤è¯´æ˜ï¼š**
1. **è¿æ¥å»ºç«‹**ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·SSHè¿æ¥
2. **èº«ä»½è´¨è¯¢**ï¼šæœåŠ¡å™¨å‘é€éšæœºæ•°æ®ä½œä¸º"é¢˜ç›®"
3. **ç­¾åè¯æ˜**ï¼šå®¢æˆ·ç«¯ç”¨ç§é’¥å¯¹æ•°æ®ç­¾åä½œä¸º"ç­”æ¡ˆ"
4. **éªŒè¯é€šè¿‡**ï¼šæœåŠ¡å™¨ç”¨å…¬é’¥éªŒè¯ç­¾åï¼Œç¡®è®¤èº«ä»½

---

## 2. ğŸ”‘ å…¬é’¥ç§é’¥åŠ å¯†åŸç†


### 2.1 éå¯¹ç§°åŠ å¯†åŸºç¡€


**ç”Ÿæ´»ç±»æ¯”ç†è§£ï¼š**
> **ğŸ’­ é‚®ç®±ç±»æ¯”**
> 
> æƒ³è±¡å…¬é’¥æ˜¯ä½ çš„é‚®ç®±åœ°å€ï¼Œä»»ä½•äººéƒ½å¯ä»¥çŸ¥é“ï¼Œç”¨æ¥ç»™ä½ å‘é‚®ä»¶ã€‚
> ç§é’¥æ˜¯ä½ çš„é‚®ç®±å¯†ç ï¼Œåªæœ‰ä½ çŸ¥é“ï¼Œç”¨æ¥æ‰“å¼€é‚®ç®±è¯»é‚®ä»¶ã€‚
> åˆ«äººå¯ä»¥ç”¨ä½ çš„é‚®ç®±åœ°å€ç»™ä½ å‘ä¿¡ï¼Œä½†åªæœ‰ä½ èƒ½ç”¨å¯†ç æ‰“å¼€çœ‹ã€‚

**æ•°å­¦åŸç†ï¼ˆç®€åŒ–ç†è§£ï¼‰ï¼š**
```
å¯†é’¥å¯¹ç”Ÿæˆè¿‡ç¨‹ï¼š
1. é€‰æ‹©å¤§è´¨æ•° â†’ 2. æ•°å­¦è¿ç®— â†’ 3. ç”Ÿæˆå¯†é’¥å¯¹

å…¬é’¥ï¼šå¯ä»¥å…¬å¼€åˆ†äº«ï¼Œç”¨äºåŠ å¯†å’ŒéªŒè¯ç­¾å
ç§é’¥ï¼šå¿…é¡»ä¿å¯†ï¼Œç”¨äºè§£å¯†å’Œç”Ÿæˆç­¾å

æ ¸å¿ƒç‰¹æ€§ï¼š
â€¢ å…¬é’¥åŠ å¯†çš„å†…å®¹ï¼Œåªèƒ½ç”¨ç§é’¥è§£å¯†
â€¢ ç§é’¥ç­¾åçš„å†…å®¹ï¼Œåªèƒ½ç”¨å…¬é’¥éªŒè¯
â€¢ ä»å…¬é’¥æ— æ³•æ¨ç®—å‡ºç§é’¥ï¼ˆæ•°å­¦éš¾é¢˜ï¼‰
```

### 2.2 SSHä¸­çš„å¯†é’¥ç”¨é€”


**è®¤è¯è¿‡ç¨‹ä¸­çš„è§’è‰²ï¼š**

| è§’è‰² | **ç”¨é€”** | **å­˜æ”¾ä½ç½®** | **å®‰å…¨çº§åˆ«** |
|------|----------|--------------|--------------|
| ğŸ”‘ **ç§é’¥** | `ç­¾åè¯æ˜èº«ä»½` | `å®¢æˆ·ç«¯æœ¬åœ°` | `ç»å¯¹ä¿å¯†` |
| ğŸ”“ **å…¬é’¥** | `éªŒè¯èº«ä»½ç­¾å` | `æœåŠ¡å™¨ç«¯` | `å¯ä»¥å…¬å¼€` |

**ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡å®‰å…¨ï¼š**
```
å®‰å…¨æ€§åˆ†æï¼š
âœ… ç§é’¥ä¸åœ¨ç½‘ç»œä¼ è¾“ï¼Œé¿å…è¢«æˆªè·
âœ… å³ä½¿å…¬é’¥æ³„éœ²ä¹Ÿæ— æ³•ä¼ªé€ èº«ä»½
âœ… æ•°å­¦éš¾é¢˜ä¿è¯æ— æ³•ä»å…¬é’¥æ¨å‡ºç§é’¥
âœ… æ¯æ¬¡è®¤è¯ä½¿ç”¨ä¸åŒéšæœºæ•°ï¼Œé˜²æ­¢é‡æ”¾æ”»å‡»
```

---

## 3. ğŸ› ï¸ å¯†é’¥ç”Ÿæˆä¸ssh-keygenå‘½ä»¤


### 3.1 ssh-keygenå‘½ä»¤è¯¦è§£


**åŸºæœ¬è¯­æ³•ï¼š**
```bash
ssh-keygen -t <å¯†é’¥ç±»å‹> -b <å¯†é’¥é•¿åº¦> -C <æ³¨é‡Š> -f <æ–‡ä»¶å>
```

**å¸¸ç”¨å‚æ•°è¯´æ˜ï¼š**

| å‚æ•° | **è¯´æ˜** | **ç¤ºä¾‹å€¼** | **æ¨èç”¨æ³•** |
|------|----------|------------|--------------|
| `-t` | `å¯†é’¥ç±»å‹` | `rsa, ecdsa, ed25519` | `æ¨èed25519` |
| `-b` | `å¯†é’¥é•¿åº¦` | `2048, 4096` | `RSAç”¨4096ä½` |
| `-C` | `æ³¨é‡Šä¿¡æ¯` | `"user@hostname"` | `ä¾¿äºè¯†åˆ«å¯†é’¥` |
| `-f` | `ä¿å­˜æ–‡ä»¶å` | `~/.ssh/id_rsa` | `é»˜è®¤ä½ç½®` |
| `-N` | `passphrase` | `"å¯†ç "æˆ–""` | `å®‰å…¨vsä¾¿åˆ©` |

### 3.2 ç”Ÿæˆå¯†é’¥çš„å®é™…æ“ä½œ


**æ¨èçš„å¯†é’¥ç”Ÿæˆæ–¹å¼ï¼š**

```bash
# ç”ŸæˆEd25519å¯†é’¥ï¼ˆæ¨èï¼‰
ssh-keygen -t ed25519 -C "your_email@example.com"

# ç”ŸæˆRSAå¯†é’¥ï¼ˆå…¼å®¹æ€§å¥½ï¼‰
ssh-keygen -t rsa -b 4096 -C "your_email@example.com"
```

**äº¤äº’è¿‡ç¨‹ç¤ºä¾‹ï¼š**
```
$ ssh-keygen -t ed25519 -C "user@example.com"

Generating public/private ed25519 key pair.
Enter file in which to save the key (/home/user/.ssh/id_ed25519): [å›è½¦ä½¿ç”¨é»˜è®¤]
Enter passphrase (empty for no passphrase): [è¾“å…¥å¯†ç æˆ–å›è½¦è·³è¿‡]
Enter same passphrase again: [å†æ¬¡ç¡®è®¤å¯†ç ]

Your identification has been saved in /home/user/.ssh/id_ed25519
Your public key has been saved in /home/user/.ssh/id_ed25519.pub
```

### 3.3 ç”Ÿæˆç»“æœæ–‡ä»¶è¯´æ˜


**ç”Ÿæˆçš„æ–‡ä»¶ï¼š**
```
~/.ssh/
â”œâ”€â”€ id_ed25519      â† ç§é’¥æ–‡ä»¶ï¼ˆç»å¯¹ä¿å¯†ï¼ï¼‰
â””â”€â”€ id_ed25519.pub  â† å…¬é’¥æ–‡ä»¶ï¼ˆå¯ä»¥åˆ†äº«ï¼‰
```

**æŸ¥çœ‹å¯†é’¥å†…å®¹ï¼š**
```bash
# æŸ¥çœ‹å…¬é’¥ï¼ˆå¯ä»¥å®‰å…¨æ˜¾ç¤ºï¼‰
cat ~/.ssh/id_ed25519.pub

# ç»“æœç¤ºä¾‹ï¼š
# ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIB... user@example.com
```

> **âš ï¸ é‡è¦æé†’**
> 
> ç§é’¥æ–‡ä»¶ï¼ˆæ— .pubåç¼€ï¼‰åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œç»å¯¹ä¸è¦åˆ†äº«ç»™ä»»ä½•äººï¼
> å…¬é’¥æ–‡ä»¶ï¼ˆ.pubåç¼€ï¼‰æ˜¯å®‰å…¨çš„ï¼Œå¯ä»¥å¤åˆ¶åˆ°æœåŠ¡å™¨æˆ–åˆ†äº«ã€‚

---

## 4. ğŸ¯ å¯†é’¥ç±»å‹é€‰æ‹©ä¸å¯¹æ¯”


### 4.1 ä¸»è¦å¯†é’¥ç±»å‹å¯¹æ¯”


| ç±»å‹ | **å®‰å…¨æ€§** | **æ€§èƒ½** | **å…¼å®¹æ€§** | **å¯†é’¥é•¿åº¦** | **æ¨èåº¦** |
|------|------------|----------|------------|--------------|------------|
| ğŸ”¹ **RSA** | `å¾ˆå¥½` | `ä¸€èˆ¬` | `æœ€å¥½` | `2048/4096ä½` | `â˜…â˜…â˜…â˜†â˜†` |
| ğŸ”¹ **ECDSA** | `å¾ˆå¥½` | `å¥½` | `å¥½` | `256/384/521ä½` | `â˜…â˜…â˜…â˜…â˜†` |
| ğŸ”¹ **Ed25519** | `æœ€å¥½` | `æœ€å¥½` | `è¾ƒå¥½` | `å›ºå®š256ä½` | `â˜…â˜…â˜…â˜…â˜…` |

### 4.2 å„ç±»å‹è¯¦ç»†åˆ†æ


**RSAå¯†é’¥ï¼š**
```bash
# ç”ŸæˆRSAå¯†é’¥
ssh-keygen -t rsa -b 4096

ä¼˜ç‚¹ï¼š
âœ… å…¼å®¹æ€§æœ€å¥½ï¼Œæ‰€æœ‰SSHæœåŠ¡å™¨éƒ½æ”¯æŒ
âœ… ç»è¿‡é•¿æ—¶é—´éªŒè¯ï¼Œå®‰å…¨æ€§å¯é 
âœ… å¹¿æ³›çš„å·¥å…·æ”¯æŒ

ç¼ºç‚¹ï¼š
âŒ å¯†é’¥æ–‡ä»¶è¾ƒå¤§
âŒ è®¡ç®—æ€§èƒ½ç›¸å¯¹è¾ƒæ…¢
âŒ éœ€è¦è¶³å¤Ÿçš„å¯†é’¥é•¿åº¦ï¼ˆå»ºè®®4096ä½ï¼‰
```

**Ed25519å¯†é’¥ï¼š**
```bash
# ç”ŸæˆEd25519å¯†é’¥
ssh-keygen -t ed25519

ä¼˜ç‚¹ï¼š
âœ… å®‰å…¨æ€§æœ€é«˜ï¼ŒåŸºäºæ¤­åœ†æ›²çº¿
âœ… æ€§èƒ½æœ€å¥½ï¼Œè®¡ç®—é€Ÿåº¦å¿«
âœ… å¯†é’¥æ–‡ä»¶å°ï¼Œå›ºå®š256ä½
âœ… æŠ—ä¾§ä¿¡é“æ”»å‡»

ç¼ºç‚¹ï¼š
âŒ è¾ƒæ–°çš„ç®—æ³•ï¼Œè€ç³»ç»Ÿå¯èƒ½ä¸æ”¯æŒ
âŒ æŸäº›ä¼ä¸šç¯å¢ƒå¯èƒ½ç¦ç”¨
```

**ECDSAå¯†é’¥ï¼š**
```bash
# ç”ŸæˆECDSAå¯†é’¥
ssh-keygen -t ecdsa -b 256

ä¼˜ç‚¹ï¼š
âœ… æ€§èƒ½å¥½äºRSA
âœ… å®‰å…¨æ€§é«˜
âœ… å…¼å®¹æ€§ä¸é”™

ç¼ºç‚¹ï¼š
âŒ æŸäº›æ›²çº¿å­˜åœ¨äº‰è®®
âŒ ä¸å¦‚Ed25519ç®€æ´
```

### 4.3 é€‰æ‹©å»ºè®®


**ğŸ“Š é€‰æ‹©ç­–ç•¥ï¼š**
```
æ–°ç¯å¢ƒ/ä¸ªäººä½¿ç”¨ï¼š
é¦–é€‰ â†’ Ed25519
å¤‡é€‰ â†’ ECDSA

ä¼ä¸šç¯å¢ƒ/å…¼å®¹æ€§è¦æ±‚ï¼š
é¦–é€‰ â†’ RSA 4096ä½
å¤‡é€‰ â†’ ECDSA

è€æ—§ç³»ç»Ÿç¯å¢ƒï¼š
åªèƒ½é€‰æ‹© â†’ RSA
```

> **ğŸ¯ å®ç”¨å»ºè®®**
> 
> å¦‚æœä¸ç¡®å®šé€‰æ‹©å“ªç§ï¼Œ**Ed25519æ˜¯æœ€ä½³é€‰æ‹©**ã€‚å¦‚æœç›®æ ‡æœåŠ¡å™¨ä¸æ”¯æŒï¼Œå†é™çº§ä½¿ç”¨RSA 4096ä½ã€‚

---

## 5. ğŸ“¤ å¯†é’¥éƒ¨ç½²ä¸ssh-copy-id


### 5.1 ssh-copy-idå‘½ä»¤è¯¦è§£


**ssh-copy-idçš„ä½œç”¨ï¼š**
- è‡ªåŠ¨å°†æœ¬åœ°å…¬é’¥å¤åˆ¶åˆ°è¿œç¨‹æœåŠ¡å™¨
- è‡ªåŠ¨è®¾ç½®æ­£ç¡®çš„æ–‡ä»¶æƒé™
- è‡ªåŠ¨åˆ›å»ºå¿…è¦çš„ç›®å½•ç»“æ„

**åŸºæœ¬è¯­æ³•ï¼š**
```bash
ssh-copy-id [-i identity_file] user@hostname
```

### 5.2 è‡ªåŠ¨éƒ¨ç½²å¯†é’¥


**æ ‡å‡†éƒ¨ç½²æµç¨‹ï¼š**

```bash
# 1. ç”Ÿæˆå¯†é’¥å¯¹ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
ssh-keygen -t ed25519 -C "your_email@example.com"

# 2. å¤åˆ¶å…¬é’¥åˆ°æœåŠ¡å™¨
ssh-copy-id username@server_ip

# 3. æµ‹è¯•å¯†é’¥ç™»å½•
ssh username@server_ip
```

**è¯¦ç»†æ“ä½œç¤ºä¾‹ï¼š**
```bash
# éƒ¨ç½²å¯†é’¥åˆ°æœåŠ¡å™¨
$ ssh-copy-id root@192.168.1.100

/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/user/.ssh/id_ed25519.pub"
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
root@192.168.1.100's password: [è¾“å…¥ä¸€æ¬¡å¯†ç ]

Number of key(s) added: 1

Now try logging into the machine, with:   "ssh 'root@192.168.1.100'"
and check to make sure that only the key(s) you wanted were added.
```

### 5.3 æŒ‡å®šç‰¹å®šå¯†é’¥éƒ¨ç½²


**ä½¿ç”¨ç‰¹å®šå¯†é’¥æ–‡ä»¶ï¼š**
```bash
# æŒ‡å®šè¦éƒ¨ç½²çš„å¯†é’¥æ–‡ä»¶
ssh-copy-id -i ~/.ssh/id_rsa.pub user@server

# éƒ¨ç½²åˆ°ç‰¹å®šç«¯å£
ssh-copy-id -i ~/.ssh/id_ed25519.pub -p 2222 user@server
```

### 5.4 ssh-copy-idçš„å†…éƒ¨å·¥ä½œåŸç†


**ssh-copy-idå®é™…æ‰§è¡Œçš„æ“ä½œï¼š**
```bash
# ssh-copy-idç›¸å½“äºæ‰§è¡Œäº†ä»¥ä¸‹æ“ä½œï¼š

# 1. è¯»å–æœ¬åœ°å…¬é’¥
cat ~/.ssh/id_ed25519.pub

# 2. è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
mkdir -p ~/.ssh
echo "å…¬é’¥å†…å®¹" >> ~/.ssh/authorized_keys
chmod 700 ~/.ssh
chmod 600 ~/.ssh/authorized_keys
```

---

## 6. ğŸ“ authorized_keysæ–‡ä»¶ç®¡ç†


### 6.1 authorized_keysæ–‡ä»¶ç»“æ„


**æ–‡ä»¶ä½ç½®ï¼š**
```bash
~/.ssh/authorized_keys
```

**æ–‡ä»¶å†…å®¹æ ¼å¼ï¼š**
```
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIB... user1@desktop
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC7... user1@laptop  
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIF... admin@workstation
```

**æ¯è¡Œæ ¼å¼è¯´æ˜ï¼š**
```
[å¯†é’¥ç±»å‹] [å…¬é’¥æ•°æ®] [æ³¨é‡Šä¿¡æ¯]
    â†“         â†“        â†“
 ssh-ed25519  [é•¿å­—ç¬¦ä¸²]  user@host
```

### 6.2 æ‰‹åŠ¨ç®¡ç†authorized_keys


**æ‰‹åŠ¨æ·»åŠ å…¬é’¥ï¼š**
```bash
# æ–¹æ³•1ï¼šç›´æ¥ç¼–è¾‘æ–‡ä»¶
vi ~/.ssh/authorized_keys

# æ–¹æ³•2ï¼šè¿½åŠ å…¬é’¥å†…å®¹
cat new_public_key.pub >> ~/.ssh/authorized_keys

# æ–¹æ³•3ï¼šä½¿ç”¨echoå‘½ä»¤
echo "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5..." >> ~/.ssh/authorized_keys
```

**æŸ¥çœ‹å’Œç®¡ç†å·²æœ‰å¯†é’¥ï¼š**
```bash
# æŸ¥çœ‹æ‰€æœ‰æˆæƒçš„å…¬é’¥
cat ~/.ssh/authorized_keys

# ç»Ÿè®¡æˆæƒå¯†é’¥æ•°é‡
wc -l ~/.ssh/authorized_keys

# æ˜¾ç¤ºæ¯ä¸ªå¯†é’¥çš„æŒ‡çº¹
ssh-keygen -l -f ~/.ssh/authorized_keys
```

### 6.3 é«˜çº§æˆæƒæ§åˆ¶é€‰é¡¹


**authorized_keysæ”¯æŒçš„é€‰é¡¹ï¼š**

| é€‰é¡¹ | **ä½œç”¨** | **ç¤ºä¾‹** |
|------|----------|----------|
| `command` | `é™åˆ¶æ‰§è¡Œç‰¹å®šå‘½ä»¤` | `åªå…è®¸å¤‡ä»½æ“ä½œ` |
| `from` | `é™åˆ¶æ¥æºIP` | `åªå…è®¸ç‰¹å®šIPç™»å½•` |
| `no-port-forwarding` | `ç¦ç”¨ç«¯å£è½¬å‘` | `æé«˜å®‰å…¨æ€§` |
| `no-agent-forwarding` | `ç¦ç”¨ä»£ç†è½¬å‘` | `é˜²æ­¢æƒé™æ‰©æ•£` |

**å¸¦é™åˆ¶çš„å…¬é’¥ç¤ºä¾‹ï¼š**
```bash
# é™åˆ¶åªèƒ½ä»ç‰¹å®šIPç™»å½•
from="192.168.1.0/24" ssh-ed25519 AAAAC3NzaC1lZDI1NTE5... user@desktop

# é™åˆ¶åªèƒ½æ‰§è¡Œç‰¹å®šå‘½ä»¤
command="/usr/bin/backup.sh" ssh-rsa AAAAB3NzaC1yc2EAAAA... backup@server

# å¤šä¸ªé™åˆ¶ç»„åˆä½¿ç”¨
from="10.0.1.100",command="/bin/ls",no-port-forwarding ssh-ed25519 AAAAC... admin@workstation
```

---

## 7. ğŸ”’ å¯†é’¥æƒé™å®‰å…¨é…ç½®


### 7.1 SSHæ–‡ä»¶æƒé™è¦æ±‚


**å…³é”®æƒé™è®¾ç½®ï¼š**

| æ–‡ä»¶/ç›®å½• | **æƒé™** | **æ•°å­—æƒé™** | **è¯´æ˜** |
|-----------|----------|-------------|----------|
| `~/.ssh/` | `drwx------` | `700` | `åªæœ‰æ‰€æœ‰è€…å¯è®¿é—®` |
| `ç§é’¥æ–‡ä»¶` | `-rw-------` | `600` | `åªæœ‰æ‰€æœ‰è€…å¯è¯»å†™` |
| `å…¬é’¥æ–‡ä»¶` | `-rw-r--r--` | `644` | `æ‰€æœ‰è€…è¯»å†™ï¼Œå…¶ä»–äººåªè¯»` |
| `authorized_keys` | `-rw-------` | `600` | `åªæœ‰æ‰€æœ‰è€…å¯è¯»å†™` |

### 7.2 æƒé™è®¾ç½®å‘½ä»¤


**ä¸€é”®è®¾ç½®æ­£ç¡®æƒé™ï¼š**
```bash
# è®¾ç½®SSHç›®å½•æƒé™
chmod 700 ~/.ssh

# è®¾ç½®ç§é’¥æƒé™
chmod 600 ~/.ssh/id_*

# è®¾ç½®å…¬é’¥æƒé™
chmod 644 ~/.ssh/*.pub

# è®¾ç½®authorized_keysæƒé™
chmod 600 ~/.ssh/authorized_keys

# ç¡®ä¿å®¶ç›®å½•æƒé™æ­£ç¡®
chmod 755 ~
```

**æƒé™æ£€æŸ¥è„šæœ¬ï¼š**
```bash
#!/bin/bash
# SSHæƒé™æ£€æŸ¥è„šæœ¬

echo "æ£€æŸ¥SSHç›®å½•å’Œæ–‡ä»¶æƒé™..."

# æ£€æŸ¥.sshç›®å½•
if [ -d ~/.ssh ]; then
    echo "~/.ssh ç›®å½•æƒé™: $(ls -ld ~/.ssh | cut -d' ' -f1)"
else
    echo "è­¦å‘Š: ~/.ssh ç›®å½•ä¸å­˜åœ¨"
fi

# æ£€æŸ¥ç§é’¥æ–‡ä»¶
for key in ~/.ssh/id_*; do
    if [ -f "$key" ] && [[ ! "$key" == *.pub ]]; then
        echo "$key æƒé™: $(ls -l "$key" | cut -d' ' -f1)"
    fi
done

# æ£€æŸ¥authorized_keys
if [ -f ~/.ssh/authorized_keys ]; then
    echo "authorized_keys æƒé™: $(ls -l ~/.ssh/authorized_keys | cut -d' ' -f1)"
fi
```

### 7.3 æƒé™é—®é¢˜æ’æŸ¥


**å¸¸è§æƒé™é—®é¢˜ï¼š**

> **âš ï¸ æƒé™è¿‡å®½çš„é—®é¢˜**
> 
> ```bash
> # é”™è¯¯ç¤ºä¾‹ - æƒé™è¿‡å®½ä¼šè¢«SSHæ‹’ç»
> chmod 755 ~/.ssh          # åº”è¯¥æ˜¯700
> chmod 644 ~/.ssh/id_rsa    # åº”è¯¥æ˜¯600
> ```

**æƒé™é—®é¢˜è¯Šæ–­ï¼š**
```bash
# SSHè¿æ¥è°ƒè¯•æ¨¡å¼
ssh -vvv user@server

# æŸ¥çœ‹SSHæœåŠ¡å™¨æ—¥å¿—
sudo tail -f /var/log/auth.log

# å¸¸è§é”™è¯¯ä¿¡æ¯ï¼š
# "Permissions 0644 for '/home/user/.ssh/id_rsa' are too open"
# "Authentication refused: bad ownership or modes for directory /home/user/.ssh"
```

---

## 8. ğŸ” å¯†é’¥passphraseç®¡ç†


### 8.1 ä»€ä¹ˆæ˜¯passphrase


**passphraseçš„ä½œç”¨ï¼š**
> **ğŸ’¡ ç®€å•ç†è§£**
> 
> passphraseå°±æ˜¯ç»™ä½ çš„ç§é’¥åŠ äº†ä¸€æŠŠé”ï¼Œå³ä½¿åˆ«äººæ‹¿åˆ°äº†ä½ çš„ç§é’¥æ–‡ä»¶ï¼Œæ²¡æœ‰passphraseä¹Ÿç”¨ä¸äº†ã€‚
> è¿™å°±åƒé“¶è¡Œå¡éœ€è¦å¯†ç ä¸€æ ·ï¼Œå¡è¢«å·äº†ï¼Œä¸çŸ¥é“å¯†ç ä¹Ÿå–ä¸äº†é’±ã€‚

**å®‰å…¨å±‚çº§å¯¹æ¯”ï¼š**
```
æ— passphraseç§é’¥ï¼š
ç§é’¥æ–‡ä»¶è¢«ç›— = ç«‹å³å¤±å»å®‰å…¨æ€§

æœ‰passphraseç§é’¥ï¼š
ç§é’¥æ–‡ä»¶è¢«ç›— + éœ€è¦ç ´è§£passphrase = åŒé‡ä¿æŠ¤
```

### 8.2 è®¾ç½®å’Œä¿®æ”¹passphrase


**ç”Ÿæˆå¯†é’¥æ—¶è®¾ç½®passphraseï¼š**
```bash
# ç”Ÿæˆå¯†é’¥æ—¶è®¾ç½®å¯†ç 
ssh-keygen -t ed25519 -C "user@example.com"
# åœ¨æç¤ºæ—¶è¾“å…¥passphrase
Enter passphrase (empty for no passphrase): [è¾“å…¥å¯†ç ]
Enter same passphrase again: [ç¡®è®¤å¯†ç ]
```

**ç»™å·²æœ‰å¯†é’¥æ·»åŠ æˆ–ä¿®æ”¹passphraseï¼š**
```bash
# ä¿®æ”¹ç°æœ‰å¯†é’¥çš„passphrase
ssh-keygen -p -f ~/.ssh/id_ed25519

Enter old passphrase: [è¾“å…¥æ—§å¯†ç ï¼Œå¦‚æœæ²¡æœ‰å°±ç›´æ¥å›è½¦]
Enter new passphrase (empty for no passphrase): [è¾“å…¥æ–°å¯†ç ]
Enter same passphrase again: [ç¡®è®¤æ–°å¯†ç ]
```

### 8.3 ssh-agentå¯†é’¥ä»£ç†ç®¡ç†


**ä»€ä¹ˆæ˜¯ssh-agentï¼š**
```
ssh-agentçš„ä½œç”¨ï¼š
â€¢ åœ¨å†…å­˜ä¸­ç¼“å­˜è§£é”çš„ç§é’¥
â€¢ é¿å…æ¯æ¬¡ä½¿ç”¨éƒ½è¾“å…¥passphrase
â€¢ ä¼šè¯ç»“æŸåè‡ªåŠ¨æ¸…é™¤ç¼“å­˜
â€¢ æä¾›ä¾¿åˆ©æ€§çš„åŒæ—¶ä¿æŒå®‰å…¨æ€§
```

**ä½¿ç”¨ssh-agentï¼š**
```bash
# å¯åŠ¨ssh-agent
eval $(ssh-agent)

# æ·»åŠ å¯†é’¥åˆ°ä»£ç†
ssh-add ~/.ssh/id_ed25519
Enter passphrase for /home/user/.ssh/id_ed25519: [è¾“å…¥ä¸€æ¬¡å¯†ç ]

# æŸ¥çœ‹å·²åŠ è½½çš„å¯†é’¥
ssh-add -l

# åˆ é™¤æ‰€æœ‰ç¼“å­˜çš„å¯†é’¥
ssh-add -D

# åœæ­¢ssh-agent
ssh-agent -k
```

**è‡ªåŠ¨å¯åŠ¨ssh-agentï¼š**
```bash
# åœ¨~/.bashrcæˆ–~/.profileä¸­æ·»åŠ ï¼š
if [ -z "$SSH_AUTH_SOCK" ]; then
    eval $(ssh-agent)
    ssh-add ~/.ssh/id_ed25519 2>/dev/null
fi
```

### 8.4 passphraseå®‰å…¨å»ºè®®


**ğŸ“‹ å®‰å…¨ä½¿ç”¨æŒ‡å—ï¼š**

âœ… **æ¨èåšæ³•ï¼š**
- é‡è¦ç¯å¢ƒä½¿ç”¨passphraseä¿æŠ¤
- ä½¿ç”¨å¼ºå¯†ç ï¼š12ä½ä»¥ä¸Šï¼ŒåŒ…å«å¤šç§å­—ç¬¦
- ç»“åˆssh-agentä½¿ç”¨ï¼Œå¹³è¡¡å®‰å…¨å’Œä¾¿åˆ©
- å®šæœŸæ›´æ¢passphrase

âŒ **ä¸æ¨èåšæ³•ï¼š**
- åœ¨è„šæœ¬ä¸­ç¡¬ç¼–ç passphrase
- ä½¿ç”¨ç®€å•çš„passphrase
- åœ¨å…±äº«ç¯å¢ƒä¸­ä½¿ç”¨æ— å¯†ç ç§é’¥

---

## 9. ğŸ—‚ï¸ å¤šå¯†é’¥ç¯å¢ƒé…ç½®


### 9.1 å¤šå¯†é’¥ä½¿ç”¨åœºæ™¯


**å¸¸è§çš„å¤šå¯†é’¥éœ€æ±‚ï¼š**
```
ä¸ªäººç¯å¢ƒï¼š
â”œâ”€â”€ id_ed25519     â†’ ä¸ªäººæœåŠ¡å™¨
â”œâ”€â”€ id_rsa_work    â†’ å…¬å¸æœåŠ¡å™¨  
â”œâ”€â”€ id_rsa_github  â†’ GitHubä»£ç åº“
â””â”€â”€ id_rsa_backup  â†’ å¤‡ä»½æœåŠ¡å™¨

ä¼ä¸šç¯å¢ƒï¼š
â”œâ”€â”€ production_key â†’ ç”Ÿäº§ç¯å¢ƒ
â”œâ”€â”€ staging_key    â†’ æµ‹è¯•ç¯å¢ƒ
â”œâ”€â”€ dev_key        â†’ å¼€å‘ç¯å¢ƒ
â””â”€â”€ admin_key      â†’ ç®¡ç†æƒé™
```

### 9.2 SSHå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶


**~/.ssh/configæ–‡ä»¶é…ç½®ï¼š**
```bash
# ä¸ªäººæœåŠ¡å™¨é…ç½®
Host personal-server
    HostName 192.168.1.100
    User admin
    IdentityFile ~/.ssh/id_ed25519
    Port 22

# å…¬å¸æœåŠ¡å™¨é…ç½®  
Host work-server
    HostName work.company.com
    User username
    IdentityFile ~/.ssh/id_rsa_work
    Port 2222

# GitHubé…ç½®
Host github.com
    HostName github.com
    User git
    IdentityFile ~/.ssh/id_rsa_github
    
# é€šé…ç¬¦é…ç½®
Host *.example.com
    User admin
    IdentityFile ~/.ssh/id_rsa_company
    StrictHostKeyChecking no
```

**configæ–‡ä»¶å¸¸ç”¨é€‰é¡¹ï¼š**

| é€‰é¡¹ | **è¯´æ˜** | **ç¤ºä¾‹å€¼** |
|------|----------|------------|
| `Host` | `åˆ«åæ ‡è¯†` | `my-server` |
| `HostName` | `çœŸå®åœ°å€` | `192.168.1.100` |
| `User` | `ç™»å½•ç”¨æˆ·å` | `root` |
| `IdentityFile` | `ç§é’¥è·¯å¾„` | `~/.ssh/id_rsa` |
| `Port` | `SSHç«¯å£` | `2222` |

### 9.3 ä½¿ç”¨é…ç½®å¥½çš„è¿æ¥


**é€šè¿‡åˆ«åè¿æ¥ï¼š**
```bash
# ä½¿ç”¨é…ç½®çš„åˆ«åè¿æ¥
ssh personal-server    # ç­‰åŒäº: ssh -i ~/.ssh/id_ed25519 admin@192.168.1.100
ssh work-server        # ç­‰åŒäº: ssh -i ~/.ssh/id_rsa_work -p 2222 username@work.company.com
```

### 9.4 åŠ¨æ€å¯†é’¥é€‰æ‹©


**ä¸´æ—¶æŒ‡å®šå¯†é’¥ï¼š**
```bash
# ä¸´æ—¶ä½¿ç”¨ç‰¹å®šå¯†é’¥
ssh -i ~/.ssh/special_key user@server

# å¤åˆ¶æ–‡ä»¶æ—¶æŒ‡å®šå¯†é’¥
scp -i ~/.ssh/backup_key file.txt user@backup-server:/path/

# rsyncåŒæ­¥æ—¶æŒ‡å®šå¯†é’¥
rsync -e "ssh -i ~/.ssh/backup_key" -av /local/path/ user@server:/remote/path/
```

**æ‰¹é‡æ“ä½œä¸åŒæœåŠ¡å™¨ï¼š**
```bash
#!/bin/bash
# æ‰¹é‡æ‰§è¡Œå‘½ä»¤è„šæœ¬

# æœåŠ¡å™¨åˆ—è¡¨
servers=(
    "personal-server"
    "work-server" 
    "backup-server"
)

# åœ¨æ‰€æœ‰æœåŠ¡å™¨ä¸Šæ‰§è¡Œå‘½ä»¤
for server in "${servers[@]}"; do
    echo "åœ¨ $server ä¸Šæ‰§è¡Œå‘½ä»¤..."
    ssh "$server" "uptime"
done
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ SSHå¯†é’¥è®¤è¯ï¼šåŸºäºæ•°å­¦ç®—æ³•çš„èº«ä»½è®¤è¯ï¼Œæ¯”å¯†ç æ›´å®‰å…¨
ğŸ”¸ å…¬ç§é’¥åŸç†ï¼šå…¬é’¥éªŒè¯ï¼Œç§é’¥ç­¾åï¼Œæ•°å­¦ä¸Šç›¸å…³ä½†æ— æ³•äº’æ¨
ğŸ”¸ å¯†é’¥ç±»å‹é€‰æ‹©ï¼šEd25519é¦–é€‰ï¼ŒRSAå…¼å®¹ï¼ŒECDSAå‡è¡¡
ğŸ”¸ æƒé™è®¾ç½®ï¼š700ç›®å½•ï¼Œ600ç§é’¥ï¼Œ644å…¬é’¥ï¼Œ600æˆæƒæ–‡ä»¶
ğŸ”¸ å¤šå¯†é’¥ç®¡ç†ï¼šconfigé…ç½®æ–‡ä»¶ï¼Œssh-agentä»£ç†ç¼“å­˜
```

### 10.2 å…³é”®æ“ä½œå‘½ä»¤


**ğŸ“Œ æ ¸å¿ƒå‘½ä»¤æ¸…å•ï¼š**
```bash
# ç”Ÿæˆå¯†é’¥
ssh-keygen -t ed25519 -C "email@example.com"

# éƒ¨ç½²å¯†é’¥  
ssh-copy-id user@server

# è®¾ç½®æƒé™
chmod 700 ~/.ssh && chmod 600 ~/.ssh/id_* ~/.ssh/authorized_keys

# ç®¡ç†ä»£ç†
ssh-add ~/.ssh/id_ed25519

# é…ç½®è¿æ¥
vi ~/.ssh/config
```

### 10.3 å®‰å…¨æœ€ä½³å®è·µ


**ğŸ”’ å®‰å…¨å»ºè®®ï¼š**
- âœ… ä½¿ç”¨å¼ºpassphraseä¿æŠ¤é‡è¦ç§é’¥
- âœ… å®šæœŸæ›´æ¢å¯†é’¥å¯¹å’Œpassphrase
- âœ… ä¸åŒç”¨é€”ä½¿ç”¨ä¸åŒå¯†é’¥
- âœ… åŠæ—¶æ¸…ç†ä¸éœ€è¦çš„authorized_keysæ¡ç›®
- âœ… ä½¿ç”¨configæ–‡ä»¶è§„èŒƒç®¡ç†è¿æ¥

**âš ï¸ å®‰å…¨ç¦å¿Œï¼š**
- âŒ ç§é’¥æ–‡ä»¶æƒé™è¿‡å®½
- âŒ åœ¨ä¸å®‰å…¨ç¯å¢ƒå­˜æ”¾ç§é’¥
- âŒ å¤šäººå…±äº«åŒä¸€å¯†é’¥å¯¹
- âŒ åœ¨è„šæœ¬ä¸­ç¡¬ç¼–ç ç§é’¥å¯†ç 

### 10.4 æ•…éšœæ’æŸ¥æ€è·¯


**ğŸ”§ å¸¸è§é—®é¢˜è§£å†³ï¼š**
```
è¿æ¥è¢«æ‹’ç»ï¼š
1. æ£€æŸ¥å¯†é’¥æ–‡ä»¶æƒé™
2. ç¡®è®¤å…¬é’¥å·²æ­£ç¡®éƒ¨ç½²
3. æŸ¥çœ‹SSHæœåŠ¡å™¨æ—¥å¿—
4. ä½¿ç”¨-vvvå‚æ•°è°ƒè¯•

å¯†é’¥æ— æ³•ä½¿ç”¨ï¼š
1. éªŒè¯å¯†é’¥æ ¼å¼å®Œæ•´æ€§
2. æ£€æŸ¥passphraseæ˜¯å¦æ­£ç¡®
3. ç¡®è®¤ssh-agentçŠ¶æ€
4. å°è¯•é‡æ–°ç”Ÿæˆå¯†é’¥å¯¹
```

**ğŸ§  æ ¸å¿ƒè®°å¿†ï¼š**
- SSHå¯†é’¥è®¤è¯å®‰å…¨ä¾¿æ·ï¼Œå…¬é’¥å…¬å¼€ç§é’¥ä¿å¯†
- Ed25519æ€§èƒ½æœ€ä¼˜ï¼ŒRSAå…¼å®¹æœ€å¥½
- æƒé™è®¾ç½®å¾ˆé‡è¦ï¼Œ700ç›®å½•600å¯†é’¥
- ssh-copy-idè‡ªåŠ¨éƒ¨ç½²ï¼Œconfigæ–‡ä»¶ç®¡ç†è¿æ¥
- passphraseåŠ åŒä¿é™©ï¼Œssh-agentæ¥ç¼“å­˜