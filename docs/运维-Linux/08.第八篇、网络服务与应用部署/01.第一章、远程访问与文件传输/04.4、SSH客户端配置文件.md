---
title: 4ã€SSHå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶
---
## ğŸ“š ç›®å½•

1. [SSHé…ç½®æ–‡ä»¶æ¦‚è¿°](#1-SSHé…ç½®æ–‡ä»¶æ¦‚è¿°)
2. [é…ç½®æ–‡ä»¶åŸºæœ¬è¯­æ³•](#2-é…ç½®æ–‡ä»¶åŸºæœ¬è¯­æ³•)
3. [Hostå—é…ç½®ä¸ç»§æ‰¿æœºåˆ¶](#3-Hostå—é…ç½®ä¸ç»§æ‰¿æœºåˆ¶)
4. [å¸¸ç”¨é…ç½®é€‰é¡¹è¯¦è§£](#4-å¸¸ç”¨é…ç½®é€‰é¡¹è¯¦è§£)
5. [åˆ«åä¸å¿«æ·è¿æ¥è®¾ç½®](#5-åˆ«åä¸å¿«æ·è¿æ¥è®¾ç½®)
6. [ä»£ç†è·³è½¬é…ç½®](#6-ä»£ç†è·³è½¬é…ç½®)
7. [è¿æ¥å¤ç”¨é…ç½®](#7-è¿æ¥å¤ç”¨é…ç½®)
8. [é…ç½®æ–‡ä»¶æƒé™ä¸å®‰å…¨](#8-é…ç½®æ–‡ä»¶æƒé™ä¸å®‰å…¨)
9. [å®ç”¨é…ç½®ç¤ºä¾‹](#9-å®ç”¨é…ç½®ç¤ºä¾‹)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”§ SSHé…ç½®æ–‡ä»¶æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯SSHé…ç½®æ–‡ä»¶


**SSHé…ç½®æ–‡ä»¶**å°±åƒæ˜¯SSHå®¢æˆ·ç«¯çš„"é€šè®¯å½•"ï¼Œå®ƒå¸®ä½ è®°ä½å„ç§æœåŠ¡å™¨çš„è¿æ¥ä¿¡æ¯ï¼Œè®©ä½ ä¸ç”¨æ¯æ¬¡éƒ½è¾“å…¥å¤æ‚çš„è¿æ¥å‚æ•°ã€‚

```
ç®€å•ç†è§£ï¼š
æ‰‹æœºé€šè®¯å½•ï¼šç‚¹å‡»è”ç³»äººåå­—å°±èƒ½æ‹¨å·
SSHé…ç½®æ–‡ä»¶ï¼šè¾“å…¥ä¸»æœºåˆ«åå°±èƒ½è¿æ¥æœåŠ¡å™¨

ä¼ ç»Ÿè¿æ¥æ–¹å¼ï¼š
ssh -i ~/.ssh/my_key.pem -p 2222 user@192.168.1.100

é…ç½®æ–‡ä»¶è¿æ¥ï¼š
ssh myserver  ï¼ˆä¸€ä¸ªè¯æå®šï¼ï¼‰
```

### 1.2 é…ç½®æ–‡ä»¶çš„ä½ç½®


**é…ç½®æ–‡ä»¶æœ‰ä¸¤ä¸ªçº§åˆ«**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å…¨å±€é…ç½®: /etc/ssh/ssh_config      â”‚ â† å½±å“æ‰€æœ‰ç”¨æˆ·
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç”¨æˆ·é…ç½®: ~/.ssh/config            â”‚ â† åªå½±å“å½“å‰ç”¨æˆ·
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¼˜å…ˆçº§ï¼šç”¨æˆ·é…ç½® > å…¨å±€é…ç½®
```

**å®é™…ä½¿ç”¨å»ºè®®**ï¼š
- ğŸ¯ **ä¸ªäººä½¿ç”¨**ï¼šåªç”¨ `~/.ssh/config`ï¼Œæ–¹ä¾¿ç®¡ç†
- ğŸ¯ **ç³»ç»Ÿç®¡ç†å‘˜**ï¼šå…¨å±€é…ç½®è®¾ç½®é€šç”¨è§„åˆ™ï¼Œç”¨æˆ·é…ç½®è®¾ç½®ä¸ªäººåå¥½
- ğŸ¯ **æ–°æ‰‹å»ºè®®**ï¼šå…ˆå­¦ä¼šç”¨æˆ·é…ç½®æ–‡ä»¶ï¼Œå¤Ÿç”¨äº†

### 1.3 é…ç½®æ–‡ä»¶çš„ä½œç”¨


**ä¸»è¦åŠŸèƒ½**ï¼š
```
ğŸ”¸ ç®€åŒ–è¿æ¥ï¼šå¤æ‚å‚æ•°å˜æˆç®€å•åˆ«å
ğŸ”¸ ç»Ÿä¸€ç®¡ç†ï¼šæ‰€æœ‰æœåŠ¡å™¨ä¿¡æ¯é›†ä¸­å­˜æ”¾
ğŸ”¸ æé«˜å®‰å…¨ï¼šé¢„è®¾å®‰å…¨å‚æ•°ï¼Œé¿å…æ‰‹è¯¯
ğŸ”¸ æå‡æ•ˆç‡ï¼šé¿å…é‡å¤è¾“å…¥ï¼Œæ”¯æŒè¿æ¥å¤ç”¨
ğŸ”¸ æ‰¹é‡æ“ä½œï¼šé…åˆè„šæœ¬å®ç°è‡ªåŠ¨åŒ–ç®¡ç†
```

---

## 2. ğŸ“ é…ç½®æ–‡ä»¶åŸºæœ¬è¯­æ³•


### 2.1 è¯­æ³•è§„åˆ™


SSHé…ç½®æ–‡ä»¶çš„è¯­æ³•å¾ˆç®€å•ï¼Œå°±åƒå†™é…ç½®æ¸…å•ä¸€æ ·ï¼š

```bash
# è¿™æ˜¯æ³¨é‡Šï¼Œä»¥#å¼€å¤´
# åŸºæœ¬æ ¼å¼ï¼šé€‰é¡¹å é€‰é¡¹å€¼

# å…¨å±€é€‰é¡¹ï¼ˆå½±å“æ‰€æœ‰è¿æ¥ï¼‰
ServerAliveInterval 60

# ä¸»æœºå—ï¼ˆåªå½±å“ç‰¹å®šä¸»æœºï¼‰
Host myserver
    HostName 192.168.1.100
    User admin
    Port 22
```

**è¯­æ³•è¦ç‚¹**ï¼š
- ğŸ”¸ **æ³¨é‡Š**ï¼š`#` å¼€å¤´çš„è¡Œæ˜¯æ³¨é‡Š
- ğŸ”¸ **ç¼©è¿›**ï¼šHostå—å†…çš„é€‰é¡¹è¦ç¼©è¿›ï¼ˆç©ºæ ¼æˆ–Tabï¼‰
- ğŸ”¸ **å¤§å°å†™**ï¼šé€‰é¡¹åä¸åŒºåˆ†å¤§å°å†™ï¼ˆ`Port`å’Œ`port`ä¸€æ ·ï¼‰
- ğŸ”¸ **ç©ºæ ¼**ï¼šé€‰é¡¹åå’Œå€¼ä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš”

### 2.2 é…ç½®æ–‡ä»¶ç»“æ„


```bash
# ~/.ssh/config æ–‡ä»¶ç»“æ„ç¤ºä¾‹

# ===== å…¨å±€è®¾ç½®ï¼ˆæ‰€æœ‰è¿æ¥éƒ½ç”Ÿæ•ˆï¼‰ =====
ServerAliveInterval 60        # ä¿æŒè¿æ¥æ´»è·ƒ
ServerAliveCountMax 3         # æœ€å¤§é‡è¯•æ¬¡æ•°
StrictHostKeyChecking ask     # ä¸»æœºå¯†é’¥æ£€æŸ¥ç­–ç•¥

# ===== å…·ä½“ä¸»æœºé…ç½® =====
Host webserver
    HostName web.company.com
    User www-data
    Port 22
    
Host database  
    HostName db.company.com
    User dbadmin
    Port 3306

# ===== é€šé…ç¬¦é…ç½® =====
Host *.company.com
    User admin
    IdentityFile ~/.ssh/company_key
```

**é…ç½®è¯»å–é¡ºåº**ï¼š
```
SSHè¯»å–é…ç½®çš„é¡ºåºï¼š
1. ä»ä¸Šåˆ°ä¸‹é€è¡Œè¯»å–
2. åŒ¹é…åˆ°ç¬¬ä¸€ä¸ªHostååº”ç”¨è¯¥é…ç½®
3. ç»§ç»­è¯»å–åé¢çš„é…ç½®ï¼ˆé™¤éè¢«è¦†ç›–ï¼‰
4. å…¨å±€é€‰é¡¹å§‹ç»ˆç”Ÿæ•ˆï¼ˆé™¤éHostä¸­é‡æ–°å®šä¹‰ï¼‰
```

---

## 3. ğŸ  Hostå—é…ç½®ä¸ç»§æ‰¿æœºåˆ¶


### 3.1 Hostå—çš„ä½œç”¨


**Hostå—**å°±æ˜¯ç»™ç‰¹å®šæœåŠ¡å™¨è®¾ç½®ä¸“é—¨çš„è¿æ¥è§„åˆ™ï¼Œç±»ä¼¼äºç»™ä¸åŒçš„æœ‹å‹è®¾ç½®ä¸åŒçš„è”ç³»æ–¹å¼ã€‚

```bash
# åŸºæœ¬Hostå—è¯­æ³•
Host åˆ«å                    # è¿™æ˜¯ä½ è¦è¾“å…¥çš„åå­—
    HostName çœŸå®åœ°å€       # æœåŠ¡å™¨çš„çœŸå®IPæˆ–åŸŸå
    User ç”¨æˆ·å             # ç™»å½•ç”¨æˆ·
    Port ç«¯å£å·             # SSHç«¯å£ï¼ˆé»˜è®¤22ï¼‰
```

**ç®€å•ç¤ºä¾‹**ï¼š
```bash
Host dev
    HostName 192.168.1.50
    User developer
    Port 2222
    
# ç°åœ¨ä½ åªéœ€è¦è¾“å…¥: ssh dev
# ç­‰ä»·äº: ssh -p 2222 developer@192.168.1.50
```

### 3.2 HoståŒ¹é…è§„åˆ™


**åŒ¹é…æ–¹å¼**ï¼š
```bash
# 1. ç²¾ç¡®åŒ¹é…
Host webserver              # åªåŒ¹é… "webserver"

# 2. é€šé…ç¬¦åŒ¹é…  
Host web*                   # åŒ¹é… web1, web2, webserver ç­‰
Host *.company.com          # åŒ¹é… xxx.company.com æ ¼å¼

# 3. å¤šä¸ªåç§°
Host web1 web2 web3         # åŒ¹é…è¿™ä¸‰ä¸ªåç§°ä¸­çš„ä»»æ„ä¸€ä¸ª

# 4. æ’é™¤åŒ¹é…
Host * !production          # åŒ¹é…æ‰€æœ‰ä¸»æœºï¼Œé™¤äº† production
```

**å®ç”¨ç¤ºä¾‹**ï¼š
```bash
# å¼€å‘ç¯å¢ƒé€šç”¨é…ç½®
Host dev*
    User developer
    IdentityFile ~/.ssh/dev_key
    StrictHostKeyChecking no

# ç”Ÿäº§ç¯å¢ƒä¸¥æ ¼é…ç½®  
Host prod*
    User admin
    IdentityFile ~/.ssh/prod_key
    StrictHostKeyChecking yes
    
# å…·ä½“æœåŠ¡å™¨é…ç½®
Host dev-web
    HostName 192.168.1.10
    
Host prod-web  
    HostName prod-web.company.com
```

### 3.3 é…ç½®ç»§æ‰¿æœºåˆ¶


**ç»§æ‰¿åŸç†**ï¼šSSHé…ç½®éµå¾ª"ç¬¬ä¸€æ¬¡åŒ¹é…ç”Ÿæ•ˆ"åŸåˆ™

```bash
# ç»§æ‰¿ç¤ºä¾‹
Host dev-web
    HostName 192.168.1.10
    Port 2222                # è¿™é‡Œå®šä¹‰äº†Port
    
Host dev*  
    User developer
    Port 22                  # è¿™ä¸ªPortä¸ä¼šè¦†ç›–ä¸Šé¢çš„2222
    IdentityFile ~/.ssh/dev_key

# ç»“æœï¼šè¿æ¥dev-webæ—¶
# HostName: 192.168.1.10 âœ“
# Port: 2222 âœ“ (ç¬¬ä¸€æ¬¡å®šä¹‰ç”Ÿæ•ˆ)
# User: developer âœ“  
# IdentityFile: ~/.ssh/dev_key âœ“
```

**ç»§æ‰¿æœ€ä½³å®è·µ**ï¼š
```bash
# æ¨èçš„é…ç½®é¡ºåºï¼šå…·ä½“ â†’ é€šç”¨ â†’ å…¨å±€

# 1. æœ€å…·ä½“çš„é…ç½®æ”¾å‰é¢
Host important-server
    HostName prod.company.com
    User admin
    Port 22
    
# 2. é€šç”¨é…ç½®æ”¾ä¸­é—´  
Host *.company.com
    IdentityFile ~/.ssh/company_key
    
# 3. é»˜è®¤é…ç½®æ”¾æœ€å
Host *
    ServerAliveInterval 60
    ServerAliveCountMax 3
```

---

## 4. âš™ï¸ å¸¸ç”¨é…ç½®é€‰é¡¹è¯¦è§£


### 4.1 è¿æ¥åŸºæœ¬ä¿¡æ¯


```bash
Host myserver
    # æœåŠ¡å™¨åœ°å€ï¼ˆå¿…å¡«ï¼‰
    HostName example.com        # IPåœ°å€æˆ–åŸŸå
    
    # ç™»å½•ç”¨æˆ·ï¼ˆæ¨èå¡«å†™ï¼‰  
    User username               # é»˜è®¤ä½¿ç”¨å½“å‰ç³»ç»Ÿç”¨æˆ·å
    
    # SSHç«¯å£ï¼ˆå¯é€‰ï¼‰
    Port 22                     # é»˜è®¤22ï¼Œæœ‰äº›æœåŠ¡å™¨æ”¹æˆå…¶ä»–ç«¯å£
```

**å®é™…åœºæ™¯**ï¼š
```bash
# äº‘æœåŠ¡å™¨é€šå¸¸è¿™æ ·é…ç½®
Host aliyun-web
    HostName 47.96.123.45
    User root
    Port 22

# å…¬å¸å†…ç½‘æœåŠ¡å™¨  
Host office-db
    HostName 192.168.10.50
    User dbadmin  
    Port 3306
```

### 4.2 èº«ä»½è®¤è¯é€‰é¡¹


```bash
Host secure-server
    # å¯†é’¥æ–‡ä»¶è·¯å¾„
    IdentityFile ~/.ssh/id_rsa          # ç§é’¥æ–‡ä»¶ä½ç½®
    
    # è®¤è¯æ–¹å¼ä¼˜å…ˆçº§
    PreferredAuthentications publickey,password
    
    # æ˜¯å¦ä½¿ç”¨å¯†ç è®¤è¯
    PasswordAuthentication yes          # yes/no
    
    # æ˜¯å¦ä½¿ç”¨å…¬é’¥è®¤è¯  
    PubkeyAuthentication yes            # yes/no
    
    # èº«ä»½ä»£ç†
    IdentitiesOnly yes                  # åªä½¿ç”¨æŒ‡å®šçš„å¯†é’¥
```

**è®¤è¯é…ç½®è¯´æ˜**ï¼š
```bash
# é«˜å®‰å…¨æœåŠ¡å™¨ï¼šåªå…è®¸å¯†é’¥ç™»å½•
Host production-*
    PubkeyAuthentication yes
    PasswordAuthentication no
    IdentitiesOnly yes
    IdentityFile ~/.ssh/production_key

# å¼€å‘æœåŠ¡å™¨ï¼šå…è®¸å¯†ç ç™»å½•  
Host dev-*
    PubkeyAuthentication yes
    PasswordAuthentication yes
```

### 4.3 è¿æ¥æ§åˆ¶é€‰é¡¹


```bash
Host myserver
    # è¿æ¥è¶…æ—¶ï¼ˆç§’ï¼‰
    ConnectTimeout 10               # 10ç§’å†…è¿ä¸ä¸Šå°±æ”¾å¼ƒ
    
    # ä¿æŒè¿æ¥æ´»è·ƒ
    ServerAliveInterval 60          # æ¯60ç§’å‘é€å¿ƒè·³åŒ…
    ServerAliveCountMax 3           # æœ€å¤š3æ¬¡å¿ƒè·³å¤±è´¥åæ–­å¼€
    
    # ä¸»æœºå¯†é’¥æ£€æŸ¥
    StrictHostKeyChecking ask       # ask/yes/no
    UserKnownHostsFile ~/.ssh/known_hosts
    
    # å‹ç¼©ä¼ è¾“  
    Compression yes                 # ç½‘ç»œæ…¢æ—¶å¼€å¯å‹ç¼©
```

**ä¸»æœºå¯†é’¥æ£€æŸ¥è¯´æ˜**ï¼š
```bash
StrictHostKeyCheckingçš„ä¸‰ç§æ¨¡å¼ï¼š

yes: ä¸¥æ ¼æ£€æŸ¥ï¼Œå¯†é’¥ä¸åŒ¹é…å°±æ‹’ç»è¿æ¥ï¼ˆæœ€å®‰å…¨ï¼‰
ask: è¯¢é—®ç”¨æˆ·æ˜¯å¦ä¿¡ä»»æ–°å¯†é’¥ï¼ˆé»˜è®¤ï¼Œå¹³è¡¡å®‰å…¨å’Œä¾¿åˆ©ï¼‰  
no:  ä¸æ£€æŸ¥ç›´æ¥è¿æ¥ï¼ˆæ–¹ä¾¿ä½†ä¸å®‰å…¨ï¼Œä»…ç”¨äºå†…ç½‘æµ‹è¯•ï¼‰

# ç”Ÿäº§ç¯å¢ƒæ¨è
Host prod-*
    StrictHostKeyChecking yes

# å¼€å‘æµ‹è¯•ç¯å¢ƒ  
Host dev-* test-*
    StrictHostKeyChecking no
```

### 4.4 ç½‘ç»œå’Œæ€§èƒ½é€‰é¡¹


```bash
Host slow-network-server
    # TCPä¿æŒè¿æ¥
    TCPKeepAlive yes                # æ£€æµ‹ç½‘ç»œæ–­å¼€
    
    # å‹ç¼©çº§åˆ«
    CompressionLevel 6              # 1-9ï¼Œæ•°å­—è¶Šå¤§å‹ç¼©è¶Šå¼º
    
    # ç½‘ç»œåè®®ç‰ˆæœ¬
    Protocol 2                      # åªä½¿ç”¨SSHåè®®ç‰ˆæœ¬2
    
    # åœ°å€æ—
    AddressFamily inet              # inet(IPv4)/inet6(IPv6)/any
    
    # ç»‘å®šåœ°å€
    BindAddress 192.168.1.100       # å¤šç½‘å¡æ—¶æŒ‡å®šå‡ºå£IP
```

---

## 5. ğŸ·ï¸ åˆ«åä¸å¿«æ·è¿æ¥è®¾ç½®


### 5.1 åˆ›å»ºè¿æ¥åˆ«å


åˆ«åå°±æ˜¯ç»™å¤æ‚çš„è¿æ¥å‘½ä»¤èµ·ä¸ªç®€å•çš„åå­—ï¼Œè®©è¿æ¥æ›´æ–¹ä¾¿ã€‚

```bash
# åŸå§‹è¿æ¥æ–¹å¼ï¼ˆéº»çƒ¦ï¼‰
ssh -i ~/.ssh/company.pem -p 2222 admin@prod-web-01.company.com

# é…ç½®åˆ«ååï¼ˆç®€å•ï¼‰  
ssh web1
```

**åˆ«åé…ç½®ç¤ºä¾‹**ï¼š
```bash
# ~/.ssh/config

# WebæœåŠ¡å™¨
Host web1
    HostName prod-web-01.company.com
    User admin
    Port 2222
    IdentityFile ~/.ssh/company.pem

Host web2  
    HostName prod-web-02.company.com
    User admin
    Port 2222
    IdentityFile ~/.ssh/company.pem
    
# æ•°æ®åº“æœåŠ¡å™¨
Host db1
    HostName db-master.company.com
    User dba
    Port 3306
    IdentityFile ~/.ssh/db_key.pem
```

### 5.2 æ‰¹é‡åˆ«åè®¾ç½®


å½“ä½ æœ‰å¾ˆå¤šç±»ä¼¼çš„æœåŠ¡å™¨æ—¶ï¼Œå¯ä»¥ç”¨é€šé…ç¬¦æ‰¹é‡è®¾ç½®ï¼š

```bash
# æ‰¹é‡é…ç½®WebæœåŠ¡å™¨
Host web*
    User www-data
    Port 80
    IdentityFile ~/.ssh/web_servers.key
    
# å…·ä½“æœåŠ¡å™¨åªéœ€æŒ‡å®šIP  
Host web1
    HostName 192.168.1.10
    
Host web2
    HostName 192.168.1.11
    
Host web3  
    HostName 192.168.1.12

# ç°åœ¨å¯ä»¥ç”¨ï¼šssh web1, ssh web2, ssh web3
```

### 5.3 ç¯å¢ƒåˆ†ç»„ç®¡ç†


**æŒ‰ç¯å¢ƒåˆ†ç»„**ï¼š
```bash
# å¼€å‘ç¯å¢ƒ
Host dev-*
    User developer
    IdentityFile ~/.ssh/dev_key
    StrictHostKeyChecking no        # å¼€å‘ç¯å¢ƒå®½æ¾ä¸€äº›
    
Host dev-web
    HostName dev-web.company.com
    
Host dev-db  
    HostName dev-db.company.com

# ç”Ÿäº§ç¯å¢ƒ
Host prod-*
    User admin  
    IdentityFile ~/.ssh/prod_key
    StrictHostKeyChecking yes       # ç”Ÿäº§ç¯å¢ƒä¸¥æ ¼æ£€æŸ¥
    
Host prod-web
    HostName prod-web.company.com
    
Host prod-db
    HostName prod-db.company.com
```

**æŒ‰åŠŸèƒ½åˆ†ç»„**ï¼š
```bash
# æ•°æ®åº“æœåŠ¡å™¨
Host *-db
    User dbadmin
    Port 3306
    IdentityFile ~/.ssh/database.key
    
# WebæœåŠ¡å™¨  
Host *-web
    User www-data
    Port 80
    IdentityFile ~/.ssh/webserver.key
    
# ç¼“å­˜æœåŠ¡å™¨
Host *-cache  
    User redis
    Port 6379
    IdentityFile ~/.ssh/cache.key
```

---

## 6. ğŸŒ‰ ä»£ç†è·³è½¬é…ç½®


### 6.1 ä»€ä¹ˆæ˜¯ä»£ç†è·³è½¬


**ä»£ç†è·³è½¬**ï¼ˆJump Hostï¼‰å°±æ˜¯é€šè¿‡ä¸€å°ä¸­é—´æœåŠ¡å™¨å»è¿æ¥ç›®æ ‡æœåŠ¡å™¨ï¼Œå¸¸ç”¨äºè¿æ¥å†…ç½‘æœåŠ¡å™¨ã€‚

```
ç½‘ç»œæ‹“æ‰‘ç¤ºä¾‹ï¼š
ä½ çš„ç”µè„‘ â†’ è·³æ¿æœº â†’ å†…ç½‘æœåŠ¡å™¨

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä½ çš„ç”µè„‘   â”‚â”€â”€â”€â”€â”‚   è·³æ¿æœº    â”‚â”€â”€â”€â”€â”‚  å†…ç½‘æœåŠ¡å™¨ â”‚  
â”‚ (å…¬ç½‘)      â”‚    â”‚ (å…¬ç½‘+å†…ç½‘) â”‚    â”‚  (ä»…å†…ç½‘)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä½¿ç”¨åœºæ™¯ï¼š
- å…¬å¸å†…ç½‘æœåŠ¡å™¨åªèƒ½é€šè¿‡VPNæˆ–è·³æ¿æœºè®¿é—®
- äº‘æœåŠ¡å™¨çš„ç§æœ‰ç½‘ç»œéœ€è¦é€šè¿‡å…¬ç½‘æœºå™¨ä¸­è½¬
- æé«˜å®‰å…¨æ€§ï¼Œé¿å…ç›´æ¥æš´éœ²å†…ç½‘æœåŠ¡å™¨
```

### 6.2 ProxyJumpé…ç½®


**ç°ä»£ä»£ç†è·³è½¬æ–¹å¼**ï¼ˆSSH 7.3+æ¨èï¼‰ï¼š
```bash
# åŸºæœ¬ä»£ç†è·³è½¬é…ç½®
Host internal-server
    HostName 192.168.10.100      # å†…ç½‘æœåŠ¡å™¨IP
    User admin
    ProxyJump jump-server         # é€šè¿‡jump-serverè·³è½¬

# è·³æ¿æœºé…ç½®    
Host jump-server
    HostName jump.company.com     # è·³æ¿æœºåœ°å€
    User jumpuser
    Port 22
```

**å¤šçº§è·³è½¬**ï¼š
```bash
# é€šè¿‡ä¸¤çº§è·³è½¬è®¿é—®ç›®æ ‡æœåŠ¡å™¨
Host target-server
    HostName 10.0.1.100
    User admin  
    ProxyJump jump1,jump2         # å…ˆè·³jump1ï¼Œå†è·³jump2

# è·³æ¿æœº1
Host jump1
    HostName first-jump.com
    User user1
    
# è·³æ¿æœº2  
Host jump2
    HostName second-jump.internal
    User user2
```

### 6.3 ProxyCommandé…ç½®


**ä¼ ç»Ÿä»£ç†æ–¹å¼**ï¼ˆå…¼å®¹è€ç‰ˆæœ¬SSHï¼‰ï¼š
```bash
# ä½¿ç”¨ncå‘½ä»¤åšä»£ç†
Host internal-server
    HostName 192.168.10.100
    User admin
    ProxyCommand ssh -W %h:%p jump-server

# ä½¿ç”¨netcatä»£ç†    
Host another-internal
    HostName 192.168.10.101
    User root
    ProxyCommand ssh jump-server nc %h %p
```

**å‚æ•°è¯´æ˜**ï¼š
- `%h`ï¼šç›®æ ‡ä¸»æœºå
- `%p`ï¼šç›®æ ‡ç«¯å£å·  
- `-W %h:%p`ï¼šSSHå†…ç½®çš„ç«¯å£è½¬å‘

### 6.4 å®é™…åº”ç”¨åœºæ™¯


**äº‘æœåŠ¡å™¨å†…ç½‘è®¿é—®**ï¼š
```bash
# é˜¿é‡Œäº‘/è…¾è®¯äº‘å†…ç½‘æœåŠ¡å™¨è®¿é—®
Host aliyun-jump
    HostName 47.96.xxx.xxx        # å…¬ç½‘è·³æ¿æœº
    User root
    IdentityFile ~/.ssh/aliyun.pem

Host aliyun-internal-*
    User root
    IdentityFile ~/.ssh/aliyun.pem  
    ProxyJump aliyun-jump          # é€šè¿‡è·³æ¿æœºè®¿é—®

# å…·ä½“å†…ç½‘æœåŠ¡å™¨
Host aliyun-internal-db
    HostName 172.16.1.10          # å†…ç½‘IP
    
Host aliyun-internal-web  
    HostName 172.16.1.11
```

**å…¬å¸å†…ç½‘æœåŠ¡å™¨**ï¼š
```bash
# å…¬å¸VPNè·³æ¿æœº
Host company-vpn
    HostName vpn.company.com
    User your-username
    
# å†…ç½‘å¼€å‘æœåŠ¡å™¨
Host dev-*  
    ProxyJump company-vpn
    User developer
    
Host dev-web
    HostName 192.168.1.100
    
Host dev-db
    HostName 192.168.1.101
```

---

## 7. ğŸ”„ è¿æ¥å¤ç”¨é…ç½®


### 7.1 ä»€ä¹ˆæ˜¯è¿æ¥å¤ç”¨


**è¿æ¥å¤ç”¨**å°±æ˜¯è®©å¤šä¸ªSSHè¿æ¥å…±äº«åŒä¸€ä¸ªç½‘ç»œè¿æ¥ï¼Œé¿å…é‡å¤å»ºç«‹è¿æ¥çš„å¼€é”€ã€‚

```
ä¼ ç»Ÿæ–¹å¼ï¼šæ¯æ¬¡SSHéƒ½å»ºç«‹æ–°è¿æ¥
ssh server1  â† å»ºç«‹è¿æ¥1
ssh server1  â† å»ºç«‹è¿æ¥2ï¼ˆé‡å¤å¼€é”€ï¼‰

å¤ç”¨æ–¹å¼ï¼šç¬¬ä¸€æ¬¡å»ºç«‹è¿æ¥ï¼Œåç»­å¤ç”¨
ssh server1  â† å»ºç«‹ä¸»è¿æ¥
ssh server1  â† å¤ç”¨ä¸»è¿æ¥ï¼ˆå¿«é€Ÿï¼‰
```

**ä¼˜ç‚¹**ï¼š
- ğŸš€ **è¿æ¥æ›´å¿«**ï¼šåç»­è¿æ¥ç§’å¼€
- ğŸ’° **èŠ‚çœèµ„æº**ï¼šå‡å°‘ç½‘ç»œå¼€é”€å’ŒæœåŠ¡å™¨è´Ÿè½½
- ğŸ”’ **æé«˜å®‰å…¨**ï¼šå‡å°‘è®¤è¯æ¬¡æ•°

### 7.2 ControlMasteré…ç½®


```bash
# å¯ç”¨è¿æ¥å¤ç”¨çš„åŸºæœ¬é…ç½®
Host *
    # å¯ç”¨è¿æ¥å¤ç”¨
    ControlMaster auto
    
    # å¤ç”¨è¿æ¥çš„socketæ–‡ä»¶ä½ç½®
    ControlPath ~/.ssh/sockets/%r@%h:%p
    
    # è¿æ¥ä¿æŒæ—¶é—´ï¼ˆç§’ï¼‰
    ControlPersist 600
```

**å‚æ•°è¯¦è§£**ï¼š
```bash
ControlMasterçš„é€‰é¡¹ï¼š
- auto: è‡ªåŠ¨å¤ç”¨ï¼Œå¦‚æœæœ‰ä¸»è¿æ¥å°±å¤ç”¨ï¼Œæ²¡æœ‰å°±åˆ›å»º
- yes: å¼ºåˆ¶ä½œä¸ºä¸»è¿æ¥  
- no: ä¸ä½¿ç”¨å¤ç”¨ï¼ˆé»˜è®¤ï¼‰
- ask: è¯¢é—®æ˜¯å¦å¤ç”¨

ControlPathè·¯å¾„å‚æ•°ï¼š
- %r: è¿œç¨‹ç”¨æˆ·å
- %h: ä¸»æœºå  
- %p: ç«¯å£å·
- %l: æœ¬åœ°ä¸»æœºå

ControlPersistæ—¶é—´ï¼š
- 10m: 10åˆ†é’Ÿ
- 1h: 1å°æ—¶  
- yes: æ°¸ä¹…ä¿æŒ
- no: ä¸ä¿æŒ
```

### 7.3 å®é™…é…ç½®ç¤ºä¾‹


**åˆ›å»ºsocketç›®å½•**ï¼š
```bash
# é¦–å…ˆåˆ›å»ºå­˜æ”¾socketæ–‡ä»¶çš„ç›®å½•
mkdir -p ~/.ssh/sockets
```

**åŸºæœ¬å¤ç”¨é…ç½®**ï¼š
```bash
# ~/.ssh/config

# å…¨å±€å¯ç”¨è¿æ¥å¤ç”¨
Host *
    ControlMaster auto
    ControlPath ~/.ssh/sockets/%r@%h:%p  
    ControlPersist 10m                   # 10åˆ†é’Ÿåå…³é—­ç©ºé—²è¿æ¥
    
# ç‰¹å®šæœåŠ¡å™¨çš„å¤ç”¨é…ç½®    
Host prod-servers prod-*
    ControlPersist 30m                   # ç”Ÿäº§æœåŠ¡å™¨ä¿æŒ30åˆ†é’Ÿ
    
Host dev-servers dev-*  
    ControlPersist 5m                    # å¼€å‘æœåŠ¡å™¨ä¿æŒ5åˆ†é’Ÿ
```

**é«˜çº§å¤ç”¨é…ç½®**ï¼š
```bash
# é¢‘ç¹è®¿é—®çš„æœåŠ¡å™¨ï¼šé•¿æ—¶é—´ä¿æŒè¿æ¥
Host important-server
    HostName prod.company.com
    User admin
    ControlMaster auto
    ControlPath ~/.ssh/sockets/important-%r@%h:%p
    ControlPersist 1h                    # ä¿æŒ1å°æ—¶
    
# ä¸´æ—¶è®¿é—®çš„æœåŠ¡å™¨ï¼šçŸ­æ—¶é—´ä¿æŒ  
Host temp-*
    ControlPersist 2m                    # åªä¿æŒ2åˆ†é’Ÿ
    
# ä¸éœ€è¦å¤ç”¨çš„æœåŠ¡å™¨
Host no-reuse-*
    ControlMaster no                     # ç¦ç”¨å¤ç”¨
```

### 7.4 å¤ç”¨è¿æ¥ç®¡ç†


**æŸ¥çœ‹å¤ç”¨è¿æ¥**ï¼š
```bash
# æŸ¥çœ‹å½“å‰çš„å¤ç”¨è¿æ¥
ssh -O check server-name

# å¼ºåˆ¶å…³é—­å¤ç”¨è¿æ¥
ssh -O exit server-name

# æŸ¥çœ‹socketæ–‡ä»¶
ls -la ~/.ssh/sockets/
```

**å¤ç”¨è¿æ¥çŠ¶æ€ç¤ºä¾‹**ï¼š
```bash
# ç¬¬ä¸€æ¬¡è¿æ¥ï¼ˆå»ºç«‹ä¸»è¿æ¥ï¼‰
$ ssh web-server
# è¾“å‡ºï¼šEstablishing new connection...

# ç¬¬äºŒæ¬¡è¿æ¥ï¼ˆå¤ç”¨è¿æ¥ï¼‰  
$ ssh web-server  
# è¾“å‡ºï¼šReusing existing connection...ï¼ˆå‡ ä¹ç§’è¿ï¼‰

# æ–‡ä»¶ä¼ è¾“ä¹Ÿä¼šå¤ç”¨è¿æ¥
$ scp file.txt web-server:/tmp/
# è¾“å‡ºï¼šUsing existing connection...
```

---

## 8. ğŸ” é…ç½®æ–‡ä»¶æƒé™ä¸å®‰å…¨


### 8.1 æƒé™è¦æ±‚


SSHå¯¹é…ç½®æ–‡ä»¶çš„æƒé™è¦æ±‚å¾ˆä¸¥æ ¼ï¼Œè¿™æ˜¯ä¸ºäº†ä¿æŠ¤ä½ çš„è¿æ¥ä¿¡æ¯å’Œå¯†é’¥å®‰å…¨ã€‚

```bash
# æ­£ç¡®çš„æƒé™è®¾ç½®
chmod 700 ~/.ssh                    # SSHç›®å½•ï¼šä»…æ‰€æœ‰è€…å¯è¯»å†™æ‰§è¡Œ
chmod 600 ~/.ssh/config             # é…ç½®æ–‡ä»¶ï¼šä»…æ‰€æœ‰è€…å¯è¯»å†™  
chmod 600 ~/.ssh/id_rsa             # ç§é’¥æ–‡ä»¶ï¼šä»…æ‰€æœ‰è€…å¯è¯»å†™
chmod 644 ~/.ssh/id_rsa.pub         # å…¬é’¥æ–‡ä»¶ï¼šæ‰€æœ‰è€…å¯è¯»å†™ï¼Œå…¶ä»–äººå¯è¯»
chmod 644 ~/.ssh/known_hosts        # å·²çŸ¥ä¸»æœºï¼šæ‰€æœ‰è€…å¯è¯»å†™ï¼Œå…¶ä»–äººå¯è¯»
```

**æƒé™æ£€æŸ¥è„šæœ¬**ï¼š
```bash
#!/bin/bash
# æ£€æŸ¥SSHç›®å½•æƒé™

echo "æ£€æŸ¥SSHç›®å½•æƒé™..."
ls -ld ~/.ssh/
ls -la ~/.ssh/config ~/.ssh/id_* ~/.ssh/known_hosts 2>/dev/null

echo -e "\nä¿®å¤æƒé™..."
chmod 700 ~/.ssh
chmod 600 ~/.ssh/config
chmod 600 ~/.ssh/id_*
chmod 644 ~/.ssh/*.pub
chmod 644 ~/.ssh/known_hosts

echo "æƒé™ä¿®å¤å®Œæˆï¼"
```

### 8.2 å…¨å±€é…ç½®vsç”¨æˆ·é…ç½®


```bash
æƒé™å¯¹æ¯”ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      æ–‡ä»¶ä½ç½®       â”‚      æƒé™       â”‚      ä½œç”¨èŒƒå›´    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /etc/ssh/ssh_config â”‚ 644 (rootæ‹¥æœ‰)  â”‚   æ‰€æœ‰ç”¨æˆ·      â”‚
â”‚ ~/.ssh/config       â”‚ 600 (ç”¨æˆ·æ‹¥æœ‰)  â”‚   å½“å‰ç”¨æˆ·      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è¯»å–ä¼˜å…ˆçº§ï¼šç”¨æˆ·é…ç½® > å…¨å±€é…ç½®
```

**ç”¨æˆ·é…ç½®æ–‡ä»¶å®‰å…¨æ£€æŸ¥**ï¼š
```bash
# æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦å®‰å…¨
ssh_config_check() {
    local config_file="$HOME/.ssh/config"
    
    if [[ ! -f "$config_file" ]]; then
        echo "é…ç½®æ–‡ä»¶ä¸å­˜åœ¨"
        return
    fi
    
    # æ£€æŸ¥æ–‡ä»¶æƒé™
    local perm=$(stat -f "%A" "$config_file" 2>/dev/null || stat -c "%a" "$config_file")
    if [[ "$perm" != "600" ]]; then
        echo "è­¦å‘Šï¼šé…ç½®æ–‡ä»¶æƒé™ä¸å®‰å…¨ ($perm)ï¼Œå»ºè®®è®¾ç½®ä¸º600"
        echo "æ‰§è¡Œï¼šchmod 600 ~/.ssh/config"
    fi
    
    # æ£€æŸ¥æ–‡ä»¶æ‰€æœ‰è€…
    local owner=$(stat -f "%Su" "$config_file" 2>/dev/null || stat -c "%U" "$config_file")
    if [[ "$owner" != "$USER" ]]; then
        echo "è­¦å‘Šï¼šé…ç½®æ–‡ä»¶æ‰€æœ‰è€…ä¸æ­£ç¡® ($owner)"
    fi
    
    echo "é…ç½®æ–‡ä»¶å®‰å…¨æ£€æŸ¥å®Œæˆ"
}
```

### 8.3 å®‰å…¨é…ç½®å»ºè®®


**åŸºæœ¬å®‰å…¨é…ç½®**ï¼š
```bash
# ~/.ssh/config å®‰å…¨é…ç½®æ¨¡æ¿

# å…¨å±€å®‰å…¨è®¾ç½®
Host *
    # ä¸»æœºå¯†é’¥æ£€æŸ¥
    StrictHostKeyChecking ask
    HashKnownHosts yes                   # åŠ å¯†known_hostsæ–‡ä»¶
    
    # è®¤è¯å®‰å…¨
    PubkeyAuthentication yes
    PasswordAuthentication no            # ç¦ç”¨å¯†ç è®¤è¯ï¼ˆæ¨èï¼‰
    ChallengeResponseAuthentication no   # ç¦ç”¨è¯¢é—®å“åº”è®¤è¯
    
    # åè®®å®‰å…¨  
    Protocol 2                          # åªä½¿ç”¨SSH-2åè®®
    Ciphers aes128-ctr,aes192-ctr,aes256-ctr
    MACs hmac-sha2-256,hmac-sha2-512
    
    # è¿æ¥å®‰å…¨
    ServerAliveInterval 300             # 5åˆ†é’Ÿå¿ƒè·³æ£€æµ‹
    ServerAliveCountMax 2               # æœ€å¤š2æ¬¡å¿ƒè·³å¤±è´¥
```

**ç”Ÿäº§ç¯å¢ƒå®‰å…¨é…ç½®**ï¼š
```bash
# ç”Ÿäº§æœåŠ¡å™¨ä¸¥æ ¼é…ç½®
Host prod-* production-*
    StrictHostKeyChecking yes           # ä¸¥æ ¼æ£€æŸ¥ä¸»æœºå¯†é’¥
    PasswordAuthentication no           # ç¦æ­¢å¯†ç ç™»å½•
    PubkeyAuthentication yes            # åªå…è®¸å¯†é’¥ç™»å½•
    IdentitiesOnly yes                  # åªä½¿ç”¨æŒ‡å®šå¯†é’¥
    LogLevel INFO                       # è®°å½•è¿æ¥æ—¥å¿—
    
# å¼€å‘æœåŠ¡å™¨å®½æ¾é…ç½®    
Host dev-* test-*
    StrictHostKeyChecking ask           # è¯¢é—®æ˜¯å¦ä¿¡ä»»æ–°ä¸»æœº
    PasswordAuthentication yes          # å…è®¸å¯†ç ç™»å½•ï¼ˆå¼€å‘æ–¹ä¾¿ï¼‰
```

**å¯†é’¥ç®¡ç†å®‰å…¨**ï¼š
```bash
# ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒå¯†é’¥
Host prod-*
    IdentityFile ~/.ssh/production_rsa  # ç”Ÿäº§ç¯å¢ƒä¸“ç”¨å¯†é’¥
    IdentitiesOnly yes
    
Host dev-*  
    IdentityFile ~/.ssh/development_rsa # å¼€å‘ç¯å¢ƒä¸“ç”¨å¯†é’¥
    IdentitiesOnly yes
    
Host personal-*
    IdentityFile ~/.ssh/personal_rsa    # ä¸ªäººé¡¹ç›®ä¸“ç”¨å¯†é’¥
    IdentitiesOnly yes
```

---

## 9. ğŸ’¡ å®ç”¨é…ç½®ç¤ºä¾‹


### 9.1 Webå¼€å‘ç¯å¢ƒé…ç½®


```bash
# ~/.ssh/config - Webå¼€å‘å›¢é˜Ÿé…ç½®

# ===== å¼€å‘ç¯å¢ƒ =====
Host dev-*
    User developer
    IdentityFile ~/.ssh/dev_team_key
    StrictHostKeyChecking no
    UserKnownHostsFile /dev/null        # ä¸ä¿å­˜ä¸»æœºå¯†é’¥ï¼ˆæµ‹è¯•ç”¨ï¼‰
    LogLevel QUIET                      # å‡å°‘è¾“å‡ºä¿¡æ¯

# å‰ç«¯å¼€å‘æœåŠ¡å™¨    
Host dev-frontend
    HostName dev-frontend.company.com
    Port 22
    
# åç«¯APIæœåŠ¡å™¨
Host dev-api  
    HostName dev-api.company.com
    Port 22
    LocalForward 3000 localhost:3000    # ç«¯å£è½¬å‘
    
# æ•°æ®åº“æœåŠ¡å™¨
Host dev-db
    HostName dev-db.company.com  
    Port 22
    LocalForward 5432 localhost:5432    # PostgreSQLç«¯å£è½¬å‘

# ===== æµ‹è¯•ç¯å¢ƒ =====  
Host test-*
    User tester
    IdentityFile ~/.ssh/test_key
    
Host test-web
    HostName test.company.com
    
# ===== ç”Ÿäº§ç¯å¢ƒ =====
Host prod-*
    User admin
    IdentityFile ~/.ssh/production_key
    StrictHostKeyChecking yes
    LogLevel VERBOSE                    # è¯¦ç»†æ—¥å¿—
    
Host prod-web1
    HostName prod-web1.company.com
    
Host prod-web2  
    HostName prod-web2.company.com
```

### 9.2 äº‘æœåŠ¡å™¨ç®¡ç†é…ç½®


```bash
# å¤šäº‘å¹³å°æœåŠ¡å™¨ç®¡ç†

# ===== é˜¿é‡Œäº‘æœåŠ¡å™¨ =====
Host aliyun-*
    User root
    IdentityFile ~/.ssh/aliyun.pem
    ServerAliveInterval 60
    
# é˜¿é‡Œäº‘è·³æ¿æœº    
Host aliyun-jump
    HostName 47.xxx.xxx.xxx
    Port 22
    
# é˜¿é‡Œäº‘å†…ç½‘æœåŠ¡å™¨ï¼ˆé€šè¿‡è·³æ¿æœºè®¿é—®ï¼‰
Host aliyun-internal-*
    ProxyJump aliyun-jump
    
Host aliyun-internal-web
    HostName 172.16.0.10
    
Host aliyun-internal-db
    HostName 172.16.0.11
    LocalForward 3306 localhost:3306    # MySQLç«¯å£è½¬å‘

# ===== è…¾è®¯äº‘æœåŠ¡å™¨ =====  
Host tencent-*
    User ubuntu
    IdentityFile ~/.ssh/tencent.pem
    
Host tencent-web
    HostName 119.xxx.xxx.xxx
    Port 22

# ===== AWSæœåŠ¡å™¨ =====
Host aws-*
    User ec2-user  
    IdentityFile ~/.ssh/aws-key.pem
    
Host aws-web
    HostName ec2-xxx.compute.amazonaws.com
    Port 22
```

### 9.3 ç«¯å£è½¬å‘é…ç½®


```bash
# æœ¬åœ°ç«¯å£è½¬å‘ï¼ˆLocal Forwardï¼‰
Host database-tunnel
    HostName database.company.com
    User dbadmin
    # æœ¬åœ°8080ç«¯å£ â†’ è¿œç¨‹3306ç«¯å£  
    LocalForward 8080 localhost:3306
    # ç°åœ¨å¯ä»¥ç”¨ localhost:8080 è®¿é—®è¿œç¨‹æ•°æ®åº“

# è¿œç¨‹ç«¯å£è½¬å‘ï¼ˆRemote Forwardï¼‰    
Host reverse-tunnel
    HostName public-server.com
    User admin
    # è¿œç¨‹8080ç«¯å£ â†’ æœ¬åœ°3000ç«¯å£
    RemoteForward 8080 localhost:3000
    # å¤–ç½‘å¯ä»¥é€šè¿‡ public-server.com:8080 è®¿é—®ä½ çš„æœ¬åœ°æœåŠ¡

# åŠ¨æ€ç«¯å£è½¬å‘ï¼ˆSOCKSä»£ç†ï¼‰
Host socks-proxy
    HostName proxy-server.com  
    User proxy
    DynamicForward 1080              # åœ¨æœ¬åœ°1080ç«¯å£åˆ›å»ºSOCKSä»£ç†
    # é…ç½®æµè§ˆå™¨ä½¿ç”¨ localhost:1080 ä½œä¸ºSOCKSä»£ç†
```

### 9.4 è‡ªåŠ¨åŒ–è¿ç»´é…ç½®


```bash
# æ‰¹é‡æœåŠ¡å™¨ç®¡ç†é…ç½®

# ===== WebæœåŠ¡å™¨é›†ç¾¤ =====
Host web-cluster web[1-9] web[1-9][0-9]
    User www-data
    IdentityFile ~/.ssh/webserver_key
    Port 22
    
# å…·ä½“WebæœåŠ¡å™¨    
Host web1
    HostName 192.168.1.10
    
Host web2
    HostName 192.168.1.11
    
Host web3  
    HostName 192.168.1.12

# ===== æ•°æ®åº“é›†ç¾¤ =====
Host db-*
    User dbadmin
    IdentityFile ~/.ssh/database_key
    Port 3306
    
Host db-master
    HostName 192.168.2.10
    
Host db-slave1
    HostName 192.168.2.11
    
Host db-slave2
    HostName 192.168.2.12

# ===== ç›‘æ§æœåŠ¡å™¨ =====
Host monitor
    HostName monitor.company.com
    User admin
    IdentityFile ~/.ssh/monitor_key
    # Grafanaç«¯å£è½¬å‘
    LocalForward 3000 localhost:3000
    # Prometheusç«¯å£è½¬å‘  
    LocalForward 9090 localhost:9090
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ é…ç½®æ–‡ä»¶ä½ç½®ï¼š~/.ssh/configï¼ˆç”¨æˆ·çº§ï¼‰ã€/etc/ssh/ssh_configï¼ˆç³»ç»Ÿçº§ï¼‰
ğŸ”¸ åŸºæœ¬è¯­æ³•ï¼šHostå— + é…ç½®é€‰é¡¹ï¼Œæ”¯æŒé€šé…ç¬¦åŒ¹é…
ğŸ”¸ ç»§æ‰¿æœºåˆ¶ï¼šç¬¬ä¸€æ¬¡åŒ¹é…ç”Ÿæ•ˆï¼Œåç»­é…ç½®è¢«å¿½ç•¥
ğŸ”¸ å¸¸ç”¨é€‰é¡¹ï¼šHostNameã€Userã€Portã€IdentityFile
ğŸ”¸ æƒé™è¦æ±‚ï¼šç›®å½•700ï¼Œé…ç½®æ–‡ä»¶600ï¼Œå¯†é’¥600
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ é…ç½®æ–‡ä»¶çš„æœ¬è´¨**
```
SSHé…ç½®æ–‡ä»¶ = è¿æ¥å‚æ•°çš„é›†åˆç®¡ç†
ä½œç”¨ï¼šç®€åŒ–å‘½ä»¤ + ç»Ÿä¸€ç®¡ç† + æé«˜å®‰å…¨æ€§
æ ¸å¿ƒä»·å€¼ï¼šè®©å¤æ‚çš„SSHè¿æ¥å˜æˆç®€å•çš„åˆ«å
```

**ğŸ”¹ HoståŒ¹é…çš„é‡è¦æ€§**  
```
åŒ¹é…é¡ºåºï¼šä»ä¸Šåˆ°ä¸‹ï¼Œç¬¬ä¸€æ¬¡åŒ¹é…ç”Ÿæ•ˆ
é…ç½®é¡ºåºï¼šå…·ä½“é…ç½®åœ¨å‰ï¼Œé€šç”¨é…ç½®åœ¨å
é€šé…ç¬¦ï¼š*åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œ!è¡¨ç¤ºæ’é™¤
```

**ğŸ”¹ ä»£ç†è·³è½¬çš„åº”ç”¨åœºæ™¯**
```
å†…ç½‘æœåŠ¡å™¨è®¿é—®ï¼šå…¬ç½‘ â†’ è·³æ¿æœº â†’ å†…ç½‘æœåŠ¡å™¨  
äº‘æœåŠ¡å™¨ç®¡ç†ï¼šå…¬ç½‘æœºå™¨ â†’ ç§æœ‰ç½‘ç»œå†…æœºå™¨
å®‰å…¨è®¿é—®ï¼šé€šè¿‡ä¸­é—´æœåŠ¡å™¨æé«˜å®‰å…¨æ€§
```

**ğŸ”¹ è¿æ¥å¤ç”¨çš„ä»·å€¼**
```
æ€§èƒ½æå‡ï¼šå‡å°‘è¿æ¥å»ºç«‹æ—¶é—´
èµ„æºèŠ‚çº¦ï¼šé™ä½ç½‘ç»œå’ŒæœåŠ¡å™¨å¼€é”€
ç”¨æˆ·ä½“éªŒï¼šåç»­è¿æ¥å‡ ä¹ç¬é—´å®Œæˆ
```

### 10.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ æ—¥å¸¸ä½¿ç”¨åœºæ™¯**
- **æœåŠ¡å™¨è¿ç»´**ï¼šç®¡ç†å¤šå°æœåŠ¡å™¨ï¼Œå¿«é€Ÿåˆ‡æ¢è¿æ¥
- **å¼€å‘æµ‹è¯•**ï¼šåœ¨ä¸åŒç¯å¢ƒé—´å¿«é€Ÿåˆ‡æ¢  
- **æ–‡ä»¶ä¼ è¾“**ï¼šscp/rsyncç­‰å·¥å…·ä¹Ÿä¼šä½¿ç”¨é…ç½®æ–‡ä»¶
- **ç«¯å£è½¬å‘**ï¼šè®¿é—®å†…ç½‘æœåŠ¡ï¼Œåˆ›å»ºå®‰å…¨éš§é“

**ğŸ¯ æœ€ä½³å®è·µå»ºè®®**
- **ç¯å¢ƒåˆ†ç¦»**ï¼šä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒé…ç½®å’Œå¯†é’¥
- **å®‰å…¨ä¼˜å…ˆ**ï¼šç”Ÿäº§ç¯å¢ƒä¸¥æ ¼é…ç½®ï¼Œå¼€å‘ç¯å¢ƒé€‚åº¦å®½æ¾
- **åˆ«åè§„èŒƒ**ï¼šä½¿ç”¨æœ‰æ„ä¹‰çš„åˆ«åï¼Œä¾¿äºè®°å¿†å’Œç®¡ç†  
- **å®šæœŸç»´æŠ¤**ï¼šæ¸…ç†æ— ç”¨é…ç½®ï¼Œæ›´æ–°å¯†é’¥å’Œæƒé™

**ğŸ¯ å¸¸è§é—®é¢˜å¤„ç†**
- **æƒé™é”™è¯¯**ï¼šæ£€æŸ¥æ–‡ä»¶æƒé™ï¼Œç¡®ä¿SSHç›®å½•å’Œæ–‡ä»¶æƒé™æ­£ç¡®
- **è¿æ¥å¤±è´¥**ï¼šæ£€æŸ¥HoståŒ¹é…é¡ºåºï¼Œç¡®è®¤ç½‘ç»œè¿é€šæ€§
- **å¯†é’¥é—®é¢˜**ï¼šç¡®è®¤IdentityFileè·¯å¾„æ­£ç¡®ï¼Œå¯†é’¥æƒé™ä¸º600
- **ä»£ç†å¤±è´¥**ï¼šæ£€æŸ¥è·³æ¿æœºé…ç½®ï¼Œç¡®è®¤ProxyJumpè¯­æ³•æ­£ç¡®

**æ ¸å¿ƒè®°å¿†**ï¼š
- SSHé…ç½®æ–‡ä»¶è®©å¤æ‚è¿æ¥å˜ç®€å•åˆ«å
- Hostå—é…ç½®éµå¾ªç¬¬ä¸€åŒ¹é…åŸåˆ™  
- ä»£ç†è·³è½¬è§£å†³å†…ç½‘è®¿é—®éš¾é¢˜
- è¿æ¥å¤ç”¨å¤§å¹…æå‡ä½¿ç”¨ä½“éªŒ
- æƒé™å®‰å…¨æ˜¯SSHé…ç½®çš„åŸºçŸ³