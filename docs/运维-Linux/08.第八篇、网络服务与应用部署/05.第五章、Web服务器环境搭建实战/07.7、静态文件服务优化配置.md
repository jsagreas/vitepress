---
title: 7ã€é™æ€æ–‡ä»¶æœåŠ¡ä¼˜åŒ–é…ç½®
---
## ğŸ“š ç›®å½•

1. [é™æ€æ–‡ä»¶æœåŠ¡åŸºç¡€æ¦‚å¿µ](#1-é™æ€æ–‡ä»¶æœåŠ¡åŸºç¡€æ¦‚å¿µ)
2. [æ–‡ä»¶ç¼“å­˜é…ç½®ç­–ç•¥](#2-æ–‡ä»¶ç¼“å­˜é…ç½®ç­–ç•¥)
3. [æ–‡ä»¶å‹ç¼©ä¼˜åŒ–é…ç½®](#3-æ–‡ä»¶å‹ç¼©ä¼˜åŒ–é…ç½®)
4. [MIMEç±»å‹é…ç½®ç®¡ç†](#4-MIMEç±»å‹é…ç½®ç®¡ç†)
5. [é˜²ç›—é“¾ä¿æŠ¤é…ç½®](#5-é˜²ç›—é“¾ä¿æŠ¤é…ç½®)
6. [ç›®å½•æµè§ˆä¸å®‰å…¨é…ç½®](#6-ç›®å½•æµè§ˆä¸å®‰å…¨é…ç½®)
7. [æ–‡ä»¶ä¸Šä¼ é™åˆ¶é…ç½®](#7-æ–‡ä»¶ä¸Šä¼ é™åˆ¶é…ç½®)
8. [CDNé›†æˆä¸æ€§èƒ½ä¼˜åŒ–](#8-CDNé›†æˆä¸æ€§èƒ½ä¼˜åŒ–)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ é™æ€æ–‡ä»¶æœåŠ¡åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯é™æ€æ–‡ä»¶æœåŠ¡

**é™æ€æ–‡ä»¶æœåŠ¡**å°±æ˜¯WebæœåŠ¡å™¨ç›´æ¥æä¾›ä¸éœ€è¦ç¨‹åºå¤„ç†çš„æ–‡ä»¶ï¼Œæ¯”å¦‚å›¾ç‰‡ã€CSSã€JavaScriptç­‰ï¼Œå°±åƒå›¾ä¹¦é¦†ç›´æ¥å€Ÿé˜…ä¹¦ç±ä¸€æ ·ç®€å•ã€‚

> **ğŸ’¡ æ ¸å¿ƒç†è§£**
> é™æ€æ–‡ä»¶ = å†…å®¹å›ºå®šä¸å˜çš„æ–‡ä»¶ï¼ŒæœåŠ¡å™¨ç›´æ¥å‘é€ç»™å®¢æˆ·ç«¯ï¼Œæ— éœ€ç¨‹åºè®¡ç®—

**ğŸ”¸ é™æ€æ–‡ä»¶ vs åŠ¨æ€æ–‡ä»¶ï¼š**
```
é™æ€æ–‡ä»¶ç¤ºä¾‹ï¼š
ğŸ“· å›¾ç‰‡ï¼šlogo.png, banner.jpg
ğŸ¨ æ ·å¼ï¼šstyle.css, theme.css  
ğŸ“œ è„šæœ¬ï¼šapp.js, jquery.min.js
ğŸ“„ æ–‡æ¡£ï¼šmanual.pdf, readme.txt

åŠ¨æ€æ–‡ä»¶ç¤ºä¾‹ï¼š
ğŸ”„ ç”¨æˆ·ä¿¡æ¯é¡µé¢ï¼ˆéœ€è¦ä»æ•°æ®åº“æŸ¥è¯¢ï¼‰
ğŸ’° è´­ç‰©è½¦å†…å®¹ï¼ˆå®æ—¶è®¡ç®—ï¼‰
ğŸ“Š ç»Ÿè®¡æŠ¥è¡¨ï¼ˆåŠ¨æ€ç”Ÿæˆï¼‰
```

### 1.2 é™æ€æ–‡ä»¶æœåŠ¡çš„é‡è¦æ€§


**âš¡ æ€§èƒ½ä¼˜åŠ¿ï¼š**
- **å“åº”é€Ÿåº¦å¿«**ï¼šæ— éœ€ç¨‹åºå¤„ç†ï¼Œç›´æ¥è¯»å–æ–‡ä»¶
- **èµ„æºæ¶ˆè€—ä½**ï¼šä¸å ç”¨åº”ç”¨æœåŠ¡å™¨èµ„æº
- **å¹¶å‘èƒ½åŠ›å¼º**ï¼šå¯åŒæ—¶å¤„ç†å¤§é‡é™æ€æ–‡ä»¶è¯·æ±‚

**ğŸ’° æˆæœ¬æ•ˆç›Šï¼š**
- **å¸¦å®½èŠ‚çœ**ï¼šé€šè¿‡ç¼“å­˜å‡å°‘é‡å¤ä¼ è¾“
- **æœåŠ¡å™¨å‡è´Ÿ**ï¼šé‡Šæ”¾æ›´å¤šèµ„æºç»™åŠ¨æ€å†…å®¹
- **ç”¨æˆ·ä½“éªŒå¥½**ï¼šé¡µé¢åŠ è½½é€Ÿåº¦æ˜æ˜¾æå‡

---

## 2. â° æ–‡ä»¶ç¼“å­˜é…ç½®ç­–ç•¥


### 2.1 æµè§ˆå™¨ç¼“å­˜æœºåˆ¶åŸç†


**ç¼“å­˜æœºåˆ¶**å°±æ˜¯è®©æµè§ˆå™¨æŠŠæ–‡ä»¶ä¿å­˜åœ¨æœ¬åœ°ï¼Œä¸‹æ¬¡è®¿é—®æ—¶ç›´æ¥ä½¿ç”¨æœ¬åœ°æ–‡ä»¶ï¼Œé¿å…é‡å¤ä¸‹è½½ã€‚

```
ä¼ ç»Ÿè®¿é—®æµç¨‹ï¼š
ç”¨æˆ·è®¿é—® â†’ æœåŠ¡å™¨å‘é€æ–‡ä»¶ â†’ æ˜¾ç¤ºé¡µé¢
æ¯æ¬¡éƒ½éœ€è¦ä¸‹è½½ï¼Œæµªè´¹å¸¦å®½å’Œæ—¶é—´

ç¼“å­˜ä¼˜åŒ–æµç¨‹ï¼š
é¦–æ¬¡è®¿é—® â†’ æœåŠ¡å™¨å‘é€æ–‡ä»¶+ç¼“å­˜è§„åˆ™ â†’ æœ¬åœ°ä¿å­˜
å†æ¬¡è®¿é—® â†’ æ£€æŸ¥ç¼“å­˜æœ‰æ•ˆæœŸ â†’ ç›´æ¥ä½¿ç”¨æœ¬åœ°æ–‡ä»¶
```

### 2.2 Nginxç¼“å­˜é…ç½®å®è·µ


**ğŸ”§ åŸºç¡€ç¼“å­˜é…ç½®ï¼š**
```nginx
server {
    listen 80;
    server_name example.com;
    
    # å›¾ç‰‡æ–‡ä»¶ç¼“å­˜30å¤©
    location ~* \.(jpg|jpeg|png|gif|ico|svg)$ {
        expires 30d;
        add_header Cache-Control "public, immutable";
        access_log off;
    }
    
    # CSSå’ŒJSæ–‡ä»¶ç¼“å­˜7å¤©
    location ~* \.(css|js)$ {
        expires 7d;
        add_header Cache-Control "public";
    }
    
    # å­—ä½“æ–‡ä»¶ç¼“å­˜1å¹´
    location ~* \.(woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
        add_header Access-Control-Allow-Origin "*";
    }
}
```

**ğŸ“Š ç¼“å­˜æ—¶é—´ç­–ç•¥è¡¨ï¼š**

| æ–‡ä»¶ç±»å‹ | **ç¼“å­˜æ—¶é—´** | **åŸå› ** | **Cache-Control** |
|---------|-------------|----------|------------------|
| `å›¾ç‰‡æ–‡ä»¶` | `30å¤©` | ä¸å¸¸å˜æ›´ | `public, immutable` |
| `CSS/JS` | `7å¤©` | å¯èƒ½æ›´æ–° | `public` |
| `å­—ä½“æ–‡ä»¶` | `1å¹´` | åŸºæœ¬ä¸å˜ | `public, immutable` |
| `HTMLæ–‡ä»¶` | `ä¸ç¼“å­˜` | ç»å¸¸æ›´æ–° | `no-cache` |

### 2.3 é«˜çº§ç¼“å­˜æ§åˆ¶


**ğŸ¯ çµæ´»ç¼“å­˜ç­–ç•¥ï¼š**
```nginx
# æ ¹æ®æ–‡ä»¶ä¿®æ”¹æ—¶é—´åŠ¨æ€è®¾ç½®ç¼“å­˜
location ~* \.(css|js)$ {
    expires modified +7d;
    add_header Cache-Control "public";
}

# å¼€å‘ç¯å¢ƒç¦ç”¨ç¼“å­˜
location ~* \.(css|js)$ {
    if ($http_host ~ "dev\.") {
        expires -1;
        add_header Cache-Control "no-cache, no-store, must-revalidate";
    }
    expires 7d;
}

# åŸºäºç”¨æˆ·ä»£ç†è®¾ç½®ç¼“å­˜
location ~* \.(png|jpg)$ {
    if ($http_user_agent ~* "bot|crawler|spider") {
        expires 1d;
    }
    expires 30d;
}
```

---

## 3. ğŸ—œï¸ æ–‡ä»¶å‹ç¼©ä¼˜åŒ–é…ç½®


### 3.1 Gzipå‹ç¼©åŸç†


**Gzipå‹ç¼©**å°±æ˜¯æŠŠæ–‡ä»¶"æ‰“åŒ…å‹ç¼©"å†å‘é€ï¼Œå°±åƒé‚®å¯„ä¸œè¥¿æ—¶ç”¨å‹ç¼©è¢‹èŠ‚çœç©ºé—´ä¸€æ ·ã€‚

> **âš ï¸ æ³¨æ„äº‹é¡¹**
> å›¾ç‰‡ã€è§†é¢‘ç­‰å·²å‹ç¼©æ ¼å¼ä¸å»ºè®®å†æ¬¡å‹ç¼©ï¼Œæ•ˆæœä¸æ˜æ˜¾è¿˜æ¶ˆè€—CPU

### 3.2 Nginx Gzipé…ç½®


**ğŸ”§ åŸºç¡€å‹ç¼©é…ç½®ï¼š**
```nginx
http {
    # å¯ç”¨gzipå‹ç¼©
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_comp_level 6;
    
    # å‹ç¼©æ–‡ä»¶ç±»å‹
    gzip_types
        text/plain
        text/css
        text/xml
        text/javascript
        application/javascript
        application/xml+rss
        application/json
        image/svg+xml;
    
    # ä¸å‹ç¼©çš„æƒ…å†µ
    gzip_disable "msie6";
    
    server {
        location / {
            # å¯ç”¨é™æ€å‹ç¼©ï¼ˆé¢„å‹ç¼©æ–‡ä»¶ï¼‰
            gzip_static on;
        }
    }
}
```

**ğŸ“ˆ å‹ç¼©æ•ˆæœå¯¹æ¯”ï¼š**
```
æ–‡ä»¶å‹ç¼©å‰åå¯¹æ¯”ï¼š
â”œâ”€â”€ style.css (åŸå§‹: 150KB)
â”‚   â””â”€â”€ å‹ç¼©å: 25KB (èŠ‚çœ83%)
â”œâ”€â”€ app.js (åŸå§‹: 200KB)  
â”‚   â””â”€â”€ å‹ç¼©å: 45KB (èŠ‚çœ77%)
â””â”€â”€ data.json (åŸå§‹: 50KB)
    â””â”€â”€ å‹ç¼©å: 8KB (èŠ‚çœ84%)

æ€»ä¼ è¾“é‡: 400KB â†’ 78KB (èŠ‚çœ80%)
```

### 3.3 Brotlié«˜çº§å‹ç¼©


**ğŸš€ æ›´é«˜æ•ˆçš„å‹ç¼©ç®—æ³•ï¼š**
```nginx
# å®‰è£…ngx_brotliæ¨¡å—å
http {
    # å¯ç”¨brotliå‹ç¼©
    brotli on;
    brotli_comp_level 6;
    brotli_min_length 1024;
    
    brotli_types
        text/plain
        text/css
        application/javascript
        application/json
        image/svg+xml;
}
```

**ğŸ“Š å‹ç¼©ç®—æ³•å¯¹æ¯”ï¼š**

| å‹ç¼©ç®—æ³• | **å‹ç¼©ç‡** | **CPUæ¶ˆè€—** | **æµè§ˆå™¨æ”¯æŒ** |
|---------|-----------|------------|---------------|
| `Gzip` | `70-80%` | `ä¸­ç­‰` | `99%` |
| `Brotli` | `75-85%` | `è¾ƒé«˜` | `95%` |
| `æ— å‹ç¼©` | `0%` | `æœ€ä½` | `100%` |

---

## 4. ğŸ“„ MIMEç±»å‹é…ç½®ç®¡ç†


### 4.1 MIMEç±»å‹ä½œç”¨åŸç†


**MIMEç±»å‹**å‘Šè¯‰æµè§ˆå™¨è¿™ä¸ªæ–‡ä»¶æ˜¯ä»€ä¹ˆç±»å‹ï¼Œåº”è¯¥æ€ä¹ˆå¤„ç†ï¼Œå°±åƒæ–‡ä»¶çš„"èº«ä»½è¯"ã€‚

```
æµè§ˆå™¨è¯†åˆ«è¿‡ç¨‹ï¼š
1. æ¥æ”¶æ–‡ä»¶ â†’ 2. æŸ¥çœ‹MIMEç±»å‹ â†’ 3. é€‰æ‹©å¤„ç†æ–¹å¼

ä¾‹å¦‚ï¼š
text/html     â†’ æ¸²æŸ“ä¸ºç½‘é¡µ
image/jpeg    â†’ æ˜¾ç¤ºä¸ºå›¾ç‰‡  
application/pdf â†’ ç”¨PDFé˜…è¯»å™¨æ‰“å¼€
text/plain    â†’ æ˜¾ç¤ºä¸ºçº¯æ–‡æœ¬
```

### 4.2 å¸¸ç”¨MIMEç±»å‹é…ç½®


**ğŸ”§ Nginx MIMEé…ç½®ï¼š**
```nginx
http {
    include /etc/nginx/mime.types;
    default_type application/octet-stream;
    
    # è‡ªå®šä¹‰MIMEç±»å‹
    location ~* \.webp$ {
        add_header Content-Type image/webp;
    }
    
    # å¼ºåˆ¶ä¸‹è½½æŸäº›æ–‡ä»¶ç±»å‹
    location ~* \.(zip|rar|exe)$ {
        add_header Content-Type application/octet-stream;
        add_header Content-Disposition "attachment";
    }
    
    # APIæ¥å£è¿”å›JSON
    location /api/ {
        add_header Content-Type application/json;
    }
}
```

**ğŸ“‹ å…³é”®MIMEç±»å‹åˆ—è¡¨ï¼š**
```
Webæ–‡æ¡£ç±»å‹ï¼š
text/html          â†’ HTMLç½‘é¡µ
text/css           â†’ CSSæ ·å¼è¡¨  
text/javascript    â†’ JavaScriptè„šæœ¬
application/json   â†’ JSONæ•°æ®

å›¾ç‰‡ç±»å‹ï¼š
image/jpeg         â†’ JPEGå›¾ç‰‡
image/png          â†’ PNGå›¾ç‰‡
image/gif          â†’ GIFåŠ¨å›¾
image/svg+xml      â†’ SVGçŸ¢é‡å›¾
image/webp         â†’ WebPå›¾ç‰‡

æ–‡æ¡£ç±»å‹ï¼š
application/pdf    â†’ PDFæ–‡æ¡£
text/plain         â†’ çº¯æ–‡æœ¬
application/zip    â†’ ZIPå‹ç¼©åŒ…
```

---

## 5. ğŸ›¡ï¸ é˜²ç›—é“¾ä¿æŠ¤é…ç½®


### 5.1 é˜²ç›—é“¾åŸç†


**é˜²ç›—é“¾**å°±æ˜¯é˜²æ­¢å…¶ä»–ç½‘ç«™ç›´æ¥ä½¿ç”¨ä½ çš„å›¾ç‰‡æˆ–æ–‡ä»¶ï¼Œå°±åƒé˜²æ­¢åˆ«äººå·ç”¨ä½ å®¶çš„æ°´ç”µä¸€æ ·ã€‚

```
ç›—é“¾è¡Œä¸ºç¤ºä¾‹ï¼š
æ¶æ„ç½‘ç«™A: <img src="https://ä½ çš„ç½‘ç«™.com/expensive-image.jpg">
ç»“æœ: æ¶ˆè€—ä½ çš„å¸¦å®½ï¼Œå´ä¸ºåˆ«äººçš„ç½‘ç«™æä¾›æœåŠ¡

é˜²ç›—é“¾æ•ˆæœï¼š
æ£€æŸ¥æ¥æº â†’ å¦‚æœä¸æ˜¯å…è®¸çš„ç½‘ç«™ â†’ æ‹’ç»æˆ–è¿”å›è­¦å‘Šå›¾ç‰‡
```

### 5.2 åŸºç¡€é˜²ç›—é“¾é…ç½®


**ğŸ”§ Nginxé˜²ç›—é“¾å®ç°ï¼š**
```nginx
server {
    # å›¾ç‰‡é˜²ç›—é“¾
    location ~* \.(jpg|jpeg|png|gif)$ {
        valid_referers none blocked server_names
                      *.example.com 
                      example.com
                      *.google.com
                      *.baidu.com;
        
        if ($invalid_referer) {
            return 403;
            # æˆ–è€…è¿”å›è­¦å‘Šå›¾ç‰‡
            # rewrite ^/ /images/no-hotlink.png last;
        }
    }
    
    # ä¸‹è½½æ–‡ä»¶é˜²ç›—é“¾
    location /downloads/ {
        valid_referers server_names *.example.com;
        if ($invalid_referer) {
            return 403 "Access denied";
        }
    }
}
```

### 5.3 é«˜çº§é˜²ç›—é“¾ç­–ç•¥


**ğŸ¯ æ™ºèƒ½é˜²æŠ¤é…ç½®ï¼š**
```nginx
# åŸºäºUser-Agentçš„é˜²æŠ¤
location ~* \.(jpg|png)$ {
    # å…è®¸æœç´¢å¼•æ“çˆ¬è™«
    if ($http_user_agent ~* "googlebot|bingbot|spider") {
        break;
    }
    
    # æ£€æŸ¥referer
    valid_referers none blocked *.example.com;
    if ($invalid_referer) {
        return 403;
    }
}

# æ—¶é—´é™åˆ¶è®¿é—®
location /secure-files/ {
    # åªå…è®¸å·¥ä½œæ—¶é—´è®¿é—®
    if ($time_iso8601 !~ "T(09|1[0-7]):") {
        return 403 "Access denied outside business hours";
    }
}
```

---

## 6. ğŸ“‚ ç›®å½•æµè§ˆä¸å®‰å…¨é…ç½®


### 6.1 ç›®å½•æµè§ˆåŠŸèƒ½


**ç›®å½•æµè§ˆ**è®©ç”¨æˆ·å¯ä»¥çœ‹åˆ°æ–‡ä»¶å¤¹é‡Œçš„æ–‡ä»¶åˆ—è¡¨ï¼Œå°±åƒæ‰“å¼€ç”µè„‘çš„æ–‡ä»¶å¤¹ä¸€æ ·ã€‚

> **âš ï¸ å®‰å…¨æé†’**
> ç”Ÿäº§ç¯å¢ƒè°¨æ…å¼€å¯ç›®å½•æµè§ˆï¼Œå¯èƒ½æ³„éœ²æ•æ„Ÿä¿¡æ¯

### 6.2 ç›®å½•æµè§ˆé…ç½®


**ğŸ”§ å®‰å…¨çš„ç›®å½•æµè§ˆï¼š**
```nginx
server {
    # å…¬å…±ä¸‹è½½ç›®å½•å¯ç”¨æµè§ˆ
    location /downloads/ {
        autoindex on;
        autoindex_exact_size off;  # æ˜¾ç¤ºæ–‡ä»¶å¤§å°KB/MB
        autoindex_localtime on;    # æ˜¾ç¤ºæœ¬åœ°æ—¶é—´
        autoindex_format html;     # è¾“å‡ºæ ¼å¼
        charset utf-8;             # ä¸­æ–‡æ–‡ä»¶åæ”¯æŒ
    }
    
    # å—ä¿æŠ¤çš„ç›®å½•
    location /private/ {
        autoindex off;             # ç¦ç”¨ç›®å½•æµè§ˆ
        deny all;                  # ç¦æ­¢è®¿é—®
    }
    
    # æœ‰æ¡ä»¶çš„ç›®å½•æµè§ˆ
    location /files/ {
        # åªå…è®¸ç‰¹å®šIPæµè§ˆç›®å½•
        allow 192.168.1.0/24;
        deny all;
        
        autoindex on;
        autoindex_exact_size off;
    }
}
```

### 6.3 å®‰å…¨é˜²æŠ¤æªæ–½


**ğŸ›¡ï¸ ç›®å½•å®‰å…¨é…ç½®ï¼š**
```nginx
# éšè—æ•æ„Ÿæ–‡ä»¶
location ~ /\. {
    deny all;                    # éšè—.å¼€å¤´çš„æ–‡ä»¶
}

location ~ \.(conf|log|bak)$ {
    deny all;                    # ç¦æ­¢è®¿é—®é…ç½®å’Œæ—¥å¿—æ–‡ä»¶
}

# é˜²æ­¢æ‰§è¡Œä¸Šä¼ çš„è„šæœ¬
location /uploads/ {
    location ~ \.(php|pl|py|jsp)$ {
        deny all;
    }
}

# é™åˆ¶ç›®å½•è®¿é—®æ·±åº¦
location ~ ^/files/.+/.+/.+/ {
    return 403 "Too deep directory access";
}
```

---

## 7. ğŸ“¤ æ–‡ä»¶ä¸Šä¼ é™åˆ¶é…ç½®


### 7.1 ä¸Šä¼ é™åˆ¶çš„é‡è¦æ€§


**æ–‡ä»¶ä¸Šä¼ é™åˆ¶**é˜²æ­¢æ¶æ„ç”¨æˆ·ä¸Šä¼ è¶…å¤§æ–‡ä»¶è€—å°½æœåŠ¡å™¨èµ„æºï¼Œå°±åƒç”µæ¢¯é™é‡ä¿æŠ¤è®¾å¤‡ä¸€æ ·ã€‚

### 7.2 åŸºç¡€ä¸Šä¼ é™åˆ¶


**ğŸ”§ Nginxä¸Šä¼ é…ç½®ï¼š**
```nginx
http {
    # å…¨å±€ä¸Šä¼ é™åˆ¶
    client_max_body_size 100M;    # æœ€å¤§æ–‡ä»¶100MB
    client_body_timeout 60s;       # ä¸Šä¼ è¶…æ—¶60ç§’
    client_body_buffer_size 128k;  # ä¸Šä¼ ç¼“å†²åŒº
}

server {
    # é’ˆå¯¹ä¸åŒè·¯å¾„çš„é™åˆ¶
    location /upload/images/ {
        client_max_body_size 10M;   # å›¾ç‰‡æœ€å¤§10MB
    }
    
    location /upload/videos/ {
        client_max_body_size 500M;  # è§†é¢‘æœ€å¤§500MB
        client_body_timeout 300s;   # å»¶é•¿è¶…æ—¶æ—¶é—´
    }
    
    # æ™®é€šè¡¨å•æäº¤
    location /forms/ {
        client_max_body_size 1M;    # è¡¨å•æ•°æ®æœ€å¤§1MB
    }
}
```

### 7.3 é«˜çº§ä¸Šä¼ æ§åˆ¶


**ğŸ¯ æ™ºèƒ½ä¸Šä¼ ç®¡ç†ï¼š**
```nginx
# åŸºäºç”¨æˆ·ç±»å‹çš„é™åˆ¶
map $http_user_type $upload_limit {
    default         1M;
    "premium"       50M;
    "enterprise"    200M;
}

server {
    location /upload/ {
        client_max_body_size $upload_limit;
        
        # é™åˆ¶ä¸Šä¼ é€Ÿåº¦ï¼ˆé˜²æ­¢å ç”¨è¿‡å¤šå¸¦å®½ï¼‰
        limit_rate_after 1M;
        limit_rate 100k;
    }
}

# ä¸Šä¼ è¿›åº¦æ”¯æŒ
location ^~ /upload_progress {
    upload_progress_json_output;
    report_uploads uploads;
}
```

**ğŸ“Š æ¨èä¸Šä¼ é™åˆ¶ï¼š**

| å†…å®¹ç±»å‹ | **å¤§å°é™åˆ¶** | **é€‚ç”¨åœºæ™¯** | **è¶…æ—¶æ—¶é—´** |
|---------|-------------|-------------|-------------|
| `å¤´åƒå›¾ç‰‡` | `2MB` | ç”¨æˆ·å¤´åƒ | `30s` |
| `æ–‡æ¡£æ–‡ä»¶` | `10MB` | PDFã€Word | `60s` |
| `éŸ³é¢‘æ–‡ä»¶` | `50MB` | éŸ³ä¹ã€å½•éŸ³ | `120s` |
| `è§†é¢‘æ–‡ä»¶` | `500MB` | çŸ­è§†é¢‘ | `300s` |

---

## 8. ğŸš€ CDNé›†æˆä¸æ€§èƒ½ä¼˜åŒ–


### 8.1 CDNå·¥ä½œåŸç†


**CDNï¼ˆå†…å®¹åˆ†å‘ç½‘ç»œï¼‰**å°±æ˜¯åœ¨å…¨å›½å„åœ°å»ºç«‹æ–‡ä»¶å‰¯æœ¬ï¼Œç”¨æˆ·è®¿é—®æ—¶ä»æœ€è¿‘çš„åœ°ç‚¹è·å–æ–‡ä»¶ï¼Œå°±åƒè¿é”è¶…å¸‚è®©ä½ å°±è¿‘è´­ç‰©ä¸€æ ·ã€‚

```
ä¼ ç»Ÿè®¿é—®ï¼š
åŒ—äº¬ç”¨æˆ· â†’ ä¸Šæµ·æœåŠ¡å™¨ (å»¶è¿Ÿé«˜)

CDNä¼˜åŒ–ï¼š
åŒ—äº¬ç”¨æˆ· â†’ åŒ—äº¬CDNèŠ‚ç‚¹ (å»¶è¿Ÿä½)
ä¸Šæµ·ç”¨æˆ· â†’ ä¸Šæµ·CDNèŠ‚ç‚¹ (å»¶è¿Ÿä½)
```

### 8.2 CDNé…ç½®ç­–ç•¥


**ğŸ”§ Nginx CDNé›†æˆï¼š**
```nginx
server {
    # é™æ€èµ„æºæŒ‡å‘CDN
    location ~* \.(css|js|png|jpg|gif)$ {
        # è®¾ç½®CDNå‹å¥½çš„ç¼“å­˜å¤´
        expires 1y;
        add_header Cache-Control "public, immutable";
        add_header Vary "Accept-Encoding";
        
        # å¦‚æœCDNå›æºï¼Œä¼˜åŒ–å“åº”
        add_header X-Cache "HIT from origin";
    }
    
    # åŠ¨æ€å†…å®¹å›æºé…ç½®
    location ~* \.(php|jsp|asp)$ {
        add_header X-Cache "MISS";
        expires -1;
    }
}

# CDNå›æºä¼˜åŒ–
upstream cdn_backend {
    server 127.0.0.1:8080;
    keepalive 32;
}

server {
    listen 8080;  # CDNå›æºç«¯å£
    
    location / {
        # é’ˆå¯¹CDNçš„ä¼˜åŒ–é…ç½®
        gzip_vary on;
        add_header X-Content-Type-Options nosniff;
    }
}
```

### 8.3 æ€§èƒ½ç›‘æ§é…ç½®


**ğŸ“Š æ€§èƒ½æŒ‡æ ‡æ”¶é›†ï¼š**
```nginx
# è®¿é—®æ—¥å¿—æ ¼å¼ä¼˜åŒ–
log_format cdn_log '$remote_addr - $remote_user [$time_local] '
                   '"$request" $status $body_bytes_sent '
                   '"$http_referer" "$http_user_agent" '
                   '$request_time $upstream_response_time';

server {
    access_log /var/log/nginx/cdn.log cdn_log;
    
    # æ€§èƒ½ç›‘æ§ç«¯ç‚¹
    location /nginx_status {
        stub_status on;
        allow 127.0.0.1;
        deny all;
    }
    
    # å®æ—¶å“åº”æ—¶é—´ç»Ÿè®¡
    location ~* \.(jpg|png|css|js)$ {
        add_header X-Response-Time $request_time;
        add_header X-Cache-Status $upstream_cache_status;
    }
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ é™æ€æ–‡ä»¶ç¼“å­˜ï¼šé€šè¿‡expireså’ŒCache-Controlå‡å°‘é‡å¤ä¼ è¾“
ğŸ”¸ æ–‡ä»¶å‹ç¼©ï¼šä½¿ç”¨gzip/brotliå¤§å¹…å‡å°‘ä¼ è¾“æ•°æ®é‡  
ğŸ”¸ MIMEç±»å‹ï¼šæ­£ç¡®è®¾ç½®æ–‡ä»¶ç±»å‹ç¡®ä¿æµè§ˆå™¨æ­£ç¡®å¤„ç†
ğŸ”¸ é˜²ç›—é“¾ï¼šä¿æŠ¤èµ„æºä¸è¢«æ¶æ„ç›—ç”¨
ğŸ”¸ ä¸Šä¼ é™åˆ¶ï¼šé˜²æ­¢èµ„æºæ»¥ç”¨å’ŒæœåŠ¡å™¨è¿‡è½½
ğŸ”¸ ç›®å½•å®‰å…¨ï¼šåˆç†é…ç½®ç›®å½•è®¿é—®æƒé™
ğŸ”¸ CDNé›†æˆï¼šåˆ©ç”¨åˆ†å¸ƒå¼ç½‘ç»œæå‡è®¿é—®é€Ÿåº¦
```

### 9.2 ä¼˜åŒ–ç­–ç•¥è¦ç‚¹


**ğŸ”¹ ç¼“å­˜ç­–ç•¥è®°å¿†ï¼š**
```
æ–‡ä»¶å˜æ›´é¢‘ç‡å†³å®šç¼“å­˜æ—¶é—´ï¼š
- åŸºæœ¬ä¸å˜ï¼šå­—ä½“æ–‡ä»¶ â†’ 1å¹´ç¼“å­˜
- å¶å°”æ›´æ–°ï¼šå›¾ç‰‡æ–‡ä»¶ â†’ 30å¤©ç¼“å­˜  
- ç»å¸¸æ›´æ–°ï¼šCSS/JS â†’ 7å¤©ç¼“å­˜
- å®æ—¶æ›´æ–°ï¼šHTML â†’ ä¸ç¼“å­˜
```

**ğŸ”¹ å‹ç¼©é…ç½®åŸåˆ™ï¼š**
```
å‹ç¼©æ”¶ç›Š = æ–‡ä»¶å¤§å° Ã— å‹ç¼©ç‡ - CPUæ¶ˆè€—
âœ… é€‚åˆå‹ç¼©ï¼šæ–‡æœ¬æ–‡ä»¶ã€CSSã€JSã€JSON
âŒ ä¸å»ºè®®å‹ç¼©ï¼šå›¾ç‰‡ã€è§†é¢‘ã€å·²å‹ç¼©æ–‡ä»¶
```

**ğŸ”¹ å®‰å…¨é˜²æŠ¤è¦ç‚¹ï¼š**
```
ğŸ›¡ï¸ é˜²ç›—é“¾ï¼šæ£€æŸ¥refereræ¥æº
ğŸ”’ ç›®å½•å®‰å…¨ï¼šç¦æ­¢æµè§ˆæ•æ„Ÿç›®å½•
ğŸ“¤ ä¸Šä¼ é™åˆ¶ï¼šé˜²æ­¢èµ„æºæ»¥ç”¨
ğŸš« æ–‡ä»¶è¿‡æ»¤ï¼šé˜»æ­¢å±é™©æ–‡ä»¶ç±»å‹
```

### 9.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–æ£€æŸ¥æ¸…å•ï¼š**
- âœ… é™æ€æ–‡ä»¶å¯ç”¨ç¼“å­˜å’Œå‹ç¼©
- âœ… æ­£ç¡®é…ç½®MIMEç±»å‹
- âœ… å®æ–½é˜²ç›—é“¾ä¿æŠ¤
- âœ… è®¾ç½®åˆç†çš„ä¸Šä¼ é™åˆ¶
- âœ… é…ç½®CDNåŠ é€Ÿ
- âœ… ç›‘æ§æ€§èƒ½æŒ‡æ ‡

**ğŸ¯ æ•…éšœæ’æŸ¥æ€è·¯ï¼š**
1. **ç¼“å­˜é—®é¢˜**ï¼šæ£€æŸ¥expiresè®¾ç½®å’Œæµè§ˆå™¨è¡Œä¸º
2. **å‹ç¼©å¤±æ•ˆ**ï¼šç¡®è®¤gzipé…ç½®å’Œæ–‡ä»¶ç±»å‹åŒ¹é…
3. **é˜²ç›—é“¾è¯¯æ€**ï¼šæ£€æŸ¥refererè§„åˆ™å’Œç™½åå•
4. **ä¸Šä¼ å¤±è´¥**ï¼šç¡®è®¤æ–‡ä»¶å¤§å°å’Œè¶…æ—¶è®¾ç½®
5. **è®¿é—®å¼‚å¸¸**ï¼šæ£€æŸ¥ç›®å½•æƒé™å’Œå®‰å…¨è§„åˆ™

**ğŸ’¡ å…³é”®ç†è§£**ï¼š
é™æ€æ–‡ä»¶ä¼˜åŒ–çš„æ ¸å¿ƒæ˜¯**å‡å°‘ä¼ è¾“é‡**å’Œ**æé«˜å“åº”é€Ÿåº¦**ã€‚é€šè¿‡åˆç†çš„ç¼“å­˜ã€å‹ç¼©ã€CDNé…ç½®ï¼Œå¯ä»¥å¤§å¹…æå‡ç”¨æˆ·ä½“éªŒï¼ŒåŒæ—¶å‡å°‘æœåŠ¡å™¨è´Ÿè½½å’Œå¸¦å®½æˆæœ¬ã€‚

**ğŸ§  è®°å¿†å£è¯€**ï¼š
- ç¼“å­˜å‡ä¼ è¾“ï¼Œå‹ç¼©çœå¸¦å®½
- é˜²ç›—ä¿èµ„æºï¼Œé™åˆ¶é˜²æ»¥ç”¨  
- MIMEè¯†æ–‡ä»¶ï¼ŒCDNé€Ÿåº¦å¿«
- å®‰å…¨ç¬¬ä¸€ä½ï¼Œæ€§èƒ½ç´§è·Ÿéš