---
title: 8ã€åå‘ä»£ç†é…ç½®å®æˆ˜
---
## ğŸ“š ç›®å½•

1. [åå‘ä»£ç†åŸºç¡€æ¦‚å¿µ](#1-åå‘ä»£ç†åŸºç¡€æ¦‚å¿µ)
2. [proxy_passåå‘ä»£ç†é…ç½®](#2-proxy_passåå‘ä»£ç†é…ç½®)
3. [ä¸Šæ¸¸æœåŠ¡å™¨é…ç½®ï¼ˆupstreamï¼‰](#3-ä¸Šæ¸¸æœåŠ¡å™¨é…ç½®upstream)
4. [è´Ÿè½½å‡è¡¡ç®—æ³•è¯¦è§£](#4-è´Ÿè½½å‡è¡¡ç®—æ³•è¯¦è§£)
5. [å¥åº·æ£€æŸ¥ä¸æ•…éšœè½¬ç§»](#5-å¥åº·æ£€æŸ¥ä¸æ•…éšœè½¬ç§»)
6. [ä»£ç†è¶…æ—¶ä¸è¯·æ±‚å¤´è®¾ç½®](#6-ä»£ç†è¶…æ—¶ä¸è¯·æ±‚å¤´è®¾ç½®)
7. [ä»£ç†ç¼“å­˜é…ç½®](#7-ä»£ç†ç¼“å­˜é…ç½®)
8. [Sessionä¿æŒç­–ç•¥](#8-sessionä¿æŒç­–ç•¥)
9. [å®æˆ˜é…ç½®æ¡ˆä¾‹](#9-å®æˆ˜é…ç½®æ¡ˆä¾‹)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”„ åå‘ä»£ç†åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯åå‘ä»£ç†


**é€šä¿—è§£é‡Š**ï¼šåå‘ä»£ç†å°±åƒé¤å…çš„æœåŠ¡å‘˜ï¼Œå®¢æˆ·ï¼ˆç”¨æˆ·ï¼‰ç‚¹èœæ—¶ä¸ç›´æ¥æ‰¾å¨å¸ˆï¼ˆåç«¯æœåŠ¡å™¨ï¼‰ï¼Œè€Œæ˜¯å‘Šè¯‰æœåŠ¡å‘˜ï¼ˆåå‘ä»£ç†ï¼‰ï¼ŒæœåŠ¡å‘˜å†å»å¨æˆ¿æ‹¿èœç»™å®¢æˆ·ã€‚

```
å®¢æˆ·ç«¯è§†è§’ï¼š
ç”¨æˆ· â†’ ç½‘ç«™ (åªçœ‹åˆ°ä¸€ä¸ªå…¥å£)

å®é™…æ¶æ„ï¼š
ç”¨æˆ· â†’ Nginxåå‘ä»£ç† â†’ å¤šä¸ªåç«¯æœåŠ¡å™¨
     â†—              â†—
   ç»Ÿä¸€å…¥å£        è´Ÿè½½åˆ†å‘
```

**åå‘ä»£ç† vs æ­£å‘ä»£ç†å¯¹æ¯”**ï¼š

| å¯¹æ¯”é¡¹ | **åå‘ä»£ç†** | **æ­£å‘ä»£ç†** |
|--------|-------------|-------------|
| **ä»£ç†å¯¹è±¡** | `ä»£ç†æœåŠ¡å™¨ï¼Œå¯¹å®¢æˆ·ç«¯é€æ˜` | `ä»£ç†å®¢æˆ·ç«¯ï¼Œå¯¹æœåŠ¡å™¨é€æ˜` |
| **ä½¿ç”¨åœºæ™¯** | `ç½‘ç«™è´Ÿè½½å‡è¡¡ã€ç¼“å­˜åŠ é€Ÿ` | `ç¿»å¢™ã€ä¼ä¸šä¸Šç½‘ç®¡ç†` |
| **å®¢æˆ·ç«¯æ„ŸçŸ¥** | `ä¸çŸ¥é“åç«¯çœŸå®æœåŠ¡å™¨` | `æ˜ç¡®çŸ¥é“åœ¨ä½¿ç”¨ä»£ç†` |

### 1.2 åå‘ä»£ç†çš„æ ¸å¿ƒä½œç”¨


**ğŸ¯ ä¸»è¦åŠŸèƒ½**ï¼š
- **è´Ÿè½½åˆ†å‘**ï¼šå°†è¯·æ±‚åˆ†æ•£åˆ°å¤šå°æœåŠ¡å™¨
- **æ•…éšœéš”ç¦»**ï¼šæŸå°æœåŠ¡å™¨æŒ‚äº†ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°å…¶ä»–æœåŠ¡å™¨
- **ç¼“å­˜åŠ é€Ÿ**ï¼šç¼“å­˜å¸¸ç”¨å†…å®¹ï¼Œå‡å°‘åç«¯å‹åŠ›
- **SSLç»ˆæ­¢**ï¼šåœ¨ä»£ç†å±‚å¤„ç†HTTPSï¼Œåç«¯å¯ä»¥ç”¨HTTP
- **å®‰å…¨é˜²æŠ¤**ï¼šéšè—åç«¯æœåŠ¡å™¨çœŸå®IP

---

## 2. ğŸ”§ proxy_passåå‘ä»£ç†é…ç½®


### 2.1 åŸºç¡€è¯­æ³•ç†è§£


**`proxy_pass`æŒ‡ä»¤**ï¼šå‘Šè¯‰Nginx"æŠŠè¿™ä¸ªè¯·æ±‚è½¬å‘ç»™è°"

```nginx
# åŸºç¡€è¯­æ³•
location /api/ {
    proxy_pass http://backend_server;
}
```

### 2.2 URLè·¯å¾„å¤„ç†è§„åˆ™


**é‡è¦æ¦‚å¿µ**ï¼š`proxy_pass`åé¢æœ‰æ²¡æœ‰æ–œæ (`/`)ï¼Œå¤„ç†æ–¹å¼å®Œå…¨ä¸åŒï¼

```nginx
# æƒ…å†µ1ï¼šproxy_pass åé¢æ²¡æœ‰è·¯å¾„
location /api/ {
    proxy_pass http://192.168.1.100:8080;
}
# è®¿é—® /api/users â†’ è½¬å‘åˆ° http://192.168.1.100:8080/api/users

# æƒ…å†µ2ï¼šproxy_pass åé¢æœ‰è·¯å¾„ï¼ˆæ³¨æ„ç»“å°¾çš„/ï¼‰
location /api/ {
    proxy_pass http://192.168.1.100:8080/;
}
# è®¿é—® /api/users â†’ è½¬å‘åˆ° http://192.168.1.100:8080/users

# æƒ…å†µ3ï¼šæ›¿æ¢è·¯å¾„
location /api/ {
    proxy_pass http://192.168.1.100:8080/v1/;
}
# è®¿é—® /api/users â†’ è½¬å‘åˆ° http://192.168.1.100:8080/v1/users
```

**è®°å¿†æŠ€å·§**ï¼š
- æ²¡æœ‰`/` = å®Œæ•´ä¿ç•™åŸè·¯å¾„
- æœ‰`/` = å»æ‰locationåŒ¹é…çš„éƒ¨åˆ†

### 2.3 å¸¸ç”¨é…ç½®ç¤ºä¾‹


```nginx
server {
    listen 80;
    server_name api.example.com;
    
    # APIæ¥å£ä»£ç†
    location /api/ {
        proxy_pass http://backend;
        
        # åŸºç¡€ä»£ç†è®¾ç½®ï¼ˆå¿…å¤‡ï¼‰
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
    
    # é™æ€æ–‡ä»¶ç›´æ¥å¤„ç†
    location /static/ {
        alias /var/www/static/;
        expires 7d;
    }
}
```

---

## 3. ğŸ—ï¸ ä¸Šæ¸¸æœåŠ¡å™¨é…ç½®ï¼ˆupstreamï¼‰


### 3.1 upstreamåŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯upstream**ï¼šå®šä¹‰ä¸€ç»„åç«¯æœåŠ¡å™¨ï¼Œå°±åƒå®šä¹‰ä¸€ä¸ª"æœåŠ¡å™¨å›¢é˜Ÿ"ï¼ŒNginxä¼šä»ä¸­é€‰æ‹©ä¸€å°æ¥å¤„ç†è¯·æ±‚ã€‚

```nginx
# å®šä¹‰æœåŠ¡å™¨ç»„
upstream backend {
    server 192.168.1.10:8080;
    server 192.168.1.11:8080;
    server 192.168.1.12:8080;
}

# ä½¿ç”¨æœåŠ¡å™¨ç»„
location / {
    proxy_pass http://backend;
}
```

### 3.2 æœåŠ¡å™¨å‚æ•°è¯¦è§£


```nginx
upstream api_servers {
    # åŸºæœ¬æœåŠ¡å™¨
    server 192.168.1.10:8080;
    
    # å¸¦æƒé‡çš„æœåŠ¡å™¨ï¼ˆå¤„ç†æ›´å¤šè¯·æ±‚ï¼‰
    server 192.168.1.11:8080 weight=3;
    
    # å¤‡ç”¨æœåŠ¡å™¨ï¼ˆåªæœ‰å…¶ä»–æœåŠ¡å™¨éƒ½æŒ‚äº†æ‰ç”¨ï¼‰
    server 192.168.1.12:8080 backup;
    
    # æ ‡è®°ä¸ºä¸‹çº¿çš„æœåŠ¡å™¨ï¼ˆä¸´æ—¶ä¸å‚ä¸è´Ÿè½½å‡è¡¡ï¼‰
    server 192.168.1.13:8080 down;
    
    # å¤±è´¥é‡è¯•é…ç½®
    server 192.168.1.14:8080 max_fails=3 fail_timeout=30s;
}
```

**å‚æ•°å«ä¹‰è§£é‡Š**ï¼š

| å‚æ•° | **å«ä¹‰** | **ç¤ºä¾‹** |
|------|----------|----------|
| `weight` | `æƒé‡ï¼Œæ•°å­—è¶Šå¤§åˆ†é…è¯·æ±‚è¶Šå¤š` | `weight=3ï¼ˆ3å€æµé‡ï¼‰` |
| `backup` | `å¤‡ç”¨æœåŠ¡å™¨ï¼Œä¸»æœåŠ¡å™¨éƒ½æŒ‚äº†æ‰å¯ç”¨` | `server 1.2.3.4 backup` |
| `down` | `æ ‡è®°æœåŠ¡å™¨ä¸‹çº¿ï¼Œä¸å‚ä¸è´Ÿè½½å‡è¡¡` | `server 1.2.3.4 down` |
| `max_fails` | `æœ€å¤§å¤±è´¥æ¬¡æ•°ï¼Œè¶…è¿‡åˆ™è®¤ä¸ºæœåŠ¡å™¨ä¸å¯ç”¨` | `max_fails=3` |
| `fail_timeout` | `å¤±è´¥åå¤šé•¿æ—¶é—´ä¸å†å°è¯•` | `fail_timeout=30s` |

### 3.3 upstreamé«˜çº§é…ç½®


```nginx
upstream web_backend {
    # ä¿æŒé•¿è¿æ¥ï¼ˆæé«˜æ€§èƒ½ï¼‰
    keepalive 32;
    
    # æœåŠ¡å™¨åˆ—è¡¨
    server 192.168.1.10:8080 weight=3 max_fails=2 fail_timeout=10s;
    server 192.168.1.11:8080 weight=1 max_fails=2 fail_timeout=10s;
    server 192.168.1.12:8080 backup;
}

server {
    location / {
        proxy_pass http://web_backend;
        
        # æ”¯æŒHTTP/1.1é•¿è¿æ¥
        proxy_http_version 1.1;
        proxy_set_header Connection "";
    }
}
```

---

## 4. âš–ï¸ è´Ÿè½½å‡è¡¡ç®—æ³•è¯¦è§£


### 4.1 è½®è¯¢ï¼ˆround-robinï¼‰- é»˜è®¤ç®—æ³•


**å·¥ä½œåŸç†**ï¼šä¾æ¬¡å°†è¯·æ±‚åˆ†é…ç»™æ¯ä¸ªæœåŠ¡å™¨ï¼Œå°±åƒæ’é˜Ÿä¹°ç¥¨ï¼Œä¸€ä¸ªä¸€ä¸ªæ¥ã€‚

```nginx
upstream backend {
    # é»˜è®¤è½®è¯¢ï¼Œä¸éœ€è¦ç‰¹æ®Šé…ç½®
    server 192.168.1.10:8080;
    server 192.168.1.11:8080;
    server 192.168.1.12:8080;
}

# è¯·æ±‚åˆ†é…æµç¨‹ï¼š
# è¯·æ±‚1 â†’ æœåŠ¡å™¨10
# è¯·æ±‚2 â†’ æœåŠ¡å™¨11  
# è¯·æ±‚3 â†’ æœåŠ¡å™¨12
# è¯·æ±‚4 â†’ æœåŠ¡å™¨10 (å¾ªç¯)
```

**é€‚ç”¨åœºæ™¯**ï¼šæœåŠ¡å™¨æ€§èƒ½ç›¸è¿‘ï¼Œç®€å•åº”ç”¨

### 4.2 åŠ æƒè½®è¯¢ï¼ˆweighted round-robinï¼‰


**å·¥ä½œåŸç†**ï¼šæ ¹æ®æƒé‡åˆ†é…è¯·æ±‚ï¼Œæ€§èƒ½å¥½çš„æœåŠ¡å™¨å¤„ç†æ›´å¤šè¯·æ±‚ã€‚

```nginx
upstream backend {
    server 192.168.1.10:8080 weight=3;  # å¤„ç†3ä¸ªè¯·æ±‚
    server 192.168.1.11:8080 weight=1;  # å¤„ç†1ä¸ªè¯·æ±‚
    server 192.168.1.12:8080 weight=1;  # å¤„ç†1ä¸ªè¯·æ±‚
}

# è¯·æ±‚åˆ†é…æµç¨‹ï¼ˆ5ä¸ªè¯·æ±‚çš„å¾ªç¯ï¼‰ï¼š
# è¯·æ±‚1-3 â†’ æœåŠ¡å™¨10 (æƒé‡3)
# è¯·æ±‚4   â†’ æœåŠ¡å™¨11 (æƒé‡1)  
# è¯·æ±‚5   â†’ æœåŠ¡å™¨12 (æƒé‡1)
```

**é€‚ç”¨åœºæ™¯**ï¼šæœåŠ¡å™¨æ€§èƒ½å·®å¼‚è¾ƒå¤§

### 4.3 IPå“ˆå¸Œï¼ˆip_hashï¼‰


**å·¥ä½œåŸç†**ï¼šæ ¹æ®å®¢æˆ·ç«¯IPè®¡ç®—å“ˆå¸Œå€¼ï¼Œç›¸åŒIPæ€»æ˜¯è®¿é—®åŒä¸€å°æœåŠ¡å™¨ã€‚

```nginx
upstream backend {
    ip_hash;  # å¯ç”¨IPå“ˆå¸Œ
    server 192.168.1.10:8080;
    server 192.168.1.11:8080;
    server 192.168.1.12:8080;
}

# å®¢æˆ·ç«¯IP 192.168.1.100 â†’ æ€»æ˜¯è®¿é—®æœåŠ¡å™¨10
# å®¢æˆ·ç«¯IP 192.168.1.101 â†’ æ€»æ˜¯è®¿é—®æœåŠ¡å™¨11
```

**é€‚ç”¨åœºæ™¯**ï¼šéœ€è¦ä¿æŒç”¨æˆ·ä¼šè¯çš„åº”ç”¨

**âš ï¸ æ³¨æ„äº‹é¡¹**ï¼š
- ä¸èƒ½ä¸`weight`å‚æ•°åŒæ—¶ä½¿ç”¨
- å¦‚æœæŸå°æœåŠ¡å™¨ä¸‹çº¿ï¼Œä¼šå½±å“éƒ¨åˆ†ç”¨æˆ·çš„ä¼šè¯

### 4.4 æœ€å°‘è¿æ¥ï¼ˆleast_connï¼‰


**å·¥ä½œåŸç†**ï¼šå°†è¯·æ±‚åˆ†é…ç»™å½“å‰è¿æ¥æ•°æœ€å°‘çš„æœåŠ¡å™¨ã€‚

```nginx
upstream backend {
    least_conn;  # å¯ç”¨æœ€å°‘è¿æ¥ç®—æ³•
    server 192.168.1.10:8080;
    server 192.168.1.11:8080;
    server 192.168.1.12:8080;
}

# åŠ¨æ€é€‰æ‹©ï¼š
# å¦‚æœæœåŠ¡å™¨10æœ‰5ä¸ªè¿æ¥ï¼ŒæœåŠ¡å™¨11æœ‰3ä¸ªè¿æ¥ï¼ŒæœåŠ¡å™¨12æœ‰4ä¸ªè¿æ¥
# æ–°è¯·æ±‚ä¼šè¢«åˆ†é…ç»™æœåŠ¡å™¨11ï¼ˆè¿æ¥æ•°æœ€å°‘ï¼‰
```

**é€‚ç”¨åœºæ™¯**ï¼šé•¿è¿æ¥åº”ç”¨ï¼Œè¯·æ±‚å¤„ç†æ—¶é—´å·®å¼‚è¾ƒå¤§

### 4.5 è´Ÿè½½å‡è¡¡ç®—æ³•å¯¹æ¯”


| ç®—æ³• | **ä¼˜ç‚¹** | **ç¼ºç‚¹** | **é€‚ç”¨åœºæ™¯** |
|------|----------|----------|-------------|
| **è½®è¯¢** | `ç®€å•ï¼Œåˆ†å¸ƒå‡åŒ€` | `ä¸è€ƒè™‘æœåŠ¡å™¨è´Ÿè½½` | `æœåŠ¡å™¨æ€§èƒ½ç›¸è¿‘` |
| **åŠ æƒè½®è¯¢** | `è€ƒè™‘æœåŠ¡å™¨æ€§èƒ½å·®å¼‚` | `ä¸è€ƒè™‘å®æ—¶è´Ÿè½½` | `æœåŠ¡å™¨æ€§èƒ½ä¸åŒ` |
| **IPå“ˆå¸Œ** | `ä¿æŒä¼šè¯ï¼Œä¸€è‡´æ€§å¥½` | `åˆ†å¸ƒå¯èƒ½ä¸å‡ï¼Œå•ç‚¹æ•…éšœå½±å“å¤§` | `éœ€è¦ä¼šè¯ä¿æŒ` |
| **æœ€å°‘è¿æ¥** | `è€ƒè™‘å®æ—¶è´Ÿè½½` | `è®¡ç®—å¼€é”€ç•¥å¤§` | `é•¿è¿æ¥ï¼Œå¤„ç†æ—¶é—´ä¸ä¸€` |

---

## 5. ğŸ¥ å¥åº·æ£€æŸ¥ä¸æ•…éšœè½¬ç§»


### 5.1 è¢«åŠ¨å¥åº·æ£€æŸ¥ï¼ˆNginxå¼€æºç‰ˆï¼‰


**å·¥ä½œåŸç†**ï¼šé€šè¿‡ç›‘æ§æ­£å¸¸è¯·æ±‚çš„å“åº”æ¥åˆ¤æ–­æœåŠ¡å™¨æ˜¯å¦å¥åº·ã€‚

```nginx
upstream backend {
    server 192.168.1.10:8080 max_fails=3 fail_timeout=30s;
    server 192.168.1.11:8080 max_fails=3 fail_timeout=30s;
    server 192.168.1.12:8080 backup;
}

# å¥åº·æ£€æŸ¥é€»è¾‘ï¼š
# 1. å¦‚æœæœåŠ¡å™¨è¿ç»­3æ¬¡è¯·æ±‚å¤±è´¥ (max_fails=3)
# 2. æ ‡è®°ä¸ºä¸å¯ç”¨ï¼Œ30ç§’å†…ä¸å†è½¬å‘è¯·æ±‚ (fail_timeout=30s)
# 3. 30ç§’åè‡ªåŠ¨å°è¯•æ¢å¤
# 4. å¦‚æœæ‰€æœ‰ä¸»æœåŠ¡å™¨éƒ½ä¸å¯ç”¨ï¼Œå¯ç”¨backupæœåŠ¡å™¨
```

### 5.2 æ•…éšœè½¬ç§»é…ç½®


```nginx
upstream web_servers {
    server 192.168.1.10:8080 max_fails=2 fail_timeout=10s;
    server 192.168.1.11:8080 max_fails=2 fail_timeout=10s;
    server 192.168.1.12:8080 backup;  # å¤‡ç”¨æœåŠ¡å™¨
}

server {
    location / {
        proxy_pass http://web_servers;
        
        # æ•…éšœè½¬ç§»è®¾ç½®
        proxy_next_upstream error timeout invalid_header http_500 http_502 http_503;
        proxy_next_upstream_tries 2;      # æœ€å¤šå°è¯•2ä¸ªæœåŠ¡å™¨
        proxy_next_upstream_timeout 3s;   # æ•…éšœè½¬ç§»æ€»è¶…æ—¶æ—¶é—´
    }
}
```

**`proxy_next_upstream`å‚æ•°è¯´æ˜**ï¼š

| å‚æ•° | **å«ä¹‰** |
|------|----------|
| `error` | `ç½‘ç»œé”™è¯¯æ—¶è½¬ç§»åˆ°ä¸‹ä¸€ä¸ªæœåŠ¡å™¨` |
| `timeout` | `è¶…æ—¶æ—¶è½¬ç§»` |
| `http_500` | `æœåŠ¡å™¨å†…éƒ¨é”™è¯¯æ—¶è½¬ç§»` |
| `http_502` | `ç½‘å…³é”™è¯¯æ—¶è½¬ç§»` |
| `http_503` | `æœåŠ¡ä¸å¯ç”¨æ—¶è½¬ç§»` |

### 5.3 å¥åº·æ£€æŸ¥æœ€ä½³å®è·µ


```nginx
# ç”Ÿäº§ç¯å¢ƒæ¨èé…ç½®
upstream production_backend {
    # ä¸»æœåŠ¡å™¨ï¼šå¿«é€Ÿæ£€æµ‹æ•…éšœï¼Œå¿«é€Ÿæ¢å¤
    server 192.168.1.10:8080 max_fails=2 fail_timeout=5s weight=3;
    server 192.168.1.11:8080 max_fails=2 fail_timeout=5s weight=3;
    
    # å¤‡ç”¨æœåŠ¡å™¨ï¼šæ›´ä¸¥æ ¼çš„æ£€æŸ¥
    server 192.168.1.12:8080 backup max_fails=1 fail_timeout=10s;
}
```

---

## 6. â±ï¸ ä»£ç†è¶…æ—¶ä¸è¯·æ±‚å¤´è®¾ç½®


### 6.1 è¶…æ—¶å‚æ•°è¯¦è§£


**ä¸ºä»€ä¹ˆéœ€è¦è®¾ç½®è¶…æ—¶**ï¼šé˜²æ­¢æŸä¸ªæ…¢è¯·æ±‚æ‹–å®æ•´ä¸ªç³»ç»Ÿï¼Œå°±åƒè®¾ç½®"æœ€é•¿ç­‰å¾…æ—¶é—´"ã€‚

```nginx
location /api/ {
    proxy_pass http://backend;
    
    # è¿æ¥è¶…æ—¶ï¼šå»ºç«‹è¿æ¥çš„æœ€é•¿æ—¶é—´
    proxy_connect_timeout 5s;
    
    # å‘é€è¶…æ—¶ï¼šå‘é€è¯·æ±‚æ•°æ®çš„æœ€é•¿æ—¶é—´  
    proxy_send_timeout 10s;
    
    # è¯»å–è¶…æ—¶ï¼šç­‰å¾…å“åº”çš„æœ€é•¿æ—¶é—´
    proxy_read_timeout 30s;
}
```

**è¶…æ—¶å‚æ•°å¯¹æ¯”**ï¼š

| å‚æ•° | **ä½œç”¨é˜¶æ®µ** | **æ¨èå€¼** | **è¯´æ˜** |
|------|-------------|-----------|----------|
| `proxy_connect_timeout` | `å»ºç«‹TCPè¿æ¥` | `5-10s` | `ç½‘ç»œé—®é¢˜æ—¶å¿«é€Ÿå¤±è´¥` |
| `proxy_send_timeout` | `å‘é€è¯·æ±‚æ•°æ®` | `10-30s` | `ä¸Šä¼ å¤§æ–‡ä»¶æ—¶é€‚å½“è°ƒå¤§` |
| `proxy_read_timeout` | `ç­‰å¾…å“åº”æ•°æ®` | `30-60s` | `æ ¹æ®ä¸šåŠ¡å¤„ç†æ—¶é—´è°ƒæ•´` |

### 6.2 è¯·æ±‚å¤´è½¬å‘è®¾ç½®


**é‡è¦æ€§**ï¼šåç«¯æœåŠ¡å™¨éœ€è¦çŸ¥é“çœŸå®çš„å®¢æˆ·ç«¯ä¿¡æ¯ï¼Œä¸ç„¶æ‰€æœ‰è¯·æ±‚éƒ½åƒæ˜¯æ¥è‡ªNginxã€‚

```nginx
location / {
    proxy_pass http://backend;
    
    # å¿…å¤‡è¯·æ±‚å¤´è®¾ç½®
    proxy_set_header Host $host;                    # ä¿æŒåŸå§‹åŸŸå
    proxy_set_header X-Real-IP $remote_addr;       # çœŸå®å®¢æˆ·ç«¯IP
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;  # IPé“¾è·¯
    proxy_set_header X-Forwarded-Proto $scheme;    # åè®®ç±»å‹(http/https)
    
    # å¯é€‰è¯·æ±‚å¤´
    proxy_set_header X-Forwarded-Host $host;       # åŸå§‹ä¸»æœºå
    proxy_set_header X-Forwarded-Port $server_port; # åŸå§‹ç«¯å£
}
```

**è¯·æ±‚å¤´å«ä¹‰è§£é‡Š**ï¼š

```nginx
# å‡è®¾ç”¨æˆ·é€šè¿‡ https://api.example.com/users è®¿é—®

# Host: api.example.com
# â†‘ å‘Šè¯‰åç«¯ç”¨æˆ·è®¿é—®çš„æ˜¯å“ªä¸ªåŸŸå

# X-Real-IP: 203.0.113.100  
# â†‘ ç”¨æˆ·çœŸå®IPåœ°å€

# X-Forwarded-For: 203.0.113.100, 10.0.0.1
# â†‘ å®Œæ•´çš„IPä¼ é€’é“¾è·¯ï¼ˆç”¨æˆ·IP â†’ ä»£ç†IPï¼‰

# X-Forwarded-Proto: https
# â†‘ ç”¨æˆ·ä½¿ç”¨çš„åè®®ï¼Œåç«¯å¯æ®æ­¤ç”Ÿæˆæ­£ç¡®çš„è·³è½¬é“¾æ¥
```

### 6.3 å®Œæ•´çš„ä»£ç†é…ç½®ç¤ºä¾‹


```nginx
upstream app_backend {
    server 192.168.1.10:8080 weight=3;
    server 192.168.1.11:8080 weight=1;
    keepalive 16;
}

server {
    listen 80;
    server_name app.example.com;
    
    location / {
        proxy_pass http://app_backend;
        
        # è¶…æ—¶è®¾ç½®
        proxy_connect_timeout 5s;
        proxy_send_timeout 15s;
        proxy_read_timeout 30s;
        
        # è¯·æ±‚å¤´è®¾ç½®
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # HTTPç‰ˆæœ¬å’Œè¿æ¥è®¾ç½®
        proxy_http_version 1.1;
        proxy_set_header Connection "";
        
        # ç¼“å†²è®¾ç½®ï¼ˆæé«˜æ€§èƒ½ï¼‰
        proxy_buffering on;
        proxy_buffer_size 4k;
        proxy_buffers 8 4k;
    }
}
```

---

## 7. ğŸ’¾ ä»£ç†ç¼“å­˜é…ç½®


### 7.1 ç¼“å­˜åŸºæœ¬æ¦‚å¿µ


**ä»£ç†ç¼“å­˜çš„ä½œç”¨**ï¼šå°†åç«¯å“åº”ç¼“å­˜åœ¨Nginxä¸­ï¼Œä¸‹æ¬¡ç›¸åŒè¯·æ±‚ç›´æ¥è¿”å›ç¼“å­˜ï¼Œä¸éœ€è¦å†è®¿é—®åç«¯ã€‚

```
ç”¨æˆ·è¯·æ±‚æµç¨‹ï¼š
ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼šç”¨æˆ· â†’ Nginx â†’ åç«¯æœåŠ¡å™¨ â†’ ç¼“å­˜åˆ°Nginx â†’ è¿”å›ç”¨æˆ·
åç»­è¯·æ±‚ï¼šç”¨æˆ· â†’ Nginx (ç›´æ¥è¿”å›ç¼“å­˜) âœ“ å¿«é€Ÿå“åº”
```

### 7.2 ç¼“å­˜åŸºç¡€é…ç½®


```nginx
# åœ¨httpå—ä¸­å®šä¹‰ç¼“å­˜è·¯å¾„
http {
    # å®šä¹‰ç¼“å­˜å­˜å‚¨è·¯å¾„å’Œå‚æ•°
    proxy_cache_path /var/cache/nginx 
                     levels=1:2                    # ç›®å½•å±‚çº§
                     keys_zone=my_cache:10m        # ç¼“å­˜åŒºåç§°å’Œå¤§å°
                     max_size=1g                   # æœ€å¤§ç¼“å­˜å¤§å°
                     inactive=60m                  # ä¸æ´»è·ƒæ•°æ®è¿‡æœŸæ—¶é—´
                     use_temp_path=off;            # ä¸ä½¿ç”¨ä¸´æ—¶è·¯å¾„

    server {
        location /api/data/ {
            proxy_pass http://backend;
            
            # å¯ç”¨ç¼“å­˜
            proxy_cache my_cache;
            
            # ç¼“å­˜æœ‰æ•ˆæœŸ
            proxy_cache_valid 200 302 10m;    # æˆåŠŸå“åº”ç¼“å­˜10åˆ†é’Ÿ
            proxy_cache_valid 404 1m;         # 404é”™è¯¯ç¼“å­˜1åˆ†é’Ÿ
            
            # ç¼“å­˜é”®ï¼ˆå†³å®šä»€ä¹ˆç®—ä½œç›¸åŒè¯·æ±‚ï¼‰
            proxy_cache_key $scheme$proxy_host$request_uri;
        }
    }
}
```

### 7.3 ç¼“å­˜æ§åˆ¶ç­–ç•¥


```nginx
location /api/ {
    proxy_pass http://backend;
    proxy_cache my_cache;
    
    # ç¼“å­˜ç­–ç•¥æ§åˆ¶
    proxy_cache_valid 200 5m;
    proxy_cache_valid any 1m;
    
    # ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨ç¼“å­˜
    proxy_cache_use_stale error timeout updating http_500 http_502 http_503 http_504;
    
    # å¹¶å‘è¯·æ±‚åˆå¹¶ï¼ˆé˜²æ­¢ç¼“å­˜å‡»ç©¿ï¼‰
    proxy_cache_lock on;
    proxy_cache_lock_timeout 3s;
    
    # ç¼“å­˜çŠ¶æ€æ˜¾ç¤ºï¼ˆè°ƒè¯•ç”¨ï¼‰
    add_header X-Cache-Status $upstream_cache_status;
}
```

**ç¼“å­˜çŠ¶æ€å«ä¹‰**ï¼š

| çŠ¶æ€ | **å«ä¹‰** |
|------|----------|
| `HIT` | `ç¼“å­˜å‘½ä¸­ï¼Œç›´æ¥è¿”å›ç¼“å­˜å†…å®¹` |
| `MISS` | `ç¼“å­˜æœªå‘½ä¸­ï¼Œä»åç«¯è·å–` |
| `BYPASS` | `è·³è¿‡ç¼“å­˜ï¼Œç›´æ¥è®¿é—®åç«¯` |
| `EXPIRED` | `ç¼“å­˜è¿‡æœŸï¼Œéœ€è¦é‡æ–°è·å–` |
| `UPDATING` | `ç¼“å­˜æ­£åœ¨æ›´æ–°ä¸­` |

### 7.4 é€‰æ‹©æ€§ç¼“å­˜é…ç½®


```nginx
location /api/ {
    proxy_pass http://backend;
    proxy_cache my_cache;
    
    # åªç¼“å­˜GETå’ŒHEADè¯·æ±‚
    proxy_cache_methods GET HEAD;
    
    # æ ¹æ®å“åº”å¤´å†³å®šæ˜¯å¦ç¼“å­˜
    proxy_cache_bypass $http_pragma $http_authorization;
    
    # æ’é™¤æŸäº›è¯·æ±‚ä¸ç¼“å­˜
    set $no_cache 0;
    if ($request_uri ~* "/(admin|login)") {
        set $no_cache 1;
    }
    proxy_cache_bypass $no_cache;
    proxy_no_cache $no_cache;
}
```

---

## 8. ğŸ” Sessionä¿æŒç­–ç•¥


### 8.1 ä»€ä¹ˆæ˜¯Sessionä¿æŒ


**é—®é¢˜åœºæ™¯**ï¼šç”¨æˆ·ç™»å½•åï¼Œå¦‚æœä¸‹æ¬¡è¯·æ±‚è¢«åˆ†é…åˆ°ä¸åŒæœåŠ¡å™¨ï¼Œå¯èƒ½éœ€è¦é‡æ–°ç™»å½•ã€‚

```
é—®é¢˜ç¤ºä¾‹ï¼š
ç”¨æˆ·ç™»å½• â†’ æœåŠ¡å™¨A (ä¿å­˜session)
ç”¨æˆ·æ“ä½œ â†’ è´Ÿè½½å‡è¡¡ â†’ æœåŠ¡å™¨B (æ²¡æœ‰session) â†’ è¦æ±‚é‡æ–°ç™»å½• âŒ
```

### 8.2 IPå“ˆå¸Œæ–¹å¼


**å®ç°åŸç†**ï¼šç¡®ä¿åŒä¸€ç”¨æˆ·æ€»æ˜¯è®¿é—®åŒä¸€å°æœåŠ¡å™¨ã€‚

```nginx
upstream web_servers {
    ip_hash;  # åŸºäºIPçš„sessionä¿æŒ
    server 192.168.1.10:8080;
    server 192.168.1.11:8080;
    server 192.168.1.12:8080;
}

server {
    location / {
        proxy_pass http://web_servers;
    }
}
```

**ä¼˜ç¼ºç‚¹åˆ†æ**ï¼š

| ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|
| `ç®€å•æ˜“é…ç½®` | `æœåŠ¡å™¨ä¸‹çº¿å½±å“ç”¨æˆ·` |
| `æ— éœ€é¢å¤–å­˜å‚¨` | `è´Ÿè½½å¯èƒ½ä¸å‡è¡¡` |
| `æ€§èƒ½å¥½` | `NATç¯å¢ƒä¸‹å¤šç”¨æˆ·åŒIP` |

### 8.3 Cookieç²˜æ€§ä¼šè¯


**å®ç°æ€è·¯**ï¼šé€šè¿‡cookieæ ‡è¯†ç”¨æˆ·åº”è¯¥è®¿é—®å“ªå°æœåŠ¡å™¨ï¼ˆéœ€è¦Nginx Plusæˆ–ç¬¬ä¸‰æ–¹æ¨¡å—ï¼‰ã€‚

```nginx
# æ¦‚å¿µç¤ºä¾‹ï¼ˆéœ€è¦ç‰¹æ®Šæ¨¡å—æ”¯æŒï¼‰
upstream backend {
    server 192.168.1.10:8080 route=server1;
    server 192.168.1.11:8080 route=server2;
    sticky cookie srv_id expires=1h path=/;
}
```

### 8.4 Sessionå…±äº«æ–¹æ¡ˆï¼ˆæ¨èï¼‰


**æœ€ä½³å®è·µ**ï¼šè®©æ‰€æœ‰æœåŠ¡å™¨å…±äº«sessionæ•°æ®ï¼Œè¿™æ ·ç”¨æˆ·è®¿é—®ä»»ä½•æœåŠ¡å™¨éƒ½æœ‰sessionã€‚

```
Sessionå…±äº«æ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœåŠ¡å™¨A    â”‚    â”‚  æœåŠ¡å™¨B    â”‚    â”‚  æœåŠ¡å™¨C    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                   â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  Redis/æ•°æ®åº“   â”‚
                 â”‚   (å…±äº«session) â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é…ç½®ç¤ºä¾‹**ï¼ˆåº”ç”¨å±‚é¢ï¼‰ï¼š

```nginx
# Nginxé…ç½®ä¿æŒç®€å•çš„è½®è¯¢å³å¯
upstream app_servers {
    server 192.168.1.10:8080;
    server 192.168.1.11:8080;
    server 192.168.1.12:8080;
}

# åº”ç”¨ç¨‹åºé…ç½®sessionå­˜å‚¨åˆ°Redis
# è¿™æ ·ä»»ä½•æœåŠ¡å™¨éƒ½èƒ½è¯»å–åˆ°ç”¨æˆ·session
```

---

## 9. ğŸ› ï¸ å®æˆ˜é…ç½®æ¡ˆä¾‹


### 9.1 ç”µå•†ç½‘ç«™é…ç½®æ¡ˆä¾‹


```nginx
# ç”µå•†ç½‘ç«™åå‘ä»£ç†é…ç½®
upstream web_backend {
    least_conn;  # ä½¿ç”¨æœ€å°‘è¿æ¥ç®—æ³•
    server 192.168.1.10:8080 weight=3 max_fails=2 fail_timeout=10s;
    server 192.168.1.11:8080 weight=3 max_fails=2 fail_timeout=10s;
    server 192.168.1.12:8080 weight=1 max_fails=2 fail_timeout=10s;
    server 192.168.1.13:8080 backup;  # å¤‡ç”¨æœåŠ¡å™¨
    keepalive 32;
}

upstream api_backend {
    ip_hash;  # APIä½¿ç”¨ip_hashä¿æŒsession
    server 192.168.1.20:8080 max_fails=3 fail_timeout=30s;
    server 192.168.1.21:8080 max_fails=3 fail_timeout=30s;
    keepalive 16;
}

server {
    listen 80;
    server_name shop.example.com;
    
    # å•†å“å±•ç¤ºé¡µé¢ï¼ˆå¯ç¼“å­˜ï¼‰
    location /products/ {
        proxy_pass http://web_backend;
        proxy_cache my_cache;
        proxy_cache_valid 200 5m;
        proxy_cache_use_stale error timeout updating;
        
        # åŸºç¡€ä»£ç†è®¾ç½®
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
    
    # APIæ¥å£ï¼ˆéœ€è¦sessionä¿æŒï¼‰
    location /api/ {
        proxy_pass http://api_backend;
        
        # è¾ƒçŸ­çš„è¶…æ—¶æ—¶é—´
        proxy_connect_timeout 3s;
        proxy_send_timeout 10s;
        proxy_read_timeout 10s;
        
        # ä¸ç¼“å­˜APIå“åº”
        proxy_cache_bypass 1;
        proxy_no_cache 1;
        
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
    
    # é™æ€èµ„æºç›´æ¥å¤„ç†
    location /static/ {
        alias /var/www/static/;
        expires 30d;
        add_header Cache-Control "public, immutable";
    }
}
```

### 9.2 å¾®æœåŠ¡æ¶æ„é…ç½®æ¡ˆä¾‹


```nginx
# å¾®æœåŠ¡ç½‘å…³é…ç½®
upstream user_service {
    server 192.168.1.10:8080;
    server 192.168.1.11:8080;
}

upstream order_service {
    server 192.168.1.20:8080;
    server 192.168.1.21:8080;
}

upstream payment_service {
    server 192.168.1.30:8080;
    server 192.168.1.31:8080;
}

server {
    listen 80;
    server_name api.microservice.com;
    
    # ç”¨æˆ·æœåŠ¡
    location /api/users/ {
        proxy_pass http://user_service/;
        include /etc/nginx/proxy_params;  # å¼•ç”¨å…¬å…±é…ç½®
    }
    
    # è®¢å•æœåŠ¡
    location /api/orders/ {
        proxy_pass http://order_service/;
        include /etc/nginx/proxy_params;
    }
    
    # æ”¯ä»˜æœåŠ¡ï¼ˆæ›´ä¸¥æ ¼çš„è¶…æ—¶è®¾ç½®ï¼‰
    location /api/payments/ {
        proxy_pass http://payment_service/;
        proxy_connect_timeout 2s;
        proxy_send_timeout 5s;
        proxy_read_timeout 15s;
        include /etc/nginx/proxy_params;
    }
}
```

**å…¬å…±é…ç½®æ–‡ä»¶ `/etc/nginx/proxy_params`**ï¼š

```nginx
proxy_set_header Host $host;
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_set_header X-Forwarded-Proto $scheme;
proxy_set_header X-Forwarded-Host $host;
proxy_set_header X-Forwarded-Port $server_port;

proxy_connect_timeout 5s;
proxy_send_timeout 10s;
proxy_read_timeout 30s;

proxy_buffering on;
proxy_buffer_size 4k;
proxy_buffers 8 4k;
proxy_busy_buffers_size 8k;
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ åå‘ä»£ç†æœ¬è´¨ï¼šä»£ç†æœåŠ¡å™¨ï¼Œå¯¹å®¢æˆ·ç«¯é€æ˜ï¼Œç»Ÿä¸€å…¥å£åˆ†å‘è¯·æ±‚
ğŸ”¸ proxy_passç”¨æ³•ï¼šURLè·¯å¾„å¤„ç†è§„åˆ™ï¼Œæœ‰æ— æ–œæ å¤„ç†æ–¹å¼ä¸åŒ
ğŸ”¸ upstreamä½œç”¨ï¼šå®šä¹‰æœåŠ¡å™¨ç»„ï¼Œæ”¯æŒè´Ÿè½½å‡è¡¡å’Œæ•…éšœè½¬ç§»
ğŸ”¸ è´Ÿè½½å‡è¡¡ç®—æ³•ï¼šè½®è¯¢ã€åŠ æƒã€IPå“ˆå¸Œã€æœ€å°‘è¿æ¥å„æœ‰é€‚ç”¨åœºæ™¯
ğŸ”¸ å¥åº·æ£€æŸ¥ï¼šé€šè¿‡max_failså’Œfail_timeoutå®ç°æ•…éšœæ£€æµ‹
ğŸ”¸ è¶…æ—¶è®¾ç½®ï¼šè¿æ¥ã€å‘é€ã€è¯»å–ä¸‰ä¸ªé˜¶æ®µçš„è¶…æ—¶æ§åˆ¶
ğŸ”¸ è¯·æ±‚å¤´è½¬å‘ï¼šä¿æŒå®¢æˆ·ç«¯çœŸå®ä¿¡æ¯ï¼ŒHostã€X-Real-IPç­‰å¿…å¤‡
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ proxy_passè·¯å¾„å¤„ç†è®°å¿†æ³•**ï¼š
```
æ— æ–œæ ï¼šå®Œæ•´ä¿ç•™ location /api/ + proxy_pass http://backend
æœ‰æ–œæ ï¼šè·¯å¾„æ›¿æ¢ location /api/ + proxy_pass http://backend/
```

**ğŸ”¹ è´Ÿè½½å‡è¡¡ç®—æ³•é€‰æ‹©**ï¼š
```
æ€§èƒ½ç›¸è¿‘ â†’ è½®è¯¢
æ€§èƒ½å·®å¼‚ â†’ åŠ æƒè½®è¯¢  
éœ€è¦ä¼šè¯ â†’ IPå“ˆå¸Œ
é•¿è¿æ¥åº”ç”¨ â†’ æœ€å°‘è¿æ¥
```

**ğŸ”¹ æ•…éšœè½¬ç§»çš„é€»è¾‘**ï¼š
```
æ£€æµ‹æ•…éšœ â†’ æ ‡è®°ä¸å¯ç”¨ â†’ ç­‰å¾…æ¢å¤æ—¶é—´ â†’ é‡æ–°å°è¯•
å¤‡ç”¨æœåŠ¡å™¨åœ¨ä¸»æœåŠ¡å™¨éƒ½ä¸å¯ç”¨æ—¶å¯ç”¨
```

### 10.3 ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ


**ğŸ¯ é…ç½®å»ºè®®**ï¼š
- **è¶…æ—¶è®¾ç½®**ï¼šæ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹è°ƒæ•´ï¼ŒAPIæ¥å£è¾ƒçŸ­ï¼Œæ–‡ä»¶ä¸Šä¼ è¾ƒé•¿
- **å¥åº·æ£€æŸ¥**ï¼š`max_fails=2-3`ï¼Œ`fail_timeout=5-30s`
- **ç¼“å­˜ç­–ç•¥**ï¼šé™æ€å†…å®¹é•¿ç¼“å­˜ï¼ŒåŠ¨æ€å†…å®¹çŸ­ç¼“å­˜æˆ–ä¸ç¼“å­˜
- **ç›‘æ§æŒ‡æ ‡**ï¼šå“åº”æ—¶é—´ã€é”™è¯¯ç‡ã€ç¼“å­˜å‘½ä¸­ç‡

**ğŸ”§ è¿ç»´æŠ€å·§**ï¼š
- ä½¿ç”¨`backup`æœåŠ¡å™¨ä½œä¸ºåº”æ€¥
- é…ç½®ç¼“å­˜çŠ¶æ€å¤´ä¾¿äºè°ƒè¯•
- å®šæœŸæ£€æŸ¥upstreamæœåŠ¡å™¨çŠ¶æ€
- åˆç†è®¾ç½®ç¼“å­˜å¤§å°é¿å…ç£ç›˜å æ»¡

**âš ï¸ å¸¸è§é™·é˜±**ï¼š
- proxy_passè·¯å¾„é…ç½®é”™è¯¯å¯¼è‡´404
- å¿˜è®°è®¾ç½®è¯·æ±‚å¤´å¯¼è‡´åç«¯è·å–ä¸åˆ°çœŸå®IP
- ç¼“å­˜é…ç½®ä¸å½“å¯¼è‡´æ•°æ®ä¸ä¸€è‡´
- è¶…æ—¶è®¾ç½®è¿‡çŸ­å¯¼è‡´æ­£å¸¸è¯·æ±‚è¢«ä¸­æ–­

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- åå‘ä»£ç†åšä¸­ä»‹ï¼Œç»Ÿä¸€å…¥å£åˆ†è¯·æ±‚
- upstreamå®šä¹‰æœåŠ¡å™¨ç»„ï¼Œè´Ÿè½½å‡è¡¡æœ‰ç®—æ³•
- å¥åº·æ£€æŸ¥é˜²æ•…éšœï¼Œè¶…æ—¶è®¾ç½®è¦åˆç†
- è¯·æ±‚å¤´è½¬å‘å¾ˆé‡è¦ï¼Œç¼“å­˜ç­–ç•¥ææ€§èƒ½