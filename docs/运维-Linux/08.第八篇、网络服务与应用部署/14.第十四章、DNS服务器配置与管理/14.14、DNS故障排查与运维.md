---
title: 14、DNS故障排查与运维
---
## 📚 目录

1. [DNS故障排查基础](#1-DNS故障排查基础)
2. [dig命令故障诊断技巧](#2-dig命令故障诊断技巧)
3. [nslookup查询测试方法](#3-nslookup查询测试方法)
4. [域名解析链路追踪](#4-域名解析链路追踪)
5. [DNS服务器连通性测试](#5-DNS服务器连通性测试)
6. [配置文件语法检查](#6-配置文件语法检查)
7. [日志文件分析方法](#7-日志文件分析方法)
8. [常见DNS故障案例](#8-常见DNS故障案例)
9. [应急处理流程建立](#9-应急处理流程建立)
10. [核心要点总结](#10-核心要点总结)

---

## 1. 🔍 DNS故障排查基础


### 1.1 DNS故障的本质理解


**什么是DNS故障？**
简单说，就是域名无法正确解析成IP地址，导致用户无法访问网站或服务。

```
正常情况：
用户输入 www.example.com → DNS解析 → 192.168.1.100 → 成功访问

故障情况：
用户输入 www.example.com → DNS解析失败 → 无法获得IP → 访问失败
```

### 1.2 DNS故障的常见表现


| 故障现象 | 用户体验 | 可能原因 |
|---------|---------|---------|
| **域名无法解析** | 浏览器显示"找不到服务器" | DNS服务器宕机、配置错误 |
| **解析缓慢** | 网页打开很慢 | DNS服务器响应慢、网络延迟 |
| **解析到错误IP** | 访问到错误网站 | DNS记录被篡改、缓存污染 |
| **部分域名失效** | 某些子域名无法访问 | 区域文件配置错误 |

### 1.3 DNS故障排查的基本思路


```
故障排查流程：
┌─────────────┐
│  问题确认   │ ← 确认故障现象和影响范围
└─────────────┘
        ↓
┌─────────────┐
│  本地检查   │ ← 检查本地DNS配置和缓存
└─────────────┘
        ↓
┌─────────────┐
│  服务器检查 │ ← 检查DNS服务器状态和配置
└─────────────┘
        ↓
┌─────────────┐
│  网络检查   │ ← 检查网络连通性和路由
└─────────────┘
        ↓
┌─────────────┐
│  日志分析   │ ← 分析系统和DNS日志
└─────────────┘
```

---

## 2. 🔧 dig命令故障诊断技巧


### 2.1 dig命令基础用法


**dig是什么？**
dig（Domain Information Groper）是Linux系统中最强大的DNS查询工具，比nslookup更详细、更可靠。

```bash
# 基本语法
dig [选项] [域名] [记录类型] [@DNS服务器]
```

### 2.2 常用dig诊断命令


**基础查询命令**

```bash
# 查询A记录（最常用）
dig www.example.com

# 查询特定记录类型
dig www.example.com A       # A记录
dig example.com MX         # 邮件记录
dig example.com NS         # 域名服务器记录
dig www.example.com CNAME  # 别名记录

# 使用指定DNS服务器查询
dig @8.8.8.8 www.example.com
dig @114.114.114.114 www.example.com
```

### 2.3 dig高级诊断技巧


**追踪解析过程**

```bash
# 显示完整解析过程（最重要的诊断命令）
dig +trace www.example.com

# 输出解释：
# . 518400 IN NS 根服务器列表
# com. 172800 IN NS .com顶级域服务器
# example.com. 300 IN NS 权威DNS服务器
# www.example.com. 300 IN A 最终IP地址
```

**详细输出分析**

```bash
# 显示详细信息
dig +noall +answer www.example.com    # 只显示答案部分
dig +short www.example.com            # 只显示IP地址
dig +noall +authority example.com NS  # 只显示权威部分
```

### 2.4 dig故障诊断实例


**诊断域名无法解析**

```bash
# 第一步：基本查询
dig www.example.com

# 如果查询失败，检查不同DNS服务器
dig @8.8.8.8 www.example.com     # Google DNS
dig @1.1.1.1 www.example.com     # Cloudflare DNS
dig @114.114.114.114 www.example.com  # 国内DNS

# 第二步：追踪解析路径
dig +trace www.example.com

# 第三步：检查权威DNS服务器
dig @权威DNS服务器IP www.example.com
```

**输出结果分析**

```
; <<>> DiG 9.16.1 <<>> www.example.com
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 12345
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; QUESTION SECTION:
;www.example.com.		IN	A

;; ANSWER SECTION:
www.example.com.	300	IN	A	93.184.216.34

;; Query time: 50 msec
;; SERVER: 192.168.1.1#53(192.168.1.1)
;; WHEN: Wed Sep 17 15:30:00 CST 2025
;; MSG SIZE  rcvd: 60
```

**关键信息解读：**
- `status: NOERROR` → 解析成功
- `status: NXDOMAIN` → 域名不存在
- `status: SERVFAIL` → 服务器错误
- `Query time: 50 msec` → 响应时间
- `SERVER: 192.168.1.1` → 使用的DNS服务器

---

## 3. 🔍 nslookup查询测试方法


### 3.1 nslookup基础概念


**nslookup是什么？**
nslookup是一个交互式的DNS查询工具，虽然功能不如dig强大，但在Windows和一些旧系统中仍然常用。

### 3.2 nslookup基本用法


**命令行模式**

```bash
# 基本查询
nslookup www.example.com

# 指定DNS服务器
nslookup www.example.com 8.8.8.8

# 查询特定记录类型
nslookup -type=MX example.com
nslookup -type=NS example.com
```

**交互模式**

```bash
# 进入交互模式
nslookup

# 在交互模式中使用
> www.example.com
> set type=MX
> example.com
> server 8.8.8.8
> www.example.com
> exit
```

### 3.3 nslookup故障诊断应用


**常见故障检查步骤**

```bash
# 1. 检查基本解析
nslookup www.example.com

# 2. 测试不同DNS服务器
nslookup www.example.com 8.8.8.8
nslookup www.example.com 114.114.114.114

# 3. 检查反向解析
nslookup 93.184.216.34

# 4. 检查权威DNS服务器
nslookup -type=NS example.com
```

### 3.4 nslookup vs dig对比


| 特性 | **nslookup** | **dig** |
|------|-------------|---------|
| **详细程度** | 基础信息 | 详细信息 |
| **追踪功能** | 无 | 有+trace |
| **输出格式** | 简单易读 | 详细专业 |
| **平台支持** | Windows/Linux | 主要Linux |
| **推荐度** | ⭐⭐ | ⭐⭐⭐⭐⭐ |

---

## 4. 🌐 域名解析链路追踪


### 4.1 DNS解析链路原理


**解析链路是什么？**
当你输入一个域名时，DNS查询会经过多个层级的服务器，这个过程就是解析链路。

```
域名解析链路图：
客户端 → 本地DNS → 根服务器 → 顶级域服务器 → 权威DNS服务器

具体示例：查询 www.example.com
1. 客户端查询本地DNS缓存
2. 本地DNS服务器查询根服务器（.）
3. 根服务器返回.com域服务器地址
4. 查询.com域服务器
5. .com服务器返回example.com权威DNS地址
6. 查询example.com权威DNS
7. 返回www.example.com的IP地址
```

### 4.2 使用dig追踪完整链路


```bash
# 完整链路追踪命令
dig +trace www.example.com

# 输出分析示例：
# Step 1: 根服务器查询
.			518400	IN	NS	a.root-servers.net.

# Step 2: 顶级域查询
com.			172800	IN	NS	a.gtld-servers.net.

# Step 3: 权威DNS查询
example.com.		172800	IN	NS	ns1.example.com.

# Step 4: 最终解析
www.example.com.	300	IN	A	93.184.216.34
```

### 4.3 链路故障分析方法


**识别故障节点**

```bash
# 分步骤检查每个环节
# 1. 检查根服务器连通性
dig +trace +tries=1 +time=5 .

# 2. 检查顶级域服务器
dig @a.gtld-servers.net. example.com NS

# 3. 检查权威DNS服务器
dig @ns1.example.com. www.example.com

# 4. 比较不同路径
dig +trace www.example.com @8.8.8.8
dig +trace www.example.com @114.114.114.114
```

### 4.4 常见链路故障类型


**故障类型分析表**

| 故障位置 | 故障现象 | 可能原因 | 解决方法 |
|---------|---------|---------|---------|
| **本地DNS** | 所有域名都无法解析 | 本地DNS服务器故障 | 更换DNS服务器 |
| **根服务器** | 大范围解析失败 | 网络连接问题 | 检查网络连接 |
| **顶级域** | 特定后缀域名失败 | 顶级域服务器问题 | 等待恢复或使用备用DNS |
| **权威DNS** | 特定域名解析失败 | 域名服务器配置错误 | 联系域名提供商 |

---

## 5. 🔗 DNS服务器连通性测试


### 5.1 连通性测试的重要性


**为什么要测试连通性？**
DNS服务器可能配置正确，但网络不通，或者端口被封锁，导致无法提供服务。

### 5.2 基础连通性测试


**ping测试**

```bash
# 测试DNS服务器是否在线
ping 8.8.8.8
ping 114.114.114.114
ping ns1.example.com

# 输出分析：
# 64 bytes from 8.8.8.8: icmp_seq=1 ttl=117 time=20.1 ms
# → 服务器在线，网络延迟20.1毫秒
```

**telnet端口测试**

```bash
# 测试DNS端口（53）是否开放
telnet 8.8.8.8 53
telnet 114.114.114.114 53

# 成功连接显示：
# Connected to 8.8.8.8.
# Escape character is '^]'.

# 连接失败显示：
# telnet: Unable to connect to remote host: Connection refused
```

### 5.3 DNS服务响应测试


**测试DNS服务器响应**

```bash
# 使用nc（netcat）测试UDP 53端口
nc -u 8.8.8.8 53 < /dev/null

# 使用dig测试响应时间
dig @8.8.8.8 www.example.com | grep "Query time"

# 批量测试多个DNS服务器
for dns in 8.8.8.8 114.114.114.114 1.1.1.1; do
    echo "Testing $dns:"
    dig @$dns www.example.com +short +time=3
done
```

### 5.4 DNS服务器性能对比


**性能测试脚本示例**

```bash
#!/bin/bash
# DNS服务器性能测试

DNS_SERVERS=("8.8.8.8" "114.114.114.114" "1.1.1.1" "223.5.5.5")
TEST_DOMAIN="www.example.com"

echo "DNS服务器性能测试报告"
echo "=============================="

for dns in "${DNS_SERVERS[@]}"; do
    echo "测试服务器: $dns"
    
    # 执行5次查询并计算平均时间
    total_time=0
    for i in {1..5}; do
        time=$(dig @$dns $TEST_DOMAIN | grep "Query time" | awk '{print $4}')
        total_time=$((total_time + time))
    done
    
    avg_time=$((total_time / 5))
    echo "平均响应时间: ${avg_time}ms"
    echo "------------------------"
done
```

---

## 6. ⚙️ 配置文件语法检查


### 6.1 BIND配置文件检查


**named.conf语法检查**

```bash
# 检查主配置文件语法
named-checkconf /etc/named.conf

# 检查特定配置文件
named-checkconf /etc/named/named.conf.local

# 详细检查（显示所有警告）
named-checkconf -v /etc/named.conf
```

**区域文件语法检查**

```bash
# 检查区域文件语法
named-checkzone example.com /var/named/example.com.zone

# 检查反向解析区域文件
named-checkzone 1.168.192.in-addr.arpa /var/named/192.168.1.zone

# 输出示例：
# zone example.com/IN: loaded serial 2025091701
# OK
```

### 6.2 常见配置错误识别


**语法错误类型**

| 错误类型 | 错误示例 | 正确写法 | 影响 |
|---------|---------|---------|------|
| **缺少分号** | `zone "example.com"` | `zone "example.com";` | 配置不生效 |
| **括号不匹配** | `zone "example.com" {` | `zone "example.com" { };` | 服务启动失败 |
| **路径错误** | `file "example.zone"` | `file "/var/named/example.zone"` | 找不到文件 |
| **记录格式错误** | `www IN A 192.168.1.1.` | `www IN A 192.168.1.1` | 解析失败 |

### 6.3 配置检查工具使用


**完整检查流程**

```bash
# 1. 检查主配置文件
echo "检查named.conf语法..."
named-checkconf /etc/named.conf
if [ $? -eq 0 ]; then
    echo "✅ named.conf语法正确"
else
    echo "❌ named.conf语法错误"
    exit 1
fi

# 2. 检查所有区域文件
echo "检查区域文件..."
for zone_file in /var/named/*.zone; do
    zone_name=$(basename "$zone_file" .zone)
    echo "检查区域: $zone_name"
    named-checkzone "$zone_name" "$zone_file"
done

# 3. 测试配置重载
echo "测试配置重载..."
named-checkconf && systemctl reload named
```

---

## 7. 📋 日志文件分析方法


### 7.1 DNS日志基础概念


**DNS日志包含什么？**
DNS日志记录了所有DNS查询、错误信息、配置变更等重要信息，是故障排查的重要依据。

### 7.2 BIND日志配置与查看


**启用详细日志**

```bash
# 编辑named.conf，添加日志配置
logging {
    channel default_debug {
        file "/var/log/named/default.log" versions 3 size 5m;
        severity debug;
        print-time yes;
    };
    category default { default_debug; };
    category queries { default_debug; };
};
```

**查看日志文件**

```bash
# 实时查看DNS日志
tail -f /var/log/named/default.log

# 查看最近的错误
grep -i error /var/log/named/default.log | tail -20

# 查看特定域名的查询记录
grep "example.com" /var/log/named/default.log

# 分析查询统计
grep "query:" /var/log/named/default.log | awk '{print $NF}' | sort | uniq -c | sort -nr
```

### 7.3 系统日志分析


**systemd日志查看**

```bash
# 查看DNS服务日志
journalctl -u named -f

# 查看最近的错误信息
journalctl -u named --since "1 hour ago" -p err

# 查看启动相关日志
journalctl -u named --since "today" | grep -E "(start|stop|restart)"
```

### 7.4 日志分析实例


**常见日志信息解读**

```bash
# 正常查询日志
17-Sep-2025 15:30:01.123 queries: info: client 192.168.1.100#12345 (www.example.com): query: www.example.com IN A + (192.168.1.1)

# 解读：
# 时间: 17-Sep-2025 15:30:01.123
# 客户端: 192.168.1.100端口12345
# 查询域名: www.example.com
# 记录类型: A记录
# DNS服务器: 192.168.1.1
```

**错误日志分析**

```bash
# 配置错误日志
17-Sep-2025 15:30:01.123 general: error: zone example.com/IN: loading from master file example.com.zone failed: file not found

# NXDOMAIN响应日志
17-Sep-2025 15:30:01.123 queries: info: client 192.168.1.100#12345 (nonexistent.example.com): query: nonexistent.example.com IN A + (192.168.1.1)
17-Sep-2025 15:30:01.124 queries: info: client 192.168.1.100#12345 (nonexistent.example.com): query failed (NXDOMAIN) for nonexistent.example.com/IN/A at query.c:5952
```

---

## 8. 🚨 常见DNS故障案例


### 8.1 域名完全无法解析


**故障现象**
- 所有客户端都无法解析特定域名
- dig查询返回SERVFAIL或超时

**故障原因分析**

```bash
# 1. 检查权威DNS服务器状态
dig @ns1.example.com www.example.com

# 2. 检查区域文件是否存在
ls -la /var/named/example.com.zone

# 3. 检查区域文件权限
ls -la /var/named/example.com.zone
# 应该显示: -rw-r--r-- 1 named named
```

**解决步骤**

```bash
# Step 1: 检查并修复文件权限
chown named:named /var/named/example.com.zone
chmod 644 /var/named/example.com.zone

# Step 2: 检查配置文件语法
named-checkzone example.com /var/named/example.com.zone

# Step 3: 重载配置
systemctl reload named

# Step 4: 验证修复效果
dig @localhost www.example.com
```

### 8.2 DNS解析缓慢


**故障现象**
- 网页打开速度慢
- dig查询时间超过1000ms

**故障诊断**

```bash
# 1. 测试多个DNS服务器响应时间
for dns in 192.168.1.1 8.8.8.8 114.114.114.114; do
    echo "Testing $dns:"
    dig @$dns www.example.com | grep "Query time"
done

# 2. 检查DNS服务器负载
top -p $(pgrep named)

# 3. 检查网络延迟
ping -c 5 8.8.8.8
```

**优化方案**

```bash
# 1. 增加DNS缓存时间
# 在区域文件中设置更长的TTL
$TTL 86400    ; 24小时缓存

# 2. 使用更快的上游DNS服务器
# 修改/etc/named.conf
forwarders {
    1.1.1.1;        # Cloudflare
    8.8.8.8;        # Google
};

# 3. 启用查询缓存
# 在named.conf中添加
max-cache-size 256m;
```

### 8.3 部分记录解析失败


**故障现象**
- 主域名可以解析，子域名无法解析
- 某些记录类型查询失败

**故障分析实例**

```bash
# 检查不同记录类型
dig example.com A        # 主域名A记录
dig www.example.com A    # www子域名
dig mail.example.com A   # mail子域名
dig example.com MX       # 邮件记录

# 检查区域文件内容
cat /var/named/example.com.zone | grep -E "(www|mail)"
```

**常见配置错误**

```
错误示例：
www    IN  A  192.168.1.100.    ; 多了一个点
mail   IN  A  192.168.1.200     ; 缺少结尾点
ftp    IN  CNAME www.example.com ; CNAME目标应该是FQDN

正确写法：
www    IN  A     192.168.1.100
mail   IN  A     192.168.1.200
ftp    IN  CNAME www.example.com.
```

### 8.4 DNS缓存污染问题


**故障现象**
- 域名解析到错误的IP地址
- 不同客户端解析结果不一致

**清理缓存方法**

```bash
# 1. 清理系统DNS缓存
# Ubuntu/Debian
sudo systemctl restart systemd-resolved

# CentOS/RHEL
sudo systemctl restart NetworkManager

# 2. 清理浏览器DNS缓存
# Chrome: chrome://net-internals/#dns → Clear host cache

# 3. 清理DNS服务器缓存
rndc flush
# 或者重启DNS服务
systemctl restart named
```

---

## 9. 🛠️ 应急处理流程建立


### 9.1 DNS故障应急响应流程


**应急处理优先级**

```
Priority 1 (立即处理) - 影响全网:
├── 主DNS服务器完全宕机
├── 所有域名无法解析
└── 根域名服务器连接失败

Priority 2 (30分钟内) - 影响部分服务:
├── 特定域名解析失败
├── DNS响应缓慢
└── 部分记录类型失效

Priority 3 (2小时内) - 影响较小:
├── 个别子域名问题
├── 非关键服务域名
└── 日志记录异常
```

### 9.2 应急处理标准流程


**第一阶段：快速评估（5分钟内）**

```bash
#!/bin/bash
# DNS故障快速评估脚本

echo "=== DNS故障快速评估 ==="
echo "时间: $(date)"

# 1. 检查DNS服务状态
echo "1. 检查DNS服务状态:"
systemctl is-active named

# 2. 检查关键域名解析
echo "2. 检查关键域名:"
for domain in www.company.com mail.company.com api.company.com; do
    echo "检查 $domain:"
    dig +short +time=3 +tries=1 $domain || echo "解析失败"
done

# 3. 检查服务器资源
echo "3. 系统资源:"
echo "CPU: $(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1)%"
echo "内存: $(free | grep Mem | awk '{printf "%.1f%%", $3/$2 * 100.0}')"
echo "磁盘: $(df / | tail -1 | awk '{print $5}')"
```

**第二阶段：问题定位（15分钟内）**

```bash
# 1. 检查配置文件
named-checkconf /etc/named.conf
if [ $? -ne 0 ]; then
    echo "❌ 配置文件有语法错误"
    exit 1
fi

# 2. 检查关键区域文件
for zone in company.com internal.local; do
    named-checkzone $zone /var/named/$zone.zone
done

# 3. 分析最近的日志
echo "最近的错误日志:"
journalctl -u named --since "10 minutes ago" -p err
```

**第三阶段：临时修复（30分钟内）**

```bash
# 应急修复选项

# 选项1: 重启DNS服务
systemctl restart named
sleep 5
systemctl status named

# 选项2: 使用备用DNS配置
cp /etc/named.conf.backup /etc/named.conf
systemctl reload named

# 选项3: 启用DNS转发模式
cat >> /etc/named.conf << EOF
options {
    forwarders {
        8.8.8.8;
        114.114.114.114;
    };
    forward only;
};
EOF
systemctl reload named
```

### 9.3 预防性维护计划


**日常检查清单**

| 检查项目 | 频率 | 检查内容 | 自动化脚本 |
|---------|------|----------|-----------|
| **服务状态** | 每小时 | DNS进程是否运行 | ✅ |
| **解析测试** | 每15分钟 | 关键域名解析测试 | ✅ |
| **日志监控** | 实时 | 错误日志告警 | ✅ |
| **配置备份** | 每天 | 配置文件备份 | ✅ |
| **性能监控** | 每5分钟 | 响应时间监控 | ✅ |

**监控脚本示例**

```bash
#!/bin/bash
# DNS服务监控脚本 (/etc/cron.d/dns-monitor)

LOG_FILE="/var/log/dns-monitor.log"
ALERT_EMAIL="admin@company.com"

# 检查DNS服务状态
if ! systemctl is-active --quiet named; then
    echo "$(date): DNS服务异常" >> $LOG_FILE
    echo "DNS服务已停止" | mail -s "DNS告警" $ALERT_EMAIL
    systemctl start named
fi

# 检查关键域名解析
for domain in www.company.com api.company.com; do
    if ! dig +short +time=3 $domain > /dev/null; then
        echo "$(date): $domain 解析失败" >> $LOG_FILE
        echo "$domain 无法解析" | mail -s "DNS解析告警" $ALERT_EMAIL
    fi
done
```

### 9.4 故障恢复验证


**恢复后的验证步骤**

```bash
# 1. 基础服务验证
systemctl status named
ss -tulnp | grep :53

# 2. 解析功能验证
dig @localhost www.company.com
nslookup mail.company.com localhost

# 3. 外部验证
dig @8.8.8.8 www.company.com
dig @114.114.114.114 www.company.com

# 4. 性能验证
for i in {1..10}; do
    dig www.company.com | grep "Query time"
done | awk '{sum+=$4} END {print "平均响应时间:", sum/NR "ms"}'
```

---

## 10. 📋 核心要点总结


### 10.1 必须掌握的核心概念


```
🔸 DNS故障本质：域名无法正确解析为IP地址的问题
🔸 故障排查思路：问题确认 → 本地检查 → 服务器检查 → 网络检查 → 日志分析
🔸 主要诊断工具：dig（推荐）、nslookup、ping、telnet
🔸 关键检查点：DNS服务状态、配置文件语法、网络连通性、日志错误
🔸 应急处理：快速评估 → 问题定位 → 临时修复 → 恢复验证
```

### 10.2 关键理解要点


**🔹 故障排查的系统性思维**
```
层次化排查：
- 应用层：域名解析请求
- 服务层：DNS服务器配置和状态  
- 网络层：连通性和路由
- 系统层：资源和权限
```

**🔹 工具选择的实用原则**
```
日常检查：dig命令（功能最全面）
快速验证：nslookup（简单直观）
深度分析：dig +trace（完整链路）
性能测试：批量脚本（自动化监控）
```

**🔹 预防胜于治疗**
```
主动监控：
- 实时服务状态检查
- 关键域名解析测试
- 性能指标监控
- 日志异常告警

定期维护：
- 配置文件备份
- 语法检查验证
- 缓存清理优化
- 安全更新应用
```

### 10.3 实际应用价值


**🎯 运维工作中的应用**
- **故障响应**：快速定位DNS问题，减少业务中断时间
- **性能优化**：通过监控数据调优DNS配置，提升用户体验  
- **容量规划**：分析查询统计，合理配置DNS服务器资源
- **安全防护**：监控异常查询，及时发现安全威胁

**🔧 日常维护实践**
- **自动化监控**：部署监控脚本，实现7×24小时监控
- **标准化流程**：建立故障处理SOP，提高响应效率
- **知识积累**：记录故障案例，建立知识库
- **团队协作**：制定告警机制，确保及时响应

### 10.4 进阶学习建议


```
深入方向：
🔸 DNS安全：DNSSEC配置与管理
🔸 负载均衡：GeoDNS和智能解析
🔸 高可用：主从复制和故障切换
🔸 性能调优：缓存策略和并发优化
🔸 监控告警：Prometheus + Grafana DNS监控
```

**核心记忆口诀**：
- 故障排查分层次，工具使用要熟练
- dig命令是首选，trace追踪找问题  
- 配置检查语法先，日志分析找根因
- 应急处理要迅速，预防监控是关键