---
title: 2ã€BIND9æœåŠ¡å™¨å®‰è£…ä¸åŸºç¡€é…ç½®
---
## ğŸ“š ç›®å½•

1. [BIND9ç®€ä»‹ä¸ç‰ˆæœ¬é€‰æ‹©](#1-bind9ç®€ä»‹ä¸ç‰ˆæœ¬é€‰æ‹©)
2. [è½¯ä»¶åŒ…å®‰è£…ä¸ä¾èµ–ç®¡ç†](#2-è½¯ä»¶åŒ…å®‰è£…ä¸ä¾èµ–ç®¡ç†)
3. [named.confä¸»é…ç½®æ–‡ä»¶è¯¦è§£](#3-namedconfä¸»é…ç½®æ–‡ä»¶è¯¦è§£)
4. [å…¨å±€é…ç½®optionsæ®µè®¾ç½®](#4-å…¨å±€é…ç½®optionsæ®µè®¾ç½®)
5. [ç›‘å¬åœ°å€ä¸ç«¯å£é…ç½®](#5-ç›‘å¬åœ°å€ä¸ç«¯å£é…ç½®)
6. [chrootå®‰å…¨ç¯å¢ƒé…ç½®](#6-chrootå®‰å…¨ç¯å¢ƒé…ç½®)
7. [ç”¨æˆ·æƒé™ä¸æ–‡ä»¶ç®¡ç†](#7-ç”¨æˆ·æƒé™ä¸æ–‡ä»¶ç®¡ç†)
8. [æœåŠ¡å¯åŠ¨ä¸çŠ¶æ€ç®¡ç†](#8-æœåŠ¡å¯åŠ¨ä¸çŠ¶æ€ç®¡ç†)
9. [åŸºç¡€é…ç½®éªŒè¯ä¸æµ‹è¯•](#9-åŸºç¡€é…ç½®éªŒè¯ä¸æµ‹è¯•)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ BIND9ç®€ä»‹ä¸ç‰ˆæœ¬é€‰æ‹©


### 1.1 ä»€ä¹ˆæ˜¯BIND9


**æ ¸å¿ƒå®šä¹‰**
```
BIND9 = Berkeley Internet Name Domain version 9
ä½œç”¨ï¼šä¸–ç•Œä¸Šä½¿ç”¨æœ€å¹¿æ³›çš„DNSæœåŠ¡å™¨è½¯ä»¶
åœ°ä½ï¼šäº’è”ç½‘åŸºç¡€è®¾æ–½çš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€
å¼€å‘è€…ï¼šISC (Internet Systems Consortium)
```

BIND9å°±åƒäº’è”ç½‘ä¸–ç•Œçš„"ç”µè¯ç°¿ç®¡ç†å‘˜"ï¼Œè´Ÿè´£æŠŠæˆ‘ä»¬ç†Ÿæ‚‰çš„åŸŸåï¼ˆå¦‚www.example.comï¼‰ç¿»è¯‘æˆè®¡ç®—æœºèƒ½ç†è§£çš„IPåœ°å€ï¼ˆå¦‚192.168.1.1ï¼‰ã€‚

### 1.2 ç‰ˆæœ¬é€‰æ‹©ç­–ç•¥


**ğŸ”¸ ç¨³å®šç‰ˆæœ¬åˆ†æ”¯**
```
BIND 9.16.xç³»åˆ— (ESV - Extended Support Version)
â€¢ é•¿æœŸæ”¯æŒç‰ˆæœ¬ï¼Œæ¨èç”Ÿäº§ç¯å¢ƒä½¿ç”¨
â€¢ å®‰å…¨æ›´æ–°å‘¨æœŸï¼šè‡³å°‘5å¹´
â€¢ åŠŸèƒ½ç¨³å®šï¼Œå…¼å®¹æ€§å¥½

BIND 9.18.xç³»åˆ— (Current Stable)
â€¢ å½“å‰ç¨³å®šç‰ˆæœ¬
â€¢ æ–°åŠŸèƒ½è¾ƒå¤šï¼Œé€‚åˆæ–°éƒ¨ç½²ç¯å¢ƒ
â€¢ å®šæœŸå®‰å…¨æ›´æ–°

BIND 9.19.xç³»åˆ— (Development)
â€¢ å¼€å‘ç‰ˆæœ¬ï¼ŒåŒ…å«æœ€æ–°ç‰¹æ€§
â€¢ ä»…é€‚åˆæµ‹è¯•ç¯å¢ƒ
```

**ğŸ’¡ ç‰ˆæœ¬é€‰æ‹©å»ºè®®**
- **ç”Ÿäº§ç¯å¢ƒ**ï¼šä¼˜å…ˆé€‰æ‹©9.16.x ESVç‰ˆæœ¬
- **æ–°é¡¹ç›®**ï¼šå¯è€ƒè™‘9.18.xè·å¾—æ–°ç‰¹æ€§
- **æµ‹è¯•ç¯å¢ƒ**ï¼šå¯ä»¥å°è¯•æœ€æ–°ç‰ˆæœ¬

---

## 2. ğŸ“¦ è½¯ä»¶åŒ…å®‰è£…ä¸ä¾èµ–ç®¡ç†


### 2.1 ä¸»æµå‘è¡Œç‰ˆå®‰è£…æ–¹æ³•


**Ubuntu/Debianç³»ç»Ÿå®‰è£…**
```bash
# æ›´æ–°è½¯ä»¶åŒ…åˆ—è¡¨
sudo apt update

# å®‰è£…BIND9åŠç›¸å…³å·¥å…·
sudo apt install bind9 bind9utils bind9-doc

# å®‰è£…DNSæŸ¥è¯¢å·¥å…·
sudo apt install dnsutils
```

**CentOS/RHELç³»ç»Ÿå®‰è£…**
```bash
# å®‰è£…BIND9è½¯ä»¶åŒ…
sudo yum install bind bind-utils

# æˆ–è€…ä½¿ç”¨dnf (CentOS 8+)
sudo dnf install bind bind-utils
```

### 2.2 è½¯ä»¶åŒ…ç»„æˆè¯´æ˜


| è½¯ä»¶åŒ…åç§° | **ä½œç”¨è¯´æ˜** | **æ ¸å¿ƒæ–‡ä»¶** |
|-----------|-------------|-------------|
| `bind9/bind` | **DNSæœåŠ¡å™¨ä¸»ç¨‹åº** | `/usr/sbin/named` |
| `bind9utils/bind-utils` | **DNSç®¡ç†å·¥å…·é›†** | `dig`, `nslookup`, `host` |
| `bind9-doc` | **æ–‡æ¡£å’Œç¤ºä¾‹é…ç½®** | `/usr/share/doc/bind9/` |

### 2.3 ä¾èµ–å…³ç³»æ£€æŸ¥


```bash
# æ£€æŸ¥BIND9è½¯ä»¶åŒ…ä¾èµ–
apt-cache depends bind9

# éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸ
named -v
```

**å¸¸è§è¾“å‡ºç¤ºä¾‹**
```
BIND 9.16.1-Ubuntu (Stable Release) <id:d497c32>
running on Linux x86_64 4.15.0-96-generic
```

---

## 3. âš™ï¸ named.confä¸»é…ç½®æ–‡ä»¶è¯¦è§£


### 3.1 é…ç½®æ–‡ä»¶å±‚æ¬¡ç»“æ„


BIND9çš„é…ç½®å°±åƒä¸€æœ¬æœ‰åºçš„"ç®¡ç†æ‰‹å†Œ"ï¼Œåˆ†ä¸ºä¸åŒçš„ç« èŠ‚ï¼š

```
/etc/bind/named.conf (ä¸»é…ç½®æ–‡ä»¶)
â”œâ”€â”€ named.conf.options (å…¨å±€é€‰é¡¹)
â”œâ”€â”€ named.conf.local (æœ¬åœ°åŒºåŸŸå®šä¹‰)  
â”œâ”€â”€ named.conf.default-zones (é»˜è®¤åŒºåŸŸ)
â””â”€â”€ /var/cache/bind/ (åŒºåŸŸæ–‡ä»¶å­˜å‚¨ç›®å½•)
```

### 3.2 ä¸»é…ç½®æ–‡ä»¶ç»“æ„


**åŸºæœ¬çš„named.confç»“æ„**
```nginx
// åŒ…å«å…¶ä»–é…ç½®æ–‡ä»¶
include "/etc/bind/named.conf.options";
include "/etc/bind/named.conf.local";
include "/etc/bind/named.conf.default-zones";

// æ—¥å¿—é…ç½®
logging {
    channel default_debug {
        file "data/named.run";
        severity dynamic;
    };
};
```

### 3.3 é…ç½®è¯­æ³•è¦ç‚¹


**ğŸ”¸ è¯­æ³•è§„åˆ™**
```
â€¢ è¯­å¥ä»¥åˆ†å·(;)ç»“å°¾
â€¢ æ³¨é‡Šä½¿ç”¨ // æˆ– /* */ 
â€¢ å­—ç¬¦ä¸²ç”¨åŒå¼•å·åŒ…å›´
â€¢ å¤§æ‹¬å·{}åŒ…å›´é…ç½®å—
â€¢ é…ç½®å—å¯ä»¥åµŒå¥—
```

**è¯­æ³•ç¤ºä¾‹**
```nginx
// è¿™æ˜¯å•è¡Œæ³¨é‡Š
/* 
   è¿™æ˜¯å¤šè¡Œæ³¨é‡Š
   å¯ä»¥è·¨è¶Šå¤šè¡Œ
*/

options {
    directory "/var/cache/bind";  // å·¥ä½œç›®å½•
    listen-on { 127.0.0.1; };     // ç›‘å¬åœ°å€
};
```

---

## 4. ğŸ”§ å…¨å±€é…ç½®optionsæ®µè®¾ç½®


### 4.1 optionsé…ç½®æ®µçš„ä½œç”¨


optionsæ®µå°±åƒDNSæœåŠ¡å™¨çš„"æ€»ä½“è®¾ç½®"ï¼Œå®šä¹‰äº†æœåŠ¡å™¨çš„å…¨å±€è¡Œä¸ºè§„åˆ™ã€‚

### 4.2 æ ¸å¿ƒé…ç½®é€‰é¡¹è¯¦è§£


**åŸºç¡€é…ç½®ç¤ºä¾‹**
```nginx
options {
    // å·¥ä½œç›®å½•è®¾ç½®
    directory "/var/cache/bind";
    
    // ç›‘å¬è®¾ç½®
    listen-on port 53 { 127.0.0.1; 192.168.1.10; };
    listen-on-v6 { ::1; };
    
    // æŸ¥è¯¢æ§åˆ¶
    allow-query { localhost; 192.168.1.0/24; };
    allow-recursion { localhost; 192.168.1.0/24; };
    
    // é€’å½’æŸ¥è¯¢è®¾ç½®
    recursion yes;
    
    // è½¬å‘è®¾ç½®
    forwarders {
        8.8.8.8;
        8.8.4.4;
    };
    
    // å®‰å…¨è®¾ç½®
    version "DNS Server";
    hostname "ns1.example.com";
};
```

### 4.3 å…³é”®é…ç½®é¡¹è¯´æ˜


| é…ç½®é¡¹ | **ä½œç”¨è¯´æ˜** | **æ¨èè®¾ç½®** |
|--------|-------------|-------------|
| `directory` | **æŒ‡å®šå·¥ä½œç›®å½•** | `/var/cache/bind` |
| `listen-on` | **IPv4ç›‘å¬åœ°å€** | `{ any; }`æˆ–å…·ä½“IP |
| `allow-query` | **å…è®¸æŸ¥è¯¢çš„å®¢æˆ·ç«¯** | é™åˆ¶ä¸ºå†…ç½‘èŒƒå›´ |
| `recursion` | **æ˜¯å¦å…è®¸é€’å½’æŸ¥è¯¢** | å†…ç½‘yesï¼Œå…¬ç½‘no |
| `forwarders` | **ä¸Šçº§DNSæœåŠ¡å™¨** | å…¬å…±DNSæˆ–è¿è¥å•†DNS |

### 4.4 å®‰å…¨ç›¸å…³é…ç½®


**éšè—æœåŠ¡å™¨ä¿¡æ¯**
```nginx
options {
    // éšè—BINDç‰ˆæœ¬ä¿¡æ¯
    version "DNS Server";
    
    // éšè—ä¸»æœºå
    hostname "ns.domain.com";
    
    // ç¦ç”¨åŒºåŸŸä¼ è¾“ï¼ˆé»˜è®¤ï¼‰
    allow-transfer { none; };
    
    // é™åˆ¶é€’å½’æŸ¥è¯¢
    allow-recursion { localhost; 192.168.0.0/16; };
};
```

---

## 5. ğŸŒ ç›‘å¬åœ°å€ä¸ç«¯å£é…ç½®


### 5.1 ç›‘å¬åœ°å€çš„æ¦‚å¿µ


ç›‘å¬åœ°å€å°±æ˜¯å‘Šè¯‰BIND9ï¼š"ä½ è¦åœ¨å“ªäº›ç½‘ç»œæ¥å£ä¸Šæä¾›DNSæœåŠ¡"ã€‚

### 5.2 ç›‘å¬é…ç½®è¯¦è§£


**IPv4ç›‘å¬é…ç½®**
```nginx
// ç›‘å¬æ‰€æœ‰IPv4æ¥å£
listen-on port 53 { any; };

// ç›‘å¬ç‰¹å®šIPåœ°å€
listen-on port 53 { 
    127.0.0.1;      // æœ¬åœ°å›ç¯
    192.168.1.10;   // å†…ç½‘IP
    10.0.0.5;       // å¦ä¸€ä¸ªå†…ç½‘IP
};

// ç›‘å¬ç½‘æ®µ
listen-on port 53 { 
    192.168.1.0/24;  // æ•´ä¸ªCç±»ç½‘æ®µ
};
```

**IPv6ç›‘å¬é…ç½®**
```nginx
// å¯ç”¨IPv6ç›‘å¬
listen-on-v6 port 53 { 
    ::1;                    // IPv6æœ¬åœ°å›ç¯
    2001:db8::1;           // å…·ä½“IPv6åœ°å€
};

// ç¦ç”¨IPv6ï¼ˆå¦‚æœä¸éœ€è¦ï¼‰
listen-on-v6 { none; };
```

### 5.3 ç«¯å£é…ç½®è¯´æ˜


**é»˜è®¤ç«¯å£è®¾ç½®**
```nginx
// DNSæ ‡å‡†ç«¯å£53
listen-on port 53 { any; };

// è‡ªå®šä¹‰ç«¯å£ï¼ˆéæ ‡å‡†ï¼Œéœ€è¦å®¢æˆ·ç«¯æŒ‡å®šï¼‰
listen-on port 5353 { 127.0.0.1; };
```

**ğŸ”¸ ç«¯å£é€‰æ‹©åŸåˆ™**
- **æ ‡å‡†DNSæœåŠ¡**ï¼šå¿…é¡»ä½¿ç”¨53ç«¯å£
- **æµ‹è¯•ç¯å¢ƒ**ï¼šå¯ä»¥ä½¿ç”¨éæ ‡å‡†ç«¯å£
- **é˜²ç«å¢™å‹å¥½**ï¼š53ç«¯å£é€šå¸¸è¢«å…è®¸é€šè¿‡

### 5.4 ç½‘ç»œæ¥å£æ£€æŸ¥


```bash
# æŸ¥çœ‹å½“å‰ç½‘ç»œæ¥å£
ip addr show

# æ£€æŸ¥ç«¯å£å ç”¨æƒ…å†µ
sudo netstat -tulnp | grep :53

# æµ‹è¯•ç›‘å¬æ˜¯å¦æ­£å¸¸
sudo ss -tulnp | grep named
```

---

## 6. ğŸ”’ chrootå®‰å…¨ç¯å¢ƒé…ç½®


### 6.1 ä»€ä¹ˆæ˜¯chrootç›‘ç‹±


chrootå°±åƒç»™BIND9å»ºé€ ä¸€ä¸ª"å®‰å…¨ç›‘ç‹±"ï¼Œå³ä½¿æœåŠ¡è¢«å…¥ä¾µï¼Œæ”»å‡»è€…ä¹Ÿåªèƒ½çœ‹åˆ°ç›‘ç‹±å†…çš„æ–‡ä»¶ï¼Œæ— æ³•è®¿é—®æ•´ä¸ªç³»ç»Ÿã€‚

### 6.2 chrootç¯å¢ƒè®¾ç½®


**Ubuntu/Debian chrooté…ç½®**
```bash
# ç¼–è¾‘é»˜è®¤é…ç½®æ–‡ä»¶
sudo nano /etc/default/bind9

# å¯ç”¨chrootæ¨¡å¼
OPTIONS="-u bind -4 -t /var/bind9/chroot"
```

**åˆ›å»ºchrootç›®å½•ç»“æ„**
```bash
# åˆ›å»ºchrootæ ¹ç›®å½•
sudo mkdir -p /var/bind9/chroot

# åˆ›å»ºå¿…è¦çš„å­ç›®å½•
sudo mkdir -p /var/bind9/chroot/{etc,dev,var/cache/bind,var/run/bind/run}

# åˆ›å»ºè®¾å¤‡æ–‡ä»¶
sudo mknod /var/bind9/chroot/dev/null c 1 3
sudo mknod /var/bind9/chroot/dev/random c 1 8
```

### 6.3 chrootç¯å¢ƒæ–‡ä»¶å¤åˆ¶


```bash
# å¤åˆ¶é…ç½®æ–‡ä»¶åˆ°chrootç¯å¢ƒ
sudo cp /etc/bind/* /var/bind9/chroot/etc/
sudo cp /etc/localtime /var/bind9/chroot/etc/

# è®¾ç½®æ­£ç¡®çš„æƒé™
sudo chown -R bind:bind /var/bind9/chroot
sudo chmod 755 /var/bind9/chroot
```

### 6.4 chrooté…ç½®éªŒè¯


```bash
# å¯åŠ¨æœåŠ¡
sudo systemctl start bind9

# æ£€æŸ¥è¿›ç¨‹æ˜¯å¦åœ¨chrootç¯å¢ƒä¸­è¿è¡Œ
sudo ps aux | grep named
```

**æ­£å¸¸è¾“å‡ºç¤ºä¾‹**
```
bind     12345  0.0  0.2  named -u bind -4 -t /var/bind9/chroot
```

---

## 7. ğŸ‘¤ ç”¨æˆ·æƒé™ä¸æ–‡ä»¶ç®¡ç†


### 7.1 BIND9ç”¨æˆ·è´¦æˆ·


BIND9ä½¿ç”¨ä¸“é—¨çš„ç³»ç»Ÿç”¨æˆ·è¿è¡Œï¼Œè¿™æ˜¯å®‰å…¨æœ€ä½³å®è·µï¼š

```bash
# æŸ¥çœ‹bindç”¨æˆ·ä¿¡æ¯
id bind

# å…¸å‹è¾“å‡º
uid=104(bind) gid=108(bind) groups=108(bind)
```

### 7.2 å…³é”®ç›®å½•æƒé™è®¾ç½®


**æ ‡å‡†æƒé™é…ç½®**
```bash
# é…ç½®æ–‡ä»¶ç›®å½•æƒé™
sudo chown -R root:bind /etc/bind
sudo chmod 755 /etc/bind
sudo chmod 644 /etc/bind/*.conf

# æ•°æ®ç›®å½•æƒé™
sudo chown -R bind:bind /var/cache/bind
sudo chmod 755 /var/cache/bind

# æ—¥å¿—ç›®å½•æƒé™
sudo chown -R bind:bind /var/log/bind
sudo chmod 755 /var/log/bind
```

### 7.3 æ–‡ä»¶æ‰€æœ‰æƒæœ€ä½³å®è·µ


| ç›®å½•/æ–‡ä»¶ | **æ‰€æœ‰è€…** | **æƒé™** | **è¯´æ˜** |
|----------|----------|---------|---------|
| `/etc/bind/` | `root:bind` | `755` | **é…ç½®æ–‡ä»¶ç›®å½•** |
| `/var/cache/bind/` | `bind:bind` | `755` | **è¿è¡Œæ—¶æ•°æ®ç›®å½•** |
| `named.conf` | `root:bind` | `644` | **ä¸»é…ç½®æ–‡ä»¶** |
| `åŒºåŸŸæ–‡ä»¶` | `bind:bind` | `644` | **DNSåŒºåŸŸæ•°æ®** |

### 7.4 æƒé™é—®é¢˜æ’æŸ¥


```bash
# æ£€æŸ¥æ–‡ä»¶æƒé™
ls -la /etc/bind/
ls -la /var/cache/bind/

# ä¿®å¤å¸¸è§æƒé™é—®é¢˜
sudo chown bind:bind /var/cache/bind/*.db
sudo chmod 644 /var/cache/bind/*.db

# æ£€æŸ¥SELinuxçŠ¶æ€ï¼ˆå¦‚æœå¯ç”¨ï¼‰
sestatus
sudo setsebool -P named_write_master_zones 1
```

---

## 8. ğŸš€ æœåŠ¡å¯åŠ¨ä¸çŠ¶æ€ç®¡ç†


### 8.1 systemdæœåŠ¡ç®¡ç†


ç°ä»£Linuxç³»ç»Ÿä½¿ç”¨systemdç®¡ç†BIND9æœåŠ¡ï¼š

```bash
# å¯åŠ¨BIND9æœåŠ¡
sudo systemctl start bind9

# è®¾ç½®å¼€æœºè‡ªå¯åŠ¨
sudo systemctl enable bind9

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo systemctl status bind9

# é‡å¯æœåŠ¡
sudo systemctl restart bind9

# é‡æ–°åŠ è½½é…ç½®
sudo systemctl reload bind9
```

### 8.2 æœåŠ¡çŠ¶æ€æ£€æŸ¥


**æ£€æŸ¥æœåŠ¡è¿è¡ŒçŠ¶æ€**
```bash
# è¯¦ç»†çŠ¶æ€ä¿¡æ¯
sudo systemctl status bind9 -l

# æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯
ps aux | grep named

# æ£€æŸ¥ç›‘å¬ç«¯å£
sudo netstat -tulnp | grep :53
```

**æ­£å¸¸è¿è¡Œçš„çŠ¶æ€ç¤ºä¾‹**
```
â— bind9.service - BIND Domain Name Server
   Loaded: loaded (/lib/systemd/system/bind9.service; enabled)
   Active: active (running) since Mon 2024-01-15 10:30:00 UTC
   Main PID: 1234 (named)
```

### 8.3 é…ç½®æ–‡ä»¶è¯­æ³•æ£€æŸ¥


```bash
# æ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•
sudo named-checkconf /etc/bind/named.conf

# æ£€æŸ¥ç‰¹å®šåŒºåŸŸæ–‡ä»¶
sudo named-checkzone example.com /etc/bind/db.example.com

# å¦‚æœé…ç½®æ­£ç¡®ï¼Œå‘½ä»¤è¿”å›ç©ºè¾“å‡ºæˆ–OK
```

### 8.4 æœåŠ¡ç®¡ç†è„šæœ¬


**åˆ›å»ºä¾¿æ·ç®¡ç†è„šæœ¬**
```bash
#!/bin/bash
# BIND9æœåŠ¡ç®¡ç†è„šæœ¬

case "$1" in
    start)
        sudo systemctl start bind9
        echo "BIND9 æœåŠ¡å·²å¯åŠ¨"
        ;;
    stop)
        sudo systemctl stop bind9
        echo "BIND9 æœåŠ¡å·²åœæ­¢"
        ;;
    restart)
        sudo systemctl restart bind9
        echo "BIND9 æœåŠ¡å·²é‡å¯"
        ;;
    status)
        sudo systemctl status bind9
        ;;
    check)
        sudo named-checkconf
        echo "é…ç½®æ£€æŸ¥å®Œæˆ"
        ;;
    *)
        echo "ç”¨æ³•: $0 {start|stop|restart|status|check}"
        ;;
esac
```

---

## 9. âœ… åŸºç¡€é…ç½®éªŒè¯ä¸æµ‹è¯•


### 9.1 é…ç½®è¯­æ³•éªŒè¯


**ç¬¬ä¸€æ­¥ï¼šæ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•**
```bash
# æ£€æŸ¥ä¸»é…ç½®æ–‡ä»¶
sudo named-checkconf /etc/bind/named.conf

# å¦‚æœæœ‰é”™è¯¯ï¼Œä¼šæ˜¾ç¤ºå…·ä½“çš„é”™è¯¯ä¿¡æ¯
# å¦‚æœæ­£ç¡®ï¼Œä¸ä¼šæœ‰ä»»ä½•è¾“å‡º
```

### 9.2 æœåŠ¡å¯åŠ¨æµ‹è¯•


**ç¬¬äºŒæ­¥ï¼šå¯åŠ¨å¹¶éªŒè¯æœåŠ¡**
```bash
# å¯åŠ¨æœåŠ¡
sudo systemctl start bind9

# æ£€æŸ¥æ˜¯å¦æˆåŠŸå¯åŠ¨
sudo systemctl is-active bind9

# æŸ¥çœ‹è¯¦ç»†çŠ¶æ€
sudo systemctl status bind9
```

### 9.3 DNSæŸ¥è¯¢åŠŸèƒ½æµ‹è¯•


**ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•DNSè§£æåŠŸèƒ½**
```bash
# æµ‹è¯•æœ¬åœ°DNSæœåŠ¡å™¨
dig @127.0.0.1 google.com

# æµ‹è¯•é€’å½’æŸ¥è¯¢
nslookup www.example.com 127.0.0.1

# æµ‹è¯•åå‘è§£æ
dig @127.0.0.1 -x 8.8.8.8
```

### 9.4 ç½‘ç»œè¿æ¥æµ‹è¯•


**ç¬¬å››æ­¥ï¼šéªŒè¯ç½‘ç»œç›‘å¬**
```bash
# æ£€æŸ¥DNSç«¯å£ç›‘å¬
sudo ss -tulnp | grep :53

# åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
# udp  UNCONN 0  0  *:53  *:*  users:(("named",pid=1234,fd=21))
# tcp  LISTEN 0  10 *:53  *:*  users:(("named",pid=1234,fd=22))
```

### 9.5 æ—¥å¿—æ£€æŸ¥


**ç¬¬äº”æ­¥ï¼šæŸ¥çœ‹è¿è¡Œæ—¥å¿—**
```bash
# æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ä¸­çš„BINDç›¸å…³ä¿¡æ¯
sudo journalctl -u bind9 -f

# æŸ¥çœ‹BINDä¸“ç”¨æ—¥å¿—ï¼ˆå¦‚æœé…ç½®äº†ï¼‰
sudo tail -f /var/log/bind/named.log
```

**æ­£å¸¸å¯åŠ¨çš„æ—¥å¿—ç¤ºä¾‹**
```
Jan 15 10:30:00 server named[1234]: starting BIND 9.16.1-Ubuntu
Jan 15 10:30:00 server named[1234]: built with OpenSSL version: OpenSSL 1.1.1
Jan 15 10:30:00 server named[1234]: running
```

### 9.6 å®Œæ•´æµ‹è¯•æµç¨‹


```
é…ç½®éªŒè¯æµç¨‹å›¾ï¼š

é…ç½®æ–‡ä»¶è¯­æ³•æ£€æŸ¥ â”€â”
                  â”œâ”€â†’ å¯åŠ¨æœåŠ¡æµ‹è¯• â”€â”
ç½‘ç»œç›‘å¬éªŒè¯ â”€â”€â”€â”€â”€â”˜              â”œâ”€â†’ DNSåŠŸèƒ½éªŒè¯ â”€â†’ ç”Ÿäº§å°±ç»ª
                                  â”‚
æ—¥å¿—æ£€æŸ¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ BIND9æœ¬è´¨ï¼šä¸–ç•Œä¸Šæœ€å¹¿æ³›ä½¿ç”¨çš„DNSæœåŠ¡å™¨è½¯ä»¶
ğŸ”¸ é…ç½®æ–‡ä»¶ï¼šnamed.confæ˜¯æ ¸å¿ƒï¼ŒåŒ…å«å…¨å±€å’ŒåŒºåŸŸé…ç½®
ğŸ”¸ å·¥ä½œç›®å½•ï¼š/var/cache/bindå­˜æ”¾è¿è¡Œæ—¶æ•°æ®
ğŸ”¸ ç›‘å¬è®¾ç½®ï¼šæ§åˆ¶åœ¨å“ªäº›æ¥å£å’Œç«¯å£æä¾›DNSæœåŠ¡
ğŸ”¸ chrootç›‘ç‹±ï¼šæä¾›é¢å¤–çš„å®‰å…¨éš”ç¦»ä¿æŠ¤
```

### 10.2 å…³é”®é…ç½®è¦ç‚¹


**ğŸ”¹ å®‰è£…é…ç½®æµç¨‹**
```
è½¯ä»¶åŒ…å®‰è£… â†’ åŸºç¡€é…ç½® â†’ æƒé™è®¾ç½® â†’ æœåŠ¡å¯åŠ¨ â†’ åŠŸèƒ½æµ‹è¯•
```

**ğŸ”¹ å®‰å…¨é…ç½®åŸåˆ™**
```
â€¢ ä½¿ç”¨ä¸“ç”¨ç”¨æˆ·è¿è¡ŒæœåŠ¡
â€¢ æ­£ç¡®è®¾ç½®æ–‡ä»¶å’Œç›®å½•æƒé™
â€¢ è€ƒè™‘å¯ç”¨chrootç›‘ç‹±ç¯å¢ƒ
â€¢ éšè—æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯
â€¢ é™åˆ¶æŸ¥è¯¢å’Œé€’å½’è®¿é—®èŒƒå›´
```

**ğŸ”¹ é…ç½®æ–‡ä»¶ç»“æ„ç†è§£**
```
named.conf (ä¸»é…ç½®)
â”œâ”€â”€ optionsæ®µ (å…¨å±€è®¾ç½®)
â”œâ”€â”€ loggingæ®µ (æ—¥å¿—é…ç½®)
â”œâ”€â”€ zoneæ®µ (åŒºåŸŸå®šä¹‰)
â””â”€â”€ includeæŒ‡ä»¤ (åŒ…å«å…¶ä»–æ–‡ä»¶)
```

### 10.3 å®é™…åº”ç”¨ä»·å€¼


- **ä¼ä¸šå†…ç½‘DNS**ï¼šä¸ºå†…éƒ¨åŸŸåæä¾›è§£ææœåŠ¡
- **æƒå¨DNSæœåŠ¡å™¨**ï¼šæ‰˜ç®¡å…¬ç½‘åŸŸåçš„DNSè®°å½•
- **ç¼“å­˜DNSæœåŠ¡å™¨**ï¼šæé«˜DNSæŸ¥è¯¢æ€§èƒ½
- **æ™ºèƒ½DNSæœåŠ¡**ï¼šæ ¹æ®å®¢æˆ·ç«¯ä½ç½®è¿”å›ä¸åŒç»“æœ
- **DNSå®‰å…¨é˜²æŠ¤**ï¼šæŠµå¾¡DNSæ”»å‡»å’Œæ±¡æŸ“

### 10.4 å¸¸è§é—®é¢˜é¢„é˜²


**ğŸ”§ é…ç½®æ£€æŸ¥æ¸…å•**
- [ ] é…ç½®æ–‡ä»¶è¯­æ³•æ­£ç¡®
- [ ] ç›‘å¬åœ°å€è®¾ç½®åˆç†
- [ ] æ–‡ä»¶æƒé™é…ç½®æ­£ç¡®
- [ ] é˜²ç«å¢™è§„åˆ™å…è®¸53ç«¯å£
- [ ] æœåŠ¡èƒ½å¤Ÿæ­£å¸¸å¯åŠ¨
- [ ] DNSæŸ¥è¯¢åŠŸèƒ½æ­£å¸¸å·¥ä½œ

**ğŸš¨ æ•…éšœæ’æŸ¥è¦ç‚¹**
```
æœåŠ¡å¯åŠ¨å¤±è´¥ â†’ æ£€æŸ¥é…ç½®è¯­æ³•å’Œæƒé™
DNSæŸ¥è¯¢æ— å“åº” â†’ æ£€æŸ¥ç›‘å¬åœ°å€å’Œé˜²ç«å¢™
æƒé™é”™è¯¯ â†’ ç¡®è®¤bindç”¨æˆ·æƒé™è®¾ç½®
ç«¯å£å†²çª â†’ æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–æœåŠ¡å ç”¨53ç«¯å£
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- BIND9å®‰è£…é…ç½®æœ‰ç« æ³•ï¼Œè¯­æ³•æƒé™å¯åŠ¨è¦æ£€æŸ¥
- ç›‘å¬åœ°å€ç«¯å£è®¾å®šå¥½ï¼Œchrootç›‘ç‹±æ›´å®‰å…¨
- æµ‹è¯•éªŒè¯ä¸å¯å°‘ï¼Œæ—¥å¿—æ’é”™æ˜¯æ³•å®