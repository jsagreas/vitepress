---
title: 13ã€ä»£ç†æœåŠ¡å™¨æ•…éšœæŽ’æŸ¥
---
## ðŸ“š ç›®å½•

1. [ä»£ç†æœåŠ¡å™¨æ•…éšœæŽ’æŸ¥æ¦‚è¿°](#1-ä»£ç†æœåŠ¡å™¨æ•…éšœæŽ’æŸ¥æ¦‚è¿°)
2. [å¸¸è§æ•…éšœçŽ°è±¡è¯†åˆ«](#2-å¸¸è§æ•…éšœçŽ°è±¡è¯†åˆ«)
3. [è¿žæŽ¥è¶…æ—¶é—®é¢˜è¯Šæ–­](#3-è¿žæŽ¥è¶…æ—¶é—®é¢˜è¯Šæ–­)
4. [ç¼“å­˜å¤±æ•ˆé—®é¢˜æŽ’æŸ¥](#4-ç¼“å­˜å¤±æ•ˆé—®é¢˜æŽ’æŸ¥)
5. [æ€§èƒ½ç“¶é¢ˆå®šä½æ–¹æ³•](#5-æ€§èƒ½ç“¶é¢ˆå®šä½æ–¹æ³•)
6. [é…ç½®é”™è¯¯æŽ’æŸ¥æ­¥éª¤](#6-é…ç½®é”™è¯¯æŽ’æŸ¥æ­¥éª¤)
7. [ç½‘ç»œè¿žé€šæ€§æµ‹è¯•](#7-ç½‘ç»œè¿žé€šæ€§æµ‹è¯•)
8. [æ—¥å¿—åˆ†æžæŽ’é”™æŠ€å·§](#8-æ—¥å¿—åˆ†æžæŽ’é”™æŠ€å·§)
9. [ç³»ç»Ÿèµ„æºé—®é¢˜è¯Šæ–­](#9-ç³»ç»Ÿèµ„æºé—®é¢˜è¯Šæ–­)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ðŸ” ä»£ç†æœåŠ¡å™¨æ•…éšœæŽ’æŸ¥æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯ä»£ç†æœåŠ¡å™¨æ•…éšœæŽ’æŸ¥


**åŸºæœ¬æ¦‚å¿µ**ï¼šä»£ç†æœåŠ¡å™¨æ•…éšœæŽ’æŸ¥æ˜¯æŒ‡å½“ä»£ç†æœåŠ¡å‡ºçŽ°å¼‚å¸¸æ—¶ï¼Œé€šè¿‡ç³»ç»ŸåŒ–çš„æ–¹æ³•å¿«é€Ÿå®šä½é—®é¢˜æ ¹æºå¹¶è§£å†³çš„è¿‡ç¨‹ã€‚

```
ä»£ç†æœåŠ¡å™¨æ•…éšœæŽ’æŸ¥æµç¨‹ï¼š
å®¢æˆ·ç«¯è¯·æ±‚ â†’ ä»£ç†æœåŠ¡å™¨ â†’ åŽç«¯æœåŠ¡å™¨
     â†“           â†“           â†“
   é—®é¢˜çŽ°è±¡    æ•…éšœå®šä½    æ ¹å› åˆ†æž
     â†“           â†“           â†“
   æ”¶é›†ä¿¡æ¯    é€æ­¥æŽ’æŸ¥    åˆ¶å®šæ–¹æ¡ˆ
```

### 1.2 æ•…éšœæŽ’æŸ¥çš„é‡è¦æ€§


**ä¸šåŠ¡å½±å“**ï¼š
- **æœåŠ¡ä¸­æ–­**ï¼šä»£ç†æ•…éšœç›´æŽ¥å½±å“ç”¨æˆ·è®¿é—®
- **æ€§èƒ½ä¸‹é™**ï¼šç¼“æ…¢çš„å“åº”å½±å“ç”¨æˆ·ä½“éªŒ
- **æ•°æ®ä¸¢å¤±**ï¼šä¸å½“å¤„ç†å¯èƒ½å¯¼è‡´è¯·æ±‚ä¸¢å¤±
- **å®‰å…¨é£Žé™©**ï¼šé…ç½®é”™è¯¯å¯èƒ½æš´éœ²å®‰å…¨æ¼æ´ž

### 1.3 æŽ’æŸ¥åŽŸåˆ™ä¸Žæ–¹æ³•


**æŽ’æŸ¥åŽŸåˆ™**ï¼š
- ðŸŽ¯ **çŽ°è±¡å…ˆè¡Œ**ï¼šä»Žç”¨æˆ·åé¦ˆçš„çŽ°è±¡å¼€å§‹
- ðŸ”„ **ç”±å¤–åˆ°å†…**ï¼šä»Žå®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯é€å±‚æŽ’æŸ¥
- ðŸ“Š **æ•°æ®è¯´è¯**ï¼šç”¨æ—¥å¿—å’Œç›‘æŽ§æ•°æ®æ”¯æ’‘åˆ¤æ–­
- âš¡ **å¿«é€Ÿå®šä½**ï¼šä¼˜å…ˆæŽ’æŸ¥æœ€å¯èƒ½çš„åŽŸå› 

---

## 2. ðŸš¨ å¸¸è§æ•…éšœçŽ°è±¡è¯†åˆ«


### 2.1 æœåŠ¡ä¸å¯ç”¨çŽ°è±¡


**å®Œå…¨æ— æ³•è®¿é—®**ï¼š
- **çŽ°è±¡è¡¨çŽ°**ï¼šå®¢æˆ·ç«¯æ— æ³•è¿žæŽ¥åˆ°ä»£ç†æœåŠ¡å™¨
- **ç”¨æˆ·æ„Ÿå—**ï¼šé¡µé¢æ˜¾ç¤º"æ— æ³•è¿žæŽ¥"æˆ–"è¿žæŽ¥è¶…æ—¶"
- **å¯èƒ½åŽŸå› **ï¼šä»£ç†æœåŠ¡è¿›ç¨‹åœæ­¢ã€ç«¯å£æœªç›‘å¬ã€é˜²ç«å¢™é˜»æ–­

**é—´æ­‡æ€§æ•…éšœ**ï¼š
- **çŽ°è±¡è¡¨çŽ°**ï¼šæœ‰æ—¶èƒ½è®¿é—®ï¼Œæœ‰æ—¶è®¿é—®å¤±è´¥
- **ç”¨æˆ·æ„Ÿå—**ï¼šé¡µé¢å¶å°”åŠ è½½å¤±è´¥ï¼Œéœ€è¦åˆ·æ–°é‡è¯•
- **å¯èƒ½åŽŸå› **ï¼šè´Ÿè½½è¿‡é«˜ã€è¿žæŽ¥æ± è€—å°½ã€ç½‘ç»œä¸ç¨³å®š

### 2.2 æ€§èƒ½å¼‚å¸¸çŽ°è±¡


**å“åº”ç¼“æ…¢**ï¼š
- **çŽ°è±¡è¡¨çŽ°**ï¼šè¯·æ±‚èƒ½æˆåŠŸä½†å“åº”æ—¶é—´å¾ˆé•¿
- **ç”¨æˆ·æ„Ÿå—**ï¼šé¡µé¢åŠ è½½å¾ˆæ…¢ï¼Œéœ€è¦ç­‰å¾…å¾ˆä¹…
- **å¯èƒ½åŽŸå› **ï¼šåŽç«¯æœåŠ¡æ…¢ã€ç½‘ç»œå»¶è¿Ÿã€ç¼“å­˜å¤±æ•ˆ

**éƒ¨åˆ†åŠŸèƒ½å¼‚å¸¸**ï¼š
- **çŽ°è±¡è¡¨çŽ°**ï¼šæŸäº›URLæˆ–åŠŸèƒ½æ— æ³•æ­£å¸¸å·¥ä½œ
- **ç”¨æˆ·æ„Ÿå—**ï¼šç‰¹å®šæ“ä½œå¤±è´¥ï¼Œå…¶ä»–åŠŸèƒ½æ­£å¸¸
- **å¯èƒ½åŽŸå› **ï¼šç‰¹å®šè§„åˆ™é…ç½®é”™è¯¯ã€åŽç«¯éƒ¨åˆ†æœåŠ¡å¼‚å¸¸

### 2.3 ç¼“å­˜ç›¸å…³çŽ°è±¡


**ç¼“å­˜å‘½ä¸­çŽ‡ä½Ž**ï¼š
- **çŽ°è±¡è¡¨çŽ°**ï¼šå¤§é‡è¯·æ±‚ç›´æŽ¥è½¬å‘åˆ°åŽç«¯
- **å½±å“ç»“æžœ**ï¼šåŽç«¯è´Ÿè½½é«˜ï¼Œå“åº”æ—¶é—´é•¿
- **æ£€æŸ¥æ–¹æ³•**ï¼šæŸ¥çœ‹ä»£ç†æœåŠ¡å™¨ç¼“å­˜ç»Ÿè®¡

**ç¼“å­˜å†…å®¹é”™è¯¯**ï¼š
- **çŽ°è±¡è¡¨çŽ°**ï¼šè¿”å›žè¿‡æœŸæˆ–é”™è¯¯çš„å†…å®¹
- **ç”¨æˆ·æ„Ÿå—**ï¼šçœ‹åˆ°æ—§ç‰ˆæœ¬é¡µé¢æˆ–é”™è¯¯ä¿¡æ¯
- **æ£€æŸ¥æ–¹æ³•**ï¼šå¯¹æ¯”ç¼“å­˜å†…å®¹ä¸Žæºç«™å†…å®¹

### 2.4 æ•…éšœçŽ°è±¡è¯Šæ–­è¡¨


| çŽ°è±¡ç±»åž‹ | å…·ä½“è¡¨çŽ° | åˆæ­¥åˆ¤æ–­ | æ£€æŸ¥é‡ç‚¹ |
|---------|---------|---------|---------|
| **å®Œå…¨æ— æ³•è®¿é—®** | è¿žæŽ¥è¢«æ‹’ç» | æœåŠ¡æœªå¯åŠ¨ | è¿›ç¨‹çŠ¶æ€ã€ç«¯å£ç›‘å¬ |
| **è¿žæŽ¥è¶…æ—¶** | è¯·æ±‚é•¿æ—¶é—´æ— å“åº” | ç½‘ç»œæˆ–é…ç½®é—®é¢˜ | ç½‘ç»œè¿žé€šæ€§ã€è¶…æ—¶è®¾ç½® |
| **502é”™è¯¯** | ç½‘å…³é”™è¯¯ | åŽç«¯æœåŠ¡å¼‚å¸¸ | åŽç«¯æœåŠ¡çŠ¶æ€ |
| **503é”™è¯¯** | æœåŠ¡ä¸å¯ç”¨ | ä»£ç†æœåŠ¡è¿‡è½½ | æœåŠ¡å™¨èµ„æºã€è´Ÿè½½ |
| **å“åº”ç¼“æ…¢** | åŠ è½½æ—¶é—´è¿‡é•¿ | æ€§èƒ½ç“¶é¢ˆ | CPUã€å†…å­˜ã€ç½‘ç»œ |

---

## 3. â±ï¸ è¿žæŽ¥è¶…æ—¶é—®é¢˜è¯Šæ–­


### 3.1 è¶…æ—¶ç±»åž‹è¯†åˆ«


**å®¢æˆ·ç«¯åˆ°ä»£ç†è¶…æ—¶**ï¼š
```
å®¢æˆ·ç«¯ --X--> ä»£ç†æœåŠ¡å™¨
```
- **çŽ°è±¡**ï¼šå®¢æˆ·ç«¯æ˜¾ç¤ºè¿žæŽ¥è¶…æ—¶
- **åŽŸå› **ï¼šä»£ç†æœåŠ¡å™¨æ— å“åº”æˆ–ç½‘ç»œé—®é¢˜
- **æ£€æŸ¥**ï¼šä»£ç†æœåŠ¡å™¨çŠ¶æ€å’Œç½‘ç»œè¿žé€šæ€§

**ä»£ç†åˆ°åŽç«¯è¶…æ—¶**ï¼š
```
å®¢æˆ·ç«¯ --> ä»£ç†æœåŠ¡å™¨ --X--> åŽç«¯æœåŠ¡å™¨
```
- **çŽ°è±¡**ï¼šä»£ç†è¿”å›ž502æˆ–504é”™è¯¯
- **åŽŸå› **ï¼šåŽç«¯æœåŠ¡å“åº”æ…¢æˆ–ä¸å¯è¾¾
- **æ£€æŸ¥**ï¼šåŽç«¯æœåŠ¡çŠ¶æ€å’Œç½‘ç»œå»¶è¿Ÿ

### 3.2 è¶…æ—¶å‚æ•°æ£€æŸ¥


**Squidè¶…æ—¶é…ç½®æ£€æŸ¥**ï¼š
```bash
# æ£€æŸ¥Squidé…ç½®ä¸­çš„è¶…æ—¶è®¾ç½®
grep -E "(timeout|connect)" /etc/squid/squid.conf

# å¸¸è§è¶…æ—¶å‚æ•°
connect_timeout 30 seconds          # è¿žæŽ¥åŽç«¯è¶…æ—¶
read_timeout 3600 seconds          # è¯»å–æ•°æ®è¶…æ—¶
request_timeout 5 minutes          # è¯·æ±‚å¤„ç†è¶…æ—¶
```

**HAProxyè¶…æ—¶é…ç½®æ£€æŸ¥**ï¼š
```bash
# æ£€æŸ¥HAProxyè¶…æ—¶é…ç½®
grep -E "timeout" /etc/haproxy/haproxy.cfg

# å¸¸è§è¶…æ—¶å‚æ•°è¯´æ˜Ž
timeout connect 5000ms             # è¿žæŽ¥åŽç«¯è¶…æ—¶
timeout client 50000ms             # å®¢æˆ·ç«¯è¶…æ—¶
timeout server 50000ms             # æœåŠ¡å™¨å“åº”è¶…æ—¶
```

### 3.3 ç½‘ç»œå»¶è¿Ÿæµ‹è¯•


**æµ‹è¯•ç½‘ç»œè¿žé€šæ€§**ï¼š
```bash
# æµ‹è¯•ä»£ç†æœåŠ¡å™¨åˆ°åŽç«¯çš„ç½‘ç»œå»¶è¿Ÿ
ping backend-server.example.com

# æµ‹è¯•TCPè¿žæŽ¥å»ºç«‹æ—¶é—´
time telnet backend-server.example.com 80

# ä½¿ç”¨curlæµ‹è¯•å®Œæ•´è¯·æ±‚æ—¶é—´
curl -w "@curl-format.txt" http://backend-server.example.com/
```

**curlæ—¶é—´æ ¼å¼æ–‡ä»¶**ï¼š
```bash
# åˆ›å»ºcurlæ—¶é—´ç»Ÿè®¡æ ¼å¼æ–‡ä»¶
cat > curl-format.txt << EOF
    time_namelookup:  %{time_namelookup}\n
       time_connect:  %{time_connect}\n
    time_appconnect:  %{time_appconnect}\n
   time_pretransfer:  %{time_pretransfer}\n
      time_redirect:  %{time_redirect}\n
 time_starttransfer:  %{time_starttransfer}\n
                    ----------\n
         time_total:  %{time_total}\n
EOF
```

### 3.4 è¶…æ—¶é—®é¢˜è§£å†³æ–¹æ¡ˆ


> ðŸ’¡ **è§£å†³æ€è·¯**  
> æ ¹æ®æµ‹è¯•ç»“æžœè°ƒæ•´ç›¸åº”çš„è¶…æ—¶å‚æ•°ï¼Œç¡®ä¿è®¾ç½®åˆç†ä¸”ç¬¦åˆå®žé™…ç½‘ç»œçŽ¯å¢ƒ

**è°ƒä¼˜å»ºè®®**ï¼š
- âš¡ **è¿žæŽ¥è¶…æ—¶**ï¼šé€šå¸¸è®¾ç½®ä¸º5-30ç§’
- ðŸ“Š **è¯»å–è¶…æ—¶**ï¼šæ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹è®¾ç½®ï¼Œé€šå¸¸30ç§’åˆ°5åˆ†é’Ÿ
- ðŸ”„ **å®¢æˆ·ç«¯è¶…æ—¶**ï¼šåº”è¯¥å¤§äºŽæœåŠ¡å™¨å¤„ç†æ—¶é—´
- ðŸŽ¯ **åˆ†å±‚è®¾ç½®**ï¼šå®¢æˆ·ç«¯è¶…æ—¶ > ä»£ç†è¶…æ—¶ > åŽç«¯è¶…æ—¶

---

## 4. ðŸ—„ï¸ ç¼“å­˜å¤±æ•ˆé—®é¢˜æŽ’æŸ¥


### 4.1 ç¼“å­˜å·¥ä½œåŽŸç†


**ç¼“å­˜å‘½ä¸­æµç¨‹**ï¼š
```
å®¢æˆ·ç«¯è¯·æ±‚ â†’ ä»£ç†æ£€æŸ¥ç¼“å­˜ â†’ ç¼“å­˜å‘½ä¸­ï¼Ÿ
     â†“                           â†“
è¿”å›žç¼“å­˜å†…å®¹ â†â€” YES â†â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â”˜
     â†“                           â†“
     â””â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â†’ NO â†’ è¯·æ±‚åŽç«¯æœåŠ¡å™¨
                                    â†“
                               ç¼“å­˜å“åº”å¹¶è¿”å›žå®¢æˆ·ç«¯
```

### 4.2 ç¼“å­˜å¤±æ•ˆåŽŸå› åˆ†æž


**é…ç½®é—®é¢˜**ï¼š
- **ç¼“å­˜è§„åˆ™é”™è¯¯**ï¼šä¸è¯¥ç¼“å­˜çš„å†…å®¹è¢«ç¼“å­˜
- **TTLè®¾ç½®ä¸å½“**ï¼šç¼“å­˜æ—¶é—´è¿‡çŸ­å¯¼è‡´é¢‘ç¹å¤±æ•ˆ
- **ç¼“å­˜å¤§å°é™åˆ¶**ï¼šç¼“å­˜ç©ºé—´ä¸è¶³å¯¼è‡´é¢‘ç¹æ¸…ç†

**å†…å®¹é—®é¢˜**ï¼š
- **åŠ¨æ€å†…å®¹ç¼“å­˜**ï¼šåŠ¨æ€ç”Ÿæˆçš„å†…å®¹ä¸åº”è¯¥è¢«ç¼“å­˜
- **ä¸ªæ€§åŒ–å†…å®¹**ï¼šç”¨æˆ·ç›¸å…³çš„å†…å®¹è¢«é”™è¯¯ç¼“å­˜
- **Headersè®¾ç½®**ï¼šåŽç«¯è¿”å›žçš„ç¼“å­˜æŽ§åˆ¶å¤´ä¸æ­£ç¡®

### 4.3 Squidç¼“å­˜è¯Šæ–­


**æŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡**ï¼š
```bash
# æŸ¥çœ‹Squidç¼“å­˜ç»Ÿè®¡ä¿¡æ¯
squidclient -p 3128 mgr:info | grep -E "(Hit|Miss)"

# æŸ¥çœ‹è¯¦ç»†çš„ç¼“å­˜ç»Ÿè®¡
squidclient -p 3128 mgr:counters

# æŸ¥çœ‹ç¼“å­˜ç›®å½•ä½¿ç”¨æƒ…å†µ
squidclient -p 3128 mgr:storedir
```

**ç¼“å­˜è§„åˆ™æ£€æŸ¥**ï¼š
```bash
# æ£€æŸ¥ç¼“å­˜é…ç½®è§„åˆ™
grep -E "(cache_dir|cache_mem|cache)" /etc/squid/squid.conf

# å¸¸è§ç¼“å­˜é…ç½®ç¤ºä¾‹
cache_dir ufs /var/spool/squid 100 16 256
cache_mem 256 MB
maximum_object_size 50 MB
```

### 4.4 ç¼“å­˜æµ‹è¯•æ–¹æ³•


**æ‰‹åŠ¨æµ‹è¯•ç¼“å­˜**ï¼š
```bash
# ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼ˆåº”è¯¥æ˜¯MISSï¼‰
curl -I -H "Cache-Control: no-cache" http://proxy:3128/test.html

# ç¬¬äºŒæ¬¡è¯·æ±‚ï¼ˆåº”è¯¥æ˜¯HITï¼‰
curl -I http://proxy:3128/test.html

# æŸ¥çœ‹å“åº”å¤´ä¸­çš„ç¼“å­˜ä¿¡æ¯
# X-Cache: HIT è¡¨ç¤ºç¼“å­˜å‘½ä¸­
# X-Cache: MISS è¡¨ç¤ºç¼“å­˜æœªå‘½ä¸­
```

### 4.5 ç¼“å­˜ä¼˜åŒ–å»ºè®®


**é…ç½®ä¼˜åŒ–**ï¼š
- ðŸŽ¯ **åˆç†è®¾ç½®TTL**ï¼šæ ¹æ®å†…å®¹æ›´æ–°é¢‘çŽ‡è®¾ç½®ç¼“å­˜æ—¶é—´
- ðŸ“¦ **è°ƒæ•´ç¼“å­˜å¤§å°**ï¼šç¡®ä¿æœ‰è¶³å¤Ÿçš„ç¼“å­˜ç©ºé—´
- ðŸ” **ä¼˜åŒ–ç¼“å­˜è§„åˆ™**ï¼šç²¾ç¡®å®šä¹‰å“ªäº›å†…å®¹éœ€è¦ç¼“å­˜
- âš¡ **åŽ‹ç¼©ç¼“å­˜**ï¼šå¯ç”¨åŽ‹ç¼©å‡å°‘å­˜å‚¨ç©ºé—´

---

## 5. ðŸ“Š æ€§èƒ½ç“¶é¢ˆå®šä½æ–¹æ³•


### 5.1 æ€§èƒ½ç›‘æŽ§æŒ‡æ ‡


**å…³é”®æ€§èƒ½æŒ‡æ ‡**ï¼š
- **å“åº”æ—¶é—´**ï¼šè¯·æ±‚å¤„ç†çš„å¹³å‡æ—¶é—´
- **åžåé‡**ï¼šå•ä½æ—¶é—´å†…å¤„ç†çš„è¯·æ±‚æ•°é‡
- **å¹¶å‘è¿žæŽ¥æ•°**ï¼šåŒæ—¶å¤„ç†çš„è¿žæŽ¥æ•°é‡
- **é”™è¯¯çŽ‡**ï¼šå¤±è´¥è¯·æ±‚å æ€»è¯·æ±‚çš„æ¯”ä¾‹

**èµ„æºä½¿ç”¨æŒ‡æ ‡**ï¼š
- **CPUä½¿ç”¨çŽ‡**ï¼šå¤„ç†å™¨è´Ÿè½½æƒ…å†µ
- **å†…å­˜ä½¿ç”¨çŽ‡**ï¼šå†…å­˜å ç”¨æƒ…å†µ
- **ç½‘ç»œI/O**ï¼šç½‘ç»œæµé‡å’Œå»¶è¿Ÿ
- **ç£ç›˜I/O**ï¼šç£ç›˜è¯»å†™æ€§èƒ½

### 5.2 æ€§èƒ½ç›‘æŽ§å·¥å…·


**ç³»ç»Ÿçº§ç›‘æŽ§**ï¼š
```bash
# å®žæ—¶æŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½
top
htop

# æŸ¥çœ‹ç½‘ç»œè¿žæŽ¥çŠ¶æ€
netstat -ant | grep :3128

# æŸ¥çœ‹ç£ç›˜I/OçŠ¶æ€
iotop
iostat

# æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ
free -h
vmstat
```

**ä»£ç†æœåŠ¡å™¨ç›‘æŽ§**ï¼š
```bash
# Squidæ€§èƒ½ç»Ÿè®¡
squidclient -p 3128 mgr:info

# HAProxyç»Ÿè®¡é¡µé¢ï¼ˆå¦‚æžœå¯ç”¨ï¼‰
curl http://localhost:8080/haproxy?stats

# æŸ¥çœ‹è¿›ç¨‹èµ„æºä½¿ç”¨
ps aux | grep squid
pidstat -p $(pgrep squid)
```

### 5.3 æ€§èƒ½ç“¶é¢ˆåˆ†æž


**CPUç“¶é¢ˆè¯†åˆ«**ï¼š
- **çŽ°è±¡**ï¼šCPUä½¿ç”¨çŽ‡æŒç»­é«˜äºŽ80%
- **åŽŸå› **ï¼šå¤§é‡è®¡ç®—ã€SSLåŠ å¯†è§£å¯†ã€æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…
- **è§£å†³**ï¼šä¼˜åŒ–é…ç½®ã€å¢žåŠ CPUæ ¸å¿ƒã€è´Ÿè½½å‡è¡¡

**å†…å­˜ç“¶é¢ˆè¯†åˆ«**ï¼š
- **çŽ°è±¡**ï¼šå†…å­˜ä½¿ç”¨çŽ‡é«˜ï¼Œå‡ºçŽ°swap
- **åŽŸå› **ï¼šç¼“å­˜é…ç½®è¿‡å¤§ã€å†…å­˜æ³„æ¼
- **è§£å†³**ï¼šè°ƒæ•´ç¼“å­˜å¤§å°ã€å¢žåŠ å†…å­˜ã€æŸ¥æ‰¾å†…å­˜æ³„æ¼

**ç½‘ç»œç“¶é¢ˆè¯†åˆ«**ï¼š
- **çŽ°è±¡**ï¼šç½‘ç»œå»¶è¿Ÿé«˜ï¼Œä¸¢åŒ…çŽ‡é«˜
- **åŽŸå› **ï¼šå¸¦å®½ä¸è¶³ã€ç½‘ç»œæ‹¥å¡ž
- **è§£å†³**ï¼šå¢žåŠ å¸¦å®½ã€ä¼˜åŒ–ç½‘ç»œæ‹“æ‰‘ã€å¯ç”¨åŽ‹ç¼©

### 5.4 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


| ç“¶é¢ˆç±»åž‹ | ä¼˜åŒ–æ–¹æ³• | æ•ˆæžœè¯„ä¼° |
|---------|---------|---------|
| **CPUç“¶é¢ˆ** | å…³é—­ä¸å¿…è¦çš„æ—¥å¿—ã€ä¼˜åŒ–æ­£åˆ™è¡¨è¾¾å¼ | é™ä½ŽCPUä½¿ç”¨çŽ‡10-30% |
| **å†…å­˜ç“¶é¢ˆ** | è°ƒæ•´ç¼“å­˜å¤§å°ã€å¯ç”¨å†…å­˜åŽ‹ç¼© | å‡å°‘å†…å­˜ä½¿ç”¨20-40% |
| **ç½‘ç»œç“¶é¢ˆ** | å¯ç”¨åŽ‹ç¼©ã€ä¼˜åŒ–è¿žæŽ¥å¤ç”¨ | å‡å°‘å¸¦å®½ä½¿ç”¨30-50% |
| **ç£ç›˜ç“¶é¢ˆ** | ä½¿ç”¨SSDã€ä¼˜åŒ–ç¼“å­˜ç­–ç•¥ | æé«˜I/Oæ€§èƒ½2-5å€ |

---

## 6. âš™ï¸ é…ç½®é”™è¯¯æŽ’æŸ¥æ­¥éª¤


### 6.1 é…ç½®æ–‡ä»¶è¯­æ³•æ£€æŸ¥


**Squidé…ç½®æ£€æŸ¥**ï¼š
```bash
# æ£€æŸ¥Squidé…ç½®æ–‡ä»¶è¯­æ³•
squid -k parse
squid -k check

# å¦‚æžœæœ‰é”™è¯¯ï¼Œä¼šæ˜¾ç¤ºå…·ä½“çš„è¡Œå·å’Œé”™è¯¯ä¿¡æ¯
# ä¾‹å¦‚ï¼šERROR: Unknown directive 'cache_dirs'
```

**HAProxyé…ç½®æ£€æŸ¥**ï¼š
```bash
# æ£€æŸ¥HAProxyé…ç½®è¯­æ³•
haproxy -f /etc/haproxy/haproxy.cfg -c

# è¯¦ç»†æ£€æŸ¥æ¨¡å¼
haproxy -f /etc/haproxy/haproxy.cfg -c -V
```

### 6.2 å¸¸è§é…ç½®é”™è¯¯


**æƒé™é…ç½®é”™è¯¯**ï¼š
- **é”™è¯¯ç¤ºä¾‹**ï¼šç¼“å­˜ç›®å½•æƒé™ä¸æ­£ç¡®
- **æ£€æŸ¥æ–¹æ³•**ï¼šæŸ¥çœ‹ç¼“å­˜ç›®å½•çš„æ‰€æœ‰è€…å’Œæƒé™
- **è§£å†³æ–¹æ¡ˆ**ï¼š`chown -R squid:squid /var/spool/squid`

**ç«¯å£å†²çªé”™è¯¯**ï¼š
- **é”™è¯¯ç¤ºä¾‹**ï¼šå¤šä¸ªæœåŠ¡ç›‘å¬åŒä¸€ç«¯å£
- **æ£€æŸ¥æ–¹æ³•**ï¼š`netstat -tulpn | grep :3128`
- **è§£å†³æ–¹æ¡ˆ**ï¼šä¿®æ”¹é…ç½®ä½¿ç”¨ä¸åŒç«¯å£

**è·¯å¾„é…ç½®é”™è¯¯**ï¼š
- **é”™è¯¯ç¤ºä¾‹**ï¼šæ—¥å¿—æ–‡ä»¶è·¯å¾„ä¸å­˜åœ¨
- **æ£€æŸ¥æ–¹æ³•**ï¼šéªŒè¯é…ç½®ä¸­çš„æ‰€æœ‰è·¯å¾„æ˜¯å¦å­˜åœ¨
- **è§£å†³æ–¹æ¡ˆ**ï¼šåˆ›å»ºç›¸åº”ç›®å½•æˆ–ä¿®æ­£è·¯å¾„

### 6.3 é…ç½®éªŒè¯æ–¹æ³•


**é€æ­¥éªŒè¯æ³•**ï¼š
1. **å¤‡ä»½åŽŸé…ç½®**ï¼š`cp squid.conf squid.conf.backup`
2. **æœ€å°åŒ–é…ç½®**ï¼šä½¿ç”¨æœ€åŸºæœ¬çš„é…ç½®å¯åŠ¨æœåŠ¡
3. **é€æ­¥æ·»åŠ **ï¼šä¸€æ¬¡æ·»åŠ ä¸€ä¸ªé…ç½®é¡¹å¹¶æµ‹è¯•
4. **è®°å½•å˜åŒ–**ï¼šè®°å½•æ¯æ¬¡ä¿®æ”¹å’Œæµ‹è¯•ç»“æžœ

**å¯¹æ¯”éªŒè¯æ³•**ï¼š
```bash
# å¯¹æ¯”é…ç½®æ–‡ä»¶å·®å¼‚
diff squid.conf.working squid.conf.problematic

# æŸ¥çœ‹æœ€è¿‘çš„é…ç½®ä¿®æ”¹
ls -la /etc/squid/squid.conf*
```

### 6.4 é…ç½®æœ€ä½³å®žè·µ


> âš ï¸ **é…ç½®æ³¨æ„äº‹é¡¹**  
> ä¿®æ”¹é…ç½®å‰åŠ¡å¿…å¤‡ä»½ï¼Œæµ‹è¯•é…ç½®åŽå†é‡å¯æœåŠ¡

**é…ç½®ç®¡ç†å»ºè®®**ï¼š
- ðŸ“ **æ³¨é‡Šé…ç½®**ï¼šä¸ºé‡è¦é…ç½®æ·»åŠ è¯´æ˜Žæ³¨é‡Š
- ðŸ”„ **ç‰ˆæœ¬æŽ§åˆ¶**ï¼šä½¿ç”¨gitç®¡ç†é…ç½®æ–‡ä»¶å˜æ›´
- ðŸ§ª **æµ‹è¯•çŽ¯å¢ƒ**ï¼šåœ¨æµ‹è¯•çŽ¯å¢ƒéªŒè¯é…ç½®å†éƒ¨ç½²ç”Ÿäº§
- ðŸ“Š **ç›‘æŽ§å˜æ›´**ï¼šé…ç½®å˜æ›´åŽå¯†åˆ‡ç›‘æŽ§æœåŠ¡çŠ¶æ€

---

## 7. ðŸŒ ç½‘ç»œè¿žé€šæ€§æµ‹è¯•


### 7.1 åŸºç¡€è¿žé€šæ€§æµ‹è¯•


**Pingæµ‹è¯•**ï¼š
```bash
# æµ‹è¯•ä»£ç†æœåŠ¡å™¨ä¸ŽåŽç«¯æœåŠ¡å™¨çš„è¿žé€šæ€§
ping -c 4 backend-server.example.com

# æµ‹è¯•å®¢æˆ·ç«¯ä¸Žä»£ç†æœåŠ¡å™¨çš„è¿žé€šæ€§
ping -c 4 proxy-server.example.com
```

**ç«¯å£è¿žé€šæ€§æµ‹è¯•**ï¼š
```bash
# ä½¿ç”¨telnetæµ‹è¯•ç«¯å£è¿žé€šæ€§
telnet backend-server.example.com 80
telnet proxy-server.example.com 3128

# ä½¿ç”¨ncï¼ˆnetcatï¼‰æµ‹è¯•
nc -zv backend-server.example.com 80
nc -zv proxy-server.example.com 3128
```

### 7.2 DNSè§£æžæµ‹è¯•


**DNSæŸ¥è¯¢æµ‹è¯•**ï¼š
```bash
# æµ‹è¯•åŸŸåè§£æž
nslookup backend-server.example.com
dig backend-server.example.com

# æµ‹è¯•åå‘DNSè§£æž
nslookup 192.168.1.100
dig -x 192.168.1.100
```

**DNSè§£æžæ—¶é—´æµ‹è¯•**ï¼š
```bash
# æµ‹è¯•DNSè§£æžè€—æ—¶
time nslookup backend-server.example.com

# ä½¿ç”¨digæŸ¥çœ‹è¯¦ç»†è§£æžè¿‡ç¨‹
dig +trace backend-server.example.com
```

### 7.3 HTTPè¿žæŽ¥æµ‹è¯•


**åŸºç¡€HTTPæµ‹è¯•**ï¼š
```bash
# ç›´æŽ¥æµ‹è¯•åŽç«¯æœåŠ¡å™¨
curl -I http://backend-server.example.com/

# é€šè¿‡ä»£ç†æµ‹è¯•
curl -I --proxy http://proxy-server.example.com:3128 http://backend-server.example.com/

# æµ‹è¯•HTTPSè¿žæŽ¥
curl -I https://backend-server.example.com/
```

**è¯¦ç»†è¿žæŽ¥åˆ†æž**ï¼š
```bash
# æ˜¾ç¤ºè¯¦ç»†çš„è¿žæŽ¥è¿‡ç¨‹
curl -v http://backend-server.example.com/

# æ˜¾ç¤ºè¿žæŽ¥æ—¶é—´ç»Ÿè®¡
curl -w "@curl-format.txt" http://backend-server.example.com/
```

### 7.4 ç½‘ç»œè·¯ç”±æµ‹è¯•


**è·¯ç”±è·Ÿè¸ª**ï¼š
```bash
# è·Ÿè¸ªæ•°æ®åŒ…è·¯ç”±è·¯å¾„
traceroute backend-server.example.com
mtr backend-server.example.com

# æµ‹è¯•ç½‘ç»œå»¶è¿Ÿå˜åŒ–
ping -c 100 backend-server.example.com | tail -1
```

### 7.5 é˜²ç«å¢™å’Œå®‰å…¨ç»„æ£€æŸ¥


**é˜²ç«å¢™è§„åˆ™æ£€æŸ¥**ï¼š
```bash
# æ£€æŸ¥iptablesè§„åˆ™
iptables -L -n
iptables -L -n | grep 3128

# æ£€æŸ¥æœåŠ¡æ˜¯å¦è¢«SELinuxé˜»æ­¢
sealert -a /var/log/audit/audit.log
```

**ç«¯å£ç›‘å¬æ£€æŸ¥**ï¼š
```bash
# æ£€æŸ¥ä»£ç†æœåŠ¡å™¨ç›‘å¬çš„ç«¯å£
netstat -tulpn | grep squid
ss -tulpn | grep squid

# æ£€æŸ¥è¿›ç¨‹ç»‘å®šçš„ç«¯å£
lsof -i :3128
```

---

## 8. ðŸ“‹ æ—¥å¿—åˆ†æžæŽ’é”™æŠ€å·§


### 8.1 æ—¥å¿—æ–‡ä»¶ä½ç½®


**Squidæ—¥å¿—æ–‡ä»¶**ï¼š
```bash
# ä¸»è¦æ—¥å¿—æ–‡ä»¶ä½ç½®
/var/log/squid/access.log    # è®¿é—®æ—¥å¿—
/var/log/squid/cache.log     # ç¼“å­˜æ—¥å¿—
/var/log/squid/squid.out     # é”™è¯¯è¾“å‡ºæ—¥å¿—
```

**HAProxyæ—¥å¿—æ–‡ä»¶**ï¼š
```bash
# HAProxyæ—¥å¿—é€šå¸¸åœ¨ç³»ç»Ÿæ—¥å¿—ä¸­
/var/log/haproxy.log
/var/log/syslog              # å¯èƒ½åŒ…å«HAProxyä¿¡æ¯
/var/log/messages            # ç³»ç»Ÿæ¶ˆæ¯æ—¥å¿—
```

### 8.2 æ—¥å¿—åˆ†æžæŠ€å·§


**å®žæ—¶æ—¥å¿—ç›‘æŽ§**ï¼š
```bash
# å®žæ—¶æŸ¥çœ‹è®¿é—®æ—¥å¿—
tail -f /var/log/squid/access.log

# è¿‡æ»¤ç‰¹å®šé”™è¯¯
tail -f /var/log/squid/access.log | grep "TCP_MISS\|ERROR"

# ç»Ÿè®¡é”™è¯¯ç±»åž‹
grep ERROR /var/log/squid/cache.log | sort | uniq -c
```

**æ—¥å¿—å­—æ®µè§£æž**ï¼š
```
Squidè®¿é—®æ—¥å¿—æ ¼å¼ç¤ºä¾‹ï¼š
1642680000.123    156 192.168.1.100 TCP_MISS/200 1234 GET http://example.com/ - HIER_DIRECT/93.184.216.34 text/html

å­—æ®µå«ä¹‰ï¼š
æ—¶é—´æˆ³    å“åº”æ—¶é—´ å®¢æˆ·ç«¯IP    ç»“æžœç /HTTPçŠ¶æ€ç  å­—èŠ‚æ•° æ–¹æ³• URL ç”¨æˆ· å±‚æ¬¡ç /æœåŠ¡å™¨IP å†…å®¹ç±»åž‹
```

### 8.3 é”™è¯¯æ—¥å¿—åˆ†æž


**å¸¸è§é”™è¯¯ç è§£æž**ï¼š

| é”™è¯¯ç  | å«ä¹‰ | å¯èƒ½åŽŸå›  | è§£å†³æ–¹æ³• |
|-------|------|---------|---------|
| **TCP_MISS** | ç¼“å­˜æœªå‘½ä¸­ | é¦–æ¬¡è¯·æ±‚æˆ–ç¼“å­˜è¿‡æœŸ | æ­£å¸¸çŽ°è±¡ï¼Œæ£€æŸ¥ç¼“å­˜é…ç½® |
| **TCP_HIT** | ç¼“å­˜å‘½ä¸­ | ä»Žç¼“å­˜è¿”å›žå†…å®¹ | æ­£å¸¸çŽ°è±¡ |
| **TCP_ERROR** | è¿žæŽ¥é”™è¯¯ | ç½‘ç»œé—®é¢˜æˆ–æœåŠ¡å™¨ä¸å¯è¾¾ | æ£€æŸ¥ç½‘ç»œè¿žé€šæ€§ |
| **TCP_DENIED** | è®¿é—®è¢«æ‹’ç» | ACLè§„åˆ™é˜»æ­¢è®¿é—® | æ£€æŸ¥è®¿é—®æŽ§åˆ¶é…ç½® |

**é”™è¯¯æ¨¡å¼è¯†åˆ«**ï¼š
```bash
# ç»Ÿè®¡æœ€å¸¸è§çš„é”™è¯¯
awk '{print $4}' /var/log/squid/access.log | sort | uniq -c | sort -nr

# æŸ¥æ‰¾ç‰¹å®šæ—¶é—´æ®µçš„é”™è¯¯
awk '$1 > 1642680000 && $1 < 1642683600 {print}' /var/log/squid/access.log

# ç»Ÿè®¡å®¢æˆ·ç«¯IPçš„è¯·æ±‚æ•°é‡
awk '{print $3}' /var/log/squid/access.log | sort | uniq -c | sort -nr
```

### 8.4 æ—¥å¿—è½®è½¬å’Œç®¡ç†


**æ—¥å¿—è½®è½¬é…ç½®**ï¼š
```bash
# æ£€æŸ¥logrotateé…ç½®
cat /etc/logrotate.d/squid

# æ‰‹åŠ¨æ‰§è¡Œæ—¥å¿—è½®è½¬
logrotate -f /etc/logrotate.d/squid
```

**æ—¥å¿—æ¸…ç†å’Œå½’æ¡£**ï¼š
```bash
# åŽ‹ç¼©æ—§æ—¥å¿—æ–‡ä»¶
gzip /var/log/squid/access.log.1

# åˆ é™¤è¶…è¿‡30å¤©çš„æ—¥å¿—
find /var/log/squid/ -name "*.log.*" -mtime +30 -delete
```

---

## 9. ðŸ’» ç³»ç»Ÿèµ„æºé—®é¢˜è¯Šæ–­


### 9.1 CPUèµ„æºè¯Šæ–­


**CPUä½¿ç”¨çŽ‡ç›‘æŽ§**ï¼š
```bash
# æŸ¥çœ‹å®žæ—¶CPUä½¿ç”¨æƒ…å†µ
top -p $(pgrep squid)

# æŸ¥çœ‹CPUè¯¦ç»†ç»Ÿè®¡
iostat -c 1

# æŸ¥çœ‹è¿›ç¨‹CPUä½¿ç”¨åŽ†å²
sar -u 1 10
```

**CPUæ€§èƒ½åˆ†æž**ï¼š
```bash
# æŸ¥çœ‹è¿›ç¨‹çš„CPUä½¿ç”¨è¯¦æƒ…
pidstat -p $(pgrep squid) 1

# åˆ†æžCPUä½¿ç”¨æ¨¡å¼
vmstat 1 10

# æŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½
uptime
cat /proc/loadavg
```

### 9.2 å†…å­˜èµ„æºè¯Šæ–­


**å†…å­˜ä½¿ç”¨ç›‘æŽ§**ï¼š
```bash
# æŸ¥çœ‹ç³»ç»Ÿå†…å­˜ä½¿ç”¨æƒ…å†µ
free -h
cat /proc/meminfo

# æŸ¥çœ‹è¿›ç¨‹å†…å­˜ä½¿ç”¨
ps aux | grep squid
pmap $(pgrep squid)
```

**å†…å­˜æ³„æ¼æ£€æµ‹**ï¼š
```bash
# ç›‘æŽ§è¿›ç¨‹å†…å­˜ä½¿ç”¨å˜åŒ–
while true; do
    ps aux | grep squid | grep -v grep
    sleep 60
done

# æŸ¥çœ‹å†…å­˜å¢žé•¿è¶‹åŠ¿
sar -r 1 10
```

### 9.3 ç£ç›˜I/Oè¯Šæ–­


**ç£ç›˜ä½¿ç”¨æƒ…å†µ**ï¼š
```bash
# æŸ¥çœ‹ç£ç›˜ç©ºé—´ä½¿ç”¨
df -h
du -sh /var/spool/squid

# æŸ¥çœ‹ç£ç›˜I/Oç»Ÿè®¡
iostat -x 1

# ç›‘æŽ§ç‰¹å®šç›®å½•çš„I/O
iotop -o -d 1
```

**ç£ç›˜æ€§èƒ½æµ‹è¯•**ï¼š
```bash
# æµ‹è¯•ç£ç›˜è¯»å†™æ€§èƒ½
dd if=/dev/zero of=/tmp/test bs=1M count=1024
dd if=/tmp/test of=/dev/null bs=1M

# æŸ¥çœ‹ç£ç›˜é˜Ÿåˆ—å’Œç­‰å¾…æ—¶é—´
iostat -x 1 | grep -E "(Device|sda)"
```

### 9.4 ç½‘ç»œèµ„æºè¯Šæ–­


**ç½‘ç»œæµé‡ç›‘æŽ§**ï¼š
```bash
# å®žæ—¶æŸ¥çœ‹ç½‘ç»œæµé‡
iftop
nethogs

# æŸ¥çœ‹ç½‘ç»œæŽ¥å£ç»Ÿè®¡
cat /proc/net/dev
ip -s link

# ç›‘æŽ§ç½‘ç»œè¿žæŽ¥çŠ¶æ€
ss -tuln
netstat -i
```

**è¿žæŽ¥æ•°ç»Ÿè®¡**ï¼š
```bash
# ç»Ÿè®¡å„ç§çŠ¶æ€çš„è¿žæŽ¥æ•°
netstat -ant | awk '{print $6}' | sort | uniq -c

# æŸ¥çœ‹ä»£ç†æœåŠ¡å™¨çš„è¿žæŽ¥æ•°
netstat -ant | grep :3128 | wc -l

# ç›‘æŽ§è¿žæŽ¥æ•°å˜åŒ–
watch "netstat -ant | grep :3128 | wc -l"
```

### 9.5 èµ„æºç“¶é¢ˆè§£å†³æ–¹æ¡ˆ


**CPUä¼˜åŒ–**ï¼š
- ðŸ”§ **å‡å°‘æ—¥å¿—è®°å½•**ï¼šå…³é—­ä¸å¿…è¦çš„è¯¦ç»†æ—¥å¿—
- âš¡ **ä¼˜åŒ–é…ç½®**ï¼šå‡å°‘æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…
- ðŸ“ˆ **æ¨ªå‘æ‰©å±•**ï¼šå¢žåŠ ä»£ç†æœåŠ¡å™¨å®žä¾‹

**å†…å­˜ä¼˜åŒ–**ï¼š
- ðŸ“¦ **è°ƒæ•´ç¼“å­˜å¤§å°**ï¼šæ ¹æ®å¯ç”¨å†…å­˜è°ƒæ•´cache_mem
- ðŸ—„ï¸ **ä¼˜åŒ–ç¼“å­˜ç­–ç•¥**ï¼šè®¾ç½®åˆç†çš„å¯¹è±¡å¤§å°é™åˆ¶
- ðŸ”„ **å®šæœŸé‡å¯**ï¼šå®šæœŸé‡å¯æœåŠ¡é‡Šæ”¾å†…å­˜

**ç£ç›˜ä¼˜åŒ–**ï¼š
- ðŸ’¾ **ä½¿ç”¨SSD**ï¼šæé«˜ç£ç›˜I/Oæ€§èƒ½
- ðŸ“ **åˆ†ç¦»å­˜å‚¨**ï¼šå°†æ—¥å¿—å’Œç¼“å­˜åˆ†åˆ«å­˜å‚¨åœ¨ä¸åŒç£ç›˜
- ðŸ—œï¸ **å¯ç”¨åŽ‹ç¼©**ï¼šå‡å°‘ç£ç›˜ç©ºé—´ä½¿ç”¨

**ç½‘ç»œä¼˜åŒ–**ï¼š
- ðŸŒ **å¢žåŠ å¸¦å®½**ï¼šå‡çº§ç½‘ç»œè¿žæŽ¥
- ðŸ”— **è¿žæŽ¥å¤ç”¨**ï¼šå¯ç”¨HTTP keep-alive
- ðŸ“Š **è´Ÿè½½å‡è¡¡**ï¼šåˆ†æ•£ç½‘ç»œè´Ÿè½½

---

## 10. ðŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŽŒæ¡çš„æ•…éšœæŽ’æŸ¥æŠ€èƒ½


```
ðŸ”¸ æ•…éšœçŽ°è±¡è¯†åˆ«ï¼šå‡†ç¡®åˆ¤æ–­æ•…éšœç±»åž‹å’Œå½±å“èŒƒå›´
ðŸ”¸ ç³»ç»ŸåŒ–æŽ’æŸ¥ï¼šæŒ‰ç…§æ—¢å®šæµç¨‹é€æ­¥å®šä½é—®é¢˜
ðŸ”¸ å·¥å…·ä½¿ç”¨ç†Ÿç»ƒï¼šç†Ÿç»ƒä½¿ç”¨å„ç§è¯Šæ–­å·¥å…·
ðŸ”¸ æ—¥å¿—åˆ†æžèƒ½åŠ›ï¼šä»Žæ—¥å¿—ä¸­å¿«é€Ÿæ‰¾åˆ°é—®é¢˜çº¿ç´¢
ðŸ”¸ æ€§èƒ½ç›‘æŽ§æ„è¯†ï¼šå»ºç«‹å®Œå–„çš„ç›‘æŽ§ä½“ç³»
ðŸ”¸ é…ç½®ç®¡ç†è§„èŒƒï¼šæ ‡å‡†åŒ–é…ç½®ç®¡ç†æµç¨‹
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ðŸ”¹ æ•…éšœæŽ’æŸ¥çš„ç³»ç»Ÿæ€§æ€ç»´**
```
æŽ’æŸ¥æ€è·¯ï¼š
çŽ°è±¡æ”¶é›† â†’ åˆæ­¥åˆ¤æ–­ â†’ é€å±‚éªŒè¯ â†’ æ ¹å› å®šä½ â†’ è§£å†³æ–¹æ¡ˆ

ä¸è¦ç›²ç›®ä¿®æ”¹é…ç½®ï¼Œè€Œæ˜¯è¦ï¼š
1. å…ˆç†è§£é—®é¢˜çŽ°è±¡
2. æ”¶é›†ç›¸å…³ä¿¡æ¯å’Œæ•°æ®
3. å½¢æˆå‡è®¾å¹¶éªŒè¯
4. æ‰¾åˆ°æ ¹æœ¬åŽŸå› åŽå†è§£å†³
```

**ðŸ”¹ é¢„é˜²æ€§ç»´æŠ¤çš„é‡è¦æ€§**
```
ä¸»åŠ¨ç›‘æŽ§ï¼š
- å»ºç«‹å…³é”®æŒ‡æ ‡ç›‘æŽ§
- è®¾ç½®åˆç†çš„å‘Šè­¦é˜ˆå€¼
- å®šæœŸæ£€æŸ¥ç³»ç»Ÿå¥åº·çŠ¶æ€

å®šæœŸç»´æŠ¤ï¼š
- æ—¥å¿—è½®è½¬å’Œæ¸…ç†
- é…ç½®æ–‡ä»¶å¤‡ä»½
- æ€§èƒ½æ•°æ®åˆ†æž
```

### 10.3 å®žæˆ˜åº”ç”¨æŒ‡å¯¼


**æ•…éšœå“åº”æµç¨‹**ï¼š
1. **å¿«é€Ÿå“åº”**ï¼šæŽ¥åˆ°æ•…éšœæŠ¥å‘ŠåŽ5åˆ†é’Ÿå†…å¼€å§‹å¤„ç†
2. **å½±å“è¯„ä¼°**ï¼šåˆ¤æ–­æ•…éšœå½±å“èŒƒå›´å’Œä¸¥é‡ç¨‹åº¦
3. **ä¸´æ—¶æŽªæ–½**ï¼šé‡‡å–æŽªæ–½å‡å°‘ä¸šåŠ¡å½±å“
4. **æ ¹å› åˆ†æž**ï¼šæ·±å…¥åˆ†æžæ‰¾å‡ºæ ¹æœ¬åŽŸå› 
5. **æ°¸ä¹…è§£å†³**ï¼šåˆ¶å®šå¹¶å®žæ–½é•¿æœŸè§£å†³æ–¹æ¡ˆ
6. **é¢„é˜²æ”¹è¿›**ï¼šæ€»ç»“ç»éªŒï¼Œå®Œå–„ç›‘æŽ§å’Œæµç¨‹

**å¸¸ç”¨æŽ’æŸ¥å‘½ä»¤é€ŸæŸ¥**ï¼š
- âœ… **æœåŠ¡çŠ¶æ€**ï¼š`systemctl status squid`
- âœ… **ç«¯å£ç›‘å¬**ï¼š`netstat -tulpn | grep 3128`
- âœ… **é…ç½®æ£€æŸ¥**ï¼š`squid -k parse`
- âœ… **å®žæ—¶æ—¥å¿—**ï¼š`tail -f /var/log/squid/access.log`
- âœ… **æ€§èƒ½ç›‘æŽ§**ï¼š`top`, `iotop`, `iftop`
- âœ… **ç½‘ç»œæµ‹è¯•**ï¼š`curl`, `telnet`, `ping`

### 10.4 æ•…éšœé¢„é˜²å»ºè®®


**ç›‘æŽ§ä½“ç³»å»ºè®¾**ï¼š
- ðŸ“Š **å…³é”®æŒ‡æ ‡ç›‘æŽ§**ï¼šå“åº”æ—¶é—´ã€é”™è¯¯çŽ‡ã€èµ„æºä½¿ç”¨çŽ‡
- ðŸš¨ **å‘Šè­¦æœºåˆ¶**ï¼šåŠæ—¶å‘çŽ°å¼‚å¸¸æƒ…å†µ
- ðŸ“ˆ **è¶‹åŠ¿åˆ†æž**ï¼šé¢„æµ‹æ½œåœ¨é—®é¢˜
- ðŸ“ **æ•…éšœè®°å½•**ï¼šå»ºç«‹æ•…éšœçŸ¥è¯†åº“

**è¿ç»´æœ€ä½³å®žè·µ**ï¼š
- ðŸ”„ **å®šæœŸå·¡æ£€**ï¼šæ¯å‘¨æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
- ðŸ’¾ **é…ç½®å¤‡ä»½**ï¼šä¿®æ”¹å‰å¤‡ä»½é…ç½®æ–‡ä»¶
- ðŸ§ª **æµ‹è¯•éªŒè¯**ï¼šå˜æ›´å‰åœ¨æµ‹è¯•çŽ¯å¢ƒéªŒè¯
- ðŸ“š **æ–‡æ¡£æ›´æ–°**ï¼šåŠæ—¶æ›´æ–°æ“ä½œæ–‡æ¡£

**åº”æ€¥é¢„æ¡ˆå‡†å¤‡**ï¼š
- ðŸ†˜ **åº”æ€¥è”ç³»äºº**ï¼šæ˜Žç¡®æ•…éšœå“åº”è´£ä»»äºº
- ðŸ“± **é€šçŸ¥æœºåˆ¶**ï¼šå»ºç«‹å¿«é€Ÿé€šçŸ¥æ¸ é“
- ðŸ”§ **åº”æ€¥å·¥å…·**ï¼šå‡†å¤‡å¸¸ç”¨æŽ’æŸ¥å·¥å…·
- ðŸ“‹ **æ“ä½œæ‰‹å†Œ**ï¼šç¼–å†™è¯¦ç»†çš„åº”æ€¥æ“ä½œæŒ‡å—

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- ä»£ç†æœåŠ¡å™¨æ•…éšœæŽ’æŸ¥è¦ç³»ç»ŸåŒ–ï¼Œä¸èƒ½ç›²ç›®æ“ä½œ
- æ—¥å¿—æ˜¯æŽ’æŸ¥é—®é¢˜çš„é‡è¦ä¾æ®ï¼Œè¦å­¦ä¼šåˆ†æžæ—¥å¿—
- æ€§èƒ½ç›‘æŽ§æ˜¯é¢„é˜²æ•…éšœçš„å…³é”®ï¼Œè¦å»ºç«‹å®Œå–„çš„ç›‘æŽ§ä½“ç³»
- é…ç½®ç®¡ç†è¦è§„èŒƒåŒ–ï¼Œä¿®æ”¹å‰å¤‡ä»½ï¼Œå˜æ›´åŽéªŒè¯
- æ•…éšœå¤„ç†è¦å¿«é€Ÿå“åº”ï¼Œæ ¹å› åˆ†æžï¼ŒæŒç»­æ”¹è¿›