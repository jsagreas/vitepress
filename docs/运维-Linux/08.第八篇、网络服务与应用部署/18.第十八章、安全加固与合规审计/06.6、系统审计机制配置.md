---
title: 6ã€ç³»ç»Ÿå®¡è®¡æœºåˆ¶é…ç½®
---
## ğŸ“š ç›®å½•

1. [å®¡è®¡ç³»ç»Ÿæ¦‚è¿°](#1-å®¡è®¡ç³»ç»Ÿæ¦‚è¿°)
2. [auditdå®¡è®¡æœåŠ¡](#2-auditdå®¡è®¡æœåŠ¡)
3. [å®¡è®¡è§„åˆ™ç®¡ç†](#3-å®¡è®¡è§„åˆ™ç®¡ç†)
4. [ç³»ç»Ÿè°ƒç”¨å®¡è®¡](#4-ç³»ç»Ÿè°ƒç”¨å®¡è®¡)
5. [æ–‡ä»¶è®¿é—®å®¡è®¡](#5-æ–‡ä»¶è®¿é—®å®¡è®¡)
6. [ç”¨æˆ·è¡Œä¸ºç›‘æ§](#6-ç”¨æˆ·è¡Œä¸ºç›‘æ§)
7. [å®¡è®¡æ—¥å¿—åˆ†æ](#7-å®¡è®¡æ—¥å¿—åˆ†æ)
8. [å®¡è®¡æ•°æ®ç®¡ç†](#8-å®¡è®¡æ•°æ®ç®¡ç†)
9. [åˆè§„å®¡è®¡æŠ¥å‘Š](#9-åˆè§„å®¡è®¡æŠ¥å‘Š)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” å®¡è®¡ç³»ç»Ÿæ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯ç³»ç»Ÿå®¡è®¡


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µ**
ç³»ç»Ÿå®¡è®¡å°±åƒç»™Linuxç³»ç»Ÿè£…äº†ä¸€ä¸ª"é»‘åŒ£å­"ï¼Œè®°å½•ç³»ç»Ÿä¸­å‘ç”Ÿçš„å„ç§é‡è¦æ“ä½œå’Œäº‹ä»¶ã€‚æƒ³è±¡ä¸€ä¸‹é“¶è¡Œçš„ç›‘æ§ç³»ç»Ÿï¼Œå®ƒä¼šè®°å½•è°åœ¨ä»€ä¹ˆæ—¶é—´åšäº†ä»€ä¹ˆæ“ä½œï¼Œå®¡è®¡ç³»ç»Ÿå°±æ˜¯è¿™ä¸ªé“ç†ã€‚

**ğŸ”¸ å®¡è®¡çš„æ ¸å¿ƒä½œç”¨**
```
å®‰å…¨ç›‘æ§ï¼šè®°å½•å¯ç–‘è¡Œä¸ºå’Œå®‰å…¨äº‹ä»¶
åˆè§„è¦æ±‚ï¼šæ»¡è¶³æ³•è§„å’Œæ ‡å‡†è¦æ±‚ï¼ˆå¦‚SOXã€PCI-DSSï¼‰
æ•…éšœæ’æŸ¥ï¼šåˆ†æç³»ç»Ÿé—®é¢˜å’Œå¼‚å¸¸è¡Œä¸º
è´£ä»»è¿½è¸ªï¼šç¡®å®šæ“ä½œè´£ä»»äººå’Œæ—¶é—´
```

### 1.2 Linuxå®¡è®¡æ¶æ„


**ğŸ”¸ å®¡è®¡ç³»ç»Ÿç»„æˆ**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åº”ç”¨ç¨‹åº       â”‚    â”‚   ç³»ç»Ÿè°ƒç”¨       â”‚    â”‚   å†…æ ¸ç©ºé—´       â”‚
â”‚   (ç”¨æˆ·æ“ä½œ)     â”‚â”€â”€â”€â–¶â”‚   (ç³»ç»Ÿæ¥å£)     â”‚â”€â”€â”€â–¶â”‚   (å®¡è®¡å­ç³»ç»Ÿ)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                      â”‚
                                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å®¡è®¡æŠ¥å‘Š       â”‚â—€â”€â”€â”€â”‚   æ—¥å¿—åˆ†æ       â”‚â—€â”€â”€â”€â”‚   auditdæœåŠ¡     â”‚
â”‚   (åˆè§„æŠ¥å‘Š)     â”‚    â”‚   (æ•°æ®å¤„ç†)     â”‚    â”‚   (æ—¥å¿—æ”¶é›†)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 å®¡è®¡ç³»ç»Ÿçš„ä»·å€¼


**ğŸ”¸ å®‰å…¨ä»·å€¼**
- **å…¥ä¾µæ£€æµ‹**: å‘ç°æœªæˆæƒè®¿é—®å’Œå¼‚å¸¸è¡Œä¸º
- **å–è¯åˆ†æ**: ä¸ºå®‰å…¨äº‹ä»¶æä¾›è¯¦ç»†è®°å½•
- **å®æ—¶ç›‘æ§**: åŠæ—¶å‘ç°å®‰å…¨å¨èƒ

**ğŸ”¸ ç®¡ç†ä»·å€¼**  
- **æ“ä½œè®°å½•**: è¿½è¸ªç®¡ç†å‘˜æ“ä½œå†å²
- **æƒé™ç›‘æ§**: ç›‘æ§ç‰¹æƒæ“ä½œä½¿ç”¨æƒ…å†µ
- **å˜æ›´ç®¡ç†**: è®°å½•ç³»ç»Ÿé…ç½®å˜æ›´

**ğŸ”¸ åˆè§„ä»·å€¼**
- **æ³•è§„éµå¾ª**: æ»¡è¶³è¡Œä¸šåˆè§„è¦æ±‚
- **å®¡è®¡è¯æ®**: æä¾›å®¡è®¡æ‰€éœ€è¯æ®ææ–™
- **é£é™©æ§åˆ¶**: é™ä½åˆè§„é£é™©

---

## 2. âš™ï¸ auditdå®¡è®¡æœåŠ¡


### 2.1 auditdæœåŠ¡åŸºç¡€


**ğŸ”¸ ä»€ä¹ˆæ˜¯auditd**
auditdæ˜¯Linuxç³»ç»Ÿçš„å®¡è®¡å®ˆæŠ¤è¿›ç¨‹ï¼Œå°±åƒä¸€ä¸ªä¸“ä¸šçš„è®°å½•å‘˜ï¼Œè´Ÿè´£æ”¶é›†ã€è®°å½•å’Œç®¡ç†ç³»ç»Ÿå®¡è®¡ä¿¡æ¯ã€‚å®ƒæ˜¯æ•´ä¸ªå®¡è®¡ç³»ç»Ÿçš„æ ¸å¿ƒç»„ä»¶ã€‚

**ğŸ”¸ auditdçš„å·¥ä½œåŸç†**
```
å†…æ ¸å®¡è®¡æ¡†æ¶ â”€â”€â–¶ auditdå®ˆæŠ¤è¿›ç¨‹ â”€â”€â–¶ å®¡è®¡æ—¥å¿—æ–‡ä»¶
     â”‚               â”‚                â”‚
 äº§ç”Ÿå®¡è®¡äº‹ä»¶    æ”¶é›†å’Œå¤„ç†äº‹ä»¶      å­˜å‚¨åˆ°ç£ç›˜
```

### 2.2 auditdæœåŠ¡ç®¡ç†


**ğŸ”¸ æœåŠ¡å®‰è£…ä¸å¯åŠ¨**
```bash
# å®‰è£…auditåŒ…
sudo yum install audit audit-libs    # CentOS/RHEL
sudo apt install auditd             # Ubuntu/Debian

# å¯åŠ¨å’Œç®¡ç†æœåŠ¡
sudo systemctl start auditd         # å¯åŠ¨æœåŠ¡
sudo systemctl enable auditd        # å¼€æœºè‡ªå¯
sudo systemctl status auditd        # æŸ¥çœ‹çŠ¶æ€
sudo systemctl reload auditd        # é‡æ–°åŠ è½½é…ç½®
```

**ğŸ”¸ æœåŠ¡çŠ¶æ€æ£€æŸ¥**
```bash
# æ£€æŸ¥å®¡è®¡ç³»ç»ŸçŠ¶æ€
sudo auditctl -s
```
è¾“å‡ºç¤ºä¾‹ï¼š
```
enabled 1           # å®¡è®¡å·²å¯ç”¨
failure 1           # å¤±è´¥å¤„ç†æ¨¡å¼
pid 1234           # auditdè¿›ç¨‹ID
rate_limit 0       # é€Ÿç‡é™åˆ¶
backlog_limit 8192 # å¾…å¤„ç†äº‹ä»¶ç¼“å†²åŒºå¤§å°
```

### 2.3 auditdé…ç½®æ–‡ä»¶


**ğŸ”¸ ä¸»é…ç½®æ–‡ä»¶ `/etc/audit/auditd.conf`**

è¿™ä¸ªæ–‡ä»¶æ§åˆ¶auditdæœåŠ¡çš„åŸºæœ¬è¡Œä¸ºï¼Œå°±åƒè®¾ç½®å½•éŸ³è®¾å¤‡çš„å„ç§å‚æ•°ï¼š

```bash
# æ—¥å¿—æ–‡ä»¶ä½ç½®å’Œå¤§å°ç®¡ç†
log_file = /var/log/audit/audit.log    # æ—¥å¿—æ–‡ä»¶ä½ç½®
log_format = RAW                       # æ—¥å¿—æ ¼å¼
max_log_file = 50                      # å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§MBæ•°
num_logs = 5                           # ä¿ç•™çš„æ—¥å¿—æ–‡ä»¶ä¸ªæ•°

# ç£ç›˜ç©ºé—´ç®¡ç†
space_left = 75                        # å‰©ä½™ç©ºé—´ä½äº75MBæ—¶å‘Šè­¦
space_left_action = SYSLOG             # ç©ºé—´ä¸è¶³æ—¶çš„å¤„ç†åŠ¨ä½œ
admin_space_left = 50                  # ç®¡ç†å‘˜ç©ºé—´é˜ˆå€¼
admin_space_left_action = SUSPEND      # ç®¡ç†å‘˜ç©ºé—´ä¸è¶³æ—¶æŒ‚èµ·

# æ—¥å¿—è½®è½¬è®¾ç½®
max_log_file_action = ROTATE           # æ—¥å¿—æ–‡ä»¶æ»¡æ—¶è½®è½¬
```

**ğŸ”¸ æ ¸å¿ƒé…ç½®å‚æ•°è§£é‡Š**

| å‚æ•°åç§° | **å«ä¹‰è¯´æ˜** | **å¸¸ç”¨å€¼** | **å®é™…ä½œç”¨** |
|---------|-------------|-----------|-------------|
| `log_format` | `æ—¥å¿—å­˜å‚¨æ ¼å¼` | `RAW/NOLOG` | `RAWä¿æŒåŸå§‹æ ¼å¼ï¼Œä¾¿äºåˆ†æ` |
| `flush` | `æ—¥å¿—å†™å…¥ç­–ç•¥` | `DATA/SYNC` | `æ§åˆ¶æ•°æ®ä½•æ—¶å†™å…¥ç£ç›˜` |
| `freq` | `å¼ºåˆ¶åŒæ­¥é¢‘ç‡` | `20` | `æ¯20æ¡è®°å½•å¼ºåˆ¶å†™å…¥ç£ç›˜` |
| `priority_boost` | `è¿›ç¨‹ä¼˜å…ˆçº§æå‡` | `4` | `æé«˜auditdè¿›ç¨‹ä¼˜å…ˆçº§` |

### 2.4 å®¡è®¡å†…æ ¸å‚æ•°


**ğŸ”¸ å†…æ ¸å®¡è®¡å‚æ•°é…ç½®**
```bash
# æŸ¥çœ‹å½“å‰å†…æ ¸å®¡è®¡å‚æ•°
cat /proc/sys/kernel/audit_*

# ä¸´æ—¶è®¾ç½®å†…æ ¸å‚æ•°
echo 1 > /proc/sys/kernel/audit           # å¯ç”¨å®¡è®¡
echo 1 > /proc/sys/kernel/audit_backlog_limit  # è®¾ç½®ç¼“å†²åŒºå¤§å°
```

**ğŸ”¸ æ°¸ä¹…è®¾ç½®å†…æ ¸å‚æ•°**
åœ¨ `/etc/sysctl.conf` ä¸­æ·»åŠ ï¼š
```
kernel.audit = 1                    # å¯ç”¨å†…æ ¸å®¡è®¡
kernel.audit_backlog_limit = 8192   # è®¾ç½®å®¡è®¡ç¼“å†²åŒºå¤§å°
```

---

## 3. ğŸ“ å®¡è®¡è§„åˆ™ç®¡ç†


### 3.1 å®¡è®¡è§„åˆ™æ¦‚è¿°


**ğŸ”¸ ä»€ä¹ˆæ˜¯å®¡è®¡è§„åˆ™**
å®¡è®¡è§„åˆ™å°±åƒè®¾ç½®ç›‘æ§æ‘„åƒå¤´çš„"æ‹æ‘„èŒƒå›´"ï¼Œå‘Šè¯‰ç³»ç»Ÿè¦ç›‘æ§å“ªäº›æ“ä½œã€å“ªäº›æ–‡ä»¶ã€å“ªäº›ç”¨æˆ·çš„è¡Œä¸ºã€‚è§„åˆ™å†³å®šäº†å®¡è®¡ç³»ç»Ÿè®°å½•ä»€ä¹ˆå†…å®¹ã€‚

**ğŸ”¸ è§„åˆ™ç±»å‹åˆ†ç±»**
```
æ§åˆ¶è§„åˆ™ï¼šæ§åˆ¶å®¡è®¡ç³»ç»Ÿè‡ªèº«è¡Œä¸º
æ–‡ä»¶è§„åˆ™ï¼šç›‘æ§æ–‡ä»¶å’Œç›®å½•è®¿é—®
ç³»ç»Ÿè°ƒç”¨è§„åˆ™ï¼šç›‘æ§ç‰¹å®šçš„ç³»ç»Ÿè°ƒç”¨
```

### 3.2 å®¡è®¡è§„åˆ™å‘½ä»¤


**ğŸ”¸ åŸºæœ¬è§„åˆ™æ“ä½œ**
```bash
# æŸ¥çœ‹å½“å‰è§„åˆ™
sudo auditctl -l                    # åˆ—å‡ºæ‰€æœ‰è§„åˆ™
sudo auditctl -s                    # æŸ¥çœ‹å®¡è®¡çŠ¶æ€

# åˆ é™¤è§„åˆ™
sudo auditctl -D                    # åˆ é™¤æ‰€æœ‰è§„åˆ™
sudo auditctl -d rule_definition    # åˆ é™¤ç‰¹å®šè§„åˆ™

# è§„åˆ™æŒä¹…åŒ–
sudo auditctl -R /etc/audit/audit.rules  # ä»æ–‡ä»¶åŠ è½½è§„åˆ™
```

**ğŸ”¸ è§„åˆ™é…ç½®æ–‡ä»¶**
å®¡è®¡è§„åˆ™å¯ä»¥å†™åœ¨ `/etc/audit/rules.d/` ç›®å½•ä¸‹çš„æ–‡ä»¶ä¸­ï¼Œç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½ã€‚

### 3.3 æ§åˆ¶è§„åˆ™è®¾ç½®


**ğŸ”¸ å®¡è®¡ç³»ç»Ÿæ§åˆ¶**
```bash
# è®¾ç½®å®¡è®¡ç¼“å†²åŒºå¤§å°
auditctl -b 8192

# è®¾ç½®å®¡è®¡å¤±è´¥å¤„ç†æ¨¡å¼
auditctl -f 1    # 1=æ‰“å°å¤±è´¥ä¿¡æ¯ï¼Œ2=å†…æ ¸panic

# å¯ç”¨/ç¦ç”¨å®¡è®¡
auditctl -e 1    # 1=å¯ç”¨ï¼Œ0=ç¦ç”¨ï¼Œ2=é”å®šé…ç½®
```

**ğŸ”¸ è§„åˆ™å®ä¾‹è¯´æ˜**
```bash
# ç¤ºä¾‹ï¼šåŸºæœ¬æ§åˆ¶è§„åˆ™
-b 8192          # è®¾ç½®8192ä¸ªå®¡è®¡äº‹ä»¶ç¼“å†²åŒº
-f 1             # å¤±è´¥æ—¶æ‰“å°ä¿¡æ¯åˆ°å†…æ ¸æ—¥å¿—
-e 1             # å¯ç”¨å®¡è®¡
```

### 3.4 è§„åˆ™æ–‡ä»¶ç®¡ç†


**ğŸ”¸ è§„åˆ™æ–‡ä»¶ç»“æ„**
```
/etc/audit/rules.d/
â”œâ”€â”€ 10-base-config.rules      # åŸºç¡€é…ç½®è§„åˆ™
â”œâ”€â”€ 20-file-access.rules      # æ–‡ä»¶è®¿é—®è§„åˆ™  
â”œâ”€â”€ 30-syscall-rules.rules    # ç³»ç»Ÿè°ƒç”¨è§„åˆ™
â””â”€â”€ 99-finalize.rules         # æœ€ç»ˆåŒ–è§„åˆ™
```

**ğŸ”¸ è§„åˆ™åŠ è½½é¡ºåº**
è§„åˆ™æŒ‰æ–‡ä»¶åå­—æ¯é¡ºåºåŠ è½½ï¼Œæ‰€ä»¥ç”¨æ•°å­—å‰ç¼€æ§åˆ¶åŠ è½½é¡ºåºå¾ˆé‡è¦ã€‚

> ğŸ’¡ **æœ€ä½³å®è·µæç¤º**  
> å°†ä¸åŒç±»å‹çš„è§„åˆ™åˆ†åˆ«å†™åœ¨ä¸åŒæ–‡ä»¶ä¸­ï¼Œä¾¿äºç®¡ç†å’Œç»´æŠ¤ã€‚ä½¿ç”¨æœ‰æ„ä¹‰çš„æ–‡ä»¶åå’Œé€‚å½“çš„æ•°å­—å‰ç¼€ã€‚

---

## 4. ğŸ”§ ç³»ç»Ÿè°ƒç”¨å®¡è®¡


### 4.1 ç³»ç»Ÿè°ƒç”¨å®¡è®¡åŸºç¡€


**ğŸ”¸ ä»€ä¹ˆæ˜¯ç³»ç»Ÿè°ƒç”¨å®¡è®¡**
ç³»ç»Ÿè°ƒç”¨æ˜¯ç¨‹åºä¸æ“ä½œç³»ç»Ÿå†…æ ¸äº¤äº’çš„æ¥å£ã€‚æ¯”å¦‚ç¨‹åºè¦è¯»å–æ–‡ä»¶ã€åˆ›å»ºè¿›ç¨‹ã€ä¿®æ”¹æƒé™ç­‰ï¼Œéƒ½éœ€è¦é€šè¿‡ç³»ç»Ÿè°ƒç”¨ã€‚å®¡è®¡ç³»ç»Ÿè°ƒç”¨å°±æ˜¯è®°å½•è¿™äº›"ç¨‹åºä¸å†…æ ¸çš„å¯¹è¯"ã€‚

**ğŸ”¸ å¸¸è§ç³»ç»Ÿè°ƒç”¨ç±»å‹**
```
æ–‡ä»¶æ“ä½œï¼šopenã€readã€writeã€closeã€unlink
è¿›ç¨‹ç®¡ç†ï¼šforkã€execã€exitã€kill
æƒé™æ“ä½œï¼šchmodã€chownã€setuid
ç½‘ç»œé€šä¿¡ï¼šsocketã€connectã€bindã€listen
```

### 4.2 ç³»ç»Ÿè°ƒç”¨è§„åˆ™è¯­æ³•


**ğŸ”¸ åŸºæœ¬è¯­æ³•æ ¼å¼**
```bash
auditctl -a action,list -S system_call -F field=value -k key_name
```

**ğŸ”¸ å‚æ•°å«ä¹‰è§£é‡Š**
- **action**: `always`(æ€»æ˜¯è®°å½•) æˆ– `never`(ä»ä¸è®°å½•)
- **list**: `exit`(ç³»ç»Ÿè°ƒç”¨é€€å‡ºæ—¶) æˆ– `entry`(ç³»ç»Ÿè°ƒç”¨è¿›å…¥æ—¶)
- **-S**: æŒ‡å®šè¦ç›‘æ§çš„ç³»ç»Ÿè°ƒç”¨åç§°
- **-F**: è¿‡æ»¤æ¡ä»¶ï¼Œå¦‚ç”¨æˆ·IDã€è¿›ç¨‹IDç­‰
- **-k**: ç»™è§„åˆ™æ·»åŠ å…³é”®å­—æ ‡è¯†ï¼Œä¾¿äºåæœŸæœç´¢

### 4.3 æ–‡ä»¶æ“ä½œå®¡è®¡


**ğŸ”¸ æ–‡ä»¶è®¿é—®ç›‘æ§**
```bash
# ç›‘æ§æ–‡ä»¶æ‰“å¼€æ“ä½œ
auditctl -a always,exit -S open,openat -k file_access

# ç›‘æ§æ–‡ä»¶åˆ é™¤æ“ä½œ  
auditctl -a always,exit -S unlink,unlinkat,rmdir -k file_delete

# ç›‘æ§æ–‡ä»¶æƒé™ä¿®æ”¹
auditctl -a always,exit -S chmod,fchmod,chown,fchown -k perm_mod
```

**ğŸ”¸ å®é™…åº”ç”¨ç¤ºä¾‹**
```bash
# ç›‘æ§æ‰€æœ‰ç”¨æˆ·çš„æ–‡ä»¶åˆ é™¤æ“ä½œ
auditctl -a always,exit -S unlink -S unlinkat -S rmdir -k delete_files

# ç›‘æ§ç‰¹å®šç”¨æˆ·çš„æ–‡ä»¶æ“ä½œï¼ˆUID=1000ï¼‰
auditctl -a always,exit -S open -F uid=1000 -k user_file_access
```

### 4.4 è¿›ç¨‹ç®¡ç†å®¡è®¡


**ğŸ”¸ è¿›ç¨‹åˆ›å»ºç›‘æ§**
```bash
# ç›‘æ§è¿›ç¨‹åˆ›å»º
auditctl -a always,exit -S fork,vfork,clone -k process_creation

# ç›‘æ§ç¨‹åºæ‰§è¡Œ
auditctl -a always,exit -S execve -k program_execution

# ç›‘æ§è¿›ç¨‹ç»ˆæ­¢
auditctl -a always,exit -S exit,exit_group -k process_termination
```

### 4.5 æƒé™å˜æ›´å®¡è®¡


**ğŸ”¸ ç‰¹æƒæ“ä½œç›‘æ§**
```bash
# ç›‘æ§æƒé™æå‡æ“ä½œ
auditctl -a always,exit -S setuid,setgid,setreuid,setregid -k privilege_escalation

# ç›‘æ§sudoä½¿ç”¨
auditctl -a always,exit -S execve -F path=/usr/bin/sudo -k sudo_usage

# ç›‘æ§suå‘½ä»¤ä½¿ç”¨  
auditctl -a always,exit -S execve -F path=/bin/su -k su_usage
```

**ğŸ”¸ ç³»ç»Ÿé…ç½®å˜æ›´**
```bash
# ç›‘æ§ç³»ç»Ÿæ—¶é—´ä¿®æ”¹
auditctl -a always,exit -S adjtimex,settimeofday,clock_settime -k time_change

# ç›‘æ§ä¸»æœºåä¿®æ”¹
auditctl -a always,exit -S sethostname,setdomainname -k hostname_change
```

---

## 5. ğŸ“ æ–‡ä»¶è®¿é—®å®¡è®¡


### 5.1 æ–‡ä»¶å®¡è®¡åŸºç¡€


**ğŸ”¸ ä»€ä¹ˆæ˜¯æ–‡ä»¶è®¿é—®å®¡è®¡**
æ–‡ä»¶è®¿é—®å®¡è®¡å°±åƒç»™é‡è¦æ–‡ä»¶å®‰è£…"æ™ºèƒ½é—¨é”"ï¼Œè®°å½•è°åœ¨ä»€ä¹ˆæ—¶å€™å¯¹æ–‡ä»¶è¿›è¡Œäº†ä»€ä¹ˆæ“ä½œã€‚è¿™å¯¹ä¿æŠ¤æ•æ„Ÿæ•°æ®å’Œè¿½è¸ªæ–‡ä»¶å˜æ›´éå¸¸é‡è¦ã€‚

**ğŸ”¸ æ–‡ä»¶å®¡è®¡çš„ç›‘æ§å†…å®¹**
```
è¯»å–æ“ä½œï¼šè°è¯»å–äº†æ–‡ä»¶å†…å®¹
å†™å…¥æ“ä½œï¼šè°ä¿®æ”¹äº†æ–‡ä»¶å†…å®¹
åˆ é™¤æ“ä½œï¼šè°åˆ é™¤äº†æ–‡ä»¶
æƒé™ä¿®æ”¹ï¼šè°æ”¹å˜äº†æ–‡ä»¶æƒé™
å±æ€§ä¿®æ”¹ï¼šè°ä¿®æ”¹äº†æ–‡ä»¶å±æ€§
```

### 5.2 æ–‡ä»¶ç›‘æ§è§„åˆ™


**ğŸ”¸ åŸºæœ¬æ–‡ä»¶ç›‘æ§è¯­æ³•**
```bash
auditctl -w path -p permissions -k keyname
```

**ğŸ”¸ æƒé™å‚æ•°å«ä¹‰**
- **r**: è¯»å–(read)
- **w**: å†™å…¥(write)  
- **x**: æ‰§è¡Œ(execute)
- **a**: å±æ€§ä¿®æ”¹(attribute change)

### 5.3 é‡è¦æ–‡ä»¶ç›‘æ§


**ğŸ”¸ ç³»ç»Ÿé…ç½®æ–‡ä»¶ç›‘æ§**
```bash
# ç›‘æ§å¯†ç æ–‡ä»¶
auditctl -w /etc/passwd -p wa -k passwd_changes
auditctl -w /etc/shadow -p wa -k shadow_changes
auditctl -w /etc/group -p wa -k group_changes

# ç›‘æ§ç½‘ç»œé…ç½®
auditctl -w /etc/hosts -p wa -k network_config
auditctl -w /etc/resolv.conf -p wa -k dns_config

# ç›‘æ§ç³»ç»ŸæœåŠ¡é…ç½®
auditctl -w /etc/systemd/ -p wa -k systemd_config
```

**ğŸ”¸ å®‰å…¨ç›¸å…³æ–‡ä»¶ç›‘æ§**
```bash
# ç›‘æ§SSHé…ç½®
auditctl -w /etc/ssh/sshd_config -p wa -k ssh_config

# ç›‘æ§sudoé…ç½®
auditctl -w /etc/sudoers -p wa -k sudo_config
auditctl -w /etc/sudoers.d/ -p wa -k sudo_config

# ç›‘æ§å®¡è®¡é…ç½®ï¼ˆé˜²æ­¢ç¯¡æ”¹ï¼‰
auditctl -w /etc/audit/ -p wa -k audit_config
```

### 5.4 åº”ç”¨ç¨‹åºå®¡è®¡


**ğŸ”¸ WebæœåŠ¡å™¨å®¡è®¡**
```bash
# ç›‘æ§Apacheé…ç½®
auditctl -w /etc/httpd/ -p wa -k apache_config

# ç›‘æ§Nginxé…ç½®
auditctl -w /etc/nginx/ -p wa -k nginx_config

# ç›‘æ§Webæ–‡æ¡£ç›®å½•
auditctl -w /var/www/ -p wa -k web_content
```

**ğŸ”¸ æ•°æ®åº“å®¡è®¡**
```bash
# ç›‘æ§MySQLé…ç½®
auditctl -w /etc/mysql/ -p wa -k mysql_config

# ç›‘æ§æ•°æ®åº“æ•°æ®ç›®å½•
auditctl -w /var/lib/mysql/ -p wa -k mysql_data
```

### 5.5 ç›®å½•é€’å½’ç›‘æ§


**ğŸ”¸ é€’å½’ç›‘æ§é‡è¦ç›®å½•**
```bash
# ç›‘æ§æ•´ä¸ª/etcç›®å½•ï¼ˆä½†è¦å°å¿ƒæ€§èƒ½å½±å“ï¼‰
auditctl -w /etc/ -p wa -k etc_changes

# ç›‘æ§ç”¨æˆ·ä¸»ç›®å½•
auditctl -w /home/ -p wa -k home_access

# ç›‘æ§ä¸´æ—¶ç›®å½•ï¼ˆå¯èƒ½çš„æ¶æ„æ–‡ä»¶å­˜æ”¾ï¼‰
auditctl -w /tmp/ -p wa -k tmp_access
```

> âš ï¸ **æ€§èƒ½æ³¨æ„äº‹é¡¹**  
> ç›‘æ§å¤§ç›®å½•æˆ–é«˜è®¿é—®é¢‘ç‡çš„æ–‡ä»¶ä¼šäº§ç”Ÿå¤§é‡æ—¥å¿—ï¼Œå¯èƒ½å½±å“ç³»ç»Ÿæ€§èƒ½ã€‚è¦æ ¹æ®å®é™…éœ€æ±‚å¹³è¡¡ç›‘æ§èŒƒå›´å’Œç³»ç»Ÿæ€§èƒ½ã€‚

---

## 6. ğŸ‘¤ ç”¨æˆ·è¡Œä¸ºç›‘æ§


### 6.1 ç”¨æˆ·å®¡è®¡åŸºç¡€


**ğŸ”¸ ç”¨æˆ·è¡Œä¸ºå®¡è®¡çš„é‡è¦æ€§**
ç”¨æˆ·è¡Œä¸ºå®¡è®¡å°±åƒå…¬å¸çš„è€ƒå‹¤è®°å½•ç³»ç»Ÿï¼Œä¸ä»…è®°å½•å‘˜å·¥ä½•æ—¶ä¸Šä¸‹ç­ï¼Œè¿˜è®°å½•ä»–ä»¬åœ¨å·¥ä½œæœŸé—´åšäº†ä»€ä¹ˆã€‚è¿™å¯¹äºå®‰å…¨ç®¡ç†å’Œè´£ä»»è¿½æº¯éå¸¸é‡è¦ã€‚

**ğŸ”¸ ç›‘æ§çš„ç”¨æˆ·è¡Œä¸ºç±»å‹**
```
ç™»å½•è¡Œä¸ºï¼šç”¨æˆ·ç™»å½•/é€€å‡ºç³»ç»Ÿ
æƒé™ä½¿ç”¨ï¼šsudoã€suç­‰ç‰¹æƒæ“ä½œ
å‘½ä»¤æ‰§è¡Œï¼šç”¨æˆ·æ‰§è¡Œçš„å‘½ä»¤å†å²
æ–‡ä»¶æ“ä½œï¼šç”¨æˆ·å¯¹æ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹
ç½‘ç»œæ´»åŠ¨ï¼šç”¨æˆ·çš„ç½‘ç»œè¿æ¥è¡Œä¸º
```

### 6.2 ç™»å½•è¡Œä¸ºç›‘æ§


**ğŸ”¸ ç”¨æˆ·ç™»å½•å®¡è®¡**
```bash
# ç›‘æ§ç”¨æˆ·ç™»å½•
auditctl -w /var/log/lastlog -p wa -k user_login

# ç›‘æ§ç™»å½•å¤±è´¥è®°å½•
auditctl -w /var/log/faillog -p wa -k login_failures

# ç›‘æ§wtmpæ–‡ä»¶ï¼ˆç™»å½•å†å²ï¼‰
auditctl -w /var/log/wtmp -p wa -k login_history
```

**ğŸ”¸ SSHç™»å½•ç›‘æ§**
```bash
# ç›‘æ§SSHç›¸å…³çš„ç”¨æˆ·éªŒè¯
auditctl -a always,exit -S connect -F a2=16 -F success=1 -k ssh_connections

# ç›‘æ§SSHé…ç½®å˜æ›´
auditctl -w /etc/ssh/sshd_config -p wa -k ssh_config_change
```

### 6.3 ç‰¹æƒæ“ä½œç›‘æ§


**ğŸ”¸ sudoæ“ä½œå®¡è®¡**
```bash
# ç›‘æ§sudoå‘½ä»¤ä½¿ç”¨
auditctl -a always,exit -F path=/usr/bin/sudo -F perm=x -k sudo_usage

# ç›‘æ§suå‘½ä»¤ä½¿ç”¨
auditctl -a always,exit -F path=/bin/su -F perm=x -k su_usage

# ç›‘æ§ç‰¹å®šç”¨æˆ·çš„ç‰¹æƒæ“ä½œ
auditctl -a always,exit -S all -F uid=0 -k root_actions
```

**ğŸ”¸ æƒé™ä¿®æ”¹ç›‘æ§**
```bash
# ç›‘æ§æ–‡ä»¶æƒé™ä¿®æ”¹
auditctl -a always,exit -S chmod,fchmod,fchmodat -k permission_changes

# ç›‘æ§æ–‡ä»¶æ‰€æœ‰æƒä¿®æ”¹  
auditctl -a always,exit -S chown,fchown,lchown,fchownat -k ownership_changes
```

### 6.4 å‘½ä»¤æ‰§è¡Œç›‘æ§


**ğŸ”¸ å…³é”®å‘½ä»¤ç›‘æ§**
```bash
# ç›‘æ§ç½‘ç»œé…ç½®å‘½ä»¤
auditctl -w /bin/netstat -p x -k network_commands
auditctl -w /sbin/ip -p x -k network_commands
auditctl -w /sbin/ifconfig -p x -k network_commands

# ç›‘æ§ç”¨æˆ·ç®¡ç†å‘½ä»¤
auditctl -w /usr/sbin/useradd -p x -k user_management
auditctl -w /usr/sbin/userdel -p x -k user_management
auditctl -w /usr/sbin/usermod -p x -k user_management
```

**ğŸ”¸ å±é™©å‘½ä»¤ç›‘æ§**
```bash
# ç›‘æ§åˆ é™¤å‘½ä»¤
auditctl -w /bin/rm -p x -k file_deletion
auditctl -w /bin/rmdir -p x -k dir_deletion

# ç›‘æ§ç³»ç»Ÿå…³æœºé‡å¯
auditctl -w /sbin/shutdown -p x -k system_shutdown
auditctl -w /sbin/reboot -p x -k system_reboot
```

### 6.5 ç‰¹å®šç”¨æˆ·ç›‘æ§


**ğŸ”¸ æŒ‰ç”¨æˆ·IDç›‘æ§**
```bash
# ç›‘æ§ç‰¹å®šç”¨æˆ·çš„æ‰€æœ‰ç³»ç»Ÿè°ƒç”¨ï¼ˆUID=1000ï¼‰
auditctl -a always,exit -S all -F uid=1000 -k user_1000_activity

# ç›‘æ§ç”¨æˆ·ç»„æ´»åŠ¨ï¼ˆGID=wheelï¼‰
auditctl -a always,exit -S all -F gid=10 -k wheel_group_activity

# ç›‘æ§æ¥è‡ªç‰¹å®šç»ˆç«¯çš„æ“ä½œ
auditctl -a always,exit -S all -F devminor=1 -k tty1_activity
```

**ğŸ”¸ ä¼šè¯ç›‘æ§é…ç½®**
åœ¨ `/etc/profile.d/` åˆ›å»ºå®¡è®¡è„šæœ¬ï¼š
```bash
# åˆ›å»ºç”¨æˆ·ä¼šè¯å®¡è®¡è„šæœ¬
cat > /etc/profile.d/audit-session.sh << 'EOF'
# è®°å½•ç”¨æˆ·ä¼šè¯å¼€å§‹
logger -p local0.notice "User $USER session started on $(tty) from $SSH_CONNECTION"

# è®¾ç½®å‘½ä»¤å†å²å®¡è®¡
export HISTTIMEFORMAT="%F %T "
export HISTSIZE=10000
export HISTFILESIZE=10000
EOF
```

---

## 7. ğŸ“Š å®¡è®¡æ—¥å¿—åˆ†æ


### 7.1 å®¡è®¡æ—¥å¿—æ ¼å¼


**ğŸ”¸ å®¡è®¡æ—¥å¿—ç»“æ„**
å®¡è®¡æ—¥å¿—å°±åƒä¸€æœ¬è¯¦ç»†çš„"æ“ä½œè®°å½•å†Œ"ï¼Œè®°å½•äº†ç³»ç»Ÿä¸­å‘ç”Ÿçš„æ¯ä¸ªé‡è¦äº‹ä»¶ã€‚æ¯æ¡è®°å½•éƒ½åŒ…å«äº†äº‹ä»¶å‘ç”Ÿçš„æ—¶é—´ã€åœ°ç‚¹ã€äººç‰©å’Œå…·ä½“æ“ä½œã€‚

**ğŸ”¸ å…¸å‹å®¡è®¡è®°å½•æ ¼å¼**
```
type=TYPE msg=audit(æ—¶é—´æˆ³:åºåˆ—å·): å…·ä½“å®¡è®¡ä¿¡æ¯
```

ç¤ºä¾‹ï¼š
```
type=SYSCALL msg=audit(1640995200.123:456): arch=c000003e syscall=2 success=yes exit=3 a0=7fff12345678 a1=0 a2=1b6 a3=0 items=1 ppid=1234 pid=5678 auid=1000 uid=1000 gid=1000 euid=1000 suid=1000 fsuid=1000 egid=1000 sgid=1000 fsgid=1000 tty=pts0 ses=2 comm="cat" exe="/bin/cat" key="file_access"
```

### 7.2 å®¡è®¡æ—¥å¿—æŸ¥çœ‹


**ğŸ”¸ åŸºæœ¬æŸ¥çœ‹å‘½ä»¤**
```bash
# æŸ¥çœ‹å®¡è®¡æ—¥å¿—
sudo tail -f /var/log/audit/audit.log     # å®æ—¶æŸ¥çœ‹
sudo less /var/log/audit/audit.log        # åˆ†é¡µæŸ¥çœ‹
sudo grep "æŸä¸ªå…³é”®å­—" /var/log/audit/audit.log  # æœç´¢ç‰¹å®šå†…å®¹
```

**ğŸ”¸ ä½¿ç”¨ausearchå·¥å…·**
`ausearch`æ˜¯ä¸“é—¨ç”¨æ¥æœç´¢å’Œåˆ†æå®¡è®¡æ—¥å¿—çš„å·¥å…·ï¼Œæ¯”ç›´æ¥ç”¨grepæ›´å¼ºå¤§ï¼š

```bash
# æŒ‰æ—¶é—´æœç´¢
sudo ausearch -ts today                    # ä»Šå¤©çš„è®°å½•
sudo ausearch -ts 10:00 -te 11:00         # 10ç‚¹åˆ°11ç‚¹çš„è®°å½•
sudo ausearch -ts recent                   # æœ€è¿‘10åˆ†é’Ÿçš„è®°å½•

# æŒ‰ç”¨æˆ·æœç´¢
sudo ausearch -uid 1000                    # ç‰¹å®šç”¨æˆ·IDçš„æ“ä½œ
sudo ausearch -loginuid 1000               # ç‰¹å®šç™»å½•ç”¨æˆ·çš„æ“ä½œ

# æŒ‰äº‹ä»¶ç±»å‹æœç´¢
sudo ausearch -m SYSCALL                   # ç³»ç»Ÿè°ƒç”¨äº‹ä»¶
sudo ausearch -m USER_LOGIN               # ç”¨æˆ·ç™»å½•äº‹ä»¶
sudo ausearch -m PATH                     # æ–‡ä»¶è·¯å¾„äº‹ä»¶
```

### 7.3 æ—¥å¿—åˆ†æå®ä¾‹


**ğŸ”¸ æ–‡ä»¶è®¿é—®åˆ†æ**
```bash
# æŸ¥çœ‹ç‰¹å®šæ–‡ä»¶çš„è®¿é—®è®°å½•
sudo ausearch -f /etc/passwd

# æŸ¥çœ‹æ–‡ä»¶åˆ é™¤æ“ä½œ
sudo ausearch -k file_delete

# æŸ¥çœ‹æƒé™ä¿®æ”¹æ“ä½œ
sudo ausearch -k perm_mod
```

**ğŸ”¸ ç”¨æˆ·è¡Œä¸ºåˆ†æ**
```bash
# æŸ¥çœ‹ç”¨æˆ·ç™»å½•è®°å½•
sudo ausearch -m USER_LOGIN -ui 1000

# æŸ¥çœ‹sudoä½¿ç”¨è®°å½•
sudo ausearch -k sudo_usage

# æŸ¥çœ‹ç‰¹å®šæ—¶é—´æ®µå†…ç”¨æˆ·çš„æ‰€æœ‰æ“ä½œ
sudo ausearch -ts 09:00 -te 17:00 -uid 1000
```

### 7.4 ä½¿ç”¨aureportç”ŸæˆæŠ¥å‘Š


**ğŸ”¸ ä»€ä¹ˆæ˜¯aureport**
`aureport`å·¥å…·å¯ä»¥ä»å®¡è®¡æ—¥å¿—ä¸­ç”Ÿæˆå„ç§ç»Ÿè®¡æŠ¥å‘Šï¼Œå°±åƒä»åŸå§‹æ•°æ®ä¸­æå–æ‘˜è¦ä¿¡æ¯ã€‚

**ğŸ”¸ å¸¸ç”¨æŠ¥å‘Šç±»å‹**
```bash
# ç”Ÿæˆç»¼åˆæŠ¥å‘Š
sudo aureport

# ç”¨æˆ·æ´»åŠ¨æŠ¥å‘Š
sudo aureport -u                          # ç”¨æˆ·ç»Ÿè®¡
sudo aureport -l                          # ç™»å½•æŠ¥å‘Š

# æ–‡ä»¶è®¿é—®æŠ¥å‘Š  
sudo aureport -f                          # æ–‡ä»¶è®¿é—®ç»Ÿè®¡
sudo aureport -x                          # å¯æ‰§è¡Œæ–‡ä»¶æŠ¥å‘Š

# ç³»ç»Ÿè°ƒç”¨æŠ¥å‘Š
sudo aureport -s                          # ç³»ç»Ÿè°ƒç”¨ç»Ÿè®¡
sudo aureport -i                          # è§£é‡Šæ¨¡å¼ï¼ˆæ˜¾ç¤ºåç§°è€Œéæ•°å­—ï¼‰
```

### 7.5 æ—¥å¿—åˆ†æè„šæœ¬


**ğŸ”¸ è‡ªå®šä¹‰åˆ†æè„šæœ¬**
åˆ›å»ºç®€å•çš„æ—¥å¿—åˆ†æè„šæœ¬æ¥æå–å…³é”®ä¿¡æ¯ï¼š

```bash
#!/bin/bash
# å®¡è®¡æ—¥å¿—åˆ†æè„šæœ¬

echo "=== ä»Šæ—¥å®¡è®¡æ—¥å¿—æ‘˜è¦ ==="

# ç»Ÿè®¡ä»Šæ—¥ç™»å½•æ¬¡æ•°
echo "ç™»å½•æ¬¡æ•°ç»Ÿè®¡ï¼š"
sudo ausearch -ts today -m USER_LOGIN | grep "res=success" | wc -l

# ç»Ÿè®¡ä»Šæ—¥sudoä½¿ç”¨æ¬¡æ•°  
echo "sudoä½¿ç”¨æ¬¡æ•°ï¼š"
sudo ausearch -ts today -k sudo_usage | wc -l

# ç»Ÿè®¡ä»Šæ—¥æ–‡ä»¶ä¿®æ”¹æ¬¡æ•°
echo "æ–‡ä»¶ä¿®æ”¹æ¬¡æ•°ï¼š"
sudo ausearch -ts today -k file_changes | wc -l

# åˆ—å‡ºä»Šæ—¥æ´»è·ƒç”¨æˆ·
echo "æ´»è·ƒç”¨æˆ·åˆ—è¡¨ï¼š"
sudo ausearch -ts today -m SYSCALL | grep -o "uid=[0-9]*" | sort | uniq -c | sort -nr
```

---

## 8. ğŸ’¾ å®¡è®¡æ•°æ®ç®¡ç†


### 8.1 æ—¥å¿—è½®è½¬ç®¡ç†


**ğŸ”¸ ä¸ºä»€ä¹ˆéœ€è¦æ—¥å¿—è½®è½¬**
å®¡è®¡æ—¥å¿—ä¼šæŒç»­å¢é•¿ï¼Œå°±åƒæ°´é¾™å¤´ä¸€ç›´åœ¨æ»´æ°´ï¼Œæ—¶é—´é•¿äº†ä¼šæŠŠå®¹å™¨è£…æ»¡ã€‚æ—¥å¿—è½®è½¬å°±æ˜¯å®šæœŸ"æ¢ä¸€ä¸ªæ–°å®¹å™¨"ï¼Œé¿å…å•ä¸ªæ—¥å¿—æ–‡ä»¶è¿‡å¤§ï¼ŒåŒæ—¶ä¿ç•™ä¸€å®šæ—¶é—´çš„å†å²è®°å½•ã€‚

**ğŸ”¸ auditdè‡ªå¸¦çš„è½®è½¬æœºåˆ¶**
åœ¨ `/etc/audit/auditd.conf` ä¸­é…ç½®ï¼š
```bash
# æ—¥å¿—æ–‡ä»¶å¤§å°é™åˆ¶ï¼ˆMBï¼‰
max_log_file = 50

# æ–‡ä»¶æ»¡æ—¶çš„å¤„ç†åŠ¨ä½œ
max_log_file_action = ROTATE

# ä¿ç•™çš„æ—¥å¿—æ–‡ä»¶æ•°é‡
num_logs = 10

# æ€»çš„æ—¥å¿—ç©ºé—´é™åˆ¶
space_left = 100          # å‰©ä½™ç©ºé—´å°äº100MBæ—¶å‘Šè­¦
space_left_action = EMAIL  # å‘Šè­¦åŠ¨ä½œ
```

### 8.2 æ—¥å¿—å‹ç¼©ä¸å½’æ¡£


**ğŸ”¸ ä½¿ç”¨logrotateç®¡ç†**
åˆ›å»º `/etc/logrotate.d/audit` é…ç½®æ–‡ä»¶ï¼š
```bash
/var/log/audit/audit.log {
    daily                    # æ¯å¤©è½®è½¬
    missingok               # æ–‡ä»¶ä¸å­˜åœ¨æ—¶ä¸æŠ¥é”™
    rotate 90               # ä¿ç•™90ä¸ªå†å²æ–‡ä»¶
    compress                # å‹ç¼©å†å²æ–‡ä»¶
    delaycompress          # å»¶è¿Ÿå‹ç¼©ï¼ˆä¸‹æ¬¡è½®è½¬æ—¶å‹ç¼©ï¼‰
    copytruncate           # å¤åˆ¶åæˆªæ–­ï¼ˆé€‚ç”¨äºæŒç»­å†™å…¥çš„æ–‡ä»¶ï¼‰
    create 0640 root root  # åˆ›å»ºæ–°æ–‡ä»¶çš„æƒé™å’Œæ‰€æœ‰è€…
}
```

**ğŸ”¸ æ‰‹åŠ¨å‹ç¼©å†å²æ—¥å¿—**
```bash
# å‹ç¼©æŒ‡å®šæ—¥æœŸçš„æ—¥å¿—
sudo gzip /var/log/audit/audit.log.1

# æ‰¹é‡å‹ç¼©å†å²æ—¥å¿—
sudo find /var/log/audit/ -name "audit.log.*" -type f ! -name "*.gz" -exec gzip {} \;
```

### 8.3 æ—¥å¿—å¤‡ä»½ç­–ç•¥


**ğŸ”¸ æœ¬åœ°å¤‡ä»½æ–¹æ¡ˆ**
```bash
#!/bin/bash
# å®¡è®¡æ—¥å¿—å¤‡ä»½è„šæœ¬

BACKUP_DIR="/backup/audit"
DATE=$(date +%Y%m%d)

# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p "$BACKUP_DIR"

# å¤‡ä»½å½“å‰æ—¥å¿—
sudo cp -r /var/log/audit/ "$BACKUP_DIR/audit_$DATE"

# å‹ç¼©å¤‡ä»½
tar -czf "$BACKUP_DIR/audit_$DATE.tar.gz" -C "$BACKUP_DIR" "audit_$DATE"

# åˆ é™¤ä¸´æ—¶ç›®å½•
rm -rf "$BACKUP_DIR/audit_$DATE"

# æ¸…ç†30å¤©å‰çš„å¤‡ä»½
find "$BACKUP_DIR" -name "audit_*.tar.gz" -mtime +30 -delete
```

**ğŸ”¸ è¿œç¨‹å¤‡ä»½æ–¹æ¡ˆ**
```bash
# ä½¿ç”¨rsyncåŒæ­¥åˆ°è¿œç¨‹æœåŠ¡å™¨
sudo rsync -avz --delete /var/log/audit/ backup-server:/backup/$(hostname)/audit/

# ä½¿ç”¨scpä¼ è¾“å‹ç¼©åŒ…
tar -czf - /var/log/audit/ | ssh backup-server "cat > /backup/$(hostname)/audit_$(date +%Y%m%d).tar.gz"
```

### 8.4 æ—¥å¿—æ¸…ç†ç­–ç•¥


**ğŸ”¸ åŸºäºæ—¶é—´çš„æ¸…ç†**
```bash
# åˆ é™¤30å¤©å‰çš„å®¡è®¡æ—¥å¿—
sudo find /var/log/audit/ -name "audit.log.*" -mtime +30 -delete

# åˆ é™¤90å¤©å‰çš„å‹ç¼©æ—¥å¿—
sudo find /var/log/audit/ -name "*.gz" -mtime +90 -delete
```

**ğŸ”¸ åŸºäºç£ç›˜ç©ºé—´çš„æ¸…ç†**
```bash
#!/bin/bash
# åŸºäºç£ç›˜ä½¿ç”¨ç‡çš„æ—¥å¿—æ¸…ç†

THRESHOLD=85  # ç£ç›˜ä½¿ç”¨ç‡é˜ˆå€¼
CURRENT_USAGE=$(df /var/log/audit | tail -1 | awk '{print $5}' | sed 's/%//')

if [ "$CURRENT_USAGE" -gt "$THRESHOLD" ]; then
    echo "ç£ç›˜ä½¿ç”¨ç‡è¶…è¿‡ ${THRESHOLD}%ï¼Œå¼€å§‹æ¸…ç†æ—§æ—¥å¿—"
    # åˆ é™¤æœ€æ—§çš„æ—¥å¿—æ–‡ä»¶
    sudo find /var/log/audit/ -name "audit.log.*" -type f -exec ls -t {} + | tail -5 | xargs rm -f
fi
```

### 8.5 æ—¥å¿—å®Œæ•´æ€§ä¿æŠ¤


**ğŸ”¸ æ—¥å¿—ç­¾åéªŒè¯**
```bash
# ä¸ºæ—¥å¿—æ–‡ä»¶ç”ŸæˆMD5æ ¡éªŒå’Œ
sudo md5sum /var/log/audit/audit.log > /var/log/audit/audit.log.md5

# éªŒè¯æ—¥å¿—æ–‡ä»¶å®Œæ•´æ€§
sudo md5sum -c /var/log/audit/audit.log.md5
```

**ğŸ”¸ ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿæ‰©å±•å±æ€§**
```bash
# è®¾ç½®æ—¥å¿—æ–‡ä»¶ä¸ºä»…è¿½åŠ 
sudo chattr +a /var/log/audit/audit.log

# æŸ¥çœ‹æ–‡ä»¶å±æ€§
sudo lsattr /var/log/audit/audit.log
```

> ğŸ’¡ **å®‰å…¨å»ºè®®**  
> å°†å®¡è®¡æ—¥å¿—å¤‡ä»½åˆ°ç‹¬ç«‹çš„ç³»ç»Ÿæˆ–å­˜å‚¨è®¾å¤‡ä¸Šï¼Œé¿å…æ”»å‡»è€…åŒæ—¶ç ´ååŸå§‹ç³»ç»Ÿå’Œå¤‡ä»½ç³»ç»Ÿã€‚å®šæœŸéªŒè¯å¤‡ä»½çš„å®Œæ•´æ€§å’Œå¯æ¢å¤æ€§ã€‚

---

## 9. ğŸ“‹ åˆè§„å®¡è®¡æŠ¥å‘Š


### 9.1 åˆè§„å®¡è®¡æ¦‚è¿°


**ğŸ”¸ ä»€ä¹ˆæ˜¯åˆè§„å®¡è®¡**
åˆè§„å®¡è®¡å°±åƒä¼ä¸šçš„"å¹´åº¦ä½“æ£€æŠ¥å‘Š"ï¼Œé€šè¿‡åˆ†æç³»ç»Ÿå®¡è®¡æ•°æ®ï¼Œç”Ÿæˆç¬¦åˆæ³•è§„å’Œæ ‡å‡†è¦æ±‚çš„æŠ¥å‘Šã€‚è¿™äº›æŠ¥å‘Šè¯æ˜ç»„ç»‡éµå¾ªäº†ç›¸å…³çš„å®‰å…¨æ”¿ç­–å’Œæ³•è§„è¦æ±‚ã€‚

**ğŸ”¸ å¸¸è§åˆè§„æ ‡å‡†**
```
SOXæ³•æ¡ˆï¼šè´¢åŠ¡æŠ¥å‘Šå†…éƒ¨æ§åˆ¶
PCI-DSSï¼šæ”¯ä»˜å¡è¡Œä¸šæ•°æ®å®‰å…¨æ ‡å‡†  
HIPAAï¼šå¥åº·ä¿é™©ä¿¡æ¯ä¿æŠ¤æ³•
ISO 27001ï¼šä¿¡æ¯å®‰å…¨ç®¡ç†ä½“ç³»
ç­‰ä¿åˆè§„ï¼šç½‘ç»œå®‰å…¨ç­‰çº§ä¿æŠ¤
```

### 9.2 æŠ¥å‘Šç”Ÿæˆå·¥å…·


**ğŸ”¸ ä½¿ç”¨aureportç”ŸæˆåŸºç¡€æŠ¥å‘Š**
```bash
# ç”Ÿæˆç”¨æˆ·æ´»åŠ¨æŠ¥å‘Š
sudo aureport -u --summary -i > user_activity_report.txt

# ç”Ÿæˆæ–‡ä»¶è®¿é—®æŠ¥å‘Š
sudo aureport -f --summary -i > file_access_report.txt

# ç”Ÿæˆç™»å½•æŠ¥å‘Š
sudo aureport -l --summary -i > login_report.txt

# ç”Ÿæˆç³»ç»Ÿè°ƒç”¨æŠ¥å‘Š
sudo aureport -s --summary -i > syscall_report.txt
```

**ğŸ”¸ ç”Ÿæˆæ—¶é—´èŒƒå›´æŠ¥å‘Š**
```bash
# ç”Ÿæˆæœ¬æœˆçš„ç»¼åˆæŠ¥å‘Š
sudo aureport --start this-month --end now -i > monthly_report.txt

# ç”Ÿæˆç‰¹å®šæ—¥æœŸèŒƒå›´çš„æŠ¥å‘Š
sudo aureport --start 01/01/2024 --end 01/31/2024 -i > january_report.txt
```

### 9.3 è‡ªå®šä¹‰æŠ¥å‘Šè„šæœ¬


**ğŸ”¸ ç»¼åˆåˆè§„æŠ¥å‘Šè„šæœ¬**
```bash
#!/bin/bash
# åˆè§„å®¡è®¡æŠ¥å‘Šç”Ÿæˆè„šæœ¬

REPORT_DIR="/var/reports/audit"
DATE=$(date +%Y%m%d)
REPORT_FILE="$REPORT_DIR/compliance_report_$DATE.html"

# åˆ›å»ºæŠ¥å‘Šç›®å½•
mkdir -p "$REPORT_DIR"

# ç”ŸæˆHTMLæŠ¥å‘Šå¤´éƒ¨
cat > "$REPORT_FILE" << EOF
<!DOCTYPE html>
<html>
<head>
    <title>ç³»ç»Ÿå®¡è®¡åˆè§„æŠ¥å‘Š - $(date +%Y-%m-%d)</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .summary { background-color: #e7f3ff; padding: 15px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>ç³»ç»Ÿå®¡è®¡åˆè§„æŠ¥å‘Š</h1>
    <div class="summary">
        <h2>æŠ¥å‘Šæ‘˜è¦</h2>
        <p>ç”Ÿæˆæ—¶é—´: $(date)</p>
        <p>æŠ¥å‘Šå‘¨æœŸ: $(date -d '7 days ago' +%Y-%m-%d) è‡³ $(date +%Y-%m-%d)</p>
        <p>ç³»ç»Ÿåç§°: $(hostname)</p>
    </div>
EOF

# æ·»åŠ ç”¨æˆ·æ´»åŠ¨ç»Ÿè®¡
echo "<h2>ç”¨æˆ·æ´»åŠ¨ç»Ÿè®¡</h2>" >> "$REPORT_FILE"
echo "<table>" >> "$REPORT_FILE"
echo "<tr><th>ç”¨æˆ·ID</th><th>ç™»å½•æ¬¡æ•°</th><th>æ“ä½œæ¬¡æ•°</th></tr>" >> "$REPORT_FILE"

# è¿™é‡Œæ·»åŠ å…·ä½“çš„ç»Ÿè®¡é€»è¾‘
sudo ausearch -ts week-ago -m USER_LOGIN | grep "res=success" | \
grep -o "uid=[0-9]*" | sort | uniq -c | \
while read count uid; do
    uid_num=$(echo $uid | cut -d= -f2)
    username=$(getent passwd $uid_num | cut -d: -f1)
    echo "<tr><td>$username ($uid_num)</td><td>$count</td><td>-</td></tr>" >> "$REPORT_FILE"
done

echo "</table>" >> "$REPORT_FILE"
echo "</body></html>" >> "$REPORT_FILE"

echo "æŠ¥å‘Šå·²ç”Ÿæˆ: $REPORT_FILE"
```

### 9.4 é‡ç‚¹ç›‘æ§æŒ‡æ ‡


**ğŸ”¸ å®‰å…¨ç›¸å…³æŒ‡æ ‡**
```bash
# ç»Ÿè®¡ç™»å½•å¤±è´¥æ¬¡æ•°
sudo ausearch -ts today -m USER_LOGIN | grep "res=failed" | wc -l

# ç»Ÿè®¡æƒé™æå‡æ“ä½œ
sudo ausearch -ts today -k sudo_usage | wc -l

# ç»Ÿè®¡ç³»ç»Ÿé…ç½®ä¿®æ”¹
sudo ausearch -ts today -k config_changes | wc -l

# ç»Ÿè®¡å¼‚å¸¸æ—¶é—´æ®µçš„æ“ä½œï¼ˆå¦‚æ·±å¤œæ´»åŠ¨ï¼‰
sudo ausearch -ts today | grep -E "(0[0-5]:|2[2-3]:)" | wc -l
```

**ğŸ”¸ åˆè§„æ€§æ£€æŸ¥é¡¹ç›®**
```bash
# æ£€æŸ¥å¯†ç æ–‡ä»¶è®¿é—®
echo "å¯†ç æ–‡ä»¶è®¿é—®æ¬¡æ•°:"
sudo ausearch -ts today -f /etc/shadow | wc -l

# æ£€æŸ¥ç³»ç»ŸæœåŠ¡å˜æ›´
echo "ç³»ç»ŸæœåŠ¡å˜æ›´æ¬¡æ•°:"
sudo ausearch -ts today -k service_changes | wc -l

# æ£€æŸ¥ç½‘ç»œé…ç½®å˜æ›´
echo "ç½‘ç»œé…ç½®å˜æ›´æ¬¡æ•°:"
sudo ausearch -ts today -k network_changes | wc -l
```

### 9.5 æŠ¥å‘Šè‡ªåŠ¨åŒ–


**ğŸ”¸ å®šæ—¶æŠ¥å‘Šç”Ÿæˆ**
åˆ›å»ºcrontabä»»åŠ¡å®šæœŸç”ŸæˆæŠ¥å‘Šï¼š
```bash
# ç¼–è¾‘crontab
sudo crontab -e

# æ·»åŠ å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å‘¨ä¸€æ—©ä¸Š8ç‚¹ç”ŸæˆæŠ¥å‘Šï¼‰
0 8 * * 1 /usr/local/bin/generate_compliance_report.sh

# æ¯æœˆæœ€åä¸€å¤©ç”Ÿæˆæœˆåº¦æŠ¥å‘Š
0 8 28-31 * * [ $(date -d tomorrow +\%d) -eq 1 ] && /usr/local/bin/generate_monthly_report.sh
```

**ğŸ”¸ æŠ¥å‘Šåˆ†å‘é…ç½®**
```bash
#!/bin/bash
# æŠ¥å‘Šåˆ†å‘è„šæœ¬

REPORT_FILE="$1"
EMAIL_LIST="security@company.com,audit@company.com"

# å‘é€é‚®ä»¶
mail -s "ç³»ç»Ÿå®¡è®¡åˆè§„æŠ¥å‘Š - $(date +%Y-%m-%d)" \
     -a "$REPORT_FILE" \
     "$EMAIL_LIST" < /dev/null

# ä¸Šä¼ åˆ°å…±äº«å­˜å‚¨
cp "$REPORT_FILE" /shared/compliance_reports/

echo "æŠ¥å‘Šå·²åˆ†å‘å®Œæˆ"
```

---

## 10. ğŸ“š æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 ç³»ç»Ÿå®¡è®¡å¿…æŒæ¡è¦ç‚¹


**ğŸ”¸ å®¡è®¡ç³»ç»Ÿæ ¸å¿ƒç†è§£**
```
å®¡è®¡æœ¬è´¨ï¼šè®°å½•ç³»ç»Ÿä¸­çš„é‡è¦æ“ä½œå’Œäº‹ä»¶
å®¡è®¡ä»·å€¼ï¼šå®‰å…¨ç›‘æ§ã€åˆè§„éµå¾ªã€æ•…éšœæ’æŸ¥ã€è´£ä»»è¿½æº¯
å®¡è®¡ç»„æˆï¼šå†…æ ¸å®¡è®¡æ¡†æ¶ + auditdæœåŠ¡ + å®¡è®¡è§„åˆ™ + æ—¥å¿—åˆ†æ
```

**ğŸ”¸ auditdæœåŠ¡ç®¡ç†è¦ç‚¹**
- **æœåŠ¡çŠ¶æ€**: ç¡®ä¿auditdæœåŠ¡æ­£å¸¸è¿è¡Œå¹¶å¼€æœºè‡ªå¯
- **é…ç½®æ–‡ä»¶**: ç†Ÿæ‚‰`/etc/audit/auditd.conf`çš„å…³é”®å‚æ•°
- **æ—¥å¿—ç®¡ç†**: åˆç†è®¾ç½®æ—¥å¿—æ–‡ä»¶å¤§å°å’Œè½®è½¬ç­–ç•¥
- **æ€§èƒ½å¹³è¡¡**: åœ¨å®‰å…¨éœ€æ±‚å’Œç³»ç»Ÿæ€§èƒ½ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ç‚¹

### 10.2 è§„åˆ™é…ç½®å®è·µè¦ç‚¹


**ğŸ”¸ è§„åˆ™è®¾è®¡åŸåˆ™**
```
ç›®æ ‡æ˜ç¡®ï¼šæ˜ç¡®è¦ç›‘æ§ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦ç›‘æ§
é€‚åº¦ç›‘æ§ï¼šé¿å…è¿‡åº¦ç›‘æ§å½±å“ç³»ç»Ÿæ€§èƒ½  
åˆ†ç±»ç®¡ç†ï¼šå°†ä¸åŒç±»å‹çš„è§„åˆ™åˆ†æ–‡ä»¶ç®¡ç†
æŒç»­ä¼˜åŒ–ï¼šæ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´è§„åˆ™é…ç½®
```

**ğŸ”¸ å¸¸ç”¨è§„åˆ™æ¨¡æ¿**
- **æ–‡ä»¶ç›‘æ§**: é‡è¦é…ç½®æ–‡ä»¶ã€æ•æ„Ÿæ•°æ®æ–‡ä»¶ã€ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶
- **ç”¨æˆ·è¡Œä¸º**: ç™»å½•æ´»åŠ¨ã€æƒé™æå‡ã€å…³é”®å‘½ä»¤æ‰§è¡Œ
- **ç³»ç»Ÿè°ƒç”¨**: æ–‡ä»¶æ“ä½œã€è¿›ç¨‹ç®¡ç†ã€æƒé™ä¿®æ”¹
- **ç½‘ç»œæ´»åŠ¨**: è¿æ¥å»ºç«‹ã€ç«¯å£ç›‘å¬ã€æ•°æ®ä¼ è¾“

### 10.3 æ—¥å¿—åˆ†ææŠ€èƒ½è¦ç‚¹


**ğŸ”¸ åˆ†æå·¥å…·æŒæ¡**
```
ausearchï¼šå¼ºå¤§çš„æ—¥å¿—æœç´¢å·¥å…·ï¼Œæ”¯æŒå¤šç§è¿‡æ»¤æ¡ä»¶
aureportï¼šç”Ÿæˆå„ç±»ç»Ÿè®¡æŠ¥å‘Šï¼Œä¾¿äºæ¦‚è§ˆå’Œåˆ†æ
è‡ªå®šä¹‰è„šæœ¬ï¼šé’ˆå¯¹ç‰¹å®šéœ€æ±‚ç¼–å†™åˆ†æè„šæœ¬
```

**ğŸ”¸ åˆ†ææ€è·¯æ–¹æ³•**
1. **æ—¶é—´ç»´åº¦**: æŒ‰æ—¶é—´æ®µåˆ†æç³»ç»Ÿæ´»åŠ¨æ¨¡å¼
2. **ç”¨æˆ·ç»´åº¦**: æŒ‰ç”¨æˆ·åˆ†ææ“ä½œè¡Œä¸ºå’Œæƒé™ä½¿ç”¨
3. **äº‹ä»¶ç»´åº¦**: æŒ‰äº‹ä»¶ç±»å‹åˆ†æç³»ç»Ÿå®‰å…¨çŠ¶å†µ
4. **è¶‹åŠ¿åˆ†æ**: é€šè¿‡å†å²æ•°æ®åˆ†æè¯†åˆ«å¼‚å¸¸æ¨¡å¼

### 10.4 æ•°æ®ç®¡ç†æœ€ä½³å®è·µ


**ğŸ”¸ å­˜å‚¨ç®¡ç†ç­–ç•¥**
- **å®¹é‡è§„åˆ’**: æ ¹æ®æ—¥å¿—äº§ç”Ÿé€Ÿåº¦åˆç†è§„åˆ’å­˜å‚¨ç©ºé—´
- **è½®è½¬ç­–ç•¥**: è®¾ç½®åˆé€‚çš„æ—¥å¿—è½®è½¬å‘¨æœŸå’Œä¿ç•™æœŸé™
- **å‹ç¼©å½’æ¡£**: ä½¿ç”¨å‹ç¼©æŠ€æœ¯èŠ‚çœå­˜å‚¨ç©ºé—´
- **å¤‡ä»½ä¿æŠ¤**: å»ºç«‹å¯é çš„æ—¥å¿—å¤‡ä»½å’Œæ¢å¤æœºåˆ¶

**ğŸ”¸ å®‰å…¨ä¿æŠ¤æªæ–½**
- **æƒé™æ§åˆ¶**: ä¸¥æ ¼æ§åˆ¶å®¡è®¡æ—¥å¿—çš„è®¿é—®æƒé™
- **å®Œæ•´æ€§ä¿æŠ¤**: ä½¿ç”¨æ ¡éªŒå’Œç­‰æœºåˆ¶ä¿æŠ¤æ—¥å¿—å®Œæ•´æ€§
- **é˜²ç¯¡æ”¹**: åˆ©ç”¨æ–‡ä»¶ç³»ç»Ÿç‰¹æ€§é˜²æ­¢æ—¥å¿—è¢«æ¶æ„ä¿®æ”¹

### 10.5 åˆè§„å®¡è®¡è¦æ±‚


**ğŸ”¸ åˆè§„æŠ¥å‘Šè¦ç´ **
- **æ´»åŠ¨ç»Ÿè®¡**: ç”¨æˆ·æ´»åŠ¨ã€ç³»ç»Ÿæ“ä½œã€å®‰å…¨äº‹ä»¶ç»Ÿè®¡
- **å¼‚å¸¸åˆ†æ**: è¯†åˆ«å’Œåˆ†æå¼‚å¸¸è¡Œä¸ºæ¨¡å¼
- **è¶‹åŠ¿æŠ¥å‘Š**: æ˜¾ç¤ºå®‰å…¨çŠ¶å†µçš„å˜åŒ–è¶‹åŠ¿
- **å»ºè®®æªæ–½**: åŸºäºåˆ†æç»“æœæå‡ºæ”¹è¿›å»ºè®®

**ğŸ”¸ è‡ªåŠ¨åŒ–å»ºè®¾**
- **å®šæ—¶ç”Ÿæˆ**: è‡ªåŠ¨åŒ–ç”Ÿæˆå®šæœŸåˆè§„æŠ¥å‘Š
- **å¼‚å¸¸å‘Šè­¦**: åŠæ—¶å‘ç°å’Œé€šæŠ¥å®‰å…¨å¼‚å¸¸
- **æ•°æ®ä¿ç•™**: æŒ‰åˆè§„è¦æ±‚ä¿ç•™å®¡è®¡æ•°æ®
- **è¯æ®é“¾**: ç»´æŠ¤å®Œæ•´çš„å®¡è®¡è¯æ®é“¾

---

**ğŸ¯ å­¦ä¹ è¦ç‚¹è®°å¿†**
- å®¡è®¡å¦‚ç›‘æ§ï¼Œè®°å½•ä¿å®‰å…¨
- è§„åˆ™è¦ç²¾å‡†ï¼Œæ€§èƒ½éœ€å¹³è¡¡  
- æ—¥å¿—é‡åˆ†æï¼Œå¼‚å¸¸æ—©å‘ç°
- æ•°æ®å¦¥ä¿å­˜ï¼Œåˆè§„æœ‰ä¿éšœ
- è‡ªåŠ¨åŒ–è¿ç»´ï¼Œæ•ˆç‡è´¨é‡åŒæå‡

**âš¡ å®è·µå»ºè®®**
1. **å¾ªåºæ¸è¿›**: ä»åŸºæœ¬è§„åˆ™å¼€å§‹ï¼Œé€æ­¥å®Œå–„ç›‘æ§ä½“ç³»
2. **æµ‹è¯•éªŒè¯**: æ–°è§„åˆ™å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ï¼Œå†éƒ¨ç½²åˆ°ç”Ÿäº§
3. **æŒç»­ç›‘æ§**: å®šæœŸæ£€æŸ¥å®¡è®¡ç³»ç»Ÿè¿è¡ŒçŠ¶å†µå’Œæ—¥å¿—è´¨é‡
4. **å›¢é˜Ÿåä½œ**: å»ºç«‹å®¡è®¡ç®¡ç†æµç¨‹ï¼Œæ˜ç¡®è´£ä»»åˆ†å·¥
5. **çŸ¥è¯†æ›´æ–°**: å…³æ³¨å®‰å…¨å¨èƒå˜åŒ–ï¼ŒåŠæ—¶æ›´æ–°ç›‘æ§ç­–ç•¥