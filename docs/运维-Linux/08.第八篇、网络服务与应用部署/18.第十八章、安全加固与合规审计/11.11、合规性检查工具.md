---
title: 11ã€åˆè§„æ€§æ£€æŸ¥å·¥å…·
---
## ğŸ“š ç›®å½•


1. [åˆè§„æ€§æ£€æŸ¥åŸºç¡€æ¦‚å¿µ](#1-åˆè§„æ€§æ£€æŸ¥åŸºç¡€æ¦‚å¿µ)
2. [CISåŸºå‡†æµ‹è¯•å·¥å…·](#2-CISåŸºå‡†æµ‹è¯•å·¥å…·)
3. [SCAPå®‰å…¨æ‰«æé…ç½®](#3-SCAPå®‰å…¨æ‰«æé…ç½®)
4. [OpenSCAPåˆè§„æ£€æŸ¥](#4-OpenSCAPåˆè§„æ£€æŸ¥)
5. [è‡ªå®šä¹‰åˆè§„è§„åˆ™ç¼–å†™](#5-è‡ªå®šä¹‰åˆè§„è§„åˆ™ç¼–å†™)
6. [åˆè§„æŠ¥å‘Šç”Ÿæˆä¸åˆ†æ](#6-åˆè§„æŠ¥å‘Šç”Ÿæˆä¸åˆ†æ)
7. [æŒç»­åˆè§„ç›‘æ§é…ç½®](#7-æŒç»­åˆè§„ç›‘æ§é…ç½®)
8. [åˆè§„é—®é¢˜ä¿®å¤æµç¨‹](#8-åˆè§„é—®é¢˜ä¿®å¤æµç¨‹)
9. [åˆè§„æ€§æ–‡æ¡£ç®¡ç†](#9-åˆè§„æ€§æ–‡æ¡£ç®¡ç†)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ›¡ï¸ åˆè§„æ€§æ£€æŸ¥åŸºç¡€æ¦‚å¿µ



### 1.1 ä»€ä¹ˆæ˜¯åˆè§„æ€§æ£€æŸ¥



**åˆè§„æ€§æ£€æŸ¥**æ˜¯æŒ‡æŒ‰ç…§ç‰¹å®šçš„å®‰å…¨æ ‡å‡†å’Œè§„èŒƒï¼Œå¯¹ç³»ç»Ÿé…ç½®è¿›è¡Œè¯„ä¼°å’ŒéªŒè¯çš„è¿‡ç¨‹ã€‚

**ğŸ¯ æ ¸å¿ƒç›®çš„**ï¼š
- ç¡®ä¿ç³»ç»Ÿç¬¦åˆå®‰å…¨æ ‡å‡†
- å‘ç°æ½œåœ¨çš„å®‰å…¨é£é™©
- æ»¡è¶³ç›‘ç®¡è¦æ±‚
- ç»´æŠ¤ç³»ç»Ÿå®‰å…¨åŸºçº¿

> ğŸ’¡ **é€šä¿—ç†è§£**ï¼šå°±åƒç»™æ±½è½¦åšå¹´æ£€ä¸€æ ·ï¼Œåˆè§„æ€§æ£€æŸ¥æ˜¯ç»™Linuxç³»ç»Ÿåš"å®‰å…¨ä½“æ£€"ï¼Œç¡®ä¿å„é¡¹é…ç½®éƒ½ç¬¦åˆå®‰å…¨æ ‡å‡†ã€‚

### 1.2 å¸¸è§åˆè§„æ ‡å‡†



**ğŸ”¸ ä¸»æµæ ‡å‡†æ¡†æ¶**ï¼š
```
CIS (Center for Internet Security)ï¼š
â€¢ æœ€å¹¿æ³›ä½¿ç”¨çš„å®‰å…¨é…ç½®åŸºå‡†
â€¢ æä¾›å…·ä½“çš„é…ç½®å»ºè®®
â€¢ åˆ†ä¸ºLevel 1å’ŒLevel 2

NIST (ç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶é™¢)ï¼š
â€¢ SP 800-53å®‰å…¨æ§åˆ¶æ¡†æ¶
â€¢ æ”¿åºœå’Œä¼ä¸šå¹¿æ³›é‡‡ç”¨

PCI DSS (æ”¯ä»˜å¡è¡Œä¸šæ•°æ®å®‰å…¨æ ‡å‡†)ï¼š
â€¢ å¤„ç†ä¿¡ç”¨å¡æ•°æ®çš„ç³»ç»Ÿå¿…é¡»éµå®ˆ
â€¢ ä¸¥æ ¼çš„å®‰å…¨è¦æ±‚

ISO 27001ï¼š
â€¢ å›½é™…ä¿¡æ¯å®‰å…¨ç®¡ç†æ ‡å‡†
â€¢ å…¨é¢çš„å®‰å…¨ç®¡ç†ä½“ç³»
```

### 1.3 åˆè§„æ£€æŸ¥çš„é‡è¦æ€§



| **æ–¹é¢** | **é‡è¦æ€§** | **å®é™…æ„ä¹‰** |
|---------|-----------|-------------|
| ğŸ›¡ï¸ **å®‰å…¨é˜²æŠ¤** | `é˜²èŒƒå®‰å…¨å¨èƒ` | åŠæ—¶å‘ç°é…ç½®æ¼æ´ï¼Œé˜²æ­¢æ”»å‡» |
| ğŸ“‹ **ç›‘ç®¡åˆè§„** | `æ»¡è¶³æ³•è§„è¦æ±‚` | é¿å…ç›‘ç®¡å¤„ç½šï¼Œé€šè¿‡å®¡è®¡ |
| ğŸ“Š **é£é™©ç®¡ç†** | `é‡åŒ–å®‰å…¨é£é™©` | å»ºç«‹å®‰å…¨åŸºçº¿ï¼ŒæŒç»­æ”¹è¿› |
| ğŸ’° **æˆæœ¬æ§åˆ¶** | `é™ä½å®‰å…¨æˆæœ¬` | é¢„é˜²å®‰å…¨äº‹ä»¶ï¼Œå‡å°‘æŸå¤± |

---

## 2. ğŸ† CISåŸºå‡†æµ‹è¯•å·¥å…·



### 2.1 CISåŸºå‡†æ¦‚è¿°



**CISåŸºå‡†**æ˜¯ç”±ç½‘ç»œå®‰å…¨ä¸“å®¶åˆ¶å®šçš„ç³»ç»Ÿé…ç½®å®‰å…¨æŒ‡å—ï¼Œè¢«å¹¿æ³›è®¤ä¸ºæ˜¯æœ€æƒå¨çš„å®‰å…¨é…ç½®æ ‡å‡†ã€‚

**ğŸ”¸ åŸºå‡†åˆ†çº§**ï¼š
```
Level 1 (åŸºç¡€çº§)ï¼š
â€¢ åŸºæœ¬å®‰å…¨é…ç½®
â€¢ å¯¹ç³»ç»ŸåŠŸèƒ½å½±å“è¾ƒå°
â€¢ æ‰€æœ‰ç¯å¢ƒéƒ½åº”å®æ–½

Level 2 (å¢å¼ºçº§)ï¼š
â€¢ æ›´ä¸¥æ ¼çš„å®‰å…¨é…ç½®
â€¢ å¯èƒ½å½±å“æŸäº›åŠŸèƒ½
â€¢ é«˜å®‰å…¨è¦æ±‚ç¯å¢ƒå®æ–½
```

### 2.2 CIS-CATå·¥å…·ä½¿ç”¨



**CIS-CAT** æ˜¯CISå®˜æ–¹æä¾›çš„åˆè§„è¯„ä¼°å·¥å…·ã€‚

**ğŸ”§ å®‰è£…å’Œé…ç½®**ï¼š
```bash
# ä¸‹è½½CIS-CATå·¥å…·

wget https://workbench.cisecurity.org/files/cis-cat-full-bundle.zip

# è§£å‹å·¥å…·åŒ…

unzip cis-cat-full-bundle.zip
cd CIS-CAT

# èµ‹äºˆæ‰§è¡Œæƒé™

chmod +x CIS-CAT.sh
```

**ğŸ’» åŸºæœ¬ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
# æŸ¥çœ‹æ”¯æŒçš„åŸºå‡†

./CIS-CAT.sh -l

# æ‰§è¡ŒåŸºå‡†è¯„ä¼°

./CIS-CAT.sh -b benchmarks/CIS_Red_Hat_Enterprise_Linux_8_Benchmark_v1.0.0-xccdf.xml

# ç”ŸæˆHTMLæŠ¥å‘Š

./CIS-CAT.sh -b benchmarks/CIS_Red_Hat_Enterprise_Linux_8_Benchmark_v1.0.0-xccdf.xml -r reports/
```

### 2.3 è‡ªåŠ¨åŒ–CISæ£€æŸ¥



**ğŸ“ åˆ›å»ºæ£€æŸ¥è„šæœ¬**ï¼š
```bash
#!/bin/bash

# CISåˆè§„è‡ªåŠ¨æ£€æŸ¥è„šæœ¬


BENCHMARK_PATH="/opt/cis-cat/benchmarks"
REPORT_PATH="/var/log/cis-compliance"
DATE=$(date +%Y%m%d_%H%M%S)

# åˆ›å»ºæŠ¥å‘Šç›®å½•

mkdir -p $REPORT_PATH

# æ‰§è¡ŒCISåŸºå‡†æ£€æŸ¥

./CIS-CAT.sh -b $BENCHMARK_PATH/CIS_CentOS_8_Benchmark.xml \
             -r $REPORT_PATH \
             -rn "CIS_Report_$DATE"

# æ£€æŸ¥ç»“æœå¹¶å‘é€é€šçŸ¥

if [ $? -eq 0 ]; then
    echo "CISåˆè§„æ£€æŸ¥å®Œæˆï¼ŒæŠ¥å‘Šå·²ç”Ÿæˆ"
#    # å¯ä»¥æ·»åŠ é‚®ä»¶é€šçŸ¥
else
    echo "CISåˆè§„æ£€æŸ¥å¤±è´¥"
fi
```

---

## 3. ğŸ” SCAPå®‰å…¨æ‰«æé…ç½®



### 3.1 SCAPåè®®ä»‹ç»



**SCAP** (Security Content Automation Protocol) æ˜¯ç¾å›½æ”¿åºœåˆ¶å®šçš„å®‰å…¨è‡ªåŠ¨åŒ–åè®®ï¼Œç”¨äºæ ‡å‡†åŒ–å®‰å…¨é…ç½®å’Œæ¼æ´ç®¡ç†ã€‚

**ğŸ”¸ SCAPç»„ä»¶**ï¼š
```
XCCDF (å¯æ‰©å±•é…ç½®æ£€æŸ¥è¡¨æè¿°æ ¼å¼)ï¼š
â€¢ å®šä¹‰å®‰å…¨é…ç½®è§„åˆ™
â€¢ æè¿°æ£€æŸ¥é€»è¾‘å’Œä¿®å¤å»ºè®®

OVAL (å¼€æ”¾æ¼æ´è¯„ä¼°è¯­è¨€)ï¼š
â€¢ æè¿°ç³»ç»ŸçŠ¶æ€æ£€æŸ¥
â€¢ æ ‡å‡†åŒ–çš„æµ‹è¯•å®šä¹‰

CVE (é€šç”¨æ¼æ´ç¼–å·)ï¼š
â€¢ å…¬å¼€çš„å®‰å…¨æ¼æ´æ•°æ®åº“
â€¢ ç»Ÿä¸€çš„æ¼æ´æ ‡è¯†ä½“ç³»
```

### 3.2 SCAPå·¥å…·å®‰è£…



**åœ¨RHEL/CentOSç³»ç»Ÿä¸Š**ï¼š
```bash
# å®‰è£…SCAPå·¥å…·åŒ…

yum install -y scap-security-guide openscap-scanner

# éªŒè¯å®‰è£…

oscap --version
```

**åœ¨Ubuntuç³»ç»Ÿä¸Š**ï¼š
```bash
# å®‰è£…SCAPå·¥å…·

apt-get update
apt-get install -y libopenscap8 scap-security-guide

# å®‰è£…æ‰«æå™¨

apt-get install -y openscap-utils
```

### 3.3 SCAPæ‰«æé…ç½®



**ğŸ“Š æŸ¥çœ‹å¯ç”¨çš„å®‰å…¨é…ç½®æ–‡ä»¶**ï¼š
```bash
# æŸ¥çœ‹ç³»ç»Ÿå¯ç”¨çš„SCAPå†…å®¹

ls /usr/share/scap-security-guide/

# æŸ¥çœ‹ç‰¹å®šç³»ç»Ÿçš„é…ç½®æ–‡ä»¶

oscap info /usr/share/scap-security-guide/ssg-rhel8-ds.xml
```

**ğŸ”§ æ‰§è¡ŒåŸºæœ¬SCAPæ‰«æ**ï¼š
```bash
# æ‰§è¡Œå®Œæ•´çš„å®‰å…¨æ‰«æ

oscap xccdf eval --profile xccdf_org.ssgproject.content_profile_cis \
      --results scan-results.xml \
      --report scan-report.html \
      /usr/share/scap-security-guide/ssg-rhel8-ds.xml

# æŸ¥çœ‹æ‰«æç»“æœ

firefox scan-report.html  # åœ¨å›¾å½¢ç•Œé¢ä¸­æŸ¥çœ‹
```

---

## 4. ğŸ“‹ OpenSCAPåˆè§„æ£€æŸ¥



### 4.1 OpenSCAPå·¥å…·ä»‹ç»



**OpenSCAP** æ˜¯å¼€æºçš„SCAPåè®®å®ç°ï¼Œæä¾›äº†å®Œæ•´çš„å®‰å…¨åˆè§„æ£€æŸ¥è§£å†³æ–¹æ¡ˆã€‚

**ğŸŒŸ ä¸»è¦åŠŸèƒ½**ï¼š
- é…ç½®åˆè§„æ€§è¯„ä¼°
- æ¼æ´æ‰«æ
- ç³»ç»ŸåŸºçº¿æ£€æŸ¥
- è‡ªåŠ¨åŒ–ä¿®å¤å»ºè®®

### 4.2 OpenSCAPåŸºæœ¬æ“ä½œ



**ğŸ”¸ ä¿¡æ¯æŸ¥è¯¢å‘½ä»¤**ï¼š
```bash
# æŸ¥çœ‹SCAPå†…å®¹ä¿¡æ¯

oscap info /usr/share/scap-security-guide/ssg-rhel8-ds.xml

# åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„é…ç½®æ–‡ä»¶

oscap info --profiles /usr/share/scap-security-guide/ssg-rhel8-ds.xml

# æŸ¥çœ‹ç‰¹å®šè§„åˆ™è¯¦æƒ…

oscap xccdf generate guide --profile cis /usr/share/scap-security-guide/ssg-rhel8-ds.xml > guide.html
```

### 4.3 è¯¦ç»†åˆè§„æ£€æŸ¥æµç¨‹



**æ­¥éª¤1ï¼šé€‰æ‹©åˆé€‚çš„é…ç½®æ–‡ä»¶**
```bash
# æŸ¥çœ‹CISé…ç½®æ–‡ä»¶

oscap info --profile cis /usr/share/scap-security-guide/ssg-rhel8-ds.xml

# æŸ¥çœ‹NISTé…ç½®æ–‡ä»¶

oscap info --profile nist-800-53 /usr/share/scap-security-guide/ssg-rhel8-ds.xml
```

**æ­¥éª¤2ï¼šæ‰§è¡Œåˆè§„æ‰«æ**
```bash
# æ‰§è¡ŒCIS Level 1æ£€æŸ¥

oscap xccdf eval \
    --profile xccdf_org.ssgproject.content_profile_cis_level1_server \
    --results results.xml \
    --report report.html \
    /usr/share/scap-security-guide/ssg-rhel8-ds.xml
```

**æ­¥éª¤3ï¼šåˆ†ææ‰«æç»“æœ**
```bash
# æŸ¥çœ‹æ‰«æç»Ÿè®¡

oscap xccdf generate stats results.xml

# ç”Ÿæˆä¿®å¤è„šæœ¬

oscap xccdf generate fix --profile cis_level1_server results.xml > fix.sh
```

### 4.4 é«˜çº§æ‰«æé…ç½®



**ğŸ¯ è‡ªå®šä¹‰æ‰«æé€‰é¡¹**ï¼š
```bash
# æŒ‡å®šç‰¹å®šè§„åˆ™è¿›è¡Œæ‰«æ

oscap xccdf eval \
    --rule xccdf_org.ssgproject.content_rule_accounts_password_minlen_login_defs \
    --results targeted-results.xml \
    /usr/share/scap-security-guide/ssg-rhel8-ds.xml

# æ’é™¤æŸäº›è§„åˆ™

oscap xccdf eval \
    --profile cis_level1_server \
    --skip-rule rule_id_to_skip \
    /usr/share/scap-security-guide/ssg-rhel8-ds.xml
```

---

## 5. âœï¸ è‡ªå®šä¹‰åˆè§„è§„åˆ™ç¼–å†™



### 5.1 XCCDFè§„åˆ™ç»“æ„



**XCCDFè§„åˆ™**æ˜¯åˆè§„æ£€æŸ¥çš„åŸºæœ¬å•ä½ï¼Œå®šä¹‰äº†å…·ä½“çš„æ£€æŸ¥é€»è¾‘å’Œä¿®å¤æ–¹æ³•ã€‚

**ğŸ”¸ è§„åˆ™åŸºæœ¬ç»“æ„**ï¼š
```xml
<Rule id="rule_custom_ssh_config" severity="medium">
    <title>è‡ªå®šä¹‰SSHé…ç½®æ£€æŸ¥</title>
    <description>æ£€æŸ¥SSHæœåŠ¡æ˜¯å¦æŒ‰ç…§å®‰å…¨è¦æ±‚é…ç½®</description>
    
    <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        <check-content-ref href="oval-definitions.xml" name="oval:custom:def:1"/>
    </check>
    
    <fix system="urn:xccdf:fix:system:bash">
        <fix-content>
#            # ä¿®å¤SSHé…ç½®
            sed -i 's/^#PermitRootLogin yes/PermitRootLogin no/' /etc/ssh/sshd_config
        </fix-content>
    </fix>
</Rule>
```

### 5.2 ç¼–å†™OVALæµ‹è¯•å®šä¹‰



**OVALå®šä¹‰**æè¿°äº†å…·ä½“çš„ç³»ç»ŸçŠ¶æ€æ£€æŸ¥é€»è¾‘ã€‚

**ğŸ’» OVALæµ‹è¯•ç¤ºä¾‹**ï¼š
```xml
<definition class="compliance" id="oval:custom:def:1" version="1">
    <metadata>
        <title>SSH Root Login Disabled</title>
        <description>æ£€æŸ¥SSHæ˜¯å¦ç¦ç”¨rootç™»å½•</description>
    </metadata>
    
    <criteria>
        <criterion test_ref="oval:custom:tst:1"/>
    </criteria>
</definition>

<ind:textfilecontent54_test id="oval:custom:tst:1" version="1" 
                            check="all" comment="æ£€æŸ¥SSHé…ç½®æ–‡ä»¶">
    <ind:object object_ref="oval:custom:obj:1"/>
    <ind:state state_ref="oval:custom:ste:1"/>
</ind:textfilecontent54_test>
```

### 5.3 ç®€åŒ–çš„è‡ªå®šä¹‰æ£€æŸ¥è„šæœ¬



å¯¹äºç®€å•çš„åˆè§„æ£€æŸ¥ï¼Œå¯ä»¥ç¼–å†™Bashè„šæœ¬ï¼š

```bash
#!/bin/bash

# è‡ªå®šä¹‰åˆè§„æ£€æŸ¥è„šæœ¬


# æ£€æŸ¥SSHé…ç½®

check_ssh_config() {
    echo "æ£€æŸ¥SSHå®‰å…¨é…ç½®..."
    
#    # æ£€æŸ¥rootç™»å½•æ˜¯å¦ç¦ç”¨
    if grep -q "^PermitRootLogin no" /etc/ssh/sshd_config; then
        echo "âœ… SSHç¦ç”¨rootç™»å½• - é€šè¿‡"
    else
        echo "âŒ SSHå…è®¸rootç™»å½• - å¤±è´¥"
    fi
    
#    # æ£€æŸ¥å¯†ç è®¤è¯
    if grep -q "^PasswordAuthentication no" /etc/ssh/sshd_config; then
        echo "âœ… SSHç¦ç”¨å¯†ç è®¤è¯ - é€šè¿‡"
    else
        echo "âš ï¸  SSHå…è®¸å¯†ç è®¤è¯ - è­¦å‘Š"
    fi
}

# æ£€æŸ¥é˜²ç«å¢™çŠ¶æ€

check_firewall() {
    echo "æ£€æŸ¥é˜²ç«å¢™çŠ¶æ€..."
    
    if systemctl is-active firewalld >/dev/null 2>&1; then
        echo "âœ… é˜²ç«å¢™å·²å¯åŠ¨ - é€šè¿‡"
    else
        echo "âŒ é˜²ç«å¢™æœªå¯åŠ¨ - å¤±è´¥"
    fi
}

# æ‰§è¡Œæ‰€æœ‰æ£€æŸ¥

echo "=== å¼€å§‹åˆè§„æ€§æ£€æŸ¥ ==="
check_ssh_config
check_firewall
echo "=== æ£€æŸ¥å®Œæˆ ==="
```

---

## 6. ğŸ“Š åˆè§„æŠ¥å‘Šç”Ÿæˆä¸åˆ†æ



### 6.1 æŠ¥å‘Šç±»å‹å’Œæ ¼å¼



**OpenSCAPæ”¯æŒå¤šç§æŠ¥å‘Šæ ¼å¼**ï¼š

| **æ ¼å¼** | **ç”¨é€”** | **ç‰¹ç‚¹** |
|---------|---------|---------|
| **HTML** | `äººå·¥æŸ¥çœ‹` | å›¾å½¢åŒ–ç•Œé¢ï¼Œæ˜“äºé˜…è¯» |
| **XML** | `ç¨‹åºå¤„ç†` | ç»“æ„åŒ–æ•°æ®ï¼Œä¾¿äºè§£æ |
| **TXT** | `ç®€å•è¾“å‡º` | çº¯æ–‡æœ¬æ ¼å¼ï¼Œè½»é‡çº§ |
| **JSON** | `APIé›†æˆ` | ç°ä»£æ ¼å¼ï¼Œä¾¿äºé›†æˆ |

### 6.2 ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š



**ğŸ”§ ç”Ÿæˆç»¼åˆæŠ¥å‘Š**ï¼š
```bash
# ç”Ÿæˆå®Œæ•´çš„HTMLæŠ¥å‘Š

oscap xccdf eval \
    --profile cis_level1_server \
    --results detailed-results.xml \
    --report detailed-report.html \
    --cpe cpe-dictionary.xml \
    /usr/share/scap-security-guide/ssg-rhel8-ds.xml

# ç”Ÿæˆä¿®å¤æŒ‡å—

oscap xccdf generate guide \
    --profile cis_level1_server \
    /usr/share/scap-security-guide/ssg-rhel8-ds.xml > compliance-guide.html
```

### 6.3 æŠ¥å‘Šåˆ†æå’Œè§£è¯»



**ğŸ” å…³é”®æŒ‡æ ‡è§£è¯»**ï¼š

```
åˆè§„å¾—åˆ†è®¡ç®—ï¼š
â€¢ é€šè¿‡çš„è§„åˆ™æ•° Ã· æ€»è§„åˆ™æ•° Ã— 100%
â€¢ æŒ‰ä¸¥é‡çº§åˆ«åŠ æƒè®¡ç®—
â€¢ è€ƒè™‘Not Applicableçš„è§„åˆ™

ç»“æœçŠ¶æ€è¯´æ˜ï¼š
âœ… Pass: è§„åˆ™æ£€æŸ¥é€šè¿‡
âŒ Fail: è§„åˆ™æ£€æŸ¥å¤±è´¥  
âš ï¸  Fixed: å·²è‡ªåŠ¨ä¿®å¤
â„¹ï¸  Not Applicable: ä¸é€‚ç”¨äºå½“å‰ç³»ç»Ÿ
â“ Not Checked: æœªæ‰§è¡Œæ£€æŸ¥
```

**ğŸ“ˆ æŠ¥å‘Šæ•°æ®æå–**ï¼š
```bash
# æå–æ‰«æç»Ÿè®¡ä¿¡æ¯

oscap xccdf generate stats results.xml

# è·å–å¤±è´¥è§„åˆ™åˆ—è¡¨

xpath -q -e "//rule-result[@result='fail']/@idref" results.xml

# ç”ŸæˆCSVæ ¼å¼çš„ç»“æœæ‘˜è¦

oscap xccdf generate report --format csv results.xml > summary.csv
```

---

## 7. ğŸ”„ æŒç»­åˆè§„ç›‘æ§é…ç½®



### 7.1 è‡ªåŠ¨åŒ–ç›‘æ§æ¶æ„



**ğŸ—ï¸ ç›‘æ§ç³»ç»Ÿæ¶æ„**ï¼š
```
å®šæ—¶ä»»åŠ¡ (Cron)
    â†“
åˆè§„æ‰«æè„šæœ¬
    â†“
ç»“æœå­˜å‚¨ (æ•°æ®åº“/æ–‡ä»¶)
    â†“
æŠ¥å‘Šç”Ÿæˆå’Œé€šçŸ¥
    â†“
ç®¡ç†å‘˜å¤„ç†
```

### 7.2 é…ç½®å®šæ—¶åˆè§„æ£€æŸ¥



**ğŸ“… è®¾ç½®å®šæ—¶ä»»åŠ¡**ï¼š
```bash
# åˆ›å»ºåˆè§„ç›‘æ§è„šæœ¬

cat > /opt/compliance-monitor.sh << 'EOF'
#!/bin/bash

DATE=$(date +%Y%m%d_%H%M%S)
REPORT_DIR="/var/log/compliance"
PROFILE="xccdf_org.ssgproject.content_profile_cis_level1_server"

mkdir -p $REPORT_DIR

# æ‰§è¡Œåˆè§„æ‰«æ

oscap xccdf eval \
    --profile $PROFILE \
    --results $REPORT_DIR/results_$DATE.xml \
    --report $REPORT_DIR/report_$DATE.html \
    /usr/share/scap-security-guide/ssg-rhel8-ds.xml

# æ£€æŸ¥åˆè§„çŠ¶æ€

SCORE=$(oscap xccdf generate stats $REPORT_DIR/results_$DATE.xml | grep -i score | cut -d: -f2)

# å‘é€é€šçŸ¥ï¼ˆå¦‚æœåˆè§„åˆ†æ•°ä½äºé˜ˆå€¼ï¼‰

if (( $(echo "$SCORE < 80" | bc -l) )); then
    echo "åˆè§„åˆ†æ•°è¿‡ä½: $SCORE%" | mail -s "åˆè§„æ£€æŸ¥è­¦å‘Š" admin@company.com
fi

# æ¸…ç†æ—§æŠ¥å‘Šï¼ˆä¿ç•™30å¤©ï¼‰

find $REPORT_DIR -name "*.xml" -mtime +30 -delete
find $REPORT_DIR -name "*.html" -mtime +30 -delete
EOF

chmod +x /opt/compliance-monitor.sh
```

**â° é…ç½®Cronå®šæ—¶ä»»åŠ¡**ï¼š
```bash
# ç¼–è¾‘crontab

crontab -e

# æ·»åŠ ä»¥ä¸‹è¡Œï¼ˆæ¯å‘¨æ—¥æ™šä¸Š2ç‚¹æ‰§è¡Œï¼‰

0 2 * * 0 /opt/compliance-monitor.sh

# æ¯æ—¥å¿«é€Ÿæ£€æŸ¥ï¼ˆä»…æ£€æŸ¥å…³é”®è§„åˆ™ï¼‰

0 6 * * * /opt/daily-compliance-check.sh
```

### 7.3 é›†æˆç›‘æ§å‘Šè­¦



**ğŸš¨ å‘Šè­¦é…ç½®ç¤ºä¾‹**ï¼š
```bash
#!/bin/bash

# compliance-alert.sh - åˆè§„å‘Šè­¦è„šæœ¬


check_compliance_threshold() {
    local results_file=$1
    local threshold=${2:-75}
    
#    # è®¡ç®—åˆè§„å¾—åˆ†
    local score=$(oscap xccdf generate stats $results_file | grep "Score:" | cut -d: -f2 | tr -d '%')
    
    if [ "$score" -lt "$threshold" ]; then
#        # å‘é€å‘Šè­¦
        cat << EOF | mail -s "åˆè§„æ£€æŸ¥å‘Šè­¦ - å¾—åˆ†: ${score}%" security-team@company.com
ç³»ç»Ÿåˆè§„æ£€æŸ¥å‘ç°é—®é¢˜ï¼š

æœåŠ¡å™¨: $(hostname)
æ£€æŸ¥æ—¶é—´: $(date)
åˆè§„å¾—åˆ†: ${score}%
é˜ˆå€¼: ${threshold}%

è¯·åŠæ—¶æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Šå¹¶å¤„ç†ç›¸å…³é—®é¢˜ã€‚

æŠ¥å‘Šä½ç½®: /var/log/compliance/
EOF
    fi
}
```

---

## 8. ğŸ”§ åˆè§„é—®é¢˜ä¿®å¤æµç¨‹



### 8.1 è‡ªåŠ¨ä¿®å¤æœºåˆ¶



**OpenSCAPæä¾›è‡ªåŠ¨ç”Ÿæˆä¿®å¤è„šæœ¬çš„åŠŸèƒ½**ï¼š

```bash
# ç”Ÿæˆä¿®å¤è„šæœ¬

oscap xccdf generate fix \
    --profile cis_level1_server \
    --template urn:xccdf:fix:script:sh \
    results.xml > remediation.sh

# æ£€æŸ¥ä¿®å¤è„šæœ¬å†…å®¹

less remediation.sh

# æ‰§è¡Œä¿®å¤ï¼ˆè°¨æ…æ“ä½œï¼‰

bash remediation.sh
```

### 8.2 ä¿®å¤æµç¨‹ç®¡ç†



**ğŸ”„ æ ‡å‡†ä¿®å¤æµç¨‹**ï¼š

```
1. é—®é¢˜è¯†åˆ«
   â†“
2. å½±å“è¯„ä¼°
   â†“  
3. ä¿®å¤è®¡åˆ’
   â†“
4. æµ‹è¯•ç¯å¢ƒéªŒè¯
   â†“
5. ç”Ÿäº§ç¯å¢ƒå®æ–½
   â†“
6. éªŒè¯ä¿®å¤ç»“æœ
   â†“
7. æ–‡æ¡£è®°å½•
```

**ğŸ“ ä¿®å¤è„šæœ¬æ¨¡æ¿**ï¼š
```bash
#!/bin/bash

# åˆè§„é—®é¢˜ä¿®å¤è„šæœ¬æ¨¡æ¿


# ä¿®å¤å‰å¤‡ä»½

backup_config() {
    local config_file=$1
    local backup_dir="/var/backups/compliance-fix-$(date +%Y%m%d)"
    
    mkdir -p $backup_dir
    cp $config_file $backup_dir/
    echo "å·²å¤‡ä»½ $config_file åˆ° $backup_dir"
}

# ä¿®å¤SSHé…ç½®

fix_ssh_config() {
    echo "ä¿®å¤SSHé…ç½®..."
    backup_config "/etc/ssh/sshd_config"
    
#    # ç¦ç”¨rootç™»å½•
    sed -i 's/^#PermitRootLogin yes/PermitRootLogin no/' /etc/ssh/sshd_config
    sed -i 's/^PermitRootLogin yes/PermitRootLogin no/' /etc/ssh/sshd_config
    
#    # é‡å¯SSHæœåŠ¡
    systemctl restart sshd
    echo "SSHé…ç½®ä¿®å¤å®Œæˆ"
}

# éªŒè¯ä¿®å¤ç»“æœ

verify_fix() {
    echo "éªŒè¯ä¿®å¤ç»“æœ..."
    
#    # é‡æ–°è¿è¡Œåˆè§„æ£€æŸ¥
    oscap xccdf eval --profile cis_level1_server \
        --results verify-results.xml \
        /usr/share/scap-security-guide/ssg-rhel8-ds.xml
    
    echo "éªŒè¯å®Œæˆï¼Œè¯·æŸ¥çœ‹ verify-results.xml"
}

# æ‰§è¡Œä¿®å¤

echo "=== å¼€å§‹åˆè§„é—®é¢˜ä¿®å¤ ==="
fix_ssh_config
verify_fix
echo "=== ä¿®å¤å®Œæˆ ==="
```

### 8.3 ä¿®å¤éªŒè¯å’Œå›æ»š



**âœ… ä¿®å¤åéªŒè¯**ï¼š
```bash
# éªŒè¯ä¿®å¤æ•ˆæœ

oscap xccdf eval --profile cis_level1_server \
    --results post-fix-results.xml \
    --report post-fix-report.html \
    /usr/share/scap-security-guide/ssg-rhel8-ds.xml

# å¯¹æ¯”ä¿®å¤å‰åçš„ç»“æœ

diff <(xpath -q -e "//rule-result/@result" pre-fix-results.xml) \
     <(xpath -q -e "//rule-result/@result" post-fix-results.xml)
```

---

## 9. ğŸ“ åˆè§„æ€§æ–‡æ¡£ç®¡ç†



### 9.1 æ–‡æ¡£ç®¡ç†ä½“ç³»



**ğŸ—‚ï¸ åˆè§„æ–‡æ¡£åˆ†ç±»**ï¼š

| **æ–‡æ¡£ç±»å‹** | **å†…å®¹** | **æ›´æ–°é¢‘ç‡** |
|------------|----------|------------|
| **æ”¿ç­–æ–‡æ¡£** | `å®‰å…¨ç­–ç•¥ã€åˆè§„è¦æ±‚` | å¹´åº¦æ›´æ–° |
| **ç¨‹åºæ–‡æ¡£** | `æ“ä½œæµç¨‹ã€æ£€æŸ¥æ¸…å•` | å­£åº¦å®¡æŸ¥ |
| **è®°å½•æ–‡æ¡£** | `æ‰«æç»“æœã€ä¿®å¤è®°å½•` | å®æ—¶æ›´æ–° |
| **è¯æ®æ–‡æ¡£** | `å®¡è®¡è¯æ®ã€åˆè§„è¯æ˜` | æŒ‰éœ€ç”Ÿæˆ |

### 9.2 è‡ªåŠ¨åŒ–æ–‡æ¡£ç”Ÿæˆ



**ğŸ“„ ç”Ÿæˆåˆè§„æŠ¥å‘Šæ–‡æ¡£**ï¼š
```bash
#!/bin/bash

# è‡ªåŠ¨ç”Ÿæˆåˆè§„æ–‡æ¡£


generate_compliance_document() {
    local date=$(date +%Y%m%d)
    local doc_dir="/opt/compliance-docs/$date"
    
    mkdir -p $doc_dir
    
#    # ç”Ÿæˆæ‰§è¡Œæ‘˜è¦
    cat > $doc_dir/executive-summary.md << EOF
# åˆè§„æ€§æ£€æŸ¥æ‰§è¡Œæ‘˜è¦


# æ£€æŸ¥æ¦‚å†µ


- æ£€æŸ¥æ—¥æœŸ: $(date)
- ç³»ç»Ÿä¿¡æ¯: $(uname -a)
- åˆè§„æ ‡å‡†: CIS Level 1 Server
- æ£€æŸ¥å·¥å…·: OpenSCAP

# åˆè§„çŠ¶æ€


EOF
    
#    # æ·»åŠ ç»Ÿè®¡ä¿¡æ¯
    oscap xccdf generate stats results.xml >> $doc_dir/executive-summary.md
    
#    # ç”Ÿæˆè¯¦ç»†æŠ€æœ¯æŠ¥å‘Š
    oscap xccdf generate report results.xml > $doc_dir/technical-report.html
    
#    # ç”Ÿæˆä¿®å¤å»ºè®®
    oscap xccdf generate fix results.xml > $doc_dir/remediation-guide.sh
    
    echo "åˆè§„æ–‡æ¡£å·²ç”Ÿæˆåˆ°: $doc_dir"
}
```

### 9.3 æ–‡æ¡£ç‰ˆæœ¬æ§åˆ¶



**ğŸ“š ä½¿ç”¨Gitç®¡ç†åˆè§„æ–‡æ¡£**ï¼š
```bash
# åˆå§‹åŒ–æ–‡æ¡£ä»“åº“

mkdir /opt/compliance-repository
cd /opt/compliance-repository
git init

# åˆ›å»ºæ–‡æ¡£ç»“æ„

mkdir -p {policies,procedures,reports,evidence}

# æ·»åŠ ç‰ˆæœ¬æ ‡ç­¾

git tag -a v1.0 -m "åˆå§‹åˆè§„åŸºçº¿"

# è‡ªåŠ¨æäº¤æŠ¥å‘Š

auto_commit_report() {
    local date=$(date +%Y%m%d)
    
#    # å¤åˆ¶æœ€æ–°æŠ¥å‘Š
    cp /var/log/compliance/report_*.html reports/
    
#    # æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
    git add reports/
    git commit -m "åˆè§„æ£€æŸ¥æŠ¥å‘Š - $date"
    
#    # å¦‚æœå‘ç°é‡å¤§é—®é¢˜ï¼Œåˆ›å»ºé—®é¢˜åˆ†æ”¯
    local critical_issues=$(grep -c "fail.*critical" reports/latest-report.html)
    if [ "$critical_issues" -gt 0 ]; then
        git checkout -b "critical-fixes-$date"
        echo "åˆ›å»ºç´§æ€¥ä¿®å¤åˆ†æ”¯: critical-fixes-$date"
    fi
}
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“



### 10.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ



```
ğŸ”¸ åˆè§„æ€§æ£€æŸ¥ï¼šæŒ‰ç…§å®‰å…¨æ ‡å‡†è¯„ä¼°ç³»ç»Ÿé…ç½®
ğŸ”¸ CISåŸºå‡†ï¼šæœ€æƒå¨çš„ç³»ç»Ÿå®‰å…¨é…ç½®æ ‡å‡†
ğŸ”¸ SCAPåè®®ï¼šæ ‡å‡†åŒ–çš„å®‰å…¨è‡ªåŠ¨åŒ–åè®®
ğŸ”¸ OpenSCAPï¼šå¼€æºçš„åˆè§„æ£€æŸ¥å·¥å…·
ğŸ”¸ XCCDF/OVALï¼šåˆè§„è§„åˆ™çš„å®šä¹‰è¯­è¨€
```

### 10.2 å…³é”®æ“ä½œå‘½ä»¤



**ğŸ”§ å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥**ï¼š
```bash
# æŸ¥çœ‹å¯ç”¨é…ç½®æ–‡ä»¶

oscap info --profiles /usr/share/scap-security-guide/ssg-rhel8-ds.xml

# æ‰§è¡Œåˆè§„æ‰«æ

oscap xccdf eval --profile cis_level1_server \
    --results results.xml --report report.html \
    /usr/share/scap-security-guide/ssg-rhel8-ds.xml

# ç”Ÿæˆä¿®å¤è„šæœ¬

oscap xccdf generate fix results.xml > fix.sh

# æŸ¥çœ‹æ‰«æç»Ÿè®¡

oscap xccdf generate stats results.xml
```

### 10.3 å®é™…åº”ç”¨è¦ç‚¹



**ğŸ¯ æœ€ä½³å®è·µå»ºè®®**ï¼š

> ğŸ’¡ **æ–°æ‰‹å»ºè®®**ï¼šå…ˆä»CIS Level 1åŸºå‡†å¼€å§‹ï¼Œé€æ­¥æå‡å®‰å…¨é…ç½®è¦æ±‚

> âš ï¸ **ä¿®å¤æ³¨æ„**ï¼šä¿®å¤å‰ä¸€å®šè¦å¤‡ä»½é…ç½®æ–‡ä»¶ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒå…ˆéªŒè¯

> ğŸ”„ **æŒç»­ç›‘æ§**ï¼šå»ºç«‹å®šæœŸæ£€æŸ¥æœºåˆ¶ï¼Œä¸è¦åªåšä¸€æ¬¡æ€§æ£€æŸ¥

> ğŸ“Š **æŠ¥å‘Šç®¡ç†**ï¼šä¿ç•™å†å²æŠ¥å‘Šï¼Œè¿½è¸ªåˆè§„æ”¹è¿›è¶‹åŠ¿

### 10.4 å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ



| **é—®é¢˜** | **åŸå› ** | **è§£å†³æ–¹æ¡ˆ** |
|---------|---------|-------------|
| æ‰«æç»“æœæœ‰è¯¯æŠ¥ | è§„åˆ™ä¸é€‚ç”¨å½“å‰ç¯å¢ƒ | è‡ªå®šä¹‰è§„åˆ™æˆ–æ’é™¤ç‰¹å®šæ£€æŸ¥ |
| ä¿®å¤è„šæœ¬æ‰§è¡Œå¤±è´¥ | ç³»ç»Ÿç¯å¢ƒå·®å¼‚ | æ‰‹åŠ¨ä¿®å¤æˆ–è°ƒæ•´è„šæœ¬ |
| åˆè§„å¾—åˆ†ä¸ç†æƒ³ | é…ç½®ä¸ç¬¦åˆåŸºå‡†è¦æ±‚ | åˆ†æå¤±è´¥é¡¹ï¼Œé€ä¸€ä¿®å¤ |
| æŠ¥å‘Šç”Ÿæˆç¼“æ…¢ | ç³»ç»Ÿèµ„æºä¸è¶³ | ä¼˜åŒ–æ‰«æèŒƒå›´æˆ–å‡çº§ç¡¬ä»¶ |

**æ ¸å¿ƒè®°å¿†**ï¼š
- åˆè§„æ£€æŸ¥æ˜¯ç³»ç»Ÿå®‰å…¨çš„é‡è¦ç¯èŠ‚
- OpenSCAPæ˜¯Linuxåˆè§„æ£€æŸ¥çš„æ ‡å‡†å·¥å…·  
- CISåŸºå‡†æ˜¯æœ€æƒå¨çš„é…ç½®æ ‡å‡†
- æŒç»­ç›‘æ§æ¯”ä¸€æ¬¡æ€§æ£€æŸ¥æ›´é‡è¦
- ä¿®å¤å‰å¤‡ä»½ï¼Œä¿®å¤åéªŒè¯