---
title: 12ã€æ•°æ®ä¿æŠ¤ä¸åŠ å¯†
---
## ğŸ“š ç›®å½•

1. [æ•°æ®ä¿æŠ¤åŸºç¡€æ¦‚å¿µ](#1-æ•°æ®ä¿æŠ¤åŸºç¡€æ¦‚å¿µ)
2. [ç£ç›˜å…¨ç›˜åŠ å¯†é…ç½®](#2-ç£ç›˜å…¨ç›˜åŠ å¯†é…ç½®)
3. [æ•°æ®åº“åŠ å¯†è®¾ç½®](#3-æ•°æ®åº“åŠ å¯†è®¾ç½®)
4. [ç½‘ç»œä¼ è¾“åŠ å¯†é…ç½®](#4-ç½‘ç»œä¼ è¾“åŠ å¯†é…ç½®)
5. [å¯†é’¥ç®¡ç†ç­–ç•¥](#5-å¯†é’¥ç®¡ç†ç­–ç•¥)
6. [è¯ä¹¦ç®¡ç†ä¸è½®æ¢](#6-è¯ä¹¦ç®¡ç†ä¸è½®æ¢)
7. [æ•æ„Ÿæ•°æ®è„±æ•å¤„ç†](#7-æ•æ„Ÿæ•°æ®è„±æ•å¤„ç†)
8. [æ•°æ®åˆ†ç±»åˆ†çº§ç®¡ç†](#8-æ•°æ®åˆ†ç±»åˆ†çº§ç®¡ç†)
9. [åŠ å¯†æ€§èƒ½ä¼˜åŒ–é…ç½®](#9-åŠ å¯†æ€§èƒ½ä¼˜åŒ–é…ç½®)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” æ•°æ®ä¿æŠ¤åŸºç¡€æ¦‚å¿µ


### 1.1 æ•°æ®ä¿æŠ¤çš„æœ¬è´¨


**ä»€ä¹ˆæ˜¯æ•°æ®ä¿æŠ¤**
```
ç®€å•ç†è§£ï¼šæŠŠé‡è¦ä¿¡æ¯å˜æˆåˆ«äººçœ‹ä¸æ‡‚çš„"å¯†ç "
ç›®çš„ï¼šé˜²æ­¢æ•æ„Ÿæ•°æ®è¢«æœªç»æˆæƒçš„äººè·å–å’Œä½¿ç”¨
èŒƒå›´ï¼šæ¶µç›–æ•°æ®çš„å­˜å‚¨ã€ä¼ è¾“ã€å¤„ç†å…¨è¿‡ç¨‹
```

**æ•°æ®ä¿æŠ¤çš„æ ¸å¿ƒåŸåˆ™**
```
æœºå¯†æ€§ï¼ˆConfidentialityï¼‰ï¼š
â€¢ å«ä¹‰ï¼šåªæœ‰æˆæƒç”¨æˆ·æ‰èƒ½çœ‹åˆ°æ•°æ®
â€¢ ä¸¾ä¾‹ï¼šé“¶è¡Œå¡å¯†ç åªæœ‰ä½ çŸ¥é“

å®Œæ•´æ€§ï¼ˆIntegrityï¼‰ï¼š
â€¢ å«ä¹‰ï¼šæ•°æ®æ²¡æœ‰è¢«ç¯¡æ”¹æˆ–ç ´å
â€¢ ä¸¾ä¾‹ï¼šè½¬è´¦é‡‘é¢ä¸èƒ½è¢«æ¶æ„ä¿®æ”¹

å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ï¼š
â€¢ å«ä¹‰ï¼šåˆæ³•ç”¨æˆ·èƒ½æ­£å¸¸è®¿é—®æ•°æ®
â€¢ ä¸¾ä¾‹ï¼šç³»ç»Ÿ24å°æ—¶å¯ä»¥æŸ¥è¯¢ä½™é¢
```

### 1.2 åŠ å¯†æŠ€æœ¯åˆ†ç±»


**å¯¹ç§°åŠ å¯† vs éå¯¹ç§°åŠ å¯†**
```
å¯¹ç§°åŠ å¯†ï¼ˆåƒä¸€æŠŠé’¥åŒ™å¼€ä¸€æŠŠé”ï¼‰ï¼š
åŠ å¯†å¯†é’¥ = è§£å¯†å¯†é’¥
ä¾‹å­ï¼šAESåŠ å¯†ç®—æ³•

éå¯¹ç§°åŠ å¯†ï¼ˆåƒé‚®ç®±çš„å…¬é’¥ç§é’¥ï¼‰ï¼š
åŠ å¯†å¯†é’¥ â‰  è§£å¯†å¯†é’¥
ä¾‹å­ï¼šRSAåŠ å¯†ç®—æ³•
```

**æ•°æ®çŠ¶æ€åˆ†ç±»**
```
æ•°æ®é™æ­¢çŠ¶æ€ï¼ˆData at Restï¼‰ï¼š
â€¢ å«ä¹‰ï¼šå­˜å‚¨åœ¨ç¡¬ç›˜ã€æ•°æ®åº“ä¸­çš„æ•°æ®
â€¢ å¨èƒï¼šç¡¬ç›˜è¢«ç›—ã€æ•°æ®åº“è¢«å…¥ä¾µ
â€¢ ä¿æŠ¤ï¼šç£ç›˜åŠ å¯†ã€æ•°æ®åº“åŠ å¯†

æ•°æ®ä¼ è¾“çŠ¶æ€ï¼ˆData in Transitï¼‰ï¼š
â€¢ å«ä¹‰ï¼šç½‘ç»œä¼ è¾“è¿‡ç¨‹ä¸­çš„æ•°æ®
â€¢ å¨èƒï¼šç½‘ç»œçªƒå¬ã€ä¸­é—´äººæ”»å‡»
â€¢ ä¿æŠ¤ï¼šSSL/TLSåŠ å¯†

æ•°æ®ä½¿ç”¨çŠ¶æ€ï¼ˆData in Useï¼‰ï¼š
â€¢ å«ä¹‰ï¼šå†…å­˜ä¸­æ­£åœ¨å¤„ç†çš„æ•°æ®
â€¢ å¨èƒï¼šå†…å­˜dumpã€æ¶æ„ç¨‹åºè¯»å–
â€¢ ä¿æŠ¤ï¼šå†…å­˜åŠ å¯†ã€å®‰å…¨å®¹å™¨
```

### 1.3 Linuxç³»ç»Ÿä¸­çš„åŠ å¯†æ¶æ„


```
LinuxåŠ å¯†æŠ€æœ¯æ ˆï¼š

åº”ç”¨å±‚åŠ å¯†
    â†“
æ–‡ä»¶ç³»ç»ŸåŠ å¯† â† eCryptfs, EncFS
    â†“
å—è®¾å¤‡åŠ å¯† â† dm-crypt, LUKS
    â†“
ç¡¬ä»¶åŠ å¯† â† TPM, ç¡¬ä»¶å®‰å…¨æ¨¡å—

æ¯ä¸€å±‚éƒ½æä¾›ä¸åŒçº§åˆ«çš„ä¿æŠ¤
```

---

## 2. ğŸ’¾ ç£ç›˜å…¨ç›˜åŠ å¯†é…ç½®


### 2.1 LUKSåŠ å¯†åŸºç¡€


**LUKSæ˜¯ä»€ä¹ˆ**
```
LUKSï¼ˆLinux Unified Key Setupï¼‰ï¼š
â€¢ å«ä¹‰ï¼šLinuxç»Ÿä¸€å¯†é’¥è®¾ç½®æ ‡å‡†
â€¢ ä½œç”¨ï¼šä¸ºç£ç›˜åˆ†åŒºæä¾›åŠ å¯†ä¿æŠ¤
â€¢ ç‰¹ç‚¹ï¼šæ”¯æŒå¤šä¸ªå¯†ç ï¼Œæ–¹ä¾¿ç®¡ç†

ç®€å•ç†è§£ï¼šç»™æ•´ä¸ªç¡¬ç›˜åŠ ä¸€æŠŠ"å¯†ç é”"
æ²¡æœ‰å¯†ç å°±æ— æ³•è¯»å–ç¡¬ç›˜ä¸Šçš„ä»»ä½•æ•°æ®
```

**LUKSåŠ å¯†åŸç†**
```
æ•°æ®æµå‘ï¼š

æ˜æ–‡æ•°æ® â†’ LUKSåŠ å¯†å±‚ â†’ ç‰©ç†å­˜å‚¨è®¾å¤‡

è¯»å–è¿‡ç¨‹ï¼š
1. è¾“å…¥å¯†ç è§£é”LUKSå¤´éƒ¨
2. è·å–ä¸»å¯†é’¥ï¼ˆMaster Keyï¼‰
3. ä½¿ç”¨ä¸»å¯†é’¥è§£å¯†æ•°æ®
4. è¿”å›æ˜æ–‡æ•°æ®ç»™åº”ç”¨

å­˜å‚¨è¿‡ç¨‹åˆ™ç›¸å
```

### 2.2 åˆ›å»ºLUKSåŠ å¯†åˆ†åŒº


**å‡†å¤‡å·¥ä½œ**
```bash
# æŸ¥çœ‹å¯ç”¨ç£ç›˜
lsblk

# ç¡®è®¤ç›®æ ‡ç£ç›˜ï¼ˆå‡è®¾æ˜¯/dev/sdbï¼‰
fdisk -l /dev/sdb
```

**åˆ›å»ºåŠ å¯†åˆ†åŒº**
```bash
# 1. åˆ›å»ºLUKSåŠ å¯†å®¹å™¨
cryptsetup luksFormat /dev/sdb1

# ç³»ç»Ÿä¼šæç¤ºï¼š
# è¾“å…¥YESç¡®è®¤ï¼ˆå¿…é¡»å¤§å†™ï¼‰
# è®¾ç½®åŠ å¯†å¯†ç ï¼ˆè¯·è®°ä½è¿™ä¸ªå¯†ç ï¼ï¼‰

# 2. æ‰“å¼€åŠ å¯†å®¹å™¨
cryptsetup luksOpen /dev/sdb1 myencrypted

# 3. åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ
mkfs.ext4 /dev/mapper/myencrypted

# 4. æŒ‚è½½ä½¿ç”¨
mkdir /mnt/encrypted
mount /dev/mapper/myencrypted /mnt/encrypted
```

**è‡ªåŠ¨æŒ‚è½½é…ç½®**
```bash
# ç¼–è¾‘/etc/crypttabæ–‡ä»¶
echo "myencrypted /dev/sdb1 none luks" >> /etc/crypttab

# ç¼–è¾‘/etc/fstabæ–‡ä»¶
echo "/dev/mapper/myencrypted /mnt/encrypted ext4 defaults 0 2" >> /etc/fstab
```

### 2.3 ç³»ç»Ÿç›˜åŠ å¯†é…ç½®


**å®‰è£…æ—¶å¯ç”¨åŠ å¯†**
```
å¤§å¤šæ•°Linuxå‘è¡Œç‰ˆåœ¨å®‰è£…æ—¶æä¾›åŠ å¯†é€‰é¡¹ï¼š

Ubuntu/Debianå®‰è£…ï¼š
â–¡ é€‰æ‹©"ä½¿ç”¨LVMåŠ å¯†æˆ‘çš„Ubuntuå®‰è£…"
â–¡ è®¾ç½®åŠ å¯†å¯†ç 

CentOS/RHELå®‰è£…ï¼š
â–¡ åœ¨åˆ†åŒºæ­¥éª¤é€‰æ‹©"åŠ å¯†æˆ‘çš„æ•°æ®"
â–¡ è®¾ç½®LUKSå¯†ç 
```

**å·²å®‰è£…ç³»ç»ŸåŠ å¯†ï¼ˆé«˜çº§æ“ä½œï¼‰**
```bash
# è­¦å‘Šï¼šè¿™æ˜¯é«˜é£é™©æ“ä½œï¼Œå»ºè®®ä¸“ä¸šäººå‘˜æ‰§è¡Œ
# éœ€è¦å¤‡ä»½æ‰€æœ‰æ•°æ®

# 1. åˆ›å»ºä¸´æ—¶åŠ å¯†åˆ†åŒº
# 2. è¿ç§»ç³»ç»Ÿæ•°æ®
# 3. ä¿®æ”¹å¯åŠ¨é…ç½®
# 4. æ›´æ–°initramfs

# å»ºè®®ä½¿ç”¨ä¸“é—¨å·¥å…·å¦‚cryptmount
```

### 2.4 å¯†ç ç®¡ç†ç­–ç•¥


**å¤šå¯†ç æ”¯æŒ**
```bash
# LUKSæ”¯æŒæœ€å¤š8ä¸ªå¯†ç æ§½
# æŸ¥çœ‹å¯†ç æ§½çŠ¶æ€
cryptsetup luksDump /dev/sdb1

# æ·»åŠ æ–°å¯†ç 
cryptsetup luksAddKey /dev/sdb1

# åˆ é™¤å¯†ç ï¼ˆéœ€è¦æä¾›å¦ä¸€ä¸ªæœ‰æ•ˆå¯†ç ï¼‰
cryptsetup luksRemoveKey /dev/sdb1
```

**å¯†ç æ¢å¤å‡†å¤‡**
```bash
# å¤‡ä»½LUKSå¤´éƒ¨ï¼ˆåŒ…å«å¯†é’¥ä¿¡æ¯ï¼‰
cryptsetup luksHeaderBackup /dev/sdb1 --header-backup-file luks-header.backup

# æ¢å¤LUKSå¤´éƒ¨
cryptsetup luksHeaderRestore /dev/sdb1 --header-backup-file luks-header.backup
```

---

## 3. ğŸ—„ï¸ æ•°æ®åº“åŠ å¯†è®¾ç½®


### 3.1 MySQLæ•°æ®åº“åŠ å¯†


**é€æ˜æ•°æ®åŠ å¯†ï¼ˆTDEï¼‰**
```
ä»€ä¹ˆæ˜¯TDEï¼š
â€¢ å«ä¹‰ï¼šæ•°æ®å†™å…¥ç£ç›˜æ—¶è‡ªåŠ¨åŠ å¯†
â€¢ ç‰¹ç‚¹ï¼šå¯¹åº”ç”¨ç¨‹åºé€æ˜ï¼Œæ— éœ€ä¿®æ”¹ä»£ç 
â€¢ ä¿æŠ¤ï¼šé˜²æ­¢æ•°æ®æ–‡ä»¶è¢«ç›´æ¥è®¿é—®
```

**MySQL 8.0åŠ å¯†é…ç½®**
```sql
-- 1. åˆ›å»ºåŠ å¯†è¡¨
CREATE TABLE sensitive_data (
    id INT PRIMARY KEY,
    username VARCHAR(50),
    email VARCHAR(100)
) ENCRYPTION='Y';

-- 2. ä¸ºç°æœ‰è¡¨å¯ç”¨åŠ å¯†
ALTER TABLE existing_table ENCRYPTION='Y';

-- 3. åˆ›å»ºåŠ å¯†è¡¨ç©ºé—´
CREATE TABLESPACE encrypted_space
ADD DATAFILE 'encrypted_space.ibd'
ENCRYPTION='Y';
```

**é…ç½®æ–‡ä»¶è®¾ç½®**
```ini
# my.cnfé…ç½®
[mysqld]
# å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—åŠ å¯†
binlog-encryption=ON

# å¯ç”¨redoæ—¥å¿—åŠ å¯†
innodb-redo-log-encrypt=ON

# å¯ç”¨undoæ—¥å¿—åŠ å¯†
innodb-undo-log-encrypt=ON
```

### 3.2 PostgreSQLæ•°æ®åº“åŠ å¯†


**åˆ—çº§åŠ å¯†**
```sql
-- å®‰è£…pgcryptoæ‰©å±•
CREATE EXTENSION pgcrypto;

-- åŠ å¯†å­˜å‚¨æ•æ„Ÿæ•°æ®
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50),
    password_hash TEXT,
    -- åŠ å¯†å­˜å‚¨ä¿¡ç”¨å¡å·
    credit_card_encrypted BYTEA
);

-- æ’å…¥åŠ å¯†æ•°æ®
INSERT INTO users (username, credit_card_encrypted) 
VALUES ('john', pgp_sym_encrypt('4111111111111111', 'å¯†é’¥'));

-- æŸ¥è¯¢è§£å¯†æ•°æ®
SELECT username, 
       pgp_sym_decrypt(credit_card_encrypted, 'å¯†é’¥') as credit_card
FROM users;
```

**è¿æ¥åŠ å¯†é…ç½®**
```bash
# postgresql.confé…ç½®
ssl = on
ssl_cert_file = 'server.crt'
ssl_key_file = 'server.key'
ssl_ca_file = 'root.crt'

# å¼ºåˆ¶SSLè¿æ¥
hostssl    all    all    0.0.0.0/0    md5
```

### 3.3 æ•°æ®åº“å¤‡ä»½åŠ å¯†


**MySQLå¤‡ä»½åŠ å¯†**
```bash
# ä½¿ç”¨mysqldumpåŠ å¯†å¤‡ä»½
mysqldump -u root -p database_name | \
gpg --symmetric --cipher-algo AES256 --compress-algo 1 \
--output backup_encrypted.sql.gpg

# è§£å¯†æ¢å¤
gpg --decrypt backup_encrypted.sql.gpg | \
mysql -u root -p database_name
```

**PostgreSQLå¤‡ä»½åŠ å¯†**
```bash
# pg_dumpåŠ å¯†å¤‡ä»½
pg_dump -U postgres database_name | \
openssl enc -aes-256-cbc -salt -out backup.sql.enc

# è§£å¯†æ¢å¤
openssl enc -aes-256-cbc -d -in backup.sql.enc | \
psql -U postgres database_name
```

---

## 4. ğŸŒ ç½‘ç»œä¼ è¾“åŠ å¯†é…ç½®


### 4.1 SSL/TLSåŸºç¡€æ¦‚å¿µ


**SSL/TLSæ˜¯ä»€ä¹ˆ**
```
SSLï¼ˆSecure Socket Layerï¼‰ï¼šå®‰å…¨å¥—æ¥å­—å±‚
TLSï¼ˆTransport Layer Securityï¼‰ï¼šä¼ è¾“å±‚å®‰å…¨åè®®

ç®€å•ç†è§£ï¼š
å°±åƒç»™ç½‘ç»œæ•°æ®åŒ…è£¹"é˜²æŠ¤ç½©"
ç¡®ä¿æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸è¢«å·çœ‹å’Œç¯¡æ”¹
```

**å·¥ä½œåŸç†**
```
HTTPSé€šä¿¡æµç¨‹ï¼š

å®¢æˆ·ç«¯                    æœåŠ¡å™¨
   |                        |
   |--[1]å‘èµ·è¿æ¥----------->|
   |<-[2]è¿”å›è¯ä¹¦------------|
   |--[3]éªŒè¯è¯ä¹¦----------->|
   |<-[4]åå•†åŠ å¯†ç®—æ³•--------|
   |--[5]ç”Ÿæˆä¼šè¯å¯†é’¥------->|
   |<====[6]åŠ å¯†é€šä¿¡=======>|
```

### 4.2 Nginx HTTPSé…ç½®


**SSLè¯ä¹¦å‡†å¤‡**
```bash
# ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼ˆæµ‹è¯•ç”¨ï¼‰
openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
-keyout /etc/ssl/private/nginx.key \
-out /etc/ssl/certs/nginx.crt

# è®¾ç½®è¯ä¹¦æƒé™
chmod 600 /etc/ssl/private/nginx.key
chmod 644 /etc/ssl/certs/nginx.crt
```

**Nginx HTTPSé…ç½®**
```nginx
server {
    listen 443 ssl http2;
    server_name example.com;
    
    # SSLè¯ä¹¦é…ç½®
    ssl_certificate /etc/ssl/certs/nginx.crt;
    ssl_certificate_key /etc/ssl/private/nginx.key;
    
    # SSLå®‰å…¨é…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384;
    ssl_prefer_server_ciphers off;
    
    # å®‰å…¨å¤´è®¾ç½®
    add_header Strict-Transport-Security "max-age=31536000" always;
    
    location / {
        root /var/www/html;
        index index.html;
    }
}

# å¼ºåˆ¶HTTPSé‡å®šå‘
server {
    listen 80;
    server_name example.com;
    return 301 https://$server_name$request_uri;
}
```

### 4.3 SSHåŠ å¯†ä¼ è¾“


**SSHé…ç½®ä¼˜åŒ–**
```bash
# /etc/ssh/sshd_configå®‰å…¨é…ç½®
# ç¦ç”¨ä¸å®‰å…¨çš„åè®®
Protocol 2

# ä½¿ç”¨å¼ºåŠ å¯†ç®—æ³•
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com
MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com
KexAlgorithms curve25519-sha256,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521

# ç¦ç”¨å¯†ç è®¤è¯ï¼Œå¼ºåˆ¶ä½¿ç”¨å¯†é’¥
PasswordAuthentication no
PubkeyAuthentication yes
```

**SCP/SFTPå®‰å…¨ä¼ è¾“**
```bash
# ä½¿ç”¨SCPåŠ å¯†ä¼ è¾“æ–‡ä»¶
scp -P 22 localfile.txt user@server:/remote/path/

# ä½¿ç”¨SFTPåŠ å¯†ä¼ è¾“
sftp -P 22 user@server
put localfile.txt /remote/path/
get /remote/path/remotefile.txt
```

### 4.4 VPNéš§é“åŠ å¯†


**OpenVPNé…ç½®ç¤ºä¾‹**
```bash
# æœåŠ¡ç«¯é…ç½®æ–‡ä»¶ server.conf
port 1194
proto udp
dev tun

ca ca.crt
cert server.crt
key server.key
dh dh.pem

# åŠ å¯†è®¾ç½®
cipher AES-256-CBC
auth SHA256
tls-version-min 1.2

# ç½‘ç»œé…ç½®
server 10.8.0.0 255.255.255.0
push "route 192.168.1.0 255.255.255.0"
```

---

## 5. ğŸ”‘ å¯†é’¥ç®¡ç†ç­–ç•¥


### 5.1 å¯†é’¥ç®¡ç†åŸºç¡€


**å¯†é’¥ç”Ÿå‘½å‘¨æœŸ**
```
å¯†é’¥ç®¡ç†æµç¨‹ï¼š

ç”Ÿæˆ â†’ åˆ†å‘ â†’ å­˜å‚¨ â†’ ä½¿ç”¨ â†’ è½®æ¢ â†’ é”€æ¯

æ¯ä¸ªé˜¶æ®µéƒ½éœ€è¦ä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶ï¼š

ç”Ÿæˆé˜¶æ®µï¼šä½¿ç”¨å®‰å…¨éšæœºæ•°ç”Ÿæˆå™¨
åˆ†å‘é˜¶æ®µï¼šé€šè¿‡å®‰å…¨é€šé“ä¼ è¾“
å­˜å‚¨é˜¶æ®µï¼šåŠ å¯†å­˜å‚¨ï¼Œè®¿é—®æ§åˆ¶
ä½¿ç”¨é˜¶æ®µï¼šæœ€å°æƒé™åŸåˆ™
è½®æ¢é˜¶æ®µï¼šå®šæœŸæ›´æ¢å¯†é’¥
é”€æ¯é˜¶æ®µï¼šå®‰å…¨åˆ é™¤å¯†é’¥æ•°æ®
```

**å¯†é’¥åˆ†ç±»ç®¡ç†**
```
æ ¹æ®é‡è¦æ€§åˆ†çº§ï¼š

ä¸»å¯†é’¥ï¼ˆMaster Keyï¼‰ï¼š
â€¢ ç”¨é€”ï¼šåŠ å¯†å…¶ä»–å¯†é’¥
â€¢ ä¿æŠ¤ï¼šæœ€é«˜çº§åˆ«ä¿æŠ¤
â€¢ å­˜å‚¨ï¼šHSMæˆ–ç¦»çº¿å­˜å‚¨

æ•°æ®åŠ å¯†å¯†é’¥ï¼ˆDEKï¼‰ï¼š
â€¢ ç”¨é€”ï¼šç›´æ¥åŠ å¯†æ•°æ®
â€¢ ä¿æŠ¤ï¼šç”±å¯†é’¥åŠ å¯†å¯†é’¥ä¿æŠ¤
â€¢ å­˜å‚¨ï¼šå¯å­˜å‚¨åœ¨ç³»ç»Ÿä¸­

å¯†é’¥åŠ å¯†å¯†é’¥ï¼ˆKEKï¼‰ï¼š
â€¢ ç”¨é€”ï¼šåŠ å¯†æ•°æ®åŠ å¯†å¯†é’¥
â€¢ ä¿æŠ¤ï¼šé«˜çº§åˆ«ä¿æŠ¤
â€¢ å­˜å‚¨ï¼šå®‰å…¨å¯†é’¥ç®¡ç†ç³»ç»Ÿ
```

### 5.2 GPGå¯†é’¥ç®¡ç†


**åˆ›å»ºGPGå¯†é’¥å¯¹**
```bash
# ç”Ÿæˆæ–°çš„GPGå¯†é’¥
gpg --full-generate-key

# é€‰æ‹©å¯†é’¥ç±»å‹ï¼ˆæ¨èRSAï¼‰
# è®¾ç½®å¯†é’¥é•¿åº¦ï¼ˆæ¨è4096ä½ï¼‰
# è®¾ç½®æœ‰æ•ˆæœŸ
# è¾“å…¥ç”¨æˆ·ä¿¡æ¯å’Œå¯†ç 

# åˆ—å‡ºå¯†é’¥
gpg --list-keys

# å¯¼å‡ºå…¬é’¥
gpg --armor --export user@example.com > public.key

# å¯¼å‡ºç§é’¥ï¼ˆå®‰å…¨å­˜å‚¨ï¼‰
gpg --armor --export-secret-keys user@example.com > private.key
```

**GPGåŠ å¯†è§£å¯†æ“ä½œ**
```bash
# åŠ å¯†æ–‡ä»¶
gpg --encrypt --recipient user@example.com document.txt

# è§£å¯†æ–‡ä»¶
gpg --decrypt document.txt.gpg > document.txt

# ç­¾åæ–‡ä»¶
gpg --sign document.txt

# éªŒè¯ç­¾å
gpg --verify document.txt.gpg
```

### 5.3 SSHå¯†é’¥ç®¡ç†


**ç”ŸæˆSSHå¯†é’¥å¯¹**
```bash
# ç”ŸæˆEd25519å¯†é’¥ï¼ˆæ¨èï¼‰
ssh-keygen -t ed25519 -C "your_email@example.com"

# ç”ŸæˆRSAå¯†é’¥ï¼ˆå…¼å®¹æ€§æ›´å¥½ï¼‰
ssh-keygen -t rsa -b 4096 -C "your_email@example.com"

# æŒ‡å®šå¯†é’¥æ–‡ä»¶å
ssh-keygen -t ed25519 -f ~/.ssh/server_key
```

**SSHå¯†é’¥éƒ¨ç½²**
```bash
# å¤åˆ¶å…¬é’¥åˆ°æœåŠ¡å™¨
ssh-copy-id -i ~/.ssh/id_ed25519.pub user@server

# æ‰‹åŠ¨éƒ¨ç½²å…¬é’¥
cat ~/.ssh/id_ed25519.pub | ssh user@server \
"mkdir -p ~/.ssh && cat >> ~/.ssh/authorized_keys"

# è®¾ç½®æ­£ç¡®æƒé™
chmod 700 ~/.ssh
chmod 600 ~/.ssh/authorized_keys
```

### 5.4 å¯†é’¥è½®æ¢ç­–ç•¥


**å®šæœŸè½®æ¢è®¡åˆ’**
```bash
# åˆ›å»ºå¯†é’¥è½®æ¢è„šæœ¬
#!/bin/bash
KEY_DIR="/etc/app/keys"
BACKUP_DIR="/etc/app/keys/backup"
DATE=$(date +%Y%m%d)

# å¤‡ä»½æ—§å¯†é’¥
cp $KEY_DIR/app.key $BACKUP_DIR/app.key.$DATE

# ç”Ÿæˆæ–°å¯†é’¥
openssl rand -base64 32 > $KEY_DIR/app.key.new

# åº”ç”¨æ–°å¯†é’¥
mv $KEY_DIR/app.key.new $KEY_DIR/app.key

# é‡å¯ç›¸å…³æœåŠ¡
systemctl restart myapp

# æ¸…ç†è¿‡æœŸå¤‡ä»½ï¼ˆä¿ç•™90å¤©ï¼‰
find $BACKUP_DIR -name "app.key.*" -mtime +90 -delete
```

---

## 6. ğŸ“œ è¯ä¹¦ç®¡ç†ä¸è½®æ¢


### 6.1 æ•°å­—è¯ä¹¦åŸºç¡€


**æ•°å­—è¯ä¹¦æ˜¯ä»€ä¹ˆ**
```
æ•°å­—è¯ä¹¦å°±åƒ"æ•°å­—èº«ä»½è¯"ï¼š
â€¢ è¯æ˜ä½ å°±æ˜¯ä½ ï¼ˆèº«ä»½è®¤è¯ï¼‰
â€¢ æä¾›åŠ å¯†å¯†é’¥ï¼ˆåŠ å¯†é€šä¿¡ï¼‰
â€¢ é˜²æ­¢èº«ä»½å†’å……ï¼ˆæ•°å­—ç­¾åï¼‰

è¯ä¹¦åŒ…å«çš„ä¿¡æ¯ï¼š
- è¯ä¹¦æŒæœ‰è€…ä¿¡æ¯
- å…¬é’¥ä¿¡æ¯
- è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰
- æœ‰æ•ˆæœŸ
- æ•°å­—ç­¾å
```

**è¯ä¹¦ç±»å‹**
```
æŒ‰éªŒè¯çº§åˆ«åˆ†ç±»ï¼š

åŸŸåéªŒè¯ï¼ˆDVï¼‰è¯ä¹¦ï¼š
â€¢ åªéªŒè¯åŸŸåæ‰€æœ‰æƒ
â€¢ é€‚ç”¨ï¼šä¸ªäººç½‘ç«™ã€åšå®¢
â€¢ ç‰¹ç‚¹ï¼šç”³è¯·ç®€å•ï¼Œä»·æ ¼ä¾¿å®œ

ç»„ç»‡éªŒè¯ï¼ˆOVï¼‰è¯ä¹¦ï¼š
â€¢ éªŒè¯åŸŸåå’Œç»„ç»‡ä¿¡æ¯
â€¢ é€‚ç”¨ï¼šä¼ä¸šç½‘ç«™
â€¢ ç‰¹ç‚¹ï¼šæ˜¾ç¤ºç»„ç»‡åç§°

æ‰©å±•éªŒè¯ï¼ˆEVï¼‰è¯ä¹¦ï¼š
â€¢ æœ€ä¸¥æ ¼çš„éªŒè¯æµç¨‹
â€¢ é€‚ç”¨ï¼šé“¶è¡Œã€ç”µå•†ç­‰é«˜å®‰å…¨è¦æ±‚
â€¢ ç‰¹ç‚¹ï¼šåœ°å€æ æ˜¾ç¤ºå…¬å¸åç§°ï¼ˆç»¿è‰²ï¼‰
```

### 6.2 Let's Encryptå…è´¹è¯ä¹¦


**å®‰è£…Certbotå®¢æˆ·ç«¯**
```bash
# Ubuntu/Debian
apt update && apt install certbot python3-certbot-nginx

# CentOS/RHEL
yum install certbot python3-certbot-nginx

# æˆ–ä½¿ç”¨snapå®‰è£…
snap install --classic certbot
```

**ç”³è¯·SSLè¯ä¹¦**
```bash
# ä¸ºNginxè‡ªåŠ¨é…ç½®SSL
certbot --nginx -d example.com -d www.example.com

# ä»…ç”³è¯·è¯ä¹¦ï¼ˆæ‰‹åŠ¨é…ç½®ï¼‰
certbot certonly --nginx -d example.com

# ä½¿ç”¨DNSéªŒè¯ï¼ˆæ¨èç”¨äºé€šé…ç¬¦è¯ä¹¦ï¼‰
certbot certonly --manual --preferred-challenges dns \
-d example.com -d *.example.com
```

**è‡ªåŠ¨ç»­æœŸé…ç½®**
```bash
# æµ‹è¯•ç»­æœŸ
certbot renew --dry-run

# è®¾ç½®è‡ªåŠ¨ç»­æœŸï¼ˆcrontabï¼‰
echo "0 12 * * * /usr/bin/certbot renew --quiet" | crontab -

# æˆ–ä½¿ç”¨systemd timerï¼ˆæ¨èï¼‰
systemctl enable certbot.timer
systemctl start certbot.timer
```

### 6.3 è‡ªç­¾åè¯ä¹¦ç®¡ç†


**åˆ›å»ºæ ¹CAè¯ä¹¦**
```bash
# 1. ç”ŸæˆCAç§é’¥
openssl genrsa -out ca.key 4096

# 2. åˆ›å»ºCAè¯ä¹¦
openssl req -x509 -new -nodes -key ca.key -sha256 -days 3650 -out ca.crt

# 3. åˆ›å»ºæœåŠ¡å™¨ç§é’¥
openssl genrsa -out server.key 2048

# 4. åˆ›å»ºè¯ä¹¦ç­¾åè¯·æ±‚
openssl req -new -key server.key -out server.csr

# 5. ä½¿ç”¨CAç­¾åæœåŠ¡å™¨è¯ä¹¦
openssl x509 -req -in server.csr -CA ca.crt -CAkey ca.key \
-CAcreateserial -out server.crt -days 365 -sha256
```

**è¯ä¹¦ä¿¡æ¯æŸ¥çœ‹**
```bash
# æŸ¥çœ‹è¯ä¹¦è¯¦ç»†ä¿¡æ¯
openssl x509 -in server.crt -text -noout

# æ£€æŸ¥è¯ä¹¦æœ‰æ•ˆæœŸ
openssl x509 -in server.crt -noout -dates

# éªŒè¯è¯ä¹¦é“¾
openssl verify -CAfile ca.crt server.crt
```

### 6.4 è¯ä¹¦ç›‘æ§ä¸å‘Šè­¦


**è¯ä¹¦æœ‰æ•ˆæœŸç›‘æ§è„šæœ¬**
```bash
#!/bin/bash
# check_cert_expiry.sh

DOMAIN="example.com"
PORT="443"
WARN_DAYS=30
CRIT_DAYS=7

# è·å–è¯ä¹¦æœ‰æ•ˆæœŸ
CERT_END_DATE=$(echo | openssl s_client -servername $DOMAIN -connect $DOMAIN:$PORT 2>/dev/null | \
openssl x509 -noout -enddate | cut -d= -f2)

# è®¡ç®—å‰©ä½™å¤©æ•°
END_EPOCH=$(date -d "$CERT_END_DATE" +%s)
NOW_EPOCH=$(date +%s)
DAYS_LEFT=$(( (END_EPOCH - NOW_EPOCH) / 86400 ))

# åˆ¤æ–­å‘Šè­¦çº§åˆ«
if [ $DAYS_LEFT -lt $CRIT_DAYS ]; then
    echo "CRITICAL: Certificate expires in $DAYS_LEFT days"
    exit 2
elif [ $DAYS_LEFT -lt $WARN_DAYS ]; then
    echo "WARNING: Certificate expires in $DAYS_LEFT days"
    exit 1
else
    echo "OK: Certificate valid for $DAYS_LEFT days"
    exit 0
fi
```

---

## 7. ğŸ­ æ•æ„Ÿæ•°æ®è„±æ•å¤„ç†


### 7.1 æ•°æ®è„±æ•åŸºç¡€æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯æ•°æ®è„±æ•**
```
æ•°æ®è„±æ•å°±æ˜¯ç»™æ•æ„Ÿæ•°æ®"æ‰“é©¬èµ›å…‹"ï¼š
â€¢ ä¿ç•™æ•°æ®çš„æ ¼å¼å’Œç»Ÿè®¡ç‰¹å¾
â€¢ å»é™¤çœŸå®çš„æ•æ„Ÿä¿¡æ¯
â€¢ ç¡®ä¿è„±æ•åçš„æ•°æ®æ— æ³•é€†å‘è¿˜åŸ

ä½¿ç”¨åœºæ™¯ï¼š
- å¼€å‘æµ‹è¯•ç¯å¢ƒ
- æ•°æ®åˆ†ææŒ–æ˜
- ç¬¬ä¸‰æ–¹æ•°æ®å…±äº«
- åˆè§„å®¡è®¡éœ€æ±‚
```

**è„±æ•æ–¹å¼åˆ†ç±»**
```
é™æ€è„±æ•ï¼š
â€¢ åœ¨éç”Ÿäº§ç¯å¢ƒä¸­å¯¹æ•°æ®è¿›è¡Œè„±æ•
â€¢ é€‚ç”¨ï¼šæµ‹è¯•æ•°æ®åº“ã€å¼€å‘ç¯å¢ƒ
â€¢ ç‰¹ç‚¹ï¼šä¸€æ¬¡å¤„ç†ï¼Œå¤šæ¬¡ä½¿ç”¨

åŠ¨æ€è„±æ•ï¼š
â€¢ å®æ—¶è„±æ•ï¼Œæ ¹æ®è®¿é—®æƒé™å†³å®š
â€¢ é€‚ç”¨ï¼šç”Ÿäº§ç¯å¢ƒçš„æ•æ„Ÿæ•°æ®æŸ¥è¯¢
â€¢ ç‰¹ç‚¹ï¼šå®æ—¶å¤„ç†ï¼Œæƒé™ç›¸å…³

æ ¼å¼ä¿ç•™è„±æ•ï¼š
â€¢ ä¿æŒåŸæ•°æ®çš„æ ¼å¼å’Œé•¿åº¦
â€¢ é€‚ç”¨ï¼šéœ€è¦ä¿æŒæ•°æ®å…³è”æ€§çš„åœºæ™¯
â€¢ ç‰¹ç‚¹ï¼šä¾¿äºæµ‹è¯•å’Œå¼€å‘
```

### 7.2 å¸¸è§è„±æ•æŠ€æœ¯


**æ›¿æ¢è„±æ•**
```bash
#!/bin/bash
# å§“åè„±æ•ï¼šå¼ ä¸‰ â†’ å¼ **
sed 's/\(.\).*/\1**/' names.txt

# æ‰‹æœºå·è„±æ•ï¼š13812345678 â†’ 138****5678
sed 's/\([0-9]\{3\}\)[0-9]\{4\}\([0-9]\{4\}\)/\1****\2/' phones.txt

# èº«ä»½è¯è„±æ•ï¼šä¿ç•™å‰6ä½å’Œå4ä½
sed 's/\([0-9]\{6\}\)[0-9]\{8\}\([0-9X]\{4\}\)/\1********\2/' ids.txt
```

**éšæœºåŒ–è„±æ•**
```python
import random
import string

def randomize_name(original_name):
    """éšæœºåŒ–å§“åï¼Œä¿æŒé•¿åº¦"""
    length = len(original_name)
    return ''.join(random.choices(string.ascii_letters, k=length))

def randomize_phone(original_phone):
    """éšæœºåŒ–æ‰‹æœºå·ï¼Œä¿æŒæ ¼å¼"""
    return f"138{''.join(random.choices(string.digits, k=8))}"

def randomize_email(original_email):
    """éšæœºåŒ–é‚®ç®±ï¼Œä¿æŒåŸŸå"""
    username, domain = original_email.split('@')
    new_username = ''.join(random.choices(string.ascii_lowercase, k=len(username)))
    return f"{new_username}@{domain}"
```

**å“ˆå¸Œè„±æ•**
```bash
# ä½¿ç”¨MD5å“ˆå¸Œï¼ˆä¸å¯é€†ï¼‰
echo "sensitive_data" | md5sum | cut -d' ' -f1

# ä½¿ç”¨SHA256å“ˆå¸Œ
echo "sensitive_data" | sha256sum | cut -d' ' -f1

# æ·»åŠ ç›å€¼å¢å¼ºå®‰å…¨æ€§
SALT="random_salt_2024"
echo "sensitive_data$SALT" | sha256sum | cut -d' ' -f1
```

### 7.3 æ•°æ®åº“è„±æ•å®ç°


**MySQLè„±æ•è§†å›¾**
```sql
-- åˆ›å»ºè„±æ•è§†å›¾
CREATE VIEW user_masked AS
SELECT 
    id,
    CONCAT(LEFT(username, 1), '***') AS username,
    CONCAT(LEFT(phone, 3), '****', RIGHT(phone, 4)) AS phone,
    CONCAT(LEFT(email, 3), '***@', SUBSTRING_INDEX(email, '@', -1)) AS email,
    created_at
FROM users;

-- ä¸ºä¸åŒè§’è‰²åˆ›å»ºä¸åŒçš„è„±æ•ç¨‹åº¦
CREATE VIEW user_dev AS
SELECT 
    id,
    MD5(CONCAT(username, 'dev_salt')) AS username,
    CONCAT('138', LPAD(FLOOR(RAND() * 100000000), 8, '0')) AS phone,
    CONCAT(MD5(email), '@example.com') AS email,
    created_at
FROM users;
```

**PostgreSQLè„±æ•å‡½æ•°**
```sql
-- åˆ›å»ºè„±æ•å‡½æ•°
CREATE OR REPLACE FUNCTION mask_phone(phone_number TEXT)
RETURNS TEXT AS $$
BEGIN
    RETURN CONCAT(
        LEFT(phone_number, 3),
        '****',
        RIGHT(phone_number, 4)
    );
END;
$$ LANGUAGE plpgsql;

-- ä½¿ç”¨è„±æ•å‡½æ•°
SELECT 
    id,
    username,
    mask_phone(phone) as phone_masked,
    created_at
FROM users;
```

### 7.4 è‡ªåŠ¨åŒ–è„±æ•æµç¨‹


**è„±æ•è„šæœ¬ç¤ºä¾‹**
```bash
#!/bin/bash
# data_masking.sh

SOURCE_DB="production"
TARGET_DB="development"
BACKUP_DIR="/backup/masked"

echo "å¼€å§‹æ•°æ®è„±æ•æµç¨‹..."

# 1. å¤‡ä»½åŸå§‹æ•°æ®
mysqldump -u root -p$SOURCE_PASS $SOURCE_DB > $BACKUP_DIR/original_$(date +%Y%m%d).sql

# 2. å¯¼å…¥åˆ°ç›®æ ‡æ•°æ®åº“
mysql -u root -p$TARGET_PASS $TARGET_DB < $BACKUP_DIR/original_$(date +%Y%m%d).sql

# 3. æ‰§è¡Œè„±æ•æ“ä½œ
mysql -u root -p$TARGET_PASS $TARGET_DB << EOF
-- è„±æ•ç”¨æˆ·è¡¨
UPDATE users SET 
    username = CONCAT(LEFT(username, 1), '***'),
    phone = CONCAT(LEFT(phone, 3), '****', RIGHT(phone, 4)),
    email = CONCAT(MD5(email), '@test.com'),
    id_card = CONCAT(LEFT(id_card, 6), '********', RIGHT(id_card, 4));

-- è„±æ•è®¢å•è¡¨
UPDATE orders SET 
    customer_name = CONCAT(LEFT(customer_name, 1), '**'),
    delivery_address = 'è„±æ•åœ°å€',
    contact_phone = CONCAT(LEFT(contact_phone, 3), '****', RIGHT(contact_phone, 4));
EOF

echo "æ•°æ®è„±æ•å®Œæˆï¼"
```

---

## 8. ğŸ“Š æ•°æ®åˆ†ç±»åˆ†çº§ç®¡ç†


### 8.1 æ•°æ®åˆ†ç±»ä½“ç³»


**æ•°æ®æ•æ„Ÿç­‰çº§åˆ’åˆ†**
```
å…¬å¼€æ•°æ®ï¼ˆPublicï¼‰ï¼š
â€¢ å«ä¹‰ï¼šå¯ä»¥å…¬å¼€å‘å¸ƒçš„æ•°æ®
â€¢ ä¸¾ä¾‹ï¼šå…¬å¸ä»‹ç»ã€äº§å“è¯´æ˜
â€¢ ä¿æŠ¤è¦æ±‚ï¼šåŸºæœ¬çš„å®Œæ•´æ€§ä¿æŠ¤
â€¢ æ ‡è¯†ï¼šç»¿è‰²æ ‡ç­¾

å†…éƒ¨æ•°æ®ï¼ˆInternalï¼‰ï¼š
â€¢ å«ä¹‰ï¼šä»…ä¾›å†…éƒ¨ä½¿ç”¨çš„æ•°æ®
â€¢ ä¸¾ä¾‹ï¼šå‘˜å·¥é€šè®¯å½•ã€å†…éƒ¨æ–‡æ¡£
â€¢ ä¿æŠ¤è¦æ±‚ï¼šè®¿é—®æ§åˆ¶ã€ä¼ è¾“åŠ å¯†
â€¢ æ ‡è¯†ï¼šé»„è‰²æ ‡ç­¾

æœºå¯†æ•°æ®ï¼ˆConfidentialï¼‰ï¼š
â€¢ å«ä¹‰ï¼šæ³„éœ²ä¼šé€ æˆé‡å¤§æŸå¤±çš„æ•°æ®
â€¢ ä¸¾ä¾‹ï¼šå®¢æˆ·ä¿¡æ¯ã€è´¢åŠ¡æ•°æ®
â€¢ ä¿æŠ¤è¦æ±‚ï¼šå¼ºåŠ å¯†ã€ä¸¥æ ¼è®¿é—®æ§åˆ¶
â€¢ æ ‡è¯†ï¼šæ©™è‰²æ ‡ç­¾

ç»å¯†æ•°æ®ï¼ˆTop Secretï¼‰ï¼š
â€¢ å«ä¹‰ï¼šæ³„éœ²ä¼šé€ æˆä¸¥é‡æ³•å¾‹é£é™©çš„æ•°æ®
â€¢ ä¸¾ä¾‹ï¼šä¸ªäººéšç§ã€å•†ä¸šæœºå¯†
â€¢ ä¿æŠ¤è¦æ±‚ï¼šæœ€é«˜çº§åˆ«åŠ å¯†å’Œå®¡è®¡
â€¢ æ ‡è¯†ï¼šçº¢è‰²æ ‡ç­¾
```

### 8.2 æ•°æ®æ ‡è¯†ä¸æ ‡è®°


**æ–‡ä»¶ç³»ç»Ÿæ ‡è®°**
```bash
# ä½¿ç”¨æ‰©å±•å±æ€§æ ‡è®°æ–‡ä»¶æ•æ„Ÿçº§åˆ«
setfattr -n user.sensitivity -v "confidential" sensitive_file.txt

# æŸ¥çœ‹æ–‡ä»¶æ•æ„Ÿçº§åˆ«
getfattr -n user.sensitivity sensitive_file.txt

# æ‰¹é‡æ ‡è®°ç›®å½•ä¸‹çš„æ–‡ä»¶
find /data/confidential -type f -exec setfattr -n user.sensitivity -v "confidential" {} \;
```

**æ•°æ®åº“å­—æ®µæ ‡è®°**
```sql
-- åœ¨æ•°æ®è¡¨ä¸­æ·»åŠ æ•æ„Ÿçº§åˆ«å­—æ®µ
ALTER TABLE data_catalog ADD COLUMN sensitivity_level ENUM(
    'public', 'internal', 'confidential', 'top_secret'
) DEFAULT 'internal';

-- æ ‡è®°æ•æ„Ÿå­—æ®µ
UPDATE data_catalog SET 
    sensitivity_level = 'confidential' 
WHERE column_name IN ('phone', 'email', 'id_card');

-- æŸ¥è¯¢ä¸åŒæ•æ„Ÿçº§åˆ«çš„å­—æ®µ
SELECT table_name, column_name, sensitivity_level 
FROM data_catalog 
WHERE sensitivity_level = 'confidential';
```

### 8.3 è®¿é—®æ§åˆ¶ç­–ç•¥


**åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶**
```bash
# åˆ›å»ºä¸åŒå®‰å…¨çº§åˆ«çš„ç”¨æˆ·ç»„
groupadd data_public
groupadd data_internal
groupadd data_confidential
groupadd data_topsecret

# è®¾ç½®ç›®å½•æƒé™
chmod 755 /data/public
chmod 750 /data/internal
chmod 740 /data/confidential
chmod 700 /data/topsecret

# è®¾ç½®ç»„å½’å±
chgrp data_public /data/public
chgrp data_internal /data/internal
chgrp data_confidential /data/confidential
chgrp data_topsecret /data/topsecret
```

**æ•°æ®åº“è®¿é—®æ§åˆ¶**
```sql
-- åˆ›å»ºä¸åŒæƒé™çš„æ•°æ®åº“ç”¨æˆ·
CREATE USER 'analyst'@'localhost' IDENTIFIED BY 'password';
CREATE USER 'developer'@'localhost' IDENTIFIED BY 'password';
CREATE USER 'dba'@'localhost' IDENTIFIED BY 'password';

-- åˆ†çº§æˆæƒ
-- åˆ†æå¸ˆï¼šåªèƒ½è®¿é—®è„±æ•æ•°æ®
GRANT SELECT ON database.user_masked TO 'analyst'@'localhost';

-- å¼€å‘è€…ï¼šå¯ä»¥è®¿é—®å†…éƒ¨æ•°æ®
GRANT SELECT, INSERT, UPDATE ON database.internal_* TO 'developer'@'localhost';

-- DBAï¼šå®Œå…¨è®¿é—®æƒé™
GRANT ALL PRIVILEGES ON database.* TO 'dba'@'localhost';
```

### 8.4 æ•°æ®ç”Ÿå‘½å‘¨æœŸç®¡ç†


**è‡ªåŠ¨åŒ–æ•°æ®åˆ†çº§è„šæœ¬**
```bash
#!/bin/bash
# data_classification.sh

DATA_DIR="/data"
LOG_FILE="/var/log/data_classification.log"

classify_file() {
    local file=$1
    local content_sample=$(head -100 "$file")
    
    # æ£€æŸ¥æ˜¯å¦åŒ…å«æ•æ„Ÿä¿¡æ¯
    if echo "$content_sample" | grep -qE "\b[0-9]{11}\b|\b[0-9]{18}[0-9X]\b"; then
        # åŒ…å«æ‰‹æœºå·æˆ–èº«ä»½è¯å·
        setfattr -n user.sensitivity -v "confidential" "$file"
        echo "$(date): $file classified as CONFIDENTIAL" >> $LOG_FILE
    elif echo "$content_sample" | grep -qE "\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b"; then
        # åŒ…å«é‚®ç®±åœ°å€
        setfattr -n user.sensitivity -v "internal" "$file"
        echo "$(date): $file classified as INTERNAL" >> $LOG_FILE
    else
        # é»˜è®¤ä¸ºå…¬å¼€
        setfattr -n user.sensitivity -v "public" "$file"
        echo "$(date): $file classified as PUBLIC" >> $LOG_FILE
    fi
}

# æ‰«ææ‰€æœ‰æ–‡ä»¶è¿›è¡Œåˆ†çº§
find $DATA_DIR -type f -name "*.txt" -o -name "*.csv" -o -name "*.log" | \
while read file; do
    classify_file "$file"
done
```

---

## 9. âš¡ åŠ å¯†æ€§èƒ½ä¼˜åŒ–é…ç½®


### 9.1 åŠ å¯†æ€§èƒ½åŸºç¡€


**å½±å“åŠ å¯†æ€§èƒ½çš„å› ç´ **
```
ç¡¬ä»¶å› ç´ ï¼š
â€¢ CPUæ€§èƒ½ï¼šå½±å“è½¯ä»¶åŠ å¯†é€Ÿåº¦
â€¢ ä¸“ç”¨åŠ å¯†æŒ‡ä»¤é›†ï¼šAES-NIç­‰ç¡¬ä»¶åŠ é€Ÿ
â€¢ å†…å­˜å¸¦å®½ï¼šå½±å“å¤§æ•°æ®é‡åŠ å¯†
â€¢ å­˜å‚¨æ€§èƒ½ï¼šå½±å“ç£ç›˜åŠ å¯†I/O

è½¯ä»¶å› ç´ ï¼š
â€¢ åŠ å¯†ç®—æ³•é€‰æ‹©ï¼šä¸åŒç®—æ³•æ€§èƒ½å·®å¼‚å¾ˆå¤§
â€¢ å®ç°è´¨é‡ï¼šä¼˜åŒ–ç¨‹åº¦å½±å“æ€§èƒ½
â€¢ å¹¶å‘å¤„ç†ï¼šå¤šçº¿ç¨‹å¯ä»¥æå‡æ€§èƒ½
â€¢ ç¼“å­˜ç­–ç•¥ï¼šå‡å°‘é‡å¤åŠ å¯†è®¡ç®—
```

**æ€§èƒ½æµ‹è¯•æ–¹æ³•**
```bash
# CPUåŠ å¯†æ€§èƒ½æµ‹è¯•
openssl speed aes-128-cbc aes-256-cbc chacha20-poly1305

# ç£ç›˜åŠ å¯†æ€§èƒ½æµ‹è¯•
hdparm -tT /dev/mapper/encrypted_disk

# ç½‘ç»œåŠ å¯†æ€§èƒ½æµ‹è¯•
iperf3 -s  # æœåŠ¡ç«¯
iperf3 -c server_ip --tls  # å®¢æˆ·ç«¯TLSæµ‹è¯•
```

### 9.2 ç¡¬ä»¶åŠ é€Ÿé…ç½®


**æ£€æŸ¥CPUåŠ å¯†æŒ‡ä»¤é›†**
```bash
# æ£€æŸ¥æ˜¯å¦æ”¯æŒAES-NI
grep -m1 -o aes /proc/cpuinfo

# æ£€æŸ¥æ”¯æŒçš„åŠ å¯†æŒ‡ä»¤
lscpu | grep -i aes
cat /proc/cpuinfo | grep flags | grep -o "aes\|avx\|sse"

# æŸ¥çœ‹ç¡¬ä»¶éšæœºæ•°ç”Ÿæˆå™¨
ls /dev/hwrng
```

**å¯ç”¨ç¡¬ä»¶åŠ é€Ÿ**
```bash
# ç¡®ä¿åŠ è½½AES-NIå†…æ ¸æ¨¡å—
modprobe aesni_intel

# éªŒè¯æ¨¡å—æ˜¯å¦åŠ è½½
lsmod | grep aes

# åœ¨å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½
echo "aesni_intel" >> /etc/modules-load.d/crypto.conf
```

### 9.3 LUKSæ€§èƒ½ä¼˜åŒ–


**é€‰æ‹©é«˜æ€§èƒ½åŠ å¯†ç®—æ³•**
```bash
# æµ‹è¯•ä¸åŒåŠ å¯†ç®—æ³•æ€§èƒ½
cryptsetup benchmark

# åˆ›å»ºä½¿ç”¨AES-XTSçš„LUKSåˆ†åŒºï¼ˆæ¨èï¼‰
cryptsetup luksFormat --cipher aes-xts-plain64 --key-size 256 \
--hash sha256 /dev/sdb1

# æŸ¥çœ‹å½“å‰LUKSé…ç½®
cryptsetup luksDump /dev/sdb1
```

**ä¼˜åŒ–LUKSå¯†é’¥è¿­ä»£æ¬¡æ•°**
```bash
# æŸ¥çœ‹å½“å‰è¿­ä»£æ¬¡æ•°
cryptsetup luksDump /dev/sdb1 | grep "PBKDF2 iterations"

# åŸºå‡†æµ‹è¯•ç¡®å®šåˆé€‚çš„è¿­ä»£æ¬¡æ•°ï¼ˆç›®æ ‡1-2ç§’ï¼‰
cryptsetup benchmark --pbkdf-force-iterations 1000000

# åˆ›å»ºæ—¶æŒ‡å®šè¿­ä»£æ¬¡æ•°
cryptsetup luksFormat --iter-time 2000 /dev/sdb1
```

### 9.4 SSL/TLSæ€§èƒ½ä¼˜åŒ–


**Nginx SSLä¼˜åŒ–é…ç½®**
```nginx
http {
    # å¯ç”¨SSLä¼šè¯ç¼“å­˜
    ssl_session_cache shared:SSL:10m;
    ssl_session_timeout 10m;
    
    # å¯ç”¨SSLä¼šè¯ç¥¨æ®
    ssl_session_tickets on;
    
    server {
        listen 443 ssl http2;
        
        # é€‰æ‹©é«˜æ€§èƒ½åŠ å¯†å¥—ä»¶
        ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256;
        ssl_prefer_server_ciphers off;
        
        # å¯ç”¨OCSPè£…è®¢
        ssl_stapling on;
        ssl_stapling_verify on;
        resolver 8.8.8.8 8.8.4.4 valid=300s;
        
        # é¢„åŠ è½½HSTS
        add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;
    }
}
```

**Apache SSLä¼˜åŒ–é…ç½®**
```apache
# å¯ç”¨SSLç¼“å­˜
SSLSessionCache shmcb:/var/cache/mod_ssl/scache(512000)
SSLSessionCacheTimeout 300

# ç¦ç”¨å‹ç¼©ï¼ˆé˜²æ­¢CRIMEæ”»å‡»ï¼‰
SSLCompression off

# é€‰æ‹©ç°ä»£åŠ å¯†å¥—ä»¶
SSLCipherSuite ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256

# å¯ç”¨OCSPè£…è®¢
SSLUseStapling on
SSLStaplingCache "shmcb:logs/stapling-cache(150000)"
```

### 9.5 æ•°æ®åº“åŠ å¯†æ€§èƒ½ä¼˜åŒ–


**MySQLåŠ å¯†æ€§èƒ½ä¼˜åŒ–**
```sql
-- å¯ç”¨æŸ¥è¯¢ç¼“å­˜ï¼ˆåŠ å¯†è¡¨é™¤å¤–ï¼‰
SET GLOBAL query_cache_type = ON;
SET GLOBAL query_cache_size = 268435456;  -- 256MB

-- è°ƒæ•´InnoDBç¼“å†²æ± å¤§å°
SET GLOBAL innodb_buffer_pool_size = 2147483648;  -- 2GB

-- å¯ç”¨å¹¶è¡ŒæŸ¥è¯¢ï¼ˆMySQL 8.0+ï¼‰
SET GLOBAL innodb_parallel_read_threads = 4;
```

**PostgreSQLåŠ å¯†æ€§èƒ½ä¼˜åŒ–**
```sql
-- è°ƒæ•´å·¥ä½œå†…å­˜
SET work_mem = '256MB';

-- å¯ç”¨å¹¶è¡ŒæŸ¥è¯¢
SET max_parallel_workers_per_gather = 4;
SET parallel_tuple_cost = 0.1;
SET parallel_setup_cost = 1000.0;

-- ä¼˜åŒ–æ£€æŸ¥ç‚¹å†™å…¥
SET checkpoint_completion_target = 0.9;
SET wal_buffers = '16MB';
```

**æ€§èƒ½ç›‘æ§è„šæœ¬**
```bash
#!/bin/bash
# crypto_performance_monitor.sh

LOGFILE="/var/log/crypto_performance.log"

# ç›‘æ§CPUä½¿ç”¨ç‡
CPU_USAGE=$(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1)

# ç›‘æ§å†…å­˜ä½¿ç”¨
MEM_USAGE=$(free | awk 'NR==2{printf "%.2f%%\t", $3*100/$2}')

# ç›‘æ§ç£ç›˜I/O
DISK_IO=$(iostat -d 1 1 | awk 'NR==4{print $4+$5}')

# è®°å½•æ€§èƒ½æ•°æ®
echo "$(date '+%Y-%m-%d %H:%M:%S') CPU:${CPU_USAGE}% MEM:${MEM_USAGE} DISK_IO:${DISK_IO}" >> $LOGFILE

# æ£€æŸ¥åŠ å¯†æœåŠ¡çŠ¶æ€
systemctl is-active cryptsetup > /dev/null && CRYPTO_STATUS="OK" || CRYPTO_STATUS="ERROR"
echo "$(date '+%Y-%m-%d %H:%M:%S') CRYPTO_STATUS:${CRYPTO_STATUS}" >> $LOGFILE
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 æ•°æ®ä¿æŠ¤å…³é”®è¦ç´ 


**ğŸ“Š ä¿æŠ¤å±‚æ¬¡å¯¹æ¯”è¡¨**

| ä¿æŠ¤å±‚æ¬¡ | **æŠ€æœ¯æ‰‹æ®µ** | **ä¿æŠ¤å¼ºåº¦** | **æ€§èƒ½å½±å“** | **é€‚ç”¨åœºæ™¯** |
|---------|-------------|-------------|-------------|-------------|
| ğŸ” **åº”ç”¨å±‚åŠ å¯†** | `ç¨‹åºå†…åŠ å¯†è§£å¯†` | â­â­â­â­â­ | `è¾ƒé«˜` | `æ•æ„Ÿå­—æ®µä¿æŠ¤` |
| ğŸ’¾ **æ•°æ®åº“åŠ å¯†** | `TDEé€æ˜åŠ å¯†` | â­â­â­â­ | `ä¸­ç­‰` | `æ•´åº“ä¿æŠ¤` |
| ğŸ—„ï¸ **æ–‡ä»¶ç³»ç»ŸåŠ å¯†** | `eCryptfs/EncFS` | â­â­â­ | `ä¸­ç­‰` | `ç”¨æˆ·ç›®å½•ä¿æŠ¤` |
| ğŸ’¿ **ç£ç›˜å…¨ç›˜åŠ å¯†** | `LUKS/dm-crypt` | â­â­â­â­â­ | `è¾ƒä½` | `æ•´æœºä¿æŠ¤` |

### 10.2 åŠ å¯†ç®—æ³•é€‰æ‹©æŒ‡å—


**å¯¹ç§°åŠ å¯†æ¨è**
```
é«˜å®‰å…¨æ€§è¦æ±‚ï¼š
âœ… AES-256-GCMï¼ˆè®¤è¯åŠ å¯†ï¼‰
âœ… ChaCha20-Poly1305ï¼ˆç§»åŠ¨è®¾å¤‡å‹å¥½ï¼‰

å¹³è¡¡æ€§èƒ½å’Œå®‰å…¨ï¼š
âœ… AES-128-GCMï¼ˆç¡¬ä»¶åŠ é€Ÿå¥½ï¼‰
âœ… AES-256-XTSï¼ˆç£ç›˜åŠ å¯†ä¸“ç”¨ï¼‰

é¿å…ä½¿ç”¨ï¼š
âŒ DESã€3DESï¼ˆå·²è¢«ç ´è§£ï¼‰
âŒ RC4ï¼ˆå­˜åœ¨ä¸¥é‡æ¼æ´ï¼‰
âŒ ECBæ¨¡å¼ï¼ˆä¸å®‰å…¨ï¼‰
```

**éå¯¹ç§°åŠ å¯†æ¨è**
```
ç°ä»£æ¨èï¼š
âœ… Ed25519ï¼ˆç­¾åï¼Œæ€§èƒ½æœ€ä½³ï¼‰
âœ… X25519ï¼ˆå¯†é’¥äº¤æ¢ï¼‰
âœ… RSA-4096ï¼ˆå…¼å®¹æ€§æœ€å¥½ï¼‰

ä¼ ç»Ÿé€‰æ‹©ï¼š
âœ… ECDSA P-256ï¼ˆå¹¿æ³›æ”¯æŒï¼‰
âœ… RSA-2048ï¼ˆæœ€ä½è¦æ±‚ï¼‰

é¿å…ä½¿ç”¨ï¼š
âŒ RSA-1024ï¼ˆå·²ä¸å®‰å…¨ï¼‰
âŒ DSAï¼ˆå­˜åœ¨è®¾è®¡ç¼ºé™·ï¼‰
```

### 10.3 å¯†é’¥ç®¡ç†æœ€ä½³å®è·µ


**ğŸ”‘ å¯†é’¥ç”Ÿå‘½å‘¨æœŸç®¡ç†æµç¨‹**
```
ç”Ÿæˆé˜¶æ®µï¼š
â€¢ ä½¿ç”¨å¯†ç å­¦å®‰å…¨éšæœºæ•°ç”Ÿæˆå™¨
â€¢ é€‰æ‹©è¶³å¤Ÿçš„å¯†é’¥é•¿åº¦
â€¢ è®°å½•å¯†é’¥åˆ›å»ºæ—¶é—´å’Œç”¨é€”

åˆ†å‘é˜¶æ®µï¼š
â€¢ é€šè¿‡å®‰å…¨é€šé“ä¼ è¾“ï¼ˆTLSã€VPNï¼‰
â€¢ ä½¿ç”¨å¯†é’¥å°è£…æœºåˆ¶
â€¢ éªŒè¯æ¥æ”¶æ–¹èº«ä»½

å­˜å‚¨é˜¶æ®µï¼š
â€¢ åŠ å¯†å­˜å‚¨æ‰€æœ‰å¯†é’¥
â€¢ å®æ–½è®¿é—®æ§åˆ¶
â€¢ å®šæœŸå¤‡ä»½å’Œæ¢å¤æµ‹è¯•

ä½¿ç”¨é˜¶æ®µï¼š
â€¢ æœ€å°æƒé™åŸåˆ™
â€¢ å®¡è®¡æ‰€æœ‰å¯†é’¥è®¿é—®
â€¢ é˜²æ­¢å¯†é’¥æ³„éœ²

è½®æ¢é˜¶æ®µï¼š
â€¢ åˆ¶å®šè½®æ¢è®¡åˆ’
â€¢ è‡ªåŠ¨åŒ–è½®æ¢æµç¨‹
â€¢ ä¿æŒæœåŠ¡è¿ç»­æ€§

é”€æ¯é˜¶æ®µï¼š
â€¢ å®‰å…¨åˆ é™¤å¯†é’¥æ•°æ®
â€¢ æ¸…ç†æ‰€æœ‰å‰¯æœ¬
â€¢ è®°å½•é”€æ¯æ—¥å¿—
```

### 10.4 æ€§èƒ½ä¼˜åŒ–æ ¸å¿ƒç­–ç•¥


**ç¡¬ä»¶ä¼˜åŒ–**
```bash
# éªŒè¯ç¡¬ä»¶åŠ é€Ÿæ”¯æŒ
grep -o aes /proc/cpuinfo  # æ£€æŸ¥AES-NI
lscpu | grep avx           # æ£€æŸ¥AVXæŒ‡ä»¤é›†

# å¯ç”¨ç¡¬ä»¶éšæœºæ•°ç”Ÿæˆå™¨
echo "rng-tools" >> /etc/modules
systemctl enable rngd
```

**ç®—æ³•é€‰æ‹©ä¼˜åŒ–**
```
ç£ç›˜åŠ å¯†ï¼šAES-XTS-256
ç½‘ç»œä¼ è¾“ï¼šChaCha20-Poly1305
æ•°æ®åº“ï¼šAES-GCM-256
æ–‡ä»¶åŠ å¯†ï¼šAES-CTR-256
```

### 10.5 åˆè§„æ€§æ£€æŸ¥æ¸…å•


**âœ… åŸºç¡€å®‰å…¨æ£€æŸ¥**
- æ‰€æœ‰æ•æ„Ÿæ•°æ®å·²åŠ å¯†å­˜å‚¨
- ç½‘ç»œä¼ è¾“ä½¿ç”¨TLS 1.2+
- å¯†é’¥å®šæœŸè½®æ¢ï¼ˆå»ºè®®90å¤©ï¼‰
- è¯ä¹¦åœ¨æœ‰æ•ˆæœŸå†…ä¸”è‡ªåŠ¨ç»­æœŸ
- è®¿é—®æ—¥å¿—å®Œæ•´è®°å½•

**âœ… é«˜çº§å®‰å…¨æ£€æŸ¥**
- å®æ–½æ•°æ®åˆ†ç±»åˆ†çº§ç®¡ç†
- æ•æ„Ÿæ•°æ®å·²è„±æ•å¤„ç†
- å»ºç«‹å¯†é’¥æ‰˜ç®¡æœºåˆ¶
- å®šæœŸè¿›è¡Œæ¸—é€æµ‹è¯•
- åˆ¶å®šæ•°æ®æ³„éœ²å“åº”è®¡åˆ’

### 10.6 æ•…éšœæ’æŸ¥å¸¸ç”¨å‘½ä»¤


```bash
# æ£€æŸ¥åŠ å¯†çŠ¶æ€
cryptsetup status encrypted_volume
dmsetup info encrypted_volume

# æ£€æŸ¥è¯ä¹¦çŠ¶æ€
openssl x509 -in cert.pem -text -noout
openssl s_client -connect domain:443

# æ€§èƒ½æµ‹è¯•
openssl speed aes-128-cbc
cryptsetup benchmark
hdparm -tT /dev/mapper/encrypted

# æ—¥å¿—æŸ¥çœ‹
journalctl -u cryptsetup
tail -f /var/log/ssl_access.log
grep "TLS" /var/log/nginx/access.log
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- æ•°æ®ä¸‰æ€è¦åŠ å¯†ï¼Œé™æ€ä¼ è¾“åŠ ä½¿ç”¨
- å¯†é’¥ç®¡ç†æ˜¯å…³é”®ï¼Œç”Ÿæˆåˆ†å‘å­˜å‚¨è½¬
- ç®—æ³•é€‰æ‹©çœ‹åœºæ™¯ï¼Œæ€§èƒ½å®‰å…¨è¦å¹³è¡¡
- åˆ†ç±»åˆ†çº§åšç®¡ç†ï¼Œè„±æ•å¤„ç†ä¿åˆè§„