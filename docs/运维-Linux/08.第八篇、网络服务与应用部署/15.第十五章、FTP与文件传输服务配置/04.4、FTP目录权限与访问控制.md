---
title: 4ã€FTPç›®å½•æƒé™ä¸è®¿é—®æ§åˆ¶
---
## ğŸ“š ç›®å½•

1. [FTPç›®å½•æƒé™åŸºç¡€æ¦‚å¿µ](#1-FTPç›®å½•æƒé™åŸºç¡€æ¦‚å¿µ)
2. [FTPæ ¹ç›®å½•è®¾ç½®ä¸æƒé™](#2-FTPæ ¹ç›®å½•è®¾ç½®ä¸æƒé™)
3. [ç”¨æˆ·ä¸»ç›®å½•é…ç½®è¯¦è§£](#3-ç”¨æˆ·ä¸»ç›®å½•é…ç½®è¯¦è§£)
4. [chrootç›‘ç‹±æœºåˆ¶é…ç½®](#4-chrootç›‘ç‹±æœºåˆ¶é…ç½®)
5. [ç›®å½•è®¿é—®æƒé™æ§åˆ¶](#5-ç›®å½•è®¿é—®æƒé™æ§åˆ¶)
6. [æ–‡ä»¶æ“ä½œæƒé™ç®¡ç†](#6-æ–‡ä»¶æ“ä½œæƒé™ç®¡ç†)
7. [æƒé™é…ç½®å®æˆ˜æ¡ˆä¾‹](#7-æƒé™é…ç½®å®æˆ˜æ¡ˆä¾‹)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ—ï¸ FTPç›®å½•æƒé™åŸºç¡€æ¦‚å¿µ


### 1.1 FTPæƒé™ç³»ç»Ÿçš„æœ¬è´¨


FTPæœåŠ¡çš„æƒé™æ§åˆ¶æœ¬è´¨ä¸Šæ˜¯**Linuxæ–‡ä»¶ç³»ç»Ÿæƒé™**å’Œ**FTPæœåŠ¡é…ç½®**çš„åŒé‡æ§åˆ¶æœºåˆ¶ã€‚

```
æƒé™æ§åˆ¶å±‚æ¬¡ï¼š
â”Œâ”€ FTPæœåŠ¡é…ç½®æƒé™ â”€â”  â† vsftpdé…ç½®æ–‡ä»¶æ§åˆ¶
â”‚                   â”‚
â”œâ”€ Linuxæ–‡ä»¶æƒé™ â”€â”€â”€â”¤  â† ç³»ç»Ÿçº§rwxæƒé™
â”‚                   â”‚
â””â”€ ç”¨æˆ·èº«ä»½éªŒè¯ â”€â”€â”€â”€â”€â”˜  â† ç”¨æˆ·ç™»å½•è®¤è¯
```

**ğŸ” æƒé™æ§åˆ¶åŸç†**
- **ç¬¬ä¸€å±‚**ï¼šç”¨æˆ·å¿…é¡»é€šè¿‡FTPèº«ä»½éªŒè¯
- **ç¬¬äºŒå±‚**ï¼šFTPæœåŠ¡é…ç½®å†³å®šç”¨æˆ·èƒ½åšä»€ä¹ˆæ“ä½œ
- **ç¬¬ä¸‰å±‚**ï¼šLinuxæ–‡ä»¶ç³»ç»Ÿæƒé™å†³å®šæ˜¯å¦çœŸæ­£å…è®¸æ“ä½œ

### 1.2 FTPç›®å½•æƒé™çš„æ ¸å¿ƒè¦ç´ 


**ğŸ“‹ æ ¸å¿ƒæ¦‚å¿µè§£æ**

**ç›®å½•æƒé™**ï¼šæ§åˆ¶ç”¨æˆ·å¯¹ç›®å½•çš„è®¿é—®èƒ½åŠ›
- `è¯»å–æƒé™`ï¼šèƒ½å¦æµè§ˆç›®å½•å†…å®¹ï¼ˆlså‘½ä»¤ï¼‰
- `å†™å…¥æƒé™`ï¼šèƒ½å¦åœ¨ç›®å½•ä¸­åˆ›å»ºã€åˆ é™¤æ–‡ä»¶
- `æ‰§è¡Œæƒé™`ï¼šèƒ½å¦è¿›å…¥ç›®å½•ï¼ˆcdå‘½ä»¤ï¼‰

**è®¿é—®æ§åˆ¶**ï¼šé™åˆ¶ç”¨æˆ·çš„æ“ä½œèŒƒå›´
- `è®¿é—®èŒƒå›´`ï¼šç”¨æˆ·èƒ½è®¿é—®å“ªäº›ç›®å½•
- `æ“ä½œæƒé™`ï¼šç”¨æˆ·èƒ½æ‰§è¡Œå“ªäº›æ“ä½œ
- `å®‰å…¨è¾¹ç•Œ`ï¼šé˜²æ­¢ç”¨æˆ·è¶Šæƒè®¿é—®

---

## 2. ğŸ  FTPæ ¹ç›®å½•è®¾ç½®ä¸æƒé™


### 2.1 FTPæ ¹ç›®å½•çš„æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯FTPæ ¹ç›®å½•ï¼Ÿ**
FTPæ ¹ç›®å½•æ˜¯ç”¨æˆ·é€šè¿‡FTPç™»å½•åçœ‹åˆ°çš„**é¡¶å±‚ç›®å½•**ï¼Œç›¸å½“äºç”¨æˆ·çš„"FTPä¸–ç•Œçš„èµ·ç‚¹"ã€‚

```
ç”¨æˆ·è§†è§’ï¼š
FTPæ ¹ç›®å½• = /        â† ç”¨æˆ·çœ‹åˆ°çš„æ ¹ç›®å½•
å®é™…è·¯å¾„ = /var/ftp   â† æœåŠ¡å™¨ä¸Šçš„çœŸå®è·¯å¾„

ç›®å½•æ˜ å°„å…³ç³»ï¼š
ç”¨æˆ·è®¿é—®è·¯å¾„     å®é™…ç³»ç»Ÿè·¯å¾„
/               /var/ftp/
/pub/           /var/ftp/pub/
/upload/        /var/ftp/upload/
```

### 2.2 FTPæ ¹ç›®å½•é…ç½®æ–¹æ³•


**ğŸ”§ é…ç½®FTPæ ¹ç›®å½•**

```bash
# ç¼–è¾‘vsftpdé…ç½®æ–‡ä»¶
vim /etc/vsftpd/vsftpd.conf

# è®¾ç½®åŒ¿åç”¨æˆ·æ ¹ç›®å½•
anon_root=/var/ftp

# è®¾ç½®æœ¬åœ°ç”¨æˆ·æ ¹ç›®å½•
local_root=/home/ftpusers
```

**é…ç½®é¡¹è¯¦è§£**ï¼š
- `anon_root`ï¼šåŒ¿åç”¨æˆ·ç™»å½•åçš„æ ¹ç›®å½•
- `local_root`ï¼šæœ¬åœ°ç”¨æˆ·ç™»å½•åçš„æ ¹ç›®å½•
- ä¸é…ç½®æ—¶ï¼Œç”¨æˆ·æ ¹ç›®å½•é»˜è®¤æ˜¯å…¶ç³»ç»Ÿä¸»ç›®å½•

### 2.3 æ ¹ç›®å½•æƒé™è®¾ç½®


**ğŸ”’ å®‰å…¨æƒé™é…ç½®**

```bash
# åˆ›å»ºFTPæ ¹ç›®å½•
mkdir -p /var/ftp

# è®¾ç½®æ ¹ç›®å½•æƒé™ï¼ˆé‡è¦ï¼šæ ¹ç›®å½•ä¸èƒ½æœ‰å†™æƒé™ï¼‰
chown root:root /var/ftp
chmod 755 /var/ftp

# åˆ›å»ºå¯å†™çš„å­ç›®å½•
mkdir /var/ftp/upload
chown ftp:ftp /var/ftp/upload
chmod 775 /var/ftp/upload
```

> âš ï¸ **å®‰å…¨è­¦å‘Š**ï¼šFTPæ ¹ç›®å½•ç»å¯¹ä¸èƒ½ç»™æ™®é€šç”¨æˆ·å†™æƒé™ï¼Œå¦åˆ™å­˜åœ¨å®‰å…¨é£é™©ï¼

**æƒé™è®¾ç½®åŸç†**ï¼š
```
æ ¹ç›®å½•æƒé™ï¼š755 (rwxr-xr-x)
â”œâ”€ æ‰€æœ‰è€…(root)ï¼šè¯»å†™æ‰§è¡Œ
â”œâ”€ åŒç»„ç”¨æˆ·ï¼šè¯»æ‰§è¡Œ
â””â”€ å…¶ä»–ç”¨æˆ·ï¼šè¯»æ‰§è¡Œ

ä¸ºä»€ä¹ˆæ ¹ç›®å½•ä¸èƒ½å†™ï¼Ÿ
- é˜²æ­¢ç”¨æˆ·ä¿®æ”¹ç³»ç»Ÿå…³é”®ç›®å½•
- é¿å…ç”¨æˆ·åˆ›å»ºå±é™©æ–‡ä»¶
- ç»´æŠ¤FTPæœåŠ¡ç¨³å®šæ€§
```

---

## 3. ğŸ¡ ç”¨æˆ·ä¸»ç›®å½•é…ç½®è¯¦è§£


### 3.1 ç”¨æˆ·ä¸»ç›®å½•çš„ä½œç”¨


**ç”¨æˆ·ä¸»ç›®å½•**æ˜¯æ¯ä¸ªFTPç”¨æˆ·ç™»å½•åçš„**ä¸“å±ç©ºé—´**ï¼Œç±»ä¼¼äºç”¨æˆ·çš„"ä¸ªäººæˆ¿é—´"ã€‚

```
ç”¨æˆ·ä¸»ç›®å½•ç»“æ„ç¤ºä¾‹ï¼š
/home/ftpuser1/          â† ç”¨æˆ·1çš„ä¸»ç›®å½•
â”œâ”€â”€ incoming/            â† ä¸Šä¼ ç›®å½•
â”œâ”€â”€ outgoing/            â† ä¸‹è½½ç›®å½•
â”œâ”€â”€ private/             â† ç§æœ‰æ–‡ä»¶
â””â”€â”€ shared/              â† å…±äº«ç›®å½•

/home/ftpuser2/          â† ç”¨æˆ·2çš„ä¸»ç›®å½•
â”œâ”€â”€ documents/
â”œâ”€â”€ projects/
â””â”€â”€ temp/
```

### 3.2 ä¸»ç›®å½•é…ç½®æ–¹æ³•


**ğŸ”§ åˆ›å»ºç”¨æˆ·ä¸»ç›®å½•**

```bash
# æ–¹æ³•1ï¼šåˆ›å»ºç”¨æˆ·æ—¶è‡ªåŠ¨åˆ›å»ºä¸»ç›®å½•
useradd -m -d /home/ftpuser1 -s /sbin/nologin ftpuser1

# æ–¹æ³•2ï¼šæ‰‹åŠ¨åˆ›å»ºä¸»ç›®å½•
mkdir /home/ftpuser1
chown ftpuser1:ftpuser1 /home/ftpuser1
chmod 755 /home/ftpuser1

# è®¾ç½®FTPå¯†ç 
passwd ftpuser1
```

**é…ç½®å‚æ•°è§£é‡Š**ï¼š
- `-m`ï¼šåˆ›å»ºç”¨æˆ·ä¸»ç›®å½•
- `-d`ï¼šæŒ‡å®šä¸»ç›®å½•è·¯å¾„
- `-s /sbin/nologin`ï¼šç¦æ­¢ç”¨æˆ·shellç™»å½•ï¼ˆä»…å…è®¸FTPï¼‰

### 3.3 ä¸»ç›®å½•æƒé™ç®¡ç†


**ğŸ“Š ä¸»ç›®å½•æƒé™é…ç½®è¡¨**

| æƒé™è®¾ç½® | æ•°å€¼ | å«ä¹‰ | é€‚ç”¨åœºæ™¯ |
|---------|------|------|----------|
| `755` | rwxr-xr-x | ç”¨æˆ·å®Œå…¨æ§åˆ¶ï¼Œä»–äººåªè¯» | **æ ‡å‡†é…ç½®** |
| `750` | rwxr-x--- | ç”¨æˆ·å®Œå…¨æ§åˆ¶ï¼Œç»„å¯è¯» | éƒ¨é—¨å†…å…±äº« |
| `700` | rwx------ | ä»…ç”¨æˆ·å¯è®¿é—® | é«˜åº¦ç§å¯† |

**å®é™…é…ç½®ç¤ºä¾‹**ï¼š

```bash
# æ ‡å‡†ä¸»ç›®å½•é…ç½®
chown ftpuser1:ftpuser1 /home/ftpuser1
chmod 755 /home/ftpuser1

# åˆ›å»ºåŠŸèƒ½å­ç›®å½•
mkdir /home/ftpuser1/{upload,download,private}
chmod 755 /home/ftpuser1/upload
chmod 755 /home/ftpuser1/download
chmod 700 /home/ftpuser1/private
```

---

## 4. ğŸ”’ chrootç›‘ç‹±æœºåˆ¶é…ç½®


### 4.1 ä»€ä¹ˆæ˜¯chrootç›‘ç‹±


**chrootç›‘ç‹±**æ˜¯ä¸€ç§**å®‰å…¨éš”ç¦»æœºåˆ¶**ï¼ŒæŠŠç”¨æˆ·"å…³"åœ¨æŒ‡å®šç›®å½•ä¸­ï¼Œè®©ç”¨æˆ·æ— æ³•è®¿é—®ç›®å½•å¤–çš„ä»»ä½•æ–‡ä»¶ã€‚

```
æ— chrootçŠ¶æ€ï¼š
ç”¨æˆ·å¯ä»¥è®¿é—®ï¼š/ï¼Œ/etcï¼Œ/usrï¼Œ/var...  â† å±é™©ï¼

æœ‰chrootçŠ¶æ€ï¼š
ç”¨æˆ·åªèƒ½è®¿é—®ï¼š/home/ftpuser1/       â† å®‰å…¨ï¼
             â”œâ”€â”€ è¿™æ˜¯ç”¨æˆ·çš„"æ•´ä¸ªä¸–ç•Œ"
             â””â”€â”€ æ— æ³•è®¿é—®ä¸Šçº§ç›®å½•
```

**ğŸ” ç›‘ç‹±æœºåˆ¶åŸç†**
- ç”¨æˆ·ç™»å½•åï¼Œç³»ç»Ÿå°†å…¶**æ ¹ç›®å½•é‡æ–°å®šä¹‰**
- ç”¨æˆ·çœ‹åˆ°çš„"/"å®é™…æ˜¯è¢«é™åˆ¶çš„ç›®å½•
- ç”¨æˆ·æ— æ³•ä½¿ç”¨`../`è·³å‡ºç›‘ç‹±èŒƒå›´

### 4.2 chroot_local_useré…ç½®


**ğŸ”§ å¯ç”¨æœ¬åœ°ç”¨æˆ·ç›‘ç‹±**

```bash
# ç¼–è¾‘vsftpdé…ç½®æ–‡ä»¶
vim /etc/vsftpd/vsftpd.conf

# å¯ç”¨æœ¬åœ°ç”¨æˆ·chroot
chroot_local_user=YES

# å…è®¸ç”¨æˆ·åœ¨chrootç›®å½•ä¸­å†™å…¥ï¼ˆå¯é€‰ï¼‰
allow_writeable_chroot=YES
```

**é…ç½®é¡¹è¯¦è§£**ï¼š
- `chroot_local_user=YES`ï¼šæ‰€æœ‰æœ¬åœ°ç”¨æˆ·éƒ½è¢«é™åˆ¶åœ¨ä¸»ç›®å½•
- `allow_writeable_chroot=YES`ï¼šå…è®¸chrootç›®å½•å¯å†™ï¼ˆéœ€è°¨æ…ä½¿ç”¨ï¼‰

### 4.3 chrootå¼‚å¸¸å¤„ç†


**âŒ å¸¸è§chrooté”™è¯¯**

```bash
# é”™è¯¯ä¿¡æ¯ï¼š500 OOPS: vsftpd: refusing to run with writable root inside chroot()
# åŸå› ï¼šchrootæ ¹ç›®å½•æœ‰å†™æƒé™

# è§£å†³æ–¹æ¡ˆ1ï¼šç§»é™¤æ ¹ç›®å½•å†™æƒé™
chmod 755 /home/ftpuser1

# è§£å†³æ–¹æ¡ˆ2ï¼šå¯ç”¨writeable_chroot
echo "allow_writeable_chroot=YES" >> /etc/vsftpd/vsftpd.conf
```

**ğŸ”„ chrootç›®å½•ç»“æ„æœ€ä½³å®è·µ**ï¼š

```
/home/ftpuser1/              â† æ ¹ç›®å½•(755ï¼Œä¸å¯å†™)
â”œâ”€â”€ files/                   â† å¯å†™ç›®å½•(775)
â”œâ”€â”€ incoming/                â† ä¸Šä¼ ç›®å½•(775)  
â””â”€â”€ outgoing/                â† ä¸‹è½½ç›®å½•(755ï¼Œåªè¯»)
```

---

## 5. ğŸ—‚ï¸ ç›®å½•è®¿é—®æƒé™æ§åˆ¶


### 5.1 ç›®å½•æµè§ˆæƒé™ç®¡ç†


**ç›®å½•æµè§ˆæƒé™**æ§åˆ¶ç”¨æˆ·èƒ½å¦æŸ¥çœ‹ç›®å½•å†…å®¹ï¼Œç›¸å½“äº"èƒ½å¦çœ‹åˆ°æˆ¿é—´é‡Œæœ‰ä»€ä¹ˆ"ã€‚

**ğŸ”§ é…ç½®ç›®å½•æµè§ˆæƒé™**

```bash
# vsftpdé…ç½®æ–‡ä»¶è®¾ç½®
vim /etc/vsftpd/vsftpd.conf

# æ§åˆ¶åŒ¿åç”¨æˆ·ç›®å½•æµè§ˆ
anon_browse_enable=YES    # å…è®¸åŒ¿åç”¨æˆ·æµè§ˆç›®å½•
anon_mkdir_write_enable=NO # ç¦æ­¢åŒ¿åç”¨æˆ·åˆ›å»ºç›®å½•

# æ§åˆ¶æœ¬åœ°ç”¨æˆ·ç›®å½•æµè§ˆ
local_enable=YES          # å…è®¸æœ¬åœ°ç”¨æˆ·ç™»å½•
write_enable=YES          # å…è®¸å†™æ“ä½œ
```

### 5.2 ç›®å½•è®¿é—®æƒé™å±‚çº§


**ğŸ“Š æƒé™æ§åˆ¶å±‚çº§å›¾**

```
ç›®å½•æƒé™å±‚çº§ï¼š
â”Œâ”€ FTPæœåŠ¡æƒé™ â”€â”
â”‚ browse_enable â”‚  â† æ˜¯å¦å…è®¸æµè§ˆ
â”‚ mkdir_enable  â”‚  â† æ˜¯å¦å…è®¸åˆ›å»ºç›®å½•
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€ Linuxç›®å½•æƒé™ â”
â”‚ r (è¯»å–) = 4   â”‚  â† æµè§ˆç›®å½•å†…å®¹
â”‚ w (å†™å…¥) = 2   â”‚  â† åˆ›å»º/åˆ é™¤æ–‡ä»¶
â”‚ x (æ‰§è¡Œ) = 1   â”‚  â† è¿›å…¥ç›®å½•
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®é™…æƒé™éªŒè¯**ï¼š

```bash
# æµ‹è¯•ç›®å½•æƒé™
ls -la /var/ftp/
drwxr-xr-x  3 root root  4096 Jan 20 10:30 .
drwxr-xr-x 23 root root  4096 Jan 20 10:29 ..
drwxrwx---  2 ftp  ftp   4096 Jan 20 10:31 upload

# æƒé™è§£è¯»ï¼š
# uploadç›®å½•ï¼šftpç”¨æˆ·å’Œç»„å¯è¯»å†™æ‰§è¡Œï¼Œå…¶ä»–ç”¨æˆ·æ— æƒé™
```

### 5.3 ç‰¹æ®Šç›®å½•æƒé™é…ç½®


**ğŸ¯ ä¸åŒåŠŸèƒ½ç›®å½•çš„æƒé™é…ç½®**

```bash
# åªè¯»ä¸‹è½½ç›®å½•
mkdir /var/ftp/download
chown root:ftp /var/ftp/download
chmod 754 /var/ftp/download

# åªå†™ä¸Šä¼ ç›®å½•  
mkdir /var/ftp/upload
chown ftp:ftp /var/ftp/upload
chmod 730 /var/ftp/upload

# è¯»å†™å…±äº«ç›®å½•
mkdir /var/ftp/shared
chown ftp:ftp /var/ftp/shared
chmod 775 /var/ftp/shared
```

**æƒé™é…ç½®è¯´æ˜è¡¨**ï¼š

| ç›®å½•ç±»å‹ | æƒé™ | è¯´æ˜ | ç”¨æˆ·ä½“éªŒ |
|----------|------|------|----------|
| **åªè¯»ç›®å½•** | `754` | ç”¨æˆ·åªèƒ½ä¸‹è½½æ–‡ä»¶ | çœ‹å¾—è§ï¼Œæ‹¿å¾—åˆ°ï¼Œæ”¹ä¸äº† |
| **åªå†™ç›®å½•** | `730` | ç”¨æˆ·åªèƒ½ä¸Šä¼ æ–‡ä»¶ | æ”¾å¾—è¿›ï¼Œçœ‹ä¸è§å†…å®¹ |
| **è¯»å†™ç›®å½•** | `775` | ç”¨æˆ·å¯ä»¥ä¸Šä¼ ä¸‹è½½ | å®Œå…¨æ§åˆ¶ |

---

## 6. ğŸ“ æ–‡ä»¶æ“ä½œæƒé™ç®¡ç†


### 6.1 ä¸Šä¼ ä¸‹è½½æƒé™è®¾ç½®


**ä¸Šä¼ æƒé™**æ§åˆ¶ç”¨æˆ·èƒ½å¦å‘FTPæœåŠ¡å™¨ä¼ è¾“æ–‡ä»¶ã€‚

**ğŸ”§ ä¸Šä¼ æƒé™é…ç½®**

```bash
# vsftpdä¸»é…ç½®
vim /etc/vsftpd/vsftpd.conf

# æœ¬åœ°ç”¨æˆ·ä¸Šä¼ æƒé™
local_enable=YES          # å…è®¸æœ¬åœ°ç”¨æˆ·ç™»å½•
write_enable=YES          # å…¨å±€å†™å…¥å¼€å…³
local_umask=022           # ä¸Šä¼ æ–‡ä»¶é»˜è®¤æƒé™

# åŒ¿åç”¨æˆ·ä¸Šä¼ æƒé™
anonymous_enable=YES      # å…è®¸åŒ¿åç™»å½•
anon_upload_enable=YES    # å…è®¸åŒ¿åä¸Šä¼ 
anon_umask=077            # åŒ¿åä¸Šä¼ æ–‡ä»¶æƒé™
```

**ğŸ” umaskæƒé™è®¡ç®—**
- `umask=022`ï¼šä¸Šä¼ æ–‡ä»¶æƒé™ = 666-022 = 644ï¼ˆrw-r--r--ï¼‰
- `umask=077`ï¼šä¸Šä¼ æ–‡ä»¶æƒé™ = 666-077 = 600ï¼ˆrw-------ï¼‰

### 6.2 æ–‡ä»¶åˆ é™¤é‡å‘½åæƒé™


**åˆ é™¤æƒé™**è®©ç”¨æˆ·èƒ½å¤Ÿç§»é™¤ä¸éœ€è¦çš„æ–‡ä»¶ã€‚

```bash
# æ–‡ä»¶åˆ é™¤æƒé™é…ç½®
anon_other_write_enable=YES    # åŒ¿åç”¨æˆ·åˆ é™¤é‡å‘½åæƒé™
local_write_enable=YES         # æœ¬åœ°ç”¨æˆ·å†™æƒé™ï¼ˆåŒ…å«åˆ é™¤ï¼‰

# é‡å‘½åæƒé™ä¸€èˆ¬è·Ÿéšåˆ é™¤æƒé™
# ç”¨æˆ·æœ‰åˆ é™¤æƒé™é€šå¸¸å°±æœ‰é‡å‘½åæƒé™
```

**æƒé™éªŒè¯ç¤ºä¾‹**ï¼š

```bash
# åˆ›å»ºæµ‹è¯•æ–‡ä»¶
echo "test content" > /var/ftp/upload/test.txt
chown ftp:ftp /var/ftp/upload/test.txt

# ç”¨æˆ·å¯ä»¥æ‰§è¡Œçš„æ“ä½œï¼š
# DELE test.txt     â† åˆ é™¤æ–‡ä»¶
# RNFR test.txt     â† é‡å‘½åæºæ–‡ä»¶
# RNTO newname.txt  â† é‡å‘½åç›®æ ‡æ–‡ä»¶
```

### 6.3 ç›®å½•åˆ›å»ºæƒé™æ§åˆ¶


**ç›®å½•åˆ›å»ºæƒé™**å…è®¸ç”¨æˆ·åœ¨FTPæœåŠ¡å™¨ä¸Šå»ºç«‹æ–°çš„æ–‡ä»¶å¤¹ã€‚

**ğŸ“‹ ç›®å½•åˆ›å»ºæƒé™é…ç½®**

```bash
# ç›®å½•åˆ›å»ºæƒé™
anon_mkdir_write_enable=YES   # åŒ¿åç”¨æˆ·åˆ›å»ºç›®å½•
local_mkdir_write_enable=YES  # æœ¬åœ°ç”¨æˆ·åˆ›å»ºç›®å½•ï¼ˆé€šå¸¸é»˜è®¤å¼€å¯ï¼‰

# ç›®å½•æƒé™è®¾ç½®
anon_umask=022               # åˆ›å»ºç›®å½•çš„é»˜è®¤æƒé™
```

**æƒé™æµ‹è¯•å®ä¾‹**ï¼š

```bash
# ç”¨æˆ·ç™»å½•åå¯ä»¥æ‰§è¡Œï¼š
ftp> mkdir newdir           # åˆ›å»ºç›®å½•
ftp> rmdir emptydir        # åˆ é™¤ç©ºç›®å½•
ftp> cd newdir             # è¿›å…¥ç›®å½•
```

---

## 7. ğŸ› ï¸ æƒé™é…ç½®å®æˆ˜æ¡ˆä¾‹


### 7.1 ä¼ä¸šæ–‡ä»¶å…±äº«åœºæ™¯


**éœ€æ±‚åˆ†æ**ï¼šä¼ä¸šéœ€è¦ä¸€ä¸ªFTPæœåŠ¡å™¨ï¼Œä¸åŒéƒ¨é—¨æœ‰ä¸åŒçš„è®¿é—®æƒé™ã€‚

```
ä¼ä¸šFTPç›®å½•ç»“æ„ï¼š
/var/ftp/company/
â”œâ”€â”€ public/              â† æ‰€æœ‰äººå¯è¯»
â”œâ”€â”€ sales/               â† é”€å”®éƒ¨å¯è¯»å†™
â”œâ”€â”€ tech/                â† æŠ€æœ¯éƒ¨å¯è¯»å†™
â”œâ”€â”€ upload/              â† ä¸´æ—¶ä¸Šä¼ åŒº
â””â”€â”€ download/            â† å…¬å…±ä¸‹è½½åŒº
```

**ğŸ”§ é…ç½®å®ç°æ­¥éª¤**

```bash
# 1. åˆ›å»ºç”¨æˆ·ç»„
groupadd sales_group
groupadd tech_group
groupadd ftp_users

# 2. åˆ›å»ºéƒ¨é—¨ç”¨æˆ·
useradd -m -g sales_group -G ftp_users -s /sbin/nologin sales_user
useradd -m -g tech_group -G ftp_users -s /sbin/nologin tech_user

# 3. åˆ›å»ºç›®å½•ç»“æ„
mkdir -p /var/ftp/company/{public,sales,tech,upload,download}

# 4. è®¾ç½®ç›®å½•æƒé™
chmod 755 /var/ftp/company/public
chmod 770 /var/ftp/company/sales
chmod 770 /var/ftp/company/tech
chmod 733 /var/ftp/company/upload
chmod 755 /var/ftp/company/download

# 5. è®¾ç½®ç›®å½•æ‰€å±
chown root:ftp_users /var/ftp/company/public
chown root:sales_group /var/ftp/company/sales  
chown root:tech_group /var/ftp/company/tech
chown ftp:ftp /var/ftp/company/upload
chown root:ftp_users /var/ftp/company/download
```

### 7.2 ä¸ªäººç½‘ç›˜åœºæ™¯


**éœ€æ±‚**ï¼šä¸ºä¸ªäººç”¨æˆ·æä¾›ç§æœ‰çš„ç½‘ç›˜ç©ºé—´ã€‚

```bash
# é…ç½®ä¸ªäººç”¨æˆ·chrootç¯å¢ƒ
vim /etc/vsftpd/vsftpd.conf

# åŸºç¡€é…ç½®
local_enable=YES
chroot_local_user=YES
allow_writeable_chroot=YES
local_root=/home/$USER

# åˆ›å»ºç”¨æˆ·ç›®å½•ç»“æ„
create_user_workspace() {
    local username=$1
    local userdir="/home/$username"
    
    # åˆ›å»ºç›®å½•
    mkdir -p "$userdir"/{private,shared,temp}
    
    # è®¾ç½®æƒé™
    chown $username:$username "$userdir"
    chmod 755 "$userdir"
    
    # å­ç›®å½•æƒé™
    chmod 700 "$userdir/private"   # å®Œå…¨ç§æœ‰
    chmod 755 "$userdir/shared"    # å¯åˆ†äº«
    chmod 755 "$userdir/temp"      # ä¸´æ—¶æ–‡ä»¶
}

# ä½¿ç”¨å‡½æ•°åˆ›å»ºç”¨æˆ·å·¥ä½œç©ºé—´
create_user_workspace "john"
create_user_workspace "mary"
```

### 7.3 åŒ¿åä¸Šä¼ ä¸‹è½½åœºæ™¯


**é…ç½®åŒ¿åç”¨æˆ·å®‰å…¨çš„ä¸Šä¼ ä¸‹è½½ç¯å¢ƒ**

```bash
# vsftpdåŒ¿åé…ç½®
vim /etc/vsftpd/vsftpd.conf

anonymous_enable=YES
anon_upload_enable=YES
anon_mkdir_write_enable=YES
anon_other_write_enable=NO    # ç¦æ­¢åˆ é™¤ä»–äººæ–‡ä»¶
anon_root=/var/ftp
anon_umask=022

# åˆ›å»ºåŒ¿åç›®å½•ç»“æ„
mkdir -p /var/ftp/{pub,incoming}

# pubç›®å½•ï¼šåªè¯»ä¸‹è½½
chown root:root /var/ftp/pub
chmod 755 /var/ftp/pub

# incomingç›®å½•ï¼šåªèƒ½ä¸Šä¼ ï¼Œçœ‹ä¸åˆ°å†…å®¹
chown ftp:ftp /var/ftp/incoming  
chmod 333 /var/ftp/incoming     # ç‰¹æ®Šæƒé™ï¼šåªå†™ä¸è¯»
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ FTPæƒé™ = FTPé…ç½® + Linuxæ–‡ä»¶æƒé™ + ç”¨æˆ·è®¤è¯
ğŸ”¸ æ ¹ç›®å½•ï¼šç”¨æˆ·FTPä¸–ç•Œçš„èµ·ç‚¹ï¼Œå¿…é¡»å®‰å…¨é…ç½®
ğŸ”¸ ä¸»ç›®å½•ï¼šç”¨æˆ·çš„ä¸“å±ç©ºé—´ï¼Œæƒé™è¦ç²¾ç¡®æ§åˆ¶
ğŸ”¸ chrootç›‘ç‹±ï¼šå®‰å…¨éš”ç¦»æœºåˆ¶ï¼Œé˜²æ­¢ç”¨æˆ·è¶Šæƒ
ğŸ”¸ æƒé™å±‚çº§ï¼šæœåŠ¡æƒé™ â†’ ç›®å½•æƒé™ â†’ æ–‡ä»¶æƒé™
```

### 8.2 å…³é”®é…ç½®è¦ç‚¹


**ğŸ”¹ å®‰å…¨åŸåˆ™**
```
- æ ¹ç›®å½•ä¸å¯å†™ï¼šé˜²æ­¢ç³»ç»Ÿå®‰å…¨é£é™©
- æœ€å°æƒé™åŸåˆ™ï¼šåªç»™å¿…éœ€çš„æƒé™
- ç”¨æˆ·éš”ç¦»ï¼šä¸åŒç”¨æˆ·æœ‰ç‹¬ç«‹ç©ºé—´
- æƒé™åˆ†ç¦»ï¼šè¯»å†™æƒé™åˆ†å¼€ç®¡ç†
```

**ğŸ”¹ å¸¸ç”¨æƒé™æ­é…**
```
æ ‡å‡†é…ç½®ï¼š
- æ ¹ç›®å½•ï¼š755ï¼ˆrwxr-xr-xï¼‰
- ä¸»ç›®å½•ï¼š755ï¼ˆrwxr-xr-xï¼‰  
- ä¸Šä¼ ç›®å½•ï¼š775ï¼ˆrwxrwxr-xï¼‰
- ä¸‹è½½ç›®å½•ï¼š755ï¼ˆrwxr-xr-xï¼‰
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ é…ç½®æµç¨‹**
1. **è§„åˆ’ç›®å½•ç»“æ„**ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚è®¾è®¡ç›®å½•
2. **åˆ›å»ºç”¨æˆ·å’Œç»„**ï¼šæŒ‰éƒ¨é—¨æˆ–åŠŸèƒ½åˆ†ç»„
3. **è®¾ç½®åŸºç¡€æƒé™**ï¼šå…ˆé…ç½®Linuxæ–‡ä»¶ç³»ç»Ÿæƒé™
4. **é…ç½®FTPæœåŠ¡**ï¼šå†è®¾ç½®vsftpdé…ç½®é¡¹
5. **æµ‹è¯•éªŒè¯æƒé™**ï¼šç”¨å®é™…ç”¨æˆ·æµ‹è¯•å„ç§æ“ä½œ

**ğŸ”§ æ•…éšœæ’æŸ¥æ€è·¯**
```
æƒé™é—®é¢˜æ’æŸ¥ï¼š
1. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦èƒ½ç™»å½•FTP
2. æ£€æŸ¥FTPæœåŠ¡é…ç½®æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥ç›®å½•çš„Linuxæƒé™è®¾ç½®
4. æ£€æŸ¥ç”¨æˆ·å’Œç»„çš„å½’å±å…³ç³»
5. æŸ¥çœ‹FTPæœåŠ¡æ—¥å¿—æ‰¾é”™è¯¯ä¿¡æ¯
```

**ğŸ’¡ æœ€ä½³å®è·µå»ºè®®**
- **å¤‡ä»½é…ç½®**ï¼šä¿®æ”¹å‰å…ˆå¤‡ä»½é…ç½®æ–‡ä»¶
- **é€æ­¥æµ‹è¯•**ï¼šæ¯æ¬¡åªæ”¹ä¸€ä¸ªé…ç½®é¡¹å¹¶æµ‹è¯•
- **æ–‡æ¡£è®°å½•**ï¼šè®°å½•æ¯ä¸ªç”¨æˆ·çš„æƒé™è®¾ç½®
- **å®šæœŸå®¡æŸ¥**ï¼šå®šæœŸæ£€æŸ¥æƒé™é…ç½®æ˜¯å¦åˆç†
- **ç›‘æ§æ—¥å¿—**ï¼šå…³æ³¨FTPè®¿é—®æ—¥å¿—å‘ç°å¼‚å¸¸

**æ ¸å¿ƒè®°å¿†**ï¼š
- FTPæƒé™æ˜¯å¤šå±‚æ§åˆ¶ï¼Œæ¯å±‚éƒ½è¦æ­£ç¡®é…ç½®
- å®‰å…¨ç¬¬ä¸€ï¼Œç»™ç”¨æˆ·åˆšå¥½å¤Ÿç”¨çš„æƒé™å³å¯
- chrootç›‘ç‹±æ˜¯FTPå®‰å…¨çš„é‡è¦ä¿éšœ
- æƒé™é…ç½®è¦ä¸å®é™…ä¸šåŠ¡éœ€æ±‚åŒ¹é…