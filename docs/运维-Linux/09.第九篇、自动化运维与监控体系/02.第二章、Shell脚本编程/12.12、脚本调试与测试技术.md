---
title: 12ã€è„šæœ¬è°ƒè¯•ä¸æµ‹è¯•æŠ€æœ¯
---
## ğŸ“š ç›®å½•

1. [Shellè°ƒè¯•åŸºç¡€æ¦‚å¿µ](#1-Shellè°ƒè¯•åŸºç¡€æ¦‚å¿µ)
2. [bashè°ƒè¯•é€‰é¡¹è¯¦è§£](#2-bashè°ƒè¯•é€‰é¡¹è¯¦è§£)
3. [è°ƒè¯•ä¿¡æ¯è¾“å‡ºä¸æ§åˆ¶](#3-è°ƒè¯•ä¿¡æ¯è¾“å‡ºä¸æ§åˆ¶)
4. [æ–­ç‚¹è®¾ç½®ä¸å•æ­¥æ‰§è¡Œ](#4-æ–­ç‚¹è®¾ç½®ä¸å•æ­¥æ‰§è¡Œ)
5. [å˜é‡çŠ¶æ€ç›‘æ§ä¸è·Ÿè¸ª](#5-å˜é‡çŠ¶æ€ç›‘æ§ä¸è·Ÿè¸ª)
6. [æ€§èƒ½åˆ†æä¸æ—¶é—´æµ‹é‡](#6-æ€§èƒ½åˆ†æä¸æ—¶é—´æµ‹é‡)
7. [å•å…ƒæµ‹è¯•æ¡†æ¶ä½¿ç”¨](#7-å•å…ƒæµ‹è¯•æ¡†æ¶ä½¿ç”¨)
8. [ä»£ç è¦†ç›–ç‡ç»Ÿè®¡](#8-ä»£ç è¦†ç›–ç‡ç»Ÿè®¡)
9. [é™æ€ä»£ç åˆ†æå·¥å…·](#9-é™æ€ä»£ç åˆ†æå·¥å…·)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ› Shellè°ƒè¯•åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯Shellè„šæœ¬è°ƒè¯•

**è°ƒè¯•**å°±æ˜¯æ‰¾å‡ºè„šæœ¬ä¸­é”™è¯¯çš„è¿‡ç¨‹ï¼Œå°±åƒåŒ»ç”Ÿè¯Šæ–­ç—…æƒ…ä¸€æ ·ã€‚å½“ä½ çš„è„šæœ¬è¿è¡Œä¸æ­£å¸¸æ—¶ï¼Œè°ƒè¯•å¸®åŠ©ä½ ï¼š
- **å®šä½é—®é¢˜**ï¼šæ‰¾å‡ºé”™è¯¯å‘ç”Ÿåœ¨å“ªä¸€è¡Œ
- **åˆ†æåŸå› **ï¼šç†è§£ä¸ºä»€ä¹ˆä¼šå‡ºé”™
- **éªŒè¯ä¿®å¤**ï¼šç¡®è®¤ä¿®æ”¹åçš„ä»£ç æ­£ç¡®å·¥ä½œ

### 1.2 å¸¸è§çš„è„šæœ¬é—®é¢˜ç±»å‹


**è¯­æ³•é”™è¯¯**ï¼š
```bash
# é”™è¯¯ç¤ºä¾‹ - ç¼ºå°‘ç©ºæ ¼
if["$name" == "tom"]; then
    echo "Hello Tom"
fi

# æ­£ç¡®å†™æ³•
if [ "$name" == "tom" ]; then
    echo "Hello Tom"
fi
```

**é€»è¾‘é”™è¯¯**ï¼š
```bash
# é”™è¯¯ç¤ºä¾‹ - æ¡ä»¶åˆ¤æ–­åäº†
if [ $age -lt 18 ]; then
    echo "æˆå¹´äºº"  # é€»è¾‘é”™è¯¯ï¼šå°äº18å²ä¸æ˜¯æˆå¹´äºº
fi

# æ­£ç¡®å†™æ³•  
if [ $age -ge 18 ]; then
    echo "æˆå¹´äºº"
fi
```

**è¿è¡Œæ—¶é”™è¯¯**ï¼š
```bash
# å¯èƒ½å‡ºé”™çš„æƒ…å†µ
filename="nonexistent.txt"
cat $filename  # å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ä¼šæŠ¥é”™
```

### 1.3 è°ƒè¯•çš„é‡è¦æ€§


```
æ— è°ƒè¯•å¼€å‘ï¼š
å†™ä»£ç  â†’ è¿è¡Œ â†’ å‡ºé”™ â†’ çŒœæµ‹é—®é¢˜ â†’ ç›²ç›®ä¿®æ”¹ â†’ ç»§ç»­å‡ºé”™
æ—¶é—´æ¶ˆè€—ï¼šâ­â­â­â­â­

æœ‰è°ƒè¯•å¼€å‘ï¼š
å†™ä»£ç  â†’ è¿è¡Œ â†’ å‡ºé”™ â†’ è°ƒè¯•å®šä½ â†’ ç²¾å‡†ä¿®å¤ â†’ éªŒè¯é€šè¿‡  
æ—¶é—´æ¶ˆè€—ï¼šâ­â­
```

---

## 2. ğŸ”§ bashè°ƒè¯•é€‰é¡¹è¯¦è§£


### 2.1 åŸºæœ¬è°ƒè¯•é€‰é¡¹æ¦‚è¿°


bashæä¾›äº†å‡ ä¸ªå†…ç½®çš„è°ƒè¯•å¼€å…³ï¼Œå°±åƒç»™ä½ çš„è„šæœ¬è£…ä¸Š"é€è§†çœ¼"ï¼š

| é€‰é¡¹ | ä½œç”¨ | é€šä¿—è§£é‡Š |
|------|------|----------|
| `-x` | æ‰§è¡Œè·Ÿè¸ª | æ˜¾ç¤ºæ¯æ¡å‘½ä»¤çš„æ‰§è¡Œè¿‡ç¨‹ |
| `-v` | è¯¦ç»†æ¨¡å¼ | æ˜¾ç¤ºè„šæœ¬çš„åŸå§‹å†…å®¹ |
| `-n` | è¯­æ³•æ£€æŸ¥ | åªæ£€æŸ¥è¯­æ³•ï¼Œä¸æ‰§è¡Œ |
| `-u` | æœªå®šä¹‰å˜é‡æ£€æŸ¥ | ä½¿ç”¨æœªå®šä¹‰å˜é‡æ—¶æŠ¥é”™ |
| `-e` | é”™è¯¯é€€å‡º | é‡åˆ°é”™è¯¯ç«‹å³åœæ­¢ |

### 2.2 -xé€‰é¡¹ï¼šæ‰§è¡Œè·Ÿè¸ªæ¨¡å¼


**ä»€ä¹ˆæ˜¯æ‰§è¡Œè·Ÿè¸ª**ï¼š
`-x`é€‰é¡¹ä¼šåœ¨æ¯æ¡å‘½ä»¤æ‰§è¡Œå‰æ˜¾ç¤ºå‡ºæ¥ï¼Œå‰é¢åŠ ä¸Š`+`å·ï¼Œè®©ä½ çœ‹åˆ°è„šæœ¬çš„"å†…å¿ƒç‹¬ç™½"ã€‚

```bash
#!/bin/bash
# debug_example.sh

name="Alice"
age=25

echo "ç”¨æˆ·ä¿¡æ¯ï¼š"
echo "å§“åï¼š$name"
echo "å¹´é¾„ï¼š$age"

if [ $age -ge 18 ]; then
    echo "æˆå¹´ç”¨æˆ·"
fi
```

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
# æ–¹æ³•1ï¼šå‘½ä»¤è¡ŒæŒ‡å®š
bash -x debug_example.sh

# æ–¹æ³•2ï¼šè„šæœ¬å†…å¼€å¯
#!/bin/bash
set -x
# ä½ çš„è„šæœ¬å†…å®¹

# æ–¹æ³•3ï¼šéƒ¨åˆ†å¼€å¯
set -x  # å¼€å¯è°ƒè¯•
# éœ€è¦è°ƒè¯•çš„ä»£ç 
set +x  # å…³é—­è°ƒè¯•
```

**è¾“å‡ºæ•ˆæœ**ï¼š
```
+ name=Alice
+ age=25
+ echo 'ç”¨æˆ·ä¿¡æ¯ï¼š'
ç”¨æˆ·ä¿¡æ¯ï¼š
+ echo 'å§“åï¼šAlice'
å§“åï¼šAlice
+ echo 'å¹´é¾„ï¼š25'
å¹´é¾„ï¼š25
+ '[' 25 -ge 18 ']'
+ echo æˆå¹´ç”¨æˆ·
æˆå¹´ç”¨æˆ·
```

### 2.3 -vé€‰é¡¹ï¼šè¯¦ç»†æ¨¡å¼


**ä½œç”¨è¯´æ˜**ï¼š
`-v`é€‰é¡¹æ˜¾ç¤ºè„šæœ¬çš„æ¯ä¸€è¡Œå†…å®¹ï¼ŒåŒ…æ‹¬æ³¨é‡Šï¼Œå°±åƒæœ—è¯»è„šæœ¬ç»™ä½ å¬ã€‚

```bash
bash -v debug_example.sh
```

**è¾“å‡ºæ•ˆæœ**ï¼š
```
#!/bin/bash
# debug_example.sh

name="Alice"
age=25

echo "ç”¨æˆ·ä¿¡æ¯ï¼š"
ç”¨æˆ·ä¿¡æ¯ï¼š
echo "å§“åï¼š$name"  
å§“åï¼šAlice
echo "å¹´é¾„ï¼š$age"
å¹´é¾„ï¼š25
```

### 2.4 -né€‰é¡¹ï¼šè¯­æ³•æ£€æŸ¥æ¨¡å¼


**ä»€ä¹ˆæ˜¯è¯­æ³•æ£€æŸ¥**ï¼š
`-n`é€‰é¡¹åªæ£€æŸ¥è„šæœ¬è¯­æ³•æ˜¯å¦æ­£ç¡®ï¼Œä¸å®é™…æ‰§è¡Œï¼Œå°±åƒè¯­æ–‡è€å¸ˆæ£€æŸ¥ä½œæ–‡è¯­æ³•ä¸€æ ·ã€‚

```bash
# åˆ›å»ºæœ‰è¯­æ³•é”™è¯¯çš„è„šæœ¬
cat > syntax_error.sh << 'EOF'
#!/bin/bash
if [ $name == "test"  # ç¼ºå°‘å³æ‹¬å·
    echo "æµ‹è¯•ç”¨æˆ·"
fi
EOF

# è¯­æ³•æ£€æŸ¥
bash -n syntax_error.sh
```

**è¾“å‡ºç»“æœ**ï¼š
```
syntax_error.sh: line 4: syntax error: unexpected end of file
syntax_error.sh: line 4: `fi'
```

### 2.5 -ué€‰é¡¹ï¼šæœªå®šä¹‰å˜é‡æ£€æŸ¥


**ä½œç”¨è¯´æ˜**ï¼š
ä½¿ç”¨æœªå®šä¹‰çš„å˜é‡æ—¶ç«‹å³æŠ¥é”™ï¼Œé˜²æ­¢å› ä¸ºå˜é‡åæ‹¼å†™é”™è¯¯å¯¼è‡´çš„é—®é¢˜ã€‚

```bash
#!/bin/bash
set -u

username="Alice"  # å®šä¹‰å˜é‡
echo "Hello $usernme"  # å˜é‡åæ‹¼å†™é”™è¯¯
```

**è¿è¡Œç»“æœ**ï¼š
```
line 4: usernme: unbound variable
```

### 2.6 -eé€‰é¡¹ï¼šé‡é”™å³åœ


**ä½œç”¨è¯´æ˜**ï¼š
ä»»ä½•å‘½ä»¤è¿”å›éé›¶çŠ¶æ€æ—¶ç«‹å³é€€å‡ºè„šæœ¬ï¼Œé¿å…é”™è¯¯ç»§ç»­ä¼ æ’­ã€‚

```bash
#!/bin/bash
set -e

ls /nonexistent_directory  # è¿™ä¸ªå‘½ä»¤ä¼šå¤±è´¥
echo "è¿™è¡Œä¸ä¼šæ‰§è¡Œ"      # ç”±äºä¸Šé¢å‘½ä»¤å¤±è´¥ï¼Œè¿™é‡Œä¸ä¼šæ‰§è¡Œ
```

### 2.7 ç»„åˆä½¿ç”¨è°ƒè¯•é€‰é¡¹


**æ¨èçš„è°ƒè¯•ç»„åˆ**ï¼š
```bash
#!/bin/bash
set -euxo pipefail

# -e: é‡é”™å³åœ
# -u: æœªå®šä¹‰å˜é‡æŠ¥é”™  
# -x: æ˜¾ç¤ºæ‰§è¡Œè¿‡ç¨‹
# -o pipefail: ç®¡é“ä¸­ä»»ä½•å‘½ä»¤å¤±è´¥éƒ½ç®—å¤±è´¥
```

---

## 3. ğŸ“ è°ƒè¯•ä¿¡æ¯è¾“å‡ºä¸æ§åˆ¶


### 3.1 è°ƒè¯•ä¿¡æ¯è¾“å‡ºçš„åŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯è°ƒè¯•ä¿¡æ¯**ï¼š
è°ƒè¯•ä¿¡æ¯å°±æ˜¯è„šæœ¬è¿è¡Œæ—¶äº§ç”Ÿçš„é¢å¤–è¯´æ˜ï¼Œå‘Šè¯‰ä½ è„šæœ¬åœ¨åšä»€ä¹ˆã€é‡åˆ°äº†ä»€ä¹ˆé—®é¢˜ã€‚å°±åƒå¯¼èˆªè½¯ä»¶å‘Šè¯‰ä½ "ç°åœ¨å‘å·¦è½¬ï¼Œå‰æ–¹æœ‰æ–½å·¥"ã€‚

### 3.2 è‡ªå®šä¹‰è°ƒè¯•ä¿¡æ¯è¾“å‡º


**åŸºæœ¬çš„è°ƒè¯•è¾“å‡º**ï¼š
```bash
#!/bin/bash

# å®šä¹‰è°ƒè¯•å‡½æ•°
debug() {
    echo "[DEBUG $(date '+%H:%M:%S')] $*" >&2
}

info() {
    echo "[INFO  $(date '+%H:%M:%S')] $*"
}

error() {
    echo "[ERROR $(date '+%H:%M:%S')] $*" >&2
}

# ä½¿ç”¨ç¤ºä¾‹
debug "è„šæœ¬å¼€å§‹æ‰§è¡Œ"
info "å¤„ç†ç”¨æˆ·æ•°æ®"

username="Alice"
debug "è®¾ç½®ç”¨æˆ·åä¸º: $username"

if [ -z "$username" ]; then
    error "ç”¨æˆ·åä¸èƒ½ä¸ºç©º"
    exit 1
fi

info "è„šæœ¬æ‰§è¡Œå®Œæˆ"
```

**è¾“å‡ºæ•ˆæœ**ï¼š
```
[DEBUG 14:30:15] è„šæœ¬å¼€å§‹æ‰§è¡Œ
[INFO  14:30:15] å¤„ç†ç”¨æˆ·æ•°æ®  
[DEBUG 14:30:15] è®¾ç½®ç”¨æˆ·åä¸º: Alice
[INFO  14:30:15] è„šæœ¬æ‰§è¡Œå®Œæˆ
```

### 3.3 æ§åˆ¶è°ƒè¯•ä¿¡æ¯çš„å¼€å…³


**ç¯å¢ƒå˜é‡æ§åˆ¶è°ƒè¯•çº§åˆ«**ï¼š
```bash
#!/bin/bash

# è°ƒè¯•çº§åˆ«ï¼š0=å…³é—­, 1=é”™è¯¯, 2=è­¦å‘Š, 3=ä¿¡æ¯, 4=è°ƒè¯•
DEBUG_LEVEL=${DEBUG_LEVEL:-2}

debug() {
    [ $DEBUG_LEVEL -ge 4 ] && echo "[DEBUG] $*" >&2
}

info() {
    [ $DEBUG_LEVEL -ge 3 ] && echo "[INFO] $*"
}

warn() {
    [ $DEBUG_LEVEL -ge 2 ] && echo "[WARN] $*" >&2
}

error() {
    [ $DEBUG_LEVEL -ge 1 ] && echo "[ERROR] $*" >&2
}

# ä½¿ç”¨ç¤ºä¾‹
debug "è¿™æ˜¯è°ƒè¯•ä¿¡æ¯"
info "è¿™æ˜¯ä¸€èˆ¬ä¿¡æ¯"  
warn "è¿™æ˜¯è­¦å‘Šä¿¡æ¯"
error "è¿™æ˜¯é”™è¯¯ä¿¡æ¯"
```

**ä¸åŒçº§åˆ«çš„è¿è¡Œæ•ˆæœ**ï¼š
```bash
# åªæ˜¾ç¤ºé”™è¯¯
DEBUG_LEVEL=1 ./script.sh
# è¾“å‡ºï¼š[ERROR] è¿™æ˜¯é”™è¯¯ä¿¡æ¯

# æ˜¾ç¤ºè­¦å‘Šå’Œé”™è¯¯
DEBUG_LEVEL=2 ./script.sh  
# è¾“å‡ºï¼š[WARN] è¿™æ˜¯è­¦å‘Šä¿¡æ¯
#      [ERROR] è¿™æ˜¯é”™è¯¯ä¿¡æ¯

# æ˜¾ç¤ºæ‰€æœ‰ä¿¡æ¯
DEBUG_LEVEL=4 ./script.sh
# è¾“å‡ºï¼š[DEBUG] è¿™æ˜¯è°ƒè¯•ä¿¡æ¯
#      [INFO] è¿™æ˜¯ä¸€èˆ¬ä¿¡æ¯
#      [WARN] è¿™æ˜¯è­¦å‘Šä¿¡æ¯  
#      [ERROR] è¿™æ˜¯é”™è¯¯ä¿¡æ¯
```

### 3.4 è°ƒè¯•ä¿¡æ¯é‡å®šå‘


**å°†è°ƒè¯•ä¿¡æ¯å†™å…¥æ–‡ä»¶**ï¼š
```bash
#!/bin/bash

# è®¾ç½®è°ƒè¯•æ—¥å¿—æ–‡ä»¶
DEBUG_LOG="/tmp/script_debug.log"

debug() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] DEBUG: $*" >> "$DEBUG_LOG"
}

# åŒæ—¶è¾“å‡ºåˆ°å±å¹•å’Œæ–‡ä»¶
debug_both() {
    local msg="[$(date '+%H:%M:%S')] DEBUG: $*"
    echo "$msg" >&2          # è¾“å‡ºåˆ°å±å¹•
    echo "$msg" >> "$DEBUG_LOG"  # å†™å…¥æ–‡ä»¶
}

# ä½¿ç”¨ç¤ºä¾‹
debug "è¿™æ¡ä¿¡æ¯åªå†™å…¥æ–‡ä»¶"
debug_both "è¿™æ¡ä¿¡æ¯æ—¢æ˜¾ç¤ºåˆè®°å½•"
```

---

## 4. â¯ï¸ æ–­ç‚¹è®¾ç½®ä¸å•æ­¥æ‰§è¡Œ


### 4.1 ä»€ä¹ˆæ˜¯æ–­ç‚¹å’Œå•æ­¥æ‰§è¡Œ


**æ–­ç‚¹**ï¼šå°±æ˜¯åœ¨è„šæœ¬çš„ç‰¹å®šä½ç½®"æš‚åœ"ï¼Œè®©ä½ æœ‰æœºä¼šæ£€æŸ¥å½“å‰çš„çŠ¶æ€ã€‚å°±åƒçœ‹ç”µå½±æ—¶æŒ‰æš‚åœé”®ä¸€æ ·ã€‚

**å•æ­¥æ‰§è¡Œ**ï¼šä¸€è¡Œä¸€è¡Œåœ°æ‰§è¡Œè„šæœ¬ï¼Œæ¯æ‰§è¡Œä¸€è¡Œéƒ½åœä¸‹æ¥ï¼Œè®©ä½ è§‚å¯Ÿç»“æœã€‚

### 4.2 ç®€å•çš„æ–­ç‚¹å®ç°


**æ‰‹åŠ¨æ–­ç‚¹**ï¼š
```bash
#!/bin/bash

# å®šä¹‰æ–­ç‚¹å‡½æ•°
breakpoint() {
    echo "=== æ–­ç‚¹: $1 ==="
    echo "å½“å‰å˜é‡çŠ¶æ€ï¼š"
    echo "  ç”¨æˆ·å: ${username:-æœªè®¾ç½®}"
    echo "  å¹´é¾„: ${age:-æœªè®¾ç½®}"
    echo "æŒ‰å›è½¦ç»§ç»­..."
    read -r
}

# è„šæœ¬ä¸»ä½“
echo "å¼€å§‹å¤„ç†ç”¨æˆ·æ•°æ®"

username="Alice"
breakpoint "è®¾ç½®ç”¨æˆ·åå"

age=25  
breakpoint "è®¾ç½®å¹´é¾„å"

echo "ç”¨æˆ· $usernameï¼Œå¹´é¾„ $age å²"
breakpoint "å¤„ç†å®Œæˆ"
```

**è¿è¡Œæ•ˆæœ**ï¼š
```
å¼€å§‹å¤„ç†ç”¨æˆ·æ•°æ®
=== æ–­ç‚¹: è®¾ç½®ç”¨æˆ·åå ===
å½“å‰å˜é‡çŠ¶æ€ï¼š
  ç”¨æˆ·å: Alice
  å¹´é¾„: æœªè®¾ç½®
æŒ‰å›è½¦ç»§ç»­...
[ç”¨æˆ·æŒ‰å›è½¦]
=== æ–­ç‚¹: è®¾ç½®å¹´é¾„å ===
å½“å‰å˜é‡çŠ¶æ€ï¼š
  ç”¨æˆ·å: Alice  
  å¹´é¾„: 25
æŒ‰å›è½¦ç»§ç»­...
```

### 4.3 æ¡ä»¶æ–­ç‚¹


**åªåœ¨ç‰¹å®šæ¡ä»¶ä¸‹æš‚åœ**ï¼š
```bash
#!/bin/bash

# æ¡ä»¶æ–­ç‚¹å‡½æ•°
conditional_break() {
    local condition="$1"
    local message="$2"
    
    if eval "$condition"; then
        echo "=== æ¡ä»¶æ–­ç‚¹è§¦å‘: $message ==="
        echo "è§¦å‘æ¡ä»¶: $condition"
        echo "å½“å‰çŠ¶æ€ï¼š"
        set | grep "^[a-zA-Z_][a-zA-Z0-9_]*=" | head -10
        echo "æŒ‰å›è½¦ç»§ç»­..."
        read -r
    fi
}

# ä½¿ç”¨ç¤ºä¾‹
for i in {1..10}; do
    count=$i
    echo "å¤„ç†ç¬¬ $i é¡¹"
    
    # å½“ count ç­‰äº 5 æ—¶æš‚åœ
    conditional_break '[ $count -eq 5 ]' "è®¡æ•°å™¨è¾¾åˆ°5"
    
    # å½“ count å¤§äº 8 æ—¶æš‚åœ  
    conditional_break '[ $count -gt 8 ]' "è®¡æ•°å™¨è¶…è¿‡8"
done
```

### 4.4 ä½¿ç”¨å¤–éƒ¨è°ƒè¯•å™¨


**bashdbè°ƒè¯•å™¨**ï¼š
```bash
# å®‰è£…bashdbï¼ˆå¦‚æœç³»ç»Ÿæ²¡æœ‰ï¼‰
# sudo apt-get install bashdb  # Ubuntu/Debian
# sudo yum install bashdb      # CentOS/RHEL

# ä½¿ç”¨bashdbè°ƒè¯•è„šæœ¬
bashdb your_script.sh

# å¸¸ç”¨bashdbå‘½ä»¤ï¼š
# n    - ä¸‹ä¸€è¡Œï¼ˆnextï¼‰
# s    - è¿›å…¥å‡½æ•°ï¼ˆstepï¼‰  
# c    - ç»§ç»­æ‰§è¡Œï¼ˆcontinueï¼‰
# l    - æ˜¾ç¤ºå½“å‰ä»£ç ï¼ˆlistï¼‰
# p var - æ‰“å°å˜é‡å€¼ï¼ˆprintï¼‰
# b 10 - åœ¨ç¬¬10è¡Œè®¾ç½®æ–­ç‚¹ï¼ˆbreakï¼‰
# q    - é€€å‡ºè°ƒè¯•å™¨ï¼ˆquitï¼‰
```

**ç®€å•çš„äº¤äº’å¼è°ƒè¯•**ï¼š
```bash
#!/bin/bash

# äº¤äº’å¼è°ƒè¯•å‡½æ•°
interactive_debug() {
    while true; do
        echo "=== è°ƒè¯•æ¨¡å¼ ==="
        echo "1. æŸ¥çœ‹å˜é‡"
        echo "2. æ‰§è¡Œå‘½ä»¤" 
        echo "3. ç»§ç»­æ‰§è¡Œ"
        echo "4. é€€å‡ºè„šæœ¬"
        read -p "é€‰æ‹©æ“ä½œ [1-4]: " choice
        
        case $choice in
            1)
                echo "å½“å‰å˜é‡ï¼š"
                set | grep "^[a-zA-Z_]" | head -20
                ;;
            2)  
                read -p "è¾“å…¥è¦æ‰§è¡Œçš„å‘½ä»¤: " cmd
                eval "$cmd"
                ;;
            3)
                break
                ;;
            4)
                exit 0
                ;;
            *)
                echo "æ— æ•ˆé€‰æ‹©"
                ;;
        esac
    done
}

# åœ¨è„šæœ¬ä¸­è°ƒç”¨
username="Alice"
age=25
interactive_debug
echo "ç»§ç»­æ‰§è¡Œè„šæœ¬..."
```

---

## 5. ğŸ‘ï¸ å˜é‡çŠ¶æ€ç›‘æ§ä¸è·Ÿè¸ª


### 5.1 å˜é‡ç›‘æ§çš„é‡è¦æ€§


**ä¸ºä»€ä¹ˆè¦ç›‘æ§å˜é‡**ï¼š
å˜é‡å°±åƒè„šæœ¬çš„"è®°å¿†"ï¼Œå®ƒä»¬çš„å€¼ä¼šå½±å“è„šæœ¬çš„è¡Œä¸ºã€‚ç›‘æ§å˜é‡å¯ä»¥å¸®ä½ ï¼š
- **å‘ç°é€»è¾‘é”™è¯¯**ï¼šå˜é‡å€¼ä¸ç¬¦åˆé¢„æœŸ
- **è¿½è¸ªæ•°æ®æµ**ï¼šçœ‹æ•°æ®å¦‚ä½•åœ¨è„šæœ¬ä¸­ä¼ é€’
- **å®šä½é—®é¢˜æºå¤´**ï¼šæ‰¾åˆ°å˜é‡å€¼å¼‚å¸¸çš„ä½ç½®

### 5.2 åŸºæœ¬çš„å˜é‡è·Ÿè¸ª


**æ˜¾ç¤ºå˜é‡çš„å˜åŒ–è¿‡ç¨‹**ï¼š
```bash
#!/bin/bash

# å˜é‡è·Ÿè¸ªå‡½æ•°
track_var() {
    local var_name="$1"
    local var_value="${!1}"  # é—´æ¥å¼•ç”¨è·å–å˜é‡å€¼
    echo "[TRACK] $var_name = '$var_value'"
}

# ä½¿ç”¨ç¤ºä¾‹
username="Alice"
track_var "username"

username="Bob"  
track_var "username"

age=25
track_var "age"

# æ‰¹é‡è·Ÿè¸ªå¤šä¸ªå˜é‡
track_vars() {
    local vars=("$@")
    echo "=== å˜é‡çŠ¶æ€å¿«ç…§ ==="
    for var in "${vars[@]}"; do
        track_var "$var"
    done
    echo "=================="
}

track_vars "username" "age"
```

### 5.3 è‡ªåŠ¨å˜é‡ç›‘æ§


**ç›‘æ§å˜é‡çš„æ¯æ¬¡èµ‹å€¼**ï¼š
```bash
#!/bin/bash

# åˆ›å»ºå˜é‡ç›‘æ§åŒ…è£…å‡½æ•°
monitored_assign() {
    local var_name="$1"
    local new_value="$2"
    local old_value="${!1}"
    
    # è®°å½•å˜åŒ–
    echo "[$(date '+%H:%M:%S')] $var_name: '$old_value' â†’ '$new_value'"
    
    # æ‰§è¡Œèµ‹å€¼
    eval "$var_name='$new_value'"
}

# ä½¿ç”¨ç¤ºä¾‹
username="Alice"
echo "åˆå§‹å€¼: username='$username'"

monitored_assign "username" "Bob"
monitored_assign "username" "Charlie" 
monitored_assign "username" ""

echo "æœ€ç»ˆå€¼: username='$username'"
```

**è¾“å‡ºæ•ˆæœ**ï¼š
```
åˆå§‹å€¼: username='Alice'
[14:30:15] username: 'Alice' â†’ 'Bob'
[14:30:15] username: 'Bob' â†’ 'Charlie'
[14:30:15] username: 'Charlie' â†’ ''
æœ€ç»ˆå€¼: username=''
```

### 5.4 å…³é”®å˜é‡çŠ¶æ€æ£€æŸ¥


**æ£€æŸ¥å˜é‡çš„æœ‰æ•ˆæ€§**ï¼š
```bash
#!/bin/bash

# å˜é‡éªŒè¯å‡½æ•°
validate_var() {
    local var_name="$1"
    local var_value="${!1}"
    local var_type="$2"  # string, number, file, directory
    
    echo "æ£€æŸ¥å˜é‡ $var_name (ç±»å‹: $var_type)"
    
    # æ£€æŸ¥æ˜¯å¦ä¸ºç©º
    if [ -z "$var_value" ]; then
        echo "  âŒ å˜é‡ä¸ºç©º"
        return 1
    fi
    
    # æ ¹æ®ç±»å‹æ£€æŸ¥
    case "$var_type" in
        "number")
            if ! [[ "$var_value" =~ ^[0-9]+$ ]]; then
                echo "  âŒ ä¸æ˜¯æœ‰æ•ˆçš„æ•°å­—"
                return 1
            fi
            ;;
        "file")
            if [ ! -f "$var_value" ]; then
                echo "  âŒ æ–‡ä»¶ä¸å­˜åœ¨: $var_value"
                return 1
            fi
            ;;
        "directory")
            if [ ! -d "$var_value" ]; then
                echo "  âŒ ç›®å½•ä¸å­˜åœ¨: $var_value" 
                return 1
            fi
            ;;
    esac
    
    echo "  âœ… å˜é‡æœ‰æ•ˆ: '$var_value'"
    return 0
}

# ä½¿ç”¨ç¤ºä¾‹
username="Alice"
age="25"
config_file="/etc/passwd"
home_dir="/home/alice"

validate_var "username" "string"
validate_var "age" "number"
validate_var "config_file" "file"
validate_var "home_dir" "directory"
```

### 5.5 ç¯å¢ƒå˜é‡ç›‘æ§


**ç›‘æ§ç¯å¢ƒå˜é‡çš„å˜åŒ–**ï¼š
```bash
#!/bin/bash

# ä¿å­˜åˆå§‹ç¯å¢ƒå˜é‡çŠ¶æ€
save_env_snapshot() {
    env | sort > "/tmp/env_before_$$"
}

# æ¯”è¾ƒç¯å¢ƒå˜é‡å˜åŒ–  
compare_env_changes() {
    env | sort > "/tmp/env_after_$$"
    
    echo "=== ç¯å¢ƒå˜é‡å˜åŒ– ==="
    
    # æ˜¾ç¤ºæ–°å¢çš„å˜é‡
    echo "æ–°å¢å˜é‡ï¼š"
    comm -13 "/tmp/env_before_$$" "/tmp/env_after_$$" | head -5
    
    # æ˜¾ç¤ºåˆ é™¤çš„å˜é‡
    echo "åˆ é™¤å˜é‡ï¼š"  
    comm -23 "/tmp/env_before_$$" "/tmp/env_after_$$" | head -5
    
    # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
    rm -f "/tmp/env_before_$$" "/tmp/env_after_$$"
}

# ä½¿ç”¨ç¤ºä¾‹
save_env_snapshot

# ä¿®æ”¹ä¸€äº›ç¯å¢ƒå˜é‡
export NEW_VAR="test_value"
export MODIFIED_VAR="new_value"

compare_env_changes
```

---

## 6. â±ï¸ æ€§èƒ½åˆ†æä¸æ—¶é—´æµ‹é‡


### 6.1 ä¸ºä»€ä¹ˆéœ€è¦æ€§èƒ½åˆ†æ


**æ€§èƒ½é—®é¢˜çš„å½±å“**ï¼š
- **ç”¨æˆ·ä½“éªŒå·®**ï¼šè„šæœ¬è¿è¡Œå¤ªæ…¢
- **èµ„æºæµªè´¹**ï¼šå ç”¨è¿‡å¤šCPUå’Œå†…å­˜
- **ç³»ç»Ÿè´Ÿæ‹…**ï¼šå½±å“å…¶ä»–ç¨‹åºè¿è¡Œ

å°±åƒä¼˜åŒ–äº¤é€šè·¯çº¿ä¸€æ ·ï¼Œæˆ‘ä»¬è¦æ‰¾å‡ºè„šæœ¬ä¸­çš„"å µç‚¹"å¹¶ä¼˜åŒ–å®ƒä»¬ã€‚

### 6.2 åŸºæœ¬çš„æ—¶é—´æµ‹é‡


**æµ‹é‡è„šæœ¬æ€»ä½“è¿è¡Œæ—¶é—´**ï¼š
```bash
#!/bin/bash

# æ–¹æ³•1ï¼šä½¿ç”¨å†…ç½®çš„timeå‘½ä»¤
time ./your_script.sh

# æ–¹æ³•2ï¼šåœ¨è„šæœ¬å†…éƒ¨æµ‹é‡
start_time=$(date +%s.%N)

# ä½ çš„è„šæœ¬å†…å®¹
sleep 2
echo "å¤„ç†ä¸€äº›ä»»åŠ¡"

end_time=$(date +%s.%N)
duration=$(echo "$end_time - $start_time" | bc)
echo "è„šæœ¬è¿è¡Œæ—¶é—´: ${duration} ç§’"
```

**æµ‹é‡ç‰¹å®šä»£ç æ®µçš„æ‰§è¡Œæ—¶é—´**ï¼š
```bash
#!/bin/bash

# æ—¶é—´æµ‹é‡å‡½æ•°
measure_time() {
    local start_time=$(date +%s.%N)
    
    # æ‰§è¡Œä¼ å…¥çš„å‘½ä»¤
    "$@"
    local exit_code=$?
    
    local end_time=$(date +%s.%N)
    local duration=$(echo "$end_time - $start_time" | bc -l)
    
    printf "å‘½ä»¤ '%s' æ‰§è¡Œæ—¶é—´: %.3f ç§’\n" "$*" "$duration"
    return $exit_code
}

# ä½¿ç”¨ç¤ºä¾‹
measure_time sleep 1
measure_time find /etc -name "*.conf" | wc -l
measure_time sort /etc/passwd
```

### 6.3 å‡½æ•°æ€§èƒ½åˆ†æ


**æµ‹é‡å‡½æ•°çš„æ‰§è¡Œæ—¶é—´**ï¼š
```bash
#!/bin/bash

# æ€§èƒ½åˆ†æåŒ…è£…å™¨
profile_function() {
    local func_name="$1"
    shift
    
    echo "å¼€å§‹æ‰§è¡Œå‡½æ•°: $func_name"
    local start_time=$(date +%s.%N)
    
    # è°ƒç”¨åŸå§‹å‡½æ•°
    "$func_name" "$@"
    local result=$?
    
    local end_time=$(date +%s.%N)
    local duration=$(echo "$end_time - $start_time" | bc -l)
    
    printf "å‡½æ•° %s æ‰§è¡Œå®Œæˆï¼Œè€—æ—¶: %.3f ç§’\n" "$func_name" "$duration"
    return $result
}

# ç¤ºä¾‹å‡½æ•°
slow_function() {
    echo "æ‰§è¡Œå¤æ‚è®¡ç®—..."
    sleep 2
    local sum=0
    for i in {1..1000000}; do
        sum=$((sum + i))
    done
    echo "è®¡ç®—ç»“æœ: $sum"
}

fast_function() {
    echo "æ‰§è¡Œç®€å•ä»»åŠ¡"
    date
}

# æ€§èƒ½æµ‹è¯•
profile_function slow_function
profile_function fast_function
```

### 6.4 å¾ªç¯æ€§èƒ½ä¼˜åŒ–


**æ¯”è¾ƒä¸åŒå®ç°çš„æ€§èƒ½**ï¼š
```bash
#!/bin/bash

# æ€§èƒ½æµ‹è¯•æ¡†æ¶
benchmark() {
    local test_name="$1"
    local iterations="$2"
    shift 2
    
    echo "æ€§èƒ½æµ‹è¯•: $test_name (æ‰§è¡Œ $iterations æ¬¡)"
    local start_time=$(date +%s.%N)
    
    for ((i=1; i<=iterations; i++)); do
        "$@" > /dev/null
    done
    
    local end_time=$(date +%s.%N)
    local total_time=$(echo "$end_time - $start_time" | bc -l)
    local avg_time=$(echo "$total_time / $iterations" | bc -l)
    
    printf "æ€»æ—¶é—´: %.3f ç§’, å¹³å‡æ—¶é—´: %.6f ç§’/æ¬¡\n" "$total_time" "$avg_time"
}

# æµ‹è¯•ä¸åŒçš„å­—ç¬¦ä¸²å¤„ç†æ–¹æ³•
test_method1() {
    local str="Hello World"
    echo "${str//o/O}"  # ä½¿ç”¨å‚æ•°æ‰©å±•
}

test_method2() {
    local str="Hello World"  
    echo "$str" | sed 's/o/O/g'  # ä½¿ç”¨sedå‘½ä»¤
}

# æ€§èƒ½æ¯”è¾ƒ
benchmark "å‚æ•°æ‰©å±•æ–¹æ³•" 1000 test_method1
benchmark "sedå‘½ä»¤æ–¹æ³•" 1000 test_method2
```

### 6.5 å†…å­˜ä½¿ç”¨ç›‘æ§


**ç›‘æ§è„šæœ¬çš„å†…å­˜ä½¿ç”¨**ï¼š
```bash
#!/bin/bash

# å†…å­˜ä½¿ç”¨ç›‘æ§å‡½æ•°
monitor_memory() {
    local pid=$$  # å½“å‰è„šæœ¬çš„è¿›ç¨‹ID
    local log_file="/tmp/memory_usage_$$.log"
    
    echo "å¼€å§‹ç›‘æ§å†…å­˜ä½¿ç”¨ (PID: $pid)"
    
    # åå°ç›‘æ§è¿›ç¨‹
    (
        while kill -0 $pid 2>/dev/null; do
            ps -o pid,vsz,rss,comm -p $pid >> "$log_file"
            sleep 1
        done
    ) &
    
    local monitor_pid=$!
    
    # æ‰§è¡Œä¸»è¦ä»»åŠ¡
    "$@"
    
    # åœæ­¢ç›‘æ§
    kill $monitor_pid 2>/dev/null
    
    # æ˜¾ç¤ºå†…å­˜ä½¿ç”¨ç»Ÿè®¡
    if [ -f "$log_file" ]; then
        echo "å†…å­˜ä½¿ç”¨ç»Ÿè®¡ï¼š"
        echo "æœ€å¤§è™šæ‹Ÿå†…å­˜: $(awk 'NR>1 {print $2}' "$log_file" | sort -n | tail -1) KB"
        echo "æœ€å¤§ç‰©ç†å†…å­˜: $(awk 'NR>1 {print $3}' "$log_file" | sort -n | tail -1) KB"
        rm -f "$log_file"
    fi
}

# å†…å­˜æ¶ˆè€—æµ‹è¯•å‡½æ•°
memory_test() {
    echo "åˆ†é…å¤§é‡å†…å­˜..."
    declare -a big_array
    for i in {1..100000}; do
        big_array[i]="This is a test string $i"
    done
    sleep 3
    echo "å†…å­˜æµ‹è¯•å®Œæˆ"
}

# è¿è¡Œå†…å­˜ç›‘æ§
monitor_memory memory_test
```

---

## 7. ğŸ§ª å•å…ƒæµ‹è¯•æ¡†æ¶ä½¿ç”¨


### 7.1 ä»€ä¹ˆæ˜¯å•å…ƒæµ‹è¯•


**å•å…ƒæµ‹è¯•**å°±æ˜¯ä¸ºè„šæœ¬ä¸­çš„æ¯ä¸ªå°åŠŸèƒ½ï¼ˆå‡½æ•°ï¼‰å†™æµ‹è¯•ç”¨ä¾‹ï¼Œç¡®ä¿å®ƒä»¬æŒ‰é¢„æœŸå·¥ä½œã€‚å°±åƒæ£€æŸ¥æ±½è½¦çš„æ¯ä¸ªé›¶ä»¶æ˜¯å¦æ­£å¸¸ä¸€æ ·ã€‚

**å•å…ƒæµ‹è¯•çš„å¥½å¤„**ï¼š
- **åŠæ—©å‘ç°é—®é¢˜**ï¼šåœ¨é›†æˆå‰å°±å‘ç°é”™è¯¯
- **é‡æ„ä¿¡å¿ƒ**ï¼šä¿®æ”¹ä»£ç åèƒ½å¿«é€ŸéªŒè¯æ­£ç¡®æ€§  
- **æ–‡æ¡£ä½œç”¨**ï¼šæµ‹è¯•ç”¨ä¾‹è¯´æ˜äº†å‡½æ•°çš„é¢„æœŸè¡Œä¸º

### 7.2 ç®€å•çš„æµ‹è¯•æ¡†æ¶


**è‡ªåˆ¶çš„è½»é‡çº§æµ‹è¯•æ¡†æ¶**ï¼š
```bash
#!/bin/bash

# æµ‹è¯•è®¡æ•°å™¨
TESTS_TOTAL=0
TESTS_PASSED=0
TESTS_FAILED=0

# æ–­è¨€å‡½æ•°
assert_equals() {
    local expected="$1"
    local actual="$2"
    local test_name="$3"
    
    TESTS_TOTAL=$((TESTS_TOTAL + 1))
    
    if [ "$expected" = "$actual" ]; then
        echo "âœ… PASS: $test_name"
        TESTS_PASSED=$((TESTS_PASSED + 1))
    else
        echo "âŒ FAIL: $test_name"
        echo "   æœŸæœ›å€¼: '$expected'"
        echo "   å®é™…å€¼: '$actual'"
        TESTS_FAILED=$((TESTS_FAILED + 1))
    fi
}

assert_true() {
    local condition="$1"
    local test_name="$2"
    
    if eval "$condition"; then
        assert_equals "true" "true" "$test_name"
    else
        assert_equals "true" "false" "$test_name"
    fi
}

# æ˜¾ç¤ºæµ‹è¯•ç»“æœ
show_test_results() {
    echo "==================="
    echo "æµ‹è¯•ç»“æœç»Ÿè®¡ï¼š"
    echo "æ€»æ•°: $TESTS_TOTAL"
    echo "é€šè¿‡: $TESTS_PASSED"  
    echo "å¤±è´¥: $TESTS_FAILED"
    echo "æˆåŠŸç‡: $((TESTS_PASSED * 100 / TESTS_TOTAL))%"
    echo "==================="
}

# è¦æµ‹è¯•çš„å‡½æ•°
add_numbers() {
    local a="$1"
    local b="$2"
    echo $((a + b))
}

is_even() {
    local number="$1"
    [ $((number % 2)) -eq 0 ]
}

# æµ‹è¯•ç”¨ä¾‹
test_add_numbers() {
    echo "æµ‹è¯• add_numbers å‡½æ•°ï¼š"
    
    local result=$(add_numbers 2 3)
    assert_equals "5" "$result" "2 + 3 = 5"
    
    result=$(add_numbers 0 0)
    assert_equals "0" "$result" "0 + 0 = 0"
    
    result=$(add_numbers -1 1) 
    assert_equals "0" "$result" "-1 + 1 = 0"
}

test_is_even() {
    echo "æµ‹è¯• is_even å‡½æ•°ï¼š"
    
    assert_true "is_even 2" "2æ˜¯å¶æ•°"
    assert_true "is_even 4" "4æ˜¯å¶æ•°"
    assert_true "! is_even 3" "3ä¸æ˜¯å¶æ•°"
    assert_true "! is_even 1" "1ä¸æ˜¯å¶æ•°"
}

# è¿è¡Œæµ‹è¯•
echo "å¼€å§‹å•å…ƒæµ‹è¯•..."
test_add_numbers
echo
test_is_even
echo
show_test_results
```

### 7.3 ä½¿ç”¨batsæµ‹è¯•æ¡†æ¶


**å®‰è£…å’Œä½¿ç”¨bats**ï¼š
```bash
# å®‰è£…bats
git clone https://github.com/bats-core/bats-core.git
cd bats-core
sudo ./install.sh /usr/local

# åˆ›å»ºæµ‹è¯•æ–‡ä»¶ test_script.bats
cat > test_script.bats << 'EOF'
#!/usr/bin/env bats

# åŠ è½½è¦æµ‹è¯•çš„è„šæœ¬
load './my_functions.sh'

@test "æµ‹è¯•åŠ æ³•å‡½æ•°" {
    result=$(add_numbers 2 3)
    [ "$result" = "5" ]
}

@test "æµ‹è¯•å¶æ•°åˆ¤æ–­" {
    is_even 4
    ! is_even 3
}

@test "æµ‹è¯•æ–‡ä»¶æ˜¯å¦å­˜åœ¨" {
    [ -f "/etc/passwd" ]
}

@test "æµ‹è¯•å­—ç¬¦ä¸²å¤„ç†" {
    result=$(echo "hello" | tr 'l' 'L')
    [ "$result" = "heLLo" ]
}
EOF

# è¿è¡Œæµ‹è¯•
bats test_script.bats
```

### 7.4 æµ‹è¯•é©±åŠ¨å¼€å‘ç¤ºä¾‹


**å…ˆå†™æµ‹è¯•ï¼Œå†å†™å®ç°**ï¼š
```bash
#!/bin/bash

# ç¬¬ä¸€æ­¥ï¼šå†™æµ‹è¯•ç”¨ä¾‹
test_string_utilities() {
    echo "æµ‹è¯•å­—ç¬¦ä¸²å·¥å…·å‡½æ•°ï¼š"
    
    # æµ‹è¯•å­—ç¬¦ä¸²é•¿åº¦è®¡ç®—
    local result=$(string_length "hello")
    assert_equals "5" "$result" "helloçš„é•¿åº¦æ˜¯5"
    
    # æµ‹è¯•å­—ç¬¦ä¸²åè½¬
    result=$(reverse_string "abc")
    assert_equals "cba" "$result" "abcåè½¬æ˜¯cba"
    
    # æµ‹è¯•å¤§å†™è½¬æ¢
    result=$(to_uppercase "hello")
    assert_equals "HELLO" "$result" "helloè½¬å¤§å†™æ˜¯HELLO"
}

# ç¬¬äºŒæ­¥ï¼šå®ç°å‡½æ•°ä½¿æµ‹è¯•é€šè¿‡
string_length() {
    local str="$1"
    echo ${#str}
}

reverse_string() {
    local str="$1"
    local reversed=""
    local i
    
    for ((i=${#str}-1; i>=0; i--)); do
        reversed="${reversed}${str:$i:1}"
    done
    
    echo "$reversed"
}

to_uppercase() {
    local str="$1"
    echo "${str^^}"  # Bash 4.0+ åŠŸèƒ½
}

# è¿è¡Œæµ‹è¯•éªŒè¯å®ç°
test_string_utilities
```

---

## 8. ğŸ“Š ä»£ç è¦†ç›–ç‡ç»Ÿè®¡


### 8.1 ä»€ä¹ˆæ˜¯ä»£ç è¦†ç›–ç‡


**ä»£ç è¦†ç›–ç‡**è¡¨ç¤ºæµ‹è¯•ç”¨ä¾‹æ‰§è¡Œäº†å¤šå°‘æ¯”ä¾‹çš„ä»£ç ã€‚å°±åƒæ£€æŸ¥ä½ æ˜¯å¦èµ°éäº†æˆ¿å­çš„æ¯ä¸ªè§’è½ä¸€æ ·ã€‚

**è¦†ç›–ç‡ç±»å‹**ï¼š
- **è¡Œè¦†ç›–ç‡**ï¼šæ‰§è¡Œäº†å¤šå°‘è¡Œä»£ç 
- **åˆ†æ”¯è¦†ç›–ç‡**ï¼šæ‰§è¡Œäº†å¤šå°‘ä¸ªif/elseåˆ†æ”¯
- **å‡½æ•°è¦†ç›–ç‡**ï¼šè°ƒç”¨äº†å¤šå°‘ä¸ªå‡½æ•°

### 8.2 ç®€å•çš„è¦†ç›–ç‡ç»Ÿè®¡


**æ‰‹åŠ¨ç»Ÿè®¡ä»£ç è¦†ç›–ç‡**ï¼š
```bash
#!/bin/bash

# è¦†ç›–ç‡ç»Ÿè®¡å˜é‡
declare -A executed_lines
declare -A all_lines

# æ ‡è®°æ‰§è¡Œçš„ä»£ç è¡Œ
mark_executed() {
    local line_number="$1"
    executed_lines[$line_number]=1
}

# ç»Ÿè®¡æ‰€æœ‰ä»£ç è¡Œï¼ˆæ’é™¤æ³¨é‡Šå’Œç©ºè¡Œï¼‰
count_all_lines() {
    local script_file="$1"
    local line_num=0
    
    while IFS= read -r line; do
        line_num=$((line_num + 1))
        # è·³è¿‡ç©ºè¡Œå’Œæ³¨é‡Šè¡Œ
        if [[ ! "$line" =~ ^[[:space:]]*$ ]] && [[ ! "$line" =~ ^[[:space:]]*# ]]; then
            all_lines[$line_num]=1
        fi
    done < "$script_file"
}

# è®¡ç®—è¦†ç›–ç‡
calculate_coverage() {
    local total_lines=${#all_lines[@]}
    local executed_count=${#executed_lines[@]}
    
    if [ $total_lines -gt 0 ]; then
        local coverage=$((executed_count * 100 / total_lines))
        echo "ä»£ç è¦†ç›–ç‡: $coverage% ($executed_count/$total_lines è¡Œ)"
    else
        echo "ä»£ç è¦†ç›–ç‡: æ— æ³•è®¡ç®—"
    fi
}

# è¢«æµ‹è¯•çš„å‡½æ•°ï¼ˆå¸¦è¦†ç›–ç‡æ ‡è®°ï¼‰
calculate_area() {
    mark_executed $LINENO
    local length="$1"
    local width="$2"
    
    mark_executed $LINENO
    if [ -z "$length" ] || [ -z "$width" ]; then
        mark_executed $LINENO
        echo "é”™è¯¯ï¼šå‚æ•°ä¸èƒ½ä¸ºç©º" >&2
        mark_executed $LINENO
        return 1
    fi
    
    mark_executed $LINENO
    local area=$((length * width))
    mark_executed $LINENO
    echo $area
}

# æµ‹è¯•ç”¨ä¾‹
test_calculate_area() {
    echo "æµ‹è¯•é¢ç§¯è®¡ç®—å‡½æ•°ï¼š"
    
    # æµ‹è¯•æ­£å¸¸æƒ…å†µ
    local result=$(calculate_area 5 4)
    echo "5 Ã— 4 = $result"
    
    # æµ‹è¯•å¼‚å¸¸æƒ…å†µ  
    calculate_area "" 4 2>/dev/null
}

# åˆå§‹åŒ–è¦†ç›–ç‡ç»Ÿè®¡
count_all_lines "$0"

# è¿è¡Œæµ‹è¯•
test_calculate_area

# æ˜¾ç¤ºè¦†ç›–ç‡
calculate_coverage
```

### 8.3 ä½¿ç”¨kcovè¿›è¡Œè¦†ç›–ç‡åˆ†æ


**å®‰è£…å’Œä½¿ç”¨kcov**ï¼š
```bash
# å®‰è£…kcovï¼ˆUbuntu/Debianï¼‰
sudo apt-get install kcov

# ä¸ºè„šæœ¬ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
kcov --include-pattern=script.sh coverage_report script.sh

# æŸ¥çœ‹HTMLæŠ¥å‘Š
firefox coverage_report/index.html
```

**åˆ›å»ºæ”¯æŒkcovçš„æµ‹è¯•è„šæœ¬**ï¼š
```bash
#!/bin/bash
# test_with_coverage.sh

# è¢«æµ‹è¯•çš„è„šæœ¬å†…å®¹
source ./my_script.sh

# è¿è¡Œæµ‹è¯•ç”¨ä¾‹
echo "è¿è¡Œæµ‹è¯•ç”¨ä¾‹..."

# æµ‹è¯•ç”¨ä¾‹1ï¼šæ­£å¸¸æµç¨‹
test_normal_case() {
    process_user_data "Alice" "25"
}

# æµ‹è¯•ç”¨ä¾‹2ï¼šè¾¹ç•Œæ¡ä»¶
test_edge_cases() {
    process_user_data "" ""
    process_user_data "test" "abc"
}

# æµ‹è¯•ç”¨ä¾‹3ï¼šå¼‚å¸¸æƒ…å†µ  
test_error_cases() {
    process_user_data "user_with_very_long_name" "-1"
}

# æ‰§è¡Œæ‰€æœ‰æµ‹è¯•
test_normal_case
test_edge_cases
test_error_cases

echo "æµ‹è¯•å®Œæˆ"
```

### 8.4 åˆ†æ”¯è¦†ç›–ç‡åˆ†æ


**æ£€æŸ¥æ¡ä»¶åˆ†æ”¯çš„æ‰§è¡Œæƒ…å†µ**ï¼š
```bash
#!/bin/bash

# åˆ†æ”¯è¦†ç›–ç‡è·Ÿè¸ª
declare -A branch_taken

track_branch() {
    local branch_id="$1"
    local condition_result="$2"
    
    branch_taken["${branch_id}_${condition_result}"]=1
}

# ç¤ºä¾‹å‡½æ•°ï¼šç”¨æˆ·å¹´é¾„åˆ†ç±»
classify_age() {
    local age="$1"
    
    track_branch "age_check" "start"
    
    if [ $age -lt 13 ]; then
        track_branch "age_check" "child"
        echo "å„¿ç«¥"
    elif [ $age -lt 18 ]; then
        track_branch "age_check" "teen"  
        echo "é’å°‘å¹´"
    elif [ $age -lt 65 ]; then
        track_branch "age_check" "adult"
        echo "æˆå¹´äºº"
    else
        track_branch "age_check" "senior"
        echo "è€å¹´äºº"
    fi
}

# æµ‹è¯•ä¸åŒåˆ†æ”¯
classify_age 10   # childåˆ†æ”¯
classify_age 16   # teenåˆ†æ”¯  
classify_age 30   # adultåˆ†æ”¯
# classify_age 70   # senioråˆ†æ”¯ï¼ˆæœªæµ‹è¯•ï¼‰

# æ˜¾ç¤ºåˆ†æ”¯è¦†ç›–æƒ…å†µ
echo "åˆ†æ”¯è¦†ç›–æƒ…å†µï¼š"
for branch in "${!branch_taken[@]}"; do
    echo "  $branch: å·²æ‰§è¡Œ"
done

echo "æœªè¦†ç›–çš„åˆ†æ”¯ï¼š"
echo "  age_check_senior: æœªæ‰§è¡Œï¼ˆå»ºè®®æ·»åŠ æµ‹è¯•ç”¨ä¾‹ï¼‰"
```

---

## 9. ğŸ” é™æ€ä»£ç åˆ†æå·¥å…·


### 9.1 ä»€ä¹ˆæ˜¯é™æ€ä»£ç åˆ†æ


**é™æ€åˆ†æ**å°±æ˜¯ä¸è¿è¡Œè„šæœ¬ï¼Œåªé€šè¿‡é˜…è¯»ä»£ç å°±èƒ½å‘ç°é—®é¢˜ã€‚å°±åƒè¯­æ–‡è€å¸ˆä¸å¬ä½ æœ—è¯»ï¼Œåªçœ‹ä½œæ–‡å°±èƒ½å‘ç°è¯­æ³•é”™è¯¯ä¸€æ ·ã€‚

**é™æ€åˆ†æçš„ä¼˜åŠ¿**ï¼š
- **å‘ç°æ½œåœ¨é—®é¢˜**ï¼šè¯­æ³•é”™è¯¯ã€é€»è¾‘é—®é¢˜
- **ä»£ç è§„èŒƒæ£€æŸ¥**ï¼šé£æ ¼ä¸€è‡´æ€§
- **å®‰å…¨æ¼æ´æ£€æµ‹**ï¼šä¸å®‰å…¨çš„ç¼–ç¨‹å®è·µ

### 9.2 ä½¿ç”¨shellcheckè¿›è¡Œä»£ç æ£€æŸ¥


**å®‰è£…å’ŒåŸºæœ¬ä½¿ç”¨**ï¼š
```bash
# å®‰è£…shellcheck
sudo apt-get install shellcheck  # Ubuntu/Debian
sudo yum install shellcheck      # CentOS/RHEL

# åŸºæœ¬ç”¨æ³•
shellcheck your_script.sh

# æŒ‡å®šshellç±»å‹
shellcheck -s bash your_script.sh

# è¾“å‡ºæ ¼å¼é€‰é¡¹
shellcheck -f gcc your_script.sh    # gccæ ¼å¼
shellcheck -f json your_script.sh   # JSONæ ¼å¼
```

**å¸¸è§çš„shellcheckè­¦å‘Šå’Œä¿®å¤**ï¼š
```bash
#!/bin/bash

# é—®é¢˜1ï¼šå˜é‡æœªåŠ å¼•å·
name=$1
echo "Hello $name"  # SC2086: åº”è¯¥ç”¨å¼•å·åŒ…å›´å˜é‡

# ä¿®å¤ï¼š
name="$1"
echo "Hello $name"

# é—®é¢˜2ï¼šæœªæ£€æŸ¥å‘½ä»¤æ‰§è¡Œç»“æœ
rm important_file.txt  # SC2320: åº”è¯¥æ£€æŸ¥å‘½ä»¤æ˜¯å¦æˆåŠŸ

# ä¿®å¤ï¼š
if ! rm important_file.txt; then
    echo "åˆ é™¤æ–‡ä»¶å¤±è´¥" >&2
    exit 1
fi

# é—®é¢˜3ï¼šä½¿ç”¨è¿‡æ—¶çš„åå¼•å·
result=`date`  # SC2006: å»ºè®®ä½¿ç”¨$()æ›¿ä»£åå¼•å·

# ä¿®å¤ï¼š
result=$(date)

# é—®é¢˜4ï¼šæœªå¤„ç†ç©ºæ ¼åŒ…å«çš„æ–‡ä»¶å
for file in $(ls); do  # SC2045: ä¸è¦è§£ælsçš„è¾“å‡º
    echo $file         # SC2086: æ–‡ä»¶ååŒ…å«ç©ºæ ¼æ—¶ä¼šå‡ºé”™
done

# ä¿®å¤ï¼š
for file in *; do
    [ -f "$file" ] || continue
    echo "$file"
done
```

### 9.3 è‡ªå®šä¹‰ä»£ç æ£€æŸ¥è§„åˆ™


**åˆ›å»ºè‡ªå·±çš„ä»£ç æ£€æŸ¥è„šæœ¬**ï¼š
```bash
#!/bin/bash
# custom_lint.sh - è‡ªå®šä¹‰ä»£ç æ£€æŸ¥å·¥å…·

# æ£€æŸ¥æ–‡ä»¶
check_script() {
    local script_file="$1"
    local issues=0
    
    echo "æ£€æŸ¥æ–‡ä»¶: $script_file"
    
    # æ£€æŸ¥1ï¼šæ˜¯å¦æœ‰shebang
    if ! head -1 "$script_file" | grep -q '^#!/'; then
        echo "  âš ï¸  ç¼ºå°‘shebangè¡Œ"
        issues=$((issues + 1))
    fi
    
    # æ£€æŸ¥2ï¼šæ˜¯å¦ä½¿ç”¨äº†å±é™©å‘½ä»¤
    if grep -q 'rm -rf /' "$script_file"; then
        echo "  ğŸš¨ å±é™©ï¼šå‘ç° 'rm -rf /' å‘½ä»¤"
        issues=$((issues + 1))
    fi
    
    # æ£€æŸ¥3ï¼šæ˜¯å¦æœ‰æœªä½¿ç”¨çš„å˜é‡
    local variables=$(grep -o '\$[a-zA-Z_][a-zA-Z0-9_]*' "$script_file" | sort | uniq)
    local defined_vars=$(grep -o '^[a-zA-Z_][a-zA-Z0-9_]*=' "$script_file" | sed 's/=$//')
    
    # æ£€æŸ¥4ï¼šå‡½æ•°æ˜¯å¦æœ‰æ³¨é‡Š
    local functions=$(grep -n '^[a-zA-Z_][a-zA-Z0-9_]*()' "$script_file")
    if [ -n "$functions" ]; then
        echo "  ğŸ’¡ å‘ç°çš„å‡½æ•°ï¼š"
        echo "$functions" | while read -r func; do
            local line_num=$(echo "$func" | cut -d: -f1)
            local func_name=$(echo "$func" | cut -d: -f2 | sed 's/().*//')
            
            # æ£€æŸ¥å‡½æ•°å‰æ˜¯å¦æœ‰æ³¨é‡Š
            local prev_line=$((line_num - 1))
            if [ $prev_line -gt 0 ]; then
                local comment=$(sed -n "${prev_line}p" "$script_file")
                if [[ ! "$comment" =~ ^[[:space:]]*# ]]; then
                    echo "    âš ï¸  å‡½æ•° '$func_name' ç¼ºå°‘æ³¨é‡Š"
                    issues=$((issues + 1))
                fi
            fi
        done
    fi
    
    # æ£€æŸ¥5ï¼šä»£ç å¤æ‚åº¦ï¼ˆå‡½æ•°è¡Œæ•°ï¼‰
    awk '/^[a-zA-Z_][a-zA-Z0-9_]*\(\)/ {
        func_name = $0; func_line = NR; brace_count = 0; in_func = 1
    }
    in_func && /{/ { brace_count++ }
    in_func && /}/ { 
        brace_count--
        if (brace_count == 0) {
            lines = NR - func_line + 1
            if (lines > 50) {
                print "  âš ï¸  å‡½æ•°è¿‡é•¿: " func_name " (" lines " è¡Œ)"
            }
            in_func = 0
        }
    }' "$script_file"
    
    echo "  æ£€æŸ¥å®Œæˆï¼Œå‘ç° $issues ä¸ªé—®é¢˜"
    return $issues
}

# æ‰¹é‡æ£€æŸ¥å¤šä¸ªæ–‡ä»¶
if [ $# -eq 0 ]; then
    echo "ç”¨æ³•: $0 <è„šæœ¬æ–‡ä»¶...>"
    exit 1
fi

total_issues=0
for script in "$@"; do
    if [ -f "$script" ]; then
        check_script "$script"
        total_issues=$((total_issues + $?))
        echo
    else
        echo "æ–‡ä»¶ä¸å­˜åœ¨: $script"
    fi
done

echo "æ€»å…±å‘ç° $total_issues ä¸ªé—®é¢˜"
exit $total_issues
```

### 9.4 ä»£ç é£æ ¼æ£€æŸ¥


**ç»Ÿä¸€ä»£ç é£æ ¼çš„æ£€æŸ¥è„šæœ¬**ï¼š
```bash
#!/bin/bash
# style_check.sh - ä»£ç é£æ ¼æ£€æŸ¥

check_style() {
    local file="$1"
    local issues=0
    
    echo "æ£€æŸ¥ä»£ç é£æ ¼: $file"
    
    # æ£€æŸ¥ç¼©è¿›ï¼ˆåº”è¯¥ä½¿ç”¨4ä¸ªç©ºæ ¼ï¼‰
    local bad_indent=$(grep -n $'^\t' "$file")
    if [ -n "$bad_indent" ]; then
        echo "  âŒ å‘ç°Tabç¼©è¿›ï¼Œå»ºè®®ä½¿ç”¨4ä¸ªç©ºæ ¼ï¼š"
        echo "$bad_indent" | head -3
        issues=$((issues + 1))
    fi
    
    # æ£€æŸ¥è¡Œé•¿åº¦ï¼ˆä¸è¶…è¿‡100å­—ç¬¦ï¼‰
    local long_lines=$(awk 'length > 100 {print NR ": " $0}' "$file")
    if [ -n "$long_lines" ]; then
        echo "  âŒ å‘ç°è¿‡é•¿çš„è¡Œï¼ˆ>100å­—ç¬¦ï¼‰ï¼š"
        echo "$long_lines" | head -3
        issues=$((issues + 1))  
    fi
    
    # æ£€æŸ¥å˜é‡å‘½åï¼ˆåº”è¯¥ä½¿ç”¨å°å†™+ä¸‹åˆ’çº¿ï¼‰
    local bad_vars=$(grep -o '^[A-Z][a-zA-Z0-9_]*=' "$file")
    if [ -n "$bad_vars" ]; then
        echo "  âš ï¸  å˜é‡å‘½åå»ºè®®ä½¿ç”¨å°å†™+ä¸‹åˆ’çº¿ï¼š"
        echo "$bad_vars"
        issues=$((issues + 1))
    fi
    
    # æ£€æŸ¥æ˜¯å¦æœ‰å°¾éšç©ºæ ¼
    local trailing_spaces=$(grep -n ' $' "$file")
    if [ -n "$trailing_spaces" ]; then
        echo "  âš ï¸  å‘ç°è¡Œå°¾ç©ºæ ¼ï¼š"
        echo "$trailing_spaces" | wc -l
        issues=$((issues + 1))
    fi
    
    echo "  é£æ ¼æ£€æŸ¥å®Œæˆï¼Œå‘ç° $issues ä¸ªé—®é¢˜"
    return $issues
}

# åº”ç”¨é£æ ¼æ£€æŸ¥
for file in "$@"; do
    check_style "$file"
    echo
done
```

### 9.5 å®‰å…¨æ£€æŸ¥


**å®‰å…¨æ¼æ´æ£€æµ‹è„šæœ¬**ï¼š
```bash
#!/bin/bash
# security_check.sh - å®‰å…¨æ£€æŸ¥å·¥å…·

security_check() {
    local file="$1"
    local security_issues=0
    
    echo "å®‰å…¨æ£€æŸ¥: $file"
    
    # æ£€æŸ¥1ï¼šå±é™©çš„å‘½ä»¤ç»„åˆ
    local dangerous_patterns=(
        'rm -rf \$'
        'chmod 777'
        'eval \$'
        'exec \$'
        'system(\$'
    )
    
    for pattern in "${dangerous_patterns[@]}"; do
        if grep -q "$pattern" "$file"; then
            echo "  ğŸš¨ å‘ç°å±é™©æ¨¡å¼: $pattern"
            security_issues=$((security_issues + 1))
        fi
    done
    
    # æ£€æŸ¥2ï¼šæœªéªŒè¯çš„ç”¨æˆ·è¾“å…¥
    if grep -q 'read.*var' "$file" && ! grep -q 'validate\|check\|verify' "$file"; then
        echo "  âš ï¸  å‘ç°ç”¨æˆ·è¾“å…¥ä½†ç¼ºå°‘éªŒè¯"
        security_issues=$((security_issues + 1))
    fi
    
    # æ£€æŸ¥3ï¼šç¡¬ç¼–ç çš„å¯†ç æˆ–å¯†é’¥
    if grep -iE '(password|passwd|pwd|secret|key).*=' "$file" | grep -v '\$'; then
        echo "  ğŸš¨ å¯èƒ½å­˜åœ¨ç¡¬ç¼–ç çš„æ•æ„Ÿä¿¡æ¯"
        security_issues=$((security_issues + 1))
    fi
    
    # æ£€æŸ¥4ï¼šä¸´æ—¶æ–‡ä»¶çš„ä¸å®‰å…¨ä½¿ç”¨
    if grep -q '/tmp/[^$]' "$file"; then
        echo "  âš ï¸  ä½¿ç”¨å›ºå®šçš„ä¸´æ—¶æ–‡ä»¶åï¼Œå­˜åœ¨ç«äº‰æ¡ä»¶é£é™©"
        security_issues=$((security_issues + 1))
    fi
    
    echo "  å®‰å…¨æ£€æŸ¥å®Œæˆï¼Œå‘ç° $security_issues ä¸ªå®‰å…¨é—®é¢˜"
    return $security_issues
}

# æ‰§è¡Œå®‰å…¨æ£€æŸ¥
for file in "$@"; do
    security_check "$file"
    echo
done
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ è°ƒè¯•é€‰é¡¹ï¼š-xæ˜¾ç¤ºæ‰§è¡Œï¼Œ-væ˜¾ç¤ºå†…å®¹ï¼Œ-næ£€æŸ¥è¯­æ³•ï¼Œ-uæ£€æŸ¥å˜é‡ï¼Œ-eé‡é”™å³åœ
ğŸ”¸ è°ƒè¯•è¾“å‡ºï¼šè‡ªå®šä¹‰è°ƒè¯•ä¿¡æ¯ï¼Œåˆ†çº§åˆ«è¾“å‡ºï¼Œé‡å®šå‘åˆ°æ–‡ä»¶
ğŸ”¸ æ–­ç‚¹è°ƒè¯•ï¼šæ‰‹åŠ¨æ–­ç‚¹ï¼Œæ¡ä»¶æ–­ç‚¹ï¼Œäº¤äº’å¼è°ƒè¯•
ğŸ”¸ å˜é‡ç›‘æ§ï¼šè·Ÿè¸ªå˜é‡å˜åŒ–ï¼ŒéªŒè¯å˜é‡æœ‰æ•ˆæ€§ï¼Œç›‘æ§ç¯å¢ƒå˜é‡
ğŸ”¸ æ€§èƒ½åˆ†æï¼šæ—¶é—´æµ‹é‡ï¼Œå‡½æ•°æ€§èƒ½åˆ†æï¼Œå†…å­˜ç›‘æ§
ğŸ”¸ å•å…ƒæµ‹è¯•ï¼šæµ‹è¯•æ¡†æ¶ä½¿ç”¨ï¼Œæ–­è¨€å‡½æ•°ï¼Œæµ‹è¯•é©±åŠ¨å¼€å‘
ğŸ”¸ è¦†ç›–ç‡ç»Ÿè®¡ï¼šè¡Œè¦†ç›–ç‡ï¼Œåˆ†æ”¯è¦†ç›–ç‡ï¼Œå‡½æ•°è¦†ç›–ç‡
ğŸ”¸ é™æ€åˆ†æï¼šshellcheckä½¿ç”¨ï¼Œè‡ªå®šä¹‰æ£€æŸ¥è§„åˆ™ï¼Œä»£ç é£æ ¼å’Œå®‰å…¨æ£€æŸ¥
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ è°ƒè¯•çš„æœ¬è´¨ç›®çš„**
```
è°ƒè¯•ä¸æ˜¯ä¸ºäº†ç‚«æŠ€ï¼Œè€Œæ˜¯ä¸ºäº†ï¼š
- å¿«é€Ÿå®šä½é—®é¢˜ï¼šå‡å°‘æ’é”™æ—¶é—´
- æé«˜ä»£ç è´¨é‡ï¼šå‘ç°æ½œåœ¨é—®é¢˜
- å¢å¼ºä¿¡å¿ƒï¼šç¡®ä¿ä»£ç æŒ‰é¢„æœŸå·¥ä½œ
- ç»´æŠ¤ä¾¿åˆ©ï¼šä¸ºå°†æ¥çš„ç»´æŠ¤æä¾›å¸®åŠ©
```

**ğŸ”¹ é€‰æ‹©åˆé€‚çš„è°ƒè¯•æ–¹æ³•**
```
é—®é¢˜ç±»å‹å¯¹åº”çš„è°ƒè¯•æ–¹æ³•ï¼š
- è¯­æ³•é”™è¯¯ â†’ bash -n æ£€æŸ¥
- é€»è¾‘é”™è¯¯ â†’ bash -x è·Ÿè¸ªæ‰§è¡Œ  
- å˜é‡é—®é¢˜ â†’ å˜é‡ç›‘æ§å’Œè·Ÿè¸ª
- æ€§èƒ½é—®é¢˜ â†’ æ—¶é—´æµ‹é‡å’Œæ€§èƒ½åˆ†æ
- åŠŸèƒ½é”™è¯¯ â†’ å•å…ƒæµ‹è¯•
- ä»£ç è´¨é‡ â†’ é™æ€ä»£ç åˆ†æ
```

**ğŸ”¹ è°ƒè¯•çš„å±‚æ¬¡åŒ–æ€ç»´**
```
è°ƒè¯•å±‚æ¬¡ï¼š
1. è¯­æ³•å±‚ â†’ ç¡®ä¿ä»£ç èƒ½è¿è¡Œ
2. é€»è¾‘å±‚ â†’ ç¡®ä¿ä»£ç åšå¯¹äº‹æƒ…  
3. æ€§èƒ½å±‚ â†’ ç¡®ä¿ä»£ç é«˜æ•ˆè¿è¡Œ
4. å®‰å…¨å±‚ â†’ ç¡®ä¿ä»£ç å®‰å…¨å¯é 
5. ç»´æŠ¤å±‚ â†’ ç¡®ä¿ä»£ç æ˜“äºç»´æŠ¤
```

### 10.3 å®é™…åº”ç”¨ä»·å€¼


- **å¼€å‘æ•ˆç‡**ï¼šåˆç†çš„è°ƒè¯•èƒ½å¤§å¹…æé«˜å¼€å‘æ•ˆç‡
- **ä»£ç è´¨é‡**ï¼šç³»ç»Ÿçš„æµ‹è¯•èƒ½ç¡®ä¿ä»£ç è´¨é‡
- **å›¢é˜Ÿåä½œ**ï¼šç»Ÿä¸€çš„ä»£ç æ£€æŸ¥æ ‡å‡†ä¾¿äºå›¢é˜Ÿåä½œ
- **é¡¹ç›®ç»´æŠ¤**ï¼šè‰¯å¥½çš„è°ƒè¯•ä¹ æƒ¯é™ä½ç»´æŠ¤æˆæœ¬

### 10.4 æœ€ä½³å®è·µå»ºè®®


**ğŸ¯ æ—¥å¸¸å¼€å‘å»ºè®®**
```
å¼€å‘é˜¶æ®µï¼š
âœ… ä½¿ç”¨ set -euo pipefail å¼€å¯ä¸¥æ ¼æ¨¡å¼
âœ… ä¸ºå¤æ‚é€»è¾‘æ·»åŠ è°ƒè¯•è¾“å‡º
âœ… é‡è¦å˜é‡è¦éªŒè¯å’Œç›‘æ§

æµ‹è¯•é˜¶æ®µï¼š  
âœ… ç¼–å†™å•å…ƒæµ‹è¯•è¦†ç›–ä¸»è¦åŠŸèƒ½
âœ… ä½¿ç”¨shellcheckæ£€æŸ¥ä»£ç è´¨é‡
âœ… è¿›è¡Œæ€§èƒ½æµ‹è¯•è¯†åˆ«ç“¶é¢ˆ

éƒ¨ç½²é˜¶æ®µï¼š
âœ… ç§»é™¤æˆ–æ§åˆ¶è°ƒè¯•è¾“å‡ºçº§åˆ«
âœ… ä¿ç•™å¿…è¦çš„æ—¥å¿—è®°å½•
âœ… å»ºç«‹ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶
```

**ğŸ”§ å·¥å…·ä½¿ç”¨å»ºè®®**
```
åˆå­¦è€…æ¨èï¼š
- bash -xï¼šæœ€åŸºç¡€çš„è°ƒè¯•å·¥å…·
- è‡ªå®šä¹‰debugå‡½æ•°ï¼šç®€å•å®ç”¨
- shellcheckï¼šä»£ç è´¨é‡æ£€æŸ¥

è¿›é˜¶ç”¨æˆ·æ¨èï¼š  
- bashdbï¼šä¸“ä¸šè°ƒè¯•å™¨
- batsï¼šå•å…ƒæµ‹è¯•æ¡†æ¶
- kcovï¼šä»£ç è¦†ç›–ç‡åˆ†æ
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- è°ƒè¯•é€‰é¡¹è¦ç†Ÿç»ƒï¼Œ-x -v -n -u -e
- å˜é‡çŠ¶æ€è¦ç›‘æ§ï¼Œé—®é¢˜å®šä½æ›´è½»æ¾
- å•å…ƒæµ‹è¯•ä¸å¯å°‘ï¼Œä»£ç è´¨é‡æœ‰ä¿éšœ  
- é™æ€åˆ†ææ‰¾é—®é¢˜ï¼Œå®‰å…¨è§„èŒƒè¦æ£€æŸ¥