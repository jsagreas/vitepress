---
title: 20ã€é«˜çº§ç¼–ç¨‹æ¨¡å¼ä¸æ¶æ„
---
## ğŸ“š ç›®å½•

1. [é¢å‘å¯¹è±¡ç¼–ç¨‹æ¨¡æ‹Ÿ](#1-é¢å‘å¯¹è±¡ç¼–ç¨‹æ¨¡æ‹Ÿ)
2. [è®¾è®¡æ¨¡å¼åœ¨Shellä¸­çš„åº”ç”¨](#2-è®¾è®¡æ¨¡å¼åœ¨Shellä¸­çš„åº”ç”¨)
3. [æ’ä»¶ç³»ç»Ÿæ¶æ„è®¾è®¡](#3-æ’ä»¶ç³»ç»Ÿæ¶æ„è®¾è®¡)
4. [é…ç½®é©±åŠ¨ç¼–ç¨‹æ¨¡å¼](#4-é…ç½®é©±åŠ¨ç¼–ç¨‹æ¨¡å¼)
5. [äº‹ä»¶é©±åŠ¨è„šæœ¬æ¶æ„](#5-äº‹ä»¶é©±åŠ¨è„šæœ¬æ¶æ„)
6. [çŠ¶æ€æœºå®ç°æŠ€æœ¯](#6-çŠ¶æ€æœºå®ç°æŠ€æœ¯)
7. [æ¡†æ¶è®¾è®¡ä¸æŠ½è±¡å±‚æ„å»º](#7-æ¡†æ¶è®¾è®¡ä¸æŠ½è±¡å±‚æ„å»º)
8. [å¤§å‹è„šæœ¬é¡¹ç›®ç»„ç»‡ç»“æ„](#8-å¤§å‹è„šæœ¬é¡¹ç›®ç»„ç»‡ç»“æ„)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ é¢å‘å¯¹è±¡ç¼–ç¨‹æ¨¡æ‹Ÿ


### 1.1 ä»€ä¹ˆæ˜¯Shellä¸­çš„é¢å‘å¯¹è±¡


**æ ¸å¿ƒç†è§£**ï¼šShellæœ¬èº«ä¸æ˜¯é¢å‘å¯¹è±¡è¯­è¨€ï¼Œä½†æˆ‘ä»¬å¯ä»¥ç”¨**å‘½åçº¦å®š**å’Œ**å‡½æ•°å°è£…**æ¥æ¨¡æ‹Ÿé¢å‘å¯¹è±¡çš„æ€æƒ³ã€‚

```
ä¼ ç»ŸShellå†™æ³•ï¼š          é¢å‘å¯¹è±¡æ¨¡æ‹Ÿï¼š
user_name="å¼ ä¸‰"         User_new "å¼ ä¸‰" "30"  # åˆ›å»ºç”¨æˆ·å¯¹è±¡
user_age=30              User_getName user1    # è°ƒç”¨æ–¹æ³•
echo $user_name          User_getAge user1     # è·å–å±æ€§

æ€æƒ³è½¬å˜ï¼šæŠŠæ•°æ®å’Œæ“ä½œæ•°æ®çš„å‡½æ•°ç»„ç»‡åœ¨ä¸€èµ·
```

### 1.2 ç±»çš„æ¨¡æ‹Ÿå®ç°


**ğŸ”¸ åŸºç¡€ç±»ç»“æ„**
```bash
#!/bin/bash

# ç”¨æˆ·"ç±»"çš„å®ç°
User_new() {
    local name="$1"
    local age="$2"
    local id="user_$$_$(date +%s)"  # ç”Ÿæˆå”¯ä¸€ID
    
    # å­˜å‚¨å¯¹è±¡å±æ€§ï¼ˆç”¨å…¨å±€å˜é‡æ¨¡æ‹Ÿï¼‰
    declare -g "${id}_name=$name"
    declare -g "${id}_age=$age"
    
    echo "$id"  # è¿”å›å¯¹è±¡ID
}

# è·å–å§“åçš„"æ–¹æ³•"
User_getName() {
    local id="$1"
    local var_name="${id}_name"
    echo "${!var_name}"  # é—´æ¥å˜é‡å¼•ç”¨
}

# è·å–å¹´é¾„çš„"æ–¹æ³•"
User_getAge() {
    local id="$1"
    local var_name="${id}_age"
    echo "${!var_name}"
}

# è®¾ç½®å¹´é¾„çš„"æ–¹æ³•"
User_setAge() {
    local id="$1"
    local new_age="$2"
    declare -g "${id}_age=$new_age"
}
```

**ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹**
```bash
# åˆ›å»ºä¸¤ä¸ªç”¨æˆ·å¯¹è±¡
user1=$(User_new "å¼ ä¸‰" "25")
user2=$(User_new "æå››" "30")

# è°ƒç”¨å¯¹è±¡æ–¹æ³•
echo "ç”¨æˆ·1å§“å: $(User_getName $user1)"
echo "ç”¨æˆ·2å¹´é¾„: $(User_getAge $user2)"

# ä¿®æ”¹å±æ€§
User_setAge $user1 26
echo "ç”¨æˆ·1æ–°å¹´é¾„: $(User_getAge $user1)"
```

### 1.3 ç»§æ‰¿çš„æ¨¡æ‹Ÿ


**ğŸ”¸ åŸºç±»ä¸æ´¾ç”Ÿç±»**
```bash
# åŠ¨ç‰©åŸºç±»
Animal_new() {
    local name="$1"
    local id="animal_$$_$(date +%s%N)"
    declare -g "${id}_name=$name"
    echo "$id"
}

Animal_speak() {
    local id="$1"
    echo "åŠ¨ç‰© $(Animal_getName $id) å‘å‡ºå£°éŸ³"
}

Animal_getName() {
    local id="$1"
    local var_name="${id}_name"
    echo "${!var_name}"
}

# ç‹—ç±»ï¼ˆç»§æ‰¿è‡ªåŠ¨ç‰©ï¼‰
Dog_new() {
    local name="$1"
    local breed="$2"
    local id=$(Animal_new "$name")  # è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°
    declare -g "${id}_breed=$breed"
    declare -g "${id}_type=dog"
    echo "$id"
}

# é‡å†™çˆ¶ç±»æ–¹æ³•
Dog_speak() {
    local id="$1"
    echo "ç‹— $(Animal_getName $id) æ±ªæ±ªå«"
}

Dog_getBreed() {
    local id="$1"
    local var_name="${id}_breed"
    echo "${!var_name}"
}
```

**å®é™…åº”ç”¨åœºæ™¯**ï¼š
- é…ç½®ç®¡ç†ç³»ç»Ÿï¼ˆä¸åŒç±»å‹çš„é…ç½®å¯¹è±¡ï¼‰
- æœåŠ¡ç›‘æ§è„šæœ¬ï¼ˆä¸åŒç±»å‹çš„æœåŠ¡å¯¹è±¡ï¼‰
- æ—¥å¿—å¤„ç†å·¥å…·ï¼ˆä¸åŒæ ¼å¼çš„æ—¥å¿—å¯¹è±¡ï¼‰

---

## 2. ğŸ—ï¸ è®¾è®¡æ¨¡å¼åœ¨Shellä¸­çš„åº”ç”¨


### 2.1 å•ä¾‹æ¨¡å¼


**å«ä¹‰è§£é‡Š**ï¼šç¡®ä¿æŸä¸ª"ç±»"åªæœ‰ä¸€ä¸ªå®ä¾‹å­˜åœ¨ï¼Œæ¯”å¦‚é…ç½®ç®¡ç†å™¨ã€æ—¥å¿—ç®¡ç†å™¨ç­‰ã€‚

```bash
# é…ç½®ç®¡ç†å™¨å•ä¾‹
Config_getInstance() {
    if [[ -z "$CONFIG_INSTANCE" ]]; then
        CONFIG_INSTANCE=$(Config_new)
        echo "é¦–æ¬¡åˆ›å»ºé…ç½®å®ä¾‹: $CONFIG_INSTANCE" >&2
    fi
    echo "$CONFIG_INSTANCE"
}

Config_new() {
    local id="config_$$"
    declare -g "${id}_data"
    echo "$id"
}

Config_set() {
    local instance=$(Config_getInstance)
    local key="$1"
    local value="$2"
    declare -g "${instance}_${key}=$value"
}

Config_get() {
    local instance=$(Config_getInstance)
    local key="$1"
    local var_name="${instance}_${key}"
    echo "${!var_name}"
}
```

### 2.2 å·¥å‚æ¨¡å¼


**å«ä¹‰è§£é‡Š**ï¼šæ ¹æ®ä¸åŒçš„æ¡ä»¶åˆ›å»ºä¸åŒç±»å‹çš„å¯¹è±¡ï¼Œè®©åˆ›å»ºè¿‡ç¨‹æ›´çµæ´»ã€‚

```bash
# æ—¥å¿—å¤„ç†å™¨å·¥å‚
LogProcessor_create() {
    local log_type="$1"
    
    case "$log_type" in
        "apache")
            ApacheLogProcessor_new
            ;;
        "nginx") 
            NginxLogProcessor_new
            ;;
        "system")
            SystemLogProcessor_new
            ;;
        *)
            echo "ä¸æ”¯æŒçš„æ—¥å¿—ç±»å‹: $log_type" >&2
            return 1
            ;;
    esac
}

# Apacheæ—¥å¿—å¤„ç†å™¨
ApacheLogProcessor_new() {
    local id="apache_processor_$$"
    declare -g "${id}_type=apache"
    declare -g "${id}_pattern='%h %l %u %t \"%r\" %>s %b'"
    echo "$id"
}

# ä½¿ç”¨å·¥å‚åˆ›å»ºå¤„ç†å™¨
processor=$(LogProcessor_create "apache")
```

### 2.3 è§‚å¯Ÿè€…æ¨¡å¼


**å«ä¹‰è§£é‡Š**ï¼šå½“æŸä¸ªå¯¹è±¡çŠ¶æ€æ”¹å˜æ—¶ï¼Œè‡ªåŠ¨é€šçŸ¥æ‰€æœ‰å…³æ³¨å®ƒçš„å¯¹è±¡ã€‚

```bash
# äº‹ä»¶å‘å¸ƒè®¢é˜…ç³»ç»Ÿ
declare -A OBSERVERS  # å­˜å‚¨è§‚å¯Ÿè€…

# æ·»åŠ è§‚å¯Ÿè€…
EventManager_subscribe() {
    local event="$1"
    local observer="$2"
    
    if [[ -n "${OBSERVERS[$event]}" ]]; then
        OBSERVERS[$event]="${OBSERVERS[$event]} $observer"
    else
        OBSERVERS[$event]="$observer"
    fi
}

# å‘å¸ƒäº‹ä»¶
EventManager_notify() {
    local event="$1"
    shift  # å‰©ä½™å‚æ•°ä½œä¸ºäº‹ä»¶æ•°æ®
    
    if [[ -n "${OBSERVERS[$event]}" ]]; then
        for observer in ${OBSERVERS[$event]}; do
            echo "é€šçŸ¥è§‚å¯Ÿè€… $observer å¤„ç†äº‹ä»¶ $event"
            $observer "$@"  # è°ƒç”¨è§‚å¯Ÿè€…å‡½æ•°
        done
    fi
}

# è§‚å¯Ÿè€…å‡½æ•°ç¤ºä¾‹
file_changed_handler() {
    local filename="$1"
    echo "æ–‡ä»¶ $filename å‘ç”Ÿäº†å˜åŒ–ï¼Œå¼€å§‹å¤‡ä»½..."
}

# ä½¿ç”¨ç¤ºä¾‹
EventManager_subscribe "file_changed" "file_changed_handler"
EventManager_notify "file_changed" "/etc/passwd"
```

---

## 3. ğŸ”Œ æ’ä»¶ç³»ç»Ÿæ¶æ„è®¾è®¡


### 3.1 æ’ä»¶ç³»ç»Ÿçš„åŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯æ’ä»¶ç³»ç»Ÿ**ï¼šå…è®¸åœ¨ä¸ä¿®æ”¹ä¸»ç¨‹åºçš„æƒ…å†µä¸‹ï¼ŒåŠ¨æ€åŠ è½½é¢å¤–åŠŸèƒ½æ¨¡å—çš„æ¶æ„ã€‚

```
ä¸»ç¨‹åºæ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ä¸»ç¨‹åºæ ¸å¿ƒ     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   æ’ä»¶ç®¡ç†å™¨     â”‚ â† è´Ÿè´£åŠ è½½å’Œç®¡ç†æ’ä»¶
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   æ’ä»¶æ¥å£      â”‚ â† å®šä¹‰æ’ä»¶å¿…é¡»å®ç°çš„è§„èŒƒ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ’ä»¶A â”‚æ’ä»¶B â”‚æ’ä»¶C â”‚ â† å…·ä½“çš„åŠŸèƒ½æ¨¡å—
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 æ’ä»¶æ¥å£è®¾è®¡


```bash
# æ’ä»¶æ¥å£è§„èŒƒï¼ˆæ‰€æœ‰æ’ä»¶å¿…é¡»å®ç°è¿™äº›å‡½æ•°ï¼‰
plugin_interface_check() {
    local plugin_name="$1"
    
    # æ£€æŸ¥å¿…éœ€çš„å‡½æ•°æ˜¯å¦å­˜åœ¨
    local required_functions=(
        "${plugin_name}_init"
        "${plugin_name}_execute" 
        "${plugin_name}_cleanup"
        "${plugin_name}_info"
    )
    
    for func in "${required_functions[@]}"; do
        if ! declare -F "$func" >/dev/null; then
            echo "æ’ä»¶ $plugin_name ç¼ºå°‘å¿…éœ€å‡½æ•°: $func" >&2
            return 1
        fi
    done
    
    return 0
}
```

### 3.3 æ’ä»¶ç®¡ç†å™¨å®ç°


```bash
#!/bin/bash

# æ’ä»¶ç®¡ç†å™¨
declare -A LOADED_PLUGINS
declare -A PLUGIN_INFO

PluginManager_loadPlugin() {
    local plugin_file="$1"
    local plugin_name=$(basename "$plugin_file" .sh)
    
    # æ£€æŸ¥æ’ä»¶æ–‡ä»¶æ˜¯å¦å­˜åœ¨
    if [[ ! -f "$plugin_file" ]]; then
        echo "æ’ä»¶æ–‡ä»¶ä¸å­˜åœ¨: $plugin_file" >&2
        return 1
    fi
    
    # åŠ è½½æ’ä»¶
    source "$plugin_file"
    
    # æ£€æŸ¥æ’ä»¶æ¥å£
    if plugin_interface_check "$plugin_name"; then
        # åˆå§‹åŒ–æ’ä»¶
        if ${plugin_name}_init; then
            LOADED_PLUGINS["$plugin_name"]="$plugin_file"
            PLUGIN_INFO["$plugin_name"]=$(${plugin_name}_info)
            echo "æ’ä»¶ $plugin_name åŠ è½½æˆåŠŸ"
        else
            echo "æ’ä»¶ $plugin_name åˆå§‹åŒ–å¤±è´¥" >&2
            return 1
        fi
    else
        echo "æ’ä»¶ $plugin_name æ¥å£ä¸ç¬¦åˆè§„èŒƒ" >&2
        return 1
    fi
}

PluginManager_executePlugin() {
    local plugin_name="$1"
    shift
    
    if [[ -n "${LOADED_PLUGINS[$plugin_name]}" ]]; then
        ${plugin_name}_execute "$@"
    else
        echo "æ’ä»¶ $plugin_name æœªåŠ è½½" >&2
        return 1
    fi
}

PluginManager_listPlugins() {
    echo "å·²åŠ è½½çš„æ’ä»¶:"
    for plugin in "${!LOADED_PLUGINS[@]}"; do
        echo "  $plugin: ${PLUGIN_INFO[$plugin]}"
    done
}
```

### 3.4 ç¤ºä¾‹æ’ä»¶å®ç°


```bash
# plugins/backup_plugin.sh
backup_plugin_init() {
    echo "å¤‡ä»½æ’ä»¶åˆå§‹åŒ–"
    return 0
}

backup_plugin_execute() {
    local source_dir="$1"
    local backup_dir="$2"
    
    echo "å¼€å§‹å¤‡ä»½ $source_dir åˆ° $backup_dir"
    cp -r "$source_dir" "$backup_dir"
    echo "å¤‡ä»½å®Œæˆ"
}

backup_plugin_cleanup() {
    echo "å¤‡ä»½æ’ä»¶æ¸…ç†èµ„æº"
}

backup_plugin_info() {
    echo "æ–‡ä»¶å¤‡ä»½æ’ä»¶ v1.0"
}
```

---

## 4. âš™ï¸ é…ç½®é©±åŠ¨ç¼–ç¨‹æ¨¡å¼


### 4.1 ä»€ä¹ˆæ˜¯é…ç½®é©±åŠ¨


**æ ¸å¿ƒæ€æƒ³**ï¼šç¨‹åºçš„è¡Œä¸ºç”±**å¤–éƒ¨é…ç½®æ–‡ä»¶**å†³å®šï¼Œè€Œä¸æ˜¯å†™æ­»åœ¨ä»£ç é‡Œã€‚è¿™æ ·å¯ä»¥åœ¨ä¸ä¿®æ”¹ä»£ç çš„æƒ…å†µä¸‹æ”¹å˜ç¨‹åºè¡Œä¸ºã€‚

```
ä¼ ç»Ÿæ–¹å¼ï¼š                é…ç½®é©±åŠ¨æ–¹å¼ï¼š
ç¨‹åºé€»è¾‘å†™æ­»åœ¨ä»£ç ä¸­       ç¨‹åºè¯»å–é…ç½®æ–‡ä»¶å†³å®šè¡Œä¸º
if [ "$env" = "prod" ]    æ ¹æ®config.iniä¸­çš„è®¾ç½®æ‰§è¡Œ
  deploy_to_prod          ä¸åŒçš„éƒ¨ç½²ç­–ç•¥
else
  deploy_to_test
fi
```

### 4.2 é…ç½®æ–‡ä»¶æ ¼å¼è®¾è®¡


**ğŸ”¸ INIæ ¼å¼é…ç½®**
```ini
# config/app.ini
[database]
host=localhost
port=3306
username=admin
password=secret123

[logging]
level=INFO
file=/var/log/app.log
max_size=100MB

[backup]
enabled=true
schedule=0 2 * * *
retention_days=7
```

**ğŸ”¸ é…ç½®è§£æå™¨**
```bash
# è§£æINIé…ç½®æ–‡ä»¶
Config_parseIni() {
    local config_file="$1"
    local section=""
    
    while IFS= read -r line; do
        # è·³è¿‡æ³¨é‡Šå’Œç©ºè¡Œ
        [[ "$line" =~ ^[[:space:]]*# ]] && continue
        [[ "$line" =~ ^[[:space:]]*$ ]] && continue
        
        # å¤„ç†section
        if [[ "$line" =~ ^\[([^\]]+)\] ]]; then
            section="${BASH_REMATCH[1]}"
            continue
        fi
        
        # å¤„ç†é”®å€¼å¯¹
        if [[ "$line" =~ ^([^=]+)=(.*)$ ]]; then
            local key="${BASH_REMATCH[1]// /}"  # å»é™¤ç©ºæ ¼
            local value="${BASH_REMATCH[2]}"
            declare -g "CONFIG_${section}_${key}=$value"
        fi
    done < "$config_file"
}

# è·å–é…ç½®å€¼
Config_get() {
    local section="$1"
    local key="$2"
    local var_name="CONFIG_${section}_${key}"
    echo "${!var_name}"
}
```

### 4.3 é…ç½®é©±åŠ¨çš„ä»»åŠ¡è°ƒåº¦å™¨


```bash
#!/bin/bash

# åŸºäºé…ç½®çš„ä»»åŠ¡è°ƒåº¦å™¨
TaskScheduler_init() {
    local config_file="$1"
    Config_parseIni "$config_file"
    
    # æ ¹æ®é…ç½®å¯ç”¨ä¸åŒåŠŸèƒ½
    if [[ "$(Config_get backup enabled)" == "true" ]]; then
        echo "å¯ç”¨å¤‡ä»½åŠŸèƒ½"
        setup_backup_job
    fi
    
    if [[ "$(Config_get monitoring enabled)" == "true" ]]; then
        echo "å¯ç”¨ç›‘æ§åŠŸèƒ½"  
        setup_monitoring
    fi
}

setup_backup_job() {
    local schedule=$(Config_get backup schedule)
    local source=$(Config_get backup source_dir)
    local target=$(Config_get backup target_dir)
    
    echo "è®¾ç½®å¤‡ä»½ä»»åŠ¡: $schedule"
    echo "æºç›®å½•: $source, ç›®æ ‡ç›®å½•: $target"
}
```

---

## 5. ğŸ“¡ äº‹ä»¶é©±åŠ¨è„šæœ¬æ¶æ„


### 5.1 äº‹ä»¶é©±åŠ¨çš„æ ¸å¿ƒæ¦‚å¿µ


**ä»€ä¹ˆæ˜¯äº‹ä»¶é©±åŠ¨**ï¼šç¨‹åºä¸æ˜¯æŒ‰å›ºå®šé¡ºåºæ‰§è¡Œï¼Œè€Œæ˜¯å“åº”å„ç§**äº‹ä»¶**çš„å‘ç”Ÿã€‚äº‹ä»¶å¯ä»¥æ˜¯æ–‡ä»¶å˜åŒ–ã€æ—¶é—´åˆ°è¾¾ã€ç”¨æˆ·è¾“å…¥ç­‰ã€‚

```
ä¼ ç»Ÿé¡ºåºæ‰§è¡Œï¼š         äº‹ä»¶é©±åŠ¨æ‰§è¡Œï¼š
step1 â†’ step2 â†’ step3   ç­‰å¾…äº‹ä»¶ â†’ å¤„ç†äº‹ä»¶A
                       ç­‰å¾…äº‹ä»¶ â†’ å¤„ç†äº‹ä»¶B  
                       ç­‰å¾…äº‹ä»¶ â†’ å¤„ç†äº‹ä»¶C
                       
ä¼˜åŠ¿ï¼šæ›´çµæ´»ï¼Œæ›´é€‚åˆå¤„ç†å¼‚æ­¥å’Œå¹¶å‘åœºæ™¯
```

### 5.2 äº‹ä»¶ç³»ç»Ÿæ¶æ„


```
äº‹ä»¶é©±åŠ¨æ¶æ„å›¾ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  äº‹ä»¶æº1    â”‚    â”‚  äº‹ä»¶æº2    â”‚    â”‚  äº‹ä»¶æº3    â”‚
â”‚ (æ–‡ä»¶ç›‘æ§)   â”‚    â”‚ (å®šæ—¶å™¨)     â”‚    â”‚ (ç½‘ç»œè¯·æ±‚)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                  â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚      äº‹ä»¶é˜Ÿåˆ—         â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚     äº‹ä»¶åˆ†å‘å™¨        â”‚
              â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
                  â”‚               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   äº‹ä»¶å¤„ç†å™¨A     â”‚ â”‚ äº‹ä»¶å¤„ç†å™¨B â”‚
        â”‚  (å¤‡ä»½å¤„ç†)      â”‚ â”‚  (å‘Šè­¦å¤„ç†) â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 äº‹ä»¶ç³»ç»Ÿå®ç°


**ğŸ”¸ äº‹ä»¶é˜Ÿåˆ—ç®¡ç†**
```bash
#!/bin/bash

# äº‹ä»¶é˜Ÿåˆ—ï¼ˆä½¿ç”¨æ•°ç»„æ¨¡æ‹Ÿï¼‰
declare -a EVENT_QUEUE
declare -A EVENT_HANDLERS

# æ·»åŠ äº‹ä»¶åˆ°é˜Ÿåˆ—
EventQueue_push() {
    local event_type="$1"
    local event_data="$2"
    local timestamp=$(date +%s)
    
    local event_json="{\"type\":\"$event_type\",\"data\":\"$event_data\",\"timestamp\":$timestamp}"
    EVENT_QUEUE+=("$event_json")
    
    echo "äº‹ä»¶å…¥é˜Ÿ: $event_type"
}

# ä»é˜Ÿåˆ—å–å‡ºäº‹ä»¶
EventQueue_pop() {
    if [[ ${#EVENT_QUEUE[@]} -gt 0 ]]; then
        local event="${EVENT_QUEUE[0]}"
        # åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ 
        EVENT_QUEUE=("${EVENT_QUEUE[@]:1}")
        echo "$event"
    fi
}

# æ³¨å†Œäº‹ä»¶å¤„ç†å™¨
EventSystem_register() {
    local event_type="$1"
    local handler_func="$2"
    EVENT_HANDLERS["$event_type"]="$handler_func"
    echo "æ³¨å†Œäº‹ä»¶å¤„ç†å™¨: $event_type -> $handler_func"
}

# äº‹ä»¶åˆ†å‘å™¨
EventSystem_dispatch() {
    local event="$1"
    
    # ç®€å•çš„JSONè§£æï¼ˆå®é™…é¡¹ç›®ä¸­å»ºè®®ç”¨jqï¼‰
    local event_type=$(echo "$event" | sed -n 's/.*"type":"\([^"]*\)".*/\1/p')
    local event_data=$(echo "$event" | sed -n 's/.*"data":"\([^"]*\)".*/\1/p')
    
    if [[ -n "${EVENT_HANDLERS[$event_type]}" ]]; then
        echo "å¤„ç†äº‹ä»¶: $event_type"
        ${EVENT_HANDLERS[$event_type]} "$event_data"
    else
        echo "æ²¡æœ‰æ‰¾åˆ°äº‹ä»¶å¤„ç†å™¨: $event_type"
    fi
}
```

### 5.4 æ–‡ä»¶ç›‘æ§äº‹ä»¶æº


```bash
# æ–‡ä»¶å˜åŒ–ç›‘æ§
FileMonitor_start() {
    local watch_dir="$1"
    local interval="${2:-5}"  # é»˜è®¤5ç§’æ£€æŸ¥ä¸€æ¬¡
    
    echo "å¼€å§‹ç›‘æ§ç›®å½•: $watch_dir"
    
    while true; do
        # æ£€æŸ¥æ–‡ä»¶å˜åŒ–ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼Œå®é™…å¯ç”¨inotifyï¼‰
        local current_files=$(find "$watch_dir" -type f -newer /tmp/last_check 2>/dev/null)
        
        if [[ -n "$current_files" ]]; then
            while IFS= read -r file; do
                EventQueue_push "file_changed" "$file"
            done <<< "$current_files"
        fi
        
        touch /tmp/last_check
        sleep $interval
    done &
    
    echo "æ–‡ä»¶ç›‘æ§å™¨å¯åŠ¨ï¼ŒPID: $!"
}

# æ–‡ä»¶å˜åŒ–å¤„ç†å™¨
handle_file_change() {
    local filename="$1"
    echo "æ–‡ä»¶ $filename å‘ç”Ÿå˜åŒ–"
    
    # æ ¹æ®æ–‡ä»¶ç±»å‹æ‰§è¡Œä¸åŒæ“ä½œ
    case "$filename" in
        *.conf)
            echo "é…ç½®æ–‡ä»¶å˜åŒ–ï¼Œé‡æ–°åŠ è½½é…ç½®"
            ;;
        *.log)
            echo "æ—¥å¿—æ–‡ä»¶å˜åŒ–ï¼Œæ£€æŸ¥é”™è¯¯"
            ;;
        *)
            echo "æ™®é€šæ–‡ä»¶å˜åŒ–ï¼Œæ‰§è¡Œå¤‡ä»½"
            ;;
    esac
}
```

---

## 6. ğŸ”„ çŠ¶æ€æœºå®ç°æŠ€æœ¯


### 6.1 ä»€ä¹ˆæ˜¯çŠ¶æ€æœº


**é€šä¿—è§£é‡Š**ï¼šçŠ¶æ€æœºå°±åƒä¸€ä¸ªæœ‰å¤šç§çŠ¶æ€çš„æœºå™¨ï¼Œåœ¨ä¸åŒæ¡ä»¶ä¸‹ä¼šä»ä¸€ä¸ªçŠ¶æ€è½¬æ¢åˆ°å¦ä¸€ä¸ªçŠ¶æ€ã€‚æ¯”å¦‚ç”µç¯å¼€å…³ï¼šå…³é—­â†’æ‰“å¼€â†’å…³é—­ã€‚

```
ç®€å•çŠ¶æ€æœºç¤ºä¾‹ï¼š
     æŒ‰å¼€å…³      æŒ‰å¼€å…³
å…³é—­ â”€â”€â”€â”€â†’ æ‰“å¼€ â”€â”€â”€â”€â†’ å…³é—­
 â†‘                    â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        æŒ‰å¼€å…³

çŠ¶æ€æœºçš„ä¸‰è¦ç´ ï¼š
1. çŠ¶æ€(State)ï¼šæœºå™¨å½“å‰æ‰€å¤„çš„æƒ…å†µ
2. äº‹ä»¶(Event)ï¼šè§¦å‘çŠ¶æ€æ”¹å˜çš„æ¡ä»¶  
3. è½¬æ¢(Transition)ï¼šä»ä¸€ä¸ªçŠ¶æ€åˆ°å¦ä¸€ä¸ªçŠ¶æ€çš„è§„åˆ™
```

### 6.2 æœåŠ¡ç®¡ç†çŠ¶æ€æœº


**ğŸ”¸ æœåŠ¡çŠ¶æ€å®šä¹‰**
```bash
#!/bin/bash

# æœåŠ¡çŠ¶æ€å¸¸é‡
readonly STATE_STOPPED="stopped"
readonly STATE_STARTING="starting"
readonly STATE_RUNNING="running"
readonly STATE_STOPPING="stopping"
readonly STATE_ERROR="error"

# çŠ¶æ€æœºæ•°æ®ç»“æ„
declare -A SERVICE_STATES
declare -A STATE_HANDLERS

# çŠ¶æ€æœºåˆå§‹åŒ–
StateMachine_init() {
    local service_name="$1"
    SERVICE_STATES["$service_name"]="$STATE_STOPPED"
    echo "æœåŠ¡ $service_name åˆå§‹åŒ–ä¸º stopped çŠ¶æ€"
}
```

**ğŸ”¸ çŠ¶æ€è½¬æ¢è§„åˆ™**
```bash
# æ£€æŸ¥çŠ¶æ€è½¬æ¢æ˜¯å¦åˆæ³•
StateMachine_canTransition() {
    local service="$1"
    local from_state="$2"
    local to_state="$3"
    
    # å®šä¹‰å…è®¸çš„çŠ¶æ€è½¬æ¢
    case "$from_state" in
        "$STATE_STOPPED")
            [[ "$to_state" == "$STATE_STARTING" ]] && return 0
            ;;
        "$STATE_STARTING")
            [[ "$to_state" == "$STATE_RUNNING" || "$to_state" == "$STATE_ERROR" ]] && return 0
            ;;
        "$STATE_RUNNING")
            [[ "$to_state" == "$STATE_STOPPING" || "$to_state" == "$STATE_ERROR" ]] && return 0
            ;;
        "$STATE_STOPPING")
            [[ "$to_state" == "$STATE_STOPPED" || "$to_state" == "$STATE_ERROR" ]] && return 0
            ;;
        "$STATE_ERROR")
            [[ "$to_state" == "$STATE_STOPPED" ]] && return 0
            ;;
    esac
    
    return 1
}

# æ‰§è¡ŒçŠ¶æ€è½¬æ¢
StateMachine_transition() {
    local service="$1"
    local new_state="$2"
    local current_state="${SERVICE_STATES[$service]}"
    
    if StateMachine_canTransition "$service" "$current_state" "$new_state"; then
        echo "æœåŠ¡ $service: $current_state â†’ $new_state"
        SERVICE_STATES["$service"]="$new_state"
        
        # æ‰§è¡ŒçŠ¶æ€è¿›å…¥å¤„ç†å™¨
        local handler="handle_${new_state}"
        if declare -F "$handler" >/dev/null; then
            $handler "$service"
        fi
    else
        echo "éæ³•çŠ¶æ€è½¬æ¢: $service ($current_state â†’ $new_state)" >&2
        return 1
    fi
}
```

### 6.3 çŠ¶æ€å¤„ç†å™¨


```bash
# å„çŠ¶æ€çš„å¤„ç†é€»è¾‘
handle_starting() {
    local service="$1"
    echo "æ­£åœ¨å¯åŠ¨æœåŠ¡: $service"
    
    # æ¨¡æ‹Ÿå¯åŠ¨è¿‡ç¨‹
    if start_service_process "$service"; then
        StateMachine_transition "$service" "$STATE_RUNNING"
    else
        StateMachine_transition "$service" "$STATE_ERROR"
    fi
}

handle_running() {
    local service="$1"
    echo "æœåŠ¡ $service æ­£åœ¨è¿è¡Œ"
    
    # å¯åŠ¨å¥åº·æ£€æŸ¥
    schedule_health_check "$service"
}

handle_stopping() {
    local service="$1"
    echo "æ­£åœ¨åœæ­¢æœåŠ¡: $service"
    
    if stop_service_process "$service"; then
        StateMachine_transition "$service" "$STATE_STOPPED"
    else
        StateMachine_transition "$service" "$STATE_ERROR"
    fi
}

handle_error() {
    local service="$1"
    echo "æœåŠ¡ $service è¿›å…¥é”™è¯¯çŠ¶æ€ï¼Œè®°å½•æ—¥å¿—"
    
    # è®°å½•é”™è¯¯æ—¥å¿—
    echo "$(date): æœåŠ¡ $service å‘ç”Ÿé”™è¯¯" >> /var/log/service_errors.log
    
    # å¯ä»¥è®¾ç½®è‡ªåŠ¨æ¢å¤é€»è¾‘
    # schedule_restart "$service"
}
```

---

## 7. ğŸ›ï¸ æ¡†æ¶è®¾è®¡ä¸æŠ½è±¡å±‚æ„å»º


### 7.1 æ¡†æ¶è®¾è®¡çš„æ ¸å¿ƒæ€æƒ³


**ä»€ä¹ˆæ˜¯æ¡†æ¶**ï¼šæ¡†æ¶æ˜¯ä¸€ä¸ª**åŠæˆå“è½¯ä»¶**ï¼Œæä¾›äº†é€šç”¨çš„åŠŸèƒ½å’Œç»“æ„ï¼Œå¼€å‘è€…åœ¨æ­¤åŸºç¡€ä¸Šå¡«å…¥å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚

```
æ¡†æ¶çš„åˆ†å±‚æ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ä¸šåŠ¡é€»è¾‘å±‚           â”‚ â† ç”¨æˆ·ç¼–å†™çš„å…·ä½“ä¸šåŠ¡ä»£ç 
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        æŠ½è±¡æ¥å£å±‚           â”‚ â† å®šä¹‰è§„èŒƒï¼Œéšè—å¤æ‚æ€§
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  
â”‚        æ ¸å¿ƒåŠŸèƒ½å±‚           â”‚ â† æ¡†æ¶æä¾›çš„é€šç”¨åŠŸèƒ½
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        åŸºç¡€å·¥å…·å±‚           â”‚ â† æ—¥å¿—ã€é…ç½®ã€å·¥å…·å‡½æ•°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¥½å¤„ï¼šå¼€å‘è€…åªéœ€å…³æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œæ¡†æ¶å¤„ç†æŠ€æœ¯ç»†èŠ‚
```

### 7.2 æ—¥å¿—æ¡†æ¶è®¾è®¡


**ğŸ”¸ æŠ½è±¡æ—¥å¿—æ¥å£**
```bash
#!/bin/bash

# æ—¥å¿—çº§åˆ«å®šä¹‰
readonly LOG_DEBUG=0
readonly LOG_INFO=1  
readonly LOG_WARN=2
readonly LOG_ERROR=3

# å…¨å±€æ—¥å¿—é…ç½®
LOG_LEVEL=$LOG_INFO
LOG_FILE="/tmp/app.log"
LOG_FORMAT="[%s] %s: %s\n"

# æŠ½è±¡æ—¥å¿—æ¥å£
Logger_log() {
    local level="$1"
    local message="$2"
    local timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    
    # æ£€æŸ¥æ—¥å¿—çº§åˆ«
    if [[ $level -lt $LOG_LEVEL ]]; then
        return 0
    fi
    
    # è·å–çº§åˆ«åç§°
    local level_name
    case $level in
        $LOG_DEBUG) level_name="DEBUG" ;;
        $LOG_INFO)  level_name="INFO"  ;;
        $LOG_WARN)  level_name="WARN"  ;;
        $LOG_ERROR) level_name="ERROR" ;;
    esac
    
    # æ ¼å¼åŒ–å¹¶è¾“å‡ºæ—¥å¿—
    printf "$LOG_FORMAT" "$timestamp" "$level_name" "$message" | tee -a "$LOG_FILE"
}

# ä¾¿æ·çš„æ—¥å¿—æ–¹æ³•
Logger_debug() { Logger_log $LOG_DEBUG "$*"; }
Logger_info()  { Logger_log $LOG_INFO  "$*"; }
Logger_warn()  { Logger_log $LOG_WARN  "$*"; }
Logger_error() { Logger_log $LOG_ERROR "$*"; }
```

### 7.3 é…ç½®ç®¡ç†æ¡†æ¶


```bash
# é…ç½®ç®¡ç†æŠ½è±¡å±‚
ConfigManager_init() {
    local config_type="${1:-ini}"
    local config_file="$2"
    
    case "$config_type" in
        "ini")
            Config_parseIni "$config_file"
            ;;
        "env")
            Config_parseEnv "$config_file"
            ;;
        "yaml")
            Config_parseYaml "$config_file"
            ;;
        *)
            Logger_error "ä¸æ”¯æŒçš„é…ç½®ç±»å‹: $config_type"
            return 1
            ;;
    esac
}

# ç»Ÿä¸€çš„é…ç½®è·å–æ¥å£
ConfigManager_get() {
    local key="$1"
    local default_value="$2"
    
    # ä¼˜å…ˆçº§ï¼šç¯å¢ƒå˜é‡ > é…ç½®æ–‡ä»¶ > é»˜è®¤å€¼
    local value="${!key}"  # ç¯å¢ƒå˜é‡
    
    if [[ -z "$value" ]]; then
        value=$(Config_get_from_file "$key")  # é…ç½®æ–‡ä»¶
    fi
    
    if [[ -z "$value" ]]; then
        value="$default_value"  # é»˜è®¤å€¼
    fi
    
    echo "$value"
}
```

---

## 8. ğŸ¢ å¤§å‹è„šæœ¬é¡¹ç›®ç»„ç»‡ç»“æ„


### 8.1 é¡¹ç›®ç›®å½•ç»“æ„è®¾è®¡


**ğŸ”¸ æ ‡å‡†é¡¹ç›®å¸ƒå±€**
```
project_root/
â”œâ”€â”€ bin/                    # å¯æ‰§è¡Œè„šæœ¬
â”‚   â”œâ”€â”€ main.sh
â”‚   â””â”€â”€ admin.sh
â”œâ”€â”€ lib/                    # æ ¸å¿ƒåº“æ–‡ä»¶
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ logger.sh
â”‚   â”‚   â”œâ”€â”€ config.sh
â”‚   â”‚   â””â”€â”€ utils.sh
â”‚   â”œâ”€â”€ plugins/
â”‚   â”‚   â”œâ”€â”€ backup.sh
â”‚   â”‚   â””â”€â”€ monitor.sh
â”‚   â””â”€â”€ framework/
â”‚       â”œâ”€â”€ base.sh
â”‚       â””â”€â”€ mvc.sh
â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ app.ini
â”‚   â”œâ”€â”€ database.conf
â”‚   â””â”€â”€ environments/
â”‚       â”œâ”€â”€ dev.ini
â”‚       â”œâ”€â”€ test.ini
â”‚       â””â”€â”€ prod.ini
â”œâ”€â”€ data/                   # æ•°æ®æ–‡ä»¶
â”‚   â”œâ”€â”€ templates/
â”‚   â””â”€â”€ cache/
â”œâ”€â”€ logs/                   # æ—¥å¿—ç›®å½•
â”œâ”€â”€ tests/                  # æµ‹è¯•è„šæœ¬
â”‚   â”œâ”€â”€ unit/
â”‚   â””â”€â”€ integration/
â”œâ”€â”€ docs/                   # æ–‡æ¡£
â”‚   â”œâ”€â”€ README.md
â”‚   â””â”€â”€ api.md
â””â”€â”€ scripts/                # è¾…åŠ©è„šæœ¬
    â”œâ”€â”€ install.sh
    â””â”€â”€ deploy.sh
```

### 8.2 æ¨¡å—åŒ–åŠ è½½ç³»ç»Ÿ


```bash
#!/bin/bash
# lib/framework/loader.sh

# æ¨¡å—åŠ è½½å™¨
declare -A LOADED_MODULES

Module_load() {
    local module_name="$1"
    local module_path="${2:-lib}"
    
    # é¿å…é‡å¤åŠ è½½
    if [[ -n "${LOADED_MODULES[$module_name]}" ]]; then
        return 0
    fi
    
    # æŸ¥æ‰¾æ¨¡å—æ–‡ä»¶
    local module_file
    for path in "$module_path" "lib/core" "lib/plugins"; do
        if [[ -f "$path/${module_name}.sh" ]]; then
            module_file="$path/${module_name}.sh"
            break
        fi
    done
    
    if [[ -z "$module_file" ]]; then
        Logger_error "æ‰¾ä¸åˆ°æ¨¡å—: $module_name"
        return 1
    fi
    
    # åŠ è½½æ¨¡å—
    source "$module_file"
    LOADED_MODULES["$module_name"]="$module_file"
    Logger_debug "æ¨¡å—åŠ è½½æˆåŠŸ: $module_name"
}

# æ‰¹é‡åŠ è½½æ ¸å¿ƒæ¨¡å—
Framework_bootstrap() {
    local core_modules=(
        "logger"
        "config" 
        "utils"
        "error_handler"
    )
    
    for module in "${core_modules[@]}"; do
        Module_load "$module"
    done
}
```

### 8.3 ä¸»ç¨‹åºå…¥å£è®¾è®¡


```bash
#!/bin/bash
# bin/main.sh

# è®¾ç½®é¡¹ç›®æ ¹ç›®å½•
PROJECT_ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"
export PROJECT_ROOT

# åŠ è½½æ¡†æ¶
source "$PROJECT_ROOT/lib/framework/loader.sh"
Framework_bootstrap

# åº”ç”¨åˆå§‹åŒ–
App_init() {
    # åŠ è½½é…ç½®
    ConfigManager_init "ini" "$PROJECT_ROOT/config/app.ini"
    
    # è®¾ç½®æ—¥å¿—
    LOG_LEVEL=$(ConfigManager_get "LOG_LEVEL" "$LOG_INFO")
    LOG_FILE="$PROJECT_ROOT/logs/app.log"
    
    Logger_info "åº”ç”¨å¯åŠ¨: $(date)"
}

# å‘½ä»¤è¡Œå‚æ•°å¤„ç†
App_main() {
    local command="$1"
    shift
    
    case "$command" in
        "start")
            App_start "$@"
            ;;
        "stop")
            App_stop "$@"
            ;;
        "status")
            App_status "$@"
            ;;
        "config")
            App_config "$@"
            ;;
        *)
            App_usage
            ;;
    esac
}

# åº”ç”¨ä½¿ç”¨è¯´æ˜
App_usage() {
    cat << EOF
ç”¨æ³•: $0 <å‘½ä»¤> [é€‰é¡¹]

å‘½ä»¤:
  start   å¯åŠ¨åº”ç”¨
  stop    åœæ­¢åº”ç”¨  
  status  æŸ¥çœ‹çŠ¶æ€
  config  é…ç½®ç®¡ç†

é€‰é¡¹:
  -h, --help     æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
  -v, --verbose  è¯¦ç»†è¾“å‡º
  -c, --config   æŒ‡å®šé…ç½®æ–‡ä»¶

EOF
}

# ä¸»å‡½æ•°
main() {
    App_init
    App_main "$@"
}

# åªæœ‰ç›´æ¥æ‰§è¡Œæ—¶æ‰è¿è¡Œmainå‡½æ•°
if [[ "${BASH_SOURCE[0]}" == "${0}" ]]; then
    main "$@"
fi
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ é¢å‘å¯¹è±¡æ¨¡æ‹Ÿï¼šç”¨å‡½æ•°å’Œå˜é‡æ¨¡æ‹Ÿç±»ã€å¯¹è±¡ã€ç»§æ‰¿
ğŸ”¸ è®¾è®¡æ¨¡å¼åº”ç”¨ï¼šå•ä¾‹ã€å·¥å‚ã€è§‚å¯Ÿè€…ç­‰æ¨¡å¼åœ¨Shellä¸­çš„å®ç°
ğŸ”¸ æ’ä»¶ç³»ç»Ÿæ¶æ„ï¼šæ¥å£è§„èŒƒã€æ’ä»¶ç®¡ç†å™¨ã€åŠ¨æ€åŠ è½½
ğŸ”¸ é…ç½®é©±åŠ¨ç¼–ç¨‹ï¼šå¤–éƒ¨é…ç½®æ§åˆ¶ç¨‹åºè¡Œä¸ºï¼Œæé«˜çµæ´»æ€§
ğŸ”¸ äº‹ä»¶é©±åŠ¨æ¶æ„ï¼šå“åº”å¼ç¼–ç¨‹ï¼Œäº‹ä»¶é˜Ÿåˆ—ã€åˆ†å‘å™¨ã€å¤„ç†å™¨
ğŸ”¸ çŠ¶æ€æœºå®ç°ï¼šçŠ¶æ€ç®¡ç†ã€è½¬æ¢è§„åˆ™ã€çŠ¶æ€å¤„ç†å™¨
ğŸ”¸ æ¡†æ¶è®¾è®¡æ€æƒ³ï¼šåˆ†å±‚æ¶æ„ã€æŠ½è±¡æ¥å£ã€é€šç”¨åŠŸèƒ½
ğŸ”¸ é¡¹ç›®ç»„ç»‡ç»“æ„ï¼šæ¨¡å—åŒ–è®¾è®¡ã€ç›®å½•è§„èŒƒã€åŠ è½½ç³»ç»Ÿ
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆè¦ç”¨è¿™äº›é«˜çº§æ¨¡å¼**
- **å¯ç»´æŠ¤æ€§**ï¼šä»£ç ç»“æ„æ¸…æ™°ï¼Œæ˜“äºä¿®æ”¹å’Œæ‰©å±•
- **å¯é‡ç”¨æ€§**ï¼šé€šç”¨åŠŸèƒ½å¯ä»¥åœ¨å¤šä¸ªé¡¹ç›®ä¸­ä½¿ç”¨
- **å¯æµ‹è¯•æ€§**ï¼šæ¨¡å—åŒ–çš„ä»£ç æ›´å®¹æ˜“è¿›è¡Œå•å…ƒæµ‹è¯•
- **å›¢é˜Ÿåä½œ**ï¼šç»Ÿä¸€çš„è§„èŒƒä¾¿äºå¤šäººåä½œå¼€å‘

**ğŸ”¹ ä»€ä¹ˆæ—¶å€™ä½¿ç”¨é«˜çº§æ¨¡å¼**
- **é¡¹ç›®å¤æ‚åº¦é«˜**ï¼šè¶…è¿‡1000è¡Œä»£ç çš„å¤§å‹è„šæœ¬
- **éœ€è¦æ‰©å±•æ€§**ï¼šåŠŸèƒ½éœ€è¦ç»å¸¸å¢åŠ æˆ–ä¿®æ”¹
- **å›¢é˜Ÿå¼€å‘**ï¼šå¤šäººåä½œå¼€å‘ç»´æŠ¤
- **é•¿æœŸç»´æŠ¤**ï¼šéœ€è¦é•¿æœŸè¿è¡Œå’Œç»´æŠ¤çš„ç³»ç»Ÿ

**ğŸ”¹ å®æ–½çš„ä¼˜å…ˆçº§**
```
åŸºç¡€é˜¶æ®µï¼šå‡½æ•°å°è£…ã€é”™è¯¯å¤„ç†ã€æ—¥å¿—è®°å½•
è¿›é˜¶é˜¶æ®µï¼šé…ç½®ç®¡ç†ã€æ¨¡å—åŒ–è®¾è®¡  
é«˜çº§é˜¶æ®µï¼šè®¾è®¡æ¨¡å¼ã€æ¡†æ¶è®¾è®¡ã€æ’ä»¶ç³»ç»Ÿ
ä¸“å®¶é˜¶æ®µï¼šäº‹ä»¶é©±åŠ¨ã€çŠ¶æ€æœºã€å¤§å‹é¡¹ç›®æ¶æ„
```

### 9.3 å®é™…åº”ç”¨åœºæ™¯


- **ğŸ¢ ä¼ä¸šè¿ç»´å¹³å°**ï¼šä½¿ç”¨æ¡†æ¶è®¾è®¡æ„å»ºç»Ÿä¸€çš„è¿ç»´å·¥å…·
- **â˜ï¸ è‡ªåŠ¨åŒ–éƒ¨ç½²ç³»ç»Ÿ**ï¼šäº‹ä»¶é©±åŠ¨å“åº”ä»£ç å˜æ›´å’Œéƒ¨ç½²è¯·æ±‚  
- **ğŸ“Š ç›‘æ§å‘Šè­¦ç³»ç»Ÿ**ï¼šæ’ä»¶æ¶æ„æ”¯æŒä¸åŒç±»å‹çš„ç›‘æ§æ’ä»¶
- **ğŸ”„ æœåŠ¡ç®¡ç†å¹³å°**ï¼šçŠ¶æ€æœºç®¡ç†æœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸ
- **âš™ï¸ é…ç½®ç®¡ç†ä¸­å¿ƒ**ï¼šé…ç½®é©±åŠ¨æ”¯æŒå¤šç¯å¢ƒéƒ¨ç½²

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- Shellé«˜çº§æ¨¡å¼è®©è„šæœ¬ä»**å·¥å…·**å‡çº§ä¸º**ç³»ç»Ÿ**
- åˆç†çš„æ¶æ„è®¾è®¡æ˜¯å¤§å‹é¡¹ç›®æˆåŠŸçš„å…³é”®
- ä¸è¦ä¸ºäº†æŠ€æœ¯è€ŒæŠ€æœ¯ï¼Œè¦æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ¨¡å¼
- ä»ç®€å•å¼€å§‹ï¼Œé€æ­¥æ¼”è¿›åˆ°å¤æ‚æ¶æ„