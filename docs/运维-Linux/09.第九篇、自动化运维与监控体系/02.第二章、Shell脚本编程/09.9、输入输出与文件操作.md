---
title: 9ã€è¾“å…¥è¾“å‡ºä¸æ–‡ä»¶æ“ä½œ
---
## ğŸ“š ç›®å½•

1. [ç”¨æˆ·è¾“å…¥å¤„ç†ï¼ˆreadå‘½ä»¤ï¼‰](#1-ç”¨æˆ·è¾“å…¥å¤„ç†readå‘½ä»¤)
2. [æ ¼å¼åŒ–è¾“å‡ºæ§åˆ¶ï¼ˆprintfï¼‰](#2-æ ¼å¼åŒ–è¾“å‡ºæ§åˆ¶printf)
3. [æ–‡ä»¶è¯»å†™æ“ä½œè¯¦è§£](#3-æ–‡ä»¶è¯»å†™æ“ä½œè¯¦è§£)
4. [Here Documentä¸Here String](#4-here-documentä¸here-string)
5. [ç®¡é“æ•°æ®å¤„ç†ä¸ä¼ é€’](#5-ç®¡é“æ•°æ®å¤„ç†ä¸ä¼ é€’)
6. [ä¸´æ—¶æ–‡ä»¶åˆ›å»ºä¸æ¸…ç†](#6-ä¸´æ—¶æ–‡ä»¶åˆ›å»ºä¸æ¸…ç†)
7. [æ–‡ä»¶é”å®šæœºåˆ¶](#7-æ–‡ä»¶é”å®šæœºåˆ¶)
8. [æ ‡å‡†æµå¤„ç†æŠ€å·§](#8-æ ‡å‡†æµå¤„ç†æŠ€å·§)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ’¬ ç”¨æˆ·è¾“å…¥å¤„ç†ï¼ˆreadå‘½ä»¤ï¼‰


### 1.1 readå‘½ä»¤åŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯readå‘½ä»¤ï¼Ÿ**
readå‘½ä»¤æ˜¯Shellä¸­ä¸“é—¨ç”¨æ¥**æ¥æ”¶ç”¨æˆ·è¾“å…¥**çš„å·¥å…·ï¼Œå°±åƒç¨‹åºé—®ä½ é—®é¢˜ï¼Œç­‰ä½ å›ç­”ä¸€æ ·ã€‚

> ğŸ’¡ **é€šä¿—ç†è§£**ï¼šreadå°±æ˜¯è®©è„šæœ¬"åœä¸‹æ¥ç­‰ä½ è¯´è¯"ï¼Œä½ è¾“å…¥ä»€ä¹ˆï¼Œå®ƒå°±è®°ä½ä»€ä¹ˆ

### 1.2 åŸºç¡€ç”¨æ³•æ¨¡å¼


**æœ€ç®€å•çš„ç”¨æ³•**

```bash
#!/bin/bash
echo "è¯·è¾“å…¥ä½ çš„åå­—ï¼š"
read name
echo "ä½ å¥½ï¼Œ$nameï¼"
```

**è¿è¡Œæ•ˆæœæ¼”ç¤ºï¼š**
```
è¯·è¾“å…¥ä½ çš„åå­—ï¼š
å¼ ä¸‰                    â† ç”¨æˆ·è¾“å…¥
ä½ å¥½ï¼Œå¼ ä¸‰ï¼              â† è„šæœ¬è¾“å‡º
```

### 1.3 readå‘½ä»¤çš„å¸¸ç”¨é€‰é¡¹


| é€‰é¡¹ | **ä½œç”¨** | **åº”ç”¨åœºæ™¯** |
|------|---------|-------------|
| `-p` | `æç¤ºä¿¡æ¯ï¼Œè¾“å…¥åœ¨åŒä¸€è¡Œ` | `ç®€åŒ–äº¤äº’ç•Œé¢` |
| `-s` | `é™é»˜è¾“å…¥ï¼Œä¸æ˜¾ç¤ºå­—ç¬¦` | `å¯†ç è¾“å…¥` |
| `-t` | `è®¾ç½®è¶…æ—¶æ—¶é—´` | `è‡ªåŠ¨åŒ–è„šæœ¬` |
| `-n` | `é™åˆ¶è¾“å…¥å­—ç¬¦æ•°` | `ç¡®è®¤æ“ä½œï¼ˆy/nï¼‰` |

**å®é™…åº”ç”¨ç¤ºä¾‹ï¼š**

```bash
# å¯†ç è¾“å…¥ï¼ˆä¸æ˜¾ç¤ºå­—ç¬¦ï¼‰
read -s -p "è¯·è¾“å…¥å¯†ç ï¼š" password
echo  # æ¢è¡Œ

# è¶…æ—¶ç­‰å¾…ï¼ˆ5ç§’æ— è¾“å…¥è‡ªåŠ¨ç»§ç»­ï¼‰
if read -t 5 -p "5ç§’å†…è¾“å…¥ä»»æ„é”®ç»§ç»­..." input; then
    echo "ç”¨æˆ·è¾“å…¥äº†ï¼š$input"
else
    echo "è¶…æ—¶ï¼Œè‡ªåŠ¨ç»§ç»­æ‰§è¡Œ"
fi

# å•å­—ç¬¦ç¡®è®¤
read -n 1 -p "ç¡®è®¤åˆ é™¤ï¼Ÿ(y/n)ï¼š" confirm
echo
if [[ $confirm == "y" ]]; then
    echo "æ‰§è¡Œåˆ é™¤æ“ä½œ"
fi
```

### 1.4 å¤šå˜é‡è¾“å…¥å¤„ç†


**åŒæ—¶è¯»å–å¤šä¸ªå€¼ï¼š**

```bash
echo "è¯·è¾“å…¥å§“åå’Œå¹´é¾„ï¼ˆç©ºæ ¼åˆ†éš”ï¼‰ï¼š"
read name age
echo "å§“åï¼š$nameï¼Œå¹´é¾„ï¼š$age"
```

**è¾“å…¥å¤„ç†æµç¨‹å›¾ï¼š**
```
ç”¨æˆ·è¾“å…¥: "å¼ ä¸‰ 25"
         â†“
    æŒ‰ç©ºæ ¼åˆ†å‰²
         â†“
name="å¼ ä¸‰"  age="25"
```

### 1.5 è¾“å…¥éªŒè¯ä¸é”™è¯¯å¤„ç†


```bash
#!/bin/bash
# æ•°å­—è¾“å…¥éªŒè¯ç¤ºä¾‹
while true; do
    read -p "è¯·è¾“å…¥ä¸€ä¸ªæ­£æ•´æ•°ï¼š" number
    
    # éªŒè¯æ˜¯å¦ä¸ºæ•°å­—
    if [[ $number =~ ^[0-9]+$ ]]; then
        echo "è¾“å…¥æ­£ç¡®ï¼š$number"
        break
    else
        echo "âŒ é”™è¯¯ï¼šè¯·è¾“å…¥æœ‰æ•ˆçš„æ­£æ•´æ•°"
    fi
done
```

> âš ï¸ **æ³¨æ„**ï¼šç”¨æˆ·è¾“å…¥å¾€å¾€ä¸å¯é¢„æµ‹ï¼Œ**å¿…é¡»è¿›è¡ŒéªŒè¯**ï¼Œé¿å…è„šæœ¬å‡ºé”™

---

## 2. ğŸ“ æ ¼å¼åŒ–è¾“å‡ºæ§åˆ¶ï¼ˆprintfï¼‰


### 2.1 printf vs echoçš„åŒºåˆ«


**ä¸ºä»€ä¹ˆéœ€è¦printfï¼Ÿ**
- `echo`ï¼šç®€å•è¾“å‡ºï¼Œä½†**æ ¼å¼æ§åˆ¶æœ‰é™**
- `printf`ï¼š**ç²¾ç¡®æ ¼å¼æ§åˆ¶**ï¼Œç±»ä¼¼Cè¯­è¨€çš„printf

> ğŸ“– **æ¦‚å¿µ**ï¼šprintfè®©ä½ èƒ½åƒæ’ç‰ˆä¸€æ ·ç²¾ç¡®æ§åˆ¶è¾“å‡ºæ ¼å¼

### 2.2 printfåŸºæœ¬è¯­æ³•


**åŸºæœ¬æ ¼å¼ï¼š**
```bash
printf "æ ¼å¼å­—ç¬¦ä¸²" å‚æ•°1 å‚æ•°2 ...
```

**å¸¸ç”¨æ ¼å¼ç¬¦ï¼š**

| æ ¼å¼ç¬¦ | **å«ä¹‰** | **ç¤ºä¾‹** |
|--------|---------|---------|
| `%s` | `å­—ç¬¦ä¸²` | `printf "%s\n" "hello"` |
| `%d` | `æ•´æ•°` | `printf "%d\n" 123` |
| `%f` | `æµ®ç‚¹æ•°` | `printf "%.2f\n" 3.14159` |
| `%x` | `åå…­è¿›åˆ¶` | `printf "%x\n" 255` |

### 2.3 å®ç”¨æ ¼å¼æ§åˆ¶


**è¡¨æ ¼å¼è¾“å‡ºï¼š**
```bash
#!/bin/bash
printf "%-10s %-8s %s\n" "å§“å" "å¹´é¾„" "èŒä¸š"
printf "%-10s %-8s %s\n" "--------" "----" "--------"
printf "%-10s %-8d %s\n" "å¼ ä¸‰" 25 "ç¨‹åºå‘˜"
printf "%-10s %-8d %s\n" "æå››" 30 "è®¾è®¡å¸ˆ"
```

**è¾“å‡ºæ•ˆæœï¼š**
```
å§“å       å¹´é¾„     èŒä¸š
--------   ----     --------
å¼ ä¸‰       25       ç¨‹åºå‘˜
æå››       30       è®¾è®¡å¸ˆ
```

### 2.4 æ•°å­—æ ¼å¼åŒ–æŠ€å·§


```bash
# é‡‘é¢æ ¼å¼åŒ–ï¼ˆä¿ç•™2ä½å°æ•°ï¼‰
amount=1234.5
printf "é‡‘é¢ï¼šï¿¥%.2f\n" $amount  # è¾“å‡ºï¼šé‡‘é¢ï¼šï¿¥1234.50

# ç™¾åˆ†æ¯”æ˜¾ç¤º
percentage=0.856
printf "å®Œæˆç‡ï¼š%.1f%%\n" $(echo "$percentage * 100" | bc)
# è¾“å‡ºï¼šå®Œæˆç‡ï¼š85.6%

# è¡¥é›¶æ˜¾ç¤º
printf "ä»»åŠ¡ç¼–å·ï¼š%04d\n" 42  # è¾“å‡ºï¼šä»»åŠ¡ç¼–å·ï¼š0042
```

---

## 3. ğŸ“ æ–‡ä»¶è¯»å†™æ“ä½œè¯¦è§£


### 3.1 Shellä¸­çš„æ–‡ä»¶æ“ä½œæ¦‚å¿µ


**ä»€ä¹ˆæ˜¯æ–‡ä»¶è¯»å†™ï¼Ÿ**
åœ¨Shellè„šæœ¬ä¸­ï¼Œæ–‡ä»¶è¯»å†™å°±æ˜¯è®©ç¨‹åºèƒ½å¤Ÿ**è‡ªåŠ¨å¤„ç†æ–‡ä»¶å†…å®¹**ï¼Œä¸éœ€è¦äººå·¥æ‰“å¼€ç¼–è¾‘å™¨ã€‚

```
ç°å®åœºæ™¯ç±»æ¯”ï¼š
æ‰‹å·¥å¤„ç†ï¼šæ‰“å¼€Word â†’ æŸ¥çœ‹å†…å®¹ â†’ ç¼–è¾‘ â†’ ä¿å­˜
è„šæœ¬å¤„ç†ï¼šç¨‹åºç›´æ¥è¯»å– â†’ è‡ªåŠ¨å¤„ç† â†’ å†™å›æ–‡ä»¶
```

### 3.2 é‡å®šå‘æ“ä½œç¬¦è¯¦è§£


**é‡å®šå‘æ“ä½œç¬¦å«ä¹‰ï¼š**

| ç¬¦å· | **ä½œç”¨** | **é€šä¿—ç†è§£** |
|------|---------|-------------|
| `>` | `å†™å…¥æ–‡ä»¶ï¼ˆè¦†ç›–ï¼‰` | `æ¸…ç©ºåé‡æ–°å†™` |
| `>>` | `è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾` | `åœ¨åé¢æ¥ç€å†™` |
| `<` | `ä»æ–‡ä»¶è¯»å–` | `æŠŠæ–‡ä»¶å†…å®¹å–‚ç»™å‘½ä»¤` |

**åŸºç¡€æ–‡ä»¶å†™å…¥ï¼š**
```bash
# åˆ›å»ºæ–‡ä»¶å¹¶å†™å…¥å†…å®¹
echo "ç¬¬ä¸€è¡Œå†…å®¹" > output.txt

# è¿½åŠ å†…å®¹
echo "ç¬¬äºŒè¡Œå†…å®¹" >> output.txt

# å¤šè¡Œå†™å…¥
cat > config.txt << EOF
server=localhost
port=8080
timeout=30
EOF
```

### 3.3 execå‘½ä»¤è¿›è¡Œæ–‡ä»¶æè¿°ç¬¦æ“ä½œ


**ä»€ä¹ˆæ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼Ÿ**
æ–‡ä»¶æè¿°ç¬¦å°±åƒæ˜¯**æ–‡ä»¶çš„"ä»£å·"**ï¼Œç³»ç»Ÿç”¨æ•°å­—æ¥ä»£è¡¨æ‰“å¼€çš„æ–‡ä»¶ã€‚

```
æ ‡å‡†æ–‡ä»¶æè¿°ç¬¦ï¼š
0 â†’ æ ‡å‡†è¾“å…¥ï¼ˆé”®ç›˜ï¼‰
1 â†’ æ ‡å‡†è¾“å‡ºï¼ˆå±å¹•ï¼‰  
2 â†’ æ ‡å‡†é”™è¯¯ï¼ˆå±å¹•ï¼‰
3,4,5... â†’ è‡ªå®šä¹‰æ–‡ä»¶
```

**execå®ç”¨ç¤ºä¾‹ï¼š**
```bash
#!/bin/bash
# æ‰“å¼€æ–‡ä»¶ç”¨äºè¯»å†™
exec 3< input.txt    # æ–‡ä»¶æè¿°ç¬¦3ç”¨äºè¯»å–
exec 4> output.txt   # æ–‡ä»¶æè¿°ç¬¦4ç”¨äºå†™å…¥

# ä»æ–‡ä»¶æè¿°ç¬¦3è¯»å–
while read -u 3 line; do
    echo "å¤„ç†ï¼š$line" >&4  # å†™å…¥æ–‡ä»¶æè¿°ç¬¦4
done

# å…³é—­æ–‡ä»¶æè¿°ç¬¦
exec 3<&-
exec 4>&-
```

### 3.4 é€è¡Œæ–‡ä»¶å¤„ç†


**æœ€å¸¸ç”¨çš„æ–‡ä»¶è¯»å–æ¨¡å¼ï¼š**
```bash
#!/bin/bash
# é€è¡Œå¤„ç†æ—¥å¿—æ–‡ä»¶
while IFS= read -r line; do
    # æ£€æŸ¥æ˜¯å¦åŒ…å«ERROR
    if [[ $line == *"ERROR"* ]]; then
        echo "å‘ç°é”™è¯¯ï¼š$line"
    fi
done < /var/log/app.log
```

> ğŸ”§ **å®è·µæŠ€å·§**ï¼š`IFS= read -r`æ˜¯è¯»å–æ–‡ä»¶çš„**æ ‡å‡†å†™æ³•**ï¼Œä¿æŒåŸå§‹æ ¼å¼

---

## 4. ğŸ“„ Here Documentä¸Here String


### 4.1 Here DocumentåŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯Here Documentï¼Ÿ**
Here Documentæ˜¯ä¸€ç§ç‰¹æ®Šçš„è¾“å…¥æ–¹å¼ï¼Œå¯ä»¥**åœ¨è„šæœ¬ä¸­ç›´æ¥å†™å¤šè¡Œæ–‡æœ¬**ï¼Œå°±åƒåœ¨è„šæœ¬é‡Œ"åµŒå…¥"ä¸€ä¸ªæ–‡æ¡£ã€‚

> ğŸ’¡ **é€šä¿—ç†è§£**ï¼šä¸ç”¨åˆ›å»ºå•ç‹¬æ–‡ä»¶ï¼Œç›´æ¥åœ¨è„šæœ¬é‡Œå†™å¤§æ®µæ–‡å­—

### 4.2 Here Documentè¯­æ³•ç»“æ„


**åŸºæœ¬è¯­æ³•ï¼š**
```
å‘½ä»¤ << ç»“æŸæ ‡è®°
å¤šè¡Œå†…å®¹
å¤šè¡Œå†…å®¹
ç»“æŸæ ‡è®°
```

**å®ç”¨ç¤ºä¾‹ï¼š**
```bash
# åˆ›å»ºé…ç½®æ–‡ä»¶
cat << EOF > nginx.conf
server {
    listen 80;
    server_name example.com;
    
    location / {
        proxy_pass http://localhost:3000;
    }
}
EOF
```

### 4.3 Here Documentçš„å˜é‡å¤„ç†


**å˜é‡æ›¿æ¢ç¤ºä¾‹ï¼š**
```bash
#!/bin/bash
domain="mysite.com"
port=8080

# å˜é‡ä¼šè‡ªåŠ¨æ›¿æ¢
cat << EOF > dynamic_config.conf
# åŠ¨æ€ç”Ÿæˆçš„é…ç½®
server_name $domain;
listen $port;
root /var/www/$domain;
EOF
```

**é˜»æ­¢å˜é‡æ›¿æ¢ï¼š**
```bash
# ä½¿ç”¨å¼•å·é˜»æ­¢å˜é‡æ›¿æ¢
cat << 'EOF' > literal_config.conf
# è¿™é‡Œçš„$å˜é‡ä¸ä¼šè¢«æ›¿æ¢
server_name $domain;
listen $port;
EOF
```

### 4.4 Here Stringç®€æ´ç”¨æ³•


**Here Stringæ˜¯ä»€ä¹ˆï¼Ÿ**
Here Stringæ˜¯Here Documentçš„**ç®€åŒ–ç‰ˆæœ¬**ï¼Œé€‚åˆä¼ é€’å•è¡Œæˆ–ç®€çŸ­å†…å®¹ã€‚

```bash
# Here Stringè¯­æ³•ï¼šå‘½ä»¤ <<< "å†…å®¹"
read name age <<< "å¼ ä¸‰ 25"
echo "å§“åï¼š$nameï¼Œå¹´é¾„ï¼š$age"

# ç­‰ä»·äºï¼š
echo "å¼ ä¸‰ 25" | read name age
```

**å®ç”¨åœºæ™¯ç¤ºä¾‹ï¼š**
```bash
# å¿«é€Ÿæµ‹è¯•è„šæœ¬åŠŸèƒ½
bash <<< '
echo "å½“å‰æ—¶é—´ï¼š$(date)"
echo "å½“å‰ç”¨æˆ·ï¼š$(whoami)"
'
```

---

## 5. ğŸ”„ ç®¡é“æ•°æ®å¤„ç†ä¸ä¼ é€’


### 5.1 ç®¡é“çš„æœ¬è´¨æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯ç®¡é“ï¼Ÿ**
ç®¡é“å°±åƒæ˜¯**æ•°æ®çš„ä¼ é€å¸¦**ï¼ŒæŠŠä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºç›´æ¥é€ç»™ä¸‹ä¸€ä¸ªå‘½ä»¤ä½œä¸ºè¾“å…¥ã€‚

```
æ•°æ®æµå‘ç¤ºæ„ï¼š
å‘½ä»¤1 çš„è¾“å‡º â†’ | â†’ å‘½ä»¤2 çš„è¾“å…¥ â†’ | â†’ å‘½ä»¤3 çš„è¾“å…¥
```

> ğŸ“– **æ¦‚å¿µ**ï¼šç®¡é“è®©å¤šä¸ªç®€å•å‘½ä»¤**ç»„åˆæˆå¼ºå¤§åŠŸèƒ½**

### 5.2 ç®¡é“åŸºç¡€åº”ç”¨


**å¸¸è§ç®¡é“ç»„åˆï¼š**
```bash
# æŸ¥çœ‹æœ€å¤§çš„5ä¸ªæ–‡ä»¶
ls -la | sort -k5 -nr | head -5

# ç»Ÿè®¡æ—¥å¿—ä¸­çš„é”™è¯¯æ•°é‡
grep "ERROR" app.log | wc -l

# æŸ¥æ‰¾è¿›ç¨‹å¹¶æ€æ­»
ps aux | grep nginx | grep -v grep | awk '{print $2}' | xargs kill
```

**ç®¡é“å¤„ç†æµç¨‹å›¾ï¼š**
```
åŸå§‹æ•°æ® â†’ è¿‡æ»¤ â†’ æ’åº â†’ ç»Ÿè®¡ â†’ æœ€ç»ˆç»“æœ
  |        |      |      |        |
 cat    â†’ grep â†’ sort â†’ uniq â†’ wc -l
```

### 5.3 å¤æ‚ç®¡é“æ•°æ®å¤„ç†


**æ—¥å¿—åˆ†æå®ä¾‹ï¼š**
```bash
#!/bin/bash
# åˆ†æè®¿é—®æ—¥å¿—ï¼Œç»Ÿè®¡æœ€é¢‘ç¹çš„IP
cat access.log | \
awk '{print $1}' | \              # æå–IPåœ°å€
sort | \                          # æ’åº
uniq -c | \                       # ç»Ÿè®¡é‡å¤æ¬¡æ•°
sort -nr | \                      # æŒ‰æ¬¡æ•°å€’åº
head -10                          # å–å‰10å
```

### 5.4 ç®¡é“ä¸­çš„é”™è¯¯å¤„ç†


**ç®¡é“å¤±è´¥æ£€æµ‹ï¼š**
```bash
# æ£€æŸ¥ç®¡é“ä¸­ä»»ä½•å‘½ä»¤å¤±è´¥
set -o pipefail

if ! command1 | command2 | command3; then
    echo "ç®¡é“æ‰§è¡Œå¤±è´¥"
    exit 1
fi
```

> âš ï¸ **æ³¨æ„**ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œç®¡é“åªçœ‹æœ€åä¸€ä¸ªå‘½ä»¤çš„çŠ¶æ€ï¼Œ`set -o pipefail`è®©ä»»ä½•ç¯èŠ‚å¤±è´¥éƒ½è¢«æ£€æµ‹åˆ°

---

## 6. ğŸ—‚ï¸ ä¸´æ—¶æ–‡ä»¶åˆ›å»ºä¸æ¸…ç†


### 6.1 ä¸ºä»€ä¹ˆéœ€è¦ä¸´æ—¶æ–‡ä»¶


**ä¸´æ—¶æ–‡ä»¶çš„ä½œç”¨ï¼š**
- **ä¸­é—´æ•°æ®å­˜å‚¨**ï¼šå¤„ç†å¤§é‡æ•°æ®æ—¶çš„ç¼“å­˜
- **è¿›ç¨‹é—´é€šä¿¡**ï¼šä¸åŒè„šæœ¬ä¹‹é—´ä¼ é€’æ•°æ®
- **å¤‡ä»½æ“ä½œ**ï¼šä¿®æ”¹æ–‡ä»¶å‰çš„å®‰å…¨å¤‡ä»½

> ğŸ”§ **å®è·µ**ï¼šä¸´æ—¶æ–‡ä»¶å°±åƒè‰ç¨¿çº¸ï¼Œç”¨å®Œè¦è®°å¾—æ”¶æ‹¾å¹²å‡€

### 6.2 mktempå‘½ä»¤è¯¦è§£


**mktempæ˜¯ä»€ä¹ˆï¼Ÿ**
mktempæ˜¯ä¸“é—¨**å®‰å…¨åˆ›å»ºä¸´æ—¶æ–‡ä»¶**çš„å‘½ä»¤ï¼Œè‡ªåŠ¨ç”Ÿæˆå”¯ä¸€çš„æ–‡ä»¶åï¼Œé¿å…å†²çªã€‚

**åŸºæœ¬ç”¨æ³•ï¼š**
```bash
# åˆ›å»ºä¸´æ—¶æ–‡ä»¶
tmp_file=$(mktemp)
echo "ä¸´æ—¶æ–‡ä»¶è·¯å¾„ï¼š$tmp_file"

# åˆ›å»ºä¸´æ—¶ç›®å½•
tmp_dir=$(mktemp -d)
echo "ä¸´æ—¶ç›®å½•è·¯å¾„ï¼š$tmp_dir"

# æŒ‡å®šæ–‡ä»¶åæ¨¡æ¿
tmp_file=$(mktemp /tmp/myapp.XXXXXX)
```

**mktempé€‰é¡¹è¯´æ˜ï¼š**

| é€‰é¡¹ | **ä½œç”¨** | **ç¤ºä¾‹** |
|------|---------|---------|
| `-d` | `åˆ›å»ºä¸´æ—¶ç›®å½•` | `mktemp -d` |
| `-t` | `æŒ‡å®šæ¨¡æ¿å‰ç¼€` | `mktemp -t myapp` |
| `-u` | `åªç”Ÿæˆåå­—ï¼Œä¸åˆ›å»º` | `mktemp -u` |

### 6.3 ä¸´æ—¶æ–‡ä»¶æœ€ä½³å®è·µ


**å®Œæ•´çš„ä¸´æ—¶æ–‡ä»¶ä½¿ç”¨æ¨¡å¼ï¼š**
```bash
#!/bin/bash
# åˆ›å»ºä¸´æ—¶æ–‡ä»¶
tmp_file=$(mktemp) || {
    echo "åˆ›å»ºä¸´æ—¶æ–‡ä»¶å¤±è´¥"
    exit 1
}

# è®¾ç½®æ¸…ç†å‡½æ•°
cleanup() {
    echo "æ¸…ç†ä¸´æ—¶æ–‡ä»¶ï¼š$tmp_file"
    rm -f "$tmp_file"
}

# è„šæœ¬é€€å‡ºæ—¶è‡ªåŠ¨æ¸…ç†
trap cleanup EXIT

# ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶
echo "å¤„ç†ä¸­..." > "$tmp_file"
# ... å…¶ä»–æ“ä½œ ...

echo "ä¸´æ—¶æ–‡ä»¶å†…å®¹ï¼š$(cat $tmp_file)"
```

### 6.4 æ‰¹é‡ä¸´æ—¶æ–‡ä»¶ç®¡ç†


```bash
#!/bin/bash
# æ‰¹é‡å¤„ç†å¤šä¸ªæ–‡ä»¶
declare -a temp_files=()

# åˆ›å»ºå¤šä¸ªä¸´æ—¶æ–‡ä»¶çš„å‡½æ•°
create_temp() {
    local tmp_file=$(mktemp)
    temp_files+=("$tmp_file")
    echo "$tmp_file"
}

# æ¸…ç†æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶
cleanup_all() {
    for file in "${temp_files[@]}"; do
        [[ -f "$file" ]] && rm -f "$file"
    done
}

trap cleanup_all EXIT

# ä½¿ç”¨ç¤ºä¾‹
file1=$(create_temp)
file2=$(create_temp)
echo "æ•°æ®1" > "$file1"
echo "æ•°æ®2" > "$file2"
```

---

## 7. ğŸ” æ–‡ä»¶é”å®šæœºåˆ¶


### 7.1 æ–‡ä»¶é”çš„æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯æ–‡ä»¶é”ï¼Ÿ**
æ–‡ä»¶é”å°±åƒç»™æ–‡ä»¶åŠ æŠŠé”ï¼Œç¡®ä¿**åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªè¿›ç¨‹**èƒ½æ“ä½œæ–‡ä»¶ï¼Œé¿å…æ•°æ®å†²çªã€‚

```
æ— é”æƒ…å†µï¼š
è¿›ç¨‹A â”€â”€â”
        â”œâ”€â†’ åŒæ—¶å†™å…¥æ–‡ä»¶ â†’ æ•°æ®æ··ä¹±
è¿›ç¨‹B â”€â”€â”˜

æœ‰é”æƒ…å†µï¼š
è¿›ç¨‹A â†’ è·å¾—é” â†’ å†™å…¥ â†’ é‡Šæ”¾é”
                            â†“
è¿›ç¨‹B â†’ ç­‰å¾…é” â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ è·å¾—é” â†’ å†™å…¥
```

### 7.2 flockå‘½ä»¤ä½¿ç”¨


**flockåŸºæœ¬è¯­æ³•ï¼š**
```bash
flock [é€‰é¡¹] é”æ–‡ä»¶ å‘½ä»¤
```

**ç®€å•é”å®šç¤ºä¾‹ï¼š**
```bash
#!/bin/bash
# ç¡®ä¿è„šæœ¬åŒæ—¶åªèƒ½è¿è¡Œä¸€ä¸ªå®ä¾‹
exec 200>/var/lock/myscript.lock
if ! flock -n 200; then
    echo "è„šæœ¬å·²åœ¨è¿è¡Œä¸­"
    exit 1
fi

echo "å¼€å§‹æ‰§è¡Œç‹¬å æ“ä½œ..."
sleep 10
echo "æ“ä½œå®Œæˆ"
```

### 7.3 ä¸åŒç±»å‹çš„é”


**é”çš„ç±»å‹ï¼š**

| é”ç±»å‹ | **ç‰¹ç‚¹** | **ä½¿ç”¨åœºæ™¯** |
|--------|---------|-------------|
| **æ’ä»–é”** | `ç‹¬å è®¿é—®` | `å†™å…¥æ“ä½œ` |
| **å…±äº«é”** | `å¤šä¸ªè¯»å–ï¼Œç¦æ­¢å†™å…¥` | `è¯»å–æ“ä½œ` |

```bash
# æ’ä»–é”ï¼ˆå†™é”ï¼‰
flock -x 200  # æˆ–è€… flock -e 200

# å…±äº«é”ï¼ˆè¯»é”ï¼‰  
flock -s 200
```

### 7.4 å®ç”¨é”å®šæ¨¡å¼


**æ—¥å¿—æ–‡ä»¶å®‰å…¨å†™å…¥ï¼š**
```bash
#!/bin/bash
log_file="/var/log/myapp.log"
lock_file="/var/lock/myapp.log.lock"

# å®‰å…¨å†™å…¥æ—¥å¿—
write_log() {
    local message="$1"
    local timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    
    # ä½¿ç”¨æ’ä»–é”ä¿æŠ¤å†™å…¥
    (
        flock -x 200
        echo "[$timestamp] $message" >> "$log_file"
    ) 200>"$lock_file"
}

# ä½¿ç”¨ç¤ºä¾‹
write_log "åº”ç”¨å¯åŠ¨"
write_log "å¤„ç†è¯·æ±‚"
```

**é…ç½®æ–‡ä»¶å®‰å…¨æ›´æ–°ï¼š**
```bash
#!/bin/bash
config_file="/etc/myapp.conf"

# å®‰å…¨æ›´æ–°é…ç½®
update_config() {
    local key="$1"
    local value="$2"
    local temp_file=$(mktemp)
    
    (
        flock -x 200
        # è¯»å–ç°æœ‰é…ç½®ï¼Œæ›´æ–°æŒ‡å®šé¡¹
        while IFS='=' read -r k v; do
            if [[ "$k" == "$key" ]]; then
                echo "$key=$value"
            else
                echo "$k=$v"
            fi
        done < "$config_file" > "$temp_file"
        
        # åŸå­æ›¿æ¢
        mv "$temp_file" "$config_file"
        
    ) 200>"$config_file.lock"
}
```

---

## 8. ğŸ”€ æ ‡å‡†æµå¤„ç†æŠ€å·§


### 8.1 æ ‡å‡†æµçš„æ¦‚å¿µ


**ä¸‰ä¸ªæ ‡å‡†æµï¼š**
```
æ ‡å‡†è¾“å…¥(stdin)  â†’ æ–‡ä»¶æè¿°ç¬¦ 0 â†’ é»˜è®¤æ¥è‡ªé”®ç›˜
æ ‡å‡†è¾“å‡º(stdout) â†’ æ–‡ä»¶æè¿°ç¬¦ 1 â†’ é»˜è®¤è¾“å‡ºåˆ°å±å¹•
æ ‡å‡†é”™è¯¯(stderr) â†’ æ–‡ä»¶æè¿°ç¬¦ 2 â†’ é»˜è®¤è¾“å‡ºåˆ°å±å¹•
```

> ğŸ“– **æ¦‚å¿µ**ï¼šç†è§£æ ‡å‡†æµæ˜¯æŒæ¡Shellè¾“å…¥è¾“å‡ºçš„åŸºç¡€

### 8.2 é‡å®šå‘é«˜çº§æŠ€å·§


**å¸¸ç”¨é‡å®šå‘æ¨¡å¼ï¼š**
```bash
# æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯åˆ†åˆ«å¤„ç†
command > output.txt 2> error.txt

# æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯åˆå¹¶
command > all_output.txt 2>&1

# é™é»˜æ‰§è¡Œï¼ˆä¸¢å¼ƒæ‰€æœ‰è¾“å‡ºï¼‰
command > /dev/null 2>&1

# åªä¿ç•™é”™è¯¯ä¿¡æ¯
command 2>&1 >/dev/null
```

### 8.3 æµå¤„ç†å®ç”¨æŠ€å·§


**é”™è¯¯æ—¥å¿—åˆ†ç¦»ï¼š**
```bash
#!/bin/bash
# å°†æ­£å¸¸è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºåˆ†å¼€å¤„ç†
run_backup() {
    backup_command \
        > >(while read line; do echo "[INFO] $line"; done) \
        2> >(while read line; do echo "[ERROR] $line" >&2; done)
}
```

**å¤šé‡è¾“å‡ºï¼š**
```bash
# åŒæ—¶è¾“å‡ºåˆ°å±å¹•å’Œæ–‡ä»¶
echo "é‡è¦ä¿¡æ¯" | tee important.log

# åŒæ—¶è¾“å‡ºåˆ°å¤šä¸ªæ–‡ä»¶
echo "ç³»ç»ŸçŠ¶æ€" | tee status.log | tee backup_status.log
```

### 8.4 è¿›ç¨‹æ›¿æ¢æŠ€å·§


**ä»€ä¹ˆæ˜¯è¿›ç¨‹æ›¿æ¢ï¼Ÿ**
è¿›ç¨‹æ›¿æ¢è®©ä½ å¯ä»¥æŠŠ**å‘½ä»¤çš„è¾“å‡ºå½“ä½œæ–‡ä»¶**æ¥ä½¿ç”¨ã€‚

```bash
# æ¯”è¾ƒä¸¤ä¸ªå‘½ä»¤çš„è¾“å‡º
diff <(ls /dir1) <(ls /dir2)

# åŒæ—¶å¤„ç†å¤šä¸ªæ•°æ®æº
paste <(cut -d: -f1 /etc/passwd) <(cut -d: -f3 /etc/passwd)
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ readå‘½ä»¤ï¼šç”¨æˆ·äº¤äº’çš„åŸºç¡€ï¼ŒæŒæ¡é€‰é¡¹ä½¿ç”¨
ğŸ”¸ printfæ ¼å¼åŒ–ï¼šç²¾ç¡®æ§åˆ¶è¾“å‡ºæ ¼å¼çš„å·¥å…·
ğŸ”¸ æ–‡ä»¶é‡å®šå‘ï¼šShellè„šæœ¬å¤„ç†æ–‡ä»¶çš„æ ¸å¿ƒæœºåˆ¶
ğŸ”¸ Here Documentï¼šåœ¨è„šæœ¬ä¸­åµŒå…¥å¤šè¡Œæ–‡æœ¬çš„æ–¹æ³•
ğŸ”¸ ç®¡é“æ“ä½œï¼šç»„åˆå‘½ä»¤å®ç°å¤æ‚åŠŸèƒ½çš„å…³é”®
ğŸ”¸ ä¸´æ—¶æ–‡ä»¶ï¼šmktempåˆ›å»ºï¼Œtrapæ¸…ç†çš„æ ‡å‡†æ¨¡å¼
ğŸ”¸ æ–‡ä»¶é”ï¼šflockä¿è¯è¿›ç¨‹å®‰å…¨çš„é‡è¦æœºåˆ¶
ğŸ”¸ æ ‡å‡†æµï¼šç†è§£stdin/stdout/stderrçš„é‡å®šå‘
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ è¾“å…¥è¾“å‡ºçš„æœ¬è´¨**
```
Shellè„šæœ¬çš„æ ¸å¿ƒå°±æ˜¯æ•°æ®å¤„ç†ï¼š
è¾“å…¥ â†’ å¤„ç† â†’ è¾“å‡º
æŒæ¡å„ç§è¾“å…¥è¾“å‡ºæ–¹å¼ï¼Œå°±æŒæ¡äº†Shellçš„ç²¾é«“
```

**ğŸ”¹ å®‰å…¨ç¼–ç¨‹å®è·µ**
```
æ–‡ä»¶æ“ä½œå®‰å…¨åŸåˆ™ï¼š
- ä½¿ç”¨mktempåˆ›å»ºä¸´æ—¶æ–‡ä»¶
- ç”¨trapç¡®ä¿æ¸…ç†
- ç”¨flocké¿å…ç«äº‰æ¡ä»¶
- éªŒè¯ç”¨æˆ·è¾“å…¥
```

**ğŸ”¹ æ•ˆç‡ä¼˜åŒ–æ€è·¯**
```
ç»„åˆä½¿ç”¨æŠ€å·§ï¼š
- ç®¡é“è¿æ¥å¤šä¸ªç®€å•å‘½ä»¤
- é‡å®šå‘é¿å…ä¸´æ—¶æ–‡ä»¶
- Here Documentå‡å°‘æ–‡ä»¶åˆ›å»º
- printfæ›¿ä»£å¤šæ¬¡echo
```

### 9.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ å¸¸è§åº”ç”¨åœºæ™¯**
- **äº¤äº’å¼è„šæœ¬**ï¼šç”¨readè·å–ç”¨æˆ·è¾“å…¥ï¼Œprintfæ ¼å¼åŒ–æ˜¾ç¤º
- **æ—¥å¿—å¤„ç†**ï¼šç®¡é“ç»„åˆå‘½ä»¤åˆ†æå¤§é‡æ—¥å¿—æ•°æ®
- **é…ç½®ç®¡ç†**ï¼šHere Documentç”Ÿæˆé…ç½®æ–‡ä»¶
- **æ•°æ®å¤‡ä»½**ï¼šæ–‡ä»¶é”ç¡®ä¿å¤‡ä»½è¿‡ç¨‹ä¸å†²çª
- **ç³»ç»Ÿç›‘æ§**ï¼šé‡å®šå‘æ”¶é›†ç³»ç»Ÿä¿¡æ¯åˆ°æ–‡ä»¶

**ğŸ”§ æœ€ä½³å®è·µæ€»ç»“**
- äº¤äº’è¾“å…¥è¦**éªŒè¯å’Œå®¹é”™**
- æ–‡ä»¶æ“ä½œè¦**å®‰å…¨å’Œæ¸…ç†**
- æ•°æ®å¤„ç†è¦**ç®¡é“å’Œé‡å®šå‘**
- å¹¶å‘è®¿é—®è¦**åŠ é”ä¿æŠ¤**

> ğŸ’¡ **æ ¸å¿ƒè®°å¿†**ï¼šShellè¾“å…¥è¾“å‡ºæ“ä½œçš„æ ¸å¿ƒæ˜¯**å®‰å…¨ã€é«˜æ•ˆã€å¯é **åœ°å¤„ç†æ•°æ®æµï¼Œç†Ÿç»ƒæŒæ¡è¿™äº›æŠ€å·§èƒ½è®©ä½ çš„è„šæœ¬æ›´åŠ ä¸“ä¸šå’Œå¥å£®ã€‚

**å­¦ä¹ è·¯å¾„å»ºè®®ï¼š**
- **åŸºç¡€**ï¼šå…ˆç†Ÿç»ƒreadå’Œprintfçš„åŸºæœ¬ç”¨æ³•
- **è¿›é˜¶**ï¼šæŒæ¡é‡å®šå‘å’Œç®¡é“çš„ç»„åˆä½¿ç”¨  
- **é«˜çº§**ï¼šå­¦ä¹ æ–‡ä»¶é”å’Œä¸´æ—¶æ–‡ä»¶çš„å®‰å…¨å¤„ç†
- **å®æˆ˜**ï¼šç»“åˆå®é™…éœ€æ±‚ç»¼åˆè¿ç”¨å„ç§æŠ€å·§