---
title: 9ã€Exporteréƒ¨ç½²ä¸é›†æˆ
---
## ğŸ“š ç›®å½•

1. [ExporteråŸºç¡€æ¦‚å¿µä¸æ¶æ„](#1-ExporteråŸºç¡€æ¦‚å¿µä¸æ¶æ„)
2. [Node Exporterç³»ç»Ÿç›‘æ§](#2-Node-Exporterç³»ç»Ÿç›‘æ§)
3. [Blackbox Exporterç½‘ç»œæ¢æµ‹](#3-Blackbox-Exporterç½‘ç»œæ¢æµ‹)
4. [æ•°æ®åº“ç›‘æ§Exporter](#4-æ•°æ®åº“ç›‘æ§Exporter)
5. [ä¸­é—´ä»¶ç›‘æ§é›†æˆ](#5-ä¸­é—´ä»¶ç›‘æ§é›†æˆ)
6. [WebæœåŠ¡ç›‘æ§æ–¹æ¡ˆ](#6-WebæœåŠ¡ç›‘æ§æ–¹æ¡ˆ)
7. [è‡ªå®šä¹‰Exporterå¼€å‘](#7-è‡ªå®šä¹‰Exporterå¼€å‘)
8. [å®¹å™¨ä¸Kubernetesç›‘æ§](#8-å®¹å™¨ä¸Kubernetesç›‘æ§)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”Œ ExporteråŸºç¡€æ¦‚å¿µä¸æ¶æ„


### 1.1 ä»€ä¹ˆæ˜¯Exporter


**Exporter**å°±æ˜¯Prometheusç”Ÿæ€ä¸­çš„"æ•°æ®æ”¶é›†å‘˜"ï¼Œä¸“é—¨è´Ÿè´£ä»å„ç§ç³»ç»Ÿä¸­æ”¶é›†ç›‘æ§æŒ‡æ ‡ï¼Œç„¶åè½¬æ¢æˆPrometheusèƒ½ç†è§£çš„æ ¼å¼ã€‚

> **ğŸ’¡ æ ¸å¿ƒç†è§£**
> Exporter = ç¿»è¯‘å®˜ + æ•°æ®æ”¶é›†å™¨ï¼ŒæŠŠä¸åŒç³»ç»Ÿçš„ç›‘æ§æ•°æ®ç¿»è¯‘æˆPrometheusæ ‡å‡†æ ¼å¼

**ğŸ”¸ å·¥ä½œåŸç†å›¾ç¤ºï¼š**
```
ç›‘æ§ç›®æ ‡ç³»ç»Ÿ          Exporter           Prometheus
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MySQL     â”‚â”€â”€â”€â”€â†’ â”‚MySQL     â”‚â†â”€â”€â”€â”€â”€â”‚ Prometheus  â”‚
â”‚   Redis     â”‚      â”‚Exporter  â”‚      â”‚   Server    â”‚
â”‚   Nginx     â”‚      â”‚          â”‚      â”‚             â”‚
â”‚   Linux     â”‚      â”‚          â”‚      â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   åŸå§‹æ•°æ®            æ ‡å‡†æŒ‡æ ‡            å­˜å‚¨åˆ†æ
```

### 1.2 Exporteråˆ†ç±»ä¸é€‰æ‹©


**ğŸ“Š æŒ‰ç›‘æ§å¯¹è±¡åˆ†ç±»ï¼š**

| ç±»å‹ | **ä»£è¡¨äº§å“** | **ä¸»è¦ç›‘æ§å†…å®¹** | **ä½¿ç”¨åœºæ™¯** |
|------|-------------|-----------------|-------------|
| ğŸ–¥ï¸ **ç³»ç»Ÿçº§** | Node Exporter | CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œ | åŸºç¡€è®¾æ–½ç›‘æ§ |
| ğŸŒ **ç½‘ç»œçº§** | Blackbox Exporter | HTTPã€TCPã€ICMPæ¢æµ‹ | æœåŠ¡å¯ç”¨æ€§æ£€æµ‹ |
| ğŸ’¾ **æ•°æ®åº“** | MySQL Exporter | è¿æ¥æ•°ã€æŸ¥è¯¢æ€§èƒ½ã€å¤åˆ¶çŠ¶æ€ | æ•°æ®åº“è¿è¡ŒçŠ¶æ€ |
| âš™ï¸ **åº”ç”¨çº§** | JMX Exporter | JVMæŒ‡æ ‡ã€ä¸šåŠ¡æŒ‡æ ‡ | Javaåº”ç”¨ç›‘æ§ |
| ğŸ“¦ **å®¹å™¨çº§** | cAdvisor | å®¹å™¨èµ„æºä½¿ç”¨ã€æ€§èƒ½æŒ‡æ ‡ | å®¹å™¨ç¯å¢ƒç›‘æ§ |

### 1.3 éƒ¨ç½²æ¶æ„æ¨¡å¼


**ğŸ—ï¸ å¸¸è§éƒ¨ç½²æ¨¡å¼ï¼š**
```
ç›´æ¥éƒ¨ç½²æ¨¡å¼ï¼š
Prometheus â†’ Exporter â†’ Target System

ä»£ç†æ¨¡å¼ï¼š
Prometheus â†’ Exporter â†’ Multiple Target Systems

æ¨é€æ¨¡å¼ï¼š
Target System â†’ Pushgateway â†’ Prometheus
```

---

## 2. ğŸ–¥ï¸ Node Exporterç³»ç»Ÿç›‘æ§


### 2.1 Node ExporteråŸºç¡€éƒ¨ç½²


**Node Exporter**æ˜¯ç›‘æ§Linux/Unixç³»ç»Ÿèµ„æºçš„æ ‡å‡†å·¥å…·ï¼Œå°±åƒç³»ç»Ÿçš„"ä½“æ£€åŒ»ç”Ÿ"ã€‚

**âš¡ å¿«é€Ÿå®‰è£…ï¼š**
```bash
# ä¸‹è½½å¹¶å®‰è£…
wget https://github.com/prometheus/node_exporter/releases/download/v1.6.1/node_exporter-1.6.1.linux-amd64.tar.gz
tar xzf node_exporter-1.6.1.linux-amd64.tar.gz
sudo cp node_exporter-1.6.1.linux-amd64/node_exporter /usr/local/bin/

# åˆ›å»ºç³»ç»ŸæœåŠ¡
sudo tee /etc/systemd/system/node-exporter.service << EOF
[Unit]
Description=Node Exporter
After=network.target

[Service]
Type=simple
ExecStart=/usr/local/bin/node_exporter
Restart=on-failure

[Install]
WantedBy=multi-user.target
EOF

# å¯åŠ¨æœåŠ¡
sudo systemctl daemon-reload
sudo systemctl enable --now node-exporter
```

### 2.2 æ ¸å¿ƒç›‘æ§æŒ‡æ ‡


**ğŸ”¸ ç³»ç»Ÿèµ„æºç›‘æ§ç»´åº¦ï¼š**
```
CPUä½¿ç”¨ç‡ç›‘æ§ï¼š
node_cpu_seconds_total - CPUæ—¶é—´ç»Ÿè®¡
rate(node_cpu_seconds_total[5m]) - CPUä½¿ç”¨ç‡

å†…å­˜ä½¿ç”¨ç›‘æ§ï¼š
node_memory_MemTotal_bytes - æ€»å†…å­˜
node_memory_MemAvailable_bytes - å¯ç”¨å†…å­˜

ç£ç›˜ç©ºé—´ç›‘æ§ï¼š
node_filesystem_size_bytes - ç£ç›˜æ€»å®¹é‡
node_filesystem_free_bytes - ç£ç›˜å‰©ä½™ç©ºé—´

ç½‘ç»œæµé‡ç›‘æ§ï¼š
node_network_receive_bytes_total - æ¥æ”¶å­—èŠ‚æ•°
node_network_transmit_bytes_total - å‘é€å­—èŠ‚æ•°
```

### 2.3 é«˜çº§é…ç½®é€‰é¡¹


**ğŸ”§ è‡ªå®šä¹‰æ”¶é›†å™¨é…ç½®ï¼š**
```bash
# å¯ç”¨ç‰¹å®šæ”¶é›†å™¨
node_exporter --collector.systemd --collector.processes

# ç¦ç”¨ä¸éœ€è¦çš„æ”¶é›†å™¨
node_exporter --no-collector.hwmon --no-collector.nfs

# æ–‡æœ¬æ–‡ä»¶æ”¶é›†å™¨ï¼ˆè‡ªå®šä¹‰æŒ‡æ ‡ï¼‰
node_exporter --collector.textfile.directory=/var/lib/node_exporter/textfiles
```

**ğŸ“ è‡ªå®šä¹‰æŒ‡æ ‡ç¤ºä¾‹ï¼š**
```bash
# åˆ›å»ºè‡ªå®šä¹‰æŒ‡æ ‡æ–‡ä»¶
echo 'custom_metric{job="my_job"} 42' > /var/lib/node_exporter/textfiles/custom.prom
```

---

## 3. ğŸŒ Blackbox Exporterç½‘ç»œæ¢æµ‹


### 3.1 Blackbox Exporteréƒ¨ç½²é…ç½®


**Blackbox Exporter**ä¸“é—¨ç”¨äº"é»‘ç›’ç›‘æ§"ï¼Œå°±åƒç½‘ç»œæ¢æµ‹å™¨ï¼Œæ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚

**ğŸ”§ åŸºç¡€é…ç½®æ–‡ä»¶ï¼š**
```yaml
# blackbox.yml
modules:
  http_2xx:
    prober: http
    timeout: 5s
    http:
      valid_http_versions: ["HTTP/1.1", "HTTP/2.0"]
      valid_status_codes: []  # é»˜è®¤2xxä¸ºæˆåŠŸ
      method: GET
      
  tcp_connect:
    prober: tcp
    timeout: 5s
    
  icmp:
    prober: icmp
    timeout: 5s
    
  dns:
    prober: dns
    timeout: 5s
    dns:
      query_name: "example.com"
      query_type: "A"
```

### 3.2 æœåŠ¡å¯ç”¨æ€§æ£€æµ‹


**ğŸ¯ å®é™…ç›‘æ§åœºæ™¯ï¼š**

**HTTPæœåŠ¡æ£€æµ‹ï¼š**
```yaml
# prometheus.ymlé…ç½®
- job_name: 'blackbox-http'
  metrics_path: /probe
  params:
    module: [http_2xx]
  static_configs:
    - targets:
      - https://www.google.com
      - https://www.github.com
      - http://internal-api.company.com
  relabel_configs:
    - source_labels: [__address__]
      target_label: __param_target
    - source_labels: [__param_target]
      target_label: instance
    - target_label: __address__
      replacement: blackbox-exporter:9115
```

**æ•°æ®åº“è¿æ¥æ£€æµ‹ï¼š**
```yaml
# æ£€æµ‹MySQLç«¯å£è¿é€šæ€§
tcp_mysql:
  prober: tcp
  timeout: 5s
  tcp:
    query_response:
      - expect: "^.*(mysql|MariaDB).*"
```

### 3.3 SSLè¯ä¹¦ç›‘æ§


**ğŸ”’ HTTPSè¯ä¹¦æ£€æµ‹ï¼š**
```yaml
http_ssl:
  prober: http
  timeout: 5s
  http:
    method: GET
    valid_status_codes: []
    fail_if_ssl: false
    fail_if_not_ssl: true
    tls_config:
      insecure_skip_verify: false
```

**âš ï¸ å‘Šè­¦è§„åˆ™ç¤ºä¾‹ï¼š**
```yaml
# è¯ä¹¦å³å°†è¿‡æœŸå‘Šè­¦
- alert: SSLCertExpiringSoon
  expr: probe_ssl_earliest_cert_expiry - time() < 86400 * 30
  for: 5m
  labels:
    severity: warning
  annotations:
    summary: "SSLè¯ä¹¦å°†åœ¨30å¤©å†…è¿‡æœŸ"
    description: "{{ $labels.instance }}çš„SSLè¯ä¹¦å°†åœ¨{{ $value | humanizeDuration }}åè¿‡æœŸ"
```

---

## 4. ğŸ’¾ æ•°æ®åº“ç›‘æ§Exporter


### 4.1 MySQLç›‘æ§é›†æˆ


**MySQL Exporter**ä¸“é—¨ç›‘æ§MySQLæ•°æ®åº“çš„è¿è¡ŒçŠ¶æ€å’Œæ€§èƒ½æŒ‡æ ‡ã€‚

**âš¡ éƒ¨ç½²é…ç½®ï¼š**
```bash
# åˆ›å»ºç›‘æ§ç”¨æˆ·
mysql -u root -p << 'EOF'
CREATE USER 'exporter'@'localhost' IDENTIFIED BY 'password';
GRANT PROCESS, REPLICATION CLIENT, SELECT ON *.* TO 'exporter'@'localhost';
FLUSH PRIVILEGES;
EOF

# é…ç½®è¿æ¥ä¿¡æ¯
export DATA_SOURCE_NAME='exporter:password@(localhost:3306)/'

# å¯åŠ¨MySQL Exporter
./mysqld_exporter --config.my-cnf=/etc/mysql-exporter/.my.cnf
```

**ğŸ” å…³é”®ç›‘æ§æŒ‡æ ‡ï¼š**
```
è¿æ¥çŠ¶æ€ï¼š
mysql_global_status_threads_connected - å½“å‰è¿æ¥æ•°
mysql_global_status_max_used_connections - æœ€å¤§è¿æ¥æ•°

æŸ¥è¯¢æ€§èƒ½ï¼š
mysql_global_status_queries - æŸ¥è¯¢æ€»æ•°
mysql_global_status_slow_queries - æ…¢æŸ¥è¯¢æ•°

å¤åˆ¶çŠ¶æ€ï¼š
mysql_slave_lag_seconds - ä¸»ä»å»¶è¿Ÿ
mysql_slave_sql_running - SQLçº¿ç¨‹çŠ¶æ€
```

### 4.2 PostgreSQLç›‘æ§


**ğŸ“Š postgres_exporteré…ç½®ï¼š**
```yaml
# è¿æ¥é…ç½®
export DATA_SOURCE_NAME="postgresql://username:password@localhost:5432/postgres?sslmode=disable"

# è‡ªå®šä¹‰æŸ¥è¯¢é…ç½®
queries:
  - name: pg_database
    query: "SELECT datname, pg_database_size(datname) as size FROM pg_database"
    metrics:
      - datname:
          usage: "LABEL"
          description: "Name of the database"
      - size:
          usage: "GAUGE"
          description: "Size of the database in bytes"
```

---

## 5. âš™ï¸ ä¸­é—´ä»¶ç›‘æ§é›†æˆ


### 5.1 Redisç›‘æ§é…ç½®


**Redis Exporter**ç›‘æ§Redisç¼“å­˜æœåŠ¡çš„æ€§èƒ½å’Œä½¿ç”¨æƒ…å†µã€‚

**ğŸ”§ åŸºç¡€é…ç½®ï¼š**
```bash
# Rediså¯†ç è®¤è¯
export REDIS_ADDR=redis://localhost:6379
export REDIS_PASSWORD=your_password

# å¯åŠ¨Redis Exporter
./redis_exporter --redis.addr=redis://localhost:6379 --redis.password=secret
```

**ğŸ“ˆ æ ¸å¿ƒæŒ‡æ ‡è¯´æ˜ï¼š**
```
å†…å­˜ä½¿ç”¨ï¼š
redis_memory_used_bytes - å·²ä½¿ç”¨å†…å­˜
redis_memory_max_bytes - æœ€å¤§å†…å­˜é™åˆ¶

è¿æ¥çŠ¶æ€ï¼š
redis_connected_clients - å½“å‰è¿æ¥å®¢æˆ·ç«¯æ•°
redis_rejected_connections_total - è¢«æ‹’ç»çš„è¿æ¥æ•°

é”®å€¼ç»Ÿè®¡ï¼š
redis_db_keys - æ•°æ®åº“é”®æ•°é‡
redis_db_keys_expiring - å³å°†è¿‡æœŸçš„é”®æ•°é‡

æ€§èƒ½æŒ‡æ ‡ï¼š
redis_commands_processed_total - å¤„ç†çš„å‘½ä»¤æ€»æ•°
redis_keyspace_hits_total - é”®ç©ºé—´å‘½ä¸­æ¬¡æ•°
```

### 5.2 MongoDBç›‘æ§é›†æˆ


**ğŸ—„ï¸ MongoDBç›‘æ§è¦ç‚¹ï¼š**
```yaml
# mongodb_exporterå¯åŠ¨å‚æ•°
--mongodb.uri=mongodb://username:password@mongodb1.example.com:27017
--collect-all
--compatible-mode
```

**å…³é”®ä¸šåŠ¡æŒ‡æ ‡ï¼š**
- è¿æ¥æ± çŠ¶æ€ç›‘æ§
- å¤åˆ¶é›†å»¶è¿Ÿç›‘æ§  
- ç´¢å¼•ä½¿ç”¨æ•ˆç‡ç›‘æ§
- æ…¢æŸ¥è¯¢ç»Ÿè®¡ç›‘æ§

---

## 6. ğŸŒ WebæœåŠ¡ç›‘æ§æ–¹æ¡ˆ


### 6.1 Nginxç›‘æ§é›†æˆ


**Nginxç›‘æ§**é€šè¿‡stub_statusæ¨¡å—æä¾›åŸºç¡€æŒ‡æ ‡ã€‚

**âš¡ Nginxé…ç½®ï¼š**
```nginx
# å¯ç”¨çŠ¶æ€é¡µé¢
server {
    listen 8080;
    server_name localhost;
    
    location /nginx_status {
        stub_status on;
        access_log off;
        allow 127.0.0.1;
        deny all;
    }
}
```

**ğŸ“Š nginx-prometheus-exporteréƒ¨ç½²ï¼š**
```bash
# å¯åŠ¨Nginx Exporter
./nginx-prometheus-exporter -nginx.scrape-uri=http://localhost:8080/nginx_status
```

**ğŸ”¸ ç›‘æ§æŒ‡æ ‡å«ä¹‰ï¼š**
```
nginx_connections_active - å½“å‰æ´»è·ƒè¿æ¥æ•°
nginx_connections_accepted - å·²æ¥å—è¿æ¥æ€»æ•°
nginx_connections_handled - å·²å¤„ç†è¿æ¥æ€»æ•°
nginx_http_requests_total - HTTPè¯·æ±‚æ€»æ•°
```

### 6.2 Apacheç›‘æ§é…ç½®


**ğŸ”§ Apache mod_statusé…ç½®ï¼š**
```apache
# å¯ç”¨çŠ¶æ€æ¨¡å—
LoadModule status_module modules/mod_status.so

<Location "/server-status">
    SetHandler server-status
    Require local
</Location>

<Location "/server-info">
    SetHandler server-info
    Require local
</Location>
```

---

## 7. ğŸ› ï¸ è‡ªå®šä¹‰Exporterå¼€å‘


### 7.1 å¼€å‘åŸºç¡€æ¦‚å¿µ


**è‡ªå®šä¹‰Exporter**ç”¨äºç›‘æ§ç‰¹æ®Šä¸šåŠ¡é€»è¾‘æˆ–ç¬¬ä¸‰æ–¹ç³»ç»Ÿï¼Œéœ€è¦è‡ªå·±ç¼–å†™é‡‡é›†ç¨‹åºã€‚

> **ğŸ’¡ æ ¸å¿ƒç†è§£**
> è‡ªå®šä¹‰Exporter = ä¸šåŠ¡é€»è¾‘ + PrometheusæŒ‡æ ‡æ ¼å¼ï¼ŒæŠŠä¸šåŠ¡æ•°æ®è½¬æ¢ä¸ºç›‘æ§æŒ‡æ ‡

### 7.2 Pythonå¼€å‘ç¤ºä¾‹


**ğŸ”§ ç®€å•çš„ä¸šåŠ¡ç›‘æ§Exporterï¼š**
```python
from prometheus_client import start_http_server, Gauge, Counter
import time
import psutil

# å®šä¹‰æŒ‡æ ‡
cpu_usage = Gauge('system_cpu_usage_percent', 'CPUä½¿ç”¨ç‡')
memory_usage = Gauge('system_memory_usage_percent', 'å†…å­˜ä½¿ç”¨ç‡')
request_count = Counter('business_requests_total', 'ä¸šåŠ¡è¯·æ±‚æ€»æ•°')

def collect_metrics():
    """æ”¶é›†ç³»ç»ŸæŒ‡æ ‡"""
    while True:
        # æ”¶é›†CPUä½¿ç”¨ç‡
        cpu_percent = psutil.cpu_percent(interval=1)
        cpu_usage.set(cpu_percent)
        
        # æ”¶é›†å†…å­˜ä½¿ç”¨ç‡
        memory = psutil.virtual_memory()
        memory_usage.set(memory.percent)
        
        # æ¨¡æ‹Ÿä¸šåŠ¡æŒ‡æ ‡
        request_count.inc()
        
        time.sleep(30)

if __name__ == '__main__':
    # å¯åŠ¨HTTPæœåŠ¡å™¨
    start_http_server(8000)
    print("Exporterå¯åŠ¨åœ¨ç«¯å£8000")
    
    # å¼€å§‹æ”¶é›†æŒ‡æ ‡
    collect_metrics()
```

### 7.3 æŒ‡æ ‡ç±»å‹é€‰æ‹©


**ğŸ“‹ PrometheusæŒ‡æ ‡ç±»å‹ï¼š**

| æŒ‡æ ‡ç±»å‹ | **ç‰¹ç‚¹** | **é€‚ç”¨åœºæ™¯** | **ç¤ºä¾‹** |
|---------|----------|-------------|----------|
| `Counter` | åªèƒ½é€’å¢ | ç´¯è®¡è®¡æ•° | HTTPè¯·æ±‚æ•°ã€é”™è¯¯æ¬¡æ•° |
| `Gauge` | å¯å¢å¯å‡ | ç¬æ—¶å€¼ | CPUä½¿ç”¨ç‡ã€å†…å­˜ä½¿ç”¨é‡ |
| `Histogram` | åˆ†å¸ƒç»Ÿè®¡ | å“åº”æ—¶é—´åˆ†å¸ƒ | æ¥å£è€—æ—¶ã€è¯·æ±‚å¤§å° |
| `Summary` | åˆ†ä½æ•°ç»Ÿè®¡ | ç™¾åˆ†ä½æ•° | 95%å“åº”æ—¶é—´ |

---

## 8. ğŸ“¦ å®¹å™¨ä¸Kubernetesç›‘æ§


### 8.1 å®¹å™¨ç›‘æ§æ¶æ„


**ğŸ—ï¸ å®¹å™¨ç›‘æ§ç»„ä»¶ï¼š**
```
Kubernetesé›†ç¾¤ç›‘æ§æ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Prometheus    â”‚    â”‚  Grafana        â”‚
â”‚                 â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  kube-state-    â”‚    â”‚  node-exporter  â”‚
â”‚  metrics        â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Kubernetes API Server          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 JMX Exporter Javaåº”ç”¨ç›‘æ§


**â˜• Javaåº”ç”¨ç›‘æ§é…ç½®ï¼š**
```yaml
# jmx_exporteré…ç½®
startDelaySeconds: 0
hostPort: 127.0.0.1:1234
username: 
password: 

rules:
  # JVMå†…å­˜ç›‘æ§
  - pattern: "java.lang<type=Memory><>HeapMemoryUsage"
    name: jvm_memory_heap_used
    type: GAUGE
    
  # GCç›‘æ§
  - pattern: "java.lang<type=GarbageCollector, name=(.*)><>CollectionCount"
    name: jvm_gc_collection_seconds_count
    labels:
      gc: "$1"
```

**ğŸš€ å¯åŠ¨Javaåº”ç”¨ï¼š**
```bash
java -javaagent:jmx_prometheus_javaagent-0.17.2.jar=8080:config.yaml \
     -jar your-application.jar
```

### 8.3 Kubernetesç›‘æ§é›†æˆ


**âš¡ å…³é”®ç›‘æ§ç»„ä»¶éƒ¨ç½²ï¼š**

**kube-state-metricsé…ç½®ï¼š**
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: kube-state-metrics
spec:
  replicas: 1
  template:
    spec:
      containers:
      - name: kube-state-metrics
        image: k8s.gcr.io/kube-state-metrics/kube-state-metrics:v2.6.0
        ports:
        - containerPort: 8080
        - containerPort: 8081
```

**ğŸ”¸ æ ¸å¿ƒç›‘æ§æŒ‡æ ‡ï¼š**
```
PodçŠ¶æ€ç›‘æ§ï¼š
kube_pod_status_phase - Podè¿è¡ŒçŠ¶æ€
kube_pod_container_restarts_total - å®¹å™¨é‡å¯æ¬¡æ•°

èµ„æºä½¿ç”¨ç›‘æ§ï¼š
container_cpu_usage_seconds_total - CPUä½¿ç”¨æ—¶é—´
container_memory_usage_bytes - å†…å­˜ä½¿ç”¨é‡

æœåŠ¡å¯ç”¨æ€§ï¼š
kube_service_status_load_balancer_ingress - æœåŠ¡è´Ÿè½½å‡è¡¡çŠ¶æ€
kube_deployment_status_replicas_available - å¯ç”¨å‰¯æœ¬æ•°
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ Exporterä½œç”¨ï¼šæ•°æ®æ”¶é›†å™¨ + æ ¼å¼è½¬æ¢å™¨
ğŸ”¸ éƒ¨ç½²æ¨¡å¼ï¼šç›´æ¥éƒ¨ç½²ã€ä»£ç†æ¨¡å¼ã€æ¨é€æ¨¡å¼
ğŸ”¸ ç›‘æ§åˆ†å±‚ï¼šç³»ç»Ÿçº§ã€åº”ç”¨çº§ã€ä¸šåŠ¡çº§ç›‘æ§
ğŸ”¸ æŒ‡æ ‡é€‰æ‹©ï¼šCounterã€Gaugeã€Histogramã€Summaryå››ç§ç±»å‹
ğŸ”¸ é›†æˆæ–¹å¼ï¼šåŸç”Ÿæ”¯æŒã€ç¬¬ä¸‰æ–¹Exporterã€è‡ªå®šä¹‰å¼€å‘
```

### 9.2 å®é™…éƒ¨ç½²è¦ç‚¹


**ğŸ”¹ é€‰æ‹©ç­–ç•¥ï¼š**
```
ç³»ç»Ÿç›‘æ§ â†’ Node Exporterï¼ˆå¿…è£…ï¼‰
æœåŠ¡å¯ç”¨æ€§ â†’ Blackbox Exporter
æ•°æ®åº“ç›‘æ§ â†’ å¯¹åº”ä¸“ç”¨Exporter
ä¸šåŠ¡ç›‘æ§ â†’ è‡ªå®šä¹‰å¼€å‘
å®¹å™¨ç›‘æ§ â†’ Kubernetesç”Ÿæ€ç»„ä»¶
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–ï¼š**
```
âœ… åˆç†è®¾ç½®é‡‡é›†é—´éš”ï¼Œé¿å…è¿‡äºé¢‘ç¹
âœ… é€‰æ‹©å¿…è¦æŒ‡æ ‡ï¼Œé¿å…ç›‘æ§æ•°æ®çˆ†ç‚¸
âœ… ä½¿ç”¨æ ‡ç­¾åˆ†ç»„ï¼Œä¾¿äºæŸ¥è¯¢å’Œå‘Šè­¦
âœ… é…ç½®åˆç†çš„è¶…æ—¶æ—¶é—´ï¼Œé¿å…ç›‘æ§é˜»å¡
```

### 9.3 å¸¸è§é—®é¢˜å¤„ç†


**âš ï¸ é—®é¢˜æ’æŸ¥è¦ç‚¹ï¼š**
```
è¿æ¥é—®é¢˜ï¼š
- æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
- éªŒè¯ç«¯å£å¼€æ”¾çŠ¶æ€
- ç¡®è®¤è®¤è¯ä¿¡æ¯æ­£ç¡®

æ•°æ®é—®é¢˜ï¼š
- ç¡®è®¤æŒ‡æ ‡å‘½åè§„èŒƒ
- æ£€æŸ¥æ ‡ç­¾ä¸€è‡´æ€§
- éªŒè¯æ•°æ®ç±»å‹åŒ¹é…

æ€§èƒ½é—®é¢˜ï¼š
- ç›‘æ§Exporterè‡ªèº«èµ„æºæ¶ˆè€—
- ä¼˜åŒ–æŸ¥è¯¢é¢‘ç‡å’Œå¤æ‚åº¦
- è€ƒè™‘ä½¿ç”¨Pushgatewayç¼“è§£å‹åŠ›
```

### 9.4 æœ€ä½³å®è·µå»ºè®®


**ğŸ¯ éƒ¨ç½²å»ºè®®ï¼š**
- **åˆ†å±‚ç›‘æ§**ï¼šåŸºç¡€è®¾æ–½ â†’ ä¸­é—´ä»¶ â†’ åº”ç”¨ â†’ ä¸šåŠ¡
- **æ ‡å‡†åŒ–é…ç½®**ï¼šç»Ÿä¸€å‘½åè§„èŒƒï¼Œä¾¿äºç»´æŠ¤
- **è‡ªåŠ¨åŒ–éƒ¨ç½²**ï¼šä½¿ç”¨é…ç½®ç®¡ç†å·¥å…·æ‰¹é‡éƒ¨ç½²
- **ç›‘æ§è¦†ç›–**ï¼šç¡®ä¿å…³é”®ç»„ä»¶éƒ½æœ‰ç›‘æ§è¦†ç›–

**ğŸ’¡ è®°å¿†è¦ç‚¹**ï¼š
Exporterç”Ÿæ€ä¸°å¯Œå¤šæ ·ï¼Œå…³é”®æ˜¯é€‰æ‹©åˆé€‚çš„å·¥å…·ç›‘æ§åˆé€‚çš„å¯¹è±¡ã€‚æŒæ¡Node Exporterå’ŒBlackbox Exporterå¯ä»¥è§£å†³å¤§éƒ¨åˆ†ç›‘æ§éœ€æ±‚ï¼Œç‰¹æ®Šéœ€æ±‚é€šè¿‡è‡ªå®šä¹‰å¼€å‘è§£å†³ã€‚é‡ç‚¹æ˜¯ç†è§£ç›‘æ§æŒ‡æ ‡çš„å«ä¹‰å’Œå‘Šè­¦ç­–ç•¥çš„è®¾è®¡ã€‚