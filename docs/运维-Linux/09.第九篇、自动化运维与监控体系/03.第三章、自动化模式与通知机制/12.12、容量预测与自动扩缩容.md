---
title: 12ã€å®¹é‡é¢„æµ‹ä¸è‡ªåŠ¨æ‰©ç¼©å®¹
---
## ğŸ“š ç›®å½•

1. [å®¹é‡é¢„æµ‹åŸºç¡€](#1-å®¹é‡é¢„æµ‹åŸºç¡€)
2. [èµ„æºä½¿ç”¨è¶‹åŠ¿åˆ†æ](#2-èµ„æºä½¿ç”¨è¶‹åŠ¿åˆ†æ)
3. [å®¹é‡é¢„æµ‹ç®—æ³•å®ç°](#3-å®¹é‡é¢„æµ‹ç®—æ³•å®ç°)
4. [è‡ªåŠ¨æ‰©ç¼©å®¹æœºåˆ¶](#4-è‡ªåŠ¨æ‰©ç¼©å®¹æœºåˆ¶)
5. [å¼¹æ€§ä¼¸ç¼©è§„åˆ™é…ç½®](#5-å¼¹æ€§ä¼¸ç¼©è§„åˆ™é…ç½®)
6. [æˆæœ¬ä¼˜åŒ–ç­–ç•¥](#6-æˆæœ¬ä¼˜åŒ–ç­–ç•¥)
7. [å®¹é‡è§„åˆ’ä¸æŠ¥å‘Š](#7-å®¹é‡è§„åˆ’ä¸æŠ¥å‘Š)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”® å®¹é‡é¢„æµ‹åŸºç¡€


### 1.1 ä»€ä¹ˆæ˜¯å®¹é‡é¢„æµ‹


**å®¹é‡é¢„æµ‹**å°±æ˜¯æå‰é¢„åˆ¤ç³»ç»Ÿæœªæ¥éœ€è¦å¤šå°‘èµ„æºã€‚å°±åƒå¤©æ°”é¢„æŠ¥ä¸€æ ·ï¼Œæˆ‘ä»¬æ ¹æ®å†å²æ•°æ®å’Œå½“å‰è¶‹åŠ¿ï¼Œæ¨æµ‹æ˜å¤©ã€ä¸‹å‘¨ç”šè‡³ä¸‹ä¸ªæœˆç³»ç»Ÿä¼šéœ€è¦å¤šå°‘CPUã€å†…å­˜ã€å­˜å‚¨ç©ºé—´ã€‚

> **ğŸ’¡ ç”Ÿæ´»ç±»æ¯”**
> å°±åƒé¤å…è€æ¿æ ¹æ®å¾€å¹´æ•°æ®é¢„æµ‹æ˜¥èŠ‚æœŸé—´éœ€è¦å‡†å¤‡å¤šå°‘é£Ÿæä¸€æ ·ï¼ŒITè¿ç»´éœ€è¦é¢„æµ‹ä¸šåŠ¡é«˜å³°æœŸéœ€è¦å‡†å¤‡å¤šå°‘æœåŠ¡å™¨èµ„æºã€‚

**ä¸ºä»€ä¹ˆè¦åšå®¹é‡é¢„æµ‹ï¼Ÿ**
```
ä¸šåŠ¡åœºæ™¯ä¸¾ä¾‹ï¼š
â€¢ ç”µå•†åŒ11ï¼šæµé‡æš´å¢10å€ï¼Œéœ€æå‰æ‰©å®¹
â€¢ è§†é¢‘ç½‘ç«™ï¼šçƒ­é—¨å‰§é›†ä¸Šçº¿ï¼Œå¸¦å®½éœ€æ±‚æ¿€å¢  
â€¢ æ¸¸æˆæœåŠ¡ï¼šæ–°ç‰ˆæœ¬å‘å¸ƒï¼ŒåŒæ—¶åœ¨çº¿ç”¨æˆ·ç¿»å€
â€¢ ä¼ä¸šåº”ç”¨ï¼šæœˆæœ«æŠ¥è¡¨ç”Ÿæˆï¼Œè®¡ç®—èµ„æºç´§å¼ 

æå‰é¢„æµ‹çš„å¥½å¤„ï¼š
âœ… é¿å…ç³»ç»Ÿå´©æºƒï¼Œä¿è¯ç”¨æˆ·ä½“éªŒ
âœ… åˆç†é‡‡è´­èµ„æºï¼Œé¿å…æµªè´¹
âœ… åˆ¶å®šåº”æ€¥é¢„æ¡ˆï¼Œé™ä½é£é™©
âœ… ä¼˜åŒ–æˆæœ¬æ”¯å‡ºï¼Œæé«˜æ•ˆç‡
```

### 1.2 å®¹é‡é¢„æµ‹çš„æ ¸å¿ƒè¦ç´ 


**ğŸ“Š éœ€è¦å…³æ³¨çš„å…³é”®æŒ‡æ ‡**

**CPUä½¿ç”¨ç‡**ï¼š
- **å«ä¹‰**ï¼šå¤„ç†å™¨å¿™ç¢Œç¨‹åº¦çš„ç™¾åˆ†æ¯”
- **æ­£å¸¸èŒƒå›´**ï¼šé•¿æœŸå¹³å‡åº”æ§åˆ¶åœ¨70%ä»¥ä¸‹
- **é¢„è­¦é˜ˆå€¼**ï¼šæŒç»­è¶…è¿‡85%éœ€è¦æ‰©å®¹

**å†…å­˜ä½¿ç”¨ç‡**ï¼š
- **å«ä¹‰**ï¼šå·²ç”¨å†…å­˜å æ€»å†…å­˜çš„æ¯”ä¾‹  
- **æ­£å¸¸èŒƒå›´**ï¼šåº”ä¿æŒåœ¨80%ä»¥ä¸‹
- **é¢„è­¦é˜ˆå€¼**ï¼šè¶…è¿‡90%å¯èƒ½è§¦å‘ç³»ç»Ÿäº¤æ¢

**ç£ç›˜IO**ï¼š
- **å«ä¹‰**ï¼šç£ç›˜è¯»å†™æ“ä½œçš„é¢‘ç¹ç¨‹åº¦
- **å…³é”®æŒ‡æ ‡**ï¼šIOPSï¼ˆæ¯ç§’è¾“å…¥/è¾“å‡ºæ“ä½œæ•°ï¼‰ã€å“åº”æ—¶é—´
- **é¢„è­¦æ ‡å‡†**ï¼šå¹³å‡å“åº”æ—¶é—´è¶…è¿‡10mséœ€å…³æ³¨

**ç½‘ç»œå¸¦å®½**ï¼š
- **å«ä¹‰**ï¼šç½‘ç»œä¼ è¾“æ•°æ®çš„èƒ½åŠ›
- **ç›‘æ§é‡ç‚¹**ï¼šå…¥ç«™/å‡ºç«™æµé‡ã€ä¸¢åŒ…ç‡
- **æ‰©å®¹æ ‡å‡†**ï¼šå³°å€¼ä½¿ç”¨ç‡è¶…è¿‡80%

---

## 2. ğŸ“ˆ èµ„æºä½¿ç”¨è¶‹åŠ¿åˆ†æ


### 2.1 æ•°æ®æ”¶é›†ä¸å­˜å‚¨


**ç›‘æ§æ•°æ®çš„æ”¶é›†æ–¹å¼**

Linuxç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ä¸»è¦é€šè¿‡ä»¥ä¸‹å·¥å…·æ”¶é›†èµ„æºä½¿ç”¨æ•°æ®ï¼š

```bash
# CPUä½¿ç”¨ç‡æ”¶é›†
sar -u 1 60    # æ¯ç§’é‡‡é›†ä¸€æ¬¡ï¼ŒæŒç»­60ç§’

# å†…å­˜ä½¿ç”¨æƒ…å†µ  
free -m -s 5   # æ¯5ç§’æ˜¾ç¤ºä¸€æ¬¡å†…å­˜çŠ¶æ€

# ç£ç›˜IOç›‘æ§
iostat -x 1    # æ¯ç§’æ˜¾ç¤ºè¯¦ç»†IOç»Ÿè®¡

# ç½‘ç»œæµé‡ç»Ÿè®¡
sar -n DEV 1   # æ¯ç§’æ˜¾ç¤ºç½‘ç»œæ¥å£æµé‡
```

> **ğŸ“Œ é‡è¦æé†’**
> æ•°æ®é‡‡é›†é¢‘ç‡è¦åˆç†ï¼šå¤ªé¢‘ç¹æµªè´¹èµ„æºï¼Œå¤ªç¨€ç–ä¸¢å¤±å…³é”®ä¿¡æ¯ã€‚ä¸€èˆ¬å»ºè®®1-5åˆ†é’Ÿé‡‡é›†ä¸€æ¬¡ã€‚

### 2.2 è¶‹åŠ¿è¯†åˆ«æ¨¡å¼


**ğŸ“Š å¸¸è§çš„èµ„æºä½¿ç”¨æ¨¡å¼**

**å‘¨æœŸæ€§æ¨¡å¼**ï¼š
```
å·¥ä½œæ—¥æ¨¡å¼ï¼š
  å‘¨ä¸€ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 80%
  å‘¨äºŒ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘ 70%  
  å‘¨ä¸‰ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 80%
  å‘¨å›› â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘ 90%
  å‘¨äº” â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 60%
  å‘¨å…­ â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘ 30%
  å‘¨æ—¥ â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 20%

æ¯æ—¥æ¨¡å¼ï¼š
00:00-06:00  â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 20% (å¤œé—´ä½è°·)
06:00-09:00  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘ 70% (æ—©é«˜å³°)
09:00-12:00  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘ 90% (ä¸Šåˆé«˜å³°)
12:00-14:00  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 60% (åˆä¼‘ä¸‹é™)
14:00-18:00  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 80% (ä¸‹åˆé«˜å³°)
18:00-24:00  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘ 50% (æ™šé—´ä¸‹é™)
```

**å¢é•¿æ€§è¶‹åŠ¿**ï¼š
- **çº¿æ€§å¢é•¿**ï¼šæ¯æœˆç”¨æˆ·å¢é•¿5%ï¼Œèµ„æºéœ€æ±‚ç›¸åº”å¢é•¿
- **æŒ‡æ•°å¢é•¿**ï¼šç—…æ¯’å¼ä¼ æ’­ï¼Œèµ„æºéœ€æ±‚å¿«é€Ÿç¿»å€
- **é˜¶æ¢¯å¢é•¿**ï¼šæ–°åŠŸèƒ½ä¸Šçº¿ï¼Œä½¿ç”¨é‡çªç„¶è·³è·ƒ

**å­£èŠ‚æ€§æ³¢åŠ¨**ï¼š
- **ç”µå•†ç³»ç»Ÿ**ï¼šè´­ç‰©èŠ‚æœŸé—´æµé‡æ¿€å¢
- **æ•™è‚²å¹³å°**ï¼šå¼€å­¦å­£ã€è€ƒè¯•å­£ä½¿ç”¨é«˜å³°
- **æ¸¸æˆæœåŠ¡**ï¼šèŠ‚å‡æ—¥åœ¨çº¿äººæ•°ç¿»å€

### 2.3 å¼‚å¸¸æ£€æµ‹æ–¹æ³•


**è¯†åˆ«å¼‚å¸¸ä½¿ç”¨æ¨¡å¼**

```bash
# ç®€å•çš„å¼‚å¸¸æ£€æµ‹è„šæœ¬ç¤ºä¾‹
#!/bin/bash

# è·å–å½“å‰CPUä½¿ç”¨ç‡
cpu_usage=$(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1)

# è®¾ç½®æ­£å¸¸èŒƒå›´
normal_min=10
normal_max=80

# æ£€æµ‹å¼‚å¸¸
if [ $(echo "$cpu_usage < $normal_min" | bc) -eq 1 ]; then
    echo "è­¦å‘Šï¼šCPUä½¿ç”¨ç‡å¼‚å¸¸åä½ ($cpu_usage%)"
elif [ $(echo "$cpu_usage > $normal_max" | bc) -eq 1 ]; then
    echo "è­¦å‘Šï¼šCPUä½¿ç”¨ç‡å¼‚å¸¸åé«˜ ($cpu_usage%)"
else
    echo "CPUä½¿ç”¨ç‡æ­£å¸¸ ($cpu_usage%)"
fi
```

---

## 3. ğŸ§® å®¹é‡é¢„æµ‹ç®—æ³•å®ç°


### 3.1 ç®€å•é¢„æµ‹æ–¹æ³•


**ç§»åŠ¨å¹³å‡æ³•**ï¼šæœ€å®¹æ˜“ç†è§£çš„é¢„æµ‹æ–¹æ³•

> **ğŸ’­ ç”Ÿæ´»ç±»æ¯”**
> å°±åƒé¢„æµ‹æ˜å¤©çš„ä½“é‡ï¼Œä½ å¯ä»¥çœ‹è¿‡å»7å¤©çš„å¹³å‡ä½“é‡ä½œä¸ºå‚è€ƒã€‚ç§»åŠ¨å¹³å‡æ³•å°±æ˜¯ç”¨æœ€è¿‘å‡ å¤©çš„å¹³å‡å€¼æ¥é¢„æµ‹æœªæ¥ã€‚

```python
# ç®€å•ç§»åŠ¨å¹³å‡é¢„æµ‹
def simple_moving_average(data, window_size=7):
    """
    è®¡ç®—ç§»åŠ¨å¹³å‡å€¼è¿›è¡Œé¢„æµ‹
    data: å†å²æ•°æ®åˆ—è¡¨
    window_size: çª—å£å¤§å°ï¼ˆé»˜è®¤7å¤©ï¼‰
    """
    if len(data) < window_size:
        return sum(data) / len(data)
    
    # å–æœ€è¿‘window_sizeä¸ªæ•°æ®ç‚¹çš„å¹³å‡å€¼
    recent_data = data[-window_size:]
    return sum(recent_data) / len(recent_data)

# ä½¿ç”¨ç¤ºä¾‹
cpu_usage_history = [65, 70, 68, 72, 69, 71, 73, 75, 74, 76]
predicted_cpu = simple_moving_average(cpu_usage_history, 5)
print(f"é¢„æµ‹æ˜å¤©CPUä½¿ç”¨ç‡: {predicted_cpu:.1f}%")
```

**çº¿æ€§è¶‹åŠ¿é¢„æµ‹**ï¼šè€ƒè™‘å¢é•¿è¶‹åŠ¿çš„æ–¹æ³•

```python
# çº¿æ€§è¶‹åŠ¿é¢„æµ‹
def linear_trend_prediction(data, days_ahead=1):
    """
    åŸºäºçº¿æ€§è¶‹åŠ¿é¢„æµ‹æœªæ¥å€¼
    """
    import numpy as np
    
    # åˆ›å»ºæ—¶é—´åºåˆ—
    x = np.arange(len(data))
    y = np.array(data)
    
    # è®¡ç®—çº¿æ€§è¶‹åŠ¿
    slope = np.sum((x - np.mean(x)) * (y - np.mean(y))) / np.sum((x - np.mean(x))**2)
    intercept = np.mean(y) - slope * np.mean(x)
    
    # é¢„æµ‹æœªæ¥å€¼
    future_x = len(data) + days_ahead - 1
    prediction = slope * future_x + intercept
    
    return max(0, prediction)  # ç¡®ä¿é¢„æµ‹å€¼ä¸ä¸ºè´Ÿ

# ä½¿ç”¨ç¤ºä¾‹  
memory_usage = [45, 47, 48, 50, 52, 53, 55, 56, 58, 60]
predicted_memory = linear_trend_prediction(memory_usage, 3)
print(f"é¢„æµ‹3å¤©åå†…å­˜ä½¿ç”¨ç‡: {predicted_memory:.1f}%")
```

### 3.2 é«˜çº§é¢„æµ‹ç®—æ³•


**æŒ‡æ•°å¹³æ»‘æ³•**ï¼šå¯¹è¿‘æœŸæ•°æ®ç»™äºˆæ›´é«˜æƒé‡

> **ğŸ” æ·±å…¥ç†è§£**
> æŒ‡æ•°å¹³æ»‘æ³•è®¤ä¸ºè¶Šè¿‘çš„æ•°æ®è¶Šé‡è¦ï¼Œå°±åƒäººçš„è®°å¿†ä¸€æ ·ï¼Œæ˜¨å¤©çš„äº‹æ¯”ä¸€ä¸ªæœˆå‰çš„äº‹å¯¹ä»Šå¤©çš„åˆ¤æ–­å½±å“æ›´å¤§ã€‚

```python
def exponential_smoothing(data, alpha=0.3):
    """
    æŒ‡æ•°å¹³æ»‘é¢„æµ‹
    alpha: å¹³æ»‘å‚æ•°ï¼Œ0-1ä¹‹é—´ï¼Œå€¼è¶Šå¤§è¶Šé‡è§†è¿‘æœŸæ•°æ®
    """
    if not data:
        return 0
    
    # åˆå§‹åŒ–
    smoothed = [data[0]]
    
    # è®¡ç®—å¹³æ»‘å€¼
    for i in range(1, len(data)):
        smoothed_value = alpha * data[i] + (1 - alpha) * smoothed[i-1]
        smoothed.append(smoothed_value)
    
    # è¿”å›é¢„æµ‹å€¼ï¼ˆä¸‹ä¸€æœŸçš„å¹³æ»‘å€¼ï¼‰
    return smoothed[-1]
```

### 3.3 é¢„æµ‹å‡†ç¡®æ€§è¯„ä¼°


**å¦‚ä½•åˆ¤æ–­é¢„æµ‹ç®—æ³•çš„å¥½åï¼Ÿ**

```python
def calculate_accuracy_metrics(actual, predicted):
    """
    è®¡ç®—é¢„æµ‹å‡†ç¡®æ€§æŒ‡æ ‡
    """
    import numpy as np
    
    # å¹³å‡ç»å¯¹è¯¯å·®(MAE)
    mae = np.mean(np.abs(np.array(actual) - np.array(predicted)))
    
    # å‡æ–¹æ ¹è¯¯å·®(RMSE)  
    rmse = np.sqrt(np.mean((np.array(actual) - np.array(predicted))**2))
    
    # å¹³å‡ç»å¯¹ç™¾åˆ†æ¯”è¯¯å·®(MAPE)
    mape = np.mean(np.abs((np.array(actual) - np.array(predicted)) / np.array(actual))) * 100
    
    return {
        'MAE': mae,
        'RMSE': rmse, 
        'MAPE': mape
    }

# é¢„æµ‹è´¨é‡è¯„åˆ¤æ ‡å‡†
# MAPE < 10%: ä¼˜ç§€é¢„æµ‹
# MAPE 10-20%: è‰¯å¥½é¢„æµ‹  
# MAPE 20-30%: å¯æ¥å—é¢„æµ‹
# MAPE > 30%: é¢„æµ‹ç²¾åº¦è¾ƒå·®
```

---

## 4. âš¡ è‡ªåŠ¨æ‰©ç¼©å®¹æœºåˆ¶


### 4.1 æ‰©å®¹è§¦å‘æ¡ä»¶è®¾è®¡


**ä»€ä¹ˆæ—¶å€™éœ€è¦è‡ªåŠ¨æ‰©å®¹ï¼Ÿ**

è‡ªåŠ¨æ‰©å®¹å°±åƒæ±½è½¦çš„è‡ªåŠ¨æŒ¡ï¼Œå½“æ£€æµ‹åˆ°"ä¸Šå¡"ï¼ˆè´Ÿè½½å¢åŠ ï¼‰æ—¶ï¼Œè‡ªåŠ¨"æ¢åˆ°ä½æ¡£ä½"ï¼ˆå¢åŠ èµ„æºï¼‰æ¥ä¿æŒæ€§èƒ½ã€‚

```bash
# æ‰©å®¹è§¦å‘æ¡ä»¶é…ç½®ç¤ºä¾‹
# /etc/autoscale.conf

[CPU_RULES]
# CPUä½¿ç”¨ç‡æŒç»­5åˆ†é’Ÿè¶…è¿‡80%è§¦å‘æ‰©å®¹
cpu_threshold_high=80
cpu_duration=300
cpu_scale_out=true

[MEMORY_RULES]  
# å†…å­˜ä½¿ç”¨ç‡è¶…è¿‡85%è§¦å‘æ‰©å®¹
memory_threshold_high=85
memory_duration=180
memory_scale_out=true

[RESPONSE_TIME_RULES]
# APIå“åº”æ—¶é—´è¶…è¿‡500msè§¦å‘æ‰©å®¹
response_time_threshold=500
response_time_duration=120
```

**ğŸ“Š å¤šç»´åº¦è§¦å‘ç­–ç•¥**

| ç›‘æ§æŒ‡æ ‡ | æ‰©å®¹é˜ˆå€¼ | æŒç»­æ—¶é—´ | æ‰©å®¹ç­–ç•¥ |
|---------|----------|----------|----------|
| **CPUä½¿ç”¨ç‡** | `> 80%` | `5åˆ†é’Ÿ` | `å¢åŠ 2ä¸ªå®ä¾‹` |
| **å†…å­˜ä½¿ç”¨ç‡** | `> 85%` | `3åˆ†é’Ÿ` | `å¢åŠ 1ä¸ªå®ä¾‹` |
| **è¯·æ±‚é˜Ÿåˆ—é•¿åº¦** | `> 100` | `2åˆ†é’Ÿ` | `å¢åŠ 3ä¸ªå®ä¾‹` |
| **å“åº”æ—¶é—´** | `> 500ms` | `1åˆ†é’Ÿ` | `ç´§æ€¥æ‰©å®¹` |

### 4.2 ç¼©å®¹å®‰å…¨ç­–ç•¥


**ä»€ä¹ˆæ—¶å€™å¯ä»¥å®‰å…¨ç¼©å®¹ï¼Ÿ**

ç¼©å®¹æ¯”æ‰©å®¹æ›´å±é™©ï¼Œå°±åƒå¼€è½¦ä¸‹å¡è¸©åˆ¹è½¦ï¼Œéœ€è¦æ›´è°¨æ…ã€‚

```python
# ç¼©å®¹å®‰å…¨æ£€æŸ¥
def safe_to_scale_down(metrics):
    """
    æ£€æŸ¥æ˜¯å¦å¯ä»¥å®‰å…¨ç¼©å®¹
    """
    checks = {
        'cpu_low': metrics['cpu_usage'] < 30,           # CPUä½¿ç”¨ç‡ä½
        'memory_low': metrics['memory_usage'] < 50,     # å†…å­˜ä½¿ç”¨ç‡ä½
        'stable_period': metrics['stable_minutes'] > 15, # ç¨³å®šæœŸè¶…è¿‡15åˆ†é’Ÿ
        'no_peak_hour': not is_peak_hour(),            # éé«˜å³°æ—¶æ®µ
        'min_instances': metrics['current_instances'] > metrics['min_instances'] # ä¿ç•™æœ€å°‘å®ä¾‹æ•°
    }
    
    # æ‰€æœ‰æ¡ä»¶éƒ½æ»¡è¶³æ‰èƒ½ç¼©å®¹
    return all(checks.values())

def is_peak_hour():
    """åˆ¤æ–­æ˜¯å¦ä¸ºä¸šåŠ¡é«˜å³°æœŸ"""
    from datetime import datetime
    hour = datetime.now().hour
    # å‡è®¾9-18ç‚¹ä¸ºé«˜å³°æœŸï¼Œä¸å…è®¸ç¼©å®¹
    return 9 <= hour <= 18
```

**ğŸ”’ ç¼©å®¹ä¿æŠ¤æœºåˆ¶**

```
ä¿æŠ¤ç­–ç•¥ï¼š
âœ… æœ€å°å®ä¾‹ä¿è¯ï¼šè‡³å°‘ä¿ç•™2ä¸ªå®ä¾‹è¿è¡Œ
âœ… å¹³æ»‘ä¸‹çº¿ï¼šé€ä¸ªå…³é—­å®ä¾‹ï¼Œä¸èƒ½æ‰¹é‡å…³é—­
âœ… è¿æ¥æ’ç©ºï¼šç­‰å¾…ç°æœ‰è¿æ¥å¤„ç†å®Œå†å…³é—­
âœ… å¥åº·æ£€æŸ¥ï¼šç¡®ä¿å‰©ä½™å®ä¾‹è¿è¡Œæ­£å¸¸
âœ… å›æ»šæœºåˆ¶ï¼šç¼©å®¹åæ€§èƒ½ä¸‹é™ç«‹å³å›æ»š
```

### 4.3 å¼¹æ€§æ‰©ç¼©å®¹å®ç°


```bash
#!/bin/bash
# ç®€å•çš„è‡ªåŠ¨æ‰©ç¼©å®¹è„šæœ¬

SCALE_CONFIG="/etc/autoscale.conf"
LOG_FILE="/var/log/autoscale.log"

# è·å–å½“å‰ç³»ç»ŸæŒ‡æ ‡
get_system_metrics() {
    CPU_USAGE=$(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1)
    MEMORY_USAGE=$(free | grep Mem | awk '{printf("%.1f", $3/$2 * 100.0)}')
    LOAD_AVG=$(uptime | awk '{print $(NF-2)}' | cut -d',' -f1)
    
    echo "CPU: $CPU_USAGE%, Memory: $MEMORY_USAGE%, Load: $LOAD_AVG"
}

# æ‰©å®¹æ“ä½œ
scale_out() {
    local reason=$1
    echo "$(date): è§¦å‘æ‰©å®¹ - $reason" >> $LOG_FILE
    
    # è¿™é‡Œè°ƒç”¨å®é™…çš„æ‰©å®¹å‘½ä»¤
    # ä¾‹å¦‚ï¼šå¯åŠ¨æ–°çš„Dockerå®¹å™¨ã€åˆ›å»ºæ–°çš„è™šæ‹Ÿæœºç­‰
    docker run -d --name "web-$(date +%s)" nginx:latest
    
    echo "æ‰©å®¹å®Œæˆï¼Œæ–°å¢1ä¸ªå®ä¾‹"
}

# ç¼©å®¹æ“ä½œ  
scale_in() {
    local reason=$1
    echo "$(date): è§¦å‘ç¼©å®¹ - $reason" >> $LOG_FILE
    
    # å®‰å…¨å…³é—­æœ€æ—§çš„å®ä¾‹
    oldest_container=$(docker ps --format "table {{.Names}}" | grep web | tail -1)
    if [ -n "$oldest_container" ]; then
        docker stop $oldest_container
        echo "ç¼©å®¹å®Œæˆï¼Œç§»é™¤å®ä¾‹: $oldest_container"
    fi
}

# ä¸»ç›‘æ§å¾ªç¯
monitor_and_scale() {
    while true; do
        metrics=$(get_system_metrics)
        cpu_usage=$(echo $metrics | awk '{print $2}' | cut -d'%' -f1)
        
        # åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹
        if (( $(echo "$cpu_usage > 80" | bc -l) )); then
            scale_out "CPUä½¿ç”¨ç‡è¿‡é«˜: ${cpu_usage}%"
            sleep 300  # æ‰©å®¹åç­‰å¾…5åˆ†é’Ÿå†æ£€æŸ¥
        # åˆ¤æ–­æ˜¯å¦å¯ä»¥ç¼©å®¹    
        elif (( $(echo "$cpu_usage < 20" | bc -l) )); then
            scale_in "CPUä½¿ç”¨ç‡è¿‡ä½: ${cpu_usage}%"
            sleep 600  # ç¼©å®¹åç­‰å¾…10åˆ†é’Ÿå†æ£€æŸ¥
        fi
        
        sleep 60  # æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
    done
}
```

---

## 5. ğŸ“ å¼¹æ€§ä¼¸ç¼©è§„åˆ™é…ç½®


### 5.1 ä¼¸ç¼©è§„åˆ™è®¾è®¡åŸåˆ™


**ğŸ“‹ é…ç½®è§„åˆ™çš„æ ¸å¿ƒåŸåˆ™**

> **ğŸ’¡ å…³é”®ç†è§£**
> å¼¹æ€§ä¼¸ç¼©è§„åˆ™å°±åƒäº¤é€šä¿¡å·ç¯çš„é€»è¾‘ï¼Œéœ€è¦æ˜ç¡®ä»€ä¹ˆæƒ…å†µä¸‹"çº¢ç¯åœ"ï¼ˆç¼©å®¹ï¼‰ï¼Œä»€ä¹ˆæƒ…å†µä¸‹"ç»¿ç¯è¡Œ"ï¼ˆæ‰©å®¹ï¼‰ï¼Œä»€ä¹ˆæƒ…å†µä¸‹"é»„ç¯ç­‰"ï¼ˆä¿æŒç°çŠ¶ï¼‰ã€‚

```yaml
# autoscale_rules.yaml - ä¼¸ç¼©è§„åˆ™é…ç½®æ–‡ä»¶
apiVersion: v1
kind: ConfigMap
metadata:
  name: autoscale-rules
data:
  rules.yaml: |
    # æ‰©å®¹è§„åˆ™
    scale_out_rules:
      # è§„åˆ™1ï¼šCPUé«˜è´Ÿè½½æ‰©å®¹
      - name: "cpu-high-load"
        metric: "cpu_usage"
        threshold: 75          # é˜ˆå€¼75%
        duration: 300          # æŒç»­5åˆ†é’Ÿ
        cooldown: 300          # å†·å´æœŸ5åˆ†é’Ÿ
        scale_step: 2          # æ¯æ¬¡å¢åŠ 2ä¸ªå®ä¾‹
        
      # è§„åˆ™2ï¼šå†…å­˜å‹åŠ›æ‰©å®¹  
      - name: "memory-pressure"
        metric: "memory_usage"
        threshold: 80
        duration: 180          # æŒç»­3åˆ†é’Ÿ
        scale_step: 1
        
      # è§„åˆ™3ï¼šè¯·æ±‚é˜Ÿåˆ—å †ç§¯æ‰©å®¹
      - name: "queue-backlog"
        metric: "pending_requests"
        threshold: 50          # é˜Ÿåˆ—é•¿åº¦è¶…è¿‡50
        duration: 60           # æŒç»­1åˆ†é’Ÿ
        scale_step: 3          # ç´§æ€¥æ‰©å®¹3ä¸ªå®ä¾‹
    
    # ç¼©å®¹è§„åˆ™
    scale_in_rules:
      - name: "low-utilization"
        conditions:
          - metric: "cpu_usage"
            threshold: 20      # CPUä½äº20%
            duration: 900      # æŒç»­15åˆ†é’Ÿ
          - metric: "memory_usage"  
            threshold: 40      # å†…å­˜ä½äº40%
            duration: 900
        scale_step: 1          # æ¯æ¬¡å‡å°‘1ä¸ªå®ä¾‹
        min_instances: 2       # æœ€å°‘ä¿ç•™2ä¸ªå®ä¾‹
```

### 5.2 å¤šå±‚æ¬¡ä¼¸ç¼©ç­–ç•¥


**ğŸ¯ ä¸åŒç´§æ€¥ç¨‹åº¦çš„å¤„ç†ç­–ç•¥**

```
ä¼¸ç¼©ç´§æ€¥ç¨‹åº¦åˆ†çº§ï¼š

ğŸŸ¢ æ­£å¸¸çŠ¶æ€ (CPU: 30-70%)
   â””â”€ ä¸è§¦å‘ä¼¸ç¼©ï¼Œä¿æŒç°çŠ¶

ğŸŸ¡ è½»å¾®å‹åŠ› (CPU: 70-80%)  
   â””â”€ é¢„çƒ­å¤‡ç”¨å®ä¾‹ï¼Œå‡†å¤‡æ‰©å®¹

ğŸŸ  ä¸­ç­‰å‹åŠ› (CPU: 80-90%)
   â””â”€ ç«‹å³æ‰©å®¹1-2ä¸ªå®ä¾‹

ğŸ”´ é«˜å‹çŠ¶æ€ (CPU: 90-95%)
   â””â”€ ç´§æ€¥æ‰©å®¹3-5ä¸ªå®ä¾‹

ğŸš¨ ç´§æ€¥çŠ¶æ€ (CPU: >95%)
   â””â”€ æœ€å¤§é€Ÿåº¦æ‰©å®¹ï¼ŒåŒæ—¶æŠ¥è­¦
```

**å¤åˆæ¡ä»¶åˆ¤æ–­**ï¼š

```python
def evaluate_scaling_decision(metrics):
    """
    åŸºäºå¤šä¸ªæŒ‡æ ‡ç»¼åˆåˆ¤æ–­æ‰©ç¼©å®¹å†³ç­–
    """
    cpu = metrics['cpu_usage']
    memory = metrics['memory_usage']  
    response_time = metrics['avg_response_time']
    error_rate = metrics['error_rate']
    
    # ç´§æ€¥æ‰©å®¹æ¡ä»¶
    if (cpu > 90 or memory > 95 or 
        response_time > 2000 or error_rate > 5):
        return {
            'action': 'scale_out',
            'urgency': 'emergency',
            'scale_step': 5
        }
    
    # æ ‡å‡†æ‰©å®¹æ¡ä»¶    
    elif (cpu > 75 or memory > 80 or response_time > 1000):
        return {
            'action': 'scale_out', 
            'urgency': 'normal',
            'scale_step': 2
        }
    
    # ç¼©å®¹æ¡ä»¶
    elif (cpu < 25 and memory < 40 and 
          response_time < 200 and error_rate < 0.1):
        return {
            'action': 'scale_in',
            'urgency': 'normal', 
            'scale_step': 1
        }
    
    # ä¿æŒç°çŠ¶
    else:
        return {'action': 'no_change'}
```

### 5.3 æ‰©ç¼©å®¹æ“ä½œè®°å½•


**ğŸ“ è¯¦ç»†çš„æ“ä½œæ—¥å¿—è®°å½•**

æ¯æ¬¡æ‰©ç¼©å®¹æ“ä½œéƒ½éœ€è¦è¯¦ç»†è®°å½•ï¼Œè¿™æ ·æ—¢èƒ½è¿½è¸ªé—®é¢˜ï¼Œä¹Ÿèƒ½ä¼˜åŒ–ç­–ç•¥ã€‚

```python
import json
import datetime

class AutoScaleLogger:
    def __init__(self, log_file="/var/log/autoscale_operations.log"):
        self.log_file = log_file
    
    def log_scaling_event(self, action, metrics, decision, result):
        """è®°å½•æ‰©ç¼©å®¹äº‹ä»¶"""
        log_entry = {
            'timestamp': datetime.datetime.now().isoformat(),
            'action': action,  # 'scale_out' æˆ– 'scale_in'
            'trigger_metrics': metrics,
            'decision_reason': decision,
            'scaling_result': result,
            'instances_before': result.get('instances_before', 0),
            'instances_after': result.get('instances_after', 0)
        }
        
        with open(self.log_file, 'a') as f:
            f.write(json.dumps(log_entry) + '\n')
    
    def generate_scaling_report(self, days=7):
        """ç”Ÿæˆæ‰©ç¼©å®¹æ“ä½œæŠ¥å‘Š"""
        # è¯»å–æœ€è¿‘Nå¤©çš„æ—¥å¿—å¹¶åˆ†æ
        scaling_stats = {
            'total_scale_out': 0,
            'total_scale_in': 0,
            'avg_instances': 0,
            'peak_instances': 0,
            'cost_savings': 0
        }
        
        return scaling_stats
```

**æ—¥å¿—æ ¼å¼ç¤ºä¾‹**ï¼š
```json
{
  "timestamp": "2025-01-17T14:30:00",
  "action": "scale_out", 
  "trigger_metrics": {
    "cpu_usage": 82.5,
    "memory_usage": 78.3,
    "response_time": 850
  },
  "decision_reason": "CPUä½¿ç”¨ç‡æŒç»­5åˆ†é’Ÿè¶…è¿‡80%é˜ˆå€¼",
  "instances_before": 3,
  "instances_after": 5,
  "scaling_duration": 120,
  "success": true
}
```

---

## 6. ğŸ’° æˆæœ¬ä¼˜åŒ–ç­–ç•¥


### 6.1 æˆæœ¬æ„ŸçŸ¥çš„æ‰©ç¼©å®¹


**å¦‚ä½•åœ¨æ€§èƒ½å’Œæˆæœ¬ä¹‹é—´æ‰¾å¹³è¡¡ï¼Ÿ**

> **ğŸ’­ å•†ä¸šæ€è€ƒ**
> å°±åƒå¼€è½¦ï¼Œä½ å¯ä»¥ä¸€è„šæ²¹é—¨å†²åˆ°ç›®çš„åœ°ï¼Œä½†ä¼šå¾ˆè´¹æ²¹ï¼›ä¹Ÿå¯ä»¥åŒ€é€Ÿè¡Œé©¶çœæ²¹ï¼Œä½†å¯èƒ½ä¼šè¿Ÿåˆ°ã€‚è‡ªåŠ¨æ‰©ç¼©å®¹ä¹Ÿæ˜¯åœ¨æ€§èƒ½å’Œæˆæœ¬é—´æ‰¾æœ€ä¼˜è§£ã€‚

**ğŸ¯ æˆæœ¬ä¼˜åŒ–çš„æ ¸å¿ƒç­–ç•¥**

```python
class CostAwareScaling:
    def __init__(self):
        # ä¸åŒå®ä¾‹ç±»å‹çš„æˆæœ¬(æ¯å°æ—¶)
        self.instance_costs = {
            'small': 0.10,    # å°å‹å®ä¾‹
            'medium': 0.20,   # ä¸­å‹å®ä¾‹  
            'large': 0.40,    # å¤§å‹å®ä¾‹
            'xlarge': 0.80    # è¶…å¤§å‹å®ä¾‹
        }
    
    def calculate_scaling_cost(self, current_instances, target_instances, duration_hours=1):
        """è®¡ç®—æ‰©ç¼©å®¹çš„æˆæœ¬å½±å“"""
        current_cost = sum(self.instance_costs[inst['type']] for inst in current_instances) * duration_hours
        target_cost = sum(self.instance_costs[inst['type']] for inst in target_instances) * duration_hours
        
        cost_impact = target_cost - current_cost
        return {
            'current_cost': current_cost,
            'target_cost': target_cost, 
            'cost_impact': cost_impact,
            'cost_per_performance_gain': cost_impact / (len(target_instances) - len(current_instances)) if target_instances != current_instances else 0
        }
    
    def choose_optimal_instance_mix(self, required_capacity):
        """é€‰æ‹©æœ€ç»æµçš„å®ä¾‹ç»„åˆ"""
        # ç®€åŒ–çš„èƒŒåŒ…é—®é¢˜æ±‚è§£
        # åœ¨æ»¡è¶³æ€§èƒ½è¦æ±‚çš„å‰æä¸‹ï¼Œé€‰æ‹©æˆæœ¬æœ€ä½çš„ç»„åˆ
        
        combinations = [
            # (å®ä¾‹æ•°é‡, å®ä¾‹ç±»å‹, æ€»æ€§èƒ½, æ€»æˆæœ¬)
            (5, 'small', 5, 0.50),
            (3, 'medium', 6, 0.60), 
            (2, 'large', 8, 0.80),
            (1, 'xlarge', 10, 0.80)
        ]
        
        # é€‰æ‹©æ»¡è¶³æ€§èƒ½è¦æ±‚ä¸”æˆæœ¬æœ€ä½çš„ç»„åˆ
        valid_combinations = [combo for combo in combinations if combo[2] >= required_capacity]
        
        if valid_combinations:
            optimal = min(valid_combinations, key=lambda x: x[3])  # æŒ‰æˆæœ¬æ’åº
            return {
                'instances': optimal[0],
                'type': optimal[1],
                'performance': optimal[2],
                'cost': optimal[3]
            }
        
        return None
```

### 6.2 é¢„ç®—çº¦æŸä¸‹çš„æ‰©å®¹ç­–ç•¥


```bash
#!/bin/bash
# é¢„ç®—çº¦æŸæ‰©å®¹è„šæœ¬

MONTHLY_BUDGET=1000      # æœˆé¢„ç®—1000ç¾å…ƒ
CURRENT_SPEND=0          # å½“å‰æ”¯å‡º
INSTANCE_HOURLY_COST=0.20  # æ¯å®ä¾‹æ¯å°æ—¶æˆæœ¬

check_budget_before_scaling() {
    local hours_remaining_in_month=720  # å‡è®¾æœˆæœ«å‰è¿˜æœ‰720å°æ—¶
    local new_instances=$1
    local projected_additional_cost=$((new_instances * INSTANCE_HOURLY_COST * hours_remaining_in_month))
    
    if [ $((CURRENT_SPEND + projected_additional_cost)) -gt $MONTHLY_BUDGET ]; then
        echo "è­¦å‘Šï¼šæ‰©å®¹å°†è¶…å‡ºæœˆé¢„ç®—ï¼Œæ‹’ç»æ‰©å®¹"
        return 1
    else
        echo "é¢„ç®—æ£€æŸ¥é€šè¿‡ï¼Œå¯ä»¥æ‰©å®¹ $new_instances ä¸ªå®ä¾‹"
        return 0
    fi
}

# æ™ºèƒ½æ‰©å®¹å†³ç­–
smart_scale_out() {
    local required_instances=$1
    local max_affordable_instances=$((($MONTHLY_BUDGET - $CURRENT_SPEND) / ($INSTANCE_HOURLY_COST * 720)))
    
    if [ $required_instances -le $max_affordable_instances ]; then
        echo "æ‰©å®¹ $required_instances ä¸ªå®ä¾‹"
        return $required_instances
    else
        echo "é¢„ç®—é™åˆ¶ï¼Œæœ€å¤šæ‰©å®¹ $max_affordable_instances ä¸ªå®ä¾‹"
        return $max_affordable_instances
    fi
}
```

### 6.3 æˆæœ¬ä¼˜åŒ–æœ€ä½³å®è·µ


**ğŸ“Š æˆæœ¬æ§åˆ¶ç­–ç•¥å¯¹æ¯”**

| ç­–ç•¥ç±»å‹ | **ä¼˜ç‚¹** | **ç¼ºç‚¹** | **é€‚ç”¨åœºæ™¯** |
|---------|----------|----------|-------------|
| **é¢„ç®—ç¡¬é™åˆ¶** | `æˆæœ¬å¯æ§` | `å¯èƒ½å½±å“æ€§èƒ½` | `æˆæœ¬æ•æ„Ÿçš„å°å…¬å¸` |
| **æ€§èƒ½ä¼˜å…ˆ** | `ç”¨æˆ·ä½“éªŒå¥½` | `æˆæœ¬è¾ƒé«˜` | `ä¸šåŠ¡å…³é”®åº”ç”¨` |
| **åŠ¨æ€å¹³è¡¡** | `å…¼é¡¾æ€§èƒ½å’Œæˆæœ¬` | `ç­–ç•¥å¤æ‚` | `å¤§å¤šæ•°ä¼ä¸šåº”ç”¨` |
| **æ—¶é—´åˆ†ç‰‡** | `é”™å³°èŠ‚çœæˆæœ¬` | `éœ€è¦é¢„æµ‹å‡†ç¡®` | `å‘¨æœŸæ€§è´Ÿè½½åº”ç”¨` |

**ğŸ’¡ å®ç”¨çš„æˆæœ¬ä¼˜åŒ–æŠ€å·§**

```
æˆæœ¬ä¼˜åŒ–æ¸…å•ï¼š

â° æ—¶é—´ç­–ç•¥ï¼š
âœ… éé«˜å³°æœŸè‡ªåŠ¨ç¼©å®¹åˆ°æœ€å°è§„æ¨¡
âœ… é¢„æµ‹æ€§æ‰©å®¹ï¼Œé¿å…çªå‘æ‰©å®¹çš„é«˜æˆæœ¬
âœ… è®¾ç½®æ¯æ—¥/æ¯å‘¨æˆæœ¬é¢„ç®—ä¸Šé™

ğŸ¯ å®ä¾‹ç­–ç•¥ï¼š
âœ… æ··åˆä½¿ç”¨ä¸åŒè§„æ ¼å®ä¾‹
âœ… ä¼˜å…ˆä½¿ç”¨é¢„ä»˜è´¹å®ä¾‹é™ä½æˆæœ¬  
âœ… è®¾ç½®å®ä¾‹æœ€é•¿è¿è¡Œæ—¶é—´ï¼Œé¿å…å¿˜è®°å…³é—­

ğŸ“Š ç›‘æ§ç­–ç•¥ï¼š
âœ… å®æ—¶ç›‘æ§æˆæœ¬å˜åŒ–è¶‹åŠ¿
âœ… è®¾ç½®æˆæœ¬å¼‚å¸¸æŠ¥è­¦
âœ… å®šæœŸç”Ÿæˆæˆæœ¬ä¼˜åŒ–å»ºè®®æŠ¥å‘Š
```

---

## 7. ğŸ“Š å®¹é‡è§„åˆ’ä¸æŠ¥å‘Š


### 7.1 å®¹é‡è§„åˆ’æŠ¥å‘Šç”Ÿæˆ


**ä»€ä¹ˆæ˜¯å®¹é‡è§„åˆ’æŠ¥å‘Šï¼Ÿ**

å®¹é‡è§„åˆ’æŠ¥å‘Šå°±åƒå…¬å¸çš„è´¢åŠ¡é¢„ç®—ä¸€æ ·ï¼Œå¸®åŠ©æˆ‘ä»¬é¢„æµ‹æœªæ¥éœ€è¦å¤šå°‘ITèµ„æºï¼Œä»¥åŠéœ€è¦æŠ•å…¥å¤šå°‘æˆæœ¬ã€‚

```python
class CapacityPlanningReport:
    def __init__(self):
        self.report_data = {}
    
    def generate_monthly_report(self, historical_data, growth_rate=0.1):
        """ç”Ÿæˆæœˆåº¦å®¹é‡è§„åˆ’æŠ¥å‘Š"""
        
        # å½“å‰èµ„æºä½¿ç”¨æƒ…å†µåˆ†æ
        current_usage = self.analyze_current_usage(historical_data)
        
        # é¢„æµ‹æœªæ¥3ä¸ªæœˆçš„èµ„æºéœ€æ±‚
        future_predictions = self.predict_future_demand(historical_data, months=3, growth_rate=growth_rate)
        
        # æˆæœ¬é¢„æµ‹
        cost_forecast = self.calculate_cost_forecast(future_predictions)
        
        # é£é™©è¯„ä¼°
        risk_analysis = self.assess_capacity_risks(current_usage, future_predictions)
        
        report = {
            'report_date': datetime.datetime.now().strftime('%Y-%m-%d'),
            'current_usage_summary': current_usage,
            'future_predictions': future_predictions,
            'cost_forecast': cost_forecast,
            'risk_analysis': risk_analysis,
            'recommendations': self.generate_recommendations(risk_analysis)
        }
        
        return report
    
    def analyze_current_usage(self, data):
        """åˆ†æå½“å‰èµ„æºä½¿ç”¨æƒ…å†µ"""
        return {
            'avg_cpu_usage': np.mean([d['cpu'] for d in data]),
            'peak_cpu_usage': np.max([d['cpu'] for d in data]),
            'avg_memory_usage': np.mean([d['memory'] for d in data]),
            'peak_memory_usage': np.max([d['memory'] for d in data]),
            'avg_instances_running': np.mean([d['instances'] for d in data]),
            'peak_instances_running': np.max([d['instances'] for d in data])
        }
    
    def generate_recommendations(self, risk_analysis):
        """åŸºäºé£é™©åˆ†æç”Ÿæˆå»ºè®®"""
        recommendations = []
        
        if risk_analysis['cpu_risk'] > 0.7:
            recommendations.append("å»ºè®®æå‰é‡‡è´­CPUèµ„æºï¼Œé¢„è®¡æœªæ¥3ä¸ªæœˆCPUä½¿ç”¨ç‡å°†è¶…è¿‡80%")
        
        if risk_analysis['memory_risk'] > 0.6:
            recommendations.append("å»ºè®®ä¼˜åŒ–å†…å­˜ä½¿ç”¨æˆ–å¢åŠ å†…å­˜å®¹é‡")
            
        if risk_analysis['cost_risk'] > 0.8:
            recommendations.append("æˆæœ¬å¢é•¿è¿‡å¿«ï¼Œå»ºè®®è€ƒè™‘èµ„æºä¼˜åŒ–æ–¹æ¡ˆ")
            
        return recommendations
```

### 7.2 æŠ¥å‘Šå¯è§†åŒ–å±•ç¤º


**ğŸ“ˆ ç›´è§‚çš„å›¾è¡¨å±•ç¤º**

è™½ç„¶è¿™é‡Œä¸èƒ½ç›´æ¥ç”»å›¾ï¼Œä½†å¯ä»¥ç”¨æ–‡æœ¬å›¾è¡¨æ¥å±•ç¤ºè¶‹åŠ¿ï¼š

```
ğŸ“Š CPUä½¿ç”¨ç‡è¶‹åŠ¿å›¾ (è¿‡å»30å¤©)
100% â”¤                                    
 90% â”¤              â•­â”€â•®                   
 80% â”¤          â•­â”€â”€â”€â•¯ â•°â”€â•®                 
 70% â”¤      â•­â”€â”€â”€â•¯       â•°â”€â”€â•®              
 60% â”¤  â•­â”€â”€â”€â•¯              â•°â”€â•®            
 50% â”¤â”€â”€â•¯                   â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     â””â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬
      1  5  10 15 20 25 30 35 40 45 50 å¤©

ğŸ” å…³é”®å‘ç°ï¼š
â€¢ ç¬¬20-25å¤©å‡ºç°ä½¿ç”¨é«˜å³°ï¼Œè¾¾åˆ°90%
â€¢ æ•´ä½“å‘ˆä¸Šå‡è¶‹åŠ¿ï¼Œæœˆå¢é•¿ç‡çº¦15%
â€¢ å»ºè®®åœ¨ç¬¬45å¤©å‰è¿›è¡Œæ‰©å®¹å‡†å¤‡

ğŸ’° æˆæœ¬é¢„æµ‹å›¾ (æœªæ¥3ä¸ªæœˆ)
$2000 â”¤                               â•­â”€
$1800 â”¤                           â•­â”€â”€â”€â•¯
$1600 â”¤                       â•­â”€â”€â”€â•¯    
$1400 â”¤                   â•­â”€â”€â”€â•¯        
$1200 â”¤               â•­â”€â”€â”€â•¯            
$1000 â”¤â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯                
      â””â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€
       ç°åœ¨  æœˆ1   æœˆ2   æœˆ3   æœˆ4   æœˆ5

é¢„æµ‹è¯´æ˜ï¼š
â€¢ å½“å‰æœˆæ”¯å‡ºï¼š$1000
â€¢ é¢„è®¡3ä¸ªæœˆåï¼š$1800 (å¢é•¿80%)
â€¢ ä¸»è¦å¢é•¿æ¥æºï¼šä¸šåŠ¡æ‰©å¼ å’Œæ–°åŠŸèƒ½ä¸Šçº¿
```

### 7.3 æŠ¥å‘Šè‡ªåŠ¨åŒ–ç”Ÿæˆ


```bash
#!/bin/bash
# è‡ªåŠ¨åŒ–ç”Ÿæˆå®¹é‡è§„åˆ’æŠ¥å‘Š

REPORT_DIR="/var/reports/capacity"
REPORT_DATE=$(date +%Y%m%d)
REPORT_FILE="$REPORT_DIR/capacity_report_$REPORT_DATE.html"

# åˆ›å»ºæŠ¥å‘Šç›®å½•
mkdir -p $REPORT_DIR

# ç”ŸæˆHTMLæŠ¥å‘Š
cat > $REPORT_FILE << EOF
<!DOCTYPE html>
<html>
<head>
    <title>å®¹é‡è§„åˆ’æŠ¥å‘Š - $REPORT_DATE</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .metric { background: #f5f5f5; padding: 10px; margin: 10px 0; border-left: 4px solid #007cba; }
        .warning { border-left-color: #ff9800; }
        .critical { border-left-color: #f44336; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>
    <h1>ğŸ–¥ï¸ ç³»ç»Ÿå®¹é‡è§„åˆ’æŠ¥å‘Š</h1>
    <p><strong>ç”Ÿæˆæ—¶é—´ï¼š</strong>$(date)</p>
    
    <h2>ğŸ“Š å½“å‰èµ„æºä½¿ç”¨æ¦‚å†µ</h2>
    <div class="metric">
        <strong>CPUä½¿ç”¨ç‡ï¼š</strong>$(top -bn1 | grep "Cpu(s)" | awk '{print $2}')
    </div>
    <div class="metric">
        <strong>å†…å­˜ä½¿ç”¨ç‡ï¼š</strong>$(free | grep Mem | awk '{printf("%.1f%%", $3/$2 * 100.0)}')
    </div>
    <div class="metric">
        <strong>ç£ç›˜ä½¿ç”¨ç‡ï¼š</strong>$(df -h / | tail -1 | awk '{print $5}')
    </div>
    
    <h2>ğŸ”® æœªæ¥3ä¸ªæœˆé¢„æµ‹</h2>
    <table>
        <tr><th>æŒ‡æ ‡</th><th>å½“å‰å€¼</th><th>1ä¸ªæœˆå</th><th>2ä¸ªæœˆå</th><th>3ä¸ªæœˆå</th></tr>
        <tr><td>é¢„è®¡å®ä¾‹æ•°</td><td>5</td><td>6</td><td>7</td><td>8</td></tr>
        <tr><td>é¢„è®¡æœˆæˆæœ¬</td><td>\$1000</td><td>\$1200</td><td>\$1400</td><td>\$1600</td></tr>
    </table>
    
    <h2>ğŸ’¡ ä¼˜åŒ–å»ºè®®</h2>
    <ul>
        <li>å»ºè®®åœ¨ä¸‹æœˆåˆå¢åŠ 2å°æœåŠ¡å™¨</li>
        <li>è€ƒè™‘ä½¿ç”¨CDNå‡å°‘å¸¦å®½æˆæœ¬</li>
        <li>ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢ï¼Œé™ä½CPUè´Ÿè½½</li>
    </ul>
    
</body>
</html>
EOF

echo "å®¹é‡è§„åˆ’æŠ¥å‘Šå·²ç”Ÿæˆï¼š$REPORT_FILE"

# å‘é€é‚®ä»¶é€šçŸ¥(å¦‚æœé…ç½®äº†é‚®ä»¶æœåŠ¡)
if command -v mail >/dev/null 2>&1; then
    echo "å®¹é‡è§„åˆ’æŠ¥å‘Šå·²ç”Ÿæˆï¼Œè¯·æŸ¥çœ‹é™„ä»¶" | mail -s "å®¹é‡è§„åˆ’æŠ¥å‘Š - $REPORT_DATE" -a $REPORT_FILE admin@company.com
fi
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å®¹é‡é¢„æµ‹ï¼šæå‰é¢„åˆ¤ç³»ç»Ÿèµ„æºéœ€æ±‚ï¼Œåƒå¤©æ°”é¢„æŠ¥ä¸€æ ·é¢„æµ‹æœªæ¥è´Ÿè½½
ğŸ”¸ è‡ªåŠ¨æ‰©ç¼©å®¹ï¼šæ ¹æ®å®æ—¶è´Ÿè½½è‡ªåŠ¨è°ƒæ•´èµ„æºï¼Œä¿è¯æ€§èƒ½å’Œæˆæœ¬å¹³è¡¡
ğŸ”¸ å¼¹æ€§ä¼¸ç¼©ï¼šè®¾è®¡åˆç†çš„æ‰©ç¼©å®¹è§„åˆ™ï¼Œé¿å…é¢‘ç¹æŠ–åŠ¨å’Œèµ„æºæµªè´¹
ğŸ”¸ æˆæœ¬ä¼˜åŒ–ï¼šåœ¨æ»¡è¶³æ€§èƒ½è¦æ±‚å‰æä¸‹ï¼Œæœ€å°åŒ–è¿ç»´æˆæœ¬
ğŸ”¸ å®¹é‡è§„åˆ’ï¼šåŸºäºé¢„æµ‹ç»“æœåˆ¶å®šé•¿æœŸèµ„æºé‡‡è´­å’Œæ‰©å®¹è®¡åˆ’
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆéœ€è¦å®¹é‡é¢„æµ‹ï¼Ÿ**
```
å®é™…ä»·å€¼ï¼š
â€¢ é¿å…çªå‘æµé‡å¯¼è‡´ç³»ç»Ÿå´©æºƒ
â€¢ åˆç†è§„åˆ’ITé¢„ç®—å’Œèµ„æºé‡‡è´­
â€¢ æé«˜ç³»ç»Ÿå¯ç”¨æ€§å’Œç”¨æˆ·ä½“éªŒ
â€¢ ä¼˜åŒ–è¿ç»´æˆæœ¬ï¼Œé¿å…èµ„æºæµªè´¹

é¢„æµ‹å‡†ç¡®æ€§ï¼š
â€¢ ä¸æ±‚100%å‡†ç¡®ï¼Œ70-80%å‡†ç¡®åº¦å³æœ‰å¾ˆå¤§ä»·å€¼
â€¢ é‡ç‚¹æ˜¯è¯†åˆ«è¶‹åŠ¿å’Œå¼‚å¸¸ï¼Œè€Œéç²¾ç¡®æ•°å€¼
â€¢ ç»“åˆä¸šåŠ¡è§„å¾‹å’Œå†å²æ•°æ®è¿›è¡Œé¢„æµ‹
```

**ğŸ”¹ è‡ªåŠ¨æ‰©ç¼©å®¹çš„æ ¸å¿ƒæŒ‘æˆ˜**
```
æŠ€æœ¯æŒ‘æˆ˜ï¼š
â€¢ å¦‚ä½•é¿å…é¢‘ç¹æ‰©ç¼©å®¹é€ æˆçš„æŠ–åŠ¨
â€¢ å¦‚ä½•å¿«é€Ÿå‡†ç¡®åœ°æ£€æµ‹è´Ÿè½½å˜åŒ–
â€¢ å¦‚ä½•åœ¨å¤šä¸ªæŒ‡æ ‡é—´åšæƒè¡¡å†³ç­–

ä¸šåŠ¡æŒ‘æˆ˜ï¼š
â€¢ å¦‚ä½•å¹³è¡¡æ€§èƒ½è¦æ±‚å’Œæˆæœ¬æ§åˆ¶
â€¢ å¦‚ä½•å¤„ç†çªå‘ä¸šåŠ¡éœ€æ±‚
â€¢ å¦‚ä½•åˆ¶å®šåˆç†çš„SLAæŒ‡æ ‡
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ“Š ç›‘æ§æŒ‡æ ‡é€‰æ‹©**
```
æ ¸å¿ƒæŒ‡æ ‡ï¼ˆå¿…é¡»ç›‘æ§ï¼‰ï¼š
âœ… CPUä½¿ç”¨ç‡ï¼šåæ˜ è®¡ç®—è´Ÿè½½
âœ… å†…å­˜ä½¿ç”¨ç‡ï¼šåæ˜ å†…å­˜å‹åŠ›  
âœ… å“åº”æ—¶é—´ï¼šåæ˜ ç”¨æˆ·ä½“éªŒ
âœ… é”™è¯¯ç‡ï¼šåæ˜ ç³»ç»Ÿå¥åº·åº¦

è¾…åŠ©æŒ‡æ ‡ï¼ˆå‚è€ƒä»·å€¼ï¼‰ï¼š
â€¢ ç½‘ç»œI/Oï¼šå¸¦å®½ä½¿ç”¨æƒ…å†µ
â€¢ ç£ç›˜I/Oï¼šå­˜å‚¨æ€§èƒ½ç“¶é¢ˆ
â€¢ é˜Ÿåˆ—é•¿åº¦ï¼šè¯·æ±‚å †ç§¯æƒ…å†µ
â€¢ è¿æ¥æ•°ï¼šå¹¶å‘ç”¨æˆ·æ•°é‡
```

**âš™ï¸ é…ç½®æœ€ä½³å®è·µ**
```
æ‰©å®¹é…ç½®ï¼š
â€¢ æ‰©å®¹é˜ˆå€¼ï¼šCPU > 75%, Memory > 80%
â€¢ æŒç»­æ—¶é—´ï¼šè‡³å°‘æŒç»­3-5åˆ†é’Ÿå†è§¦å‘
â€¢ å†·å´æœŸï¼šæ‰©å®¹åç­‰å¾…5åˆ†é’Ÿå†æ¬¡æ£€æµ‹
â€¢ æ‰©å®¹æ­¥é•¿ï¼šä¸€æ¬¡å¢åŠ 1-2ä¸ªå®ä¾‹

ç¼©å®¹é…ç½®ï¼š  
â€¢ ç¼©å®¹é˜ˆå€¼ï¼šCPU < 30%, Memory < 50%
â€¢ æŒç»­æ—¶é—´ï¼šè‡³å°‘ç¨³å®š15åˆ†é’Ÿå†ç¼©å®¹
â€¢ æœ€å°å®ä¾‹ï¼šè‡³å°‘ä¿ç•™2ä¸ªå®ä¾‹è¿è¡Œ
â€¢ ä¿æŠ¤æ—¶æ®µï¼šä¸šåŠ¡é«˜å³°æœŸç¦æ­¢ç¼©å®¹
```

### 8.4 å·¥ç¨‹å®è·µè¦ç‚¹


**ğŸ”§ å®æ–½æ­¥éª¤å»ºè®®**
```
ç¬¬ä¸€é˜¶æ®µï¼šç›‘æ§ä½“ç³»å»ºè®¾
â€¢ éƒ¨ç½²ç›‘æ§å·¥å…·ï¼Œæ”¶é›†åŸºç¡€æŒ‡æ ‡
â€¢ å»ºç«‹å†å²æ•°æ®å­˜å‚¨å’Œåˆ†æèƒ½åŠ›
â€¢ è®¾ç½®åŸºæœ¬çš„å‘Šè­¦è§„åˆ™

ç¬¬äºŒé˜¶æ®µï¼šé¢„æµ‹èƒ½åŠ›å»ºè®¾  
â€¢ å®ç°ç®€å•çš„é¢„æµ‹ç®—æ³•
â€¢ éªŒè¯é¢„æµ‹å‡†ç¡®æ€§
â€¢ å»ºç«‹é¢„æµ‹ç»“æœå±•ç¤º

ç¬¬ä¸‰é˜¶æ®µï¼šè‡ªåŠ¨åŒ–æ‰©ç¼©å®¹
â€¢ å®ç°åŸºæœ¬çš„æ‰©ç¼©å®¹é€»è¾‘
â€¢ åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ç­–ç•¥
â€¢ é€æ­¥åœ¨ç”Ÿäº§ç¯å¢ƒæ¨å¹¿

ç¬¬å››é˜¶æ®µï¼šæˆæœ¬ä¼˜åŒ–
â€¢ å¼•å…¥æˆæœ¬è€ƒé‡å› ç´ 
â€¢ ä¼˜åŒ–æ‰©ç¼©å®¹ç­–ç•¥
â€¢ å»ºç«‹å®Œå–„çš„æŠ¥å‘Šä½“ç³»
```

**ğŸ“ è¿ç»´æ£€æŸ¥æ¸…å•**
```
æ—¥å¸¸æ£€æŸ¥ï¼š
â–¡ æ‰©ç¼©å®¹æ“ä½œæ—¥å¿—æ˜¯å¦æ­£å¸¸
â–¡ é¢„æµ‹å‡†ç¡®æ€§æ˜¯å¦åœ¨å¯æ¥å—èŒƒå›´
â–¡ æˆæœ¬æ”¯å‡ºæ˜¯å¦ç¬¦åˆé¢„ç®—
â–¡ ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡æ˜¯å¦è¾¾æ ‡

å®šæœŸä¼˜åŒ–ï¼š
â–¡ æ¯æœˆå›é¡¾æ‰©ç¼©å®¹ç­–ç•¥æœ‰æ•ˆæ€§
â–¡ æ¯å­£åº¦è°ƒæ•´é¢„æµ‹ç®—æ³•å‚æ•°
â–¡ æ¯å¹´è¯„ä¼°æ•´ä½“å®¹é‡è§„åˆ’
â–¡ æŒç»­ä¼˜åŒ–æˆæœ¬æ•ˆç›Šæ¯”
```

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- å®¹é‡é¢„æµ‹é‡åœ¨è¶‹åŠ¿ï¼Œä¸æ±‚ç»å¯¹ç²¾å‡†
- è‡ªåŠ¨æ‰©ç¼©å®¹è¦ä¿å®ˆç¨³å¦¥ï¼Œé¿å…é¢‘ç¹æŠ–åŠ¨  
- æˆæœ¬å’Œæ€§èƒ½éœ€è¦å¹³è¡¡ï¼Œä¸èƒ½åªé¡¾ä¸€æ–¹é¢
- ç›‘æ§æ•°æ®æ˜¯åŸºç¡€ï¼Œè§„åˆ™é…ç½®æ˜¯å…³é”®
- æŒç»­ä¼˜åŒ–æ¯”ä¸€æ¬¡æ€§å®Œç¾æ›´é‡è¦