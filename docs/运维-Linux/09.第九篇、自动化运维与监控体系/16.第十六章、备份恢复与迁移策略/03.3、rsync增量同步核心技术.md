---
title: 3ã€rsyncå¢žé‡åŒæ­¥æ ¸å¿ƒæŠ€æœ¯
---
## ðŸ“š ç›®å½•

1. [rsyncåŸºç¡€æ¦‚å¿µä¸Žå·¥ä½œåŽŸç†](#1-rsyncåŸºç¡€æ¦‚å¿µä¸Žå·¥ä½œåŽŸç†)
2. [rsyncç®—æ³•æœºåˆ¶æ·±åº¦è§£æž](#2-rsyncç®—æ³•æœºåˆ¶æ·±åº¦è§£æž)
3. [æœ¬åœ°åŒæ­¥ä¸Žè¿œç¨‹åŒæ­¥é…ç½®](#3-æœ¬åœ°åŒæ­¥ä¸Žè¿œç¨‹åŒæ­¥é…ç½®)
4. [å¢žé‡ä¼ è¾“ä¸Žæ ¡éªŒå’Œè®¡ç®—](#4-å¢žé‡ä¼ è¾“ä¸Žæ ¡éªŒå’Œè®¡ç®—)
5. [æŽ’é™¤è§„åˆ™ä¸ŽåŒ…å«æ¨¡å¼](#5-æŽ’é™¤è§„åˆ™ä¸ŽåŒ…å«æ¨¡å¼)
6. [åˆ é™¤ç­–ç•¥é…ç½®è¯¦è§£](#6-åˆ é™¤ç­–ç•¥é…ç½®è¯¦è§£)
7. [å¸¦å®½é™åˆ¶ä¸Žä¼ è¾“ä¼˜åŒ–](#7-å¸¦å®½é™åˆ¶ä¸Žä¼ è¾“ä¼˜åŒ–)
8. [æ–­ç‚¹ç»­ä¼ ä¸Žé”™è¯¯æ¢å¤](#8-æ–­ç‚¹ç»­ä¼ ä¸Žé”™è¯¯æ¢å¤)
9. [rsyncå®ˆæŠ¤è¿›ç¨‹æ¨¡å¼é…ç½®](#9-rsyncå®ˆæŠ¤è¿›ç¨‹æ¨¡å¼é…ç½®)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ðŸ”„ rsyncåŸºç¡€æ¦‚å¿µä¸Žå·¥ä½œåŽŸç†


### 1.1 ä»€ä¹ˆæ˜¯rsync


**rsync**æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ–‡ä»¶åŒæ­¥å·¥å…·ï¼Œå°±åƒæ˜¯"æ™ºèƒ½å¤åˆ¶ä¸“å®¶"ï¼Œèƒ½å¤Ÿé«˜æ•ˆåœ°åœ¨æœ¬åœ°æˆ–è¿œç¨‹ç³»ç»Ÿé—´åŒæ­¥æ–‡ä»¶ã€‚

> **ðŸ’¡ æ ¸å¿ƒç†è§£**
> rsync = **è¿œç¨‹åŒæ­¥** + **å¢žé‡ä¼ è¾“** + **æ ¡éªŒä¿éšœ**ï¼Œè§£å†³äº†ä¼ ç»Ÿcpå‘½ä»¤æ— æ³•å¤„ç†çš„å¤æ‚åŒæ­¥éœ€æ±‚

**ðŸ”¸ ä¼ ç»Ÿå¤åˆ¶ vs rsyncåŒæ­¥ï¼š**
```
ä¼ ç»Ÿcpå‘½ä»¤ï¼š
æ¯æ¬¡éƒ½å®Œæ•´å¤åˆ¶æ‰€æœ‰æ–‡ä»¶ï¼Œå³ä½¿æ–‡ä»¶æ²¡æœ‰å˜åŒ–

rsyncæ™ºèƒ½åŒæ­¥ï¼š
åªä¼ è¾“å‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶éƒ¨åˆ†ï¼Œå¤§å¹…èŠ‚çœæ—¶é—´å’Œå¸¦å®½
```

### 1.2 rsyncçš„æ ¸å¿ƒä¼˜åŠ¿


**âš¡ æ ¸å¿ƒç‰¹æ€§å¯¹æ¯”ï¼š**

| ç‰¹æ€§ | **ä¼ ç»Ÿå·¥å…·** | **rsync** | **å®žé™…æ„ä¹‰** |
|------|-------------|-----------|-------------|
| `å¢žé‡ä¼ è¾“` | âŒ å…¨é‡å¤åˆ¶ | âœ… åªä¼ è¾“å˜åŒ– | `èŠ‚çœ90%+ä¼ è¾“æ—¶é—´` |
| `æ–­ç‚¹ç»­ä¼ ` | âŒ é‡æ–°å¼€å§‹ | âœ… ä»Žæ–­ç‚¹ç»§ç»­ | `ç½‘ç»œä¸­æ–­ä¸æ€•` |
| `æƒé™ä¿æŒ` | âŒ å¯èƒ½ä¸¢å¤± | âœ… å®Œæ•´ä¿æŒ | `ç³»ç»Ÿè¿ç§»æ— å¿§` |
| `è¿œç¨‹åŒæ­¥` | âŒ éœ€è¦é¢å¤–é…ç½® | âœ… å†…ç½®æ”¯æŒ | `è·¨æœåŠ¡å™¨åŒæ­¥` |
| `å®žæ—¶æ ¡éªŒ` | âŒ æ— æ ¡éªŒ | âœ… å¤šé‡æ ¡éªŒ | `æ•°æ®å®Œæ•´æ€§ä¿éšœ` |

### 1.3 å…¸åž‹åº”ç”¨åœºæ™¯


**ðŸŽ¯ å®žé™…åº”ç”¨ç¤ºä¾‹ï¼š**
```
ç½‘ç«™å¤‡ä»½ï¼š
æ¯å¤©å¤‡ä»½ç½‘ç«™æ–‡ä»¶ï¼ŒåªåŒæ­¥ä¿®æ”¹è¿‡çš„å†…å®¹

ä»£ç åŒæ­¥ï¼š
å¼€å‘çŽ¯å¢ƒä¸Žç”Ÿäº§çŽ¯å¢ƒä»£ç åŒæ­¥

æ•°æ®è¿ç§»ï¼š
æœåŠ¡å™¨é—´å¤§é‡æ•°æ®è¿ç§»

ç›®å½•é•œåƒï¼š
ä¿æŒä¸¤ä¸ªç›®å½•å®Œå…¨ä¸€è‡´
```

---

## 2. âš™ï¸ rsyncç®—æ³•æœºåˆ¶æ·±åº¦è§£æž


### 2.1 rsyncç®—æ³•æ ¸å¿ƒæ€æƒ³


rsyncä½¿ç”¨**æ»šåŠ¨æ ¡éªŒå’Œç®—æ³•**æ¥è¯†åˆ«æ–‡ä»¶çš„å˜åŒ–éƒ¨åˆ†ï¼Œè¿™å°±åƒæ˜¯"æ–‡ä»¶æŒ‡çº¹è¯†åˆ«æŠ€æœ¯"ã€‚

> **ðŸ” ç®—æ³•æœ¬è´¨**
> ä¸ä¼ è¾“æ•´ä¸ªæ–‡ä»¶ï¼Œè€Œæ˜¯é€šè¿‡æ ¡éªŒå’Œæ¯”å¯¹ï¼Œåªä¼ è¾“å‘ç”Ÿå˜åŒ–çš„æ•°æ®å—

### 2.2 ç®—æ³•å·¥ä½œæµç¨‹


**ðŸ“Š rsyncåŒæ­¥æµç¨‹å›¾ï¼š**
```
æºç«¯                          ç›®æ ‡ç«¯
â”œâ”€â”€ æ–‡ä»¶A (1MB)              â”œâ”€â”€ æ–‡ä»¶A (æ—§ç‰ˆæœ¬)
â”œâ”€â”€ æ–‡ä»¶B (æ–°å¢ž)             â””â”€â”€ ç©ºç¼º
â””â”€â”€ æ–‡ä»¶C (åˆ é™¤)

ç¬¬1æ­¥ï¼šç›®æ ‡ç«¯å‘é€æ–‡ä»¶åˆ—è¡¨å’Œæ ¡éªŒå’Œ
æºç«¯ â†â”€â”€â”€â”€ [æ–‡ä»¶æ¸…å•+æ ¡éªŒå’Œ] â”€â”€â”€â”€ ç›®æ ‡ç«¯

ç¬¬2æ­¥ï¼šæºç«¯æ¯”è¾ƒæ ¡éªŒå’Œï¼Œè¯†åˆ«å·®å¼‚
æºç«¯è®¡ç®—ï¼šå“ªäº›æ–‡ä»¶éœ€è¦åŒæ­¥ï¼Ÿ

ç¬¬3æ­¥ï¼šåªä¼ è¾“å˜åŒ–çš„æ•°æ®å—
æºç«¯ â”€â”€â”€â”€ [å·®å¼‚æ•°æ®å—] â”€â”€â”€â”€â†’ ç›®æ ‡ç«¯

ç¬¬4æ­¥ï¼šç›®æ ‡ç«¯é‡å»ºå®Œæ•´æ–‡ä»¶
ç›®æ ‡ç«¯ï¼šæ—§æ•°æ®å— + æ–°æ•°æ®å— = å®Œæ•´æ–‡ä»¶
```

### 2.3 æ ¡éªŒå’Œç®—æ³•è¯¦è§£


**ðŸ” åŒé‡æ ¡éªŒæœºåˆ¶ï¼š**
```
å¼±æ ¡éªŒå’Œï¼ˆRolling Checksumï¼‰ï¼š
- å¿«é€Ÿè®¡ç®—ï¼Œç”¨äºŽåˆæ­¥ç­›é€‰
- 32ä½æ•´æ•°ï¼Œå¯èƒ½æœ‰å†²çª

å¼ºæ ¡éªŒå’Œï¼ˆMD5/SHA1ï¼‰ï¼š
- ç²¾ç¡®æ ¡éªŒï¼Œç¡®ä¿æ•°æ®å‡†ç¡®æ€§
- 128/160ä½ï¼Œå†²çªæ¦‚çŽ‡æžä½Ž

å·¥ä½œåŽŸç†ï¼š
å¼±æ ¡éªŒæ‰¾åˆ°å¯ç–‘æ•°æ®å— â†’ å¼ºæ ¡éªŒç¡®è®¤æ˜¯å¦çœŸçš„å˜åŒ–
```

---

## 3. ðŸŒ æœ¬åœ°åŒæ­¥ä¸Žè¿œç¨‹åŒæ­¥é…ç½®


### 3.1 åŸºæœ¬è¯­æ³•æ ¼å¼


**ðŸ“‹ rsyncå‘½ä»¤è¯­æ³•ï¼š**
```bash
# æœ¬åœ°åŒæ­¥
rsync [é€‰é¡¹] æºç›®å½• ç›®æ ‡ç›®å½•

# è¿œç¨‹åŒæ­¥ï¼ˆSSHæ–¹å¼ï¼‰
rsync [é€‰é¡¹] æºç›®å½• ç”¨æˆ·å@ä¸»æœºå:ç›®æ ‡ç›®å½•
rsync [é€‰é¡¹] ç”¨æˆ·å@ä¸»æœºå:æºç›®å½• ç›®æ ‡ç›®å½•
```

### 3.2 æœ¬åœ°åŒæ­¥å®žä¾‹


**ðŸ  æœ¬åœ°ç›®å½•åŒæ­¥ï¼š**
```bash
# åŸºç¡€åŒæ­¥ï¼ˆå¤åˆ¶æ–‡ä»¶å†…å®¹ï¼‰
rsync -av /home/source/ /backup/dest/

# å‚æ•°è§£é‡Šï¼š
# -a: å½’æ¡£æ¨¡å¼ï¼Œä¿æŒæ–‡ä»¶å±žæ€§
# -v: æ˜¾ç¤ºè¯¦ç»†è¿‡ç¨‹
# æ³¨æ„ï¼šæºç›®å½•åŽçš„ / å¾ˆé‡è¦ï¼
```

**âš ï¸ è·¯å¾„ç»†èŠ‚è¯´æ˜Žï¼š**
```bash
# æœ‰æ–œæ ï¼šåŒæ­¥ç›®å½•å†…å®¹
rsync -av /home/source/ /backup/
ç»“æžœï¼š/backup/file1, /backup/file2

# æ— æ–œæ ï¼šåŒæ­¥æ•´ä¸ªç›®å½•
rsync -av /home/source /backup/
ç»“æžœï¼š/backup/source/file1, /backup/source/file2
```

### 3.3 è¿œç¨‹åŒæ­¥é…ç½®


**ðŸŒ SSHæ–¹å¼è¿œç¨‹åŒæ­¥ï¼š**
```bash
# æŽ¨é€åˆ°è¿œç¨‹æœåŠ¡å™¨
rsync -avz /local/data/ user@server.com:/remote/backup/

# ä»Žè¿œç¨‹æœåŠ¡å™¨æ‹‰å–
rsync -avz user@server.com:/remote/data/ /local/backup/

# æŒ‡å®šSSHç«¯å£
rsync -avz -e "ssh -p 2222" /local/data/ user@server:/remote/
```

**ðŸ” å…å¯†ç åŒæ­¥è®¾ç½®ï¼š**
```bash
# 1. ç”ŸæˆSSHå¯†é’¥å¯¹
ssh-keygen -t rsa -b 4096

# 2. å¤åˆ¶å…¬é’¥åˆ°è¿œç¨‹æœåŠ¡å™¨
ssh-copy-id user@server.com

# 3. æµ‹è¯•å…å¯†ç ç™»å½•
ssh user@server.com

# 4. çŽ°åœ¨å¯ä»¥å…å¯†ç åŒæ­¥
rsync -avz /data/ user@server.com:/backup/
```

---

## 4. ðŸ“ˆ å¢žé‡ä¼ è¾“ä¸Žæ ¡éªŒå’Œè®¡ç®—


### 4.1 å¢žé‡ä¼ è¾“åŽŸç†


å¢žé‡ä¼ è¾“å°±åƒæ˜¯"æ™ºèƒ½æ›´æ–°"ï¼Œåªä¼ è¾“çœŸæ­£å‘ç”Ÿå˜åŒ–çš„éƒ¨åˆ†ã€‚

> **ðŸ’¡ ç”Ÿæ´»ç±»æ¯”**
> å°±åƒæ›´æ–°æ‰‹æœºåº”ç”¨ï¼Œä¸éœ€è¦é‡æ–°ä¸‹è½½æ•´ä¸ªAPPï¼Œåªä¸‹è½½å˜åŒ–çš„éƒ¨åˆ†

### 4.2 æ ¡éªŒå’Œè®¡ç®—è¿‡ç¨‹


**ðŸ” æ–‡ä»¶å˜åŒ–æ£€æµ‹æœºåˆ¶ï¼š**
```bash
# å¯ç”¨è¯¦ç»†æ ¡éªŒä¿¡æ¯
rsync -avz --progress --stats /source/ /dest/

è¾“å‡ºç¤ºä¾‹ï¼š
Number of files: 1,234
Number of files transferred: 45
Total file size: 2.3GB
Literal data: 125MB      â† å®žé™…ä¼ è¾“çš„æ•°æ®é‡
Matched data: 2.2GB      â† é€šè¿‡æ ¡éªŒå’ŒåŒ¹é…çš„æ•°æ®
File list size: 89KB
Total bytes sent: 125.1MB
Total bytes received: 1.2KB
```

### 4.3 æ ¡éªŒé€‰é¡¹è¯¦è§£


**ðŸ“Š æ ¡éªŒç›¸å…³å‚æ•°ï¼š**

| å‚æ•° | **ä½œç”¨** | **ä½¿ç”¨åœºæ™¯** | **æ€§èƒ½å½±å“** |
|------|----------|-------------|-------------|
| `--checksum` | åŸºäºŽå†…å®¹æ ¡éªŒ | ç²¾ç¡®åŒæ­¥ | è¾ƒæ…¢ä½†å‡†ç¡® |
| `--ignore-times` | å¿½ç•¥æ—¶é—´æˆ³ | å¼ºåˆ¶æ£€æŸ¥æ‰€æœ‰æ–‡ä»¶ | æ…¢ä½†å½»åº• |
| `--size-only` | ä»…æ¯”è¾ƒå¤§å° | å¿«é€ŸåŒæ­¥ | å¿«ä½†å¯èƒ½é—æ¼ |
| `--whole-file` | ä¼ è¾“å®Œæ•´æ–‡ä»¶ | æœ¬åœ°åŒæ­¥ | è·³è¿‡å¢žé‡ç®—æ³• |

**ðŸ”§ å®žè·µç¤ºä¾‹ï¼š**
```bash
# ç²¾ç¡®æ ¡éªŒï¼ˆæ…¢ä½†å‡†ç¡®ï¼‰
rsync -av --checksum /source/ /dest/

# å¿«é€ŸåŒæ­¥ï¼ˆä»…æ£€æŸ¥å¤§å°ï¼‰
rsync -av --size-only /source/ /dest/

# å¼ºåˆ¶æ£€æŸ¥æ‰€æœ‰æ–‡ä»¶
rsync -av --ignore-times /source/ /dest/
```

---

## 5. ðŸš« æŽ’é™¤è§„åˆ™ä¸ŽåŒ…å«æ¨¡å¼


### 5.1 æŽ’é™¤è§„åˆ™åŸºç¡€


æŽ’é™¤è§„åˆ™å°±æ˜¯å‘Šè¯‰rsync"å“ªäº›æ–‡ä»¶ä¸è¦åŒæ­¥"ï¼Œå°±åƒè®¾ç½®"é»‘åå•"ã€‚

> **ðŸŽ¯ å®žé™…éœ€æ±‚**
> åŒæ­¥ä»£ç æ—¶ä¸æƒ³åŒæ­¥ä¸´æ—¶æ–‡ä»¶ã€æ—¥å¿—æ–‡ä»¶ã€ç¼–è¯‘äº§ç‰©ç­‰

### 5.2 åŸºç¡€æŽ’é™¤è¯­æ³•


**ðŸ“‹ æŽ’é™¤è§„åˆ™è¯­æ³•ï¼š**
```bash
# æŽ’é™¤ç‰¹å®šæ–‡ä»¶
rsync -av --exclude="*.log" /source/ /dest/

# æŽ’é™¤å¤šä¸ªæ¨¡å¼
rsync -av --exclude="*.tmp" --exclude="*.cache" /source/ /dest/

# æŽ’é™¤ç‰¹å®šç›®å½•
rsync -av --exclude="temp/" /source/ /dest/

# ä»Žæ–‡ä»¶è¯»å–æŽ’é™¤è§„åˆ™
rsync -av --exclude-from="exclude.txt" /source/ /dest/
```

### 5.3 é«˜çº§æŽ’é™¤æ¨¡å¼


**ðŸ”§ å¤æ‚æŽ’é™¤è§„åˆ™ç¤ºä¾‹ï¼š**
```bash
# åˆ›å»ºæŽ’é™¤è§„åˆ™æ–‡ä»¶
cat > exclude.txt << 'EOF'
*.log
*.tmp
*.cache
.git/
node_modules/
__pycache__/
*.pyc
.DS_Store
Thumbs.db
/temp/
/build/
EOF

# ä½¿ç”¨æŽ’é™¤è§„åˆ™æ–‡ä»¶
rsync -av --exclude-from="exclude.txt" /project/ /backup/
```

### 5.4 åŒ…å«æ¨¡å¼é…ç½®


**âœ… åŒ…å«è§„åˆ™ï¼ˆç™½åå•æ¨¡å¼ï¼‰ï¼š**
```bash
# åªåŒæ­¥ç‰¹å®šç±»åž‹æ–‡ä»¶
rsync -av --include="*.txt" --exclude="*" /source/ /dest/

# å¤æ‚åŒ…å«/æŽ’é™¤ç»„åˆ
rsync -av \
  --include="*.conf" \
  --include="*.yaml" \
  --include="*/" \
  --exclude="*" \
  /config/ /backup/
```

**ðŸ“ è§„åˆ™ä¼˜å…ˆçº§è¯´æ˜Žï¼š**
```
è§„åˆ™åŒ¹é…é¡ºåºï¼šä»Žä¸Šåˆ°ä¸‹ï¼Œç¬¬ä¸€ä¸ªåŒ¹é…çš„è§„åˆ™ç”Ÿæ•ˆ

ç¤ºä¾‹ï¼š
--include="important.log"    â† ä¼˜å…ˆçº§é«˜
--exclude="*.log"           â† ä¼˜å…ˆçº§ä½Ž

ç»“æžœï¼šimportant.logä¼šè¢«åŒ…å«ï¼Œå…¶ä»–.logæ–‡ä»¶è¢«æŽ’é™¤
```

---

## 6. ðŸ—‘ï¸ åˆ é™¤ç­–ç•¥é…ç½®è¯¦è§£


### 6.1 åˆ é™¤ç­–ç•¥æ¦‚è¿°


åˆ é™¤ç­–ç•¥æŽ§åˆ¶å½“æºç›®å½•ä¸­æ–‡ä»¶è¢«åˆ é™¤æ—¶ï¼Œç›®æ ‡ç›®å½•æ˜¯å¦ä¹Ÿåˆ é™¤å¯¹åº”æ–‡ä»¶ã€‚

> **âš ï¸ é‡è¦æé†’**
> åˆ é™¤æ“ä½œä¸å¯é€†ï¼Œä½¿ç”¨å‰åŠ¡å¿…å¤‡ä»½é‡è¦æ•°æ®

### 6.2 åˆ é™¤å‚æ•°è¯¦è§£


**ðŸ—‚ï¸ åˆ é™¤ç›¸å…³å‚æ•°å¯¹æ¯”ï¼š**

| å‚æ•° | **ä½œç”¨** | **åˆ é™¤æ—¶æœº** | **å®‰å…¨æ€§** |
|------|----------|-------------|-----------|
| `--delete` | åˆ é™¤ç›®æ ‡ç«¯å¤šä½™æ–‡ä»¶ | ä¼ è¾“åŽåˆ é™¤ | ä¸­ç­‰ |
| `--delete-before` | ä¼ è¾“å‰å…ˆåˆ é™¤ | ä¼ è¾“å‰åˆ é™¤ | è¾ƒä½Ž |
| `--delete-after` | ä¼ è¾“åŽå†åˆ é™¤ | ä¼ è¾“åŽåˆ é™¤ | è¾ƒé«˜ |
| `--delete-during` | ä¼ è¾“è¿‡ç¨‹ä¸­åˆ é™¤ | ä¼ è¾“ä¸­åˆ é™¤ | ä¸­ç­‰ |
| `--delete-excluded` | åˆ é™¤è¢«æŽ’é™¤çš„æ–‡ä»¶ | æ ¹æ®æŽ’é™¤è§„åˆ™ | éœ€è°¨æ…Ž |

### 6.3 å®‰å…¨åˆ é™¤ç­–ç•¥


**ðŸ›¡ï¸ å®‰å…¨åˆ é™¤å®žè·µï¼š**
```bash
# 1. å…ˆé¢„è§ˆåˆ é™¤æ“ä½œï¼ˆä¸å®žé™…åˆ é™¤ï¼‰
rsync -av --delete --dry-run /source/ /dest/

# 2. ç¡®è®¤æ— è¯¯åŽå®žé™…æ‰§è¡Œ
rsync -av --delete /source/ /dest/

# 3. ä½¿ç”¨å¤‡ä»½ç›®å½•ä¿æŠ¤é‡è¦æ–‡ä»¶
rsync -av --delete --backup --backup-dir=/backup/deleted-$(date +%Y%m%d) \
  /source/ /dest/
```

### 6.4 åˆ é™¤ç­–ç•¥æœ€ä½³å®žè·µ


**ðŸ“‹ æŽ¨èåˆ é™¤é…ç½®ï¼š**
```bash
# ç”Ÿäº§çŽ¯å¢ƒæŽ¨èé…ç½®
rsync -av \
  --delete-after \          # ä¼ è¾“å®ŒæˆåŽåˆ é™¤
  --backup \                # åˆ é™¤å‰å¤‡ä»½
  --backup-dir=/backup/$(date +%Y%m%d-%H%M%S) \
  --exclude-from="exclude.txt" \
  /source/ /dest/

# å¼€å‘çŽ¯å¢ƒå¿«é€ŸåŒæ­¥
rsync -av --delete --delete-excluded /source/ /dest/
```

---

## 7. ðŸš€ å¸¦å®½é™åˆ¶ä¸Žä¼ è¾“ä¼˜åŒ–


### 7.1 å¸¦å®½é™åˆ¶é…ç½®


åœ¨ç½‘ç»œçŽ¯å¢ƒå—é™æˆ–éœ€è¦æŽ§åˆ¶ç½‘ç»œå ç”¨æ—¶ï¼Œå¸¦å®½é™åˆ¶éžå¸¸æœ‰ç”¨ã€‚

> **ðŸŒ å®žé™…åœºæ™¯**
> ç™½å¤©é™åˆ¶åŒæ­¥é€Ÿåº¦é¿å…å½±å“ä¸šåŠ¡ï¼Œå¤œé—´å…¨é€ŸåŒæ­¥

### 7.2 åŸºç¡€å¸¦å®½æŽ§åˆ¶


**âš¡ å¸¦å®½é™åˆ¶å‚æ•°ï¼š**
```bash
# é™åˆ¶å¸¦å®½ä¸º100KB/s
rsync -av --bwlimit=100 /source/ user@server:/dest/

# åŠ¨æ€è°ƒæ•´å¸¦å®½ï¼ˆä¸åŒæ—¶é—´æ®µï¼‰
# ç™½å¤©é™åˆ¶
rsync -av --bwlimit=50 /large-data/ /backup/

# å¤œé—´å…¨é€Ÿ
rsync -av /large-data/ /backup/
```

### 7.3 ä¼ è¾“ä¼˜åŒ–é…ç½®


**ðŸ”§ æ€§èƒ½ä¼˜åŒ–å‚æ•°ç»„åˆï¼š**
```bash
# é«˜æ•ˆä¼ è¾“é…ç½®
rsync -avz \
  --compress-level=6 \      # åŽ‹ç¼©çº§åˆ«ï¼ˆ1-9ï¼‰
  --partial \               # æ”¯æŒæ–­ç‚¹ç»­ä¼ 
  --progress \              # æ˜¾ç¤ºä¼ è¾“è¿›åº¦
  --bwlimit=1000 \          # å¸¦å®½é™åˆ¶1MB/s
  --timeout=300 \           # è¶…æ—¶è®¾ç½®5åˆ†é’Ÿ
  /large-files/ user@server:/backup/
```

**ðŸ“Š åŽ‹ç¼©çº§åˆ«é€‰æ‹©ï¼š**

| åŽ‹ç¼©çº§åˆ« | **åŽ‹ç¼©æ¯”** | **CPUå ç”¨** | **é€‚ç”¨åœºæ™¯** |
|---------|-----------|-------------|-------------|
| `1-3` | ä½Ž | ä½Ž | ç½‘ç»œè‰¯å¥½ï¼Œè¿½æ±‚é€Ÿåº¦ |
| `4-6` | ä¸­ç­‰ | ä¸­ç­‰ | å¹³è¡¡æ€§èƒ½å’Œå¸¦å®½ |
| `7-9` | é«˜ | é«˜ | ç½‘ç»œå—é™ï¼Œä¸åœ¨æ„CPU |

### 7.4 ç½‘ç»œä¼˜åŒ–å®žè·µ


**ðŸŒ ä¸åŒç½‘ç»œçŽ¯å¢ƒçš„ä¼˜åŒ–ç­–ç•¥ï¼š**
```bash
# æœ¬åœ°ç½‘ç»œï¼ˆé«˜é€Ÿï¼‰
rsync -av --whole-file /source/ /dest/

# äº’è”ç½‘ï¼ˆä¸­é€Ÿï¼‰
rsync -avz --compress-level=6 --partial /source/ user@server:/dest/

# æ…¢é€Ÿç½‘ç»œï¼ˆé™åˆ¶å¸¦å®½ï¼‰
rsync -avz --compress-level=9 --bwlimit=50 --partial \
  /source/ user@server:/dest/

# ä¸ç¨³å®šç½‘ç»œï¼ˆå¢žå¼ºå®¹é”™ï¼‰
rsync -avz --partial --timeout=60 --contimeout=10 \
  /source/ user@server:/dest/
```

---

## 8. ðŸ”„ æ–­ç‚¹ç»­ä¼ ä¸Žé”™è¯¯æ¢å¤


### 8.1 æ–­ç‚¹ç»­ä¼ æœºåˆ¶


æ–­ç‚¹ç»­ä¼ è®©å¤§æ–‡ä»¶ä¼ è¾“åœ¨ç½‘ç»œä¸­æ–­åŽèƒ½å¤Ÿä»Žæ–­ç‚¹ç»§ç»­ï¼Œè€Œä¸æ˜¯é‡æ–°å¼€å§‹ã€‚

> **ðŸ’¡ å·¥ä½œåŽŸç†**
> rsyncä¼šä¿å­˜å·²ä¼ è¾“çš„éƒ¨åˆ†ï¼Œç½‘ç»œæ¢å¤åŽè‡ªåŠ¨ä»Žä¸­æ–­ç‚¹ç»§ç»­ä¼ è¾“

### 8.2 æ–­ç‚¹ç»­ä¼ é…ç½®


**ðŸ”„ æ–­ç‚¹ç»­ä¼ å‚æ•°ï¼š**
```bash
# åŸºç¡€æ–­ç‚¹ç»­ä¼ 
rsync -av --partial /large-files/ user@server:/backup/

# å®Œæ•´æ–­ç‚¹ç»­ä¼ é…ç½®
rsync -avz \
  --partial \               # ä¿ç•™éƒ¨åˆ†ä¼ è¾“çš„æ–‡ä»¶
  --partial-dir=/tmp/rsync \# æŒ‡å®šéƒ¨åˆ†æ–‡ä»¶å­˜æ”¾ç›®å½•
  --timeout=300 \           # ç½‘ç»œè¶…æ—¶æ—¶é—´
  /source/ user@server:/dest/
```

### 8.3 é”™è¯¯æ¢å¤ç­–ç•¥


**ðŸ› ï¸ å¥å£®æ€§é…ç½®ï¼š**
```bash
# å®Œæ•´çš„å®¹é”™é…ç½®
rsync -avz \
  --partial \               # æ–­ç‚¹ç»­ä¼ 
  --timeout=60 \            # æ•°æ®ä¼ è¾“è¶…æ—¶
  --contimeout=10 \         # è¿žæŽ¥è¶…æ—¶
  --tries=3 \               # é‡è¯•æ¬¡æ•°
  --delay-updates \         # å»¶è¿Ÿæ›´æ–°ï¼Œç¡®ä¿åŽŸå­æ€§
  --temp-dir=/tmp/rsync \   # ä¸´æ—¶ç›®å½•
  /critical-data/ user@server:/backup/
```

### 8.4 ä¼ è¾“ç›‘æŽ§ä¸Žæ—¥å¿—


**ðŸ“Š ä¼ è¾“è¿‡ç¨‹ç›‘æŽ§ï¼š**
```bash
# è¯¦ç»†è¿›åº¦æ˜¾ç¤º
rsync -avz --progress --stats \
  /large-dataset/ user@server:/backup/

è¾“å‡ºç¤ºä¾‹ï¼š
backup-file.tar.gz
    2,147,483,648   48%  123.45MB/s    0:01:25

Number of files: 156
Number of files transferred: 12
Total file size: 8.5GB
Literal data: 2.3GB
Matched data: 6.2GB
File list size: 4.5KB
Total bytes sent: 2.31GB
```

---

## 9. ðŸ‘¥ rsyncå®ˆæŠ¤è¿›ç¨‹æ¨¡å¼é…ç½®


### 9.1 å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼æ¦‚è¿°


rsyncå®ˆæŠ¤è¿›ç¨‹æ¨¡å¼å…è®¸rsyncä½œä¸ºæœåŠ¡è¿è¡Œï¼Œæä¾›æŒç»­çš„åŒæ­¥æœåŠ¡ã€‚

> **ðŸ—ï¸ æœåŠ¡æž¶æž„**
> å®¢æˆ·ç«¯ â† ç½‘ç»œè¿žæŽ¥ â†’ rsyncæœåŠ¡å™¨ï¼ˆå®ˆæŠ¤è¿›ç¨‹ï¼‰

### 9.2 æœåŠ¡ç«¯é…ç½®


**ðŸ“ åˆ›å»ºrsyncé…ç½®æ–‡ä»¶ï¼š**
```bash
# åˆ›å»ºé…ç½®æ–‡ä»¶ /etc/rsyncd.conf
cat > /etc/rsyncd.conf << 'EOF'
# å…¨å±€é…ç½®
uid = rsync
gid = rsync
use chroot = yes
max connections = 10
lock file = /var/run/rsync.lock
log file = /var/log/rsyncd.log
pid file = /var/run/rsyncd.pid

# æ¨¡å—é…ç½®
[backup]
    path = /data/backup
    comment = Backup module
    read only = no
    list = yes
    uid = rsync
    gid = rsync
    auth users = backup_user
    secrets file = /etc/rsync.password
    hosts allow = 192.168.1.0/24
    hosts deny = *

[web-files]
    path = /var/www
    comment = Web files
    read only = yes
    list = yes
    uid = www-data
    gid = www-data
EOF
```

### 9.3 ç”¨æˆ·è®¤è¯é…ç½®


**ðŸ” å¯†ç æ–‡ä»¶é…ç½®ï¼š**
```bash
# åˆ›å»ºå¯†ç æ–‡ä»¶ï¼ˆæœåŠ¡ç«¯ï¼‰
echo "backup_user:SecurePassword123" > /etc/rsync.password
chmod 600 /etc/rsync.password

# åˆ›å»ºç”¨æˆ·
useradd -r -s /sbin/nologin rsync

# å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹
rsync --daemon
```

### 9.4 å®¢æˆ·ç«¯è¿žæŽ¥é…ç½®


**ðŸ”— å®¢æˆ·ç«¯è¿žæŽ¥ç¤ºä¾‹ï¼š**
```bash
# åˆ›å»ºå®¢æˆ·ç«¯å¯†ç æ–‡ä»¶
echo "SecurePassword123" > /etc/rsync_client.password
chmod 600 /etc/rsync_client.password

# è¿žæŽ¥åˆ°rsyncæœåŠ¡å™¨
rsync -avz --password-file=/etc/rsync_client.password \
  /local/data/ backup_user@rsync-server::backup

# ä»ŽrsyncæœåŠ¡å™¨åŒæ­¥
rsync -avz --password-file=/etc/rsync_client.password \
  backup_user@rsync-server::web-files /local/web-backup/
```

### 9.5 æœåŠ¡ç®¡ç†


**âš™ï¸ å®ˆæŠ¤è¿›ç¨‹æœåŠ¡ç®¡ç†ï¼š**
```bash
# åˆ›å»ºsystemdæœåŠ¡æ–‡ä»¶
cat > /etc/systemd/system/rsyncd.service << 'EOF'
[Unit]
Description=rsync daemon
After=network.target

[Service]
Type=forking
ExecStart=/usr/bin/rsync --daemon
ExecReload=/bin/kill -HUP $MAINPID
KillMode=process
Restart=on-failure

[Install]
WantedBy=multi-user.target
EOF

# å¯ç”¨å¹¶å¯åŠ¨æœåŠ¡
systemctl enable rsyncd
systemctl start rsyncd

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
systemctl status rsyncd
```

---

## 10. ðŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŽŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ðŸ”¸ rsyncæ ¸å¿ƒï¼šå¢žé‡åŒæ­¥ + æ ¡éªŒä¿éšœ + è¿œç¨‹ä¼ è¾“
ðŸ”¸ ç®—æ³•æœºåˆ¶ï¼šæ»šåŠ¨æ ¡éªŒå’Œ + æ•°æ®å—å·®å¼‚ä¼ è¾“
ðŸ”¸ åŒæ­¥æ¨¡å¼ï¼šæœ¬åœ°åŒæ­¥ã€SSHè¿œç¨‹åŒæ­¥ã€å®ˆæŠ¤è¿›ç¨‹åŒæ­¥
ðŸ”¸ å…³é”®å‚æ•°ï¼š-aå½’æ¡£ã€-vè¯¦ç»†ã€-zåŽ‹ç¼©ã€--deleteåˆ é™¤
ðŸ”¸ å®‰å…¨ç‰¹æ€§ï¼šæ–­ç‚¹ç»­ä¼ ã€é”™è¯¯æ¢å¤ã€æƒé™ä¿æŒ
```

### 10.2 å®žé™…åº”ç”¨è¦ç‚¹


**ðŸ”¹ æ—¥å¸¸ä½¿ç”¨è®°å¿†ï¼š**
```
åŸºç¡€åŒæ­¥ï¼šrsync -av æº/ ç›®æ ‡/
è¿œç¨‹åŒæ­¥ï¼šrsync -avz æº/ ç”¨æˆ·@ä¸»æœº:ç›®æ ‡/
å®‰å…¨åˆ é™¤ï¼šå…ˆ--dry-runé¢„è§ˆï¼Œå†å®žé™…æ‰§è¡Œ
å¸¦å®½æŽ§åˆ¶ï¼š--bwlimit=é€Ÿåº¦ï¼ˆKB/sï¼‰
æ–­ç‚¹ç»­ä¼ ï¼š--partialå‚æ•°
```

**ðŸ”¹ å‚æ•°ç»„åˆæŽ¨èï¼š**
```
æ—¥å¸¸å¤‡ä»½ï¼š-avz --delete --partial
ç”Ÿäº§åŒæ­¥ï¼š-avz --delete-after --backup
å¤§æ–‡ä»¶ä¼ è¾“ï¼š-avz --partial --progress --bwlimit=1000
ç½‘ç»œä¸ç¨³å®šï¼š-avz --partial --timeout=60 --tries=3
```

### 10.3 æœ€ä½³å®žè·µæ€»ç»“


**âš¡ é«˜æ•ˆä½¿ç”¨ç­–ç•¥ï¼š**
- **æµ‹è¯•ä¼˜å…ˆ**ï¼šé‡è¦æ“ä½œå‰ç”¨`--dry-run`é¢„è§ˆ
- **é€æ­¥å®žæ–½**ï¼šå…ˆå°èŒƒå›´æµ‹è¯•ï¼Œå†å¤§è§„æ¨¡éƒ¨ç½²
- **ç›‘æŽ§ä¼ è¾“**ï¼šä½¿ç”¨`--progress`å’Œ`--stats`ç›‘æŽ§è¿‡ç¨‹
- **å®‰å…¨åˆ é™¤**ï¼šä½¿ç”¨`--backup`åœ¨åˆ é™¤å‰å¤‡ä»½
- **ç½‘ç»œä¼˜åŒ–**ï¼šæ ¹æ®ç½‘ç»œçŽ¯å¢ƒè°ƒæ•´åŽ‹ç¼©å’Œå¸¦å®½é™åˆ¶

**ðŸŽ¯ æ•…éšœæŽ’é™¤æ€è·¯ï¼š**
```
ä¼ è¾“ä¸­æ–­ï¼šæ£€æŸ¥ç½‘ç»œè¿žæŽ¥å’Œè¶…æ—¶è®¾ç½®
æƒé™é”™è¯¯ï¼šç¡®è®¤ç”¨æˆ·æƒé™å’Œç›®å½•è®¿é—®æƒé™
é€Ÿåº¦ç¼“æ…¢ï¼šè°ƒæ•´åŽ‹ç¼©çº§åˆ«å’Œå¸¦å®½é™åˆ¶
ç©ºé—´ä¸è¶³ï¼šæ£€æŸ¥ç›®æ ‡ç›®å½•ç£ç›˜ç©ºé—´
åŒæ­¥ä¸å®Œæ•´ï¼šæ£€æŸ¥æŽ’é™¤è§„åˆ™å’Œåˆ é™¤ç­–ç•¥
```

**ðŸ’¡ æ ¸å¿ƒè®°å¿†å£è¯€ï¼š**
- rsyncå¢žé‡ä¼ è¾“çœæ—¶é—´ï¼Œæ ¡éªŒç®—æ³•ä¿å®‰å…¨
- æœ¬åœ°è¿œç¨‹éšæ„åˆ‡ï¼ŒæŽ’é™¤åŒ…å«è§„åˆ™å…¨
- åˆ é™¤ç­–ç•¥è¦è°¨æ…Žï¼Œå¤‡ä»½é¢„è§ˆæ˜¯å…³é”®
- æ–­ç‚¹ç»­ä¼ ç½‘ç»œå¼ºï¼Œå®ˆæŠ¤è¿›ç¨‹æœåŠ¡æ£’