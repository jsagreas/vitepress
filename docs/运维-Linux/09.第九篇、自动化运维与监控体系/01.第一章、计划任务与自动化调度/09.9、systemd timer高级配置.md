---
title: 9ã€systemd timeré«˜çº§é…ç½®
---
## ğŸ“š ç›®å½•

1. [systemd timeråŸºç¡€å›é¡¾](#1-systemd-timeråŸºç¡€å›é¡¾)
2. [systemctl timerå‘½ä»¤ç®¡ç†](#2-systemctl-timerå‘½ä»¤ç®¡ç†)
3. [systemctl list-timersæŸ¥çœ‹è¯¦è§£](#3-systemctl-list-timersæŸ¥çœ‹è¯¦è§£)
4. [timeræ—¥å¿—æŸ¥çœ‹ä¸åˆ†æ](#4-timeræ—¥å¿—æŸ¥çœ‹ä¸åˆ†æ)
5. [å¤šä¸ªtimeråè°ƒé…ç½®](#5-å¤šä¸ªtimeråè°ƒé…ç½®)
6. [timerä¾èµ–å…³ç³»è®¾ç½®](#6-timerä¾èµ–å…³ç³»è®¾ç½®)
7. [åŠ¨æ€timeråˆ›å»ºä¸åˆ é™¤](#7-åŠ¨æ€timeråˆ›å»ºä¸åˆ é™¤)
8. [timerçŠ¶æ€ç›‘æ§](#8-timerçŠ¶æ€ç›‘æ§)
9. [timeræ•…éšœæ’æŸ¥](#9-timeræ•…éšœæ’æŸ¥)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”„ systemd timeråŸºç¡€å›é¡¾


### 1.1 ä»€ä¹ˆæ˜¯systemd timer


**ğŸ“‹ æ ¸å¿ƒæ¦‚å¿µ**
> systemd timeræ˜¯ç°ä»£Linuxç³»ç»Ÿä¸­çš„**å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨**ï¼Œç”¨æ¥æ›¿ä»£ä¼ ç»Ÿçš„cronã€‚å®ƒä¸æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºï¼Œè€Œæ˜¯systemdç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œé€šè¿‡`.timer`é…ç½®æ–‡ä»¶æ¥å®šä¹‰ä½•æ—¶æ‰§è¡ŒæŸä¸ªæœåŠ¡ã€‚

```
ä¼ ç»Ÿæ–¹å¼å¯¹æ¯”ï¼š
cron:     ç”¨æˆ· â†’ crontab â†’ crondå®ˆæŠ¤è¿›ç¨‹ â†’ æ‰§è¡Œä»»åŠ¡
systemd:  ç”¨æˆ· â†’ .timeræ–‡ä»¶ â†’ systemd â†’ å¯åŠ¨service â†’ æ‰§è¡Œä»»åŠ¡

ä¼˜åŠ¿ç®€å•è¯´ï¼š
âœ… æ›´å¥½çš„æ—¥å¿—è®°å½•
âœ… ä¾èµ–å…³ç³»ç®¡ç†  
âœ… èµ„æºæ§åˆ¶
âœ… æ•…éšœæ¢å¤æœºåˆ¶
```

### 1.2 timerå·¥ä½œåŸç†


**ğŸ”§ å·¥ä½œæœºåˆ¶**
```
å·¥ä½œæµç¨‹å›¾ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   .timer    â”‚â”€â”€â”€â–¶â”‚   systemd   â”‚â”€â”€â”€â–¶â”‚   .service  â”‚
â”‚  é…ç½®æ–‡ä»¶    â”‚    â”‚   è°ƒåº¦å™¨    â”‚    â”‚   å®é™…ä»»åŠ¡   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å®é™…æ‰§è¡Œè¿‡ç¨‹ï¼š
1. systemdè¯»å–.timeræ–‡ä»¶
2. æ ¹æ®æ—¶é—´è§„åˆ™è®¡ç®—ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´
3. åˆ°æ—¶é—´åå¯åŠ¨å¯¹åº”çš„.service
4. serviceæ‰§è¡Œå®Œæ¯•åè®°å½•ç»“æœ
5. æ ¹æ®é…ç½®å†³å®šæ˜¯å¦é‡å¤æ‰§è¡Œ
```

---

## 2. âš™ï¸ systemctl timerå‘½ä»¤ç®¡ç†


### 2.1 åŸºç¡€å‘½ä»¤æ“ä½œ


**ğŸ¯ å¯åŠ¨åœæ­¢timer**
```bash
# å¯åŠ¨timerï¼ˆä¸€æ¬¡æ€§ï¼‰
systemctl start backup.timer

# åœæ­¢timer  
systemctl stop backup.timer

# é‡å¯timer
systemctl restart backup.timer

# é‡æ–°åŠ è½½é…ç½®ï¼ˆä¸ä¸­æ–­è¿è¡Œï¼‰
systemctl reload backup.timer
```

> ğŸ’¡ **é‡è¦æé†’**ï¼šå¯åŠ¨timerä¸ç­‰äºå¯åŠ¨serviceï¼timeråªæ˜¯è°ƒåº¦å™¨ï¼Œå®ƒä¼šåœ¨æŒ‡å®šæ—¶é—´è‡ªåŠ¨å¯åŠ¨å¯¹åº”çš„serviceã€‚

### 2.2 å¼€æœºè‡ªå¯åŠ¨ç®¡ç†


**ğŸ”„ æ°¸ä¹…æ€§é…ç½®**
```bash
# è®¾ç½®å¼€æœºè‡ªå¯åŠ¨
systemctl enable backup.timer
# Created symlink /etc/systemd/system/timers.target.wants/backup.timer

# å–æ¶ˆå¼€æœºè‡ªå¯åŠ¨  
systemctl disable backup.timer

# ä¸€æ­¥åˆ°ä½ï¼šå¯åŠ¨å¹¶è®¾ç½®è‡ªå¯åŠ¨
systemctl enable --now backup.timer

# æ£€æŸ¥æ˜¯å¦å·²è®¾ç½®è‡ªå¯åŠ¨
systemctl is-enabled backup.timer
# enabled è¡¨ç¤ºå·²è®¾ç½®è‡ªå¯åŠ¨
# disabled è¡¨ç¤ºæœªè®¾ç½®è‡ªå¯åŠ¨
```

### 2.3 timerçŠ¶æ€æŸ¥è¯¢


**ğŸ“Š çŠ¶æ€ä¿¡æ¯æŸ¥çœ‹**
```bash
# æŸ¥çœ‹timerè¯¦ç»†çŠ¶æ€
systemctl status backup.timer

# è¾“å‡ºç¤ºä¾‹ï¼š
â— backup.timer - Daily Backup Timer
   Loaded: loaded (/etc/systemd/system/backup.timer; enabled; vendor preset: disabled)
   Active: active (waiting) since Mon 2025-01-17 09:00:00 CST; 5h 23min ago
  Trigger: Tue 2025-01-18 02:00:00 CST; 11h left
 Triggers: â— backup.service

Jan 17 09:00:00 server systemd[1]: Started Daily Backup Timer.
```

**ğŸ” çŠ¶æ€ä¿¡æ¯è§£è¯»**
- **Loaded**: timeræ–‡ä»¶å·²åŠ è½½ï¼Œenabledè¡¨ç¤ºå¼€æœºè‡ªå¯åŠ¨
- **Active**: `active (waiting)`è¡¨ç¤ºtimeræ­£åœ¨ç­‰å¾…è§¦å‘æ—¶é—´
- **Trigger**: ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´
- **Triggers**: è¿™ä¸ªtimerä¼šè§¦å‘å“ªä¸ªservice

---

## 3. ğŸ“‹ systemctl list-timersæŸ¥çœ‹è¯¦è§£


### 3.1 åŸºæœ¬åˆ—è¡¨æŸ¥çœ‹


**ğŸ“Š æŸ¥çœ‹æ‰€æœ‰timer**
```bash
# æŸ¥çœ‹æ‰€æœ‰æ´»è·ƒçš„timer
systemctl list-timers

# è¾“å‡ºç¤ºä¾‹ï¼š
NEXT                          LEFT       LAST                          PASSED     UNIT                         ACTIVATES
Tue 2025-01-18 02:00:00 CST   10h left   Mon 2025-01-17 02:00:00 CST   13h ago    backup.timer                 backup.service
Tue 2025-01-18 06:30:00 CST   15h left   Mon 2025-01-17 06:30:00 CST   9h ago     logrotate.timer              logrotate.service
```

**ğŸ” åˆ—è¡¨ä¿¡æ¯è§£è¯»**
- **NEXT**: ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´
- **LEFT**: è·ç¦»ä¸‹æ¬¡æ‰§è¡Œè¿˜æœ‰å¤šé•¿æ—¶é—´
- **LAST**: ä¸Šæ¬¡æ‰§è¡Œæ—¶é—´  
- **PASSED**: è·ç¦»ä¸Šæ¬¡æ‰§è¡Œè¿‡äº†å¤šé•¿æ—¶é—´
- **UNIT**: timerå•å…ƒåç§°
- **ACTIVATES**: è¯¥timerä¼šæ¿€æ´»çš„service

### 3.2 è¯¦ç»†ä¿¡æ¯æŸ¥çœ‹


**ğŸ“ˆ æŸ¥çœ‹æ‰€æœ‰timerï¼ˆåŒ…æ‹¬ä¸æ´»è·ƒçš„ï¼‰**
```bash
# æŸ¥çœ‹æ‰€æœ‰timerï¼ŒåŒ…æ‹¬å·²åœç”¨çš„
systemctl list-timers --all

# åªæŸ¥çœ‹å¤±è´¥çš„timer
systemctl list-timers --failed

# æŒ‰æ—¶é—´æ’åºæŸ¥çœ‹
systemctl list-timers --sort=next
```

### 3.3 ç­›é€‰ç‰¹å®štimer


**ğŸ¯ é’ˆå¯¹æ€§æŸ¥çœ‹**
```bash
# æŸ¥çœ‹åç§°åŒ…å«"backup"çš„timer
systemctl list-timers | grep backup

# æŸ¥çœ‹ç‰¹å®štimerçš„ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´
systemctl list-timers backup.timer

# ä½¿ç”¨é€šé…ç¬¦æŸ¥çœ‹å¤šä¸ªç›¸å…³timer
systemctl list-timers 'backup*.timer'
```

---

## 4. ğŸ“ timeræ—¥å¿—æŸ¥çœ‹ä¸åˆ†æ


### 4.1 journalctlæŸ¥çœ‹timeræ—¥å¿—


**ğŸ“Š åŸºç¡€æ—¥å¿—æŸ¥çœ‹**
```bash
# æŸ¥çœ‹ç‰¹å®štimerçš„æ—¥å¿—
journalctl -u backup.timer

# æŸ¥çœ‹timerç›¸å…³serviceçš„æ—¥å¿—
journalctl -u backup.service

# åŒæ—¶æŸ¥çœ‹timerå’Œserviceæ—¥å¿—
journalctl -u backup.timer -u backup.service
```

### 4.2 æ—¥å¿—ç­›é€‰æŠ€å·§


**ğŸ” é«˜æ•ˆæ—¥å¿—åˆ†æ**
```bash
# æŸ¥çœ‹æœ€è¿‘çš„æ—¥å¿—ï¼ˆæœ€å10æ¡ï¼‰
journalctl -u backup.timer -n 10

# å®æ—¶ç›‘æ§æ—¥å¿—
journalctl -u backup.timer -f

# æŸ¥çœ‹ä»Šå¤©çš„æ—¥å¿—
journalctl -u backup.timer --since today

# æŸ¥çœ‹ç‰¹å®šæ—¶é—´æ®µçš„æ—¥å¿—
journalctl -u backup.timer --since "2025-01-17 00:00:00" --until "2025-01-17 23:59:59"

# æŸ¥çœ‹æœ€è¿‘ä¸€å°æ—¶çš„æ—¥å¿—
journalctl -u backup.timer --since "1 hour ago"
```

### 4.3 æ—¥å¿—å†…å®¹åˆ†æ


**ğŸ“‹ å…¸å‹æ—¥å¿—å†…å®¹è§£è¯»**
```bash
# æ­£å¸¸å¯åŠ¨çš„æ—¥å¿—
Jan 17 02:00:00 server systemd[1]: Started Daily Backup Timer.
Jan 17 02:00:00 server systemd[1]: backup.timer: Succeeded.

# Timerè§¦å‘serviceçš„æ—¥å¿—
Jan 17 02:00:01 server systemd[1]: Starting Daily Backup Service...
Jan 17 02:00:01 server systemd[1]: backup.service: Succeeded.
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**ï¼štimerçš„æ—¥å¿—é€šå¸¸æ¯”è¾ƒç®€æ´ï¼Œä¸»è¦è®°å½•å¯åŠ¨åœæ­¢ã€‚çœŸæ­£çš„ä»»åŠ¡æ‰§è¡Œæ—¥å¿—è¦çœ‹å¯¹åº”çš„serviceæ—¥å¿—ã€‚

---

## 5. ğŸ”„ å¤šä¸ªtimeråè°ƒé…ç½®


### 5.1 æ—¶é—´é”™å¼€æ‰§è¡Œ


**â° é¿å…èµ„æºç«äº‰**
```bash
# ç¤ºä¾‹ï¼šä¸‰ä¸ªå¤‡ä»½ä»»åŠ¡é”™å¼€æ‰§è¡Œ
# /etc/systemd/system/backup-db.timer
[Timer]
OnCalendar=*-*-* 02:00:00
Persistent=true

# /etc/systemd/system/backup-web.timer  
[Timer]
OnCalendar=*-*-* 02:30:00
Persistent=true

# /etc/systemd/system/backup-logs.timer
[Timer]
OnCalendar=*-*-* 03:00:00
Persistent=true
```

### 5.2 æ¡ä»¶æ‰§è¡Œé…ç½®


**ğŸ¯ æ™ºèƒ½è°ƒåº¦**
```bash
# backup-secondary.timer - åªåœ¨ä¸»å¤‡ä»½æˆåŠŸåè¿è¡Œ
[Unit]
Description=Secondary Backup Timer
Requires=backup-primary.service
After=backup-primary.service

[Timer]
OnCalendar=*-*-* 04:00:00
Persistent=true

[Install]
WantedBy=timers.target
```

### 5.3 æ‰¹é‡ç®¡ç†å¤šä¸ªtimer


**âš™ï¸ ç»Ÿä¸€æ“ä½œ**
```bash
# åŒæ—¶å¯åŠ¨å¤šä¸ªtimer
systemctl start backup-db.timer backup-web.timer backup-logs.timer

# ä½¿ç”¨targetæ¥æ‰¹é‡ç®¡ç†
# /etc/systemd/system/backup-all.target
[Unit]
Description=All Backup Timers
Wants=backup-db.timer
Wants=backup-web.timer  
Wants=backup-logs.timer

# é€šè¿‡targetç»Ÿä¸€ç®¡ç†
systemctl start backup-all.target
```

---

## 6. ğŸ”— timerä¾èµ–å…³ç³»è®¾ç½®


### 6.1 åŸºæœ¬ä¾èµ–é…ç½®


**ğŸ“‹ ä¾èµ–å…³ç³»ç±»å‹**
```
Requires=    å¼ºä¾èµ–ï¼Œä¾èµ–é¡¹å¤±è´¥åˆ™å½“å‰å•å…ƒä¹Ÿå¤±è´¥
Wants=       å¼±ä¾èµ–ï¼Œä¾èµ–é¡¹å¤±è´¥ä¸å½±å“å½“å‰å•å…ƒ
After=       é¡ºåºä¾èµ–ï¼Œåœ¨æŒ‡å®šå•å…ƒä¹‹åå¯åŠ¨
Before=      é¡ºåºä¾èµ–ï¼Œåœ¨æŒ‡å®šå•å…ƒä¹‹å‰å¯åŠ¨
```

### 6.2 å®é™…é…ç½®ç¤ºä¾‹


**ğŸ”§ æ•°æ®åº“å¤‡ä»½ä¾èµ–é…ç½®**
```bash
# /etc/systemd/system/db-backup.timer
[Unit]
Description=Database Backup Timer
# ä¾èµ–æ•°æ®åº“æœåŠ¡è¿è¡Œ
Wants=mysql.service
After=mysql.service
# ç¡®ä¿ç½‘ç»œå¯ç”¨
After=network.target

[Timer]
OnCalendar=daily
RandomizedDelaySec=600
Persistent=true

[Install]
WantedBy=timers.target
```

### 6.3 æ¡ä»¶æ‰§è¡Œé…ç½®


**ğŸ¯ æ¡ä»¶è§¦å‘**
```bash
# /etc/systemd/system/cleanup.timer
[Unit]
Description=System Cleanup Timer
# åªåœ¨ç³»ç»Ÿè´Ÿè½½ä¸é«˜æ—¶è¿è¡Œ
ConditionLoadAverage=|0.0 2.0
# åªåœ¨ç£ç›˜ä½¿ç”¨ç‡ä¸è¶…è¿‡80%æ—¶è¿è¡Œ  
ConditionPathExists=!/tmp/high-disk-usage

[Timer]
OnCalendar=*-*-* 01:00:00
Persistent=true

[Install]
WantedBy=timers.target
```

---

## 7. ğŸš€ åŠ¨æ€timeråˆ›å»ºä¸åˆ é™¤


### 7.1 è¿è¡Œæ—¶åˆ›å»ºtimer


**âš¡ ä¸´æ—¶timeråˆ›å»º**
```bash
# åˆ›å»ºä¸´æ—¶timerï¼ˆç³»ç»Ÿé‡å¯åæ¶ˆå¤±ï¼‰
systemd-run --on-calendar="*:0/10" --timer-property="Description=Temp Test Timer" \
            /usr/bin/echo "Hello from temp timer"

# è¾“å‡ºä¼šæ˜¾ç¤ºåˆ›å»ºçš„timeråç§°ï¼Œç±»ä¼¼ï¼š
# Running timer as unit: run-r6c8c8b8c8f7d4b9bb2a0f7d3e9a4c5b6.timer

# æŸ¥çœ‹åˆ›å»ºçš„ä¸´æ—¶timer
systemctl list-timers | grep run-
```

### 7.2 ç¨‹åºåŒ–åˆ›å»ºtimeræ–‡ä»¶


**ğŸ”§ è„šæœ¬åˆ›å»ºtimer**
```bash
#!/bin/bash
# create-backup-timer.sh

TIMER_NAME="$1"
SCHEDULE="$2"
COMMAND="$3"

if [[ -z "$TIMER_NAME" || -z "$SCHEDULE" || -z "$COMMAND" ]]; then
    echo "Usage: $0 <timer_name> <schedule> <command>"
    echo "Example: $0 mybackup daily '/usr/local/bin/backup.sh'"
    exit 1
fi

# åˆ›å»ºserviceæ–‡ä»¶
cat > "/etc/systemd/system/${TIMER_NAME}.service" << EOF
[Unit]
Description=${TIMER_NAME} Service

[Service]
Type=oneshot
ExecStart=${COMMAND}
EOF

# åˆ›å»ºtimeræ–‡ä»¶
cat > "/etc/systemd/system/${TIMER_NAME}.timer" << EOF
[Unit]
Description=${TIMER_NAME} Timer

[Timer]
OnCalendar=${SCHEDULE}
Persistent=true

[Install]
WantedBy=timers.target
EOF

# é‡æ–°åŠ è½½systemdé…ç½®
systemctl daemon-reload

# å¯åŠ¨å¹¶å¯ç”¨timer
systemctl enable --now "${TIMER_NAME}.timer"

echo "Timer ${TIMER_NAME} created and started successfully!"
```

### 7.3 åˆ é™¤timer


**ğŸ—‘ï¸ æ¸…ç†timer**
```bash
#!/bin/bash
# remove-timer.sh

TIMER_NAME="$1"

# åœæ­¢å¹¶ç¦ç”¨timer
systemctl disable --now "${TIMER_NAME}.timer"

# åˆ é™¤æ–‡ä»¶
rm -f "/etc/systemd/system/${TIMER_NAME}.timer"
rm -f "/etc/systemd/system/${TIMER_NAME}.service"

# é‡æ–°åŠ è½½é…ç½®
systemctl daemon-reload

echo "Timer ${TIMER_NAME} removed successfully!"
```

---

## 8. ğŸ“Š timerçŠ¶æ€ç›‘æ§


### 8.1 ç³»ç»Ÿç›‘æ§è„šæœ¬


**ğŸ” timerå¥åº·æ£€æŸ¥**
```bash
#!/bin/bash
# timer-monitor.sh

echo "=== Timer Status Report ==="
echo "Generated at: $(date)"
echo

# æ£€æŸ¥æ´»è·ƒçš„timer
echo "ğŸ“Š Active Timers:"
systemctl list-timers --no-pager | head -20

echo
echo "âš ï¸  Failed Timers:"
FAILED=$(systemctl list-timers --failed --no-pager)
if [[ -n "$FAILED" ]]; then
    echo "$FAILED"
else
    echo "No failed timers found."
fi

echo
echo "ğŸ•’ Next 5 Timer Executions:"
systemctl list-timers --no-pager | grep -E "(NEXT|[0-9])" | head -6

# æ£€æŸ¥ç‰¹å®štimerçš„è¯¦ç»†çŠ¶æ€
echo
echo "ğŸ“‹ Important Timer Details:"
for timer in backup.timer logrotate.timer; do
    if systemctl is-active "$timer" >/dev/null 2>&1; then
        echo "âœ… $timer: $(systemctl show -p NextElapseUSecRealtime --value $timer | cut -c1-19)"
    else
        echo "âŒ $timer: Not active"
    fi
done
```

### 8.2 ç›‘æ§å‘Šè­¦é…ç½®


**ğŸ“¢ è‡ªåŠ¨å‘Šè­¦**
```bash
# /etc/systemd/system/timer-monitor.timer
[Unit]
Description=Timer Health Monitor

[Timer]
OnCalendar=*:0/30  # æ¯30åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
Persistent=true

[Install]
WantedBy=timers.target

# /etc/systemd/system/timer-monitor.service
[Unit]
Description=Check Timer Health

[Service]
Type=oneshot
ExecStart=/usr/local/bin/check-timers.sh

# check-timers.sh
#!/bin/bash
FAILED_COUNT=$(systemctl list-timers --failed --no-legend | wc -l)

if [[ $FAILED_COUNT -gt 0 ]]; then
    echo "Warning: $FAILED_COUNT failed timers detected!" | \
    mail -s "Timer Alert" admin@example.com
fi
```

### 8.3 æ€§èƒ½ç›‘æ§


**âš¡ èµ„æºä½¿ç”¨ç›‘æ§**
```bash
# æŸ¥çœ‹timerç›¸å…³è¿›ç¨‹çš„èµ„æºä½¿ç”¨
systemctl status --lines=0 *.timer | grep -E "(Active|Memory|Tasks)"

# æŸ¥çœ‹æœ€è€—èµ„æºçš„timer service
systemctl list-units --type=service --state=active | \
    xargs -I {} sh -c 'echo -n "{} "; systemctl show --property=MemoryCurrent --value {}'
```

---

## 9. ğŸ”§ timeræ•…éšœæ’æŸ¥


### 9.1 å¸¸è§é—®é¢˜è¯Šæ–­


**âŒ Timerä¸æ‰§è¡Œé—®é¢˜æ’æŸ¥**

> ğŸ’¡ **æ’æŸ¥æ­¥éª¤**ï¼šé—®é¢˜é€šå¸¸å‡ºç°åœ¨è¿™å‡ ä¸ªç¯èŠ‚

**ç¬¬ä¸€æ­¥ï¼šæ£€æŸ¥timeræœ¬èº«çŠ¶æ€**
```bash
# æ£€æŸ¥timeræ˜¯å¦æ´»è·ƒ
systemctl is-active backup.timer
# åº”è¯¥æ˜¾ç¤º "active"

# æ£€æŸ¥timeré…ç½®æ˜¯å¦æ­£ç¡®
systemctl cat backup.timer

# æ£€æŸ¥ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´
systemctl list-timers backup.timer
```

**ç¬¬äºŒæ­¥ï¼šæ£€æŸ¥serviceé…ç½®**
```bash
# æ£€æŸ¥å¯¹åº”çš„serviceæ˜¯å¦å­˜åœ¨
systemctl cat backup.service

# æ‰‹åŠ¨æ‰§è¡Œserviceæµ‹è¯•
systemctl start backup.service
systemctl status backup.service
```

**ç¬¬ä¸‰æ­¥ï¼šæ£€æŸ¥æƒé™å’Œè·¯å¾„**
```bash
# æ£€æŸ¥serviceä¸­çš„è„šæœ¬æ˜¯å¦æœ‰æ‰§è¡Œæƒé™
ls -la /usr/local/bin/backup.sh

# æ£€æŸ¥è„šæœ¬è·¯å¾„æ˜¯å¦æ­£ç¡®
which backup.sh
```

### 9.2 æ—¶é—´é…ç½®é—®é¢˜


**â° æ—¶é—´æ ¼å¼é”™è¯¯æ’æŸ¥**
```bash
# éªŒè¯æ—¶é—´æ ¼å¼æ˜¯å¦æ­£ç¡®
systemd-analyze calendar "*-*-* 02:00:00"
# æ­£ç¡®çš„è¾“å‡ºä¼šæ˜¾ç¤ºä¸‹æ¬¡è§¦å‘æ—¶é—´

# å¸¸è§é”™è¯¯æ ¼å¼ï¼š
systemd-analyze calendar "2:00"
# Error: Failed to parse calendar specification

# æ­£ç¡®æ ¼å¼ï¼š
systemd-analyze calendar "*-*-* 02:00:00"
# Next elapse: Tue 2025-01-18 02:00:00 CST
```

### 9.3 è°ƒè¯•æ¨¡å¼


**ğŸ” è¯¦ç»†è°ƒè¯•ä¿¡æ¯**
```bash
# å¯ç”¨debugæ¨¡å¼æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
systemctl set-environment SYSTEMD_LOG_LEVEL=debug
systemctl daemon-reload

# æŸ¥çœ‹è¯¦ç»†çš„systemdæ—¥å¿—
journalctl -u systemd --since "10 minutes ago" | grep timer

# æ¢å¤æ­£å¸¸æ—¥å¿—çº§åˆ«
systemctl unset-environment SYSTEMD_LOG_LEVEL
systemctl daemon-reload
```

### 9.4 æ•…éšœæ’æŸ¥æ£€æŸ¥æ¸…å•


> ğŸ“‹ **Timeræ•…éšœæ’æŸ¥æ¸…å•**

- [ ] **TimerçŠ¶æ€æ£€æŸ¥**
  - Timeræ˜¯å¦activeï¼Ÿ`systemctl is-active timerå`
  - Timeræ˜¯å¦enabledï¼Ÿ`systemctl is-enabled timerå`
  - ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´æ˜¯å¦æ­£ç¡®ï¼Ÿ`systemctl list-timers`

- [ ] **é…ç½®æ–‡ä»¶æ£€æŸ¥**  
  - Timeræ–‡ä»¶è¯­æ³•æ˜¯å¦æ­£ç¡®ï¼Ÿ`systemctl cat timerå`
  - Serviceæ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Ÿ`systemctl cat serviceå`
  - æ—¶é—´æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼Ÿ`systemd-analyze calendar`

- [ ] **æƒé™æ£€æŸ¥**
  - è„šæœ¬æ˜¯å¦æœ‰æ‰§è¡Œæƒé™ï¼Ÿ`ls -la è„šæœ¬è·¯å¾„`
  - systemdæ˜¯å¦æœ‰æƒé™è®¿é—®æ–‡ä»¶ï¼Ÿ

- [ ] **æ—¥å¿—åˆ†æ**
  - æŸ¥çœ‹timeræ—¥å¿—ï¼š`journalctl -u timerå`
  - æŸ¥çœ‹serviceæ—¥å¿—ï¼š`journalctl -u serviceå`
  - æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ï¼š`journalctl --since today | grep timer`

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ¯ timerç®¡ç†è¦ç‚¹**
```
âœ… Timeræœ¬è´¨ï¼šè°ƒåº¦å™¨ï¼Œä¸æ˜¯æ‰§è¡Œå™¨
âœ… åŸºæœ¬æ“ä½œï¼šstart/stop/enable/disable/status
âœ… çŠ¶æ€æŸ¥çœ‹ï¼šlist-timersæ˜¾ç¤ºæ‰€æœ‰timerä¿¡æ¯
âœ… æ—¥å¿—åˆ†æï¼šjournalctlæŸ¥çœ‹timerå’Œserviceæ—¥å¿—
âœ… ä¾èµ–å…³ç³»ï¼šRequires/Wants/After/Beforeé…ç½®
âœ… åŠ¨æ€ç®¡ç†ï¼šsystemd-runåˆ›å»ºä¸´æ—¶timer
âœ… æ•…éšœæ’æŸ¥ï¼šæ£€æŸ¥timerçŠ¶æ€â†’serviceé…ç½®â†’æƒé™â†’æ—¥å¿—
```

### 10.2 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ”§ æœ€ä½³å®è·µæ€»ç»“**
```
æ—¶é—´é…ç½®ï¼š
â€¢ ä½¿ç”¨systemd-analyze calendaréªŒè¯æ—¶é—´æ ¼å¼
â€¢ è®¾ç½®RandomizedDelaySecé¿å…åŒæ—¶æ‰§è¡Œ
â€¢ è€ƒè™‘ä½¿ç”¨Persistent=trueå¤„ç†ç³»ç»Ÿå…³æœºæƒ…å†µ

ä¾èµ–ç®¡ç†ï¼š
â€¢ ç”¨Wantsè€Œä¸æ˜¯Requireså»ºç«‹å¼±ä¾èµ–
â€¢ ä½¿ç”¨Afterç¡®ä¿æ‰§è¡Œé¡ºåº
â€¢ è®¾ç½®åˆç†çš„æ¡ä»¶æ‰§è¡Œ

ç›‘æ§å‘Šè­¦ï¼š
â€¢ å®šæœŸæ£€æŸ¥systemctl list-timersè¾“å‡º
â€¢ ç›‘æ§failedçŠ¶æ€çš„timer
â€¢ è®¾ç½®è‡ªåŠ¨åŒ–å¥åº·æ£€æŸ¥

æ•…éšœå¤„ç†ï¼š
â€¢ å…ˆæŸ¥timerçŠ¶æ€ï¼Œå†æŸ¥serviceçŠ¶æ€
â€¢ æ‰‹åŠ¨æ‰§è¡ŒserviceéªŒè¯åŠŸèƒ½
â€¢ åˆ†ææ—¥å¿—æ‰¾å‡ºæ ¹æœ¬åŸå› 
```

### 10.3 å…³é”®ç†è§£è¦ç‚¹


> ğŸ’¡ **æ ¸å¿ƒè®°å¿†è¦ç‚¹**

**Timer vs Serviceå…³ç³»**ï¼š
- Timer = é—¹é’Ÿï¼ŒService = è¦åšçš„äº‹
- Timeråˆ°æ—¶é—´äº†å°±å¯åŠ¨Service
- Timerçš„æ—¥å¿—ç®€å•ï¼ŒServiceçš„æ—¥å¿—æ‰æ˜¯é‡ç‚¹

**ç®¡ç†å‘½ä»¤è®°å¿†**ï¼š
- `systemctl list-timers` - çœ‹æ‰€æœ‰å®šæ—¶ä»»åŠ¡
- `journalctl -u timerå` - çœ‹å…·ä½“æ—¥å¿—
- `systemctl status timerå` - çœ‹è¯¦ç»†çŠ¶æ€  

**æ•…éšœæ’æŸ¥æ€è·¯**ï¼š
1. Timeræ´»è·ƒå—ï¼Ÿâ†’ `systemctl is-active`
2. é…ç½®æ­£ç¡®å—ï¼Ÿâ†’ `systemctl cat` + `systemd-analyze calendar`
3. Serviceèƒ½è¿è¡Œå—ï¼Ÿâ†’ æ‰‹åŠ¨`systemctl start service`
4. æƒé™å¤Ÿå—ï¼Ÿâ†’ æ£€æŸ¥æ–‡ä»¶æƒé™å’Œè·¯å¾„

**å®ç”¨æŠ€å·§**ï¼š
- ç”¨`--now`å‚æ•°ä¸€æ­¥å¯åŠ¨å¹¶å¯ç”¨
- ç”¨é€šé…ç¬¦`*.timer`æ‰¹é‡æ“ä½œ
- ç”¨`-f`å‚æ•°å®æ—¶ç›‘æ§æ—¥å¿—
- ç”¨targetæ‰¹é‡ç®¡ç†ç›¸å…³timer

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- Timeræ˜¯è°ƒåº¦å™¨ï¼ŒServiceæ˜¯æ‰§è¡Œè€…
- list-timersçœ‹å…¨å±€ï¼Œstatusçœ‹ç»†èŠ‚  
- æ•…éšœå…ˆæŸ¥çŠ¶æ€ï¼Œå†æŸ¥é…ç½®ï¼Œæœ€åæŸ¥æ—¥å¿—
- åŠ¨æ€åˆ›å»ºç”¨systemd-runï¼Œæ‰¹é‡ç®¡ç†ç”¨target