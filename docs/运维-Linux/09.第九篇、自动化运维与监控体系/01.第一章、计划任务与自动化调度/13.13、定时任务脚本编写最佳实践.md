---
title: 13ã€å®šæ—¶ä»»åŠ¡è„šæœ¬ç¼–å†™æœ€ä½³å®è·µ
---
## ğŸ“š ç›®å½•


1. [å®šæ—¶ä»»åŠ¡è„šæœ¬æ¦‚è¿°](#1-å®šæ—¶ä»»åŠ¡è„šæœ¬æ¦‚è¿°)
2. [æ ‡å‡†è„šæœ¬ç»“æ„è®¾è®¡](#2-æ ‡å‡†è„šæœ¬ç»“æ„è®¾è®¡)
3. [é”™è¯¯å¤„ç†ä¸é€€å‡ºç ç®¡ç†](#3-é”™è¯¯å¤„ç†ä¸é€€å‡ºç ç®¡ç†)
4. [æ—¥å¿—è®°å½•æ ‡å‡†åŒ–](#4-æ—¥å¿—è®°å½•æ ‡å‡†åŒ–)
5. [å‚æ•°éªŒè¯ä¸é…ç½®ç®¡ç†](#5-å‚æ•°éªŒè¯ä¸é…ç½®ç®¡ç†)
6. [èµ„æºç®¡ç†ä¸æ¸…ç†æœºåˆ¶](#6-èµ„æºç®¡ç†ä¸æ¸…ç†æœºåˆ¶)
7. [æƒé™ä¸å®‰å…¨é…ç½®](#7-æƒé™ä¸å®‰å…¨é…ç½®)
8. [è°ƒè¯•ä¸æµ‹è¯•ç­–ç•¥](#8-è°ƒè¯•ä¸æµ‹è¯•ç­–ç•¥)
9. [è„šæœ¬ç»´æŠ¤ä¸æ–‡æ¡£è§„èŒƒ](#9-è„šæœ¬ç»´æŠ¤ä¸æ–‡æ¡£è§„èŒƒ)
10. [å®æˆ˜æ¡ˆä¾‹ä¸æ¨¡æ¿](#10-å®æˆ˜æ¡ˆä¾‹ä¸æ¨¡æ¿)
11. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#11-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ å®šæ—¶ä»»åŠ¡è„šæœ¬æ¦‚è¿°



### 1.1 ä»€ä¹ˆæ˜¯å®šæ—¶ä»»åŠ¡è„šæœ¬



**å®šæ—¶ä»»åŠ¡è„šæœ¬**å°±æ˜¯ä¸“é—¨ä¸º`cron`ã€`at`æˆ–`systemd timer`ç­‰è°ƒåº¦ç³»ç»Ÿç¼–å†™çš„è‡ªåŠ¨åŒ–æ‰§è¡Œè„šæœ¬ã€‚

```
ç®€å•ç†è§£ï¼š
æ™®é€šè„šæœ¬ = æ‰‹åŠ¨è¿è¡Œçš„å·¥å…·
å®šæ—¶è„šæœ¬ = ç³»ç»Ÿè‡ªåŠ¨è¿è¡Œçš„"æœºå™¨äºº"

ç‰¹ç‚¹å¯¹æ¯”ï¼š
æ‰‹åŠ¨è„šæœ¬ï¼šæœ‰äººå€¼å®ˆï¼Œå‡ºé”™èƒ½ç«‹å³å¤„ç†
å®šæ—¶è„šæœ¬ï¼šæ— äººå€¼å®ˆï¼Œå¿…é¡»è‡ªå·±å¤„ç†æ‰€æœ‰æƒ…å†µ
```

### 1.2 å®šæ—¶è„šæœ¬çš„ç‰¹æ®Šè¦æ±‚



**æ— äººå€¼å®ˆç‰¹æ€§**ï¼š
- ğŸ”¸ **è‡ªä¸»å¤„ç†**ï¼šé‡åˆ°é—®é¢˜è¦è‡ªå·±è§£å†³æˆ–ä¼˜é›…é€€å‡º
- ğŸ”¸ **æ—¥å¿—å®Œå¤‡**ï¼šæ‰€æœ‰é‡è¦æ“ä½œéƒ½è¦è®°å½•
- ğŸ”¸ **é”™è¯¯æ¢å¤**ï¼šèƒ½å¤Ÿä»å¼‚å¸¸çŠ¶æ€ä¸­æ¢å¤
- ğŸ”¸ **èµ„æºæ¸…ç†**ï¼šæ‰§è¡Œå®Œæ¯•è¦æ¸…ç†ä¸´æ—¶æ–‡ä»¶

**ç¯å¢ƒå·®å¼‚æ€§**ï¼š
```
äº¤äº’å¼è¿è¡Œç¯å¢ƒï¼š
- å®Œæ•´çš„ç”¨æˆ·ç¯å¢ƒå˜é‡
- å¯ä»¥æ¥æ”¶ç”¨æˆ·è¾“å…¥
- æœ‰ç»ˆç«¯æ˜¾ç¤ºè¾“å‡º

cronè¿è¡Œç¯å¢ƒï¼š
- æœ€å°åŒ–çš„ç¯å¢ƒå˜é‡ï¼ˆé€šå¸¸åªæœ‰PATHã€HOMEã€USERç­‰ï¼‰
- æ— æ³•æ¥æ”¶ç”¨æˆ·è¾“å…¥
- æ— ç»ˆç«¯è¾“å‡ºï¼ˆéœ€è¦é‡å®šå‘ï¼‰
```

### 1.3 å®šæ—¶è„šæœ¬çš„åº”ç”¨åœºæ™¯



**ğŸ”¸ ç³»ç»Ÿç»´æŠ¤ä»»åŠ¡**ï¼š
- æ—¥å¿—æ¸…ç†ã€ç³»ç»Ÿå¤‡ä»½ã€ç£ç›˜æ¸…ç†
- æœåŠ¡çŠ¶æ€æ£€æŸ¥ã€ç³»ç»Ÿæ€§èƒ½ç›‘æ§

**ğŸ”¸ æ•°æ®å¤„ç†ä»»åŠ¡**ï¼š
- æ•°æ®åº“å¤‡ä»½ã€æ•°æ®åŒæ­¥ã€æŠ¥è¡¨ç”Ÿæˆ
- æ–‡ä»¶å¤„ç†ã€æ‰¹é‡æ•°æ®å¯¼å…¥å¯¼å‡º

**ğŸ”¸ ä¸šåŠ¡æµç¨‹è‡ªåŠ¨åŒ–**ï¼š
- å®šæœŸé‚®ä»¶å‘é€ã€æ–‡ä»¶ä¼ è¾“
- è¯ä¹¦æ›´æ–°ã€é…ç½®åŒæ­¥

---

## 2. ğŸ“‹ æ ‡å‡†è„šæœ¬ç»“æ„è®¾è®¡



### 2.1 è„šæœ¬åŸºç¡€ç»“æ„æ¨¡æ¿



**æ ‡å‡†ç»“æ„ç»„æˆ**ï¼š
```bash
#!/bin/bash

#

# è„šæœ¬åç§°ï¼šbackup_database.sh  

# åŠŸèƒ½æè¿°ï¼šå®šæ—¶å¤‡ä»½MySQLæ•°æ®åº“

# ä½œè€…ï¼šè¿ç»´å›¢é˜Ÿ

# åˆ›å»ºæ—¶é—´ï¼š2025-09-17

# ä¿®æ”¹è®°å½•ï¼š

#   2025-09-17 v1.0 åˆå§‹ç‰ˆæœ¬

#


# ==================== é…ç½®åŒºåŸŸ ====================

SCRIPT_NAME=$(basename "$0")
SCRIPT_DIR=$(cd "$(dirname "$0")" && pwd)
LOG_DIR="/var/log/cron-scripts"
PID_FILE="/tmp/${SCRIPT_NAME%.sh}.pid"

# ==================== å‡½æ•°å®šä¹‰åŒºåŸŸ ====================

# å‡½æ•°ï¼šè®°å½•æ—¥å¿—

log_message() {
#    # å…·ä½“å®ç°...
}

# ==================== ä¸»ç¨‹åºåŒºåŸŸ ====================  

main() {
#    # å…·ä½“ä¸šåŠ¡é€»è¾‘...
}

# ==================== æ‰§è¡Œå…¥å£ ====================

if [[ "${BASH_SOURCE[0]}" == "${0}" ]]; then
    main "$@"
fi
```

### 2.2 è„šæœ¬å¤´éƒ¨ä¿¡æ¯è§„èŒƒ



**ğŸ“ æ–‡ä»¶å¤´éƒ¨æ¨¡æ¿**ï¼š
```bash
#!/bin/bash

#===============================================================================

# è„šæœ¬åç§°ï¼šcleanup_logs.sh

# åŠŸèƒ½æè¿°ï¼šæ¸…ç†ç³»ç»Ÿè¿‡æœŸæ—¥å¿—æ–‡ä»¶ï¼Œä¿ç•™æŒ‡å®šå¤©æ•°çš„æ—¥å¿—

# ä½¿ç”¨æ–¹æ³•ï¼š./cleanup_logs.sh [ä¿ç•™å¤©æ•°]

# å‚æ•°è¯´æ˜ï¼š

#   $1: ä¿ç•™å¤©æ•°ï¼Œé»˜è®¤30å¤©

# é€€å‡ºç ï¼š

#   0: æˆåŠŸå®Œæˆ

#   1: å‚æ•°é”™è¯¯

#   2: æƒé™ä¸è¶³

#   3: ç£ç›˜ç©ºé—´ä¸è¶³

# ä¾èµ–æ¡ä»¶ï¼š

#   - éœ€è¦rootæƒé™æˆ–å¯¹æ—¥å¿—ç›®å½•çš„å†™æƒé™

#   - éœ€è¦findã€rmç­‰åŸºç¡€å‘½ä»¤

# é…ç½®æ–‡ä»¶ï¼š/etc/logcleanup.conf

# æ—¥å¿—æ–‡ä»¶ï¼š/var/log/cron-scripts/cleanup_logs.log

#===============================================================================

```

> ğŸ’¡ **ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆè¯¦ç»†**ï¼šå®šæ—¶ä»»åŠ¡å‡ºé—®é¢˜æ—¶ï¼Œç»´æŠ¤äººå‘˜å¾€å¾€æ˜¯åœ¨æ·±å¤œæ”¶åˆ°å‘Šè­¦ï¼Œè¯¦ç»†çš„å¤´éƒ¨ä¿¡æ¯èƒ½å¿«é€Ÿäº†è§£è„šæœ¬ä½œç”¨å’Œä½¿ç”¨æ–¹æ³•ã€‚

### 2.3 å…¨å±€å˜é‡å®šä¹‰è§„èŒƒ



**ğŸ”§ å˜é‡å‘½åä¸ç»„ç»‡**ï¼š
```bash
# ==================== ç³»ç»Ÿå˜é‡ ====================

readonly SCRIPT_NAME=$(basename "$0")
readonly SCRIPT_DIR=$(cd "$(dirname "$0")" && pwd)
readonly SCRIPT_VERSION="1.2.0"
readonly RUN_USER=$(whoami)

# ==================== è·¯å¾„é…ç½® ====================  

readonly LOG_DIR="/var/log/cron-scripts"
readonly WORK_DIR="/tmp/${SCRIPT_NAME%.sh}"
readonly CONFIG_FILE="/etc/${SCRIPT_NAME%.sh}.conf"
readonly PID_FILE="/var/run/${SCRIPT_NAME%.sh}.pid"

# ==================== ä¸šåŠ¡é…ç½® ====================

DEFAULT_RETENTION_DAYS=30
DEFAULT_LOG_LEVEL="INFO"
MAX_RETRY_COUNT=3
TIMEOUT_SECONDS=300
```

**ğŸ”¸ å˜é‡å‘½åè§„èŒƒ**ï¼š
- å…¨å±€é…ç½®ç”¨å¤§å†™ï¼š`LOG_DIR`ã€`CONFIG_FILE`
- åªè¯»å˜é‡ç”¨`readonly`ï¼š`readonly SCRIPT_NAME`
- ä¸´æ—¶å˜é‡ç”¨å°å†™ï¼š`temp_file`ã€`retry_count`

---

## 3. âŒ é”™è¯¯å¤„ç†ä¸é€€å‡ºç ç®¡ç†



### 3.1 æ ‡å‡†é€€å‡ºç å®šä¹‰



**ğŸ“Š é€€å‡ºç æ ‡å‡†åŒ–**ï¼š

| é€€å‡ºç  | **å«ä¹‰** | **ä½¿ç”¨åœºæ™¯** | **ç¤ºä¾‹** |
|--------|---------|-------------|----------|
| `0` | æˆåŠŸå®Œæˆ | æ‰€æœ‰æ“ä½œæ­£å¸¸æ‰§è¡Œ | `exit 0` |
| `1` | å‚æ•°é”™è¯¯ | å‘½ä»¤è¡Œå‚æ•°ä¸æ­£ç¡® | `å‚æ•°ä¸ªæ•°ä¸å¯¹` |
| `2` | æƒé™ä¸è¶³ | æ²¡æœ‰æ‰§è¡Œæƒé™ | `æ— æ³•è®¿é—®ç›®å½•` |
| `3` | èµ„æºä¸è¶³ | ç£ç›˜ç©ºé—´ã€å†…å­˜ä¸è¶³ | `ç£ç›˜ç©ºé—´ä¸å¤Ÿ` |
| `4` | æ–‡ä»¶ä¸å­˜åœ¨ | é…ç½®æ–‡ä»¶ã€æ•°æ®æ–‡ä»¶ç¼ºå¤± | `é…ç½®æ–‡ä»¶ä¸¢å¤±` |
| `5` | ç½‘ç»œé”™è¯¯ | è¿æ¥è¶…æ—¶ã€DNSè§£æå¤±è´¥ | `æ•°æ®åº“è¿æ¥å¤±è´¥` |
| `6` | æœåŠ¡å¼‚å¸¸ | å¤–éƒ¨æœåŠ¡ä¸å¯ç”¨ | `APIè°ƒç”¨å¤±è´¥` |
| `10+` | ä¸šåŠ¡é€»è¾‘é”™è¯¯ | å…·ä½“ä¸šåŠ¡ç›¸å…³é—®é¢˜ | `æ•°æ®éªŒè¯å¤±è´¥` |

### 3.2 é”™è¯¯å¤„ç†æœºåˆ¶å®ç°



**ğŸ›¡ï¸ å…¨å±€é”™è¯¯æ•è·**ï¼š
```bash
# è®¾ç½®é”™è¯¯å¤„ç†é€‰é¡¹

set -euo pipefail  # é‡åˆ°é”™è¯¯ç«‹å³é€€å‡ºï¼Œæœªå®šä¹‰å˜é‡æŠ¥é”™ï¼Œç®¡é“é”™è¯¯ä¼ é€’

# å…¨å±€é”™è¯¯å¤„ç†å‡½æ•°

handle_error() {
    local exit_code=$?
    local line_number=$1
    
    log_message "ERROR" "è„šæœ¬åœ¨ç¬¬ ${line_number} è¡Œå‘ç”Ÿé”™è¯¯ï¼Œé€€å‡ºç ï¼š${exit_code}"
    
#    # æ¸…ç†ä¸´æ—¶èµ„æº
    cleanup_resources
    
#    # å‘é€å‘Šè­¦é€šçŸ¥
    send_alert "è„šæœ¬æ‰§è¡Œå¤±è´¥" "è„šæœ¬ ${SCRIPT_NAME} åœ¨ç¬¬ ${line_number} è¡Œå¤±è´¥"
    
    exit ${exit_code}
}

# æ³¨å†Œé”™è¯¯å¤„ç†

trap 'handle_error ${LINENO}' ERR
```

> âš ï¸ **é‡è¦æé†’**ï¼š`set -e`ä¼šè®©è„šæœ¬åœ¨ä»»ä½•å‘½ä»¤å¤±è´¥æ—¶ç«‹å³é€€å‡ºã€‚è¿™å¯¹å®šæ—¶ä»»åŠ¡å¾ˆé‡è¦ï¼Œé¿å…é”™è¯¯çŠ¶æ€ç»§ç»­ä¼ æ’­ã€‚

**ğŸ”„ é‡è¯•æœºåˆ¶å®ç°**ï¼š
```bash
# å¸¦é‡è¯•çš„å‘½ä»¤æ‰§è¡Œå‡½æ•°

execute_with_retry() {
    local command="$1"
    local max_attempts="${2:-3}"
    local attempt=1
    
    while [ $attempt -le $max_attempts ]; do
        log_message "INFO" "å°è¯•æ‰§è¡Œå‘½ä»¤ï¼ˆç¬¬ ${attempt}/${max_attempts} æ¬¡ï¼‰: $command"
        
        if eval "$command"; then
            log_message "INFO" "å‘½ä»¤æ‰§è¡ŒæˆåŠŸ"
            return 0
        else
            local exit_code=$?
            log_message "WARN" "å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œé€€å‡ºç ï¼š$exit_code"
            
            if [ $attempt -eq $max_attempts ]; then
                log_message "ERROR" "è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œå‘½ä»¤æ‰§è¡Œå¤±è´¥"
                return $exit_code
            fi
            
#            # ç­‰å¾…åé‡è¯•
            local wait_time=$((attempt * 5))
            log_message "INFO" "ç­‰å¾… ${wait_time} ç§’åé‡è¯•"
            sleep $wait_time
        fi
        
        ((attempt++))
    done
}
```

### 3.3 ä¸šåŠ¡é€»è¾‘é”™è¯¯å¤„ç†



**âœ… æ•°æ®éªŒè¯ä¸é”™è¯¯å¤„ç†**ï¼š
```bash
validate_and_backup_database() {
    local db_name="$1"
    
#    # å‚æ•°éªŒè¯
    if [[ -z "$db_name" ]]; then
        log_message "ERROR" "æ•°æ®åº“åç§°ä¸èƒ½ä¸ºç©º"
        return 1
    fi
    
#    # æ£€æŸ¥æ•°æ®åº“æ˜¯å¦å­˜åœ¨
    if ! mysql -e "USE $db_name" 2>/dev/null; then
        log_message "ERROR" "æ•°æ®åº“ $db_name ä¸å­˜åœ¨æˆ–æ— æ³•è®¿é—®"
        return 4
    fi
    
#    # æ£€æŸ¥ç£ç›˜ç©ºé—´
    local available_space=$(df /backup | tail -1 | awk '{print $4}')
    local required_space=1048576  # 1GB in KB
    
    if [[ $available_space -lt $required_space ]]; then
        log_message "ERROR" "ç£ç›˜ç©ºé—´ä¸è¶³ï¼Œéœ€è¦è‡³å°‘ 1GB ç©ºé—´"
        return 3
    fi
    
#    # æ‰§è¡Œå¤‡ä»½
    local backup_file="/backup/${db_name}_$(date +%Y%m%d_%H%M%S).sql"
    
    if execute_with_retry "mysqldump $db_name > $backup_file" 3; then
        log_message "INFO" "æ•°æ®åº“å¤‡ä»½æˆåŠŸï¼š$backup_file"
        return 0
    else
        log_message "ERROR" "æ•°æ®åº“å¤‡ä»½å¤±è´¥"
        return 6
    fi
}
```

---

## 4. ğŸ“ æ—¥å¿—è®°å½•æ ‡å‡†åŒ–



### 4.1 æ—¥å¿—çº§åˆ«ä¸æ ¼å¼è§„èŒƒ



**ğŸ“Š æ ‡å‡†æ—¥å¿—çº§åˆ«**ï¼š
```
DEBUG: è¯¦ç»†è°ƒè¯•ä¿¡æ¯ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¸è¾“å‡º
INFO:  ä¸€èˆ¬ä¿¡æ¯ï¼Œè®°å½•å…³é”®æ­¥éª¤
WARN:  è­¦å‘Šä¿¡æ¯ï¼Œå¯èƒ½æœ‰é—®é¢˜ä½†ä¸å½±å“æ‰§è¡Œ  
ERROR: é”™è¯¯ä¿¡æ¯ï¼Œå½±å“åŠŸèƒ½ä½†å¯ç»§ç»­
FATAL: ä¸¥é‡é”™è¯¯ï¼Œå¿…é¡»ç»ˆæ­¢ç¨‹åº
```

**ğŸ”¸ æ—¥å¿—æ ¼å¼æ ‡å‡†**ï¼š
```bash
# æ ‡å‡†æ—¥å¿—æ ¼å¼ï¼š[æ—¶é—´] [çº§åˆ«] [PID] æ¶ˆæ¯å†…å®¹

# ç¤ºä¾‹ï¼š[2025-09-17 15:30:25] [INFO] [12345] å¼€å§‹æ‰§è¡Œæ•°æ®åº“å¤‡ä»½

log_message() {
    local level="$1"
    local message="$2"
    local timestamp=$(date "+%Y-%m-%d %H:%M:%S")
    local pid=$$
    
#    # ç¡®ä¿æ—¥å¿—ç›®å½•å­˜åœ¨
    mkdir -p "$LOG_DIR"
    
#    # æ„é€ æ—¥å¿—æ¡ç›®
    local log_entry="[$timestamp] [$level] [$pid] $message"
    
#    # åŒæ—¶è¾“å‡ºåˆ°æ–‡ä»¶å’Œæ ‡å‡†è¾“å‡º
    echo "$log_entry" >> "$LOG_DIR/${SCRIPT_NAME%.sh}.log"
    echo "$log_entry"
}
```

### 4.2 æ—¥å¿—è½®è½¬ä¸ç®¡ç†



**ğŸ”„ æ—¥å¿—è‡ªåŠ¨è½®è½¬é…ç½®**ï¼š
```bash
# /etc/logrotate.d/cron-scripts

/var/log/cron-scripts/*.log {
    daily                # æ¯å¤©è½®è½¬
    rotate 30           # ä¿ç•™30ä¸ªæ–‡ä»¶
    compress            # å‹ç¼©æ—§æ–‡ä»¶
    delaycompress       # ç¬¬äºŒæ¬¡è½®è½¬æ—¶æ‰å‹ç¼©
    missingok          # æ–‡ä»¶ä¸å­˜åœ¨ä¸æŠ¥é”™
    notifempty         # ç©ºæ–‡ä»¶ä¸è½®è½¬
    create 0644 root root  # åˆ›å»ºæ–°æ–‡ä»¶çš„æƒé™
}
```

**ğŸ“ˆ æ—¥å¿—ç»Ÿè®¡ä¸ç›‘æ§**ï¼š
```bash
# æ—¥å¿—ç»Ÿè®¡å‡½æ•°

log_statistics() {
    local log_file="$LOG_DIR/${SCRIPT_NAME%.sh}.log"
    
    if [[ -f "$log_file" ]]; then
        local total_lines=$(wc -l < "$log_file")
        local error_count=$(grep -c "\[ERROR\]" "$log_file" || echo "0")
        local warn_count=$(grep -c "\[WARN\]" "$log_file" || echo "0")
        
        log_message "INFO" "æ—¥å¿—ç»Ÿè®¡ - æ€»è¡Œæ•°:$total_lines, é”™è¯¯:$error_count, è­¦å‘Š:$warn_count"
        
#        # å¦‚æœé”™è¯¯æ•°è¿‡å¤šï¼Œå‘é€å‘Šè­¦
        if [[ $error_count -gt 10 ]]; then
            send_alert "æ—¥å¿—é”™è¯¯è¿‡å¤š" "è„šæœ¬ $SCRIPT_NAME ä»Šæ—¥é”™è¯¯æ•°ï¼š$error_count"
        fi
    fi
}
```

### 4.3 ç»“æ„åŒ–æ—¥å¿—è®°å½•



**ğŸ—‚ï¸ å…³é”®æ“ä½œæ—¥å¿—æ¨¡æ¿**ï¼š
```bash
# æ“ä½œå¼€å§‹æ—¥å¿—

log_operation_start() {
    local operation="$1"
    log_message "INFO" "========== å¼€å§‹æ‰§è¡Œï¼š$operation =========="
}

# æ“ä½œå®Œæˆæ—¥å¿—  

log_operation_end() {
    local operation="$1"
    local result="$2"
    local duration="$3"
    log_message "INFO" "========== å®Œæˆæ‰§è¡Œï¼š$operationï¼Œç»“æœï¼š$resultï¼Œè€—æ—¶ï¼š${duration}ç§’ =========="
}

# ä½¿ç”¨ç¤ºä¾‹

backup_database() {
    local start_time=$(date +%s)
    
    log_operation_start "æ•°æ®åº“å¤‡ä»½"
    
#    # æ‰§è¡Œå¤‡ä»½é€»è¾‘...
    if execute_backup; then
        local end_time=$(date +%s)
        local duration=$((end_time - start_time))
        log_operation_end "æ•°æ®åº“å¤‡ä»½" "æˆåŠŸ" "$duration"
    else
        log_operation_end "æ•°æ®åº“å¤‡ä»½" "å¤±è´¥" "N/A"
        return 1
    fi
}
```

---

## 5. ğŸ”§ å‚æ•°éªŒè¯ä¸é…ç½®ç®¡ç†



### 5.1 å‘½ä»¤è¡Œå‚æ•°å¤„ç†



**âš™ï¸ æ ‡å‡†å‚æ•°è§£æ**ï¼š
```bash
# æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯

show_help() {
    cat << EOF
ç”¨æ³•: $SCRIPT_NAME [é€‰é¡¹] [å‚æ•°]

æè¿°: ç³»ç»Ÿæ—¥å¿—æ¸…ç†å·¥å…·ï¼Œæ¸…ç†æŒ‡å®šå¤©æ•°ä¹‹å‰çš„æ—¥å¿—æ–‡ä»¶

é€‰é¡¹:
  -d, --days DAYS       ä¿ç•™å¤©æ•°ï¼Œé»˜è®¤30å¤©
  -p, --path PATH       æ—¥å¿—è·¯å¾„ï¼Œé»˜è®¤/var/log  
  -t, --test           æµ‹è¯•æ¨¡å¼ï¼Œåªæ˜¾ç¤ºå°†è¦åˆ é™¤çš„æ–‡ä»¶
  -v, --verbose        è¯¦ç»†è¾“å‡ºæ¨¡å¼
  -h, --help           æ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯

ç¤ºä¾‹:
  $SCRIPT_NAME -d 7                 # æ¸…ç†7å¤©å‰çš„æ—¥å¿—
  $SCRIPT_NAME --path /app/logs -t  # æµ‹è¯•æ¨¡å¼æŸ¥çœ‹/app/logsç›®å½•
  
é€€å‡ºç :
  0: æˆåŠŸå®Œæˆ
  1: å‚æ•°é”™è¯¯
  2: æƒé™ä¸è¶³
EOF
}

# å‚æ•°è§£æå‡½æ•°

parse_arguments() {
#    # é»˜è®¤å€¼
    RETENTION_DAYS=$DEFAULT_RETENTION_DAYS
    LOG_PATH="/var/log"
    TEST_MODE=false
    VERBOSE_MODE=false
    
    while [[ $# -gt 0 ]]; do
        case $1 in
            -d|--days)
                RETENTION_DAYS="$2"
                if ! [[ "$RETENTION_DAYS" =~ ^[0-9]+$ ]] || [[ $RETENTION_DAYS -lt 1 ]]; then
                    log_message "ERROR" "ä¿ç•™å¤©æ•°å¿…é¡»æ˜¯å¤§äº0çš„æ•´æ•°"
                    exit 1
                fi
                shift 2
                ;;
            -p|--path)
                LOG_PATH="$2"
                if [[ ! -d "$LOG_PATH" ]]; then
                    log_message "ERROR" "æŒ‡å®šçš„è·¯å¾„ä¸å­˜åœ¨ï¼š$LOG_PATH"
                    exit 4
                fi
                shift 2
                ;;
            -t|--test)
                TEST_MODE=true
                shift
                ;;
            -v|--verbose)
                VERBOSE_MODE=true
                shift
                ;;
            -h|--help)
                show_help
                exit 0
                ;;
            *)
                log_message "ERROR" "æœªçŸ¥å‚æ•°: $1"
                show_help
                exit 1
                ;;
        esac
    done
    
    log_message "INFO" "å‚æ•°è§£æå®Œæˆ - ä¿ç•™å¤©æ•°:$RETENTION_DAYS, è·¯å¾„:$LOG_PATH, æµ‹è¯•æ¨¡å¼:$TEST_MODE"
}
```

### 5.2 é…ç½®æ–‡ä»¶ç®¡ç†



**ğŸ“‹ é…ç½®æ–‡ä»¶ç»“æ„**ï¼š
```bash
# /etc/backup_script.conf - é…ç½®æ–‡ä»¶ç¤ºä¾‹

# æ•°æ®åº“é…ç½®

DB_HOST="localhost"
DB_USER="backup_user" 
DB_PASS="secure_password"
DB_LIST="app_db,user_db,log_db"

# å¤‡ä»½é…ç½®

BACKUP_DIR="/data/backups"
RETENTION_DAYS=30
COMPRESS_BACKUPS=true

# é€šçŸ¥é…ç½®  

ENABLE_EMAIL_NOTIFY=true
ALERT_EMAIL="admin@company.com"
SMTP_SERVER="smtp.company.com"

# æ—¥å¿—é…ç½®

LOG_LEVEL="INFO"
MAX_LOG_SIZE="100M"
```

**âš¡ é…ç½®æ–‡ä»¶è¯»å–ä¸éªŒè¯**ï¼š
```bash
# è¯»å–é…ç½®æ–‡ä»¶

load_config() {
    local config_file="$1"
    
    if [[ -f "$config_file" ]]; then
        log_message "INFO" "åŠ è½½é…ç½®æ–‡ä»¶ï¼š$config_file"
        
#        # å®‰å…¨åœ°åŠ è½½é…ç½®æ–‡ä»¶
        while IFS='=' read -r key value; do
#            # è·³è¿‡æ³¨é‡Šå’Œç©ºè¡Œ
            [[ $key =~ ^#.*$ ]] && continue
            [[ -z $key ]] && continue
            
#            # å»é™¤å¼•å·
            value=$(echo "$value" | sed 's/^"//;s/"$//')
            
#            # å¯¼å‡ºå˜é‡
            export "$key"="$value"
            
        done < "$config_file"
        
        log_message "INFO" "é…ç½®æ–‡ä»¶åŠ è½½å®Œæˆ"
    else
        log_message "WARN" "é…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤é…ç½®ï¼š$config_file"
    fi
}

# é…ç½®éªŒè¯

validate_config() {
    local errors=0
    
#    # éªŒè¯å¿…éœ€çš„é…ç½®é¡¹
    if [[ -z "$BACKUP_DIR" ]]; then
        log_message "ERROR" "å¤‡ä»½ç›®å½•æœªé…ç½®"
        ((errors++))
    elif [[ ! -d "$BACKUP_DIR" ]]; then
        log_message "ERROR" "å¤‡ä»½ç›®å½•ä¸å­˜åœ¨ï¼š$BACKUP_DIR"  
        ((errors++))
    fi
    
    if [[ -z "$DB_HOST" || -z "$DB_USER" ]]; then
        log_message "ERROR" "æ•°æ®åº“è¿æ¥ä¿¡æ¯æœªé…ç½®"
        ((errors++))
    fi
    
#    # éªŒè¯æ•°å­—é…ç½®
    if ! [[ "$RETENTION_DAYS" =~ ^[0-9]+$ ]]; then
        log_message "ERROR" "ä¿ç•™å¤©æ•°é…ç½®é”™è¯¯ï¼š$RETENTION_DAYS"
        ((errors++))
    fi
    
    if [[ $errors -gt 0 ]]; then
        log_message "ERROR" "é…ç½®éªŒè¯å¤±è´¥ï¼Œå‘ç° $errors ä¸ªé”™è¯¯"
        exit 1
    else
        log_message "INFO" "é…ç½®éªŒè¯é€šè¿‡"
    fi
}
```

### 5.3 ç¯å¢ƒå˜é‡å¤„ç†



**ğŸŒ cronç¯å¢ƒå˜é‡è®¾ç½®**ï¼š
```bash
# è®¾ç½®åŸºç¡€ç¯å¢ƒå˜é‡ï¼ˆåœ¨è„šæœ¬å¼€å¤´ï¼‰

setup_environment() {
#    # è®¾ç½®å®‰å…¨çš„PATH
    export PATH="/usr/local/bin:/usr/bin:/bin"
    
#    # è®¾ç½®è¯­è¨€ç¯å¢ƒ
    export LANG="en_US.UTF-8"
    export LC_ALL="en_US.UTF-8"
    
#    # è®¾ç½®æ—¶åŒº
    export TZ="Asia/Shanghai"
    
#    # è·å–ç”¨æˆ·ç¯å¢ƒï¼ˆå¦‚æœéœ€è¦ï¼‰
    if [[ -f "$HOME/.profile" ]]; then
        source "$HOME/.profile"
    fi
    
    log_message "INFO" "ç¯å¢ƒå˜é‡è®¾ç½®å®Œæˆ - PATH:$PATH, USER:$USER, HOME:$HOME"
}
```

---

## 6. ğŸ§¹ èµ„æºç®¡ç†ä¸æ¸…ç†æœºåˆ¶



### 6.1 ä¸´æ—¶æ–‡ä»¶ç®¡ç†



**ğŸ“ ä¸´æ—¶æ–‡ä»¶åˆ›å»ºä¸æ¸…ç†**ï¼š
```bash
# å…¨å±€ä¸´æ—¶æ–‡ä»¶æ•°ç»„

TEMP_FILES=()

# åˆ›å»ºä¸´æ—¶æ–‡ä»¶å‡½æ•°

create_temp_file() {
    local prefix="$1"
    local temp_file
    
#    # åˆ›å»ºå·¥ä½œç›®å½•
    mkdir -p "$WORK_DIR"
    
#    # åˆ›å»ºä¸´æ—¶æ–‡ä»¶
    temp_file=$(mktemp "$WORK_DIR/${prefix}.XXXXXX")
    
#    # è®°å½•åˆ°æ•°ç»„ä¸­
    TEMP_FILES+=("$temp_file")
    
    log_message "DEBUG" "åˆ›å»ºä¸´æ—¶æ–‡ä»¶ï¼š$temp_file"
    echo "$temp_file"
}

# æ¸…ç†æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶

cleanup_temp_files() {
    log_message "INFO" "å¼€å§‹æ¸…ç†ä¸´æ—¶æ–‡ä»¶"
    
    for temp_file in "${TEMP_FILES[@]}"; do
        if [[ -f "$temp_file" ]]; then
            rm -f "$temp_file"
            log_message "DEBUG" "åˆ é™¤ä¸´æ—¶æ–‡ä»¶ï¼š$temp_file"
        fi
    done
    
#    # æ¸…ç†å·¥ä½œç›®å½•
    if [[ -d "$WORK_DIR" ]]; then
        rmdir "$WORK_DIR" 2>/dev/null || log_message "WARN" "å·¥ä½œç›®å½•ä¸ä¸ºç©ºï¼Œæ— æ³•åˆ é™¤ï¼š$WORK_DIR"
    fi
    
    log_message "INFO" "ä¸´æ—¶æ–‡ä»¶æ¸…ç†å®Œæˆ"
}
```

### 6.2 è¿›ç¨‹ç®¡ç†ä¸é”æœºåˆ¶



**ğŸ”’ å•å®ä¾‹è¿è¡Œä¿è¯**ï¼š
```bash
# æ£€æŸ¥æ˜¯å¦å·²æœ‰å®ä¾‹è¿è¡Œ

check_single_instance() {
    if [[ -f "$PID_FILE" ]]; then
        local old_pid=$(cat "$PID_FILE")
        
#        # æ£€æŸ¥è¿›ç¨‹æ˜¯å¦çœŸçš„åœ¨è¿è¡Œ
        if kill -0 "$old_pid" 2>/dev/null; then
            log_message "ERROR" "è„šæœ¬å·²åœ¨è¿è¡Œä¸­ï¼ŒPID: $old_pid"
            exit 1
        else
            log_message "WARN" "å‘ç°åƒµæ­»çš„PIDæ–‡ä»¶ï¼Œæ¸…ç†ä¸­"
            rm -f "$PID_FILE"
        fi
    fi
    
#    # å†™å…¥å½“å‰PID
    echo $$ > "$PID_FILE"
    log_message "INFO" "åˆ›å»ºPIDæ–‡ä»¶ï¼š$PID_FILEï¼Œå½“å‰PID: $$"
}

# æ¸…ç†PIDæ–‡ä»¶

cleanup_pid_file() {
    if [[ -f "$PID_FILE" ]]; then
        rm -f "$PID_FILE"
        log_message "INFO" "æ¸…ç†PIDæ–‡ä»¶ï¼š$PID_FILE"
    fi
}
```

### 6.3 èµ„æºæ¸…ç†æœºåˆ¶



**ğŸ›¡ï¸ å®Œæ•´çš„æ¸…ç†æµç¨‹**ï¼š
```bash
# å…¨å±€æ¸…ç†å‡½æ•°

cleanup_resources() {
    log_message "INFO" "å¼€å§‹æ¸…ç†ç³»ç»Ÿèµ„æº"
    
#    # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
    cleanup_temp_files
    
#    # æ¸…ç†PIDæ–‡ä»¶
    cleanup_pid_file
    
#    # å…³é—­å¯èƒ½çš„æ•°æ®åº“è¿æ¥
    cleanup_database_connections
    
#    # æ¸…ç†ç½‘ç»œè¿æ¥
    cleanup_network_connections
    
#    # æ¢å¤ä¿®æ”¹çš„ç³»ç»Ÿè®¾ç½®
    restore_system_settings
    
    log_message "INFO" "èµ„æºæ¸…ç†å®Œæˆ"
}

# æ³¨å†Œæ¸…ç†å‡½æ•°åˆ°ä¸åŒçš„ä¿¡å·

setup_signal_handlers() {
    trap cleanup_resources EXIT    # æ­£å¸¸é€€å‡ºæ—¶æ¸…ç†
    trap cleanup_resources INT     # Ctrl+Cæ—¶æ¸…ç†
    trap cleanup_resources TERM    # killå‘½ä»¤æ—¶æ¸…ç†
    trap cleanup_resources HUP     # æŒ‚æ–­æ—¶æ¸…ç†
}

# æ•°æ®åº“è¿æ¥æ¸…ç†

cleanup_database_connections() {
    if [[ -n "${DB_CONNECTION:-}" ]]; then
        log_message "INFO" "å…³é—­æ•°æ®åº“è¿æ¥"
#        # è¿™é‡Œæ·»åŠ å…·ä½“çš„æ•°æ®åº“å…³é—­é€»è¾‘
    fi
}
```

---

## 7. ğŸ” æƒé™ä¸å®‰å…¨é…ç½®



### 7.1 è„šæœ¬æƒé™è®¾ç½®



**ğŸ“‹ æƒé™è®¾ç½®æœ€ä½³å®è·µ**ï¼š
```bash
# è®¾ç½®è„šæœ¬æ–‡ä»¶æƒé™

chmod 750 /path/to/script.sh    # æ‰€æœ‰è€…å¯è¯»å†™æ‰§è¡Œï¼Œç»„å¯è¯»æ‰§è¡Œï¼Œå…¶ä»–æ— æƒé™
chown root:cron /path/to/script.sh  # è®¾ç½®æ‰€æœ‰è€…ä¸ºrootï¼Œç»„ä¸ºcron

# è®¾ç½®é…ç½®æ–‡ä»¶æƒé™

chmod 640 /etc/script.conf      # æ‰€æœ‰è€…å¯è¯»å†™ï¼Œç»„å¯è¯»ï¼Œå…¶ä»–æ— æƒé™
chown root:root /etc/script.conf

# è®¾ç½®æ—¥å¿—ç›®å½•æƒé™

mkdir -p /var/log/cron-scripts
chmod 755 /var/log/cron-scripts  # ç›®å½•éœ€è¦æ‰§è¡Œæƒé™æ‰èƒ½è¿›å…¥
chown root:adm /var/log/cron-scripts
```

**ğŸ” æƒé™æ£€æŸ¥å‡½æ•°**ï¼š
```bash
# æ£€æŸ¥è„šæœ¬æ‰§è¡Œæƒé™

check_permissions() {
    local required_dirs=("$LOG_DIR" "$WORK_DIR")
    local required_files=("$CONFIG_FILE")
    
#    # æ£€æŸ¥ç›®å½•æƒé™
    for dir in "${required_dirs[@]}"; do
        if [[ ! -d "$dir" ]]; then
            if ! mkdir -p "$dir" 2>/dev/null; then
                log_message "ERROR" "æ— æ³•åˆ›å»ºç›®å½•ï¼š$dir"
                return 2
            fi
        fi
        
        if [[ ! -w "$dir" ]]; then
            log_message "ERROR" "ç›®å½•æ— å†™æƒé™ï¼š$dir"
            return 2
        fi
    done
    
#    # æ£€æŸ¥æ–‡ä»¶æƒé™
    for file in "${required_files[@]}"; do
        if [[ -f "$file" && ! -r "$file" ]]; then
            log_message "ERROR" "æ–‡ä»¶æ— è¯»æƒé™ï¼š$file"
            return 2
        fi
    done
    
    log_message "INFO" "æƒé™æ£€æŸ¥é€šè¿‡"
    return 0
}
```

### 7.2 æ•æ„Ÿä¿¡æ¯å¤„ç†



**ğŸ” å¯†ç å’Œå¯†é’¥å®‰å…¨**ï¼š
```bash
# ä»å®‰å…¨æ–‡ä»¶è¯»å–å¯†ç 

read_secure_password() {
    local password_file="$1"
    local password
    
#    # æ£€æŸ¥å¯†ç æ–‡ä»¶æƒé™
    if [[ -f "$password_file" ]]; then
        local file_perms=$(stat -c "%a" "$password_file")
        if [[ "$file_perms" != "600" ]]; then
            log_message "ERROR" "å¯†ç æ–‡ä»¶æƒé™ä¸å®‰å…¨ï¼š$password_file ($file_perms)"
            return 2
        fi
        
        password=$(cat "$password_file")
        echo "$password"
    else
        log_message "ERROR" "å¯†ç æ–‡ä»¶ä¸å­˜åœ¨ï¼š$password_file"
        return 4
    fi
}

# å®‰å…¨åœ°æ‰§è¡ŒåŒ…å«å¯†ç çš„å‘½ä»¤

execute_secure_command() {
    local command="$1"
    local password="$2"
    
#    # ä½¿ç”¨ä¸´æ—¶ç¯å¢ƒå˜é‡ä¼ é€’å¯†ç 
    env MYSQL_PWD="$password" bash -c "$command"
    
#    # æ¸…é™¤ç¯å¢ƒå˜é‡
    unset MYSQL_PWD
}
```

### 7.3 å®¡è®¡ä¸æ—¥å¿—å®‰å…¨



**ğŸ“Š æ“ä½œå®¡è®¡è®°å½•**ï¼š
```bash
# å®¡è®¡æ—¥å¿—è®°å½•

audit_log() {
    local operation="$1"
    local result="$2"
    local user="${RUN_USER:-unknown}"
    local timestamp=$(date "+%Y-%m-%d %H:%M:%S")
    
#    # è®°å½•åˆ°å®¡è®¡æ—¥å¿—
    local audit_entry="[$timestamp] USER=$user SCRIPT=$SCRIPT_NAME OP=$operation RESULT=$result PID=$$"
    echo "$audit_entry" >> "/var/log/audit/cron-scripts.log"
    
#    # å¦‚æœæ˜¯æ•æ„Ÿæ“ä½œï¼ŒåŒæ—¶è®°å½•åˆ°ç³»ç»Ÿæ—¥å¿—
    if [[ "$operation" =~ (backup|delete|modify) ]]; then
        logger -t "$SCRIPT_NAME" "AUDIT: $audit_entry"
    fi
}
```

---

## 8. ğŸ› è°ƒè¯•ä¸æµ‹è¯•ç­–ç•¥



### 8.1 è°ƒè¯•æ¨¡å¼å®ç°



**ğŸ” è°ƒè¯•åŠŸèƒ½å¼€å…³**ï¼š
```bash
# è°ƒè¯•æ¨¡å¼å˜é‡

DEBUG_MODE=${DEBUG_MODE:-false}
DRY_RUN=${DRY_RUN:-false}

# è°ƒè¯•ä¿¡æ¯è¾“å‡º

debug_log() {
    if [[ "$DEBUG_MODE" == "true" ]]; then
        log_message "DEBUG" "$1"
    fi
}

# æ‰§è¡Œå‰é¢„è§ˆï¼ˆå¹²è¿è¡Œï¼‰

execute_or_preview() {
    local command="$1"
    local description="$2"
    
    if [[ "$DRY_RUN" == "true" ]]; then
        log_message "INFO" "[é¢„è§ˆæ¨¡å¼] å°†è¦æ‰§è¡Œ: $description"
        log_message "INFO" "[é¢„è§ˆæ¨¡å¼] å‘½ä»¤: $command"
        return 0
    else
        debug_log "æ‰§è¡Œå‘½ä»¤: $command"
        eval "$command"
    fi
}
```

**ğŸ¯ è°ƒè¯•ä¿¡æ¯æ”¶é›†**ï¼š
```bash
# æ”¶é›†ç³»ç»Ÿç¯å¢ƒä¿¡æ¯

collect_debug_info() {
    if [[ "$DEBUG_MODE" != "true" ]]; then
        return 0
    fi
    
    log_message "DEBUG" "========== è°ƒè¯•ä¿¡æ¯å¼€å§‹ =========="
    log_message "DEBUG" "è„šæœ¬ç‰ˆæœ¬: $SCRIPT_VERSION"
    log_message "DEBUG" "æ‰§è¡Œç”¨æˆ·: $(whoami)"
    log_message "DEBUG" "æ‰§è¡Œç›®å½•: $(pwd)"
    log_message "DEBUG" "ç³»ç»Ÿä¿¡æ¯: $(uname -a)"
    log_message "DEBUG" "å¯ç”¨å†…å­˜: $(free -h | grep Mem)"
    log_message "DEBUG" "ç£ç›˜ç©ºé—´: $(df -h /)"
    log_message "DEBUG" "ç¯å¢ƒå˜é‡: PATH=$PATH"
    log_message "DEBUG" "è„šæœ¬å‚æ•°: $*"
    log_message "DEBUG" "========== è°ƒè¯•ä¿¡æ¯ç»“æŸ =========="
}
```

### 8.2 æµ‹è¯•ç”¨ä¾‹è®¾è®¡



**âœ… å•å…ƒæµ‹è¯•æ¡†æ¶**ï¼š
```bash
# ç®€å•çš„æµ‹è¯•æ¡†æ¶

TEST_COUNT=0
PASS_COUNT=0
FAIL_COUNT=0

# æ–­è¨€å‡½æ•°

assert_equals() {
    local expected="$1"
    local actual="$2"
    local message="$3"
    
    ((TEST_COUNT++))
    
    if [[ "$expected" == "$actual" ]]; then
        log_message "INFO" "[PASS] $message"
        ((PASS_COUNT++))
    else
        log_message "ERROR" "[FAIL] $message - æœŸæœ›: '$expected', å®é™…: '$actual'"
        ((FAIL_COUNT++))
    fi
}

# æµ‹è¯•å‡½æ•°ç¤ºä¾‹

test_parameter_validation() {
    log_message "INFO" "æµ‹è¯•å‚æ•°éªŒè¯åŠŸèƒ½"
    
#    # æµ‹è¯•æœ‰æ•ˆå‚æ•°
    if validate_retention_days "30"; then
        assert_equals "0" "$?" "æœ‰æ•ˆå¤©æ•°éªŒè¯"
    fi
    
#    # æµ‹è¯•æ— æ•ˆå‚æ•°
    if ! validate_retention_days "abc"; then
        assert_equals "1" "$?" "æ— æ•ˆå¤©æ•°éªŒè¯"
    fi
}

# è¿è¡Œæ‰€æœ‰æµ‹è¯•

run_tests() {
    log_message "INFO" "å¼€å§‹è¿è¡Œæµ‹è¯•ç”¨ä¾‹"
    
    test_parameter_validation
    test_file_operations
    test_database_connection
    
    log_message "INFO" "æµ‹è¯•å®Œæˆ - æ€»æ•°: $TEST_COUNT, é€šè¿‡: $PASS_COUNT, å¤±è´¥: $FAIL_COUNT"
    
    if [[ $FAIL_COUNT -gt 0 ]]; then
        return 1
    else
        return 0
    fi
}
```

### 8.3 æ€§èƒ½ç›‘æ§



**ğŸ“Š æ‰§è¡Œæ—¶é—´ç›‘æ§**ï¼š
```bash
# æ€§èƒ½ç›‘æ§å‡½æ•°

monitor_performance() {
    local operation="$1"
    local start_time=$(date +%s.%N)
    
#    # æ‰§è¡Œæ“ä½œ
    shift
    "$@"
    local exit_code=$?
    
    local end_time=$(date +%s.%N)
    local duration=$(echo "$end_time - $start_time" | bc)
    
    log_message "INFO" "æ€§èƒ½ç›‘æ§ - $operation è€—æ—¶: ${duration}ç§’"
    
#    # è®°å½•åˆ°æ€§èƒ½æ—¥å¿—
    echo "$(date '+%Y-%m-%d %H:%M:%S'),$operation,$duration" >> "$LOG_DIR/performance.csv"
    
    return $exit_code
}

# å†…å­˜ä½¿ç”¨ç›‘æ§

monitor_memory_usage() {
    local operation="$1"
    local pid=$$
    
#    # è®°å½•æ“ä½œå‰å†…å­˜
    local mem_before=$(cat /proc/$pid/status | grep VmRSS | awk '{print $2}')
    
#    # æ‰§è¡Œæ“ä½œ
    shift
    "$@"
    local exit_code=$?
    
#    # è®°å½•æ“ä½œåå†…å­˜
    local mem_after=$(cat /proc/$pid/status | grep VmRSS | awk '{print $2}')
    local mem_diff=$((mem_after - mem_before))
    
    log_message "INFO" "å†…å­˜ç›‘æ§ - $operation å†…å­˜å˜åŒ–: ${mem_diff}KB"
    
    return $exit_code
}
```

---

## 9. ğŸ“š è„šæœ¬ç»´æŠ¤ä¸æ–‡æ¡£è§„èŒƒ



### 9.1 ç‰ˆæœ¬ç®¡ç†ç­–ç•¥



**ğŸ”– ç‰ˆæœ¬å·è§„èŒƒ**ï¼š
```bash
# ç‰ˆæœ¬ä¿¡æ¯ç»“æ„

SCRIPT_VERSION="1.2.3"
# ä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å·

# ä¸»ç‰ˆæœ¬å·ï¼šä¸å…¼å®¹çš„é‡å¤§ä¿®æ”¹

# æ¬¡ç‰ˆæœ¬å·ï¼šå‘åå…¼å®¹çš„åŠŸèƒ½æ·»åŠ   

# ä¿®è®¢å·ï¼šå‘åå…¼å®¹çš„é—®é¢˜ä¿®å¤


# ç‰ˆæœ¬ä¿¡æ¯å‡½æ•°

show_version() {
    cat << EOF
$SCRIPT_NAME ç‰ˆæœ¬ $SCRIPT_VERSION
æ„å»ºæ—¥æœŸ: $(date "+%Y-%m-%d")
ä½œè€…: è¿ç»´å›¢é˜Ÿ
æè¿°: Linuxç³»ç»Ÿè‡ªåŠ¨åŒ–ç»´æŠ¤è„šæœ¬

ç‰ˆæœ¬å†å²:
  v1.2.3 (2025-09-17) - ä¿®å¤æ—¥å¿—è½®è½¬é—®é¢˜
  v1.2.0 (2025-09-10) - æ·»åŠ é‚®ä»¶é€šçŸ¥åŠŸèƒ½
  v1.1.0 (2025-09-01) - æ·»åŠ é…ç½®æ–‡ä»¶æ”¯æŒ
  v1.0.0 (2025-08-15) - åˆå§‹ç‰ˆæœ¬
EOF
}
```

**ğŸ“ å˜æ›´è®°å½•æ¨¡æ¿**ï¼š
```bash
# è„šæœ¬å¤´éƒ¨çš„å˜æ›´æ—¥å¿—

#===============================================================================

# å˜æ›´è®°å½•:

#   v1.2.3 2025-09-17 å¼ ä¸‰

#     - [ä¿®å¤] æ—¥å¿—æ–‡ä»¶æƒé™é—®é¢˜

#     - [ä¿®å¤] ç£ç›˜ç©ºé—´æ£€æŸ¥é€»è¾‘é”™è¯¯

#   

#   v1.2.0 2025-09-10 æå››  

#     - [æ–°å¢] é‚®ä»¶é€šçŸ¥åŠŸèƒ½

#     - [æ–°å¢] é…ç½®æ–‡ä»¶éªŒè¯

#     - [ä¼˜åŒ–] é”™è¯¯å¤„ç†æœºåˆ¶

#

#   v1.1.0 2025-09-01 ç‹äº”

#     - [æ–°å¢] æ”¯æŒé…ç½®æ–‡ä»¶

#     - [æ–°å¢] è°ƒè¯•æ¨¡å¼

#     - [æ”¹è¿›] æ—¥å¿—æ ¼å¼

#===============================================================================

```

### 9.2 å†…è”æ–‡æ¡£è§„èŒƒ



**ğŸ“– å‡½æ•°æ–‡æ¡£æ¨¡æ¿**ï¼š
```bash
#===============================================================================

# å‡½æ•°åç§°: backup_mysql_database

# åŠŸèƒ½æè¿°: å¤‡ä»½æŒ‡å®šçš„MySQLæ•°æ®åº“åˆ°æœ¬åœ°ç›®å½•

# 

# å‚æ•°è¯´æ˜:

#   $1 - æ•°æ®åº“åç§° (å¿…éœ€)

#   $2 - å¤‡ä»½ç›®å½• (å¯é€‰ï¼Œé»˜è®¤ä½¿ç”¨BACKUP_DIR)

#   $3 - æ˜¯å¦å‹ç¼© (å¯é€‰ï¼Œtrue/falseï¼Œé»˜è®¤true)

#

# è¿”å›å€¼:

#   0 - å¤‡ä»½æˆåŠŸ

#   1 - å‚æ•°é”™è¯¯  

#   3 - ç£ç›˜ç©ºé—´ä¸è¶³

#   4 - æ•°æ®åº“ä¸å­˜åœ¨

#   5 - å¤‡ä»½å¤±è´¥

#

# ä¾èµ–:

#   - mysqldumpå‘½ä»¤

#   - è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´

#   - æ•°æ®åº“è®¿é—®æƒé™

#

# ç¤ºä¾‹:

#   backup_mysql_database "myapp_db"

#   backup_mysql_database "myapp_db" "/backup" "false"

#

# ä½œè€…: è¿ç»´å›¢é˜Ÿ

# åˆ›å»º: 2025-09-17

#===============================================================================

backup_mysql_database() {
    local db_name="$1"
    local backup_dir="${2:-$BACKUP_DIR}"  
    local compress="${3:-true}"
    
#    # å‡½æ•°å®ç°...
}
```

### 9.3 è¿ç»´æ–‡æ¡£ç”Ÿæˆ



**ğŸ“„ è‡ªåŠ¨ç”Ÿæˆå¸®åŠ©æ–‡æ¡£**ï¼š
```bash
# ç”Ÿæˆè¿ç»´æ‰‹å†Œ

generate_operations_manual() {
    local manual_file="$SCRIPT_DIR/OPERATIONS.md"
    
    cat > "$manual_file" << EOF
# $SCRIPT_NAME è¿ç»´æ‰‹å†Œ


# åŸºæœ¬ä¿¡æ¯


- **è„šæœ¬ç‰ˆæœ¬**: $SCRIPT_VERSION
- **ç»´æŠ¤å›¢é˜Ÿ**: è¿ç»´å›¢é˜Ÿ
- **æ›´æ–°æ—¶é—´**: $(date '+%Y-%m-%d')

# éƒ¨ç½²ä¿¡æ¯  


- **å®‰è£…ä½ç½®**: $SCRIPT_DIR/$SCRIPT_NAME
- **é…ç½®æ–‡ä»¶**: $CONFIG_FILE
- **æ—¥å¿—ç›®å½•**: $LOG_DIR
- **PIDæ–‡ä»¶**: $PID_FILE

# ä½¿ç”¨æ–¹æ³•


\`\`\`bash
# åŸºæœ¬ä½¿ç”¨

$SCRIPT_NAME [é€‰é¡¹] [å‚æ•°]

# æµ‹è¯•æ¨¡å¼

$SCRIPT_NAME --test

# è°ƒè¯•æ¨¡å¼

DEBUG_MODE=true $SCRIPT_NAME --verbose
\`\`\`

# æ•…éšœæ’æŸ¥


## å¸¸è§é—®é¢˜


1. **æƒé™ä¸è¶³é”™è¯¯**
   - æ£€æŸ¥è„šæœ¬æ–‡ä»¶æƒé™: \`ls -l $SCRIPT_NAME\`
   - æ£€æŸ¥ç›®å½•æƒé™: \`ls -ld $LOG_DIR\`

2. **ç£ç›˜ç©ºé—´ä¸è¶³**
   - æ£€æŸ¥ç£ç›˜ä½¿ç”¨: \`df -h\`
   - æ¸…ç†æ—§æ—¥å¿—: \`find $LOG_DIR -name "*.log" -mtime +30 -delete\`

## æ—¥å¿—æŸ¥çœ‹


\`\`\`bash
# æŸ¥çœ‹æœ€æ–°æ—¥å¿—

tail -f $LOG_DIR/${SCRIPT_NAME%.sh}.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—

grep ERROR $LOG_DIR/${SCRIPT_NAME%.sh}.log
\`\`\`

# ç›‘æ§æŒ‡æ ‡


- æ‰§è¡ŒæˆåŠŸç‡
- å¹³å‡æ‰§è¡Œæ—¶é—´
- èµ„æºä½¿ç”¨æƒ…å†µ
- é”™è¯¯é¢‘ç‡

# è”ç³»ä¿¡æ¯


- **å€¼ç­ç”µè¯**: 400-XXX-XXXX
- **é‚®ç®±**: ops@company.com
- **æ–‡æ¡£åœ°å€**: http://wiki.company.com/ops
EOF

    log_message "INFO" "è¿ç»´æ‰‹å†Œå·²ç”Ÿæˆ: $manual_file"
}
```

---

## 10. ğŸ¯ å®æˆ˜æ¡ˆä¾‹ä¸æ¨¡æ¿



### 10.1 å®Œæ•´è„šæœ¬æ¨¡æ¿



**ğŸ“‹ ç”Ÿäº§çº§è„šæœ¬æ¨¡æ¿**ï¼š
```bash
#!/bin/bash

#===============================================================================

# è„šæœ¬åç§°: system_maintenance.sh

# åŠŸèƒ½æè¿°: ç³»ç»Ÿç»´æŠ¤è‡ªåŠ¨åŒ–è„šæœ¬ï¼ŒåŒ…å«æ—¥å¿—æ¸…ç†ã€å¤‡ä»½ã€ç›‘æ§ç­‰åŠŸèƒ½

# ç‰ˆæœ¬ä¿¡æ¯: v1.0.0

# åˆ›å»ºæ—¥æœŸ: 2025-09-17

# ä½œè€…ä¿¡æ¯: è¿ç»´å›¢é˜Ÿ <ops@company.com>

#===============================================================================


set -euo pipefail

# ==================== å…¨å±€å˜é‡å®šä¹‰ ====================

readonly SCRIPT_NAME=$(basename "$0")
readonly SCRIPT_DIR=$(cd "$(dirname "$0")" && pwd)
readonly SCRIPT_VERSION="1.0.0"
readonly RUN_USER=$(whoami)

# è·¯å¾„é…ç½®

readonly LOG_DIR="/var/log/cron-scripts"
readonly WORK_DIR="/tmp/${SCRIPT_NAME%.sh}"
readonly CONFIG_FILE="/etc/${SCRIPT_NAME%.sh}.conf"
readonly PID_FILE="/var/run/${SCRIPT_NAME%.sh}.pid"

# ä¸šåŠ¡é…ç½®é»˜è®¤å€¼

DEFAULT_LOG_RETENTION=30
DEFAULT_BACKUP_RETENTION=7
DEFAULT_TIMEOUT=300

# å…¨å±€çŠ¶æ€å˜é‡

TEMP_FILES=()
DEBUG_MODE=${DEBUG_MODE:-false}
DRY_RUN=${DRY_RUN:-false}

# ==================== æ ¸å¿ƒå‡½æ•°å®šä¹‰ ====================


# æ—¥å¿—è®°å½•å‡½æ•°

log_message() {
    local level="$1"
    local message="$2"
    local timestamp=$(date "+%Y-%m-%d %H:%M:%S")
    local pid=$$
    
    mkdir -p "$LOG_DIR"
    local log_entry="[$timestamp] [$level] [$pid] $message"
    
    echo "$log_entry" | tee -a "$LOG_DIR/${SCRIPT_NAME%.sh}.log"
}

# é”™è¯¯å¤„ç†å‡½æ•°

handle_error() {
    local exit_code=$?
    local line_number=$1
    
    log_message "ERROR" "è„šæœ¬åœ¨ç¬¬ ${line_number} è¡Œå‘ç”Ÿé”™è¯¯ï¼Œé€€å‡ºç ï¼š${exit_code}"
    cleanup_resources
    exit ${exit_code}
}

# èµ„æºæ¸…ç†å‡½æ•°

cleanup_resources() {
    log_message "INFO" "å¼€å§‹æ¸…ç†ç³»ç»Ÿèµ„æº"
    
#    # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
    for temp_file in "${TEMP_FILES[@]}"; do
        [[ -f "$temp_file" ]] && rm -f "$temp_file"
    done
    
#    # æ¸…ç†å·¥ä½œç›®å½•
    [[ -d "$WORK_DIR" ]] && rmdir "$WORK_DIR" 2>/dev/null || true
    
#    # æ¸…ç†PIDæ–‡ä»¶
    [[ -f "$PID_FILE" ]] && rm -f "$PID_FILE"
    
    log_message "INFO" "èµ„æºæ¸…ç†å®Œæˆ"
}

# å•å®ä¾‹æ£€æŸ¥

check_single_instance() {
    if [[ -f "$PID_FILE" ]]; then
        local old_pid=$(cat "$PID_FILE")
        if kill -0 "$old_pid" 2>/dev/null; then
            log_message "ERROR" "è„šæœ¬å·²åœ¨è¿è¡Œä¸­ï¼ŒPID: $old_pid"
            exit 1
        else
            rm -f "$PID_FILE"
        fi
    fi
    
    echo $$ > "$PID_FILE"
    log_message "INFO" "åˆ›å»ºPIDæ–‡ä»¶ï¼Œå½“å‰PID: $$"
}

# ==================== ä¸»ä¸šåŠ¡å‡½æ•° ====================


# ç³»ç»Ÿç»´æŠ¤ä¸»å‡½æ•°

perform_maintenance() {
    log_message "INFO" "å¼€å§‹æ‰§è¡Œç³»ç»Ÿç»´æŠ¤ä»»åŠ¡"
    
#    # æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
    check_system_status
    
#    # æ¸…ç†æ—§æ—¥å¿—
    cleanup_old_logs
    
#    # æ‰§è¡Œç³»ç»Ÿå¤‡ä»½
    perform_system_backup
    
#    # æ£€æŸ¥ç£ç›˜ä½¿ç”¨ç‡
    check_disk_usage
    
    log_message "INFO" "ç³»ç»Ÿç»´æŠ¤ä»»åŠ¡å®Œæˆ"
}

# ==================== ç¨‹åºå…¥å£ ====================


main() {
#    # è®¾ç½®ä¿¡å·å¤„ç†
    trap 'handle_error ${LINENO}' ERR
    trap 'cleanup_resources' EXIT INT TERM
    
#    # åŸºç¡€æ£€æŸ¥
    check_single_instance
    
#    # æ‰§è¡Œä¸»è¦ä¸šåŠ¡
    perform_maintenance
    
    log_message "INFO" "$SCRIPT_NAME æ‰§è¡Œå®Œæˆ"
    exit 0
}

# è„šæœ¬æ‰§è¡Œå…¥å£

if [[ "${BASH_SOURCE[0]}" == "${0}" ]]; then
    main "$@"
fi
```

### 10.2 æ•°æ®åº“å¤‡ä»½è„šæœ¬ç¤ºä¾‹



**ğŸ’¾ ä¸“ä¸šæ•°æ®åº“å¤‡ä»½è„šæœ¬**ï¼š
```bash
# æ•°æ®åº“å¤‡ä»½å‡½æ•°

backup_databases() {
    local db_list="$1"
    local backup_base_dir="$2"
    local retention_days="$3"
    
    log_message "INFO" "å¼€å§‹æ•°æ®åº“å¤‡ä»½ä»»åŠ¡"
    
#    # åˆ›å»ºå¤‡ä»½ç›®å½•
    local backup_date=$(date +%Y%m%d_%H%M%S)
    local backup_dir="$backup_base_dir/$backup_date"
    mkdir -p "$backup_dir"
    
#    # åˆ†å‰²æ•°æ®åº“åˆ—è¡¨å¹¶é€ä¸ªå¤‡ä»½
    IFS=',' read -ra DATABASES <<< "$db_list"
    for db in "${DATABASES[@]}"; do
        backup_single_database "$db" "$backup_dir"
    done
    
#    # æ¸…ç†è¿‡æœŸå¤‡ä»½
    cleanup_old_backups "$backup_base_dir" "$retention_days"
    
    log_message "INFO" "æ•°æ®åº“å¤‡ä»½ä»»åŠ¡å®Œæˆ"
}

# å•ä¸ªæ•°æ®åº“å¤‡ä»½

backup_single_database() {
    local db_name="$1"
    local backup_dir="$2"
    local backup_file="$backup_dir/${db_name}.sql"
    
    log_message "INFO" "å¤‡ä»½æ•°æ®åº“: $db_name"
    
#    # æ£€æŸ¥æ•°æ®åº“æ˜¯å¦å­˜åœ¨
    if ! mysql -e "USE $db_name" 2>/dev/null; then
        log_message "ERROR" "æ•°æ®åº“ä¸å­˜åœ¨: $db_name"
        return 4
    fi
    
#    # æ‰§è¡Œå¤‡ä»½
    if mysqldump \
        --single-transaction \
        --routines \
        --triggers \
        --lock-tables=false \
        "$db_name" > "$backup_file"; then
        
#        # å‹ç¼©å¤‡ä»½æ–‡ä»¶
        gzip "$backup_file"
        log_message "INFO" "æ•°æ®åº“å¤‡ä»½å®Œæˆ: ${backup_file}.gz"
        
#        # éªŒè¯å¤‡ä»½æ–‡ä»¶
        if [[ -s "${backup_file}.gz" ]]; then
            log_message "INFO" "å¤‡ä»½æ–‡ä»¶éªŒè¯æˆåŠŸ"
        else
            log_message "ERROR" "å¤‡ä»½æ–‡ä»¶ä¸ºç©ºæˆ–ä¸å­˜åœ¨"
            return 6
        fi
    else
        log_message "ERROR" "æ•°æ®åº“å¤‡ä»½å¤±è´¥: $db_name"
        return 6
    fi
}
```

---

## 11. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“



### 11.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒè¦ç‚¹



```
ğŸ”¸ è„šæœ¬ç»“æ„ï¼šæ ‡å‡†åŒ–çš„æ–‡ä»¶å¤´ã€é…ç½®åŒºã€å‡½æ•°åŒºã€æ‰§è¡ŒåŒº
ğŸ”¸ é”™è¯¯å¤„ç†ï¼šç»Ÿä¸€çš„é€€å‡ºç ã€é”™è¯¯æ•è·ã€é‡è¯•æœºåˆ¶
ğŸ”¸ æ—¥å¿—è§„èŒƒï¼šæ ‡å‡†æ ¼å¼ã€çº§åˆ«ç®¡ç†ã€è½®è½¬æ¸…ç†
ğŸ”¸ å‚æ•°å¤„ç†ï¼šå‘½ä»¤è¡Œè§£æã€é…ç½®æ–‡ä»¶ã€ç¯å¢ƒå˜é‡
ğŸ”¸ èµ„æºç®¡ç†ï¼šä¸´æ—¶æ–‡ä»¶æ¸…ç†ã€å•å®ä¾‹æ§åˆ¶ã€ä¿¡å·å¤„ç†
ğŸ”¸ æƒé™å®‰å…¨ï¼šæœ€å°æƒé™åŸåˆ™ã€æ•æ„Ÿä¿¡æ¯ä¿æŠ¤
ğŸ”¸ è°ƒè¯•æµ‹è¯•ï¼šè°ƒè¯•æ¨¡å¼ã€å¹²è¿è¡Œã€å•å…ƒæµ‹è¯•
ğŸ”¸ æ–‡æ¡£ç»´æŠ¤ï¼šç‰ˆæœ¬ç®¡ç†ã€å†…è”æ–‡æ¡£ã€è¿ç»´æ‰‹å†Œ
```

### 11.2 å…³é”®ç†è§£è¦ç‚¹



**ğŸ”¹ æ— äººå€¼å®ˆçš„ç‰¹æ®Šæ€§**
```
å®šæ—¶ä»»åŠ¡ç¯å¢ƒç‰¹ç‚¹ï¼š
- æœ€å°åŒ–ç¯å¢ƒå˜é‡ï¼Œéœ€è¦æ˜¾å¼è®¾ç½®PATHç­‰
- æ— æ³•äº¤äº’ï¼Œæ‰€æœ‰å¼‚å¸¸æƒ…å†µéƒ½è¦è‡ªåŠ¨å¤„ç†
- å‡ºé”™æ—¶åªèƒ½é€šè¿‡æ—¥å¿—å’Œé€šçŸ¥äº†è§£æƒ…å†µ
- å¿…é¡»è€ƒè™‘å„ç§è¾¹ç•Œæƒ…å†µå’Œå¼‚å¸¸åœºæ™¯
```

**ğŸ”¹ é”™è¯¯å¤„ç†çš„é‡è¦æ€§**
```
ä¸ºä»€ä¹ˆéœ€è¦å®Œå–„çš„é”™è¯¯å¤„ç†ï¼š
- é¿å…éƒ¨åˆ†æ‰§è¡Œå¯¼è‡´çš„æ•°æ®ä¸ä¸€è‡´
- å¿«é€Ÿå®šä½é—®é¢˜ï¼Œå‡å°‘æ•…éšœæ—¶é—´
- ä¿æŠ¤ç³»ç»Ÿèµ„æºï¼Œé˜²æ­¢èµ„æºæ³„éœ²
- æä¾›å‡†ç¡®çš„æ‰§è¡ŒçŠ¶æ€åé¦ˆ
```

**ğŸ”¹ èµ„æºç®¡ç†çš„å¿…è¦æ€§**
```
å®šæ—¶ä»»åŠ¡çš„èµ„æºç®¡ç†åŸåˆ™ï¼š
- åˆ›å»ºçš„å¿…é¡»æ¸…ç†ï¼Œå€Ÿç”¨çš„å¿…é¡»å½’è¿˜
- é˜²æ­¢å¤šå®ä¾‹å¹¶å‘æ‰§è¡Œå¯¼è‡´å†²çª
- åˆç†ä½¿ç”¨ç³»ç»Ÿèµ„æºï¼Œé¿å…å½±å“å…¶ä»–æœåŠ¡
- å¼‚å¸¸é€€å‡ºæ—¶ä¹Ÿè¦ä¿è¯èµ„æºæ¸…ç†
```

### 11.3 å®è·µåº”ç”¨å»ºè®®



**âœ… å¼€å‘é˜¶æ®µ**
- å…ˆåœ¨äº¤äº’ç¯å¢ƒæµ‹è¯•ï¼Œå†é…ç½®åˆ°cron
- ä½¿ç”¨è°ƒè¯•æ¨¡å¼å’Œå¹²è¿è¡Œæ¨¡å¼éªŒè¯é€»è¾‘
- ç¼–å†™æµ‹è¯•ç”¨ä¾‹è¦†ç›–ä¸»è¦åŠŸèƒ½
- è¯¦ç»†è®°å½•é…ç½®å‚æ•°å’Œä¾èµ–æ¡ä»¶

**âœ… éƒ¨ç½²é˜¶æ®µ**  
- è®¾ç½®åˆé€‚çš„æ–‡ä»¶æƒé™å’Œæ‰€æœ‰è€…
- é…ç½®æ—¥å¿—è½®è½¬å’Œç›‘æ§å‘Šè­¦
- å‡†å¤‡å®Œæ•´çš„è¿ç»´æ–‡æ¡£
- å»ºç«‹å¤‡ä»½å’Œæ¢å¤æœºåˆ¶

**âœ… è¿ç»´é˜¶æ®µ**
- å®šæœŸæ£€æŸ¥æ—¥å¿—æ–‡ä»¶å’Œæ‰§è¡ŒçŠ¶æ€
- ç›‘æ§ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
- åŠæ—¶å¤„ç†å‘Šè­¦å’Œå¼‚å¸¸
- æŒç»­ä¼˜åŒ–è„šæœ¬æ€§èƒ½å’Œç¨³å®šæ€§

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
å®šæ—¶è„šæœ¬è¦è§„èŒƒï¼Œç»“æ„æ¸…æ™°æ˜“ç»´æŠ¤
é”™è¯¯å¤„ç†è¦å®Œå–„ï¼Œæ—¥å¿—è®°å½•è¦è¯¦ç»†  
èµ„æºç®¡ç†è¦åˆ°ä½ï¼Œæƒé™å®‰å…¨è¦é‡è§†
è°ƒè¯•æµ‹è¯•ä¸èƒ½å°‘ï¼Œæ–‡æ¡£ç»´æŠ¤è¦è·Ÿä¸Š
```

> ğŸ’¡ **æœ€é‡è¦çš„å»ºè®®**ï¼šç¼–å†™å®šæ—¶ä»»åŠ¡è„šæœ¬æ—¶ï¼Œè¦å§‹ç»ˆç«™åœ¨"3ä¸ªæœˆåçš„è‡ªå·±"æˆ–"å…¶ä»–ç»´æŠ¤äººå‘˜"çš„è§’åº¦æ€è€ƒï¼Œç¡®ä¿è„šæœ¬çš„å¯ç†è§£æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚