---
title: 9ã€DHCPæœåŠ¡æ•…éšœå¤„ç†
---
## ğŸ“š ç›®å½•

1. [DHCPæœåŠ¡åŸºç¡€æ¦‚å¿µ](#1-DHCPæœåŠ¡åŸºç¡€æ¦‚å¿µ)
2. [DHCPæœåŠ¡çŠ¶æ€æ£€æŸ¥](#2-DHCPæœåŠ¡çŠ¶æ€æ£€æŸ¥)
3. [IPåœ°å€æ± è€—å°½é—®é¢˜](#3-IPåœ°å€æ± è€—å°½é—®é¢˜)
4. [DHCPç§Ÿçº¦ç®¡ç†](#4-DHCPç§Ÿçº¦ç®¡ç†)
5. [DHCPä¸­ç»§é…ç½®æ•…éšœ](#5-DHCPä¸­ç»§é…ç½®æ•…éšœ)
6. [å®¢æˆ·ç«¯DHCPè¯·æ±‚å¤±è´¥](#6-å®¢æˆ·ç«¯DHCPè¯·æ±‚å¤±è´¥)
7. [DHCPæœåŠ¡å™¨å†²çªå¤„ç†](#7-DHCPæœåŠ¡å™¨å†²çªå¤„ç†)
8. [é™æ€IPä¸DHCPå†²çª](#8-é™æ€IPä¸DHCPå†²çª)
9. [DHCPé€‰é¡¹é…ç½®é”™è¯¯](#9-DHCPé€‰é¡¹é…ç½®é”™è¯¯)
10. [æ•…éšœæ’æŸ¥å·¥å…·ä¸æ–¹æ³•](#10-æ•…éšœæ’æŸ¥å·¥å…·ä¸æ–¹æ³•)
11. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#11-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ DHCPæœåŠ¡åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯DHCPæœåŠ¡


**ç®€å•ç†è§£**ï¼šDHCPï¼ˆDynamic Host Configuration Protocolï¼‰å°±åƒç½‘ç»œä¸­çš„"è‡ªåŠ¨åˆ†é…å‘˜"

ğŸ  **ç”Ÿæ´»ç±»æ¯”**
> æƒ³è±¡ä¸€ä¸ªå¤§å‹åœè½¦åœºï¼ŒDHCPæœåŠ¡å™¨å°±åƒåœè½¦åœºç®¡ç†å‘˜ï¼š
> - è½¦è¾†è¿›å…¥æ—¶è‡ªåŠ¨åˆ†é…åœè½¦ä½ï¼ˆIPåœ°å€ï¼‰
> - è®°å½•å“ªä¸ªè½¦å ç”¨äº†å“ªä¸ªä½ç½®ï¼ˆç§Ÿçº¦è®°å½•ï¼‰
> - è½¦è¾†ç¦»å¼€æ—¶å›æ”¶åœè½¦ä½ï¼ˆé‡Šæ”¾IPï¼‰
> - è¿˜ä¼šå‘Šè¯‰ä½ å‡ºå£åœ¨å“ªé‡Œï¼ˆç½‘å…³åœ°å€ï¼‰

### 1.2 DHCPå·¥ä½œæµç¨‹


**æ ¸å¿ƒå››æ­¥æ¡æ‰‹è¿‡ç¨‹**ï¼š
```
å®¢æˆ·ç«¯                    DHCPæœåŠ¡å™¨
   |                          |
   |----[1] DISCOVER--------->|  "æˆ‘éœ€è¦ä¸€ä¸ªIPåœ°å€"
   |                          |
   |<---[2] OFFER-------------|  "æˆ‘å¯ä»¥ç»™ä½ 192.168.1.100"
   |                          |
   |----[3] REQUEST---------->|  "å¥½çš„ï¼Œæˆ‘è¦è¿™ä¸ªåœ°å€"
   |                          |
   |<---[4] ACK---------------|  "ç¡®è®¤åˆ†é…ç»™ä½ äº†"
```

**ğŸ“ è¯¦ç»†è§£é‡Š**ï¼š
1. **DISCOVERé˜¶æ®µ**ï¼šå®¢æˆ·ç«¯å¹¿æ’­å¯»æ‰¾DHCPæœåŠ¡å™¨
2. **OFFERé˜¶æ®µ**ï¼šæœåŠ¡å™¨æä¾›å¯ç”¨çš„IPåœ°å€é…ç½®
3. **REQUESTé˜¶æ®µ**ï¼šå®¢æˆ·ç«¯é€‰æ‹©å¹¶è¯·æ±‚ç‰¹å®šé…ç½®
4. **ACKé˜¶æ®µ**ï¼šæœåŠ¡å™¨ç¡®è®¤åˆ†é…ï¼Œå®¢æˆ·ç«¯å¼€å§‹ä½¿ç”¨

### 1.3 DHCPæä¾›çš„ç½‘ç»œé…ç½®


**ğŸ”§ åŸºæœ¬é…ç½®ä¿¡æ¯**ï¼š
- **IPåœ°å€**ï¼šå®¢æˆ·ç«¯åœ¨ç½‘ç»œä¸­çš„å”¯ä¸€æ ‡è¯†
- **å­ç½‘æ©ç **ï¼šç¡®å®šç½‘ç»œèŒƒå›´
- **é»˜è®¤ç½‘å…³**ï¼šè®¿é—®å…¶ä»–ç½‘ç»œçš„å‡ºå£
- **DNSæœåŠ¡å™¨**ï¼šåŸŸåè§£ææœåŠ¡

**ğŸ“Š æ‰©å±•é…ç½®é€‰é¡¹**ï¼š
- NTPæœåŠ¡å™¨ï¼ˆæ—¶é—´åŒæ­¥ï¼‰
- TFTPæœåŠ¡å™¨ï¼ˆç½‘ç»œå¯åŠ¨ï¼‰
- åŸŸååç¼€
- WINSæœåŠ¡å™¨
- é™æ€è·¯ç”±

---

## 2. ğŸ” DHCPæœåŠ¡çŠ¶æ€æ£€æŸ¥


### 2.1 æ£€æŸ¥DHCPæœåŠ¡è¿è¡ŒçŠ¶æ€


**ğŸ’¡ åŸºç¡€çŠ¶æ€æ£€æŸ¥**

**systemdç³»ç»Ÿæ£€æŸ¥**ï¼š
```bash
# æŸ¥çœ‹DHCPæœåŠ¡çŠ¶æ€
sudo systemctl status dhcpd
# æˆ–è€…å¯¹äºISC DHCP
sudo systemctl status isc-dhcp-server

# æ£€æŸ¥æœåŠ¡æ˜¯å¦å¼€æœºå¯åŠ¨
sudo systemctl is-enabled dhcpd
```

**ğŸ” è¯¦ç»†ä¿¡æ¯è·å–**ï¼š
```bash
# æŸ¥çœ‹æœåŠ¡è¯¦ç»†çŠ¶æ€å’Œæœ€è¿‘æ—¥å¿—
sudo systemctl status dhcpd -l

# æŸ¥çœ‹æœåŠ¡å¯åŠ¨å¤±è´¥åŸå› 
sudo journalctl -u dhcpd --since "1 hour ago"
```

### 2.2 è¿›ç¨‹å’Œç«¯å£æ£€æŸ¥


**ğŸ“ˆ è¿›ç¨‹çŠ¶æ€ç›‘æ§**ï¼š
```bash
# æ£€æŸ¥DHCPè¿›ç¨‹æ˜¯å¦è¿è¡Œ
ps aux | grep dhcp | grep -v grep

# æ£€æŸ¥ç«¯å£ç›‘å¬çŠ¶æ€
sudo netstat -ulnp | grep :67
sudo ss -ulnp | grep :67

# æ£€æŸ¥ç½‘ç»œæ¥å£ç»‘å®š
sudo lsof -i :67
```

**ğŸ¯ å¿«é€Ÿè¯Šæ–­å‘½ä»¤**ï¼š
```bash
# ä¸€é”®æ£€æŸ¥DHCPæœåŠ¡çŠ¶æ€
dhcp_check() {
    echo "=== DHCP Service Status ==="
    systemctl is-active dhcpd
    echo "=== Port 67 Listening ==="
    ss -ulnp | grep :67 || echo "Port 67 not listening"
    echo "=== Recent Logs ==="
    journalctl -u dhcpd --since "10 minutes ago" --no-pager -n 10
}
```

### 2.3 é…ç½®æ–‡ä»¶è¯­æ³•æ£€æŸ¥


**âš ï¸ é…ç½®æ–‡ä»¶éªŒè¯**ï¼š
```bash
# æ£€æŸ¥dhcpd.confè¯­æ³•
sudo dhcpd -t -cf /etc/dhcp/dhcpd.conf

# æ£€æŸ¥é…ç½®æ–‡ä»¶æƒé™
ls -la /etc/dhcp/dhcpd.conf

# å¤‡ä»½å¹¶æµ‹è¯•æ–°é…ç½®
sudo cp /etc/dhcp/dhcpd.conf /etc/dhcp/dhcpd.conf.backup
sudo dhcpd -t -cf /etc/dhcp/dhcpd.conf.new
```

---

## 3. ğŸ“Š IPåœ°å€æ± è€—å°½é—®é¢˜


### 3.1 åœ°å€æ± è€—å°½çš„ç—‡çŠ¶è¡¨ç°


**ğŸš¨ å…¸å‹æ•…éšœç°è±¡**ï¼š
- æ–°è®¾å¤‡æ— æ³•è·å–IPåœ°å€
- å®¢æˆ·ç«¯æ˜¾ç¤º"æ— æ³•è·å¾—ç½‘ç»œåœ°å€"
- DHCPæ—¥å¿—æ˜¾ç¤º"no free leases"
- ç½‘ç»œä¸­éƒ¨åˆ†è®¾å¤‡æ­£å¸¸ï¼Œæ–°åŠ å…¥è®¾å¤‡å¼‚å¸¸

**ğŸ’¡ ç†è§£åœ°å€æ± è€—å°½**
> å°±åƒé…’åº—æˆ¿é—´å…¨éƒ¨ä½æ»¡äº†ï¼Œæ–°å®¢äººæ¥äº†æ²¡æœ‰æˆ¿é—´å¯ä»¥åˆ†é…ã€‚å³ä½¿æœ‰äº›æˆ¿é—´çš„å®¢äººå·²ç»é€€æˆ¿ï¼Œä½†æˆ¿é—´è¿˜æ²¡æœ‰è¢«æ¸…ç†å‡ºæ¥é‡æ–°ä½¿ç”¨ã€‚

### 3.2 æ£€æŸ¥åœ°å€æ± ä½¿ç”¨æƒ…å†µ


**ğŸ“‹ æŸ¥çœ‹å½“å‰ç§Ÿçº¦çŠ¶æ€**ï¼š
```bash
# æŸ¥çœ‹dhcpd.leasesæ–‡ä»¶
sudo cat /var/lib/dhcp/dhcpd.leases | tail -50

# ç»Ÿè®¡æ´»è·ƒç§Ÿçº¦æ•°é‡
sudo dhcp-lease-list

# æˆ–è€…ä½¿ç”¨awkç»Ÿè®¡
awk '/lease/ { ip = $2 } /binding state active/ { active[ip] = 1 } 
END { for (ip in active) print ip }' /var/lib/dhcp/dhcpd.leases | wc -l
```

**ğŸ“ˆ åœ°å€æ± é…ç½®æ£€æŸ¥**ï¼š
```bash
# æŸ¥çœ‹é…ç½®çš„åœ°å€èŒƒå›´
grep -n "range" /etc/dhcp/dhcpd.conf
grep -n "pool" /etc/dhcp/dhcpd.conf
```

### 3.3 åœ°å€æ± æ‰©å®¹è§£å†³æ–¹æ¡ˆ


**ğŸ”§ ä¸´æ—¶è§£å†³æ–¹æ¡ˆ**ï¼š

**æ¸…ç†è¿‡æœŸç§Ÿçº¦**ï¼š
```bash
# åœæ­¢DHCPæœåŠ¡
sudo systemctl stop dhcpd

# å¤‡ä»½ç§Ÿçº¦æ–‡ä»¶
sudo cp /var/lib/dhcp/dhcpd.leases /var/lib/dhcp/dhcpd.leases.backup

# æ¸…ç©ºç§Ÿçº¦æ–‡ä»¶ï¼ˆè°¨æ…æ“ä½œï¼‰
sudo > /var/lib/dhcp/dhcpd.leases

# é‡å¯æœåŠ¡
sudo systemctl start dhcpd
```

**ğŸ”„ æ°¸ä¹…è§£å†³æ–¹æ¡ˆ**ï¼š

**æ‰©å¤§åœ°å€æ± èŒƒå›´**ï¼š
```bash
# ç¼–è¾‘DHCPé…ç½®æ–‡ä»¶
sudo vi /etc/dhcp/dhcpd.conf

# ä¿®æ”¹åœ°å€èŒƒå›´ç¤ºä¾‹
subnet 192.168.1.0 netmask 255.255.255.0 {
    range 192.168.1.100 192.168.1.200;  # åŸæ¥100ä¸ªåœ°å€
    # æ‰©å±•ä¸ºï¼š
    range 192.168.1.50 192.168.1.250;   # æ‰©å±•åˆ°200ä¸ªåœ°å€
    option routers 192.168.1.1;
    option subnet-mask 255.255.255.0;
}
```

### 3.4 åœ°å€ä½¿ç”¨ä¼˜åŒ–ç­–ç•¥


| ç­–ç•¥ | **æè¿°** | **é€‚ç”¨åœºæ™¯** | **ä¼˜ç¼ºç‚¹** |
|------|----------|-------------|-----------|
| ğŸ•’ **ç¼©çŸ­ç§Ÿçº¦æ—¶é—´** | `default-lease-time 1800;` | `ä¸´æ—¶è®¾å¤‡å¤š` | `é‡Šæ”¾å¿«ï¼Œä½†è¯·æ±‚é¢‘ç¹` |
| ğŸ“± **è®¾å¤‡åˆ†ç±»ç®¡ç†** | `ä¸åŒè®¾å¤‡ç±»å‹ä¸åŒæ± ` | `æ··åˆç½‘ç»œç¯å¢ƒ` | `ç²¾ç¡®æ§åˆ¶ï¼Œé…ç½®å¤æ‚` |
| ğŸ”’ **é™æ€é¢„ç•™** | `é‡è¦è®¾å¤‡å›ºå®šIP` | `æœåŠ¡å™¨ã€æ‰“å°æœº` | `ç¨³å®šå¯é ï¼Œå‡å°‘åŠ¨æ€æ± ` |
| ğŸ“Š **ç›‘æ§å‘Šè­¦** | `åœ°å€ä½¿ç”¨ç‡ç›‘æ§` | `æ‰€æœ‰ç¯å¢ƒ` | `é¢„é˜²æ€§ç»´æŠ¤` |

---

## 4. ğŸ“‹ DHCPç§Ÿçº¦ç®¡ç†


### 4.1 ç†è§£DHCPç§Ÿçº¦æœºåˆ¶


**ğŸ  ç§Ÿçº¦ç”Ÿæ´»ç±»æ¯”**
> DHCPç§Ÿçº¦å°±åƒç§Ÿæˆ¿åˆåŒï¼š
> - ç§Ÿå®¢ï¼ˆå®¢æˆ·ç«¯ï¼‰å‘æˆ¿ä¸œï¼ˆDHCPæœåŠ¡å™¨ï¼‰ç”³è¯·æˆ¿å­ï¼ˆIPåœ°å€ï¼‰
> - ç­¾è®¢æœ‰æœŸé™çš„åˆåŒï¼ˆç§Ÿçº¦æ—¶é—´ï¼‰
> - åˆ°æœŸå‰å¯ä»¥ç»­ç§Ÿï¼ˆrenewï¼‰
> - ä¸ç»­ç§Ÿå°±æ”¶å›æˆ¿å­ï¼ˆlease expireï¼‰

**ğŸ“… ç§Ÿçº¦ç”Ÿå‘½å‘¨æœŸ**ï¼š
```
è·å–ç§Ÿçº¦ â†’ ä½¿ç”¨æœŸ â†’ ç»­çº¦æœŸ(50%) â†’ é‡æ–°ç»‘å®šæœŸ(87.5%) â†’ ç§Ÿçº¦åˆ°æœŸ
    â†“         â†“           â†“              â†“            â†“
   ACK     æ­£å¸¸ä½¿ç”¨    å°è¯•ç»­çº¦        å¹¿æ’­ç»­çº¦      é‡Šæ”¾IP
```

### 4.2 ç§Ÿçº¦æ–‡ä»¶åˆ†æ


**ğŸ” ç§Ÿçº¦æ–‡ä»¶ç»“æ„è§£è¯»**ï¼š
```bash
# æŸ¥çœ‹ç§Ÿçº¦æ–‡ä»¶å†…å®¹
sudo cat /var/lib/dhcp/dhcpd.leases

# å…¸å‹ç§Ÿçº¦è®°å½•æ ¼å¼
lease 192.168.1.150 {
  starts 2 2025/01/15 08:30:00;        # ç§Ÿçº¦å¼€å§‹æ—¶é—´
  ends 2 2025/01/15 20:30:00;          # ç§Ÿçº¦ç»“æŸæ—¶é—´  
  cltt 2 2025/01/15 08:30:00;          # å®¢æˆ·ç«¯æœ€åäº‹åŠ¡æ—¶é—´
  binding state active;                 # ç»‘å®šçŠ¶æ€ï¼šactive/free/backup
  next binding state free;              # ä¸‹ä¸€ä¸ªçŠ¶æ€
  hardware ethernet 00:1a:2b:3c:4d:5e; # å®¢æˆ·ç«¯MACåœ°å€
  client-hostname "laptop01";           # å®¢æˆ·ç«¯ä¸»æœºå
}
```

### 4.3 æ‰‹åŠ¨ç®¡ç†ç§Ÿçº¦


**ğŸ”§ æ‰‹åŠ¨é‡Šæ”¾ç‰¹å®šç§Ÿçº¦**ï¼š
```bash
# åˆ›å»ºç§Ÿçº¦ç®¡ç†è„šæœ¬
cat > /usr/local/bin/dhcp-lease-mgr << 'EOF'
#!/bin/bash
case "$1" in
    "list")
        echo "=== Active DHCP Leases ==="
        awk '/lease/ { ip = $2 } /binding state active/ { print ip }' \
        /var/lib/dhcp/dhcpd.leases | sort -V
        ;;
    "release")
        if [ -z "$2" ]; then
            echo "Usage: $0 release <IP_ADDRESS>"
            exit 1
        fi
        echo "Releasing lease for $2..."
        # è¿™é‡Œéœ€è¦æ›´å¤æ‚çš„è„šæœ¬æ¥ä¿®æ”¹ç§Ÿçº¦çŠ¶æ€
        ;;
    *)
        echo "Usage: $0 {list|release}"
        exit 1
        ;;
esac
EOF

chmod +x /usr/local/bin/dhcp-lease-mgr
```

### 4.4 ç§Ÿçº¦æ—¶é—´ä¼˜åŒ–é…ç½®


**âš¡ ç§Ÿçº¦æ—¶é—´é…ç½®ç­–ç•¥**ï¼š

```bash
# ç¼–è¾‘DHCPé…ç½®æ–‡ä»¶
sudo vi /etc/dhcp/dhcpd.conf

# ä¸åŒåœºæ™¯çš„ç§Ÿçº¦æ—¶é—´é…ç½®
subnet 192.168.1.0 netmask 255.255.255.0 {
    range 192.168.1.100 192.168.1.200;
    
    # åŠå…¬ç½‘ç»œï¼š8å°æ—¶ç§Ÿçº¦
    default-lease-time 28800;    # 8å°æ—¶
    max-lease-time 86400;        # æœ€å¤§24å°æ—¶
    
    # å®¢äººç½‘ç»œï¼šçŸ­ç§Ÿçº¦
    # default-lease-time 3600;   # 1å°æ—¶
    # max-lease-time 7200;       # æœ€å¤§2å°æ—¶
    
    # æœåŠ¡å™¨ç½‘ç»œï¼šé•¿ç§Ÿçº¦
    # default-lease-time 604800; # 7å¤©
    # max-lease-time 2592000;    # æœ€å¤§30å¤©
}
```

**ğŸ“Š ç§Ÿçº¦æ—¶é—´é€‰æ‹©æŒ‡å¯¼**ï¼š

| ç½‘ç»œç±»å‹ | **å»ºè®®ç§Ÿçº¦æ—¶é—´** | **åŸå› ** | **æ³¨æ„äº‹é¡¹** |
|---------|---------------|---------|-------------|
| ğŸ¢ **åŠå…¬ç½‘ç»œ** | `8-24å°æ—¶` | `è®¾å¤‡ç¨³å®šï¼Œå‡å°‘ç»­çº¦å¼€é”€` | `è€ƒè™‘ä¸‹ç­æ—¶é—´` |
| ğŸ“± **æ— çº¿ç½‘ç»œ** | `2-4å°æ—¶` | `ç§»åŠ¨è®¾å¤‡è¾ƒå¤š` | `å¹³è¡¡é‡Šæ”¾é€Ÿåº¦å’Œç¨³å®šæ€§` |
| ğŸ¨ **å®¢äººç½‘ç»œ** | `30åˆ†é’Ÿ-2å°æ—¶` | `è®¾å¤‡æµåŠ¨æ€§å¤§` | `å¿«é€Ÿé‡Šæ”¾IP` |
| ğŸ–¥ï¸ **æœåŠ¡å™¨ç½‘ç»œ** | `7-30å¤©` | `è®¾å¤‡å›ºå®šï¼Œå‡å°‘ç®¡ç†å¼€é”€` | `å¯è€ƒè™‘é™æ€åˆ†é…` |

---

## 5. ğŸŒ‰ DHCPä¸­ç»§é…ç½®æ•…éšœ


### 5.1 ç†è§£DHCPä¸­ç»§æœºåˆ¶


**ğŸŒ ä¸­ç»§çš„ä½œç”¨åŸç†**
> DHCPä¸­ç»§å°±åƒ"ä¿¡ä½¿"ï¼š
> - ä¸åŒç½‘æ®µçš„å®¢æˆ·ç«¯æ— æ³•ç›´æ¥å’ŒDHCPæœåŠ¡å™¨é€šä¿¡ï¼ˆå¹¿æ’­ä¸è·¨ç½‘æ®µï¼‰
> - ä¸­ç»§ä»£ç†æ¥æ”¶æœ¬ç½‘æ®µçš„DHCPè¯·æ±‚
> - è½¬å‘ç»™è¿œç¨‹DHCPæœåŠ¡å™¨
> - å†å°†å“åº”è½¬å‘å›å®¢æˆ·ç«¯

**ğŸ“¡ ä¸­ç»§å·¥ä½œæµç¨‹**ï¼š
```
å®¢æˆ·ç«¯(VLAN10) â†’ è·¯ç”±å™¨/ä¸­ç»§ â†’ DHCPæœåŠ¡å™¨(VLAN20) 
192.168.10.x      192.168.1.1      192.168.20.100
       |              |                   |
   [DISCOVER]    [è½¬å‘DISCOVER]      [OFFERå›å¤]
       |              |                   |
   [æ¥æ”¶OFFER]   [è½¬å‘OFFER]        [å¤„ç†REQUEST]
```

### 5.2 DHCPä¸­ç»§é…ç½®æ£€æŸ¥


**ğŸ” ä¸­ç»§æœåŠ¡çŠ¶æ€æ£€æŸ¥**ï¼š
```bash
# æ£€æŸ¥DHCPä¸­ç»§æœåŠ¡
sudo systemctl status dhcrelay

# æŸ¥çœ‹ä¸­ç»§è¿›ç¨‹å‚æ•°
ps aux | grep dhcrelay

# æ£€æŸ¥ä¸­ç»§é…ç½®æ–‡ä»¶
cat /etc/default/dhcrelay
# æˆ–
cat /etc/sysconfig/dhcrelay
```

**å…¸å‹ä¸­ç»§é…ç½®ç¤ºä¾‹**ï¼š
```bash
# /etc/default/dhcrelay é…ç½®ç¤ºä¾‹
SERVERS="192.168.20.100"        # DHCPæœåŠ¡å™¨åœ°å€
INTERFACES="eth1 eth2"          # ä¸­ç»§ç›‘å¬æ¥å£
OPTIONS=""                      # é¢å¤–é€‰é¡¹
```

### 5.3 ä¸­ç»§æ•…éšœæ’æŸ¥


**ğŸš¨ å¸¸è§ä¸­ç»§æ•…éšœç°è±¡**ï¼š
- æŸä¸ªVLANçš„å®¢æˆ·ç«¯æ— æ³•è·å–IP
- è·¨ç½‘æ®µDHCPè¯·æ±‚å¤±è´¥
- ä¸­ç»§æ—¥å¿—æ˜¾ç¤ºè½¬å‘é”™è¯¯

**ğŸ”§ ä¸­ç»§æ•…éšœè¯Šæ–­æ­¥éª¤**ï¼š

**1. æ£€æŸ¥ç½‘ç»œè¿é€šæ€§**ï¼š
```bash
# ä»ä¸­ç»§è®¾å¤‡ping DHCPæœåŠ¡å™¨
ping 192.168.20.100

# æ£€æŸ¥è·¯ç”±è¡¨
route -n
ip route show
```

**2. æ£€æŸ¥ä¸­ç»§é…ç½®**ï¼š
```bash
# éªŒè¯ä¸­ç»§é…ç½®è¯­æ³•
dhcrelay -t

# æ‰‹åŠ¨å¯åŠ¨ä¸­ç»§æŸ¥çœ‹é”™è¯¯
sudo dhcrelay -d -i eth1 192.168.20.100
```

**3. æŠ“åŒ…åˆ†æä¸­ç»§æµé‡**ï¼š
```bash
# åœ¨ä¸­ç»§è®¾å¤‡æŠ“åŒ…
sudo tcpdump -i eth1 port 67 or port 68 -v

# æ£€æŸ¥DHCPåŒ…æ˜¯å¦æ­£ç¡®è½¬å‘
sudo tcpdump -i any "port 67 or port 68" -n
```

### 5.4 æ€ç§‘è®¾å¤‡DHCPä¸­ç»§é…ç½®


**ğŸ”§ æ€ç§‘è·¯ç”±å™¨ä¸­ç»§é…ç½®**ï¼š
```bash
# è¿›å…¥æ¥å£é…ç½®æ¨¡å¼
configure terminal
interface vlan 10

# é…ç½®DHCPä¸­ç»§
ip helper-address 192.168.20.100

# æ£€æŸ¥é…ç½®
show running-config | include helper
show ip dhcp conflict
```

**åä¸ºè®¾å¤‡ä¸­ç»§é…ç½®**ï¼š
```bash
# ç³»ç»Ÿè§†å›¾ä¸‹é…ç½®
system-view
dhcp enable

# æ¥å£ä¸‹é…ç½®ä¸­ç»§
interface vlanif 10
dhcp select relay
dhcp relay server-ip 192.168.20.100

# æŸ¥çœ‹ä¸­ç»§çŠ¶æ€
display dhcp relay statistics
```

---

## 6. ğŸ’» å®¢æˆ·ç«¯DHCPè¯·æ±‚å¤±è´¥


### 6.1 å®¢æˆ·ç«¯æ•…éšœç—‡çŠ¶åˆ†æ


**ğŸ” å¸¸è§å¤±è´¥ç°è±¡åŠåŸå› **ï¼š

| ç—‡çŠ¶è¡¨ç° | **å¯èƒ½åŸå› ** | **åˆæ­¥åˆ¤æ–­** |
|---------|------------|-------------|
| ğŸ”´ **è·å–169.254.x.xåœ°å€** | `æ— æ³•è”ç³»DHCPæœåŠ¡å™¨` | `ç½‘ç»œè¿æ¥æˆ–æœåŠ¡å™¨é—®é¢˜` |
| â° **è·å–IPéå¸¸æ…¢** | `DHCPæœåŠ¡å™¨å“åº”æ…¢` | `æœåŠ¡å™¨è´Ÿè½½æˆ–ç½‘ç»œå»¶è¿Ÿ` |
| ğŸ”„ **åå¤è·å–ä¸åŒIP** | `åœ°å€æ± ä¸ç¨³å®š` | `ç§Ÿçº¦ç®¡ç†é—®é¢˜` |
| âŒ **å®Œå…¨æ— æ³•è·å–IP** | `DHCPæœåŠ¡åœæ­¢` | `æœåŠ¡å™¨æ•…éšœ` |

### 6.2 Linuxå®¢æˆ·ç«¯æ•…éšœæ’æŸ¥


**ğŸ§ Linuxå®¢æˆ·ç«¯è¯Šæ–­å‘½ä»¤**ï¼š

**åŸºç¡€ç½‘ç»œæ£€æŸ¥**ï¼š
```bash
# æ£€æŸ¥ç½‘ç»œæ¥å£çŠ¶æ€
ip link show
ifconfig -a

# æ£€æŸ¥ç½‘ç»œè¿æ¥
ping -c 4 ç½‘å…³IP
ping -c 4 8.8.8.8
```

**DHCPå®¢æˆ·ç«¯æ“ä½œ**ï¼š
```bash
# é‡Šæ”¾å½“å‰IPï¼ˆä¸åŒå‘è¡Œç‰ˆå‘½ä»¤ä¸åŒï¼‰
# Ubuntu/Debian:
sudo dhclient -r eth0
sudo dhclient eth0

# CentOS/RHEL:
sudo dhclient -r eth0
sudo dhclient -v eth0  # -væ˜¾ç¤ºè¯¦ç»†è¿‡ç¨‹

# æŸ¥çœ‹DHCPå®¢æˆ·ç«¯æ—¥å¿—
sudo journalctl -u NetworkManager --since "1 hour ago"
tail -f /var/log/syslog | grep -i dhcp
```

**æ‰‹åŠ¨æµ‹è¯•DHCPè·å–**ï¼š
```bash
# ä½¿ç”¨dhclientè¯¦ç»†æ¨¡å¼æµ‹è¯•
sudo dhclient -v -d eth0

# ä½¿ç”¨pumpå·¥å…·æµ‹è¯•ï¼ˆå¦‚æœå¯ç”¨ï¼‰
sudo pump -i eth0 -h
```

### 6.3 Windowså®¢æˆ·ç«¯æ•…éšœæ’æŸ¥


**ğŸ’» Windowså®¢æˆ·ç«¯è¯Šæ–­**ï¼š

**å‘½ä»¤è¡Œè¯Šæ–­**ï¼š
```cmd
# æŸ¥çœ‹å½“å‰IPé…ç½®
ipconfig /all

# é‡Šæ”¾å’Œé‡æ–°è·å–IP
ipconfig /release
ipconfig /renew

# åˆ·æ–°DNSè§£æ
ipconfig /flushdns

# é‡ç½®ç½‘ç»œé…ç½®
netsh winsock reset
netsh int ip reset
```

**é«˜çº§è¯Šæ–­å·¥å…·**ï¼š
```cmd
# æŸ¥çœ‹DHCPå®¢æˆ·ç«¯äº‹ä»¶æ—¥å¿—
eventvwr.msc
# æŸ¥çœ‹ Windowsæ—¥å¿— â†’ ç³»ç»Ÿ â†’ ç­›é€‰DHCPç›¸å…³äº‹ä»¶

# ç½‘ç»œè¯Šæ–­å·¥å…·
msdt.exe -id NetworkDiagnosticsDA
```

### 6.4 å®¢æˆ·ç«¯ç½‘ç»œé…ç½®ä¿®å¤


**ğŸ”§ è‡ªåŠ¨ä¿®å¤è„šæœ¬**ï¼š
```bash
#!/bin/bash
# DHCPå®¢æˆ·ç«¯ä¿®å¤è„šæœ¬

echo "=== DHCP Client Repair Script ==="

# æ£€æŸ¥ç½‘ç»œæ¥å£
interface=$(ip route | grep default | awk '{print $5}' | head -n1)
if [ -z "$interface" ]; then
    echo "âŒ No default interface found"
    exit 1
fi

echo "ğŸ” Using interface: $interface"

# æ­¥éª¤1ï¼šé‡å¯ç½‘ç»œæ¥å£
echo "ğŸ”„ Restarting network interface..."
sudo ip link set $interface down
sleep 2
sudo ip link set $interface up
sleep 5

# æ­¥éª¤2ï¼šæ¸…é™¤æ—§IPé…ç½®
echo "ğŸ—‘ï¸ Clearing old IP configuration..."
sudo ip addr flush dev $interface

# æ­¥éª¤3ï¼šé‡æ–°è·å–DHCP
echo "ğŸ“¡ Requesting new DHCP lease..."
sudo dhclient -r $interface 2>/dev/null
sudo dhclient -v $interface

# æ­¥éª¤4ï¼šéªŒè¯ç»“æœ
echo "âœ… Verification:"
ip addr show $interface | grep inet
ping -c 2 $(ip route | grep default | awk '{print $3}') && echo "Gateway reachable" || echo "Gateway unreachable"
```

---

## 7. âš”ï¸ DHCPæœåŠ¡å™¨å†²çªå¤„ç†


### 7.1 è¯†åˆ«DHCPæœåŠ¡å™¨å†²çª


**ğŸš¨ å†²çªçš„å…¸å‹ç—‡çŠ¶**ï¼š
- å®¢æˆ·ç«¯è·å–åˆ°é”™è¯¯çš„ç½‘ç»œé…ç½®
- IPåœ°å€åˆ†é…æ··ä¹±
- ç½‘ç»œè¿æ¥ä¸ç¨³å®š
- DNSæˆ–ç½‘å…³é…ç½®ä¸æ­£ç¡®

**ğŸ’¡ ç†è§£DHCPå†²çª**
> å°±åƒä¸¤ä¸ªæˆ¿ä¸œåŒæ—¶å‡ºç§ŸåŒä¸€å¥—æˆ¿å­ï¼š
> - ç§Ÿå®¢ä¸çŸ¥é“è¯¥å¬è°çš„
> - å¯èƒ½æ‹¿åˆ°ä¸åŒçš„é’¥åŒ™ï¼ˆç½‘ç»œé…ç½®ï¼‰
> - æœ€ç»ˆå¯¼è‡´æ— æ³•æ­£å¸¸ä½¿ç”¨æˆ¿å­ï¼ˆç½‘ç»œæœåŠ¡ï¼‰

### 7.2 æ£€æµ‹ç½‘ç»œä¸­çš„DHCPæœåŠ¡å™¨


**ğŸ” å‘ç°DHCPæœåŠ¡å™¨çš„æ–¹æ³•**ï¼š

**ä½¿ç”¨nmapæ‰«æ**ï¼š
```bash
# æ‰«æç½‘ç»œä¸­çš„DHCPæœåŠ¡å™¨
sudo nmap --script broadcast-dhcp-discover

# è¯¦ç»†æ‰«æç‰¹å®šç½‘æ®µ
sudo nmap -sU -p 67 --script dhcp-discover 192.168.1.0/24
```

**ä½¿ç”¨dhcpingå·¥å…·**ï¼š
```bash
# å®‰è£…dhcpingï¼ˆå¦‚æœæ²¡æœ‰ï¼‰
sudo apt install dhcping  # Ubuntu/Debian
sudo yum install dhcping  # CentOS/RHEL

# æµ‹è¯•DHCPæœåŠ¡å™¨
dhcping -c 192.168.1.100 -s 192.168.1.1 -h aa:bb:cc:dd:ee:ff
```

**æŠ“åŒ…åˆ†æDHCPæµé‡**ï¼š
```bash
# ç›‘å¬DHCPé€šä¿¡ï¼ŒæŸ¥çœ‹å¤šä¸ªæœåŠ¡å™¨å“åº”
sudo tcpdump -i any port 67 or port 68 -v -n

# ä¸“é—¨ç›‘å¬DHCP OFFERåŒ…
sudo tcpdump -i any 'udp port 67 or udp port 68' -v | grep -A 20 "DHCP-Message Option 53, length 1: Offer"
```

### 7.3 è§£å†³DHCPæœåŠ¡å™¨å†²çª


**ğŸ›¡ï¸ å†²çªè§£å†³ç­–ç•¥**ï¼š

**ç«‹å³åœæ­¢éæˆæƒDHCPæœåŠ¡å™¨**ï¼š
```bash
# å¦‚æœå‘ç°æ¶æ„æˆ–æ„å¤–çš„DHCPæœåŠ¡å™¨
# åœ¨è¯¥è®¾å¤‡ä¸Šæ‰§è¡Œï¼š
sudo systemctl stop dhcpd
sudo systemctl disable dhcpd

# æˆ–è€…é€šè¿‡ç½‘ç»œè®¾å¤‡é˜»æ–­
# åœ¨äº¤æ¢æœºä¸Šç¦ç”¨DHCPç›‘å¬ç«¯å£
```

**é…ç½®DHCPæœåŠ¡å™¨æƒé‡**ï¼š
```bash
# ä¸»DHCPæœåŠ¡å™¨é…ç½®ï¼ˆæ›´å¿«å“åº”ï¼‰
subnet 192.168.1.0 netmask 255.255.255.0 {
    range 192.168.1.100 192.168.1.200;
    option routers 192.168.1.1;
    
    # å‡å°‘å“åº”å»¶è¿Ÿ
    min-secs 0;
    default-lease-time 86400;
}

# å¤‡ç”¨DHCPæœåŠ¡å™¨é…ç½®ï¼ˆå»¶è¿Ÿå“åº”ï¼‰
subnet 192.168.1.0 netmask 255.255.255.0 {
    range 192.168.1.201 192.168.1.220;  # ä¸åŒåœ°å€æ®µ
    option routers 192.168.1.1;
    
    # å¢åŠ å“åº”å»¶è¿Ÿï¼Œè®©ä¸»æœåŠ¡å™¨å…ˆå“åº”
    min-secs 5;
    default-lease-time 43200;
}
```

### 7.4 é¢„é˜²DHCPå†²çªæªæ–½


**ğŸ”’ ç½‘ç»œå®‰å…¨é˜²æŠ¤**ï¼š

**DHCP Snoopingé…ç½®**ï¼ˆäº¤æ¢æœºï¼‰ï¼š
```bash
# æ€ç§‘äº¤æ¢æœºDHCP Snoopingé…ç½®
configure terminal
ip dhcp snooping
ip dhcp snooping vlan 10,20

# é…ç½®ä¿¡ä»»ç«¯å£ï¼ˆè¿æ¥åˆæ³•DHCPæœåŠ¡å™¨çš„ç«¯å£ï¼‰
interface fastethernet 0/24
ip dhcp snooping trust

# é™åˆ¶éä¿¡ä»»ç«¯å£çš„DHCPè¯·æ±‚é€Ÿç‡
interface range fastethernet 0/1-23
ip dhcp snooping limit rate 10
```

**ğŸ“Š ç›‘æ§å’Œå‘Šè­¦é…ç½®**ï¼š
```bash
#!/bin/bash
# DHCPæœåŠ¡å™¨ç›‘æ§è„šæœ¬

log_file="/var/log/dhcp-monitor.log"
config_file="/etc/dhcp-monitor.conf"

# é…ç½®æ–‡ä»¶ç¤ºä¾‹
cat > "$config_file" << 'EOF'
# æˆæƒçš„DHCPæœåŠ¡å™¨åˆ—è¡¨
AUTHORIZED_SERVERS="192.168.1.100"
# æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰
CHECK_INTERVAL=300
# é‚®ä»¶å‘Šè­¦åœ°å€
ALERT_EMAIL="admin@company.com"
EOF

# ç›‘æ§è„šæœ¬
check_dhcp_servers() {
    detected_servers=$(nmap --script broadcast-dhcp-discover 2>/dev/null | grep -o '[0-9]\+\.[0-9]\+\.[0-9]\+\.[0-9]\+')
    
    for server in $detected_servers; do
        if ! echo "$AUTHORIZED_SERVERS" | grep -q "$server"; then
            echo "$(date): Unauthorized DHCP server detected: $server" >> "$log_file"
            # å‘é€å‘Šè­¦é‚®ä»¶
            echo "Unauthorized DHCP server $server detected on network" | \
            mail -s "DHCP Security Alert" "$ALERT_EMAIL"
        fi
    done
}
```

---

## 8. ğŸ”„ é™æ€IPä¸DHCPå†²çª


### 8.1 ç†è§£é™æ€IPä¸DHCPå†²çª


**âš¡ å†²çªäº§ç”ŸåŸç†**
> æƒ³è±¡åœè½¦åœºçš„ç®¡ç†æ··ä¹±ï¼š
> - æœ‰äº›è½¦ä½è¢«å›ºå®šåˆ†é…ç»™ç‰¹å®šè½¦è¾†ï¼ˆé™æ€IPï¼‰
> - ç®¡ç†å‘˜ä¸çŸ¥é“è¿™äº›è½¦ä½å·²è¢«å ç”¨
> - ç»§ç»­å°†è¿™äº›è½¦ä½åˆ†é…ç»™ä¸´æ—¶åœè½¦è€…ï¼ˆDHCPå®¢æˆ·ç«¯ï¼‰
> - ç»“æœä¸¤è¾†è½¦äº‰æŠ¢åŒä¸€ä¸ªè½¦ä½ï¼ˆIPå†²çªï¼‰

**ğŸ” å†²çªçš„å…¸å‹è¡¨ç°**ï¼š
- ç½‘ç»œè¿æ¥æ—¶æ–­æ—¶ç»­
- ç³»ç»Ÿæ˜¾ç¤º"IPåœ°å€å†²çª"è­¦å‘Š
- æŸäº›æœåŠ¡æ— æ³•è®¿é—®
- ç½‘ç»œæ€§èƒ½ä¸‹é™

### 8.2 æ£€æµ‹IPåœ°å€å†²çª


**ğŸ” å†²çªæ£€æµ‹æ–¹æ³•**ï¼š

**Linuxç³»ç»Ÿæ£€æµ‹**ï¼š
```bash
# ä½¿ç”¨arpingæ£€æµ‹IPå†²çª
arping -D -I eth0 192.168.1.150
# è¿”å›å€¼0è¡¨ç¤ºæ²¡æœ‰å†²çªï¼Œé0è¡¨ç¤ºæœ‰å†²çª

# æ‰«æç½‘ç»œä¸­çš„é‡å¤IP
nmap -sn 192.168.1.0/24 | grep "Host is up"
arp -a | sort

# æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—ä¸­çš„å†²çªè®°å½•
grep -i "duplicate\|conflict" /var/log/syslog
dmesg | grep -i "duplicate address"
```

**é«˜çº§å†²çªæ£€æµ‹è„šæœ¬**ï¼š
```bash
#!/bin/bash
# IPå†²çªæ£€æµ‹è„šæœ¬

network="192.168.1"
range_start=100
range_end=200

echo "=== IP Conflict Detection ==="
echo "Scanning ${network}.${range_start}-${range_end}..."

for i in $(seq $range_start $range_end); do
    ip="${network}.${i}"
    
    # ä½¿ç”¨arpingæ£€æµ‹
    if arping -D -c 2 -I eth0 "$ip" >/dev/null 2>&1; then
        echo "âœ… $ip - No conflict"
    else
        echo "âš ï¸  $ip - CONFLICT DETECTED!"
        
        # è·å–å†²çªè®¾å¤‡çš„MACåœ°å€
        arp_entry=$(arp -n "$ip" 2>/dev/null)
        echo "   ARP entry: $arp_entry"
        
        # å°è¯•è¯†åˆ«è®¾å¤‡
        mac=$(echo "$arp_entry" | awk '{print $3}')
        if [ -n "$mac" ]; then
            vendor=$(curl -s "https://api.macvendors.com/$mac" 2>/dev/null || echo "Unknown")
            echo "   Device vendor: $vendor"
        fi
    fi
done
```

### 8.3 é…ç½®DHCPæ’é™¤é™æ€IP


**ğŸ›¡ï¸ DHCPæœåŠ¡å™¨æ’é™¤é…ç½®**ï¼š

**åŸºæœ¬æ’é™¤é…ç½®**ï¼š
```bash
# ç¼–è¾‘DHCPé…ç½®æ–‡ä»¶
sudo vi /etc/dhcp/dhcpd.conf

# é…ç½®ç¤ºä¾‹
subnet 192.168.1.0 netmask 255.255.255.0 {
    # æ’é™¤é™æ€IPèŒƒå›´
    range 192.168.1.100 192.168.1.199;   # åªåˆ†é…100-199
    
    # æˆ–è€…ä½¿ç”¨å¤šä¸ªèŒƒå›´æ’é™¤ä¸­é—´çš„é™æ€IP
    range 192.168.1.50 192.168.1.99;     # åŠ¨æ€èŒƒå›´1
    range 192.168.1.150 192.168.1.200;   # åŠ¨æ€èŒƒå›´2
    
    option routers 192.168.1.1;
    option subnet-mask 255.255.255.0;
    option domain-name-servers 8.8.8.8, 8.8.4.4;
    
    default-lease-time 86400;
    max-lease-time 172800;
}

# ä¸ºå…³é”®è®¾å¤‡é…ç½®é™æ€åˆ†é…
host file-server {
    hardware ethernet 00:1a:2b:3c:4d:5e;
    fixed-address 192.168.1.10;
    option host-name "fileserver";
}

host printer01 {
    hardware ethernet 00:aa:bb:cc:dd:ee;
    fixed-address 192.168.1.20;
    option host-name "printer01";
}
```

### 8.4 IPåœ°å€è§„åˆ’æœ€ä½³å®è·µ


**ğŸ“‹ ç½‘ç»œåœ°å€åˆ†é…ç­–ç•¥**ï¼š

| IPèŒƒå›´ | **ç”¨é€”** | **ç®¡ç†æ–¹å¼** | **ç¤ºä¾‹** |
|--------|---------|------------|----------|
| `192.168.1.1-10` | **ç½‘ç»œè®¾å¤‡** | `é™æ€é…ç½®` | `è·¯ç”±å™¨ã€äº¤æ¢æœº` |
| `192.168.1.11-50` | **æœåŠ¡å™¨** | `é™æ€é…ç½®æˆ–DHCPé¢„ç•™` | `æ–‡ä»¶æœåŠ¡å™¨ã€æ‰“å°æœº` |
| `192.168.1.51-200` | **ç»ˆç«¯è®¾å¤‡** | `DHCPåŠ¨æ€åˆ†é…` | `ç”µè„‘ã€æ‰‹æœº` |
| `192.168.1.201-220` | **è®¿å®¢è®¾å¤‡** | `DHCPçŸ­æœŸç§Ÿçº¦` | `ä¸´æ—¶è®¾å¤‡` |
| `192.168.1.221-254` | **é¢„ç•™åœ°å€** | `æœªæ¥æ‰©å±•` | `æ–°è®¾å¤‡ç±»å‹` |

**ğŸ”§ é™æ€IPç®¡ç†è„šæœ¬**ï¼š
```bash
#!/bin/bash
# é™æ€IPç®¡ç†å·¥å…·

static_ip_file="/etc/network/static-ips.txt"

case "$1" in
    "add")
        if [ $# -ne 4 ]; then
            echo "Usage: $0 add <IP> <MAC> <HOSTNAME>"
            exit 1
        fi
        echo "$2 $3 $4" >> "$static_ip_file"
        echo "âœ… Added static IP: $2 for $4 ($3)"
        
        # è‡ªåŠ¨æ›´æ–°DHCPé…ç½®ï¼ˆéœ€è¦æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ï¼‰
        echo "ğŸ”„ Consider updating DHCP configuration to exclude $2"
        ;;
    "list")
        echo "=== Static IP Assignments ==="
        if [ -f "$static_ip_file" ]; then
            cat "$static_ip_file" | column -t
        else
            echo "No static IPs configured"
        fi
        ;;
    "check")
        echo "=== Checking static IP conflicts ==="
        while read ip mac hostname; do
            if arping -D -c 2 -I eth0 "$ip" >/dev/null 2>&1; then
                echo "âœ… $ip ($hostname) - OK"
            else
                echo "âš ï¸  $ip ($hostname) - CONFLICT!"
            fi
        done < "$static_ip_file"
        ;;
    *)
        echo "Usage: $0 {add|list|check}"
        exit 1
        ;;
esac
```

---

## 9. âš™ï¸ DHCPé€‰é¡¹é…ç½®é”™è¯¯


### 9.1 ç†è§£DHCPé€‰é¡¹çš„ä½œç”¨


**ğŸ“‹ DHCPé€‰é¡¹æ¦‚å¿µ**
> DHCPé€‰é¡¹å°±åƒ"å…¥ä½æŒ‡å—"ï¼š
> - ä¸ä»…ç»™ä½ æˆ¿é—´é’¥åŒ™ï¼ˆIPåœ°å€ï¼‰
> - è¿˜å‘Šè¯‰ä½ WiFiå¯†ç ï¼ˆDNSæœåŠ¡å™¨ï¼‰
> - æ¥¼ä¸‹é¤å…ä½ç½®ï¼ˆé»˜è®¤ç½‘å…³ï¼‰
> - å¥èº«æˆ¿å¼€æ”¾æ—¶é—´ï¼ˆNTPæœåŠ¡å™¨ï¼‰
> - ä»¥åŠå…¶ä»–å„ç§æœåŠ¡ä¿¡æ¯

**ğŸ”§ å¸¸ç”¨DHCPé€‰é¡¹åˆ—è¡¨**ï¼š

| é€‰é¡¹ä»£ç  | **é€‰é¡¹åç§°** | **ä½œç”¨** | **ç¤ºä¾‹å€¼** |
|---------|------------|---------|-----------|
| `3` | **Router** | `é»˜è®¤ç½‘å…³` | `192.168.1.1` |
| `6` | **Domain Name Server** | `DNSæœåŠ¡å™¨` | `8.8.8.8, 8.8.4.4` |
| `15` | **Domain Name** | `åŸŸååç¼€` | `company.com` |
| `42` | **NTP Servers** | `æ—¶é—´æœåŠ¡å™¨` | `pool.ntp.org` |
| `44` | **NetBIOS Name Server** | `WINSæœåŠ¡å™¨` | `192.168.1.10` |
| `121` | **Classless Static Route** | `é™æ€è·¯ç”±` | `ç‰¹å®šè·¯ç”±ä¿¡æ¯` |

### 9.2 å¸¸è§é€‰é¡¹é…ç½®é”™è¯¯


**ğŸš¨ å…¸å‹é…ç½®é”™è¯¯åŠç—‡çŠ¶**ï¼š

**é”™è¯¯çš„DNSé…ç½®**ï¼š
```bash
# é”™è¯¯é…ç½®ç¤ºä¾‹
option domain-name-servers 192.168.1.999;  # æ— æ•ˆIPåœ°å€
option domain-name-servers;                 # ç©ºå€¼
option domain-name-servers 192.168.1.1;    # ç½‘å…³å½“DNSï¼ˆå¯èƒ½ä¸æä¾›DNSï¼‰

# æ­£ç¡®é…ç½®ç¤ºä¾‹  
option domain-name-servers 8.8.8.8, 8.8.4.4;
option domain-name-servers 192.168.1.10, 8.8.8.8;  # æœ¬åœ°DNS + å…¬å…±DNS
```

**é”™è¯¯çš„ç½‘å…³é…ç½®**ï¼š
```bash
# é”™è¯¯é…ç½®
option routers 192.168.2.1;    # ä¸åŒç½‘æ®µçš„ç½‘å…³
option routers;                 # ç©ºç½‘å…³
option routers 192.168.1.100;  # æŒ‡å‘æ™®é€šä¸»æœº

# æ­£ç¡®é…ç½®
option routers 192.168.1.1;    # æ­£ç¡®çš„ç½‘å…³åœ°å€
```

### 9.3 è¯Šæ–­é€‰é¡¹é…ç½®é—®é¢˜


**ğŸ” å®¢æˆ·ç«¯é…ç½®éªŒè¯**ï¼š

**Linuxå®¢æˆ·ç«¯æ£€æŸ¥**ï¼š
```bash
# æŸ¥çœ‹ä»DHCPè·å–çš„å®Œæ•´é…ç½®
cat /var/lib/dhcp/dhclient.leases

# æ£€æŸ¥å½“å‰ç½‘ç»œé…ç½®
ip route show                    # æŸ¥çœ‹è·¯ç”±è¡¨
cat /etc/resolv.conf            # æŸ¥çœ‹DNSé…ç½®
timedatectl show-timesync       # æŸ¥çœ‹NTPé…ç½®

# æµ‹è¯•ç½‘ç»œè¿é€šæ€§
ping 8.8.8.8                    # æµ‹è¯•å¤–ç½‘è¿æ¥
nslookup google.com             # æµ‹è¯•DNSè§£æ
```

**è¯¦ç»†çš„ç½‘ç»œè¯Šæ–­è„šæœ¬**ï¼š
```bash
#!/bin/bash
# DHCPé€‰é¡¹é…ç½®è¯Šæ–­è„šæœ¬

echo "=== DHCP Configuration Diagnosis ==="

# è·å–ç½‘ç»œæ¥å£
interface=$(ip route | grep default | awk '{print $5}' | head -n1)
echo "ğŸ” Interface: $interface"

# æ£€æŸ¥IPé…ç½®
ip_addr=$(ip addr show $interface | grep "inet " | awk '{print $2}' | cut -d'/' -f1)
echo "ğŸ“¡ IP Address: $ip_addr"

# æ£€æŸ¥ç½‘å…³
gateway=$(ip route | grep default | awk '{print $3}')
echo "ğŸŒ Gateway: $gateway"

# æµ‹è¯•ç½‘å…³è¿é€šæ€§
if ping -c 2 "$gateway" >/dev/null 2>&1; then
    echo "âœ… Gateway reachable"
else
    echo "âŒ Gateway NOT reachable"
fi

# æ£€æŸ¥DNSé…ç½®
dns_servers=$(grep nameserver /etc/resolv.conf | awk '{print $2}' | tr '\n' ' ')
echo "ğŸ—‚ï¸  DNS Servers: $dns_servers"

# æµ‹è¯•DNSè§£æ
for dns in $dns_servers; do
    if nslookup google.com "$dns" >/dev/null 2>&1; then
        echo "âœ… DNS $dns working"
    else
        echo "âŒ DNS $dns NOT working"
    fi
done

# æ£€æŸ¥åŸŸååç¼€
domain=$(grep search /etc/resolv.conf | awk '{print $2}')
echo "ğŸ·ï¸  Domain: ${domain:-"Not configured"}"

# æ£€æŸ¥DHCPç§Ÿçº¦ä¿¡æ¯
if [ -f /var/lib/dhcp/dhclient.leases ]; then
    echo "ğŸ“‹ DHCP Options received:"
    tail -20 /var/lib/dhcp/dhclient.leases | grep "option " | sort | uniq
fi
```

### 9.4 ä¿®å¤é€‰é¡¹é…ç½®é”™è¯¯


**ğŸ› ï¸ DHCPæœåŠ¡å™¨é€‰é¡¹ä¿®å¤**ï¼š

**å®Œæ•´çš„é€‰é¡¹é…ç½®ç¤ºä¾‹**ï¼š
```bash
# /etc/dhcp/dhcpd.conf å®Œæ•´é…ç½®
subnet 192.168.1.0 netmask 255.255.255.0 {
    range 192.168.1.100 192.168.1.200;
    
    # åŸºç¡€ç½‘ç»œé€‰é¡¹
    option routers 192.168.1.1;                    # é»˜è®¤ç½‘å…³
    option subnet-mask 255.255.255.0;              # å­ç½‘æ©ç 
    option broadcast-address 192.168.1.255;        # å¹¿æ’­åœ°å€
    
    # DNSé€‰é¡¹
    option domain-name "company.local";             # åŸŸååç¼€
    option domain-name-servers 192.168.1.10, 8.8.8.8, 8.8.4.4;  # DNSæœåŠ¡å™¨
    option domain-search "company.local", "backup.local";         # DNSæœç´¢åŸŸ
    
    # æ—¶é—´åŒæ­¥é€‰é¡¹
    option ntp-servers 192.168.1.10, pool.ntp.org;  # NTPæœåŠ¡å™¨
    
    # å…¶ä»–æœ‰ç”¨é€‰é¡¹
    option netbios-name-servers 192.168.1.10;      # WINSæœåŠ¡å™¨
    option netbios-node-type 8;                     # NetBIOSèŠ‚ç‚¹ç±»å‹
    
    # ç§Ÿçº¦æ—¶é—´
    default-lease-time 86400;                       # 24å°æ—¶
    max-lease-time 172800;                          # 48å°æ—¶
    
    # é«˜çº§é€‰é¡¹ç¤ºä¾‹
    option classless-routes 24, 10,0,0, 192,168,1,1,    # é™æ€è·¯ç”±
                          0, 192,168,1,1;               # é»˜è®¤è·¯ç”±
}
```

**é…ç½®éªŒè¯è„šæœ¬**ï¼š
```bash
#!/bin/bash
# DHCPé€‰é¡¹é…ç½®éªŒè¯è„šæœ¬

config_file="/etc/dhcp/dhcpd.conf"
temp_test="/tmp/dhcpd_test.conf"

echo "=== DHCP Configuration Validation ==="

# è¯­æ³•æ£€æŸ¥
echo "ğŸ” Checking syntax..."
if dhcpd -t -cf "$config_file" 2>/dev/null; then
    echo "âœ… Syntax OK"
else
    echo "âŒ Syntax errors found:"
    dhcpd -t -cf "$config_file"
    exit 1
fi

# æ£€æŸ¥å¿…è¦é€‰é¡¹
echo "ğŸ” Checking required options..."

required_options=("routers" "subnet-mask" "domain-name-servers")
for option in "${required_options[@]}"; do
    if grep -q "option $option" "$config_file"; then
        echo "âœ… $option configured"
    else
        echo "âš ï¸  $option not configured"
    fi
done

# æ£€æŸ¥IPåœ°å€æ ¼å¼
echo "ğŸ” Checking IP address formats..."
grep "option.*[0-9]" "$config_file" | while read line; do
    # æå–IPåœ°å€
    ips=$(echo "$line" | grep -oE '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}')
    for ip in $ips; do
        if [[ $ip =~ ^([0-9]{1,3}\.){3}[0-9]{1,3}$ ]]; then
            # æ£€æŸ¥æ¯ä¸ªå­—æ®µæ˜¯å¦åœ¨0-255èŒƒå›´å†…
            IFS='.' read -ra ADDR <<< "$ip"
            valid=true
            for i in "${ADDR[@]}"; do
                if [ "$i" -lt 0 ] || [ "$i" -gt 255 ]; then
                    valid=false
                    break
                fi
            done
            
            if $valid; then
                echo "âœ… $ip format OK"
            else
                echo "âŒ $ip invalid IP address"
            fi
        else
            echo "âŒ $ip invalid IP format"
        fi
    done
done

echo "ğŸ¯ Configuration validation complete!"
```

---

## 10. ğŸ› ï¸ æ•…éšœæ’æŸ¥å·¥å…·ä¸æ–¹æ³•


### 10.1 DHCPæ•…éšœæ’æŸ¥å·¥å…·ç®±


**ğŸ”§ åŸºç¡€å‘½ä»¤å·¥å…·**ï¼š

| å·¥å…· | **åŠŸèƒ½** | **ä½¿ç”¨åœºæ™¯** | **ç¤ºä¾‹å‘½ä»¤** |
|------|---------|------------|-------------|
| `dhclient` | **DHCPå®¢æˆ·ç«¯** | `æµ‹è¯•DHCPè·å–` | `dhclient -v eth0` |
| `dhcpd` | **DHCPæœåŠ¡å™¨** | `æœåŠ¡å™¨æµ‹è¯•` | `dhcpd -t -cf /etc/dhcp/dhcpd.conf` |
| `tcpdump` | **æŠ“åŒ…åˆ†æ** | `ç½‘ç»œæµé‡åˆ†æ` | `tcpdump port 67 or port 68` |
| `nmap` | **ç½‘ç»œæ‰«æ** | `å‘ç°DHCPæœåŠ¡å™¨` | `nmap --script broadcast-dhcp-discover` |
| `arping` | **ARPæµ‹è¯•** | `IPå†²çªæ£€æµ‹` | `arping -D -I eth0 192.168.1.100` |

### 10.2 ç³»ç»ŸåŒ–æ•…éšœæ’æŸ¥æµç¨‹


**ğŸ“‹ æ ‡å‡†æ’æŸ¥æµç¨‹**ï¼š

**ç¬¬ä¸€é˜¶æ®µï¼šå¿«é€Ÿè¯Šæ–­**
```bash
# 1åˆ†é’Ÿå¿«é€Ÿè¯Šæ–­è„šæœ¬
#!/bin/bash
echo "=== DHCP Quick Diagnosis ==="

# æ£€æŸ¥DHCPæœåŠ¡çŠ¶æ€
echo "ğŸ“Š Service Status:"
systemctl is-active dhcpd && echo "âœ… DHCP service active" || echo "âŒ DHCP service inactive"

# æ£€æŸ¥ç«¯å£ç›‘å¬
echo "ğŸ“¡ Port Status:"
ss -ulnp | grep :67 && echo "âœ… Port 67 listening" || echo "âŒ Port 67 not listening"

# æ£€æŸ¥æœ€è¿‘é”™è¯¯
echo "ğŸš¨ Recent Errors:"
journalctl -u dhcpd --since "10 minutes ago" --no-pager -n 5 | grep -i error || echo "No recent errors"

# æ£€æŸ¥åœ°å€æ± çŠ¶æ€
echo "ğŸ“Š Address Pool Status:"
active_leases=$(awk '/binding state active/ {count++} END {print count+0}' /var/lib/dhcp/dhcpd.leases)
echo "Active leases: $active_leases"
```

**ç¬¬äºŒé˜¶æ®µï¼šè¯¦ç»†åˆ†æ**
```bash
#!/bin/bash
# è¯¦ç»†DHCPæ•…éšœåˆ†æ

analyze_dhcp_detailed() {
    echo "=== Detailed DHCP Analysis ==="
    
    # é…ç½®æ–‡ä»¶åˆ†æ
    echo "ğŸ” Configuration Analysis:"
    config_file="/etc/dhcp/dhcpd.conf"
    
    # æ£€æŸ¥è¯­æ³•
    if dhcpd -t -cf "$config_file" 2>/dev/null; then
        echo "âœ… Configuration syntax valid"
    else
        echo "âŒ Configuration syntax errors:"
        dhcpd -t -cf "$config_file" 2>&1 | head -10
        return 1
    fi
    
    # åˆ†æåœ°å€æ± 
    echo "ğŸ“Š Address Pool Analysis:"
    grep -n "range" "$config_file" | while read line; do
        echo "  $line"
    done
    
    # æ£€æŸ¥ç§Ÿçº¦æ•°æ®åº“
    echo "ğŸ“‹ Lease Database Analysis:"
    lease_file="/var/lib/dhcp/dhcpd.leases"
    if [ -f "$lease_file" ]; then
        total_leases=$(grep "^lease" "$lease_file" | wc -l)
        active_leases=$(awk '/binding state active/ {count++} END {print count+0}' "$lease_file")
        free_leases=$(awk '/binding state free/ {count++} END {print count+0}' "$lease_file")
        
        echo "  Total lease records: $total_leases"
        echo "  Active leases: $active_leases"
        echo "  Free leases: $free_leases"
    fi
    
    # ç½‘ç»œè¿é€šæ€§æµ‹è¯•
    echo "ğŸŒ Network Connectivity:"
    interface=$(grep -o 'eth[0-9]\+\|enp[0-9]\+s[0-9]\+' /proc/net/dev | head -1)
    if [ -n "$interface" ]; then
        ip addr show "$interface" | grep "inet " && echo "âœ… Interface has IP" || echo "âŒ Interface no IP"
        
        # æµ‹è¯•ç½‘å…³
        gateway=$(ip route | grep default | awk '{print $3}' | head -1)
        if [ -n "$gateway" ]; then
            ping -c 2 "$gateway" >/dev/null 2>&1 && echo "âœ… Gateway reachable" || echo "âŒ Gateway unreachable"
        fi
    fi
}
```

### 10.3 é«˜çº§æ’æŸ¥æŠ€æœ¯


**ğŸ”¬ æŠ“åŒ…åˆ†æDHCPäº¤äº’**ï¼š

**ä¸“ä¸šæŠ“åŒ…åˆ†æ**ï¼š
```bash
#!/bin/bash
# DHCPæµé‡åˆ†æè„šæœ¬

capture_dhcp_traffic() {
    echo "=== DHCP Traffic Capture ==="
    echo "Starting packet capture... Press Ctrl+C to stop"
    
    # åˆ›å»ºä¸´æ—¶æ–‡ä»¶
    temp_file="/tmp/dhcp_capture_$(date +%s).pcap"
    
    # å¯åŠ¨æŠ“åŒ…ï¼ˆåå°è¿è¡Œï¼‰
    tcpdump -i any -w "$temp_file" port 67 or port 68 &
    tcpdump_pid=$!
    
    echo "Capture started (PID: $tcpdump_pid)"
    echo "Saved to: $temp_file"
    
    # ç­‰å¾…ç”¨æˆ·ä¸­æ–­
    trap "kill $tcpdump_pid 2>/dev/null; analyze_capture '$temp_file'; exit 0" INT
    wait $tcpdump_pid
}

analyze_capture() {
    local capture_file="$1"
    echo "=== Analyzing Capture ==="
    
    # åŸºæœ¬ç»Ÿè®¡
    echo "ğŸ“Š Packet Statistics:"
    tcpdump -r "$capture_file" -n | awk '
    /DHCP-Message.*Discover/ { discover++ }
    /DHCP-Message.*Offer/ { offer++ }
    /DHCP-Message.*Request/ { request++ }
    /DHCP-Message.*ACK/ { ack++ }
    /DHCP-Message.*NAK/ { nak++ }
    END {
        print "  DISCOVER packets: " discover+0
        print "  OFFER packets: " offer+0  
        print "  REQUEST packets: " request+0
        print "  ACK packets: " ack+0
        print "  NAK packets: " nak+0
    }'
    
    echo "ğŸ” Detailed Analysis:"
    echo "Recent DHCP transactions:"
    tcpdump -r "$capture_file" -n -v | grep -A 5 -B 1 "DHCP-Message" | tail -20
}

# å¯åŠ¨æŠ“åŒ…
capture_dhcp_traffic
```

### 10.4 è‡ªåŠ¨åŒ–ç›‘æ§ä¸å‘Šè­¦


**ğŸ“Š DHCPå¥åº·ç›‘æ§è„šæœ¬**ï¼š
```bash
#!/bin/bash
# DHCPæœåŠ¡å¥åº·ç›‘æ§

config_file="/etc/dhcp-monitor.conf"
log_file="/var/log/dhcp-monitor.log"

# é»˜è®¤é…ç½®
DHCP_SERVER="127.0.0.1"
CHECK_INTERVAL=300
ALERT_EMAIL="admin@company.com"
LEASE_THRESHOLD=80  # ç§Ÿçº¦ä½¿ç”¨ç‡è­¦å‘Šé˜ˆå€¼

# åŠ è½½é…ç½®
[ -f "$config_file" ] && source "$config_file"

log_message() {
    echo "$(date): $1" | tee -a "$log_file"
}

check_service_status() {
    if systemctl is-active dhcpd >/dev/null 2>&1; then
        return 0
    else
        return 1
    fi
}

check_port_listening() {
    if ss -ulnp | grep -q ":67 "; then
        return 0
    else
        return 1
    fi
}

check_lease_usage() {
    lease_file="/var/lib/dhcp/dhcpd.leases"
    if [ ! -f "$lease_file" ]; then
        return 1
    fi
    
    # è®¡ç®—ç§Ÿçº¦ä½¿ç”¨ç‡
    total_pool=$(grep -o 'range.*' /etc/dhcp/dhcpd.conf | awk '{
        split($2, start, ".")
        split($3, end, ".")
        total += (end[4] - start[4] + 1)
    } END {print total}')
    
    active_leases=$(awk '/binding state active/ {count++} END {print count+0}' "$lease_file")
    
    if [ "$total_pool" -gt 0 ]; then
        usage_percent=$(( active_leases * 100 / total_pool ))
        echo "$usage_percent"
        
        if [ "$usage_percent" -ge "$LEASE_THRESHOLD" ]; then
            return 1
        fi
    fi
    
    return 0
}

send_alert() {
    local message="$1"
    echo "$message" | mail -s "DHCP Alert: $(hostname)" "$ALERT_EMAIL"
    log_message "ALERT: $message"
}

# ä¸»ç›‘æ§å¾ªç¯
monitor_dhcp() {
    log_message "DHCP monitoring started"
    
    while true; do
        # æ£€æŸ¥æœåŠ¡çŠ¶æ€
        if ! check_service_status; then
            send_alert "DHCP service is not running on $(hostname)"
        fi
        
        # æ£€æŸ¥ç«¯å£ç›‘å¬
        if ! check_port_listening; then
            send_alert "DHCP service not listening on port 67 on $(hostname)"
        fi
        
        # æ£€æŸ¥ç§Ÿçº¦ä½¿ç”¨ç‡
        usage=$(check_lease_usage)
        if [ $? -ne 0 ]; then
            send_alert "DHCP lease usage is ${usage}% (threshold: ${LEASE_THRESHOLD}%)"
        fi
        
        sleep "$CHECK_INTERVAL"
    done
}

# å¯åŠ¨ç›‘æ§
case "$1" in
    "start")
        monitor_dhcp &
        echo $! > /var/run/dhcp-monitor.pid
        echo "DHCP monitoring started"
        ;;
    "stop")
        if [ -f /var/run/dhcp-monitor.pid ]; then
            kill $(cat /var/run/dhcp-monitor.pid)
            rm /var/run/dhcp-monitor.pid
            echo "DHCP monitoring stopped"
        fi
        ;;
    "status")
        if [ -f /var/run/dhcp-monitor.pid ] && kill -0 $(cat /var/run/dhcp-monitor.pid) 2>/dev/null; then
            echo "DHCP monitoring is running"
        else
            echo "DHCP monitoring is not running"
        fi
        ;;
    *)
        echo "Usage: $0 {start|stop|status}"
        exit 1
        ;;
esac
```

---

## 11. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 11.1 å¿…é¡»æŒæ¡çš„æ•…éšœæ’æŸ¥æŠ€èƒ½


**ğŸ¯ æ ¸å¿ƒè¯Šæ–­èƒ½åŠ›**ï¼š
- âœ… **å¿«é€ŸçŠ¶æ€æ£€æŸ¥**ï¼šæœåŠ¡çŠ¶æ€ã€ç«¯å£ç›‘å¬ã€é…ç½®è¯­æ³•
- âœ… **æ—¥å¿—åˆ†æèƒ½åŠ›**ï¼šç†è§£DHCPæ—¥å¿—ä¿¡æ¯å’Œé”™è¯¯ä»£ç 
- âœ… **ç½‘ç»œè¿é€šæ€§æµ‹è¯•**ï¼špingã€arpingã€tcpdumpä½¿ç”¨
- âœ… **é…ç½®æ–‡ä»¶ç®¡ç†**ï¼šè¯­æ³•æ£€æŸ¥ã€å¤‡ä»½æ¢å¤ã€é€‰é¡¹é…ç½®

### 11.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ DHCPæ•…éšœçš„æœ¬è´¨ç†è§£**
```
DHCPæ•…éšœä¸‰å¤§ç±»ï¼š
â€¢ æœåŠ¡ç«¯æ•…éšœï¼šæœåŠ¡åœæ­¢ã€é…ç½®é”™è¯¯ã€åœ°å€è€—å°½
â€¢ ç½‘ç»œæ•…éšœï¼šè¿é€šæ€§é—®é¢˜ã€å†²çªã€ä¸­ç»§å¤±è´¥  
â€¢ å®¢æˆ·ç«¯æ•…éšœï¼šè¯·æ±‚å¤±è´¥ã€é…ç½®é”™è¯¯ã€IPå†²çª
```

**ğŸ”¹ æ•…éšœæ’æŸ¥æ€ç»´æ¨¡å¼**
```
ç³»ç»ŸåŒ–æ’æŸ¥æµç¨‹ï¼š
1. å¿«é€Ÿè¯Šæ–­ â†’ ç¡®å®šæ•…éšœèŒƒå›´
2. æ·±å…¥åˆ†æ â†’ å®šä½æ ¹æœ¬åŸå› 
3. é’ˆå¯¹æ€§ä¿®å¤ â†’ è§£å†³å…·ä½“é—®é¢˜
4. éªŒè¯æµ‹è¯• â†’ ç¡®ä¿ä¿®å¤æ•ˆæœ
5. é¢„é˜²æªæ–½ â†’ é¿å…å†æ¬¡å‘ç”Ÿ
```

**ğŸ”¹ å®é™…åº”ç”¨åœºæ™¯æŒæ¡**
- **ä¼ä¸šç½‘ç»œç¯å¢ƒ**ï¼šå¤šVLANã€ä¸­ç»§é…ç½®ã€å¤§è§„æ¨¡éƒ¨ç½²
- **å®¶åº­åŠå…¬ç¯å¢ƒ**ï¼šè®¾å¤‡å†²çªã€åœ°å€ä¸è¶³ã€é…ç½®ç®€åŒ–
- **æ··åˆäº‘ç¯å¢ƒ**ï¼šæœ¬åœ°DHCPä¸äº‘æœåŠ¡é›†æˆ
- **æ•…éšœåº”æ€¥å¤„ç†**ï¼šå¿«é€Ÿæ¢å¤ã€ä¸šåŠ¡è¿ç»­æ€§ä¿éšœ

### 11.3 å¸¸è§æ•…éšœå¤„ç†checklist


**ğŸ“ DHCPæ•…éšœå¿«é€Ÿæ£€æŸ¥æ¸…å•**

**ğŸ”¸ æœåŠ¡ç«¯æ£€æŸ¥**ï¼š
- [ ] DHCPæœåŠ¡è¿è¡ŒçŠ¶æ€
- [ ] é…ç½®æ–‡ä»¶è¯­æ³•æ­£ç¡®æ€§
- [ ] ç«¯å£67ç›‘å¬çŠ¶æ€
- [ ] åœ°å€æ± å……è¶³æ€§
- [ ] ç§Ÿçº¦æ–‡ä»¶å®Œæ•´æ€§

**ğŸ”¸ ç½‘ç»œå±‚æ£€æŸ¥**ï¼š
- [ ] ç½‘ç»œæ¥å£UPçŠ¶æ€
- [ ] VLANé…ç½®æ­£ç¡®æ€§
- [ ] ä¸­ç»§é…ç½®å®Œæ•´æ€§
- [ ] é˜²ç«å¢™è§„åˆ™å…è®¸
- [ ] ç½‘ç»œè¿é€šæ€§æ­£å¸¸

**ğŸ”¸ å®¢æˆ·ç«¯æ£€æŸ¥**ï¼š
- [ ] ç½‘ç»œæ¥å£é…ç½®
- [ ] DHCPå®¢æˆ·ç«¯è¿è¡Œ
- [ ] IPå†²çªæ£€æµ‹
- [ ] DNSè§£ææ­£å¸¸
- [ ] è·¯ç”±è¡¨æ­£ç¡®

### 11.4 æ•…éšœé¢„é˜²æœ€ä½³å®è·µ


**ğŸ›¡ï¸ é¢„é˜²æ€§æªæ–½**ï¼š

**ç›‘æ§å‘Šè­¦ä½“ç³»**ï¼š
- ğŸ“Š **æœåŠ¡çŠ¶æ€ç›‘æ§**ï¼šå®æ—¶ç›‘æ§DHCPæœåŠ¡è¿è¡ŒçŠ¶æ€
- ğŸ“ˆ **åœ°å€æ± ç›‘æ§**ï¼šç›‘æ§åœ°å€ä½¿ç”¨ç‡ï¼Œé¢„è­¦åœ°å€ä¸è¶³
- ğŸš¨ **å†²çªæ£€æµ‹ç›‘æ§**ï¼šå®šæœŸæ£€æµ‹IPåœ°å€å†²çª
- ğŸ“§ **è‡ªåŠ¨åŒ–å‘Šè­¦**ï¼šå…³é”®æ•…éšœè‡ªåŠ¨é‚®ä»¶é€šçŸ¥

**é…ç½®ç®¡ç†è§„èŒƒ**ï¼š
- ğŸ“ **é…ç½®ç‰ˆæœ¬æ§åˆ¶**ï¼šä½¿ç”¨gitç®¡ç†é…ç½®æ–‡ä»¶å˜æ›´
- ğŸ”’ **æƒé™ç®¡ç†**ï¼šé™åˆ¶DHCPé…ç½®ä¿®æ”¹æƒé™
- ğŸ’¾ **å®šæœŸå¤‡ä»½**ï¼šè‡ªåŠ¨å¤‡ä»½é…ç½®æ–‡ä»¶å’Œç§Ÿçº¦æ•°æ®
- âœ… **å˜æ›´æµ‹è¯•**ï¼šé…ç½®ä¿®æ”¹å‰å¿…é¡»è¯­æ³•æ£€æŸ¥

**ğŸ¯ è®°å¿†è¦ç‚¹**ï¼š
- DHCPæ•…éšœ80%æºäºé…ç½®é”™è¯¯å’Œç½‘ç»œè¿é€šæ€§é—®é¢˜
- åœ°å€æ± è€—å°½æ˜¯æœ€å¸¸è§çš„DHCPæ•…éšœç±»å‹
- ç³»ç»ŸåŒ–çš„æ’æŸ¥æµç¨‹æ¯”å·¥å…·é‡è¦
- é¢„é˜²æ€§ç›‘æ§æ¯”æ•…éšœåä¿®å¤æ›´æœ‰ä»·å€¼

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
> "æœåŠ¡é…ç½®ç½‘ç»œé€šï¼Œåœ°å€ç§Ÿçº¦è¦ç›‘æ§
> å†²çªæ’æŸ¥æœ‰æ–¹æ³•ï¼Œé¢„é˜²ç›‘æ§ä¿è¿è¡Œ"

### 11.5 æŒç»­æ”¹è¿›å»ºè®®


**ğŸ“ˆ è¿ç»´æˆç†Ÿåº¦æå‡**ï¼š

**åˆçº§é˜¶æ®µ**ï¼š
- æŒæ¡åŸºç¡€å‘½ä»¤å’Œå·¥å…·ä½¿ç”¨
- èƒ½å¤Ÿå¤„ç†å¸¸è§çš„DHCPæ•…éšœ
- å»ºç«‹åŸºæœ¬çš„æ•…éšœå¤„ç†æµç¨‹

**ä¸­çº§é˜¶æ®µ**ï¼š
- å®æ–½è‡ªåŠ¨åŒ–ç›‘æ§å’Œå‘Šè­¦
- å»ºç«‹å®Œæ•´çš„é…ç½®ç®¡ç†ä½“ç³»
- å…·å¤‡å¤æ‚ç½‘ç»œç¯å¢ƒçš„æ•…éšœå¤„ç†èƒ½åŠ›

**é«˜çº§é˜¶æ®µ**ï¼š
- å»ºç«‹é¢„æµ‹æ€§ç»´æŠ¤ä½“ç³»
- å®ç°DHCPæœåŠ¡çš„é«˜å¯ç”¨æ¶æ„
- å…·å¤‡å¤§è§„æ¨¡ç½‘ç»œçš„DHCPè§„åˆ’èƒ½åŠ›

è¿™ä»½DHCPæ•…éšœå¤„ç†æŒ‡å—æ¶µç›–äº†ä»åŸºç¡€æ¦‚å¿µåˆ°é«˜çº§æ•…éšœæ’æŸ¥çš„å®Œæ•´çŸ¥è¯†ä½“ç³»ï¼Œé€šè¿‡ç³»ç»ŸåŒ–çš„å­¦ä¹ å’Œå®è·µï¼Œèƒ½å¤Ÿå¸®åŠ©ä½ æˆä¸ºDHCPæ•…éšœå¤„ç†ä¸“å®¶ï¼