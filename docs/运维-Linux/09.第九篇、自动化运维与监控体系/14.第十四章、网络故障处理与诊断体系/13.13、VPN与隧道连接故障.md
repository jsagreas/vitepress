---
title: 13ã€VPNä¸Žéš§é“è¿žæŽ¥æ•…éšœ
---
## ðŸ“š ç›®å½•

1. [VPNæ•…éšœè¯Šæ–­æ¦‚è¿°](#1-VPNæ•…éšœè¯Šæ–­æ¦‚è¿°)
2. [VPNè¿žæŽ¥å»ºç«‹å¤±è´¥å¤„ç†](#2-VPNè¿žæŽ¥å»ºç«‹å¤±è´¥å¤„ç†)
3. [IPSecéš§é“é…ç½®é”™è¯¯è¯Šæ–­](#3-IPSecéš§é“é…ç½®é”™è¯¯è¯Šæ–­)
4. [OpenVPNè¿žæŽ¥é—®é¢˜è§£å†³](#4-OpenVPNè¿žæŽ¥é—®é¢˜è§£å†³)
5. [WireGuardé…ç½®æ•…éšœæŽ’é™¤](#5-WireGuardé…ç½®æ•…éšœæŽ’é™¤)
6. [VPNè®¤è¯å¤±è´¥å¤„ç†](#6-VPNè®¤è¯å¤±è´¥å¤„ç†)
7. [éš§é“MTUè®¾ç½®é—®é¢˜](#7-éš§é“MTUè®¾ç½®é—®é¢˜)
8. [VPNè·¯ç”±é…ç½®æ•…éšœ](#8-VPNè·¯ç”±é…ç½®æ•…éšœ)
9. [VPNæ€§èƒ½é—®é¢˜åˆ†æž](#9-VPNæ€§èƒ½é—®é¢˜åˆ†æž)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ðŸ” VPNæ•…éšœè¯Šæ–­æ¦‚è¿°


### 1.1 VPNåŸºæœ¬æ¦‚å¿µ


**ðŸ”¸ VPNæ˜¯ä»€ä¹ˆ**
VPNï¼ˆVirtual Private Networkï¼‰å°±åƒåœ¨å…¬å…±ç½‘ç»œä¸Šå»ºç«‹ä¸€æ¡ä¸“ç”¨çš„ç§å¯†é€šé“ã€‚æƒ³è±¡ä¸€ä¸‹é‚®é€’å‘˜é€šè¿‡å…¬å…±é“è·¯é€ä¿¡ï¼Œä½†ä¿¡ä»¶è£…åœ¨ç‰¹åˆ¶çš„ä¿å¯†ç®±é‡Œï¼Œåªæœ‰æ”¶ä»¶äººæœ‰é’¥åŒ™èƒ½æ‰“å¼€ã€‚

**å·¥ä½œåŽŸç†å›¾ç¤ºï¼š**
```
ç”¨æˆ·è®¾å¤‡ â†â€”â€”â€”â€”â€”â€” åŠ å¯†éš§é“ â€”â€”â€”â€”â€”â†’ VPNæœåŠ¡å™¨ â†â€”â€”â€”â†’ ç›®æ ‡ç½‘ç»œ
  å®¢æˆ·ç«¯    |    äº’è”ç½‘ä¼ è¾“    |     æœåŠ¡ç«¯      å†…ç½‘èµ„æº
           åŠ å¯†ä¿æŠ¤æ•°æ®åŒ…      è§£å¯†è½¬å‘æ•°æ®åŒ…
```

**ðŸ”¸ VPNçš„æ ¸å¿ƒä½œç”¨**
- **æ•°æ®åŠ å¯†**ï¼šä¿æŠ¤ä¼ è¾“æ•°æ®ä¸è¢«çªƒå–
- **èº«ä»½éšè—**ï¼šéšè—çœŸå®žIPåœ°å€
- **è¿œç¨‹è®¿é—®**ï¼šè®¿é—®è¿œç¨‹å†…ç½‘èµ„æº
- **ç»•è¿‡é™åˆ¶**ï¼šçªç ´ç½‘ç»œè®¿é—®é™åˆ¶

### 1.2 å¸¸è§VPNç±»åž‹å¯¹æ¯”


| VPNç±»åž‹ | **é€‚ç”¨åœºæ™¯** | **å®‰å…¨çº§åˆ«** | **é…ç½®éš¾åº¦** | **æ€§èƒ½è¡¨çŽ°** |
|---------|-------------|-------------|-------------|-------------|
| ðŸ›¡ï¸ **IPSec** | `ä¼ä¸šä¸“çº¿è¿žæŽ¥` | `æžé«˜` | `å¤æ‚` | `ä¸­ç­‰` |
| ðŸŒ **OpenVPN** | `è¿œç¨‹åŠžå…¬` | `é«˜` | `ä¸­ç­‰` | `è¾ƒå¥½` |
| âš¡ **WireGuard** | `çŽ°ä»£åŒ–éƒ¨ç½²` | `é«˜` | `ç®€å•` | `ä¼˜ç§€` |
| ðŸ“± **L2TP/IPSec** | `ç§»åŠ¨è®¾å¤‡` | `ä¸­é«˜` | `ç®€å•` | `ä¸€èˆ¬` |

### 1.3 VPNæ•…éšœè¯Šæ–­æ€è·¯


**ðŸŽ¯ æ ‡å‡†è¯Šæ–­æµç¨‹ï¼š**
```
ç¬¬1æ­¥ï¼šç¡®è®¤ç½‘ç»œè¿žé€šæ€§
   â†“
ç¬¬2æ­¥ï¼šæ£€æŸ¥VPNæœåŠ¡è¿è¡ŒçŠ¶æ€
   â†“
ç¬¬3æ­¥ï¼šéªŒè¯è®¤è¯é…ç½®
   â†“
ç¬¬4æ­¥ï¼šåˆ†æžæ—¥å¿—é”™è¯¯ä¿¡æ¯
   â†“
ç¬¬5æ­¥ï¼šæµ‹è¯•éš§é“å»ºç«‹è¿‡ç¨‹
   â†“
ç¬¬6æ­¥ï¼šæŽ’æŸ¥è·¯ç”±é…ç½®é—®é¢˜
```

---

## 2. âŒ VPNè¿žæŽ¥å»ºç«‹å¤±è´¥å¤„ç†


### 2.1 è¿žæŽ¥å¤±è´¥å¸¸è§åŽŸå› 


**ðŸ”¸ ç½‘ç»œå±‚é¢é—®é¢˜**
```bash
# æ£€æŸ¥åŸºç¡€ç½‘ç»œè¿žé€šæ€§
ping vpn-server.example.com

# æ£€æŸ¥VPNç«¯å£å¯è¾¾æ€§
nmap -p 1194,500,4500 vpn-server.example.com

# æµ‹è¯•UDPç«¯å£è¿žé€šæ€§
nc -u -v vpn-server.example.com 1194
```

**ðŸ”¸ é˜²ç«å¢™é˜»æ–­**
å¤§å¤šæ•°VPNè¿žæŽ¥å¤±è´¥éƒ½æ˜¯å› ä¸ºé˜²ç«å¢™æŒ¡ä½äº†å…³é”®ç«¯å£ã€‚å°±åƒé—¨å«ä¸è®©å¿«é€’å‘˜è¿›å°åŒºä¸€æ ·ã€‚

**å¸¸ç”¨VPNç«¯å£å¯¹ç…§ï¼š**
| VPNç±»åž‹ | ç«¯å£å· | åè®® | ç”¨é€” |
|---------|--------|------|------|
| OpenVPN | 1194 | UDP/TCP | ä¸»è¦è¿žæŽ¥ç«¯å£ |
| IPSec | 500 | UDP | IKEåå•† |
| IPSec | 4500 | UDP | NATç©¿è¶Š |
| WireGuard | 51820 | UDP | é»˜è®¤ç›‘å¬ç«¯å£ |

### 2.2 è¿žæŽ¥è¶…æ—¶é—®é¢˜


**ðŸ”§ è¶…æ—¶é—®é¢˜è¯Šæ–­ï¼š**
```bash
# æ£€æŸ¥DNSè§£æž
nslookup vpn-server.example.com

# æµ‹è¯•è¿žæŽ¥å»¶è¿Ÿ
traceroute vpn-server.example.com

# æ£€æŸ¥æœ¬åœ°ç½‘ç»œé…ç½®
ip route show
```

**âš ï¸ æ³¨æ„äº‹é¡¹ï¼š**
- **DNSé—®é¢˜**ï¼šæ— æ³•è§£æžVPNæœåŠ¡å™¨åŸŸå
- **è·¯ç”±é—®é¢˜**ï¼šæœ¬åœ°è·¯ç”±è¡¨é…ç½®é”™è¯¯
- **ISPé™åˆ¶**ï¼šç½‘ç»œè¿è¥å•†å°é”VPNæµé‡

### 2.3 è¯ä¹¦éªŒè¯å¤±è´¥


**è¯ä¹¦é—®é¢˜æŽ’æŸ¥ï¼š**
```bash
# æ£€æŸ¥è¯ä¹¦æœ‰æ•ˆæœŸ
openssl x509 -in client.crt -text -noout

# éªŒè¯è¯ä¹¦é“¾
openssl verify -CAfile ca.crt client.crt

# æ£€æŸ¥ç§é’¥åŒ¹é…
openssl rsa -in client.key -check
```

**ðŸ” è¯ä¹¦å¸¸è§é—®é¢˜ï¼š**
- **è¿‡æœŸè¯ä¹¦**ï¼šè¯ä¹¦è¶…è¿‡æœ‰æ•ˆæœŸ
- **æ—¶é—´åŒæ­¥**ï¼šå®¢æˆ·ç«¯æ—¶é—´ä¸ŽæœåŠ¡å™¨æ—¶é—´å·®å¼‚è¿‡å¤§
- **è¯ä¹¦é“¾æ–­è£‚**ï¼šç¼ºå°‘ä¸­é—´è¯ä¹¦æˆ–æ ¹è¯ä¹¦

---

## 3. ðŸ›¡ï¸ IPSecéš§é“é…ç½®é”™è¯¯è¯Šæ–­


### 3.1 IPSecåŸºæœ¬åŽŸç†


**IPSecå·¥ä½œæœºåˆ¶ï¼š**
IPSecå°±åƒå»ºç«‹ä¸€ä¸ªå®‰å…¨çš„ä¼ è¾“ç®¡é“ï¼Œåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š
1. **ç¬¬ä¸€é˜¶æ®µï¼ˆIKEï¼‰**ï¼šåŒæ–¹åå•†å¦‚ä½•å»ºç«‹å®‰å…¨é€šé“
2. **ç¬¬äºŒé˜¶æ®µï¼ˆIPSecï¼‰**ï¼šåœ¨å®‰å…¨é€šé“å†…ä¼ è¾“å®žé™…æ•°æ®

```
é˜¶æ®µ1åå•†æµç¨‹ï¼š
å®¢æˆ·ç«¯ â†â€”â€” èº«ä»½éªŒè¯ â€”â€”â†’ æœåŠ¡ç«¯
   â†“                      â†“
é€‰æ‹©åŠ å¯†ç®—æ³• â†â€”â€”â€”â€”â€”â€”â€”â€”â†’ ç¡®è®¤ç®—æ³•
   â†“                      â†“
å»ºç«‹å®‰å…¨å…³è” â†â€”â€”â€”â€”â€”â€”â€”â€”â†’ å»ºç«‹SA
```

### 3.2 IPSecé…ç½®æ–‡ä»¶æ£€æŸ¥


**ðŸ”§ StrongSwané…ç½®ç¤ºä¾‹ï¼š**
```bash
# æ£€æŸ¥ipsecé…ç½®
sudo ipsec statusall

# æŸ¥çœ‹è¿žæŽ¥çŠ¶æ€
sudo ipsec status

# é‡æ–°è¯»å–é…ç½®
sudo ipsec reload
```

**å…³é”®é…ç½®é¡¹æ£€æŸ¥ï¼š**
- **é¢„å…±äº«å¯†é’¥ï¼ˆPSKï¼‰**ï¼šåŒæ–¹å¿…é¡»å®Œå…¨ä¸€è‡´
- **åŠ å¯†ç®—æ³•**ï¼šåŒæ–¹æ”¯æŒçš„ç®—æ³•è¦æœ‰äº¤é›†
- **å­ç½‘é…ç½®**ï¼šå·¦å³ä¸¤ç«¯å­ç½‘ä¸èƒ½å†²çª

### 3.3 IPSecæ•…éšœæ—¥å¿—åˆ†æž


**ðŸ“Š å¸¸è§é”™è¯¯ä¿¡æ¯è§£è¯»ï¼š**

| é”™è¯¯ä¿¡æ¯ | **å«ä¹‰** | **è§£å†³æ–¹æ¡ˆ** |
|----------|----------|-------------|
| `no proposal chosen` | åŠ å¯†ç®—æ³•ä¸åŒ¹é… | ç»Ÿä¸€åŒæ–¹åŠ å¯†é…ç½® |
| `authentication failed` | è®¤è¯å¤±è´¥ | æ£€æŸ¥PSKæˆ–è¯ä¹¦ |
| `peer not responding` | å¯¹ç«¯æ— å“åº” | æ£€æŸ¥ç½‘ç»œè¿žé€šæ€§ |

**ðŸ” æ—¥å¿—æŸ¥çœ‹å‘½ä»¤ï¼š**
```bash
# æŸ¥çœ‹IPSecæ—¥å¿—
sudo journalctl -u strongswan

# å®žæ—¶ç›‘æŽ§è¿žæŽ¥
sudo ipsec up tunnel-name
sudo ipsec statusall
```

---

## 4. ðŸŒ OpenVPNè¿žæŽ¥é—®é¢˜è§£å†³


### 4.1 OpenVPNå·¥ä½œåŽŸç†


**OpenVPNè¿žæŽ¥è¿‡ç¨‹ï¼š**
OpenVPNåƒä¸€ä¸ªæ™ºèƒ½çš„é‚®é€’ç³»ç»Ÿï¼Œå®ƒä¼šï¼š
1. **æ¡æ‰‹é˜¶æ®µ**ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ç›¸äº’ç¡®è®¤èº«ä»½
2. **å¯†é’¥äº¤æ¢**ï¼šåå•†åŠ å¯†å¯†é’¥
3. **éš§é“å»ºç«‹**ï¼šåˆ›å»ºè™šæ‹Ÿç½‘ç»œæŽ¥å£
4. **æ•°æ®ä¼ è¾“**ï¼šåœ¨åŠ å¯†éš§é“å†…ä¼ è¾“æ•°æ®

### 4.2 OpenVPNé…ç½®æ£€æŸ¥


**ðŸ”§ å®¢æˆ·ç«¯é…ç½®æ£€æŸ¥è¦ç‚¹ï¼š**
```
# åŸºç¡€è¿žæŽ¥å‚æ•°
remote server-ip 1194        # æœåŠ¡å™¨åœ°å€å’Œç«¯å£
proto udp                    # ä¼ è¾“åè®®
dev tun                      # è™šæ‹Ÿç½‘å¡ç±»åž‹

# è®¤è¯æ–‡ä»¶è·¯å¾„
ca ca.crt                    # æ ¹è¯ä¹¦
cert client.crt              # å®¢æˆ·ç«¯è¯ä¹¦
key client.key               # å®¢æˆ·ç«¯ç§é’¥

# å®‰å…¨é€‰é¡¹
verify-x509-name server-name # éªŒè¯æœåŠ¡å™¨è¯ä¹¦
```

**âš ï¸ é…ç½®å¸¸è§é”™è¯¯ï¼š**
- **æ–‡ä»¶è·¯å¾„é”™è¯¯**ï¼šè¯ä¹¦æ–‡ä»¶æ‰¾ä¸åˆ°æˆ–æƒé™ä¸è¶³
- **åè®®ä¸åŒ¹é…**ï¼šå®¢æˆ·ç«¯ç”¨TCPï¼ŒæœåŠ¡ç«¯ç”¨UDP
- **ç«¯å£å†²çª**ï¼šæŒ‡å®šç«¯å£è¢«å…¶ä»–ç¨‹åºå ç”¨

### 4.3 OpenVPNè¿žæŽ¥è°ƒè¯•


**ðŸ” è¯¦ç»†è°ƒè¯•æ–¹æ³•ï¼š**
```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
openvpn --config client.ovpn --verb 9

# æ£€æŸ¥è™šæ‹Ÿç½‘å¡
ip addr show tun0

# æµ‹è¯•éš§é“å†…è¿žé€šæ€§
ping 10.8.0.1  # VPNç½‘å…³åœ°å€
```

**è¿žæŽ¥çŠ¶æ€æ£€æŸ¥ï¼š**
- **TUN/TAPæŽ¥å£**ï¼šè™šæ‹Ÿç½‘å¡æ˜¯å¦æ­£å¸¸åˆ›å»º
- **è·¯ç”±è¡¨**ï¼šVPNè·¯ç”±æ˜¯å¦æ­£ç¡®æ·»åŠ 
- **DNSè®¾ç½®**ï¼šåŸŸåè§£æžæ˜¯å¦é€šè¿‡VPN

---

## 5. âš¡ WireGuardé…ç½®æ•…éšœæŽ’é™¤


### 5.1 WireGuardç‰¹ç‚¹


**WireGuardä¼˜åŠ¿ï¼š**
WireGuardå°±åƒçŽ°ä»£åŒ–çš„é«˜é€Ÿå…¬è·¯ï¼Œç›¸æ¯”ä¼ ç»ŸVPNï¼š
- **é…ç½®ç®€å•**ï¼šåªéœ€è¦å‡ è¡Œé…ç½®
- **æ€§èƒ½ä¼˜å¼‚**ï¼šè¿è¡Œåœ¨å†…æ ¸æ€ï¼Œé€Ÿåº¦æ›´å¿«
- **å®‰å…¨çŽ°ä»£**ï¼šä½¿ç”¨æœ€æ–°çš„åŠ å¯†ç®—æ³•
- **æ˜“äºŽè°ƒè¯•**ï¼šæ—¥å¿—ç®€æ´æ˜Žäº†

### 5.2 WireGuardé…ç½®è¦ç´ 


**ðŸ”§ åŸºæœ¬é…ç½®ç»“æž„ï¼š**
```bash
# æ£€æŸ¥WireGuardçŠ¶æ€
sudo wg show

# å¯åŠ¨æŽ¥å£
sudo wg-quick up wg0

# åœæ­¢æŽ¥å£
sudo wg-quick down wg0
```

**é…ç½®æ–‡ä»¶å…³é”®å­—æ®µï¼š**
- **PrivateKey**ï¼šæœ¬æœºç§é’¥ï¼ˆå¿…é¡»ä¿å¯†ï¼‰
- **PublicKey**ï¼šå¯¹ç«¯å…¬é’¥ï¼ˆç”¨äºŽèº«ä»½éªŒè¯ï¼‰
- **Endpoint**ï¼šå¯¹ç«¯æœåŠ¡å™¨åœ°å€
- **AllowedIPs**ï¼šå…è®¸é€šè¿‡éš§é“çš„IPèŒƒå›´

### 5.3 WireGuardæ•…éšœè¯Šæ–­


**ðŸ” å¸¸è§é…ç½®é”™è¯¯ï¼š**

| é—®é¢˜çŽ°è±¡ | **å¯èƒ½åŽŸå› ** | **è§£å†³æ–¹æ³•** |
|----------|-------------|-------------|
| æ— æ³•è¿žæŽ¥ | Endpointåœ°å€é”™è¯¯ | ç¡®è®¤æœåŠ¡å™¨IPå’Œç«¯å£ |
| éƒ¨åˆ†ç½‘ç«™ä¸é€š | AllowedIPsé…ç½®ä¸å½“ | è°ƒæ•´è·¯ç”±èŒƒå›´ |
| è¿žæŽ¥ä¸ç¨³å®š | NATè¶…æ—¶ | é…ç½®PersistentKeepalive |

**è°ƒè¯•å‘½ä»¤ï¼š**
```bash
# æŸ¥çœ‹è¿žæŽ¥ç»Ÿè®¡
sudo wg show all

# æ£€æŸ¥å†…æ ¸æ¨¡å—
lsmod | grep wireguard

# æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
sudo dmesg | grep wireguard
```

---

## 6. ðŸ” VPNè®¤è¯å¤±è´¥å¤„ç†


### 6.1 è®¤è¯æ–¹å¼åˆ†ç±»


**ðŸ”¸ å¯†ç è®¤è¯ï¼ˆPAP/CHAPï¼‰**
æœ€ç®€å•çš„è®¤è¯æ–¹å¼ï¼Œå°±åƒé—¨å«æ£€æŸ¥èº«ä»½è¯ï¼š
- **ç”¨æˆ·å**ï¼šèº«ä»½æ ‡è¯†
- **å¯†ç **ï¼šèº«ä»½éªŒè¯
- **é£Žé™©**ï¼šå®¹æ˜“è¢«ç ´è§£

**ðŸ”¸ è¯ä¹¦è®¤è¯ï¼ˆPKIï¼‰**
åƒé“¶è¡Œçš„å®‰å…¨ä»¤ç‰Œï¼Œæ›´åŠ å®‰å…¨ï¼š
- **æ•°å­—è¯ä¹¦**ï¼šç”µå­èº«ä»½è¯
- **ç§é’¥**ï¼šä¸ªäººç­¾å
- **CAè¯ä¹¦**ï¼šæƒå¨æœºæž„è®¤è¯

### 6.2 è®¤è¯é…ç½®æ£€æŸ¥


**ç”¨æˆ·è®¤è¯é—®é¢˜æŽ’æŸ¥ï¼š**
```bash
# æ£€æŸ¥ç”¨æˆ·å¯†ç æ–‡ä»¶
sudo cat /etc/ppp/chap-secrets

# éªŒè¯è¯ä¹¦æœ‰æ•ˆæ€§
openssl x509 -in client.crt -dates -noout

# æ£€æŸ¥è¯ä¹¦å’Œç§é’¥åŒ¹é…
openssl x509 -noout -modulus -in client.crt | openssl md5
openssl rsa -noout -modulus -in client.key | openssl md5
```

**ðŸ” è®¤è¯å¤±è´¥å¸¸è§åŽŸå› ï¼š**
- **ç”¨æˆ·åå¯†ç é”™è¯¯**ï¼šè¾“å…¥ä¿¡æ¯ä¸åŒ¹é…
- **è¯ä¹¦è¿‡æœŸ**ï¼šè¶…è¿‡æœ‰æ•ˆæœŸé™
- **æ—¶é—´åŒæ­¥é—®é¢˜**ï¼šç³»ç»Ÿæ—¶é—´å·®å¼‚è¿‡å¤§
- **CAè¯ä¹¦ç¼ºå¤±**ï¼šæ ¹è¯ä¹¦é“¾ä¸å®Œæ•´

### 6.3 åŒå› ç´ è®¤è¯æ•…éšœ


**ðŸ” 2FAè®¤è¯æµç¨‹ï¼š**
```
ç¬¬1æ­¥ï¼šç”¨æˆ·åå¯†ç éªŒè¯
   â†“
ç¬¬2æ­¥ï¼šOTPä»¤ç‰ŒéªŒè¯  
   â†“
ç¬¬3æ­¥ï¼šå»ºç«‹VPNè¿žæŽ¥
```

**åŒå› ç´ è®¤è¯é—®é¢˜å¤„ç†ï¼š**
- **æ—¶é—´æ¼‚ç§»**ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ—¶é—´ä¸åŒæ­¥
- **ä»¤ç‰ŒåŒæ­¥**ï¼šOTPç”Ÿæˆå™¨å¤±åŽ»åŒæ­¥
- **ç½‘ç»œå»¶è¿Ÿ**ï¼šä»¤ç‰ŒéªŒè¯è¶…æ—¶

---

## 7. ðŸ“ éš§é“MTUè®¾ç½®é—®é¢˜


### 7.1 MTUæ¦‚å¿µç†è§£


**ðŸ”¸ MTUæ˜¯ä»€ä¹ˆ**
MTUï¼ˆMaximum Transmission Unitï¼‰å°±åƒå¿«é€’åŒ…è£¹çš„æœ€å¤§å°ºå¯¸é™åˆ¶ã€‚å¦‚æžœåŒ…è£¹å¤ªå¤§ï¼Œå°±éœ€è¦æ‹†åˆ†æˆå¤šä¸ªå°åŒ…è£¹ã€‚

**MTUé—®é¢˜è¡¨çŽ°ï¼š**
- **å¤§æ–‡ä»¶ä¼ è¾“å¤±è´¥**ï¼šèƒ½pingé€šï¼Œä½†ä¸‹è½½ä¸­æ–­
- **ç½‘é¡µåŠ è½½ä¸å®Œæ•´**ï¼šéƒ¨åˆ†å†…å®¹æ˜¾ç¤ºå¼‚å¸¸
- **SSHè¿žæŽ¥æ–­å¼€**ï¼šé•¿å‘½ä»¤æ‰§è¡Œå¤±è´¥

### 7.2 MTUæ£€æµ‹æ–¹æ³•


**ðŸ”§ MTUæ£€æµ‹å‘½ä»¤ï¼š**
```bash
# æ£€æµ‹åˆ°ç›®æ ‡ä¸»æœºçš„MTU
ping -M do -s 1472 target-host

# ä½¿ç”¨tracepathæ£€æµ‹è·¯å¾„MTU
tracepath target-host

# æ£€æŸ¥ç½‘å¡MTUè®¾ç½®
ip link show
```

**MTUå¤§å°è®¡ç®—ï¼š**
```
ä»¥å¤ªç½‘MTU: 1500å­—èŠ‚
- IPå¤´: 20å­—èŠ‚  
- UDPå¤´: 8å­—èŠ‚
- OpenVPNå¤´: çº¦50å­—èŠ‚
= å®žé™…æ•°æ®: 1422å­—èŠ‚
```

### 7.3 MTUä¼˜åŒ–é…ç½®


**VPN MTUé…ç½®å»ºè®®ï¼š**

| VPNç±»åž‹ | **æŽ¨èMTU** | **é…ç½®ä½ç½®** |
|---------|-------------|-------------|
| OpenVPN | 1200-1400 | `tun-mtu 1400` |
| IPSec | 1400-1450 | æŽ¥å£é…ç½® |
| WireGuard | 1420 | `MTU = 1420` |

**âš™ï¸ è‡ªåŠ¨MTUå‘çŽ°ï¼š**
```bash
# OpenVPNè‡ªåŠ¨MTU
mssfix 1400

# WireGuardè‡ªåŠ¨è°ƒæ•´
# ç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç†
```

---

## 8. ðŸ›£ï¸ VPNè·¯ç”±é…ç½®æ•…éšœ


### 8.1 VPNè·¯ç”±åŽŸç†


**ðŸ”¸ è·¯ç”±å·¥ä½œæœºåˆ¶**
VPNè·¯ç”±å°±åƒäº¤é€šæŒ‡æŒ¥å‘˜ï¼Œå†³å®šæ•°æ®åŒ…èµ°å“ªæ¡è·¯ï¼š

```
æ•°æ®æµå‘é€‰æ‹©ï¼š
æœ¬åœ°ç½‘ç»œæµé‡ â€”â€”â†’ ç›´æŽ¥è·¯ç”±ï¼ˆä¸èµ°VPNï¼‰
    â†“
VPNç½‘ç»œæµé‡ â€”â€”â†’ VPNéš§é“è·¯ç”±
    â†“  
é»˜è®¤ç½‘å…³æµé‡ â€”â€”â†’ æ ¹æ®ç­–ç•¥é€‰æ‹©
```

**è·¯ç”±ä¼˜å…ˆçº§ï¼š**
1. **ä¸»æœºè·¯ç”±**ï¼ˆæœ€å…·ä½“ï¼‰ï¼š/32
2. **å­ç½‘è·¯ç”±**ï¼š/24ã€/16ç­‰
3. **é»˜è®¤è·¯ç”±**ï¼ˆæœ€é€šç”¨ï¼‰ï¼š0.0.0.0/0

### 8.2 è·¯ç”±é…ç½®æ£€æŸ¥


**ðŸ”§ è·¯ç”±è¯Šæ–­å‘½ä»¤ï¼š**
```bash
# æŸ¥çœ‹å®Œæ•´è·¯ç”±è¡¨
ip route show

# æ£€æŸ¥ç‰¹å®šè·¯ç”±
ip route get 8.8.8.8

# æŸ¥çœ‹è·¯ç”±ç»Ÿè®¡
netstat -rn
```

**å¸¸è§è·¯ç”±é—®é¢˜ï¼š**
- **è·¯ç”±å†²çª**ï¼šå¤šæ¡è·¯ç”±æŒ‡å‘åŒä¸€ç›®æ ‡
- **ç¼ºå¤±è·¯ç”±**ï¼šæ²¡æœ‰åˆ°ç›®æ ‡ç½‘ç»œçš„è·¯ç”±
- **ä¼˜å…ˆçº§é”™è¯¯**ï¼šé”™è¯¯çš„è·¯ç”±è¢«ä¼˜å…ˆé€‰æ‹©

### 8.3 åˆ†ç¦»è·¯ç”±é…ç½®


**ðŸŽ¯ æ™ºèƒ½è·¯ç”±ç­–ç•¥ï¼š**

| æµé‡ç±»åž‹ | **è·¯ç”±ç­–ç•¥** | **åº”ç”¨åœºæ™¯** |
|----------|-------------|-------------|
| åŠžå…¬ç½‘ç»œ | èµ°VPNéš§é“ | è®¿é—®å…¬å¸å†…ç½‘ |
| æœ¬åœ°æœåŠ¡ | èµ°æœ¬åœ°ç½‘å…³ | æ‰“å°æœºã€NAS |
| å›½å¤–ç½‘ç«™ | èµ°VPNéš§é“ | ç»•è¿‡åœ°åŸŸé™åˆ¶ |
| å›½å†…ç½‘ç«™ | èµ°æœ¬åœ°ç½‘å…³ | æé«˜è®¿é—®é€Ÿåº¦ |

**è·¯ç”±é…ç½®ç¤ºä¾‹ï¼š**
```bash
# æ·»åŠ ç‰¹å®šç½‘ç»œè·¯ç”±
sudo ip route add 192.168.1.0/24 via 10.8.0.1 dev tun0

# åˆ é™¤é»˜è®¤VPNè·¯ç”±
sudo ip route del default dev tun0

# æ·»åŠ æ¡ä»¶è·¯ç”±
sudo ip route add 0.0.0.0/1 via 10.8.0.1 dev tun0
sudo ip route add 128.0.0.0/1 via 10.8.0.1 dev tun0
```

---

## 9. âš¡ VPNæ€§èƒ½é—®é¢˜åˆ†æž


### 9.1 æ€§èƒ½å½±å“å› ç´ 


**ðŸ”¸ å½±å“VPNæ€§èƒ½çš„ä¸»è¦å› ç´ ï¼š**

```
æ€§èƒ½å½±å“é“¾ï¼š
ç½‘ç»œå¸¦å®½ â†â€”â€” ç‰©ç†é™åˆ¶ â€”â€”â†’ æœ€å¤§ä¼ è¾“é€ŸçŽ‡
    â†“
CPUæ€§èƒ½ â†â€”â€” åŠ å¯†è§£å¯† â€”â€”â†’ å¤„ç†èƒ½åŠ›ä¸Šé™  
    â†“
ç½‘ç»œå»¶è¿Ÿ â†â€”â€” åœ°ç†è·ç¦» â€”â€”â†’ å“åº”æ—¶é—´
    â†“
åè®®é€‰æ‹© â†â€”â€” å¼€é”€å¤§å° â€”â€”â†’ ä¼ è¾“æ•ˆçŽ‡
```

### 9.2 æ€§èƒ½æµ‹è¯•æ–¹æ³•


**ðŸ”§ é€Ÿåº¦æµ‹è¯•å·¥å…·ï¼š**
```bash
# åŸºç¡€ç½‘é€Ÿæµ‹è¯•
speedtest-cli

# iperfç½‘ç»œæ€§èƒ½æµ‹è¯•
iperf3 -c server-ip

# VPNå‰åŽå¯¹æ¯”æµ‹è¯•
# 1. æ–­å¼€VPNæµ‹è¯•
# 2. è¿žæŽ¥VPNæµ‹è¯•
# 3. å¯¹æ¯”é€Ÿåº¦å·®å¼‚
```

**æ€§èƒ½åŸºå‡†å‚è€ƒï¼š**

| ç½‘ç»œçŽ¯å¢ƒ | **æœŸæœ›é€Ÿåº¦** | **å»¶è¿ŸèŒƒå›´** |
|----------|-------------|-------------|
| æœ¬åœ°å…‰çº¤ | 80-90% å¸¦å®½ | +5-10ms |
| 4Gç§»åŠ¨ç½‘ç»œ | 60-80% å¸¦å®½ | +20-50ms |
| è·¨å›½è¿žæŽ¥ | 40-70% å¸¦å®½ | +100-300ms |

### 9.3 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


**âš™ï¸ åè®®ä¼˜åŒ–ï¼š**
- **UDP vs TCP**ï¼šUDPé€šå¸¸æ›´å¿«ï¼Œä½†å¯èƒ½ä¸ç¨³å®š
- **åŽ‹ç¼©ç®—æ³•**ï¼šå¯ç”¨LZOåŽ‹ç¼©èŠ‚çœå¸¦å®½
- **åŠ å¯†ç®—æ³•**ï¼šAES-128æ¯”AES-256æ›´å¿«

**ç½‘ç»œä¼˜åŒ–ï¼š**
```bash
# OpenVPNä¼˜åŒ–å‚æ•°
fast-io                 # å¿«é€ŸIO
sndbuf 393216          # å‘é€ç¼“å†²åŒº  
rcvbuf 393216          # æŽ¥æ”¶ç¼“å†²åŒº
comp-lzo               # LZOåŽ‹ç¼©
```

**ðŸŽ¯ ä¼˜åŒ–å»ºè®®ï¼š**
- **é€‰æ‹©å°±è¿‘æœåŠ¡å™¨**ï¼šå‡å°‘ç½‘ç»œå»¶è¿Ÿ
- **ä¼˜åŒ–MTUè®¾ç½®**ï¼šé¿å…æ•°æ®åŒ…åˆ†ç‰‡
- **è°ƒæ•´åŠ å¯†å¼ºåº¦**ï¼šå¹³è¡¡å®‰å…¨æ€§å’Œæ€§èƒ½
- **ä½¿ç”¨çŽ°ä»£åè®®**ï¼šWireGuardé€šå¸¸æ¯”OpenVPNæ›´å¿«

---

## 10. ðŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŽŒæ¡çš„è¯Šæ–­æŠ€èƒ½


```
ðŸ”¸ åŸºç¡€ç½‘ç»œè¯Šæ–­ï¼špingã€tracerouteã€nmap
ðŸ”¸ ç«¯å£è¿žé€šæ€§æ£€æŸ¥ï¼šnetstatã€ssã€lsof
ðŸ”¸ è¯ä¹¦éªŒè¯ï¼šopensslå‘½ä»¤è¡Œå·¥å…·ä½¿ç”¨
ðŸ”¸ æ—¥å¿—åˆ†æžï¼šsystemd journalã€syslog
ðŸ”¸ è·¯ç”±è°ƒè¯•ï¼šip routeã€netstat -rn
ðŸ”¸ æ€§èƒ½æµ‹è¯•ï¼šiperfã€speedtestå·¥å…·
```

### 10.2 æ•…éšœå¤„ç†ä¼˜å…ˆçº§


**ðŸŽ¯ æ ‡å‡†å¤„ç†æµç¨‹ï¼š**
1. **ç¡®è®¤åŸºç¡€è¿žé€š**ï¼šç½‘ç»œã€DNSã€é˜²ç«å¢™
2. **æ£€æŸ¥æœåŠ¡çŠ¶æ€**ï¼šVPNè¿›ç¨‹ã€ç«¯å£ç›‘å¬
3. **éªŒè¯é…ç½®æ–‡ä»¶**ï¼šè¯­æ³•ã€å‚æ•°ã€è·¯å¾„
4. **åˆ†æžè®¤è¯é—®é¢˜**ï¼šç”¨æˆ·åã€å¯†ç ã€è¯ä¹¦
5. **è°ƒè¯•éš§é“å»ºç«‹**ï¼šæ—¥å¿—ã€çŠ¶æ€ã€åå•†è¿‡ç¨‹
6. **ä¼˜åŒ–æ€§èƒ½å‚æ•°**ï¼šMTUã€åŠ å¯†ã€è·¯ç”±

### 10.3 å¸¸è§é”™è¯¯å¿«é€Ÿè§£å†³


| é—®é¢˜ç—‡çŠ¶ | **å¿«é€Ÿæ£€æŸ¥** | **è§£å†³æ–¹å‘** |
|----------|-------------|-------------|
| å®Œå…¨æ— æ³•è¿žæŽ¥ | ç½‘ç»œè¿žé€šæ€§ | é˜²ç«å¢™ã€ç«¯å£ |
| èƒ½è¿žæŽ¥ä½†æ— ç½‘ç»œ | è·¯ç”±é…ç½® | DNSã€è·¯ç”±è¡¨ |
| è¿žæŽ¥ä¸ç¨³å®š | MTUè®¾ç½® | ç½‘ç»œè´¨é‡ |
| é€Ÿåº¦å¾ˆæ…¢ | åŠ å¯†ç®—æ³• | åè®®ä¼˜åŒ– |

### 10.4 é¢„é˜²æ€§ç»´æŠ¤å»ºè®®


**ðŸ› ï¸ æ—¥å¸¸ç»´æŠ¤ä»»åŠ¡ï¼š**
- **å®šæœŸæ›´æ–°è¯ä¹¦**ï¼šé¿å…è¿‡æœŸé—®é¢˜
- **ç›‘æŽ§è¿žæŽ¥è´¨é‡**ï¼šåŠæ—¶å‘çŽ°æ€§èƒ½ä¸‹é™
- **å¤‡ä»½é…ç½®æ–‡ä»¶**ï¼šå¿«é€Ÿæ¢å¤æœåŠ¡
- **æµ‹è¯•æ•…éšœåˆ‡æ¢**ï¼šç¡®ä¿é«˜å¯ç”¨æ€§

**ðŸ“Š ç›‘æŽ§æŒ‡æ ‡ï¼š**
- **è¿žæŽ¥æˆåŠŸçŽ‡**ï¼š>99%
- **å»¶è¿Ÿå¢žé•¿**ï¼š<50ms
- **å¸¦å®½åˆ©ç”¨çŽ‡**ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚
- **é”™è¯¯æ—¥å¿—é¢‘çŽ‡**ï¼šåŠæ—¶å“åº”å¼‚å¸¸

### 10.5 æ•…éšœé¢„æ¡ˆåˆ¶å®š


**ðŸŽ¯ åº”æ€¥å“åº”æµç¨‹ï¼š**
```
ç´§æ€¥æ•…éšœ â€”â€”â†’ å¿«é€Ÿè¯Šæ–­ â€”â€”â†’ ä¸´æ—¶è§£å†³
    â†“              â†“            â†“
æ”¶é›†ä¿¡æ¯ â€”â€”â†’ æ ¹å› åˆ†æž â€”â€”â†’ æ°¸ä¹…ä¿®å¤
    â†“              â†“            â†“  
æ–‡æ¡£è®°å½• â€”â€”â†’ ç»éªŒæ€»ç»“ â€”â€”â†’ æµç¨‹ä¼˜åŒ–
```

**æ ¸å¿ƒè®°å¿†è¦ç‚¹ï¼š**
- VPNæ•…éšœ80%æºäºŽç½‘ç»œè¿žé€šå’Œè®¤è¯é…ç½®
- è·¯ç”±å’ŒMTUé—®é¢˜æ˜¯éš§é“å»ºç«‹åŽçš„ä¸»è¦æ•…éšœ
- æ€§èƒ½é—®é¢˜éœ€è¦ä»Žåè®®ã€ç½‘ç»œã€ç¡¬ä»¶å¤šç»´åº¦åˆ†æž
- è¯¦ç»†çš„æ—¥å¿—è®°å½•æ˜¯å¿«é€Ÿå®šä½é—®é¢˜çš„å…³é”®