---
title: 2ã€Sambaè½¯ä»¶åŒ…å®‰è£…ä¸ŽæœåŠ¡ç®¡ç†
---
## ðŸ“š ç›®å½•

1. [Sambaè½¯ä»¶åŒ…æ¦‚è¿°](#1-Sambaè½¯ä»¶åŒ…æ¦‚è¿°)
2. [è½¯ä»¶åŒ…å®‰è£…](#2-è½¯ä»¶åŒ…å®‰è£…)
3. [å®ˆæŠ¤è¿›ç¨‹è¯¦è§£](#3-å®ˆæŠ¤è¿›ç¨‹è¯¦è§£)
4. [æœåŠ¡ç®¡ç†æ“ä½œ](#4-æœåŠ¡ç®¡ç†æ“ä½œ)
5. [ç«¯å£é…ç½®ä¸Žé˜²ç«å¢™](#5-ç«¯å£é…ç½®ä¸Žé˜²ç«å¢™)
6. [æœåŠ¡æ—¥å¿—ç®¡ç†](#6-æœåŠ¡æ—¥å¿—ç®¡ç†)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ðŸŒ Sambaè½¯ä»¶åŒ…æ¦‚è¿°


### 1.1 SambaåŸºæœ¬å®šä¹‰


**ðŸ”¸ ä»€ä¹ˆæ˜¯Samba**
```
Sambaï¼šå¼€æºçš„æ–‡ä»¶å…±äº«æœåŠ¡è½¯ä»¶
ä½œç”¨ï¼šè®©Linuxç³»ç»Ÿèƒ½ä¸ŽWindowsç³»ç»Ÿäº’ç›¸è®¿é—®æ–‡ä»¶
åŽŸç†ï¼šå®žçŽ°SMB/CIFSåè®®ï¼Œæä¾›è·¨å¹³å°æ–‡ä»¶å…±äº«
åº”ç”¨ï¼šä¼ä¸šç½‘ç»œä¸­LinuxæœåŠ¡å™¨å…±äº«æ–‡ä»¶ç»™Windowså®¢æˆ·ç«¯
```

**ðŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦Samba**
- **è·¨å¹³å°éœ€æ±‚**ï¼šLinuxæœåŠ¡å™¨ â†” Windowså®¢æˆ·ç«¯æ–‡ä»¶å…±äº«
- **åè®®å…¼å®¹**ï¼šWindowså¤©ç„¶æ”¯æŒSMBåè®®ï¼ŒLinuxé€šè¿‡Sambaå®žçŽ°
- **ä¼ä¸šåº”ç”¨**ï¼šç»Ÿä¸€çš„æ–‡ä»¶æœåŠ¡å™¨ï¼Œæ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿè®¿é—®

### 1.2 Sambaä¸ŽWindowså…±äº«çš„å…³ç³»


```
Windowsç½‘ç»œå…±äº«æž¶æž„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    SMB/CIFSåè®®    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Windowså®¢æˆ·ç«¯  â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  â”‚   æ–‡ä»¶æœåŠ¡å™¨     â”‚
â”‚                 â”‚    ç½‘ç»œæ–‡ä»¶å…±äº«     â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Sambaçš„ä½œç”¨ï¼š
è®©LinuxæœåŠ¡å™¨"ä¼ªè£…"æˆWindowsæ–‡ä»¶æœåŠ¡å™¨
å®¢æˆ·ç«¯æ„ŸçŸ¥ï¼šå°±åƒè®¿é—®Windowså…±äº«æ–‡ä»¶å¤¹ä¸€æ ·
```

---

## 2. ðŸ“¦ è½¯ä»¶åŒ…å®‰è£…


### 2.1 æ ¸å¿ƒè½¯ä»¶åŒ…ä»‹ç»


**ðŸ”¸ ä¸‰ä¸ªæ ¸å¿ƒåŒ…è¯´æ˜Ž**

| è½¯ä»¶åŒ…å | **ä¸»è¦ä½œç”¨** | **åŒ…å«ç»„ä»¶** | **å¿…éœ€æ€§** |
|---------|-------------|-------------|-----------|
| **samba** | `æ ¸å¿ƒæœåŠ¡ç¨‹åº` | `smbd, nmbdå®ˆæŠ¤è¿›ç¨‹` | `å¿…è£…` |
| **samba-common** | `å…¬å…±é…ç½®æ–‡ä»¶` | `é…ç½®æ–‡ä»¶æ¨¡æ¿ã€å·¥å…·` | `å¿…è£…` |
| **samba-client** | `å®¢æˆ·ç«¯å·¥å…·` | `smbclientå‘½ä»¤è¡Œå·¥å…·` | `å¯é€‰` |

**å„åŒ…è¯¦ç»†è¯´æ˜Ž**ï¼š
- **samba**ï¼šæä¾›æ–‡ä»¶å…±äº«çš„æ ¸å¿ƒæœåŠ¡ï¼Œè¿™æ˜¯æœ€é‡è¦çš„åŒ…
- **samba-common**ï¼šåŒ…å«é…ç½®æ–‡ä»¶å’Œå…¬å…±ç»„ä»¶ï¼ŒsambaåŒ…ä¾èµ–å®ƒ
- **samba-client**ï¼šæä¾›è¿žæŽ¥å…¶ä»–SMBæœåŠ¡å™¨çš„å·¥å…·ï¼Œç”¨äºŽæµ‹è¯•å¾ˆæœ‰ç”¨

### 2.2 å®‰è£…æ“ä½œæ­¥éª¤


**ðŸ”§ CentOS/RHELç³»ç»Ÿå®‰è£…**
```bash
# ä¸€æ¬¡æ€§å®‰è£…æ‰€æœ‰ç›¸å…³åŒ…
yum install -y samba samba-common samba-client

# æˆ–è€…åˆ†æ­¥å®‰è£…
yum install -y samba          # æ ¸å¿ƒæœåŠ¡
yum install -y samba-common   # å…¬å…±ç»„ä»¶  
yum install -y samba-client   # å®¢æˆ·ç«¯å·¥å…·ï¼ˆå¯é€‰ï¼‰
```

**ðŸ”§ Ubuntu/Debianç³»ç»Ÿå®‰è£…**
```bash
# æ›´æ–°è½¯ä»¶æº
apt update

# å®‰è£…Sambaè½¯ä»¶åŒ…
apt install -y samba samba-common-bin
```

### 2.3 å®‰è£…éªŒè¯


**âœ… éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸ**
```bash
# æ£€æŸ¥è½¯ä»¶åŒ…æ˜¯å¦å®‰è£…
rpm -qa | grep samba     # CentOS/RHEL
dpkg -l | grep samba     # Ubuntu/Debian

# æ£€æŸ¥ä¸»è¦é…ç½®æ–‡ä»¶
ls -l /etc/samba/smb.conf

# æ£€æŸ¥å¯æ‰§è¡Œæ–‡ä»¶
which smbd nmbd
```

---

## 3. âš™ï¸ å®ˆæŠ¤è¿›ç¨‹è¯¦è§£


### 3.1 ä¸‰å¤§å®ˆæŠ¤è¿›ç¨‹æ¦‚è¿°


**ðŸ”¸ å®ˆæŠ¤è¿›ç¨‹æž¶æž„å›¾**
```
SambaæœåŠ¡æž¶æž„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   SambaæœåŠ¡     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   nmbdè¿›ç¨‹      â”‚ â† NetBIOSåç§°æœåŠ¡
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  
â”‚   smbdè¿›ç¨‹      â”‚ â† æ–‡ä»¶å…±äº«æœåŠ¡
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   winbindè¿›ç¨‹   â”‚ â† åŸŸè®¤è¯æœåŠ¡ï¼ˆå¯é€‰ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 nmbdå®ˆæŠ¤è¿›ç¨‹


**ðŸ”¸ nmbdè¿›ç¨‹è¯¦è§£**
```
è¿›ç¨‹åç§°ï¼šnmbd
ä¸»è¦ä½œç”¨ï¼šNetBIOSåç§°è§£æžæœåŠ¡
å·¥ä½œæœºåˆ¶ï¼šå¤„ç†ç½‘ç»œä¸­çš„è®¡ç®—æœºåç§°è§£æž
ç›‘å¬ç«¯å£ï¼š137(UDP)ã€138(UDP)
```

**ðŸ’¡ nmbdçš„å…·ä½“ä½œç”¨**
- **åç§°æ³¨å†Œ**ï¼šåœ¨ç½‘ç»œä¸­æ³¨å†Œæœ¬æœºçš„NetBIOSåç§°
- **åç§°è§£æž**ï¼šå°†è®¡ç®—æœºåè½¬æ¢ä¸ºIPåœ°å€
- **æµè§ˆæœåŠ¡**ï¼šæä¾›ç½‘ç»œé‚»å±…ä¸­çš„è®¡ç®—æœºåˆ—è¡¨
- **å¹¿æ’­å“åº”**ï¼šå“åº”ç½‘ç»œä¸­çš„åç§°æŸ¥è¯¢å¹¿æ’­

**å®žé™…åœºæ™¯ä¸¾ä¾‹**ï¼š
> å½“Windowså®¢æˆ·ç«¯åœ¨"ç½‘ç»œ"ä¸­çœ‹åˆ°LinuxæœåŠ¡å™¨åç§°æ—¶ï¼Œå°±æ˜¯nmbdåœ¨å·¥ä½œ

### 3.3 smbdå®ˆæŠ¤è¿›ç¨‹


**ðŸ”¸ smbdè¿›ç¨‹è¯¦è§£**
```
è¿›ç¨‹åç§°ï¼šsmbd
ä¸»è¦ä½œç”¨ï¼šæ–‡ä»¶å’Œæ‰“å°å…±äº«æœåŠ¡
å·¥ä½œæœºåˆ¶ï¼šå¤„ç†å®¢æˆ·ç«¯çš„æ–‡ä»¶è®¿é—®è¯·æ±‚
ç›‘å¬ç«¯å£ï¼š139(TCP)ã€445(TCP)
```

**ðŸ’¡ smbdçš„æ ¸å¿ƒåŠŸèƒ½**
- **æ–‡ä»¶å…±äº«**ï¼šæä¾›ç›®å½•å’Œæ–‡ä»¶çš„è¯»å†™è®¿é—®
- **æƒé™æŽ§åˆ¶**ï¼šç®¡ç†ç”¨æˆ·è®¿é—®æƒé™
- **ä¼šè¯ç®¡ç†**ï¼šç»´æŠ¤å®¢æˆ·ç«¯è¿žæŽ¥ä¼šè¯
- **æ‰“å°æœåŠ¡**ï¼šæä¾›ç½‘ç»œæ‰“å°åŠŸèƒ½ï¼ˆå¦‚æžœé…ç½®ï¼‰

**å·¥ä½œæµç¨‹ç¤ºä¾‹**ï¼š
```
å®¢æˆ·ç«¯è®¿é—®æµç¨‹ï¼š
å®¢æˆ·ç«¯è¯·æ±‚ â†’ smbdæŽ¥æ”¶ â†’ æƒé™éªŒè¯ â†’ æ–‡ä»¶æ“ä½œ â†’ è¿”å›žç»“æžœ
```

### 3.4 winbindå®ˆæŠ¤è¿›ç¨‹


**ðŸ”¸ winbindè¿›ç¨‹è¯¦è§£**
```
è¿›ç¨‹åç§°ï¼šwinbind
ä¸»è¦ä½œç”¨ï¼šWindowsåŸŸé›†æˆè®¤è¯
ä½¿ç”¨åœºæ™¯ï¼šLinuxæœåŠ¡å™¨åŠ å…¥Windows Active DirectoryåŸŸ
å¯åŠ¨æ¡ä»¶ï¼šåªæœ‰åœ¨åŸŸçŽ¯å¢ƒé…ç½®æ—¶æ‰éœ€è¦å¯åŠ¨
```

**ðŸ’¡ winbindçš„åº”ç”¨åœºæ™¯**
- **åŸŸè®¤è¯**ï¼šä½¿ç”¨WindowsåŸŸç”¨æˆ·ç™»å½•Linuxç³»ç»Ÿ
- **ç”¨æˆ·æ˜ å°„**ï¼šå°†WindowsåŸŸç”¨æˆ·æ˜ å°„åˆ°Linuxç”¨æˆ·
- **ç»„ç®¡ç†**ï¼šå¤„ç†WindowsåŸŸç»„æƒé™

> **æ–°æ‰‹æç¤º**ï¼šä¸€èˆ¬çš„æ–‡ä»¶å…±äº«æœåŠ¡åªéœ€è¦nmbdå’Œsmbdï¼Œä¸éœ€è¦winbind

---

## 4. ðŸ”§ æœåŠ¡ç®¡ç†æ“ä½œ


### 4.1 systemctlåŸºç¡€ç®¡ç†


**ðŸ”¸ æœåŠ¡å¯åœæŽ§åˆ¶**

| æ“ä½œ | **å‘½ä»¤** | **è¯´æ˜Ž** |
|------|---------|----------|
| **å¯åŠ¨æœåŠ¡** | `systemctl start smb nmb` | `ç«‹å³å¯åŠ¨æœåŠ¡` |
| **åœæ­¢æœåŠ¡** | `systemctl stop smb nmb` | `ç«‹å³åœæ­¢æœåŠ¡` |
| **é‡å¯æœåŠ¡** | `systemctl restart smb nmb` | `é‡å¯æœåŠ¡ï¼ˆé…ç½®ä¿®æ”¹åŽï¼‰` |
| **é‡æ–°åŠ è½½** | `systemctl reload smb` | `é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶` |

**å®žé™…æ“ä½œç¤ºä¾‹**ï¼š
```bash
# å¯åŠ¨SambaæœåŠ¡
systemctl start smb nmb

# é‡å¯æœåŠ¡ï¼ˆä¿®æ”¹é…ç½®åŽå¸¸ç”¨ï¼‰
systemctl restart smb nmb

# é‡æ–°åŠ è½½é…ç½®ï¼ˆä¸ä¸­æ–­è¿žæŽ¥ï¼‰
systemctl reload smb
```

### 4.2 å¼€æœºè‡ªå¯åŠ¨é…ç½®


**ðŸ”¸ è‡ªå¯åŠ¨ç®¡ç†**
```bash
# è®¾ç½®å¼€æœºè‡ªå¯åŠ¨
systemctl enable smb nmb

# ç¦ç”¨å¼€æœºè‡ªå¯åŠ¨  
systemctl disable smb nmb

# æŸ¥çœ‹è‡ªå¯åŠ¨çŠ¶æ€
systemctl is-enabled smb nmb
```

**ðŸ’¡ ä¸ºä»€ä¹ˆè¦è®¾ç½®è‡ªå¯åŠ¨**
- **æœåŠ¡ç¨³å®šæ€§**ï¼šç³»ç»Ÿé‡å¯åŽæœåŠ¡è‡ªåŠ¨æ¢å¤
- **æ— äººå€¼å®ˆ**ï¼šä¸éœ€è¦æ‰‹åŠ¨é‡å¯æœåŠ¡
- **ç”Ÿäº§çŽ¯å¢ƒå¿…éœ€**ï¼šç¡®ä¿æ–‡ä»¶å…±äº«æœåŠ¡æŒç»­å¯ç”¨

### 4.3 æœåŠ¡çŠ¶æ€æ£€æŸ¥


**âœ… æœåŠ¡çŠ¶æ€æŸ¥çœ‹**
```bash
# æŸ¥çœ‹è¯¦ç»†æœåŠ¡çŠ¶æ€
systemctl status smb nmb

# æŸ¥çœ‹æœåŠ¡æ˜¯å¦è¿è¡Œ
systemctl is-active smb nmb

# æŸ¥çœ‹æ‰€æœ‰Sambaç›¸å…³è¿›ç¨‹
ps aux | grep -E "(smbd|nmbd)"
```

**çŠ¶æ€è¾“å‡ºè§£è¯»**ï¼š
```bash
â— smb.service - Samba SMB Daemon
   Loaded: loaded (/usr/lib/systemd/system/smb.service; enabled; vendor preset: disabled)
   Active: active (running) since Mon 2025-01-21 10:30:15 CST; 5min ago
     Docs: man:smbd(8)
           man:samba(7)
           man:smb.conf(5)
 Main PID: 1234 (smbd)
   Status: "smbd: ready to serve connections..."
```

**å…³é”®ä¿¡æ¯è¯´æ˜Ž**ï¼š
- **Loaded: enabled**ï¼šå¼€æœºè‡ªå¯åŠ¨å·²å¯ç”¨
- **Active: active (running)**ï¼šæœåŠ¡æ­£åœ¨è¿è¡Œ
- **Main PID**ï¼šä¸»è¿›ç¨‹ID

---

## 5. ðŸ”Œ ç«¯å£é…ç½®ä¸Žé˜²ç«å¢™


### 5.1 SambaæœåŠ¡ç«¯å£è¯´æ˜Ž


**ðŸ”¸ ç«¯å£åŠŸèƒ½è¯¦è§£**

| ç«¯å£å· | **åè®®** | **æœåŠ¡** | **ç”¨é€”è¯´æ˜Ž** |
|--------|---------|---------|-------------|
| **137** | `UDP` | `nmbd` | `NetBIOSåç§°æœåŠ¡` |
| **138** | `UDP` | `nmbd` | `NetBIOSæ•°æ®æŠ¥æœåŠ¡` |
| **139** | `TCP` | `smbd` | `NetBIOSä¼šè¯æœåŠ¡ï¼ˆä¼ ç»Ÿï¼‰` |
| **445** | `TCP` | `smbd` | `Microsoft-DSç›´æŽ¥SMB` |

**ç«¯å£ä½¿ç”¨åœºæ™¯**ï¼š
- **137/138ç«¯å£**ï¼šä¸»è¦ç”¨äºŽç½‘ç»œé‚»å±…æµè§ˆå’Œåç§°è§£æž
- **139ç«¯å£**ï¼šè€ç‰ˆæœ¬Windowsä½¿ç”¨çš„SMB over NetBIOS
- **445ç«¯å£**ï¼šçŽ°ä»£Windowsç³»ç»Ÿä½¿ç”¨çš„ç›´æŽ¥SMBè¿žæŽ¥

### 5.2 é˜²ç«å¢™é…ç½®


**ðŸ”¥ firewall-cmdé…ç½®ï¼ˆCentOS/RHELï¼‰**
```bash
# å¼€æ”¾SambaæœåŠ¡ï¼ˆæŽ¨èæ–¹å¼ï¼‰
firewall-cmd --permanent --add-service=samba
firewall-cmd --reload

# æˆ–è€…å•ç‹¬å¼€æ”¾ç«¯å£
firewall-cmd --permanent --add-port=137/udp
firewall-cmd --permanent --add-port=138/udp  
firewall-cmd --permanent --add-port=139/tcp
firewall-cmd --permanent --add-port=445/tcp
firewall-cmd --reload
```

**ðŸ”¥ ufwé…ç½®ï¼ˆUbuntuï¼‰**
```bash
# å…è®¸SambaæœåŠ¡
ufw allow samba

# æˆ–è€…æŒ‡å®šç«¯å£èŒƒå›´
ufw allow 137:139/udp
ufw allow 445/tcp
```

### 5.3 ç½‘ç»œè¿žæŽ¥æµ‹è¯•


**ðŸ” è¿žæŽ¥æµ‹è¯•æ–¹æ³•**
```bash
# æ£€æŸ¥ç«¯å£æ˜¯å¦ç›‘å¬
netstat -tulnp | grep -E "(137|138|139|445)"
ss -tulnp | grep -E "(137|138|139|445)"

# æµ‹è¯•ç«¯å£è¿žé€šæ€§
telnet æœåŠ¡å™¨IP 445
nc -v æœåŠ¡å™¨IP 445
```

**æœŸæœ›è¾“å‡ºç¤ºä¾‹**ï¼š
```
tcp  0  0  0.0.0.0:445    0.0.0.0:*    LISTEN   1234/smbd
tcp  0  0  0.0.0.0:139    0.0.0.0:*    LISTEN   1234/smbd  
udp  0  0  0.0.0.0:137    0.0.0.0:*             1235/nmbd
udp  0  0  0.0.0.0:138    0.0.0.0:*             1235/nmbd
```

---

## 6. ðŸ“‹ æœåŠ¡æ—¥å¿—ç®¡ç†


### 6.1 æ—¥å¿—æ–‡ä»¶ä½ç½®


**ðŸ”¸ ä¸»è¦æ—¥å¿—æ–‡ä»¶**
```
ç³»ç»Ÿæ—¥å¿—ä½ç½®ï¼š
/var/log/samba/          â† Sambaä¸“ç”¨æ—¥å¿—ç›®å½•
â”œâ”€â”€ log.nmbd             â† nmbdè¿›ç¨‹æ—¥å¿—
â”œâ”€â”€ log.smbd             â† smbdè¿›ç¨‹æ—¥å¿—  
â””â”€â”€ log.winbindd         â† winbindè¿›ç¨‹æ—¥å¿—

ç³»ç»ŸæœåŠ¡æ—¥å¿—ï¼š
/var/log/messages        â† ç³»ç»Ÿç»¼åˆæ—¥å¿—
/var/log/secure          â† è®¤è¯ç›¸å…³æ—¥å¿—
```

### 6.2 æ—¥å¿—æŸ¥çœ‹æ–¹æ³•


**ðŸ“– å¸¸ç”¨æ—¥å¿—æŸ¥çœ‹å‘½ä»¤**
```bash
# æŸ¥çœ‹Sambaä¸»æ—¥å¿—
tail -f /var/log/samba/log.smbd
tail -f /var/log/samba/log.nmbd

# ä½¿ç”¨systemctlæŸ¥çœ‹æœåŠ¡æ—¥å¿—
journalctl -u smb -f
journalctl -u nmb -f

# æŸ¥çœ‹æœ€è¿‘çš„é”™è¯¯æ—¥å¿—
journalctl -u smb --since "1 hour ago" -p err
```

### 6.3 å¸¸è§æ—¥å¿—é—®é¢˜åˆ†æž


**âš ï¸ å…¸åž‹é”™è¯¯æ—¥å¿—åŠè§£å†³æ–¹æ¡ˆ**

**æƒé™é—®é¢˜**ï¼š
```
[ERROR] Failed to connect to socket /var/run/samba/smbd.sock
è§£å†³ï¼šæ£€æŸ¥sambaè¿›ç¨‹æƒé™ï¼Œé‡å¯æœåŠ¡
```

**é…ç½®æ–‡ä»¶é”™è¯¯**ï¼š
```
[ERROR] Can't load configuration file /etc/samba/smb.conf
è§£å†³ï¼šæ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•ï¼Œä½¿ç”¨testparméªŒè¯
```

**ç«¯å£å†²çª**ï¼š
```
[ERROR] bind failed on port 445
è§£å†³ï¼šæ£€æŸ¥ç«¯å£å ç”¨ï¼Œåœæ­¢å†²çªçš„æœåŠ¡
```

### 6.4 æ—¥å¿—ç®¡ç†å»ºè®®


**ðŸ’¡ æ—¥å¿—ç»´æŠ¤æœ€ä½³å®žè·µ**
- **å®šæœŸæ¸…ç†**ï¼šé¿å…æ—¥å¿—æ–‡ä»¶è¿‡å¤§å½±å“æ€§èƒ½
- **æ—¥å¿—è½®è½¬**ï¼šé…ç½®logrotateè‡ªåŠ¨ç®¡ç†æ—¥å¿—
- **ç›‘æŽ§å‘Šè­¦**ï¼šå¯¹é”™è¯¯æ—¥å¿—è®¾ç½®ç›‘æŽ§æé†’
- **å¤‡ä»½é‡è¦æ—¥å¿—**ï¼šä¿ç•™é—®é¢˜æŽ’æŸ¥çš„åŽ†å²è®°å½•

```bash
# é…ç½®æ—¥å¿—è½®è½¬ç¤ºä¾‹
cat > /etc/logrotate.d/samba << EOF
/var/log/samba/*.log {
    weekly
    rotate 4
    compress
    missingok
    notifempty
    create 0644 root root
}
EOF
```

---

## 7. ðŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŽŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ðŸ”¸ ä¸‰ä¸ªæ ¸å¿ƒåŒ…ï¼šsambaï¼ˆæ ¸å¿ƒï¼‰ã€samba-commonï¼ˆé…ç½®ï¼‰ã€samba-clientï¼ˆå·¥å…·ï¼‰
ðŸ”¸ ä¸‰ä¸ªå®ˆæŠ¤è¿›ç¨‹ï¼šnmbdï¼ˆåç§°è§£æžï¼‰ã€smbdï¼ˆæ–‡ä»¶å…±äº«ï¼‰ã€winbindï¼ˆåŸŸè®¤è¯ï¼‰
ðŸ”¸ å››ä¸ªå…³é”®ç«¯å£ï¼š137/138ï¼ˆUDPï¼‰ã€139/445ï¼ˆTCPï¼‰
ðŸ”¸ systemctlç®¡ç†ï¼šå¯åœã€è‡ªå¯åŠ¨ã€çŠ¶æ€æ£€æŸ¥
ðŸ”¸ é˜²ç«å¢™é…ç½®ï¼šå¿…é¡»å¼€æ”¾ç›¸åº”ç«¯å£
ðŸ”¸ æ—¥å¿—ç®¡ç†ï¼š/var/log/samba/ç›®å½•ä¸‹çš„å„ç±»æ—¥å¿—
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ðŸ”¹ æœåŠ¡ä¾èµ–å…³ç³»**
```
åŸºç¡€ä¾èµ–ï¼šsamba â†’ samba-common
è¿›ç¨‹åä½œï¼šnmbdï¼ˆåç§°æœåŠ¡ï¼‰ + smbdï¼ˆæ–‡ä»¶æœåŠ¡ï¼‰
ç½‘ç»œé€šä¿¡ï¼šé˜²ç«å¢™ç«¯å£ â†’ å®¢æˆ·ç«¯è¿žæŽ¥ â†’ æœåŠ¡å“åº”
```

**ðŸ”¹ å¸¸ç”¨æ“ä½œæµç¨‹**
```
æ ‡å‡†å¯åŠ¨æµç¨‹ï¼š
1. å®‰è£…è½¯ä»¶åŒ…
2. å¯åŠ¨æœåŠ¡è¿›ç¨‹  
3. è®¾ç½®è‡ªå¯åŠ¨
4. å¼€æ”¾é˜²ç«å¢™ç«¯å£
5. éªŒè¯æœåŠ¡çŠ¶æ€
```

**ðŸ”¹ æ•…éšœæŽ’æŸ¥æ€è·¯**
```
é—®é¢˜æŽ’æŸ¥é¡ºåºï¼š
1. æœåŠ¡çŠ¶æ€æ£€æŸ¥ï¼ˆsystemctl statusï¼‰
2. ç«¯å£ç›‘å¬æ£€æŸ¥ï¼ˆnetstat/ssï¼‰
3. é˜²ç«å¢™è§„åˆ™æ£€æŸ¥ï¼ˆfirewall-cmd --listï¼‰
4. æ—¥å¿—é”™è¯¯åˆ†æžï¼ˆjournalctl/tailï¼‰
5. é…ç½®æ–‡ä»¶éªŒè¯ï¼ˆtestparmï¼‰
```

### 7.3 å®žé™…åº”ç”¨ä»·å€¼


- **ä¼ä¸šæ–‡ä»¶æœåŠ¡**ï¼šä¸ºWindowså®¢æˆ·ç«¯æä¾›Linuxæ–‡ä»¶æœåŠ¡å™¨
- **è·¨å¹³å°åä½œ**ï¼šå®žçŽ°ä¸åŒæ“ä½œç³»ç»Ÿé—´çš„æ–‡ä»¶å…±äº«
- **é›†ä¸­å­˜å‚¨ç®¡ç†**ï¼šç»Ÿä¸€çš„æ–‡ä»¶å­˜å‚¨å’Œæƒé™ç®¡ç†
- **æˆæœ¬ä¼˜åŒ–**ï¼šä½¿ç”¨LinuxæœåŠ¡å™¨æ›¿ä»£Windowsæ–‡ä»¶æœåŠ¡å™¨

### 7.4 æ–°æ‰‹å­¦ä¹ é‡ç‚¹


**ðŸŽ¯ å­¦ä¹ ä¼˜å…ˆçº§**
1. **æŽŒæ¡åŸºæœ¬å®‰è£…**ï¼šä¸‰ä¸ªè½¯ä»¶åŒ…çš„ä½œç”¨å’Œå®‰è£…æ–¹æ³•
2. **ç†è§£è¿›ç¨‹è§’è‰²**ï¼šnmbdå’Œsmbdåˆ†åˆ«åšä»€ä¹ˆ
3. **ç†Ÿç»ƒæœåŠ¡ç®¡ç†**ï¼šsystemctlçš„å¸¸ç”¨å‘½ä»¤
4. **é…ç½®é˜²ç«å¢™**ï¼šç¡®ä¿ç½‘ç»œè¿žé€šæ€§
5. **ä¼šçœ‹æ—¥å¿—**ï¼šåŸºæœ¬çš„æ•…éšœæŽ’æŸ¥èƒ½åŠ›

**ðŸ“ å®žè·µå»ºè®®**
- **åŠ¨æ‰‹æ“ä½œ**ï¼šåœ¨è™šæ‹Ÿæœºä¸­å®žé™…å®‰è£…é…ç½®
- **ç½‘ç»œæµ‹è¯•**ï¼šéªŒè¯ç«¯å£å¼€æ”¾å’ŒæœåŠ¡è¿žé€šæ€§  
- **æ•…éšœæ¨¡æ‹Ÿ**ï¼šä¸»åŠ¨åˆ¶é€ é—®é¢˜ç»ƒä¹ æŽ’æŸ¥
- **æ–‡æ¡£è®°å½•**ï¼šè®°å½•è‡ªå·±çš„é…ç½®æ­¥éª¤å’Œé‡åˆ°çš„é—®é¢˜

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- Sambaè®©Linux"è¯´"Windowsè¯­è¨€ï¼Œå®žçŽ°æ–‡ä»¶å…±äº«
- ä¸‰ä¸ªåŒ…ã€ä¸‰ä¸ªè¿›ç¨‹ã€å››ä¸ªç«¯å£æ˜¯åŸºç¡€æž¶æž„
- systemctlç®¡ç†æœåŠ¡ï¼Œé˜²ç«å¢™å¼€æ”¾ç«¯å£ï¼Œæ—¥å¿—æŽ’æŸ¥é—®é¢˜
- å®‰è£…â†’å¯åŠ¨â†’å¼€ç«¯å£â†’æµ‹è¯•ï¼Œè¿™æ˜¯æ ‡å‡†æµç¨‹