---
title: 1ã€hostsæ–‡ä»¶é…ç½®ä¸ç®¡ç†
---
## ğŸ“š ç›®å½•

1. [hostsæ–‡ä»¶æ¦‚è¿°ä¸ä½œç”¨](#1-hostsæ–‡ä»¶æ¦‚è¿°ä¸ä½œç”¨)
2. [æ–‡ä»¶ç»“æ„ä¸è¯­æ³•è§„åˆ™](#2-æ–‡ä»¶ç»“æ„ä¸è¯­æ³•è§„åˆ™)
3. [åŸŸåè§£æä¼˜å…ˆçº§æœºåˆ¶](#3-åŸŸåè§£æä¼˜å…ˆçº§æœºåˆ¶)
4. [ä¸»æœºåä¸IPåœ°å€æ˜ å°„é…ç½®](#4-ä¸»æœºåä¸IPåœ°å€æ˜ å°„é…ç½®)
5. [ç”Ÿäº§ç¯å¢ƒåº”ç”¨åœºæ™¯](#5-ç”Ÿäº§ç¯å¢ƒåº”ç”¨åœºæ™¯)
6. [ä¸DNSè§£æçš„å…³ç³»å¤„ç†](#6-ä¸DNSè§£æçš„å…³ç³»å¤„ç†)
7. [å®‰å…¨è€ƒè™‘ä¸æœ€ä½³å®è·µ](#7-å®‰å…¨è€ƒè™‘ä¸æœ€ä½³å®è·µ)
8. [æ•…éšœæ’æŸ¥ä¸è¯Šæ–­æ–¹æ³•](#8-æ•…éšœæ’æŸ¥ä¸è¯Šæ–­æ–¹æ³•)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ  hostsæ–‡ä»¶æ¦‚è¿°ä¸ä½œç”¨


### 1.1 ä»€ä¹ˆæ˜¯hostsæ–‡ä»¶


**ç®€å•ç†è§£**ï¼šhostsæ–‡ä»¶å°±åƒä½ æ‰‹æœºé‡Œçš„é€šè®¯å½•ï¼Œå­˜å‚¨ç€"åå­—â†’ç”µè¯å·ç "çš„å¯¹åº”å…³ç³»ã€‚åœ¨Linuxç³»ç»Ÿä¸­ï¼Œå®ƒå­˜å‚¨çš„æ˜¯"åŸŸåâ†’IPåœ°å€"çš„å¯¹åº”å…³ç³»ã€‚

```
é€šè®¯å½•ç±»æ¯”ï¼š
å¼ ä¸‰ â†’ 138xxxx1234
æå›› â†’ 139xxxx5678

hostsæ–‡ä»¶ï¼š
www.example.com â†’ 192.168.1.100
api.mysite.com â†’ 10.0.0.50
```

**ğŸ”¸ æ ¸å¿ƒä½œç”¨**ï¼š
- **æœ¬åœ°åŸŸåè§£æ**ï¼šä¸ç”¨é—®DNSæœåŠ¡å™¨ï¼Œç›´æ¥åœ¨æœ¬åœ°æŸ¥æ‰¾åŸŸåå¯¹åº”çš„IP
- **ç½‘ç»œè®¿é—®æ§åˆ¶**ï¼šå¯ä»¥å±è”½æŸäº›ç½‘ç«™æˆ–é‡å®šå‘åˆ°ç‰¹å®šæœåŠ¡å™¨
- **å¼€å‘ç¯å¢ƒé…ç½®**ï¼šæµ‹è¯•æ—¶å°†åŸŸåæŒ‡å‘æœ¬åœ°æœåŠ¡å™¨
- **ç½‘ç»œåŠ é€Ÿ**ï¼šå‡å°‘DNSæŸ¥è¯¢æ—¶é—´

### 1.2 æ–‡ä»¶ä½ç½®ä¸æƒé™


**ğŸ“ æ–‡ä»¶ä½ç½®**ï¼š
```bash
/etc/hosts
```

**ğŸ” æƒé™è¦æ±‚**ï¼š
```bash
# æŸ¥çœ‹æ–‡ä»¶æƒé™
ls -l /etc/hosts
-rw-r--r-- 1 root root 158 Sep 18 14:30 /etc/hosts

æƒé™è§£é‡Šï¼š
- æ‰€æœ‰è€…(root)ï¼šè¯»å†™æƒé™
- ç»„ç”¨æˆ·ï¼šåªè¯»æƒé™  
- å…¶ä»–ç”¨æˆ·ï¼šåªè¯»æƒé™
```

### 1.3 å·¥ä½œåŸç†


```
ç”¨æˆ·è®¿é—®æµç¨‹ï¼š
ç”¨æˆ·è¾“å…¥åŸŸå â†’ ç³»ç»ŸæŸ¥è¯¢hostsæ–‡ä»¶ â†’ æ‰¾åˆ°å¯¹åº”IP â†’ ç›´æ¥è®¿é—®
               â†“ (å¦‚æœhostsä¸­æ²¡æœ‰)
               æŸ¥è¯¢DNSæœåŠ¡å™¨ â†’ è·å–IPåœ°å€ â†’ è®¿é—®ç›®æ ‡
```

**ğŸ’¡ é‡è¦ç‰¹ç‚¹**ï¼š
- **ä¼˜å…ˆçº§é«˜**ï¼šhostsæ–‡ä»¶çš„è§£æä¼˜å…ˆäºDNSæœåŠ¡å™¨
- **å³æ—¶ç”Ÿæ•ˆ**ï¼šä¿®æ”¹åä¸éœ€è¦é‡å¯æœåŠ¡
- **ç³»ç»Ÿçº§åˆ«**ï¼šå½±å“æ•´ä¸ªç³»ç»Ÿçš„åŸŸåè§£æ

---

## 2. ğŸ“ æ–‡ä»¶ç»“æ„ä¸è¯­æ³•è§„åˆ™


### 2.1 åŸºæœ¬è¯­æ³•æ ¼å¼


**æ ‡å‡†æ ¼å¼**ï¼š
```
IPåœ°å€    åŸŸå1    [åŸŸå2]    [åŸŸå3]    [# æ³¨é‡Š]
```

**ğŸ”¸ è¯­æ³•è¦ç‚¹**ï¼š
- IPåœ°å€å’ŒåŸŸåä¹‹é—´ç”¨**ç©ºæ ¼**æˆ–**Tab**åˆ†éš”
- ä¸€è¡Œå¯ä»¥åŒ…å«å¤šä¸ªåŸŸåï¼ˆéƒ½æŒ‡å‘åŒä¸€ä¸ªIPï¼‰
- ä»¥`#`å¼€å¤´çš„æ˜¯æ³¨é‡Šè¡Œ
- ç©ºè¡Œè¢«å¿½ç•¥

### 2.2 å®é™…ç¤ºä¾‹è§£æ


```bash
# æŸ¥çœ‹ç³»ç»Ÿé»˜è®¤hostsæ–‡ä»¶å†…å®¹
cat /etc/hosts
```

**å…¸å‹å†…å®¹ç¤ºä¾‹**ï¼š
```
# æœ¬åœ°å›ç¯åœ°å€
127.0.0.1   localhost localhost.localdomain
::1         localhost localhost.localdomain

# æœ¬æœºIPæ˜ å°„
192.168.1.10   myserver myserver.local

# å¼€å‘ç¯å¢ƒé…ç½®
127.0.0.1   dev.example.com test.example.com

# ç”Ÿäº§ç¯å¢ƒæ˜ å°„
203.0.113.10   www.example.com example.com
203.0.113.20   api.example.com

# å±è”½å¹¿å‘ŠåŸŸå
0.0.0.0   ads.example.com tracker.spam.com
```

### 2.3 æ ¼å¼è§„èŒƒè¯¦è§£


**âœ… æ­£ç¡®å†™æ³•**ï¼š
```bash
192.168.1.100    web1.company.com web1
10.0.0.50        database.local db
127.0.0.1        test.dev
```

**âŒ é”™è¯¯å†™æ³•**ï¼š
```bash
192.168.1.100web1.company.com    # ç¼ºå°‘åˆ†éš”ç¬¦
192.168.1.100,web1.company.com   # é”™è¯¯çš„åˆ†éš”ç¬¦
192.168.1.300    web1.company.com # æ— æ•ˆIPåœ°å€
web1.company.com 192.168.1.100   # IPå’ŒåŸŸåä½ç½®é¢ å€’
```

**ğŸ¯ ä¹¦å†™å»ºè®®**ï¼š
- ä½¿ç”¨åˆ¶è¡¨ç¬¦(Tab)å¯¹é½ï¼Œè®©æ–‡ä»¶æ›´æ˜“è¯»
- ç›¸å…³æ¡ç›®åˆ†ç»„ï¼Œæ·»åŠ æ³¨é‡Šè¯´æ˜
- IPåœ°å€åˆ—å¯¹é½ï¼ŒåŸŸååˆ—å¯¹é½

---

## 3. ğŸ” åŸŸåè§£æä¼˜å…ˆçº§æœºåˆ¶


### 3.1 è§£æé¡ºåºæµç¨‹


**å®Œæ•´è§£ææµç¨‹**ï¼š
```
åº”ç”¨ç¨‹åºè¯·æ±‚åŸŸåè§£æ
         â†“
æ£€æŸ¥æœ¬åœ°ç¼“å­˜
         â†“ (ç¼“å­˜æœªå‘½ä¸­)
æŸ¥è¯¢ /etc/hosts æ–‡ä»¶  â† è¿™é‡Œï¼
         â†“ (hostsä¸­æœªæ‰¾åˆ°)
æŸ¥è¯¢ /etc/resolv.conf é…ç½®çš„DNSæœåŠ¡å™¨
         â†“
è¿”å›è§£æç»“æœç»™åº”ç”¨ç¨‹åº
```

### 3.2 ä¼˜å…ˆçº§é…ç½®


**ğŸ’¡ ç†è§£è¦ç‚¹**ï¼šhostsæ–‡ä»¶çš„ä¼˜å…ˆçº§ç”±`/etc/nsswitch.conf`æ–‡ä»¶æ§åˆ¶

```bash
# æŸ¥çœ‹åŸŸåè§£æé…ç½®
grep hosts /etc/nsswitch.conf

# å…¸å‹è¾“å‡º
hosts: files dns
```

**é…ç½®å«ä¹‰**ï¼š
- `files`ï¼šè¡¨ç¤ºå…ˆæŸ¥è¯¢æœ¬åœ°æ–‡ä»¶(åŒ…æ‹¬hosts)
- `dns`ï¼šè¡¨ç¤ºå†æŸ¥è¯¢DNSæœåŠ¡å™¨
- é¡ºåºï¼šä»å·¦åˆ°å³ä¾æ¬¡æŸ¥è¯¢

### 3.3 å®é™…éªŒè¯


**ğŸ§ª æµ‹è¯•hostsæ–‡ä»¶ä¼˜å…ˆçº§**ï¼š

```bash
# 1. æ·»åŠ æµ‹è¯•æ¡ç›®åˆ°hosts
echo "127.0.0.1 www.baidu.com" >> /etc/hosts

# 2. æµ‹è¯•è§£æç»“æœ
ping www.baidu.com
# ä¼špingåˆ°127.0.0.1è€Œä¸æ˜¯ç™¾åº¦çœŸå®IP

# 3. æ¸…ç†æµ‹è¯•
sed -i '/127.0.0.1 www.baidu.com/d' /etc/hosts
```

**ğŸ“Š ä¼˜å…ˆçº§å¯¹æ¯”**ï¼š

| è§£ææ–¹å¼ | ä¼˜å…ˆçº§ | é€Ÿåº¦ | ä½¿ç”¨åœºæ™¯ |
|---------|--------|------|---------|
| æœ¬åœ°ç¼“å­˜ | ğŸ¥‡ æœ€é«˜ | âš¡ æœ€å¿« | ç³»ç»Ÿè‡ªåŠ¨ç®¡ç† |
| hostsæ–‡ä»¶ | ğŸ¥ˆ ç¬¬äºŒ | âš¡ å¾ˆå¿« | æ‰‹åŠ¨é…ç½® |
| DNSæœåŠ¡å™¨ | ğŸ¥‰ ç¬¬ä¸‰ | ğŸ¢ è¾ƒæ…¢ | ç½‘ç»œæŸ¥è¯¢ |

---

## 4. ğŸ”§ ä¸»æœºåä¸IPåœ°å€æ˜ å°„é…ç½®


### 4.1 åŸºæœ¬æ˜ å°„é…ç½®


**å•åŸŸåæ˜ å°„**ï¼š
```bash
# åŸºæœ¬æ ¼å¼
192.168.1.100    webserver.company.com

# å®é™…é…ç½®ç¤ºä¾‹
192.168.1.10     mail.company.com
192.168.1.20     ftp.company.com  
192.168.1.30     db.company.com
```

**å¤šåŸŸåæ˜ å°„åŒä¸€IP**ï¼š
```bash
# ä¸€ä¸ªIPå¯¹åº”å¤šä¸ªåŸŸå
192.168.1.100    www.company.com company.com web.company.com
```

### 4.2 å¸¸ç”¨æ˜ å°„åœºæ™¯


**ğŸ”¸ å¼€å‘ç¯å¢ƒé…ç½®**ï¼š
```bash
# å¼€å‘ç¯å¢ƒæ˜ å°„
127.0.0.1        dev.myproject.com
127.0.0.1        api.dev.myproject.com
127.0.0.1        admin.dev.myproject.com

# æµ‹è¯•ç¯å¢ƒæ˜ å°„
192.168.10.50    test.myproject.com
192.168.10.51    api.test.myproject.com
```

**ğŸ”¸ å†…ç½‘æœåŠ¡æ˜ å°„**ï¼š
```bash
# å†…ç½‘æœåŠ¡å™¨æ˜ å°„
10.0.1.100       jenkins.internal
10.0.1.101       gitlab.internal
10.0.1.102       monitoring.internal
10.0.1.103       backup.internal
```

### 4.3 IPv6åœ°å€æ˜ å°„


**IPv6æ ¼å¼æ”¯æŒ**ï¼š
```bash
# IPv6æœ¬åœ°å›ç¯
::1              localhost ip6-localhost ip6-loopback

# IPv6åœ°å€æ˜ å°„
2001:db8::1      ipv6.example.com
fe80::1          local-ipv6.test
```

### 4.4 é…ç½®ç®¡ç†æŠ€å·§


**ğŸ“‹ åˆ†ç»„ç®¡ç†ç¤ºä¾‹**ï¼š
```bash
# ============= æœ¬åœ°ç¯å› =============
127.0.0.1       localhost localhost.localdomain
::1             localhost ip6-localhost ip6-loopback

# ============= å¼€å‘ç¯å¢ƒ =============
127.0.0.1       dev.api.com
127.0.0.1       dev.web.com

# ============= ç”Ÿäº§ç¯å¢ƒ =============
203.0.113.100   api.company.com
203.0.113.101   web.company.com

# ============= å†…ç½‘æœåŠ¡ =============
192.168.1.10    jenkins.local
192.168.1.20    git.local
```

**ğŸ’¡ ç®¡ç†å»ºè®®**ï¼š
- ä½¿ç”¨æ³¨é‡Šåˆ†ç»„ï¼Œä¾¿äºç»´æŠ¤
- ä¿ç•™åŸå§‹é…ç½®çš„å¤‡ä»½
- å®šæœŸæ¸…ç†æ— ç”¨æ¡ç›®

---

## 5. ğŸ¢ ç”Ÿäº§ç¯å¢ƒåº”ç”¨åœºæ™¯


### 5.1 æœåŠ¡è¿ç§»åœºæ™¯


**åœºæ™¯æè¿°**ï¼šå°†æœåŠ¡ä»æ—§æœåŠ¡å™¨è¿ç§»åˆ°æ–°æœåŠ¡å™¨ï¼Œä½†åŸŸåä¿æŒä¸å˜

**ä¼ ç»Ÿæ–¹å¼**ï¼šä¿®æ”¹DNSè®°å½•ï¼Œç­‰å¾…å…¨çƒDNSæ›´æ–°(å¯èƒ½éœ€è¦24-48å°æ—¶)

**hostsæ–‡ä»¶æ–¹å¼**ï¼š
```bash
# è¿ç§»å‰ï¼šæœåŠ¡åœ¨æ—§æœåŠ¡å™¨
# 203.0.113.100   api.company.com

# è¿ç§»ä¸­ï¼šä¸´æ—¶æŒ‡å‘æ–°æœåŠ¡å™¨æµ‹è¯•
203.0.113.200   api.company.com

# ç¡®è®¤æ— è¯¯åï¼Œæ›´æ–°DNSå¹¶åˆ é™¤hostsæ¡ç›®
```

**ğŸ¯ ä¼˜åŠ¿**ï¼š
- **å³æ—¶ç”Ÿæ•ˆ**ï¼šæ— éœ€ç­‰å¾…DNSä¼ æ’­
- **ç²¾ç¡®æ§åˆ¶**ï¼šåªå½±å“å½“å‰æœåŠ¡å™¨
- **æ–¹ä¾¿å›æ»š**ï¼šå‡ºé—®é¢˜ç«‹å³æ¢å¤

### 5.2 è´Ÿè½½å‡è¡¡é…ç½®


**ç®€å•è½®è¯¢å®ç°**ï¼š
```bash
# æ³¨æ„ï¼šhostsæ–‡ä»¶ä¸èƒ½å®ç°çœŸæ­£çš„è´Ÿè½½å‡è¡¡
# ä½†å¯ä»¥ç”¨äºæ•…éšœåˆ‡æ¢

# æ­£å¸¸æƒ…å†µ
192.168.1.100   api.service.com

# ä¸»æœåŠ¡å™¨æ•…éšœæ—¶ï¼Œå¿«é€Ÿåˆ‡æ¢åˆ°å¤‡ç”¨æœåŠ¡å™¨
# 192.168.1.100   api.service.com     # æ³¨é‡Šæ‰æ•…éšœæœåŠ¡å™¨
192.168.1.101   api.service.com       # å¯ç”¨å¤‡ç”¨æœåŠ¡å™¨
```

### 5.3 ç½‘ç»œå®‰å…¨åº”ç”¨


**æ¶æ„åŸŸåå±è”½**ï¼š
```bash
# å±è”½æ¶æ„ç½‘ç«™(æŒ‡å‘æ— æ•ˆåœ°å€)
0.0.0.0         malware.example.com
0.0.0.0         phishing.site.com
127.0.0.1       unwanted-ads.com

# æˆ–è€…æŒ‡å‘æœ¬åœ°ï¼Œç”¨äºåˆ†ææ¶æ„è¯·æ±‚
127.0.0.1       suspicious.domain.com
```

### 5.4 å†…ç½‘æœåŠ¡ä¼˜åŒ–


**å†…ç½‘åŸŸåç®€åŒ–**ï¼š
```bash
# é•¿åŸŸåç®€åŒ–
192.168.1.100   jenkins    # ç®€åŒ–è®¿é—®jenkins.company.internal
192.168.1.101   git        # ç®€åŒ–è®¿é—®git.company.internal
192.168.1.102   monitor    # ç®€åŒ–è®¿é—®monitoring.company.internal

# ä½¿ç”¨æ•ˆæœ
# åŸæ¥ï¼šssh admin@jenkins.company.internal
# ç°åœ¨ï¼šssh admin@jenkins
```

---

## 6. ğŸŒ ä¸DNSè§£æçš„å…³ç³»å¤„ç†


### 6.1 DNSä¸hostsçš„å…³ç³»


**å·¥ä½œå…³ç³»å›¾**ï¼š
```
DNSæŸ¥è¯¢æµç¨‹ï¼š
å®¢æˆ·ç«¯è¯·æ±‚åŸŸå
    â†“
æŸ¥çœ‹æœ¬åœ°hostsæ–‡ä»¶  â†â”€ ä¼˜å…ˆæŸ¥è¯¢
    â†“ (æœªæ‰¾åˆ°)
æŸ¥è¯¢æœ¬åœ°DNSç¼“å­˜
    â†“ (ç¼“å­˜è¿‡æœŸ/æœªæ‰¾åˆ°)
æŸ¥è¯¢DNSæœåŠ¡å™¨
    â†“
è¿”å›IPåœ°å€
```

**ğŸ’¡ å…³é”®ç†è§£**ï¼š
- hostsæ–‡ä»¶æ˜¯**æœ¬åœ°é™æ€è§£æ**
- DNSæœåŠ¡å™¨æ˜¯**ç½‘ç»œåŠ¨æ€è§£æ**
- hostsä¼˜å…ˆçº§æ›´é«˜ï¼Œä½†åªå½±å“æœ¬æœº

### 6.2 å†²çªå¤„ç†ç­–ç•¥


**å¸¸è§å†²çªåœºæ™¯**ï¼š
```bash
# hostsæ–‡ä»¶é…ç½®
192.168.1.100   www.example.com

# DNSæœåŠ¡å™¨è¿”å›
# www.example.com â†’ 203.0.113.50

# ç»“æœï¼šç³»ç»Ÿä¼šä½¿ç”¨hostsæ–‡ä»¶çš„192.168.1.100
```

**ğŸ”§ å†²çªå¤„ç†æ–¹æ³•**ï¼š

| å¤„ç†æ–¹å¼ | é€‚ç”¨åœºæ™¯ | æ“ä½œæ–¹æ³• |
|---------|----------|----------|
| **åˆ é™¤hostsæ¡ç›®** | ä½¿ç”¨DNSè§£æ | `sed -i '/example.com/d' /etc/hosts` |
| **æ³¨é‡Šhostsæ¡ç›®** | ä¸´æ—¶åˆ‡æ¢åˆ°DNS | åœ¨è¡Œé¦–æ·»åŠ `#` |
| **ä¿®æ”¹hostsæ¡ç›®** | æ›´æ–°æœ¬åœ°æ˜ å°„ | ç›´æ¥ç¼–è¾‘IPåœ°å€ |

### 6.3 DNSç¼“å­˜åˆ·æ–°


**æ¸…é™¤DNSç¼“å­˜**ï¼š
```bash
# CentOS/RHEL ç³»ç»Ÿ
systemctl restart systemd-resolved

# Ubuntu/Debian ç³»ç»Ÿ  
systemctl restart systemd-resolved

# ä¼ ç»Ÿç³»ç»Ÿæˆ–æ‰‹åŠ¨åˆ·æ–°
/etc/init.d/networking restart
```

**æµ‹è¯•åŸŸåè§£æ**ï¼š
```bash
# æµ‹è¯•åŸŸåè§£æç»“æœ
nslookup www.example.com
dig www.example.com

# è·Ÿè¸ªè§£æè¿‡ç¨‹
dig +trace www.example.com
```

### 6.4 è§£æä¼˜åŒ–å»ºè®®


**âš¡ æ€§èƒ½ä¼˜åŒ–**ï¼š
```bash
# å¸¸ç”¨å†…ç½‘æœåŠ¡æ”¾å…¥hostsæ–‡ä»¶ï¼Œé¿å…DNSæŸ¥è¯¢å»¶è¿Ÿ
192.168.1.10    jenkins.internal
192.168.1.11    gitlab.internal
192.168.1.12    nexus.internal

# é¢‘ç¹è®¿é—®çš„å¤–ç½‘æœåŠ¡ä¹Ÿå¯ä»¥æ·»åŠ 
8.8.8.8         dns.google
1.1.1.1         cloudflare-dns.com
```

**ğŸ›¡ï¸ å®‰å…¨è€ƒè™‘**ï¼š
- å®šæœŸå®¡æŸ¥hostsæ–‡ä»¶ï¼Œé˜²æ­¢æ¶æ„ç¯¡æ”¹
- å¯¹å…³é”®åŸŸåä½¿ç”¨DNS over HTTPSå¢å¼ºå®‰å…¨æ€§
- å¤‡ä»½åŸå§‹hostsæ–‡ä»¶

---

## 7. ğŸ”’ å®‰å…¨è€ƒè™‘ä¸æœ€ä½³å®è·µ


### 7.1 å®‰å…¨é£é™©è¯†åˆ«


**ğŸš¨ å¸¸è§å®‰å…¨é£é™©**ï¼š

**DNSåŠ«æŒé£é™©**ï¼š
```bash
# æ¶æ„è½¯ä»¶å¯èƒ½æ·»åŠ çš„æ¡ç›®
127.0.0.1       www.bank.com        # åŠ«æŒé“¶è¡Œç½‘ç«™åˆ°æœ¬åœ°
0.0.0.0         antivirus.com       # é˜»æ­¢è®¿é—®å®‰å…¨è½¯ä»¶å®˜ç½‘
192.168.1.99    update.os.com       # åŠ«æŒç³»ç»Ÿæ›´æ–°
```

**æƒé™å®‰å…¨**ï¼š
```bash
# æ£€æŸ¥æ–‡ä»¶æƒé™
ls -l /etc/hosts
# åº”è¯¥æ˜¾ç¤ºï¼š-rw-r--r-- 1 root root

# å¦‚æœæƒé™å¼‚å¸¸ï¼Œä¿®æ­£æƒé™
sudo chmod 644 /etc/hosts
sudo chown root:root /etc/hosts
```

### 7.2 å®‰å…¨é˜²æŠ¤æªæ–½


**ğŸ›¡ï¸ æ–‡ä»¶ä¿æŠ¤ç­–ç•¥**ï¼š

**è®¾ç½®æ–‡ä»¶ä¸å¯å˜å±æ€§**ï¼š
```bash
# è®¾ç½®ä¸å¯å˜å±æ€§(éœ€è¦rootæƒé™)
chattr +i /etc/hosts

# æŸ¥çœ‹å±æ€§
lsattr /etc/hosts
# è¾“å‡ºï¼š----i---------e----- /etc/hosts

# å–æ¶ˆä¸å¯å˜å±æ€§(ä¿®æ”¹æ—¶)
chattr -i /etc/hosts
```

**å®šæœŸå¤‡ä»½ä¸ç›‘æ§**ï¼š
```bash
# åˆ›å»ºhostsæ–‡ä»¶å¤‡ä»½
cp /etc/hosts /etc/hosts.backup.$(date +%Y%m%d)

# è®¾ç½®æ–‡ä»¶ç›‘æ§(ä½¿ç”¨inotify)
inotifywait -m /etc/hosts -e modify,delete,move
```

### 7.3 è®¿é—®æ§åˆ¶æœ€ä½³å®è·µ


**ğŸ“‹ å®‰å…¨æ£€æŸ¥æ¸…å•**ï¼š

```markdown
âœ… **æƒé™æ£€æŸ¥**
- [ ] æ–‡ä»¶æ‰€æœ‰è€…æ˜¯root
- [ ] æ–‡ä»¶æƒé™æ˜¯644
- [ ] ç›®å½•æƒé™æ­£ç¡®è®¾ç½®

âœ… **å†…å®¹å®¡æŸ¥** 
- [ ] æ²¡æœ‰å¯ç–‘çš„åŸŸåé‡å®šå‘
- [ ] æœ¬åœ°æœåŠ¡æ˜ å°„åˆç†
- [ ] æ³¨é‡Šè¯´æ˜å……åˆ†

âœ… **å˜æ›´ç®¡ç†**
- [ ] å˜æ›´å‰å¤‡ä»½æ–‡ä»¶
- [ ] è®°å½•å˜æ›´åŸå› å’Œæ—¶é—´
- [ ] æµ‹è¯•å˜æ›´æ•ˆæœ
```

### 7.4 åˆè§„æ€§è€ƒè™‘


**ä¼ä¸šç¯å¢ƒè§„èŒƒ**ï¼š
```bash
# æ ‡å‡†åŒ–çš„hostsæ–‡ä»¶å¤´éƒ¨
###############################

# Company: ABC Corporation
# System: Production Server 01
# Maintainer: IT Team
# Last Updated: 2024-09-18
# Purpose: Local DNS resolution
###############################


# ç³»ç»ŸåŸºç¡€æ˜ å°„
127.0.0.1       localhost localhost.localdomain

# ä¸šåŠ¡æœåŠ¡æ˜ å°„
192.168.10.100  app.company.internal
192.168.10.101  db.company.internal

# å˜æ›´è®°å½•
# 2024-09-18: Added new database server mapping
# 2024-09-15: Updated application server IP
```

---

## 8. ğŸ”§ æ•…éšœæ’æŸ¥ä¸è¯Šæ–­æ–¹æ³•


### 8.1 å¸¸è§é—®é¢˜è¯Šæ–­


**ğŸ” åŸŸåè§£æä¸å·¥ä½œ**

**è¯Šæ–­æ­¥éª¤**ï¼š
```bash
# 1. æ£€æŸ¥hostsæ–‡ä»¶è¯­æ³•
cat /etc/hosts | grep -v '^#' | grep -v '^$'

# 2. éªŒè¯IPåœ°å€æ ¼å¼
# æ£€æŸ¥æ˜¯å¦æœ‰æ— æ•ˆIPåœ°å€

# 3. æ£€æŸ¥æƒé™
ls -l /etc/hosts

# 4. æµ‹è¯•è§£æ
ping target-domain.com
nslookup target-domain.com
```

**è¯­æ³•é”™è¯¯æ’æŸ¥**ï¼š
```bash
# å¸¸è§è¯­æ³•é”™è¯¯æ£€æŸ¥è„šæœ¬
#!/bin/bash
while IFS= read -r line; do
    # è·³è¿‡æ³¨é‡Šå’Œç©ºè¡Œ
    [[ $line =~ ^#.*$ ]] && continue
    [[ -z $line ]] && continue
    
    # æ£€æŸ¥IPåœ°å€æ ¼å¼
    ip=$(echo $line | awk '{print $1}')
    if ! [[ $ip =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$ ]]; then
        echo "Invalid IP: $line"
    fi
done < /etc/hosts
```

### 8.2 è§£æå†²çªè°ƒè¯•


**ğŸ”„ è§£æè·¯å¾„è·Ÿè¸ª**ï¼š
```bash
# è¯¦ç»†è·Ÿè¸ªåŸŸåè§£æè¿‡ç¨‹
strace -e trace=openat ping -c 1 example.com 2>&1 | grep hosts

# ä½¿ç”¨digè·Ÿè¸ªå®Œæ•´è§£æè¿‡ç¨‹
dig +trace +additional example.com

# æŸ¥çœ‹ç³»ç»Ÿè§£æé…ç½®
cat /etc/nsswitch.conf | grep hosts
```

**è§£æç»“æœå¯¹æ¯”**ï¼š
```bash
# æŸ¥çœ‹hostsæ–‡ä»¶ä¸­çš„æ˜ å°„
grep example.com /etc/hosts

# æŸ¥çœ‹DNSæœåŠ¡å™¨è¿”å›ç»“æœ
nslookup example.com 8.8.8.8

# æŸ¥çœ‹ç³»ç»Ÿå®é™…ä½¿ç”¨çš„è§£æç»“æœ
getent hosts example.com
```

### 8.3 æ€§èƒ½é—®é¢˜æ’æŸ¥


**ğŸ“Š è§£ææ€§èƒ½æµ‹è¯•**ï¼š
```bash
# æµ‹è¯•hostsæ–‡ä»¶è§£æé€Ÿåº¦
time getent hosts localhost

# æµ‹è¯•DNSè§£æé€Ÿåº¦  
time nslookup google.com

# æ‰¹é‡æµ‹è¯•å¤šä¸ªåŸŸå
for domain in google.com baidu.com github.com; do
    echo "Testing $domain:"
    time nslookup $domain > /dev/null
    echo "---"
done
```

### 8.4 æ•…éšœæ¢å¤æ–¹æ¡ˆ


**ğŸš‘ å¿«é€Ÿæ¢å¤æ­¥éª¤**ï¼š

**å¤‡ä»½ä¸æ¢å¤**ï¼š
```bash
# ç´§æ€¥å¤‡ä»½å½“å‰é…ç½®
cp /etc/hosts /tmp/hosts.emergency.backup

# æ¢å¤åˆ°ç³»ç»Ÿé»˜è®¤é…ç½®
cp /etc/hosts.backup /etc/hosts

# æˆ–åˆ›å»ºæœ€å°åŒ–é…ç½®
cat > /etc/hosts << EOF
127.0.0.1   localhost localhost.localdomain
::1         localhost ip6-localhost ip6-loopback
EOF
```

**éªŒè¯æ¢å¤æ•ˆæœ**ï¼š
```bash
# æµ‹è¯•åŸºæœ¬è§£æåŠŸèƒ½
ping -c 1 localhost
ping -c 1 google.com

# æ£€æŸ¥å…³é”®ä¸šåŠ¡åŸŸå
nslookup your-business-domain.com
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ hostsæ–‡ä»¶æœ¬è´¨ï¼šæœ¬åœ°åŸŸååˆ°IPåœ°å€çš„é™æ€æ˜ å°„è¡¨
ğŸ”¸ å·¥ä½œåŸç†ï¼šåŸŸåè§£ææ—¶ä¼˜å…ˆæŸ¥è¯¢ï¼Œæ¯”DNSæœåŠ¡å™¨ä¼˜å…ˆçº§æ›´é«˜
ğŸ”¸ è¯­æ³•æ ¼å¼ï¼šIPåœ°å€ + ç©ºæ ¼/Tab + åŸŸå + å¯é€‰æ³¨é‡Š
ğŸ”¸ ä½ç½®æƒé™ï¼š/etc/hostsæ–‡ä»¶ï¼Œrootç”¨æˆ·æ‹¥æœ‰ï¼Œ644æƒé™
ğŸ”¸ å³æ—¶ç”Ÿæ•ˆï¼šä¿®æ”¹åç«‹å³ç”Ÿæ•ˆï¼Œæ— éœ€é‡å¯æœåŠ¡
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ è§£æä¼˜å…ˆçº§å…³ç³»**ï¼š
```
ç³»ç»ŸåŸŸåè§£æé¡ºåºï¼š
æœ¬åœ°ç¼“å­˜ â†’ hostsæ–‡ä»¶ â†’ DNSæœåŠ¡å™¨

hostsæ–‡ä»¶çš„ä½œç”¨ï¼š
â€¢ åŠ å¿«å¸¸ç”¨åŸŸåè§£æé€Ÿåº¦  
â€¢ å®ç°æœ¬åœ°å¼€å‘ç¯å¢ƒé…ç½®
â€¢ æä¾›DNSæ•…éšœæ—¶çš„å¤‡ç”¨è§£æ
â€¢ å®ç°ç®€å•çš„è®¿é—®æ§åˆ¶
```

**ğŸ”¹ å®é™…åº”ç”¨ä»·å€¼**ï¼š
```
å¼€å‘æµ‹è¯•ï¼šå°†ç”Ÿäº§åŸŸåæŒ‡å‘æœ¬åœ°å¼€å‘æœåŠ¡å™¨
è¿ç»´ç®¡ç†ï¼šå¿«é€Ÿåˆ‡æ¢æœåŠ¡å™¨è€Œæ— éœ€ç­‰å¾…DNSæ›´æ–°  
ç½‘ç»œä¼˜åŒ–ï¼šå‡å°‘å¸¸ç”¨åŸŸåçš„DNSæŸ¥è¯¢å»¶è¿Ÿ
å®‰å…¨é˜²æŠ¤ï¼šå±è”½æ¶æ„åŸŸåæˆ–é‡å®šå‘åˆ°èœœç½
```

**ğŸ”¹ ç®¡ç†ç»´æŠ¤è¦ç‚¹**ï¼š
```
è¯­æ³•è§„èŒƒï¼šä¸¥æ ¼æŒ‰ç…§"IP åŸŸå"æ ¼å¼ï¼Œæ³¨æ„åˆ†éš”ç¬¦
æƒé™æ§åˆ¶ï¼šç¡®ä¿åªæœ‰ç®¡ç†å‘˜å¯ä»¥ä¿®æ”¹
å®šæœŸå®¡æŸ¥ï¼šæ£€æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸æˆ–è¿‡æœŸçš„æ˜ å°„æ¡ç›®
å¤‡ä»½ç­–ç•¥ï¼šå˜æ›´å‰å¤‡ä»½ï¼Œæ”¯æŒå¿«é€Ÿå›æ»š
```

### 9.3 ç”Ÿäº§ç¯å¢ƒåº”ç”¨æŒ‡å—


**ğŸ’¼ ä¼ä¸šçº§ä½¿ç”¨å»ºè®®**ï¼š
- **æ ‡å‡†åŒ–æ ¼å¼**ï¼šç»Ÿä¸€æ³¨é‡Šè§„èŒƒï¼Œè®°å½•å˜æ›´å†å²
- **åˆ†ç±»ç®¡ç†**ï¼šæŒ‰åŠŸèƒ½åˆ†ç»„ï¼ˆç³»ç»ŸåŸºç¡€ã€å¼€å‘ç¯å¢ƒã€ç”Ÿäº§æœåŠ¡ï¼‰
- **å®‰å…¨å®¡è®¡**ï¼šå®šæœŸæ£€æŸ¥æ–‡ä»¶å®Œæ•´æ€§ï¼Œé˜²æ­¢æ¶æ„ç¯¡æ”¹
- **å˜æ›´æµç¨‹**ï¼šå»ºç«‹å˜æ›´å®¡æ‰¹æµç¨‹ï¼Œé¿å…è¯¯æ“ä½œ

**ğŸš€ æ€§èƒ½ä¼˜åŒ–æŠ€å·§**ï¼š
- **ç²¾ç®€æ¡ç›®**ï¼šåªä¿ç•™å¿…è¦çš„æ˜ å°„ï¼Œå®šæœŸæ¸…ç†æ— ç”¨æ¡ç›®
- **åˆç†åˆ†ç»„**ï¼šç›¸å…³æœåŠ¡æ”¾åœ¨ä¸€èµ·ï¼Œä¾¿äºæŸ¥æ‰¾å’Œç»´æŠ¤
- **å†…ç½‘ä¼˜åŒ–**ï¼šå†…ç½‘æœåŠ¡å™¨æ˜ å°„æ”¾å…¥hostsï¼Œå‡å°‘DNSæŸ¥è¯¢
- **ç¼“å­˜é…åˆ**ï¼šç»“åˆDNSç¼“å­˜ç­–ç•¥ï¼Œä¼˜åŒ–æ•´ä½“è§£ææ€§èƒ½

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- hostsæ–‡ä»¶åƒé€šè®¯å½•ï¼ŒåŸŸåç”µè¯ä¸€å¯¹ä¸€
- æœ¬åœ°è§£æä¼˜å…ˆçº§é«˜ï¼ŒDNSæœåŠ¡æ’åœ¨å  
- è¯­æ³•æ ¼å¼è¦è§„èŒƒï¼ŒIPåŸŸåç©ºæ ¼è¿
- æƒé™å®‰å…¨è¦é‡è§†ï¼Œå®šæœŸå¤‡ä»½ä¿å¹³å®‰