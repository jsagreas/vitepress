---
title: 3ã€resolv.conf DNSè§£æé…ç½®
---
## ğŸ“š ç›®å½•

1. [DNSè§£æåŸºç¡€æ¦‚å¿µ](#1-DNSè§£æåŸºç¡€æ¦‚å¿µ)
2. [resolv.confæ–‡ä»¶è¯¦è§£](#2-resolv.confæ–‡ä»¶è¯¦è§£)
3. [æ ¸å¿ƒé…ç½®æŒ‡ä»¤æ·±å…¥](#3-æ ¸å¿ƒé…ç½®æŒ‡ä»¤æ·±å…¥)
4. [é«˜çº§é€‰é¡¹é…ç½®](#4-é«˜çº§é€‰é¡¹é…ç½®)
5. [NetworkManagerç®¡ç†æœºåˆ¶](#5-NetworkManagerç®¡ç†æœºåˆ¶)
6. [å®ç”¨é…ç½®æ¡ˆä¾‹](#6-å®ç”¨é…ç½®æ¡ˆä¾‹)
7. [æ•…éšœè¯Šæ–­ä¸ä¼˜åŒ–](#7-æ•…éšœè¯Šæ–­ä¸ä¼˜åŒ–)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ DNSè§£æåŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯DNSè§£æ


**ğŸ” DNSçš„æœ¬è´¨**
DNSï¼ˆDomain Name Systemï¼‰å°±åƒäº’è”ç½‘çš„**ç”µè¯ç°¿**ï¼Œå®ƒå¸®æˆ‘ä»¬æŠŠå®¹æ˜“è®°ä½çš„åŸŸåï¼ˆå¦‚ `www.baidu.com`ï¼‰è½¬æ¢æˆè®¡ç®—æœºèƒ½ç†è§£çš„IPåœ°å€ï¼ˆå¦‚ `14.215.177.38`ï¼‰ã€‚

```
äººç±»ç†è§£çš„æ–¹å¼ï¼š
www.baidu.com â†’ å¥½è®°ï¼Œæœ‰æ„ä¹‰

è®¡ç®—æœºç†è§£çš„æ–¹å¼ï¼š
14.215.177.38 â†’ å®é™…çš„ç½‘ç»œåœ°å€
```

**ğŸ’¡ ç”Ÿæ´»ç±»æ¯”**
> å°±åƒä½ è¦ç»™æœ‹å‹å¯„ä¿¡ï¼Œä½ çŸ¥é“æœ‹å‹çš„å§“åï¼Œä½†é‚®é€’å‘˜éœ€è¦å…·ä½“åœ°å€ã€‚DNSå°±æ˜¯å¸®ä½ æŸ¥æ‰¾"é€šè®¯å½•"ï¼ŒæŠŠå§“åè½¬æ¢æˆåœ°å€çš„æœåŠ¡ã€‚

### 1.2 DNSè§£æè¿‡ç¨‹


**ğŸ“Š è§£ææµç¨‹å›¾ç¤º**
```
ç”¨æˆ·è¾“å…¥åŸŸå
      â†“
æ£€æŸ¥æœ¬åœ°hostsæ–‡ä»¶
      â†“
æŸ¥è¯¢æœ¬åœ°DNSç¼“å­˜
      â†“
å‘DNSæœåŠ¡å™¨æŸ¥è¯¢
      â†“
è¿”å›IPåœ°å€
      â†“
å»ºç«‹ç½‘ç»œè¿æ¥
```

**ğŸ”„ è¯¦ç»†è§£ææ­¥éª¤**

| æ­¥éª¤ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|------|------|--------|
| 1ï¸âƒ£ **æœ¬åœ°hosts** | æ£€æŸ¥ `/etc/hosts` æ–‡ä»¶ | â­â­â­â­â­ |
| 2ï¸âƒ£ **æœ¬åœ°ç¼“å­˜** | æŸ¥çœ‹ç³»ç»ŸDNSç¼“å­˜ | â­â­â­â­ |
| 3ï¸âƒ£ **DNSæœåŠ¡å™¨** | å‘é…ç½®çš„DNSæœåŠ¡å™¨æŸ¥è¯¢ | â­â­â­ |
| 4ï¸âƒ£ **é€’å½’æŸ¥è¯¢** | DNSæœåŠ¡å™¨å‘ä¸Šçº§æŸ¥è¯¢ | â­â­ |

### 1.3 resolv.confçš„ä½œç”¨


**ğŸ¯ æ ¸å¿ƒåŠŸèƒ½**
`/etc/resolv.conf` æ˜¯Linuxç³»ç»Ÿçš„**DNSé…ç½®ä¸­å¿ƒ**ï¼Œå®ƒå‘Šè¯‰ç³»ç»Ÿï¼š
- å»å“ªé‡ŒæŸ¥è¯¢åŸŸåï¼ˆDNSæœåŠ¡å™¨ï¼‰
- æ€ä¹ˆæŸ¥è¯¢ï¼ˆæŸ¥è¯¢é€‰é¡¹ï¼‰
- æŸ¥è¯¢è¶…æ—¶å’Œé‡è¯•ç­–ç•¥

**ğŸ“ é‡è¦æ€§**
- âœ… **ç½‘ç»œè¿æ¥åŸºç¡€**ï¼šæ²¡æœ‰æ­£ç¡®çš„DNSé…ç½®ï¼Œæ— æ³•è®¿é—®ç½‘ç«™
- âœ… **æ€§èƒ½å½±å“**ï¼šDNSé…ç½®å½±å“ç½‘ç»œè®¿é—®é€Ÿåº¦
- âœ… **å®‰å…¨è€ƒé‡**ï¼šDNSæœåŠ¡å™¨é€‰æ‹©å…³ç³»åˆ°ç½‘ç»œå®‰å…¨

---

## 2. ğŸ“‹ resolv.confæ–‡ä»¶è¯¦è§£


### 2.1 æ–‡ä»¶ä½ç½®ä¸æƒé™


**ğŸ“ æ–‡ä»¶åŸºæœ¬ä¿¡æ¯**
```bash
æ–‡ä»¶è·¯å¾„ï¼š/etc/resolv.conf
é»˜è®¤æƒé™ï¼š644 (rw-r--r--)
æ‰€æœ‰è€…ï¼šroot:root
æ–‡ä»¶ç±»å‹ï¼šçº¯æ–‡æœ¬é…ç½®æ–‡ä»¶
```

**ğŸ”§ æ–‡ä»¶æ“ä½œ**
```bash
# æŸ¥çœ‹å½“å‰é…ç½®
cat /etc/resolv.conf

# ç¼–è¾‘é…ç½®ï¼ˆéœ€è¦rootæƒé™ï¼‰
sudo nano /etc/resolv.conf

# å¤‡ä»½åŸé…ç½®
sudo cp /etc/resolv.conf /etc/resolv.conf.backup
```

### 2.2 æ–‡ä»¶ç»“æ„è§£æ


**ğŸ“„ æ ‡å‡†æ–‡ä»¶ç»“æ„**
```bash
# DNSæœåŠ¡å™¨é…ç½®
nameserver 8.8.8.8
nameserver 8.8.4.4

# æœç´¢åŸŸé…ç½®  
search example.com local.domain

# é»˜è®¤åŸŸå
domain company.com

# é«˜çº§é€‰é¡¹
options timeout:2 attempts:3 rotate
```

**ğŸ” æ–‡ä»¶æ ¼å¼è§„åˆ™**
- **è¡Œæ³¨é‡Š**ï¼šä»¥ `#` å¼€å¤´çš„è¡Œä¸ºæ³¨é‡Š
- **ç©ºè¡Œå¿½ç•¥**ï¼šç©ºè¡Œä¼šè¢«è‡ªåŠ¨å¿½ç•¥
- **é¡ºåºé‡è¦**ï¼šæŸäº›é…ç½®çš„é¡ºåºä¼šå½±å“è§£æè¡Œä¸º
- **å¤§å°å†™æ•æ„Ÿ**ï¼šé…ç½®æŒ‡ä»¤åŒºåˆ†å¤§å°å†™

### 2.3 é…ç½®ç”Ÿæ•ˆæœºåˆ¶


**âš¡ å®æ—¶ç”Ÿæ•ˆ**
ä¿®æ”¹ `resolv.conf` å**ç«‹å³ç”Ÿæ•ˆ**ï¼Œæ— éœ€é‡å¯æœåŠ¡æˆ–ç³»ç»Ÿã€‚

**ğŸ”„ éªŒè¯æ–¹æ³•**
```bash
# æµ‹è¯•DNSè§£æ
nslookup www.baidu.com

# è¯¦ç»†è§£æä¿¡æ¯
dig www.baidu.com

# è¿½è¸ªè§£æè·¯å¾„
dig +trace www.baidu.com
```

---

## 3. ğŸ¯ æ ¸å¿ƒé…ç½®æŒ‡ä»¤æ·±å…¥


### 3.1 nameserver - DNSæœåŠ¡å™¨é…ç½®


**ğŸ”¸ åŸºæœ¬è¯­æ³•**
```bash
nameserver IPåœ°å€
```

**ğŸ’¡ è¯¦ç»†è¯´æ˜**
`nameserver` æŒ‡å®šDNSæœåŠ¡å™¨çš„IPåœ°å€ï¼Œç³»ç»Ÿä¼šæŒ‰ç…§é…ç½®é¡ºåºä¾æ¬¡æŸ¥è¯¢ã€‚

**ğŸ“Š é…ç½®è§„åˆ™**

| è§„åˆ™ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **æœ€å¤š3ä¸ª** | ç³»ç»Ÿæœ€å¤šè¯†åˆ«å‰3ä¸ªnameserver | `nameserver 8.8.8.8` |
| **é¡ºåºæŸ¥è¯¢** | æŒ‰é…ç½®é¡ºåºä¾æ¬¡æŸ¥è¯¢ | é¦–é€‰â†’å¤‡é€‰â†’å¤‡é€‰ |
| **IPv4/IPv6** | æ”¯æŒIPv4å’ŒIPv6åœ°å€ | `nameserver 2001:4860:4860::8888` |
| **æœ¬åœ°ä¼˜å…ˆ** | æœ¬åœ°DNSæœåŠ¡å™¨å“åº”æ›´å¿« | `nameserver 192.168.1.1` |

**ğŸŒŸ å¸¸ç”¨DNSæœåŠ¡å™¨**
```bash
# Google DNSï¼ˆç¨³å®šå¯é ï¼‰
nameserver 8.8.8.8
nameserver 8.8.4.4

# Cloudflare DNSï¼ˆé€Ÿåº¦å¿«ï¼‰  
nameserver 1.1.1.1
nameserver 1.0.0.1

# å›½å†…DNSï¼ˆè®¿é—®å›½å†…ç½‘ç«™æ›´å¿«ï¼‰
nameserver 114.114.114.114
nameserver 223.5.5.5

# æœ¬åœ°è·¯ç”±å™¨DNS
nameserver 192.168.1.1
```

### 3.2 search - æœç´¢åŸŸé…ç½®


**ğŸ”¸ åŸºæœ¬è¯­æ³•**
```bash
search åŸŸå1 åŸŸå2 åŸŸå3
```

**ğŸ’¡ å·¥ä½œåŸç†**
å½“ä½ è¾“å…¥**ä¸å®Œæ•´çš„åŸŸå**æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ·»åŠ æœç´¢åŸŸè¿›è¡ŒæŸ¥è¯¢ã€‚

**ğŸ  ç”Ÿæ´»ç±»æ¯”**
> å°±åƒä½ åœ¨å…¬å¸å†…éƒ¨ï¼Œè¯´"æ‰¾å°ç‹"ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç†è§£ä¸º"æ‰¾æŠ€æœ¯éƒ¨çš„å°ç‹"ã€"æ‰¾é”€å”®éƒ¨çš„å°ç‹"ç­‰ã€‚

**ğŸ“ˆ å®é™…åº”ç”¨ç¤ºä¾‹**
```bash
# é…ç½®æœç´¢åŸŸ
search company.com local.domain

# å½“ä½ è¾“å…¥ï¼šping server1
# ç³»ç»Ÿå®é™…æŸ¥è¯¢ï¼š
# 1. server1.company.com
# 2. server1.local.domain
# 3. server1ï¼ˆå¦‚æœå‰é¢éƒ½å¤±è´¥ï¼‰
```

**âš ï¸ é‡è¦é™åˆ¶**
- **æœ€å¤š6ä¸ªåŸŸ**ï¼šsearchæŒ‡ä»¤æœ€å¤šæ”¯æŒ6ä¸ªæœç´¢åŸŸ
- **æ€»é•¿åº¦é™åˆ¶**ï¼šæ‰€æœ‰åŸŸåæ€»é•¿åº¦ä¸è¶…è¿‡256å­—ç¬¦
- **è¦†ç›–domain**ï¼šsearchä¼šè¦†ç›–domainè®¾ç½®

### 3.3 domain - é»˜è®¤åŸŸåè®¾ç½®


**ğŸ”¸ åŸºæœ¬è¯­æ³•**
```bash
domain åŸŸå
```

**ğŸ’¡ åŠŸèƒ½è¯´æ˜**
è®¾ç½®ç³»ç»Ÿçš„é»˜è®¤åŸŸåï¼Œä¸»è¦ç”¨äºä¸»æœºåè§£æã€‚

**ğŸ”„ domain vs search å¯¹æ¯”**

| ç‰¹æ€§ | domain | search |
|------|--------|---------|
| **æ•°é‡** | åªèƒ½è®¾ç½®1ä¸ª | æœ€å¤š6ä¸ª |
| **ç”¨é€”** | ç³»ç»Ÿé»˜è®¤åŸŸ | åŸŸåæœç´¢åˆ—è¡¨ |
| **ä¼˜å…ˆçº§** | è¢«searchè¦†ç›– | ä¼˜å…ˆçº§æ›´é«˜ |
| **é€‚ç”¨åœºæ™¯** | å•åŸŸç¯å¢ƒ | å¤šåŸŸç¯å¢ƒ |

**ğŸ“ ä½¿ç”¨å»ºè®®**
```bash
# å•ä¸€åŸŸç¯å¢ƒ
domain company.com

# å¤šåŸŸç¯å¢ƒï¼ˆæ¨èï¼‰
search company.com partner.com local
```

---

## 4. ğŸ”§ é«˜çº§é€‰é¡¹é…ç½®


### 4.1 optionsæŒ‡ä»¤è¯¦è§£


**ğŸ”¸ åŸºæœ¬è¯­æ³•**
```bash
options é€‰é¡¹1:å€¼1 é€‰é¡¹2:å€¼2 é€‰é¡¹3
```

**âš™ï¸ æ ¸å¿ƒé€‰é¡¹è¯´æ˜**

#### ğŸ• timeout - æŸ¥è¯¢è¶…æ—¶è®¾ç½®


```bash
options timeout:5
```

**è¯´æ˜**ï¼šè®¾ç½®DNSæŸ¥è¯¢è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
- **é»˜è®¤å€¼**ï¼š5ç§’
- **æ¨èå€¼**ï¼š2-10ç§’
- **å½±å“**ï¼šè¶…æ—¶æ—¶é—´è¿‡çŸ­å¯èƒ½å¯¼è‡´æŸ¥è¯¢å¤±è´¥ï¼Œè¿‡é•¿å½±å“ç”¨æˆ·ä½“éªŒ

#### ğŸ”„ attempts - é‡è¯•æ¬¡æ•°è®¾ç½®


```bash
options attempts:3
```

**è¯´æ˜**ï¼šè®¾ç½®DNSæŸ¥è¯¢å¤±è´¥åçš„é‡è¯•æ¬¡æ•°
- **é»˜è®¤å€¼**ï¼š2æ¬¡
- **æ¨èå€¼**ï¼š2-5æ¬¡
- **æ³¨æ„**ï¼šè¿‡å¤šé‡è¯•ä¼šå»¶é•¿è§£ææ—¶é—´

#### ğŸ² rotate - è½®è¯¢DNSæœåŠ¡å™¨


```bash
options rotate
```

**è¯´æ˜**ï¼šå¯ç”¨DNSæœåŠ¡å™¨è½®è¯¢ï¼Œé¿å…æ‰€æœ‰æŸ¥è¯¢éƒ½é›†ä¸­åœ¨ç¬¬ä¸€ä¸ªDNSæœåŠ¡å™¨
- **ä¼˜åŠ¿**ï¼šè´Ÿè½½å‡è¡¡ï¼Œæé«˜å¯ç”¨æ€§
- **é€‚ç”¨**ï¼šé…ç½®å¤šä¸ªDNSæœåŠ¡å™¨æ—¶

### 4.2 æ€§èƒ½ä¼˜åŒ–é€‰é¡¹


**âš¡ ä¼˜åŒ–é…ç½®ç¤ºä¾‹**
```bash
# å¿«é€Ÿå“åº”é…ç½®
options timeout:2 attempts:2 rotate

# é«˜å¯é æ€§é…ç½®  
options timeout:5 attempts:5

# å¹³è¡¡é…ç½®ï¼ˆæ¨èï¼‰
options timeout:3 attempts:3 rotate
```

**ğŸ“Š é€‰é¡¹ç»„åˆæ•ˆæœ**

| é…ç½®ç±»å‹ | timeout | attempts | rotate | é€‚ç”¨åœºæ™¯ |
|----------|---------|----------|--------|----------|
| **å¿«é€Ÿå“åº”** | 2ç§’ | 2æ¬¡ | âœ… | ç½‘ç»œç¯å¢ƒå¥½ |
| **é«˜å¯é ** | 5ç§’ | 5æ¬¡ | âŒ | ç½‘ç»œä¸ç¨³å®š |
| **å¹³è¡¡** | 3ç§’ | 3æ¬¡ | âœ… | å¤§å¤šæ•°ç¯å¢ƒ |

### 4.3 å…¶ä»–å®ç”¨é€‰é¡¹


**ğŸ” è°ƒè¯•é€‰é¡¹**
```bash
# å¯ç”¨è°ƒè¯•æ¨¡å¼
options debug

# ä½¿ç”¨TCPæŸ¥è¯¢ï¼ˆé»˜è®¤UDPï¼‰
options use-vc
```

**ğŸ›¡ï¸ å®‰å…¨é€‰é¡¹**
```bash
# å¯ç”¨DNSSECéªŒè¯
options edns0

# ç¦ç”¨IPv6æŸ¥è¯¢ï¼ˆå¦‚æœç½‘ç»œä¸æ”¯æŒï¼‰
options single-request
```

---

## 5. ğŸ›ï¸ NetworkManagerç®¡ç†æœºåˆ¶


### 5.1 NetworkManagerä¸resolv.confå…³ç³»


**ğŸ”„ ç®¡ç†æ¨¡å¼**
ç°ä»£Linuxå‘è¡Œç‰ˆé€šå¸¸ä½¿ç”¨NetworkManageræ¥**è‡ªåŠ¨ç®¡ç†**DNSé…ç½®ï¼Œè¿™æ„å‘³ç€ï¼š

```
ä¼ ç»Ÿæ–¹å¼ï¼šæ‰‹åŠ¨ç¼–è¾‘ /etc/resolv.conf
ç°ä»£æ–¹å¼ï¼šNetworkManagerè‡ªåŠ¨ç”Ÿæˆ /etc/resolv.conf
```

**âš ï¸ é‡è¦è­¦å‘Š**
å½“NetworkManagerç®¡ç†DNSæ—¶ï¼Œæ‰‹åŠ¨ä¿®æ”¹ `/etc/resolv.conf` çš„æ›´æ”¹å¯èƒ½ä¼šè¢«**è‡ªåŠ¨è¦†ç›–**ï¼

### 5.2 æ£€æŸ¥ç®¡ç†çŠ¶æ€


**ğŸ” åˆ¤æ–­æ˜¯å¦è¢«NetworkManagerç®¡ç†**
```bash
# æ–¹æ³•1ï¼šæŸ¥çœ‹æ–‡ä»¶å¤´éƒ¨æ³¨é‡Š
head /etc/resolv.conf

# å¦‚æœçœ‹åˆ°ç±»ä¼¼å†…å®¹ï¼Œè¯´æ˜è¢«NetworkManagerç®¡ç†ï¼š
# Generated by NetworkManager
```

**ğŸ“ å¸¸è§æ ‡è¯†**
```bash
# Generated by NetworkManager
# This file is managed by systemd-resolved
# ATTENTION: This file is managed by netplan
```

### 5.3 NetworkManager DNSé…ç½®


**ğŸ› ï¸ é…ç½®NetworkManager DNS**

#### æ–¹æ³•1ï¼šå›¾å½¢ç•Œé¢é…ç½®

```
ç³»ç»Ÿè®¾ç½® â†’ ç½‘ç»œ â†’ æœ‰çº¿/æ— çº¿è®¾ç½® â†’ DNSæœåŠ¡å™¨
```

#### æ–¹æ³•2ï¼šå‘½ä»¤è¡Œé…ç½®

```bash
# æŸ¥çœ‹è¿æ¥é…ç½®
nmcli connection show

# è®¾ç½®DNSæœåŠ¡å™¨
sudo nmcli connection modify "è¿æ¥å" ipv4.dns "8.8.8.8,8.8.4.4"

# è®¾ç½®æœç´¢åŸŸ
sudo nmcli connection modify "è¿æ¥å" ipv4.dns-search "company.com"

# åº”ç”¨é…ç½®
sudo nmcli connection up "è¿æ¥å"
```

#### æ–¹æ³•3ï¼šé…ç½®æ–‡ä»¶æ–¹å¼

```bash
# ç¼–è¾‘è¿æ¥é…ç½®æ–‡ä»¶
sudo nano /etc/NetworkManager/system-connections/è¿æ¥å.nmconnection

# æ·»åŠ DNSé…ç½®
[ipv4]
dns=8.8.8.8;8.8.4.4;
dns-search=company.com;local;

# é‡æ–°åŠ è½½é…ç½®
sudo systemctl reload NetworkManager
```

### 5.4 ç¦ç”¨NetworkManager DNSç®¡ç†


**ğŸš« å¦‚éœ€æ‰‹åŠ¨ç®¡ç†DNS**
```bash
# ç¼–è¾‘NetworkManagerä¸»é…ç½®
sudo nano /etc/NetworkManager/NetworkManager.conf

# æ·»åŠ ä»¥ä¸‹é…ç½®
[main]
dns=none

# é‡å¯NetworkManager
sudo systemctl restart NetworkManager
```

**ğŸ’¡ é…ç½®è¯´æ˜**
- `dns=none`ï¼šç¦ç”¨NetworkManagerçš„DNSç®¡ç†
- ç¦ç”¨åå¯ä»¥æ‰‹åŠ¨ç¼–è¾‘ `/etc/resolv.conf`
- éœ€è¦é‡å¯NetworkManageræœåŠ¡ç”Ÿæ•ˆ

---

## 6. ğŸ’¼ å®ç”¨é…ç½®æ¡ˆä¾‹


### 6.1 å®¶åº­ç½‘ç»œé…ç½®


**ğŸ  å…¸å‹å®¶åº­ç¯å¢ƒ**
```bash
# ä¼˜å…ˆä½¿ç”¨è·¯ç”±å™¨DNSï¼Œå¤‡ç”¨å…¬å…±DNS
nameserver 192.168.1.1
nameserver 8.8.8.8
nameserver 1.1.1.1

# æœ¬åœ°åŸŸåæœç´¢
search local

# å¿«é€Ÿå“åº”é…ç½®
options timeout:2 attempts:2 rotate
```

**ğŸ“‹ é…ç½®è§£é‡Š**
- **è·¯ç”±å™¨DNS**ï¼šé€šå¸¸æœ€å¿«ï¼Œäº†è§£æœ¬åœ°ç½‘ç»œ
- **å…¬å…±DNS**ï¼šå¤‡ç”¨é€‰é¡¹ï¼Œç¡®ä¿å¯ç”¨æ€§
- **localåŸŸ**ï¼šä¾¿äºè®¿é—®æœ¬åœ°è®¾å¤‡

### 6.2 ä¼ä¸šç½‘ç»œé…ç½®


**ğŸ¢ ä¼ä¸šå†…ç½‘ç¯å¢ƒ**
```bash
# ä¼ä¸šå†…ç½‘DNSæœåŠ¡å™¨
nameserver 10.0.1.10
nameserver 10.0.1.11

# ä¼ä¸šåŸŸåæœç´¢
search company.com internal.company.com

# ç¨³å®šæ€§ä¼˜å…ˆé…ç½®
options timeout:5 attempts:3
```

**ğŸ¯ ä¼ä¸šé…ç½®ç‰¹ç‚¹**
- **å†…ç½‘DNS**ï¼šè§£æå†…éƒ¨æœåŠ¡å™¨å’Œèµ„æº
- **å¤šçº§åŸŸå**ï¼šæ”¯æŒå¤æ‚çš„ä¼ä¸šåŸŸåç»“æ„
- **ç¨³å®šæ€§**ï¼šè¶…æ—¶æ—¶é—´è¾ƒé•¿ï¼Œç¡®ä¿è§£ææˆåŠŸ

### 6.3 å¼€å‘ç¯å¢ƒé…ç½®


**ğŸ’» å¼€å‘è€…ä¸“ç”¨é…ç½®**
```bash
# å¿«é€Ÿå…¬å…±DNS
nameserver 1.1.1.1
nameserver 8.8.8.8

# å¼€å‘åŸŸå
search dev.local test.local localhost

# è°ƒè¯•å‹å¥½é…ç½®
options timeout:1 attempts:1 debug
```

**âš¡ å¼€å‘é…ç½®ä¼˜åŠ¿**
- **å¿«é€ŸDNS**ï¼šå‡å°‘ç­‰å¾…æ—¶é—´
- **å¼€å‘åŸŸå**ï¼šä¾¿äºæµ‹è¯•ç¯å¢ƒè®¿é—®
- **è°ƒè¯•æ¨¡å¼**ï¼šä¾¿äºé—®é¢˜æ’æŸ¥

### 6.4 æœåŠ¡å™¨ç”Ÿäº§ç¯å¢ƒ


**ğŸ›¡ï¸ ç”Ÿäº§æœåŠ¡å™¨é…ç½®**
```bash
# é«˜å¯ç”¨DNSé…ç½®
nameserver 8.8.8.8
nameserver 1.1.1.1  
nameserver 114.114.114.114

# ç”Ÿäº§åŸŸå
search production.com

# é«˜å¯é æ€§é…ç½®
options timeout:10 attempts:5 rotate
```

**ğŸ”’ ç”Ÿäº§ç¯å¢ƒç‰¹ç‚¹**
- **å¤šDNSæœåŠ¡å™¨**ï¼šç¡®ä¿é«˜å¯ç”¨æ€§
- **é•¿è¶…æ—¶æ—¶é—´**ï¼šé¿å…å¶å‘ç½‘ç»œé—®é¢˜
- **è½®è¯¢æœºåˆ¶**ï¼šè´Ÿè½½å‡è¡¡

---

## 7. ğŸ”§ æ•…éšœè¯Šæ–­ä¸ä¼˜åŒ–


### 7.1 å¸¸è§DNSé—®é¢˜


**ğŸš¨ é—®é¢˜æ¸…å•**

| é—®é¢˜ç±»å‹ | ç—‡çŠ¶ | å¸¸è§åŸå›  |
|----------|------|----------|
| **æ— æ³•è§£æåŸŸå** | `ping: cannot resolve hostname` | DNSæœåŠ¡å™¨ä¸å¯è¾¾ |
| **è§£æç¼“æ…¢** | è®¿é—®ç½‘ç«™å“åº”æ…¢ | DNSå“åº”æ—¶é—´é•¿ |
| **éƒ¨åˆ†åŸŸåæ— æ³•è®¿é—®** | æŸäº›ç½‘ç«™æ‰“ä¸å¼€ | DNSæ±¡æŸ“æˆ–å±è”½ |
| **é…ç½®è¢«è¦†ç›–** | æ‰‹åŠ¨ä¿®æ”¹æ— æ•ˆ | NetworkManagerç®¡ç† |

### 7.2 è¯Šæ–­å‘½ä»¤è¯¦è§£


**ğŸ” åŸºç¡€è¯Šæ–­**
```bash
# 1. æ£€æŸ¥å½“å‰DNSé…ç½®
cat /etc/resolv.conf

# 2. æµ‹è¯•DNSè§£æ
nslookup www.baidu.com

# 3. è¯¦ç»†æŸ¥è¯¢ä¿¡æ¯  
dig www.baidu.com

# 4. æµ‹è¯•ç‰¹å®šDNSæœåŠ¡å™¨
nslookup www.baidu.com 8.8.8.8
```

**ğŸ“Š é«˜çº§è¯Šæ–­**
```bash
# è¿½è¸ªå®Œæ•´è§£æè·¯å¾„
dig +trace www.baidu.com

# æµ‹è¯•åå‘è§£æ
dig -x 8.8.8.8

# æŸ¥çœ‹DNSç¼“å­˜
systemd-resolve --status

# æ¸…ç©ºDNSç¼“å­˜
sudo systemd-resolve --flush-caches
```

### 7.3 æ€§èƒ½æµ‹è¯•ä¸ä¼˜åŒ–


**â±ï¸ DNSå“åº”æ—¶é—´æµ‹è¯•**
```bash
# æµ‹è¯•ä¸åŒDNSæœåŠ¡å™¨å“åº”æ—¶é—´
for dns in 8.8.8.8 1.1.1.1 114.114.114.114; do
    echo "Testing $dns:"
    dig @$dns www.baidu.com | grep "Query time"
done
```

**ğŸ“ˆ ä¼˜åŒ–å»ºè®®**

#### ğŸš€ é€Ÿåº¦ä¼˜åŒ–

- **é€‰æ‹©å¿«é€ŸDNS**ï¼šä½¿ç”¨1.1.1.1, 8.8.8.8ç­‰å¿«é€ŸDNS
- **ç¼©çŸ­è¶…æ—¶**ï¼š`timeout:2`é€‚åˆç¨³å®šç½‘ç»œ
- **å‡å°‘é‡è¯•**ï¼š`attempts:2`é¿å…è¿‡å¤šç­‰å¾…
- **å¯ç”¨è½®è¯¢**ï¼š`rotate`å¹³è¡¡è´Ÿè½½

#### ğŸ›¡ï¸ å¯é æ€§ä¼˜åŒ–  

- **é…ç½®å¤šDNS**ï¼šè‡³å°‘2-3ä¸ªå¤‡ç”¨DNSæœåŠ¡å™¨
- **å»¶é•¿è¶…æ—¶**ï¼š`timeout:5`é€‚åˆä¸ç¨³å®šç½‘ç»œ
- **å¢åŠ é‡è¯•**ï¼š`attempts:3`æé«˜æˆåŠŸç‡
- **æ··åˆDNS**ï¼šæœ¬åœ°+å…¬å…±DNSç»„åˆ

### 7.4 æ•…éšœæ’é™¤æ­¥éª¤


**ğŸ”§ æ ‡å‡†æ’éšœæµç¨‹**

#### æ­¥éª¤1ï¼šåŸºç¡€æ£€æŸ¥

```bash
# æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
ping 8.8.8.8

# æ£€æŸ¥DNSé…ç½®
cat /etc/resolv.conf
```

#### æ­¥éª¤2ï¼šDNSæœåŠ¡å™¨æµ‹è¯•

```bash
# æµ‹è¯•æ¯ä¸ªé…ç½®çš„DNSæœåŠ¡å™¨
nslookup www.baidu.com 8.8.8.8
nslookup www.baidu.com 1.1.1.1
```

#### æ­¥éª¤3ï¼šç¼“å­˜æ¸…ç†

```bash
# æ¸…ç©ºç³»ç»ŸDNSç¼“å­˜
sudo systemd-resolve --flush-caches

# é‡å¯ç½‘ç»œæœåŠ¡
sudo systemctl restart systemd-resolved
```

#### æ­¥éª¤4ï¼šé…ç½®ä¿®å¤

```bash
# å¦‚æœæ˜¯NetworkManageré—®é¢˜
sudo systemctl restart NetworkManager

# æ‰‹åŠ¨é…ç½®å¤‡ç”¨DNS
echo "nameserver 8.8.8.8" | sudo tee /etc/resolv.conf
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ DNSè§£æåŸç†ï¼šåŸŸåâ†’IPåœ°å€çš„è½¬æ¢è¿‡ç¨‹
ğŸ”¸ resolv.confä½œç”¨ï¼šLinuxç³»ç»ŸDNSé…ç½®ä¸­å¿ƒ
ğŸ”¸ é…ç½®æŒ‡ä»¤å«ä¹‰ï¼šnameserverã€searchã€domainã€options
ğŸ”¸ NetworkManagerç®¡ç†ï¼šç°ä»£ç³»ç»Ÿçš„è‡ªåŠ¨DNSç®¡ç†
ğŸ”¸ æ•…éšœè¯Šæ–­æ–¹æ³•ï¼šåŸºæœ¬å‘½ä»¤å’Œæ’æŸ¥æ€è·¯
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ resolv.confçš„æ ¸å¿ƒä»·å€¼**
- **ç½‘ç»œåŸºç¡€**ï¼šæ²¡æœ‰DNSå°±æ— æ³•æ­£å¸¸è®¿é—®ç½‘ç»œ
- **æ€§èƒ½å½±å“**ï¼šDNSé…ç½®ç›´æ¥å½±å“ç½‘ç»œå“åº”é€Ÿåº¦  
- **å®‰å…¨é‡è¦**ï¼šDNSæœåŠ¡å™¨é€‰æ‹©å…³ç³»ç½‘ç»œå®‰å…¨

**ğŸ”¹ é…ç½®ä¼˜åŒ–åŸåˆ™**
- **é€Ÿåº¦ä¸ç¨³å®šæ€§å¹³è¡¡**ï¼šå¿«é€ŸDNS + é€‚å½“è¶…æ—¶é‡è¯•
- **å¤šDNSå¤‡ä»½**ï¼šè‡³å°‘é…ç½®2-3ä¸ªDNSæœåŠ¡å™¨
- **ç¯å¢ƒé€‚é…**ï¼šæ ¹æ®ç½‘ç»œç¯å¢ƒé€‰æ‹©åˆé€‚é…ç½®

**ğŸ”¹ ç°ä»£ç®¡ç†æ–¹å¼**
- **è‡ªåŠ¨åŒ–ç®¡ç†**ï¼šå¤§å¤šæ•°æƒ…å†µä¸‹ç”¨NetworkManager
- **æ‰‹åŠ¨é…ç½®**ï¼šç‰¹æ®Šéœ€æ±‚æ—¶ç¦ç”¨è‡ªåŠ¨ç®¡ç†
- **é…ç½®æŒä¹…åŒ–**ï¼šé€šè¿‡æ­£ç¡®æ–¹å¼ç¡®ä¿é…ç½®ç”Ÿæ•ˆ

### 8.3 å®ç”¨æ“ä½œæŠ€èƒ½


**ğŸ¯ æ—¥å¸¸æ“ä½œ**
- æŸ¥çœ‹DNSé…ç½®ï¼š`cat /etc/resolv.conf`
- æµ‹è¯•DNSè§£æï¼š`nslookup åŸŸå`
- è¯¦ç»†è§£æä¿¡æ¯ï¼š`dig åŸŸå`
- æ¸…ç©ºDNSç¼“å­˜ï¼š`sudo systemd-resolve --flush-caches`

**ğŸ”§ é…ç½®ç®¡ç†**
- æ£€æŸ¥ç®¡ç†æ–¹å¼ï¼šæŸ¥çœ‹æ–‡ä»¶å¤´éƒ¨æ³¨é‡Š
- NetworkManageré…ç½®ï¼šä½¿ç”¨`nmcli`å‘½ä»¤
- æ‰‹åŠ¨é…ç½®ï¼šç¦ç”¨NetworkManager DNSç®¡ç†
- é…ç½®éªŒè¯ï¼šä½¿ç”¨è¯Šæ–­å‘½ä»¤éªŒè¯

**ğŸš¨ æ•…éšœå¤„ç†**  
- ç½‘ç»œè¿é€šæ€§ï¼š`ping IPåœ°å€`
- DNSæœåŠ¡å™¨æµ‹è¯•ï¼š`nslookup åŸŸå DNSæœåŠ¡å™¨IP`
- æœåŠ¡é‡å¯ï¼š`systemctl restart systemd-resolved`
- åº”æ€¥é…ç½®ï¼šæ‰‹åŠ¨è®¾ç½®å¯ç”¨DNS

### 8.4 æœ€ä½³å®è·µå»ºè®®


**âœ… æ¨èåšæ³•**
```bash
# å®¶åº­ç½‘ç»œæ¨èé…ç½®
nameserver 192.168.1.1
nameserver 8.8.8.8
nameserver 1.1.1.1
search local
options timeout:2 attempts:2 rotate

# ä¼ä¸šç½‘ç»œæ¨èé…ç½®  
nameserver å†…ç½‘DNS
nameserver 8.8.8.8
nameserver 1.1.1.1
search company.com
options timeout:3 attempts:3

# æœåŠ¡å™¨æ¨èé…ç½®
nameserver 8.8.8.8
nameserver 1.1.1.1
nameserver 114.114.114.114
options timeout:5 attempts:3 rotate
```

**âŒ é¿å…è¯¯åŒº**
- ä¸è¦åªé…ç½®ä¸€ä¸ªDNSæœåŠ¡å™¨
- ä¸è¦è®¾ç½®è¿‡çŸ­çš„è¶…æ—¶æ—¶é—´ï¼ˆ<1ç§’ï¼‰
- ä¸è¦å¿½ç•¥NetworkManagerçš„å½±å“
- ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ä¸å¯é çš„DNS

### 8.5 æ‰©å±•å­¦ä¹ æ–¹å‘


**ğŸ“š æ·±å…¥å­¦ä¹ **
- **BINDé…ç½®**ï¼šæ­å»ºè‡ªå·±çš„DNSæœåŠ¡å™¨
- **DNSå®‰å…¨**ï¼šäº†è§£DNSåŠ«æŒå’Œé˜²æŠ¤
- **IPv6 DNS**ï¼šæŒæ¡IPv6ç¯å¢ƒä¸‹çš„DNSé…ç½®
- **æ™ºèƒ½DNS**ï¼šäº†è§£GeoDNSå’Œè´Ÿè½½å‡è¡¡

**ğŸ”— ç›¸å…³æŠ€æœ¯**
- **ç½‘ç»œè¯Šæ–­**ï¼šæŒæ¡æ›´å¤šç½‘ç»œæ’æŸ¥å·¥å…·
- **ç³»ç»ŸæœåŠ¡**ï¼šæ·±å…¥ç†è§£systemd-resolved
- **ç½‘ç»œç®¡ç†**ï¼šå­¦ä¹ æ›´å¤šNetworkManageråŠŸèƒ½
- **å®‰å…¨åŠ å›º**ï¼šDNS over HTTPS (DoH) é…ç½®

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- *nameserveræŒ‡è·¯æ ‡ï¼ŒsearchåŸŸåå·§æ­é…*
- *optionsè°ƒæ€§èƒ½ï¼ŒNetworkManagerè¦æ³¨æ„*  
- *è¯Šæ–­ç”¨digæŸ¥ï¼Œæ•…éšœstep by step*
- *DNSæ˜¯åŸºç¡€ï¼Œé…ç½®è¦åˆç†*