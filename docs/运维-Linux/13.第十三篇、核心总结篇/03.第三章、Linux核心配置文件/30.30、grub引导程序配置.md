---
title: 30、grub引导程序配置
---
## 📚 目录

1. [GRUB引导程序基础概念](#1-GRUB引导程序基础概念)
2. [GRUB配置文件体系](#2-GRUB配置文件体系)
3. [主配置文件详解](#3-主配置文件详解)
4. [核心配置参数解析](#4-核心配置参数解析)
5. [安全配置与密码保护](#5-安全配置与密码保护)
6. [配置更新与故障恢复](#6-配置更新与故障恢复)
7. [实战配置示例](#7-实战配置示例)
8. [核心要点总结](#8-核心要点总结)

---

## 1. 🚀 GRUB引导程序基础概念


### 1.1 什么是GRUB引导程序


**GRUB（GRand Unified Bootloader）**：Linux系统的引导加载程序，简单理解就是**开机时帮你选择和启动操作系统的程序**。

```
开机启动流程：
BIOS/UEFI → GRUB引导程序 → Linux内核 → 系统启动

作用类比：
GRUB就像是一个"系统管家"，开机时：
1. 显示启动菜单让你选择系统
2. 加载你选择的操作系统
3. 传递启动参数给系统内核
```

**🔸 为什么需要GRUB？**
- **多系统管理**：一台电脑装了多个操作系统时，选择启动哪个
- **内核选择**：Linux有多个内核版本时，选择用哪个启动  
- **参数传递**：向内核传递启动时需要的参数
- **故障恢复**：系统出问题时提供恢复模式

### 1.2 GRUB版本说明


目前主流使用**GRUB 2**（也叫GRUB2），相比老版本GRUB Legacy有重大改进：

| 特性对比 | **GRUB Legacy** | **GRUB 2** |
|---------|----------------|------------|
| 🔧 **配置方式** | 直接编辑配置文件 | 通过模板生成配置 |
| 🎛️ **功能** | 基础引导功能 | 模块化、可扩展 |
| 💾 **文件系统支持** | 有限 | 支持多种文件系统 |
| 🔒 **安全性** | 较弱 | 支持密码保护、加密 |

### 1.3 GRUB工作原理图解


```
系统启动时GRUB的工作流程：

开机
 ↓
BIOS/UEFI检测硬件
 ↓
读取硬盘MBR/GPT分区表
 ↓
加载GRUB Stage 1（引导代码）
 ↓
加载GRUB Stage 2（主程序）
 ↓
读取/boot/grub2/grub.cfg配置文件
 ↓
显示启动菜单
 ↓ [用户选择或超时]
加载对应的Linux内核
 ↓
启动操作系统
```

---

## 2. 📁 GRUB配置文件体系


### 2.1 配置文件层级关系


GRUB的配置采用**模板生成**的方式，理解这个层级关系很重要：

```
GRUB配置文件体系：

📄 /etc/default/grub                 ← 主配置模板（用户编辑）
📁 /etc/grub.d/                      ← 配置脚本目录
   ├── 00_header                     ← 生成文件头
   ├── 10_linux                      ← 扫描Linux内核
   ├── 20_linux_xen                  ← Xen虚拟化支持
   ├── 30_os-prober                  ← 检测其他操作系统
   └── 40_custom                     ← 自定义启动项
         ↓ [执行 grub2-mkconfig 命令]
📄 /boot/grub2/grub.cfg              ← 最终生成的配置文件（不要直接编辑！）
```

> **💡 重要提醒**：永远不要直接编辑`/boot/grub2/grub.cfg`文件！这个文件是自动生成的，手动修改会在下次更新时被覆盖。

### 2.2 配置文件详细说明


**主配置模板 - `/etc/default/grub`**
- **作用**：存放GRUB的全局配置参数
- **特点**：人类可读的简单键值对格式
- **编辑**：这是唯一应该手动编辑的GRUB配置文件

**配置脚本目录 - `/etc/grub.d/`**
- **作用**：包含生成最终配置文件的脚本
- **特点**：按数字顺序执行，数字越小优先级越高
- **用途**：自动检测系统信息并生成对应配置

**最终配置文件 - `/boot/grub2/grub.cfg`**
- **作用**：GRUB启动时实际读取的配置文件
- **特点**：复杂的脚本格式，包含完整的启动逻辑
- **生成**：通过`grub2-mkconfig`命令自动生成

### 2.3 配置更新工作流程


```
GRUB配置更新的完整流程：

1. 编辑主配置文件
   vi /etc/default/grub

2. 执行配置生成命令
   grub2-mkconfig -o /boot/grub2/grub.cfg
   
3. 系统读取脚本目录
   /etc/grub.d/* 按顺序执行
   
4. 结合主配置参数
   应用 /etc/default/grub 中的设置
   
5. 生成最终配置
   输出到 /boot/grub2/grub.cfg
   
6. 重启生效
   下次开机时使用新配置
```

---

## 3. ⚙️ 主配置文件详解


### 3.1 `/etc/default/grub`文件结构


这个文件采用简单的**shell变量**格式，每行定义一个配置参数：

```bash
# GRUB主配置文件示例
GRUB_TIMEOUT=5                    # 启动等待时间
GRUB_DEFAULT=0                    # 默认启动项
GRUB_DISTRIBUTOR="CentOS"         # 发行版名称
GRUB_CMDLINE_LINUX="rhgb quiet"   # 内核启动参数
GRUB_DISABLE_RECOVERY="false"     # 是否禁用恢复模式
```

### 3.2 文件内容详细解析


让我们来看一个完整的配置文件例子：

```bash
# =================== 基本启动配置 ===================
GRUB_TIMEOUT=5
# 含义：启动菜单显示5秒后自动启动默认项
# 设置：0=立即启动，-1=永远等待用户选择

GRUB_DISTRIBUTOR="$(sed 's, release .*$,,g' /etc/system-release)"
# 含义：从系统发行版文件中自动获取系统名称
# 显示：在启动菜单中显示为"CentOS Linux"等

GRUB_DEFAULT=saved
# 含义：使用上次启动的系统作为默认项
# 其他选项：0=第一个选项，1=第二个选项，"kernel-name"=指定内核

# =================== 内核启动参数 ===================
GRUB_CMDLINE_LINUX="crashkernel=auto rhgb quiet"
# 含义：传递给Linux内核的启动参数
# crashkernel=auto：自动配置内核崩溃转储空间
# rhgb：显示图形化启动画面
# quiet：减少启动时的详细信息输出

# =================== 功能控制配置 ===================
GRUB_DISABLE_SUBMENU=true
# 含义：禁用子菜单，所有启动项显示在同一级别
# 效果：避免菜单层级过深，操作更简单

GRUB_DISABLE_RECOVERY="false"
# 含义：是否禁用恢复模式启动项
# false：显示恢复模式选项
# true：隐藏恢复模式选项
```

### 3.3 各配置参数的实际影响


**启动等待时间的影响：**
```
GRUB_TIMEOUT=5    → 显示菜单5秒，然后自动启动
GRUB_TIMEOUT=0    → 不显示菜单，直接启动默认系统  
GRUB_TIMEOUT=-1   → 一直显示菜单，等待用户选择
```

**默认启动项的选择：**
```
GRUB_DEFAULT=0        → 第一个启动项（通常是最新内核）
GRUB_DEFAULT=1        → 第二个启动项
GRUB_DEFAULT=saved    → 记住上次的选择
GRUB_DEFAULT="3.10.0-957.el7.x86_64"  → 指定具体内核版本
```

---

## 4. 🔧 核心配置参数解析


### 4.1 GRUB_TIMEOUT - 启动等待时间配置


**参数作用**：控制GRUB菜单显示多长时间后自动启动默认系统

**配置语法**：`GRUB_TIMEOUT=数字`

| 设置值 | **含义** | **适用场景** |
|-------|---------|-------------|
| `5` | 等待5秒后自动启动 | 🏠 **个人桌面**：给用户选择时间但不会等太久 |
| `0` | 立即启动，不显示菜单 | 🖥️ **服务器**：快速启动，减少无人值守时间 |
| `-1` | 永远等待用户选择 | 🔧 **调试环境**：需要手动选择不同内核测试 |
| `30` | 等待30秒 | 🏢 **企业环境**：给管理员足够时间进行选择 |

**实际应用示例：**
```bash
# 服务器环境 - 快速启动
GRUB_TIMEOUT=0

# 个人电脑 - 平衡设置  
GRUB_TIMEOUT=5

# 开发环境 - 需要经常选择
GRUB_TIMEOUT=15
```

### 4.2 GRUB_DEFAULT - 默认启动项配置


**参数作用**：设置开机时默认启动哪个系统或内核版本

**配置方式详解：**

```bash
# 方式1：按序号选择（从0开始计数）
GRUB_DEFAULT=0          # 启动菜单中的第1项
GRUB_DEFAULT=1          # 启动菜单中的第2项

# 方式2：记住上次选择  
GRUB_DEFAULT=saved      # 使用上次启动的选项

# 方式3：指定具体内核版本
GRUB_DEFAULT="3.10.0-957.21.3.el7.x86_64"

# 方式4：按菜单项名称选择
GRUB_DEFAULT="CentOS Linux (3.10.0-957.el7.x86_64) 7 (Core)"
```

**💡 如何查看当前可选择的启动项：**
```bash
# 方法1：查看当前启动菜单项
awk -F\' '/menuentry / {print $2}' /boot/grub2/grub.cfg

# 方法2：查看已安装的内核版本
ls /boot/vmlinuz-* | sed 's/\/boot\/vmlinuz-//'
```

### 4.3 GRUB_CMDLINE_LINUX - 内核参数配置


**参数作用**：设置传递给Linux内核的启动参数，影响系统启动行为

**常用内核参数解释：**

```bash
GRUB_CMDLINE_LINUX="crashkernel=auto rhgb quiet net.ifnames=0"
```

| 参数 | **含义** | **作用说明** |
|-----|---------|-------------|
| `crashkernel=auto` | 自动配置崩溃转储 | 系统崩溃时自动保存内存信息用于分析 |
| `rhgb` | 图形化启动画面 | 显示美观的启动进度条而非文字信息 |
| `quiet` | 静默启动 | 隐藏详细的启动日志，只显示重要信息 |
| `net.ifnames=0` | 使用传统网卡命名 | 网卡名称为eth0、eth1而非ens33等 |
| `selinux=0` | 禁用SELinux | 关闭SELinux安全增强功能 |
| `init=/bin/bash` | 指定init程序 | 紧急情况下直接启动到bash shell |

**实际应用场景：**

```bash
# 生产服务器配置 - 注重稳定性和日志
GRUB_CMDLINE_LINUX="crashkernel=auto quiet"

# 开发环境配置 - 便于调试
GRUB_CMDLINE_LINUX="crashkernel=auto net.ifnames=0"  

# 故障恢复配置 - 最小化启动
GRUB_CMDLINE_LINUX="single init=/bin/bash"

# 性能优化配置 - 禁用不必要功能
GRUB_CMDLINE_LINUX="crashkernel=auto quiet selinux=0 audit=0"
```

### 4.4 其他重要配置参数


**GRUB_DISABLE_RECOVERY**
```bash
GRUB_DISABLE_RECOVERY="false"   # 显示恢复模式选项
GRUB_DISABLE_RECOVERY="true"    # 隐藏恢复模式选项
```
- **恢复模式**：系统出现问题时，可以启动到单用户模式进行修复
- **建议**：个人电脑保持为"false"，服务器可设置为"true"

**GRUB_DISABLE_SUBMENU**
```bash
GRUB_DISABLE_SUBMENU=true       # 所有选项显示在一级菜单
GRUB_DISABLE_SUBMENU=false      # 使用子菜单分类显示
```

**GRUB_SAVEDEFAULT**
```bash
GRUB_SAVEDEFAULT=true          # 自动记住最后选择的启动项
```
- 配合`GRUB_DEFAULT=saved`使用
- 让系统"学习"用户的启动习惯

---

## 5. 🔒 安全配置与密码保护


### 5.1 为什么需要GRUB密码保护


**安全风险分析：**
- **物理访问威胁**：任何能接触电脑的人都可以通过GRUB菜单进入系统
- **单用户模式风险**：可以无密码启动到root权限的单用户模式
- **内核参数篡改**：可以修改启动参数绕过某些安全限制

**适用场景：**
- 🏢 **企业服务器**：防止未授权人员物理接触时获取系统访问权
- 🖥️ **公共电脑**：学校、图书馆等场所的公用电脑
- 💼 **重要数据主机**：存储敏感信息的系统

### 5.2 设置GRUB密码保护


**步骤1：生成加密密码**

```bash
# 使用grub2-mkpasswd-pbkdf2命令生成加密密码
[root@server ~]# grub2-mkpasswd-pbkdf2
Enter password: ********        # 输入密码（不显示）
Reenter password: ********      # 确认密码
Your PBKDF2 is: grub.pbkdf2.sha512.10000.9AC39B1FD9D65...（很长的加密字符串）
```

**步骤2：配置密码文件**

创建用户和密码配置：
```bash
# 编辑或创建密码配置文件
vi /etc/grub.d/01_users

#!/bin/sh
cat <<EOF
set superusers="admin"
password_pbkdf2 admin grub.pbkdf2.sha512.10000.9AC39B1FD9D65...
EOF
```

**步骤3：设置文件权限和更新配置**

```bash
# 设置文件权限（重要！）
chmod 755 /etc/grub.d/01_users

# 更新GRUB配置
grub2-mkconfig -o /boot/grub2/grub.cfg
```

### 5.3 密码保护级别配置


**完全保护模式**：所有操作都需要密码
```bash
# 在/etc/grub.d/01_users中设置
set superusers="admin"
password_pbkdf2 admin [加密密码字符串]
```

**部分保护模式**：正常启动不需要密码，但编辑启动项需要密码
```bash
# 在启动项配置中添加--users参数
menuentry 'CentOS Linux' --users admin {
    # 启动配置...
}

# 不受保护的启动项（无--users参数）
menuentry 'CentOS Linux (Normal Boot)' {
    # 启动配置...
}
```

### 5.4 密码保护最佳实践


**🔸 密码策略建议：**
- 使用强密码（至少12位，包含大小写字母、数字、特殊字符）
- 定期更换GRUB密码
- 不要使用与系统用户相同的密码

**🔸 权限管理：**
```bash
# 确保配置文件权限正确
chmod 600 /etc/grub.d/01_users      # 只有root可以读写
chown root:root /etc/grub.d/01_users # 文件属主为root
```

**🔸 紧急访问预案：**
- 准备系统恢复光盘或U盘
- 记录密码重置的应急步骤
- 建立多种身份验证方式

---

## 6. 🔄 配置更新与故障恢复


### 6.1 GRUB配置更新命令


**主要更新命令：**

```bash
# RHEL/CentOS系统
grub2-mkconfig -o /boot/grub2/grub.cfg

# Debian/Ubuntu系统  
update-grub

# 手动指定配置文件位置
grub2-mkconfig -o /boot/efi/EFI/centos/grub.cfg  # UEFI系统
```

**更新过程详解：**
```
执行更新命令后的处理流程：

1. 读取主配置文件
   /etc/default/grub

2. 执行配置脚本
   /etc/grub.d/* （按数字顺序）
   
3. 检测系统信息
   - 扫描已安装的内核
   - 检测其他操作系统
   - 获取硬件信息
   
4. 生成最终配置
   输出完整的grub.cfg文件
   
5. 验证配置语法
   确保生成的配置文件正确
```

### 6.2 配置验证与检查


**更新前的准备检查：**
```bash
# 1. 备份当前配置
cp /boot/grub2/grub.cfg /boot/grub2/grub.cfg.backup.$(date +%Y%m%d)

# 2. 检查主配置文件语法
grep -v '^#' /etc/default/grub | grep -v '^$'

# 3. 验证内核文件存在
ls -la /boot/vmlinuz-*

# 4. 检查磁盘空间
df -h /boot
```

**更新后的验证检查：**
```bash
# 1. 检查生成的配置文件
head -20 /boot/grub2/grub.cfg

# 2. 验证菜单项数量
grep "^menuentry" /boot/grub2/grub.cfg | wc -l

# 3. 检查默认启动项设置
grep "set default" /boot/grub2/grub.cfg

# 4. 模拟启动测试（如果有虚拟化环境）
```

### 6.3 常见故障及恢复方法


**故障1：GRUB配置文件损坏**

**现象**：开机后出现"grub>"提示符，无法正常启动

**恢复方法：**
```bash
# 在grub>提示符下手动启动
grub> ls                                    # 列出分区
grub> set root=(hd0,msdos1)                # 设置根分区  
grub> linux /vmlinuz-3.10.0-957.el7.x86_64 root=/dev/sda1
grub> initrd /initramfs-3.10.0-957.el7.x86_64.img
grub> boot                                  # 启动系统

# 系统启动后重新生成配置
grub2-mkconfig -o /boot/grub2/grub.cfg
```

**故障2：默认启动项设置错误**

**现象**：系统总是启动到错误的内核版本

**解决方法：**
```bash
# 查看当前默认启动项
grub2-editenv list

# 设置新的默认启动项
grub2-set-default 0                        # 设置第一个为默认

# 或者编辑配置文件
vi /etc/default/grub
GRUB_DEFAULT=0

# 更新配置
grub2-mkconfig -o /boot/grub2/grub.cfg
```

**故障3：GRUB完全损坏**

**现象**：开机显示"Operating System not found"或类似错误

**恢复步骤：**
```bash
# 1. 使用安装光盘或救援模式启动

# 2. 挂载系统分区
mount /dev/sda1 /mnt
mount /dev/sda2 /mnt/boot          # 如果/boot是单独分区

# 3. 进入chroot环境  
chroot /mnt

# 4. 重新安装GRUB
grub2-install /dev/sda

# 5. 重新生成配置文件
grub2-mkconfig -o /boot/grub2/grub.cfg
```

### 6.4 故障预防措施


**🔸 定期备份：**
```bash
# 创建自动备份脚本
cat > /usr/local/bin/grub-backup.sh << 'EOF'
#!/bin/bash
BACKUP_DIR="/root/grub-backups"
DATE=$(date +%Y%m%d-%H%M%S)

mkdir -p $BACKUP_DIR
cp /boot/grub2/grub.cfg $BACKUP_DIR/grub.cfg.$DATE
cp /etc/default/grub $BACKUP_DIR/grub.default.$DATE

# 保留最新的10个备份
ls -t $BACKUP_DIR/grub.cfg.* | tail -n +11 | xargs rm -f
ls -t $BACKUP_DIR/grub.default.* | tail -n +11 | xargs rm -f
EOF

chmod +x /usr/local/bin/grub-backup.sh
```

**🔸 配置监控：**
```bash
# 添加到crontab，每周备份一次
echo "0 2 * * 0 /usr/local/bin/grub-backup.sh" | crontab -
```

---

## 7. 💡 实战配置示例


### 7.1 个人桌面电脑配置


**需求场景**：个人使用的Linux桌面，偶尔需要选择不同内核版本进行测试

```bash
# /etc/default/grub 配置示例
GRUB_TIMEOUT=10                           # 给足时间选择
GRUB_DEFAULT=saved                        # 记住上次选择
GRUB_DISTRIBUTOR="Fedora"                 
GRUB_CMDLINE_LINUX="rhgb quiet"          # 美观的启动画面
GRUB_DISABLE_SUBMENU=true                # 简化菜单结构
GRUB_DISABLE_RECOVERY="false"            # 保留恢复模式
GRUB_SAVEDEFAULT=true                    # 自动保存选择
```

**配置说明：**
- ⏰ **较长等待时间**：给用户充分的选择时间
- 🧠 **智能记忆**：系统记住用户的使用习惯
- 🎨 **用户友好**：美观的启动界面和简单的菜单

### 7.2 生产服务器配置


**需求场景**：生产环境服务器，要求快速启动，高度稳定

```bash
# /etc/default/grub 配置示例
GRUB_TIMEOUT=3                            # 快速启动
GRUB_DEFAULT=0                           # 固定启动最新内核
GRUB_DISTRIBUTOR="CentOS"
GRUB_CMDLINE_LINUX="crashkernel=auto quiet audit=0"  # 性能优化
GRUB_DISABLE_SUBMENU=true
GRUB_DISABLE_RECOVERY="true"             # 隐藏恢复模式
GRUB_TERMINAL_OUTPUT="console"           # 控制台输出
```

**安全加固配置：**
```bash
# 设置GRUB密码保护
cat > /etc/grub.d/01_users << 'EOF'
#!/bin/sh
cat <<EOFM
set superusers="admin"
password_pbkdf2 admin grub.pbkdf2.sha512.10000.A1B2C3D4E5...
EOFM
EOF

chmod 755 /etc/grub.d/01_users
```

### 7.3 开发测试环境配置


**需求场景**：开发环境，需要频繁切换不同内核版本，便于调试

```bash
# /etc/default/grub 配置示例  
GRUB_TIMEOUT=15                          # 充足的选择时间
GRUB_DEFAULT=saved                       # 记住开发者选择
GRUB_DISTRIBUTOR="Dev-Linux"
GRUB_CMDLINE_LINUX="net.ifnames=0 selinux=0"  # 简化网络配置
GRUB_DISABLE_SUBMENU=false               # 显示详细菜单
GRUB_DISABLE_RECOVERY="false"            # 保留所有选项
GRUB_SAVEDEFAULT=true
```

**添加自定义启动项：**
```bash
# /etc/grub.d/40_custom 添加调试选项
cat >> /etc/grub.d/40_custom << 'EOF'
menuentry "Debug Mode - Verbose Boot" {
    set root='hd0,msdos1'
    linux /vmlinuz-$(uname -r) root=/dev/sda1 debug verbose
    initrd /initramfs-$(uname -r).img
}

menuentry "Safe Mode - Minimal Drivers" {
    set root='hd0,msdos1'  
    linux /vmlinuz-$(uname -r) root=/dev/sda1 nomodeset
    initrd /initramfs-$(uname -r).img
}
EOF
```

### 7.4 双系统配置


**需求场景**：一台电脑安装了Linux和Windows双系统

```bash
# /etc/default/grub 配置示例
GRUB_TIMEOUT=10                          # 给用户选择时间
GRUB_DEFAULT=0                          # 默认启动Linux
GRUB_DISTRIBUTOR="Ubuntu"
GRUB_CMDLINE_LINUX="quiet splash"       # 美观启动
GRUB_DISABLE_OS_PROBER=false            # 启用其他系统检测
```

**验证Windows检测：**
```bash
# 安装os-prober（如果未安装）
yum install os-prober    # CentOS/RHEL
apt install os-prober    # Ubuntu/Debian

# 手动检测其他操作系统
os-prober

# 更新GRUB配置以包含Windows
grub2-mkconfig -o /boot/grub2/grub.cfg
```

---

## 8. 📋 核心要点总结


### 8.1 必须掌握的核心概念


```
🔸 GRUB作用：Linux系统的引导加载程序，负责启动选择和内核加载
🔸 配置体系：模板文件(/etc/default/grub) → 生成脚本(/etc/grub.d/) → 最终配置(/boot/grub2/grub.cfg)
🔸 更新流程：编辑模板 → 执行grub2-mkconfig → 重启生效
🔸 核心参数：TIMEOUT(等待时间)、DEFAULT(默认启动项)、CMDLINE_LINUX(内核参数)
🔸 安全保护：密码设置、权限控制、备份恢复
```

### 8.2 关键理解要点


**🔹 为什么不能直接编辑grub.cfg**
```
原因：
- 这是自动生成的文件，手动修改会被覆盖
- 文件语法复杂，容易出错导致系统无法启动
- 正确方式是编辑模板文件然后重新生成

记忆要点：
grub.cfg = 只读的最终产品
/etc/default/grub = 可编辑的配置模板
```

**🔹 内核参数的实际作用**
```
常用参数含义：
- quiet：隐藏详细启动信息，让启动过程更简洁
- rhgb：显示图形化启动画面而不是文字滚动
- crashkernel=auto：系统崩溃时自动保存内存信息
- net.ifnames=0：使用传统的网卡命名(eth0)而不是新式命名(ens33)
```

**🔹 安全配置的重要性**
```
风险场景：
- 物理接触电脑的人可以通过GRUB进入单用户模式
- 单用户模式具有root权限，可以修改系统

防护措施：
- 设置GRUB密码保护
- 禁用不必要的启动选项
- 定期备份配置文件
```

### 8.3 实践操作要点


**🔧 配置修改的安全步骤**
```
1. 备份当前配置：cp /boot/grub2/grub.cfg /root/grub.cfg.backup
2. 编辑模板文件：vi /etc/default/grub  
3. 验证语法正确：检查配置参数格式
4. 生成新配置：grub2-mkconfig -o /boot/grub2/grub.cfg
5. 验证结果：检查生成的配置文件
6. 测试启动：重启验证配置生效
```

**🚨 故障恢复准备**
```
必备技能：
- 记住手动启动命令：grub> linux /vmlinuz... root=...
- 准备启动U盘或光盘作为应急工具
- 了解chroot恢复环境的使用方法
- 定期备份重要配置文件
```

**⚡ 性能优化建议**
```
服务器环境：
- 设置较短的TIMEOUT值(0-3秒)
- 禁用不需要的恢复模式
- 优化内核参数减少启动时间

开发环境：  
- 设置较长的TIMEOUT值(10-15秒)
- 启用详细的启动选项
- 添加调试和测试相关的内核参数
```

### 8.4 常用命令速查


| 操作目的 | **命令** | **说明** |
|---------|---------|---------|
| 🔧 **更新配置** | `grub2-mkconfig -o /boot/grub2/grub.cfg` | 生成新的GRUB配置文件 |
| 🔍 **查看启动项** | `awk -F\' '/menuentry / {print $2}' /boot/grub2/grub.cfg` | 列出所有可用的启动项 |
| ⚙️ **设置默认项** | `grub2-set-default 0` | 设置第一个启动项为默认 |
| 🔑 **生成密码** | `grub2-mkpasswd-pbkdf2` | 生成GRUB密码保护的加密字符串 |
| 💾 **备份配置** | `cp /boot/grub2/grub.cfg /root/grub.cfg.$(date +%Y%m%d)` | 备份当前配置文件 |

**核心记忆口诀**：
- GRUB管启动，模板生配置
- 编辑default文件，mkconfig来更新  
- 超时默认内核参，安全备份不可少
- 故障恢复有预案，手动启动能救急