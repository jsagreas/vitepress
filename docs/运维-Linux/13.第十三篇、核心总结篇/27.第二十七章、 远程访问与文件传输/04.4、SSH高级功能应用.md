---
title: 4ã€SSHé«˜çº§åŠŸèƒ½åº”ç”¨
---
## ğŸ“š ç›®å½•

1. [SSHéš§é“ä¸ç«¯å£è½¬å‘](#1-SSHéš§é“ä¸ç«¯å£è½¬å‘)
2. [ProxyJumpè·³æ¿æœºé…ç½®](#2-ProxyJumpè·³æ¿æœºé…ç½®)
3. [SSHä»£ç†è½¬å‘æœºåˆ¶](#3-SSHä»£ç†è½¬å‘æœºåˆ¶)
4. [SSHé…ç½®æ–‡ä»¶é«˜çº§è¯­æ³•](#4-SSHé…ç½®æ–‡ä»¶é«˜çº§è¯­æ³•)
5. [å¤šä¸»æœºæ‰¹é‡è¿æ¥ç®¡ç†](#5-å¤šä¸»æœºæ‰¹é‡è¿æ¥ç®¡ç†)
6. [SSHè¿æ¥å¤ç”¨æŠ€æœ¯](#6-SSHè¿æ¥å¤ç”¨æŠ€æœ¯)
7. [X11è½¬å‘ä¸å›¾å½¢åº”ç”¨](#7-X11è½¬å‘ä¸å›¾å½¢åº”ç”¨)
8. [SSHè½¬ä¹‰åºåˆ—åº”ç”¨](#8-SSHè½¬ä¹‰åºåˆ—åº”ç”¨)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”— SSHéš§é“ä¸ç«¯å£è½¬å‘


### 1.1 ä»€ä¹ˆæ˜¯SSHéš§é“


**ğŸ”¸ æ ¸å¿ƒæ¦‚å¿µ**
SSHéš§é“å°±åƒåœ¨ç½‘ç»œä¸­æŒ–äº†ä¸€æ¡"åœ°ä¸‹é€šé“"ï¼Œè®©æ•°æ®å¯ä»¥é€šè¿‡åŠ å¯†çš„SSHè¿æ¥å®‰å…¨ä¼ è¾“ã€‚ç®€å•ç†è§£å°±æ˜¯ï¼š**å€Ÿç”¨SSHè¿æ¥æ¥ä¼ è¾“å…¶ä»–æœåŠ¡çš„æ•°æ®**ã€‚

```
æ™®é€šè¿æ¥ï¼š    å®¢æˆ·ç«¯ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”> æœåŠ¡å™¨
                   æ˜æ–‡ä¼ è¾“ï¼Œä¸å®‰å…¨

SSHéš§é“ï¼š     å®¢æˆ·ç«¯ â€”â€”[SSHåŠ å¯†é€šé“]â€”â€”> è·³æ¿æœº â€”â€”> ç›®æ ‡æœåŠ¡å™¨
                   åŠ å¯†ä¼ è¾“ï¼Œç»•è¿‡é˜²ç«å¢™
```

**ğŸ¯ SSHéš§é“çš„ä½œç”¨**
- **å®‰å…¨æ€§**ï¼šæ•°æ®åœ¨ä¸å®‰å…¨çš„ç½‘ç»œä¸­åŠ å¯†ä¼ è¾“
- **ç»•è¿‡é™åˆ¶**ï¼šçªç ´é˜²ç«å¢™å’Œç½‘ç»œå°é”
- **è®¿é—®å†…ç½‘**ï¼šé€šè¿‡è·³æ¿æœºè®¿é—®å†…ç½‘æœåŠ¡

### 1.2 æœ¬åœ°ç«¯å£è½¬å‘ï¼ˆLocal Forwardï¼‰


**ğŸ’¡ å·¥ä½œåŸç†**
æŠŠæœ¬åœ°è®¡ç®—æœºçš„æŸä¸ªç«¯å£ï¼Œé€šè¿‡SSHè¿æ¥è½¬å‘åˆ°è¿œç¨‹æœåŠ¡å™¨çš„æŸä¸ªç«¯å£ã€‚å°±åƒåœ¨æœ¬åœ°å¼€äº†ä¸€æ‰‡"ä¼ é€é—¨"ï¼Œèµ°è¿›å»å°±åˆ°äº†è¿œç¨‹æœåŠ¡å™¨ã€‚

```
æœ¬åœ°è½¬å‘ç¤ºæ„å›¾ï¼š

æœ¬åœ°è®¡ç®—æœº          SSHæœåŠ¡å™¨         ç›®æ ‡æœåŠ¡å™¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åº”ç”¨ç¨‹åº â”‚        â”‚         â”‚       â”‚  æ•°æ®åº“  â”‚
â”‚    â†“    â”‚        â”‚         â”‚       â”‚ :3306   â”‚
â”‚ :8080   â”‚------->â”‚ SSHéš§é“ â”‚------>â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”§ åŸºæœ¬è¯­æ³•**
```bash
# æ ¼å¼ï¼šssh -L æœ¬åœ°ç«¯å£:ç›®æ ‡ä¸»æœº:ç›®æ ‡ç«¯å£ SSHæœåŠ¡å™¨
ssh -L 8080:localhost:80 user@server.com

# å®é™…æ¡ˆä¾‹ï¼šè®¿é—®è¿œç¨‹æ•°æ®åº“
ssh -L 3306:database.internal:3306 user@jumphost.com
```

**ğŸ“‹ å®ç”¨åœºæ™¯ç¤ºä¾‹**

```bash
# åœºæ™¯1ï¼šè®¿é—®è¿œç¨‹å†…ç½‘æ•°æ®åº“
ssh -L 3306:192.168.1.100:3306 user@jumphost.com
# ç°åœ¨è¿æ¥localhost:3306å°±ç­‰äºè¿æ¥192.168.1.100:3306

# åœºæ™¯2ï¼šè®¿é—®è¿œç¨‹Webç®¡ç†ç•Œé¢
ssh -L 8080:internal-server:80 user@gateway.com
# æµè§ˆå™¨è®¿é—®http://localhost:8080å°±èƒ½çœ‹åˆ°å†…ç½‘Webç•Œé¢

# åœºæ™¯3ï¼šåŠ å¯†ä¸å®‰å…¨çš„åè®®
ssh -L 2525:mail.server.com:25 user@secure-server.com
# æŠŠä¸åŠ å¯†çš„SMTPå˜æˆåŠ å¯†ä¼ è¾“
```

### 1.3 è¿œç¨‹ç«¯å£è½¬å‘ï¼ˆRemote Forwardï¼‰


**ğŸ’¡ å·¥ä½œåŸç†**
ä¸æœ¬åœ°è½¬å‘ç›¸åï¼ŒæŠŠè¿œç¨‹æœåŠ¡å™¨çš„ç«¯å£è½¬å‘åˆ°æœ¬åœ°ã€‚è®©è¿œç¨‹æœåŠ¡å™¨èƒ½å¤Ÿè®¿é—®æœ¬åœ°çš„æœåŠ¡ï¼Œå¸¸ç”¨äºå†…ç½‘ç©¿é€ã€‚

```
è¿œç¨‹è½¬å‘ç¤ºæ„å›¾ï¼š

æœ¬åœ°è®¡ç®—æœº          SSHæœåŠ¡å™¨         å¤–éƒ¨ç”¨æˆ·
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WebæœåŠ¡  â”‚        â”‚         â”‚       â”‚  æµè§ˆå™¨  â”‚
â”‚ :3000   â”‚<-------â”‚ SSHéš§é“ â”‚<------â”‚         â”‚
â”‚         â”‚        â”‚ :8080   â”‚       â”‚ :8080   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”§ åŸºæœ¬è¯­æ³•**
```bash
# æ ¼å¼ï¼šssh -R è¿œç¨‹ç«¯å£:æœ¬åœ°ä¸»æœº:æœ¬åœ°ç«¯å£ SSHæœåŠ¡å™¨
ssh -R 8080:localhost:3000 user@public-server.com

# å®é™…æ•ˆæœï¼šå¤–éƒ¨è®¿é—®public-server.com:8080å°±èƒ½çœ‹åˆ°æœ¬åœ°çš„3000ç«¯å£æœåŠ¡
```

**ğŸ“‹ å®ç”¨åœºæ™¯ç¤ºä¾‹**

```bash
# åœºæ™¯1ï¼šå±•ç¤ºæœ¬åœ°å¼€å‘çš„ç½‘ç«™
ssh -R 8080:localhost:3000 user@public-server.com
# å®¢æˆ·å¯ä»¥é€šè¿‡public-server.com:8080æŸ¥çœ‹ä½ æœ¬åœ°å¼€å‘çš„ç½‘ç«™

# åœºæ™¯2ï¼šè¿œç¨‹è°ƒè¯•
ssh -R 9229:localhost:9229 user@dev-server.com
# è®©è¿œç¨‹æœåŠ¡å™¨èƒ½è¿æ¥åˆ°æœ¬åœ°çš„è°ƒè¯•ç«¯å£

# åœºæ™¯3ï¼šå†…ç½‘æœåŠ¡å¤–ç½‘è®¿é—®
ssh -R 22222:192.168.1.100:22 user@cloud-server.com
# é€šè¿‡cloud-server.com:22222å°±èƒ½SSHåˆ°å†…ç½‘çš„192.168.1.100
```

### 1.4 åŠ¨æ€ç«¯å£è½¬å‘ï¼ˆSOCKSä»£ç†ï¼‰


**ğŸ’¡ å·¥ä½œåŸç†**
æŠŠSSHè¿æ¥å˜æˆä¸€ä¸ªSOCKSä»£ç†æœåŠ¡å™¨ï¼Œå¯ä»¥ä»£ç†ä»»æ„åè®®çš„è¿æ¥ã€‚å°±åƒæœ‰äº†ä¸€ä¸ª"ä¸‡èƒ½ä»£ç†"ï¼Œä»€ä¹ˆç½‘ç«™éƒ½èƒ½é€šè¿‡å®ƒè®¿é—®ã€‚

```bash
# åˆ›å»ºSOCKSä»£ç†
ssh -D 1080 user@proxy-server.com

# é…ç½®æµè§ˆå™¨ä½¿ç”¨SOCKS5ä»£ç†ï¼š127.0.0.1:1080
# ç°åœ¨æ‰€æœ‰ç½‘é¡µè®¿é—®éƒ½ä¼šé€šè¿‡proxy-server.com
```

**ğŸ¯ åŠ¨æ€è½¬å‘çš„ä¼˜åŠ¿**
- **çµæ´»æ€§**ï¼šä¸éœ€è¦æŒ‡å®šå…·ä½“çš„ç›®æ ‡åœ°å€
- **å¤šåè®®**ï¼šæ”¯æŒHTTPã€HTTPSã€FTPç­‰å„ç§åè®®
- **ç®€å•é…ç½®**ï¼šä¸€ä¸ªå‘½ä»¤å°±èƒ½åˆ›å»ºä»£ç†æœåŠ¡

---

## 2. ğŸš€ ProxyJumpè·³æ¿æœºé…ç½®


### 2.1 ä»€ä¹ˆæ˜¯è·³æ¿æœº


**ğŸ”¸ æ ¸å¿ƒæ¦‚å¿µ**
è·³æ¿æœºå°±åƒæ˜¯ç½‘ç»œä¸–ç•Œçš„"ä¸­è½¬ç«™"ã€‚å½“ä½ æ— æ³•ç›´æ¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨æ—¶ï¼Œéœ€è¦å…ˆè¿æ¥åˆ°è·³æ¿æœºï¼Œå†ä»è·³æ¿æœºè¿æ¥åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚

```
ä¼ ç»Ÿå¤šè·³è¿æ¥ï¼š
ä½ çš„ç”µè„‘ -> SSHåˆ°è·³æ¿æœº -> å†SSHåˆ°ç›®æ ‡æœåŠ¡å™¨
éœ€è¦æ‰‹åŠ¨æ“ä½œä¸¤æ¬¡SSHè¿æ¥

ProxyJumpï¼š
ä½ çš„ç”µè„‘ --[è‡ªåŠ¨ç»è¿‡è·³æ¿æœº]--> ç›®æ ‡æœåŠ¡å™¨
ä¸€ä¸ªå‘½ä»¤å®Œæˆæ‰€æœ‰è¿æ¥
```

### 2.2 ProxyJumpåŸºæœ¬ä½¿ç”¨


**ğŸ”§ å‘½ä»¤è¡Œè¯­æ³•**
```bash
# æ ¼å¼ï¼šssh -J è·³æ¿æœº ç›®æ ‡æœåŠ¡å™¨
ssh -J jumphost.com user@target-server.com

# å¤šçº§è·³æ¿ï¼šè·³æ¿æœº1 -> è·³æ¿æœº2 -> ç›®æ ‡æœåŠ¡å™¨
ssh -J jump1.com,jump2.com user@target.com
```

**ğŸ“‹ å®é™…åº”ç”¨åœºæ™¯**

```bash
# åœºæ™¯1ï¼šå…¬å¸å†…ç½‘è®¿é—®
ssh -J gateway.company.com user@internal-db.local
# å…ˆè¿gateway.company.comï¼Œå†è‡ªåŠ¨è¿åˆ°internal-db.local

# åœºæ™¯2ï¼šäº‘æœåŠ¡å™¨å†…ç½‘äº’è®¿
ssh -J bastion.cloud.com user@private-instance
# é€šè¿‡å ¡å’æœºè®¿é—®ç§æœ‰å®ä¾‹

# åœºæ™¯3ï¼šå¤šå±‚ç½‘ç»œç¯å¢ƒ
ssh -J proxy1.com,proxy2.com user@deep-server.internal
# ç»è¿‡ä¸¤å±‚ä»£ç†æ‰èƒ½åˆ°è¾¾çš„æœåŠ¡å™¨
```

### 2.3 é…ç½®æ–‡ä»¶ä¸­çš„ProxyJump


**ğŸ“ ~/.ssh/configé…ç½®**
```bash
# å®šä¹‰è·³æ¿æœº
Host jumphost
    HostName gateway.company.com
    User admin
    Port 22
    
# å®šä¹‰ç›®æ ‡æœåŠ¡å™¨ï¼Œä½¿ç”¨è·³æ¿æœº
Host internal-server
    HostName 192.168.1.100
    User developer
    ProxyJump jumphost
    
# å¤šçº§è·³æ¿é…ç½®
Host deep-server
    HostName 10.0.0.50
    User root
    ProxyJump jumphost,proxy2.company.com
```

**ğŸ¯ é…ç½®æ–‡ä»¶çš„å¥½å¤„**
- **ç®€åŒ–å‘½ä»¤**ï¼š`ssh internal-server` å°±èƒ½è‡ªåŠ¨è·³è½¬
- **ç»Ÿä¸€ç®¡ç†**ï¼šæ‰€æœ‰è·³æ¿é…ç½®é›†ä¸­ç®¡ç†
- **å‚æ•°å¤ç”¨**ï¼šè·³æ¿æœºé…ç½®å¯ä»¥è¢«å¤šä¸ªæœåŠ¡å™¨ä½¿ç”¨

### 2.4 ProxyCommandæ›¿ä»£æ–¹æ¡ˆ


å¯¹äºä¸æ”¯æŒProxyJumpçš„è€ç‰ˆæœ¬SSHï¼Œå¯ä»¥ä½¿ç”¨ProxyCommandï¼š

```bash
# ~/.ssh/config
Host target-via-proxy
    HostName target-server.com
    User myuser
    ProxyCommand ssh gateway.com -W %h:%p
    
# %hä»£è¡¨ç›®æ ‡ä¸»æœºåï¼Œ%pä»£è¡¨ç›®æ ‡ç«¯å£
```

---

## 3. ğŸ” SSHä»£ç†è½¬å‘æœºåˆ¶


### 3.1 ä»€ä¹ˆæ˜¯SSHä»£ç†


**ğŸ”¸ æ ¸å¿ƒæ¦‚å¿µ**
SSHä»£ç†ï¼ˆssh-agentï¼‰å°±åƒä¸€ä¸ª"é’¥åŒ™ç®¡å®¶"ï¼Œå¸®ä½ ä¿ç®¡æ‰€æœ‰çš„SSHç§é’¥ã€‚å½“éœ€è¦èº«ä»½éªŒè¯æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨æä¾›æ­£ç¡®çš„å¯†é’¥ï¼Œä½ ä¸ç”¨æ¯æ¬¡éƒ½è¾“å…¥å¯†ç ã€‚

```
æ²¡æœ‰ssh-agentï¼š
SSHè¿æ¥1 -> è¾“å…¥å¯†ç /å¯†é’¥
SSHè¿æ¥2 -> å†æ¬¡è¾“å…¥å¯†ç /å¯†é’¥
SSHè¿æ¥3 -> åˆè¦è¾“å…¥å¯†ç /å¯†é’¥

æœ‰ssh-agentï¼š
å¯åŠ¨agent -> æ·»åŠ å¯†é’¥(è¾“å…¥ä¸€æ¬¡å¯†ç )
SSHè¿æ¥1,2,3... -> è‡ªåŠ¨ä½¿ç”¨å¯†é’¥ï¼Œæ— éœ€å†è¾“å¯†ç 
```

### 3.2 ssh-agentåŸºæœ¬ä½¿ç”¨


**ğŸš€ å¯åŠ¨å’Œä½¿ç”¨ssh-agent**

```bash
# å¯åŠ¨ssh-agent
eval $(ssh-agent)
# æˆ–è€…
ssh-agent bash

# æ·»åŠ ç§é’¥åˆ°agent
ssh-add ~/.ssh/id_rsa
# è¾“å…¥ä¸€æ¬¡å¯†é’¥å¯†ç åï¼Œåç»­è¿æ¥éƒ½ä¸éœ€è¦å¯†ç 

# æŸ¥çœ‹å·²æ·»åŠ çš„å¯†é’¥
ssh-add -l

# åˆ é™¤æ‰€æœ‰å¯†é’¥
ssh-add -D
```

**ğŸ’¡ å®é™…ä½¿ç”¨æ•ˆæœ**
```bash
# æ·»åŠ å¯†é’¥åï¼Œè¿™äº›è¿æ¥éƒ½ä¸éœ€è¦è¾“å…¥å¯†ç 
ssh user1@server1.com
ssh user2@server2.com  
ssh user3@server3.com
```

### 3.3 ä»£ç†è½¬å‘ï¼ˆAgent Forwardingï¼‰


**ğŸ”¸ æ ¸å¿ƒæ¦‚å¿µ**
ä»£ç†è½¬å‘è®©ä½ åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šä¹Ÿèƒ½ä½¿ç”¨æœ¬åœ°çš„SSHå¯†é’¥ã€‚å°±åƒæŠŠ"é’¥åŒ™ç®¡å®¶"çš„æœåŠ¡å»¶ä¼¸åˆ°è¿œç¨‹æœåŠ¡å™¨ã€‚

```
ä»£ç†è½¬å‘ç¤ºæ„å›¾ï¼š

æœ¬åœ°ç”µè„‘              è·³æ¿æœº              ç›®æ ‡æœåŠ¡å™¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ssh-agentâ”‚          â”‚         â”‚         â”‚         â”‚
â”‚  å¯†é’¥åº“  â”‚--------->â”‚ è½¬å‘æœåŠ¡ â”‚-------->â”‚éœ€è¦è®¤è¯  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”§ å¯ç”¨ä»£ç†è½¬å‘**

```bash
# æ–¹å¼1ï¼šå‘½ä»¤è¡Œå‚æ•°
ssh -A user@jumphost.com

# æ–¹å¼2ï¼šé…ç½®æ–‡ä»¶
# ~/.ssh/config
Host jumphost
    HostName jumphost.com
    User admin
    ForwardAgent yes
```

**ğŸ“‹ ä»£ç†è½¬å‘çš„åº”ç”¨åœºæ™¯**

```bash
# åœºæ™¯1ï¼šä»è·³æ¿æœºè®¿é—®Gitä»“åº“
ssh -A user@jumphost.com
# ç™»å½•è·³æ¿æœºå
git clone git@github.com:company/private-repo.git
# èƒ½å¤Ÿä½¿ç”¨æœ¬åœ°çš„GitHubå¯†é’¥

# åœºæ™¯2ï¼šè·³æ¿æœºåˆ°å†…ç½‘æœåŠ¡å™¨çš„å…å¯†è®¿é—®
ssh -A user@gateway.com
# ç™»å½•ç½‘å…³å
ssh internal-server  # ä½¿ç”¨æœ¬åœ°å¯†é’¥ï¼Œæ— éœ€å¯†ç 
```

### 3.4 ä»£ç†è½¬å‘å®‰å…¨æ³¨æ„äº‹é¡¹


**âš ï¸ å®‰å…¨é£é™©**
- ä»£ç†è½¬å‘ä¼šæŠŠå¯†é’¥è®¿é—®æƒé™ç»™è¿œç¨‹æœåŠ¡å™¨
- ä¸è¦åœ¨ä¸ä¿¡ä»»çš„æœåŠ¡å™¨ä¸Šä½¿ç”¨ä»£ç†è½¬å‘
- è°¨æ…ä½¿ç”¨`ForwardAgent yes`å…¨å±€é…ç½®

**âœ… å®‰å…¨å®è·µ**
```bash
# åªå¯¹ä¿¡ä»»çš„ç‰¹å®šä¸»æœºå¯ç”¨
Host trusted-jumphost
    HostName company-gateway.com
    User admin
    ForwardAgent yes

Host untrusted-server
    HostName public-server.com
    User test
    ForwardAgent no  # æ˜ç¡®ç¦ç”¨
```

---

## 4. âš™ï¸ SSHé…ç½®æ–‡ä»¶é«˜çº§è¯­æ³•


### 4.1 é…ç½®æ–‡ä»¶åŸºæœ¬ç»“æ„


**ğŸ“ é…ç½®æ–‡ä»¶ä½ç½®**
- **ç”¨æˆ·é…ç½®**ï¼š`~/.ssh/config` ï¼ˆä¼˜å…ˆçº§é«˜ï¼‰
- **ç³»ç»Ÿé…ç½®**ï¼š`/etc/ssh/ssh_config` ï¼ˆå…¨å±€é»˜è®¤ï¼‰

**ğŸ“ åŸºæœ¬è¯­æ³•ç»“æ„**
```bash
# å…¨å±€é»˜è®¤é…ç½®
ServerAliveInterval 60
ServerAliveCountMax 3

# ç‰¹å®šä¸»æœºé…ç½®
Host myserver
    HostName server.example.com
    User myuser
    Port 2222
    
# æ¨¡å¼åŒ¹é…é…ç½®
Host *.company.com
    User employee
    ProxyJump gateway.company.com
```

### 4.2 é«˜çº§åŒ¹é…æ¨¡å¼


**ğŸ¯ é€šé…ç¬¦åŒ¹é…**

```bash
# åŒ¹é…æ‰€æœ‰.devç»“å°¾çš„ä¸»æœº
Host *.dev
    User developer
    Port 2222
    
# åŒ¹é…å¤šä¸ªæ¨¡å¼
Host server1 server2 *.test.com
    StrictHostKeyChecking no
    
# æ’é™¤ç‰¹å®šä¸»æœº
Host * !production.com
    LogLevel DEBUG
```

**ğŸ”§ æ¡ä»¶åŒ¹é…é«˜çº§è¯­æ³•**

```bash
# åŸºäºç”¨æˆ·çš„åŒ¹é…
Match User admin
    PermitRootLogin yes
    
# åŸºäºåœ°å€çš„åŒ¹é…  
Match Address 192.168.1.*
    PasswordAuthentication no
    
# ç»„åˆæ¡ä»¶åŒ¹é…
Match User developer Address 10.0.0.*
    AllowTcpForwarding yes
    X11Forwarding yes
```

### 4.3 å¸¸ç”¨é«˜çº§é…ç½®é€‰é¡¹


**â° è¿æ¥ä¿æ´»é…ç½®**
```bash
Host *
    # æ¯60ç§’å‘é€ä¿æ´»åŒ…
    ServerAliveInterval 60
    # æœ€å¤šå‘é€3æ¬¡ä¿æ´»åŒ…æ— å“åº”åæ–­å¼€
    ServerAliveCountMax 3
    # TCPå±‚é¢çš„ä¿æ´»
    TCPKeepAlive yes
```

**ğŸ” å®‰å…¨ç›¸å…³é…ç½®**
```bash
Host production-*
    # ä¸¥æ ¼ä¸»æœºå¯†é’¥æ£€æŸ¥
    StrictHostKeyChecking yes
    # ç¦ç”¨å¯†ç è®¤è¯ï¼Œåªç”¨å¯†é’¥
    PasswordAuthentication no
    # ç¦ç”¨é”®ç›˜äº¤äº’è®¤è¯
    KbdInteractiveAuthentication no
    # æŒ‡å®šå¯†é’¥æ–‡ä»¶
    IdentityFile ~/.ssh/production_rsa
    # åªä½¿ç”¨æŒ‡å®šçš„å¯†é’¥
    IdentitiesOnly yes
```

**ğŸš€ æ€§èƒ½ä¼˜åŒ–é…ç½®**
```bash
Host *
    # å¯ç”¨è¿æ¥å‹ç¼©
    Compression yes
    # ä½¿ç”¨æ›´å¿«çš„åŠ å¯†ç®—æ³•
    Ciphers aes128-gcm@openssh.com,aes256-gcm@openssh.com
    # è¿æ¥å¤ç”¨
    ControlMaster auto
    ControlPath ~/.ssh/control-%r@%h:%p
    ControlPersist 10m
```

### 4.4 å®ç”¨é…ç½®æ¨¡æ¿


**ğŸ¢ ä¼ä¸šç¯å¢ƒé…ç½®ç¤ºä¾‹**
```bash
# è·³æ¿æœºé…ç½®
Host jumphost
    HostName gateway.company.com
    User admin
    Port 22
    IdentityFile ~/.ssh/company_rsa
    
# å†…ç½‘æœåŠ¡å™¨é…ç½®ï¼ˆé€šè¿‡è·³æ¿æœºï¼‰
Host web-* db-* app-*
    User developer
    ProxyJump jumphost
    StrictHostKeyChecking no
    UserKnownHostsFile /dev/null
    LogLevel QUIET
    
# ç”Ÿäº§ç¯å¢ƒï¼ˆé«˜å®‰å…¨ï¼‰
Host prod-*
    User root
    ProxyJump jumphost
    IdentityFile ~/.ssh/production_rsa
    IdentitiesOnly yes
    StrictHostKeyChecking yes
    
# å¼€å‘ç¯å¢ƒï¼ˆä¾¿åˆ©æ€§ä¼˜å…ˆï¼‰
Host dev-*
    User developer
    ProxyJump jumphost
    StrictHostKeyChecking no
    PasswordAuthentication yes
    ForwardAgent yes
    X11Forwarding yes
```

---

## 5. ğŸ‘¥ å¤šä¸»æœºæ‰¹é‡è¿æ¥ç®¡ç†


### 5.1 ä»€ä¹ˆæ˜¯æ‰¹é‡è¿æ¥ç®¡ç†


**ğŸ”¸ æ ¸å¿ƒéœ€æ±‚**
å½“ä½ éœ€è¦ç®¡ç†å‡ åå°ç”šè‡³ä¸Šç™¾å°æœåŠ¡å™¨æ—¶ï¼Œé€ä¸ªSSHè¿æ¥æ•ˆç‡æä½ã€‚æ‰¹é‡è¿æ¥ç®¡ç†å°±æ˜¯ç”¨å·¥å…·å’Œè„šæœ¬åŒæ—¶è¿æ¥å’Œæ“ä½œå¤šå°æœåŠ¡å™¨ã€‚

```
ä¼ ç»Ÿæ–¹å¼ï¼š
ssh server1 -> æ‰§è¡Œå‘½ä»¤ -> é€€å‡º
ssh server2 -> æ‰§è¡Œå‘½ä»¤ -> é€€å‡º
ssh server3 -> æ‰§è¡Œå‘½ä»¤ -> é€€å‡º
...é‡å¤100æ¬¡

æ‰¹é‡ç®¡ç†ï¼š
ä¸€ä¸ªå‘½ä»¤ -> åŒæ—¶è¿æ¥æ‰€æœ‰æœåŠ¡å™¨ -> æ‰¹é‡æ‰§è¡Œ -> æ±‡æ€»ç»“æœ
```

### 5.2 ä½¿ç”¨psshè¿›è¡Œå¹¶è¡ŒSSH


**ğŸ“¦ å®‰è£…psshå·¥å…·**
```bash
# Ubuntu/Debian
sudo apt-get install pssh

# CentOS/RHEL
sudo yum install pssh

# æˆ–è€…pipå®‰è£…
pip install pssh
```

**ğŸ”§ åŸºæœ¬ä½¿ç”¨æ–¹æ³•**

```bash
# å‡†å¤‡ä¸»æœºåˆ—è¡¨æ–‡ä»¶
echo "server1.com" > hosts.txt
echo "server2.com" >> hosts.txt
echo "server3.com" >> hosts.txt

# å¹¶è¡Œæ‰§è¡Œå‘½ä»¤
parallel-ssh -h hosts.txt -l root "uptime"

# å¹¶è¡Œå¤åˆ¶æ–‡ä»¶
parallel-scp -h hosts.txt -l root local-file.txt /tmp/

# ä»æ‰€æœ‰ä¸»æœºæ”¶é›†æ–‡ä»¶
parallel-slurp -h hosts.txt -l root /var/log/messages logs/
```

**ğŸ“‹ å®ç”¨æ‰¹é‡æ“ä½œç¤ºä¾‹**

```bash
# æ‰¹é‡æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
parallel-ssh -h web-servers.txt -l admin "df -h && free -m"

# æ‰¹é‡æ›´æ–°è½¯ä»¶åŒ…
parallel-ssh -h all-servers.txt -l root "yum update -y"

# æ‰¹é‡é‡å¯æœåŠ¡
parallel-ssh -h app-servers.txt -l deploy "systemctl restart nginx"

# æ‰¹é‡æ”¶é›†æ—¥å¿—
parallel-slurp -h servers.txt -l root /var/log/error.log ./logs/
```

### 5.3 ä½¿ç”¨Ansibleè¿›è¡Œæ‰¹é‡ç®¡ç†


**ğŸ¯ Ansibleç®€ä»‹**
Ansibleæ˜¯æ›´å¼ºå¤§çš„æ‰¹é‡ç®¡ç†å·¥å…·ï¼Œä½¿ç”¨YAMLé…ç½®æ–‡ä»¶ï¼Œæ— éœ€åœ¨ç›®æ ‡æœºå™¨å®‰è£…å®¢æˆ·ç«¯ã€‚

**ğŸ“ Inventoryæ–‡ä»¶é…ç½®**
```bash
# inventory/hosts
[webservers]
web1.example.com
web2.example.com
web3.example.com

[databases]
db1.example.com
db2.example.com

[all:vars]
ansible_user=admin
ansible_ssh_private_key_file=~/.ssh/admin_key
```

**ğŸ”§ å¸¸ç”¨Ansibleå‘½ä»¤**
```bash
# æµ‹è¯•è¿é€šæ€§
ansible all -i inventory/hosts -m ping

# æ‰¹é‡æ‰§è¡Œå‘½ä»¤
ansible webservers -i inventory/hosts -m shell -a "uptime"

# æ‰¹é‡å¤åˆ¶æ–‡ä»¶
ansible all -i inventory/hosts -m copy -a "src=config.txt dest=/tmp/"

# æ‰¹é‡å®‰è£…è½¯ä»¶
ansible webservers -i inventory/hosts -m yum -a "name=nginx state=present"
```

### 5.4 è‡ªå®šä¹‰æ‰¹é‡è¿æ¥è„šæœ¬


**ğŸ“œ ç®€å•çš„Shellè„šæœ¬ç¤ºä¾‹**
```bash
#!/bin/bash
# batch_ssh.sh - æ‰¹é‡SSHæ‰§è¡Œè„šæœ¬

SERVERS_FILE="servers.txt"
COMMAND="$1"

if [ -z "$COMMAND" ]; then
    echo "ç”¨æ³•: $0 'è¦æ‰§è¡Œçš„å‘½ä»¤'"
    exit 1
fi

while read server; do
    echo "=== $server ==="
    ssh "$server" "$COMMAND"
    echo ""
done < "$SERVERS_FILE"
```

**ğŸ”§ ä½¿ç”¨è„šæœ¬**
```bash
# åˆ›å»ºæœåŠ¡å™¨åˆ—è¡¨
cat > servers.txt << EOF
user@server1.com
user@server2.com
user@server3.com
EOF

# æ‰¹é‡æ‰§è¡Œå‘½ä»¤
./batch_ssh.sh "df -h"
./batch_ssh.sh "systemctl status nginx"
```

---

## 6. ğŸ”„ SSHè¿æ¥å¤ç”¨æŠ€æœ¯


### 6.1 ä»€ä¹ˆæ˜¯è¿æ¥å¤ç”¨


**ğŸ”¸ æ ¸å¿ƒæ¦‚å¿µ**
SSHè¿æ¥å¤ç”¨å°±åƒ"æ‹¼è½¦"ä¸€æ ·ï¼Œå¤šä¸ªSSHä¼šè¯å…±äº«åŒä¸€æ¡ç½‘ç»œè¿æ¥ã€‚ç¬¬ä¸€æ¬¡è¿æ¥æ—¶å»ºç«‹"ä¸»è¿æ¥"ï¼Œåç»­è¿æ¥éƒ½é€šè¿‡è¿™æ¡ä¸»è¿æ¥ä¼ è¾“æ•°æ®ï¼Œé¿å…é‡å¤çš„æ¡æ‰‹å’Œè®¤è¯è¿‡ç¨‹ã€‚

```
æ— è¿æ¥å¤ç”¨ï¼š
SSHä¼šè¯1 â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”> æœåŠ¡å™¨ (å»ºç«‹è¿æ¥1)
SSHä¼šè¯2 â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”> æœåŠ¡å™¨ (å»ºç«‹è¿æ¥2)
SSHä¼šè¯3 â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”> æœåŠ¡å™¨ (å»ºç«‹è¿æ¥3)
æ¯æ¬¡éƒ½è¦é‡æ–°è®¤è¯

æœ‰è¿æ¥å¤ç”¨ï¼š
SSHä¼šè¯1 â€”â€”â€”â€”â€”â€”[ä¸»è¿æ¥]â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”> æœåŠ¡å™¨
SSHä¼šè¯2 â€”â€”â€”â€”>  |
SSHä¼šè¯3 â€”â€”â€”â€”>  | å…±äº«åŒä¸€è¿æ¥
åç»­è¿æ¥æ— éœ€è®¤è¯ï¼Œé€Ÿåº¦æ›´å¿«
```

### 6.2 é…ç½®SSHè¿æ¥å¤ç”¨


**âš™ï¸ é…ç½®æ–‡ä»¶è®¾ç½®**
```bash
# ~/.ssh/config
Host *
    # å¯ç”¨è¿æ¥å¤ç”¨
    ControlMaster auto
    # æ§åˆ¶socketè·¯å¾„ï¼Œ%r=ç”¨æˆ·å %h=ä¸»æœºå %p=ç«¯å£
    ControlPath ~/.ssh/control-%r@%h:%p
    # ä¿æŒè¿æ¥10åˆ†é’Ÿ
    ControlPersist 10m
```

**ğŸ“‹ é…ç½®å‚æ•°è¯¦è§£**

| å‚æ•° | å«ä¹‰ | æ¨èå€¼ |
|------|------|--------|
| `ControlMaster` | è¿æ¥å¤ç”¨æ¨¡å¼ | `auto` (è‡ªåŠ¨ç®¡ç†) |
| `ControlPath` | æ§åˆ¶socketæ–‡ä»¶è·¯å¾„ | `~/.ssh/control-%r@%h:%p` |
| `ControlPersist` | ä¸»è¿æ¥ä¿æŒæ—¶é—´ | `10m` (10åˆ†é’Ÿ) |

### 6.3 è¿æ¥å¤ç”¨å®é™…æ•ˆæœ


**âš¡ é€Ÿåº¦å¯¹æ¯”æµ‹è¯•**
```bash
# ç¬¬ä¸€æ¬¡è¿æ¥ï¼ˆå»ºç«‹ä¸»è¿æ¥ï¼‰
time ssh server.com "echo 'first connection'"
# è¾“å‡ºï¼šreal 0m2.1s ï¼ˆåŒ…å«è®¤è¯æ—¶é—´ï¼‰

# åç»­è¿æ¥ï¼ˆä½¿ç”¨å¤ç”¨ï¼‰
time ssh server.com "echo 'reused connection'" 
# è¾“å‡ºï¼šreal 0m0.3s ï¼ˆå¿«äº†6å€ï¼ï¼‰
```

**ğŸ”§ æ‰‹åŠ¨ç®¡ç†å¤ç”¨è¿æ¥**
```bash
# æ‰‹åŠ¨å»ºç«‹ä¸»è¿æ¥
ssh -M -S ~/.ssh/control-user@server.com server.com

# ä½¿ç”¨å·²å»ºç«‹çš„è¿æ¥
ssh -S ~/.ssh/control-user@server.com server.com "whoami"

# æ£€æŸ¥è¿æ¥çŠ¶æ€
ssh -S ~/.ssh/control-user@server.com -O check server.com

# å…³é—­ä¸»è¿æ¥
ssh -S ~/.ssh/control-user@server.com -O exit server.com
```

### 6.4 è¿æ¥å¤ç”¨é«˜çº§æŠ€å·§


**ğŸ¯ é’ˆå¯¹ç‰¹å®šæœåŠ¡å™¨ä¼˜åŒ–**
```bash
# ä¸ºé¢‘ç¹è®¿é—®çš„æœåŠ¡å™¨è®¾ç½®é•¿æ—¶é—´ä¿æŒ
Host production-server
    HostName prod.company.com
    ControlMaster auto
    ControlPath ~/.ssh/control-%r@%h:%p
    ControlPersist 1h  # ä¿æŒ1å°æ—¶

# ä¸ºä¸´æ—¶æœåŠ¡å™¨è®¾ç½®çŸ­æ—¶é—´ä¿æŒ
Host temp-*
    ControlMaster auto
    ControlPath ~/.ssh/control-%r@%h:%p
    ControlPersist 2m   # ä¿æŒ2åˆ†é’Ÿ
```

**ğŸ› ï¸ åˆ›å»ºæ§åˆ¶socketç›®å½•**
```bash
# ç¡®ä¿æ§åˆ¶socketç›®å½•å­˜åœ¨
mkdir -p ~/.ssh/control
chmod 700 ~/.ssh/control

# é…ç½®ä½¿ç”¨ä¸“é—¨ç›®å½•
Host *
    ControlPath ~/.ssh/control/%r@%h:%p
```

---

## 7. ğŸ–¥ï¸ X11è½¬å‘ä¸å›¾å½¢åº”ç”¨


### 7.1 ä»€ä¹ˆæ˜¯X11è½¬å‘


**ğŸ”¸ æ ¸å¿ƒæ¦‚å¿µ**
X11è½¬å‘è®©ä½ å¯ä»¥åœ¨æœ¬åœ°ç”µè„‘ä¸Šæ˜¾ç¤ºè¿œç¨‹LinuxæœåŠ¡å™¨çš„å›¾å½¢ç•Œé¢ç¨‹åºã€‚ç®€å•ç†è§£å°±æ˜¯ï¼šè¿œç¨‹ç¨‹åºåœ¨æœåŠ¡å™¨è¿è¡Œï¼Œå›¾å½¢ç•Œé¢åœ¨ä½ çš„ç”µè„‘ä¸Šæ˜¾ç¤ºã€‚

```
X11è½¬å‘å·¥ä½œæµç¨‹ï¼š

è¿œç¨‹æœåŠ¡å™¨                æœ¬åœ°ç”µè„‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å›¾å½¢ç¨‹åº     â”‚          â”‚             â”‚
â”‚ (è®¡ç®—å¤„ç†)   â”‚<-------->â”‚ æ˜¾ç¤ºç•Œé¢     â”‚
â”‚             â”‚   SSH    â”‚ (é¼ æ ‡é”®ç›˜)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  éš§é“    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 å¯ç”¨X11è½¬å‘


**ğŸ–±ï¸ æœ¬åœ°ç¯å¢ƒå‡†å¤‡**

**Windowsç¯å¢ƒï¼š**
```bash
# å®‰è£…Xmingæˆ–VcXsrvä½œä¸ºXæœåŠ¡å™¨
# ä¸‹è½½åœ°å€ï¼šhttps://sourceforge.net/projects/xming/
# æˆ–è€…ä½¿ç”¨WSL2 + Windows XæœåŠ¡å™¨

# è®¾ç½®DISPLAYç¯å¢ƒå˜é‡
export DISPLAY=localhost:0.0
```

**macOSç¯å¢ƒï¼š**
```bash
# å®‰è£…XQuartz
brew install --cask xquartz

# å¯åŠ¨åè®¾ç½®DISPLAY
export DISPLAY=:0.0
```

**Linuxç¯å¢ƒï¼š**
```bash
# é€šå¸¸å·²æœ‰XæœåŠ¡å™¨ï¼Œç›´æ¥ä½¿ç”¨
echo $DISPLAY  # æŸ¥çœ‹å½“å‰DISPLAYè®¾ç½®
```

### 7.3 SSH X11è½¬å‘ä½¿ç”¨


**ğŸ”§ å‘½ä»¤è¡Œå¯ç”¨X11è½¬å‘**
```bash
# å¯ç”¨X11è½¬å‘
ssh -X user@server.com

# å¯ç”¨å¯ä¿¡X11è½¬å‘ï¼ˆæ›´å°‘é™åˆ¶ï¼‰
ssh -Y user@server.com

# æµ‹è¯•X11è½¬å‘æ˜¯å¦å·¥ä½œ
xclock  # æ˜¾ç¤ºä¸€ä¸ªæ—¶é’Ÿç¨‹åº
xeyes   # æ˜¾ç¤ºä¸€ä¸ªçœ¼çƒç¨‹åº
```

**âš™ï¸ é…ç½®æ–‡ä»¶è®¾ç½®**
```bash
# ~/.ssh/config
Host graphics-server
    HostName server.company.com
    User developer
    ForwardX11 yes
    ForwardX11Trusted yes
    # è®¾ç½®X11æ˜¾ç¤ºè¶…æ—¶
    ForwardX11Timeout 10m
```

### 7.4 å¸¸ç”¨å›¾å½¢åº”ç”¨ç¤ºä¾‹


**ğŸ› ï¸ å¼€å‘å·¥å…·**
```bash
# SSHè¿æ¥åè¿è¡Œå›¾å½¢IDE
ssh -X dev-server.com
gedit file.txt        # å›¾å½¢æ–‡æœ¬ç¼–è¾‘å™¨
firefox               # ç½‘é¡µæµè§ˆå™¨
gimp                  # å›¾åƒç¼–è¾‘è½¯ä»¶
code                  # VS Code (å¦‚æœå®‰è£…äº†)
```

**ğŸ“Š ç³»ç»Ÿç®¡ç†å·¥å…·**
```bash
# ç³»ç»Ÿç›‘æ§å›¾å½¢ç•Œé¢
gnome-system-monitor  # ç³»ç»Ÿç›‘è§†å™¨
wireshark            # ç½‘ç»œæŠ“åŒ…å·¥å…·
gparted              # ç£ç›˜åˆ†åŒºå·¥å…·
```

**ğŸ”¬ ç§‘å­¦è®¡ç®—åº”ç”¨**
```bash
# æ•°æ®åˆ†æå’Œç§‘å­¦è®¡ç®—
jupyter notebook     # Jupyterç¬”è®°æœ¬
matlab              # MATLAB (å¦‚æœæœ‰è®¸å¯è¯)
rstudio             # Rè¯­è¨€IDE
```

### 7.5 X11è½¬å‘æ€§èƒ½ä¼˜åŒ–


**âš¡ å‹ç¼©å’ŒåŠ é€Ÿ**
```bash
# å¯ç”¨å‹ç¼©å‡å°‘ç½‘ç»œä¼ è¾“
ssh -X -C user@server.com

# ä½¿ç”¨æ›´å¿«çš„åŠ å¯†ç®—æ³•
ssh -X -c aes128-ctr user@server.com

# ç»„åˆä¼˜åŒ–å‚æ•°
ssh -X -C -c aes128-ctr -o CompressionLevel=6 user@server.com
```

**âš ï¸ å¸¸è§é—®é¢˜è§£å†³**
```bash
# é—®é¢˜1ï¼šæ— æ³•æ˜¾ç¤ºå›¾å½¢
export DISPLAY=localhost:10.0  # SSHé€šå¸¸ä½¿ç”¨10.0ç«¯å£

# é—®é¢˜2ï¼šæƒé™è¢«æ‹’ç»
xauth list  # æŸ¥çœ‹Xè®¤è¯ä¿¡æ¯
xhost +     # ä¸´æ—¶å…è®¸æ‰€æœ‰è¿æ¥ï¼ˆä¸å®‰å…¨ï¼‰

# é—®é¢˜3ï¼šå­—ä½“æ˜¾ç¤ºé—®é¢˜
ssh -X -o ForwardX11Trusted=yes user@server.com
```

---

## 8. âŒ¨ï¸ SSHè½¬ä¹‰åºåˆ—åº”ç”¨


### 8.1 ä»€ä¹ˆæ˜¯SSHè½¬ä¹‰åºåˆ—


**ğŸ”¸ æ ¸å¿ƒæ¦‚å¿µ**
SSHè½¬ä¹‰åºåˆ—å°±åƒ"ç‰¹æ®Šå¿«æ·é”®"ï¼Œè®©ä½ åœ¨SSHè¿æ¥ä¸­æ‰§è¡Œç‰¹æ®Šæ“ä½œã€‚é»˜è®¤è½¬ä¹‰å­—ç¬¦æ˜¯`~`ï¼Œå¿…é¡»åœ¨è¡Œé¦–è¾“å…¥æ‰æœ‰æ•ˆã€‚

```
è½¬ä¹‰åºåˆ—æ ¼å¼ï¼š
~<å­—ç¬¦>

æ³¨æ„ï¼šå¿…é¡»åœ¨æ–°è¡Œçš„å¼€å¤´è¾“å…¥~ï¼Œä¸èƒ½åœ¨è¡Œä¸­é—´
```

### 8.2 å¸¸ç”¨è½¬ä¹‰åºåˆ—


**ğŸ“‹ åŸºæœ¬è½¬ä¹‰åºåˆ—è¡¨**

| åºåˆ— | åŠŸèƒ½ | ä½¿ç”¨åœºæ™¯ |
|------|------|----------|
| `~.` | æ–­å¼€è¿æ¥ | å¼ºåˆ¶é€€å‡ºSSHä¼šè¯ |
| `~^Z` | æš‚åœè¿æ¥ | å°†SSHæ”¾åˆ°åå° |
| `~?` | æ˜¾ç¤ºå¸®åŠ© | æŸ¥çœ‹æ‰€æœ‰è½¬ä¹‰åºåˆ— |
| `~#` | åˆ—å‡ºè½¬å‘è¿æ¥ | æŸ¥çœ‹ç«¯å£è½¬å‘çŠ¶æ€ |
| `~&` | åå°è¿è¡Œ | å°†SSHæ”¾åˆ°åå°ç»§ç»­è¿è¡Œ |

### 8.3 è½¬ä¹‰åºåˆ—å®é™…åº”ç”¨


**ğŸ›‘ å¼ºåˆ¶æ–­å¼€è¿æ¥**
```bash
# å½“SSHä¼šè¯å¡æ­»æ— å“åº”æ—¶
ssh user@server.com
# è¿æ¥åå¦‚æœå¡æ­»ï¼ŒæŒ‰ Enter ç„¶åè¾“å…¥ ~.
~.
# [è¿æ¥å·²æ–­å¼€]
```

**â¸ï¸ æš‚åœå’Œæ¢å¤è¿æ¥**
```bash
# æš‚åœSSHè¿æ¥
~^Z
# [1]+  Stopped    ssh user@server.com

# æŸ¥çœ‹åå°ä»»åŠ¡
jobs

# æ¢å¤è¿æ¥
fg
```

**ğŸ“Š æŸ¥çœ‹è¿æ¥çŠ¶æ€**
```bash
# åœ¨SSHè¿æ¥ä¸­è¾“å…¥
~#
# è¾“å‡ºç¤ºä¾‹ï¼š
# The following connections are open:
#   #2 client-session (t4 nr0 i0/0 o0/0 e[write]/0 fd 5/6/7)

~?
# æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„è½¬ä¹‰åºåˆ—å¸®åŠ©
```

### 8.4 ç«¯å£è½¬å‘ç›¸å…³è½¬ä¹‰åºåˆ—


**ğŸ”§ åŠ¨æ€ç®¡ç†ç«¯å£è½¬å‘**
```bash
# åœ¨å·²å»ºç«‹çš„SSHè¿æ¥ä¸­æ·»åŠ ç«¯å£è½¬å‘
~C
# è¿›å…¥SSHå‘½ä»¤è¡Œæ¨¡å¼
ssh> -L 8080:localhost:80
# æ·»åŠ æœ¬åœ°ç«¯å£è½¬å‘

ssh> -R 9999:localhost:22  
# æ·»åŠ è¿œç¨‹ç«¯å£è½¬å‘

ssh> ?
# æŸ¥çœ‹å‘½ä»¤è¡Œæ¨¡å¼å¸®åŠ©

ssh> help
# æ˜¾ç¤ºè¯¦ç»†å¸®åŠ©ä¿¡æ¯
```

### 8.5 è‡ªå®šä¹‰è½¬ä¹‰å­—ç¬¦


**âš™ï¸ ä¿®æ”¹è½¬ä¹‰å­—ç¬¦**
```bash
# ä½¿ç”¨ä¸åŒçš„è½¬ä¹‰å­—ç¬¦
ssh -e '^' user@server.com  # ä½¿ç”¨ Ctrl+^ ä½œä¸ºè½¬ä¹‰å­—ç¬¦
ssh -e none user@server.com # ç¦ç”¨è½¬ä¹‰åºåˆ—

# é…ç½®æ–‡ä»¶ä¸­è®¾ç½®
# ~/.ssh/config
Host special-server
    EscapeChar ^
    # æˆ–è€…ç¦ç”¨è½¬ä¹‰
    # EscapeChar none
```

**ğŸ“ å®ç”¨é…ç½®ç¤ºä¾‹**
```bash
# å¯¹äºè„šæœ¬è‡ªåŠ¨åŒ–ï¼Œç¦ç”¨è½¬ä¹‰åºåˆ—é¿å…å¹²æ‰°
Host automated-*
    EscapeChar none
    StrictHostKeyChecking no
    
# å¯¹äºäº¤äº’å¼è¿æ¥ï¼Œä¿æŒé»˜è®¤è½¬ä¹‰å­—ç¬¦
Host interactive-*
    EscapeChar ~
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ”¸ SSHéš§é“æŠ€æœ¯**
- **æœ¬åœ°è½¬å‘**ï¼š`ssh -L æœ¬åœ°ç«¯å£:ç›®æ ‡:ç«¯å£ æœåŠ¡å™¨` - è®¿é—®è¿œç¨‹å†…ç½‘æœåŠ¡
- **è¿œç¨‹è½¬å‘**ï¼š`ssh -R è¿œç¨‹ç«¯å£:æœ¬åœ°:ç«¯å£ æœåŠ¡å™¨` - å†…ç½‘ç©¿é€ï¼Œå¤–éƒ¨è®¿é—®æœ¬åœ°
- **åŠ¨æ€è½¬å‘**ï¼š`ssh -D ç«¯å£ æœåŠ¡å™¨` - åˆ›å»ºSOCKSä»£ç†

**ğŸ”¸ è·³æ¿æœºé…ç½®**
- **ProxyJump**ï¼š`ssh -J è·³æ¿æœº ç›®æ ‡æœåŠ¡å™¨` - ä¸€æ¡å‘½ä»¤å¤šçº§è·³è½¬
- **é…ç½®æ–‡ä»¶**ï¼š`ProxyJump jumphost` - ç®€åŒ–è¿æ¥å‘½ä»¤

**ğŸ”¸ SSHä»£ç†ç®¡ç†**
- **ssh-agent**ï¼šå¯†é’¥ç®¡å®¶ï¼Œé¿å…é‡å¤è¾“å…¥å¯†ç 
- **ä»£ç†è½¬å‘**ï¼š`ssh -A` è®©è¿œç¨‹æœåŠ¡å™¨ä½¿ç”¨æœ¬åœ°å¯†é’¥

### 9.2 å®ç”¨é…ç½®æ¨¡æ¿


**ğŸ“ å®Œæ•´çš„~/.ssh/configç¤ºä¾‹**
```bash
# å…¨å±€ä¼˜åŒ–è®¾ç½®
Host *
    ServerAliveInterval 60
    ServerAliveCountMax 3
    Compression yes
    ControlMaster auto
    ControlPath ~/.ssh/control-%r@%h:%p
    ControlPersist 10m

# è·³æ¿æœºé…ç½®
Host jumphost
    HostName gateway.company.com
    User admin
    IdentityFile ~/.ssh/company_rsa

# å†…ç½‘æœåŠ¡å™¨ï¼ˆé€šè¿‡è·³æ¿æœºï¼‰
Host web-* db-* app-*
    User developer
    ProxyJump jumphost
    ForwardAgent yes

# å›¾å½¢åº”ç”¨æœåŠ¡å™¨
Host graphics
    HostName graphics.lab.com
    User researcher
    ForwardX11 yes
    ForwardX11Trusted yes
```

### 9.3 æœ€ä½³å®è·µå»ºè®®


**ğŸ”’ å®‰å…¨æ€§**
- ä»£ç†è½¬å‘åªåœ¨å¯ä¿¡æœåŠ¡å™¨ä½¿ç”¨
- ç”Ÿäº§ç¯å¢ƒç¦ç”¨å¯†ç è®¤è¯ï¼Œåªç”¨å¯†é’¥
- å®šæœŸæ›´æ¢SSHå¯†é’¥

**âš¡ æ€§èƒ½ä¼˜åŒ–**
- å¯ç”¨è¿æ¥å¤ç”¨å‡å°‘è¿æ¥æ—¶é—´
- ä½¿ç”¨å‹ç¼©ç®—æ³•å‡å°‘ç½‘ç»œä¼ è¾“
- åˆç†è®¾ç½®ä¿æ´»å‚æ•°

**ğŸ› ï¸ ç®¡ç†æ•ˆç‡**
- ä½¿ç”¨é…ç½®æ–‡ä»¶ç»Ÿä¸€ç®¡ç†è¿æ¥å‚æ•°
- æ‰¹é‡ç®¡ç†å·¥å…·å¤„ç†å¤šæœåŠ¡å™¨æ“ä½œ
- å–„ç”¨è½¬ä¹‰åºåˆ—å¤„ç†å¼‚å¸¸æƒ…å†µ

**ğŸ’¡ æ ¸å¿ƒè®°å¿†è¦ç‚¹**
- SSHéš§é“æ˜¯ç½‘ç»œçš„"åœ°ä¸‹é€šé“"ï¼Œå®‰å…¨ç»•è¿‡é™åˆ¶
- ProxyJumpè®©å¤šçº§è·³è½¬å˜æˆä¸€æ¡å‘½ä»¤
- ssh-agentæ˜¯"é’¥åŒ™ç®¡å®¶"ï¼Œç®¡ç†æ‰€æœ‰å¯†é’¥
- é…ç½®æ–‡ä»¶æ˜¯æ•ˆç‡å·¥å…·ï¼Œä¸€æ¬¡é…ç½®ç»ˆèº«å—ç›Š
- X11è½¬å‘è®©è¿œç¨‹å›¾å½¢ç¨‹åºåœ¨æœ¬åœ°æ˜¾ç¤º
- è½¬ä¹‰åºåˆ—æ˜¯åº”æ€¥å·¥å…·ï¼Œå…³é”®æ—¶åˆ»æ•‘å‘½