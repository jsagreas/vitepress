---
title: 8ã€rsyncé«˜çº§é…ç½®åº”ç”¨
---
## ğŸ“š ç›®å½•

1. [rsyncå®ˆæŠ¤è¿›ç¨‹æ¨¡å¼](#1-rsyncå®ˆæŠ¤è¿›ç¨‹æ¨¡å¼)
2. [rsyncd.confé…ç½®æ–‡ä»¶è¯¦è§£](#2-rsyncd-confé…ç½®æ–‡ä»¶è¯¦è§£)
3. [æ¨¡å—å®šä¹‰ä¸è®¿é—®æ§åˆ¶](#3-æ¨¡å—å®šä¹‰ä¸è®¿é—®æ§åˆ¶)
4. [ç”¨æˆ·è®¤è¯ä¸å¯†ç æ–‡ä»¶](#4-ç”¨æˆ·è®¤è¯ä¸å¯†ç æ–‡ä»¶)
5. [ä¼ è¾“ç»Ÿè®¡ä¸æ€§èƒ½ä¼˜åŒ–](#5-ä¼ è¾“ç»Ÿè®¡ä¸æ€§èƒ½ä¼˜åŒ–)
6. [rsyncå¤‡ä»½ç­–ç•¥è®¾è®¡](#6-rsyncå¤‡ä»½ç­–ç•¥è®¾è®¡)
7. [å®šæ—¶åŒæ­¥ä¸è‡ªåŠ¨åŒ–è„šæœ¬](#7-å®šæ—¶åŒæ­¥ä¸è‡ªåŠ¨åŒ–è„šæœ¬)
8. [ç½‘ç»œæ•…éšœå¤„ç†ä¸é‡è¯•æœºåˆ¶](#8-ç½‘ç»œæ•…éšœå¤„ç†ä¸é‡è¯•æœºåˆ¶)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ rsyncå®ˆæŠ¤è¿›ç¨‹æ¨¡å¼


### 1.1 ä»€ä¹ˆæ˜¯å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼


**é€šä¿—è§£é‡Š**ï¼šå®ˆæŠ¤è¿›ç¨‹æ¨¡å¼å°±æ˜¯è®©rsyncåƒä¸€ä¸ªæœåŠ¡ä¸€æ ·åœ¨åå°æŒç»­è¿è¡Œï¼Œéšæ—¶å‡†å¤‡æ¥æ”¶åŒæ­¥è¯·æ±‚ã€‚

```
æ™®é€šæ¨¡å¼ vs å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ï¼š

æ™®é€šæ¨¡å¼ï¼ˆä¸´æ—¶æ€§ï¼‰ï¼š
å®¢æˆ·ç«¯ â†’ SSHè¿æ¥ â†’ è¿œç¨‹rsync â†’ åŒæ­¥å®Œæˆ â†’ æ–­å¼€

å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ï¼ˆæœåŠ¡å¼ï¼‰ï¼š
å®¢æˆ·ç«¯ â†’ ç›´è¿873ç«¯å£ â†’ rsyncå®ˆæŠ¤è¿›ç¨‹ â†’ æŒç»­æœåŠ¡
```

**â­ ä¸»è¦ä¼˜åŠ¿**ï¼š
- **æŒç»­æœåŠ¡**ï¼šæ— éœ€æ¯æ¬¡å»ºç«‹SSHè¿æ¥
- **æ€§èƒ½æ›´å¥½**ï¼šä¸“ç”¨ç«¯å£ï¼Œå‡å°‘è®¤è¯å¼€é”€  
- **é…ç½®çµæ´»**ï¼šé€šè¿‡é…ç½®æ–‡ä»¶ç²¾ç¡®æ§åˆ¶
- **è®¿é—®æ§åˆ¶**ï¼šå¯è®¾ç½®å¤šä¸ªå…±äº«æ¨¡å—

### 1.2 å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼


**ğŸ”¸ æ–¹æ³•ä¸€ï¼šç›´æ¥å¯åŠ¨**
```bash
# å¯åŠ¨rsyncå®ˆæŠ¤è¿›ç¨‹ï¼ˆå‰å°è¿è¡Œï¼‰
rsync --daemon --no-detach

# åå°å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹
rsync --daemon

# æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨
rsync --daemon --config=/etc/rsyncd.conf
```

**ğŸ”¸ æ–¹æ³•äºŒï¼šsystemdæœåŠ¡ç®¡ç†**
```bash
# å¯åŠ¨rsyncæœåŠ¡
systemctl start rsyncd

# å¼€æœºè‡ªå¯
systemctl enable rsyncd

# æŸ¥çœ‹çŠ¶æ€
systemctl status rsyncd
```

**æ£€æŸ¥å®ˆæŠ¤è¿›ç¨‹æ˜¯å¦å¯åŠ¨æˆåŠŸ**ï¼š
```bash
# æ£€æŸ¥873ç«¯å£æ˜¯å¦ç›‘å¬
netstat -tlnp | grep 873
# æˆ–è€…
ss -tlnp | grep 873

# è¾“å‡ºç¤ºä¾‹ï¼š
# tcp 0 0 0.0.0.0:873 0.0.0.0:* LISTEN 1234/rsync
```

---

## 2. âš™ï¸ rsyncd.confé…ç½®æ–‡ä»¶è¯¦è§£


### 2.1 é…ç½®æ–‡ä»¶åŸºæœ¬ç»“æ„


**é…ç½®æ–‡ä»¶ä½ç½®**ï¼š`/etc/rsyncd.conf`ï¼ˆå¦‚æœä¸å­˜åœ¨éœ€è¦æ‰‹åŠ¨åˆ›å»ºï¼‰

```
é…ç½®æ–‡ä»¶ç»“æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å…¨å±€é…ç½®æ®µ     â”‚ â† å½±å“æ•´ä¸ªrsyncå®ˆæŠ¤è¿›ç¨‹
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   æ¨¡å—1é…ç½®     â”‚ â† å®šä¹‰å…±äº«ç›®å½•
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   æ¨¡å—2é…ç½®     â”‚ â† å¯å®šä¹‰å¤šä¸ªæ¨¡å—
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 å…¨å±€é…ç½®å‚æ•°è¯¦è§£


**ğŸ”¸ åŸºç¡€é…ç½®ç¤ºä¾‹**ï¼š
```ini
# /etc/rsyncd.conf
# å…¨å±€é…ç½®æ®µ
port = 873                    # ç›‘å¬ç«¯å£ï¼ˆé»˜è®¤873ï¼‰
address = 0.0.0.0            # ç›‘å¬åœ°å€ï¼ˆ0.0.0.0è¡¨ç¤ºæ‰€æœ‰æ¥å£ï¼‰
uid = rsync                  # è¿è¡Œç”¨æˆ·
gid = rsync                  # è¿è¡Œç»„
use chroot = yes             # æ˜¯å¦ä½¿ç”¨chrootï¼ˆå®‰å…¨éš”ç¦»ï¼‰
max connections = 10         # æœ€å¤§å¹¶å‘è¿æ¥æ•°
timeout = 300               # è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
motd file = /etc/rsyncd.motd # æ¬¢è¿ä¿¡æ¯æ–‡ä»¶
log file = /var/log/rsyncd.log # æ—¥å¿—æ–‡ä»¶
pid file = /var/run/rsyncd.pid # PIDæ–‡ä»¶
```

**å‚æ•°å«ä¹‰è¯¦è§£**ï¼š

| å‚æ•° | è¯´æ˜ | æ¨èå€¼ |
|------|------|--------|
| **port** | ç›‘å¬ç«¯å£å· | `873`ï¼ˆé»˜è®¤ï¼‰ |
| **address** | ç»‘å®šIPåœ°å€ | `0.0.0.0`ï¼ˆæ‰€æœ‰ï¼‰æˆ–å…·ä½“IP |
| **uid/gid** | è¿è¡Œç”¨æˆ·/ç»„ | `rsync`æˆ–`nobody` |
| **use chroot** | chrootå®‰å…¨éš”ç¦» | `yes`ï¼ˆæ¨èï¼‰ |
| **max connections** | æœ€å¤§è¿æ¥æ•° | `10-50`ï¼ˆæ ¹æ®éœ€æ±‚ï¼‰ |
| **timeout** | è¿æ¥è¶…æ—¶ | `300`ï¼ˆ5åˆ†é’Ÿï¼‰ |

### 2.3 åˆ›å»ºé…ç½®æ–‡ä»¶å®Œæ•´ç¤ºä¾‹


```bash
# åˆ›å»ºrsyncç”¨æˆ·ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
useradd -r -s /bin/false rsync

# åˆ›å»ºé…ç½®æ–‡ä»¶
cat > /etc/rsyncd.conf << 'EOF'
# rsyncå®ˆæŠ¤è¿›ç¨‹å…¨å±€é…ç½®
port = 873
address = 0.0.0.0
uid = rsync
gid = rsync
use chroot = yes
max connections = 10
timeout = 300
motd file = /etc/rsyncd.motd
log file = /var/log/rsyncd.log
pid file = /var/run/rsyncd.pid

# åŸºæœ¬æ¨¡å—ç¤ºä¾‹ï¼ˆåé¢è¯¦ç»†è®²è§£ï¼‰
[backup]
    path = /data/backup
    comment = Backup Directory
    read only = no
    auth users = backup
    secrets file = /etc/rsyncd.passwd
EOF

# åˆ›å»ºæ¬¢è¿ä¿¡æ¯
echo "Welcome to rsync server" > /etc/rsyncd.motd
```

---

## 3. ğŸ“‚ æ¨¡å—å®šä¹‰ä¸è®¿é—®æ§åˆ¶


### 3.1 ä»€ä¹ˆæ˜¯rsyncæ¨¡å—


**é€šä¿—ç†è§£**ï¼šæ¨¡å—å°±åƒæ˜¯rsyncæœåŠ¡å™¨ä¸Šçš„"å…±äº«æ–‡ä»¶å¤¹"ï¼Œæ¯ä¸ªæ¨¡å—å¯¹åº”ä¸€ä¸ªå¯ä»¥è¢«å®¢æˆ·ç«¯è®¿é—®çš„ç›®å½•ã€‚

```
æ¨¡å—æ¦‚å¿µç¤ºæ„ï¼š
rsyncæœåŠ¡å™¨
â”œâ”€â”€ [backup]     â† æ¨¡å—åï¼ˆå¯¹å¤–æ˜¾ç¤ºï¼‰
â”‚   â””â”€â”€ /data/backup  â† å®é™…ç›®å½•è·¯å¾„
â”œâ”€â”€ [www]
â”‚   â””â”€â”€ /var/www/html
â””â”€â”€ [logs]
    â””â”€â”€ /var/log/apps

å®¢æˆ·ç«¯è®¿é—®ï¼šrsync://server::backup/
```

### 3.2 æ¨¡å—åŸºæœ¬é…ç½®å‚æ•°


**ğŸ”¸ æ ¸å¿ƒé…ç½®ç¤ºä¾‹**ï¼š
```ini
[backup]                     # æ¨¡å—åï¼ˆå®¢æˆ·ç«¯çœ‹åˆ°çš„åç§°ï¼‰
    path = /data/backup     # å®é™…ç›®å½•è·¯å¾„
    comment = Backup files  # æ¨¡å—æè¿°
    read only = no          # æ˜¯å¦åªè¯»ï¼ˆno=å¯è¯»å†™ï¼‰
    list = yes              # æ˜¯å¦å…è®¸åˆ—å‡ºæ¨¡å—
    auth users = backup,admin # å…è®¸è®¿é—®çš„ç”¨æˆ·
    secrets file = /etc/rsyncd.passwd # å¯†ç æ–‡ä»¶
    hosts allow = 192.168.1.0/24     # å…è®¸çš„IPæ®µ
    hosts deny = *          # æ‹’ç»å…¶ä»–æ‰€æœ‰IP
```

**ğŸ”¸ æƒé™æ§åˆ¶å‚æ•°è¯¦è§£**ï¼š

| å‚æ•° | ä½œç”¨ | å€¼ç¤ºä¾‹ |
|------|------|--------|
| **read only** | æ˜¯å¦åªè¯» | `yes`ï¼ˆåªè¯»ï¼‰`no`ï¼ˆè¯»å†™ï¼‰ |
| **write only** | æ˜¯å¦åªå†™ | `yes`ï¼ˆåªå†™ï¼‰`no`ï¼ˆè¯»å†™ï¼‰ |
| **list** | å…è®¸åˆ—å‡ºæ–‡ä»¶ | `yes`ï¼ˆå…è®¸ï¼‰`no`ï¼ˆç¦æ­¢ï¼‰ |
| **upload** | å…è®¸ä¸Šä¼  | `yes`ï¼ˆå…è®¸ï¼‰`no`ï¼ˆç¦æ­¢ï¼‰ |
| **download** | å…è®¸ä¸‹è½½ | `yes`ï¼ˆå…è®¸ï¼‰`no`ï¼ˆç¦æ­¢ï¼‰ |

### 3.3 IPè®¿é—®æ§åˆ¶è¯¦è§£


**ğŸ”¸ hosts allow/denyè§„åˆ™**ï¼š
```ini
# å…è®¸ç‰¹å®šIP
hosts allow = 192.168.1.100

# å…è®¸IPæ®µ
hosts allow = 192.168.1.0/24

# å…è®¸å¤šä¸ªIPæ®µ
hosts allow = 192.168.1.0/24 10.0.0.0/8

# å…è®¸åŸŸå
hosts allow = *.example.com

# ç»„åˆä½¿ç”¨
hosts allow = 192.168.1.0/24 10.0.0.0/8
hosts deny = 192.168.1.50    # æ‹’ç»ç‰¹å®šIP
```

**ğŸ“ è§„åˆ™åŒ¹é…é¡ºåº**ï¼š
1. å…ˆæ£€æŸ¥ `hosts allow`ï¼ˆç™½åå•ï¼‰
2. å†æ£€æŸ¥ `hosts deny`ï¼ˆé»‘åå•ï¼‰
3. å¦‚æœéƒ½æ²¡åŒ¹é…ï¼Œé»˜è®¤å…è®¸

### 3.4 å¤šæ¨¡å—é…ç½®ç¤ºä¾‹


```ini
# å®Œæ•´çš„å¤šæ¨¡å—é…ç½®ç¤ºä¾‹
[backup]
    path = /data/backup
    comment = Daily backup directory
    read only = no
    auth users = backup
    secrets file = /etc/rsyncd.passwd
    hosts allow = 192.168.1.0/24

[www]
    path = /var/www/html
    comment = Web files
    read only = yes          # åªå…è®¸ä¸‹è½½
    list = yes
    # ä¸éœ€è¦è®¤è¯ï¼ˆå…¬å¼€è®¿é—®ï¼‰

[logs]
    path = /var/log/apps
    comment = Application logs
    read only = yes
    auth users = admin
    secrets file = /etc/rsyncd.passwd
    hosts allow = 192.168.1.10 192.168.1.11
```

---

## 4. ğŸ” ç”¨æˆ·è®¤è¯ä¸å¯†ç æ–‡ä»¶


### 4.1 è®¤è¯æœºåˆ¶åŸç†


**è®¤è¯æµç¨‹å›¾**ï¼š
```
å®¢æˆ·ç«¯è¯·æ±‚è®¿é—®æ¨¡å—
         â†“
æ£€æŸ¥æ˜¯å¦éœ€è¦è®¤è¯ï¼ˆauth userså‚æ•°ï¼‰
         â†“
éœ€è¦è®¤è¯ â†’ è¦æ±‚ç”¨æˆ·åå¯†ç 
         â†“
æŸ¥æ‰¾å¯†ç æ–‡ä»¶ï¼ˆsecrets fileï¼‰
         â†“
éªŒè¯æˆåŠŸ â†’ å…è®¸è®¿é—®
```

### 4.2 å¯†ç æ–‡ä»¶åˆ›å»ºä¸ç®¡ç†


**ğŸ”¸ åˆ›å»ºå¯†ç æ–‡ä»¶**ï¼š
```bash
# åˆ›å»ºå¯†ç æ–‡ä»¶
cat > /etc/rsyncd.passwd << 'EOF'
backup:backup123
admin:admin456
readonly:view789
EOF

# è®¾ç½®æ­£ç¡®æƒé™ï¼ˆé‡è¦ï¼ï¼‰
chmod 600 /etc/rsyncd.passwd
chown root:root /etc/rsyncd.passwd
```

**ğŸ“ å¯†ç æ–‡ä»¶æ ¼å¼è¯´æ˜**ï¼š
- **æ ¼å¼**ï¼š`ç”¨æˆ·å:å¯†ç `
- **æƒé™**ï¼šå¿…é¡»æ˜¯ `600`ï¼ˆåªæœ‰rootå¯è¯»å†™ï¼‰
- **ä½ç½®**ï¼šåœ¨é…ç½®æ–‡ä»¶ä¸­ç”¨ `secrets file` æŒ‡å®š

### 4.3 å®¢æˆ·ç«¯è®¤è¯é…ç½®


**ğŸ”¸ äº¤äº’å¼è®¤è¯**ï¼š
```bash
# å®¢æˆ·ç«¯åŒæ­¥ï¼ˆä¼šæç¤ºè¾“å…¥å¯†ç ï¼‰
rsync -avz /local/data/ rsync://backup@server::backup/
```

**ğŸ”¸ å¯†ç æ–‡ä»¶è®¤è¯**ï¼š
```bash
# åˆ›å»ºå®¢æˆ·ç«¯å¯†ç æ–‡ä»¶ï¼ˆåªåŒ…å«å¯†ç ï¼‰
echo "backup123" > /etc/rsync.passwd
chmod 600 /etc/rsync.passwd

# ä½¿ç”¨å¯†ç æ–‡ä»¶åŒæ­¥ï¼ˆä¸ä¼šæç¤ºè¾“å…¥ï¼‰
rsync -avz --password-file=/etc/rsync.passwd /local/data/ rsync://backup@server::backup/
```

**ğŸ”¸ ç¯å¢ƒå˜é‡è®¤è¯**ï¼š
```bash
# è®¾ç½®å¯†ç ç¯å¢ƒå˜é‡
export RSYNC_PASSWORD="backup123"

# åŒæ­¥ï¼ˆä¸éœ€è¦å¯†ç æ–‡ä»¶ï¼‰
rsync -avz /local/data/ rsync://backup@server::backup/
```

### 4.4 å¤šç”¨æˆ·æƒé™ç®¡ç†


**é…ç½®ç¤ºä¾‹**ï¼š
```ini
# ä¸åŒæƒé™çš„ç”¨æˆ·é…ç½®
[backup]
    path = /data/backup
    auth users = backup,admin,readonly
    secrets file = /etc/rsyncd.passwd
    
    # å¯ä»¥ç»“åˆread onlyå‚æ•°ç»†åŒ–æƒé™
    # è¿™é‡Œæ‰€æœ‰è®¤è¯ç”¨æˆ·éƒ½æœ‰è¯»å†™æƒé™

[public]
    path = /data/public
    read only = yes
    # æ— éœ€è®¤è¯ï¼Œä»»ä½•äººéƒ½å¯ä»¥åªè¯»è®¿é—®
```

**å¯†ç æ–‡ä»¶å¯¹åº”**ï¼š
```bash
# /etc/rsyncd.passwd
backup:backup123      # å®Œæ•´æƒé™ç”¨æˆ·
admin:admin456       # ç®¡ç†å‘˜ç”¨æˆ·  
readonly:view789     # åªè¯»ç”¨æˆ·ï¼ˆé€šè¿‡å®¢æˆ·ç«¯æ§åˆ¶ï¼‰
```

---

## 5. ğŸ“Š ä¼ è¾“ç»Ÿè®¡ä¸æ€§èƒ½ä¼˜åŒ–


### 5.1 ä¼ è¾“ç»Ÿè®¡ä¿¡æ¯


**ğŸ”¸ å¯ç”¨è¯¦ç»†ç»Ÿè®¡**ï¼š
```bash
# å®¢æˆ·ç«¯ä½¿ç”¨ç»Ÿè®¡å‚æ•°
rsync -avz --stats --progress /local/ rsync://user@server::backup/

# è¾“å‡ºç¤ºä¾‹ï¼š
# Number of files: 1,234 (reg: 1,200, dir: 34)
# Total file size: 45,678,901 bytes
# Total transferred file size: 12,345,678 bytes
# Literal data: 12,345,678 bytes
# Matched data: 0 bytes
# File list size: 31,234
# Total bytes sent: 12,456,789
# Total bytes received: 8,901
```

**ğŸ”¸ æœåŠ¡å™¨ç«¯æ—¥å¿—é…ç½®**ï¼š
```ini
# åœ¨rsyncd.confä¸­é…ç½®è¯¦ç»†æ—¥å¿—
log file = /var/log/rsyncd.log
log format = %t %a %m %f %b    # æ—¶é—´ åœ°å€ æ¨¡å— æ–‡ä»¶ å­—èŠ‚æ•°
transfer logging = yes         # å¯ç”¨ä¼ è¾“æ—¥å¿—
```

### 5.2 æ€§èƒ½ä¼˜åŒ–å‚æ•°


**ğŸ”¸ å‹ç¼©ä¸åŠ é€Ÿé…ç½®**ï¼š
```bash
# å®¢æˆ·ç«¯ä¼˜åŒ–å‚æ•°
rsync -avz \
  --compress-level=6 \    # å‹ç¼©çº§åˆ«ï¼ˆ1-9ï¼Œ6æ˜¯å¹³è¡¡ç‚¹ï¼‰
  --whole-file \          # ä¼ è¾“æ•´ä¸ªæ–‡ä»¶ï¼ˆå±€åŸŸç½‘æ¨èï¼‰
  --inplace \             # å°±åœ°æ›´æ–°ï¼ˆèŠ‚çœç©ºé—´ï¼‰
  --partial \             # ä¿ç•™éƒ¨åˆ†ä¼ è¾“çš„æ–‡ä»¶
  /source/ rsync://server::backup/
```

**ğŸ”¸ æœåŠ¡å™¨ç«¯æ€§èƒ½é…ç½®**ï¼š
```ini
[backup]
    path = /data/backup
    # æ€§èƒ½ä¼˜åŒ–å‚æ•°
    dont compress = *.gz *.tgz *.zip *.z *.rpm *.deb *.iso
    exclude = temp/ *.tmp *.log
    max connections = 20    # å¢åŠ å¹¶å‘è¿æ¥
    timeout = 600          # å¢åŠ è¶…æ—¶æ—¶é—´
```

### 5.3 å¸¦å®½é™åˆ¶ä¸æµæ§


**ğŸ”¸ é™åˆ¶ä¼ è¾“é€Ÿåº¦**ï¼š
```bash
# é™åˆ¶ä¸º1MB/s
rsync -avz --bwlimit=1000 /source/ rsync://server::backup/

# ä¸åŒæ—¶é—´æ®µä¸åŒé™åˆ¶
rsync -avz --bwlimit=500 /source/ rsync://server::backup/  # ç™½å¤©é™åˆ¶
rsync -avz --bwlimit=2000 /source/ rsync://server::backup/ # æ™šä¸Šæ”¾å®½
```

**ğŸ”¸ æœåŠ¡å™¨ç«¯é™åˆ¶**ï¼š
```ini
[backup]
    path = /data/backup
    # æœåŠ¡å™¨ç«¯é™åˆ¶æ¯ä¸ªè¿æ¥çš„å¸¦å®½
    # æ³¨æ„ï¼šrsyncd.confæœ¬èº«ä¸æ”¯æŒbwlimit
    # éœ€è¦ç»“åˆå…¶ä»–å·¥å…·å¦‚tcï¼ˆæµé‡æ§åˆ¶ï¼‰
```

---

## 6. ğŸ—ƒï¸ rsyncå¤‡ä»½ç­–ç•¥è®¾è®¡


### 6.1 å¤‡ä»½ç­–ç•¥ç±»å‹


**ğŸ“ å¸¸è§å¤‡ä»½ç­–ç•¥å¯¹æ¯”**ï¼š

| ç­–ç•¥ç±»å‹ | è¯´æ˜ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|----------|------|------|------|----------|
| **å®Œæ•´å¤‡ä»½** | æ¯æ¬¡å¤‡ä»½æ‰€æœ‰æ•°æ® | æ¢å¤ç®€å• | å ç”¨ç©ºé—´å¤§ï¼Œæ—¶é—´é•¿ | å°æ•°æ®é‡ï¼Œè¦æ±‚ç®€å• |
| **å¢é‡å¤‡ä»½** | åªå¤‡ä»½å˜åŒ–çš„æ–‡ä»¶ | é€Ÿåº¦å¿«ï¼Œçœç©ºé—´ | æ¢å¤å¤æ‚ | å¤§æ•°æ®é‡ï¼Œé¢‘ç¹å˜åŒ– |
| **å·®å¼‚å¤‡ä»½** | å¤‡ä»½ä¸ä¸Šæ¬¡å®Œæ•´å¤‡ä»½çš„å·®å¼‚ | æ¢å¤ç›¸å¯¹ç®€å• | å ç”¨ç©ºé—´é€æ¸å¢å¤§ | ä¸­ç­‰æ•°æ®é‡ |
| **é•œåƒåŒæ­¥** | ä¿æŒç›®æ ‡ä¸æºå®Œå…¨ä¸€è‡´ | å®æ—¶æ€§å¥½ | è¯¯åˆ ä¼šåŒæ­¥åˆ é™¤ | çƒ­å¤‡ä»½ï¼Œå®¹ç¾ |

### 6.2 å¢é‡å¤‡ä»½ç­–ç•¥å®ç°


**ğŸ”¸ åŸºäºæ—¶é—´æˆ³çš„å¢é‡å¤‡ä»½**ï¼š
```bash
#!/bin/bash
# å¢é‡å¤‡ä»½è„šæœ¬ç¤ºä¾‹

BACKUP_DIR="/backup"
SOURCE_DIR="/data"
DATE=$(date +%Y%m%d)
LAST_BACKUP="$BACKUP_DIR/last_backup"

# åˆ›å»ºä»Šå¤©çš„å¤‡ä»½ç›®å½•
TODAY_BACKUP="$BACKUP_DIR/$DATE"
mkdir -p "$TODAY_BACKUP"

if [ -f "$LAST_BACKUP" ]; then
    # å¢é‡å¤‡ä»½ï¼šåªå¤‡ä»½æ¯”ä¸Šæ¬¡å¤‡ä»½æ–°çš„æ–‡ä»¶
    rsync -avz \
      --backup \
      --backup-dir="$TODAY_BACKUP/deleted" \
      --delete \
      --link-dest="$BACKUP_DIR/$(cat $LAST_BACKUP)" \
      "$SOURCE_DIR/" \
      "$TODAY_BACKUP/"
else
    # é¦–æ¬¡å¤‡ä»½ï¼šå®Œæ•´å¤‡ä»½
    rsync -avz "$SOURCE_DIR/" "$TODAY_BACKUP/"
fi

# è®°å½•æœ¬æ¬¡å¤‡ä»½æ—¶é—´
echo "$DATE" > "$LAST_BACKUP"
```

### 6.3 å¤šç‰ˆæœ¬å¤‡ä»½ä¿ç•™ç­–ç•¥


**ğŸ”¸ ä¿ç•™ç­–ç•¥é…ç½®**ï¼š
```bash
#!/bin/bash
# å¤‡ä»½ä¿ç•™ç­–ç•¥è„šæœ¬

BACKUP_BASE="/backup"

# ä¿ç•™ç­–ç•¥ï¼š
# - æœ€è¿‘7å¤©çš„æ¯æ—¥å¤‡ä»½
# - æœ€è¿‘4å‘¨çš„æ¯å‘¨å¤‡ä»½  
# - æœ€è¿‘12ä¸ªæœˆçš„æ¯æœˆå¤‡ä»½

cleanup_backups() {
    cd "$BACKUP_BASE" || exit 1
    
    # åˆ é™¤7å¤©å‰çš„æ—¥å¤‡ä»½ï¼ˆé™¤äº†å‘¨æ—¥çš„ï¼‰
    find . -name "20*" -type d -mtime +7 \
      ! -name "*07" ! -name "*14" ! -name "*21" ! -name "*28" \
      -exec rm -rf {} \;
    
    # åˆ é™¤4å‘¨å‰çš„å‘¨å¤‡ä»½ï¼ˆé™¤äº†æœˆæœ«çš„ï¼‰
    find . -name "20*" -type d -mtime +28 \
      ! -name "*31" ! -name "*30" ! -name "*29" \
      -exec rm -rf {} \;
    
    # åˆ é™¤12ä¸ªæœˆå‰çš„æœˆå¤‡ä»½
    find . -name "20*" -type d -mtime +365 \
      -exec rm -rf {} \;
}

cleanup_backups
```

### 6.4 å·®å¼‚åŒ–å¤‡ä»½é…ç½®


**ğŸ”¸ ä¸åŒç±»å‹æ–‡ä»¶çš„å¤‡ä»½ç­–ç•¥**ï¼š
```ini
# rsyncd.confä¸­çš„å·®å¼‚åŒ–é…ç½®
[database]
    path = /var/lib/mysql
    comment = Database files
    read only = no
    # æ•°æ®åº“æ–‡ä»¶éœ€è¦ç‰¹æ®Šå¤„ç†
    exclude = *.pid *.sock tmp/

[webfiles]  
    path = /var/www
    comment = Web files
    read only = no
    # æ’é™¤ç¼“å­˜å’Œä¸´æ—¶æ–‡ä»¶
    exclude = cache/ tmp/ *.log

[documents]
    path = /home/*/Documents
    comment = User documents  
    read only = no
    # æ–‡æ¡£å¤‡ä»½ï¼Œæ’é™¤å¤§æ–‡ä»¶
    exclude = *.iso *.mp4 *.mkv
```

---

## 7. â° å®šæ—¶åŒæ­¥ä¸è‡ªåŠ¨åŒ–è„šæœ¬


### 7.1 cronå®šæ—¶ä»»åŠ¡é…ç½®


**ğŸ”¸ åŸºæœ¬å®šæ—¶é…ç½®**ï¼š
```bash
# ç¼–è¾‘crontab
crontab -e

# æ·»åŠ å®šæ—¶ä»»åŠ¡
# æ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œå¤‡ä»½
0 2 * * * /usr/local/bin/rsync_backup.sh

# æ¯å°æ—¶å¢é‡åŒæ­¥
0 * * * * /usr/local/bin/rsync_sync.sh

# æ¯å‘¨æ—¥å‡Œæ™¨3ç‚¹å®Œæ•´å¤‡ä»½
0 3 * * 0 /usr/local/bin/rsync_full_backup.sh
```

**ğŸ“ cronæ—¶é—´æ ¼å¼è¯´æ˜**ï¼š
```
åˆ† æ—¶ æ—¥ æœˆ å‘¨
*  *  *  *  *
â”‚  â”‚  â”‚  â”‚  â””â”€â”€ æ˜ŸæœŸå‡  (0-7, 0å’Œ7éƒ½è¡¨ç¤ºå‘¨æ—¥)
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€ æœˆä»½ (1-12)
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€ æ—¥æœŸ (1-31)
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å°æ—¶ (0-23)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ åˆ†é’Ÿ (0-59)
```

### 7.2 è‡ªåŠ¨åŒ–å¤‡ä»½è„šæœ¬


**ğŸ”¸ æ™ºèƒ½å¤‡ä»½è„šæœ¬**ï¼š
```bash
#!/bin/bash
# /usr/local/bin/smart_rsync_backup.sh

# é…ç½®å˜é‡
CONFIG_FILE="/etc/rsync_backup.conf"
LOG_FILE="/var/log/rsync_backup.log"
LOCK_FILE="/tmp/rsync_backup.lock"

# è¯»å–é…ç½®æ–‡ä»¶
source "$CONFIG_FILE" 2>/dev/null || {
    echo "é…ç½®æ–‡ä»¶ $CONFIG_FILE ä¸å­˜åœ¨ï¼" | tee -a "$LOG_FILE"
    exit 1
}

# é˜²æ­¢é‡å¤è¿è¡Œ
if [ -f "$LOCK_FILE" ]; then
    echo "å¤‡ä»½ä»»åŠ¡å·²åœ¨è¿è¡Œä¸­..." | tee -a "$LOG_FILE"
    exit 1
fi

# åˆ›å»ºé”æ–‡ä»¶
echo $$ > "$LOCK_FILE"

# æ¸…ç†å‡½æ•°
cleanup() {
    rm -f "$LOCK_FILE"
    echo "$(date '+%Y-%m-%d %H:%M:%S') - å¤‡ä»½ä»»åŠ¡ç»“æŸ" >> "$LOG_FILE"
}
trap cleanup EXIT

# è®°å½•å¼€å§‹æ—¶é—´
echo "$(date '+%Y-%m-%d %H:%M:%S') - å¼€å§‹æ‰§è¡Œå¤‡ä»½" >> "$LOG_FILE"

# æ‰§è¡Œå¤‡ä»½
for source in "${BACKUP_SOURCES[@]}"; do
    echo "æ­£åœ¨å¤‡ä»½: $source" >> "$LOG_FILE"
    
    if rsync -avz \
        --delete \
        --stats \
        --password-file="$PASSWORD_FILE" \
        "$source" \
        "$BACKUP_DESTINATION" >> "$LOG_FILE" 2>&1; then
        echo "å¤‡ä»½æˆåŠŸ: $source" >> "$LOG_FILE"
    else
        echo "å¤‡ä»½å¤±è´¥: $source" >> "$LOG_FILE"
        # å‘é€å‘Šè­¦é‚®ä»¶ï¼ˆå¯é€‰ï¼‰
        # echo "å¤‡ä»½å¤±è´¥: $source" | mail -s "å¤‡ä»½å‘Šè­¦" admin@example.com
    fi
done
```

**ğŸ”¸ é…ç½®æ–‡ä»¶ç¤ºä¾‹**ï¼š
```bash
# /etc/rsync_backup.conf
BACKUP_SOURCES=(
    "/home/"
    "/etc/"
    "/var/www/"
    "/opt/apps/"
)
BACKUP_DESTINATION="rsync://backup@backup-server::daily/"
PASSWORD_FILE="/etc/rsync_backup.passwd"
```

### 7.3 ç›‘æ§ä¸å‘Šè­¦æœºåˆ¶


**ğŸ”¸ å¤‡ä»½çŠ¶æ€ç›‘æ§è„šæœ¬**ï¼š
```bash
#!/bin/bash
# å¤‡ä»½çŠ¶æ€æ£€æŸ¥è„šæœ¬

check_backup_status() {
    local log_file="/var/log/rsync_backup.log"
    local today=$(date '+%Y-%m-%d')
    
    # æ£€æŸ¥ä»Šå¤©æ˜¯å¦æœ‰æˆåŠŸçš„å¤‡ä»½è®°å½•
    if grep -q "$today.*å¤‡ä»½æˆåŠŸ" "$log_file"; then
        echo "âœ… ä»Šæ—¥å¤‡ä»½æ­£å¸¸"
        return 0
    else
        echo "âŒ ä»Šæ—¥å¤‡ä»½å¼‚å¸¸æˆ–æœªæ‰§è¡Œ"
        return 1
    fi
}

# æ£€æŸ¥ç£ç›˜ç©ºé—´
check_disk_space() {
    local backup_path="/backup"
    local usage=$(df "$backup_path" | awk 'NR==2{print $5}' | sed 's/%//')
    
    if [ "$usage" -gt 90 ]; then
        echo "âš ï¸  å¤‡ä»½ç£ç›˜ç©ºé—´ä¸è¶³ï¼š${usage}%"
        return 1
    else
        echo "âœ… ç£ç›˜ç©ºé—´å……è¶³ï¼š${usage}%"
        return 0
    fi
}

# ä¸»æ£€æŸ¥é€»è¾‘
check_backup_status
backup_ok=$?

check_disk_space  
disk_ok=$?

# å‘é€é€šçŸ¥ï¼ˆå¤±è´¥æ—¶ï¼‰
if [ $backup_ok -ne 0 ] || [ $disk_ok -ne 0 ]; then
    echo "å¤‡ä»½ç³»ç»Ÿéœ€è¦å…³æ³¨ï¼" | mail -s "å¤‡ä»½ç›‘æ§å‘Šè­¦" admin@example.com
fi
```

---

## 8. ğŸ”§ ç½‘ç»œæ•…éšœå¤„ç†ä¸é‡è¯•æœºåˆ¶


### 8.1 å¸¸è§ç½‘ç»œæ•…éšœç±»å‹


**ğŸ”¸ æ•…éšœç±»å‹ä¸ç°è±¡**ï¼š

| æ•…éšœç±»å‹ | ç°è±¡æè¿° | å¯èƒ½åŸå›  |
|----------|----------|----------|
| **è¿æ¥è¶…æ—¶** | `connection timed out` | ç½‘ç»œä¸é€šï¼Œé˜²ç«å¢™é˜»æŒ¡ |
| **è¿æ¥æ‹’ç»** | `connection refused` | æœåŠ¡æœªå¯åŠ¨ï¼Œç«¯å£é”™è¯¯ |
| **è®¤è¯å¤±è´¥** | `auth failed` | ç”¨æˆ·åå¯†ç é”™è¯¯ï¼Œæƒé™é—®é¢˜ |
| **ä¼ è¾“ä¸­æ–­** | `broken pipe` | ç½‘ç»œä¸ç¨³å®šï¼Œè¿æ¥æ–­å¼€ |
| **æƒé™é”™è¯¯** | `permission denied` | æ–‡ä»¶æƒé™ï¼ŒSELinuxé™åˆ¶ |

### 8.2 ç½‘ç»œæ•…éšœè¯Šæ–­æ­¥éª¤


**ğŸ”¸ ç³»ç»ŸåŒ–è¯Šæ–­æµç¨‹**ï¼š
```bash
#!/bin/bash
# rsyncæ•…éšœè¯Šæ–­è„šæœ¬

diagnose_rsync() {
    local server="$1"
    local port="${2:-873}"
    
    echo "=== rsyncè¿æ¥è¯Šæ–­ ==="
    
    # 1. ç½‘ç»œè¿é€šæ€§æµ‹è¯•
    echo "1. æµ‹è¯•ç½‘ç»œè¿é€šæ€§..."
    if ping -c 3 "$server" >/dev/null 2>&1; then
        echo "âœ… ç½‘ç»œè¿é€šæ­£å¸¸"
    else
        echo "âŒ ç½‘ç»œä¸é€šï¼Œæ£€æŸ¥ç½‘ç»œé…ç½®"
        return 1
    fi
    
    # 2. ç«¯å£è¿é€šæ€§æµ‹è¯•  
    echo "2. æµ‹è¯•ç«¯å£è¿é€šæ€§..."
    if nc -z "$server" "$port" 2>/dev/null; then
        echo "âœ… ç«¯å£ $port è¿é€šæ­£å¸¸"
    else
        echo "âŒ ç«¯å£ $port ä¸é€šï¼Œæ£€æŸ¥é˜²ç«å¢™å’ŒæœåŠ¡çŠ¶æ€"
        return 1
    fi
    
    # 3. rsyncæœåŠ¡æµ‹è¯•
    echo "3. æµ‹è¯•rsyncæœåŠ¡..."
    if rsync --list-only rsync://"$server"/ >/dev/null 2>&1; then
        echo "âœ… rsyncæœåŠ¡æ­£å¸¸"
    else
        echo "âŒ rsyncæœåŠ¡å¼‚å¸¸ï¼Œæ£€æŸ¥é…ç½®"
        return 1
    fi
    
    echo "âœ… è¯Šæ–­å®Œæˆï¼ŒæœåŠ¡æ­£å¸¸"
}

# ä½¿ç”¨ç¤ºä¾‹
diagnose_rsync "backup-server.example.com"
```

### 8.3 è‡ªåŠ¨é‡è¯•æœºåˆ¶å®ç°


**ğŸ”¸ æ™ºèƒ½é‡è¯•è„šæœ¬**ï¼š
```bash
#!/bin/bash
# å¸¦é‡è¯•æœºåˆ¶çš„rsyncåŒæ­¥è„šæœ¬

# é…ç½®å‚æ•°
MAX_RETRY=3           # æœ€å¤§é‡è¯•æ¬¡æ•°
RETRY_DELAY=30        # é‡è¯•é—´éš”ï¼ˆç§’ï¼‰
TIMEOUT=300           # å•æ¬¡è¶…æ—¶ï¼ˆç§’ï¼‰

# é‡è¯•å‡½æ•°
rsync_with_retry() {
    local source="$1"
    local destination="$2" 
    local retry_count=0
    
    while [ $retry_count -lt $MAX_RETRY ]; do
        echo "å°è¯•åŒæ­¥ (ç¬¬ $((retry_count + 1)) æ¬¡)..."
        
        if timeout $TIMEOUT rsync -avz \
            --partial \
            --inplace \
            --password-file=/etc/rsync.passwd \
            "$source" "$destination"; then
            echo "âœ… åŒæ­¥æˆåŠŸ"
            return 0
        else
            retry_count=$((retry_count + 1))
            if [ $retry_count -lt $MAX_RETRY ]; then
                echo "âŒ åŒæ­¥å¤±è´¥ï¼Œ$RETRY_DELAY ç§’åé‡è¯•..."
                sleep $RETRY_DELAY
            fi
        fi
    done
    
    echo "âŒ è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°ï¼ŒåŒæ­¥å¤±è´¥"
    return 1
}

# ä½¿ç”¨ç¤ºä¾‹
rsync_with_retry "/local/data/" "rsync://backup@server::backup/"
```

### 8.4 ç½‘ç»œä¼˜åŒ–é…ç½®


**ğŸ”¸ ä¸ç¨³å®šç½‘ç»œä¼˜åŒ–å‚æ•°**ï¼š
```bash
# é’ˆå¯¹ä¸ç¨³å®šç½‘ç»œçš„rsyncä¼˜åŒ–
rsync -avz \
  --timeout=60 \           # å‡å°‘è¶…æ—¶æ—¶é—´
  --contimeout=10 \        # è¿æ¥è¶…æ—¶æ—¶é—´
  --partial \              # ä¿ç•™éƒ¨åˆ†ä¼ è¾“æ–‡ä»¶
  --inplace \              # å°±åœ°æ›´æ–°ï¼ˆå‡å°‘ç½‘ç»œä¸­æ–­å½±å“ï¼‰
  --compress-level=1 \     # é™ä½å‹ç¼©çº§åˆ«ï¼ˆå‡å°‘CPUè´Ÿè½½ï¼‰
  --bwlimit=1000 \         # é™åˆ¶å¸¦å®½ï¼ˆé¿å…ç½‘ç»œæ‹¥å¡ï¼‰
  /source/ rsync://server::backup/
```

**ğŸ”¸ æœåŠ¡å™¨ç«¯ç¨³å®šæ€§é…ç½®**ï¼š
```ini
# rsyncd.confä¼˜åŒ–é…ç½®
port = 873
max connections = 5      # é™åˆ¶å¹¶å‘ï¼ˆé¿å…è¿‡è½½ï¼‰
timeout = 120           # é€‚ä¸­çš„è¶…æ—¶æ—¶é—´
socket options = SO_KEEPALIVE

[backup]
    path = /backup
    timeout = 300       # æ¨¡å—çº§è¶…æ—¶è®¾ç½®
    # é¿å…ä¼ è¾“å¤§æ–‡ä»¶å¯¼è‡´çš„è¶…æ—¶
```

### 8.5 æ•…éšœæ¢å¤ç­–ç•¥


**ğŸ”¸ æ–­ç‚¹ç»­ä¼ æœºåˆ¶**ï¼š
```bash
#!/bin/bash
# æ–­ç‚¹ç»­ä¼ å¤‡ä»½è„šæœ¬

TEMP_DIR="/tmp/rsync_partial"
BACKUP_LIST="/tmp/backup_list.txt"

# åˆ›å»ºä¸´æ—¶ç›®å½•
mkdir -p "$TEMP_DIR"

# ç”Ÿæˆå¾…å¤‡ä»½æ–‡ä»¶åˆ—è¡¨
find /source -type f -newer /backup/.last_backup > "$BACKUP_LIST"

# é€ä¸ªæ–‡ä»¶å¤„ç†ï¼ˆæ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼‰
while read -r file; do
    relative_path="${file#/source/}"
    
    # ä½¿ç”¨--partialå‚æ•°æ”¯æŒæ–­ç‚¹ç»­ä¼ 
    if rsync -avz \
        --partial \
        --partial-dir="$TEMP_DIR" \
        --timeout=60 \
        "$file" \
        "rsync://backup@server::backup/$relative_path"; then
        echo "âœ… $file å¤‡ä»½æˆåŠŸ"
    else
        echo "âŒ $file å¤‡ä»½å¤±è´¥ï¼Œå·²ä¿å­˜æ–­ç‚¹"
    fi
done < "$BACKUP_LIST"

# æ›´æ–°æ—¶é—´æˆ³
touch /backup/.last_backup
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ï¼šrsyncä½œä¸ºæœåŠ¡æŒç»­è¿è¡Œï¼Œæä¾›ä¸“ä¸šåŒæ­¥æœåŠ¡
ğŸ”¸ é…ç½®æ–‡ä»¶ç»“æ„ï¼šå…¨å±€é…ç½® + æ¨¡å—é…ç½®çš„å±‚æ¬¡åŒ–ç®¡ç†
ğŸ”¸ æ¨¡å—æ¦‚å¿µï¼šç±»ä¼¼å…±äº«æ–‡ä»¶å¤¹ï¼Œæ¯ä¸ªæ¨¡å—å¯¹åº”ä¸€ä¸ªå¯è®¿é—®ç›®å½•
ğŸ”¸ è®¤è¯æœºåˆ¶ï¼šç”¨æˆ·åå¯†ç éªŒè¯ï¼Œä¿éšœæ•°æ®å®‰å…¨
ğŸ”¸ æ€§èƒ½ä¼˜åŒ–ï¼šå‹ç¼©ã€å¹¶å‘ã€å¸¦å®½æ§åˆ¶ç­‰å¤šç»´åº¦ä¼˜åŒ–
ğŸ”¸ å¤‡ä»½ç­–ç•¥ï¼šå®Œæ•´ã€å¢é‡ã€å·®å¼‚ç­‰ä¸åŒç­–ç•¥çš„é€‰æ‹©
ğŸ”¸ è‡ªåŠ¨åŒ–è¿ç»´ï¼šå®šæ—¶ä»»åŠ¡ã€ç›‘æ§å‘Šè­¦ã€æ•…éšœæ¢å¤
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼çš„ä»·å€¼**
```
ç†è§£è¦ç‚¹ï¼š
- å®ˆæŠ¤è¿›ç¨‹ = ä¸“ä¸šæœåŠ¡ï¼Œæ¯”SSHæ–¹å¼æ›´é«˜æ•ˆ
- ç»Ÿä¸€ç®¡ç†å¤šä¸ªåŒæ­¥ä»»åŠ¡å’Œæƒé™æ§åˆ¶
- æ”¯æŒå¹¶å‘è¿æ¥ï¼Œæé«˜åŒæ­¥æ•ˆç‡
```

**ğŸ”¹ é…ç½®æ–‡ä»¶çš„æ ¸å¿ƒä½œç”¨**
```
é…ç½®é€»è¾‘ï¼š
- å…¨å±€å‚æ•°æ§åˆ¶æ•´ä½“è¡Œä¸º
- æ¨¡å—å‚æ•°æ§åˆ¶å…·ä½“å…±äº«ç›®å½•
- å®‰å…¨å‚æ•°ç¡®ä¿è®¿é—®æ§åˆ¶
```

**ğŸ”¹ å¤‡ä»½ç­–ç•¥çš„é€‰æ‹©åŸåˆ™**
```
é€‰æ‹©ä¾æ®ï¼š
- æ•°æ®é‡å¤§å°ï¼šå°æ•°æ®å®Œæ•´å¤‡ä»½ï¼Œå¤§æ•°æ®å¢é‡å¤‡ä»½
- å˜åŒ–é¢‘ç‡ï¼šé¢‘ç¹å˜åŒ–ç”¨å¢é‡ï¼Œå¶å°”å˜åŒ–ç”¨å®Œæ•´
- æ¢å¤è¦æ±‚ï¼šè¦æ±‚ç®€å•ç”¨é•œåƒï¼Œè¦æ±‚å†å²ç”¨ç‰ˆæœ¬å¤‡ä»½
```

### 9.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ ä¼ä¸šçº§åº”ç”¨åœºæ™¯**
- **æ•°æ®ä¸­å¿ƒå¤‡ä»½**ï¼šå¤šæœåŠ¡å™¨æ•°æ®ç»Ÿä¸€å¤‡ä»½ç®¡ç†
- **ç½‘ç«™å†…å®¹åŒæ­¥**ï¼šå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒå†…å®¹åŒæ­¥
- **æ—¥å¿—æ”¶é›†**ï¼šé›†ä¸­æ”¶é›†å„æœåŠ¡å™¨æ—¥å¿—æ–‡ä»¶
- **ä»£ç éƒ¨ç½²**ï¼šè‡ªåŠ¨åŒ–ä»£ç åˆ†å‘å’Œæ›´æ–°

**ğŸ”§ è¿ç»´å®è·µè¦ç‚¹**
- **å®‰å…¨ç¬¬ä¸€**ï¼šåˆç†è®¾ç½®ç”¨æˆ·æƒé™å’ŒIPè®¿é—®æ§åˆ¶
- **æ€§èƒ½ä¼˜åŒ–**ï¼šæ ¹æ®ç½‘ç»œç¯å¢ƒè°ƒæ•´ä¼ è¾“å‚æ•°
- **ç›‘æ§å‘Šè­¦**ï¼šåŠæ—¶å‘ç°å¹¶å¤„ç†å¤‡ä»½å¼‚å¸¸
- **å®¹ç¾æ¢å¤**ï¼šåˆ¶å®šå®Œå–„çš„æ•…éšœæ¢å¤æµç¨‹

### 9.4 å¸¸è§é—®é¢˜ä¸è§£å†³æ€è·¯


**â“ è®¤è¯å¤±è´¥é—®é¢˜**
- æ£€æŸ¥å¯†ç æ–‡ä»¶æƒé™ï¼ˆå¿…é¡»600ï¼‰
- éªŒè¯ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®
- ç¡®è®¤secrets fileè·¯å¾„é…ç½®

**â“ ä¼ è¾“é€Ÿåº¦æ…¢**
- è°ƒæ•´å‹ç¼©çº§åˆ«å’Œå¹¶å‘æ•°
- æ£€æŸ¥ç½‘ç»œå¸¦å®½å’Œå»¶è¿Ÿ
- ä½¿ç”¨--whole-fileå‚æ•°ï¼ˆå±€åŸŸç½‘ï¼‰

**â“ åŒæ­¥ä¸­æ–­é—®é¢˜**
- å¯ç”¨--partialä¿ç•™éƒ¨åˆ†æ–‡ä»¶
- å¢åŠ é‡è¯•æœºåˆ¶å’Œæ–­ç‚¹ç»­ä¼ 
- ä¼˜åŒ–ç½‘ç»œå‚æ•°å’Œè¶…æ—¶è®¾ç½®

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- rsyncå®ˆæŠ¤è¿›ç¨‹æä¾›ä¸“ä¸šåŒæ­¥æœåŠ¡
- é…ç½®æ–‡ä»¶æ˜¯åŠŸèƒ½æ§åˆ¶çš„æ ¸å¿ƒ
- å®‰å…¨è®¤è¯å’Œæ€§èƒ½ä¼˜åŒ–åŒæ ·é‡è¦  
- è‡ªåŠ¨åŒ–å’Œç›‘æ§æ˜¯è¿ç»´å¿…å¤‡æŠ€èƒ½