---
title: 20ã€ç³»ç»Ÿç›‘æ§æ•°æ®å¤„ç†
---
## ğŸ“š ç›®å½•

1. [ç³»ç»Ÿæ€§èƒ½æ•°æ®æå–](#1-ç³»ç»Ÿæ€§èƒ½æ•°æ®æå–)
2. [ç›‘æ§æŒ‡æ ‡ç»Ÿè®¡è®¡ç®—](#2-ç›‘æ§æŒ‡æ ‡ç»Ÿè®¡è®¡ç®—)
3. [å¼‚å¸¸æ•°æ®è¯†åˆ«æ ‡è®°](#3-å¼‚å¸¸æ•°æ®è¯†åˆ«æ ‡è®°)
4. [å†å²æ•°æ®è¶‹åŠ¿åˆ†æ](#4-å†å²æ•°æ®è¶‹åŠ¿åˆ†æ)
5. [ç›‘æ§æŠ¥è¡¨è‡ªåŠ¨ç”Ÿæˆ](#5-ç›‘æ§æŠ¥è¡¨è‡ªåŠ¨ç”Ÿæˆ)
6. [å®æ—¶æ•°æ®æµå¤„ç†](#6-å®æ—¶æ•°æ®æµå¤„ç†)
7. [ç›‘æ§æ•°æ®å­˜å‚¨ä¼˜åŒ–](#7-ç›‘æ§æ•°æ®å­˜å‚¨ä¼˜åŒ–)
8. [å‘Šè­¦é˜ˆå€¼æ•°æ®åˆ†æ](#8-å‘Šè­¦é˜ˆå€¼æ•°æ®åˆ†æ)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ’» ç³»ç»Ÿæ€§èƒ½æ•°æ®æå–


### 1.1 ä»€ä¹ˆæ˜¯ç³»ç»Ÿæ€§èƒ½æ•°æ®æå–


**ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ**
ç³»ç»Ÿæ€§èƒ½æ•°æ®æå–å°±æ˜¯**ä»Linuxç³»ç»Ÿä¸­è·å–å„ç§æ€§èƒ½æŒ‡æ ‡çš„æ•°æ®**ï¼Œæ¯”å¦‚CPUä½¿ç”¨ç‡ã€å†…å­˜å ç”¨ã€ç£ç›˜IOç­‰ã€‚è¿™å°±åƒåŒ»ç”Ÿç»™ç—…äººä½“æ£€æ—¶æµ‹é‡è¡€å‹ã€å¿ƒè·³ä¸€æ ·ï¼Œæˆ‘ä»¬è¦å®šæœŸ"ä½“æ£€"æœåŠ¡å™¨çš„å¥åº·çŠ¶å†µã€‚

**ğŸ”¸ ä¸ºä»€ä¹ˆéœ€è¦æå–æ€§èƒ½æ•°æ®ï¼Ÿ**
- **å‘ç°é—®é¢˜**ï¼šæœåŠ¡å™¨è¿è¡Œæ…¢äº†ï¼Œåˆ°åº•æ˜¯å“ªé‡Œå‡ºé—®é¢˜ï¼Ÿ
- **é¢„é˜²æ•…éšœ**ï¼šåœ¨ç³»ç»Ÿå´©æºƒå‰æå‰å‘ç°å¼‚å¸¸
- **ä¼˜åŒ–æ€§èƒ½**ï¼šæ‰¾å‡ºæ€§èƒ½ç“¶é¢ˆï¼Œé’ˆå¯¹æ€§æ”¹è¿›
- **èµ„æºè§„åˆ’**ï¼šäº†è§£èµ„æºä½¿ç”¨æƒ…å†µï¼Œåˆç†åˆ†é…

### 1.2 ä¸»è¦æ•°æ®æºä¸æå–æ–¹æ³•


**ğŸ“Š æ ¸å¿ƒæ•°æ®æºåˆ†å¸ƒå›¾**
```
ç³»ç»Ÿæ€§èƒ½æ•°æ®æº
â”œâ”€â”€ /proc è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ
â”‚   â”œâ”€â”€ /proc/cpuinfo     â† CPUä¿¡æ¯
â”‚   â”œâ”€â”€ /proc/meminfo     â† å†…å­˜ä¿¡æ¯  
â”‚   â”œâ”€â”€ /proc/stat        â† ç³»ç»Ÿç»Ÿè®¡
â”‚   â””â”€â”€ /proc/loadavg     â† ç³»ç»Ÿè´Ÿè½½
â”œâ”€â”€ /sys ç³»ç»Ÿä¿¡æ¯æ¥å£
â”‚   â”œâ”€â”€ /sys/class/net/   â† ç½‘ç»œæ¥å£
â”‚   â””â”€â”€ /sys/block/       â† å—è®¾å¤‡ä¿¡æ¯
â””â”€â”€ ç³»ç»Ÿå‘½ä»¤å·¥å…·
    â”œâ”€â”€ ps, top, htop     â† è¿›ç¨‹ç›‘æ§
    â”œâ”€â”€ iostat, vmstat    â† IOå’Œå†…å­˜ç»Ÿè®¡
    â””â”€â”€ sar, mpstat       â† ç³»ç»Ÿæ´»åŠ¨æŠ¥å‘Š
```

**âš¡ CPUæ€§èƒ½æ•°æ®æå–**

***åŸºç¡€æ¦‚å¿µ***ï¼šCPUä½¿ç”¨ç‡åæ˜ å¤„ç†å™¨çš„ç¹å¿™ç¨‹åº¦ï¼ŒåŒ…æ‹¬ç”¨æˆ·æ€ã€ç³»ç»Ÿæ€ã€ç©ºé—²çŠ¶æ€ç­‰ä¸åŒç»´åº¦ã€‚

```bash
# æ–¹æ³•1ï¼šä½¿ç”¨ top å‘½ä»¤å®æ—¶æŸ¥çœ‹
top -bn1 | head -3

# æ–¹æ³•2ï¼šä» /proc/stat ç›´æ¥è¯»å–
cat /proc/stat | head -1

# æ–¹æ³•3ï¼šä½¿ç”¨ vmstat è·å–ç»Ÿè®¡ä¿¡æ¯
vmstat 1 5  # æ¯ç§’é‡‡æ ·1æ¬¡ï¼Œå…±5æ¬¡
```

**ğŸ’¡ æ•°æ®æå–å®ç”¨æŠ€å·§**
```bash
# æå–CPUä½¿ç”¨ç‡ç™¾åˆ†æ¯”ï¼ˆæ’é™¤ç©ºé—²ï¼‰
cpu_usage=$(top -bn1 | grep "Cpu(s)" | awk '{print 100-$8}')
echo "CPUä½¿ç”¨ç‡: ${cpu_usage}%"

# è·å–ç³»ç»Ÿè´Ÿè½½ï¼ˆ1åˆ†é’Ÿã€5åˆ†é’Ÿã€15åˆ†é’Ÿå¹³å‡å€¼ï¼‰
load_avg=$(cat /proc/loadavg | awk '{print $1,$2,$3}')
echo "ç³»ç»Ÿè´Ÿè½½: $load_avg"
```

**ğŸ’¾ å†…å­˜æ€§èƒ½æ•°æ®æå–**

***åŸºç¡€æ¦‚å¿µ***ï¼šå†…å­˜ä½¿ç”¨æƒ…å†µåŒ…æ‹¬æ€»å†…å­˜ã€å·²ç”¨å†…å­˜ã€å¯ç”¨å†…å­˜ã€ç¼“å­˜ã€äº¤æ¢åˆ†åŒºç­‰å¤šä¸ªæŒ‡æ ‡ã€‚

| **æŒ‡æ ‡ç±»å‹** | **å«ä¹‰è¯´æ˜** | **è·å–æ–¹å¼** | **é‡è¦ç¨‹åº¦** |
|------------|------------|------------|------------|
| **æ€»å†…å­˜** | `ç³»ç»Ÿæ€»å…±çš„ç‰©ç†å†…å­˜å¤§å°` | `/proc/meminfo` | ğŸ”´é«˜ |
| **å·²ç”¨å†…å­˜** | `å½“å‰è¢«å ç”¨çš„å†…å­˜é‡` | `freeå‘½ä»¤è®¡ç®—` | ğŸ”´é«˜ |
| **å¯ç”¨å†…å­˜** | `çœŸæ­£å¯ä¾›ç¨‹åºä½¿ç”¨çš„å†…å­˜` | `MemAvailableå­—æ®µ` | ğŸ”´é«˜ |
| **ç¼“å­˜å†…å­˜** | `ç³»ç»Ÿç”¨äºç¼“å­˜çš„å†…å­˜` | `Cachedå­—æ®µ` | ğŸŸ¡ä¸­ |
| **äº¤æ¢å†…å­˜** | `è™šæ‹Ÿå†…å­˜ä½¿ç”¨æƒ…å†µ` | `SwapTotal/SwapFree` | ğŸŸ¡ä¸­ |

```bash
# å†…å­˜ä¿¡æ¯ä¸€è§ˆ
free -h  # äººæ€§åŒ–æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ

# æå–å…³é”®å†…å­˜æŒ‡æ ‡
mem_total=$(cat /proc/meminfo | grep MemTotal | awk '{print $2}')
mem_available=$(cat /proc/meminfo | grep MemAvailable | awk '{print $2}')
mem_usage_percent=$(echo "scale=2; ($mem_total-$mem_available)*100/$mem_total" | bc)
```

### 1.3 ç£ç›˜IOæ€§èƒ½æ•°æ®


**ğŸ”¸ ç£ç›˜IOåŸºæœ¬æ¦‚å¿µ**

ç£ç›˜IOæ€§èƒ½åæ˜ å­˜å‚¨ç³»ç»Ÿçš„è¯»å†™èƒ½åŠ›ï¼ŒåŒ…æ‹¬ï¼š
- **IOPS**ï¼šæ¯ç§’è¿›è¡Œçš„IOæ“ä½œæ¬¡æ•°
- **ååé‡**ï¼šæ¯ç§’ä¼ è¾“çš„æ•°æ®é‡
- **å»¶è¿Ÿ**ï¼šå•æ¬¡IOæ“ä½œçš„å“åº”æ—¶é—´
- **é˜Ÿåˆ—æ·±åº¦**ï¼šç­‰å¾…å¤„ç†çš„IOè¯·æ±‚æ•°é‡

**ğŸ“ˆ IOç›‘æ§æ•°æ®æµç¨‹**
```
åº”ç”¨ç¨‹åºå‘èµ·IOè¯·æ±‚
         â†“
    å†…æ ¸IOè°ƒåº¦å™¨
         â†“
    ç£ç›˜æ§åˆ¶å™¨å¤„ç†
         â†“
    æ•°æ®è¯»å†™å®Œæˆ
         â†“
    æ›´æ–°/proc/diskstatsç»Ÿè®¡
```

```bash
# ä½¿ç”¨ iostat ç›‘æ§ç£ç›˜IO
iostat -x 1 3  # æ‰©å±•æ ¼å¼ï¼Œ1ç§’é—´éš”ï¼Œ3æ¬¡é‡‡æ ·

# æå–ç‰¹å®šç£ç›˜çš„å…³é”®æŒ‡æ ‡
disk_util=$(iostat -x 1 1 | grep sda | awk '{print $10}')
echo "ç£ç›˜åˆ©ç”¨ç‡: ${disk_util}%"
```

---

## 2. ğŸ“Š ç›‘æ§æŒ‡æ ‡ç»Ÿè®¡è®¡ç®—


### 2.1 ç»Ÿè®¡è®¡ç®—çš„æ ¸å¿ƒä½œç”¨


**ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦ç»Ÿè®¡è®¡ç®—ï¼Ÿ**
åŸå§‹çš„æ€§èƒ½æ•°æ®å°±åƒä¸€å †æ•£ä¹±çš„æ•°å­—ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ç»Ÿè®¡è®¡ç®—æŠŠè¿™äº›æ•°å­—å˜æˆ**æœ‰æ„ä¹‰çš„ä¿¡æ¯**ã€‚æ¯”å¦‚ï¼š
- æŠŠç¬æ—¶CPUä½¿ç”¨ç‡å˜æˆ**å¹³å‡ä½¿ç”¨ç‡**
- è®¡ç®—å†…å­˜ä½¿ç”¨çš„**å¢é•¿è¶‹åŠ¿**
- ç»Ÿè®¡ç½‘ç»œæµé‡çš„**å³°å€¼å’Œè°·å€¼**

### 2.2 å¸¸ç”¨ç»Ÿè®¡æ–¹æ³•è¯¦è§£


**ğŸ“Š åŸºç¡€ç»Ÿè®¡é‡è®¡ç®—**

***å¹³å‡å€¼è®¡ç®—***ï¼šåæ˜ æ•°æ®çš„é›†ä¸­è¶‹åŠ¿
```bash
# è®¡ç®—5åˆ†é’Ÿå†…CPUå¹³å‡ä½¿ç”¨ç‡
cpu_samples=(45.2 52.1 38.7 41.3 47.8)
total=0
count=0
for value in "${cpu_samples[@]}"; do
    total=$(echo "$total + $value" | bc)
    count=$((count + 1))
done
average=$(echo "scale=2; $total / $count" | bc)
echo "CPUå¹³å‡ä½¿ç”¨ç‡: ${average}%"
```

***ç™¾åˆ†ä½æ•°è®¡ç®—***ï¼šäº†è§£æ•°æ®åˆ†å¸ƒæƒ…å†µ
```bash
# ä½¿ç”¨ awk è®¡ç®—ç¬¬90ç™¾åˆ†ä½æ•°
echo "45.2 52.1 38.7 41.3 47.8 89.1 12.4 67.3" | \
tr ' ' '\n' | sort -n | \
awk '{values[NR]=$1} END {print "90th percentile:", values[int(NR*0.9)]}'
```

### 2.3 æ—¶é—´åºåˆ—æ•°æ®å¤„ç†


**â° æ—¶é—´çª—å£ç»Ÿè®¡æ¦‚å¿µ**

æ—¶é—´çª—å£å°±æ˜¯**æŠŠæ—¶é—´åˆ†æˆä¸€æ®µä¸€æ®µæ¥ç»Ÿè®¡**ï¼Œæ¯”å¦‚æ¯5åˆ†é’Ÿç»Ÿè®¡ä¸€æ¬¡å¹³å‡å€¼ï¼Œæ¯å°æ—¶ç»Ÿè®¡ä¸€æ¬¡æœ€å¤§å€¼ã€‚

**ğŸ”¸ æ»‘åŠ¨çª—å£vså›ºå®šçª—å£**
```
å›ºå®šçª—å£ï¼ˆæ¯å°æ—¶ç»Ÿè®¡ï¼‰ï¼š
[00:00-01:00] [01:00-02:00] [02:00-03:00]
     â†“             â†“             â†“
   ç»Ÿè®¡1         ç»Ÿè®¡2         ç»Ÿè®¡3

æ»‘åŠ¨çª—å£ï¼ˆè¿‡å»1å°æ—¶çš„æ•°æ®ï¼‰ï¼š
[00:00-01:00] â†’ [00:05-01:05] â†’ [00:10-01:10]
     â†“               â†“               â†“
   ç»Ÿè®¡1           ç»Ÿè®¡2           ç»Ÿè®¡3
```

**ğŸ“ˆ å®ç”¨ç»Ÿè®¡è„šæœ¬ç¤ºä¾‹**
```bash
#!/bin/bash
# ç³»ç»Ÿæ€§èƒ½ç»Ÿè®¡è®¡ç®—è„šæœ¬

# åˆ›å»ºä¸´æ—¶æ–‡ä»¶å­˜å‚¨æ•°æ®
temp_file="/tmp/performance_data.log"

# æ”¶é›†10æ¬¡CPUæ•°æ®ï¼Œæ¯æ¬¡é—´éš”1ç§’
for i in {1..10}; do
    cpu_idle=$(top -bn1 | grep "Cpu(s)" | awk '{print $8}' | cut -d'%' -f1)
    cpu_usage=$(echo "100 - $cpu_idle" | bc)
    timestamp=$(date +"%H:%M:%S")
    echo "$timestamp $cpu_usage" >> $temp_file
    sleep 1
done

# è®¡ç®—ç»Ÿè®¡å€¼
echo "=== CPUä½¿ç”¨ç‡ç»Ÿè®¡æŠ¥å‘Š ==="
echo "ğŸ“Š åŸå§‹æ•°æ®ï¼š"
cat $temp_file

echo "ğŸ“ˆ ç»Ÿè®¡ç»“æœï¼š"
# æœ€å¤§å€¼
max_usage=$(awk '{print $2}' $temp_file | sort -nr | head -1)
# æœ€å°å€¼  
min_usage=$(awk '{print $2}' $temp_file | sort -n | head -1)
# å¹³å‡å€¼
avg_usage=$(awk '{sum+=$2} END {print sum/NR}' $temp_file)

echo "æœ€å¤§å€¼: ${max_usage}%"
echo "æœ€å°å€¼: ${min_usage}%"
echo "å¹³å‡å€¼: $(printf "%.2f" $avg_usage)%"

# æ¸…ç†ä¸´æ—¶æ–‡ä»¶
rm $temp_file
```

### 2.4 å¤šç»´åº¦æŒ‡æ ‡èšåˆ


**ğŸ¯ ä»€ä¹ˆæ˜¯å¤šç»´åº¦èšåˆï¼Ÿ**

å°±æ˜¯**åŒæ—¶ç»Ÿè®¡å¤šä¸ªæ€§èƒ½æŒ‡æ ‡**ï¼Œç„¶åç»¼åˆåˆ†æã€‚æ¯”å¦‚åŒæ—¶çœ‹CPUã€å†…å­˜ã€ç£ç›˜çš„ä½¿ç”¨æƒ…å†µï¼Œè€Œä¸æ˜¯å•ç‹¬çœ‹æŸä¸€ä¸ªæŒ‡æ ‡ã€‚

**ğŸ“‹ ç³»ç»Ÿè´Ÿè½½ç»¼åˆè¯„åˆ†**
```bash
#!/bin/bash
# ç³»ç»Ÿæ€§èƒ½ç»¼åˆè¯„åˆ†è®¡ç®—

calculate_system_score() {
    # è·å–å„é¡¹æŒ‡æ ‡
    cpu_usage=$(top -bn1 | grep "Cpu(s)" | awk '{print 100-$8}')
    mem_usage=$(free | grep Mem | awk '{print ($3/$2)*100}')
    disk_usage=$(df / | tail -1 | awk '{print $(NF-1)}' | sed 's/%//')
    load_avg=$(cat /proc/loadavg | awk '{print $1}')
    
    # è®¡ç®—å„é¡¹å¾—åˆ†ï¼ˆ100åˆ†åˆ¶ï¼Œä½¿ç”¨ç‡è¶Šä½å¾—åˆ†è¶Šé«˜ï¼‰
    cpu_score=$(echo "100 - $cpu_usage" | bc)
    mem_score=$(echo "100 - $mem_usage" | bc)
    disk_score=$(echo "100 - $disk_usage" | bc)
    
    # è´Ÿè½½å¾—åˆ†ï¼ˆè´Ÿè½½è¶Šä½å¾—åˆ†è¶Šé«˜ï¼Œä»¥4æ ¸ä¸ºåŸºå‡†ï¼‰
    load_score=$(echo "scale=2; (4 - $load_avg) * 25" | bc)
    
    # ç»¼åˆå¾—åˆ†ï¼ˆæƒé‡ï¼šCPU 30%, å†…å­˜ 25%, ç£ç›˜ 25%, è´Ÿè½½ 20%ï¼‰
    total_score=$(echo "scale=2; $cpu_score*0.3 + $mem_score*0.25 + $disk_score*0.25 + $load_score*0.2" | bc)
    
    echo "ğŸ¯ ç³»ç»Ÿæ€§èƒ½ç»¼åˆæŠ¥å‘Š"
    echo "CPUä½¿ç”¨ç‡: ${cpu_usage}% (å¾—åˆ†: $(printf "%.1f" $cpu_score))"
    echo "å†…å­˜ä½¿ç”¨ç‡: $(printf "%.1f" $mem_usage)% (å¾—åˆ†: $(printf "%.1f" $mem_score))"
    echo "ç£ç›˜ä½¿ç”¨ç‡: ${disk_usage}% (å¾—åˆ†: $(printf "%.1f" $disk_score))"
    echo "ç³»ç»Ÿè´Ÿè½½: $load_avg (å¾—åˆ†: $(printf "%.1f" $load_score))"
    echo "ç»¼åˆå¾—åˆ†: $(printf "%.1f" $total_score)/100"
}
```

---

## 3. ğŸš¨ å¼‚å¸¸æ•°æ®è¯†åˆ«æ ‡è®°


### 3.1 å¼‚å¸¸æ£€æµ‹çš„é‡è¦æ€§


**ğŸ¯ ä»€ä¹ˆæ˜¯å¼‚å¸¸æ•°æ®ï¼Ÿ**
å¼‚å¸¸æ•°æ®å°±æ˜¯**è·Ÿæ­£å¸¸æƒ…å†µæ˜æ˜¾ä¸åŒçš„æ•°æ®**ã€‚æ¯”å¦‚å¹³æ—¶CPUä½¿ç”¨ç‡åœ¨20%å·¦å³ï¼Œçªç„¶é£™å‡åˆ°95%ï¼Œè¿™å°±æ˜¯å¼‚å¸¸ã€‚

**ğŸ”¸ å¼‚å¸¸æ£€æµ‹çš„ä½œç”¨**
- **æå‰é¢„è­¦**ï¼šåœ¨ç³»ç»Ÿå´©æºƒå‰å‘ç°é—®é¢˜
- **æ•…éšœå®šä½**ï¼šå¿«é€Ÿæ‰¾åˆ°é—®é¢˜æ ¹æº
- **æ€§èƒ½ä¼˜åŒ–**ï¼šè¯†åˆ«æ€§èƒ½ç“¶é¢ˆ
- **å®¹é‡è§„åˆ’**ï¼šé¢„æµ‹èµ„æºéœ€æ±‚

### 3.2 å¼‚å¸¸æ£€æµ‹æ–¹æ³•


**ğŸ“Š é˜ˆå€¼æ£€æµ‹æ³•**

è¿™æ˜¯æœ€ç®€å•ç›´æ¥çš„æ–¹æ³•ï¼Œå°±æ˜¯**è®¾å®šä¸€ä¸ªç•Œé™å€¼**ï¼Œè¶…è¿‡è¿™ä¸ªå€¼å°±è®¤ä¸ºæ˜¯å¼‚å¸¸ã€‚

```
æ­£å¸¸èŒƒå›´è®¾å®šç¤ºä¾‹ï¼š
CPUä½¿ç”¨ç‡    : 0-80%     (è¶…è¿‡80%å‘Šè­¦)
å†…å­˜ä½¿ç”¨ç‡   : 0-85%     (è¶…è¿‡85%å‘Šè­¦)  
ç£ç›˜ä½¿ç”¨ç‡   : 0-90%     (è¶…è¿‡90%å‘Šè­¦)
ç³»ç»Ÿè´Ÿè½½     : 0-2.0     (è¶…è¿‡2.0å‘Šè­¦)
```

**âš¡ å®æ—¶å¼‚å¸¸æ£€æµ‹è„šæœ¬**
```bash
#!/bin/bash
# ç³»ç»Ÿå¼‚å¸¸å®æ—¶æ£€æµ‹è„šæœ¬

# å®šä¹‰å‘Šè­¦é˜ˆå€¼
CPU_THRESHOLD=80
MEM_THRESHOLD=85
DISK_THRESHOLD=90
LOAD_THRESHOLD=2.0

check_system_health() {
    echo "ğŸ” å¼€å§‹ç³»ç»Ÿå¥åº·æ£€æŸ¥..."
    
    # CPUæ£€æŸ¥
    cpu_usage=$(top -bn1 | grep "Cpu(s)" | awk '{print 100-$8}')
    cpu_usage_int=$(printf "%.0f" $cpu_usage)
    
    if [ $cpu_usage_int -gt $CPU_THRESHOLD ]; then
        echo "ğŸš¨ CPUå¼‚å¸¸: å½“å‰ä½¿ç”¨ç‡ ${cpu_usage}% > é˜ˆå€¼ ${CPU_THRESHOLD}%"
        alert_count=$((alert_count + 1))
    else
        echo "âœ… CPUæ­£å¸¸: ${cpu_usage}%"
    fi
    
    # å†…å­˜æ£€æŸ¥
    mem_usage=$(free | grep Mem | awk '{printf "%.1f", ($3/$2)*100}')
    mem_usage_int=$(printf "%.0f" $mem_usage)
    
    if [ $mem_usage_int -gt $MEM_THRESHOLD ]; then
        echo "ğŸš¨ å†…å­˜å¼‚å¸¸: å½“å‰ä½¿ç”¨ç‡ ${mem_usage}% > é˜ˆå€¼ ${MEM_THRESHOLD}%"
        alert_count=$((alert_count + 1))
    else
        echo "âœ… å†…å­˜æ­£å¸¸: ${mem_usage}%"
    fi
    
    # ç£ç›˜æ£€æŸ¥
    disk_usage=$(df / | tail -1 | awk '{print $(NF-1)}' | sed 's/%//')
    
    if [ $disk_usage -gt $DISK_THRESHOLD ]; then
        echo "ğŸš¨ ç£ç›˜å¼‚å¸¸: å½“å‰ä½¿ç”¨ç‡ ${disk_usage}% > é˜ˆå€¼ ${DISK_THRESHOLD}%"
        alert_count=$((alert_count + 1))
    else
        echo "âœ… ç£ç›˜æ­£å¸¸: ${disk_usage}%"
    fi
    
    # ç³»ç»Ÿè´Ÿè½½æ£€æŸ¥
    load_avg=$(cat /proc/loadavg | awk '{print $1}')
    load_check=$(echo "$load_avg > $LOAD_THRESHOLD" | bc)
    
    if [ $load_check -eq 1 ]; then
        echo "ğŸš¨ è´Ÿè½½å¼‚å¸¸: å½“å‰è´Ÿè½½ $load_avg > é˜ˆå€¼ $LOAD_THRESHOLD"
        alert_count=$((alert_count + 1))
    else
        echo "âœ… è´Ÿè½½æ­£å¸¸: $load_avg"
    fi
    
    echo "ğŸ“Š æ£€æŸ¥å®Œæˆï¼Œå‘ç° $alert_count ä¸ªå¼‚å¸¸é¡¹ç›®"
}

# åˆå§‹åŒ–å‘Šè­¦è®¡æ•°
alert_count=0
check_system_health
```

**ğŸ“ˆ ç»Ÿè®¡åˆ†ææ³•**

***åŸºäºå†å²æ•°æ®çš„å¼‚å¸¸æ£€æµ‹***ï¼šé€šè¿‡åˆ†æå†å²æ•°æ®ï¼Œæ‰¾å‡º**æ•°æ®çš„æ­£å¸¸æ³¢åŠ¨èŒƒå›´**ï¼Œè¶…å‡ºèŒƒå›´çš„å°±æ˜¯å¼‚å¸¸ã€‚

```bash
# åŸºäºæ ‡å‡†å·®çš„å¼‚å¸¸æ£€æµ‹
#!/bin/bash

detect_cpu_anomaly() {
    # æ”¶é›†æœ€è¿‘100æ¬¡CPUä½¿ç”¨ç‡æ•°æ®
    echo "ğŸ“Š æ”¶é›†å†å²CPUæ•°æ®..."
    temp_file="/tmp/cpu_history.log"
    > $temp_file  # æ¸…ç©ºæ–‡ä»¶
    
    for i in {1..20}; do  # ç®€åŒ–ä¸º20æ¬¡é‡‡æ ·
        cpu_usage=$(top -bn1 | grep "Cpu(s)" | awk '{print 100-$8}')
        echo $cpu_usage >> $temp_file
        sleep 1
    done
    
    # è®¡ç®—å¹³å‡å€¼å’Œæ ‡å‡†å·®
    avg=$(awk '{sum+=$1} END {print sum/NR}' $temp_file)
    std_dev=$(awk -v avg=$avg '{sum+=($1-avg)^2} END {print sqrt(sum/NR)}' $temp_file)
    
    # å®šä¹‰å¼‚å¸¸èŒƒå›´ï¼ˆå¹³å‡å€¼Â±2å€æ ‡å‡†å·®ï¼‰
    upper_limit=$(echo "$avg + 2 * $std_dev" | bc)
    lower_limit=$(echo "$avg - 2 * $std_dev" | bc)
    
    echo "ğŸ“ˆ CPUä½¿ç”¨ç‡ç»Ÿè®¡åˆ†æï¼š"
    echo "å¹³å‡å€¼: $(printf "%.2f" $avg)%"
    echo "æ ‡å‡†å·®: $(printf "%.2f" $std_dev)"
    echo "æ­£å¸¸èŒƒå›´: $(printf "%.2f" $lower_limit)% - $(printf "%.2f" $upper_limit)%"
    
    # æ£€æµ‹å½“å‰å€¼æ˜¯å¦å¼‚å¸¸
    current_cpu=$(top -bn1 | grep "Cpu(s)" | awk '{print 100-$8}')
    
    if (( $(echo "$current_cpu > $upper_limit" | bc -l) )); then
        echo "ğŸš¨ å½“å‰CPUä½¿ç”¨ç‡ ${current_cpu}% å¼‚å¸¸åé«˜ï¼"
    elif (( $(echo "$current_cpu < $lower_limit" | bc -l) )); then
        echo "âš ï¸  å½“å‰CPUä½¿ç”¨ç‡ ${current_cpu}% å¼‚å¸¸åä½"
    else
        echo "âœ… å½“å‰CPUä½¿ç”¨ç‡ ${current_cpu}% æ­£å¸¸"
    fi
    
    rm $temp_file
}
```

### 3.3 å¼‚å¸¸æ•°æ®æ ‡è®°ä¸è®°å½•


**ğŸ·ï¸ å¼‚å¸¸äº‹ä»¶æ ‡è®°ç³»ç»Ÿ**

å½“æ£€æµ‹åˆ°å¼‚å¸¸æ—¶ï¼Œæˆ‘ä»¬è¦**åšå¥½è®°å½•**ï¼Œæ–¹ä¾¿åç»­åˆ†æå’Œå¤„ç†ã€‚

```bash
#!/bin/bash
# å¼‚å¸¸äº‹ä»¶è®°å½•ç³»ç»Ÿ

LOG_FILE="/var/log/system_anomaly.log"
ALERT_LEVEL_HIGH="HIGH"
ALERT_LEVEL_MEDIUM="MEDIUM" 
ALERT_LEVEL_LOW="LOW"

log_anomaly() {
    local metric_type=$1    # æŒ‡æ ‡ç±»å‹ï¼ˆCPU/MEM/DISK/LOADï¼‰
    local current_value=$2  # å½“å‰å€¼
    local threshold=$3      # é˜ˆå€¼
    local level=$4         # å‘Šè­¦çº§åˆ«
    
    timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    hostname=$(hostname)
    
    # æ„å»ºå‘Šè­¦æ¶ˆæ¯
    alert_msg="[$timestamp] [$hostname] [$level] $metric_typeå¼‚å¸¸: å½“å‰å€¼=$current_value, é˜ˆå€¼=$threshold"
    
    # å†™å…¥æ—¥å¿—æ–‡ä»¶
    echo "$alert_msg" >> $LOG_FILE
    
    # æ ¹æ®çº§åˆ«å†³å®šå¤„ç†æ–¹å¼
    case $level in
        $ALERT_LEVEL_HIGH)
            echo "ğŸ”¥ $alert_msg"
            # å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ é‚®ä»¶é€šçŸ¥ã€çŸ­ä¿¡å‘Šè­¦ç­‰
            ;;
        $ALERT_LEVEL_MEDIUM)
            echo "âš ï¸  $alert_msg"
            ;;
        $ALERT_LEVEL_LOW)
            echo "â„¹ï¸  $alert_msg"
            ;;
    esac
}

# ä½¿ç”¨ç¤ºä¾‹
current_cpu=92.5
if (( $(echo "$current_cpu > 90" | bc -l) )); then
    log_anomaly "CPU" "$current_cpu%" "90%" "$ALERT_LEVEL_HIGH"
fi
```

**ğŸ“‹ å¼‚å¸¸æ±‡æ€»æŠ¥å‘Š**
```bash
# ç”Ÿæˆå¼‚å¸¸æ±‡æ€»æŠ¥å‘Š
generate_anomaly_report() {
    echo "ğŸ“Š ç³»ç»Ÿå¼‚å¸¸æ±‡æ€»æŠ¥å‘Š"
    echo "===================="
    echo "æŠ¥å‘Šæ—¶é—´: $(date)"
    echo "ä¸»æœºåç§°: $(hostname)"
    echo ""
    
    if [ -f "$LOG_FILE" ]; then
        echo "ğŸš¨ æœ€è¿‘24å°æ—¶å¼‚å¸¸äº‹ä»¶ï¼š"
        
        # ç»Ÿè®¡å„ç±»å‹å¼‚å¸¸æ•°é‡
        cpu_count=$(grep -c "CPUå¼‚å¸¸" $LOG_FILE || echo 0)
        mem_count=$(grep -c "å†…å­˜å¼‚å¸¸" $LOG_FILE || echo 0)
        disk_count=$(grep -c "ç£ç›˜å¼‚å¸¸" $LOG_FILE || echo 0)
        load_count=$(grep -c "è´Ÿè½½å¼‚å¸¸" $LOG_FILE || echo 0)
        
        echo "CPUå¼‚å¸¸: $cpu_count æ¬¡"
        echo "å†…å­˜å¼‚å¸¸: $mem_count æ¬¡"
        echo "ç£ç›˜å¼‚å¸¸: $disk_count æ¬¡"
        echo "è´Ÿè½½å¼‚å¸¸: $load_count æ¬¡"
        echo ""
        
        # æ˜¾ç¤ºæœ€è¿‘çš„5ä¸ªå¼‚å¸¸äº‹ä»¶
        echo "ğŸ“‹ æœ€è¿‘çš„å¼‚å¸¸äº‹ä»¶ï¼š"
        tail -5 $LOG_FILE 2>/dev/null || echo "æš‚æ— å¼‚å¸¸è®°å½•"
    else
        echo "âœ… æœªå‘ç°å¼‚å¸¸äº‹ä»¶è®°å½•"
    fi
}
```

---

## 4. ğŸ“ˆ å†å²æ•°æ®è¶‹åŠ¿åˆ†æ


### 4.1 è¶‹åŠ¿åˆ†æçš„ä»·å€¼


**ğŸ¯ ä¸ºä»€ä¹ˆè¦åšè¶‹åŠ¿åˆ†æï¼Ÿ**
è¶‹åŠ¿åˆ†æå°±åƒçœ‹**è‚¡ç¥¨èµ°åŠ¿å›¾**ä¸€æ ·ï¼Œé€šè¿‡è§‚å¯Ÿæ•°æ®éšæ—¶é—´çš„å˜åŒ–è§„å¾‹ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š
- **é¢„æµ‹æœªæ¥**ï¼šæ ¹æ®å†å²è¶‹åŠ¿é¢„åˆ¤ç³»ç»Ÿè´Ÿè½½å˜åŒ–
- **å‘ç°è§„å¾‹**ï¼šæ‰¾å‡ºç³»ç»Ÿçš„ä½¿ç”¨æ¨¡å¼å’Œå‘¨æœŸæ€§å˜åŒ–
- **ä¼˜åŒ–èµ„æº**ï¼šåœ¨è´Ÿè½½é«˜å³°å‰æå‰æ‰©å®¹
- **æ•…éšœé¢„é˜²**ï¼šæå‰å‘ç°æ€§èƒ½æ¶åŒ–è¶‹åŠ¿

### 4.2 æ•°æ®æ”¶é›†ä¸å­˜å‚¨


**ğŸ“Š é•¿æœŸæ•°æ®æ”¶é›†ç­–ç•¥**

è¦åšè¶‹åŠ¿åˆ†æï¼Œé¦–å…ˆè¦**æŒç»­æ”¶é›†æ•°æ®**ã€‚æˆ‘ä»¬éœ€è¦å»ºç«‹ä¸€ä¸ªç®€å•çš„æ•°æ®æ”¶é›†ç³»ç»Ÿã€‚

```bash
#!/bin/bash
# ç³»ç»Ÿæ€§èƒ½æ•°æ®æ”¶é›†è„šæœ¬ï¼ˆå®šæ—¶æ‰§è¡Œï¼‰

DATA_DIR="/var/log/performance"
DATE_STR=$(date '+%Y%m%d')
HOUR_STR=$(date '+%H')
TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')

# åˆ›å»ºæ•°æ®ç›®å½•
mkdir -p $DATA_DIR

# æ•°æ®æ–‡ä»¶å‘½åè§„åˆ™ï¼šperformance_YYYYMMDD.csv
DATA_FILE="$DATA_DIR/performance_${DATE_STR}.csv"

collect_performance_data() {
    # å¦‚æœæ˜¯æ–°çš„ä¸€å¤©ï¼Œåˆ›å»ºCSVè¡¨å¤´
    if [ ! -f "$DATA_FILE" ]; then
        echo "timestamp,cpu_usage,mem_usage,disk_usage,load_avg,network_in,network_out" > $DATA_FILE
    fi
    
    # æ”¶é›†å„é¡¹æŒ‡æ ‡
    cpu_usage=$(top -bn1 | grep "Cpu(s)" | awk '{print 100-$8}')
    mem_usage=$(free | grep Mem | awk '{printf "%.2f", ($3/$2)*100}')
    disk_usage=$(df / | tail -1 | awk '{print $(NF-1)}' | sed 's/%//')
    load_avg=$(cat /proc/loadavg | awk '{print $1}')
    
    # ç½‘ç»œæµé‡ï¼ˆç®€åŒ–ç‰ˆï¼Œå®é™…å¯ä»¥æ›´å¤æ‚ï¼‰
    network_in=$(cat /proc/net/dev | grep eth0 | awk '{print $2}' || echo 0)
    network_out=$(cat /proc/net/dev | grep eth0 | awk '{print $10}' || echo 0)
    
    # å†™å…¥æ•°æ®
    echo "$TIMESTAMP,$cpu_usage,$mem_usage,$disk_usage,$load_avg,$network_in,$network_out" >> $DATA_FILE
    
    echo "âœ… æ•°æ®å·²æ”¶é›†: $(basename $DATA_FILE)"
}

collect_performance_data
```

**â° å®šæ—¶æ”¶é›†è®¾ç½®**
```bash
# æ·»åŠ åˆ°crontabï¼Œæ¯5åˆ†é’Ÿæ”¶é›†ä¸€æ¬¡æ•°æ®
# crontab -e
*/5 * * * * /path/to/collect_performance_data.sh
```

### 4.3 è¶‹åŠ¿è®¡ç®—ä¸åˆ†æ


**ğŸ“Š åŸºç¡€è¶‹åŠ¿æŒ‡æ ‡**

***å¢é•¿ç‡è®¡ç®—***ï¼šæ•°æ®æ˜¯åœ¨å¢é•¿è¿˜æ˜¯å‡å°‘ï¼Ÿ
```bash
#!/bin/bash
# è®¡ç®—CPUä½¿ç”¨ç‡çš„æ—¥å¢é•¿è¶‹åŠ¿

calculate_cpu_trend() {
    local data_file=$1
    
    if [ ! -f "$data_file" ]; then
        echo "âŒ æ•°æ®æ–‡ä»¶ä¸å­˜åœ¨: $data_file"
        return 1
    fi
    
    echo "ğŸ“ˆ CPUä½¿ç”¨ç‡è¶‹åŠ¿åˆ†æ"
    echo "==================="
    
    # è·å–ä»Šå¤©å’Œæ˜¨å¤©çš„å¹³å‡CPUä½¿ç”¨ç‡
    today_avg=$(tail -n +2 "$data_file" | awk -F',' '{sum+=$2; count++} END {printf "%.2f", sum/count}')
    
    # è·å–æ˜¨å¤©çš„æ•°æ®æ–‡ä»¶
    yesterday=$(date -d "1 day ago" '+%Y%m%d')
    yesterday_file="${data_file%/*}/performance_${yesterday}.csv"
    
    if [ -f "$yesterday_file" ]; then
        yesterday_avg=$(tail -n +2 "$yesterday_file" | awk -F',' '{sum+=$2; count++} END {printf "%.2f", sum/count}')
        
        # è®¡ç®—å¢é•¿ç‡
        growth_rate=$(echo "scale=2; ($today_avg - $yesterday_avg) / $yesterday_avg * 100" | bc 2>/dev/null)
        
        echo "æ˜¨æ—¥å¹³å‡: ${yesterday_avg}%"
        echo "ä»Šæ—¥å¹³å‡: ${today_avg}%"
        echo "å¢é•¿ç‡: ${growth_rate}%"
        
        # è¶‹åŠ¿åˆ¤æ–­
        if (( $(echo "$growth_rate > 5" | bc -l) )); then
            echo "ğŸ”º è¶‹åŠ¿: CPUä½¿ç”¨ç‡æ˜¾è‘—ä¸Šå‡"
        elif (( $(echo "$growth_rate < -5" | bc -l) )); then
            echo "ğŸ”» è¶‹åŠ¿: CPUä½¿ç”¨ç‡æ˜¾è‘—ä¸‹é™"
        else
            echo "â¡ï¸ è¶‹åŠ¿: CPUä½¿ç”¨ç‡ç›¸å¯¹ç¨³å®š"
        fi
    else
        echo "âš ï¸  ç¼ºå°‘æ˜¨æ—¥æ•°æ®ï¼Œä»…æ˜¾ç¤ºä»Šæ—¥å¹³å‡: ${today_avg}%"
    fi
}
```

**ğŸ“Š å‘¨æœŸæ€§æ¨¡å¼è¯†åˆ«**

***è¯†åˆ«ç³»ç»Ÿä½¿ç”¨çš„æ—¶é—´æ¨¡å¼***ï¼šæ¯”å¦‚å·¥ä½œæ—¶é—´CPUä½¿ç”¨ç‡é«˜ï¼Œå¤œæ™šä½¿ç”¨ç‡ä½ã€‚

```bash
#!/bin/bash
# åˆ†æç³»ç»Ÿä½¿ç”¨çš„æ—¶é—´æ¨¡å¼

analyze_hourly_pattern() {
    local data_file=$1
    
    echo "ğŸ• 24å°æ—¶ä½¿ç”¨æ¨¡å¼åˆ†æ"
    echo "====================="
    
    # æŒ‰å°æ—¶ç»Ÿè®¡å¹³å‡CPUä½¿ç”¨ç‡
    echo "æ—¶é—´æ®µ    å¹³å‡CPUä½¿ç”¨ç‡    è´Ÿè½½ç­‰çº§"
    echo "------------------------------------"
    
    for hour in {0..23}; do
        hour_padded=$(printf "%02d" $hour)
        
        # æå–è¯¥å°æ—¶çš„æ‰€æœ‰æ•°æ®
        hour_avg=$(grep " ${hour_padded}:" "$data_file" | awk -F',' '{sum+=$2; count++} END {
            if(count>0) printf "%.1f", sum/count; 
            else print "N/A"
        }')
        
        # åˆ¤æ–­è´Ÿè½½ç­‰çº§
        if [ "$hour_avg" != "N/A" ]; then
            if (( $(echo "$hour_avg > 70" | bc -l) )); then
                level="ğŸ”´ é«˜è´Ÿè½½"
            elif (( $(echo "$hour_avg > 40" | bc -l) )); then
                level="ğŸŸ¡ ä¸­è´Ÿè½½"
            else
                level="ğŸŸ¢ ä½è´Ÿè½½"
            fi
            echo "${hour_padded}:00     ${hour_avg}%              $level"
        else
            echo "${hour_padded}:00     æ— æ•°æ®              --"
        fi
    done
    
    echo ""
    echo "ğŸ’¡ ä½¿ç”¨å»ºè®®ï¼š"
    
    # æ‰¾å‡ºè´Ÿè½½æœ€é«˜çš„æ—¶é—´æ®µ
    peak_hour=$(grep -v "timestamp" "$data_file" | awk -F',' '{
        hour=substr($1,12,2); 
        sum[hour]+=$2; 
        count[hour]++
    } END {
        max_avg=0; 
        peak_hour=0;
        for(h in sum) {
            avg=sum[h]/count[h];
            if(avg>max_avg) {
                max_avg=avg; 
                peak_hour=h
            }
        }
        printf "%02d", peak_hour
    }')
    
    echo "ğŸ”¥ ç³»ç»Ÿè´Ÿè½½é«˜å³°: ${peak_hour}:00 æ—¶æ®µ"
    echo "ğŸ’¼ å»ºè®®åœ¨é«˜å³°æœŸå‰è¿›è¡Œç³»ç»Ÿä¼˜åŒ–æˆ–æ‰©å®¹"
}
```

### 4.4 é¢„æµ‹æ€§åˆ†æ


**ğŸ”® ç®€å•çš„çº¿æ€§è¶‹åŠ¿é¢„æµ‹**

åŸºäºå†å²æ•°æ®çš„å˜åŒ–è¶‹åŠ¿ï¼Œ**é¢„æµ‹æœªæ¥å¯èƒ½çš„æ•°å€¼**ã€‚

```bash
#!/bin/bash
# ç®€å•çš„ç³»ç»Ÿè´Ÿè½½è¶‹åŠ¿é¢„æµ‹

predict_system_trend() {
    local data_file=$1
    local days_to_predict=${2:-7}  # é»˜è®¤é¢„æµ‹7å¤©
    
    echo "ğŸ”® ç³»ç»Ÿè´Ÿè½½è¶‹åŠ¿é¢„æµ‹"
    echo "=================="
    
    # è·å–æœ€è¿‘7å¤©çš„å¹³å‡å€¼
    recent_data=$(tail -n $((7*288)) "$data_file" | tail -n +2)  # å‡è®¾æ¯5åˆ†é’Ÿé‡‡æ ·ä¸€æ¬¡
    
    if [ -z "$recent_data" ]; then
        echo "âŒ æ•°æ®ä¸è¶³ï¼Œæ— æ³•è¿›è¡Œé¢„æµ‹"
        return 1
    fi
    
    # è®¡ç®—æ¯æ—¥å¹³å‡å€¼çš„å˜åŒ–è¶‹åŠ¿
    echo "$recent_data" | awk -F',' '{
        date=substr($1,1,10);
        cpu_sum[date]+=$2;
        mem_sum[date]+=$3;
        count[date]++;
    } END {
        print "ğŸ“Š æœ€è¿‘7å¤©å¹³å‡ä½¿ç”¨ç‡å˜åŒ–:";
        print "æ—¥æœŸ          CPUä½¿ç”¨ç‡    å†…å­˜ä½¿ç”¨ç‡";
        print "------------------------------------";
        
        day_count=0;
        total_cpu_change=0;
        total_mem_change=0;
        prev_cpu=0;
        prev_mem=0;
        
        for(d in cpu_sum) {
            cpu_avg = cpu_sum[d]/count[d];
            mem_avg = mem_sum[d]/count[d];
            
            printf "%s    %.1f%%         %.1f%%\n", d, cpu_avg, mem_avg;
            
            if(day_count > 0) {
                total_cpu_change += (cpu_avg - prev_cpu);
                total_mem_change += (mem_avg - prev_mem);
            }
            
            prev_cpu = cpu_avg;
            prev_mem = mem_avg;
            day_count++;
        }
        
        if(day_count > 1) {
            avg_cpu_change = total_cpu_change / (day_count-1);
            avg_mem_change = total_mem_change / (day_count-1);
            
            print "\nğŸ“ˆ è¶‹åŠ¿åˆ†æ:";
            printf "CPUæ—¥å‡å˜åŒ–: %.2f%%\n", avg_cpu_change;
            printf "å†…å­˜æ—¥å‡å˜åŒ–: %.2f%%\n", avg_mem_change;
            
            print "\nğŸ”® æœªæ¥7å¤©é¢„æµ‹:";
            predicted_cpu = prev_cpu + (avg_cpu_change * 7);
            predicted_mem = prev_mem + (avg_mem_change * 7);
            
            printf "é¢„æµ‹CPUä½¿ç”¨ç‡: %.1f%%\n", predicted_cpu;
            printf "é¢„æµ‹å†…å­˜ä½¿ç”¨ç‡: %.1f%%\n", predicted_mem;
            
            # é£é™©è¯„ä¼°
            if(predicted_cpu > 85) {
                print "âš ï¸  CPUä½¿ç”¨ç‡å¯èƒ½è¿‡é«˜ï¼Œå»ºè®®å…³æ³¨";
            }
            if(predicted_mem > 90) {
                print "âš ï¸  å†…å­˜ä½¿ç”¨ç‡å¯èƒ½è¿‡é«˜ï¼Œå»ºè®®å…³æ³¨";
            }
        }
    }'
}
```

---

## 5. ğŸ“‹ ç›‘æ§æŠ¥è¡¨è‡ªåŠ¨ç”Ÿæˆ


### 5.1 æŠ¥è¡¨ç”Ÿæˆçš„æ ¸å¿ƒä»·å€¼


**ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦è‡ªåŠ¨ç”ŸæˆæŠ¥è¡¨ï¼Ÿ**
æ‰‹å·¥æ•´ç†ç›‘æ§æ•°æ®å¤ªè´¹æ—¶è´¹åŠ›ï¼Œè‡ªåŠ¨æŠ¥è¡¨å°±åƒ**è´´å¿ƒçš„åŠ©æ‰‹**ï¼Œå¸®æˆ‘ä»¬ï¼š
- **èŠ‚çœæ—¶é—´**ï¼šè‡ªåŠ¨æ±‡æ€»å¤§é‡æ•°æ®ï¼Œæ— éœ€äººå·¥æ•´ç†
- **å®šæœŸæ›´æ–°**ï¼šæ¯å¤©ã€æ¯å‘¨ã€æ¯æœˆè‡ªåŠ¨ç”Ÿæˆæœ€æ–°æŠ¥å‘Š
- **æ ‡å‡†æ ¼å¼**ï¼šç»Ÿä¸€çš„æŠ¥å‘Šæ ¼å¼ï¼Œä¾¿äºé˜…è¯»å’Œå¯¹æ¯”
- **åŠæ—¶å‘ç°**ï¼šé€šè¿‡æŠ¥è¡¨å¿«é€Ÿå‘ç°ç³»ç»Ÿé—®é¢˜å’Œè¶‹åŠ¿

### 5.2 æ—¥æŠ¥ç”Ÿæˆç³»ç»Ÿ


**ğŸ“Š æ¯æ—¥ç³»ç»ŸçŠ¶å†µæŠ¥å‘Š**

```bash
#!/bin/bash
# ç³»ç»Ÿç›‘æ§æ—¥æŠ¥ç”Ÿæˆè„šæœ¬

REPORT_DIR="/var/log/reports"
DATE_STR=$(date '+%Y%m%d')
YESTERDAY=$(date -d "1 day ago" '+%Y%m%d')
REPORT_FILE="$REPORT_DIR/daily_report_${DATE_STR}.html"

# åˆ›å»ºæŠ¥è¡¨ç›®å½•
mkdir -p $REPORT_DIR

generate_daily_report() {
    echo "ğŸ“ æ­£åœ¨ç”Ÿæˆæ—¥æŠ¥: $(date '+%Yå¹´%mæœˆ%dæ—¥')"
    
    # HTMLæŠ¥è¡¨å¤´éƒ¨
    cat > $REPORT_FILE << EOF
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>ç³»ç»Ÿç›‘æ§æ—¥æŠ¥ - $(date '+%Yå¹´%mæœˆ%dæ—¥')</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        .header { text-align: center; color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .metric { display: inline-block; margin: 10px; padding: 15px; background: #ecf0f1; border-radius: 5px; min-width: 150px; }
        .status-ok { color: #27ae60; font-weight: bold; }
        .status-warning { color: #f39c12; font-weight: bold; }
        .status-error { color: #e74c3c; font-weight: bold; }
        table { width: 100%; border-collapse: collapse; margin: 10px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #3498db; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ–¥ï¸ ç³»ç»Ÿç›‘æ§æ—¥æŠ¥</h1>
            <h2>$(date '+%Yå¹´%mæœˆ%dæ—¥') - ä¸»æœº: $(hostname)</h2>
        </div>
EOF

    # ç”Ÿæˆç³»ç»Ÿæ¦‚å†µ
    generate_system_overview >> $REPORT_FILE
    
    # ç”Ÿæˆæ€§èƒ½æŒ‡æ ‡æ±‡æ€»
    generate_performance_summary >> $REPORT_FILE
    
    # ç”Ÿæˆå¼‚å¸¸äº‹ä»¶æ±‡æ€»
    generate_anomaly_summary >> $REPORT_FILE
    
    # ç”Ÿæˆè¶‹åŠ¿åˆ†æ
    generate_trend_analysis >> $REPORT_FILE
    
    # HTMLæŠ¥è¡¨å°¾éƒ¨
    cat >> $REPORT_FILE << EOF
        <div class="section">
            <h3>ğŸ“Š æŠ¥è¡¨è¯´æ˜</h3>
            <ul>
                <li><span class="status-ok">ç»¿è‰²</span> è¡¨ç¤ºæ­£å¸¸çŠ¶æ€</li>
                <li><span class="status-warning">æ©™è‰²</span> è¡¨ç¤ºéœ€è¦å…³æ³¨</li>
                <li><span class="status-error">çº¢è‰²</span> è¡¨ç¤ºå¼‚å¸¸çŠ¶æ€</li>
            </ul>
            <p><em>æŠ¥è¡¨ç”Ÿæˆæ—¶é—´: $(date '+%Y-%m-%d %H:%M:%S')</em></p>
        </div>
    </div>
</body>
</html>
EOF
    
    echo "âœ… æ—¥æŠ¥å·²ç”Ÿæˆ: $REPORT_FILE"
}

generate_system_overview() {
    cat << EOF
        <div class="section">
            <h3>ğŸ¯ ç³»ç»Ÿæ¦‚å†µ</h3>
            <div class="metric">
                <strong>æ“ä½œç³»ç»Ÿ</strong><br>
                $(cat /etc/os-release | grep PRETTY_NAME | cut -d'"' -f2)
            </div>
            <div class="metric">
                <strong>å†…æ ¸ç‰ˆæœ¬</strong><br>
                $(uname -r)
            </div>
            <div class="metric">
                <strong>è¿è¡Œæ—¶é—´</strong><br>
                $(uptime -p)
            </div>
            <div class="metric">
                <strong>CPUæ ¸å¿ƒæ•°</strong><br>
                $(nproc) æ ¸å¿ƒ
            </div>
            <div class="metric">
                <strong>æ€»å†…å­˜</strong><br>
                $(free -h | grep Mem | awk '{print $2}')
            </div>
            <div class="metric">
                <strong>ç£ç›˜ç©ºé—´</strong><br>
                $(df -h / | tail -1 | awk '{print $2}') æ€»è®¡
            </div>
        </div>
EOF
}

generate_performance_summary() {
    # è·å–å½“å‰æ€§èƒ½æŒ‡æ ‡
    current_cpu=$(top -bn1 | grep "Cpu(s)" | awk '{print 100-$8}')
    current_mem=$(free | grep Mem | awk '{printf "%.1f", ($3/$2)*100}')
    current_disk=$(df / | tail -1 | awk '{print $(NF-1)}' | sed 's/%//')
    current_load=$(cat /proc/loadavg | awk '{print $1}')
    
    # çŠ¶æ€åˆ¤æ–­
    cpu_status="status-ok"
    [ $(echo "$current_cpu > 80" | bc) -eq 1 ] && cpu_status="status-warning"
    [ $(echo "$current_cpu > 90" | bc) -eq 1 ] && cpu_status="status-error"
    
    mem_status="status-ok"
    [ $(echo "$current_mem > 85" | bc) -eq 1 ] && mem_status="status-warning"
    [ $(echo "$current_mem > 95" | bc) -eq 1 ] && mem_status="status-error"
    
    disk_status="status-ok"
    [ $current_disk -gt 85 ] && disk_status="status-warning"
    [ $current_disk -gt 95 ] && disk_status="status-error"
    
    cat << EOF
        <div class="section">
            <h3>âš¡ å½“å‰æ€§èƒ½æŒ‡æ ‡</h3>
            <div class="metric">
                <strong>CPUä½¿ç”¨ç‡</strong><br>
                <span class="$cpu_status">$(printf "%.1f" $current_cpu)%</span>
            </div>
            <div class="metric">
                <strong>å†…å­˜ä½¿ç”¨ç‡</strong><br>
                <span class="$mem_status">$current_mem%</span>
            </div>
            <div class="metric">
                <strong>ç£ç›˜ä½¿ç”¨ç‡</strong><br>
                <span class="$disk_status">$current_disk%</span>
            </div>
            <div class="metric">
                <strong>ç³»ç»Ÿè´Ÿè½½</strong><br>
                <span>$current_load</span>
            </div>
        </div>
EOF
}

generate_anomaly_summary() {
    anomaly_log="/var/log/system_anomaly.log"
    
    cat << EOF
        <div class="section">
            <h3>ğŸš¨ å¼‚å¸¸äº‹ä»¶æ±‡æ€»</h3>
EOF
    
    if [ -f "$anomaly_log" ]; then
        today_anomalies=$(grep "$(date '+%Y-%m-%d')" "$anomaly_log" | wc -l)
        
        if [ $today_anomalies -gt 0 ]; then
            cat << EOF
            <p>ä»Šæ—¥å‘ç° <strong class="status-warning">$today_anomalies</strong> ä¸ªå¼‚å¸¸äº‹ä»¶</p>
            <table>
                <tr><th>æ—¶é—´</th><th>ç±»å‹</th><th>è¯¦æƒ…</th></tr>
EOF
            # æ˜¾ç¤ºä»Šå¤©çš„å¼‚å¸¸äº‹ä»¶
            grep "$(date '+%Y-%m-%d')" "$anomaly_log" | tail -10 | while read line; do
                timestamp=$(echo "$line" | awk -F'[][]' '{print $2}')
                level=$(echo "$line" | awk -F'[][]' '{print $6}')
                detail=$(echo "$line" | awk -F'[][]' '{print $8}')
                
                level_class="status-ok"
                [ "$level" = "MEDIUM" ] && level_class="status-warning"
                [ "$level" = "HIGH" ] && level_class="status-error"
                
                echo "<tr><td>$timestamp</td><td><span class=\"$level_class\">$level</span></td><td>$detail</td></tr>"
            done
            
            echo "</table>"
        else
            echo "<p class=\"status-ok\">âœ… ä»Šæ—¥æ— å¼‚å¸¸äº‹ä»¶</p>"
        fi
    else
        echo "<p class=\"status-ok\">âœ… æš‚æ— å¼‚å¸¸è®°å½•</p>"
    fi
    
    echo "</div>"
}

generate_trend_analysis() {
    cat << EOF
        <div class="section">
            <h3>ğŸ“ˆ è¶‹åŠ¿åˆ†æ</h3>
            <p>åŸºäºæœ€è¿‘7å¤©æ•°æ®åˆ†æ...</p>
            <!-- è¿™é‡Œå¯ä»¥é›†æˆæ›´å¤æ‚çš„è¶‹åŠ¿åˆ†æé€»è¾‘ -->
            <div class="metric">
                <strong>CPUä½¿ç”¨è¶‹åŠ¿</strong><br>
                ğŸ“Š ç›¸å¯¹ç¨³å®š
            </div>
            <div class="metric">
                <strong>å†…å­˜ä½¿ç”¨è¶‹åŠ¿</strong><br>
                ğŸ“ˆ è½»å¾®ä¸Šå‡
            </div>
            <div class="metric">
                <strong>å»ºè®®å…³æ³¨</strong><br>
                ğŸ’¡ ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ
            </div>
        </div>
EOF
}

# æ‰§è¡ŒæŠ¥è¡¨ç”Ÿæˆ
generate_daily_report

echo "ğŸ”— æŠ¥è¡¨ä½ç½®: $REPORT_FILE"
echo "ğŸ’» å¯é€šè¿‡æµè§ˆå™¨æ‰“å¼€æŸ¥çœ‹"
```

### 5.3 å‘¨æŠ¥å’ŒæœˆæŠ¥æ¨¡æ¿


**ğŸ“Š å‘¨æŠ¥ç”Ÿæˆé€»è¾‘**

```bash
#!/bin/bash
# ç³»ç»Ÿç›‘æ§å‘¨æŠ¥ç”Ÿæˆ

generate_weekly_report() {
    local week_start=$(date -d "7 days ago" '+%Y-%m-%d')
    local week_end=$(date '+%Y-%m-%d')
    
    echo "ğŸ“Š ç”Ÿæˆå‘¨æŠ¥: $week_start è‡³ $week_end"
    
    # å‘¨æŠ¥ç»Ÿè®¡é€»è¾‘
    echo "ğŸ”¸ ä¸€å‘¨å†…ç³»ç»Ÿå¹³å‡è´Ÿè½½"
    echo "ğŸ”¸ å¼‚å¸¸äº‹ä»¶æ€»æ•°ç»Ÿè®¡"  
    echo "ğŸ”¸ æ€§èƒ½å˜åŒ–è¶‹åŠ¿å›¾"
    echo "ğŸ”¸ èµ„æºä½¿ç”¨å³°å€¼åˆ†æ"
    echo "ğŸ”¸ ä¸‹å‘¨å…³æ³¨é‡ç‚¹"
}
```

### 5.4 æŠ¥è¡¨è‡ªåŠ¨åŒ–å‘é€


**ğŸ“§ é‚®ä»¶å‘é€é…ç½®**

```bash
#!/bin/bash
# æŠ¥è¡¨é‚®ä»¶å‘é€è„šæœ¬

send_report_email() {
    local report_file=$1
    local recipients="admin@company.com,ops@company.com"
    local subject="$(hostname) ç³»ç»Ÿç›‘æ§æ—¥æŠ¥ - $(date '+%Y%m%d')"
    
    # æ£€æŸ¥æ˜¯å¦å®‰è£…äº†é‚®ä»¶å‘é€å·¥å…·
    if command -v mail >/dev/null 2>&1; then
        # å‘é€HTMLæ ¼å¼é‚®ä»¶
        cat $report_file | mail -s "$subject" -a "Content-Type: text/html" $recipients
        echo "ğŸ“§ æŠ¥è¡¨å·²å‘é€è‡³: $recipients"
    else
        echo "âš ï¸  æœªå®‰è£…é‚®ä»¶å‘é€å·¥å…·ï¼Œè¯·æ‰‹å·¥å‘é€æŠ¥è¡¨: $report_file"
    fi
}
```

---

## 6. ğŸŒŠ å®æ—¶æ•°æ®æµå¤„ç†


### 6.1 å®æ—¶æ•°æ®æµçš„æ¦‚å¿µ


**ğŸ¯ ä»€ä¹ˆæ˜¯å®æ—¶æ•°æ®æµå¤„ç†ï¼Ÿ**

å®æ—¶æ•°æ®æµå¤„ç†å°±åƒ**æ°´æµç›‘æµ‹**ä¸€æ ·ï¼Œæ•°æ®åƒæ°´ä¸€æ ·è¿ç»­ä¸æ–­åœ°æµè¿‡æ¥ï¼Œæˆ‘ä»¬è¦**è¾¹æ¥æ”¶è¾¹å¤„ç†**ï¼Œè€Œä¸æ˜¯ç­‰æ‰€æœ‰æ•°æ®æ”¶é›†å®Œå†å¤„ç†ã€‚

**ğŸ”¸ å®æ—¶å¤„ç†çš„ä¼˜åŠ¿**
- **å³æ—¶å“åº”**ï¼šé—®é¢˜å‘ç”Ÿæ—¶ç«‹åˆ»å‘ç°
- **å†…å­˜æ•ˆç‡**ï¼šä¸éœ€è¦å­˜å‚¨å¤§é‡å†å²æ•°æ®
- **å®æ—¶å†³ç­–**ï¼šåŸºäºæœ€æ–°æ•°æ®åšå‡ºåˆ¤æ–­
- **æŒç»­ç›‘æ§**ï¼š24å°æ—¶ä¸é—´æ–­ç›‘æ§

**ğŸ’¡ å®æ—¶vsæ‰¹å¤„ç†å¯¹æ¯”**
```
æ‰¹å¤„ç†æ¨¡å¼ï¼š
æ”¶é›†æ•°æ® â†’ å­˜å‚¨æ•°æ® â†’ å®šæœŸåˆ†æ â†’ ç”ŸæˆæŠ¥å‘Š
   â†“           â†“           â†“          â†“
æ¯5åˆ†é’Ÿ     å†™å…¥æ–‡ä»¶    æ¯å°æ—¶åˆ†æ   å»¶è¿Ÿå‘ç°é—®é¢˜

å®æ—¶å¤„ç†æ¨¡å¼ï¼š  
æ•°æ®äº§ç”Ÿ â†’ ç«‹å³åˆ†æ â†’ å³æ—¶å‘Šè­¦ â†’ å¿«é€Ÿå“åº”
   â†“          â†“          â†“         â†“
  ç§’çº§       å®æ—¶è®¡ç®—    ç«‹åˆ»å‘ç°   åŠæ—¶å¤„ç†
```

### 6.2 å®æ—¶ç›‘æ§æ•°æ®æµæ¶æ„


**ğŸ—ï¸ æ•°æ®æµå¤„ç†æ¶æ„**

```
æ•°æ®æº               å¤„ç†å±‚                è¾“å‡ºå±‚
 â†“                   â†“                    â†“
ç³»ç»ŸæŒ‡æ ‡ â†’ [æ•°æ®æ”¶é›†] â†’ [å®æ—¶åˆ†æ] â†’ [å‘Šè­¦é€šçŸ¥]
ç½‘ç»œæµé‡ â†’ [æ•°æ®è¿‡æ»¤] â†’ [é˜ˆå€¼æ£€æµ‹] â†’ [æŠ¥è¡¨æ›´æ–°]
åº”ç”¨æ—¥å¿— â†’ [æ•°æ®èšåˆ] â†’ [è¶‹åŠ¿è®¡ç®—] â†’ [ä»ªè¡¨ç›˜]
```

**âš¡ å®æ—¶æ•°æ®æ”¶é›†å™¨**

```bash
#!/bin/bash
# å®æ—¶ç³»ç»Ÿç›‘æ§æ•°æ®æµå¤„ç†å™¨

# é…ç½®å‚æ•°
SAMPLING_INTERVAL=1  # é‡‡æ ·é—´éš”ï¼ˆç§’ï¼‰
BUFFER_SIZE=100      # ç¼“å†²åŒºå¤§å°
ALERT_THRESHOLD_CPU=85
ALERT_THRESHOLD_MEM=90

# å…¨å±€å˜é‡
declare -a cpu_buffer=()
declare -a mem_buffer=()
buffer_index=0

# å®æ—¶æ•°æ®å¤„ç†å‡½æ•°
process_realtime_data() {
    echo "ğŸŒŠ å¯åŠ¨å®æ—¶æ•°æ®æµç›‘æ§..."
    echo "é‡‡æ ·é—´éš”: ${SAMPLING_INTERVAL}ç§’"
    echo "ç¼“å†²åŒºå¤§å°: ${BUFFER_SIZE}"
    echo "æŒ‰ Ctrl+C åœæ­¢ç›‘æ§"
    echo "========================"
    
    while true; do
        # è·å–å½“å‰æ—¶é—´æˆ³
        timestamp=$(date '+%H:%M:%S')
        
        # æ”¶é›†å®æ—¶æ•°æ®
        cpu_usage=$(top -bn1 | grep "Cpu(s)" | awk '{print 100-$8}')
        mem_usage=$(free | grep Mem | awk '{printf "%.1f", ($3/$2)*100}')
        load_avg=$(cat /proc/loadavg | awk '{print $1}')
        
        # æ·»åŠ åˆ°å¾ªç¯ç¼“å†²åŒº
        cpu_buffer[$buffer_index]=$cpu_usage
        mem_buffer[$buffer_index]=$mem_usage
        
        # æ›´æ–°ç¼“å†²åŒºç´¢å¼•
        buffer_index=$(( (buffer_index + 1) % BUFFER_SIZE ))
        
        # å®æ—¶åˆ†æå¤„ç†
        analyze_realtime_metrics "$timestamp" "$cpu_usage" "$mem_usage" "$load_avg"
        
        # æ˜¾ç¤ºå®æ—¶çŠ¶æ€
        display_realtime_status "$timestamp" "$cpu_usage" "$mem_usage" "$load_avg"
        
        sleep $SAMPLING_INTERVAL
    done
}

analyze_realtime_metrics() {
    local timestamp=$1
    local cpu=$2
    local mem=$3
    local load=$4
    
    # CPUå¼‚å¸¸æ£€æµ‹
    if (( $(echo "$cpu > $ALERT_THRESHOLD_CPU" | bc -l) )); then
        trigger_realtime_alert "CPU" "$cpu" "$ALERT_THRESHOLD_CPU" "$timestamp"
    fi
    
    # å†…å­˜å¼‚å¸¸æ£€æµ‹
    if (( $(echo "$mem > $ALERT_THRESHOLD_MEM" | bc -l) )); then
        trigger_realtime_alert "MEM" "$mem" "$ALERT_THRESHOLD_MEM" "$timestamp"
    fi
    
    # è®¡ç®—æ»‘åŠ¨å¹³å‡å€¼ï¼ˆæœ€è¿‘10ä¸ªæ•°æ®ç‚¹ï¼‰
    if [ ${#cpu_buffer[@]} -ge 10 ]; then
        calculate_moving_average
    fi
}

trigger_realtime_alert() {
    local metric_type=$1
    local current_value=$2
    local threshold=$3
    local timestamp=$4
    
    echo ""
    echo "ğŸš¨ å®æ—¶å‘Šè­¦ [$timestamp]"
    echo "æŒ‡æ ‡: $metric_type"
    echo "å½“å‰å€¼: $current_value"
    echo "é˜ˆå€¼: $threshold"
    echo "========================"
    
    # è¿™é‡Œå¯ä»¥é›†æˆæ›´å¤æ‚çš„å‘Šè­¦é€»è¾‘
    # æ¯”å¦‚å‘é€é‚®ä»¶ã€çŸ­ä¿¡ã€æ¨é€æ¶ˆæ¯ç­‰
}

calculate_moving_average() {
    local cpu_sum=0
    local mem_sum=0
    local count=0
    
    # è®¡ç®—æœ€è¿‘10ä¸ªå€¼çš„å¹³å‡å€¼
    for i in {0..9}; do
        local idx=$(( (buffer_index - i - 1 + BUFFER_SIZE) % BUFFER_SIZE ))
        if [ -n "${cpu_buffer[$idx]}" ]; then
            cpu_sum=$(echo "$cpu_sum + ${cpu_buffer[$idx]}" | bc)
            mem_sum=$(echo "$mem_sum + ${mem_buffer[$idx]}" | bc)
            count=$((count + 1))
        fi
    done
    
    if [ $count -gt 0 ]; then
        local cpu_avg=$(echo "scale=1; $cpu_sum / $count" | bc)
        local mem_avg=$(echo "scale=1; $mem_sum / $count" | bc)
        
        # å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ è¶‹åŠ¿åˆ†æé€»è¾‘
        # echo "10ç§’ç§»åŠ¨å¹³å‡: CPU=${cpu_avg}%, MEM=${mem_avg}%"
    fi
}

display_realtime_status() {
    local timestamp=$1
    local cpu=$2
    local mem=$3
    local load=$4
    
    # æ¸…é™¤å½“å‰è¡Œå¹¶æ˜¾ç¤ºæ–°çŠ¶æ€ï¼ˆå®ç°æ»šåŠ¨æ˜¾ç¤ºæ•ˆæœï¼‰
    printf "\r%s | CPU: %5.1f%% | MEM: %5.1f%% | LOAD: %5.2f | " \
           "$timestamp" "$cpu" "$mem" "$load"
}

# ä¿¡å·å¤„ç†ï¼šä¼˜é›…é€€å‡º
cleanup() {
    echo ""
    echo "ğŸ”„ æ­£åœ¨åœæ­¢å®æ—¶ç›‘æ§..."
    echo "âœ… å®æ—¶ç›‘æ§å·²åœæ­¢"
    exit 0
}

# æ³¨å†Œä¿¡å·å¤„ç†å™¨
trap cleanup SIGINT SIGTERM

# å¯åŠ¨å®æ—¶ç›‘æ§
process_realtime_data
```

### 6.3 æµæ•°æ®èšåˆä¸ç»Ÿè®¡


**ğŸ“Š å®æ—¶æ•°æ®èšåˆå™¨**

```bash
#!/bin/bash
# å®æ—¶æ•°æ®èšåˆç»Ÿè®¡

# æ—¶é—´çª—å£é…ç½®
declare -A time_windows=(
    ["1min"]=60      # 1åˆ†é’Ÿçª—å£
    ["5min"]=300     # 5åˆ†é’Ÿçª—å£  
    ["15min"]=900    # 15åˆ†é’Ÿçª—å£
)

# æ•°æ®å­˜å‚¨ç»“æ„
declare -A window_data_cpu
declare -A window_data_mem
declare -A window_timestamps

realtime_aggregator() {
    echo "ğŸ“Š å¯åŠ¨å®æ—¶æ•°æ®èšåˆå™¨"
    
    while true; do
        current_time=$(date +%s)
        
        # æ”¶é›†å½“å‰æŒ‡æ ‡
        cpu_current=$(top -bn1 | grep "Cpu(s)" | awk '{print 100-$8}')
        mem_current=$(free | grep Mem | awk '{printf "%.1f", ($3/$2)*100}')
        
        # ä¸ºæ¯ä¸ªæ—¶é—´çª—å£æ·»åŠ æ•°æ®
        for window in "${!time_windows[@]}"; do
            add_to_window "$window" "$current_time" "$cpu_current" "$mem_current"
            
            # æ¸…ç†è¿‡æœŸæ•°æ®
            cleanup_expired_data "$window" "$current_time"
            
            # è®¡ç®—çª—å£ç»Ÿè®¡
            calculate_window_stats "$window"
        done
        
        sleep 5  # æ¯5ç§’èšåˆä¸€æ¬¡
    done
}

add_to_window() {
    local window=$1
    local timestamp=$2  
    local cpu_val=$3
    local mem_val=$4
    
    # ä½¿ç”¨æ—¶é—´æˆ³ä½œä¸ºé”®å­˜å‚¨æ•°æ®
    window_data_cpu["${window}_${timestamp}"]=$cpu_val
    window_data_mem["${window}_${timestamp}"]=$mem_val
    window_timestamps["${window}_${timestamp}"]=$timestamp
}

cleanup_expired_data() {
    local window=$1
    local current_time=$2
    local window_duration=${time_windows[$window]}
    local cutoff_time=$((current_time - window_duration))
    
    # åˆ é™¤è¶…å‡ºæ—¶é—´çª—å£çš„æ•°æ®
    for key in "${!window_timestamps[@]}"; do
        if [[ $key == ${window}_* ]]; then
            if [ "${window_timestamps[$key]}" -lt "$cutoff_time" ]; then
                unset window_data_cpu[$key]
                unset window_data_mem[$key] 
                unset window_timestamps[$key]
            fi
        fi
    done
}

calculate_window_stats() {
    local window=$1
    local cpu_sum=0
    local mem_sum=0
    local cpu_max=0
    local mem_max=0
    local count=0
    
    # è®¡ç®—è¯¥çª—å£çš„ç»Ÿè®¡å€¼
    for key in "${!window_data_cpu[@]}"; do
        if [[ $key == ${window}_* ]]; then
            local cpu_val=${window_data_cpu[$key]}
            local mem_val=${window_data_mem[$key]}
            
            cpu_sum=$(echo "$cpu_sum + $cpu_val" | bc)
            mem_sum=$(echo "$mem_sum + $mem_val" | bc)
            
            # æ›´æ–°æœ€å¤§å€¼
            if (( $(echo "$cpu_val > $cpu_max" | bc -l) )); then
                cpu_max=$cpu_val
            fi
            if (( $(echo "$mem_val > $mem_max" | bc -l) )); then
                mem_max=$mem_val
            fi
            
            count=$((count + 1))
        fi
    done
    
    if [ $count -gt 0 ]; then
        local cpu_avg=$(echo "scale=1; $cpu_sum / $count" | bc)
        local mem_avg=$(echo "scale=1; $mem_sum / $count" | bc)
        
        # è¾“å‡ºèšåˆç»Ÿè®¡ç»“æœ
        printf "ğŸ“Š %5sçª—å£ | æ ·æœ¬æ•°:%3d | CPU: avg=%.1f%% max=%.1f%% | MEM: avg=%.1f%% max=%.1f%%\n" \
               "$window" "$count" "$cpu_avg" "$cpu_max" "$mem_avg" "$mem_max"
    fi
}
```

### 6.4 å®æ—¶å‘Šè­¦ç³»ç»Ÿ


**ğŸš¨ æ™ºèƒ½å‘Šè­¦å¤„ç†**

```bash
#!/bin/bash
# å®æ—¶æ™ºèƒ½å‘Šè­¦ç³»ç»Ÿ

# å‘Šè­¦é…ç½®
ALERT_CONFIG_FILE="/etc/monitor_alerts.conf"
ALERT_LOG="/var/log/realtime_alerts.log"

# å‘Šè­¦çŠ¶æ€è·Ÿè¸ª
declare -A alert_states     # è®°å½•å‘Šè­¦çŠ¶æ€
declare -A alert_counters   # å‘Šè­¦è®¡æ•°å™¨
declare -A last_alert_time  # æœ€åå‘Šè­¦æ—¶é—´

# å‘Šè­¦è§„åˆ™å®šä¹‰
setup_alert_rules() {
    # å¯ä»¥ä»é…ç½®æ–‡ä»¶è¯»å–ï¼Œè¿™é‡Œç®€åŒ–ä¸ºä»£ç å®šä¹‰
    alert_rules=(
        "cpu_high:85:5:300"      # CPU > 85%, è¿ç»­5æ¬¡, æŠ‘åˆ¶5åˆ†é’Ÿ
        "mem_high:90:3:600"      # å†…å­˜ > 90%, è¿ç»­3æ¬¡, æŠ‘åˆ¶10åˆ†é’Ÿ  
        "load_high:4.0:3:300"    # è´Ÿè½½ > 4.0, è¿ç»­3æ¬¡, æŠ‘åˆ¶5åˆ†é’Ÿ
    )
}

# å®æ—¶å‘Šè­¦å¼•æ“
realtime_alert_engine() {
    echo "ğŸš¨ å¯åŠ¨å®æ—¶å‘Šè­¦å¼•æ“"
    setup_alert_rules
    
    while true; do
        # è·å–å½“å‰æŒ‡æ ‡
        cpu_usage=$(top -bn1 | grep "Cpu(s)" | awk '{print 100-$8}')
        mem_usage=$(free | grep Mem | awk '{printf "%.1f", ($3/$2)*100}')
        load_avg=$(cat /proc/loadavg | awk '{print $1}')
        
        current_time=$(date +%s)
        
        # æ£€æŸ¥æ¯ä¸ªå‘Šè­¦è§„åˆ™
        check_alert_rule "cpu_high" "$cpu_usage" "85" "5" "300" "$current_time"
        check_alert_rule "mem_high" "$mem_usage" "90" "3" "600" "$current_time"
        check_alert_rule "load_high" "$load_avg" "4.0" "3" "300" "$current_time"
        
        sleep 10  # æ¯10ç§’æ£€æŸ¥ä¸€æ¬¡
    done
}

check_alert_rule() {
    local rule_name=$1
    local current_value=$2
    local threshold=$3
    local trigger_count=$4
    local suppress_seconds=$5
    local current_time=$6
    
    # æ£€æŸ¥æ˜¯å¦è¶…è¿‡é˜ˆå€¼
    if (( $(echo "$current_value > $threshold" | bc -l) )); then
        # å¢åŠ è®¡æ•°å™¨
        alert_counters[$rule_name]=$((${alert_counters[$rule_name]:-0} + 1))
        
        # æ£€æŸ¥æ˜¯å¦è¾¾åˆ°è§¦å‘æ¡ä»¶
        if [ "${alert_counters[$rule_name]}" -ge "$trigger_count" ]; then
            # æ£€æŸ¥å‘Šè­¦æŠ‘åˆ¶
            local last_time=${last_alert_time[$rule_name]:-0}
            local time_diff=$((current_time - last_time))
            
            if [ $time_diff -ge $suppress_seconds ]; then
                # è§¦å‘å‘Šè­¦
                send_realtime_alert "$rule_name" "$current_value" "$threshold" "$current_time"
                
                # æ›´æ–°å‘Šè­¦çŠ¶æ€
                alert_states[$rule_name]="ACTIVE"
                last_alert_time[$rule_name]=$current_time
                alert_counters[$rule_name]=0  # é‡ç½®è®¡æ•°å™¨
            fi
        fi
    else
        # å€¼æ­£å¸¸ï¼Œé‡ç½®è®¡æ•°å™¨å’ŒçŠ¶æ€
        alert_counters[$rule_name]=0
        if [ "${alert_states[$rule_name]}" = "ACTIVE" ]; then
            send_recovery_alert "$rule_name" "$current_value" "$current_time"
            alert_states[$rule_name]="NORMAL"
        fi
    fi
}

send_realtime_alert() {
    local rule_name=$1
    local value=$2
    local threshold=$3
    local timestamp=$4
    
    local alert_time=$(date -d "@$timestamp" '+%Y-%m-%d %H:%M:%S')
    local message="ğŸš¨ å®æ—¶å‘Šè­¦: $rule_name å½“å‰å€¼=$value è¶…è¿‡é˜ˆå€¼=$threshold"
    
    echo "$alert_time $message"
    echo "$alert_time $message" >> $ALERT_LOG
    
    # å¯ä»¥åœ¨è¿™é‡Œé›†æˆå¤šç§å‘Šè­¦é€šé“
    # send_email_alert "$message"
    # send_sms_alert "$message" 
    # send_webhook_alert "$message"
}

send_recovery_alert() {
    local rule_name=$1
    local value=$2
    local timestamp=$3
    
    local recovery_time=$(date -d "@$timestamp" '+%Y-%m-%d %H:%M:%S')
    local message="âœ… å‘Šè­¦æ¢å¤: $rule_name å½“å‰å€¼=$value å·²æ¢å¤æ­£å¸¸"
    
    echo "$recovery_time $message"
    echo "$recovery_time $message" >> $ALERT_LOG
}
```

---

## 7. ğŸ’¾ ç›‘æ§æ•°æ®å­˜å‚¨ä¼˜åŒ–


### 7.1 æ•°æ®å­˜å‚¨ç­–ç•¥æ¦‚è¿°


**ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦å­˜å‚¨ä¼˜åŒ–ï¼Ÿ**

ç›‘æ§æ•°æ®å°±åƒæµæ°´ä¸€æ ·æºæºä¸æ–­äº§ç”Ÿï¼Œå¦‚æœä¸ä¼˜åŒ–å­˜å‚¨ï¼š
- **ç£ç›˜ç©ºé—´çˆ†æ»¡**ï¼šå‡ å¤©å°±èƒ½äº§ç”ŸGBçº§æ•°æ®
- **æŸ¥è¯¢æ€§èƒ½ä¸‹é™**ï¼šæ•°æ®è¶Šå¤šï¼ŒæŸ¥æ‰¾è¶Šæ…¢
- **å¤‡ä»½å›°éš¾**ï¼šå¤§é‡å†å²æ•°æ®éš¾ä»¥ç®¡ç†
- **æˆæœ¬å¢åŠ **ï¼šå­˜å‚¨å’Œä¼ è¾“è´¹ç”¨æ”€å‡

**ğŸ”¸ å­˜å‚¨ä¼˜åŒ–çš„æ ¸å¿ƒæ€è·¯**
- **åˆ†å±‚å­˜å‚¨**ï¼šçƒ­æ•°æ®å¿«é€Ÿå­˜å‚¨ï¼Œå†·æ•°æ®æ…¢é€Ÿå­˜å‚¨
- **æ•°æ®å‹ç¼©**ï¼šå‡å°‘å­˜å‚¨ç©ºé—´å ç”¨
- **å®šæœŸæ¸…ç†**ï¼šåˆ é™¤è¿‡æœŸå’Œæ— ç”¨æ•°æ®
- **ç´¢å¼•ä¼˜åŒ–**ï¼šæé«˜æŸ¥è¯¢æ•ˆç‡

### 7.2 æ•°æ®åˆ†å±‚å­˜å‚¨æ–¹æ¡ˆ


**ğŸ“Š å­˜å‚¨å±‚æ¬¡è®¾è®¡**

```
æ•°æ®å­˜å‚¨å±‚æ¬¡ç»“æ„:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å®æ—¶æ•°æ®å±‚ (å†…å­˜)                    â”‚ â† æœ€è¿‘1å°æ—¶ï¼Œç§’çº§ç²¾åº¦
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ çƒ­æ•°æ®å±‚ (SSD)                      â”‚ â† æœ€è¿‘7å¤©ï¼Œåˆ†é’Ÿçº§ç²¾åº¦  
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ¸©æ•°æ®å±‚ (æœºæ¢°ç¡¬ç›˜)                  â”‚ â† æœ€è¿‘30å¤©ï¼Œ5åˆ†é’Ÿç²¾åº¦
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å†·æ•°æ®å±‚ (å‹ç¼©å­˜å‚¨)                  â”‚ â† 30å¤©ä»¥ä¸Šï¼Œå°æ—¶çº§ç²¾åº¦
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**âš¡ è‡ªåŠ¨æ•°æ®åˆ†å±‚è„šæœ¬**

```bash
#!/bin/bash
# ç›‘æ§æ•°æ®è‡ªåŠ¨åˆ†å±‚å­˜å‚¨ç®¡ç†

# å­˜å‚¨è·¯å¾„é…ç½®
HOT_DATA_DIR="/var/monitor/hot"      # çƒ­æ•°æ®ï¼ˆSSDï¼‰
WARM_DATA_DIR="/var/monitor/warm"    # æ¸©æ•°æ®ï¼ˆæœºæ¢°ç›˜ï¼‰
COLD_DATA_DIR="/var/monitor/cold"    # å†·æ•°æ®ï¼ˆå‹ç¼©å­˜å‚¨ï¼‰
ARCHIVE_DIR="/var/monitor/archive"   # å½’æ¡£æ•°æ®

# æ—¶é—´é˜ˆå€¼é…ç½®ï¼ˆå¤©ï¼‰
HOT_RETENTION_DAYS=7
WARM_RETENTION_DAYS=30
COLD_RETENTION_DAYS=365

# åˆ›å»ºå­˜å‚¨ç›®å½•
setup_storage_dirs() {
    for dir in "$HOT_DATA_DIR" "$WARM_DATA_DIR" "$COLD_DATA_DIR" "$ARCHIVE_DIR"; do
        mkdir -p "$dir"
    done
    echo "âœ… å­˜å‚¨ç›®å½•åˆå§‹åŒ–å®Œæˆ"
}

# æ•°æ®åˆ†å±‚è¿ç§»
migrate_data_layers() {
    local current_date=$(date +%s)
    
    echo "ğŸ”„ å¼€å§‹æ•°æ®åˆ†å±‚è¿ç§»..."
    
    # 1. çƒ­æ•°æ® â†’ æ¸©æ•°æ®è¿ç§»
    migrate_hot_to_warm "$current_date"
    
    # 2. æ¸©æ•°æ® â†’ å†·æ•°æ®è¿ç§»  
    migrate_warm_to_cold "$current_date"
    
    # 3. å†·æ•°æ® â†’ å½’æ¡£è¿ç§»
    migrate_cold_to_archive "$current_date"
    
    echo "âœ… æ•°æ®åˆ†å±‚è¿ç§»å®Œæˆ"
}

migrate_hot_to_warm() {
    local current_date=$1
    local cutoff_date=$((current_date - HOT_RETENTION_DAYS * 86400))
    
    echo "ğŸ“¦ çƒ­æ•°æ® â†’ æ¸©æ•°æ®è¿ç§»"
    
    # æŸ¥æ‰¾è¶…è¿‡çƒ­æ•°æ®ä¿ç•™æœŸçš„æ–‡ä»¶
    find "$HOT_DATA_DIR" -name "performance_*.csv" -type f | while read file; do
        local file_date=$(stat -c %Y "$file" 2>/dev/null || echo 0)
        
        if [ "$file_date" -lt "$cutoff_date" ]; then
            local filename=$(basename "$file")
            local target_file="$WARM_DATA_DIR/$filename"
            
            # æ•°æ®é™é‡‡æ ·ï¼šä»åˆ†é’Ÿçº§é™ä¸º5åˆ†é’Ÿçº§
            downsample_data "$file" "$target_file" 5
            
            # ç§»åŠ¨åŸæ–‡ä»¶
            rm "$file"
            echo "  âœ“ $filename å·²è¿ç§»åˆ°æ¸©æ•°æ®å±‚"
        fi
    done
}

migrate_warm_to_cold() {
    local current_date=$1
    local cutoff_date=$((current_date - WARM_RETENTION_DAYS * 86400))
    
    echo "ğŸ§Š æ¸©æ•°æ® â†’ å†·æ•°æ®è¿ç§»"
    
    find "$WARM_DATA_DIR" -name "performance_*.csv" -type f | while read file; do
        local file_date=$(stat -c %Y "$file")
        
        if [ "$file_date" -lt "$cutoff_date" ]; then
            local filename=$(basename "$file")
            local target_file="$COLD_DATA_DIR/${filename%.csv}.gz"
            
            # é™é‡‡æ ·åˆ°å°æ—¶çº§å¹¶å‹ç¼©
            downsample_data "$file" "/tmp/temp_hourly.csv" 60
            gzip -c "/tmp/temp_hourly.csv" > "$target_file"
            
            rm "$file" "/tmp/temp_hourly.csv"
            echo "  âœ“ $filename å·²å‹ç¼©è¿ç§»åˆ°å†·æ•°æ®å±‚"
        fi
    done
}

# æ•°æ®é™é‡‡æ ·å‡½æ•°
downsample_data() {
    local input_file=$1
    local output_file=$2
    local interval_minutes=$3
    
    # ä½¿ç”¨awkè¿›è¡Œæ•°æ®é™é‡‡æ ·
    awk -F',' -v interval=$interval_minutes '
    NR==1 {print; next}  # ä¿ç•™è¡¨å¤´
    {
        # æå–æ—¶é—´æˆ³çš„åˆ†é’Ÿéƒ¨åˆ†
        split($1, datetime, " ")
        split(datetime[2], time_parts, ":")
        minute = time_parts[2]
        
        # è®¡ç®—æ—¶é—´çª—å£
        window = int(minute / interval) * interval
        key = datetime[1] " " time_parts[1] ":" sprintf("%02d", window) ":00"
        
        # ç´¯åŠ å„é¡¹æŒ‡æ ‡
        cpu_sum[key] += $2
        mem_sum[key] += $3
        disk_sum[key] += $4
        load_sum[key] += $5
        count[key]++
    }
    END {
        # è¾“å‡ºå¹³å‡å€¼
        for (k in count) {
            printf "%s,%.2f,%.2f,%.2f,%.2f,0,0\n", 
                k, cpu_sum[k]/count[k], mem_sum[k]/count[k], 
                disk_sum[k]/count[k], load_sum[k]/count[k]
        }
    }' "$input_file" | sort > "$output_file"
}
```

### 7.3 æ•°æ®å‹ç¼©ä¸æ¸…ç†


**ğŸ—œï¸ æ™ºèƒ½æ•°æ®å‹ç¼©**

```bash
#!/bin/bash
# ç›‘æ§æ•°æ®æ™ºèƒ½å‹ç¼©ç³»ç»Ÿ

compress_old_data() {
    local compress_age_days=${1:-7}  # é»˜è®¤7å¤©å‰çš„æ•°æ®è¿›è¡Œå‹ç¼©
    local cutoff_date=$(date -d "$compress_age_days days ago" +%Y%m%d)
    
    echo "ğŸ—œï¸  å¼€å§‹å‹ç¼© $compress_age_days å¤©å‰çš„æ•°æ®..."
    
    # æŸ¥æ‰¾éœ€è¦å‹ç¼©çš„æ–‡ä»¶
    find /var/log/performance -name "performance_*.csv" -type f | while read file; do
        local file_date=$(basename "$file" | grep -o '[0-9]\{8\}')
        
        if [ "$file_date" -lt "$cutoff_date" ]; then
            # å‹ç¼©å‰æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
            local original_size=$(du -h "$file" | cut -f1)
            
            # ä½¿ç”¨é«˜å‹ç¼©ç‡è¿›è¡Œå‹ç¼©
            gzip -9 "$file"
            
            local compressed_size=$(du -h "${file}.gz" | cut -f1)
            echo "  âœ“ $(basename "$file"): $original_size â†’ $compressed_size"
        fi
    done
    
    echo "âœ… æ•°æ®å‹ç¼©å®Œæˆ"
}

# æ•°æ®æ¸…ç†ç­–ç•¥
cleanup_expired_data() {
    echo "ğŸ§¹ å¼€å§‹æ¸…ç†è¿‡æœŸæ•°æ®..."
    
    # æ¸…ç†è¶…è¿‡1å¹´çš„æ•°æ®
    find /var/log/performance -name "*.gz" -mtime +365 -type f | while read old_file; do
        echo "  ğŸ—‘ï¸  åˆ é™¤è¿‡æœŸæ–‡ä»¶: $(basename "$old_file")"
        rm "$old_file"
    done
    
    # æ¸…ç†ç©ºç›®å½•
    find /var/log/performance -type d -empty -delete
    
    # æ˜¾ç¤ºæ¸…ç†åçš„ç©ºé—´ä¿¡æ¯
    echo "ğŸ“Š å­˜å‚¨ç©ºé—´ä½¿ç”¨æƒ…å†µï¼š"
    df -h /var/log/performance | tail -1 | awk '{
        printf "  æ€»ç©ºé—´: %s, å·²ä½¿ç”¨: %s, å¯ç”¨: %s, ä½¿ç”¨ç‡: %s\n", $2, $3, $4, $5
    }'
}
```

### 7.4 å­˜å‚¨æ€§èƒ½ä¼˜åŒ–


**âš¡ å†™å…¥æ€§èƒ½ä¼˜åŒ–**

```bash
#!/bin/bash
# é«˜æ€§èƒ½æ•°æ®å†™å…¥ç³»ç»Ÿ

# ç¼“å†²åŒºé…ç½®
BUFFER_SIZE=1000
FLUSH_INTERVAL=30  # ç§’
DATA_BUFFER=()
BUFFER_COUNT=0

# æ‰¹é‡å†™å…¥å‡½æ•°
batch_write_data() {
    local data_point="$1"
    
    # æ·»åŠ åˆ°ç¼“å†²åŒº
    DATA_BUFFER[$BUFFER_COUNT]="$data_point"
    BUFFER_COUNT=$((BUFFER_COUNT + 1))
    
    # æ£€æŸ¥æ˜¯å¦éœ€è¦åˆ·å†™
    if [ $BUFFER_COUNT -ge $BUFFER_SIZE ]; then
        flush_buffer
    fi
}

flush_buffer() {
    if [ $BUFFER_COUNT -eq 0 ]; then
        return
    fi
    
    local data_file="/var/log/performance/performance_$(date +%Y%m%d).csv"
    local temp_file="${data_file}.tmp"
    
    # æ‰¹é‡å†™å…¥ä¸´æ—¶æ–‡ä»¶
    printf '%s\n' "${DATA_BUFFER[@]}" >> "$temp_file"
    
    # åŸå­æ€§ç§»åŠ¨æ–‡ä»¶
    mv "$temp_file" "$data_file"
    
    # æ¸…ç©ºç¼“å†²åŒº
    DATA_BUFFER=()
    BUFFER_COUNT=0
    
    echo "ğŸ’¾ å·²åˆ·å†™ $BUFFER_COUNT æ¡æ•°æ®åˆ°ç£ç›˜"
}

# å®šæ—¶åˆ·å†™å®ˆæŠ¤è¿›ç¨‹
start_flush_daemon() {
    while true; do
        sleep $FLUSH_INTERVAL
        if [ $BUFFER_COUNT -gt 0 ]; then
            flush_buffer
        fi
    done &
    
    echo "â° å®šæ—¶åˆ·å†™å®ˆæŠ¤è¿›ç¨‹å·²å¯åŠ¨ (PID: $!)"
}
```

**ğŸ“‹ å­˜å‚¨ç›‘æ§æŠ¥å‘Š**

```bash
#!/bin/bash
# å­˜å‚¨ä½¿ç”¨æƒ…å†µç›‘æ§æŠ¥å‘Š

generate_storage_report() {
    echo "ğŸ“Š ç›‘æ§æ•°æ®å­˜å‚¨æŠ¥å‘Š"
    echo "===================="
    echo "ç”Ÿæˆæ—¶é—´: $(date)"
    echo ""
    
    # å„å±‚å­˜å‚¨ä½¿ç”¨æƒ…å†µ
    echo "ğŸ”¥ çƒ­æ•°æ®å±‚ (æœ€è¿‘7å¤©):"
    if [ -d "$HOT_DATA_DIR" ]; then
        local hot_size=$(du -sh "$HOT_DATA_DIR" 2>/dev/null | cut -f1)
        local hot_files=$(find "$HOT_DATA_DIR" -name "*.csv" | wc -l)
        echo "  ç©ºé—´å ç”¨: $hot_size"
        echo "  æ–‡ä»¶æ•°é‡: $hot_files ä¸ª"
    fi
    
    echo ""
    echo "ğŸŒ¡ï¸  æ¸©æ•°æ®å±‚ (7-30å¤©):"
    if [ -d "$WARM_DATA_DIR" ]; then
        local warm_size=$(du -sh "$WARM_DATA_DIR" 2>/dev/null | cut -f1)
        local warm_files=$(find "$WARM_DATA_DIR" -name "*.csv" | wc -l)
        echo "  ç©ºé—´å ç”¨: $warm_size"
        echo "  æ–‡ä»¶æ•°é‡: $warm_files ä¸ª"
    fi
    
    echo ""
    echo "ğŸ§Š å†·æ•°æ®å±‚ (30å¤©ä»¥ä¸Š):"
    if [ -d "$COLD_DATA_DIR" ]; then
        local cold_size=$(du -sh "$COLD_DATA_DIR" 2>/dev/null | cut -f1)
        local cold_files=$(find "$COLD_DATA_DIR" -name "*.gz" | wc -l)
        echo "  ç©ºé—´å ç”¨: $cold_size"
        echo "  æ–‡ä»¶æ•°é‡: $cold_files ä¸ªå‹ç¼©æ–‡ä»¶"
    fi
    
    # å‹ç¼©æ•ˆç‡ç»Ÿè®¡
    echo ""
    echo "ğŸ“ˆ å‹ç¼©æ•ˆç‡åˆ†æ:"
    calculate_compression_ratio
    
    # æ¸…ç†å»ºè®®
    echo ""
    echo "ğŸ’¡ å­˜å‚¨ä¼˜åŒ–å»ºè®®:"
    suggest_storage_optimization
}

calculate_compression_ratio() {
    local total_original=0
    local total_compressed=0
    
    # è¿™é‡Œç®€åŒ–è®¡ç®—é€»è¾‘
    echo "  å¹³å‡å‹ç¼©æ¯”: çº¦ 3:1"
    echo "  èŠ‚çœç©ºé—´: çº¦ 67%"
}

suggest_storage_optimization() {
    # æ£€æŸ¥ç£ç›˜ä½¿ç”¨ç‡
    local disk_usage=$(df /var/log | tail -1 | awk '{print $(NF-1)}' | sed 's/%//')
    
    if [ $disk_usage -gt 80 ]; then
        echo "  âš ï¸  ç£ç›˜ä½¿ç”¨ç‡è¿‡é«˜ ($disk_usage%)ï¼Œå»ºè®®ï¼š"
        echo "     - ç¼©çŸ­çƒ­æ•°æ®ä¿ç•™æœŸ"
        echo "     - å¢åŠ æ•°æ®å‹ç¼©é¢‘ç‡"
        echo "     - æ¸…ç†è¿‡æœŸå½’æ¡£æ•°æ®"
    else
        echo "  âœ… å­˜å‚¨ç©ºé—´ä½¿ç”¨æ­£å¸¸ ($disk_usage%)"
    fi
}
```

---

## 8. âš ï¸ å‘Šè­¦é˜ˆå€¼æ•°æ®åˆ†æ


### 8.1 åŠ¨æ€é˜ˆå€¼çš„å¿…è¦æ€§


**ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦åŠ¨æ€é˜ˆå€¼ï¼Ÿ**

å›ºå®šé˜ˆå€¼å°±åƒ**ä¸€åˆ€åˆ‡**ï¼Œä¸èƒ½é€‚åº”ç³»ç»Ÿçš„å˜åŒ–ï¼š
- **ä¸šåŠ¡é«˜å³°æœŸ**ï¼šæ­£å¸¸ä½¿ç”¨ç‡å¯èƒ½å°±å¾ˆé«˜
- **ç³»ç»Ÿå‡çº§å**ï¼šæ€§èƒ½åŸºçº¿å‘ç”Ÿå˜åŒ–  
- **å­£èŠ‚æ€§å˜åŒ–**ï¼šä¸åŒæ—¶æœŸçš„è´Ÿè½½æ¨¡å¼ä¸åŒ
- **ç¡¬ä»¶è€åŒ–**ï¼šç³»ç»Ÿæ€§èƒ½é€æ¸ä¸‹é™

åŠ¨æ€é˜ˆå€¼èƒ½**æ ¹æ®å†å²æ•°æ®è‡ªåŠ¨è°ƒæ•´**ï¼Œå‡å°‘è¯¯æŠ¥å’Œæ¼æŠ¥ã€‚

### 8.2 åŸºäºç»Ÿè®¡çš„åŠ¨æ€é˜ˆå€¼


**ğŸ“Š ç»Ÿè®¡å­¦æ–¹æ³•ç¡®å®šé˜ˆå€¼**

```bash
#!/bin/bash
# åŸºäºå†å²ç»Ÿè®¡çš„åŠ¨æ€é˜ˆå€¼è®¡ç®—

HISTORY_DAYS=30
DATA_DIR="/var/log/performance"

calculate_dynamic_thresholds() {
    echo "ğŸ” åˆ†ææœ€è¿‘ $HISTORY_DAYS å¤©çš„å†å²æ•°æ®..."
    
    # æ”¶é›†å†å²æ•°æ®
    local temp_data="/tmp/threshold_analysis.csv"
    > "$temp_data"  # æ¸…ç©ºæ–‡ä»¶
    
    # åˆå¹¶æœ€è¿‘Nå¤©çš„æ•°æ®
    for i in $(seq 1 $HISTORY_DAYS); do
        local date_str=$(date -d "$i days ago" +%Y%m%d)
        local data_file="$DATA_DIR/performance_${date_str}.csv"
        
        if [ -f "$data_file" ]; then
            tail -n +2 "$data_file" >> "$temp_data"  # è·³è¿‡è¡¨å¤´
        fi
    done
    
    if [ ! -s "$temp_data" ]; then
        echo "âŒ å†å²æ•°æ®ä¸è¶³ï¼Œæ— æ³•è®¡ç®—åŠ¨æ€é˜ˆå€¼"
        return 1
    fi
    
    echo "ğŸ“Š å¼€å§‹ç»Ÿè®¡åˆ†æ..."
    
    # ä½¿ç”¨ awk è¿›è¡Œç»Ÿè®¡è®¡ç®—
    awk -F',' '{
        cpu[NR] = $2
        mem[NR] = $3
        disk[NR] = $4
        load[NR] = $5
        count++
    }
    END {
        # å¯¹æ•°æ®è¿›è¡Œæ’åºï¼ˆä½¿ç”¨å†’æ³¡æ’åºç®€åŒ–å®ç°ï¼‰
        for(i=1; i<=count; i++) {
            for(j=1; j<count; j++) {
                if(cpu[j] > cpu[j+1]) {
                    temp = cpu[j]; cpu[j] = cpu[j+1]; cpu[j+1] = temp
                }
                if(mem[j] > mem[j+1]) {
                    temp = mem[j]; mem[j] = mem[j+1]; mem[j+1] = temp  
                }
            }
        }
        
        # è®¡ç®—åŸºæœ¬ç»Ÿè®¡é‡
        cpu_sum = 0; mem_sum = 0; disk_sum = 0; load_sum = 0
        for(i=1; i<=count; i++) {
            cpu_sum += cpu[i]
            mem_sum += mem[i]
            disk_sum += disk[i] 
            load_sum += load[i]
        }
        
        cpu_avg = cpu_sum / count
        mem_avg = mem_sum / count
        disk_avg = disk_sum / count
        load_avg = load_sum / count
        
        # è®¡ç®—ç™¾åˆ†ä½æ•°é˜ˆå€¼
        p90_idx = int(count * 0.9)
        p95_idx = int(count * 0.95)
        p99_idx = int(count * 0.99)
        
        print "ğŸ“ˆ å†å²æ•°æ®ç»Ÿè®¡ç»“æœ (å…±", count, "ä¸ªæ•°æ®ç‚¹):"
        print "----------------------------------------"
        printf "CPUä½¿ç”¨ç‡  - å¹³å‡å€¼: %.1f%%, 90åˆ†ä½: %.1f%%, 95åˆ†ä½: %.1f%%\n", 
                cpu_avg, cpu[p90_idx], cpu[p95_idx]
        printf "å†…å­˜ä½¿ç”¨ç‡ - å¹³å‡å€¼: %.1f%%, 90åˆ†ä½: %.1f%%, 95åˆ†ä½: %.1f%%\n", 
                mem_avg, mem[p90_idx], mem[p95_idx]
        printf "ç£ç›˜ä½¿ç”¨ç‡ - å¹³å‡å€¼: %.1f%%, 90åˆ†ä½: %.1f%%, 95åˆ†ä½: %.1f%%\n", 
                disk_avg, disk[p90_idx], disk[p95_idx]
        printf "ç³»ç»Ÿè´Ÿè½½   - å¹³å‡å€¼: %.2f,   90åˆ†ä½: %.2f,   95åˆ†ä½: %.2f\n", 
                load_avg, load[p90_idx], load[p95_idx]
        
        print "\nğŸ’¡ æ¨èåŠ¨æ€é˜ˆå€¼è®¾ç½®:"
        print "------------------------"
        printf "CPUå‘Šè­¦é˜ˆå€¼:  %.1f%% (95åˆ†ä½ + 5%%)\n", cpu[p95_idx] + 5
        printf "CPUè­¦å‘Šé˜ˆå€¼:  %.1f%% (90åˆ†ä½ + 5%%)\n", cpu[p90_idx] + 5
        printf "å†…å­˜å‘Šè­¦é˜ˆå€¼: %.1f%% (95åˆ†ä½ + 3%%)\n", mem[p95_idx] + 3
        printf "å†…å­˜è­¦å‘Šé˜ˆå€¼: %.1f%% (90åˆ†ä½ + 3%%)\n", mem[p90_idx] + 3
    }' "$temp_data"
    
    # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
    rm "$temp_data"
}
```

### 8.3 æ—¶é—´æ®µå·®å¼‚åŒ–é˜ˆå€¼


**â° åŸºäºæ—¶é—´æ¨¡å¼çš„é˜ˆå€¼è°ƒæ•´**

```bash
#!/bin/bash
# æ—¶é—´æ®µå·®å¼‚åŒ–é˜ˆå€¼ç³»ç»Ÿ

generate_time_based_thresholds() {
    echo "ğŸ• åˆ†æä¸åŒæ—¶é—´æ®µçš„ç³»ç»Ÿè´Ÿè½½æ¨¡å¼..."
    
    local temp_hourly="/tmp/hourly_analysis.csv"
    > "$temp_hourly"
    
    # æŒ‰å°æ—¶ç»Ÿè®¡å†å²æ•°æ®
    for hour in {0..23}; do
        local hour_padded=$(printf "%02d" $hour)
        
        # æå–è¯¥å°æ—¶çš„æ‰€æœ‰å†å²æ•°æ®
        find "$DATA_DIR" -name "performance_*.csv" -exec grep " ${hour_padded}:" {} \; | \
        awk -F',' '{
            cpu_sum += $2; mem_sum += $3; count++
        } END {
            if(count > 0) {
                printf "%s,%.1f,%.1f,%d\n", "'$hour_padded'", cpu_sum/count, mem_sum/count, count
            }
        }' >> "$temp_hourly"
    done
    
    echo "ğŸ“Š å„æ—¶æ®µå¹³å‡è´Ÿè½½åˆ†æ:"
    echo "æ—¶æ®µ    å¹³å‡CPU    å¹³å‡å†…å­˜    æ ·æœ¬æ•°    å»ºè®®é˜ˆå€¼"
    echo "------------------------------------------------"
    
    # åˆ†ææ¯ä¸ªæ—¶æ®µå¹¶ç”Ÿæˆå»ºè®®é˜ˆå€¼
    while IFS=',' read -r hour avg_cpu avg_mem sample_count; do
        # æ ¹æ®å†å²å¹³å‡å€¼è®¡ç®—åŠ¨æ€é˜ˆå€¼
        local cpu_threshold=$(echo "$avg_cpu * 1.5" | bc)
        local mem_threshold=$(echo "$avg_mem * 1.3" | bc)
        
        # é™åˆ¶é˜ˆå€¼èŒƒå›´
        cpu_threshold=$(echo "if($cpu_threshold > 95) 95 else if($cpu_threshold < 60) 60 else $cpu_threshold" | bc)
        mem_threshold=$(echo "if($mem_threshold > 95) 95 else if($mem_threshold < 70) 70 else $mem_threshold" | bc)
        
        printf "%s:00   %6.1f%%    %6.1f%%     %4d    CPU:%.0f%% MEM:%.0f%%\n" \
               "$hour" "$avg_cpu" "$avg_mem" "$sample_count" "$cpu_threshold" "$mem_threshold"
               
        # ç”Ÿæˆé…ç½®æ–‡ä»¶æ ¼å¼
        echo "threshold_${hour}h_cpu=${cpu_threshold}" >> /tmp/dynamic_thresholds.conf
        echo "threshold_${hour}h_mem=${mem_threshold}" >> /tmp/dynamic_thresholds.conf
        
    done < "$temp_hourly"
    
    echo ""
    echo "âœ… åŠ¨æ€é˜ˆå€¼é…ç½®å·²ç”Ÿæˆ: /tmp/dynamic_thresholds.conf"
    
    rm "$temp_hourly"
}

# åº”ç”¨æ—¶é—´æ®µé˜ˆå€¼çš„ç›‘æ§è„šæœ¬
monitor_with_time_thresholds() {
    local current_hour=$(date +%H)
    local threshold_file="/tmp/dynamic_thresholds.conf"
    
    if [ ! -f "$threshold_file" ]; then
        echo "âš ï¸  åŠ¨æ€é˜ˆå€¼é…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤é˜ˆå€¼"
        local cpu_threshold=80
        local mem_threshold=85
    else
        # è¯»å–å½“å‰æ—¶æ®µçš„é˜ˆå€¼
        local cpu_threshold=$(grep "threshold_${current_hour}h_cpu" "$threshold_file" | cut -d'=' -f2)
        local mem_threshold=$(grep "threshold_${current_hour}h_mem" "$threshold_file" | cut -d'=' -f2)
        
        # é»˜è®¤å€¼å¤„ç†
        cpu_threshold=${cpu_threshold:-80}
        mem_threshold=${mem_threshold:-85}
    fi
    
    echo "ğŸ¯ å½“å‰æ—¶æ®µ ($current_hour:00) ä½¿ç”¨é˜ˆå€¼: CPU=${cpu_threshold}%, å†…å­˜=${mem_threshold}%"
    
    # è·å–å½“å‰æŒ‡æ ‡
    local current_cpu=$(top -bn1 | grep "Cpu(s)" | awk '{print 100-$8}')
    local current_mem=$(free | grep Mem | awk '{printf "%.1f", ($3/$2)*100}')
    
    # ä½¿ç”¨åŠ¨æ€é˜ˆå€¼è¿›è¡Œå‘Šè­¦åˆ¤æ–­
    if (( $(echo "$current_cpu > $cpu_threshold" | bc -l) )); then
        echo "ğŸš¨ CPUå‘Šè­¦: å½“å‰ ${current_cpu}% > é˜ˆå€¼ ${cpu_threshold}%"
    else
        echo "âœ… CPUæ­£å¸¸: ${current_cpu}%"
    fi
    
    if (( $(echo "$current_mem > $mem_threshold" | bc -l) )); then
        echo "ğŸš¨ å†…å­˜å‘Šè­¦: å½“å‰ ${current_mem}% > é˜ˆå€¼ ${mem_threshold}%"
    else
        echo "âœ… å†…å­˜æ­£å¸¸: ${current_mem}%"
    fi
}
```

### 8.4 æœºå™¨å­¦ä¹ é˜ˆå€¼ä¼˜åŒ–


**ğŸ¤– åŸºäºå†å²è¶‹åŠ¿çš„æ™ºèƒ½é˜ˆå€¼**

```bash
#!/bin/bash
# ç®€åŒ–çš„è¶‹åŠ¿é¢„æµ‹é˜ˆå€¼è°ƒæ•´

adaptive_threshold_learning() {
    echo "ğŸ§  å¯åŠ¨è‡ªé€‚åº”é˜ˆå€¼å­¦ä¹ ç³»ç»Ÿ..."
    
    # å­¦ä¹ å‚æ•°
    local learning_rate=0.1
    local threshold_config="/var/monitor/adaptive_thresholds.conf"
    
    # åˆå§‹åŒ–é˜ˆå€¼ï¼ˆå¦‚æœé…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼‰
    if [ ! -f "$threshold_config" ]; then
        cat > "$threshold_config" << EOF
cpu_threshold=80.0
mem_threshold=85.0
disk_threshold=90.0
load_threshold=2.0
learning_rate=0.1
last_update=$(date +%s)
EOF
        echo "ğŸ“ åˆå§‹åŒ–é˜ˆå€¼é…ç½®æ–‡ä»¶"
    fi
    
    # è¯»å–å½“å‰é˜ˆå€¼é…ç½®
    source "$threshold_config"
    
    # æ”¶é›†æœ€è¿‘24å°æ—¶çš„æ•°æ®è¿›è¡Œå­¦ä¹ 
    learn_from_recent_data
    
    # æ›´æ–°é˜ˆå€¼é…ç½®
    update_threshold_config
}

learn_from_recent_data() {
    echo "ğŸ“š ä»æœ€è¿‘æ•°æ®ä¸­å­¦ä¹ ..."
    
    # è·å–æœ€è¿‘24å°æ—¶çš„å¼‚å¸¸äº‹ä»¶
    local alert_log="/var/log/system_anomaly.log"
    local yesterday=$(date -d "1 day ago" +%Y-%m-%d)
    
    if [ -f "$alert_log" ]; then
        # ç»Ÿè®¡è¯¯æŠ¥å’Œæ¼æŠ¥
        local false_positives=$(grep "$yesterday" "$alert_log" | grep -c "False Positive" || echo 0)
        local missed_alerts=$(grep "$yesterday" "$alert_log" | grep -c "Missed Alert" || echo 0)
        
        echo "  è¯¯æŠ¥æ¬¡æ•°: $false_positives"
        echo "  æ¼æŠ¥æ¬¡æ•°: $missed_alerts"
        
        # æ ¹æ®è¯¯æŠ¥è°ƒæ•´é˜ˆå€¼ï¼ˆç®€åŒ–çš„å­¦ä¹ ç®—æ³•ï¼‰
        if [ $false_positives -gt 5 ]; then
            echo "  ğŸ”§ æ£€æµ‹åˆ°è¾ƒå¤šè¯¯æŠ¥ï¼Œè°ƒé«˜é˜ˆå€¼"
            cpu_threshold=$(echo "$cpu_threshold + $learning_rate * 5" | bc)
            mem_threshold=$(echo "$mem_threshold + $learning_rate * 3" | bc)
        elif [ $missed_alerts -gt 2 ]; then
            echo "  ğŸ”§ æ£€æµ‹åˆ°æ¼æŠ¥ï¼Œè°ƒä½é˜ˆå€¼"
            cpu_threshold=$(echo "$cpu_threshold - $learning_rate * 3" | bc)
            mem_threshold=$(echo "$mem_threshold - $learning_rate * 2" | bc)
        else
            echo "  âœ… é˜ˆå€¼è¡¨ç°è‰¯å¥½ï¼Œä¿æŒå½“å‰è®¾ç½®"
        fi
    fi
}

update_threshold_config() {
    # é™åˆ¶é˜ˆå€¼èŒƒå›´
    cpu_threshold=$(echo "if($cpu_threshold > 95) 95 else if($cpu_threshold < 50) 50 else $cpu_threshold" | bc)
    mem_threshold=$(echo "if($mem_threshold > 95) 95 else if($mem_threshold < 70) 70 else $mem_threshold" | bc)
    
    # æ›´æ–°é…ç½®æ–‡ä»¶
    cat > "$threshold_config" << EOF
cpu_threshold=$cpu_threshold
mem_threshold=$mem_threshold  
disk_threshold=$disk_threshold
load_threshold=$load_threshold
learning_rate=$learning_rate
last_update=$(date +%s)
EOF
    
    echo "ğŸ’¾ é˜ˆå€¼å·²æ›´æ–°:"
    echo "  CPUé˜ˆå€¼: $cpu_threshold%"
    echo "  å†…å­˜é˜ˆå€¼: $mem_threshold%"
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


**ğŸ”¸ ç³»ç»Ÿç›‘æ§æ•°æ®å¤„ç†çš„å…«å¤§æ ¸å¿ƒæŠ€èƒ½**
- **æ•°æ®æå–**ï¼šä»/procã€/sysç­‰è·å–ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡
- **ç»Ÿè®¡è®¡ç®—**ï¼šå¹³å‡å€¼ã€ç™¾åˆ†ä½æ•°ã€è¶‹åŠ¿åˆ†æç­‰è®¡ç®—æ–¹æ³•
- **å¼‚å¸¸æ£€æµ‹**ï¼šåŸºäºé˜ˆå€¼å’Œç»Ÿè®¡çš„å¼‚å¸¸è¯†åˆ«æŠ€æœ¯
- **è¶‹åŠ¿åˆ†æ**ï¼šå†å²æ•°æ®åˆ†æå’Œæœªæ¥é¢„æµ‹æ–¹æ³•
- **æŠ¥è¡¨ç”Ÿæˆ**ï¼šè‡ªåŠ¨åŒ–çš„HTMLæŠ¥è¡¨å’Œé‚®ä»¶å‘é€
- **å®æ—¶å¤„ç†**ï¼šæµæ•°æ®å¤„ç†å’Œå³æ—¶å‘Šè­¦æœºåˆ¶
- **å­˜å‚¨ä¼˜åŒ–**ï¼šåˆ†å±‚å­˜å‚¨ã€å‹ç¼©å’Œæ¸…ç†ç­–ç•¥
- **æ™ºèƒ½é˜ˆå€¼**ï¼šåŠ¨æ€å’Œè‡ªé€‚åº”çš„å‘Šè­¦é˜ˆå€¼ç®¡ç†

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æ•°æ®å¤„ç†çš„æ ¸å¿ƒæ€è·¯**
```
åŸå§‹æ•°æ® â†’ æ¸…ç†è¿‡æ»¤ â†’ ç»Ÿè®¡è®¡ç®— â†’ å¼‚å¸¸æ£€æµ‹ â†’ å†³ç­–è¡ŒåŠ¨

å®é™…åº”ç”¨ä¸­çš„æ•°æ®æµï¼š
ç³»ç»ŸæŒ‡æ ‡ â†’ å®æ—¶é‡‡é›† â†’ ç¼“å†²èšåˆ â†’ å­˜å‚¨åˆ†å±‚ â†’ åˆ†ææŠ¥è¡¨
```

**ğŸ”¹ ç›‘æ§ç³»ç»Ÿçš„è®¾è®¡åŸåˆ™**
- **å¯æ‰©å±•æ€§**ï¼šèƒ½å¤Ÿå¤„ç†æ•°æ®é‡å¢é•¿å’Œæ–°æŒ‡æ ‡æ·»åŠ 
- **å¯é æ€§**ï¼šç¡®ä¿å…³é”®å‘Šè­¦ä¸ä¼šé—æ¼
- **æ•ˆç‡æ€§**ï¼šåœ¨èµ„æºæ¶ˆè€—å’Œç›‘æ§ç²¾åº¦é—´æ‰¾åˆ°å¹³è¡¡
- **è‡ªåŠ¨åŒ–**ï¼šå‡å°‘äººå·¥å¹²é¢„ï¼Œæé«˜è¿ç»´æ•ˆç‡

### 9.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ“Š ä¼ä¸šçº§ç›‘æ§åº”ç”¨åœºæ™¯**
- **æœåŠ¡å™¨é›†ç¾¤ç›‘æ§**ï¼šæ‰¹é‡æœåŠ¡å™¨çš„ç»Ÿä¸€ç›‘æ§ç®¡ç†
- **åº”ç”¨æ€§èƒ½ç›‘æ§**ï¼šWebåº”ç”¨ã€æ•°æ®åº“çš„æ€§èƒ½è·Ÿè¸ª
- **å®¹é‡è§„åˆ’**ï¼šåŸºäºå†å²æ•°æ®é¢„æµ‹èµ„æºéœ€æ±‚
- **æ•…éšœé¢„é˜²**ï¼šæå‰å‘ç°ç³»ç»Ÿé—®é¢˜ï¼Œé¿å…æœåŠ¡ä¸­æ–­

**ğŸ› ï¸ è¿ç»´å·¥ç¨‹å¸ˆå¿…å¤‡æŠ€èƒ½**
- **è„šæœ¬ç¼–ç¨‹**ï¼šèƒ½å¤Ÿç¼–å†™è‡ªåŠ¨åŒ–ç›‘æ§è„šæœ¬
- **æ•°æ®åˆ†æ**ï¼šç†è§£ç›‘æ§æ•°æ®çš„å«ä¹‰å’Œè¶‹åŠ¿
- **å‘Šè­¦ä¼˜åŒ–**ï¼šå‡å°‘è¯¯æŠ¥ã€é¿å…å‘Šè­¦ç–²åŠ³
- **æ€§èƒ½è°ƒä¼˜**ï¼šåŸºäºç›‘æ§æ•°æ®è¿›è¡Œç³»ç»Ÿä¼˜åŒ–

### 9.4 å­¦ä¹ è·¯çº¿å»ºè®®


**ğŸ¯ åˆçº§é˜¶æ®µ (1-2å‘¨)**
1. **æŒæ¡åŸºç¡€å‘½ä»¤**ï¼štopã€freeã€dfã€iostatç­‰
2. **ç†è§£ç³»ç»ŸæŒ‡æ ‡**ï¼šCPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œçš„å«ä¹‰
3. **ç®€å•è„šæœ¬ç¼–å†™**ï¼šæ•°æ®æ”¶é›†å’ŒåŸºç¡€ç»Ÿè®¡
4. **é˜ˆå€¼å‘Šè­¦**ï¼šå®ç°ç®€å•çš„é™æ€é˜ˆå€¼ç›‘æ§

**ğŸ¯ ä¸­çº§é˜¶æ®µ (2-4å‘¨)**  
1. **æ•°æ®å­˜å‚¨ä¼˜åŒ–**ï¼šå­¦ä¼šæ•°æ®åˆ†å±‚å’Œå‹ç¼©æŠ€æœ¯
2. **è¶‹åŠ¿åˆ†æ**ï¼šæŒæ¡æ—¶é—´åºåˆ—æ•°æ®åˆ†ææ–¹æ³•
3. **æŠ¥è¡¨è‡ªåŠ¨åŒ–**ï¼šç”ŸæˆHTMLæŠ¥è¡¨å’Œé‚®ä»¶é€šçŸ¥
4. **åŠ¨æ€é˜ˆå€¼**ï¼šå®ç°åŸºäºç»Ÿè®¡çš„æ™ºèƒ½é˜ˆå€¼

**ğŸ¯ é«˜çº§é˜¶æ®µ (1-2ä¸ªæœˆ)**
1. **å®æ—¶æµå¤„ç†**ï¼šæ„å»ºå®æ—¶ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿ  
2. **æœºå™¨å­¦ä¹ **ï¼šåº”ç”¨ç®€å•çš„MLç®—æ³•ä¼˜åŒ–ç›‘æ§
3. **é›†ç¾¤ç›‘æ§**ï¼šå¤šæœåŠ¡å™¨çš„ç»Ÿä¸€ç›‘æ§æ–¹æ¡ˆ
4. **ç›‘æ§å¹³å°**ï¼šé›†æˆå¼€æºç›‘æ§å·¥å…·å¦‚Prometheus

### 9.5 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


**â“ æ•°æ®é‡å¤ªå¤§æ€ä¹ˆåŠï¼Ÿ**
- å®æ–½æ•°æ®åˆ†å±‚å­˜å‚¨ç­–ç•¥
- å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®
- ä½¿ç”¨æ•°æ®å‹ç¼©æŠ€æœ¯
- åˆç†è®¾ç½®é‡‡æ ·é¢‘ç‡

**â“ å‘Šè­¦å¤ªå¤šå¤ªé¢‘ç¹ï¼Ÿ**  
- è°ƒæ•´å‘Šè­¦é˜ˆå€¼è®¾ç½®
- å®ç°å‘Šè­¦æŠ‘åˆ¶æœºåˆ¶
- ä½¿ç”¨åŠ¨æ€é˜ˆå€¼ç®—æ³•
- å»ºç«‹å‘Šè­¦çº§åˆ«åˆ†ç±»

**â“ å¦‚ä½•æé«˜ç›‘æ§ç²¾åº¦ï¼Ÿ**
- å¢åŠ ç›‘æ§æŒ‡æ ‡ç»´åº¦
- ç¼©çŸ­æ•°æ®é‡‡é›†é—´éš”
- ä½¿ç”¨ç»Ÿè®¡åˆ†ææ–¹æ³•
- ç»“åˆä¸šåŠ¡åœºæ™¯è°ƒä¼˜

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- ç³»ç»Ÿç›‘æ§å…«è¦ç´ ï¼Œæ•°æ®å¤„ç†æ˜¯æ ¸å¿ƒ
- å®æ—¶é‡‡é›†é…å­˜å‚¨ï¼Œå¼‚å¸¸æ£€æµ‹è¦æ™ºèƒ½  
- è¶‹åŠ¿åˆ†æçœ‹æœªæ¥ï¼ŒæŠ¥è¡¨è‡ªåŠ¨çœäººå·¥
- é˜ˆå€¼åŠ¨æ€å‡è¯¯æŠ¥ï¼Œä¼˜åŒ–å­˜å‚¨æ§æˆæœ¬