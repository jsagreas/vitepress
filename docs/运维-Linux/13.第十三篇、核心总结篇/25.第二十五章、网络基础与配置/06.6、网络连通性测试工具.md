---
title: 6、网络连通性测试工具
---
## 📚 目录

1. [ping连通性测试](#1-ping连通性测试)
2. [traceroute路径追踪分析](#2-traceroute路径追踪分析)
3. [tracepath MTU路径发现](#3-tracepath-mtu路径发现)
4. [mtr网络诊断组合工具](#4-mtr网络诊断组合工具)
5. [telnet端口连通性测试](#5-telnet端口连通性测试)
6. [nc/netcat网络连接工具](#6-ncnetcat网络连接工具)
7. [网络延迟与丢包分析](#7-网络延迟与丢包分析)
8. [网络测试脚本编写](#8-网络测试脚本编写)
9. [连通性故障排查流程](#9-连通性故障排查流程)
10. [核心要点总结](#10-核心要点总结)

---

## 1. 🏓 ping连通性测试


### 1.1 ping是什么


**🔸 基本概念**
`ping`就像网络世界的"喊话器"，它向目标主机发送一个**ICMP回显请求**（就像喊"你在吗？"），然后等待对方回应**ICMP回显应答**（对方回答"我在这里！"）。

```
简单理解ping的工作过程：
你的电脑 --------"你好！"---------→ 目标主机
你的电脑 ←-------"我在这里！"------- 目标主机

这个过程测量了：
✅ 对方是否在线（能否收到回应）
✅ 网络延迟多少毫秒（来回时间）
✅ 数据包是否丢失（发10个回来几个）
```

### 1.2 ping基本用法


**🔹 最简单的ping命令**
```bash
# 测试能否连通百度
ping baidu.com

# 测试能否连通本地回环地址
ping 127.0.0.1
```

**🔹 常用参数详解**

| 参数 | 含义 | 实际用途 |
|------|------|----------|
| `-c 数量` | 指定发送次数 | `ping -c 4 baidu.com` 只发4次就停止 |
| `-i 秒数` | 设置发送间隔 | `ping -i 2 baidu.com` 每2秒发一次 |
| `-s 字节数` | 设置数据包大小 | `ping -s 1000 baidu.com` 发送大包测试 |
| `-W 秒数` | 设置等待超时 | `ping -W 3 baidu.com` 等待3秒无回应就算超时 |

### 1.3 ping结果分析


**📊 ping输出解读**
```bash
$ ping -c 4 baidu.com
PING baidu.com (110.242.68.66) 56(84) bytes of data.
64 bytes from 110.242.68.66: icmp_seq=1 time=28.2 ms
64 bytes from 110.242.68.66: icmp_seq=2 time=27.8 ms
64 bytes from 110.242.68.66: icmp_seq=3 time=28.1 ms
64 bytes from 110.242.68.66: icmp_seq=4 time=28.0 ms

--- baidu.com ping statistics ---
4 packets transmitted, 4 received, 0% packet loss
round-trip min/avg/max/mdev = 27.8/28.0/28.2/0.2 ms
```

**🔍 关键信息解释**
- **IP地址**：`110.242.68.66` - 这是百度的实际IP地址
- **字节数**：`64 bytes` - 每个数据包的大小
- **序列号**：`icmp_seq=1` - 第1个包，用来检测包的顺序
- **响应时间**：`time=28.2 ms` - 往返延迟28.2毫秒
- **丢包率**：`0% packet loss` - 没有丢失任何数据包
- **统计信息**：最小/平均/最大/抖动延迟

---

## 2. 🛤️ traceroute路径追踪分析


### 2.1 traceroute的作用


**🔸 什么是路径追踪**
`traceroute`就像给数据包装上GPS定位器，追踪它从你的电脑到目标网站经过的**每一个路由器**，就像查看快递包裹的运输路径一样。

```
数据传输路径示例：
你的电脑 → 家用路由器 → ISP路由器 → 核心路由器 → 目标服务器

traceroute显示：
 1  192.168.1.1     (你的路由器)      1.2 ms
 2  10.0.0.1        (运营商路由器)    15.6 ms  
 3  202.96.128.1    (骨干网路由器)    25.3 ms
 4  110.242.68.66   (目标服务器)      28.1 ms
```

### 2.2 traceroute基本使用


**🔹 基础命令**
```bash
# 追踪到百度的网络路径
traceroute baidu.com

# 在有些系统上命令是tracert
tracert baidu.com    # Windows系统
```

**🔹 常用参数**

| 参数 | 功能 | 使用示例 |
|------|------|----------|
| `-n` | 不解析域名，只显示IP | `traceroute -n baidu.com` |
| `-m 跳数` | 最大跳数限制 | `traceroute -m 10 baidu.com` |
| `-q 次数` | 每跳探测包数量 | `traceroute -q 1 baidu.com` |

### 2.3 traceroute结果解读


**📋 输出示例分析**
```bash
$ traceroute baidu.com
 1  192.168.1.1 (192.168.1.1)  1.123 ms  1.089 ms  1.077 ms
 2  10.0.0.1 (10.0.0.1)  15.234 ms  15.678 ms  15.456 ms
 3  * * *
 4  202.96.128.86  25.567 ms  25.234 ms  25.678 ms
 5  110.242.68.66 (110.242.68.66)  28.123 ms  28.456 ms  28.234 ms
```

**🔍 关键信息含义**
- **跳数**：第几个路由器节点
- **IP地址**：该路由器的地址
- **三个时间**：三次探测的延迟时间（毫秒）
- **星号（*）**：该路由器不响应探测包（可能防火墙屏蔽）

---

## 3. 🔍 tracepath MTU路径发现


### 3.1 什么是MTU和tracepath


**🔸 MTU概念解释**
**MTU**（Maximum Transmission Unit）就是网络传输中**单个数据包的最大尺寸**，就像快递规定的单个包裹最大重量一样。

```
MTU理解：
━━━━━━━━━━━━━━━━━━━━━━━━━━━━  ← 1500字节MTU（标准以太网）
████████████████████████    ← 实际数据包

如果数据包太大：
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  ← 超大数据包
需要分割成：
████████████████████████ + ████████  ← 分成两个小包
```

**🔸 tracepath的作用**
`tracepath`不仅能追踪网络路径，还能**发现路径上每个节点的MTU大小**，找出网络传输的"瓶颈路段"。

### 3.2 tracepath使用方法


**🔹 基本命令**
```bash
# 追踪路径并发现MTU
tracepath baidu.com

# 指定起始包大小
tracepath -l 1400 baidu.com
```

**🔹 结果示例分析**
```bash
$ tracepath baidu.com
 1?: [LOCALHOST]                      pmtu 1500
 1:  192.168.1.1                       1.234ms 
 2:  10.0.0.1                         15.678ms 
 3:  202.96.128.86                    25.456ms pmtu 1480
 4:  110.242.68.66                    28.234ms reached
     Resume: pmtu 1480 hops 4 back 4
```

**📊 关键信息解读**
- **pmtu 1500**：路径MTU是1500字节
- **pmtu 1480**：在第3跳发现MTU变小了
- **Resume**：总结信息，最终路径MTU是1480字节

---

## 4. 🎯 mtr网络诊断组合工具


### 4.1 mtr是什么


**🔸 mtr的强大之处**
`mtr`（My TraceRoute）是**ping和traceroute的结合体**，它能够：
- **实时显示**网络路径信息
- **持续监控**每一跳的延迟和丢包
- **统计分析**网络质量状况

```
mtr的优势：
传统方式：ping测延迟 + traceroute看路径 = 两个命令分开做
mtr方式：一个工具 = ping + traceroute + 实时统计 + 持续监控
```

### 4.2 mtr使用方法


**🔹 安装mtr**
```bash
# Ubuntu/Debian系统
sudo apt install mtr

# CentOS/RHEL系统  
sudo yum install mtr
```

**🔹 常用参数**

| 参数 | 功能 | 使用示例 |
|------|------|----------|
| `-c 数量` | 指定测试次数 | `mtr -c 10 baidu.com` |
| `-r` | 生成报告模式 | `mtr -r baidu.com` |
| `-n` | 不解析域名 | `mtr -n baidu.com` |
| `-i 秒数` | 设置间隔时间 | `mtr -i 2 baidu.com` |

### 4.3 mtr结果分析


**📊 mtr输出解读**
```bash
$ mtr -r -c 10 baidu.com
HOST: myserver                    Loss%   Snt   Last   Avg  Best  Wrst StDev
  1.|-- 192.168.1.1                0.0%    10    1.2   1.3   1.1   1.8   0.2
  2.|-- 10.0.0.1                   0.0%    10   15.6  15.8  15.2  16.8   0.5
  3.|-- 202.96.128.86             10.0%    10   25.4  25.6  25.1  26.2   0.4
  4.|-- 110.242.68.66              0.0%    10   28.1  28.3  27.8  29.1   0.4
```

**🔍 各列含义详解**
- **HOST**：路径上的主机IP地址
- **Loss%**：数据包丢失率（10%表示10个包丢了1个）
- **Snt**：发送的包数量
- **Last**：最近一次的延迟时间
- **Avg**：平均延迟时间
- **Best**：最好（最小）延迟时间
- **Wrst**：最坏（最大）延迟时间
- **StDev**：延迟时间的标准差（波动程度）

---

## 5. 📞 telnet端口连通性测试


### 5.1 telnet的网络测试用途


**🔸 什么是端口连通性**
想象网络服务就像一栋大楼，**IP地址是楼的地址，端口号是房间号**。telnet可以测试能否"敲开特定房间的门"。

```
网络连接理解：
服务器 = 大楼（IP：192.168.1.100）
├── 22号房间（SSH服务）
├── 80号房间（网站服务）  
├── 443号房间（HTTPS服务）
└── 3306号房间（数据库服务）

telnet测试：能否敲开80号房间的门？
```

### 5.2 telnet测试方法


**🔹 基本语法**
```bash
# 测试网站80端口
telnet baidu.com 80

# 测试SSH 22端口
telnet 192.168.1.100 22

# 测试数据库3306端口
telnet localhost 3306
```

**🔹 结果判断**

✅ **连接成功示例**
```bash
$ telnet baidu.com 80
Trying 110.242.68.66...
Connected to baidu.com.
Escape character is '^]'.
```

❌ **连接失败示例**
```bash
$ telnet 192.168.1.100 8080  
Trying 192.168.1.100...
telnet: Unable to connect to remote host: Connection refused
```

### 5.3 telnet在Web服务测试中的应用


**🔹 HTTP请求测试**
```bash
# 连接到网站80端口后，手动输入HTTP请求
telnet baidu.com 80
# 连接成功后输入：
GET / HTTP/1.1
Host: baidu.com
# 按两次回车，会看到网页返回内容
```

**🔹 常见端口速查表**

| 端口 | 服务 | 用途 |
|------|------|------|
| 22 | SSH | 远程登录 |
| 80 | HTTP | 网站服务 |
| 443 | HTTPS | 安全网站服务 |
| 21 | FTP | 文件传输 |
| 25 | SMTP | 邮件发送 |
| 3306 | MySQL | 数据库服务 |

---

## 6. 🔌 nc/netcat网络连接工具


### 6.1 netcat的强大功能


**🔸 netcat是什么**
`netcat`（简称nc）被称为"网络工具中的瑞士军刀"，它能够：
- **监听端口**（充当服务器）
- **连接端口**（充当客户端）
- **传输文件**
- **端口扫描**
- **网络调试**

```
netcat的多面性：
客户端模式：nc 目标IP 端口        （连接别人）
服务器模式：nc -l 端口           （等待别人连接）
文件传输：  nc -l 1234 < file    （发送文件）
端口扫描：  nc -z 主机 端口范围    （扫描开放端口）
```

### 6.2 nc基本用法


**🔹 连接测试**
```bash
# 测试端口连通性
nc -v baidu.com 80

# 扫描端口范围
nc -z -v 192.168.1.100 20-25
```

**🔹 简单服务器和客户端**

**服务器端（监听）**
```bash
# 监听8080端口，等待连接
nc -l 8080
```

**客户端（连接）**
```bash
# 连接到服务器8080端口
nc localhost 8080
# 连接后可以互相发送文本消息
```

### 6.3 nc实用场景


**🔹 文件传输**

**发送方**
```bash
# 监听端口并发送文件
nc -l 1234 < myfile.txt
```

**接收方**  
```bash
# 连接并接收文件
nc 192.168.1.100 1234 > received_file.txt
```

**🔹 端口扫描**
```bash
# 扫描主机的常用端口
nc -z -v 192.168.1.100 20-100

# 扫描结果示例：
# Connection to 192.168.1.100 22 port [tcp/ssh] succeeded!  ✅ SSH开放
# nc: connect to 192.168.1.100 port 23 (tcp) failed: Connection refused ❌ Telnet关闭
```

---

## 7. 📊 网络延迟与丢包分析


### 7.1 网络性能指标理解


**🔸 延迟（Latency）含义**
网络延迟就像**快递运输时间**，从发出数据到收到回应的时间间隔。

```
延迟分类：
🚀 优秀延迟：  < 20ms   （本地网络，同城）
✅ 良好延迟：  20-50ms  （国内不同城市）
⚠️  一般延迟：  50-100ms（国际网络）
❌ 差劲延迟：  > 200ms  （卫星网络，网络拥堵）
```

**🔸 丢包（Packet Loss）含义**
丢包就像**快递丢失**，发出的数据包没有到达目的地。

```
丢包率影响：
0%    = 完美网络
1-2%  = 轻微影响，网页浏览基本正常
3-5%  = 明显影响，视频可能卡顿  
>10%  = 严重影响，应用几乎无法使用
```

### 7.2 延迟测试技巧


**🔹 不同时段测试**
```bash
# 创建测试脚本，每小时测试一次
while true; do
    echo "$(date): 开始测试网络延迟"
    ping -c 10 baidu.com | tail -1
    sleep 3600  # 等待1小时
done
```

**🔹 多目标对比测试**
```bash
# 测试多个网站的延迟
for site in baidu.com google.com github.com; do
    echo "测试 $site:"
    ping -c 5 $site | grep avg
done
```

### 7.3 丢包分析方法


**🔹 长时间ping监控**
```bash
# 连续ping 1000次，观察丢包情况
ping -c 1000 baidu.com

# 结果分析：
# 1000 packets transmitted, 995 received, 0.5% packet loss
# 丢包率0.5%，属于正常范围
```

**🔹 使用mtr深度分析**
```bash
# 运行10分钟的网络质量监控
mtr -r -c 100 baidu.com

# 重点关注Loss%列，找出丢包发生在哪一跳
```

---

## 8. 📝 网络测试脚本编写


### 8.1 基础连通性检查脚本


**🔹 简单的连通性测试脚本**
```bash
#!/bin/bash
# 网络连通性检查脚本

echo "=== 网络连通性测试报告 ==="
echo "测试时间: $(date)"
echo

# 测试列表
targets=("baidu.com" "google.com" "github.com")

for target in "${targets[@]}"; do
    echo "测试 $target:"
    if ping -c 3 -W 3 "$target" > /dev/null 2>&1; then
        echo "✅ $target 连通正常"
        # 获取平均延迟
        avg_time=$(ping -c 3 "$target" | tail -1 | cut -d'=' -f2 | cut -d'/' -f2)
        echo "   平均延迟: ${avg_time}ms"
    else
        echo "❌ $target 连接失败"
    fi
    echo
done
```

### 8.2 端口扫描脚本


**🔹 常用端口检查脚本**
```bash
#!/bin/bash
# 端口扫描脚本

target="$1"
if [ -z "$target" ]; then
    echo "用法: $0 目标IP"
    exit 1
fi

echo "扫描主机: $target"
echo "常用端口检查结果:"

# 常用端口列表
ports=(22 80 443 21 25 53 110 143 993 995 3306 5432)

for port in "${ports[@]}"; do
    if nc -z -w3 "$target" "$port" 2>/dev/null; then
        echo "✅ 端口 $port 开放"
    else
        echo "❌ 端口 $port 关闭"
    fi
done
```

### 8.3 网络质量监控脚本


**🔹 网络性能监控脚本**
```bash
#!/bin/bash
# 网络质量监控脚本

log_file="/tmp/network_monitor.log"
target="baidu.com"

echo "开始监控网络质量，日志保存到: $log_file"

while true; do
    timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    
    # ping测试
    ping_result=$(ping -c 5 -W 5 "$target" 2>/dev/null)
    
    if [ $? -eq 0 ]; then
        # 提取延迟和丢包信息
        avg_time=$(echo "$ping_result" | tail -1 | cut -d'=' -f2 | cut -d'/' -f2)
        packet_loss=$(echo "$ping_result" | grep "packet loss" | cut -d',' -f3 | cut -d'%' -f1 | tr -d ' ')
        
        echo "$timestamp | 延迟: ${avg_time}ms | 丢包: ${packet_loss}%" >> "$log_file"
        echo "$timestamp | 延迟: ${avg_time}ms | 丢包: ${packet_loss}%"
    else
        echo "$timestamp | 网络连接失败" >> "$log_file"
        echo "$timestamp | 网络连接失败"
    fi
    
    sleep 60  # 每分钟测试一次
done
```

---

## 9. 🔧 连通性故障排查流程


### 9.1 系统化排查思路


**🔸 网络故障排查的层次方法**
网络排查要**从内到外、从下到上**，就像医生看病一样，要有系统的检查流程。

```
网络排查顺序：
第1步：检查本机网络配置    （自己的问题）
第2步：检查本地网关连通    （路由器的问题）  
第3步：检查DNS解析功能     （域名解析问题）
第4步：检查外网连通性      （运营商的问题）
第5步：检查具体服务端口    （应用服务问题）
```

### 9.2 具体排查步骤


**🔹 第1步：检查网络接口**
```bash
# 查看网络接口状态
ip addr show
# 或者使用
ifconfig

# 检查要点：
# ✅ 网卡是否UP状态
# ✅ 是否有IP地址
# ✅ IP地址是否正确
```

**🔹 第2步：检查本地连通**
```bash
# 测试本机回环地址
ping 127.0.0.1

# 测试本机IP地址
ping 192.168.1.100  # 你的实际IP

# 测试网关连通性
ping 192.168.1.1    # 你的网关地址
```

**🔹 第3步：检查DNS解析**
```bash
# 测试DNS解析
nslookup baidu.com

# 如果DNS有问题，直接用IP测试
ping 110.242.68.66  # 百度的IP地址
```

**🔹 第4步：检查外网连通**
```bash
# 测试外网知名网站
ping baidu.com
ping google.com

# 追踪网络路径
traceroute baidu.com
```

**🔹 第5步：检查服务端口**
```bash
# 测试具体服务端口
telnet baidu.com 80
nc -v baidu.com 80

# 检查本机端口监听
netstat -tuln
```

### 9.3 常见问题及解决方法


**🔍 故障现象与解决方案**

| 现象 | 可能原因 | 解决方法 |
|------|----------|----------|
| ping 127.0.0.1 失败 | 网络服务未启动 | `sudo systemctl restart networking` |
| ping 网关失败 | 网卡配置错误 | 检查IP、网关配置 |
| 能ping IP，不能ping域名 | DNS配置问题 | 修改`/etc/resolv.conf` |
| 外网ping不通 | 路由问题 | 检查默认网关设置 |
| 能ping通，telnet端口失败 | 防火墙或服务未启动 | 检查iptables、服务状态 |

### 9.4 故障排查工具组合


**🔹 一键网络诊断脚本**
```bash
#!/bin/bash
# 网络故障排查脚本

echo "=== 网络故障诊断报告 ==="
echo "诊断时间: $(date)"
echo

# 1. 检查网络接口
echo "🔍 检查网络接口状态:"
ip addr show | grep -E "(inet|state)"
echo

# 2. 检查路由表
echo "🔍 检查路由表:"
ip route show
echo

# 3. 检查DNS配置
echo "🔍 检查DNS配置:"
cat /etc/resolv.conf | grep nameserver
echo

# 4. 测试本地连通
echo "🔍 测试本地连通:"
ping -c 1 127.0.0.1 > /dev/null && echo "✅ 本机回环正常" || echo "❌ 本机回环异常"

# 5. 测试网关连通
gateway=$(ip route | grep default | awk '{print $3}')
if [ ! -z "$gateway" ]; then
    ping -c 1 -W 3 "$gateway" > /dev/null && echo "✅ 网关 $gateway 连通" || echo "❌ 网关 $gateway 不通"
fi

# 6. 测试外网连通
echo "🔍 测试外网连通:"
for site in "baidu.com" "8.8.8.8"; do
    ping -c 1 -W 3 "$site" > /dev/null && echo "✅ $site 连通" || echo "❌ $site 不通"
done

echo
echo "=== 诊断完成 ==="
```

---

## 10. 📋 核心要点总结


### 10.1 必须掌握的核心工具


```
🎯 基础连通测试：
• ping：最基本的连通性测试，检查网络是否可达
• telnet：检查特定端口是否开放
• nc：多功能网络工具，连接测试和端口扫描

🎯 路径分析工具：
• traceroute：查看数据包传输路径
• tracepath：发现路径MTU大小
• mtr：综合性网络诊断工具

🎯 性能分析指标：
• 延迟时间：数据往返时间，影响响应速度
• 丢包率：数据包丢失比例，影响传输可靠性
• MTU大小：最大传输单元，影响传输效率
```

### 10.2 关键理解要点


**🔹 工具选择原则**
```
简单测试      → 使用 ping
详细分析      → 使用 mtr  
路径追踪      → 使用 traceroute
端口检查      → 使用 telnet 或 nc
综合诊断      → 组合使用多个工具
```

**🔹 故障排查思维**
```
排查顺序：从内到外，从下到上
1️⃣ 本机配置 → 2️⃣ 本地网络 → 3️⃣ DNS解析 → 4️⃣ 外网连通 → 5️⃣ 应用服务
```

**🔹 网络性能判断标准**
```
延迟评估：
• < 20ms    优秀（本地网络）
• 20-50ms   良好（同城网络）  
• 50-100ms  一般（跨地区网络）
• > 200ms   较差（需要优化）

丢包评估：
• 0%        完美
• 1-2%      可接受
• 3-5%      有影响
• > 10%     严重问题
```

### 10.3 实际应用指导


**🔧 日常网络维护**
- **定期监控**：使用脚本定期检查网络质量
- **问题定位**：掌握系统化的故障排查流程  
- **性能优化**：根据测试结果调整网络配置
- **预防维护**：建立网络性能基线，及时发现异常

**💡 最佳实践建议**
- 组合使用多种工具，互相验证结果
- 保存测试脚本，提高故障处理效率
- 建立网络性能监控，及时发现问题
- 记录常见问题的解决方案，形成知识库

**核心记忆口诀**：
- ping测连通telnet测端口，traceroute追踪mtr监控
- 故障排查从内到外，本机网关DNS外网
- 延迟丢包是关键，脚本自动来监控