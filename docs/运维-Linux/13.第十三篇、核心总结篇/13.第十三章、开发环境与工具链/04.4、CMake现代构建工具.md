---
title: 4ã€CMakeç°ä»£æ„å»ºå·¥å…·
---
## ğŸ“š ç›®å½•

1. [CMakeæ˜¯ä»€ä¹ˆ](#1-cmakeæ˜¯ä»€ä¹ˆ)
2. [CMakeLists.txtåŸºç¡€è¯­æ³•](#2-cmakeliststxtåŸºç¡€è¯­æ³•)
3. [é¡¹ç›®é…ç½®ä¸ç›®æ ‡å®šä¹‰](#3-é¡¹ç›®é…ç½®ä¸ç›®æ ‡å®šä¹‰)
4. [åº“ä¾èµ–æŸ¥æ‰¾ä¸é“¾æ¥](#4-åº“ä¾èµ–æŸ¥æ‰¾ä¸é“¾æ¥)
5. [ç¼–è¯‘é€‰é¡¹ä¸é¢„å¤„ç†å™¨å®šä¹‰](#5-ç¼–è¯‘é€‰é¡¹ä¸é¢„å¤„ç†å™¨å®šä¹‰)
6. [å®‰è£…è§„åˆ™ä¸åŒ…ç®¡ç†](#6-å®‰è£…è§„åˆ™ä¸åŒ…ç®¡ç†)
7. [è·¨å¹³å°æ„å»ºé…ç½®](#7-è·¨å¹³å°æ„å»ºé…ç½®)
8. [ç”Ÿæˆå™¨é€‰æ‹©ä¸ä½¿ç”¨](#8-ç”Ÿæˆå™¨é€‰æ‹©ä¸ä½¿ç”¨)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ—ï¸ CMakeæ˜¯ä»€ä¹ˆ


### 1.1 CMakeçš„æœ¬è´¨


**ç®€å•ç†è§£**ï¼šCMakeå°±åƒæ˜¯ä¸€ä¸ª"ç¿»è¯‘å®˜"ï¼Œå®ƒæŠŠä½ å†™çš„ç®€å•é…ç½®æ–‡ä»¶ç¿»è¯‘æˆä¸åŒç¼–è¯‘å™¨èƒ½ç†è§£çš„æ„å»ºæ–‡ä»¶ã€‚

```
ä½ çš„æƒ³æ³•ï¼šæˆ‘è¦ç¼–è¯‘ä¸€ä¸ªç¨‹åºï¼Œéœ€è¦è¿™äº›æºæ–‡ä»¶ï¼Œé“¾æ¥è¿™äº›åº“
       â†“
CMakeç¿»è¯‘ï¼š
       â†“
Windows â†’ Visual Studioé¡¹ç›®æ–‡ä»¶(.sln)
Linux   â†’ Makefileæ–‡ä»¶
macOS   â†’ Xcodeé¡¹ç›®æ–‡ä»¶
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦CMake


**è§£å†³çš„æ ¸å¿ƒé—®é¢˜**ï¼š
- **å¹³å°å·®å¼‚**ï¼šä¸åŒæ“ä½œç³»ç»Ÿçš„ç¼–è¯‘æ–¹å¼ä¸åŒ
- **ç¼–è¯‘å™¨å·®å¼‚**ï¼šgccã€clangã€MSVCè¯­æ³•ä¸å®Œå…¨ä¸€æ ·
- **é¡¹ç›®å¤æ‚æ€§**ï¼šå¤§é¡¹ç›®æ‰‹å†™Makefileå¤ªå¤æ‚æ˜“é”™

**ä¼ ç»Ÿæ–¹å¼ vs CMakeæ–¹å¼**ï¼š
```
ä¼ ç»Ÿæ–¹å¼ï¼š
Windowsï¼šæ‰‹å†™.vcproj â†’ ç»´æŠ¤å›°éš¾
Linuxï¼š  æ‰‹å†™Makefile â†’ è¯­æ³•å¤æ‚
macOSï¼š  æ‰‹å†™Xcodeé…ç½® â†’ é‡å¤åŠ³åŠ¨

CMakeæ–¹å¼ï¼š
å†™ä¸€ä»½CMakeLists.txt â†’ è‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰å¹³å°çš„æ„å»ºæ–‡ä»¶
```

### 1.3 CMakeçš„å·¥ä½œæµç¨‹


```
æºç ç›®å½•ç»“æ„ï¼š
project/
â”œâ”€â”€ CMakeLists.txt     â† ä½ å†™çš„é…ç½®æ–‡ä»¶
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.cpp
â”‚   â””â”€â”€ utils.cpp
â””â”€â”€ include/
    â””â”€â”€ utils.h

CMakeå·¥ä½œæµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CMakeLists.txtâ”‚ â†’  â”‚    CMake     â”‚ â†’  â”‚ æ„å»ºç³»ç»Ÿæ–‡ä»¶  â”‚
â”‚   (é…ç½®)      â”‚    â”‚   (ç”Ÿæˆå™¨)    â”‚    â”‚ (Makefileç­‰) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â†“
                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                        â”‚   ç¼–è¯‘å™¨     â”‚
                                        â”‚  (gcc/clang) â”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â†“
                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                        â”‚  å¯æ‰§è¡Œæ–‡ä»¶   â”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ğŸ“ CMakeLists.txtåŸºç¡€è¯­æ³•


### 2.1 åŸºæœ¬è¯­æ³•è§„åˆ™


**è¯­æ³•ç‰¹ç‚¹**ï¼š
- **å‘½ä»¤æ ¼å¼**ï¼š`command(å‚æ•°1 å‚æ•°2 ...)`
- **å¤§å°å†™ä¸æ•æ„Ÿ**ï¼š`PROJECT`å’Œ`project`æ˜¯ä¸€æ ·çš„
- **å˜é‡å¼•ç”¨**ï¼š`${å˜é‡å}`
- **æ³¨é‡Š**ï¼š`#` å¼€å¤´çš„è¡Œ

### 2.2 æœ€ç®€å•çš„CMakeLists.txt


```cmake
# æŒ‡å®šCMakeæœ€ä½ç‰ˆæœ¬è¦æ±‚
cmake_minimum_required(VERSION 3.10)

# é¡¹ç›®åç§°
project(MyApp)

# æ·»åŠ å¯æ‰§è¡Œæ–‡ä»¶
add_executable(myapp main.cpp)
```

**æ¯è¡Œè§£é‡Š**ï¼š
- `cmake_minimum_required`ï¼šå‘Šè¯‰CMakeéœ€è¦ä»€ä¹ˆç‰ˆæœ¬ï¼Œé¿å…å…¼å®¹æ€§é—®é¢˜
- `project(MyApp)`ï¼šç»™é¡¹ç›®èµ·ä¸ªåå­—ï¼ŒCMakeä¼šè‡ªåŠ¨è®¾ç½®ç›¸å…³å˜é‡
- `add_executable`ï¼šåˆ›å»ºä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ç›®æ ‡ï¼Œåå­—å«myappï¼Œæºæ–‡ä»¶æ˜¯main.cpp

### 2.3 å¸¸ç”¨å˜é‡


**ç³»ç»Ÿé¢„å®šä¹‰å˜é‡**ï¼š
```cmake
# é¡¹ç›®ç›¸å…³
${PROJECT_NAME}           # é¡¹ç›®åç§°
${PROJECT_SOURCE_DIR}     # æºç æ ¹ç›®å½•
${PROJECT_BINARY_DIR}     # æ„å»ºç›®å½•

# è·¯å¾„ç›¸å…³  
${CMAKE_SOURCE_DIR}       # é¡¶å±‚æºç ç›®å½•
${CMAKE_BINARY_DIR}       # é¡¶å±‚æ„å»ºç›®å½•
${CMAKE_CURRENT_SOURCE_DIR}  # å½“å‰CMakeLists.txtæ‰€åœ¨ç›®å½•

# ç¼–è¯‘å™¨ç›¸å…³
${CMAKE_CXX_COMPILER}     # C++ç¼–è¯‘å™¨è·¯å¾„
${CMAKE_BUILD_TYPE}       # æ„å»ºç±»å‹(Debug/Release)
```

**è‡ªå®šä¹‰å˜é‡**ï¼š
```cmake
# è®¾ç½®å˜é‡
set(MY_SOURCES main.cpp utils.cpp helper.cpp)
set(MY_INCLUDE_DIR ${CMAKE_SOURCE_DIR}/include)

# ä½¿ç”¨å˜é‡
add_executable(myapp ${MY_SOURCES})
target_include_directories(myapp PRIVATE ${MY_INCLUDE_DIR})
```

### 2.4 æ¡ä»¶åˆ¤æ–­ä¸å¾ªç¯


**æ¡ä»¶åˆ¤æ–­**ï¼š
```cmake
# æ ¹æ®æ“ä½œç³»ç»Ÿé€‰æ‹©ä¸åŒé…ç½®
if(WIN32)
    # Windowsç‰¹æœ‰é…ç½®
    set(PLATFORM_LIBS ws2_32)
elseif(UNIX)
    # Unix/Linuxç‰¹æœ‰é…ç½®  
    set(PLATFORM_LIBS pthread)
endif()

# æ ¹æ®æ„å»ºç±»å‹ä¼˜åŒ–
if(CMAKE_BUILD_TYPE STREQUAL "Debug")
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -g -O0")
else()
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -O3")
endif()
```

**å¾ªç¯éå†**ï¼š
```cmake
# éå†æºæ–‡ä»¶åˆ—è¡¨
set(SOURCE_FILES main.cpp utils.cpp math.cpp)
foreach(source ${SOURCE_FILES})
    message("å¤„ç†æºæ–‡ä»¶: ${source}")
endforeach()

# æ‰¹é‡è®¾ç½®æ–‡ä»¶å±æ€§
file(GLOB_RECURSE ALL_HEADERS "include/*.h")
foreach(header ${ALL_HEADERS})
    set_source_files_properties(${header} PROPERTIES HEADER_FILE_ONLY TRUE)
endforeach()
```

---

## 3. ğŸ¯ é¡¹ç›®é…ç½®ä¸ç›®æ ‡å®šä¹‰


### 3.1 é¡¹ç›®åŸºæœ¬é…ç½®


**æ ‡å‡†é¡¹ç›®é…ç½®**ï¼š
```cmake
cmake_minimum_required(VERSION 3.10)

# é¡¹ç›®ä¿¡æ¯
project(MyProject 
    VERSION 1.0.0
    DESCRIPTION "ä¸€ä¸ªç¤ºä¾‹é¡¹ç›®"
    LANGUAGES CXX)

# C++æ ‡å‡†è®¾ç½®
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# è¾“å‡ºç›®å½•è®¾ç½®
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin)
set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib)
```

**é…ç½®è§£é‡Š**ï¼š
- `VERSION`ï¼šé¡¹ç›®ç‰ˆæœ¬å·ï¼Œä¼šè‡ªåŠ¨è®¾ç½®ç›¸å…³å˜é‡
- `LANGUAGES`ï¼šæŒ‡å®šä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€
- `CMAKE_CXX_STANDARD`ï¼šè¦æ±‚C++17æ ‡å‡†
- è¾“å‡ºç›®å½•ï¼šç»Ÿä¸€ç®¡ç†ç¼–è¯‘ç»“æœçš„å­˜æ”¾ä½ç½®

### 3.2 ç›®æ ‡ç±»å‹è¯¦è§£


**å¯æ‰§è¡Œæ–‡ä»¶ç›®æ ‡**ï¼š
```cmake
# æœ€ç®€å•å½¢å¼
add_executable(myapp main.cpp)

# å¤šæºæ–‡ä»¶å½¢å¼
add_executable(myapp 
    main.cpp
    src/utils.cpp
    src/config.cpp)

# ä½¿ç”¨å˜é‡å½¢å¼
set(APP_SOURCES main.cpp src/utils.cpp src/config.cpp)
add_executable(myapp ${APP_SOURCES})
```

**é™æ€åº“ç›®æ ‡**ï¼š
```cmake
# åˆ›å»ºé™æ€åº“
add_library(mylib STATIC
    src/math.cpp
    src/string_utils.cpp)

# è¿™æ ·å…¶ä»–ç¨‹åºå°±å¯ä»¥é“¾æ¥è¿™ä¸ªåº“
target_link_libraries(myapp mylib)
```

**åŠ¨æ€åº“ç›®æ ‡**ï¼š
```cmake
# åˆ›å»ºåŠ¨æ€åº“(å…±äº«åº“)
add_library(mysharedlib SHARED
    src/database.cpp
    src/network.cpp)

# è®¾ç½®åº“çš„ç‰ˆæœ¬ä¿¡æ¯
set_target_properties(mysharedlib PROPERTIES
    VERSION 1.2.3
    SOVERSION 1)
```

### 3.3 ç›®æ ‡å±æ€§è®¾ç½®


**ç¼–è¯‘ç‰¹æ€§è®¾ç½®**ï¼š
```cmake
# è®¾ç½®åŒ…å«ç›®å½•
target_include_directories(myapp 
    PRIVATE ${CMAKE_SOURCE_DIR}/include
    PUBLIC ${CMAKE_SOURCE_DIR}/public_include)

# è®¾ç½®ç¼–è¯‘é€‰é¡¹
target_compile_options(myapp PRIVATE
    $<$<CXX_COMPILER_ID:GNU>:-Wall -Wextra>
    $<$<CXX_COMPILER_ID:MSVC>:/W4>)

# è®¾ç½®é¢„å¤„ç†å®
target_compile_definitions(myapp PRIVATE
    APP_VERSION="${PROJECT_VERSION}"
    $<$<CONFIG:Debug>:DEBUG_MODE>)
```

**å¯è§æ€§è¯´æ˜**ï¼š
- `PRIVATE`ï¼šåªå¯¹å½“å‰ç›®æ ‡æœ‰æ•ˆ
- `PUBLIC`ï¼šå¯¹å½“å‰ç›®æ ‡å’Œé“¾æ¥å®ƒçš„ç›®æ ‡éƒ½æœ‰æ•ˆ  
- `INTERFACE`ï¼šåªå¯¹é“¾æ¥å½“å‰ç›®æ ‡çš„å…¶ä»–ç›®æ ‡æœ‰æ•ˆ

---

## 4. ğŸ”— åº“ä¾èµ–æŸ¥æ‰¾ä¸é“¾æ¥


### 4.1 find_packageåŸºç¡€ç”¨æ³•


**ä»€ä¹ˆæ˜¯find_package**ï¼š
å°±åƒåœ¨å›¾ä¹¦é¦†æ‰¾ä¹¦ä¸€æ ·ï¼Œ`find_package`å¸®ä½ åœ¨ç³»ç»Ÿä¸­æ‰¾åˆ°å·²å®‰è£…çš„åº“ï¼Œå¹¶å‘Šè¯‰ä½ æ€ä¹ˆä½¿ç”¨å®ƒä»¬ã€‚

```cmake
# æŸ¥æ‰¾OpenCVåº“
find_package(OpenCV REQUIRED)

# ä½¿ç”¨æ‰¾åˆ°çš„åº“
target_link_libraries(myapp ${OpenCV_LIBS})
target_include_directories(myapp PRIVATE ${OpenCV_INCLUDE_DIRS})
```

### 4.2 ç°ä»£CMakeçš„find_packageç”¨æ³•


**æ¨èæ–¹å¼ï¼ˆç›®æ ‡é“¾æ¥ï¼‰**ï¼š
```cmake
# æŸ¥æ‰¾åº“å¹¶åˆ›å»ºå¯¼å…¥ç›®æ ‡
find_package(OpenCV REQUIRED)
find_package(Boost REQUIRED COMPONENTS system filesystem)

# ç›´æ¥é“¾æ¥ç›®æ ‡ï¼Œè‡ªåŠ¨å¤„ç†å¤´æ–‡ä»¶è·¯å¾„
target_link_libraries(myapp 
    opencv_core opencv_imgproc
    Boost::system Boost::filesystem)
```

**ä¼ ç»Ÿæ–¹å¼ vs ç°ä»£æ–¹å¼å¯¹æ¯”**ï¼š
```
ä¼ ç»Ÿæ–¹å¼ï¼š
find_package(OpenCV REQUIRED)
target_include_directories(myapp PRIVATE ${OpenCV_INCLUDE_DIRS})
target_link_libraries(myapp ${OpenCV_LIBS})

ç°ä»£æ–¹å¼ï¼š
find_package(OpenCV REQUIRED)
target_link_libraries(myapp opencv_core opencv_imgproc)
# å¤´æ–‡ä»¶è·¯å¾„è‡ªåŠ¨å¤„ç†ï¼Œæ— éœ€æ‰‹åŠ¨æ·»åŠ 
```

### 4.3 å¸¸è§åº“çš„æŸ¥æ‰¾æ–¹å¼


**ç³»ç»Ÿåº“æŸ¥æ‰¾**ï¼š
```cmake
# çº¿ç¨‹åº“
find_package(Threads REQUIRED)
target_link_libraries(myapp Threads::Threads)

# OpenGL
find_package(OpenGL REQUIRED)
target_link_libraries(myapp OpenGL::GL)

# æ•°å­¦åº“(Linux)
if(UNIX)
    target_link_libraries(myapp m)  # é“¾æ¥æ•°å­¦åº“
endif()
```

**ç¬¬ä¸‰æ–¹åº“æŸ¥æ‰¾**ï¼š
```cmake
# Qt5
find_package(Qt5 REQUIRED COMPONENTS Core Widgets)
target_link_libraries(myapp Qt5::Core Qt5::Widgets)

# protobuf
find_package(Protobuf REQUIRED)
target_link_libraries(myapp protobuf::libprotobuf)

# JSONåº“
find_package(nlohmann_json REQUIRED)
target_link_libraries(myapp nlohmann_json::nlohmann_json)
```

### 4.4 å¤„ç†æ‰¾ä¸åˆ°åº“çš„æƒ…å†µ


**å¯é€‰ä¾èµ–å¤„ç†**ï¼š
```cmake
# å°è¯•æŸ¥æ‰¾å¯é€‰åº“
find_package(OpenMP)
if(OpenMP_FOUND)
    target_link_libraries(myapp OpenMP::OpenMP_CXX)
    target_compile_definitions(myapp PRIVATE HAVE_OPENMP)
else()
    message(WARNING "OpenMP not found, å°†ä½¿ç”¨å•çº¿ç¨‹ç‰ˆæœ¬")
endif()
```

**æ‰‹åŠ¨æŒ‡å®šåº“è·¯å¾„**ï¼š
```cmake
# å¦‚æœfind_packageæ‰¾ä¸åˆ°ï¼Œå¯ä»¥æ‰‹åŠ¨æŒ‡å®š
if(NOT TARGET myspeciallib)
    find_library(SPECIAL_LIB 
        NAMES speciallib libspecial
        PATHS /usr/local/lib /opt/lib)
    
    if(SPECIAL_LIB)
        add_library(myspeciallib UNKNOWN IMPORTED)
        set_target_properties(myspeciallib PROPERTIES
            IMPORTED_LOCATION ${SPECIAL_LIB})
    endif()
endif()
```

---

## 5. âš™ï¸ ç¼–è¯‘é€‰é¡¹ä¸é¢„å¤„ç†å™¨å®šä¹‰


### 5.1 ç¼–è¯‘é€‰é¡¹çš„ä½œç”¨


**ç¼–è¯‘é€‰é¡¹å°±åƒç»™ç¼–è¯‘å™¨çš„"æŒ‡ç¤ºç‰Œ"**ï¼š
- å‘Šè¯‰ç¼–è¯‘å™¨ç”¨ä»€ä¹ˆæ ‡å‡†ç¼–è¯‘ï¼ˆC++17ã€C++20ï¼‰
- å¼€å¯ä»€ä¹ˆè­¦å‘Šï¼ˆå¸®ä½ å‘ç°æ½œåœ¨é—®é¢˜ï¼‰
- ç”¨ä»€ä¹ˆä¼˜åŒ–çº§åˆ«ï¼ˆè°ƒè¯•ç”¨O0ï¼Œå‘å¸ƒç”¨O3ï¼‰

### 5.2 å…¨å±€ç¼–è¯‘é€‰é¡¹è®¾ç½®


**è®¾ç½®C++æ ‡å‡†**ï¼š
```cmake
# æ–¹å¼1ï¼šå…¨å±€è®¾ç½®
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# æ–¹å¼2ï¼šé’ˆå¯¹ç‰¹å®šç›®æ ‡
set_property(TARGET myapp PROPERTY CXX_STANDARD 20)
```

**ç¼–è¯‘å™¨ç‰¹å®šé€‰é¡¹**ï¼š
```cmake
# æ ¹æ®ç¼–è¯‘å™¨ç±»å‹è®¾ç½®ä¸åŒé€‰é¡¹
if(CMAKE_CXX_COMPILER_ID STREQUAL "GNU")
    # GCCç¼–è¯‘å™¨é€‰é¡¹
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall -Wextra -pedantic")
elseif(CMAKE_CXX_COMPILER_ID STREQUAL "Clang")
    # Clangç¼–è¯‘å™¨é€‰é¡¹
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall -Wextra -Weverything")
elseif(CMAKE_CXX_COMPILER_ID STREQUAL "MSVC")
    # MSVCç¼–è¯‘å™¨é€‰é¡¹
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} /W4")
endif()
```

### 5.3 ç›®æ ‡ç‰¹å®šç¼–è¯‘é€‰é¡¹


**æ¨èæ–¹å¼ï¼ˆç›®æ ‡ç‰¹å®šï¼‰**ï¼š
```cmake
# ç°ä»£CMakeæ¨èæ–¹å¼
target_compile_options(myapp PRIVATE
    $<$<CXX_COMPILER_ID:GNU>:-Wall -Wextra -O2>
    $<$<CXX_COMPILER_ID:Clang>:-Wall -Wextra -O2>
    $<$<CXX_COMPILER_ID:MSVC>:/W4 /O2>)

# æ ¹æ®æ„å»ºç±»å‹è®¾ç½®é€‰é¡¹
target_compile_options(myapp PRIVATE
    $<$<CONFIG:Debug>:-g -O0 -DDEBUG>
    $<$<CONFIG:Release>:-O3 -DNDEBUG>)
```

**ç”Ÿæˆå™¨è¡¨è¾¾å¼è§£é‡Š**ï¼š
- `$<$<CXX_COMPILER_ID:GNU>:é€‰é¡¹>`ï¼šå¦‚æœæ˜¯GCCç¼–è¯‘å™¨å°±åº”ç”¨è¿™äº›é€‰é¡¹
- `$<$<CONFIG:Debug>:é€‰é¡¹>`ï¼šå¦‚æœæ˜¯Debugæ„å»ºå°±åº”ç”¨è¿™äº›é€‰é¡¹

### 5.4 é¢„å¤„ç†å™¨å®šä¹‰


**é¢„å¤„ç†å™¨å®šä¹‰çš„ä½œç”¨**ï¼š
å°±åƒåœ¨ä»£ç ä¸­è®¾ç½®"å¼€å…³"ï¼Œå¯ä»¥æ ¹æ®ç¼–è¯‘æ—¶çš„æ¡ä»¶åŒ…å«ä¸åŒçš„ä»£ç ã€‚

```cmake
# è®¾ç½®ç‰ˆæœ¬ä¿¡æ¯
target_compile_definitions(myapp PRIVATE
    APP_NAME="${PROJECT_NAME}"
    APP_VERSION="${PROJECT_VERSION}")

# æ¡ä»¶ç¼–è¯‘å¼€å…³
target_compile_definitions(myapp PRIVATE
    $<$<CONFIG:Debug>:DEBUG_MODE>
    $<$<CONFIG:Release>:RELEASE_MODE>
    $<$<PLATFORM_ID:Windows>:WINDOWS_PLATFORM>
    $<$<PLATFORM_ID:Linux>:LINUX_PLATFORM>)
```

**åœ¨C++ä»£ç ä¸­ä½¿ç”¨**ï¼š
```cpp
#include <iostream>

int main() {
    std::cout << "åº”ç”¨åç§°: " << APP_NAME << std::endl;
    std::cout << "ç‰ˆæœ¬: " << APP_VERSION << std::endl;
    
#ifdef DEBUG_MODE
    std::cout << "è¿è¡Œåœ¨è°ƒè¯•æ¨¡å¼" << std::endl;
#endif

#ifdef WINDOWS_PLATFORM
    // Windowsç‰¹æœ‰ä»£ç 
#elif defined(LINUX_PLATFORM)
    // Linuxç‰¹æœ‰ä»£ç 
#endif
    
    return 0;
}
```

### 5.5 ç¼–è¯‘ä¼˜åŒ–é…ç½®


**æ€§èƒ½ä¼˜åŒ–è®¾ç½®**ï¼š
```cmake
# åˆ›å»ºä¸åŒçš„æ„å»ºç±»å‹
set(CMAKE_CONFIGURATION_TYPES "Debug;Release;RelWithDebInfo" CACHE STRING "" FORCE)

# Debug: æ–¹ä¾¿è°ƒè¯•
set(CMAKE_CXX_FLAGS_DEBUG "-g -O0 -DDEBUG")

# Release: æœ€å¤§æ€§èƒ½
set(CMAKE_CXX_FLAGS_RELEASE "-O3 -DNDEBUG")

# RelWithDebInfo: æ€§èƒ½+è°ƒè¯•ä¿¡æ¯
set(CMAKE_CXX_FLAGS_RELWITHDEBINFO "-O2 -g -DNDEBUG")
```

---

## 6. ğŸ“¦ å®‰è£…è§„åˆ™ä¸åŒ…ç®¡ç†


### 6.1 å®‰è£…è§„åˆ™çš„æ¦‚å¿µ


**å®‰è£…æ˜¯ä»€ä¹ˆ**ï¼š
å°±åƒæŠŠç¼–è¯‘å¥½çš„ç¨‹åº"æ¬å®¶"åˆ°ç³»ç»Ÿçš„æ ‡å‡†ä½ç½®ï¼Œè¿™æ ·å…¶ä»–ç¨‹åºæˆ–ç”¨æˆ·å°±èƒ½æ–¹ä¾¿åœ°ä½¿ç”¨å®ƒã€‚

```
å…¸å‹çš„å®‰è£…ä½ç½®ï¼š
/usr/local/bin/     â† å¯æ‰§è¡Œæ–‡ä»¶
/usr/local/lib/     â† åº“æ–‡ä»¶  
/usr/local/include/ â† å¤´æ–‡ä»¶
/usr/local/share/   â† æ–‡æ¡£ã€é…ç½®ç­‰
```

### 6.2 åŸºæœ¬å®‰è£…è§„åˆ™


**å®‰è£…å¯æ‰§è¡Œæ–‡ä»¶**ï¼š
```cmake
# å®‰è£…å¯æ‰§è¡Œæ–‡ä»¶åˆ° bin ç›®å½•
install(TARGETS myapp
    RUNTIME DESTINATION bin)

# ä¹Ÿå¯ä»¥æŒ‡å®šå…·ä½“è·¯å¾„
install(TARGETS myapp
    RUNTIME DESTINATION ${CMAKE_INSTALL_PREFIX}/bin)
```

**å®‰è£…åº“æ–‡ä»¶**ï¼š
```cmake
# å®‰è£…é™æ€åº“å’ŒåŠ¨æ€åº“
install(TARGETS mylib mysharedlib
    LIBRARY DESTINATION lib     # åŠ¨æ€åº“(.so)
    ARCHIVE DESTINATION lib     # é™æ€åº“(.a)
    RUNTIME DESTINATION bin)    # Windowsçš„DLL
```

**å®‰è£…å¤´æ–‡ä»¶**ï¼š
```cmake
# å®‰è£…å•ä¸ªå¤´æ–‡ä»¶
install(FILES include/mylib.h
    DESTINATION include)

# å®‰è£…æ•´ä¸ªç›®å½•çš„å¤´æ–‡ä»¶
install(DIRECTORY include/
    DESTINATION include
    FILES_MATCHING PATTERN "*.h")
```

### 6.3 å¤æ‚å®‰è£…é…ç½®


**æ¡ä»¶å®‰è£…**ï¼š
```cmake
# åªåœ¨Releaseæ¨¡å¼ä¸‹å®‰è£…
install(TARGETS myapp
    RUNTIME DESTINATION bin
    CONFIGURATIONS Release)

# æ ¹æ®å¹³å°å®‰è£…ä¸åŒæ–‡ä»¶
if(WIN32)
    install(FILES config/windows.conf
        DESTINATION etc RENAME myapp.conf)
elseif(UNIX)
    install(FILES config/unix.conf  
        DESTINATION etc RENAME myapp.conf)
endif()
```

**å®‰è£…åå¤„ç†**ï¼š
```cmake
# è®¾ç½®å®‰è£…åçš„æ–‡ä»¶æƒé™
install(TARGETS myapp
    RUNTIME DESTINATION bin
    PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE
                GROUP_READ GROUP_EXECUTE
                WORLD_READ WORLD_EXECUTE)

# åˆ›å»ºç¬¦å·é“¾æ¥
install(CODE "execute_process(COMMAND ${CMAKE_COMMAND} -E create_symlink
    ${CMAKE_INSTALL_PREFIX}/bin/myapp
    ${CMAKE_INSTALL_PREFIX}/bin/myapp-${PROJECT_VERSION})")
```

### 6.4 CMakeåŒ…é…ç½®


**ç”ŸæˆåŒ…é…ç½®æ–‡ä»¶**ï¼š
```cmake
# åŒ…å«CMakeçš„åŒ…é…ç½®æ¨¡å—
include(CMakePackageConfigHelpers)

# ç”Ÿæˆç‰ˆæœ¬æ–‡ä»¶
write_basic_package_version_file(
    "${CMAKE_CURRENT_BINARY_DIR}/MyLibConfigVersion.cmake"
    VERSION ${PROJECT_VERSION}
    COMPATIBILITY AnyNewerVersion)

# ç”Ÿæˆé…ç½®æ–‡ä»¶
configure_package_config_file(
    "${CMAKE_CURRENT_SOURCE_DIR}/Config.cmake.in"
    "${CMAKE_CURRENT_BINARY_DIR}/MyLibConfig.cmake"
    INSTALL_DESTINATION lib/cmake/MyLib)

# å®‰è£…é…ç½®æ–‡ä»¶
install(FILES
    "${CMAKE_CURRENT_BINARY_DIR}/MyLibConfig.cmake"
    "${CMAKE_CURRENT_BINARY_DIR}/MyLibConfigVersion.cmake"
    DESTINATION lib/cmake/MyLib)
```

**Config.cmake.inæ¨¡æ¿æ–‡ä»¶**ï¼š
```cmake
@PACKAGE_INIT@

include("${CMAKE_CURRENT_LIST_DIR}/MyLibTargets.cmake")

check_required_components(MyLib)
```

### 6.5 ä½¿ç”¨æ‰“åŒ…å·¥å…·


**CPacké›†æˆ**ï¼š
```cmake
# å¯ç”¨CPack
include(CPack)

# è®¾ç½®åŒ…ä¿¡æ¯
set(CPACK_PACKAGE_NAME "${PROJECT_NAME}")
set(CPACK_PACKAGE_VERSION "${PROJECT_VERSION}")
set(CPACK_PACKAGE_DESCRIPTION "æˆ‘çš„åº”ç”¨ç¨‹åº")
set(CPACK_PACKAGE_CONTACT "your.email@example.com")

# Linuxä¸‹ç”ŸæˆDEBåŒ…
set(CPACK_DEBIAN_PACKAGE_MAINTAINER "Your Name")
set(CPACK_DEBIAN_PACKAGE_DEPENDS "libc6, libstdc++6")

# ç”ŸæˆåŒ…çš„å‘½ä»¤: cmake --build . --target package
```

---

## 7. ğŸŒ è·¨å¹³å°æ„å»ºé…ç½®


### 7.1 è·¨å¹³å°çš„æŒ‘æˆ˜


**ä¸åŒå¹³å°çš„å·®å¼‚**ï¼š
```
Windows:
- æ–‡ä»¶è·¯å¾„ç”¨åæ–œæ  \
- åŠ¨æ€åº“åç¼€ .dll
- å¯æ‰§è¡Œæ–‡ä»¶åç¼€ .exe

Linux/macOS:
- æ–‡ä»¶è·¯å¾„ç”¨æ­£æ–œæ  /  
- åŠ¨æ€åº“åç¼€ .so/.dylib
- å¯æ‰§è¡Œæ–‡ä»¶æ— åç¼€
```

### 7.2 å¹³å°æ£€æµ‹ä¸é…ç½®


**åŸºæœ¬å¹³å°æ£€æµ‹**ï¼š
```cmake
# æ£€æµ‹æ“ä½œç³»ç»Ÿ
if(WIN32)
    message("æ„å»ºWindowsç‰ˆæœ¬")
    set(PLATFORM_NAME "Windows")
elseif(APPLE)
    message("æ„å»ºmacOSç‰ˆæœ¬")
    set(PLATFORM_NAME "macOS")
elseif(UNIX)
    message("æ„å»ºLinuxç‰ˆæœ¬")  
    set(PLATFORM_NAME "Linux")
endif()

# æ£€æµ‹ç¼–è¯‘å™¨
if(CMAKE_CXX_COMPILER_ID STREQUAL "MSVC")
    set(PLATFORM_LIBS "ws2_32.lib;advapi32.lib")
elseif(CMAKE_CXX_COMPILER_ID STREQUAL "GNU")
    set(PLATFORM_LIBS "pthread;dl")
endif()
```

**æ¶æ„æ£€æµ‹**ï¼š
```cmake
# æ£€æµ‹CPUæ¶æ„
if(CMAKE_SIZEOF_VOID_P EQUAL 8)
    set(ARCH_64 TRUE)
    message("64ä½æ¶æ„")
else()
    set(ARCH_32 TRUE)
    message("32ä½æ¶æ„")
endif()

# è®¾ç½®æ¶æ„ç›¸å…³çš„åº“è·¯å¾„
if(ARCH_64)
    set(LIB_SUFFIX "64")
else()
    set(LIB_SUFFIX "32")
endif()
```

### 7.3 å¹³å°ç‰¹å®šæºæ–‡ä»¶


**æ¡ä»¶ç¼–è¯‘æºæ–‡ä»¶**ï¼š
```cmake
# å…¬å…±æºæ–‡ä»¶
set(COMMON_SOURCES
    src/main.cpp
    src/common.cpp)

# å¹³å°ç‰¹å®šæºæ–‡ä»¶
if(WIN32)
    list(APPEND PLATFORM_SOURCES src/windows_impl.cpp)
elseif(APPLE)
    list(APPEND PLATFORM_SOURCES src/macos_impl.cpp)
elseif(UNIX)
    list(APPEND PLATFORM_SOURCES src/linux_impl.cpp)
endif()

# åˆå¹¶æºæ–‡ä»¶
add_executable(myapp ${COMMON_SOURCES} ${PLATFORM_SOURCES})
```

### 7.4 è·¯å¾„å¤„ç†


**è·¨å¹³å°è·¯å¾„å¤„ç†**ï¼š
```cmake
# ä½¿ç”¨CMakeçš„è·¯å¾„å¤„ç†å‡½æ•°
set(CONFIG_FILE_PATH "${CMAKE_SOURCE_DIR}/config/app.conf")

# åœ¨Windowsä¸Šè‡ªåŠ¨è½¬æ¢ä¸ºæ­£ç¡®çš„è·¯å¾„æ ¼å¼
file(TO_NATIVE_PATH "${CONFIG_FILE_PATH}" NATIVE_CONFIG_PATH)

# å¤åˆ¶æ–‡ä»¶åˆ°æ„å»ºç›®å½•
configure_file(
    "${CONFIG_FILE_PATH}"
    "${CMAKE_BINARY_DIR}/app.conf"
    COPYONLY)
```

### 7.5 å·¥å…·é“¾æ–‡ä»¶


**äº¤å‰ç¼–è¯‘é…ç½®**ï¼š
```cmake
# toolchain-arm.cmake - ARMäº¤å‰ç¼–è¯‘å·¥å…·é“¾
set(CMAKE_SYSTEM_NAME Linux)
set(CMAKE_SYSTEM_PROCESSOR arm)

# æŒ‡å®šäº¤å‰ç¼–è¯‘å™¨
set(CMAKE_C_COMPILER arm-linux-gnueabihf-gcc)
set(CMAKE_CXX_COMPILER arm-linux-gnueabihf-g++)

# è®¾ç½®æŸ¥æ‰¾è·¯å¾„
set(CMAKE_FIND_ROOT_PATH /usr/arm-linux-gnueabihf)
set(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)
set(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)
set(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)

# ä½¿ç”¨: cmake -DCMAKE_TOOLCHAIN_FILE=toolchain-arm.cmake ..
```

---

## 8. ğŸ”§ ç”Ÿæˆå™¨é€‰æ‹©ä¸ä½¿ç”¨


### 8.1 ä»€ä¹ˆæ˜¯ç”Ÿæˆå™¨


**ç”Ÿæˆå™¨çš„ä½œç”¨**ï¼š
CMakeç”Ÿæˆå™¨å°±åƒ"æ–¹è¨€ç¿»è¯‘å™¨"ï¼ŒæŠŠCMakeçš„"é€šç”¨è¯­è¨€"ç¿»è¯‘æˆä¸åŒæ„å»ºç³»ç»Ÿçš„"æ–¹è¨€"ã€‚

```
CMakeé…ç½®æ–‡ä»¶
       â†“
   ç”Ÿæˆå™¨ç¿»è¯‘
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Makefile  â”‚ Visual Studioâ”‚    Xcode    â”‚
â”‚  (Linux)    â”‚  (Windows)  â”‚   (macOS)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 æŸ¥çœ‹å¯ç”¨ç”Ÿæˆå™¨


**æŸ¥çœ‹ç³»ç»Ÿæ”¯æŒçš„ç”Ÿæˆå™¨**ï¼š
```bash
# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨ç”Ÿæˆå™¨
cmake --help

# å¸¸è§ç”Ÿæˆå™¨åˆ—è¡¨ï¼š
# Unix Makefiles        - Linux/macOSé»˜è®¤
# Visual Studio 16 2019 - Windows VS2019
# Visual Studio 17 2022 - Windows VS2022  
# Xcode                 - macOS Xcode
# Ninja                 - è·¨å¹³å°é«˜æ€§èƒ½æ„å»º
```

### 8.3 ç”Ÿæˆå™¨çš„é€‰æ‹©ä¸ä½¿ç”¨


**Linux/macOSç¯å¢ƒ**ï¼š
```bash
# ä½¿ç”¨é»˜è®¤ç”Ÿæˆå™¨(é€šå¸¸æ˜¯Unix Makefiles)
cmake ..

# æ˜¾å¼æŒ‡å®šMakefileç”Ÿæˆå™¨
cmake -G "Unix Makefiles" ..

# ä½¿ç”¨Ninjaç”Ÿæˆå™¨(æ›´å¿«çš„æ„å»ºé€Ÿåº¦)
cmake -G "Ninja" ..
```

**Windowsç¯å¢ƒ**ï¼š
```bash
# ä½¿ç”¨Visual Studio 2022
cmake -G "Visual Studio 17 2022" ..

# æŒ‡å®šæ¶æ„
cmake -G "Visual Studio 17 2022" -A x64 ..
cmake -G "Visual Studio 17 2022" -A Win32 ..

# ä½¿ç”¨Ninja(éœ€è¦åœ¨VSå¼€å‘è€…å‘½ä»¤è¡Œä¸­)
cmake -G "Ninja" ..
```

### 8.4 ç”Ÿæˆå™¨ç‰¹å®šé…ç½®


**Makefileç”Ÿæˆå™¨é…ç½®**ï¼š
```cmake
# å¹¶è¡Œç¼–è¯‘è®¾ç½®
if(CMAKE_GENERATOR STREQUAL "Unix Makefiles")
    # è‡ªåŠ¨æ£€æµ‹CPUæ ¸å¿ƒæ•°
    include(ProcessorCount)
    ProcessorCount(CPU_COUNT)
    set(CMAKE_BUILD_PARALLEL_LEVEL ${CPU_COUNT})
endif()
```

**Visual Studioç”Ÿæˆå™¨é…ç½®**ï¼š
```cmake
# VSç‰¹å®šè®¾ç½®
if(CMAKE_GENERATOR MATCHES "Visual Studio")
    # è®¾ç½®å¯åŠ¨é¡¹ç›®
    set_property(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR} 
        PROPERTY VS_STARTUP_PROJECT myapp)
    
    # è®¾ç½®è°ƒè¯•å·¥ä½œç›®å½•
    set_target_properties(myapp PROPERTIES
        VS_DEBUGGER_WORKING_DIRECTORY "${CMAKE_SOURCE_DIR}")
endif()
```

**Ninjaç”Ÿæˆå™¨é…ç½®**ï¼š
```cmake
# Ninjaç‰¹å®šä¼˜åŒ–
if(CMAKE_GENERATOR STREQUAL "Ninja")
    # å¯ç”¨é¢œè‰²è¾“å‡º
    if(CMAKE_CXX_COMPILER_ID STREQUAL "GNU")
        add_compile_options(-fdiagnostics-color=always)
    elseif(CMAKE_CXX_COMPILER_ID STREQUAL "Clang")
        add_compile_options(-fcolor-diagnostics)
    endif()
endif()
```

### 8.5 æ„å»ºå‘½ä»¤å¯¹æ¯”


**ä¸åŒç”Ÿæˆå™¨çš„æ„å»ºå‘½ä»¤**ï¼š

| ç”Ÿæˆå™¨ | é…ç½®å‘½ä»¤ | æ„å»ºå‘½ä»¤ | è¯´æ˜ |
|--------|----------|----------|------|
| **Unix Makefiles** | `cmake ..` | `make -j4` | Linux/macOSæ ‡å‡† |
| **Ninja** | `cmake -G Ninja ..` | `ninja` | é«˜æ€§èƒ½è·¨å¹³å° |
| **Visual Studio** | `cmake -G "Visual Studio 17 2022" ..` | `cmake --build .` | Windows IDE |
| **Xcode** | `cmake -G Xcode ..` | `cmake --build .` | macOS IDE |

**é€šç”¨æ„å»ºå‘½ä»¤**ï¼š
```bash
# é…ç½®é˜¶æ®µ
cmake -B build -S .

# æ„å»ºé˜¶æ®µ(é€‚ç”¨äºæ‰€æœ‰ç”Ÿæˆå™¨)
cmake --build build

# å®‰è£…é˜¶æ®µ
cmake --build build --target install

# æ‰“åŒ…é˜¶æ®µ
cmake --build build --target package
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ CMakeæœ¬è´¨ï¼šè·¨å¹³å°æ„å»ºç³»ç»Ÿç”Ÿæˆå™¨ï¼Œä¸€æ¬¡é…ç½®å¤šå¹³å°ç¼–è¯‘
ğŸ”¸ CMakeLists.txtï¼šé¡¹ç›®é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨ç®€å•å‘½ä»¤æè¿°æ„å»ºè§„åˆ™  
ğŸ”¸ ç›®æ ‡(Target)ï¼šå¯æ‰§è¡Œæ–‡ä»¶ã€åº“æ–‡ä»¶ç­‰æ„å»ºäº§ç‰©çš„æŠ½è±¡è¡¨ç¤º
ğŸ”¸ ç”Ÿæˆå™¨ï¼šå°†CMakeé…ç½®è½¬æ¢ä¸ºå…·ä½“æ„å»ºç³»ç»Ÿæ–‡ä»¶çš„å·¥å…·
ğŸ”¸ find_packageï¼šæŸ¥æ‰¾å¹¶é…ç½®å¤–éƒ¨ä¾èµ–åº“çš„æ ‡å‡†æ–¹æ³•
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ç°ä»£CMake vs ä¼ ç»ŸCMake**
```
ä¼ ç»Ÿåšæ³•ï¼š
- ä½¿ç”¨å…¨å±€å˜é‡é…ç½®
- æ‰‹åŠ¨ç®¡ç†å¤´æ–‡ä»¶è·¯å¾„
- å¤æ‚çš„è·¯å¾„æ‹¼æ¥

ç°ä»£åšæ³•ï¼š
- åŸºäºtargetçš„é…ç½®
- è‡ªåŠ¨ä¼ æ’­ä¾èµ–å…³ç³»
- ä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼
```

**ğŸ”¹ CMakeçš„å±‚æ¬¡ç»“æ„**
```
é¡¹ç›®å±‚æ¬¡ï¼š
project() â†’ add_executable/library() â†’ target_*()
å…¨å±€é…ç½® â†’ ç›®æ ‡å®šä¹‰ â†’ ç›®æ ‡å±æ€§è®¾ç½®

ä¾èµ–å…³ç³»ï¼š
åº“ç›®æ ‡ â†’ å¯æ‰§è¡Œç›®æ ‡ â†’ å®‰è£…è§„åˆ™
åº•å±‚ç»„ä»¶ â†’ ä¸Šå±‚åº”ç”¨ â†’ æœ€ç»ˆéƒ¨ç½²
```

**ğŸ”¹ è·¨å¹³å°çš„æ ¸å¿ƒæ€æƒ³**
```
ä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„æ„å»ºï¼š
ç›¸åŒçš„CMakeLists.txt â†’ ä¸åŒå¹³å°çš„æ„å»ºæ–‡ä»¶
ç»Ÿä¸€çš„é…ç½®è¯­æ³• â†’ å¹³å°ç‰¹å®šçš„ç¼–è¯‘å™¨è°ƒç”¨
æŠ½è±¡çš„ç›®æ ‡æ¦‚å¿µ â†’ å…·ä½“çš„æ–‡ä»¶å’Œå‘½ä»¤
```

### 9.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ é¡¹ç›®ç®¡ç†ä»·å€¼**
- **ç®€åŒ–æ„å»º**ï¼šæ¶ˆé™¤æ‰‹åŠ¨ç¼–å†™Makefileçš„å¤æ‚æ€§
- **å›¢é˜Ÿåä½œ**ï¼šç»Ÿä¸€çš„æ„å»ºé…ç½®ï¼Œå‡å°‘ç¯å¢ƒå·®å¼‚
- **æŒç»­é›†æˆ**ï¼šæ”¯æŒè‡ªåŠ¨åŒ–æ„å»ºå’Œæµ‹è¯•æµç¨‹

**ğŸ”§ å¼€å‘æ•ˆç‡æå‡**
- **ä¾èµ–ç®¡ç†**ï¼šè‡ªåŠ¨å¤„ç†åº“ä¾èµ–å’Œé“¾æ¥å…³ç³»
- **ä»£ç ç»„ç»‡**ï¼šæ¸…æ™°çš„ç›®æ ‡å’Œæ¨¡å—åˆ’åˆ†
- **è°ƒè¯•æ”¯æŒ**ï¼šç”Ÿæˆé€‚åˆè°ƒè¯•çš„é¡¹ç›®æ–‡ä»¶

**ğŸ“¦ éƒ¨ç½²å’Œåˆ†å‘**
- **åŒ…ç®¡ç†**ï¼šç”Ÿæˆæ ‡å‡†çš„è½¯ä»¶åŒ…æ ¼å¼
- **å®‰è£…è§„åˆ™**ï¼šè‡ªåŠ¨åŒ–çš„å®‰è£…å’Œéƒ¨ç½²æµç¨‹
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šç»Ÿä¸€çš„ç‰ˆæœ¬ç®¡ç†æœºåˆ¶

### 9.4 å­¦ä¹ è·¯å¾„å»ºè®®


**ğŸŒ± å…¥é—¨é˜¶æ®µ**
```
1. ç†è§£CMakeåŸºæœ¬æ¦‚å¿µå’Œå·¥ä½œæµç¨‹
2. ç»ƒä¹ ç¼–å†™ç®€å•çš„CMakeLists.txt
3. æŒæ¡add_executableå’ŒåŸºæœ¬å˜é‡ä½¿ç”¨
4. å­¦ä¼šæŸ¥çœ‹å’Œä½¿ç”¨CMakeæ–‡æ¡£
```

**ğŸŒ¿ è¿›é˜¶é˜¶æ®µ**  
```
1. æŒæ¡ç°ä»£CMakeçš„target-basedæ–¹æ³•
2. å­¦ä¹ find_packageå’Œåº“ä¾èµ–ç®¡ç†
3. ç†è§£è·¨å¹³å°é…ç½®å’Œæ¡ä»¶ç¼–è¯‘
4. å®è·µå¤æ‚é¡¹ç›®çš„æ„å»ºé…ç½®
```

**ğŸŒ³ é«˜çº§é˜¶æ®µ**
```
1. æ·±å…¥ç†è§£ç”Ÿæˆå™¨è¡¨è¾¾å¼å’Œé«˜çº§ç‰¹æ€§
2. ç¼–å†™è‡ªå®šä¹‰FindModuleå’ŒConfigæ–‡ä»¶
3. æŒæ¡CMakeçš„æ‰©å±•å’Œè‡ªå®šä¹‰å‘½ä»¤
4. ä¼˜åŒ–å¤§å‹é¡¹ç›®çš„æ„å»ºæ€§èƒ½
```

### 9.5 å¸¸è§é—®é¢˜å’Œæœ€ä½³å®è·µ


**âš ï¸ å¸¸è§è¯¯åŒº**
```
âŒ æ»¥ç”¨å…¨å±€å˜é‡å’Œè®¾ç½®
âœ… ä½¿ç”¨target_*å‡½æ•°è¿›è¡Œç›®æ ‡ç‰¹å®šé…ç½®

âŒ ç¡¬ç¼–ç è·¯å¾„å’Œç¼–è¯‘å™¨é€‰é¡¹  
âœ… ä½¿ç”¨å˜é‡å’Œç”Ÿæˆå™¨è¡¨è¾¾å¼

âŒ å¿½ç•¥è·¨å¹³å°å…¼å®¹æ€§
âœ… ä»é¡¹ç›®å¼€å§‹å°±è€ƒè™‘å¤šå¹³å°æ”¯æŒ
```

**ğŸ’¡ æœ€ä½³å®è·µ**
```
â€¢ ä½¿ç”¨ç°ä»£CMakeè¯­æ³•ï¼ˆ3.10+ç‰ˆæœ¬ç‰¹æ€§ï¼‰
â€¢ ä¼˜å…ˆä½¿ç”¨target_link_librariesé“¾æ¥åº“
â€¢ åˆç†ç»„ç»‡ç›®å½•ç»“æ„å’ŒCMakeLists.txt
â€¢ ä¸ºå¤æ‚é¡¹ç›®ç¼–å†™æ¸…æ™°çš„æ–‡æ¡£å’Œæ³¨é‡Š
â€¢ å®šæœŸæµ‹è¯•åœ¨ä¸åŒå¹³å°å’Œç¼–è¯‘å™¨ä¸‹çš„æ„å»º
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- CMakeç”Ÿæˆå™¨ï¼Œä¸€é…å¤šå¹³å°
- ç›®æ ‡ä¸ºä¸­å¿ƒï¼Œå±æ€§å±‚å±‚ä¼ 
- find_packageæ‰¾åº“ï¼Œtarget_linkæ¥è¿
- è·¨å¹³å°æ€ç»´ï¼Œç”Ÿæˆå™¨æ¥è½¬æ¢