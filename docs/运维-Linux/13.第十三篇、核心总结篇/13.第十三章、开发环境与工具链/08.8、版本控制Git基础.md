---
title: 8、版本控制Git基础
---
## 📚 目录

1. [Git基础概念](#1-Git基础概念)
2. [Git仓库初始化与配置](#2-Git仓库初始化与配置)
3. [基本操作命令](#3-基本操作命令)
4. [分支管理与合并策略](#4-分支管理与合并策略)
5. [远程仓库操作](#5-远程仓库操作)
6. [冲突解决方法](#6-冲突解决方法)
7. [标签管理与版本发布](#7-标签管理与版本发布)
8. [gitignore文件配置](#8-gitignore文件配置)
9. [核心要点总结](#9-核心要点总结)

---

## 1. 🎯 Git基础概念


### 1.1 什么是Git？


**Git简单理解**：Git就像是给你的代码拍照，每次修改后都能保存一张"快照"，让你随时回到任何一个历史版本。

```
传统文件管理方式：
project.txt
project_备份.txt
project_最终版.txt
project_真正最终版.txt
project_老板修改版.txt

Git管理方式：
project.txt (自动记录所有历史版本)
- 版本1：初始代码
- 版本2：添加登录功能
- 版本3：修复登录bug
- 版本4：添加注册功能
```

### 1.2 Git核心概念


**📋 工作区域概念**
```
┌─────────────────┐
│    工作目录      │ ← 你正在编辑的文件
│   (Working)     │
└─────────────────┘
         │ git add
         ▼
┌─────────────────┐
│    暂存区       │ ← 准备提交的文件
│   (Staging)     │
└─────────────────┘
         │ git commit
         ▼
┌─────────────────┐
│    本地仓库      │ ← 已保存的版本历史
│  (Repository)   │
└─────────────────┘
         │ git push
         ▼
┌─────────────────┐
│    远程仓库      │ ← GitHub/GitLab等
│   (Remote)      │
└─────────────────┘
```

**💡 版本控制原理**
- **快照机制**：每次提交都是完整的项目快照，不是增量更新
- **分布式**：每个开发者都有完整的版本历史
- **分支管理**：可以同时维护多个开发线
- **内容寻址**：通过文件内容的哈希值来识别文件

---

## 2. ⚙️ Git仓库初始化与配置


### 2.1 安装后的首次配置


**🔧 基本身份配置**
```bash
# 设置用户名（必须）
git config --global user.name "你的姓名"

# 设置邮箱（必须）
git config --global user.email "your.email@example.com"

# 查看配置
git config --list
```

> 💡 **配置说明**：`--global`表示全局配置，所有项目都会使用。如果某个项目需要不同配置，可以在项目目录下运行不带`--global`的命令。

### 2.2 创建Git仓库


**方式一：从零开始创建**
```bash
# 1. 创建项目目录
mkdir my-project
cd my-project

# 2. 初始化Git仓库
git init

# 3. 创建第一个文件
echo "# 我的项目" > README.md

# 4. 添加到暂存区
git add README.md

# 5. 提交第一个版本
git commit -m "初始提交"
```

**方式二：克隆现有仓库**
```bash
# 从远程仓库克隆
git clone https://github.com/username/project.git

# 克隆到指定目录
git clone https://github.com/username/project.git my-local-name
```

### 2.3 仓库状态检查


**📊 常用状态命令**
```bash
# 查看仓库状态
git status

# 查看提交历史
git log

# 查看简洁历史
git log --oneline

# 查看分支情况
git branch
```

---

## 3. 🛠️ 基本操作命令


### 3.1 文件添加与提交


**📋 基本工作流程**
```
编辑文件 → git add → git commit → git push
   ↓         ↓         ↓         ↓
 工作目录   暂存区    本地仓库   远程仓库
```

**常用操作命令**
```bash
# 添加单个文件到暂存区
git add filename.txt

# 添加所有修改的文件
git add .

# 添加所有txt文件
git add *.txt

# 提交暂存区的文件
git commit -m "提交说明"

# 添加并提交（跳过暂存区）
git commit -am "提交说明"
```

**💡 提交消息规范**
```
feat: 新功能
fix: 修复bug
docs: 文档更新
style: 代码格式调整
refactor: 重构代码
test: 测试相关
chore: 构建工具或辅助工具的变动

示例：
git commit -m "feat: 添加用户登录功能"
git commit -m "fix: 修复密码验证bug"
```

### 3.2 文件状态管理


**📊 文件状态类型**

| 状态 | **说明** | **解决方法** |
|------|----------|-------------|
| 🟢 **已跟踪** | `文件已被Git管理` | `正常状态` |
| 🟡 **已修改** | `文件有变更但未暂存` | `git add 文件名` |
| 🔵 **已暂存** | `文件在暂存区等待提交` | `git commit` |
| 🔴 **未跟踪** | `新文件未被Git管理` | `git add 文件名` |

**撤销操作**
```bash
# 撤销工作目录的修改
git checkout -- filename.txt

# 撤销暂存区的文件（保留工作目录修改）
git reset HEAD filename.txt

# 撤销最后一次提交（保留修改）
git reset --soft HEAD~1

# 完全撤销最后一次提交
git reset --hard HEAD~1
```

### 3.3 推拉操作


**🔄 与远程仓库同步**
```bash
# 推送到远程仓库
git push origin main

# 从远程仓库拉取更新
git pull origin main

# 获取远程更新但不合并
git fetch origin

# 查看远程仓库信息
git remote -v
```

**推拉操作流程图**
```
本地仓库                    远程仓库
    │                         │
    │ ──── git push ────────→ │  推送本地提交
    │                         │
    │ ←──── git pull ──────── │  拉取远程更新
    │                         │
    │ ←──── git fetch ─────── │  仅获取不合并
```

---

## 4. 🌳 分支管理与合并策略


### 4.1 分支概念理解


**🌿 分支的作用**
```
主分支 (main)：    A───B───C───F───G
                           │       │
开发分支 (dev)：            D───E───┘
                           │
功能分支 (feature)：        H───I

说明：
- 主分支：稳定的生产代码
- 开发分支：日常开发工作
- 功能分支：独立功能开发
```

> 💡 **分支理解**：分支就像是平行世界，你可以在一个分支上做实验，不影响主分支的代码。完成后再合并回主分支。

### 4.2 分支基本操作


**🔧 分支管理命令**
```bash
# 查看所有分支
git branch

# 创建新分支
git branch feature-login

# 切换到分支
git checkout feature-login

# 创建并切换到新分支（常用）
git checkout -b feature-login

# 删除分支
git branch -d feature-login

# 强制删除分支
git branch -D feature-login
```

**分支工作流程**
```bash
# 1. 从主分支创建功能分支
git checkout main
git checkout -b feature-user-auth

# 2. 在功能分支上开发
echo "用户认证代码" > auth.js
git add auth.js
git commit -m "feat: 添加用户认证功能"

# 3. 切换回主分支
git checkout main

# 4. 合并功能分支
git merge feature-user-auth

# 5. 删除已合并的分支
git branch -d feature-user-auth
```

### 4.3 合并策略详解


**📊 合并方式对比**

| 合并方式 | **特点** | **使用场景** | **命令** |
|----------|----------|-------------|----------|
| 🔄 **Fast-forward** | `直接移动指针，无合并提交` | `线性历史，无冲突` | `git merge branch` |
| 🔀 **三方合并** | `创建合并提交` | `有分叉历史` | `git merge branch` |
| 📝 **Squash合并** | `压缩多个提交为一个` | `保持历史清洁` | `git merge --squash branch` |
| 🔄 **Rebase合并** | `重新应用提交，保持线性` | `保持提交历史整洁` | `git rebase main` |

**合并策略示例**
```bash
# 普通合并（保留分支历史）
git merge feature-branch

# 压缩合并（压缩为一个提交）
git merge --squash feature-branch

# 变基合并（重写提交历史）
git checkout feature-branch
git rebase main
git checkout main
git merge feature-branch
```

---

## 5. 🌐 远程仓库操作


### 5.1 远程仓库概念


**🔗 远程仓库的作用**
- **代码备份**：防止本地代码丢失
- **团队协作**：多人共享代码
- **版本同步**：保持代码一致性
- **代码托管**：GitHub、GitLab等平台

**远程仓库结构图**
```
开发者A电脑           远程仓库           开发者B电脑
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  本地仓库    │ ←→  │  GitHub仓库  │ ←→  │  本地仓库    │
│             │ push│             │pull │             │
│  代码版本1   │ ──→ │  代码版本1   │ ←── │  代码版本1   │
│  代码版本2   │ ──→ │  代码版本2   │ ←── │  代码版本2   │
└─────────────┘     └─────────────┘     └─────────────┘
```

### 5.2 添加远程仓库


**🔧 远程仓库配置**
```bash
# 添加远程仓库
git remote add origin https://github.com/username/repo.git

# 查看远程仓库
git remote -v

# 修改远程仓库地址
git remote set-url origin https://github.com/username/new-repo.git

# 删除远程仓库
git remote remove origin
```

**首次推送设置**
```bash
# 推送并设置上游分支
git push -u origin main

# 之后只需要
git push
```

### 5.3 多人协作流程


**👥 团队协作工作流**
```
1. 克隆项目：       git clone <repository>
2. 创建功能分支：   git checkout -b feature/new-feature
3. 开发功能：       编写代码 → git add → git commit
4. 推送分支：       git push origin feature/new-feature
5. 创建Pull Request（GitHub）或Merge Request（GitLab）
6. 代码审查：       团队成员review代码
7. 合并主分支：     通过审查后合并
8. 同步主分支：     git checkout main → git pull origin main
```

**协作注意事项**
> ⚠️ **重要提醒**：
> - 推送前先拉取：`git pull origin main`
> - 不要直接在main分支开发
> - 及时同步远程更新避免冲突
> - 提交信息要清晰明确

---

## 6. 🔧 冲突解决方法


### 6.1 冲突产生原因


**💥 什么是Git冲突？**
当两个人修改了同一个文件的同一部分，Git无法自动决定使用哪个版本，就会产生冲突。

**冲突场景示例**
```
开发者A修改：
function login() {
    return "用户登录A版本";
}

开发者B同时修改：
function login() {
    return "用户登录B版本";
}

Git不知道要保留哪个版本！
```

### 6.2 冲突标记解读


**📋 冲突文件内容**
```javascript
function login() {
<<<<<<< HEAD
    return "用户登录A版本";  // 当前分支的内容
=======
    return "用户登录B版本";  // 要合并分支的内容
>>>>>>> feature-branch
}
```

**冲突标记说明**
- `<<<<<<< HEAD`：当前分支的内容开始
- `=======`：分隔线
- `>>>>>>> branch-name`：要合并分支的内容结束

### 6.3 冲突解决步骤


**🛠️ 解决冲突流程**
```bash
# 1. 拉取最新代码时发现冲突
git pull origin main
# Auto-merging login.js
# CONFLICT (content): Merge conflict in login.js

# 2. 查看冲突文件
git status
# Unmerged paths:
#   both modified:   login.js

# 3. 手动编辑冲突文件
# 删除冲突标记，保留需要的内容

# 4. 标记冲突已解决
git add login.js

# 5. 完成合并
git commit -m "解决登录功能合并冲突"
```

**冲突解决示例**
```javascript
// 冲突前：
function login() {
<<<<<<< HEAD
    return "用户登录A版本";
=======
    return "用户登录B版本";
>>>>>>> feature-branch
}

// 解决后：
function login() {
    return "用户登录最终版本";  // 手动合并两个版本
}
```

**🎯 冲突解决技巧**
- **仔细分析**：理解两个版本的差异
- **沟通确认**：与其他开发者讨论最佳方案
- **测试验证**：解决后要测试功能是否正常
- **及时提交**：解决冲突后立即提交

---

## 7. 🏷️ 标签管理与版本发布


### 7.1 标签概念理解


**🎯 什么是Git标签？**
标签就像是给特定的提交贴一个"标签纸"，通常用来标记重要的版本发布点。

```
提交历史：   A───B───C───D───E───F
标签：               v1.0   v1.1   v2.0

说明：
- v1.0：第一个稳定版本
- v1.1：小版本更新
- v2.0：大版本升级
```

**📊 标签类型对比**

| 标签类型 | **特点** | **使用场景** | **命令示例** |
|----------|----------|-------------|-------------|
| 🏷️ **轻量标签** | `仅指向提交的指针` | `临时标记` | `git tag v1.0` |
| 📝 **附注标签** | `包含详细信息的对象` | `正式发布` | `git tag -a v1.0 -m "版本1.0"` |

### 7.2 标签基本操作


**🔧 标签管理命令**
```bash
# 创建轻量标签
git tag v1.0

# 创建附注标签（推荐）
git tag -a v1.0.0 -m "第一个正式版本"

# 查看所有标签
git tag

# 查看标签详细信息
git show v1.0.0

# 给特定提交打标签
git tag -a v0.9 -m "beta版本" 9fceb02

# 删除标签
git tag -d v1.0

# 推送标签到远程
git push origin v1.0.0

# 推送所有标签
git push origin --tags
```

### 7.3 版本发布流程


**🚀 版本发布最佳实践**
```bash
# 1. 确保代码稳定
git checkout main
git pull origin main

# 2. 创建发布标签
git tag -a v1.2.0 -m "版本1.2.0：添加用户管理功能"

# 3. 推送标签
git push origin v1.2.0

# 4. 在GitHub创建Release
# - 选择标签
# - 编写发布说明
# - 上传相关文件
```

**版本号规范（语义化版本）**
```
版本格式：主版本号.次版本号.修订号 (MAJOR.MINOR.PATCH)

v1.2.3 的含义：
- 主版本号1：不兼容的API修改
- 次版本号2：向下兼容的功能性新增
- 修订号3：向下兼容的问题修正

示例：
v1.0.0 → v1.0.1 (bug修复)
v1.0.1 → v1.1.0 (新功能)
v1.1.0 → v2.0.0 (重大更新)
```

---

## 8. 📋 gitignore文件配置


### 8.1 gitignore作用理解


**🚫 为什么需要gitignore？**
有些文件不应该被Git管理，比如：
- **编译产物**：可以重新生成的文件
- **敏感信息**：密码、密钥等
- **临时文件**：日志、缓存等
- **系统文件**：操作系统生成的文件

**忽略文件示例**
```
不需要管理的文件：
├── node_modules/     # 依赖包（可重新安装）
├── .env             # 环境变量（包含密码）
├── *.log            # 日志文件
├── dist/            # 构建产物
└── .DS_Store        # macOS系统文件
```

### 8.2 gitignore规则语法


**📝 匹配规则详解**
```bash
# 注释
# 这是注释内容

# 忽略具体文件
secret.txt

# 忽略所有txt文件
*.txt

# 忽略目录
node_modules/
logs/

# 忽略某个目录下的文件
build/*.js

# 不忽略某个文件（例外规则）
!important.txt

# 忽略根目录下的文件
/README.md

# 忽略所有目录下的某类文件
**/*.log
```

### 8.3 常见项目gitignore配置


**🛠️ Node.js项目示例**
```bash
# 依赖包
node_modules/
npm-debug.log*

# 构建产物
dist/
build/

# 环境配置
.env
.env.local

# 编辑器配置
.vscode/
.idea/

# 系统文件
.DS_Store
Thumbs.db

# 日志文件
*.log
logs/
```

**🖥️ Java项目示例**
```bash
# 编译产物
*.class
*.jar
*.war
target/

# IDE文件
.idea/
*.iml
.eclipse/

# 构建工具
.gradle/
build/

# 系统文件
.DS_Store
```

**⚙️ Python项目示例**
```bash
# 字节码
__pycache__/
*.pyc
*.pyo

# 虚拟环境
venv/
env/

# 包文件
*.egg-info/
dist/

# Jupyter
.ipynb_checkpoints/
```

**🔧 配置gitignore的技巧**
```bash
# 1. 在项目根目录创建.gitignore文件
touch .gitignore

# 2. 如果文件已被跟踪，需要先移除
git rm --cached filename

# 3. 使用在线生成器
# 访问 gitignore.io 生成模板

# 4. 查看忽略状态
git status --ignored
```

> 💡 **最佳实践**：在项目开始时就配置好.gitignore，避免错误提交不需要的文件。

---

## 9. 📋 核心要点总结


### 9.1 必须掌握的基本概念


```
🔸 Git本质：分布式版本控制系统，通过快照管理代码历史
🔸 工作流程：工作目录 → 暂存区 → 本地仓库 → 远程仓库
🔸 基本命令：add、commit、push、pull是日常必用命令
🔸 分支概念：并行开发线，主分支保持稳定，功能分支独立开发
🔸 冲突处理：理解冲突原因，掌握手动解决方法
🔸 标签版本：重要节点标记，规范版本发布流程
🔸 文件过滤：合理配置gitignore，避免提交不必要文件
```

### 9.2 日常使用流程


**🔄 个人开发流程**
```
1. 初始化项目：     git init → 配置 → 首次提交
2. 日常开发：       编辑 → git add → git commit
3. 备份同步：       git push → git pull
4. 版本发布：       git tag → 创建release
```

**👥 团队协作流程**
```
1. 获取项目：       git clone → 配置本地环境
2. 功能开发：       创建分支 → 开发 → 提交 → 推送
3. 代码审查：       创建PR/MR → 团队review
4. 合并主线：       merge → 同步主分支
```

### 9.3 实用技巧总结


**⚡ 效率提升技巧**
- **别名设置**：`git config --global alias.st status`
- **自动完成**：配置shell的Git自动完成
- **图形界面**：使用SourceTree、GitKraken等GUI工具
- **命令组合**：`git add . && git commit -m "message"`

**🛡️ 安全注意事项**
- **敏感信息**：永远不要提交密码、密钥到Git
- **提交前检查**：使用`git status`和`git diff`确认修改
- **备份重要分支**：重要功能分支推送到远程备份
- **定期同步**：及时pull最新代码避免大冲突

**📚 学习进阶路径**
```
基础命令掌握 → 分支管理熟练 → 冲突解决能力 → 团队协作规范
      ↓              ↓              ↓              ↓
  日常开发够用    独立功能开发     处理复杂场景     专业团队开发
```

### 9.4 常见问题解决


**❓ 新手常见问题**
- **忘记提交信息**：`git commit --amend -m "新的提交信息"`
- **提交错误文件**：`git reset HEAD~1` 然后重新提交
- **分支名打错**：`git branch -m old-name new-name`
- **忘记切分支**：`git stash` → 切换分支 → `git stash pop`

**核心记忆要点**：
- Git是给代码拍照的工具，每次提交都是完整快照
- 分支就像平行世界，可以安全试验不影响主线
- 冲突不可怕，理解标记含义就能轻松解决
- 团队协作要遵循规范，分支开发、审查合并