---
title: 15ã€ä¼ä¸šä»“åº“æ­å»ºå®è·µ
---
## ğŸ“š ç›®å½•

1. [ç§æœ‰ä»“åº“æœåŠ¡å™¨æ­å»º](#1-ç§æœ‰ä»“åº“æœåŠ¡å™¨æ­å»º)
2. [WebæœåŠ¡é…ç½®ä¸ä¼˜åŒ–](#2-WebæœåŠ¡é…ç½®ä¸ä¼˜åŒ–)
3. [ä»“åº“åŒæ­¥ç­–ç•¥](#3-ä»“åº“åŒæ­¥ç­–ç•¥)
4. [åˆ†å±‚æ¶æ„è®¾è®¡](#4-åˆ†å±‚æ¶æ„è®¾è®¡)
5. [è®¿é—®æ§åˆ¶ä¸è®¤è¯](#5-è®¿é—®æ§åˆ¶ä¸è®¤è¯)
6. [é«˜å¯ç”¨é…ç½®](#6-é«˜å¯ç”¨é…ç½®)
7. [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#7-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
8. [ç›‘æ§ä¸è¿ç»´ç®¡ç†](#8-ç›‘æ§ä¸è¿ç»´ç®¡ç†)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ—ï¸ ç§æœ‰ä»“åº“æœåŠ¡å™¨æ­å»º


### 1.1 ç§æœ‰ä»“åº“çš„æ ¸å¿ƒæ¦‚å¿µ


**ä»€ä¹ˆæ˜¯ç§æœ‰ä»“åº“ï¼Ÿ**
ç§æœ‰ä»“åº“å°±åƒä¼ä¸šå†…éƒ¨çš„"è½¯ä»¶è¶…å¸‚"ï¼Œä¸“é—¨å­˜æ”¾å’Œåˆ†å‘è½¯ä»¶åŒ…ã€‚ä¸å…¬ç½‘ä»“åº“ä¸åŒï¼Œå®ƒå®Œå…¨ç”±ä¼ä¸šè‡ªå·±æ§åˆ¶ï¼Œå¯ä»¥å†³å®šæ”¾ä»€ä¹ˆè½¯ä»¶ã€è°èƒ½ä¸‹è½½ã€æ€ä¹ˆç®¡ç†ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦ç§æœ‰ä»“åº“ï¼Ÿ**
```
ä¼ä¸šåœºæ™¯åˆ†æï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¼€å‘ç¯å¢ƒ       â”‚    â”‚  ç”Ÿäº§ç¯å¢ƒ       â”‚
â”‚  éœ€è¦æµ‹è¯•åŒ…     â”‚    â”‚  éœ€è¦ç¨³å®šç‰ˆæœ¬   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æµ‹è¯•ç¯å¢ƒ       â”‚    â”‚  å¤‡ä»½ç¯å¢ƒ       â”‚ 
â”‚  éœ€è¦ç‰¹å®šç‰ˆæœ¬   â”‚    â”‚  éœ€è¦ç¦»çº¿éƒ¨ç½²   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“                    â†“
         ç»Ÿä¸€ç®¡ç† â†’ ç§æœ‰ä»“åº“æœåŠ¡å™¨
```

> ğŸ’¡ **æ ¸å¿ƒä»·å€¼**ï¼š
> - **å®‰å…¨å¯æ§**ï¼šæ•æ„Ÿè½¯ä»¶ä¸å‡ºä¼ä¸šç½‘ç»œ
> - **ç‰ˆæœ¬ç»Ÿä¸€**ï¼šç¡®ä¿æ‰€æœ‰ç¯å¢ƒä½¿ç”¨ç›¸åŒç‰ˆæœ¬
> - **ç½‘ç»œä¼˜åŒ–**ï¼šå†…ç½‘è®¿é—®é€Ÿåº¦å¿«ï¼ŒèŠ‚çœå¸¦å®½
> - **ç¦»çº¿éƒ¨ç½²**ï¼šæ”¯æŒæ— å¤–ç½‘ç¯å¢ƒçš„è½¯ä»¶å®‰è£…

### 1.2 ä»“åº“æœåŠ¡å™¨ç¡¬ä»¶è§„åˆ’


**æœåŠ¡å™¨é…ç½®å»ºè®®**

| è§„æ¨¡ç±»å‹ | **æœåŠ¡å™¨æ•°é‡** | **CPU** | **å†…å­˜** | **å­˜å‚¨** | **ç½‘ç»œ** |
|---------|---------------|---------|----------|----------|----------|
| ğŸŸ¢ **å°å‹ä¼ä¸š** | `1å°` | `4æ ¸` | `8GB` | `500GB SSD` | `åƒå…†ç½‘å¡` |
| ğŸŸ¡ **ä¸­å‹ä¼ä¸š** | `2-3å°` | `8æ ¸` | `16GB` | `2TB SSD + 4TB HDD` | `ä¸‡å…†ç½‘å¡` |
| ğŸ”´ **å¤§å‹ä¼ä¸š** | `5+å°` | `16æ ¸` | `32GB` | `å¤šå—SSD + å­˜å‚¨é˜µåˆ—` | `ä¸‡å…†ç½‘å¡+å†—ä½™` |

**å­˜å‚¨è§„åˆ’è¯´æ˜**
```
å­˜å‚¨åˆ†å±‚ç­–ç•¥ï¼š
â”œâ”€â”€ SSDå­˜å‚¨ (çƒ­æ•°æ®)
â”‚   â”œâ”€â”€ å¸¸ç”¨è½¯ä»¶åŒ…      (80%è®¿é—®é¢‘ç‡)
â”‚   â”œâ”€â”€ ç³»ç»Ÿå…³é”®åŒ…      (é«˜ä¼˜å…ˆçº§)
â”‚   â””â”€â”€ ç´¢å¼•æ•°æ®åº“      (å¿«é€Ÿæ£€ç´¢)
â”‚
â””â”€â”€ HDDå­˜å‚¨ (å†·æ•°æ®)
    â”œâ”€â”€ å†å²ç‰ˆæœ¬åŒ…      (å¤‡ä»½å½’æ¡£)
    â”œâ”€â”€ å¤§å‹è½¯ä»¶åŒ…      (å¦‚å¼€å‘å·¥å…·)
    â””â”€â”€ æ—¥å¿—æ–‡ä»¶       (è¿ç»´æ•°æ®)
```

### 1.3 åŸºç¡€ç¯å¢ƒå‡†å¤‡


**ç³»ç»Ÿè¦æ±‚æ£€æŸ¥**
```bash
# æ£€æŸ¥ç³»ç»Ÿç‰ˆæœ¬
cat /etc/redhat-release

# æ£€æŸ¥ç£ç›˜ç©ºé—´ï¼ˆè‡³å°‘500GBå¯ç”¨ï¼‰
df -h /

# æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
ping -c 3 mirrors.aliyun.com

# æ£€æŸ¥SELinuxçŠ¶æ€
getenforce
```

**åˆ›å»ºä»“åº“ç›®å½•ç»“æ„**
```bash
# åˆ›å»ºä»“åº“æ ¹ç›®å½•
mkdir -p /var/www/repos/{centos,rhel,epel}/{7,8,9}/x86_64

# åˆ›å»ºæ—¥å¿—ç›®å½•
mkdir -p /var/log/repo-sync

# è®¾ç½®åˆé€‚çš„æƒé™
chown -R apache:apache /var/www/repos
chmod -R 755 /var/www/repos
```

**ç›®å½•ç»“æ„è¯´æ˜**
```
/var/www/repos/                    â† ä»“åº“æ ¹ç›®å½•
â”œâ”€â”€ centos/                        â† CentOSä»“åº“
â”‚   â”œâ”€â”€ 7/x86_64/                  â† CentOS 7 64ä½
â”‚   â”œâ”€â”€ 8/x86_64/                  â† CentOS 8 64ä½  
â”‚   â””â”€â”€ 9/x86_64/                  â† CentOS 9 64ä½
â”œâ”€â”€ rhel/                          â† Red Hatä¼ä¸šç‰ˆ
â”‚   â”œâ”€â”€ 7/x86_64/
â”‚   â”œâ”€â”€ 8/x86_64/
â”‚   â””â”€â”€ 9/x86_64/
â””â”€â”€ epel/                          â† æ‰©å±•åŒ…ä»“åº“
    â”œâ”€â”€ 7/x86_64/
    â”œâ”€â”€ 8/x86_64/
    â””â”€â”€ 9/x86_64/
```

---

## 2. ğŸŒ WebæœåŠ¡é…ç½®ä¸ä¼˜åŒ–


### 2.1 Apache HTTP Serveré…ç½®


**å®‰è£…å’ŒåŸºç¡€é…ç½®**
```bash
# å®‰è£…Apache
yum install -y httpd

# å¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯
systemctl enable httpd
systemctl start httpd
```

**Apacheä»“åº“ç«™ç‚¹é…ç½®**
```apache
# /etc/httpd/conf.d/repos.conf
<VirtualHost *:80>
    ServerName repo.company.com
    DocumentRoot /var/www/repos
    
    # å¯ç”¨ç›®å½•æµè§ˆ
    <Directory "/var/www/repos">
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted
        
        # è‡ªå®šä¹‰ç›®å½•é¡µé¢æ ·å¼
        IndexOptions FancyIndexing HTMLTable VersionSort
        IndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t
    </Directory>
    
    # æ—¥å¿—é…ç½®
    CustomLog /var/log/httpd/repos_access.log combined
    ErrorLog /var/log/httpd/repos_error.log
</VirtualHost>
```

> âš ï¸ **æ³¨æ„**ï¼š`Options Indexes`å…è®¸æµè§ˆå™¨æŸ¥çœ‹ç›®å½•å†…å®¹ï¼Œè¿™å¯¹ä»“åº“å¾ˆé‡è¦ï¼Œç”¨æˆ·å¯ä»¥ç›´æ¥æµè§ˆå¯ç”¨çš„è½¯ä»¶åŒ…ã€‚

### 2.2 Nginxé…ç½®æ–¹æ¡ˆ


**ä¸ºä»€ä¹ˆé€‰æ‹©Nginxï¼Ÿ**
- **æ€§èƒ½æ›´å¥½**ï¼šå¤„ç†é™æ€æ–‡ä»¶èƒ½åŠ›å¼º
- **å†…å­˜å ç”¨å°‘**ï¼šé€‚åˆå¤§é‡å¹¶å‘è®¿é—®
- **é…ç½®çµæ´»**ï¼šæ”¯æŒè´Ÿè½½å‡è¡¡å’Œç¼“å­˜

**Nginxå®‰è£…ä¸é…ç½®**
```bash
# å®‰è£…Nginx
yum install -y nginx

# åˆ›å»ºä»“åº“ç«™ç‚¹é…ç½®
cat > /etc/nginx/conf.d/repos.conf << 'EOF'
server {
    listen 80;
    server_name repo.company.com;
    root /var/www/repos;
    
    # å¯ç”¨ç›®å½•æµè§ˆ
    location / {
        autoindex on;                    # æ˜¾ç¤ºç›®å½•åˆ—è¡¨
        autoindex_exact_size off;        # æ˜¾ç¤ºæ–‡ä»¶å¤§å°(KB/MB)
        autoindex_localtime on;          # æ˜¾ç¤ºæœ¬åœ°æ—¶é—´
        
        # è®¾ç½®ç¼“å­˜ç­–ç•¥
        expires 1d;
        add_header Cache-Control "public, immutable";
    }
    
    # RPMåŒ…ç‰¹æ®Šå¤„ç†
    location ~* \.(rpm|deb)$ {
        expires 7d;
        add_header Cache-Control "public, immutable";
    }
    
    # ä»“åº“å…ƒæ•°æ®ç¼“å­˜
    location ~* \.(xml|gz|bz2)$ {
        expires 1h;
        add_header Cache-Control "public";
    }
    
    # è®¿é—®æ—¥å¿—
    access_log /var/log/nginx/repos_access.log;
    error_log /var/log/nginx/repos_error.log;
}
EOF
```

**é…ç½®è¯´æ˜è§£æ**
- **autoindex on**ï¼šè®©æµè§ˆå™¨å¯ä»¥çœ‹åˆ°ç›®å½•å†…å®¹ï¼Œç”¨æˆ·èƒ½æµè§ˆæ‰€æœ‰å¯ç”¨è½¯ä»¶åŒ…
- **expiresè®¾ç½®**ï¼šå‘Šè¯‰å®¢æˆ·ç«¯å¤šä¹…ç¼“å­˜æ–‡ä»¶ï¼Œå‡å°‘é‡å¤ä¸‹è½½
- **ä¸åŒæ–‡ä»¶ç±»å‹**ï¼šRPMåŒ…ç¼“å­˜7å¤©ï¼Œå…ƒæ•°æ®ç¼“å­˜1å°æ—¶

### 2.3 æ€§èƒ½ä¼˜åŒ–é…ç½®


**Apacheæ€§èƒ½è°ƒä¼˜**
```apache
# /etc/httpd/conf.d/performance.conf
# å¯ç”¨å‹ç¼©ä¼ è¾“
LoadModule deflate_module modules/mod_deflate.so
<Location />
    SetOutputFilter DEFLATE
    SetEnvIfNoCase Request_URI \
        \.(?:gif|jpe?g|png|rpm|deb)$ no-gzip dont-vary
</Location>

# é™æ€æ–‡ä»¶ç¼“å­˜
<LocationMatch "\.(css|js|png|jpg|jpeg|gif|ico|svg)$">
    ExpiresActive On
    ExpiresDefault "access plus 1 month"
</LocationMatch>
```

**Nginxæ€§èƒ½è°ƒä¼˜**
```nginx
# åœ¨httpå—ä¸­æ·»åŠ 
gzip on;
gzip_vary on;
gzip_min_length 1024;
gzip_types text/plain text/css text/xml text/javascript 
           application/javascript application/xml+rss 
           application/json;

# workerè¿›ç¨‹ä¼˜åŒ–
worker_processes auto;
worker_connections 1024;

# æ–‡ä»¶ç¼“å­˜
open_file_cache max=1000 inactive=20s;
open_file_cache_valid 30s;
```

---

## 3. ğŸ”„ ä»“åº“åŒæ­¥ç­–ç•¥


### 3.1 rsyncåŒæ­¥å·¥å…·è¯¦è§£


**ä»€ä¹ˆæ˜¯rsyncï¼Ÿ**
rsyncæ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ–‡ä»¶åŒæ­¥å·¥å…·ï¼Œå°±åƒ"æ™ºèƒ½å¤åˆ¶"ï¼Œå®ƒåªä¼ è¾“å˜åŒ–çš„éƒ¨åˆ†ï¼Œå¤§å¤§æé«˜äº†åŒæ­¥æ•ˆç‡ã€‚

**rsyncå·¥ä½œåŸç†**
```
åŸå§‹ä»“åº“                    æœ¬åœ°ä»“åº“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ file1.rpm   â”‚  æ¯”å¯¹å·®å¼‚   â”‚ file1.rpm   â”‚
â”‚ file2.rpm   â”‚ ---------> â”‚ (æ—§ç‰ˆæœ¬)     â”‚
â”‚ file3.rpm   â”‚  åªä¼ è¾“     â”‚             â”‚
â”‚ (æ–°å¢æ–‡ä»¶)   â”‚  å˜åŒ–éƒ¨åˆ†   â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 åŸºç¡€åŒæ­¥é…ç½®


**CentOSå®˜æ–¹ä»“åº“åŒæ­¥**
```bash
#!/bin/bash
# /usr/local/bin/sync-centos.sh

# åŒæ­¥é…ç½®
RSYNC_OPTS="-avSH --delete --progress"
SOURCE_MIRROR="rsync://mirrors.aliyun.com/centos/"
LOCAL_REPO="/var/www/repos/centos/"

echo "å¼€å§‹åŒæ­¥ CentOS ä»“åº“ - $(date)"

# åŒæ­¥CentOS 7
rsync $RSYNC_OPTS \
      --exclude="*.iso" \
      --exclude="LiveOS/" \
      ${SOURCE_MIRROR}7/ ${LOCAL_REPO}7/

# åŒæ­¥CentOS 8
rsync $RSYNC_OPTS \
      --exclude="*.iso" \
      --exclude="LiveOS/" \
      ${SOURCE_MIRROR}8/ ${LOCAL_REPO}8/

echo "CentOS ä»“åº“åŒæ­¥å®Œæˆ - $(date)"
```

**å‚æ•°è¯´æ˜**
- **-a**ï¼šå½’æ¡£æ¨¡å¼ï¼Œä¿æŒæ–‡ä»¶å±æ€§
- **-v**ï¼šæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯  
- **-S**ï¼šå¤„ç†ç¨€ç–æ–‡ä»¶
- **-H**ï¼šä¿æŒç¡¬é“¾æ¥
- **--delete**ï¼šåˆ é™¤ç›®æ ‡ä¸­å¤šä½™æ–‡ä»¶
- **--exclude**ï¼šæ’é™¤ä¸éœ€è¦çš„æ–‡ä»¶

### 3.3 å¢é‡åŒæ­¥ç­–ç•¥


**ä¸ºä»€ä¹ˆéœ€è¦å¢é‡åŒæ­¥ï¼Ÿ**
å®Œæ•´åŒæ­¥å¯èƒ½éœ€è¦å‡ åGBæ•°æ®ï¼Œè€Œå¢é‡åŒæ­¥åªä¼ è¾“å˜åŒ–éƒ¨åˆ†ï¼Œå¯èƒ½åªæœ‰å‡ ç™¾MBã€‚

**æ™ºèƒ½åŒæ­¥è„šæœ¬**
```bash
#!/bin/bash
# /usr/local/bin/smart-sync.sh

LOCK_FILE="/var/lock/repo-sync.lock"
LOG_FILE="/var/log/repo-sync/sync-$(date +%Y%m%d).log"

# é˜²æ­¢é‡å¤è¿è¡Œ
if [ -f "$LOCK_FILE" ]; then
    echo "åŒæ­¥å·²åœ¨è¿è¡Œä¸­..." | tee -a $LOG_FILE
    exit 1
fi

# åˆ›å»ºé”æ–‡ä»¶
touch $LOCK_FILE
trap 'rm -f $LOCK_FILE' EXIT

sync_repo() {
    local repo_name=$1
    local source_url=$2
    local local_path=$3
    
    echo "[$(date)] å¼€å§‹åŒæ­¥ $repo_name" | tee -a $LOG_FILE
    
    rsync -avSH --delete --progress \
          --timeout=300 \
          --exclude="*.iso" \
          "$source_url" "$local_path" 2>&1 | tee -a $LOG_FILE
    
    if [ $? -eq 0 ]; then
        echo "[$(date)] $repo_name åŒæ­¥æˆåŠŸ" | tee -a $LOG_FILE
    else
        echo "[$(date)] $repo_name åŒæ­¥å¤±è´¥" | tee -a $LOG_FILE
        return 1
    fi
}

# æ‰§è¡ŒåŒæ­¥
sync_repo "CentOS-7" "rsync://mirrors.aliyun.com/centos/7/" "/var/www/repos/centos/7/"
sync_repo "EPEL-7" "rsync://mirrors.aliyun.com/epel/7/" "/var/www/repos/epel/7/"
```

### 3.4 è‡ªåŠ¨åŒ–åŒæ­¥éƒ¨ç½²


**å®šæ—¶ä»»åŠ¡é…ç½®**
```bash
# ç¼–è¾‘å®šæ—¶ä»»åŠ¡
crontab -e

# æ·»åŠ ä»¥ä¸‹å†…å®¹
# æ¯å¤©å‡Œæ™¨2ç‚¹åŒæ­¥ä¸€æ¬¡
0 2 * * * /usr/local/bin/smart-sync.sh >/dev/null 2>&1

# æ¯å‘¨æ—¥å‡Œæ™¨1ç‚¹æ¸…ç†æ—¥å¿—
0 1 * * 0 find /var/log/repo-sync -name "*.log" -mtime +30 -delete
```

**åŒæ­¥çŠ¶æ€ç›‘æ§**
```bash
#!/bin/bash
# /usr/local/bin/sync-status.sh

check_sync_status() {
    local repo_path=$1
    local repo_name=$2
    
    if [ -d "$repo_path" ]; then
        local file_count=$(find "$repo_path" -name "*.rpm" | wc -l)
        local last_update=$(stat -c %Y "$repo_path" 2>/dev/null || echo 0)
        local update_time=$(date -d @$last_update '+%Y-%m-%d %H:%M:%S' 2>/dev/null || echo "æœªçŸ¥")
        
        echo "ğŸ“¦ $repo_name: $file_count ä¸ªåŒ…ï¼Œæœ€åæ›´æ–°: $update_time"
    else
        echo "âŒ $repo_name: ç›®å½•ä¸å­˜åœ¨"
    fi
}

echo "=== ä»“åº“åŒæ­¥çŠ¶æ€æ£€æŸ¥ ==="
check_sync_status "/var/www/repos/centos/7" "CentOS 7"
check_sync_status "/var/www/repos/centos/8" "CentOS 8" 
check_sync_status "/var/www/repos/epel/7" "EPEL 7"
```

---

## 4. ğŸ¢ åˆ†å±‚æ¶æ„è®¾è®¡


### 4.1 åˆ†å±‚æ¶æ„çš„å¿…è¦æ€§


**ä»€ä¹ˆæ˜¯åˆ†å±‚æ¶æ„ï¼Ÿ**
åˆ†å±‚æ¶æ„å°±åƒä¼ä¸šçš„ç»„ç»‡ç»“æ„ï¼Œä¸åŒå±‚çº§æ‰¿æ‹…ä¸åŒèŒè´£ï¼Œæ—¢ä¿è¯æ•ˆç‡åˆä¾¿äºç®¡ç†ã€‚

**ä¼ä¸šä»“åº“åˆ†å±‚æ¨¡å¼**
```
                    äº’è”ç½‘ä»“åº“æº
                         â”‚
                    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
                    â”‚ ä¸»ä»“åº“  â”‚ â† Tier 1 (ä¸­å¤®ä»“åº“)
                    â”‚ æœåŠ¡å™¨  â”‚
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                         â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚            â”‚            â”‚
      â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
      â”‚ åŒºåŸŸä»“åº“1 â”‚ â”‚åŒºåŸŸä»“åº“2â”‚ â”‚ åŒºåŸŸä»“åº“3â”‚ â† Tier 2 (åŒºåŸŸä»“åº“)
      â”‚(åŒ—äº¬æœºæˆ¿) â”‚ â”‚(ä¸Šæµ·æœºæˆ¿)â”‚ â”‚(å¹¿å·æœºæˆ¿) â”‚
      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
            â”‚           â”‚           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”   â”Œâ”€â”€â”´â”€â”€â”    â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚æœ¬åœ°ç¼“å­˜1  â”‚   â”‚æœ¬åœ° â”‚    â”‚ æœ¬åœ°   â”‚ â† Tier 3 (è¾¹ç¼˜ç¼“å­˜)
    â”‚          â”‚   â”‚ç¼“å­˜2â”‚    â”‚ ç¼“å­˜3  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ä¸»ä»“åº“æœåŠ¡å™¨é…ç½®


**ä¸»ä»“åº“èŒè´£**
- **å®Œæ•´åŒæ­¥**ï¼šä»å®˜æ–¹æºåŒæ­¥æ‰€æœ‰è½¯ä»¶åŒ…
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šç®¡ç†è½¯ä»¶åŒ…ç‰ˆæœ¬ç­–ç•¥
- **å®‰å…¨æ‰«æ**ï¼šæ£€æŸ¥è½¯ä»¶åŒ…å®‰å…¨æ€§
- **åˆ†å‘ç®¡ç†**ï¼šå‘ä¸‹çº§ä»“åº“æ¨é€æ›´æ–°

**ä¸»ä»“åº“é…ç½®ç¤ºä¾‹**
```bash
# ä¸»ä»“åº“ç›®å½•ç»“æ„
/data/master-repo/
â”œâ”€â”€ upstream/           # ä¸Šæ¸¸ä»“åº“é•œåƒ
â”‚   â”œâ”€â”€ centos/
â”‚   â”œâ”€â”€ epel/
â”‚   â””â”€â”€ rhel/
â”œâ”€â”€ staging/           # æµ‹è¯•ç¯å¢ƒä»“åº“  
â”‚   â”œâ”€â”€ centos/
â”‚   â””â”€â”€ epel/
â”œâ”€â”€ production/        # ç”Ÿäº§ç¯å¢ƒä»“åº“
â”‚   â”œâ”€â”€ centos/
â”‚   â””â”€â”€ epel/
â””â”€â”€ archive/          # å†å²ç‰ˆæœ¬å½’æ¡£
    â”œâ”€â”€ centos/
    â””â”€â”€ epel/
```

**ä¸»ä»“åº“åŒæ­¥è„šæœ¬**
```bash
#!/bin/bash
# /usr/local/bin/master-sync.sh

# é…ç½®å˜é‡
UPSTREAM_DIR="/data/master-repo/upstream"
STAGING_DIR="/data/master-repo/staging"
PRODUCTION_DIR="/data/master-repo/production"

# ç¬¬ä¸€æ­¥ï¼šä»å®˜æ–¹æºåŒæ­¥åˆ°upstream
sync_upstream() {
    echo "=== åŒæ­¥ä¸Šæ¸¸ä»“åº“ ==="
    rsync -avSH --delete \
          rsync://mirrors.aliyun.com/centos/7/ \
          $UPSTREAM_DIR/centos/7/
}

# ç¬¬äºŒæ­¥ï¼šä»upstreamæ¨é€åˆ°stagingæµ‹è¯•
push_to_staging() {
    echo "=== æ¨é€åˆ°æµ‹è¯•ç¯å¢ƒ ==="
    rsync -avSH --delete \
          $UPSTREAM_DIR/centos/7/ \
          $STAGING_DIR/centos/7/
}

# ç¬¬ä¸‰æ­¥ï¼šç»è¿‡éªŒè¯åæ¨é€åˆ°ç”Ÿäº§
push_to_production() {
    echo "=== æ¨é€åˆ°ç”Ÿäº§ç¯å¢ƒ ==="
    # è¿™é‡Œå¯ä»¥åŠ å…¥è‡ªåŠ¨åŒ–æµ‹è¯•
    if validate_staging; then
        rsync -avSH --delete \
              $STAGING_DIR/centos/7/ \
              $PRODUCTION_DIR/centos/7/
    fi
}
```

### 4.3 åŒºåŸŸä»“åº“é…ç½®


**åŒºåŸŸä»“åº“çš„ä½œç”¨**
åŒºåŸŸä»“åº“å°±åƒå„åœ°çš„"åˆ†å…¬å¸"ï¼Œä»æ€»éƒ¨è·å–è½¯ä»¶åŒ…ï¼Œä¸ºæœ¬åœ°ç”¨æˆ·æä¾›å¿«é€Ÿè®¿é—®ã€‚

**åŒºåŸŸä»“åº“è‡ªåŠ¨åŒæ­¥**
```bash
#!/bin/bash
# /usr/local/bin/regional-sync.sh

MASTER_REPO="rsync://master.company.com/repos/"
LOCAL_REPO="/var/www/repos/"
REGION="beijing"  # åŒºåŸŸæ ‡è¯†

sync_from_master() {
    local repo_type=$1
    
    echo "[$REGION] ä»ä¸»ä»“åº“åŒæ­¥ $repo_type"
    
    rsync -avSH --delete \
          --timeout=600 \
          --exclude="*.tmp" \
          "${MASTER_REPO}production/${repo_type}/" \
          "${LOCAL_REPO}${repo_type}/" 2>&1 | \
    tee -a "/var/log/repo-sync/regional-$(date +%Y%m%d).log"
}

# åŒæ­¥å„ç±»ä»“åº“
sync_from_master "centos"
sync_from_master "epel"

# æ›´æ–°ä»“åº“å…ƒæ•°æ®
createrepo --update $LOCAL_REPO
```

### 4.4 æ™ºèƒ½è·¯ç”±ç­–ç•¥


**ç”¨æˆ·è®¿é—®æ™ºèƒ½è·¯ç”±**
```nginx
# /etc/nginx/conf.d/smart-routing.conf
upstream master_repo {
    server master.company.com:80 weight=1 max_fails=3 fail_timeout=30s;
}

upstream regional_repos {
    server beijing.repo.company.com:80 weight=5 max_fails=2 fail_timeout=10s;
    server shanghai.repo.company.com:80 weight=3 max_fails=2 fail_timeout=10s;
    server guangzhou.repo.company.com:80 weight=2 max_fails=2 fail_timeout=10s;
}

server {
    listen 80;
    server_name repo.company.com;
    
    # æ ¹æ®å®¢æˆ·ç«¯IPæ™ºèƒ½è·¯ç”±
    location / {
        # ä¼˜å…ˆä½¿ç”¨åŒºåŸŸä»“åº“
        proxy_pass http://regional_repos;
        proxy_next_upstream error timeout invalid_header http_500 http_502 http_503;
        
        # åŒºåŸŸä»“åº“éƒ½å¤±è´¥æ—¶ä½¿ç”¨ä¸»ä»“åº“
        proxy_next_upstream_tries 3;
        proxy_next_upstream_timeout 30s;
    }
    
    # å¥åº·æ£€æŸ¥
    location /health {
        access_log off;
        return 200 "OK\n";
        add_header Content-Type text/plain;
    }
}
```

---

## 5. ğŸ” è®¿é—®æ§åˆ¶ä¸è®¤è¯


### 5.1 åŸºç¡€è®¿é—®æ§åˆ¶


**ä¸ºä»€ä¹ˆéœ€è¦è®¿é—®æ§åˆ¶ï¼Ÿ**
ä¼ä¸šä»“åº“å¯èƒ½åŒ…å«ï¼š
- **å•†ä¸šè½¯ä»¶**ï¼šéœ€è¦è®¸å¯è¯çš„è½¯ä»¶
- **å†…éƒ¨å·¥å…·**ï¼šä¼ä¸šè‡ªç ”è½¯ä»¶åŒ…
- **æ•æ„Ÿç»„ä»¶**ï¼šå®‰å…¨ç›¸å…³çš„è½¯ä»¶
- **æµ‹è¯•ç‰ˆæœ¬**ï¼šæœªç»å……åˆ†éªŒè¯çš„è½¯ä»¶

**ApacheåŸºç¡€è®¤è¯é…ç½®**
```apache
# /etc/httpd/conf.d/repos-auth.conf
<VirtualHost *:80>
    ServerName repo.company.com
    DocumentRoot /var/www/repos
    
    # å…¬å…±ä»“åº“åŒºåŸŸï¼ˆæ— éœ€è®¤è¯ï¼‰
    <Directory "/var/www/repos/public">
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted
    </Directory>
    
    # å†…éƒ¨ä»“åº“åŒºåŸŸï¼ˆéœ€è¦è®¤è¯ï¼‰
    <Directory "/var/www/repos/internal">
        Options Indexes FollowSymLinks
        AllowOverride None
        
        AuthType Basic
        AuthName "Internal Repository Access"
        AuthUserFile /etc/httpd/conf.d/.htpasswd
        Require valid-user
    </Directory>
    
    # å¼€å‘æµ‹è¯•åŒºåŸŸï¼ˆä»…å¼€å‘äººå‘˜ï¼‰
    <Directory "/var/www/repos/dev">
        Options Indexes FollowSymLinks
        AllowOverride None
        
        AuthType Basic
        AuthName "Development Repository"
        AuthUserFile /etc/httpd/conf.d/.htpasswd
        Require group developers
    </Directory>
</VirtualHost>
```

**åˆ›å»ºè®¤è¯ç”¨æˆ·**
```bash
# åˆ›å»ºè®¤è¯æ–‡ä»¶
htpasswd -c /etc/httpd/conf.d/.htpasswd admin
htpasswd /etc/httpd/conf.d/.htpasswd developer1
htpasswd /etc/httpd/conf.d/.htpasswd tester1

# åˆ›å»ºç»„æ–‡ä»¶
cat > /etc/httpd/conf.d/.htgroup << EOF
developers: developer1 developer2
testers: tester1 tester2
admins: admin
EOF
```

### 5.2 IPåœ°å€è®¿é—®æ§åˆ¶


**åŸºäºç½‘ç»œçš„è®¿é—®æ§åˆ¶**
```apache
# å†…éƒ¨ç½‘ç»œè®¿é—®é…ç½®
<Directory "/var/www/repos/internal">
    Options Indexes FollowSymLinks
    AllowOverride None
    
    # åªå…è®¸å†…éƒ¨ç½‘ç»œè®¿é—®
    <RequireAll>
        Require ip 192.168.1.0/24      # åŠå…¬ç½‘ç»œ
        Require ip 10.0.0.0/8          # å†…éƒ¨ç½‘ç»œ
        Require ip 172.16.0.0/12       # VPNç½‘ç»œ
    </RequireAll>
</Directory>

# æ‹’ç»ç‰¹å®šIP
<Directory "/var/www/repos">
    <RequireAll>
        Require all granted
        Require not ip 192.168.1.100   # æ‹’ç»ç‰¹å®šIP
        Require not host badhost.com   # æ‹’ç»ç‰¹å®šä¸»æœº
    </RequireAll>
</Directory>
```

### 5.3 Nginxè®¿é—®æ§åˆ¶


**Nginxè®¤è¯é…ç½®**
```nginx
server {
    listen 80;
    server_name repo.company.com;
    root /var/www/repos;
    
    # å…¬å…±åŒºåŸŸ
    location /public/ {
        autoindex on;
        allow all;
    }
    
    # å†…éƒ¨åŒºåŸŸ - åŸºç¡€è®¤è¯
    location /internal/ {
        auth_basic "Internal Repository";
        auth_basic_user_file /etc/nginx/.htpasswd;
        autoindex on;
    }
    
    # å¼€å‘åŒºåŸŸ - IP + è®¤è¯åŒé‡éªŒè¯
    location /dev/ {
        # IPç™½åå•
        allow 192.168.1.0/24;
        allow 10.0.0.0/8;
        deny all;
        
        # åŸºç¡€è®¤è¯
        auth_basic "Development Repository";
        auth_basic_user_file /etc/nginx/.htpasswd;
        autoindex on;
    }
    
    # é™åˆ¶ä¸‹è½½é€Ÿåº¦ï¼ˆé˜²æ­¢æ»¥ç”¨ï¼‰
    location ~* \.(rpm|deb|tar\.gz)$ {
        limit_rate 10m;  # é™åˆ¶ä¸º10MB/s
        autoindex on;
    }
}
```

### 5.4 SSL/TLSåŠ å¯†é…ç½®


**HTTPSä»“åº“é…ç½®**
```nginx
server {
    listen 443 ssl http2;
    server_name repo.company.com;
    root /var/www/repos;
    
    # SSLè¯ä¹¦é…ç½®
    ssl_certificate /etc/nginx/ssl/repo.company.com.crt;
    ssl_certificate_key /etc/nginx/ssl/repo.company.com.key;
    
    # SSLä¼˜åŒ–é…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384;
    ssl_prefer_server_ciphers off;
    
    # å®‰å…¨å¤´è®¾ç½®
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options DENY always;
    add_header X-Content-Type-Options nosniff always;
    
    location / {
        autoindex on;
        auth_basic "Secure Repository";
        auth_basic_user_file /etc/nginx/.htpasswd;
    }
}

# HTTPé‡å®šå‘åˆ°HTTPS
server {
    listen 80;
    server_name repo.company.com;
    return 301 https://$server_name$request_uri;
}
```

---

## 6. âš¡ é«˜å¯ç”¨é…ç½®


### 6.1 é«˜å¯ç”¨æ¶æ„è®¾è®¡


**ä»€ä¹ˆæ˜¯é«˜å¯ç”¨ï¼Ÿ**
é«˜å¯ç”¨å°±æ˜¯ç¡®ä¿æœåŠ¡"æ°¸ä¸åœæœº"ï¼Œå³ä½¿æŸå°æœåŠ¡å™¨å‡ºæ•…éšœï¼Œç”¨æˆ·ä»èƒ½æ­£å¸¸ä¸‹è½½è½¯ä»¶åŒ…ã€‚

**åŒæœºçƒ­å¤‡æ¶æ„**
```
                 è´Ÿè½½å‡è¡¡å™¨
                      â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                     â”‚
      â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”
      â”‚ä¸»ä»“åº“   â”‚ <-------> â”‚å¤‡ä»“åº“  â”‚
      â”‚æœåŠ¡å™¨1  â”‚   åŒæ­¥     â”‚æœåŠ¡å™¨2 â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                     â”‚
      â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”
      â”‚å…±äº«å­˜å‚¨1â”‚           â”‚å…±äº«å­˜å‚¨2â”‚
      â”‚(ä¸»)     â”‚ <-------> â”‚(å¤‡)    â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   é•œåƒ    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 Keepalivedé…ç½®


**ä¸»æœåŠ¡å™¨é…ç½®**
```bash
# /etc/keepalived/keepalived.conf (ä¸»æœåŠ¡å™¨)
! Configuration File for keepalived

global_defs {
    router_id REPO_MASTER
    vrrp_skip_check_adv_addr
    vrrp_strict
    vrrp_garp_interval 0
    vrrp_gna_interval 0
}

# æ£€æŸ¥NginxæœåŠ¡çŠ¶æ€çš„è„šæœ¬
vrrp_script chk_nginx {
    script "/usr/local/bin/check_nginx.sh"
    interval 3
    weight -2
    fall 2
    rise 1
}

vrrp_instance VI_1 {
    state MASTER
    interface eth0
    virtual_router_id 51
    priority 150                    # ä¸»æœåŠ¡å™¨ä¼˜å…ˆçº§é«˜
    advert_int 1
    authentication {
        auth_type PASS
        auth_pass repo@2024
    }
    
    virtual_ipaddress {
        192.168.1.200/24           # è™šæ‹ŸIPåœ°å€
    }
    
    track_script {
        chk_nginx
    }
    
    notify_master "/usr/local/bin/notify_master.sh"
    notify_backup "/usr/local/bin/notify_backup.sh"
}
```

**å¤‡æœåŠ¡å™¨é…ç½®**
```bash
# /etc/keepalived/keepalived.conf (å¤‡æœåŠ¡å™¨)
! Configuration File for keepalived

global_defs {
    router_id REPO_BACKUP
}

vrrp_instance VI_1 {
    state BACKUP
    interface eth0
    virtual_router_id 51
    priority 100                    # å¤‡æœåŠ¡å™¨ä¼˜å…ˆçº§ä½
    advert_int 1
    authentication {
        auth_type PASS
        auth_pass repo@2024
    }
    
    virtual_ipaddress {
        192.168.1.200/24
    }
    
    track_script {
        chk_nginx  
    }
}
```

### 6.3 å¥åº·æ£€æŸ¥è„šæœ¬


**NginxçŠ¶æ€æ£€æŸ¥**
```bash
#!/bin/bash
# /usr/local/bin/check_nginx.sh

# æ£€æŸ¥nginxè¿›ç¨‹
if ! pgrep nginx > /dev/null; then
    echo "Nginxè¿›ç¨‹ä¸å­˜åœ¨"
    exit 1
fi

# æ£€æŸ¥nginxç«¯å£
if ! ss -tln | grep -q ":80 "; then
    echo "Nginxç«¯å£80æœªç›‘å¬"
    exit 1
fi

# æ£€æŸ¥ä»“åº“æœåŠ¡å“åº”
response=$(curl -s -o /dev/null -w "%{http_code}" http://localhost/health 2>/dev/null)
if [ "$response" != "200" ]; then
    echo "ä»“åº“æœåŠ¡æ— å“åº”ï¼ŒçŠ¶æ€ç : $response"
    exit 1
fi

# æ£€æŸ¥ç£ç›˜ç©ºé—´
disk_usage=$(df /var/www/repos | awk 'NR==2 {print $(NF-1)}' | sed 's/%//')
if [ "$disk_usage" -gt 90 ]; then
    echo "ç£ç›˜ç©ºé—´ä¸è¶³ï¼Œä½¿ç”¨ç‡: ${disk_usage}%"
    exit 1
fi

echo "æ‰€æœ‰æ£€æŸ¥é€šè¿‡"
exit 0
```

**åˆ‡æ¢é€šçŸ¥è„šæœ¬**
```bash
#!/bin/bash
# /usr/local/bin/notify_master.sh

LOG_FILE="/var/log/keepalived/transition.log"
HOSTNAME=$(hostname)

echo "[$(date)] $HOSTNAME æˆä¸ºä¸»æœåŠ¡å™¨" >> $LOG_FILE

# ç¡®ä¿æœåŠ¡æ­£å¸¸è¿è¡Œ
systemctl restart nginx

# å‘é€å‘Šè­¦é€šçŸ¥ï¼ˆå¯é€‰ï¼‰
curl -X POST \
     -H "Content-Type: application/json" \
     -d "{\"text\":\"ä»“åº“æœåŠ¡å™¨ $HOSTNAME å·²åˆ‡æ¢ä¸ºä¸»æœåŠ¡å™¨\"}" \
     http://webhook.company.com/alerts
```

### 6.4 æ•°æ®åŒæ­¥é…ç½®


**å®æ—¶æ–‡ä»¶åŒæ­¥**
```bash
#!/bin/bash
# /usr/local/bin/realtime-sync.sh

# ä½¿ç”¨inotifyç›‘æ§æ–‡ä»¶å˜åŒ–å¹¶å®æ—¶åŒæ­¥
MASTER_REPO="/var/www/repos"
BACKUP_SERVER="192.168.1.201"
BACKUP_USER="reposync"

# å®‰è£…inotifyå·¥å…·
yum install -y inotify-tools

# ç›‘æ§å¹¶åŒæ­¥
inotifywait -m -r -e create,delete,modify,move "$MASTER_REPO" --format '%w%f %e' | 
while read file event; do
    echo "[$(date)] æ£€æµ‹åˆ°æ–‡ä»¶å˜åŒ–: $file ($event)"
    
    # åŒæ­¥åˆ°å¤‡ä»½æœåŠ¡å™¨
    rsync -avz --delete \
          -e "ssh -o StrictHostKeyChecking=no" \
          "$MASTER_REPO/" \
          "$BACKUP_USER@$BACKUP_SERVER:$MASTER_REPO/" 2>&1 | \
    tee -a "/var/log/realtime-sync.log"
done
```

---

## 7. ğŸš€ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


### 7.1 å¸¦å®½ä¼˜åŒ–ç­–ç•¥


**ä»€ä¹ˆæ˜¯å¸¦å®½ä¼˜åŒ–ï¼Ÿ**
å¸¦å®½ä¼˜åŒ–å°±æ˜¯åœ¨æœ‰é™çš„ç½‘ç»œæ¡ä»¶ä¸‹ï¼Œè®©ç”¨æˆ·èƒ½æ›´å¿«åœ°ä¸‹è½½è½¯ä»¶åŒ…ï¼ŒåŒæ—¶å‡å°‘æœåŠ¡å™¨çš„ç½‘ç»œå‹åŠ›ã€‚

**å‹ç¼©ä¼ è¾“é…ç½®**
```nginx
# Nginxå‹ç¼©é…ç½®
http {
    # å¯ç”¨gzipå‹ç¼©
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_proxied any;
    gzip_comp_level 6;
    
    # å‹ç¼©æ–‡ä»¶ç±»å‹
    gzip_types
        text/plain
        text/css
        text/xml
        text/javascript
        application/javascript
        application/xml+rss
        application/json
        application/xml;
    
    # ä¸å‹ç¼©å·²å‹ç¼©æ–‡ä»¶
    gzip_disable "msie6";
    
    # æ–‡ä»¶ç¼“å­˜
    open_file_cache max=1000 inactive=20s;
    open_file_cache_valid 30s;
    open_file_cache_min_uses 2;
    open_file_cache_errors on;
}
```

### 7.2 ç¼“å­˜ç­–ç•¥ä¼˜åŒ–


**å¤šå±‚ç¼“å­˜æ¶æ„**
```
ç”¨æˆ·è¯·æ±‚
    â†“
CDNç¼“å­˜ (å…¨å±€)
    â†“
Nginxç¼“å­˜ (æœ¬åœ°)  
    â†“
æ–‡ä»¶ç³»ç»Ÿç¼“å­˜
    â†“
ç£ç›˜å­˜å‚¨
```

**Nginxç¼“å­˜é…ç½®**
```nginx
# ç¼“å­˜è·¯å¾„é…ç½®
proxy_cache_path /var/cache/nginx/repos
                 levels=1:2
                 keys_zone=repo_cache:10m
                 max_size=10g
                 inactive=60m
                 use_temp_path=off;

server {
    listen 80;
    server_name repo.company.com;
    root /var/www/repos;
    
    # é™æ€æ–‡ä»¶ç¼“å­˜
    location ~* \.(rpm|deb|tar\.gz|tar\.bz2|tar\.xz)$ {
        expires 7d;
        add_header Cache-Control "public, immutable";
        add_header X-Cache-Status "HIT from repo server";
        
        # å¯ç”¨sendfileä¼˜åŒ–
        sendfile on;
        tcp_nopush on;
        tcp_nodelay on;
    }
    
    # ä»“åº“å…ƒæ•°æ®ç¼“å­˜
    location ~* \.(xml|gz|bz2|sqlite)$ {
        expires 1h;
        add_header Cache-Control "public, must-revalidate";
        
        # ä»£ç†ç¼“å­˜
        proxy_cache repo_cache;
        proxy_cache_valid 200 1h;
        proxy_cache_use_stale error timeout updating http_500 http_502 http_503 http_504;
    }
}
```

### 7.3 è¿æ¥ä¼˜åŒ–


**HTTP/2åè®®å¯ç”¨**
```nginx
server {
    listen 443 ssl http2;  # å¯ç”¨HTTP/2
    server_name repo.company.com;
    
    # HTTP/2ä¼˜åŒ–é…ç½®
    http2_max_field_size 16k;
    http2_max_header_size 32k;
    
    # è¿æ¥å¤ç”¨
    keepalive_timeout 65;
    keepalive_requests 1000;
    
    location / {
        # å¯ç”¨é›¶æ‹·è´
        sendfile on;
        sendfile_max_chunk 1m;
        
        # TCPä¼˜åŒ–
        tcp_nopush on;
        tcp_nodelay on;
    }
}
```

### 7.4 ç£ç›˜IOä¼˜åŒ–


**SSDåŠ é€Ÿé…ç½®**
```bash
# /etc/fstabä¸­çš„SSDä¼˜åŒ–æŒ‚è½½é€‰é¡¹
/dev/sda1 /var/www/repos ext4 noatime,discard,data=ordered 0 2

# è®¾ç½®IOè°ƒåº¦å™¨ä¸ºdeadlineï¼ˆé€‚åˆSSDï¼‰
echo deadline > /sys/block/sda/queue/scheduler

# è°ƒæ•´å†…æ ¸å‚æ•°ä¼˜åŒ–IO
cat >> /etc/sysctl.conf << EOF
# ç£ç›˜IOä¼˜åŒ–
vm.dirty_background_ratio = 5
vm.dirty_ratio = 10
vm.dirty_writeback_centisecs = 500
vm.dirty_expire_centisecs = 3000

# ç½‘ç»œä¼˜åŒ–
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216
net.ipv4.tcp_rmem = 4096 87380 16777216
net.ipv4.tcp_wmem = 4096 65536 16777216
EOF

sysctl -p
```

**æ™ºèƒ½é¢„è¯»é…ç½®**
```bash
#!/bin/bash
# /usr/local/bin/preload-popular.sh

# é¢„åŠ è½½çƒ­é—¨è½¯ä»¶åŒ…åˆ°å†…å­˜
POPULAR_PACKAGES=(
    "kernel"
    "glibc"
    "systemd"
    "nginx"
    "httpd"
    "mysql"
    "postgresql"
)

echo "å¼€å§‹é¢„åŠ è½½çƒ­é—¨è½¯ä»¶åŒ…..."

for package in "${POPULAR_PACKAGES[@]}"; do
    find /var/www/repos -name "*${package}*.rpm" -exec cat {} > /dev/null \; 2>/dev/null
    echo "é¢„åŠ è½½ $package ç›¸å…³åŒ…å®Œæˆ"
done

echo "é¢„åŠ è½½å®Œæˆ"
```

---

## 8. ğŸ“Š ç›‘æ§ä¸è¿ç»´ç®¡ç†


### 8.1 ç³»ç»Ÿç›‘æ§æŒ‡æ ‡


**å…³é”®ç›‘æ§æŒ‡æ ‡**
- âœ… **æœåŠ¡å¯ç”¨æ€§**ï¼šHTTPå“åº”çŠ¶æ€
- âœ… **ç£ç›˜ç©ºé—´**ï¼šå­˜å‚¨ä½¿ç”¨ç‡å’Œå¢é•¿è¶‹åŠ¿  
- âœ… **ç½‘ç»œå¸¦å®½**ï¼šä¸‹è½½é€Ÿåº¦å’Œå¹¶å‘è¿æ¥
- âœ… **åŒæ­¥çŠ¶æ€**ï¼šä»“åº“æ›´æ–°æ˜¯å¦æ­£å¸¸
- âœ… **è®¿é—®ç»Ÿè®¡**ï¼šçƒ­é—¨è½¯ä»¶åŒ…å’Œç”¨æˆ·è¡Œä¸º

**ç›‘æ§è„šæœ¬å®ç°**
```bash
#!/bin/bash
# /usr/local/bin/repo-monitor.sh

REPO_ROOT="/var/www/repos"
LOG_FILE="/var/log/repo-monitor.log"
ALERT_THRESHOLD_DISK=85
ALERT_THRESHOLD_CONN=1000

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
check_service_status() {
    echo "=== æœåŠ¡çŠ¶æ€æ£€æŸ¥ ===" | tee -a $LOG_FILE
    
    # æ£€æŸ¥nginxçŠ¶æ€
    if systemctl is-active nginx > /dev/null; then
        echo "âœ… NginxæœåŠ¡: è¿è¡Œä¸­" | tee -a $LOG_FILE
    else
        echo "âŒ NginxæœåŠ¡: å¼‚å¸¸" | tee -a $LOG_FILE
        # å°è¯•é‡å¯æœåŠ¡
        systemctl restart nginx
    fi
    
    # æ£€æŸ¥HTTPå“åº”
    response=$(curl -s -o /dev/null -w "%{http_code}" http://localhost/ 2>/dev/null)
    if [ "$response" = "200" ]; then
        echo "âœ… HTTPæœåŠ¡: æ­£å¸¸å“åº” ($response)" | tee -a $LOG_FILE
    else
        echo "âŒ HTTPæœåŠ¡: å“åº”å¼‚å¸¸ ($response)" | tee -a $LOG_FILE
    fi
}

# æ£€æŸ¥ç£ç›˜ä½¿ç”¨ç‡
check_disk_usage() {
    echo "=== ç£ç›˜ä½¿ç”¨ç‡æ£€æŸ¥ ===" | tee -a $LOG_FILE
    
    disk_usage=$(df $REPO_ROOT | awk 'NR==2 {print $(NF-1)}' | sed 's/%//')
    echo "ğŸ“Š ä»“åº“ç£ç›˜ä½¿ç”¨ç‡: ${disk_usage}%" | tee -a $LOG_FILE
    
    if [ "$disk_usage" -gt "$ALERT_THRESHOLD_DISK" ]; then
        echo "âš ï¸  ç£ç›˜ä½¿ç”¨ç‡è¿‡é«˜!" | tee -a $LOG_FILE
        # å‘é€å‘Šè­¦
        send_alert "ç£ç›˜ä½¿ç”¨ç‡è¿‡é«˜: ${disk_usage}%"
    fi
}

# æ£€æŸ¥ç½‘ç»œè¿æ¥
check_network_connections() {
    echo "=== ç½‘ç»œè¿æ¥æ£€æŸ¥ ===" | tee -a $LOG_FILE
    
    conn_count=$(ss -tun state connected | wc -l)
    echo "ğŸŒ å½“å‰è¿æ¥æ•°: $conn_count" | tee -a $LOG_FILE
    
    if [ "$conn_count" -gt "$ALERT_THRESHOLD_CONN" ]; then
        echo "âš ï¸  å¹¶å‘è¿æ¥è¿‡å¤š!" | tee -a $LOG_FILE
    fi
}

# æ£€æŸ¥ä»“åº“åŒæ­¥çŠ¶æ€
check_sync_status() {
    echo "=== ä»“åº“åŒæ­¥çŠ¶æ€ ===" | tee -a $LOG_FILE
    
    for repo in centos epel rhel; do
        if [ -d "$REPO_ROOT/$repo" ]; then
            last_sync=$(stat -c %Y "$REPO_ROOT/$repo/repodata/repomd.xml" 2>/dev/null || echo 0)
            current_time=$(date +%s)
            hours_since_sync=$(( (current_time - last_sync) / 3600 ))
            
            echo "ğŸ“¦ $repo ä»“åº“: ${hours_since_sync}å°æ—¶å‰æ›´æ–°" | tee -a $LOG_FILE
            
            if [ "$hours_since_sync" -gt 48 ]; then
                echo "âš ï¸  $repo ä»“åº“åŒæ­¥å»¶è¿Ÿ!" | tee -a $LOG_FILE
            fi
        fi
    done
}

# ç”Ÿæˆè®¿é—®ç»Ÿè®¡æŠ¥å‘Š
generate_access_stats() {
    echo "=== è®¿é—®ç»Ÿè®¡æŠ¥å‘Š ===" | tee -a $LOG_FILE
    
    # åˆ†æè®¿é—®æ—¥å¿—
    if [ -f "/var/log/nginx/repos_access.log" ]; then
        # ä»Šæ—¥è®¿é—®é‡
        today_access=$(grep "$(date +%d/%b/%Y)" /var/log/nginx/repos_access.log | wc -l)
        echo "ğŸ“ˆ ä»Šæ—¥è®¿é—®é‡: $today_access" | tee -a $LOG_FILE
        
        # çƒ­é—¨æ–‡ä»¶TOP5
        echo "ğŸ”¥ çƒ­é—¨ä¸‹è½½æ–‡ä»¶:" | tee -a $LOG_FILE
        grep "$(date +%d/%b/%Y)" /var/log/nginx/repos_access.log | \
        awk '{print $7}' | grep -E '\.(rpm|deb)$' | \
        sort | uniq -c | sort -nr | head -5 | \
        while read count file; do
            echo "   $count æ¬¡: $(basename $file)" | tee -a $LOG_FILE
        done
    fi
}

# å‘é€å‘Šè­¦å‡½æ•°
send_alert() {
    local message=$1
    local hostname=$(hostname)
    
    # å‘é€åˆ°ä¼ä¸šå¾®ä¿¡/é’‰é’‰ç­‰ï¼ˆç¤ºä¾‹ï¼‰
    curl -X POST -H "Content-Type: application/json" \
         -d "{\"text\":\"[$hostname] ä»“åº“å‘Šè­¦: $message\"}" \
         "http://webhook.company.com/alerts" 2>/dev/null
}

# ä¸»å‡½æ•°
main() {
    echo "[$(date)] å¼€å§‹ä»“åº“ç›‘æ§æ£€æŸ¥" | tee -a $LOG_FILE
    
    check_service_status
    check_disk_usage
    check_network_connections
    check_sync_status
    generate_access_stats
    
    echo "[$(date)] ç›‘æ§æ£€æŸ¥å®Œæˆ" | tee -a $LOG_FILE
    echo "=========================" | tee -a $LOG_FILE
}

main "$@"
```

### 8.2 æ—¥å¿—ç®¡ç†ç­–ç•¥


**æ—¥å¿—è½®è½¬é…ç½®**
```bash
# /etc/logrotate.d/repos
/var/log/nginx/repos_*.log {
    daily
    rotate 30
    compress
    delaycompress
    missingok
    notifempty
    sharedscripts
    postrotate
        /bin/kill -USR1 `cat /run/nginx.pid 2>/dev/null` 2>/dev/null || true
    endscript
}

/var/log/repo-sync/*.log {
    weekly
    rotate 12
    compress
    delaycompress
    missingok
    notifempty
}
```

**æ—¥å¿—åˆ†æè„šæœ¬**
```bash
#!/bin/bash
# /usr/local/bin/analyze-logs.sh

ACCESS_LOG="/var/log/nginx/repos_access.log"
REPORT_FILE="/var/log/repo-analysis-$(date +%Y%m%d).log"

analyze_access_patterns() {
    echo "=== è®¿é—®æ¨¡å¼åˆ†æ ===" > $REPORT_FILE
    
    # æŒ‰å°æ—¶ç»Ÿè®¡è®¿é—®é‡
    echo "ğŸ“Š å°æ—¶è®¿é—®åˆ†å¸ƒ:" >> $REPORT_FILE
    awk '{print $4}' $ACCESS_LOG | cut -d: -f2 | sort | uniq -c | sort -nr >> $REPORT_FILE
    
    # ç»Ÿè®¡ç”¨æˆ·ä»£ç†
    echo -e "\nğŸ” å®¢æˆ·ç«¯ç±»å‹:" >> $REPORT_FILE
    awk -F'"' '{print $(NF-1)}' $ACCESS_LOG | sort | uniq -c | sort -nr | head -10 >> $REPORT_FILE
    
    # ç»Ÿè®¡å“åº”çŠ¶æ€ç 
    echo -e "\nğŸ“ˆ å“åº”çŠ¶æ€åˆ†å¸ƒ:" >> $REPORT_FILE
    awk '{print $9}' $ACCESS_LOG | sort | uniq -c | sort -nr >> $REPORT_FILE
}

analyze_download_patterns() {
    echo -e "\n=== ä¸‹è½½æ¨¡å¼åˆ†æ ===" >> $REPORT_FILE
    
    # å¤§æ–‡ä»¶ä¸‹è½½ç»Ÿè®¡
    echo "ğŸ’¾ å¤§æ–‡ä»¶ä¸‹è½½ (>100MB):" >> $REPORT_FILE
    awk '$10 > 104857600 {print $7, $10/1024/1024 "MB"}' $ACCESS_LOG | \
    sort | uniq -c | sort -nr | head -10 >> $REPORT_FILE
    
    # ä¸‹è½½é”™è¯¯åˆ†æ
    echo -e "\nâŒ ä¸‹è½½é”™è¯¯åˆ†æ:" >> $REPORT_FILE
    awk '$9 >= 400 {print $7, $9}' $ACCESS_LOG | sort | uniq -c | sort -nr | head -10 >> $REPORT_FILE
}

echo "æ—¥å¿—åˆ†æå®Œæˆï¼ŒæŠ¥å‘Šä¿å­˜è‡³: $REPORT_FILE"
```

### 8.3 è‡ªåŠ¨åŒ–è¿ç»´è„šæœ¬


**ä¸€é”®éƒ¨ç½²è„šæœ¬**
```bash
#!/bin/bash
# /usr/local/bin/repo-deploy.sh

REPO_VERSION="1.0"
BACKUP_DIR="/backup/repo-$(date +%Y%m%d)"

deploy_repo_server() {
    echo "ğŸš€ å¼€å§‹éƒ¨ç½²ä»“åº“æœåŠ¡å™¨ v$REPO_VERSION"
    
    # 1. å¤‡ä»½å½“å‰é…ç½®
    mkdir -p $BACKUP_DIR
    cp -r /etc/nginx/conf.d $BACKUP_DIR/
    cp -r /var/www/repos $BACKUP_DIR/
    
    # 2. æ›´æ–°è½¯ä»¶åŒ…
    yum update -y
    
    # 3. éƒ¨ç½²æ–°é…ç½®
    curl -s http://config.company.com/repo-configs.tar.gz | tar -xz -C /tmp/
    cp -r /tmp/repo-configs/* /etc/nginx/conf.d/
    
    # 4. é‡å¯æœåŠ¡
    nginx -t && systemctl reload nginx
    
    # 5. éªŒè¯éƒ¨ç½²
    if curl -s http://localhost/health | grep -q "OK"; then
        echo "âœ… éƒ¨ç½²æˆåŠŸ!"
    else
        echo "âŒ éƒ¨ç½²å¤±è´¥ï¼Œæ­£åœ¨å›æ»š..."
        cp -r $BACKUP_DIR/conf.d/* /etc/nginx/conf.d/
        systemctl reload nginx
        exit 1
    fi
}

deploy_repo_server
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ç§æœ‰ä»“åº“æœ¬è´¨ï¼šä¼ä¸šå†…éƒ¨çš„è½¯ä»¶åŒ…ç®¡ç†ä¸­å¿ƒ
ğŸ”¸ æœåŠ¡å™¨é…ç½®ï¼šnginx/apache + ç›®å½•ç»“æ„ + æƒé™ç®¡ç†
ğŸ”¸ åŒæ­¥ç­–ç•¥ï¼šrsyncå¢é‡åŒæ­¥ + å®šæ—¶ä»»åŠ¡ + çŠ¶æ€ç›‘æ§
ğŸ”¸ åˆ†å±‚æ¶æ„ï¼šä¸»ä»“åº“ + åŒºåŸŸä»“åº“ + è¾¹ç¼˜ç¼“å­˜çš„å±‚æ¬¡è®¾è®¡
ğŸ”¸ è®¿é—®æ§åˆ¶ï¼šåŸºç¡€è®¤è¯ + IPæ§åˆ¶ + SSLåŠ å¯†
ğŸ”¸ é«˜å¯ç”¨ä¿éšœï¼škeepalived + åŒæœºçƒ­å¤‡ + å¥åº·æ£€æŸ¥
ğŸ”¸ æ€§èƒ½ä¼˜åŒ–ï¼šç¼“å­˜ç­–ç•¥ + å¸¦å®½æ§åˆ¶ + IOä¼˜åŒ–
ğŸ”¸ è¿ç»´ç›‘æ§ï¼šçŠ¶æ€ç›‘æ§ + æ—¥å¿—åˆ†æ + è‡ªåŠ¨å‘Šè­¦
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆéœ€è¦ä¼ä¸šä»“åº“ï¼Ÿ**
```
è§£å†³çš„æ ¸å¿ƒé—®é¢˜ï¼š
- ç½‘ç»œä¾èµ–ï¼šå‡å°‘å¯¹å¤–ç½‘çš„ä¾èµ–
- ç‰ˆæœ¬æ§åˆ¶ï¼šç»Ÿä¸€ç®¡ç†è½¯ä»¶ç‰ˆæœ¬
- å®‰å…¨åˆè§„ï¼šæ•æ„Ÿè½¯ä»¶ä¸å‡ºä¼ä¸šè¾¹ç•Œ
- æ€§èƒ½ä¼˜åŒ–ï¼šå†…ç½‘è®¿é—®é€Ÿåº¦å¿«
- æˆæœ¬æ§åˆ¶ï¼šå‡å°‘é‡å¤ä¸‹è½½çš„å¸¦å®½æˆæœ¬
```

**ğŸ”¹ åˆ†å±‚æ¶æ„çš„ä»·å€¼**
```
è®¾è®¡æ€æƒ³ï¼š
- å°±è¿‘æœåŠ¡ï¼šç”¨æˆ·è®¿é—®æœ€è¿‘çš„ä»“åº“èŠ‚ç‚¹
- è´Ÿè½½åˆ†æ•£ï¼šé¿å…å•ç‚¹è¿‡è½½
- æ•…éšœéš”ç¦»ï¼šå•ä¸ªèŠ‚ç‚¹æ•…éšœä¸å½±å“å…¨å±€
- æ‰©å±•çµæ´»ï¼šå¯æ ¹æ®éœ€æ±‚å¢åŠ èŠ‚ç‚¹
```

**ğŸ”¹ åŒæ­¥ç­–ç•¥çš„é€‰æ‹©**
```
rsyncä¼˜åŠ¿ï¼š
- å¢é‡ä¼ è¾“ï¼šåªåŒæ­¥å˜åŒ–éƒ¨åˆ†ï¼Œæ•ˆç‡é«˜
- æ–­ç‚¹ç»­ä¼ ï¼šç½‘ç»œä¸­æ–­åå¯ç»§ç»­åŒæ­¥
- å‹ç¼©ä¼ è¾“ï¼šå‡å°‘ç½‘ç»œå¸¦å®½å ç”¨
- åˆ é™¤åŒæ­¥ï¼šä¿æŒç›®æ ‡ç›®å½•ä¸æºç›®å½•ä¸€è‡´
```

### 9.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ ä¼ä¸šè§„æ¨¡ä¸æ–¹æ¡ˆé€‰æ‹©**

| ä¼ä¸šè§„æ¨¡ | **æ¨èæ–¹æ¡ˆ** | **å…³é”®ç‰¹ç‚¹** |
|---------|-------------|-------------|
| ğŸŸ¢ **å°å‹** | `å•æœºnginx + å®šæ—¶åŒæ­¥` | `æˆæœ¬ä½ï¼Œéƒ¨ç½²ç®€å•` |
| ğŸŸ¡ **ä¸­å‹** | `ä¸»å¤‡åŒæœº + åŒºåŸŸç¼“å­˜` | `é«˜å¯ç”¨ï¼Œæ€§èƒ½å‡è¡¡` |
| ğŸ”´ **å¤§å‹** | `åˆ†å±‚æ¶æ„ + å…¨çƒåˆ†å¸ƒ` | `é«˜æ€§èƒ½ï¼Œå…¨çƒæœåŠ¡` |

**ğŸ”§ éƒ¨ç½²å®æ–½æ­¥éª¤**
```
ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€æ­å»º
â‘  æœåŠ¡å™¨å‡†å¤‡å’Œç¯å¢ƒé…ç½®
â‘¡ WebæœåŠ¡å®‰è£…å’ŒåŸºç¡€é…ç½®
â‘¢ ç›®å½•ç»“æ„åˆ›å»ºå’Œæƒé™è®¾ç½®

ç¬¬äºŒé˜¶æ®µï¼šåŒæ­¥é…ç½®
â‘  rsyncåŒæ­¥è„šæœ¬ç¼–å†™å’Œæµ‹è¯•
â‘¡ å®šæ—¶ä»»åŠ¡é…ç½®å’Œç›‘æ§
â‘¢ åŒæ­¥çŠ¶æ€æ£€æŸ¥å’Œå‘Šè­¦

ç¬¬ä¸‰é˜¶æ®µï¼šä¼˜åŒ–åŠ å›º
â‘  è®¿é—®æ§åˆ¶å’Œå®‰å…¨é…ç½®
â‘¡ æ€§èƒ½ä¼˜åŒ–å’Œç¼“å­˜é…ç½®
â‘¢ ç›‘æ§ç³»ç»Ÿå’Œæ—¥å¿—ç®¡ç†

ç¬¬å››é˜¶æ®µï¼šé«˜å¯ç”¨
â‘  åŒæœºçƒ­å¤‡é…ç½®
â‘¡ è´Ÿè½½å‡è¡¡å’Œæ•…éšœè½¬ç§»
â‘¤ æ•´ä½“æµ‹è¯•å’Œæ–‡æ¡£æ•´ç†
```

**ğŸ“Š è¿ç»´æœ€ä½³å®è·µ**
- **ç›‘æ§å…ˆè¡Œ**ï¼šéƒ¨ç½²å‰å°±è¦è€ƒè™‘ç›‘æ§æ–¹æ¡ˆ
- **å®‰å…¨ç¬¬ä¸€**ï¼šè®¿é—®æ§åˆ¶å’Œæ•°æ®åŠ å¯†å¿…ä¸å¯å°‘
- **è‡ªåŠ¨åŒ–**ï¼šå‡å°‘äººå·¥æ“ä½œï¼Œé™ä½å‡ºé”™æ¦‚ç‡
- **æ–‡æ¡£é½å…¨**ï¼šè¯¦ç»†è®°å½•é…ç½®å’Œæ“ä½œæµç¨‹
- **å®šæœŸæ¼”ç»ƒ**ï¼šæ•…éšœæ¢å¤æµç¨‹è¦å®šæœŸæµ‹è¯•

### 9.4 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


**â“ åŒæ­¥é€Ÿåº¦æ…¢æ€ä¹ˆåŠï¼Ÿ**
```
è§£å†³æ€è·¯ï¼š
âœ… é€‰æ‹©åˆé€‚çš„æºç«™é•œåƒï¼ˆåœ°ç†ä½ç½®è¿‘ï¼‰
âœ… ä½¿ç”¨å¤šçº¿ç¨‹åŒæ­¥å·¥å…·
âœ… é…ç½®å¸¦å®½é™åˆ¶é¿å…å½±å“ä¸šåŠ¡
âœ… åˆ†æ—¶æ®µåŒæ­¥ï¼Œé¿å¼€ä¸šåŠ¡é«˜å³°
```

**â“ ç£ç›˜ç©ºé—´ä¸è¶³æ€ä¹ˆå¤„ç†ï¼Ÿ**
```
è§£å†³æ–¹æ¡ˆï¼š
âœ… æ¸…ç†å†å²ç‰ˆæœ¬å’Œä¸´æ—¶æ–‡ä»¶
âœ… é…ç½®è‡ªåŠ¨æ¸…ç†ç­–ç•¥
âœ… åªåŒæ­¥å¿…è¦çš„è½¯ä»¶åŒ…ç±»å‹
âœ… ä½¿ç”¨å­˜å‚¨å‹ç¼©æŠ€æœ¯
```

**â“ å¦‚ä½•ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Ÿ**
```
ä¿éšœæªæ–½ï¼š
âœ… ä½¿ç”¨checksumséªŒè¯æ–‡ä»¶å®Œæ•´æ€§
âœ… åŒæ­¥å‰åè¿›è¡Œæ•°æ®æ ¡éªŒ
âœ… é…ç½®åŸå­æ“ä½œé¿å…ä¸­é—´çŠ¶æ€
âœ… å»ºç«‹å›æ»šæœºåˆ¶åº”å¯¹å¼‚å¸¸
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- ä¼ä¸šä»“åº“è§£å†³å†…ç½‘è½¯ä»¶åˆ†å‘é—®é¢˜
- åˆ†å±‚æ¶æ„æä¾›é«˜å¯ç”¨å’Œé«˜æ€§èƒ½
- rsyncåŒæ­¥ä¿è¯æ•°æ®åŠæ—¶æ›´æ–°
- ç›‘æ§è¿ç»´ç¡®ä¿æœåŠ¡ç¨³å®šå¯é 