---
title: 7ã€NPMä¸ŽNode.jsé•œåƒæºé…ç½®
---
## ðŸ“š ç›®å½•

1. [NPMé•œåƒæºåŸºç¡€æ¦‚å¿µ](#1-npmé•œåƒæºåŸºç¡€æ¦‚å¿µ)
2. [æ·˜å®NPMé•œåƒæºé…ç½®](#2-æ·˜å®npmé•œåƒæºé…ç½®)
3. [Yarné•œåƒæºé…ç½®](#3-yarné•œåƒæºé…ç½®)
4. [npmrcé…ç½®æ–‡ä»¶ç®¡ç†](#4-npmrcé…ç½®æ–‡ä»¶ç®¡ç†)
5. [nrmé•œåƒæºç®¡ç†å·¥å…·](#5-nrmé•œåƒæºç®¡ç†å·¥å…·)
6. [NPMä»£ç†é…ç½®å‚æ•°](#6-npmä»£ç†é…ç½®å‚æ•°)
7. [Node.jsåŒ…ç®¡ç†åŠ é€Ÿ](#7-nodejsåŒ…ç®¡ç†åŠ é€Ÿ)
8. [ç§æœ‰NPMæºæ­å»º](#8-ç§æœ‰npmæºæ­å»º)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ðŸŒ NPMé•œåƒæºåŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯NPMé•œåƒæº


**NPMé•œåƒæºçš„æœ¬è´¨**
> NPMé•œåƒæºå°±åƒ"å›¾ä¹¦åˆ†é¦†"ï¼Œå®˜æ–¹NPMåº“æ˜¯"æ€»é¦†"ï¼Œé•œåƒæºæ˜¯å„åœ°çš„"åˆ†é¦†"ã€‚å½“ä½ éœ€è¦å€Ÿä¹¦ï¼ˆä¸‹è½½åŒ…ï¼‰æ—¶ï¼ŒåŽ»æœ€è¿‘çš„åˆ†é¦†é€Ÿåº¦æ›´å¿«ã€‚

```
NPMä¸‹è½½è¿‡ç¨‹å¯¹æ¯”ï¼š

ä½¿ç”¨å®˜æ–¹æºï¼ˆnpmå®˜ç½‘ï¼‰ï¼š
ä½ çš„ç”µè„‘ â†’ ç½‘ç»œ â†’ æµ·å¤–NPMæœåŠ¡å™¨ â†’ ä¸‹è½½åŒ…
ç‰¹ç‚¹ï¼šè·ç¦»è¿œï¼Œé€Ÿåº¦æ…¢ï¼Œå¯èƒ½è¢«å¢™

ä½¿ç”¨å›½å†…é•œåƒæºï¼ˆå¦‚æ·˜å®é•œåƒï¼‰ï¼š
ä½ çš„ç”µè„‘ â†’ ç½‘ç»œ â†’ å›½å†…é•œåƒæœåŠ¡å™¨ â†’ ä¸‹è½½åŒ…  
ç‰¹ç‚¹ï¼šè·ç¦»è¿‘ï¼Œé€Ÿåº¦å¿«ï¼Œç¨³å®šå¯é 
```

### 1.2 é•œåƒæºçš„å·¥ä½œåŽŸç†


**é•œåƒåŒæ­¥æœºåˆ¶**
```
é•œåƒæºå¦‚ä½•ä¿æŒä¸Žå®˜æ–¹åŒæ­¥ï¼š

å®˜æ–¹NPMåº“ â”€â”€â”€å®šæœŸåŒæ­¥â”€â”€â”€â†’ é•œåƒæœåŠ¡å™¨
     â†‘                        â†“
   åŒ…å‘å¸ƒè€…                  ç”¨æˆ·ä¸‹è½½

åŒæ­¥é¢‘çŽ‡ï¼š
â€¢ å¤§åž‹é•œåƒæºï¼šæ¯10-30åˆ†é’ŸåŒæ­¥ä¸€æ¬¡
â€¢ çƒ­é—¨åŒ…ï¼šå‡ åˆ†é’Ÿå†…å°±èƒ½åŒæ­¥
â€¢ å†·é—¨åŒ…ï¼šå¯èƒ½å»¶è¿Ÿå‡ å°æ—¶
```

**ä¸ºä»€ä¹ˆè¦ä½¿ç”¨é•œåƒæºï¼š**
- **ðŸš€ é€Ÿåº¦æå‡**ï¼šå›½å†…è®¿é—®é€Ÿåº¦æå‡5-10å€
- **ðŸ›¡ï¸ ç¨³å®šæ€§å¥½**ï¼šé¿å…ç½‘ç»œæ³¢åŠ¨å’Œå°é”é—®é¢˜
- **ðŸ’° èŠ‚çœå¸¦å®½**ï¼šä¼ä¸šå†…ç½‘å¯ä»¥æ­å»ºå†…éƒ¨é•œåƒ
- **ðŸ“¦ å®Œæ•´æ€§ä¿è¯**ï¼šé•œåƒå†…å®¹ä¸Žå®˜æ–¹å®Œå…¨ä¸€è‡´

### 1.3 å¸¸è§é•œåƒæºå¯¹æ¯”


| é•œåƒæºåç§° | **åœ°å€** | **ç»´æŠ¤æ–¹** | **åŒæ­¥é¢‘çŽ‡** | **æŽ¨èæŒ‡æ•°** |
|-----------|---------|-----------|-------------|-------------|
| **æ·˜å®é•œåƒ** | `https://registry.npmmirror.com` | é˜¿é‡Œå·´å·´ | 10åˆ†é’Ÿ | â­â­â­â­â­ |
| **åŽä¸ºé•œåƒ** | `https://repo.huaweicloud.com/repository/npm/` | åŽä¸ºäº‘ | 30åˆ†é’Ÿ | â­â­â­â­ |
| **è…¾è®¯é•œåƒ** | `https://mirrors.cloud.tencent.com/npm/` | è…¾è®¯äº‘ | 15åˆ†é’Ÿ | â­â­â­â­ |
| **å®˜æ–¹æº** | `https://registry.npmjs.org` | NPMå®˜æ–¹ | å®žæ—¶ | â­â­â­ |

---

## 2. ðŸ† æ·˜å®NPMé•œåƒæºé…ç½®


### 2.1 æ·˜å®é•œåƒæºåŸºæœ¬ä»‹ç»


**ä¸ºä»€ä¹ˆé€‰æ‹©æ·˜å®é•œåƒï¼Ÿ**
> æ·˜å®NPMé•œåƒæ˜¯ç›®å‰å›½å†…æœ€ç¨³å®šã€æœ€å¿«é€Ÿçš„NPMé•œåƒæºï¼Œç”±é˜¿é‡Œå·´å·´å›¢é˜Ÿç»´æŠ¤ï¼ŒåŒæ­¥é¢‘çŽ‡é«˜ï¼ŒæœåŠ¡è´¨é‡å¯é ã€‚

**é‡è¦æé†’ï¼š** æ·˜å®é•œåƒå·²ä»Ž `https://registry.npm.taobao.org` è¿ç§»åˆ° `https://registry.npmmirror.com`

### 2.2 ä¸´æ—¶ä½¿ç”¨æ·˜å®é•œåƒ


```bash
# ä¸´æ—¶ä½¿ç”¨æ·˜å®é•œåƒå®‰è£…åŒ…
npm install åŒ…å --registry https://registry.npmmirror.com

# ç¤ºä¾‹ï¼šå®‰è£…express
npm install express --registry https://registry.npmmirror.com

# ä¸´æ—¶ä½¿ç”¨æ·˜å®é•œåƒå®‰è£…æ‰€æœ‰ä¾èµ–
npm install --registry https://registry.npmmirror.com
```

**ä¸´æ—¶ä½¿ç”¨çš„é€‚ç”¨åœºæ™¯ï¼š**
- ðŸ”§ **ä¸´æ—¶åŠ é€Ÿ**ï¼šå¶å°”éœ€è¦å¿«é€Ÿå®‰è£…æŸä¸ªåŒ…
- ðŸ§ª **æµ‹è¯•éªŒè¯**ï¼šéªŒè¯é•œåƒæºæ˜¯å¦å¯ç”¨
- ðŸš« **é¿å…å…¨å±€æ”¹åŠ¨**ï¼šä¸æƒ³ä¿®æ”¹ç³»ç»Ÿé…ç½®

### 2.3 æ°¸ä¹…è®¾ç½®æ·˜å®é•œåƒ


#### ðŸ”¸ æ–¹æ³•ä¸€ï¼šnpm configè®¾ç½®

```bash
# æŸ¥çœ‹å½“å‰é•œåƒæº
npm config get registry

# è®¾ç½®æ·˜å®é•œåƒæº
npm config set registry https://registry.npmmirror.com

# éªŒè¯è®¾ç½®æ˜¯å¦ç”Ÿæ•ˆ
npm config get registry
# è¾“å‡ºï¼šhttps://registry.npmmirror.com

# æµ‹è¯•é•œåƒæºè¿žé€šæ€§
npm ping
```

#### ðŸ”¸ æ–¹æ³•äºŒï¼šä½¿ç”¨cnpmå·¥å…·

```bash
# å®‰è£…cnpmï¼ˆæ·˜å®å®šåˆ¶çš„npmï¼‰
npm install -g cnpm --registry=https://registry.npmmirror.com

# ä½¿ç”¨cnpmä»£æ›¿npm
cnpm install express
cnpm install

# cnpmçš„ä¼˜åŠ¿
âœ… ä¸“ä¸ºæ·˜å®é•œåƒä¼˜åŒ–
âœ… å®‰è£…é€Ÿåº¦æ›´å¿«
âœ… ä¿æŒnpmçš„æ‰€æœ‰åŠŸèƒ½
```

### 2.4 æ¢å¤å®˜æ–¹æº


```bash
# æ¢å¤åˆ°npmå®˜æ–¹æº
npm config set registry https://registry.npmjs.org

# æˆ–è€…åˆ é™¤è‡ªå®šä¹‰é…ç½®ï¼ˆæ¢å¤é»˜è®¤ï¼‰
npm config delete registry

# éªŒè¯æ¢å¤ç»“æžœ
npm config get registry
```

---

## 3. ðŸ§¶ Yarné•œåƒæºé…ç½®


### 3.1 YarnåŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯Yarnï¼Ÿ**
> Yarnæ˜¯Facebookå¼€å‘çš„åŒ…ç®¡ç†å™¨ï¼Œå¯ä»¥çœ‹ä½œæ˜¯"å‡çº§ç‰ˆçš„npm"ï¼Œç‰¹ç‚¹æ˜¯é€Ÿåº¦å¿«ã€å®‰å…¨æ€§å¥½ã€ä¾èµ–ç®¡ç†æ›´å¯é ã€‚

```
NPM vs Yarn ç‰¹ç‚¹å¯¹æ¯”ï¼š

NPMï¼š
â€¢ Node.jså®˜æ–¹åŒ…ç®¡ç†å™¨
â€¢ åŠŸèƒ½å…¨é¢ï¼Œç”Ÿæ€æˆç†Ÿ
â€¢ å®‰è£…é€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢

Yarnï¼š
â€¢ Facebookå¼€å‘çš„æ›¿ä»£æ–¹æ¡ˆ
â€¢ å¹¶è¡Œä¸‹è½½ï¼Œé€Ÿåº¦æ›´å¿«
â€¢ é”æ–‡ä»¶æ›´å¯é ï¼ˆyarn.lockï¼‰
â€¢ ç¦»çº¿å®‰è£…æ”¯æŒ
```

### 3.2 Yarné•œåƒæºé…ç½®


#### ðŸ”¸ æŸ¥çœ‹å’Œè®¾ç½®Yarné•œåƒæº

```bash
# æŸ¥çœ‹å½“å‰Yarné•œåƒæº
yarn config get registry

# è®¾ç½®æ·˜å®é•œåƒæº
yarn config set registry https://registry.npmmirror.com

# ä¸´æ—¶ä½¿ç”¨é•œåƒæºå®‰è£…
yarn add express --registry https://registry.npmmirror.com
```

#### ðŸ”¸ Yarnå…¨å±€é•œåƒæºé…ç½®

```bash
# å…¨å±€è®¾ç½®æ·˜å®é•œåƒæº
yarn config set registry https://registry.npmmirror.com -g

# æŸ¥çœ‹æ‰€æœ‰Yarné…ç½®
yarn config list

# åˆ é™¤é•œåƒæºé…ç½®
yarn config delete registry
```

### 3.3 Yarnæ€§èƒ½ä¼˜åŒ–é…ç½®


```bash
# è®¾ç½®ç½‘ç»œè¶…æ—¶æ—¶é—´ï¼ˆé»˜è®¤30ç§’ï¼Œå¯ä»¥æ”¹ä¸º60ç§’ï¼‰
yarn config set network-timeout 60000

# å¯ç”¨ç¦»çº¿æ¨¡å¼ï¼ˆä¼˜å…ˆä½¿ç”¨æœ¬åœ°ç¼“å­˜ï¼‰
yarn config set prefer-offline true

# è®¾ç½®ç¼“å­˜ç›®å½•ï¼ˆå¯é€‰ï¼Œé»˜è®¤åœ¨ç”¨æˆ·ç›®å½•ï¼‰
yarn config set cache-folder /path/to/yarn-cache
```

### 3.4 Yarnä¸ŽNPMæ··ç”¨æ³¨æ„äº‹é¡¹


**é¡¹ç›®ä¸­çš„æœ€ä½³å®žè·µï¼š**
```bash
# âœ… æŽ¨èåšæ³•ï¼šåœ¨é¡¹ç›®ä¸­ç»Ÿä¸€ä½¿ç”¨ä¸€ç§åŒ…ç®¡ç†å™¨

# å¦‚æžœé¡¹ç›®æœ‰package-lock.jsonï¼Œä½¿ç”¨npm
npm install

# å¦‚æžœé¡¹ç›®æœ‰yarn.lockï¼Œä½¿ç”¨yarn
yarn install

# âŒ é¿å…æ··ç”¨ï¼šä¸è¦åœ¨åŒä¸€é¡¹ç›®ä¸­åŒæ—¶ä½¿ç”¨npmå’Œyarn
# è¿™å¯èƒ½å¯¼è‡´ç‰ˆæœ¬å†²çªå’Œä¾èµ–é—®é¢˜
```

**é”æ–‡ä»¶çš„é‡è¦æ€§ï¼š**
```
package-lock.json (NPM)ï¼š
â€¢ é”å®šç¡®åˆ‡çš„åŒ…ç‰ˆæœ¬
â€¢ ç¡®ä¿å›¢é˜Ÿå®‰è£…ç›¸åŒç‰ˆæœ¬
â€¢ æé«˜å®‰è£…é€Ÿåº¦

yarn.lock (Yarn)ï¼š
â€¢ åŠŸèƒ½ç±»ä¼¼package-lock.json
â€¢ æ ¼å¼æ›´æ˜“è¯»
â€¢ åˆå¹¶å†²çªå¤„ç†æ›´å¥½
```

---

## 4. âš™ï¸ npmrcé…ç½®æ–‡ä»¶ç®¡ç†


### 4.1 npmrcæ–‡ä»¶åŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯.npmrcæ–‡ä»¶ï¼Ÿ**
> `.npmrc`æ–‡ä»¶å°±åƒNPMçš„"é…ç½®æ¸…å•"ï¼Œè®°å½•äº†NPMçš„å„ç§è®¾ç½®ï¼ŒåŒ…æ‹¬é•œåƒæºã€ä»£ç†ã€è®¤è¯ä¿¡æ¯ç­‰ã€‚

```
.npmrcæ–‡ä»¶çš„å±‚çº§ç³»ç»Ÿï¼š

ç³»ç»Ÿçº§ > ç”¨æˆ·çº§ > é¡¹ç›®çº§ > ä¸´æ—¶å‘½ä»¤è¡Œå‚æ•°

/etc/npmrc (ç³»ç»Ÿçº§)
â””â”€â”€ ~/.npmrc (ç”¨æˆ·çº§)
    â””â”€â”€ project/.npmrc (é¡¹ç›®çº§)
        â””â”€â”€ npm install --registry=... (å‘½ä»¤è¡Œ)

ä¼˜å…ˆçº§ï¼šé¡¹ç›®çº§ > ç”¨æˆ·çº§ > ç³»ç»Ÿçº§
```

### 4.2 npmrcæ–‡ä»¶ä½ç½®ä¸Žä½œç”¨åŸŸ


#### ðŸ”¸ ç”¨æˆ·çº§.npmrcé…ç½®

```bash
# æŸ¥çœ‹ç”¨æˆ·çº§é…ç½®æ–‡ä»¶ä½ç½®
npm config get userconfig
# é€šå¸¸åœ¨ï¼š~/.npmrc æˆ– C:\Users\ç”¨æˆ·å\.npmrc

# ç¼–è¾‘ç”¨æˆ·çº§é…ç½®æ–‡ä»¶
npm config edit

# æˆ–ç›´æŽ¥ç¼–è¾‘æ–‡ä»¶
vim ~/.npmrc
```

**ç”¨æˆ·çº§.npmrcç¤ºä¾‹å†…å®¹ï¼š**
```ini
# è®¾ç½®é•œåƒæº
registry=https://registry.npmmirror.com

# è®¾ç½®ä½œè€…ä¿¡æ¯
init-author-name=å¼ ä¸‰
init-author-email=zhangsan@example.com

# è®¾ç½®npmå®‰è£…åŒ…çš„ä¿å­˜ç±»åž‹
save=true
save-exact=true
```

#### ðŸ”¸ é¡¹ç›®çº§.npmrcé…ç½®

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º.npmrcæ–‡ä»¶
touch .npmrc

# é¡¹ç›®çº§é…ç½®ç¤ºä¾‹
echo "registry=https://registry.npmmirror.com" > .npmrc
echo "sass_binary_site=https://npm.taobao.org/mirrors/node-sass/" >> .npmrc
```

**é¡¹ç›®çº§é…ç½®çš„ä¼˜åŠ¿ï¼š**
- **ðŸŽ¯ é¡¹ç›®ç‹¬ç«‹**ï¼šä¸å½±å“å…¶ä»–é¡¹ç›®
- **ðŸ‘¥ å›¢é˜Ÿç»Ÿä¸€**ï¼šç¡®ä¿å›¢é˜Ÿæˆå‘˜ä½¿ç”¨ç›¸åŒé…ç½®
- **ðŸ“ ç‰ˆæœ¬æŽ§åˆ¶**ï¼šå¯ä»¥æäº¤åˆ°Gitä»“åº“

### 4.3 å¸¸ç”¨.npmrcé…ç½®å‚æ•°


```ini
# ===== é•œåƒæºé…ç½® =====
registry=https://registry.npmmirror.com
sass_binary_site=https://npm.taobao.org/mirrors/node-sass/
phantomjs_cdnurl=https://npm.taobao.org/mirrors/phantomjs/
electron_mirror=https://npm.taobao.org/mirrors/electron/
chromedriver_cdnurl=https://npm.taobao.org/mirrors/chromedriver/

# ===== å®‰è£…è¡Œä¸ºé…ç½® =====
save=true                    # è‡ªåŠ¨ä¿å­˜åˆ°package.json
save-exact=true              # ä¿å­˜ç¡®åˆ‡ç‰ˆæœ¬å·
package-lock=true            # ç”Ÿæˆpackage-lock.json
prefer-offline=true          # ä¼˜å…ˆä½¿ç”¨ç¼“å­˜

# ===== ç½‘ç»œé…ç½® =====
timeout=60000                # è¶…æ—¶æ—¶é—´60ç§’
registry-timeout=30000       # é•œåƒæºè¶…æ—¶æ—¶é—´
fetch-retry-maxtimeout=60000 # é‡è¯•æœ€å¤§è¶…æ—¶æ—¶é—´

# ===== ä½œè€…ä¿¡æ¯é…ç½® =====
init-author-name=ä½ çš„åå­—
init-author-email=ä½ çš„é‚®ç®±@example.com
init-license=MIT
```

### 4.4 npmrcé…ç½®ç®¡ç†å‘½ä»¤


```bash
# æŸ¥çœ‹æ‰€æœ‰é…ç½®
npm config list

# æŸ¥çœ‹è¯¦ç»†é…ç½®ï¼ˆåŒ…æ‹¬é»˜è®¤å€¼ï¼‰
npm config list -l

# èŽ·å–ç‰¹å®šé…ç½®
npm config get registry
npm config get cache

# è®¾ç½®é…ç½®
npm config set key value

# åˆ é™¤é…ç½®
npm config delete key

# é‡ç½®æ‰€æœ‰é…ç½®åˆ°é»˜è®¤å€¼
npm config edit  # æ‰‹åŠ¨æ¸…ç©ºæ–‡ä»¶å†…å®¹
```

**é…ç½®æ–‡ä»¶å¤‡ä»½ä¸Žæ¢å¤ï¼š**
```bash
# å¤‡ä»½å½“å‰é…ç½®
cp ~/.npmrc ~/.npmrc.backup

# æ¢å¤å¤‡ä»½é…ç½®
cp ~/.npmrc.backup ~/.npmrc

# æŸ¥çœ‹é…ç½®æ–‡ä»¶å†…å®¹
cat ~/.npmrc
```

---

## 5. ðŸ”§ nrmé•œåƒæºç®¡ç†å·¥å…·


### 5.1 nrmå·¥å…·ä»‹ç»


**ä»€ä¹ˆæ˜¯nrmï¼Ÿ**
> nrm (NPM Registry Manager) æ˜¯ä¸€ä¸ªNPMé•œåƒæºç®¡ç†å·¥å…·ï¼Œå°±åƒ"é¥æŽ§å™¨"ï¼Œå¯ä»¥å¿«é€Ÿåˆ‡æ¢ä¸åŒçš„é•œåƒæºï¼Œéžå¸¸æ–¹ä¾¿ã€‚

```
ä½¿ç”¨nrmçš„å¥½å¤„ï¼š
â€¢ å¿«é€Ÿåˆ‡æ¢é•œåƒæºï¼Œä¸€æ¡å‘½ä»¤æžå®š
â€¢ æµ‹è¯•é•œåƒæºé€Ÿåº¦ï¼Œæ‰¾åˆ°æœ€å¿«çš„æº
â€¢ æ·»åŠ è‡ªå®šä¹‰é•œåƒæº
â€¢ é¿å…æ‰‹åŠ¨ä¿®æ”¹é…ç½®æ–‡ä»¶
```

### 5.2 nrmå®‰è£…ä¸ŽåŸºç¡€ä½¿ç”¨


#### ðŸ”¸ å®‰è£…nrmå·¥å…·

```bash
# å…¨å±€å®‰è£…nrm
npm install -g nrm

# éªŒè¯å®‰è£…
nrm --version

# å¦‚æžœå®‰è£…å¤±è´¥ï¼Œå¯ä»¥ä½¿ç”¨æ·˜å®é•œåƒå®‰è£…
npm install -g nrm --registry=https://registry.npmmirror.com
```

#### ðŸ”¸ nrmåŸºç¡€å‘½ä»¤

```bash
# åˆ—å‡ºæ‰€æœ‰å¯ç”¨é•œåƒæº
nrm ls

# è¾“å‡ºç¤ºä¾‹ï¼š
#   npm -------- https://registry.npmjs.org/
# * taobao ----- https://registry.npmmirror.com/
#   cnpm ------- http://r.cnpmjs.org/
#   nj --------- https://registry.nodejitsu.com/
#   rednpm ----- http://registry.mirror.cqupt.edu.cn/

# æ³¨ï¼š* è¡¨ç¤ºå½“å‰ä½¿ç”¨çš„é•œåƒæº
```

### 5.3 nrmé•œåƒæºç®¡ç†


#### ðŸ”¸ åˆ‡æ¢é•œåƒæº

```bash
# åˆ‡æ¢åˆ°æ·˜å®é•œåƒæº
nrm use taobao

# åˆ‡æ¢åˆ°npmå®˜æ–¹æº
nrm use npm

# åˆ‡æ¢åˆ°cnpmé•œåƒæº
nrm use cnpm

# éªŒè¯å½“å‰ä½¿ç”¨çš„é•œåƒæº
nrm current
npm config get registry
```

#### ðŸ”¸ æµ‹è¯•é•œåƒæºé€Ÿåº¦

```bash
# æµ‹è¯•æ‰€æœ‰é•œåƒæºçš„å“åº”é€Ÿåº¦
nrm test

# è¾“å‡ºç¤ºä¾‹ï¼š
#   npm ---- 1420ms
# * taobao - 152ms
#   cnpm --- 289ms
#   nj ----- timeout

# æµ‹è¯•ç‰¹å®šé•œåƒæº
nrm test taobao
nrm test npm
```

### 5.4 è‡ªå®šä¹‰é•œåƒæºç®¡ç†


#### ðŸ”¸ æ·»åŠ è‡ªå®šä¹‰é•œåƒæº

```bash
# æ·»åŠ å…¬å¸å†…éƒ¨é•œåƒæº
nrm add company http://npm.company.com/

# æ·»åŠ å…¶ä»–é•œåƒæº
nrm add tencent https://mirrors.cloud.tencent.com/npm/
nrm add huawei https://repo.huaweicloud.com/repository/npm/

# æŸ¥çœ‹æ·»åŠ ç»“æžœ
nrm ls
```

#### ðŸ”¸ åˆ é™¤é•œåƒæº

```bash
# åˆ é™¤è‡ªå®šä¹‰çš„é•œåƒæº
nrm del company

# åˆ é™¤ä¸éœ€è¦çš„é•œåƒæº
nrm del tencent

# æ³¨æ„ï¼šä¸èƒ½åˆ é™¤å†…ç½®çš„é•œåƒæºï¼ˆnpmã€taobaoç­‰ï¼‰
```

### 5.5 nrmé«˜çº§åŠŸèƒ½


```bash
# æŸ¥çœ‹é•œåƒæºè¯¦ç»†ä¿¡æ¯
nrm show taobao

# ä¸´æ—¶ä½¿ç”¨æŸä¸ªé•œåƒæºï¼ˆä¸æ”¹å˜å…¨å±€é…ç½®ï¼‰
nrm exec taobao npm install express

# æ‰“å¼€é•œåƒæºç½‘ç«™ï¼ˆå¦‚æžœé…ç½®äº†homeå­—æ®µï¼‰
nrm home taobao
```

**nrmé…ç½®æ–‡ä»¶ä½ç½®ï¼š**
```bash
# nrmé…ç½®æ–‡ä»¶é€šå¸¸åœ¨ç”¨æˆ·ç›®å½•ä¸‹
~/.nrmrc

# æ‰‹åŠ¨ç¼–è¾‘é…ç½®æ–‡ä»¶
{
  "registry": "taobao",
  "registries": {
    "npm": {
      "home": "https://www.npmjs.org",
      "registry": "https://registry.npmjs.org/"
    },
    "taobao": {
      "home": "https://npmmirror.com",
      "registry": "https://registry.npmmirror.com/"
    }
  }
}
```

---

## 6. ðŸ” NPMä»£ç†é…ç½®å‚æ•°


### 6.1 ä»£ç†é…ç½®åŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ—¶å€™éœ€è¦é…ç½®ä»£ç†ï¼Ÿ**
> å½“ä½ åœ¨å…¬å¸å†…ç½‘æˆ–æœ‰ç½‘ç»œé™åˆ¶çš„çŽ¯å¢ƒä¸­æ—¶ï¼Œéœ€è¦é€šè¿‡ä»£ç†æœåŠ¡å™¨è®¿é—®å¤–ç½‘ã€‚å°±åƒåŽ»å›½å¤–éœ€è¦é€šè¿‡"ä¸­è½¬ç«™"ä¸€æ ·ã€‚

```
ç›´æŽ¥è®¿é—® vs ä»£ç†è®¿é—®ï¼š

ç›´æŽ¥è®¿é—®ï¼š
ä½ çš„ç”µè„‘ â†’ äº’è”ç½‘ â†’ NPMæœåŠ¡å™¨

ä»£ç†è®¿é—®ï¼š
ä½ çš„ç”µè„‘ â†’ å…¬å¸ä»£ç†æœåŠ¡å™¨ â†’ äº’è”ç½‘ â†’ NPMæœåŠ¡å™¨
              â†‘
         èº«ä»½éªŒè¯ã€è®¿é—®æŽ§åˆ¶
```

### 6.2 HTTPä»£ç†é…ç½®


#### ðŸ”¸ åŸºç¡€HTTPä»£ç†è®¾ç½®

```bash
# è®¾ç½®HTTPä»£ç†
npm config set proxy http://proxy.company.com:8080

# è®¾ç½®HTTPSä»£ç†
npm config set https-proxy http://proxy.company.com:8080

# æŸ¥çœ‹ä»£ç†é…ç½®
npm config get proxy
npm config get https-proxy
```

#### ðŸ”¸ å¸¦è®¤è¯çš„ä»£ç†é…ç½®

```bash
# å¸¦ç”¨æˆ·åå¯†ç çš„ä»£ç†é…ç½®
npm config set proxy http://username:password@proxy.company.com:8080
npm config set https-proxy http://username:password@proxy.company.com:8080

# å¯†ç ä¸­æœ‰ç‰¹æ®Šå­—ç¬¦æ—¶éœ€è¦URLç¼–ç 
# ä¾‹å¦‚ï¼šå¯†ç æ˜¯"pass@123"ï¼Œéœ€è¦ç¼–ç ä¸º"pass%40123"
npm config set proxy http://user:pass%40123@proxy.company.com:8080
```

### 6.3 ä»£ç†ä¾‹å¤–é…ç½®


```bash
# è®¾ç½®ä¸ä½¿ç”¨ä»£ç†çš„åœ°å€ï¼ˆå†…ç½‘åœ°å€ï¼‰
npm config set no-proxy localhost,127.0.0.1,*.company.com,10.*

# æŸ¥çœ‹ä»£ç†ä¾‹å¤–é…ç½®
npm config get no-proxy

# ç¤ºä¾‹é…ç½®è§£é‡Šï¼š
# localhost      - æœ¬åœ°åœ°å€
# 127.0.0.1      - æœ¬åœ°å›žçŽ¯åœ°å€
# *.company.com  - å…¬å¸å†…ç½‘åŸŸå
# 10.*           - 10å¼€å¤´çš„å†…ç½‘IPæ®µ
```

### 6.4 SOCKSä»£ç†é…ç½®


```bash
# è®¾ç½®SOCKS5ä»£ç†ï¼ˆéœ€è¦é¢å¤–å·¥å…·æ”¯æŒï¼‰
npm config set proxy socks5://127.0.0.1:1080
npm config set https-proxy socks5://127.0.0.1:1080

# æˆ–è€…ä½¿ç”¨çŽ¯å¢ƒå˜é‡æ–¹å¼
export HTTP_PROXY=socks5://127.0.0.1:1080
export HTTPS_PROXY=socks5://127.0.0.1:1080
npm install
```

### 6.5 ä»£ç†é—®é¢˜è¯Šæ–­


**å¸¸è§ä»£ç†é—®é¢˜åŠè§£å†³æ–¹æ¡ˆï¼š**

#### ðŸ”¸ è¿žæŽ¥è¶…æ—¶é—®é¢˜

```bash
# å¢žåŠ è¶…æ—¶æ—¶é—´
npm config set timeout 300000        # 5åˆ†é’Ÿ
npm config set registry-timeout 300000

# æµ‹è¯•ä»£ç†è¿žé€šæ€§
curl -x http://proxy.company.com:8080 https://registry.npmjs.org
```

#### ðŸ”¸ SSLè¯ä¹¦é—®é¢˜

```bash
# è·³è¿‡SSLéªŒè¯ï¼ˆä»…ç”¨äºŽæµ‹è¯•ï¼Œä¸æŽ¨èç”Ÿäº§ä½¿ç”¨ï¼‰
npm config set strict-ssl false

# æˆ–è€…è®¾ç½®è‡ªå®šä¹‰CAè¯ä¹¦
npm config set ca /path/to/ca-cert.pem
```

#### ðŸ”¸ ä»£ç†è®¤è¯é—®é¢˜

```bash
# æ£€æŸ¥ä»£ç†è®¤è¯
# å¦‚æžœç”¨æˆ·åæˆ–å¯†ç ä¸­æœ‰ç‰¹æ®Šå­—ç¬¦ï¼Œéœ€è¦è¿›è¡ŒURLç¼–ç 

ç‰¹æ®Šå­—ç¬¦ç¼–ç è¡¨ï¼š
@ â†’ %40
: â†’ %3A
/ â†’ %2F
? â†’ %3F
# â†’ %23
```

### 6.6 ä¼ä¸šçŽ¯å¢ƒä»£ç†æœ€ä½³å®žè·µ


```bash
# ä¼ä¸šçŽ¯å¢ƒå®Œæ•´é…ç½®ç¤ºä¾‹
npm config set registry https://registry.npmmirror.com
npm config set proxy http://user:pass@proxy.company.com:8080
npm config set https-proxy http://user:pass@proxy.company.com:8080
npm config set no-proxy localhost,127.0.0.1,*.company.local,10.*,192.168.*
npm config set strict-ssl false
npm config set timeout 300000
```

**çŽ¯å¢ƒå˜é‡æ–¹å¼é…ç½®ï¼š**
```bash
# åœ¨~/.bashrcæˆ–~/.zshrcä¸­æ·»åŠ 
export HTTP_PROXY=http://proxy.company.com:8080
export HTTPS_PROXY=http://proxy.company.com:8080
export NO_PROXY=localhost,127.0.0.1,*.company.com

# é‡æ–°åŠ è½½é…ç½®
source ~/.bashrc
```

---

## 7. âš¡ Node.jsåŒ…ç®¡ç†åŠ é€Ÿ


### 7.1 åŒ…ç®¡ç†åŠ é€ŸåŸºæœ¬ç­–ç•¥


**Node.jsåŒ…ç®¡ç†æ…¢åœ¨å“ªé‡Œï¼Ÿ**
```
åŒ…å®‰è£…è¿‡ç¨‹åˆ†æžï¼š
1. è§£æžä¾èµ–å…³ç³» (10%)    â† åˆ†æžpackage.json
2. ä¸‹è½½åŒ…æ–‡ä»¶ (70%)      â† ä¸»è¦ç“¶é¢ˆï¼šç½‘ç»œä¸‹è½½
3. è§£åŽ‹å®‰è£…åŒ… (15%)      â† ç£ç›˜IOæ“ä½œ  
4. æ‰§è¡Œå®‰è£…è„šæœ¬ (5%)     â† è¿è¡Œpostinstallç­‰è„šæœ¬

ä¼˜åŒ–é‡ç‚¹ï¼šç½‘ç»œä¸‹è½½çŽ¯èŠ‚ï¼ˆ70%çš„æ—¶é—´ï¼‰
```

### 7.2 ç¼“å­˜æœºåˆ¶ä¼˜åŒ–


#### ðŸ”¸ NPMç¼“å­˜ç®¡ç†

```bash
# æŸ¥çœ‹ç¼“å­˜ç›®å½•
npm config get cache

# æŸ¥çœ‹ç¼“å­˜å¤§å°
npm cache verify

# æ¸…ç†ç¼“å­˜ï¼ˆè°¨æ…Žä½¿ç”¨ï¼‰
npm cache clean --force

# è®¾ç½®è‡ªå®šä¹‰ç¼“å­˜ç›®å½•
npm config set cache /path/to/npm-cache
```

**ç¼“å­˜å·¥ä½œåŽŸç†ï¼š**
```
é¦–æ¬¡å®‰è£…åŒ…ï¼š
npm install express
â”œâ”€â”€ ä¸‹è½½expressåŒ…
â”œâ”€â”€ å­˜å‚¨åˆ°æœ¬åœ°ç¼“å­˜
â””â”€â”€ å®‰è£…åˆ°node_modules

å†æ¬¡å®‰è£…ç›¸åŒç‰ˆæœ¬ï¼š
npm install express  
â”œâ”€â”€ æ£€æŸ¥æœ¬åœ°ç¼“å­˜
â”œâ”€â”€ å‘çŽ°ç¼“å­˜å­˜åœ¨
â””â”€â”€ ç›´æŽ¥ä»Žç¼“å­˜å®‰è£…ï¼ˆå¿«10å€ä»¥ä¸Šï¼‰
```

#### ðŸ”¸ Yarnç¼“å­˜ä¼˜åŠ¿

```bash
# Yarnçš„ç¼“å­˜ç®¡ç†
yarn cache list          # æŸ¥çœ‹ç¼“å­˜çš„åŒ…
yarn cache dir           # æŸ¥çœ‹ç¼“å­˜ç›®å½•
yarn cache clean         # æ¸…ç†ç¼“å­˜

# Yarnç¼“å­˜çš„ä¼˜åŠ¿ï¼š
âœ… å…¨å±€ç¼“å­˜ï¼Œå¤šé¡¹ç›®å…±äº«
âœ… ç¦»çº¿å®‰è£…æ”¯æŒ
âœ… æ›´æ™ºèƒ½çš„ç¼“å­˜ç­–ç•¥
```

### 7.3 å¹¶å‘ä¸‹è½½ä¼˜åŒ–


```bash
# NPMå¹¶å‘ä¸‹è½½é…ç½®
npm config set maxsockets 10        # æœ€å¤§å¹¶å‘è¿žæŽ¥æ•°
npm config set registry-timeout 30000  # å•ä¸ªè¯·æ±‚è¶…æ—¶æ—¶é—´

# Yarnå¹¶å‘é…ç½®
yarn config set network-concurrency 8  # å¹¶å‘ä¸‹è½½æ•°é‡
```

**å¹¶å‘ä¸‹è½½æ•ˆæžœå¯¹æ¯”ï¼š**
```
å•çº¿ç¨‹ä¸‹è½½ï¼š
åŒ…A â†’ åŒ…B â†’ åŒ…C â†’ åŒ…D
æ€»æ—¶é—´ï¼š4 Ã— å¹³å‡ä¸‹è½½æ—¶é—´

å¹¶å‘ä¸‹è½½ï¼š
åŒ…A â”
åŒ…B â”œâ”€â”€ åŒæ—¶ä¸‹è½½
åŒ…C â”œâ”€â”€ 
åŒ…D â”˜
æ€»æ—¶é—´ï¼šmax(åŒ…A, åŒ…B, åŒ…C, åŒ…Dçš„ä¸‹è½½æ—¶é—´)
```

### 7.4 ä¾èµ–ä¼˜åŒ–ç­–ç•¥


#### ðŸ”¸ package.jsonä¼˜åŒ–

```json
{
  "name": "my-project",
  "dependencies": {
    "express": "^4.18.0",
    "lodash": "^4.17.21"
  },
  "devDependencies": {
    "eslint": "^8.0.0",
    "jest": "^28.0.0"
  },
  "engines": {
    "node": ">=16.0.0",
    "npm": ">=8.0.0"
  }
}
```

**ç‰ˆæœ¬å·ç­–ç•¥ï¼š**
```
ç‰ˆæœ¬å·ç±»åž‹è¯´æ˜Žï¼š
"express": "4.18.0"     # ç²¾ç¡®ç‰ˆæœ¬ï¼ˆæœ€å¿«ï¼‰
"express": "~4.18.0"    # è¡¥ä¸ç‰ˆæœ¬èŒƒå›´
"express": "^4.18.0"    # æ¬¡è¦ç‰ˆæœ¬èŒƒå›´
"express": "latest"     # æœ€æ–°ç‰ˆæœ¬ï¼ˆæœ€æ…¢ï¼‰

æŽ¨èç­–ç•¥ï¼š
ç”Ÿäº§ä¾èµ–ï¼šä½¿ç”¨ç²¾ç¡®ç‰ˆæœ¬å·
å¼€å‘ä¾èµ–ï¼šå¯ä»¥ä½¿ç”¨èŒƒå›´ç‰ˆæœ¬å·
```

#### ðŸ”¸ é”æ–‡ä»¶çš„é‡è¦æ€§

```bash
# ç¡®ä¿ä½¿ç”¨é”æ–‡ä»¶å®‰è£…
npm ci                    # åŸºäºŽpackage-lock.jsonå®‰è£…
yarn install --frozen-lockfile  # åŸºäºŽyarn.lockå®‰è£…

# é”æ–‡ä»¶çš„ä¼˜åŠ¿ï¼š
âœ… å®‰è£…é€Ÿåº¦å¿«ï¼ˆè·³è¿‡ä¾èµ–è§£æžï¼‰
âœ… ç‰ˆæœ¬ä¸€è‡´æ€§ï¼ˆç¡®ä¿å›¢é˜Ÿä½¿ç”¨ç›¸åŒç‰ˆæœ¬ï¼‰
âœ… å®‰å…¨æ€§å¥½ï¼ˆé¿å…æ„å¤–çš„ç‰ˆæœ¬å‡çº§ï¼‰
```

### 7.5 äºŒè¿›åˆ¶åŒ…åŠ é€Ÿé…ç½®


**å¸¸è§äºŒè¿›åˆ¶åŒ…çš„é•œåƒé…ç½®ï¼š**
```bash
# node-sassé•œåƒé…ç½®
npm config set sass_binary_site https://npm.taobao.org/mirrors/node-sass/

# Electroné•œåƒé…ç½®  
npm config set electron_mirror https://npm.taobao.org/mirrors/electron/
npm config set electron_cache_dir /path/to/electron-cache

# Puppeteeré•œåƒé…ç½®
npm config set puppeteer_download_host https://npm.taobao.org/mirrors
```

**é€šè¿‡.npmrcæ–‡ä»¶ç»Ÿä¸€é…ç½®ï¼š**
```ini
# äºŒè¿›åˆ¶åŒ…é•œåƒé…ç½®
sass_binary_site=https://npm.taobao.org/mirrors/node-sass/
phantomjs_cdnurl=https://npm.taobao.org/mirrors/phantomjs/
electron_mirror=https://npm.taobao.org/mirrors/electron/
chromedriver_cdnurl=https://npm.taobao.org/mirrors/chromedriver/
puppeteer_download_host=https://npm.taobao.org/mirrors
```

### 7.6 ä¼ä¸šçº§åŠ é€Ÿæ–¹æ¡ˆ


#### ðŸ”¸ ä¼ä¸šå†…ç½‘npmç¼“å­˜æœåŠ¡å™¨

```bash
# ä½¿ç”¨verdaccioæ­å»ºä¼ä¸šnpmç¼“å­˜
npm install -g verdaccio

# å¯åŠ¨æœåŠ¡
verdaccio

# å®¢æˆ·ç«¯é…ç½®
npm config set registry http://your-company-npm-server:4873
```

**ä¼ä¸šç¼“å­˜çš„ä¼˜åŠ¿ï¼š**
- **ðŸ¢ å†…ç½‘åŠ é€Ÿ**ï¼šå®Œå…¨åœ¨å†…ç½‘ä¼ è¾“ï¼Œé€Ÿåº¦æžå¿«
- **ðŸ“¦ ç¦»çº¿å¯ç”¨**ï¼šæ–­ç½‘æ—¶ä»èƒ½å®‰è£…å·²ç¼“å­˜çš„åŒ…
- **ðŸ”’ å®‰å…¨æŽ§åˆ¶**ï¼šå¯ä»¥è¿‡æ»¤å’Œå®¡æ ¸åŒ…çš„å†…å®¹
- **ðŸ’¾ èŠ‚çœå¸¦å®½**ï¼šå‡å°‘é‡å¤ä¸‹è½½ï¼ŒèŠ‚çœå¤–ç½‘å¸¦å®½

---

## 8. ðŸ—ï¸ ç§æœ‰NPMæºæ­å»º


### 8.1 ç§æœ‰NPMæºåŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯ç§æœ‰NPMæºï¼Ÿ**
> ç§æœ‰NPMæºå°±åƒå…¬å¸çš„"å†…éƒ¨å›¾ä¹¦é¦†"ï¼Œå­˜æ”¾å…¬å¸å†…éƒ¨å¼€å‘çš„åŒ…ï¼Œæ—¢å¯ä»¥æ–¹ä¾¿å†…éƒ¨å…±äº«ä»£ç ï¼Œåˆèƒ½ä¿æŠ¤å•†ä¸šæœºå¯†ã€‚

```
ç§æœ‰NPMæºçš„å…¸åž‹æž¶æž„ï¼š

å¼€å‘å›¢é˜ŸA â”€â”€â”
å¼€å‘å›¢é˜ŸB â”€â”€â”¤â”€â”€ å‘å¸ƒ â”€â”€â†’ ç§æœ‰NPMæº â”€â”€â† å®‰è£… â”€â”€â”¬â”€â”€ é¡¹ç›®X
å¼€å‘å›¢é˜ŸC â”€â”€â”˜                                   â”œâ”€â”€ é¡¹ç›®Y
                                               â””â”€â”€ é¡¹ç›®Z

åŠŸèƒ½ç‰¹ç‚¹ï¼š
â€¢ å†…ç½‘é«˜é€Ÿè®¿é—®
â€¢ æƒé™æŽ§åˆ¶ç®¡ç†
â€¢ ç‰ˆæœ¬åŽ†å²è¿½è¸ª  
â€¢ ä¸Žå…¬å…±æºæ··åˆä½¿ç”¨
```

### 8.2 Verdaccioæ­å»ºç§æœ‰æº


#### ðŸ”¸ VerdaccioåŸºç¡€å®‰è£…

```bash
# å…¨å±€å®‰è£…verdaccio
npm install -g verdaccio

# å¯åŠ¨æœåŠ¡
verdaccio

# è¾“å‡ºä¿¡æ¯ï¼š
#  warn --- config file  - /home/user/.config/verdaccio/config.yaml
#  warn --- Plugin successfully loaded: verdaccio-htpasswd
#  warn --- http address - http://localhost:4873/ - verdaccio/5.0.0
```

#### ðŸ”¸ Verdaccioé…ç½®æ–‡ä»¶

é»˜è®¤é…ç½®æ–‡ä»¶ä½ç½®ï¼š`~/.config/verdaccio/config.yaml`

```yaml
# åŸºç¡€é…ç½®ç¤ºä¾‹
storage: /home/verdaccio/storage      # åŒ…å­˜å‚¨ç›®å½•
auth:
  htpasswd:
    file: /home/verdaccio/htpasswd    # ç”¨æˆ·è®¤è¯æ–‡ä»¶
    max_users: 1000                   # æœ€å¤§ç”¨æˆ·æ•°

uplinks:
  npmjs:
    url: https://registry.npmjs.org/  # ä¸Šæ¸¸é•œåƒæº
  taobao:
    url: https://registry.npmmirror.com/

packages:
  '@company/*':                       # å…¬å¸å†…éƒ¨åŒ…
    access: $authenticated            # éœ€è¦è®¤è¯æ‰èƒ½è®¿é—®
    publish: $authenticated           # éœ€è¦è®¤è¯æ‰èƒ½å‘å¸ƒ
    unpublish: $authenticated
    proxy: npmjs

  '**':                              # å…¶ä»–æ‰€æœ‰åŒ…
    access: $all                     # æ‰€æœ‰äººå¯ä»¥è®¿é—®
    publish: $authenticated          # éœ€è¦è®¤è¯æ‰èƒ½å‘å¸ƒ
    proxy: taobao npmjs              # ä»£ç†åˆ°å¤–éƒ¨æº

listen: 0.0.0.0:4873                # ç›‘å¬åœ°å€å’Œç«¯å£
```

### 8.3 ç”¨æˆ·ç®¡ç†ä¸Žæƒé™æŽ§åˆ¶


#### ðŸ”¸ ç”¨æˆ·æ³¨å†Œä¸Žç™»å½•

```bash
# è®¾ç½®npm registryåˆ°ç§æœ‰æº
npm config set registry http://your-server:4873

# æ³¨å†Œæ–°ç”¨æˆ·
npm adduser
# è¾“å…¥ç”¨æˆ·åã€å¯†ç ã€é‚®ç®±

# æˆ–è€…ç™»å½•å·²æœ‰ç”¨æˆ·
npm login

# æŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·
npm whoami
```

#### ðŸ”¸ å‘å¸ƒç§æœ‰åŒ…

```bash
# åˆå§‹åŒ–ä¸€ä¸ªç§æœ‰åŒ…é¡¹ç›®
mkdir my-company-utils
cd my-company-utils
npm init

# ä¿®æ”¹package.json
{
  "name": "@company/utils",           # ä½¿ç”¨å…¬å¸scope
  "version": "1.0.0",
  "description": "Company utilities",
  "main": "index.js",
  "private": false                    # å…è®¸å‘å¸ƒ
}

# å‘å¸ƒåŒ…åˆ°ç§æœ‰æº
npm publish

# å®‰è£…ç§æœ‰åŒ…
npm install @company/utils
```

### 8.4 é«˜å¯ç”¨éƒ¨ç½²æ–¹æ¡ˆ


#### ðŸ”¸ Dockeréƒ¨ç½²Verdaccio

```bash
# åˆ›å»ºå­˜å‚¨ç›®å½•
mkdir -p /opt/verdaccio/storage
mkdir -p /opt/verdaccio/config

# åˆ›å»ºé…ç½®æ–‡ä»¶
cat > /opt/verdaccio/config/config.yaml << 'EOF'
storage: /verdaccio/storage
auth:
  htpasswd:
    file: /verdaccio/conf/htpasswd
uplinks:
  npmjs:
    url: https://registry.npmjs.org/
packages:
  '**':
    access: $all
    publish: $authenticated
    proxy: npmjs
listen: 0.0.0.0:4873
EOF

# å¯åŠ¨Dockerå®¹å™¨
docker run -d \
  --name verdaccio \
  -p 4873:4873 \
  -v /opt/verdaccio/storage:/verdaccio/storage \
  -v /opt/verdaccio/config:/verdaccio/conf \
  verdaccio/verdaccio
```

#### ðŸ”¸ Nginxåå‘ä»£ç†é…ç½®

```nginx
server {
    listen 80;
    server_name npm.company.com;
    
    location / {
        proxy_pass http://127.0.0.1:4873;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # NPMå®¢æˆ·ç«¯éœ€è¦çš„ç‰¹æ®Šé…ç½®
        proxy_set_header X-NpmOrg-RemoteAddress $remote_addr;
        proxy_max_temp_file_size 0;
        proxy_buffering off;
    }
}
```

### 8.5 ç§æœ‰æºç®¡ç†æœ€ä½³å®žè·µ


**åŒ…å‘½åè§„èŒƒï¼š**
```json
{
  "name": "@company/component-name",     // ä½¿ç”¨å…¬å¸scope
  "version": "1.0.0",
  "description": "Clear description",
  "keywords": ["company", "internal"],
  "repository": {
    "type": "git",
    "url": "http://git.company.com/npm/component-name"
  }
}
```

**ç‰ˆæœ¬å‘å¸ƒæµç¨‹ï¼š**
```bash
# å¼€å‘å®ŒæˆåŽçš„å‘å¸ƒæµç¨‹
npm version patch          # æ›´æ–°ç‰ˆæœ¬å·
npm run test              # è¿è¡Œæµ‹è¯•
npm run build             # æž„å»ºä»£ç 
npm publish               # å‘å¸ƒåˆ°ç§æœ‰æº

# å›¢é˜Ÿå®‰è£…ç§æœ‰åŒ…
npm install @company/component-name
```

**å¤‡ä»½ä¸Žæ¢å¤ï¼š**
```bash
# å¤‡ä»½å­˜å‚¨ç›®å½•
tar -czf verdaccio-backup-$(date +%Y%m%d).tar.gz /opt/verdaccio/storage

# å¤‡ä»½é…ç½®æ–‡ä»¶
cp /opt/verdaccio/config/config.yaml config-backup.yaml

# æ¢å¤æ•°æ®
tar -xzf verdaccio-backup-20241201.tar.gz -C /
```

---

## 9. ðŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŽŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ðŸ”¸ é•œåƒæºæ¦‚å¿µï¼šç†è§£é•œåƒæºçš„ä½œç”¨å’Œå·¥ä½œåŽŸç†
ðŸ”¸ æ·˜å®é•œåƒï¼šå›½å†…æœ€ç¨³å®šçš„NPMé•œåƒæºé€‰æ‹©
ðŸ”¸ é…ç½®ç®¡ç†ï¼š.npmrcæ–‡ä»¶çš„å±‚çº§å’Œä¼˜å…ˆçº§
ðŸ”¸ ä»£ç†è®¾ç½®ï¼šä¼ä¸šçŽ¯å¢ƒä¸‹çš„ç½‘ç»œä»£ç†é…ç½®
ðŸ”¸ ç¼“å­˜æœºåˆ¶ï¼šåˆ©ç”¨ç¼“å­˜æœºåˆ¶åŠ é€ŸåŒ…å®‰è£…
ðŸ”¸ å·¥å…·ä½¿ç”¨ï¼šnrmç­‰å·¥å…·çš„å®žé™…åº”ç”¨ä»·å€¼
ðŸ”¸ ç§æœ‰æºï¼šä¼ä¸šçº§ç§æœ‰NPMæºçš„æ­å»ºå’Œç®¡ç†
```

### 9.2 å…³é”®é…ç½®é€ŸæŸ¥è¡¨


**ðŸ”¹ å¸¸ç”¨é•œåƒæºåœ°å€**
```
æ·˜å®é•œåƒï¼šhttps://registry.npmmirror.com
åŽä¸ºé•œåƒï¼šhttps://repo.huaweicloud.com/repository/npm/
è…¾è®¯é•œåƒï¼šhttps://mirrors.cloud.tencent.com/npm/
å®˜æ–¹æºï¼š  https://registry.npmjs.org
```

**ðŸ”¹ å¿«é€Ÿé…ç½®å‘½ä»¤**
```bash
# è®¾ç½®æ·˜å®é•œåƒ
npm config set registry https://registry.npmmirror.com

# å®‰è£…nrmå¹¶åˆ‡æ¢æº
npm install -g nrm
nrm use taobao

# æµ‹è¯•é•œåƒæºé€Ÿåº¦
nrm test

# æ¢å¤å®˜æ–¹æº
npm config set registry https://registry.npmjs.org
```

**ðŸ”¹ ä¼ä¸šçŽ¯å¢ƒé…ç½®**
```bash
# ä»£ç† + é•œåƒæº + è¶…æ—¶é…ç½®
npm config set registry https://registry.npmmirror.com
npm config set proxy http://user:pass@proxy.company.com:8080
npm config set https-proxy http://user:pass@proxy.company.com:8080
npm config set timeout 300000
```

### 9.3 é—®é¢˜è¯Šæ–­æŒ‡å—


**ðŸ”§ å¸¸è§é—®é¢˜å¿«é€Ÿè§£å†³**

| é—®é¢˜çŽ°è±¡ | **å¯èƒ½åŽŸå› ** | **è§£å†³æ–¹æ¡ˆ** |
|---------|-------------|-------------|
| `å®‰è£…é€Ÿåº¦æ…¢` | ä½¿ç”¨å®˜æ–¹æº | åˆ‡æ¢åˆ°æ·˜å®é•œåƒæº |
| `è¿žæŽ¥è¶…æ—¶` | ç½‘ç»œæˆ–ä»£ç†é—®é¢˜ | æ£€æŸ¥ä»£ç†é…ç½®ï¼Œå¢žåŠ è¶…æ—¶æ—¶é—´ |
| `æƒé™é”™è¯¯` | è®¤è¯é—®é¢˜ | æ‰§è¡Œ`npm login`é‡æ–°ç™»å½• |
| `åŒ…æ‰¾ä¸åˆ°` | é•œåƒæºåŒæ­¥å»¶è¿Ÿ | ç­‰å¾…åŒæ­¥æˆ–ä¸´æ—¶åˆ‡æ¢åˆ°å®˜æ–¹æº |
| `SSLé”™è¯¯` | è¯ä¹¦é—®é¢˜ | è®¾ç½®`strict-ssl=false`ï¼ˆä»…æµ‹è¯•ç”¨ï¼‰ |

### 9.4 æœ€ä½³å®žè·µæ€»ç»“


**ðŸŽ¯ ä¸ªäººå¼€å‘çŽ¯å¢ƒé…ç½®**
```bash
# æŽ¨èçš„ä¸ªäººé…ç½®
npm install -g nrm
nrm use taobao
npm config set save-exact true
npm config set package-lock true
```

**ðŸŽ¯ ä¼ä¸šå›¢é˜ŸçŽ¯å¢ƒé…ç½®**
```bash
# å›¢é˜Ÿç»Ÿä¸€é…ç½®æ–‡ä»¶ï¼ˆé¡¹ç›®æ ¹ç›®å½•.npmrcï¼‰
registry=https://registry.npmmirror.com
save-exact=true
package-lock=true
sass_binary_site=https://npm.taobao.org/mirrors/node-sass/
electron_mirror=https://npm.taobao.org/mirrors/electron/
```

**ðŸŽ¯ ç§æœ‰åŒ…å‘å¸ƒæµç¨‹**
```bash
# ç§æœ‰åŒ…å¼€å‘å‘å¸ƒæµç¨‹
npm init                    # åˆå§‹åŒ–é¡¹ç›®
npm adduser                # æ³¨å†Œç”¨æˆ·
npm version patch          # æ›´æ–°ç‰ˆæœ¬
npm publish                # å‘å¸ƒåŒ…
```

### 9.5 è¿›é˜¶æŠ€å·§ä¸Žæ³¨æ„äº‹é¡¹


**âš¡ æ€§èƒ½ä¼˜åŒ–æŠ€å·§**
- ä½¿ç”¨`npm ci`ä»£æ›¿`npm install`ï¼ˆCIçŽ¯å¢ƒï¼‰
- åˆç†ä½¿ç”¨ç¼“å­˜ï¼Œå®šæœŸæ¸…ç†æ— ç”¨ç¼“å­˜
- ä½¿ç”¨YarnèŽ·å¾—æ›´å¥½çš„å®‰è£…æ€§èƒ½
- ä¸ºäºŒè¿›åˆ¶åŒ…é…ç½®å›½å†…é•œåƒæº

**âš ï¸ å®‰å…¨æ³¨æ„äº‹é¡¹**
- ä¸è¦åœ¨å…¬å…±ä»“åº“æäº¤åŒ…å«å¯†ç çš„.npmrcæ–‡ä»¶
- ç§æœ‰åŒ…è¦è®¾ç½®é€‚å½“çš„è®¿é—®æƒé™
- å®šæœŸæ›´æ–°ä¾èµ–åŒ…ï¼Œä¿®å¤å®‰å…¨æ¼æ´ž
- ä¼ä¸šçŽ¯å¢ƒè¦ä½¿ç”¨HTTPSå’Œè®¤è¯

**ðŸ”„ ç‰ˆæœ¬ç®¡ç†å»ºè®®**
- ç”Ÿäº§çŽ¯å¢ƒä½¿ç”¨ç²¾ç¡®ç‰ˆæœ¬å·
- å¼€å‘çŽ¯å¢ƒå¯ä»¥ä½¿ç”¨èŒƒå›´ç‰ˆæœ¬å·
- é‡è¦é¡¹ç›®è¦é”å®šä¾èµ–ç‰ˆæœ¬
- å®šæœŸå®¡æŸ¥å’Œæ›´æ–°è¿‡æ—¶ä¾èµ–

**æ ¸å¿ƒè®°å¿†è¦ç‚¹ï¼š**
- é•œåƒæºè§£å†³é€Ÿåº¦é—®é¢˜ï¼Œä»£ç†è§£å†³è®¿é—®é—®é¢˜
- nrmè®©é•œåƒæºç®¡ç†å˜å¾—ç®€å•é«˜æ•ˆ
- .npmrcæ–‡ä»¶æ˜¯é…ç½®ç®¡ç†çš„æ ¸å¿ƒ
- ä¼ä¸šçŽ¯å¢ƒéœ€è¦è€ƒè™‘å®‰å…¨æ€§å’Œç§æœ‰æ€§
- ç¼“å­˜å’Œå¹¶å‘æ˜¯æå‡æ€§èƒ½çš„å…³é”®æ‰‹æ®µ