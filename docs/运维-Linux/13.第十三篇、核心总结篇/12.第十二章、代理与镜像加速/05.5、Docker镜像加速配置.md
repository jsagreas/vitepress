---
title: 5ã€Dockeré•œåƒåŠ é€Ÿé…ç½®
---
## ğŸ“š ç›®å½•

1. [Dockeré•œåƒåŠ é€Ÿæ¦‚è¿°](#1-Dockeré•œåƒåŠ é€Ÿæ¦‚è¿°)
2. [å›½å†…é•œåƒåŠ é€Ÿå™¨é…ç½®](#2-å›½å†…é•œåƒåŠ é€Ÿå™¨é…ç½®)
3. [Dockerä»£ç†é…ç½®](#3-Dockerä»£ç†é…ç½®)
4. [ç§æœ‰é•œåƒä»“åº“é…ç½®](#4-ç§æœ‰é•œåƒä»“åº“é…ç½®)
5. [é•œåƒç¼“å­˜ç­–ç•¥ä¸ä¼˜åŒ–](#5-é•œåƒç¼“å­˜ç­–ç•¥ä¸ä¼˜åŒ–)
6. [å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ](#6-å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ³ Dockeré•œåƒåŠ é€Ÿæ¦‚è¿°


### 1.1 ä¸ºä»€ä¹ˆéœ€è¦é•œåƒåŠ é€Ÿ


**ç°å®é—®é¢˜**ï¼šå°±åƒç½‘è´­æ—¶å•†å“ä»å›½å¤–å‘è´§å¾ˆæ…¢ä¸€æ ·ï¼ŒDockerä»å®˜æ–¹ä»“åº“ä¸‹è½½é•œåƒä¹Ÿä¼šé‡åˆ°ç½‘ç»œç“¶é¢ˆ

```
é—®é¢˜åœºæ™¯ï¼š
ç”¨æˆ·ä½ç½®ï¼šä¸­å›½å¤§é™†
Docker Hubï¼šä½äºç¾å›½
ç½‘ç»œè·¯å¾„ï¼šä¸­å›½ â†’ æµ·å¤– â†’ Docker Hub

ç»“æœï¼š
â€¢ ä¸‹è½½é€Ÿåº¦æ…¢ï¼ˆå‡ KB/sï¼‰
â€¢ ç»å¸¸è¿æ¥è¶…æ—¶
â€¢ å½±å“å¼€å‘æ•ˆç‡
```

**Docker Hubå®˜æ–¹é•œåƒä»“åº“**ï¼š
- **å®šä¹‰**ï¼šDockerå®˜æ–¹æä¾›çš„å…¬å…±é•œåƒä»“åº“
- **åœ°å€**ï¼š`docker.io`ï¼ˆé»˜è®¤ä»“åº“ï¼‰
- **é—®é¢˜**ï¼šå›½å†…è®¿é—®é€Ÿåº¦æ…¢ï¼Œç»å¸¸è¶…æ—¶
- **è§£å†³æ€è·¯**ï¼šä½¿ç”¨å›½å†…é•œåƒç«™ä½œä¸º"ä¸­è½¬ç«™"

### 1.2 é•œåƒåŠ é€Ÿçš„å·¥ä½œåŸç†


**é•œåƒåŠ é€Ÿå™¨**å°±åƒå¿«é€’ä»£æ”¶ç‚¹ï¼Œå¸®ä½ å°±è¿‘å–è´§ï¼š

```
ä¼ ç»Ÿæ¨¡å¼ï¼š
å¼€å‘è€… â†’ ç›´æ¥è®¿é—®Docker Hub â†’ ä¸‹è½½é•œåƒï¼ˆæ…¢ï¼‰

åŠ é€Ÿæ¨¡å¼ï¼š
å¼€å‘è€… â†’ å›½å†…é•œåƒç«™ â†’ é•œåƒæ•°æ® â†’ å¿«é€Ÿä¸‹è½½
           â†“
    å®šæœŸåŒæ­¥Docker Hubæœ€æ–°é•œåƒ
```

**æ ¸å¿ƒæœºåˆ¶**ï¼š
- ğŸ”„ **é•œåƒåŒæ­¥**ï¼šå›½å†…æœåŠ¡å™¨å®šæœŸåŒæ­¥Docker Hubå†…å®¹
- ğŸš€ **å°±è¿‘è®¿é—®**ï¼šDockerå®¢æˆ·ç«¯ä¼˜å…ˆä»å›½å†…æœåŠ¡å™¨ä¸‹è½½
- ğŸ“¦ **é€æ˜ä»£ç†**ï¼šç”¨æˆ·æ— éœ€æ”¹å˜ä½¿ç”¨ä¹ æƒ¯

---

## 2. âš¡ å›½å†…é•œåƒåŠ é€Ÿå™¨é…ç½®


### 2.1 ä¸»æµé•œåƒåŠ é€ŸæœåŠ¡


**å›½å†…ä¸‰å¤§ä¸»æµåŠ é€Ÿå™¨å¯¹æ¯”**ï¼š

| æœåŠ¡å•† | åœ°å€ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|--------|------|------|----------|
| **é˜¿é‡Œäº‘** | `https://xxx.mirror.aliyuncs.com` | éœ€æ³¨å†Œè·å–ä¸“å±åœ°å€ | ä¼ä¸šç”¨æˆ· |
| **DaoCloud** | `http://f1361db2.m.daocloud.io` | å…è´¹å…¬ç”¨ | ä¸ªäººå¼€å‘ |
| **ç½‘æ˜“** | `http://hub-mirror.c.163.com` | ç¨³å®šå¯é  | é€šç”¨åœºæ™¯ |

> **ğŸ’¡ é‡è¦æç¤º**ï¼šé˜¿é‡Œäº‘é•œåƒéœ€è¦ç™»å½•é˜¿é‡Œäº‘æ§åˆ¶å°è·å–ä¸ªäººä¸“å±åœ°å€ï¼Œå…¶ä»–ä¸¤ä¸ªå¯ç›´æ¥ä½¿ç”¨

### 2.2 daemon.jsoné…ç½®è¯¦è§£


**é…ç½®æ–‡ä»¶ä½ç½®**ï¼š`/etc/docker/daemon.json`

è¿™ä¸ªæ–‡ä»¶æ˜¯Dockerçš„"å…¨å±€è®¾ç½®ä¸­å¿ƒ"ï¼Œå°±åƒæ‰‹æœºçš„ç³»ç»Ÿè®¾ç½®ä¸€æ ·ï¼š

```json
{
  "registry-mirrors": [
    "https://your-id.mirror.aliyuncs.com",
    "http://hub-mirror.c.163.com",
    "http://f1361db2.m.daocloud.io"
  ]
}
```

**å‚æ•°è¯´æ˜**ï¼š
- **registry-mirrors**ï¼šé•œåƒä»“åº“é•œåƒåˆ—è¡¨
- **æ•°ç»„å½¢å¼**ï¼šæ”¯æŒå¤šä¸ªé•œåƒæºï¼ŒæŒ‰é¡ºåºå°è¯•
- **HTTPSä¼˜å…ˆ**ï¼šå»ºè®®ä½¿ç”¨HTTPSåœ°å€ä¿è¯å®‰å…¨

### 2.3 å®Œæ•´é…ç½®æµç¨‹


**Step 1ï¼šåˆ›å»ºé…ç½®æ–‡ä»¶**
```bash
# åˆ›å»ºDockeré…ç½®ç›®å½•
sudo mkdir -p /etc/docker

# ç¼–è¾‘é…ç½®æ–‡ä»¶
sudo vim /etc/docker/daemon.json
```

**Step 2ï¼šå†™å…¥é•œåƒé…ç½®**
```json
{
  "registry-mirrors": [
    "https://your-id.mirror.aliyuncs.com",
    "http://hub-mirror.c.163.com"
  ],
  "log-driver": "json-file",
  "log-opts": {
    "max-size": "10m",
    "max-file": "3"
  }
}
```

**Step 3ï¼šé‡å¯DockeræœåŠ¡**
```bash
# é‡æ–°åŠ è½½é…ç½®
sudo systemctl daemon-reload

# é‡å¯Docker
sudo systemctl restart docker

# éªŒè¯é…ç½®
docker info | grep -A 5 "Registry Mirrors"
```

### 2.4 é…ç½®éªŒè¯æ–¹æ³•


**æ£€æŸ¥é…ç½®æ˜¯å¦ç”Ÿæ•ˆ**ï¼š
```bash
# æ–¹æ³•1ï¼šæŸ¥çœ‹Dockerä¿¡æ¯
docker info | grep "Registry Mirrors"

# æ–¹æ³•2ï¼šæµ‹è¯•ä¸‹è½½é€Ÿåº¦
time docker pull hello-world

# æ–¹æ³•3ï¼šæŸ¥çœ‹é…ç½®æ–‡ä»¶
cat /etc/docker/daemon.json
```

**æ­£ç¡®è¾“å‡ºç¤ºä¾‹**ï¼š
```
Registry Mirrors:
 https://xxx.mirror.aliyuncs.com/
 http://hub-mirror.c.163.com/
```

---

## 3. ğŸ”— Dockerä»£ç†é…ç½®


### 3.1 ä»€ä¹ˆæ—¶å€™éœ€è¦ä»£ç†é…ç½®


**ä»£ç†é…ç½®åœºæ™¯**ï¼š
- ğŸ¢ **ä¼ä¸šç¯å¢ƒ**ï¼šå…¬å¸ç½‘ç»œéœ€è¦é€šè¿‡ä»£ç†æœåŠ¡å™¨ä¸Šç½‘
- ğŸ›¡ï¸ **å®‰å…¨è¦æ±‚**ï¼šç»Ÿä¸€ç®¡ç†ç½‘ç»œå‡ºå£ï¼Œç›‘æ§æµé‡
- ğŸŒ **ç½‘ç»œé™åˆ¶**ï¼šæŸäº›ç½‘ç»œç¯å¢ƒå¿…é¡»é€šè¿‡ä»£ç†è®¿é—®å¤–ç½‘

### 3.2 Dockerä»£ç†é…ç½®æ–¹æ³•


**ç³»ç»Ÿçº§ä»£ç†é…ç½®**ï¼šå½±å“æ•´ä¸ªDockeræœåŠ¡

```bash
# åˆ›å»ºDockeræœåŠ¡é…ç½®ç›®å½•
sudo mkdir -p /etc/systemd/system/docker.service.d

# åˆ›å»ºä»£ç†é…ç½®æ–‡ä»¶
sudo vim /etc/systemd/system/docker.service.d/proxy.conf
```

**ä»£ç†é…ç½®å†…å®¹**ï¼š
```ini
[Service]
Environment="HTTP_PROXY=http://proxy.company.com:8080"
Environment="HTTPS_PROXY=http://proxy.company.com:8080"
Environment="NO_PROXY=localhost,127.0.0.1,docker-registry.company.com"
```

**é‡å¯ç”Ÿæ•ˆ**ï¼š
```bash
sudo systemctl daemon-reload
sudo systemctl restart docker
```

### 3.3 å®¹å™¨çº§ä»£ç†é…ç½®


**ä¸´æ—¶ä»£ç†**ï¼ˆä»…å½“æ¬¡è¿è¡Œæœ‰æ•ˆï¼‰ï¼š
```bash
docker run --env HTTP_PROXY=http://proxy:8080 \
           --env HTTPS_PROXY=http://proxy:8080 \
           nginx
```

**Dockerfileä¸­é…ç½®ä»£ç†**ï¼š
```dockerfile
# æ„å»ºé˜¶æ®µä½¿ç”¨ä»£ç†
FROM ubuntu
ENV http_proxy=http://proxy.company.com:8080
ENV https_proxy=http://proxy.company.com:8080
RUN apt-get update && apt-get install -y curl
```

---

## 4. ğŸ—ï¸ ç§æœ‰é•œåƒä»“åº“é…ç½®


### 4.1 ä»€ä¹ˆæ˜¯ç§æœ‰é•œåƒä»“åº“


**ç§æœ‰é•œåƒä»“åº“**å°±åƒå…¬å¸å†…éƒ¨çš„"åº”ç”¨å•†åº—"ï¼š
- ğŸ”’ **å®‰å…¨å¯æ§**ï¼šé•œåƒä¸å¯¹å¤–å…¬å¼€
- ğŸš€ **è®¿é—®å¿«é€Ÿ**ï¼šéƒ¨ç½²åœ¨å†…ç½‘ï¼Œä¸‹è½½é€Ÿåº¦å¿«
- ğŸ’¼ **ä¼ä¸šå®šåˆ¶**ï¼šå­˜å‚¨å…¬å¸ä¸“æœ‰åº”ç”¨é•œåƒ

### 4.2 é…ç½®ç§æœ‰ä»“åº“è®¿é—®


**æ·»åŠ ç§æœ‰ä»“åº“é…ç½®**ï¼š
```json
{
  "registry-mirrors": [
    "http://hub-mirror.c.163.com"
  ],
  "insecure-registries": [
    "registry.company.com:5000"
  ],
  "registries": {
    "registry.company.com:5000": {
      "secure": false
    }
  }
}
```

**å‚æ•°è§£é‡Š**ï¼š
- **insecure-registries**ï¼šå…è®¸HTTPåè®®è®¿é—®çš„ä»“åº“
- **registries**ï¼šè¯¦ç»†ä»“åº“é…ç½®
- **secure: false**ï¼šå…è®¸ä¸å®‰å…¨è¿æ¥ï¼ˆä»…å†…ç½‘ä½¿ç”¨ï¼‰

### 4.3 ç§æœ‰ä»“åº“è®¤è¯é…ç½®


**ç™»å½•ç§æœ‰ä»“åº“**ï¼š
```bash
# ç™»å½•ç§æœ‰ä»“åº“
docker login registry.company.com:5000

# è¾“å…¥ç”¨æˆ·åå’Œå¯†ç 
Username: your-username
Password: your-password
```

**è®¤è¯ä¿¡æ¯å­˜å‚¨ä½ç½®**ï¼š
- Linuxï¼š`~/.docker/config.json`
- åŒ…å«åŠ å¯†çš„è®¤è¯å‡­æ®

---

## 5. ğŸ“¦ é•œåƒç¼“å­˜ç­–ç•¥ä¸ä¼˜åŒ–


### 5.1 Dockeré•œåƒç¼“å­˜æœºåˆ¶


**Dockeré•œåƒçš„å±‚çº§ç»“æ„**ï¼š
```
é•œåƒå±‚çº§ç¤ºä¾‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åº”ç”¨å±‚ï¼ˆAppï¼‰      â”‚ â† ä½ çš„åº”ç”¨ä»£ç 
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   è¿è¡Œæ—¶å±‚ï¼ˆRuntimeï¼‰â”‚ â† Javaã€Pythonç­‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   æ“ä½œç³»ç»Ÿå±‚ï¼ˆOSï¼‰   â”‚ â† Ubuntuã€CentOSç­‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¼“å­˜åŸç†ï¼šç›¸åŒçš„å±‚åªä¸‹è½½ä¸€æ¬¡ï¼Œå¤šä¸ªé•œåƒå¯ä»¥å…±äº«
```

### 5.2 ç¼“å­˜ä¼˜åŒ–ç­–ç•¥


**é•œåƒæ‹‰å–è¶…æ—¶å¤„ç†**ï¼š

```json
{
  "registry-mirrors": [
    "http://hub-mirror.c.163.com"
  ],
  "max-concurrent-downloads": 3,
  "max-download-attempts": 5,
  "registry-timeout": "600s"
}
```

**å‚æ•°è¯´æ˜**ï¼š
- **max-concurrent-downloads**ï¼šåŒæ—¶ä¸‹è½½çš„å±‚æ•°é™åˆ¶
- **max-download-attempts**ï¼šä¸‹è½½å¤±è´¥é‡è¯•æ¬¡æ•°
- **registry-timeout**ï¼šå•æ¬¡ä¸‹è½½è¶…æ—¶æ—¶é—´

### 5.3 æ¸…ç†ç¼“å­˜å‘½ä»¤


**é•œåƒæ¸…ç†ç»´æŠ¤**ï¼š
```bash
# æŸ¥çœ‹ç£ç›˜ä½¿ç”¨æƒ…å†µ
docker system df

# æ¸…ç†æ— ç”¨é•œåƒ
docker image prune -a

# æ¸…ç†æ‰€æœ‰æ— ç”¨èµ„æº
docker system prune --all --volumes
```

**å®šæœŸæ¸…ç†ç­–ç•¥**ï¼š
```bash
#!/bin/bash
# æ¯å‘¨æ¸…ç†è„šæœ¬
docker image prune -f
docker container prune -f
docker volume prune -f
```

---

## 6. â— å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


### 6.1 é•œåƒæ‹‰å–å¤±è´¥é—®é¢˜


**é—®é¢˜ç°è±¡**ï¼š
```
Error response from daemon: Get https://registry-1.docker.io/v2/: 
net/http: TLS handshake timeout
```

**è§£å†³æ–¹æ¡ˆä¼˜å…ˆçº§**ï¼š

| é—®é¢˜ç±»å‹ | è§£å†³æ–¹æ³• | æœ‰æ•ˆæ€§ |
|----------|----------|---------|
| ç½‘ç»œè¶…æ—¶ | é…ç½®é•œåƒåŠ é€Ÿå™¨ | â­â­â­â­â­ |
| DNSé—®é¢˜ | ä¿®æ”¹DNSä¸º8.8.8.8 | â­â­â­â­ |
| ä»£ç†é—®é¢˜ | æ£€æŸ¥ä»£ç†é…ç½® | â­â­â­ |
| é˜²ç«å¢™ | å¼€æ”¾ç›¸å…³ç«¯å£ | â­â­ |

### 6.2 é…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯


**å¸¸è§é”™è¯¯**ï¼š
```json
{
  "registry-mirrors": [
    "http://mirror.com",  â† å¤šä½™é€—å·
  ]
}
```

**æ­£ç¡®æ ¼å¼**ï¼š
```json
{
  "registry-mirrors": [
    "http://mirror.com"
  ]
}
```

**æ£€æŸ¥é…ç½®**ï¼š
```bash
# éªŒè¯JSONæ ¼å¼
cat /etc/docker/daemon.json | python -m json.tool
```

### 6.3 æƒé™é—®é¢˜è§£å†³


**æƒé™ä¸è¶³é”™è¯¯**ï¼š
```bash
# é—®é¢˜ï¼špermission denied
sudo chmod 644 /etc/docker/daemon.json

# æ£€æŸ¥DockeræœåŠ¡çŠ¶æ€
sudo systemctl status docker
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Docker Hubï¼šå®˜æ–¹é•œåƒä»“åº“ï¼Œå›½å†…è®¿é—®æ…¢
ğŸ”¸ é•œåƒåŠ é€Ÿå™¨ï¼šå›½å†…æœåŠ¡å•†æä¾›çš„é•œåƒç¼“å­˜æœåŠ¡
ğŸ”¸ daemon.jsonï¼šDockerå…¨å±€é…ç½®æ–‡ä»¶
ğŸ”¸ registry-mirrorsï¼šé•œåƒä»“åº“é•œåƒåˆ—è¡¨å‚æ•°
ğŸ”¸ ç§æœ‰ä»“åº“ï¼šä¼ä¸šå†…éƒ¨çš„é•œåƒå­˜å‚¨æœåŠ¡
```

### 7.2 å…³é”®é…ç½®æ–‡ä»¶å’Œå‚æ•°


**æ ¸å¿ƒé…ç½®æ–‡ä»¶**ï¼š
- `/etc/docker/daemon.json` - Dockerå…¨å±€é…ç½®
- `~/.docker/config.json` - ç”¨æˆ·è®¤è¯ä¿¡æ¯

**é‡è¦å‚æ•°**ï¼š
```json
{
  "registry-mirrors": ["é•œåƒåŠ é€Ÿåœ°å€"],
  "insecure-registries": ["ç§æœ‰ä»“åº“åœ°å€"],
  "max-concurrent-downloads": 3,
  "registry-timeout": "600s"
}
```

### 7.3 æœ€ä½³å®è·µå»ºè®®


**ğŸ¯ æ¨èé…ç½®æ¨¡æ¿**ï¼š
```json
{
  "registry-mirrors": [
    "https://your-id.mirror.aliyuncs.com",
    "http://hub-mirror.c.163.com",
    "http://f1361db2.m.daocloud.io"
  ],
  "log-driver": "json-file",
  "log-opts": {
    "max-size": "10m",
    "max-file": "3"
  },
  "max-concurrent-downloads": 3,
  "registry-timeout": "600s"
}
```

**ğŸ”§ è¿ç»´å»ºè®®**ï¼š
- å®šæœŸæ£€æŸ¥é•œåƒåŠ é€Ÿå™¨å¯ç”¨æ€§
- è®¾ç½®åˆç†çš„è¶…æ—¶å’Œé‡è¯•å‚æ•°
- å®šæœŸæ¸…ç†æ— ç”¨é•œåƒé‡Šæ”¾ç©ºé—´
- ä¼ä¸šç¯å¢ƒå»ºè®®ä½¿ç”¨ç§æœ‰ä»“åº“

### 7.4 æ•…éšœæ’æŸ¥æ€è·¯


**é—®é¢˜è¯Šæ–­æµç¨‹**ï¼š
```
é•œåƒä¸‹è½½æ…¢/å¤±è´¥
    â†“
æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
    â†“
éªŒè¯é…ç½®æ–‡ä»¶æ ¼å¼
    â†“
ç¡®è®¤é•œåƒåŠ é€Ÿå™¨å¯ç”¨æ€§
    â†“
æ£€æŸ¥DNSå’Œä»£ç†è®¾ç½®
    â†“
æŸ¥çœ‹DockeræœåŠ¡æ—¥å¿—
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- é•œåƒåŠ é€Ÿå™¨è§£å†³ç½‘ç»œæ…¢é—®é¢˜
- daemon.jsonæ˜¯Dockerå…¨å±€é…ç½®ä¸­å¿ƒ
- å¤šé•œåƒæºé…ç½®æé«˜å¯ç”¨æ€§
- å®šæœŸç»´æŠ¤ä¿è¯ç³»ç»Ÿç¨³å®šè¿è¡Œ