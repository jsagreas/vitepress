---
title: 5ã€firewall-cmdå‘½ä»¤è¡Œå·¥å…·
---
## ğŸ“š ç›®å½•

1. [firewall-cmdåŸºæœ¬æ¦‚å¿µ](#1-firewall-cmdåŸºæœ¬æ¦‚å¿µ)
2. [åŸºæœ¬è¯­æ³•ç»“æ„](#2-åŸºæœ¬è¯­æ³•ç»“æ„)
3. [å¸¸ç”¨é€‰é¡¹å‚æ•°è¯¦è§£](#3-å¸¸ç”¨é€‰é¡¹å‚æ•°è¯¦è§£)
4. [runtimeä¸permanentæ“ä½œ](#4-runtimeä¸permanentæ“ä½œ)
5. [é…ç½®é‡è½½æœºåˆ¶](#5-é…ç½®é‡è½½æœºåˆ¶)
6. [æŸ¥è¯¢å‘½ä»¤è¯¦è§£](#6-æŸ¥è¯¢å‘½ä»¤è¯¦è§£)
7. [åˆ—è¡¨å‘½ä»¤è¯¦è§£](#7-åˆ—è¡¨å‘½ä»¤è¯¦è§£)
8. [å‘½ä»¤è¾“å‡ºæ ¼å¼è§£è¯»](#8-å‘½ä»¤è¾“å‡ºæ ¼å¼è§£è¯»)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”§ firewall-cmdåŸºæœ¬æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯firewall-cmd


**å®šä¹‰**ï¼šfirewall-cmdæ˜¯firewalldé˜²ç«å¢™çš„**å‘½ä»¤è¡Œç®¡ç†å·¥å…·**ï¼Œå°±åƒæ˜¯é˜²ç«å¢™çš„"é¥æ§å™¨"

```
ç®€å•ç†è§£ï¼š
firewalldæœåŠ¡  = ç”µè§†æœºï¼ˆåå°è¿è¡Œçš„é˜²ç«å¢™æœåŠ¡ï¼‰
firewall-cmd  = é¥æ§å™¨ï¼ˆç”¨æ¥æ§åˆ¶é˜²ç«å¢™çš„å·¥å…·ï¼‰

é€šè¿‡é¥æ§å™¨(firewall-cmd)æ¥ï¼š
â€¢ å¼€å…³é˜²ç«å¢™è§„åˆ™
â€¢ æŸ¥çœ‹å½“å‰çŠ¶æ€  
â€¢ ä¿®æ”¹é˜²ç«å¢™é…ç½®
â€¢ ç®¡ç†ç½‘ç»œåŒºåŸŸ
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦firewall-cmd


**ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜**ï¼š
- **iptables**ï¼šè¯­æ³•å¤æ‚ï¼Œè§„åˆ™éš¾è®°å¿†
- **é…ç½®æ–‡ä»¶**ï¼šéœ€è¦æ‰‹åŠ¨ç¼–è¾‘ï¼Œå®¹æ˜“å‡ºé”™
- **é‡å¯å½±å“**ï¼šä¿®æ”¹åéœ€è¦é‡å¯æœåŠ¡

**firewall-cmdçš„ä¼˜åŠ¿**ï¼š
- âœ… **è¯­æ³•ç®€å•**ï¼šå‘½ä»¤ç›´è§‚æ˜“æ‡‚
- âœ… **å³æ—¶ç”Ÿæ•ˆ**ï¼šæ— éœ€é‡å¯æœåŠ¡
- âœ… **å®‰å…¨æ“ä½œ**ï¼šæ”¯æŒä¸´æ—¶å’Œæ°¸ä¹…ä¸¤ç§æ¨¡å¼
- âœ… **çŠ¶æ€æŸ¥è¯¢**ï¼šéšæ—¶æŸ¥çœ‹å½“å‰é…ç½®

### 1.3 å·¥ä½œåŸç†ç®€å›¾


```
ç”¨æˆ·è¾“å…¥å‘½ä»¤
     â†“
firewall-cmdå·¥å…·
     â†“
D-Busæ¥å£é€šä¿¡
     â†“  
firewalldæœåŠ¡
     â†“
netfilterå†…æ ¸æ¨¡å—
     â†“
å®é™…ç½‘ç»œæµé‡æ§åˆ¶
```

---

## 2. ğŸ“ åŸºæœ¬è¯­æ³•ç»“æ„


### 2.1 å‘½ä»¤åŸºæœ¬æ ¼å¼


**æ ‡å‡†è¯­æ³•**ï¼š
```bash
firewall-cmd [é€‰é¡¹] [å‚æ•°]
```

**è¯­æ³•ç»„æˆ**ï¼š
- **firewall-cmd**ï¼šå›ºå®šçš„å‘½ä»¤åç§°
- **[é€‰é¡¹]**ï¼šå‘Šè¯‰å·¥å…·è¦åšä»€ä¹ˆæ“ä½œ
- **[å‚æ•°]**ï¼šå…·ä½“çš„æ“ä½œå¯¹è±¡

### 2.2 å¸¸è§å‘½ä»¤æ¨¡å¼


**æŸ¥è¯¢æ¨¡å¼**ï¼š
```bash
firewall-cmd --get-çŠ¶æ€ä¿¡æ¯
firewall-cmd --list-å…·ä½“å†…å®¹
```

**æ“ä½œæ¨¡å¼**ï¼š
```bash
firewall-cmd --add-æ·»åŠ è§„åˆ™    # æ·»åŠ è§„åˆ™
firewall-cmd --remove-åˆ é™¤è§„åˆ™ # åˆ é™¤è§„åˆ™
firewall-cmd --change-ä¿®æ”¹è§„åˆ™ # ä¿®æ”¹è§„åˆ™
```

**ç®¡ç†æ¨¡å¼**ï¼š
```bash
firewall-cmd --reload          # é‡è½½é…ç½®
firewall-cmd --complete-reload # å®Œå…¨é‡è½½
```

### 2.3 å‘½ä»¤ç»“æ„ç¤ºä¾‹


```bash
# åŸºç¡€æ ¼å¼ç¤ºä¾‹
firewall-cmd --state                    # åªæœ‰é€‰é¡¹
firewall-cmd --get-default-zone         # è·å–ä¿¡æ¯
firewall-cmd --add-port=80/tcp          # æ“ä½œ+å‚æ•°
firewall-cmd --zone=public --list-ports # æŒ‡å®šåŒºåŸŸ+æ“ä½œ
```

---

## 3. âš™ï¸ å¸¸ç”¨é€‰é¡¹å‚æ•°è¯¦è§£


### 3.1 çŠ¶æ€æŸ¥è¯¢é€‰é¡¹


| é€‰é¡¹ | ä½œç”¨ | ç¤ºä¾‹ |
|-----|-----|------|
| `--state` | æŸ¥çœ‹é˜²ç«å¢™è¿è¡ŒçŠ¶æ€ | `firewall-cmd --state` |
| `--get-default-zone` | è·å–é»˜è®¤åŒºåŸŸ | `firewall-cmd --get-default-zone` |
| `--get-active-zones` | æŸ¥çœ‹æ´»è·ƒåŒºåŸŸ | `firewall-cmd --get-active-zones` |
| `--get-zones` | åˆ—å‡ºæ‰€æœ‰åŒºåŸŸ | `firewall-cmd --get-zones` |

**å®é™…ä½¿ç”¨ç¤ºä¾‹**ï¼š
```bash
# æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦åœ¨è¿è¡Œ
$ firewall-cmd --state
running

# æŸ¥çœ‹å½“å‰é»˜è®¤åŒºåŸŸ
$ firewall-cmd --get-default-zone  
public
```

### 3.2 åŒºåŸŸç®¡ç†é€‰é¡¹


| é€‰é¡¹ | å«ä¹‰ | è¯´æ˜ |
|-----|-----|------|
| `--zone=åŒºåŸŸå` | æŒ‡å®šæ“ä½œçš„åŒºåŸŸ | ä¸æŒ‡å®šåˆ™ä½¿ç”¨é»˜è®¤åŒºåŸŸ |
| `--set-default-zone=åŒºåŸŸå` | è®¾ç½®é»˜è®¤åŒºåŸŸ | æ°¸ä¹…ç”Ÿæ•ˆ |
| `--get-zone-of-interface=ç½‘å¡` | æŸ¥çœ‹ç½‘å¡æ‰€å±åŒºåŸŸ | æŸ¥è¯¢ç½‘å¡ç»‘å®š |

### 3.3 ç«¯å£ç®¡ç†é€‰é¡¹


**ç«¯å£æ“ä½œè¯­æ³•**ï¼š
```bash
--add-port=ç«¯å£/åè®®        # æ·»åŠ ç«¯å£
--remove-port=ç«¯å£/åè®®     # åˆ é™¤ç«¯å£
--query-port=ç«¯å£/åè®®      # æŸ¥è¯¢ç«¯å£çŠ¶æ€
```

**åè®®ç±»å‹**ï¼š
- `tcp`ï¼šTCPåè®®ç«¯å£
- `udp`ï¼šUDPåè®®ç«¯å£
- `sctp`ï¼šSCTPåè®®ç«¯å£

**ç«¯å£æ ¼å¼ç¤ºä¾‹**ï¼š
```bash
80/tcp          # å•ä¸ªTCPç«¯å£
53/udp          # å•ä¸ªUDPç«¯å£
8080-8090/tcp   # TCPç«¯å£èŒƒå›´
```

### 3.4 æœåŠ¡ç®¡ç†é€‰é¡¹


**é¢„å®šä¹‰æœåŠ¡æ“ä½œ**ï¼š
```bash
--add-service=æœåŠ¡å        # æ·»åŠ æœåŠ¡
--remove-service=æœåŠ¡å     # åˆ é™¤æœåŠ¡
--query-service=æœåŠ¡å      # æŸ¥è¯¢æœåŠ¡çŠ¶æ€
```

**å¸¸è§æœåŠ¡å**ï¼š
- `http`ï¼šHTTPæœåŠ¡ï¼ˆ80ç«¯å£ï¼‰
- `https`ï¼šHTTPSæœåŠ¡ï¼ˆ443ç«¯å£ï¼‰
- `ssh`ï¼šSSHæœåŠ¡ï¼ˆ22ç«¯å£ï¼‰
- `ftp`ï¼šFTPæœåŠ¡ï¼ˆ21ç«¯å£ï¼‰

---

## 4. ğŸ”„ runtimeä¸permanentæ“ä½œ


### 4.1 ä¸¤ç§æ“ä½œæ¨¡å¼å¯¹æ¯”


**runtimeæ¨¡å¼ï¼ˆè¿è¡Œæ—¶ï¼‰**ï¼š
```
ç‰¹ç‚¹ï¼šç«‹å³ç”Ÿæ•ˆï¼Œé‡å¯å¤±æ•ˆ
é€‚ç”¨ï¼šä¸´æ—¶æµ‹è¯•ã€ç´§æ€¥ä¿®å¤
é£é™©ï¼šé‡å¯åé…ç½®ä¸¢å¤±
```

**permanentæ¨¡å¼ï¼ˆæ°¸ä¹…ï¼‰**ï¼š
```
ç‰¹ç‚¹ï¼šé‡å¯åç”Ÿæ•ˆï¼Œéœ€è¦reload
é€‚ç”¨ï¼šæ­£å¼é…ç½®ã€é•¿æœŸè§„åˆ™
å®‰å…¨ï¼šä¸ä¼šç«‹å³å½±å“ç°æœ‰è¿æ¥
```

### 4.2 æ¨¡å¼é€‰æ‹©æŒ‡å—


```
ä¸´æ—¶æµ‹è¯•åœºæ™¯ï¼š
1. å…ˆç”¨runtimeæ¨¡å¼æµ‹è¯•
2. ç¡®è®¤æ— é—®é¢˜åç”¨permanentæ¨¡å¼
3. æœ€åreloadä½¿permanentç”Ÿæ•ˆ

ç´§æ€¥å¤„ç†åœºæ™¯ï¼š
1. ç›´æ¥ç”¨runtimeæ¨¡å¼å¿«é€Ÿç”Ÿæ•ˆ
2. é—®é¢˜è§£å†³åå†åšpermanenté…ç½®

æ—¥å¸¸ç®¡ç†åœºæ™¯ï¼š
1. ç›´æ¥ä½¿ç”¨permanentæ¨¡å¼
2. ç»Ÿä¸€reloadåº”ç”¨æ‰€æœ‰æ›´æ”¹
```

### 4.3 æ“ä½œæ¨¡å¼ç¤ºä¾‹


**runtimeæ“ä½œï¼ˆç«‹å³ç”Ÿæ•ˆï¼‰**ï¼š
```bash
# ä¸´æ—¶å¼€æ”¾80ç«¯å£
firewall-cmd --add-port=80/tcp

# ä¸´æ—¶æ·»åŠ SSHæœåŠ¡
firewall-cmd --add-service=ssh

# æ£€æŸ¥runtimeé…ç½®
firewall-cmd --list-ports
```

**permanentæ“ä½œï¼ˆæŒä¹…åŒ–ï¼‰**ï¼š
```bash
# æ°¸ä¹…å¼€æ”¾80ç«¯å£ï¼ˆéœ€è¦reloadï¼‰
firewall-cmd --permanent --add-port=80/tcp

# æ°¸ä¹…æ·»åŠ SSHæœåŠ¡
firewall-cmd --permanent --add-service=ssh

# é‡è½½é…ç½®ä½¿å…¶ç”Ÿæ•ˆ
firewall-cmd --reload
```

### 4.4 åŒé‡é…ç½®ç­–ç•¥


**åŒæ—¶é…ç½®runtimeå’Œpermanent**ï¼š
```bash
# æ–¹å¼1ï¼šåˆ†åˆ«æ‰§è¡Œ
firewall-cmd --add-port=80/tcp              # runtime
firewall-cmd --permanent --add-port=80/tcp  # permanent

# æ–¹å¼2ï¼šå…ˆpermanentåreload
firewall-cmd --permanent --add-port=80/tcp
firewall-cmd --reload
```

> ğŸ’¡ **æœ€ä½³å®è·µ**ï¼šå¯¹äºæ­£å¼ç¯å¢ƒï¼Œå»ºè®®ä½¿ç”¨permanentæ¨¡å¼ç¡®ä¿é…ç½®æŒä¹…åŒ–

---

## 5. ğŸ”„ é…ç½®é‡è½½æœºåˆ¶


### 5.1 ä»€ä¹ˆæ˜¯é…ç½®é‡è½½


**é…ç½®é‡è½½**ï¼šè®©firewalldé‡æ–°è¯»å–é…ç½®æ–‡ä»¶ï¼Œä½¿permanenté…ç½®ç”Ÿæ•ˆ

```
ç†è§£é…ç½®é‡è½½ï¼š
permanenté…ç½® = å†™å…¥é…ç½®æ–‡ä»¶ï¼Œä½†æœªåº”ç”¨
reloadæ“ä½œ   = è¯»å–é…ç½®æ–‡ä»¶ï¼Œåº”ç”¨åˆ°è¿è¡Œæ—¶
```

### 5.2 reload vs complete-reload


| é‡è½½ç±»å‹ | å‘½ä»¤ | å½±å“ | é€‚ç”¨åœºæ™¯ |
|---------|------|------|---------|
| **æ™®é€šé‡è½½** | `--reload` | ä¿æŒç°æœ‰è¿æ¥ | æ—¥å¸¸é…ç½®æ›´æ–° |
| **å®Œå…¨é‡è½½** | `--complete-reload` | æ–­å¼€æ‰€æœ‰è¿æ¥ | é‡å¤§é…ç½®å˜æ›´ |

### 5.3 é‡è½½æ“ä½œè¯¦è§£


**æ™®é€šé‡è½½ï¼ˆæ¨èï¼‰**ï¼š
```bash
# é‡è½½é…ç½®ï¼Œä¿æŒç°æœ‰è¿æ¥
firewall-cmd --reload

# æ£€æŸ¥é‡è½½æ˜¯å¦æˆåŠŸ
echo $?  # è¿”å›0è¡¨ç¤ºæˆåŠŸ
```

**å®Œå…¨é‡è½½ï¼ˆæ…ç”¨ï¼‰**ï¼š
```bash
# å®Œå…¨é‡è½½ï¼Œä¼šæ–­å¼€ç°æœ‰è¿æ¥
firewall-cmd --complete-reload
```

> âš ï¸ **æ³¨æ„**ï¼šcomplete-reloadä¼šæ–­å¼€æ‰€æœ‰ç°æœ‰è¿æ¥ï¼Œç”Ÿäº§ç¯å¢ƒæ…ç”¨

### 5.4 é‡è½½æ—¶æœºé€‰æ‹©


**éœ€è¦reloadçš„æƒ…å†µ**ï¼š
```bash
# æ‰§è¡Œäº†permanentæ“ä½œå
firewall-cmd --permanent --add-port=80/tcp
firewall-cmd --reload  # å¿…éœ€

# ä¿®æ”¹äº†é…ç½®æ–‡ä»¶å
vi /etc/firewalld/zones/public.xml
firewall-cmd --reload  # å¿…éœ€
```

**ä¸éœ€è¦reloadçš„æƒ…å†µ**ï¼š
```bash
# runtimeæ“ä½œç«‹å³ç”Ÿæ•ˆ
firewall-cmd --add-port=80/tcp  # æ— éœ€reload
```

---

## 6. ğŸ” æŸ¥è¯¢å‘½ä»¤è¯¦è§£


### 6.1 --getç³»åˆ—å‘½ä»¤æ¦‚è§ˆ


**--getç³»åˆ—**ï¼šè·å–å•ä¸€ä¿¡æ¯ï¼Œè¿”å›ç®€æ´ç»“æœ

```
å‘½ä»¤ç‰¹ç‚¹ï¼š
â€¢ è¿”å›å•ä¸€å€¼æˆ–ç®€çŸ­ä¿¡æ¯
â€¢ é€‚åˆè„šæœ¬ç¼–ç¨‹ä½¿ç”¨
â€¢ è¾“å‡ºæ ¼å¼ç®€æ´
```

### 6.2 åŸºç¡€çŠ¶æ€æŸ¥è¯¢


**ç³»ç»ŸçŠ¶æ€æŸ¥è¯¢**ï¼š
```bash
# æŸ¥çœ‹é˜²ç«å¢™è¿è¡ŒçŠ¶æ€
firewall-cmd --state
# è¾“å‡ºï¼šrunning æˆ– not running

# è·å–é»˜è®¤åŒºåŸŸ
firewall-cmd --get-default-zone
# è¾“å‡ºï¼špublic

# è·å–æ‰€æœ‰åŒºåŸŸåˆ—è¡¨
firewall-cmd --get-zones
# è¾“å‡ºï¼šblock dmz drop external home internal public trusted work
```

**æ´»è·ƒåŒºåŸŸæŸ¥è¯¢**ï¼š
```bash
# æŸ¥çœ‹æ´»è·ƒçš„åŒºåŸŸåŠç»‘å®šçš„æ¥å£
firewall-cmd --get-active-zones
# è¾“å‡ºï¼š
# public
#   interfaces: eth0 eth1
```

### 6.3 ç½‘ç»œæ¥å£æŸ¥è¯¢


**æ¥å£ç›¸å…³æŸ¥è¯¢**ï¼š
```bash
# æŸ¥çœ‹ç½‘å¡å±äºå“ªä¸ªåŒºåŸŸ
firewall-cmd --get-zone-of-interface=eth0
# è¾“å‡ºï¼špublic

# æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œæ¥å£
ip link show  # ç³»ç»Ÿå‘½ä»¤ï¼Œé…åˆä½¿ç”¨
```

### 6.4 æ—¥å¿—å’Œè¶…æ—¶æŸ¥è¯¢


**é«˜çº§æŸ¥è¯¢é€‰é¡¹**ï¼š
```bash
# æŸ¥çœ‹æ—¥å¿—æ‹’ç»çº§åˆ«
firewall-cmd --get-log-denied
# è¾“å‡ºï¼šoff

# æŸ¥çœ‹é»˜è®¤è¶…æ—¶æ—¶é—´
firewall-cmd --get-default-timeout
# è¾“å‡ºï¼š600
```

> ğŸ“ **ä½¿ç”¨æŠ€å·§**ï¼š--getå‘½ä»¤è¿”å›å€¼å¯ä»¥ç›´æ¥ç”¨äºShellè„šæœ¬ç¼–ç¨‹

---

## 7. ğŸ“‹ åˆ—è¡¨å‘½ä»¤è¯¦è§£


### 7.1 --listç³»åˆ—å‘½ä»¤æ¦‚è§ˆ


**--listç³»åˆ—**ï¼šæ˜¾ç¤ºè¯¦ç»†åˆ—è¡¨ä¿¡æ¯ï¼Œè¿”å›å®Œæ•´é…ç½®

```
å‘½ä»¤ç‰¹ç‚¹ï¼š
â€¢ è¿”å›è¯¦ç»†åˆ—è¡¨ä¿¡æ¯
â€¢ é€‚åˆäººå·¥æŸ¥çœ‹åˆ†æ
â€¢ è¾“å‡ºæ ¼å¼å‹å¥½
```

### 7.2 åŒºåŸŸé…ç½®åˆ—è¡¨


**æŸ¥çœ‹æŒ‡å®šåŒºåŸŸçš„å®Œæ•´é…ç½®**ï¼š
```bash
# æŸ¥çœ‹é»˜è®¤åŒºåŸŸçš„æ‰€æœ‰é…ç½®
firewall-cmd --list-all

# æŸ¥çœ‹æŒ‡å®šåŒºåŸŸçš„æ‰€æœ‰é…ç½®
firewall-cmd --zone=public --list-all
```

**è¾“å‡ºç¤ºä¾‹è§£è¯»**ï¼š
```
public (active)
  target: default
  icmp-block-inversion: no
  interfaces: eth0
  sources: 
  services: cockpit dhcpv6-client ssh
  ports: 80/tcp 443/tcp
  protocols: 
  masquerade: no
  forward-ports: 
  source-ports: 
  icmp-blocks: 
  rich rules:
```

### 7.3 å…·ä½“é…ç½®é¡¹åˆ—è¡¨


**ç«¯å£åˆ—è¡¨æŸ¥è¯¢**ï¼š
```bash
# æŸ¥çœ‹å½“å‰åŒºåŸŸå¼€æ”¾çš„ç«¯å£
firewall-cmd --list-ports
# è¾“å‡ºï¼š80/tcp 443/tcp 8080-8090/tcp

# æŸ¥çœ‹æŒ‡å®šåŒºåŸŸçš„ç«¯å£
firewall-cmd --zone=public --list-ports
```

**æœåŠ¡åˆ—è¡¨æŸ¥è¯¢**ï¼š
```bash
# æŸ¥çœ‹å½“å‰åŒºåŸŸå…è®¸çš„æœåŠ¡
firewall-cmd --list-services  
# è¾“å‡ºï¼šcockpit dhcpv6-client ssh

# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„é¢„å®šä¹‰æœåŠ¡
firewall-cmd --get-services
```

**æ¥å£åˆ—è¡¨æŸ¥è¯¢**ï¼š
```bash
# æŸ¥çœ‹åŒºåŸŸç»‘å®šçš„ç½‘ç»œæ¥å£
firewall-cmd --list-interfaces
# è¾“å‡ºï¼šeth0 eth1

# æŸ¥çœ‹åŒºåŸŸçš„æºåœ°å€
firewall-cmd --list-sources
```

### 7.4 å…¨å±€é…ç½®åˆ—è¡¨


**æŸ¥çœ‹æ‰€æœ‰åŒºåŸŸçš„é…ç½®**ï¼š
```bash
# åˆ—å‡ºæ‰€æœ‰åŒºåŸŸçš„è¯¦ç»†é…ç½®
firewall-cmd --list-all-zones

# ä»…æŸ¥çœ‹åŒºåŸŸåç§°
firewall-cmd --get-zones
```

---

## 8. ğŸ“Š å‘½ä»¤è¾“å‡ºæ ¼å¼è§£è¯»


### 8.1 --list-allè¾“å‡ºè¯¦è§£


**å®Œæ•´è¾“å‡ºæ ¼å¼åˆ†æ**ï¼š
```
public (active)                    â† åŒºåŸŸå(çŠ¶æ€)
  target: default                  â† é»˜è®¤åŠ¨ä½œ
  icmp-block-inversion: no         â† ICMPé˜»æ–­åè½¬
  interfaces: eth0                 â† ç»‘å®šçš„ç½‘ç»œæ¥å£  
  sources:                         â† æºåœ°å€(ç©º)
  services: ssh http               â† å…è®¸çš„æœåŠ¡
  ports: 80/tcp 443/tcp           â† å¼€æ”¾çš„ç«¯å£
  protocols:                       â† åè®®(ç©º)
  masquerade: no                   â† IPä¼ªè£…
  forward-ports:                   â† ç«¯å£è½¬å‘(ç©º)
  source-ports:                    â† æºç«¯å£(ç©º)
  icmp-blocks:                     â† ICMPé˜»æ–­(ç©º)
  rich rules:                      â† å¯Œè§„åˆ™(ç©º)
```

### 8.2 çŠ¶æ€ä¿¡æ¯è§£è¯»


**åŒºåŸŸçŠ¶æ€å«ä¹‰**ï¼š
- `(active)`ï¼šåŒºåŸŸå½“å‰æ´»è·ƒï¼Œæœ‰æ¥å£ç»‘å®š
- `(inactive)`ï¼šåŒºåŸŸå­˜åœ¨ä½†æœªä½¿ç”¨

**targetç›®æ ‡åŠ¨ä½œ**ï¼š
- `default`ï¼šä½¿ç”¨åŒºåŸŸé»˜è®¤è¡Œä¸º
- `ACCEPT`ï¼šæ¥å—æ‰€æœ‰æµé‡
- `DROP`ï¼šä¸¢å¼ƒæ‰€æœ‰æµé‡
- `REJECT`ï¼šæ‹’ç»æ‰€æœ‰æµé‡

### 8.3 é…ç½®é¡¹å«ä¹‰è§£é‡Š


**services vs portsåŒºåˆ«**ï¼š
```
services: ssh http
â†‘ ä½¿ç”¨é¢„å®šä¹‰æœåŠ¡åï¼Œè‡ªåŠ¨åŒ…å«ç›¸å…³ç«¯å£

ports: 80/tcp 443/tcp  
â†‘ ç›´æ¥æŒ‡å®šç«¯å£å·å’Œåè®®
```

**masqueradeï¼ˆIPä¼ªè£…ï¼‰**ï¼š
- `yes`ï¼šå¯ç”¨NATåœ°å€è½¬æ¢
- `no`ï¼šç¦ç”¨NATåŠŸèƒ½

**forward-portsï¼ˆç«¯å£è½¬å‘ï¼‰**ï¼š
```bash
# ç«¯å£è½¬å‘æ ¼å¼ç¤ºä¾‹
port=80:proto=tcp:toport=8080:toaddr=192.168.1.100
# å«ä¹‰ï¼šå°†80ç«¯å£çš„TCPæµé‡è½¬å‘åˆ°192.168.1.100:8080
```

### 8.4 è¾“å‡ºä¿¡æ¯çš„å®ç”¨æ€§


**æ—¥å¸¸è¿ç»´åº”ç”¨**ï¼š
```bash
# å¿«é€Ÿæ£€æŸ¥SSHæ˜¯å¦å¼€æ”¾
firewall-cmd --list-services | grep ssh

# æ£€æŸ¥ç‰¹å®šç«¯å£æ˜¯å¦å¼€æ”¾  
firewall-cmd --list-ports | grep 80/tcp

# è·å–ç®€æ´çš„çŠ¶æ€ä¿¡æ¯
firewall-cmd --state && firewall-cmd --get-default-zone
```

> ğŸ¯ **å®ç”¨æŠ€å·§**ï¼šç»“åˆgrepå‘½ä»¤å¯ä»¥å¿«é€ŸæŸ¥æ‰¾ç‰¹å®šé…ç½®é¡¹

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ firewall-cmdæœ¬è´¨ï¼šfirewalldçš„å‘½ä»¤è¡Œæ§åˆ¶å·¥å…·
ğŸ”¸ ä¸¤ç§æ¨¡å¼ï¼šruntime(ä¸´æ—¶)å’Œpermanent(æ°¸ä¹…)
ğŸ”¸ é‡è½½æœºåˆ¶ï¼špermanenté…ç½®éœ€è¦reloadæ‰èƒ½ç”Ÿæ•ˆ  
ğŸ”¸ å‘½ä»¤åˆ†ç±»ï¼š--getè·å–ä¿¡æ¯ï¼Œ--listæ˜¾ç¤ºåˆ—è¡¨ï¼Œ--add/removeæ“ä½œè§„åˆ™
ğŸ”¸ å®‰å…¨æ“ä½œï¼šå…ˆæµ‹è¯•runtimeï¼Œç¡®è®¤ååšpermanenté…ç½®
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ runtime vs permanentçš„é€‰æ‹©**ï¼š
```
ä¸´æ—¶æµ‹è¯•  â†’ runtimeæ¨¡å¼
æ­£å¼é…ç½®  â†’ permanentæ¨¡å¼  
ç´§æ€¥å¤„ç†  â†’ runtimeæ¨¡å¼
æ‰¹é‡é…ç½®  â†’ permanent + reload
```

**ğŸ”¹ reloadçš„æ—¶æœºæŠŠæ¡**ï¼š
```
å¿…é¡»reloadçš„æƒ…å†µï¼š
â€¢ æ‰§è¡Œäº†permanentæ“ä½œ
â€¢ ä¿®æ”¹äº†é…ç½®æ–‡ä»¶
â€¢ éœ€è¦permanenté…ç½®ç”Ÿæ•ˆ

ä¸éœ€è¦reloadçš„æƒ…å†µï¼š
â€¢ ä»…åšruntimeæ“ä½œ
â€¢ åªæ˜¯æŸ¥è¯¢å‘½ä»¤
```

**ğŸ”¹ å‘½ä»¤è¾“å‡ºçš„ç†è§£**ï¼š
```
--getç³»åˆ—  â†’ ç®€æ´è¾“å‡ºï¼Œé€‚åˆè„šæœ¬
--listç³»åˆ— â†’ è¯¦ç»†è¾“å‡ºï¼Œé€‚åˆæŸ¥çœ‹
--state    â†’ è¿”å›çŠ¶æ€å€¼
--list-all â†’ è¿”å›å®Œæ•´é…ç½®
```

### 9.3 å®é™…åº”ç”¨ä»·å€¼


**æ—¥å¸¸è¿ç»´åœºæ™¯**ï¼š
- **å¿«é€ŸæŸ¥è¯¢**ï¼šä½¿ç”¨--getå’Œ--listå‘½ä»¤æŸ¥çœ‹å½“å‰é…ç½®
- **å®‰å…¨æµ‹è¯•**ï¼šä½¿ç”¨runtimeæ¨¡å¼è¿›è¡Œä¸´æ—¶é…ç½®æµ‹è¯•
- **æ‰¹é‡é…ç½®**ï¼šä½¿ç”¨permanentæ¨¡å¼è¿›è¡Œæ­£å¼ç¯å¢ƒé…ç½®
- **æ•…éšœæ’æŸ¥**ï¼šé€šè¿‡--list-allæŸ¥çœ‹å®Œæ•´é˜²ç«å¢™çŠ¶æ€

**æœ€ä½³å®è·µæ€»ç»“**ï¼š
```bash
# æ ‡å‡†é…ç½®æµç¨‹
1. æŸ¥çœ‹å½“å‰çŠ¶æ€ï¼šfirewall-cmd --list-all
2. æµ‹è¯•é…ç½®ï¼šfirewall-cmd --add-port=80/tcp
3. éªŒè¯æ•ˆæœï¼šæµ‹è¯•è¿æ¥
4. æ°¸ä¹…é…ç½®ï¼šfirewall-cmd --permanent --add-port=80/tcp  
5. é‡è½½ç”Ÿæ•ˆï¼šfirewall-cmd --reload
6. æœ€ç»ˆç¡®è®¤ï¼šfirewall-cmd --list-all
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- firewall-cmdæ˜¯é˜²ç«å¢™é¥æ§å™¨
- runtimeä¸´æ—¶ï¼Œpermanentæ°¸ä¹…
- permanentè¦reloadæ‰ç”Ÿæ•ˆ
- getç®€æ´ï¼Œlistè¯¦ç»†ï¼Œæ“ä½œè¦è°¨æ…