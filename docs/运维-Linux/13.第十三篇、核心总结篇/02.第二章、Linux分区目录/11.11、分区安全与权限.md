---
title: 11ã€åˆ†åŒºå®‰å…¨ä¸æƒé™
---
## ğŸ“š ç›®å½•

1. [åˆ†åŒºå®‰å…¨æ¦‚è¿°](#1-åˆ†åŒºå®‰å…¨æ¦‚è¿°)
2. [åˆ†åŒºçº§æƒé™æ§åˆ¶](#2-åˆ†åŒºçº§æƒé™æ§åˆ¶)
3. [å®‰å…¨æŒ‚è½½é€‰é¡¹è¯¦è§£](#3-å®‰å…¨æŒ‚è½½é€‰é¡¹è¯¦è§£)
4. [å…³é”®ç›®å½•å®‰å…¨åŠ å›º](#4-å…³é”®ç›®å½•å®‰å…¨åŠ å›º)
5. [åˆ†åŒºåŠ å¯†é…ç½®](#5-åˆ†åŒºåŠ å¯†é…ç½®)
6. [åªè¯»åˆ†åŒºè®¾ç½®](#6-åªè¯»åˆ†åŒºè®¾ç½®)
7. [å®¡è®¡æ—¥å¿—è®°å½•](#7-å®¡è®¡æ—¥å¿—è®°å½•)
8. [å®‰å…¨æŒ‚è½½æœ€ä½³å®è·µ](#8-å®‰å…¨æŒ‚è½½æœ€ä½³å®è·µ)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” åˆ†åŒºå®‰å…¨æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯åˆ†åŒºå®‰å…¨

**ç®€å•ç†è§£**ï¼šåˆ†åŒºå®‰å…¨å°±æ˜¯å¯¹Linuxç³»ç»Ÿä¸­ä¸åŒåˆ†åŒºï¼ˆç¡¬ç›˜åˆ’åˆ†çš„åŒºåŸŸï¼‰è®¾ç½®å®‰å…¨é™åˆ¶ï¼Œé˜²æ­¢æ¶æ„ç¨‹åºæˆ–è¯¯æ“ä½œç ´åç³»ç»Ÿã€‚

```
æƒ³è±¡ä¸€ä¸‹ä½ çš„æˆ¿å­ï¼š
ğŸ  æ•´ä¸ªæˆ¿å­ = æ•´ä¸ªç¡¬ç›˜
ğŸšª ä¸åŒæˆ¿é—´ = ä¸åŒåˆ†åŒºï¼ˆ/ã€/homeã€/tmpç­‰ï¼‰
ğŸ” æˆ¿é—´é—¨é” = åˆ†åŒºå®‰å…¨è®¾ç½®

æ¯ä¸ªæˆ¿é—´å¯ä»¥è®¾ç½®ä¸åŒçš„å®‰å…¨è§„åˆ™ï¼š
- å®¢å…ï¼šä»»ä½•äººéƒ½èƒ½è¿›å…¥
- å§å®¤ï¼šåªæœ‰ä¸»äººèƒ½è¿›å…¥  
- ä¿é™©åº“ï¼šä¸¥æ ¼åŠ å¯†ä¿æŠ¤
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦åˆ†åŒºå®‰å…¨


**ğŸ¯ æ ¸å¿ƒç›®æ ‡**ï¼š
- **é˜²æ­¢æ¶æ„æ‰§è¡Œ**ï¼šé˜»æ­¢ç—…æ¯’ã€æœ¨é©¬åœ¨ç‰¹å®šåˆ†åŒºè¿è¡Œ
- **æ•°æ®ä¿æŠ¤**ï¼šæ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨
- **ç³»ç»Ÿç¨³å®š**ï¼šé˜²æ­¢æ„å¤–åˆ é™¤æˆ–ä¿®æ”¹é‡è¦æ–‡ä»¶
- **æƒé™éš”ç¦»**ï¼šä¸åŒç”¨æˆ·åªèƒ½è®¿é—®å…è®¸çš„åŒºåŸŸ

**ğŸ“Š å¸¸è§å¨èƒåœºæ™¯**ï¼š
```
åœºæ™¯1ï¼šæ¶æ„è½¯ä»¶æ”»å‡»
/tmpç›®å½•è¢«ä¸Šä¼ ç—…æ¯’ â†’ å¦‚æœèƒ½æ‰§è¡Œ â†’ ç³»ç»Ÿæ„ŸæŸ“
è§£å†³ï¼šè®¾ç½®noexecé€‰é¡¹ â†’ æ— æ³•æ‰§è¡Œ

åœºæ™¯2ï¼šæƒé™æå‡æ”»å‡»  
æ™®é€šç”¨æˆ·ä¸Šä¼ suidç¨‹åº â†’ è·å¾—rootæƒé™
è§£å†³ï¼šè®¾ç½®nosuidé€‰é¡¹ â†’ å¿½ç•¥suidä½

åœºæ™¯3ï¼šæ•°æ®æ³„éœ²
æ•æ„Ÿæ–‡ä»¶è¢«éæ³•è®¿é—®
è§£å†³ï¼šåˆ†åŒºåŠ å¯† â†’ æ•°æ®å®‰å…¨
```

### 1.3 åˆ†åŒºå®‰å…¨å±‚æ¬¡ç»“æ„


```
Linuxåˆ†åŒºå®‰å…¨ä½“ç³»ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         åº”ç”¨å±‚å®‰å…¨                   â”‚  â† SELinuxã€AppArmor
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         æ–‡ä»¶ç³»ç»Ÿæƒé™                 â”‚  â† chmodã€chownã€ACL
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         åˆ†åŒºçº§å®‰å…¨ â­                â”‚  â† æŒ‚è½½é€‰é¡¹ã€åŠ å¯†
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         å—è®¾å¤‡å®‰å…¨                   â”‚  â† è®¾å¤‡æƒé™
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ğŸ›¡ï¸ åˆ†åŒºçº§æƒé™æ§åˆ¶


### 2.1 æƒé™æ§åˆ¶åŸºç¡€æ¦‚å¿µ


**åˆ†åŒºæƒé™ vs æ–‡ä»¶æƒé™**ï¼š
```
æ–‡ä»¶æƒé™ï¼ˆrwxï¼‰ï¼š
-rw-r--r-- 1 user group 1024 file.txt
â†‘ æ§åˆ¶å•ä¸ªæ–‡ä»¶çš„è¯»å†™æ‰§è¡Œ

åˆ†åŒºæƒé™ï¼ˆæŒ‚è½½é€‰é¡¹ï¼‰ï¼š
/dev/sda1 /tmp ext4 defaults,noexec,nosuid 0 0
                         â†‘ æ§åˆ¶æ•´ä¸ªåˆ†åŒºçš„è¡Œä¸ºè§„åˆ™
```

> ğŸ’¡ **ç†è§£è¦ç‚¹**ï¼šåˆ†åŒºæƒé™æ˜¯"å¤§èŒƒå›´é™åˆ¶"ï¼Œæ–‡ä»¶æƒé™æ˜¯"ç»†ç²’åº¦æ§åˆ¶"

### 2.2 æƒé™æ§åˆ¶æœºåˆ¶


**ğŸ”¸ æƒé™ç»§æ‰¿å…³ç³»**ï¼š
```
ç³»ç»Ÿæƒé™æ£€æŸ¥é¡ºåºï¼š
1. åˆ†åŒºæŒ‚è½½é€‰é¡¹æ£€æŸ¥ â† æœ€ä¼˜å…ˆ
2. æ–‡ä»¶ç³»ç»Ÿæƒé™æ£€æŸ¥  
3. ç”¨æˆ·æƒé™æ£€æŸ¥
4. åº”ç”¨å±‚å®‰å…¨ç­–ç•¥

ç¤ºä¾‹ï¼šå³ä½¿æ–‡ä»¶æœ‰æ‰§è¡Œæƒé™ï¼Œå¦‚æœåˆ†åŒºè®¾ç½®äº†noexecï¼Œä¾ç„¶æ— æ³•æ‰§è¡Œ
```

**ğŸ”¸ æƒé™æ§åˆ¶èŒƒå›´**ï¼š

| **æ§åˆ¶çº§åˆ«** | **ä½œç”¨èŒƒå›´** | **å…¸å‹åº”ç”¨** |
|-------------|-------------|-------------|
| **åˆ†åŒºçº§** | `æ•´ä¸ªæŒ‚è½½ç‚¹` | `noexecã€nosuidã€ro` |
| **ç›®å½•çº§** | `ç›®å½•åŠå­ç›®å½•` | `sticky bitã€ACL` |
| **æ–‡ä»¶çº§** | `å•ä¸ªæ–‡ä»¶` | `chmod 755 file` |

### 2.3 å®é™…æƒé™æ§åˆ¶ç¤ºä¾‹


```bash
# æŸ¥çœ‹å½“å‰åˆ†åŒºæŒ‚è½½é€‰é¡¹
mount | grep -E "(tmp|home|var)"

# ä¸´æ—¶ä¿®æ”¹åˆ†åŒºæƒé™ï¼ˆé‡å¯å¤±æ•ˆï¼‰
sudo mount -o remount,noexec,nosuid /tmp

# æ°¸ä¹…ä¿®æ”¹åˆ†åŒºæƒé™ï¼ˆç¼–è¾‘fstabï¼‰
sudo vim /etc/fstab
# /dev/sda2 /tmp ext4 defaults,noexec,nosuid,nodev 0 0
```

**æµ‹è¯•æƒé™æ•ˆæœ**ï¼š
```bash
# åœ¨/tmpåˆ›å»ºæµ‹è¯•è„šæœ¬
echo '#!/bin/bash\necho "Hello World"' > /tmp/test.sh
chmod +x /tmp/test.sh

# è®¾ç½®noexecå‰ï¼šèƒ½æ‰§è¡Œ
./tmp/test.sh  # è¾“å‡ºï¼šHello World

# è®¾ç½®noexecåï¼šæ— æ³•æ‰§è¡Œ
./tmp/test.sh  # é”™è¯¯ï¼šPermission denied
```

---

## 3. âš™ï¸ å®‰å…¨æŒ‚è½½é€‰é¡¹è¯¦è§£


### 3.1 noexecé€‰é¡¹ - ç¦æ­¢æ‰§è¡Œ


**ğŸ¯ ä½œç”¨**ï¼šé˜²æ­¢åœ¨è¯¥åˆ†åŒºæ‰§è¡Œä»»ä½•ç¨‹åºæ–‡ä»¶

```
åŸç†è§£é‡Šï¼š
æ™®é€šæƒ…å†µï¼šç¨‹åºæ–‡ä»¶ â†’ åŠ è½½åˆ°å†…å­˜ â†’ CPUæ‰§è¡Œ
noexecæƒ…å†µï¼šç¨‹åºæ–‡ä»¶ â†’ ç³»ç»Ÿæ‹’ç»åŠ è½½ â†’ æŠ¥é”™

å°±åƒåœ¨å›¾ä¹¦é¦†è´´"ç¦æ­¢å¤§å£°å–§å“—"ï¼Œä»æºå¤´é˜²æ­¢è¡Œä¸ºå‘ç”Ÿ
```

**å…¸å‹åº”ç”¨åœºæ™¯**ï¼š
```bash
# /tmpç›®å½• - ä¸´æ—¶æ–‡ä»¶å­˜å‚¨åŒº
/dev/sda1 /tmp ext4 defaults,noexec 0 0

# /var/www - WebæœåŠ¡å™¨ç›®å½•  
/dev/sda2 /var/www ext4 defaults,noexec 0 0

# /home/shared - å…±äº«æ–‡ä»¶ç›®å½•
/dev/sda3 /home/shared ext4 defaults,noexec 0 0
```

**âš ï¸ æ³¨æ„äº‹é¡¹**ï¼š
- è„šæœ¬è§£é‡Šå™¨ä»å¯è¿è¡Œï¼š`bash /tmp/script.sh`
- ä¸å½±å“ç³»ç»Ÿå‘½ä»¤ï¼š`/bin/ls` ä»æ­£å¸¸å·¥ä½œ
- Javaç­‰è§£é‡Šå‹è¯­è¨€ä¸å—å½±å“

### 3.2 nosuidé€‰é¡¹ - å¿½ç•¥SUIDä½


**ğŸ¯ ä½œç”¨**ï¼šå¿½ç•¥æ–‡ä»¶çš„SUID/SGIDä½è®¾ç½®ï¼Œé˜²æ­¢æƒé™æå‡æ”»å‡»

```
SUIDæœºåˆ¶åŸç†ï¼š
æ™®é€šæ–‡ä»¶ï¼šä»¥è¿è¡Œè€…èº«ä»½æ‰§è¡Œ
SUIDæ–‡ä»¶ï¼šä»¥æ–‡ä»¶æ‰€æœ‰è€…èº«ä»½æ‰§è¡Œ

å±é™©ç¤ºä¾‹ï¼š
-rwsr-xr-x 1 root root /tmp/evil  â† æ™®é€šç”¨æˆ·æ‰§è¡Œè·å¾—rootæƒé™
nosuidåï¼šæŒ‰æ™®é€šç”¨æˆ·æƒé™æ‰§è¡Œ   â† å®‰å…¨
```

**å®é™…æµ‹è¯•**ï¼š
```bash
# åˆ›å»ºæµ‹è¯•SUIDç¨‹åº
sudo cp /bin/cat /tmp/test_suid
sudo chmod u+s /tmp/test_suid
ls -l /tmp/test_suid  # -rwsr-xr-x

# æ— nosuidæ—¶ï¼šä»¥rootèº«ä»½è¿è¡Œ
/tmp/test_suid /etc/shadow  # å¯èƒ½æˆåŠŸè¯»å–

# æœ‰nosuidæ—¶ï¼šä»¥å½“å‰ç”¨æˆ·èº«ä»½è¿è¡Œ  
/tmp/test_suid /etc/shadow  # Permission denied
```

### 3.3 nodevé€‰é¡¹ - ç¦æ­¢è®¾å¤‡æ–‡ä»¶


**ğŸ¯ ä½œç”¨**ï¼šé˜²æ­¢åœ¨è¯¥åˆ†åŒºåˆ›å»ºæˆ–ä½¿ç”¨è®¾å¤‡æ–‡ä»¶

```
è®¾å¤‡æ–‡ä»¶å±é™©æ€§ï¼š
/dev/sda1 â† ç›´æ¥è®¿é—®ç¡¬ç›˜
/dev/kmem â† ç›´æ¥è®¿é—®å†…æ ¸å†…å­˜

æ”»å‡»è€…å¯èƒ½ï¼šåˆ›å»ºæ¶æ„è®¾å¤‡æ–‡ä»¶ â†’ ç»•è¿‡æ–‡ä»¶ç³»ç»Ÿé™åˆ¶ â†’ ç›´æ¥è®¿é—®ç¡¬ä»¶
```

**åº”ç”¨åœºæ™¯**ï¼š
```bash
# ç”¨æˆ·ç›®å½•ä¸åº”åŒ…å«è®¾å¤‡æ–‡ä»¶
/dev/sda3 /home ext4 defaults,nodev 0 0

# Webç›®å½•ç»å¯¹ç¦æ­¢è®¾å¤‡æ–‡ä»¶
/dev/sda4 /var/www ext4 defaults,nodev,noexec,nosuid 0 0
```

### 3.4 roé€‰é¡¹ - åªè¯»æŒ‚è½½


**ğŸ¯ ä½œç”¨**ï¼šæ•´ä¸ªåˆ†åŒºåªèƒ½è¯»å–ï¼Œæ— æ³•å†™å…¥æˆ–ä¿®æ”¹

**å…¸å‹åº”ç”¨**ï¼š
```bash
# ç³»ç»Ÿé…ç½®å¤‡ä»½åˆ†åŒº
/dev/sda5 /backup ext4 ro 0 0

# é‡è¦æ•°æ®å­˜æ¡£åˆ†åŒº
/dev/sda6 /archive ext4 ro 0 0

# ä¸´æ—¶åªè¯»æŒ‚è½½
sudo mount -o ro /dev/sdb1 /mnt/readonly
```

### 3.5 ç»¼åˆå®‰å…¨é€‰é¡¹ç»„åˆ


**ğŸ† æ¨èå®‰å…¨ç»„åˆ**ï¼š

| **åˆ†åŒº** | **æ¨èé€‰é¡¹** | **å®‰å…¨è¯´æ˜** |
|---------|-------------|-------------|
| **`/tmp`** | `noexec,nosuid,nodev` | `é˜²æ­¢æ¶æ„ç¨‹åºæ‰§è¡Œå’Œæƒé™æå‡` |
| **`/var`** | `nosuid,nodev` | `æ—¥å¿—å’Œä¸´æ—¶æ•°æ®ï¼Œé˜²æ­¢è®¾å¤‡æ”»å‡»` |
| **`/home`** | `nosuid,nodev` | `ç”¨æˆ·æ•°æ®ï¼Œé˜²æ­¢æƒé™æå‡` |
| **`/usr`** | `ro` (å¯é€‰) | `ç³»ç»Ÿç¨‹åºï¼Œåªè¯»ä¿æŠ¤` |
| **`/boot`** | `ro` | `å¯åŠ¨æ–‡ä»¶ï¼Œä¸¥æ ¼åªè¯»` |

---

## 4. ğŸ  å…³é”®ç›®å½•å®‰å…¨åŠ å›º


### 4.1 /tmpåˆ†åŒºå®‰å…¨åŠ å›º


**ä¸ºä»€ä¹ˆ/tmpæœ€å±é™©**ï¼š
```
/tmpç›®å½•ç‰¹ç‚¹ï¼š
âœ… ä»»ä½•ç”¨æˆ·éƒ½å¯å†™å…¥
âœ… ç»å¸¸ç”¨äºä¸´æ—¶æ–‡ä»¶å­˜å‚¨  
âœ… ç¨‹åºç»å¸¸åœ¨æ­¤åˆ›å»ºä¸´æ—¶è„šæœ¬
âŒ æ”»å‡»è€…æœ€å–œæ¬¢çš„ä¸Šä¼ ç›®æ ‡
```

**ğŸ”§ å®Œæ•´åŠ å›ºæ–¹æ¡ˆ**ï¼š
```bash
# æ–¹æ¡ˆ1ï¼šç‹¬ç«‹åˆ†åŒºæŒ‚è½½ï¼ˆæ¨èï¼‰
# åˆ›å»ºä¸“ç”¨åˆ†åŒºç”¨äº/tmp
sudo fdisk /dev/sda  # åˆ›å»ºæ–°åˆ†åŒº
sudo mkfs.ext4 /dev/sda7
sudo mount -o noexec,nosuid,nodev /dev/sda7 /tmp

# æ–¹æ¡ˆ2ï¼štmpfså†…å­˜æ–‡ä»¶ç³»ç»Ÿï¼ˆé«˜å®‰å…¨ï¼‰
echo "tmpfs /tmp tmpfs defaults,noexec,nosuid,nodev,size=2G 0 0" >> /etc/fstab
```

**ğŸ¯ /tmpåŠ å›ºåçš„æ•ˆæœ**ï¼š
```bash
# æµ‹è¯•ï¼šä¸Šä¼ æ¶æ„ç¨‹åºæ— æ³•æ‰§è¡Œ
echo '#!/bin/bash\nrm -rf /' > /tmp/virus.sh
chmod +x /tmp/virus.sh
/tmp/virus.sh  # Permission denied (noexecç”Ÿæ•ˆ)

# æµ‹è¯•ï¼šæ— æ³•åˆ›å»ºè®¾å¤‡æ–‡ä»¶  
mknod /tmp/fake_dev c 1 1  # Operation not permitted (nodevç”Ÿæ•ˆ)
```

### 4.2 /varåˆ†åŒºå®‰å…¨é…ç½®


**å…³é”®å­ç›®å½•å®‰å…¨**ï¼š
```
/varç›®å½•ç»“æ„ä¸å®‰å…¨è¦æ±‚ï¼š
/var
â”œâ”€â”€ log/     â† æ—¥å¿—æ–‡ä»¶ï¼Œéœ€è¦é˜²ç¯¡æ”¹
â”œâ”€â”€ tmp/     â† ä¸´æ—¶æ–‡ä»¶ï¼Œç±»ä¼¼/tmpå¤„ç†
â”œâ”€â”€ www/     â† Webæ–‡ä»¶ï¼Œä¸¥æ ¼é™åˆ¶æ‰§è¡Œ
â”œâ”€â”€ spool/   â† é‚®ä»¶é˜Ÿåˆ—ï¼Œé˜²æ­¢æƒé™æå‡
â””â”€â”€ cache/   â† ç¼“å­˜æ•°æ®ï¼Œä¸€èˆ¬å®‰å…¨é£é™©è¾ƒä½
```

**é…ç½®ç¤ºä¾‹**ï¼š
```bash
# /varç‹¬ç«‹åˆ†åŒºé…ç½®
/dev/sda4 /var ext4 defaults,nosuid,nodev 0 0

# /var/wwwç‰¹æ®Šé…ç½®ï¼ˆWebæœåŠ¡å™¨ï¼‰
/dev/sda5 /var/www ext4 defaults,noexec,nosuid,nodev 0 0

# /var/logåªè¯»ä¿æŠ¤ï¼ˆå¯é€‰ï¼‰
sudo mount -o remount,ro /var/log  # ä¸´æ—¶åªè¯»ï¼Œé˜²æ­¢æ—¥å¿—è¢«åˆ 
```

### 4.3 æ•æ„Ÿç›®å½•è®¿é—®é™åˆ¶


**ğŸ”’ é‡è¦ç³»ç»Ÿç›®å½•ä¿æŠ¤**ï¼š

```bash
# /bootç›®å½•ä¿æŠ¤ï¼ˆå¯åŠ¨æ–‡ä»¶ï¼‰
/dev/sda1 /boot ext4 defaults,ro 0 0  # åªè¯»ä¿æŠ¤

# /usrç›®å½•ä¿æŠ¤ï¼ˆç³»ç»Ÿç¨‹åºï¼‰  
/dev/sda2 /usr ext4 defaults,ro 0 0   # åªè¯»ä¿æŠ¤ï¼ˆå¯é€‰ï¼‰

# /etcå¤‡ä»½ä¿æŠ¤
sudo cp -r /etc /etc.backup
sudo mount -o bind,ro /etc.backup /mnt/etc_readonly
```

**ğŸ“ ç›®å½•æƒé™å¼ºåŒ–**ï¼š
```bash  
# é‡è¦ç›®å½•è®¾ç½®sticky bit
sudo chmod 1777 /tmp    # åªæœ‰æ–‡ä»¶æ‰€æœ‰è€…èƒ½åˆ é™¤è‡ªå·±çš„æ–‡ä»¶
sudo chmod 1777 /var/tmp

# æ•æ„Ÿç›®å½•é™åˆ¶è®¿é—®
sudo chmod 700 /root    # åªæœ‰rootèƒ½è®¿é—®
sudo chmod 755 /home    # ç”¨æˆ·ç›®å½•åŸºç¡€æƒé™
```

---

## 5. ğŸ” åˆ†åŒºåŠ å¯†é…ç½®


### 5.1 åˆ†åŒºåŠ å¯†åŸºç¡€æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯åˆ†åŒºåŠ å¯†**ï¼š
```
æƒ³è±¡ä¿é™©ç®±ï¼š
æ™®é€šåˆ†åŒº = é€æ˜ç»ç’ƒç®± â† æ•°æ®ç›´æ¥å¯è§
åŠ å¯†åˆ†åŒº = å¯†ç ä¿é™©ç®± â† å¿…é¡»å¯†ç è§£é”æ‰èƒ½çœ‹åˆ°å†…å®¹

æŠ€æœ¯åŸç†ï¼š
åŸå§‹æ•°æ® â†’ åŠ å¯†ç®—æ³•(AES) â†’ å¯†æ–‡å­˜å‚¨åˆ°ç¡¬ç›˜
è¯»å–æ—¶ï¼šå¯†æ–‡ â†’ è§£å¯†ç®—æ³• â†’ åŸå§‹æ•°æ®
```

**ğŸ¯ åŠ å¯†çš„å¥½å¤„**ï¼š
- **æ•°æ®ä¿æŠ¤**ï¼šç¡¬ç›˜è¢«ç›—ä¹Ÿæ— æ³•è¯»å–æ•°æ®
- **éšç§å®‰å…¨**ï¼šæ•æ„Ÿæ–‡ä»¶å®Œå…¨ä¿æŠ¤  
- **åˆè§„è¦æ±‚**ï¼šæ»¡è¶³æ•°æ®ä¿æŠ¤æ³•è§„

### 5.2 LUKSåŠ å¯†å®è·µ


**LUKSæ˜¯ä»€ä¹ˆ**ï¼š
> ğŸ’¡ **LUKS**ï¼ˆLinux Unified Key Setupï¼‰= Linuxæ ‡å‡†çš„ç¡¬ç›˜åŠ å¯†æ–¹æ¡ˆï¼Œç±»ä¼¼äºWindowsçš„BitLocker

**ğŸ”§ åˆ›å»ºåŠ å¯†åˆ†åŒº**ï¼š
```bash
# æ­¥éª¤1ï¼šå®‰è£…åŠ å¯†å·¥å…·
sudo apt install cryptsetup  # Ubuntu/Debian
sudo yum install cryptsetup  # CentOS/RHEL

# æ­¥éª¤2ï¼šåˆ›å»ºLUKSåŠ å¯†åˆ†åŒº
sudo cryptsetup luksFormat /dev/sda3
# ä¼šè¦æ±‚è®¾ç½®å¯†ç ï¼Œè¯·ç‰¢è®°ï¼

# æ­¥éª¤3ï¼šæ‰“å¼€åŠ å¯†åˆ†åŒº
sudo cryptsetup luksOpen /dev/sda3 encrypted_data
# encrypted_dataæ˜¯è§£é”åçš„è®¾å¤‡å

# æ­¥éª¤4ï¼šæ ¼å¼åŒ–å’ŒæŒ‚è½½
sudo mkfs.ext4 /dev/mapper/encrypted_data  
sudo mount /dev/mapper/encrypted_data /mnt/secure
```

**ğŸ—ï¸ æ—¥å¸¸ä½¿ç”¨æµç¨‹**ï¼š
```bash
# å¼€æœºåæ‰‹åŠ¨è§£é”
sudo cryptsetup luksOpen /dev/sda3 secure_partition
sudo mount /dev/mapper/secure_partition /home/secure

# ä½¿ç”¨å®Œæ¯•åé”å®š
sudo umount /home/secure  
sudo cryptsetup luksClose secure_partition
```

### 5.3 è‡ªåŠ¨æŒ‚è½½åŠ å¯†åˆ†åŒº


**é…ç½®å¯†é’¥æ–‡ä»¶**ï¼ˆâš ï¸ å®‰å…¨æƒè¡¡ï¼‰ï¼š
```bash
# åˆ›å»ºå¯†é’¥æ–‡ä»¶ï¼ˆæ³¨æ„æƒé™ï¼‰
sudo dd if=/dev/urandom of=/etc/luks-key bs=1024 count=4
sudo chmod 600 /etc/luks-key

# æ·»åŠ å¯†é’¥åˆ°LUKS
sudo cryptsetup luksAddKey /dev/sda3 /etc/luks-key

# é…ç½®è‡ªåŠ¨è§£é”
echo "secure_data /dev/sda3 /etc/luks-key luks" >> /etc/crypttab
echo "/dev/mapper/secure_data /mnt/secure ext4 defaults 0 0" >> /etc/fstab
```

### 5.4 åŠ å¯†åˆ†åŒºæœ€ä½³å®è·µ


**ğŸ† æ¨èåŠ å¯†ç­–ç•¥**ï¼š

| **æ•°æ®ç±»å‹** | **åŠ å¯†æ–¹æ¡ˆ** | **æŒ‚è½½é€‰é¡¹** |
|-------------|-------------|-------------|
| **ä¸ªäººæ–‡æ¡£** | `LUKS + å¯†ç è§£é”` | `defaults,nodev` |
| **æ•°æ®åº“æ–‡ä»¶** | `LUKS + å¯†é’¥æ–‡ä»¶` | `defaults,noatime` |
| **å¤‡ä»½æ•°æ®** | `LUKS + æ‰‹åŠ¨æŒ‚è½½` | `ro,noauto` |

**âš ï¸ å®‰å…¨æ³¨æ„äº‹é¡¹**ï¼š
```
å¯†ç å®‰å…¨ï¼š
âœ… ä½¿ç”¨å¼ºå¯†ç ï¼ˆ12ä½ä»¥ä¸Šï¼ŒåŒ…å«æ•°å­—å­—æ¯ç¬¦å·ï¼‰
âœ… å®šæœŸæ›´æ¢å¯†ç 
âŒ ä¸è¦å°†å¯†ç ä¿å­˜åœ¨ç³»ç»Ÿä¸­

å¤‡ä»½å®‰å…¨ï¼š
âœ… å¤‡ä»½LUKSå¤´ä¿¡æ¯ï¼šcryptsetup luksHeaderBackup
âœ… è®°å½•æ¢å¤å¯†ç åˆ°å®‰å…¨ä½ç½®
âŒ ä¸è¦åªä¾èµ–å•ä¸€è§£é”æ–¹å¼
```

---

## 6. ğŸ“– åªè¯»åˆ†åŒºè®¾ç½®


### 6.1 åªè¯»åˆ†åŒºçš„ä½œç”¨


**ä»€ä¹ˆæ˜¯åªè¯»åˆ†åŒº**ï¼š
```
ç±»æ¯”å›¾ä¹¦é¦†ï¼š
å¯å†™åˆ†åŒº = ä½ çš„ç¬”è®°æœ¬ â† å¯ä»¥éšæ„ä¿®æ”¹
åªè¯»åˆ†åŒº = å›¾ä¹¦é¦†çš„ä¹¦ â† åªèƒ½é˜…è¯»ï¼Œä¸èƒ½ä¿®æ”¹

æŠ€æœ¯å®ç°ï¼š
æ–‡ä»¶ç³»ç»Ÿçº§åˆ«ç¦æ­¢å†™æ“ä½œ
ä»»ä½•ä¿®æ”¹å°è¯•éƒ½ä¼šè¢«æ‹’ç»
```

**ğŸ¯ åªè¯»åˆ†åŒºçš„ç”¨é€”**ï¼š
- **ç³»ç»Ÿä¿æŠ¤**ï¼šé˜²æ­¢é‡è¦ç³»ç»Ÿæ–‡ä»¶è¢«æ„å¤–ä¿®æ”¹
- **æ•°æ®å½’æ¡£**ï¼šç¡®ä¿å†å²æ•°æ®ä¸è¢«ç¯¡æ”¹  
- **å®‰å…¨åŠ å›º**ï¼šå‡å°‘æ”»å‡»é¢ï¼Œæé«˜ç³»ç»Ÿå®‰å…¨
- **æ•…éšœæ¢å¤**ï¼šå¿«é€Ÿæ¢å¤åˆ°å·²çŸ¥è‰¯å¥½çŠ¶æ€

### 6.2 ä¸´æ—¶åªè¯»è®¾ç½®


**ğŸ”§ ä¸´æ—¶è®¾ç½®åªè¯»**ï¼š
```bash
# å°†ç°æœ‰åˆ†åŒºè®¾ä¸ºåªè¯»
sudo mount -o remount,ro /home

# éªŒè¯åªè¯»æ•ˆæœ
touch /home/test.txt  # touch: cannot touch '/home/test.txt': Read-only file system

# æ¢å¤å¯å†™çŠ¶æ€
sudo mount -o remount,rw /home
```

**åº”ç”¨åœºæ™¯ç¤ºä¾‹**ï¼š
```bash
# ç³»ç»Ÿç»´æŠ¤æ—¶ä¿æŠ¤ç”¨æˆ·æ•°æ®
sudo mount -o remount,ro /home
# è¿›è¡Œç³»ç»Ÿå‡çº§æˆ–ä¿®å¤...
sudo mount -o remount,rw /home

# æ•°æ®å¤‡ä»½æ—¶é˜²æ­¢ä¿®æ”¹
sudo mount -o remount,ro /var/data
rsync -av /var/data/ /backup/
sudo mount -o remount,rw /var/data
```

### 6.3 æ°¸ä¹…åªè¯»é…ç½®


**ä¿®æ”¹/etc/fstabå®ç°æ°¸ä¹…åªè¯»**ï¼š
```bash
# ç¼–è¾‘fstabæ–‡ä»¶
sudo vim /etc/fstab

# æ·»åŠ åªè¯»é€‰é¡¹
/dev/sda5 /archive ext4 defaults,ro 0 0
/dev/sda6 /backup  ext4 defaults,ro 0 0

# é‡æ–°æŒ‚è½½ç”Ÿæ•ˆ
sudo mount -a
```

**ğŸ† æ¨èåªè¯»åˆ†åŒºè§„åˆ’**ï¼š

| **åˆ†åŒº** | **ç”¨é€”** | **åªè¯»æ—¶æœº** |
|---------|---------|-------------|
| **`/boot`** | `å¯åŠ¨æ–‡ä»¶` | `æ°¸ä¹…åªè¯»` |
| **`/usr`** | `ç³»ç»Ÿç¨‹åº` | `æ­£å¸¸è¿è¡Œæ—¶åªè¯»` |
| **`/archive`** | `æ•°æ®å½’æ¡£` | `æ°¸ä¹…åªè¯»` |
| **`/backup`** | `ç³»ç»Ÿå¤‡ä»½` | `å¤‡ä»½å®Œæˆååªè¯»` |

### 6.4 åªè¯»æ–‡ä»¶ç³»ç»Ÿçš„ç‰¹æ®Šå¤„ç†


**å¤„ç†åªè¯»ç³»ç»Ÿçš„æ—¥å¿—é—®é¢˜**ï¼š
```bash
# é—®é¢˜ï¼šåªè¯»ç³»ç»Ÿæ— æ³•å†™å…¥æ—¥å¿—
# è§£å†³ï¼šä½¿ç”¨å†…å­˜æ–‡ä»¶ç³»ç»Ÿ
echo "tmpfs /var/log tmpfs defaults,size=100M 0 0" >> /etc/fstab

# é—®é¢˜ï¼šåªè¯»ç³»ç»Ÿæ— æ³•æ›´æ–°æ—¶é—´æˆ³
# è§£å†³ï¼šä½¿ç”¨noatimeé€‰é¡¹
/dev/sda2 /usr ext4 defaults,ro,noatime 0 0
```

**åªè¯»ç³»ç»Ÿçš„ç»´æŠ¤æ¨¡å¼**ï¼š
```bash
# åˆ›å»ºç»´æŠ¤è„šæœ¬
cat > /usr/local/bin/maintenance_mode.sh << 'EOF'
#!/bin/bash
if [ "$1" = "on" ]; then
    mount -o remount,rw /usr
    mount -o remount,rw /boot
    echo "ç»´æŠ¤æ¨¡å¼å¼€å¯ï¼šç³»ç»Ÿåˆ†åŒºå¯å†™"
elif [ "$1" = "off" ]; then
    mount -o remount,ro /usr  
    mount -o remount,ro /boot
    echo "ç»´æŠ¤æ¨¡å¼å…³é—­ï¼šç³»ç»Ÿåˆ†åŒºåªè¯»"
else
    echo "ç”¨æ³•: $0 [on|off]"
fi
EOF

sudo chmod +x /usr/local/bin/maintenance_mode.sh
```

---

## 7. ğŸ“Š å®¡è®¡æ—¥å¿—è®°å½•


### 7.1 å®¡è®¡æ—¥å¿—åŸºç¡€æ¦‚å¿µ  


**ä»€ä¹ˆæ˜¯å®¡è®¡æ—¥å¿—**ï¼š
```
å®¡è®¡æ—¥å¿— = ç³»ç»Ÿè¡Œä¸ºçš„"ç›‘æ§å½•åƒ"
è®°å½•å†…å®¹ï¼šè°ã€ä»€ä¹ˆæ—¶å€™ã€åšäº†ä»€ä¹ˆã€ç»“æœå¦‚ä½•

ç±»æ¯”é“¶è¡Œï¼š
æ¯ç¬”äº¤æ˜“éƒ½æœ‰è®°å½• â† å®¡è®¡æ—¥å¿—
ä¾¿äºæŸ¥è´¦å’Œè¿½è¸ªé—®é¢˜ â† å®‰å…¨å®¡è®¡
```

**ğŸ¯ å®¡è®¡çš„é‡è¦æ€§**ï¼š
- **å®‰å…¨è¿½è¸ª**ï¼šå‘ç°å…¥ä¾µå’Œå¼‚å¸¸è¡Œä¸º
- **åˆè§„è¦æ±‚**ï¼šæ»¡è¶³æ³•è§„å’Œæ ‡å‡†è¦æ±‚
- **æ•…éšœè¯Šæ–­**ï¼šå¿«é€Ÿå®šä½é—®é¢˜åŸå›   
- **æ€§èƒ½åˆ†æ**ï¼šäº†è§£ç³»ç»Ÿä½¿ç”¨æ¨¡å¼

### 7.2 auditdç³»ç»Ÿå®¡è®¡


**å®‰è£…å’Œå¯åŠ¨auditd**ï¼š
```bash
# å®‰è£…å®¡è®¡daemon
sudo apt install auditd audispd-plugins  # Ubuntu
sudo yum install audit audit-libs        # CentOS

# å¯åŠ¨å®¡è®¡æœåŠ¡
sudo systemctl enable auditd
sudo systemctl start auditd
```

**ğŸ”§ åŸºç¡€å®¡è®¡è§„åˆ™**ï¼š
```bash
# ç›‘æ§æ–‡ä»¶è®¿é—®
sudo auditctl -w /etc/passwd -p wa -k passwd_changes
sudo auditctl -w /etc/shadow -p wa -k shadow_changes  
sudo auditctl -w /etc/fstab -p wa -k mount_changes

# ç›‘æ§ç›®å½•æ“ä½œ
sudo auditctl -w /tmp -p wa -k tmp_access
sudo auditctl -w /var/log -p wa -k log_access

# ç›‘æ§ç³»ç»Ÿè°ƒç”¨
sudo auditctl -a always,exit -F arch=b64 -S mount -k mount_syscall
sudo auditctl -a always,exit -F arch=b64 -S chmod -k perm_changes
```

**æŸ¥çœ‹å®¡è®¡æ—¥å¿—**ï¼š
```bash
# æŸ¥çœ‹æ‰€æœ‰å®¡è®¡äº‹ä»¶
sudo ausearch -ts today

# æŸ¥çœ‹ç‰¹å®šå…³é”®è¯çš„äº‹ä»¶
sudo ausearch -k passwd_changes
sudo ausearch -k mount_syscall

# æŸ¥çœ‹ç‰¹å®šç”¨æˆ·çš„æ“ä½œ
sudo ausearch -ua username
```

### 7.3 åˆ†åŒºç›¸å…³å®¡è®¡é…ç½®


**ğŸ” é‡ç‚¹ç›‘æ§çš„åˆ†åŒºæ“ä½œ**ï¼š
```bash
# ç›‘æ§æŒ‚è½½æ“ä½œ
sudo auditctl -w /etc/fstab -p wa -k fstab_modifications
sudo auditctl -a always,exit -S mount -S umount2 -k mount_operations

# ç›‘æ§æ•æ„Ÿç›®å½•
sudo auditctl -w /boot -p rwxa -k boot_access  
sudo auditctl -w /etc -p wa -k etc_modifications
sudo auditctl -w /root -p rwxa -k root_access

# ç›‘æ§æƒé™å˜æ›´
sudo auditctl -a always,exit -S chmod -S chown -k permission_changes
sudo auditctl -a always,exit -S setuid -S setgid -k privilege_escalation
```

**ğŸ“‹ é…ç½®æ°¸ä¹…å®¡è®¡è§„åˆ™**ï¼š
```bash
# ç¼–è¾‘å®¡è®¡è§„åˆ™æ–‡ä»¶
sudo vim /etc/audit/rules.d/custom.rules

# æ·»åŠ åˆ†åŒºå®‰å…¨ç›¸å…³è§„åˆ™
-w /etc/fstab -p wa -k fstab_changes
-w /tmp -p rwxa -k tmp_operations  
-w /var/log/auth.log -p wa -k auth_log_changes
-a always,exit -S mount -S umount2 -k mount_syscalls
-a always,exit -S chmod -S chown -k perm_modifications

# é‡æ–°åŠ è½½è§„åˆ™
sudo augenrules --load
```

### 7.4 æ—¥å¿—åˆ†æå’Œå‘Šè­¦


**ğŸ”” å®æ—¶ç›‘æ§è„šæœ¬ç¤ºä¾‹**ï¼š
```bash
#!/bin/bash
# ç›‘æ§æŒ‚è½½æ“ä½œçš„è„šæœ¬
tail -f /var/log/audit/audit.log | grep --line-buffered "mount" | while read line
do
    echo "[$(date)] æ£€æµ‹åˆ°æŒ‚è½½æ“ä½œ: $line"
    # å¯ä»¥æ·»åŠ é‚®ä»¶é€šçŸ¥æˆ–å…¶ä»–å‘Šè­¦æœºåˆ¶
done
```

**ç”Ÿæˆå®¡è®¡æŠ¥å‘Š**ï¼š
```bash
# ç”Ÿæˆä»Šæ—¥çš„å®¡è®¡æŠ¥å‘Š
sudo aureport --start today --summary

# ç”Ÿæˆæ–‡ä»¶è®¿é—®æŠ¥å‘Š
sudo aureport --file --summary

# ç”Ÿæˆç”¨æˆ·æ´»åŠ¨æŠ¥å‘Š  
sudo aureport --user --summary

# ç”Ÿæˆç³»ç»Ÿè°ƒç”¨æŠ¥å‘Š
sudo aureport --syscall --summary
```

---

## 8. ğŸ† å®‰å…¨æŒ‚è½½æœ€ä½³å®è·µ


### 8.1 åˆ†åŒºè§„åˆ’å®‰å…¨åŸåˆ™


**ğŸ¯ å®‰å…¨åˆ†åŒºè§„åˆ’çš„æ ¸å¿ƒæ€è·¯**ï¼š
```
éš”ç¦»åŸåˆ™ï¼šä¸åŒåŠŸèƒ½ä½¿ç”¨ä¸åŒåˆ†åŒº
æœ€å°æƒé™ï¼šæ¯ä¸ªåˆ†åŒºåªç»™å¿…éœ€çš„æƒé™  
æ·±åº¦é˜²å¾¡ï¼šå¤šå±‚å®‰å…¨æªæ–½ç»„åˆä½¿ç”¨
```

**ğŸ“Š æ¨èåˆ†åŒºå®‰å…¨æ–¹æ¡ˆ**ï¼š

```
å®Œæ•´çš„å®‰å…¨åˆ†åŒºå¸ƒå±€ï¼š

/           â† æ ¹åˆ†åŒºï¼ŒåŸºç¡€æƒé™
â”œâ”€â”€ /boot   â† ç‹¬ç«‹åˆ†åŒºï¼Œåªè¯»ä¿æŠ¤
â”œâ”€â”€ /tmp    â† ç‹¬ç«‹åˆ†åŒºï¼Œnoexec+nosuid+nodev  
â”œâ”€â”€ /var    â† ç‹¬ç«‹åˆ†åŒºï¼Œnosuid+nodev
â”‚   â”œâ”€â”€ /var/log    â† å¯é€‰ç‹¬ç«‹ï¼Œè¿½åŠ æ¨¡å¼
â”‚   â””â”€â”€ /var/www    â† å¯é€‰ç‹¬ç«‹ï¼Œnoexec+nosuid+nodev
â”œâ”€â”€ /home   â† ç‹¬ç«‹åˆ†åŒºï¼Œnosuid+nodev
â””â”€â”€ /opt    â† å¯é€‰ç‹¬ç«‹ï¼Œæ ¹æ®éœ€è¦è®¾ç½®æƒé™
```

### 8.2 /etc/fstabæœ€ä½³é…ç½®


**ğŸ”§ å®Œæ•´çš„fstabå®‰å…¨é…ç½®ç¤ºä¾‹**ï¼š
```bash
# è®¾å¤‡             æŒ‚è½½ç‚¹        æ–‡ä»¶ç³»ç»Ÿ  é€‰é¡¹                            dump pass
/dev/sda1         /boot         ext4      defaults,ro                     0    2
/dev/sda2         /             ext4      defaults,errors=remount-ro      0    1  
/dev/sda3         /tmp          ext4      defaults,noexec,nosuid,nodev    0    2
/dev/sda4         /var          ext4      defaults,nosuid,nodev           0    2
/dev/sda5         /home         ext4      defaults,nosuid,nodev           0    2
/dev/sda6         /var/log      ext4      defaults,nodev                  0    2

# ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿï¼ˆå†…å­˜ï¼‰
tmpfs             /run          tmpfs     defaults,noexec,nosuid,size=10% 0    0
tmpfs             /tmp          tmpfs     defaults,noexec,nosuid,nodev    0    0

# åŠ å¯†åˆ†åŒº
/dev/mapper/secure /mnt/secure  ext4      defaults,nodev                  0    0
```

### 8.3 åŠ¨æ€å®‰å…¨ç­–ç•¥


**ğŸ”„ æ ¹æ®è¿è¡ŒçŠ¶æ€è°ƒæ•´å®‰å…¨çº§åˆ«**ï¼š
```bash
# åˆ›å»ºå®‰å…¨çº§åˆ«åˆ‡æ¢è„šæœ¬
cat > /usr/local/bin/security_level.sh << 'EOF'  
#!/bin/bash

case "$1" in
    "high")
        # é«˜å®‰å…¨çº§åˆ«ï¼šæ‰€æœ‰å¯èƒ½åˆ†åŒºåªè¯»
        mount -o remount,ro /boot
        mount -o remount,ro /usr  
        mount -o remount,noexec,nosuid,nodev /tmp
        echo "é«˜å®‰å…¨çº§åˆ«å·²æ¿€æ´»"
        ;;
    "normal")  
        # æ­£å¸¸çº§åˆ«ï¼šåŸºç¡€å®‰å…¨é€‰é¡¹
        mount -o remount,rw /usr
        mount -o remount,noexec,nosuid,nodev /tmp
        echo "æ­£å¸¸å®‰å…¨çº§åˆ«å·²æ¿€æ´»"
        ;;
    "maintenance")
        # ç»´æŠ¤çº§åˆ«ï¼šä¾¿äºç³»ç»Ÿç®¡ç†
        mount -o remount,rw /boot
        mount -o remount,rw /usr
        mount -o remount,rw /tmp
        echo "ç»´æŠ¤çº§åˆ«å·²æ¿€æ´» - æ³¨æ„å®‰å…¨ï¼"
        ;;
    *)
        echo "ç”¨æ³•: $0 {high|normal|maintenance}"
        ;;
esac
EOF

sudo chmod +x /usr/local/bin/security_level.sh
```

### 8.4 è‡ªåŠ¨åŒ–å®‰å…¨æ£€æŸ¥


**ğŸ” åˆ†åŒºå®‰å…¨çŠ¶æ€ç›‘æ§è„šæœ¬**ï¼š
```bash
#!/bin/bash
# åˆ†åŒºå®‰å…¨çŠ¶æ€æ£€æŸ¥è„šæœ¬

echo "=== åˆ†åŒºå®‰å…¨çŠ¶æ€æ£€æŸ¥ ==="
echo

# æ£€æŸ¥å…³é”®åˆ†åŒºçš„æŒ‚è½½é€‰é¡¹
check_mount_options() {
    local partition=$1
    local expected_options=$2
    
    current_options=$(mount | grep " $partition " | sed 's/.*(\(.*\))/\1/')
    echo "åˆ†åŒº $partition å½“å‰é€‰é¡¹: $current_options"
    
    for option in $expected_options; do
        if echo "$current_options" | grep -q "$option"; then
            echo "  âœ… $option - å·²å¯ç”¨"
        else
            echo "  âŒ $option - æœªå¯ç”¨ (å®‰å…¨é£é™©!)"
        fi
    done
    echo
}

# æ£€æŸ¥å„ä¸ªå…³é”®åˆ†åŒº
check_mount_options "/tmp" "noexec nosuid nodev"
check_mount_options "/var" "nosuid nodev"  
check_mount_options "/home" "nosuid nodev"
check_mount_options "/boot" "ro"

# æ£€æŸ¥æ˜¯å¦å­˜åœ¨å¯ç–‘çš„suidæ–‡ä»¶
echo "=== æ£€æŸ¥å¯ç–‘SUIDæ–‡ä»¶ ==="
find /tmp /var/tmp -perm -4000 -type f 2>/dev/null | while read suid_file; do
    echo "âŒ å‘ç°å¯ç–‘SUIDæ–‡ä»¶: $suid_file"  
done

echo "æ£€æŸ¥å®Œæˆï¼"
```

### 8.5 åº”æ€¥å“åº”é¢„æ¡ˆ


**ğŸš¨ å®‰å…¨äº‹ä»¶åº”æ€¥å¤„ç†**ï¼š
```bash
# ç´§æ€¥å®‰å…¨é”å®šè„šæœ¬
cat > /usr/local/bin/emergency_lockdown.sh << 'EOF'
#!/bin/bash
echo "æ‰§è¡Œç´§æ€¥å®‰å…¨é”å®š..."

# 1. ç«‹å³è®¾ç½®æ‰€æœ‰åˆ†åŒºä¸ºæœ€ä¸¥æ ¼æ¨¡å¼
mount -o remount,ro /boot
mount -o remount,ro /usr
mount -o remount,ro /var
mount -o remount,noexec,nosuid,nodev,ro /tmp

# 2. è®°å½•é”å®šæ—¶é—´
echo "$(date): ç´§æ€¥å®‰å…¨é”å®šæ‰§è¡Œ" >> /var/log/security_lockdown.log

# 3. é€šçŸ¥ç®¡ç†å‘˜ï¼ˆå¯é…ç½®é‚®ä»¶æˆ–æ¶ˆæ¯ï¼‰  
logger "SECURITY: Emergency lockdown activated"

echo "ç´§æ€¥å®‰å…¨é”å®šå®Œæˆï¼"
echo "å¦‚éœ€æ¢å¤ï¼Œè¯·è¿è¡Œ: security_level.sh normal"
EOF

sudo chmod +x /usr/local/bin/emergency_lockdown.sh
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ åˆ†åŒºå®‰å…¨æœ¬è´¨ï¼šé€šè¿‡æŒ‚è½½é€‰é¡¹å¯¹æ•´ä¸ªåˆ†åŒºè®¾ç½®å®‰å…¨é™åˆ¶
ğŸ”¸ ä¸‰å¤§æ ¸å¿ƒé€‰é¡¹ï¼šnoexec(ç¦æ‰§è¡Œ)ã€nosuid(å¿½ç•¥SUID)ã€nodev(ç¦è®¾å¤‡)  
ğŸ”¸ æƒé™æ£€æŸ¥é¡ºåºï¼šåˆ†åŒºçº§ â†’ æ–‡ä»¶ç³»ç»Ÿçº§ â†’ ç”¨æˆ·çº§ â†’ åº”ç”¨çº§
ğŸ”¸ åŠ å¯†åˆ†åŒºï¼šLUKSæä¾›é€æ˜çš„åˆ†åŒºçº§æ•°æ®åŠ å¯†ä¿æŠ¤
ğŸ”¸ åªè¯»åˆ†åŒºï¼šroé€‰é¡¹æä¾›æœ€å¼ºçš„æ•°æ®ä¿æŠ¤çº§åˆ«
ğŸ”¸ å®¡è®¡æ—¥å¿—ï¼šauditdè®°å½•æ‰€æœ‰åˆ†åŒºæ“ä½œï¼Œä¾¿äºè¿½è¸ªå’Œåˆ†æ
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ åˆ†åŒºå®‰å…¨çš„å±‚æ¬¡æ€ç»´**ï¼š
```
æƒ³è±¡å¤šé“é˜²çº¿ï¼š
ç¬¬ä¸€é“ï¼šåˆ†åŒºæŒ‚è½½é€‰é¡¹ â† å¤§èŒƒå›´é™åˆ¶
ç¬¬äºŒé“ï¼šæ–‡ä»¶ç³»ç»Ÿæƒé™ â† ä¸­ç­‰ç²’åº¦æ§åˆ¶  
ç¬¬ä¸‰é“ï¼šç”¨æˆ·æƒé™æ£€æŸ¥ â† ç»†ç²’åº¦æ§åˆ¶
ç¬¬å››é“ï¼šåº”ç”¨å±‚å®‰å…¨ â† æœ€åä¸€é“é˜²çº¿

æ¯ä¸€é“é˜²çº¿éƒ½å¾ˆé‡è¦ï¼Œç»„åˆä½¿ç”¨æ•ˆæœæœ€ä½³
```

**ğŸ”¹ å®‰å…¨ä¸ä¾¿åˆ©æ€§çš„å¹³è¡¡**ï¼š
```
å®‰å…¨çº§åˆ«è¶Šé«˜ï¼Œä½¿ç”¨è¶Šä¸ä¾¿ï¼š
æœ€é«˜å®‰å…¨ï¼šæ‰€æœ‰åˆ†åŒºåªè¯» â† æœ€å®‰å…¨ä½†æ— æ³•æ­£å¸¸ä½¿ç”¨
é«˜å®‰å…¨ï¼š/tmp noexec+nosuid â† å®‰å…¨æ€§é«˜ï¼Œè½»å¾®å½±å“ä¾¿åˆ©æ€§
ä¸­ç­‰å®‰å…¨ï¼šä»…å…³é”®åˆ†åŒºé™åˆ¶ â† å¹³è¡¡ç‚¹
ä½å®‰å…¨ï¼šé»˜è®¤æŒ‚è½½é€‰é¡¹ â† ä¾¿åˆ©ä½†å­˜åœ¨é£é™©

å…³é”®æ˜¯æ‰¾åˆ°é€‚åˆè‡ªå·±ç¯å¢ƒçš„å¹³è¡¡ç‚¹
```

### 9.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ’¼ å…¸å‹åº”ç”¨åœºæ™¯**ï¼š

| **ç¯å¢ƒç±»å‹** | **å®‰å…¨ç­–ç•¥** | **é‡ç‚¹ä¿æŠ¤** |
|-------------|-------------|-------------|
| **ä¸ªäººæ¡Œé¢** | `åŸºç¡€å®‰å…¨é€‰é¡¹` | `/tmp noexecï¼Œ/homeåŠ å¯†` |
| **WebæœåŠ¡å™¨** | `ä¸¥æ ¼é™åˆ¶æ‰§è¡Œ` | `/var/www noexec+nosuid+nodev` |
| **æ•°æ®åº“æœåŠ¡å™¨** | `æ•°æ®åŠ å¯†+å®¡è®¡` | `æ•°æ®åˆ†åŒºLUKSåŠ å¯†` |
| **é«˜å®‰å…¨ç¯å¢ƒ** | `å¤šå±‚é˜²æŠ¤` | `æ‰€æœ‰åˆ†åŒºä¸¥æ ¼é™åˆ¶+å…¨é¢å®¡è®¡` |

**ğŸ”§ è¿ç»´å®è·µè¦ç‚¹**ï¼š
```
æ—¥å¸¸ç»´æŠ¤ï¼š
âœ… å®šæœŸæ£€æŸ¥åˆ†åŒºæŒ‚è½½é€‰é¡¹
âœ… ç›‘æ§å®¡è®¡æ—¥å¿—å¼‚å¸¸
âœ… å¤‡ä»½é‡è¦çš„å®‰å…¨é…ç½®
âœ… æµ‹è¯•åº”æ€¥å“åº”é¢„æ¡ˆ

å®‰å…¨é…ç½®ï¼š
âœ… æ¸è¿›å¼éƒ¨ç½²ï¼Œå…ˆæµ‹è¯•åç”Ÿäº§
âœ… æ–‡æ¡£è®°å½•æ‰€æœ‰é…ç½®å˜æ›´
âœ… å»ºç«‹é…ç½®å˜æ›´çš„å›æ»šæœºåˆ¶
âœ… å®šæœŸå®‰å…¨è¯„ä¼°å’Œä¼˜åŒ–
```

### 9.4 å¸¸è§è¯¯åŒºå’Œæ³¨æ„äº‹é¡¹


**âŒ å¸¸è§é”™è¯¯åšæ³•**ï¼š
```
è¿‡åº¦å®‰å…¨ï¼šæŠŠæ‰€æœ‰åˆ†åŒºéƒ½è®¾ä¸ºåªè¯» â†’ ç³»ç»Ÿæ— æ³•æ­£å¸¸å·¥ä½œ
å¿½è§†æµ‹è¯•ï¼šç›´æ¥åœ¨ç”Ÿäº§ç¯å¢ƒåº”ç”¨ä¸¥æ ¼å®‰å…¨é€‰é¡¹ â†’ å¯èƒ½å½±å“ä¸šåŠ¡
å•ä¸€é˜²æŠ¤ï¼šåªä¾èµ–åˆ†åŒºé€‰é¡¹ï¼Œå¿½è§†å…¶ä»–å®‰å…¨æªæ–½ â†’ é˜²æŠ¤ä¸å…¨é¢
é…ç½®é—å¿˜ï¼šè®¾ç½®åä¸ç»´æŠ¤ï¼Œä¸æ£€æŸ¥ â†’ å®‰å…¨æªæ–½å¯èƒ½å¤±æ•ˆ
```

**âœ… æœ€ä½³å®è·µåŸåˆ™**ï¼š
```
æ¸è¿›éƒ¨ç½²ï¼šå…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ï¼Œå†é€æ­¥æ¨å¹¿
æ–‡æ¡£è®°å½•ï¼šè¯¦ç»†è®°å½•æ¯ä¸ªé…ç½®é€‰é¡¹çš„ç”¨é€”å’Œå½±å“  
å®šæœŸæ£€æŸ¥ï¼šå»ºç«‹å®šæœŸçš„å®‰å…¨é…ç½®å®¡æŸ¥æœºåˆ¶
åº”æ€¥å‡†å¤‡ï¼šå‡†å¤‡å¿«é€Ÿæ¢å¤å’Œåº”æ€¥å“åº”çš„æ–¹æ¡ˆ
æŒç»­å­¦ä¹ ï¼šè·Ÿä¸Šå®‰å…¨æŠ€æœ¯çš„å‘å±•ï¼Œä¸æ–­ä¼˜åŒ–é…ç½®
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
> ğŸ” **åˆ†åŒºå®‰å…¨ä¸‰è¦ç´ **ï¼šnoexecç¦æ‰§è¡Œï¼Œnosuidé˜²ææƒï¼Œnodevé˜»è®¾å¤‡
> ğŸ›¡ï¸ **å®‰å…¨é…ç½®ä¸‰æ­¥èµ°**ï¼šå…ˆæµ‹è¯•ã€å†éƒ¨ç½²ã€åç›‘æ§  
> ğŸ“Š **é˜²æŠ¤ä½“ç³»ä¸‰å±‚æ¬¡**ï¼šåˆ†åŒºçº§ã€æ–‡ä»¶çº§ã€åº”ç”¨çº§
> ğŸ” **è¿ç»´ç®¡ç†ä¸‰ä»¶äº‹**ï¼šé…ç½®å¥½ã€ç›‘æ§ä¸¥ã€åº”æ€¥å¿«