---
title: 8ã€æ—¥å¿—ç›‘æ§ä¸å®æ—¶åˆ†æ
---
## ğŸ“š ç›®å½•

1. [tailå®æ—¶ç›‘æ§æŠ€å·§](#1-tailå®æ—¶ç›‘æ§æŠ€å·§)
2. [multitailå¤šæ–‡ä»¶åŒæ—¶ç›‘æ§](#2-multitailå¤šæ–‡ä»¶åŒæ—¶ç›‘æ§)
3. [æ—¥å¿—å…³é”®å­—ç›‘æ§è„šæœ¬](#3-æ—¥å¿—å…³é”®å­—ç›‘æ§è„šæœ¬)
4. [æ—¥å¿—å¼‚å¸¸æ¨¡å¼è¯†åˆ«](#4-æ—¥å¿—å¼‚å¸¸æ¨¡å¼è¯†åˆ«)
5. [æ—¥å¿—ç»Ÿè®¡ä¸æŠ¥è¡¨ç”Ÿæˆ](#5-æ—¥å¿—ç»Ÿè®¡ä¸æŠ¥è¡¨ç”Ÿæˆ)
6. [æ—¥å¿—å‘Šè­¦æœºåˆ¶è®¾è®¡](#6-æ—¥å¿—å‘Šè­¦æœºåˆ¶è®¾è®¡)
7. [æ€§èƒ½æ—¥å¿—ç›‘æ§æŒ‡æ ‡](#7-æ€§èƒ½æ—¥å¿—ç›‘æ§æŒ‡æ ‡)
8. [æ—¥å¿—ç›‘æ§å·¥å…·é€‰æ‹©](#8-æ—¥å¿—ç›‘æ§å·¥å…·é€‰æ‹©)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” tailå®æ—¶ç›‘æ§æŠ€å·§


### 1.1 ä»€ä¹ˆæ˜¯tailå®æ—¶ç›‘æ§


**æ ¸å¿ƒæ¦‚å¿µ**ï¼štailæ˜¯Linuxç³»ç»Ÿä¸­ä¸“é—¨ç”¨æ¥æŸ¥çœ‹æ–‡ä»¶æœ«å°¾å†…å®¹çš„å‘½ä»¤ï¼Œç‰¹åˆ«é€‚åˆç›‘æ§æ—¥å¿—æ–‡ä»¶ã€‚

```
å°±åƒçœ‹ç”µå½±çš„æœ€åå‡ åˆ†é’Ÿï¼š
- tail æ™®é€šæ¨¡å¼ï¼šåªçœ‹æ–‡ä»¶çš„ç»“å°¾éƒ¨åˆ†ï¼ˆé™æ€ï¼‰
- tail -f è·Ÿè¸ªæ¨¡å¼ï¼šæŒç»­ç›‘è§†æ–‡ä»¶æ–°å¢å†…å®¹ï¼ˆåŠ¨æ€ï¼‰

å®é™…åº”ç”¨åœºæ™¯ï¼š
âœ… ç›‘æ§WebæœåŠ¡å™¨è®¿é—®æ—¥å¿—
âœ… è¿½è¸ªåº”ç”¨ç¨‹åºè¿è¡Œæ—¥å¿—  
âœ… è§‚å¯Ÿç³»ç»Ÿé”™è¯¯æ—¥å¿—å˜åŒ–
âœ… è°ƒè¯•ç¨‹åºå®æ—¶è¾“å‡º
```

### 1.2 åŸºç¡€tailç›‘æ§å‘½ä»¤


**å¸¸ç”¨ç›‘æ§å‘½ä»¤å¯¹æ¯”**ï¼š

| å‘½ä»¤ | **ä½œç”¨** | **ä½¿ç”¨åœºæ™¯** | **ä¼˜ç¼ºç‚¹** |
|------|---------|-------------|-----------|
| `tail -f file.log` | `å®æ—¶è·Ÿè¸ªæ–‡ä»¶æœ«å°¾` | `å¸¸è§„æ—¥å¿—ç›‘æ§` | `ç®€å•ç›´æ¥ï¼Œä½†æ–‡ä»¶é‡å‘½ååä¼šæ–­å¼€` |
| `tail -F file.log` | `æ™ºèƒ½è·Ÿè¸ªï¼Œæ”¯æŒæ–‡ä»¶è½®è½¬` | `ç”Ÿäº§ç¯å¢ƒæ—¥å¿—ç›‘æ§` | `æ›´æ™ºèƒ½ï¼Œä¼šé‡æ–°æ‰“å¼€æ–‡ä»¶` |
| `tail -n 100 -f file.log` | `æ˜¾ç¤ºæœ€å100è¡Œå¹¶è·Ÿè¸ª` | `æŸ¥çœ‹å†å²+å®æ—¶ç›‘æ§` | `å¯ä»¥çœ‹åˆ°ä¹‹å‰çš„å†…å®¹` |
| `tail -f file1.log file2.log` | `åŒæ—¶ç›‘æ§å¤šä¸ªæ–‡ä»¶` | `å¤šæœåŠ¡ç›‘æ§` | `æ˜¾ç¤ºæ–‡ä»¶åæ ‡è¯†` |

### 1.3 é«˜çº§tailç›‘æ§æŠ€å·§


**ğŸ”¸ æŒ‰æ—¶é—´èŒƒå›´ç›‘æ§**
```bash
# åªæ˜¾ç¤ºä»Šå¤©çš„æ—¥å¿—å¹¶å®æ—¶è·Ÿè¸ª
tail -f /var/log/messages | grep "$(date +%b\ %d)"

# ç›‘æ§æœ€è¿‘1å°æ—¶çš„è®¿é—®æ—¥å¿—
tail -f /var/log/apache2/access.log | grep "$(date +%d/%b/%Y:%H)"
```

**ğŸ”¸ è¿‡æ»¤å…³é”®ä¿¡æ¯ç›‘æ§**
```bash
# åªç›‘æ§ERRORçº§åˆ«çš„æ—¥å¿—
tail -f /var/log/application.log | grep ERROR

# ç›‘æ§ç‰¹å®šIPçš„è®¿é—®
tail -f /var/log/nginx/access.log | grep "192.168.1.100"

# ç»„åˆæ¡ä»¶ç›‘æ§ï¼ˆé”™è¯¯æˆ–è­¦å‘Šï¼‰
tail -f /var/log/syslog | egrep "(ERROR|WARNING|CRITICAL)"
```

**ğŸ”¸ å½©è‰²è¾“å‡ºå¢å¼ºå¯è¯»æ€§**
```bash
# ä½¿ç”¨cczeä¸ºæ—¥å¿—æ·»åŠ é¢œè‰²
tail -f /var/log/syslog | ccze -A

# ä½¿ç”¨colortailå½©è‰²æ˜¾ç¤º
colortail -f /var/log/messages

# è‡ªå®šä¹‰é¢œè‰²è§„åˆ™
tail -f /var/log/application.log | grep --color=always ERROR
```

### 1.4 tailç›‘æ§æœ€ä½³å®è·µ


**ğŸ“Š ç›‘æ§æ•ˆç‡ä¼˜åŒ–**ï¼š
```
æ€§èƒ½è€ƒé‡ï¼š
ğŸ”¸ å¤§æ–‡ä»¶ç›‘æ§ï¼šä½¿ç”¨ -F é€‰é¡¹è€Œä¸æ˜¯ -f
ğŸ”¸ ç½‘ç»œç›‘æ§ï¼šé¿å…é€šè¿‡ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿç›‘æ§å¤§æ—¥å¿—
ğŸ”¸ ç³»ç»Ÿèµ„æºï¼šç›‘æ§å¤šä¸ªæ–‡ä»¶æ—¶æ³¨æ„CPUå’Œå†…å­˜ä½¿ç”¨

å®ç”¨æŠ€å·§ï¼š
ğŸ”¸ ç»ˆç«¯åˆ†å±ï¼šä½¿ç”¨screenæˆ–tmuxåŒæ—¶ç›‘æ§å¤šä¸ªæ—¥å¿—
ğŸ”¸ è¾“å‡ºé‡å®šå‘ï¼šå°†ç›‘æ§ç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­
ğŸ”¸ åå°è¿è¡Œï¼šä½¿ç”¨nohupè®©ç›‘æ§åœ¨åå°æŒç»­è¿è¡Œ
```

---

## 2. ğŸ“º multitailå¤šæ–‡ä»¶åŒæ—¶ç›‘æ§


### 2.1 multitailåŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯multitail**ï¼šmultitailæ˜¯ä¸€ä¸ªå¢å¼ºç‰ˆçš„tailå‘½ä»¤ï¼Œå¯ä»¥åŒæ—¶ç›‘æ§å¤šä¸ªæ–‡ä»¶ï¼Œå¹¶ä»¥åˆ†å±çš„æ–¹å¼æ˜¾ç¤ºã€‚

```
ä¼ ç»Ÿtailçš„é™åˆ¶ï¼š
- åªèƒ½é¡ºåºæ˜¾ç¤ºå¤šä¸ªæ–‡ä»¶å†…å®¹
- æ–‡ä»¶å†…å®¹æ··æ‚åœ¨ä¸€èµ·ï¼Œéš¾ä»¥åŒºåˆ†
- æ— æ³•çµæ´»æ§åˆ¶æ˜¾ç¤ºæ ¼å¼

multitailçš„ä¼˜åŠ¿ï¼š
âœ… åˆ†å±æ˜¾ç¤ºå¤šä¸ªæ–‡ä»¶
âœ… æ¯ä¸ªæ–‡ä»¶æœ‰ç‹¬ç«‹çš„æ˜¾ç¤ºåŒºåŸŸ
âœ… æ”¯æŒé¢œè‰²é«˜äº®æ˜¾ç¤º
âœ… å¯ä»¥åŠ¨æ€è°ƒæ•´æ˜¾ç¤ºå¸ƒå±€
```

### 2.2 multitailå®‰è£…ä¸åŸºæœ¬ä½¿ç”¨


**å®‰è£…æ–¹æ³•**ï¼š
```bash
# Ubuntu/Debianç³»ç»Ÿ
apt-get install multitail

# CentOS/RHELç³»ç»Ÿ  
yum install multitail

# éªŒè¯å®‰è£…
multitail --version
```

**åŸºæœ¬ä½¿ç”¨è¯­æ³•**ï¼š
```bash
# åŒæ—¶ç›‘æ§ä¸¤ä¸ªæ—¥å¿—æ–‡ä»¶
multitail /var/log/messages /var/log/apache2/error.log

# æ°´å¹³åˆ†å±æ˜¾ç¤º
multitail -s 2 /var/log/syslog /var/log/auth.log

# å‚ç›´åˆ†å±æ˜¾ç¤º  
multitail -S 2 /var/log/messages /var/log/secure
```

### 2.3 multitailé«˜çº§åŠŸèƒ½


**ğŸ”¸ å¤šç§åˆ†å±æ¨¡å¼**
```bash
# å››åˆ†å±ç›‘æ§
multitail -s 2 -S 2 file1.log file2.log file3.log file4.log

# è‡ªå®šä¹‰çª—å£å¤§å°æ¯”ä¾‹
multitail -sw 60,40 /var/log/nginx/access.log /var/log/nginx/error.log

# åŠ¨æ€è°ƒæ•´çª—å£ï¼ˆè¿è¡Œæ—¶æŒ‰é”®ï¼‰
# è¿è¡Œåå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å¿«æ·é”®ï¼š
# 'q' - é€€å‡º
# 'h' - å¸®åŠ©  
# 'f' - åˆ‡æ¢è·Ÿè¸ªæ¨¡å¼
# 'r' - åˆ·æ–°æ˜¾ç¤º
```

**ğŸ”¸ è¿‡æ»¤å’Œé«˜äº®åŠŸèƒ½**
```bash
# ä¸ºä¸åŒæ–‡ä»¶è®¾ç½®ä¸åŒçš„è¿‡æ»¤æ¡ä»¶
multitail -e "ERROR" /var/log/app1.log -e "WARNING" /var/log/app2.log

# ä½¿ç”¨é…ç½®æ–‡ä»¶è‡ªå®šä¹‰é¢œè‰²
multitail -cT apache /var/log/apache2/access.log

# æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤
multitail -E "/ERROR|CRITICAL/" /var/log/syslog
```

### 2.4 å®é™…åº”ç”¨åœºæ™¯


**ğŸ¯ WebæœåŠ¡å™¨ç›‘æ§**
```
ç›‘æ§ç»„åˆï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è®¿é—®æ—¥å¿—       â”‚   é”™è¯¯æ—¥å¿—      â”‚
â”‚ access.log      â”‚  error.log      â”‚
â”‚                 â”‚                 â”‚
â”‚ 192.168.1.1...  â”‚ [error] PHP...  â”‚
â”‚ 192.168.1.2...  â”‚ [warn] SSL...   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å‘½ä»¤ï¼š
multitail -s 2 /var/log/nginx/access.log /var/log/nginx/error.log
```

**ğŸ¯ åº”ç”¨æœåŠ¡ç›‘æ§**
```
ç›‘æ§çŸ©é˜µï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åº”ç”¨æ—¥å¿—    â”‚  ç³»ç»Ÿæ—¥å¿—    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  
â”‚  æ•°æ®åº“æ—¥å¿—  â”‚  å®‰å…¨æ—¥å¿—    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å®ç°æ–¹æ³•ï¼š
multitail -s 2 -S 2 \
  /var/log/application.log \
  /var/log/syslog \
  /var/log/mysql/error.log \
  /var/log/auth.log
```

---

## 3. ğŸ”” æ—¥å¿—å…³é”®å­—ç›‘æ§è„šæœ¬


### 3.1 ç›‘æ§è„šæœ¬çš„æ ¸å¿ƒä½œç”¨


**ä¸ºä»€ä¹ˆéœ€è¦å…³é”®å­—ç›‘æ§**ï¼š
- **è¢«åŠ¨ç›‘æ§çš„å±€é™**ï¼šäººå·¥æŸ¥çœ‹æ—¥å¿—æ•ˆç‡ä½ï¼Œå®¹æ˜“é—æ¼é‡è¦ä¿¡æ¯
- **ä¸»åŠ¨ç›‘æ§çš„ä»·å€¼**ï¼šè‡ªåŠ¨å‘ç°é—®é¢˜ï¼ŒåŠæ—¶å“åº”ï¼Œå‡å°‘æŸå¤±
- **å…³é”®å­—çš„æ„ä¹‰**ï¼šé€šè¿‡ç‰¹å®šè¯æ±‡å¿«é€Ÿå®šä½é—®é¢˜ç±»å‹å’Œä¸¥é‡ç¨‹åº¦

```
ç›‘æ§é€»è¾‘æµç¨‹ï¼š
æ—¥å¿—äº§ç”Ÿ â†’ å…³é”®å­—åŒ¹é… â†’ è§¦å‘åŠ¨ä½œ â†’ é€šçŸ¥ç®¡ç†å‘˜

å¸¸è§å…³é”®å­—ç±»å‹ï¼š
ğŸ”¸ é”™è¯¯ç±»ï¼šERROR, FATAL, CRITICAL, FAILED
ğŸ”¸ è­¦å‘Šç±»ï¼šWARNING, WARN, DEPRECATED  
ğŸ”¸ å®‰å…¨ç±»ï¼šUNAUTHORIZED, FORBIDDEN, ATTACK
ğŸ”¸ æ€§èƒ½ç±»ï¼šSLOW, TIMEOUT, OVERLOAD, MEMORY
```

### 3.2 åŸºç¡€å…³é”®å­—ç›‘æ§è„šæœ¬


**ç®€å•å…³é”®å­—æ£€æµ‹è„šæœ¬**ï¼š
```bash
#!/bin/bash
# æ–‡ä»¶åï¼škeyword_monitor.sh

LOG_FILE="/var/log/application.log"
KEYWORDS=("ERROR" "CRITICAL" "FAILED" "TIMEOUT")
ALERT_FILE="/tmp/alert.log"

# æŒç»­ç›‘æ§å‡½æ•°
monitor_keywords() {
    tail -F "$LOG_FILE" | while read line; do
        for keyword in "${KEYWORDS[@]}"; do
            if echo "$line" | grep -i "$keyword" > /dev/null; then
                timestamp=$(date '+%Y-%m-%d %H:%M:%S')
                echo "[$timestamp] å‘ç°å…³é”®å­—: $keyword" >> "$ALERT_FILE"
                echo "åŸå§‹æ—¥å¿—: $line" >> "$ALERT_FILE"
                echo "----------------------------------------" >> "$ALERT_FILE"
                
                # å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ é€šçŸ¥é€»è¾‘
                send_alert "$keyword" "$line"
            fi
        done
    done
}

# å‘é€å‘Šè­¦å‡½æ•°
send_alert() {
    local keyword=$1
    local log_line=$2
    
    # å‘é€é‚®ä»¶å‘Šè­¦ï¼ˆéœ€è¦é…ç½®é‚®ä»¶æœåŠ¡ï¼‰
    echo "å‘ç°å…³é”®å­—å‘Šè­¦: $keyword" | mail -s "æ—¥å¿—å‘Šè­¦" admin@company.com
    
    # æˆ–è€…å‘é€ç³»ç»Ÿé€šçŸ¥
    logger "ALERT: æ—¥å¿—ä¸­å‘ç°å…³é”®å­— $keyword: $log_line"
}

# å¯åŠ¨ç›‘æ§
monitor_keywords
```

### 3.3 é«˜çº§ç›‘æ§è„šæœ¬åŠŸèƒ½


**ğŸ”¸ å¤šçº§å‘Šè­¦æœºåˆ¶**
```bash
#!/bin/bash
# é«˜çº§å…³é”®å­—ç›‘æ§è„šæœ¬

# å®šä¹‰ä¸åŒçº§åˆ«çš„å…³é”®å­—
declare -A CRITICAL_KEYWORDS=( 
    ["FATAL"]=1 
    ["CRITICAL"]=1 
    ["PANIC"]=1 
)

declare -A WARNING_KEYWORDS=( 
    ["ERROR"]=1 
    ["FAILED"]=1 
    ["TIMEOUT"]=1 
)

declare -A INFO_KEYWORDS=( 
    ["WARNING"]=1 
    ["DEPRECATED"]=1 
)

# å‘Šè­¦ç»Ÿè®¡
CRITICAL_COUNT=0
WARNING_COUNT=0
INFO_COUNT=0

# åˆ†çº§å¤„ç†å‡½æ•°
process_alert() {
    local keyword=$1
    local log_line=$2
    local level=""
    
    if [[ ${CRITICAL_KEYWORDS[$keyword]} ]]; then
        level="CRITICAL"
        ((CRITICAL_COUNT++))
        # ç«‹å³å‘é€å‘Šè­¦
        send_immediate_alert "$keyword" "$log_line"
    elif [[ ${WARNING_KEYWORDS[$keyword]} ]]; then
        level="WARNING"
        ((WARNING_COUNT++))
        # ç´¯ç§¯åˆ°ä¸€å®šæ•°é‡åå‘é€
        if (( WARNING_COUNT % 5 == 0 )); then
            send_batch_alert "WARNING" $WARNING_COUNT
        fi
    elif [[ ${INFO_KEYWORDS[$keyword]} ]]; then
        level="INFO"
        ((INFO_COUNT++))
        # è®°å½•åˆ°æ–‡ä»¶ï¼Œå®šæœŸæ±‡æ€»
        log_to_summary "$keyword" "$log_line"
    fi
    
    echo "[$(date)] [$level] $keyword: $log_line"
}
```

**ğŸ”¸ æ¨¡å¼è¯†åˆ«ç›‘æ§**
```bash
# å¤æ‚æ¨¡å¼ç›‘æ§ç¤ºä¾‹
monitor_patterns() {
    tail -F "$LOG_FILE" | while read line; do
        # IPåœ°å€å¼‚å¸¸è®¿é—®æ¨¡å¼
        if echo "$line" | grep -E "([0-9]{1,3}\.){3}[0-9]{1,3}.*404.*404.*404" > /dev/null; then
            alert "å¯èƒ½çš„æ¶æ„æ‰«æ" "$line"
        fi
        
        # çŸ­æ—¶é—´å¤§é‡é”™è¯¯æ¨¡å¼
        if echo "$line" | grep -c "ERROR" | awk '$1 > 10 {print "é«˜é¢‘é”™è¯¯"}'; then
            alert "é«˜é¢‘é”™è¯¯å‘ç”Ÿ" "$line"
        fi
        
        # æ•°æ®åº“è¿æ¥å¼‚å¸¸æ¨¡å¼
        if echo "$line" | grep -E "(Connection.*refused|Database.*timeout|Too many connections)" > /dev/null; then
            alert "æ•°æ®åº“è¿æ¥é—®é¢˜" "$line"
        fi
    done
}
```

### 3.4 ç›‘æ§è„šæœ¬çš„ä¼˜åŒ–ç­–ç•¥


**ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–è¦ç‚¹**ï¼š

```
æ•ˆç‡æå‡æŠ€å·§ï¼š
ğŸ”¸ ä½¿ç”¨grep -Fè¿›è¡Œå›ºå®šå­—ç¬¦ä¸²åŒ¹é…ï¼ˆæ›´å¿«ï¼‰
ğŸ”¸ å°†é¢‘ç¹åŒ¹é…çš„å…³é”®å­—æ”¾åœ¨å‰é¢
ğŸ”¸ ä½¿ç”¨ç®¡é“ç»„åˆå‘½ä»¤å‡å°‘è¿›ç¨‹åˆ›å»ºå¼€é”€
ğŸ”¸ è®¾ç½®åˆç†çš„ç¼“å†²åŒºå¤§å°é¿å…ä¸¢å¤±æ—¥å¿—

èµ„æºæ§åˆ¶ï¼š
ğŸ”¸ é™åˆ¶è„šæœ¬çš„CPUä½¿ç”¨ç‡
ğŸ”¸ æ§åˆ¶å‘Šè­¦é¢‘ç‡é¿å…å‘Šè­¦é£æš´
ğŸ”¸ å®šæœŸæ¸…ç†å†å²å‘Šè­¦è®°å½•
ğŸ”¸ ç›‘æ§è„šæœ¬æœ¬èº«çš„è¿è¡ŒçŠ¶æ€
```

---

## 4. ğŸ¯ æ—¥å¿—å¼‚å¸¸æ¨¡å¼è¯†åˆ«


### 4.1 ä»€ä¹ˆæ˜¯æ—¥å¿—å¼‚å¸¸æ¨¡å¼


**å¼‚å¸¸æ¨¡å¼çš„æ¦‚å¿µ**ï¼šå¼‚å¸¸æ¨¡å¼æ˜¯æŒ‡åœ¨æ—¥å¿—ä¸­å‡ºç°çš„ä¸æ­£å¸¸è¡Œä¸ºç‰¹å¾ï¼Œè¿™äº›ç‰¹å¾å¾€å¾€é¢„ç¤ºç€ç³»ç»Ÿé—®é¢˜ã€å®‰å…¨å¨èƒæˆ–æ€§èƒ½ç“¶é¢ˆã€‚

```
æ­£å¸¸æ¨¡å¼ vs å¼‚å¸¸æ¨¡å¼ï¼š

æ­£å¸¸è®¿é—®æ¨¡å¼ï¼š
2025-01-17 10:15:23 GET /index.html 200 1.2KB
2025-01-17 10:15:25 GET /about.html 200 2.1KB
2025-01-17 10:15:28 GET /contact.html 200 1.8KB

å¼‚å¸¸æ‰«ææ¨¡å¼ï¼š
2025-01-17 10:15:23 GET /admin.php 404 0KB
2025-01-17 10:15:23 GET /wp-admin/ 404 0KB
2025-01-17 10:15:24 GET /.env 404 0KB
2025-01-17 10:15:24 GET /config.php 404 0KB

ğŸ”¸ ç‰¹å¾ï¼šåŒä¸€IPçŸ­æ—¶é—´å†…å¤§é‡404è¯·æ±‚
ğŸ”¸ åˆ¤æ–­ï¼šå¯èƒ½æ˜¯æ¶æ„æ‰«æè¡Œä¸º
```

### 4.2 å¸¸è§å¼‚å¸¸æ¨¡å¼ç±»å‹


**ğŸ”´ å®‰å…¨ç›¸å…³å¼‚å¸¸æ¨¡å¼**

| æ¨¡å¼ç±»å‹ | **ç‰¹å¾æè¿°** | **è¯†åˆ«æ–¹æ³•** | **å±é™©ç­‰çº§** |
|---------|------------|------------|-------------|
| **æš´åŠ›ç ´è§£** | `çŸ­æ—¶é—´å†…åŒä¸€IPå¤šæ¬¡ç™»å½•å¤±è´¥` | `ç»Ÿè®¡failed loginé¢‘æ¬¡` | `ğŸ”´ é«˜` |
| **æ¶æ„æ‰«æ** | `å¤§é‡404é”™è¯¯ï¼Œè®¿é—®æ•æ„Ÿè·¯å¾„` | `404çŠ¶æ€ç +ç‰¹å®šURLæ¨¡å¼` | `ğŸŸ¡ ä¸­` |
| **SQLæ³¨å…¥** | `URLå‚æ•°åŒ…å«SQLå…³é”®å­—` | `æ£€æµ‹unionã€selectç­‰å…³é”®å­—` | `ğŸ”´ é«˜` |
| **æ–‡ä»¶ä¸Šä¼ æ”»å‡»** | `ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶ç±»å‹` | `æ£€æµ‹.phpã€.jspç­‰æ‰©å±•å` | `ğŸ”´ é«˜` |

**ğŸŸ¡ æ€§èƒ½ç›¸å…³å¼‚å¸¸æ¨¡å¼**

```
å“åº”æ—¶é—´å¼‚å¸¸ï¼š
æ­£å¸¸ï¼šGET /api/users 200 120ms
å¼‚å¸¸ï¼šGET /api/users 200 5200ms

è¯†åˆ«è§„åˆ™ï¼šå“åº”æ—¶é—´è¶…è¿‡æ­£å¸¸å€¼çš„3-5å€

æ•°æ®åº“è¿æ¥å¼‚å¸¸ï¼š
æ¨¡å¼ï¼šConnection pool exhausted
      Too many connections
      Database timeout after 30s

å†…å­˜ä½¿ç”¨å¼‚å¸¸ï¼š
æ¨¡å¼ï¼šOutOfMemoryError
      GC overhead limit exceeded
      Cannot allocate memory
```

### 4.3 å¼‚å¸¸æ¨¡å¼è¯†åˆ«è„šæœ¬


**ğŸ”¸ ç»¼åˆå¼‚å¸¸æ£€æµ‹è„šæœ¬**
```bash
#!/bin/bash
# æ—¥å¿—å¼‚å¸¸æ¨¡å¼è¯†åˆ«è„šæœ¬

LOG_FILE="/var/log/nginx/access.log"
TEMP_DIR="/tmp/log_analysis"
ALERT_LOG="/var/log/security_alerts.log"

mkdir -p "$TEMP_DIR"

# æ£€æµ‹æš´åŠ›ç ´è§£æ¨¡å¼
detect_brute_force() {
    local time_window=300  # 5åˆ†é’Ÿæ—¶é—´çª—å£
    local threshold=20     # é˜ˆå€¼ï¼š20æ¬¡å¤±è´¥å°è¯•
    
    # æå–æœ€è¿‘5åˆ†é’Ÿçš„å¤±è´¥ç™»å½•
    awk -v now="$(date +%s)" -v window="$time_window" '
    {
        # è§£ææ—¶é—´æˆ³ï¼ˆéœ€è¦æ ¹æ®æ—¥å¿—æ ¼å¼è°ƒæ•´ï¼‰
        if ($9 == "401" || $9 == "403") {
            cmd = "date -d \"" $4 " " $5 "\" +%s"
            cmd | getline timestamp
            close(cmd)
            
            if (now - timestamp <= window) {
                print $1  # è¾“å‡ºIPåœ°å€
            }
        }
    }' "$LOG_FILE" | sort | uniq -c | awk -v thresh="$threshold" '
    $1 >= thresh {
        print "[BRUTE_FORCE] IP " $2 " failed " $1 " times in 5 minutes"
    }' >> "$ALERT_LOG"
}

# æ£€æµ‹æ‰«ææ¨¡å¼
detect_scanning() {
    local threshold=50
    
    # ç»Ÿè®¡æ¯ä¸ªIPçš„404é”™è¯¯æ•°é‡
    awk '$9 == "404" { print $1 }' "$LOG_FILE" | \
    sort | uniq -c | awk -v thresh="$threshold" '
    $1 >= thresh {
        print "[SCANNING] IP " $2 " generated " $1 " 404 errors"
    }' >> "$ALERT_LOG"
}

# æ£€æµ‹å¼‚å¸¸å“åº”æ—¶é—´
detect_slow_response() {
    local threshold=5000  # 5ç§’é˜ˆå€¼
    
    awk -v thresh="$threshold" '
    NF >= 10 && $NF > thresh {
        print "[SLOW_RESPONSE] " $7 " took " $NF "ms from " $1
    }' "$LOG_FILE" >> "$ALERT_LOG"
}

# ä¸»æ£€æµ‹å‡½æ•°
main_detection() {
    echo "[$(date)] å¼€å§‹å¼‚å¸¸æ¨¡å¼æ£€æµ‹..."
    
    detect_brute_force
    detect_scanning  
    detect_slow_response
    
    # æ£€æŸ¥æ˜¯å¦æœ‰æ–°å‘Šè­¦
    if [[ -s "$ALERT_LOG" ]]; then
        echo "å‘ç°å¼‚å¸¸æ¨¡å¼ï¼Œè¯·æŸ¥çœ‹ $ALERT_LOG"
        # å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ é‚®ä»¶æˆ–å…¶ä»–é€šçŸ¥æ–¹å¼
    fi
}

# æ‰§è¡Œæ£€æµ‹
main_detection
```

### 4.4 å¼‚å¸¸æ¨¡å¼å¯è§†åŒ–åˆ†æ


**ğŸ“Š ç»Ÿè®¡åˆ†ææ–¹æ³•**
```bash
# ç”Ÿæˆå¼‚å¸¸æ¨¡å¼æŠ¥å‘Š
generate_pattern_report() {
    local report_file="/tmp/pattern_report_$(date +%Y%m%d).txt"
    
    echo "=== æ—¥å¿—å¼‚å¸¸æ¨¡å¼åˆ†ææŠ¥å‘Š ===" > "$report_file"
    echo "ç”Ÿæˆæ—¶é—´: $(date)" >> "$report_file"
    echo "" >> "$report_file"
    
    # ç»Ÿè®¡å„ç±»çŠ¶æ€ç åˆ†å¸ƒ
    echo "çŠ¶æ€ç åˆ†å¸ƒç»Ÿè®¡:" >> "$report_file"
    awk '{print $9}' "$LOG_FILE" | sort | uniq -c | sort -nr >> "$report_file"
    echo "" >> "$report_file"
    
    # ç»Ÿè®¡è®¿é—®æœ€é¢‘ç¹çš„IP
    echo "è®¿é—®é¢‘ç‡æœ€é«˜çš„IP (Top 10):" >> "$report_file"
    awk '{print $1}' "$LOG_FILE" | sort | uniq -c | sort -nr | head -10 >> "$report_file"
    echo "" >> "$report_file"
    
    # ç»Ÿè®¡æœ€å¸¸è®¿é—®çš„URL
    echo "è®¿é—®æœ€é¢‘ç¹çš„URL (Top 10):" >> "$report_file"
    awk '{print $7}' "$LOG_FILE" | sort | uniq -c | sort -nr | head -10 >> "$report_file"
    
    echo "æŠ¥å‘Šå·²ç”Ÿæˆ: $report_file"
}
```

---

## 5. ğŸ“ˆ æ—¥å¿—ç»Ÿè®¡ä¸æŠ¥è¡¨ç”Ÿæˆ


### 5.1 æ—¥å¿—ç»Ÿè®¡çš„é‡è¦æ€§


**ä¸ºä»€ä¹ˆè¦åšæ—¥å¿—ç»Ÿè®¡**ï¼š
- **è¶‹åŠ¿åˆ†æ**ï¼šäº†è§£ç³»ç»Ÿä½¿ç”¨æƒ…å†µçš„å˜åŒ–è¶‹åŠ¿
- **å®¹é‡è§„åˆ’**ï¼šåŸºäºå†å²æ•°æ®é¢„æµ‹æœªæ¥èµ„æºéœ€æ±‚  
- **æ€§èƒ½ä¼˜åŒ–**ï¼šè¯†åˆ«æ€§èƒ½ç“¶é¢ˆå’Œä¼˜åŒ–æœºä¼š
- **ä¸šåŠ¡æ´å¯Ÿ**ï¼šä»æŠ€æœ¯æ—¥å¿—ä¸­æå–ä¸šåŠ¡ä»·å€¼

```
ç»Ÿè®¡ç»´åº¦åˆ†ç±»ï¼š

æ—¶é—´ç»´åº¦ï¼š
ğŸ”¸ å°æ—¶çº§ç»Ÿè®¡ï¼šäº†è§£ä¸šåŠ¡é«˜å³°æ—¶é—´
ğŸ”¸ æ—¥çº§ç»Ÿè®¡ï¼šåˆ†æå·¥ä½œæ—¥vså‘¨æœ«å·®å¼‚
ğŸ”¸ æœˆçº§ç»Ÿè®¡ï¼šè§‚å¯Ÿä¸šåŠ¡å¢é•¿è¶‹åŠ¿

ä¸šåŠ¡ç»´åº¦ï¼š
ğŸ”¸ è®¿é—®é‡ç»Ÿè®¡ï¼šPVã€UVã€é¡µé¢è®¿é—®åˆ†å¸ƒ
ğŸ”¸ é”™è¯¯ç‡ç»Ÿè®¡ï¼šä¸åŒç±»å‹é”™è¯¯çš„å æ¯”
ğŸ”¸ æ€§èƒ½ç»Ÿè®¡ï¼šå“åº”æ—¶é—´ã€ååé‡åˆ†æ
```

### 5.2 åŸºç¡€ç»Ÿè®¡è„šæœ¬å®ç°


**ğŸ”¸ Webè®¿é—®æ—¥å¿—ç»Ÿè®¡è„šæœ¬**
```bash
#!/bin/bash
# Webè®¿é—®æ—¥å¿—ç»Ÿè®¡åˆ†æè„šæœ¬

LOG_FILE="/var/log/nginx/access.log"
REPORT_DIR="/var/reports/$(date +%Y%m)"
DAILY_REPORT="$REPORT_DIR/daily_$(date +%Y%m%d).txt"

mkdir -p "$REPORT_DIR"

# ç”Ÿæˆæ¯æ—¥ç»Ÿè®¡æŠ¥å‘Š
generate_daily_report() {
    local today=$(date +%d/%b/%Y)
    
    echo "===============================================" > "$DAILY_REPORT"
    echo "          æ¯æ—¥è®¿é—®ç»Ÿè®¡æŠ¥å‘Š"                      >> "$DAILY_REPORT"
    echo "          æ—¥æœŸ: $today"                        >> "$DAILY_REPORT"
    echo "===============================================" >> "$DAILY_REPORT"
    echo "" >> "$DAILY_REPORT"
    
    # 1. æ€»ä½“è®¿é—®ç»Ÿè®¡
    echo "ã€æ€»ä½“è®¿é—®æƒ…å†µã€‘" >> "$DAILY_REPORT"
    local total_requests=$(grep "$today" "$LOG_FILE" | wc -l)
    local unique_ips=$(grep "$today" "$LOG_FILE" | awk '{print $1}' | sort | uniq | wc -l)
    local total_bandwidth=$(grep "$today" "$LOG_FILE" | awk '{sum+=$10} END {printf "%.2f MB", sum/1024/1024}')
    
    echo "æ€»è¯·æ±‚æ•°: $total_requests" >> "$DAILY_REPORT"
    echo "ç‹¬ç«‹è®¿å®¢: $unique_ips" >> "$DAILY_REPORT"
    echo "æ€»æµé‡: $total_bandwidth" >> "$DAILY_REPORT"
    echo "" >> "$DAILY_REPORT"
    
    # 2. çŠ¶æ€ç ç»Ÿè®¡
    echo "ã€HTTPçŠ¶æ€ç åˆ†å¸ƒã€‘" >> "$DAILY_REPORT"
    grep "$today" "$LOG_FILE" | awk '{print $9}' | sort | uniq -c | sort -nr | \
    while read count code; do
        percentage=$(echo "scale=2; $count * 100 / $total_requests" | bc)
        echo "$code: $count æ¬¡ (${percentage}%)" >> "$DAILY_REPORT"
    done
    echo "" >> "$DAILY_REPORT"
    
    # 3. å°æ—¶è®¿é—®é‡åˆ†å¸ƒ
    echo "ã€24å°æ—¶è®¿é—®åˆ†å¸ƒã€‘" >> "$DAILY_REPORT"
    for hour in {00..23}; do
        count=$(grep "$today:$hour:" "$LOG_FILE" | wc -l)
        bar=$(printf "%*s" $((count/100)) | tr ' ' 'â–ˆ')
        printf "%s:00 %6d %s\n" "$hour" "$count" "$bar" >> "$DAILY_REPORT"
    done
    echo "" >> "$DAILY_REPORT"
    
    # 4. çƒ­é—¨é¡µé¢
    echo "ã€è®¿é—®æœ€å¤šçš„é¡µé¢ (Top 10)ã€‘" >> "$DAILY_REPORT"
    grep "$today" "$LOG_FILE" | awk '{print $7}' | grep -v '\.(css|js|png|jpg|ico)$' | \
    sort | uniq -c | sort -nr | head -10 | \
    awk '{printf "%-50s %d\n", $2, $1}' >> "$DAILY_REPORT"
    echo "" >> "$DAILY_REPORT"
}

# ç”Ÿæˆæ€§èƒ½ç»Ÿè®¡æŠ¥å‘Š
generate_performance_report() {
    echo "ã€å“åº”æ—¶é—´åˆ†æã€‘" >> "$DAILY_REPORT"
    
    # è®¡ç®—å¹³å‡å“åº”æ—¶é—´
    local avg_response=$(grep "$today" "$LOG_FILE" | awk '{sum+=$NF; count++} END {printf "%.2f ms", sum/count}')
    echo "å¹³å‡å“åº”æ—¶é—´: $avg_response" >> "$DAILY_REPORT"
    
    # å“åº”æ—¶é—´åˆ†å¸ƒ
    echo "å“åº”æ—¶é—´åˆ†å¸ƒ:" >> "$DAILY_REPORT"
    grep "$today" "$LOG_FILE" | awk '{print $NF}' | awk '
    {
        if ($1 < 100) range["< 100ms"]++
        else if ($1 < 500) range["100-500ms"]++  
        else if ($1 < 1000) range["500ms-1s"]++
        else if ($1 < 3000) range["1-3s"]++
        else range["> 3s"]++
        total++
    }
    END {
        for (r in range) {
            printf "  %-12s: %6d (%.1f%%)\n", r, range[r], range[r]*100/total
        }
    }' >> "$DAILY_REPORT"
}

# æ‰§è¡ŒæŠ¥å‘Šç”Ÿæˆ
echo "æ­£åœ¨ç”Ÿæˆæ¯æ—¥ç»Ÿè®¡æŠ¥å‘Š..."
generate_daily_report
generate_performance_report
echo "æŠ¥å‘Šå·²ç”Ÿæˆ: $DAILY_REPORT"
```

### 5.3 é«˜çº§ç»Ÿè®¡åˆ†æåŠŸèƒ½


**ğŸ”¸ è¶‹åŠ¿åˆ†æè„šæœ¬**
```bash
#!/bin/bash
# æ—¥å¿—è¶‹åŠ¿åˆ†æè„šæœ¬

# ç”Ÿæˆ7å¤©è®¿é—®é‡è¶‹åŠ¿
generate_weekly_trend() {
    echo "ã€7å¤©è®¿é—®é‡è¶‹åŠ¿ã€‘"
    
    for i in {6..0}; do
        date_str=$(date -d "$i days ago" +%d/%b/%Y)
        count=$(grep "$date_str" "$LOG_FILE" | wc -l)
        
        # ç®€å•çš„ASCIIå›¾è¡¨
        bar_length=$((count / 100))
        bar=$(printf "%*s" $bar_length | tr ' ' 'â–“')
        
        printf "%s %8d %s\n" "$date_str" "$count" "$bar"
    done
}

# å¼‚å¸¸æ£€æµ‹åˆ†æ
detect_anomalies() {
    echo "ã€å¼‚å¸¸è®¿é—®æ£€æµ‹ã€‘"
    
    # æ£€æµ‹è®¿é—®é‡å¼‚å¸¸ï¼ˆè¶…è¿‡å¹³å‡å€¼çš„3å€ï¼‰
    avg_requests=$(awk 'END {print NR/7}' <(for i in {6..0}; do 
        date_str=$(date -d "$i days ago" +%d/%b/%Y)
        grep "$date_str" "$LOG_FILE" | wc -l
    done))
    
    threshold=$(echo "$avg_requests * 3" | bc)
    
    today_requests=$(grep "$(date +%d/%b/%Y)" "$LOG_FILE" | wc -l)
    
    if (( $(echo "$today_requests > $threshold" | bc -l) )); then
        echo "âš ï¸  ä»Šæ—¥è®¿é—®é‡å¼‚å¸¸: $today_requests (å¹³å‡: $avg_requests)"
    else
        echo "âœ… ä»Šæ—¥è®¿é—®é‡æ­£å¸¸: $today_requests"
    fi
}
```

### 5.4 è‡ªåŠ¨åŒ–æŠ¥è¡¨ç”Ÿæˆ


**ğŸ“Š å®šæ—¶ä»»åŠ¡é…ç½®**
```bash
# æ·»åŠ åˆ°crontabä¸­å®ç°è‡ªåŠ¨åŒ–æŠ¥è¡¨ç”Ÿæˆ
# crontab -e

# æ¯å¤©å‡Œæ™¨1ç‚¹ç”Ÿæˆæ˜¨æ—¥æŠ¥å‘Š
0 1 * * * /scripts/generate_daily_report.sh

# æ¯å‘¨ä¸€æ—©ä¸Š8ç‚¹ç”Ÿæˆå‘¨æŠ¥
0 8 * * 1 /scripts/generate_weekly_report.sh

# æ¯æœˆ1æ—¥ç”Ÿæˆæœˆåº¦æŠ¥å‘Š  
0 9 1 * * /scripts/generate_monthly_report.sh
```

**ğŸ“§ è‡ªåŠ¨é‚®ä»¶å‘é€**
```bash
# æŠ¥å‘Šé‚®ä»¶å‘é€å‡½æ•°
send_report_email() {
    local report_file=$1
    local report_type=$2
    
    {
        echo "Subject: $report_type - $(date +%Y-%m-%d)"
        echo "Content-Type: text/html; charset=utf-8"
        echo ""
        echo "<html><body><pre>"
        cat "$report_file"
        echo "</pre></body></html>"
    } | sendmail admin@company.com
}
```

---

## 6. ğŸš¨ æ—¥å¿—å‘Šè­¦æœºåˆ¶è®¾è®¡


### 6.1 å‘Šè­¦æœºåˆ¶çš„è®¾è®¡åŸåˆ™


**å‘Šè­¦æœºåˆ¶çš„æ ¸å¿ƒç›®æ ‡**ï¼šåœ¨é—®é¢˜å‘ç”Ÿæˆ–å³å°†å‘ç”Ÿæ—¶ï¼ŒåŠæ—¶é€šçŸ¥ç›¸å…³äººå‘˜ï¼Œä»¥ä¾¿å¿«é€Ÿå“åº”å’Œå¤„ç†ã€‚

```
å‘Šè­¦è®¾è®¡çš„å…³é”®åŸåˆ™ï¼š

ğŸ¯ å‡†ç¡®æ€§åŸåˆ™ï¼š
- å‡å°‘è¯¯æŠ¥ï¼šé¿å…ä¸å¿…è¦çš„æ‰“æ‰°
- å‡å°‘æ¼æŠ¥ï¼šç¡®ä¿é‡è¦é—®é¢˜ä¸è¢«é—æ¼
- åˆ†çº§å¤„ç†ï¼šä¸åŒä¸¥é‡ç¨‹åº¦é‡‡ç”¨ä¸åŒå“åº”æ–¹å¼

â° æ—¶æ•ˆæ€§åŸåˆ™ï¼š
- å®æ—¶æ£€æµ‹ï¼šé—®é¢˜å‘ç”Ÿåç«‹å³å‘ç°
- å¿«é€Ÿä¼ è¾¾ï¼šå‘Šè­¦ä¿¡æ¯è¿…é€Ÿä¼ é€’ç»™è´£ä»»äºº
- åŠæ—¶å“åº”ï¼šæ”¶åˆ°å‘Šè­¦åå¿«é€Ÿå“åº”å¤„ç†

ğŸ“‹ å¯æ“ä½œæ€§åŸåˆ™ï¼š
- ä¿¡æ¯å®Œæ•´ï¼šæä¾›è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ä¿¡æ¯
- å¤„ç†å»ºè®®ï¼šç»™å‡ºåˆæ­¥çš„å¤„ç†æ–¹å‘
- è´£ä»»æ˜ç¡®ï¼šæ˜ç¡®è°è´Ÿè´£å¤„ç†ä»€ä¹ˆç±»å‹çš„é—®é¢˜
```

### 6.2 å¤šçº§å‘Šè­¦ä½“ç³»è®¾è®¡


**ğŸ”¸ å‘Šè­¦çº§åˆ«å®šä¹‰**

| çº§åˆ« | **è§¦å‘æ¡ä»¶** | **å“åº”æ—¶é—´** | **é€šçŸ¥æ–¹å¼** | **è´£ä»»äºº** |
|------|-------------|-------------|-------------|-----------|
| **ğŸ”´ Critical** | `ç³»ç»Ÿå®•æœºã€æ•°æ®ä¸¢å¤±` | `ç«‹å³` | `çŸ­ä¿¡+ç”µè¯+é‚®ä»¶` | `å€¼ç­å·¥ç¨‹å¸ˆ` |
| **ğŸŸ  High** | `æ€§èƒ½ä¸¥é‡ä¸‹é™ã€å®‰å…¨å¨èƒ` | `5åˆ†é’Ÿå†…` | `çŸ­ä¿¡+é‚®ä»¶` | `è¿ç»´å›¢é˜Ÿ` |
| **ğŸŸ¡ Medium** | `åŠŸèƒ½å¼‚å¸¸ã€å®¹é‡å‘Šè­¦` | `15åˆ†é’Ÿå†…` | `é‚®ä»¶+IM` | `å¼€å‘å›¢é˜Ÿ` |
| **ğŸŸ¢ Low** | `æ€§èƒ½æé†’ã€é…ç½®å»ºè®®` | `1å°æ—¶å†…` | `é‚®ä»¶` | `ç›¸å…³è´Ÿè´£äºº` |

**ğŸ”¸ å‘Šè­¦è§„åˆ™é…ç½®ç¤ºä¾‹**
```bash
#!/bin/bash
# å¤šçº§å‘Šè­¦è§„åˆ™é…ç½®

# Criticalçº§åˆ«å‘Šè­¦è§„åˆ™
CRITICAL_RULES=(
    "FATAL|PANIC|OutOfMemoryError:ç«‹å³:ç³»ç»Ÿå´©æºƒ"
    "ERROR.*database.*connection:ç«‹å³:æ•°æ®åº“è¿æ¥å¤±è´¥" 
    "HTTP 5[0-9][0-9].*count>100:ç«‹å³:å¤§é‡æœåŠ¡å™¨é”™è¯¯"
)

# Highçº§åˆ«å‘Šè­¦è§„åˆ™  
HIGH_RULES=(
    "ERROR.*timeout:5åˆ†é’Ÿ:è¯·æ±‚è¶…æ—¶è¿‡å¤š"
    "login.*failed.*count>50:5åˆ†é’Ÿ:å¯èƒ½çš„æš´åŠ›ç ´è§£"
    "response_time>5000:5åˆ†é’Ÿ:å“åº”æ—¶é—´è¿‡é•¿"
)

# Mediumçº§åˆ«å‘Šè­¦è§„åˆ™
MEDIUM_RULES=(
    "WARNING.*memory:15åˆ†é’Ÿ:å†…å­˜ä½¿ç”¨è­¦å‘Š"
    "HTTP 4[0-9][0-9].*count>500:15åˆ†é’Ÿ:å¤§é‡å®¢æˆ·ç«¯é”™è¯¯"
    "disk.*usage>80:15åˆ†é’Ÿ:ç£ç›˜ç©ºé—´ä¸è¶³"
)

# å¤„ç†å‘Šè­¦è§„åˆ™
process_alert_rule() {
    local rule=$1
    local pattern=$(echo "$rule" | cut -d: -f1)
    local urgency=$(echo "$rule" | cut -d: -f2)  
    local description=$(echo "$rule" | cut -d: -f3)
    
    if grep -E "$pattern" "$LOG_FILE" > /dev/null; then
        trigger_alert "$urgency" "$description" "$pattern"
    fi
}
```

### 6.3 æ™ºèƒ½å‘Šè­¦ç®—æ³•


**ğŸ”¸ å‘Šè­¦é¢‘ç‡æ§åˆ¶**
```bash
# å‘Šè­¦å»é‡å’Œé¢‘ç‡æ§åˆ¶
ALERT_CACHE="/tmp/alert_cache"
ALERT_INTERVAL=300  # 5åˆ†é’Ÿå†…ç›¸åŒå‘Šè­¦åªå‘é€ä¸€æ¬¡

# æ£€æŸ¥æ˜¯å¦åº”è¯¥å‘é€å‘Šè­¦
should_send_alert() {
    local alert_key=$1
    local current_time=$(date +%s)
    local cache_file="$ALERT_CACHE/$alert_key"
    
    # å¦‚æœç¼“å­˜æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæˆ–è€…å·²è¿‡æœŸ
    if [[ ! -f "$cache_file" ]] || [[ $((current_time - $(cat "$cache_file"))) -gt $ALERT_INTERVAL ]]; then
        echo "$current_time" > "$cache_file"
        return 0  # åº”è¯¥å‘é€å‘Šè­¦
    else
        return 1  # ä¸åº”è¯¥å‘é€å‘Šè­¦
    fi
}

# æ™ºèƒ½å‘Šè­¦èšåˆ
aggregate_similar_alerts() {
    local time_window=300  # 5åˆ†é’Ÿæ—¶é—´çª—å£
    local temp_file="/tmp/alert_aggregation"
    
    # æ”¶é›†åŒä¸€æ—¶é—´çª—å£å†…çš„ç›¸ä¼¼å‘Šè­¦
    find "$ALERT_CACHE" -newermt "5 minutes ago" -name "*" | while read alert_file; do
        alert_type=$(basename "$alert_file")
        echo "$alert_type" >> "$temp_file"
    done
    
    # ç»Ÿè®¡ç›¸ä¼¼å‘Šè­¦æ•°é‡
    if [[ -f "$temp_file" ]]; then
        sort "$temp_file" | uniq -c | while read count alert_type; do
            if [[ $count -gt 3 ]]; then
                send_aggregated_alert "$alert_type" "$count"
            fi
        done
        rm "$temp_file"
    fi
}
```

**ğŸ”¸ åŠ¨æ€é˜ˆå€¼è°ƒæ•´**
```bash
# åŸºäºå†å²æ•°æ®çš„åŠ¨æ€é˜ˆå€¼
calculate_dynamic_threshold() {
    local metric=$1
    local history_file="/var/log/metrics_history/$metric.log"
    
    # è®¡ç®—è¿‡å»7å¤©çš„å¹³å‡å€¼å’Œæ ‡å‡†å·®
    if [[ -f "$history_file" ]]; then
        awk '{sum+=$1; sumsq+=$1*$1} END {
            avg = sum/NR
            stddev = sqrt(sumsq/NR - avg*avg)
            # é˜ˆå€¼ = å¹³å‡å€¼ + 2*æ ‡å‡†å·®
            threshold = avg + 2*stddev
            print threshold
        }' "$history_file"
    else
        echo "1000"  # é»˜è®¤é˜ˆå€¼
    fi
}

# æ›´æ–°å†å²æ•°æ®
update_metric_history() {
    local metric=$1
    local value=$2
    local history_file="/var/log/metrics_history/$metric.log"
    
    echo "$value $(date +%s)" >> "$history_file"
    
    # åªä¿ç•™æœ€è¿‘7å¤©çš„æ•°æ®
    find "$history_file" -mtime +7 -delete
}
```

### 6.4 å‘Šè­¦é€šçŸ¥å®ç°


**ğŸ”¸ å¤šé€šé“é€šçŸ¥ç³»ç»Ÿ**
```bash
#!/bin/bash
# å¤šé€šé“å‘Šè­¦é€šçŸ¥ç³»ç»Ÿ

# é‚®ä»¶é€šçŸ¥
send_email_alert() {
    local level=$1
    local message=$2
    local log_excerpt=$3
    
    {
        echo "To: ops-team@company.com"
        echo "Subject: [$level] ç³»ç»Ÿå‘Šè­¦ - $(date)"
        echo "Content-Type: text/html; charset=utf-8"
        echo ""
        echo "<html><body>"
        echo "<h2 style='color:red'>ç³»ç»Ÿå‘Šè­¦é€šçŸ¥</h2>"
        echo "<p><strong>å‘Šè­¦çº§åˆ«:</strong> $level</p>"
        echo "<p><strong>å‘Šè­¦æ—¶é—´:</strong> $(date)</p>"
        echo "<p><strong>å‘Šè­¦æè¿°:</strong> $message</p>"
        echo "<h3>ç›¸å…³æ—¥å¿—:</h3>"
        echo "<pre>$log_excerpt</pre>"
        echo "<p>è¯·åŠæ—¶å¤„ç†æ­¤å‘Šè­¦ã€‚</p>"
        echo "</body></html>"
    } | sendmail ops-team@company.com
}

# çŸ­ä¿¡é€šçŸ¥ï¼ˆé€šè¿‡APIï¼‰
send_sms_alert() {
    local level=$1
    local message=$2
    local phone_numbers=("13800138000" "13800138001")
    
    for phone in "${phone_numbers[@]}"; do
        curl -X POST "https://api.sms-service.com/send" \
            -H "Authorization: Bearer YOUR_API_TOKEN" \
            -d "to=$phone" \
            -d "message=ã€$levelã€‘$message - $(date +%H:%M)"
    done
}

# ä¼ä¸šIMé€šçŸ¥ï¼ˆé’‰é’‰/ä¼ä¸šå¾®ä¿¡ï¼‰
send_im_alert() {
    local level=$1
    local message=$2
    
    local webhook_url="https://oapi.dingtalk.com/robot/send?access_token=YOUR_TOKEN"
    
    curl -X POST "$webhook_url" \
        -H "Content-Type: application/json" \
        -d "{
            \"msgtype\": \"text\",
            \"text\": {
                \"content\": \"ã€ç³»ç»Ÿå‘Šè­¦ã€‘\\nçº§åˆ«: $level\\næ—¶é—´: $(date)\\næè¿°: $message\"
            }
        }"
}

# ç»Ÿä¸€å‘Šè­¦åˆ†å‘å‡½æ•°
dispatch_alert() {
    local level=$1
    local message=$2
    local log_excerpt=$3
    
    case "$level" in
        "CRITICAL")
            send_sms_alert "$level" "$message"
            send_email_alert "$level" "$message" "$log_excerpt"
            send_im_alert "$level" "$message"
            ;;
        "HIGH")
            send_sms_alert "$level" "$message"
            send_email_alert "$level" "$message" "$log_excerpt"
            ;;
        "MEDIUM")
            send_email_alert "$level" "$message" "$log_excerpt"
            send_im_alert "$level" "$message"
            ;;
        "LOW")
            send_email_alert "$level" "$message" "$log_excerpt"
            ;;
    esac
}
```

---

## 7. âš¡ æ€§èƒ½æ—¥å¿—ç›‘æ§æŒ‡æ ‡


### 7.1 å…³é”®æ€§èƒ½æŒ‡æ ‡(KPI)å®šä¹‰


**ä»€ä¹ˆæ˜¯æ€§èƒ½æ—¥å¿—ç›‘æ§**ï¼šé€šè¿‡åˆ†æåº”ç”¨ç¨‹åºå’Œç³»ç»Ÿäº§ç”Ÿçš„æ—¥å¿—ï¼Œæå–å’Œç›‘æ§å½±å“ç³»ç»Ÿæ€§èƒ½çš„å…³é”®æŒ‡æ ‡ã€‚

```
æ€§èƒ½ç›‘æ§çš„ä»·å€¼ï¼š
ğŸ¯ é¢„é˜²æ€§ç»´æŠ¤ï¼šåœ¨æ€§èƒ½é—®é¢˜å½±å“ç”¨æˆ·å‰å‘ç°å¹¶è§£å†³
ğŸ¯ å®¹é‡è§„åˆ’ï¼šåŸºäºæ€§èƒ½è¶‹åŠ¿è§„åˆ’èµ„æºæ‰©å®¹
ğŸ¯ ä¼˜åŒ–å†³ç­–ï¼šè¯†åˆ«æ€§èƒ½ç“¶é¢ˆï¼ŒæŒ‡å¯¼ä¼˜åŒ–æ–¹å‘
ğŸ¯ SLAä¿éšœï¼šç¡®ä¿æœåŠ¡æ°´å¹³åè®®çš„è¾¾æˆ

æ ¸å¿ƒæ€§èƒ½ç»´åº¦ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å“åº”æ—¶é—´ (Response Time)           â”‚
â”‚  â”œâ”€ å¹³å‡å“åº”æ—¶é—´                    â”‚
â”‚  â”œâ”€ 95ç™¾åˆ†ä½å“åº”æ—¶é—´                â”‚
â”‚  â””â”€ æœ€å¤§å“åº”æ—¶é—´                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ååé‡ (Throughput)                â”‚  
â”‚  â”œâ”€ è¯·æ±‚å¤„ç†é€Ÿç‡ (RPS)              â”‚
â”‚  â”œâ”€ æ•°æ®å¤„ç†é‡ (MB/s)               â”‚
â”‚  â””â”€ å¹¶å‘ç”¨æˆ·æ•°                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é”™è¯¯ç‡ (Error Rate)                â”‚
â”‚  â”œâ”€ HTTPé”™è¯¯æ¯”ä¾‹                    â”‚
â”‚  â”œâ”€ åº”ç”¨å¼‚å¸¸ç‡                      â”‚
â”‚  â””â”€ è¶…æ—¶é”™è¯¯ç‡                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  èµ„æºä½¿ç”¨ (Resource Usage)          â”‚
â”‚  â”œâ”€ CPUä½¿ç”¨ç‡                       â”‚
â”‚  â”œâ”€ å†…å­˜ä½¿ç”¨ç‡                      â”‚
â”‚  â””â”€ ç£ç›˜I/Oä½¿ç”¨ç‡                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 å“åº”æ—¶é—´ç›‘æ§å®ç°


**ğŸ”¸ å“åº”æ—¶é—´åˆ†æè„šæœ¬**
```bash
#!/bin/bash
# HTTPå“åº”æ—¶é—´ç›‘æ§è„šæœ¬

ACCESS_LOG="/var/log/nginx/access.log"
METRICS_DIR="/var/metrics/response_time"
mkdir -p "$METRICS_DIR"

# åˆ†æå“åº”æ—¶é—´åˆ†å¸ƒ
analyze_response_time() {
    local time_period=${1:-"1 hour ago"}
    local output_file="$METRICS_DIR/response_time_$(date +%Y%m%d_%H%M).txt"
    
    echo "=== å“åº”æ—¶é—´åˆ†ææŠ¥å‘Š ===" > "$output_file"
    echo "æ—¶é—´èŒƒå›´: $time_period è‡³ $(date)" >> "$output_file"
    echo "" >> "$output_file"
    
    # æå–æŒ‡å®šæ—¶é—´æ®µçš„å“åº”æ—¶é—´æ•°æ®
    awk -v since="$(date -d "$time_period" +%s)" '
    {
        # è§£ænginxæ—¥å¿—æ—¶é—´æˆ³ (éœ€è¦æ ¹æ®å®é™…æ ¼å¼è°ƒæ•´)
        gsub(/\[|\]/, "", $4)
        cmd = "date -d \"" $4 "\" +%s 2>/dev/null"
        cmd | getline timestamp
        close(cmd)
        
        if (timestamp >= since && $NF ~ /^[0-9]+$/) {
            response_times[++count] = $NF
            total += $NF
            
            # åˆ†ç±»ç»Ÿè®¡
            if ($NF < 100) fast++
            else if ($NF < 500) normal++
            else if ($NF < 1000) slow++
            else if ($NF < 3000) very_slow++
            else critical++
        }
    }
    END {
        if (count > 0) {
            # è®¡ç®—åŸºæœ¬ç»Ÿè®¡
            avg = total / count
            print "æ€»è¯·æ±‚æ•°: " count
            print "å¹³å‡å“åº”æ—¶é—´: " avg " ms"
            
            # æ’åºè®¡ç®—ç™¾åˆ†ä½
            asort(response_times)
            p50 = response_times[int(count * 0.5)]
            p90 = response_times[int(count * 0.9)]  
            p95 = response_times[int(count * 0.95)]
            p99 = response_times[int(count * 0.99)]
            
            print "50% ç™¾åˆ†ä½: " p50 " ms"
            print "90% ç™¾åˆ†ä½: " p90 " ms"
            print "95% ç™¾åˆ†ä½: " p95 " ms"
            print "99% ç™¾åˆ†ä½: " p99 " ms"
            print "æœ€å¤§å“åº”æ—¶é—´: " response_times[count] " ms"
            print ""
            
            # å“åº”æ—¶é—´åˆ†å¸ƒ
            print "å“åº”æ—¶é—´åˆ†å¸ƒ:"
            printf "  < 100ms:     %6d (%.1f%%)\n", fast, fast*100/count
            printf "  100-500ms:   %6d (%.1f%%)\n", normal, normal*100/count
            printf "  500ms-1s:    %6d (%.1f%%)\n", slow, slow*100/count
            printf "  1-3s:        %6d (%.1f%%)\n", very_slow, very_slow*100/count
            printf "  > 3s:        %6d (%.1f%%)\n", critical, critical*100/count
        }
    }' "$ACCESS_LOG" >> "$output_file"
    
    echo "å“åº”æ—¶é—´åˆ†æå®Œæˆ: $output_file"
}

# å®æ—¶å“åº”æ—¶é—´ç›‘æ§
monitor_realtime_response() {
    echo "å¼€å§‹å®æ—¶å“åº”æ—¶é—´ç›‘æ§..."
    
    tail -F "$ACCESS_LOG" | while read line; do
        response_time=$(echo "$line" | awk '{print $NF}')
        
        # æ£€æŸ¥æ˜¯å¦æ˜¯æœ‰æ•ˆçš„å“åº”æ—¶é—´
        if [[ "$response_time" =~ ^[0-9]+$ ]]; then
            timestamp=$(date '+%Y-%m-%d %H:%M:%S')
            
            # å“åº”æ—¶é—´å‘Šè­¦é˜ˆå€¼æ£€æŸ¥
            if (( response_time > 3000 )); then
                echo "[$timestamp] âš ï¸  ä¸¥é‡: å“åº”æ—¶é—´ ${response_time}ms"
                # è¿™é‡Œå¯ä»¥è§¦å‘å‘Šè­¦
                # send_alert "CRITICAL" "å“åº”æ—¶é—´è¿‡é•¿: ${response_time}ms"
            elif (( response_time > 1000 )); then
                echo "[$timestamp] âš ï¸  è­¦å‘Š: å“åº”æ—¶é—´ ${response_time}ms"
            fi
            
            # è®°å½•åˆ°æ—¶é—´åºåˆ—æ•°æ®
            echo "$timestamp,$response_time" >> "$METRICS_DIR/realtime_response.csv"
        fi
    done
}
```

### 7.3 ååé‡ç›‘æ§å®ç°


**ğŸ”¸ ååé‡ç»Ÿè®¡è„šæœ¬**
```bash
#!/bin/bash
# ååé‡ç›‘æ§è„šæœ¬

# è®¡ç®—RPS (Requests Per Second)
calculate_rps() {
    local time_window=${1:-60}  # é»˜è®¤60ç§’çª—å£
    local current_time=$(date +%s)
    local start_time=$((current_time - time_window))
    
    # ç»Ÿè®¡æ—¶é—´çª—å£å†…çš„è¯·æ±‚æ•°
    local request_count=$(awk -v start="$start_time" -v end="$current_time" '
    {
        gsub(/\[|\]/, "", $4)
        cmd = "date -d \"" $4 "\" +%s 2>/dev/null"
        cmd | getline timestamp
        close(cmd)
        
        if (timestamp >= start && timestamp <= end) {
            count++
        }
    }
    END {
        print count + 0
    }' "$ACCESS_LOG")
    
    local rps=$(echo "scale=2; $request_count / $time_window" | bc)
    echo "å½“å‰RPS: $rps requests/second (æœ€è¿‘${time_window}ç§’)"
    
    # RPSå‘Šè­¦æ£€æŸ¥
    if (( $(echo "$rps < 1.0" | bc -l) )); then
        echo "âš ï¸  è­¦å‘Š: RPSè¿‡ä½ï¼Œå¯èƒ½å­˜åœ¨æ€§èƒ½é—®é¢˜"
    elif (( $(echo "$rps > 1000.0" | bc -l) )); then
        echo "âš ï¸  è­¦å‘Š: RPSè¿‡é«˜ï¼Œå¯èƒ½å­˜åœ¨æµé‡å¼‚å¸¸"
    fi
}

# å¹¶å‘ç”¨æˆ·æ•°ç›‘æ§
monitor_concurrent_users() {
    local time_window=300  # 5åˆ†é’Ÿçª—å£
    
    echo "=== å¹¶å‘ç”¨æˆ·ç›‘æ§ ==="
    
    # ç»Ÿè®¡æ´»è·ƒIPæ•°é‡ï¼ˆ5åˆ†é’Ÿå†…æœ‰è®¿é—®çš„IPï¼‰
    local concurrent_ips=$(awk -v window="$time_window" '
    {
        gsub(/\[|\]/, "", $4)
        cmd = "date -d \"" $4 "\" +%s 2>/dev/null" 
        cmd | getline timestamp
        close(cmd)
        
        if ((systime() - timestamp) <= window) {
            ips[$1] = 1
        }
    }
    END {
        print length(ips)
    }' "$ACCESS_LOG")
    
    echo "å½“å‰å¹¶å‘ç”¨æˆ·æ•°: $concurrent_ips"
    
    # ç»Ÿè®¡ä¸åŒæ—¶é—´æ®µçš„å¹¶å‘åˆ†å¸ƒ
    echo "å¹¶å‘ç”¨æˆ·æ•°è¶‹åŠ¿ (æ¯å°æ—¶):"
    for hour in {23..0}; do
        hour_start=$(date -d "$hour hours ago" +%s)
        hour_end=$(date -d "$((hour-1)) hours ago" +%s)
        
        user_count=$(awk -v start="$hour_start" -v end="$hour_end" '
        {
            gsub(/\[|\]/, "", $4)
            cmd = "date -d \"" $4 "\" +%s 2>/dev/null"
            cmd | getline timestamp  
            close(cmd)
            
            if (timestamp >= start && timestamp < end) {
                ips[$1] = 1
            }
        }
        END {
            print length(ips)
        }' "$ACCESS_LOG")
        
        hour_label=$(date -d "$hour hours ago" +"%H:00")
        printf "%s: %4d users\n" "$hour_label" "$user_count"
    done
}
```

### 7.4 é”™è¯¯ç‡ç›‘æ§å®ç°


**ğŸ”¸ é”™è¯¯ç‡åˆ†æè„šæœ¬**
```bash
#!/bin/bash
# é”™è¯¯ç‡ç›‘æ§è„šæœ¬

# è®¡ç®—HTTPé”™è¯¯ç‡
calculate_error_rate() {
    local time_period=${1:-"1 hour ago"}
    
    echo "=== HTTPé”™è¯¯ç‡åˆ†æ ==="
    echo "æ—¶é—´èŒƒå›´: $time_period è‡³ $(date)"
    echo ""
    
    # ç»Ÿè®¡å„ç§çŠ¶æ€ç 
    awk -v since="$(date -d "$time_period" +%s)" '
    {
        gsub(/\[|\]/, "", $4)
        cmd = "date -d \"" $4 "\" +%s 2>/dev/null"
        cmd | getline timestamp
        close(cmd)
        
        if (timestamp >= since) {
            total++
            status_code = $9
            status_codes[status_code]++
            
            # åˆ†ç±»ç»Ÿè®¡
            if (status_code ~ /^2/) success++
            else if (status_code ~ /^3/) redirect++  
            else if (status_code ~ /^4/) client_error++
            else if (status_code ~ /^5/) server_error++
        }
    }
    END {
        if (total > 0) {
            print "æ€»è¯·æ±‚æ•°: " total
            printf "æˆåŠŸç‡ (2xx): %.2f%% (%d requests)\n", success*100/total, success
            printf "é‡å®šå‘ (3xx): %.2f%% (%d requests)\n", redirect*100/total, redirect
            printf "å®¢æˆ·ç«¯é”™è¯¯ (4xx): %.2f%% (%d requests)\n", client_error*100/total, client_error
            printf "æœåŠ¡å™¨é”™è¯¯ (5xx): %.2f%% (%d requests)\n", server_error*100/total, server_error
            
            total_errors = client_error + server_error
            error_rate = total_errors * 100 / total
            printf "\næ€»é”™è¯¯ç‡: %.2f%% (%d errors)\n", error_rate, total_errors
            
            # é”™è¯¯ç‡å‘Šè­¦
            if (error_rate > 5.0) {
                print "ğŸ”´ ä¸¥é‡: é”™è¯¯ç‡è¿‡é«˜ (" error_rate "%)"
            } elif (error_rate > 1.0) {
                print "ğŸŸ¡ è­¦å‘Š: é”™è¯¯ç‡åé«˜ (" error_rate "%)"
            } else {
                print "âœ… æ­£å¸¸: é”™è¯¯ç‡åœ¨åˆç†èŒƒå›´å†…"
            }
            
            print "\nè¯¦ç»†çŠ¶æ€ç åˆ†å¸ƒ:"
            for (code in status_codes) {
                printf "  %s: %6d (%.2f%%)\n", code, status_codes[code], status_codes[code]*100/total
            }
        }
    }' "$ACCESS_LOG"
}

# åº”ç”¨å¼‚å¸¸ç›‘æ§
monitor_application_errors() {
    local app_log="/var/log/application.log"
    local error_patterns=("Exception" "ERROR" "FATAL" "OutOfMemoryError" "StackOverflowError")
    
    echo "=== åº”ç”¨å¼‚å¸¸ç›‘æ§ ==="
    
    for pattern in "${error_patterns[@]}"; do
        count=$(grep -c "$pattern" "$app_log" 2>/dev/null || echo "0")
        echo "$pattern: $count æ¬¡"
        
        if [[ "$pattern" == "FATAL" && $count -gt 0 ]]; then
            echo "ğŸ”´ å‘ç°è‡´å‘½é”™è¯¯ï¼"
        elif [[ "$pattern" == "ERROR" && $count -gt 50 ]]; then
            echo "ğŸŸ¡ é”™è¯¯æ•°é‡è¾ƒå¤šï¼Œéœ€è¦å…³æ³¨"
        fi
    done
}
```

---

## 8. ğŸ› ï¸ æ—¥å¿—ç›‘æ§å·¥å…·é€‰æ‹©


### 8.1 æ—¥å¿—ç›‘æ§å·¥å…·åˆ†ç±»


**æŒ‰åŠŸèƒ½ç‰¹ç‚¹åˆ†ç±»**ï¼š

```
è½»é‡çº§å·¥å…·ï¼š
ğŸ”¸ é€‚åˆåœºæ™¯ï¼šå°å‹é¡¹ç›®ã€èµ„æºå—é™ç¯å¢ƒ
ğŸ”¸ ç‰¹ç‚¹ï¼šå ç”¨èµ„æºå°‘ã€é…ç½®ç®€å•ã€åŠŸèƒ½åŸºç¡€
ğŸ”¸ ä»£è¡¨å·¥å…·ï¼štailã€grepã€awkã€è‡ªå®šä¹‰è„šæœ¬

ä¸­å‹å·¥å…·ï¼š
ğŸ”¸ é€‚åˆåœºæ™¯ï¼šä¸­ç­‰è§„æ¨¡åº”ç”¨ã€éœ€è¦åŸºæœ¬å¯è§†åŒ–
ğŸ”¸ ç‰¹ç‚¹ï¼šåŠŸèƒ½è¾ƒå®Œå–„ã€æœ‰Webç•Œé¢ã€é…ç½®ä¸­ç­‰å¤æ‚åº¦
ğŸ”¸ ä»£è¡¨å·¥å…·ï¼šGrafana + Lokiã€Fluentd

ä¼ä¸šçº§å·¥å…·ï¼š
ğŸ”¸ é€‚åˆåœºæ™¯ï¼šå¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿã€å¤æ‚ç›‘æ§éœ€æ±‚
ğŸ”¸ ç‰¹ç‚¹ï¼šåŠŸèƒ½å…¨é¢ã€é«˜å¯ç”¨ã€æ”¯æŒé›†ç¾¤éƒ¨ç½²
ğŸ”¸ ä»£è¡¨å·¥å…·ï¼šELK Stackã€Splunkã€SumoLogic
```

### 8.2 å¸¸ç”¨æ—¥å¿—ç›‘æ§å·¥å…·å¯¹æ¯”


| å·¥å…· | **é€‚ç”¨è§„æ¨¡** | **å­¦ä¹ æˆæœ¬** | **èµ„æºæ¶ˆè€—** | **åŠŸèƒ½ä¸°å¯Œåº¦** | **ä»·æ ¼** |
|------|-------------|-------------|-------------|-------------|----------|
| **Shellè„šæœ¬** | `å°å‹` | `ğŸŸ¢ ä½` | `ğŸŸ¢ ä½` | `ğŸŸ¡ åŸºç¡€` | `ğŸŸ¢ å…è´¹` |
| **Grafana + Loki** | `ä¸­å‹` | `ğŸŸ¡ ä¸­` | `ğŸŸ¡ ä¸­` | `ğŸŸ¢ ä¸°å¯Œ` | `ğŸŸ¢ å…è´¹` |
| **ELK Stack** | `å¤§å‹` | `ğŸ”´ é«˜` | `ğŸ”´ é«˜` | `ğŸŸ¢ éå¸¸ä¸°å¯Œ` | `ğŸŸ¡ éƒ¨åˆ†å…è´¹` |
| **Splunk** | `ä¼ä¸šçº§` | `ğŸ”´ é«˜` | `ğŸŸ¡ ä¸­` | `ğŸŸ¢ éå¸¸ä¸°å¯Œ` | `ğŸ”´ æ˜‚è´µ` |
| **Datadog** | `ä¼ä¸šçº§` | `ğŸŸ¡ ä¸­` | `ğŸŸ¢ ä½(SaaS)` | `ğŸŸ¢ éå¸¸ä¸°å¯Œ` | `ğŸ”´ æ˜‚è´µ` |

### 8.3 å·¥å…·é€‰æ‹©å†³ç­–æ ‘


**ğŸ”¸ é€‰æ‹©å†³ç­–æµç¨‹**
```
å¼€å§‹é€‰æ‹©
    â†“
æ—¥å¿—é‡ < 1GB/å¤©ï¼Ÿ
    â†“ æ˜¯                        â†“ å¦
ä½¿ç”¨Shellè„šæœ¬                  éœ€è¦å®æ—¶æœç´¢ï¼Ÿ
    â†“                            â†“ æ˜¯              â†“ å¦  
å›¢é˜Ÿ < 5äººï¼Ÿ                    é¢„ç®—å……è¶³ï¼Ÿ          ä½¿ç”¨Grafana+Loki
    â†“ æ˜¯        â†“ å¦               â†“ æ˜¯    â†“ å¦
Shellè„šæœ¬    Grafana+Loki      Splunk   ELK Stack
```

**ğŸ”¸ å…·ä½“åœºæ™¯å»ºè®®**

**å°å‹é¡¹ç›® (< 10å°æœåŠ¡å™¨)**ï¼š
```bash
æ¨èæ–¹æ¡ˆ: Shellè„šæœ¬ + Crontab
ä¼˜åŠ¿:
âœ… é›¶å­¦ä¹ æˆæœ¬ï¼Œç›´æ¥ä½¿ç”¨
âœ… èµ„æºå ç”¨æå°‘
âœ… å®Œå…¨å¯æ§ï¼Œå®šåˆ¶æ€§å¼º
âœ… æ— é¢å¤–ä¾èµ–

å®æ–½å»ºè®®:
- ä½¿ç”¨å‰é¢ä»‹ç»çš„ç›‘æ§è„šæœ¬
- é…ç½®é‚®ä»¶å‘Šè­¦
- å®šæœŸæ¸…ç†æ—¥å¿—æ–‡ä»¶
- å»ºç«‹ç®€å•çš„ç›‘æ§ä»ªè¡¨æ¿
```

**ä¸­å‹é¡¹ç›® (10-100å°æœåŠ¡å™¨)**ï¼š
```bash
æ¨èæ–¹æ¡ˆ: Grafana + Loki + Promtail
ä¼˜åŠ¿:
âœ… ç°ä»£åŒ–çš„Webç•Œé¢
âœ… å¼ºå¤§çš„æŸ¥è¯¢å’Œå¯è§†åŒ–èƒ½åŠ›
âœ… è¾ƒä½çš„èµ„æºæ¶ˆè€—
âœ… æ´»è·ƒçš„ç¤¾åŒºæ”¯æŒ

éƒ¨ç½²ç¤ºä¾‹:
# å®‰è£…Loki (æ—¥å¿—æ•°æ®åº“)
docker run -d --name=loki -p 3100:3100 grafana/loki

# å®‰è£…Grafana (å¯è§†åŒ–ç•Œé¢)
docker run -d --name=grafana -p 3000:3000 grafana/grafana

# é…ç½®Promtail (æ—¥å¿—æ”¶é›†å™¨)
docker run -d --name=promtail \
  -v /var/log:/var/log \
  -v /tmp/promtail-config.yml:/etc/promtail/config.yml \
  grafana/promtail
```

**å¤§å‹é¡¹ç›® (100+ å°æœåŠ¡å™¨)**ï¼š
```bash
æ¨èæ–¹æ¡ˆ: ELK Stack (Elasticsearch + Logstash + Kibana)
ä¼˜åŠ¿:
âœ… å¤„ç†æµ·é‡æ•°æ®çš„èƒ½åŠ›
âœ… å¼ºå¤§çš„æœç´¢å’Œåˆ†æåŠŸèƒ½
âœ… ä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€
âœ… æ”¯æŒå¤æ‚çš„æ•°æ®å¤„ç†ç®¡é“

æ¶æ„ç¤ºä¾‹:
åº”ç”¨æœåŠ¡å™¨ â†’ Filebeat â†’ Logstash â†’ Elasticsearch â†’ Kibana
     â†“           â†“           â†“            â†“            â†“
   äº§ç”Ÿæ—¥å¿—    æ”¶é›†æ—¥å¿—    å¤„ç†æ—¥å¿—     å­˜å‚¨æœç´¢     å¯è§†åŒ–å±•ç¤º
```

### 8.4 è‡ªå»ºç›‘æ§ç³»ç»Ÿæ–¹æ¡ˆ


**ğŸ”¸ åŸºäºShellçš„å®Œæ•´ç›‘æ§æ–¹æ¡ˆ**
```bash
#!/bin/bash
# ç»¼åˆæ—¥å¿—ç›‘æ§ç³»ç»Ÿ

MONITOR_HOME="/opt/log-monitor"
CONFIG_FILE="$MONITOR_HOME/config/monitor.conf"
WEB_DIR="$MONITOR_HOME/web"

# é…ç½®æ–‡ä»¶ç¤ºä¾‹
cat > "$CONFIG_FILE" << 'EOF'
# ç›‘æ§é…ç½®
LOG_FILES=(
    "/var/log/nginx/access.log:web"
    "/var/log/application.log:app"
    "/var/log/syslog:system"
)

ALERT_EMAIL="ops@company.com"
ALERT_THRESHOLD_ERROR_RATE=5.0
ALERT_THRESHOLD_RESPONSE_TIME=3000
REPORT_INTERVAL=3600  # 1å°æ—¶
EOF

# ä¸»ç›‘æ§å‡½æ•°
main_monitor() {
    source "$CONFIG_FILE"
    
    while true; do
        for log_entry in "${LOG_FILES[@]}"; do
            log_file=$(echo "$log_entry" | cut -d: -f1)
            log_type=$(echo "$log_entry" | cut -d: -f2)
            
            if [[ -f "$log_file" ]]; then
                monitor_log_file "$log_file" "$log_type"
            fi
        done
        
        sleep 60  # æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
    done
}

# ç”ŸæˆWebä»ªè¡¨æ¿
generate_web_dashboard() {
    local dashboard_file="$WEB_DIR/dashboard.html"
    
    cat > "$dashboard_file" << 'HTML'
<!DOCTYPE html>
<html>
<head>
    <title>æ—¥å¿—ç›‘æ§ä»ªè¡¨æ¿</title>
    <meta charset="utf-8">
    <meta http-equiv="refresh" content="60">
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .metric-card { 
            border: 1px solid #ddd; 
            padding: 15px; 
            margin: 10px; 
            border-radius: 5px; 
            display: inline-block; 
            min-width: 200px;
        }
        .metric-value { font-size: 24px; font-weight: bold; }
        .metric-label { color: #666; }
        .status-ok { color: green; }
        .status-warning { color: orange; }
        .status-critical { color: red; }
        .chart { margin: 20px 0; }
    </style>
</head>
<body>
    <h1>ç³»ç»Ÿæ—¥å¿—ç›‘æ§ä»ªè¡¨æ¿</h1>
    <p>æœ€åæ›´æ–°: <span id="timestamp"></span></p>
    
    <div class="metrics">
        <div class="metric-card">
            <div class="metric-label">å½“å‰RPS</div>
            <div class="metric-value status-ok" id="current-rps">0</div>
        </div>
        
        <div class="metric-card">
            <div class="metric-label">é”™è¯¯ç‡</div>
            <div class="metric-value status-ok" id="error-rate">0%</div>
        </div>
        
        <div class="metric-card">
            <div class="metric-label">å¹³å‡å“åº”æ—¶é—´</div>
            <div class="metric-value status-ok" id="avg-response">0ms</div>
        </div>
        
        <div class="metric-card">
            <div class="metric-label">æ´»è·ƒå‘Šè­¦</div>
            <div class="metric-value status-ok" id="active-alerts">0</div>
        </div>
    </div>
    
    <div class="chart">
        <h3>24å°æ—¶è®¿é—®é‡è¶‹åŠ¿</h3>
        <pre id="access-trend"></pre>
    </div>
    
    <div class="recent-alerts">
        <h3>æœ€è¿‘å‘Šè­¦</h3>
        <div id="alert-list"></div>
    </div>
    
    <script>
        // è‡ªåŠ¨æ›´æ–°æ•°æ®
        function updateDashboard() {
            fetch('/api/metrics')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('current-rps').textContent = data.rps;
                    document.getElementById('error-rate').textContent = data.error_rate + '%';
                    document.getElementById('avg-response').textContent = data.avg_response + 'ms';
                    document.getElementById('active-alerts').textContent = data.alerts;
                    document.getElementById('timestamp').textContent = new Date().toLocaleString();
                });
        }
        
        setInterval(updateDashboard, 30000);
        updateDashboard();
    </script>
</body>
</html>
HTML
    
    echo "Webä»ªè¡¨æ¿å·²ç”Ÿæˆ: $dashboard_file"
}

# å¯åŠ¨WebæœåŠ¡å™¨
start_web_server() {
    cd "$WEB_DIR"
    python3 -m http.server 8080 &
    echo "WebæœåŠ¡å™¨å·²å¯åŠ¨: http://localhost:8080"
}
```

**ğŸ”¸ ç›‘æ§ç³»ç»Ÿçš„é«˜çº§ç‰¹æ€§**
```bash
# æ™ºèƒ½æ—¥å¿—åˆ†æå¼•æ“
intelligent_log_analysis() {
    local log_file=$1
    local analysis_result="/tmp/log_analysis_$(date +%Y%m%d).json"
    
    # ä½¿ç”¨æœºå™¨å­¦ä¹ æ–¹æ³•æ£€æµ‹å¼‚å¸¸
    python3 << 'PYTHON'
import json
import re
from datetime import datetime, timedelta
from collections import defaultdict, Counter

def analyze_log_patterns(log_file):
    patterns = defaultdict(int)
    time_series = defaultdict(list)
    anomalies = []
    
    with open(log_file, 'r') as f:
        for line in f:
            # æå–æ—¶é—´æˆ³
            timestamp_match = re.search(r'\[(.*?)\]', line)
            if timestamp_match:
                timestamp = timestamp_match.group(1)
                
                # ç»Ÿè®¡è®¿é—®æ¨¡å¼
                if 'GET' in line or 'POST' in line:
                    patterns['requests'] += 1
                
                # æ£€æµ‹å¼‚å¸¸æ¨¡å¼
                if any(keyword in line.upper() for keyword in ['ERROR', 'FAILED', 'TIMEOUT']):
                    anomalies.append({
                        'timestamp': timestamp,
                        'severity': 'high',
                        'message': line.strip()
                    })
    
    return {
        'patterns': dict(patterns),
        'anomalies': anomalies,
        'summary': {
            'total_requests': patterns['requests'],
            'anomaly_count': len(anomalies),
            'analysis_time': datetime.now().isoformat()
        }
    }

# æ‰§è¡Œåˆ†æ
result = analyze_log_patterns('$log_file')
with open('$analysis_result', 'w') as f:
    json.dump(result, f, indent=2)
PYTHON
    
    echo "æ™ºèƒ½åˆ†æå®Œæˆ: $analysis_result"
}
```

### 8.5 ç›‘æ§å·¥å…·é›†æˆæœ€ä½³å®è·µ


**ğŸ”¸ å¤šå·¥å…·ååŒæ–¹æ¡ˆ**
```bash
# åˆ†å±‚ç›‘æ§æ¶æ„
ç›‘æ§å±‚æ¬¡æ¶æ„:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ä¸šåŠ¡å±‚ç›‘æ§                â”‚
â”‚    (ä¸šåŠ¡æŒ‡æ ‡ã€ç”¨æˆ·ä½“éªŒ)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        åº”ç”¨å±‚ç›‘æ§                â”‚
â”‚    (åº”ç”¨æ€§èƒ½ã€é”™è¯¯ç‡)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        ç³»ç»Ÿå±‚ç›‘æ§                â”‚
â”‚    (èµ„æºä½¿ç”¨ã€ç³»ç»ŸæŒ‡æ ‡)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        ç½‘ç»œå±‚ç›‘æ§                â”‚
â”‚    (ç½‘ç»œæµé‡ã€è¿æ¥çŠ¶æ€)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å·¥å…·é…ç½®:
# ç³»ç»Ÿå±‚: Prometheus + Node Exporter
# åº”ç”¨å±‚: è‡ªå®šä¹‰è„šæœ¬ + Grafana
# ä¸šåŠ¡å±‚: ELK Stack
# å‘Šè­¦: AlertManager + ä¼ä¸šIM
```

**ğŸ”¸ ç›‘æ§æ•°æ®æ ‡å‡†åŒ–**
```bash
# ç»Ÿä¸€ç›‘æ§æ•°æ®æ ¼å¼
standardize_metrics() {
    local metric_name=$1
    local metric_value=$2
    local metric_tags=$3
    
    # ç”Ÿæˆæ ‡å‡†æ ¼å¼çš„ç›‘æ§æ•°æ®
    cat >> "/var/metrics/standardized.log" << EOF
{
    "timestamp": "$(date -u +%Y-%m-%dT%H:%M:%SZ)",
    "metric": "$metric_name",
    "value": $metric_value,
    "tags": $metric_tags,
    "host": "$(hostname)",
    "source": "log-monitor"
}
EOF
}

# è°ƒç”¨ç¤ºä¾‹
standardize_metrics "http_request_rate" "150.5" '{"service":"web","environment":"production"}'
standardize_metrics "error_rate" "2.3" '{"service":"api","environment":"production"}'
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæŠ€èƒ½


```
ğŸ¯ åŸºç¡€ç›‘æ§æŠ€èƒ½:
âœ… tailå®æ—¶ç›‘æ§: æŒæ¡-fã€-Få‚æ•°ï¼Œç†è§£æ–‡ä»¶è½®è½¬å¤„ç†
âœ… å…³é”®å­—ç›‘æ§: ä½¿ç”¨grepã€awkè¿›è¡Œæ¨¡å¼åŒ¹é…å’Œç»Ÿè®¡
âœ… å¤šæ–‡ä»¶ç›‘æ§: multitailåˆ†å±æ˜¾ç¤ºï¼Œæé«˜ç›‘æ§æ•ˆç‡
âœ… è„šæœ¬ç¼–å†™: ç¼–å†™è‡ªåŠ¨åŒ–ç›‘æ§è„šæœ¬ï¼Œå®ç°æŒç»­ç›‘æ§

ğŸ¯ é«˜çº§åˆ†ææŠ€èƒ½:
âœ… å¼‚å¸¸æ¨¡å¼è¯†åˆ«: è¯†åˆ«å®‰å…¨å¨èƒã€æ€§èƒ½é—®é¢˜ã€ç³»ç»Ÿæ•…éšœ
âœ… ç»Ÿè®¡åˆ†æ: ç”Ÿæˆè®¿é—®æŠ¥å‘Šã€æ€§èƒ½æŠ¥å‘Šã€è¶‹åŠ¿åˆ†æ
âœ… å‘Šè­¦æœºåˆ¶: è®¾è®¡å¤šçº§å‘Šè­¦ä½“ç³»ï¼Œé¿å…å‘Šè­¦ç–²åŠ³
âœ… å·¥å…·é€‰æ‹©: æ ¹æ®é¡¹ç›®è§„æ¨¡é€‰æ‹©åˆé€‚çš„ç›‘æ§å·¥å…·
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ç›‘æ§çš„æœ¬è´¨ç›®çš„**
```
ä¸æ˜¯ä¸ºäº†ç›‘æ§è€Œç›‘æ§ï¼Œè€Œæ˜¯è¦è§£å†³å®é™…é—®é¢˜:
- é¢„é˜²é—®é¢˜: åœ¨é—®é¢˜å½±å“ç”¨æˆ·å‰å‘ç°å¹¶è§£å†³
- å¿«é€Ÿå®šä½: é—®é¢˜å‘ç”Ÿæ—¶å¿«é€Ÿæ‰¾åˆ°æ ¹æœ¬åŸå›   
- ä¼˜åŒ–å†³ç­–: åŸºäºæ•°æ®åšå‡ºåˆç†çš„ä¼˜åŒ–å†³ç­–
- å®¹é‡è§„åˆ’: é¢„æµ‹èµ„æºéœ€æ±‚ï¼Œé¿å…èµ„æºä¸è¶³
```

**ğŸ”¹ ç›‘æ§æ•°æ®çš„ä»·å€¼æŒ–æ˜**
```
ä»æ—¥å¿—ä¸­æå–æœ‰ä»·å€¼çš„ä¿¡æ¯:
- ç”¨æˆ·è¡Œä¸º: äº†è§£ç”¨æˆ·ä½¿ç”¨ä¹ æƒ¯å’Œåå¥½
- ç³»ç»Ÿæ€§èƒ½: è¯†åˆ«æ€§èƒ½ç“¶é¢ˆå’Œä¼˜åŒ–æœºä¼š
- å®‰å…¨å¨èƒ: åŠæ—¶å‘ç°å’Œé˜»æ­¢æ”»å‡»è¡Œä¸º
- ä¸šåŠ¡æ´å¯Ÿ: ä»æŠ€æœ¯æŒ‡æ ‡æ¨å¯¼ä¸šåŠ¡æŒ‡æ ‡
```

**ğŸ”¹ ç›‘æ§ç­–ç•¥çš„å¹³è¡¡è‰ºæœ¯**
```
éœ€è¦åœ¨å¤šä¸ªç»´åº¦æ‰¾åˆ°å¹³è¡¡:
- è¦†ç›–é¢ vs ç²¾ç¡®åº¦: å…¨é¢ç›‘æ§ vs é‡ç‚¹ç›‘æ§
- å®æ—¶æ€§ vs èµ„æºæ¶ˆè€—: å¿«é€Ÿå“åº” vs ç³»ç»Ÿè´Ÿè½½
- è‡ªåŠ¨åŒ– vs äººå·¥å¹²é¢„: å‡å°‘äººåŠ› vs ä¿æŒæ§åˆ¶
- ç®€å•æ€§ vs åŠŸèƒ½æ€§: æ˜“äºç»´æŠ¤ vs åŠŸèƒ½ä¸°å¯Œ
```

### 9.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ“Š ç›‘æ§å®æ–½è·¯çº¿å›¾**
```
é˜¶æ®µ1: åŸºç¡€ç›‘æ§ (ç¬¬1-2å‘¨)
- å®ç°åŸºæœ¬çš„tailç›‘æ§
- é…ç½®å…³é”®å­—å‘Šè­¦
- å»ºç«‹æ—¥å¸¸å·¡æ£€æµç¨‹

é˜¶æ®µ2: è‡ªåŠ¨åŒ–ç›‘æ§ (ç¬¬3-4å‘¨)  
- ç¼–å†™ç›‘æ§è„šæœ¬
- é…ç½®è‡ªåŠ¨å‘Šè­¦
- å»ºç«‹æŠ¥è¡¨ç”Ÿæˆæœºåˆ¶

é˜¶æ®µ3: æ™ºèƒ½ç›‘æ§ (ç¬¬5-8å‘¨)
- å®ç°å¼‚å¸¸æ¨¡å¼è¯†åˆ«
- é…ç½®åŠ¨æ€é˜ˆå€¼
- ä¼˜åŒ–å‘Šè­¦ç­–ç•¥

é˜¶æ®µ4: å¹³å°åŒ–ç›‘æ§ (ç¬¬9-12å‘¨)
- é€‰æ‹©å’Œéƒ¨ç½²ç›‘æ§å¹³å°
- é›†æˆå¤šæ•°æ®æº
- å»ºç«‹ç›‘æ§è¿è¥ä½“ç³»
```

**ğŸ”§ ç›‘æ§è¿ç»´æœ€ä½³å®è·µ**

```
æ—¥å¸¸è¿ç»´è§„èŒƒ:
ğŸ”¸ ç›‘æ§è„šæœ¬å®šæœŸæ£€æŸ¥: ç¡®ä¿ç›‘æ§è„šæœ¬æ­£å¸¸è¿è¡Œ
ğŸ”¸ å‘Šè­¦è§„åˆ™å®šæœŸä¼˜åŒ–: æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´é˜ˆå€¼
ğŸ”¸ ç›‘æ§æ•°æ®å®šæœŸæ¸…ç†: é¿å…ç£ç›˜ç©ºé—´ä¸è¶³
ğŸ”¸ ç›‘æ§ç³»ç»Ÿè‡ªèº«ç›‘æ§: ç›‘æ§çš„ç›‘æ§ï¼Œç¡®ä¿å¯é æ€§

åº”æ€¥å“åº”æµç¨‹:
ğŸ”¸ å‘Šè­¦åˆ†çº§å¤„ç†: ä¸åŒçº§åˆ«é‡‡ç”¨ä¸åŒå“åº”æ—¶é—´
ğŸ”¸ é—®é¢˜å‡çº§æœºåˆ¶: æ˜ç¡®ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦å‡çº§
ğŸ”¸ å¤„ç†è®°å½•å½’æ¡£: ä¸ºåç»­ä¼˜åŒ–æä¾›å‚è€ƒ
ğŸ”¸ å¤ç›˜æ”¹è¿›æœºåˆ¶: å®šæœŸæ€»ç»“å’Œæ”¹è¿›ç›‘æ§ç­–ç•¥
```

### 9.4 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


**âŒ å¸¸è§ç›‘æ§è¯¯åŒº**
```
è¯¯åŒº1: ç›‘æ§è¶Šå¤šè¶Šå¥½
æ­£è§£: é‡ç‚¹ç›‘æ§æ ¸å¿ƒæŒ‡æ ‡ï¼Œé¿å…ä¿¡æ¯è¿‡è½½

è¯¯åŒº2: é˜ˆå€¼è®¾ç½®è¿‡äºæ•æ„Ÿ
æ­£è§£: åŸºäºå†å²æ•°æ®è®¾ç½®åˆç†é˜ˆå€¼ï¼Œé¿å…è¯¯æŠ¥

è¯¯åŒº3: åªå…³æ³¨æŠ€æœ¯æŒ‡æ ‡
æ­£è§£: ç»“åˆä¸šåŠ¡æŒ‡æ ‡ï¼Œç›‘æ§è¦ä¸ºä¸šåŠ¡æœåŠ¡

è¯¯åŒº4: å¿½è§†ç›‘æ§ç³»ç»Ÿæœ¬èº«çš„å¯é æ€§
æ­£è§£: ç›‘æ§ç³»ç»Ÿä¹Ÿéœ€è¦ç›‘æ§ï¼Œç¡®ä¿å…¶ç¨³å®šè¿è¡Œ
```

**âœ… é—®é¢˜æ’æŸ¥æ€è·¯**
```
ç›‘æ§å‘Šè­¦åçš„æ ‡å‡†å¤„ç†æµç¨‹:
1. ç¡®è®¤å‘Šè­¦: éªŒè¯å‘Šè­¦æ˜¯å¦çœŸå®æœ‰æ•ˆ
2. å½±å“è¯„ä¼°: è¯„ä¼°é—®é¢˜å¯¹ä¸šåŠ¡çš„å½±å“ç¨‹åº¦
3. å¿«é€Ÿæ­¢æŸ: ä¼˜å…ˆæ¢å¤æœåŠ¡ï¼Œåç»­å†åˆ†æåŸå› 
4. æ ¹å› åˆ†æ: æ·±å…¥åˆ†æé—®é¢˜çš„æ ¹æœ¬åŸå› 
5. é¢„é˜²æ”¹è¿›: æ”¹è¿›ç›‘æ§å’Œæµç¨‹ï¼Œé¿å…é‡å¤å‘ç”Ÿ
```

### 9.5 å­¦ä¹ è¿›é˜¶å»ºè®®


**ğŸ“š æ·±å…¥å­¦ä¹ æ–¹å‘**
```
æŠ€æœ¯æ·±å…¥:
- å­¦ä¹ æ›´å¤šLinuxæ—¥å¿—åˆ†æå·¥å…·
- æŒæ¡æ­£åˆ™è¡¨è¾¾å¼å’Œæ–‡æœ¬å¤„ç†æŠ€å·§
- äº†è§£ç›‘æ§å¹³å°çš„æ¶æ„è®¾è®¡

ä¸šåŠ¡ç»“åˆ:
- ç†è§£ä¸šåŠ¡æµç¨‹å’Œå…³é”®æŒ‡æ ‡
- å­¦ä¹ å¦‚ä½•ä»æŠ€æœ¯æŒ‡æ ‡æ¨å¯¼ä¸šåŠ¡å½±å“
- æŒæ¡å®¹é‡è§„åˆ’å’Œæ€§èƒ½ä¼˜åŒ–æ–¹æ³•

å·¥å…·è¿›é˜¶:
- å­¦ä¹ Prometheusã€Grafanaç­‰ç°ä»£ç›‘æ§å·¥å…·
- äº†è§£ELK Stackçš„éƒ¨ç½²å’Œä½¿ç”¨
- æŒæ¡äº‘å¹³å°çš„ç›‘æ§æœåŠ¡
```

**ğŸ¯ å®è·µé¡¹ç›®å»ºè®®**
```
å…¥é—¨é¡¹ç›®:
- ä¸ºä¸ªäººç½‘ç«™å»ºç«‹ç›‘æ§ç³»ç»Ÿ
- ç¼–å†™ç®€å•çš„æ—¥å¿—åˆ†æè„šæœ¬
- é…ç½®é‚®ä»¶å‘Šè­¦é€šçŸ¥

è¿›é˜¶é¡¹ç›®:
- æ­å»ºå®Œæ•´çš„ç›‘æ§å¹³å°
- å®ç°å¤šç»´åº¦çš„ç›‘æ§æŠ¥è¡¨
- è®¾è®¡æ™ºèƒ½å‘Šè­¦ç­–ç•¥

é«˜çº§é¡¹ç›®:
- å»ºç«‹åˆ†å¸ƒå¼ç›‘æ§ç³»ç»Ÿ
- å®ç°è‡ªåŠ¨åŒ–çš„å¼‚å¸¸æ£€æµ‹
- è®¾è®¡ç›‘æ§å³ä»£ç çš„DevOpsæµç¨‹
```

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- æ—¥å¿—ç›‘æ§æ˜¯ç³»ç»Ÿè¿ç»´çš„çœ¼ç›ï¼Œè¦çœ‹å¾—æ¸…ã€çœ‹å¾—å‡†ã€çœ‹å¾—åŠæ—¶
- ä»tailåŸºç¡€å‘½ä»¤åˆ°æ™ºèƒ½åˆ†æå¹³å°ï¼Œé€‰æ‹©åˆé€‚çš„å·¥å…·è§£å†³å®é™…é—®é¢˜  
- å‘Šè­¦ä¸æ˜¯ç›®çš„ï¼Œå¿«é€Ÿå‘ç°å’Œè§£å†³é—®é¢˜æ‰æ˜¯ä»·å€¼æ‰€åœ¨
- ç›‘æ§ç³»ç»Ÿæœ¬èº«ä¹Ÿéœ€è¦ç›‘æ§ï¼Œå¯é æ€§æ˜¯ç¬¬ä¸€è¦åŠ¡
- æŠ€æœ¯æ‰‹æ®µè¦ä¸ºä¸šåŠ¡ç›®æ ‡æœåŠ¡ï¼Œä¸èƒ½ä¸ºäº†ç›‘æ§è€Œç›‘æ§