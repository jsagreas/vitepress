---
title: 24ã€Shellè„šæœ¬æ‰§è¡Œé£é™©
---
## ğŸ“š ç›®å½•

1. [è„šæœ¬æ‰§è¡Œé£é™©æ¦‚è¿°](#1-è„šæœ¬æ‰§è¡Œé£é™©æ¦‚è¿°)
2. [è„šæœ¬æƒé™è¿‡åº¦æˆæƒ](#2-è„šæœ¬æƒé™è¿‡åº¦æˆæƒ)
3. [è„šæœ¬ä¸­ç¡¬ç¼–ç é£é™©](#3-è„šæœ¬ä¸­ç¡¬ç¼–ç é£é™©)
4. [å˜é‡æœªå®šä¹‰å¯¼è‡´çš„è¯¯æ“ä½œ](#4-å˜é‡æœªå®šä¹‰å¯¼è‡´çš„è¯¯æ“ä½œ)
5. [è„šæœ¬é€»è¾‘é”™è¯¯é£é™©](#5-è„šæœ¬é€»è¾‘é”™è¯¯é£é™©)
6. [æ‰¹é‡æ“ä½œè„šæœ¬é£é™©](#6-æ‰¹é‡æ“ä½œè„šæœ¬é£é™©)
7. [è„šæœ¬æ‰§è¡Œç¯å¢ƒéªŒè¯](#7-è„šæœ¬æ‰§è¡Œç¯å¢ƒéªŒè¯)
8. [è„šæœ¬å®‰å…¨ç¼–ç¨‹è§„èŒƒ](#8-è„šæœ¬å®‰å…¨ç¼–ç¨‹è§„èŒƒ)
9. [è„šæœ¬æµ‹è¯•ä¸éªŒè¯](#9-è„šæœ¬æµ‹è¯•ä¸éªŒè¯)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸš¨ è„šæœ¬æ‰§è¡Œé£é™©æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯Shellè„šæœ¬é£é™©


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µ**
Shellè„šæœ¬é£é™©æ˜¯æŒ‡åœ¨ç¼–å†™ã€éƒ¨ç½²å’Œæ‰§è¡Œè‡ªåŠ¨åŒ–è„šæœ¬æ—¶ï¼Œç”±äºè®¾è®¡ç¼ºé™·ã€ç¼–ç¨‹é”™è¯¯æˆ–æƒé™é…ç½®ä¸å½“å¯¼è‡´çš„ç³»ç»Ÿå®‰å…¨é—®é¢˜å’Œæ•°æ®ç ´åé£é™©ã€‚

**ğŸ’¡ é£é™©çš„æœ¬è´¨**
```
äººå·¥æ“ä½œ vs è„šæœ¬æ“ä½œçš„åŒºåˆ«ï¼š
äººå·¥æ“ä½œï¼šä¸€æ­¥ä¸€æ­¥ï¼Œå¯ä»¥éšæ—¶åœæ­¢å’Œä¿®æ­£
è„šæœ¬æ“ä½œï¼šæ‰¹é‡æ‰§è¡Œï¼Œé”™è¯¯ä¼šè¢«å¿«é€Ÿæ”¾å¤§
```

**ğŸ“Š é£é™©å½±å“èŒƒå›´**

| é£é™©ç±»å‹ | **å½±å“èŒƒå›´** | **ç ´åç¨‹åº¦** | **æ¢å¤éš¾åº¦** |
|----------|-------------|-------------|-------------|
| ğŸ” **æƒé™æ»¥ç”¨** | `æ•´ä¸ªç³»ç»Ÿ` | `é«˜` | `å›°éš¾` |
| ğŸ“ **æ•°æ®æ³„éœ²** | `æ•æ„Ÿä¿¡æ¯` | `é«˜` | `å‡ ä¹ä¸å¯èƒ½` |
| ğŸ—‚ï¸ **æ–‡ä»¶æŸå** | `ä¸šåŠ¡æ•°æ®` | `ä¸­-é«˜` | `ä¸­ç­‰` |
| âš™ï¸ **ç³»ç»Ÿç ´å** | `æ“ä½œç³»ç»Ÿ` | `é«˜` | `å›°éš¾` |

### 1.2 è„šæœ¬é£é™©çš„å¸¸è§åœºæ™¯


**ğŸ¯ å…¸å‹å±é™©åœºæ™¯**
```
åœºæ™¯1ï¼šè‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬
é£é™©ï¼šè¯¯åˆ ç”Ÿäº§ç¯å¢ƒæ–‡ä»¶
åæœï¼šä¸šåŠ¡ä¸­æ–­ï¼Œæ•°æ®ä¸¢å¤±

åœºæ™¯2ï¼šæ‰¹é‡ç”¨æˆ·ç®¡ç†è„šæœ¬  
é£é™©ï¼šæƒé™è®¾ç½®é”™è¯¯
åæœï¼šå®‰å…¨æ¼æ´ï¼Œæƒé™æ³„éœ²

åœºæ™¯3ï¼šå®šæ—¶æ¸…ç†è„šæœ¬
é£é™©ï¼šæ¸…ç†èŒƒå›´è¿‡å¤§
åæœï¼šé‡è¦æ–‡ä»¶è¢«åˆ é™¤

åœºæ™¯4ï¼šæ•°æ®å¤„ç†è„šæœ¬
é£é™©ï¼šé€»è¾‘é”™è¯¯å¯¼è‡´æ•°æ®æŸå
åæœï¼šæ•°æ®å®Œæ•´æ€§ç ´å
```

---

## 2. ğŸ” è„šæœ¬æƒé™è¿‡åº¦æˆæƒ


### 2.1 æƒé™è¿‡åº¦æˆæƒçš„å±å®³


**âš ï¸ ä»€ä¹ˆæ˜¯æƒé™è¿‡åº¦æˆæƒ**
ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ç»™è„šæœ¬åˆ†é…äº†è¶…è¿‡å®é™…éœ€è¦çš„ç³»ç»Ÿæƒé™ï¼Œå°±åƒç»™ä¿å®‰é…äº†å…¬å¸æ‰€æœ‰æˆ¿é—´çš„é’¥åŒ™ä¸€æ ·å±é™©ã€‚

**ğŸš¨ å…¸å‹çš„è¿‡åº¦æˆæƒåœºæ™¯**
```bash
# å±é™©ç¤ºä¾‹ï¼šç»™è„šæœ¬sudoæ— å¯†ç æƒé™
# /etc/sudoersæ–‡ä»¶ä¸­ï¼š
script_user ALL=(ALL) NOPASSWD: ALL

# é—®é¢˜ï¼šè„šæœ¬å¯ä»¥æ‰§è¡Œä»»ä½•rootå‘½ä»¤
# é£é™©ï¼šä¸€æ—¦è„šæœ¬è¢«æ¶æ„åˆ©ç”¨ï¼Œæ•´ä¸ªç³»ç»Ÿæ²¦é™·
```

### 2.2 æƒé™æœ€å°åŒ–åŸåˆ™


**ğŸ¯ æƒé™åˆ†çº§ç­–ç•¥**

```
æƒé™ç­‰çº§é‡‘å­—å¡”ï¼š
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Rootæƒé™   â”‚ â† æœ€é«˜é£é™©
        â”‚ (sudo ALL)  â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ ç‰¹å®šå‘½ä»¤æƒé™ â”‚ â† ä¸­ç­‰é£é™©
        â”‚(sudo æŒ‡å®š)  â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚  æ™®é€šç”¨æˆ·   â”‚ â† ç›¸å¯¹å®‰å…¨
        â”‚   æƒé™     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**âœ… å®‰å…¨çš„æƒé™é…ç½®**
```bash
# æ­£ç¡®åšæ³•ï¼šåªæˆäºˆå¿…è¦çš„ç‰¹å®šæƒé™
# ä¾‹ï¼šåªå…è®¸é‡å¯ç‰¹å®šæœåŠ¡
script_user ALL=(ALL) NOPASSWD: /bin/systemctl restart nginx
script_user ALL=(ALL) NOPASSWD: /bin/systemctl reload nginx

# ä¸è¦ç»™æ•´ä¸ªsystemctlçš„æƒé™
# é”™è¯¯ï¼šscript_user ALL=(ALL) NOPASSWD: /bin/systemctl
```

### 2.3 æƒé™éªŒè¯æœºåˆ¶


**ğŸ” æƒé™æ£€æŸ¥çš„æ–¹æ³•**
```bash
# è„šæœ¬å¼€å¤´è¿›è¡Œæƒé™éªŒè¯
check_permissions() {
    # æ£€æŸ¥å½“å‰ç”¨æˆ·æƒé™
    if [ "$EUID" -eq 0 ]; then
        echo "âš ï¸  è­¦å‘Šï¼šä»¥rootæƒé™è¿è¡Œï¼Œé£é™©æé«˜ï¼"
        read -p "ç¡®å®šç»§ç»­ï¼Ÿ(y/N): " confirm
        [[ "$confirm" != "y" ]] && exit 1
    fi
    
    # æ£€æŸ¥å¿…è¦çš„æƒé™
    if ! sudo -l | grep -q "systemctl restart nginx"; then
        echo "âŒ ç¼ºå°‘å¿…è¦æƒé™"
        exit 1
    fi
}
```

---

## 3. ğŸ”‘ è„šæœ¬ä¸­ç¡¬ç¼–ç é£é™©


### 3.1 ç¡¬ç¼–ç çš„å±å®³æ€§


**ğŸ”¸ ä»€ä¹ˆæ˜¯ç¡¬ç¼–ç **
ç¡¬ç¼–ç å°±æ˜¯æŠŠå¯†ç ã€å¯†é’¥ã€æ•°æ®åº“è¿æ¥ç­‰æ•æ„Ÿä¿¡æ¯ç›´æ¥å†™æ­»åœ¨è„šæœ¬ä»£ç é‡Œï¼Œå°±åƒæŠŠå®¶é—¨é’¥åŒ™è´´åœ¨é—¨ä¸Šä¸€æ ·ä¸å®‰å…¨ã€‚

**ğŸ’€ å…¸å‹çš„ç¡¬ç¼–ç é£é™©**

| ç¡¬ç¼–ç ç±»å‹ | **é£é™©ç¨‹åº¦** | **å¸¸è§åæœ** |
|------------|-------------|-------------|
| ğŸ” **æ•°æ®åº“å¯†ç ** | `æé«˜` | `æ•°æ®æ³„éœ²ã€ç³»ç»Ÿå…¥ä¾µ` |
| ğŸ”‘ **APIå¯†é’¥** | `é«˜` | `æœåŠ¡æ»¥ç”¨ã€è´¹ç”¨æŸå¤±` |
| ğŸ“‚ **æ–‡ä»¶è·¯å¾„** | `ä¸­` | `è„šæœ¬å¤±æ•ˆã€è¯¯æ“ä½œ` |
| ğŸŒ **æœåŠ¡å™¨IP** | `ä¸­` | `ç»´æŠ¤å›°éš¾ã€å®‰å…¨éšæ‚£` |

### 3.2 ç¡¬ç¼–ç çš„è¯†åˆ«ä¸å±å®³


**âŒ å±é™©çš„ç¡¬ç¼–ç ç¤ºä¾‹**
```bash
# æåº¦å±é™©ï¼šå¯†ç ç¡¬ç¼–ç 
mysql -u root -p123456 -e "DROP DATABASE old_data"

# å±é™©ï¼šAPIå¯†é’¥ç¡¬ç¼–ç   
curl -H "Authorization: Bearer sk-1234567890abcdef" \
     https://api.example.com/delete-all

# é£é™©ï¼šè·¯å¾„ç¡¬ç¼–ç 
rm -rf /home/user/important-data/*
```

**âš ï¸ ç¡¬ç¼–ç å¸¦æ¥çš„é—®é¢˜**
```
å®‰å…¨é—®é¢˜ï¼š
â€¢ ä»£ç å®¡è®¡æ—¶æš´éœ²æ•æ„Ÿä¿¡æ¯
â€¢ ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸­ç•™ä¸‹æ°¸ä¹…è®°å½•
â€¢ å…¶ä»–äººå¯ä»¥è½»æ˜“è·å–è®¤è¯ä¿¡æ¯

ç»´æŠ¤é—®é¢˜ï¼š  
â€¢ å¯†ç å˜æ›´éœ€è¦ä¿®æ”¹å¤šä¸ªè„šæœ¬
â€¢ ä¸åŒç¯å¢ƒéœ€è¦ä¸åŒçš„é…ç½®
â€¢ ä»£ç å¯ç§»æ¤æ€§å·®
```

### 3.3 å®‰å…¨çš„é…ç½®ç®¡ç†


**âœ… é…ç½®å¤–éƒ¨åŒ–çš„æ–¹æ³•**

**æ–¹æ³•1ï¼šç¯å¢ƒå˜é‡**
```bash
# è„šæœ¬ä¸­è¯»å–ç¯å¢ƒå˜é‡
DB_PASSWORD="${DB_PASSWORD:-}"
if [ -z "$DB_PASSWORD" ]; then
    echo "âŒ ç¯å¢ƒå˜é‡ DB_PASSWORD æœªè®¾ç½®"
    exit 1
fi

mysql -u root -p"$DB_PASSWORD" -e "SELECT 1"
```

**æ–¹æ³•2ï¼šé…ç½®æ–‡ä»¶**
```bash
# åˆ›å»ºå—ä¿æŠ¤çš„é…ç½®æ–‡ä»¶ ~/.script-config
chmod 600 ~/.script-config

# é…ç½®æ–‡ä»¶å†…å®¹
DB_HOST=localhost
DB_USER=app_user  
DB_NAME=production

# è„šæœ¬ä¸­åŠ è½½é…ç½®
source ~/.script-config
```

**æ–¹æ³•3ï¼šå¯†é’¥ç®¡ç†ç³»ç»Ÿ**
```bash
# ä½¿ç”¨ç³»ç»Ÿå¯†é’¥ç¯
SECRET=$(secret-tool lookup service database user app)
mysql -u app_user -p"$SECRET" database
```

---

## 4. ğŸ“ å˜é‡æœªå®šä¹‰å¯¼è‡´çš„è¯¯æ“ä½œ


### 4.1 æœªå®šä¹‰å˜é‡çš„å±å®³


**ğŸ”¸ é—®é¢˜çš„æœ¬è´¨**
å½“Shellè„šæœ¬ä¸­çš„å˜é‡æ²¡æœ‰æ­£ç¡®å®šä¹‰æ—¶ï¼ŒShellä¼šå°†å…¶è§†ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œè¿™å¯èƒ½å¯¼è‡´å‘½ä»¤æ‰§è¡Œå‡ºç°æ„æƒ³ä¸åˆ°çš„ç»“æœã€‚

**ğŸ’¥ ç»å…¸çš„ç¾éš¾åœºæ™¯**
```bash
# å±é™©ç¤ºä¾‹ï¼šå˜é‡æœªå®šä¹‰å¯¼è‡´è¯¯åˆ æ ¹ç›®å½•
TARGET_DIR=""  # å˜é‡æœªæ­£ç¡®èµ‹å€¼
rm -rf $TARGET_DIR/*

# å®é™…æ‰§è¡Œçš„å‘½ä»¤å˜æˆï¼š
# rm -rf /*  â† åˆ é™¤æ•´ä¸ªæ ¹ç›®å½•ï¼
```

### 4.2 å˜é‡æœªå®šä¹‰çš„å¸¸è§æƒ…å†µ


**ğŸ¯ é«˜é£é™©åœºæ™¯åˆ†æ**

```bash
# åœºæ™¯1ï¼šä»å‘½ä»¤è¡Œå‚æ•°è·å–å˜é‡
TARGET_PATH=$1  # å¦‚æœç”¨æˆ·å¿˜è®°ä¼ å‚æ•°ï¼Œå˜é‡ä¸ºç©º
rm -rf $TARGET_PATH/*  # å±é™©ï¼

# åœºæ™¯2ï¼šä»é…ç½®æ–‡ä»¶è¯»å–å˜é‡
BACKUP_DIR=$(grep backup_dir config.txt | cut -d= -f2)
# å¦‚æœé…ç½®æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ ¼å¼é”™è¯¯ï¼Œå˜é‡ä¸ºç©º
rm -rf $BACKUP_DIR/*  # å±é™©ï¼

# åœºæ™¯3ï¼šä»å‘½ä»¤è¾“å‡ºè·å–å˜é‡
LOG_DIR=$(find /var/log -name "app*" | head -1)
# å¦‚æœfindæ²¡æ‰¾åˆ°ï¼Œå˜é‡ä¸ºç©º
chmod 777 $LOG_DIR  # å¯èƒ½è¯¯æ“ä½œå…¶ä»–ç›®å½•
```

### 4.3 å˜é‡å®‰å…¨éªŒè¯


**ğŸ”’ é˜²æŠ¤æ€§ç¼–ç¨‹æŠ€å·§**

**æŠ€å·§1ï¼šä½¿ç”¨setå‘½ä»¤å¢å¼ºé”™è¯¯æ£€æµ‹**
```bash
#!/bin/bash
# å¼€å¯ä¸¥æ ¼æ¨¡å¼
set -euo pipefail
# -e: é‡åˆ°é”™è¯¯ç«‹å³é€€å‡º
# -u: ä½¿ç”¨æœªå®šä¹‰å˜é‡æ—¶æŠ¥é”™é€€å‡º  
# -o pipefail: ç®¡é“ä¸­ä»»ä½•å‘½ä»¤å¤±è´¥éƒ½æŠ¥é”™
```

**æŠ€å·§2ï¼šå˜é‡æœ‰æ•ˆæ€§æ£€æŸ¥**
```bash
# æ£€æŸ¥å¿…è¦å˜é‡æ˜¯å¦å®šä¹‰
check_required_vars() {
    local vars=("$@")
    for var in "${vars[@]}"; do
        if [ -z "${!var:-}" ]; then
            echo "âŒ å¿…è¦å˜é‡ $var æœªå®šä¹‰"
            exit 1
        fi
    done
}

# ä½¿ç”¨ç¤ºä¾‹
TARGET_DIR="$1"
BACKUP_DIR="$2"
check_required_vars TARGET_DIR BACKUP_DIR
```

**æŠ€å·§3ï¼šæä¾›é»˜è®¤å€¼å’Œè¾¹ç•Œæ£€æŸ¥**
```bash
# æä¾›å®‰å…¨çš„é»˜è®¤å€¼
LOG_LEVEL="${LOG_LEVEL:-INFO}"
MAX_FILES="${MAX_FILES:-100}"

# è·¯å¾„æœ‰æ•ˆæ€§æ£€æŸ¥
validate_path() {
    local path="$1"
    # æ£€æŸ¥è·¯å¾„ä¸ä¸ºç©º
    [ -n "$path" ] || { echo "è·¯å¾„ä¸ºç©º"; return 1; }
    # æ£€æŸ¥è·¯å¾„å­˜åœ¨
    [ -e "$path" ] || { echo "è·¯å¾„ä¸å­˜åœ¨: $path"; return 1; }
    # æ£€æŸ¥è·¯å¾„å®‰å…¨æ€§ï¼ˆä¸åœ¨ç³»ç»Ÿå…³é”®ç›®å½•ï¼‰
    case "$path" in
        /|/bin|/boot|/etc|/lib|/proc|/sys|/usr)
            echo "âš ï¸  å±é™©è·¯å¾„: $path"
            return 1
            ;;
    esac
}
```

---

## 5. âš™ï¸ è„šæœ¬é€»è¾‘é”™è¯¯é£é™©


### 5.1 é€»è¾‘é”™è¯¯çš„ç±»å‹


**ğŸ”¸ ä»€ä¹ˆæ˜¯è„šæœ¬é€»è¾‘é”™è¯¯**
è„šæœ¬é€»è¾‘é”™è¯¯æ˜¯æŒ‡ç¨‹åºè¯­æ³•æ­£ç¡®ï¼Œå¯ä»¥è¿è¡Œï¼Œä½†æ‰§è¡Œç»“æœä¸ç¬¦åˆé¢„æœŸçš„æƒ…å†µã€‚è¿™ç§é”™è¯¯å¾€å¾€æ›´å±é™©ï¼Œå› ä¸ºä¸ä¼šç«‹å³æš´éœ²ã€‚

**ğŸ“Š å¸¸è§é€»è¾‘é”™è¯¯åˆ†ç±»**

```
é€»è¾‘é”™è¯¯é‡‘å­—å¡”ï¼š
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ æ¡ä»¶åˆ¤æ–­é”™è¯¯ â”‚ â† æœ€å¸¸è§
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ å¾ªç¯é€»è¾‘é”™è¯¯ â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ æ–‡ä»¶æ“ä½œé”™è¯¯ â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ æ•°æ®å¤„ç†é”™è¯¯ â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 æ¡ä»¶åˆ¤æ–­é”™è¯¯


**âŒ å±é™©çš„æ¡ä»¶åˆ¤æ–­**
```bash
# é”™è¯¯1ï¼šå­—ç¬¦ä¸²æ¯”è¾ƒé”™è¯¯
if [ $USER = "admin" ]; then  # æ²¡æœ‰å¼•å·ï¼Œå˜é‡ä¸ºç©ºæ—¶å‡ºé”™
    rm -rf /important-data/*
fi

# é”™è¯¯2ï¼šæ•°å€¼æ¯”è¾ƒæ··æ·†
if [ "$file_size" > "1000" ]; then  # å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œä¸æ˜¯æ•°å€¼æ¯”è¾ƒ
    echo "å¤§æ–‡ä»¶"
fi

# é”™è¯¯3ï¼šæ–‡ä»¶å­˜åœ¨æ€§åˆ¤æ–­é”™è¯¯
if [ -f $config_file ]; then  # å˜é‡æœªåŠ å¼•å·
    source $config_file
fi
```

**âœ… æ­£ç¡®çš„æ¡ä»¶åˆ¤æ–­**
```bash
# æ­£ç¡®1ï¼šåŠ å¼•å·ä¿æŠ¤å˜é‡
if [ "$USER" = "admin" ]; then
    echo "ç®¡ç†å‘˜ç”¨æˆ·"
fi

# æ­£ç¡®2ï¼šä½¿ç”¨æ•°å€¼æ¯”è¾ƒ
if [ "$file_size" -gt 1000 ]; then
    echo "å¤§æ–‡ä»¶"
fi

# æ­£ç¡®3ï¼šå®‰å…¨çš„æ–‡ä»¶æ£€æŸ¥
if [ -n "$config_file" ] && [ -f "$config_file" ]; then
    source "$config_file"
fi
```

### 5.3 å¾ªç¯é€»è¾‘é”™è¯¯


**ğŸ”„ å¾ªç¯é£é™©åœºæ™¯**
```bash
# å±é™©ï¼šæ— é™å¾ªç¯
while true; do
    process_files
    # å¿˜è®°è®¾ç½®é€€å‡ºæ¡ä»¶
done

# å±é™©ï¼šå¾ªç¯èŒƒå›´é”™è¯¯
for file in *.log; do
    # å¦‚æœæ²¡æœ‰.logæ–‡ä»¶ï¼Œfileçš„å€¼æ˜¯"*.log"å­—ç¬¦ä¸²
    rm "$file"  # å¯èƒ½è¯¯åˆ å…¶ä»–æ–‡ä»¶
done
```

**âœ… å®‰å…¨çš„å¾ªç¯è®¾è®¡**
```bash
# è®¾ç½®å¾ªç¯è®¡æ•°å™¨é˜²æ­¢æ— é™å¾ªç¯
counter=0
max_attempts=100

while [ $counter -lt $max_attempts ]; do
    if process_files; then
        break
    fi
    counter=$((counter + 1))
    sleep 1
done

# å®‰å…¨çš„æ–‡ä»¶å¾ªç¯
shopt -s nullglob  # æ²¡æœ‰åŒ¹é…æ–‡ä»¶æ—¶è¿”å›ç©ºæ•°ç»„
for file in *.log; do
    [ -f "$file" ] || continue  # ç¡®ä¿æ˜¯æ–‡ä»¶
    rm "$file"
done
```

---

## 6. ğŸ“¦ æ‰¹é‡æ“ä½œè„šæœ¬é£é™©


### 6.1 æ‰¹é‡æ“ä½œçš„æ”¾å¤§æ•ˆåº”


**ğŸ”¸ æ‰¹é‡æ“ä½œçš„ç‰¹ç‚¹**
æ‰¹é‡æ“ä½œå°±åƒå¼€è‡ªåŠ¨æŒ¡è½¦ï¼Œä¸€æ—¦æ–¹å‘é”™äº†ï¼Œä¼šè¿…é€Ÿåç¦»æ­£è½¨ã€‚å•ä¸ªé”™è¯¯ä¼šè¢«æˆç™¾ä¸Šåƒå€åœ°æ”¾å¤§ã€‚

**ğŸ“ˆ é”™è¯¯æ”¾å¤§ç¤ºä¾‹**
```
å•ä¸ªæ“ä½œå½±å“ï¼š1ä¸ªæ–‡ä»¶ â†’ åˆ é™¤é”™è¯¯ â†’ æŸå¤±1ä¸ªæ–‡ä»¶
æ‰¹é‡æ“ä½œå½±å“ï¼š1000ä¸ªæ–‡ä»¶ â†’ åˆ é™¤é”™è¯¯ â†’ æŸå¤±1000ä¸ªæ–‡ä»¶

æ—¶é—´å¯¹æ¯”ï¼š
æ‰‹åŠ¨æ“ä½œï¼šå‘ç°é”™è¯¯å¯ç«‹å³åœæ­¢
æ‰¹é‡è„šæœ¬ï¼šé”™è¯¯æ‰§è¡Œå®Œæ¯•æ‰èƒ½å‘ç°
```

### 6.2 æ‰¹é‡åˆ é™¤çš„é™·é˜±


**ğŸ’€ ç»å…¸çš„æ‰¹é‡åˆ é™¤ç¾éš¾**
```bash
# åœºæ™¯ï¼šæ¸…ç†ä¸´æ—¶æ–‡ä»¶
TEMP_DIR="/tmp/app_temp"

# å±é™©è„šæœ¬
for dir in $TEMP_DIR/*; do
    rm -rf "$dir"  # å¦‚æœTEMP_DIRä¸ºç©ºï¼Œåˆ é™¤/*æ‰€æœ‰æ–‡ä»¶
done

# æ›´å±é™©çš„ç‰ˆæœ¬
find $TEMP_DIR -type f -delete  # å˜é‡ä¸ºç©ºæ—¶åˆ é™¤æ ¹ç›®å½•æ–‡ä»¶
```

**ğŸ›¡ï¸ å®‰å…¨çš„æ‰¹é‡åˆ é™¤è®¾è®¡**
```bash
# å®‰å…¨ç‰ˆæœ¬1ï¼šå¤šé‡æ£€æŸ¥
safe_batch_delete() {
    local target_dir="$1"
    
    # æ£€æŸ¥1ï¼šç›®å½•ä¸ä¸ºç©º
    [ -n "$target_dir" ] || { echo "ç›®å½•å‚æ•°ä¸ºç©º"; return 1; }
    
    # æ£€æŸ¥2ï¼šç›®å½•å­˜åœ¨
    [ -d "$target_dir" ] || { echo "ç›®å½•ä¸å­˜åœ¨"; return 1; }
    
    # æ£€æŸ¥3ï¼šä¸æ˜¯ç³»ç»Ÿå…³é”®ç›®å½•
    case "$target_dir" in
        /|/bin|/boot|/etc|/home|/lib|/proc|/root|/sys|/usr|/var)
            echo "âš ï¸  æ‹’ç»æ“ä½œç³»ç»Ÿå…³é”®ç›®å½•"
            return 1
            ;;
    esac
    
    # æ£€æŸ¥4ï¼šç¡®è®¤æ“ä½œ
    echo "å°†è¦åˆ é™¤ç›®å½•: $target_dir"
    echo "åŒ…å«æ–‡ä»¶æ•°é‡: $(find "$target_dir" -type f | wc -l)"
    read -p "ç¡®è®¤åˆ é™¤ï¼Ÿ(yes/no): " confirm
    [ "$confirm" = "yes" ] || return 1
    
    # æ‰§è¡Œåˆ é™¤
    rm -rf "$target_dir"/*
}
```

### 6.3 æ‰¹é‡ç”¨æˆ·ç®¡ç†é£é™©


**ğŸ‘¥ ç”¨æˆ·ç®¡ç†è„šæœ¬çš„é£é™©**
```bash
# å±é™©ï¼šæ‰¹é‡åˆ é™¤ç”¨æˆ·
users_to_delete="user1 user2 user3"
for user in $users_to_delete; do
    userdel -r "$user"  # åˆ é™¤ç”¨æˆ·å’Œhomeç›®å½•
done

# é£é™©ï¼š
# 1. å¯èƒ½åˆ é™¤æ­£åœ¨ä½¿ç”¨çš„ç”¨æˆ·
# 2. å¯èƒ½åˆ é™¤ç³»ç»Ÿç”¨æˆ·
# 3. æ•°æ®æ— æ³•æ¢å¤
```

**âœ… å®‰å…¨çš„ç”¨æˆ·ç®¡ç†**
```bash
batch_user_management() {
    local action="$1"
    shift
    local users=("$@")
    
    # é¢„æ£€æŸ¥é˜¶æ®µ
    echo "ğŸ” é¢„æ£€æŸ¥é˜¶æ®µ..."
    for user in "${users[@]}"; do
        # æ£€æŸ¥ç”¨æˆ·å­˜åœ¨æ€§
        if ! id "$user" >/dev/null 2>&1; then
            echo "âŒ ç”¨æˆ· $user ä¸å­˜åœ¨"
            return 1
        fi
        
        # æ£€æŸ¥æ˜¯å¦ä¸ºç³»ç»Ÿç”¨æˆ·
        local uid=$(id -u "$user")
        if [ "$uid" -lt 1000 ]; then
            echo "âš ï¸  $user æ˜¯ç³»ç»Ÿç”¨æˆ· (UID: $uid)"
            read -p "ä»è¦ç»§ç»­ï¼Ÿ(y/N): " confirm
            [[ "$confirm" != "y" ]] && return 1
        fi
        
        # æ£€æŸ¥ç”¨æˆ·æ˜¯å¦åœ¨çº¿
        if who | grep -q "^$user "; then
            echo "âš ï¸  ç”¨æˆ· $user å½“å‰åœ¨çº¿"
        fi
    done
    
    # æ‰§è¡Œé˜¶æ®µ
    echo "âœ… é¢„æ£€æŸ¥é€šè¿‡ï¼Œå¼€å§‹æ‰§è¡Œ..."
    for user in "${users[@]}"; do
        echo "å¤„ç†ç”¨æˆ·: $user"
        case "$action" in
            "lock")
                usermod -L "$user"
                ;;
            "delete")  
                read -p "ç¡®è®¤åˆ é™¤ç”¨æˆ· $userï¼Ÿ(yes/no): " confirm
                [ "$confirm" = "yes" ] && userdel -r "$user"
                ;;
        esac
    done
}
```

---

## 7. ğŸ” è„šæœ¬æ‰§è¡Œç¯å¢ƒéªŒè¯


### 7.1 ç¯å¢ƒéªŒè¯çš„é‡è¦æ€§


**ğŸ”¸ ä¸ºä»€ä¹ˆè¦éªŒè¯æ‰§è¡Œç¯å¢ƒ**
è„šæœ¬å°±åƒç§å­ï¼Œåœ¨ä¸åŒçš„åœŸå£¤(ç¯å¢ƒ)ä¸­ä¼šæœ‰ä¸åŒçš„ç”Ÿé•¿ç»“æœã€‚åŒæ ·çš„è„šæœ¬åœ¨ä¸åŒç¯å¢ƒä¸­å¯èƒ½äº§ç”Ÿå®Œå…¨ä¸åŒçš„å½±å“ã€‚

**ğŸ¯ éœ€è¦éªŒè¯çš„ç¯å¢ƒè¦ç´ **

```
ç¯å¢ƒéªŒè¯æ¸…å•ï¼š
â”œâ”€â”€ æ“ä½œç³»ç»Ÿç‰ˆæœ¬
â”œâ”€â”€ å¿…éœ€è½¯ä»¶ä¾èµ–
â”œâ”€â”€ ç½‘ç»œè¿æ¥çŠ¶æ€
â”œâ”€â”€ ç£ç›˜ç©ºé—´æƒ…å†µ
â”œâ”€â”€ æƒé™é…ç½®çŠ¶æ€
â”œâ”€â”€ ç³»ç»Ÿè´Ÿè½½æƒ…å†µ
â””â”€â”€ æ•°æ®å¤‡ä»½çŠ¶æ€
```

### 7.2 ç³»ç»Ÿç¯å¢ƒæ£€æŸ¥


**ğŸ”§ å…¨é¢çš„ç¯å¢ƒæ£€æŸ¥å‡½æ•°**
```bash
verify_environment() {
    echo "ğŸ” å¼€å§‹ç¯å¢ƒéªŒè¯..."
    
    # æ£€æŸ¥1ï¼šæ“ä½œç³»ç»Ÿ
    local os_info=$(uname -a)
    echo "ç³»ç»Ÿä¿¡æ¯: $os_info"
    
    # æ£€æŸ¥2ï¼šå¿…éœ€å‘½ä»¤å­˜åœ¨æ€§
    local required_commands=("mysql" "curl" "tar" "gzip")
    for cmd in "${required_commands[@]}"; do
        if ! command -v "$cmd" >/dev/null 2>&1; then
            echo "âŒ ç¼ºå°‘å¿…éœ€å‘½ä»¤: $cmd"
            return 1
        fi
    done
    
    # æ£€æŸ¥3ï¼šç£ç›˜ç©ºé—´
    local available_space=$(df /tmp | awk 'NR==2 {print $4}')
    local required_space=1048576  # 1GB in KB
    if [ "$available_space" -lt "$required_space" ]; then
        echo "âš ï¸  ç£ç›˜ç©ºé—´ä¸è¶³ (å¯ç”¨: ${available_space}KB, éœ€è¦: ${required_space}KB)"
        return 1
    fi
    
    # æ£€æŸ¥4ï¼šç½‘ç»œè¿é€šæ€§  
    if ! ping -c 1 8.8.8.8 >/dev/null 2>&1; then
        echo "âš ï¸  ç½‘ç»œè¿æ¥å¼‚å¸¸"
    fi
    
    # æ£€æŸ¥5ï¼šç³»ç»Ÿè´Ÿè½½
    local load_avg=$(uptime | awk -F'load average:' '{print $2}' | awk -F',' '{print $1}' | tr -d ' ')
    if (( $(echo "$load_avg > 5.0" | bc -l) )); then
        echo "âš ï¸  ç³»ç»Ÿè´Ÿè½½è¿‡é«˜: $load_avg"
        read -p "ç»§ç»­æ‰§è¡Œï¼Ÿ(y/N): " confirm
        [[ "$confirm" != "y" ]] && return 1
    fi
    
    echo "âœ… ç¯å¢ƒéªŒè¯é€šè¿‡"
}
```

### 7.3 æœåŠ¡çŠ¶æ€éªŒè¯


**âš™ï¸ å…³é”®æœåŠ¡æ£€æŸ¥**
```bash
check_services() {
    local services=("nginx" "mysql" "redis")
    
    echo "ğŸ”§ æ£€æŸ¥æœåŠ¡çŠ¶æ€..."
    for service in "${services[@]}"; do
        if systemctl is-active --quiet "$service"; then
            echo "âœ… $service: è¿è¡Œä¸­"
        else
            echo "âŒ $service: æœªè¿è¡Œ"
            # æ ¹æ®éœ€è¦å†³å®šæ˜¯å¦ç»§ç»­
            case "$service" in
                "mysql")
                    echo "ğŸ’¡ MySQLæœªè¿è¡Œï¼ŒæŸäº›åŠŸèƒ½å°†å—é™"
                    ;;
                "nginx")
                    echo "âš ï¸  Nginxæœªè¿è¡Œï¼ŒWebæœåŠ¡ä¸å¯ç”¨"
                    ;;
            esac
        fi
    done
}
```

---

## 8. ğŸ“‹ è„šæœ¬å®‰å…¨ç¼–ç¨‹è§„èŒƒ


### 8.1 å®‰å…¨ç¼–ç¨‹çš„åŸºæœ¬åŸåˆ™


**ğŸ”¸ å®‰å…¨ç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³**
"é˜²å¾¡æ€§ç¼–ç¨‹" - å‡è®¾ä¸€åˆ‡éƒ½å¯èƒ½å‡ºé”™ï¼Œä¸ºæ¯ç§å¯èƒ½çš„é”™è¯¯æƒ…å†µåšå¥½å‡†å¤‡ã€‚

**ğŸ¯ å®‰å…¨ç¼–ç¨‹é‡‘å­—å¡”**

```
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ æœ€é«˜ä¼˜å…ˆçº§   â”‚
        â”‚  æ•°æ®ä¿æŠ¤   â”‚ â† é˜²æ­¢æ•°æ®ä¸¢å¤±/æ³„éœ²  
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚   é”™è¯¯å¤„ç†   â”‚ â† ä¼˜é›…å¤„ç†å¼‚å¸¸
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  
        â”‚   è¾“å…¥éªŒè¯   â”‚ â† éªŒè¯æ‰€æœ‰è¾“å…¥
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚   æƒé™æ§åˆ¶   â”‚ â† æœ€å°æƒé™åŸåˆ™
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 è¾“å…¥éªŒè¯ä¸æ¸…ç†


**ğŸ”’ è¾“å…¥éªŒè¯çš„é‡è¦æ€§**
ç”¨æˆ·è¾“å…¥å°±åƒæ¥å†ä¸æ˜çš„åŒ…è£¹ï¼Œå¿…é¡»å…ˆæ£€æŸ¥åä½¿ç”¨ã€‚

**âœ… å®‰å…¨çš„è¾“å…¥å¤„ç†**
```bash
# éªŒè¯æ–‡ä»¶è·¯å¾„è¾“å…¥
validate_file_path() {
    local path="$1"
    
    # æ£€æŸ¥ç©ºå€¼
    [ -n "$path" ] || { echo "è·¯å¾„ä¸èƒ½ä¸ºç©º"; return 1; }
    
    # æ£€æŸ¥è·¯å¾„æ³¨å…¥
    case "$path" in
        *".."*|*";"*|*"|"*|*"&"*|*"$"*)
            echo "ğŸš¨ æ£€æµ‹åˆ°æ½œåœ¨çš„è·¯å¾„æ³¨å…¥æ”»å‡»"
            return 1
            ;;
    esac
    
    # æ£€æŸ¥è·¯å¾„é•¿åº¦  
    if [ ${#path} -gt 255 ]; then
        echo "è·¯å¾„é•¿åº¦è¶…è¿‡é™åˆ¶"
        return 1
    fi
    
    # æ ‡å‡†åŒ–è·¯å¾„
    path=$(realpath "$path" 2>/dev/null) || {
        echo "è·¯å¾„æ ¼å¼æ— æ•ˆ"
        return 1
    }
    
    echo "$path"
}

# éªŒè¯ç”¨æˆ·åè¾“å…¥
validate_username() {
    local username="$1"
    
    # æ£€æŸ¥æ ¼å¼ï¼ˆåªå…è®¸å­—æ¯æ•°å­—å’Œä¸‹åˆ’çº¿ï¼‰
    if [[ ! "$username" =~ ^[a-zA-Z0-9_]+$ ]]; then
        echo "ç”¨æˆ·åæ ¼å¼æ— æ•ˆ"
        return 1
    fi
    
    # æ£€æŸ¥é•¿åº¦
    if [ ${#username} -lt 3 ] || [ ${#username} -gt 32 ]; then
        echo "ç”¨æˆ·åé•¿åº¦å¿…é¡»åœ¨3-32å­—ç¬¦ä¹‹é—´"
        return 1
    fi
    
    echo "$username"
}
```

### 8.3 é”™è¯¯å¤„ç†ä¸æ—¥å¿—è®°å½•


**ğŸ“ å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶**
```bash
# è®¾ç½®é”™è¯¯å¤„ç†å‡½æ•°
error_handler() {
    local line_no=$1
    local error_code=$2
    echo "ğŸ’¥ è„šæœ¬åœ¨ç¬¬ $line_no è¡Œå‘ç”Ÿé”™è¯¯ (é€€å‡ºç : $error_code)" >&2
    echo "â° é”™è¯¯æ—¶é—´: $(date)" >&2
    echo "ğŸ“‚ å½“å‰ç›®å½•: $(pwd)" >&2
    echo "ğŸ‘¤ æ‰§è¡Œç”¨æˆ·: $(whoami)" >&2
    
    # æ¸…ç†ä¸´æ—¶èµ„æº
    cleanup_on_error
    
    exit $error_code
}

# æ³¨å†Œé”™è¯¯å¤„ç†å‡½æ•°
trap 'error_handler ${LINENO} $?' ERR

# æ¸…ç†å‡½æ•°
cleanup_on_error() {
    echo "ğŸ§¹ æ¸…ç†ä¸´æ—¶èµ„æº..."
    # åˆ é™¤ä¸´æ—¶æ–‡ä»¶
    [ -f "$temp_file" ] && rm -f "$temp_file"
    # é‡Šæ”¾é”æ–‡ä»¶
    [ -f "$lock_file" ] && rm -f "$lock_file"
}
```

### 8.4 å®‰å…¨çš„ä¸´æ—¶æ–‡ä»¶å¤„ç†


**ğŸ“ ä¸´æ—¶æ–‡ä»¶å®‰å…¨åˆ›å»º**
```bash
create_secure_temp_file() {
    # ä½¿ç”¨å®‰å…¨çš„ä¸´æ—¶ç›®å½•
    local temp_dir
    temp_dir=$(mktemp -d) || {
        echo "æ— æ³•åˆ›å»ºä¸´æ—¶ç›®å½•"
        return 1
    }
    
    # è®¾ç½®ä¸¥æ ¼æƒé™
    chmod 700 "$temp_dir"
    
    # åˆ›å»ºä¸´æ—¶æ–‡ä»¶
    local temp_file="$temp_dir/secure_temp.$$"
    touch "$temp_file"
    chmod 600 "$temp_file"
    
    # è®¾ç½®æ¸…ç†é™·é˜±
    trap "rm -rf '$temp_dir'" EXIT
    
    echo "$temp_file"
}
```

---

## 9. ğŸ§ª è„šæœ¬æµ‹è¯•ä¸éªŒè¯


### 9.1 æµ‹è¯•ç­–ç•¥


**ğŸ”¸ æµ‹è¯•çš„é‡è¦æ€§**
æµ‹è¯•å°±åƒä½“æ£€ï¼Œå¯ä»¥åœ¨é—®é¢˜ä¸¥é‡ä¹‹å‰å‘ç°å¹¶è§£å†³ã€‚å¯¹äºå¯èƒ½å½±å“ç³»ç»Ÿå®‰å…¨çš„è„šæœ¬ï¼Œæµ‹è¯•æ˜¯å¿…ä¸å¯å°‘çš„å®‰å…¨ç½‘ã€‚

**ğŸ“Š æµ‹è¯•é‡‘å­—å¡”**

```
æµ‹è¯•å±‚æ¬¡ç»“æ„ï¼š
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  ç”Ÿäº§æµ‹è¯•   â”‚ â† æœ€ç»ˆéªŒè¯
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚  é›†æˆæµ‹è¯•   â”‚ â† ç³»ç»Ÿé›†æˆ
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚  åŠŸèƒ½æµ‹è¯•   â”‚ â† ä¸šåŠ¡é€»è¾‘
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚  å•å…ƒæµ‹è¯•   â”‚ â† åŸºç¡€åŠŸèƒ½
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 æ²™ç›’ç¯å¢ƒæµ‹è¯•


**ğŸ–ï¸ ä»€ä¹ˆæ˜¯æ²™ç›’æµ‹è¯•**
æ²™ç›’å°±åƒå„¿ç«¥æ¸¸ä¹åœºï¼Œåœ¨è¿™é‡Œå¯ä»¥å®‰å…¨åœ°"ç©è€"ï¼Œä¸ä¼šå¯¹å¤–ç•Œé€ æˆå½±å“ã€‚

**âœ… æ­å»ºæµ‹è¯•æ²™ç›’**
```bash
# åˆ›å»ºéš”ç¦»çš„æµ‹è¯•ç¯å¢ƒ
setup_test_sandbox() {
    local sandbox_dir="/tmp/script_sandbox_$$"
    
    echo "ğŸ–ï¸  åˆ›å»ºæµ‹è¯•æ²™ç›’: $sandbox_dir"
    mkdir -p "$sandbox_dir"/{bin,data,logs,temp}
    
    # åˆ›å»ºæµ‹è¯•æ•°æ®
    echo "test data 1" > "$sandbox_dir/data/file1.txt"
    echo "test data 2" > "$sandbox_dir/data/file2.txt"
    mkdir -p "$sandbox_dir/data/subdir"
    
    # è®¾ç½®ç¯å¢ƒå˜é‡æŒ‡å‘æ²™ç›’
    export TEST_DATA_DIR="$sandbox_dir/data"
    export TEST_LOG_DIR="$sandbox_dir/logs"
    export TEST_TEMP_DIR="$sandbox_dir/temp"
    
    echo "âœ… æ²™ç›’ç¯å¢ƒå‡†å¤‡å®Œæˆ"
    echo "$sandbox_dir"
}

# æ¸…ç†æµ‹è¯•æ²™ç›’
cleanup_sandbox() {
    local sandbox_dir="$1"
    if [ -d "$sandbox_dir" ] && [[ "$sandbox_dir" == *"script_sandbox"* ]]; then
        rm -rf "$sandbox_dir"
        echo "ğŸ§¹ æ²™ç›’ç¯å¢ƒå·²æ¸…ç†"
    fi
}
```

### 9.3 åŠŸèƒ½æµ‹è¯•ç”¨ä¾‹


**ğŸ¯ æµ‹è¯•ç”¨ä¾‹è®¾è®¡**
```bash
# æµ‹è¯•æ¡†æ¶
run_test_case() {
    local test_name="$1"
    local test_function="$2"
    
    echo "ğŸ§ª æ‰§è¡Œæµ‹è¯•: $test_name"
    
    if $test_function; then
        echo "âœ… $test_name: é€šè¿‡"
        return 0
    else
        echo "âŒ $test_name: å¤±è´¥"
        return 1
    fi
}

# æµ‹è¯•ç”¨ä¾‹1ï¼šæ­£å¸¸è¾“å…¥æµ‹è¯•
test_normal_input() {
    local result
    result=$(validate_username "testuser")
    [ "$result" = "testuser" ]
}

# æµ‹è¯•ç”¨ä¾‹2ï¼šè¾¹ç•Œæ¡ä»¶æµ‹è¯•
test_boundary_conditions() {
    # æµ‹è¯•æœ€çŸ­ç”¨æˆ·å
    local result
    result=$(validate_username "abc")
    [ "$result" = "abc" ] || return 1
    
    # æµ‹è¯•æœ€é•¿ç”¨æˆ·å  
    local long_name=$(printf "%32s" | tr ' ' 'a')
    result=$(validate_username "$long_name")
    [ "$result" = "$long_name" ] || return 1
    
    return 0
}

# æµ‹è¯•ç”¨ä¾‹3ï¼šå¼‚å¸¸è¾“å…¥æµ‹è¯•
test_invalid_input() {
    # æµ‹è¯•ç©ºè¾“å…¥
    if validate_username "" 2>/dev/null; then
        return 1  # åº”è¯¥å¤±è´¥ä½†æˆåŠŸäº†
    fi
    
    # æµ‹è¯•ç‰¹æ®Šå­—ç¬¦
    if validate_username "test@user" 2>/dev/null; then
        return 1  # åº”è¯¥å¤±è´¥ä½†æˆåŠŸäº†
    fi
    
    return 0
}

# æ‰§è¡Œæ‰€æœ‰æµ‹è¯•
run_all_tests() {
    local test_passed=0
    local test_failed=0
    
    # è®¾ç½®æµ‹è¯•ç¯å¢ƒ
    local sandbox
    sandbox=$(setup_test_sandbox)
    
    # æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹
    if run_test_case "æ­£å¸¸è¾“å…¥æµ‹è¯•" test_normal_input; then
        ((test_passed++))
    else
        ((test_failed++))
    fi
    
    if run_test_case "è¾¹ç•Œæ¡ä»¶æµ‹è¯•" test_boundary_conditions; then
        ((test_passed++))
    else
        ((test_failed++))
    fi
    
    if run_test_case "å¼‚å¸¸è¾“å…¥æµ‹è¯•" test_invalid_input; then
        ((test_passed++))  
    else
        ((test_failed++))
    fi
    
    # æ¸…ç†æµ‹è¯•ç¯å¢ƒ
    cleanup_sandbox "$sandbox"
    
    # è¾“å‡ºæµ‹è¯•ç»“æœ
    echo "ğŸ“Š æµ‹è¯•ç»“æœ: é€šè¿‡ $test_passed ä¸ªï¼Œå¤±è´¥ $test_failed ä¸ª"
    
    return $test_failed
}
```

### 9.4 æ€§èƒ½ä¸å®‰å…¨æµ‹è¯•


**âš¡ æ€§èƒ½æµ‹è¯•**
```bash
# æ€§èƒ½æµ‹è¯•å‡½æ•°
performance_test() {
    local test_function="$1"
    local iterations=${2:-100}
    
    echo "âš¡ æ€§èƒ½æµ‹è¯•: $test_function ($iterations æ¬¡è¿­ä»£)"
    
    local start_time=$(date +%s.%N)
    
    for ((i=1; i<=iterations; i++)); do
        $test_function >/dev/null 2>&1
    done
    
    local end_time=$(date +%s.%N)
    local duration=$(echo "$end_time - $start_time" | bc)
    local avg_time=$(echo "scale=4; $duration / $iterations" | bc)
    
    echo "ğŸ“ˆ æ€»è€—æ—¶: ${duration}s"
    echo "ğŸ“Š å¹³å‡è€—æ—¶: ${avg_time}s"
    
    # æ€§èƒ½é˜ˆå€¼æ£€æŸ¥
    if (( $(echo "$avg_time > 0.1" | bc -l) )); then
        echo "âš ï¸  æ€§èƒ½å‘Šè­¦: å¹³å‡è€—æ—¶è¶…è¿‡0.1ç§’"
        return 1
    fi
    
    return 0
}
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ è„šæœ¬é£é™©æœ¬è´¨ï¼šè‡ªåŠ¨åŒ–æ”¾å¤§äº†é”™è¯¯çš„å½±å“èŒƒå›´å’Œé€Ÿåº¦
ğŸ”¸ æƒé™æœ€å°åŒ–ï¼šåªæˆäºˆè„šæœ¬å¿…è¦çš„æœ€å°æƒé™
ğŸ”¸ ç¡¬ç¼–ç å±å®³ï¼šæ•æ„Ÿä¿¡æ¯ä¸åº”å†™æ­»åœ¨ä»£ç ä¸­  
ğŸ”¸ å˜é‡éªŒè¯ï¼šæ‰€æœ‰å˜é‡ä½¿ç”¨å‰éƒ½åº”éªŒè¯æœ‰æ•ˆæ€§
ğŸ”¸ é€»è¾‘ç¼œå¯†ï¼šæ¡ä»¶åˆ¤æ–­å’Œå¾ªç¯é€»è¾‘éœ€è¦ä¸¥æ ¼éªŒè¯
ğŸ”¸ æ‰¹é‡è°¨æ…ï¼šæ‰¹é‡æ“ä½œå‰å¿…é¡»å¤šé‡æ£€æŸ¥å’Œç¡®è®¤
ğŸ”¸ ç¯å¢ƒéªŒè¯ï¼šè„šæœ¬æ‰§è¡Œå‰æ£€æŸ¥è¿è¡Œç¯å¢ƒçš„å®Œæ•´æ€§
ğŸ”¸ å®‰å…¨ç¼–ç¨‹ï¼šé‡‡ç”¨é˜²å¾¡æ€§ç¼–ç¨‹æ€æƒ³
ğŸ”¸ å……åˆ†æµ‹è¯•ï¼šåœ¨æ²™ç›’ç¯å¢ƒä¸­è¿›è¡Œå…¨é¢æµ‹è¯•
```

### 10.2 å…³é”®å®‰å…¨å®è·µ


**ğŸ”¹ ç¼–ç¨‹å®‰å…¨æ£€æŸ¥æ¸…å•**
```
ä»£ç å®¡æŸ¥ï¼š
âœ… æ‰€æœ‰å˜é‡éƒ½åŠ å¼•å·ä¿æŠ¤
âœ… ä½¿ç”¨set -euo pipefailå¢å¼ºé”™è¯¯æ£€æµ‹
âœ… æ•æ„Ÿä¿¡æ¯å¤–éƒ¨åŒ–é…ç½®
âœ… å±é™©æ“ä½œå‰è¿›è¡Œç¡®è®¤
âœ… è®¾ç½®é€‚å½“çš„æ–‡ä»¶æƒé™
âœ… å®ç°å®Œå–„çš„é”™è¯¯å¤„ç†
âœ… è®°å½•è¯¦ç»†çš„æ“ä½œæ—¥å¿—

éƒ¨ç½²æ£€æŸ¥ï¼š
âœ… åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯åŠŸèƒ½
âœ… æ£€æŸ¥è„šæœ¬æƒé™é…ç½®
âœ… éªŒè¯ä¾èµ–è½¯ä»¶å’Œç¯å¢ƒ
âœ… å‡†å¤‡å›æ»šå’Œæ¢å¤æ–¹æ¡ˆ
âœ… è®¾ç½®ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶
```

**ğŸ”¹ é£é™©é˜²èŒƒç­–ç•¥**
```
é¢„é˜²ä¸ºä¸»ï¼š
â€¢ ä»£ç å®¡æŸ¥ï¼šå¤šäººå®¡æŸ¥å…³é”®è„šæœ¬
â€¢ æƒé™æ§åˆ¶ï¼šä¸¥æ ¼é™åˆ¶è„šæœ¬æƒé™
â€¢ è¾“å…¥éªŒè¯ï¼šéªŒè¯æ‰€æœ‰å¤–éƒ¨è¾“å…¥
â€¢ ç¯å¢ƒéš”ç¦»ï¼šæµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒåˆ†ç¦»

æ£€æµ‹æœºåˆ¶ï¼š
â€¢ æ—¥å¿—è®°å½•ï¼šè®°å½•æ‰€æœ‰å…³é”®æ“ä½œ
â€¢ ç›‘æ§å‘Šè­¦ï¼šå¼‚å¸¸æƒ…å†µåŠæ—¶é€šçŸ¥
â€¢ å®šæœŸå®¡è®¡ï¼šæ£€æŸ¥è„šæœ¬å’Œæƒé™é…ç½®

åº”æ€¥å“åº”ï¼š  
â€¢ å¿«é€Ÿå›æ»šï¼šå‡†å¤‡æ•°æ®å’Œé…ç½®å¤‡ä»½
â€¢ æ•…éšœéš”ç¦»ï¼šé™åˆ¶å½±å“èŒƒå›´
â€¢ äº‹ååˆ†æï¼šåˆ†æåŸå› ï¼Œæ”¹è¿›æµç¨‹
```

### 10.3 å®é™…åº”ç”¨ä»·å€¼


ğŸ’¼ **é€‚ç”¨åœºæ™¯**ï¼š
- **è¿ç»´è‡ªåŠ¨åŒ–**ï¼šéƒ¨ç½²è„šæœ¬ã€ç›‘æ§è„šæœ¬ã€å¤‡ä»½è„šæœ¬
- **æ•°æ®å¤„ç†**ï¼šETLè„šæœ¬ã€æ—¥å¿—åˆ†æã€æŠ¥è¡¨ç”Ÿæˆ
- **ç³»ç»Ÿç®¡ç†**ï¼šç”¨æˆ·ç®¡ç†ã€æƒé™è®¾ç½®ã€èµ„æºæ¸…ç†
- **CI/CDæµç¨‹**ï¼šæ„å»ºè„šæœ¬ã€æµ‹è¯•è„šæœ¬ã€å‘å¸ƒè„šæœ¬

ğŸ”§ **æœ€ä½³å®è·µå»ºè®®**ï¼š
- å»ºç«‹è„šæœ¬å¼€å‘è§„èŒƒå’Œå®¡æŸ¥æµç¨‹
- ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ç®¡ç†æ‰€æœ‰è„šæœ¬
- å®šæœŸè¿›è¡Œå®‰å…¨æ£€æŸ¥å’Œæ›´æ–°
- åŸ¹è®­å›¢é˜Ÿæˆå‘˜å®‰å…¨ç¼–ç¨‹æ„è¯†

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
ğŸ¯ Shellè„šæœ¬è¦è°¨æ…ï¼Œå®‰å…¨ç¬¬ä¸€è®°å¿ƒé—´
æƒé™æœ€å°ç¡¬ç¼–ç ç»ï¼Œå˜é‡æ£€æŸ¥ä¸èƒ½å…  
é€»è¾‘ä¸¥å¯†æµ‹è¯•å…¨ï¼Œç¯å¢ƒéªŒè¯ä¿å®‰å…¨
é˜²å¾¡ç¼–ç¨‹æ˜¯æ ¹æœ¬ï¼Œå‡ºé”™å¤„ç†è¦å®Œå–„
```

---

> ğŸ’¡ **å­¦ä¹ æç¤º**: Shellè„šæœ¬çš„å¨åŠ›å·¨å¤§ï¼Œä½†åŒæ—¶é£é™©ä¹Ÿå¾ˆé«˜ã€‚æŒæ¡å®‰å…¨ç¼–ç¨‹ä¸ä»…æ˜¯æŠ€æœ¯èƒ½åŠ›ï¼Œæ›´æ˜¯èŒä¸šè´£ä»»ã€‚è®°ä½ï¼šå°å¿ƒé©¶å¾—ä¸‡å¹´èˆ¹ï¼Œå®‰å…¨ç¼–ç¨‹æ— å°äº‹ï¼

> âš ï¸ **é‡è¦è­¦å‘Š**: åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œä»»ä½•è„šæœ¬å‰ï¼Œéƒ½åº”è¯¥åœ¨éš”ç¦»çš„æµ‹è¯•ç¯å¢ƒä¸­è¿›è¡Œå……åˆ†éªŒè¯ã€‚å½“æœ‰ç–‘è™‘æ—¶ï¼Œå®å¯ä¿å®ˆä¹Ÿä¸è¦å†’é™©ï¼