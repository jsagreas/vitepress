---
title: 11ã€åŒæ ˆç¯å¢ƒç›‘æ§ä¸æ—¥å¿—
---
## ğŸ“š ç›®å½•

1. [åŒæ ˆç¯å¢ƒç›‘æ§æ¦‚è¿°](#1-åŒæ ˆç¯å¢ƒç›‘æ§æ¦‚è¿°)
2. [IPv6è¿æ¥çŠ¶æ€ç›‘æ§](#2-IPv6è¿æ¥çŠ¶æ€ç›‘æ§)
3. [åŒæ ˆæµé‡ç»Ÿè®¡åˆ†æ](#3-åŒæ ˆæµé‡ç»Ÿè®¡åˆ†æ)
4. [IPv6åœ°å€ä½¿ç”¨æƒ…å†µç›‘æ§](#4-IPv6åœ°å€ä½¿ç”¨æƒ…å†µç›‘æ§)
5. [é‚»å±…å‘ç°åè®®æ—¥å¿—ç®¡ç†](#5-é‚»å±…å‘ç°åè®®æ—¥å¿—ç®¡ç†)
6. [è·¯ç”±å˜æ›´ç›‘æ§ä¸æ—¥å¿—](#6-è·¯ç”±å˜æ›´ç›‘æ§ä¸æ—¥å¿—)
7. [IPv6å®‰å…¨äº‹ä»¶æ—¥å¿—åˆ†æ](#7-IPv6å®‰å…¨äº‹ä»¶æ—¥å¿—åˆ†æ)
8. [æ€§èƒ½æŒ‡æ ‡ç›‘æ§ç³»ç»Ÿ](#8-æ€§èƒ½æŒ‡æ ‡ç›‘æ§ç³»ç»Ÿ)
9. [å‘Šè­¦è§„åˆ™é…ç½®ä¸ç®¡ç†](#9-å‘Šè­¦è§„åˆ™é…ç½®ä¸ç®¡ç†)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” åŒæ ˆç¯å¢ƒç›‘æ§æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯åŒæ ˆç¯å¢ƒç›‘æ§


**ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µ**ï¼šåŒæ ˆç¯å¢ƒç›‘æ§æ˜¯æŒ‡åŒæ—¶ç›‘æ§IPv4å’ŒIPv6ç½‘ç»œåè®®çš„è¿è¡ŒçŠ¶æ€ã€æ€§èƒ½æŒ‡æ ‡å’Œå®‰å…¨äº‹ä»¶çš„ç»¼åˆç®¡ç†ä½“ç³»ã€‚

```
ä¼ ç»ŸIPv4ç›‘æ§ï¼š         åŒæ ˆç¯å¢ƒç›‘æ§ï¼š
     IPv4                IPv4 + IPv6
      |                     |    |
   [ç›‘æ§å·¥å…·]            [ç»Ÿä¸€ç›‘æ§å¹³å°]
      |                     |    |
   [å‘Šè­¦ç³»ç»Ÿ]            [å…³è”åˆ†æ] [æ™ºèƒ½å‘Šè­¦]

ç›®æ ‡ï¼šç¡®ä¿ä¸¤ç§åè®®çš„åè°ƒè¿è¡Œå’Œæœ€ä½³æ€§èƒ½
```

### 1.2 åŒæ ˆç›‘æ§çš„é‡è¦æ€§


**ğŸ¯ æ ¸å¿ƒä»·å€¼**ï¼š
- **åè®®åè°ƒæ€§**ï¼šç¡®ä¿IPv4å’ŒIPv6åè®®ä¸ä¼šç›¸äº’å¹²æ‰°
- **æ€§èƒ½ä¼˜åŒ–**ï¼šè¯†åˆ«å¹¶è§£å†³åŒæ ˆç¯å¢ƒä¸­çš„æ€§èƒ½ç“¶é¢ˆ
- **å®‰å…¨ä¿éšœ**ï¼šåŠæ—¶å‘ç°å’Œå“åº”å®‰å…¨å¨èƒ
- **æ•…éšœé¢„é˜²**ï¼šé€šè¿‡ç›‘æ§æ•°æ®é¢„æµ‹å’Œé¿å…ç³»ç»Ÿæ•…éšœ

### 1.3 ç›‘æ§æ¶æ„è®¾è®¡


```
ç›‘æ§å±‚æ¬¡ç»“æ„ï¼š

[åº”ç”¨å±‚ç›‘æ§]
     |
[ç½‘ç»œå±‚ç›‘æ§] â†â†’ IPv4/IPv6åŒæ ˆ
     |
[ç³»ç»Ÿå±‚ç›‘æ§]
     |
[ç¡¬ä»¶å±‚ç›‘æ§]

ç›‘æ§æ•°æ®æµï¼š
æ•°æ®é‡‡é›† â†’ æ•°æ®å¤„ç† â†’ å­˜å‚¨åˆ†æ â†’ å¯è§†åŒ–å±•ç¤º â†’ å‘Šè­¦å“åº”
```

---

## 2. ğŸ“Š IPv6è¿æ¥çŠ¶æ€ç›‘æ§


### 2.1 IPv6è¿æ¥ç›‘æ§åŸºç¡€


**ğŸ”¸ è¿æ¥çŠ¶æ€ç±»å‹**ï¼š
- **é‚»å±…å‘ç°çŠ¶æ€**ï¼šNDPåè®®è¿è¡ŒçŠ¶æ€
- **è·¯ç”±å™¨å‘ç°**ï¼šRAæ¶ˆæ¯æ¥æ”¶çŠ¶æ€
- **åœ°å€é…ç½®çŠ¶æ€**ï¼šSLAACå’ŒDHCPv6çŠ¶æ€
- **è¿æ¥å¯è¾¾æ€§**ï¼šç«¯åˆ°ç«¯è¿é€šæ€§æµ‹è¯•

### 2.2 è¿æ¥ç›‘æ§å·¥å…·ä¸å‘½ä»¤


**âš¡ å®æ—¶ç›‘æ§å‘½ä»¤**ï¼š

```bash
# IPv6é‚»å±…è¡¨ç›‘æ§
ip -6 neigh show

# IPv6è·¯ç”±è¡¨ç›‘æ§
ip -6 route show

# IPv6åœ°å€çŠ¶æ€ç›‘æ§
ip -6 addr show

# è¿é€šæ€§æµ‹è¯•
ping6 2001:db8::1

# è·¯å¾„è¿½è¸ª
traceroute6 2001:db8::1
```

**ğŸ“‹ ç›‘æ§è„šæœ¬ç¤ºä¾‹**ï¼š

```bash
#!/bin/bash
# IPv6è¿æ¥ç›‘æ§è„šæœ¬

check_ipv6_connectivity() {
    local target="2001:4860:4860::8888"  # Google IPv6 DNS
    
    echo "=== IPv6è¿æ¥çŠ¶æ€æ£€æŸ¥ $(date) ===" >> /var/log/ipv6_monitor.log
    
    # æ£€æŸ¥IPv6åœ°å€é…ç½®
    if ip -6 addr show | grep -q "scope global"; then
        echo "âœ… IPv6å…¨å±€åœ°å€å·²é…ç½®" >> /var/log/ipv6_monitor.log
    else
        echo "âŒ IPv6å…¨å±€åœ°å€æœªé…ç½®" >> /var/log/ipv6_monitor.log
        return 1
    fi
    
    # æ£€æŸ¥é»˜è®¤è·¯ç”±
    if ip -6 route show | grep -q "default"; then
        echo "âœ… IPv6é»˜è®¤è·¯ç”±å­˜åœ¨" >> /var/log/ipv6_monitor.log
    else
        echo "âŒ IPv6é»˜è®¤è·¯ç”±ç¼ºå¤±" >> /var/log/ipv6_monitor.log
    fi
    
    # è¿é€šæ€§æµ‹è¯•
    if ping6 -c 3 $target >/dev/null 2>&1; then
        echo "âœ… IPv6å¤–ç½‘è¿é€šæ­£å¸¸" >> /var/log/ipv6_monitor.log
    else
        echo "âŒ IPv6å¤–ç½‘è¿é€šå¤±è´¥" >> /var/log/ipv6_monitor.log
    fi
}

# æ¯5åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡
while true; do
    check_ipv6_connectivity
    sleep 300
done
```

### 2.3 è¿æ¥çŠ¶æ€å¯è§†åŒ–


**ğŸ“ˆ çŠ¶æ€ç›‘æ§è¡¨æ ¼**ï¼š

| ç›‘æ§é¡¹ç›® | æ£€æŸ¥å‘½ä»¤ | æ­£å¸¸çŠ¶æ€ | å¼‚å¸¸çŠ¶æ€ | å¤„ç†å»ºè®® |
|---------|---------|---------|---------|---------|
| **IPv6åœ°å€** | `ip -6 addr show` | æœ‰å…¨å±€åœ°å€ | ä»…æœ¬åœ°åœ°å€ | æ£€æŸ¥SLAAC/DHCPv6 |
| **é»˜è®¤è·¯ç”±** | `ip -6 route show` | å­˜åœ¨default | æ— default | æ£€æŸ¥RAæ¶ˆæ¯ |
| **é‚»å±…å‘ç°** | `ip -6 neigh show` | REACHABLE | FAILED | æ£€æŸ¥ç½‘ç»œè¿æ¥ |
| **DNSè§£æ** | `nslookup -type=AAAA` | è¿”å›IPv6åœ°å€ | è¶…æ—¶/å¤±è´¥ | æ£€æŸ¥DNSé…ç½® |

---

## 3. ğŸ“ˆ åŒæ ˆæµé‡ç»Ÿè®¡åˆ†æ


### 3.1 æµé‡ç»Ÿè®¡çš„é‡è¦æ€§


**ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦æµé‡ç»Ÿè®¡**ï¼š
å°±åƒç»Ÿè®¡å•†åº—çš„å®¢æµé‡ä¸€æ ·ï¼Œç½‘ç»œæµé‡ç»Ÿè®¡å¸®åŠ©æˆ‘ä»¬äº†è§£ï¼š
- å“ªç§åè®®ä½¿ç”¨æ›´é¢‘ç¹ï¼ˆIPv4 vs IPv6ï¼‰
- ç½‘ç»œè´Ÿè½½çš„åˆ†å¸ƒæƒ…å†µ
- æ€§èƒ½ç“¶é¢ˆçš„ä½ç½®
- æµé‡è¶‹åŠ¿çš„å˜åŒ–

### 3.2 æµé‡ç»Ÿè®¡å·¥å…·é…ç½®


**ğŸ”§ ä½¿ç”¨iftopç›‘æ§åŒæ ˆæµé‡**ï¼š

```bash
# å®‰è£…æµé‡ç›‘æ§å·¥å…·
yum install -y iftop nethogs nload

# ç›‘æ§ç‰¹å®šæ¥å£çš„åŒæ ˆæµé‡
iftop -i eth0 -n

# æŒ‰åè®®åˆ†ç±»ç»Ÿè®¡
netstat -s | grep -E "(Ip|Ipv6)"
```

**ğŸ“Š æµé‡ç»Ÿè®¡è„šæœ¬**ï¼š

```bash
#!/bin/bash
# åŒæ ˆæµé‡ç»Ÿè®¡è„šæœ¬

generate_traffic_report() {
    local interface="eth0"
    local report_file="/var/log/dual_stack_traffic.log"
    
    echo "=== åŒæ ˆæµé‡æŠ¥å‘Š $(date) ===" >> $report_file
    
    # IPv4æµé‡ç»Ÿè®¡
    ipv4_rx=$(cat /proc/net/dev | grep $interface | awk '{print $2}')
    ipv4_tx=$(cat /proc/net/dev | grep $interface | awk '{print $10}')
    
    # IPv6æµé‡ç»Ÿè®¡ï¼ˆé€šè¿‡netstatï¼‰
    ipv6_packets=$(netstat -s | grep -A 10 "Ipv6:" | grep "total packets received" | awk '{print $1}')
    
    echo "IPv4æ¥æ”¶å­—èŠ‚: $ipv4_rx" >> $report_file
    echo "IPv4å‘é€å­—èŠ‚: $ipv4_tx" >> $report_file
    echo "IPv6å¤„ç†åŒ…æ•°: $ipv6_packets" >> $report_file
    
    # è®¡ç®—åè®®ä½¿ç”¨æ¯”ä¾‹
    calculate_protocol_ratio
}

calculate_protocol_ratio() {
    # é€šè¿‡è¿æ¥æ•°ç»Ÿè®¡åè®®ä½¿ç”¨æ¯”ä¾‹
    ipv4_conns=$(netstat -tn | grep -c ":")
    ipv6_conns=$(netstat -tn6 | grep -c ":")
    
    total_conns=$((ipv4_conns + ipv6_conns))
    
    if [ $total_conns -gt 0 ]; then
        ipv4_ratio=$((ipv4_conns * 100 / total_conns))
        ipv6_ratio=$((ipv6_conns * 100 / total_conns))
        
        echo "IPv4è¿æ¥å æ¯”: ${ipv4_ratio}%" >> /var/log/dual_stack_traffic.log
        echo "IPv6è¿æ¥å æ¯”: ${ipv6_ratio}%" >> /var/log/dual_stack_traffic.log
    fi
}
```

### 3.3 æµé‡åˆ†æä»ªè¡¨æ¿


**ğŸ“‹ æµé‡ç›‘æ§æ•°æ®å±•ç¤º**ï¼š

```
æµé‡ç»Ÿè®¡æ¦‚è§ˆï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          åŒæ ˆæµé‡ç»Ÿè®¡é¢æ¿             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ IPv4æµé‡:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 75%        â”‚
â”‚ IPv6æµé‡:  â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 25%        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ€»å¸¦å®½ä½¿ç”¨: 150 Mbps / 1 Gbps       â”‚
â”‚ å¹¶å‘è¿æ¥æ•°: 1,250                   â”‚
â”‚ å¹³å‡å»¶è¿Ÿ:   15ms                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åè®®åˆ†å¸ƒè¶‹åŠ¿ï¼š
æ—¶é—´     IPv4%   IPv6%   æ€»æµé‡
08:00     80      20     120MB
09:00     78      22     145MB
10:00     75      25     180MB
11:00     73      27     165MB
```

---

## 4. ğŸ  IPv6åœ°å€ä½¿ç”¨æƒ…å†µç›‘æ§


### 4.1 IPv6åœ°å€ç±»å‹ç›‘æ§


**ğŸ”¸ åœ°å€åˆ†ç±»ç›‘æ§**ï¼š
- **é“¾è·¯æœ¬åœ°åœ°å€**ï¼šfe80::/10èŒƒå›´å†…åœ°å€
- **å”¯ä¸€æœ¬åœ°åœ°å€**ï¼šfc00::/7èŒƒå›´å†…åœ°å€  
- **å…¨å±€å•æ’­åœ°å€**ï¼š2000::/3èŒƒå›´å†…åœ°å€
- **å¤šæ’­åœ°å€**ï¼šff00::/8èŒƒå›´å†…åœ°å€

### 4.2 åœ°å€ä½¿ç”¨ç›‘æ§è„šæœ¬


```bash
#!/bin/bash
# IPv6åœ°å€ä½¿ç”¨æƒ…å†µç›‘æ§

monitor_ipv6_addresses() {
    local log_file="/var/log/ipv6_address_usage.log"
    
    echo "=== IPv6åœ°å€ä½¿ç”¨æƒ…å†µ $(date) ===" >> $log_file
    
    # ç»Ÿè®¡å„ç±»å‹åœ°å€æ•°é‡
    link_local=$(ip -6 addr show | grep "fe80::" | wc -l)
    unique_local=$(ip -6 addr show | grep -E "f[cd][0-9a-f]{2}::" | wc -l)
    global_unicast=$(ip -6 addr show | grep "scope global" | wc -l)
    
    echo "ğŸ“ åœ°å€ç»Ÿè®¡:" >> $log_file
    echo "  é“¾è·¯æœ¬åœ°åœ°å€: $link_local ä¸ª" >> $log_file
    echo "  å”¯ä¸€æœ¬åœ°åœ°å€: $unique_local ä¸ª" >> $log_file
    echo "  å…¨å±€å•æ’­åœ°å€: $global_unicast ä¸ª" >> $log_file
    
    # æ£€æŸ¥åœ°å€å†²çª
    check_address_conflicts
    
    # ç›‘æ§åœ°å€ç”Ÿå‘½å‘¨æœŸ
    monitor_address_lifetime
}

check_address_conflicts() {
    echo "ğŸ” æ£€æŸ¥åœ°å€å†²çª:" >> /var/log/ipv6_address_usage.log
    
    # æ£€æŸ¥é‡å¤åœ°å€æ£€æµ‹(DAD)å¤±è´¥
    if dmesg | tail -100 | grep -q "duplicate address"; then
        echo "âš ï¸  å‘ç°åœ°å€å†²çª" >> /var/log/ipv6_address_usage.log
    else
        echo "âœ… æ— åœ°å€å†²çª" >> /var/log/ipv6_address_usage.log
    fi
}

monitor_address_lifetime() {
    echo "â° åœ°å€ç”Ÿå‘½å‘¨æœŸçŠ¶æ€:" >> /var/log/ipv6_address_usage.log
    
    # æ£€æŸ¥ä¸´æ—¶åœ°å€å’Œæ°¸ä¹…åœ°å€
    ip -6 addr show | while read line; do
        if echo "$line" | grep -q "temporary"; then
            echo "  ä¸´æ—¶åœ°å€: $(echo $line | awk '{print $2}')" >> /var/log/ipv6_address_usage.log
        elif echo "$line" | grep -q "permanent"; then
            echo "  æ°¸ä¹…åœ°å€: $(echo $line | awk '{print $2}')" >> /var/log/ipv6_address_usage.log
        fi
    done
}
```

### 4.3 åœ°å€æ± ç®¡ç†ç›‘æ§


**ğŸ“Š åœ°å€æ± çŠ¶æ€è¡¨**ï¼š

| åœ°å€æ± ç±»å‹ | æ€»å®¹é‡ | å·²åˆ†é… | å¯ç”¨ç‡ | é¢„è­¦é˜ˆå€¼ | çŠ¶æ€ |
|-----------|--------|--------|--------|----------|------|
| **SLAACæ± ** | /64å‰ç¼€ | 15ä¸ªä¸»æœº | 99.9% | 80% | ğŸŸ¢ æ­£å¸¸ |
| **DHCPv6æ± ** | 1000ä¸ªåœ°å€ | 245ä¸ª | 75.5% | 90% | ğŸŸ¡ æ³¨æ„ |
| **é™æ€åœ°å€** | 50ä¸ªåœ°å€ | 12ä¸ª | 76% | 95% | ğŸŸ¢ æ­£å¸¸ |

---

## 5. ğŸ¤ é‚»å±…å‘ç°åè®®æ—¥å¿—ç®¡ç†


### 5.1 NDPåè®®ç›‘æ§åŸºç¡€


**ğŸ’¡ é‚»å±…å‘ç°åè®®ä½œç”¨**ï¼š
NDPï¼ˆNeighbor Discovery Protocolï¼‰å°±åƒIPv6ç½‘ç»œä¸­çš„"é€šè®¯å½•"ï¼Œå®ƒå¸®åŠ©è®¾å¤‡ï¼š
- ğŸ” å‘ç°åŒä¸€ç½‘æ®µçš„å…¶ä»–è®¾å¤‡
- ğŸ“ è§£æIPv6åœ°å€å¯¹åº”çš„MACåœ°å€
- ğŸšª æ‰¾åˆ°é»˜è®¤ç½‘å…³è·¯ç”±å™¨
- âœ… æ£€æµ‹åœ°å€æ˜¯å¦é‡å¤

### 5.2 NDPæ—¥å¿—é…ç½®


**ğŸ”§ å¯ç”¨è¯¦ç»†NDPæ—¥å¿—**ï¼š

```bash
# å¯ç”¨å†…æ ¸NDPè°ƒè¯•æ—¥å¿—
echo 1 > /proc/sys/net/ipv6/conf/all/log_neighbour_updates

# é…ç½®rsyslogæ•è·NDPæ¶ˆæ¯
cat >> /etc/rsyslog.conf << 'EOF'
# IPv6é‚»å±…å‘ç°æ—¥å¿—
:msg, contains, "neighbour" /var/log/ipv6_ndp.log
:msg, contains, "router advertisement" /var/log/ipv6_ra.log
EOF

systemctl restart rsyslog
```

**ğŸ“‹ NDPç›‘æ§è„šæœ¬**ï¼š

```bash
#!/bin/bash
# NDPåè®®ç›‘æ§è„šæœ¬

monitor_ndp_activity() {
    local log_file="/var/log/ndp_monitor.log"
    
    echo "=== NDPæ´»åŠ¨ç›‘æ§ $(date) ===" >> $log_file
    
    # ç›‘æ§é‚»å±…è¡¨å˜åŒ–
    monitor_neighbor_table
    
    # æ£€æŸ¥è·¯ç”±å™¨é€šå‘Š
    check_router_advertisements
    
    # åˆ†æNDPæ€§èƒ½
    analyze_ndp_performance
}

monitor_neighbor_table() {
    echo "ğŸ“‹ é‚»å±…è¡¨çŠ¶æ€:" >> /var/log/ndp_monitor.log
    
    # ç»Ÿè®¡é‚»å±…çŠ¶æ€
    reachable=$(ip -6 neigh show | grep -c "REACHABLE")
    stale=$(ip -6 neigh show | grep -c "STALE")
    delay=$(ip -6 neigh show | grep -c "DELAY")
    probe=$(ip -6 neigh show | grep -c "PROBE")
    failed=$(ip -6 neigh show | grep -c "FAILED")
    
    echo "  å¯è¾¾çŠ¶æ€: $reachable" >> /var/log/ndp_monitor.log
    echo "  è¿‡æœŸçŠ¶æ€: $stale" >> /var/log/ndp_monitor.log
    echo "  å»¶è¿ŸçŠ¶æ€: $delay" >> /var/log/ndp_monitor.log
    echo "  æ¢æµ‹çŠ¶æ€: $probe" >> /var/log/ndp_monitor.log
    echo "  å¤±è´¥çŠ¶æ€: $failed" >> /var/log/ndp_monitor.log
    
    # è­¦å‘Šæ£€æŸ¥
    if [ $failed -gt 0 ]; then
        echo "âš ï¸  è­¦å‘Š: å‘ç°å¤±è´¥çš„é‚»å±…å‘ç°" >> /var/log/ndp_monitor.log
    fi
}

check_router_advertisements() {
    echo "ğŸ“¡ è·¯ç”±å™¨é€šå‘Šæ£€æŸ¥:" >> /var/log/ndp_monitor.log
    
    # æ£€æŸ¥æ˜¯å¦æ”¶åˆ°RAæ¶ˆæ¯
    if timeout 10 tcpdump -c 1 -i any icmp6 2>/dev/null | grep -q "router advertisement"; then
        echo "âœ… æ¥æ”¶åˆ°è·¯ç”±å™¨é€šå‘Š" >> /var/log/ndp_monitor.log
    else
        echo "âŒ æœªæ¥æ”¶åˆ°è·¯ç”±å™¨é€šå‘Š" >> /var/log/ndp_monitor.log
    fi
}
```

### 5.3 NDPæ•…éšœè¯Šæ–­


**ğŸ” å¸¸è§NDPé—®é¢˜è¯Šæ–­**ï¼š

```
NDPæ•…éšœæ’æŸ¥æµç¨‹ï¼š

é—®é¢˜ç°è±¡               å¯èƒ½åŸå›                      è§£å†³æ–¹æ¡ˆ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
é‚»å±…å‘ç°å¤±è´¥     â†’     ç½‘ç»œè¿æ¥é—®é¢˜           â†’     æ£€æŸ¥ç‰©ç†è¿æ¥
åœ°å€è§£æè¶…æ—¶     â†’     é˜²ç«å¢™é˜»æ­¢ICMPv6       â†’     è°ƒæ•´é˜²ç«å¢™è§„åˆ™  
é‡å¤åœ°å€æ£€æµ‹å¤±è´¥  â†’     åœ°å€å†²çª               â†’     æ£€æŸ¥åœ°å€åˆ†é…
è·¯ç”±å™¨å‘ç°å¤±è´¥    â†’     RAæ¶ˆæ¯è¢«è¿‡æ»¤           â†’     æ£€æŸ¥ç½‘ç»œé…ç½®

è¯Šæ–­å‘½ä»¤åºåˆ—ï¼š
1. ping6 -I eth0 ff02::1          # æµ‹è¯•é“¾è·¯æœ¬åœ°å¤šæ’­
2. ip -6 neigh show               # æŸ¥çœ‹é‚»å±…è¡¨
3. tcpdump -i eth0 icmp6          # æŠ“å–ICMPv6åŒ…
4. rdisc6 eth0                    # æ‰‹åŠ¨è·¯ç”±å™¨å‘ç°
```

---

## 6. ğŸ›£ï¸ è·¯ç”±å˜æ›´ç›‘æ§ä¸æ—¥å¿—


### 6.1 IPv6è·¯ç”±ç›‘æ§é‡è¦æ€§


**ğŸ¯ è·¯ç”±ç›‘æ§ç›®æ ‡**ï¼š
- **è·¯ç”±ç¨³å®šæ€§**ï¼šç¡®ä¿è·¯ç”±è¡¨ä¸é¢‘ç¹å˜åŠ¨
- **è·¯å¾„ä¼˜åŒ–**ï¼šç›‘æ§è·¯ç”±è·¯å¾„çš„æ•ˆç‡
- **æ•…éšœæ£€æµ‹**ï¼šåŠæ—¶å‘ç°è·¯ç”±æ•…éšœ
- **å®‰å…¨é˜²æŠ¤**ï¼šæ£€æµ‹æ¶æ„è·¯ç”±æ³¨å…¥

### 6.2 è·¯ç”±å˜æ›´ç›‘æ§é…ç½®


**ğŸ“¡ å®æ—¶è·¯ç”±ç›‘æ§**ï¼š

```bash
#!/bin/bash
# IPv6è·¯ç”±å˜æ›´ç›‘æ§è„šæœ¬

monitor_ipv6_routes() {
    local route_file="/tmp/ipv6_routes.current"
    local log_file="/var/log/ipv6_route_changes.log"
    local old_route_file="/tmp/ipv6_routes.previous"
    
    # è·å–å½“å‰è·¯ç”±è¡¨
    ip -6 route show > $route_file
    
    # å¦‚æœå­˜åœ¨æ—§çš„è·¯ç”±è®°å½•ï¼Œæ¯”è¾ƒå˜åŒ–
    if [ -f $old_route_file ]; then
        detect_route_changes
    fi
    
    # ä¿å­˜å½“å‰è·¯ç”±ä½œä¸ºä¸‹æ¬¡æ¯”è¾ƒåŸºå‡†
    cp $route_file $old_route_file
}

detect_route_changes() {
    echo "=== è·¯ç”±å˜æ›´æ£€æµ‹ $(date) ===" >> /var/log/ipv6_route_changes.log
    
    # æ£€æµ‹æ–°å¢è·¯ç”±
    comm -13 $old_route_file $route_file > /tmp/new_routes
    if [ -s /tmp/new_routes ]; then
        echo "â• æ–°å¢è·¯ç”±:" >> /var/log/ipv6_route_changes.log
        cat /tmp/new_routes | sed 's/^/    /' >> /var/log/ipv6_route_changes.log
    fi
    
    # æ£€æµ‹åˆ é™¤è·¯ç”±
    comm -23 $old_route_file $route_file > /tmp/deleted_routes
    if [ -s /tmp/deleted_routes ]; then
        echo "â– åˆ é™¤è·¯ç”±:" >> /var/log/ipv6_route_changes.log
        cat /tmp/deleted_routes | sed 's/^/    /' >> /var/log/ipv6_route_changes.log
    fi
    
    # åˆ†æè·¯ç”±å˜æ›´å½±å“
    analyze_route_impact
}

analyze_route_impact() {
    # æ£€æŸ¥é»˜è®¤è·¯ç”±å˜æ›´
    if grep -q "default" /tmp/new_routes; then
        echo "ğŸš¨ é‡è¦: é»˜è®¤è·¯ç”±å‘ç”Ÿå˜æ›´" >> /var/log/ipv6_route_changes.log
    fi
    
    if grep -q "default" /tmp/deleted_routes; then
        echo "ğŸš¨ è­¦å‘Š: é»˜è®¤è·¯ç”±è¢«åˆ é™¤" >> /var/log/ipv6_route_changes.log
    fi
    
    # ç»Ÿè®¡è·¯ç”±æ•°é‡å˜åŒ–
    current_routes=$(wc -l < $route_file)
    previous_routes=$(wc -l < $old_route_file)
    route_diff=$((current_routes - previous_routes))
    
    echo "ğŸ“Š è·¯ç”±ç»Ÿè®¡: å½“å‰${current_routes}æ¡, å˜åŒ–${route_diff}æ¡" >> /var/log/ipv6_route_changes.log
}
```

### 6.3 è·¯ç”±æ€§èƒ½ç›‘æ§


**âš¡ è·¯ç”±æ€§èƒ½æŒ‡æ ‡**ï¼š

| ç›‘æ§æŒ‡æ ‡ | æ­£å¸¸èŒƒå›´ | ç›‘æ§å‘½ä»¤ | å¼‚å¸¸å¤„ç† |
|---------|---------|---------|---------|
| **è·¯ç”±æ¡ç›®æ•°** | < 1000æ¡ | `ip -6 route | wc -l` | æ¸…ç†æ— æ•ˆè·¯ç”± |
| **é»˜è®¤è·¯ç”±æ•°** | 1-2æ¡ | `ip -6 route | grep default` | æ£€æŸ¥ç½‘å…³é…ç½® |
| **è·¯ç”±æ›´æ–°é¢‘ç‡** | < 10æ¬¡/å°æ—¶ | ç›‘æ§è„šæœ¬ç»Ÿè®¡ | æ£€æŸ¥ç½‘ç»œç¨³å®šæ€§ |
| **è·¯ç”±æŸ¥æ‰¾å»¶è¿Ÿ** | < 1ms | `time ip -6 route get` | ä¼˜åŒ–è·¯ç”±è¡¨ |

---

## 7. ğŸ›¡ï¸ IPv6å®‰å…¨äº‹ä»¶æ—¥å¿—åˆ†æ


### 7.1 IPv6å®‰å…¨å¨èƒè¯†åˆ«


**âš ï¸ å¸¸è§IPv6å®‰å…¨å¨èƒ**ï¼š
- **RAæ”»å‡»**ï¼šæ¶æ„è·¯ç”±å™¨é€šå‘Š
- **NDPæ¬ºéª—**ï¼šé‚»å±…å‘ç°åè®®æ”»å‡»
- **åœ°å€æ‰«æ**ï¼šIPv6åœ°å€ç©ºé—´æ‰«æ
- **éš§é“æ”»å‡»**ï¼šIPv6 over IPv4éš§é“æ”»å‡»

### 7.2 å®‰å…¨æ—¥å¿—é…ç½®


**ğŸ”’ å®‰å…¨ç›‘æ§é…ç½®**ï¼š

```bash
# é…ç½®é˜²ç«å¢™æ—¥å¿—IPv6ç›¸å…³äº‹ä»¶
ip6tables -A INPUT -p icmpv6 --icmpv6-type router-advertisement -j LOG --log-prefix "IPv6-RA: "
ip6tables -A INPUT -p icmpv6 --icmpv6-type neighbor-solicitation -j LOG --log-prefix "IPv6-NS: "

# åˆ›å»ºIPv6å®‰å…¨äº‹ä»¶ç›‘æ§è„šæœ¬
cat > /usr/local/bin/ipv6_security_monitor.sh << 'EOF'
#!/bin/bash

detect_ipv6_attacks() {
    local log_file="/var/log/ipv6_security.log"
    
    echo "=== IPv6å®‰å…¨æ£€æµ‹ $(date) ===" >> $log_file
    
    # æ£€æµ‹RAæ”»å‡»
    detect_ra_attacks
    
    # æ£€æµ‹NDPæ¬ºéª—
    detect_ndp_spoofing
    
    # æ£€æµ‹åœ°å€æ‰«æ
    detect_address_scanning
    
    # æ£€æµ‹å¼‚å¸¸æµé‡
    detect_anomalous_traffic
}

detect_ra_attacks() {
    # æ£€æŸ¥æ˜¯å¦æœ‰å¤šä¸ªè·¯ç”±å™¨å‘é€RA
    ra_sources=$(tcpdump -n -c 10 -i any icmp6 2>/dev/null | grep "router advertisement" | awk '{print $3}' | sort | uniq | wc -l)
    
    if [ $ra_sources -gt 2 ]; then
        echo "ğŸš¨ å¯èƒ½çš„RAæ”»å‡»: æ£€æµ‹åˆ°${ra_sources}ä¸ªRAæº" >> /var/log/ipv6_security.log
    fi
}

detect_ndp_spoofing() {
    # ç›‘æ§å¼‚å¸¸çš„é‚»å±…å‘ç°æ´»åŠ¨
    ndp_rate=$(tail -100 /var/log/messages | grep "neighbour" | wc -l)
    
    if [ $ndp_rate -gt 20 ]; then
        echo "ğŸš¨ å¯èƒ½çš„NDPæ¬ºéª—: å¼‚å¸¸é«˜çš„NDPæ´»åŠ¨" >> /var/log/ipv6_security.log
    fi
}

detect_address_scanning() {
    # æ£€æµ‹IPv6åœ°å€æ‰«æè¡Œä¸º
    netstat -n | grep -E "^tcp6.*:.*" | awk '{print $5}' | cut -d: -f1-4 | sort | uniq -c | sort -nr | head -5 | while read count ip; do
        if [ $count -gt 10 ]; then
            echo "ğŸš¨ å¯èƒ½çš„åœ°å€æ‰«æ: ${ip} å°è¯•è¿æ¥ ${count} æ¬¡" >> /var/log/ipv6_security.log
        fi
    done
}
EOF

chmod +x /usr/local/bin/ipv6_security_monitor.sh
```

### 7.3 å®‰å…¨äº‹ä»¶å“åº”


**ğŸš€ è‡ªåŠ¨å“åº”æœºåˆ¶**ï¼š

```bash
#!/bin/bash
# IPv6å®‰å…¨äº‹ä»¶è‡ªåŠ¨å“åº”

respond_to_security_event() {
    local event_type="$1"
    local source_ip="$2"
    
    case $event_type in
        "ra_attack")
            # é˜»æ­¢æ¶æ„RAæº
            ip6tables -A INPUT -s $source_ip -p icmpv6 --icmpv6-type router-advertisement -j DROP
            echo "ğŸ›¡ï¸  å·²é˜»æ­¢æ¥è‡ª $source_ip çš„RAæ”»å‡»" >> /var/log/ipv6_security_response.log
            ;;
        "ndp_spoof")
            # é™åˆ¶NDPè¯·æ±‚é¢‘ç‡
            ip6tables -A INPUT -s $source_ip -p icmpv6 --icmpv6-type neighbor-solicitation -m limit --limit 5/min -j ACCEPT
            ip6tables -A INPUT -s $source_ip -p icmpv6 --icmpv6-type neighbor-solicitation -j DROP
            ;;
        "addr_scan")
            # ä¸´æ—¶é˜»æ­¢æ‰«ææº
            ip6tables -A INPUT -s $source_ip -j DROP
            echo "ğŸš« å·²ä¸´æ—¶é˜»æ­¢æ‰«ææº $source_ip" >> /var/log/ipv6_security_response.log
            # 15åˆ†é’Ÿåè‡ªåŠ¨è§£é™¤
            echo "ip6tables -D INPUT -s $source_ip -j DROP" | at now + 15 minutes
            ;;
    esac
}
```

---

## 8. ğŸ“Š æ€§èƒ½æŒ‡æ ‡ç›‘æ§ç³»ç»Ÿ


### 8.1 å…³é”®æ€§èƒ½æŒ‡æ ‡å®šä¹‰


**âš¡ IPv6æ€§èƒ½æŒ‡æ ‡ä½“ç³»**ï¼š

```
æ€§èƒ½æŒ‡æ ‡å±‚æ¬¡ï¼š

[è¿æ¥æ€§èƒ½]
â”œâ”€â”€ å»¶è¿Ÿ (Latency)
â”œâ”€â”€ ååé‡ (Throughput)  
â”œâ”€â”€ ä¸¢åŒ…ç‡ (Packet Loss)
â””â”€â”€ è¿æ¥å»ºç«‹æ—¶é—´

[åè®®æ€§èƒ½]
â”œâ”€â”€ NDPè§£ææ—¶é—´
â”œâ”€â”€ è·¯ç”±æ”¶æ•›æ—¶é—´
â”œâ”€â”€ åœ°å€é…ç½®æ—¶é—´
â””â”€â”€ DNSè§£ææ—¶é—´

[ç³»ç»Ÿæ€§èƒ½]
â”œâ”€â”€ CPUä½¿ç”¨ç‡
â”œâ”€â”€ å†…å­˜ä½¿ç”¨ç‡
â”œâ”€â”€ ç½‘ç»œæ¥å£åˆ©ç”¨ç‡
â””â”€â”€ å†…æ ¸ç½‘ç»œç¼“å†²åŒºä½¿ç”¨
```

### 8.2 æ€§èƒ½ç›‘æ§è„šæœ¬


```bash
#!/bin/bash
# IPv6æ€§èƒ½ç›‘æ§ç³»ç»Ÿ

collect_performance_metrics() {
    local metrics_file="/var/log/ipv6_performance.log"
    
    echo "=== IPv6æ€§èƒ½æŒ‡æ ‡ $(date) ===" >> $metrics_file
    
    # ç½‘ç»œå»¶è¿Ÿæµ‹è¯•
    measure_latency
    
    # ååé‡æµ‹è¯•
    measure_throughput
    
    # DNSè§£ææ€§èƒ½
    measure_dns_performance
    
    # ç³»ç»Ÿèµ„æºä½¿ç”¨
    measure_system_resources
}

measure_latency() {
    local test_targets=("2001:4860:4860::8888" "2606:4700:4700::1111")
    
    echo "ğŸš€ å»¶è¿Ÿæµ‹è¯•ç»“æœ:" >> /var/log/ipv6_performance.log
    
    for target in "${test_targets[@]}"; do
        latency=$(ping6 -c 3 $target 2>/dev/null | tail -1 | awk -F'/' '{print $5}')
        if [ ! -z "$latency" ]; then
            echo "  $target: ${latency}ms" >> /var/log/ipv6_performance.log
        else
            echo "  $target: è¶…æ—¶" >> /var/log/ipv6_performance.log
        fi
    done
}

measure_dns_performance() {
    echo "ğŸ” DNSè§£ææ€§èƒ½:" >> /var/log/ipv6_performance.log
    
    # æµ‹è¯•IPv6 DNSè§£ææ—¶é—´
    start_time=$(date +%s.%N)
    nslookup ipv6.google.com 2001:4860:4860::8888 >/dev/null 2>&1
    end_time=$(date +%s.%N)
    
    dns_time=$(echo "$end_time - $start_time" | bc)
    echo "  DNSè§£ææ—¶é—´: ${dns_time}ç§’" >> /var/log/ipv6_performance.log
}

measure_system_resources() {
    echo "ğŸ’» ç³»ç»Ÿèµ„æºä½¿ç”¨:" >> /var/log/ipv6_performance.log
    
    # CPUä½¿ç”¨ç‡
    cpu_usage=$(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | awk -F'%' '{print $1}')
    echo "  CPUä½¿ç”¨ç‡: ${cpu_usage}%" >> /var/log/ipv6_performance.log
    
    # å†…å­˜ä½¿ç”¨ç‡
    mem_usage=$(free | grep Mem | awk '{printf "%.1f", $3/$2 * 100.0}')
    echo "  å†…å­˜ä½¿ç”¨ç‡: ${mem_usage}%" >> /var/log/ipv6_performance.log
    
    # ç½‘ç»œç¼“å†²åŒºç»Ÿè®¡
    buffer_stats=$(cat /proc/net/sockstat6 | grep TCP6)
    echo "  IPv6 TCPè¿æ¥: $buffer_stats" >> /var/log/ipv6_performance.log
}
```

### 8.3 æ€§èƒ½åŸºå‡†ä¸ä¼˜åŒ–å»ºè®®


**ğŸ“ˆ æ€§èƒ½åŸºå‡†è¡¨**ï¼š

| æ€§èƒ½æŒ‡æ ‡ | ä¼˜ç§€ | è‰¯å¥½ | ä¸€èˆ¬ | éœ€ä¼˜åŒ– | ä¼˜åŒ–å»ºè®® |
|---------|------|------|------|--------|----------|
| **pingå»¶è¿Ÿ** | <10ms | 10-50ms | 50-100ms | >100ms | æ£€æŸ¥ç½‘ç»œè·¯å¾„ |
| **DNSè§£æ** | <50ms | 50-200ms | 200-500ms | >500ms | ä¼˜åŒ–DNSé…ç½® |
| **NDPè§£æ** | <1ms | 1-5ms | 5-10ms | >10ms | æ£€æŸ¥é“¾è·¯è´¨é‡ |
| **ååé‡** | >800Mbps | 500-800Mbps | 100-500Mbps | <100Mbps | æ£€æŸ¥ç½‘å¡è®¾ç½® |

---

## 9. ğŸš¨ å‘Šè­¦è§„åˆ™é…ç½®ä¸ç®¡ç†


### 9.1 å‘Šè­¦ç³»ç»Ÿæ¶æ„


**ğŸ”” å‘Šè­¦å¤„ç†æµç¨‹**ï¼š

```
æ•°æ®é‡‡é›† â†’ è§„åˆ™åŒ¹é… â†’ å‘Šè­¦è§¦å‘ â†’ é€šçŸ¥å‘é€ â†’ å“åº”å¤„ç†

å‘Šè­¦çº§åˆ«ï¼š
ğŸ”´ ç´§æ€¥ (Critical)  - æœåŠ¡ä¸­æ–­
ğŸŸ¡ è­¦å‘Š (Warning)   - æ€§èƒ½ä¸‹é™  
ğŸŸ¢ ä¿¡æ¯ (Info)      - çŠ¶æ€å˜æ›´
ğŸ”µ è°ƒè¯• (Debug)     - è¯¦ç»†ä¿¡æ¯
```

### 9.2 å‘Šè­¦è§„åˆ™é…ç½®


**âš™ï¸ å‘Šè­¦è§„åˆ™å®šä¹‰**ï¼š

```bash
#!/bin/bash
# IPv6ç›‘æ§å‘Šè­¦è§„åˆ™é…ç½®

setup_alert_rules() {
    local config_file="/etc/ipv6_alerts.conf"
    
    cat > $config_file << 'EOF'
# IPv6ç›‘æ§å‘Šè­¦è§„åˆ™é…ç½®

[connectivity]
# è¿é€šæ€§å‘Šè­¦
ping_failure_threshold=3      # pingå¤±è´¥æ¬¡æ•°é˜ˆå€¼
ping_timeout_threshold=1000   # pingè¶…æ—¶é˜ˆå€¼(ms)
route_missing_critical=yes    # ç¼ºå°‘é»˜è®¤è·¯ç”±æ˜¯å¦ä¸¥é‡

[performance]  
# æ€§èƒ½å‘Šè­¦
latency_warning=100          # å»¶è¿Ÿè­¦å‘Šé˜ˆå€¼(ms)
latency_critical=500         # å»¶è¿Ÿä¸¥é‡é˜ˆå€¼(ms)
packet_loss_warning=1        # ä¸¢åŒ…ç‡è­¦å‘Šé˜ˆå€¼(%)
packet_loss_critical=5       # ä¸¢åŒ…ç‡ä¸¥é‡é˜ˆå€¼(%)

[security]
# å®‰å…¨å‘Šè­¦
ra_source_limit=2            # RAæºæ•°é‡é™åˆ¶
ndp_rate_limit=50            # NDPè¯·æ±‚é¢‘ç‡é™åˆ¶(æ¬¡/åˆ†é’Ÿ)
scan_attempt_limit=20        # æ‰«æå°è¯•é™åˆ¶(æ¬¡/å°æ—¶)

[system]
# ç³»ç»Ÿèµ„æºå‘Šè­¦
cpu_usage_warning=80         # CPUä½¿ç”¨ç‡è­¦å‘Š(%)
memory_usage_warning=90      # å†…å­˜ä½¿ç”¨ç‡è­¦å‘Š(%)
connection_limit_warning=1000 # è¿æ¥æ•°è­¦å‘Šé˜ˆå€¼
EOF
}

# å‘Šè­¦æ£€æŸ¥å‡½æ•°
check_alert_conditions() {
    source /etc/ipv6_alerts.conf
    
    # æ£€æŸ¥è¿é€šæ€§å‘Šè­¦
    check_connectivity_alerts
    
    # æ£€æŸ¥æ€§èƒ½å‘Šè­¦
    check_performance_alerts
    
    # æ£€æŸ¥å®‰å…¨å‘Šè­¦
    check_security_alerts
    
    # æ£€æŸ¥ç³»ç»Ÿå‘Šè­¦
    check_system_alerts
}

check_connectivity_alerts() {
    # æ£€æŸ¥pingè¿é€šæ€§
    if ! ping6 -c 3 2001:4860:4860::8888 >/dev/null 2>&1; then
        send_alert "CRITICAL" "IPv6è¿é€šæ€§å¤±è´¥" "æ— æ³•pingé€šå¤–éƒ¨IPv6åœ°å€"
    fi
    
    # æ£€æŸ¥é»˜è®¤è·¯ç”±
    if ! ip -6 route show | grep -q "default"; then
        send_alert "CRITICAL" "IPv6é»˜è®¤è·¯ç”±ç¼ºå¤±" "ç³»ç»Ÿæ— IPv6é»˜è®¤è·¯ç”±"
    fi
}

send_alert() {
    local level="$1"
    local title="$2" 
    local message="$3"
    local timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    
    # è®°å½•å‘Šè­¦æ—¥å¿—
    echo "[$timestamp] [$level] $title: $message" >> /var/log/ipv6_alerts.log
    
    # å‘é€é‚®ä»¶å‘Šè­¦ï¼ˆå¦‚æœé…ç½®äº†é‚®ä»¶ï¼‰
    if command -v mail >/dev/null; then
        echo "$message" | mail -s "IPv6ç›‘æ§å‘Šè­¦: $title" admin@example.com
    fi
    
    # å‘é€ç³»ç»Ÿé€šçŸ¥
    logger -p daemon.alert "IPv6ç›‘æ§: [$level] $title - $message"
}
```

### 9.3 å‘Šè­¦é€šçŸ¥é…ç½®


**ğŸ“§ å¤šæ¸ é“å‘Šè­¦é€šçŸ¥**ï¼š

```bash
# é…ç½®å¤šç§å‘Šè­¦é€šçŸ¥æ–¹å¼
configure_alert_notifications() {
    
    # é‚®ä»¶é€šçŸ¥é…ç½®
    setup_email_alerts() {
        # å®‰è£…å¹¶é…ç½®postfix
        yum install -y postfix mailx
        systemctl enable postfix
        systemctl start postfix
        
        # é…ç½®é‚®ä»¶åˆ«å
        echo "admin: root@localhost" >> /etc/aliases
        newaliases
    }
    
    # å¾®ä¿¡/é’‰é’‰webhooké€šçŸ¥
    setup_webhook_alerts() {
        cat > /usr/local/bin/send_webhook_alert.sh << 'EOF'
#!/bin/bash
webhook_url="YOUR_WEBHOOK_URL"
message="$1"
level="$2"

curl -X POST $webhook_url \
  -H 'Content-Type: application/json' \
  -d "{
    \"msgtype\": \"text\",
    \"text\": {
      \"content\": \"IPv6ç›‘æ§å‘Šè­¦\\nçº§åˆ«: $level\\nå†…å®¹: $message\\næ—¶é—´: $(date)\"
    }
  }"
EOF
        chmod +x /usr/local/bin/send_webhook_alert.sh
    }
    
    # çŸ­ä¿¡å‘Šè­¦ï¼ˆéœ€è¦çŸ­ä¿¡ç½‘å…³ï¼‰
    setup_sms_alerts() {
        cat > /usr/local/bin/send_sms_alert.sh << 'EOF'
#!/bin/bash
# çŸ­ä¿¡å‘Šè­¦è„šæœ¬ï¼ˆéœ€è¦é…ç½®çŸ­ä¿¡æœåŠ¡å•†æ¥å£ï¼‰
phone_number="$1"
message="$2"

# è¿™é‡Œé›†æˆæ‚¨çš„çŸ­ä¿¡æœåŠ¡å•†API
# curl -X POST "https://sms-api.example.com/send" \
#   -d "phone=$phone_number" \
#   -d "message=$message"
EOF
    }
}
```

### 9.4 å‘Šè­¦æŠ‘åˆ¶ä¸å‡çº§


**ğŸ”„ æ™ºèƒ½å‘Šè­¦ç®¡ç†**ï¼š

```bash
# å‘Šè­¦æŠ‘åˆ¶å’Œå‡çº§æœºåˆ¶
manage_alert_lifecycle() {
    
    # å‘Šè­¦æŠ‘åˆ¶ï¼ˆé¿å…é‡å¤å‘Šè­¦ï¼‰
    suppress_duplicate_alerts() {
        local alert_key="$1"
        local suppress_time=300  # 5åˆ†é’ŸæŠ‘åˆ¶æ—¶é—´
        local last_alert_file="/tmp/last_alert_${alert_key}"
        
        if [ -f $last_alert_file ]; then
            local last_time=$(cat $last_alert_file)
            local current_time=$(date +%s)
            local time_diff=$((current_time - last_time))
            
            if [ $time_diff -lt $suppress_time ]; then
                return 1  # æŠ‘åˆ¶å‘Šè­¦
            fi
        fi
        
        echo $(date +%s) > $last_alert_file
        return 0  # å‘é€å‘Šè­¦
    }
    
    # å‘Šè­¦å‡çº§ï¼ˆé•¿æ—¶é—´æœªè§£å†³çš„å‘Šè­¦ï¼‰
    escalate_unresolved_alerts() {
        local alert_file="/var/log/unresolved_alerts.log"
        local escalation_time=3600  # 1å°æ—¶åå‡çº§
        
        while read line; do
            local alert_time=$(echo $line | awk '{print $1}')
            local current_time=$(date +%s)
            local time_diff=$((current_time - alert_time))
            
            if [ $time_diff -gt $escalation_time ]; then
                send_escalated_alert "$line"
            fi
        done < $alert_file
    }
}
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


ğŸ”¸ **åŒæ ˆç›‘æ§æœ¬è´¨**ï¼šåŒæ—¶ç›‘æ§IPv4å’ŒIPv6åè®®çš„ç»Ÿä¸€ç®¡ç†ä½“ç³»  
ğŸ”¸ **ç›‘æ§ç»´åº¦**ï¼šè¿æ¥çŠ¶æ€ã€æµé‡ç»Ÿè®¡ã€åœ°å€ä½¿ç”¨ã€åè®®æ—¥å¿—ã€å®‰å…¨äº‹ä»¶  
ğŸ”¸ **å…³é”®åè®®**ï¼šNDPé‚»å±…å‘ç°ã€RAè·¯ç”±å™¨é€šå‘Šã€SLAACåœ°å€é…ç½®  
ğŸ”¸ **æ€§èƒ½æŒ‡æ ‡**ï¼šå»¶è¿Ÿã€ååé‡ã€ä¸¢åŒ…ç‡ã€DNSè§£ææ—¶é—´  
ğŸ”¸ **å‘Šè­¦æœºåˆ¶**ï¼šå¤šçº§åˆ«å‘Šè­¦ã€æ™ºèƒ½æŠ‘åˆ¶ã€è‡ªåŠ¨å“åº”

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆéœ€è¦åŒæ ˆç›‘æ§**
```
ä¼ ç»ŸIPv4ç›‘æ§çš„å±€é™ï¼š
- æ— æ³•ç›‘æ§IPv6ç‰¹æœ‰çš„åè®®è¡Œä¸º
- å¿½ç•¥äº†åŒæ ˆç¯å¢ƒçš„åè®®äº¤äº’
- ç¼ºä¹IPv6å®‰å…¨å¨èƒæ£€æµ‹

åŒæ ˆç›‘æ§çš„ä»·å€¼ï¼š
- åè®®åè°ƒï¼šç¡®ä¿IPv4/IPv6å’Œè°å…±å­˜
- æ€§èƒ½ä¼˜åŒ–ï¼šå‘ç°å¹¶è§£å†³åŒæ ˆæ€§èƒ½é—®é¢˜  
- å®‰å…¨é˜²æŠ¤ï¼šæ£€æµ‹IPv6ç‰¹æœ‰çš„å®‰å…¨å¨èƒ
- æ•…éšœé¢„é˜²ï¼šæå‰å‘ç°æ½œåœ¨é—®é¢˜
```

**ğŸ”¹ ç›‘æ§é‡ç‚¹çš„ä¼˜å…ˆçº§**
```
ä¸€çº§ç›‘æ§ï¼ˆå¿…é¡»ï¼‰ï¼š
âœ… IPv6è¿é€šæ€§çŠ¶æ€
âœ… é»˜è®¤è·¯ç”±å¯ç”¨æ€§
âœ… DNSè§£æåŠŸèƒ½
âœ… å®‰å…¨å¨èƒæ£€æµ‹

äºŒçº§ç›‘æ§ï¼ˆé‡è¦ï¼‰ï¼š
ğŸ“Š æµé‡åˆ†å¸ƒç»Ÿè®¡
ğŸ“Š æ€§èƒ½æŒ‡æ ‡è¶‹åŠ¿
ğŸ“Š åœ°å€ä½¿ç”¨æƒ…å†µ
ğŸ“Š è·¯ç”±è¡¨å˜åŒ–

ä¸‰çº§ç›‘æ§ï¼ˆè¡¥å……ï¼‰ï¼š
ğŸ“ˆ è¯¦ç»†åè®®ç»Ÿè®¡
ğŸ“ˆ å†å²è¶‹åŠ¿åˆ†æ
ğŸ“ˆ å®¹é‡è§„åˆ’æ•°æ®
```

**ğŸ”¹ æ•…éšœå¤„ç†çš„æ€è·¯**
```
æ•…éšœè¯Šæ–­æ­¥éª¤ï¼š
1. è¿é€šæ€§æµ‹è¯• â†’ ping6ã€traceroute6
2. é…ç½®æ£€æŸ¥ â†’ åœ°å€ã€è·¯ç”±ã€DNS
3. åè®®åˆ†æ â†’ NDPã€RAæ¶ˆæ¯
4. å®‰å…¨æ£€æŸ¥ â†’ é˜²ç«å¢™ã€æ”»å‡»æ£€æµ‹
5. æ€§èƒ½åˆ†æ â†’ å»¶è¿Ÿã€ååé‡

å¸¸è§é—®é¢˜è§£å†³ï¼š
è¿æ¥å¤±è´¥ â†’ æ£€æŸ¥ç‰©ç†è¿æ¥å’Œé…ç½®
è§£æè¶…æ—¶ â†’ æ£€æŸ¥DNSæœåŠ¡å™¨è®¾ç½®  
è·¯ç”±å¼‚å¸¸ â†’ æ£€æŸ¥è·¯ç”±å™¨é€šå‘Š
å®‰å…¨å‘Šè­¦ â†’ å¯ç”¨é˜²æŠ¤æªæ–½
```

### 10.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ éƒ¨ç½²å»ºè®®**
- **ç›‘æ§å·¥å…·é€‰æ‹©**ï¼šç»“åˆç³»ç»Ÿè‡ªå¸¦å·¥å…·å’Œç¬¬ä¸‰æ–¹ç›‘æ§è½¯ä»¶
- **æ—¥å¿—ç®¡ç†**ï¼šåˆç†è®¾ç½®æ—¥å¿—çº§åˆ«ï¼Œå®šæœŸæ¸…ç†å†å²æ—¥å¿—
- **å‘Šè­¦é…ç½®**ï¼šæ ¹æ®ä¸šåŠ¡é‡è¦æ€§è®¾ç½®ä¸åŒçº§åˆ«çš„å‘Šè­¦é˜ˆå€¼
- **è‡ªåŠ¨åŒ–ç¨‹åº¦**ï¼šä»æ‰‹åŠ¨æ£€æŸ¥é€æ­¥å‘è‡ªåŠ¨ç›‘æ§å’Œå“åº”å‘å±•

**ğŸ”§ æœ€ä½³å®è·µ**
- **ç›‘æ§è¦†ç›–**ï¼šç¡®ä¿ç›‘æ§è¦†ç›–æ‰€æœ‰å…³é”®IPv6åŠŸèƒ½
- **æ•°æ®ä¿ç•™**ï¼šä¿ç•™è¶³å¤Ÿçš„å†å²æ•°æ®ç”¨äºè¶‹åŠ¿åˆ†æ
- **å‘Šè­¦ä¼˜åŒ–**ï¼šé¿å…å‘Šè­¦é£æš´ï¼Œå®æ–½æ™ºèƒ½å‘Šè­¦æŠ‘åˆ¶
- **æ–‡æ¡£ç»´æŠ¤**ï¼šä¿æŒç›‘æ§è„šæœ¬å’Œé…ç½®çš„æ–‡æ¡£æ›´æ–°

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- åŒæ ˆç›‘æ§å››è¦ç´ ï¼šè¿é€šæµé‡åœ°å€å®‰å…¨
- NDPæ˜¯å…³é”®åè®®ï¼šé‚»å±…å‘ç°è·¯ç”±é€šå‘Š
- å‘Šè­¦åˆ†çº§å¾ˆé‡è¦ï¼šç´§æ€¥è­¦å‘Šä¿¡æ¯è°ƒè¯•
- è‡ªåŠ¨å“åº”æ˜¯è¶‹åŠ¿ï¼šç›‘æ§å‘ç°å¤„ç†ä¼˜åŒ–