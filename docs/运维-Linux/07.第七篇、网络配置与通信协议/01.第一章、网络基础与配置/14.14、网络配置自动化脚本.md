---
title: 14ã€ç½‘ç»œé…ç½®è‡ªåŠ¨åŒ–è„šæœ¬
---
## ğŸ“š ç›®å½•

1. [ç½‘ç»œé…ç½®è‡ªåŠ¨åŒ–æ¦‚è¿°](#1-ç½‘ç»œé…ç½®è‡ªåŠ¨åŒ–æ¦‚è¿°)
2. [ç½‘ç»œé…ç½®è„šæœ¬ç¼–å†™åŸºç¡€](#2-ç½‘ç»œé…ç½®è„šæœ¬ç¼–å†™åŸºç¡€)
3. [æ‰¹é‡ç½‘ç»œæ¥å£é…ç½®](#3-æ‰¹é‡ç½‘ç»œæ¥å£é…ç½®)
4. [ç½‘ç»œé…ç½®æ¨¡æ¿åŒ–ç®¡ç†](#4-ç½‘ç»œé…ç½®æ¨¡æ¿åŒ–ç®¡ç†)
5. [é…ç½®éªŒè¯ä¸æµ‹è¯•è„šæœ¬](#5-é…ç½®éªŒè¯ä¸æµ‹è¯•è„šæœ¬)
6. [ç½‘ç»œç¯å¢ƒå¿«é€Ÿéƒ¨ç½²](#6-ç½‘ç»œç¯å¢ƒå¿«é€Ÿéƒ¨ç½²)
7. [é…ç½®å›æ»šä¸æ¢å¤æœºåˆ¶](#7-é…ç½®å›æ»šä¸æ¢å¤æœºåˆ¶)
8. [ç½‘ç»œé…ç½®ç‰ˆæœ¬ç®¡ç†](#8-ç½‘ç»œé…ç½®ç‰ˆæœ¬ç®¡ç†)
9. [è‡ªåŠ¨åŒ–éƒ¨ç½²æœ€ä½³å®è·µ](#9-è‡ªåŠ¨åŒ–éƒ¨ç½²æœ€ä½³å®è·µ)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ ç½‘ç»œé…ç½®è‡ªåŠ¨åŒ–æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯ç½‘ç»œé…ç½®è‡ªåŠ¨åŒ–


**é€šä¿—ç†è§£**ï¼šç½‘ç»œé…ç½®è‡ªåŠ¨åŒ–å°±åƒæ˜¯ç»™ç½‘ç»œç®¡ç†å‘˜é…å¤‡äº†ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ï¼Œèƒ½å¤Ÿè‡ªåŠ¨å®ŒæˆåŸæœ¬éœ€è¦æ‰‹å·¥æ“ä½œçš„ç½‘ç»œé…ç½®ä»»åŠ¡ã€‚

```
æ‰‹å·¥é…ç½®æ¨¡å¼ï¼š
ç®¡ç†å‘˜ â†’ ä¸€å°ä¸€å°æœåŠ¡å™¨ â†’ é€ä¸ªé…ç½®ç½‘ç»œ â†’ å®¹æ˜“å‡ºé”™ä¸”è€—æ—¶

è‡ªåŠ¨åŒ–é…ç½®æ¨¡å¼ï¼š
ç®¡ç†å‘˜ â†’ ç¼–å†™è„šæœ¬ â†’ æ‰¹é‡æ‰§è¡Œ â†’ å¿«é€Ÿå‡†ç¡®å®Œæˆé…ç½®
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦ç½‘ç»œé…ç½®è‡ªåŠ¨åŒ–


**ğŸ”¥ è§£å†³çš„æ ¸å¿ƒé—®é¢˜**ï¼š

- **â±ï¸ æ•ˆç‡é—®é¢˜**ï¼šæ‰‹å·¥é…ç½®100å°æœåŠ¡å™¨éœ€è¦å‡ å¤©ï¼Œè„šæœ¬é…ç½®åªéœ€å‡ åˆ†é’Ÿ
- **âŒ é”™è¯¯ç‡é«˜**ï¼šäººå·¥æ“ä½œå®¹æ˜“è¾“é”™IPã€ç½‘å…³ç­‰å…³é”®ä¿¡æ¯
- **ğŸ”„ é‡å¤åŠ³åŠ¨**ï¼šç›¸åŒçš„é…ç½®æ“ä½œé‡å¤æ‰§è¡Œï¼Œæµªè´¹äººåŠ›
- **ğŸ“ˆ è§„æ¨¡æŒ‘æˆ˜**ï¼šæœåŠ¡å™¨æ•°é‡å¢é•¿ï¼Œæ‰‹å·¥é…ç½®å˜å¾—ä¸ç°å®

### 1.3 è‡ªåŠ¨åŒ–å¸¦æ¥çš„ä»·å€¼


**ğŸ’ æ ¸å¿ƒæ”¶ç›Š**ï¼š
```
æ—¶é—´èŠ‚çœï¼š10å°æœåŠ¡å™¨é…ç½®ä»2å°æ—¶ç¼©çŸ­åˆ°5åˆ†é’Ÿ
é”™è¯¯å‡å°‘ï¼šé…ç½®é”™è¯¯ç‡ä»20%é™ä½åˆ°æ¥è¿‘0%
æ ‡å‡†åŒ–ï¼šæ‰€æœ‰æœåŠ¡å™¨ä½¿ç”¨ç»Ÿä¸€çš„é…ç½®æ ‡å‡†
å¯è¿½æº¯ï¼šæ¯æ¬¡é…ç½®å˜æ›´éƒ½æœ‰è®°å½•å’Œç‰ˆæœ¬æ§åˆ¶
```

---

## 2. âœï¸ ç½‘ç»œé…ç½®è„šæœ¬ç¼–å†™åŸºç¡€


### 2.1 è„šæœ¬ç¼–å†™çš„åŸºæœ¬æ€è·¯


**ğŸ“ ç¼–å†™é€»è¾‘**ï¼š
1. **ğŸ“‹ éœ€æ±‚åˆ†æ** â†’ æ˜ç¡®è¦é…ç½®ä»€ä¹ˆç½‘ç»œå‚æ•°
2. **ğŸ§ª æµ‹è¯•éªŒè¯** â†’ å…ˆåœ¨å•å°æœºå™¨ä¸Šæµ‹è¯•é…ç½®å‘½ä»¤
3. **ğŸ“œ è„šæœ¬ç¼–å†™** â†’ å°†å‘½ä»¤ç»„ç»‡æˆå¯é‡å¤æ‰§è¡Œçš„è„šæœ¬
4. **ğŸ” é”™è¯¯å¤„ç†** â†’ æ·»åŠ å¼‚å¸¸æƒ…å†µçš„å¤„ç†é€»è¾‘

### 2.2 åŸºç¡€é…ç½®è„šæœ¬ç¤ºä¾‹


**ğŸ”§ ç®€å•çš„IPé…ç½®è„šæœ¬**ï¼š
```bash
#!/bin/bash
# ç½‘ç»œæ¥å£é…ç½®è„šæœ¬

# å®šä¹‰ç½‘ç»œå‚æ•°ï¼ˆè¿™äº›æ˜¯é…ç½®å˜é‡ï¼‰
INTERFACE="eth0"
IP_ADDRESS="192.168.1.100"
NETMASK="255.255.255.0"
GATEWAY="192.168.1.1"

# é…ç½®IPåœ°å€
ifconfig $INTERFACE $IP_ADDRESS netmask $NETMASK up

# é…ç½®é»˜è®¤ç½‘å…³
route add default gw $GATEWAY
```

**ğŸ” è„šæœ¬è§£è¯»**ï¼š
- `INTERFACE`ï¼šç½‘ç»œæ¥å£åç§°ï¼Œå°±æ˜¯ç½‘å¡çš„åå­—
- `IP_ADDRESS`ï¼šè¦åˆ†é…ç»™è¿™å°æœºå™¨çš„IPåœ°å€
- `NETMASK`ï¼šå­ç½‘æ©ç ï¼Œå†³å®šç½‘ç»œèŒƒå›´
- `GATEWAY`ï¼šç½‘å…³åœ°å€ï¼Œè®¿é—®å¤–éƒ¨ç½‘ç»œçš„å‡ºå£

### 2.3 å¢å¼ºç‰ˆé…ç½®è„šæœ¬


**âš¡ å¸¦é”™è¯¯æ£€æŸ¥çš„é…ç½®è„šæœ¬**ï¼š
```bash
#!/bin/bash
# å¢å¼ºç‰ˆç½‘ç»œé…ç½®è„šæœ¬

set -e  # é‡åˆ°é”™è¯¯ç«‹å³é€€å‡º

# æ£€æŸ¥æ˜¯å¦ä»¥rootæƒé™è¿è¡Œ
if [ $EUID -ne 0 ]; then
    echo "âŒ æ­¤è„šæœ¬éœ€è¦rootæƒé™è¿è¡Œ"
    exit 1
fi

# é…ç½®å‡½æ•°
configure_network() {
    local interface=$1
    local ip=$2
    local netmask=$3
    local gateway=$4
    
    echo "ğŸ”§ æ­£åœ¨é…ç½®ç½‘ç»œæ¥å£ $interface..."
    
    # é…ç½®IPåœ°å€
    if ifconfig $interface $ip netmask $netmask up; then
        echo "âœ… IPåœ°å€é…ç½®æˆåŠŸï¼š$ip"
    else
        echo "âŒ IPåœ°å€é…ç½®å¤±è´¥"
        return 1
    fi
    
    # é…ç½®ç½‘å…³
    if route add default gw $gateway 2>/dev/null; then
        echo "âœ… ç½‘å…³é…ç½®æˆåŠŸï¼š$gateway"
    else
        echo "âš ï¸ ç½‘å…³å¯èƒ½å·²å­˜åœ¨ï¼Œè·³è¿‡é…ç½®"
    fi
}

# æ‰§è¡Œé…ç½®
configure_network "eth0" "192.168.1.100" "255.255.255.0" "192.168.1.1"
```

---

## 3. ğŸ”„ æ‰¹é‡ç½‘ç»œæ¥å£é…ç½®


### 3.1 ä»€ä¹ˆæ˜¯æ‰¹é‡é…ç½®


**ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µ**ï¼šæ‰¹é‡é…ç½®å°±æ˜¯ä¸€æ¬¡æ€§å¯¹å¤šä¸ªç½‘ç»œæ¥å£æˆ–å¤šå°æœåŠ¡å™¨è¿›è¡Œç›¸åŒç±»å‹çš„ç½‘ç»œé…ç½®ã€‚

**ğŸ“Š åº”ç”¨åœºæ™¯å¯¹æ¯”**ï¼š

| åœºæ™¯ç±»å‹ | **æ‰‹å·¥é…ç½®** | **æ‰¹é‡é…ç½®** | **æ•ˆç‡æå‡** |
|---------|------------|------------|------------|
| å•å°æœåŠ¡å™¨ | `5åˆ†é’Ÿ` | `1åˆ†é’Ÿ` | `5å€` |
| 10å°æœåŠ¡å™¨ | `50åˆ†é’Ÿ` | `3åˆ†é’Ÿ` | `17å€` |
| 100å°æœåŠ¡å™¨ | `8å°æ—¶` | `10åˆ†é’Ÿ` | `48å€` |

### 3.2 æ‰¹é‡é…ç½®çš„å®ç°æ–¹å¼


**ğŸ”¸ é…ç½®æ–‡ä»¶é©±åŠ¨**ï¼š
```bash
#!/bin/bash
# åŸºäºé…ç½®æ–‡ä»¶çš„æ‰¹é‡ç½‘ç»œé…ç½®

# æœåŠ¡å™¨åˆ—è¡¨æ–‡ä»¶æ ¼å¼ï¼šä¸»æœºå,IPåœ°å€,ç½‘å…³
# server01,192.168.1.10,192.168.1.1
# server02,192.168.1.11,192.168.1.1

CONFIG_FILE="servers.txt"

while IFS=',' read -r hostname ip gateway; do
    echo "ğŸ”§ é…ç½®æœåŠ¡å™¨ï¼š$hostname"
    
    # SSHåˆ°è¿œç¨‹æœåŠ¡å™¨æ‰§è¡Œé…ç½®
    ssh root@$hostname "
        ifconfig eth0 $ip netmask 255.255.255.0 up
        route add default gw $gateway
        echo 'âœ… $hostname é…ç½®å®Œæˆ'
    "
done < $CONFIG_FILE
```

**ğŸ”¸ å¾ªç¯æ‰¹é‡é…ç½®**ï¼š
```bash
#!/bin/bash
# å¾ªç¯æ–¹å¼æ‰¹é‡é…ç½®å¤šä¸ªæ¥å£

# å®šä¹‰è¦é…ç½®çš„ç½‘ç»œæ¥å£æ•°ç»„
INTERFACES=("eth0" "eth1" "eth2")
BASE_IP="192.168"

for i in "${!INTERFACES[@]}"; do
    interface=${INTERFACES[$i]}
    # ä¸ºæ¯ä¸ªæ¥å£åˆ†é…ä¸åŒç½‘æ®µçš„IP
    subnet=$((i + 1))
    ip="$BASE_IP.$subnet.10"
    
    echo "ğŸ”§ é…ç½®æ¥å£ $interfaceï¼ŒIPï¼š$ip"
    ifconfig $interface $ip netmask 255.255.255.0 up
done
```

### 3.3 æ‰¹é‡é…ç½®çš„é”™è¯¯å¤„ç†


**âš ï¸ é”™è¯¯å¤„ç†æœºåˆ¶**ï¼š
```bash
#!/bin/bash
# å¸¦å®Œå–„é”™è¯¯å¤„ç†çš„æ‰¹é‡é…ç½®

LOG_FILE="/var/log/network_config.log"
SUCCESS_COUNT=0
FAILED_COUNT=0

configure_server() {
    local server=$1
    local ip=$2
    
    echo "$(date): å¼€å§‹é…ç½® $server" >> $LOG_FILE
    
    if ping -c 1 $server &> /dev/null; then
        # æœåŠ¡å™¨å¯è¾¾ï¼Œæ‰§è¡Œé…ç½®
        if ssh root@$server "ifconfig eth0 $ip netmask 255.255.255.0 up"; then
            echo "âœ… $server é…ç½®æˆåŠŸ"
            ((SUCCESS_COUNT++))
        else
            echo "âŒ $server é…ç½®å¤±è´¥"
            ((FAILED_COUNT++))
        fi
    else
        echo "âŒ $server æ— æ³•è¿æ¥"
        ((FAILED_COUNT++))
    fi
}

# æ‰¹é‡é…ç½®æ‰§è¡Œ
# ... é…ç½®é€»è¾‘ ...

# è¾“å‡ºç»Ÿè®¡ç»“æœ
echo "ğŸ“Š æ‰¹é‡é…ç½®å®Œæˆï¼š"
echo "   æˆåŠŸï¼š$SUCCESS_COUNT å°"
echo "   å¤±è´¥ï¼š$FAILED_COUNT å°"
```

---

## 4. ğŸ“‹ ç½‘ç»œé…ç½®æ¨¡æ¿åŒ–ç®¡ç†


### 4.1 ä»€ä¹ˆæ˜¯é…ç½®æ¨¡æ¿åŒ–


**ğŸ¯ æ ¸å¿ƒæ€æƒ³**ï¼šæ¨¡æ¿åŒ–å°±æ˜¯å°†ç½‘ç»œé…ç½®æ ‡å‡†åŒ–ï¼Œåˆ›å»ºå¯é‡å¤ä½¿ç”¨çš„é…ç½®"æ¨¡æ¿"ï¼Œå°±åƒå¡«ç©ºé¢˜ä¸€æ ·ï¼Œåªéœ€è¦å¡«å…¥ä¸åŒçš„å‚æ•°å€¼ã€‚

**ğŸ”„ æ¨¡æ¿åŒ–æµç¨‹**ï¼š
```
æ ‡å‡†æ¨¡æ¿ + å‚æ•°å˜é‡ = å…·ä½“é…ç½®
   â†“
å¤ç”¨æ¨¡æ¿ + ä¸åŒå‚æ•° = æ‰¹é‡é…ç½®
```

### 4.2 æ¨¡æ¿æ–‡ä»¶è®¾è®¡


**ğŸ“ ç½‘ç»œé…ç½®æ¨¡æ¿ç¤ºä¾‹**ï¼š
```bash
# ç½‘ç»œé…ç½®æ¨¡æ¿æ–‡ä»¶ï¼šnetwork_template.conf
# ä½¿ç”¨ {{å˜é‡å}} æ ‡è®°éœ€è¦æ›¿æ¢çš„éƒ¨åˆ†

INTERFACE={{INTERFACE_NAME}}
IPADDR={{IP_ADDRESS}}
NETMASK={{SUBNET_MASK}}
GATEWAY={{GATEWAY_IP}}
DNS1={{DNS_SERVER1}}
DNS2={{DNS_SERVER2}}
ONBOOT=yes
BOOTPROTO=static
```

**ğŸ”§ æ¨¡æ¿å¤„ç†è„šæœ¬**ï¼š
```bash
#!/bin/bash
# æ¨¡æ¿å¤„ç†è„šæœ¬

generate_config() {
    local template_file=$1
    local output_file=$2
    
    # ä»æ¨¡æ¿ç”Ÿæˆå…·ä½“é…ç½®æ–‡ä»¶
    sed -e "s/{{INTERFACE_NAME}}/$INTERFACE/g" \
        -e "s/{{IP_ADDRESS}}/$IP/g" \
        -e "s/{{SUBNET_MASK}}/$NETMASK/g" \
        -e "s/{{GATEWAY_IP}}/$GATEWAY/g" \
        -e "s/{{DNS_SERVER1}}/$DNS1/g" \
        -e "s/{{DNS_SERVER2}}/$DNS2/g" \
        $template_file > $output_file
    
    echo "âœ… é…ç½®æ–‡ä»¶ç”Ÿæˆå®Œæˆï¼š$output_file"
}

# è®¾ç½®å‚æ•°
INTERFACE="eth0"
IP="192.168.1.100"
NETMASK="255.255.255.0"
GATEWAY="192.168.1.1"
DNS1="8.8.8.8"
DNS2="8.8.4.4"

# ç”Ÿæˆé…ç½®æ–‡ä»¶
generate_config "network_template.conf" "/etc/sysconfig/network-scripts/ifcfg-eth0"
```

### 4.3 å¤šç¯å¢ƒæ¨¡æ¿ç®¡ç†


**ğŸŒ ç¯å¢ƒåˆ†ç±»ç®¡ç†**ï¼š
```
é¡¹ç›®ç»“æ„ï¼š
network_templates/
â”œâ”€â”€ production/          # ç”Ÿäº§ç¯å¢ƒæ¨¡æ¿
â”‚   â”œâ”€â”€ web_server.conf
â”‚   â””â”€â”€ database.conf
â”œâ”€â”€ testing/            # æµ‹è¯•ç¯å¢ƒæ¨¡æ¿
â”‚   â”œâ”€â”€ web_server.conf
â”‚   â””â”€â”€ database.conf
â””â”€â”€ development/        # å¼€å‘ç¯å¢ƒæ¨¡æ¿
    â”œâ”€â”€ web_server.conf
    â””â”€â”€ database.conf
```

**ğŸ”„ ç¯å¢ƒåˆ‡æ¢è„šæœ¬**ï¼š
```bash
#!/bin/bash
# ç¯å¢ƒåˆ‡æ¢é…ç½®è„šæœ¬

ENVIRONMENT=$1  # production, testing, development
SERVER_TYPE=$2  # web_server, database

if [ -z "$ENVIRONMENT" ] || [ -z "$SERVER_TYPE" ]; then
    echo "ç”¨æ³•: $0 <ç¯å¢ƒ> <æœåŠ¡å™¨ç±»å‹>"
    echo "ç¯å¢ƒ: production | testing | development"
    echo "ç±»å‹: web_server | database"
    exit 1
fi

TEMPLATE_DIR="network_templates/$ENVIRONMENT"
TEMPLATE_FILE="$TEMPLATE_DIR/$SERVER_TYPE.conf"

if [ -f "$TEMPLATE_FILE" ]; then
    echo "ğŸ”§ ä½¿ç”¨æ¨¡æ¿ï¼š$TEMPLATE_FILE"
    # åº”ç”¨æ¨¡æ¿é…ç½®
    apply_template "$TEMPLATE_FILE"
else
    echo "âŒ æ¨¡æ¿æ–‡ä»¶ä¸å­˜åœ¨ï¼š$TEMPLATE_FILE"
    exit 1
fi
```

---

## 5. ğŸ§ª é…ç½®éªŒè¯ä¸æµ‹è¯•è„šæœ¬


### 5.1 ä¸ºä»€ä¹ˆéœ€è¦é…ç½®éªŒè¯


**âš ï¸ é…ç½®é£é™©**ï¼šç½‘ç»œé…ç½®é”™è¯¯å¯èƒ½å¯¼è‡´ï¼š
- æœåŠ¡å™¨å¤±è”ï¼Œæ— æ³•è¿œç¨‹ç®¡ç†
- ç½‘ç»œæœåŠ¡ä¸­æ–­ï¼Œå½±å“ä¸šåŠ¡
- å®‰å…¨æ¼æ´ï¼Œç½‘ç»œè®¿é—®æ§åˆ¶å¤±æ•ˆ

**âœ… éªŒè¯çš„ä»·å€¼**ï¼šåœ¨é…ç½®ç”Ÿæ•ˆå‰å‘ç°é—®é¢˜ï¼Œé¿å…ç½‘ç»œæ•…éšœã€‚

### 5.2 åŸºç¡€éªŒè¯è„šæœ¬


**ğŸ” ç½‘ç»œè¿é€šæ€§éªŒè¯**ï¼š
```bash
#!/bin/bash
# ç½‘ç»œé…ç½®éªŒè¯è„šæœ¬

verify_network_config() {
    local interface=$1
    local expected_ip=$2
    local gateway=$3
    
    echo "ğŸ” éªŒè¯ç½‘ç»œé…ç½®..."
    
    # æ£€æŸ¥æ¥å£æ˜¯å¦å¯ç”¨
    if ip link show $interface | grep -q "state UP"; then
        echo "âœ… ç½‘ç»œæ¥å£ $interface å·²å¯ç”¨"
    else
        echo "âŒ ç½‘ç»œæ¥å£ $interface æœªå¯ç”¨"
        return 1
    fi
    
    # æ£€æŸ¥IPåœ°å€æ˜¯å¦æ­£ç¡®
    current_ip=$(ip addr show $interface | grep 'inet ' | awk '{print $2}' | cut -d'/' -f1)
    if [ "$current_ip" = "$expected_ip" ]; then
        echo "âœ… IPåœ°å€é…ç½®æ­£ç¡®ï¼š$current_ip"
    else
        echo "âŒ IPåœ°å€é…ç½®é”™è¯¯ï¼ŒæœŸæœ›ï¼š$expected_ipï¼Œå®é™…ï¼š$current_ip"
        return 1
    fi
    
    # æ£€æŸ¥ç½‘å…³è¿é€šæ€§
    if ping -c 3 $gateway &> /dev/null; then
        echo "âœ… ç½‘å…³è¿é€šæ­£å¸¸ï¼š$gateway"
    else
        echo "âŒ ç½‘å…³æ— æ³•è¿é€šï¼š$gateway"
        return 1
    fi
    
    echo "ğŸ‰ ç½‘ç»œé…ç½®éªŒè¯é€šè¿‡"
    return 0
}

# æ‰§è¡ŒéªŒè¯
verify_network_config "eth0" "192.168.1.100" "192.168.1.1"
```

### 5.3 ç»¼åˆæµ‹è¯•è„šæœ¬


**ğŸ§ª å®Œæ•´çš„ç½‘ç»œæµ‹è¯•**ï¼š
```bash
#!/bin/bash
# ç»¼åˆç½‘ç»œæµ‹è¯•è„šæœ¬

run_network_tests() {
    echo "ğŸ§ª å¼€å§‹ç½‘ç»œé…ç½®æµ‹è¯•..."
    
    local test_results=()
    
    # æµ‹è¯•1ï¼šæœ¬åœ°ç½‘ç»œé…ç½®
    echo "ğŸ“‹ æµ‹è¯•1ï¼šæœ¬åœ°ç½‘ç»œé…ç½®æ£€æŸ¥"
    if check_local_config; then
        test_results+=("æœ¬åœ°é…ç½®ï¼šâœ…")
    else
        test_results+=("æœ¬åœ°é…ç½®ï¼šâŒ")
    fi
    
    # æµ‹è¯•2ï¼šç½‘å…³è¿é€šæ€§
    echo "ğŸ“‹ æµ‹è¯•2ï¼šç½‘å…³è¿é€šæ€§æ£€æŸ¥"
    if test_gateway_connectivity; then
        test_results+=("ç½‘å…³è¿é€šï¼šâœ…")
    else
        test_results+=("ç½‘å…³è¿é€šï¼šâŒ")
    fi
    
    # æµ‹è¯•3ï¼šDNSè§£æ
    echo "ğŸ“‹ æµ‹è¯•3ï¼šDNSè§£ææ£€æŸ¥"
    if test_dns_resolution; then
        test_results+=("DNSè§£æï¼šâœ…")
    else
        test_results+=("DNSè§£æï¼šâŒ")
    fi
    
    # æµ‹è¯•4ï¼šå¤–ç½‘è¿é€šæ€§
    echo "ğŸ“‹ æµ‹è¯•4ï¼šå¤–ç½‘è¿é€šæ€§æ£€æŸ¥"
    if test_internet_connectivity; then
        test_results+=("å¤–ç½‘è¿é€šï¼šâœ…")
    else
        test_results+=("å¤–ç½‘è¿é€šï¼šâŒ")
    fi
    
    # è¾“å‡ºæµ‹è¯•ç»“æœ
    echo "ğŸ“Š æµ‹è¯•ç»“æœæ±‡æ€»ï¼š"
    for result in "${test_results[@]}"; do
        echo "   $result"
    done
}

check_local_config() {
    # æ£€æŸ¥ç½‘ç»œæ¥å£é…ç½®
    ip addr show | grep -q "inet.*eth0" && return 0 || return 1
}

test_gateway_connectivity() {
    # æµ‹è¯•ç½‘å…³è¿é€šæ€§
    local gateway=$(ip route | grep default | awk '{print $3}')
    ping -c 2 $gateway &> /dev/null
}

test_dns_resolution() {
    # æµ‹è¯•DNSè§£æ
    nslookup google.com &> /dev/null
}

test_internet_connectivity() {
    # æµ‹è¯•å¤–ç½‘è¿é€šæ€§
    ping -c 2 8.8.8.8 &> /dev/null
}

# æ‰§è¡Œç»¼åˆæµ‹è¯•
run_network_tests
```

---

## 6. âš¡ ç½‘ç»œç¯å¢ƒå¿«é€Ÿéƒ¨ç½²


### 6.1 å¿«é€Ÿéƒ¨ç½²çš„æ ¸å¿ƒæ€æƒ³


**ğŸš€ å¿«é€Ÿéƒ¨ç½²ç›®æ ‡**ï¼šä»é›¶å¼€å§‹ï¼Œåœ¨æœ€çŸ­æ—¶é—´å†…å»ºç«‹å®Œæ•´çš„ç½‘ç»œç¯å¢ƒã€‚

**ğŸ“ˆ éƒ¨ç½²æµç¨‹**ï¼š
```
ç¯å¢ƒè§„åˆ’ â†’ é…ç½®ç”Ÿæˆ â†’ æ‰¹é‡éƒ¨ç½² â†’ éªŒè¯æµ‹è¯• â†’ æœåŠ¡å¯åŠ¨
    â†“         â†“         â†“         â†“         â†“
  5åˆ†é’Ÿ     2åˆ†é’Ÿ     3åˆ†é’Ÿ     2åˆ†é’Ÿ     1åˆ†é’Ÿ
```

### 6.2 ä¸€é”®éƒ¨ç½²è„šæœ¬


**ğŸ¯ å®Œæ•´éƒ¨ç½²è„šæœ¬**ï¼š
```bash
#!/bin/bash
# ç½‘ç»œç¯å¢ƒä¸€é”®éƒ¨ç½²è„šæœ¬

DEPLOYMENT_LOG="/var/log/network_deployment.log"

log_message() {
    echo "$(date '+%Y-%m-%d %H:%M:%S'): $1" | tee -a $DEPLOYMENT_LOG
}

deploy_network_environment() {
    log_message "ğŸš€ å¼€å§‹ç½‘ç»œç¯å¢ƒéƒ¨ç½²"
    
    # é˜¶æ®µ1ï¼šç¯å¢ƒæ£€æŸ¥
    log_message "ğŸ“‹ é˜¶æ®µ1ï¼šç¯å¢ƒæ£€æŸ¥"
    if ! check_prerequisites; then
        log_message "âŒ ç¯å¢ƒæ£€æŸ¥å¤±è´¥ï¼Œéƒ¨ç½²ä¸­æ­¢"
        exit 1
    fi
    
    # é˜¶æ®µ2ï¼šç½‘ç»œé…ç½®
    log_message "ğŸ”§ é˜¶æ®µ2ï¼šç½‘ç»œé…ç½®"
    configure_network_interfaces
    
    # é˜¶æ®µ3ï¼šæœåŠ¡é…ç½®
    log_message "âš™ï¸ é˜¶æ®µ3ï¼šæœåŠ¡é…ç½®"
    configure_network_services
    
    # é˜¶æ®µ4ï¼šéªŒè¯æµ‹è¯•
    log_message "ğŸ§ª é˜¶æ®µ4ï¼šéªŒè¯æµ‹è¯•"
    if verify_deployment; then
        log_message "âœ… ç½‘ç»œç¯å¢ƒéƒ¨ç½²æˆåŠŸ"
    else
        log_message "âŒ éƒ¨ç½²éªŒè¯å¤±è´¥"
        exit 1
    fi
}

check_prerequisites() {
    # æ£€æŸ¥å¿…è¦çš„å·¥å…·å’Œæƒé™
    [ $EUID -eq 0 ] || { echo "éœ€è¦rootæƒé™"; return 1; }
    command -v ifconfig &> /dev/null || { echo "ifconfigå‘½ä»¤ä¸å­˜åœ¨"; return 1; }
    return 0
}

configure_network_interfaces() {
    # é…ç½®ç½‘ç»œæ¥å£
    log_message "é…ç½®ä¸»ç½‘ç»œæ¥å£..."
    ifconfig eth0 192.168.1.100 netmask 255.255.255.0 up
    route add default gw 192.168.1.1
}

configure_network_services() {
    # é…ç½®ç½‘ç»œæœåŠ¡
    log_message "é…ç½®DNSæœåŠ¡å™¨..."
    echo "nameserver 8.8.8.8" > /etc/resolv.conf
    echo "nameserver 8.8.4.4" >> /etc/resolv.conf
    
    log_message "å¯åŠ¨ç½‘ç»œæœåŠ¡..."
    systemctl restart network 2>/dev/null || service network restart
}

verify_deployment() {
    # éªŒè¯éƒ¨ç½²ç»“æœ
    ping -c 2 192.168.1.1 &> /dev/null && \
    ping -c 2 8.8.8.8 &> /dev/null
}

# æ‰§è¡Œéƒ¨ç½²
deploy_network_environment
```

### 6.3 åˆ†ç¯å¢ƒå¿«é€Ÿåˆ‡æ¢


**ğŸ”„ ç¯å¢ƒåˆ‡æ¢éƒ¨ç½²**ï¼š
```bash
#!/bin/bash
# ç¯å¢ƒå¿«é€Ÿåˆ‡æ¢è„šæœ¬

ENVIRONMENTS=(
    "production:192.168.1.0:192.168.1.1:prod.company.com"
    "testing:192.168.2.0:192.168.2.1:test.company.com"
    "development:192.168.3.0:192.168.3.1:dev.company.com"
)

switch_environment() {
    local env_name=$1
    
    echo "ğŸ”„ åˆ‡æ¢åˆ° $env_name ç¯å¢ƒ..."
    
    for env_config in "${ENVIRONMENTS[@]}"; do
        IFS=':' read -r name network gateway domain <<< "$env_config"
        
        if [ "$name" = "$env_name" ]; then
            echo "ğŸ”§ åº”ç”¨ $env_name ç¯å¢ƒé…ç½®"
            
            # ç”Ÿæˆè¯¥ç¯å¢ƒçš„IPåœ°å€
            local ip="${network%.*}.100"
            
            # é…ç½®ç½‘ç»œ
            ifconfig eth0 $ip netmask 255.255.255.0 up
            route add default gw $gateway
            
            # æ›´æ–°ä¸»æœºå
            hostnamectl set-hostname $domain
            
            echo "âœ… ç¯å¢ƒåˆ‡æ¢å®Œæˆ"
            return 0
        fi
    done
    
    echo "âŒ æœªæ‰¾åˆ°ç¯å¢ƒï¼š$env_name"
    return 1
}

# ä½¿ç”¨ç¤ºä¾‹
# ./switch_environment.sh production
switch_environment $1
```

---

## 7. ğŸ”„ é…ç½®å›æ»šä¸æ¢å¤æœºåˆ¶


### 7.1 ä¸ºä»€ä¹ˆéœ€è¦å›æ»šæœºåˆ¶


**âš ï¸ é…ç½®é£é™©åœºæ™¯**ï¼š
- æ–°é…ç½®å¯¼è‡´ç½‘ç»œä¸­æ–­
- é…ç½®é”™è¯¯å½±å“æœåŠ¡å¯ç”¨æ€§
- æµ‹è¯•é…ç½®éœ€è¦å¿«é€Ÿæ¢å¤

**ğŸ›¡ï¸ å›æ»šæœºåˆ¶ä»·å€¼**ï¼šèƒ½å¤Ÿå¿«é€Ÿæ¢å¤åˆ°ä¹‹å‰çš„å·¥ä½œçŠ¶æ€ï¼Œæœ€å°åŒ–æ•…éšœå½±å“ã€‚

### 7.2 é…ç½®å¤‡ä»½ç­–ç•¥


**ğŸ’¾ è‡ªåŠ¨å¤‡ä»½è„šæœ¬**ï¼š
```bash
#!/bin/bash
# é…ç½®å¤‡ä»½è„šæœ¬

BACKUP_DIR="/etc/network/backups"
TIMESTAMP=$(date '+%Y%m%d_%H%M%S')

backup_network_config() {
    echo "ğŸ’¾ åˆ›å»ºç½‘ç»œé…ç½®å¤‡ä»½..."
    
    # åˆ›å»ºå¤‡ä»½ç›®å½•
    mkdir -p "$BACKUP_DIR/$TIMESTAMP"
    
    # å¤‡ä»½ç½‘ç»œé…ç½®æ–‡ä»¶
    if [ -f /etc/sysconfig/network-scripts/ifcfg-eth0 ]; then
        cp /etc/sysconfig/network-scripts/ifcfg-* "$BACKUP_DIR/$TIMESTAMP/"
        echo "âœ… ç½‘ç»œæ¥å£é…ç½®å·²å¤‡ä»½"
    fi
    
    # å¤‡ä»½è·¯ç”±è¡¨
    route -n > "$BACKUP_DIR/$TIMESTAMP/route_table.txt"
    echo "âœ… è·¯ç”±è¡¨å·²å¤‡ä»½"
    
    # å¤‡ä»½DNSé…ç½®
    cp /etc/resolv.conf "$BACKUP_DIR/$TIMESTAMP/"
    echo "âœ… DNSé…ç½®å·²å¤‡ä»½"
    
    # åˆ›å»ºå¤‡ä»½æ¸…å•
    echo "å¤‡ä»½æ—¶é—´: $(date)" > "$BACKUP_DIR/$TIMESTAMP/backup_info.txt"
    echo "å¤‡ä»½ç›®å½•: $BACKUP_DIR/$TIMESTAMP" >> "$BACKUP_DIR/$TIMESTAMP/backup_info.txt"
    
    echo "ğŸ“‹ å¤‡ä»½å®Œæˆï¼Œå¤‡ä»½æ ‡è¯†ï¼š$TIMESTAMP"
    return 0
}

# æ‰§è¡Œå¤‡ä»½
backup_network_config
```

### 7.3 é…ç½®å›æ»šå®ç°


**âª é…ç½®å›æ»šè„šæœ¬**ï¼š
```bash
#!/bin/bash
# é…ç½®å›æ»šè„šæœ¬

BACKUP_DIR="/etc/network/backups"

list_backups() {
    echo "ğŸ“‹ å¯ç”¨çš„é…ç½®å¤‡ä»½ï¼š"
    echo "ID | å¤‡ä»½æ—¶é—´ | å¤‡ä»½ç›®å½•"
    echo "---|---------|----------"
    
    local count=1
    for backup in $(ls -t $BACKUP_DIR 2>/dev/null); do
        if [ -d "$BACKUP_DIR/$backup" ]; then
            local backup_time=$(echo $backup | sed 's/_/ /')
            echo "$count  | $backup_time | $backup"
            ((count++))
        fi
    done
}

rollback_config() {
    local backup_id=$1
    
    if [ -z "$backup_id" ]; then
        echo "âŒ è¯·æŒ‡å®šè¦å›æ»šçš„å¤‡ä»½ID"
        list_backups
        return 1
    fi
    
    # è·å–å¯¹åº”çš„å¤‡ä»½ç›®å½•
    local backup_dirs=($(ls -t $BACKUP_DIR))
    local backup_dir="${backup_dirs[$((backup_id-1))]}"
    
    if [ ! -d "$BACKUP_DIR/$backup_dir" ]; then
        echo "âŒ å¤‡ä»½ä¸å­˜åœ¨ï¼š$backup_id"
        return 1
    fi
    
    echo "âª å›æ»šåˆ°å¤‡ä»½ï¼š$backup_dir"
    
    # å½“å‰é…ç½®å¤‡ä»½ï¼ˆå›æ»šå‰çš„å®‰å…¨æªæ–½ï¼‰
    backup_network_config
    
    # æ¢å¤ç½‘ç»œé…ç½®æ–‡ä»¶
    if [ -f "$BACKUP_DIR/$backup_dir/ifcfg-eth0" ]; then
        cp "$BACKUP_DIR/$backup_dir"/ifcfg-* /etc/sysconfig/network-scripts/
        echo "âœ… ç½‘ç»œæ¥å£é…ç½®å·²æ¢å¤"
    fi
    
    # æ¢å¤DNSé…ç½®
    if [ -f "$BACKUP_DIR/$backup_dir/resolv.conf" ]; then
        cp "$BACKUP_DIR/$backup_dir/resolv.conf" /etc/
        echo "âœ… DNSé…ç½®å·²æ¢å¤"
    fi
    
    # é‡å¯ç½‘ç»œæœåŠ¡
    echo "ğŸ”„ é‡å¯ç½‘ç»œæœåŠ¡..."
    systemctl restart network 2>/dev/null || service network restart
    
    echo "âœ… é…ç½®å›æ»šå®Œæˆ"
}

# ä½¿ç”¨æ–¹æ³•
case $1 in
    "list")
        list_backups
        ;;
    "rollback")
        rollback_config $2
        ;;
    *)
        echo "ç”¨æ³•ï¼š"
        echo "  $0 list           # åˆ—å‡ºæ‰€æœ‰å¤‡ä»½"
        echo "  $0 rollback <ID>  # å›æ»šåˆ°æŒ‡å®šå¤‡ä»½"
        ;;
esac
```

---

## 8. ğŸ“Š ç½‘ç»œé…ç½®ç‰ˆæœ¬ç®¡ç†


### 8.1 ç‰ˆæœ¬ç®¡ç†çš„é‡è¦æ€§


**ğŸ¯ ç‰ˆæœ¬ç®¡ç†è§£å†³çš„é—®é¢˜**ï¼š
- **ğŸ“ å˜æ›´è¿½è¸ª**ï¼šè®°å½•æ¯æ¬¡é…ç½®çš„å˜æ›´å†…å®¹
- **ğŸ‘¤ è´£ä»»è¿½æº¯**ï¼šçŸ¥é“è°åœ¨ä»€ä¹ˆæ—¶å€™åšäº†ä»€ä¹ˆå˜æ›´
- **ğŸ”„ ç‰ˆæœ¬å¯¹æ¯”**ï¼šå¯¹æ¯”ä¸åŒç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚
- **âª ç²¾ç¡®å›æ»š**ï¼šå›æ»šåˆ°ä»»æ„å†å²ç‰ˆæœ¬

### 8.2 ä½¿ç”¨Gitç®¡ç†ç½‘ç»œé…ç½®


**ğŸ“‚ é…ç½®ä»“åº“ç»“æ„**ï¼š
```
network-configs/
â”œâ”€â”€ environments/
â”‚   â”œâ”€â”€ production/
â”‚   â”‚   â”œâ”€â”€ servers/
â”‚   â”‚   â””â”€â”€ network/
â”‚   â”œâ”€â”€ testing/
â”‚   â””â”€â”€ development/
â”œâ”€â”€ templates/
â”œâ”€â”€ scripts/
â””â”€â”€ docs/
```

**ğŸ”§ Gité›†æˆè„šæœ¬**ï¼š
```bash
#!/bin/bash
# Gitç‰ˆæœ¬ç®¡ç†é›†æˆè„šæœ¬

CONFIG_REPO="/opt/network-configs"

init_config_repo() {
    echo "ğŸ“¦ åˆå§‹åŒ–é…ç½®ä»“åº“..."
    
    if [ ! -d "$CONFIG_REPO" ]; then
        mkdir -p "$CONFIG_REPO"
        cd "$CONFIG_REPO"
        git init
        echo "âœ… Gitä»“åº“åˆå§‹åŒ–å®Œæˆ"
    else
        echo "â„¹ï¸ é…ç½®ä»“åº“å·²å­˜åœ¨"
    fi
}

commit_config_changes() {
    local message=$1
    local author=$2
    
    if [ -z "$message" ]; then
        echo "âŒ è¯·æä¾›æäº¤ä¿¡æ¯"
        return 1
    fi
    
    cd "$CONFIG_REPO"
    
    # æ·»åŠ æ‰€æœ‰å˜æ›´
    git add .
    
    # æäº¤å˜æ›´
    if [ -n "$author" ]; then
        git -c user.name="$author" -c user.email="$author@company.com" \
            commit -m "$message"
    else
        git commit -m "$message"
    fi
    
    echo "âœ… é…ç½®å˜æ›´å·²æäº¤ï¼š$message"
}

show_config_history() {
    cd "$CONFIG_REPO"
    echo "ğŸ“‹ é…ç½®å˜æ›´å†å²ï¼š"
    git log --oneline --graph --decorate -10
}

compare_versions() {
    local version1=$1
    local version2=$2
    
    cd "$CONFIG_REPO"
    
    if [ -z "$version2" ]; then
        version2="HEAD"
    fi
    
    echo "ğŸ” ç‰ˆæœ¬å¯¹æ¯”ï¼š$version1 vs $version2"
    git diff $version1 $version2
}

# ä½¿ç”¨ç¤ºä¾‹
case $1 in
    "init")
        init_config_repo
        ;;
    "commit")
        commit_config_changes "$2" "$3"
        ;;
    "history")
        show_config_history
        ;;
    "diff")
        compare_versions "$2" "$3"
        ;;
    *)
        echo "ç”¨æ³•ï¼š"
        echo "  $0 init                    # åˆå§‹åŒ–é…ç½®ä»“åº“"
        echo "  $0 commit 'æ¶ˆæ¯' [ä½œè€…]     # æäº¤é…ç½®å˜æ›´"
        echo "  $0 history                 # æŸ¥çœ‹å˜æ›´å†å²"
        echo "  $0 diff <ç‰ˆæœ¬1> [ç‰ˆæœ¬2]     # å¯¹æ¯”ç‰ˆæœ¬å·®å¼‚"
        ;;
esac
```

### 8.3 é…ç½®å˜æ›´å·¥ä½œæµ


**ğŸ”„ æ ‡å‡†å˜æ›´æµç¨‹**ï¼š
```
1. å¤‡ä»½å½“å‰é…ç½®     â† å®‰å…¨æªæ–½
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯     â† git checkout -b feature/new-network
3. ä¿®æ”¹é…ç½®æ–‡ä»¶     â† å®é™…çš„é…ç½®å˜æ›´
4. æµ‹è¯•éªŒè¯é…ç½®     â† ç¡®ä¿é…ç½®æ­£ç¡®
5. æäº¤å˜æ›´è®°å½•     â† git commit -m "æ·»åŠ æ–°ç½‘ç»œé…ç½®"
6. åˆå¹¶åˆ°ä¸»åˆ†æ”¯     â† git merge feature/new-network
7. åº”ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒ   â† å®é™…éƒ¨ç½²é…ç½®
```

**âš™ï¸ è‡ªåŠ¨åŒ–å˜æ›´è„šæœ¬**ï¼š
```bash
#!/bin/bash
# é…ç½®å˜æ›´è‡ªåŠ¨åŒ–è„šæœ¬

perform_config_change() {
    local change_description=$1
    local config_files=("${@:2}")
    
    echo "ğŸ”„ å¼€å§‹é…ç½®å˜æ›´ï¼š$change_description"
    
    # æ­¥éª¤1ï¼šå¤‡ä»½å½“å‰é…ç½®
    backup_timestamp=$(date '+%Y%m%d_%H%M%S')
    backup_network_config
    
    # æ­¥éª¤2ï¼šåˆ›å»ºGitåˆ†æ”¯
    cd "$CONFIG_REPO"
    branch_name="change_$backup_timestamp"
    git checkout -b "$branch_name"
    
    # æ­¥éª¤3ï¼šå¤åˆ¶æ–°é…ç½®æ–‡ä»¶
    for config_file in "${config_files[@]}"; do
        if [ -f "$config_file" ]; then
            cp "$config_file" "$CONFIG_REPO/current/"
            echo "âœ… å·²æ›´æ–°ï¼š$(basename $config_file)"
        fi
    done
    
    # æ­¥éª¤4ï¼šæµ‹è¯•é…ç½®
    if test_config_validity; then
        echo "âœ… é…ç½®æµ‹è¯•é€šè¿‡"
    else
        echo "âŒ é…ç½®æµ‹è¯•å¤±è´¥ï¼Œå›æ»šå˜æ›´"
        git checkout main
        git branch -D "$branch_name"
        return 1
    fi
    
    # æ­¥éª¤5ï¼šæäº¤å˜æ›´
    git add .
    git commit -m "$change_description"
    
    # æ­¥éª¤6ï¼šåˆå¹¶åˆ°ä¸»åˆ†æ”¯
    git checkout main
    git merge "$branch_name"
    git branch -d "$branch_name"
    
    echo "âœ… é…ç½®å˜æ›´å®Œæˆå¹¶å·²è®°å½•"
}

test_config_validity() {
    # é…ç½®æœ‰æ•ˆæ€§æµ‹è¯•
    echo "ğŸ§ª æµ‹è¯•é…ç½®æœ‰æ•ˆæ€§..."
    # è¿™é‡Œæ·»åŠ å…·ä½“çš„æµ‹è¯•é€»è¾‘
    return 0
}
```

---

## 9. ğŸ¯ è‡ªåŠ¨åŒ–éƒ¨ç½²æœ€ä½³å®è·µ


### 9.1 è‡ªåŠ¨åŒ–éƒ¨ç½²çš„æ ¸å¿ƒåŸåˆ™


**ğŸ—ï¸ è®¾è®¡åŸåˆ™**ï¼š

| åŸåˆ™ | **å«ä¹‰** | **å®é™…åº”ç”¨** |
|------|---------|-------------|
| **å¹‚ç­‰æ€§** | `å¤šæ¬¡æ‰§è¡Œç»“æœä¸€è‡´` | `è„šæœ¬å¯ä»¥é‡å¤è¿è¡Œè€Œä¸å‡ºé”™` |
| **åŸå­æ€§** | `æ“ä½œè¦ä¹ˆå…¨æˆåŠŸè¦ä¹ˆå…¨å¤±è´¥` | `é…ç½®å¤±è´¥æ—¶è‡ªåŠ¨å›æ»š` |
| **å¯è¿½æº¯** | `æ¯ä¸ªæ“ä½œéƒ½æœ‰è®°å½•` | `è¯¦ç»†çš„æ—¥å¿—å’Œç‰ˆæœ¬æ§åˆ¶` |
| **å¯æµ‹è¯•** | `éƒ¨ç½²å‰å¿…é¡»éªŒè¯` | `æµ‹è¯•ç¯å¢ƒå…ˆè¡ŒéªŒè¯` |

### 9.2 ç¯å¢ƒéš”ç¦»æœ€ä½³å®è·µ


**ğŸ”’ ç¯å¢ƒéš”ç¦»ç­–ç•¥**ï¼š
```bash
#!/bin/bash
# ç¯å¢ƒéš”ç¦»é…ç½®è„šæœ¬

# ç¯å¢ƒé…ç½®æ˜ å°„
declare -A ENV_CONFIGS=(
    ["development"]="192.168.10.0/24:192.168.10.1:dev-dns.local"
    ["testing"]="192.168.20.0/24:192.168.20.1:test-dns.local"  
    ["production"]="10.0.1.0/24:10.0.1.1:prod-dns.local"
)

apply_environment_isolation() {
    local environment=$1
    
    if [ -z "${ENV_CONFIGS[$environment]}" ]; then
        echo "âŒ æœªçŸ¥ç¯å¢ƒï¼š$environment"
        return 1
    fi
    
    # è§£æç¯å¢ƒé…ç½®
    IFS=':' read -r network gateway dns <<< "${ENV_CONFIGS[$environment]}"
    
    echo "ğŸ”’ åº”ç”¨ $environment ç¯å¢ƒéš”ç¦»é…ç½®"
    echo "   ç½‘ç»œæ®µï¼š$network"
    echo "   ç½‘å…³ï¼š$gateway"  
    echo "   DNSï¼š$dns"
    
    # åº”ç”¨é˜²ç«å¢™è§„åˆ™ï¼ˆç¯å¢ƒéš”ç¦»çš„å…³é”®ï¼‰
    apply_firewall_rules "$environment" "$network"
    
    # åº”ç”¨ç½‘ç»œé…ç½®
    configure_network_for_environment "$environment" "$network" "$gateway"
    
    echo "âœ… ç¯å¢ƒéš”ç¦»é…ç½®å®Œæˆ"
}

apply_firewall_rules() {
    local env=$1
    local network=$2
    
    echo "ğŸ›¡ï¸ é…ç½® $env ç¯å¢ƒé˜²ç«å¢™è§„åˆ™..."
    
    # æ¸…é™¤ç°æœ‰è§„åˆ™
    iptables -F
    
    # å…è®¸æœ¬ç¯å¢ƒå†…é€šä¿¡
    iptables -A INPUT -s $network -j ACCEPT
    iptables -A OUTPUT -d $network -j ACCEPT
    
    # ç”Ÿäº§ç¯å¢ƒé¢å¤–å®‰å…¨è§„åˆ™
    if [ "$env" = "production" ]; then
        # åªå…è®¸ç‰¹å®šç«¯å£
        iptables -A INPUT -p tcp --dport 22 -j ACCEPT
        iptables -A INPUT -p tcp --dport 80 -j ACCEPT
        iptables -A INPUT -p tcp --dport 443 -j ACCEPT
        iptables -P INPUT DROP
    fi
    
    echo "âœ… é˜²ç«å¢™è§„åˆ™é…ç½®å®Œæˆ"
}
```

### 9.3 ç›‘æ§ä¸å‘Šè­¦é›†æˆ


**ğŸ“Š éƒ¨ç½²ç›‘æ§è„šæœ¬**ï¼š
```bash
#!/bin/bash
# éƒ¨ç½²ç›‘æ§å’Œå‘Šè­¦è„šæœ¬

MONITOR_LOG="/var/log/network_monitor.log"
ALERT_THRESHOLD=3  # è¿ç»­å¤±è´¥æ¬¡æ•°é˜ˆå€¼

monitor_network_health() {
    local failure_count=0
    
    while true; do
        echo "ğŸ” $(date): ç½‘ç»œå¥åº·æ£€æŸ¥" >> $MONITOR_LOG
        
        if perform_health_check; then
            echo "âœ… $(date): ç½‘ç»œçŠ¶æ€æ­£å¸¸" >> $MONITOR_LOG
            failure_count=0
        else
            ((failure_count++))
            echo "âŒ $(date): ç½‘ç»œæ£€æŸ¥å¤±è´¥ ($failure_count/$ALERT_THRESHOLD)" >> $MONITOR_LOG
            
            if [ $failure_count -ge $ALERT_THRESHOLD ]; then
                send_alert "ç½‘ç»œè¿ç»­æ•…éšœ $failure_count æ¬¡"
                failure_count=0  # é‡ç½®è®¡æ•°å™¨
            fi
        fi
        
        sleep 60  # æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
    done
}

perform_health_check() {
    # åŸºç¡€ç½‘ç»œæ£€æŸ¥
    ping -c 1 -W 5 8.8.8.8 &> /dev/null || return 1
    
    # å…³é”®æœåŠ¡æ£€æŸ¥  
    systemctl is-active network &> /dev/null || return 1
    
    # ç½‘ç»œæ¥å£æ£€æŸ¥
    ip link show eth0 | grep -q "state UP" || return 1
    
    return 0
}

send_alert() {
    local message=$1
    local timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    
    # å‘é€é‚®ä»¶å‘Šè­¦ï¼ˆå¦‚æœé…ç½®äº†é‚®ä»¶æœåŠ¡ï¼‰
    if command -v mail &> /dev/null; then
        echo "$timestamp: $message" | mail -s "ç½‘ç»œå‘Šè­¦" admin@company.com
    fi
    
    # è®°å½•å‘Šè­¦æ—¥å¿—
    echo "ğŸš¨ $timestamp: ALERT - $message" >> $MONITOR_LOG
    
    # å¯ä»¥é›†æˆå…¶ä»–å‘Šè­¦æ–¹å¼ï¼šçŸ­ä¿¡ã€é’‰é’‰ã€å¾®ä¿¡ç­‰
}

# å¯åŠ¨ç›‘æ§ï¼ˆåå°è¿è¡Œï¼‰
monitor_network_health &
echo "ğŸ“Š ç½‘ç»œç›‘æ§å·²å¯åŠ¨ï¼ŒPID: $!"
```

### 9.4 é…ç½®æ ‡å‡†åŒ–æ£€æŸ¥


**ğŸ“‹ æ ‡å‡†åŒ–æ£€æŸ¥è„šæœ¬**ï¼š
```bash
#!/bin/bash
# ç½‘ç»œé…ç½®æ ‡å‡†åŒ–æ£€æŸ¥

STANDARDS_CONFIG="/etc/network/standards.conf"

# å®šä¹‰æ ‡å‡†é…ç½®è¦æ±‚
declare -A NETWORK_STANDARDS=(
    ["min_mtu"]="1500"
    ["max_mtu"]="9000"  
    ["required_dns"]="8.8.8.8"
    ["forbidden_networks"]="169.254.0.0/16"  # ç¦ç”¨çš„ç½‘ç»œæ®µ
    ["required_gateway_ping"]="true"
)

check_network_standards() {
    echo "ğŸ“‹ æ‰§è¡Œç½‘ç»œé…ç½®æ ‡å‡†åŒ–æ£€æŸ¥..."
    
    local check_passed=0
    local check_failed=0
    
    # æ£€æŸ¥MTUè®¾ç½®
    if check_mtu_standards; then
        echo "âœ… MTUé…ç½®ç¬¦åˆæ ‡å‡†"
        ((check_passed++))
    else
        echo "âŒ MTUé…ç½®ä¸ç¬¦åˆæ ‡å‡†"
        ((check_failed++))
    fi
    
    # æ£€æŸ¥DNSé…ç½®
    if check_dns_standards; then
        echo "âœ… DNSé…ç½®ç¬¦åˆæ ‡å‡†"
        ((check_passed++))
    else
        echo "âŒ DNSé…ç½®ä¸ç¬¦åˆæ ‡å‡†"
        ((check_failed++))
    fi
    
    # æ£€æŸ¥ç½‘ç»œæ®µåˆè§„æ€§
    if check_network_compliance; then
        echo "âœ… ç½‘ç»œæ®µé…ç½®åˆè§„"
        ((check_passed++))
    else
        echo "âŒ ç½‘ç»œæ®µé…ç½®ä¸åˆè§„"
        ((check_failed++))
    fi
    
    # è¾“å‡ºæ£€æŸ¥ç»“æœ
    echo "ğŸ“Š æ ‡å‡†åŒ–æ£€æŸ¥å®Œæˆï¼š"
    echo "   é€šè¿‡ï¼š$check_passed é¡¹"
    echo "   å¤±è´¥ï¼š$check_failed é¡¹"
    
    if [ $check_failed -eq 0 ]; then
        echo "ğŸ‰ æ‰€æœ‰æ£€æŸ¥é¡¹å‡é€šè¿‡æ ‡å‡†"
        return 0
    else
        echo "âš ï¸ å­˜åœ¨ä¸ç¬¦åˆæ ‡å‡†çš„é…ç½®é¡¹"
        return 1
    fi
}

check_mtu_standards() {
    local current_mtu=$(ip link show eth0 | grep mtu | awk '{print $5}')
    local min_mtu=${NETWORK_STANDARDS["min_mtu"]}
    local max_mtu=${NETWORK_STANDARDS["max_mtu"]}
    
    if [ $current_mtu -ge $min_mtu ] && [ $current_mtu -le $max_mtu ]; then
        return 0
    else
        echo "   å½“å‰MTU: $current_mtu, æ ‡å‡†èŒƒå›´: $min_mtu-$max_mtu"
        return 1
    fi
}

check_dns_standards() {
    local required_dns=${NETWORK_STANDARDS["required_dns"]}
    
    if grep -q "$required_dns" /etc/resolv.conf; then
        return 0
    else
        echo "   æœªæ‰¾åˆ°æ ‡å‡†DNSæœåŠ¡å™¨: $required_dns"
        return 1
    fi
}

check_network_compliance() {
    local forbidden=${NETWORK_STANDARDS["forbidden_networks"]}
    
    # æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº†ç¦ç”¨çš„ç½‘ç»œæ®µ
    if ip route | grep -q "$forbidden"; then
        echo "   æ£€æµ‹åˆ°ç¦ç”¨ç½‘ç»œæ®µ: $forbidden"
        return 1
    fi
    
    return 0
}

# æ‰§è¡Œæ ‡å‡†åŒ–æ£€æŸ¥
check_network_standards
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ è‡ªåŠ¨åŒ–æ€ç»´ï¼šç”¨è„šæœ¬è§£å†³é‡å¤æ€§ç½‘ç»œé…ç½®ä»»åŠ¡
ğŸ”¸ æ¨¡æ¿åŒ–ç®¡ç†ï¼šæ ‡å‡†åŒ–é…ç½®ï¼Œæé«˜å¤ç”¨æ€§å’Œä¸€è‡´æ€§
ğŸ”¸ éªŒè¯æœºåˆ¶ï¼šé…ç½®å‰åéƒ½è¦éªŒè¯ï¼Œç¡®ä¿ç½‘ç»œæ­£å¸¸
ğŸ”¸ ç‰ˆæœ¬æ§åˆ¶ï¼šæ‰€æœ‰é…ç½®å˜æ›´éƒ½è¦æœ‰è®°å½•å’Œå¯å›æ»šèƒ½åŠ›
ğŸ”¸ ç¯å¢ƒéš”ç¦»ï¼šä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒçš„ç½‘ç»œé…ç½®ç­–ç•¥
ğŸ”¸ ç›‘æ§å‘Šè­¦ï¼šå®æ—¶ç›‘æ§ç½‘ç»œçŠ¶æ€ï¼ŒåŠæ—¶å‘ç°é—®é¢˜
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ è‡ªåŠ¨åŒ–çš„ä»·å€¼**ï¼š
```
æ•ˆç‡æå‡ï¼šæ‰¹é‡æ“ä½œæ¯”æ‰‹å·¥æ“ä½œå¿«10-100å€
é”™è¯¯å‡å°‘ï¼šè„šæœ¬æ‰§è¡Œæ¯”äººå·¥æ“ä½œé”™è¯¯ç‡ä½90%ä»¥ä¸Š
æ ‡å‡†ç»Ÿä¸€ï¼šæ‰€æœ‰æœåŠ¡å™¨ä½¿ç”¨ç›¸åŒçš„é…ç½®æ ‡å‡†
å¯è¿½æº¯æ€§ï¼šæ¯æ¬¡å˜æ›´éƒ½æœ‰å®Œæ•´çš„è®°å½•å’Œæ—¥å¿—
```

**ğŸ”¹ è„šæœ¬ç¼–å†™åŸåˆ™**ï¼š
```
å¹‚ç­‰æ€§ï¼šå¤šæ¬¡æ‰§è¡ŒåŒä¸€è„šæœ¬ç»“æœä¸€è‡´
å®¹é”™æ€§ï¼šé‡åˆ°é”™è¯¯èƒ½å¤Ÿä¼˜é›…å¤„ç†
å¯è¯»æ€§ï¼šä»£ç è¦æœ‰æ¸…æ™°çš„æ³¨é‡Šå’Œæ—¥å¿—è¾“å‡º
å¯ç»´æŠ¤æ€§ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œä¾¿äºåç»­ä¿®æ”¹
```

**ğŸ”¹ é…ç½®ç®¡ç†æœ€ä½³å®è·µ**ï¼š
```
å¤‡ä»½å…ˆè¡Œï¼šä»»ä½•é…ç½®å˜æ›´å‰éƒ½è¦å¤‡ä»½
æµ‹è¯•éªŒè¯ï¼šå…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ï¼Œå†éƒ¨ç½²ç”Ÿäº§
ç‰ˆæœ¬æ§åˆ¶ï¼šä½¿ç”¨Gitç­‰å·¥å…·ç®¡ç†é…ç½®ç‰ˆæœ¬
æ–‡æ¡£è®°å½•ï¼šé‡è¦çš„é…ç½®å˜æ›´è¦æœ‰æ–‡æ¡£è¯´æ˜
```

### 10.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ é€‚ç”¨åœºæ™¯**ï¼š
- âœ… **æœåŠ¡å™¨æ•°é‡å¤š**ï¼š10å°ä»¥ä¸ŠæœåŠ¡å™¨çš„ç½‘ç»œé…ç½®
- âœ… **é…ç½®å˜æ›´é¢‘ç¹**ï¼šç»å¸¸éœ€è¦è°ƒæ•´ç½‘ç»œå‚æ•°
- âœ… **ç¯å¢ƒåˆ‡æ¢éœ€æ±‚**ï¼šå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒåˆ‡æ¢
- âœ… **æ ‡å‡†åŒ–è¦æ±‚**ï¼šéœ€è¦ç»Ÿä¸€çš„ç½‘ç»œé…ç½®æ ‡å‡†

**âš ï¸ æ³¨æ„äº‹é¡¹**ï¼š
- ğŸ”’ **æƒé™æ§åˆ¶**ï¼šè‡ªåŠ¨åŒ–è„šæœ¬é€šå¸¸éœ€è¦rootæƒé™ï¼Œè¦æ³¨æ„å®‰å…¨
- ğŸ§ª **å……åˆ†æµ‹è¯•**ï¼šç½‘ç»œé…ç½®é”™è¯¯å¯èƒ½å¯¼è‡´æœåŠ¡å™¨å¤±è”
- ğŸ“ **è¯¦ç»†æ—¥å¿—**ï¼šè®°å½•æ¯ä¸€æ­¥æ“ä½œï¼Œä¾¿äºé—®é¢˜æ’æŸ¥
- ğŸ”„ **å›æ»šå‡†å¤‡**ï¼šéšæ—¶å‡†å¤‡å›æ»šåˆ°ä¹‹å‰çš„é…ç½®

**ğŸ› ï¸ å·¥å…·é€‰æ‹©å»ºè®®**ï¼š
```
ç®€å•åœºæ™¯ï¼šä½¿ç”¨Shellè„šæœ¬å³å¯
å¤æ‚åœºæ™¯ï¼šè€ƒè™‘Ansibleã€Puppetç­‰é…ç½®ç®¡ç†å·¥å…·
å¤§è§„æ¨¡ç¯å¢ƒï¼šç»“åˆå®¹å™¨åŒ–å’ŒKubernetesç½‘ç»œç®¡ç†
ä¼ä¸šçº§åº”ç”¨ï¼šé›†æˆç›‘æ§å‘Šè­¦å’ŒCMDBç³»ç»Ÿ
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- ç½‘ç»œé…ç½®è‡ªåŠ¨åŒ–æ˜¯ç°ä»£è¿ç»´çš„å¿…å¤‡æŠ€èƒ½
- è„šæœ¬åŒ–ã€æ¨¡æ¿åŒ–ã€ç‰ˆæœ¬åŒ–æ˜¯ä¸‰å¤§æ ¸å¿ƒç†å¿µ
- å®‰å…¨ç¬¬ä¸€ï¼Œæµ‹è¯•å…ˆè¡Œï¼Œç›‘æ§ä¿éšœ
- ä»ç®€å•å¼€å§‹ï¼Œé€æ­¥å®Œå–„è‡ªåŠ¨åŒ–ä½“ç³»