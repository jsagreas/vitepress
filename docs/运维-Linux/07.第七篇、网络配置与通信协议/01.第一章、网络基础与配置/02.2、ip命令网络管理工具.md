---
title: 2ã€ipå‘½ä»¤ç½‘ç»œç®¡ç†å·¥å…·
---
## ğŸ“š ç›®å½•

1. [ipå‘½ä»¤æ¦‚è¿°ä¸åŸºç¡€](#1-ipå‘½ä»¤æ¦‚è¿°ä¸åŸºç¡€)
2. [ipå‘½ä»¤è¯­æ³•ç»“æ„è¯¦è§£](#2-ipå‘½ä»¤è¯­æ³•ç»“æ„è¯¦è§£)
3. [ip addråœ°å€ç®¡ç†](#3-ip-addråœ°å€ç®¡ç†)
4. [ip linké“¾è·¯ç®¡ç†](#4-ip-linké“¾è·¯ç®¡ç†)
5. [ip routeè·¯ç”±ç®¡ç†](#5-ip-routeè·¯ç”±ç®¡ç†)
6. [ip neighboré‚»å±…è¡¨ç®¡ç†](#6-ip-neighboré‚»å±…è¡¨ç®¡ç†)
7. [ip netnsç½‘ç»œå‘½åç©ºé—´](#7-ip-netnsç½‘ç»œå‘½åç©ºé—´)
8. [é…ç½®æŒä¹…åŒ–ç­–ç•¥](#8-é…ç½®æŒä¹…åŒ–ç­–ç•¥)
9. [è¾“å‡ºæ ¼å¼è§£ææŠ€å·§](#9-è¾“å‡ºæ ¼å¼è§£ææŠ€å·§)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ ipå‘½ä»¤æ¦‚è¿°ä¸åŸºç¡€


### 1.1 ä»€ä¹ˆæ˜¯ipå‘½ä»¤


**ç®€å•ç†è§£**ï¼šipå‘½ä»¤å°±æ˜¯Linuxç³»ç»Ÿä¸­ç®¡ç†ç½‘ç»œçš„"ç‘å£«å†›åˆ€"ï¼Œå®ƒèƒ½å¸®ä½ æŸ¥çœ‹å’Œè®¾ç½®ç½‘ç»œæ¥å£ã€IPåœ°å€ã€è·¯ç”±ç­‰æ‰€æœ‰ç½‘ç»œç›¸å…³çš„é…ç½®ã€‚

> **ğŸ“– é€šä¿—è§£é‡Š**ï¼šå°±åƒä½ æ‰‹æœºä¸Šçš„ç½‘ç»œè®¾ç½®ç•Œé¢ï¼Œå¯ä»¥æŸ¥çœ‹WiFiè¿æ¥ã€è®¾ç½®IPåœ°å€ç­‰ï¼Œipå‘½ä»¤å°±æ˜¯Linuxå‘½ä»¤è¡Œç‰ˆæœ¬çš„ç½‘ç»œè®¾ç½®å·¥å…·ã€‚

**æ ¸å¿ƒä½œç”¨**ï¼š
- ğŸ” **æŸ¥çœ‹ç½‘ç»œçŠ¶æ€** - çœ‹çœ‹ç½‘å¡æœ‰å“ªäº›ï¼ŒIPåœ°å€æ˜¯ä»€ä¹ˆ
- âš™ï¸ **é…ç½®ç½‘ç»œå‚æ•°** - è®¾ç½®IPåœ°å€ã€å­ç½‘æ©ç ç­‰
- ğŸ›£ï¸ **ç®¡ç†è·¯ç”±è¡¨** - å‘Šè¯‰æ•°æ®åŒ…è¯¥èµ°å“ªæ¡è·¯
- ğŸ”— **æ§åˆ¶ç½‘ç»œæ¥å£** - å¯ç”¨æˆ–ç¦ç”¨ç½‘å¡

### 1.2 ipå‘½ä»¤çš„ä¼˜åŠ¿


**ä¸ºä»€ä¹ˆè¦ç”¨ipå‘½ä»¤**ï¼š

```
ä¼ ç»Ÿå·¥å…· vs ipå‘½ä»¤å¯¹æ¯”ï¼š

æ—§å·¥å…·é›†åˆï¼š               ç°ä»£ipå‘½ä»¤ï¼š
â”œâ”€â”€ ifconfig (æŸ¥çœ‹ç½‘å¡)    â”‚
â”œâ”€â”€ route (ç®¡ç†è·¯ç”±)       â”‚  ip å‘½ä»¤ç»Ÿä¸€ç®¡ç†
â”œâ”€â”€ arp (é‚»å±…è¡¨)          â”‚  â”Œâ”€ addr  (åœ°å€)
â””â”€â”€ netstat (ç½‘ç»œçŠ¶æ€)    â”‚  â”œâ”€ link  (é“¾è·¯)
                          â”‚  â”œâ”€ route (è·¯ç”±)
                          â”‚  â””â”€ neighbor (é‚»å±…)
```

**ipå‘½ä»¤çš„æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- âœ… **åŠŸèƒ½ç»Ÿä¸€** - ä¸€ä¸ªå‘½ä»¤æå®šæ‰€æœ‰ç½‘ç»œé…ç½®
- âœ… **ä¿¡æ¯è¯¦ç»†** - æ˜¾ç¤ºçš„ä¿¡æ¯æ¯”è€å·¥å…·æ›´ä¸°å¯Œ
- âœ… **ç°ä»£åŒ–** - æ”¯æŒæœ€æ–°çš„ç½‘ç»œç‰¹æ€§
- âœ… **é«˜æ•ˆå¿«é€Ÿ** - æ‰§è¡Œé€Ÿåº¦æ›´å¿«ï¼Œèµ„æºå ç”¨æ›´å°‘

### 1.3 é€‚ç”¨åœºæ™¯


| åœºæ™¯ç±»å‹ | **å…·ä½“åº”ç”¨** | **ä½¿ç”¨é¢‘ç‡** |
|---------|-------------|-------------|
| ğŸ  **æ—¥å¸¸è¿ç»´** | `æŸ¥çœ‹ç½‘ç»œé…ç½®ã€è¯Šæ–­ç½‘ç»œé—®é¢˜` | `â˜…â˜…â˜…â˜…â˜…` |
| ğŸ”§ **ç³»ç»Ÿé…ç½®** | `è®¾ç½®é™æ€IPã€é…ç½®ç½‘ç»œæ¥å£` | `â˜…â˜…â˜…â˜…â˜†` |
| ğŸ–¥ï¸ **æœåŠ¡å™¨ç®¡ç†** | `è·¯ç”±é…ç½®ã€ç½‘ç»œæ•…éšœæ’æŸ¥` | `â˜…â˜…â˜…â˜…â˜…` |
| ğŸ³ **å®¹å™¨ç½‘ç»œ** | `Dockerç½‘ç»œã€è™šæ‹Ÿç½‘ç»œç®¡ç†` | `â˜…â˜…â˜…â˜†â˜†` |

---

## 2. âš™ï¸ ipå‘½ä»¤è¯­æ³•ç»“æ„è¯¦è§£


### 2.1 åŸºæœ¬è¯­æ³•æ ¼å¼


**å‘½ä»¤ç»“æ„å›¾**ï¼š
```
ip [é€‰é¡¹] å¯¹è±¡ {å‘½ä»¤|å¸®åŠ©}
â”‚     â”‚     â”‚      â”‚
â”‚     â”‚     â”‚      â””â”€ å…·ä½“æ“ä½œï¼šshowã€addã€delç­‰
â”‚     â”‚     â””â”€ ç®¡ç†å¯¹è±¡ï¼šaddrã€linkã€routeç­‰  
â”‚     â””â”€ å…¨å±€é€‰é¡¹ï¼š-4ã€-6ã€-sç­‰
â””â”€ å‘½ä»¤åç§°
```

### 2.2 ä¸»è¦å¯¹è±¡ç±»å‹


**æ ¸å¿ƒç®¡ç†å¯¹è±¡**ï¼š

| å¯¹è±¡åç§° | **ç®€å†™** | **ç®¡ç†å†…å®¹** | **å¸¸ç”¨åœºæ™¯** |
|---------|---------|-------------|-------------|
| `addr` | `a` | `IPåœ°å€ç®¡ç†` | `æŸ¥çœ‹/è®¾ç½®ç½‘å¡IPåœ°å€` |
| `link` | `l` | `ç½‘ç»œæ¥å£ç®¡ç†` | `å¯ç”¨/ç¦ç”¨ç½‘å¡` |
| `route` | `r` | `è·¯ç”±è¡¨ç®¡ç†` | `é…ç½®ç½‘å…³å’Œè·¯ç”±` |
| `neighbor` | `n` | `ARPé‚»å±…è¡¨` | `æŸ¥çœ‹MACåœ°å€æ˜ å°„` |
| `netns` | `netns` | `ç½‘ç»œå‘½åç©ºé—´` | `ç½‘ç»œéš”ç¦»å’Œè™šæ‹ŸåŒ–` |

### 2.3 å¸¸ç”¨å…¨å±€é€‰é¡¹


**é‡è¦é€‰é¡¹è¯´æ˜**ï¼š

```bash
ip -4 addr show        # åªæ˜¾ç¤ºIPv4åœ°å€
ip -6 addr show        # åªæ˜¾ç¤ºIPv6åœ°å€
ip -s link show        # æ˜¾ç¤ºè¯¦ç»†ç»Ÿè®¡ä¿¡æ¯
ip -c addr show        # å½©è‰²è¾“å‡ºï¼ˆæ›´å¥½çœ‹ï¼‰
ip -br addr show       # ç®€æ´è¾“å‡ºæ ¼å¼
```

> **ğŸ’¡ è®°å¿†æŠ€å·§**ï¼š
> - `-4` = IPv4ï¼Œ`-6` = IPv6
> - `-s` = statisticsï¼ˆç»Ÿè®¡ï¼‰
> - `-c` = colorï¼ˆå½©è‰²ï¼‰
> - `-br` = briefï¼ˆç®€æ´ï¼‰

---

## 3. ğŸŒ ip addråœ°å€ç®¡ç†


### 3.1 æŸ¥çœ‹IPåœ°å€ä¿¡æ¯


**åŸºç¡€æŸ¥çœ‹å‘½ä»¤**ï¼š

```bash
# æŸ¥çœ‹æ‰€æœ‰ç½‘å¡çš„IPåœ°å€
ip addr show
ip a show          # ç®€å†™å½¢å¼
ip a               # æœ€ç®€å½¢å¼

# æŸ¥çœ‹æŒ‡å®šç½‘å¡
ip addr show eth0
ip a show enp0s3   # å…·ä½“ç½‘å¡åç§°
```

### 3.2 è¾“å‡ºä¿¡æ¯è§£è¯»


**å…¸å‹è¾“å‡ºè§£æ**ï¼š
```
2: enp0s3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether 08:00:27:8d:c0:4d brd ff:ff:ff:ff:ff:ff
    inet 192.168.1.100/24 brd 192.168.1.255 scope global noprefixroute enp0s3
       valid_lft forever preferred_lft forever
    inet6 fe80::a00:27ff:fe8d:c04d/64 scope link noprefixroute 
       valid_lft forever preferred_lft forever
```

**ä¿¡æ¯å«ä¹‰è¯¦è§£**ï¼š

```
ç½‘å¡çŠ¶æ€æ ‡è¯†ï¼š
â”Œâ”€â”€ 2: enp0s3 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç½‘å¡ç¼–å·å’Œåç§°
â”œâ”€â”€ <BROADCAST,MULTICAST,UP,LOWER_UP> â”€ ç½‘å¡åŠŸèƒ½çŠ¶æ€
â”‚   â”œâ”€â”€ BROADCAST: æ”¯æŒå¹¿æ’­
â”‚   â”œâ”€â”€ MULTICAST: æ”¯æŒç»„æ’­  
â”‚   â”œâ”€â”€ UP: ç½‘å¡å·²å¯ç”¨
â”‚   â””â”€â”€ LOWER_UP: ç‰©ç†é“¾è·¯æ­£å¸¸
â”œâ”€â”€ mtu 1500 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æœ€å¤§ä¼ è¾“å•å…ƒ
â”œâ”€â”€ state UP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å½“å‰è¿è¡ŒçŠ¶æ€
â””â”€â”€ qlen 1000 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å‘é€é˜Ÿåˆ—é•¿åº¦

åœ°å€ä¿¡æ¯ï¼š
â”œâ”€â”€ link/ether 08:00:27:8d:c0:4d â”€â”€â”€ MACåœ°å€
â”œâ”€â”€ inet 192.168.1.100/24 â”€â”€â”€â”€â”€â”€â”€â”€â”€ IPv4åœ°å€/å­ç½‘æ©ç 
â”œâ”€â”€ brd 192.168.1.255 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å¹¿æ’­åœ°å€
â””â”€â”€ scope global â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ åœ°å€ä½œç”¨åŸŸ
```

### 3.3 IPåœ°å€é…ç½®æ“ä½œ


**æ·»åŠ IPåœ°å€**ï¼š
```bash
# ç»™ç½‘å¡æ·»åŠ IPåœ°å€
ip addr add 192.168.1.100/24 dev eth0

# æ·»åŠ å¸¦æ ‡ç­¾çš„åˆ«ååœ°å€
ip addr add 192.168.1.101/24 dev eth0 label eth0:1
```

**åˆ é™¤IPåœ°å€**ï¼š
```bash
# åˆ é™¤æŒ‡å®šIPåœ°å€
ip addr del 192.168.1.100/24 dev eth0

# æ¸…ç©ºç½‘å¡æ‰€æœ‰IPåœ°å€
ip addr flush dev eth0
```

> **âš ï¸ æ³¨æ„äº‹é¡¹**ï¼š
> - é…ç½®IPåœ°å€éœ€è¦rootæƒé™
> - åˆ é™¤ä¸»IPå¯èƒ½å¯¼è‡´ç½‘ç»œä¸­æ–­
> - ä¸´æ—¶é…ç½®é‡å¯åä¼šä¸¢å¤±

### 3.4 å®ç”¨æŸ¥çœ‹æŠ€å·§


**å¿«é€ŸæŸ¥çœ‹æŠ€å·§**ï¼š

```bash
# åªçœ‹IPv4åœ°å€ï¼Œç®€æ´æ ¼å¼
ip -4 -br addr show

# åªçœ‹æŒ‡å®šç½‘å¡çš„IPv4åœ°å€
ip -4 addr show dev eth0 | grep inet

# å½©è‰²æ˜¾ç¤ºï¼Œæ–¹ä¾¿æŸ¥çœ‹
ip -c addr show
```

**è¾“å‡ºè¿‡æ»¤ç¤ºä¾‹**ï¼š
```bash
# æå–IPåœ°å€ï¼ˆå»é™¤ç½‘å¡åç­‰ä¿¡æ¯ï¼‰
ip addr show eth0 | grep 'inet ' | awk '{print $2}' | cut -d'/' -f1
# è¾“å‡ºï¼š192.168.1.100
```

---

## 4. ğŸ”— ip linké“¾è·¯ç®¡ç†


### 4.1 ç½‘ç»œæ¥å£çŠ¶æ€ç®¡ç†


**æŸ¥çœ‹ç½‘ç»œæ¥å£**ï¼š

```bash
# æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œæ¥å£
ip link show
ip link list        # åŒæ ·æ•ˆæœ
ip l                # æœ€ç®€å†™æ³•

# æŸ¥çœ‹æŒ‡å®šæ¥å£
ip link show eth0
```

### 4.2 æ¥å£çŠ¶æ€æ§åˆ¶


**å¯ç”¨/ç¦ç”¨ç½‘å¡**ï¼š

```bash
# å¯ç”¨ç½‘å¡ï¼ˆç›¸å½“äºæ‹”æ‰ç½‘çº¿åé‡æ–°æ’å…¥ï¼‰
ip link set eth0 up

# ç¦ç”¨ç½‘å¡ï¼ˆç›¸å½“äºæ‹”æ‰ç½‘çº¿ï¼‰
ip link set eth0 down

# æŸ¥çœ‹ç½‘å¡çŠ¶æ€å˜åŒ–
ip link show eth0
```

> **ğŸ” çŠ¶æ€è§£é‡Š**ï¼š
> - `UP`ï¼šç½‘å¡å·²å¯ç”¨ï¼Œå¯ä»¥æ”¶å‘æ•°æ®
> - `DOWN`ï¼šç½‘å¡å·²ç¦ç”¨ï¼Œæ— æ³•é€šä¿¡
> - `LOWER_UP`ï¼šç‰©ç†é“¾è·¯æ­£å¸¸ï¼ˆç½‘çº¿è¿æ¥è‰¯å¥½ï¼‰

### 4.3 æ¥å£å±æ€§é…ç½®


**ä¿®æ”¹æ¥å£å±æ€§**ï¼š

```bash
# ä¿®æ”¹MTUå€¼ï¼ˆæœ€å¤§ä¼ è¾“å•å…ƒï¼‰
ip link set eth0 mtu 9000

# ä¿®æ”¹MACåœ°å€
ip link set eth0 address 00:11:22:33:44:55

# è®¾ç½®æ¥å£åˆ«å
ip link set eth0 alias "ä¸»ç½‘å¡"
```

**æŸ¥çœ‹è¯¦ç»†ç»Ÿè®¡ä¿¡æ¯**ï¼š
```bash
# æ˜¾ç¤ºç½‘å¡æ”¶å‘åŒ…ç»Ÿè®¡
ip -s link show eth0

# æ›´è¯¦ç»†çš„ç»Ÿè®¡ä¿¡æ¯
ip -s -s link show eth0
```

### 4.4 è™šæ‹Ÿæ¥å£ç®¡ç†


**åˆ›å»ºè™šæ‹Ÿç½‘å¡**ï¼š

```bash
# åˆ›å»ºè™šæ‹Ÿä»¥å¤ªç½‘æ¥å£
ip link add veth0 type veth peer name veth1

# åˆ›å»ºç½‘æ¡¥
ip link add br0 type bridge

# åˆ é™¤è™šæ‹Ÿæ¥å£
ip link delete veth0
```

---

## 5. ğŸ›£ï¸ ip routeè·¯ç”±ç®¡ç†


### 5.1 è·¯ç”±è¡¨æŸ¥çœ‹


**åŸºç¡€è·¯ç”±æŸ¥çœ‹**ï¼š

```bash
# æŸ¥çœ‹è·¯ç”±è¡¨
ip route show
ip route list       # åŒæ ·æ•ˆæœ
ip r                # æœ€ç®€å†™æ³•

# æŸ¥çœ‹æŒ‡å®šç›®æ ‡çš„è·¯ç”±
ip route show 8.8.8.8
```

### 5.2 è·¯ç”±è¡¨ä¿¡æ¯è§£è¯»


**å…¸å‹è·¯ç”±è¡¨è¾“å‡º**ï¼š
```
default via 192.168.1.1 dev enp0s3 proto dhcp metric 100 
169.254.0.0/16 dev enp0s3 scope link metric 1000 
192.168.1.0/24 dev enp0s3 proto kernel scope link src 192.168.1.100 metric 100
```

**è·¯ç”±æ¡ç›®è§£æ**ï¼š

```
è·¯ç”±æ¡ç›®ç»„æˆï¼š
ç›®æ ‡ç½‘ç»œ via ä¸‹ä¸€è·³ç½‘å…³ dev å‡ºæ¥å£ [å…¶ä»–å±æ€§]

ç¤ºä¾‹åˆ†æï¼š
default via 192.168.1.1 dev enp0s3
â”œâ”€â”€ default â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ é»˜è®¤è·¯ç”±ï¼ˆ0.0.0.0/0ï¼‰
â”œâ”€â”€ via 192.168.1.1 â”€â”€ ä¸‹ä¸€è·³ç½‘å…³IP
â”œâ”€â”€ dev enp0s3 â”€â”€â”€â”€â”€â”€â”€â”€ å‡ºæ¥å£ç½‘å¡
â”œâ”€â”€ proto dhcp â”€â”€â”€â”€â”€â”€â”€ è·¯ç”±æ¥æºï¼ˆDHCPè·å–ï¼‰
â””â”€â”€ metric 100 â”€â”€â”€â”€â”€â”€â”€â”€ è·¯ç”±ä¼˜å…ˆçº§ï¼ˆæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼‰
```

### 5.3 è·¯ç”±æ“ä½œç®¡ç†


**æ·»åŠ è·¯ç”±**ï¼š

```bash
# æ·»åŠ é»˜è®¤ç½‘å…³
ip route add default via 192.168.1.1

# æ·»åŠ é™æ€è·¯ç”±
ip route add 10.0.0.0/8 via 192.168.1.254

# æ·»åŠ ä¸»æœºè·¯ç”±
ip route add 8.8.8.8 via 192.168.1.1
```

**åˆ é™¤è·¯ç”±**ï¼š

```bash
# åˆ é™¤é»˜è®¤è·¯ç”±
ip route del default

# åˆ é™¤æŒ‡å®šè·¯ç”±
ip route del 10.0.0.0/8

# æ›¿æ¢è·¯ç”±ï¼ˆå­˜åœ¨åˆ™æ›¿æ¢ï¼Œä¸å­˜åœ¨åˆ™æ·»åŠ ï¼‰
ip route replace default via 192.168.1.1
```

### 5.4 è·¯ç”±ç­–ç•¥åº”ç”¨


**å¤šç½‘å¡ç¯å¢ƒè·¯ç”±**ï¼š

```bash
# ä¸ºä¸åŒç½‘å¡è®¾ç½®ä¸åŒçš„é»˜è®¤è·¯ç”±
ip route add default via 192.168.1.1 dev eth0 metric 100
ip route add default via 10.0.0.1 dev eth1 metric 200

# æŸ¥çœ‹ç”Ÿæ•ˆçš„è·¯ç”±
ip route get 8.8.8.8
```

> **ğŸ“Š è·¯ç”±ä¼˜å…ˆçº§è§„åˆ™**ï¼š
> 1. **æœ€é•¿åŒ¹é…åŸåˆ™** - æ›´å…·ä½“çš„è·¯ç”±ä¼˜å…ˆ
> 2. **Metricå€¼** - æ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜
> 3. **ç®¡ç†è·ç¦»** - ä¸åŒåè®®çš„ä¼˜å…ˆçº§

---

## 6. ğŸ‘¥ ip neighboré‚»å±…è¡¨ç®¡ç†


### 6.1 ARPé‚»å±…è¡¨æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯é‚»å±…è¡¨**ï¼š
> é‚»å±…è¡¨å°±åƒä½ æ‰‹æœºçš„é€šè®¯å½•ï¼Œè®°å½•äº†å±€åŸŸç½‘å†…å…¶ä»–è®¾å¤‡çš„"è”ç³»æ–¹å¼"ï¼Œå³IPåœ°å€å¯¹åº”çš„MACåœ°å€ï¼Œè¿™æ ·å‘é€æ•°æ®æ—¶å°±çŸ¥é“è¯¥å‘ç»™å“ªä¸ªç‰©ç†è®¾å¤‡ã€‚

**é‚»å±…è¡¨çš„ä½œç”¨**ï¼š
- ğŸ” **åœ°å€è§£æ** - å°†IPåœ°å€è½¬æ¢ä¸ºMACåœ°å€
- âš¡ **ç¼“å­˜åŠ é€Ÿ** - é¿å…é‡å¤çš„ARPè¯·æ±‚
- ğŸ›¡ï¸ **ç½‘ç»œå®‰å…¨** - æ£€æµ‹ARPæ¬ºéª—æ”»å‡»

### 6.2 æŸ¥çœ‹é‚»å±…è¡¨ä¿¡æ¯


**åŸºç¡€æŸ¥çœ‹å‘½ä»¤**ï¼š

```bash
# æŸ¥çœ‹æ‰€æœ‰é‚»å±…è¡¨æ¡ç›®
ip neighbor show
ip neigh show       # ç®€å†™
ip n                # æœ€ç®€å†™æ³•

# æŸ¥çœ‹æŒ‡å®šæ¥å£çš„é‚»å±…
ip neighbor show dev eth0
```

**é‚»å±…è¡¨è¾“å‡ºè§£æ**ï¼š
```
192.168.1.1 dev enp0s3 lladdr 00:1a:2b:3c:4d:5e REACHABLE
192.168.1.10 dev enp0s3 lladdr 08:00:27:12:34:56 STALE
192.168.1.20 dev enp0s3  FAILED
```

**çŠ¶æ€å«ä¹‰è§£é‡Š**ï¼š

| çŠ¶æ€ | **å«ä¹‰** | **è¯´æ˜** |
|------|---------|---------|
| `REACHABLE` | `å¯è¾¾` | `æœ€è¿‘é€šä¿¡è¿‡ï¼ŒMACåœ°å€æœ‰æ•ˆ` |
| `STALE` | `è¿‡æœŸ` | `è¶…æ—¶ä½†æœªåˆ é™¤ï¼Œä¸‹æ¬¡é€šä¿¡ä¼šéªŒè¯` |
| `DELAY` | `å»¶è¿Ÿ` | `æ­£åœ¨éªŒè¯æ˜¯å¦ä»ç„¶å¯è¾¾` |
| `PROBE` | `æ¢æµ‹` | `æ­£åœ¨å‘é€ARPè¯·æ±‚éªŒè¯` |
| `FAILED` | `å¤±è´¥` | `æ— æ³•è·å–MACåœ°å€` |

### 6.3 é‚»å±…è¡¨æ“ä½œ


**æ‰‹åŠ¨æ·»åŠ é‚»å±…æ¡ç›®**ï¼š
```bash
# æ·»åŠ é™æ€ARPæ¡ç›®
ip neighbor add 192.168.1.100 lladdr 00:11:22:33:44:55 dev eth0

# æ·»åŠ æ°¸ä¹…æ¡ç›®ï¼ˆä¸ä¼šè¿‡æœŸï¼‰
ip neighbor add 192.168.1.100 lladdr 00:11:22:33:44:55 dev eth0 nud permanent
```

**åˆ é™¤å’Œæ¸…ç†**ï¼š
```bash
# åˆ é™¤æŒ‡å®šæ¡ç›®
ip neighbor del 192.168.1.100 dev eth0

# æ¸…ç©ºæŒ‡å®šæ¥å£çš„é‚»å±…è¡¨
ip neighbor flush dev eth0

# æ¸…ç©ºæ‰€æœ‰é‚»å±…è¡¨
ip neighbor flush all
```

---

## 7. ğŸ—ï¸ ip netnsç½‘ç»œå‘½åç©ºé—´


### 7.1 ç½‘ç»œå‘½åç©ºé—´æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯ç½‘ç»œå‘½åç©ºé—´**ï¼š
> ç½‘ç»œå‘½åç©ºé—´å°±åƒç»™æ¯ä¸ªåº”ç”¨ç¨‹åºåˆ†é…ä¸€ä¸ªç‹¬ç«‹çš„"ç½‘ç»œæˆ¿é—´"ï¼Œæ¯ä¸ªæˆ¿é—´æœ‰è‡ªå·±çš„ç½‘å¡ã€IPåœ°å€ã€è·¯ç”±è¡¨ï¼Œå½¼æ­¤å®Œå…¨éš”ç¦»ï¼Œå°±åƒä¸åŒçš„è™šæ‹Ÿç½‘ç»œç¯å¢ƒã€‚

**åº”ç”¨åœºæ™¯**ï¼š
- ğŸ³ **å®¹å™¨ç½‘ç»œ** - Dockerå®¹å™¨çš„ç½‘ç»œéš”ç¦»
- ğŸ”’ **å®‰å…¨éš”ç¦»** - å°†ä¸åŒæœåŠ¡çš„ç½‘ç»œæµé‡éš”ç¦»
- ğŸ§ª **ç½‘ç»œæµ‹è¯•** - æ¨¡æ‹Ÿå¤æ‚çš„ç½‘ç»œç¯å¢ƒ
- ğŸ¢ **å¤šç§Ÿæˆ·** - ä¸ºä¸åŒç”¨æˆ·æä¾›ç‹¬ç«‹ç½‘ç»œ

### 7.2 å‘½åç©ºé—´åŸºæœ¬æ“ä½œ


**åˆ›å»ºå’Œç®¡ç†å‘½åç©ºé—´**ï¼š

```bash
# åˆ›å»ºç½‘ç»œå‘½åç©ºé—´
ip netns add myns

# åˆ—å‡ºæ‰€æœ‰å‘½åç©ºé—´
ip netns list

# åˆ é™¤å‘½åç©ºé—´
ip netns delete myns
```

**åœ¨å‘½åç©ºé—´ä¸­æ‰§è¡Œå‘½ä»¤**ï¼š

```bash
# åœ¨æŒ‡å®šå‘½åç©ºé—´ä¸­æ‰§è¡Œå‘½ä»¤
ip netns exec myns ip addr show

# è¿›å…¥å‘½åç©ºé—´çš„shell
ip netns exec myns bash

# åœ¨å‘½åç©ºé—´ä¸­é…ç½®ç½‘ç»œ
ip netns exec myns ip addr add 10.0.1.1/24 dev lo
ip netns exec myns ip link set lo up
```

### 7.3 å‘½åç©ºé—´ç½‘ç»œé…ç½®


**è¿æ¥ä¸åŒå‘½åç©ºé—´**ï¼š

```bash
# åˆ›å»ºä¸¤ä¸ªå‘½åç©ºé—´
ip netns add ns1
ip netns add ns2

# åˆ›å»ºvethå¯¹ï¼ˆè™šæ‹Ÿç½‘çº¿ï¼‰
ip link add veth1 type veth peer name veth2

# å°†vethçš„ä¸¤ç«¯åˆ†åˆ«æ”¾å…¥ä¸åŒå‘½åç©ºé—´
ip link set veth1 netns ns1
ip link set veth2 netns ns2

# åœ¨å„å‘½åç©ºé—´ä¸­é…ç½®IP
ip netns exec ns1 ip addr add 10.0.1.1/24 dev veth1
ip netns exec ns2 ip addr add 10.0.1.2/24 dev veth2

# å¯ç”¨æ¥å£
ip netns exec ns1 ip link set veth1 up
ip netns exec ns2 ip link set veth2 up
```

**æµ‹è¯•è¿é€šæ€§**ï¼š
```bash
# ä»ns1 ping ns2
ip netns exec ns1 ping 10.0.1.2
```

---

## 8. ğŸ’¾ é…ç½®æŒä¹…åŒ–ç­–ç•¥


### 8.1 ä¸´æ—¶é…ç½® vs æ°¸ä¹…é…ç½®


**é…ç½®ç±»å‹å¯¹æ¯”**ï¼š

```
ä¸´æ—¶é…ç½®ï¼ˆipå‘½ä»¤ï¼‰ï¼š
â”œâ”€â”€ ç‰¹ç‚¹ï¼šç«‹å³ç”Ÿæ•ˆï¼Œé‡å¯ä¸¢å¤±
â”œâ”€â”€ é€‚ç”¨ï¼šæµ‹è¯•ã€è°ƒè¯•ã€ä¸´æ—¶ä¿®å¤
â””â”€â”€ ç¤ºä¾‹ï¼šip addr add 192.168.1.100/24 dev eth0

æ°¸ä¹…é…ç½®ï¼ˆé…ç½®æ–‡ä»¶ï¼‰ï¼š
â”œâ”€â”€ ç‰¹ç‚¹ï¼šé‡å¯åä»ç„¶æœ‰æ•ˆ
â”œâ”€â”€ é€‚ç”¨ï¼šç”Ÿäº§ç¯å¢ƒã€æœåŠ¡å™¨é…ç½®
â””â”€â”€ ä½ç½®ï¼š/etc/network/interfaces æˆ– /etc/sysconfig/network-scripts/
```

### 8.2 ä¸åŒå‘è¡Œç‰ˆçš„é…ç½®æ–¹æ³•


**Ubuntu/Debianç³»ç»Ÿ**ï¼š

é…ç½®æ–‡ä»¶ä½ç½®ï¼š`/etc/netplan/01-netcfg.yaml`
```yaml
network:
  version: 2
  ethernets:
    enp0s3:
      dhcp4: false
      addresses: [192.168.1.100/24]
      gateway4: 192.168.1.1
      nameservers:
        addresses: [8.8.8.8, 1.1.1.1]
```

åº”ç”¨é…ç½®ï¼š
```bash
sudo netplan apply
```

**CentOS/RHELç³»ç»Ÿ**ï¼š

é…ç½®æ–‡ä»¶ä½ç½®ï¼š`/etc/sysconfig/network-scripts/ifcfg-eth0`
```bash
TYPE=Ethernet
BOOTPROTO=static
DEVICE=eth0
ONBOOT=yes
IPADDR=192.168.1.100
NETMASK=255.255.255.0
GATEWAY=192.168.1.1
DNS1=8.8.8.8
```

é‡å¯ç½‘ç»œï¼š
```bash
sudo systemctl restart network
```

### 8.3 é…ç½®è„šæœ¬åŒ–ç®¡ç†


**ç¼–å†™ç½‘ç»œé…ç½®è„šæœ¬**ï¼š

```bash
#!/bin/bash
# ç½‘ç»œé…ç½®è„šæœ¬ç¤ºä¾‹

# é…ç½®å˜é‡
INTERFACE="eth0"
IP_ADDR="192.168.1.100/24"
GATEWAY="192.168.1.1"

# é…ç½®ç½‘ç»œ
echo "é…ç½®ç½‘ç»œæ¥å£..."
ip addr add $IP_ADDR dev $INTERFACE
ip link set $INTERFACE up
ip route add default via $GATEWAY

# éªŒè¯é…ç½®
echo "éªŒè¯ç½‘ç»œé…ç½®..."
ip addr show $INTERFACE
ip route show
ping -c 3 $GATEWAY
```

---

## 9. ğŸ“Š è¾“å‡ºæ ¼å¼è§£ææŠ€å·§


### 9.1 è¾“å‡ºæ ¼å¼ä¼˜åŒ–


**ä¸åŒè¾“å‡ºæ ¼å¼å¯¹æ¯”**ï¼š

| æ ¼å¼é€‰é¡¹ | **ç”¨é€”** | **ç‰¹ç‚¹** | **ç¤ºä¾‹** |
|---------|---------|---------|---------|
| `é»˜è®¤æ ¼å¼` | `è¯¦ç»†ä¿¡æ¯` | `å®Œæ•´ä½†å†—é•¿` | `ip addr show` |
| `-br` | `ç®€æ´æ ¼å¼` | `ä¸€è¡Œæ˜¾ç¤ºå…³é”®ä¿¡æ¯` | `ip -br addr show` |
| `-c` | `å½©è‰²è¾“å‡º` | `é‡è¦ä¿¡æ¯é«˜äº®æ˜¾ç¤º` | `ip -c addr show` |
| `-j` | `JSONæ ¼å¼` | `ä¾¿äºè„šæœ¬å¤„ç†` | `ip -j addr show` |

**å®é™…æ•ˆæœå¯¹æ¯”**ï¼š

```bash
# é»˜è®¤è¯¦ç»†æ ¼å¼
ip addr show eth0
# è¾“å‡ºï¼šè¯¦ç»†çš„å¤šè¡Œä¿¡æ¯...

# ç®€æ´æ ¼å¼
ip -br addr show eth0
# è¾“å‡ºï¼šeth0    UP    192.168.1.100/24

# JSONæ ¼å¼ï¼ˆä¾¿äºè„šæœ¬å¤„ç†ï¼‰
ip -j addr show eth0 | jq '.[0].addr_info[0].local'
# è¾“å‡ºï¼š"192.168.1.100"
```

### 9.2 è¾“å‡ºè¿‡æ»¤å’Œæå–


**å¸¸ç”¨è¿‡æ»¤æŠ€å·§**ï¼š

```bash
# åªæ˜¾ç¤ºIPåœ°å€
ip -4 addr show eth0 | grep -oP '(?<=inet\s)\d+(\.\d+){3}'

# æ˜¾ç¤ºç½‘å¡çŠ¶æ€
ip link show | grep -E "^[0-9]+:" | awk '{print $2}' | sed 's/://'

# æ˜¾ç¤ºè·¯ç”±ç½‘å…³
ip route | grep default | awk '{print $3}'

# ç»Ÿè®¡ç½‘ç»œæ¥å£æ•°é‡
ip link show | grep -c "^[0-9]"
```

**å®ç”¨è„šæœ¬ç¤ºä¾‹**ï¼š

```bash
#!/bin/bash
# ç½‘ç»œä¿¡æ¯æ±‡æ€»è„šæœ¬

echo "=== ç½‘ç»œæ¥å£çŠ¶æ€ ==="
ip -br link show

echo -e "\n=== IPåœ°å€ä¿¡æ¯ ==="
ip -br addr show

echo -e "\n=== è·¯ç”±ä¿¡æ¯ ==="
ip route show

echo -e "\n=== é»˜è®¤ç½‘å…³ ==="
ip route | grep default | awk '{print $3}'
```

### 9.3 JSONæ ¼å¼å¤„ç†


**ä½¿ç”¨jqå¤„ç†JSONè¾“å‡º**ï¼š

```bash
# è·å–æ‰€æœ‰ç½‘å¡åç§°
ip -j link show | jq -r '.[].ifname'

# è·å–æŒ‡å®šç½‘å¡çš„IPåœ°å€
ip -j addr show eth0 | jq -r '.[0].addr_info[] | select(.family=="inet") | .local'

# è·å–ç½‘å¡çš„MACåœ°å€
ip -j link show eth0 | jq -r '.[0].address'
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ ipå‘½ä»¤æœ¬è´¨ï¼šç°ä»£Linuxç½‘ç»œé…ç½®çš„ç»Ÿä¸€å·¥å…·
ğŸ”¸ äº”å¤§æ ¸å¿ƒå¯¹è±¡ï¼šaddr(åœ°å€)ã€link(é“¾è·¯)ã€route(è·¯ç”±)ã€neighbor(é‚»å±…)ã€netns(å‘½åç©ºé—´)
ğŸ”¸ é…ç½®åˆ†ç±»ï¼šä¸´æ—¶é…ç½®(ç«‹å³ç”Ÿæ•ˆ)ã€æ°¸ä¹…é…ç½®(é‡å¯ä¿æŒ)
ğŸ”¸ è¾“å‡ºæ ¼å¼ï¼šé»˜è®¤è¯¦ç»†ã€-brç®€æ´ã€-cå½©è‰²ã€-j JSONæ ¼å¼
ğŸ”¸ æƒé™è¦æ±‚ï¼šæŸ¥çœ‹æ— éœ€æƒé™ï¼Œé…ç½®éœ€è¦rootæƒé™
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ç½‘ç»œå¯¹è±¡çš„å±‚æ¬¡å…³ç³»**ï¼š
```
ç½‘ç»œé…ç½®å±‚æ¬¡ï¼š
ç‰©ç†å±‚ï¼šç½‘å¡ç¡¬ä»¶
â”œâ”€â”€ linkï¼šç½‘å¡å¯ç”¨/ç¦ç”¨ã€MACåœ°å€
â”œâ”€â”€ addrï¼šIPåœ°å€é…ç½®
â”œâ”€â”€ routeï¼šæ•°æ®åŒ…è½¬å‘è·¯å¾„
â”œâ”€â”€ neighborï¼šIP-MACåœ°å€æ˜ å°„
â””â”€â”€ netnsï¼šç½‘ç»œç¯å¢ƒéš”ç¦»
```

**ğŸ”¹ ä¸´æ—¶vsæ°¸ä¹…é…ç½®çš„é€‰æ‹©**ï¼š
```
ä½¿ç”¨åœºæ™¯ï¼š
ä¸´æ—¶é…ç½® â†’ æ•…éšœæ’é™¤ã€ç½‘ç»œæµ‹è¯•ã€ä¸´æ—¶ä¿®å¤
æ°¸ä¹…é…ç½® â†’ ç”Ÿäº§ç¯å¢ƒã€æœåŠ¡å™¨éƒ¨ç½²ã€æŒä¹…è®¾ç½®
```

**ğŸ”¹ å‘½ä»¤ä½¿ç”¨çš„å®ç”¨åŸåˆ™**ï¼š
```
æŸ¥çœ‹ä¼˜å…ˆï¼šå…ˆçœ‹çŠ¶æ€å†é…ç½®
æµ‹è¯•éªŒè¯ï¼šé…ç½®åç«‹å³éªŒè¯
å¤‡ä»½æ¢å¤ï¼šé‡è¦é…ç½®è¦æœ‰å¤‡ä»½æ–¹æ¡ˆ
æƒé™å®‰å…¨ï¼šé¿å…ä¸å¿…è¦çš„rootæƒé™æ“ä½œ
```

### 10.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ æ—¥å¸¸è¿ç»´åœºæ™¯**ï¼š

```bash
# å¿«é€Ÿè¯Šæ–­ç½‘ç»œé—®é¢˜
ip -c -br addr show          # æŸ¥çœ‹ç½‘å¡çŠ¶æ€å’ŒIP
ip route show               # æ£€æŸ¥è·¯ç”±é…ç½®
ip neighbor show           # æ£€æŸ¥ARPè¡¨

# ä¸´æ—¶ä¿®å¤ç½‘ç»œ
ip link set eth0 up        # å¯ç”¨ç½‘å¡
ip addr add 192.168.1.100/24 dev eth0  # é…ç½®IP
ip route add default via 192.168.1.1   # è®¾ç½®ç½‘å…³
```

**ğŸ”§ è„šæœ¬è‡ªåŠ¨åŒ–ç®¡ç†**ï¼š

```bash
# ç½‘ç»œçŠ¶æ€æ£€æŸ¥è„šæœ¬
check_network() {
    echo "æ£€æŸ¥ç½‘ç»œæ¥å£..."
    ip -br link show | grep -v "lo"
    
    echo "æ£€æŸ¥IPé…ç½®..."
    ip -br addr show | grep -v "lo"
    
    echo "æ£€æŸ¥é»˜è®¤è·¯ç”±..."
    ip route | grep default
}
```

**âš ï¸ æ³¨æ„äº‹é¡¹å’Œæœ€ä½³å®è·µ**ï¼š

```
å®‰å…¨æé†’ï¼š
âœ… é…ç½®å‰å¤‡ä»½å½“å‰é…ç½®
âœ… åœ¨æµ‹è¯•ç¯å¢ƒå…ˆéªŒè¯
âœ… é‡è¦æ“ä½œåšå¥½å›æ»šå‡†å¤‡
âœ… é¿å…è¿œç¨‹æ“ä½œä¸­æ–­ç½‘ç»œè¿æ¥

æ€§èƒ½ä¼˜åŒ–ï¼š
âœ… ä½¿ç”¨ç®€æ´æ ¼å¼æé«˜æŸ¥çœ‹æ•ˆç‡
âœ… åˆç†ä½¿ç”¨è¿‡æ»¤å‡å°‘è¾“å‡ºå¹²æ‰°  
âœ… è„šæœ¬ä¸­ä½¿ç”¨JSONæ ¼å¼ä¾¿äºå¤„ç†
âœ… æ‰¹é‡æ“ä½œæ—¶æ³¨æ„ç³»ç»Ÿè´Ÿè½½
```

### 10.4 è¿›é˜¶å­¦ä¹ æ–¹å‘


**ğŸš€ æ‰©å±•çŸ¥è¯†é¢†åŸŸ**ï¼š
- **ç½‘ç»œè™šæ‹ŸåŒ–** - VLANã€æ¡¥æ¥ã€éš§é“æŠ€æœ¯
- **å®¹å™¨ç½‘ç»œ** - Dockerç½‘ç»œã€Kubernetesç½‘ç»œ
- **ç½‘ç»œå®‰å…¨** - é˜²ç«å¢™ã€ç½‘ç»œç›‘æ§ã€å…¥ä¾µæ£€æµ‹
- **æ€§èƒ½è°ƒä¼˜** - ç½‘ç»œå‚æ•°ä¼˜åŒ–ã€å¸¦å®½ç®¡ç†

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- ipå‘½ä»¤ç®¡ç½‘ç»œï¼Œäº”å¤§å¯¹è±¡è¦è®°æ¸…
- addrç®¡åœ°å€ï¼Œlinkç®¡æ¥å£ï¼Œrouteç®¡è·¯å¾„è¦åˆ†æ˜
- neighborçœ‹é‚»å±…ï¼Œnetnsåšéš”ç¦»ï¼Œä¸´æ—¶æ°¸ä¹…é…ç½®å®š
- æŸ¥çœ‹é…ç½®å…ˆååºï¼Œæƒé™å®‰å…¨è®°å¿ƒä¸­