---
title: 14ã€DNSé›†æˆå¼€å‘å®è·µ
---
## ğŸ“š ç›®å½•


1. [è„šæœ¬åŒ–DNSé…ç½®ç®¡ç†](#1-è„šæœ¬åŒ–DNSé…ç½®ç®¡ç†)
2. [DNSé…ç½®è‡ªåŠ¨åŒ–éƒ¨ç½²](#2-DNSé…ç½®è‡ªåŠ¨åŒ–éƒ¨ç½²)
3. [åŠ¨æ€DNSæ›´æ–°è„šæœ¬](#3-åŠ¨æ€DNSæ›´æ–°è„šæœ¬)
4. [DNSç›‘æ§å‘Šè­¦è„šæœ¬](#4-DNSç›‘æ§å‘Šè­¦è„šæœ¬)
5. [æ‰¹é‡åŸŸåè§£æå·¥å…·](#5-æ‰¹é‡åŸŸåè§£æå·¥å…·)
6. [DNSé…ç½®æ¨¡æ¿åŒ–ç®¡ç†](#6-DNSé…ç½®æ¨¡æ¿åŒ–ç®¡ç†)
7. [APIæ¥å£DNSç®¡ç†](#7-APIæ¥å£DNSç®¡ç†)
8. [DNSé…ç½®ç‰ˆæœ¬æ§åˆ¶](#8-DNSé…ç½®ç‰ˆæœ¬æ§åˆ¶)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”§ è„šæœ¬åŒ–DNSé…ç½®ç®¡ç†



### 1.1 ä»€ä¹ˆæ˜¯è„šæœ¬åŒ–DNSé…ç½®ç®¡ç†



**æ ¸å¿ƒæ¦‚å¿µ**ï¼šç”¨è„šæœ¬ç¨‹åºè‡ªåŠ¨ç®¡ç†DNSæœåŠ¡å™¨çš„é…ç½®ï¼Œæ›¿ä»£æ‰‹å·¥æ“ä½œ

```
ä¼ ç»Ÿæ–¹å¼ï¼šæ‰‹å·¥ç¼–è¾‘é…ç½®æ–‡ä»¶ â†’ é‡å¯æœåŠ¡ â†’ éªŒè¯é…ç½®
è„šæœ¬åŒ–æ–¹å¼ï¼šè¿è¡Œè„šæœ¬ â†’ è‡ªåŠ¨é…ç½® â†’ è‡ªåŠ¨éªŒè¯ â†’ è‡ªåŠ¨éƒ¨ç½²
```

**ä¸ºä»€ä¹ˆéœ€è¦è„šæœ¬åŒ–ç®¡ç†**ï¼š
- ğŸ”¸ **å‡å°‘äººå·¥é”™è¯¯**ï¼šé¿å…æ‰‹å·¥ç¼–è¾‘é…ç½®æ–‡ä»¶å‡ºé”™
- ğŸ”¸ **æé«˜æ•ˆç‡**ï¼šæ‰¹é‡æ“ä½œï¼Œå¿«é€Ÿéƒ¨ç½²
- ğŸ”¸ **æ ‡å‡†åŒ–æ“ä½œ**ï¼šç¡®ä¿æ¯æ¬¡æ“ä½œçš„ä¸€è‡´æ€§
- ğŸ”¸ **ä¾¿äºç»´æŠ¤**ï¼šç»Ÿä¸€çš„é…ç½®ç®¡ç†æ–¹å¼

### 1.2 DNSé…ç½®æ–‡ä»¶ç»“æ„



**ä¸»è¦é…ç½®æ–‡ä»¶**ï¼š
```
/etc/bind/named.conf        # ä¸»é…ç½®æ–‡ä»¶
/etc/bind/named.conf.local  # æœ¬åœ°åŸŸé…ç½®
/var/lib/bind/domain.com.db # åŸŸåè§£ææ–‡ä»¶
```

**é…ç½®æ–‡ä»¶åŸºæœ¬ç»“æ„**ï¼š
```
åŸŸé…ç½®æ–‡ä»¶ç»„æˆï¼š
SOAè®°å½• â†’ æŒ‡å®šåŸŸçš„æƒå¨ä¿¡æ¯
NSè®°å½•  â†’ æŒ‡å®šåŸŸåæœåŠ¡å™¨
Aè®°å½•   â†’ åŸŸååˆ°IPåœ°å€æ˜ å°„
CNAME   â†’ åŸŸååˆ«åè®°å½•
MXè®°å½•  â†’ é‚®ä»¶æœåŠ¡å™¨è®°å½•
```

### 1.3 åŸºç¡€DNSé…ç½®è„šæœ¬



```bash
#!/bin/bash

# DNSåŸºç¡€é…ç½®ç®¡ç†è„šæœ¬


# é…ç½®å‚æ•°

DOMAIN="example.com"
DNS_DIR="/var/lib/bind"
CONFIG_DIR="/etc/bind"

# æ·»åŠ åŸŸåè§£æè®°å½•

add_dns_record() {
    local hostname="$1"
    local ip="$2"
    local record_type="${3:-A}"
    
    echo "æ·»åŠ DNSè®°å½•ï¼š$hostname.$DOMAIN -> $ip"
    
#    # å¤‡ä»½åŸé…ç½®
    cp "$DNS_DIR/$DOMAIN.db" "$DNS_DIR/$DOMAIN.db.bak"
    
#    # æ·»åŠ è®°å½•
    echo "$hostname    IN    $record_type    $ip" >> "$DNS_DIR/$DOMAIN.db"
    
#    # éªŒè¯é…ç½®
    if named-checkzone "$DOMAIN" "$DNS_DIR/$DOMAIN.db"; then
        echo "âœ… é…ç½®éªŒè¯æˆåŠŸ"
        systemctl reload bind9
    else
        echo "âŒ é…ç½®éªŒè¯å¤±è´¥ï¼Œæ¢å¤å¤‡ä»½"
        mv "$DNS_DIR/$DOMAIN.db.bak" "$DNS_DIR/$DOMAIN.db"
        return 1
    fi
}

# åˆ é™¤åŸŸåè§£æè®°å½•

remove_dns_record() {
    local hostname="$1"
    
    echo "åˆ é™¤DNSè®°å½•ï¼š$hostname.$DOMAIN"
    
#    # å¤‡ä»½é…ç½®
    cp "$DNS_DIR/$DOMAIN.db" "$DNS_DIR/$DOMAIN.db.bak"
    
#    # åˆ é™¤è®°å½•
    sed -i "/^$hostname\s/d" "$DNS_DIR/$DOMAIN.db"
    
#    # éªŒè¯å¹¶é‡è½½
    if named-checkzone "$DOMAIN" "$DNS_DIR/$DOMAIN.db"; then
        systemctl reload bind9
        echo "âœ… è®°å½•åˆ é™¤æˆåŠŸ"
    else
        mv "$DNS_DIR/$DOMAIN.db.bak" "$DNS_DIR/$DOMAIN.db"
        echo "âŒ åˆ é™¤å¤±è´¥ï¼Œå·²æ¢å¤é…ç½®"
    fi
}
```

### 1.4 é«˜çº§é…ç½®ç®¡ç†åŠŸèƒ½



**æ‰¹é‡æ“ä½œè„šæœ¬**ï¼š
```bash
#!/bin/bash

# æ‰¹é‡DNSè®°å½•ç®¡ç†


# ä»CSVæ–‡ä»¶æ‰¹é‡æ·»åŠ è®°å½•

batch_add_from_csv() {
    local csv_file="$1"
    
    while IFS=',' read -r hostname ip record_type; do
#        # è·³è¿‡æ³¨é‡Šè¡Œ
        [[ "$hostname" =~ ^#.*$ ]] && continue
        
        echo "å¤„ç†è®°å½•ï¼š$hostname -> $ip ($record_type)"
        add_dns_record "$hostname" "$ip" "$record_type"
        
#        # æ·»åŠ å»¶è¿Ÿé¿å…æœåŠ¡è¿‡è½½
        sleep 1
    done < "$csv_file"
}

# é…ç½®è¯­æ³•æ£€æŸ¥

check_dns_config() {
    echo "ğŸ” æ£€æŸ¥DNSé…ç½®è¯­æ³•..."
    
#    # æ£€æŸ¥ä¸»é…ç½®æ–‡ä»¶
    if named-checkconf "$CONFIG_DIR/named.conf"; then
        echo "âœ… ä¸»é…ç½®æ–‡ä»¶è¯­æ³•æ­£ç¡®"
    else
        echo "âŒ ä¸»é…ç½®æ–‡ä»¶æœ‰è¯­æ³•é”™è¯¯"
        return 1
    fi
    
#    # æ£€æŸ¥æ‰€æœ‰åŸŸé…ç½®æ–‡ä»¶
    for zone_file in "$DNS_DIR"/*.db; do
        if [ -f "$zone_file" ]; then
            zone_name=$(basename "$zone_file" .db)
            if named-checkzone "$zone_name" "$zone_file"; then
                echo "âœ… $zone_name åŸŸé…ç½®æ­£ç¡®"
            else
                echo "âŒ $zone_name åŸŸé…ç½®æœ‰é”™è¯¯"
                return 1
            fi
        fi
    done
}
```

---

## 2. ğŸš€ DNSé…ç½®è‡ªåŠ¨åŒ–éƒ¨ç½²



### 2.1 è‡ªåŠ¨åŒ–éƒ¨ç½²çš„æ¦‚å¿µ



**ä»€ä¹ˆæ˜¯DNSè‡ªåŠ¨åŒ–éƒ¨ç½²**ï¼šé€šè¿‡è„šæœ¬å’Œå·¥å…·ï¼Œè‡ªåŠ¨å®ŒæˆDNSæœåŠ¡å™¨çš„å®‰è£…ã€é…ç½®ã€å¯åŠ¨å’ŒéªŒè¯å…¨è¿‡ç¨‹

**éƒ¨ç½²æµç¨‹**ï¼š
```
ç¯å¢ƒå‡†å¤‡ â†’ è½¯ä»¶å®‰è£… â†’ é…ç½®ç”Ÿæˆ â†’ æœåŠ¡å¯åŠ¨ â†’ åŠŸèƒ½éªŒè¯ â†’ ç›‘æ§éƒ¨ç½²
```

### 2.2 å®Œæ•´è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬



```bash
#!/bin/bash

# DNSæœåŠ¡å™¨è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬


set -e  # é‡åˆ°é”™è¯¯ç«‹å³é€€å‡º

# å…¨å±€é…ç½®

LOG_FILE="/var/log/dns-deploy.log"
BACKUP_DIR="/backup/dns-$(date +%Y%m%d)"

# æ—¥å¿—è®°å½•å‡½æ•°

log() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1" | tee -a "$LOG_FILE"
}

# ç¯å¢ƒæ£€æŸ¥

check_environment() {
    log "ğŸ” å¼€å§‹ç¯å¢ƒæ£€æŸ¥..."
    
#    # æ£€æŸ¥ç³»ç»Ÿç‰ˆæœ¬
    if ! command -v apt-get >/dev/null 2>&1; then
        log "âŒ ä»…æ”¯æŒUbuntu/Debianç³»ç»Ÿ"
        exit 1
    fi
    
#    # æ£€æŸ¥æƒé™
    if [ "$EUID" -ne 0 ]; then
        log "âŒ éœ€è¦rootæƒé™è¿è¡Œ"
        exit 1
    fi
    
#    # æ£€æŸ¥ç½‘ç»œè¿æ¥
    if ! ping -c 1 8.8.8.8 >/dev/null 2>&1; then
        log "âš ï¸ ç½‘ç»œè¿æ¥å¼‚å¸¸ï¼Œå¯èƒ½å½±å“è½¯ä»¶ä¸‹è½½"
    fi
    
    log "âœ… ç¯å¢ƒæ£€æŸ¥å®Œæˆ"
}

# è½¯ä»¶å®‰è£…

install_dns_server() {
    log "ğŸ“¦ å¼€å§‹å®‰è£…DNSæœåŠ¡å™¨..."
    
#    # æ›´æ–°è½¯ä»¶æº
    apt-get update -y
    
#    # å®‰è£…BIND9
    apt-get install -y bind9 bind9utils bind9-doc
    
#    # å®‰è£…è¾…åŠ©å·¥å…·
    apt-get install -y dnsutils curl wget
    
    log "âœ… DNSæœåŠ¡å™¨å®‰è£…å®Œæˆ"
}

# ç”Ÿæˆé…ç½®æ–‡ä»¶

generate_config() {
    log "âš™ï¸ ç”ŸæˆDNSé…ç½®æ–‡ä»¶..."
    
#    # åˆ›å»ºå¤‡ä»½ç›®å½•
    mkdir -p "$BACKUP_DIR"
    
#    # å¤‡ä»½åŸé…ç½®
    cp -r /etc/bind/* "$BACKUP_DIR/"
    
#    # ç”Ÿæˆä¸»é…ç½®æ–‡ä»¶
    cat > /etc/bind/named.conf.local << 'EOF'
zone "example.com" {
    type master;
    file "/var/lib/bind/example.com.db";
    allow-transfer { any; };
    allow-query { any; };
};

zone "1.168.192.in-addr.arpa" {
    type master;
    file "/var/lib/bind/192.168.1.db";
    allow-transfer { any; };
    allow-query { any; };
};
EOF

#    # ç”Ÿæˆæ­£å‘è§£ææ–‡ä»¶
    cat > /var/lib/bind/example.com.db << 'EOF'
$TTL    604800
@       IN      SOA     ns.example.com. admin.example.com. (
                        2023091501      ; Serial
                        604800          ; Refresh
                        86400           ; Retry
                        2419200         ; Expire
                        604800 )        ; Negative Cache TTL

; Name servers
@       IN      NS      ns.example.com.

; A records
ns      IN      A       192.168.1.10
www     IN      A       192.168.1.100
mail    IN      A       192.168.1.101
ftp     IN      A       192.168.1.102

; CNAME records
webmail IN      CNAME   mail

; MX records
@       IN      MX      10      mail.example.com.
EOF
    
    log "âœ… é…ç½®æ–‡ä»¶ç”Ÿæˆå®Œæˆ"
}

# éƒ¨ç½²éªŒè¯

validate_deployment() {
    log "ğŸ” éªŒè¯éƒ¨ç½²ç»“æœ..."
    
#    # æ£€æŸ¥é…ç½®è¯­æ³•
    if ! named-checkconf; then
        log "âŒ ä¸»é…ç½®æ–‡ä»¶è¯­æ³•é”™è¯¯"
        return 1
    fi
    
#    # æ£€æŸ¥åŸŸé…ç½®
    if ! named-checkzone example.com /var/lib/bind/example.com.db; then
        log "âŒ åŸŸé…ç½®æ–‡ä»¶è¯­æ³•é”™è¯¯"
        return 1
    fi
    
#    # å¯åŠ¨æœåŠ¡
    systemctl enable bind9
    systemctl start bind9
    
#    # æ£€æŸ¥æœåŠ¡çŠ¶æ€
    if systemctl is-active bind9 >/dev/null; then
        log "âœ… DNSæœåŠ¡å¯åŠ¨æˆåŠŸ"
    else
        log "âŒ DNSæœåŠ¡å¯åŠ¨å¤±è´¥"
        return 1
    fi
    
#    # åŠŸèƒ½æµ‹è¯•
    sleep 5  # ç­‰å¾…æœåŠ¡å®Œå…¨å¯åŠ¨
    if nslookup www.example.com 127.0.0.1 >/dev/null 2>&1; then
        log "âœ… DNSè§£æåŠŸèƒ½æ­£å¸¸"
    else
        log "âš ï¸ DNSè§£ææµ‹è¯•å¤±è´¥"
    fi
}

# ä¸»éƒ¨ç½²æµç¨‹

main() {
    log "ğŸš€ å¼€å§‹DNSæœåŠ¡å™¨è‡ªåŠ¨åŒ–éƒ¨ç½²"
    
    check_environment
    install_dns_server
    generate_config
    validate_deployment
    
    log "ğŸ‰ DNSæœåŠ¡å™¨éƒ¨ç½²å®Œæˆï¼"
    log "ğŸ“Š éƒ¨ç½²ä¿¡æ¯ï¼š"
    log "   - æœåŠ¡çŠ¶æ€ï¼š$(systemctl is-active bind9)"
    log "   - é…ç½®è·¯å¾„ï¼š/etc/bind/"
    log "   - æ—¥å¿—æ–‡ä»¶ï¼š$LOG_FILE"
    log "   - å¤‡ä»½è·¯å¾„ï¼š$BACKUP_DIR"
}

# æ‰§è¡Œéƒ¨ç½²

main "$@"
```

### 2.3 é…ç½®æ¨¡æ¿ç³»ç»Ÿ



**æ¨¡æ¿åŒ–é…ç½®ç®¡ç†**ï¼š
```bash
#!/bin/bash

# DNSé…ç½®æ¨¡æ¿ç”Ÿæˆå™¨


# æ¨¡æ¿å˜é‡

DOMAIN_NAME="{{DOMAIN}}"
PRIMARY_IP="{{PRIMARY_IP}}"
SECONDARY_IP="{{SECONDARY_IP}}"
ADMIN_EMAIL="{{ADMIN_EMAIL}}"

# ç”Ÿæˆé…ç½®æ¨¡æ¿

generate_from_template() {
    local template_file="$1"
    local output_file="$2"
    local domain="$3"
    local primary_ip="$4"
    local admin_email="$5"
    
#    # æ›¿æ¢æ¨¡æ¿å˜é‡
    sed -e "s/{{DOMAIN}}/$domain/g" \
        -e "s/{{PRIMARY_IP}}/$primary_ip/g" \
        -e "s/{{ADMIN_EMAIL}}/$admin_email/g" \
        "$template_file" > "$output_file"
    
    echo "âœ… é…ç½®æ–‡ä»¶ç”Ÿæˆï¼š$output_file"
}

# æ‰¹é‡éƒ¨ç½²å¤šä¸ªåŸŸ

deploy_multiple_domains() {
    local domains_config="$1"
    
    while IFS=',' read -r domain primary_ip admin_email; do
        echo "éƒ¨ç½²åŸŸï¼š$domain"
        generate_from_template "zone.template" \
            "/var/lib/bind/$domain.db" \
            "$domain" "$primary_ip" "$admin_email"
    done < "$domains_config"
}
```

---

## 3. ğŸ”„ åŠ¨æ€DNSæ›´æ–°è„šæœ¬



### 3.1 åŠ¨æ€DNSçš„æ¦‚å¿µ



**ä»€ä¹ˆæ˜¯åŠ¨æ€DNS**ï¼šå½“IPåœ°å€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè‡ªåŠ¨æ›´æ–°DNSè®°å½•ï¼Œä¿æŒåŸŸåè§£æçš„å‡†ç¡®æ€§

**åº”ç”¨åœºæ™¯**ï¼š
- ğŸ  **å®¶åº­ç½‘ç»œ**ï¼šå®¶ç”¨è·¯ç”±å™¨IPåœ°å€ç»å¸¸å˜åŒ–
- â˜ï¸ **äº‘æœåŠ¡å™¨**ï¼šå¼¹æ€§IPåœ°å€å˜æ›´
- ğŸ”„ **è´Ÿè½½å‡è¡¡**ï¼šæœåŠ¡å™¨ä¸Šä¸‹çº¿æ—¶è‡ªåŠ¨æ›´æ–°
- ğŸ›¡ï¸ **æ•…éšœåˆ‡æ¢**ï¼šä¸»æœåŠ¡å™¨æ•…éšœæ—¶åˆ‡æ¢åˆ°å¤‡ç”¨æœåŠ¡å™¨

### 3.2 æ£€æµ‹IPå˜åŒ–çš„æ–¹æ³•



```bash
#!/bin/bash

# IPå˜åŒ–æ£€æµ‹è„šæœ¬


CURRENT_IP_FILE="/tmp/current_ip"
DOMAIN="home.example.com"

# è·å–å½“å‰å…¬ç½‘IP

get_current_ip() {
#    # æ–¹æ³•1ï¼šä½¿ç”¨å¤–éƒ¨æœåŠ¡
    curl -s http://ipinfo.io/ip 2>/dev/null || \
    curl -s http://icanhazip.com 2>/dev/null || \
    curl -s http://ipecho.net/plain 2>/dev/null
}

# è·å–DNSè®°å½•ä¸­çš„IP

get_dns_ip() {
    local domain="$1"
    dig +short "$domain" @8.8.8.8 | head -n1
}

# æ£€æŸ¥IPæ˜¯å¦å˜åŒ–

check_ip_change() {
    local current_ip
    local old_ip
    local dns_ip
    
    current_ip=$(get_current_ip)
    dns_ip=$(get_dns_ip "$DOMAIN")
    
    if [ -f "$CURRENT_IP_FILE" ]; then
        old_ip=$(cat "$CURRENT_IP_FILE")
    fi
    
    echo "å½“å‰IPï¼š$current_ip"
    echo "DNSè®°å½•IPï¼š$dns_ip"
    echo "ä¸Šæ¬¡è®°å½•IPï¼š$old_ip"
    
#    # åˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°
    if [ "$current_ip" != "$dns_ip" ] || [ "$current_ip" != "$old_ip" ]; then
        echo "ğŸ”„ æ£€æµ‹åˆ°IPå˜åŒ–ï¼Œéœ€è¦æ›´æ–°DNS"
        echo "$current_ip" > "$CURRENT_IP_FILE"
        return 0  # éœ€è¦æ›´æ–°
    else
        echo "âœ… IPåœ°å€æ— å˜åŒ–"
        return 1  # ä¸éœ€è¦æ›´æ–°
    fi
}
```

### 3.3 nsupdateåŠ¨æ€æ›´æ–°



**nsupdateå·¥å…·ç®€ä»‹**ï¼šBINDæä¾›çš„åŠ¨æ€DNSæ›´æ–°å·¥å…·ï¼Œå¯ä»¥å®æ—¶ä¿®æ”¹DNSè®°å½•

```bash
#!/bin/bash

# ä½¿ç”¨nsupdateæ›´æ–°DNSè®°å½•


DNS_SERVER="127.0.0.1"
ZONE="example.com"
HOSTNAME="home"
TTL=300

# ä½¿ç”¨nsupdateæ›´æ–°è®°å½•

update_dns_record() {
    local hostname="$1"
    local new_ip="$2"
    local ttl="${3:-300}"
    
    echo "ğŸ”„ æ›´æ–°DNSè®°å½•ï¼š$hostname.$ZONE -> $new_ip"
    
#    # åˆ›å»ºæ›´æ–°æŒ‡ä»¤
    nsupdate << EOF
server $DNS_SERVER
zone $ZONE
update delete $hostname.$ZONE A
update add $hostname.$ZONE $ttl A $new_ip
send
quit
EOF
    
    if [ $? -eq 0 ]; then
        echo "âœ… DNSè®°å½•æ›´æ–°æˆåŠŸ"
        
#        # éªŒè¯æ›´æ–°ç»“æœ
        sleep 2
        local updated_ip=$(dig +short "$hostname.$ZONE" @"$DNS_SERVER")
        if [ "$updated_ip" = "$new_ip" ]; then
            echo "âœ… æ›´æ–°éªŒè¯æˆåŠŸï¼š$updated_ip"
        else
            echo "âš ï¸ æ›´æ–°éªŒè¯å¤±è´¥ï¼Œå½“å‰è§£æï¼š$updated_ip"
        fi
    else
        echo "âŒ DNSè®°å½•æ›´æ–°å¤±è´¥"
        return 1
    fi
}

# å¸¦é‡è¯•æœºåˆ¶çš„æ›´æ–°

update_with_retry() {
    local hostname="$1"
    local new_ip="$2"
    local max_retry=3
    local retry_count=0
    
    while [ $retry_count -lt $max_retry ]; do
        if update_dns_record "$hostname" "$new_ip"; then
            return 0
        fi
        
        retry_count=$((retry_count + 1))
        echo "âš ï¸ ç¬¬ $retry_count æ¬¡é‡è¯•..."
        sleep 5
    done
    
    echo "âŒ æ›´æ–°å¤±è´¥ï¼Œå·²é‡è¯• $max_retry æ¬¡"
    return 1
}
```

### 3.4 å®Œæ•´çš„åŠ¨æ€DNSè„šæœ¬



```bash
#!/bin/bash

# å®Œæ•´çš„åŠ¨æ€DNSæ›´æ–°è„šæœ¬


# é…ç½®å‚æ•°

CONFIG_FILE="/etc/ddns.conf"
LOG_FILE="/var/log/ddns.log"
LOCK_FILE="/var/run/ddns.lock"

# ä»é…ç½®æ–‡ä»¶è¯»å–å‚æ•°

load_config() {
    if [ -f "$CONFIG_FILE" ]; then
        source "$CONFIG_FILE"
    else
#        # é»˜è®¤é…ç½®
        DOMAIN="home.example.com"
        DNS_SERVER="127.0.0.1"
        CHECK_INTERVAL=300  # 5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
        NOTIFY_EMAIL="admin@example.com"
    fi
}

# æ—¥å¿—è®°å½•

log_message() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1" | tee -a "$LOG_FILE"
}

# å‘é€é€šçŸ¥é‚®ä»¶

send_notification() {
    local subject="$1"
    local message="$2"
    
    if command -v mail >/dev/null 2>&1 && [ -n "$NOTIFY_EMAIL" ]; then
        echo "$message" | mail -s "$subject" "$NOTIFY_EMAIL"
        log_message "ğŸ“§ é€šçŸ¥é‚®ä»¶å·²å‘é€åˆ° $NOTIFY_EMAIL"
    fi
}

# ä¸»æ›´æ–°é€»è¾‘

main_update() {
#    # æ£€æŸ¥é”æ–‡ä»¶ï¼Œé¿å…é‡å¤è¿è¡Œ
    if [ -f "$LOCK_FILE" ]; then
        log_message "âš ï¸ å‘ç°é”æ–‡ä»¶ï¼Œå¯èƒ½æœ‰å…¶ä»–å®ä¾‹æ­£åœ¨è¿è¡Œ"
        exit 1
    fi
    
#    # åˆ›å»ºé”æ–‡ä»¶
    echo $$ > "$LOCK_FILE"
    trap 'rm -f "$LOCK_FILE"' EXIT
    
    log_message "ğŸ” å¼€å§‹æ£€æŸ¥IPå˜åŒ–"
    
    if check_ip_change; then
        local current_ip=$(get_current_ip)
        log_message "ğŸ”„ IPå‘ç”Ÿå˜åŒ–ï¼Œæ›´æ–°ä¸ºï¼š$current_ip"
        
        if update_with_retry "${DOMAIN%%.*}" "$current_ip"; then
            log_message "âœ… åŠ¨æ€DNSæ›´æ–°æˆåŠŸ"
            send_notification "DDNSæ›´æ–°æˆåŠŸ" \
                "åŸŸå $DOMAIN å·²æ›´æ–°ä¸ºæ–°IPï¼š$current_ip"
        else
            log_message "âŒ åŠ¨æ€DNSæ›´æ–°å¤±è´¥"
            send_notification "DDNSæ›´æ–°å¤±è´¥" \
                "åŸŸå $DOMAIN æ›´æ–°å¤±è´¥ï¼Œè¯·æ£€æŸ¥é…ç½®"
        fi
    else
        log_message "âœ… IPåœ°å€æ— å˜åŒ–ï¼Œæ— éœ€æ›´æ–°"
    fi
}

# å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼

daemon_mode() {
    log_message "ğŸš€ å¯åŠ¨åŠ¨æ€DNSå®ˆæŠ¤è¿›ç¨‹"
    
    while true; do
        main_update
        sleep "$CHECK_INTERVAL"
    done
}

# å‘½ä»¤è¡Œå‚æ•°å¤„ç†

case "$1" in
    "daemon")
        load_config
        daemon_mode
        ;;
    "once")
        load_config
        main_update
        ;;
    *)
        echo "ç”¨æ³•ï¼š$0 {daemon|once}"
        echo "  daemon - å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ï¼ŒæŒç»­ç›‘æ§"
        echo "  once   - å•æ¬¡æ£€æŸ¥æ¨¡å¼"
        exit 1
        ;;
esac
```

---

## 4. ğŸ“Š DNSç›‘æ§å‘Šè­¦è„šæœ¬



### 4.1 DNSç›‘æ§çš„é‡è¦æ€§



**ä¸ºä»€ä¹ˆéœ€è¦DNSç›‘æ§**ï¼š
- ğŸ” **æœåŠ¡å¯ç”¨æ€§**ï¼šç¡®ä¿DNSæœåŠ¡æ­£å¸¸è¿è¡Œ
- âš¡ **å“åº”æ€§èƒ½**ï¼šç›‘æ§æŸ¥è¯¢å“åº”æ—¶é—´
- ğŸ¯ **è§£æå‡†ç¡®æ€§**ï¼šéªŒè¯åŸŸåè§£æç»“æœ
- ğŸ“ˆ **è¶‹åŠ¿åˆ†æ**ï¼šäº†è§£DNSæœåŠ¡è´Ÿè½½æƒ…å†µ

### 4.2 åŸºç¡€ç›‘æ§è„šæœ¬



```bash
#!/bin/bash

# DNSæœåŠ¡ç›‘æ§è„šæœ¬


MONITOR_CONFIG="/etc/dns-monitor.conf"
ALERT_LOG="/var/log/dns-alert.log"

# ç›‘æ§é…ç½®

DNS_SERVERS=("127.0.0.1" "8.8.8.8" "1.1.1.1")
TEST_DOMAINS=("www.example.com" "mail.example.com")
RESPONSE_THRESHOLD=2000  # å“åº”æ—¶é—´é˜ˆå€¼(æ¯«ç§’)
FAILURE_THRESHOLD=3      # è¿ç»­å¤±è´¥æ¬¡æ•°é˜ˆå€¼

# æ£€æŸ¥DNSæœåŠ¡çŠ¶æ€

check_dns_service() {
    local dns_server="$1"
    
#    # æ£€æŸ¥ç«¯å£æ˜¯å¦å¼€æ”¾
    if ! nc -z -w3 "$dns_server" 53 2>/dev/null; then
        echo "âŒ DNSæœåŠ¡å™¨ $dns_server ç«¯å£53ä¸å¯è¾¾"
        return 1
    fi
    
    echo "âœ… DNSæœåŠ¡å™¨ $dns_server ç«¯å£æ­£å¸¸"
    return 0
}

# æ£€æŸ¥åŸŸåè§£æ

check_domain_resolution() {
    local domain="$1"
    local dns_server="$2"
    local start_time end_time response_time
    
#    # è®°å½•å¼€å§‹æ—¶é—´
    start_time=$(date +%s%3N)
    
#    # æ‰§è¡ŒDNSæŸ¥è¯¢
    local result=$(dig +short "$domain" @"$dns_server" 2>/dev/null)
    local exit_code=$?
    
#    # è®¡ç®—å“åº”æ—¶é—´
    end_time=$(date +%s%3N)
    response_time=$((end_time - start_time))
    
    if [ $exit_code -eq 0 ] && [ -n "$result" ]; then
        if [ $response_time -gt $RESPONSE_THRESHOLD ]; then
            echo "âš ï¸ $domain è§£ææˆåŠŸä½†å“åº”æ…¢: ${response_time}ms"
            return 2  # å“åº”æ…¢
        else
            echo "âœ… $domain è§£ææ­£å¸¸: ${response_time}ms -> $result"
            return 0  # æ­£å¸¸
        fi
    else
        echo "âŒ $domain è§£æå¤±è´¥"
        return 1  # å¤±è´¥
    fi
}

# ç»¼åˆå¥åº·æ£€æŸ¥

health_check() {
    local dns_server="$1"
    local health_score=0
    local total_checks=0
    
    echo "ğŸ” æ£€æŸ¥DNSæœåŠ¡å™¨ï¼š$dns_server"
    
#    # æ£€æŸ¥æœåŠ¡çŠ¶æ€
    if check_dns_service "$dns_server"; then
        health_score=$((health_score + 1))
    fi
    total_checks=$((total_checks + 1))
    
#    # æ£€æŸ¥åŸŸåè§£æ
    for domain in "${TEST_DOMAINS[@]}"; do
        case $(check_domain_resolution "$domain" "$dns_server"; echo $?) in
            0) health_score=$((health_score + 1)) ;;  # æ­£å¸¸
            2) health_score=$((health_score + 0.5)) ;; # å“åº”æ…¢
            *) ;;  # å¤±è´¥ï¼Œä¸åŠ åˆ†
        esac
        total_checks=$((total_checks + 1))
    done
    
#    # è®¡ç®—å¥åº·åˆ†æ•°ï¼ˆç™¾åˆ†æ¯”ï¼‰
    local health_percentage=$(echo "scale=0; $health_score * 100 / $total_checks" | bc)
    echo "ğŸ“Š $dns_server å¥åº·åˆ†æ•°ï¼š$health_percentage%"
    
    return $health_percentage
}
```

### 4.3 å‘Šè­¦é€šçŸ¥ç³»ç»Ÿ



```bash
#!/bin/bash

# DNSå‘Šè­¦é€šçŸ¥è„šæœ¬


# å‘Šè­¦çº§åˆ«å®šä¹‰

ALERT_LEVELS=("INFO" "WARNING" "ERROR" "CRITICAL")
ALERT_COLORS=("\033[0;32m" "\033[0;33m" "\033[0;31m" "\033[1;31m")

# å‘é€å‘Šè­¦

send_alert() {
    local level="$1"
    local message="$2"
    local timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    
#    # è®°å½•åˆ°æ—¥å¿—
    echo "[$timestamp] [$level] $message" >> "$ALERT_LOG"
    
#    # æ§åˆ¶å°è¾“å‡ºï¼ˆå¸¦é¢œè‰²ï¼‰
    case "$level" in
        "INFO")     color_index=0 ;;
        "WARNING")  color_index=1 ;;
        "ERROR")    color_index=2 ;;
        "CRITICAL") color_index=3 ;;
        *)          color_index=0 ;;
    esac
    
    echo -e "${ALERT_COLORS[$color_index]}[$level] $message\033[0m"
    
#    # æ ¹æ®çº§åˆ«å‘é€é€šçŸ¥
    case "$level" in
        "CRITICAL"|"ERROR")
            send_email_alert "$level" "$message"
            send_webhook_alert "$level" "$message"
            ;;
        "WARNING")
            send_webhook_alert "$level" "$message"
            ;;
    esac
}

# é‚®ä»¶å‘Šè­¦

send_email_alert() {
    local level="$1"
    local message="$2"
    
    if [ -n "$ALERT_EMAIL" ] && command -v mail >/dev/null; then
        {
            echo "DNSç›‘æ§å‘Šè­¦"
            echo "============"
            echo "æ—¶é—´ï¼š$(date)"
            echo "çº§åˆ«ï¼š$level"
            echo "æ¶ˆæ¯ï¼š$message"
            echo "ä¸»æœºï¼š$(hostname)"
        } | mail -s "DNSå‘Šè­¦: $level" "$ALERT_EMAIL"
    fi
}

# Webhookå‘Šè­¦

send_webhook_alert() {
    local level="$1"
    local message="$2"
    
    if [ -n "$WEBHOOK_URL" ]; then
        local payload=$(cat << EOF
{
    "text": "DNSç›‘æ§å‘Šè­¦",
    "attachments": [
        {
            "color": "danger",
            "fields": [
                {
                    "title": "çº§åˆ«",
                    "value": "$level",
                    "short": true
                },
                {
                    "title": "æ¶ˆæ¯",
                    "value": "$message",
                    "short": false
                },
                {
                    "title": "ä¸»æœº",
                    "value": "$(hostname)",
                    "short": true
                },
                {
                    "title": "æ—¶é—´",
                    "value": "$(date)",
                    "short": true
                }
            ]
        }
    ]
}
EOF
        )
        
        curl -X POST -H 'Content-type: application/json' \
             --data "$payload" "$WEBHOOK_URL" 2>/dev/null
    fi
}

# æŒç»­ç›‘æ§ä¸»å¾ªç¯

continuous_monitor() {
    local failure_counts=()
    
#    # åˆå§‹åŒ–å¤±è´¥è®¡æ•°å™¨
    for dns_server in "${DNS_SERVERS[@]}"; do
        failure_counts["$dns_server"]=0
    done
    
    while true; do
        for dns_server in "${DNS_SERVERS[@]}"; do
            health_check "$dns_server"
            local health_score=$?
            
            if [ $health_score -lt 50 ]; then
#                # å¥åº·åˆ†æ•°ä½äº50%
                failure_counts["$dns_server"]=$((failure_counts["$dns_server"] + 1))
                
                if [ ${failure_counts["$dns_server"]} -ge $FAILURE_THRESHOLD ]; then
                    send_alert "CRITICAL" "DNSæœåŠ¡å™¨ $dns_server è¿ç»­ ${failure_counts["$dns_server"]} æ¬¡æ£€æŸ¥å¤±è´¥"
                else
                    send_alert "WARNING" "DNSæœåŠ¡å™¨ $dns_server å¥åº·æ£€æŸ¥å¤±è´¥ (${failure_counts["$dns_server"]}/$FAILURE_THRESHOLD)"
                fi
            elif [ $health_score -lt 80 ]; then
#                # å¥åº·åˆ†æ•°åœ¨50-80%ä¹‹é—´
                send_alert "WARNING" "DNSæœåŠ¡å™¨ $dns_server æ€§èƒ½ä¸‹é™ï¼Œå¥åº·åˆ†æ•°: $health_score%"
                failure_counts["$dns_server"]=0  # é‡ç½®è®¡æ•°å™¨
            else
#                # å¥åº·åˆ†æ•°æ­£å¸¸
                if [ ${failure_counts["$dns_server"]} -gt 0 ]; then
                    send_alert "INFO" "DNSæœåŠ¡å™¨ $dns_server å·²æ¢å¤æ­£å¸¸"
                fi
                failure_counts["$dns_server"]=0
            fi
        done
        
        sleep 60  # æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
    done
}
```

---

## 5. ğŸ” æ‰¹é‡åŸŸåè§£æå·¥å…·



### 5.1 æ‰¹é‡è§£æçš„åº”ç”¨åœºæ™¯



**ä¸ºä»€ä¹ˆéœ€è¦æ‰¹é‡åŸŸåè§£æ**ï¼š
- ğŸ“‹ **åŸŸåæ¸…å•æ£€æŸ¥**ï¼šéªŒè¯å¤§é‡åŸŸåçš„è§£æçŠ¶æ€
- ğŸ” **ç½‘ç»œèµ„äº§å‘ç°**ï¼šæ‰¹é‡è§£æå­åŸŸå
- ğŸ“Š **DNSæ€§èƒ½æµ‹è¯•**ï¼šæµ‹è¯•DNSæœåŠ¡å™¨å¤„ç†èƒ½åŠ›
- ğŸ›¡ï¸ **å®‰å…¨æ‰«æ**ï¼šæ£€æŸ¥åŸŸåè§£æå¼‚å¸¸

### 5.2 åŸºç¡€æ‰¹é‡è§£æè„šæœ¬



```bash
#!/bin/bash

# æ‰¹é‡åŸŸåè§£æå·¥å…·


OUTPUT_DIR="./dns_results"
CONCURRENT_JOBS=10  # å¹¶å‘ä»»åŠ¡æ•°

# åˆ›å»ºè¾“å‡ºç›®å½•

mkdir -p "$OUTPUT_DIR"

# å•ä¸ªåŸŸåè§£æå‡½æ•°

resolve_domain() {
    local domain="$1"
    local dns_server="${2:-8.8.8.8}"
    local output_file="$OUTPUT_DIR/$(echo "$domain" | tr '/' '_').txt"
    
    {
        echo "åŸŸå: $domain"
        echo "DNSæœåŠ¡å™¨: $dns_server"
        echo "æŸ¥è¯¢æ—¶é—´: $(date)"
        echo "===================="
        
#        # Aè®°å½•æŸ¥è¯¢
        echo "Aè®°å½•:"
        dig +short A "$domain" @"$dns_server" | while read ip; do
            [ -n "$ip" ] && echo "  $ip"
        done
        
#        # AAAAè®°å½•æŸ¥è¯¢
        echo "AAAAè®°å½•:"
        dig +short AAAA "$domain" @"$dns_server" | while read ipv6; do
            [ -n "$ipv6" ] && echo "  $ipv6"
        done
        
#        # CNAMEè®°å½•æŸ¥è¯¢
        echo "CNAMEè®°å½•:"
        dig +short CNAME "$domain" @"$dns_server" | while read cname; do
            [ -n "$cname" ] && echo "  $cname"
        done
        
#        # MXè®°å½•æŸ¥è¯¢
        echo "MXè®°å½•:"
        dig +short MX "$domain" @"$dns_server" | while read mx; do
            [ -n "$mx" ] && echo "  $mx"
        done
        
#        # TXTè®°å½•æŸ¥è¯¢
        echo "TXTè®°å½•:"
        dig +short TXT "$domain" @"$dns_server" | while read txt; do
            [ -n "$txt" ] && echo "  $txt"
        done
        
    } > "$output_file" 2>&1
    
    echo "âœ… $domain è§£æå®Œæˆ -> $output_file"
}

# å¹¶å‘æ‰¹é‡è§£æ

batch_resolve() {
    local domain_list="$1"
    local dns_server="${2:-8.8.8.8}"
    
    echo "ğŸš€ å¼€å§‹æ‰¹é‡åŸŸåè§£æ"
    echo "ğŸ“„ åŸŸååˆ—è¡¨: $domain_list"
    echo "ğŸŒ DNSæœåŠ¡å™¨: $dns_server"
    echo "âš¡ å¹¶å‘æ•°: $CONCURRENT_JOBS"
    
#    # è®¡ç®—æ€»åŸŸåæ•°
    local total_domains=$(wc -l < "$domain_list")
    echo "ğŸ“Š æ€»åŸŸåæ•°: $total_domains"
    
#    # è¿›åº¦è®¡æ•°å™¨
    local completed=0
    
#    # è¯»å–åŸŸååˆ—è¡¨å¹¶å¹¶å‘è§£æ
    while IFS= read -r domain; do
#        # è·³è¿‡ç©ºè¡Œå’Œæ³¨é‡Šè¡Œ
        [[ -z "$domain" || "$domain" =~ ^#.*$ ]] && continue
        
#        # æ§åˆ¶å¹¶å‘æ•°
        while [ $(jobs -r | wc -l) -ge $CONCURRENT_JOBS ]; do
            sleep 0.1
        done
        
#        # åå°æ‰§è¡Œè§£æ
        {
            resolve_domain "$domain" "$dns_server"
            completed=$((completed + 1))
            echo "ğŸ“ˆ è¿›åº¦: $completed/$total_domains ($((completed * 100 / total_domains))%)"
        } &
        
    done < "$domain_list"
    
#    # ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ
    wait
    echo "ğŸ‰ æ‰¹é‡è§£æå®Œæˆï¼ç»“æœä¿å­˜åœ¨: $OUTPUT_DIR"
}
```

### 5.3 é«˜çº§æ‰¹é‡è§£æåŠŸèƒ½



```bash
#!/bin/bash

# é«˜çº§æ‰¹é‡åŸŸåè§£æå·¥å…·


# å¤šDNSæœåŠ¡å™¨å¯¹æ¯”è§£æ

compare_dns_servers() {
    local domain="$1"
    local servers=("8.8.8.8" "1.1.1.1" "114.114.114.114" "127.0.0.1")
    
    echo "ğŸ” å¤šDNSæœåŠ¡å™¨è§£æå¯¹æ¯”: $domain"
    echo "==============================="
    
    for server in "${servers[@]}"; do
        echo "DNSæœåŠ¡å™¨: $server"
        local start_time=$(date +%s%3N)
        local result=$(dig +short A "$domain" @"$server" 2>/dev/null)
        local end_time=$(date +%s%3N)
        local response_time=$((end_time - start_time))
        
        if [ -n "$result" ]; then
            echo "  ç»“æœ: $result"
            echo "  å“åº”æ—¶é—´: ${response_time}ms"
        else
            echo "  ç»“æœ: è§£æå¤±è´¥"
        fi
        echo "  ---"
    done
}

# å­åŸŸåæšä¸¾

enumerate_subdomains() {
    local domain="$1"
    local subdomain_list="${2:-/usr/share/dns/subdomains.txt}"
    
    echo "ğŸ” å­åŸŸåæšä¸¾: $domain"
    
#    # å¸¸è§å­åŸŸååˆ—è¡¨
    local common_subdomains=(
        "www" "mail" "ftp" "admin" "test" "dev" "staging"
        "api" "cdn" "blog" "shop" "secure" "vpn" "remote"
    )
    
    for subdomain in "${common_subdomains[@]}"; do
        local full_domain="$subdomain.$domain"
        local result=$(dig +short A "$full_domain" 2>/dev/null)
        
        if [ -n "$result" ]; then
            echo "âœ… $full_domain -> $result"
        fi
    done
}

# ç”Ÿæˆè§£ææŠ¥å‘Š

generate_report() {
    local output_dir="$1"
    local report_file="$output_dir/dns_report.html"
    
    cat > "$report_file" << 'EOF'
<!DOCTYPE html>
<html>
<head>
    <title>DNSè§£ææŠ¥å‘Š</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { background: #f4f4f4; padding: 15px; border-radius: 5px; }
        .domain { margin: 20px 0; border: 1px solid #ddd; padding: 15px; }
        .success { color: green; }
        .error { color: red; }
        .warning { color: orange; }
    </style>
</head>
<body>
    <div class="header">
        <h1>DNSè§£ææŠ¥å‘Š</h1>
        <p>ç”Ÿæˆæ—¶é—´: $(date)</p>
    </div>
EOF

#    # ç»Ÿè®¡ä¿¡æ¯
    local total_files=$(find "$output_dir" -name "*.txt" | wc -l)
    local success_count=0
    local error_count=0
    
    echo "    <h2>ç»Ÿè®¡ä¿¡æ¯</h2>" >> "$report_file"
    echo "    <p>æ€»åŸŸåæ•°: $total_files</p>" >> "$report_file"
    
#    # å¤„ç†æ¯ä¸ªè§£æç»“æœæ–‡ä»¶
    for result_file in "$output_dir"/*.txt; do
        [ ! -f "$result_file" ] && continue
        
        local domain=$(basename "$result_file" .txt | tr '_' '/')
        local has_ip=$(grep -c "Aè®°å½•:" "$result_file")
        
        if [ $has_ip -gt 0 ]; then
            success_count=$((success_count + 1))
            echo "    <div class='domain success'>âœ… $domain</div>" >> "$report_file"
        else
            error_count=$((error_count + 1))
            echo "    <div class='domain error'>âŒ $domain</div>" >> "$report_file"
        fi
    done
    
    echo "    <p class='success'>æˆåŠŸè§£æ: $success_count</p>" >> "$report_file"
    echo "    <p class='error'>è§£æå¤±è´¥: $error_count</p>" >> "$report_file"
    echo "</body></html>" >> "$report_file"
    
    echo "ğŸ“Š HTMLæŠ¥å‘Šç”Ÿæˆå®Œæˆ: $report_file"
}
```

---

## 6. ğŸ“ DNSé…ç½®æ¨¡æ¿åŒ–ç®¡ç†



### 6.1 æ¨¡æ¿åŒ–ç®¡ç†çš„ä¼˜åŠ¿



**ä»€ä¹ˆæ˜¯DNSé…ç½®æ¨¡æ¿åŒ–**ï¼šå°†DNSé…ç½®æ–‡ä»¶æŠ½è±¡æˆå¯é‡ç”¨çš„æ¨¡æ¿ï¼Œé€šè¿‡å˜é‡æ›¿æ¢ç”Ÿæˆå…·ä½“é…ç½®

**æ¨¡æ¿åŒ–çš„å¥½å¤„**ï¼š
- ğŸ”„ **æ ‡å‡†åŒ–é…ç½®**ï¼šç¡®ä¿æ‰€æœ‰åŸŸåé…ç½®çš„ä¸€è‡´æ€§
- âš¡ **å¿«é€Ÿéƒ¨ç½²**ï¼šé€šè¿‡æ¨¡æ¿å¿«é€Ÿç”Ÿæˆæ–°åŸŸåé…ç½®
- ğŸ› ï¸ **æ‰¹é‡ç®¡ç†**ï¼šåŒæ—¶ç®¡ç†å¤šä¸ªç›¸ä¼¼çš„åŸŸåé…ç½®
- ğŸ”§ **å‡å°‘é”™è¯¯**ï¼šé¿å…æ‰‹å·¥é…ç½®çš„è¯­æ³•é”™è¯¯

### 6.2 DNSé…ç½®æ¨¡æ¿è®¾è®¡



```bash
#!/bin/bash

# DNSé…ç½®æ¨¡æ¿ç®¡ç†ç³»ç»Ÿ


TEMPLATE_DIR="/etc/dns-templates"
CONFIG_DIR="/etc/bind"
ZONE_DIR="/var/lib/bind"

# åˆ›å»ºç›®å½•ç»“æ„

mkdir -p "$TEMPLATE_DIR" "$CONFIG_DIR" "$ZONE_DIR"

# åŸŸåé…ç½®æ¨¡æ¿

create_zone_template() {
    cat > "$TEMPLATE_DIR/zone.template" << 'EOF'
; DNS Zone Template for {{DOMAIN}}
; Generated: {{TIMESTAMP}}

$TTL    {{DEFAULT_TTL}}
@       IN      SOA     {{PRIMARY_NS}}. {{ADMIN_EMAIL}}. (
                        {{SERIAL}}          ; Serial
                        {{REFRESH}}         ; Refresh
                        {{RETRY}}           ; Retry
                        {{EXPIRE}}          ; Expire
                        {{NEGATIVE_TTL}} )  ; Negative Cache TTL

; Name servers
@       IN      NS      {{PRIMARY_NS}}.
@       IN      NS      {{SECONDARY_NS}}.

; A records
{{PRIMARY_NS}}  IN      A       {{NS_IP}}
www             IN      A       {{WEB_IP}}
mail            IN      A       {{MAIL_IP}}
ftp             IN      A       {{FTP_IP}}

; CNAME records
webmail         IN      CNAME   mail
smtp            IN      CNAME   mail
pop             IN      CNAME   mail
imap            IN      CNAME   mail

; MX records
@               IN      MX      10      mail.{{DOMAIN}}.

; TXT records (SPF, DKIMç­‰)
@               IN      TXT     "v=spf1 mx a ip4:{{MAIL_IP}} ~all"
EOF

    echo "âœ… åŸŸåé…ç½®æ¨¡æ¿åˆ›å»ºå®Œæˆ"
}

# åå‘è§£ææ¨¡æ¿

create_reverse_template() {
    cat > "$TEMPLATE_DIR/reverse.template" << 'EOF'
; Reverse DNS Template for {{NETWORK}}
; Generated: {{TIMESTAMP}}

$TTL    {{DEFAULT_TTL}}
@       IN      SOA     {{PRIMARY_NS}}. {{ADMIN_EMAIL}}. (
                        {{SERIAL}}          ; Serial
                        {{REFRESH}}         ; Refresh
                        {{RETRY}}           ; Retry
                        {{EXPIRE}}          ; Expire
                        {{NEGATIVE_TTL}} )  ; Negative Cache TTL

; Name servers
@       IN      NS      {{PRIMARY_NS}}.
@       IN      NS      {{SECONDARY_NS}}.

; PTR records
{{HOST_OCTET}}  IN      PTR     {{HOSTNAME}}.{{DOMAIN}}.
EOF

    echo "âœ… åå‘è§£ææ¨¡æ¿åˆ›å»ºå®Œæˆ"
}
```

### 6.3 é…ç½®ç”Ÿæˆå™¨



```bash
#!/bin/bash

# DNSé…ç½®ç”Ÿæˆå™¨


# é…ç½®å˜é‡

declare -A DNS_VARS

# åŠ è½½é…ç½®å˜é‡

load_variables() {
    local config_file="$1"
    
    if [ -f "$config_file" ]; then
        while IFS='=' read -r key value; do
#            # è·³è¿‡æ³¨é‡Šå’Œç©ºè¡Œ
            [[ "$key" =~ ^#.*$ || -z "$key" ]] && continue
            
#            # å»é™¤å€¼çš„å¼•å·
            value=$(echo "$value" | sed 's/^"\(.*\)"$/\1/')
            DNS_VARS["$key"]="$value"
        done < "$config_file"
    else
        echo "âŒ é…ç½®æ–‡ä»¶ä¸å­˜åœ¨: $config_file"
        return 1
    fi
}

# æ›¿æ¢æ¨¡æ¿å˜é‡

replace_template_vars() {
    local template_file="$1"
    local output_file="$2"
    
#    # å¤åˆ¶æ¨¡æ¿åˆ°è¾“å‡ºæ–‡ä»¶
    cp "$template_file" "$output_file"
    
#    # æ›¿æ¢æ‰€æœ‰å˜é‡
    for var in "${!DNS_VARS[@]}"; do
        local value="${DNS_VARS[$var]}"
        sed -i "s/{{$var}}/$value/g" "$output_file"
    done
    
#    # æ·»åŠ æ—¶é—´æˆ³
    local timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    sed -i "s/{{TIMESTAMP}}/$timestamp/g" "$output_file"
    
    echo "âœ… é…ç½®æ–‡ä»¶ç”Ÿæˆ: $output_file"
}

# ç”Ÿæˆåºåˆ—å·

generate_serial() {
#    # ä½¿ç”¨æ—¥æœŸæ—¶é—´æ ¼å¼: YYYYMMDDNN
    local date_part=$(date +%Y%m%d)
    local time_part=$(date +%H%M | sed 's/^0*//')
    echo "${date_part}$(printf "%02d" $((time_part % 100)))"
}

# æ‰¹é‡ç”ŸæˆåŸŸåé…ç½®

batch_generate_configs() {
    local domains_config="$1"
    
    echo "ğŸš€ å¼€å§‹æ‰¹é‡ç”ŸæˆDNSé…ç½®"
    
    while IFS=',' read -r domain web_ip mail_ip ns_ip admin_email; do
#        # è·³è¿‡æ³¨é‡Šè¡Œ
        [[ "$domain" =~ ^#.*$ ]] && continue
        
        echo "ç”Ÿæˆé…ç½®: $domain"
        
#        # è®¾ç½®åŸŸåç‰¹å®šçš„å˜é‡
        DNS_VARS["DOMAIN"]="$domain"
        DNS_VARS["WEB_IP"]="$web_ip"
        DNS_VARS["MAIL_IP"]="$mail_ip"
        DNS_VARS["NS_IP"]="$ns_ip"
        DNS_VARS["ADMIN_EMAIL"]="$admin_email"
        DNS_VARS["SERIAL"]=$(generate_serial)
        
#        # ç”Ÿæˆé…ç½®æ–‡ä»¶
        replace_template_vars "$TEMPLATE_DIR/zone.template" \
                             "$ZONE_DIR/$domain.db"
        
#        # æ·»åŠ åˆ°ä¸»é…ç½®æ–‡ä»¶
        add_zone_to_config "$domain"
        
    done < "$domains_config"
    
    echo "âœ… æ‰¹é‡é…ç½®ç”Ÿæˆå®Œæˆ"
}

# æ·»åŠ åŸŸååˆ°ä¸»é…ç½®

add_zone_to_config() {
    local domain="$1"
    local config_entry="
zone \"$domain\" {
    type master;
    file \"$ZONE_DIR/$domain.db\";
    allow-transfer { any; };
    allow-query { any; };
};"
    
#    # æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
    if ! grep -q "zone \"$domain\"" "$CONFIG_DIR/named.conf.local"; then
        echo "$config_entry" >> "$CONFIG_DIR/named.conf.local"
        echo "âœ… åŸŸå $domain å·²æ·»åŠ åˆ°ä¸»é…ç½®"
    else
        echo "âš ï¸ åŸŸå $domain å·²å­˜åœ¨äºä¸»é…ç½®ä¸­"
    fi
}
```

### 6.4 é…ç½®éªŒè¯å’Œéƒ¨ç½²



```bash
#!/bin/bash

# DNSé…ç½®éªŒè¯å’Œéƒ¨ç½²


# éªŒè¯å•ä¸ªåŸŸåé…ç½®

validate_zone_config() {
    local domain="$1"
    local zone_file="$ZONE_DIR/$domain.db"
    
    echo "ğŸ” éªŒè¯åŸŸåé…ç½®: $domain"
    
#    # æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨
    if [ ! -f "$zone_file" ]; then
        echo "âŒ é…ç½®æ–‡ä»¶ä¸å­˜åœ¨: $zone_file"
        return 1
    fi
    
#    # è¯­æ³•æ£€æŸ¥
    if named-checkzone "$domain" "$zone_file" >/dev/null 2>&1; then
        echo "âœ… $domain é…ç½®è¯­æ³•æ­£ç¡®"
        return 0
    else
        echo "âŒ $domain é…ç½®è¯­æ³•é”™è¯¯:"
        named-checkzone "$domain" "$zone_file"
        return 1
    fi
}

# æ‰¹é‡éªŒè¯é…ç½®

validate_all_configs() {
    local error_count=0
    local total_count=0
    
    echo "ğŸ” å¼€å§‹æ‰¹é‡éªŒè¯DNSé…ç½®"
    
#    # éªŒè¯ä¸»é…ç½®æ–‡ä»¶
    if named-checkconf "$CONFIG_DIR/named.conf" >/dev/null 2>&1; then
        echo "âœ… ä¸»é…ç½®æ–‡ä»¶è¯­æ³•æ­£ç¡®"
    else
        echo "âŒ ä¸»é…ç½®æ–‡ä»¶è¯­æ³•é”™è¯¯:"
        named-checkconf "$CONFIG_DIR/named.conf"
        error_count=$((error_count + 1))
    fi
    
#    # éªŒè¯æ‰€æœ‰åŸŸåé…ç½®
    for zone_file in "$ZONE_DIR"/*.db; do
        [ ! -f "$zone_file" ] && continue
        
        local domain=$(basename "$zone_file" .db)
        total_count=$((total_count + 1))
        
        if ! validate_zone_config "$domain"; then
            error_count=$((error_count + 1))
        fi
    done
    
    echo "ğŸ“Š éªŒè¯ç»“æœ:"
    echo "   æ€»é…ç½®æ•°: $total_count"
    echo "   é”™è¯¯æ•°é‡: $error_count"
    echo "   æˆåŠŸç‡: $(( (total_count - error_count) * 100 / total_count ))%"
    
    return $error_count
}

# å®‰å…¨éƒ¨ç½²é…ç½®

safe_deploy() {
    echo "ğŸš€ å¼€å§‹å®‰å…¨éƒ¨ç½²DNSé…ç½®"
    
#    # 1. åˆ›å»ºå¤‡ä»½
    local backup_dir="/backup/dns-$(date +%Y%m%d-%H%M%S)"
    mkdir -p "$backup_dir"
    cp -r "$CONFIG_DIR"/* "$backup_dir/"
    cp -r "$ZONE_DIR"/* "$backup_dir/"
    echo "ğŸ“¦ é…ç½®å¤‡ä»½å®Œæˆ: $backup_dir"
    
#    # 2. éªŒè¯é…ç½®
    if ! validate_all_configs; then
        echo "âŒ é…ç½®éªŒè¯å¤±è´¥ï¼Œå–æ¶ˆéƒ¨ç½²"
        return 1
    fi
    
#    # 3. é‡è½½æœåŠ¡
    if systemctl reload bind9; then
        echo "âœ… DNSæœåŠ¡é‡è½½æˆåŠŸ"
        
#        # 4. åŠŸèƒ½æµ‹è¯•
        sleep 3
        if test_dns_functionality; then
            echo "âœ… DNSåŠŸèƒ½æµ‹è¯•é€šè¿‡"
            echo "ğŸ‰ é…ç½®éƒ¨ç½²æˆåŠŸï¼"
        else
            echo "âŒ DNSåŠŸèƒ½æµ‹è¯•å¤±è´¥ï¼Œå›æ»šé…ç½®"
            restore_backup "$backup_dir"
        fi
    else
        echo "âŒ DNSæœåŠ¡é‡è½½å¤±è´¥ï¼Œå›æ»šé…ç½®"
        restore_backup "$backup_dir"
    fi
}

# æ¢å¤å¤‡ä»½é…ç½®

restore_backup() {
    local backup_dir="$1"
    
    echo "ğŸ”„ æ¢å¤é…ç½®å¤‡ä»½"
    cp -r "$backup_dir"/* "$CONFIG_DIR/"
    cp -r "$backup_dir"/* "$ZONE_DIR/"
    systemctl reload bind9
    echo "âœ… é…ç½®å·²æ¢å¤"
}
```

---

## 7. ğŸŒ APIæ¥å£DNSç®¡ç†



### 7.1 DNS APIç®¡ç†çš„æ¦‚å¿µ



**ä»€ä¹ˆæ˜¯DNS APIç®¡ç†**ï¼šé€šè¿‡HTTP APIæ¥å£æ¥ç®¡ç†DNSè®°å½•ï¼Œå®ç°ç¨‹åºåŒ–çš„DNSæ“ä½œ

**APIç®¡ç†çš„ä¼˜åŠ¿**ï¼š
- ğŸ”§ **è‡ªåŠ¨åŒ–é›†æˆ**ï¼šä¸å…¶ä»–ç³»ç»Ÿæ— ç¼é›†æˆ
- ğŸš€ **å¿«é€Ÿå“åº”**ï¼šç¨‹åºåŒ–æ“ä½œï¼Œå“åº”é€Ÿåº¦å¿«
- ğŸ“Š **ç»Ÿä¸€ç®¡ç†**ï¼šé€šè¿‡ç»Ÿä¸€æ¥å£ç®¡ç†æ‰€æœ‰DNSè®°å½•
- ğŸ”’ **æƒé™æ§åˆ¶**ï¼šç²¾ç»†åŒ–çš„è®¿é—®æ§åˆ¶

### 7.2 RESTful DNS APIè®¾è®¡



```bash
#!/bin/bash

# DNS APIæœåŠ¡å™¨è„šæœ¬ï¼ˆä½¿ç”¨ç®€å•çš„HTTPæœåŠ¡ï¼‰


API_PORT=8080
API_LOG="/var/log/dns-api.log"
AUTH_TOKEN="your-secret-token"

# APIå“åº”å‡½æ•°

send_response() {
    local status="$1"
    local content_type="$2"
    local body="$3"
    
    echo "HTTP/1.1 $status"
    echo "Content-Type: $content_type"
    echo "Content-Length: ${#body}"
    echo ""
    echo "$body"
}

# è®°å½•APIæ—¥å¿—

log_api() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1" >> "$API_LOG"
}

# éªŒè¯APIä»¤ç‰Œ

verify_token() {
    local provided_token="$1"
    
    if [ "$provided_token" = "$AUTH_TOKEN" ]; then
        return 0
    else
        return 1
    fi
}

# è·å–DNSè®°å½•

get_dns_record() {
    local domain="$1"
    local record_type="${2:-A}"
    
    log_api "GET /dns/$domain/$record_type"
    
    local result=$(dig +short "$record_type" "$domain" 2>/dev/null)
    
    if [ -n "$result" ]; then
        local json_response="{
            \"domain\": \"$domain\",
            \"type\": \"$record_type\",
            \"records\": ["
        
        local first=true
        while IFS= read -r line; do
            if [ "$first" = true ]; then
                first=false
            else
                json_response="$json_response,"
            fi
            json_response="$json_response \"$line\""
        done <<< "$result"
        
        json_response="$json_response ]
        }"
        
        send_response "200 OK" "application/json" "$json_response"
    else
        send_response "404 Not Found" "application/json" \
                     "{\"error\": \"Record not found\"}"
    fi
}

# æ·»åŠ DNSè®°å½•

add_dns_record() {
    local domain="$1"
    local record_type="$2"
    local value="$3"
    local ttl="${4:-300}"
    
    log_api "POST /dns/$domain - Type: $record_type, Value: $value"
    
#    # ä½¿ç”¨nsupdateæ·»åŠ è®°å½•
    if nsupdate << EOF
server 127.0.0.1
zone $domain
update add $domain $ttl $record_type $value
send
quit
EOF
    then
        send_response "201 Created" "application/json" \
                     "{\"message\": \"Record added successfully\"}"
        log_api "SUCCESS: Added $record_type record for $domain"
    else
        send_response "500 Internal Server Error" "application/json" \
                     "{\"error\": \"Failed to add record\"}"
        log_api "ERROR: Failed to add $record_type record for $domain"
    fi
}

# åˆ é™¤DNSè®°å½•

delete_dns_record() {
    local domain="$1"
    local record_type="$2"
    local value="$3"
    
    log_api "DELETE /dns/$domain - Type: $record_type, Value: $value"
    
    if nsupdate << EOF
server 127.0.0.1
zone $domain
update delete $domain $record_type $value
send
quit
EOF
    then
        send_response "200 OK" "application/json" \
                     "{\"message\": \"Record deleted successfully\"}"
        log_api "SUCCESS: Deleted $record_type record for $domain"
    else
        send_response "500 Internal Server Error" "application/json" \
                     "{\"error\": \"Failed to delete record\"}"
        log_api "ERROR: Failed to delete $record_type record for $domain"
    fi
}
```

### 7.3 APIå®¢æˆ·ç«¯å·¥å…·



```bash
#!/bin/bash

# DNS APIå®¢æˆ·ç«¯å·¥å…·


API_BASE_URL="http://localhost:8080"
API_TOKEN="your-secret-token"

# å‘é€APIè¯·æ±‚

api_request() {
    local method="$1"
    local endpoint="$2"
    local data="$3"
    
    local curl_opts="-s -X $method"
    curl_opts="$curl_opts -H 'Authorization: Bearer $API_TOKEN'"
    curl_opts="$curl_opts -H 'Content-Type: application/json'"
    
    if [ -n "$data" ]; then
        curl_opts="$curl_opts -d '$data'"
    fi
    
    eval curl $curl_opts "$API_BASE_URL$endpoint"
}

# æŸ¥è¯¢DNSè®°å½•

query_record() {
    local domain="$1"
    local record_type="${2:-A}"
    
    echo "ğŸ” æŸ¥è¯¢DNSè®°å½•: $domain ($record_type)"
    
    local response=$(api_request "GET" "/dns/$domain/$record_type")
    echo "$response" | python3 -m json.tool 2>/dev/null || echo "$response"
}

# æ·»åŠ DNSè®°å½•

add_record() {
    local domain="$1"
    local record_type="$2"
    local value="$3"
    local ttl="${4:-300}"
    
    echo "â• æ·»åŠ DNSè®°å½•: $domain -> $value ($record_type)"
    
    local data="{
        \"type\": \"$record_type\",
        \"value\": \"$value\",
        \"ttl\": $ttl
    }"
    
    local response=$(api_request "POST" "/dns/$domain" "$data")
    echo "$response" | python3 -m json.tool 2>/dev/null || echo "$response"
}

# åˆ é™¤DNSè®°å½•

delete_record() {
    local domain="$1"
    local record_type="$2"
    local value="$3"
    
    echo "ğŸ—‘ï¸ åˆ é™¤DNSè®°å½•: $domain ($record_type = $value)"
    
    local data="{
        \"type\": \"$record_type\",
        \"value\": \"$value\"
    }"
    
    local response=$(api_request "DELETE" "/dns/$domain" "$data")
    echo "$response" | python3 -m json.tool 2>/dev/null || echo "$response"
}

# æ‰¹é‡æ“ä½œ

batch_operations() {
    local operations_file="$1"
    
    echo "ğŸ“‹ æ‰§è¡Œæ‰¹é‡DNSæ“ä½œ"
    
    while IFS=',' read -r action domain record_type value ttl; do
#        # è·³è¿‡æ³¨é‡Šè¡Œ
        [[ "$action" =~ ^#.*$ ]] && continue
        
        case "$action" in
            "add")
                add_record "$domain" "$record_type" "$value" "$ttl"
                ;;
            "delete")
                delete_record "$domain" "$record_type" "$value"
                ;;
            "query")
                query_record "$domain" "$record_type"
                ;;
            *)
                echo "âŒ æœªçŸ¥æ“ä½œ: $action"
                ;;
        esac
        
#        # æ·»åŠ å»¶è¿Ÿé¿å…APIè¿‡è½½
        sleep 1
    done < "$operations_file"
}

# å‘½ä»¤è¡Œç•Œé¢

case "$1" in
    "query")
        query_record "$2" "$3"
        ;;
    "add")
        add_record "$2" "$3" "$4" "$5"
        ;;
    "delete")
        delete_record "$2" "$3" "$4"
        ;;
    "batch")
        batch_operations "$2"
        ;;
    *)
        echo "ç”¨æ³•: $0 {query|add|delete|batch} [å‚æ•°...]"
        echo ""
        echo "æŸ¥è¯¢è®°å½•: $0 query domain.com [A|CNAME|MX]"
        echo "æ·»åŠ è®°å½•: $0 add domain.com A 192.168.1.100 [TTL]"
        echo "åˆ é™¤è®°å½•: $0 delete domain.com A 192.168.1.100"
        echo "æ‰¹é‡æ“ä½œ: $0 batch operations.csv"
        exit 1
        ;;
esac
```

---

## 8. ğŸ“š DNSé…ç½®ç‰ˆæœ¬æ§åˆ¶



### 8.1 ç‰ˆæœ¬æ§åˆ¶çš„å¿…è¦æ€§



**ä¸ºä»€ä¹ˆéœ€è¦DNSé…ç½®ç‰ˆæœ¬æ§åˆ¶**ï¼š
- ğŸ“ **å˜æ›´è¿½è¸ª**ï¼šè®°å½•æ¯æ¬¡é…ç½®ä¿®æ”¹çš„è¯¦ç»†ä¿¡æ¯
- ğŸ”„ **å¿«é€Ÿå›æ»š**ï¼šå‡ºç°é—®é¢˜æ—¶å¿«é€Ÿæ¢å¤åˆ°ä¹‹å‰ç‰ˆæœ¬
- ğŸ‘¥ **åä½œç®¡ç†**ï¼šå¤šäººåä½œæ—¶é¿å…é…ç½®å†²çª
- ğŸ“Š **å®¡è®¡è¦æ±‚**ï¼šæ»¡è¶³å®‰å…¨å®¡è®¡å’Œåˆè§„è¦æ±‚

### 8.2 Gité›†æˆçš„DNSç®¡ç†



```bash
#!/bin/bash

# DNSé…ç½®ç‰ˆæœ¬æ§åˆ¶ç®¡ç†


DNS_REPO="/opt/dns-config"
CONFIG_DIR="/etc/bind"
ZONE_DIR="/var/lib/bind"
BACKUP_REMOTE="git@github.com:company/dns-configs.git"

# åˆå§‹åŒ–DNSé…ç½®ä»“åº“

init_dns_repo() {
    echo "ğŸš€ åˆå§‹åŒ–DNSé…ç½®ä»“åº“"
    
#    # åˆ›å»ºä»“åº“ç›®å½•
    mkdir -p "$DNS_REPO"
    cd "$DNS_REPO"
    
#    # åˆå§‹åŒ–Gitä»“åº“
    git init
    
#    # åˆ›å»ºç›®å½•ç»“æ„
    mkdir -p config zones scripts templates
    
#    # åˆ›å»º.gitignoreæ–‡ä»¶
    cat > .gitignore << 'EOF'
# ä¸´æ—¶æ–‡ä»¶

*.tmp
*.bak
*.log

# æ•æ„Ÿä¿¡æ¯

*.key
secrets/
*.secret

# ç³»ç»Ÿç”Ÿæˆæ–‡ä»¶

.DS_Store
Thumbs.db
EOF
    
#    # åˆ›å»ºREADMEæ–‡ä»¶
    cat > README.md << 'EOF'
# DNSé…ç½®ç®¡ç†ä»“åº“


# ç›®å½•ç»“æ„


- config/  - BINDé…ç½®æ–‡ä»¶
- zones/   - åŸŸåè§£ææ–‡ä»¶  
- scripts/ - ç®¡ç†è„šæœ¬
- templates/ - é…ç½®æ¨¡æ¿

# ä½¿ç”¨è¯´æ˜


1. ä¿®æ”¹é…ç½®æ–‡ä»¶
2. æäº¤å˜æ›´: git add . && git commit -m "æè¿°"
3. éƒ¨ç½²é…ç½®: ./scripts/deploy.sh
EOF
    
#    # åˆå§‹æäº¤
    git add .
    git commit -m "åˆå§‹åŒ–DNSé…ç½®ä»“åº“"
    
#    # æ·»åŠ è¿œç¨‹ä»“åº“
    if [ -n "$BACKUP_REMOTE" ]; then
        git remote add origin "$BACKUP_REMOTE"
    fi
    
    echo "âœ… DNSé…ç½®ä»“åº“åˆå§‹åŒ–å®Œæˆ"
}

# åŒæ­¥ç°æœ‰é…ç½®åˆ°ä»“åº“

sync_existing_config() {
    echo "ğŸ”„ åŒæ­¥ç°æœ‰DNSé…ç½®åˆ°ä»“åº“"
    
    cd "$DNS_REPO"
    
#    # åŒæ­¥BINDé…ç½®æ–‡ä»¶
    cp -r "$CONFIG_DIR"/* config/ 2>/dev/null || true
    
#    # åŒæ­¥åŸŸåè§£ææ–‡ä»¶
    cp -r "$ZONE_DIR"/* zones/ 2>/dev/null || true
    
#    # æ·»åŠ å˜æ›´
    git add .
    
#    # æ£€æŸ¥æ˜¯å¦æœ‰å˜æ›´
    if git diff --cached --quiet; then
        echo "â„¹ï¸ æ²¡æœ‰é…ç½®å˜æ›´éœ€è¦åŒæ­¥"
    else
        git commit -m "åŒæ­¥ç°æœ‰DNSé…ç½® - $(date '+%Y-%m-%d %H:%M:%S')"
        echo "âœ… é…ç½®åŒæ­¥å®Œæˆ"
    fi
}

# æäº¤é…ç½®å˜æ›´

commit_changes() {
    local commit_message="$1"
    local files_changed="$2"
    
    cd "$DNS_REPO"
    
    echo "ğŸ“ æäº¤DNSé…ç½®å˜æ›´"
    
#    # åŒæ­¥æœ€æ–°é…ç½®
    sync_existing_config
    
#    # æ£€æŸ¥å˜æ›´
    if git diff --cached --quiet && git diff --quiet; then
        echo "â„¹ï¸ æ²¡æœ‰é…ç½®å˜æ›´éœ€è¦æäº¤"
        return 0
    fi
    
#    # æ˜¾ç¤ºå˜æ›´å†…å®¹
    echo "ğŸ“‹ å˜æ›´å†…å®¹:"
    git diff --name-status
    
#    # æäº¤å˜æ›´
    if [ -n "$commit_message" ]; then
        git add .
        git commit -m "$commit_message"
        echo "âœ… å˜æ›´æäº¤æˆåŠŸ: $commit_message"
    else
        echo "âŒ æäº¤æ¶ˆæ¯ä¸èƒ½ä¸ºç©º"
        return 1
    fi
}

# æŸ¥çœ‹é…ç½®å†å²

view_history() {
    cd "$DNS_REPO"
    
    echo "ğŸ“š DNSé…ç½®å˜æ›´å†å²"
    echo "==================="
    
#    # æ˜¾ç¤ºæœ€è¿‘10æ¬¡æäº¤
    git log --oneline -10 --graph --decorate
    
    echo ""
    echo "ğŸ“Š ç»Ÿè®¡ä¿¡æ¯:"
    echo "æ€»æäº¤æ¬¡æ•°: $(git rev-list --count HEAD)"
    echo "ä»“åº“å¤§å°: $(du -sh . | cut -f1)"
}

# å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬

rollback_to_version() {
    local version="$1"
    local create_backup="${2:-true}"
    
    cd "$DNS_REPO"
    
    echo "ğŸ”„ å›æ»šDNSé…ç½®åˆ°ç‰ˆæœ¬: $version"
    
#    # éªŒè¯ç‰ˆæœ¬æ˜¯å¦å­˜åœ¨
    if ! git rev-parse --quiet --verify "$version" >/dev/null; then
        echo "âŒ ç‰ˆæœ¬ä¸å­˜åœ¨: $version"
        return 1
    fi
    
#    # åˆ›å»ºå½“å‰çŠ¶æ€å¤‡ä»½
    if [ "$create_backup" = "true" ]; then
        local backup_branch="backup-$(date +%Y%m%d-%H%M%S)"
        git branch "$backup_branch"
        echo "ğŸ’¾ å½“å‰çŠ¶æ€å·²å¤‡ä»½åˆ°åˆ†æ”¯: $backup_branch"
    fi
    
#    # å›æ»šé…ç½®æ–‡ä»¶
    git checkout "$version" -- config/ zones/
    
#    # éƒ¨ç½²å›æ»šçš„é…ç½®
    deploy_from_repo
    
#    # æäº¤å›æ»šè®°å½•
    git add .
    git commit -m "å›æ»šé…ç½®åˆ°ç‰ˆæœ¬ $version - $(date '+%Y-%m-%d %H:%M:%S')"
    
    echo "âœ… é…ç½®å›æ»šå®Œæˆ"
}

# ä»ä»“åº“éƒ¨ç½²é…ç½®

deploy_from_repo() {
    echo "ğŸš€ ä»ä»“åº“éƒ¨ç½²DNSé…ç½®"
    
    cd "$DNS_REPO"
    
#    # éªŒè¯é…ç½®è¯­æ³•
    echo "ğŸ” éªŒè¯é…ç½®è¯­æ³•..."
    local validation_errors=0
    
#    # æ£€æŸ¥BINDä¸»é…ç½®
    for config_file in config/*.conf; do
        [ ! -f "$config_file" ] && continue
        
        if ! named-checkconf "$config_file" 2>/dev/null; then
            echo "âŒ é…ç½®æ–‡ä»¶è¯­æ³•é”™è¯¯: $config_file"
            validation_errors=$((validation_errors + 1))
        fi
    done
    
#    # æ£€æŸ¥åŸŸåé…ç½®
    for zone_file in zones/*.db; do
        [ ! -f "$zone_file" ] && continue
        
        local domain=$(basename "$zone_file" .db)
        if ! named-checkzone "$domain" "$zone_file" >/dev/null 2>&1; then
            echo "âŒ åŸŸåé…ç½®è¯­æ³•é”™è¯¯: $zone_file"
            validation_errors=$((validation_errors + 1))
        fi
    done
    
    if [ $validation_errors -gt 0 ]; then
        echo "âŒ å‘ç° $validation_errors ä¸ªé…ç½®é”™è¯¯ï¼Œå–æ¶ˆéƒ¨ç½²"
        return 1
    fi
    
    echo "âœ… é…ç½®éªŒè¯é€šè¿‡"
    
#    # å¤‡ä»½å½“å‰é…ç½®
    local backup_dir="/backup/dns-deploy-$(date +%Y%m%d-%H%M%S)"
    mkdir -p "$backup_dir"
    cp -r "$CONFIG_DIR"/* "$backup_dir/" 2>/dev/null || true
    cp -r "$ZONE_DIR"/* "$backup_dir/" 2>/dev/null || true
    echo "ğŸ’¾ å½“å‰é…ç½®å·²å¤‡ä»½åˆ°: $backup_dir"
    
#    # éƒ¨ç½²æ–°é…ç½®
    cp -r config/* "$CONFIG_DIR/" 2>/dev/null || true
    cp -r zones/* "$ZONE_DIR/" 2>/dev/null || true
    
#    # é‡å¯DNSæœåŠ¡
    if systemctl reload bind9; then
        echo "âœ… DNSæœåŠ¡é‡è½½æˆåŠŸ"
        
#        # éªŒè¯éƒ¨ç½²ç»“æœ
        sleep 3
        if test_dns_deployment; then
            echo "ğŸ‰ é…ç½®éƒ¨ç½²æˆåŠŸï¼"
        else
            echo "âŒ éƒ¨ç½²éªŒè¯å¤±è´¥ï¼Œå›æ»šé…ç½®"
            cp -r "$backup_dir"/* "$CONFIG_DIR/" 2>/dev/null || true
            cp -r "$backup_dir"/* "$ZONE_DIR/" 2>/dev/null || true
            systemctl reload bind9
            return 1
        fi
    else
        echo "âŒ DNSæœåŠ¡é‡è½½å¤±è´¥ï¼Œå›æ»šé…ç½®"
        cp -r "$backup_dir"/* "$CONFIG_DIR/" 2>/dev/null || true
        cp -r "$backup_dir"/* "$ZONE_DIR/" 2>/dev/null || true
        return 1
    fi
}

# éƒ¨ç½²éªŒè¯æµ‹è¯•

test_dns_deployment() {
    echo "ğŸ§ª éªŒè¯DNSéƒ¨ç½²ç»“æœ"
    
#    # æµ‹è¯•æœ¬åœ°è§£æ
    local test_domains=("localhost" "www.example.com")
    
    for domain in "${test_domains[@]}"; do
        if nslookup "$domain" 127.0.0.1 >/dev/null 2>&1; then
            echo "âœ… $domain è§£ææµ‹è¯•é€šè¿‡"
        else
            echo "âŒ $domain è§£ææµ‹è¯•å¤±è´¥"
            return 1
        fi
    done
    
    return 0
}

# åˆ†æ”¯ç®¡ç†

create_feature_branch() {
    local branch_name="$1"
    local description="$2"
    
    cd "$DNS_REPO"
    
    echo "ğŸŒ¿ åˆ›å»ºåŠŸèƒ½åˆ†æ”¯: $branch_name"
    
#    # åˆ›å»ºå¹¶åˆ‡æ¢åˆ°æ–°åˆ†æ”¯
    git checkout -b "$branch_name"
    
#    # æ·»åŠ åˆ†æ”¯æè¿°
    if [ -n "$description" ]; then
        echo "$description" > ".branch-description"
        git add .branch-description
        git commit -m "åˆ›å»ºåŠŸèƒ½åˆ†æ”¯: $branch_name - $description"
    fi
    
    echo "âœ… åˆ†æ”¯åˆ›å»ºå®Œæˆï¼Œå½“å‰åˆ†æ”¯: $(git branch --show-current)"
}

# åˆå¹¶åˆ†æ”¯

merge_feature_branch() {
    local branch_name="$1"
    local target_branch="${2:-master}"
    
    cd "$DNS_REPO"
    
    echo "ğŸ”€ åˆå¹¶åˆ†æ”¯ $branch_name åˆ° $target_branch"
    
#    # åˆ‡æ¢åˆ°ç›®æ ‡åˆ†æ”¯
    git checkout "$target_branch"
    
#    # åˆå¹¶åŠŸèƒ½åˆ†æ”¯
    if git merge --no-ff "$branch_name" -m "åˆå¹¶åŠŸèƒ½åˆ†æ”¯: $branch_name"; then
        echo "âœ… åˆ†æ”¯åˆå¹¶æˆåŠŸ"
        
#        # è¯¢é—®æ˜¯å¦åˆ é™¤åŠŸèƒ½åˆ†æ”¯
        read -p "æ˜¯å¦åˆ é™¤åŠŸèƒ½åˆ†æ”¯ $branch_name? (y/N): " -n 1 -r
        echo
        if [[ $REPLY =~ ^[Yy]$ ]]; then
            git branch -d "$branch_name"
            echo "ğŸ—‘ï¸ åŠŸèƒ½åˆ†æ”¯å·²åˆ é™¤"
        fi
    else
        echo "âŒ åˆ†æ”¯åˆå¹¶å¤±è´¥ï¼Œè¯·è§£å†³å†²çªåæ‰‹åŠ¨åˆå¹¶"
        return 1
    fi
}
```

### 8.3 è‡ªåŠ¨åŒ–å·¥ä½œæµ



```bash
#!/bin/bash

# DNSé…ç½®è‡ªåŠ¨åŒ–å·¥ä½œæµè„šæœ¬


WORKFLOW_CONFIG="/etc/dns-workflow.conf"
WEBHOOK_URL=""
APPROVAL_REQUIRED="false"

# åŠ è½½å·¥ä½œæµé…ç½®

load_workflow_config() {
    if [ -f "$WORKFLOW_CONFIG" ]; then
        source "$WORKFLOW_CONFIG"
    fi
}

# é…ç½®å˜æ›´æ£€æµ‹

detect_config_changes() {
    cd "$DNS_REPO"
    
#    # æ£€æŸ¥æ˜¯å¦æœ‰æœªæäº¤çš„å˜æ›´
    if ! git diff --quiet || ! git diff --cached --quiet; then
        return 0  # æœ‰å˜æ›´
    else
        return 1  # æ— å˜æ›´
    fi
}

# è‡ªåŠ¨æäº¤å·¥ä½œæµ

auto_commit_workflow() {
    local auto_message="$1"
    
    echo "ğŸ¤– è‡ªåŠ¨æäº¤å·¥ä½œæµ"
    
    if detect_config_changes; then
#        # ç”Ÿæˆè‡ªåŠ¨æäº¤æ¶ˆæ¯
        if [ -z "$auto_message" ]; then
            auto_message="è‡ªåŠ¨æäº¤ - $(date '+%Y-%m-%d %H:%M:%S')"
        fi
        
        commit_changes "$auto_message"
        
#        # æ¨é€åˆ°è¿œç¨‹ä»“åº“
        if [ -n "$BACKUP_REMOTE" ]; then
            git push origin master
            echo "ğŸ“¤ å˜æ›´å·²æ¨é€åˆ°è¿œç¨‹ä»“åº“"
        fi
        
#        # å‘é€é€šçŸ¥
        send_workflow_notification "commit" "$auto_message"
        
    else
        echo "â„¹ï¸ æ²¡æœ‰é…ç½®å˜æ›´ï¼Œè·³è¿‡è‡ªåŠ¨æäº¤"
    fi
}

# å®¡æ‰¹å·¥ä½œæµ

approval_workflow() {
    local changes_description="$1"
    
    if [ "$APPROVAL_REQUIRED" != "true" ]; then
        echo "â„¹ï¸ å®¡æ‰¹æœªå¯ç”¨ï¼Œç›´æ¥éƒ¨ç½²"
        return 0
    fi
    
    echo "â³ ç­‰å¾…é…ç½®å˜æ›´å®¡æ‰¹"
    echo "å˜æ›´æè¿°: $changes_description"
    
#    # å‘é€å®¡æ‰¹è¯·æ±‚
    send_approval_request "$changes_description"
    
#    # ç­‰å¾…å®¡æ‰¹ç»“æœ
    local approval_file="/tmp/dns-approval-$.txt"
    
    echo "è¯·å®¡æ‰¹äººå‘˜å°†ç»“æœå†™å…¥æ–‡ä»¶: $approval_file"
    echo "æ ¼å¼: APPROVED æˆ– REJECTED [åŸå› ]"
    
#    # ç­‰å¾…å®¡æ‰¹æ–‡ä»¶
    local timeout=3600  # 1å°æ—¶è¶…æ—¶
    local elapsed=0
    
    while [ $elapsed -lt $timeout ]; do
        if [ -f "$approval_file" ]; then
            local approval_result=$(cat "$approval_file")
            rm -f "$approval_file"
            
            if [[ "$approval_result" =~ ^APPROVED ]]; then
                echo "âœ… é…ç½®å˜æ›´å·²è·å¾—å®¡æ‰¹"
                return 0
            else
                echo "âŒ é…ç½®å˜æ›´è¢«æ‹’ç»: $approval_result"
                return 1
            fi
        fi
        
        sleep 60
        elapsed=$((elapsed + 60))
        echo "â³ ç­‰å¾…å®¡æ‰¹ä¸­... ($elapsed/${timeout}s)"
    done
    
    echo "â° å®¡æ‰¹è¶…æ—¶ï¼Œå˜æ›´è¢«è‡ªåŠ¨æ‹’ç»"
    return 1
}

# å‘é€å·¥ä½œæµé€šçŸ¥

send_workflow_notification() {
    local event_type="$1"
    local message="$2"
    
    if [ -n "$WEBHOOK_URL" ]; then
        local payload="{
            \"event\": \"$event_type\",
            \"message\": \"$message\",
            \"timestamp\": \"$(date -Iseconds)\",
            \"hostname\": \"$(hostname)\"
        }"
        
        curl -X POST -H 'Content-Type: application/json' \
             --data "$payload" "$WEBHOOK_URL" 2>/dev/null
    fi
}

# å‘é€å®¡æ‰¹è¯·æ±‚

send_approval_request() {
    local changes="$1"
    
#    # è¿™é‡Œå¯ä»¥é›†æˆä¼ä¸šå†…éƒ¨çš„å®¡æ‰¹ç³»ç»Ÿ
    echo "ğŸ“§ å®¡æ‰¹è¯·æ±‚å·²å‘é€"
    
    if [ -n "$APPROVAL_EMAIL" ]; then
        {
            echo "DNSé…ç½®å˜æ›´å®¡æ‰¹è¯·æ±‚"
            echo "===================="
            echo ""
            echo "å˜æ›´æè¿°: $changes"
            echo "æäº¤æ—¶é—´: $(date)"
            echo "æäº¤ä¸»æœº: $(hostname)"
            echo ""
            echo "å˜æ›´è¯¦æƒ…:"
            cd "$DNS_REPO"
            git diff --name-status
            echo ""
            echo "è¯·å®¡æ‰¹åå›å¤ APPROVED æˆ– REJECTED"
        } | mail -s "DNSé…ç½®å˜æ›´å®¡æ‰¹è¯·æ±‚" "$APPROVAL_EMAIL"
    fi
}

# å®šæ—¶åŒæ­¥ä»»åŠ¡

scheduled_sync() {
    echo "â° æ‰§è¡Œå®šæ—¶åŒæ­¥ä»»åŠ¡"
    
#    # åŒæ­¥é…ç½®åˆ°ä»“åº“
    sync_existing_config
    
#    # æ£€æŸ¥æ˜¯å¦éœ€è¦æ¨é€åˆ°è¿œç¨‹
    cd "$DNS_REPO"
    
    if [ -n "$(git log origin/master..HEAD 2>/dev/null)" ]; then
        echo "ğŸ“¤ æ¨é€æœ¬åœ°å˜æ›´åˆ°è¿œç¨‹ä»“åº“"
        git push origin master
    fi
    
#    # æ£€æŸ¥è¿œç¨‹æ˜¯å¦æœ‰æ–°å˜æ›´
    git fetch origin
    if [ -n "$(git log HEAD..origin/master 2>/dev/null)" ]; then
        echo "ğŸ“¥ å‘ç°è¿œç¨‹æ–°å˜æ›´ï¼Œéœ€è¦æ‰‹åŠ¨å¤„ç†"
        send_workflow_notification "sync_conflict" "å‘ç°è¿œç¨‹æ–°å˜æ›´ï¼Œéœ€è¦æ‰‹åŠ¨åˆå¹¶"
    fi
}

# ä¸»å·¥ä½œæµå‡½æ•°

main_workflow() {
    local action="$1"
    
    load_workflow_config
    
    case "$action" in
        "auto-commit")
            auto_commit_workflow "$2"
            ;;
        "deploy")
            if approval_workflow "éƒ¨ç½²DNSé…ç½®å˜æ›´"; then
                deploy_from_repo
            fi
            ;;
        "sync")
            scheduled_sync
            ;;
        *)
            echo "ç”¨æ³•: $0 {auto-commit|deploy|sync} [å‚æ•°]"
            exit 1
            ;;
    esac
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“



### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ



```
ğŸ”¸ è„šæœ¬åŒ–ç®¡ç†ï¼šç”¨è„šæœ¬è‡ªåŠ¨åŒ–DNSé…ç½®ï¼Œå‡å°‘äººå·¥é”™è¯¯
ğŸ”¸ è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼šå®Œæ•´çš„éƒ¨ç½²æµç¨‹ï¼ŒåŒ…æ‹¬éªŒè¯å’Œå›æ»šæœºåˆ¶
ğŸ”¸ åŠ¨æ€æ›´æ–°ï¼šå®æ—¶æ›´æ–°DNSè®°å½•ï¼Œé€‚åº”IPåœ°å€å˜åŒ–
ğŸ”¸ ç›‘æ§å‘Šè­¦ï¼šæŒç»­ç›‘æ§DNSæœåŠ¡çŠ¶æ€ï¼ŒåŠæ—¶å‘ç°é—®é¢˜
ğŸ”¸ æ‰¹é‡å¤„ç†ï¼šé«˜æ•ˆå¤„ç†å¤§é‡åŸŸåè§£æä»»åŠ¡
ğŸ”¸ æ¨¡æ¿åŒ–ç®¡ç†ï¼šæ ‡å‡†åŒ–é…ç½®ï¼Œæé«˜ç®¡ç†æ•ˆç‡
ğŸ”¸ APIæ¥å£ï¼šç¨‹åºåŒ–ç®¡ç†DNSï¼Œä¾¿äºç³»ç»Ÿé›†æˆ
ğŸ”¸ ç‰ˆæœ¬æ§åˆ¶ï¼šè¿½è¸ªé…ç½®å˜æ›´ï¼Œæ”¯æŒå¿«é€Ÿå›æ»š
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹



**ğŸ”¹ è„šæœ¬åŒ–ç®¡ç†çš„ä»·å€¼**
```
ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜ï¼š
- æ‰‹å·¥æ“ä½œå®¹æ˜“å‡ºé”™
- é…ç½®ä¸ä¸€è‡´
- éš¾ä»¥æ‰¹é‡å¤„ç†
- ç¼ºä¹å®¡è®¡è®°å½•

è„šæœ¬åŒ–çš„ä¼˜åŠ¿ï¼š
- æ“ä½œæ ‡å‡†åŒ–
- å‡å°‘äººå·¥é”™è¯¯  
- æé«˜æ•ˆç‡
- ä¾¿äºç»´æŠ¤
```

**ğŸ”¹ è‡ªåŠ¨åŒ–éƒ¨ç½²çš„å…³é”®ç¯èŠ‚**
```
å®Œæ•´çš„éƒ¨ç½²æµç¨‹ï¼š
ç¯å¢ƒæ£€æŸ¥ â†’ è½¯ä»¶å®‰è£… â†’ é…ç½®ç”Ÿæˆ â†’ è¯­æ³•éªŒè¯ â†’ æœåŠ¡é‡å¯ â†’ åŠŸèƒ½æµ‹è¯•

å…³é”®å®‰å…¨æªæ–½ï¼š
- é…ç½®å¤‡ä»½
- è¯­æ³•éªŒè¯
- åˆ†æ­¥éƒ¨ç½²
- è‡ªåŠ¨å›æ»š
```

**ğŸ”¹ ç›‘æ§å‘Šè­¦çš„é‡è¦æ€§**
```
ç›‘æ§ç»´åº¦ï¼š
- æœåŠ¡å¯ç”¨æ€§ï¼šç«¯å£çŠ¶æ€ã€è¿›ç¨‹çŠ¶æ€
- è§£ææ€§èƒ½ï¼šå“åº”æ—¶é—´ã€æˆåŠŸç‡
- é…ç½®æ­£ç¡®æ€§ï¼šè§£æç»“æœéªŒè¯

å‘Šè­¦ç­–ç•¥ï¼š
- åˆ†çº§å‘Šè­¦ï¼šINFOã€WARNINGã€ERRORã€CRITICAL
- å¤šæ¸ é“é€šçŸ¥ï¼šé‚®ä»¶ã€çŸ­ä¿¡ã€Webhook
- è‡ªåŠ¨æ¢å¤ï¼šç®€å•é—®é¢˜è‡ªåŠ¨å¤„ç†
```

### 9.3 å®é™…åº”ç”¨ä»·å€¼



**ğŸ¯ ä¸šåŠ¡åœºæ™¯åº”ç”¨**
- **ä¼ä¸šDNSç®¡ç†**ï¼šç»Ÿä¸€ç®¡ç†å…¬å¸æ‰€æœ‰åŸŸåè§£æ
- **äº‘æœåŠ¡é›†æˆ**ï¼šä¸äº‘å¹³å°DNSæœåŠ¡APIå¯¹æ¥
- **DevOpsæµæ°´çº¿**ï¼šå°†DNSç®¡ç†é›†æˆåˆ°CI/CDæµç¨‹
- **ç¾å¤‡åˆ‡æ¢**ï¼šæ•…éšœæ—¶è‡ªåŠ¨åˆ‡æ¢DNSè®°å½•

**ğŸ”§ è¿ç»´å®è·µ**
- **é…ç½®æ ‡å‡†åŒ–**ï¼šä½¿ç”¨æ¨¡æ¿ç¡®ä¿é…ç½®ä¸€è‡´æ€§
- **å˜æ›´ç®¡ç†**ï¼šé€šè¿‡ç‰ˆæœ¬æ§åˆ¶ç®¡ç†æ‰€æœ‰å˜æ›´
- **è‡ªåŠ¨åŒ–è¿ç»´**ï¼šå‡å°‘æ‰‹å·¥æ“ä½œï¼Œæé«˜æ•ˆç‡
- **ç›‘æ§é¢„è­¦**ï¼šåŠæ—¶å‘ç°å’Œå¤„ç†DNSé—®é¢˜

### 9.4 å­¦ä¹ é‡ç‚¹æé†’



**â­ ä¼˜å…ˆæŒæ¡ï¼ˆæ–°æ‰‹å¿…ä¼šï¼‰**
- åŸºç¡€è„šæœ¬ç¼–å†™ï¼šé…ç½®æ–‡ä»¶æ“ä½œã€è¯­æ³•éªŒè¯
- æœåŠ¡ç®¡ç†ï¼šå¯åŠ¨ã€åœæ­¢ã€é‡è½½DNSæœåŠ¡
- ç®€å•ç›‘æ§ï¼šæ£€æŸ¥æœåŠ¡çŠ¶æ€ã€éªŒè¯è§£æç»“æœ

**â­â­ è¿›é˜¶æŒæ¡ï¼ˆæé«˜æ•ˆç‡ï¼‰**
- è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼šå®Œæ•´çš„éƒ¨ç½²æµç¨‹è„šæœ¬
- æ‰¹é‡æ“ä½œï¼šå¤„ç†å¤§é‡åŸŸåçš„å·¥å…·
- æ¨¡æ¿ç³»ç»Ÿï¼šæ ‡å‡†åŒ–é…ç½®ç®¡ç†

**â­â­â­ é«˜çº§åº”ç”¨ï¼ˆä¸“ä¸šè¿ç»´ï¼‰**
- APIæ¥å£å¼€å‘ï¼šRESTful DNSç®¡ç†æ¥å£
- ç‰ˆæœ¬æ§åˆ¶é›†æˆï¼šGitå·¥ä½œæµç®¡ç†
- ä¼ä¸šçº§é›†æˆï¼šä¸ç°æœ‰ç³»ç»Ÿçš„é›†æˆ

**æ ¸å¿ƒè®°å¿†**ï¼š
- DNSè„šæœ¬åŒ–ç®¡ç†æ˜¯ç°ä»£è¿ç»´çš„å¿…å¤‡æŠ€èƒ½
- è‡ªåŠ¨åŒ–ä¸æ˜¯ç›®çš„ï¼Œç¨³å®šå¯é æ‰æ˜¯ç›®æ ‡
- ç›‘æ§å’Œå‘Šè­¦æ˜¯ä¿éšœDNSæœåŠ¡çš„å…³é”®
- ç‰ˆæœ¬æ§åˆ¶è®©DNSç®¡ç†æ›´åŠ ä¸“ä¸šåŒ–