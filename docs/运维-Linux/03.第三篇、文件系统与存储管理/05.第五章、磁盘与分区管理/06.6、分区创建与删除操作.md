---
title: 6、分区创建与删除操作
---
## 📚 目录

1. [分区基础概念理解](#1-分区基础概念理解)
2. [fdisk交互式分区操作](#2-fdisk交互式分区操作)
3. [parted命令行分区管理](#3-parted命令行分区管理)
4. [分区类型与文件系统](#4-分区类型与文件系统)
5. [分区删除与数据安全](#5-分区删除与数据安全)
6. [核心要点总结](#6-核心要点总结)

---

## 1. 💾 分区基础概念理解


### 1.1 什么是磁盘分区

**简单理解**：分区就是把一个大硬盘"切"成几个小部分，每个部分可以单独使用

```
比喻说明：
硬盘像一块大地皮 (500GB)
    ↓
分区就像划分地块
    ↓
/dev/sda1 (100GB) - 装系统的地块  
/dev/sda2 (200GB) - 存数据的地块
/dev/sda3 (200GB) - 备份用的地块

每块地可以盖不同的房子(安装不同的文件系统)
```

### 1.2 为什么要分区

**实际好处**：
- **安全隔离**：系统出问题不会影响数据区
- **便于管理**：不同类型的文件分开存放
- **性能优化**：系统文件和用户数据分离访问更快
- **备份方便**：可以只备份重要分区

### 1.3 分区的三种类型


> 📌 **核心概念**  
> Linux系统支持三种分区类型，理解它们的区别很重要

**🔸 主分区（Primary Partition）**
```
作用：直接存放操作系统和数据的分区
数量限制：一个硬盘最多4个主分区
特点：可以直接格式化使用，可以设置为启动分区
```

**🔸 扩展分区（Extended Partition）**
```
作用：用来突破4个主分区限制的特殊分区
数量限制：最多1个，且占用1个主分区位置
特点：不能直接使用，必须在其内创建逻辑分区
```

**🔸 逻辑分区（Logical Partition）**
```
作用：在扩展分区内创建的实际可用分区
数量限制：理论上无限制(实际受设备文件限制)
特点：编号从5开始(/dev/sda5、/dev/sda6...)
```

### 1.4 分区编号规则

```
分区命名规则：
/dev/sda1 - 第一块SATA硬盘的第一个主分区
/dev/sda2 - 第一块SATA硬盘的第二个主分区  
/dev/sda3 - 第一块SATA硬盘的第三个主分区
/dev/sda4 - 第一块SATA硬盘的扩展分区
/dev/sda5 - 第一块SATA硬盘的第一个逻辑分区
/dev/sda6 - 第一块SATA硬盘的第二个逻辑分区

记忆方法：
- sda = 第一块SATA硬盘 (sdb是第二块)
- 1-4 = 主分区和扩展分区编号  
- 5开始 = 逻辑分区编号
```

---

## 2. 🔧 fdisk交互式分区操作


### 2.1 fdisk基本使用方法


**fdisk是什么**：Linux系统自带的分区管理工具，通过交互式菜单操作

```bash
# 查看系统所有硬盘
fdisk -l

# 对指定硬盘进行分区操作
fdisk /dev/sda
```

> ⚠️ **重要提醒**  
> fdisk操作有风险！建议先在虚拟机练习，生产环境务必备份数据

### 2.2 fdisk交互式菜单详解


**进入fdisk后的常用命令**：

| 命令 | **功能说明** | **使用场景** |
|------|-------------|-------------|
| `p` | `打印分区表信息` | `查看当前分区状况` |
| `n` | `创建新分区` | `添加分区时使用` |
| `d` | `删除分区` | `移除不需要的分区` |
| `t` | `修改分区类型` | `设置文件系统类型` |
| `w` | `保存并退出` | `确认修改生效` |
| `q` | `不保存退出` | `取消所有修改` |
| `m` | `显示帮助菜单` | `忘记命令时查看` |

### 2.3 创建主分区完整流程


**创建一个100GB的主分区步骤**：

```bash
# 1. 启动fdisk
fdisk /dev/sda

# 2. 查看当前分区表
Command (m for help): p

# 3. 创建新分区  
Command (m for help): n

# 4. 选择分区类型
Partition type:
   p   primary (0 primary, 0 extended, 4 free)
   e   extended
Select (default p): p    # 选择主分区

# 5. 选择分区编号
Partition number (1-4, default 1): 1    # 第一个主分区

# 6. 设置起始扇区(通常使用默认值)
First sector: [回车使用默认值]

# 7. 设置结束位置  
Last sector: +100G    # 设置100GB大小

# 8. 查看创建结果
Command (m for help): p

# 9. 保存修改
Command (m for help): w
```

**关键理解**：
- **起始扇区**：分区在硬盘上的开始位置，通常用默认值即可
- **结束位置**：可用 `+100G` 表示大小，或直接指定扇区号
- **分区表**：记录分区信息的数据结构，在硬盘最前面

### 2.4 创建扩展分区和逻辑分区


**为什么需要扩展分区**：当需要超过4个分区时使用

```bash
# 创建扩展分区流程
fdisk /dev/sda

# 创建扩展分区
Command: n
Select: e    # 选择扩展分区
Partition number: 4    # 通常用第4个位置
# 设置大小(建议用剩余全部空间)

# 在扩展分区内创建逻辑分区
Command: n  
Select: l    # 选择逻辑分区(系统自动检测)
# 设置逻辑分区大小
```

**分区结构示意**：
```
硬盘空间分配：
├─ /dev/sda1 (主分区1) - 100GB - 系统分区
├─ /dev/sda2 (主分区2) - 200GB - 用户数据
├─ /dev/sda3 (主分区3) - 50GB  - 交换分区
└─ /dev/sda4 (扩展分区) - 剩余空间
   ├─ /dev/sda5 (逻辑分区1) - 100GB
   ├─ /dev/sda6 (逻辑分区2) - 150GB
   └─ /dev/sda7 (逻辑分区3) - 剩余空间
```

---

## 3. 🎯 parted命令行分区管理


### 3.1 parted与fdisk的区别


**为什么要学parted**：
- **支持大硬盘**：可以处理2TB以上的硬盘
- **命令行友好**：可以写脚本自动化操作
- **功能更强**：支持调整分区大小
- **GPT支持**：支持新的分区表格式

> 💡 **选择建议**  
> 小于2TB硬盘：fdisk更简单易用  
> 大于2TB硬盘：必须使用parted  
> 脚本自动化：推荐parted

### 3.2 parted基本操作


**查看分区信息**：
```bash
# 查看所有硬盘
parted -l

# 查看指定硬盘
parted /dev/sda print
```

**交互式操作**：
```bash
# 进入交互模式
parted /dev/sda

# 常用交互命令
(parted) print         # 显示分区表
(parted) help          # 显示帮助
(parted) quit          # 退出
```

### 3.3 parted创建分区实例


**创建一个新分区**：
```bash
# 方法1：非交互式(推荐脚本使用)
parted /dev/sda mkpart primary ext4 1GB 101GB

# 方法2：交互式
parted /dev/sda
(parted) mkpart
Partition name? []    # 分区名称(可空)
File system type? ext4    # 文件系统类型
Start? 1GB           # 起始位置
End? 101GB           # 结束位置
```

**命令参数解释**：
- `primary`：分区类型(主分区)
- `ext4`：文件系统类型
- `1GB`：起始位置(从1GB处开始)
- `101GB`：结束位置(到101GB处结束)

### 3.4 parted分区大小计算


**大小表示方法**：

| 表示方法 | **含义** | **示例** | **适用场景** |
|----------|---------|----------|-------------|
| `100MB` | `100兆字节` | `mkpart primary 0 100MB` | `小分区精确控制` |
| `10GB` | `10吉字节` | `mkpart primary 0 10GB` | `常规分区大小` |
| `50%` | `硬盘50%空间` | `mkpart primary 0 50%` | `按比例分配` |
| `-1` | `到硬盘末尾` | `mkpart primary 10GB -1` | `使用剩余空间` |

**实际计算示例**：
```bash
# 500GB硬盘分区规划：
# 分区1：系统分区 100GB (0-100GB)  
# 分区2：用户数据 200GB (100GB-300GB)
# 分区3：剩余空间 (300GB-500GB)

parted /dev/sda mkpart primary ext4 0 100GB
parted /dev/sda mkpart primary ext4 100GB 300GB  
parted /dev/sda mkpart primary ext4 300GB -1
```

---

## 4. 🏷️ 分区类型与文件系统


### 4.1 分区类型标识的作用


**什么是分区类型ID**：
- 每种文件系统都有一个数字编号
- 告诉系统这个分区准备装什么类型的文件系统
- 只是标识作用，不会自动创建文件系统

### 4.2 常用分区类型对照表


| 类型ID | **文件系统** | **十六进制** | **用途说明** |
|--------|-------------|-------------|-------------|
| `83` | `Linux原生文件系统` | `0x83` | `ext2/ext3/ext4等` |
| `82` | `Linux交换分区` | `0x82` | `虚拟内存swap` |
| `8e` | `Linux LVM` | `0x8e` | `逻辑卷管理` |
| `fd` | `Linux RAID` | `0xfd` | `软件RAID` |
| `7` | `NTFS` | `0x07` | `Windows系统分区` |
| `b` | `FAT32` | `0x0b` | `兼容性文件系统` |

### 4.3 设置分区类型


**fdisk中设置分区类型**：
```bash
fdisk /dev/sda

# 修改分区类型
Command: t          # 选择修改分区类型
Partition number: 1 # 选择要修改的分区号
Hex code: 82        # 输入类型代码(82=swap)
```

**parted中设置分区类型**：
```bash
# 创建时直接指定
parted /dev/sda mkpart primary linux-swap 10GB 12GB

# 修改现有分区类型
parted /dev/sda set 1 boot on    # 设置启动标志
```

### 4.4 分区类型与文件系统的关系


> 📌 **重要理解**  
> 分区类型只是标识，真正的文件系统要通过格式化来创建

**完整的分区使用流程**：
```
第1步：创建分区 → 指定分区类型
第2步：格式化分区 → 创建真正的文件系统  
第3步：挂载分区 → 才能正常使用

示例流程：
1. fdisk创建分区，设置类型83
2. mkfs.ext4格式化为ext4文件系统
3. mount挂载到目录才能使用
```

---

## 5. 🗑️ 分区删除与数据安全


### 5.1 分区删除的风险认识


> ⚠️ **重要警告**  
> 分区删除是不可逆操作！数据一旦删除很难恢复！

**删除分区的后果**：
- **数据完全丢失**：分区内所有文件立即无法访问
- **无法撤销**：没有"撤销"按钮，操作立即生效
- **影响其他分区**：错误删除可能导致整个系统无法启动

### 5.2 删除前的数据备份要求


**📋 备份检查清单**：
- [ ] 确认分区内有哪些重要数据
- [ ] 选择合适的备份位置(其他分区/外部存储)
- [ ] 执行完整数据备份
- [ ] 验证备份文件的完整性
- [ ] 记录分区的挂载点和配置信息

**常用备份方法**：
```bash
# 方法1：复制重要文件
cp -r /home/user/important_data /backup/location/

# 方法2：打包压缩备份  
tar -czf backup.tar.gz /path/to/backup

# 方法3：使用rsync同步备份
rsync -av /source/path/ /backup/path/

# 方法4：整个分区镜像备份(高级用法)
dd if=/dev/sda1 of=/backup/partition.img
```

### 5.3 安全删除分区步骤


**fdisk删除分区**：
```bash
# 1. 先卸载分区(如果已挂载)
umount /dev/sda2

# 2. 启动fdisk
fdisk /dev/sda

# 3. 查看当前分区
Command: p

# 4. 删除指定分区
Command: d
Partition number: 2    # 删除第2个分区

# 5. 确认删除结果  
Command: p

# 6. 保存修改(谨慎操作!)
Command: w
```

**parted删除分区**：
```bash
# 查看分区信息
parted /dev/sda print

# 删除指定分区(编号2)
parted /dev/sda rm 2
```

### 5.4 删除分区后的清理工作


**需要处理的后续问题**：

**🔸 更新分区表缓存**
```bash
# 通知内核重新读取分区表
partprobe /dev/sda

# 或者重启系统
reboot
```

**🔸 修改fstab文件**
```bash
# 编辑挂载配置文件
vim /etc/fstab

# 删除或注释掉已删除分区的挂载记录
# /dev/sda2 /home ext4 defaults 0 2  ← 删除这行
```

**🔸 清理相关配置**
```bash
# 检查是否有程序依赖被删除的分区
grep -r "/dev/sda2" /etc/

# 检查启动脚本中的引用
grep -r "/mount/point" /etc/init.d/
```

---

## 6. 📋 核心要点总结


### 6.1 必须掌握的基本概念


```
🔸 分区本质：将硬盘空间逻辑划分为独立可用的存储区域
🔸 分区类型：主分区(直接使用)、扩展分区(容器)、逻辑分区(扩展内的实际分区)
🔸 分区编号：1-4为主/扩展分区，5开始为逻辑分区
🔸 分区标识：类型ID只是标识，真正文件系统需要格式化创建
🔸 操作风险：分区操作不可逆，必须先备份数据
```

### 6.2 工具选择与使用要点


**🔹 fdisk vs parted对比**
```
fdisk优势：
• 操作简单，交互友好
• 适合小于2TB的硬盘
• Linux系统标配工具

parted优势：  
• 支持大硬盘(>2TB)
• 支持脚本自动化
• 功能更加强大

选择原则：
• 日常管理 → fdisk够用
• 大硬盘 → 必须parted  
• 自动化 → 推荐parted
```

**🔹 操作安全要点**
```
操作前检查：
• 确认硬盘设备名 (/dev/sda?)
• 备份重要数据
• 了解现有分区用途

操作中注意：
• 仔细核对分区号
• 多次确认再执行w命令
• 记录操作步骤便于恢复

操作后验证：
• 执行partprobe刷新分区表
• 检查/etc/fstab配置
• 验证系统启动正常
```

### 6.3 实际应用指导


**🎯 常见分区规划方案**
```
家用电脑分区：
/dev/sda1 - 系统分区 (50-100GB)
/dev/sda2 - 用户数据 (剩余大部分)
/dev/sda3 - 交换分区 (内存1-2倍)

服务器分区：
/dev/sda1 - /boot (200MB)
/dev/sda2 - / (20-50GB) 
/dev/sda3 - /var (日志数据)
/dev/sda4 - 扩展分区
  /dev/sda5 - /home (用户数据)
  /dev/sda6 - swap (交换分区)
```

**📝 故障处理经验**
```
分区表损坏：
• 症状：无法识别分区
• 处理：使用testdisk工具恢复
• 预防：定期备份分区表

错误删除分区：
• 紧急措施：立即停止写入操作
• 恢复工具：photorec/extundelete
• 成功率：取决于数据覆盖程度

系统无法启动：
• 检查：/etc/fstab配置错误
• 解决：单用户模式修复
• 预防：修改前备份配置文件
```

### 6.4 学习建议与进阶方向


> 💡 **学习路径建议**  
> 新手练习 → 虚拟机环境 → 生产环境应用

**🌱 初级掌握目标**
```
• 理解分区基本概念和作用
• 熟练使用fdisk创建/删除分区  
• 了解分区类型和文件系统关系
• 养成操作前备份的良好习惯
```

**🌿 进阶学习方向**
```
• LVM逻辑卷管理
• RAID软件阵列配置
• GPT分区表格式
• 自动化分区脚本编写
```

**🔒 安全操作原则**
```
• 测试环境先练习
• 生产环境必备份
• 重要操作二次确认  
• 文档记录操作过程
```

**核心记忆口诀**：
```
分区操作需谨慎，备份数据是关键
主扩逻辑要分清，编号规则要记牢
fdisk交互适新手，parted脚本更灵活
类型标识只是号，格式化后才能用
```