---
title: 4ã€ç£ç›˜æ•…éšœé¢„è­¦ç³»ç»Ÿ
---
## ğŸ“š ç›®å½•

1. [ç£ç›˜æ•…éšœé¢„è­¦ç³»ç»Ÿæ¦‚è¿°](#1-ç£ç›˜æ•…éšœé¢„è­¦ç³»ç»Ÿæ¦‚è¿°)
2. [è‡ªåŠ¨åŒ–ç£ç›˜å¥åº·æ£€æŸ¥](#2-è‡ªåŠ¨åŒ–ç£ç›˜å¥åº·æ£€æŸ¥)
3. [SMARTç›‘æ§è„šæœ¬ç¼–å†™](#3-SMARTç›‘æ§è„šæœ¬ç¼–å†™)
4. [æ•…éšœé¢„è­¦é˜ˆå€¼é…ç½®](#4-æ•…éšœé¢„è­¦é˜ˆå€¼é…ç½®)
5. [é‚®ä»¶/çŸ­ä¿¡å‘Šè­¦æœºåˆ¶](#5-é‚®ä»¶çŸ­ä¿¡å‘Šè­¦æœºåˆ¶)
6. [ç›‘æ§æ•°æ®å¯è§†åŒ–](#6-ç›‘æ§æ•°æ®å¯è§†åŒ–)
7. [è¶‹åŠ¿åˆ†æä¸é¢„æµ‹](#7-è¶‹åŠ¿åˆ†æä¸é¢„æµ‹)
8. [é›†æˆç›‘æ§ç³»ç»Ÿé…ç½®](#8-é›†æˆç›‘æ§ç³»ç»Ÿé…ç½®)
9. [æ•…éšœæŠ¥å‘Šç”Ÿæˆ](#9-æ•…éšœæŠ¥å‘Šç”Ÿæˆ)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” ç£ç›˜æ•…éšœé¢„è­¦ç³»ç»Ÿæ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯ç£ç›˜æ•…éšœé¢„è­¦ç³»ç»Ÿ


**ğŸ’¡ æ ¸å¿ƒç†è§£**
> ç£ç›˜æ•…éšœé¢„è­¦ç³»ç»Ÿå°±åƒç»™ç¡¬ç›˜é…äº†ä¸ª"ä½“æ£€åŒ»ç”Ÿ"ï¼Œå®šæœŸæ£€æŸ¥ç¡¬ç›˜çš„"èº«ä½“çŠ¶å†µ"ï¼Œä¸€å‘ç°å¼‚å¸¸å°±ç«‹å³é€šçŸ¥ç®¡ç†å‘˜ï¼Œé¿å…æ•°æ®ä¸¢å¤±çš„ç¾éš¾ã€‚

**ğŸ¯ ç³»ç»Ÿæ ¸å¿ƒä½œç”¨**
```
é¢„é˜²èƒœäºæ²»ç–—ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­£å¸¸è¿è¡Œ â†’ å¼‚å¸¸æ£€æµ‹ â†’ é¢„è­¦é€šçŸ¥ â”‚
â”‚     â†“         â†“         â†“      â”‚
â”‚  å®šæœŸä½“æ£€   å‘ç°é—®é¢˜   åŠæ—¶å¤„ç†  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦æ•…éšœé¢„è­¦


**ğŸ“Š æ•°æ®ç¾éš¾çš„ä»£ä»·**
- ğŸ’° **ç»æµæŸå¤±**ï¼šæ•°æ®ä¸¢å¤±å¹³å‡æŸå¤±æ¯å°æ—¶5600ç¾å…ƒ
- â° **æ—¶é—´æˆæœ¬**ï¼šæ•°æ®æ¢å¤å¯èƒ½éœ€è¦æ•°å¤©ç”šè‡³æ•°å‘¨
- ğŸ“ˆ **ä¸šåŠ¡å½±å“**ï¼šç³»ç»Ÿåœæœºç›´æ¥å½±å“ä¸šåŠ¡è¿è¥
- ğŸ˜° **å¿ƒç†å‹åŠ›**ï¼šçªå‘æ•…éšœè®©ç®¡ç†å‘˜æªæ‰‹ä¸åŠ

**ğŸ”” é¢„è­¦ç³»ç»Ÿçš„ä»·å€¼**
```
ä¼ ç»Ÿæ–¹å¼ï¼šç¡¬ç›˜åäº†æ‰çŸ¥é“ â†’ è¢«åŠ¨åº”å¯¹ â†’ æŸå¤±å·¨å¤§
é¢„è­¦æ–¹å¼ï¼šæå‰å‘ç°é—®é¢˜ â†’ ä¸»åŠ¨å¤„ç† â†’ æŸå¤±æœ€å°

é¢„è­¦ä¼˜åŠ¿ï¼š
â€¢ æå‰2-6å‘¨å‘ç°æ½œåœ¨æ•…éšœ
â€¢ 95%çš„ç¡¬ç›˜æ•…éšœå¯ä»¥é¢„æµ‹
â€¢ æ•°æ®ä¸¢å¤±é£é™©é™ä½80%
â€¢ ç»´æŠ¤æˆæœ¬å‡å°‘60%
```

### 1.3 é¢„è­¦ç³»ç»Ÿçš„åŸºæœ¬æ¶æ„


**ğŸ—ï¸ ç³»ç»Ÿæ¶æ„å›¾**
```
æ•°æ®é‡‡é›†å±‚          å¤„ç†åˆ†æå±‚          å‘Šè­¦è¾“å‡ºå±‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SMARTæ•°æ®â”‚ â”€â”€â†’  â”‚ æ•°æ®åˆ†æ â”‚ â”€â”€â†’  â”‚ é‚®ä»¶å‘Šè­¦ â”‚
â”‚ ç³»ç»Ÿæ—¥å¿— â”‚      â”‚ é˜ˆå€¼åˆ¤æ–­ â”‚      â”‚ çŸ­ä¿¡é€šçŸ¥ â”‚
â”‚ æ€§èƒ½æŒ‡æ ‡ â”‚      â”‚ è¶‹åŠ¿é¢„æµ‹ â”‚      â”‚ æŠ¥è¡¨ç”Ÿæˆ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. âš™ï¸ è‡ªåŠ¨åŒ–ç£ç›˜å¥åº·æ£€æŸ¥


### 2.1 ä»€ä¹ˆæ˜¯ç£ç›˜å¥åº·æ£€æŸ¥


**ğŸ” æ ¸å¿ƒæ¦‚å¿µ**
> ç£ç›˜å¥åº·æ£€æŸ¥å°±åƒå®šæœŸç»™æ±½è½¦åšä¿å…»ä¸€æ ·ï¼Œé€šè¿‡è¯»å–ç¡¬ç›˜å†…ç½®çš„"å¥åº·æ•°æ®"æ¥åˆ¤æ–­ç¡¬ç›˜çš„å·¥ä½œçŠ¶æ€ï¼Œå‘ç°æ½œåœ¨é—®é¢˜ã€‚

**ğŸ“‹ æ£€æŸ¥å†…å®¹åŒ…æ‹¬**
- **ğŸ”¹ SMARTå±æ€§**ï¼šç¡¬ç›˜è‡ªå¸¦çš„å¥åº·æŒ‡æ ‡
- **ğŸ”¹ åé“æ£€æµ‹**ï¼šæŸ¥æ‰¾æ— æ³•æ­£å¸¸è¯»å†™çš„åŒºåŸŸ
- **ğŸ”¹ æ¸©åº¦ç›‘æ§**ï¼šé˜²æ­¢è¿‡çƒ­æŸå
- **ğŸ”¹ è¯»å†™æ€§èƒ½**ï¼šæ£€æµ‹é€Ÿåº¦æ˜¯å¦å¼‚å¸¸
- **ğŸ”¹ é”™è¯¯ç»Ÿè®¡**ï¼šè®°å½•å„ç±»é”™è¯¯æ¬¡æ•°

### 2.2 åŸºç¡€å¥åº·æ£€æŸ¥å‘½ä»¤


**ğŸ”§ æ ¸å¿ƒæ£€æŸ¥å·¥å…·**
```bash
# 1. æ£€æŸ¥SMARTæ˜¯å¦å¯ç”¨
sudo smartctl -i /dev/sda

# 2. æŸ¥çœ‹SMARTå¥åº·çŠ¶æ€
sudo smartctl -H /dev/sda

# 3. è¯¦ç»†SMARTä¿¡æ¯
sudo smartctl -a /dev/sda

# 4. å¿«é€Ÿè‡ªæ£€
sudo smartctl -t short /dev/sda

# 5. å®Œæ•´è‡ªæ£€
sudo smartctl -t long /dev/sda
```

**ğŸ“Š å¥åº·çŠ¶æ€åˆ¤æ–­**
```
å¥åº·çŠ¶æ€æ˜¾ç¤ºï¼š
âœ… SMART overall-health self-assessment test result: PASSED
âŒ SMART overall-health self-assessment test result: FAILED

å…³é”®ç†è§£ï¼š
- PASSEDï¼šç¡¬ç›˜ç›®å‰çŠ¶æ€è‰¯å¥½
- FAILEDï¼šç¡¬ç›˜å­˜åœ¨ä¸¥é‡é—®é¢˜ï¼Œéœ€è¦ç«‹å³å¤„ç†
```

### 2.3 è‡ªåŠ¨åŒ–æ£€æŸ¥è„šæœ¬åŸºç¡€ç‰ˆ


```bash
#!/bin/bash
# ç£ç›˜å¥åº·è‡ªåŠ¨æ£€æŸ¥è„šæœ¬

# é…ç½®éƒ¨åˆ†
DISKS=("/dev/sda" "/dev/sdb" "/dev/sdc")
LOG_FILE="/var/log/disk_health.log"
ALERT_EMAIL="admin@company.com"

# æ£€æŸ¥å‡½æ•°
check_disk_health() {
    local disk=$1
    local timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    
    echo "[$timestamp] æ£€æŸ¥ç£ç›˜: $disk" >> $LOG_FILE
    
    # SMARTå¥åº·æ£€æŸ¥
    health_status=$(smartctl -H $disk | grep "test result" | awk '{print $6}')
    
    if [ "$health_status" = "PASSED" ]; then
        echo "[$timestamp] $disk çŠ¶æ€æ­£å¸¸" >> $LOG_FILE
        return 0
    else
        echo "[$timestamp] âš ï¸  $disk çŠ¶æ€å¼‚å¸¸: $health_status" >> $LOG_FILE
        return 1
    fi
}

# ä¸»ç¨‹åº
main() {
    failed_disks=()
    
    for disk in "${DISKS[@]}"; do
        if ! check_disk_health $disk; then
            failed_disks+=($disk)
        fi
    done
    
    # å¦‚æœæœ‰æ•…éšœç£ç›˜ï¼Œå‘é€å‘Šè­¦
    if [ ${#failed_disks[@]} -gt 0 ]; then
        echo "å‘ç°æ•…éšœç£ç›˜: ${failed_disks[*]}" | mail -s "ç£ç›˜å¥åº·å‘Šè­¦" $ALERT_EMAIL
    fi
}

main
```

**â° å®šæ—¶æ‰§è¡Œè®¾ç½®**
```bash
# ç¼–è¾‘crontab
crontab -e

# æ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œæ£€æŸ¥
0 2 * * * /home/scripts/disk_health_check.sh

# æ¯4å°æ—¶æ‰§è¡Œä¸€æ¬¡æ£€æŸ¥
0 */4 * * * /home/scripts/disk_health_check.sh
```

---

## 3. ğŸ“ SMARTç›‘æ§è„šæœ¬ç¼–å†™


### 3.1 ç†è§£SMARTæŠ€æœ¯


**ğŸ’¡ ä»€ä¹ˆæ˜¯SMART**
> SMARTï¼ˆSelf-Monitoring, Analysis and Reporting Technologyï¼‰æ˜¯ç¡¬ç›˜çš„"è‡ªæˆ‘è¯Šæ–­"æŠ€æœ¯ï¼Œå°±åƒäººä½“çš„å„é¡¹ç”Ÿç†æŒ‡æ ‡ä¸€æ ·ï¼Œè®°å½•ç¡¬ç›˜çš„è¿è¡ŒçŠ¶å†µã€‚

**ğŸ“Š é‡è¦SMARTå±æ€§è§£é‡Š**
```
æ ¸å¿ƒå±æ€§å«ä¹‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID  å±æ€§åç§°              è¯´æ˜              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1   Raw_Read_Error_Rate   è¯»å–é”™è¯¯ç‡        â”‚
â”‚ 5   Reallocated_Sector    é‡æ–°åˆ†é…æ‰‡åŒºæ•°    â”‚
â”‚ 7   Seek_Error_Rate       å¯»é“é”™è¯¯ç‡        â”‚
â”‚ 9   Power_On_Hours        é€šç”µæ—¶é—´          â”‚
â”‚ 10  Spin_Retry_Count      æ—‹è½¬é‡è¯•è®¡æ•°      â”‚
â”‚ 194 Temperature_Celsius   æ¸©åº¦              â”‚
â”‚ 196 Reallocated_Event     é‡æ–°åˆ†é…äº‹ä»¶      â”‚
â”‚ 197 Current_Pending       å½“å‰å¾…å¤„ç†æ‰‡åŒº    â”‚
â”‚ 198 Offline_Uncorrectable è„±æœºä¸å¯çº æ­£     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 é«˜çº§SMARTç›‘æ§è„šæœ¬


```bash
#!/bin/bash
# é«˜çº§SMARTç›‘æ§è„šæœ¬

# é…ç½®æ–‡ä»¶
CONFIG_FILE="/etc/smart_monitor.conf"
LOG_FILE="/var/log/smart_monitor.log"
DATA_DIR="/var/lib/smart_monitor"

# åˆ›å»ºå¿…è¦ç›®å½•
mkdir -p $DATA_DIR

# SMARTå…³é”®å±æ€§å®šä¹‰
declare -A SMART_THRESHOLDS=(
    ["1"]="1000000"      # Raw_Read_Error_Rate
    ["5"]="0"            # Reallocated_Sector_Ct (ä¸¥æ ¼)
    ["7"]="1000000"      # Seek_Error_Rate  
    ["10"]="0"           # Spin_Retry_Count
    ["194"]="55"         # Temperature_Celsius
    ["196"]="0"          # Reallocated_Event_Count
    ["197"]="0"          # Current_Pending_Sector
    ["198"]="0"          # Offline_Uncorrectable
)

# è·å–SMARTæ•°æ®
get_smart_data() {
    local disk=$1
    local output_file="$DATA_DIR/$(basename $disk)_smart.json"
    
    smartctl -A $disk --json > $output_file
    echo $output_file
}

# åˆ†æSMARTå±æ€§
analyze_smart_attribute() {
    local json_file=$1
    local attr_id=$2
    local threshold=${SMART_THRESHOLDS[$attr_id]}
    
    if [ -z "$threshold" ]; then
        return 0  # æœªå®šä¹‰é˜ˆå€¼çš„å±æ€§è·³è¿‡
    fi
    
    # æå–å±æ€§å€¼ (ç®€åŒ–ç‰ˆï¼Œå®é™…ä½¿ç”¨jqæ›´å¥½)
    local raw_value=$(grep -A5 "\"id\": $attr_id" $json_file | grep "raw" | grep "value" | cut -d':' -f2 | tr -d ' ,')
    
    if [ -n "$raw_value" ] && [ "$raw_value" -gt "$threshold" ]; then
        return 1  # è¶…è¿‡é˜ˆå€¼
    fi
    
    return 0
}

# ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š
generate_smart_report() {
    local disk=$1
    local json_file=$2
    local timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    
    echo "==============================================="
    echo "SMARTç›‘æ§æŠ¥å‘Š - $disk"
    echo "æ£€æŸ¥æ—¶é—´: $timestamp"
    echo "==============================================="
    
    # æ£€æŸ¥å…³é”®å±æ€§
    for attr_id in "${!SMART_THRESHOLDS[@]}"; do
        if ! analyze_smart_attribute $json_file $attr_id; then
            echo "âš ï¸  å±æ€§ID $attr_id è¶…è¿‡é˜ˆå€¼"
        fi
    done
    
    # æ¸©åº¦æ£€æŸ¥
    temp=$(grep -A5 '"id": 194' $json_file | grep "raw" | grep "value" | cut -d':' -f2 | tr -d ' ,')
    if [ -n "$temp" ]; then
        echo "å½“å‰æ¸©åº¦: ${temp}Â°C"
        if [ "$temp" -gt "55" ]; then
            echo "ğŸ”¥ æ¸©åº¦è¿‡é«˜ï¼Œéœ€è¦å…³æ³¨ï¼"
        fi
    fi
    
    echo "==============================================="
}

# ä¸»ç›‘æ§å‡½æ•°
monitor_disk() {
    local disk=$1
    
    # æ£€æŸ¥ç£ç›˜æ˜¯å¦å­˜åœ¨
    if [ ! -b "$disk" ]; then
        echo "é”™è¯¯: ç£ç›˜ $disk ä¸å­˜åœ¨" >> $LOG_FILE
        return 1
    fi
    
    # è·å–SMARTæ•°æ®
    smart_file=$(get_smart_data $disk)
    
    # ç”ŸæˆæŠ¥å‘Š
    report=$(generate_smart_report $disk $smart_file)
    
    # è®°å½•æ—¥å¿—
    echo "$report" >> $LOG_FILE
    
    # æ£€æŸ¥æ˜¯å¦éœ€è¦å‘Šè­¦
    if echo "$report" | grep -q "âš ï¸\|ğŸ”¥"; then
        echo "ç£ç›˜ $disk æ£€æµ‹åˆ°å¼‚å¸¸æƒ…å†µ" | mail -s "SMARTç›‘æ§å‘Šè­¦" $ALERT_EMAIL
    fi
}
```

**ğŸ”§ å®ç”¨ç›‘æ§æŠ€å·§**
```
ç›‘æ§é¢‘ç‡å»ºè®®ï¼š
â€¢ å…³é”®æœåŠ¡å™¨ï¼šæ¯å°æ—¶æ£€æŸ¥
â€¢ ä¸€èˆ¬æœåŠ¡å™¨ï¼šæ¯4å°æ—¶æ£€æŸ¥  
â€¢ åŠå…¬ç”µè„‘ï¼šæ¯å¤©æ£€æŸ¥ä¸€æ¬¡

å…³é”®æé†’ï¼š
- é‡æ–°åˆ†é…æ‰‡åŒºæ•°(ID 5) > 0 å°±è¦è­¦æƒ•
- å½“å‰å¾…å¤„ç†æ‰‡åŒº(ID 197) > 0 éœ€è¦ç«‹å³å…³æ³¨
- æ¸©åº¦è¶…è¿‡60Â°Cè¦æ£€æŸ¥æ•£çƒ­
- é€šç”µæ—¶é—´è¶…è¿‡3ä¸‡å°æ—¶è¦è€ƒè™‘æ›´æ¢
```

---

## 4. âš ï¸ æ•…éšœé¢„è­¦é˜ˆå€¼é…ç½®


### 4.1 ç†è§£é¢„è­¦é˜ˆå€¼


**ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µ**
> é¢„è­¦é˜ˆå€¼å°±åƒä½“æ£€çš„æ­£å¸¸å€¼èŒƒå›´ï¼Œè¶…è¿‡è¿™ä¸ªèŒƒå›´å°±è¯´æ˜å¯èƒ½æœ‰é—®é¢˜ã€‚è®¾ç½®åˆé€‚çš„é˜ˆå€¼æ˜¯é¢„è­¦ç³»ç»Ÿçš„å…³é”®ã€‚

**ğŸ“Š é˜ˆå€¼è®¾è®¡åŸåˆ™**
```
é˜ˆå€¼è®¾è®¡æ€è·¯ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­£å¸¸èŒƒå›´  â”‚  æ³¨æ„èŒƒå›´  â”‚  å±é™©èŒƒå›´   â”‚
â”‚           â”‚           â”‚             â”‚
â”‚    ç»¿ç¯    â”‚    é»„ç¯    â”‚    çº¢ç¯     â”‚
â”‚  ç»§ç»­ç›‘æ§  â”‚  åŠ å¼ºå…³æ³¨  â”‚  ç«‹å³å¤„ç†   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è®¾ç½®ç­–ç•¥ï¼š
ğŸ”¹ ä¿å®ˆç­–ç•¥ï¼šé˜ˆå€¼è¾ƒä½ï¼Œå‘Šè­¦é¢‘ç¹ï¼Œä½†ä¸ä¼šæ¼æ‰é—®é¢˜
ğŸ”¹ æ¿€è¿›ç­–ç•¥ï¼šé˜ˆå€¼è¾ƒé«˜ï¼Œå‘Šè­¦è¾ƒå°‘ï¼Œä½†å¯èƒ½æ¼æ‰æ—©æœŸé—®é¢˜
ğŸ”¹ å¹³è¡¡ç­–ç•¥ï¼šæ ¹æ®ç»éªŒå’Œç¯å¢ƒè°ƒæ•´ï¼Œå¹³è¡¡å‡†ç¡®æ€§å’Œå®ç”¨æ€§
```

### 4.2 æ ¸å¿ƒSMARTå±æ€§é˜ˆå€¼é…ç½®


**ğŸ“‹ æ¨èé˜ˆå€¼é…ç½®è¡¨**
| SMARTå±æ€§ | å±æ€§åç§° | **æ³¨æ„é˜ˆå€¼** | **å±é™©é˜ˆå€¼** | **è¯´æ˜** |
|-----------|----------|--------------|--------------|----------|
| `ID 1` | è¯»å–é”™è¯¯ç‡ | `> 100ä¸‡` | `> 1000ä¸‡` | è¯»å–æ•°æ®æ—¶çš„é”™è¯¯æ¬¡æ•° |
| `ID 5` | é‡æ–°åˆ†é…æ‰‡åŒº | `> 0` | `> 5` | **æœ€é‡è¦æŒ‡æ ‡**ï¼Œåé“æ•°é‡ |
| `ID 7` | å¯»é“é”™è¯¯ç‡ | `> 100ä¸‡` | `> 1000ä¸‡` | ç£å¤´å®šä½é”™è¯¯æ¬¡æ•° |
| `ID 10` | æ—‹è½¬é‡è¯•è®¡æ•° | `> 0` | `> 3` | é©¬è¾¾å¯åŠ¨å¤±è´¥æ¬¡æ•° |
| `ID 194` | æ¸©åº¦ | `> 50Â°C` | `> 60Â°C` | ç¡¬ç›˜å·¥ä½œæ¸©åº¦ |
| `ID 196` | é‡æ–°åˆ†é…äº‹ä»¶ | `> 0` | `> 10` | é‡æ–°åˆ†é…æ“ä½œæ¬¡æ•° |
| `ID 197` | å¾…å¤„ç†æ‰‡åŒº | `> 0` | `> 1` | **å…³é”®æŒ‡æ ‡**ï¼Œç«‹å³å…³æ³¨ |
| `ID 198` | ä¸å¯çº æ­£é”™è¯¯ | `> 0` | `> 0` | **ä¸¥é‡æŒ‡æ ‡**ï¼Œç«‹å³æ›´æ¢ |

**âš ï¸ ç‰¹åˆ«æ³¨æ„**
```
ç»å¯¹ä¸èƒ½å¿½è§†çš„æŒ‡æ ‡ï¼š
ğŸš¨ ID 5 (é‡æ–°åˆ†é…æ‰‡åŒº) > 0    â†’ ç¡¬ç›˜å¼€å§‹å‡ºç°åé“
ğŸš¨ ID 197 (å½“å‰å¾…å¤„ç†æ‰‡åŒº) > 0 â†’ æœ‰æ‰‡åŒºæ— æ³•è¯»å–
ğŸš¨ ID 198 (ä¸å¯çº æ­£é”™è¯¯) > 0  â†’ æ•°æ®å·²ç»æŸå

è¿™ä¸‰ä¸ªæŒ‡æ ‡ä»»ä½•ä¸€ä¸ª > 0ï¼Œéƒ½è¦ç«‹å³å¤‡ä»½æ•°æ®ï¼
```

### 4.3 é˜ˆå€¼é…ç½®æ–‡ä»¶


```bash
# /etc/smart_thresholds.conf
# SMARTç›‘æ§é˜ˆå€¼é…ç½®æ–‡ä»¶

# æ ¼å¼: ATTR_ID:WARNING_THRESHOLD:CRITICAL_THRESHOLD:DESCRIPTION

# åŸºç¡€é”™è¯¯ç±»å±æ€§
1:1000000:10000000:Raw_Read_Error_Rate
7:1000000:10000000:Seek_Error_Rate

# é‡æ–°åˆ†é…ç±»å±æ€§ (æœ€å…³é”®)
5:0:5:Reallocated_Sector_Count
196:0:10:Reallocated_Event_Count
197:0:1:Current_Pending_Sector
198:0:0:Offline_Uncorrectable

# æœºæ¢°ç±»å±æ€§
10:0:3:Spin_Retry_Count
190:45:55:Airflow_Temperature

# æ¸©åº¦ç±»å±æ€§
194:50:60:Temperature_Celsius

# ä½¿ç”¨æ—¶é—´ç±»å±æ€§ (å°æ—¶)
9:26280:43800:Power_On_Hours  # 3å¹´å’Œ5å¹´
```

**ğŸ”§ åŠ¨æ€é˜ˆå€¼é…ç½®è„šæœ¬**
```bash
#!/bin/bash
# é˜ˆå€¼é…ç½®ç®¡ç†è„šæœ¬

THRESHOLD_FILE="/etc/smart_thresholds.conf"

# è¯»å–é˜ˆå€¼é…ç½®
load_thresholds() {
    declare -gA WARNING_THRESHOLDS
    declare -gA CRITICAL_THRESHOLDS
    declare -gA ATTR_DESCRIPTIONS
    
    while IFS=':' read -r attr_id warning critical desc; do
        # è·³è¿‡æ³¨é‡Šå’Œç©ºè¡Œ
        [[ $attr_id =~ ^#.*$ ]] && continue
        [[ -z $attr_id ]] && continue
        
        WARNING_THRESHOLDS[$attr_id]=$warning
        CRITICAL_THRESHOLDS[$attr_id]=$critical
        ATTR_DESCRIPTIONS[$attr_id]=$desc
    done < $THRESHOLD_FILE
}

# æ£€æŸ¥å±æ€§å€¼
check_threshold() {
    local attr_id=$1
    local current_value=$2
    
    local warning=${WARNING_THRESHOLDS[$attr_id]}
    local critical=${CRITICAL_THRESHOLDS[$attr_id]}
    
    if [ -z "$warning" ]; then
        return 0  # æœªé…ç½®çš„å±æ€§
    fi
    
    if [ "$current_value" -gt "$critical" ]; then
        echo "CRITICAL"
        return 2
    elif [ "$current_value" -gt "$warning" ]; then
        echo "WARNING" 
        return 1
    else
        echo "OK"
        return 0
    fi
}

# ç¤ºä¾‹ä½¿ç”¨
load_thresholds
result=$(check_threshold "5" "3")
echo "é‡æ–°åˆ†é…æ‰‡åŒºæ•°æ£€æŸ¥ç»“æœ: $result"
```

---

## 5. ğŸ“§ é‚®ä»¶/çŸ­ä¿¡å‘Šè­¦æœºåˆ¶


### 5.1 å‘Šè­¦æœºåˆ¶è®¾è®¡ç†å¿µ


**ğŸ’¡ æ ¸å¿ƒç†è§£**
> å‘Šè­¦ç³»ç»Ÿå°±åƒç«è­¦æŠ¥è­¦å™¨ï¼Œä¸€æ—¦å‘ç°é—®é¢˜ç«‹å³é€šçŸ¥ç›¸å…³äººå‘˜ã€‚ä½†è¦é¿å…"ç‹¼æ¥äº†"æ•ˆåº”ï¼Œåˆç†è®¾è®¡å‘Šè­¦çº§åˆ«å’Œé¢‘ç‡ã€‚

**ğŸ”” å‘Šè­¦çº§åˆ«è®¾è®¡**
```
å‘Šè­¦çº§åˆ«æ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ çº§åˆ« â”‚ é¢œè‰² â”‚ é€šçŸ¥æ–¹å¼ â”‚    å¤„ç†æ—¶é—´    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ INFO â”‚  ğŸ”µ  â”‚   æ—¥å¿—   â”‚      æ—        â”‚
â”‚ WARN â”‚  ğŸŸ¡  â”‚  é‚®ä»¶   â”‚    24å°æ—¶     â”‚
â”‚ ERRORâ”‚  ğŸŸ   â”‚ é‚®ä»¶+çŸ­ä¿¡â”‚     4å°æ—¶     â”‚
â”‚FATAL â”‚  ğŸ”´  â”‚ ç”µè¯å‘Šè­¦ â”‚    ç«‹å³å¤„ç†    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 é‚®ä»¶å‘Šè­¦é…ç½®


**ğŸ“§ åŸºç¡€é‚®ä»¶é…ç½®**
```bash
# å®‰è£…é‚®ä»¶å·¥å…·
sudo apt-get install mailutils ssmtp

# é…ç½®ssmtp (/etc/ssmtp/ssmtp.conf)
root=admin@company.com
mailhub=smtp.company.com:587
rewriteDomain=company.com
hostname=server01
UseTLS=Yes
UseSTARTTLS=Yes
AuthUser=alert@company.com
AuthPass=your_password
```

**ğŸ“¨ é‚®ä»¶å‘Šè­¦è„šæœ¬**
```bash
#!/bin/bash
# é‚®ä»¶å‘Šè­¦å‘é€è„šæœ¬

send_disk_alert() {
    local alert_level=$1
    local disk=$2
    local message=$3
    local timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    
    # æ ¹æ®çº§åˆ«è®¾ç½®æ”¶ä»¶äºº
    case $alert_level in
        "WARNING")
            recipients="sysadmin@company.com"
            subject="âš ï¸  ç£ç›˜è­¦å‘Š - $disk"
            ;;
        "CRITICAL")
            recipients="sysadmin@company.com,manager@company.com"
            subject="ğŸš¨ ç£ç›˜ä¸¥é‡å‘Šè­¦ - $disk"
            ;;
        "FATAL")
            recipients="sysadmin@company.com,manager@company.com,cto@company.com"
            subject="ğŸ’€ ç£ç›˜è‡´å‘½é”™è¯¯ - $disk"
            ;;
    esac
    
    # æ„å»ºé‚®ä»¶å†…å®¹
    email_body="
æœåŠ¡å™¨ç£ç›˜å‘Šè­¦é€šçŸ¥
==================

å‘Šè­¦çº§åˆ«: $alert_level
é—®é¢˜ç£ç›˜: $disk
å‘ç”Ÿæ—¶é—´: $timestamp
æœåŠ¡å™¨: $(hostname)

é—®é¢˜æè¿°:
$message

SMARTè¯¦ç»†ä¿¡æ¯:
$(smartctl -a $disk | head -20)

è¯·åŠæ—¶å¤„ç†æ­¤é—®é¢˜ä»¥é¿å…æ•°æ®ä¸¢å¤±ã€‚

--
è‡ªåŠ¨ç£ç›˜ç›‘æ§ç³»ç»Ÿ
"

    # å‘é€é‚®ä»¶
    echo "$email_body" | mail -s "$subject" $recipients
    
    # è®°å½•å‘é€æ—¥å¿—
    echo "[$timestamp] å‘é€ $alert_level çº§åˆ«å‘Šè­¦é‚®ä»¶åˆ°: $recipients" >> /var/log/disk_alerts.log
}

# ä½¿ç”¨ç¤ºä¾‹
send_disk_alert "WARNING" "/dev/sda" "é‡æ–°åˆ†é…æ‰‡åŒºæ•°å¢åŠ åˆ°5ä¸ª"
```

### 5.3 çŸ­ä¿¡å‘Šè­¦é›†æˆ


**ğŸ“± çŸ­ä¿¡APIé›†æˆç¤ºä¾‹**
```bash
#!/bin/bash
# çŸ­ä¿¡å‘Šè­¦è„šæœ¬ (ä»¥é˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡ä¸ºä¾‹)

# é…ç½®ä¿¡æ¯
SMS_ACCESS_KEY="your_access_key"
SMS_ACCESS_SECRET="your_access_secret"  
SMS_SIGN_NAME="æœåŠ¡å™¨ç›‘æ§"
SMS_TEMPLATE_CODE="SMS_123456789"

send_sms_alert() {
    local phone_number=$1
    local disk=$2
    local alert_level=$3
    
    # æ„å»ºçŸ­ä¿¡å†…å®¹
    local sms_content="ã€æœåŠ¡å™¨ç›‘æ§ã€‘$alert_levelçº§åˆ«å‘Šè­¦ï¼šæœåŠ¡å™¨$(hostname)çš„ç£ç›˜$diskå‡ºç°å¼‚å¸¸ï¼Œè¯·åŠæ—¶å¤„ç†ã€‚æ—¶é—´ï¼š$(date '+%m-%d %H:%M')"
    
    # è°ƒç”¨çŸ­ä¿¡API (ç®€åŒ–ç¤ºä¾‹)
    curl -X POST "https://dysmsapi.aliyuncs.com/" \
        -d "PhoneNumbers=$phone_number" \
        -d "SignName=$SMS_SIGN_NAME" \
        -d "TemplateCode=$SMS_TEMPLATE_CODE" \
        -d "TemplateParam={\"disk\":\"$disk\",\"level\":\"$alert_level\"}" \
        --header "Authorization: your_signature"
    
    echo "çŸ­ä¿¡å‘Šè­¦å·²å‘é€åˆ°: $phone_number"
}

# å‘Šè­¦å‡çº§æœºåˆ¶
escalate_alert() {
    local disk=$1
    local alert_level=$2
    local message=$3
    
    case $alert_level in
        "WARNING")
            send_disk_alert "WARNING" $disk "$message"
            ;;
        "CRITICAL")
            send_disk_alert "CRITICAL" $disk "$message"
            send_sms_alert "13800138000" $disk "CRITICAL"  # ç³»ç»Ÿç®¡ç†å‘˜
            ;;
        "FATAL")
            send_disk_alert "FATAL" $disk "$message"
            send_sms_alert "13800138000" $disk "FATAL"     # ç³»ç»Ÿç®¡ç†å‘˜
            send_sms_alert "13900139000" $disk "FATAL"     # æŠ€æœ¯ä¸»ç®¡
            ;;
    esac
}
```

**ğŸ”• å‘Šè­¦é™é»˜å’Œå»é‡**
```bash
#!/bin/bash
# å‘Šè­¦å»é‡å’Œé™é»˜æœºåˆ¶

ALERT_STATE_FILE="/var/lib/disk_monitor/alert_states"

# æ£€æŸ¥æ˜¯å¦éœ€è¦å‘é€å‘Šè­¦
should_send_alert() {
    local disk=$1
    local alert_level=$2
    local current_time=$(date +%s)
    
    # è¯»å–ä¸Šæ¬¡å‘Šè­¦æ—¶é—´
    local last_alert_time=$(grep "^$disk:$alert_level:" $ALERT_STATE_FILE | cut -d':' -f3)
    
    # å‘Šè­¦é—´éš”è®¾ç½® (ç§’)
    local warning_interval=3600      # WARNING: 1å°æ—¶
    local critical_interval=1800     # CRITICAL: 30åˆ†é’Ÿ
    local fatal_interval=300         # FATAL: 5åˆ†é’Ÿ
    
    case $alert_level in
        "WARNING")
            interval=$warning_interval
            ;;
        "CRITICAL") 
            interval=$critical_interval
            ;;
        "FATAL")
            interval=$fatal_interval
            ;;
    esac
    
    # æ£€æŸ¥æ˜¯å¦åœ¨é™é»˜æœŸå†…
    if [ -n "$last_alert_time" ]; then
        local time_diff=$((current_time - last_alert_time))
        if [ $time_diff -lt $interval ]; then
            return 1  # åœ¨é™é»˜æœŸå†…ï¼Œä¸å‘é€å‘Šè­¦
        fi
    fi
    
    # æ›´æ–°å‘Šè­¦æ—¶é—´
    sed -i "/^$disk:$alert_level:/d" $ALERT_STATE_FILE
    echo "$disk:$alert_level:$current_time" >> $ALERT_STATE_FILE
    
    return 0  # å¯ä»¥å‘é€å‘Šè­¦
}
```

---

## 6. ğŸ“Š ç›‘æ§æ•°æ®å¯è§†åŒ–


### 6.1 ç›‘æ§æ•°æ®å¯è§†åŒ–çš„é‡è¦æ€§


**ğŸ’¡ æ ¸å¿ƒç†è§£**
> æ•°æ®å¯è§†åŒ–å°±åƒç»™åŒ»ç”Ÿçœ‹Xå…‰ç‰‡ï¼ŒæŠŠå¤æ‚çš„æ•°å­—å˜æˆç›´è§‚çš„å›¾è¡¨ï¼Œè®©æˆ‘ä»¬ä¸€çœ¼å°±èƒ½çœ‹å‡ºç¡¬ç›˜çš„å¥åº·è¶‹åŠ¿å’Œæ½œåœ¨é—®é¢˜ã€‚

**ğŸ“ˆ å¯è§†åŒ–çš„ä»·å€¼**
```
æ•°å­— vs å›¾è¡¨çš„å¯¹æ¯”ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ•°å­—: é‡æ–°åˆ†é…æ‰‡åŒº 0â†’1â†’3â†’7â†’12   â”‚
â”‚                                â”‚  
â”‚ å›¾è¡¨: ğŸ“ˆ å¯ä»¥ç›´è§‚çœ‹å‡ºæ¶åŒ–è¶‹åŠ¿    â”‚
â”‚       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚
â”‚       0    1    3    7    12    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¯è§†åŒ–ä¼˜åŠ¿ï¼š
â€¢ è¶‹åŠ¿ä¸€ç›®äº†ç„¶
â€¢ å¼‚å¸¸å¿«é€Ÿè¯†åˆ«  
â€¢ å†å²å¯¹æ¯”æ¸…æ™°
â€¢ å†³ç­–æ›´åŠ å‡†ç¡®
```

### 6.2 åŸºäºGrafanaçš„ç›‘æ§é¢æ¿


**ğŸ“Š Grafanaé…ç½®æ¦‚è¿°**
```bash
# å®‰è£…Grafana
wget -q -O - https://packages.grafana.com/gpg.key | sudo apt-key add -
echo "deb https://packages.grafana.com/oss/deb stable main" | sudo tee -a /etc/apt/sources.list.d/grafana.list
sudo apt-get update && sudo apt-get install grafana

# å¯åŠ¨æœåŠ¡
sudo systemctl enable grafana-server
sudo systemctl start grafana-server
```

**ğŸ”§ æ•°æ®æ”¶é›†è„šæœ¬(è¾“å‡ºåˆ°InfluxDB)**
```bash
#!/bin/bash
# å°†SMARTæ•°æ®å‘é€åˆ°InfluxDB

INFLUXDB_URL="http://localhost:8086"
DATABASE="disk_monitoring"

collect_smart_metrics() {
    local disk=$1
    local disk_name=$(basename $disk)
    local timestamp=$(date +%s)000000000  # çº³ç§’æ—¶é—´æˆ³
    
    # è·å–å…³é”®SMARTå±æ€§
    smartctl -A $disk | while read line; do
        if echo "$line" | grep -E "^[ ]*[0-9]+" > /dev/null; then
            attr_id=$(echo "$line" | awk '{print $1}')
            attr_name=$(echo "$line" | awk '{print $2}')
            raw_value=$(echo "$line" | awk '{print $10}')
            
            # å‘é€åˆ°InfluxDB
            curl -i -XPOST "$INFLUXDB_URL/write?db=$DATABASE" \
                --data-binary "smart_attributes,disk=$disk_name,attr_id=$attr_id,attr_name=$attr_name value=$raw_value $timestamp"
        fi
    done
    
    # æ”¶é›†æ¸©åº¦ä¿¡æ¯
    temp=$(smartctl -A $disk | grep "Temperature" | awk '{print $10}')
    if [ -n "$temp" ]; then
        curl -i -XPOST "$INFLUXDB_URL/write?db=$DATABASE" \
            --data-binary "disk_temperature,disk=$disk_name value=$temp $timestamp"
    fi
}

# æ”¶é›†æ‰€æœ‰ç£ç›˜æ•°æ®
for disk in /dev/sd*; do
    [ -b "$disk" ] && collect_smart_metrics $disk
done
```

### 6.3 ç®€å•Webé¢æ¿å®ç°


**ğŸŒ åŸºç¡€HTMLç›‘æ§é¢æ¿**
```html
<!DOCTYPE html>
<html>
<head>
    <title>ç£ç›˜å¥åº·ç›‘æ§é¢æ¿</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .dashboard { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px; }
        .panel { border: 1px solid #ddd; padding: 15px; border-radius: 5px; }
        .status-ok { color: green; }
        .status-warning { color: orange; }
        .status-critical { color: red; }
    </style>
</head>
<body>
    <h1>ğŸ–¥ï¸ ç£ç›˜å¥åº·ç›‘æ§é¢æ¿</h1>
    
    <div class="dashboard">
        <div class="panel">
            <h3>ğŸ“Š ç£ç›˜çŠ¶æ€æ€»è§ˆ</h3>
            <div id="disk-status"></div>
        </div>
        
        <div class="panel">
            <h3>ğŸŒ¡ï¸ æ¸©åº¦è¶‹åŠ¿</h3>
            <canvas id="temp-chart" width="400" height="200"></canvas>
        </div>
        
        <div class="panel">
            <h3>ğŸ”§ SMARTå±æ€§è¶‹åŠ¿</h3>
            <canvas id="smart-chart" width="400" height="200"></canvas>
        </div>
        
        <div class="panel">
            <h3>âš ï¸ æœ€æ–°å‘Šè­¦</h3>
            <div id="recent-alerts"></div>
        </div>
    </div>

    <script>
    // è·å–ç£ç›˜çŠ¶æ€æ•°æ®
    async function loadDiskStatus() {
        try {
            const response = await fetch('/api/disk-status');
            const data = await response.json();
            
            let statusHtml = '';
            data.disks.forEach(disk => {
                const statusClass = disk.health === 'PASSED' ? 'status-ok' : 'status-critical';
                statusHtml += `
                    <div class="${statusClass}">
                        <strong>${disk.name}</strong>: ${disk.health}
                        <br>æ¸©åº¦: ${disk.temperature}Â°C
                        <br>é‡æ–°åˆ†é…æ‰‡åŒº: ${disk.reallocated_sectors}
                    </div>
                    <hr>
                `;
            });
            
            document.getElementById('disk-status').innerHTML = statusHtml;
        } catch (error) {
            console.error('åŠ è½½ç£ç›˜çŠ¶æ€å¤±è´¥:', error);
        }
    }
    
    // åˆå§‹åŒ–æ¸©åº¦å›¾è¡¨
    function initTempChart() {
        const ctx = document.getElementById('temp-chart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['1hå‰', '2hå‰', '3hå‰', '4hå‰', 'ç°åœ¨'],
                datasets: [{
                    label: 'ç£ç›˜æ¸©åº¦',
                    data: [45, 47, 44, 46, 48],
                    borderColor: 'rgb(255, 99, 132)',
                    tension: 0.1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: false,
                        min: 30,
                        max: 70
                    }
                }
            }
        });
    }
    
    // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
    window.onload = function() {
        loadDiskStatus();
        initTempChart();
        
        // æ¯30ç§’åˆ·æ–°ä¸€æ¬¡æ•°æ®
        setInterval(loadDiskStatus, 30000);
    };
    </script>
</body>
</html>
```

**ğŸ”§ åç«¯APIè„šæœ¬(ç®€åŒ–ç‰ˆ)**
```bash
#!/bin/bash
# ç®€å•çš„APIæœåŠ¡å™¨ (ä½¿ç”¨Python)

cat > /tmp/disk_api.py << 'EOF'
#!/usr/bin/env python3
import json, subprocess
from http.server import HTTPServer, BaseHTTPRequestHandler

class DiskAPIHandler(BaseHTTPRequestHandler):
    def do_GET(self):
        if self.path == '/api/disk-status':
            self.send_response(200)
            self.send_header('Content-type', 'application/json')
            self.send_header('Access-Control-Allow-Origin', '*')
            self.end_headers()
            
            # è·å–ç£ç›˜çŠ¶æ€
            disks = []
            for disk in ['/dev/sda', '/dev/sdb']:
                try:
                    # è·å–SMARTå¥åº·çŠ¶æ€
                    result = subprocess.run(['smartctl', '-H', disk], 
                                          capture_output=True, text=True)
                    health = 'PASSED' if 'PASSED' in result.stdout else 'FAILED'
                    
                    # è·å–æ¸©åº¦
                    temp_result = subprocess.run(['smartctl', '-A', disk], 
                                               capture_output=True, text=True)
                    temp = '45'  # ç®€åŒ–å®ç°
                    
                    disks.append({
                        'name': disk,
                        'health': health,
                        'temperature': temp,
                        'reallocated_sectors': 0
                    })
                except:
                    pass
            
            response = {'disks': disks}
            self.wfile.write(json.dumps(response).encode())

if __name__ == '__main__':
    server = HTTPServer(('localhost', 8080), DiskAPIHandler)
    print('APIæœåŠ¡å™¨å¯åŠ¨åœ¨ http://localhost:8080')
    server.serve_forever()
EOF

python3 /tmp/disk_api.py
```

---

## 7. ğŸ“ˆ è¶‹åŠ¿åˆ†æä¸é¢„æµ‹


### 7.1 è¶‹åŠ¿åˆ†æçš„é‡è¦æ€§


**ğŸ’¡ æ ¸å¿ƒç†è§£**
> è¶‹åŠ¿åˆ†æå°±åƒåŒ»ç”Ÿçœ‹ç—…äººçš„å†å²ç—…å†ï¼Œé€šè¿‡è§‚å¯Ÿæ•°æ®çš„å˜åŒ–è§„å¾‹ï¼Œé¢„æµ‹ç¡¬ç›˜æœªæ¥å¯èƒ½å‡ºç°çš„é—®é¢˜ï¼Œåšåˆ°é˜²æ‚£äºæœªç„¶ã€‚

**ğŸ“Š è¶‹åŠ¿åˆ†æçš„ä»·å€¼**
```
é™æ€æ•°æ® vs è¶‹åŠ¿æ•°æ®ï¼š

é™æ€æ•°æ®ï¼šé‡æ–°åˆ†é…æ‰‡åŒº = 3
å«ä¹‰ï¼šä¸æ¸…æ¥šæ˜¯å¥½æ˜¯å

è¶‹åŠ¿æ•°æ®ï¼š0 â†’ 0 â†’ 1 â†’ 2 â†’ 3 (ä¸€å‘¨å†…å˜åŒ–)
å«ä¹‰ï¼šæ˜æ˜¾æ¶åŒ–ï¼Œéœ€è¦ç«‹å³å…³æ³¨ï¼

è¶‹åŠ¿åˆ†æä¼˜åŠ¿ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ æå‰å‘ç°é—®é¢˜å¾å…†                  â”‚
â”‚ â€¢ é¢„æµ‹æ•…éšœå‘ç”Ÿæ—¶é—´                  â”‚  
â”‚ â€¢ åˆ¶å®šåˆç†æ›´æ¢è®¡åˆ’                  â”‚
â”‚ â€¢ é¿å…çªå‘æ•°æ®ä¸¢å¤±                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 å…³é”®æŒ‡æ ‡è¶‹åŠ¿ç›‘æ§


**ğŸ“‹ é‡ç‚¹å…³æ³¨çš„è¶‹åŠ¿æŒ‡æ ‡**
```
æ ¸å¿ƒè¶‹åŠ¿æŒ‡æ ‡ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŒ‡æ ‡                â”‚ æ­£å¸¸è¶‹åŠ¿  â”‚ å¼‚å¸¸è¶‹åŠ¿            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é‡æ–°åˆ†é…æ‰‡åŒº(ID 5)  â”‚ ä¿æŒ0     â”‚ ä»0å¼€å§‹å¢é•¿ ğŸš¨      â”‚
â”‚ å½“å‰å¾…å¤„ç†æ‰‡åŒº(ID 197)â”‚ ä¿æŒ0   â”‚ å‡ºç°é0å€¼ ğŸš¨        â”‚
â”‚ æ¸©åº¦(ID 194)        â”‚ ç¨³å®šå˜åŒ–  â”‚ æŒç»­å‡é«˜ âš ï¸        â”‚
â”‚ é€šç”µæ—¶é—´(ID 9)      â”‚ åŒ€é€Ÿå¢é•¿  â”‚ æ— å¼‚å¸¸              â”‚
â”‚ è¯»å–é”™è¯¯ç‡(ID 1)    â”‚ ç¨³å®šæˆ–ç¼“æ…¢å¢é•¿â”‚ æ€¥å‰§å¢é•¿ âš ï¸     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å±é™©ä¿¡å·è¯†åˆ«ï¼š
ğŸ”´ ä»»ä½•ä»0å˜ä¸ºé0çš„å…³é”®æŒ‡æ ‡ (ID 5, 197, 198)
ğŸŸ  7å¤©å†…æ¸©åº¦æŒç»­è¶…è¿‡50Â°C
ğŸŸ¡ 30å¤©å†…è¯»å–é”™è¯¯ç‡å¢é•¿è¶…è¿‡100ä¸‡
```

### 7.3 è¶‹åŠ¿åˆ†æè„šæœ¬


```bash
#!/bin/bash
# SMARTè¶‹åŠ¿åˆ†æè„šæœ¬

DATA_DIR="/var/lib/smart_trends"
TREND_LOG="$DATA_DIR/trend_analysis.log"
ALERT_THRESHOLD_DAYS=7

# åˆ›å»ºæ•°æ®ç›®å½•
mkdir -p $DATA_DIR

# è®°å½•SMARTå†å²æ•°æ®
record_smart_history() {
    local disk=$1
    local date_str=$(date '+%Y-%m-%d')
    local history_file="$DATA_DIR/$(basename $disk)_history.csv"
    
    # åˆ›å»ºCSVå¤´éƒ¨(å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨)
    if [ ! -f "$history_file" ]; then
        echo "date,attr_5,attr_194,attr_197,attr_198,attr_1,attr_9" > $history_file
    fi
    
    # è·å–å…³é”®SMARTå±æ€§
    local smart_data=$(smartctl -A $disk)
    
    local attr_5=$(echo "$smart_data" | grep "^  5 " | awk '{print $10}')
    local attr_194=$(echo "$smart_data" | grep "^194 " | awk '{print $10}')
    local attr_197=$(echo "$smart_data" | grep "^197 " | awk '{print $10}')
    local attr_198=$(echo "$smart_data" | grep "^198 " | awk '{print $10}')
    local attr_1=$(echo "$smart_data" | grep "^  1 " | awk '{print $10}')
    local attr_9=$(echo "$smart_data" | grep "^  9 " | awk '{print $10}')
    
    # å†™å…¥å†å²æ•°æ®
    echo "$date_str,$attr_5,$attr_194,$attr_197,$attr_198,$attr_1,$attr_9" >> $history_file
}

# åˆ†æè¶‹åŠ¿
analyze_trends() {
    local disk=$1
    local history_file="$DATA_DIR/$(basename $disk)_history.csv"
    
    if [ ! -f "$history_file" ]; then
        echo "æ²¡æœ‰è¶³å¤Ÿçš„å†å²æ•°æ®è¿›è¡Œè¶‹åŠ¿åˆ†æ"
        return 1
    fi
    
    echo "æ­£åœ¨åˆ†æ $disk çš„è¶‹åŠ¿..."
    
    # åˆ†æé‡æ–°åˆ†é…æ‰‡åŒºè¶‹åŠ¿ (æœ€å…³é”®)
    local latest_attr5=$(tail -1 $history_file | cut -d',' -f2)
    local week_ago_attr5=$(tail -8 $history_file | head -1 | cut -d',' -f2 2>/dev/null)
    
    if [ -n "$week_ago_attr5" ] && [ -n "$latest_attr5" ]; then
        if [ "$latest_attr5" -gt "$week_ago_attr5" ]; then
            local increase=$((latest_attr5 - week_ago_attr5))
            echo "ğŸš¨ è­¦å‘Š: é‡æ–°åˆ†é…æ‰‡åŒºåœ¨è¿‡å»ä¸€å‘¨å¢åŠ äº† $increase ä¸ª!"
            echo "   ä¸€å‘¨å‰: $week_ago_attr5, ç°åœ¨: $latest_attr5"
            
            # é¢„æµ‹è¶‹åŠ¿
            if [ "$increase" -gt "0" ]; then
                local days_to_failure=$(echo "scale=1; (10 - $latest_attr5) * 7 / $increase" | bc 2>/dev/null)
                echo "   é¢„æµ‹: æŒ‰å½“å‰è¶‹åŠ¿ï¼Œ$days_to_failure å¤©åå¯èƒ½éœ€è¦æ›´æ¢ç¡¬ç›˜"
            fi
        fi
    fi
    
    # åˆ†ææ¸©åº¦è¶‹åŠ¿
    local avg_temp_recent=$(tail -7 $history_file | cut -d',' -f3 | awk '{sum+=$1; count++} END {if(count>0) print sum/count}')
    local avg_temp_older=$(tail -14 $history_file | head -7 | cut -d',' -f3 | awk '{sum+=$1; count++} END {if(count>0) print sum/count}')
    
    if [ -n "$avg_temp_recent" ] && [ -n "$avg_temp_older" ]; then
        local temp_diff=$(echo "$avg_temp_recent - $avg_temp_older" | bc 2>/dev/null)
        if (( $(echo "$temp_diff > 5" | bc -l) )); then
            echo "ğŸ”¥ æ³¨æ„: å¹³å‡æ¸©åº¦åœ¨è¿‡å»ä¸€å‘¨ä¸Šå‡äº† ${temp_diff}Â°C"
            echo "   å»ºè®®æ£€æŸ¥æ•£çƒ­ç³»ç»Ÿ"
        fi
    fi
}

# ç”Ÿæˆè¶‹åŠ¿æŠ¥å‘Š
generate_trend_report() {
    local disk=$1
    local history_file="$DATA_DIR/$(basename $disk)_history.csv"
    local report_file="$DATA_DIR/$(basename $disk)_trend_report.txt"
    
    echo "ç£ç›˜è¶‹åŠ¿åˆ†ææŠ¥å‘Š - $disk" > $report_file
    echo "ç”Ÿæˆæ—¶é—´: $(date)" >> $report_file
    echo "========================================" >> $report_file
    
    # æœ€è¿‘7å¤©çš„æ•°æ®æ‘˜è¦
    echo "" >> $report_file
    echo "æœ€è¿‘7å¤©å…³é”®æŒ‡æ ‡å˜åŒ–:" >> $report_file
    tail -7 $history_file | while IFS=',' read date attr5 temp attr197 attr198 attr1 attr9; do
        echo "$date: é‡æ–°åˆ†é…æ‰‡åŒº=$attr5, æ¸©åº¦=${temp}Â°C, å¾…å¤„ç†æ‰‡åŒº=$attr197" >> $report_file
    done
    
    # è¶‹åŠ¿åˆ†æç»“æœ
    echo "" >> $report_file
    echo "è¶‹åŠ¿åˆ†æç»“æœ:" >> $report_file
    analyze_trends $disk >> $report_file
    
    echo "æŠ¥å‘Šå·²ç”Ÿæˆ: $report_file"
}

# ä¸»ç¨‹åº
main() {
    local disks=("/dev/sda" "/dev/sdb" "/dev/sdc")
    
    for disk in "${disks[@]}"; do
        if [ -b "$disk" ]; then
            echo "å¤„ç†ç£ç›˜: $disk"
            record_smart_history $disk
            analyze_trends $disk
            generate_trend_report $disk
            echo "---"
        fi
    done
}

main
```

**âš ï¸ é¢„æµ‹æ¨¡å‹ç®€åŒ–ç‰ˆ**
```bash
#!/bin/bash
# ç®€å•çš„æ•…éšœé¢„æµ‹æ¨¡å‹

predict_failure() {
    local disk=$1
    local history_file="$DATA_DIR/$(basename $disk)_history.csv"
    
    # è¯»å–æœ€è¿‘30å¤©çš„é‡æ–°åˆ†é…æ‰‡åŒºæ•°æ®
    local recent_data=$(tail -30 $history_file | cut -d',' -f2 | grep -v "attr_5")
    
    # è®¡ç®—å¢é•¿ç‡
    local first_value=$(echo "$recent_data" | head -1)
    local last_value=$(echo "$recent_data" | tail -1)
    local data_points=$(echo "$recent_data" | wc -l)
    
    if [ "$data_points" -gt 7 ] && [ "$last_value" -gt "$first_value" ]; then
        local growth_rate=$(echo "scale=3; ($last_value - $first_value) / $data_points" | bc)
        
        # é¢„æµ‹æ¨¡å‹ï¼šå¦‚æœå¢é•¿ç‡æŒç»­ï¼Œä½•æ—¶è¾¾åˆ°å±é™©å€¼ (å‡è®¾20ä¸ªé‡æ–°åˆ†é…æ‰‡åŒºä¸ºå±é™©å€¼)
        local days_to_danger=$(echo "scale=1; (20 - $last_value) / $growth_rate" | bc 2>/dev/null)
        
        echo "é¢„æµ‹åˆ†æ - $disk:"
        echo "å½“å‰é‡æ–°åˆ†é…æ‰‡åŒº: $last_value"
        echo "å¹³å‡æ—¥å¢é•¿ç‡: $growth_rate"
        echo "é¢„è®¡ $days_to_danger å¤©åè¾¾åˆ°å±é™©æ°´å¹³"
        
        if (( $(echo "$days_to_danger < 30" | bc -l) )); then
            echo "ğŸš¨ å»ºè®®ç«‹å³å®‰æ’æ•°æ®å¤‡ä»½å’Œç¡¬ç›˜æ›´æ¢!"
        elif (( $(echo "$days_to_danger < 90" | bc -l) )); then
            echo "âš ï¸  å»ºè®®åœ¨æœªæ¥2-3ä¸ªæœˆå†…å®‰æ’ç¡¬ç›˜æ›´æ¢"
        fi
    fi
}
```

---

## 8. ğŸ”§ é›†æˆç›‘æ§ç³»ç»Ÿé…ç½®


### 8.1 ç›‘æ§ç³»ç»Ÿé›†æˆæ¦‚è¿°


**ğŸ’¡ æ ¸å¿ƒç†è§£**
> é›†æˆç›‘æ§å°±åƒæŠŠæ‰€æœ‰çš„"ä½“æ£€æŠ¥å‘Š"æ±‡æ€»åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œè®©ç®¡ç†å‘˜åœ¨ä¸€ä¸ªç•Œé¢å°±èƒ½çœ‹åˆ°æ‰€æœ‰æœåŠ¡å™¨çš„ç£ç›˜å¥åº·çŠ¶å†µï¼Œä¸ç”¨åˆ°å¤„æ‰¾ä¿¡æ¯ã€‚

**ğŸ—ï¸ é›†æˆæ¶æ„è®¾è®¡**
```
ç›‘æ§ç³»ç»Ÿé›†æˆæ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 ç›‘æ§ä¸­å¿ƒ                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Nagios    â”‚  â”‚   Zabbix    â”‚  â”‚  Prometheus â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”
â”‚   Server A    â”‚  â”‚  Server B â”‚  â”‚  Server C â”‚
â”‚ ç£ç›˜ç›‘æ§Agent â”‚  â”‚ç£ç›˜ç›‘æ§Agentâ”‚  â”‚ç£ç›˜ç›‘æ§Agentâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é›†æˆä¼˜åŠ¿ï¼š
â€¢ ç»Ÿä¸€ç®¡ç†ç•Œé¢
â€¢ é›†ä¸­å‘Šè­¦å¤„ç†
â€¢ å†å²æ•°æ®åˆ†æ
â€¢ æ‰¹é‡é…ç½®ç®¡ç†
```

### 8.2 Nagiosé›†æˆé…ç½®


**ğŸ”§ Nagiosæ’ä»¶å¼€å‘**
```bash
#!/bin/bash
# Nagiosç£ç›˜å¥åº·æ£€æŸ¥æ’ä»¶
# æ–‡ä»¶ä½ç½®: /usr/local/nagios/libexec/check_disk_smart

PLUGIN_NAME="DISK_SMART"
VERSION="1.0"

# NagiosçŠ¶æ€ç 
STATE_OK=0
STATE_WARNING=1
STATE_CRITICAL=2
STATE_UNKNOWN=3

# æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
print_help() {
    echo "$PLUGIN_NAME $VERSION"
    echo "ç”¨æ³•: $0 -d <ç£ç›˜è®¾å¤‡> [-w è­¦å‘Šé˜ˆå€¼] [-c ä¸¥é‡é˜ˆå€¼]"
    echo ""
    echo "é€‰é¡¹:"
    echo "  -d  ç£ç›˜è®¾å¤‡è·¯å¾„ (ä¾‹å¦‚: /dev/sda)"
    echo "  -w  è­¦å‘Šé˜ˆå€¼ (é‡æ–°åˆ†é…æ‰‡åŒºæ•°, é»˜è®¤: 1)"
    echo "  -c  ä¸¥é‡é˜ˆå€¼ (é‡æ–°åˆ†é…æ‰‡åŒºæ•°, é»˜è®¤: 5)"
    echo "  -h  æ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯"
}

# æ£€æŸ¥SMARTçŠ¶æ€
check_smart_status() {
    local disk=$1
    local warn_threshold=$2
    local crit_threshold=$3
    
    # æ£€æŸ¥ç£ç›˜æ˜¯å¦å­˜åœ¨
    if [ ! -b "$disk" ]; then
        echo "UNKNOWN - ç£ç›˜è®¾å¤‡ $disk ä¸å­˜åœ¨"
        exit $STATE_UNKNOWN
    fi
    
    # æ£€æŸ¥SMARTæ˜¯å¦æ”¯æŒ
    if ! smartctl -i $disk | grep -q "SMART support is: Available"; then
        echo "UNKNOWN - ç£ç›˜ $disk ä¸æ”¯æŒSMART"
        exit $STATE_UNKNOWN
    fi
    
    # è·å–SMARTå¥åº·çŠ¶æ€
    local health_status=$(smartctl -H $disk | grep "test result" | awk '{print $6}')
    
    # è·å–é‡è¦SMARTå±æ€§
    local smart_data=$(smartctl -A $disk)
    local reallocated_sectors=$(echo "$smart_data" | grep "^  5 " | awk '{print $10}')
    local current_pending=$(echo "$smart_data" | grep "^197 " | awk '{print $10}')
    local offline_uncorrectable=$(echo "$smart_data" | grep "^198 " | awk '{print $10}')
    local temperature=$(echo "$smart_data" | grep "^194 " | awk '{print $10}')
    
    # æ„å»ºæ€§èƒ½æ•°æ®
    local perfdata="reallocated_sectors=$reallocated_sectors;$warn_threshold;$crit_threshold;0"
    perfdata="$perfdata current_pending=$current_pending;0;1;0"
    perfdata="$perfdata temperature=$temperature;50;60;0"
    
    # æ£€æŸ¥è‡´å‘½é”™è¯¯
    if [ "$health_status" != "PASSED" ]; then
        echo "CRITICAL - SMARTå¥åº·æ£€æŸ¥å¤±è´¥: $health_status | $perfdata"
        exit $STATE_CRITICAL
    fi
    
    if [ "$offline_uncorrectable" -gt "0" ]; then
        echo "CRITICAL - æ£€æµ‹åˆ°ä¸å¯çº æ­£é”™è¯¯: $offline_uncorrectable | $perfdata"
        exit $STATE_CRITICAL
    fi
    
    if [ "$current_pending" -gt "0" ]; then
        echo "CRITICAL - æ£€æµ‹åˆ°å¾…å¤„ç†æ‰‡åŒº: $current_pending | $perfdata"
        exit $STATE_CRITICAL
    fi
    
    # æ£€æŸ¥ä¸¥é‡è­¦å‘Š
    if [ "$reallocated_sectors" -gt "$crit_threshold" ]; then
        echo "CRITICAL - é‡æ–°åˆ†é…æ‰‡åŒºè¿‡å¤š: $reallocated_sectors | $perfdata"
        exit $STATE_CRITICAL
    fi
    
    # æ£€æŸ¥ä¸€èˆ¬è­¦å‘Š
    if [ "$reallocated_sectors" -gt "$warn_threshold" ]; then
        echo "WARNING - é‡æ–°åˆ†é…æ‰‡åŒºå¢åŠ : $reallocated_sectors | $perfdata"
        exit $STATE_WARNING
    fi
    
    if [ "$temperature" -gt "55" ]; then
        echo "WARNING - æ¸©åº¦è¿‡é«˜: ${temperature}Â°C | $perfdata"
        exit $STATE_WARNING
    fi
    
    # ä¸€åˆ‡æ­£å¸¸
    echo "OK - ç£ç›˜å¥åº·çŠ¶æ€æ­£å¸¸ | $perfdata"
    exit $STATE_OK
}

# å‚æ•°è§£æ
DISK=""
WARN_THRESHOLD=1
CRIT_THRESHOLD=5

while getopts "d:w:c:h" opt; do
    case $opt in
        d) DISK="$OPTARG" ;;
        w) WARN_THRESHOLD="$OPTARG" ;;
        c) CRIT_THRESHOLD="$OPTARG" ;;
        h) print_help; exit $STATE_OK ;;
        *) print_help; exit $STATE_UNKNOWN ;;
    esac
done

# æ£€æŸ¥å¿…éœ€å‚æ•°
if [ -z "$DISK" ]; then
    echo "é”™è¯¯: å¿…é¡»æŒ‡å®šç£ç›˜è®¾å¤‡"
    print_help
    exit $STATE_UNKNOWN
fi

# æ‰§è¡Œæ£€æŸ¥
check_smart_status $DISK $WARN_THRESHOLD $CRIT_THRESHOLD
```

**ğŸ“ Nagiosé…ç½®æ–‡ä»¶**
```bash
# /usr/local/nagios/etc/objects/disk-smart.cfg

# å®šä¹‰å‘½ä»¤
define command {
    command_name    check_disk_smart
    command_line    $USER1$/check_disk_smart -d $ARG1$ -w $ARG2$ -c $ARG3$
}

# å®šä¹‰æœåŠ¡æ¨¡æ¿
define service {
    use                     generic-service
    name                    disk-smart-service
    service_description     ç£ç›˜SMARTå¥åº·æ£€æŸ¥
    check_command          check_disk_smart!/dev/sda!1!5
    check_interval         60      # æ¯60åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
    retry_interval         10      # é‡è¯•é—´éš”10åˆ†é’Ÿ
    max_check_attempts     3
    notification_interval  1440    # 24å°æ—¶é€šçŸ¥ä¸€æ¬¡
    register               0       # è¿™æ˜¯æ¨¡æ¿ï¼Œä¸è¦æ³¨å†Œ
}

# åº”ç”¨åˆ°å…·ä½“æœåŠ¡å™¨
define service {
    use                 disk-smart-service
    host_name          server01
    service_description SMARTæ£€æŸ¥-/dev/sda
    check_command      check_disk_smart!/dev/sda!1!5
}

define service {
    use                 disk-smart-service
    host_name          server01  
    service_description SMARTæ£€æŸ¥-/dev/sdb
    check_command      check_disk_smart!/dev/sdb!1!5
}
```

### 8.3 Zabbixé›†æˆé…ç½®


**ğŸ”§ Zabbix Agenté…ç½®**
```bash
# /etc/zabbix/zabbix_agentd.d/smart_monitoring.conf

# ç”¨æˆ·è‡ªå®šä¹‰å‚æ•°
UserParameter=smart.health[*],smartctl -H $1 | grep "test result" | awk '{print $$6}' | grep -c PASSED
UserParameter=smart.reallocated[*],smartctl -A $1 | grep "^  5 " | awk '{print $$10}'
UserParameter=smart.temperature[*],smartctl -A $1 | grep "^194 " | awk '{print $$10}'
UserParameter=smart.pending[*],smartctl -A $1 | grep "^197 " | awk '{print $$10}'
UserParameter=smart.uncorrectable[*],smartctl -A $1 | grep "^198 " | awk '{print $$10}'

# ç£ç›˜å‘ç°è§„åˆ™
UserParameter=smart.discovery,smartctl --scan-open | awk '{print $$1}' | sed 's/$/,/' | tr -d '\n' | sed 's/,$//'

# é‡å¯Zabbix Agent
sudo systemctl restart zabbix-agent
```

**ğŸ“Š Zabbixæ¨¡æ¿é…ç½®**
```json
{
    "zabbix_export": {
        "version": "5.0",
        "groups": [
            {
                "name": "Templates/Operating systems"
            }
        ],
        "templates": [
            {
                "template": "Template SMART Monitoring",
                "name": "Template SMART Monitoring",
                "groups": [
                    {
                        "name": "Templates/Operating systems"
                    }
                ],
                "applications": [
                    {
                        "name": "SMART Monitoring"
                    }
                ],
                "items": [
                    {
                        "name": "SMART Health Status /dev/sda",
                        "key": "smart.health[/dev/sda]",
                        "type": 0,
                        "value_type": 3,
                        "applications": [
                            {
                                "name": "SMART Monitoring"
                            }
                        ],
                        "triggers": [
                            {
                                "expression": "{Template SMART Monitoring:smart.health[/dev/sda].last()}=0",
                                "name": "SMART health check failed on /dev/sda",
                                "priority": 5
                            }
                        ]
                    }
                ]
            }
        ]
    }
}
```

### 8.4 Prometheusé›†æˆé…ç½®


**ğŸ“Š Node Exporter SMARTé…ç½®**
```bash
#!/bin/bash
# ä¸ºPrometheuså‡†å¤‡SMARTæŒ‡æ ‡

# /usr/local/bin/smart_exporter.sh
METRICS_FILE="/var/lib/node_exporter/textfile_collector/smart.prom"

# æ¸…ç©ºæ—§çš„æŒ‡æ ‡æ–‡ä»¶
> $METRICS_FILE

# æ”¶é›†SMARTæŒ‡æ ‡
collect_smart_metrics() {
    local disk=$1
    local disk_name=$(basename $disk)
    
    # SMARTå¥åº·çŠ¶æ€
    local health=$(smartctl -H $disk | grep "test result" | grep -c "PASSED")
    echo "smart_health{device=\"$disk_name\"} $health" >> $METRICS_FILE
    
    # é‡è¦SMARTå±æ€§
    smartctl -A $disk | while read line; do
        if echo "$line" | grep -E "^[ ]*[0-9]+" > /dev/null; then
            local attr_id=$(echo "$line" | awk '{print $1}')
            local attr_name=$(echo "$line" | awk '{print $2}')
            local raw_value=$(echo "$line" | awk '{print $10}')
            
            # åªæ”¶é›†å…³é”®å±æ€§
            case $attr_id in
                5|194|197|198)
                    echo "smart_attribute{device=\"$disk_name\",id=\"$attr_id\",name=\"$attr_name\"} $raw_value" >> $METRICS_FILE
                    ;;
            esac
        fi
    done
}

# æ”¶é›†æ‰€æœ‰ç£ç›˜çš„æŒ‡æ ‡
for disk in /dev/sd[a-z]; do
    if [ -b "$disk" ]; then
        collect_smart_metrics $disk
    fi
done

# æ·»åŠ æ—¶é—´æˆ³
echo "smart_collection_time $(date +%s)" >> $METRICS_FILE
```

**â° å®šæ—¶æ‰§è¡Œé…ç½®**
```bash
# æ·»åŠ åˆ°crontab
*/5 * * * * /usr/local/bin/smart_exporter.sh
```

---

## 9. ğŸ“‹ æ•…éšœæŠ¥å‘Šç”Ÿæˆ


### 9.1 æ•…éšœæŠ¥å‘Šçš„é‡è¦æ€§


**ğŸ’¡ æ ¸å¿ƒç†è§£**
> æ•…éšœæŠ¥å‘Šå°±åƒåŒ»é™¢çš„è¯Šæ–­æŠ¥å‘Šï¼Œè¯¦ç»†è®°å½•é—®é¢˜çš„å‘ç°è¿‡ç¨‹ã€ä¸¥é‡ç¨‹åº¦å’Œå»ºè®®å¤„ç†æ–¹æ¡ˆï¼Œä¸ºè¿ç»´å†³ç­–æä¾›ä¾æ®ã€‚

**ğŸ“Š æŠ¥å‘Šçš„ä»·å€¼**
```
æ•…éšœæŠ¥å‘Šçš„ä½œç”¨ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ é—®é¢˜è¿½è¸ªï¼šè®°å½•é—®é¢˜å‘ç°å’Œå¤„ç†è¿‡ç¨‹         â”‚
â”‚ ğŸ“ˆ è¶‹åŠ¿åˆ†æï¼šä¸ºå®¹é‡è§„åˆ’æä¾›æ•°æ®æ”¯æŒ         â”‚
â”‚ ğŸ” æ ¹å› åˆ†æï¼šå¸®åŠ©æ‰¾å‡ºé—®é¢˜çš„æ ¹æœ¬åŸå›          â”‚
â”‚ ğŸ“š çŸ¥è¯†ç§¯ç´¯ï¼šä¸ºå›¢é˜Ÿç§¯ç´¯æ•…éšœå¤„ç†ç»éªŒ         â”‚
â”‚ ğŸ’° æˆæœ¬åˆ†æï¼šè¯„ä¼°ç¡¬ä»¶æ›´æ¢å’Œç»´æŠ¤æˆæœ¬         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æŠ¥å‘Šç±»å‹åˆ†çº§ï¼š
â€¢ ğŸ“„ æ—¥å¸¸æŠ¥å‘Šï¼šå®šæœŸå¥åº·æ£€æŸ¥æ‘˜è¦
â€¢ âš ï¸ å¼‚å¸¸æŠ¥å‘Šï¼šå‘ç°é—®é¢˜æ—¶çš„è¯¦ç»†åˆ†æ
â€¢ ğŸš¨ æ•…éšœæŠ¥å‘Šï¼šç³»ç»Ÿæ•…éšœåçš„å®Œæ•´è®°å½•
â€¢ ğŸ“Š ç»Ÿè®¡æŠ¥å‘Šï¼šé•¿æœŸè¶‹åŠ¿å’Œæ€§èƒ½åˆ†æ
```

### 9.2 è‡ªåŠ¨åŒ–æŠ¥å‘Šç”Ÿæˆè„šæœ¬


**ğŸ“ ç»¼åˆæ•…éšœæŠ¥å‘Šç”Ÿæˆå™¨**
```bash
#!/bin/bash
# ç£ç›˜æ•…éšœæŠ¥å‘Šè‡ªåŠ¨ç”Ÿæˆè„šæœ¬

REPORT_DIR="/var/reports/disk_health"
TEMPLATE_DIR="/etc/disk_monitor/templates"
DATE_STR=$(date '+%Y%m%d_%H%M%S')

# åˆ›å»ºæŠ¥å‘Šç›®å½•
mkdir -p $REPORT_DIR

# ç”Ÿæˆè¯¦ç»†æ•…éšœæŠ¥å‘Š
generate_failure_report() {
    local disk=$1
    local alert_level=$2
    local report_file="$REPORT_DIR/disk_failure_${DATE_STR}_$(basename $disk).html"
    
    # HTMLæŠ¥å‘Šæ¨¡æ¿
    cat > $report_file << EOF
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ç£ç›˜æ•…éšœæŠ¥å‘Š - $(basename $disk)</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { background: #f44336; color: white; padding: 15px; border-radius: 5px; }
        .section { margin: 20px 0; padding: 15px; border-left: 4px solid #2196F3; background: #f5f5f5; }
        .critical { border-left-color: #f44336; background: #ffebee; }
        .warning { border-left-color: #ff9800; background: #fff3e0; }
        .info { border-left-color: #4caf50; background: #e8f5e0; }
        table { border-collapse: collapse; width: 100%; margin: 10px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .status-critical { color: #f44336; font-weight: bold; }
        .status-warning { color: #ff9800; font-weight: bold; }
        .status-ok { color: #4caf50; font-weight: bold; }
        .chart-container { width: 100%; height: 300px; margin: 20px 0; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸš¨ ç£ç›˜æ•…éšœæŠ¥å‘Š</h1>
        <p>ç£ç›˜: $disk | å‘Šè­¦çº§åˆ«: $alert_level | ç”Ÿæˆæ—¶é—´: $(date)</p>
        <p>æœåŠ¡å™¨: $(hostname) | æ“ä½œç³»ç»Ÿ: $(cat /etc/os-release | grep PRETTY_NAME | cut -d'"' -f2)</p>
    </div>
EOF

    # åŸºæœ¬ä¿¡æ¯éƒ¨åˆ†
    echo '<div class="section critical">' >> $report_file
    echo '<h2>ğŸ“‹ åŸºæœ¬ä¿¡æ¯</h2>' >> $report_file
    echo '<table>' >> $report_file
    echo '<tr><th>é¡¹ç›®</th><th>å€¼</th><th>çŠ¶æ€</th></tr>' >> $report_file
    
    # è·å–ç£ç›˜åŸºæœ¬ä¿¡æ¯
    local model=$(smartctl -i $disk | grep "Device Model" | cut -d':' -f2 | xargs)
    local serial=$(smartctl -i $disk | grep "Serial Number" | cut -d':' -f2 | xargs)
    local capacity=$(smartctl -i $disk | grep "User Capacity" | cut -d':' -f2 | cut -d'[' -f1 | xargs)
    local health=$(smartctl -H $disk | grep "test result" | awk '{print $6}')
    
    echo "<tr><td>ç£ç›˜å‹å·</td><td>$model</td><td>-</td></tr>" >> $report_file
    echo "<tr><td>åºåˆ—å·</td><td>$serial</td><td>-</td></tr>" >> $report_file
    echo "<tr><td>å®¹é‡</td><td>$capacity</td><td>-</td></tr>" >> $report_file
    
    if [ "$health" = "PASSED" ]; then
        echo "<tr><td>SMARTå¥åº·çŠ¶æ€</td><td>$health</td><td class=\"status-ok\">æ­£å¸¸</td></tr>" >> $report_file
    else
        echo "<tr><td>SMARTå¥åº·çŠ¶æ€</td><td>$health</td><td class=\"status-critical\">å¼‚å¸¸</td></tr>" >> $report_file
    fi
    
    echo '</table>' >> $report_file
    echo '</div>' >> $report_file
    
    # SMARTå±æ€§è¯¦ç»†åˆ†æ
    echo '<div class="section warning">' >> $report_file
    echo '<h2>ğŸ” SMARTå±æ€§åˆ†æ</h2>' >> $report_file
    echo '<table>' >> $report_file
    echo '<tr><th>ID</th><th>å±æ€§å</th><th>å½“å‰å€¼</th><th>é˜ˆå€¼</th><th>åŸå§‹å€¼</th><th>çŠ¶æ€</th></tr>' >> $report_file
    
    # å…³é”®SMARTå±æ€§åˆ†æ
    smartctl -A $disk | grep "^  [0-9]" | while read line; do
        local id=$(echo "$line" | awk '{print $1}')
        local attr_name=$(echo "$line" | awk '{print $2}')
        local value=$(echo "$line" | awk '{print $4}')
        local thresh=$(echo "$line" | awk '{print $6}')
        local raw=$(echo "$line" | awk '{print $10}')
        local status="æ­£å¸¸"
        local status_class="status-ok"
        
        # æ£€æŸ¥å…³é”®å±æ€§
        case $id in
            5|196|197|198)
                if [ "$raw" -gt "0" ]; then
                    status="å¼‚å¸¸"
                    status_class="status-critical"
                fi
                ;;
            194)
                if [ "$raw" -gt "55" ]; then
                    status="è¿‡é«˜"
                    status_class="status-warning"
                fi
                ;;
        esac
        
        echo "<tr><td>$id</td><td>$attr_name</td><td>$value</td><td>$thresh</td><td>$raw</td><td class=\"$status_class\">$status</td></tr>" >> $report_file
    done
    
    echo '</table>' >> $report_file
    echo '</div>' >> $report_file
    
    # å†å²è¶‹åŠ¿åˆ†æ
    echo '<div class="section info">' >> $report_file
    echo '<h2>ğŸ“ˆ å†å²è¶‹åŠ¿åˆ†æ</h2>' >> $report_file
    
    # æ£€æŸ¥æ˜¯å¦æœ‰å†å²æ•°æ®
    local history_file="/var/lib/smart_trends/$(basename $disk)_history.csv"
    if [ -f "$history_file" ]; then
        echo '<p>æœ€è¿‘7å¤©é‡æ–°åˆ†é…æ‰‡åŒºå˜åŒ–ï¼š</p>' >> $report_file
        echo '<table>' >> $report_file
        echo '<tr><th>æ—¥æœŸ</th><th>é‡æ–°åˆ†é…æ‰‡åŒº</th><th>æ¸©åº¦</th><th>å¾…å¤„ç†æ‰‡åŒº</th></tr>' >> $report_file
        
        tail -7 $history_file | while IFS=',' read date attr5 temp attr197 others; do
            echo "<tr><td>$date</td><td>$attr5</td><td>${temp}Â°C</td><td>$attr197</td></tr>" >> $report_file
        done
        
        echo '</table>' >> $report_file
    else
        echo '<p>æš‚æ— å†å²è¶‹åŠ¿æ•°æ®</p>' >> $report_file
    fi
    
    echo '</div>' >> $report_file
    
    # å»ºè®®å¤„ç†æ–¹æ¡ˆ
    echo '<div class="section">' >> $report_file
    echo '<h2>ğŸ’¡ å»ºè®®å¤„ç†æ–¹æ¡ˆ</h2>' >> $report_file
    
    # æ ¹æ®é—®é¢˜ä¸¥é‡ç¨‹åº¦ç»™å‡ºå»ºè®®
    local reallocated=$(smartctl -A $disk | grep "^  5 " | awk '{print $10}')
    local pending=$(smartctl -A $disk | grep "^197 " | awk '{print $10}')
    
    echo '<ul>' >> $report_file
    
    if [ "$pending" -gt "0" ]; then
        echo '<li class="status-critical">âš ï¸ ç«‹å³æ‰§è¡Œæ•°æ®å¤‡ä»½ï¼Œå½“å‰å¾…å¤„ç†æ‰‡åŒºå¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±</li>' >> $report_file
        echo '<li class="status-critical">ğŸ”§ å»ºè®®ç«‹å³æ›´æ¢æ­¤ç¡¬ç›˜</li>' >> $report_file
    elif [ "$reallocated" -gt "5" ]; then
        echo '<li class="status-warning">ğŸ“… å»ºè®®åœ¨1-2å‘¨å†…å®‰æ’ç¡¬ç›˜æ›´æ¢</li>' >> $report_file
        echo '<li class="status-warning">ğŸ’¾ åŠ å¼ºæ•°æ®å¤‡ä»½é¢‘ç‡</li>' >> $report_file
    elif [ "$reallocated" -gt "0" ]; then
        echo '<li class="status-warning">ğŸ‘€ å¯†åˆ‡ç›‘æ§ï¼Œæ¯å¤©æ£€æŸ¥SMARTçŠ¶æ€</li>' >> $report_file
        echo '<li class="status-info">ğŸ“‹ å‡†å¤‡ç¡¬ç›˜æ›´æ¢è®¡åˆ’</li>' >> $report_file
    else
        echo '<li class="status-ok">âœ… å½“å‰çŠ¶æ€è‰¯å¥½ï¼Œç»§ç»­å®šæœŸç›‘æ§å³å¯</li>' >> $report_file
    fi
    
    echo '<li>ğŸ“Š å»ºè®®é›†æˆåˆ°ç›‘æ§ç³»ç»Ÿè¿›è¡Œè‡ªåŠ¨åŒ–ç›‘æ§</li>' >> $report_file
    echo '<li>ğŸ“§ é…ç½®å‘Šè­¦é€šçŸ¥ï¼ŒåŠæ—¶å‘ç°é—®é¢˜</li>' >> $report_file
    echo '</ul>' >> $report_file
    echo '</div>' >> $report_file
    
    # æŠ€æœ¯ç»†èŠ‚éƒ¨åˆ†
    echo '<div class="section">' >> $report_file
    echo '<h2>ğŸ”§ æŠ€æœ¯ç»†èŠ‚</h2>' >> $report_file
    echo '<h3>å®Œæ•´SMARTä¿¡æ¯:</h3>' >> $report_file
    echo '<pre style="background: #f5f5f5; padding: 10px; overflow-x: auto;">' >> $report_file
    smartctl -a $disk >> $report_file
    echo '</pre>' >> $report_file
    echo '</div>' >> $report_file
    
    # æŠ¥å‘Šç»“å°¾
    echo '<div class="section">' >> $report_file
    echo '<h2>ğŸ“ è”ç³»ä¿¡æ¯</h2>' >> $report_file
    echo '<p>å¦‚éœ€æŠ€æœ¯æ”¯æŒï¼Œè¯·è”ç³»ç³»ç»Ÿç®¡ç†å‘˜ï¼š</p>' >> $report_file
    echo '<ul>' >> $report_file
    echo '<li>é‚®ç®±: sysadmin@company.com</li>' >> $report_file
    echo '<li>ç”µè¯: 400-123-4567</li>' >> $report_file
    echo '<li>å·¥å•ç³»ç»Ÿ: https://helpdesk.company.com</li>' >> $report_file
    echo '</ul>' >> $report_file
    echo '<p><small>æŠ¥å‘Šç”Ÿæˆæ—¶é—´: $(date) | ç”Ÿæˆç³»ç»Ÿ: ç£ç›˜å¥åº·ç›‘æ§ç³»ç»Ÿ v1.0</small></p>' >> $report_file
    echo '</div>' >> $report_file
    
    echo '</body></html>' >> $report_file
    
    echo "è¯¦ç»†æŠ¥å‘Šå·²ç”Ÿæˆ: $report_file"
}

# ç”Ÿæˆå‘¨æŠ¥
generate_weekly_report() {
    local report_file="$REPORT_DIR/weekly_disk_health_$(date '+%Y%m%d').html"
    
    cat > $report_file << EOF
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ç£ç›˜å¥åº·å‘¨æŠ¥</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { background: #2196F3; color: white; padding: 15px; border-radius: 5px; }
        .summary { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0; }
        .stat-card { background: white; border: 1px solid #ddd; border-radius: 5px; padding: 15px; text-align: center; }
        .stat-number { font-size: 2em; font-weight: bold; color: #2196F3; }
        .section { margin: 20px 0; padding: 15px; background: #f9f9f9; border-radius: 5px; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ“Š ç£ç›˜å¥åº·å‘¨æŠ¥</h1>
        <p>ç»Ÿè®¡å‘¨æœŸ: $(date -d '7 days ago' '+%Y-%m-%d') è‡³ $(date '+%Y-%m-%d')</p>
        <p>æœåŠ¡å™¨: $(hostname)</p>
    </div>
    
    <div class="summary">
        <div class="stat-card">
            <div class="stat-number">$(ls /dev/sd* 2>/dev/null | wc -l)</div>
            <div>ç›‘æ§ç£ç›˜æ€»æ•°</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">0</div>
            <div>ä¸¥é‡å‘Šè­¦æ•°</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">0</div>
            <div>ä¸€èˆ¬å‘Šè­¦æ•°</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">100%</div>
            <div>ç³»ç»Ÿå¯ç”¨ç‡</div>
        </div>
    </div>
EOF
    
    # ç£ç›˜çŠ¶æ€æ‘˜è¦
    echo '<div class="section">' >> $report_file
    echo '<h2>ğŸ’½ ç£ç›˜çŠ¶æ€æ‘˜è¦</h2>' >> $report_file
    echo '<table>' >> $report_file
    echo '<tr><th>ç£ç›˜</th><th>å‹å·</th><th>å¥åº·çŠ¶æ€</th><th>æ¸©åº¦</th><th>é‡æ–°åˆ†é…æ‰‡åŒº</th><th>å»ºè®®</th></tr>' >> $report_file
    
    for disk in /dev/sd[a-z]; do
        if [ -b "$disk" ]; then
            local model=$(smartctl -i $disk 2>/dev/null | grep "Device Model" | cut -d':' -f2 | xargs)
            local health=$(smartctl -H $disk 2>/dev/null | grep "test result" | awk '{print $6}')
            local temp=$(smartctl -A $disk 2>/dev/null | grep "^194 " | awk '{print $10}')
            local reallocated=$(smartctl -A $disk 2>/dev/null | grep "^  5 " | awk '{print $10}')
            
            local recommendation="æ­£å¸¸ç›‘æ§"
            if [ "$reallocated" -gt "0" ]; then
                recommendation="åŠ å¼ºç›‘æ§"
            fi
            
            echo "<tr><td>$disk</td><td>$model</td><td>$health</td><td>${temp}Â°C</td><td>$reallocated</td><td>$recommendation</td></tr>" >> $report_file
        fi
    done
    
    echo '</table>' >> $report_file
    echo '</div>' >> $report_file
    
    echo '</body></html>' >> $report_file
    echo "å‘¨æŠ¥å·²ç”Ÿæˆ: $report_file"
}
```

### 9.3 æŠ¥å‘Šæ¨¡æ¿ç³»ç»Ÿ


**ğŸ“‹ æŠ¥å‘Šæ¨¡æ¿é…ç½®**
```bash
#!/bin/bash
# æŠ¥å‘Šæ¨¡æ¿ç®¡ç†è„šæœ¬

TEMPLATE_DIR="/etc/disk_monitor/templates"
mkdir -p $TEMPLATE_DIR

# åˆ›å»ºé‚®ä»¶æŠ¥å‘Šæ¨¡æ¿
create_email_template() {
    cat > $TEMPLATE_DIR/email_alert.template << 'EOF'
Subject: ğŸš¨ ç£ç›˜æ•…éšœå‘Šè­¦ - {{DISK}} ({{ALERT_LEVEL}})

æœåŠ¡å™¨ç£ç›˜å‘Šè­¦é€šçŸ¥
==================

åŸºæœ¬ä¿¡æ¯:
---------
â€¢ æœåŠ¡å™¨: {{HOSTNAME}}
â€¢ ç£ç›˜è®¾å¤‡: {{DISK}}
â€¢ å‘Šè­¦çº§åˆ«: {{ALERT_LEVEL}}
â€¢ å‘ç”Ÿæ—¶é—´: {{TIMESTAMP}}
â€¢ ç£ç›˜å‹å·: {{MODEL}}
â€¢ åºåˆ—å·: {{SERIAL}}

é—®é¢˜è¯¦æƒ…:
---------
{{PROBLEM_DESCRIPTION}}

SMARTå…³é”®æŒ‡æ ‡:
-------------
â€¢ SMARTå¥åº·çŠ¶æ€: {{SMART_HEALTH}}
â€¢ é‡æ–°åˆ†é…æ‰‡åŒº: {{REALLOCATED_SECTORS}}
â€¢ å½“å‰å¾…å¤„ç†æ‰‡åŒº: {{CURRENT_PENDING}}
â€¢ ä¸å¯çº æ­£é”™è¯¯: {{UNCORRECTABLE_ERRORS}}
â€¢ å½“å‰æ¸©åº¦: {{TEMPERATURE}}Â°C

å¤„ç†å»ºè®®:
---------
{{RECOMMENDATIONS}}

å†å²è¶‹åŠ¿:
---------
{{TREND_DATA}}

æŠ€æœ¯æ”¯æŒ:
---------
å¦‚éœ€å¸®åŠ©ï¼Œè¯·è”ç³»:
â€¢ é‚®ç®±: sysadmin@company.com  
â€¢ å·¥å•: https://helpdesk.company.com

---
æ­¤é‚®ä»¶ç”±ç£ç›˜ç›‘æ§ç³»ç»Ÿè‡ªåŠ¨å‘é€
EOF
}

# ä½¿ç”¨æ¨¡æ¿ç”ŸæˆæŠ¥å‘Š
generate_report_from_template() {
    local template_file=$1
    local output_file=$2
    local disk=$3
    local alert_level=$4
    
    # è·å–ç£ç›˜ä¿¡æ¯
    local hostname=$(hostname)
    local timestamp=$(date)
    local model=$(smartctl -i $disk | grep "Device Model" | cut -d':' -f2 | xargs)
    local serial=$(smartctl -i $disk | grep "Serial Number" | cut -d':' -f2 | xargs)
    local smart_health=$(smartctl -H $disk | grep "test result" | awk '{print $6}')
    local reallocated=$(smartctl -A $disk | grep "^  5 " | awk '{print $10}')
    local pending=$(smartctl -A $disk | grep "^197 " | awk '{print $10}')
    local uncorrectable=$(smartctl -A $disk | grep "^198 " | awk '{print $10}')
    local temperature=$(smartctl -A $disk | grep "^194 " | awk '{print $10}')
    
    # ç”Ÿæˆå»ºè®®
    local recommendations=""
    if [ "$pending" -gt "0" ]; then
        recommendations="âš ï¸ ç«‹å³å¤‡ä»½æ•°æ®å¹¶æ›´æ¢ç¡¬ç›˜"
    elif [ "$reallocated" -gt "5" ]; then
        recommendations="ğŸ“… å»ºè®®1-2å‘¨å†…æ›´æ¢ç¡¬ç›˜"
    elif [ "$reallocated" -gt "0" ]; then
        recommendations="ğŸ‘€ åŠ å¼ºç›‘æ§ï¼Œå‡†å¤‡æ›´æ¢è®¡åˆ’"
    else
        recommendations="âœ… ç»§ç»­å®šæœŸç›‘æ§"
    fi
    
    # æ›¿æ¢æ¨¡æ¿å˜é‡
    sed -e "s/{{HOSTNAME}}/$hostname/g" \
        -e "s/{{DISK}}/$disk/g" \
        -e "s/{{ALERT_LEVEL}}/$alert_level/g" \
        -e "s/{{TIMESTAMP}}/$timestamp/g" \
        -e "s/{{MODEL}}/$model/g" \
        -e "s/{{SERIAL}}/$serial/g" \
        -e "s/{{SMART_HEALTH}}/$smart_health/g" \
        -e "s/{{REALLOCATED_SECTORS}}/$reallocated/g" \
        -e "s/{{CURRENT_PENDING}}/$pending/g" \
        -e "s/{{UNCORRECTABLE_ERRORS}}/$uncorrectable/g" \
        -e "s/{{TEMPERATURE}}/$temperature/g" \
        -e "s/{{RECOMMENDATIONS}}/$recommendations/g" \
        $template_file > $output_file
}
```

### 9.4 æŠ¥å‘Šåˆ†å‘å’Œå­˜æ¡£


**ğŸ“¤ è‡ªåŠ¨åŒ–æŠ¥å‘Šåˆ†å‘**
```bash
#!/bin/bash
# æŠ¥å‘Šåˆ†å‘ç³»ç»Ÿ

REPORT_DIR="/var/reports/disk_health"
ARCHIVE_DIR="/var/archive/disk_reports"
FTP_SERVER="backup.company.com"
EMAIL_LIST="sysadmin@company.com,manager@company.com"

# åˆ›å»ºå­˜æ¡£ç›®å½•
mkdir -p $ARCHIVE_DIR

# åˆ†å‘æŠ¥å‘Š
distribute_reports() {
    local report_type=$1  # daily, weekly, incident
    local date_str=$(date '+%Y%m%d')
    
    case $report_type in
        "daily")
            local report_pattern="daily_disk_health_${date_str}*"
            local recipients="sysadmin@company.com"
            ;;
        "weekly")
            local report_pattern="weekly_disk_health_${date_str}*"
            local recipients="sysadmin@company.com,manager@company.com"
            ;;
        "incident")
            local report_pattern="disk_failure_*"
            local recipients="sysadmin@company.com,manager@company.com,oncall@company.com"
            ;;
    esac
    
    # æŸ¥æ‰¾åŒ¹é…çš„æŠ¥å‘Šæ–‡ä»¶
    for report_file in $REPORT_DIR/$report_pattern; do
        if [ -f "$report_file" ]; then
            # å‘é€é‚®ä»¶
            mail -s "ç£ç›˜ç›‘æ§æŠ¥å‘Š - $(basename $report_file)" \
                 -a "$report_file" \
                 $recipients < /dev/null
            
            # ä¸Šä¼ åˆ°FTPæœåŠ¡å™¨
            if command -v lftp &> /dev/null; then
                lftp -c "open $FTP_SERVER; put $report_file"
            fi
            
            # ç§»åŠ¨åˆ°å­˜æ¡£ç›®å½•
            mv "$report_file" "$ARCHIVE_DIR/"
            
            echo "æŠ¥å‘Šå·²åˆ†å‘: $(basename $report_file)"
        fi
    done
}

# æ¸…ç†æ—§æŠ¥å‘Š (ä¿ç•™30å¤©)
cleanup_old_reports() {
    find $ARCHIVE_DIR -name "*.html" -mtime +30 -delete
    find $ARCHIVE_DIR -name "*.pdf" -mtime +30 -delete
    echo "å·²æ¸…ç†30å¤©å‰çš„æ—§æŠ¥å‘Š"
}

# ä¸»ç¨‹åº
case $1 in
    "daily"|"weekly"|"incident")
        distribute_reports $1
        ;;
    "cleanup")
        cleanup_old_reports
        ;;
    *)
        echo "ç”¨æ³•: $0 {daily|weekly|incident|cleanup}"
        exit 1
        ;;
esac
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ é¢„è­¦ç³»ç»Ÿæœ¬è´¨ï¼šæå‰å‘ç°é—®é¢˜ï¼Œé¿å…æ•°æ®ä¸¢å¤±çš„é˜²æŠ¤ç³»ç»Ÿ
ğŸ”¸ SMARTç›‘æ§ï¼šç¡¬ç›˜è‡ªå¸¦çš„å¥åº·æŒ‡æ ‡ï¼Œæ˜¯é¢„è­¦çš„æ•°æ®åŸºç¡€
ğŸ”¸ é˜ˆå€¼é…ç½®ï¼šåˆç†çš„è­¦å‘Šçº¿ï¼Œå¹³è¡¡å‡†ç¡®æ€§å’Œå®ç”¨æ€§
ğŸ”¸ å‘Šè­¦æœºåˆ¶ï¼šå¤šçº§å‘Šè­¦ä½“ç³»ï¼Œç¡®ä¿é‡è¦é—®é¢˜åŠæ—¶é€šçŸ¥
ğŸ”¸ è¶‹åŠ¿åˆ†æï¼šé€šè¿‡å†å²æ•°æ®é¢„æµ‹æœªæ¥å¯èƒ½çš„æ•…éšœ
ğŸ”¸ ç³»ç»Ÿé›†æˆï¼šä¸ç°æœ‰ç›‘æ§å¹³å°æ•´åˆï¼Œæä¾›ç»Ÿä¸€ç®¡ç†
ğŸ”¸ æ•…éšœæŠ¥å‘Šï¼šè¯¦ç»†è®°å½•é—®é¢˜å’Œå¤„ç†è¿‡ç¨‹ï¼Œç§¯ç´¯ç»éªŒ
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ é¢„è­¦ç³»ç»Ÿçš„æ ¸å¿ƒä»·å€¼**
```
é¢„é˜²æ€§ç»´æŠ¤çš„é‡è¦æ€§ï¼š
â€¢ æ•°æ®æ— ä»·ï¼šä¸¢å¤±æ•°æ®çš„æŸå¤±è¿œè¶…ç¡¬ç›˜æˆæœ¬
â€¢ æå‰é¢„è­¦ï¼š2-6å‘¨çš„é¢„è­¦æ—¶é—´è¶³å¤Ÿåˆ¶å®šåº”å¯¹ç­–ç•¥
â€¢ æˆæœ¬èŠ‚çº¦ï¼šè®¡åˆ’æ€§æ›´æ¢æ¯”ç´§æ€¥æ›´æ¢æˆæœ¬ä½60%
â€¢ ä¸šåŠ¡è¿ç»­æ€§ï¼šé¿å…å› çªå‘æ•…éšœå¯¼è‡´çš„ä¸šåŠ¡ä¸­æ–­

å®é™…æ¡ˆä¾‹å¯¹æ¯”ï¼š
ä¼ ç»Ÿæ–¹å¼ï¼šç¡¬ç›˜çªç„¶æ•…éšœ â†’ æ•°æ®ä¸¢å¤± â†’ ä¸šåŠ¡åœæœº â†’ ç´§æ€¥æ¢å¤
é¢„è­¦æ–¹å¼ï¼šç›‘æµ‹åˆ°å¼‚å¸¸ â†’ è®¡åˆ’å¤‡ä»½ â†’ æœ‰åºæ›´æ¢ â†’ é›¶åœæœºæ—¶é—´
```

**ğŸ”¹ SMARTç›‘æ§çš„å…³é”®æŒ‡æ ‡**
```
ç»å¯¹ä¸èƒ½å¿½è§†çš„æŒ‡æ ‡ï¼š
ğŸš¨ ID 5 (é‡æ–°åˆ†é…æ‰‡åŒº) > 0     â†’ ç¡¬ç›˜ç‰©ç†æŸåå¼€å§‹
ğŸš¨ ID 197 (å½“å‰å¾…å¤„ç†æ‰‡åŒº) > 0 â†’ æœ‰æ•°æ®æ— æ³•è¯»å–
ğŸš¨ ID 198 (ä¸å¯çº æ­£é”™è¯¯) > 0   â†’ æ•°æ®å·²ç»æŸå

è¿™ä¸‰ä¸ªæŒ‡æ ‡ä»»ä½•ä¸€ä¸ªå¼‚å¸¸ï¼Œéƒ½è¦ç«‹å³å¤‡ä»½æ•°æ®ï¼

ç›‘æ§é¢‘ç‡å»ºè®®ï¼š
â€¢ å…³é”®ä¸šåŠ¡æœåŠ¡å™¨ï¼šæ¯å°æ—¶æ£€æŸ¥
â€¢ ä¸€èˆ¬æœåŠ¡å™¨ï¼šæ¯4å°æ—¶æ£€æŸ¥
â€¢ ä¸ªäººå·¥ä½œç«™ï¼šæ¯å¤©æ£€æŸ¥ä¸€æ¬¡
```

**ğŸ”¹ å‘Šè­¦ç³»ç»Ÿè®¾è®¡åŸåˆ™**
```
é¿å…"ç‹¼æ¥äº†"æ•ˆåº”ï¼š
â€¢ åˆç†è®¾ç½®é˜ˆå€¼ï¼Œå‡å°‘è¯¯æŠ¥
â€¢ åˆ†çº§å‘Šè­¦ä½“ç³»ï¼Œé‡è¦é—®é¢˜ä¼˜å…ˆ
â€¢ å‘Šè­¦å»é‡æœºåˆ¶ï¼Œé¿å…é‡å¤é€šçŸ¥
â€¢ é™é»˜æœŸè®¾ç½®ï¼Œé˜²æ­¢å‘Šè­¦è½°ç‚¸

å‘Šè­¦å‡çº§ç­–ç•¥ï¼š
INFO â†’ WARN â†’ ERROR â†’ FATAL
æ—¥å¿—   é‚®ä»¶   çŸ­ä¿¡    ç”µè¯
```

### 10.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ ä¸šåŠ¡åœºæ™¯åº”ç”¨**
- **ä¼ä¸šæ•°æ®ä¸­å¿ƒ**ï¼šä¿æŠ¤å…³é”®ä¸šåŠ¡æ•°æ®ï¼Œç¡®ä¿æœåŠ¡è¿ç»­æ€§
- **WebæœåŠ¡å™¨**ï¼šé¿å…ç½‘ç«™å› ç£ç›˜æ•…éšœå¯¼è‡´çš„æœåŠ¡ä¸­æ–­
- **æ•°æ®åº“æœåŠ¡å™¨**ï¼šé¢„é˜²æ•°æ®åº“æŸåï¼Œä¿è¯æ•°æ®å®Œæ•´æ€§
- **ä¸ªäººå·¥ä½œç«™**ï¼šä¿æŠ¤é‡è¦æ–‡ä»¶ï¼Œé¿å…çªå‘æ•°æ®ä¸¢å¤±

**ğŸ”§ å®æ–½å»ºè®®**
```
éƒ¨ç½²ç­–ç•¥ï¼š
1ï¸âƒ£ ä»å…³é”®æœåŠ¡å™¨å¼€å§‹éƒ¨ç½²
2ï¸âƒ£ å»ºç«‹åŸºç¡€ç›‘æ§å’Œå‘Šè­¦
3ï¸âƒ£ é€æ­¥å®Œå–„é˜ˆå€¼é…ç½®
4ï¸âƒ£ é›†æˆç°æœ‰ç›‘æ§ç³»ç»Ÿ
5ï¸âƒ£ å»ºç«‹æ ‡å‡†åŒ–æŠ¥å‘Šæµç¨‹

æˆåŠŸæ ‡å‡†ï¼š
â€¢ 95%ä»¥ä¸Šçš„ç¡¬ç›˜æ•…éšœèƒ½æå‰å‘ç°
â€¢ å‘Šè­¦å“åº”æ—¶é—´åœ¨5åˆ†é’Ÿå†…
â€¢ è¯¯æŠ¥ç‡æ§åˆ¶åœ¨5%ä»¥ä¸‹
â€¢ æ•°æ®ä¸¢å¤±äº‹ä»¶é™ä¸ºé›¶
```

**ğŸ’° æŠ•å…¥äº§å‡ºåˆ†æ**
```
æŠ•å…¥æˆæœ¬ï¼š
â€¢ åˆæœŸéƒ¨ç½²ï¼š1-2å‘¨å·¥ä½œé‡
â€¢ ç»´æŠ¤æˆæœ¬ï¼šæ¯æœˆ2-4å°æ—¶
â€¢ ç¡¬ä»¶æˆæœ¬ï¼šæ— é¢å¤–æˆæœ¬

äº§å‡ºæ”¶ç›Šï¼š
â€¢ é¿å…æ•°æ®ä¸¢å¤±ï¼šèŠ‚çº¦æ•°ä¸‡åˆ°æ•°åä¸‡æŸå¤±
â€¢ æé«˜å¯ç”¨æ€§ï¼šå‡å°‘éè®¡åˆ’åœæœºæ—¶é—´
â€¢ é™ä½è¿ç»´æˆæœ¬ï¼šå˜è¢«åŠ¨ä¸ºä¸»åŠ¨
â€¢ æå‡ç”¨æˆ·ä½“éªŒï¼šé¿å…æœåŠ¡ä¸­æ–­
```

### 10.4 å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ


**â“ å¸¸è§é—®é¢˜**
```
é—®é¢˜1ï¼šå‘Šè­¦å¤ªé¢‘ç¹ï¼Œäº§ç”Ÿå‘Šè­¦ç–²åŠ³
è§£å†³ï¼šè°ƒæ•´é˜ˆå€¼ï¼Œå¢åŠ å‘Šè­¦å»é‡å’Œé™é»˜æœºåˆ¶

é—®é¢˜2ï¼šå†å²æ•°æ®å ç”¨ç©ºé—´è¿‡å¤§
è§£å†³ï¼šè®¾ç½®æ•°æ®ä¿ç•™æœŸé™ï¼Œå®šæœŸæ¸…ç†æ—§æ•°æ®

é—®é¢˜3ï¼šç›‘æ§ç³»ç»Ÿæœ¬èº«çš„å¯é æ€§
è§£å†³ï¼šç›‘æ§ç³»ç»Ÿä¹Ÿéœ€è¦ç›‘æ§ï¼Œè®¾ç½®å¿ƒè·³æ£€æŸ¥

é—®é¢˜4ï¼šä¸åŒå“ç‰Œç¡¬ç›˜çš„SMARTå®ç°å·®å¼‚
è§£å†³ï¼šæ ¹æ®ç¡¬ç›˜å“ç‰Œè°ƒæ•´é˜ˆå€¼é…ç½®

é—®é¢˜5ï¼šSSDçš„ç›‘æ§æŒ‡æ ‡ä¸æœºæ¢°ç¡¬ç›˜ä¸åŒ
è§£å†³ï¼šä¸ºSSDåˆ¶å®šä¸“é—¨çš„ç›‘æ§ç­–ç•¥
```

**ğŸ› ï¸ æœ€ä½³å®è·µ**
```
ç›‘æ§å®è·µï¼š
â€¢ å»ºç«‹åŸºçº¿ï¼šè®°å½•æ­£å¸¸çŠ¶æ€ä¸‹çš„å„é¡¹æŒ‡æ ‡
â€¢ å®šæœŸæ ¡å‡†ï¼šæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´é˜ˆå€¼
â€¢ æ–‡æ¡£è®°å½•ï¼šè®°å½•æ‰€æœ‰é…ç½®å˜æ›´å’Œæ•…éšœå¤„ç†
â€¢ å®šæœŸæ¼”ç»ƒï¼šæ¨¡æ‹Ÿæ•…éšœæƒ…å†µï¼Œæµ‹è¯•å‘Šè­¦æµç¨‹

è¿ç»´å®è·µï¼š
â€¢ é¢„é˜²ä¸ºä¸»ï¼šé‡ç‚¹å…³æ³¨é¢„è­¦ä¿¡å·
â€¢ å¿«é€Ÿå“åº”ï¼šå»ºç«‹æ ‡å‡†åŒ–å¤„ç†æµç¨‹
â€¢ æŒç»­æ”¹è¿›ï¼šæ ¹æ®æ•…éšœç»éªŒä¼˜åŒ–ç³»ç»Ÿ
â€¢ çŸ¥è¯†å…±äº«ï¼šå»ºç«‹å›¢é˜ŸçŸ¥è¯†åº“
```

### 10.5 å‘å±•è¶‹åŠ¿


```
æŠ€æœ¯å‘å±•æ–¹å‘ï¼š
ğŸ”® AIæ™ºèƒ½é¢„æµ‹ï¼šåˆ©ç”¨æœºå™¨å­¦ä¹ æé«˜é¢„æµ‹å‡†ç¡®æ€§
ğŸ”® äº‘ç«¯ç›‘æ§ï¼šåŸºäºäº‘å¹³å°çš„é›†ä¸­ç›‘æ§æœåŠ¡
ğŸ”® ç‰©è”ç½‘é›†æˆï¼šä¸ç¡¬ä»¶ä¼ æ„Ÿå™¨æ·±åº¦é›†æˆ
ğŸ”® è‡ªåŠ¨åŒ–è¿ç»´ï¼šè‡ªåŠ¨åŒ–çš„æ•…éšœå¤„ç†å’Œæ¢å¤

æ ‡å‡†åŒ–è¶‹åŠ¿ï¼š
â€¢ ç»Ÿä¸€çš„ç›‘æ§APIæ¥å£
â€¢ æ ‡å‡†åŒ–çš„å‘Šè­¦åè®®
â€¢ è·¨å¹³å°çš„ç›‘æ§ä»£ç†
â€¢ å¼€æºç›‘æ§è§£å†³æ–¹æ¡ˆçš„å®Œå–„
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- é¢„è­¦ç³»ç»Ÿä¿å¹³å®‰ï¼ŒSMARTç›‘æ§æ˜¯å…³é”®
- é‡è¦æŒ‡æ ‡è¦ç‰¢è®°ï¼Œäº”ä¸€ä¹ä¸ƒä¸€ä¹å…«
- é˜ˆå€¼è®¾ç½®è¦åˆç†ï¼Œå‘Šè­¦åˆ†çº§ä¸ç–²åŠ³  
- è¶‹åŠ¿åˆ†æçœ‹æœªæ¥ï¼ŒåŠæ—¶å¤„ç†ä¿æ•°æ®
- ç³»ç»Ÿé›†æˆç»Ÿä¸€ç®¡ï¼ŒæŠ¥å‘Šè®°å½•ç§¯ç»éªŒ

**æœ€ç»ˆç›®æ ‡**ï¼šè®©ç£ç›˜æ•…éšœä»"çªå‘äº‹ä»¶"å˜æˆ"è®¡åˆ’ç»´æŠ¤"ï¼Œå®ç°ä»è¢«åŠ¨åº”å¯¹åˆ°ä¸»åŠ¨é¢„é˜²çš„è½¬å˜ã€‚