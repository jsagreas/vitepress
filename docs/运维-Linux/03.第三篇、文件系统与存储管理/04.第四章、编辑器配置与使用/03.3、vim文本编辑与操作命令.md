---
title: 3、vim文本编辑与操作命令
---
## 📚 目录

1. [删除操作详解](#1-删除操作详解)
2. [复制粘贴系统](#2-复制粘贴系统)
3. [修改操作命令](#3-修改操作命令)
4. [撤销与重做机制](#4-撤销与重做机制)
5. [查找与替换功能](#5-查找与替换功能)
6. [大小写转换操作](#6-大小写转换操作)
7. [排序与格式化](#7-排序与格式化)
8. [批量操作技巧](#8-批量操作技巧)
9. [核心要点总结](#9-核心要点总结)

---

## 1. 🗑️ 删除操作详解


### 1.1 基础删除命令


**🔸 字符级删除**
```bash
# x命令：删除光标所在字符（相当于Del键）
x       # 删除当前字符
3x      # 删除3个字符

# X命令：删除光标前面的字符（相当于Backspace键）
X       # 删除光标前一个字符
2X      # 删除光标前2个字符
```

> 💡 **理解要点**：x和X就像键盘上的Del和Backspace，只是在vim中用字母表示

**🔸 行级删除**
```bash
# dd命令：删除整行
dd      # 删除当前行
3dd     # 删除3行（从当前行开始）
5dd     # 删除5行

# D命令：删除到行尾
D       # 删除从光标到行尾的所有内容
```

### 1.2 精确删除操作


**删除操作的逻辑**：`删除命令 + 移动范围 = 精确删除`

```bash
# 单词删除
dw      # 删除一个单词（delete word）
db      # 删除到单词开头（delete back）
diw     # 删除整个单词（不包括空格）
daw     # 删除整个单词（包括空格）

# 位置删除  
d$      # 删除到行尾（$ = 行尾）
d0      # 删除到行首（0 = 行首）
dG      # 删除到文件末尾
d1G     # 删除到文件开头
```

**实际使用示例**：
```
原文本：Hello world, this is a test line.
光标位置：      ↑

执行 dw 后：Hello , this is a test line.
执行 d$ 后：Hello world
执行 dd 后：（整行被删除）
```

### 1.3 删除操作记忆技巧


```
🎯 记忆口诀：
x - 删除字符像叉掉
d - delete删除要记牢
w - word单词一起删
$ - 美元符号到行尾
0 - 零代表行开头
```

---

## 2. 📋 复制粘贴系统


### 2.1 基础复制操作


**🔸 行复制**
```bash
# yy命令：复制当前行（yank yankl）
yy      # 复制当前行
3yy     # 复制3行
Y       # 等同于yy，复制整行
```

**🔸 选择性复制**
```bash
# 单词复制
yw      # 复制一个单词
yiw     # 复制整个单词（内部）
yaw     # 复制整个单词（包括空格）

# 位置复制
y$      # 复制到行尾  
y0      # 复制到行首
yG      # 复制到文件末尾
```

### 2.2 粘贴操作详解


**🔸 粘贴位置控制**
```bash
# p命令：在光标后粘贴
p       # 粘贴到光标后面
3p      # 粘贴3次

# P命令：在光标前粘贴  
P       # 粘贴到光标前面
2P      # 粘贴2次到前面
```

**粘贴位置示例**：
```
原文本：Hello|world    # |表示光标位置
复制内容：" vim"

执行 p 后：Hello vim|world
执行 P 后：Hello| vimworld  
```

### 2.3 寄存器系统详解


**什么是寄存器？**
> 💡 **通俗解释**：寄存器就像是vim的"剪贴板"，可以有很多个，用字母和数字来区分

**🔸 寄存器类型**
```bash
# 命名寄存器（a-z）
"ayy    # 将当前行复制到寄存器a
"ap     # 从寄存器a粘贴
"byiw   # 将单词复制到寄存器b

# 数字寄存器（0-9）
"0      # 最近一次yank的内容
"1      # 最近一次delete的内容（自动保存）
"2      # 倒数第二次delete的内容
```

**🔸 实用寄存器技巧**
```bash
# 查看所有寄存器内容
:registers
:reg

# 常用寄存器
""      # 默认寄存器
"+      # 系统剪贴板（可与其他程序互通）
"*      # 鼠标选择缓冲区
```

**寄存器使用场景**：
```
场景：需要在多个位置粘贴不同内容
1. "ayy  复制第一行到寄存器a
2. "byy  复制第二行到寄存器b  
3. "ap   在需要的地方粘贴a的内容
4. "bp   在需要的地方粘贴b的内容
```

---

## 3. ✏️ 修改操作命令


### 3.1 c系列命令（修改）


**修改操作的本质**：`删除 + 进入插入模式`

```bash
# 基础修改命令
cc      # 修改整行（删除整行并进入插入模式）
C       # 修改到行尾
cw      # 修改一个单词
ciw     # 修改整个单词（内部）
caw     # 修改整个单词（包括空格）

# 位置修改
c$      # 修改到行尾（等同于C）
c0      # 修改到行首
```

**修改操作示例**：
```
原文本：Hello world
光标在：   ↑

执行 cw：Hello |___     # 删除"world"并进入插入模式
执行 cc：|___           # 删除整行并进入插入模式
```

### 3.2 替换命令


**🔸 字符替换**
```bash
# r命令：替换单个字符（不进入插入模式）
r       # 替换当前字符，然后等待输入新字符
3r      # 替换3个字符为同一个字符

# R命令：替换模式（覆盖输入）
R       # 进入替换模式，输入会覆盖原字符
```

**🔸 s系列命令**
```bash
# s命令：替换字符并进入插入模式
s       # 删除当前字符并进入插入模式
3s      # 删除3个字符并进入插入模式

# S命令：替换整行
S       # 删除整行并进入插入模式（等同于cc）
```

### 3.3 修改命令对比表


| 命令 | **作用** | **是否进入插入模式** | **使用场景** |
|------|----------|---------------------|-------------|
| `r` | `替换单个字符` | `❌ 否` | `快速修正单个字符` |
| `R` | `覆盖输入模式` | `✅ 是` | `覆盖一段文字` |
| `s` | `删除字符+插入` | `✅ 是` | `修改少量字符` |
| `S` | `删除整行+插入` | `✅ 是` | `重写整行` |
| `c+动作` | `删除范围+插入` | `✅ 是` | `精确修改范围` |

---

## 4. ↩️ 撤销与重做机制


### 4.1 基础撤销操作


**🔸 撤销命令**
```bash
# u命令：撤销上一次操作
u       # 撤销一次操作
3u      # 撤销3次操作
U       # 撤销当前行的所有修改
```

**🔸 重做命令**
```bash
# Ctrl+r：重做被撤销的操作
Ctrl+r  # 重做一次
3Ctrl+r # 重做3次
```

> 💡 **理解要点**：u像是"返回"，Ctrl+r像是"前进"，就像浏览器的后退和前进按钮

### 4.2 时间旅行功能


**🔸 基于时间的撤销**
```bash
# earlier命令：回到更早的状态
:earlier 5m     # 回到5分钟前
:earlier 10s    # 回到10秒前  
:earlier 3f     # 撤销3个文件修改

# later命令：回到更晚的状态
:later 2m       # 前进到2分钟后
:later 5s       # 前进5秒
:later 1f       # 重做1个文件修改
```

**时间单位说明**：
```
s = 秒 (seconds)
m = 分 (minutes) 
h = 小时 (hours)
d = 天 (days)
f = 文件修改次数 (file changes)
```

### 4.3 撤销历史查看


```bash
# 查看撤销树
:undolist       # 显示撤销历史
:earlier 1f     # 按文件修改次数撤销
```

**撤销使用技巧**：
```
📌 实用场景：
1. 误删内容：立即按 u 恢复
2. 修改过度：用 :earlier 5m 回到5分钟前
3. 想要重新修改：用 Ctrl+r 恢复刚才撤销的内容
4. 大量修改后想看原样：U 撤销当前行所有修改
```

---

## 5. 🔍 查找与替换功能


### 5.1 基础搜索操作


**🔸 正向搜索**
```bash
/关键词     # 向下搜索
/vim       # 搜索"vim"
/^Hello    # 搜索行首的"Hello"
/world$    # 搜索行尾的"world"
```

**🔸 反向搜索**
```bash
?关键词     # 向上搜索
?error     # 向上搜索"error"
```

**🔸 搜索导航**
```bash
n          # 跳到下一个匹配项（Next）
N          # 跳到上一个匹配项
*          # 搜索光标下的单词（向下）
#          # 搜索光标下的单词（向上）
```

### 5.2 搜索选项设置


```bash
# 搜索高亮
:set hlsearch      # 高亮显示搜索结果
:nohlsearch       # 取消当前高亮
:set nohlsearch   # 关闭搜索高亮

# 增量搜索
:set incsearch    # 输入时实时搜索
:set ignorecase   # 忽略大小写
:set smartcase    # 智能大小写（有大写则精确匹配）
```

### 5.3 替换命令详解


**🔸 基础替换语法**
```bash
# :s命令语法：:s/查找内容/替换内容/标志
:s/old/new/       # 替换当前行第一个匹配
:s/old/new/g      # 替换当前行所有匹配
:s/old/new/gc     # 替换时逐一确认
```

**🔸 范围替换**
```bash
# 全文替换
:%s/old/new/g     # 替换整个文件
:%s/old/new/gc    # 替换整个文件（确认模式）

# 指定行范围替换
:1,10s/old/new/g  # 替换1-10行
:.,5s/old/new/g   # 从当前行到第5行
:'<,'>s/old/new/g # 替换选中区域
```

### 5.4 高级替换技巧


**🔸 替换标志说明**
```bash
g    # global - 替换行内所有匹配
c    # confirm - 逐一确认
i    # ignore case - 忽略大小写
I    # 不忽略大小写
n    # 只报告匹配数量，不执行替换
```

**🔸 特殊替换字符**
```bash
# 使用正则表达式
:%s/\<word\>/新词/g    # 精确匹配整个单词
:%s/^/前缀/g           # 在每行开头添加前缀
:%s/$/后缀/g           # 在每行末尾添加后缀
:%s/\s\+$//g          # 删除行尾空格
```

**替换实用示例**：
```
任务：将所有的"color"替换为"colour"
命令：:%s/color/colour/g

任务：在每行前添加行号
命令：:%s/^/\=line('.').': '/g

任务：删除空行
命令：:%s/^$\n//g
```

---

## 6. 🔤 大小写转换操作


### 6.1 字符大小写转换


**🔸 ~命令：反转大小写**
```bash
~       # 反转当前字符大小写并移动光标
3~      # 反转3个字符的大小写
g~~     # 反转整行大小写
```

**转换示例**：
```
原文本：Hello World
光标在：↑

执行 ~：hELLO World  # H变h，继续操作可转换更多
执行g~~：hELLO wORLD  # 整行大小写反转
```

### 6.2 区域大小写转换


**🔸 gu/gU命令组合**
```bash
# gu：转为小写（go uppercase）
guw     # 将单词转为小写
gu$     # 将到行尾转为小写
gU      # 整行转为小写

# gU：转为大写（go uppercase）
gUw     # 将单词转为大写
gU$     # 将到行尾转为大写
gUgU    # 整行转为大写（可简写为gUU）
```

### 6.3 可视模式下的转换


```bash
# 1. 先进入可视模式选择文本
v       # 字符选择模式
V       # 行选择模式
Ctrl+v  # 块选择模式

# 2. 选择完成后使用转换命令
~       # 反转选中内容大小写
u       # 转为小写
U       # 转为大写
```

**实际使用场景**：
```
📝 常见应用：
1. 修正输入错误的大小写
2. 统一变量命名风格
3. 处理文档格式要求
4. 转换常量定义
```

---

## 7. 📊 排序与格式化


### 7.1 排序功能


**🔸 基础排序**
```bash
# :sort命令
:sort           # 按字母顺序排序整个文件
:1,10sort       # 排序1-10行
:'<,'>sort      # 排序选中区域
```

**🔸 排序选项**
```bash
:sort n         # 按数字排序
:sort!          # 反向排序
:sort u         # 排序并去重（unique）
:sort n u       # 数字排序并去重
```

**排序示例**：
```bash
# 原始内容
apple
banana
10
2
zebra

# :sort 结果（字母排序）
10
2
apple
banana
zebra

# :sort n 结果（数字排序）  
2
10
apple
banana
zebra
```

### 7.2 格式化操作


**🔸 段落格式化**
```bash
gq          # 格式化选中段落
gqap        # 格式化当前段落
gq}         # 格式化到段落结尾
```

**🔸 自动缩进**
```bash
=           # 自动缩进选中行
==          # 自动缩进当前行
=G          # 从当前行到文件末尾自动缩进
gg=G        # 整个文件自动缩进
```

### 7.3 格式化设置


```bash
# 设置文本宽度
:set textwidth=80    # 设置行宽80字符
:set tw=80          # 简写形式

# 自动换行设置
:set wrap           # 显示时自动换行
:set nowrap         # 不自动换行

# 缩进设置
:set autoindent     # 自动缩进
:set smartindent    # 智能缩进
:set tabstop=4      # Tab键宽度
:set shiftwidth=4   # 缩进宽度
```

---

## 8. 🎯 批量操作技巧


### 8.1 宏录制与执行


**什么是宏？**
> 💡 **通俗解释**：宏就像是"录制"你的操作步骤，然后可以"重播"这些步骤，实现批量处理

**🔸 宏的基础操作**
```bash
# 录制宏
qa          # 开始录制到寄存器a
# ...执行你想重复的操作...
q           # 停止录制

# 执行宏
@a          # 执行寄存器a中的宏
5@a         # 执行5次宏
$$          # 重复执行上次的宏
```

**宏录制实例**：
```bash
任务：为每行开头添加"- "，制作无序列表

步骤：
1. qa        # 开始录制到寄存器a
2. I- <Esc>  # 行首插入"- "
3. j         # 移动到下一行
4. q         # 停止录制
5. 9@a       # 对后续9行执行相同操作
```

### 8.2 可视模式批量操作


**🔸 块选择模式**
```bash
Ctrl+v      # 进入块选择模式
# 选择多行多列
I           # 在选中块前插入
A           # 在选中块后插入
c           # 修改选中块
```

**块选择应用示例**：
```bash
原始文本：
function1()
function2()
function3()

操作步骤：
1. Ctrl+v          # 进入块选择
2. 选择"function"列
3. c               # 修改选中内容
4. 输入"method"     # 替换为新内容
```

### 8.3 :normal命令批量执行


**🔸 批量执行普通模式命令**
```bash
# 语法：:[范围]normal 命令
:normal A;          # 在当前行末尾加分号
:1,5normal A;       # 在1-5行末尾加分号  
:%normal I#         # 在所有行开头加#注释
:'<,'>normal .      # 在选中行重复上次操作
```

**:normal实用场景**：
```bash
# 批量注释
:%normal I// 

# 批量去除注释
:%normal 3x

# 批量缩进
:%normal >>

# 批量在行尾加内容
:%normal A,
```

### 8.4 批量操作组合技巧


```bash
# 宏 + 查找替换组合
1. 录制一个处理单行的宏
2. 用查找命令定位到需要处理的行
3. 执行宏进行处理
4. 用n跳到下个位置，$$重复宏

# 可视模式 + 宏组合
1. V选择多行
2. ':'<,'>normal @a   # 对选中行执行宏a
```

**高效批量操作策略**：
```
🎯 选择合适的方法：
- 简单重复 → 宏录制
- 规律替换 → :s命令
- 块状编辑 → 可视块模式
- 条件批量 → :normal命令
```

---

## 9. 📋 核心要点总结


### 9.1 必须掌握的核心命令


```
🔸 删除操作：x删字符，dd删行，dw删词，d$删到行尾
🔸 复制粘贴：yy复制行，yw复制词，p后粘贴，P前粘贴
🔸 修改替换：cc修改行，cw修改词，r替换字符，R替换模式
🔸 撤销重做：u撤销，Ctrl+r重做，:earlier时间撤销
🔸 查找替换：/搜索，n下一个，:s替换，:%s全局替换
🔸 大小写：~反转，gu转小写，gU转大写
🔸 批量操作：qa录制宏，@a执行宏，:normal批量执行
```

### 9.2 关键记忆技巧


**🔹 命令逻辑理解**
```
动作命令 = 操作符 + 动作范围
- d + w = 删除一个单词
- c + $ = 修改到行尾  
- y + y = 复制当前行

这个逻辑适用于大部分vim操作
```

**🔹 寄存器系统**
```
"寄存器名 + 命令 = 指定寄存器操作
- "ayy = 复制到寄存器a
- "ap = 从寄存器a粘贴
- "+ = 系统剪贴板寄存器
```

**🔹 替换命令结构**
```
:范围s/查找/替换/标志
- :s = 当前行
- :%s = 全文  
- :1,10s = 1-10行
- /g = 全部替换
- /c = 确认替换
```

### 9.3 实际应用指导


**📝 日常编辑工作流**
```bash
1. 快速定位：/搜索关键词，*搜索光标词
2. 精确选择：可视模式选择，文本对象选择
3. 高效修改：c命令修改，r命令替换
4. 批量处理：宏录制，:normal命令
5. 撤销恢复：u撤销，:earlier时间恢复
```

**🛠️ 不同场景的最佳实践**
```
代码编辑：
- 使用=进行自动缩进
- 用ciw快速修改变量名
- 用*搜索相同变量

文档处理：
- 用gq格式化段落
- 用:sort排序列表
- 用宏批量格式化

数据处理：
- 用块选择模式对齐数据
- 用:s命令批量替换格式
- 用:sort去重排序
```

### 9.4 进阶学习路径


**🎯 从基础到熟练**
```
第一阶段：熟练基本命令（x,dd,yy,p,u）
第二阶段：掌握组合逻辑（dw,cw,y$等）
第三阶段：学会寄存器和宏录制
第四阶段：精通查找替换和批量操作
```

**💡 提升效率的关键**
```
1. 理解vim的"语法"：操作符+动作
2. 善用文本对象：iw,aw,ip,ap等
3. 掌握重复操作：.命令重复，宏批量
4. 熟练寄存器：多剪贴板并行工作
5. 组合使用：多种方法解决复杂任务
```

**核心记忆口诀**：
```
删除复制粘贴先学会，
撤销重做不用怕，
查找替换效率高，
宏录制批量处理好。
vim操作有逻辑，
熟练使用效率高！
```