---
title: 11ã€ç³»ç»Ÿçº§æ•…éšœè½¬å‚¨
---
## ğŸ“š ç›®å½•

1. [æ ¸å¿ƒè½¬å‚¨åŸºç¡€æ¦‚å¿µ](#1-æ ¸å¿ƒè½¬å‚¨åŸºç¡€æ¦‚å¿µ)
2. [coredumpctlå·¥å…·è¯¦è§£](#2-coredumpctlå·¥å…·è¯¦è§£)
3. [kernel panicä¸kdumpé…ç½®](#3-kernel-panicä¸kdumpé…ç½®)
4. [å†…æ ¸è½¬å‚¨æ–‡ä»¶åˆ†æ](#4-å†…æ ¸è½¬å‚¨æ–‡ä»¶åˆ†æ)
5. [crashå·¥å…·æ·±åº¦åˆ†æ](#5-crashå·¥å…·æ·±åº¦åˆ†æ)
6. [ç³»ç»ŸhangæœºçŠ¶æ€è¯Šæ–­](#6-ç³»ç»ŸhangæœºçŠ¶æ€è¯Šæ–­)
7. [å†…æ ¸æ¨¡å—å´©æºƒè°ƒè¯•](#7-å†…æ ¸æ¨¡å—å´©æºƒè°ƒè¯•)
8. [é©±åŠ¨ç¨‹åºæ•…éšœåˆ†æ](#8-é©±åŠ¨ç¨‹åºæ•…éšœåˆ†æ)
9. [ç¡¬ä»¶æ•…éšœç›¸å…³è½¬å‚¨](#9-ç¡¬ä»¶æ•…éšœç›¸å…³è½¬å‚¨)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” æ ¸å¿ƒè½¬å‚¨åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯æ ¸å¿ƒè½¬å‚¨


**ğŸ¯ æ ¸å¿ƒè½¬å‚¨å®šä¹‰**
æ ¸å¿ƒè½¬å‚¨ï¼ˆCore Dumpï¼‰å°±æ˜¯å½“ç¨‹åºæˆ–ç³»ç»Ÿå‡ºç°ä¸¥é‡é”™è¯¯æ—¶ï¼Œç³»ç»Ÿä¼šæŠŠå½“æ—¶å†…å­˜ä¸­çš„æ‰€æœ‰æ•°æ®"æ‹ä¸ªå¿«ç…§"ä¿å­˜åˆ°æ–‡ä»¶é‡Œã€‚å°±åƒç»™å‡ºè½¦ç¥¸ç°åœºæ‹ç…§ä¸€æ ·ï¼Œè¿™ä¸ª"å¿«ç…§"èƒ½å¸®æˆ‘ä»¬åˆ†æåˆ°åº•å“ªé‡Œå‡ºäº†é—®é¢˜ã€‚

```
ç¨‹åºæ­£å¸¸è¿è¡ŒçŠ¶æ€ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç¨‹åºä»£ç    â”‚ â† æ­£å¸¸æ‰§è¡Œ
â”‚   å†…å­˜æ•°æ®   â”‚
â”‚   å¯„å­˜å™¨çŠ¶æ€ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¨‹åºå´©æºƒæ—¶ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç¨‹åºä»£ç    â”‚ â† ğŸ’¥ å´©æºƒäº†ï¼
â”‚   å†…å­˜æ•°æ®   â”‚ â† ğŸ“¸ ä¿å­˜å¿«ç…§
â”‚   å¯„å­˜å™¨çŠ¶æ€ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
  core dump æ–‡ä»¶
```

### 1.2 è½¬å‚¨çš„ç±»å‹åˆ†ç±»


**ğŸ“‹ è½¬å‚¨ç±»å‹è¯´æ˜**

| è½¬å‚¨ç±»å‹ | **è¯´æ˜** | **è§¦å‘åœºæ™¯** | **æ–‡ä»¶ä½ç½®** |
|---------|---------|-------------|-------------|
| ğŸ”§ **ç”¨æˆ·ç¨‹åºè½¬å‚¨** | `æ™®é€šåº”ç”¨ç¨‹åºå´©æºƒæ—¶ç”Ÿæˆ` | `æ®µé”™è¯¯ã€éæ³•æ“ä½œ` | `/var/lib/systemd/coredump/` |
| ğŸ’¥ **å†…æ ¸è½¬å‚¨** | `æ•´ä¸ªç³»ç»Ÿå†…æ ¸å´©æºƒæ—¶ç”Ÿæˆ` | `kernel panicã€æ­»é”` | `/var/crash/` |
| ğŸš¨ **åº”ç”¨æœåŠ¡è½¬å‚¨** | `ç³»ç»ŸæœåŠ¡ç¨‹åºå´©æºƒ` | `systemdç®¡ç†çš„æœåŠ¡å¼‚å¸¸` | `systemd-coredumpç®¡ç†` |

### 1.3 è½¬å‚¨çš„ä½œç”¨ä»·å€¼


**ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦æ ¸å¿ƒè½¬å‚¨ï¼Ÿ**

```
æ²¡æœ‰è½¬å‚¨æ—¶çš„å›°å¢ƒï¼š
ç¨‹åºå´©æºƒ â†’ é‡å¯ â†’ ä¸çŸ¥é“åŸå›  â†’ é—®é¢˜é‡å¤å‡ºç°

æœ‰äº†è½¬å‚¨åçš„ä¼˜åŠ¿ï¼š
ç¨‹åºå´©æºƒ â†’ ç”Ÿæˆè½¬å‚¨ â†’ åˆ†æè½¬å‚¨ â†’ æ‰¾åˆ°æ ¹æœ¬åŸå›  â†’ ä¿®å¤é—®é¢˜
```

**ğŸ¯ æ ¸å¿ƒè½¬å‚¨çš„å®é™…ä»·å€¼**
- **ğŸ” é—®é¢˜å®šä½**ï¼šç²¾ç¡®çŸ¥é“ç¨‹åºåœ¨å“ªä¸€è¡Œä»£ç å´©æºƒ
- **ğŸ“Š çŠ¶æ€åˆ†æ**ï¼šæŸ¥çœ‹å´©æºƒæ—¶çš„å†…å­˜çŠ¶æ€ã€å˜é‡å€¼
- **ğŸš€ å¤ç°é—®é¢˜**ï¼šé€šè¿‡è½¬å‚¨é‡ç°å´©æºƒç°åœº
- **ğŸ› ï¸ ä¿®å¤æŒ‡å¯¼**ï¼šä¸ºç¨‹åºä¿®å¤æä¾›å‡†ç¡®ä¿¡æ¯

---

## 2. ğŸ› ï¸ coredumpctlå·¥å…·è¯¦è§£


### 2.1 coredumpctlå·¥å…·ä»‹ç»


**ğŸ”§ coredumpctlæ˜¯ä»€ä¹ˆï¼Ÿ**
coredumpctlæ˜¯systemdæä¾›çš„æ ¸å¿ƒè½¬å‚¨ç®¡ç†å·¥å…·ï¼Œå®ƒå°±åƒä¸€ä¸ª"å´©æºƒæ¡£æ¡ˆç®¡ç†å‘˜"ï¼Œå¸®ä½ ç®¡ç†ç³»ç»Ÿä¸­æ‰€æœ‰çš„ç¨‹åºå´©æºƒè®°å½•ã€‚

```
ä¼ ç»Ÿæ–¹å¼ç®¡ç†è½¬å‚¨ï¼š
æ‰¾è½¬å‚¨æ–‡ä»¶ â†’ æ‰‹åŠ¨åˆ†æ â†’ å®¹æ˜“ä¸¢å¤± â†’ ç®¡ç†å›°éš¾

coredumpctlæ–¹å¼ï¼š
ç»Ÿä¸€ç®¡ç† â†’ è‡ªåŠ¨æ”¶é›† â†’ ä¾¿æ·æŸ¥è¯¢ â†’ è¯¦ç»†åˆ†æ
```

### 2.2 åŸºæœ¬ä½¿ç”¨å‘½ä»¤


**ğŸ“‹ å¸¸ç”¨å‘½ä»¤è¯¦è§£**

```bash
# æŸ¥çœ‹æ‰€æœ‰è½¬å‚¨è®°å½•
coredumpctl list

# æŸ¥çœ‹æœ€è¿‘çš„è½¬å‚¨è¯¦æƒ…
coredumpctl info

# è°ƒè¯•ç‰¹å®šçš„è½¬å‚¨
coredumpctl debug

# ä¿å­˜è½¬å‚¨æ–‡ä»¶åˆ°æŒ‡å®šä½ç½®
coredumpctl dump -o /tmp/core.dump
```

**ğŸ” å®é™…ä½¿ç”¨ç¤ºä¾‹**

```bash
# 1. æŸ¥çœ‹ç³»ç»Ÿä¸­çš„æ‰€æœ‰å´©æºƒè®°å½•
$ coredumpctl list
TIME                            PID   UID   GID SIG COREFILE  EXE
Mon 2025-09-15 10:30:15 CST    1234  1000  1000  11 present   /usr/bin/test-app
Mon 2025-09-15 11:45:22 CST    5678  1000  1000   6 present   /usr/bin/my-program

# 2. æŸ¥çœ‹æœ€æ–°å´©æºƒçš„è¯¦ç»†ä¿¡æ¯
$ coredumpctl info
           PID: 5678
           UID: 1000 (username)
           GID: 1000 (username)
        Signal: 6 (ABRT)
     Timestamp: Mon 2025-09-15 11:45:22 CST
  Command Line: /usr/bin/my-program --config /etc/my-program.conf
    Executable: /usr/bin/my-program
         Stack trace of thread 5678:
         #0  0x00007f8b9c5b5387 abort (libc.so.6)
         #1  0x0000558b8c4a12f3 main (my-program)
```

### 2.3 è½¬å‚¨æ–‡ä»¶ç®¡ç†


**ğŸ’¾ è½¬å‚¨æ–‡ä»¶å­˜å‚¨æœºåˆ¶**

```
coredumpctlç®¡ç†çš„æ–‡ä»¶ä½ç½®ï¼š
/var/lib/systemd/coredump/
â”œâ”€â”€ core.my-program.1000.*.lz4    â† å‹ç¼©çš„è½¬å‚¨æ–‡ä»¶
â”œâ”€â”€ core.test-app.1000.*.lz4      â† æŒ‰ç¨‹åºååˆ†ç±»
â””â”€â”€ ...

è½¬å‚¨æ–‡ä»¶å‘½åè§„åˆ™ï¼š
core.[ç¨‹åºå].[ç”¨æˆ·ID].[æ—¶é—´æˆ³].[å‹ç¼©æ ¼å¼]
```

**ğŸ”§ è½¬å‚¨æ–‡ä»¶æ“ä½œ**

```bash
# å¯¼å‡ºè½¬å‚¨æ–‡ä»¶ï¼ˆä¼šè‡ªåŠ¨è§£å‹ï¼‰
coredumpctl dump PID -o /tmp/my-core.dump

# ç›´æ¥å¯åŠ¨è°ƒè¯•å™¨åˆ†æè½¬å‚¨
coredumpctl debug PID

# æŸ¥çœ‹ç‰¹å®šç¨‹åºçš„æ‰€æœ‰è½¬å‚¨
coredumpctl list my-program

# æ¸…ç†æ—§çš„è½¬å‚¨æ–‡ä»¶
coredumpctl --vacuum-time=7d  # åˆ é™¤7å¤©å‰çš„è½¬å‚¨
coredumpctl --vacuum-size=1G  # ä¿æŒæ€»å¤§å°åœ¨1GBä»¥å†…
```

---

## 3. ğŸ’¥ kernel panicä¸kdumpé…ç½®


### 3.1 kernel panicåŸºç¡€ç†è§£


**ğŸš¨ ä»€ä¹ˆæ˜¯kernel panicï¼Ÿ**
kernel panicå°±æ˜¯å†…æ ¸"ææ…Œ"äº†ï¼Œç®€å•è¯´å°±æ˜¯Linuxå†…æ ¸é‡åˆ°äº†æ— æ³•å¤„ç†çš„ä¸¥é‡é”™è¯¯ï¼Œä¸ºäº†é¿å…ç³»ç»ŸæŸåï¼Œå†…æ ¸é€‰æ‹©"è‡ªæ€é‡å¯"ã€‚å°±åƒé©¾é©¶å‘˜å‘ç°åˆ¹è½¦å¤±çµæ—¶ï¼Œé€‰æ‹©æ’å‘æŠ¤æ è€Œä¸æ˜¯å†²å‘äººç¾¤ã€‚

```
æ­£å¸¸ç³»ç»Ÿè¿è¡Œï¼š
ç”¨æˆ·ç¨‹åº â†â†’ å†…æ ¸ â†â†’ ç¡¬ä»¶
     âœ…        âœ…      âœ…

kernel panicçŠ¶æ€ï¼š
ç”¨æˆ·ç¨‹åº â†â†’ å†…æ ¸ â†â†’ ç¡¬ä»¶
     â“        ğŸ’¥      â“
                â†“
           ç³»ç»Ÿé‡å¯/æ­»æœº
```

**ğŸ” å¸¸è§panicåŸå› **

| åŸå› ç±»å‹ | **å…·ä½“è¯´æ˜** | **å¸¸è§åœºæ™¯** |
|---------|-------------|-------------|
| ğŸ”§ **ç¡¬ä»¶æ•…éšœ** | `å†…å­˜æ¡æŸåã€CPUè¿‡çƒ­` | `è¿è¡Œä¸­çªç„¶é‡å¯` |
| ğŸ’» **é©±åŠ¨é—®é¢˜** | `é©±åŠ¨ç¨‹åºæœ‰bugæˆ–ä¸å…¼å®¹` | `å®‰è£…æ–°ç¡¬ä»¶åå´©æºƒ` |
| ğŸ› ï¸ **å†…æ ¸bug** | `å†…æ ¸ä»£ç æœ¬èº«æœ‰ç¼ºé™·` | `ç‰¹å®šæ“ä½œè§¦å‘å´©æºƒ` |
| âš¡ **èµ„æºè€—å°½** | `å†…å­˜ä¸è¶³ã€æ ˆæº¢å‡º` | `é«˜è´Ÿè½½æ—¶ç³»ç»Ÿå´©æºƒ` |

### 3.2 kdumpé…ç½®è¯¦è§£


**ğŸ› ï¸ kdumpæ˜¯ä»€ä¹ˆï¼Ÿ**
kdumpæ˜¯ä¸“é—¨ç”¨æ¥æ•è·kernel panicæ—¶å†…æ ¸çŠ¶æ€çš„å·¥å…·ã€‚å½“ç³»ç»Ÿå´©æºƒæ—¶ï¼Œkdumpä¼šå¯åŠ¨ä¸€ä¸ªå°çš„"æ•‘æ´å†…æ ¸"ï¼Œè¿™ä¸ªæ•‘æ´å†…æ ¸çš„ä»»åŠ¡å°±æ˜¯æŠŠå´©æºƒçš„ä¸»å†…æ ¸å†…å­˜ä¿å­˜ä¸‹æ¥ã€‚

```
æ­£å¸¸å¯åŠ¨æµç¨‹ï¼š
BIOS â†’ åŠ è½½å†…æ ¸ â†’ å¯åŠ¨ç³»ç»Ÿ

kdumpå¯åŠ¨æµç¨‹ï¼ˆå´©æºƒæ—¶ï¼‰ï¼š
ä¸»å†…æ ¸å´©æºƒ â†’ å¯åŠ¨æ•‘æ´å†…æ ¸ â†’ ä¿å­˜å´©æºƒå†…æ ¸å†…å­˜ â†’ é‡å¯
```

**âš™ï¸ kdumpé…ç½®æ­¥éª¤**

```bash
# 1. å®‰è£…kdumpç›¸å…³åŒ…
sudo dnf install kexec-tools crash kernel-debuginfo

# 2. ä¸ºkdumpé¢„ç•™å†…å­˜
# ç¼–è¾‘ /etc/default/grub
GRUB_CMDLINE_LINUX="... crashkernel=128M"

# 3. æ›´æ–°grubé…ç½®
sudo grub2-mkconfig -o /boot/grub2/grub.cfg

# 4. å¯ç”¨kdumpæœåŠ¡
sudo systemctl enable kdump
sudo systemctl start kdump

# 5. éªŒè¯kdumpçŠ¶æ€
sudo kdumpctl status
```

**ğŸ“ kdumpé…ç½®æ–‡ä»¶è¯´æ˜**

```bash
# /etc/kdump.conf - ä¸»è¦é…ç½®é€‰é¡¹
path /var/crash                    # è½¬å‚¨æ–‡ä»¶ä¿å­˜è·¯å¾„
core_collector makedumpfile -l     # å‹ç¼©è½¬å‚¨æ–‡ä»¶
default reboot                     # è½¬å‚¨å®Œæˆåé‡å¯
```

### 3.3 æµ‹è¯•kdumpåŠŸèƒ½


**ğŸ§ª å®‰å…¨æµ‹è¯•æ–¹æ³•**

> âš ï¸ **é‡è¦æé†’**  
> ä¸‹é¢çš„æµ‹è¯•ä¼šå¯¼è‡´ç³»ç»Ÿå´©æºƒé‡å¯ï¼Œè¯·åœ¨æµ‹è¯•ç¯å¢ƒæˆ–è€…ä¿å­˜å¥½å·¥ä½œåå†æ‰§è¡Œï¼

```bash
# è§¦å‘kernel panicè¿›è¡Œæµ‹è¯•
echo 1 | sudo tee /proc/sys/kernel/sysrq
echo c | sudo tee /proc/sysrq-trigger

# ç³»ç»Ÿä¼šç«‹å³å´©æºƒå¹¶ç”Ÿæˆè½¬å‚¨æ–‡ä»¶
```

**âœ… éªŒè¯kdumpæ˜¯å¦æ­£å¸¸å·¥ä½œ**

```bash
# é‡å¯åæ£€æŸ¥æ˜¯å¦ç”Ÿæˆäº†è½¬å‚¨æ–‡ä»¶
ls -la /var/crash/
# åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„ç›®å½•ï¼š
# 127.0.0.1-2025-09-15-15:30:15/

# æŸ¥çœ‹è½¬å‚¨æ–‡ä»¶å†…å®¹
ls -la /var/crash/127.0.0.1-*/
# vmcore      - å†…æ ¸è½¬å‚¨æ–‡ä»¶
# vmcore-dmesg.txt - å†…æ ¸æ¶ˆæ¯
```

---

## 4. ğŸ“ å†…æ ¸è½¬å‚¨æ–‡ä»¶åˆ†æ


### 4.1 /proc/vmcoreæ–‡ä»¶ç†è§£


**ğŸ“‹ vmcoreæ–‡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ**
/proc/vmcoreæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„è™šæ‹Ÿæ–‡ä»¶ï¼Œåªæœ‰åœ¨kdumpæ•‘æ´å†…æ ¸ç¯å¢ƒä¸‹æ‰å­˜åœ¨ã€‚å®ƒåŒ…å«äº†å´©æºƒæ—¶ä¸»å†…æ ¸çš„å®Œæ•´å†…å­˜æ˜ åƒï¼Œå°±åƒæ˜¯ç»™æ•´ä¸ªç³»ç»Ÿå†…å­˜æ‹äº†ä¸€å¼ "å…¨æ™¯ç…§ç‰‡"ã€‚

```
vmcoreæ–‡ä»¶ç»“æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ELFæ–‡ä»¶å¤´     â”‚ â† æ ‡å‡†ELFæ ¼å¼
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ç¨‹åºå¤´è¡¨      â”‚ â† å†…å­˜æ®µä¿¡æ¯
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å†…æ ¸ä»£ç æ®µ    â”‚ â† å†…æ ¸ç¨‹åºä»£ç 
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å†…æ ¸æ•°æ®æ®µ    â”‚ â† å…¨å±€å˜é‡ã€æ•°æ®ç»“æ„
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ç‰©ç†å†…å­˜æ˜ åƒ  â”‚ â† å®Œæ•´çš„ç‰©ç†å†…å­˜å†…å®¹
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 è½¬å‚¨æ–‡ä»¶å†…å®¹åˆ†æ


**ğŸ” vmcoreåŒ…å«çš„å…³é”®ä¿¡æ¯**

| ä¿¡æ¯ç±»å‹ | **å†…å®¹è¯´æ˜** | **ç”¨é€”** |
|---------|-------------|---------|
| ğŸ“‹ **å¯„å­˜å™¨çŠ¶æ€** | `CPUå¯„å­˜å™¨å€¼ï¼Œç¨‹åºè®¡æ•°å™¨` | `ç¡®å®šå´©æºƒä½ç½®` |
| ğŸ’¾ **å†…å­˜å†…å®¹** | `å†…æ ¸å’Œç”¨æˆ·ç©ºé—´å†…å­˜æ•°æ®` | `åˆ†ææ•°æ®çŠ¶æ€` |
| ğŸ“š **ç¬¦å·è¡¨** | `å‡½æ•°åã€å˜é‡åæ˜ å°„` | `ä¾¿äºé˜…è¯»åˆ†æ` |
| ğŸ”— **è°ƒç”¨æ ˆ** | `å‡½æ•°è°ƒç”¨é“¾å…³ç³»` | `è¿½æº¯å´©æºƒåŸå› ` |

**ğŸ“ è½¬å‚¨æ–‡ä»¶å¤§å°è®¡ç®—**

```bash
# æŸ¥çœ‹ç³»ç»Ÿå†…å­˜å¤§å°
free -h
#               total        used        free
# Mem:           7.8Gi       2.1Gi       3.2Gi

# vmcoreæ–‡ä»¶å¤§å°é€šå¸¸ç­‰äºç‰©ç†å†…å­˜å¤§å°
# å¦‚æœç³»ç»Ÿæœ‰8GBå†…å­˜ï¼Œvmcoreå¯èƒ½å°±æ˜¯8GB
# ä½¿ç”¨å‹ç¼©å¯ä»¥å‡å°‘åˆ°å‡ ç™¾MBåˆ°å‡ GB
```

### 4.3 è½¬å‚¨æ–‡ä»¶çš„è·å–æ–¹å¼


**ğŸ’¿ ä»æ•‘æ´ç¯å¢ƒè·å–è½¬å‚¨**

```bash
# åœ¨kdumpæ•‘æ´å†…æ ¸ä¸­æ“ä½œ
# å¤åˆ¶vmcoreåˆ°æ°¸ä¹…å­˜å‚¨
cp /proc/vmcore /var/crash/vmcore-$(date +%Y%m%d-%H%M%S)

# ä½¿ç”¨makedumpfileå‹ç¼©è½¬å‚¨
makedumpfile -l -d 31 /proc/vmcore /var/crash/vmcore.compressed
```

**ğŸ“¦ è½¬å‚¨æ–‡ä»¶æ ¼å¼é€‰æ‹©**

```bash
# ä¸å‹ç¼©ï¼ˆå®Œæ•´ä¿¡æ¯ï¼Œæ–‡ä»¶å¾ˆå¤§ï¼‰
cp /proc/vmcore /var/crash/vmcore.raw

# å‹ç¼©ä½†ä¿ç•™é‡è¦ä¿¡æ¯ï¼ˆæ¨èï¼‰
makedumpfile -l /proc/vmcore /var/crash/vmcore.dump

# é«˜åº¦å‹ç¼©ï¼ˆæ–‡ä»¶å°ï¼Œä¿¡æ¯æœ‰æŸå¤±ï¼‰
makedumpfile -c /proc/vmcore /var/crash/vmcore.compressed
```

---

## 5. ğŸ”¬ crashå·¥å…·æ·±åº¦åˆ†æ


### 5.1 crashå·¥å…·ä»‹ç»


**ğŸ› ï¸ crashå·¥å…·æ˜¯ä»€ä¹ˆï¼Ÿ**
crashæ˜¯ä¸“é—¨ç”¨æ¥åˆ†æLinuxå†…æ ¸è½¬å‚¨æ–‡ä»¶çš„å·¥å…·ï¼Œå®ƒå°±åƒä¸€ä¸ª"å†…æ ¸ä¾¦æ¢"ï¼Œèƒ½å¤Ÿæ·±å…¥åˆ†æå´©æºƒç°åœºï¼Œæ‰¾å‡ºé—®é¢˜çš„æ ¹æœ¬åŸå› ã€‚crashå·¥å…·å¯ä»¥è®©ä½ åƒä½¿ç”¨è°ƒè¯•å™¨ä¸€æ ·æŸ¥çœ‹å´©æºƒæ—¶çš„å†…æ ¸çŠ¶æ€ã€‚

```
crashå·¥å…·çš„ä½œç”¨ï¼š
è½¬å‚¨æ–‡ä»¶ â†’ crashå·¥å…· â†’ å¯è¯»çš„åˆ†ææŠ¥å‘Š
  (äºŒè¿›åˆ¶)    (åˆ†æå™¨)     (äººèƒ½ç†è§£çš„ä¿¡æ¯)
```

### 5.2 crashå·¥å…·å®‰è£…ä¸åŸºæœ¬ä½¿ç”¨


**ğŸ“¦ å®‰è£…crashå·¥å…·**

```bash
# RHEL/CentOS/Fedora
sudo dnf install crash kernel-debuginfo

# Ubuntu/Debian
sudo apt-get install crash linux-image-$(uname -r)-dbg
```

**ğŸš€ å¯åŠ¨crashåˆ†æ**

```bash
# åˆ†ææœ¬åœ°vmcoreæ–‡ä»¶
crash /usr/lib/debug/lib/modules/$(uname -r)/vmlinux /var/crash/vmcore

# åˆ†æè¿œç¨‹vmcoreæ–‡ä»¶
crash /path/to/vmlinux /path/to/vmcore
```

### 5.3 crashå·¥å…·å¸¸ç”¨å‘½ä»¤


**ğŸ“‹ åŸºç¡€ä¿¡æ¯æŸ¥çœ‹å‘½ä»¤**

```bash
# å¯åŠ¨crashåï¼Œåœ¨crash>æç¤ºç¬¦ä¸‹æ‰§è¡Œï¼š

# æŸ¥çœ‹ç³»ç»ŸåŸºæœ¬ä¿¡æ¯
crash> sys
# æ˜¾ç¤ºï¼šå†…æ ¸ç‰ˆæœ¬ã€å´©æºƒæ—¶é—´ã€CPUæ¶æ„ã€å†…å­˜å¤§å°ç­‰

# æŸ¥çœ‹å´©æºƒæ—¶çš„æ—¥å¿—
crash> log
# æ˜¾ç¤ºï¼šå†…æ ¸æ¶ˆæ¯ç¼“å†²åŒºå†…å®¹ï¼ŒåŒ…æ‹¬panicæ¶ˆæ¯

# æŸ¥çœ‹CPUçŠ¶æ€
crash> bt
# æ˜¾ç¤ºï¼šå´©æºƒæ—¶çš„è°ƒç”¨æ ˆï¼ˆbacktraceï¼‰
```

**ğŸ” æ·±åº¦åˆ†æå‘½ä»¤**

```bash
# æŸ¥çœ‹æ‰€æœ‰ä»»åŠ¡/è¿›ç¨‹çŠ¶æ€
crash> ps
# æ˜¾ç¤ºï¼šå´©æºƒæ—¶è¿è¡Œçš„æ‰€æœ‰è¿›ç¨‹

# æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ
crash> kmem -i
# æ˜¾ç¤ºï¼šå†…æ ¸å†…å­˜åˆ†é…ç»Ÿè®¡

# æŸ¥çœ‹ç‰¹å®šè¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯
crash> task PID
# æ˜¾ç¤ºï¼šæŒ‡å®šè¿›ç¨‹çš„è¯¦ç»†çŠ¶æ€

# æŸ¥çœ‹æ–‡ä»¶ç³»ç»ŸçŠ¶æ€
crash> mount
# æ˜¾ç¤ºï¼šå·²æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿ
```

### 5.4 å®é™…åˆ†ææ¡ˆä¾‹


**ğŸ’¡ å…¸å‹çš„crashåˆ†ææµç¨‹**

<details>
<summary>ğŸ”§ ç‚¹å‡»æŸ¥çœ‹å®Œæ•´çš„crashåˆ†æç¤ºä¾‹</summary>

```bash
# 1. å¯åŠ¨crashåˆ†æ
$ crash /usr/lib/debug/boot/vmlinux-5.14.0 /var/crash/vmcore

# 2. æŸ¥çœ‹ç³»ç»ŸåŸºæœ¬ä¿¡æ¯
crash> sys
      KERNEL: /usr/lib/debug/boot/vmlinux-5.14.0
    DUMPFILE: /var/crash/vmcore
        CPUS: 4
        DATE: Mon Sep 15 15:30:15 2025
      UPTIME: 02:15:30
LOAD AVERAGE: 1.2, 0.8, 0.5
       TASKS: 156
    NODENAME: myserver
     RELEASE: 5.14.0-162.el9.x86_64
     VERSION: #1 SMP PREEMPT
     MACHINE: x86_64

# 3. æŸ¥çœ‹å´©æºƒæ—¶çš„è°ƒç”¨æ ˆ
crash> bt
PID: 0      TASK: ffffffff82e13ac0  CPU: 2   COMMAND: "swapper/2"
 #0 [ffffb12040387b28] crash_kexec at ffffffff810e5b2c
 #1 [ffffb12040387b40] __crash_kexec at ffffffff810e5c1d
 #2 [ffffb12040387b58] panic at ffffffff8109c7f5
 #3 [ffffb12040387bd8] oops_end at ffffffff81027c2b

# 4. æŸ¥çœ‹å†…æ ¸æ—¥å¿—æ‰¾åŸå› 
crash> log | tail -20
[42315.234567] BUG: unable to handle kernel NULL pointer dereference
[42315.234568] RIP: 0010:some_driver_function+0x45/0x123 [bad_driver]
[42315.234569] Call Trace:
[42315.234570] driver_callback+0x23/0x67 [bad_driver]
```

</details>

**ğŸ¯ åˆ†æé‡ç‚¹å…³æ³¨ç‚¹**

| å…³æ³¨å†…å®¹ | **æŸ¥çœ‹å‘½ä»¤** | **åˆ†æè¦ç‚¹** |
|---------|-------------|-------------|
| ğŸ’¥ **å´©æºƒåŸå› ** | `log`ã€`bt` | `æŸ¥æ‰¾panicæ¶ˆæ¯ï¼Œåˆ†æè°ƒç”¨æ ˆ` |
| ğŸ§  **å†…å­˜çŠ¶æ€** | `kmem`ã€`vm` | `æ£€æŸ¥å†…å­˜æ³„æ¼ã€å†…å­˜ä¸è¶³` |
| ğŸ”„ **è¿›ç¨‹çŠ¶æ€** | `ps`ã€`task` | `æŸ¥çœ‹å¼‚å¸¸è¿›ç¨‹ï¼Œæ­»é”æƒ…å†µ` |
| ğŸ”Œ **ç¡¬ä»¶çŠ¶æ€** | `sys`ã€`mach` | `æ£€æŸ¥ç¡¬ä»¶ä¿¡æ¯ã€ä¸­æ–­çŠ¶æ€` |

---

## 6. ğŸ”„ ç³»ç»ŸhangæœºçŠ¶æ€è¯Šæ–­


### 6.1 ä»€ä¹ˆæ˜¯ç³»ç»Ÿhangæœº


**ğŸš¨ hangæœºçŠ¶æ€ç†è§£**
ç³»ç»Ÿhangæœºï¼ˆæŒ‚èµ·ï¼‰å°±æ˜¯ç³»ç»Ÿ"å¡æ­»"äº†ï¼Œçœ‹èµ·æ¥è¿˜åœ¨è¿è¡Œä½†æ˜¯æ— æ³•å“åº”ä»»ä½•æ“ä½œã€‚å°±åƒäºº"å‘†ä½äº†"ä¸€æ ·ï¼Œæœ‰æ„è¯†ä½†æ— æ³•è¡ŒåŠ¨ã€‚è¿™ç§çŠ¶æ€æ¯”å®Œå…¨å´©æºƒæ›´éš¾è°ƒè¯•ï¼Œå› ä¸ºç³»ç»Ÿæ²¡æœ‰é‡å¯ï¼Œä½†ä¹Ÿæ— æ³•æ­£å¸¸å·¥ä½œã€‚

```
æ­£å¸¸ç³»ç»Ÿï¼š
ç”¨æˆ·è¾“å…¥ â†’ ç³»ç»Ÿå“åº” â†’ æ‰§è¡Œæ“ä½œ â†’ è¿”å›ç»“æœ
   âœ…         âœ…         âœ…         âœ…

hangæœºç³»ç»Ÿï¼š
ç”¨æˆ·è¾“å…¥ â†’ ç³»ç»Ÿå“åº” â†’ æ‰§è¡Œæ“ä½œ â†’ è¿”å›ç»“æœ
   âœ…         âŒ         â“         âŒ
```

### 6.2 hangæœºçš„å¸¸è§åŸå› 


**ğŸ” å…¸å‹hangæœºåœºæ™¯**

| åŸå› ç±»å‹ | **å…·ä½“è¡¨ç°** | **å¸¸è§è§¦å‘æ¡ä»¶** |
|---------|-------------|----------------|
| ğŸ”’ **æ­»é”** | `å¤šä¸ªè¿›ç¨‹äº’ç›¸ç­‰å¾…` | `èµ„æºç«äº‰ã€é”é¡ºåºé”™è¯¯` |
| ğŸ’¾ **å†…å­˜è€—å°½** | `ç³»ç»Ÿæ— æ³•åˆ†é…å†…å­˜` | `å†…å­˜æ³„æ¼ã€å¤§æ–‡ä»¶æ“ä½œ` |
| ğŸ’¿ **IOé˜»å¡** | `ç£ç›˜IOæ— æ³•å®Œæˆ` | `ç¡¬ç›˜æ•…éšœã€ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿé—®é¢˜` |
| ğŸ”„ **ä¸­æ–­é£æš´** | `ç¡¬ä»¶ä¸­æ–­è¿‡äºé¢‘ç¹` | `ç¡¬ä»¶æ•…éšœã€é©±åŠ¨ç¨‹åºbug` |

### 6.3 hangæœºè¯Šæ–­æ–¹æ³•


**ğŸ› ï¸ Magic SysRqé”®è¯Šæ–­**

Magic SysRqæ˜¯Linuxå†…æ ¸æä¾›çš„ç´§æ€¥è°ƒè¯•åŠŸèƒ½ï¼Œå³ä½¿ç³»ç»Ÿhangæœºä¹Ÿèƒ½ä½¿ç”¨ï¼š

```bash
# å¯ç”¨Magic SysRqåŠŸèƒ½
echo 1 | sudo tee /proc/sys/kernel/sysrq

# å¸¸ç”¨çš„SysRqå‘½ä»¤ï¼ˆé€šè¿‡é”®ç›˜æˆ–å‘½ä»¤è¡Œï¼‰
echo t | sudo tee /proc/sysrq-trigger  # æ˜¾ç¤ºæ‰€æœ‰ä»»åŠ¡çŠ¶æ€
echo m | sudo tee /proc/sysrq-trigger  # æ˜¾ç¤ºå†…å­˜ä¿¡æ¯
echo w | sudo tee /proc/sysrq-trigger  # æ˜¾ç¤ºé˜»å¡çš„ä»»åŠ¡
echo l | sudo tee /proc/sysrq-trigger  # æ˜¾ç¤ºæ‰€æœ‰CPUçš„è°ƒç”¨æ ˆ
```

**ğŸ“Š /procæ–‡ä»¶ç³»ç»Ÿè¯Šæ–­**

```bash
# æŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½
cat /proc/loadavg
# å¦‚æœload averageå¾ˆé«˜ï¼ˆ>CPUæ ¸å¿ƒæ•°ï¼‰ï¼Œå¯èƒ½æœ‰é—®é¢˜

# æŸ¥çœ‹å†…å­˜ä½¿ç”¨
cat /proc/meminfo
# é‡ç‚¹å…³æ³¨ï¼šMemFreeã€MemAvailableã€SwapFree

# æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€
cat /proc/*/stat | awk '{print $1, $2, $3}' | sort
# æŸ¥çœ‹å“ªäº›è¿›ç¨‹å¤„äºä»€ä¹ˆçŠ¶æ€ï¼ˆRè¿è¡Œã€Sç¡çœ ã€Dä¸å¯ä¸­æ–­ï¼‰
```

### 6.4 ç”Ÿæˆhangæœºè½¬å‚¨


**ğŸ“¸ æ‰‹åŠ¨è§¦å‘è½¬å‚¨**

å½“ç³»ç»Ÿhangæœºæ—¶ï¼Œå¯ä»¥æ‰‹åŠ¨è§¦å‘è½¬å‚¨ä»¥ä¿å­˜å½“å‰çŠ¶æ€ï¼š

```bash
# é€šè¿‡Magic SysRqè§¦å‘å´©æºƒè½¬å‚¨
echo c | sudo tee /proc/sysrq-trigger

# è¿™ä¼šç«‹å³è§¦å‘kernel panicå¹¶ç”Ÿæˆè½¬å‚¨æ–‡ä»¶
# æ³¨æ„ï¼šè¿™ä¼šå¯¼è‡´ç³»ç»Ÿé‡å¯ï¼
```

**ğŸ”§ ä½¿ç”¨NMIæŒ‰é’®**

```bash
# é€šè¿‡NMIï¼ˆä¸å¯å±è”½ä¸­æ–­ï¼‰ç”Ÿæˆè½¬å‚¨
echo 1 | sudo tee /proc/sys/kernel/unknown_nmi_panic
# ç„¶åæŒ‰æœåŠ¡å™¨çš„NMIæŒ‰é’®ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰
```

---

## 7. ğŸ§© å†…æ ¸æ¨¡å—å´©æºƒè°ƒè¯•


### 7.1 å†…æ ¸æ¨¡å—å´©æºƒç‰¹ç‚¹


**ğŸ”Œ ä»€ä¹ˆæ˜¯å†…æ ¸æ¨¡å—å´©æºƒï¼Ÿ**
å†…æ ¸æ¨¡å—å°±æ˜¯å¯ä»¥åŠ¨æ€åŠ è½½åˆ°å†…æ ¸ä¸­çš„ä»£ç ç‰‡æ®µï¼Œæ¯”å¦‚è®¾å¤‡é©±åŠ¨ç¨‹åºã€‚å½“è¿™äº›æ¨¡å—æœ‰bugæ—¶ï¼Œå®ƒä»¬å¯èƒ½ä¼šå¯¼è‡´æ•´ä¸ªå†…æ ¸å´©æºƒï¼Œå› ä¸ºå®ƒä»¬è¿è¡Œåœ¨å†…æ ¸ç©ºé—´ï¼Œæ‹¥æœ‰æœ€é«˜æƒé™ã€‚

```
å†…æ ¸æ¨¡å—åœ¨ç³»ç»Ÿä¸­çš„ä½ç½®ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·ç¨‹åº      â”‚ â† ç”¨æˆ·ç©ºé—´ï¼ˆç›¸å¯¹å®‰å…¨ï¼‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ç³»ç»Ÿè°ƒç”¨æ¥å£   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å†…æ ¸æ ¸å¿ƒ      â”‚ â† å†…æ ¸ç©ºé—´
â”‚   å†…æ ¸æ¨¡å—      â”‚ â† é©±åŠ¨ç¨‹åºç­‰ï¼ˆå®¹æ˜“å‡ºé”™ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 è¯†åˆ«æ¨¡å—å´©æºƒ


**ğŸ” æ¨¡å—å´©æºƒçš„å…¸å‹ç‰¹å¾**

```bash
# æŸ¥çœ‹å†…æ ¸æ—¥å¿—ä¸­çš„æ¨¡å—å´©æºƒä¿¡æ¯
dmesg | grep -i "BUG\|oops\|panic"

# å…¸å‹çš„æ¨¡å—å´©æºƒæ—¥å¿—ï¼š
# BUG: unable to handle kernel NULL pointer dereference at 0000000000000008
# RIP: 0010:bad_driver_function+0x45/0x123 [bad_driver]
#                                          ^^^^^^^^^^^^
#                                          é—®é¢˜æ¨¡å—å
```

**ğŸ“‹ æ¨¡å—å´©æºƒä¿¡æ¯è§£è¯»**

| å…³é”®ä¿¡æ¯ | **å«ä¹‰** | **åˆ†æè¦ç‚¹** |
|---------|---------|-------------|
| ğŸ¯ **RIPåœ°å€** | `å´©æºƒå‘ç”Ÿçš„ä»£ç ä½ç½®` | `å®šä½å…·ä½“çš„é—®é¢˜å‡½æ•°` |
| ğŸ“¦ **æ¨¡å—å** | `[æ–¹æ‹¬å·]ä¸­çš„æ¨¡å—å` | `ç¡®å®šæœ‰é—®é¢˜çš„é©±åŠ¨æˆ–æ¨¡å—` |
| ğŸ” **é”™è¯¯ç±»å‹** | `NULL pointerã€page faultç­‰` | `åˆ¤æ–­é”™è¯¯çš„æ€§è´¨` |
| ğŸ“š **è°ƒç”¨æ ˆ** | `Call Traceéƒ¨åˆ†` | `è¿½æº¯é”™è¯¯çš„è°ƒç”¨è·¯å¾„` |

### 7.3 æ¨¡å—è°ƒè¯•æ–¹æ³•


**ğŸ› ï¸ æŸ¥çœ‹åŠ è½½çš„æ¨¡å—**

```bash
# æŸ¥çœ‹å½“å‰åŠ è½½çš„æ‰€æœ‰æ¨¡å—
lsmod

# æŸ¥çœ‹ç‰¹å®šæ¨¡å—çš„ä¿¡æ¯
modinfo driver_name

# æŸ¥çœ‹æ¨¡å—çš„ä¾èµ–å…³ç³»
modprobe --show-depends driver_name
```

**ğŸ”§ æ¨¡å—è°ƒè¯•æ­¥éª¤**

```bash
# 1. å¸è½½å¯ç–‘æ¨¡å—
sudo modprobe -r suspicious_driver

# 2. é‡æ–°åŠ è½½æ¨¡å—å¹¶è§‚å¯Ÿ
sudo modprobe suspicious_driver

# 3. æŸ¥çœ‹æ¨¡å—åŠ è½½æ—¥å¿—
dmesg | tail -20

# 4. å¦‚æœå´©æºƒé‡ç°ï¼Œç”Ÿæˆè½¬å‚¨åˆ†æ
```

### 7.4 ä½¿ç”¨crashåˆ†ææ¨¡å—å´©æºƒ


**ğŸ”¬ crashä¸­çš„æ¨¡å—åˆ†æå‘½ä»¤**

```bash
# åœ¨crashä¸­æŸ¥çœ‹åŠ è½½çš„æ¨¡å—
crash> mod
# æ˜¾ç¤ºå´©æºƒæ—¶åŠ è½½çš„æ‰€æœ‰å†…æ ¸æ¨¡å—

# æŸ¥çœ‹ç‰¹å®šæ¨¡å—çš„è¯¦ç»†ä¿¡æ¯
crash> mod -s module_name
# æ˜¾ç¤ºæ¨¡å—çš„ç¬¦å·è¡¨å’Œä»£ç æ®µä¿¡æ¯

# åˆ†ææ¨¡å—ç›¸å…³çš„è°ƒç”¨æ ˆ
crash> bt -t
# æ˜¾ç¤ºè¯¦ç»†çš„è°ƒç”¨æ ˆï¼ŒåŒ…æ‹¬æ¨¡å—å‡½æ•°
```

---

## 8. ğŸš— é©±åŠ¨ç¨‹åºæ•…éšœåˆ†æ


### 8.1 é©±åŠ¨ç¨‹åºæ•…éšœç±»å‹


**ğŸ”§ å¸¸è§é©±åŠ¨ç¨‹åºé—®é¢˜**

é©±åŠ¨ç¨‹åºæ˜¯æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶ä¹‹é—´çš„"ç¿»è¯‘å®˜"ï¼Œå½“é©±åŠ¨æœ‰é—®é¢˜æ—¶ï¼Œè½»åˆ™è®¾å¤‡æ— æ³•ä½¿ç”¨ï¼Œé‡åˆ™æ•´ä¸ªç³»ç»Ÿå´©æºƒã€‚

```
é©±åŠ¨ç¨‹åºçš„ä½œç”¨ï¼š
åº”ç”¨ç¨‹åº â†â†’ å†…æ ¸ â†â†’ é©±åŠ¨ç¨‹åº â†â†’ ç¡¬ä»¶è®¾å¤‡
                      â†‘
                   é—®é¢˜å¯èƒ½å‡ºç°åœ¨è¿™é‡Œ
```

**ğŸ“‹ é©±åŠ¨æ•…éšœåˆ†ç±»**

| æ•…éšœç±»å‹ | **ç—‡çŠ¶è¡¨ç°** | **å¸¸è§åŸå› ** | **å½±å“èŒƒå›´** |
|---------|-------------|-------------|-------------|
| ğŸ’¥ **å´©æºƒå‹** | `kernel panicï¼Œç³»ç»Ÿé‡å¯` | `ç©ºæŒ‡é’ˆè®¿é—®ã€å†…å­˜è¶Šç•Œ` | `æ•´ä¸ªç³»ç»Ÿ` |
| ğŸ”’ **æ­»é”å‹** | `ç³»ç»Ÿhangæœºï¼Œæ— å“åº”` | `é”çš„ä½¿ç”¨é”™è¯¯` | `ç›¸å…³è¿›ç¨‹` |
| ğŸŒ **æ€§èƒ½å‹** | `è®¾å¤‡å“åº”æ…¢ï¼ŒIOé˜»å¡` | `ç®—æ³•æ•ˆç‡ä½ã€èµ„æºäº‰ç”¨` | `è®¾å¤‡æ€§èƒ½` |
| ğŸ”Œ **åŠŸèƒ½å‹** | `è®¾å¤‡æ— æ³•æ­£å¸¸å·¥ä½œ` | `é€»è¾‘é”™è¯¯ã€å…¼å®¹æ€§é—®é¢˜` | `ç‰¹å®šè®¾å¤‡` |

### 8.2 é©±åŠ¨æ•…éšœè¯Šæ–­å·¥å…·


**ğŸ› ï¸ åŸºç¡€è¯Šæ–­å‘½ä»¤**

```bash
# æŸ¥çœ‹ç¡¬ä»¶è®¾å¤‡ä¿¡æ¯
lspci -v                    # PCIè®¾å¤‡è¯¦ç»†ä¿¡æ¯
lsusb -v                    # USBè®¾å¤‡è¯¦ç»†ä¿¡æ¯
lshw                        # å®Œæ•´ç¡¬ä»¶ä¿¡æ¯

# æŸ¥çœ‹è®¾å¤‡é©±åŠ¨ç»‘å®šæƒ…å†µ
ls -la /sys/bus/pci/drivers/    # PCIé©±åŠ¨
ls -la /sys/bus/usb/drivers/    # USBé©±åŠ¨

# æŸ¥çœ‹è®¾å¤‡çŠ¶æ€
cat /proc/interrupts        # ä¸­æ–­ä½¿ç”¨æƒ…å†µ
cat /proc/iomem             # IOå†…å­˜æ˜ å°„
cat /proc/ioports           # IOç«¯å£ä½¿ç”¨
```

**ğŸ“Š é©±åŠ¨æ€§èƒ½ç›‘æ§**

```bash
# ç›‘æ§ç£ç›˜IOæ€§èƒ½
iostat -x 1                 # æ¯ç§’æ˜¾ç¤ºç£ç›˜IOç»Ÿè®¡

# ç›‘æ§ç½‘ç»œæ¥å£æ€§èƒ½
iftop                       # å®æ—¶ç½‘ç»œæµé‡ç›‘æ§
ss -i                       # ç½‘ç»œè¿æ¥è¯¦ç»†ä¿¡æ¯

# ç›‘æ§CPUä¸­æ–­åˆ†å¸ƒ
watch -n 1 'cat /proc/interrupts'
```

### 8.3 ç‰¹å®šç±»å‹é©±åŠ¨åˆ†æ


**ğŸ’¿ å­˜å‚¨è®¾å¤‡é©±åŠ¨é—®é¢˜**

```bash
# æŸ¥çœ‹ç£ç›˜é”™è¯¯æ—¥å¿—
dmesg | grep -i "error\|fail"

# æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿé”™è¯¯
fsck /dev/sdb1              # æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿ

# æŸ¥çœ‹SMARTä¿¡æ¯ï¼ˆç¡¬ç›˜å¥åº·çŠ¶æ€ï¼‰
smartctl -a /dev/sda
```

**ğŸŒ ç½‘ç»œè®¾å¤‡é©±åŠ¨é—®é¢˜**

```bash
# æŸ¥çœ‹ç½‘ç»œæ¥å£çŠ¶æ€
ip link show                # æ¥å£åŸºæœ¬ä¿¡æ¯
ethtool eth0               # æ¥å£è¯¦ç»†å‚æ•°

# æŸ¥çœ‹ç½‘ç»œé”™è¯¯ç»Ÿè®¡
cat /proc/net/dev          # ç½‘ç»œæ¥å£ç»Ÿè®¡
netstat -i                 # ç½‘ç»œæ¥å£é”™è¯¯è®¡æ•°
```

### 8.4 ä½¿ç”¨crashåˆ†æé©±åŠ¨é—®é¢˜


**ğŸ”¬ é©±åŠ¨ç›¸å…³çš„crashåˆ†æ**

```bash
# åœ¨crashä¸­æŸ¥çœ‹è®¾å¤‡é©±åŠ¨çŠ¶æ€
crash> dev
# æ˜¾ç¤ºæ‰€æœ‰è®¾å¤‡çš„é©±åŠ¨ç»‘å®šæƒ…å†µ

# æŸ¥çœ‹ä¸­æ–­å¤„ç†
crash> irq
# æ˜¾ç¤ºä¸­æ–­å‘é‡è¡¨å’Œå¤„ç†å‡½æ•°

# åˆ†æç½‘ç»œè®¾å¤‡çŠ¶æ€
crash> net
# æ˜¾ç¤ºç½‘ç»œè®¾å¤‡å’Œè¿æ¥çŠ¶æ€
```

---

## 9. âš¡ ç¡¬ä»¶æ•…éšœç›¸å…³è½¬å‚¨


### 9.1 ç¡¬ä»¶æ•…éšœè½¬å‚¨ç‰¹å¾


**ğŸ”§ ç¡¬ä»¶æ•…éšœå¯¼è‡´çš„è½¬å‚¨ç‰¹ç‚¹**

ç¡¬ä»¶æ•…éšœå¼•èµ·çš„ç³»ç»Ÿå´©æºƒé€šå¸¸æœ‰ç‰¹å®šçš„æ¨¡å¼ï¼Œè¿™äº›æ¨¡å¼å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿå®šä½é—®é¢˜æ˜¯è½¯ä»¶è¿˜æ˜¯ç¡¬ä»¶å¼•èµ·çš„ã€‚

```
è½¯ä»¶é—®é¢˜ vs ç¡¬ä»¶é—®é¢˜çš„è½¬å‚¨ç‰¹å¾ï¼š

è½¯ä»¶é—®é¢˜è½¬å‚¨ï¼š
- è°ƒç”¨æ ˆæ¸…æ™°ï¼ŒæŒ‡å‘ç‰¹å®šä»£ç 
- é”™è¯¯å¯ä»¥é‡ç°
- é€šå¸¸æœ‰æ˜ç¡®çš„é”™è¯¯ä¿¡æ¯

ç¡¬ä»¶é—®é¢˜è½¬å‚¨ï¼š
- è°ƒç”¨æ ˆå¯èƒ½ä¸­æ–­æˆ–æŸå
- é”™è¯¯éšæœºå‡ºç°
- å¸¸ä¼´éšç¡¬ä»¶é”™è¯¯æ—¥å¿—
```

### 9.2 CPUç›¸å…³ç¡¬ä»¶æ•…éšœ


**ğŸ§  CPUæ•…éšœçš„è½¬å‚¨åˆ†æ**

```bash
# æŸ¥çœ‹CPUç¡¬ä»¶é”™è¯¯æ—¥å¿—
dmesg | grep -i "mce\|machine check"

# MCE (Machine Check Exception) æ˜¯CPUæ£€æµ‹åˆ°ç¡¬ä»¶é”™è¯¯æ—¶äº§ç”Ÿçš„å¼‚å¸¸
# å…¸å‹çš„MCEé”™è¯¯ä¿¡æ¯ï¼š
# [12345.678] mce: CPU 2: Machine Check Exception: 4 Bank 1: b200000000070f0f
```

**ğŸ“‹ CPUé”™è¯¯ç±»å‹è§£è¯»**

| é”™è¯¯ç±»å‹ | **MCEä¿¡æ¯ç‰¹å¾** | **å¯èƒ½åŸå› ** | **å¤„ç†å»ºè®®** |
|---------|---------------|-------------|-------------|
| ğŸŒ¡ï¸ **è¿‡çƒ­** | `THERMAL ERROR` | `æ•£çƒ­ä¸è‰¯ï¼Œé£æ‰‡æ•…éšœ` | `æ£€æŸ¥æ•£çƒ­ç³»ç»Ÿ` |
| âš¡ **ç”µå‹** | `VOLTAGE ERROR` | `ç”µæºä¸ç¨³å®š` | `æ£€æŸ¥ç”µæºä¾›åº”` |
| ğŸ’¾ **ç¼“å­˜** | `CACHE ERROR` | `CPUç¼“å­˜æŸå` | `å¯èƒ½éœ€è¦æ›´æ¢CPU` |
| ğŸ”„ **æ€»çº¿** | `BUS ERROR` | `CPUä¸å†…å­˜é€šä¿¡é—®é¢˜` | `æ£€æŸ¥ä¸»æ¿å’Œå†…å­˜` |

### 9.3 å†…å­˜ç›¸å…³ç¡¬ä»¶æ•…éšœ


**ğŸ’¾ å†…å­˜æ•…éšœçš„è¯Šæ–­**

```bash
# æŸ¥çœ‹å†…å­˜ç¡¬ä»¶é”™è¯¯
dmesg | grep -i "edac\|ecc"

# EDAC (Error Detection and Correction) é”™è¯¯ç¤ºä¾‹ï¼š
# EDAC MC0: CE row 2, channel 1, label "DIMM_B1": 1 Unknown error(s)
```

**ğŸ” å†…å­˜æµ‹è¯•å·¥å…·**

```bash
# ä½¿ç”¨memtest86+æµ‹è¯•å†…å­˜
# éœ€è¦åˆ¶ä½œå¯åŠ¨ç›˜ï¼Œåœ¨ç³»ç»Ÿå¯åŠ¨å‰æµ‹è¯•

# åœ¨Linuxç³»ç»Ÿä¸­æµ‹è¯•å†…å­˜
# æ³¨æ„ï¼šè¿™äº›æµ‹è¯•å¯èƒ½å½±å“ç³»ç»Ÿç¨³å®šæ€§
echo 1 > /proc/sys/vm/drop_caches    # æ¸…ç†ç¼“å­˜
echo 2 > /proc/sys/vm/drop_caches    # æ¸…ç†inodeç¼“å­˜
echo 3 > /proc/sys/vm/drop_caches    # æ¸…ç†æ‰€æœ‰ç¼“å­˜
```

### 9.4 å­˜å‚¨è®¾å¤‡ç¡¬ä»¶æ•…éšœ


**ğŸ’¿ ç¡¬ç›˜æ•…éšœåˆ†æ**

```bash
# æŸ¥çœ‹ç¡¬ç›˜SMARTä¿¡æ¯
smartctl -a /dev/sda | grep -i "error\|fail"

# æŸ¥çœ‹ç¡¬ç›˜IOé”™è¯¯
dmesg | grep -i "ata\|scsi.*error"

# å…¸å‹çš„ç¡¬ç›˜é”™è¯¯ä¿¡æ¯ï¼š
# ata1.00: exception Emask 0x0 SAct 0x0 SErr 0x0 action 0x6 frozen
# ata1.00: failed command: READ DMA EXT
```

**ğŸ”§ å­˜å‚¨æ•…éšœçš„è½¬å‚¨ç‰¹å¾**

| æ•…éšœç±»å‹ | **æ—¥å¿—ç‰¹å¾** | **è½¬å‚¨ç‰¹ç‚¹** | **å½±å“** |
|---------|-------------|-------------|---------|
| ğŸ”´ **ç¡¬ç›˜åé“** | `READ/WRITE ERROR` | `IOæ“ä½œhangæœº` | `æ–‡ä»¶ç³»ç»ŸæŸå` |
| ğŸ“¡ **æ¥å£æ•…éšœ** | `SATA/SCSI ERROR` | `è®¾å¤‡æ–­å¼€é‡è¿` | `æ•°æ®ä¼ è¾“ä¸­æ–­` |
| âš¡ **ç”µæºé—®é¢˜** | `POWER-ON RESET` | `éšæœºè®¾å¤‡æ‰çº¿` | `æ•°æ®ä¸¢å¤±é£é™©` |

### 9.5 ç½‘ç»œç¡¬ä»¶æ•…éšœ


**ğŸŒ ç½‘ç»œè®¾å¤‡æ•…éšœåˆ†æ**

```bash
# æŸ¥çœ‹ç½‘ç»œç¡¬ä»¶é”™è¯¯
dmesg | grep -i "eth\|net.*error"

# æ£€æŸ¥ç½‘ç»œæ¥å£é”™è¯¯è®¡æ•°
cat /proc/net/dev
# å…³æ³¨ï¼šerrorsã€droppedã€fifoã€frameç­‰é”™è¯¯è®¡æ•°

# æŸ¥çœ‹ç½‘å¡ç¡¬ä»¶ä¿¡æ¯
ethtool -i eth0             # é©±åŠ¨ä¿¡æ¯
ethtool -S eth0             # ç¡¬ä»¶ç»Ÿè®¡
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ” æ ¸å¿ƒè½¬å‚¨æœ¬è´¨ï¼šç³»ç»Ÿå´©æºƒæ—¶å†…å­˜çŠ¶æ€çš„"å¿«ç…§"ï¼Œç”¨äºäº‹ååˆ†æ
ğŸ› ï¸ coredumpctlï¼šsystemdæä¾›çš„è½¬å‚¨ç®¡ç†å·¥å…·ï¼Œç»Ÿä¸€ç®¡ç†æ‰€æœ‰è½¬å‚¨
ğŸ’¥ kernel panicï¼šå†…æ ¸é‡åˆ°ä¸¥é‡é”™è¯¯æ—¶çš„"è‡ªæ€"ä¿æŠ¤æœºåˆ¶
ğŸ“ kdumpï¼šä¸“é—¨æ•è·å†…æ ¸å´©æºƒçŠ¶æ€çš„å·¥å…·å’Œæœºåˆ¶
ğŸ”¬ crashï¼šä¸“ä¸šçš„å†…æ ¸è½¬å‚¨åˆ†æå·¥å…·ï¼Œæ ¸å¿ƒè°ƒè¯•åˆ©å™¨
ğŸ”„ hangæœºè¯Šæ–­ï¼šç³»ç»Ÿ"å¡æ­»"çŠ¶æ€çš„åˆ†æå’Œå¤„ç†æ–¹æ³•
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ è½¬å‚¨ç±»å‹çš„åŒºåˆ«**
```
ç”¨æˆ·ç¨‹åºè½¬å‚¨ï¼š
- å•ä¸ªç¨‹åºå´©æºƒï¼Œå½±å“èŒƒå›´å°
- ä½¿ç”¨ coredumpctl ç®¡ç†
- é€šå¸¸å®¹æ˜“ä¿®å¤

å†…æ ¸è½¬å‚¨ï¼š
- æ•´ä¸ªç³»ç»Ÿå´©æºƒï¼Œå½±å“èŒƒå›´å¤§
- ä½¿ç”¨ kdump æ•è·
- éœ€è¦ä¸“ä¸šå·¥å…·åˆ†æ
```

**ğŸ”¹ åˆ†æå·¥å…·çš„é€‰æ‹©**
```
é—®é¢˜ç±»å‹                æ¨èå·¥å…·
â”œâ”€â”€ ç”¨æˆ·ç¨‹åºå´©æºƒ  â†’    coredumpctl + gdb
â”œâ”€â”€ å†…æ ¸å´©æºƒ      â†’    crash + vmcore
â”œâ”€â”€ ç³»ç»Ÿhangæœº    â†’    Magic SysRq + /proc
â””â”€â”€ ç¡¬ä»¶æ•…éšœ      â†’    dmesg + ç¡¬ä»¶æ£€æµ‹å·¥å…·
```

**ğŸ”¹ æ•…éšœåˆ†æçš„æ€è·¯**
```
1. æ”¶é›†ç°è±¡ï¼šé”™è¯¯ä¿¡æ¯ã€é‡ç°æ¡ä»¶ã€å½±å“èŒƒå›´
2. æŸ¥çœ‹æ—¥å¿—ï¼šdmesgã€/var/log/messagesã€è½¬å‚¨æ–‡ä»¶
3. åˆ†æè½¬å‚¨ï¼šä½¿ç”¨crashå·¥å…·æ·±å…¥åˆ†æå´©æºƒç°åœº
4. ç¡®å®šåŸå› ï¼šè½¯ä»¶bugã€ç¡¬ä»¶æ•…éšœã€é…ç½®é—®é¢˜
5. åˆ¶å®šæ–¹æ¡ˆï¼šä¿®å¤ä»£ç ã€æ›´æ¢ç¡¬ä»¶ã€è°ƒæ•´é…ç½®
```

### 10.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ æ—¥å¸¸è¿ç»´ä¸­çš„åº”ç”¨**

- **ğŸ” é—®é¢˜æ’æŸ¥**ï¼šé€šè¿‡è½¬å‚¨æ–‡ä»¶å¿«é€Ÿå®šä½å´©æºƒåŸå› 
- **ğŸ“Š ç³»ç»Ÿç›‘æ§**ï¼šç›‘æ§è½¬å‚¨æ–‡ä»¶çš„äº§ç”Ÿé¢‘ç‡å’Œç±»å‹
- **ğŸ› ï¸ æ•…éšœé¢„é˜²**ï¼šé€šè¿‡åˆ†æè½¬å‚¨æ–‡ä»¶å‘ç°æ½œåœ¨é—®é¢˜
- **ğŸ“š çŸ¥è¯†ç§¯ç´¯**ï¼šå»ºç«‹æ•…éšœæ¡ˆä¾‹åº“ï¼Œæé«˜å¤„ç†æ•ˆç‡

**âš ï¸ æ³¨æ„äº‹é¡¹**

> ğŸ’¡ **é‡è¦æé†’**  
> - è½¬å‚¨æ–‡ä»¶å¯èƒ½å¾ˆå¤§ï¼Œæ³¨æ„ç£ç›˜ç©ºé—´
> - ç”Ÿæˆè½¬å‚¨æ—¶ç³»ç»Ÿä¼šé‡å¯ï¼Œé€‰æ‹©åˆé€‚æ—¶æœº
> - æ•æ„Ÿä¿¡æ¯å¯èƒ½åŒ…å«åœ¨è½¬å‚¨ä¸­ï¼Œæ³¨æ„å®‰å…¨
> - å®šæœŸæ¸…ç†æ—§çš„è½¬å‚¨æ–‡ä»¶ï¼Œé¿å…å ç”¨è¿‡å¤šç©ºé—´

**ğŸ”§ æœ€ä½³å®è·µ**

```bash
# 1. é…ç½®åˆç†çš„è½¬å‚¨ç­–ç•¥
echo 'kernel.core_pattern=|/usr/lib/systemd/systemd-coredump %P %u %g %s %t %c %h %e' > /etc/sysctl.d/50-coredump.conf

# 2. è®¾ç½®è½¬å‚¨æ–‡ä»¶è‡ªåŠ¨æ¸…ç†
systemctl edit systemd-coredump@.service
# æ·»åŠ æ¸…ç†ç­–ç•¥

# 3. ç›‘æ§è½¬å‚¨æ–‡ä»¶äº§ç”Ÿ
coredumpctl list --since="1 hour ago"

# 4. å»ºç«‹åˆ†ææµç¨‹
# å‘ç°è½¬å‚¨ â†’ ä¿å­˜ç°åœº â†’ crashåˆ†æ â†’ è®°å½•ç»“è®º â†’ ä¿®å¤é—®é¢˜
```

### 10.4 å­¦ä¹ è·¯å¾„å»ºè®®


```
åˆçº§é˜¶æ®µï¼š
âœ… ç†è§£æ ¸å¿ƒè½¬å‚¨çš„åŸºæœ¬æ¦‚å¿µ
âœ… æŒæ¡ coredumpctl åŸºæœ¬ä½¿ç”¨
âœ… å­¦ä¼šæŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—

ä¸­çº§é˜¶æ®µï¼š
âœ… é…ç½®å’Œä½¿ç”¨ kdump
âœ… æŒæ¡ crash å·¥å…·åŸºæœ¬å‘½ä»¤
âœ… èƒ½å¤Ÿåˆ†æç®€å•çš„å´©æºƒé—®é¢˜

é«˜çº§é˜¶æ®µï¼š
âœ… æ·±å…¥ç†è§£å†…æ ¸è°ƒè¯•åŸç†
âœ… ç†Ÿç»ƒä½¿ç”¨ crash é«˜çº§åŠŸèƒ½
âœ… èƒ½å¤Ÿå¤„ç†å¤æ‚çš„ç¡¬ä»¶æ•…éšœ
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- ç¨‹åºå´©æºƒç•™è½¬å‚¨ï¼Œcoredumpctlæ¥ç®¡ç†
- å†…æ ¸ææ…Œç”¨kdumpï¼Œcrashå·¥å…·ç»†åˆ†æ  
- ç³»ç»ŸhangæœºæŸ¥/procï¼ŒMagic SysRqæ˜¾ç¥å¨
- ç¡¬ä»¶æ•…éšœçœ‹æ—¥å¿—ï¼Œdmesgé‡Œæ‰¾çº¿ç´¢
- è½¬å‚¨åˆ†ææœ‰ç« æ³•ï¼Œè°ƒç”¨æ ˆé‡Œæ‰¾çœŸç›¸