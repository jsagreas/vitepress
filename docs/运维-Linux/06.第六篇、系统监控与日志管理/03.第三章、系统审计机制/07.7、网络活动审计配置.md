---
title: 7ã€ç½‘ç»œæ´»åŠ¨å®¡è®¡é…ç½®
---
## ğŸ“š ç›®å½•

1. [ç½‘ç»œæ´»åŠ¨å®¡è®¡åŸºç¡€æ¦‚å¿µ](#1-ç½‘ç»œæ´»åŠ¨å®¡è®¡åŸºç¡€æ¦‚å¿µ)
2. [ç½‘ç»œè¿æ¥å»ºç«‹å®¡è®¡](#2-ç½‘ç»œè¿æ¥å»ºç«‹å®¡è®¡)
3. [ç«¯å£ç›‘å¬æ“ä½œå®¡è®¡](#3-ç«¯å£ç›‘å¬æ“ä½œå®¡è®¡)
4. [é˜²ç«å¢™è§„åˆ™å˜æ›´å®¡è®¡](#4-é˜²ç«å¢™è§„åˆ™å˜æ›´å®¡è®¡)
5. [ç½‘ç»œé…ç½®ä¿®æ”¹å®¡è®¡](#5-ç½‘ç»œé…ç½®ä¿®æ”¹å®¡è®¡)
6. [Socketæ“ä½œå®¡è®¡](#6-socketæ“ä½œå®¡è®¡)
7. [ç½‘ç»œæœåŠ¡å¯åœå®¡è®¡](#7-ç½‘ç»œæœåŠ¡å¯åœå®¡è®¡)
8. [å¼‚å¸¸ç½‘ç»œè¡Œä¸ºç›‘æ§](#8-å¼‚å¸¸ç½‘ç»œè¡Œä¸ºç›‘æ§)
9. [ç½‘ç»œå®‰å…¨äº‹ä»¶å®¡è®¡](#9-ç½‘ç»œå®‰å…¨äº‹ä»¶å®¡è®¡)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ ç½‘ç»œæ´»åŠ¨å®¡è®¡åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯ç½‘ç»œæ´»åŠ¨å®¡è®¡


**ç®€å•ç†è§£**ï¼šç½‘ç»œæ´»åŠ¨å®¡è®¡å°±åƒç»™ä½ çš„Linuxç³»ç»Ÿè£…äº†ä¸€ä¸ª"ç½‘ç»œè¡Œä¸ºè®°å½•ä»ª"ï¼Œä¸“é—¨è®°å½•ç³»ç»Ÿçš„å„ç§ç½‘ç»œæ“ä½œå’Œè¿æ¥æ´»åŠ¨ã€‚

```
ç”Ÿæ´»ç±»æ¯”ï¼š
ç½‘ç»œå®¡è®¡ = å°åŒºé—¨å«çš„ç™»è®°å†Œ
è®°å½•å†…å®¹ï¼š
- è°è¿›æ¥äº†ï¼ˆè¿æ¥å»ºç«‹ï¼‰
- è°å‡ºå»äº†ï¼ˆè¿æ¥æ–­å¼€ï¼‰  
- å¼€äº†å“ªäº›é—¨ï¼ˆç«¯å£ç›‘å¬ï¼‰
- é—¨ç¦è§„åˆ™æ”¹åŠ¨ï¼ˆé˜²ç«å¢™å˜æ›´ï¼‰
```

**æ ¸å¿ƒä½œç”¨**ï¼š
- ğŸ” **å®‰å…¨ç›‘æ§**ï¼šå‘ç°å¯ç–‘ç½‘ç»œè¿æ¥å’Œæ”»å‡»è¡Œä¸º
- ğŸ“Š **åˆè§„å®¡æŸ¥**ï¼šæ»¡è¶³ä¼ä¸šå’Œæ³•è§„çš„å®¡è®¡è¦æ±‚
- ğŸ”§ **æ•…éšœæ’æŸ¥**ï¼šåˆ†æç½‘ç»œé—®é¢˜çš„æ ¹æœ¬åŸå› 
- ğŸ“ **è¡Œä¸ºåˆ†æ**ï¼šäº†è§£ç³»ç»Ÿç½‘ç»œä½¿ç”¨æ¨¡å¼

### 1.2 å®¡è®¡çš„ç½‘ç»œæ´»åŠ¨ç±»å‹


```
ç½‘ç»œæ´»åŠ¨å®¡è®¡è¦†ç›–èŒƒå›´ï¼š

è¿æ¥å±‚é¢ï¼š
â”œâ”€â”€ TCPè¿æ¥å»ºç«‹/æ–­å¼€
â”œâ”€â”€ UDPæ•°æ®ä¼ è¾“
â”œâ”€â”€ ç½‘ç»œsocketåˆ›å»º/å…³é—­
â””â”€â”€ ç«¯å£ç»‘å®šå’Œç›‘å¬

é…ç½®å±‚é¢ï¼š
â”œâ”€â”€ IPåœ°å€ä¿®æ”¹
â”œâ”€â”€ è·¯ç”±è¡¨å˜æ›´
â”œâ”€â”€ é˜²ç«å¢™è§„åˆ™è°ƒæ•´
â””â”€â”€ ç½‘ç»œæ¥å£çŠ¶æ€æ”¹å˜

æœåŠ¡å±‚é¢ï¼š
â”œâ”€â”€ ç½‘ç»œæœåŠ¡å¯åŠ¨/åœæ­¢
â”œâ”€â”€ æœåŠ¡é…ç½®æ–‡ä»¶ä¿®æ”¹
â”œâ”€â”€ æœåŠ¡æƒé™å˜æ›´
â””â”€â”€ æœåŠ¡å¼‚å¸¸è¡Œä¸º
```

### 1.3 å®¡è®¡æœºåˆ¶å·¥ä½œåŸç†


**å·¥ä½œæµç¨‹å›¾**ï¼š
```
åº”ç”¨ç¨‹åº â†’ ç³»ç»Ÿè°ƒç”¨ â†’ å†…æ ¸ç½‘ç»œæ ˆ â†’ auditdç›‘æ§ â†’ æ—¥å¿—è®°å½•

è¯¦ç»†è¿‡ç¨‹ï¼š
[åº”ç”¨] å‘èµ·ç½‘ç»œè¯·æ±‚
   â†“
[å†…æ ¸] å¤„ç†socketç³»ç»Ÿè°ƒç”¨
   â†“  
[audit] æ•è·ç½‘ç»œç›¸å…³è°ƒç”¨
   â†“
[auditd] æ ¼å¼åŒ–å¹¶è®°å½•æ—¥å¿—
   â†“
[æ—¥å¿—] å­˜å‚¨åˆ° /var/log/audit/
```

---

## 2. ğŸ”— ç½‘ç»œè¿æ¥å»ºç«‹å®¡è®¡


### 2.1 è¿æ¥å®¡è®¡çš„é‡è¦æ€§


**ä¸ºä»€ä¹ˆè¦å®¡è®¡ç½‘ç»œè¿æ¥**ï¼š
- ğŸš¨ **å®‰å…¨å¨èƒæ£€æµ‹**ï¼šè¯†åˆ«æ¶æ„è¿æ¥å’Œç½‘ç»œæ”»å‡»
- ğŸ“Š **æµé‡åˆ†æ**ï¼šäº†è§£ç½‘ç»œä½¿ç”¨æƒ…å†µå’Œæ¨¡å¼
- ğŸ” **å¼‚å¸¸å‘ç°**ï¼šå‘ç°ä¸æ­£å¸¸çš„è¿æ¥è¡Œä¸º
- ğŸ“ **åˆè§„è®°å½•**ï¼šæ»¡è¶³å®‰å…¨å®¡è®¡è¦æ±‚

### 2.2 TCPè¿æ¥å®¡è®¡é…ç½®


**åŸºç¡€é…ç½®è§„åˆ™**ï¼š
```bash
# å®¡è®¡TCPè¿æ¥å»ºç«‹
-a always,exit -F arch=b64 -S connect -k tcp_connect
-a always,exit -F arch=b32 -S connect -k tcp_connect

# å®¡è®¡TCPæœåŠ¡å™¨å¥—æ¥å­—
-a always,exit -F arch=b64 -S accept -k tcp_accept  
-a always,exit -F arch=b32 -S accept -k tcp_accept

# å®¡è®¡socketåˆ›å»º
-a always,exit -F arch=b64 -S socket -k socket_create
-a always,exit -F arch=b32 -S socket -k socket_create
```

**é…ç½®å«ä¹‰è§£é‡Š**ï¼š
- `connect`ï¼šç›‘æ§å®¢æˆ·ç«¯ä¸»åŠ¨å‘èµ·çš„è¿æ¥
- `accept`ï¼šç›‘æ§æœåŠ¡å™¨æ¥å—çš„è¿æ¥è¯·æ±‚
- `socket`ï¼šç›‘æ§socketçš„åˆ›å»ºæ“ä½œ
- `arch=b64/b32`ï¼šåˆ†åˆ«å¯¹åº”64ä½å’Œ32ä½ç³»ç»Ÿæ¶æ„

### 2.3 ç‰¹å®šç«¯å£è¿æ¥å®¡è®¡


**ç›‘æ§é‡è¦ç«¯å£è¿æ¥**ï¼š
```bash
# å®¡è®¡SSHè¿æ¥ï¼ˆ22ç«¯å£ï¼‰
-a always,exit -F arch=b64 -S connect -F a2=0x16 -k ssh_connect

# å®¡è®¡HTTP/HTTPSè¿æ¥ï¼ˆ80/443ç«¯å£ï¼‰
-a always,exit -F arch=b64 -S connect -F a2=0x50 -k http_connect
-a always,exit -F arch=b64 -S connect -F a2=0x1bb -k https_connect

# å®¡è®¡æ•°æ®åº“è¿æ¥ï¼ˆ3306ç«¯å£MySQLï¼‰
-a always,exit -F arch=b64 -S connect -F a2=0xcea -k mysql_connect
```

> ğŸ’¡ **æç¤º**ï¼šç«¯å£å·éœ€è¦è½¬æ¢ä¸ºåå…­è¿›åˆ¶æ ¼å¼
> - 22ç«¯å£ = 0x16
> - 80ç«¯å£ = 0x50  
> - 443ç«¯å£ = 0x1bb
> - 3306ç«¯å£ = 0xcea

### 2.4 è¿æ¥å®¡è®¡æ—¥å¿—åˆ†æ


**å…¸å‹æ—¥å¿—æ ¼å¼**ï¼š
```
type=SYSCALL msg=audit(1694764800.123:456): arch=c000003e syscall=42 
success=yes exit=0 a0=3 a1=7fffd8b2c1a0 a2=10 a3=0 
items=0 ppid=1234 pid=5678 auid=1000 uid=1000 gid=1000 
euid=1000 suid=1000 fsuid=1000 egid=1000 sgid=1000 fsgid=1000 
tty=pts0 ses=1 comm="ssh" exe="/usr/bin/ssh" key="tcp_connect"
```

**æ—¥å¿—å…³é”®å­—æ®µè§£é‡Š**ï¼š
| å­—æ®µ | å«ä¹‰ | ç¤ºä¾‹å€¼ |
|------|------|--------|
| `syscall=42` | ç³»ç»Ÿè°ƒç”¨å·ï¼ˆconnectï¼‰ | 42 |
| `success=yes` | æ“ä½œæ˜¯å¦æˆåŠŸ | yes/no |
| `pid=5678` | è¿›ç¨‹ID | 5678 |
| `comm="ssh"` | è¿›ç¨‹åç§° | ssh |
| `exe="/usr/bin/ssh"` | å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ | /usr/bin/ssh |
| `key="tcp_connect"` | å®¡è®¡è§„åˆ™æ ‡è¯† | tcp_connect |

---

## 3. ğŸ”Œ ç«¯å£ç›‘å¬æ“ä½œå®¡è®¡


### 3.1 ç«¯å£ç›‘å¬å®¡è®¡é…ç½®


**ç›‘å¬æ“ä½œå®¡è®¡è§„åˆ™**ï¼š
```bash
# å®¡è®¡bindç³»ç»Ÿè°ƒç”¨ï¼ˆç«¯å£ç»‘å®šï¼‰
-a always,exit -F arch=b64 -S bind -k port_bind
-a always,exit -F arch=b32 -S bind -k port_bind

# å®¡è®¡listenç³»ç»Ÿè°ƒç”¨ï¼ˆå¼€å§‹ç›‘å¬ï¼‰
-a always,exit -F arch=b64 -S listen -k port_listen
-a always,exit -F arch=b32 -S listen -k port_listen

# å®¡è®¡socketé€‰é¡¹è®¾ç½®
-a always,exit -F arch=b64 -S setsockopt -k socket_option
-a always,exit -F arch=b32 -S setsockopt -k socket_option
```

### 3.2 ç‰¹æƒç«¯å£ç›‘å¬å®¡è®¡


**ç›‘æ§ç‰¹æƒç«¯å£ï¼ˆ1-1024ï¼‰**ï¼š
```bash
# å®¡è®¡ç‰¹æƒç«¯å£ç»‘å®š
-a always,exit -F arch=b64 -S bind -F a1_type=sockaddr -F a1&0x2=0x2 -F a1&0xFFFF<=0x400 -k privileged_port

# ç›‘æ§å¸¸è§æœåŠ¡ç«¯å£
-a always,exit -F arch=b64 -S bind -F a2=0x16 -k ssh_bind     # SSH (22)
-a always,exit -F arch=b64 -S bind -F a2=0x50 -k http_bind    # HTTP (80)  
-a always,exit -F arch=b64 -S bind -F a2=0x1bb -k https_bind  # HTTPS (443)
```

### 3.3 ç›‘å¬çŠ¶æ€å˜åŒ–ç›‘æ§


**æœåŠ¡å¯åœç›‘æ§**ï¼š
```bash
# ç›‘æ§ç½‘ç»œæœåŠ¡é…ç½®æ–‡ä»¶å˜æ›´
-w /etc/systemd/system/ -p wa -k service_config
-w /etc/nginx/ -p wa -k nginx_config
-w /etc/apache2/ -p wa -k apache_config
-w /etc/ssh/sshd_config -p wa -k ssh_config

# ç›‘æ§æœåŠ¡æ§åˆ¶å‘½ä»¤
-a always,exit -F arch=b64 -S execve -F path=/bin/systemctl -k service_control
-a always,exit -F arch=b64 -S execve -F path=/usr/bin/systemctl -k service_control
```

### 3.4 ç«¯å£ç›‘å¬å¼‚å¸¸æ£€æµ‹


**å¼‚å¸¸ç›‘å¬è¡Œä¸ºç‰¹å¾**ï¼š

| å¼‚å¸¸ç±»å‹ | ç‰¹å¾æè¿° | å®¡è®¡å…³æ³¨ç‚¹ |
|----------|----------|------------|
| ğŸš¨ **æœªæˆæƒç«¯å£** | ç»‘å®šä¸åº”è¯¥ä½¿ç”¨çš„ç«¯å£ | ç‰¹æƒç«¯å£ç»‘å®š |
| âš ï¸ **å¼‚å¸¸è¿›ç¨‹** | éé¢„æœŸè¿›ç¨‹ç›‘å¬ç«¯å£ | è¿›ç¨‹åç§°å’Œè·¯å¾„ |
| ğŸ”¥ **é¢‘ç¹ç»‘å®š** | çŸ­æ—¶é—´å†…å¤§é‡ç«¯å£æ“ä½œ | æ“ä½œé¢‘ç‡ç»Ÿè®¡ |
| ğŸ’¥ **æƒé™æå‡** | æ™®é€šç”¨æˆ·ç»‘å®šç‰¹æƒç«¯å£ | ç”¨æˆ·æƒé™æ£€æŸ¥ |

---

## 4. ğŸ›¡ï¸ é˜²ç«å¢™è§„åˆ™å˜æ›´å®¡è®¡


### 4.1 é˜²ç«å¢™å®¡è®¡çš„é‡è¦æ€§


**ä¸ºä»€ä¹ˆå®¡è®¡é˜²ç«å¢™å˜æ›´**ï¼š
- ğŸ”’ **å®‰å…¨ç­–ç•¥ä¿æŠ¤**ï¼šé˜²æ­¢æœªæˆæƒçš„è§„åˆ™ä¿®æ”¹
- ğŸ“Š **å˜æ›´è¿½è¸ª**ï¼šè®°å½•æ‰€æœ‰é˜²ç«å¢™é…ç½®å˜åŒ–
- ğŸ” **é—®é¢˜æ’æŸ¥**ï¼šå¿«é€Ÿå®šä½ç½‘ç»œé—®é¢˜åŸå› 
- ğŸ“ **åˆè§„è¦æ±‚**ï¼šæ»¡è¶³å®‰å…¨å®¡è®¡æ ‡å‡†

### 4.2 iptablesè§„åˆ™å˜æ›´å®¡è®¡


**ç›‘æ§iptableså‘½ä»¤æ‰§è¡Œ**ï¼š
```bash
# å®¡è®¡iptableså‘½ä»¤æ‰§è¡Œ
-a always,exit -F arch=b64 -S execve -F path=/sbin/iptables -k firewall_change
-a always,exit -F arch=b64 -S execve -F path=/usr/sbin/iptables -k firewall_change

# å®¡è®¡iptables-saveå’Œrestore
-a always,exit -F arch=b64 -S execve -F path=/sbin/iptables-save -k firewall_backup
-a always,exit -F arch=b64 -S execve -F path=/sbin/iptables-restore -k firewall_restore

# å®¡è®¡netfilterç›¸å…³ç³»ç»Ÿè°ƒç”¨
-a always,exit -F arch=b64 -S setsockopt -F a0&0x3=0x3 -k netfilter_change
```

### 4.3 é˜²ç«å¢™é…ç½®æ–‡ä»¶ç›‘æ§


**æ–‡ä»¶ç³»ç»Ÿç›‘æ§**ï¼š
```bash
# ç›‘æ§iptablesè§„åˆ™æ–‡ä»¶
-w /etc/iptables/rules.v4 -p wa -k iptables_rules
-w /etc/iptables/rules.v6 -p wa -k iptables6_rules

# ç›‘æ§é˜²ç«å¢™æœåŠ¡é…ç½®
-w /etc/systemd/system/iptables.service -p wa -k iptables_service
-w /etc/default/iptables -p wa -k iptables_default

# ç›‘æ§ufwé˜²ç«å¢™ï¼ˆUbuntuï¼‰
-w /etc/ufw/ -p wa -k ufw_config
-w /usr/sbin/ufw -p x -k ufw_command
```

### 4.4 firewalldå®¡è®¡é…ç½®


**ç›‘æ§firewalldæ“ä½œ**ï¼š
```bash
# å®¡è®¡firewall-cmdå‘½ä»¤
-a always,exit -F arch=b64 -S execve -F path=/usr/bin/firewall-cmd -k firewalld_cmd

# ç›‘æ§firewalldé…ç½®æ–‡ä»¶
-w /etc/firewalld/ -p wa -k firewalld_config
-w /usr/lib/firewalld/ -p wa -k firewalld_system

# ç›‘æ§zoneé…ç½®å˜æ›´
-w /etc/firewalld/zones/ -p wa -k firewalld_zones
-w /etc/firewalld/services/ -p wa -k firewalld_services
```

---

## 5. âš™ï¸ ç½‘ç»œé…ç½®ä¿®æ”¹å®¡è®¡


### 5.1 ç½‘ç»œæ¥å£é…ç½®å®¡è®¡


**ç›‘æ§ç½‘ç»œæ¥å£å˜æ›´**ï¼š
```bash
# ç›‘æ§ç½‘ç»œé…ç½®æ–‡ä»¶
-w /etc/network/interfaces -p wa -k network_config
-w /etc/netplan/ -p wa -k netplan_config
-w /etc/sysconfig/network-scripts/ -p wa -k network_scripts

# ç›‘æ§IPé…ç½®å‘½ä»¤
-a always,exit -F arch=b64 -S execve -F path=/sbin/ip -k ip_command
-a always,exit -F arch=b64 -S execve -F path=/sbin/ifconfig -k ifconfig_command
```

### 5.2 è·¯ç”±è¡¨å˜æ›´å®¡è®¡


**è·¯ç”±é…ç½®ç›‘æ§**ï¼š
```bash
# å®¡è®¡routeå‘½ä»¤
-a always,exit -F arch=b64 -S execve -F path=/sbin/route -k route_change

# ç›‘æ§è·¯ç”±è¡¨æ–‡ä»¶
-w /etc/iproute2/rt_tables -p wa -k route_tables
-w /proc/sys/net/ipv4/ip_forward -p wa -k ip_forward

# å®¡è®¡è·¯ç”±ç›¸å…³ç³»ç»Ÿè°ƒç”¨
-a always,exit -F arch=b64 -S socket -F a0=16 -k netlink_route
```

### 5.3 DNSé…ç½®å®¡è®¡


**DNSè®¾ç½®ç›‘æ§**ï¼š
```bash
# ç›‘æ§DNSé…ç½®æ–‡ä»¶
-w /etc/resolv.conf -p wa -k dns_config
-w /etc/hosts -p wa -k hosts_file
-w /etc/nsswitch.conf -p wa -k nsswitch_config

# ç›‘æ§DNSæœåŠ¡é…ç½®
-w /etc/bind/ -p wa -k bind_config
-w /etc/named.conf -p wa -k named_config
```

### 5.4 ç½‘ç»œé…ç½®å®¡è®¡æ—¥å¿—åˆ†æ


**é…ç½®å˜æ›´æ—¥å¿—ç¤ºä¾‹**ï¼š
```
type=PATH msg=audit(1694764800.456:789): item=0 name="/etc/network/interfaces" 
inode=123456 dev=08:01 mode=0100644 ouid=0 ogid=0 rdev=00:00 
nametype=NORMAL cap_fp=0000000000000000 cap_fi=0000000000000000 cap_fe=0 cap_fver=0

type=SYSCALL msg=audit(1694764800.456:789): arch=c000003e syscall=2 
success=yes exit=3 a0=55a1b2c3d4e0 a1=241 a2=1b6 a3=0 
items=1 ppid=1234 pid=5678 auid=1000 uid=0 gid=0 
euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 
tty=pts0 ses=1 comm="nano" exe="/usr/bin/nano" key="network_config"
```

**åˆ†æè¦ç‚¹**ï¼š
- ğŸ“ **å˜æ›´æ–‡ä»¶**ï¼š`/etc/network/interfaces`
- ğŸ‘¤ **æ“ä½œç”¨æˆ·**ï¼š`auid=1000`ï¼ˆå®é™…ç”¨æˆ·ï¼‰
- ğŸ”§ **ä½¿ç”¨å·¥å…·**ï¼š`nano`ç¼–è¾‘å™¨
- â° **å˜æ›´æ—¶é—´**ï¼šå®¡è®¡æ—¶é—´æˆ³

---

## 6. ğŸ”Œ Socketæ“ä½œå®¡è®¡


### 6.1 Socketå®¡è®¡åŸºç¡€æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯Socketæ“ä½œå®¡è®¡**ï¼š
Socketæ˜¯ç½‘ç»œé€šä¿¡çš„åŸºç¡€æ¥å£ï¼Œå®¡è®¡Socketæ“ä½œå¯ä»¥ç›‘æ§æ‰€æœ‰ç½‘ç»œæ´»åŠ¨çš„åº•å±‚è¡Œä¸ºã€‚

```
Socketæ“ä½œç”Ÿå‘½å‘¨æœŸï¼š
åˆ›å»º â†’ ç»‘å®š â†’ ç›‘å¬/è¿æ¥ â†’ æ•°æ®ä¼ è¾“ â†’ å…³é—­

socket() â†’ bind() â†’ listen()/connect() â†’ send()/recv() â†’ close()
   â†“        â†“           â†“                    â†“           â†“
 åˆ›å»ºç›‘æ§  ç«¯å£ç›‘æ§    è¿æ¥ç›‘æ§           æ•°æ®ç›‘æ§      å…³é—­ç›‘æ§
```

### 6.2 Socketç³»ç»Ÿè°ƒç”¨å®¡è®¡


**å®Œæ•´Socketæ“ä½œå®¡è®¡**ï¼š
```bash
# Socketåˆ›å»ºå’Œå…³é—­
-a always,exit -F arch=b64 -S socket -k socket_create
-a always,exit -F arch=b64 -S close -F a0_type=socket -k socket_close

# Socketç»‘å®šå’Œè¿æ¥
-a always,exit -F arch=b64 -S bind -k socket_bind
-a always,exit -F arch=b64 -S connect -k socket_connect
-a always,exit -F arch=b64 -S listen -k socket_listen
-a always,exit -F arch=b64 -S accept -k socket_accept

# Socketæ•°æ®ä¼ è¾“
-a always,exit -F arch=b64 -S sendto -k socket_send
-a always,exit -F arch=b64 -S recvfrom -k socket_recv
-a always,exit -F arch=b64 -S sendmsg -k socket_sendmsg
-a always,exit -F arch=b64 -S recvmsg -k socket_recvmsg
```

### 6.3 ç‰¹å®šåè®®Socketå®¡è®¡


**æŒ‰åè®®ç±»å‹ç›‘æ§**ï¼š
```bash
# TCP Socketç›‘æ§
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=1 -k tcp_socket

# UDP Socketç›‘æ§  
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=2 -k udp_socket

# UnixåŸŸSocketç›‘æ§
-a always,exit -F arch=b64 -S socket -F a0=1 -k unix_socket

# åŸå§‹Socketç›‘æ§ï¼ˆéœ€è¦ç‰¹æƒï¼‰
-a always,exit -F arch=b64 -S socket -F a0=2 -F a1=3 -k raw_socket
```

**åè®®å‚æ•°è¯´æ˜**ï¼š
| å‚æ•° | å«ä¹‰ | å€¼ |
|------|------|-----|
| `a0=2` | åœ°å€æ—AF_INET | IPv4 |
| `a1=1` | å¥—æ¥å­—ç±»å‹SOCK_STREAM | TCP |
| `a1=2` | å¥—æ¥å­—ç±»å‹SOCK_DGRAM | UDP |
| `a1=3` | å¥—æ¥å­—ç±»å‹SOCK_RAW | åŸå§‹å¥—æ¥å­— |

### 6.4 Socketé€‰é¡¹å’Œæ§åˆ¶å®¡è®¡


**Socketé…ç½®ç›‘æ§**ï¼š
```bash
# Socketé€‰é¡¹è®¾ç½®
-a always,exit -F arch=b64 -S setsockopt -k socket_setopt
-a always,exit -F arch=b64 -S getsockopt -k socket_getopt

# Socketæ§åˆ¶æ“ä½œ
-a always,exit -F arch=b64 -S fcntl -F a1=4 -k socket_fcntl
-a always,exit -F arch=b64 -S ioctl -k socket_ioctl
```

---

## 7. ğŸš€ ç½‘ç»œæœåŠ¡å¯åœå®¡è®¡


### 7.1 æœåŠ¡ç®¡ç†å®¡è®¡é…ç½®


**systemctlå‘½ä»¤ç›‘æ§**ï¼š
```bash
# å®¡è®¡systemctlæœåŠ¡æ§åˆ¶
-a always,exit -F arch=b64 -S execve -F path=/bin/systemctl -k service_systemctl
-a always,exit -F arch=b64 -S execve -F path=/usr/bin/systemctl -k service_systemctl

# å®¡è®¡serviceå‘½ä»¤ï¼ˆä¼ ç»Ÿinitï¼‰
-a always,exit -F arch=b64 -S execve -F path=/usr/sbin/service -k service_command
```

### 7.2 ç½‘ç»œæœåŠ¡é…ç½®æ–‡ä»¶ç›‘æ§


**ä¸»è¦ç½‘ç»œæœåŠ¡é…ç½®**ï¼š
```bash
# SSHæœåŠ¡
-w /etc/ssh/sshd_config -p wa -k ssh_config
-w /etc/ssh/ssh_config -p wa -k ssh_client_config

# WebæœåŠ¡å™¨
-w /etc/nginx/nginx.conf -p wa -k nginx_config
-w /etc/apache2/apache2.conf -p wa -k apache_config
-w /etc/httpd/conf/httpd.conf -p wa -k httpd_config

# æ•°æ®åº“æœåŠ¡
-w /etc/mysql/my.cnf -p wa -k mysql_config
-w /etc/postgresql/ -p wa -k postgresql_config

# DNSæœåŠ¡
-w /etc/bind/named.conf -p wa -k bind_config
-w /etc/named.conf -p wa -k named_config

# é‚®ä»¶æœåŠ¡
-w /etc/postfix/main.cf -p wa -k postfix_config
-w /etc/dovecot/dovecot.conf -p wa -k dovecot_config
```

### 7.3 æœåŠ¡çŠ¶æ€å˜åŒ–ç›‘æ§


**æœåŠ¡å¯åœæ£€æµ‹æ–¹æ³•**ï¼š

```
ç›‘æ§ç»´åº¦ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è¿›ç¨‹ç›‘æ§      â”‚ â†’ æœåŠ¡è¿›ç¨‹å¯åŠ¨/åœæ­¢
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ç«¯å£ç›‘æ§      â”‚ â†’ ç›‘å¬ç«¯å£å¼€å¯/å…³é—­
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  
â”‚   æ—¥å¿—ç›‘æ§      â”‚ â†’ æœåŠ¡æ—¥å¿—å˜åŒ–
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   é…ç½®ç›‘æ§      â”‚ â†’ é…ç½®æ–‡ä»¶ä¿®æ”¹
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æœåŠ¡è¿›ç¨‹ç›‘æ§**ï¼š
```bash
# ç›‘æ§ç‰¹å®šç½‘ç»œæœåŠ¡è¿›ç¨‹
-a always,exit -F arch=b64 -S execve -F path=/usr/sbin/sshd -k sshd_start
-a always,exit -F arch=b64 -S execve -F path=/usr/sbin/nginx -k nginx_start
-a always,exit -F arch=b64 -S execve -F path=/usr/sbin/apache2 -k apache_start

# ç›‘æ§è¿›ç¨‹ç»ˆæ­¢
-a always,exit -F arch=b64 -S kill -k process_kill
-a always,exit -F arch=b64 -S exit_group -k process_exit
```

### 7.4 æœåŠ¡å®¡è®¡æ—¥å¿—åˆ†æ


**æœåŠ¡å¯åŠ¨æ—¥å¿—ç¤ºä¾‹**ï¼š
```
type=EXECVE msg=audit(1694764800.789:1011): argc=3 a0="systemctl" a1="start" a2="nginx"

type=SYSCALL msg=audit(1694764800.789:1011): arch=c000003e syscall=59 
success=yes exit=0 a0=7f8a9b1c2d3e a1=7f8a9b1c2d50 a2=7f8a9b1c2d70 a3=0 
items=2 ppid=1234 pid=5678 auid=1000 uid=0 gid=0 
euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 
tty=pts0 ses=1 comm="systemctl" exe="/usr/bin/systemctl" key="service_systemctl"
```

**å…³é”®ä¿¡æ¯æå–**ï¼š
- ğŸ”§ **æ“ä½œå‘½ä»¤**ï¼š`systemctl start nginx`
- ğŸ‘¤ **æ‰§è¡Œç”¨æˆ·**ï¼š`auid=1000`ï¼ˆåŸå§‹ç”¨æˆ·ï¼‰ï¼Œ`uid=0`ï¼ˆæœ‰æ•ˆç”¨æˆ·rootï¼‰
- ğŸ“… **æ‰§è¡Œæ—¶é—´**ï¼šå®¡è®¡æ—¶é—´æˆ³
- âœ… **æ“ä½œç»“æœ**ï¼š`success=yes`

---

## 8. ğŸš¨ å¼‚å¸¸ç½‘ç»œè¡Œä¸ºç›‘æ§


### 8.1 å¼‚å¸¸è¡Œä¸ºè¯†åˆ«æ ‡å‡†


**ç½‘ç»œå¼‚å¸¸è¡Œä¸ºç±»å‹**ï¼š

| å¼‚å¸¸ç±»å‹ | è¡Œä¸ºç‰¹å¾ | é£é™©ç­‰çº§ | æ£€æµ‹æ–¹æ³• |
|----------|----------|----------|----------|
| ğŸ”¥ **ç«¯å£æ‰«æ** | çŸ­æ—¶é—´å¤§é‡ç«¯å£è¿æ¥å°è¯• | é«˜ | è¿æ¥é¢‘ç‡ç»Ÿè®¡ |
| âš ï¸ **å¼‚å¸¸ç«¯å£** | ä½¿ç”¨éæ ‡å‡†ç«¯å£æœåŠ¡ | ä¸­ | ç«¯å£é»‘åå•æ£€æŸ¥ |
| ğŸš¨ **æƒé™å¼‚å¸¸** | æ™®é€šç”¨æˆ·ç»‘å®šç‰¹æƒç«¯å£ | é«˜ | ç”¨æˆ·æƒé™æ£€æŸ¥ |
| ğŸ’¥ **è¿æ¥å¼‚å¸¸** | è¿æ¥å¤±è´¥ç‡è¿‡é«˜ | ä¸­ | æˆåŠŸç‡ç»Ÿè®¡ |
| ğŸ” **æµé‡å¼‚å¸¸** | å¼‚å¸¸å¤§çš„æ•°æ®ä¼ è¾“ | ä¸­ | æµé‡é˜ˆå€¼ç›‘æ§ |

### 8.2 å¼‚å¸¸è¿æ¥ç›‘æ§é…ç½®


**é«˜é¢‘è¿æ¥ç›‘æ§**ï¼š
```bash
# ç›‘æ§çŸ­æ—¶é—´å†…å¤§é‡è¿æ¥
-a always,exit -F arch=b64 -S connect -F success=0 -k failed_connect
-a always,exit -F arch=b64 -S connect -F success=1 -k success_connect

# ç›‘æ§å¼‚å¸¸ç«¯å£è¿æ¥
-a always,exit -F arch=b64 -S connect -F a2>0x1388 -k high_port_connect

# ç›‘æ§æœ¬åœ°å›ç¯å¼‚å¸¸è¿æ¥
-a always,exit -F arch=b64 -S connect -F a1_type=sockaddr -k localhost_connect
```

### 8.3 å¼‚å¸¸è¿›ç¨‹ç½‘ç»œè¡Œä¸ºç›‘æ§


**å¯ç–‘è¿›ç¨‹ç½‘ç»œæ´»åŠ¨**ï¼š
```bash
# ç›‘æ§ç³»ç»Ÿè¿›ç¨‹å¼‚å¸¸ç½‘ç»œè¡Œä¸º
-a always,exit -F arch=b64 -S socket -F auid!=-1 -F comm!=sshd -F comm!=nginx -k suspicious_network

# ç›‘æ§ä¸´æ—¶æ–‡ä»¶æ‰§è¡Œçš„ç½‘ç»œè¡Œä¸º
-a always,exit -F arch=b64 -S socket -F exe_path=/tmp/ -k tmp_network
-a always,exit -F arch=b64 -S socket -F exe_path=/var/tmp/ -k tmp_network

# ç›‘æ§è„šæœ¬è§£é‡Šå™¨ç½‘ç»œè¡Œä¸º
-a always,exit -F arch=b64 -S socket -F comm=python -k python_network
-a always,exit -F arch=b64 -S socket -F comm=sh -k shell_network
```

### 8.4 å¼‚å¸¸è¡Œä¸ºè‡ªåŠ¨æ£€æµ‹è„šæœ¬


**ç®€å•å¼‚å¸¸æ£€æµ‹ç¤ºä¾‹**ï¼š
```bash
#!/bin/bash
# ç½‘ç»œå¼‚å¸¸è¡Œä¸ºæ£€æµ‹è„šæœ¬

# æ£€æµ‹çŸ­æ—¶é—´å†…å¤§é‡è¿æ¥
check_connection_flood() {
    echo "æ£€æŸ¥è¿æ¥æ´ªæ°´æ”»å‡»..."
    ausearch -k tcp_connect -ts recent | \
    grep -o 'pid=[0-9]*' | sort | uniq -c | \
    awk '$1 > 100 {print "è­¦å‘Šï¼šè¿›ç¨‹" $2 "è¿æ¥æ¬¡æ•°å¼‚å¸¸ï¼š" $1}'
}

# æ£€æµ‹å¼‚å¸¸ç«¯å£ä½¿ç”¨
check_abnormal_ports() {
    echo "æ£€æŸ¥å¼‚å¸¸ç«¯å£ä½¿ç”¨..."
    ausearch -k port_bind -ts recent | \
    grep -E 'a2=0x[0-9a-f]+' | \
    while read line; do
        port=$(echo "$line" | grep -o 'a2=0x[0-9a-f]*' | cut -d= -f2)
        port_dec=$((16#${port#0x}))
        if [ $port_dec -gt 65000 ]; then
            echo "è­¦å‘Šï¼šä½¿ç”¨å¼‚å¸¸é«˜ç«¯å£ï¼š$port_dec"
        fi
    done
}

# æ‰§è¡Œæ£€æµ‹
check_connection_flood
check_abnormal_ports
```

---

## 9. ğŸ” ç½‘ç»œå®‰å…¨äº‹ä»¶å®¡è®¡


### 9.1 å®‰å…¨äº‹ä»¶åˆ†ç±»


**ç½‘ç»œå®‰å…¨äº‹ä»¶ç±»å‹**ï¼š

```
å®‰å…¨äº‹ä»¶åˆ†ç±»ï¼š
â”œâ”€â”€ æ”»å‡»ç±»äº‹ä»¶
â”‚   â”œâ”€â”€ ç«¯å£æ‰«æ
â”‚   â”œâ”€â”€ æš´åŠ›ç ´è§£
â”‚   â”œâ”€â”€ DDoSæ”»å‡»
â”‚   â””â”€â”€ æ¶æ„è¿æ¥
â”œâ”€â”€ è¿è§„ç±»äº‹ä»¶  
â”‚   â”œâ”€â”€ æœªæˆæƒè®¿é—®
â”‚   â”œâ”€â”€ æƒé™æ»¥ç”¨
â”‚   â”œâ”€â”€ ç­–ç•¥è¿å
â”‚   â””â”€â”€ é…ç½®ç¯¡æ”¹
â””â”€â”€ å¼‚å¸¸ç±»äº‹ä»¶
    â”œâ”€â”€ å¼‚å¸¸æµé‡
    â”œâ”€â”€ å¼‚å¸¸è¿æ¥
    â”œâ”€â”€ æœåŠ¡å¼‚å¸¸
    â””â”€â”€ æ€§èƒ½å¼‚å¸¸
```

### 9.2 æ”»å‡»è¡Œä¸ºå®¡è®¡é…ç½®


**å¸¸è§æ”»å‡»ç›‘æ§**ï¼š
```bash
# SSHæš´åŠ›ç ´è§£ç›‘æ§
-a always,exit -F arch=b64 -S connect -F a2=0x16 -F success=0 -k ssh_attack

# Webæ”»å‡»ç›‘æ§
-a always,exit -F arch=b64 -S connect -F a2=0x50 -k http_access
-a always,exit -F arch=b64 -S connect -F a2=0x1bb -k https_access

# æ•°æ®åº“æ”»å‡»ç›‘æ§
-a always,exit -F arch=b64 -S connect -F a2=0xcea -k mysql_access

# å¼‚å¸¸å¤§é‡è¿æ¥ç›‘æ§
-a always,exit -F arch=b64 -S socket -F a0=2 -F success=1 -k socket_flood
```

### 9.3 å…¥ä¾µæ£€æµ‹å®¡è®¡è§„åˆ™


**å…¥ä¾µè¡Œä¸ºç‰¹å¾ç›‘æ§**ï¼š
```bash
# ç›‘æ§åå¼¹shellè¡Œä¸º
-a always,exit -F arch=b64 -S connect -F comm=bash -k reverse_shell
-a always,exit -F arch=b64 -S connect -F comm=sh -k reverse_shell
-a always,exit -F arch=b64 -S connect -F comm=nc -k reverse_shell

# ç›‘æ§ç½‘ç»œæ‰«æå·¥å…·
-a always,exit -F arch=b64 -S socket -F comm=nmap -k network_scan
-a always,exit -F arch=b64 -S socket -F comm=masscan -k network_scan
-a always,exit -F arch=b64 -S socket -F comm=zmap -k network_scan

# ç›‘æ§å¼‚å¸¸ç½‘ç»œå·¥å…·
-a always,exit -F arch=b64 -S execve -F path=/usr/bin/wget -k download_tool
-a always,exit -F arch=b64 -S execve -F path=/usr/bin/curl -k download_tool
```

### 9.4 å®‰å…¨äº‹ä»¶å“åº”é…ç½®


**è‡ªåŠ¨å“åº”æœºåˆ¶**ï¼š
```bash
# åˆ›å»ºå®‰å…¨äº‹ä»¶ç›‘æ§è„šæœ¬
cat > /usr/local/bin/security_monitor.sh << 'EOF'
#!/bin/bash

# ç›‘æ§SSHæš´åŠ›ç ´è§£
monitor_ssh_attacks() {
    failed_count=$(ausearch -k ssh_attack -ts recent | grep 'success=no' | wc -l)
    if [ $failed_count -gt 50 ]; then
        logger "å®‰å…¨è­¦å‘Šï¼šæ£€æµ‹åˆ°SSHæš´åŠ›ç ´è§£æ”»å‡»ï¼Œå¤±è´¥æ¬¡æ•°ï¼š$failed_count"
        # å¯ä»¥æ·»åŠ è‡ªåŠ¨å°é”IPçš„é€»è¾‘
    fi
}

# ç›‘æ§å¼‚å¸¸ç½‘ç»œè¿æ¥
monitor_abnormal_connections() {
    reverse_shells=$(ausearch -k reverse_shell -ts recent | wc -l)
    if [ $reverse_shells -gt 0 ]; then
        logger "ä¸¥é‡è­¦å‘Šï¼šæ£€æµ‹åˆ°ç–‘ä¼¼åå¼¹shellè¡Œä¸º"
        # ç«‹å³å‘Šè­¦
    fi
}

# å®šæœŸæ‰§è¡Œç›‘æ§
monitor_ssh_attacks
monitor_abnormal_connections
EOF

chmod +x /usr/local/bin/security_monitor.sh

# æ·»åŠ åˆ°crontabä¸­æ¯5åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡
echo "*/5 * * * * /usr/local/bin/security_monitor.sh" | crontab -
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ç½‘ç»œå®¡è®¡æœ¬è´¨ï¼šç›‘æ§å’Œè®°å½•ç³»ç»Ÿçš„æ‰€æœ‰ç½‘ç»œç›¸å…³æ´»åŠ¨
ğŸ”¸ å®¡è®¡èŒƒå›´ï¼šè¿æ¥å»ºç«‹ã€ç«¯å£ç›‘å¬ã€é…ç½®å˜æ›´ã€æœåŠ¡ç®¡ç†
ğŸ”¸ æ ¸å¿ƒç³»ç»Ÿè°ƒç”¨ï¼šsocketã€connectã€bindã€listenã€accept
ğŸ”¸ é…ç½®è¦ç‚¹ï¼šåŒºåˆ†32ä½å’Œ64ä½æ¶æ„ï¼Œè®¾ç½®åˆé€‚çš„å®¡è®¡é”®
ğŸ”¸ æ—¥å¿—åˆ†æï¼šç†è§£å®¡è®¡æ—¥å¿—æ ¼å¼ï¼Œæå–å…³é”®ä¿¡æ¯
ğŸ”¸ å®‰å…¨åº”ç”¨ï¼šæ£€æµ‹æ”»å‡»è¡Œä¸ºï¼Œç›‘æ§å¼‚å¸¸æ´»åŠ¨
```

### 10.2 å…³é”®é…ç½®è¦ç‚¹


**ğŸ”¹ åŸºç¡€é…ç½®åŸåˆ™**ï¼š
```
ç³»ç»Ÿè°ƒç”¨è¦†ç›–ï¼š
- socketæ“ä½œï¼šåˆ›å»ºã€ç»‘å®šã€è¿æ¥ã€ç›‘å¬
- ç½‘ç»œé…ç½®ï¼šæ¥å£ã€è·¯ç”±ã€é˜²ç«å¢™ã€DNS
- æœåŠ¡ç®¡ç†ï¼šå¯åŠ¨ã€åœæ­¢ã€é…ç½®å˜æ›´

æ¶æ„å…¼å®¹æ€§ï¼š
- åŒæ—¶é…ç½®64ä½å’Œ32ä½è§„åˆ™
- ä½¿ç”¨æ­£ç¡®çš„æ¶æ„æ ‡è¯†ç¬¦
- è€ƒè™‘ç³»ç»Ÿè°ƒç”¨å·å·®å¼‚

å®¡è®¡é”®è®¾ç½®ï¼š
- ä½¿ç”¨æœ‰æ„ä¹‰çš„é”®å
- ä¾¿äºæ—¥å¿—æ£€ç´¢å’Œåˆ†æ
- åŒºåˆ†ä¸åŒç±»å‹çš„ç½‘ç»œæ´»åŠ¨
```

**ğŸ”¹ ç›‘æ§é‡ç‚¹ç­–ç•¥**ï¼š
```
å®‰å…¨ä¼˜å…ˆçº§ï¼š
é«˜ä¼˜å…ˆçº§ï¼šç‰¹æƒç«¯å£ã€åå¼¹shellã€æš´åŠ›ç ´è§£
ä¸­ä¼˜å…ˆçº§ï¼šå¼‚å¸¸è¿æ¥ã€é…ç½®å˜æ›´ã€æœåŠ¡é‡å¯
ä½ä¼˜å…ˆçº§ï¼šå¸¸è§„è¿æ¥ã€æ­£å¸¸æœåŠ¡æ“ä½œ

èµ„æºå¹³è¡¡ï¼š
- é¿å…è¿‡åº¦å®¡è®¡å½±å“æ€§èƒ½
- é‡ç‚¹ç›‘æ§å…³é”®ç½‘ç»œæ´»åŠ¨
- å®šæœŸæ¸…ç†å’Œå½’æ¡£å®¡è®¡æ—¥å¿—
```

### 10.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ åº”ç”¨åœºæ™¯åˆ†ç±»**ï¼š

| åœºæ™¯ç±»å‹ | ç›‘æ§é‡ç‚¹ | é…ç½®ç‰¹ç‚¹ |
|----------|----------|----------|
| **WebæœåŠ¡å™¨** | HTTP/HTTPSè¿æ¥ã€é…ç½®å˜æ›´ | é‡ç‚¹ç›‘æ§80/443ç«¯å£ |
| **æ•°æ®åº“æœåŠ¡å™¨** | æ•°æ®åº“è¿æ¥ã€æƒé™å˜æ›´ | ç›‘æ§3306/5432ç­‰ç«¯å£ |
| **è·³æ¿æœº** | SSHè¿æ¥ã€ç”¨æˆ·è¡Œä¸º | é‡ç‚¹ç›‘æ§22ç«¯å£å’Œç”¨æˆ·åˆ‡æ¢ |
| **å†…ç½‘æœåŠ¡å™¨** | å¼‚å¸¸å¤–è”ã€é…ç½®ç¯¡æ”¹ | ç›‘æ§å¼‚å¸¸å‡ºç«™è¿æ¥ |

**ğŸ”§ è¿ç»´æœ€ä½³å®è·µ**ï¼š
```
æ—¥å¸¸ç®¡ç†ï¼š
âœ… å®šæœŸæ£€æŸ¥å®¡è®¡æ—¥å¿—
âœ… åˆ†æå¼‚å¸¸ç½‘ç»œè¡Œä¸º
âœ… ç»´æŠ¤å®¡è®¡è§„åˆ™é…ç½®
âœ… ç›‘æ§å®¡è®¡ç³»ç»Ÿæ€§èƒ½

å®‰å…¨å“åº”ï¼š
ğŸš¨ å»ºç«‹å‘Šè­¦æœºåˆ¶
ğŸš¨ åˆ¶å®šå“åº”æµç¨‹  
ğŸš¨ å®šæœŸå®‰å…¨è¯„ä¼°
ğŸš¨ æ›´æ–°ç›‘æ§è§„åˆ™
```

**ğŸ” æ•…éšœæ’æŸ¥æŠ€å·§**ï¼š
```
å¸¸è§é—®é¢˜è¯Šæ–­ï¼š
1. å®¡è®¡è§„åˆ™ä¸ç”Ÿæ•ˆ â†’ æ£€æŸ¥è¯­æ³•å’Œæƒé™
2. æ—¥å¿—é‡è¿‡å¤§ â†’ ä¼˜åŒ–è§„åˆ™ç²¾ç¡®åº¦
3. æ€§èƒ½å½±å“ â†’ å‡å°‘ä¸å¿…è¦çš„å®¡è®¡é¡¹
4. è¯¯æŠ¥è¿‡å¤š â†’ è°ƒæ•´ç›‘æ§é˜ˆå€¼
```

### 10.4 å­¦ä¹ è¿›é˜¶å»ºè®®


**ğŸ“š æ·±å…¥å­¦ä¹ æ–¹å‘**ï¼š
- **ç½‘ç»œåè®®åˆ†æ**ï¼šæ·±å…¥ç†è§£TCP/IPåè®®æ ˆ
- **å®‰å…¨äº‹ä»¶å“åº”**ï¼šå­¦ä¹ SIEMç³»ç»Ÿå’Œå®‰å…¨è¿è¥
- **è‡ªåŠ¨åŒ–è„šæœ¬**ï¼šå¼€å‘ç½‘ç»œç›‘æ§å’Œå“åº”è„šæœ¬
- **æ€§èƒ½ä¼˜åŒ–**ï¼šå¹³è¡¡å®‰å…¨ç›‘æ§å’Œç³»ç»Ÿæ€§èƒ½

**ğŸ› ï¸ å®è·µå»ºè®®**ï¼š
- åœ¨æµ‹è¯•ç¯å¢ƒä¸­éªŒè¯å®¡è®¡è§„åˆ™
- å»ºç«‹ç½‘ç»œæ´»åŠ¨åŸºçº¿ï¼Œè¯†åˆ«å¼‚å¸¸è¡Œä¸º
- ç»“åˆå…¶ä»–å®‰å…¨å·¥å…·å½¢æˆå®Œæ•´ç›‘æ§ä½“ç³»
- å®šæœŸå®¡æŸ¥å’Œæ›´æ–°ç½‘ç»œå®¡è®¡ç­–ç•¥

**æ ¸å¿ƒè®°å¿†**ï¼š
- ç½‘ç»œå®¡è®¡æ˜¯å®‰å…¨ç›‘æ§çš„é‡è¦ç»„æˆéƒ¨åˆ†
- åˆç†é…ç½®èƒ½æœ‰æ•ˆæ£€æµ‹å’Œé˜²èŒƒç½‘ç»œæ”»å‡»
- æ—¥å¿—åˆ†ææ˜¯å‘ç°å®‰å…¨é—®é¢˜çš„å…³é”®æŠ€èƒ½
- å¹³è¡¡å®‰å…¨æ€§å’Œç³»ç»Ÿæ€§èƒ½æ˜¯æŒç»­ä¼˜åŒ–çš„è¿‡ç¨‹