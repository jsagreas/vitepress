---
title: 8ã€netstatç½‘ç»œè¿æ¥ç›‘æ§
---
## ğŸ“š ç›®å½•

1. [netstatåŸºç¡€æ¦‚å¿µä¸ä½œç”¨](#1-netstatåŸºç¡€æ¦‚å¿µä¸ä½œç”¨)
2. [netstatå‘½ä»¤å‚æ•°è¯¦è§£](#2-netstatå‘½ä»¤å‚æ•°è¯¦è§£)
3. [TCP/UDPè¿æ¥çŠ¶æ€æŸ¥çœ‹](#3-tcpudpè¿æ¥çŠ¶æ€æŸ¥çœ‹)
4. [ç›‘å¬ç«¯å£ä¸æœåŠ¡è¯†åˆ«](#4-ç›‘å¬ç«¯å£ä¸æœåŠ¡è¯†åˆ«)
5. [ç½‘ç»œç»Ÿè®¡ä¿¡æ¯åˆ†æ](#5-ç½‘ç»œç»Ÿè®¡ä¿¡æ¯åˆ†æ)
6. [è·¯ç”±è¡¨ä¿¡æ¯æŸ¥çœ‹](#6-è·¯ç”±è¡¨ä¿¡æ¯æŸ¥çœ‹)
7. [ç½‘ç»œæ¥å£ç»Ÿè®¡æ•°æ®](#7-ç½‘ç»œæ¥å£ç»Ÿè®¡æ•°æ®)
8. [è¿æ¥æ’é˜Ÿä¸ç§¯å‹ç›‘æ§](#8-è¿æ¥æ’é˜Ÿä¸ç§¯å‹ç›‘æ§)
9. [ç½‘ç»œæ€§èƒ½é—®é¢˜åˆæ­¥è¯Šæ–­](#9-ç½‘ç»œæ€§èƒ½é—®é¢˜åˆæ­¥è¯Šæ–­)
10. [å®æˆ˜åº”ç”¨ä¸æœ€ä½³å®è·µ](#10-å®æˆ˜åº”ç”¨ä¸æœ€ä½³å®è·µ)
11. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#11-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ netstatåŸºç¡€æ¦‚å¿µä¸ä½œç”¨


### 1.1 ä»€ä¹ˆæ˜¯netstat


**ç®€å•ç†è§£**ï¼šnetstatå°±åƒæ˜¯ç½‘ç»œä¸–ç•Œçš„"ä½“æ£€æŠ¥å‘Š"ï¼Œèƒ½å‘Šè¯‰ä½ ç³»ç»Ÿå½“å‰æ‰€æœ‰çš„ç½‘ç»œè¿æ¥æƒ…å†µã€‚

```
ç”Ÿæ´»ç±»æ¯”ï¼š
netstat = åŒ»é™¢ä½“æ£€æŠ¥å‘Š
- æ˜¾ç¤ºèº«ä½“å„é¡¹æŒ‡æ ‡ â†’ æ˜¾ç¤ºç½‘ç»œå„é¡¹çŠ¶æ€
- å‘ç°æ½œåœ¨é—®é¢˜     â†’ å‘ç°ç½‘ç»œå¼‚å¸¸
- æä¾›è¯Šæ–­ä¾æ®     â†’ æä¾›æ’æŸ¥çº¿ç´¢
```

**ğŸ” æ ¸å¿ƒä½œç”¨**
- **è¿æ¥ç›‘æ§**ï¼šæŸ¥çœ‹å½“å‰æ‰€æœ‰ç½‘ç»œè¿æ¥
- **ç«¯å£æŸ¥çœ‹**ï¼šæ£€æŸ¥å“ªäº›ç«¯å£åœ¨ç›‘å¬
- **æœåŠ¡è¯†åˆ«**ï¼šæ‰¾å‡ºå ç”¨ç«¯å£çš„è¿›ç¨‹
- **ç»Ÿè®¡åˆ†æ**ï¼šè·å–ç½‘ç»œæµé‡ç»Ÿè®¡
- **é—®é¢˜è¯Šæ–­**ï¼šæ’æŸ¥ç½‘ç»œç›¸å…³æ•…éšœ

### 1.2 netstatçš„å·¥ä½œåŸç†


**ğŸ”§ åº•å±‚æœºåˆ¶**
```
netstatå·¥ä½œæµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¯»å–å†…æ ¸   â”‚â”€â”€â”€â–¶â”‚  è§£æç½‘ç»œ    â”‚â”€â”€â”€â–¶â”‚  æ ¼å¼åŒ–     â”‚
â”‚  ç½‘ç»œä¿¡æ¯   â”‚    â”‚  çŠ¶æ€ä¿¡æ¯    â”‚    â”‚  è¾“å‡ºç»“æœ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â–²                    â–²                   â–²
   /proc/net/*         å†…æ ¸ç½‘ç»œæ ˆ         ç”¨æˆ·å‹å¥½æ˜¾ç¤º
```

**ğŸ“Š ä¿¡æ¯æ¥æº**
- `/proc/net/tcp` - TCPè¿æ¥ä¿¡æ¯
- `/proc/net/udp` - UDPè¿æ¥ä¿¡æ¯  
- `/proc/net/route` - è·¯ç”±è¡¨ä¿¡æ¯
- `/proc/net/dev` - ç½‘ç»œæ¥å£ç»Ÿè®¡

### 1.3 ä¸ºä»€ä¹ˆè¦å­¦ä¹ netstat


> ğŸ’¡ **å®é™…ä»·å€¼**ï¼šnetstatæ˜¯Linuxç³»ç»Ÿç®¡ç†å‘˜å’Œå¼€å‘è€…å¿…å¤‡çš„ç½‘ç»œè¯Šæ–­å·¥å…·

**ğŸ¯ ä½¿ç”¨åœºæ™¯**
- **æœåŠ¡å™¨è¿ç»´**ï¼šæ£€æŸ¥æœåŠ¡è¿è¡ŒçŠ¶æ€
- **å®‰å…¨å®¡è®¡**ï¼šå‘ç°å¯ç–‘ç½‘ç»œè¿æ¥
- **æ€§èƒ½ä¼˜åŒ–**ï¼šåˆ†æç½‘ç»œç“¶é¢ˆ
- **æ•…éšœæ’æŸ¥**ï¼šå®šä½ç½‘ç»œé—®é¢˜æ ¹æº

---

## 2. ğŸ”§ netstatå‘½ä»¤å‚æ•°è¯¦è§£


### 2.1 åŸºæœ¬è¯­æ³•ç»“æ„


```bash
netstat [é€‰é¡¹] [åœ°å€æ—]
```

**ğŸ“‹ å‚æ•°åˆ†ç±»**
```
æ˜¾ç¤ºé€‰é¡¹ï¼š
-a, --all          æ˜¾ç¤ºæ‰€æœ‰è¿æ¥ï¼ˆé»˜è®¤åªæ˜¾ç¤ºå·²è¿æ¥çš„ï¼‰
-l, --listening    åªæ˜¾ç¤ºç›‘å¬çŠ¶æ€çš„è¿æ¥
-n, --numeric      æ˜¾ç¤ºæ•°å­—åœ°å€è€Œä¸æ˜¯åŸŸå
-p, --programs     æ˜¾ç¤ºè¿›ç¨‹PIDå’Œåç§°

åè®®é€‰é¡¹ï¼š
-t, --tcp          åªæ˜¾ç¤ºTCPè¿æ¥
-u, --udp          åªæ˜¾ç¤ºUDPè¿æ¥
-x, --unix         æ˜¾ç¤ºUnixåŸŸsocket

ç»Ÿè®¡é€‰é¡¹ï¼š
-s, --statistics   æ˜¾ç¤ºç½‘ç»œç»Ÿè®¡ä¿¡æ¯
-r, --route        æ˜¾ç¤ºè·¯ç”±è¡¨
-i, --interfaces   æ˜¾ç¤ºç½‘ç»œæ¥å£ä¿¡æ¯
```

### 2.2 å¸¸ç”¨å‚æ•°ç»„åˆ


**ğŸŒŸ æœ€å®ç”¨çš„ç»„åˆ**

| å‘½ä»¤ç»„åˆ | ä½œç”¨è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|---------|----------|----------|
| `netstat -tlnp` | æ˜¾ç¤ºTCPç›‘å¬ç«¯å£åŠè¿›ç¨‹ | **æ—¥å¸¸æ£€æŸ¥æœåŠ¡çŠ¶æ€** |
| `netstat -tuln` | æ˜¾ç¤ºæ‰€æœ‰ç›‘å¬ç«¯å£ï¼ˆTCP+UDPï¼‰ | **ç«¯å£æ‰«æå‰æ£€æŸ¥** |
| `netstat -anp` | æ˜¾ç¤ºæ‰€æœ‰è¿æ¥åŠè¿›ç¨‹ä¿¡æ¯ | **å…¨é¢è¿æ¥åˆ†æ** |
| `netstat -s` | æ˜¾ç¤ºç½‘ç»œç»Ÿè®¡ä¿¡æ¯ | **æ€§èƒ½åˆ†æ** |
| `netstat -rn` | æ˜¾ç¤ºæ•°å­—æ ¼å¼è·¯ç”±è¡¨ | **ç½‘ç»œè·¯ç”±æ£€æŸ¥** |

### 2.3 å‚æ•°è¯¦ç»†è¯´æ˜


**ğŸ”¸ -a (--all) å‚æ•°**
```bash
# ä¸åŠ -aï¼šåªæ˜¾ç¤ºå·²å»ºç«‹çš„è¿æ¥
netstat -t
Active Internet connections (w/o servers)
Proto Recv-Q Send-Q Local Address    Foreign Address    State

# åŠ -aï¼šæ˜¾ç¤ºæ‰€æœ‰è¿æ¥ï¼ˆåŒ…æ‹¬ç›‘å¬çŠ¶æ€ï¼‰
netstat -ta
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address    Foreign Address    State
tcp        0      0 0.0.0.0:22       0.0.0.0:*          LISTEN
tcp        0      0 192.168.1.10:22  192.168.1.5:45678  ESTABLISHED
```

**ğŸ”¸ -n (--numeric) å‚æ•°**
```bash
# ä¸åŠ -nï¼šæ˜¾ç¤ºåŸŸåï¼ˆæ…¢ï¼‰
netstat -t
tcp  0  0  localhost:22  client.example.com:45678  ESTABLISHED

# åŠ -nï¼šæ˜¾ç¤ºIPåœ°å€ï¼ˆå¿«ï¼‰
netstat -tn  
tcp  0  0  127.0.0.1:22  192.168.1.5:45678         ESTABLISHED
```

> âš ï¸ **é‡è¦æç¤º**ï¼šç”Ÿäº§ç¯å¢ƒå»ºè®®æ€»æ˜¯ä½¿ç”¨`-n`å‚æ•°ï¼Œé¿å…DNSè§£æå»¶è¿Ÿ

**ğŸ”¸ -p (--programs) å‚æ•°**
```bash
# æ˜¾ç¤ºè¿›ç¨‹ä¿¡æ¯ï¼ˆéœ€è¦rootæƒé™çœ‹åˆ°æ‰€æœ‰è¿›ç¨‹ï¼‰
netstat -tlnp
Proto Recv-Q Send-Q Local Address    State       PID/Program name
tcp        0      0 0.0.0.0:22       LISTEN      1234/sshd
tcp        0      0 0.0.0.0:80       LISTEN      5678/nginx
```

---

## 3. ğŸ”— TCP/UDPè¿æ¥çŠ¶æ€æŸ¥çœ‹


### 3.1 TCPè¿æ¥çŠ¶æ€è¯¦è§£


**ğŸ“Š TCPçŠ¶æ€æœº**
```
TCPè¿æ¥ç”Ÿå‘½å‘¨æœŸï¼š

å®¢æˆ·ç«¯                    æœåŠ¡ç«¯
   â”‚                        â”‚
   â”‚â”€â”€â”€â”€ SYN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  (SYN_SENT)
   â”‚                        â”‚  (SYN_RCVD)
   â”‚â—€â”€â”€â”€â”€ SYN+ACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚â”€â”€â”€â”€ ACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
   â”‚                        â”‚  (ESTABLISHED)
   â”‚â—€â•â•â•â• æ•°æ®ä¼ è¾“ â•â•â•â•â•â•â•â•â–¶â”‚
   â”‚                        â”‚
   â”‚â”€â”€â”€â”€ FIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  (FIN_WAIT_1)
   â”‚                        â”‚  (CLOSE_WAIT)
   â”‚â—€â”€â”€â”€â”€ ACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  (FIN_WAIT_2)
   â”‚â—€â”€â”€â”€â”€ FIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  (LAST_ACK)
   â”‚â”€â”€â”€â”€ ACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
   â”‚                        â”‚  (CLOSED)
```

**ğŸ”¸ ä¸»è¦çŠ¶æ€è¯´æ˜**

| çŠ¶æ€ | å«ä¹‰ | é€šä¿—è§£é‡Š | æ˜¯å¦æ­£å¸¸ |
|------|------|----------|----------|
| **LISTEN** | ç›‘å¬çŠ¶æ€ | æœåŠ¡åœ¨ç­‰å®¢æˆ·ç«¯è¿æ¥ | âœ… æ­£å¸¸ |
| **ESTABLISHED** | å·²å»ºç«‹è¿æ¥ | æ­£åœ¨ä¼ è¾“æ•°æ® | âœ… æ­£å¸¸ |
| **SYN_SENT** | å‘é€è¿æ¥è¯·æ±‚ | å®¢æˆ·ç«¯ç­‰å¾…æœåŠ¡ç«¯å“åº” | ğŸŸ¡ çŸ­æš‚æ­£å¸¸ |
| **SYN_RCVD** | æ”¶åˆ°è¿æ¥è¯·æ±‚ | æœåŠ¡ç«¯ç­‰å¾…å®¢æˆ·ç«¯ç¡®è®¤ | ğŸŸ¡ çŸ­æš‚æ­£å¸¸ |
| **FIN_WAIT_1** | ä¸»åŠ¨å…³é—­ç­‰å¾… | å‘èµ·å…³é—­ç­‰å¾…å¯¹æ–¹ç¡®è®¤ | ğŸŸ¡ çŸ­æš‚æ­£å¸¸ |
| **FIN_WAIT_2** | ç­‰å¾…å¯¹æ–¹å…³é—­ | ç­‰å¾…å¯¹æ–¹å‘é€å…³é—­ä¿¡å· | ğŸŸ¡ çŸ­æš‚æ­£å¸¸ |
| **TIME_WAIT** | ç­‰å¾…è¶…æ—¶ | è¿æ¥å…³é—­åçš„ç­‰å¾…æœŸ | ğŸŸ¡ æ­£å¸¸ä½†éœ€å…³æ³¨ |
| **CLOSE_WAIT** | ç­‰å¾…åº”ç”¨å…³é—­ | å¯¹æ–¹å·²å…³é—­ï¼Œç­‰æœ¬åœ°å…³é—­ | ğŸ”´ å¯èƒ½æœ‰é—®é¢˜ |

### 3.2 æŸ¥çœ‹TCPè¿æ¥å®ä¾‹


**ğŸ” åŸºæœ¬è¿æ¥æŸ¥çœ‹**
```bash
# æŸ¥çœ‹æ‰€æœ‰TCPè¿æ¥
netstat -tan
Proto Recv-Q Send-Q Local Address      Foreign Address    State
tcp        0      0 0.0.0.0:22         0.0.0.0:*          LISTEN
tcp        0      0 0.0.0.0:80         0.0.0.0:*          LISTEN
tcp        0      0 192.168.1.10:22    192.168.1.5:45678  ESTABLISHED
tcp        0     32 192.168.1.10:80    203.0.113.15:60234 ESTABLISHED
tcp        0      0 192.168.1.10:8080  0.0.0.0:*          LISTEN
```

**ğŸ” æŸ¥çœ‹ç‰¹å®šçŠ¶æ€çš„è¿æ¥**
```bash
# åªçœ‹ESTABLISHEDçŠ¶æ€çš„è¿æ¥
netstat -tan | grep ESTABLISHED

# ç»Ÿè®¡å„ç§çŠ¶æ€çš„è¿æ¥æ•°
netstat -tan | awk '{print $6}' | sort | uniq -c
   2 ESTABLISHED
   3 LISTEN
   1 TIME_WAIT
```

### 3.3 UDPè¿æ¥ç‰¹ç‚¹


> ğŸ’¡ **é‡è¦æ¦‚å¿µ**ï¼šUDPæ˜¯æ— è¿æ¥åè®®ï¼Œæ²¡æœ‰è¿æ¥çŠ¶æ€æ¦‚å¿µ

**ğŸ”¸ UDPæ˜¾ç¤ºç‰¹ç‚¹**
```bash
# UDPè¿æ¥æŸ¥çœ‹
netstat -uan
Proto Recv-Q Send-Q Local Address      Foreign Address    State
udp        0      0 0.0.0.0:53         0.0.0.0:*          
udp        0      0 127.0.0.1:323      0.0.0.0:*          
udp        0      0 0.0.0.0:68         0.0.0.0:*          
```

**UDPç‰¹ç‚¹è¯´æ˜**ï¼š
- æ²¡æœ‰Stateåˆ—ï¼ˆæˆ–æ˜¾ç¤ºä¸ºç©ºï¼‰
- Foreign Addressé€šå¸¸ä¸º`0.0.0.0:*`
- ä¸»è¦å…³æ³¨æ˜¯å¦åœ¨ç›‘å¬ï¼ˆLocal Addressï¼‰

---

## 4. ğŸ¯ ç›‘å¬ç«¯å£ä¸æœåŠ¡è¯†åˆ«


### 4.1 æŸ¥çœ‹ç›‘å¬ç«¯å£


**ğŸ”¸ æŸ¥çœ‹æ‰€æœ‰ç›‘å¬ç«¯å£**
```bash
# TCPç›‘å¬ç«¯å£
netstat -tlnp
Proto Recv-Q Send-Q Local Address    State    PID/Program name
tcp        0      0 0.0.0.0:22       LISTEN   1234/sshd
tcp        0      0 0.0.0.0:80       LISTEN   5678/nginx: master
tcp        0      0 127.0.0.1:3306   LISTEN   9012/mysqld

# UDPç›‘å¬ç«¯å£  
netstat -ulnp
Proto Recv-Q Send-Q Local Address    PID/Program name
udp        0      0 0.0.0.0:53       1111/named
udp        0      0 0.0.0.0:123      2222/ntpd
```

**ğŸ”¸ ç»„åˆæŸ¥çœ‹TCP+UDP**
```bash
netstat -tulnp
```

### 4.2 ç«¯å£ä¸æœåŠ¡å¯¹åº”å…³ç³»


**ğŸ“‹ å¸¸è§ç«¯å£æœåŠ¡è¡¨**

| ç«¯å£å· | åè®® | æœåŠ¡åç§° | ç”¨é€”è¯´æ˜ |
|--------|------|----------|----------|
| **22** | TCP | SSH | è¿œç¨‹ç™»å½•ç®¡ç† |
| **53** | UDP/TCP | DNS | åŸŸåè§£ææœåŠ¡ |
| **80** | TCP | HTTP | WebæœåŠ¡ |
| **443** | TCP | HTTPS | åŠ å¯†WebæœåŠ¡ |
| **3306** | TCP | MySQL | æ•°æ®åº“æœåŠ¡ |
| **6379** | TCP | Redis | ç¼“å­˜æœåŠ¡ |
| **27017** | TCP | MongoDB | æ–‡æ¡£æ•°æ®åº“ |
| **9200** | TCP | Elasticsearch | æœç´¢å¼•æ“ |

### 4.3 æœåŠ¡è¯†åˆ«æŠ€å·§


**ğŸ” é€šè¿‡ç«¯å£æ‰¾æœåŠ¡**
```bash
# æŸ¥çœ‹ç‰¹å®šç«¯å£çš„æœåŠ¡
netstat -tlnp | grep :80
tcp  0  0  0.0.0.0:80  0.0.0.0:*  LISTEN  5678/nginx: master

# æŸ¥çœ‹è¿›ç¨‹è¯¦ç»†ä¿¡æ¯
ps aux | grep 5678
root  5678  nginx: master process /usr/sbin/nginx
```

**ğŸ” é€šè¿‡è¿›ç¨‹åæ‰¾ç«¯å£**
```bash
# æŸ¥çœ‹nginxå ç”¨çš„ç«¯å£
netstat -tlnp | grep nginx
tcp  0  0  0.0.0.0:80   0.0.0.0:*  LISTEN  5678/nginx: master
tcp  0  0  0.0.0.0:8080 0.0.0.0:*  LISTEN  5678/nginx: master
```

**ğŸ” æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨**
```bash
# æ£€æŸ¥80ç«¯å£æ˜¯å¦è¢«å ç”¨
netstat -tlnp | grep :80
# å¦‚æœæœ‰è¾“å‡ºï¼Œè¯´æ˜è¢«å ç”¨ï¼›æ— è¾“å‡ºè¯´æ˜ç©ºé—²

# æˆ–è€…ä½¿ç”¨æ›´ç®€æ´çš„æ–¹å¼
ss -tlnp | grep :80
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**ï¼š
> - ä½¿ç”¨`-p`å‚æ•°éœ€è¦rootæƒé™æ‰èƒ½çœ‹åˆ°æ‰€æœ‰è¿›ç¨‹ä¿¡æ¯
> - æ™®é€šç”¨æˆ·åªèƒ½çœ‹åˆ°è‡ªå·±å¯åŠ¨çš„è¿›ç¨‹

### 4.4 å®‰å…¨ç›‘æ§è¦ç‚¹


**ğŸ”’ å®‰å…¨æ£€æŸ¥æ¸…å•**

```
å®šæœŸæ£€æŸ¥é¡¹ç›®ï¼š
â–¡ æ˜¯å¦æœ‰æœªçŸ¥æœåŠ¡åœ¨ç›‘å¬
â–¡ æ˜¯å¦æœ‰å¼‚å¸¸ç«¯å£å¼€æ”¾
â–¡ æ˜¯å¦æœ‰å¤–éƒ¨å¯è®¿é—®çš„å†…éƒ¨æœåŠ¡
â–¡ æ˜¯å¦æœ‰å¯ç–‘çš„é«˜ç«¯å£ç›‘å¬
```

**ğŸš¨ å¼‚å¸¸æƒ…å†µç¤ºä¾‹**
```bash
# å‘ç°å¯ç–‘çš„é«˜ç«¯å£ç›‘å¬
netstat -tlnp | grep -E ":[0-9]{5}"
tcp  0  0  0.0.0.0:54321  0.0.0.0:*  LISTEN  unknown

# å‘ç°å†…éƒ¨æœåŠ¡å¯¹å¤–å¼€æ”¾
netstat -tlnp | grep 3306
tcp  0  0  0.0.0.0:3306   0.0.0.0:*  LISTEN  1234/mysqld
# æ³¨æ„ï¼š0.0.0.0è¡¨ç¤ºå¯¹æ‰€æœ‰ç½‘å¡å¼€æ”¾ï¼Œå¯èƒ½ä¸å®‰å…¨
```

---

## 5. ğŸ“Š ç½‘ç»œç»Ÿè®¡ä¿¡æ¯åˆ†æ


### 5.1 è·å–ç½‘ç»œç»Ÿè®¡ä¿¡æ¯


**ğŸ”¸ åŸºæœ¬ç»Ÿè®¡å‘½ä»¤**
```bash
# æ˜¾ç¤ºæ‰€æœ‰åè®®ç»Ÿè®¡
netstat -s

# åªæ˜¾ç¤ºTCPç»Ÿè®¡
netstat -st

# åªæ˜¾ç¤ºUDPç»Ÿè®¡  
netstat -su
```

### 5.2 TCPç»Ÿè®¡ä¿¡æ¯è§£è¯»


**ğŸ“ˆ é‡è¦TCPæŒ‡æ ‡**
```bash
netstat -st
Tcp:
    12345 active connections openings      # ä¸»åŠ¨å»ºç«‹çš„è¿æ¥æ•°
    6789 passive connection openings       # è¢«åŠ¨æ¥å—çš„è¿æ¥æ•°  
    234 failed connection attempts         # è¿æ¥å¤±è´¥æ¬¡æ•°
    56 connection resets received          # æ”¶åˆ°çš„è¿æ¥é‡ç½®
    7 connections established              # å½“å‰å»ºç«‹çš„è¿æ¥
    1234567 segments received              # æ¥æ”¶çš„æ•°æ®æ®µ
    2345678 segments sent out              # å‘é€çš„æ•°æ®æ®µ
    123 segments retransmitted             # é‡ä¼ çš„æ•°æ®æ®µ
    45 bad segments received               # æ”¶åˆ°çš„é”™è¯¯æ•°æ®æ®µ
    678 resets sent                        # å‘é€çš„é‡ç½®åŒ…
```

**ğŸ” å…³é”®æŒ‡æ ‡è§£é‡Š**

| æŒ‡æ ‡ | è‹±æ–‡åç§° | å«ä¹‰ | å¼‚å¸¸åˆ¤æ–­ |
|------|----------|------|----------|
| **è¿æ¥å¤±è´¥** | failed connection attempts | æ— æ³•å»ºç«‹è¿æ¥çš„æ¬¡æ•° | ğŸ”´ æ•°å€¼è¿‡é«˜éœ€å…³æ³¨ |
| **è¿æ¥é‡ç½®** | connection resets received | è¿æ¥è¢«å¼‚å¸¸ä¸­æ–­ | ğŸ”´ é¢‘ç¹é‡ç½®æœ‰é—®é¢˜ |
| **é‡ä¼ æ®µ** | segments retransmitted | ç½‘ç»œä¸¢åŒ…å¯¼è‡´é‡ä¼  | ğŸŸ¡ æ¯”ä¾‹>5%éœ€å…³æ³¨ |
| **é”™è¯¯æ®µ** | bad segments received | æ”¶åˆ°æŸåçš„æ•°æ®åŒ… | ğŸ”´ ä»»ä½•æ•°å€¼éƒ½éœ€å…³æ³¨ |

### 5.3 UDPç»Ÿè®¡ä¿¡æ¯è§£è¯»


**ğŸ“ˆ UDPå…³é”®æŒ‡æ ‡**
```bash
netstat -su
Udp:
    123456 packets received               # æ¥æ”¶çš„æ•°æ®åŒ…
    234 packets to unknown port received # å‘å¾€æœªçŸ¥ç«¯å£çš„åŒ…
    56 packet receive errors             # æ¥æ”¶é”™è¯¯
    234567 packets sent                  # å‘é€çš„æ•°æ®åŒ…
```

**ğŸ” UDPå¼‚å¸¸åˆ¤æ–­**
- **unknown portè¿‡å¤š**ï¼šå¯èƒ½é­å—ç«¯å£æ‰«æ
- **receive errors**ï¼šç½‘ç»œè´¨é‡é—®é¢˜
- **å‘é€æ¥æ”¶ä¸å¹³è¡¡**ï¼šå¯èƒ½æœ‰ä¸¢åŒ…

### 5.4 ç½‘ç»œæ€§èƒ½åˆ†æ


**âš¡ æ€§èƒ½æŒ‡æ ‡è®¡ç®—**
```bash
# é‡ä¼ ç‡è®¡ç®—
# é‡ä¼ ç‡ = é‡ä¼ æ®µæ•° / å‘é€æ®µæ•° * 100%
# æ­£å¸¸åº”è¯¥ < 1%ï¼Œè¶…è¿‡5%éœ€è¦å…³æ³¨

# è¿æ¥æˆåŠŸç‡è®¡ç®—  
# æˆåŠŸç‡ = (ä¸»åŠ¨è¿æ¥ - å¤±è´¥è¿æ¥) / ä¸»åŠ¨è¿æ¥ * 100%
# æ­£å¸¸åº”è¯¥ > 95%
```

**ğŸ“Š ç›‘æ§è„šæœ¬ç¤ºä¾‹**
```bash
#!/bin/bash
# ç½‘ç»œæ€§èƒ½ç›‘æ§è„šæœ¬

# è·å–TCPç»Ÿè®¡
tcp_stats=$(netstat -st)

# æå–å…³é”®æŒ‡æ ‡
failed=$(echo "$tcp_stats" | grep "failed connection" | awk '{print $1}')
retrans=$(echo "$tcp_stats" | grep "segments retransmitted" | awk '{print $1}')
sent=$(echo "$tcp_stats" | grep "segments sent" | awk '{print $1}')

# è®¡ç®—é‡ä¼ ç‡
if [ "$sent" -gt 0 ]; then
    retrans_rate=$(echo "scale=2; $retrans * 100 / $sent" | bc)
    echo "é‡ä¼ ç‡: ${retrans_rate}%"
fi

echo "è¿æ¥å¤±è´¥æ¬¡æ•°: $failed"
```

---

## 6. ğŸ—ºï¸ è·¯ç”±è¡¨ä¿¡æ¯æŸ¥çœ‹


### 6.1 è·¯ç”±è¡¨åŸºç¡€æ¦‚å¿µ


**ğŸ›£ï¸ ä»€ä¹ˆæ˜¯è·¯ç”±è¡¨**
```
ç”Ÿæ´»ç±»æ¯”ï¼š
è·¯ç”±è¡¨ = å¿«é€’åˆ†æ‹£ä¸­å¿ƒçš„åœ°å€è¡¨
- æ”¶åˆ°åŒ…è£¹çœ‹ç›®æ ‡åœ°å€ â†’ æ”¶åˆ°æ•°æ®åŒ…çœ‹ç›®æ ‡IP
- æŸ¥è¡¨å†³å®šå‘å¾€å“ªä¸ªç½‘ç‚¹ â†’ æŸ¥è¡¨å†³å®šä»å“ªä¸ªæ¥å£å‘é€
- é€‰æ‹©æœ€ä¼˜æŠ•é€’è·¯å¾„   â†’ é€‰æ‹©æœ€ä¼˜ç½‘ç»œè·¯å¾„
```

**ğŸ“‹ è·¯ç”±è¡¨ä½œç”¨**
- **è·¯å¾„é€‰æ‹©**ï¼šå†³å®šæ•°æ®åŒ…çš„å‘é€è·¯å¾„
- **ç½‘å…³é…ç½®**ï¼šæŒ‡å®šä¸åŒç½‘æ®µçš„ç½‘å…³
- **æ¥å£ç»‘å®š**ï¼šç¡®å®šä½¿ç”¨å“ªä¸ªç½‘ç»œæ¥å£
- **é»˜è®¤è·¯ç”±**ï¼šå¤„ç†æœªçŸ¥ç›®æ ‡çš„æ•°æ®åŒ…

### 6.2 æŸ¥çœ‹è·¯ç”±è¡¨ä¿¡æ¯


**ğŸ”¸ åŸºæœ¬è·¯ç”±è¡¨æŸ¥çœ‹**
```bash
# æŸ¥çœ‹è·¯ç”±è¡¨ï¼ˆæ¨èåŠ -né¿å…DNSè§£æï¼‰
netstat -rn
Kernel IP routing table
Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
0.0.0.0         192.168.1.1     0.0.0.0         UG      0   0       0    eth0
192.168.1.0     0.0.0.0         255.255.255.0   U       0   0       0    eth0
127.0.0.0       0.0.0.0         255.0.0.0       U       0   0       0    lo
```

**ğŸ”¸ ç­‰æ•ˆå‘½ä»¤**
```bash
# å…¶ä»–æŸ¥çœ‹è·¯ç”±çš„æ–¹æ³•
route -n
ip route show
```

### 6.3 è·¯ç”±è¡¨å­—æ®µè§£é‡Š


**ğŸ“Š å­—æ®µå«ä¹‰è¯´æ˜**

| å­—æ®µ | å«ä¹‰ | ç¤ºä¾‹å€¼ | è¯´æ˜ |
|------|------|--------|------|
| **Destination** | ç›®æ ‡ç½‘ç»œ | `192.168.1.0` | æ•°æ®åŒ…è¦å»çš„ç½‘ç»œ |
| **Gateway** | ç½‘å…³åœ°å€ | `192.168.1.1` | ä¸‹ä¸€è·³è·¯ç”±å™¨åœ°å€ |
| **Genmask** | å­ç½‘æ©ç  | `255.255.255.0` | ç½‘ç»œèŒƒå›´å®šä¹‰ |
| **Flags** | è·¯ç”±æ ‡å¿— | `UG` | è·¯ç”±çŠ¶æ€å’Œç±»å‹ |
| **Iface** | ç½‘ç»œæ¥å£ | `eth0` | å‘é€æ¥å£åç§° |

**ğŸš© Flagsæ ‡å¿—è§£é‡Š**
- **U (Up)**ï¼šè·¯ç”±æœ‰æ•ˆ
- **G (Gateway)**ï¼šé€šè¿‡ç½‘å…³è·¯ç”±
- **H (Host)**ï¼šä¸»æœºè·¯ç”±
- **D (Dynamically)**ï¼šåŠ¨æ€è·¯ç”±
- **M (Modified)**ï¼šè¢«ä¿®æ”¹çš„è·¯ç”±

### 6.4 è·¯ç”±è¡¨åˆ†æå®ä¾‹


**ğŸ” å…¸å‹è·¯ç”±è¡¨åˆ†æ**
```bash
netstat -rn
Destination     Gateway         Genmask         Flags   Iface
0.0.0.0         192.168.1.1     0.0.0.0         UG      eth0    # é»˜è®¤è·¯ç”±
192.168.1.0     0.0.0.0         255.255.255.0   U       eth0    # æœ¬åœ°ç½‘ç»œ
10.0.0.0        192.168.1.254   255.0.0.0       UG      eth0    # ç§ç½‘è·¯ç”±
127.0.0.0       0.0.0.0         255.0.0.0       U       lo      # æœ¬åœ°å›ç¯
```

**è·¯ç”±è§£è¯»**ï¼š
1. **é»˜è®¤è·¯ç”±** (`0.0.0.0`): æ‰€æœ‰æœªåŒ¹é…çš„æµé‡éƒ½å‘ç»™`192.168.1.1`
2. **æœ¬åœ°ç½‘ç»œ** (`192.168.1.0/24`): ç›´æ¥ä»`eth0`å‘é€ï¼Œæ— éœ€ç½‘å…³
3. **ç§ç½‘è·¯ç”±** (`10.0.0.0/8`): å»å¾€10ç½‘æ®µçš„æµé‡å‘ç»™`192.168.1.254`
4. **å›ç¯è·¯ç”±** (`127.0.0.0/8`): æœ¬åœ°å›ç¯é€šä¿¡

### 6.5 è·¯ç”±é—®é¢˜è¯Šæ–­


**ğŸ”§ å¸¸è§è·¯ç”±é—®é¢˜**

```bash
# 1. æ£€æŸ¥æ˜¯å¦æœ‰é»˜è®¤è·¯ç”±
netstat -rn | grep "0.0.0.0"
# å¦‚æœæ²¡æœ‰è¾“å‡ºï¼Œè¯´æ˜ç¼ºå°‘é»˜è®¤è·¯ç”±

# 2. æ£€æŸ¥ç‰¹å®šç½‘ç»œçš„è·¯ç”±
netstat -rn | grep "ç›®æ ‡ç½‘ç»œ"

# 3. æ£€æŸ¥ç½‘å…³æ˜¯å¦å¯è¾¾
ping 192.168.1.1
```

**ğŸš¨ å…¸å‹æ•…éšœåœºæ™¯**
```
æ•…éšœç°è±¡ï¼šæ— æ³•è®¿é—®å¤–ç½‘
æ£€æŸ¥æ­¥éª¤ï¼š
1. netstat -rn æŸ¥çœ‹æ˜¯å¦æœ‰é»˜è®¤è·¯ç”±
2. ping ç½‘å…³åœ°å€æ£€æŸ¥ç½‘å…³è¿é€šæ€§
3. ping å¤–ç½‘IPæ£€æŸ¥è·¯ç”±æ˜¯å¦æ­£ç¡®
```

---

## 7. ğŸ“¡ ç½‘ç»œæ¥å£ç»Ÿè®¡æ•°æ®


### 7.1 ç½‘ç»œæ¥å£ç»Ÿè®¡æ¦‚è¿°


**ğŸ”¸ æ¥å£ç»Ÿè®¡çš„ä½œç”¨**
```
ç½‘ç»œæ¥å£ç»Ÿè®¡ = ç½‘å¡çš„"ä½“æ£€æŠ¥å‘Š"
- æ”¶å‘æ•°æ®åŒ…æ•°é‡ â†’ äº†è§£ç½‘å¡å·¥ä½œè´Ÿè½½
- é”™è¯¯å’Œä¸¢åŒ…ç»Ÿè®¡ â†’ å‘ç°ç½‘ç»œè´¨é‡é—®é¢˜  
- å­—èŠ‚æ•°ç»Ÿè®¡     â†’ åˆ†æå¸¦å®½ä½¿ç”¨æƒ…å†µ
- å†²çªå’Œè½½æ³¢é”™è¯¯ â†’ è¯Šæ–­ç‰©ç†å±‚é—®é¢˜
```

### 7.2 æŸ¥çœ‹ç½‘ç»œæ¥å£ç»Ÿè®¡


**ğŸ”¸ åŸºæœ¬æ¥å£ç»Ÿè®¡**
```bash
netstat -i
Kernel Interface table
Iface   MTU  RX-OK RX-ERR RX-DRP RX-OVR    TX-OK TX-ERR TX-DRP TX-OVR Flg
eth0   1500  12345     0      0      0     23456     0      0      0 BMRU
lo    65536    100     0      0      0       100     0      0      0 LRU
```

**ğŸ”¸ è¯¦ç»†æ¥å£ç»Ÿè®¡**
```bash
# æ˜¾ç¤ºæ›´è¯¦ç»†çš„ç»Ÿè®¡ä¿¡æ¯
cat /proc/net/dev
Inter-|   Receive                                                |  Transmit
 face |bytes    packets errs drop fifo frame compressed multicast|bytes    packets errs drop fifo colls carrier compressed
  eth0:12345678   12345    0    0    0     0          0         0  23456789   23456    0    0    0     0       0          0
    lo:    1000     100    0    0    0     0          0         0      1000     100    0    0    0     0       0          0
```

### 7.3 ç»Ÿè®¡å­—æ®µè¯¦è§£


**ğŸ“Š æ¥æ”¶(RX)å­—æ®µè¯´æ˜**

| å­—æ®µ | å…¨ç§° | å«ä¹‰ | æ­£å¸¸å€¼ | å¼‚å¸¸æŒ‡æ ‡ |
|------|------|------|--------|----------|
| **RX-OK** | Receive OK | æˆåŠŸæ¥æ”¶çš„åŒ…æ•° | æŒç»­å¢é•¿ | åœæ­¢å¢é•¿ |
| **RX-ERR** | Receive Errors | æ¥æ”¶é”™è¯¯åŒ…æ•° | 0æˆ–å¾ˆå° | ğŸ”´ æŒç»­å¢é•¿ |
| **RX-DRP** | Receive Dropped | æ¥æ”¶æ—¶ä¸¢å¼ƒåŒ…æ•° | 0æˆ–å¾ˆå° | ğŸ”´ æ•°å€¼è¾ƒå¤§ |
| **RX-OVR** | Receive Overruns | æ¥æ”¶æº¢å‡ºæ¬¡æ•° | 0 | ğŸ”´ ä»»ä½•é0å€¼ |

**ğŸ“Š å‘é€(TX)å­—æ®µè¯´æ˜**

| å­—æ®µ | å…¨ç§° | å«ä¹‰ | æ­£å¸¸å€¼ | å¼‚å¸¸æŒ‡æ ‡ |
|------|------|------|--------|----------|
| **TX-OK** | Transmit OK | æˆåŠŸå‘é€çš„åŒ…æ•° | æŒç»­å¢é•¿ | åœæ­¢å¢é•¿ |
| **TX-ERR** | Transmit Errors | å‘é€é”™è¯¯åŒ…æ•° | 0æˆ–å¾ˆå° | ğŸ”´ æŒç»­å¢é•¿ |
| **TX-DRP** | Transmit Dropped | å‘é€æ—¶ä¸¢å¼ƒåŒ…æ•° | 0æˆ–å¾ˆå° | ğŸ”´ æ•°å€¼è¾ƒå¤§ |
| **TX-OVR** | Transmit Overruns | å‘é€æº¢å‡ºæ¬¡æ•° | 0 | ğŸ”´ ä»»ä½•é0å€¼ |

### 7.4 æ¥å£çŠ¶æ€æ ‡å¿—


**ğŸš© Flagsæ ‡å¿—å«ä¹‰**
```
å¸¸è§æ ‡å¿—ç»„åˆï¼š
BMRU - å¹¿æ’­ã€ç»„æ’­ã€è¿è¡Œã€å¯åŠ¨ (æ­£å¸¸çš„ä»¥å¤ªç½‘æ¥å£)
LRU  - å›ç¯ã€è¿è¡Œã€å¯åŠ¨ (æœ¬åœ°å›ç¯æ¥å£)

å…·ä½“æ ‡å¿—è¯´æ˜ï¼š
B - Broadcast (å¹¿æ’­)     M - Multicast (ç»„æ’­)
R - Running (è¿è¡Œ)       U - Up (å¯åŠ¨)  
L - Loopback (å›ç¯)      P - Point-to-Point (ç‚¹å¯¹ç‚¹)
```

### 7.5 ç½‘ç»œè´¨é‡åˆ†æ


**âš¡ è´¨é‡æŒ‡æ ‡è®¡ç®—**
```bash
#!/bin/bash
# ç½‘ç»œè´¨é‡åˆ†æè„šæœ¬

interface="eth0"
stats=$(grep "$interface:" /proc/net/dev)

# æå–ç»Ÿè®¡æ•°æ®
rx_packets=$(echo $stats | awk '{print $3}')
rx_errors=$(echo $stats | awk '{print $4}')
rx_dropped=$(echo $stats | awk '{print $5}')

tx_packets=$(echo $stats | awk '{print $11}')
tx_errors=$(echo $stats | awk '{print $12}')
tx_dropped=$(echo $stats | awk '{print $13}')

# è®¡ç®—é”™è¯¯ç‡
if [ $rx_packets -gt 0 ]; then
    rx_error_rate=$(echo "scale=4; $rx_errors * 100 / $rx_packets" | bc)
    echo "æ¥æ”¶é”™è¯¯ç‡: ${rx_error_rate}%"
fi

if [ $tx_packets -gt 0 ]; then
    tx_error_rate=$(echo "scale=4; $tx_errors * 100 / $tx_packets" | bc)
    echo "å‘é€é”™è¯¯ç‡: ${tx_error_rate}%"
fi
```

**ğŸ” å¥åº·é˜ˆå€¼å‚è€ƒ**
- **é”™è¯¯ç‡** < 0.01% (ä¸‡åˆ†ä¹‹ä¸€) âœ… ä¼˜ç§€
- **é”™è¯¯ç‡** < 0.1% (åƒåˆ†ä¹‹ä¸€) ğŸŸ¡ å¯æ¥å—
- **é”™è¯¯ç‡** > 0.1% ğŸ”´ éœ€è¦å…³æ³¨
- **ä¸¢åŒ…ç‡** > 1% ğŸ”´ ä¸¥é‡é—®é¢˜

---

## 8. ğŸ“ˆ è¿æ¥æ’é˜Ÿä¸ç§¯å‹ç›‘æ§


### 8.1 è¿æ¥æ’é˜Ÿæœºåˆ¶


**ğŸ”¸ TCPè¿æ¥é˜Ÿåˆ—åŸç†**
```
TCPä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ä¸­çš„é˜Ÿåˆ—ï¼š

å®¢æˆ·ç«¯            æœåŠ¡ç«¯
   â”‚                â”‚
   â”‚â”€â”€â”€â”€ SYN â”€â”€â”€â”€â”€â”€â–¶â”‚ â”€â”€â”
   â”‚                â”‚   â”‚ è¿›å…¥SYNé˜Ÿåˆ—
   â”‚â—€â”€â”€â”€ SYN+ACK â”€â”€â”‚ â—€â”€â”˜ (åŠè¿æ¥é˜Ÿåˆ—)
   â”‚â”€â”€â”€â”€ ACK â”€â”€â”€â”€â”€â”€â–¶â”‚ â”€â”€â”
   â”‚                â”‚   â”‚ è¿›å…¥Accepté˜Ÿåˆ—  
   â”‚                â”‚ â—€â”€â”˜ (å…¨è¿æ¥é˜Ÿåˆ—)
   â”‚                â”‚
  åº”ç”¨accept()å–èµ°è¿æ¥
```

**ğŸ“‹ ä¸¤ç§é˜Ÿåˆ—è¯´æ˜**
- **SYNé˜Ÿåˆ— (åŠè¿æ¥é˜Ÿåˆ—)**ï¼šå­˜å‚¨SYN_RCVDçŠ¶æ€çš„è¿æ¥
- **Accepté˜Ÿåˆ— (å…¨è¿æ¥é˜Ÿåˆ—)**ï¼šå­˜å‚¨ESTABLISHEDä½†æœªè¢«acceptçš„è¿æ¥

### 8.2 æŸ¥çœ‹è¿æ¥æ’é˜Ÿæƒ…å†µ


**ğŸ” é€šè¿‡netstatæŸ¥çœ‹æ’é˜Ÿ**
```bash
# æŸ¥çœ‹è¿æ¥çš„Recv-Qå’ŒSend-Q
netstat -antp
Proto Recv-Q Send-Q Local Address    Foreign Address    State       PID/Program
tcp        0      0 0.0.0.0:80       0.0.0.0:*          LISTEN      1234/nginx
tcp        0      0 192.168.1.10:80  203.0.113.15:8080  ESTABLISHED 1234/nginx
tcp       32      0 192.168.1.10:80  203.0.113.16:8081  ESTABLISHED 1234/nginx
```

**ğŸ“Š é˜Ÿåˆ—å­—æ®µå«ä¹‰**

| è¿æ¥çŠ¶æ€ | Recv-Qå«ä¹‰ | Send-Qå«ä¹‰ | æ­£å¸¸å€¼ |
|----------|------------|------------|--------|
| **LISTEN** | å½“å‰accepté˜Ÿåˆ—é•¿åº¦ | accepté˜Ÿåˆ—æœ€å¤§é•¿åº¦ | åº”è¯¥å¾ˆå° |
| **ESTABLISHED** | æ¥æ”¶ç¼“å†²åŒºæœªè¯»æ•°æ® | å‘é€ç¼“å†²åŒºæœªå‘æ•°æ® | åº”è¯¥ä¸º0æˆ–å¾ˆå° |

### 8.3 é˜Ÿåˆ—ç§¯å‹é—®é¢˜è¯Šæ–­


**ğŸš¨ ç§¯å‹é—®é¢˜è¯†åˆ«**
```bash
# æ£€æŸ¥ç›‘å¬ç«¯å£çš„é˜Ÿåˆ—ç§¯å‹
netstat -antp | grep LISTEN
tcp        5     128    0.0.0.0:80    0.0.0.0:*    LISTEN    1234/nginx
# Recv-Q=5è¡¨ç¤ºaccepté˜Ÿåˆ—ä¸­æœ‰5ä¸ªç­‰å¾…å¤„ç†çš„è¿æ¥
# Send-Q=128è¡¨ç¤ºaccepté˜Ÿåˆ—æœ€å¤§é•¿åº¦ä¸º128

# æ£€æŸ¥ESTABLISHEDè¿æ¥çš„ç¼“å†²åŒºç§¯å‹
netstat -antp | grep ESTABLISHED | awk '$2 > 0 || $3 > 0'
tcp       1024    0    192.168.1.10:80    client1:8080    ESTABLISHED
tcp         0   512    192.168.1.10:80    client2:8081    ESTABLISHED
# ç¬¬ä¸€ä¸ªè¿æ¥ï¼šæ¥æ”¶ç¼“å†²åŒºæœ‰1024å­—èŠ‚æœªè¯»æ•°æ®
# ç¬¬äºŒä¸ªè¿æ¥ï¼šå‘é€ç¼“å†²åŒºæœ‰512å­—èŠ‚æœªå‘é€æ•°æ®
```

**ğŸ”§ é—®é¢˜åŸå› åˆ†æ**

```
Accepté˜Ÿåˆ—ç§¯å‹åŸå› ï¼š
â–¡ åº”ç”¨ç¨‹åºaccept()è°ƒç”¨å¤ªæ…¢
â–¡ åº”ç”¨ç¨‹åºå¤„ç†è¿æ¥çš„é€Ÿåº¦è·Ÿä¸ä¸Š
â–¡ é˜Ÿåˆ—é•¿åº¦è®¾ç½®è¿‡å°
â–¡ çªå‘è¿æ¥æ•°è¶…è¿‡å¤„ç†èƒ½åŠ›

ç¼“å†²åŒºç§¯å‹åŸå› ï¼š
â–¡ ç½‘ç»œå»¶è¿Ÿæˆ–ä¸¢åŒ…å¯¼è‡´å‘é€ç¼“æ…¢
â–¡ å¯¹ç«¯å¤„ç†æ•°æ®é€Ÿåº¦æ…¢
â–¡ åº”ç”¨ç¨‹åºè¯»å–æ•°æ®é€Ÿåº¦æ…¢
â–¡ ç¼“å†²åŒºè®¾ç½®ä¸åˆç†
```

### 8.4 é˜Ÿåˆ—å‚æ•°è°ƒä¼˜


**ğŸ”§ ç³»ç»Ÿçº§é˜Ÿåˆ—å‚æ•°**
```bash
# æŸ¥çœ‹å½“å‰é˜Ÿåˆ—å‚æ•°
sysctl net.core.somaxconn          # accepté˜Ÿåˆ—æœ€å¤§é•¿åº¦
sysctl net.ipv4.tcp_max_syn_backlog  # SYNé˜Ÿåˆ—æœ€å¤§é•¿åº¦

# è°ƒæ•´é˜Ÿåˆ—å‚æ•°
echo 'net.core.somaxconn = 1024' >> /etc/sysctl.conf
echo 'net.ipv4.tcp_max_syn_backlog = 2048' >> /etc/sysctl.conf
sysctl -p
```

**ğŸ”§ åº”ç”¨çº§é˜Ÿåˆ—ä¼˜åŒ–**
```bash
# nginxé…ç½®ç¤ºä¾‹
listen 80 backlog=511;  # è®¾ç½®accepté˜Ÿåˆ—é•¿åº¦

# æ£€æŸ¥æ˜¯å¦ç”Ÿæ•ˆ
netstat -antp | grep :80
tcp    0    511    0.0.0.0:80    0.0.0.0:*    LISTEN    nginx
```

### 8.5 ç›‘æ§è„šæœ¬ç¤ºä¾‹


**ğŸ“Š é˜Ÿåˆ—ç›‘æ§è„šæœ¬**
```bash
#!/bin/bash
# è¿æ¥é˜Ÿåˆ—ç›‘æ§è„šæœ¬

echo "=== Accepté˜Ÿåˆ—ç›‘æ§ ==="
netstat -antp | grep LISTEN | while read line; do
    recv_q=$(echo $line | awk '{print $2}')
    send_q=$(echo $line | awk '{print $3}')
    port=$(echo $line | awk '{print $4}' | cut -d: -f2)
    
    if [ "$recv_q" -gt 10 ]; then
        echo "è­¦å‘Š: ç«¯å£$port accepté˜Ÿåˆ—ç§¯å‹ $recv_q ä¸ªè¿æ¥"
    fi
done

echo "=== ç¼“å†²åŒºç§¯å‹ç›‘æ§ ==="
netstat -antp | grep ESTABLISHED | awk '$2 > 1024 || $3 > 1024' | while read line; do
    recv_q=$(echo $line | awk '{print $2}')
    send_q=$(echo $line | awk '{print $3}')
    conn=$(echo $line | awk '{print $4"-"$5}')
    
    echo "è¿æ¥ç§¯å‹: $conn (Recv:$recv_q Send:$send_q)"
done
```

---

## 9. ğŸ” ç½‘ç»œæ€§èƒ½é—®é¢˜åˆæ­¥è¯Šæ–­


### 9.1 è¯Šæ–­æ€è·¯æ¡†æ¶


**ğŸ¯ è¯Šæ–­æµç¨‹å›¾**
```
ç½‘ç»œé—®é¢˜æŠ¥å‘Š
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¡®å®šé—®é¢˜   â”‚â”€â”€â”€â–¶â”‚  æ”¶é›†ä¿¡æ¯   â”‚â”€â”€â”€â–¶â”‚  åˆ†æå®šä½   â”‚
â”‚  ç°è±¡å’ŒèŒƒå›´ â”‚    â”‚  å’Œæ•°æ®     â”‚    â”‚  æ ¹æœ¬åŸå›    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                    â”‚                    â”‚
      â–¼                    â–¼                    â–¼
  å…·ä½“è¡¨ç°ç—‡çŠ¶        netstatç­‰å·¥å…·         åˆ¶å®šè§£å†³æ–¹æ¡ˆ
```

**ğŸ“‹ é—®é¢˜åˆ†ç±»**
- **è¿æ¥é—®é¢˜**ï¼šæ— æ³•å»ºç«‹è¿æ¥ã€è¿æ¥ä¸­æ–­
- **æ€§èƒ½é—®é¢˜**ï¼šå“åº”æ…¢ã€ååé‡ä½  
- **ä¸¢åŒ…é—®é¢˜**ï¼šæ•°æ®ä¼ è¾“ä¸å®Œæ•´
- **ç«¯å£é—®é¢˜**ï¼šæœåŠ¡æ— æ³•è®¿é—®

### 9.2 è¿æ¥é—®é¢˜è¯Šæ–­


**ğŸ”¸ æ— æ³•å»ºç«‹è¿æ¥**
```bash
# æ­¥éª¤1ï¼šæ£€æŸ¥æœåŠ¡æ˜¯å¦åœ¨ç›‘å¬
netstat -tlnp | grep :ç«¯å£å·
# å¦‚æœæ²¡æœ‰è¾“å‡ºï¼Œè¯´æ˜æœåŠ¡æœªå¯åŠ¨æˆ–æœªç›‘å¬è¯¥ç«¯å£

# æ­¥éª¤2ï¼šæ£€æŸ¥è¿æ¥çŠ¶æ€
netstat -antp | grep :ç«¯å£å·
# æŸ¥çœ‹æ˜¯å¦æœ‰SYN_SENTæˆ–SYN_RCVDçŠ¶æ€å¼‚å¸¸å¤š

# æ­¥éª¤3ï¼šæ£€æŸ¥é˜²ç«å¢™
iptables -L -n | grep ç«¯å£å·
# æˆ–è€…
firewall-cmd --list-all
```

**ğŸš¨ å…¸å‹æ•…éšœç°è±¡**
```
æ•…éšœ1ï¼šå¤§é‡SYN_SENTçŠ¶æ€
åŸå› ï¼šç›®æ ‡æœåŠ¡ä¸å¯è¾¾æˆ–æ‹’ç»è¿æ¥
è§£å†³ï¼šæ£€æŸ¥ç›®æ ‡æœåŠ¡çŠ¶æ€å’Œç½‘ç»œè¿é€šæ€§

æ•…éšœ2ï¼šå¤§é‡SYN_RCVDçŠ¶æ€  
åŸå› ï¼šå¯èƒ½é­å—SYN Floodæ”»å‡»
è§£å†³ï¼šæ£€æŸ¥è¿æ¥æ¥æºï¼Œè°ƒæ•´SYNé˜Ÿåˆ—å‚æ•°

æ•…éšœ3ï¼šTIME_WAITçŠ¶æ€è¿‡å¤š
åŸå› ï¼šè¿æ¥å…³é—­é¢‘ç¹ï¼Œå¯èƒ½å½±å“æ–°è¿æ¥å»ºç«‹
è§£å†³ï¼šè°ƒæ•´TIME_WAITç›¸å…³å‚æ•°
```

### 9.3 æ€§èƒ½é—®é¢˜è¯Šæ–­


**âš¡ æ€§èƒ½æŒ‡æ ‡æ£€æŸ¥**
```bash
# æ£€æŸ¥é‡ä¼ ç‡
netstat -st | grep -E "(segments retransmitted|segments sent)"
# è®¡ç®—é‡ä¼ ç‡ = é‡ä¼ æ•°/å‘é€æ•°ï¼Œæ­£å¸¸åº” < 1%

# æ£€æŸ¥è¿æ¥å¤±è´¥ç‡
netstat -st | grep -E "(failed connection|active connections)"
# å¤±è´¥ç‡è¿‡é«˜è¯´æ˜ç½‘ç»œæˆ–æœåŠ¡æœ‰é—®é¢˜

# æ£€æŸ¥ç¼“å†²åŒºç§¯å‹
netstat -antp | awk 'NR>2 {if($2>0||$3>0) print $0}'
# æŒç»­çš„ç¼“å†²åŒºç§¯å‹è¯´æ˜å¤„ç†èƒ½åŠ›ä¸è¶³
```

**ğŸ“Š å¸¦å®½ä½¿ç”¨åˆ†æ**
```bash
#!/bin/bash
# ç½‘ç»œå¸¦å®½ä½¿ç”¨åˆ†æ

interface="eth0"

# è·å–å½“å‰ç»Ÿè®¡
stats1=$(grep "$interface:" /proc/net/dev)
rx_bytes1=$(echo $stats1 | awk '{print $2}')
tx_bytes1=$(echo $stats1 | awk '{print $10}')

sleep 1

# ä¸€ç§’åå†æ¬¡è·å–
stats2=$(grep "$interface:" /proc/net/dev)
rx_bytes2=$(echo $stats2 | awk '{print $2}')
tx_bytes2=$(echo $stats2 | awk '{print $10}')

# è®¡ç®—æ¯ç§’å­—èŠ‚æ•°
rx_rate=$((rx_bytes2 - rx_bytes1))
tx_rate=$((tx_bytes2 - tx_bytes1))

echo "æ¥æ”¶é€Ÿç‡: $((rx_rate / 1024)) KB/s"
echo "å‘é€é€Ÿç‡: $((tx_rate / 1024)) KB/s"
```

### 9.4 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


**ğŸ”§ é—®é¢˜è§£å†³æŒ‡å—**

| é—®é¢˜ç°è±¡ | å¯èƒ½åŸå›  | è¯Šæ–­å‘½ä»¤ | è§£å†³æ–¹å‘ |
|----------|----------|----------|----------|
| **è¿æ¥è¶…æ—¶** | æœåŠ¡æœªå¯åŠ¨/é˜²ç«å¢™é˜»æ–­ | `netstat -tlnp` | å¯åŠ¨æœåŠ¡/è°ƒæ•´é˜²ç«å¢™ |
| **å“åº”æ…¢** | ç½‘ç»œå»¶è¿Ÿ/æœåŠ¡æ€§èƒ½å·® | `ping` + `netstat -s` | ä¼˜åŒ–ç½‘ç»œ/è°ƒä¼˜æœåŠ¡ |
| **è¿æ¥æ–­å¼€** | ç½‘ç»œä¸ç¨³å®š/èµ„æºä¸è¶³ | `netstat -st` æŸ¥çœ‹é‡ä¼  | æ£€æŸ¥ç½‘ç»œè´¨é‡ |
| **ç«¯å£æ— æ³•è®¿é—®** | ç›‘å¬åœ°å€é”™è¯¯ | `netstat -tlnp` æŸ¥çœ‹ç›‘å¬åœ°å€ | ä¿®æ”¹ç›‘å¬é…ç½® |

**ğŸš¨ ç´§æ€¥æ•…éšœå¤„ç†**
```bash
# å¿«é€Ÿæ•…éšœæ’æŸ¥è„šæœ¬
#!/bin/bash

echo "=== ç½‘ç»œæ•…éšœå¿«é€Ÿè¯Šæ–­ ==="

# 1. æ£€æŸ¥å…³é”®æœåŠ¡ç«¯å£
echo "1. æ£€æŸ¥æœåŠ¡çŠ¶æ€:"
for port in 22 80 443 3306; do
    count=$(netstat -tlnp | grep ":$port " | wc -l)
    if [ $count -eq 0 ]; then
        echo "è­¦å‘Š: ç«¯å£ $port æ— æœåŠ¡ç›‘å¬"
    else
        echo "æ­£å¸¸: ç«¯å£ $port æœ‰æœåŠ¡ç›‘å¬"
    fi
done

# 2. æ£€æŸ¥è¿æ¥çŠ¶æ€å¼‚å¸¸
echo -e "\n2. è¿æ¥çŠ¶æ€ç»Ÿè®¡:"
netstat -tan | awk 'NR>2{print $6}' | sort | uniq -c | sort -nr

# 3. æ£€æŸ¥æ˜¯å¦æœ‰å¤§é‡TIME_WAIT
time_wait_count=$(netstat -tan | grep TIME_WAIT | wc -l)
if [ $time_wait_count -gt 1000 ]; then
    echo "è­¦å‘Š: TIME_WAITè¿æ¥è¿‡å¤š ($time_wait_count)"
fi

# 4. æ£€æŸ¥ç½‘ç»œé”™è¯¯
echo -e "\n3. ç½‘ç»œé”™è¯¯ç»Ÿè®¡:"
netstat -st | grep -E "(failed|error|retransmitted)" | head -5
```

---

## 10. ğŸ› ï¸ å®æˆ˜åº”ç”¨ä¸æœ€ä½³å®è·µ


### 10.1 æ—¥å¸¸è¿ç»´æ£€æŸ¥


**ğŸ“ æ¯æ—¥æ£€æŸ¥æ¸…å•**
```bash
#!/bin/bash
# æ—¥å¸¸ç½‘ç»œçŠ¶æ€æ£€æŸ¥è„šæœ¬

echo "==================== æ—¥æœŸ: $(date) ===================="

echo -e "\n1. å…³é”®æœåŠ¡ç«¯å£æ£€æŸ¥:"
critical_ports=(22 80 443 53 25)
for port in "${critical_ports[@]}"; do
    service=$(netstat -tlnp | grep ":$port ")
    if [ -n "$service" ]; then
        echo "âœ… ç«¯å£ $port: $(echo $service | awk '{print $7}')"
    else
        echo "âŒ ç«¯å£ $port: æ— æœåŠ¡ç›‘å¬"
    fi
done

echo -e "\n2. è¿æ¥çŠ¶æ€åˆ†å¸ƒ:"
netstat -tan | awk 'NR>2{state[$6]++} END{for(i in state) printf "%-15s: %d\n", i, state[i]}'

echo -e "\n3. ç½‘ç»œæ¥å£çŠ¶æ€:"
netstat -i | awk 'NR>2{printf "%-8s RX: %s/%s  TX: %s/%s\n", $1, $4, $3, $8, $7}'

echo -e "\n4. è·¯ç”±è¡¨æ‘˜è¦:"
default_route=$(netstat -rn | grep "^0.0.0.0")
if [ -n "$default_route" ]; then
    echo "âœ… é»˜è®¤è·¯ç”±: $(echo $default_route | awk '{print $2}')"
else
    echo "âŒ æ— é»˜è®¤è·¯ç”±"
fi

echo -e "\n==================== æ£€æŸ¥å®Œæˆ ===================="
```

### 10.2 æ€§èƒ½ç›‘æ§è„šæœ¬


**ğŸ“Š å®æ—¶ç½‘ç»œç›‘æ§**
```bash
#!/bin/bash
# å®æ—¶ç½‘ç»œæ€§èƒ½ç›‘æ§

interface=${1:-eth0}  # é»˜è®¤ç›‘æ§eth0æ¥å£
interval=5           # 5ç§’æ›´æ–°é—´éš”

echo "å¼€å§‹ç›‘æ§ç½‘ç»œæ¥å£: $interface (æ¯${interval}ç§’æ›´æ–°)"
echo "æŒ‰ Ctrl+C åœæ­¢ç›‘æ§"

# è·å–åˆå§‹å€¼
get_stats() {
    grep "$interface:" /proc/net/dev | awk '{print $2,$3,$4,$5,$10,$11,$12,$13}'
}

prev_stats=($(get_stats))
sleep $interval

while true; do
    current_stats=($(get_stats))
    
    # è®¡ç®—å·®å€¼
    rx_bytes=$((${current_stats[0]} - ${prev_stats[0]}))
    rx_packets=$((${current_stats[1]} - ${prev_stats[1]}))
    rx_errors=$((${current_stats[2]} - ${prev_stats[2]}))
    rx_dropped=$((${current_stats[3]} - ${prev_stats[3]}))
    
    tx_bytes=$((${current_stats[4]} - ${prev_stats[4]}))
    tx_packets=$((${current_stats[5]} - ${prev_stats[5]}))
    tx_errors=$((${current_stats[6]} - ${prev_stats[6]}))
    tx_dropped=$((${current_stats[7]} - ${prev_stats[7]}))
    
    # è½¬æ¢å•ä½
    rx_kb=$((rx_bytes / 1024))
    tx_kb=$((tx_bytes / 1024))
    
    # æ˜¾ç¤ºç»“æœ
    printf "\r$(date +%H:%M:%S) "
    printf "RX: %4d KB/s %5d pps " $rx_kb $((rx_packets/interval))
    printf "TX: %4d KB/s %5d pps " $tx_kb $((tx_packets/interval))
    
    # æ˜¾ç¤ºé”™è¯¯ï¼ˆå¦‚æœæœ‰ï¼‰
    if [ $rx_errors -gt 0 ] || [ $tx_errors -gt 0 ]; then
        printf "ERR: RX:%d TX:%d " $rx_errors $tx_errors
    fi
    
    if [ $rx_dropped -gt 0 ] || [ $tx_dropped -gt 0 ]; then
        printf "DROP: RX:%d TX:%d " $rx_dropped $tx_dropped
    fi
    
    # ä¿å­˜å½“å‰å€¼ä¾›ä¸‹æ¬¡ä½¿ç”¨
    prev_stats=("${current_stats[@]}")
    
    sleep $interval
done
```

### 10.3 å®‰å…¨ç›‘æ§å®è·µ


**ğŸ”’ å®‰å…¨æ£€æŸ¥è„šæœ¬**
```bash
#!/bin/bash
# ç½‘ç»œå®‰å…¨çŠ¶æ€æ£€æŸ¥

echo "=== ç½‘ç»œå®‰å…¨æ£€æŸ¥æŠ¥å‘Š ==="

# 1. æ£€æŸ¥å¼‚å¸¸ç›‘å¬ç«¯å£
echo -e "\n1. ç›‘å¬ç«¯å£æ£€æŸ¥:"
echo "æ­£å¸¸æœåŠ¡ç«¯å£:"
netstat -tlnp | grep -E ":(22|53|80|443|25|993|995) " | while read line; do
    port=$(echo $line | awk '{print $4}' | cut -d: -f2)
    service=$(echo $line | awk '{print $7}')
    echo "  ç«¯å£ $port: $service"
done

echo -e "\nå¯ç–‘é«˜ç«¯å£ç›‘å¬:"
netstat -tlnp | awk '$4 ~ /:[0-9]{5}/ {print $4, $7}' | while read addr service; do
    port=$(echo $addr | cut -d: -f2)
    echo "  é«˜ç«¯å£ $port: $service"
done

# 2. æ£€æŸ¥å¤–éƒ¨è¿æ¥
echo -e "\n2. å¤–éƒ¨è¿æ¥åˆ†æ:"
echo "å½“å‰å¤–éƒ¨è¿æ¥æ•°é‡:"
netstat -antp | grep ESTABLISHED | grep -v "127.0.0.1\|::1" | wc -l

echo "è¿æ¥æœ€å¤šçš„å¤–éƒ¨IP:"
netstat -antp | grep ESTABLISHED | awk '{print $5}' | cut -d: -f1 | \
    grep -v "127.0.0.1\|::1" | sort | uniq -c | sort -nr | head -5

# 3. æ£€æŸ¥SYN Floodæ”»å‡»è¿¹è±¡
echo -e "\n3. SYN Floodæ£€æŸ¥:"
syn_recv_count=$(netstat -tan | grep SYN_RECV | wc -l)
if [ $syn_recv_count -gt 100 ]; then
    echo "è­¦å‘Š: SYN_RECVçŠ¶æ€è¿æ¥è¿‡å¤š ($syn_recv_count)ï¼Œå¯èƒ½é­å—SYN Floodæ”»å‡»"
    echo "æ”»å‡»æ¥æºIPç»Ÿè®¡:"
    netstat -tan | grep SYN_RECV | awk '{print $5}' | cut -d: -f1 | \
        sort | uniq -c | sort -nr | head -5
else
    echo "æ­£å¸¸: SYN_RECVè¿æ¥æ•° $syn_recv_count"
fi

# 4. æ£€æŸ¥TIME_WAITè¿‡å¤š
echo -e "\n4. TIME_WAITçŠ¶æ€æ£€æŸ¥:"
time_wait_count=$(netstat -tan | grep TIME_WAIT | wc -l)
if [ $time_wait_count -gt 2000 ]; then
    echo "è­¦å‘Š: TIME_WAITè¿æ¥è¿‡å¤š ($time_wait_count)"
else
    echo "æ­£å¸¸: TIME_WAITè¿æ¥æ•° $time_wait_count"
fi
```

### 10.4 æ•…éšœå¤„ç†é¢„æ¡ˆ


**ğŸš¨ å¸¸è§æ•…éšœåº”æ€¥å¤„ç†**

```bash
#!/bin/bash
# ç½‘ç»œæ•…éšœåº”æ€¥å¤„ç†è„šæœ¬

case $1 in
    "port-check")
        # ç«¯å£å ç”¨æ£€æŸ¥
        port=$2
        if [ -z "$port" ]; then
            echo "ç”¨æ³•: $0 port-check <ç«¯å£å·>"
            exit 1
        fi
        
        echo "æ£€æŸ¥ç«¯å£ $port çš„ä½¿ç”¨æƒ…å†µ:"
        netstat -tlnp | grep ":$port "
        if [ $? -eq 0 ]; then
            echo "ç«¯å£ $port å·²è¢«å ç”¨"
        else
            echo "ç«¯å£ $port ç©ºé—²"
        fi
        ;;
        
    "conn-reset")
        # é‡ç½®å¼‚å¸¸è¿æ¥
        echo "æŸ¥æ‰¾å¼‚å¸¸è¿æ¥å¹¶é‡ç½®..."
        netstat -antp | grep -E "FIN_WAIT|CLOSE_WAIT" | while read line; do
            local_addr=$(echo $line | awk '{print $4}')
            foreign_addr=$(echo $line | awk '{print $5}')
            echo "å‘ç°å¼‚å¸¸è¿æ¥: $local_addr -> $foreign_addr"
        done
        ;;
        
    "bandwidth")
        # æ£€æŸ¥å¸¦å®½ä½¿ç”¨
        interface=${2:-eth0}
        echo "æ£€æŸ¥æ¥å£ $interface çš„å¸¦å®½ä½¿ç”¨:"
        
        # ç®€å•çš„å¸¦å®½æ£€æŸ¥
        stats1=$(grep "$interface:" /proc/net/dev)
        rx1=$(echo $stats1 | awk '{print $2}')
        tx1=$(echo $stats1 | awk '{print $10}')
        
        sleep 1
        
        stats2=$(grep "$interface:" /proc/net/dev)
        rx2=$(echo $stats2 | awk '{print $2}')
        tx2=$(echo $stats2 | awk '{print $10}')
        
        rx_rate=$(((rx2 - rx1) / 1024))
        tx_rate=$(((tx2 - tx1) / 1024))
        
        echo "å½“å‰å¸¦å®½ä½¿ç”¨: RX ${rx_rate} KB/s, TX ${tx_rate} KB/s"
        ;;
        
    *)
        echo "ç½‘ç»œæ•…éšœåº”æ€¥å¤„ç†å·¥å…·"
        echo "ç”¨æ³•: $0 <é€‰é¡¹>"
        echo "é€‰é¡¹:"
        echo "  port-check <ç«¯å£>     æ£€æŸ¥ç«¯å£å ç”¨"
        echo "  conn-reset           æŸ¥æ‰¾å¼‚å¸¸è¿æ¥"
        echo "  bandwidth [æ¥å£]     æ£€æŸ¥å¸¦å®½ä½¿ç”¨"
        ;;
esac
```

### 10.5 æœ€ä½³å®è·µæ€»ç»“


**âœ… è¿ç»´æœ€ä½³å®è·µ**

> ğŸ¯ **ç›‘æ§ç­–ç•¥**
> - å®šæœŸæ£€æŸ¥å…³é”®æœåŠ¡ç«¯å£çŠ¶æ€
> - ç›‘æ§ç½‘ç»œç»Ÿè®¡æŒ‡æ ‡å˜åŒ–è¶‹åŠ¿  
> - è®¾ç½®è¿æ¥æ•°å’Œé”™è¯¯ç‡å‘Šè­¦é˜ˆå€¼
> - å»ºç«‹ç½‘ç»œæ€§èƒ½åŸºçº¿

> ğŸ”’ **å®‰å…¨å®è·µ**
> - å®šæœŸå®¡è®¡ç›‘å¬ç«¯å£å’ŒæœåŠ¡
> - ç›‘æ§å¼‚å¸¸ç½‘ç»œè¿æ¥æ¨¡å¼
> - å…³æ³¨SYN Floodç­‰æ”»å‡»è¿¹è±¡
> - é™åˆ¶ä¸å¿…è¦çš„å¤–éƒ¨ç½‘ç»œè®¿é—®

> âš¡ **æ€§èƒ½ä¼˜åŒ–**
> - åˆç†é…ç½®TCPé˜Ÿåˆ—å‚æ•°
> - ç›‘æ§ç¼“å†²åŒºä½¿ç”¨æƒ…å†µ
> - ä¼˜åŒ–TIME_WAITå‚æ•°è®¾ç½®
> - å®šæœŸåˆ†æç½‘ç»œç“¶é¢ˆ

---

## 11. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 11.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ netstatæœ¬è´¨ï¼šç½‘ç»œè¿æ¥çŠ¶æ€çš„å…¨é¢ä½“æ£€å·¥å…·
ğŸ”¸ å‚æ•°ç»„åˆï¼š-tlnpæŸ¥æœåŠ¡ã€-anpæŸ¥è¿æ¥ã€-sæŸ¥ç»Ÿè®¡ã€-ræŸ¥è·¯ç”±  
ğŸ”¸ è¿æ¥çŠ¶æ€ï¼šLISTENç›‘å¬ã€ESTABLISHEDé€šä¿¡ã€TIME_WAITå…³é—­ç­‰å¾…
ğŸ”¸ é˜Ÿåˆ—ç›‘æ§ï¼šRecv-Qå’ŒSend-Qåæ˜ è¿æ¥å¤„ç†å’Œç¼“å†²åŒºçŠ¶æ€
ğŸ”¸ æ€§èƒ½æŒ‡æ ‡ï¼šé‡ä¼ ç‡ã€é”™è¯¯ç‡ã€ä¸¢åŒ…ç‡æ˜¯å…³é”®æ€§èƒ½æŒ‡æ ‡
```

### 11.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆnetstatå¦‚æ­¤é‡è¦**
```
ç½‘ç»œè¯Šæ–­ä»·å€¼ï¼š
- å¿«é€Ÿå‘ç°ç½‘ç»œè¿æ¥é—®é¢˜
- è¯†åˆ«æ€§èƒ½ç“¶é¢ˆå’Œå¼‚å¸¸
- æä¾›æ•…éšœæ’æŸ¥çš„ç¬¬ä¸€æ‰‹ä¿¡æ¯
- ç›‘æ§ç³»ç»Ÿå®‰å…¨çŠ¶æ€

å®é™…å·¥ä½œä¸­çš„ä½œç”¨ï¼š
- æœåŠ¡éƒ¨ç½²åçš„çŠ¶æ€éªŒè¯
- æ€§èƒ½é—®é¢˜çš„åˆæ­¥å®šä½
- å®‰å…¨äº‹ä»¶çš„çº¿ç´¢æ”¶é›†
- å®¹é‡è§„åˆ’çš„æ•°æ®æ”¯æ’‘
```

**ğŸ”¹ å„ç§çŠ¶æ€çš„å®é™…å«ä¹‰**
```
LISTENçŠ¶æ€ï¼š
- æœåŠ¡æ­£å¸¸å¯åŠ¨å¹¶ç­‰å¾…è¿æ¥
- æ•°é‡åº”è¯¥ç¨³å®šï¼Œçªç„¶æ¶ˆå¤±è¯´æ˜æœåŠ¡å¼‚å¸¸

ESTABLISHEDçŠ¶æ€ï¼š
- æ­£å¸¸çš„æ•°æ®ä¼ è¾“è¿æ¥
- æ•°é‡åæ˜ å½“å‰ç³»ç»Ÿè´Ÿè½½

TIME_WAITçŠ¶æ€ï¼š
- è¿æ¥æ­£å¸¸å…³é—­åçš„æ¸…ç†æœŸ
- æ•°é‡è¿‡å¤šå¯èƒ½å½±å“æ–°è¿æ¥å»ºç«‹
```

**ğŸ”¹ æ’é˜Ÿæœºåˆ¶çš„é‡è¦æ€§**
```
é˜Ÿåˆ—çš„ä½œç”¨ï¼š
- ç¼“å†²çªå‘è¿æ¥è¯·æ±‚
- ä¿è¯è¿æ¥å»ºç«‹çš„å¯é æ€§
- æä¾›ç³»ç»Ÿè¿‡è½½ä¿æŠ¤

é˜Ÿåˆ—ç§¯å‹çš„å±å®³ï¼š
- æ–°è¿æ¥å»ºç«‹å»¶è¿Ÿ
- ç³»ç»Ÿå“åº”èƒ½åŠ›ä¸‹é™
- å¯èƒ½å¯¼è‡´è¿æ¥è¶…æ—¶å¤±è´¥
```

### 11.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ æ—¥å¸¸ä½¿ç”¨å»ºè®®**

```
åŸºç¡€æ£€æŸ¥å‘½ä»¤ï¼š
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
netstat -tlnp

# æ£€æŸ¥è¿æ¥æƒ…å†µ  
netstat -antp | head -20

# ç›‘æ§ç½‘ç»œè´¨é‡
netstat -s | grep -E "(failed|error|retransmitted)"

# æ£€æŸ¥è·¯ç”±çŠ¶æ€
netstat -rn
```

**ğŸ”§ æ•…éšœæ’æŸ¥æµç¨‹**
```
1. ç¡®å®šé—®é¢˜ç°è±¡
   â†’ æ— æ³•è¿æ¥ / å“åº”æ…¢ / è¿æ¥ä¸­æ–­

2. åŸºç¡€çŠ¶æ€æ£€æŸ¥
   â†’ netstat -tlnp ç¡®è®¤æœåŠ¡æ˜¯å¦ç›‘å¬
   â†’ netstat -antp æŸ¥çœ‹è¿æ¥çŠ¶æ€åˆ†å¸ƒ

3. æ·±å…¥åˆ†æ
   â†’ netstat -s æŸ¥çœ‹ç½‘ç»œç»Ÿè®¡
   â†’ æ£€æŸ¥é˜Ÿåˆ—ç§¯å‹æƒ…å†µ
   â†’ åˆ†æé”™è¯¯å’Œé‡ä¼ æŒ‡æ ‡

4. å®šä½æ ¹æœ¬åŸå› 
   â†’ æœåŠ¡é…ç½®é—®é¢˜ / ç½‘ç»œè´¨é‡é—®é¢˜ / èµ„æºä¸è¶³
```

**ğŸš¨ å‘Šè­¦é˜ˆå€¼å»ºè®®**
```
å»ºè®®ç›‘æ§æŒ‡æ ‡ï¼š
- å…³é”®æœåŠ¡ç«¯å£ç›‘å¬çŠ¶æ€ (å¿…é¡»100%åœ¨çº¿)
- ç½‘ç»œé”™è¯¯ç‡ < 0.1%
- è¿æ¥é˜Ÿåˆ—ç§¯å‹ < é˜Ÿåˆ—å®¹é‡çš„50%
- TIME_WAITè¿æ¥æ•° < 10000
- é‡ä¼ ç‡ < 1%
```

### 11.4 è¿›é˜¶å­¦ä¹ æ–¹å‘


**ğŸ“ˆ æ‰©å±•çŸ¥è¯†**
- **sså‘½ä»¤**ï¼šnetstatçš„ç°ä»£åŒ–æ›¿ä»£å·¥å…·
- **tcpdump**ï¼šæ•°æ®åŒ…çº§åˆ«çš„ç½‘ç»œåˆ†æ
- **sar**ï¼šç³»ç»Ÿçº§ç½‘ç»œæ€§èƒ½ç›‘æ§
- **nmon**ï¼šç»¼åˆæ€§ç³»ç»Ÿç›‘æ§å·¥å…·

**ğŸ”§ è‡ªåŠ¨åŒ–è¿ç»´**
- ç¼–å†™ç½‘ç»œç›‘æ§è„šæœ¬
- é›†æˆåˆ°ç›‘æ§ç³»ç»Ÿ(Zabbix/Prometheus)
- è®¾ç½®è‡ªåŠ¨å‘Šè­¦æœºåˆ¶
- å»ºç«‹æ•…éšœå¤„ç†çŸ¥è¯†åº“

**æ ¸å¿ƒè®°å¿†**ï¼š
- netstatçœ‹ç½‘ç»œï¼ŒçŠ¶æ€è¿æ¥å…¨çŸ¥é“
- tlnpæŸ¥æœåŠ¡ï¼Œanpçœ‹è¿æ¥ä¸ä¼šé”™  
- é˜Ÿåˆ—å’Œç»Ÿè®¡ï¼Œæ€§èƒ½é—®é¢˜æ—©å‘ç°
- ç»“åˆå…¶ä»–å·¥å…·ï¼Œç½‘ç»œè¿ç»´æ›´ä¸“ä¸š

> ğŸ’¡ **å­¦ä¹ å»ºè®®**ï¼šnetstatæ˜¯ç½‘ç»œè¿ç»´çš„åŸºç¡€å·¥å…·ï¼Œç†Ÿç»ƒæŒæ¡å®ƒçš„å„ç§ç”¨æ³•æ˜¯æ¯ä¸ªLinuxç®¡ç†å‘˜çš„å¿…å¤‡æŠ€èƒ½ã€‚å»ºè®®å¤šåœ¨å®é™…ç¯å¢ƒä¸­ç»ƒä¹ ï¼Œç»“åˆçœŸå®çš„ç½‘ç»œé—®é¢˜æ¥åŠ æ·±ç†è§£ã€‚