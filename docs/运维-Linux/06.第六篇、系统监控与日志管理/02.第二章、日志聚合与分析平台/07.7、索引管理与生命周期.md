---
title: 7ã€ç´¢å¼•ç®¡ç†ä¸ç”Ÿå‘½å‘¨æœŸ
---
## ğŸ“š ç›®å½•


1. [ç´¢å¼•ç®¡ç†åŸºç¡€æ¦‚å¿µ](#1-ç´¢å¼•ç®¡ç†åŸºç¡€æ¦‚å¿µ)
2. [ç´¢å¼•å‘½åè§„èŒƒä¸ç­–ç•¥](#2-ç´¢å¼•å‘½åè§„èŒƒä¸ç­–ç•¥)
3. [æ—¶é—´åºåˆ—ç´¢å¼•è®¾è®¡](#3-æ—¶é—´åºåˆ—ç´¢å¼•è®¾è®¡)
4. [Index Lifecycle Managementé…ç½®](#4-index-lifecycle-managementé…ç½®)
5. [ç´¢å¼•æ»šåŠ¨ä¸å½’æ¡£ç­–ç•¥](#5-ç´¢å¼•æ»šåŠ¨ä¸å½’æ¡£ç­–ç•¥)
6. [å†·çƒ­æ•°æ®åˆ†å±‚å­˜å‚¨](#6-å†·çƒ­æ•°æ®åˆ†å±‚å­˜å‚¨)
7. [ç´¢å¼•åˆ é™¤ä¸æ¸…ç†ç­–ç•¥](#7-ç´¢å¼•åˆ é™¤ä¸æ¸…ç†ç­–ç•¥)
8. [ç´¢å¼•æ¨¡æ¿ç®¡ç†](#8-ç´¢å¼•æ¨¡æ¿ç®¡ç†)
9. [ç´¢å¼•åˆ«åä½¿ç”¨æŠ€å·§](#9-ç´¢å¼•åˆ«åä½¿ç”¨æŠ€å·§)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

# ğŸ¯ **å­¦ä¹ è·¯å¾„å¯¼èˆª**


**å‰ç½®çŸ¥è¯†**ï¼šéœ€è¦æŒæ¡ElasticsearchåŸºç¡€ã€é›†ç¾¤æ¦‚å¿µã€ç´¢å¼•ç»“æ„ â†’ **å½“å‰å†…å®¹**ï¼šç´¢å¼•ç”Ÿå‘½å‘¨æœŸç®¡ç† â†’ **åç»­å­¦ä¹ **ï¼šå»ºè®®å­¦ä¹ æ€§èƒ½è°ƒä¼˜ã€ç›‘æ§å‘Šè­¦

â±ï¸ **é¢„è®¡å­¦ä¹ æ—¶é—´**ï¼šæœ¬ç« é¢„è®¡90åˆ†é’Ÿ | å®è·µé…ç½®45åˆ†é’Ÿ

---

## 1. ğŸ“– ç´¢å¼•ç®¡ç†åŸºç¡€æ¦‚å¿µ



### 1.1 ä»€ä¹ˆæ˜¯ç´¢å¼•ç”Ÿå‘½å‘¨æœŸç®¡ç†



**ğŸ”¸ æ ¸å¿ƒå®šä¹‰**
```
ç´¢å¼•ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ˆILMï¼‰ï¼šè‡ªåŠ¨ç®¡ç†ç´¢å¼•ä»åˆ›å»ºåˆ°åˆ é™¤çš„æ•´ä¸ªè¿‡ç¨‹
ç›®çš„ï¼šæ ¹æ®æ•°æ®çš„ä½¿ç”¨æ¨¡å¼ï¼Œè‡ªåŠ¨ä¼˜åŒ–å­˜å‚¨æˆæœ¬å’ŒæŸ¥è¯¢æ€§èƒ½
æœ¬è´¨ï¼šè®©æ•°æ®åœ¨ä¸åŒé˜¶æ®µé‡‡ç”¨æœ€åˆé€‚çš„å­˜å‚¨å’Œå¤„ç†æ–¹å¼
```

**ğŸ’¡ é€šä¿—ç†è§£**
å°±åƒäººçš„ä¸€ç”Ÿæœ‰ä¸åŒé˜¶æ®µï¼š
- **å©´å¹¼å„¿æœŸ**ï¼ˆHoté˜¶æ®µï¼‰ï¼šéœ€è¦ç²¾å¿ƒç…§æ–™ï¼Œé¢‘ç¹è®¿é—®
- **é’å£®å¹´æœŸ**ï¼ˆWarmé˜¶æ®µï¼‰ï¼šç›¸å¯¹ç¨³å®šï¼Œå¶å°”éœ€è¦å…³æ³¨
- **è€å¹´æœŸ**ï¼ˆColdé˜¶æ®µï¼‰ï¼šå¾ˆå°‘æ´»åŠ¨ï¼Œä½†éœ€è¦ä¿ç•™
- **èº«åäº‹**ï¼ˆDeleteé˜¶æ®µï¼‰ï¼šæœ€ç»ˆéœ€è¦å¤„ç†

### 1.2 ç´¢å¼•ç”Ÿå‘½å‘¨æœŸçš„ä»·å€¼



**ğŸ¯ æ ¸å¿ƒä»·å€¼**
```
æˆæœ¬ä¼˜åŒ–ï¼š
â€¢ çƒ­æ•°æ®ç”¨é«˜æ€§èƒ½å­˜å‚¨ï¼Œå†·æ•°æ®ç”¨ä½æˆæœ¬å­˜å‚¨
â€¢ è‡ªåŠ¨å‹ç¼©å½’æ¡£ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´
â€¢ è¿‡æœŸæ•°æ®è‡ªåŠ¨åˆ é™¤ï¼Œé¿å…æ— é™å¢é•¿

æ€§èƒ½æå‡ï¼š
â€¢ æ–°æ•°æ®åœ¨é«˜æ€§èƒ½èŠ‚ç‚¹ï¼ŒæŸ¥è¯¢é€Ÿåº¦å¿«
â€¢ è€æ•°æ®è¿ç§»åˆ°ä¸“ç”¨èŠ‚ç‚¹ï¼Œä¸å½±å“å®æ—¶æŸ¥è¯¢
â€¢ åˆç†çš„åˆ†ç‰‡ç­–ç•¥ï¼Œé¿å…å°åˆ†ç‰‡é—®é¢˜

è¿ç»´ç®€åŒ–ï¼š
â€¢ è‡ªåŠ¨åŒ–ç®¡ç†ï¼Œå‡å°‘äººå·¥å¹²é¢„
â€¢ æ ‡å‡†åŒ–æµç¨‹ï¼Œé¿å…è¯¯æ“ä½œ
â€¢ ç­–ç•¥åŒ–é…ç½®ï¼Œæ˜“äºç»´æŠ¤
```

### 1.3 ç”Ÿå‘½å‘¨æœŸå››ä¸ªé˜¶æ®µ



```
ç´¢å¼•ç”Ÿå‘½å‘¨æœŸé˜¶æ®µï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Hot   â”‚â”€â”€â”€â–¶â”‚  Warm   â”‚â”€â”€â”€â–¶â”‚  Cold   â”‚â”€â”€â”€â–¶â”‚ Delete  â”‚
â”‚ çƒ­æ•°æ®   â”‚    â”‚ æ¸©æ•°æ®   â”‚    â”‚ å†·æ•°æ®   â”‚    â”‚ åˆ é™¤    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Hoté˜¶æ®µï¼š
â€¢ é¢‘ç¹å†™å…¥å’ŒæŸ¥è¯¢
â€¢ é«˜æ€§èƒ½SSDå­˜å‚¨
â€¢ æ›´å¤šå‰¯æœ¬ä¿è¯å¯ç”¨æ€§

Warmé˜¶æ®µï¼š
â€¢ åªè¯»ï¼Œå¶å°”æŸ¥è¯¢
â€¢ å¯ä»¥å‡å°‘å‰¯æœ¬æ•°
â€¢ å¯ä»¥è¿ç§»åˆ°ä¾¿å®œå­˜å‚¨

Coldé˜¶æ®µï¼š
â€¢ å¾ˆå°‘æŸ¥è¯¢
â€¢ é«˜å‹ç¼©æ¯”å­˜å‚¨
â€¢ æœ€å°‘çš„å‰¯æœ¬æ•°

Deleteé˜¶æ®µï¼š
â€¢ è¾¾åˆ°ä¿ç•™æœŸé™
â€¢ è‡ªåŠ¨åˆ é™¤é‡Šæ”¾ç©ºé—´
```

---

## 2. ğŸ·ï¸ ç´¢å¼•å‘½åè§„èŒƒä¸ç­–ç•¥



### 2.1 ç´¢å¼•å‘½åæœ€ä½³å®è·µ



**ğŸ“ å‘½åè§„èŒƒè®¾è®¡**
```
æ ‡å‡†å‘½åæ ¼å¼ï¼š
{åº”ç”¨å}-{æ•°æ®ç±»å‹}-{æ—¶é—´}{ç¯å¢ƒæ ‡è¯†}

ç¤ºä¾‹å‘½åï¼š
â€¢ web-access-2024.01.15        # Webè®¿é—®æ—¥å¿—
â€¢ app-error-2024.01-prod       # åº”ç”¨é”™è¯¯æ—¥å¿—  
â€¢ nginx-metrics-2024.01.15-dev # Nginxç›‘æ§æ•°æ®
â€¢ order-events-2024.01         # è®¢å•äº‹ä»¶æ•°æ®
```

**ğŸ” å‘½åè¦ç´ è¯¦è§£**
```bash
# 1. åº”ç”¨æ ‡è¯†

web          # WebæœåŠ¡
app          # åº”ç”¨æœåŠ¡
db           # æ•°æ®åº“
nginx        # NginxæœåŠ¡

# 2. æ•°æ®ç±»å‹

access       # è®¿é—®æ—¥å¿—
error        # é”™è¯¯æ—¥å¿—
metrics      # ç›‘æ§æŒ‡æ ‡
events       # äº‹ä»¶æ•°æ®
audit        # å®¡è®¡æ—¥å¿—

# 3. æ—¶é—´ç»´åº¦

2024.01.15   # æŒ‰å¤©åˆ†å‰²
2024.01      # æŒ‰æœˆåˆ†å‰²
2024-w03     # æŒ‰å‘¨åˆ†å‰²
2024-q1      # æŒ‰å­£åº¦åˆ†å‰²

# 4. ç¯å¢ƒæ ‡è¯†

-prod        # ç”Ÿäº§ç¯å¢ƒ
-dev         # å¼€å‘ç¯å¢ƒ
-test        # æµ‹è¯•ç¯å¢ƒ
```

### 2.2 åˆ†å‰²ç­–ç•¥é€‰æ‹©



**ğŸ“Š æ—¶é—´åˆ†å‰²å¯¹æ¯”**

| **åˆ†å‰²æ–¹å¼** | **é€‚ç”¨åœºæ™¯** | **ç´¢å¼•æ•°é‡** | **å•ç´¢å¼•å¤§å°** | **æŸ¥è¯¢æ€§èƒ½** |
|-------------|-------------|-------------|---------------|-------------|
| **æŒ‰å°æ—¶** | é«˜é¢‘å†™å…¥ | å¤š | å° | å¿«é€Ÿå®šä½ |
| **æŒ‰å¤©** | å¸¸è§„æ—¥å¿— | ä¸­ç­‰ | ä¸­ç­‰ | å¹³è¡¡ |
| **æŒ‰å‘¨** | ä½é¢‘æ•°æ® | å°‘ | å¤§ | èŒƒå›´æŸ¥è¯¢å¥½ |
| **æŒ‰æœˆ** | å½’æ¡£æ•°æ® | å¾ˆå°‘ | å¾ˆå¤§ | å­˜å‚¨æ•ˆç‡é«˜ |

**ğŸ’¡ é€‰æ‹©å»ºè®®**
```
é«˜é¢‘æ—¥å¿—ï¼ˆ>1GB/å¤©ï¼‰ï¼šæŒ‰å¤©åˆ†å‰²
- web-access-2024.01.15
- api-requests-2024.01.15

ä¸­é¢‘æ—¥å¿—ï¼ˆ100MB-1GB/å¤©ï¼‰ï¼šæŒ‰å¤©æˆ–æŒ‰å‘¨
- app-error-2024.01.15
- audit-logs-2024-w03

ä½é¢‘æ—¥å¿—ï¼ˆ<100MB/å¤©ï¼‰ï¼šæŒ‰æœˆåˆ†å‰²
- system-events-2024.01
- security-audit-2024.01
```

### 2.3 å‘½åè§„èŒƒå®æ–½



**ğŸ› ï¸ é…ç½®æ¨¡æ¿ç¤ºä¾‹**
```json
{
  "index_patterns": ["web-access-*"],
  "template": {
    "settings": {
      "index": {
        "lifecycle": {
          "name": "web-access-policy",
          "rollover_alias": "web-access-active"
        },
        "number_of_shards": 1,
        "number_of_replicas": 1
      }
    },
    "mappings": {
      "properties": {
        "@timestamp": {
          "type": "date"
        },
        "ip": {
          "type": "ip"
        },
        "status": {
          "type": "integer"
        }
      }
    }
  }
}
```

---

## 3. â° æ—¶é—´åºåˆ—ç´¢å¼•è®¾è®¡



### 3.1 æ—¶é—´åºåˆ—æ•°æ®ç‰¹ç‚¹



**ğŸ“ˆ æ—¶é—´åºåˆ—æ•°æ®æ¨¡å¼**
```
æ—¶é—´åºåˆ—æ•°æ®ç‰¹å¾ï¼š

æ—¶é—´æœ‰åºæ€§ï¼š
â€¢ æ•°æ®æŒ‰æ—¶é—´é¡ºåºäº§ç”Ÿ
â€¢ æ–°æ•°æ®æ€»æ˜¯è¿½åŠ å†™å…¥
â€¢ æŸ¥è¯¢å¤šé›†ä¸­åœ¨æœ€è¿‘æ—¶é—´

è®¿é—®æ¨¡å¼ï¼š
â€¢ 80%æŸ¥è¯¢é›†ä¸­åœ¨æœ€è¿‘7å¤©
â€¢ 15%æŸ¥è¯¢é›†ä¸­åœ¨æœ€è¿‘30å¤©  
â€¢ 5%æŸ¥è¯¢æ¶‰åŠå†å²æ•°æ®

å†™å…¥æ¨¡å¼ï¼š
â€¢ æŒç»­é«˜é¢‘å†™å…¥
â€¢ å‡ ä¹æ²¡æœ‰æ›´æ–°æ“ä½œ
â€¢ æ•°æ®é‡éšæ—¶é—´çº¿æ€§å¢é•¿
```

### 3.2 æ»šåŠ¨ç´¢å¼•ç­–ç•¥



**ğŸ”„ è‡ªåŠ¨æ»šåŠ¨é…ç½®**
```json
{
  "policy": {
    "phases": {
      "hot": {
        "actions": {
          "rollover": {
            "max_size": "5GB",
            "max_age": "1d",
            "max_docs": 1000000
          }
        }
      }
    }
  }
}
```

**ğŸ’¡ æ»šåŠ¨æ¡ä»¶è¯´æ˜**
```
å¤§å°æ¡ä»¶ï¼šmax_size = "5GB"
â€¢ ç´¢å¼•è¾¾åˆ°5GBè‡ªåŠ¨æ»šåŠ¨
â€¢ é¿å…å•ä¸ªç´¢å¼•è¿‡å¤§å½±å“æ€§èƒ½

æ—¶é—´æ¡ä»¶ï¼šmax_age = "1d" 
â€¢ æ¯å¤©åˆ›å»ºæ–°ç´¢å¼•
â€¢ ä¾¿äºæŒ‰å¤©ç®¡ç†å’ŒæŸ¥è¯¢

æ–‡æ¡£æ•°ï¼šmax_docs = 1000000
â€¢ æ–‡æ¡£æ•°è¾¾åˆ°100ä¸‡è‡ªåŠ¨æ»šåŠ¨
â€¢ æ§åˆ¶åˆ†ç‰‡å¤§å°é€‚ä¸­
```

### 3.3 ç´¢å¼•åˆ†ç‰‡ç­–ç•¥



**âš–ï¸ åˆ†ç‰‡æ•°é‡è§„åˆ’**
```bash
# åˆ†ç‰‡æ•°é‡è®¡ç®—å…¬å¼

åˆ†ç‰‡æ•° = ç´¢å¼•å¤§å° / ç›®æ ‡åˆ†ç‰‡å¤§å°

# æ¨èåˆ†ç‰‡å¤§å°

ç›®æ ‡åˆ†ç‰‡å¤§å°ï¼š10GB - 50GB

# å®é™…é…ç½®ç¤ºä¾‹

å°ç´¢å¼•ï¼ˆ<10GBï¼‰   â†’ 1ä¸ªåˆ†ç‰‡
ä¸­ç­‰ç´¢å¼•ï¼ˆ10-50GBï¼‰ â†’ 2-5ä¸ªåˆ†ç‰‡  
å¤§ç´¢å¼•ï¼ˆ>50GBï¼‰    â†’ æ ¹æ®å…¬å¼è®¡ç®—

# å‰¯æœ¬æ•°é‡ç­–ç•¥

ç”Ÿäº§ç¯å¢ƒï¼šè‡³å°‘1ä¸ªå‰¯æœ¬ï¼ˆå®¹é”™ï¼‰
æµ‹è¯•ç¯å¢ƒï¼š0ä¸ªå‰¯æœ¬ï¼ˆèŠ‚çœèµ„æºï¼‰
```

**ğŸ”§ åŠ¨æ€åˆ†ç‰‡é…ç½®**
```json
{
  "template": {
    "settings": {
      "index": {
        "number_of_shards": "{{ (doc_count / 10000000) | round(0, 'ceil') | max(1) }}",
        "number_of_replicas": 1,
        "refresh_interval": "30s"
      }
    }
  }
}
```

---

## 4. ğŸ”„ Index Lifecycle Managementé…ç½®



### 4.1 ILMç­–ç•¥åˆ›å»º



**ğŸ“‹ åŸºç¡€ILMç­–ç•¥**
```json
{
  "policy": {
    "phases": {
      "hot": {
        "min_age": "0ms",
        "actions": {
          "rollover": {
            "max_size": "5GB",
            "max_age": "1d"
          },
          "set_priority": {
            "priority": 100
          }
        }
      },
      "warm": {
        "min_age": "7d",
        "actions": {
          "set_priority": {
            "priority": 50
          },
          "allocate": {
            "number_of_replicas": 0
          },
          "forcemerge": {
            "max_num_segments": 1
          }
        }
      },
      "cold": {
        "min_age": "30d",
        "actions": {
          "set_priority": {
            "priority": 0
          },
          "allocate": {
            "include": {
              "box_type": "cold"
            }
          }
        }
      },
      "delete": {
        "min_age": "90d",
        "actions": {
          "delete": {}
        }
      }
    }
  }
}
```

### 4.2 ç­–ç•¥åº”ç”¨ä¸ç®¡ç†



**ğŸ› ï¸ ç­–ç•¥åº”ç”¨ç¤ºä¾‹**
```bash
# 1. åˆ›å»ºILMç­–ç•¥

curl -X PUT "localhost:9200/_ilm/policy/log-policy" \
  -H 'Content-Type: application/json' \
  -d @log-ilm-policy.json

# 2. åˆ›å»ºç´¢å¼•æ¨¡æ¿åº”ç”¨ç­–ç•¥

curl -X PUT "localhost:9200/_index_template/log-template" \
  -H 'Content-Type: application/json' \
  -d '{
    "index_patterns": ["logs-*"],
    "template": {
      "settings": {
        "index.lifecycle.name": "log-policy",
        "index.lifecycle.rollover_alias": "logs-active"
      }
    }
  }'

# 3. åˆ›å»ºåˆå§‹ç´¢å¼•

curl -X PUT "localhost:9200/logs-000001" \
  -H 'Content-Type: application/json' \
  -d '{
    "aliases": {
      "logs-active": {
        "is_write_index": true
      }
    }
  }'
```

### 4.3 ç­–ç•¥ç›‘æ§ä¸è°ƒè¯•



**ğŸ” ç­–ç•¥çŠ¶æ€æŸ¥çœ‹**
```bash
# æŸ¥çœ‹ç´¢å¼•ILMçŠ¶æ€

curl "localhost:9200/logs-*/_ilm/explain?pretty"

# æŸ¥çœ‹ç­–ç•¥æ‰§è¡Œå†å²

curl "localhost:9200/_ilm/policy/log-policy?pretty"

# æ‰‹åŠ¨æ‰§è¡ŒILMæ­¥éª¤ï¼ˆè°ƒè¯•ç”¨ï¼‰

curl -X POST "localhost:9200/_ilm/move/logs-000001" \
  -H 'Content-Type: application/json' \
  -d '{
    "current_step": {
      "phase": "hot",
      "action": "rollover",
      "name": "check-rollover-ready"
    },
    "next_step": {
      "phase": "warm",
      "action": "allocate", 
      "name": "allocate"
    }
  }'
```

---

## 5. ğŸ”„ ç´¢å¼•æ»šåŠ¨ä¸å½’æ¡£ç­–ç•¥



### 5.1 æ»šåŠ¨è§¦å‘æ¡ä»¶



**âš™ï¸ æ™ºèƒ½æ»šåŠ¨é…ç½®**
```json
{
  "rollover": {
    "conditions": {
      "max_age": "1d",
      "max_size": "5GB", 
      "max_docs": 1000000
    }
  }
}
```

**ğŸ¯ æ¡ä»¶è¯´æ˜**
```
æ—¶é—´æ¡ä»¶ï¼ˆmax_ageï¼‰ï¼š
â€¢ 1d = æ¯å¤©æ»šåŠ¨ï¼Œé€‚åˆé«˜é¢‘æ—¥å¿—
â€¢ 7d = æ¯å‘¨æ»šåŠ¨ï¼Œé€‚åˆä¸­é¢‘æ•°æ®
â€¢ 30d = æ¯æœˆæ»šåŠ¨ï¼Œé€‚åˆä½é¢‘æ•°æ®

å¤§å°æ¡ä»¶ï¼ˆmax_sizeï¼‰ï¼š
â€¢ 5GB = é€‚åˆå¤§éƒ¨åˆ†åœºæ™¯
â€¢ 1GB = é€‚åˆèµ„æºå—é™ç¯å¢ƒ
â€¢ 10GB = é€‚åˆé«˜æ€§èƒ½åœºæ™¯

æ–‡æ¡£æ•°æ¡ä»¶ï¼ˆmax_docsï¼‰ï¼š
â€¢ 1000000 = 100ä¸‡æ–‡æ¡£
â€¢ é˜²æ­¢å•åˆ†ç‰‡æ–‡æ¡£è¿‡å¤š
â€¢ ä¿æŒæŸ¥è¯¢æ€§èƒ½
```

### 5.2 å½’æ¡£å‹ç¼©ç­–ç•¥



**ğŸ“¦ æ•°æ®å‹ç¼©é…ç½®**
```json
{
  "warm": {
    "actions": {
      "forcemerge": {
        "max_num_segments": 1
      },
      "shrink": {
        "number_of_shards": 1
      }
    }
  }
}
```

**ğŸ’¡ å‹ç¼©åŸç†è§£é‡Š**
```
Forcemergeæ“ä½œï¼š
â€¢ å°†å¤šä¸ªæ®µæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ª
â€¢ åˆ é™¤æ ‡è®°åˆ é™¤çš„æ–‡æ¡£
â€¢ å‹ç¼©æ¯”å¯è¾¾30-50%

Shrinkæ“ä½œï¼š
â€¢ å‡å°‘åˆ†ç‰‡æ•°é‡
â€¢ å°†å¤šåˆ†ç‰‡åˆå¹¶ä¸ºå°‘åˆ†ç‰‡
â€¢ é€‚åˆæ•°æ®ä¸å†å¢é•¿çš„ç´¢å¼•
```

### 5.3 å½’æ¡£éªŒè¯æœºåˆ¶



**âœ… å½’æ¡£è´¨é‡æ£€æŸ¥**
```bash
#!/bin/bash

# å½’æ¡£éªŒè¯è„šæœ¬


check_archive_quality() {
    local index_name="$1"
    
    echo "ğŸ” æ£€æŸ¥ç´¢å¼•å½’æ¡£è´¨é‡: $index_name"
    
#    # æ£€æŸ¥å‹ç¼©ç‡
    local original_size=$(curl -s "localhost:9200/$index_name/_stats/store" | \
        jq '.indices[].total.store.size_in_bytes')
    
#    # æ£€æŸ¥æ®µæ•°é‡
    local segments=$(curl -s "localhost:9200/$index_name/_segments" | \
        jq '.indices[].shards | length')
    
    echo "ğŸ“Š å‹ç¼©åå¤§å°: $(($original_size / 1024 / 1024))MB"
    echo "ğŸ“Š æ®µæ•°é‡: $segments"
    
#    # éªŒè¯æ•°æ®å®Œæ•´æ€§
    local doc_count=$(curl -s "localhost:9200/$index_name/_count" | \
        jq '.count')
    
    echo "ğŸ“Š æ–‡æ¡£æ•°é‡: $doc_count"
    
    if [[ $segments -le 1 && $doc_count -gt 0 ]]; then
        echo "âœ… å½’æ¡£è´¨é‡æ£€æŸ¥é€šè¿‡"
    else
        echo "âš ï¸ å½’æ¡£è´¨é‡éœ€è¦å…³æ³¨"
    fi
}
```

---

## 6. ğŸŒ¡ï¸ å†·çƒ­æ•°æ®åˆ†å±‚å­˜å‚¨



### 6.1 èŠ‚ç‚¹è§’è‰²åˆ’åˆ†



**ğŸ—ï¸ é›†ç¾¤èŠ‚ç‚¹åˆ†å±‚**
```
é›†ç¾¤èŠ‚ç‚¹åˆ†å±‚æ¶æ„ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   HotèŠ‚ç‚¹    â”‚    â”‚   WarmèŠ‚ç‚¹   â”‚    â”‚   ColdèŠ‚ç‚¹   â”‚
â”‚ é«˜æ€§èƒ½SSD    â”‚    â”‚  SATAç¡¬ç›˜   â”‚    â”‚  å¤§å®¹é‡HDD   â”‚
â”‚ é¢‘ç¹è¯»å†™     â”‚    â”‚  å¶å°”è¯»å–   â”‚    â”‚  é•¿æœŸå­˜å‚¨    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

HotèŠ‚ç‚¹ç‰¹ç‚¹ï¼š
â€¢ é«˜æ€§èƒ½SSDå­˜å‚¨
â€¢ å¤§å†…å­˜é…ç½®
â€¢ æ‰¿è½½å®æ—¶å†™å…¥å’ŒæŸ¥è¯¢

WarmèŠ‚ç‚¹ç‰¹ç‚¹ï¼š
â€¢ å¹³è¡¡æ€§èƒ½ä¸æˆæœ¬
â€¢ SATA SSDæˆ–å¿«é€Ÿæœºæ¢°ç›˜
â€¢ æ‰¿è½½å†å²æ•°æ®æŸ¥è¯¢

ColdèŠ‚ç‚¹ç‰¹ç‚¹ï¼š
â€¢ å¤§å®¹é‡ä½æˆæœ¬å­˜å‚¨
â€¢ æœºæ¢°ç¡¬ç›˜
â€¢ é•¿æœŸå½’æ¡£å­˜å‚¨
```

### 6.2 èŠ‚ç‚¹é…ç½®ç¤ºä¾‹



**âš™ï¸ èŠ‚ç‚¹å±æ€§è®¾ç½®**
```yaml
# HotèŠ‚ç‚¹é…ç½®

node.roles: ["data_hot", "data_content"]
node.attr.box_type: hot
node.attr.storage_type: ssd

# WarmèŠ‚ç‚¹é…ç½®  

node.roles: ["data_warm", "data_content"]
node.attr.box_type: warm
node.attr.storage_type: hybrid

# ColdèŠ‚ç‚¹é…ç½®

node.roles: ["data_cold", "data_content"] 
node.attr.box_type: cold
node.attr.storage_type: hdd
```

### 6.3 åˆ†å±‚è¿ç§»é…ç½®



**ğŸ”„ è‡ªåŠ¨è¿ç§»ç­–ç•¥**
```json
{
  "policy": {
    "phases": {
      "hot": {
        "actions": {
          "rollover": {
            "max_size": "5GB",
            "max_age": "1d"
          },
          "allocate": {
            "require": {
              "box_type": "hot"
            }
          }
        }
      },
      "warm": {
        "min_age": "7d",
        "actions": {
          "allocate": {
            "require": {
              "box_type": "warm"
            },
            "number_of_replicas": 0
          },
          "forcemerge": {
            "max_num_segments": 1
          }
        }
      },
      "cold": {
        "min_age": "30d", 
        "actions": {
          "allocate": {
            "require": {
              "box_type": "cold"
            }
          }
        }
      }
    }
  }
}
```

---

## 7. ğŸ—‘ï¸ ç´¢å¼•åˆ é™¤ä¸æ¸…ç†ç­–ç•¥



### 7.1 åˆ é™¤ç­–ç•¥é…ç½®



**â° åŸºäºæ—¶é—´çš„åˆ é™¤**
```json
{
  "delete": {
    "min_age": "90d",
    "actions": {
      "delete": {}
    }
  }
}
```

**ğŸ“Š åŸºäºæ¡ä»¶çš„åˆ é™¤**
```bash
# åŸºäºç´¢å¼•å¤§å°åˆ é™¤

curl -X DELETE "localhost:9200/logs-*" \
  -H 'Content-Type: application/json' \
  -d '{
    "query": {
      "range": {
        "@timestamp": {
          "lt": "now-90d"
        }
      }
    }
  }'

# æ‰¹é‡åˆ é™¤è„šæœ¬

#!/bin/bash

delete_old_indices() {
    local pattern="$1"
    local days_old="$2"
    
    echo "ğŸ—‘ï¸ åˆ é™¤è¶…è¿‡ $days_old å¤©çš„ç´¢å¼•: $pattern"
    
#    # è·å–è¦åˆ é™¤çš„ç´¢å¼•åˆ—è¡¨
    local old_indices=$(curl -s "localhost:9200/_cat/indices/$pattern?h=index,creation.date.string" | \
        awk -v days="$days_old" '
        {
            cmd = "date -d \"" $2 "\" +%s"
            cmd | getline creation_time
            close(cmd)
            
            cmd = "date -d \"" days " days ago\" +%s"  
            cmd | getline cutoff_time
            close(cmd)
            
            if (creation_time < cutoff_time) {
                print $1
            }
        }')
    
#    # æ‰§è¡Œåˆ é™¤
    for index in $old_indices; do
        echo "ğŸ—‘ï¸ åˆ é™¤ç´¢å¼•: $index"
        curl -X DELETE "localhost:9200/$index"
    done
}
```

### 7.2 å®‰å…¨åˆ é™¤æœºåˆ¶



**ğŸ›¡ï¸ åˆ é™¤å‰æ£€æŸ¥**
```bash
safe_delete_index() {
    local index_name="$1"
    
    echo "ğŸ” å®‰å…¨åˆ é™¤æ£€æŸ¥: $index_name"
    
#    # 1. æ£€æŸ¥ç´¢å¼•æ˜¯å¦å­˜åœ¨
    if ! curl -s "localhost:9200/$index_name" | grep -q "\"index\":"; then
        echo "âŒ ç´¢å¼•ä¸å­˜åœ¨: $index_name"
        return 1
    fi
    
#    # 2. æ£€æŸ¥æ˜¯å¦ä¸ºæ´»è·ƒå†™å…¥ç´¢å¼•
    local is_write_index=$(curl -s "localhost:9200/$index_name/_alias" | \
        jq -r '.[] | select(.aliases | has("*-active") and .aliases[].is_write_index == true) | "true"')
    
    if [[ "$is_write_index" == "true" ]]; then
        echo "âš ï¸ ä¸èƒ½åˆ é™¤æ´»è·ƒå†™å…¥ç´¢å¼•: $index_name"
        return 1
    fi
    
#    # 3. å¤‡ä»½é‡è¦å…ƒæ•°æ®
    curl -s "localhost:9200/$index_name/_mapping" > "${index_name}_mapping_backup.json"
    curl -s "localhost:9200/$index_name/_settings" > "${index_name}_settings_backup.json"
    
#    # 4. æ‰§è¡Œåˆ é™¤
    echo "ğŸ—‘ï¸ æ‰§è¡Œåˆ é™¤: $index_name"
    curl -X DELETE "localhost:9200/$index_name"
    
    echo "âœ… ç´¢å¼•åˆ é™¤å®Œæˆï¼Œå…ƒæ•°æ®å·²å¤‡ä»½"
}
```

### 7.3 åˆ é™¤ç›‘æ§å‘Šè­¦



**ğŸ“Š åˆ é™¤æ“ä½œç›‘æ§**
```bash
monitor_deletion() {
    echo "ğŸ“Š ç›‘æ§ç´¢å¼•åˆ é™¤æƒ…å†µ..."
    
#    # ç»Ÿè®¡ä»Šæ—¥åˆ é™¤çš„ç´¢å¼•æ•°é‡
    local deleted_today=$(grep "$(date +%Y-%m-%d)" /var/log/elasticsearch/deletion.log | wc -l)
    
#    # è®¡ç®—é‡Šæ”¾çš„å­˜å‚¨ç©ºé—´
    local freed_space=$(grep "$(date +%Y-%m-%d)" /var/log/elasticsearch/deletion.log | \
        awk '{sum+=$3} END {print sum/1024/1024/1024}')
    
    echo "ğŸ“ˆ ä»Šæ—¥åˆ é™¤ç´¢å¼•: $deleted_today ä¸ª"
    echo "ğŸ’¾ é‡Šæ”¾å­˜å‚¨ç©ºé—´: ${freed_space}GB"
    
#    # å‘Šè­¦æ£€æŸ¥
    if [[ $deleted_today -gt 10 ]]; then
        echo "âš ï¸ ä»Šæ—¥åˆ é™¤ç´¢å¼•æ•°é‡å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥åˆ é™¤ç­–ç•¥"
#        # å‘é€å‘Šè­¦é€šçŸ¥
        send_alert "ç´¢å¼•åˆ é™¤å¼‚å¸¸" "ä»Šæ—¥åˆ é™¤äº† $deleted_today ä¸ªç´¢å¼•ï¼Œè¶…å‡ºæ­£å¸¸èŒƒå›´"
    fi
}
```

---

## 8. ğŸ“‹ ç´¢å¼•æ¨¡æ¿ç®¡ç†



### 8.1 ç´¢å¼•æ¨¡æ¿è®¾è®¡



**ğŸ“ é€šç”¨æ¨¡æ¿ç»“æ„**
```json
{
  "index_patterns": ["logs-*"],
  "priority": 200,
  "template": {
    "settings": {
      "index": {
        "lifecycle": {
          "name": "logs-policy",
          "rollover_alias": "logs-active"
        },
        "number_of_shards": 1,
        "number_of_replicas": 1,
        "refresh_interval": "30s",
        "mapping": {
          "total_fields": {
            "limit": 2000
          }
        }
      }
    },
    "mappings": {
      "properties": {
        "@timestamp": {
          "type": "date"
        },
        "level": {
          "type": "keyword"
        },
        "message": {
          "type": "text",
          "analyzer": "standard"
        },
        "host": {
          "type": "keyword"
        },
        "service": {
          "type": "keyword"
        }
      }
    }
  }
}
```

### 8.2 æ¨¡æ¿ç‰ˆæœ¬ç®¡ç†



**ğŸ”„ æ¨¡æ¿ç‰ˆæœ¬æ§åˆ¶**
```bash
# æ¨¡æ¿ç‰ˆæœ¬ç®¡ç†è„šæœ¬

manage_template_versions() {
    local template_name="$1"
    local action="$2"
    
    case "$action" in
        "backup")
            echo "ğŸ’¾ å¤‡ä»½æ¨¡æ¿: $template_name"
            curl -s "localhost:9200/_index_template/$template_name" > \
                "templates/${template_name}_$(date +%Y%m%d).json"
            ;;
        "restore")
            local backup_file="$3"
            echo "ğŸ”„ æ¢å¤æ¨¡æ¿: $template_name"
            curl -X PUT "localhost:9200/_index_template/$template_name" \
                -H 'Content-Type: application/json' \
                -d @"$backup_file"
            ;;
        "update")
            echo "ğŸ“ æ›´æ–°æ¨¡æ¿: $template_name"
#            # å…ˆå¤‡ä»½
            manage_template_versions "$template_name" "backup"
#            # å†æ›´æ–°
            curl -X PUT "localhost:9200/_index_template/$template_name" \
                -H 'Content-Type: application/json' \
                -d @"templates/${template_name}_new.json"
            ;;
    esac
}
```

### 8.3 æ¨¡æ¿ä¼˜å…ˆçº§ç®¡ç†



**ğŸ“Š ä¼˜å…ˆçº§ç­–ç•¥**
```json
{
  "åŸºç¡€æ¨¡æ¿": {
    "priority": 100,
    "patterns": ["*"],
    "description": "å…¨å±€é»˜è®¤è®¾ç½®"
  },
  "åº”ç”¨æ¨¡æ¿": {
    "priority": 200, 
    "patterns": ["app-*"],
    "description": "åº”ç”¨ç‰¹å®šè®¾ç½®"
  },
  "ç¯å¢ƒæ¨¡æ¿": {
    "priority": 300,
    "patterns": ["app-*-prod"],
    "description": "ç”Ÿäº§ç¯å¢ƒè®¾ç½®"
  }
}
```

---

## 9. ğŸ”— ç´¢å¼•åˆ«åä½¿ç”¨æŠ€å·§



### 9.1 åˆ«ååŸºç¡€æ¦‚å¿µ



**ğŸ·ï¸ åˆ«åçš„ä½œç”¨**
```
ç´¢å¼•åˆ«åç”¨é€”ï¼š

è¯»å†™åˆ†ç¦»ï¼š
â€¢ å†™åˆ«åï¼šæŒ‡å‘å½“å‰æ´»è·ƒç´¢å¼•
â€¢ è¯»åˆ«åï¼šæŒ‡å‘æ‰€æœ‰ç›¸å…³ç´¢å¼•

é›¶åœæœºåˆ‡æ¢ï¼š
â€¢ åŸå­æ€§æ“ä½œåˆ‡æ¢ç´¢å¼•
â€¢ åº”ç”¨æ— æ„ŸçŸ¥æ›´æ–°

å¤šç‰ˆæœ¬ç®¡ç†ï¼š
â€¢ åŒæ—¶ç»´æŠ¤å¤šä¸ªç‰ˆæœ¬
â€¢ é€æ­¥è¿ç§»æµé‡
```

### 9.2 æ»šåŠ¨åˆ«åé…ç½®



**ğŸ”„ è‡ªåŠ¨æ»šåŠ¨åˆ«å**
```bash
# åˆ›å»ºæ»šåŠ¨åˆ«å

setup_rollover_alias() {
    local alias_name="$1"
    local initial_index="${alias_name}-000001"
    
    echo "ğŸ”— åˆ›å»ºæ»šåŠ¨åˆ«å: $alias_name"
    
#    # åˆ›å»ºåˆå§‹ç´¢å¼•
    curl -X PUT "localhost:9200/$initial_index" \
        -H 'Content-Type: application/json' \
        -d '{
            "aliases": {
                "'$alias_name'-active": {
                    "is_write_index": true
                },
                "'$alias_name'-read": {}
            }
        }'
    
    echo "âœ… æ»šåŠ¨åˆ«åè®¾ç½®å®Œæˆ"
    echo "ğŸ“ å†™å…¥åˆ«å: ${alias_name}-active"
    echo "ğŸ“ è¯»å–åˆ«å: ${alias_name}-read"
}
```

### 9.3 åˆ«ååˆ‡æ¢ç­–ç•¥



**âš¡ é›¶åœæœºåˆ‡æ¢**
```bash
# æ— ç¼åˆ‡æ¢ç´¢å¼•åˆ«å

switch_alias() {
    local alias_name="$1"
    local old_index="$2" 
    local new_index="$3"
    
    echo "ğŸ”„ åˆ‡æ¢åˆ«å: $alias_name"
    echo "   ä»: $old_index"
    echo "   åˆ°: $new_index"
    
#    # åŸå­æ“ä½œï¼šç§»é™¤æ—§çš„ï¼Œæ·»åŠ æ–°çš„
    curl -X POST "localhost:9200/_aliases" \
        -H 'Content-Type: application/json' \
        -d '{
            "actions": [
                {
                    "remove": {
                        "index": "'$old_index'",
                        "alias": "'$alias_name'"
                    }
                },
                {
                    "add": {
                        "index": "'$new_index'",
                        "alias": "'$alias_name'"
                    }
                }
            ]
        }'
    
    echo "âœ… åˆ«ååˆ‡æ¢å®Œæˆ"
}
```

### 9.4 åˆ«åç®¡ç†æœ€ä½³å®è·µ



**ğŸ› ï¸ åˆ«åè¿ç»´è„šæœ¬**
```bash
# åˆ«åçŠ¶æ€æ£€æŸ¥

check_alias_status() {
    echo "ğŸ” æ£€æŸ¥åˆ«åçŠ¶æ€..."
    
#    # è·å–æ‰€æœ‰åˆ«åä¿¡æ¯
    curl -s "localhost:9200/_alias" | jq -r '
        to_entries | 
        map(select(.value | length > 0)) |
        .[] | 
        .key as $index | 
        .value | 
        to_entries[] | 
        "\(.key): \($index)"
    ' | sort
    
#    # æ£€æŸ¥å†™å…¥åˆ«å
    echo ""
    echo "ğŸ“ æ´»è·ƒå†™å…¥ç´¢å¼•:"
    curl -s "localhost:9200/_alias/*-active" | jq -r '
        to_entries |
        map(select(.value[].is_write_index == true)) |
        .[] |
        "\(.key)"
    '
}

# æ¸…ç†å­¤ç«‹åˆ«å

cleanup_orphaned_aliases() {
    echo "ğŸ§¹ æ¸…ç†å­¤ç«‹åˆ«å..."
    
#    # æŸ¥æ‰¾æŒ‡å‘ä¸å­˜åœ¨ç´¢å¼•çš„åˆ«å
    local orphaned_aliases=$(curl -s "localhost:9200/_alias" | jq -r '
        to_entries |
        map(select(.value | length > 0)) |
        .[] |
        .key as $index |
        if (index("index_not_found_exception")) then
            .value | to_entries[] | .key
        else
            empty
        end
    ')
    
    for alias in $orphaned_aliases; do
        echo "ğŸ—‘ï¸ åˆ é™¤å­¤ç«‹åˆ«å: $alias"
        curl -X DELETE "localhost:9200/_alias/$alias"
    done
}
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“



### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ



```
ğŸ”¸ ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼šè‡ªåŠ¨åŒ–ç®¡ç†ç´¢å¼•ä»åˆ›å»ºåˆ°åˆ é™¤çš„å®Œæ•´æµç¨‹
ğŸ”¸ å››ä¸ªé˜¶æ®µï¼šHotï¼ˆçƒ­ï¼‰â†’ Warmï¼ˆæ¸©ï¼‰â†’ Coldï¼ˆå†·ï¼‰â†’ Deleteï¼ˆåˆ é™¤ï¼‰
ğŸ”¸ æ»šåŠ¨ç­–ç•¥ï¼šåŸºäºæ—¶é—´ã€å¤§å°ã€æ–‡æ¡£æ•°çš„è‡ªåŠ¨æ»šåŠ¨æœºåˆ¶
ğŸ”¸ åˆ†å±‚å­˜å‚¨ï¼šæ ¹æ®æ•°æ®è®¿é—®é¢‘ç‡ä½¿ç”¨ä¸åŒæ€§èƒ½çš„å­˜å‚¨
ğŸ”¸ ç´¢å¼•æ¨¡æ¿ï¼šæ ‡å‡†åŒ–ç´¢å¼•åˆ›å»ºå’Œé…ç½®ç®¡ç†
ğŸ”¸ åˆ«åç®¡ç†ï¼šå®ç°é›¶åœæœºåˆ‡æ¢å’Œçµæ´»çš„ç´¢å¼•è·¯ç”±
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹



**ğŸ”¹ ä¸ºä»€ä¹ˆéœ€è¦ç”Ÿå‘½å‘¨æœŸç®¡ç†**
```
æˆæœ¬æ§åˆ¶ï¼š
â€¢ çƒ­æ•°æ®ç”¨é«˜æ€§èƒ½å­˜å‚¨ï¼Œæˆæœ¬é«˜ä½†å¿…è¦
â€¢ å†·æ•°æ®ç”¨ä½æˆæœ¬å­˜å‚¨ï¼ŒèŠ‚çœå¼€æ”¯
â€¢ è¿‡æœŸæ•°æ®è‡ªåŠ¨åˆ é™¤ï¼Œé¿å…æ— é™åˆ¶å¢é•¿

æ€§èƒ½ä¼˜åŒ–ï¼š
â€¢ æ–°æ•°æ®åœ¨é«˜æ€§èƒ½èŠ‚ç‚¹ï¼ŒæŸ¥è¯¢å¿«
â€¢ å†å²æ•°æ®ä¸å½±å“å®æ—¶æŸ¥è¯¢æ€§èƒ½
â€¢ åˆç†åˆ†ç‰‡é¿å…å°åˆ†ç‰‡é—®é¢˜

è¿ç»´æ•ˆç‡ï¼š
â€¢ è‡ªåŠ¨åŒ–å‡å°‘äººå·¥å¹²é¢„
â€¢ æ ‡å‡†åŒ–æµç¨‹é¿å…è¯¯æ“ä½œ
â€¢ ç­–ç•¥åŒ–é…ç½®ä¾¿äºç»´æŠ¤
```

**ğŸ”¹ ç”Ÿå‘½å‘¨æœŸé˜¶æ®µçš„è®¾è®¡æ€è·¯**
```
Hoté˜¶æ®µï¼š
â€¢ æ•°æ®æ–°é²œï¼ŒæŸ¥è¯¢é¢‘ç¹
â€¢ éœ€è¦é«˜æ€§èƒ½è¯»å†™
â€¢ é€šå¸¸ä¿æŒ7-30å¤©

Warmé˜¶æ®µï¼š
â€¢ æŸ¥è¯¢é¢‘ç‡é™ä½
â€¢ å¯ä»¥å‡å°‘å‰¯æœ¬èŠ‚çœå­˜å‚¨
â€¢ è¿›è¡Œæ•°æ®å‹ç¼©ä¼˜åŒ–

Coldé˜¶æ®µï¼š
â€¢ å¾ˆå°‘è¢«æŸ¥è¯¢
â€¢ è¿ç§»åˆ°ä½æˆæœ¬å­˜å‚¨
â€¢ æœ€å°åŒ–èµ„æºå ç”¨

Deleteé˜¶æ®µï¼š
â€¢ è¶…è¿‡ä¿ç•™æœŸé™
â€¢ è‡ªåŠ¨åˆ é™¤é‡Šæ”¾ç©ºé—´
```

### 10.3 å®é™…åº”ç”¨ä»·å€¼



**ğŸ¯ ä¸šåŠ¡åœºæ™¯åº”ç”¨**
- **æ—¥å¿—åˆ†æå¹³å°**ï¼šè‡ªåŠ¨ç®¡ç†TBçº§æ—¥å¿—æ•°æ®çš„ç”Ÿå‘½å‘¨æœŸ
- **ç›‘æ§ç³»ç»Ÿ**ï¼šä¼˜åŒ–ç›‘æ§æŒ‡æ ‡çš„å­˜å‚¨æˆæœ¬å’ŒæŸ¥è¯¢æ€§èƒ½
- **å®¡è®¡ç³»ç»Ÿ**ï¼šåˆè§„è¦æ±‚ä¸‹çš„æ•°æ®ä¿ç•™å’Œåˆ é™¤ç­–ç•¥
- **æœç´¢å¹³å°**ï¼šå¤§è§„æ¨¡æ–‡æ¡£ç´¢å¼•çš„æ€§èƒ½å’Œæˆæœ¬ä¼˜åŒ–

**ğŸ’¡ æœ€ä½³å®è·µå»ºè®®**
```
ç­–ç•¥è®¾è®¡ï¼š
â€¢ æ ¹æ®ä¸šåŠ¡éœ€æ±‚è®¾å®šåˆç†çš„ä¿ç•™æœŸ
â€¢ å¹³è¡¡æ€§èƒ½éœ€æ±‚å’Œæˆæœ¬æ§åˆ¶
â€¢ è€ƒè™‘åˆè§„è¦æ±‚å’Œæ³•å¾‹æ³•è§„

è¿ç»´ç®¡ç†ï¼š
â€¢ å®šæœŸç›‘æ§ç­–ç•¥æ‰§è¡Œæ•ˆæœ
â€¢ æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´å‚æ•°
â€¢ å»ºç«‹å®Œå–„çš„å¤‡ä»½å’Œæ¢å¤æœºåˆ¶

æ€§èƒ½è°ƒä¼˜ï¼š
â€¢ åˆç†è®¾ç½®æ»šåŠ¨æ¡ä»¶
â€¢ ä¼˜åŒ–åˆ†ç‰‡å’Œå‰¯æœ¬é…ç½®
â€¢ ç›‘æ§é›†ç¾¤èµ„æºä½¿ç”¨æƒ…å†µ
```

### 10.4 å­¦ä¹ æ£€æŸ¥æ¸…å•



- [ ] ç†è§£ç´¢å¼•ç”Ÿå‘½å‘¨æœŸå››ä¸ªé˜¶æ®µçš„ä½œç”¨
- [ ] èƒ½å¤Ÿè®¾è®¡åˆç†çš„ç´¢å¼•å‘½åè§„èŒƒ
- [ ] æŒæ¡ILMç­–ç•¥çš„åˆ›å»ºå’Œé…ç½®
- [ ] äº†è§£å†·çƒ­æ•°æ®åˆ†å±‚å­˜å‚¨åŸç†
- [ ] ä¼šä½¿ç”¨ç´¢å¼•æ¨¡æ¿æ ‡å‡†åŒ–ç®¡ç†
- [ ] èƒ½å¤Ÿçµæ´»è¿ç”¨ç´¢å¼•åˆ«å
- [ ] æŒæ¡å®‰å…¨çš„ç´¢å¼•åˆ é™¤æ“ä½œ
- [ ] ä¼šç›‘æ§å’Œè°ƒè¯•ILMç­–ç•¥æ‰§è¡Œ

**ğŸ”‘ æ ¸å¿ƒè®°å¿†å£è¯€**
> ç´¢å¼•ç”Ÿå‘½æœ‰å››æœŸï¼Œçƒ­æ¸©å†·åˆ éœ€ç‰¢è®°
> æ»šåŠ¨å½’æ¡£è‡ªåŠ¨åŒ–ï¼Œåˆ†å±‚å­˜å‚¨æˆæœ¬ä½
> æ¨¡æ¿åˆ«åå¥½ç®¡ç†ï¼Œç›‘æ§å‘Šè­¦ä¸èƒ½ç¼º

**ğŸ’¡ å»¶ä¼¸å­¦ä¹ å»ºè®®**
- å­¦ä¹ Elasticsearché›†ç¾¤è§„åˆ’å’Œå®¹é‡é¢„æµ‹
- ç ”ç©¶æ›´å¤æ‚çš„æ•°æ®åˆ†å±‚å’Œå‹ç¼©ç­–ç•¥
- äº†è§£è·¨é›†ç¾¤å¤åˆ¶å’Œç¾å¤‡æ–¹æ¡ˆ
- æ¢ç´¢ä¸Kafkaã€Logstashçš„é›†æˆä¼˜åŒ–