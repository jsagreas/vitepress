---
title: 2、安装介质制作与验证
---
## 📚 目录

1. [ISO镜像下载与校验](#1-ISO镜像下载与校验)
2. [启动盘制作工具详解](#2-启动盘制作工具详解)
3. [USB启动盘创建与测试](#3-USB启动盘创建与测试)
4. [网络启动环境配置](#4-网络启动环境配置)
5. [安装介质完整性验证](#5-安装介质完整性验证)
6. [安全启动配置](#6-安全启动配置)
7. [核心要点总结](#7-核心要点总结)

---

## 1. 💿 ISO镜像下载与校验


### 1.1 什么是ISO镜像


**ISO镜像**就是把整个光盘的内容完整地打包成一个文件，就像把一本书的所有页面扫描后装订成册一样。

```
现实对比：
光盘 → 装有Linux系统的实体光盘
ISO文件 → 光盘内容的数字副本

想象一下：
- 你有一张Linux安装光盘
- 把光盘里的所有文件和结构完全复制到一个文件里
- 这个文件就是ISO镜像，扩展名通常是.iso
```

### 1.2 为什么要校验ISO镜像


**校验的目的**：确保下载的文件是完整且未被篡改的

> **💡 生活例子**：就像网购收货时要检查包裹是否完好，ISO校验就是检查下载的"数字包裹"是否完整

**常见问题**：
- **下载中断** → 文件不完整，安装时会出错
- **网络传输错误** → 部分数据损坏
- **恶意篡改** → 被植入病毒或后门

### 1.3 校验码详解


#### 🔐 MD5校验码

```bash
# 计算文件的MD5值
md5sum ubuntu-22.04.3-desktop-amd64.iso

# 输出示例：
a4acfda10b18da50e2ec50ccaf860d7f  ubuntu-22.04.3-desktop-amd64.iso
```

**MD5特点**：
- 32位十六进制字符串
- 文件内容改变，MD5值就会完全不同
- 已不够安全，仅用于基本校验

#### 🔒 SHA256校验码

```bash
# 计算文件的SHA256值
sha256sum ubuntu-22.04.3-desktop-amd64.iso

# 输出示例：
c396c91b4e0b9d7d4b31d82dc19b2b04b3d3b2e8f3c7b9d6a3e5c7f8a1b2c3d4  ubuntu-22.04.3-desktop-amd64.iso
```

**SHA256特点**：
- 64位十六进制字符串
- 安全性更高，目前推荐使用
- 几乎不可能产生碰撞

### 1.4 下载与校验实操


#### 📥 下载步骤


**1. 选择下载源**
```
官方源：download.ubuntu.com（最安全）
镜像源：mirrors.aliyun.com（国内速度快）
大学镜像：mirrors.tuna.tsinghua.edu.cn（稳定）
```

**2. 同时下载ISO和校验文件**
```bash
# 下载ISO文件
wget https://releases.ubuntu.com/22.04/ubuntu-22.04.3-desktop-amd64.iso

# 下载对应的校验文件
wget https://releases.ubuntu.com/22.04/SHA256SUMS
```

**3. 执行校验**
```bash
# 方法1：直接对比
sha256sum ubuntu-22.04.3-desktop-amd64.iso
cat SHA256SUMS | grep ubuntu-22.04.3-desktop-amd64.iso

# 方法2：自动校验
sha256sum -c SHA256SUMS --ignore-missing
```

**结果说明**：
- ✅ `OK` - 校验通过，文件完整
- ❌ `FAILED` - 校验失败，需要重新下载

---

## 2. 🛠️ 启动盘制作工具详解


### 2.1 什么是启动盘


**启动盘**：能让电脑从U盘启动并运行操作系统安装程序的特殊U盘

```
普通U盘 vs 启动盘：

普通U盘：
├── 文档.docx
├── 照片.jpg
└── 视频.mp4
（只能存储文件，不能启动系统）

启动盘：
├── bootloader（启动引导程序）
├── kernel（系统内核）
├── initrd（初始化程序）
└── filesystem（文件系统）
（可以启动电脑并运行安装程序）
```

### 2.2 制作工具对比


| 工具名称 | 操作系统 | 特点 | 适用场景 |
|---------|---------|------|----------|
| **dd命令** | Linux/macOS | `命令行，精确控制` | 🔧 技术人员，服务器环境 |
| **Rufus** | Windows | `功能强大，选项丰富` | 🖥️ Windows用户首选 |
| **Etcher** | 跨平台 | `界面简洁，操作简单` | 👥 新手友好 |
| **UNetbootin** | 跨平台 | `支持多种发行版` | 📱 多系统安装 |

### 2.3 dd命令详解（Linux/macOS）


**dd命令**：直接复制数据的底层工具，能精确地将ISO镜像写入U盘

```bash
# 1. 查看U盘设备
lsblk
# 输出示例：
# sdb      8:16   1  14.9G  0 disk 
# └─sdb1   8:17   1  14.9G  0 part /media/usb

# 2. 卸载U盘（重要！）
sudo umount /dev/sdb1

# 3. 写入ISO镜像
sudo dd if=ubuntu-22.04.3-desktop-amd64.iso of=/dev/sdb bs=4M status=progress

# 4. 同步数据
sudo sync
```

**参数解释**：
- `if=` - **input file** 输入文件（ISO镜像）
- `of=` - **output file** 输出设备（U盘设备）
- `bs=4M` - **block size** 每次读写4MB，提高速度
- `status=progress` - 显示进度

⚠️ **重要警告**：
- 确保设备路径正确（`/dev/sdb`不是`/dev/sdb1`）
- dd命令会完全擦除目标设备上的所有数据
- 写错设备可能会损坏硬盘数据

### 2.4 Rufus使用指南（Windows）


**Rufus**：Windows上最受欢迎的启动盘制作工具

**操作步骤**：
```
1. 下载Rufus → rufus.ie
2. 插入U盘（≥4GB）
3. 启动Rufus程序

配置选项：
├── 设备：选择U盘
├── 启动类型：选择ISO镜像
├── 分区方案：
│   ├── GPT（适用于UEFI）
│   └── MBR（适用于传统BIOS）
├── 目标系统：
│   ├── UEFI（现代电脑）
│   └── BIOS（老电脑）
└── 文件系统：FAT32

4. 点击"开始"制作
```

**关键配置说明**：
- **GPT + UEFI** → 新电脑（2012年后）
- **MBR + BIOS** → 老电脑（2012年前）
- **FAT32** → 兼容性最好的文件系统

### 2.5 Etcher使用指南（跨平台）


**Etcher**：界面最友好的启动盘制作工具

```
操作流程图：
用户 → 选择镜像 → 选择U盘 → 点击Flash → 完成

具体步骤：
┌─────────────────┐
│ 1. Select Image │ ← 选择ISO文件
├─────────────────┤
│ 2. Select Drive │ ← 选择U盘
├─────────────────┤  
│ 3. Flash!       │ ← 开始制作
└─────────────────┘
```

**Etcher优点**：
- 界面直观，三步完成
- 自动校验写入结果
- 防止误选硬盘
- 支持压缩镜像格式

---

## 3. 💾 USB启动盘创建与测试


### 3.1 U盘选择要求


**容量要求**：
```
最小容量：4GB
推荐容量：8GB及以上
企业级：16GB-32GB

容量计算：
Ubuntu Desktop：≥4GB
CentOS Full：≥8GB  
Windows 10：≥8GB
多系统启动盘：≥16GB
```

**性能要求**：
- **USB 3.0接口** → 读写速度快，安装时间短
- **A级芯片** → 稳定性好，不容易出错
- **品牌U盘** → 兼容性佳，成功率高

### 3.2 制作流程详解


#### 🔧 Linux环境制作


```bash
# 完整制作流程
#!/bin/bash

# 1. 确认U盘设备
echo "=== 检测U盘设备 ==="
lsblk -d -o NAME,SIZE,MODEL | grep -E "(sd[b-z]|nvme)"

# 2. 安全检查
read -p "请确认U盘设备（如 sdb）: " DEVICE
if [ ! -b "/dev/$DEVICE" ]; then
    echo "设备不存在！"
    exit 1
fi

# 3. 卸载所有分区
echo "=== 卸载U盘分区 ==="
sudo umount /dev/${DEVICE}* 2>/dev/null

# 4. 写入镜像
echo "=== 写入镜像（请耐心等待）==="
sudo dd if=ubuntu-22.04.3-desktop-amd64.iso \
        of=/dev/$DEVICE \
        bs=4M \
        status=progress \
        conv=fdatasync

echo "=== 制作完成 ==="
```

#### 🖥️ Windows环境制作


使用Rufus的详细配置：

```
高级选项配置：
┌─────────────────────────────────┐
│ ☑️ 检查设备坏扇区               │
│ ☑️ 快速格式化                  │  
│ ☑️ 创建扩展标签和图标文件        │
│ ☐ 添加修复文件                 │
│ ☐ 创建USB-HDD兼容启动盘         │
└─────────────────────────────────┘

分区方案选择：
现代电脑（UEFI）：
├── 分区方案：GPT
├── 目标系统：UEFI (非CSM)
└── 文件系统：FAT32

传统电脑（BIOS）：  
├── 分区方案：MBR
├── 目标系统：BIOS或UEFI-CSM
└── 文件系统：FAT32
```

### 3.3 启动盘测试方法


#### 🧪 功能性测试


**1. 文件完整性检查**
```bash
# Linux检查
sudo fdisk -l /dev/sdb  # 查看分区表
file -s /dev/sdb1       # 检查文件系统

# 挂载测试
mkdir /tmp/usb_test
sudo mount /dev/sdb1 /tmp/usb_test
ls -la /tmp/usb_test/   # 查看文件列表
sudo umount /tmp/usb_test
```

**2. 启动测试**
```
测试步骤：
1. 插入制作好的启动盘
2. 重启电脑
3. 进入BIOS/UEFI设置
4. 修改启动顺序，USB优先
5. 保存并重启
6. 观察是否正常进入安装界面
```

#### 💻 兼容性测试


**测试环境清单**：
- [x] **现代笔记本**（UEFI + Secure Boot）
- [x] **台式机**（传统BIOS）  
- [x] **服务器**（IPMI远程安装）
- [x] **虚拟机**（VMware/VirtualBox）

**测试要点**：
```
启动方式测试：
├── UEFI模式启动 ✓
├── Legacy BIOS模式启动 ✓  
├── Secure Boot开启状态 ✓
└── Secure Boot关闭状态 ✓

显示输出测试：
├── 集成显卡正常显示 ✓
├── 独立显卡正常显示 ✓
└── 多显示器支持 ✓
```

---

## 4. 🌐 网络启动环境配置


### 4.1 什么是网络启动


**PXE启动**：Pre-boot Execution Environment，让电脑通过网络下载和启动操作系统

```
传统启动 vs 网络启动：

传统启动流程：
电脑 → 硬盘/U盘 → 启动系统

网络启动流程：  
电脑 → 网络 → 服务器 → 下载启动程序 → 启动系统
```

**应用场景**：
- 🏢 **批量部署** → 同时给多台电脑安装系统
- 🔧 **无盘工作站** → 没有硬盘的电脑启动
- 🚀 **云环境** → 虚拟机快速部署
- 💼 **企业环境** → 标准化系统安装

### 4.2 PXE环境组件


**核心服务**：

```
PXE启动环境架构：
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│  DHCP服务   │    │  TFTP服务   │    │  HTTP服务   │
│ 分配IP地址   │    │ 传输启动文件  │    │ 提供安装包   │
│ 指定启动服务器│    │             │    │             │
└─────────────┘    └─────────────┘    └─────────────┘
       ↓                   ↓                   ↓
┌──────────────────────────────────────────────────────┐
│                  客户端电脑                          │
│  1.获取IP → 2.下载启动文件 → 3.下载安装程序        │
└──────────────────────────────────────────────────────┘
```

### 4.3 DHCP服务配置


**DHCP作用**：为启动的电脑分配IP地址，并告诉它从哪里下载启动文件

```bash
# 安装DHCP服务
sudo apt install isc-dhcp-server  # Ubuntu/Debian
sudo yum install dhcp-server      # CentOS/RHEL

# 配置文件：/etc/dhcp/dhcpd.conf
subnet 192.168.1.0 netmask 255.255.255.0 {
    range 192.168.1.100 192.168.1.200;     # IP地址池
    option routers 192.168.1.1;            # 网关
    option domain-name-servers 8.8.8.8;    # DNS服务器
    
    # PXE相关配置
    next-server 192.168.1.10;              # TFTP服务器IP
    filename "pxelinux.0";                  # 启动文件名
}

# 启动DHCP服务
sudo systemctl enable dhcpd
sudo systemctl start dhcpd
```

### 4.4 TFTP服务配置


**TFTP作用**：提供启动文件的下载服务

```bash
# 安装TFTP服务
sudo apt install tftpd-hpa        # Ubuntu/Debian
sudo yum install tftp-server      # CentOS/RHEL

# 配置TFTP服务
# 编辑 /etc/default/tftpd-hpa
TFTP_USERNAME="tftp"
TFTP_DIRECTORY="/var/lib/tftpboot"
TFTP_ADDRESS=":69"
TFTP_OPTIONS="--secure"

# 创建启动文件目录
sudo mkdir -p /var/lib/tftpboot
sudo mkdir -p /var/lib/tftpboot/pxelinux.cfg

# 复制启动文件
sudo cp /usr/lib/PXELINUX/pxelinux.0 /var/lib/tftpboot/
sudo cp /usr/lib/syslinux/modules/bios/*.c32 /var/lib/tftpboot/
```

### 4.5 启动配置文件


**PXE启动菜单配置**：

```bash
# 创建默认启动配置：/var/lib/tftpboot/pxelinux.cfg/default
DEFAULT menu.c32
PROMPT 0
TIMEOUT 30

MENU TITLE PXE Boot Menu
MENU BACKGROUND splash.png

LABEL local
    MENU LABEL Boot from ^Local Hard Drive
    LOCALBOOT 0

LABEL ubuntu_install
    MENU LABEL ^Install Ubuntu 22.04
    KERNEL ubuntu/vmlinuz
    APPEND initrd=ubuntu/initrd.img boot=casper netboot=nfs nfsroot=192.168.1.10:/ubuntu

LABEL centos_install  
    MENU LABEL Install ^CentOS 8
    KERNEL centos/vmlinuz
    APPEND initrd=centos/initrd.img ks=http://192.168.1.10/centos/ks.cfg
```

---

## 5. ✅ 安装介质完整性验证


### 5.1 为什么要验证完整性


**验证的重要性**：确保安装介质没有问题，避免安装失败

> **💡 类比**：就像买药要检查包装是否完整、有效期是否过期一样，安装介质也要检查完整性

**常见问题及后果**：
```
文件损坏 → 安装过程中断
缺失文件 → 系统功能异常  
校验失败 → 安全风险
介质老化 → 读取错误
```

### 5.2 数字签名验证


**什么是数字签名**：就像官方的防伪印章，证明文件确实来自官方且未被篡改

```bash
# 1. 下载GPG公钥
wget https://releases.ubuntu.com/22.04/SHA256SUMS.gpg
gpg --keyserver keyserver.ubuntu.com --recv-keys 843938DF228D22F7B3742BC0D94AA3F0EFE21092

# 2. 验证签名
gpg --verify SHA256SUMS.gpg SHA256SUMS

# 成功输出示例：
# gpg: Good signature from "Ubuntu CD Image Automatic Signing Key (2012) <cdimage@ubuntu.com>"
```

**签名验证流程**：
```
官方服务器                     用户电脑
├── 生成ISO文件               ├── 下载ISO文件
├── 计算校验码                ├── 下载校验码  
├── 使用私钥签名校验码          ├── 下载签名文件
└── 发布：ISO + 校验码 + 签名   └── 用公钥验证签名 ✓
```

### 5.3 介质读取测试


**U盘读取测试**：
```bash
# 1. 扇区读取测试
sudo dd if=/dev/sdb of=/dev/null bs=4096 count=1000
# 如果有坏块会报错

# 2. 文件系统检查
sudo fsck /dev/sdb1
# 检查文件系统完整性

# 3. 挂载测试
sudo mount /dev/sdb1 /mnt
ls -la /mnt/
# 能正常访问文件说明介质良好
```

**光盘验证测试**：
```bash
# 1. 读取测试
sudo dd if=/dev/cdrom of=/dev/null
# 能完整读取说明光盘无划痕

# 2. 校验ISO内容
sudo dd if=/dev/cdrom of=/tmp/cd_image.iso
sha256sum /tmp/cd_image.iso
# 与原ISO对比校验码
```

---

## 6. 🔒 安全启动配置


### 6.1 什么是安全启动


**Secure Boot**：一种安全机制，只允许运行经过数字签名认证的启动程序

```
安全启动工作原理：

传统启动：
BIOS → 启动程序 → 操作系统
（任何程序都能启动，存在安全风险）

安全启动：  
UEFI → 检查签名 → 允许启动程序 → 操作系统
       ↓
    未签名程序被拒绝 ❌
```

**作用**：
- 🛡️ 防止恶意软件在启动阶段植入
- 🔐 确保只运行信任的操作系统
- ⚡ 提高系统启动安全性

### 6.2 启动优先级设置


**BIOS/UEFI启动顺序配置**：

```
启动顺序设置流程：
1. 开机时按F2/F12/Del进入BIOS
2. 找到"Boot"或"启动"选项
3. 调整启动顺序

推荐启动顺序：
┌─────────────────┐
│ 1st: USB Drive │ ← U盘优先（安装时）
│ 2nd: Hard Disk │ ← 硬盘第二
│ 3rd: CD/DVD    │ ← 光驱第三  
│ 4th: Network   │ ← 网络启动最后
└─────────────────┘
```

**不同品牌进入方式**：
| 品牌 | 按键 | 启动选择 | BIOS设置 |
|------|------|----------|----------|
| **Dell** | `F12` | F12启动菜单 | F2进入BIOS |
| **HP** | `F9` | F9启动菜单 | F10进入BIOS |
| **Lenovo** | `F12` | F12启动菜单 | F1进入BIOS |
| **Asus** | `F8` | F8启动菜单 | Del进入BIOS |

### 6.3 安全启动兼容性


**Linux发行版支持情况**：

| 发行版 | Secure Boot支持 | 说明 |
|--------|----------------|------|
| **Ubuntu** | ✅ 完全支持 | `内置签名，开箱即用` |
| **CentOS/RHEL** | ✅ 完全支持 | `Red Hat签名认证` |
| **openSUSE** | ✅ 完全支持 | `SUSE官方签名` |
| **Debian** | ⚠️ 部分支持 | `需要手动配置` |
| **Arch Linux** | ❌ 不支持 | `需要关闭Secure Boot` |

**配置建议**：
```
新手用户：
├── 选择主流发行版（Ubuntu/CentOS）
├── 保持Secure Boot开启
└── 使用官方镜像

高级用户：
├── 可以关闭Secure Boot
├── 支持更多发行版选择  
└── 自定义内核编译
```

### 6.4 常见启动问题解决


**问题1：Secure Boot阻止启动**
```
现象：显示"Verification failed: (0x1A) Security Violation"
解决：
1. 进入BIOS设置
2. 找到Security → Secure Boot
3. 设置为Disabled
4. 保存并重启
```

**问题2：找不到启动设备**  
```
现象：显示"No bootable device found"
检查：
1. U盘是否正确制作
2. BIOS启动模式是否匹配（UEFI/Legacy）
3. 启动顺序是否正确设置
```

**问题3：启动文件损坏**
```
现象：启动到一半黑屏或报错
解决：
1. 重新校验ISO文件
2. 更换U盘重新制作
3. 尝试不同制作工具
```

---

## 7. 📋 核心要点总结


### 7.1 必须掌握的核心概念


```
🔸 ISO镜像：系统安装盘的数字副本，需要校验完整性
🔸 启动盘：能让电脑从U盘启动的特殊介质
🔸 校验码：确保文件完整性的"数字指纹"(MD5/SHA256)
🔸 PXE启动：通过网络启动和安装系统
🔸 安全启动：只允许认证程序启动的安全机制
```

### 7.2 关键操作要点


**🔹 ISO下载与校验**
```
标准流程：
1. 从官方源下载ISO和校验文件
2. 使用sha256sum验证文件完整性  
3. 校验通过才能制作启动盘
4. 建议保留ISO文件备用
```

**🔹 启动盘制作选择**
```
工具选择原则：
- Linux环境 → dd命令（精确控制）
- Windows环境 → Rufus（功能强大）
- 跨平台需求 → Etcher（操作简单）
- 批量制作 → 脚本自动化
```

**🔹 启动配置要点**
```
关键配置：
- UEFI新电脑 → GPT分区 + UEFI模式
- BIOS老电脑 → MBR分区 + Legacy模式  
- U盘选择 → USB 3.0 + 8GB以上
- 安全启动 → 主流发行版可保持开启
```

### 7.3 实际应用价值


**🎯 个人使用场景**
- **系统安装** → 制作U盘启动盘安装Linux
- **系统修复** → 制作救援盘修复系统问题
- **多系统测试** → 制作不同发行版的启动盘

**🏢 企业应用场景**  
- **批量部署** → PXE网络启动批量安装
- **标准化管理** → 统一的系统镜像和配置
- **远程安装** → IPMI + PXE无人值守安装

**🔧 运维实践要点**
- **安全第一** → 始终验证镜像完整性和数字签名
- **兼容性测试** → 在目标硬件上测试启动盘
- **备份策略** → 保留多个版本的启动盘
- **文档记录** → 记录制作过程和配置参数

### 7.4 常见问题防范


**预防措施**：
- ✅ **下载前** → 选择官方或可信镜像源
- ✅ **制作前** → 校验ISO文件完整性  
- ✅ **制作后** → 测试启动盘功能
- ✅ **使用前** → 备份重要数据

**核心记忆**：
- 安装介质是系统部署的基础，质量决定成败
- 校验完整性是确保安全的必要步骤
- 工具选择要根据环境和需求决定
- 启动配置要匹配硬件特性
- 网络启动适合批量部署场景