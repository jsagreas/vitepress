---
title: 8ã€GRUB2é«˜çº§åŠŸèƒ½ä¸å®šåˆ¶
---
## ğŸ“š ç›®å½•

1. [GRUB2é«˜çº§å®šåˆ¶æ¦‚è¿°](#1-GRUB2é«˜çº§å®šåˆ¶æ¦‚è¿°)
2. [ä¸»é¢˜ä¸è§†è§‰å®šåˆ¶](#2-ä¸»é¢˜ä¸è§†è§‰å®šåˆ¶)
3. [å¼•å¯¼èœå•è¡Œä¸ºæ§åˆ¶](#3-å¼•å¯¼èœå•è¡Œä¸ºæ§åˆ¶)
4. [GRUB2è„šæœ¬ç¼–ç¨‹](#4-GRUB2è„šæœ¬ç¼–ç¨‹)
5. [æ¡ä»¶å¯åŠ¨ä¸æ™ºèƒ½é…ç½®](#5-æ¡ä»¶å¯åŠ¨ä¸æ™ºèƒ½é…ç½®)
6. [ç¯å¢ƒå˜é‡ç®¡ç†ç³»ç»Ÿ](#6-ç¯å¢ƒå˜é‡ç®¡ç†ç³»ç»Ÿ)
7. [åŠ¨æ€èœå•ç”Ÿæˆæœºåˆ¶](#7-åŠ¨æ€èœå•ç”Ÿæˆæœºåˆ¶)
8. [ç½‘ç»œå¯åŠ¨é…ç½®](#8-ç½‘ç»œå¯åŠ¨é…ç½®)
9. [è‡ªå®šä¹‰æ¨¡å—å¼€å‘](#9-è‡ªå®šä¹‰æ¨¡å—å¼€å‘)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ GRUB2é«˜çº§å®šåˆ¶æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯GRUB2é«˜çº§åŠŸèƒ½


**ğŸ”¸ åŸºæœ¬å®šä¹‰**
```
GRUB2é«˜çº§åŠŸèƒ½ï¼šè¶…è¶ŠåŸºæœ¬å¯åŠ¨éœ€æ±‚çš„å®šåˆ¶åŒ–é…ç½®
ç›®çš„ï¼šè®©å¼•å¯¼è¿‡ç¨‹æ›´ç¾è§‚ã€æ™ºèƒ½ã€çµæ´»
æœ¬è´¨ï¼šé€šè¿‡é…ç½®æ–‡ä»¶å’Œè„šæœ¬å®ç°ä¸ªæ€§åŒ–å¯åŠ¨ä½“éªŒ
```

**ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦é«˜çº§å®šåˆ¶**
```
ç”Ÿæ´»åŒ–ç±»æ¯”ï¼š
åŸºç¡€GRUB2 = æ¯›å¯æˆ¿ï¼ˆèƒ½ä½ï¼Œä½†ä¸ç¾è§‚ï¼‰
é«˜çº§å®šåˆ¶ = ç²¾è£…ä¿®ï¼ˆæ—¢å®ç”¨åˆç¾è§‚ï¼‰

å®é™…éœ€æ±‚ï¼š
â€¢ ä¼ä¸šç¯å¢ƒï¼šç»Ÿä¸€ç¾è§‚çš„å¯åŠ¨ç•Œé¢
â€¢ æŠ€æœ¯çˆ±å¥½è€…ï¼šä¸ªæ€§åŒ–å®šåˆ¶ä½“éªŒ
â€¢ å¤šç³»ç»Ÿç”¨æˆ·ï¼šæ™ºèƒ½å¯åŠ¨é€‰æ‹©
â€¢ æœåŠ¡å™¨ç®¡ç†ï¼šç½‘ç»œæ‰¹é‡éƒ¨ç½²
```

### 1.2 GRUB2é…ç½®æ–‡ä»¶ä½“ç³»


**ğŸ“‹ é…ç½®æ–‡ä»¶ç»“æ„å›¾**
```
/boot/grub/
â”œâ”€â”€ grub.cfg          â† ä¸»é…ç½®æ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼Œä¸è¦æ‰‹åŠ¨ç¼–è¾‘ï¼‰
â”œâ”€â”€ grubenv           â† ç¯å¢ƒå˜é‡å­˜å‚¨æ–‡ä»¶
â”œâ”€â”€ themes/           â† ä¸»é¢˜æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ my-theme/
â”‚   â”‚   â”œâ”€â”€ theme.txt
â”‚   â”‚   â”œâ”€â”€ background.png
â”‚   â”‚   â””â”€â”€ icons/
â””â”€â”€ custom.cfg        â† è‡ªå®šä¹‰é…ç½®ï¼ˆå¯é€‰ï¼‰

/etc/default/grub     â† ç”¨æˆ·é…ç½®æ–‡ä»¶ï¼ˆä¸»è¦ç¼–è¾‘è¿™ä¸ªï¼‰
/etc/grub.d/          â† é…ç½®ç”Ÿæˆè„šæœ¬ç›®å½•
â”œâ”€â”€ 00_header
â”œâ”€â”€ 10_linux
â”œâ”€â”€ 20_linux_xen
â”œâ”€â”€ 30_os-prober
â”œâ”€â”€ 40_custom         â† è‡ªå®šä¹‰è„šæœ¬
â””â”€â”€ 41_custom
```

**âš ï¸ é…ç½®åŸåˆ™**
> **é‡è¦æé†’**
> - æ°¸è¿œä¸è¦ç›´æ¥ç¼–è¾‘ `/boot/grub/grub.cfg`
> - ä¿®æ”¹ `/etc/default/grub` åå¿…é¡»è¿è¡Œ `update-grub`
> - è‡ªå®šä¹‰è„šæœ¬æ”¾åœ¨ `/etc/grub.d/40_custom`

### 1.3 GRUB2å·¥ä½œæµç¨‹


**ğŸ”„ é…ç½®ç”Ÿæˆæµç¨‹**
```
ç”¨æˆ·ä¿®æ”¹é…ç½®
      â†“
/etc/default/grub â† ä¸»è¦é…ç½®æ–‡ä»¶
      â†“
/etc/grub.d/* è„šæœ¬ â† é…ç½®ç”Ÿæˆè„šæœ¬
      â†“
update-grub å‘½ä»¤ â† æ‰§è¡Œé…ç½®ç”Ÿæˆ
      â†“
/boot/grub/grub.cfg â† æœ€ç»ˆé…ç½®æ–‡ä»¶
      â†“
ç³»ç»Ÿé‡å¯æ—¶åŠ è½½
```

---

## 2. ğŸ¨ ä¸»é¢˜ä¸è§†è§‰å®šåˆ¶


### 2.1 GRUB2ä¸»é¢˜ç³»ç»ŸåŸç†


**ğŸ”¸ ä¸»é¢˜çš„æœ¬è´¨**
```
GRUB2ä¸»é¢˜ = ä¸€å¥—è§†è§‰æ ·å¼æ–‡ä»¶
åŒ…å«ï¼šèƒŒæ™¯å›¾ç‰‡ + å­—ä½“ + é¢œè‰² + å¸ƒå±€é…ç½®
ç›®çš„ï¼šè®©å†°å†·çš„å¯åŠ¨èœå•å˜å¾—ç¾è§‚å‹å¥½
```

**ğŸ–¼ï¸ ä¸»é¢˜æ–‡ä»¶ç»“æ„**
```
/boot/grub/themes/my-theme/
â”œâ”€â”€ theme.txt           â† ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼ˆå¿…éœ€ï¼‰
â”œâ”€â”€ background.png      â† èƒŒæ™¯å›¾ç‰‡
â”œâ”€â”€ icons/              â† ç³»ç»Ÿå›¾æ ‡ç›®å½•
â”‚   â”œâ”€â”€ ubuntu.png
â”‚   â”œâ”€â”€ windows.png
â”‚   â””â”€â”€ generic.png
â”œâ”€â”€ fonts/              â† å­—ä½“æ–‡ä»¶
â”‚   â””â”€â”€ my-font.pf2
â”œâ”€â”€ select_c.png        â† èœå•é€‰ä¸­çŠ¶æ€èƒŒæ™¯
â”œâ”€â”€ select_e.png        â† èœå•é€‰ä¸­çŠ¶æ€è¾¹æ¡†
â””â”€â”€ select_w.png        â† èœå•é€‰ä¸­çŠ¶æ€è¥¿è¾¹æ¡†
```

### 2.2 èƒŒæ™¯å›¾ç‰‡é…ç½®


**ğŸ–¼ï¸ èƒŒæ™¯å›¾ç‰‡è¦æ±‚**
```
æ”¯æŒæ ¼å¼ï¼šPNG, JPG, TGA
å»ºè®®åˆ†è¾¨ç‡ï¼š
â€¢ 1920x1080 (Full HD)
â€¢ 1366x768 (ç¬”è®°æœ¬å¸¸è§)
â€¢ 800x600 (å…¼å®¹æ€§å¥½)

é¢œè‰²æ·±åº¦ï¼š24ä½çœŸå½©è‰²
æ–‡ä»¶å¤§å°ï¼šå»ºè®® < 2MBï¼ˆå¯åŠ¨é€Ÿåº¦è€ƒè™‘ï¼‰
```

**âš™ï¸ èƒŒæ™¯é…ç½®æ–¹æ³•**

**æ–¹æ³•1ï¼šå…¨å±€é…ç½®**
```bash
# ç¼–è¾‘ä¸»é…ç½®æ–‡ä»¶
sudo nano /etc/default/grub

# æ·»åŠ æˆ–ä¿®æ”¹ä»¥ä¸‹è¡Œ
GRUB_BACKGROUND="/boot/grub/themes/my-theme/background.png"

# æ›´æ–°é…ç½®
sudo update-grub
```

**æ–¹æ³•2ï¼šä¸»é¢˜é…ç½®**
```bash
# åˆ›å»ºä¸»é¢˜ç›®å½•
sudo mkdir -p /boot/grub/themes/my-theme

# å¤åˆ¶èƒŒæ™¯å›¾ç‰‡
sudo cp ~/my-background.png /boot/grub/themes/my-theme/background.png

# åˆ›å»ºä¸»é¢˜é…ç½®æ–‡ä»¶
sudo nano /boot/grub/themes/my-theme/theme.txt
```

**ğŸ“ ä¸»é¢˜é…ç½®æ–‡ä»¶ç¤ºä¾‹**
```ini
# theme.txt åŸºç¡€é…ç½®
desktop-image: "background.png"
desktop-color: "#000000"
desktop-image-scale-method: "stretch"
desktop-image-h-align: "center" 
desktop-image-v-align: "center"

# èœå•æ ·å¼
title-font: "Unifont Regular 16"
title-color: "#FFFFFF"
title-text: ""

menu-color-normal: "#FFFFFF"
menu-color-highlight: "#FF6600" 
menu-pixmap-style: "select_*.png"

# ç»ˆç«¯æ ·å¼
terminal-font: "Unifont Regular 16"
terminal-width: "80%"
terminal-height: "24"
terminal-border: "1"
terminal-top: "10%"
terminal-left: "10%"
```

### 2.3 å­—ä½“å®šåˆ¶


**ğŸ”¤ GRUB2å­—ä½“ç³»ç»Ÿ**
```
GRUB2å­—ä½“æ ¼å¼ï¼š.pf2 (GRUB2ä¸“ç”¨æ ¼å¼)
æ¥æºï¼šä»TTF/OTFå­—ä½“è½¬æ¢è€Œæ¥
å·¥å…·ï¼šgrub-mkfont å‘½ä»¤
```

**å­—ä½“è½¬æ¢æ­¥éª¤**
```bash
# 1. å‡†å¤‡TTFå­—ä½“æ–‡ä»¶
wget https://fonts.google.com/specimen/Roboto

# 2. è½¬æ¢ä¸ºGRUB2æ ¼å¼
sudo grub-mkfont --output=/boot/grub/themes/my-theme/roboto-16.pf2 \
                 --size=16 \
                 ~/Downloads/Roboto-Regular.ttf

# 3. åœ¨ä¸»é¢˜ä¸­ä½¿ç”¨
echo 'title-font: "roboto-16"' >> /boot/grub/themes/my-theme/theme.txt
```

**å¸¸ç”¨å­—ä½“å¤§å°å»ºè®®**
```
æ ‡é¢˜å­—ä½“ï¼š16-24 åƒç´ 
èœå•å­—ä½“ï¼š14-16 åƒç´ 
ç»ˆç«¯å­—ä½“ï¼š12-14 åƒç´ 

ä¸­æ–‡å­—ä½“æ”¯æŒï¼š
sudo grub-mkfont --output=/boot/grub/fonts/chinese.pf2 \
                 --size=16 \
                 /usr/share/fonts/truetype/wqy/wqy-zenhei.ttc
```

### 2.4 é¢œè‰²ä¸æ ·å¼å®šåˆ¶


**ğŸ¨ é¢œè‰²é…ç½®è¡¨**
| é…ç½®é¡¹ | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|--------|
| `desktop-color` | èƒŒæ™¯è‰² | `#000000` (é»‘è‰²) |
| `title-color` | æ ‡é¢˜æ–‡å­—è‰² | `#FFFFFF` (ç™½è‰²) |
| `menu-color-normal` | èœå•æ­£å¸¸è‰² | `#CCCCCC` (æµ…ç°) |
| `menu-color-highlight` | èœå•é«˜äº®è‰² | `#FF6600` (æ©™è‰²) |
| `terminal-color-normal` | ç»ˆç«¯æ­£å¸¸è‰² | `#00FF00` (ç»¿è‰²) |

**ğŸ“ å¸ƒå±€é…ç½®**
```ini
# èœå•ä½ç½®ä¸å¤§å°
menu-pixmap-style: "menu_*.png"
menu-width: "400"
menu-height: "300" 
menu-vbox-top: "200"
menu-vbox-left: "300"

# è¿›åº¦æ¡æ ·å¼
progress_bar_style: "progress_bar_*.png"
progress_bar_width: "400"
progress_bar_height: "20"
```

---

## 3. â° å¼•å¯¼èœå•è¡Œä¸ºæ§åˆ¶


### 3.1 èœå•è¶…æ—¶é…ç½®


**ğŸ”¸ è¶…æ—¶çš„å«ä¹‰**
```
èœå•è¶…æ—¶ï¼šç”¨æˆ·ä¸æ“ä½œæ—¶è‡ªåŠ¨å¯åŠ¨é»˜è®¤ç³»ç»Ÿçš„ç­‰å¾…æ—¶é—´
å•ä½ï¼šç§’
é»˜è®¤å€¼ï¼šé€šå¸¸æ˜¯10ç§’
è®¾ä¸º0ï¼šç«‹å³å¯åŠ¨ï¼Œä¸æ˜¾ç¤ºèœå•
è®¾ä¸º-1ï¼šæ°¸ä¹…ç­‰å¾…ç”¨æˆ·é€‰æ‹©
```

**âš™ï¸ è¶…æ—¶é…ç½®æ–¹æ³•**
```bash
# ç¼–è¾‘GRUBé…ç½®
sudo nano /etc/default/grub

# ä¿®æ”¹è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
GRUB_TIMEOUT=5          # ç­‰å¾…5ç§’
GRUB_TIMEOUT=0          # ç«‹å³å¯åŠ¨
GRUB_TIMEOUT=-1         # æ°¸ä¹…ç­‰å¾…

# éšè—è¶…æ—¶ï¼ˆæŒ‰é”®æ‰æ˜¾ç¤ºèœå•ï¼‰
GRUB_TIMEOUT_STYLE=hidden

# æ›´æ–°é…ç½®
sudo update-grub
```

**ğŸ’¡ å®é™…åº”ç”¨åœºæ™¯**
```
å®¶ç”¨ç”µè„‘ï¼šGRUB_TIMEOUT=10    ï¼ˆç»™ç”¨æˆ·å……åˆ†é€‰æ‹©æ—¶é—´ï¼‰
æœåŠ¡å™¨ï¼š  GRUB_TIMEOUT=3     ï¼ˆå¿«é€Ÿå¯åŠ¨ï¼Œå‡å°‘åœæœºæ—¶é—´ï¼‰
åŒç³»ç»Ÿï¼š  GRUB_TIMEOUT=15    ï¼ˆç»™ç”¨æˆ·æ›´å¤šè€ƒè™‘æ—¶é—´ï¼‰
æµ‹è¯•ç¯å¢ƒï¼šGRUB_TIMEOUT=-1    ï¼ˆæ‰‹åŠ¨é€‰æ‹©å¯åŠ¨é¡¹ï¼‰
```

### 3.2 é»˜è®¤å¯åŠ¨é¡¹é…ç½®


**ğŸ¯ é»˜è®¤å¯åŠ¨é¡¹æŒ‡å®šæ–¹æ³•**

**æ–¹æ³•1ï¼šæŒ‰åºå·æŒ‡å®š**
```bash
# ç¼–è¾‘é…ç½®æ–‡ä»¶
sudo nano /etc/default/grub

# è®¾ç½®é»˜è®¤å¯åŠ¨ç¬¬ä¸€é¡¹ï¼ˆä»0å¼€å§‹è®¡æ•°ï¼‰
GRUB_DEFAULT=0          # ç¬¬ä¸€é¡¹
GRUB_DEFAULT=1          # ç¬¬äºŒé¡¹
GRUB_DEFAULT="1>2"      # ç¬¬äºŒä¸ªèœå•çš„ç¬¬ä¸‰é¡¹ï¼ˆå­èœå•ï¼‰

# æ›´æ–°é…ç½®
sudo update-grub
```

**æ–¹æ³•2ï¼šæŒ‰åç§°æŒ‡å®š**
```bash
# ä½¿ç”¨èœå•é¡¹åç§°
GRUB_DEFAULT="Ubuntu"
GRUB_DEFAULT="Windows Boot Manager"

# ä½¿ç”¨å®Œæ•´è·¯å¾„ï¼ˆæ›´ç²¾ç¡®ï¼‰
GRUB_DEFAULT="Advanced options for Ubuntu>Ubuntu, with Linux 5.15.0-generic"
```

**æ–¹æ³•3ï¼šè®°ä½æœ€åé€‰æ‹©**
```bash
# å¯ç”¨ä¿å­˜æœ€åé€‰æ‹©
GRUB_DEFAULT=saved
GRUB_SAVEDEFAULT=true

# è¿™æ ·æ¯æ¬¡å¯åŠ¨é€‰æ‹©çš„é¡¹ç›®ä¼šè¢«è®°ä½
```

### 3.3 èœå•éšè—ä¸æ¡ä»¶æ˜¾ç¤º


**ğŸ‘ï¸ èœå•æ˜¾ç¤ºæ§åˆ¶**
```bash
# å®Œå…¨éšè—èœå•ï¼ˆæŒ‰ESCæ˜¾ç¤ºï¼‰
GRUB_TIMEOUT_STYLE=hidden
GRUB_TIMEOUT=5

# æŒ‰ä½Shiftæ˜¾ç¤ºèœå•
GRUB_FORCE_HIDDEN_MENU="true"

# é™é»˜å¯åŠ¨ï¼ˆæ— è¾“å‡ºä¿¡æ¯ï¼‰
GRUB_CMDLINE_LINUX_DEFAULT="quiet splash"
```

**ğŸ”§ æ¡ä»¶æ˜¾ç¤ºé…ç½®å®ä¾‹**
```bash
#!/bin/bash
# /etc/grub.d/40_custom ä¸­çš„æ¡ä»¶æ˜¾ç¤º

# æ£€æµ‹æ˜¯å¦æœ‰å¤šä¸ªå†…æ ¸
if [ "$(ls /boot/vmlinuz-* | wc -l)" -gt 1 ]; then
    # æœ‰å¤šä¸ªå†…æ ¸æ—¶æ˜¾ç¤ºèœå•
    echo "set timeout=10"
else
    # åªæœ‰ä¸€ä¸ªå†…æ ¸æ—¶å¿«é€Ÿå¯åŠ¨
    echo "set timeout=1"
fi
```

---

## 4. ğŸ“œ GRUB2è„šæœ¬ç¼–ç¨‹


### 4.1 GRUB2è„šæœ¬è¯­è¨€åŸºç¡€


**ğŸ”¸ è„šæœ¬è¯­è¨€ç‰¹ç‚¹**
```
GRUB2è„šæœ¬ï¼šç±»ä¼¼bashä½†åŠŸèƒ½å—é™çš„è„šæœ¬è¯­è¨€
ç”¨é€”ï¼šåœ¨å¯åŠ¨æ—¶æ‰§è¡Œæ¡ä»¶åˆ¤æ–­å’ŒåŠ¨æ€é…ç½®
æ–‡ä»¶ä½ç½®ï¼š/etc/grub.d/ ç›®å½•ä¸‹çš„å¯æ‰§è¡Œè„šæœ¬
æ‰§è¡Œæ—¶æœºï¼šè¿è¡Œupdate-grubæ—¶æ‰§è¡Œï¼Œç”Ÿæˆæœ€ç»ˆé…ç½®
```

**ğŸ“ åŸºç¡€è¯­æ³•ç»“æ„**
```bash
#!/bin/bash
# /etc/grub.d/40_custom

# è¿™éƒ¨åˆ†åœ¨update-grubæ—¶æ‰§è¡Œï¼ˆç”Ÿæˆé…ç½®ï¼‰
echo "# è¿™æ˜¯æ³¨é‡Š"

# è¾“å‡ºåˆ°grub.cfgçš„å†…å®¹
cat << 'EOF'
# è¿™éƒ¨åˆ†åœ¨GRUB2å¯åŠ¨æ—¶æ‰§è¡Œ

# è®¾ç½®å˜é‡
set my_var="hello"

# æ¡ä»¶åˆ¤æ–­
if [ -e (hd0,1)/vmlinuz ]; then
    echo "Found kernel on first partition"
fi

# å¾ªç¯
for device in (*); do
    echo "Checking device: $device"
done

EOF
```

### 4.2 å˜é‡ä¸ç¯å¢ƒæ“ä½œ


**ğŸ’¾ GRUB2å˜é‡ç³»ç»Ÿ**
```bash
# åœ¨grub.cfgä¸­çš„å˜é‡æ“ä½œ

# è®¾ç½®å˜é‡
set root='hd0,msdos1'
set my_theme='/boot/grub/themes/my-theme'

# ä½¿ç”¨å˜é‡
echo "Root is: $root"
echo "Theme path: ${my_theme}/theme.txt"

# ç¯å¢ƒå˜é‡ï¼ˆé‡å¯åä¿æŒï¼‰
save_env my_var
load_env my_var

# ç‰¹æ®Šå˜é‡
echo "Current root: $root"
echo "Current prefix: $prefix"      # GRUB2å®‰è£…è·¯å¾„
echo "Command line: $cmdline"       # å†…æ ¸å‘½ä»¤è¡Œ
```

**ğŸ”§ ç¯å¢ƒå˜é‡å®é™…åº”ç”¨**
```bash
#!/bin/bash
# /etc/grub.d/40_custom

cat << 'EOF'
# è®°å½•å¯åŠ¨æ¬¡æ•°
if [ -z "$boot_count" ]; then
    set boot_count=1
else
    set boot_count=$((boot_count + 1))
fi

echo "This is boot #$boot_count"
save_env boot_count

# æ ¹æ®å¯åŠ¨æ¬¡æ•°é€‰æ‹©ä¸åŒé…ç½®
if [ "$boot_count" -gt 3 ]; then
    echo "Multiple boots detected, entering safe mode"
    set default="1"  # é€‰æ‹©å®‰å…¨æ¨¡å¼å¯åŠ¨é¡¹
fi
EOF
```

### 4.3 æ¡ä»¶åˆ¤æ–­ä¸é€»è¾‘æ§åˆ¶


**ğŸ¤” æ¡ä»¶åˆ¤æ–­è¯­æ³•**
```bash
# æ–‡ä»¶å­˜åœ¨æ€§æ£€æŸ¥
if [ -e (hd0,1)/vmlinuz ]; then
    echo "Kernel found"
fi

# å­—ç¬¦ä¸²æ¯”è¾ƒ
if [ "$my_var" = "test" ]; then
    echo "Variable matches"
fi

# æ•°å€¼æ¯”è¾ƒ
if [ "$number" -gt 5 ]; then
    echo "Number is greater than 5"
fi

# ç»„åˆæ¡ä»¶
if [ -e (hd0,1)/vmlinuz -a "$enable_kernel" = "yes" ]; then
    echo "Kernel available and enabled"
fi
```

**ğŸ”„ å¾ªç¯ç»“æ„**
```bash
# éå†è®¾å¤‡
for device in (*); do
    echo "Found device: $device" 
    if [ -e "$device/vmlinuz" ]; then
        echo "  Has kernel"
    fi
done

# éå†æ–‡ä»¶
for kernel in (hd0,1)/vmlinuz-*; do
    echo "Found kernel: $kernel"
done
```

### 4.4 å‡½æ•°å®šä¹‰ä¸è°ƒç”¨


**âš™ï¸ è‡ªå®šä¹‰å‡½æ•°**
```bash
# å®šä¹‰å‡½æ•°
function detect_os {
    set device="$1"
    if [ -e "$device/Windows/System32" ]; then
        return "windows"
    elif [ -e "$device/etc/fstab" ]; then
        return "linux"
    else
        return "unknown"
    fi
}

# è°ƒç”¨å‡½æ•°
detect_os (hd0,1)
if [ "$?" = "windows" ]; then
    echo "Windows detected on (hd0,1)"
fi
```

---

## 5. ğŸ§  æ¡ä»¶å¯åŠ¨ä¸æ™ºèƒ½é…ç½®


### 5.1 ç¡¬ä»¶æ£€æµ‹é©±åŠ¨çš„æ¡ä»¶å¯åŠ¨


**ğŸ” ç¡¬ä»¶æ£€æµ‹åŸç†**
```
ç¡¬ä»¶æ£€æµ‹ç›®çš„ï¼šæ ¹æ®ä¸åŒç¡¬ä»¶é€‰æ‹©æœ€é€‚åˆçš„å¯åŠ¨æ–¹å¼
æ£€æµ‹å†…å®¹ï¼šCPUç±»å‹ã€å†…å­˜å¤§å°ã€æ˜¾å¡å‹å·ã€ç½‘ç»œè®¾å¤‡
å®ç°æ–¹å¼ï¼šé€šè¿‡GRUB2çš„ç¡¬ä»¶æ£€æµ‹åŠŸèƒ½å’Œæ¡ä»¶åˆ¤æ–­
```

**ğŸ’» CPUæ¶æ„æ£€æµ‹**
```bash
#!/bin/bash
# /etc/grub.d/40_custom

cat << 'EOF'
# æ£€æµ‹CPUæ¶æ„
cpuid --feature-detect

# æ ¹æ®CPUç‰¹æ€§é€‰æ‹©å†…æ ¸å‚æ•°
if cpuid -f sse2; then
    set cpu_opts="sse2"
    echo "SSE2 support detected"
fi

if cpuid -f x64; then
    set kernel_suffix="x86_64"
else
    set kernel_suffix="i386"
fi

# åŠ¨æ€ç”Ÿæˆå¯åŠ¨é¡¹
menuentry "Optimized Linux ($kernel_suffix)" {
    linux /vmlinuz root=/dev/sda1 $cpu_opts
    initrd /initrd.img
}
EOF
```

**ğŸ–¥ï¸ å†…å­˜å¤§å°æ£€æµ‹**
```bash
# åœ¨grub.cfgä¸­æ£€æµ‹å†…å­˜
if [ "$grub_total_mem" -lt 1048576 ]; then    # å°äº1GB
    echo "Low memory detected, using minimal kernel"
    set kernel_params="mem=512M"
elif [ "$grub_total_mem" -gt 4194304 ]; then  # å¤§äº4GB
    echo "High memory detected, enabling all features"
    set kernel_params="mem=all hugepages=1024"
fi
```

### 5.2 å¤šç³»ç»Ÿæ™ºèƒ½è¯†åˆ«


**ğŸ–¥ï¸ æ“ä½œç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹**
```bash
#!/bin/bash
# å¢å¼ºçš„ç³»ç»Ÿæ£€æµ‹è„šæœ¬

cat << 'EOF'
# ç³»ç»Ÿæ£€æµ‹å‡½æ•°
function scan_for_systems {
    echo "Scanning for operating systems..."
    
    # æ‰«ææ‰€æœ‰åˆ†åŒº
    for device in (hd*); do
        echo "Checking $device"
        
        # æ£€æµ‹Windows
        if [ -e "$device/Windows/System32/winload.exe" ]; then
            echo "Found Windows on $device"
            
            menuentry "Windows (on $device)" "$device" {
                set root="$2"
                chainloader /Windows/System32/winload.exe
            }
        fi
        
        # æ£€æµ‹Linux
        if [ -e "$device/etc/fstab" ]; then
            echo "Found Linux on $device"
            
            # æ£€æµ‹å‘è¡Œç‰ˆ
            if [ -e "$device/etc/debian_version" ]; then
                set distro="Debian/Ubuntu"
            elif [ -e "$device/etc/redhat-release" ]; then
                set distro="Red Hat/CentOS"
            else
                set distro="Linux"
            fi
            
            menuentry "$distro (on $device)" "$device" {
                set root="$2"
                linux /vmlinuz root=$2
                initrd /initrd.img
            }
        fi
        
        # æ£€æµ‹macOS
        if [ -e "$device/System/Library/CoreServices/boot.efi" ]; then
            echo "Found macOS on $device"
            
            menuentry "macOS (on $device)" "$device" {
                set root="$2"  
                chainloader /System/Library/CoreServices/boot.efi
            }
        fi
    done
}

# æ‰§è¡Œæ‰«æ
scan_for_systems
EOF
```

### 5.3 ç½‘ç»œç¯å¢ƒé€‚åº”æ€§å¯åŠ¨


**ğŸŒ ç½‘ç»œå¯åŠ¨æ¡ä»¶åˆ¤æ–­**
```bash
cat << 'EOF'
# ç½‘ç»œç¯å¢ƒæ£€æµ‹
function check_network_boot {
    # æ£€æµ‹æ˜¯å¦æœ‰ç½‘ç»œæ¥å£
    if net_get_dhcp_option net_default_server 1 string; then
        echo "DHCP server found: $net_default_server"
        set network_available=1
        
        # å°è¯•ç½‘ç»œå¯åŠ¨é€‰é¡¹
        if [ -n "$net_pxe_boot_file" ]; then
            menuentry "Network Boot (PXE)" {
                set root=(pxe)
                linux (pxe)/$net_pxe_boot_file
            }
        fi
        
        # ç½‘ç»œå®‰è£…é€‰é¡¹
        menuentry "Network Installation" {
            set root=(http,192.168.1.100)/
            linux /install/vmlinuz ip=dhcp url=http://192.168.1.100/ubuntu/
            initrd /install/initrd.gz
        }
    else
        echo "No network detected, local boot only"
        set network_available=0
    fi
}

check_network_boot
EOF
```

### 5.4 æ•…éšœæ¢å¤ä¸å®‰å…¨æ¨¡å¼


**ğŸ›¡ï¸ æ™ºèƒ½æ•…éšœæ£€æµ‹**
```bash
cat << 'EOF'
# å¯åŠ¨å¤±è´¥è®¡æ•°å™¨
if [ -z "$boot_failure_count" ]; then
    set boot_failure_count=0
fi

# æ£€æµ‹ä¸Šæ¬¡æ˜¯å¦å¯åŠ¨æˆåŠŸ
if [ "$boot_success" != "1" ]; then
    set boot_failure_count=$((boot_failure_count + 1))
    echo "Boot failure #$boot_failure_count detected"
    
    # è¿ç»­å¤±è´¥3æ¬¡è¿›å…¥æ¢å¤æ¨¡å¼
    if [ "$boot_failure_count" -ge 3 ]; then
        echo "Multiple boot failures, entering recovery mode"
        set default="recovery"
        set timeout=30
        
        menuentry "Emergency Recovery Shell" {
            insmod efi_gop
            insmod efi_uga
            echo "Entering emergency recovery mode..."
            echo "Type 'exit' to return to GRUB menu"
            grub_rescue
        }
        
        menuentry "Safe Mode Linux" {
            linux /vmlinuz root=/dev/sda1 single init=/bin/bash
            initrd /initrd.img
        }
    fi
fi

# ä¿å­˜çŠ¶æ€
save_env boot_failure_count
EOF
```

---

## 6. ğŸŒ ç¯å¢ƒå˜é‡ç®¡ç†ç³»ç»Ÿ


### 6.1 GRUB2ç¯å¢ƒå˜é‡æœºåˆ¶


**ğŸ”¸ ç¯å¢ƒå˜é‡å­˜å‚¨åŸç†**
```
å­˜å‚¨ä½ç½®ï¼š/boot/grub/grubenv æ–‡ä»¶
å­˜å‚¨æ ¼å¼ï¼šé”®å€¼å¯¹ï¼Œæ¯è¡Œä¸€ä¸ªå˜é‡
æŒä¹…æ€§ï¼šé‡å¯åä¿æŒï¼Œç±»ä¼¼BIOSè®¾ç½®
å®¹é‡é™åˆ¶ï¼šçº¦1KBå¤§å°ï¼Œå˜é‡åä¸è¶…è¿‡255å­—ç¬¦
```

**ğŸ“‹ grubenvæ–‡ä»¶ç»“æ„**
```bash
# æŸ¥çœ‹å½“å‰ç¯å¢ƒå˜é‡
sudo grub-editenv /boot/grub/grubenv list

# å…¸å‹å†…å®¹ç¤ºä¾‹
next_entry=0
boot_success=1 
prev_saved_entry=Ubuntu
custom_theme=/boot/grub/themes/dark
network_config=dhcp
```

### 6.2 ç¯å¢ƒå˜é‡æ“ä½œå‘½ä»¤


**âš™ï¸ åŸºæœ¬æ“ä½œå‘½ä»¤**
```bash
# æŸ¥çœ‹æ‰€æœ‰å˜é‡
sudo grub-editenv /boot/grub/grubenv list

# è®¾ç½®å•ä¸ªå˜é‡
sudo grub-editenv /boot/grub/grubenv set my_var=value

# åˆ é™¤å˜é‡
sudo grub-editenv /boot/grub/grubenv unset my_var

# åˆ›å»ºæ–°çš„ç¯å¢ƒæ–‡ä»¶
sudo grub-editenv /boot/grub/grubenv create

# åœ¨GRUBè„šæœ¬ä¸­ä½¿ç”¨
load_env my_var        # ä»grubenvåŠ è½½å˜é‡
save_env my_var        # ä¿å­˜å˜é‡åˆ°grubenv
```

**ğŸ’¡ å®é™…åº”ç”¨ç¤ºä¾‹**
```bash
#!/bin/bash
# é…ç½®ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½

# è®¾ç½®ä¸»é¢˜å˜é‡
sudo grub-editenv /boot/grub/grubenv set current_theme=dark
sudo grub-editenv /boot/grub/grubenv set theme_rotation=enabled

# åœ¨GRUBé…ç½®ä¸­ä½¿ç”¨
cat << 'EOF' >> /etc/grub.d/40_custom
# ä¸»é¢˜è½®æ¢åŠŸèƒ½
load_env current_theme

if [ "$current_theme" = "dark" ]; then
    set theme="/boot/grub/themes/dark-theme/theme.txt"
    # ä¸‹æ¬¡ä½¿ç”¨äº®è‰²ä¸»é¢˜
    set current_theme="light"
elif [ "$current_theme" = "light" ]; then
    set theme="/boot/grub/themes/light-theme/theme.txt"
    set current_theme="dark"
else
    # é»˜è®¤ä¸»é¢˜
    set theme="/boot/grub/themes/default/theme.txt"
    set current_theme="dark"
fi

save_env current_theme
EOF
```

### 6.3 å¯åŠ¨çŠ¶æ€è·Ÿè¸ª


**ğŸ“Š å¯åŠ¨ç»Ÿè®¡åŠŸèƒ½**
```bash
cat << 'EOF'
# å¯åŠ¨ç»Ÿè®¡å’Œå¥åº·ç›‘æ§

# åŠ è½½ç»Ÿè®¡å˜é‡
load_env total_boots
load_env last_boot_time
load_env boot_success_rate

# æ›´æ–°å¯åŠ¨æ¬¡æ•°
if [ -z "$total_boots" ]; then
    set total_boots=1
else
    set total_boots=$((total_boots + 1))
fi

# è®°å½•å¯åŠ¨æ—¶é—´ï¼ˆç®€åŒ–ç‰ˆï¼‰
set current_time=`date +%s`
set last_boot_time="$current_time"

# è®¡ç®—æˆåŠŸç‡ï¼ˆéœ€è¦åœ¨ç³»ç»Ÿå¯åŠ¨å®Œæˆåæ›´æ–°ï¼‰
echo "Total boots: $total_boots"
echo "Last successful boot: $last_boot_time"

# ä¿å­˜ç»Ÿè®¡æ•°æ®
save_env total_boots
save_env last_boot_time
save_env boot_success_rate
EOF
```

### 6.4 ç”¨æˆ·åå¥½è®¾ç½®ç®¡ç†


**ğŸ‘¤ ä¸ªæ€§åŒ–é…ç½®ç®¡ç†**
```bash
# ç”¨æˆ·åå¥½è®¾ç½®è„šæœ¬
cat << 'EOF'
# åŠ è½½ç”¨æˆ·åå¥½
load_env user_timeout
load_env user_default_entry
load_env user_theme_preference
load_env user_language

# åº”ç”¨è¶…æ—¶è®¾ç½®
if [ -n "$user_timeout" ]; then
    set timeout="$user_timeout"
else
    set timeout=10  # é»˜è®¤å€¼
fi

# åº”ç”¨é»˜è®¤å¯åŠ¨é¡¹
if [ -n "$user_default_entry" ]; then
    set default="$user_default_entry"
fi

# åº”ç”¨ä¸»é¢˜åå¥½
case "$user_theme_preference" in
    "dark")
        set theme="/boot/grub/themes/dark/theme.txt"
        ;;
    "light") 
        set theme="/boot/grub/themes/light/theme.txt"
        ;;
    "colorful")
        set theme="/boot/grub/themes/colorful/theme.txt"
        ;;
    *)
        set theme="/boot/grub/themes/default/theme.txt"
        ;;
esac

# åº”ç”¨è¯­è¨€è®¾ç½®
if [ -n "$user_language" ]; then
    set lang="$user_language"
fi
EOF

# ç”¨æˆ·é…ç½®å‘½ä»¤ç¤ºä¾‹
sudo grub-editenv /boot/grub/grubenv set user_timeout=5
sudo grub-editenv /boot/grub/grubenv set user_theme_preference=dark
sudo grub-editenv /boot/grub/grubenv set user_language=zh_CN
```

---

## 7. ğŸ”„ åŠ¨æ€èœå•ç”Ÿæˆæœºåˆ¶


### 7.1 èœå•ç”Ÿæˆå·¥ä½œåŸç†


**ğŸ”¸ åŠ¨æ€ç”Ÿæˆçš„å«ä¹‰**
```
é™æ€èœå•ï¼šå†™æ­»åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œä¸ä¼šå˜åŒ–
åŠ¨æ€èœå•ï¼šæ ¹æ®å®é™…æƒ…å†µè‡ªåŠ¨ç”Ÿæˆèœå•é¡¹
ä¼˜åŠ¿ï¼šè‡ªåŠ¨é€‚åº”ç³»ç»Ÿå˜åŒ–ï¼Œæ— éœ€æ‰‹åŠ¨ç»´æŠ¤
å®ç°ï¼šé€šè¿‡è„šæœ¬åœ¨update-grubæ—¶æ‰«æç³»ç»Ÿ
```

**âš™ï¸ ç”Ÿæˆè„šæœ¬æ‰§è¡Œé¡ºåº**
```
GRUBç”Ÿæˆè„šæœ¬æ‰§è¡Œé¡ºåºï¼š
/etc/grub.d/00_header     â† åŸºç¡€é…ç½®ï¼ˆè¶…æ—¶ã€é»˜è®¤é¡¹ç­‰ï¼‰
/etc/grub.d/05_debian_theme â† ä¸»é¢˜è®¾ç½®
/etc/grub.d/10_linux      â† Linuxå†…æ ¸æ‰«æ
/etc/grub.d/20_linux_xen  â† Xenè™šæ‹ŸåŒ–æ”¯æŒ
/etc/grub.d/20_memtest86+ â† å†…å­˜æµ‹è¯•å·¥å…·
/etc/grub.d/30_os-prober  â† å…¶ä»–æ“ä½œç³»ç»Ÿæ£€æµ‹
/etc/grub.d/40_custom     â† ç”¨æˆ·è‡ªå®šä¹‰å†…å®¹
/etc/grub.d/41_custom     â† ç”¨æˆ·è‡ªå®šä¹‰å†…å®¹ï¼ˆæ‰§è¡Œè¾ƒæ™šï¼‰

æ•°å­—è¶Šå°è¶Šå…ˆæ‰§è¡Œï¼Œæ•°å­—ç›¸åŒæŒ‰å­—æ¯é¡ºåº
```

### 7.2 å†…æ ¸ç‰ˆæœ¬è‡ªåŠ¨æ£€æµ‹


**ğŸ” å†…æ ¸æ‰«ææœºåˆ¶**
```bash
#!/bin/bash
# æ¨¡æ‹Ÿ /etc/grub.d/10_linux çš„å·¥ä½œæ–¹å¼

# æ‰«ææ‰€æœ‰å†…æ ¸æ–‡ä»¶
for kernel in /boot/vmlinuz-*; do
    if [ ! -e "$kernel" ]; then
        continue
    fi
    
    # æå–ç‰ˆæœ¬å·
    version=$(echo "$kernel" | sed 's/.*vmlinuz-//')
    echo "Found kernel: $version"
    
    # æŸ¥æ‰¾å¯¹åº”çš„initrd
    initrd="/boot/initrd.img-${version}"
    if [ ! -e "$initrd" ]; then
        initrd="/boot/initramfs-${version}.img"
    fi
    
    # ç”Ÿæˆèœå•é¡¹
    cat << EOF
menuentry 'Ubuntu, with Linux $version' {
    recordfail
    load_video
    gfxmode \$linux_gfx_mode
    insmod gzio
    if [ x\$grub_platform = xxen ]; then insmod xzio; insmod lzopio; fi
    insmod part_gpt
    insmod ext2
    linux $kernel root=UUID=\$root_uuid ro quiet splash
    initrd $initrd
}
EOF

    # ç”Ÿæˆæ¢å¤æ¨¡å¼èœå•é¡¹
    cat << EOF  
menuentry 'Ubuntu, with Linux $version (recovery mode)' {
    recordfail
    load_video
    insmod gzio
    linux $kernel root=UUID=\$root_uuid ro recovery nomodeset
    initrd $initrd
}
EOF

done
```

### 7.3 æ™ºèƒ½ç³»ç»Ÿæ£€æµ‹è„šæœ¬


**ğŸ–¥ï¸ å¢å¼ºçš„os-proberåŠŸèƒ½**
```bash
#!/bin/bash
# /etc/grub.d/35_smart_os_prober

# æ›´æ™ºèƒ½çš„æ“ä½œç³»ç»Ÿæ£€æµ‹
detect_windows() {
    local device="$1"
    local mount_point="/tmp/grub_mount_$$"
    
    mkdir -p "$mount_point"
    if mount "$device" "$mount_point" 2>/dev/null; then
        
        # æ£€æµ‹Windowsç‰ˆæœ¬
        if [ -f "$mount_point/Windows/System32/kernel32.dll" ]; then
            local version="Unknown"
            
            # Windows 10/11æ£€æµ‹
            if [ -f "$mount_point/Windows/System32/ntoskrnl.exe" ]; then
                version_info=$(strings "$mount_point/Windows/System32/ntoskrnl.exe" | grep -i "windows" | head -1)
                case "$version_info" in
                    *"10.0"*) version="Windows 10/11" ;;
                    *"6.3"*) version="Windows 8.1" ;;
                    *"6.1"*) version="Windows 7" ;;
                esac
            fi
            
            echo "Found $version on $device"
            
            # ç”ŸæˆWindowså¯åŠ¨é¡¹
            cat << EOF
menuentry '$version (on $device)' {
    insmod part_msdos
    insmod ntfs
    set root='$device'
    if [ x\$feature_platform_search_hint = xy ]; then
        search --no-floppy --fs-uuid --set=root $device
    fi
    chainloader +1
}
EOF
        fi
        
        umount "$mount_point"
    fi
    rmdir "$mount_point"
}

# æ‰«ææ‰€æœ‰ç£ç›˜åˆ†åŒº
for disk in /dev/sd? /dev/nvme?n?; do
    [ -e "$disk" ] || continue
    
    # æ£€æŸ¥åˆ†åŒºè¡¨
    for partition in ${disk}[0-9]* ${disk}p[0-9]*; do
        [ -e "$partition" ] || continue
        
        echo "Scanning $partition..." >&2
        detect_windows "$partition"
    done
done
```

### 7.4 æ¡ä»¶èœå•ç”Ÿæˆ


**ğŸ›ï¸ åŸºäºæ¡ä»¶çš„èœå•é¡¹**
```bash
#!/bin/bash
# /etc/grub.d/45_conditional_entries

# æ ¹æ®ç³»ç»ŸçŠ¶æ€ç”Ÿæˆä¸åŒèœå•

cat << 'EOF'
# æ£€æµ‹ç³»ç»ŸçŠ¶æ€å¹¶ç”Ÿæˆç›¸åº”èœå•

# æ£€æµ‹æ˜¯å¦åœ¨è™šæ‹Ÿæœºä¸­è¿è¡Œ
function detect_virtualization {
    # æ£€æµ‹å¸¸è§è™šæ‹ŸåŒ–å¹³å°
    if [ -e /dev/disk/by-id/ata-VBOX_HARDDISK* ]; then
        return "virtualbox"
    elif [ -e /sys/class/dmi/id/product_name ]; then
        local product_name
        read product_name < /sys/class/dmi/id/product_name
        case "$product_name" in
            *"VMware"*) return "vmware" ;;
            *"VirtualBox"*) return "virtualbox" ;;
            *"QEMU"*) return "qemu" ;;
            *) return "physical" ;;
        esac
    fi
    return "physical"
}

# æ ¹æ®ç¯å¢ƒç”Ÿæˆèœå•
virt_type=$(detect_virtualization)

case "$virt_type" in
    "virtualbox")
        echo "VirtualBox environment detected"
        
        menuentry 'Install VirtualBox Guest Additions' {
            linux /vmlinuz root=/dev/sda1 init=/usr/share/virtualbox/autorun.sh
            initrd /initrd.img
        }
        ;;
        
    "vmware")
        echo "VMware environment detected"
        
        menuentry 'Install VMware Tools' {
            linux /vmlinuz root=/dev/sda1 vmware-tools-install
            initrd /initrd.img
        }
        ;;
        
    "physical")
        echo "Physical machine detected"
        
        # ç‰©ç†æœºç‰¹æœ‰çš„èœå•é¡¹
        if [ -e /sys/firmware/efi ]; then
            menuentry 'UEFI Firmware Settings' {
                fwsetup
            }
        fi
        ;;
esac

EOF
```

---

## 8. ğŸŒ ç½‘ç»œå¯åŠ¨é…ç½®


### 8.1 PXEç½‘ç»œå¯åŠ¨åŸç†


**ğŸ”¸ PXEå¯åŠ¨æµç¨‹**
```
PXEå¯åŠ¨è¿‡ç¨‹ï¼š
å®¢æˆ·ç«¯å¼€æœº â†’ DHCPè¯·æ±‚ â†’ è·å–IPå’Œå¼•å¯¼æ–‡ä»¶ä¿¡æ¯ â†’ TFTPä¸‹è½½å¼•å¯¼ç¨‹åº â†’ æ‰§è¡Œç½‘ç»œå¯åŠ¨

ç½‘ç»œå¯åŠ¨æ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®¢æˆ·ç«¯æœºå™¨  â”‚    â”‚ DHCPæœåŠ¡å™¨  â”‚    â”‚ TFTPæœåŠ¡å™¨  â”‚
â”‚             â”‚â”€â”€â”€â”€â”‚             â”‚â”€â”€â”€â”€â”‚             â”‚
â”‚ è¯·æ±‚å¯åŠ¨ä¿¡æ¯ â”‚    â”‚è¿”å›IPå’Œæ–‡ä»¶è·¯å¾„â”‚    â”‚ æä¾›å¯åŠ¨æ–‡ä»¶ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦ç½‘ç»œå¯åŠ¨**
```
åº”ç”¨åœºæ™¯ï¼š
â€¢ æ‰¹é‡ç³»ç»Ÿå®‰è£…ï¼šä¼ä¸šç¯å¢ƒå¤§é‡æœºå™¨éƒ¨ç½²
â€¢ æ— ç£ç›˜å·¥ä½œç«™ï¼šç˜¦å®¢æˆ·ç«¯ï¼Œæ‰€æœ‰æ•°æ®åœ¨æœåŠ¡å™¨
â€¢ ç³»ç»Ÿç»´æŠ¤ï¼šè¿œç¨‹è¯Šæ–­å’Œä¿®å¤
â€¢ è‡ªåŠ¨åŒ–è¿ç»´ï¼šæ— äººå€¼å®ˆçš„ç³»ç»Ÿç®¡ç†
```

### 8.2 GRUB2ç½‘ç»œæ¨¡å—é…ç½®


**ğŸ”§ å¯ç”¨ç½‘ç»œæ”¯æŒæ¨¡å—**
```bash
# é‡æ–°ç¼–è¯‘GRUB2ä»¥åŒ…å«ç½‘ç»œæ¨¡å—
sudo grub-install --modules="biosdisk part_msdos fat ext2 normal boot linux configfile net tftp http" /dev/sda

# æˆ–è€…åœ¨è¿è¡Œæ—¶åŠ è½½æ¨¡å—
cat << 'EOF' >> /etc/grub.d/40_custom
# åœ¨GRUBèœå•ä¸­åŠ è½½ç½‘ç»œæ¨¡å—
insmod net
insmod efinet  # UEFIç½‘ç»œæ”¯æŒ
insmod tftp
insmod http
EOF
```

**âš™ï¸ ç½‘ç»œæ¥å£é…ç½®**
```bash
cat << 'EOF'
# GRUB2ç½‘ç»œé…ç½®

# é…ç½®ç½‘ç»œæ¥å£
net_add_addr efinet0 192.168.1.100/24 192.168.1.1

# æˆ–ä½¿ç”¨DHCPè‡ªåŠ¨é…ç½®
net_dhcp efinet0

# è®¾ç½®DNSï¼ˆå¦‚æœéœ€è¦ï¼‰
net_add_dns 8.8.8.8

# æµ‹è¯•ç½‘ç»œè¿é€šæ€§
if net_ping 192.168.1.1; then
    echo "Network is ready"
else
    echo "Network configuration failed"
fi
EOF
```

### 8.3 ç½‘ç»œå¯åŠ¨èœå•é¡¹


**ğŸŒ HTTP/TFTPå¯åŠ¨é…ç½®**
```bash
#!/bin/bash
# ç½‘ç»œå¯åŠ¨èœå•ç”Ÿæˆè„šæœ¬

cat << 'EOF'
# ç½‘ç»œå¯åŠ¨èœå•é¡¹

menuentry 'Ubuntu Network Install (HTTP)' {
    insmod net
    insmod efinet
    insmod http
    
    # é…ç½®ç½‘ç»œ
    net_dhcp efinet0
    
    # ä»HTTPæœåŠ¡å™¨å¯åŠ¨
    set root=(http,192.168.1.200)
    linux /ubuntu-installer/vmlinuz ip=dhcp url=http://192.168.1.200/ubuntu/
    initrd /ubuntu-installer/initrd.gz
}

menuentry 'CentOS Network Install (TFTP)' {
    insmod net
    insmod efinet  
    insmod tftp
    
    # é…ç½®ç½‘ç»œ
    net_dhcp efinet0
    
    # ä»TFTPæœåŠ¡å™¨å¯åŠ¨
    set root=(tftp,192.168.1.200)
    linux (tftp)/centos/vmlinuz ip=dhcp ks=http://192.168.1.200/kickstart.cfg
    initrd (tftp)/centos/initrd.img
}

menuentry 'Network Boot Menu' {
    insmod net
    insmod efinet
    insmod http
    
    # ä¸‹è½½å¹¶æ‰§è¡Œè¿œç¨‹GRUBé…ç½®
    net_dhcp efinet0
    configfile (http,192.168.1.200)/grub/network-menu.cfg
}

menuentry 'Diskless Workstation' {
    insmod net
    insmod efinet
    insmod http
    
    net_dhcp efinet0
    
    # å®Œå…¨ä»ç½‘ç»œå¯åŠ¨çš„ç³»ç»Ÿ
    linux (http,192.168.1.200)/diskless/vmlinuz root=/dev/nfs nfsroot=192.168.1.200:/diskless/rootfs ip=dhcp
    initrd (http,192.168.1.200)/diskless/initrd.img
}
EOF
```

### 8.4 ç½‘ç»œå¯åŠ¨æœåŠ¡å™¨é…ç½®


**ğŸ–¥ï¸ æœåŠ¡å™¨ç«¯é…ç½®ç¤ºä¾‹**

**DHCPæœåŠ¡å™¨é…ç½®**
```bash
# /etc/dhcp/dhcpd.conf
subnet 192.168.1.0 netmask 255.255.255.0 {
    range 192.168.1.100 192.168.1.200;
    option routers 192.168.1.1;
    option domain-name-servers 8.8.8.8;
    
    # PXEå¯åŠ¨é…ç½®
    option bootfile-name "grub/grubnetx64.efi";  # UEFI
    option tftp-server-name "192.168.1.200";
    next-server 192.168.1.200;
}

# é’ˆå¯¹ç‰¹å®šMACåœ°å€çš„é…ç½®
host client1 {
    hardware ethernet 00:11:22:33:44:55;
    fixed-address 192.168.1.150;
    option bootfile-name "grub/grubnet.pxe";     # BIOS
}
```

**HTTPæœåŠ¡å™¨é…ç½®**
```bash
# Apache2é…ç½®ç¤ºä¾‹
# /etc/apache2/sites-available/netboot.conf

<VirtualHost *:80>
    DocumentRoot /var/www/netboot
    
    <Directory "/var/www/netboot">
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted
    </Directory>
    
    # å…è®¸å¤§æ–‡ä»¶ä¼ è¾“
    LimitRequestBody 0
</VirtualHost>

# ç›®å½•ç»“æ„
/var/www/netboot/
â”œâ”€â”€ ubuntu/
â”‚   â”œâ”€â”€ vmlinuz
â”‚   â”œâ”€â”€ initrd.gz
â”‚   â””â”€â”€ preseed.cfg
â”œâ”€â”€ centos/
â”‚   â”œâ”€â”€ vmlinuz
â”‚   â”œâ”€â”€ initrd.img
â”‚   â””â”€â”€ kickstart.cfg
â””â”€â”€ grub/
    â”œâ”€â”€ grub.cfg
    â””â”€â”€ grubnetx64.efi
```

---

## 9. ğŸ”§ è‡ªå®šä¹‰æ¨¡å—å¼€å‘


### 9.1 GRUB2æ¨¡å—ç³»ç»Ÿæ¶æ„


**ğŸ”¸ æ¨¡å—ç³»ç»Ÿæ¦‚å¿µ**
```
GRUB2æ¨¡å—ï¼šæ‰©å±•GRUB2åŠŸèƒ½çš„ä»£ç ç»„ä»¶
æ¨¡å—ç±»å‹ï¼š
â€¢ æ–‡ä»¶ç³»ç»Ÿæ¨¡å—ï¼šæ”¯æŒæ–°çš„æ–‡ä»¶ç³»ç»Ÿæ ¼å¼
â€¢ ç½‘ç»œæ¨¡å—ï¼šç½‘ç»œåè®®å’Œé©±åŠ¨æ”¯æŒ
â€¢ è§†é¢‘æ¨¡å—ï¼šæ˜¾ç¤ºå’Œå›¾å½¢åŠŸèƒ½
â€¢ å‘½ä»¤æ¨¡å—ï¼šæ–°çš„GRUB2å‘½ä»¤
â€¢ åŠ è½½å™¨æ¨¡å—ï¼šæ“ä½œç³»ç»Ÿå¼•å¯¼æ”¯æŒ
```

**ğŸ“ æ¨¡å—å­˜æ”¾ä½ç½®**
```bash
# æ¨¡å—æ–‡ä»¶ä½ç½®
/boot/grub/i386-pc/          # BIOSæ¨¡å—
/boot/grub/x86_64-efi/       # UEFI 64ä½æ¨¡å—
/boot/grub/i386-efi/         # UEFI 32ä½æ¨¡å—

# æ¨¡å—æ–‡ä»¶æ ¼å¼
*.mod    - æ¨¡å—æ–‡ä»¶
*.lst    - æ¨¡å—åˆ—è¡¨
*.img    - æ ¸å¿ƒæ˜ åƒæ–‡ä»¶

# æŸ¥çœ‹å·²å®‰è£…æ¨¡å—
ls /boot/grub/x86_64-efi/*.mod | head -10
```

### 9.2 ç®€å•å‘½ä»¤æ¨¡å—å¼€å‘


**ğŸ’» Hello Worldå‘½ä»¤æ¨¡å—**
```c
/* hello.c - ç®€å•çš„GRUB2å‘½ä»¤æ¨¡å— */
#include <grub/dl.h>
#include <grub/command.h>
#include <grub/misc.h>

GRUB_MOD_LICENSE ("GPLv3+");

/* å‘½ä»¤å®ç°å‡½æ•° */
static grub_err_t
grub_cmd_hello (grub_command_t cmd __attribute__ ((unused)),
               int argc, char **argv)
{
    if (argc == 0)
        grub_printf ("Hello, GRUB2 World!\n");
    else
        grub_printf ("Hello, %s!\n", argv[0]);
    
    return GRUB_ERR_NONE;
}

static grub_command_t cmd_hello;

/* æ¨¡å—åˆå§‹åŒ– */
GRUB_MOD_INIT(hello)
{
    cmd_hello = grub_register_command ("hello", grub_cmd_hello,
                                     "[NAME]",
                                     "Say hello to NAME or world.");
}

/* æ¨¡å—å¸è½½ */
GRUB_MOD_FINI(hello)
{
    grub_unregister_command (cmd_hello);
}
```

**ğŸ”¨ ç¼–è¯‘å’Œå®‰è£…**
```bash
# 1. å‡†å¤‡ç¼–è¯‘ç¯å¢ƒ
sudo apt-get install build-essential autoconf automake

# 2. è·å–GRUB2æºç 
wget https://ftp.gnu.org/gnu/grub/grub-2.06.tar.xz
tar xf grub-2.06.tar.xz
cd grub-2.06

# 3. é…ç½®ç¼–è¯‘é€‰é¡¹
./configure --target=x86_64 --with-platform=efi

# 4. å°†æ¨¡å—æºç æ”¾å…¥æ­£ç¡®ä½ç½®
cp hello.c grub-core/commands/

# 5. ä¿®æ”¹Makefile
echo "hello_mod_SOURCES = commands/hello.c" >> grub-core/Makefile.core.def

# 6. ç¼–è¯‘æ¨¡å—
make

# 7. å®‰è£…æ¨¡å—
sudo cp grub-core/hello.mod /boot/grub/x86_64-efi/
```

### 9.3 ç³»ç»Ÿä¿¡æ¯æ˜¾ç¤ºæ¨¡å—


**ğŸ“Š ç³»ç»Ÿä¿¡æ¯æ¨¡å—ç¤ºä¾‹**
```c
/* sysinfo.c - ç³»ç»Ÿä¿¡æ¯æ˜¾ç¤ºæ¨¡å— */
#include <grub/dl.h>
#include <grub/command.h>
#include <grub/misc.h>
#include <grub/mm.h>
#include <grub/env.h>
#include <grub/cpu/cpuid.h>

GRUB_MOD_LICENSE ("GPLv3+");

static grub_err_t
grub_cmd_sysinfo (grub_command_t cmd __attribute__ ((unused)),
                 int argc __attribute__ ((unused)),
                 char **argv __attribute__ ((unused)))
{
    grub_uint32_t eax, ebx, ecx, edx;
    
    grub_printf ("=== System Information ===\n");
    
    /* CPUä¿¡æ¯ */
    if (grub_cpu_is_cpuid_supported ()) {
        grub_cpuid (0, eax, ebx, ecx, edx);
        grub_printf ("CPU Vendor: ");
        grub_printf ("%c%c%c%c", 
                    (ebx >> 0) & 0xff, (ebx >> 8) & 0xff,
                    (ebx >> 16) & 0xff, (ebx >> 24) & 0xff);
        grub_printf ("%c%c%c%c",
                    (edx >> 0) & 0xff, (edx >> 8) & 0xff, 
                    (edx >> 16) & 0xff, (edx >> 24) & 0xff);
        grub_printf ("%c%c%c%c\n",
                    (ecx >> 0) & 0xff, (ecx >> 8) & 0xff,
                    (ecx >> 16) & 0xff, (ecx >> 24) & 0xff);
    }
    
    /* å†…å­˜ä¿¡æ¯ */
    grub_uint64_t total_mem = grub_get_total_mem ();
    grub_printf ("Total Memory: %llu KB\n", 
                (unsigned long long) total_mem / 1024);
    
    /* å¹³å°ä¿¡æ¯ */
    grub_printf ("Platform: %s\n", GRUB_PLATFORM);
    grub_printf ("Target: %s\n", GRUB_TARGET_CPU "-" GRUB_PLATFORM);
    
    /* ç¯å¢ƒå˜é‡ç¤ºä¾‹ */
    const char *root = grub_env_get ("root");
    if (root)
        grub_printf ("Current root: %s\n", root);
    
    return GRUB_ERR_NONE;
}

static grub_command_t cmd_sysinfo;

GRUB_MOD_INIT(sysinfo)
{
    cmd_sysinfo = grub_register_command ("sysinfo", grub_cmd_sysinfo,
                                        "",
                                        "Display system information.");
}

GRUB_MOD_FINI(sysinfo)
{
    grub_unregister_command (cmd_sysinfo);
}
```

### 9.4 æ¨¡å—æµ‹è¯•å’Œè°ƒè¯•


**ğŸ§ª æ¨¡å—æµ‹è¯•æ–¹æ³•**
```bash
# 1. åœ¨GRUBå‘½ä»¤è¡Œä¸­æµ‹è¯•
# é‡å¯è¿›å…¥GRUBèœå•ï¼ŒæŒ‰'c'è¿›å…¥å‘½ä»¤è¡Œ

# åŠ è½½æ¨¡å—
insmod hello

# æµ‹è¯•å‘½ä»¤
hello
hello GRUB2

# æŸ¥çœ‹æ¨¡å—æ˜¯å¦æ­£ç¡®åŠ è½½
lsmod

# 2. åˆ›å»ºæµ‹è¯•è„šæœ¬
cat << 'EOF' > /etc/grub.d/99_test_modules
#!/bin/bash

cat << 'GRUB_EOF'
# æµ‹è¯•è‡ªå®šä¹‰æ¨¡å—
menuentry 'Test Custom Modules' {
    insmod hello
    insmod sysinfo
    
    hello "Custom Module"
    echo "Press any key to see system info..."
    read
    sysinfo
    echo "Press any key to continue..."
    read
}
GRUB_EOF
EOF

chmod +x /etc/grub.d/99_test_modules
sudo update-grub
```

**ğŸ” è°ƒè¯•æŠ€å·§**
```bash
# å¯ç”¨GRUB2è°ƒè¯•æ¨¡å¼
set debug=all

# æŸ¥çœ‹æ¨¡å—åŠ è½½ä¿¡æ¯
set pager=1  # å¯ç”¨åˆ†é¡µæ˜¾ç¤º
lsmod        # åˆ—å‡ºæ‰€æœ‰æ¨¡å—

# æ£€æŸ¥å‘½ä»¤æ˜¯å¦æ³¨å†Œ
help         # æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤
help hello   # æŸ¥çœ‹ç‰¹å®šå‘½ä»¤å¸®åŠ©

# é”™è¯¯å¤„ç†
if ! insmod hello; then
    echo "Failed to load hello module"
fi
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ GRUB2é«˜çº§åŠŸèƒ½æœ¬è´¨ï¼šé€šè¿‡é…ç½®å’Œè„šæœ¬å®ç°å¯åŠ¨è¿‡ç¨‹çš„æ·±åº¦å®šåˆ¶
ğŸ”¸ é…ç½®æ–‡ä»¶ä½“ç³»ï¼š/etc/default/grubï¼ˆç”¨æˆ·é…ç½®ï¼‰+ /etc/grub.d/ï¼ˆç”Ÿæˆè„šæœ¬ï¼‰
ğŸ”¸ ä¸»é¢˜å®šåˆ¶ï¼šèƒŒæ™¯å›¾ç‰‡ + å­—ä½“ + é¢œè‰² + å¸ƒå±€çš„ç»¼åˆé…ç½®
ğŸ”¸ è„šæœ¬ç¼–ç¨‹ï¼šç±»bashè¯­æ³•çš„æ¡ä»¶åˆ¤æ–­å’ŒåŠ¨æ€é…ç½®ç”Ÿæˆ
ğŸ”¸ ç¯å¢ƒå˜é‡ï¼šæŒä¹…åŒ–å­˜å‚¨çš„é…ç½®çŠ¶æ€ç®¡ç†æœºåˆ¶
ğŸ”¸ åŠ¨æ€ç”Ÿæˆï¼šæ ¹æ®ç³»ç»Ÿå®é™…æƒ…å†µè‡ªåŠ¨åˆ›å»ºèœå•é¡¹
ğŸ”¸ ç½‘ç»œå¯åŠ¨ï¼šé€šè¿‡PXE/HTTP/TFTPå®ç°æ— ç£ç›˜å¯åŠ¨
ğŸ”¸ æ¨¡å—å¼€å‘ï¼šCè¯­è¨€ç¼–å†™çš„åŠŸèƒ½æ‰©å±•ç»„ä»¶
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ é…ç½®æ–‡ä»¶çš„å±‚æ¬¡å…³ç³»**
```
ç†è§£è¦ç‚¹ï¼š
â€¢ /etc/default/grubï¼šç”¨æˆ·ä¸»é…ç½®ï¼Œç®€å•ç›´è§‚
â€¢ /etc/grub.d/*ï¼šè„šæœ¬ç”Ÿæˆå™¨ï¼Œè´Ÿè´£å¤æ‚é€»è¾‘
â€¢ /boot/grub/grub.cfgï¼šæœ€ç»ˆé…ç½®ï¼Œè‡ªåŠ¨ç”Ÿæˆ
â€¢ /boot/grub/grubenvï¼šç¯å¢ƒå˜é‡ï¼ŒçŠ¶æ€ä¿å­˜

è®°å¿†æ–¹æ³•ï¼š
é…ç½® â†’ è„šæœ¬ â†’ ç”Ÿæˆ â†’ å­˜å‚¨
ç®€å• â†’ å¤æ‚ â†’ ç»“æœ â†’ çŠ¶æ€
```

**ğŸ”¹ ä¸»é¢˜å®šåˆ¶çš„å®é™…ä»·å€¼**
```
ä¸ä»…ä»…æ˜¯ç¾è§‚ï¼š
â€¢ ä¼ä¸šå½¢è±¡ï¼šç»Ÿä¸€çš„å¯åŠ¨ç•Œé¢å±•ç¤ºä¸“ä¸šæ€§
â€¢ ç”¨æˆ·ä½“éªŒï¼šæ¸…æ™°çš„è§†è§‰æŒ‡å¯¼é™ä½æ“ä½œéš¾åº¦
â€¢ åŠŸèƒ½æç¤ºï¼šé€šè¿‡é¢œè‰²å’Œå›¾æ ‡ä¼ è¾¾çŠ¶æ€ä¿¡æ¯
â€¢ å“ç‰Œè¯†åˆ«ï¼šè‡ªå®šä¹‰å¤–è§‚å»ºç«‹ç‹¬ç‰¹æ ‡è¯†
```

**ğŸ”¹ è„šæœ¬ç¼–ç¨‹çš„åº”ç”¨åœºæ™¯**
```
å®é™…åº”ç”¨ï¼š
â€¢ ç¡¬ä»¶é€‚é…ï¼šæ ¹æ®ç¡¬ä»¶é…ç½®è‡ªåŠ¨é€‰æ‹©å†…æ ¸å‚æ•°
â€¢ æ•…éšœæ¢å¤ï¼šæ£€æµ‹å¯åŠ¨å¤±è´¥å¹¶æä¾›æ¢å¤é€‰é¡¹
â€¢ ç¯å¢ƒæ„ŸçŸ¥ï¼šè¯†åˆ«è™šæ‹ŸåŒ–ç¯å¢ƒå¹¶æä¾›ç›¸åº”åŠŸèƒ½
â€¢ ç”¨æˆ·åå¥½ï¼šè®°å¿†ç”¨æˆ·é€‰æ‹©å¹¶æ™ºèƒ½æ¨è
```

### 10.3 å®é™…åº”ç”¨æŒ‡å—


**ğŸ¯ ä¼ä¸šç¯å¢ƒéƒ¨ç½²å»ºè®®**
```
ä¸»é¢˜ç»Ÿä¸€ï¼š
âœ… ä½¿ç”¨ä¼ä¸šLogoä½œä¸ºèƒŒæ™¯
âœ… ç»Ÿä¸€çš„é¢œè‰²æ–¹æ¡ˆ
âœ… æ ‡å‡†åŒ–çš„å­—ä½“é€‰æ‹©
âœ… æ¸…æ™°çš„èœå•ç»“æ„

è‡ªåŠ¨åŒ–é…ç½®ï¼š
âœ… æ‰¹é‡éƒ¨ç½²è„šæœ¬
âœ… é…ç½®æ¨¡æ¿ç®¡ç†
âœ… è¿œç¨‹æ›´æ–°æœºåˆ¶
âœ… æ•…éšœè‡ªåŠ¨æ¢å¤
```

**ğŸ  ä¸ªäººç”¨æˆ·ä¼˜åŒ–å»ºè®®**
```
ä¸ªæ€§åŒ–å®šåˆ¶ï¼š
â€¢ é€‰æ‹©å–œæ¬¢çš„èƒŒæ™¯å›¾ç‰‡å’Œä¸»é¢˜
â€¢ è®¾ç½®åˆé€‚çš„è¶…æ—¶æ—¶é—´
â€¢ é…ç½®é»˜è®¤å¯åŠ¨é¡¹
â€¢ å¯ç”¨å¯åŠ¨çŠ¶æ€è·Ÿè¸ª

æ€§èƒ½ä¼˜åŒ–ï¼š
â€¢ å‡å°‘ä¸å¿…è¦çš„æ¨¡å—åŠ è½½
â€¢ ä¼˜åŒ–å›¾ç‰‡å¤§å°å’Œæ ¼å¼
â€¢ ç²¾ç®€èœå•é¡¹æ•°é‡
â€¢ å¯ç”¨å¿«é€Ÿå¯åŠ¨æ¨¡å¼
```

**ğŸ”§ æ•…éšœæ’æŸ¥æŒ‡å—**
```
å¸¸è§é—®é¢˜è§£å†³ï¼š
1. é…ç½®ä¸ç”Ÿæ•ˆï¼šæ£€æŸ¥æ˜¯å¦æ‰§è¡Œäº†update-grub
2. ä¸»é¢˜ä¸æ˜¾ç¤ºï¼šéªŒè¯æ–‡ä»¶è·¯å¾„å’Œæ ¼å¼
3. è„šæœ¬é”™è¯¯ï¼šæ£€æŸ¥è¯­æ³•å’Œæƒé™è®¾ç½®
4. æ¨¡å—åŠ è½½å¤±è´¥ï¼šç¡®è®¤æ¨¡å—å…¼å®¹æ€§

è°ƒè¯•æ–¹æ³•ï¼š
â€¢ ä½¿ç”¨GRUBå‘½ä»¤è¡Œæµ‹è¯•
â€¢ æŸ¥çœ‹ç”Ÿæˆçš„grub.cfgæ–‡ä»¶
â€¢ å¯ç”¨è°ƒè¯•æ¨¡å¼è·å–è¯¦ç»†ä¿¡æ¯
â€¢ é€æ­¥æµ‹è¯•å„ä¸ªç»„ä»¶åŠŸèƒ½
```

### 10.4 å­¦ä¹ è¿›é˜¶è·¯å¾„


```
ğŸ¯ å­¦ä¹ å±‚æ¬¡ï¼š
åˆçº§ï¼šæŒæ¡åŸºæœ¬é…ç½®å’Œä¸»é¢˜å®šåˆ¶
ä¸­çº§ï¼šç¼–å†™ç®€å•è„šæœ¬å’Œæ¡ä»¶å¯åŠ¨
é«˜çº§ï¼šå¼€å‘è‡ªå®šä¹‰æ¨¡å—å’Œç½‘ç»œå¯åŠ¨
ä¸“å®¶ï¼šæ·±å…¥GRUB2æºç å’Œç³»ç»Ÿé›†æˆ

ğŸ“š æ¨èå®è·µé¡¹ç›®ï¼š
1. åˆ›å»ºä¸ªäººä¸“å±å¯åŠ¨ä¸»é¢˜
2. å®ç°å¤šç³»ç»Ÿæ™ºèƒ½æ£€æµ‹è„šæœ¬  
3. é…ç½®PXEç½‘ç»œå¯åŠ¨ç¯å¢ƒ
4. å¼€å‘ç³»ç»Ÿç›‘æ§å‘½ä»¤æ¨¡å—

ğŸ”— ç›¸å…³æŠ€æœ¯æ‰©å±•ï¼š
â€¢ ç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹æ·±å…¥ç†è§£
â€¢ Linuxå†…æ ¸å‚æ•°è°ƒä¼˜
â€¢ è‡ªåŠ¨åŒ–è¿ç»´å·¥å…·é›†æˆ
â€¢ è™šæ‹ŸåŒ–ç¯å¢ƒå®šåˆ¶ä¼˜åŒ–
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- é…ç½®åˆ†å±‚çº§ï¼Œè„šæœ¬æ¥ç”Ÿæˆ
- ä¸»é¢˜é‡å¤–è§‚ï¼ŒåŠŸèƒ½åœ¨å†…æ ¸  
- ç¯å¢ƒå˜é‡å­˜çŠ¶æ€ï¼ŒåŠ¨æ€ç”Ÿæˆæ˜¾æ™ºèƒ½
- ç½‘ç»œå¯åŠ¨æ‰¹é‡åŒ–ï¼Œæ¨¡å—å¼€å‘åŠŸèƒ½æ‰©
- ç†è®ºå®è·µç›¸ç»“åˆï¼Œæ•…éšœæ’æŸ¥æœ‰æ–¹æ³•