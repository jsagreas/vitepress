---
title: 9ã€å¯åŠ¨æ•…éšœè¯Šæ–­æ–¹æ³•
---
## ðŸ“š ç›®å½•

1. [å¯åŠ¨æ•…éšœè¯Šæ–­æ¦‚è¿°](#1-å¯åŠ¨æ•…éšœè¯Šæ–­æ¦‚è¿°)
2. [å†…æ ¸panicåˆ†æž](#2-å†…æ ¸panicåˆ†æž)
3. [initramfsæ•…éšœæŽ’æŸ¥](#3-initramfsæ•…éšœæŽ’æŸ¥)
4. [æœåŠ¡å¯åŠ¨å¤±è´¥è¯Šæ–­](#4-æœåŠ¡å¯åŠ¨å¤±è´¥è¯Šæ–­)
5. [ä¾èµ–å…³ç³»é—®é¢˜æŽ’æŸ¥](#5-ä¾èµ–å…³ç³»é—®é¢˜æŽ’æŸ¥)
6. [è¶…æ—¶é—®é¢˜è§£å†³](#6-è¶…æ—¶é—®é¢˜è§£å†³)
7. [å¯åŠ¨æ—¥å¿—åˆ†æžæŠ€å·§](#7-å¯åŠ¨æ—¥å¿—åˆ†æžæŠ€å·§)
8. [å•ç”¨æˆ·æ¨¡å¼æ¢å¤](#8-å•ç”¨æˆ·æ¨¡å¼æ¢å¤)
9. [å¯åŠ¨å‚æ•°è°ƒè¯•](#9-å¯åŠ¨å‚æ•°è°ƒè¯•)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ðŸš¨ å¯åŠ¨æ•…éšœè¯Šæ–­æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯å¯åŠ¨æ•…éšœ


**ç®€å•ç†è§£**ï¼šå¯åŠ¨æ•…éšœå°±æ˜¯Linuxç³»ç»Ÿå¼€æœºæ—¶å‡ºçŽ°é—®é¢˜ï¼Œæ— æ³•æ­£å¸¸è¿›å…¥å¯ç”¨çŠ¶æ€ã€‚

```
æ­£å¸¸å¯åŠ¨æµç¨‹ï¼š
å¼€æœº â†’ å¼•å¯¼åŠ è½½ â†’ å†…æ ¸å¯åŠ¨ â†’ åˆå§‹åŒ– â†’ ç™»å½•ç•Œé¢

æ•…éšœå¯èƒ½å‘ç”Ÿåœ¨ä»»ä½•çŽ¯èŠ‚ï¼
```

### 1.2 å¸¸è§æ•…éšœç±»åž‹åˆ†ç±»


**ðŸ”¸ ç¡¬ä»¶ç›¸å…³æ•…éšœ**
```
- ç¡¬ç›˜æŸåï¼šç³»ç»Ÿæ–‡ä»¶è¯»å–å¤±è´¥
- å†…å­˜é—®é¢˜ï¼šå†…æ ¸åŠ è½½å¼‚å¸¸
- ç”µæºä¸ç¨³ï¼šå¯åŠ¨è¿‡ç¨‹ä¸­æ–­
```

**ðŸ”¸ è½¯ä»¶é…ç½®æ•…éšœ**
```
- å†…æ ¸æ–‡ä»¶æŸåï¼šæ— æ³•åŠ è½½å†…æ ¸
- é…ç½®æ–‡ä»¶é”™è¯¯ï¼šæœåŠ¡å¯åŠ¨å¤±è´¥
- ä¾èµ–å…³ç³»ç ´åï¼šæœåŠ¡æ— æ³•æ‰¾åˆ°ä¾èµ–
- æ–‡ä»¶æƒé™é—®é¢˜ï¼šå…³é”®æ–‡ä»¶æ— æ³•æ‰§è¡Œ
```

### 1.3 æ•…éšœè¯Šæ–­åŸºæœ¬æ€è·¯


```
æ•…éšœè¯Šæ–­æµç¨‹ï¼š
    è§‚å¯Ÿç—‡çŠ¶
        â†“
    ç¡®å®šæ•…éšœé˜¶æ®µ
        â†“
    æŸ¥çœ‹ç›¸å…³æ—¥å¿—
        â†“
    åˆ†æžå…·ä½“åŽŸå› 
        â†“
    åˆ¶å®šè§£å†³æ–¹æ¡ˆ
        â†“
    éªŒè¯ä¿®å¤æ•ˆæžœ
```

> ðŸ’¡ **è¯Šæ–­åŽŸåˆ™**ï¼šå…ˆç¡®å®šæ•…éšœå‘ç”Ÿåœ¨å¯åŠ¨çš„å“ªä¸ªé˜¶æ®µï¼Œå†é’ˆå¯¹æ€§åˆ†æž

---

## 2. ðŸ’¥ å†…æ ¸panicåˆ†æž


### 2.1 ä»€ä¹ˆæ˜¯å†…æ ¸panic


**é€šä¿—ç†è§£**ï¼šå†…æ ¸panicå°±åƒç³»ç»Ÿ"æ­»æœº"ï¼Œå†…æ ¸é‡åˆ°æ— æ³•å¤„ç†çš„ä¸¥é‡é”™è¯¯æ—¶çš„ä¿æŠ¤æœºåˆ¶ã€‚

```
å†…æ ¸panic = å†…æ ¸å´©æºƒ = ç³»ç»Ÿå®Œå…¨åœæ­¢å“åº”
```

**ðŸ”¸ å…¸åž‹è¡¨çŽ°**
- å±å¹•æ˜¾ç¤ºå¤§é‡é”™è¯¯ä¿¡æ¯
- ç³»ç»Ÿå®Œå…¨æ— å“åº”
- åªèƒ½å¼ºåˆ¶é‡å¯

### 2.2 panicä¿¡æ¯è§£è¯»


**å…¸åž‹panicä¿¡æ¯ç»“æž„**ï¼š
```
Kernel panic - not syncing: VFS: Unable to mount root fs
CPU: 0 PID: 1 Comm: swapper/0 Not tainted 5.4.0 #1
Call Trace:
 panic+0x107/0x2b8
 mount_block_root+0x2e4/0x2f4
 prepare_namespace+0x15d/0x19a
```

**ðŸ” ä¿¡æ¯åˆ†æžè¦ç‚¹**
```
ç¬¬ä¸€è¡Œï¼španicçš„ç›´æŽ¥åŽŸå› 
- "Unable to mount root fs" = æ— æ³•æŒ‚è½½æ ¹æ–‡ä»¶ç³»ç»Ÿ

CPUä¿¡æ¯ï¼šé—®é¢˜å‘ç”Ÿæ—¶çš„ç³»ç»ŸçŠ¶æ€
- CPU: 0 = åœ¨ç¬¬0å·CPUä¸Šå‘ç”Ÿ
- PID: 1 = åœ¨1å·è¿›ç¨‹ä¸­å‘ç”Ÿï¼ˆé€šå¸¸æ˜¯initè¿›ç¨‹ï¼‰

è°ƒç”¨å †æ ˆï¼šæ˜¾ç¤ºå‡½æ•°è°ƒç”¨é“¾
- ä»Žä¸‹å¾€ä¸Šçœ‹ï¼Œæ˜¾ç¤ºé—®é¢˜çš„è°ƒç”¨è·¯å¾„
```

### 2.3 å¸¸è§panicåŽŸå› åŠè§£å†³


**ðŸ“‹ æ ¹æ–‡ä»¶ç³»ç»Ÿé—®é¢˜**
```bash
# ç—‡çŠ¶ï¼šUnable to mount root fs
# åŽŸå› ï¼šæ‰¾ä¸åˆ°æˆ–æ— æ³•æŒ‚è½½æ ¹åˆ†åŒº

# è§£å†³æ­¥éª¤ï¼š
1. æ£€æŸ¥GRUBé…ç½®ä¸­çš„rootå‚æ•°
2. ç¡®è®¤ç¡¬ç›˜è®¾å¤‡æ˜¯å¦æ­£å¸¸è¯†åˆ«
3. æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿæ˜¯å¦æŸå

# ä¿®å¤ç¤ºä¾‹ï¼š
fsck /dev/sda1  # ä¿®å¤æ–‡ä»¶ç³»ç»Ÿ
```

**ðŸ“‹ å†…å­˜ä¸è¶³é—®é¢˜**
```bash
# ç—‡çŠ¶ï¼šOut of memory: Kill process
# åŽŸå› ï¼šç³»ç»Ÿå†…å­˜è€—å°½

# ä¸´æ—¶è§£å†³ï¼š
# å¯åŠ¨æ—¶æ·»åŠ å†…æ ¸å‚æ•°
mem=512M  # é™åˆ¶å†…å­˜ä½¿ç”¨
```

**ðŸ“‹ é©±åŠ¨ç¨‹åºé—®é¢˜**
```bash
# ç—‡çŠ¶ï¼šUnable to load driver
# åŽŸå› ï¼šç¡¬ä»¶é©±åŠ¨ä¸å…¼å®¹æˆ–æŸå

# è§£å†³ï¼š
# 1. ç¦ç”¨æœ‰é—®é¢˜çš„é©±åŠ¨
modprobe.blacklist=problematic_driver

# 2. ä½¿ç”¨é€šç”¨é©±åŠ¨
acpi=off  # ç¦ç”¨ACPI
```

### 2.4 panicä¿¡æ¯æ”¶é›†æŠ€å·§


```bash
# å¯ç”¨panicä¿¡æ¯ä¿å­˜
echo 1 > /proc/sys/kernel/panic_on_oops
echo 10 > /proc/sys/kernel/panic  # 10ç§’åŽè‡ªåŠ¨é‡å¯

# é€šè¿‡ä¸²å£ä¿å­˜panicä¿¡æ¯
console=ttyS0,115200  # å†…æ ¸å‚æ•°
```

---

## 3. ðŸ”§ initramfsæ•…éšœæŽ’æŸ¥


### 3.1 ä»€ä¹ˆæ˜¯initramfs


**ç®€å•è§£é‡Š**ï¼šinitramfsæ˜¯ä¸€ä¸ªä¸´æ—¶çš„æ ¹æ–‡ä»¶ç³»ç»Ÿï¼ŒåŒ…å«å¯åŠ¨å¿…éœ€çš„å·¥å…·å’Œé©±åŠ¨ã€‚

```
å¯åŠ¨è¿‡ç¨‹ä¸­çš„ä½œç”¨ï¼š
å†…æ ¸åŠ è½½ â†’ initramfsæŒ‚è½½ â†’ å‡†å¤‡çœŸæ­£æ ¹æ–‡ä»¶ç³»ç»Ÿ â†’ åˆ‡æ¢åˆ°çœŸæ ¹
```

**ðŸ”¸ ä¸ºä»€ä¹ˆéœ€è¦initramfs**
- åŒ…å«ç¡¬ç›˜é©±åŠ¨ç¨‹åº
- åŒ…å«æ–‡ä»¶ç³»ç»Ÿæ”¯æŒ
- åŒ…å«ç½‘ç»œå¯åŠ¨å·¥å…·
- æä¾›æ—©æœŸç”¨æˆ·ç©ºé—´çŽ¯å¢ƒ

### 3.2 initramfsæ•…éšœè¡¨çŽ°


**å…¸åž‹æ•…éšœç—‡çŠ¶**ï¼š
```
- å†…æ ¸åŠ è½½åŽåœæ­¢ä¸åŠ¨
- æç¤ºæ‰¾ä¸åˆ°initç¨‹åº
- æ— æ³•æŒ‚è½½æ ¹æ–‡ä»¶ç³»ç»Ÿ
- è®¾å¤‡èŠ‚ç‚¹åˆ›å»ºå¤±è´¥
```

**ðŸ” å¸¸è§é”™è¯¯ä¿¡æ¯**
```bash
# æ‰¾ä¸åˆ°initç¨‹åº
Kernel panic - not syncing: No working init found

# è®¾å¤‡ä¸å­˜åœ¨
mount: /dev/sda1 does not exist

# æ¨¡å—åŠ è½½å¤±è´¥
modprobe: can't load module xyz
```

### 3.3 initramfsè°ƒè¯•æ–¹æ³•


**ðŸ”§ è¿›å…¥è°ƒè¯•shell**
```bash
# åœ¨å†…æ ¸å‚æ•°ä¸­æ·»åŠ ï¼š
rd.break=pre-mount  # åœ¨æŒ‚è½½å‰åœæ­¢
rd.shell           # æä¾›è°ƒè¯•shell
```

**ðŸ”§ æ‰‹åŠ¨è°ƒè¯•æ­¥éª¤**
```bash
# 1. æ£€æŸ¥è®¾å¤‡æ˜¯å¦å­˜åœ¨
ls /dev/sd*
ls /dev/mapper/

# 2. æŸ¥çœ‹å¯ç”¨æ¨¡å—
lsmod
modprobe -l

# 3. æ‰‹åŠ¨åŠ è½½å¿…è¦æ¨¡å—
modprobe ahci      # SATAé©±åŠ¨
modprobe ext4      # æ–‡ä»¶ç³»ç»Ÿæ”¯æŒ

# 4. å°è¯•æ‰‹åŠ¨æŒ‚è½½
mount /dev/sda1 /sysroot
```

### 3.4 é‡å»ºinitramfs


```bash
# RHEL/CentOSç³»åˆ—
dracut --force /boot/initramfs-$(uname -r).img $(uname -r)

# Debian/Ubuntuç³»åˆ—  
update-initramfs -u -k $(uname -r)

# æŒ‡å®šåŒ…å«ç‰¹å®šæ¨¡å—
dracut --add-drivers "ahci ext4" --force
```

**ðŸ”¸ é‡å»ºæ—¶çš„æ³¨æ„äº‹é¡¹**
```
1. ç¡®ä¿åœ¨æ­£ç¡®çš„å†…æ ¸ç‰ˆæœ¬ä¸‹æ“ä½œ
2. å¤‡ä»½åŽŸæœ‰çš„initramfsæ–‡ä»¶
3. åŒ…å«æ‰€æœ‰å¿…è¦çš„é©±åŠ¨æ¨¡å—
4. æµ‹è¯•æ–°ç”Ÿæˆçš„initramfs
```

---

## 4. âš™ï¸ æœåŠ¡å¯åŠ¨å¤±è´¥è¯Šæ–­


### 4.1 systemdæœåŠ¡ç®¡ç†åŸºç¡€


**ä»€ä¹ˆæ˜¯systemdæœåŠ¡**ï¼šsystemdæ˜¯çŽ°ä»£Linuxå‘è¡Œç‰ˆçš„ç³»ç»Ÿå’ŒæœåŠ¡ç®¡ç†å™¨ã€‚

```
æœåŠ¡å¯åŠ¨æµç¨‹ï¼š
systemdå¯åŠ¨ â†’ è¯»å–æœåŠ¡é…ç½® â†’ æ£€æŸ¥ä¾èµ– â†’ å¯åŠ¨æœåŠ¡ â†’ ç›‘æŽ§çŠ¶æ€
```

### 4.2 æœåŠ¡çŠ¶æ€æ£€æŸ¥


**ðŸ” åŸºæœ¬çŠ¶æ€æŸ¥çœ‹**
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
systemctl status servicename

# æŸ¥çœ‹æ‰€æœ‰å¤±è´¥çš„æœåŠ¡
systemctl --failed

# æŸ¥çœ‹å¯åŠ¨è€—æ—¶
systemd-analyze blame
```

**ðŸ” è¯¦ç»†ä¿¡æ¯èŽ·å–**
```bash
# æŸ¥çœ‹æœåŠ¡è¯¦ç»†ä¿¡æ¯
systemctl show servicename

# æŸ¥çœ‹æœåŠ¡ä¾èµ–å…³ç³»
systemctl list-dependencies servicename

# æŸ¥çœ‹æœåŠ¡é…ç½®æ–‡ä»¶
systemctl cat servicename
```

### 4.3 å¸¸è§æœåŠ¡å¯åŠ¨é—®é¢˜


**ðŸ“‹ é…ç½®æ–‡ä»¶é”™è¯¯**
```bash
# ç—‡çŠ¶ï¼šæœåŠ¡æ— æ³•å¯åŠ¨ï¼ŒçŠ¶æ€æ˜¾ç¤ºfailed

# æ£€æŸ¥æ–¹æ³•ï¼š
journalctl -u servicename  # æŸ¥çœ‹æœåŠ¡æ—¥å¿—

# å¸¸è§é…ç½®é”™è¯¯ï¼š
- ExecStartè·¯å¾„ä¸æ­£ç¡®
- ç”¨æˆ·æƒé™ä¸è¶³  
- çŽ¯å¢ƒå˜é‡ç¼ºå¤±
- é…ç½®è¯­æ³•é”™è¯¯
```

**ðŸ“‹ æƒé™é—®é¢˜**
```bash
# ç—‡çŠ¶ï¼šPermission deniedé”™è¯¯

# è§£å†³æ–¹æ³•ï¼š
# 1. æ£€æŸ¥æ–‡ä»¶æƒé™
ls -la /path/to/service/file

# 2. æ£€æŸ¥SELinuxä¸Šä¸‹æ–‡
ls -Z /path/to/service/file

# 3. è°ƒæ•´æƒé™
chmod +x /path/to/executable
chown user:group /path/to/file
```

**ðŸ“‹ ç«¯å£å†²çª**
```bash
# ç—‡çŠ¶ï¼šAddress already in use

# æ£€æŸ¥ç«¯å£ä½¿ç”¨æƒ…å†µ
netstat -tulpn | grep :80
ss -tulpn | grep :80

# æ‰¾å‡ºå ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -i :80
```

### 4.4 æœåŠ¡å¯åŠ¨æ•…éšœä¿®å¤


```bash
# 1. é‡ç½®å¤±è´¥çŠ¶æ€
systemctl reset-failed servicename

# 2. é‡æ–°åŠ è½½é…ç½®
systemctl daemon-reload

# 3. å¯ç”¨æœåŠ¡
systemctl enable servicename

# 4. å¯åŠ¨æœåŠ¡
systemctl start servicename

# 5. éªŒè¯çŠ¶æ€
systemctl is-active servicename
systemctl is-enabled servicename
```

---

## 5. ðŸ”— ä¾èµ–å…³ç³»é—®é¢˜æŽ’æŸ¥


### 5.1 ç†è§£æœåŠ¡ä¾èµ–


**ä»€ä¹ˆæ˜¯æœåŠ¡ä¾èµ–**ï¼šæŸä¸ªæœåŠ¡éœ€è¦å…¶ä»–æœåŠ¡å…ˆå¯åŠ¨æ‰èƒ½æ­£å¸¸å·¥ä½œã€‚

```
ä¾èµ–å…³ç³»ç¤ºä¾‹ï¼š
WebæœåŠ¡ â†’ éœ€è¦ â†’ ç½‘ç»œæœåŠ¡
æ•°æ®åº“ â†’ éœ€è¦ â†’ æ–‡ä»¶ç³»ç»ŸæŒ‚è½½
```

### 5.2 ä¾èµ–å…³ç³»ç±»åž‹


**ðŸ”¸ ä¸»è¦ä¾èµ–ç±»åž‹**
```
Requiresï¼šå¼ºä¾èµ–ï¼Œä¾èµ–å¤±è´¥åˆ™æœ¬æœåŠ¡å¤±è´¥
Wantsï¼šå¼±ä¾èµ–ï¼Œä¾èµ–å¤±è´¥ä¸å½±å“æœ¬æœåŠ¡
Afterï¼šé¡ºåºä¾èµ–ï¼Œåœ¨æŸæœåŠ¡ä¹‹åŽå¯åŠ¨
Beforeï¼šåœ¨æŸæœåŠ¡ä¹‹å‰å¯åŠ¨
```

**ðŸ” æŸ¥çœ‹ä¾èµ–å…³ç³»**
```bash
# æŸ¥çœ‹æœåŠ¡çš„ä¾èµ–
systemctl list-dependencies servicename

# æŸ¥çœ‹ä¾èµ–æ ‘
systemctl list-dependencies --all servicename

# æŸ¥çœ‹åå‘ä¾èµ–ï¼ˆè°ä¾èµ–è¿™ä¸ªæœåŠ¡ï¼‰
systemctl list-dependencies --reverse servicename
```

### 5.3 ä¾èµ–é—®é¢˜è¯Šæ–­


**ðŸ“‹ å¾ªçŽ¯ä¾èµ–é—®é¢˜**
```bash
# ç—‡çŠ¶ï¼šç³»ç»Ÿå¯åŠ¨å¡ä½ï¼ŒæœåŠ¡ç›¸äº’ç­‰å¾…

# æ£€æŸ¥æ–¹æ³•ï¼š
systemctl list-dependencies --all | grep -i cycle

# åˆ†æžå¯åŠ¨å›¾
systemd-analyze plot > boot.svg  # ç”Ÿæˆå¯åŠ¨æ—¶åºå›¾
```

**ðŸ“‹ ä¾èµ–æœåŠ¡å¤±è´¥**
```bash
# ç—‡çŠ¶ï¼šæœåŠ¡å› ä¾èµ–å¤±è´¥è€Œæ— æ³•å¯åŠ¨

# è¯Šæ–­æ­¥éª¤ï¼š
1. æŸ¥çœ‹ä¸»æœåŠ¡çŠ¶æ€
systemctl status main-service

2. æŸ¥çœ‹ä¾èµ–æœåŠ¡çŠ¶æ€  
systemctl status dependency-service

3. åˆ†æžå¤±è´¥åŽŸå› 
journalctl -u dependency-service
```

### 5.4 ä¾èµ–é—®é¢˜è§£å†³


**ðŸ”§ ä¸´æ—¶è§£å†³æ–¹æ³•**
```bash
# 1. æ‰‹åŠ¨å¯åŠ¨ä¾èµ–æœåŠ¡
systemctl start dependency-service

# 2. å¿½ç•¥ä¾èµ–ï¼ˆä¸´æ—¶ï¼‰
systemctl --no-deps start main-service

# 3. ä¿®æ”¹ä¾èµ–å…³ç³»
systemctl edit servicename
# åœ¨æ‰“å¼€çš„ç¼–è¾‘å™¨ä¸­æ·»åŠ ï¼š
[Unit]
After=
Requires=
```

**ðŸ”§ æ°¸ä¹…è§£å†³æ–¹æ³•**
```bash
# 1. åˆ›å»ºæœåŠ¡overrideé…ç½®
mkdir -p /etc/systemd/system/servicename.service.d/
cat > /etc/systemd/system/servicename.service.d/override.conf << EOF
[Unit]
# ç§»é™¤æœ‰é—®é¢˜çš„ä¾èµ–
After=
Requires=correct-dependency.service
EOF

# 2. é‡æ–°åŠ è½½é…ç½®
systemctl daemon-reload
systemctl restart servicename
```

---

## 6. â° è¶…æ—¶é—®é¢˜è§£å†³


### 6.1 ä»€ä¹ˆæ˜¯å¯åŠ¨è¶…æ—¶


**ç®€å•ç†è§£**ï¼šæœåŠ¡åœ¨è§„å®šæ—¶é—´å†…æ²¡æœ‰å¯åŠ¨æˆåŠŸï¼Œsystemdè®¤ä¸ºæœåŠ¡å¯åŠ¨å¤±è´¥ã€‚

```
è¶…æ—¶æœºåˆ¶çš„ä½œç”¨ï¼š
é˜²æ­¢ç³»ç»Ÿå› æŸä¸ªæœåŠ¡å¡ä½è€Œæ•´ä½“æ— å“åº”
```

### 6.2 è¶…æ—¶ç±»åž‹åŠè¡¨çŽ°


**ðŸ”¸ å¸¸è§è¶…æ—¶ç±»åž‹**
```
TimeoutStartSecï¼šå¯åŠ¨è¶…æ—¶ï¼ˆé»˜è®¤90ç§’ï¼‰
TimeoutStopSecï¼šåœæ­¢è¶…æ—¶ï¼ˆé»˜è®¤90ç§’ï¼‰
TimeoutSecï¼šåŒæ—¶è®¾ç½®å¯åŠ¨å’Œåœæ­¢è¶…æ—¶
```

**ðŸ” è¶…æ—¶æ•…éšœè¡¨çŽ°**
```bash
# å…¸åž‹é”™è¯¯ä¿¡æ¯ï¼š
systemd[1]: servicename.service: Start operation timed out. Terminating.
systemd[1]: servicename.service: Failed with result 'timeout'.
```

### 6.3 è¶…æ—¶é—®é¢˜è¯Šæ–­


**ðŸ“‹ è¯Šæ–­æ­¥éª¤**
```bash
# 1. æŸ¥çœ‹æœåŠ¡é…ç½®çš„è¶…æ—¶è®¾ç½®
systemctl show servicename | grep Timeout

# 2. æŸ¥çœ‹æœåŠ¡å¯åŠ¨æ—¥å¿—
journalctl -u servicename

# 3. åˆ†æžæœåŠ¡å¯åŠ¨è¿‡ç¨‹
strace -f -o /tmp/service.trace systemctl start servicename

# 4. ç›‘æŽ§èµ„æºä½¿ç”¨
top -p $(systemctl show --property MainPID servicename | cut -d= -f2)
```

### 6.4 è¶…æ—¶é—®é¢˜è§£å†³


**ðŸ”§ è°ƒæ•´è¶…æ—¶æ—¶é—´**
```bash
# 1. åˆ›å»ºoverrideé…ç½®
systemctl edit servicename

# 2. æ·»åŠ è¶…æ—¶é…ç½®
[Service]
TimeoutStartSec=300  # å¢žåŠ åˆ°5åˆ†é’Ÿ
TimeoutStopSec=30

# 3. é‡æ–°åŠ è½½å¹¶é‡å¯
systemctl daemon-reload
systemctl restart servicename
```

**ðŸ”§ ä¼˜åŒ–æœåŠ¡å¯åŠ¨**
```bash
# 1. å¹¶è¡Œå¯åŠ¨ä¼˜åŒ–
[Unit]
# ç§»é™¤ä¸å¿…è¦çš„Afterä¾èµ–
After=

# 2. èµ„æºé™åˆ¶ä¼˜åŒ–
[Service]
# å¢žåŠ èµ„æºé™åˆ¶
MemoryMax=1G
CPUQuota=50%

# 3. å¯åŠ¨æ–¹å¼ä¼˜åŒ–
Type=notify  # ä½¿ç”¨notifyç±»åž‹æé«˜å¯åŠ¨æ•ˆçŽ‡
```

---

## 7. ðŸ“Š å¯åŠ¨æ—¥å¿—åˆ†æžæŠ€å·§


### 7.1 æ—¥å¿—ç³»ç»Ÿæ¦‚è¿°


**Linuxæ—¥å¿—åˆ†å¸ƒ**ï¼š
```
ç³»ç»Ÿæ—¥å¿—ä½ç½®ï¼š
/var/log/messages     # ç³»ç»Ÿæ€»æ—¥å¿—
/var/log/boot.log     # å¯åŠ¨æ—¥å¿—  
/var/log/dmesg        # å†…æ ¸æ¶ˆæ¯
journalctl            # systemdæ—¥å¿—
```

### 7.2 å…³é”®æ—¥å¿—æŸ¥çœ‹æ–¹æ³•


**ðŸ” ç³»ç»Ÿå¯åŠ¨æ—¥å¿—**
```bash
# æŸ¥çœ‹æœ€è¿‘ä¸€æ¬¡å¯åŠ¨çš„æ—¥å¿—
journalctl -b

# æŸ¥çœ‹ä¸Šæ¬¡å¯åŠ¨çš„æ—¥å¿—
journalctl -b -1

# æŸ¥çœ‹å†…æ ¸æ¶ˆæ¯
dmesg | less
dmesg -T  # æ˜¾ç¤ºæ—¶é—´æˆ³

# æŸ¥çœ‹ç‰¹å®šæ—¶é—´èŒƒå›´çš„æ—¥å¿—
journalctl --since "2024-01-01 00:00:00" --until "2024-01-02 00:00:00"
```

**ðŸ” æœåŠ¡ç›¸å…³æ—¥å¿—**
```bash
# æŸ¥çœ‹ç‰¹å®šæœåŠ¡çš„æ—¥å¿—
journalctl -u servicename

# å®žæ—¶è·Ÿè¸ªæœåŠ¡æ—¥å¿—
journalctl -fu servicename

# æŸ¥çœ‹æœåŠ¡çš„é”™è¯¯æ—¥å¿—
journalctl -u servicename -p err
```

### 7.3 æ—¥å¿—åˆ†æžæŠ€å·§


**ðŸ“‹ å…³é”®ä¿¡æ¯è¯†åˆ«**
```bash
# æŸ¥æ‰¾é”™è¯¯å’Œè­¦å‘Š
journalctl -p warning -b

# æœç´¢å…³é”®è¯
journalctl -b | grep -i error
journalctl -b | grep -i failed
journalctl -b | grep -i timeout

# æŒ‰ä¼˜å…ˆçº§è¿‡æ»¤
journalctl -p 0..3  # åªæ˜¾ç¤ºç´§æ€¥åˆ°é”™è¯¯çº§åˆ«çš„æ¶ˆæ¯
```

**ðŸ“‹ æ—¶é—´çº¿åˆ†æž**
```bash
# åˆ†æžå¯åŠ¨æ—¶åº
systemd-analyze

# è¯¦ç»†å¯åŠ¨æ—¶é—´åˆ†æž
systemd-analyze blame

# å¯åŠ¨å…³é”®è·¯å¾„
systemd-analyze critical-chain
```

### 7.4 æ—¥å¿—æŒä¹…åŒ–é…ç½®


```bash
# å¯ç”¨æ—¥å¿—æŒä¹…åŒ–
mkdir -p /var/log/journal
systemd-tmpfiles --create --prefix /var/log/journal

# é…ç½®æ—¥å¿—ä¿ç•™ç­–ç•¥
# ç¼–è¾‘ /etc/systemd/journald.conf
[Journal]
Storage=persistent        # æŒä¹…åŒ–å­˜å‚¨
MaxRetentionSec=1month   # ä¿ç•™1ä¸ªæœˆ
MaxFileSec=1week         # å•ä¸ªæ–‡ä»¶æœ€å¤š1å‘¨
```

---

## 8. ðŸ› ï¸ å•ç”¨æˆ·æ¨¡å¼æ¢å¤


### 8.1 ä»€ä¹ˆæ˜¯å•ç”¨æˆ·æ¨¡å¼


**ç®€å•ç†è§£**ï¼šå•ç”¨æˆ·æ¨¡å¼æ˜¯Linuxç³»ç»Ÿçš„æ•‘æ´æ¨¡å¼ï¼Œåªå¯åŠ¨æœ€åŸºæœ¬çš„æœåŠ¡ï¼Œä¸»è¦ç”¨äºŽç³»ç»Ÿä¿®å¤ã€‚

```
å•ç”¨æˆ·æ¨¡å¼ç‰¹ç‚¹ï¼š
- åªæœ‰rootç”¨æˆ·èƒ½ç™»å½•
- ç½‘ç»œæœåŠ¡ä¸å¯åŠ¨
- å›¾å½¢ç•Œé¢ä¸å¯åŠ¨
- å¤§éƒ¨åˆ†æœåŠ¡ä¸å¯åŠ¨
```

### 8.2 è¿›å…¥å•ç”¨æˆ·æ¨¡å¼çš„æ–¹æ³•


**ðŸ”§ æ–¹æ³•ä¸€ï¼šGRUBå¼•å¯¼æ—¶ä¿®æ”¹**
```
1. å¼€æœºæ—¶æŒ‰ä¸‹eé”®è¿›å…¥GRUBç¼–è¾‘æ¨¡å¼
2. æ‰¾åˆ°linuxå¼€å¤´çš„è¡Œ
3. åœ¨è¡Œå°¾æ·»åŠ ï¼šsingle æˆ– 1 æˆ– systemd.unit=rescue.target
4. æŒ‰Ctrl+Xå¯åŠ¨
```

**ðŸ”§ æ–¹æ³•äºŒï¼šsystemctlåˆ‡æ¢**
```bash
# åœ¨ç³»ç»Ÿè¿è¡Œæ—¶åˆ‡æ¢åˆ°æ•‘æ´æ¨¡å¼
systemctl rescue

# åˆ‡æ¢åˆ°ç´§æ€¥æ¨¡å¼ï¼ˆæ›´åŸºæœ¬ï¼‰
systemctl emergency
```

### 8.3 å•ç”¨æˆ·æ¨¡å¼ä¸‹çš„ä¿®å¤æ“ä½œ


**ðŸ“‹ æ–‡ä»¶ç³»ç»Ÿä¿®å¤**
```bash
# æ£€æŸ¥æ ¹æ–‡ä»¶ç³»ç»Ÿï¼ˆé€šå¸¸å·²è‡ªåŠ¨æŒ‚è½½ä¸ºåªè¯»ï¼‰
fsck /dev/sda1

# é‡æ–°æŒ‚è½½ä¸ºè¯»å†™æ¨¡å¼
mount -o remount,rw /

# æ£€æŸ¥å…¶ä»–æ–‡ä»¶ç³»ç»Ÿ
fsck /dev/sda2
fsck /dev/sdb1
```

**ðŸ“‹ é…ç½®æ–‡ä»¶ä¿®å¤**
```bash
# ä¿®å¤æŸåçš„é…ç½®æ–‡ä»¶
cp /etc/fstab.bak /etc/fstab
vim /etc/fstab  # æ‰‹åŠ¨ç¼–è¾‘ä¿®å¤

# é‡ç½®ç”¨æˆ·å¯†ç 
passwd root
passwd username

# ä¿®å¤ç½‘ç»œé…ç½®
vim /etc/network/interfaces  # Debianç³»
vim /etc/sysconfig/network-scripts/ifcfg-eth0  # RHELç³»
```

**ðŸ“‹ æœåŠ¡é…ç½®ä¿®å¤**
```bash
# ç¦ç”¨æœ‰é—®é¢˜çš„æœåŠ¡
systemctl disable problematic.service

# é‡ç½®æœåŠ¡çŠ¶æ€
systemctl reset-failed

# é‡æ–°ç”Ÿæˆinitramfs
dracut --force
```

### 8.4 ä»Žå•ç”¨æˆ·æ¨¡å¼æ¢å¤


```bash
# æ£€æŸ¥ä¿®å¤ç»“æžœ
systemctl status

# é€€å‡ºå•ç”¨æˆ·æ¨¡å¼ï¼Œæ­£å¸¸å¯åŠ¨
systemctl default

# æˆ–è€…é‡å¯ç³»ç»Ÿ
reboot
```

---

## 9. ðŸ› å¯åŠ¨å‚æ•°è°ƒè¯•


### 9.1 å†…æ ¸å¯åŠ¨å‚æ•°ä½œç”¨


**ä»€ä¹ˆæ˜¯å¯åŠ¨å‚æ•°**ï¼šä¼ é€’ç»™Linuxå†…æ ¸çš„é…ç½®é€‰é¡¹ï¼Œç”¨äºŽæŽ§åˆ¶ç³»ç»Ÿè¡Œä¸ºã€‚

```
å¯åŠ¨å‚æ•°ä¼ é€’è·¯å¾„ï¼š
GRUB â†’ å†…æ ¸ â†’ ç³»ç»Ÿåˆå§‹åŒ–
```

### 9.2 å¸¸ç”¨è°ƒè¯•å‚æ•°


**ðŸ”§ è°ƒè¯•ç›¸å…³å‚æ•°**
```bash
# è¯¦ç»†å¯åŠ¨ä¿¡æ¯
debug           # å¯ç”¨è°ƒè¯•æ¨¡å¼
verbose         # è¯¦ç»†è¾“å‡º
loglevel=7      # è®¾ç½®æ—¥å¿—çº§åˆ«ï¼ˆ0-7ï¼‰

# å›¾å½¢ç•Œé¢ç›¸å…³
text            # å¼ºåˆ¶æ–‡æœ¬æ¨¡å¼å¯åŠ¨
3               # å¯åŠ¨åˆ°è¿è¡Œçº§åˆ«3ï¼ˆæ–‡æœ¬æ¨¡å¼ï¼‰

# ç¡¬ä»¶ç›¸å…³
acpi=off        # ç¦ç”¨ACPI
noapic          # ç¦ç”¨APIC
nomodeset       # ç¦ç”¨æ˜¾å¡é©±åŠ¨æ¨¡å¼è®¾ç½®
```

**ðŸ”§ å­˜å‚¨ç›¸å…³å‚æ•°**
```bash
# æ ¹æ–‡ä»¶ç³»ç»Ÿ
root=/dev/sda1              # æŒ‡å®šæ ¹åˆ†åŒº
rootfstype=ext4            # æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿç±»åž‹
ro                         # åªè¯»æŒ‚è½½æ ¹æ–‡ä»¶ç³»ç»Ÿ

# RAIDå’ŒLVM
rd.lvm.lv=vgname/lvname    # æŒ‡å®šLVMé€»è¾‘å·
rd.md.uuid=uuid            # æŒ‡å®šRAID UUID
```

### 9.3 å‚æ•°è®¾ç½®æ–¹æ³•


**ðŸ”§ ä¸´æ—¶è®¾ç½®ï¼ˆå•æ¬¡å¯åŠ¨ï¼‰**
```
1. å¼€æœºæ—¶æŒ‰eè¿›å…¥GRUBç¼–è¾‘
2. åœ¨linuxè¡Œæ·»åŠ å‚æ•°
3. æŒ‰Ctrl+Xå¯åŠ¨
```

**ðŸ”§ æ°¸ä¹…è®¾ç½®**
```bash
# ç¼–è¾‘GRUBé…ç½®
vim /etc/default/grub

# ä¿®æ”¹GRUB_CMDLINE_LINUXè¡Œ
GRUB_CMDLINE_LINUX="debug loglevel=7"

# æ›´æ–°GRUBé…ç½®
update-grub        # Debian/Ubuntu
grub2-mkconfig -o /boot/grub2/grub.cfg  # RHEL/CentOS
```

### 9.4 å‚æ•°è°ƒè¯•ç­–ç•¥


**ðŸ“‹ é€æ­¥æŽ’é™¤æ³•**
```
1. ä½¿ç”¨æœ€å°å‚æ•°é›†å¯åŠ¨
2. é€ä¸ªæ·»åŠ å‚æ•°æµ‹è¯•
3. ç¡®å®šå¯¼è‡´é—®é¢˜çš„å‚æ•°
4. è°ƒæ•´æˆ–ç§»é™¤é—®é¢˜å‚æ•°
```

**ðŸ“‹ å¸¸è§å‚æ•°ç»„åˆ**
```bash
# å®‰å…¨æ¨¡å¼å¯åŠ¨
single acpi=off noapic nomodeset

# ç½‘ç»œå¯åŠ¨é—®é¢˜
ip=dhcp root=/dev/nfs nfsroot=server:/path

# å­˜å‚¨é—®é¢˜è°ƒè¯•
rd.shell rd.debug rd.break=pre-mount
```

---

## 10. ðŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 æ•…éšœè¯Šæ–­æµç¨‹è®°å¿†


```
è§‚å¯Ÿ â†’ å®šä½ â†’ åˆ†æž â†’ ä¿®å¤ â†’ éªŒè¯

ðŸ”¸ è§‚å¯Ÿï¼šæ”¶é›†æ•…éšœçŽ°è±¡å’Œé”™è¯¯ä¿¡æ¯
ðŸ”¸ å®šä½ï¼šç¡®å®šæ•…éšœå‘ç”Ÿçš„å…·ä½“é˜¶æ®µ  
ðŸ”¸ åˆ†æžï¼šæŸ¥æ‰¾æ—¥å¿—ï¼Œåˆ†æžæ ¹æœ¬åŽŸå› 
ðŸ”¸ ä¿®å¤ï¼šåˆ¶å®šå¹¶æ‰§è¡Œè§£å†³æ–¹æ¡ˆ
ðŸ”¸ éªŒè¯ï¼šç¡®è®¤é—®é¢˜å·²å½»åº•è§£å†³
```

### 10.2 å¿…å¤‡è¯Šæ–­æŠ€èƒ½


**ðŸ” æ—¥å¿—åˆ†æžèƒ½åŠ›**
- `journalctl -b` - æŸ¥çœ‹å¯åŠ¨æ—¥å¿—
- `dmesg` - æŸ¥çœ‹å†…æ ¸æ¶ˆæ¯  
- `systemctl --failed` - æŸ¥çœ‹å¤±è´¥æœåŠ¡

**ðŸ”§ åŸºæœ¬ä¿®å¤æŠ€èƒ½**
- å•ç”¨æˆ·æ¨¡å¼è¿›å…¥å’Œä½¿ç”¨
- å†…æ ¸å‚æ•°ä¸´æ—¶å’Œæ°¸ä¹…ä¿®æ”¹
- æœåŠ¡ä¾èµ–å…³ç³»åˆ†æžå’Œè°ƒæ•´

**âš¡ åº”æ€¥å¤„ç†èƒ½åŠ›**
- å¿«é€Ÿè¿›å…¥æ•‘æ´æ¨¡å¼
- åŸºæœ¬æ–‡ä»¶ç³»ç»Ÿä¿®å¤
- å…³é”®é…ç½®æ–‡ä»¶å¤‡ä»½å’Œæ¢å¤

### 10.3 æ•…éšœé¢„é˜²ç­–ç•¥


**ðŸ“‹ é¢„é˜²æ€§æŽªæ–½**
- **å®šæœŸå¤‡ä»½**ï¼šå…³é”®é…ç½®æ–‡ä»¶å’Œæ•°æ®
- **ç›‘æŽ§å‘Šè­¦**ï¼šè®¾ç½®æœåŠ¡çŠ¶æ€ç›‘æŽ§
- **æµ‹è¯•éªŒè¯**ï¼šé…ç½®æ›´æ”¹å‰æµ‹è¯•
- **æ–‡æ¡£è®°å½•**ï¼šè®°å½•ç³»ç»Ÿé…ç½®å˜æ›´

### 10.4 å®žç”¨å·¥å…·æ¸…å•


| å·¥å…· | **ç”¨é€”** | **å¸¸ç”¨å‘½ä»¤** |
|-----|---------|-------------|
| `journalctl` | **æŸ¥çœ‹systemdæ—¥å¿—** | `journalctl -b -u servicename` |
| `systemctl` | **æœåŠ¡ç®¡ç†è¯Šæ–­** | `systemctl status --failed` |
| `dmesg` | **å†…æ ¸æ¶ˆæ¯æŸ¥çœ‹** | `dmesg -T \| grep -i error` |
| `fsck` | **æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥ä¿®å¤** | `fsck -y /dev/sda1` |
| `systemd-analyze` | **å¯åŠ¨æ€§èƒ½åˆ†æž** | `systemd-analyze blame` |

**æ ¸å¿ƒè®°å¿†**ï¼š
- å¯åŠ¨æ•…éšœè¦åˆ†é˜¶æ®µå®šä½ï¼Œä¸è¦ç›²ç›®ä¿®å¤
- æ—¥å¿—æ˜¯è¯Šæ–­çš„å…³é”®ï¼Œå­¦ä¼šçœ‹æ‡‚é”™è¯¯ä¿¡æ¯  
- å•ç”¨æˆ·æ¨¡å¼æ˜¯æœ€åŽçš„æ•‘å‘½ç¨»è‰
- å†…æ ¸å‚æ•°è°ƒè¯•èƒ½è§£å†³å¾ˆå¤šæ£˜æ‰‹é—®é¢˜
- é¢„é˜²èƒœäºŽä¿®å¤ï¼Œåšå¥½å¤‡ä»½å’Œç›‘æŽ§