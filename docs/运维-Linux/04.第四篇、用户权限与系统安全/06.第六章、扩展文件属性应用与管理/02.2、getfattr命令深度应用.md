---
title: 2ã€getfattrå‘½ä»¤æ·±åº¦åº”ç”¨
---
## ğŸ“š ç›®å½•

1. [getfattrå‘½ä»¤åŸºç¡€æ¦‚å¿µ](#1-getfattrå‘½ä»¤åŸºç¡€æ¦‚å¿µ)
2. [åŸºæœ¬è¯­æ³•ä¸æ ¸å¿ƒé€‰é¡¹](#2-åŸºæœ¬è¯­æ³•ä¸æ ¸å¿ƒé€‰é¡¹)
3. [æŸ¥çœ‹æ‰©å±•å±æ€§çš„ä¸åŒæ–¹æ³•](#3-æŸ¥çœ‹æ‰©å±•å±æ€§çš„ä¸åŒæ–¹æ³•)
4. [è¾“å‡ºæ ¼å¼æ§åˆ¶è¯¦è§£](#4-è¾“å‡ºæ ¼å¼æ§åˆ¶è¯¦è§£)
5. [é«˜çº§åº”ç”¨ä¸æ‰¹é‡æ“ä½œ](#5-é«˜çº§åº”ç”¨ä¸æ‰¹é‡æ“ä½œ)
6. [å¤‡ä»½å¯¼å‡ºä¸å®é™…åº”ç”¨](#6-å¤‡ä»½å¯¼å‡ºä¸å®é™…åº”ç”¨)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” getfattrå‘½ä»¤åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯getfattrå‘½ä»¤


**é€šä¿—ç†è§£**ï¼š`getfattr`å°±æ˜¯Linuxç³»ç»Ÿä¸­ä¸“é—¨ç”¨æ¥"æŸ¥çœ‹æ–‡ä»¶é¢å¤–ä¿¡æ¯"çš„å·¥å…·ï¼Œå°±åƒæŸ¥çœ‹æ–‡ä»¶çš„"æ ‡ç­¾çº¸"ä¸€æ ·ã€‚

> ğŸ“Œ **æ ¸å¿ƒæ¦‚å¿µ**  
> getfattr = **get** + **f**ile + **attr**ibutesï¼ˆè·å–æ–‡ä»¶å±æ€§ï¼‰  
> å®ƒçš„ä½œç”¨æ˜¯æŸ¥çœ‹å’Œæ˜¾ç¤ºæ–‡ä»¶æˆ–ç›®å½•ä¸Šé™„åŠ çš„"æ‰©å±•å±æ€§"

**å®é™…ç±»æ¯”**ï¼š
```
æ™®é€šæ–‡ä»¶ä¿¡æ¯ï¼ˆls -lï¼‰ï¼š  å°±åƒçœ‹ä¹¦çš„å°é¢
â”œâ”€ æ–‡ä»¶å¤§å°                ä¹¦çš„åšåº¦
â”œâ”€ åˆ›å»ºæ—¶é—´                å‡ºç‰ˆæ—¥æœŸ  
â”œâ”€ æƒé™ä¿¡æ¯                å€Ÿé˜…æƒé™
â””â”€ æ‰€æœ‰è€…                  ä½œè€…ä¿¡æ¯

æ‰©å±•å±æ€§ï¼ˆgetfattrï¼‰ï¼š   å°±åƒçœ‹ä¹¦çš„æ ‡ç­¾è´´
â”œâ”€ å®‰å…¨æ ‡ç­¾                "æœºå¯†"æ ‡ç­¾
â”œâ”€ å¤‡ä»½ä¿¡æ¯                "å·²å¤‡ä»½"æ ‡ç­¾
â”œâ”€ è‡ªå®šä¹‰æ ‡è®°              "é‡è¦æ–‡æ¡£"æ ‡ç­¾
â””â”€ åº”ç”¨ç‰¹å®šä¿¡æ¯            å…¶ä»–å¤‡æ³¨æ ‡ç­¾
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦getfattr


**è§£å†³çš„é—®é¢˜**ï¼šä¼ ç»Ÿçš„`ls`å‘½ä»¤åªèƒ½çœ‹åˆ°æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼Œä½†çœ‹ä¸åˆ°æ–‡ä»¶ä¸Šé™„åŠ çš„"é¢å¤–æ ‡è®°"

```
ä¼ ç»Ÿæ–¹å¼çš„å±€é™ï¼š
æ–‡ä»¶å: document.txt
å¤§å°: 1024å­—èŠ‚  
æ—¶é—´: 2025-09-14
æƒé™: rw-r--r--
âŒ çœ‹ä¸åˆ°ï¼šè¿™æ˜¯åŠ å¯†æ–‡ä»¶ï¼Ÿæœ‰å¤‡ä»½å—ï¼Ÿå±äºå“ªä¸ªé¡¹ç›®ï¼Ÿ

getfattrçš„ä¼˜åŠ¿ï¼š  
âœ… èƒ½çœ‹åˆ°ï¼šsecurity.selinux = "confidential_t"
âœ… èƒ½çœ‹åˆ°ï¼šuser.backup = "yes"  
âœ… èƒ½çœ‹åˆ°ï¼šuser.project = "webdev"
```

> ğŸ’¡ **å®ç”¨æŠ€å·§**  
> åœ¨ä¼ä¸šç¯å¢ƒä¸­ï¼Œæ‰©å±•å±æ€§å¸¸ç”¨äºæ–‡ä»¶åˆ†ç±»ã€å®‰å…¨æ ‡è®°ã€å¤‡ä»½çŠ¶æ€è·Ÿè¸ªç­‰åœºæ™¯

---

## 2. âš™ï¸ åŸºæœ¬è¯­æ³•ä¸æ ¸å¿ƒé€‰é¡¹


### 2.1 å‘½ä»¤åŸºæœ¬è¯­æ³•


**æ ‡å‡†æ ¼å¼**ï¼š
```bash
getfattr [é€‰é¡¹] æ–‡ä»¶åæˆ–ç›®å½•å
```

**æ ¸å¿ƒè¯­æ³•ç»“æ„**ï¼š
```
getfattr
    â”œâ”€ -d        æ˜¾ç¤ºæ‰€æœ‰æ‰©å±•å±æ€§
    â”œâ”€ -n <åç§°>  æ˜¾ç¤ºæŒ‡å®šå±æ€§
    â”œâ”€ -R        é€’å½’å¤„ç†ç›®å½•
    â”œâ”€ -h        ä¸è·Ÿéšç¬¦å·é“¾æ¥
    â””â”€ --dump    ä»¥å¯å¯¼å…¥æ ¼å¼æ˜¾ç¤º
```

### 2.2 æœ€å¸¸ç”¨çš„åŸºç¡€é€‰é¡¹


#### ğŸ”¸ æŸ¥çœ‹æ‰€æœ‰å±æ€§ (-dé€‰é¡¹)


**å«ä¹‰**ï¼š`-d`ä»£è¡¨**dump**ï¼ˆè½¬å‚¨ï¼‰ï¼Œæ˜¾ç¤ºæ–‡ä»¶çš„æ‰€æœ‰æ‰©å±•å±æ€§

```bash
# æŸ¥çœ‹æ–‡ä»¶çš„æ‰€æœ‰æ‰©å±•å±æ€§
getfattr -d myfile.txt

# å®é™…è¾“å‡ºç¤ºä¾‹ï¼š
# file: myfile.txt
# user.comment="è¿™æ˜¯é‡è¦æ–‡æ¡£"
# user.author="å¼ ä¸‰"
# user.project="ç½‘ç«™å¼€å‘"
```

> ğŸ“Œ **æ ¸å¿ƒæ¦‚å¿µ**  
> `-d`é€‰é¡¹å°±åƒ"å…¨éƒ¨å±•ç¤º"ï¼ŒæŠŠæ–‡ä»¶èº«ä¸Šçš„æ‰€æœ‰"æ ‡ç­¾"éƒ½åˆ—å‡ºæ¥

#### ğŸ”¸ æŸ¥çœ‹ç‰¹å®šå±æ€§ (-né€‰é¡¹)


**å«ä¹‰**ï¼š`-n`ä»£è¡¨**name**ï¼ˆåç§°ï¼‰ï¼Œåªæ˜¾ç¤ºæŒ‡å®šåç§°çš„å±æ€§å€¼

```bash
# åªæŸ¥çœ‹commentå±æ€§
getfattr -n user.comment myfile.txt

# è¾“å‡ºï¼š
# file: myfile.txt
# user.comment="è¿™æ˜¯é‡è¦æ–‡æ¡£"

# åªæŸ¥çœ‹ä½œè€…ä¿¡æ¯
getfattr -n user.author myfile.txt
```

**ä½¿ç”¨åœºæ™¯å¯¹æ¯”**ï¼š
```
-dé€‰é¡¹ï¼šçœ‹æ‰€æœ‰æ ‡ç­¾ï¼ˆé€‚åˆæ¢ç´¢æœªçŸ¥æ–‡ä»¶ï¼‰
-né€‰é¡¹ï¼šçœ‹ç‰¹å®šæ ‡ç­¾ï¼ˆé€‚åˆæŸ¥æ‰¾å·²çŸ¥ä¿¡æ¯ï¼‰

ç±»æ¯”ï¼š
-d = "è¿™ä¸ªåŒ…è£¹æœ‰ä»€ä¹ˆæ ‡ç­¾ï¼Ÿ"ï¼ˆå…¨éƒ¨æ˜¾ç¤ºï¼‰
-n = "è¿™ä¸ªåŒ…è£¹æ˜¯æ˜“ç¢å“å—ï¼Ÿ"ï¼ˆåªçœ‹æŒ‡å®šæ ‡ç­¾ï¼‰
```

#### ğŸ”¸ é€’å½’æŸ¥çœ‹ (-Ré€‰é¡¹)


**å«ä¹‰**ï¼š`-R`ä»£è¡¨**Recursive**ï¼ˆé€’å½’ï¼‰ï¼Œå¤„ç†ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•

```bash
# é€’å½’æŸ¥çœ‹æ•´ä¸ªç›®å½•æ ‘çš„æ‰©å±•å±æ€§
getfattr -d -R /home/user/documents/

# ä¼šæ˜¾ç¤ºï¼š
# documents/æ–‡ä»¶1çš„å±æ€§
# documents/å­ç›®å½•1/æ–‡ä»¶2çš„å±æ€§  
# documents/å­ç›®å½•1/å­å­ç›®å½•/æ–‡ä»¶3çš„å±æ€§
# ...
```

**ç›®å½•ç»“æ„ç¤ºä¾‹**ï¼š
```
documents/
â”œâ”€ file1.txt          â† æ˜¾ç¤ºå…¶æ‰©å±•å±æ€§
â”œâ”€ project/           
â”‚  â”œâ”€ readme.md       â† æ˜¾ç¤ºå…¶æ‰©å±•å±æ€§
â”‚  â””â”€ config.ini      â† æ˜¾ç¤ºå…¶æ‰©å±•å±æ€§
â””â”€ backup/
   â””â”€ old.txt         â† æ˜¾ç¤ºå…¶æ‰©å±•å±æ€§
```

---

## 3. ğŸ” æŸ¥çœ‹æ‰©å±•å±æ€§çš„ä¸åŒæ–¹æ³•


### 3.1 åŸºç¡€æŸ¥çœ‹æ–¹æ³•å¯¹æ¯”


| æ–¹æ³• | **å‘½ä»¤** | **é€‚ç”¨åœºæ™¯** | **ä¼˜ç¼ºç‚¹** |
|------|----------|-------------|-----------|
| æŸ¥çœ‹æ‰€æœ‰å±æ€§ | `getfattr -d file` | æ¢ç´¢æœªçŸ¥æ–‡ä»¶ | ä¿¡æ¯å…¨é¢ä½†å¯èƒ½å†—é•¿ |
| æŸ¥çœ‹å•ä¸ªå±æ€§ | `getfattr -n user.comment file` | æŸ¥æ‰¾ç‰¹å®šä¿¡æ¯ | ç²¾ç¡®ä½†éœ€è¦çŸ¥é“å±æ€§å |
| æ‰¹é‡æŸ¥çœ‹ | `getfattr -d file1 file2 file3` | å¯¹æ¯”å¤šä¸ªæ–‡ä»¶ | æ–¹ä¾¿å¯¹æ¯” |
| é€’å½’æŸ¥çœ‹ | `getfattr -d -R directory/` | åˆ†ææ•´ä¸ªç›®å½• | å…¨é¢ä½†è¾“å‡ºé‡å¤§ |

### 3.2 å¤„ç†ç¬¦å·é“¾æ¥ (-hé€‰é¡¹)


**ç¬¦å·é“¾æ¥çš„å¤„ç†ç­–ç•¥**ï¼š

```bash
# åˆ›å»ºç¬¦å·é“¾æ¥ç¤ºä¾‹
echo "åŸå§‹æ–‡ä»¶" > original.txt
setfattr -n user.type -v "original" original.txt
ln -s original.txt link.txt

# é»˜è®¤è¡Œä¸ºï¼šè·Ÿéšé“¾æ¥ï¼ˆæŸ¥çœ‹åŸå§‹æ–‡ä»¶çš„å±æ€§ï¼‰
getfattr -d link.txt
# ç»“æœï¼šæ˜¾ç¤ºoriginal.txtçš„æ‰©å±•å±æ€§

# ä½¿ç”¨-hé€‰é¡¹ï¼šä¸è·Ÿéšé“¾æ¥ï¼ˆæŸ¥çœ‹é“¾æ¥æœ¬èº«çš„å±æ€§ï¼‰
getfattr -d -h link.txt  
# ç»“æœï¼šæ˜¾ç¤ºlink.txtæœ¬èº«çš„æ‰©å±•å±æ€§ï¼ˆå¯èƒ½ä¸ºç©ºï¼‰
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**  
> ç¬¦å·é“¾æ¥æœ¬èº«é€šå¸¸æ²¡æœ‰æ‰©å±•å±æ€§ï¼Œå±æ€§éƒ½å­˜å‚¨åœ¨ç›®æ ‡æ–‡ä»¶ä¸Š

**å®é™…åº”ç”¨åœºæ™¯**ï¼š
```
ç½‘ç«™ç›®å½•ç»“æ„ï¼š
/var/www/html/index.html  â† åŸå§‹æ–‡ä»¶ï¼ˆæœ‰æ‰©å±•å±æ€§ï¼‰
/home/user/website/index.html â† ç¬¦å·é“¾æ¥

getfattr -d /home/user/website/index.html     # çœ‹åˆ°åŸå§‹æ–‡ä»¶çš„å±æ€§
getfattr -d -h /home/user/website/index.html  # çœ‹é“¾æ¥æœ¬èº«çš„å±æ€§ï¼ˆé€šå¸¸ä¸ºç©ºï¼‰
```

### 3.3 åªæ˜¾ç¤ºå±æ€§å€¼ (--only-values)


**å«ä¹‰**ï¼šåªè¾“å‡ºå±æ€§çš„å€¼ï¼Œä¸æ˜¾ç¤ºæ–‡ä»¶åå’Œå±æ€§å

```bash
# æ™®é€šè¾“å‡º
getfattr -n user.comment myfile.txt
# file: myfile.txt  
# user.comment="è¿™æ˜¯é‡è¦æ–‡æ¡£"

# åªæ˜¾ç¤ºå€¼
getfattr -n user.comment --only-values myfile.txt
# è¿™æ˜¯é‡è¦æ–‡æ¡£

# åœ¨è„šæœ¬ä¸­çš„åº”ç”¨
COMMENT=$(getfattr -n user.comment --only-values myfile.txt)
echo "æ–‡ä»¶å¤‡æ³¨: $COMMENT"
```

---

## 4. ğŸ¨ è¾“å‡ºæ ¼å¼æ§åˆ¶è¯¦è§£


### 4.1 é»˜è®¤è¾“å‡ºæ ¼å¼


**æ ‡å‡†è¾“å‡ºæ ¼å¼**ï¼š
```bash
getfattr -d example.txt
# file: example.txt
# user.author="æå››"
# user.date="2025-09-14"
# user.status="å·²å®¡æ ¸"
```

**æ ¼å¼è§£æ**ï¼š
```
ç¬¬1è¡Œï¼šfile: æ–‡ä»¶å     â† è¡¨ç¤ºæ­£åœ¨æŸ¥çœ‹çš„æ–‡ä»¶
ç¬¬2è¡Œï¼šå±æ€§å="å±æ€§å€¼"   â† userå‘½åç©ºé—´çš„å±æ€§
ç¬¬3è¡Œï¼šå±æ€§å="å±æ€§å€¼"   â† æ¯è¡Œä¸€ä¸ªå±æ€§
ç¬¬Nè¡Œï¼š...             â† æ‰€æœ‰å±æ€§ä¾æ¬¡åˆ—å‡º
```

### 4.2 å¯¼å‡ºæ ¼å¼æ§åˆ¶ (--dump)


**å«ä¹‰**ï¼š`--dump`æ ¼å¼ç”Ÿæˆå¯ä»¥é‡æ–°å¯¼å…¥çš„æ ‡å‡†æ ¼å¼

```bash
# å¯¼å‡ºæ ¼å¼
getfattr -d --dump myfile.txt

# è¾“å‡ºç¤ºä¾‹ï¼š
# file: myfile.txt
# user.author=0x"æå››"
# user.project=0x"ç½‘ç«™å¼€å‘é¡¹ç›®" 
# user.priority=0x"é«˜"
```

**ä¸æ™®é€šæ ¼å¼çš„åŒºåˆ«**ï¼š
```
æ™®é€šæ ¼å¼ï¼šuser.author="æå››"           â† äººç±»å¯è¯»
å¯¼å‡ºæ ¼å¼ï¼šuser.author=0x"æå››"         â† å¯é‡æ–°å¯¼å…¥

ç”¨é€”å¯¹æ¯”ï¼š
æ™®é€šæ ¼å¼ï¼šé€‚åˆæŸ¥çœ‹å’Œé˜…è¯»
å¯¼å‡ºæ ¼å¼ï¼šé€‚åˆå¤‡ä»½å’Œæ¢å¤
```

### 4.3 æ–‡æœ¬æ ¼å¼ä¸åå…­è¿›åˆ¶æ ¼å¼


#### ğŸ”¸ æ–‡æœ¬æ ¼å¼æ˜¾ç¤º (--text)


```bash
# å¼ºåˆ¶ä»¥æ–‡æœ¬æ ¼å¼æ˜¾ç¤º
getfattr -d --text myfile.txt

# é€‚ç”¨äºåŒ…å«ç‰¹æ®Šå­—ç¬¦çš„å±æ€§å€¼
setfattr -n user.note -v "åŒ…å«\næ¢è¡Œç¬¦çš„\tæ–‡æœ¬" myfile.txt
getfattr -n user.note --text myfile.txt
```

#### ğŸ”¸ åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤º (--hex)


```bash
# ä»¥åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤º
getfattr -d --hex myfile.txt

# è¾“å‡ºç¤ºä¾‹ï¼š
# file: myfile.txt
# user.author=0x6C69343934  # "æå››"çš„åå…­è¿›åˆ¶è¡¨ç¤º
```

**æ ¼å¼é€‰æ‹©å»ºè®®**ï¼š
```
é»˜è®¤æ ¼å¼ï¼šæ—¥å¸¸æŸ¥çœ‹ä½¿ç”¨
--textï¼š  å¤„ç†åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„å†…å®¹
--hexï¼š   è°ƒè¯•æˆ–å¤„ç†äºŒè¿›åˆ¶æ•°æ®
--dumpï¼š  å¤‡ä»½å’Œè¿ç§»åœºæ™¯
```

---

## 5. ğŸš€ é«˜çº§åº”ç”¨ä¸æ‰¹é‡æ“ä½œ


### 5.1 ä¸findå‘½ä»¤ç»“åˆçš„æ‰¹é‡æŸ¥è¯¢


**æŸ¥æ‰¾æœ‰ç‰¹å®šå±æ€§çš„æ–‡ä»¶**ï¼š

```bash
# æ–¹æ³•1ï¼šä½¿ç”¨find + getfattrç»„åˆ
find /home/user -type f -exec getfattr -n user.project {} \; 2>/dev/null | grep -B1 "ç½‘ç«™å¼€å‘"

# æ–¹æ³•2ï¼šæ›´ä¼˜é›…çš„è„šæœ¬æ–¹å¼
#!/bin/bash
find /home/user -type f | while read file; do
    if getfattr -n user.project "$file" 2>/dev/null | grep -q "ç½‘ç«™å¼€å‘"; then
        echo "é¡¹ç›®æ–‡ä»¶: $file"
        getfattr -d "$file"
        echo "---"
    fi
done
```

**æ‰¹é‡åˆ†æç›®å½•å±æ€§**ï¼š
```bash
# ç»Ÿè®¡ä¸åŒé¡¹ç›®çš„æ–‡ä»¶æ•°é‡
#!/bin/bash
declare -A project_count

find /home/user/documents -type f | while read file; do
    project=$(getfattr -n user.project --only-values "$file" 2>/dev/null)
    if [ ! -z "$project" ]; then
        ((project_count["$project"]++))
    fi
done

# æ˜¾ç¤ºç»Ÿè®¡ç»“æœ
for project in "${!project_count[@]}"; do
    echo "$project: ${project_count[$project]} ä¸ªæ–‡ä»¶"
done
```

### 5.2 å®é™…å·¥ä½œåœºæ™¯åº”ç”¨


#### ğŸ”¸ æ–‡ä»¶åˆ†ç±»ç»Ÿè®¡


```bash
# ç»Ÿè®¡ä¸åŒç±»å‹æ–‡ä»¶çš„æ‰©å±•å±æ€§
getfattr -R -d /var/www/html | awk '
/^# file:/ { file = $3 }
/user\.type=/ { 
    gsub(/.*"/, "", $0)
    gsub(/".*/, "", $0) 
    types[$0]++
}
END {
    for (type in types) {
        print type ": " types[type] " ä¸ªæ–‡ä»¶"
    }
}'
```

#### ğŸ”¸ å®‰å…¨å®¡è®¡æ£€æŸ¥


```bash
# æ£€æŸ¥æ•æ„Ÿæ–‡ä»¶çš„å®‰å…¨å±æ€§
#!/bin/bash
SENSITIVE_DIRS="/etc /var/log /home"

for dir in $SENSITIVE_DIRS; do
    echo "=== æ£€æŸ¥ç›®å½•: $dir ==="
    find "$dir" -type f 2>/dev/null | head -20 | while read file; do
        security_attr=$(getfattr -n security.selinux --only-values "$file" 2>/dev/null)
        if [ ! -z "$security_attr" ]; then
            echo "$file: $security_attr"
        fi
    done
done
```

### 5.3 æ€§èƒ½ä¼˜åŒ–å»ºè®®


**å¤§é‡æ–‡ä»¶å¤„ç†ä¼˜åŒ–**ï¼š
```bash
# ä½æ•ˆæ–¹å¼ï¼ˆæ¯ä¸ªæ–‡ä»¶å•ç‹¬è°ƒç”¨ï¼‰
for file in /large/directory/*; do
    getfattr -d "$file"
done

# é«˜æ•ˆæ–¹å¼ï¼ˆæ‰¹é‡å¤„ç†ï¼‰
getfattr -d /large/directory/*

# æœ€ä¼˜æ–¹å¼ï¼ˆé€’å½’å¤„ç†ï¼‰
getfattr -d -R /large/directory/
```

> ğŸ’¡ **å®ç”¨æŠ€å·§**  
> å¤„ç†å¤§é‡æ–‡ä»¶æ—¶ï¼Œä½¿ç”¨é€’å½’é€‰é¡¹`-R`æ¯”å¾ªç¯è°ƒç”¨æ•ˆç‡é«˜å¾—å¤š

---

## 6. ğŸ’¾ å¤‡ä»½å¯¼å‡ºä¸å®é™…åº”ç”¨


### 6.1 æ‰©å±•å±æ€§çš„å¤‡ä»½ç­–ç•¥


**å®Œæ•´å¤‡ä»½æ–¹æ¡ˆ**ï¼š
```bash
# 1. å¯¼å‡ºæ‰€æœ‰æ‰©å±•å±æ€§åˆ°æ–‡ä»¶
getfattr -d -R --dump /home/user > /backup/xattr_backup.txt

# 2. å¤‡ä»½æ–‡ä»¶å†…å®¹å’Œæ‰©å±•å±æ€§
tar --xattrs -czf /backup/full_backup.tar.gz /home/user

# 3. éªŒè¯å¤‡ä»½å®Œæ•´æ€§
getfattr -d -R /home/user | wc -l  # åŸå§‹å±æ€§æ•°é‡
tar --xattrs -tzf /backup/full_backup.tar.gz | wc -l  # å¤‡ä»½æ–‡ä»¶æ•°é‡
```

**å¤‡ä»½æ ¼å¼ç¤ºä¾‹**ï¼š
```
# file: /home/user/document.txt
user.author="å¼ ä¸‰"
user.project="ç½‘ç«™å¼€å‘"
user.backup_date="2025-09-14"

# file: /home/user/config.ini  
user.type="é…ç½®æ–‡ä»¶"
user.critical="yes"
```

### 6.2 å±æ€§è¿ç§»ä¸æ¢å¤


**æ¢å¤æ‰©å±•å±æ€§**ï¼š
```bash
# æ–¹æ³•1ï¼šä½¿ç”¨taræ¢å¤ï¼ˆæ¨èï¼‰
tar --xattrs -xzf /backup/full_backup.tar.gz

# æ–¹æ³•2ï¼šä½¿ç”¨setfattræ‰‹åŠ¨æ¢å¤
# ä»å¤‡ä»½æ–‡ä»¶ä¸­æ¢å¤ç‰¹å®šæ–‡ä»¶çš„å±æ€§
while read line; do
    if [[ $line == "# file:"* ]]; then
        current_file=$(echo $line | cut -d' ' -f3)
    elif [[ $line == user.* ]]; then
        attr_name=$(echo $line | cut -d'=' -f1)
        attr_value=$(echo $line | cut -d'=' -f2-)
        setfattr -n "$attr_name" -v "$attr_value" "$current_file"
    fi
done < /backup/xattr_backup.txt
```

### 6.3 è·¨ç³»ç»Ÿå…¼å®¹æ€§å¤„ç†


**ä¸åŒæ–‡ä»¶ç³»ç»Ÿçš„å…¼å®¹æ€§**ï¼š

| æ–‡ä»¶ç³»ç»Ÿ | **æ”¯æŒç¨‹åº¦** | **æ³¨æ„äº‹é¡¹** |
|----------|-------------|-------------|
| ext4 | âœ… å®Œå…¨æ”¯æŒ | é»˜è®¤å¯ç”¨æ‰©å±•å±æ€§ |
| xfs | âœ… å®Œå…¨æ”¯æŒ | éœ€è¦mountæ—¶å¯ç”¨attr2 |
| btrfs | âœ… å®Œå…¨æ”¯æŒ | åŸç”Ÿæ”¯æŒ |
| ntfs | âš ï¸ éƒ¨åˆ†æ”¯æŒ | éœ€è¦ntfs-3gé©±åŠ¨ |
| fat32 | âŒ ä¸æ”¯æŒ | æ— æ³•å­˜å‚¨æ‰©å±•å±æ€§ |

**è·¨ç³»ç»Ÿè¿ç§»è„šæœ¬**ï¼š
```bash
#!/bin/bash
# æ£€æŸ¥ç›®æ ‡æ–‡ä»¶ç³»ç»Ÿæ˜¯å¦æ”¯æŒæ‰©å±•å±æ€§

check_xattr_support() {
    local file="$1"
    local test_attr="user.test_support"
    
    # å°è¯•è®¾ç½®æµ‹è¯•å±æ€§
    if setfattr -n "$test_attr" -v "test" "$file" 2>/dev/null; then
        # æˆåŠŸè®¾ç½®ï¼Œåˆ é™¤æµ‹è¯•å±æ€§
        setfattr -x "$test_attr" "$file" 2>/dev/null
        echo "æ”¯æŒæ‰©å±•å±æ€§"
        return 0
    else
        echo "ä¸æ”¯æŒæ‰©å±•å±æ€§"
        return 1
    fi
}

# ä½¿ç”¨ç¤ºä¾‹
if check_xattr_support "/mnt/target/test.txt"; then
    echo "å¯ä»¥å®‰å…¨è¿ç§»æ‰©å±•å±æ€§"
else
    echo "è­¦å‘Šï¼šç›®æ ‡æ–‡ä»¶ç³»ç»Ÿä¸æ”¯æŒæ‰©å±•å±æ€§"
fi
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ getfattrï¼šæŸ¥çœ‹æ–‡ä»¶æ‰©å±•å±æ€§çš„ä¸“é—¨å·¥å…·
ğŸ”¸ æ‰©å±•å±æ€§ï¼šæ–‡ä»¶ä¸Šé™„åŠ çš„é¢å¤–æ ‡è®°ä¿¡æ¯
ğŸ”¸ å‘½åç©ºé—´ï¼šuserã€securityã€systemç­‰å±æ€§åˆ†ç±»
ğŸ”¸ è¾“å‡ºæ ¼å¼ï¼šæ™®é€šã€å¯¼å‡ºã€æ–‡æœ¬ã€åå…­è¿›åˆ¶ç­‰æ ¼å¼
ğŸ”¸ æ‰¹é‡æ“ä½œï¼šç»“åˆfindå‘½ä»¤å¤„ç†å¤§é‡æ–‡ä»¶
```

### 7.2 å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨


| ç”¨é€” | **å‘½ä»¤** | **è¯´æ˜** |
|------|----------|----------|
| æŸ¥çœ‹æ‰€æœ‰å±æ€§ | `getfattr -d file` | æ˜¾ç¤ºæ–‡ä»¶çš„å…¨éƒ¨æ‰©å±•å±æ€§ |
| æŸ¥çœ‹ç‰¹å®šå±æ€§ | `getfattr -n user.comment file` | åªæ˜¾ç¤ºæŒ‡å®šå±æ€§ |
| é€’å½’æŸ¥çœ‹ | `getfattr -d -R directory/` | å¤„ç†æ•´ä¸ªç›®å½•æ ‘ |
| å¯¼å‡ºæ ¼å¼ | `getfattr -d --dump file` | ç”Ÿæˆå¯å¯¼å…¥çš„æ ¼å¼ |
| åªæ˜¾ç¤ºå€¼ | `getfattr -n attr --only-values file` | ä»…è¾“å‡ºå±æ€§å€¼ |
| æ‰¹é‡å¤„ç† | `getfattr -d file1 file2 file3` | åŒæ—¶å¤„ç†å¤šä¸ªæ–‡ä»¶ |

### 7.3 å®é™…åº”ç”¨ä»·å€¼


**ä¼ä¸šç¯å¢ƒåº”ç”¨**ï¼š
- **æ–‡ä»¶åˆ†ç±»ç®¡ç†**ï¼šé€šè¿‡å±æ€§æ ‡è®°æ–‡ä»¶ç±»å‹ã€é¡¹ç›®å½’å±
- **å®‰å…¨å®¡è®¡**ï¼šæ£€æŸ¥æ–‡ä»¶çš„å®‰å…¨æ ‡ç­¾å’Œè®¿é—®æ§åˆ¶å±æ€§  
- **å¤‡ä»½ç­–ç•¥**ï¼šæ ‡è®°å¤‡ä»½çŠ¶æ€ã€å¤‡ä»½æ—¶é—´ç­‰ä¿¡æ¯
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šè®°å½•æ–‡ä»¶ç‰ˆæœ¬ã€ä¿®æ”¹è€…ç­‰å…ƒæ•°æ®

**æ—¥å¸¸ä½¿ç”¨åœºæ™¯**ï¼š
- **ä¸ªäººæ–‡ä»¶ç®¡ç†**ï¼šä¸ºé‡è¦æ–‡ä»¶æ·»åŠ å¤‡æ³¨å’Œæ ‡ç­¾
- **é¡¹ç›®å¼€å‘**ï¼šæ ‡è®°æ–‡ä»¶ç”¨é€”ã€é‡è¦ç¨‹åº¦ç­‰ä¿¡æ¯
- **ç³»ç»Ÿç»´æŠ¤**ï¼šæ£€æŸ¥ç³»ç»Ÿæ–‡ä»¶çš„å®Œæ•´æ€§å’Œå±æ€§

> ğŸ“š **å­¦ä¹ è·¯å¾„å»ºè®®**  
> åŸºç¡€é˜¶æ®µï¼šæŒæ¡-då’Œ-né€‰é¡¹ â†’ è¿›é˜¶é˜¶æ®µï¼šå­¦ä¼šæ‰¹é‡å¤„ç† â†’ é«˜çº§é˜¶æ®µï¼šç»“åˆè„šæœ¬è‡ªåŠ¨åŒ–

### 7.4 æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ


âš¡ **æ€§èƒ½æç¤º**ï¼šå¤„ç†å¤§é‡æ–‡ä»¶æ—¶ä¼˜å…ˆä½¿ç”¨-Ré€’å½’é€‰é¡¹  
ğŸ”’ **å®‰å…¨æé†’**ï¼šæ‰©å±•å±æ€§å¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œæ³¨æ„è®¿é—®æƒé™  
ğŸ› **è°ƒè¯•æŠ€å·§**ï¼šä½¿ç”¨2>/dev/nullè¿‡æ»¤é”™è¯¯ä¿¡æ¯ï¼Œä¸“æ³¨äºæœ‰æ•ˆè¾“å‡º  
ğŸ’¡ **æœ€ä½³å®è·µ**ï¼šå®šæœŸå¤‡ä»½é‡è¦æ–‡ä»¶çš„æ‰©å±•å±æ€§ä¿¡æ¯

**è®°å¿†è¦ç‚¹**ï¼š
- getfattræ˜¯"è·å–æ–‡ä»¶å±æ€§"çš„æ„æ€
- -dæ˜¾ç¤ºæ‰€æœ‰ï¼Œ-næ˜¾ç¤ºç‰¹å®šï¼Œ-Ré€’å½’å¤„ç†
- æ‰©å±•å±æ€§å°±åƒæ–‡ä»¶ä¸Šè´´çš„"æ ‡ç­¾çº¸"
- å¤‡ä»½æ—¶åˆ«å¿˜äº†æ‰©å±•å±æ€§ï¼Œä½¿ç”¨tar --xattrsé€‰é¡¹