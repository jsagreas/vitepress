---
title: 6ã€æ–‡ä»¶éšè—å±æ€§é›†æˆç®¡ç†
---
## ğŸ“š ç›®å½•

1. [æ–‡ä»¶éšè—å±æ€§åŸºç¡€æ¦‚å¿µ](#1-æ–‡ä»¶éšè—å±æ€§åŸºç¡€æ¦‚å¿µ)
2. [chattrå‘½ä»¤æ·±åº¦æŒæ¡](#2-chattrå‘½ä»¤æ·±åº¦æŒæ¡)
3. [lsattræŸ¥çœ‹å±æ€§çŠ¶æ€](#3-lsattræŸ¥çœ‹å±æ€§çŠ¶æ€)
4. [æ ¸å¿ƒå±æ€§è¯¦è§£ä¸åº”ç”¨](#4-æ ¸å¿ƒå±æ€§è¯¦è§£ä¸åº”ç”¨)
5. [é«˜çº§å±æ€§ç®¡ç†æŠ€å·§](#5-é«˜çº§å±æ€§ç®¡ç†æŠ€å·§)
6. [éšè—å±æ€§ä¸æ‰©å±•å±æ€§ååŒ](#6-éšè—å±æ€§ä¸æ‰©å±•å±æ€§ååŒ)
7. [å®æˆ˜åº”ç”¨åœºæ™¯](#7-å®æˆ˜åº”ç”¨åœºæ™¯)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” æ–‡ä»¶éšè—å±æ€§åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯æ–‡ä»¶éšè—å±æ€§


**ç®€å•ç†è§£**ï¼šæ–‡ä»¶éšè—å±æ€§å°±åƒç»™æ–‡ä»¶è´´ä¸Šç‰¹æ®Šçš„"æ ‡ç­¾"ï¼Œå‘Šè¯‰ç³»ç»Ÿè¿™ä¸ªæ–‡ä»¶éœ€è¦ç‰¹æ®Šå¯¹å¾…ã€‚

```
æ™®é€šæ–‡ä»¶æƒé™ï¼šrwxrwxrwx ï¼ˆè°èƒ½è¯»ã€å†™ã€æ‰§è¡Œï¼‰
éšè—å±æ€§ï¼šç»™æ–‡ä»¶é¢å¤–çš„"è¶…èƒ½åŠ›"
- è®©æ–‡ä»¶æ— æ³•è¢«åˆ é™¤æˆ–ä¿®æ”¹
- è®©æ–‡ä»¶åªèƒ½è¿½åŠ å†…å®¹ï¼Œä¸èƒ½è¦†ç›–
- è®©ç³»ç»Ÿè‡ªåŠ¨å‹ç¼©æ–‡ä»¶èŠ‚çœç©ºé—´
- è®©æ–‡ä»¶å†™å…¥æ—¶ç«‹å³åŒæ­¥åˆ°ç£ç›˜
```

### 1.2 éšè—å±æ€§ vs æ™®é€šæƒé™


**ä¸¤è€…çš„åŒºåˆ«**ï¼š
```
æ™®é€šæƒé™ï¼ˆchmodï¼‰ï¼š          éšè—å±æ€§ï¼ˆchattrï¼‰ï¼š
æ§åˆ¶"è°"èƒ½åšä»€ä¹ˆ             æ§åˆ¶æ–‡ä»¶"æ€æ ·"è¢«æ“ä½œ
ç”¨æˆ·çº§åˆ«çš„è®¿é—®æ§åˆ¶            ç³»ç»Ÿçº§åˆ«çš„è¡Œä¸ºæ§åˆ¶

ç¤ºä¾‹å¯¹æ¯”ï¼š
chmod 444 file.txt          chattr +i file.txt
â†“                          â†“
æ‰€æœ‰äººåªèƒ½è¯»å–æ–‡ä»¶           å³ä½¿rootä¹Ÿæ— æ³•åˆ é™¤æ–‡ä»¶
ä½†rootä»å¯å¼ºåˆ¶åˆ é™¤          å¿…é¡»å…ˆå»æ‰å±æ€§æ‰èƒ½åˆ é™¤
```

### 1.3 ä¸ºä»€ä¹ˆéœ€è¦éšè—å±æ€§


**å®é™…åº”ç”¨åœºæ™¯**ï¼š
- **ç³»ç»Ÿå®‰å…¨**ï¼šä¿æŠ¤é‡è¦é…ç½®æ–‡ä»¶ä¸è¢«è¯¯åˆ 
- **æ—¥å¿—ç®¡ç†**ï¼šç¡®ä¿æ—¥å¿—æ–‡ä»¶åªèƒ½è¿½åŠ ï¼Œä¸èƒ½ç¯¡æ”¹
- **å­˜å‚¨ä¼˜åŒ–**ï¼šè‡ªåŠ¨å‹ç¼©ä¸å¸¸ç”¨æ–‡ä»¶èŠ‚çœç©ºé—´
- **æ•°æ®å®Œæ•´æ€§**ï¼šå¼ºåˆ¶åŒæ­¥å†™å…¥ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±

---

## 2. ğŸ› ï¸ chattrå‘½ä»¤æ·±åº¦æŒæ¡


### 2.1 chattråŸºæœ¬è¯­æ³•


**å‘½ä»¤æ ¼å¼**ï¼š`chattr [é€‰é¡¹] [Â±=å±æ€§] æ–‡ä»¶æˆ–ç›®å½•`

```bash
# åŸºæœ¬è¯­æ³•è¯´æ˜
chattr +i file.txt    # æ·»åŠ ä¸å¯å˜å±æ€§
chattr -i file.txt    # ç§»é™¤ä¸å¯å˜å±æ€§  
chattr =i file.txt    # è®¾ç½®ä¸ºåªæœ‰ä¸å¯å˜å±æ€§ï¼ˆæ¸…é™¤å…¶ä»–ï¼‰

# ç¬¦å·å«ä¹‰
+  æ·»åŠ å±æ€§
-  ç§»é™¤å±æ€§
=  ç²¾ç¡®è®¾ç½®ï¼ˆæ¸…é™¤å…¶ä»–å±æ€§ï¼‰
```

### 2.2 chattrå¸¸ç”¨é€‰é¡¹


| é€‰é¡¹ | **ä½œç”¨** | **ä½¿ç”¨åœºæ™¯** |
|------|----------|-------------|
| `-R` | `é€’å½’æ“ä½œç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶` | `æ‰¹é‡è®¾ç½®ç›®å½•å±æ€§` |
| `-V` | `æ˜¾ç¤ºè¯¦ç»†æ“ä½œè¿‡ç¨‹` | `è°ƒè¯•å’Œç¡®è®¤æ“ä½œ` |
| `-v` | `è®¾ç½®æ–‡ä»¶ç‰ˆæœ¬å·` | `æ–‡ä»¶ç‰ˆæœ¬ç®¡ç†` |

**å®ç”¨ç¤ºä¾‹**ï¼š
```bash
# é€’å½’è®¾ç½®ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ä¸ºä¸å¯å˜
chattr -R +i /important/configs/

# æ˜¾ç¤ºè¯¦ç»†æ“ä½œè¿‡ç¨‹
chattr -V +a /var/log/application.log

# è®¾ç½®æ–‡ä»¶ç‰ˆæœ¬
chattr -v 20250914 document.txt
```

### 2.3 å±æ€§ç»„åˆä½¿ç”¨


**å¤šå±æ€§è®¾ç½®**ï¼š
```bash
# åŒæ—¶è®¾ç½®å¤šä¸ªå±æ€§
chattr +ia file.txt        # ä¸å¯å˜ + åªè¿½åŠ 
chattr +cS backup.tar      # å‹ç¼© + åŒæ­¥å†™å…¥
chattr +d +s sensitive.doc # ç›®å½•é»˜è®¤ + å®‰å…¨åˆ é™¤

# é€æ­¥æ“ä½œ
chattr +i file.txt    # å…ˆè®¾ç½®ä¸å¯å˜
chattr +a file.txt    # å†æ·»åŠ åªè¿½åŠ ï¼ˆåŒæ—¶å…·æœ‰ä¸¤ç§å±æ€§ï¼‰
```

---

## 3. ğŸ‘€ lsattræŸ¥çœ‹å±æ€§çŠ¶æ€


### 3.1 lsattråŸºæœ¬ç”¨æ³•


**æŸ¥çœ‹æ–‡ä»¶å±æ€§**ï¼š
```bash
# æŸ¥çœ‹å•ä¸ªæ–‡ä»¶
lsattr file.txt
# è¾“å‡ºç¤ºä¾‹ï¼š----i---------e----- file.txt

# æŸ¥çœ‹ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶
lsattr /etc/
# è¾“å‡ºæ¯ä¸ªæ–‡ä»¶çš„å±æ€§çŠ¶æ€
```

### 3.2 lsattré€‰é¡¹è¯¦è§£


| é€‰é¡¹ | **åŠŸèƒ½** | **è¾“å‡ºæ•ˆæœ** |
|------|----------|-------------|
| `-a` | `æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬éšè—æ–‡ä»¶ï¼‰` | `åˆ—å‡º.å¼€å¤´çš„æ–‡ä»¶å±æ€§` |
| `-d` | `åªæ˜¾ç¤ºç›®å½•æœ¬èº«å±æ€§` | `ä¸æ˜¾ç¤ºç›®å½•å†…å®¹` |
| `-R` | `é€’å½’æ˜¾ç¤ºå­ç›®å½•` | `éå†æ‰€æœ‰å­ç›®å½•` |
| `-v` | `æ˜¾ç¤ºæ–‡ä»¶ç‰ˆæœ¬å·` | `é¢å¤–æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯` |

**å®ç”¨ç¤ºä¾‹**ï¼š
```bash
# æŸ¥çœ‹æ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬éšè—æ–‡ä»¶ï¼‰
lsattr -a /home/user/

# åªæŸ¥çœ‹ç›®å½•å±æ€§ï¼Œä¸æ˜¾ç¤ºå†…å®¹
lsattr -d /var/log/

# é€’å½’æŸ¥çœ‹æ‰€æœ‰å­ç›®å½•
lsattr -R /etc/

# æ˜¾ç¤ºç‰ˆæœ¬å·
lsattr -v important.txt
```

### 3.3 å±æ€§æ ‡è¯†ç¬¦è§£è¯»


**å¸¸è§å±æ€§æ ‡è¯†**ï¼š
```
è¾“å‡ºæ ¼å¼ï¼š----i---------e----- filename
          ||||||||||||||||
          å„ä½ç½®ä»£è¡¨ä¸åŒå±æ€§

å¸¸è§æ ‡è¯†ç¬¦ï¼š
i = immutableï¼ˆä¸å¯å˜ï¼‰
a = append onlyï¼ˆåªè¿½åŠ ï¼‰
c = compressedï¼ˆå‹ç¼©ï¼‰
s = secure deletionï¼ˆå®‰å…¨åˆ é™¤ï¼‰
S = synchronous updatesï¼ˆåŒæ­¥æ›´æ–°ï¼‰
d = no dumpï¼ˆå¤‡ä»½æ—¶å¿½ç•¥ï¼‰
e = extents formatï¼ˆæ‰©å±•æ ¼å¼ï¼Œext4é»˜è®¤ï¼‰
```

---

## 4. ğŸ”’ æ ¸å¿ƒå±æ€§è¯¦è§£ä¸åº”ç”¨


### 4.1 ä¸å¯å˜å±æ€§ï¼ˆ+iï¼‰- æœ€å¼ºä¿æŠ¤


**ä½œç”¨æœºåˆ¶**ï¼šè®¾ç½®åæ–‡ä»¶æ— æ³•è¢«ä¿®æ”¹ã€åˆ é™¤ã€é‡å‘½åæˆ–åˆ›å»ºé“¾æ¥ã€‚

```bash
# è®¾ç½®ä¸å¯å˜å±æ€§
echo "é‡è¦é…ç½®" > config.txt
chattr +i config.txt

# éªŒè¯ä¿æŠ¤æ•ˆæœ
rm config.txt           # å¤±è´¥ï¼šOperation not permitted
echo "hack" > config.txt # å¤±è´¥ï¼šOperation not permitted
mv config.txt new.txt   # å¤±è´¥ï¼šOperation not permitted

# è¿rootéƒ½æ— æ³•å¼ºåˆ¶åˆ é™¤
sudo rm -f config.txt   # ä»ç„¶å¤±è´¥ï¼

# å¿…é¡»å…ˆç§»é™¤å±æ€§æ‰èƒ½æ“ä½œ
chattr -i config.txt
rm config.txt           # ç°åœ¨å¯ä»¥åˆ é™¤äº†
```

**å®é™…åº”ç”¨åœºæ™¯**ï¼š
- **ç³»ç»Ÿé…ç½®æ–‡ä»¶**ï¼š`/etc/fstab`, `/etc/passwd`
- **é‡è¦è„šæœ¬**ï¼šå¯åŠ¨è„šæœ¬ã€å¤‡ä»½è„šæœ¬
- **è¯ä¹¦æ–‡ä»¶**ï¼šSSLè¯ä¹¦ã€å¯†é’¥æ–‡ä»¶

### 4.2 åªè¿½åŠ å±æ€§ï¼ˆ+aï¼‰- æ—¥å¿—ä¿æŠ¤ç¥å™¨


**ä½œç”¨æœºåˆ¶**ï¼šæ–‡ä»¶åªèƒ½è¿½åŠ å†…å®¹ï¼Œä¸èƒ½ä¿®æ”¹ç°æœ‰å†…å®¹æˆ–åˆ é™¤ã€‚

```bash
# åˆ›å»ºæ—¥å¿—æ–‡ä»¶å¹¶è®¾ç½®åªè¿½åŠ 
touch application.log
chattr +a application.log

# å¯ä»¥è¿½åŠ å†…å®¹
echo "æ–°æ—¥å¿—æ¡ç›®" >> application.log  # âœ… æˆåŠŸ
echo "å¦ä¸€æ¡æ—¥å¿—" >> application.log  # âœ… æˆåŠŸ

# æ— æ³•è¦†ç›–æˆ–ä¿®æ”¹
echo "è¦†ç›–å†…å®¹" > application.log    # âŒ å¤±è´¥
vim application.log                  # âŒ æ— æ³•ä¿å­˜ä¿®æ”¹

# æŸ¥çœ‹æ—¥å¿—å†…å®¹æ­£å¸¸
cat application.log                  # âœ… å¯ä»¥æŸ¥çœ‹
tail -f application.log             # âœ… å¯ä»¥ç›‘æ§
```

**åº”ç”¨åœºæ™¯è§£æ**ï¼š
```
ç³»ç»Ÿæ—¥å¿—ä¿æŠ¤ï¼š
/var/log/messages     ç³»ç»Ÿæ¶ˆæ¯æ—¥å¿—
/var/log/secure      å®‰å…¨æ—¥å¿—
/var/log/audit.log   å®¡è®¡æ—¥å¿—

åº”ç”¨æ—¥å¿—ä¿æŠ¤ï¼š
/var/log/apache2/access.log   Webè®¿é—®æ—¥å¿—
/var/log/mysql/mysql.log      æ•°æ®åº“æ—¥å¿—
~/app/logs/application.log    åº”ç”¨ç¨‹åºæ—¥å¿—
```

### 4.3 å‹ç¼©å±æ€§ï¼ˆ+cï¼‰- å­˜å‚¨ä¼˜åŒ–


**ä½œç”¨æœºåˆ¶**ï¼šç³»ç»Ÿè‡ªåŠ¨å‹ç¼©æ–‡ä»¶ï¼Œè¯»å–æ—¶è‡ªåŠ¨è§£å‹ï¼ˆé€æ˜å‹ç¼©ï¼‰ã€‚

```bash
# åˆ›å»ºå¤§æ–‡ä»¶æµ‹è¯•
dd if=/dev/zero of=bigfile.txt bs=1M count=100  # åˆ›å»º100MBæ–‡ä»¶
ls -lh bigfile.txt  # æŸ¥çœ‹åŸå§‹å¤§å°

# è®¾ç½®å‹ç¼©å±æ€§
chattr +c bigfile.txt
ls -lh bigfile.txt  # å¤§å°å¯èƒ½å˜å°ï¼ˆå–å†³äºæ–‡ä»¶ç³»ç»Ÿæ”¯æŒï¼‰

# ä½¿ç”¨å®Œå…¨é€æ˜ï¼Œæ— éœ€æ‰‹åŠ¨è§£å‹
cat bigfile.txt > /dev/null  # æ­£å¸¸è¯»å–
echo "æ–°å†…å®¹" >> bigfile.txt  # æ­£å¸¸å†™å…¥
```

**æ³¨æ„äº‹é¡¹**ï¼š
```
æ–‡ä»¶ç³»ç»Ÿæ”¯æŒï¼š
âœ… Btrfsï¼šå®Œå…¨æ”¯æŒé€æ˜å‹ç¼©
âœ… ZFSï¼šæ”¯æŒå‹ç¼©
âŒ ext4ï¼šå±æ€§å­˜åœ¨ä½†é€šå¸¸ä¸èµ·å®é™…ä½œç”¨
âŒ XFSï¼šä¸æ”¯æŒæ­¤å±æ€§

ä½¿ç”¨å»ºè®®ï¼š
- å¤§å‹å½’æ¡£æ–‡ä»¶
- æ—¥å¿—æ–‡ä»¶ï¼ˆé…åˆ+aä½¿ç”¨ï¼‰
- å¤‡ä»½æ–‡ä»¶
```

### 4.4 åŒæ­¥å†™å…¥å±æ€§ï¼ˆ+Sï¼‰- æ•°æ®å®‰å…¨ä¿éšœ


**ä½œç”¨æœºåˆ¶**ï¼šå†™å…¥æ“ä½œç«‹å³åŒæ­¥åˆ°ç£ç›˜ï¼Œä¸ä½¿ç”¨ç¼“å­˜ã€‚

```bash
# è®¾ç½®åŒæ­¥å†™å…¥
chattr +S critical-data.txt

# å†™å…¥æ“ä½œå°†ç«‹å³åŒæ­¥
echo "é‡è¦æ•°æ®" > critical-data.txt  # ç«‹å³å†™å…¥ç£ç›˜ï¼Œä¸ç»è¿‡ç¼“å­˜

# å¯¹æ¯”æ™®é€šæ–‡ä»¶çš„å»¶è¿Ÿå†™å…¥
echo "æ™®é€šæ•°æ®" > normal-data.txt    # å¯èƒ½æš‚å­˜åœ¨å†…å­˜ç¼“å­˜ä¸­
sync  # æ‰‹åŠ¨åŒæ­¥æ‰€æœ‰ç¼“å­˜åˆ°ç£ç›˜
```

**æ€§èƒ½ä¸å®‰å…¨æƒè¡¡**ï¼š
```
ä¼˜åŠ¿ï¼š
âœ… æ•°æ®å³æ—¶å®‰å…¨ï¼Œæ–­ç”µä¸ä¸¢å¤±
âœ… å…³é”®æ–‡ä»¶çš„å®Œæ•´æ€§ä¿éšœ
âœ… é€‚åˆæ•°æ®åº“æ–‡ä»¶ã€é…ç½®æ–‡ä»¶

åŠ£åŠ¿ï¼š
âŒ å†™å…¥æ€§èƒ½æ˜¾è‘—ä¸‹é™
âŒ å¢åŠ ç£ç›˜I/Oè´Ÿæ‹…
âŒ ä¸é€‚åˆé¢‘ç¹å†™å…¥çš„æ–‡ä»¶

ä½¿ç”¨åœºæ™¯ï¼š
- æ•°æ®åº“äº‹åŠ¡æ—¥å¿—
- é‡è¦é…ç½®æ–‡ä»¶
- é‡‘èäº¤æ˜“è®°å½•
```

### 4.5 å®‰å…¨åˆ é™¤å±æ€§ï¼ˆ+sï¼‰- æ•°æ®å½»åº•æ¸…é™¤


**ä½œç”¨æœºåˆ¶**ï¼šåˆ é™¤æ–‡ä»¶æ—¶ï¼Œç³»ç»Ÿç”¨é›¶è¦†ç›–ç£ç›˜ç©ºé—´ï¼Œé˜²æ­¢æ•°æ®æ¢å¤ã€‚

```bash
# åˆ›å»ºæ•æ„Ÿæ–‡ä»¶
echo "æœºå¯†ä¿¡æ¯: å¯†ç 123456" > secret.txt
chattr +s secret.txt

# æ­£å¸¸ä½¿ç”¨
cat secret.txt  # å¯ä»¥æ­£å¸¸è¯»å–

# åˆ é™¤æ—¶ä¼šå®‰å…¨æ“¦é™¤
rm secret.txt   # ç£ç›˜ç©ºé—´è¢«é›¶è¦†ç›–ï¼Œæ— æ³•æ¢å¤

# å¯¹æ¯”ï¼šæ™®é€šåˆ é™¤
echo "æ™®é€šä¿¡æ¯" > normal.txt
rm normal.txt   # ä»…åˆ é™¤ç›®å½•é¡¹ï¼Œæ•°æ®å¯èƒ½è¢«æ¢å¤å·¥å…·æ‰¾å›
```

**å®‰å…¨çº§åˆ«å¯¹æ¯”**ï¼š
```
æ™®é€šåˆ é™¤ï¼ˆrmï¼‰ï¼š
- åªåˆ é™¤æ–‡ä»¶ç³»ç»Ÿç›®å½•é¡¹
- æ•°æ®å—ä»åœ¨ç£ç›˜ä¸Š
- å¯ç”¨å·¥å…·æ¢å¤

å®‰å…¨åˆ é™¤ï¼ˆ+så±æ€§ï¼‰ï¼š
- åˆ é™¤å‰ç”¨é›¶è¦†ç›–æ•°æ®å—  
- å¤§å¹…å¢åŠ æ¢å¤éš¾åº¦
- é€‚åˆæ•æ„Ÿæ•°æ®å¤„ç†

ä¸“ä¸šå·¥å…·ï¼ˆshredï¼‰ï¼š
- å¤šæ¬¡è¦†ç›–ï¼ˆéšæœºæ•°æ®ï¼‰
- æ›´é«˜å®‰å…¨çº§åˆ«
- ä½†+så±æ€§æ›´ä¾¿äºæ‰¹é‡ç®¡ç†
```

---

## 5. ğŸ¯ é«˜çº§å±æ€§ç®¡ç†æŠ€å·§


### 5.1 å±æ€§ç»§æ‰¿ï¼ˆ+dï¼‰- ç›®å½•ç®¡ç†


**ä½œç”¨æœºåˆ¶**ï¼šè®¾ç½®åœ¨ç›®å½•ä¸Šï¼Œæ–°åˆ›å»ºçš„æ–‡ä»¶ä¸ä¼šè¢«dumpå‘½ä»¤å¤‡ä»½ã€‚

```bash
# åˆ›å»ºä¸´æ—¶æ–‡ä»¶ç›®å½•
mkdir /tmp/cache
chattr +d /tmp/cache

# åœ¨ç›®å½•ä¸­åˆ›å»ºæ–‡ä»¶
touch /tmp/cache/temp1.txt
touch /tmp/cache/temp2.txt

# æ£€æŸ¥å±æ€§ç»§æ‰¿
lsattr /tmp/cache/
lsattr /tmp/cache/*

# dumpå‘½ä»¤ä¼šè·³è¿‡è¿™äº›æ–‡ä»¶
dump -0 -f backup.dump /  # å¤‡ä»½æ—¶å¿½ç•¥+då±æ€§çš„æ–‡ä»¶
```

### 5.2 æ‰¹é‡å±æ€§ç®¡ç†


**ç›®å½•é€’å½’æ“ä½œ**ï¼š
```bash
# ä¿æŠ¤æ•´ä¸ªé…ç½®ç›®å½•
chattr -R +i /etc/important-configs/

# è®¾ç½®æ—¥å¿—ç›®å½•ä¸ºåªè¿½åŠ 
find /var/log -name "*.log" -exec chattr +a {} \;

# æ‰¹é‡ç§»é™¤å±æ€§ï¼ˆç»´æŠ¤æ—¶ä½¿ç”¨ï¼‰
chattr -R -i /etc/important-configs/
# æ‰§è¡Œç»´æŠ¤æ“ä½œ...
chattr -R +i /etc/important-configs/  # é‡æ–°ä¿æŠ¤
```

### 5.3 å±æ€§ç»„åˆç­–ç•¥


**æ™ºèƒ½ç»„åˆåº”ç”¨**ï¼š
```bash
# ç³»ç»Ÿæ—¥å¿—ï¼šåªè¿½åŠ  + å®‰å…¨åˆ é™¤
chattr +as /var/log/secure

# é…ç½®å¤‡ä»½ï¼šä¸å¯å˜ + å‹ç¼© + åŒæ­¥
chattr +icS /backup/system-configs.tar

# ä¸´æ—¶ç¼“å­˜ï¼šå‹ç¼© + ä¸å¤‡ä»½
chattr +cd /var/cache/application/*
```

---

## 6. ğŸ”— éšè—å±æ€§ä¸æ‰©å±•å±æ€§ååŒ


### 6.1 ä¸¤ç§å±æ€§çš„åŒºåˆ«


**åŠŸèƒ½å¯¹æ¯”**ï¼š
```
éšè—å±æ€§ï¼ˆchattr/lsattrï¼‰ï¼š     æ‰©å±•å±æ€§ï¼ˆsetfattr/getfattrï¼‰ï¼š
ç³»ç»Ÿçº§è¡Œä¸ºæ§åˆ¶                 ç”¨æˆ·è‡ªå®šä¹‰å…ƒæ•°æ®å­˜å‚¨
å½±å“æ–‡ä»¶æ“ä½œæ–¹å¼               ä¸å½±å“æ–‡ä»¶æ“ä½œ
å›ºå®šçš„å±æ€§ç±»å‹                 çµæ´»çš„é”®å€¼å¯¹
å†…æ ¸çº§å®ç°                    æ–‡ä»¶ç³»ç»Ÿçº§å®ç°
```

### 6.2 ååŒä½¿ç”¨åœºæ™¯


**ç»„åˆåº”ç”¨ç¤ºä¾‹**ï¼š
```bash
# åˆ›å»ºé‡è¦æ–‡æ¡£
echo "æœºå¯†æ–‡æ¡£å†…å®¹" > document.txt

# è®¾ç½®éšè—å±æ€§ï¼ˆè¡Œä¸ºæ§åˆ¶ï¼‰
chattr +is document.txt  # ä¸å¯å˜ + å®‰å…¨åˆ é™¤

# è®¾ç½®æ‰©å±•å±æ€§ï¼ˆå…ƒæ•°æ®æ ‡è®°ï¼‰
setfattr -n user.classification -v "top-secret" document.txt
setfattr -n user.owner -v "security-team" document.txt  
setfattr -n user.created -v "$(date)" document.txt

# æŸ¥çœ‹å®Œæ•´å±æ€§ä¿¡æ¯
echo "=== éšè—å±æ€§ ==="
lsattr document.txt

echo "=== æ‰©å±•å±æ€§ ==="
getfattr -d document.txt

echo "=== æ™®é€šæƒé™ ==="
ls -l document.txt
```

### 6.3 å±æ€§ç®¡ç†è„šæœ¬


```bash
#!/bin/bash
# æ–‡ä»¶å±æ€§ç®¡ç†è„šæœ¬

function secure_file() {
    local file="$1"
    local classification="$2"
    
    # è®¾ç½®éšè—å±æ€§
    chattr +is "$file"
    
    # è®¾ç½®æ‰©å±•å±æ€§
    setfattr -n user.classification -v "$classification" "$file"
    setfattr -n user.secured_date -v "$(date)" "$file"
    
    echo "æ–‡ä»¶ $file å·²åŠ å›ºï¼Œåˆ†ç±»çº§åˆ«ï¼š$classification"
}

function unsecure_file() {
    local file="$1"
    
    # ç§»é™¤éšè—å±æ€§
    chattr -is "$file"
    
    echo "æ–‡ä»¶ $file ä¿æŠ¤å·²è§£é™¤"
}

# ä½¿ç”¨ç¤ºä¾‹
secure_file "important.txt" "confidential"
```

---

## 7. ğŸ’¼ å®æˆ˜åº”ç”¨åœºæ™¯


### 7.1 ç³»ç»Ÿå®‰å…¨åŠ å›º


**å…³é”®ç³»ç»Ÿæ–‡ä»¶ä¿æŠ¤**ï¼š
```bash
#!/bin/bash
# ç³»ç»Ÿå®‰å…¨åŠ å›ºè„šæœ¬

echo "å¼€å§‹ç³»ç»Ÿå®‰å…¨åŠ å›º..."

# ä¿æŠ¤å…³é”®é…ç½®æ–‡ä»¶
critical_files=(
    "/etc/passwd"
    "/etc/shadow"  
    "/etc/group"
    "/etc/fstab"
    "/etc/sudoers"
    "/boot/grub/grub.cfg"
)

for file in "${critical_files[@]}"; do
    if [[ -f "$file" ]]; then
        chattr +i "$file"
        echo "å·²ä¿æŠ¤ï¼š$file"
    fi
done

# ä¿æŠ¤ç³»ç»Ÿå¯åŠ¨ç›®å½•
chattr -R +i /boot/

echo "ç³»ç»ŸåŠ å›ºå®Œæˆï¼"
echo "å¦‚éœ€ä¿®æ”¹ç³»ç»Ÿæ–‡ä»¶ï¼Œè¯·å…ˆè¿è¡Œï¼šchattr -i ç›®æ ‡æ–‡ä»¶"
```

### 7.2 æ—¥å¿—ç®¡ç†ç³»ç»Ÿ


**æ—¥å¿—æ–‡ä»¶ä¸“ä¸šç®¡ç†**ï¼š
```bash
#!/bin/bash
# æ—¥å¿—ç®¡ç†è„šæœ¬

function setup_log_protection() {
    local log_dir="$1"
    
    echo "è®¾ç½®æ—¥å¿—ç›®å½•ä¿æŠ¤ï¼š$log_dir"
    
    # æŸ¥æ‰¾æ‰€æœ‰æ—¥å¿—æ–‡ä»¶
    find "$log_dir" -name "*.log" | while read logfile; do
        # è®¾ç½®åªè¿½åŠ å±æ€§
        chattr +a "$logfile"
        
        # æ·»åŠ æ‰©å±•å±æ€§æ ‡è®°
        setfattr -n user.log_type -v "system" "$logfile"
        setfattr -n user.protected_date -v "$(date)" "$logfile"
        
        echo "å·²ä¿æŠ¤æ—¥å¿—æ–‡ä»¶ï¼š$logfile"
    done
}

# ä¿æŠ¤ä¸»è¦æ—¥å¿—ç›®å½•
setup_log_protection "/var/log"

# åˆ›å»ºæ—¥å¿—è½®è½¬å…¼å®¹çš„æ–°æ—¥å¿—æ–‡ä»¶å‡½æ•°
function create_protected_log() {
    local logfile="$1"
    touch "$logfile"
    chmod 644 "$logfile"
    chattr +a "$logfile"
    echo "åˆ›å»ºå—ä¿æŠ¤çš„æ—¥å¿—æ–‡ä»¶ï¼š$logfile"
}
```

### 7.3 å¤‡ä»½æ–‡ä»¶ç®¡ç†


**å¤‡ä»½æ•°æ®ä¿æŠ¤ç­–ç•¥**ï¼š
```bash
#!/bin/bash
# å¤‡ä»½æ–‡ä»¶ç®¡ç†è„šæœ¬

function protect_backup() {
    local backup_file="$1"
    local backup_type="$2"
    
    # æ ¹æ®å¤‡ä»½ç±»å‹è®¾ç½®ä¸åŒä¿æŠ¤ç­–ç•¥
    case "$backup_type" in
        "system")
            # ç³»ç»Ÿå¤‡ä»½ï¼šä¸å¯å˜ + å‹ç¼© + åŒæ­¥
            chattr +icS "$backup_file"
            ;;
        "database")  
            # æ•°æ®åº“å¤‡ä»½ï¼šä¸å¯å˜ + åŒæ­¥ + å®‰å…¨åˆ é™¤
            chattr +iSs "$backup_file"
            ;;
        "archive")
            # å½’æ¡£å¤‡ä»½ï¼šä¸å¯å˜ + å‹ç¼© + ä¸å¤‡ä»½
            chattr +icd "$backup_file"
            ;;
    esac
    
    # è®¾ç½®å¤‡ä»½å…ƒæ•°æ®
    setfattr -n user.backup_type -v "$backup_type" "$backup_file"
    setfattr -n user.backup_date -v "$(date)" "$backup_file"
    setfattr -n user.checksum -v "$(md5sum "$backup_file" | cut -d' ' -f1)" "$backup_file"
    
    echo "å¤‡ä»½æ–‡ä»¶å·²ä¿æŠ¤ï¼š$backup_file (ç±»å‹ï¼š$backup_type)"
}

# ä½¿ç”¨ç¤ºä¾‹
protect_backup "/backup/system-20250914.tar.gz" "system"
protect_backup "/backup/database-20250914.sql.gz" "database"
protect_backup "/archive/old-data-20250914.tar.gz" "archive"
```

### 7.4 å¼€å‘ç¯å¢ƒé…ç½®


**é¡¹ç›®é…ç½®æ–‡ä»¶ä¿æŠ¤**ï¼š
```bash
#!/bin/bash
# å¼€å‘é¡¹ç›®é…ç½®ä¿æŠ¤

function protect_project_config() {
    local project_dir="$1"
    
    echo "ä¿æŠ¤é¡¹ç›®é…ç½®ï¼š$project_dir"
    
    # ä¿æŠ¤é‡è¦é…ç½®æ–‡ä»¶
    config_files=(
        ".env"
        ".env.production"  
        "docker-compose.yml"
        "Dockerfile"
        "package.json"
        "requirements.txt"
    )
    
    for config in "${config_files[@]}"; do
        if [[ -f "$project_dir/$config" ]]; then
            # è®¾ç½®ä¸å¯å˜å±æ€§
            chattr +i "$project_dir/$config"
            
            # æ·»åŠ é¡¹ç›®å…ƒæ•°æ®
            setfattr -n user.project_config -v "protected" "$project_dir/$config"
            setfattr -n user.protection_date -v "$(date)" "$project_dir/$config"
            
            echo "å·²ä¿æŠ¤é…ç½®æ–‡ä»¶ï¼š$config"
        fi
    done
    
    echo "é¡¹ç›®é…ç½®ä¿æŠ¤å®Œæˆï¼"
    echo "ä¿®æ”¹é…ç½®å‰è¯·è¿è¡Œï¼šchattr -i é…ç½®æ–‡ä»¶å"
}

# ä¿æŠ¤å½“å‰é¡¹ç›®
protect_project_config "$(pwd)"
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ éšè—å±æ€§æœ¬è´¨ï¼šç³»ç»Ÿçº§çš„æ–‡ä»¶è¡Œä¸ºæ§åˆ¶æœºåˆ¶
ğŸ”¸ chattrå‘½ä»¤ï¼šè®¾ç½®å’Œä¿®æ”¹æ–‡ä»¶éšè—å±æ€§
ğŸ”¸ lsattrå‘½ä»¤ï¼šæŸ¥çœ‹æ–‡ä»¶å½“å‰å±æ€§çŠ¶æ€  
ğŸ”¸ æ ¸å¿ƒå±æ€§ï¼ši(ä¸å¯å˜)ã€a(åªè¿½åŠ )ã€c(å‹ç¼©)ã€S(åŒæ­¥)ã€s(å®‰å…¨åˆ é™¤)
ğŸ”¸ åº”ç”¨åœºæ™¯ï¼šç³»ç»Ÿå®‰å…¨ã€æ—¥å¿—ä¿æŠ¤ã€å­˜å‚¨ä¼˜åŒ–ã€æ•°æ®å®Œæ•´æ€§
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ å±æ€§ä¸æƒé™çš„å…³ç³»**
```
æ™®é€šæƒé™ï¼šæ§åˆ¶"è°"èƒ½è®¿é—®
éšè—å±æ€§ï¼šæ§åˆ¶æ–‡ä»¶"å¦‚ä½•"è¢«æ“ä½œ
ä¸¤è€…äº’è¡¥ï¼Œå…±åŒæ„å»ºå®Œæ•´çš„å®‰å…¨ä½“ç³»
```

**ğŸ”¹ ä¸åŒå±æ€§çš„é€‚ç”¨åœºæ™¯**
```
+i ä¸å¯å˜ï¼šç³»ç»Ÿé…ç½®ã€é‡è¦è„šæœ¬ã€è¯ä¹¦æ–‡ä»¶
+a åªè¿½åŠ ï¼šå„ç±»æ—¥å¿—æ–‡ä»¶ã€å®¡è®¡è®°å½•
+c å‹ç¼©ï¼šå¤§å‹å½’æ¡£ã€å¤‡ä»½æ–‡ä»¶ï¼ˆéœ€æ–‡ä»¶ç³»ç»Ÿæ”¯æŒï¼‰
+S åŒæ­¥ï¼šæ•°æ®åº“æ–‡ä»¶ã€å…³é”®é…ç½®
+s å®‰å…¨åˆ é™¤ï¼šæ•æ„Ÿæ•°æ®ã€æœºå¯†æ–‡æ¡£
```

**ğŸ”¹ ç®¡ç†ç»´æŠ¤ç­–ç•¥**
```
è®¾ç½®å‰å¤‡ä»½ï¼šé‡è¦æ“ä½œå‰å…ˆå¤‡ä»½
æ–‡æ¡£è®°å½•ï¼šè®°å½•å“ªäº›æ–‡ä»¶è®¾ç½®äº†ä»€ä¹ˆå±æ€§
å®šæœŸæ£€æŸ¥ï¼šä½¿ç”¨lsattrå®šæœŸæ£€æŸ¥å±æ€§çŠ¶æ€
ç»´æŠ¤çª—å£ï¼šè®¡åˆ’ç»´æŠ¤æ—¶æ‰¹é‡ç®¡ç†å±æ€§
```

### 8.3 å®é™…åº”ç”¨ä»·å€¼


**ç³»ç»Ÿç®¡ç†å‘˜è§†è§’**ï¼š
- **å®‰å…¨é˜²æŠ¤**ï¼šé˜²æ­¢é‡è¦æ–‡ä»¶è¢«è¯¯æ“ä½œæˆ–æ¶æ„ç¯¡æ”¹
- **æ—¥å¿—å®Œæ•´æ€§**ï¼šç¡®ä¿ç³»ç»Ÿæ—¥å¿—ä¸è¢«ç¯¡æ”¹ï¼Œæ»¡è¶³åˆè§„è¦æ±‚
- **è‡ªåŠ¨åŒ–ç®¡ç†**ï¼šç»“åˆè„šæœ¬å®ç°æ‰¹é‡æ–‡ä»¶ä¿æŠ¤
- **æ•…éšœé¢„é˜²**ï¼šå‡å°‘äººä¸ºé”™è¯¯å¯¼è‡´çš„ç³»ç»Ÿæ•…éšœ

**è¿ç»´å·¥ç¨‹å¸ˆè§†è§’**ï¼š
- **é…ç½®ç®¡ç†**ï¼šä¿æŠ¤ç”Ÿäº§ç¯å¢ƒå…³é”®é…ç½®ä¸è¢«æ„å¤–ä¿®æ”¹
- **å¤‡ä»½ç­–ç•¥**ï¼šä¼˜åŒ–å­˜å‚¨ä½¿ç”¨ï¼Œç¡®ä¿å¤‡ä»½æ–‡ä»¶å®Œæ•´æ€§
- **ç›‘æ§å®¡è®¡**ï¼šé…åˆæ—¥å¿—ç³»ç»Ÿå®ç°å®Œæ•´çš„æ“ä½œå®¡è®¡
- **åº”æ€¥å“åº”**ï¼šå¿«é€Ÿè¯†åˆ«å’Œä¿æŠ¤å…³é”®ç³»ç»Ÿæ–‡ä»¶

### 8.4 æœ€ä½³å®è·µå»ºè®®


**ğŸ”¹ æ—¥å¸¸æ“ä½œè§„èŒƒ**
```bash
# æ“ä½œå‰æ£€æŸ¥
lsattr file.txt                    # æŸ¥çœ‹å½“å‰å±æ€§
ls -l file.txt                     # æŸ¥çœ‹æ™®é€šæƒé™

# å®‰å…¨æ“ä½œæµç¨‹
cp file.txt file.txt.backup        # æ“ä½œå‰å¤‡ä»½
chattr -i file.txt                 # ä¸´æ—¶ç§»é™¤ä¿æŠ¤
# æ‰§è¡Œå¿…è¦ä¿®æ”¹...
chattr +i file.txt                 # é‡æ–°å¯ç”¨ä¿æŠ¤

# æ‰¹é‡æ“ä½œéªŒè¯
lsattr /etc/important/*            # ç¡®è®¤æ‰¹é‡æ“ä½œç»“æœ
```

**ğŸ”¹ è„šæœ¬åŒ–ç®¡ç†**
```bash
# åˆ›å»ºå±æ€§ç®¡ç†å‡½æ•°
function file_protect() {
    local action="$1"  # protect/unprotect
    local file="$2"
    
    case "$action" in
        "protect")
            chattr +i "$file" && echo "å·²ä¿æŠ¤ï¼š$file"
            ;;
        "unprotect")
            chattr -i "$file" && echo "å·²è§£é™¤ä¿æŠ¤ï¼š$file"
            ;;
    esac
}

# ä½¿ç”¨ç¤ºä¾‹
file_protect protect /etc/passwd
file_protect unprotect /etc/passwd
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- **chattrè®¾å±æ€§ï¼Œlsattræ¥æŸ¥çœ‹**
- **iè®©æ–‡ä»¶ä¸å¯å˜ï¼Œaè®©æ—¥å¿—åªè¿½åŠ **
- **SåŒæ­¥å†™å®‰å…¨ï¼Œsåˆ é™¤æ›´å½»åº•**
- **æƒé™æ§åˆ¶è°è®¿é—®ï¼Œå±æ€§æ§åˆ¶æ€æ“ä½œ**
- **ç³»ç»Ÿå®‰å…¨ç¬¬ä¸€å…³ï¼Œéšè—å±æ€§æ˜¯æŠ¤ç›¾**