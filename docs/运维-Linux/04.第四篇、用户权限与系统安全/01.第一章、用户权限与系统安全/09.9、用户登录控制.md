---
title: 9ã€ç”¨æˆ·ç™»å½•æŽ§åˆ¶
---
## ðŸ“š ç›®å½•

1. [ç”¨æˆ·ç™»å½•æŽ§åˆ¶æ¦‚è¿°](#1-ç”¨æˆ·ç™»å½•æŽ§åˆ¶æ¦‚è¿°)
2. [ç™»å½•é™åˆ¶æœºåˆ¶è¯¦è§£](#2-ç™»å½•é™åˆ¶æœºåˆ¶è¯¦è§£)
3. [/etc/nologinæ–‡ä»¶æœºåˆ¶](#3-etcnologinæ–‡ä»¶æœºåˆ¶)
4. [ç™»å½•æ—¶é—´ä¸Žæ¥æºæŽ§åˆ¶](#4-ç™»å½•æ—¶é—´ä¸Žæ¥æºæŽ§åˆ¶)
5. [å¹¶å‘ç™»å½•é™åˆ¶](#5-å¹¶å‘ç™»å½•é™åˆ¶)
6. [ç™»å½•å¤±è´¥å¤„ç†æœºåˆ¶](#6-ç™»å½•å¤±è´¥å¤„ç†æœºåˆ¶)
7. [ç™»å½•å®¡è®¡ä¸Žæ—¥å¿—](#7-ç™»å½•å®¡è®¡ä¸Žæ—¥å¿—)
8. [ç™»å½•å®‰å…¨åŠ å›ºç­–ç•¥](#8-ç™»å½•å®‰å…¨åŠ å›ºç­–ç•¥)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ðŸ” ç”¨æˆ·ç™»å½•æŽ§åˆ¶æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯ç”¨æˆ·ç™»å½•æŽ§åˆ¶


**ç®€å•ç†è§£**ï¼šå°±åƒé—¨å«ç®¡ç†è¿›å‡ºå¤§æ¥¼ä¸€æ ·ï¼ŒLinuxç³»ç»Ÿéœ€è¦æŽ§åˆ¶å“ªäº›ç”¨æˆ·èƒ½ç™»å½•ã€ä»€ä¹ˆæ—¶å€™èƒ½ç™»å½•ã€ä»Žå“ªé‡Œèƒ½ç™»å½•ã€‚

**æ ¸å¿ƒä½œç”¨**ï¼š
```
ðŸ”¸ é˜²æ­¢æœªæŽˆæƒè®¿é—® - ä¸è®©åäººè¿›æ¥
ðŸ”¸ ç®¡ç†ç³»ç»Ÿèµ„æº - æŽ§åˆ¶åŒæ—¶åœ¨çº¿äººæ•°
ðŸ”¸ ç»´æŠ¤ç³»ç»Ÿå®‰å…¨ - è®°å½•è°ä»€ä¹ˆæ—¶å€™è¿›æ¥è¿‡
ðŸ”¸ éµå®ˆå®‰å…¨ç­–ç•¥ - æŒ‰å…¬å¸è§„å®šç®¡ç†ç”¨æˆ·
```

### 1.2 ç™»å½•æŽ§åˆ¶çš„åŸºæœ¬æµç¨‹


**ç™»å½•æ£€æŸ¥æµç¨‹**ï¼š
```
ç”¨æˆ·è¾“å…¥è´¦å·å¯†ç 
         â†“
    è´¦å·æ˜¯å¦å­˜åœ¨ï¼Ÿ â”€â”€â”€â”€Noâ”€â”€â†’ ç™»å½•å¤±è´¥
         â†“ Yes
    å¯†ç æ˜¯å¦æ­£ç¡®ï¼Ÿ â”€â”€â”€â”€Noâ”€â”€â†’ è®°å½•å¤±è´¥æ¬¡æ•°
         â†“ Yes
    è´¦å·æ˜¯å¦è¢«é”å®šï¼Ÿ â”€â”€Yesâ”€â”€â†’ ç™»å½•å¤±è´¥
         â†“ No
    æ˜¯å¦åœ¨å…è®¸æ—¶é—´ï¼Ÿ â”€â”€Noâ”€â”€â”€â†’ ç™»å½•å¤±è´¥
         â†“ Yes
    æ˜¯å¦ä»Žå…è®¸ä½ç½®ï¼Ÿ â”€â”€Noâ”€â”€â”€â†’ ç™»å½•å¤±è´¥
         â†“ Yes
    æ˜¯å¦è¶…è¿‡å¹¶å‘æ•°ï¼Ÿ â”€â”€Yesâ”€â”€â†’ ç™»å½•å¤±è´¥
         â†“ No
      ç™»å½•æˆåŠŸ
```

### 1.3 ç™»å½•æŽ§åˆ¶æ¶‰åŠçš„æ ¸å¿ƒæ–‡ä»¶


**ðŸ”´ å¿…é¡»æŽŒæ¡çš„å…³é”®æ–‡ä»¶**ï¼š

| æ–‡ä»¶è·¯å¾„ | ä½œç”¨è¯´æ˜Ž | é‡è¦ç¨‹åº¦ |
|---------|---------|----------|
| `/etc/passwd` | ç”¨æˆ·è´¦å·ä¿¡æ¯ | â˜…â˜…â˜…â˜…â˜… |
| `/etc/shadow` | å¯†ç å’Œè´¦å·ç­–ç•¥ | â˜…â˜…â˜…â˜…â˜… |
| `/etc/nologin` | ç³»ç»Ÿç™»å½•ç¦ç”¨ | â˜…â˜…â˜…â˜…â˜† |
| `/etc/security/limits.conf` | ç”¨æˆ·èµ„æºé™åˆ¶ | â˜…â˜…â˜…â˜…â˜† |
| `/etc/pam.d/login` | ç™»å½•è®¤è¯é…ç½® | â˜…â˜…â˜…â˜†â˜† |

---

## 2. ðŸšª ç™»å½•é™åˆ¶æœºåˆ¶è¯¦è§£


### 2.1 è´¦å·çŠ¶æ€æŽ§åˆ¶


**è´¦å·é”å®šæœºåˆ¶**ï¼š
```bash
# é”å®šç”¨æˆ·è´¦å·ï¼ˆä¸èƒ½ç™»å½•ï¼‰
sudo passwd -l username

# è§£é”ç”¨æˆ·è´¦å·
sudo passwd -u username

# æŸ¥çœ‹è´¦å·çŠ¶æ€
sudo passwd -S username
```

**å®žé™…æ•ˆæžœæ¼”ç¤º**ï¼š
```
# æ­£å¸¸ç”¨æˆ·çš„shadowæ–‡ä»¶è®°å½•
zhang:$6$salt$hashedpassword:18500:0:99999:7:::

# è¢«é”å®šåŽçš„è®°å½•ï¼ˆå¯†ç å‰å¤šäº†æ„Ÿå¹å·ï¼‰
zhang:!$6$salt$hashedpassword:18500:0:99999:7:::
```

> ðŸ¤” **æ€è€ƒç†è§£**ï¼š
> ä¸ºä»€ä¹ˆåŠ ä¸ªæ„Ÿå¹å·å°±èƒ½é”å®šè´¦å·ï¼Ÿ
> å› ä¸ºLinuxåœ¨éªŒè¯å¯†ç æ—¶ï¼Œä¼šè®¡ç®—è¾“å…¥å¯†ç çš„å“ˆå¸Œå€¼ï¼Œå¦‚æžœshadowæ–‡ä»¶ä¸­çš„å¯†ç å­—æ®µä»¥`!`å¼€å¤´ï¼Œå°±æ°¸è¿œåŒ¹é…ä¸ä¸Šï¼Œä»Žè€Œæ‹’ç»ç™»å½•ã€‚

### 2.2 è´¦å·æœ‰æ•ˆæœŸæŽ§åˆ¶


**è®¾ç½®è´¦å·è¿‡æœŸæ—¶é—´**ï¼š
```bash
# è®¾ç½®è´¦å·2024å¹´12æœˆ31æ—¥è¿‡æœŸ
sudo usermod -e 2024-12-31 zhang

# æŸ¥çœ‹è´¦å·è¿‡æœŸä¿¡æ¯
sudo chage -l zhang

# ç«‹å³è®©è´¦å·è¿‡æœŸ
sudo usermod -e 1 zhang
```

**å¯†ç æœ‰æ•ˆæœŸæŽ§åˆ¶**ï¼š
```bash
# è®¾ç½®å¯†ç 90å¤©åŽè¿‡æœŸ
sudo chage -M 90 zhang

# è®¾ç½®å¯†ç è¿‡æœŸå‰7å¤©å¼€å§‹æé†’
sudo chage -W 7 zhang

# å¯†ç è¿‡æœŸåŽ3å¤©å†…å¿…é¡»æ›´æ”¹ï¼Œå¦åˆ™è´¦å·é”å®š
sudo chage -I 3 zhang
```

---

## 3. ðŸš« /etc/nologinæ–‡ä»¶æœºåˆ¶


### 3.1 nologinæ–‡ä»¶çš„ä½œç”¨åŽŸç†


**ç®€å•ç†è§£**ï¼š`/etc/nologin`å°±åƒæ˜¯åœ¨é—¨å£è´´ä¸ª"æš‚åœè¥ä¸š"çš„ç‰Œå­ï¼Œæ™®é€šç”¨æˆ·çœ‹åˆ°å°±ä¸èƒ½è¿›æ¥äº†ï¼Œä½†è€æ¿ï¼ˆrootï¼‰è¿˜æ˜¯å¯ä»¥è¿›å…¥ã€‚

### 3.2 nologinçš„ä½¿ç”¨æ–¹æ³•


**åˆ›å»ºnologinæ–‡ä»¶**ï¼š
```bash
# ç¦æ­¢æ‰€æœ‰æ™®é€šç”¨æˆ·ç™»å½•
sudo touch /etc/nologin

# åˆ›å»ºå¸¦æç¤ºä¿¡æ¯çš„nologin
echo "ç³»ç»Ÿæ­£åœ¨ç»´æŠ¤ï¼Œè¯·ç¨åŽå†è¯•" | sudo tee /etc/nologin
```

**éªŒè¯æ•ˆæžœ**ï¼š
```bash
# æ™®é€šç”¨æˆ·ç™»å½•æ—¶ä¼šçœ‹åˆ°ï¼š
$ ssh zhang@server
ç³»ç»Ÿæ­£åœ¨ç»´æŠ¤ï¼Œè¯·ç¨åŽå†è¯•
Connection closed.

# rootç”¨æˆ·ä¸å—å½±å“
$ ssh root@server
Last login: ...
[root@server ~]#
```

### 3.3 nologinçš„åº”ç”¨åœºæ™¯


**ðŸ”¸ ç³»ç»Ÿç»´æŠ¤åœºæ™¯**ï¼š
```bash
# ç»´æŠ¤å‰ç¦æ­¢æ™®é€šç”¨æˆ·ç™»å½•
echo "ç³»ç»Ÿç»´æŠ¤ä¸­ï¼Œé¢„è®¡1å°æ—¶åŽæ¢å¤" | sudo tee /etc/nologin

# æ‰§è¡Œç³»ç»Ÿç»´æŠ¤å·¥ä½œ
sudo systemctl stop some-service
sudo yum update -y

# ç»´æŠ¤å®ŒæˆåŽæ¢å¤ç™»å½•
sudo rm /etc/nologin
```

**ðŸ”¸ åº”æ€¥å“åº”åœºæ™¯**ï¼š
```bash
# å‘çŽ°å®‰å…¨äº‹ä»¶ï¼Œç«‹å³ç¦ç”¨æ™®é€šç”¨æˆ·ç™»å½•
echo "æ£€æµ‹åˆ°å®‰å…¨å¨èƒï¼Œç³»ç»Ÿå·²ä¸´æ—¶é”å®š" | sudo tee /etc/nologin
```

---

## 4. â° ç™»å½•æ—¶é—´ä¸Žæ¥æºæŽ§åˆ¶


### 4.1 åŸºäºŽæ—¶é—´çš„ç™»å½•æŽ§åˆ¶


**ä½¿ç”¨PAMæ¨¡å—æŽ§åˆ¶ç™»å½•æ—¶é—´**ï¼š

ç¼–è¾‘ `/etc/security/time.conf`ï¼š
```bash
# å·¥ä½œæ—¶é—´ç™»å½•é™åˆ¶ï¼ˆå‘¨ä¸€åˆ°å‘¨äº”ï¼Œ8:00-18:00ï¼‰
login;*;*;MoTuWeThFr0800-1800

# ç‰¹å®šç”¨æˆ·çš„æ—¶é—´é™åˆ¶
login;zhang;*;MoTuWeThFr0900-1700
```

**é…ç½®PAMä½¿æ—¶é—´é™åˆ¶ç”Ÿæ•ˆ**ï¼š
åœ¨ `/etc/pam.d/login` ä¸­æ·»åŠ ï¼š
```
account required pam_time.so
```

### 4.2 åŸºäºŽæ¥æºçš„ç™»å½•æŽ§åˆ¶


**é€šè¿‡hosts.allowå’Œhosts.denyæŽ§åˆ¶**ï¼š

`/etc/hosts.allow`ï¼š
```bash
# åªå…è®¸å†…ç½‘SSHç™»å½•
sshd: 192.168.1.0/24
sshd: 10.0.0.0/8

# å…è®¸ç‰¹å®šç”¨æˆ·ä»Žä»»ä½•åœ°æ–¹ç™»å½•
sshd: root@ALL
```

`/etc/hosts.deny`ï¼š
```bash
# é»˜è®¤æ‹’ç»æ‰€æœ‰SSHè¿žæŽ¥
sshd: ALL
```

**SSHé…ç½®æ–‡ä»¶æŽ§åˆ¶**ï¼š

ç¼–è¾‘ `/etc/ssh/sshd_config`ï¼š
```bash
# åªå…è®¸ç‰¹å®šç”¨æˆ·SSHç™»å½•
AllowUsers zhang li@192.168.1.100

# æ‹’ç»ç‰¹å®šç”¨æˆ·SSHç™»å½•
DenyUsers guest temp

# åªå…è®¸ç‰¹å®šç»„SSHç™»å½•
AllowGroups sysadmin developers
```

---

## 5. ðŸ‘¥ å¹¶å‘ç™»å½•é™åˆ¶


### 5.1 ç†è§£å¹¶å‘ç™»å½•é™åˆ¶


**ä¸ºä»€ä¹ˆéœ€è¦é™åˆ¶**ï¼š
- é˜²æ­¢è´¦å·è¢«å¤šäººåŒæ—¶ä½¿ç”¨
- æŽ§åˆ¶ç³»ç»Ÿèµ„æºæ¶ˆè€—
- æé«˜ç³»ç»Ÿå®‰å…¨æ€§

### 5.2 ä½¿ç”¨limits.confé™åˆ¶å¹¶å‘


**é…ç½®æ–‡ä»¶**ï¼š`/etc/security/limits.conf`

```bash
# ç”¨æˆ·zhangæœ€å¤šåŒæ—¶ç™»å½•2ä¸ªä¼šè¯
zhang    hard    maxlogins    2

# ç»„developersçš„æ¯ä¸ªç”¨æˆ·æœ€å¤š3ä¸ªä¼šè¯
@developers    hard    maxlogins    3

# æ‰€æœ‰ç”¨æˆ·é»˜è®¤æœ€å¤š5ä¸ªä¼šè¯
*    hard    maxlogins    5
```

**éªŒè¯é™åˆ¶æ•ˆæžœ**ï¼š
```bash
# æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„ç™»å½•ä¼šè¯
who | grep $USER

# å°è¯•è¶…å‡ºé™åˆ¶æ—¶çš„æç¤º
$ ssh zhang@server
Too many logins for 'zhang'.
Connection closed.
```

### 5.3 ä½¿ç”¨systemdé™åˆ¶ç”¨æˆ·ä¼šè¯


**æŸ¥çœ‹ç”¨æˆ·ä¼šè¯ä¿¡æ¯**ï¼š
```bash
# æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·ä¼šè¯
loginctl list-sessions

# æŸ¥çœ‹ç‰¹å®šç”¨æˆ·ä¼šè¯
loginctl show-user zhang
```

**é…ç½®ç”¨æˆ·ä¼šè¯é™åˆ¶**ï¼š
ç¼–è¾‘ `/etc/systemd/logind.conf`ï¼š
```bash
# ç”¨æˆ·ä¼šè¯ç©ºé—²è¶…æ—¶ï¼ˆ15åˆ†é’Ÿï¼‰
UserTasksMax=1000
IdleActionSec=15min
IdleAction=lock
```

---

## 6. âŒ ç™»å½•å¤±è´¥å¤„ç†æœºåˆ¶


### 6.1 ç™»å½•å¤±è´¥é”å®šæœºåˆ¶


**ä½¿ç”¨pam_faillockæ¨¡å—**ï¼š

é…ç½® `/etc/pam.d/password-auth` å’Œ `/etc/pam.d/system-auth`ï¼š
```bash
# åœ¨authæ®µæ·»åŠ 
auth required pam_faillock.so preauth deny=3 unlock_time=600

# åœ¨authæ®µæœ«å°¾æ·»åŠ 
auth required pam_faillock.so authfail deny=3 unlock_time=600

# åœ¨accountæ®µæ·»åŠ 
account required pam_faillock.so
```

**å‚æ•°è¯´æ˜Ž**ï¼š
- `deny=3`ï¼šè¿žç»­å¤±è´¥3æ¬¡å°±é”å®š
- `unlock_time=600`ï¼šé”å®š10åˆ†é’ŸåŽè‡ªåŠ¨è§£é”

### 6.2 æ‰‹åŠ¨ç®¡ç†å¤±è´¥é”å®š


**æŸ¥çœ‹å¤±è´¥è®°å½•**ï¼š
```bash
# æŸ¥çœ‹ç”¨æˆ·å¤±è´¥ç™»å½•è®°å½•
sudo faillock --user zhang

# é‡ç½®ç”¨æˆ·å¤±è´¥è®¡æ•°
sudo faillock --user zhang --reset
```

**å®žé™…åº”ç”¨åœºæ™¯**ï¼š
```bash
# ç”¨æˆ·å¼ ä¸‰è¯´è‡ªå·±è¢«é”äº†ï¼Œè¿ç»´æ£€æŸ¥ï¼š
sudo faillock --user zhang
# è¾“å‡ºï¼šzhangæœ‰3æ¬¡å¤±è´¥è®°å½•ï¼Œè¿˜éœ€ç­‰å¾…8åˆ†é’Ÿè§£é”

# ç¡®è®¤æ˜¯æœ¬äººæ“ä½œåŽï¼Œæ‰‹åŠ¨è§£é”ï¼š
sudo faillock --user zhang --reset
```

---

## 7. ðŸ“Š ç™»å½•å®¡è®¡ä¸Žæ—¥å¿—


### 7.1 ç™»å½•æ—¥å¿—çš„ä½ç½®å’Œä½œç”¨


**æ ¸å¿ƒæ—¥å¿—æ–‡ä»¶**ï¼š

| æ—¥å¿—æ–‡ä»¶ | è®°å½•å†…å®¹ | æŸ¥çœ‹å‘½ä»¤ |
|---------|---------|---------|
| `/var/log/secure` | SSHç™»å½•è®°å½• | `tail -f /var/log/secure` |
| `/var/log/lastlog` | æœ€åŽç™»å½•æ—¶é—´ | `lastlog` |
| `/var/log/wtmp` | ç™»å½•åŽ†å²è®°å½• | `last` |
| `/var/log/btmp` | å¤±è´¥ç™»å½•è®°å½• | `lastb` |

### 7.2 å¸¸ç”¨çš„æ—¥å¿—æŸ¥çœ‹å‘½ä»¤


**æŸ¥çœ‹ç™»å½•æˆåŠŸè®°å½•**ï¼š
```bash
# æŸ¥çœ‹æœ€è¿‘ç™»å½•è®°å½•
last

# æŸ¥çœ‹ç‰¹å®šç”¨æˆ·ç™»å½•è®°å½•
last zhang

# æŸ¥çœ‹ä»Žç‰¹å®šIPçš„ç™»å½•
last | grep "192.168.1.100"
```

**æŸ¥çœ‹ç™»å½•å¤±è´¥è®°å½•**ï¼š
```bash
# æŸ¥çœ‹å¤±è´¥ç™»å½•å°è¯•
sudo lastb

# æŸ¥çœ‹ç‰¹å®šç”¨æˆ·çš„å¤±è´¥ç™»å½•
sudo lastb zhang

# ç»Ÿè®¡å¤±è´¥ç™»å½•æœ€å¤šçš„IP
sudo lastb | awk '{print $3}' | sort | uniq -c | sort -nr | head -10
```

### 7.3 å®žæ—¶ç›‘æŽ§ç™»å½•æ´»åŠ¨


**ç›‘æŽ§æ­£åœ¨è¿›è¡Œçš„ç™»å½•**ï¼š
```bash
# å®žæ—¶æŸ¥çœ‹ç™»å½•æ—¥å¿—
sudo tail -f /var/log/secure

# ç›‘æŽ§å½“å‰åœ¨çº¿ç”¨æˆ·
watch -n 2 'who'

# æŸ¥çœ‹ç”¨æˆ·æ´»åŠ¨è¯¦æƒ…
w
```

**æ—¥å¿—åˆ†æžç¤ºä¾‹**ï¼š
```bash
# åœ¨secureæ—¥å¿—ä¸­æœç´¢å¯ç–‘æ´»åŠ¨
grep "Failed password" /var/log/secure | tail -10
grep "Invalid user" /var/log/secure | tail -10
grep "Connection closed" /var/log/secure | tail -10
```

---

## 8. ðŸ›¡ï¸ ç™»å½•å®‰å…¨åŠ å›ºç­–ç•¥


### 8.1 SSHç™»å½•å®‰å…¨é…ç½®


**ä¿®æ”¹SSHé»˜è®¤é…ç½®** (`/etc/ssh/sshd_config`)ï¼š
```bash
# ç¦ç”¨rootç›´æŽ¥SSHç™»å½•
PermitRootLogin no

# ä¿®æ”¹é»˜è®¤ç«¯å£
Port 2022

# ç¦ç”¨å¯†ç ç™»å½•ï¼Œå¼ºåˆ¶ä½¿ç”¨å¯†é’¥
PasswordAuthentication no
PubkeyAuthentication yes

# è®¾ç½®ç™»å½•è¶…æ—¶
LoginGraceTime 60
ClientAliveInterval 300
ClientAliveCountMax 2

# é™åˆ¶ç™»å½•å°è¯•
MaxAuthTries 3
MaxStartups 5:30:10
```

### 8.2 å¯†é’¥è®¤è¯é…ç½®


**ä¸ºç”¨æˆ·è®¾ç½®SSHå¯†é’¥è®¤è¯**ï¼š
```bash
# ç”¨æˆ·ç”Ÿæˆå¯†é’¥å¯¹
ssh-keygen -t rsa -b 4096 -C "zhang@company.com"

# å°†å…¬é’¥å¤åˆ¶åˆ°æœåŠ¡å™¨
ssh-copy-id -i ~/.ssh/id_rsa.pub zhang@server

# éªŒè¯å¯†é’¥ç™»å½•
ssh -i ~/.ssh/id_rsa zhang@server
```

### 8.3 ç™»å½•ç›‘æŽ§å’Œå‘Šè­¦


**è®¾ç½®ç™»å½•å‘Šè­¦è„šæœ¬**ï¼š
```bash
#!/bin/bash
# ç™»å½•ç›‘æŽ§è„šæœ¬
LOGFILE="/var/log/secure"
ALERT_EMAIL="admin@company.com"

# ç›‘æŽ§å¼‚å¸¸ç™»å½•
tail -f $LOGFILE | while read line; do
    if echo "$line" | grep -q "Failed password"; then
        echo "æ£€æµ‹åˆ°ç™»å½•å¤±è´¥: $line" | mail -s "ç™»å½•å‘Šè­¦" $ALERT_EMAIL
    fi
    
    if echo "$line" | grep -q "Invalid user"; then
        echo "æ£€æµ‹åˆ°æ— æ•ˆç”¨æˆ·ç™»å½•: $line" | mail -s "å®‰å…¨å‘Šè­¦" $ALERT_EMAIL
    fi
done
```

### 8.4 ç»¼åˆå®‰å…¨ç­–ç•¥


**ðŸ”´ å¿…é¡»æ‰§è¡Œçš„å®‰å…¨æŽªæ–½**ï¼š

```
å®‰å…¨æ£€æŸ¥æ¸…å•ï¼š
â–¡ ç¦ç”¨ä¸å¿…è¦çš„ç”¨æˆ·è´¦å·
â–¡ è®¾ç½®å¼ºå¯†ç ç­–ç•¥
â–¡ å¯ç”¨ç™»å½•å¤±è´¥é”å®š
â–¡ ä¿®æ”¹SSHé»˜è®¤ç«¯å£
â–¡ ç¦ç”¨rootç›´æŽ¥ç™»å½•
â–¡ å¯ç”¨å¯†é’¥è®¤è¯
â–¡ å®šæœŸæ£€æŸ¥ç™»å½•æ—¥å¿—
â–¡ è®¾ç½®ç™»å½•æ—¶é—´é™åˆ¶
â–¡ é…ç½®é˜²ç«å¢™è§„åˆ™
â–¡ å¯ç”¨æ—¥å¿—å®¡è®¡
```

**å®‰å…¨åŠ å›ºå®žæ–½è„šæœ¬**ï¼š
```bash
#!/bin/bash
# SSHå®‰å…¨åŠ å›ºè„šæœ¬

# å¤‡ä»½åŽŸé…ç½®
cp /etc/ssh/sshd_config /etc/ssh/sshd_config.backup

# åº”ç”¨å®‰å…¨é…ç½®
cat >> /etc/ssh/sshd_config << EOF
# å®‰å…¨åŠ å›ºé…ç½®
PermitRootLogin no
PasswordAuthentication no
MaxAuthTries 3
ClientAliveInterval 300
ClientAliveCountMax 2
EOF

# é‡å¯SSHæœåŠ¡
systemctl restart sshd

echo "SSHå®‰å…¨åŠ å›ºå®Œæˆ"
```

---

## 9. ðŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŽŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ðŸ”¸ ç™»å½•æŽ§åˆ¶æœ¬è´¨ï¼šç®¡ç†"è°èƒ½è¿›æ¥ï¼Œä»€ä¹ˆæ—¶å€™è¿›æ¥ï¼Œä»Žå“ªé‡Œè¿›æ¥"
ðŸ”¸ nologinæœºåˆ¶ï¼šç³»ç»Ÿçº§çš„ç™»å½•å¼€å…³ï¼Œå½±å“æ‰€æœ‰æ™®é€šç”¨æˆ·
ðŸ”¸ è´¦å·é”å®šï¼šé€šè¿‡ä¿®æ”¹shadowæ–‡ä»¶å®žçŽ°ç”¨æˆ·ç¦ç”¨
ðŸ”¸ å¹¶å‘é™åˆ¶ï¼šé˜²æ­¢è´¦å·è¢«æ»¥ç”¨ï¼ŒæŽ§åˆ¶ç³»ç»Ÿèµ„æº
ðŸ”¸ æ—¥å¿—å®¡è®¡ï¼šè®°å½•å’Œåˆ†æžæ‰€æœ‰ç™»å½•æ´»åŠ¨
ðŸ”¸ å®‰å…¨åŠ å›ºï¼šå¤šå±‚é˜²æŠ¤ç¡®ä¿ç³»ç»Ÿå®‰å…¨
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ðŸ”¹ ç™»å½•æŽ§åˆ¶çš„å±‚æ¬¡ç»“æž„**ï¼š
```
ç³»ç»Ÿå±‚é¢ (/etc/nologin) â†’ å½±å“æ‰€æœ‰æ™®é€šç”¨æˆ·
è´¦å·å±‚é¢ (passwd -l) â†’ å½±å“ç‰¹å®šç”¨æˆ·
æ—¶é—´å±‚é¢ (time.conf) â†’ åŸºäºŽæ—¶é—´ç­–ç•¥
æ¥æºå±‚é¢ (hosts.allow) â†’ åŸºäºŽç½‘ç»œä½ç½®
èµ„æºå±‚é¢ (limits.conf) â†’ åŸºäºŽèµ„æºé™åˆ¶
```

**ðŸ”¹ å®‰å…¨ä¸Žä¾¿åˆ©çš„å¹³è¡¡**ï¼š
```
å®‰å…¨æŽªæ–½          ä¾¿åˆ©æ€§å½±å“        é€‚ç”¨åœºæ™¯
å¯†é’¥è®¤è¯          éœ€è¦é…ç½®å¯†é’¥      ç”Ÿäº§çŽ¯å¢ƒ
å¤±è´¥é”å®š          å¯èƒ½è¯¯é”ç”¨æˆ·      æ‰€æœ‰çŽ¯å¢ƒ  
æ—¶é—´é™åˆ¶          é™åˆ¶å·¥ä½œæ—¶é—´      åŠžå…¬çŽ¯å¢ƒ
å¹¶å‘é™åˆ¶          å½±å“å¤šç‚¹ç™»å½•      å…±äº«çŽ¯å¢ƒ
```

### 9.3 å®žé™…åº”ç”¨ä»·å€¼


**ðŸŽ¯ è¿ç»´ç®¡ç†åº”ç”¨**ï¼š
- **ç”¨æˆ·ç®¡ç†**ï¼šæ‰¹é‡åˆ›å»ºã€é”å®šã€è§£é”ç”¨æˆ·è´¦å·
- **å®‰å…¨å“åº”**ï¼šå‘çŽ°å¼‚å¸¸æ—¶å¿«é€Ÿç¦ç”¨ç™»å½•
- **ç³»ç»Ÿç»´æŠ¤**ï¼šç»´æŠ¤æœŸé—´é˜²æ­¢ç”¨æˆ·å¹²æ‰°
- **åˆè§„å®¡è®¡**ï¼šè®°å½•å’Œåˆ†æžç”¨æˆ·è®¿é—®è¡Œä¸º

**ðŸ”§ æ•…éšœå¤„ç†æŠ€èƒ½**ï¼š
- **ç™»å½•é—®é¢˜è¯Šæ–­**ï¼šåˆ†æžç”¨æˆ·æ— æ³•ç™»å½•çš„åŽŸå› 
- **å®‰å…¨äº‹ä»¶å“åº”**ï¼šå¤„ç†æš´åŠ›ç ´è§£ç­‰æ”»å‡»
- **æ€§èƒ½ä¼˜åŒ–**ï¼šåˆç†è®¾ç½®å¹¶å‘å’Œè¶…æ—¶å‚æ•°
- **æ—¥å¿—åˆ†æž**ï¼šä»Žæ—¥å¿—ä¸­å‘çŽ°å®‰å…¨å¨èƒ

### 9.4 å­¦ä¹ æ£€æŸ¥æ¸…å•


**âœ… åŸºç¡€æ“ä½œæŽŒæ¡åº¦**ï¼š
- [ ] èƒ½é”å®šå’Œè§£é”ç”¨æˆ·è´¦å·
- [ ] ä¼šåˆ›å»ºå’Œåˆ é™¤nologinæ–‡ä»¶  
- [ ] èƒ½é…ç½®SSHå®‰å…¨å‚æ•°
- [ ] ä¼šæŸ¥çœ‹å’Œåˆ†æžç™»å½•æ—¥å¿—

**âœ… å®‰å…¨é…ç½®ç†è§£åº¦**ï¼š
- [ ] ç†è§£å„ç§ç™»å½•é™åˆ¶çš„ä½œç”¨
- [ ] çŸ¥é“å¦‚ä½•è®¾ç½®æ—¶é—´å’Œæ¥æºæŽ§åˆ¶
- [ ] æŽŒæ¡å¤±è´¥é”å®šçš„é…ç½®æ–¹æ³•
- [ ] äº†è§£æ—¥å¿—å®¡è®¡çš„é‡è¦æ€§

**ðŸ§  è®°å¿†è¦ç‚¹**ï¼š
```
ç™»å½•æŽ§åˆ¶ä¸‰è¦ç´ ï¼šç”¨æˆ·ã€æ—¶é—´ã€æ¥æº
nologinæ–‡ä»¶ï¼šæ™®é€šç”¨æˆ·çš„"å…è¿›ç‰Œ"
å¤±è´¥é”å®šï¼šä¸‰æ¬¡ä¸å¯¹å°±ç­‰ç­‰å†è¯•
æ—¥å¿—å®¡è®¡ï¼šç³»ç»Ÿçš„"ç›‘æŽ§å½•åƒ"
å®‰å…¨åŠ å›ºï¼šå¤šé“é˜²çº¿ä¿å¹³å®‰
```

**æ ¸å¿ƒç†è§£**ï¼š
- ç”¨æˆ·ç™»å½•æŽ§åˆ¶æ˜¯Linuxå®‰å…¨çš„ç¬¬ä¸€é“é˜²çº¿
- æ¯ç§æŽ§åˆ¶æœºåˆ¶éƒ½æœ‰å…¶ç‰¹å®šçš„åº”ç”¨åœºæ™¯  
- å®‰å…¨é…ç½®éœ€è¦åœ¨å®‰å…¨æ€§å’Œä¾¿åˆ©æ€§ä¹‹é—´æ‰¾å¹³è¡¡
- æ—¥å¿—ç›‘æŽ§å’Œåˆ†æžæ˜¯åŠæ—¶å‘çŽ°é—®é¢˜çš„å…³é”®
- å®šæœŸæ£€æŸ¥å’Œç»´æŠ¤ç™»å½•æŽ§åˆ¶ç­–ç•¥å¾ˆé‡è¦