---
title: 13ã€ä¼ä¸šç¯å¢ƒACLæƒé™è§„åˆ’
---
## ğŸ“š ç›®å½•

1. [ACLæƒé™è§„åˆ’æ¦‚è¿°](#1-aclæƒé™è§„åˆ’æ¦‚è¿°)
2. [éƒ¨é—¨çº§æƒé™åˆ†é…ç­–ç•¥](#2-éƒ¨é—¨çº§æƒé™åˆ†é…ç­–ç•¥)
3. [é¡¹ç›®ç›®å½•ACLæƒé™è®¾è®¡](#3-é¡¹ç›®ç›®å½•aclæƒé™è®¾è®¡)
4. [å…±äº«ç›®å½•æƒé™ç®¡ç†](#4-å…±äº«ç›®å½•æƒé™ç®¡ç†)
5. [ä¸´æ—¶æƒé™æˆäºˆæœºåˆ¶](#5-ä¸´æ—¶æƒé™æˆäºˆæœºåˆ¶)
6. [ACLæƒé™å˜æ›´æµç¨‹](#6-aclæƒé™å˜æ›´æµç¨‹)
7. [æƒé™å®¡è®¡ä¸åˆè§„æ£€æŸ¥](#7-æƒé™å®¡è®¡ä¸åˆè§„æ£€æŸ¥)
8. [ACLæƒé™è‡ªåŠ¨åŒ–ç®¡ç†](#8-aclæƒé™è‡ªåŠ¨åŒ–ç®¡ç†)
9. [å¤§è§„æ¨¡ACLéƒ¨ç½²ç­–ç•¥](#9-å¤§è§„æ¨¡acléƒ¨ç½²ç­–ç•¥)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¢ ACLæƒé™è§„åˆ’æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯ä¼ä¸šç¯å¢ƒä¸‹çš„ACLæƒé™è§„åˆ’


**ç®€å•ç†è§£**ï¼šå°±åƒç»™å…¬å¸çš„æ¯ä¸ªéƒ¨é—¨ã€æ¯ä¸ªå‘˜å·¥åˆ†é…åŠå…¬å®¤é’¥åŒ™ä¸€æ ·ï¼ŒACLæƒé™è§„åˆ’æ˜¯ä¸ºä¼ä¸šçš„æ–‡ä»¶ç³»ç»Ÿåˆ¶å®šä¸€å¥—è¯¦ç»†çš„"é—¨ç¦å¡"åˆ†é…æ–¹æ¡ˆã€‚

**æ ¸å¿ƒç›®çš„**ï¼š
- ğŸ” **å®‰å…¨ä¿éšœ**ï¼šç¡®ä¿æ•æ„Ÿæ•°æ®åªæœ‰æˆæƒäººå‘˜èƒ½è®¿é—®
- ğŸ¯ **ç²¾ç¡®æ§åˆ¶**ï¼šç»†ç²’åº¦æ§åˆ¶åˆ°å…·ä½“ç”¨æˆ·å’Œæ–‡ä»¶
- ğŸ“‹ **åˆè§„è¦æ±‚**ï¼šæ»¡è¶³ä¼ä¸šå®‰å…¨å®¡è®¡å’Œæ³•è§„è¦æ±‚
- ğŸš€ **æ•ˆç‡æå‡**ï¼šé¿å…é¢‘ç¹çš„æƒé™ç”³è¯·å’Œå˜æ›´

### 1.2 ä¼ä¸šACLæƒé™æ¶æ„


```
ä¼ä¸šæƒé™å±‚çº§ç»“æ„ï¼š

é›†å›¢æ€»éƒ¨
â”œâ”€â”€ ç ”å‘éƒ¨é—¨
â”‚   â”œâ”€â”€ å‰ç«¯å›¢é˜Ÿ
â”‚   â”œâ”€â”€ åç«¯å›¢é˜Ÿ
â”‚   â””â”€â”€ æµ‹è¯•å›¢é˜Ÿ
â”œâ”€â”€ è¿è¥éƒ¨é—¨
â”‚   â”œâ”€â”€ å¸‚åœºç»„
â”‚   â””â”€â”€ å®¢æœç»„
â””â”€â”€ è´¢åŠ¡éƒ¨é—¨
    â”œâ”€â”€ ä¼šè®¡ç»„
    â””â”€â”€ å®¡è®¡ç»„

å¯¹åº”æ–‡ä»¶ç³»ç»Ÿæƒé™ï¼š
/enterprise/
â”œâ”€â”€ /dev/          â† ç ”å‘éƒ¨é—¨ç›®å½•
â”‚   â”œâ”€â”€ /frontend/ â† å‰ç«¯å›¢é˜Ÿä¸“ç”¨
â”‚   â”œâ”€â”€ /backend/  â† åç«¯å›¢é˜Ÿä¸“ç”¨
â”‚   â””â”€â”€ /testing/  â† æµ‹è¯•å›¢é˜Ÿä¸“ç”¨
â”œâ”€â”€ /operations/   â† è¿è¥éƒ¨é—¨ç›®å½•
â””â”€â”€ /finance/      â† è´¢åŠ¡éƒ¨é—¨ç›®å½•
```

### 1.3 ACLè§„åˆ’çš„æ ¸å¿ƒåŸåˆ™


**æœ€å°æƒé™åŸåˆ™**ï¼š
```
æ¯ä¸ªç”¨æˆ·åªè·å¾—å®Œæˆå·¥ä½œæ‰€éœ€çš„æœ€å°æƒé™
ä¾‹å¦‚ï¼š
- å¼€å‘äººå‘˜ï¼šåªèƒ½è®¿é—®è‡ªå·±è´Ÿè´£çš„é¡¹ç›®ç›®å½•
- æµ‹è¯•äººå‘˜ï¼šå¯¹å¼€å‘ç›®å½•æœ‰è¯»æƒé™ï¼Œå¯¹æµ‹è¯•ç›®å½•æœ‰å†™æƒé™
- ç®¡ç†äººå‘˜ï¼šæ ¹æ®ç®¡ç†èŒƒå›´è·å¾—ç›¸åº”æƒé™
```

**èŒè´£åˆ†ç¦»åŸåˆ™**ï¼š
```
ä¸åŒèŒè´£çš„æƒé™è¦æ˜ç¡®åˆ†å¼€
- å¼€å‘æƒé™ â‰  ç”Ÿäº§ç¯å¢ƒæƒé™
- æ•°æ®è¯»å–æƒé™ â‰  æ•°æ®ä¿®æ”¹æƒé™
- æ™®é€šç”¨æˆ·æƒé™ â‰  ç®¡ç†å‘˜æƒé™
```

---

## 2. ğŸ›ï¸ éƒ¨é—¨çº§æƒé™åˆ†é…ç­–ç•¥


### 2.1 éƒ¨é—¨æƒé™åˆ†å±‚è®¾è®¡


**ä¸‰å±‚æƒé™æ¨¡å‹**ï¼š

```
ç¬¬ä¸€å±‚ï¼šéƒ¨é—¨ä¸»ç®¡æƒé™
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ éƒ¨é—¨ä¸»ç®¡(dept-manager)           â”‚
â”‚ âœ… éƒ¨é—¨ç›®å½•å®Œå…¨æ§åˆ¶æƒé™           â”‚
â”‚ âœ… å­ç›®å½•åˆ›å»ºå’Œåˆ é™¤æƒé™           â”‚
â”‚ âœ… ç”¨æˆ·æƒé™åˆ†é…æƒé™             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
ç¬¬äºŒå±‚ï¼šå›¢é˜Ÿè´Ÿè´£äººæƒé™
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å›¢é˜Ÿè´Ÿè´£äºº(team-lead)            â”‚
â”‚ âœ… å›¢é˜Ÿç›®å½•ç®¡ç†æƒé™             â”‚
â”‚ âœ… å›¢é˜Ÿæˆå‘˜æƒé™åˆ†é…             â”‚
â”‚ âŒ å…¶ä»–å›¢é˜Ÿç›®å½•è®¿é—®             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
ç¬¬ä¸‰å±‚ï¼šæ™®é€šå‘˜å·¥æƒé™
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ™®é€šå‘˜å·¥(employee)              â”‚
â”‚ âœ… ä¸ªäººå·¥ä½œç›®å½•è¯»å†™æƒé™          â”‚
â”‚ âœ… å›¢é˜Ÿå…±äº«ç›®å½•ç‰¹å®šæƒé™          â”‚
â”‚ âŒ éƒ¨é—¨ç®¡ç†æƒé™                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ç ”å‘éƒ¨é—¨æƒé™é…ç½®ç¤ºä¾‹


```bash
# åˆ›å»ºç ”å‘éƒ¨é—¨åŸºç¡€ç›®å½•ç»“æ„
mkdir -p /enterprise/dev/{frontend,backend,testing,shared}

# è®¾ç½®éƒ¨é—¨ä¸»ç®¡æƒé™
setfacl -m u:dev-manager:rwx /enterprise/dev
setfacl -m d:u:dev-manager:rwx /enterprise/dev

# è®¾ç½®å„å›¢é˜Ÿè´Ÿè´£äººæƒé™
setfacl -m u:frontend-lead:rwx /enterprise/dev/frontend
setfacl -m u:backend-lead:rwx /enterprise/dev/backend
setfacl -m u:test-lead:rwx /enterprise/dev/testing
```

> ğŸ’¡ **å®é™…å«ä¹‰è§£é‡Š**ï¼š
> - `u:dev-manager:rwx`ï¼šç»™ç ”å‘éƒ¨é—¨ç»ç†å®Œæ•´çš„è¯»å†™æ‰§è¡Œæƒé™
> - `d:u:dev-manager:rwx`ï¼šé»˜è®¤æƒé™ï¼Œæ–°åˆ›å»ºçš„æ–‡ä»¶å¤¹ä¼šè‡ªåŠ¨ç»§æ‰¿è¿™ä¸ªæƒé™
> - æ¯ä¸ªå›¢é˜Ÿè´Ÿè´£äººåªèƒ½ç®¡ç†è‡ªå·±å›¢é˜Ÿçš„ç›®å½•

### 2.3 è·¨éƒ¨é—¨åä½œæƒé™


**åœºæ™¯**ï¼šç ”å‘éƒ¨é—¨éœ€è¦ä¸è¿è¥éƒ¨é—¨åä½œ

```bash
# åˆ›å»ºè·¨éƒ¨é—¨åä½œç›®å½•
mkdir -p /enterprise/collaboration/dev-ops

# è®¾ç½®åä½œæƒé™
setfacl -m g:dev-team:rw- /enterprise/collaboration/dev-ops
setfacl -m g:ops-team:rw- /enterprise/collaboration/dev-ops

# è®¾ç½®é¡¹ç›®ç»ç†æƒé™ï¼ˆå¯ä»¥ç®¡ç†åä½œç›®å½•ï¼‰
setfacl -m u:project-manager:rwx /enterprise/collaboration/dev-ops
```

**æƒé™å«ä¹‰**ï¼š
- ç ”å‘å›¢é˜Ÿå’Œè¿è¥å›¢é˜Ÿéƒ½èƒ½è¯»å†™åä½œç›®å½•ä¸­çš„æ–‡ä»¶
- é¡¹ç›®ç»ç†æœ‰å®Œæ•´ç®¡ç†æƒé™ï¼Œå¯ä»¥åˆ›å»ºå­ç›®å½•å’Œè°ƒæ•´æƒé™
- å…¶ä»–éƒ¨é—¨é»˜è®¤æ— æ³•è®¿é—®

---

## 3. ğŸ“ é¡¹ç›®ç›®å½•ACLæƒé™è®¾è®¡


### 3.1 é¡¹ç›®ç›®å½•ç»“æ„è§„åˆ’


**æ ‡å‡†é¡¹ç›®ç›®å½•ç»“æ„**ï¼š

```
/enterprise/projects/project-alpha/
â”œâ”€â”€ docs/           â† é¡¹ç›®æ–‡æ¡£ç›®å½•
â”œâ”€â”€ src/            â† æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ frontend/   â† å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ backend/    â† åç«¯ä»£ç 
â”‚   â””â”€â”€ database/   â† æ•°æ®åº“è„šæœ¬
â”œâ”€â”€ config/         â† é…ç½®æ–‡ä»¶ç›®å½•
â”œâ”€â”€ logs/           â† æ—¥å¿—æ–‡ä»¶ç›®å½•
â””â”€â”€ releases/       â† å‘å¸ƒç‰ˆæœ¬ç›®å½•
```

### 3.2 è§’è‰²æƒé™çŸ©é˜µ


| è§’è‰²/ç›®å½• | **docs/** | **src/** | **config/** | **logs/** | **releases/** |
|----------|-----------|----------|-------------|-----------|---------------|
| ğŸ¯ **é¡¹ç›®ç»ç†** | `rwx` | `r-x` | `r--` | `r--` | `rwx` |
| ğŸ‘¨â€ğŸ’» **å¼€å‘äººå‘˜** | `rw-` | `rwx` | `r--` | `r--` | `r--` |
| ğŸ§ª **æµ‹è¯•äººå‘˜** | `rw-` | `r-x` | `r--` | `rw-` | `r-x` |
| ğŸ”§ **è¿ç»´äººå‘˜** | `r--` | `r--` | `rwx` | `rwx` | `rwx` |
| ğŸ‘€ **äº§å“ç»ç†** | `rwx` | `r--` | `---` | `r--` | `r-x` |

### 3.3 é¡¹ç›®æƒé™é…ç½®å®ç°


```bash
# åˆ›å»ºé¡¹ç›®ç›®å½•
PROJECT_DIR="/enterprise/projects/project-alpha"
mkdir -p $PROJECT_DIR/{docs,src/{frontend,backend,database},config,logs,releases}

# é¡¹ç›®ç»ç†æƒé™è®¾ç½®
setfacl -R -m u:pm-alice:rwx $PROJECT_DIR/docs
setfacl -R -m u:pm-alice:r-x $PROJECT_DIR/src
setfacl -R -m u:pm-alice:rwx $PROJECT_DIR/releases

# å¼€å‘äººå‘˜æƒé™è®¾ç½®ï¼ˆä»¥å‰ç«¯å¼€å‘ä¸ºä¾‹ï¼‰
setfacl -R -m u:dev-bob:rw- $PROJECT_DIR/docs
setfacl -R -m u:dev-bob:rwx $PROJECT_DIR/src/frontend
setfacl -R -m u:dev-bob:r-- $PROJECT_DIR/src/backend

# æµ‹è¯•äººå‘˜æƒé™è®¾ç½®
setfacl -R -m u:test-charlie:rw- $PROJECT_DIR/docs
setfacl -R -m u:test-charlie:r-x $PROJECT_DIR/src
setfacl -R -m u:test-charlie:rw- $PROJECT_DIR/logs
```

> ğŸ“‹ **æƒé™å«ä¹‰è¯´æ˜**ï¼š
> - `rwx`ï¼šå¯ä»¥è¯»å–ã€ä¿®æ”¹æ–‡ä»¶ï¼Œåˆ›å»ºåˆ é™¤æ–‡ä»¶å¤¹
> - `rw-`ï¼šå¯ä»¥è¯»å–å’Œä¿®æ”¹æ–‡ä»¶ï¼Œä½†ä¸èƒ½æ‰§è¡Œæˆ–è¿›å…¥ç›®å½•
> - `r-x`ï¼šå¯ä»¥è¯»å–å’Œè¿›å…¥ç›®å½•ï¼Œä½†ä¸èƒ½ä¿®æ”¹
> - `r--`ï¼šåªèƒ½è¯»å–ï¼Œä¸èƒ½ä¿®æ”¹æˆ–æ‰§è¡Œ

### 3.4 æ•æ„Ÿæ–‡ä»¶ç‰¹æ®Šä¿æŠ¤


**åœºæ™¯**ï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶åŒ…å«æ•æ„Ÿä¿¡æ¯

```bash
# åˆ›å»ºæ•æ„Ÿé…ç½®æ–‡ä»¶
touch $PROJECT_DIR/config/database.conf
touch $PROJECT_DIR/config/api-keys.conf

# è®¾ç½®ä¸¥æ ¼æƒé™ï¼ˆåªæœ‰é¡¹ç›®ç»ç†å’Œè¿ç»´å¯ä»¥è®¿é—®ï¼‰
setfacl -m u:pm-alice:rw- $PROJECT_DIR/config/database.conf
setfacl -m u:ops-david:rw- $PROJECT_DIR/config/database.conf
setfacl -m u:ops-david:rw- $PROJECT_DIR/config/api-keys.conf

# ç§»é™¤ç»„æƒé™å’Œå…¶ä»–ç”¨æˆ·æƒé™
chmod 600 $PROJECT_DIR/config/database.conf
chmod 600 $PROJECT_DIR/config/api-keys.conf
```

---

## 4. ğŸ¤ å…±äº«ç›®å½•æƒé™ç®¡ç†


### 4.1 å…±äº«ç›®å½•åˆ†ç±»ç®¡ç†


**ä¼ä¸šå…¸å‹å…±äº«ç›®å½•**ï¼š

```
å…±äº«ç›®å½•æ¶æ„ï¼š

/shared/
â”œâ”€â”€ public/         â† å…¬å…±èµ„æ–™ï¼ˆæ‰€æœ‰å‘˜å·¥å¯è®¿é—®ï¼‰
â”œâ”€â”€ departments/    â† éƒ¨é—¨å†…éƒ¨å…±äº«
â”‚   â”œâ”€â”€ dev-shared/
â”‚   â”œâ”€â”€ ops-shared/
â”‚   â””â”€â”€ hr-shared/
â”œâ”€â”€ projects/       â† é¡¹ç›®å…±äº«èµ„æº
â””â”€â”€ temp/          â† ä¸´æ—¶æ–‡ä»¶äº¤æ¢
```

### 4.2 åˆ†çº§å…±äº«æƒé™è®¾è®¡


**ğŸŒ å…¬å…±å…±äº«ç›®å½•**ï¼š
```bash
# æ‰€æœ‰å‘˜å·¥éƒ½å¯ä»¥è¯»å–ï¼Œä½†åªæœ‰ç®¡ç†å‘˜å¯ä»¥ä¿®æ”¹
setfacl -m g:all-employees:r-x /shared/public
setfacl -m u:admin:rwx /shared/public
setfacl -d -m g:all-employees:r-- /shared/public
setfacl -d -m u:admin:rw- /shared/public
```

**ğŸ¢ éƒ¨é—¨å…±äº«ç›®å½•**ï¼š
```bash
# ç ”å‘éƒ¨é—¨å…±äº«ç›®å½•
setfacl -m g:dev-team:rwx /shared/departments/dev-shared
setfacl -d -m g:dev-team:rw- /shared/departments/dev-shared

# å…¶ä»–éƒ¨é—¨æ— è®¿é—®æƒé™
setfacl -m g:ops-team:--- /shared/departments/dev-shared
setfacl -m g:hr-team:--- /shared/departments/dev-shared
```

### 4.3 ä¸´æ—¶æ–‡ä»¶äº¤æ¢åŒº


**ä½¿ç”¨åœºæ™¯**ï¼šéƒ¨é—¨é—´ä¸´æ—¶æ–‡ä»¶ä¼ è¾“

```bash
# åˆ›å»ºä¸´æ—¶äº¤æ¢ç›®å½•
mkdir -p /shared/temp

# è®¾ç½®ç‰¹æ®Šæƒé™ï¼šæ‰€æœ‰äººå¯ä»¥ä¸Šä¼ ï¼Œä½†åªèƒ½çœ‹åˆ°è‡ªå·±çš„æ–‡ä»¶
setfacl -m g:all-employees:rwx /shared/temp
chmod +t /shared/temp  # è®¾ç½®ç²˜æ»ä½

# åˆ›å»ºæŒ‰æ—¥æœŸçš„å­ç›®å½•
mkdir -p /shared/temp/$(date +%Y-%m-%d)
setfacl -m g:all-employees:rwx /shared/temp/$(date +%Y-%m-%d)
```

> ğŸ’¡ **ç²˜æ»ä½ä½œç”¨**ï¼š
> è®¾ç½®ç²˜æ»ä½(`+t`)åï¼Œå³ä½¿ç”¨æˆ·æœ‰å†™æƒé™ï¼Œä¹Ÿåªèƒ½åˆ é™¤è‡ªå·±åˆ›å»ºçš„æ–‡ä»¶ï¼Œä¸èƒ½åˆ é™¤åˆ«äººçš„æ–‡ä»¶

### 4.4 å…±äº«ç›®å½•é…é¢ç®¡ç†


```bash
# ä¸ºä¸åŒéƒ¨é—¨è®¾ç½®å­˜å‚¨é…é¢
# ç ”å‘éƒ¨é—¨ï¼š50GBé…é¢
setquota -u dev-team 0 52428800 0 0 /shared/departments/dev-shared

# è¿è¥éƒ¨é—¨ï¼š20GBé…é¢
setquota -u ops-team 0 20971520 0 0 /shared/departments/ops-shared
```

---

## 5. â° ä¸´æ—¶æƒé™æˆäºˆæœºåˆ¶


### 5.1 ä¸´æ—¶æƒé™çš„åº”ç”¨åœºæ™¯


**å¸¸è§åœºæ™¯**ï¼š
- ğŸ”„ **é¡¹ç›®æ”¯æŒ**ï¼šå…¶ä»–éƒ¨é—¨ä¸´æ—¶æ”¯æŒæŸä¸ªé¡¹ç›®
- ğŸš¨ **ç´§æ€¥å“åº”**ï¼šæ•…éšœå¤„ç†æ—¶ä¸´æ—¶å¼€æ”¾æƒé™
- ğŸ‘¥ **å¤–éƒ¨åˆä½œ**ï¼šä¸´æ—¶åˆä½œä¼™ä¼´éœ€è¦è®¿é—®ç‰¹å®šèµ„æº
- ğŸ“ **åŸ¹è®­å®ä¹ **ï¼šå®ä¹ ç”Ÿæˆ–æ–°å‘˜å·¥çš„ä¸´æ—¶è®¿é—®æƒé™

### 5.2 åŸºäºæ—¶é—´çš„æƒé™æ§åˆ¶


**ä½¿ç”¨atå‘½ä»¤å®ç°è‡ªåŠ¨æƒé™å›æ”¶**ï¼š

```bash
#!/bin/bash
# ä¸´æ—¶æƒé™æˆäºˆè„šæœ¬ï¼štemp_permission.sh

USER=$1
DIRECTORY=$2
DURATION_HOURS=$3

# æˆäºˆä¸´æ—¶æƒé™
echo "æˆäºˆç”¨æˆ· $USER å¯¹ç›®å½• $DIRECTORY çš„ä¸´æ—¶è®¿é—®æƒé™"
setfacl -m u:$USER:rwx $DIRECTORY

# è®¾ç½®è‡ªåŠ¨å›æ”¶ä»»åŠ¡
echo "setfacl -x u:$USER $DIRECTORY" | at now + ${DURATION_HOURS} hours
echo "æƒé™å°†åœ¨ $DURATION_HOURS å°æ—¶åè‡ªåŠ¨å›æ”¶"
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```bash
# ç»™ç”¨æˆ·johnä¸´æ—¶è®¿é—®é¡¹ç›®ç›®å½•æƒé™ï¼Œ8å°æ—¶åè‡ªåŠ¨å›æ”¶
./temp_permission.sh john /enterprise/projects/project-alpha 8
```

### 5.3 ä¸´æ—¶æƒé™ç”³è¯·æµç¨‹


**æƒé™ç”³è¯·å·¥ä½œæµ**ï¼š

```
ç”³è¯·é˜¶æ®µï¼š
å‘˜å·¥ç”³è¯· â†’ ç›´å±ä¸»ç®¡å®¡æ‰¹ â†’ ITç®¡ç†å‘˜æ‰§è¡Œ
    â†“           â†“            â†“
  å¡«å†™è¡¨å•   â†’ é‚®ä»¶ç¡®è®¤  â†’ è®¾ç½®æƒé™

è‡ªåŠ¨å›æ”¶é˜¶æ®µï¼š
æƒé™åˆ°æœŸ â†’ ç³»ç»Ÿè‡ªåŠ¨å›æ”¶ â†’ é€šçŸ¥ç›¸å…³äººå‘˜
    â†“           â†“            â†“
  åˆ°æœŸæé†’  â†’ æ‰§è¡Œå›æ”¶   â†’ é‚®ä»¶é€šçŸ¥
```

**ç”³è¯·è¡¨å•æ¨¡æ¿**ï¼š
```bash
# ä¸´æ—¶æƒé™ç”³è¯·è®°å½•
echo "ç”³è¯·æ—¶é—´: $(date)" >> /var/log/temp_permissions.log
echo "ç”³è¯·äºº: $USER" >> /var/log/temp_permissions.log
echo "ç›®æ ‡ç›®å½•: $DIRECTORY" >> /var/log/temp_permissions.log
echo "æƒé™æœŸé™: $DURATION_HOURS å°æ—¶" >> /var/log/temp_permissions.log
echo "ç”³è¯·åŸå› : $REASON" >> /var/log/temp_permissions.log
echo "å®¡æ‰¹äºº: $APPROVER" >> /var/log/temp_permissions.log
echo "---" >> /var/log/temp_permissions.log
```

### 5.4 ç´§æ€¥æƒé™å¤„ç†æœºåˆ¶


**ç´§æ€¥æƒ…å†µå¿«é€Ÿå“åº”**ï¼š

```bash
#!/bin/bash
# ç´§æ€¥æƒé™è„šæœ¬ï¼šemergency_access.sh

INCIDENT_ID=$1
USER=$2
TARGET_PATH=$3

# ç«‹å³æˆäºˆç´§æ€¥æƒé™
setfacl -m u:$USER:rwx $TARGET_PATH

# è®°å½•ç´§æ€¥æƒé™ä½¿ç”¨
echo "[EMERGENCY] $(date): äº‹ä»¶ID:$INCIDENT_ID ç”¨æˆ·:$USER è·¯å¾„:$TARGET_PATH" \
    >> /var/log/emergency_access.log

# 24å°æ—¶åè‡ªåŠ¨å›æ”¶
echo "setfacl -x u:$USER $TARGET_PATH" | at now + 24 hours

# é€šçŸ¥ç®¡ç†å‘˜
mail -s "ç´§æ€¥æƒé™æˆäºˆé€šçŸ¥" admin@company.com < /tmp/emergency_notice
```

---

## 6. ğŸ”„ ACLæƒé™å˜æ›´æµç¨‹


### 6.1 æ ‡å‡†æƒé™å˜æ›´æµç¨‹


**æƒé™å˜æ›´å·¥ä½œæµç¨‹å›¾**ï¼š

```
æƒé™å˜æ›´ç”³è¯·æµç¨‹ï¼š

ç”³è¯·äºº â†’ å¡«å†™å˜æ›´ç”³è¯· â†’ éƒ¨é—¨ä¸»ç®¡å®¡æ‰¹ â†’ ITéƒ¨é—¨å®¡æ ¸ â†’ æ‰§è¡Œå˜æ›´
  â†“         â†“              â†“             â†“          â†“
ç”¨æˆ·éœ€æ±‚   è¯¦ç»†è¯´æ˜      ä¸šåŠ¡åˆç†æ€§     æŠ€æœ¯å¯è¡Œæ€§   æƒé™ç”Ÿæ•ˆ
  â†“         â†“              â†“             â†“          â†“
å·¥ä½œéœ€è¦   å½±å“è¯„ä¼°      å®‰å…¨å®¡æŸ¥      å†²çªæ£€æŸ¥    è®°å½•å¤‡æ¡ˆ

å˜æ›´åéªŒè¯ï¼š
æƒé™æµ‹è¯• â†’ åŠŸèƒ½éªŒè¯ â†’ å®‰å…¨æ£€æŸ¥ â†’ é€šçŸ¥ç›¸å…³äººå‘˜
```

### 6.2 æƒé™å˜æ›´åˆ†ç±»å¤„ç†


**ğŸŸ¢ ä½é£é™©å˜æ›´**ï¼ˆè‡ªåŠ¨åŒ–å¤„ç†ï¼‰ï¼š
```bash
# ä¸ªäººç›®å½•æƒé™è°ƒæ•´
# å›¢é˜Ÿå†…éƒ¨æƒé™å¾®è°ƒ
# ä¸´æ—¶åªè¯»æƒé™æ·»åŠ 

# è‡ªåŠ¨åŒ–è„šæœ¬ç¤ºä¾‹
if [ "$RISK_LEVEL" == "LOW" ]; then
    # ç›´æ¥æ‰§è¡Œå˜æ›´
    setfacl -m u:$USER:$PERMISSIONS $TARGET_PATH
    echo "ä½é£é™©æƒé™å˜æ›´å·²è‡ªåŠ¨æ‰§è¡Œ" | mail -s "æƒé™å˜æ›´é€šçŸ¥" $USER
fi
```

**ğŸŸ¡ ä¸­é£é™©å˜æ›´**ï¼ˆéœ€è¦å®¡æ‰¹ï¼‰ï¼š
```bash
# è·¨éƒ¨é—¨æƒé™è®¿é—®
# ç”Ÿäº§ç¯å¢ƒæƒé™è°ƒæ•´
# æ‰¹é‡ç”¨æˆ·æƒé™å˜æ›´

# éœ€è¦ä¸»ç®¡å®¡æ‰¹
if [ "$RISK_LEVEL" == "MEDIUM" ]; then
    echo "æƒé™å˜æ›´ç”³è¯·éœ€è¦ä¸»ç®¡å®¡æ‰¹"
    # å‘é€å®¡æ‰¹é‚®ä»¶
    send_approval_request "$USER" "$PERMISSIONS" "$TARGET_PATH"
fi
```

**ğŸ”´ é«˜é£é™©å˜æ›´**ï¼ˆä¸¥æ ¼æ§åˆ¶ï¼‰ï¼š
```bash
# ç®¡ç†å‘˜æƒé™å˜æ›´
# æ•æ„Ÿæ•°æ®è®¿é—®æƒé™
# å¤§è§„æ¨¡æƒé™è°ƒæ•´

# éœ€è¦å¤šçº§å®¡æ‰¹å’Œå®‰å…¨æ£€æŸ¥
if [ "$RISK_LEVEL" == "HIGH" ]; then
    echo "é«˜é£é™©æƒé™å˜æ›´éœ€è¦å®‰å…¨å§”å‘˜ä¼šå®¡æ‰¹"
    security_review_required=true
fi
```

### 6.3 æƒé™å˜æ›´æ‰§è¡Œè„šæœ¬


```bash
#!/bin/bash
# æƒé™å˜æ›´æ‰§è¡Œè„šæœ¬ï¼šacl_change_executor.sh

CHANGE_ID=$1
USER=$2
ACTION=$3  # add, modify, remove
PERMISSIONS=$4
TARGET_PATH=$5

# å¤‡ä»½å½“å‰æƒé™
getfacl $TARGET_PATH > /backup/acl_backups/before_${CHANGE_ID}.acl

case $ACTION in
    "add")
        setfacl -m u:$USER:$PERMISSIONS $TARGET_PATH
        ;;
    "modify")
        setfacl -m u:$USER:$PERMISSIONS $TARGET_PATH
        ;;
    "remove")
        setfacl -x u:$USER $TARGET_PATH
        ;;
esac

# å¤‡ä»½å˜æ›´åæƒé™
getfacl $TARGET_PATH > /backup/acl_backups/after_${CHANGE_ID}.acl

# è®°å½•å˜æ›´
echo "$(date): å˜æ›´ID:$CHANGE_ID ç”¨æˆ·:$USER æ“ä½œ:$ACTION æƒé™:$PERMISSIONS è·¯å¾„:$TARGET_PATH" \
    >> /var/log/acl_changes.log
```

### 6.4 æƒé™å˜æ›´å›æ»šæœºåˆ¶


```bash
#!/bin/bash
# æƒé™å›æ»šè„šæœ¬ï¼šacl_rollback.sh

CHANGE_ID=$1
BACKUP_FILE="/backup/acl_backups/before_${CHANGE_ID}.acl"

if [ -f "$BACKUP_FILE" ]; then
    # æ¢å¤åˆ°å˜æ›´å‰çš„çŠ¶æ€
    setfacl --restore=$BACKUP_FILE
    echo "æƒé™å·²å›æ»šåˆ°å˜æ›´å‰çŠ¶æ€"
    
    # è®°å½•å›æ»šæ“ä½œ
    echo "$(date): æƒé™å›æ»š - å˜æ›´ID:$CHANGE_ID" >> /var/log/acl_rollbacks.log
else
    echo "é”™è¯¯ï¼šæ‰¾ä¸åˆ°å¤‡ä»½æ–‡ä»¶ $BACKUP_FILE"
    exit 1
fi
```

---

## 7. ğŸ” æƒé™å®¡è®¡ä¸åˆè§„æ£€æŸ¥


### 7.1 æƒé™å®¡è®¡çš„é‡è¦æ€§


**ä¸ºä»€ä¹ˆéœ€è¦æƒé™å®¡è®¡**ï¼š
- ğŸ›¡ï¸ **å®‰å…¨åˆè§„**ï¼šæ»¡è¶³ä¼ä¸šå®‰å…¨æ”¿ç­–å’Œæ³•è§„è¦æ±‚
- ğŸ” **é£é™©è¯†åˆ«**ï¼šå‘ç°è¿‡åº¦æˆæƒå’Œæƒé™æ»¥ç”¨
- ğŸ“Š **ä½¿ç”¨åˆ†æ**ï¼šäº†è§£æƒé™ä½¿ç”¨æƒ…å†µå’Œä¼˜åŒ–éœ€æ±‚
- ğŸš¨ **å¼‚å¸¸æ£€æµ‹**ï¼šåŠæ—¶å‘ç°æƒé™ç›¸å…³çš„å®‰å…¨äº‹ä»¶

### 7.2 è‡ªåŠ¨åŒ–æƒé™æ£€æŸ¥è„šæœ¬


**æ—¥å¸¸æƒé™å¥åº·æ£€æŸ¥**ï¼š

```bash
#!/bin/bash
# æƒé™å¥åº·æ£€æŸ¥è„šæœ¬ï¼šacl_health_check.sh

REPORT_DATE=$(date +%Y-%m-%d)
REPORT_FILE="/reports/acl_health_${REPORT_DATE}.txt"

echo "=== ACLæƒé™å¥åº·æ£€æŸ¥æŠ¥å‘Š ===" > $REPORT_FILE
echo "æ£€æŸ¥æ—¶é—´: $(date)" >> $REPORT_FILE
echo "" >> $REPORT_FILE

# 1. æ£€æŸ¥å¼‚å¸¸æƒé™
echo "### å¼‚å¸¸æƒé™æ£€æŸ¥ ###" >> $REPORT_FILE
find /enterprise -type f -perm -o+w | head -10 >> $REPORT_FILE

# 2. æ£€æŸ¥ç©ºæƒé™ç›®å½•
echo -e "\n### ç©ºæƒé™ç›®å½•æ£€æŸ¥ ###" >> $REPORT_FILE
find /enterprise -type d -empty >> $REPORT_FILE

# 3. æ£€æŸ¥æƒé™é…ç½®æœ€å¤šçš„æ–‡ä»¶
echo -e "\n### å¤æ‚æƒé™é…ç½® ###" >> $REPORT_FILE
find /enterprise -type f -exec getfacl {} \; | grep -c "user:" | sort -nr | head -5

# 4. ç»Ÿè®¡æƒé™ä½¿ç”¨æƒ…å†µ
echo -e "\n### æƒé™ç»Ÿè®¡ ###" >> $REPORT_FILE
echo "æ€»ç”¨æˆ·æ•°: $(getent passwd | wc -l)" >> $REPORT_FILE
echo "æ€»ç»„æ•°: $(getent group | wc -l)" >> $REPORT_FILE
echo "è®¾ç½®ACLçš„æ–‡ä»¶æ•°: $(find /enterprise -type f -exec getfacl {} \; 2>/dev/null | grep -c "user:")" >> $REPORT_FILE
```

### 7.3 ç”¨æˆ·æƒé™å®¡è®¡


**å®šæœŸç”¨æˆ·æƒé™æ£€æŸ¥**ï¼š

```bash
#!/bin/bash
# ç”¨æˆ·æƒé™å®¡è®¡è„šæœ¬ï¼šuser_permission_audit.sh

USER=$1
AUDIT_DATE=$(date +%Y-%m-%d)

echo "=== ç”¨æˆ·æƒé™å®¡è®¡æŠ¥å‘Šï¼š$USER ===" 
echo "å®¡è®¡æ—¥æœŸ: $AUDIT_DATE"
echo ""

# æ£€æŸ¥ç”¨æˆ·æ‰€å±ç»„
echo "ç”¨æˆ·æ‰€å±ç»„:"
groups $USER

# æ£€æŸ¥ç”¨æˆ·æœ‰ACLæƒé™çš„ç›®å½•
echo -e "\nç”¨æˆ·ACLæƒé™ç›®å½•:"
find /enterprise -type d -exec getfacl {} \; 2>/dev/null | \
    grep -B5 "user:$USER" | grep "# file:" | cut -d' ' -f3

# æ£€æŸ¥ç”¨æˆ·æœ€è¿‘çš„æ–‡ä»¶è®¿é—®
echo -e "\næœ€è¿‘è®¿é—®çš„æ–‡ä»¶:"
find /enterprise -type f -user $USER -atime -7 | head -10

# æ£€æŸ¥ç”¨æˆ·æƒé™ç­‰çº§
echo -e "\næƒé™ç­‰çº§åˆ†æ:"
if groups $USER | grep -q "admin"; then
    echo "âš ï¸  ç®¡ç†å‘˜çº§åˆ«æƒé™"
elif groups $USER | grep -q "manager"; then
    echo "ğŸ“‹ ç®¡ç†çº§åˆ«æƒé™"
else
    echo "ğŸ‘¤ æ™®é€šç”¨æˆ·æƒé™"
fi
```

### 7.4 åˆè§„æ£€æŸ¥æ¸…å•


**ä¼ä¸šACLåˆè§„æ£€æŸ¥é¡¹ç›®**ï¼š

```
ğŸ”² æƒé™æœ€å°åŒ–åŸåˆ™æ£€æŸ¥
   â”œâ”€â”€ ç”¨æˆ·æƒé™æ˜¯å¦è¶…å‡ºå·¥ä½œéœ€è¦
   â”œâ”€â”€ ä¸´æ—¶æƒé™æ˜¯å¦åŠæ—¶å›æ”¶
   â””â”€â”€ ç¦»èŒå‘˜å·¥æƒé™æ˜¯å¦æ¸…ç†

ğŸ”² æ•æ„Ÿæ•°æ®ä¿æŠ¤æ£€æŸ¥
   â”œâ”€â”€ è´¢åŠ¡æ•°æ®è®¿é—®æƒé™
   â”œâ”€â”€ å®¢æˆ·ä¿¡æ¯ä¿æŠ¤çº§åˆ«
   â””â”€â”€ å•†ä¸šæœºå¯†è®¿é—®æ§åˆ¶

ğŸ”² æƒé™å˜æ›´è®°å½•æ£€æŸ¥
   â”œâ”€â”€ æ‰€æœ‰æƒé™å˜æ›´æ˜¯å¦æœ‰è®°å½•
   â”œâ”€â”€ å˜æ›´æ˜¯å¦æœ‰é€‚å½“å®¡æ‰¹
   â””â”€â”€ ç´§æ€¥æƒé™ä½¿ç”¨æ˜¯å¦åˆè§„

ğŸ”² å®šæœŸæƒé™æ¸…ç†æ£€æŸ¥
   â”œâ”€â”€ ä¸æ´»è·ƒç”¨æˆ·æƒé™æ¸…ç†
   â”œâ”€â”€ è¿‡æœŸæƒé™è‡ªåŠ¨å›æ”¶
   â””â”€â”€ æƒé™é…ç½®ä¼˜åŒ–æ›´æ–°
```

**åˆè§„æ£€æŸ¥è‡ªåŠ¨åŒ–è„šæœ¬**ï¼š

```bash
#!/bin/bash
# åˆè§„æ£€æŸ¥è„šæœ¬ï¼šcompliance_check.sh

CHECK_DATE=$(date +%Y-%m-%d)
COMPLIANCE_REPORT="/reports/compliance_${CHECK_DATE}.txt"

echo "=== ä¼ä¸šACLåˆè§„æ£€æŸ¥æŠ¥å‘Š ===" > $COMPLIANCE_REPORT

# æ£€æŸ¥1: è¿‡åº¦æƒé™æ£€æŸ¥
echo "### è¿‡åº¦æƒé™ç”¨æˆ· ###" >> $COMPLIANCE_REPORT
for user in $(getent passwd | cut -d: -f1); do
    perm_count=$(find /enterprise -type f -exec getfacl {} \; 2>/dev/null | grep -c "user:$user")
    if [ $perm_count -gt 50 ]; then
        echo "âš ï¸  ç”¨æˆ· $user æœ‰ $perm_count ä¸ªæƒé™é…ç½®" >> $COMPLIANCE_REPORT
    fi
done

# æ£€æŸ¥2: é•¿æœŸæœªä½¿ç”¨çš„æƒé™
echo -e "\n### é•¿æœŸæœªä½¿ç”¨æƒé™ ###" >> $COMPLIANCE_REPORT
find /enterprise -type f -atime +90 -exec getfacl {} \; 2>/dev/null | \
    grep "user:" | cut -d: -f2 | sort | uniq -c | sort -nr >> $COMPLIANCE_REPORT
```

---

## 8. ğŸ¤– ACLæƒé™è‡ªåŠ¨åŒ–ç®¡ç†


### 8.1 è‡ªåŠ¨åŒ–ç®¡ç†çš„ä¼˜åŠ¿


**ä¸ºä»€ä¹ˆè¦è‡ªåŠ¨åŒ–**ï¼š
- âš¡ **æé«˜æ•ˆç‡**ï¼šå‡å°‘æ‰‹å·¥æ“ä½œï¼Œé™ä½å‡ºé”™ç‡
- ğŸ¯ **æ ‡å‡†åŒ–**ï¼šç¡®ä¿æƒé™é…ç½®çš„ä¸€è‡´æ€§
- ğŸ“ˆ **å¯æ‰©å±•**ï¼šè½»æ¾å¤„ç†å¤§è§„æ¨¡æƒé™ç®¡ç†
- ğŸ”„ **åŠæ—¶å“åº”**ï¼šå¿«é€Ÿå“åº”æƒé™å˜æ›´éœ€æ±‚

### 8.2 åŸºäºLDAPçš„ç”¨æˆ·ç»„ç»‡ç»“æ„


**LDAPé›†æˆæ¶æ„**ï¼š

```
LDAPç›®å½•ç»“æ„ï¼š
dc=company,dc=com
â”œâ”€â”€ ou=people                    â† ç”¨æˆ·ä¿¡æ¯
â”‚   â”œâ”€â”€ cn=alice,ou=people      â† å…·ä½“ç”¨æˆ·
â”‚   â””â”€â”€ cn=bob,ou=people
â”œâ”€â”€ ou=groups                   â† ç”¨æˆ·ç»„ä¿¡æ¯  
â”‚   â”œâ”€â”€ cn=dev-team,ou=groups   â† å¼€å‘å›¢é˜Ÿç»„
â”‚   â””â”€â”€ cn=ops-team,ou=groups   â† è¿ç»´å›¢é˜Ÿç»„
â””â”€â”€ ou=roles                    â† è§’è‰²å®šä¹‰
    â”œâ”€â”€ cn=manager,ou=roles     â† ç®¡ç†è€…è§’è‰²
    â””â”€â”€ cn=employee,ou=roles    â† å‘˜å·¥è§’è‰²
```

**LDAPæƒé™åŒæ­¥è„šæœ¬**ï¼š

```bash
#!/bin/bash
# LDAPæƒé™åŒæ­¥è„šæœ¬ï¼šldap_acl_sync.sh

LDAP_SERVER="ldap://ldap.company.com"
BIND_DN="cn=admin,dc=company,dc=com"

# ä»LDAPè·å–ç”¨æˆ·ç»„ä¿¡æ¯
get_user_groups() {
    local username=$1
    ldapsearch -x -H $LDAP_SERVER -D $BIND_DN -w $LDAP_PASS \
        "(uid=$username)" memberOf | grep "memberOf:" | cut -d' ' -f2
}

# æ ¹æ®LDAPç»„ç»‡ç»“æ„è®¾ç½®æƒé™
sync_permissions() {
    for user in $(ldapsearch -x -H $LDAP_SERVER -D $BIND_DN -w $LDAP_PASS \
                  "(objectClass=person)" uid | grep "uid:" | cut -d' ' -f2); do
        
        # è·å–ç”¨æˆ·æ‰€å±éƒ¨é—¨
        department=$(ldapsearch -x -H $LDAP_SERVER -D $BIND_DN -w $LDAP_PASS \
                    "(uid=$user)" departmentNumber | grep "departmentNumber:" | cut -d' ' -f2)
        
        # æ ¹æ®éƒ¨é—¨è®¾ç½®åŸºç¡€æƒé™
        case $department in
            "dev")
                setfacl -m u:$user:rwx /enterprise/dev
                ;;
            "ops")
                setfacl -m u:$user:rwx /enterprise/ops
                ;;
            "hr")
                setfacl -m u:$user:rwx /enterprise/hr
                ;;
        esac
        
        echo "å·²åŒæ­¥ç”¨æˆ· $user çš„æƒé™"
    done
}
```

### 8.3 é…ç½®æ–‡ä»¶é©±åŠ¨çš„æƒé™ç®¡ç†


**æƒé™é…ç½®æ–‡ä»¶æ ¼å¼**ï¼ˆYAMLï¼‰ï¼š

```yaml
# acl_config.yaml - æƒé™é…ç½®æ–‡ä»¶
departments:
  development:
    base_path: "/enterprise/dev"
    managers:
      - alice
      - bob
    teams:
      frontend:
        members: [charlie, david, eve]
        permissions:
          - path: "/enterprise/dev/frontend"
            access: "rwx"
          - path: "/enterprise/dev/shared"
            access: "r-x"
      backend:
        members: [frank, grace, henry]
        permissions:
          - path: "/enterprise/dev/backend"
            access: "rwx"
          - path: "/enterprise/dev/database"
            access: "rw-"

projects:
  project-alpha:
    base_path: "/enterprise/projects/alpha"
    roles:
      project_manager: [alice]
      developers: [charlie, frank]
      testers: [david, grace]
    permissions:
      docs:
        project_manager: "rwx"
        developers: "rw-"
        testers: "r--"
      source:
        developers: "rwx"
        testers: "r-x"
```

**é…ç½®è§£æå’Œåº”ç”¨è„šæœ¬**ï¼š

```bash
#!/bin/bash
# é…ç½®é©±åŠ¨æƒé™ç®¡ç†ï¼šconfig_driven_acl.sh

CONFIG_FILE="/etc/acl_config.yaml"

# è§£æYAMLé…ç½®å¹¶åº”ç”¨æƒé™
apply_department_permissions() {
    # ä½¿ç”¨Pythonè„šæœ¬è§£æYAMLé…ç½®
    python3 << EOF
import yaml
import subprocess
import sys

with open('$CONFIG_FILE', 'r') as file:
    config = yaml.safe_load(file)

for dept_name, dept_config in config.get('departments', {}).items():
    base_path = dept_config['base_path']
    
    # è®¾ç½®ç®¡ç†å‘˜æƒé™
    for manager in dept_config.get('managers', []):
        cmd = f"setfacl -m u:{manager}:rwx {base_path}"
        subprocess.run(cmd, shell=True)
        print(f"è®¾ç½®ç®¡ç†å‘˜æƒé™: {manager} -> {base_path}")
    
    # è®¾ç½®å›¢é˜Ÿæƒé™
    for team_name, team_config in dept_config.get('teams', {}).items():
        for member in team_config.get('members', []):
            for perm in team_config.get('permissions', []):
                path = perm['path']
                access = perm['access']
                cmd = f"setfacl -m u:{member}:{access} {path}"
                subprocess.run(cmd, shell=True)
                print(f"è®¾ç½®å›¢é˜Ÿæƒé™: {member} -> {path} ({access})")
EOF
}

# æ‰§è¡Œæƒé™é…ç½®
apply_department_permissions
```

### 8.4 å®šæ—¶ä»»åŠ¡å’Œç›‘æ§


**è‡ªåŠ¨åŒ–æƒé™ç®¡ç†å®šæ—¶ä»»åŠ¡**ï¼š

```bash
# æ·»åŠ åˆ°crontabä¸­çš„å®šæ—¶ä»»åŠ¡
# æ¯å¤©å‡Œæ™¨2ç‚¹åŒæ­¥LDAPæƒé™
0 2 * * * /scripts/ldap_acl_sync.sh >> /var/log/acl_sync.log 2>&1

# æ¯å‘¨ä¸€è¿›è¡Œæƒé™å¥åº·æ£€æŸ¥
0 8 * * 1 /scripts/acl_health_check.sh

# æ¯æœˆç¬¬ä¸€å¤©ç”Ÿæˆåˆè§„æŠ¥å‘Š
0 9 1 * * /scripts/compliance_check.sh

# æ¯å°æ—¶æ£€æŸ¥ä¸´æ—¶æƒé™æ˜¯å¦åˆ°æœŸ
0 * * * * /scripts/temp_permission_cleanup.sh
```

**æƒé™å˜æ›´ç›‘æ§è„šæœ¬**ï¼š

```bash
#!/bin/bash
# æƒé™ç›‘æ§è„šæœ¬ï¼šacl_monitor.sh

WATCH_DIRS="/enterprise /shared"
LOG_FILE="/var/log/acl_monitor.log"

# ä½¿ç”¨inotifyç›‘æ§æƒé™å˜æ›´
inotifywait -m -r -e attrib $WATCH_DIRS --format '%w%f %e %T' --timefmt '%Y-%m-%d %H:%M:%S' | \
while read FILE EVENT TIME; do
    # æ£€æŸ¥æ˜¯å¦æ˜¯æƒé™ç›¸å…³å˜æ›´
    if [[ $EVENT == *"ATTRIB"* ]]; then
        echo "[$TIME] æƒé™å˜æ›´æ£€æµ‹: $FILE" >> $LOG_FILE
        
        # è·å–å½“å‰æƒé™ä¿¡æ¯
        getfacl "$FILE" >> $LOG_FILE
        
        # å¦‚æœæ˜¯æ•æ„Ÿç›®å½•ï¼Œå‘é€å‘Šè­¦
        if [[ $FILE == *"/finance/"* ]] || [[ $FILE == *"/hr/"* ]]; then
            echo "æ•æ„Ÿç›®å½•æƒé™å˜æ›´è­¦å‘Š: $FILE" | \
                mail -s "æƒé™å˜æ›´è­¦å‘Š" security@company.com
        fi
    fi
done
```

---

## 9. ğŸ—ï¸ å¤§è§„æ¨¡ACLéƒ¨ç½²ç­–ç•¥


### 9.1 å¤§è§„æ¨¡éƒ¨ç½²é¢ä¸´çš„æŒ‘æˆ˜


**ä¼ä¸šçº§éƒ¨ç½²æŒ‘æˆ˜**ï¼š
- ğŸ“Š **è§„æ¨¡åºå¤§**ï¼šæ•°åƒç”¨æˆ·ã€æ•°ä¸‡æ–‡ä»¶éœ€è¦æƒé™ç®¡ç†
- ğŸ”„ **é¢‘ç¹å˜æ›´**ï¼šäººå‘˜æµåŠ¨ã€é¡¹ç›®è°ƒæ•´å¯¼è‡´æƒé™é¢‘ç¹å˜åŒ–
- âš¡ **æ€§èƒ½è¦æ±‚**ï¼šå¤§é‡æƒé™æŸ¥è¯¢ä¸èƒ½å½±å“ç³»ç»Ÿæ€§èƒ½
- ğŸ›¡ï¸ **ä¸€è‡´æ€§ä¿è¯**ï¼šå¤šæœåŠ¡å™¨ç¯å¢ƒä¸‹æƒé™é…ç½®çš„ä¸€è‡´æ€§

### 9.2 åˆ†å±‚éƒ¨ç½²æ¶æ„


**ä¸‰å±‚æƒé™ç®¡ç†æ¶æ„**ï¼š

```
æƒé™ç®¡ç†åˆ†å±‚æ¶æ„ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç®¡ç†å±‚ (Management)          â”‚  â† æƒé™ç­–ç•¥åˆ¶å®š
â”‚   - æƒé™ç­–ç•¥ç®¡ç†                     â”‚
â”‚   - åˆè§„æ£€æŸ¥ç›‘ç£                     â”‚
â”‚   - å®¡è®¡æŠ¥å‘Šç”Ÿæˆ                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ§åˆ¶å±‚ (Control)            â”‚  â† æƒé™é…ç½®åˆ†å‘
â”‚   - LDAP/ADé›†æˆ                    â”‚
â”‚   - æƒé™é…ç½®æ¨¡æ¿                    â”‚
â”‚   - è‡ªåŠ¨åŒ–è„šæœ¬æ‰§è¡Œ                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ‰§è¡Œå±‚ (Execution)          â”‚  â† å…·ä½“æƒé™å®æ–½
â”‚   - æ–‡ä»¶æœåŠ¡å™¨æƒé™è®¾ç½®               â”‚
â”‚   - æƒé™å˜æ›´æ‰§è¡Œ                     â”‚
â”‚   - çŠ¶æ€ç›‘æ§åé¦ˆ                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.3 æ‰¹é‡æƒé™éƒ¨ç½²è„šæœ¬


**å¤§è§„æ¨¡ç”¨æˆ·æƒé™åˆå§‹åŒ–**ï¼š

```bash
#!/bin/bash
# å¤§è§„æ¨¡æƒé™éƒ¨ç½²è„šæœ¬ï¼šmass_acl_deployment.sh

DEPLOYMENT_CONFIG="/config/mass_deployment.conf"
PARALLEL_JOBS=10  # å¹¶å‘ä»»åŠ¡æ•°

# è¯»å–éƒ¨ç½²é…ç½®
source $DEPLOYMENT_CONFIG

# å¹¶å‘å¤„ç†ç”¨æˆ·æƒé™è®¾ç½®
deploy_user_permissions() {
    local user_list=$1
    local target_path=$2
    local permissions=$3
    
    # ä½¿ç”¨GNU parallelè¿›è¡Œå¹¶å‘å¤„ç†
    cat $user_list | parallel -j $PARALLEL_JOBS \
        "setfacl -m u:{}:$permissions $target_path && echo 'ç”¨æˆ· {} æƒé™è®¾ç½®å®Œæˆ'"
}

# æ‰¹é‡åˆ›å»ºç›®å½•ç»“æ„
create_directory_structure() {
    local structure_file=$1
    
    while IFS=',' read -r path owner group permissions; do
        mkdir -p "$path"
        chown "$owner:$group" "$path"
        chmod "$permissions" "$path"
        echo "ç›®å½•åˆ›å»ºå®Œæˆ: $path"
    done < "$structure_file"
}

# ä¸»éƒ¨ç½²æµç¨‹
main() {
    echo "å¼€å§‹å¤§è§„æ¨¡ACLæƒé™éƒ¨ç½²..."
    
    # 1. åˆ›å»ºç›®å½•ç»“æ„
    create_directory_structure "/config/directory_structure.csv"
    
    # 2. éƒ¨ç½²éƒ¨é—¨æƒé™
    for dept in dev ops hr finance; do
        echo "æ­£åœ¨éƒ¨ç½² $dept éƒ¨é—¨æƒé™..."
        deploy_user_permissions "/config/${dept}_users.txt" \
                               "/enterprise/$dept" "rwx"
    done
    
    # 3. éƒ¨ç½²é¡¹ç›®æƒé™
    for project in $(ls /config/projects/); do
        echo "æ­£åœ¨éƒ¨ç½²é¡¹ç›® $project æƒé™..."
        deploy_project_permissions "/config/projects/$project"
    done
    
    echo "å¤§è§„æ¨¡ACLæƒé™éƒ¨ç½²å®Œæˆï¼"
}

# æ‰§è¡Œéƒ¨ç½²
main
```

### 9.4 æƒé™é…ç½®æ¨¡æ¿åŒ–


**éƒ¨é—¨æƒé™é…ç½®æ¨¡æ¿**ï¼š

```bash
# éƒ¨é—¨æƒé™æ¨¡æ¿ï¼šdepartment_template.sh
create_department_structure() {
    local DEPT_NAME=$1
    local DEPT_PATH="/enterprise/$DEPT_NAME"
    local DEPT_MANAGER=$2
    
    # åˆ›å»ºéƒ¨é—¨æ ‡å‡†ç›®å½•ç»“æ„
    mkdir -p $DEPT_PATH/{management,teams,shared,temp,archive}
    
    # è®¾ç½®éƒ¨é—¨ç»ç†æƒé™
    setfacl -R -m u:$DEPT_MANAGER:rwx $DEPT_PATH
    setfacl -R -d -m u:$DEPT_MANAGER:rwx $DEPT_PATH
    
    # è®¾ç½®å„å­ç›®å½•æƒé™
    # ç®¡ç†ç›®å½•ï¼šåªæœ‰ç»ç†å¯è®¿é—®
    setfacl -m g:${DEPT_NAME}-team:--- $DEPT_PATH/management
    
    # å›¢é˜Ÿç›®å½•ï¼šå›¢é˜Ÿæˆå‘˜å¯è®¿é—®
    setfacl -m g:${DEPT_NAME}-team:rwx $DEPT_PATH/teams
    setfacl -d -m g:${DEPT_NAME}-team:rw- $DEPT_PATH/teams
    
    # å…±äº«ç›®å½•ï¼šéƒ¨é—¨å†…å…±äº«
    setfacl -m g:${DEPT_NAME}-team:rwx $DEPT_PATH/shared
    setfacl -d -m g:${DEPT_NAME}-team:rw- $DEPT_PATH/shared
    
    # ä¸´æ—¶ç›®å½•ï¼šæ‰€æœ‰äººå¯å†™ï¼Œä½†æœ‰ç²˜æ»ä½
    setfacl -m g:${DEPT_NAME}-team:rwx $DEPT_PATH/temp
    chmod +t $DEPT_PATH/temp
    
    # å½’æ¡£ç›®å½•ï¼šåªè¯»æƒé™
    setfacl -m g:${DEPT_NAME}-team:r-x $DEPT_PATH/archive
    
    echo "éƒ¨é—¨ $DEPT_NAME æƒé™ç»“æ„åˆ›å»ºå®Œæˆ"
}

# ä½¿ç”¨æ¨¡æ¿åˆ›å»ºå„éƒ¨é—¨
create_department_structure "development" "dev-manager"
create_department_structure "operations" "ops-manager" 
create_department_structure "humanresources" "hr-manager"
```

### 9.5 å¤šæœåŠ¡å™¨æƒé™åŒæ­¥


**æœåŠ¡å™¨é—´æƒé™åŒæ­¥ç­–ç•¥**ï¼š

```bash
#!/bin/bash
# å¤šæœåŠ¡å™¨æƒé™åŒæ­¥ï¼šmulti_server_sync.sh

SERVER_LIST="/config/server_list.txt"
MASTER_SERVER="master.company.com"
SYNC_PATHS="/enterprise /shared"

# ä»ä¸»æœåŠ¡å™¨åŒæ­¥æƒé™é…ç½®
sync_acl_from_master() {
    local target_server=$1
    
    for path in $SYNC_PATHS; do
        echo "æ­£åœ¨åŒæ­¥ $path åˆ° $target_server..."
        
        # 1. åŒæ­¥ç›®å½•ç»“æ„
        rsync -av --delete $MASTER_SERVER:$path/ $target_server:$path/
        
        # 2. åŒæ­¥ACLæƒé™
        ssh $MASTER_SERVER "getfacl -R $path" | \
            ssh $target_server "setfacl --restore=-"
        
        echo "$path åŒæ­¥åˆ° $target_server å®Œæˆ"
    done
}

# å¹¶å‘åŒæ­¥åˆ°æ‰€æœ‰æœåŠ¡å™¨
while read server; do
    if [ "$server" != "$MASTER_SERVER" ]; then
        sync_acl_from_master "$server" &
    fi
done < $SERVER_LIST

# ç­‰å¾…æ‰€æœ‰åŒæ­¥ä»»åŠ¡å®Œæˆ
wait
echo "æ‰€æœ‰æœåŠ¡å™¨æƒé™åŒæ­¥å®Œæˆ"
```

### 9.6 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


**å¤§è§„æ¨¡ACLæ€§èƒ½ä¼˜åŒ–æŠ€å·§**ï¼š

```bash
# 1. ä½¿ç”¨é»˜è®¤ACLå‡å°‘é‡å¤è®¾ç½®
setfacl -d -m g:dev-team:rw- /enterprise/dev

# 2. æ‰¹é‡æ“ä½œæ›¿ä»£é€ä¸ªè®¾ç½®
find /enterprise/dev -type f -name "*.txt" -exec setfacl -m u:alice:rw- {} +

# 3. ä½¿ç”¨æƒé™ç»§æ‰¿å‡å°‘é…ç½®å¤æ‚åº¦
# åœ¨çˆ¶ç›®å½•è®¾ç½®é»˜è®¤æƒé™ï¼Œå­ç›®å½•è‡ªåŠ¨ç»§æ‰¿

# 4. å®šæœŸæ¸…ç†æ— ç”¨çš„ACLæ¡ç›®
find /enterprise -type f -exec setfacl -b {} \; 2>/dev/null | grep -v "Operation not supported"
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ACLæƒé™è§„åˆ’æœ¬è´¨ï¼šä¸ºä¼ä¸šæ–‡ä»¶ç³»ç»Ÿåˆ¶å®šç²¾ç¡®çš„è®¿é—®æ§åˆ¶ç­–ç•¥
ğŸ”¸ åˆ†å±‚æƒé™ç®¡ç†ï¼šéƒ¨é—¨â†’å›¢é˜Ÿâ†’ä¸ªäººçš„ä¸‰å±‚æƒé™æ¶æ„
ğŸ”¸ æƒé™æœ€å°åŒ–åŸåˆ™ï¼šæ¯ä¸ªç”¨æˆ·åªè·å¾—å®Œæˆå·¥ä½œæ‰€éœ€çš„æœ€å°æƒé™
ğŸ”¸ ä¸´æ—¶æƒé™æœºåˆ¶ï¼šåŸºäºæ—¶é—´çš„ä¸´æ—¶æƒé™æˆäºˆå’Œè‡ªåŠ¨å›æ”¶
ğŸ”¸ æƒé™å˜æ›´æµç¨‹ï¼šç”³è¯·â†’å®¡æ‰¹â†’æ‰§è¡Œâ†’éªŒè¯çš„æ ‡å‡†åŒ–æµç¨‹
ğŸ”¸ å®¡è®¡åˆè§„è¦æ±‚ï¼šå®šæœŸæƒé™æ£€æŸ¥å’Œåˆè§„æ€§å®¡è®¡
ğŸ”¸ è‡ªåŠ¨åŒ–ç®¡ç†ï¼šé€šè¿‡è„šæœ¬å’Œé…ç½®æ–‡ä»¶å®ç°æƒé™è‡ªåŠ¨åŒ–ç®¡ç†
ğŸ”¸ å¤§è§„æ¨¡éƒ¨ç½²ï¼šåˆ†å±‚æ¶æ„å’Œå¹¶å‘å¤„ç†çš„ä¼ä¸šçº§éƒ¨ç½²ç­–ç•¥
```

### 10.2 å®é™…åº”ç”¨è¦ç‚¹


**ğŸ”¹ æƒé™è§„åˆ’è®¾è®¡åŸåˆ™**
```
å®‰å…¨æ€§ä¼˜å…ˆï¼š
- æ•æ„Ÿæ•°æ®ä¸¥æ ¼æ§åˆ¶è®¿é—®æƒé™
- å…³é”®ç³»ç»Ÿé‡‡ç”¨å¤šé‡æƒé™éªŒè¯
- å®šæœŸå®¡è®¡å’Œæƒé™æ¸…ç†

å®ç”¨æ€§å¹³è¡¡ï¼š
- æƒé™è®¾ç½®ä¸èƒ½è¿‡äºå¤æ‚å½±å“å·¥ä½œæ•ˆç‡
- æä¾›ä¾¿æ·çš„æƒé™ç”³è¯·å’Œå®¡æ‰¹æµç¨‹
- è‡ªåŠ¨åŒ–å¤„ç†å¸¸è§æƒé™æ“ä½œ

å¯ç»´æŠ¤æ€§è€ƒè™‘ï¼š
- ä½¿ç”¨æ ‡å‡†åŒ–çš„æƒé™é…ç½®æ¨¡æ¿
- æ–‡æ¡£åŒ–æ‰€æœ‰æƒé™è®¾ç½®çš„åŸå› å’Œä¾æ®
- å»ºç«‹æƒé™å˜æ›´çš„è¿½è¸ªå’Œå›æ»šæœºåˆ¶
```

**ğŸ”¹ éƒ¨ç½²å®æ–½å»ºè®®**
```
æ¸è¿›å¼éƒ¨ç½²ï¼š
1. å…ˆåœ¨å°èŒƒå›´è¯•ç‚¹éªŒè¯æ–¹æ¡ˆå¯è¡Œæ€§
2. é€æ­¥æ‰©å±•åˆ°å„ä¸ªéƒ¨é—¨å’Œé¡¹ç›®
3. æœ€åå½¢æˆä¼ä¸šçº§çš„ç»Ÿä¸€æƒé™ç®¡ç†ä½“ç³»

ç›‘æ§å’Œä¼˜åŒ–ï¼š
1. å»ºç«‹æƒé™ä½¿ç”¨æƒ…å†µçš„ç›‘æ§æœºåˆ¶
2. å®šæœŸæ”¶é›†ç”¨æˆ·åé¦ˆä¼˜åŒ–æƒé™é…ç½®
3. æŒç»­æ”¹è¿›æƒé™ç®¡ç†æµç¨‹å’Œå·¥å…·
```

### 10.3 å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ


**ğŸ”¹ æƒé™å†²çªå¤„ç†**
```
é—®é¢˜ï¼šç”¨æˆ·åŒæ—¶å±äºå¤šä¸ªç»„ï¼Œæƒé™äº§ç”Ÿå†²çª
è§£å†³ï¼šå»ºç«‹æƒé™ä¼˜å…ˆçº§è§„åˆ™ï¼Œæ˜ç¡®æƒé™å åŠ è®¡ç®—æ–¹å¼

é—®é¢˜ï¼šä¸´æ—¶æƒé™è¿‡æœŸåå·¥ä½œå—å½±å“
è§£å†³ï¼šå»ºç«‹æå‰æé†’æœºåˆ¶ï¼Œæä¾›ä¾¿æ·çš„æƒé™å»¶æœŸç”³è¯·æµç¨‹
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–**
```
é—®é¢˜ï¼šå¤§é‡ACLè®¾ç½®å½±å“ç³»ç»Ÿæ€§èƒ½
è§£å†³ï¼šä½¿ç”¨é»˜è®¤ACLã€æƒé™ç»§æ‰¿ã€æ‰¹é‡æ“ä½œç­‰ä¼˜åŒ–æŠ€å·§

é—®é¢˜ï¼šæƒé™æ£€æŸ¥å»¶è¿Ÿå½±å“ç”¨æˆ·ä½“éªŒ
è§£å†³ï¼šåˆç†è®¾è®¡æƒé™å±‚æ¬¡ç»“æ„ï¼Œé¿å…è¿‡åº¦å¤æ‚çš„æƒé™é…ç½®
```

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- **ä¼ä¸šACLæƒé™è§„åˆ’æ˜¯ç³»ç»Ÿæ€§å·¥ç¨‹**ï¼šéœ€è¦è€ƒè™‘å®‰å…¨ã€æ•ˆç‡ã€ç»´æŠ¤ç­‰å¤šä¸ªæ–¹é¢
- **æ ‡å‡†åŒ–å’Œè‡ªåŠ¨åŒ–æ˜¯å…³é”®**ï¼šé€šè¿‡æ¨¡æ¿åŒ–é…ç½®å’Œè‡ªåŠ¨åŒ–è„šæœ¬æé«˜ç®¡ç†æ•ˆç‡
- **æŒç»­ç›‘æ§å’Œä¼˜åŒ–**ï¼šæƒé™ç®¡ç†ä¸æ˜¯ä¸€æ¬¡æ€§å·¥ä½œï¼Œéœ€è¦æŒç»­å…³æ³¨å’Œæ”¹è¿›
- **å¹³è¡¡å®‰å…¨ä¸ä¾¿åˆ©**ï¼šåœ¨ä¿è¯å®‰å…¨çš„å‰æä¸‹ï¼Œå°½å¯èƒ½æä¾›ä¾¿æ·çš„ç”¨æˆ·ä½“éªŒ