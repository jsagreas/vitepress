---
title: 11ã€å®¡è®¡ä¸æ—¥å¿—å®‰å…¨
---
## ğŸ“š ç›®å½•

1. [ç³»ç»Ÿå®¡è®¡æœºåˆ¶é…ç½®](#1-ç³»ç»Ÿå®¡è®¡æœºåˆ¶é…ç½®)
2. [ç”¨æˆ·æ“ä½œæ—¥å¿—è®°å½•](#2-ç”¨æˆ·æ“ä½œæ—¥å¿—è®°å½•)
3. [å®‰å…¨äº‹ä»¶æ£€æµ‹](#3-å®‰å…¨äº‹ä»¶æ£€æµ‹)
4. [å®¡è®¡æ—¥å¿—ä¿æŠ¤](#4-å®¡è®¡æ—¥å¿—ä¿æŠ¤)
5. [æ—¥å¿—å®Œæ•´æ€§éªŒè¯](#5-æ—¥å¿—å®Œæ•´æ€§éªŒè¯)
6. [å®æ—¶å®‰å…¨ç›‘æ§](#6-å®æ—¶å®‰å…¨ç›‘æ§)
7. [å¼‚å¸¸è¡Œä¸ºæ£€æµ‹](#7-å¼‚å¸¸è¡Œä¸ºæ£€æµ‹)
8. [å®¡è®¡æ•°æ®åˆ†æ](#8-å®¡è®¡æ•°æ®åˆ†æ)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” ç³»ç»Ÿå®¡è®¡æœºåˆ¶é…ç½®


### 1.1 ä»€ä¹ˆæ˜¯ç³»ç»Ÿå®¡è®¡


**å®¡è®¡ï¼ˆAuditï¼‰**ï¼šç®€å•è¯´å°±æ˜¯**è®°å½•è°åœ¨ä»€ä¹ˆæ—¶å€™åšäº†ä»€ä¹ˆäº‹æƒ…**ï¼Œå°±åƒç›‘æ§æ‘„åƒå¤´ä¸€æ ·ï¼ŒæŠŠç³»ç»Ÿé‡Œå‘ç”Ÿçš„é‡è¦æ“ä½œéƒ½è®°å½•ä¸‹æ¥ã€‚

```
ç°å®ä¸­çš„æ¯”å–»ï¼š
é“¶è¡Œå‡ºå…¥è´¦è®°å½• = Linuxç³»ç»Ÿå®¡è®¡
æ¯ç¬”è½¬è´¦éƒ½æœ‰è®°å½• = æ¯ä¸ªç³»ç»Ÿæ“ä½œéƒ½æœ‰æ—¥å¿—
è´¦ç›®ä¸èƒ½éšä¾¿æ”¹ = å®¡è®¡æ—¥å¿—è¦ä¿æŠ¤å¥½
```

**ä¸ºä»€ä¹ˆéœ€è¦å®¡è®¡ï¼Ÿ**
- ğŸ”¸ **å®‰å…¨è¿½è¸ª**ï¼šå‡ºé—®é¢˜æ—¶èƒ½æ‰¾åˆ°æ˜¯è°å¹²çš„
- ğŸ”¸ **åˆè§„è¦æ±‚**ï¼šå¾ˆå¤šä¼ä¸šå¿…é¡»æœ‰å®¡è®¡è®°å½•
- ğŸ”¸ **æ•…éšœæ’æŸ¥**ï¼šç³»ç»Ÿå‡ºé”™æ—¶èƒ½å›æº¯åŸå› 
- ğŸ”¸ **æ€§èƒ½åˆ†æ**ï¼šäº†è§£ç³»ç»Ÿä½¿ç”¨æƒ…å†µ

### 1.2 Linuxå®¡è®¡ç³»ç»Ÿæ¶æ„


**Linuxå®¡è®¡ç³»ç»Ÿçš„æ ¸å¿ƒç»„ä»¶ï¼š**

```
ç”¨æˆ·æ“ä½œ â†’ å†…æ ¸å®¡è®¡å­ç³»ç»Ÿ â†’ auditdå®ˆæŠ¤è¿›ç¨‹ â†’ å®¡è®¡æ—¥å¿—æ–‡ä»¶
    â†“              â†“                â†“             â†“
  æ•²å‘½ä»¤         æ•è·äº‹ä»¶         å¤„ç†æ ¼å¼åŒ–      å­˜å‚¨åˆ°ç£ç›˜

å®¡è®¡è§„åˆ™åº“ â†’ è¿‡æ»¤è§„åˆ™ â†’ åªè®°å½•é‡è¦äº‹ä»¶
```

**æ ¸å¿ƒç»„ä»¶è§£é‡Šï¼š**
- **å†…æ ¸å®¡è®¡å­ç³»ç»Ÿ**ï¼šç³»ç»Ÿåº•å±‚çš„ç›‘æ§å™¨ï¼Œå†…ç½®åœ¨Linuxå†…æ ¸ä¸­
- **auditd**ï¼šä¸“é—¨ç®¡ç†å®¡è®¡çš„åå°ç¨‹åº
- **å®¡è®¡è§„åˆ™**ï¼šå‘Šè¯‰ç³»ç»Ÿè¦è®°å½•ä»€ä¹ˆï¼Œä¸è®°å½•ä»€ä¹ˆ
- **å®¡è®¡æ—¥å¿—**ï¼šæœ€ç»ˆçš„è®°å½•æ–‡ä»¶

### 1.3 å®¡è®¡ç³»ç»Ÿé…ç½®åŸºç¡€


**å®‰è£…å®¡è®¡å·¥å…·ï¼š**
```bash
# CentOS/RHELç³»ç»Ÿ
sudo yum install audit audit-libs

# Ubuntu/Debianç³»ç»Ÿ  
sudo apt install auditd audispd-plugins

# å¯åŠ¨å®¡è®¡æœåŠ¡
sudo systemctl start auditd
sudo systemctl enable auditd
```

**åŸºç¡€é…ç½®æ–‡ä»¶ï¼š**
```bash
# ä¸»é…ç½®æ–‡ä»¶
/etc/audit/auditd.conf     # å®¡è®¡æœåŠ¡é…ç½®
/etc/audit/audit.rules     # å®¡è®¡è§„åˆ™å®šä¹‰
/var/log/audit/audit.log   # å®¡è®¡æ—¥å¿—å­˜å‚¨ä½ç½®
```

**æ ¸å¿ƒé…ç½®ç¤ºä¾‹ï¼š**
```bash
# /etc/audit/auditd.conf é‡è¦è®¾ç½®
log_file = /var/log/audit/audit.log    # æ—¥å¿—æ–‡ä»¶ä½ç½®
log_format = RAW                       # æ—¥å¿—æ ¼å¼
log_group = root                       # æ—¥å¿—æ–‡ä»¶æ‰€å±ç»„
max_log_file = 50                      # å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§50MB
max_log_file_action = ROTATE           # æ–‡ä»¶æ»¡äº†å°±è½®è½¬
```

### 1.4 å®¡è®¡è§„åˆ™é…ç½®


**å®¡è®¡è§„åˆ™çš„ä½œç”¨ï¼š**
å°±åƒç»™ç›‘æ§æ‘„åƒå¤´è®¾å®š"æ‹æ‘„ä»€ä¹ˆ"çš„è§„åˆ™ä¸€æ ·ï¼Œå®¡è®¡è§„åˆ™å‘Šè¯‰ç³»ç»Ÿè¦è®°å½•å“ªäº›æ“ä½œã€‚

**åŸºæœ¬è§„åˆ™è¯­æ³•ï¼š**
```bash
# ç›‘æ§æ–‡ä»¶è®¿é—®
-w /path/to/file -p rwxa -k keyname

å‚æ•°è§£é‡Šï¼š
-w: watchï¼Œç›‘æ§è¿™ä¸ªè·¯å¾„
-p: æƒé™ï¼Œrè¯»å– wå†™å…¥ xæ‰§è¡Œ aå±æ€§ä¿®æ”¹
-k: å…³é”®å­—ï¼Œç»™è¿™æ¡è§„åˆ™èµ·ä¸ªåå­—ï¼Œæ–¹ä¾¿æœç´¢
```

**å¸¸ç”¨å®¡è®¡è§„åˆ™ç¤ºä¾‹ï¼š**
```bash
# ç›‘æ§é‡è¦ç³»ç»Ÿæ–‡ä»¶
-w /etc/passwd -p wa -k user_modification
-w /etc/group -p wa -k group_modification  
-w /etc/shadow -p wa -k shadow_modification

# ç›‘æ§ç³»ç»Ÿé…ç½®
-w /etc/ssh/sshd_config -p wa -k ssh_config
-w /etc/sudoers -p wa -k sudo_config

# ç›‘æ§é‡è¦ç›®å½•
-w /root -p rwxa -k root_access
-w /home -p rwxa -k home_access
```

---

## 2. ğŸ“ ç”¨æˆ·æ“ä½œæ—¥å¿—è®°å½•


### 2.1 ç”¨æˆ·ç™»å½•æ—¥å¿—


**ç³»ç»Ÿè‡ªåŠ¨è®°å½•çš„ç™»å½•ä¿¡æ¯ï¼š**

**wtmpæ—¥å¿— - è®°å½•æ‰€æœ‰ç™»å½•**
```bash
# æŸ¥çœ‹ç™»å½•å†å²
last
# è¾“å‡ºç¤ºä¾‹ï¼š
zhang    pts/0    192.168.1.100    Sat Sep 14 09:15   still logged in
root     tty1                      Sat Sep 14 08:30 - 10:45  (02:15)
```

**utmpæ—¥å¿— - å½“å‰ç™»å½•ç”¨æˆ·**
```bash
# æŸ¥çœ‹å½“å‰åœ¨çº¿ç”¨æˆ·
who
# è¾“å‡ºç¤ºä¾‹ï¼š
zhang    pts/0        2025-09-14 09:15 (192.168.1.100)
root     tty1         2025-09-14 08:30
```

**btmpæ—¥å¿— - å¤±è´¥çš„ç™»å½•å°è¯•**
```bash
# æŸ¥çœ‹ç™»å½•å¤±è´¥è®°å½•ï¼ˆéœ€è¦rootæƒé™ï¼‰
sudo lastb
# è¾“å‡ºç¤ºä¾‹ï¼š
hacker   ssh:notty    192.168.1.200    Sat Sep 14 10:20 - 10:20  (00:00)
```

### 2.2 å‘½ä»¤æ‰§è¡Œæ—¥å¿—


**bashå†å²è®°å½•ï¼š**
```bash
# æ¯ä¸ªç”¨æˆ·çš„å‘½ä»¤å†å²
~/.bash_history

# æŸ¥çœ‹å†å²å‘½ä»¤
history

# é…ç½®å†å²è®°å½•æ ¼å¼
export HISTTIMEFORMAT="%Y-%m-%d %H:%M:%S "
```

**å¢å¼ºçš„å‘½ä»¤è®°å½•ï¼š**
```bash
# åœ¨/etc/profileä¸­æ·»åŠ ï¼Œè®°å½•æ‰€æœ‰ç”¨æˆ·å‘½ä»¤
export PROMPT_COMMAND='history -a; \
echo "$(date "+%Y-%m-%d %H:%M:%S") $(whoami) $(pwd) $(history 1 | sed "s/^[ ]*[0-9]\+[ ]*//")" \
>> /var/log/user_commands.log'
```

### 2.3 sudoæ“ä½œæ—¥å¿—


**sudoæ—¥å¿—é…ç½®ï¼š**
```bash
# /etc/sudoers ä¸­çš„æ—¥å¿—è®¾ç½®
Defaults logfile="/var/log/sudo.log"
Defaults log_input, log_output
Defaults timestamp_timeout=0
```

**sudoæ—¥å¿—å†…å®¹ç¤ºä¾‹ï¼š**
```bash
# /var/log/sudo.log
Sep 14 10:30:15 server zhang : TTY=pts/0 ; PWD=/home/zhang ; 
USER=root ; COMMAND=/bin/systemctl restart nginx

è§£é‡Šï¼š
- æ—¶é—´ï¼š2025å¹´9æœˆ14æ—¥10:30:15
- ç”¨æˆ·ï¼šzhang
- ç»ˆç«¯ï¼špts/0
- ç›®å½•ï¼š/home/zhang
- åˆ‡æ¢åˆ°ï¼šrootç”¨æˆ·
- æ‰§è¡Œï¼šé‡å¯nginxæœåŠ¡
```

### 2.4 ç³»ç»Ÿè°ƒç”¨å®¡è®¡


**ç›‘æ§ç³»ç»Ÿè°ƒç”¨ï¼š**
```bash
# ç›‘æ§æ–‡ä»¶æ“ä½œç³»ç»Ÿè°ƒç”¨
auditctl -a always,exit -F arch=b64 -S openat -k file_access

# ç›‘æ§ç½‘ç»œè¿æ¥
auditctl -a always,exit -F arch=b64 -S connect -k network_connect

# ç›‘æ§è¿›ç¨‹åˆ›å»º
auditctl -a always,exit -F arch=b64 -S execve -k process_creation
```

**æŸ¥çœ‹ç³»ç»Ÿè°ƒç”¨å®¡è®¡æ—¥å¿—ï¼š**
```bash
# æœç´¢ç‰¹å®šå…³é”®å­—çš„å®¡è®¡è®°å½•
ausearch -k file_access

# æŒ‰æ—¶é—´èŒƒå›´æœç´¢
ausearch --start today --end now -k network_connect
```

---

## 3. ğŸš¨ å®‰å…¨äº‹ä»¶æ£€æµ‹


### 3.1 ç™»å½•å¼‚å¸¸æ£€æµ‹


**ä»€ä¹ˆæ˜¯ç™»å½•å¼‚å¸¸ï¼Ÿ**
å°±åƒä½ å®¶é—¨é”ï¼Œå¦‚æœæœ‰äººè¯•å›¾å¤šæ¬¡ç”¨é”™è¯¯çš„é’¥åŒ™å¼€é—¨ï¼Œæˆ–è€…åœ¨å¥‡æ€ªçš„æ—¶é—´å¼€é—¨ï¼Œå°±å¯èƒ½æ˜¯å¼‚å¸¸ã€‚

**å¸¸è§ç™»å½•å¼‚å¸¸ç±»å‹ï¼š**
- ğŸ”¸ **æš´åŠ›ç ´è§£**ï¼šçŸ­æ—¶é—´å†…å¤šæ¬¡ç™»å½•å¤±è´¥
- ğŸ”¸ **å¼‚åœ°ç™»å½•**ï¼šä»å¼‚å¸¸IPåœ°å€ç™»å½•
- ğŸ”¸ **æ—¶é—´å¼‚å¸¸**ï¼šåœ¨éæ­£å¸¸å·¥ä½œæ—¶é—´ç™»å½•
- ğŸ”¸ **æƒé™æå‡**ï¼šæ™®é€šç”¨æˆ·çªç„¶è·å¾—rootæƒé™

**æ£€æµ‹æš´åŠ›ç ´è§£ï¼š**
```bash
# æ£€æŸ¥SSHç™»å½•å¤±è´¥æ¬¡æ•°
grep "Failed password" /var/log/auth.log | tail -10

# ç»Ÿè®¡å¤±è´¥ç™»å½•IP
grep "Failed password" /var/log/auth.log | \
awk '{print $(NF-3)}' | sort | uniq -c | sort -nr

# è¾“å‡ºç¤ºä¾‹ï¼š
     15 192.168.1.200    # è¿™ä¸ªIPå¤±è´¥äº†15æ¬¡
      3 192.168.1.150    # è¿™ä¸ªIPå¤±è´¥äº†3æ¬¡
```

**è‡ªåŠ¨æ£€æµ‹è„šæœ¬ç¤ºä¾‹ï¼š**
```bash
#!/bin/bash
# ç™»å½•å¼‚å¸¸æ£€æµ‹è„šæœ¬

# æ£€æŸ¥æœ€è¿‘1å°æ—¶å†…ç™»å½•å¤±è´¥è¶…è¿‡5æ¬¡çš„IP
failed_ips=$(grep "Failed password" /var/log/auth.log | \
grep "$(date '+%b %d %H')" | \
awk '{print $(NF-3)}' | sort | uniq -c | \
awk '$1 > 5 {print $2}')

if [ ! -z "$failed_ips" ]; then
    echo "âš ï¸  æ£€æµ‹åˆ°æš´åŠ›ç ´è§£å°è¯•ï¼š"
    echo "$failed_ips"
    # å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ è‡ªåŠ¨å°ç¦IPçš„é€»è¾‘
fi
```

### 3.2 æ–‡ä»¶ç³»ç»Ÿå¼‚å¸¸


**ç›‘æ§é‡è¦æ–‡ä»¶ä¿®æ”¹ï¼š**
```bash
# å®¡è®¡è§„åˆ™ï¼šç›‘æ§ç³»ç»Ÿé‡è¦æ–‡ä»¶
-w /etc/passwd -p wa -k user_file_change
-w /etc/shadow -p wa -k shadow_file_change
-w /etc/hosts -p wa -k network_config_change
-w /bin -p wa -k system_binary_change
```

**æ£€æµ‹æ–‡ä»¶å®Œæ•´æ€§ï¼š**
```bash
# ä½¿ç”¨AIDEå·¥å…·æ£€æµ‹æ–‡ä»¶å˜åŒ–
# å®‰è£…AIDE
sudo yum install aide

# åˆå§‹åŒ–æ•°æ®åº“
sudo aide --init
sudo mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz

# æ£€æŸ¥æ–‡ä»¶å˜åŒ–
sudo aide --check
```

### 3.3 è¿›ç¨‹å¼‚å¸¸æ£€æµ‹


**ç›‘æ§å¼‚å¸¸è¿›ç¨‹ï¼š**
```bash
# æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹åŠå…¶èµ„æºä½¿ç”¨
ps aux --sort=-%cpu | head -10

# ç›‘æ§ç½‘ç»œè¿æ¥
netstat -tulnp | grep LISTEN

# æ£€æŸ¥å¼‚å¸¸çš„ç½‘ç»œè¿æ¥
ss -tulnp | grep -E ":80|:443|:22|:3389"
```

**æ£€æµ‹æ¶æ„è¿›ç¨‹ç‰¹å¾ï¼š**
- ğŸ”¸ **CPUä½¿ç”¨ç‡å¼‚å¸¸é«˜**
- ğŸ”¸ **ç›‘å¬å¥‡æ€ªç«¯å£**
- ğŸ”¸ **è¿›ç¨‹åç§°å¯ç–‘**
- ğŸ”¸ **ä»å¼‚å¸¸ä½ç½®å¯åŠ¨**

---

## 4. ğŸ›¡ï¸ å®¡è®¡æ—¥å¿—ä¿æŠ¤


### 4.1 ä¸ºä»€ä¹ˆè¦ä¿æŠ¤å®¡è®¡æ—¥å¿—


**ä¿æŠ¤å®¡è®¡æ—¥å¿—å°±åƒä¿æŠ¤é“¶è¡Œçš„ç›‘æ§å½•åƒ**ï¼Œå¦‚æœåäººèƒ½éšæ„åˆ é™¤æˆ–ä¿®æ”¹è¿™äº›è®°å½•ï¼Œé‚£å®¡è®¡å°±å¤±å»äº†æ„ä¹‰ã€‚

**æ—¥å¿—é¢ä¸´çš„å¨èƒï¼š**
- ğŸ”¸ **æ¶æ„åˆ é™¤**ï¼šæ”»å‡»è€…åˆ é™¤è‡ªå·±çš„æ“ä½œè®°å½•
- ğŸ”¸ **æ¶æ„ä¿®æ”¹**ï¼šç¯¡æ”¹æ—¥å¿—å†…å®¹æ©ç›–ç—•è¿¹  
- ğŸ”¸ **å­˜å‚¨è€—å°½**ï¼šæ—¥å¿—æ–‡ä»¶è¿‡å¤§å¯¼è‡´ç£ç›˜æ»¡
- ğŸ”¸ **æœªæˆæƒè®¿é—®**ï¼šæ™®é€šç”¨æˆ·èƒ½çœ‹åˆ°æ•æ„Ÿæ—¥å¿—

### 4.2 æ–‡ä»¶æƒé™ä¿æŠ¤


**è®¾ç½®æ­£ç¡®çš„æ—¥å¿—æ–‡ä»¶æƒé™ï¼š**
```bash
# å®¡è®¡æ—¥å¿—æ–‡ä»¶æƒé™è®¾ç½®
sudo chmod 600 /var/log/audit/audit.log
sudo chown root:root /var/log/audit/audit.log

# ç³»ç»Ÿæ—¥å¿—æƒé™ä¿æŠ¤
sudo chmod 640 /var/log/messages
sudo chmod 640 /var/log/secure
sudo chmod 600 /var/log/auth.log
```

**ä½¿ç”¨ACLè¿›è¡Œç²¾ç»†æƒé™æ§åˆ¶ï¼š**
```bash
# åªå…è®¸ç‰¹å®šç”¨æˆ·è¯»å–å®¡è®¡æ—¥å¿—
sudo setfacl -m u:audituser:r /var/log/audit/audit.log

# æŸ¥çœ‹ACLè®¾ç½®
getfacl /var/log/audit/audit.log
```

### 4.3 æ—¥å¿—è½®è½¬ä¸å½’æ¡£


**é…ç½®logrotateè¿›è¡Œæ—¥å¿—è½®è½¬ï¼š**
```bash
# /etc/logrotate.d/audité…ç½®ç¤ºä¾‹
/var/log/audit/audit.log {
    weekly          # æ¯å‘¨è½®è½¬ä¸€æ¬¡
    rotate 52       # ä¿ç•™52ä¸ªæ—§æ–‡ä»¶ï¼ˆä¸€å¹´ï¼‰
    compress        # å‹ç¼©æ—§æ–‡ä»¶
    delaycompress   # å»¶è¿Ÿå‹ç¼©
    missingok       # æ–‡ä»¶ä¸å­˜åœ¨ä¸æŠ¥é”™
    notifempty      # ç©ºæ–‡ä»¶ä¸è½®è½¬
    create 600 root root  # åˆ›å»ºæ–°æ–‡ä»¶æ—¶çš„æƒé™
    postrotate      # è½®è½¬åæ‰§è¡Œçš„å‘½ä»¤
        /usr/bin/killall -HUP auditd
    endscript
}
```

### 4.4 è¿œç¨‹æ—¥å¿—ä¼ è¾“


**å°†æ—¥å¿—å‘é€åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼š**
```bash
# é…ç½®rsyslogå‘é€åˆ°è¿œç¨‹æœåŠ¡å™¨
# /etc/rsyslog.conf
*.* $$192.168.1.100:514

# é‡å¯rsyslogæœåŠ¡
sudo systemctl restart rsyslog
```

**ä½¿ç”¨syslog-ngè¿›è¡Œé«˜çº§æ—¥å¿—ä¼ è¾“ï¼š**
```bash
# /etc/syslog-ng/syslog-ng.conf
destination remote_server {
    tcp("192.168.1.100" port(514));
};

log {
    source(s_sys);
    destination(remote_server);
};
```

---

## 5. âœ… æ—¥å¿—å®Œæ•´æ€§éªŒè¯


### 5.1 ä»€ä¹ˆæ˜¯æ—¥å¿—å®Œæ•´æ€§


**å®Œæ•´æ€§éªŒè¯å°±åƒç»™é‡è¦æ–‡ä»¶è´´å°æ¡**ï¼Œå¦‚æœæœ‰äººåŠ¨è¿‡è¿™ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬å°±èƒ½å‘ç°ã€‚

**å®Œæ•´æ€§éªŒè¯çš„ç›®çš„ï¼š**
- ğŸ”¸ **é˜²æ­¢ç¯¡æ”¹**ï¼šç¡®ä¿æ—¥å¿—å†…å®¹æ²¡æœ‰è¢«ä¿®æ”¹
- ğŸ”¸ **æ£€æµ‹åˆ é™¤**ï¼šå‘ç°æ—¥å¿—æ–‡ä»¶æ˜¯å¦è¢«åˆ é™¤
- ğŸ”¸ **æ—¶é—´éªŒè¯**ï¼šç¡®ä¿æ—¥å¿—è®°å½•çš„æ—¶é—´æ­£ç¡®
- ğŸ”¸ **æ³•å¾‹è¯æ®**ï¼šåœ¨æ³•å¾‹ç¨‹åºä¸­ä½œä¸ºæœ‰æ•ˆè¯æ®

### 5.2 ä½¿ç”¨æ•°å­—ç­¾å


**ä¸ºæ—¥å¿—æ–‡ä»¶åˆ›å»ºæ•°å­—ç­¾åï¼š**
```bash
# ä½¿ç”¨GPGä¸ºæ—¥å¿—æ–‡ä»¶ç­¾å
gpg --detach-sign /var/log/audit/audit.log

# éªŒè¯ç­¾å
gpg --verify audit.log.sig audit.log
```

**ä½¿ç”¨MD5/SHA256æ ¡éªŒå’Œï¼š**
```bash
# ä¸ºæ—¥å¿—æ–‡ä»¶åˆ›å»ºæ ¡éªŒå’Œ
sha256sum /var/log/audit/audit.log > audit.log.sha256

# éªŒè¯æ ¡éªŒå’Œ
sha256sum -c audit.log.sha256

# è¾“å‡ºç¤ºä¾‹ï¼š
/var/log/audit/audit.log: OK     # æ–‡ä»¶å®Œæ•´
/var/log/audit/audit.log: FAILED # æ–‡ä»¶è¢«ä¿®æ”¹
```

### 5.3 æ—¶é—´æˆ³ä¿æŠ¤


**ä½¿ç”¨æ—¶é—´æˆ³æœåŠ¡å™¨ï¼š**
```bash
# é…ç½®NTPç¡®ä¿æ—¶é—´å‡†ç¡®
sudo chronyd -q 'server ntp.aliyun.com iburst'

# æ£€æŸ¥ç³»ç»Ÿæ—¶é—´
timedatectl status
```

**åœ¨å®¡è®¡é…ç½®ä¸­å¯ç”¨æ—¶é—´æˆ³ï¼š**
```bash
# /etc/audit/auditd.conf
log_format = ENRICHED  # ä½¿ç”¨å¢å¼ºæ ¼å¼åŒ…å«æ›´å¤šæ—¶é—´ä¿¡æ¯
```

### 5.4 è‡ªåŠ¨åŒ–å®Œæ•´æ€§æ£€æŸ¥


**åˆ›å»ºå®Œæ•´æ€§æ£€æŸ¥è„šæœ¬ï¼š**
```bash
#!/bin/bash
# æ—¥å¿—å®Œæ•´æ€§æ£€æŸ¥è„šæœ¬

LOG_DIR="/var/log/audit"
CHECKSUM_DIR="/var/lib/audit/checksums"

# åˆ›å»ºæ ¡éªŒå’Œç›®å½•
mkdir -p "$CHECKSUM_DIR"

# æ£€æŸ¥æ‰€æœ‰å®¡è®¡æ—¥å¿—æ–‡ä»¶
for logfile in "$LOG_DIR"/*.log; do
    if [ -f "$logfile" ]; then
        filename=$(basename "$logfile")
        checksum_file="$CHECKSUM_DIR/$filename.sha256"
        
        if [ -f "$checksum_file" ]; then
            # éªŒè¯ç°æœ‰æ ¡éªŒå’Œ
            if ! sha256sum -c "$checksum_file" > /dev/null 2>&1; then
                echo "âš ï¸  è­¦å‘Šï¼š$logfile å¯èƒ½è¢«ç¯¡æ”¹ï¼"
            fi
        fi
        
        # æ›´æ–°æ ¡éªŒå’Œæ–‡ä»¶
        sha256sum "$logfile" > "$checksum_file"
    fi
done
```

---

## 6. ğŸ“Š å®æ—¶å®‰å…¨ç›‘æ§


### 6.1 å®æ—¶ç›‘æ§çš„é‡è¦æ€§


**å®æ—¶ç›‘æ§å°±åƒ24å°æ—¶çš„å®‰ä¿**ï¼Œä¸ç­‰é—®é¢˜å‘ç”Ÿåå†å»æŸ¥æ—¥å¿—ï¼Œè€Œæ˜¯åœ¨é—®é¢˜å‘ç”Ÿæ—¶ç«‹å³å‘ç°å¹¶å“åº”ã€‚

**å®æ—¶ç›‘æ§çš„ä¼˜åŠ¿ï¼š**
- ğŸ”¸ **å¿«é€Ÿå“åº”**ï¼šé—®é¢˜å‘ç”Ÿåç«‹å³çŸ¥é“
- ğŸ”¸ **é˜»æ­¢æ”»å‡»**ï¼šåœ¨æ”»å‡»è¿›è¡Œä¸­å°±å‘ç°å¹¶é˜»æ­¢
- ğŸ”¸ **å‡å°‘æŸå¤±**ï¼šåŠæ—¶å‘ç°å‡å°‘å®‰å…¨æŸå¤±
- ğŸ”¸ **è‡ªåŠ¨å¤„ç†**ï¼šå¯ä»¥é…ç½®è‡ªåŠ¨å“åº”åŠ¨ä½œ

### 6.2 ä½¿ç”¨auditdè¿›è¡Œå®æ—¶ç›‘æ§


**é…ç½®å®æ—¶äº‹ä»¶å“åº”ï¼š**
```bash
# /etc/audit/auditd.conf
# é…ç½®å®æ—¶äº‹ä»¶åˆ†å‘
disp_qos = lossy
dispatcher = /sbin/audispd
```

**é…ç½®audispè¿›è¡Œäº‹ä»¶åˆ†å‘ï¼š**
```bash
# /etc/audisp/audispd.conf
q_depth = 150
overflow_action = syslog
priority_boost = 4
max_restarts = 10

# æ¿€æ´»syslogæ’ä»¶
# /etc/audisp/plugins.d/syslog.conf
active = yes
direction = out
path = /sbin/audisp-syslog
format = string
```

### 6.3 è®¾ç½®å®æ—¶å‘Šè­¦


**åŸºäºæ—¥å¿—ç›‘æ§çš„å‘Šè­¦è„šæœ¬ï¼š**
```bash
#!/bin/bash
# å®æ—¶å®‰å…¨å‘Šè­¦è„šæœ¬

# ç›‘æ§SSHç™»å½•å¤±è´¥
tail -f /var/log/auth.log | while read line; do
    if echo "$line" | grep -q "Failed password"; then
        ip=$(echo "$line" | awk '{print $(NF-3)}')
        user=$(echo "$line" | awk '{for(i=1;i<=NF;i++) if($i=="for") print $(i+1)}')
        
        echo "âš ï¸  SSHç™»å½•å¤±è´¥: ç”¨æˆ·=$user, IP=$ip, æ—¶é—´=$(date)"
        
        # æ£€æŸ¥æ˜¯å¦éœ€è¦å°ç¦IP
        fail_count=$(grep "$ip" /var/log/auth.log | grep "Failed password" | wc -l)
        if [ "$fail_count" -gt 5 ]; then
            echo "ğŸš« è‡ªåŠ¨å°ç¦IP: $ip"
            # iptables -A INPUT -s $ip -j DROP
        fi
    fi
done
```

### 6.4 ç³»ç»Ÿèµ„æºç›‘æ§


**ç›‘æ§ç³»ç»Ÿå¼‚å¸¸ä½¿ç”¨ï¼š**
```bash
# ç›‘æ§CPUä½¿ç”¨ç‡
while true; do
    cpu_usage=$(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1)
    if (( $(echo "$cpu_usage > 90" | bc -l) )); then
        echo "âš ï¸  CPUä½¿ç”¨ç‡è¿‡é«˜: ${cpu_usage}%"
    fi
    sleep 60
done

# ç›‘æ§å†…å­˜ä½¿ç”¨
while true; do
    mem_usage=$(free | grep Mem | awk '{printf("%.1f", $3/$2 * 100.0)}')
    if (( $(echo "$mem_usage > 90" | bc -l) )); then
        echo "âš ï¸  å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜: ${mem_usage}%"
    fi
    sleep 60
done
```

---

## 7. ğŸ•µï¸ å¼‚å¸¸è¡Œä¸ºæ£€æµ‹


### 7.1 ç”¨æˆ·è¡Œä¸ºå¼‚å¸¸æ£€æµ‹


**ä»€ä¹ˆæ˜¯ç”¨æˆ·è¡Œä¸ºå¼‚å¸¸ï¼Ÿ**
å°±åƒä½ ç†Ÿæ‚‰æŸä¸ªåŒäº‹çš„å·¥ä½œä¹ æƒ¯ï¼Œå¦‚æœä»–çªç„¶åšå‡ºä¸å¯»å¸¸çš„äº‹æƒ…ï¼Œä½ ä¼šæ³¨æ„åˆ°ã€‚ç³»ç»Ÿä¹Ÿå¯ä»¥å­¦ä¹ ç”¨æˆ·çš„æ­£å¸¸è¡Œä¸ºæ¨¡å¼ã€‚

**å¸¸è§å¼‚å¸¸è¡Œä¸ºæ¨¡å¼ï¼š**
- ğŸ”¸ **ç™»å½•æ—¶é—´å¼‚å¸¸**ï¼šå¹³æ—¶ç™½å¤©å·¥ä½œï¼Œçªç„¶åŠå¤œç™»å½•
- ğŸ”¸ **è®¿é—®æƒé™å¼‚å¸¸**ï¼šå¹³æ—¶åªç”¨æ™®é€šæƒé™ï¼Œçªç„¶ä½¿ç”¨sudo
- ğŸ”¸ **è®¿é—®æ–‡ä»¶å¼‚å¸¸**ï¼šè®¿é—®ä»æœªæ¥è§¦è¿‡çš„æ•æ„Ÿæ–‡ä»¶
- ğŸ”¸ **ç½‘ç»œè¡Œä¸ºå¼‚å¸¸**ï¼šçªç„¶è®¿é—®å¤–ç½‘æˆ–ä¸‹è½½å¤§é‡æ•°æ®

### 7.2 åŸºäºç»Ÿè®¡çš„å¼‚å¸¸æ£€æµ‹


**åˆ†æç”¨æˆ·ç™»å½•æ¨¡å¼ï¼š**
```bash
#!/bin/bash
# ç”¨æˆ·è¡Œä¸ºåˆ†æè„šæœ¬

analyze_user_behavior() {
    local username=$1
    
    echo "=== $username ç”¨æˆ·è¡Œä¸ºåˆ†æ ==="
    
    # åˆ†æç™»å½•æ—¶é—´åˆ†å¸ƒ
    echo "ğŸ“Š ç™»å½•æ—¶é—´åˆ†å¸ƒï¼š"
    last $username | grep -v "wtmp begins" | \
    awk '{print $4}' | cut -d: -f1 | sort | uniq -c | sort -rn
    
    # åˆ†æç™»å½•æ¥æºIP
    echo "ğŸŒ ç™»å½•æ¥æºåˆ†æï¼š"
    last $username | grep -v "wtmp begins" | \
    awk '{print $3}' | grep -v "^$" | sort | uniq -c | sort -rn
    
    # åˆ†æsudoä½¿ç”¨æƒ…å†µ
    echo "ğŸ”‘ sudoä½¿ç”¨é¢‘ç‡ï¼š"
    grep "sudo.*$username" /var/log/auth.log | wc -l
}

# ä½¿ç”¨ç¤ºä¾‹
analyze_user_behavior "zhang"
```

### 7.3 å‘½ä»¤æ‰§è¡Œæ¨¡å¼åˆ†æ


**åˆ†æç”¨æˆ·å‘½ä»¤ä½¿ç”¨ä¹ æƒ¯ï¼š**
```bash
#!/bin/bash
# å‘½ä»¤æ¨¡å¼åˆ†æ

analyze_command_patterns() {
    local username=$1
    local history_file="/home/$username/.bash_history"
    
    if [ -f "$history_file" ]; then
        echo "=== $username å‘½ä»¤ä½¿ç”¨åˆ†æ ==="
        
        # æœ€å¸¸ç”¨çš„å‘½ä»¤
        echo "ğŸ“ˆ æœ€å¸¸ç”¨å‘½ä»¤Top10ï¼š"
        cat "$history_file" | awk '{print $1}' | sort | uniq -c | sort -rn | head -10
        
        # å±é™©å‘½ä»¤æ£€æµ‹
        echo "âš ï¸  å±é™©å‘½ä»¤ä½¿ç”¨ï¼š"
        grep -E "(rm -rf|chmod 777|wget.*http|curl.*http)" "$history_file"
        
        # å¼‚å¸¸æ—¶é—´å‘½ä»¤ï¼ˆéœ€è¦é…ç½®HISTTIMEFORMATï¼‰
        echo "ğŸ• å¤œé—´æ‰§è¡Œçš„å‘½ä»¤ï¼š"
        grep -E "2[2-3]:|0[0-5]:" "$history_file"
    fi
}
```

### 7.4 ç½‘ç»œè¡Œä¸ºå¼‚å¸¸æ£€æµ‹


**ç›‘æ§å¼‚å¸¸ç½‘ç»œè¿æ¥ï¼š**
```bash
#!/bin/bash
# ç½‘ç»œå¼‚å¸¸æ£€æµ‹è„šæœ¬

detect_network_anomaly() {
    echo "=== ç½‘ç»œå¼‚å¸¸æ£€æµ‹ ==="
    
    # æ£€æµ‹å¼‚å¸¸ç«¯å£è¿æ¥
    echo "ğŸ”Œ å¼‚å¸¸ç«¯å£è¿æ¥ï¼š"
    netstat -tulnp | grep -E ":(1337|3389|5555|6666|7777|8888|9999|31337)"
    
    # æ£€æµ‹å¤§é‡è¿æ¥çš„IP
    echo "ğŸ“Š è¿æ¥æ•°é‡ç»Ÿè®¡ï¼š"
    netstat -an | grep ESTABLISHED | awk '{print $5}' | \
    cut -d: -f1 | sort | uniq -c | sort -rn | head -10
    
    # æ£€æµ‹DNSæŸ¥è¯¢å¼‚å¸¸
    echo "ğŸŒ DNSæŸ¥è¯¢åˆ†æï¼š"
    grep "$(date '+%b %d')" /var/log/messages | grep "dnsmasq" | \
    grep -v -E "(google|microsoft|amazon|cloudflare)" | tail -10
}
```

---

## 8. ğŸ“ˆ å®¡è®¡æ•°æ®åˆ†æ


### 8.1 æ—¥å¿—æ•°æ®åˆ†æå·¥å…·


**å¸¸ç”¨çš„æ—¥å¿—åˆ†æå·¥å…·ï¼š**

| å·¥å…·åç§° | **é€‚ç”¨åœºæ™¯** | **ç‰¹ç‚¹** | **é€‚ç”¨è§„æ¨¡** |
|----------|-------------|----------|------------|
| ğŸ“Š **grep/awk** | `åŸºç¡€æ–‡æœ¬åˆ†æ` | `è½»é‡çº§ï¼Œå¿«é€ŸæŸ¥æ‰¾` | `å°åˆ°ä¸­å‹` |
| ğŸ” **ausearch** | `å®¡è®¡æ—¥å¿—ä¸“ç”¨` | `ä¸“ä¸šå®¡è®¡æŸ¥è¯¢` | `ä¸­å‹` |
| ğŸ“ˆ **logwatch** | `æ—¥å¸¸æŠ¥å‘Šç”Ÿæˆ` | `è‡ªåŠ¨ç”Ÿæˆæ‘˜è¦` | `ä¸­å‹` |
| ğŸŒŸ **ELK Stack** | `ä¼ä¸šçº§åˆ†æ` | `å¼ºå¤§å¯è§†åŒ–` | `å¤§å‹` |

### 8.2 åŸºç¡€æ—¥å¿—åˆ†æå‘½ä»¤


**ä½¿ç”¨grepè¿›è¡Œæ—¥å¿—æœç´¢ï¼š**
```bash
# æœç´¢ç‰¹å®šç”¨æˆ·çš„æ‰€æœ‰æ“ä½œ
grep "zhang" /var/log/audit/audit.log

# æœç´¢æ–‡ä»¶è®¿é—®è®°å½•
grep "PATH.*passwd" /var/log/audit/audit.log

# æœç´¢ç‰¹å®šæ—¶é—´æ®µçš„è®°å½•
grep "$(date '+%Y-%m-%d 14')" /var/log/audit/audit.log
```

**ä½¿ç”¨ausearchè¿›è¡Œä¸“ä¸šæœç´¢ï¼š**
```bash
# æœç´¢ç‰¹å®šç”¨æˆ·çš„å®¡è®¡è®°å½•
ausearch -ua zhang

# æœç´¢æ–‡ä»¶è®¿é—®è®°å½•
ausearch -f /etc/passwd

# æœç´¢å¤±è´¥çš„äº‹ä»¶
ausearch --success no

# æŒ‰æ—¶é—´èŒƒå›´æœç´¢
ausearch --start 09/14/2025 --end 09/14/2025
```

### 8.3 ç”Ÿæˆåˆ†ææŠ¥å‘Š


**åˆ›å»ºæ—¥å¸¸å®‰å…¨åˆ†ææŠ¥å‘Šï¼š**
```bash
#!/bin/bash
# å®‰å…¨åˆ†ææŠ¥å‘Šç”Ÿæˆè„šæœ¬

generate_security_report() {
    local report_file="/tmp/security_report_$(date +%Y%m%d).txt"
    local today=$(date '+%Y-%m-%d')
    
    echo "=== ç³»ç»Ÿå®‰å…¨åˆ†ææŠ¥å‘Š ===" > "$report_file"
    echo "ç”Ÿæˆæ—¶é—´: $(date)" >> "$report_file"
    echo "" >> "$report_file"
    
    # ç™»å½•ç»Ÿè®¡
    echo "ğŸ“Š ç™»å½•ç»Ÿè®¡:" >> "$report_file"
    echo "æˆåŠŸç™»å½•æ¬¡æ•°: $(grep "$today.*Accepted" /var/log/auth.log | wc -l)" >> "$report_file"
    echo "å¤±è´¥ç™»å½•æ¬¡æ•°: $(grep "$today.*Failed" /var/log/auth.log | wc -l)" >> "$report_file"
    echo "" >> "$report_file"
    
    # ç”¨æˆ·è¡Œä¸ºç»Ÿè®¡
    echo "ğŸ‘¥ ç”¨æˆ·æ´»åŠ¨ç»Ÿè®¡:" >> "$report_file"
    last -s "$today" | head -10 >> "$report_file"
    echo "" >> "$report_file"
    
    # sudoä½¿ç”¨ç»Ÿè®¡
    echo "ğŸ”‘ sudoä½¿ç”¨ç»Ÿè®¡:" >> "$report_file"
    grep "$today.*sudo" /var/log/auth.log | wc -l >> "$report_file"
    echo "" >> "$report_file"
    
    # ç³»ç»Ÿæ–‡ä»¶ä¿®æ”¹
    echo "ğŸ“ ç³»ç»Ÿæ–‡ä»¶ä¿®æ”¹:" >> "$report_file"
    ausearch --start today -k user_file_change >> "$report_file"
    
    echo "æŠ¥å‘Šå·²ç”Ÿæˆ: $report_file"
}

# æ‰§è¡ŒæŠ¥å‘Šç”Ÿæˆ
generate_security_report
```

### 8.4 å¯è§†åŒ–åˆ†æ


**ä½¿ç”¨ç®€å•å·¥å…·è¿›è¡Œæ•°æ®å¯è§†åŒ–ï¼š**
```bash
# ç™»å½•æ¬¡æ•°è¶‹åŠ¿åˆ†æ
#!/bin/bash
echo "ğŸ“ˆ è¿‡å»7å¤©ç™»å½•è¶‹åŠ¿:"
for i in {6..0}; do
    date_check=$(date -d "$i days ago" '+%Y-%m-%d')
    login_count=$(grep "$date_check.*Accepted" /var/log/auth.log | wc -l)
    printf "%-12s " "$date_check"
    
    # ç®€å•çš„æ–‡æœ¬æ¡å½¢å›¾
    for j in $(seq 1 $((login_count/5+1))); do
        printf "â–ˆ"
    done
    printf " (%d)\n" "$login_count"
done
```

**åˆ†æç”¨æˆ·æ´»è·ƒåº¦ï¼š**
```bash
#!/bin/bash
echo "ğŸ‘¤ ç”¨æˆ·æ´»è·ƒåº¦åˆ†æ:"
grep "Accepted password" /var/log/auth.log | \
awk '{for(i=1;i<=NF;i++) if($i=="for") print $(i+1)}' | \
sort | uniq -c | sort -rn | head -10 | \
while read count user; do
    printf "%-15s " "$user"
    for i in $(seq 1 $((count/10+1))); do
        printf "â–“"
    done
    printf " (%dæ¬¡)\n" "$count"
done
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å®¡è®¡æœ¬è´¨ï¼šè®°å½•"è°åœ¨ä½•æ—¶åšäº†ä»€ä¹ˆ"çš„ç³»ç»Ÿæœºåˆ¶
ğŸ”¸ å®¡è®¡ç»„ä»¶ï¼šå†…æ ¸å®¡è®¡å­ç³»ç»Ÿ + auditdæœåŠ¡ + å®¡è®¡è§„åˆ™ + æ—¥å¿—æ–‡ä»¶
ğŸ”¸ æ—¥å¿—ä¿æŠ¤ï¼šæƒé™æ§åˆ¶ + å®Œæ•´æ€§éªŒè¯ + è¿œç¨‹å¤‡ä»½
ğŸ”¸ å®æ—¶ç›‘æ§ï¼šåŠæ—¶å‘ç°å¼‚å¸¸è¡Œä¸ºå¹¶å“åº”
ğŸ”¸ æ•°æ®åˆ†æï¼šä»æµ·é‡æ—¥å¿—ä¸­æå–æœ‰ä»·å€¼çš„å®‰å…¨ä¿¡æ¯
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ å®¡è®¡ç³»ç»Ÿçš„å·¥ä½œåŸç†**
```
ç”¨æˆ·æ“ä½œ â†’ å†…æ ¸æ•è· â†’ è§„åˆ™è¿‡æ»¤ â†’ æ ¼å¼åŒ–è®°å½• â†’ å­˜å‚¨åˆ°æ–‡ä»¶
                â†“
         å®æ—¶ç›‘æ§ â†’ å¼‚å¸¸æ£€æµ‹ â†’ å‘Šè­¦å“åº”
```

**ğŸ”¹ å®¡è®¡è§„åˆ™çš„è®¾è®¡æ€è·¯**
```
ç›‘æ§é‡ç‚¹ï¼š
- ç³»ç»Ÿå…³é”®æ–‡ä»¶ï¼ˆ/etc/passwd, /etc/shadowç­‰ï¼‰
- æƒé™å˜æ›´æ“ä½œï¼ˆsudo, chmodç­‰ï¼‰
- ç½‘ç»œè®¿é—®è¡Œä¸º
- ç”¨æˆ·ç™»å½•æ´»åŠ¨

å¹³è¡¡è€ƒè™‘ï¼š
- å®‰å…¨æ€§ vs æ€§èƒ½å¼€é”€
- è¯¦ç»†æ€§ vs å­˜å‚¨ç©ºé—´
- å®æ—¶æ€§ vs ç³»ç»Ÿè´Ÿè½½
```

**ğŸ”¹ æ—¥å¿—åˆ†æçš„æ€ç»´æ–¹å¼**
```
å•ç‚¹åˆ†æï¼šæŸä¸ªç‰¹å®šäº‹ä»¶çš„è¯¦ç»†æƒ…å†µ
è¶‹åŠ¿åˆ†æï¼šä¸€æ®µæ—¶é—´å†…çš„å˜åŒ–è¶‹åŠ¿
å…³è”åˆ†æï¼šå¤šä¸ªäº‹ä»¶ä¹‹é—´çš„å…³ç³»
å¼‚å¸¸æ£€æµ‹ï¼šåç¦»æ­£å¸¸æ¨¡å¼çš„è¡Œä¸º
```

### 9.3 å®é™…åº”ç”¨æŒ‡å¯¼


**é€‚ç”¨åœºæ™¯åˆ¤æ–­ï¼š**
```
âœ… éœ€è¦å¼€å¯å®¡è®¡çš„æƒ…å†µï¼š
- ç”Ÿäº§æœåŠ¡å™¨ç¯å¢ƒ
- å¤šç”¨æˆ·å…±äº«ç³»ç»Ÿ
- åˆè§„è¦æ±‚ï¼ˆå¦‚ç­‰ä¿ï¼‰
- æ•æ„Ÿæ•°æ®å¤„ç†

âš ï¸  éœ€è¦è°¨æ…çš„æƒ…å†µï¼š
- é«˜æ€§èƒ½è¦æ±‚çš„ç³»ç»Ÿ
- å­˜å‚¨ç©ºé—´å—é™
- ç½‘ç»œå¸¦å®½æœ‰é™
```

**é…ç½®ä¼˜åŒ–ç­–ç•¥ï¼š**
```
æ–°æ‰‹é…ç½®ï¼š
- ç›‘æ§åŸºæœ¬çš„æ–‡ä»¶å’Œæƒé™å˜æ›´
- ä½¿ç”¨é»˜è®¤çš„æ—¥å¿—è½®è½¬é…ç½®
- å®šæœŸæ‰‹å·¥æ£€æŸ¥é‡è¦æ—¥å¿—

è¿›é˜¶é…ç½®ï¼š
- è‡ªå®šä¹‰å®¡è®¡è§„åˆ™
- è®¾ç½®å®æ—¶ç›‘æ§å‘Šè­¦
- é›†æˆSIEMç³»ç»Ÿ
- è‡ªåŠ¨åŒ–åˆ†ææŠ¥å‘Š
```

### 9.4 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


**æ€§èƒ½å½±å“é—®é¢˜ï¼š**
```
é—®é¢˜ï¼šå®¡è®¡å¼€å¯åç³»ç»Ÿå˜æ…¢
è§£å†³ï¼š
- ä¼˜åŒ–å®¡è®¡è§„åˆ™ï¼Œåªç›‘æ§å¿…è¦çš„äº‹ä»¶
- è°ƒæ•´æ—¥å¿—çº§åˆ«ï¼Œå‡å°‘è¯¦ç»†è®°å½•
- ä½¿ç”¨å¼‚æ­¥æ—¥å¿—å†™å…¥
- å®šæœŸæ¸…ç†æ—§æ—¥å¿—æ–‡ä»¶
```

**å­˜å‚¨ç©ºé—´é—®é¢˜ï¼š**
```
é—®é¢˜ï¼šå®¡è®¡æ—¥å¿—å ç”¨å¤§é‡ç£ç›˜ç©ºé—´
è§£å†³ï¼š
- é…ç½®åˆç†çš„æ—¥å¿—è½®è½¬ç­–ç•¥
- å‹ç¼©å†å²æ—¥å¿—æ–‡ä»¶
- å°†æ—¥å¿—è½¬ç§»åˆ°ä¸“ç”¨å­˜å‚¨
- å®æ–½æ—¥å¿—ä¿ç•™ç­–ç•¥
```

**ç›‘æ§å‘Šè­¦é—®é¢˜ï¼š**
```
é—®é¢˜ï¼šå‘Šè­¦å¤ªå¤šæˆ–å¤ªå°‘
è§£å†³ï¼š
- è°ƒæ•´å¼‚å¸¸æ£€æµ‹é˜ˆå€¼
- å»ºç«‹å‘Šè­¦ä¼˜å…ˆçº§
- å®æ–½ç™½åå•æœºåˆ¶
- å®šæœŸè¯„ä¼°å‘Šè­¦è§„åˆ™
```

**æ ¸å¿ƒè®°å¿†å£è¯€ï¼š**
- å®¡è®¡ç›‘æ§ä¿å®‰å…¨ï¼Œè®°å½•æ“ä½œé˜²é£é™©
- è§„åˆ™é…ç½®è¦åˆç†ï¼Œæ€§èƒ½å®‰å…¨éœ€å¹³è¡¡  
- æ—¥å¿—ä¿æŠ¤å¾ˆé‡è¦ï¼Œå®Œæ•´æ€§æ£€éªŒä¸èƒ½å°‘
- å®æ—¶ç›‘æ§åŠ åˆ†æï¼Œå¼‚å¸¸è¡Œä¸ºæ—©å‘ç°