---
title: 2ã€RPMåŒ…ç®¡ç†åŸºç¡€
---
## ğŸ“š ç›®å½•

1. [RPMåŒ…ç®¡ç†æ¦‚è¿°](#1-RPMåŒ…ç®¡ç†æ¦‚è¿°)
2. [RPMåŒ…æ ¼å¼ä¸å‘½åè§„èŒƒ](#2-RPMåŒ…æ ¼å¼ä¸å‘½åè§„èŒƒ)
3. [rpmå‘½ä»¤æ ¸å¿ƒå‚æ•°è¯¦è§£](#3-rpmå‘½ä»¤æ ¸å¿ƒå‚æ•°è¯¦è§£)
4. [åŒ…æŸ¥è¯¢ä¸ä¿¡æ¯æ˜¾ç¤º](#4-åŒ…æŸ¥è¯¢ä¸ä¿¡æ¯æ˜¾ç¤º)
5. [åŒ…éªŒè¯ä¸å®Œæ•´æ€§æ£€æŸ¥](#5-åŒ…éªŒè¯ä¸å®Œæ•´æ€§æ£€æŸ¥)
6. [é«˜çº§å®‰è£…é€‰é¡¹](#6-é«˜çº§å®‰è£…é€‰é¡¹)
7. [RPMæ•°æ®åº“ç®¡ç†](#7-RPMæ•°æ®åº“ç®¡ç†)
8. [åŒ…ç­¾åä¸å®‰å…¨æœºåˆ¶](#8-åŒ…ç­¾åä¸å®‰å…¨æœºåˆ¶)
9. [RPMæ„å»ºåŸºç¡€](#9-RPMæ„å»ºåŸºç¡€)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ RPMåŒ…ç®¡ç†æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯RPM


**RPMå…¨ç§°**ï¼šRed Hat Package Managerï¼ˆçº¢å¸½åŒ…ç®¡ç†å™¨ï¼‰
- ğŸ’¡ **æœ¬è´¨**ï¼šä¸€ç§æ‰“åŒ…æ ¼å¼å’Œç®¡ç†å·¥å…·
- ğŸ¯ **ç›®çš„**ï¼šæ ‡å‡†åŒ–è½¯ä»¶çš„å®‰è£…ã€å‡çº§ã€å¸è½½å’Œç®¡ç†
- ğŸ“¦ **ç‰¹ç‚¹**ï¼šé¢„ç¼–è¯‘ã€ä¾èµ–å…³ç³»ã€å…ƒæ•°æ®ä¸°å¯Œ

**RPMè§£å†³çš„æ ¸å¿ƒé—®é¢˜**ï¼š
```
ä¼ ç»Ÿè½¯ä»¶å®‰è£…ç—›ç‚¹ï¼š           RPMçš„è§£å†³æ–¹æ¡ˆï¼š
â”œâ”€ æºç ç¼–è¯‘å¤æ‚              â”œâ”€ é¢„ç¼–è¯‘äºŒè¿›åˆ¶åŒ…
â”œâ”€ ä¾èµ–å…³ç³»æ··ä¹±              â”œâ”€ æ˜ç¡®çš„ä¾èµ–å£°æ˜
â”œâ”€ å®‰è£…ä½ç½®ä¸ç»Ÿä¸€            â”œâ”€ æ ‡å‡†åŒ–ç›®å½•ç»“æ„
â”œâ”€ å¸è½½ä¸å¹²å‡€                â”œâ”€ å®Œæ•´çš„æ–‡ä»¶è·Ÿè¸ª
â””â”€ ç‰ˆæœ¬ç®¡ç†å›°éš¾              â””â”€ è¯¦ç»†çš„ç‰ˆæœ¬ä¿¡æ¯
```

### 1.2 RPMåœ¨Linuxå‘è¡Œç‰ˆä¸­çš„åœ°ä½


**RPMç”Ÿæ€ç³»ç»Ÿæ¶æ„**ï¼š
```
åº”ç”¨å±‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    yum/dnf      â”‚      zypper     â”‚ â† é«˜çº§åŒ…ç®¡ç†å™¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      rpm        â”‚      rpm        â”‚ â† åº•å±‚åŒ…ç®¡ç†å™¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   RPMæ•°æ®åº“     â”‚   RPMæ•°æ®åº“     â”‚ â† åŒ…ä¿¡æ¯å­˜å‚¨
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   RHEL/CentOS      SUSE Linux

æ”¯æŒRPMçš„å‘è¡Œç‰ˆï¼š
â”œâ”€ Red Hat Enterprise Linux (RHEL)
â”œâ”€ CentOS / AlmaLinux / Rocky Linux
â”œâ”€ Fedora
â”œâ”€ SUSE Linux Enterprise Server (SLES)
â””â”€ openSUSE
```

### 1.3 RPM vs å…¶ä»–åŒ…ç®¡ç†æ ¼å¼


| åŒ…æ ¼å¼ | **ä½¿ç”¨å‘è¡Œç‰ˆ** | **ç‰¹ç‚¹** | **ä¼˜åŠ¿** |
|--------|---------------|----------|----------|
| **RPM** | `RHEL/CentOS/Fedora` | `å…ƒæ•°æ®ä¸°å¯Œã€ç­¾åéªŒè¯` | `ä¼ä¸šçº§ç¨³å®šã€å®‰å…¨æ€§å¼º` |
| **DEB** | `Debian/Ubuntu` | `ä¾èµ–è§£ææ™ºèƒ½` | `ç¤¾åŒºæ´»è·ƒã€åŒ…æ•°é‡å¤š` |
| **TAR.XZ** | `Arch Linux` | `æ„å»ºè„šæœ¬çµæ´»` | `æ»šåŠ¨æ›´æ–°ã€è‡ªå®šä¹‰æ€§å¼º` |

---

## 2. ğŸ“¦ RPMåŒ…æ ¼å¼ä¸å‘½åè§„èŒƒ


### 2.1 RPMåŒ…æ–‡ä»¶ç»“æ„


**RPMåŒ…å†…éƒ¨ç»“æ„**ï¼š
```
RPMåŒ…æ–‡ä»¶ (.rpm)
â”œâ”€ Leadï¼ˆå¼•å¯¼ï¼‰
â”‚   â””â”€ åŒ…æ ‡è¯†å’ŒåŸºæœ¬ä¿¡æ¯
â”œâ”€ Signature Headerï¼ˆç­¾åå¤´ï¼‰
â”‚   â”œâ”€ æ•°å­—ç­¾åä¿¡æ¯
â”‚   â””â”€ å®Œæ•´æ€§æ ¡éªŒæ•°æ®
â”œâ”€ Headerï¼ˆåŒ…å¤´ï¼‰
â”‚   â”œâ”€ åŒ…å…ƒæ•°æ®
â”‚   â”œâ”€ ä¾èµ–å…³ç³»ä¿¡æ¯
â”‚   â”œâ”€ æ–‡ä»¶åˆ—è¡¨
â”‚   â””â”€ å®‰è£…è„šæœ¬
â””â”€ Payloadï¼ˆæœ‰æ•ˆè½½è·ï¼‰
    â””â”€ å®é™…çš„æ–‡ä»¶æ•°æ®ï¼ˆé€šå¸¸ä¸ºcpioæ ¼å¼å‹ç¼©ï¼‰
```

### 2.2 RPMå‘½åè§„èŒƒ


**æ ‡å‡†å‘½åæ ¼å¼**ï¼š
```
åŒ…å-ç‰ˆæœ¬-å‘å¸ƒå·.æ¶æ„.rpm
 â†“    â†“    â†“     â†“
name-version-release.architecture.rpm

ç¤ºä¾‹åˆ†æï¼š
httpd-2.4.37-43.module_el8.5.0.x86_64.rpm
â”œâ”€ httpdï¼šåŒ…åï¼ˆè½¯ä»¶åç§°ï¼‰
â”œâ”€ 2.4.37ï¼šç‰ˆæœ¬å·ï¼ˆä¸Šæ¸¸è½¯ä»¶ç‰ˆæœ¬ï¼‰
â”œâ”€ 43.module_el8.5.0ï¼šå‘å¸ƒå·ï¼ˆæ‰“åŒ…ç‰ˆæœ¬ï¼‰
â””â”€ x86_64ï¼šç›®æ ‡æ¶æ„
```

**ç‰ˆæœ¬å·è¯¦è§£**ï¼š
```bash
# ç‰ˆæœ¬æ¯”è¾ƒè§„åˆ™
2.4.37 > 2.4.36    # æ•°å­—æ¯”è¾ƒ
2.4.37-43 > 2.4.37-42  # å‘å¸ƒå·æ¯”è¾ƒ
```

### 2.3 å¸¸è§æ¶æ„æ ‡è¯†


```bash
# æŸ¥çœ‹ç³»ç»Ÿæ¶æ„
uname -m

å¸¸è§æ¶æ„ç±»å‹ï¼š
â”œâ”€ x86_64ï¼š64ä½Intel/AMDå¤„ç†å™¨
â”œâ”€ i386/i686ï¼š32ä½Intelå¤„ç†å™¨
â”œâ”€ aarch64ï¼š64ä½ARMå¤„ç†å™¨
â”œâ”€ ppc64leï¼šPowerå¤„ç†å™¨ï¼ˆå°ç«¯åºï¼‰
â”œâ”€ s390xï¼šIBM Zç³»åˆ—å¤§å‹æœº
â””â”€ noarchï¼šæ¶æ„æ— å…³åŒ…ï¼ˆè„šæœ¬ã€æ–‡æ¡£ç­‰ï¼‰
```

**æ¶æ„å…¼å®¹æ€§**ï¼š
```bash
# x86_64ç³»ç»Ÿå¯ä»¥å®‰è£…
x86_64.rpm  # åŸç”Ÿ64ä½åŒ…
i686.rpm    # 32ä½å…¼å®¹åŒ…ï¼ˆéœ€è¦32ä½åº“ï¼‰
noarch.rpm  # æ¶æ„æ— å…³åŒ…

# ä½†ä¸èƒ½å®‰è£…
aarch64.rpm # ARMæ¶æ„åŒ…
ppc64le.rpm # Poweræ¶æ„åŒ…
```

---

## 3. âš™ï¸ rpmå‘½ä»¤æ ¸å¿ƒå‚æ•°è¯¦è§£


### 3.1 å®‰è£…ç›¸å…³å‚æ•°


**ğŸ”¸ åŸºæœ¬å®‰è£…ï¼ˆ-i/--installï¼‰**
```bash
# åŸºæœ¬å®‰è£…è¯­æ³•
rpm -i package.rpm
rpm -ivh package.rpm  # æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯å’Œè¿›åº¦

# ç¤ºä¾‹ï¼šå®‰è£…vimåŒ…
rpm -ivh vim-8.0.1763-15.el8.x86_64.rpm

è¾“å‡ºç¤ºä¾‹ï¼š
å‡†å¤‡ä¸­...                          ################################# [100%]
æ­£åœ¨å‡çº§/å®‰è£…...
   1:vim-2:8.0.1763-15.el8           ################################# [100%]
```

**ğŸ”¸ å‡çº§å®‰è£…ï¼ˆ-U/--upgradeï¼‰**
```bash
# å‡çº§æˆ–å®‰è£…ï¼ˆæ¨èæ–¹å¼ï¼‰
rpm -Uvh package.rpm

# ä¸ -i çš„åŒºåˆ«
rpm -i   # åªå®‰è£…ï¼Œå¦‚æœå·²å­˜åœ¨ä¼šæŠ¥é”™
rpm -U   # å‡çº§å·²æœ‰åŒ…ï¼Œæˆ–å®‰è£…æ–°åŒ…ï¼ˆæ™ºèƒ½é€‰æ‹©ï¼‰

# ç¤ºä¾‹
rpm -Uvh httpd-2.4.37-43.el8.x86_64.rpm
```

**ğŸ”¸ å¼ºåˆ¶åˆ·æ–°ï¼ˆ-F/--freshenï¼‰**
```bash
# åªå‡çº§å·²å®‰è£…çš„åŒ…
rpm -Fvh *.rpm

# ä½¿ç”¨åœºæ™¯ï¼šæ‰¹é‡å‡çº§
rpm -Fvh /mnt/cdrom/Packages/*.rpm  # åªå‡çº§å·²å®‰è£…çš„åŒ…
```

### 3.2 å¸è½½å‚æ•°


```bash
# åŸºæœ¬å¸è½½è¯­æ³•
rpm -e package_name    # æ³¨æ„ï¼šä½¿ç”¨åŒ…åï¼Œä¸æ˜¯æ–‡ä»¶å
rpm -ev package_name   # æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯

# ç¤ºä¾‹
rpm -e vim
rpm -e httpd-2.4.37-43.el8.x86_64  # å®Œæ•´åŒ…å

# æ‰¹é‡å¸è½½
rpm -e $(rpm -qa | grep -i apache)
```

### 3.3 å®‰è£…é€‰é¡¹è¯¦è§£


| å‚æ•° | **ä½œç”¨** | **ä½¿ç”¨åœºæ™¯** |
|------|----------|-------------|
| **-v** | `æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯` | `æŸ¥çœ‹å®‰è£…è¿‡ç¨‹è¯¦æƒ…` |
| **-h** | `æ˜¾ç¤ºè¿›åº¦æ¡` | `ç›‘æ§å®‰è£…è¿›åº¦` |
| **--test** | `æ¨¡æ‹Ÿå®‰è£…ï¼Œä¸å®é™…æ‰§è¡Œ` | `æ£€æŸ¥ä¾èµ–å’Œå†²çª` |
| **--force** | `å¼ºåˆ¶å®‰è£…ï¼ˆå±é™©ï¼‰` | `è¦†ç›–å·²æœ‰æ–‡ä»¶` |
| **--nodeps** | `å¿½ç•¥ä¾èµ–æ£€æŸ¥` | `è§£å†³å¾ªç¯ä¾èµ–` |

---

## 4. ğŸ” åŒ…æŸ¥è¯¢ä¸ä¿¡æ¯æ˜¾ç¤º


### 4.1 æŸ¥è¯¢å·²å®‰è£…åŒ…


**ğŸ”¸ åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…åŒ…ï¼ˆ-qaï¼‰**
```bash
# æŸ¥çœ‹æ‰€æœ‰å·²å®‰è£…åŒ…
rpm -qa

# æŒ‰åç§°è¿‡æ»¤
rpm -qa | grep httpd
rpm -qa | grep -i python  # å¿½ç•¥å¤§å°å†™

# æŒ‰å®‰è£…æ—¶é—´æ’åº
rpm -qa --last | head -10  # æœ€è¿‘å®‰è£…çš„10ä¸ªåŒ…

# è¾“å‡ºæ ¼å¼åŒ–
rpm -qa --qf "%{NAME}-%{VERSION}-%{RELEASE}\n"
```

**ğŸ”¸ æŸ¥è¯¢ç‰¹å®šåŒ…ï¼ˆ-qï¼‰**
```bash
# æŸ¥è¯¢åŒ…æ˜¯å¦å·²å®‰è£…
rpm -q httpd
# è¾“å‡ºï¼šhttpd-2.4.37-43.el8.x86_64 ï¼ˆå·²å®‰è£…ï¼‰
# è¾“å‡ºï¼šæœªå®‰è£…è½¯ä»¶åŒ… httpd ï¼ˆæœªå®‰è£…ï¼‰

# æŸ¥è¯¢åŒ…æ–‡ä»¶
rpm -qp package.rpm  # æŸ¥è¯¢rpmæ–‡ä»¶ä¿¡æ¯
```

### 4.2 åŒ…è¯¦ç»†ä¿¡æ¯æŸ¥è¯¢


**ğŸ”¸ æ˜¾ç¤ºåŒ…ä¿¡æ¯ï¼ˆ-qiï¼‰**
```bash
# æŸ¥çœ‹å·²å®‰è£…åŒ…ä¿¡æ¯
rpm -qi httpd

è¾“å‡ºç¤ºä¾‹ï¼š
åç§°        : httpd
ç‰ˆæœ¬        : 2.4.37
å‘è¡Œ        : 43.module_el8.5.0
æ¶æ„        : x86_64
å®‰è£…æ—¥æœŸ    : 2024å¹´03æœˆ15æ—¥ æ˜ŸæœŸäº” 10æ—¶30åˆ†25ç§’
ç»„          : System Environment/Daemons
å¤§å°        : 4318203
è®¸å¯è¯      : ASL 2.0
ç­¾å        : RSA/SHA256, 2021å¹´11æœˆ10æ—¥ æ˜ŸæœŸä¸‰
æº RPM      : httpd-2.4.37-43.module_el8.5.0.src.rpm
æ„å»ºæ—¥æœŸ    : 2021å¹´11æœˆ09æ—¥ æ˜ŸæœŸäºŒ
æ„å»ºä¸»æœº    : x86-02.mbox.centos.org
æ‘˜è¦        : Apache HTTP Server
æè¿°        : The Apache HTTP Server is a powerful...
```

**ğŸ”¸ æ˜¾ç¤ºåŒ…æ–‡ä»¶åˆ—è¡¨ï¼ˆ-qlï¼‰**
```bash
# æŸ¥çœ‹åŒ…å®‰è£…çš„æ–‡ä»¶
rpm -ql httpd

è¾“å‡ºç¤ºä¾‹ï¼š
/etc/httpd/conf/httpd.conf
/etc/httpd/conf.d
/usr/sbin/httpd
/usr/share/httpd/noindex
/var/log/httpd
/var/www/html
...

# åªæ˜¾ç¤ºé…ç½®æ–‡ä»¶
rpm -qc httpd

# åªæ˜¾ç¤ºæ–‡æ¡£æ–‡ä»¶
rpm -qd httpd
```

### 4.3 åå‘æŸ¥è¯¢


**ğŸ”¸ æŸ¥è¯¢æ–‡ä»¶å±äºå“ªä¸ªåŒ…ï¼ˆ-qfï¼‰**
```bash
# æŸ¥è¯¢æ–‡ä»¶æ‰€å±åŒ…
rpm -qf /usr/sbin/httpd
# è¾“å‡ºï¼šhttpd-2.4.37-43.el8.x86_64

rpm -qf /etc/passwd
# è¾“å‡ºï¼šsetup-2.12.2-6.el8.noarch

# æŸ¥è¯¢å‘½ä»¤æ‰€å±åŒ…
rpm -qf $(which ls)
# è¾“å‡ºï¼šcoreutils-8.30-12.el8.x86_64
```

### 4.4 ä¾èµ–å…³ç³»æŸ¥è¯¢


```bash
# æŸ¥è¯¢åŒ…çš„ä¾èµ–å…³ç³»
rpm -qR httpd
è¾“å‡ºï¼š
/bin/sh
/usr/sbin/useradd
httpd-filesystem = 2.4.37-43.module_el8.5.0
httpd-tools = 2.4.37-43.module_el8.5.0
libapr-1.so.0()(64bit)
...

# æŸ¥è¯¢å“ªäº›åŒ…ä¾èµ–æ­¤åŒ…
rpm -q --whatrequires httpd-tools

# æŸ¥è¯¢åŒ…æä¾›çš„åŠŸèƒ½
rpm -q --provides httpd
```

---

## 5. âœ… åŒ…éªŒè¯ä¸å®Œæ•´æ€§æ£€æŸ¥


### 5.1 åŒ…éªŒè¯åŸºç¡€


**ä»€ä¹ˆæ˜¯RPMéªŒè¯**ï¼šæ£€æŸ¥å·²å®‰è£…åŒ…çš„æ–‡ä»¶å®Œæ•´æ€§å’Œå±æ€§
```bash
# åŸºæœ¬éªŒè¯è¯­æ³•
rpm -V package_name    # éªŒè¯ç‰¹å®šåŒ…
rpm -Va               # éªŒè¯æ‰€æœ‰åŒ…ï¼ˆè€—æ—¶è¾ƒé•¿ï¼‰

# ç¤ºä¾‹
rpm -V httpd
# æ— è¾“å‡ºè¡¨ç¤ºéªŒè¯é€šè¿‡
# æœ‰è¾“å‡ºè¡¨ç¤ºå‘ç°é—®é¢˜
```

### 5.2 éªŒè¯è¾“å‡ºè§£è¯»


**éªŒè¯ç»“æœæ ¼å¼**ï¼š
```bash
# éªŒè¯è¾“å‡ºç¤ºä¾‹
S.5....T.  c /etc/httpd/conf/httpd.conf

æ ¼å¼è¯´æ˜ï¼š
S.5....T.  c /path/to/file
â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚  â”‚ â”‚
â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚  â”‚ â””â”€ æ–‡ä»¶è·¯å¾„
â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚â”‚  â””â”€ æ–‡ä»¶ç±»å‹æ ‡è¯†
â”‚â”‚â”‚â”‚â”‚â”‚â”‚â””â”€ T: ä¿®æ”¹æ—¶é—´å˜åŒ–
â”‚â”‚â”‚â”‚â”‚â”‚â””â”€ (æœªä½¿ç”¨)
â”‚â”‚â”‚â”‚â”‚â””â”€ (æœªä½¿ç”¨)  
â”‚â”‚â”‚â”‚â””â”€ (æœªä½¿ç”¨)
â”‚â”‚â”‚â””â”€ 4: (æœªä½¿ç”¨)
â”‚â”‚â””â”€ 5: MD5æ ¡éªŒå’Œå˜åŒ–
â”‚â””â”€ (æœªä½¿ç”¨)
â””â”€ S: æ–‡ä»¶å¤§å°å˜åŒ–
```

**éªŒè¯å±æ€§å«ä¹‰**ï¼š
```bash
éªŒè¯ä½å«ä¹‰ï¼š
â”œâ”€ S: Sizeï¼ˆæ–‡ä»¶å¤§å°ï¼‰
â”œâ”€ M: Modeï¼ˆæƒé™å’Œæ–‡ä»¶ç±»å‹ï¼‰
â”œâ”€ 5: MD5æ ¡éªŒå’Œ
â”œâ”€ D: Deviceï¼ˆä¸»æ¬¡è®¾å¤‡å·ï¼‰
â”œâ”€ L: readLinkè·¯å¾„
â”œâ”€ U: Userï¼ˆæ–‡ä»¶æ‰€æœ‰è€…ï¼‰
â”œâ”€ G: Groupï¼ˆæ–‡ä»¶æ‰€å±ç»„ï¼‰
â”œâ”€ T: mTimeï¼ˆä¿®æ”¹æ—¶é—´ï¼‰
â””â”€ P: caPabilitiesï¼ˆæ–‡ä»¶èƒ½åŠ›ï¼‰

æ–‡ä»¶ç±»å‹ï¼š
â”œâ”€ c: é…ç½®æ–‡ä»¶
â”œâ”€ d: æ–‡æ¡£æ–‡ä»¶
â”œâ”€ g: ghostæ–‡ä»¶
â”œâ”€ l: è®¸å¯è¯æ–‡ä»¶
â””â”€ r: readmeæ–‡ä»¶
```

### 5.3 éªŒè¯å®ä¾‹åˆ†æ


```bash
# ä¿®æ”¹é…ç½®æ–‡ä»¶åéªŒè¯
echo "# test modification" >> /etc/httpd/conf/httpd.conf
rpm -V httpd

è¾“å‡ºï¼š
S.5....T.  c /etc/httpd/conf/httpd.conf
          â†‘     â†‘        â†‘
     å¤§å°å˜åŒ–  MD5å˜åŒ–   æ—¶é—´å˜åŒ–

# éªŒè¯å…³é”®ç³»ç»Ÿæ–‡ä»¶
rpm -V setup coreutils filesystem
```

### 5.4 åŒ…å®Œæ•´æ€§ä¿®å¤


```bash
# ä¿®å¤æŸåçš„åŒ…æ–‡ä»¶
rpm -Uvh --replacepkgs package.rpm  # æ›¿æ¢åŒ…æ¨¡å¼é‡è£…

# ä¿®å¤ç‰¹å®šæ–‡ä»¶ï¼ˆéœ€è¦åŸå§‹rpmåŒ…ï¼‰
rpm2cpio package.rpm | cpio -idmv ./path/to/file
cp path/to/file /path/to/file

# æ‰¹é‡éªŒè¯å’Œä¿®å¤è„šæœ¬ç¤ºä¾‹
#!/bin/bash
for pkg in $(rpm -Va | awk '{print $2}' | xargs rpm -qf | sort -u); do
    echo "éªŒè¯åŒ…: $pkg"
    rpm -V $pkg
done
```

---

## 6. ğŸ”§ é«˜çº§å®‰è£…é€‰é¡¹


### 6.1 å¼ºåˆ¶å®‰è£…é€‰é¡¹


**> âš ï¸ è­¦å‘Š**ï¼šå¼ºåˆ¶å®‰è£…å¯èƒ½å¯¼è‡´ç³»ç»Ÿä¸ç¨³å®šï¼Œä»…åœ¨å®Œå…¨ç†è§£åæœæ—¶ä½¿ç”¨

```bash
# å¿½ç•¥ä¾èµ–å®‰è£…ï¼ˆå±é™©ï¼‰
rpm -ivh --nodeps package.rpm

# å¼ºåˆ¶è¦†ç›–æ–‡ä»¶
rpm -ivh --force package.rpm

# æ›¿æ¢å·²å®‰è£…åŒ…
rpm -ivh --replacepkgs package.rpm

# ç»„åˆä½¿ç”¨ï¼ˆæåº¦å±é™©ï¼‰
rpm -ivh --force --nodeps package.rpm
```

### 6.2 ä¾èµ–é—®é¢˜è§£å†³


**ä¾èµ–å†²çªå¤„ç†æµç¨‹**ï¼š
```bash
# 1. æ£€æŸ¥ä¾èµ–
rpm -ivh --test package.rpm
è¾“å‡ºï¼š
é”™è¯¯ï¼šä¾èµ–æ£€æµ‹å¤±è´¥ï¼š
        libssl.so.1.1()(64bit) è¢« package.rpm éœ€è¦

# 2. æŸ¥æ‰¾æä¾›ä¾èµ–çš„åŒ…
yum whatprovides libssl.so.1.1

# 3. å®‰è£…ä¾èµ–åŒ…
yum install openssl-libs

# 4. é‡æ–°å®‰è£…ç›®æ ‡åŒ…
rpm -ivh package.rpm
```

### 6.3 å®‰è£…ä½ç½®è‡ªå®šä¹‰


```bash
# æ”¹å˜å®‰è£…æ ¹ç›®å½•
rpm -ivh --root /mnt/sysimage package.rpm

# æ’é™¤ç‰¹å®šæ–‡ä»¶
rpm -ivh --excludedocs package.rpm  # ä¸å®‰è£…æ–‡æ¡£

# å®‰è£…å‰åè„šæœ¬æ§åˆ¶
rpm -ivh --noscripts package.rpm    # è·³è¿‡å®‰è£…è„šæœ¬
```

### 6.4 æ‰¹é‡æ“ä½œ


```bash
# æ‰¹é‡å®‰è£…
rpm -ivh *.rpm
rpm -ivh package1.rpm package2.rpm package3.rpm

# æ‰¹é‡å‡çº§
rpm -Uvh /path/to/packages/*.rpm

# ä»URLå®‰è£…
rpm -ivh http://example.com/package.rpm
rpm -ivh ftp://ftp.example.com/package.rpm
```

---

## 7. ğŸ’¾ RPMæ•°æ®åº“ç®¡ç†


### 7.1 RPMæ•°æ®åº“æ¦‚è¿°


**RPMæ•°æ®åº“ä½ç½®**ï¼š
```bash
# é»˜è®¤æ•°æ®åº“ä½ç½®
/var/lib/rpm/

æ•°æ®åº“æ–‡ä»¶ï¼š
â”œâ”€ Packagesï¼šä¸»æ•°æ®åº“æ–‡ä»¶
â”œâ”€ Nameï¼šæŒ‰åŒ…åç´¢å¼•
â”œâ”€ Basenamesï¼šæŒ‰æ–‡ä»¶åç´¢å¼•
â”œâ”€ Groupï¼šæŒ‰ç»„åˆ†ç±»ç´¢å¼•
â”œâ”€ Requirenameï¼šä¾èµ–å…³ç³»ç´¢å¼•
â””â”€ Providenameï¼šæä¾›åŠŸèƒ½ç´¢å¼•
```

### 7.2 æ•°æ®åº“æŸ¥è¯¢ä¸ç»´æŠ¤


```bash
# æŸ¥çœ‹æ•°æ®åº“ç»Ÿè®¡ä¿¡æ¯
rpm --querytags | wc -l  # æ”¯æŒçš„æŸ¥è¯¢æ ‡ç­¾æ•°
rpm -qa | wc -l          # å·²å®‰è£…åŒ…æ€»æ•°

# æ£€æŸ¥æ•°æ®åº“ä¸€è‡´æ€§
rpm -Va --nofiles --nodigest

# é‡å»ºæ•°æ®åº“ç´¢å¼•
rpm --rebuilddb

# åˆå§‹åŒ–æ–°æ•°æ®åº“
rpm --initdb
```

### 7.3 æ•°æ®åº“å¤‡ä»½ä¸æ¢å¤


```bash
# å¤‡ä»½RPMæ•°æ®åº“
tar czf rpm-db-backup-$(date +%Y%m%d).tar.gz -C /var/lib/rpm .

# æ¢å¤RPMæ•°æ®åº“
cd /var/lib/rpm
rm -f __db.*  # åˆ é™¤é”æ–‡ä»¶
tar xzf rpm-db-backup-20240315.tar.gz
rpm --rebuilddb
```

### 7.4 æ•°æ®åº“æ•…éšœæ’é™¤


**å¸¸è§æ•°æ®åº“é—®é¢˜**ï¼š
```bash
# æ•°æ®åº“é”å®šé—®é¢˜
é”™è¯¯ï¼šæ— æ³•è·å–é” /var/lib/rpm/.rpm.lock

è§£å†³æ–¹æ³•ï¼š
rm -f /var/lib/rpm/.rpm.lock
rm -f /var/lib/rpm/__db.*

# æ•°æ®åº“æŸåä¿®å¤
rpm --rebuilddb
```

**æ•°æ®åº“ä¸€è‡´æ€§æ£€æŸ¥è„šæœ¬**ï¼š
```bash
#!/bin/bash
# RPMæ•°æ®åº“å¥åº·æ£€æŸ¥
echo "æ£€æŸ¥RPMæ•°æ®åº“å®Œæ•´æ€§..."

# æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶
if [ ! -f /var/lib/rpm/Packages ]; then
    echo "é”™è¯¯ï¼šRPMæ•°æ®åº“ä¸»æ–‡ä»¶ä¸¢å¤±"
    exit 1
fi

# æ£€æŸ¥æ•°æ®åº“å¯è¯»æ€§
if ! rpm -qa > /dev/null 2>&1; then
    echo "è­¦å‘Šï¼šRPMæ•°æ®åº“å¯èƒ½æŸåï¼Œå°è¯•é‡å»º..."
    rpm --rebuilddb
fi

echo "RPMæ•°æ®åº“æ£€æŸ¥å®Œæˆ"
```

---

## 8. ğŸ” åŒ…ç­¾åä¸å®‰å…¨æœºåˆ¶


### 8.1 æ•°å­—ç­¾åæ¦‚è¿°


**ä¸ºä»€ä¹ˆéœ€è¦åŒ…ç­¾å**ï¼š
- ğŸ”’ **é˜²ç¯¡æ”¹**ï¼šç¡®ä¿åŒ…å†…å®¹æœªè¢«æ¶æ„ä¿®æ”¹
- ğŸ›ï¸ **éªŒè¯æ¥æº**ï¼šç¡®è®¤åŒ…æ¥è‡ªå¯ä¿¡çš„å‘å¸ƒè€…
- ğŸ›¡ï¸ **å®Œæ•´æ€§**ï¼šæ£€æµ‹ä¼ è¾“è¿‡ç¨‹ä¸­çš„æ•°æ®æŸå

**ç­¾åå·¥ä½œæµç¨‹**ï¼š
```
æ‰“åŒ…è€…                     ç”¨æˆ·
  â†“                        â†“
1. ç”¨ç§é’¥ç­¾ååŒ… ---------> 4. ç”¨å…¬é’¥éªŒè¯ç­¾å
2. å‘å¸ƒå…¬é’¥              5. éªŒè¯é€šè¿‡åˆ™å®‰è£…
3. åˆ†å‘å·²ç­¾ååŒ… -------->  6. éªŒè¯å¤±è´¥åˆ™æ‹’ç»
```

### 8.2 GPGå¯†é’¥ç®¡ç†


```bash
# æŸ¥çœ‹ç³»ç»Ÿä¸­çš„RPM GPGå¯†é’¥
rpm -qa gpg-pubkey*

# æŸ¥çœ‹å¯†é’¥è¯¦æƒ…
rpm -qi gpg-pubkey-fd431d51-4ae0493b

# å¯¼å…¥æ–°çš„GPGå¯†é’¥
rpm --import /path/to/RPM-GPG-KEY-vendor

# ä»URLå¯¼å…¥å¯†é’¥
rpm --import https://example.com/RPM-GPG-KEY
```

### 8.3 ç­¾åéªŒè¯æ“ä½œ


```bash
# æ£€æŸ¥åŒ…ç­¾å
rpm -K package.rpm
è¾“å‡ºç¤ºä¾‹ï¼š
package.rpm: rsa sha1 (md5) pgp md5 OK   # ç­¾åå®Œæ•´
package.rpm: sha1 md5 OK                # æ— ç­¾åä½†æ ¡éªŒå’Œæ­£ç¡®

# è¯¦ç»†ç­¾åä¿¡æ¯
rpm -Kv package.rpm

# å®‰è£…æ—¶è‡ªåŠ¨éªŒè¯ç­¾å
rpm -ivh --checksig package.rpm
```

### 8.4 ç­¾åç­–ç•¥é…ç½®


```bash
# æŸ¥çœ‹ç­¾åæ£€æŸ¥é…ç½®
grep signature /etc/rpm/macros.*

# å…¨å±€ç­¾åç­–ç•¥ï¼ˆ/etc/rpm/macrosï¼‰
%_signature gpg
%_gpg_name "Your Name <email@example.com>"

# è·³è¿‡ç­¾åæ£€æŸ¥ï¼ˆä¸æ¨èï¼‰
rpm -ivh --nosignature package.rpm

# åªæ£€æŸ¥ç­¾åï¼Œä¸å®‰è£…
rpm --checksig *.rpm
```

---

## 9. ğŸ—ï¸ RPMæ„å»ºåŸºç¡€


### 9.1 RPMæ„å»ºç¯å¢ƒå‡†å¤‡


```bash
# å®‰è£…æ„å»ºå·¥å…·
yum groupinstall "Development Tools"
yum install rpm-build rpmdevtools

# åˆ›å»ºæ„å»ºç›®å½•ç»“æ„
rpmdev-setuptree

ç›®å½•ç»“æ„ï¼š
~/rpmbuild/
â”œâ”€ BUILD/      # ç¼–è¯‘ç›®å½•
â”œâ”€ BUILDROOT/  # å®‰è£…æ ¹ç›®å½•
â”œâ”€ RPMS/       # ç”Ÿæˆçš„äºŒè¿›åˆ¶åŒ…
â”œâ”€ SOURCES/    # æºä»£ç å’Œè¡¥ä¸
â”œâ”€ SPECS/      # specæ–‡ä»¶
â””â”€ SRPMS/      # æºç åŒ…
```

### 9.2 SPECæ–‡ä»¶åŸºç¡€


**SPECæ–‡ä»¶æ¨¡æ¿**ï¼š
```spec
Name:           mypackage
Version:        1.0
Release:        1%{?dist}
Summary:        A sample package

Group:          Applications/Internet
License:        GPL
URL:            http://example.com
Source0:        %{name}-%{version}.tar.gz

BuildRequires:  gcc
Requires:       glibc

%description
This is a sample package for demonstration.

%prep
%setup -q

%build
make %{?_smp_mflags}

%install
rm -rf $RPM_BUILD_ROOT
make install DESTDIR=$RPM_BUILD_ROOT

%files
%defattr(-,root,root,-)
/usr/bin/myprogram
%doc README COPYING ChangeLog

%changelog
* Mon Mar 15 2024 Your Name <email@example.com> - 1.0-1
- Initial package
```

### 9.3 æ„å»ºè¿‡ç¨‹


```bash
# ä»SPECæ–‡ä»¶æ„å»º
rpmbuild -ba mypackage.spec

æ„å»ºé˜¶æ®µï¼š
â”œâ”€ %prepï¼šå‡†å¤‡æºç 
â”œâ”€ %buildï¼šç¼–è¯‘è½¯ä»¶
â”œâ”€ %installï¼šå®‰è£…åˆ°æ„å»ºæ ¹ç›®å½•
â”œâ”€ %filesï¼šæ‰“åŒ…æ–‡ä»¶
â””â”€ ç”ŸæˆRPMåŒ…

# åªæ„å»ºäºŒè¿›åˆ¶åŒ…
rpmbuild -bb mypackage.spec

# åªæ„å»ºæºç åŒ…
rpmbuild -bs mypackage.spec
```

### 9.4 åŒ…æµ‹è¯•ä¸å‘å¸ƒ


```bash
# æµ‹è¯•å®‰è£…
rpm -ivh --test ~/rpmbuild/RPMS/x86_64/mypackage-1.0-1.el8.x86_64.rpm

# æ£€æŸ¥åŒ…å†…å®¹
rpm -qlp ~/rpmbuild/RPMS/x86_64/mypackage-1.0-1.el8.x86_64.rpm

# éªŒè¯åŒ…ç­¾å
rpm -K ~/rpmbuild/RPMS/x86_64/mypackage-1.0-1.el8.x86_64.rpm

# å‘å¸ƒåˆ°ä»“åº“
createrepo /path/to/repository
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„åŸºç¡€æ“ä½œ


```bash
# åŒ…å®‰è£…ç®¡ç†
rpm -ivh package.rpm    # å®‰è£…æ–°åŒ…
rpm -Uvh package.rpm    # å‡çº§æˆ–å®‰è£…åŒ…ï¼ˆæ¨èï¼‰
rpm -e package_name     # å¸è½½åŒ…

# åŒ…æŸ¥è¯¢æ“ä½œ
rpm -qa                 # åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…åŒ…
rpm -qi package_name    # æŸ¥çœ‹åŒ…è¯¦ç»†ä¿¡æ¯
rpm -ql package_name    # æŸ¥çœ‹åŒ…æ–‡ä»¶åˆ—è¡¨
rpm -qf /path/to/file   # æŸ¥è¯¢æ–‡ä»¶å±äºå“ªä¸ªåŒ…

# åŒ…éªŒè¯æ£€æŸ¥
rpm -V package_name     # éªŒè¯åŒ…å®Œæ•´æ€§
rpm -K package.rpm      # æ£€æŸ¥åŒ…ç­¾å
```

### 10.2 å…³é”®æ¦‚å¿µç†è§£


**ğŸ”¹ RPM vs é«˜çº§åŒ…ç®¡ç†å™¨**
```
RPMï¼ˆåº•å±‚ï¼‰ï¼š
âœ… ç›´æ¥æ“ä½œåŒ…æ–‡ä»¶
âœ… ä¸è‡ªåŠ¨è§£å†³ä¾èµ–
âœ… é€Ÿåº¦å¿«ã€æ§åˆ¶ç²¾ç¡®
âŒ éœ€è¦æ‰‹åŠ¨ç®¡ç†ä¾èµ–å…³ç³»

YUM/DNFï¼ˆé«˜çº§ï¼‰ï¼š
âœ… è‡ªåŠ¨è§£å†³ä¾èµ–å…³ç³»
âœ… ä»ä»“åº“å®‰è£…
âœ… æ‰¹é‡æ“ä½œæ–¹ä¾¿
âŒ ç›¸å¯¹å¤æ‚ã€é€Ÿåº¦ç¨æ…¢
```

**ğŸ”¹ å®‰å…¨éªŒè¯çš„é‡è¦æ€§**
```
ç­¾åéªŒè¯ä¿æŠ¤ï¼š
â”œâ”€ é˜²æ­¢æ¶æ„è½¯ä»¶å®‰è£…
â”œâ”€ ç¡®ä¿åŒ…æ¥æºå¯ä¿¡
â”œâ”€ æ£€æµ‹ä¼ è¾“è¿‡ç¨‹æŸå
â””â”€ ç»´æŠ¤ç³»ç»Ÿå®Œæ•´æ€§
```

### 10.3 å®é™…åº”ç”¨åœºæ™¯


**ğŸ”¸ ä¼ä¸šç¯å¢ƒæœ€ä½³å®è·µ**
```bash
# 1. å®‰è£…å‰æ£€æŸ¥
rpm -ivh --test package.rpm

# 2. å¤‡ä»½é‡è¦é…ç½®
cp /etc/important.conf /etc/important.conf.backup

# 3. ä½¿ç”¨å‡çº§æ¨¡å¼å®‰è£…
rpm -Uvh package.rpm

# 4. éªŒè¯å®‰è£…ç»“æœ
rpm -V package_name
```

**ğŸ”¸ æ•…éšœæ’é™¤æµç¨‹**
```bash
# 1. æ£€æŸ¥ä¾èµ–é—®é¢˜
rpm -qR package_name

# 2. æŸ¥æ‰¾å†²çªæ–‡ä»¶
rpm -ql package_name | xargs ls -la

# 3. éªŒè¯åŒ…å®Œæ•´æ€§
rpm -Va --nofiles

# 4. é‡å»ºæ•°æ®åº“
rpm --rebuilddb
```

**ğŸ”¸ å®šåˆ¶åŒ–éƒ¨ç½²**
- ğŸ¢ **ä¼ä¸šå†…éƒ¨è½¯ä»¶**ï¼šæ„å»ºç§æœ‰RPMåŒ…
- ğŸ”§ **ç³»ç»Ÿé…ç½®**ï¼šæ‰“åŒ…é…ç½®æ–‡ä»¶å’Œè„šæœ¬  
- ğŸ“¦ **æ‰¹é‡éƒ¨ç½²**ï¼šä½¿ç”¨rpmè¿›è¡Œå¤§è§„æ¨¡è½¯ä»¶éƒ¨ç½²
- ğŸ” **å®‰å…¨ç­–ç•¥**ï¼šå¼ºåˆ¶ç­¾åéªŒè¯å’Œå®Œæ•´æ€§æ£€æŸ¥

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- RPMæ˜¯åº•å±‚åŒ…ç®¡ç†ï¼Œç²¾ç¡®ä½†éœ€è¦æ‰‹åŠ¨å¤„ç†ä¾èµ–
- åŒ…å‘½åéµå¾ªä¸¥æ ¼è§„èŒƒï¼šåç§°-ç‰ˆæœ¬-å‘å¸ƒå·.æ¶æ„
- éªŒè¯æœºåˆ¶ç¡®ä¿ç³»ç»Ÿå®‰å…¨å’ŒåŒ…å®Œæ•´æ€§
- æ•°æ®åº“ç®¡ç†æ˜¯RPMç³»ç»Ÿæ­£å¸¸è¿è¡Œçš„åŸºç¡€
- æ„å»ºç¯å¢ƒå…è®¸åˆ›å»ºå®šåˆ¶åŒ–çš„ä¼ä¸šçº§è½¯ä»¶åŒ…