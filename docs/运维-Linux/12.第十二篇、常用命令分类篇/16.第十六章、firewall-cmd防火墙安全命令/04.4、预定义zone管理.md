---
title: 4、预定义zone管理
---
## 📚 目录

1. [zone区域基本概念](#1-zone区域基本概念)
2. [预定义zone详解](#2-预定义zone详解)
3. [zone管理核心命令](#3-zone管理核心命令)
4. [zone安全策略对比](#4-zone安全策略对比)
5. [zone实际应用场景](#5-zone实际应用场景)
6. [核心要点总结](#6-核心要点总结)

---

## 1. 🛡️ zone区域基本概念


### 1.1 什么是zone区域


**🔸 通俗理解**
```
想象你的房子有不同的区域：
- 客厅：可以接待一般客人（public区域）
- 卧室：只允许家人进入（home区域）  
- 保险库：完全禁止外人（drop区域）

Linux防火墙的zone就是这样的概念！
```

**📍 zone的本质**：
- **安全边界**：每个zone代表不同的安全信任级别
- **规则集合**：每个zone包含一套防火墙规则
- **网卡绑定**：网络接口卡可以分配到不同zone
- **动态切换**：可以根据环境动态调整zone策略

### 1.2 zone工作机制


**🔄 zone运行逻辑**：
```
数据包到达 → 判断来源网卡 → 匹配对应zone → 应用zone规则 → 允许/拒绝
```

💡 **生活化类比**：
就像小区门禁系统：
- **业主通道**（trusted）：刷卡直接进入
- **访客通道**（public）：登记后有限制地进入  
- **送货通道**（work）：只能到达指定区域
- **黑名单**（drop）：直接拒绝

---

## 2. 🏗️ 预定义zone详解


### 2.1 查看所有可用zone


**🔍 基础查看命令**：
```bash
# 列出系统所有预定义zone
firewall-cmd --get-zones

# 输出示例：
# block dmz drop external home internal public trusted work
```

**📊 zone数量说明**：
- CentOS/RHEL默认提供 **9个** 预定义zone
- 每个zone都有不同的安全策略
- 可以根据需要创建自定义zone

### 2.2 高安全级别zone


#### 🔒 drop区域（最严格）


**🎯 安全特点**：
```
策略：丢弃所有传入数据包
行为：静默丢弃，不返回任何响应
适用：高度敏感环境，需要隐身
```

**💼 典型应用场景**：
- 生产服务器的管理网口
- 面向互联网的honeypot系统
- 需要完全隐藏的内部服务

#### 🚫 block区域（严格拒绝）


**🎯 安全特点**：
```
策略：拒绝所有传入连接
行为：主动返回icmp-host-prohibited消息
适用：需要明确告知拒绝的场景
```

**🔄 drop vs block对比**：
| 特性 | **drop** | **block** |
|------|----------|-----------|
| 🔇 响应方式 | 静默丢弃 | 主动拒绝 |
| 👁️ 隐蔽性 | 完全隐身 | 暴露存在 |
| 🔍 故障排查 | 困难 | 容易 |
| ⚡ 网络效率 | 高 | 中等 |

### 2.3 中等安全级别zone


#### 🏠 home区域（家庭网络）


**🎯 设计理念**：
```
信任度：中高（信任同网段设备）
默认服务：ssh, dhcpv6-client, mdns, samba-client
适用环境：家庭局域网，小型办公室
```

**💡 实际应用**：
- 家用路由器后的设备
- 小型工作室内网
- 开发测试环境

```bash
# 查看home区域详细配置
firewall-cmd --zone=home --list-all

# 典型输出：
# home (active)
#   interfaces: enp0s3
#   services: dhcpv6-client mdns samba-client ssh
#   masquerade: no
```

#### 🏢 work区域（工作环境）


**🎯 设计理念**：
```
信任度：中等（信任工作网络）
默认服务：ssh, dhcpv6-client
策略：允许基本工作需要，限制其他服务
```

**💼 适用场景**：
- 企业办公网络
- 部门内部网段
- 协作开发环境

#### 🌐 internal区域（内网环境）


**🎯 设计理念**：
```
信任度：较高（组织内部网络）
默认服务：ssh, dhcpv6-client, mdns, samba-client
策略：允许内部协作，限制外部访问
```

### 2.4 低安全级别zone


#### 🌍 public区域（公共网络）


**🎯 设计理念**：
```
信任度：低（默认zone）
默认服务：ssh, dhcpv6-client
策略：最小权限原则，只开放必要服务
```

**📍 重要性说明**：
- **默认zone**：新网卡默认分配到public
- **最常用**：大部分服务器使用此zone
- **安全平衡**：在安全和可用性间找平衡

```bash
# 查看public区域配置
firewall-cmd --zone=public --list-all

# 添加服务到public zone
firewall-cmd --zone=public --add-service=http --permanent
firewall-cmd --reload
```

#### 🔗 external区域（外网环境）


**🎯 设计理念**：
```
信任度：很低（面向互联网）
默认服务：ssh
特殊功能：启用IP伪装（masquerading）
适用：网关、路由器、NAT设备
```

**⚙️ 关键特性**：
- **IP伪装**：自动进行网络地址转换
- **最小服务**：只开放ssh管理
- **网关角色**：适合作为网络出入口

### 2.5 特殊用途zone


#### ⭐ trusted区域（完全信任）


**🎯 设计理念**：
```
信任度：最高（完全信任）
策略：允许所有传入流量
适用：完全可信的网络环境
```

**⚠️ 使用警告**：
- 等同于关闭防火墙
- 只适用于绝对安全的环境
- 管理网络或测试环境使用

#### 🏰 dmz区域（非军事区）


**🎯 设计理念**：
```
信任度：较低（面向公网的服务）
默认服务：ssh
策略：允许特定公共服务，限制其他访问
```

**💼 典型应用**：
- Web服务器
- 邮件服务器
- DNS服务器
- 对外提供服务的应用

---

## 3. ⚙️ zone管理核心命令


### 3.1 查看zone状态


**🔍 基础查看命令**：
```bash
# 1. 查看所有zone
firewall-cmd --get-zones

# 2. 查看当前活动的zone
firewall-cmd --get-active-zones

# 3. 查看默认zone
firewall-cmd --get-default-zone

# 4. 查看特定网卡的zone
firewall-cmd --get-zone-of-interface=eth0
```

**📊 活动zone示例输出**：
```
public
  interfaces: eth0 eth1
home
  interfaces: wlan0
```

### 3.2 zone分配管理


**🔄 网卡zone分配**：
```bash
# 临时将网卡分配到指定zone
firewall-cmd --zone=home --change-interface=eth0

# 永久分配网卡到zone
firewall-cmd --permanent --zone=work --change-interface=eth1
firewall-cmd --reload

# 从zone中移除网卡
firewall-cmd --zone=public --remove-interface=eth0
```

### 3.3 默认zone管理


**🎯 默认zone设置**：
```bash
# 查看当前默认zone
firewall-cmd --get-default-zone

# 设置新的默认zone
firewall-cmd --set-default-zone=home

# 验证设置结果
firewall-cmd --get-default-zone
```

💡 **默认zone作用**：
- 新网卡自动分配的zone
- 未明确指定zone的规则生效范围
- 系统重启后的zone配置基准

---

## 4. 📊 zone安全策略对比


### 4.1 zone安全级别排序


**🔒 从高到低安全级别**：
```
1. drop      ⭐⭐⭐⭐⭐ 完全丢弃
2. block     ⭐⭐⭐⭐   主动拒绝  
3. public    ⭐⭐⭐     公共网络
4. external  ⭐⭐⭐     外网环境
5. dmz       ⭐⭐⭐     非军事区
6. work      ⭐⭐       工作环境
7. home      ⭐⭐       家庭网络
8. internal  ⭐⭐       内部网络
9. trusted   ⭐         完全信任
```

### 4.2 zone默认服务对比表


| zone类型 | **默认开放服务** | **安全级别** | **适用场景** |
|----------|-----------------|-------------|-------------|
| 🔒 **drop** | `无` | 最高 | 完全隐藏 |
| 🚫 **block** | `无` | 很高 | 明确拒绝 |
| 🌍 **public** | `ssh, dhcpv6-client` | 高 | 公共服务器 |
| 🔗 **external** | `ssh + masquerade` | 高 | 网关设备 |
| 🏰 **dmz** | `ssh` | 中高 | 公共服务 |
| 🏢 **work** | `ssh, dhcpv6-client` | 中等 | 办公环境 |
| 🏠 **home** | `ssh, dhcpv6-client, mdns, samba-client` | 中低 | 家庭网络 |
| 🏢 **internal** | `ssh, dhcpv6-client, mdns, samba-client` | 低 | 内部网络 |
| ⭐ **trusted** | `全部允许` | 最低 | 测试环境 |

### 4.3 zone特殊功能对比


**🔧 特殊功能说明**：
```
IP伪装（Masquerading）：
✅ external - 默认启用
❌ 其他zone - 默认禁用

端口转发：
✅ 所有zone - 支持配置
🔧 配置复杂度因zone而异

自定义规则：
✅ 所有zone - 完全支持
🎯 灵活性和安全性平衡
```

---

## 5. 🎯 zone实际应用场景


### 5.1 企业网络架构示例


**🏢 典型企业网络zone规划**：
```
Internet
    |
┌───▼────┐
│ Router │ external zone (网关)
└───┬────┘
    |
┌───▼────┐
│Firewall│ 
└───┬────┘
    |
┌───▼────┬─────────┬─────────┐
│  DMZ   │  Work   │  Home   │
│  zone  │  zone   │  zone   │
└────────┴─────────┴─────────┘
Web服务器  办公电脑   测试环境
```

**📋 zone分配策略**：
- **external**：面向互联网的路由器接口
- **dmz**：Web服务器、邮件服务器等公共服务
- **work**：员工办公电脑、业务服务器
- **home**：开发测试环境、临时设备

### 5.2 家庭网络简单配置


**🏠 家庭网络zone使用**：
```bash
# 1. 设置默认zone为home（信任家庭网络）
firewall-cmd --set-default-zone=home

# 2. 如果有访客WiFi，可以设置为public
firewall-cmd --permanent --zone=public --change-interface=wlan1

# 3. 内网NAS等设备使用internal
firewall-cmd --permanent --zone=internal --change-interface=eth1
```

### 5.3 云服务器安全配置


**☁️ 云服务器zone最佳实践**：
```bash
# 1. 保持默认public zone（面向公网）
firewall-cmd --get-default-zone

# 2. 只开放必要服务
firewall-cmd --zone=public --add-service=http --permanent
firewall-cmd --zone=public --add-service=https --permanent

# 3. 管理端口使用特定源IP限制
firewall-cmd --zone=public --add-rich-rule='rule family="ipv4" source address="管理员IP" port protocol="tcp" port="22" accept' --permanent

# 4. 应用配置
firewall-cmd --reload
```

### 5.4 开发环境灵活配置


**💻 开发环境zone策略**：
```bash
# 开发阶段：使用trusted zone（便于调试）
firewall-cmd --set-default-zone=trusted

# 测试阶段：切换到work zone（模拟生产环境）
firewall-cmd --set-default-zone=work

# 部署阶段：使用public zone（生产环境配置）
firewall-cmd --set-default-zone=public
```

---

## 6. 📋 核心要点总结


### 6.1 必须掌握的基本概念


```
🔸 zone本质：安全边界和规则集合的抽象
🔸 预定义zone：9个不同安全级别的zone
🔸 默认zone：新网卡和规则的默认归属
🔸 活动zone：当前正在使用的zone
🔸 zone分配：网卡与zone的绑定关系
```

### 6.2 关键命令记忆


**🔧 核心命令总结**：
```bash
# 查看类命令
--get-zones              # 所有zone
--get-active-zones       # 活动zone  
--get-default-zone       # 默认zone

# 管理类命令  
--set-default-zone       # 设置默认
--change-interface       # 分配网卡
--zone=xxx --list-all    # 查看zone详情
```

### 6.3 zone选择指导原则


**🎯 zone选择决策树**：
```
环境类型判断：
├─ 完全可信？ → trusted
├─ 家庭网络？ → home
├─ 办公环境？ → work  
├─ 公共服务？ → dmz
├─ 网关设备？ → external
├─ 普通服务器？ → public
├─ 需要隐藏？ → drop
└─ 明确拒绝？ → block
```

### 6.4 最佳实践建议


**✅ 推荐做法**：
- **规划先行**：根据网络架构规划zone使用
- **最小权限**：选择满足需求的最严格zone
- **文档记录**：记录zone分配和配置理由
- **定期审查**：定期检查zone配置的合理性

**❌ 避免误区**：
- 不要滥用trusted zone
- 不要忽视默认zone的重要性
- 不要混淆zone的安全级别
- 不要忘记应用永久配置

### 6.5 实际应用价值


**🎯 业务场景应用**：
- **网络安全**：建立多层次防护体系
- **环境隔离**：不同环境使用不同安全策略
- **运维管理**：简化防火墙规则管理
- **合规要求**：满足安全合规标准

**🧠 核心记忆口诀**：
```
zone区域分安全，九个预定义要记全
drop最严block拒绝，public默认最常见
home内网work办公，external带伪装
dmz服务trusted全通，internal似home间
查看管理要熟练，安全第一是关键
```

**核心理解**：
- zone是Linux防火墙的核心概念，理解zone就理解了firewall-cmd的精髓
- 不同zone代表不同的信任级别，选择合适的zone是安全配置的第一步
- zone管理是网络安全架构设计的重要组成部分
- 掌握zone概念和命令，是Linux系统管理员的必备技能