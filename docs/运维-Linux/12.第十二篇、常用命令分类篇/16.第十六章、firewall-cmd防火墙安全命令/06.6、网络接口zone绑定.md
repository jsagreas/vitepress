---
title: 6ã€ç½‘ç»œæ¥å£zoneç»‘å®š
---
## ğŸ“š ç›®å½•

1. [ç½‘ç»œæ¥å£zoneç»‘å®šåŸºç¡€](#1-ç½‘ç»œæ¥å£zoneç»‘å®šåŸºç¡€)
2. [æ·»åŠ æ¥å£åˆ°åŒºåŸŸæ“ä½œ](#2-æ·»åŠ æ¥å£åˆ°åŒºåŸŸæ“ä½œ)
3. [ç§»é™¤å’Œè½¬ç§»æ¥å£æ“ä½œ](#3-ç§»é™¤å’Œè½¬ç§»æ¥å£æ“ä½œ)
4. [æ¥å£zoneæŸ¥è¯¢ç®¡ç†](#4-æ¥å£zoneæŸ¥è¯¢ç®¡ç†)
5. [å¤šç½‘å¡zoneåˆ†é…ç­–ç•¥](#5-å¤šç½‘å¡zoneåˆ†é…ç­–ç•¥)
6. [è™šæ‹Ÿæ¥å£zoneè®¾ç½®](#6-è™šæ‹Ÿæ¥å£zoneè®¾ç½®)
7. [æŒä¹…åŒ–é…ç½®ç®¡ç†](#7-æŒä¹…åŒ–é…ç½®ç®¡ç†)
8. [æ¥å£zoneå†²çªå¤„ç†](#8-æ¥å£zoneå†²çªå¤„ç†)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ ç½‘ç»œæ¥å£zoneç»‘å®šåŸºç¡€


### 1.1 ä»€ä¹ˆæ˜¯æ¥å£zoneç»‘å®š


**ç®€å•ç†è§£**ï¼šæŠŠç½‘å¡åˆ†é…ç»™ä¸åŒçš„å®‰å…¨åŒºåŸŸï¼Œå°±åƒç»™ä¸åŒçš„é—¨å®‰è£…ä¸åŒçº§åˆ«çš„é”

```
ç°å®åœºæ™¯ç±»æ¯”ï¼š
åŠå…¬å¤§æ¥¼æœ‰å¤šä¸ªå…¥å£ï¼š
â”œâ”€ å‰é—¨ â†’ è®¿å®¢åŒºåŸŸ(public zone)     - ä¸¥æ ¼æ£€æŸ¥
â”œâ”€ å‘˜å·¥é—¨ â†’ å†…éƒ¨åŒºåŸŸ(internal zone)  - å®½æ¾æ£€æŸ¥  
â””â”€ åé—¨ â†’ ä¿¡ä»»åŒºåŸŸ(trusted zone)    - å‡ ä¹ä¸æ£€æŸ¥

LinuxæœåŠ¡å™¨æœ‰å¤šä¸ªç½‘å¡ï¼š
â”œâ”€ eth0 â†’ public zone     - è¿æ¥äº’è”ç½‘ï¼Œä¸¥æ ¼é˜²æŠ¤
â”œâ”€ eth1 â†’ internal zone   - è¿æ¥å†…ç½‘ï¼Œé€‚ä¸­é˜²æŠ¤
â””â”€ eth2 â†’ trusted zone    - è¿æ¥ç®¡ç†ç½‘ï¼Œæœ€å°é˜²æŠ¤
```

### 1.2 zoneç»‘å®šçš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ”¸ åŸºæœ¬åŸç†**
```
æ¯ä¸ªç½‘ç»œæ¥å£åªèƒ½å±äºä¸€ä¸ªzone
â””â”€ æ¥å£ = ç½‘å¡è®¾å¤‡ï¼ˆå¦‚eth0ã€ens33ç­‰ï¼‰
â””â”€ zone = å®‰å…¨ç­–ç•¥é›†åˆï¼ˆå¦‚publicã€internalç­‰ï¼‰
â””â”€ ç»‘å®š = å°†æ¥å£åˆ†é…ç»™ç‰¹å®šzone
```

**ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦zoneç»‘å®š**
- **åˆ†å±‚é˜²æŠ¤**ï¼šä¸åŒç½‘ç»œä¸åŒå®‰å…¨ç­–ç•¥
- **çµæ´»ç®¡ç†**ï¼šé’ˆå¯¹æ€§çš„é˜²ç«å¢™è§„åˆ™
- **å®‰å…¨éš”ç¦»**ï¼šé¿å…å†…å¤–ç½‘æ··ç”¨ç›¸åŒè§„åˆ™
- **ç®€åŒ–é…ç½®**ï¼šä¸€ä¸ªzoneé…ç½®å¤šä¸ªæ¥å£å…±äº«

### 1.3 zoneç»‘å®šçŠ¶æ€æŸ¥çœ‹


**æŸ¥çœ‹æ‰€æœ‰zoneçš„æ¥å£åˆ†é…**
```bash
# æ˜¾ç¤ºæ‰€æœ‰zoneåŠå…¶ç»‘å®šçš„æ¥å£
firewall-cmd --get-active-zones
```

**è¾“å‡ºç¤ºä¾‹è§£è¯»**
```
public
  interfaces: eth0 eth2
internal  
  interfaces: eth1
```

> ğŸ’¡ **ç†è§£è¾“å‡º**ï¼šeth0å’Œeth2åœ¨publicåŒºåŸŸï¼Œeth1åœ¨internalåŒºåŸŸ

---

## 2. â• æ·»åŠ æ¥å£åˆ°åŒºåŸŸæ“ä½œ


### 2.1 åŸºæœ¬æ·»åŠ å‘½ä»¤


**ğŸ”¸ ä¸´æ—¶æ·»åŠ æ¥å£**
```bash
# å°†eth1æ·»åŠ åˆ°internalåŒºåŸŸï¼ˆé‡å¯å¤±æ•ˆï¼‰
firewall-cmd --zone=internal --add-interface=eth1

# æ·»åŠ æˆåŠŸä¼šæ˜¾ç¤ºï¼šsuccess
```

**ğŸ”¸ æ°¸ä¹…æ·»åŠ æ¥å£**
```bash
# å°†eth1æ°¸ä¹…æ·»åŠ åˆ°internalåŒºåŸŸ
firewall-cmd --permanent --zone=internal --add-interface=eth1

# é‡æ–°åŠ è½½é…ç½®ä½¿å…¶ç”Ÿæ•ˆ
firewall-cmd --reload
```

### 2.2 å®é™…åº”ç”¨åœºæ™¯


**ğŸ¯ åœºæ™¯1ï¼šåŒç½‘å¡æœåŠ¡å™¨é…ç½®**
```bash
# æœåŠ¡å™¨æœ‰ä¸¤ä¸ªç½‘å¡ï¼š
# eth0 - è¿æ¥äº’è”ç½‘ï¼Œéœ€è¦ä¸¥æ ¼é˜²æŠ¤
# eth1 - è¿æ¥å†…ç½‘ï¼Œé€‚åº¦é˜²æŠ¤

# é…ç½®eth0ä¸ºpublic zoneï¼ˆé¢å‘å…¬ç½‘ï¼‰
firewall-cmd --permanent --zone=public --add-interface=eth0

# é…ç½®eth1ä¸ºinternal zoneï¼ˆé¢å‘å†…ç½‘ï¼‰
firewall-cmd --permanent --zone=internal --add-interface=eth1

# åº”ç”¨é…ç½®
firewall-cmd --reload
```

**éªŒè¯é…ç½®ç»“æœ**
```bash
# æŸ¥çœ‹é…ç½®æ˜¯å¦æˆåŠŸ
firewall-cmd --get-active-zones

# é¢„æœŸè¾“å‡ºï¼š
# public
#   interfaces: eth0
# internal
#   interfaces: eth1
```

### 2.3 æ·»åŠ æ¥å£çš„æ³¨æ„äº‹é¡¹


> âš ï¸ **é‡è¦æé†’**ï¼šä¸€ä¸ªæ¥å£åŒæ—¶åªèƒ½å±äºä¸€ä¸ªzone

**å¸¸è§é—®é¢˜å¤„ç†**
```bash
# å¦‚æœæ¥å£å·²åœ¨å…¶ä»–zoneï¼Œä¼šæç¤ºé”™è¯¯
firewall-cmd --zone=public --add-interface=eth1
# é”™è¯¯ï¼šALREADY_ENABLED: 'eth1' already bound to 'internal'

# æ­£ç¡®åšæ³•ï¼šå…ˆç§»é™¤å†æ·»åŠ ï¼Œæˆ–ç›´æ¥è½¬ç§»
```

---

## 3. â– ç§»é™¤å’Œè½¬ç§»æ¥å£æ“ä½œ


### 3.1 ç§»é™¤æ¥å£æ“ä½œ


**ğŸ”¸ ä¸´æ—¶ç§»é™¤æ¥å£**
```bash
# ä»internalåŒºåŸŸç§»é™¤eth1
firewall-cmd --zone=internal --remove-interface=eth1

# æˆåŠŸä¼šæ˜¾ç¤ºï¼šsuccess
# æ³¨æ„ï¼šç§»é™¤åæ¥å£ä¼šå›åˆ°é»˜è®¤zone
```

**ğŸ”¸ æ°¸ä¹…ç§»é™¤æ¥å£**
```bash
# æ°¸ä¹…ä»zoneç§»é™¤æ¥å£
firewall-cmd --permanent --zone=internal --remove-interface=eth1
firewall-cmd --reload
```

### 3.2 æ¥å£åŒºåŸŸè½¬ç§»


**ğŸ”¸ ç›´æ¥è½¬ç§»æ–¹æ³•**
```bash
# å°†eth1ä»å½“å‰zoneè½¬ç§»åˆ°public zone
firewall-cmd --zone=public --change-interface=eth1

# è¿™æ˜¯æœ€ç®€å•çš„è½¬ç§»æ–¹æ³•ï¼Œè‡ªåŠ¨å¤„ç†zoneåˆ‡æ¢
```

**ğŸ”¸ æ°¸ä¹…è½¬ç§»é…ç½®**
```bash
# æ°¸ä¹…è½¬ç§»eth1åˆ°public zone
firewall-cmd --permanent --zone=public --change-interface=eth1
firewall-cmd --reload
```

### 3.3 å®é™…è½¬ç§»åœºæ™¯


**ğŸ¯ åœºæ™¯ï¼šæœåŠ¡å™¨è§’è‰²å˜æ›´**
```bash
# åŸæœ¬eth0åœ¨internal zoneï¼Œç°åœ¨éœ€è¦å¯¹å¤–æä¾›æœåŠ¡
# éœ€è¦è½¬ç§»åˆ°public zone

# æŸ¥çœ‹å½“å‰çŠ¶æ€
firewall-cmd --get-active-zones

# æ‰§è¡Œè½¬ç§»
firewall-cmd --permanent --zone=public --change-interface=eth0
firewall-cmd --reload

# éªŒè¯è½¬ç§»ç»“æœ
firewall-cmd --get-active-zones
```

---

## 4. ğŸ“‹ æ¥å£zoneæŸ¥è¯¢ç®¡ç†


### 4.1 æŸ¥è¯¢å‘½ä»¤æ€»è§ˆ


**ğŸ”¸ æŸ¥çœ‹æŒ‡å®šzoneçš„æ¥å£**
```bash
# æŸ¥çœ‹public zoneç»‘å®šäº†å“ªäº›æ¥å£
firewall-cmd --zone=public --list-interfaces

# è¾“å‡ºç¤ºä¾‹ï¼šeth0 eth2
```

**ğŸ”¸ æŸ¥çœ‹æ¥å£å±äºå“ªä¸ªzone**
```bash
# æŸ¥çœ‹eth0å±äºå“ªä¸ªzone
firewall-cmd --get-zone-of-interface=eth0

# è¾“å‡ºç¤ºä¾‹ï¼špublic
```

**ğŸ”¸ æŸ¥çœ‹æ‰€æœ‰æ´»è·ƒzone**
```bash
# æ˜¾ç¤ºæ‰€æœ‰æœ‰æ¥å£ç»‘å®šçš„zone
firewall-cmd --get-active-zones
```

### 4.2 æŸ¥è¯¢å‘½ä»¤å®ç”¨æŠ€å·§


**ğŸ“Š ç³»ç»Ÿæ¥å£zoneåˆ†å¸ƒæŸ¥çœ‹**
```bash
# ä¸€é”®æŸ¥çœ‹æ‰€æœ‰ç½‘å¡çš„zoneåˆ†é…æƒ…å†µ
for interface in $(ip link show | grep -E '^[0-9]+:' | cut -d: -f2 | tr -d ' '); do
    if [[ $interface != "lo" ]]; then
        zone=$(firewall-cmd --get-zone-of-interface=$interface 2>/dev/null)
        echo "æ¥å£ $interface -> zone: ${zone:-æœªåˆ†é…}"
    fi
done
```

> ğŸ’¡ **è„šæœ¬è¯´æ˜**ï¼šè¿™ä¸ªç®€å•è„šæœ¬å¸®ä½ å¿«é€Ÿäº†è§£ç³»ç»Ÿä¸­æ‰€æœ‰ç½‘å¡çš„zoneåˆ†é…çŠ¶æ€

### 4.3 æŸ¥è¯¢ç»“æœè§£è¯»


**ç†è§£æŸ¥è¯¢è¾“å‡º**
```bash
# å‘½ä»¤ï¼šfirewall-cmd --get-active-zones
# è¾“å‡ºè§£è¯»ï¼š

public
  interfaces: eth0 eth2    â† public zoneåŒ…å«eth0å’Œeth2
  sources: 192.168.1.0/24 â† åŒæ—¶åŒ…å«æºåœ°å€è§„åˆ™

internal
  interfaces: eth1        â† internal zoneåªæœ‰eth1

# ç©ºzoneä¸ä¼šæ˜¾ç¤ºåœ¨æ´»è·ƒåˆ—è¡¨ä¸­
```

---

## 5. ğŸ”— å¤šç½‘å¡zoneåˆ†é…ç­–ç•¥


### 5.1 å¸¸è§å¤šç½‘å¡åœºæ™¯


**ğŸ¢ ä¼ä¸šæœåŠ¡å™¨å…¸å‹é…ç½®**
```
æœåŠ¡å™¨ç½‘å¡å¸ƒå±€ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             LinuxæœåŠ¡å™¨              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ eth0 â”€â”€â”€â†’ äº’è”ç½‘ (public zone)      â”‚
â”‚ eth1 â”€â”€â”€â†’ å†…ç½‘LAN (internal zone)   â”‚  
â”‚ eth2 â”€â”€â”€â†’ ç®¡ç†ç½‘ (trusted zone)     â”‚
â”‚ eth3 â”€â”€â”€â†’ å­˜å‚¨ç½‘ (work zone)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é…ç½®å®ç°**
```bash
# é…ç½®ä¸åŒç½‘å¡åˆ°å¯¹åº”zone
firewall-cmd --permanent --zone=public --add-interface=eth0
firewall-cmd --permanent --zone=internal --add-interface=eth1  
firewall-cmd --permanent --zone=trusted --add-interface=eth2
firewall-cmd --permanent --zone=work --add-interface=eth3

# åº”ç”¨é…ç½®
firewall-cmd --reload
```

### 5.2 zoneåˆ†é…æœ€ä½³å®è·µ


**ğŸ¯ åˆ†é…åŸåˆ™**

| ç½‘ç»œç±»å‹ | **æ¨èzone** | **å®‰å…¨çº§åˆ«** | **å…¸å‹ç”¨é€”** |
|---------|-------------|-------------|-------------|
| `å…¬ç½‘æ¥å£` | **public** | `æœ€ä¸¥æ ¼` | `WebæœåŠ¡ã€é‚®ä»¶æœåŠ¡` |
| `å†…ç½‘æ¥å£` | **internal** | `é€‚ä¸­` | `æ–‡ä»¶å…±äº«ã€å†…éƒ¨åº”ç”¨` |
| `ç®¡ç†æ¥å£` | **trusted** | `æœ€å®½æ¾` | `SSHç®¡ç†ã€ç›‘æ§` |
| `å­˜å‚¨æ¥å£` | **work** | `ä¸­ç­‰` | `æ•°æ®åº“ã€å­˜å‚¨è®¿é—®` |

**é…ç½®éªŒè¯è„šæœ¬**
```bash
#!/bin/bash
# éªŒè¯å¤šç½‘å¡zoneé…ç½®

echo "=== ç½‘å¡Zoneåˆ†é…æ£€æŸ¥ ==="
for zone in public internal trusted work; do
    interfaces=$(firewall-cmd --zone=$zone --list-interfaces)
    if [[ -n "$interfaces" ]]; then
        echo "$zone zone: $interfaces"
    fi
done
```

### 5.3 è´Ÿè½½å‡è¡¡ç¯å¢ƒé…ç½®


**ğŸ”„ åŒç½‘å¡è´Ÿè½½å‡è¡¡åœºæ™¯**
```bash
# ä¸¤ä¸ªå…¬ç½‘æ¥å£åšè´Ÿè½½å‡è¡¡ï¼Œéƒ½è®¾ç½®ä¸ºpublic zone
firewall-cmd --permanent --zone=public --add-interface=eth0
firewall-cmd --permanent --zone=public --add-interface=eth1

# å†…ç½‘ç®¡ç†æ¥å£
firewall-cmd --permanent --zone=internal --add-interface=eth2

firewall-cmd --reload
```

---

## 6. ğŸ”Œ è™šæ‹Ÿæ¥å£zoneè®¾ç½®


### 6.1 è™šæ‹Ÿæ¥å£ç±»å‹ä»‹ç»


**å¸¸è§è™šæ‹Ÿæ¥å£**
```
è™šæ‹Ÿæ¥å£ç±»å‹ï¼š
â”œâ”€ bridgeæ¥å£ (br0, virbr0)     - è™šæ‹Ÿç½‘æ¡¥
â”œâ”€ VLANæ¥å£ (eth0.100)          - VLANæ ‡ç­¾æ¥å£  
â”œâ”€ éš§é“æ¥å£ (tun0, tap0)        - VPNéš§é“
â”œâ”€ Dockeræ¥å£ (docker0)         - å®¹å™¨ç½‘ç»œ
â””â”€ bondæ¥å£ (bond0)             - ç½‘å¡ç»‘å®š
```

### 6.2 bridgeæ¥å£zoneé…ç½®


**ğŸŒ‰ è™šæ‹Ÿæœºç½‘æ¡¥é…ç½®**
```bash
# libvirté»˜è®¤åˆ›å»ºçš„virbr0æ¡¥æ¥å£
# é€šå¸¸ç”¨äºè™šæ‹Ÿæœºå†…ç½‘é€šä¿¡

# å°†virbr0è®¾ç½®ä¸ºinternal zone
firewall-cmd --permanent --zone=internal --add-interface=virbr0

# Docker bridgeæ¥å£é…ç½®
firewall-cmd --permanent --zone=trusted --add-interface=docker0

firewall-cmd --reload
```

> ğŸ’¡ **è§£é‡Š**ï¼šè™šæ‹Ÿæœºç½‘æ¡¥é€šå¸¸ç”¨äºå†…éƒ¨é€šä¿¡ï¼Œè®¾ç½®ä¸ºinternal zoneæ¯”è¾ƒåˆé€‚

### 6.3 VLANæ¥å£zoneé…ç½®


**ğŸ·ï¸ VLANæ¥å£ç®¡ç†**
```bash
# å‡è®¾åˆ›å»ºäº†VLANæ¥å£ eth0.100 (VLAN ID 100)
# è¿™ä¸ªVLANç”¨äºè®¿å®¢ç½‘ç»œ

# é…ç½®VLANæ¥å£åˆ°å¯¹åº”zone
firewall-cmd --permanent --zone=public --add-interface=eth0.100

# æŸ¥çœ‹VLANæ¥å£é…ç½®
firewall-cmd --zone=public --list-interfaces
```

### 6.4 éš§é“æ¥å£zoneè®¾ç½®


**ğŸ” VPNéš§é“æ¥å£é…ç½®**
```bash
# OpenVPNåˆ›å»ºçš„tun0æ¥å£
# é€šå¸¸ç”¨äºè¿œç¨‹è®¿é—®ï¼Œè®¾ç½®ä¸ºinternal zone

firewall-cmd --permanent --zone=internal --add-interface=tun0

# WireGuardæ¥å£ wg0
firewall-cmd --permanent --zone=trusted --add-interface=wg0

firewall-cmd --reload
```

---

## 7. ğŸ’¾ æŒä¹…åŒ–é…ç½®ç®¡ç†


### 7.1 ä¸´æ—¶vsæ°¸ä¹…é…ç½®


**ğŸ”¸ é…ç½®ç±»å‹å¯¹æ¯”**

| é…ç½®ç±»å‹ | **å‘½ä»¤ç‰¹ç‚¹** | **ç”Ÿæ•ˆæ—¶é—´** | **é‡å¯å** | **é€‚ç”¨åœºæ™¯** |
|---------|-------------|-------------|----------|-------------|
| `ä¸´æ—¶é…ç½®` | **æ— --permanent** | `ç«‹å³ç”Ÿæ•ˆ` | `ä¼šä¸¢å¤±` | `æµ‹è¯•éªŒè¯` |
| `æ°¸ä¹…é…ç½®` | **åŠ --permanent** | `éœ€reloadç”Ÿæ•ˆ` | `ä¼šä¿ç•™` | `ç”Ÿäº§ç¯å¢ƒ` |

**å®é™…æ“ä½œç¤ºä¾‹**
```bash
# ä¸´æ—¶é…ç½®ï¼ˆé‡å¯ä¸¢å¤±ï¼‰
firewall-cmd --zone=public --add-interface=eth0

# æ°¸ä¹…é…ç½®ï¼ˆé‡å¯ä¿ç•™ï¼‰  
firewall-cmd --permanent --zone=public --add-interface=eth0
firewall-cmd --reload
```

### 7.2 é…ç½®æ–‡ä»¶ä½ç½®


**ğŸ“ é…ç½®æ–‡ä»¶å­˜å‚¨ç»“æ„**
```
/etc/firewalld/
â”œâ”€ zones/                    â† zoneé…ç½®æ–‡ä»¶ç›®å½•
â”‚  â”œâ”€ public.xml            â† public zoneé…ç½®
â”‚  â”œâ”€ internal.xml          â† internal zoneé…ç½®
â”‚  â””â”€ trusted.xml           â† trusted zoneé…ç½®
â”œâ”€ services/                â† æœåŠ¡é…ç½®ç›®å½•
â””â”€ firewalld.conf           â† ä¸»é…ç½®æ–‡ä»¶
```

**æŸ¥çœ‹é…ç½®æ–‡ä»¶å†…å®¹**
```bash
# æŸ¥çœ‹public zoneçš„é…ç½®æ–‡ä»¶
cat /etc/firewalld/zones/public.xml

# è¾“å‡ºç¤ºä¾‹ï¼ˆåŒ…å«æ¥å£é…ç½®ï¼‰ï¼š
# <zone>
#   <short>Public</short>
#   <interface name="eth0"/>
#   <interface name="eth2"/>
#   <service name="ssh"/>
# </zone>
```

### 7.3 é…ç½®å¤‡ä»½ä¸æ¢å¤


**ğŸ”„ é…ç½®å¤‡ä»½ç­–ç•¥**
```bash
# å¤‡ä»½firewalldé…ç½®
cp -r /etc/firewalld/ /backup/firewalld-$(date +%Y%m%d)

# å¤‡ä»½å½“å‰è¿è¡Œé…ç½®
firewall-cmd --list-all-zones > /backup/firewall-config-$(date +%Y%m%d).txt
```

**æ¢å¤é…ç½®æ–¹æ³•**
```bash
# æ¢å¤é…ç½®æ–‡ä»¶
cp -r /backup/firewalld-20250921/ /etc/firewalld/

# é‡å¯firewalldæœåŠ¡
systemctl restart firewalld

# éªŒè¯é…ç½®
firewall-cmd --get-active-zones
```

---

## 8. âš ï¸ æ¥å£zoneå†²çªå¤„ç†


### 8.1 å¸¸è§å†²çªåœºæ™¯


**ğŸ”¸ æ¥å£å·²ç»‘å®šå…¶ä»–zone**
```bash
# å°è¯•æ·»åŠ å·²ç»‘å®šçš„æ¥å£ä¼šæŠ¥é”™
firewall-cmd --zone=public --add-interface=eth1
# é”™è¯¯ï¼šALREADY_ENABLED: 'eth1' already bound to 'internal'
```

**è§£å†³æ–¹æ³•1ï¼šä½¿ç”¨change-interface**
```bash
# ç›´æ¥è½¬ç§»æ¥å£åˆ°æ–°zone
firewall-cmd --zone=public --change-interface=eth1
```

**è§£å†³æ–¹æ³•2ï¼šå…ˆç§»é™¤å†æ·»åŠ **
```bash
# å…ˆä»åŸzoneç§»é™¤
firewall-cmd --zone=internal --remove-interface=eth1
# å†æ·»åŠ åˆ°æ–°zone  
firewall-cmd --zone=public --add-interface=eth1
```

### 8.2 NetworkManagerå†²çª


**ğŸ”¸ NetworkManagerç®¡ç†çš„æ¥å£å†²çª**
```bash
# æœ‰æ—¶NetworkManagerä¼šè‡ªåŠ¨åˆ†é…æ¥å£åˆ°zone
# å¯¼è‡´firewall-cmdé…ç½®å¤±æ•ˆ

# æŸ¥çœ‹NetworkManagerçš„zoneé…ç½®
nmcli connection show
```

**è§£å†³NetworkManagerå†²çª**
```bash
# æ–¹æ³•1ï¼šåœ¨NetworkManagerä¸­è®¾ç½®zone
nmcli connection modify eth0 connection.zone public

# æ–¹æ³•2ï¼šç¦ç”¨NetworkManagerçš„zoneç®¡ç†
# ç¼–è¾‘ /etc/firewalld/firewalld.conf
# AllowZoneDrifting=no
```

### 8.3 é…ç½®ä¸ä¸€è‡´é—®é¢˜


**ğŸ”¸ ä¸´æ—¶é…ç½®ä¸æ°¸ä¹…é…ç½®ä¸ä¸€è‡´**
```bash
# æŸ¥çœ‹è¿è¡Œæ—¶é…ç½®
firewall-cmd --get-active-zones

# æŸ¥çœ‹æ°¸ä¹…é…ç½®  
firewall-cmd --permanent --get-active-zones

# å¦‚æœä¸ä¸€è‡´ï¼Œé‡æ–°åŒæ­¥
firewall-cmd --reload
```

**é…ç½®åŒæ­¥è„šæœ¬**
```bash
#!/bin/bash
# æ£€æŸ¥å¹¶åŒæ­¥firewallé…ç½®

echo "æ£€æŸ¥é…ç½®ä¸€è‡´æ€§..."
if ! firewall-cmd --check-config; then
    echo "é…ç½®æœ‰é”™è¯¯ï¼Œè¯·æ£€æŸ¥"
    exit 1
fi

echo "é‡æ–°åŠ è½½é…ç½®..."
firewall-cmd --reload
echo "é…ç½®åŒæ­¥å®Œæˆ"
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æ¥å£zoneç»‘å®šï¼šå°†ç½‘å¡åˆ†é…ç»™å®‰å…¨åŒºåŸŸï¼Œå®ç°åˆ†å±‚é˜²æŠ¤
ğŸ”¸ ä¸€å¯¹ä¸€å…³ç³»ï¼šæ¯ä¸ªæ¥å£åŒæ—¶åªèƒ½å±äºä¸€ä¸ªzone  
ğŸ”¸ ä¸´æ—¶vsæ°¸ä¹…ï¼šä¸´æ—¶é…ç½®é‡å¯ä¸¢å¤±ï¼Œæ°¸ä¹…é…ç½®éœ€è¦reload
ğŸ”¸ zoneç­–ç•¥ç»§æ‰¿ï¼šæ¥å£ç»‘å®šzoneåï¼Œè‡ªåŠ¨åº”ç”¨è¯¥zoneçš„æ‰€æœ‰è§„åˆ™
```

### 9.2 å…³é”®å‘½ä»¤é€ŸæŸ¥


**ğŸ”¹ åŸºç¡€æ“ä½œå‘½ä»¤**
```bash
# æŸ¥çœ‹æ¥å£zoneåˆ†é…
firewall-cmd --get-active-zones

# æ·»åŠ æ¥å£åˆ°zone
firewall-cmd --zone=public --add-interface=eth0

# ç§»é™¤æ¥å£  
firewall-cmd --zone=public --remove-interface=eth0

# è½¬ç§»æ¥å£
firewall-cmd --zone=internal --change-interface=eth0

# æŸ¥çœ‹zoneçš„æ¥å£
firewall-cmd --zone=public --list-interfaces

# æŸ¥çœ‹æ¥å£å±äºå“ªä¸ªzone
firewall-cmd --get-zone-of-interface=eth0
```

### 9.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ é…ç½®æœ€ä½³å®è·µ**
- **å…¬ç½‘æ¥å£**ï¼šå§‹ç»ˆä½¿ç”¨public zoneï¼Œä¸¥æ ¼é˜²æŠ¤
- **å†…ç½‘æ¥å£**ï¼šä½¿ç”¨internal zoneï¼Œé€‚åº¦å¼€æ”¾
- **ç®¡ç†æ¥å£**ï¼šä½¿ç”¨trusted zoneï¼Œä¾¿äºç®¡ç†
- **è™šæ‹Ÿæ¥å£**ï¼šæ ¹æ®ç”¨é€”é€‰æ‹©åˆé€‚zone

**ğŸ”§ æ•…éšœæ’æŸ¥æ€è·¯**
```
æ¥å£é…ç½®é—®é¢˜æ’æŸ¥æµç¨‹ï¼š
1. ç¡®è®¤æ¥å£æ˜¯å¦å­˜åœ¨ï¼šip link show
2. æŸ¥çœ‹å½“å‰zoneåˆ†é…ï¼šfirewall-cmd --get-active-zones  
3. æ£€æŸ¥é…ç½®ä¸€è‡´æ€§ï¼šå¯¹æ¯”ä¸´æ—¶å’Œæ°¸ä¹…é…ç½®
4. éªŒè¯NetworkManagerå†²çªï¼šnmcli connection show
5. é‡æ–°åŠ è½½é…ç½®ï¼šfirewall-cmd --reload
```

### 9.4 å¸¸è§åº”ç”¨åœºæ™¯


**ğŸ’¼ ä¼ä¸šçº§éƒ¨ç½²å‚è€ƒ**
- **WebæœåŠ¡å™¨**ï¼šeth0(public) + eth1(internalç®¡ç†)
- **æ•°æ®åº“æœåŠ¡å™¨**ï¼šeth0(internal) + eth1(trustedç®¡ç†)  
- **é˜²ç«å¢™ç½‘å…³**ï¼šeth0(publicå¤–ç½‘) + eth1(internalå†…ç½‘) + eth2(dmz)
- **è™šæ‹ŸåŒ–å¹³å°**ï¼šç‰©ç†æ¥å£(public) + è™šæ‹Ÿæ¥å£(internal)

**ğŸ”’ å®‰å…¨é˜²æŠ¤è¦ç‚¹**
- ç®¡ç†æ¥å£ä¸è¦æ”¾åœ¨public zone
- ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨æ°¸ä¹…é…ç½®
- å®šæœŸå¤‡ä»½firewalldé…ç½®æ–‡ä»¶
- å˜æ›´å‰å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯

**æ ¸å¿ƒè®°å¿†**ï¼š
- æ¥å£zoneç»‘å®šå°±æ˜¯ç»™ä¸åŒç½‘å¡åˆ†é…ä¸åŒå®‰å…¨ç­–ç•¥
- ä¸€ä¸ªæ¥å£åªèƒ½å±äºä¸€ä¸ªzoneï¼Œä½†ä¸€ä¸ªzoneå¯ä»¥åŒ…å«å¤šä¸ªæ¥å£
- æ°¸ä¹…é…ç½®éœ€è¦reloadï¼Œä¸´æ—¶é…ç½®ç«‹å³ç”Ÿæ•ˆä½†é‡å¯ä¸¢å¤±
- å¤šç½‘å¡æœåŠ¡å™¨åº”è¯¥æ ¹æ®ç½‘ç»œç”¨é€”åˆ†é…åˆ°ä¸åŒzone