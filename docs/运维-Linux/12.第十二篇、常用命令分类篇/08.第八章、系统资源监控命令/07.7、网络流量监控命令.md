---
title: 7、网络流量监控命令
---
## 📚 目录


1. [网络流量监控概述](#1-网络流量监控概述)
2. [iftop实时网络流量监控](#2-iftop实时网络流量监控)
3. [nethogs按进程网络使用统计](#3-nethogs按进程网络使用统计)
4. [nload网络接口流量显示](#4-nload网络接口流量显示)
5. [网络流量分析技巧](#5-网络流量分析技巧)
6. [网络性能故障诊断](#6-网络性能故障诊断)
7. [核心要点总结](#7-核心要点总结)

---

## 1. 🌐 网络流量监控概述



### 1.1 什么是网络流量监控



**简单理解**：网络流量监控就像是给你的网络装了一个"流量表"，可以实时看到网络上有多少数据在传输，就像看水表一样简单直观。

**核心作用**：
- **流量统计**：看看网络用了多少流量
- **速度监控**：检查网络传输速度快不快
- **异常发现**：找出哪些程序在偷偷占用网络
- **性能优化**：找到网络卡顿的原因

### 1.2 为什么需要网络流量监控



```
日常场景对比：

家庭网络问题：
网速突然变慢 → 不知道哪个设备在下载
视频卡顿     → 不清楚带宽被谁占用了

服务器网络问题：
服务响应慢   → 需要查看网络瓶颈在哪里
流量异常     → 可能有安全问题需要排查
成本控制     → 监控云服务器流量使用情况
```

### 1.3 网络监控的基本概念



**🔸 入站流量（Inbound）**：
- 含义：从外面进入你电脑的数据
- 比如：下载文件、接收邮件、浏览网页

**🔸 出站流量（Outbound）**：
- 含义：从你电脑发送到外面的数据  
- 比如：上传文件、发送邮件、视频通话

**🔸 网络带宽**：
- 含义：网络的"管道粗细"，决定最大传输速度
- 单位：Mbps（兆比特每秒）、KB/s（千字节每秒）

**🔸 网络接口**：
- 含义：网络连接的"接口"，比如网卡、WiFi适配器
- 常见：eth0（有线网卡）、wlan0（无线网卡）

---

## 2. 📊 iftop实时网络流量监控



### 2.1 iftop是什么



**通俗解释**：iftop就像是网络版的"任务管理器"，可以实时显示哪些连接在使用网络，用了多少流量，速度有多快。

**核心特点**：
- ✅ **实时显示**：网络流量变化一目了然
- ✅ **连接详情**：显示具体是谁在和谁通信
- ✅ **流量方向**：清楚看到上传下载情况
- ✅ **历史统计**：显示过去一段时间的平均值

### 2.2 安装iftop



**Ubuntu/Debian系统**：
```bash
sudo apt update
sudo apt install iftop
```

**CentOS/RedHat系统**：
```bash
sudo yum install iftop
# 或者较新版本

sudo dnf install iftop
```

### 2.3 基本使用方法



**🔸 启动iftop**
```bash
# 基本启动（需要root权限）

sudo iftop

# 监控指定网卡

sudo iftop -i eth0

# 不显示端口号，只显示主机

sudo iftop -n
```

### 2.4 iftop界面详解



**界面布局说明**：
```
                    iftop 界面示例
┌─────────────────────────────────────────────────────────────┐
│                    12.5Kb  25.0Kb  37.5Kb  50.0Kb          │
│server.example.com        => client.local     1.52Kb  890b   │
│                          <=                   2.3Kb  1.2Kb  │
│192.168.1.100            => 8.8.8.8           856b    0b     │
│                          <=                   1.2Kb  445b   │
│─────────────────────────────────────────────────────────────│
│Total send rate:     2.4Kb/s                                 │
│Total receive rate:  3.5Kb/s                                 │
│Total send and receive rate: 5.9Kb/s                        │
└─────────────────────────────────────────────────────────────┘

界面说明：
=> 箭头：表示数据发送方向（出站）
<= 箭头：表示数据接收方向（入站）  
右侧数字：当前速率和平均速率
底部统计：总的发送接收速率
```

**🔸 重要列说明**：

| 显示内容 | 含义说明 |
|---------|---------|
| `主机名/IP` | 通信的两端地址 |
| `=>` | 本机发送数据的方向 |
| `<=` | 本机接收数据的方向 |
| `右侧第1列` | 最近2秒的平均速率 |
| `右侧第2列` | 最近10秒的平均速率 |
| `右侧第3列` | 最近40秒的平均速率 |

### 2.5 常用快捷键



**iftop交互式操作**：

| 按键 | 功能说明 |
|------|----------|
| `h` | 显示帮助信息 |
| `n` | 切换显示主机名/IP地址 |
| `s` | 切换显示源地址 |
| `d` | 切换显示目标地址 |
| `t` | 切换显示格式（文本条/数字） |
| `p` | 切换显示端口 |
| `P` | 暂停显示更新 |
| `q` | 退出iftop |

### 2.6 实用参数组合



```bash
# 监控所有连接，显示端口号

sudo iftop -P

# 只显示IP地址，不解析主机名（速度更快）

sudo iftop -n

# 指定监控的网络接口

sudo iftop -i wlan0

# 只显示TCP连接

sudo iftop -f "tcp"

# 过滤特定端口（比如只看HTTP流量）

sudo iftop -f "port 80"
```

**💡 实际应用场景**：
- **排查网速慢**：看看是哪个连接占用了带宽
- **检测异常连接**：发现不明IP的大流量连接
- **监控服务器**：实时查看服务器网络负载情况

---

## 3. 🔍 nethogs按进程网络使用统计



### 3.1 nethogs是什么



**通俗解释**：如果说iftop是看"网络连接"的流量，那nethogs就是看"程序进程"的流量。它能告诉你电脑里哪个软件在偷偷消耗网络流量。

**核心优势**：
- ✅ **按进程分类**：清楚看到每个程序的网络使用情况
- ✅ **进程识别**：显示程序名称和进程ID
- ✅ **实时更新**：网络使用变化实时显示
- ✅ **简单易懂**：界面简洁，一目了然

### 3.2 安装nethogs



```bash
# Ubuntu/Debian

sudo apt install nethogs

# CentOS/RedHat

sudo yum install nethogs
# 或

sudo dnf install nethogs
```

### 3.3 基本使用方法



**🔸 基本启动**
```bash
# 监控默认网卡

sudo nethogs

# 监控指定网卡

sudo nethogs eth0

# 监控多个网卡

sudo nethogs eth0 wlan0
```

### 3.4 nethogs界面详解



**界面示例**：
```
NetHogs version 0.8.5

    PID USER     PROGRAM                      DEV    SENT   RECEIVED
   1234 user     firefox                      eth0   2.351   8.425 KB/sec
   5678 root     /usr/bin/ssh                 eth0   0.485   1.247 KB/sec
   9012 user     /usr/bin/chrome              eth0   1.156   3.892 KB/sec
      ? root     unknown TCP                          0.000   0.034 KB/sec

  TOTAL                                              4.012  13.598 KB/sec

界面说明：
PID：进程ID号
USER：运行该程序的用户
PROGRAM：程序名称或路径
DEV：使用的网络设备
SENT：发送速率（上传）
RECEIVED：接收速率（下载）
TOTAL：总的网络使用率
```

**🔸 各列含义详解**：

| 列名 | 含义说明 |
|------|----------|
| `PID` | 进程识别号，可用于进程管理 |
| `USER` | 运行程序的系统用户名 |
| `PROGRAM` | 程序的名称或完整路径 |
| `DEV` | 使用的网络接口设备 |
| `SENT` | 程序发送数据的速度（上传） |
| `RECEIVED` | 程序接收数据的速度（下载） |

### 3.5 nethogs实用参数



```bash
# 指定刷新间隔（默认1秒）

sudo nethogs -d 5  # 5秒更新一次

# 指定监控设备

sudo nethogs eth0

# 显示更详细的信息

sudo nethogs -v

# 追踪模式（记录到文件）

sudo nethogs -t > network_log.txt
```

### 3.6 实际应用场景



**🎯 排查问题场景**：

```
场景1：网速突然变慢
问题：不知道哪个程序在占用网络
解决：sudo nethogs
结果：发现某个下载程序正在大量占用带宽

场景2：流量费用异常增加
问题：不清楚哪些程序在消耗流量
解决：长期监控各程序的网络使用情况
结果：找到"偷跑流量"的程序

场景3：服务器网络异常
问题：服务器网络负载突然增高
解决：查看是哪个服务进程导致的
结果：定位具体的问题进程
```

**💡 与iftop的区别**：
- **iftop**：看的是"连接"，告诉你数据在哪些主机之间传输
- **nethogs**：看的是"程序"，告诉你哪个软件在使用网络

---

## 4. 📈 nload网络接口流量显示



### 4.1 nload是什么



**通俗解释**：nload就像是网络的"速度表"，用图表的方式实时显示网络接口的流量使用情况，看起来很直观，就像看汽车仪表盘一样简单。

**核心特点**：
- ✅ **图形化显示**：用ASCII字符绘制流量图表
- ✅ **多接口支持**：可以同时监控多个网卡
- ✅ **历史统计**：显示当前、平均、最小、最大值
- ✅ **简洁明了**：界面简单，信息清晰

### 4.2 安装nload



```bash
# Ubuntu/Debian

sudo apt install nload

# CentOS/RedHat

sudo yum install nload
# 或

sudo dnf install nload
```

### 4.3 基本使用方法



```bash
# 监控默认网卡

nload

# 监控指定网卡

nload eth0

# 监控所有网卡

nload -m

# 指定刷新间隔

nload -t 500  # 500毫秒刷新一次
```

### 4.4 nload界面详解



**界面示例**：
```
Device eth0 [192.168.1.100] (1/1):
=====================================

Incoming:
###############                                    Curr: 1.25 MBit/s


########                                           Avg: 856.3 KBit/s


#####                                              Min: 0.00 Bit/s


##                                                 Max: 2.15 MBit/s


                                                    Ttl: 45.2 GByte

Outgoing:
#######                                            Curr: 645.2 KBit/s


####                                               Avg: 423.1 KBit/s


##                                                 Min: 0.00 Bit/s


#                                                  Max: 1.05 MBit/s


                                                    Ttl: 12.8 GByte

界面说明：
Incoming：入站流量（下载）
Outgoing：出站流量（上传）
Curr：当前速度
Avg：平均速度
Min：最小速度
Max：最大速度  
Ttl：总流量
```

**🔸 统计信息详解**：

| 统计项 | 含义说明 |
|--------|----------|
| `Curr` | 当前瞬时速度 |
| `Avg` | 平均传输速度 |
| `Min` | 记录的最小速度 |
| `Max` | 记录的最大速度 |
| `Ttl` | 累计总传输量 |

### 4.5 nload常用快捷键



| 按键 | 功能说明 |
|------|----------|
| `↑/↓` | 切换不同的网络接口 |
| `→/←` | 切换显示时间单位 |
| `r` | 重置统计数据 |
| `s` | 保存当前统计到文件 |
| `q` | 退出nload |

### 4.6 nload高级用法



```bash
# 设置流量单位显示

nload -u M  # 以MB为单位显示
nload -u K  # 以KB为单位显示

# 设置图形显示长度

nload -a 300  # 显示300秒的历史数据

# 同时监控多个接口并保存统计

nload -m -o /tmp/network_stats.txt
```

**💡 实际应用价值**：
- **网络调试**：快速查看网络接口是否正常工作
- **性能监控**：长期观察网络使用模式
- **容量规划**：了解网络带宽需求情况
- **故障排查**：检查网络瓶颈和异常流量

---

## 5. 🔧 网络流量分析技巧



### 5.1 综合使用多个工具



**分层分析思路**：
```
网络问题排查流程：

第1步：整体概览
使用 nload 查看网络接口整体流量情况
→ 判断是否存在流量异常

第2步：连接分析  
使用 iftop 查看具体的网络连接
→ 找出占用带宽的连接来源

第3步：进程定位
使用 nethogs 查看进程网络使用情况
→ 确定是哪个程序造成的问题
```

### 5.2 网络带宽使用率分析



**🔸 带宽使用率计算**：
```
带宽使用率公式：
使用率 = (当前速度 ÷ 总带宽) × 100%

实际例子：
假设网络总带宽：100 Mbps
当前使用速度：25 Mbps  
带宽使用率：25 ÷ 100 × 100% = 25%

健康水平参考：
🟢 < 30%：网络状况良好
🟡 30-70%：网络使用正常
🔴 > 70%：网络可能拥塞
```

### 5.3 流量模式识别



**常见流量模式特征**：

| 流量模式 | 特征描述 | 可能原因 |
|----------|----------|----------|
| **突发大流量** | 短时间内流量急剧增加 | 大文件下载、数据备份 |
| **持续小流量** | 长时间保持稳定小流量 | 正常业务通信、心跳包 |
| **周期性波动** | 有规律的流量变化 | 定时任务、备份计划 |
| **异常连接** | 与陌生IP的大流量通信 | 可能的安全威胁 |

### 5.4 入站出站流量分析



**🔸 流量方向分析技巧**：
```
入站流量异常高：
可能原因：
- 大量下载活动
- 受到网络攻击
- 服务被大量访问

出站流量异常高：
可能原因：
- 大量上传操作
- 数据泄露风险
- 恶意软件外传数据

均衡流量：
通常表现：
- 正常的双向通信
- 视频会议、在线游戏
- 文件同步服务
```

### 5.5 网络连接流向分析



**连接分析要点**：
```
正常连接特征：
✅ 连接已知的服务IP
✅ 使用标准端口（80、443、22等）
✅ 流量大小合理

可疑连接特征：
🚨 连接未知的IP地址
🚨 使用异常端口
🚨 流量异常巨大
🚨 连接时间异常长
```

---

## 6. 🔍 网络性能故障诊断



### 6.1 常见网络性能问题



**🔸 网速慢问题诊断流程**：
```
步骤1：确认问题范围
nload eth0  # 查看整体网络使用情况

步骤2：识别流量占用
iftop -P    # 查看具体连接和端口

步骤3：定位问题进程
nethogs     # 找出占用网络的程序

步骤4：采取相应措施
- 限制或关闭占用网络的程序
- 优化网络配置
- 升级网络带宽
```

### 6.2 网络异常流量识别



**异常流量特征识别**：

> 🚨 **高风险信号**：
> - 与未知IP的大量数据交换
> - 非工作时间的异常网络活动  
> - 某个进程持续大量网络传输
> - 出站流量远超入站流量（可能数据泄露）

**识别方法**：
```bash
# 1. 持续监控异常连接

sudo iftop -P | grep -v ":80\|:443\|:22"

# 2. 查看高流量进程

sudo nethogs | head -10

# 3. 分析流量趋势

nload -t 1000  # 降低刷新频率，便于观察趋势
```

### 6.3 网络性能瓶颈定位



**瓶颈类型和定位方法**：

| 瓶颈类型 | 症状表现 | 定位方法 | 解决思路 |
|----------|----------|----------|----------|
| **带宽瓶颈** | 总流量接近带宽上限 | nload查看使用率 | 升级带宽或限流 |
| **连接数瓶颈** | 连接建立缓慢 | iftop查看连接数 | 优化连接池设置 |
| **应用瓶颈** | 特定程序占用过多 | nethogs定位程序 | 优化应用或限制 |
| **网卡瓶颈** | 硬件处理能力不足 | 查看网卡负载 | 升级硬件设备 |

### 6.4 监控自动化脚本示例



**简单监控脚本**：
```bash
#!/bin/bash

# 网络监控告警脚本


INTERFACE="eth0"
THRESHOLD=80  # 告警阈值（MB/s）

while true; do
#    # 获取当前流量（简化示例）
    RX_BYTES=$(cat /sys/class/net/$INTERFACE/statistics/rx_bytes)
    TX_BYTES=$(cat /sys/class/net/$INTERFACE/statistics/tx_bytes)
    
    sleep 1
    
    RX_BYTES_NEW=$(cat /sys/class/net/$INTERFACE/statistics/rx_bytes)
    TX_BYTES_NEW=$(cat /sys/class/net/$INTERFACE/statistics/tx_bytes)
    
    RX_RATE=$(((RX_BYTES_NEW - RX_BYTES) / 1024 / 1024))
    TX_RATE=$(((TX_BYTES_NEW - TX_BYTES) / 1024 / 1024))
    
    if [ $RX_RATE -gt $THRESHOLD ] || [ $TX_RATE -gt $THRESHOLD ]; then
        echo "网络流量告警: RX=${RX_RATE}MB/s, TX=${TX_RATE}MB/s"
#        # 这里可以添加邮件通知等功能
    fi
done
```

---

## 7. 📋 核心要点总结



### 7.1 必须掌握的核心概念



```
🔸 网络流量监控本质：实时监控网络数据传输情况
🔸 三大核心工具：iftop看连接、nethogs看进程、nload看接口
🔸 流量方向概念：入站（下载）、出站（上传）
🔸 监控层次：接口层 → 连接层 → 进程层
🔸 性能指标：带宽使用率、连接数量、流量模式
```

### 7.2 工具选择指南



**🔹 根据需求选择合适工具**：
```
想看整体网络状况 → 使用 nload
需要分析具体连接 → 使用 iftop  
要找占用网络的程序 → 使用 nethogs

综合诊断建议：
第1步：nload 看概况
第2步：iftop 看连接
第3步：nethogs 看进程
```

**🔹 参数使用技巧**：
```
常用组合：
sudo iftop -P -n    # 显示端口和IP，不解析主机名
sudo nethogs eth0   # 监控指定网卡的进程流量
nload -m -t 1000   # 监控所有接口，1秒刷新
```

### 7.3 实际应用价值



**故障排查场景**：
- **网速变慢**：用nethogs找出占用网络的程序
- **流量异常**：用iftop发现异常连接来源
- **性能监控**：用nload长期观察网络使用模式
- **安全排查**：发现可疑的网络连接和数据传输

**网络优化指导**：
- **容量规划**：基于历史流量数据规划带宽需求
- **性能调优**：识别网络瓶颈并针对性优化
- **成本控制**：监控云服务器流量使用情况
- **预防维护**：提前发现网络性能下降趋势

### 7.4 学习要点回顾



**🔹 概念理解要点**：
```
网络监控 = 流量统计 + 连接分析 + 性能诊断
入站出站 = 下载上传的专业术语
带宽使用率 = 当前速度 ÷ 总带宽容量
```

**🔹 实践操作要点**：
```
基础监控：掌握三个工具的基本用法
进阶分析：学会综合使用多个工具排查问题  
自动化：可以编写简单脚本进行持续监控
```

**🔹 问题诊断思路**：
```
发现问题 → 定位层次 → 分析原因 → 采取措施
（症状）  （工具）  （分析）  （解决）
```

**核心记忆**：
- iftop看连接流向，nethogs查进程占用，nload显示接口状态
- 网络监控三步走：先看整体，再看连接，最后定位进程
- 入站是下载出站是上传，流量异常要警惕安全问题
- 工具组合使用效果好，单独使用有局限性