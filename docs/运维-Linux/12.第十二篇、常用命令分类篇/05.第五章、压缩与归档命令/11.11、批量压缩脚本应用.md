---
title: 11ã€æ‰¹é‡å‹ç¼©è„šæœ¬åº”ç”¨
---
## ğŸ“š ç›®å½•

1. [æ‰¹é‡å‹ç¼©è„šæœ¬åŸºç¡€](#1-æ‰¹é‡å‹ç¼©è„šæœ¬åŸºç¡€)
2. [æŒ‰æ—¥æœŸå½’æ¡£å‹ç¼©](#2-æŒ‰æ—¥æœŸå½’æ¡£å‹ç¼©)
3. [æŒ‰å¤§å°åˆ†ç±»å‹ç¼©](#3-æŒ‰å¤§å°åˆ†ç±»å‹ç¼©)
4. [å®šæ—¶å‹ç¼©ä»»åŠ¡è®¾ç½®](#4-å®šæ—¶å‹ç¼©ä»»åŠ¡è®¾ç½®)
5. [å‹ç¼©ç»“æœéªŒè¯ä¸é”™è¯¯å¤„ç†](#5-å‹ç¼©ç»“æœéªŒè¯ä¸é”™è¯¯å¤„ç†)
6. [æ—¥å¿—è®°å½•ä¸ç›‘æ§ç­–ç•¥](#6-æ—¥å¿—è®°å½•ä¸ç›‘æ§ç­–ç•¥)
7. [è‡ªåŠ¨åŒ–å‹ç¼©æµç¨‹è®¾è®¡](#7-è‡ªåŠ¨åŒ–å‹ç¼©æµç¨‹è®¾è®¡)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ“¦ æ‰¹é‡å‹ç¼©è„šæœ¬åŸºç¡€


### 1.1 ä»€ä¹ˆæ˜¯æ‰¹é‡å‹ç¼©è„šæœ¬


**ğŸ”¸ ç®€å•ç†è§£**ï¼š
æ‰¹é‡å‹ç¼©è„šæœ¬å°±åƒæ˜¯ä¸€ä¸ª**æ™ºèƒ½åŠ©æ‰‹**ï¼Œå¯ä»¥è‡ªåŠ¨å¸®ä½ å¤„ç†å¤§é‡æ–‡ä»¶çš„å‹ç¼©å·¥ä½œã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰100ä¸ªæ–‡ä»¶å¤¹éœ€è¦å‹ç¼©å¤‡ä»½ï¼Œæ‰‹åŠ¨ä¸€ä¸ªä¸ªå¤„ç†ä¼šå¾ˆç´¯ï¼Œè€Œè„šæœ¬å¯ä»¥**ä¸€é”®æå®š**æ‰€æœ‰å·¥ä½œã€‚

**ğŸ¯ ä¸»è¦ç”¨é€”**ï¼š
- **æ—¥å¸¸å¤‡ä»½**ï¼šè‡ªåŠ¨å‹ç¼©é¡¹ç›®æ–‡ä»¶ã€é…ç½®æ–‡ä»¶
- **ç©ºé—´ç®¡ç†**ï¼šå‹ç¼©å¤§æ–‡ä»¶é‡Šæ”¾ç£ç›˜ç©ºé—´  
- **æ•°æ®å½’æ¡£**ï¼šæŒ‰è§„åˆ™æ•´ç†å†å²æ•°æ®
- **å®šæœŸæ¸…ç†**ï¼šè‡ªåŠ¨å¤„ç†æ—¥å¿—æ–‡ä»¶

### 1.2 åŸºç¡€æ‰¹é‡å‹ç¼©è„šæœ¬


**ğŸ“ æœ€ç®€å•çš„æ‰¹é‡å‹ç¼©**ï¼š
```bash
#!/bin/bash
# å‹ç¼©å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å¤¹

for dir in */; do
    if [ -d "$dir" ]; then
        echo "æ­£åœ¨å‹ç¼©: $dir"
        tar -czf "${dir%/}.tar.gz" "$dir"
        echo "å®Œæˆ: ${dir%/}.tar.gz"
    fi
done
```

**ğŸ’¡ è„šæœ¬è§£è¯»**ï¼š
```
for dir in */          â† éå†æ‰€æœ‰æ–‡ä»¶å¤¹
if [ -d "$dir" ]       â† ç¡®è®¤æ˜¯æ–‡ä»¶å¤¹
tar -czf               â† åˆ›å»ºå‹ç¼©åŒ…
${dir%/}               â† å»æ‰æ–‡ä»¶å¤¹åæœ«å°¾çš„/
```

### 1.3 å¢å¼ºç‰ˆæ‰¹é‡å‹ç¼©è„šæœ¬


```bash
#!/bin/bash
# å¢å¼ºç‰ˆæ‰¹é‡å‹ç¼©è„šæœ¬

# åŸºæœ¬é…ç½®
COMPRESSION_TYPE="gz"  # å‹ç¼©æ ¼å¼ï¼šgzã€bz2ã€xz
BACKUP_DIR="./compressed"  # å‹ç¼©æ–‡ä»¶å­˜æ”¾ç›®å½•
DATE=$(date +%Y%m%d_%H%M%S)

# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p "$BACKUP_DIR"

# å‹ç¼©å‡½æ•°
compress_directory() {
    local source_dir="$1"
    local archive_name="$2"
    
    case "$COMPRESSION_TYPE" in
        "gz")
            tar -czf "$BACKUP_DIR/${archive_name}.tar.gz" "$source_dir"
            ;;
        "bz2")  
            tar -cjf "$BACKUP_DIR/${archive_name}.tar.bz2" "$source_dir"
            ;;
        "xz")
            tar -cJf "$BACKUP_DIR/${archive_name}.tar.xz" "$source_dir"
            ;;
    esac
}

# ä¸»å¤„ç†é€»è¾‘
echo "ğŸš€ å¼€å§‹æ‰¹é‡å‹ç¼©ä»»åŠ¡ - $DATE"
count=0

for item in *; do
    if [ -d "$item" ] && [ "$item" != "compressed" ]; then
        echo "ğŸ“¦ å‹ç¼©ä¸­: $item"
        compress_directory "$item" "${item}_${DATE}"
        ((count++))
        echo "âœ… å®Œæˆ: $item"
    fi
done

echo "ğŸ‰ æ‰¹é‡å‹ç¼©å®Œæˆï¼Œå…±å¤„ç† $count ä¸ªç›®å½•"
```

**ğŸ”§ ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
# 1. ä¿å­˜è„šæœ¬ä¸º batch_compress.sh
# 2. æ·»åŠ æ‰§è¡Œæƒé™
chmod +x batch_compress.sh

# 3. è¿è¡Œè„šæœ¬
./batch_compress.sh
```

---

## 2. ğŸ“… æŒ‰æ—¥æœŸå½’æ¡£å‹ç¼©


### 2.1 ä¸ºä»€ä¹ˆéœ€è¦æŒ‰æ—¥æœŸå½’æ¡£


**ğŸ  ç”Ÿæ´»ç±»æ¯”**ï¼š
å°±åƒæ•´ç†å®¶é‡Œçš„ç…§ç‰‡ï¼Œæˆ‘ä»¬é€šå¸¸æŒ‰å¹´ä»½ã€æœˆä»½åˆ†ç±»å­˜æ”¾ã€‚**æŒ‰æ—¥æœŸå½’æ¡£å‹ç¼©**å°±æ˜¯æŠŠæ–‡ä»¶æŒ‰æ—¶é—´åˆ†ç±»æ‰“åŒ…ï¼Œæ–¹ä¾¿ä»¥åæŸ¥æ‰¾å’Œç®¡ç†ã€‚

**ğŸ“Š å®é™…åº”ç”¨åœºæ™¯**ï¼š
- **æ—¥å¿—æ–‡ä»¶**ï¼šæŒ‰å¤©/å‘¨/æœˆå½’æ¡£æ—¥å¿—
- **é¡¹ç›®å¤‡ä»½**ï¼šå®šæœŸä¿å­˜é¡¹ç›®å¿«ç…§
- **æ•°æ®æ¸…ç†**ï¼šå‹ç¼©æ—§æ–‡ä»¶é‡Šæ”¾ç©ºé—´

### 2.2 æŒ‰æ—¥æœŸå½’æ¡£è„šæœ¬å®ç°


```bash
#!/bin/bash
# æŒ‰æ—¥æœŸå½’æ¡£å‹ç¼©è„šæœ¬

# é…ç½®å‚æ•°
SOURCE_DIR="/var/log"           # æºç›®å½•
ARCHIVE_ROOT="/backup/archives" # å½’æ¡£æ ¹ç›®å½•
DAYS_OLD=7                      # å½’æ¡£å‡ å¤©å‰çš„æ–‡ä»¶
DATE_FORMAT="%Y-%m-%d"          # æ—¥æœŸæ ¼å¼

# åˆ›å»ºå½’æ¡£ç›®å½•ç»“æ„
create_archive_structure() {
    local year=$(date +%Y)
    local month=$(date +%m)
    
    mkdir -p "$ARCHIVE_ROOT/$year/$month"
    echo "$ARCHIVE_ROOT/$year/$month"
}

# æŒ‰æ—¥æœŸæŸ¥æ‰¾å¹¶å‹ç¼©æ–‡ä»¶
archive_by_date() {
    local target_date="$1"
    local archive_dir="$2"
    local archive_name="logs_${target_date}.tar.gz"
    
    # æŸ¥æ‰¾æŒ‡å®šæ—¥æœŸçš„æ–‡ä»¶
    local files_to_archive=$(find "$SOURCE_DIR" -type f -newermt "$target_date" ! -newermt "$target_date + 1 day")
    
    if [ -n "$files_to_archive" ]; then
        echo "ğŸ“¦ å½’æ¡£ $target_date çš„æ–‡ä»¶"
        
        # åˆ›å»ºä¸´æ—¶æ–‡ä»¶åˆ—è¡¨
        local temp_list="/tmp/archive_list_$$.txt"
        echo "$files_to_archive" > "$temp_list"
        
        # å‹ç¼©æ–‡ä»¶
        tar -czf "$archive_dir/$archive_name" -T "$temp_list"
        
        # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
        rm "$temp_list"
        
        echo "âœ… å®Œæˆ: $archive_dir/$archive_name"
        return 0
    else
        echo "âš ï¸  $target_date æ— æ–‡ä»¶éœ€è¦å½’æ¡£"
        return 1
    fi
}

# ä¸»å¤„ç†æµç¨‹
echo "ğŸ—‚ï¸  å¼€å§‹æŒ‰æ—¥æœŸå½’æ¡£å‹ç¼©"

# è®¡ç®—ç›®æ ‡æ—¥æœŸ
target_date=$(date -d "$DAYS_OLD days ago" +$DATE_FORMAT)
archive_dir=$(create_archive_structure)

echo "ğŸ“… å¤„ç†æ—¥æœŸ: $target_date"
echo "ğŸ“ å½’æ¡£ç›®å½•: $archive_dir"

if archive_by_date "$target_date" "$archive_dir"; then
    echo "ğŸ‰ æ—¥æœŸå½’æ¡£å®Œæˆ"
else
    echo "âŒ å½’æ¡£å¤±è´¥æˆ–æ— æ–‡ä»¶å¤„ç†"
fi
```

### 2.3 çµæ´»çš„æ—¥æœŸå½’æ¡£ç­–ç•¥


**ğŸ“‹ å¤šç§å½’æ¡£ç­–ç•¥å¯¹æ¯”**ï¼š

| ç­–ç•¥ç±»å‹ | **é€‚ç”¨åœºæ™¯** | **ä¼˜åŠ¿** | **åŠ£åŠ¿** |
|---------|-------------|----------|----------|
| ğŸ”¸ **æŒ‰å¤©å½’æ¡£** | `æ—¥å¿—æ–‡ä»¶ã€ä¸´æ—¶æ–‡ä»¶` | `ç²¾ç¡®æ§åˆ¶ï¼Œä¾¿äºæŸ¥æ‰¾` | `æ–‡ä»¶æ•°é‡å¤š` |
| ğŸ”¸ **æŒ‰å‘¨å½’æ¡£** | `ä¸­ç­‰é¢‘ç‡çš„æ•°æ®` | `å¹³è¡¡å­˜å‚¨å’Œç®¡ç†` | `æŸ¥æ‰¾ç²’åº¦è¾ƒç²—` |
| ğŸ”¸ **æŒ‰æœˆå½’æ¡£** | `å†å²æ•°æ®ã€æŠ¥è¡¨` | `é•¿æœŸå­˜å‚¨ï¼Œæ–‡ä»¶å°‘` | `å•ä¸ªæ–‡ä»¶è¾ƒå¤§` |

**ğŸ¯ æ™ºèƒ½å½’æ¡£ç­–ç•¥è„šæœ¬**ï¼š
```bash
# æ™ºèƒ½æŒ‰ä¸åŒå‘¨æœŸå½’æ¡£
intelligent_archive() {
    local file_age_days=$(stat -c %Y "$1")
    local current_time=$(date +%s)
    local age_days=$(( (current_time - file_age_days) / 86400 ))
    
    if [ $age_days -le 30 ]; then
        echo "daily"      # 30å¤©å†…æŒ‰å¤©å½’æ¡£
    elif [ $age_days -le 365 ]; then
        echo "weekly"     # 1å¹´å†…æŒ‰å‘¨å½’æ¡£  
    else
        echo "monthly"    # è¶…è¿‡1å¹´æŒ‰æœˆå½’æ¡£
    fi
}
```

---

## 3. ğŸ“ æŒ‰å¤§å°åˆ†ç±»å‹ç¼©


### 3.1 ä¸ºä»€ä¹ˆè¦æŒ‰å¤§å°åˆ†ç±»å‹ç¼©


**ğŸª é©¬æˆå›¢ç±»æ¯”**ï¼š
å°±åƒé©¬æˆå›¢çš„**å¤§è±¡å’Œå°ç‹—ä¸èƒ½ååŒä¸€è¾†è½¦**ï¼Œå¤§æ–‡ä»¶å’Œå°æ–‡ä»¶çš„å¤„ç†ç­–ç•¥ä¹Ÿä¸åŒï¼š
- **å¤§æ–‡ä»¶**ï¼šå•ç‹¬å‹ç¼©ï¼Œé¿å…å†…å­˜ä¸è¶³
- **å°æ–‡ä»¶**ï¼šæ‰“åŒ…å‹ç¼©ï¼Œæé«˜æ•ˆç‡
- **ä¸­ç­‰æ–‡ä»¶**ï¼šåˆ†ç»„å¤„ç†ï¼Œå¹³è¡¡æ€§èƒ½

### 3.2 æ–‡ä»¶å¤§å°åˆ†ç±»è„šæœ¬


```bash
#!/bin/bash
# æŒ‰æ–‡ä»¶å¤§å°åˆ†ç±»å‹ç¼©è„šæœ¬

# å¤§å°é˜ˆå€¼é…ç½®ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰
SMALL_SIZE=$((1024 * 1024))      # 1MBä»¥ä¸‹ä¸ºå°æ–‡ä»¶
LARGE_SIZE=$((100 * 1024 * 1024)) # 100MBä»¥ä¸Šä¸ºå¤§æ–‡ä»¶

# åˆ†ç±»ç›®å½•
SMALL_DIR="small_files"
MEDIUM_DIR="medium_files"  
LARGE_DIR="large_files"

# åˆ›å»ºåˆ†ç±»ç›®å½•
mkdir -p "$SMALL_DIR" "$MEDIUM_DIR" "$LARGE_DIR"

# æ–‡ä»¶åˆ†ç±»å‡½æ•°
classify_file() {
    local file="$1"
    local size=$(stat -c%s "$file")
    
    if [ $size -lt $SMALL_SIZE ]; then
        echo "small"
    elif [ $size -gt $LARGE_SIZE ]; then
        echo "large"  
    else
        echo "medium"
    fi
}

# åˆ†ç±»å¤„ç†æ–‡ä»¶
classify_and_move() {
    echo "ğŸ” æ­£åœ¨åˆ†ææ–‡ä»¶å¤§å°..."
    
    for file in *; do
        if [ -f "$file" ]; then
            category=$(classify_file "$file")
            case $category in
                "small")
                    cp "$file" "$SMALL_DIR/"
                    ;;
                "medium")
                    cp "$file" "$MEDIUM_DIR/"
                    ;;
                "large")
                    cp "$file" "$LARGE_DIR/"
                    ;;
            esac
        fi
    done
}

# æŒ‰ç±»åˆ«å‹ç¼©
compress_by_category() {
    echo "ğŸ“¦ å¼€å§‹åˆ†ç±»å‹ç¼©..."
    
    # å°æ–‡ä»¶ï¼šæ‰“åŒ…æˆä¸€ä¸ªå‹ç¼©åŒ…
    if [ "$(ls -A $SMALL_DIR)" ]; then
        echo "ğŸ—œï¸  å‹ç¼©å°æ–‡ä»¶..."
        tar -czf "small_files_$(date +%Y%m%d).tar.gz" "$SMALL_DIR"/*
    fi
    
    # ä¸­ç­‰æ–‡ä»¶ï¼šåˆ†ç»„å‹ç¼©
    if [ "$(ls -A $MEDIUM_DIR)" ]; then
        echo "ğŸ“¦ å‹ç¼©ä¸­ç­‰æ–‡ä»¶..."
        tar -czf "medium_files_$(date +%Y%m%d).tar.gz" "$MEDIUM_DIR"/*
    fi
    
    # å¤§æ–‡ä»¶ï¼šå•ç‹¬å‹ç¼©
    if [ "$(ls -A $LARGE_DIR)" ]; then
        echo "ğŸ—ï¸  å•ç‹¬å‹ç¼©å¤§æ–‡ä»¶..."
        for file in "$LARGE_DIR"/*; do
            if [ -f "$file" ]; then
                gzip -c "$file" > "${file}.gz"
                echo "âœ… å®Œæˆ: $(basename "$file").gz"
            fi
        done
    fi
}

# æ‰§è¡Œåˆ†ç±»å‹ç¼©
classify_and_move
compress_by_category
echo "ğŸ‰ æŒ‰å¤§å°åˆ†ç±»å‹ç¼©å®Œæˆï¼"
```

### 3.3 æ™ºèƒ½å‹ç¼©ç­–ç•¥


**ğŸ§  å‹ç¼©ç®—æ³•é€‰æ‹©ç­–ç•¥**ï¼š
```
æ–‡ä»¶ç±»å‹åˆ¤æ–­æµç¨‹ï¼š
     æ–‡ä»¶
      â†“
  â”Œâ”€æ–‡æœ¬æ–‡ä»¶ï¼Ÿâ”€â”
  â†“YES        â†“NO
gzipå‹ç¼©    â”Œâ”€å¤šåª’ä½“ï¼Ÿâ”€â”  
(é«˜å‹ç¼©æ¯”)   â†“YES     â†“NO
           å­˜æ¡£æ‰“åŒ…   é€‰æ‹©å¹³è¡¡ç®—æ³•
          (å·²å‹ç¼©)   (é€Ÿåº¦å’Œå‹ç¼©æ¯”)
```

**âš¡ æ™ºèƒ½å‹ç¼©é€‰æ‹©**ï¼š

| æ–‡ä»¶ç±»å‹ | **æ¨èç®—æ³•** | **åŸå› ** | **å‹ç¼©æ¯”** |
|---------|-------------|----------|-----------|
| ğŸ”¸ **æ–‡æœ¬æ–‡ä»¶** | `gzip/xz` | `æ–‡æœ¬é‡å¤æ€§é«˜ï¼Œå‹ç¼©æ•ˆæœå¥½` | `70-90%` |
| ğŸ”¸ **å›¾ç‰‡è§†é¢‘** | `taræ‰“åŒ…` | `å·²ç»å‹ç¼©ï¼Œå†å‹ç¼©æ„ä¹‰ä¸å¤§` | `5-15%` |
| ğŸ”¸ **ç¨‹åºæ–‡ä»¶** | `bzip2` | `å¹³è¡¡å‹ç¼©æ¯”å’Œé€Ÿåº¦` | `40-70%` |
| ğŸ”¸ **æ··åˆæ–‡ä»¶** | `gzip` | `é€šç”¨æ€§å¥½ï¼Œå…¼å®¹æ€§å¼º` | `50-80%` |

---

## 4. â° å®šæ—¶å‹ç¼©ä»»åŠ¡è®¾ç½®


### 4.1 cronå®šæ—¶ä»»åŠ¡åŸºç¡€


**ğŸ•’ ä»€ä¹ˆæ˜¯cron**ï¼š
cronå°±åƒæ˜¯Linuxç³»ç»Ÿçš„**é—¹é’Ÿ**ï¼Œå¯ä»¥åœ¨æŒ‡å®šçš„æ—¶é—´è‡ªåŠ¨æ‰§è¡Œä»»åŠ¡ã€‚æ¯”å¦‚æ¯å¤©å‡Œæ™¨2ç‚¹è‡ªåŠ¨å¤‡ä»½ï¼Œæ¯å‘¨æ—¥æ¸…ç†æ—¥å¿—ç­‰ã€‚

**ğŸ“… cronæ—¶é—´æ ¼å¼è¯´æ˜**ï¼š
```
* * * * * å‘½ä»¤
â”‚ â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€ æ˜ŸæœŸå‡  (0-7ï¼Œ0å’Œ7éƒ½è¡¨ç¤ºå‘¨æ—¥)
â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€ æœˆä»½ (1-12)
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€ æ—¥æœŸ (1-31)  
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€ å°æ—¶ (0-23)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ åˆ†é’Ÿ (0-59)
```

### 4.2 å¸¸ç”¨å®šæ—¶å‹ç¼©ä»»åŠ¡


**ğŸ“‹ å®ç”¨å®šæ—¶ä»»åŠ¡ç¤ºä¾‹**ï¼š

```bash
# ç¼–è¾‘å®šæ—¶ä»»åŠ¡
crontab -e

# æ·»åŠ ä»¥ä¸‹ä»»åŠ¡ï¼š

# æ¯å¤©å‡Œæ™¨2ç‚¹å‹ç¼©æ—¥å¿—
0 2 * * * /home/user/scripts/daily_compress.sh

# æ¯å‘¨æ—¥å‡Œæ™¨3ç‚¹æ¸…ç†å‹ç¼©æ—§æ–‡ä»¶  
0 3 * * 0 /home/user/scripts/weekly_cleanup.sh

# æ¯æœˆ1å·å‡Œæ™¨1ç‚¹å½’æ¡£ä¸Šæœˆæ•°æ®
0 1 1 * * /home/user/scripts/monthly_archive.sh

# æ¯å°æ—¶æ£€æŸ¥ä¸´æ—¶æ–‡ä»¶å¹¶å‹ç¼©å¤§æ–‡ä»¶
0 * * * * /home/user/scripts/hourly_check.sh
```

### 4.3 å®šæ—¶å‹ç¼©è„šæœ¬ç¤ºä¾‹


```bash
#!/bin/bash
# å®šæ—¶æ—¥å¿—å‹ç¼©è„šæœ¬

LOG_DIR="/var/log/myapp"
ARCHIVE_DIR="/backup/logs"
DAYS_TO_KEEP=7

# ç¡®ä¿ç›®å½•å­˜åœ¨
mkdir -p "$ARCHIVE_DIR"

# è®°å½•å¼€å§‹æ—¶é—´
START_TIME=$(date "+%Y-%m-%d %H:%M:%S")
echo "[$START_TIME] å¼€å§‹å®šæ—¶å‹ç¼©ä»»åŠ¡" >> /var/log/compress.log

# æŸ¥æ‰¾éœ€è¦å‹ç¼©çš„æ—¥å¿—æ–‡ä»¶
find "$LOG_DIR" -name "*.log" -mtime +1 -exec bash -c '
    file="$1"
    filename=$(basename "$file")
    archive_name="${filename%.*}_$(date -r "$file" +%Y%m%d).tar.gz"
    
    # å‹ç¼©æ–‡ä»¶
    tar -czf "'$ARCHIVE_DIR'/$archive_name" "$file"
    
    # éªŒè¯å‹ç¼©æˆåŠŸååˆ é™¤åŸæ–‡ä»¶
    if [ -f "'$ARCHIVE_DIR'/$archive_name" ]; then
        rm "$file"
        echo "âœ… å‹ç¼©å®Œæˆ: $archive_name" >> /var/log/compress.log
    else
        echo "âŒ å‹ç¼©å¤±è´¥: $file" >> /var/log/compress.log
    fi
' _ {} \;

# æ¸…ç†è¶…è¿‡ä¿ç•™æœŸçš„å‹ç¼©æ–‡ä»¶
find "$ARCHIVE_DIR" -name "*.tar.gz" -mtime +$DAYS_TO_KEEP -delete

END_TIME=$(date "+%Y-%m-%d %H:%M:%S")
echo "[$END_TIME] å®šæ—¶å‹ç¼©ä»»åŠ¡å®Œæˆ" >> /var/log/compress.log
```

**ğŸ”§ å®šæ—¶ä»»åŠ¡ç®¡ç†æŠ€å·§**ï¼š

> ğŸ’¡ **å®ç”¨å»ºè®®**
>
> **1. é¿å¼€ä¸šåŠ¡é«˜å³°æœŸ**ï¼šé€‰æ‹©å‡Œæ™¨æˆ–ä¸šåŠ¡ä½è°·æ‰§è¡Œ
> **2. é¢„ç•™è¶³å¤Ÿæ—¶é—´**ï¼šå¤§æ–‡ä»¶å‹ç¼©å¯èƒ½å¾ˆè€—æ—¶
> **3. ç›‘æ§ä»»åŠ¡çŠ¶æ€**ï¼šé€šè¿‡æ—¥å¿—ç¡®è®¤ä»»åŠ¡æ­£å¸¸æ‰§è¡Œ
> **4. è®¾ç½®é‚®ä»¶é€šçŸ¥**ï¼šä»»åŠ¡å¤±è´¥æ—¶åŠæ—¶çŸ¥æ™“

---

## 5. âœ… å‹ç¼©ç»“æœéªŒè¯ä¸é”™è¯¯å¤„ç†


### 5.1 ä¸ºä»€ä¹ˆéœ€è¦éªŒè¯å‹ç¼©ç»“æœ


**ğŸ¥ ä½“æ£€ç±»æ¯”**ï¼š
å°±åƒä½“æ£€è¦ç¡®è®¤èº«ä½“å¥åº·ä¸€æ ·ï¼Œå‹ç¼©åä¹Ÿè¦**éªŒè¯æ–‡ä»¶å®Œæ•´æ€§**ã€‚å¦‚æœå‹ç¼©æ–‡ä»¶æŸåäº†ï¼Œç­‰éœ€è¦æ¢å¤æ•°æ®æ—¶å°±éº»çƒ¦äº†ã€‚

**âš ï¸ å¸¸è§å‹ç¼©é—®é¢˜**ï¼š
- **ç£ç›˜ç©ºé—´ä¸è¶³**ï¼šå‹ç¼©è¿‡ç¨‹ä¸­ç£ç›˜æ»¡äº†
- **æƒé™é—®é¢˜**ï¼šæ²¡æœ‰è¯»å–æŸäº›æ–‡ä»¶çš„æƒé™
- **æ–‡ä»¶è¢«å ç”¨**ï¼šæ–‡ä»¶æ­£åœ¨è¢«å…¶ä»–ç¨‹åºä½¿ç”¨
- **å‹ç¼©ç®—æ³•é”™è¯¯**ï¼šé€‰æ‹©äº†ä¸åˆé€‚çš„å‹ç¼©æ–¹å¼

### 5.2 å‹ç¼©ç»“æœéªŒè¯è„šæœ¬


```bash
#!/bin/bash
# å‹ç¼©ç»“æœéªŒè¯è„šæœ¬

verify_compression() {
    local archive_file="$1"
    local original_dir="$2"
    
    echo "ğŸ” éªŒè¯å‹ç¼©æ–‡ä»¶: $archive_file"
    
    # 1. æ£€æŸ¥å‹ç¼©æ–‡ä»¶æ˜¯å¦å­˜åœ¨
    if [ ! -f "$archive_file" ]; then
        echo "âŒ å‹ç¼©æ–‡ä»¶ä¸å­˜åœ¨: $archive_file"
        return 1
    fi
    
    # 2. æ£€æŸ¥å‹ç¼©æ–‡ä»¶å¤§å°
    local archive_size=$(stat -c%s "$archive_file")
    if [ $archive_size -eq 0 ]; then
        echo "âŒ å‹ç¼©æ–‡ä»¶ä¸ºç©º: $archive_file"
        return 1
    fi
    
    # 3. æµ‹è¯•å‹ç¼©æ–‡ä»¶å®Œæ•´æ€§
    case "$archive_file" in
        *.tar.gz)
            if tar -tzf "$archive_file" >/dev/null 2>&1; then
                echo "âœ… tar.gz æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥é€šè¿‡"
            else
                echo "âŒ tar.gz æ–‡ä»¶æŸå"
                return 1
            fi
            ;;
        *.zip)
            if unzip -t "$archive_file" >/dev/null 2>&1; then
                echo "âœ… zip æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥é€šè¿‡" 
            else
                echo "âŒ zip æ–‡ä»¶æŸå"
                return 1
            fi
            ;;
        *.gz)
            if gzip -t "$archive_file" 2>/dev/null; then
                echo "âœ… gzip æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥é€šè¿‡"
            else
                echo "âŒ gzip æ–‡ä»¶æŸå"
                return 1
            fi
            ;;
    esac
    
    # 4. è®¡ç®—å‹ç¼©æ¯”
    if [ -d "$original_dir" ]; then
        local original_size=$(du -sb "$original_dir" | cut -f1)
        local compression_ratio=$((100 - (archive_size * 100 / original_size)))
        echo "ğŸ“Š å‹ç¼©æ¯”: ${compression_ratio}%"
        echo "ğŸ“ åŸå§‹å¤§å°: $(numfmt --to=iec $original_size)"
        echo "ğŸ“¦ å‹ç¼©å¤§å°: $(numfmt --to=iec $archive_size)"
    fi
    
    return 0
}

# ä½¿ç”¨ç¤ºä¾‹
# verify_compression "backup.tar.gz" "/path/to/original"
```

### 5.3 é”™è¯¯å¤„ç†æœºåˆ¶


```bash
#!/bin/bash
# å¸¦é”™è¯¯å¤„ç†çš„æ‰¹é‡å‹ç¼©è„šæœ¬

# é”™è¯¯å¤„ç†é…ç½®
ERROR_LOG="/var/log/compression_errors.log"
MAX_RETRIES=3
RETRY_DELAY=5

# é”™è¯¯è®°å½•å‡½æ•°
log_error() {
    local message="$1"
    local timestamp=$(date "+%Y-%m-%d %H:%M:%S")
    echo "[$timestamp] ERROR: $message" >> "$ERROR_LOG"
}

# å¸¦é‡è¯•çš„å‹ç¼©å‡½æ•°
compress_with_retry() {
    local source="$1"
    local target="$2"
    local retry_count=0
    
    while [ $retry_count -lt $MAX_RETRIES ]; do
        echo "ğŸ”„ å°è¯•å‹ç¼© ($((retry_count + 1))/$MAX_RETRIES): $source"
        
        # æ‰§è¡Œå‹ç¼©
        if tar -czf "$target" "$source" 2>/dev/null; then
            # éªŒè¯å‹ç¼©ç»“æœ
            if verify_compression "$target" "$source"; then
                echo "âœ… å‹ç¼©æˆåŠŸ: $target"
                return 0
            else
                log_error "å‹ç¼©éªŒè¯å¤±è´¥: $target"
                rm -f "$target"  # åˆ é™¤æŸåçš„å‹ç¼©æ–‡ä»¶
            fi
        else
            log_error "å‹ç¼©å‘½ä»¤æ‰§è¡Œå¤±è´¥: $source -> $target"
        fi
        
        ((retry_count++))
        if [ $retry_count -lt $MAX_RETRIES ]; then
            echo "â³ ç­‰å¾… ${RETRY_DELAY} ç§’åé‡è¯•..."
            sleep $RETRY_DELAY
        fi
    done
    
    log_error "å‹ç¼©æœ€ç»ˆå¤±è´¥ï¼Œå·²è¾¾æœ€å¤§é‡è¯•æ¬¡æ•°: $source"
    return 1
}

# å¥åº·æ£€æŸ¥å‡½æ•°
health_check() {
    echo "ğŸ¥ æ‰§è¡Œç³»ç»Ÿå¥åº·æ£€æŸ¥..."
    
    # æ£€æŸ¥ç£ç›˜ç©ºé—´
    local disk_usage=$(df /tmp | awk 'NR==2 {print $5}' | sed 's/%//')
    if [ $disk_usage -gt 90 ]; then
        log_error "ç£ç›˜ç©ºé—´ä¸è¶³: ${disk_usage}% å·²ä½¿ç”¨"
        echo "âš ï¸  è­¦å‘Šï¼šç£ç›˜ç©ºé—´ä¸è¶³ï¼Œå‹ç¼©å¯èƒ½å¤±è´¥"
        return 1
    fi
    
    # æ£€æŸ¥å†…å­˜ä½¿ç”¨
    local mem_usage=$(free | awk 'NR==2{printf "%.0f", $3*100/$2}')
    if [ $mem_usage -gt 85 ]; then
        echo "âš ï¸  è­¦å‘Šï¼šå†…å­˜ä½¿ç”¨ç‡è¾ƒé«˜ (${mem_usage}%)"
    fi
    
    echo "âœ… ç³»ç»Ÿå¥åº·æ£€æŸ¥é€šè¿‡"
    return 0
}

# ä¸»å¤„ç†æµç¨‹
main() {
    echo "ğŸš€ å¼€å§‹å¸¦é”™è¯¯å¤„ç†çš„æ‰¹é‡å‹ç¼©"
    
    # é¢„æ£€æŸ¥
    if ! health_check; then
        echo "âŒ ç³»ç»Ÿå¥åº·æ£€æŸ¥å¤±è´¥ï¼Œç»ˆæ­¢å‹ç¼©ä»»åŠ¡"
        exit 1
    fi
    
    local success_count=0
    local failure_count=0
    
    # å¤„ç†æ¯ä¸ªç›®å½•
    for dir in */; do
        if [ -d "$dir" ]; then
            local archive_name="${dir%/}_$(date +%Y%m%d_%H%M%S).tar.gz"
            
            if compress_with_retry "$dir" "$archive_name"; then
                ((success_count++))
            else
                ((failure_count++))
            fi
        fi
    done
    
    # è¾“å‡ºç»Ÿè®¡ç»“æœ
    echo ""
    echo "ğŸ“Š å‹ç¼©ä»»åŠ¡å®Œæˆç»Ÿè®¡ï¼š"
    echo "âœ… æˆåŠŸ: $success_count ä¸ª"
    echo "âŒ å¤±è´¥: $failure_count ä¸ª"
    
    if [ $failure_count -gt 0 ]; then
        echo "âš ï¸  è¯·æ£€æŸ¥é”™è¯¯æ—¥å¿—: $ERROR_LOG"
        return 1
    fi
    
    return 0
}

# æ‰§è¡Œä¸»å‡½æ•°
main "$@"
```

---

## 6. ğŸ“‹ æ—¥å¿—è®°å½•ä¸ç›‘æ§ç­–ç•¥


### 6.1 ä¸ºä»€ä¹ˆéœ€è¦è¯¦ç»†çš„æ—¥å¿—è®°å½•


**ğŸ•µï¸ ä¾¦æ¢ç±»æ¯”**ï¼š
æ—¥å¿—å°±åƒæ˜¯**æ¡ˆå‘ç°åœºçš„è¯æ®**ï¼Œå¯ä»¥å¸®æˆ‘ä»¬ï¼š
- **è¿½è¸ªé—®é¢˜**ï¼šä»€ä¹ˆæ—¶å€™å‡ºé”™äº†ï¼Ÿ
- **åˆ†æåŸå› **ï¼šä¸ºä»€ä¹ˆä¼šå¤±è´¥ï¼Ÿ
- **ä¼˜åŒ–æ€§èƒ½**ï¼šå“ªäº›æ“ä½œæ¯”è¾ƒæ…¢ï¼Ÿ
- **åˆ¶å®šç­–ç•¥**ï¼šä»€ä¹ˆæ—¶å€™å‹ç¼©æ•ˆç‡æœ€é«˜ï¼Ÿ

### 6.2 å®Œå–„çš„æ—¥å¿—è®°å½•ç³»ç»Ÿ


```bash
#!/bin/bash
# å®Œå–„çš„æ—¥å¿—è®°å½•ç³»ç»Ÿ

# æ—¥å¿—é…ç½®
LOG_DIR="/var/log/compression"
LOG_FILE="$LOG_DIR/compression.log"
ERROR_LOG="$LOG_DIR/compression_error.log"
PERFORMANCE_LOG="$LOG_DIR/compression_performance.log"

# ç¡®ä¿æ—¥å¿—ç›®å½•å­˜åœ¨
mkdir -p "$LOG_DIR"

# æ—¥å¿—çº§åˆ«å®šä¹‰
readonly LOG_LEVEL_DEBUG=0
readonly LOG_LEVEL_INFO=1
readonly LOG_LEVEL_WARN=2
readonly LOG_LEVEL_ERROR=3

CURRENT_LOG_LEVEL=$LOG_LEVEL_INFO

# é€šç”¨æ—¥å¿—å‡½æ•°
write_log() {
    local level="$1"
    local message="$2"
    local timestamp=$(date "+%Y-%m-%d %H:%M:%S")
    local log_entry="[$timestamp] [$level] $message"
    
    # æ ¹æ®çº§åˆ«å†™å…¥ä¸åŒæ—¥å¿—æ–‡ä»¶
    case "$level" in
        "ERROR")
            echo "$log_entry" >> "$ERROR_LOG"
            echo "$log_entry" >> "$LOG_FILE"
            ;;
        "PERFORMANCE")
            echo "$log_entry" >> "$PERFORMANCE_LOG"
            ;;
        *)
            echo "$log_entry" >> "$LOG_FILE"
            ;;
    esac
    
    # åŒæ—¶æ˜¾ç¤ºåœ¨æ§åˆ¶å°
    echo "$log_entry"
}

# å„çº§åˆ«æ—¥å¿—å‡½æ•°
log_debug() { [ $CURRENT_LOG_LEVEL -le $LOG_LEVEL_DEBUG ] && write_log "DEBUG" "$1"; }
log_info() { [ $CURRENT_LOG_LEVEL -le $LOG_LEVEL_INFO ] && write_log "INFO" "$1"; }
log_warn() { [ $CURRENT_LOG_LEVEL -le $LOG_LEVEL_WARN ] && write_log "WARN" "$1"; }
log_error() { write_log "ERROR" "$1"; }
log_performance() { write_log "PERFORMANCE" "$1"; }

# æ€§èƒ½ç›‘æ§å‡½æ•°
monitor_compression() {
    local source="$1"
    local target="$2"
    local start_time=$(date +%s.%N)
    
    # è·å–æºæ–‡ä»¶/ç›®å½•ä¿¡æ¯
    local source_size=$(du -sb "$source" | cut -f1)
    local source_files=$(find "$source" -type f | wc -l)
    
    log_info "å¼€å§‹å‹ç¼©: $source -> $target"
    log_info "æºå¤§å°: $(numfmt --to=iec $source_size), æ–‡ä»¶æ•°: $source_files"
    
    # æ‰§è¡Œå‹ç¼©
    if tar -czf "$target" "$source" 2>/dev/null; then
        local end_time=$(date +%s.%N)
        local duration=$(echo "$end_time - $start_time" | bc)
        local target_size=$(stat -c%s "$target")
        local compression_ratio=$((100 - (target_size * 100 / source_size)))
        local speed=$(echo "scale=2; $source_size / $duration / 1024 / 1024" | bc)
        
        log_info "å‹ç¼©å®Œæˆ: $target"
        log_performance "æ–‡ä»¶: $source, è€—æ—¶: ${duration}s, å‹ç¼©æ¯”: ${compression_ratio}%, é€Ÿåº¦: ${speed}MB/s"
        
        return 0
    else
        local end_time=$(date +%s.%N)
        local duration=$(echo "$end_time - $start_time" | bc)
        log_error "å‹ç¼©å¤±è´¥: $source, è€—æ—¶: ${duration}s"
        return 1
    fi
}
```

### 6.3 æ—¥å¿—åˆ†æå’ŒæŠ¥å‘Šç”Ÿæˆ


```bash
#!/bin/bash  
# æ—¥å¿—åˆ†æå’ŒæŠ¥å‘Šç”Ÿæˆè„šæœ¬

generate_daily_report() {
    local report_date=${1:-$(date +%Y-%m-%d)}
    local report_file="/tmp/compression_report_${report_date}.txt"
    
    echo "ğŸ“Š å‹ç¼©ä»»åŠ¡æ—¥æŠ¥ - $report_date" > "$report_file"
    echo "=" >> "$report_file"
    
    # ç»Ÿè®¡æˆåŠŸå’Œå¤±è´¥æ¬¡æ•°
    local success_count=$(grep "$report_date.*INFO.*å‹ç¼©å®Œæˆ" "$LOG_FILE" | wc -l)
    local failure_count=$(grep "$report_date.*ERROR.*å‹ç¼©å¤±è´¥" "$ERROR_LOG" | wc -l)
    local total_count=$((success_count + failure_count))
    
    echo "" >> "$report_file"
    echo "ğŸ“ˆ åŸºæœ¬ç»Ÿè®¡:" >> "$report_file"
    echo "   æ€»ä»»åŠ¡æ•°: $total_count" >> "$report_file"
    echo "   æˆåŠŸæ•°é‡: $success_count" >> "$report_file"
    echo "   å¤±è´¥æ•°é‡: $failure_count" >> "$report_file"
    
    if [ $total_count -gt 0 ]; then
        local success_rate=$(echo "scale=1; $success_count * 100 / $total_count" | bc)
        echo "   æˆåŠŸç‡: ${success_rate}%" >> "$report_file"
    fi
    
    # æ€§èƒ½ç»Ÿè®¡
    if [ -f "$PERFORMANCE_LOG" ]; then
        echo "" >> "$report_file"
        echo "âš¡ æ€§èƒ½ç»Ÿè®¡:" >> "$report_file"
        
        # å¹³å‡å‹ç¼©æ¯”
        local avg_ratio=$(grep "$report_date.*PERFORMANCE" "$PERFORMANCE_LOG" | \
                         grep -o "å‹ç¼©æ¯”: [0-9]*%" | \
                         sed 's/å‹ç¼©æ¯”: //; s/%//' | \
                         awk '{sum+=$1; count++} END {if(count>0) printf "%.1f", sum/count}')
        
        if [ -n "$avg_ratio" ]; then
            echo "   å¹³å‡å‹ç¼©æ¯”: ${avg_ratio}%" >> "$report_file"
        fi
        
        # å¹³å‡é€Ÿåº¦
        local avg_speed=$(grep "$report_date.*PERFORMANCE" "$PERFORMANCE_LOG" | \
                         grep -o "é€Ÿåº¦: [0-9.]*MB/s" | \
                         sed 's/é€Ÿåº¦: //; s/MB\/s//' | \
                         awk '{sum+=$1; count++} END {if(count>0) printf "%.1f", sum/count}')
        
        if [ -n "$avg_speed" ]; then
            echo "   å¹³å‡é€Ÿåº¦: ${avg_speed}MB/s" >> "$report_file"
        fi
    fi
    
    # é”™è¯¯åˆ†æ
    if [ $failure_count -gt 0 ]; then
        echo "" >> "$report_file"
        echo "âŒ é”™è¯¯åˆ†æ:" >> "$report_file"
        grep "$report_date.*ERROR" "$ERROR_LOG" | tail -5 >> "$report_file"
    fi
    
    echo "" >> "$report_file"
    echo "æŠ¥å‘Šç”Ÿæˆæ—¶é—´: $(date)" >> "$report_file"
    
    # æ˜¾ç¤ºæŠ¥å‘Š
    cat "$report_file"
    
    # å¦‚æœæœ‰é‚®ä»¶å·¥å…·ï¼Œå¯ä»¥å‘é€æŠ¥å‘Š
    # mail -s "å‹ç¼©ä»»åŠ¡æ—¥æŠ¥ - $report_date" admin@company.com < "$report_file"
}

# æ—¥å¿—è½®è½¬å‡½æ•°
rotate_logs() {
    local max_size=10485760  # 10MB
    
    for log_file in "$LOG_FILE" "$ERROR_LOG" "$PERFORMANCE_LOG"; do
        if [ -f "$log_file" ]; then
            local file_size=$(stat -c%s "$log_file")
            if [ $file_size -gt $max_size ]; then
                log_info "è½®è½¬æ—¥å¿—æ–‡ä»¶: $log_file"
                mv "$log_file" "${log_file}.old"
                touch "$log_file"
                
                # ä¿ç•™æœ€è¿‘5ä¸ªè½®è½¬æ–‡ä»¶
                find "$(dirname "$log_file")" -name "$(basename "$log_file").old*" | \
                sort -r | tail -n +6 | xargs rm -f
            fi
        fi
    done
}

# ä½¿ç”¨ç¤ºä¾‹
# generate_daily_report "2025-09-18"
# rotate_logs
```

---

## 7. ğŸ”„ è‡ªåŠ¨åŒ–å‹ç¼©æµç¨‹è®¾è®¡


### 7.1 å®Œæ•´çš„è‡ªåŠ¨åŒ–æµç¨‹æ¶æ„


**ğŸ­ å·¥å‚æµæ°´çº¿ç±»æ¯”**ï¼š
è‡ªåŠ¨åŒ–å‹ç¼©æµç¨‹å°±åƒæ˜¯**æ™ºèƒ½å·¥å‚çš„æµæ°´çº¿**ï¼š
- **åŸæ–™æ£€éªŒ**ï¼šæ£€æŸ¥å¾…å‹ç¼©æ–‡ä»¶
- **åˆ†ç±»å¤„ç†**ï¼šæŒ‰è§„åˆ™åˆ†ç±»æ–‡ä»¶
- **è´¨é‡æ§åˆ¶**ï¼šéªŒè¯å‹ç¼©ç»“æœ
- **åŒ…è£…å…¥åº“**ï¼šå½’æ¡£åˆ°æŒ‡å®šä½ç½®
- **ç”Ÿäº§æŠ¥å‘Š**ï¼šç”Ÿæˆå¤„ç†æŠ¥å‘Š

### 7.2 ä¸»æ§åˆ¶è„šæœ¬è®¾è®¡


```bash
#!/bin/bash
# è‡ªåŠ¨åŒ–å‹ç¼©æµç¨‹ä¸»æ§åˆ¶å™¨

# ====================
# é…ç½®åŒºåŸŸ  
# ====================

# åŸºç¡€è·¯å¾„é…ç½®
readonly BASE_DIR="/opt/compression"
readonly CONFIG_FILE="$BASE_DIR/config/compression.conf"
readonly SCRIPTS_DIR="$BASE_DIR/scripts"
readonly LOGS_DIR="$BASE_DIR/logs"
readonly TEMP_DIR="$BASE_DIR/temp"

# é»˜è®¤é…ç½®
DEFAULT_SOURCE_DIRS="/home/user/documents,/var/log/app"
DEFAULT_ARCHIVE_ROOT="/backup/compressed"
DEFAULT_RETENTION_DAYS="30"
DEFAULT_COMPRESSION_TYPE="gz"

# ====================
# åˆå§‹åŒ–å‡½æ•°
# ====================

init_environment() {
    echo "ğŸ”§ åˆå§‹åŒ–å‹ç¼©ç¯å¢ƒ..."
    
    # åˆ›å»ºå¿…è¦ç›®å½•
    mkdir -p "$BASE_DIR"/{config,scripts,logs,temp}
    mkdir -p "$DEFAULT_ARCHIVE_ROOT"
    
    # åˆ›å»ºé»˜è®¤é…ç½®æ–‡ä»¶
    if [ ! -f "$CONFIG_FILE" ]; then
        cat > "$CONFIG_FILE" << EOF
# è‡ªåŠ¨åŒ–å‹ç¼©é…ç½®æ–‡ä»¶
SOURCE_DIRS="$DEFAULT_SOURCE_DIRS"
ARCHIVE_ROOT="$DEFAULT_ARCHIVE_ROOT"  
RETENTION_DAYS="$DEFAULT_RETENTION_DAYS"
COMPRESSION_TYPE="$DEFAULT_COMPRESSION_TYPE"
MAX_PARALLEL_JOBS="2"
ENABLE_EMAIL_NOTIFICATIONS="false"
ADMIN_EMAIL="admin@company.com"
EOF
    fi
    
    echo "âœ… ç¯å¢ƒåˆå§‹åŒ–å®Œæˆ"
}

# åŠ è½½é…ç½®
load_config() {
    if [ -f "$CONFIG_FILE" ]; then
        source "$CONFIG_FILE"
        echo "ğŸ“‹ é…ç½®å·²åŠ è½½: $CONFIG_FILE"
    else
        echo "âš ï¸  é…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤é…ç½®"
        SOURCE_DIRS="$DEFAULT_SOURCE_DIRS"
        ARCHIVE_ROOT="$DEFAULT_ARCHIVE_ROOT"
        RETENTION_DAYS="$DEFAULT_RETENTION_DAYS"
        COMPRESSION_TYPE="$DEFAULT_COMPRESSION_TYPE"
        MAX_PARALLEL_JOBS="2"
    fi
}

# ====================
# æ ¸å¿ƒå¤„ç†å‡½æ•°
# ====================

# æ–‡ä»¶é¢„å¤„ç†å’Œç­›é€‰
preprocess_files() {
    local source_dir="$1"
    local criteria="$2"
    
    echo "ğŸ” é¢„å¤„ç†ç›®å½•: $source_dir"
    
    # åˆ›å»ºä¸´æ—¶æ–‡ä»¶åˆ—è¡¨
    local temp_list="$TEMP_DIR/files_$(date +%s).list"
    
    case "$criteria" in
        "by_age")
            # æŸ¥æ‰¾7å¤©å‰çš„æ–‡ä»¶
            find "$source_dir" -type f -mtime +7 > "$temp_list"
            ;;
        "by_size")
            # æŸ¥æ‰¾å¤§äº100MBçš„æ–‡ä»¶
            find "$source_dir" -type f -size +100M > "$temp_list"
            ;;
        "by_type")
            # æŸ¥æ‰¾æ—¥å¿—æ–‡ä»¶
            find "$source_dir" -type f -name "*.log" -o -name "*.log.*" > "$temp_list"
            ;;
        *)
            # é»˜è®¤å¤„ç†æ‰€æœ‰æ–‡ä»¶
            find "$source_dir" -type f > "$temp_list"
            ;;
    esac
    
    local file_count=$(wc -l < "$temp_list")
    echo "ğŸ“Š æ‰¾åˆ° $file_count ä¸ªå¾…å¤„ç†æ–‡ä»¶"
    
    echo "$temp_list"
}

# æ™ºèƒ½å‹ç¼©ç­–ç•¥é€‰æ‹©
select_compression_strategy() {
    local file_list="$1"
    local total_size=0
    local file_count=0
    
    # è®¡ç®—æ€»å¤§å°å’Œæ–‡ä»¶æ•°
    while IFS= read -r file; do
        if [ -f "$file" ]; then
            local size=$(stat -c%s "$file")
            total_size=$((total_size + size))
            ((file_count++))
        fi
    done < "$file_list"
    
    # ç­–ç•¥é€‰æ‹©é€»è¾‘
    if [ $file_count -gt 1000 ] || [ $total_size -gt $((1024*1024*1024)) ]; then
        echo "parallel"  # å¹¶è¡Œå¤„ç†
    elif [ $file_count -gt 100 ]; then
        echo "batch"     # æ‰¹é‡å¤„ç†
    else
        echo "single"    # å•ä¸ªå¤„ç†
    fi
}

# å¹¶è¡Œå‹ç¼©å¤„ç†
parallel_compress() {
    local file_list="$1"
    local output_prefix="$2"
    
    echo "ğŸš€ å¯åŠ¨å¹¶è¡Œå‹ç¼©å¤„ç†..."
    
    # åˆ†å‰²æ–‡ä»¶åˆ—è¡¨
    local lines_per_job=$(($(wc -l < "$file_list") / MAX_PARALLEL_JOBS + 1))
    split -l $lines_per_job "$file_list" "$TEMP_DIR/chunk_"
    
    # å¯åŠ¨å¹¶è¡Œä»»åŠ¡
    local job_pids=()
    local job_count=0
    
    for chunk_file in "$TEMP_DIR"/chunk_*; do
        if [ -f "$chunk_file" ]; then
            {
                local chunk_name=$(basename "$chunk_file")
                local archive_name="${output_prefix}_${chunk_name}_$(date +%Y%m%d_%H%M%S).tar.gz"
                
                echo "ğŸ“¦ å¤„ç†å—: $chunk_name"
                tar -czf "$ARCHIVE_ROOT/$archive_name" -T "$chunk_file"
                
                if [ $? -eq 0 ]; then
                    echo "âœ… å®Œæˆ: $archive_name"
                else
                    echo "âŒ å¤±è´¥: $archive_name"
                fi
                
                # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
                rm "$chunk_file"
                
            } &
            
            job_pids+=($!)
            ((job_count++))
        fi
    done
    
    # ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ
    echo "â³ ç­‰å¾… $job_count ä¸ªå¹¶è¡Œä»»åŠ¡å®Œæˆ..."
    for pid in "${job_pids[@]}"; do
        wait $pid
    done
    
    echo "ğŸ‰ å¹¶è¡Œå‹ç¼©å¤„ç†å®Œæˆ"
}

# å‹ç¼©ç»“æœéªŒè¯å’Œæ¸…ç†
post_process() {
    local archive_pattern="$1"
    
    echo "ğŸ” éªŒè¯å’Œæ¸…ç†å‹ç¼©ç»“æœ..."
    
    local success_count=0
    local failure_count=0
    
    # éªŒè¯æ‰€æœ‰å‹ç¼©æ–‡ä»¶
    for archive in "$ARCHIVE_ROOT"/$archive_pattern; do
        if [ -f "$archive" ]; then
            if tar -tzf "$archive" >/dev/null 2>&1; then
                ((success_count++))
                echo "âœ… éªŒè¯é€šè¿‡: $(basename "$archive")"
            else
                ((failure_count++))
                echo "âŒ éªŒè¯å¤±è´¥: $(basename "$archive")"
                # ç§»åŠ¨æŸåæ–‡ä»¶åˆ°é”™è¯¯ç›®å½•
                mkdir -p "$ARCHIVE_ROOT/corrupted"
                mv "$archive" "$ARCHIVE_ROOT/corrupted/"
            fi
        fi
    done
    
    echo "ğŸ“Š éªŒè¯ç»“æœ: æˆåŠŸ $success_count ä¸ªï¼Œå¤±è´¥ $failure_count ä¸ª"
    
    # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
    rm -f "$TEMP_DIR"/*.list
    rm -f "$TEMP_DIR"/chunk_*
    
    # æ¸…ç†è¿‡æœŸå‹ç¼©æ–‡ä»¶
    find "$ARCHIVE_ROOT" -name "*.tar.gz" -mtime +$RETENTION_DAYS -delete
    
    return $failure_count
}

# ====================
# ä¸»æµç¨‹æ§åˆ¶
# ====================

main() {
    echo "ğŸ¯ å¼€å§‹è‡ªåŠ¨åŒ–å‹ç¼©æµç¨‹"
    local start_time=$(date +%s)
    
    # åˆå§‹åŒ–
    init_environment
    load_config
    
    # å¤„ç†çŠ¶æ€ç»Ÿè®¡
    local total_processed=0
    local total_success=0
    local total_failures=0
    
    # å¤„ç†æ¯ä¸ªæºç›®å½•
    IFS=',' read -ra SOURCE_ARRAY <<< "$SOURCE_DIRS"
    for source_dir in "${SOURCE_ARRAY[@]}"; do
        source_dir=$(echo "$source_dir" | xargs)  # å»é™¤ç©ºæ ¼
        
        if [ ! -d "$source_dir" ]; then
            echo "âš ï¸  ç›®å½•ä¸å­˜åœ¨: $source_dir"
            continue
        fi
        
        echo ""
        echo "ğŸ—‚ï¸  å¤„ç†ç›®å½•: $source_dir"
        
        # é¢„å¤„ç†æ–‡ä»¶
        local file_list=$(preprocess_files "$source_dir" "by_age")
        local file_count=$(wc -l < "$file_list")
        
        if [ $file_count -eq 0 ]; then
            echo "â„¹ï¸  æ²¡æœ‰æ–‡ä»¶éœ€è¦å¤„ç†"
            rm -f "$file_list"
            continue
        fi
        
        total_processed=$((total_processed + file_count))
        
        # é€‰æ‹©å‹ç¼©ç­–ç•¥
        local strategy=$(select_compression_strategy "$file_list")
        echo "ğŸ“‹ å‹ç¼©ç­–ç•¥: $strategy"
        
        # æ‰§è¡Œå‹ç¼©
        local output_prefix="$(basename "$source_dir")_archive"
        
        case "$strategy" in
            "parallel")
                parallel_compress "$file_list" "$output_prefix"
                ;;
            "batch"|"single")
                # ç®€åŒ–çš„æ‰¹é‡å¤„ç†
                local archive_name="${output_prefix}_$(date +%Y%m%d_%H%M%S).tar.gz"
                echo "ğŸ“¦ æ‰¹é‡å‹ç¼©: $archive_name"
                if tar -czf "$ARCHIVE_ROOT/$archive_name" -T "$file_list"; then
                    echo "âœ… æ‰¹é‡å‹ç¼©å®Œæˆ"
                    ((total_success++))
                else
                    echo "âŒ æ‰¹é‡å‹ç¼©å¤±è´¥"
                    ((total_failures++))
                fi
                ;;
        esac
        
        # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
        rm -f "$file_list"
    done
    
    # åå¤„ç†
    local post_failures=$(post_process "*.tar.gz")
    total_failures=$((total_failures + post_failures))
    
    # ç”Ÿæˆæ€»ç»“æŠ¥å‘Š
    local end_time=$(date +%s)
    local duration=$((end_time - start_time))
    
    echo ""
    echo "ğŸ‰ è‡ªåŠ¨åŒ–å‹ç¼©æµç¨‹å®Œæˆ"
    echo "ğŸ“Š å¤„ç†ç»Ÿè®¡:"
    echo "   æ€»è€—æ—¶: ${duration}ç§’"
    echo "   å¤„ç†æ–‡ä»¶: $total_processed ä¸ª"
    echo "   æˆåŠŸ: $total_success ä¸ª"
    echo "   å¤±è´¥: $total_failures ä¸ª"
    
    # é‚®ä»¶é€šçŸ¥ï¼ˆå¦‚æœå¯ç”¨ï¼‰
    if [ "$ENABLE_EMAIL_NOTIFICATIONS" = "true" ] && [ $total_failures -gt 0 ]; then
        echo "ğŸ“§ å‘é€å¤±è´¥é€šçŸ¥é‚®ä»¶..."
        # echo "å‹ç¼©ä»»åŠ¡æœ‰ $total_failures ä¸ªå¤±è´¥" | mail -s "å‹ç¼©ä»»åŠ¡æŠ¥å‘Š" "$ADMIN_EMAIL"
    fi
    
    return $total_failures
}

# æ‰§è¡Œä¸»æµç¨‹
main "$@"
exit $?
```

### 7.3 ç³»ç»Ÿé›†æˆå’Œéƒ¨ç½²


**ğŸ”§ å®Œæ•´éƒ¨ç½²æµç¨‹**ï¼š

```bash
#!/bin/bash
# è‡ªåŠ¨åŒ–å‹ç¼©ç³»ç»Ÿéƒ¨ç½²è„šæœ¬

deploy_compression_system() {
    echo "ğŸš€ éƒ¨ç½²è‡ªåŠ¨åŒ–å‹ç¼©ç³»ç»Ÿ..."
    
    # 1. åˆ›å»ºç³»ç»Ÿç”¨æˆ·
    if ! id -u compression >/dev/null 2>&1; then
        useradd -r -d /opt/compression -s /bin/bash compression
        echo "âœ… åˆ›å»ºç³»ç»Ÿç”¨æˆ·: compression"
    fi
    
    # 2. è®¾ç½®ç›®å½•æƒé™
    chown -R compression:compression /opt/compression
    chmod +x /opt/compression/scripts/*.sh
    
    # 3. å®‰è£…å®šæ—¶ä»»åŠ¡
    cat > /etc/cron.d/auto-compression << 'EOF'
# è‡ªåŠ¨åŒ–å‹ç¼©å®šæ—¶ä»»åŠ¡
0 2 * * * compression /opt/compression/scripts/main_compress.sh
0 6 * * 0 compression /opt/compression/scripts/weekly_cleanup.sh  
0 0 1 * * compression /opt/compression/scripts/monthly_report.sh
EOF
    
    # 4. åˆ›å»ºæ—¥å¿—è½®è½¬é…ç½®
    cat > /etc/logrotate.d/compression << 'EOF'
/opt/compression/logs/*.log {
    daily
    missingok
    rotate 30
    compress
    notifempty
    create 644 compression compression
}
EOF
    
    # 5. åˆ›å»ºsystemdæœåŠ¡ï¼ˆå¯é€‰ï¼‰
    cat > /etc/systemd/system/compression-monitor.service << 'EOF'
[Unit]
Description=Compression System Monitor
After=network.target

[Service]
Type=simple
User=compression
ExecStart=/opt/compression/scripts/monitor.sh
Restart=always
RestartSec=60

[Install]
WantedBy=multi-user.target
EOF
    
    systemctl enable compression-monitor.service
    systemctl start compression-monitor.service
    
    echo "âœ… è‡ªåŠ¨åŒ–å‹ç¼©ç³»ç»Ÿéƒ¨ç½²å®Œæˆ"
}

# æ‰§è¡Œéƒ¨ç½²
deploy_compression_system
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æ‰¹é‡å‹ç¼©è„šæœ¬ï¼šè‡ªåŠ¨åŒ–å¤„ç†å¤§é‡æ–‡ä»¶çš„å‹ç¼©å·¥å…·
ğŸ”¸ æŒ‰æ—¥æœŸå½’æ¡£ï¼šå°†æ–‡ä»¶æŒ‰æ—¶é—´è§„å¾‹åˆ†ç±»å‹ç¼©å­˜å‚¨  
ğŸ”¸ æŒ‰å¤§å°åˆ†ç±»ï¼šæ ¹æ®æ–‡ä»¶å¤§å°é€‰æ‹©ä¸åŒçš„å‹ç¼©ç­–ç•¥
ğŸ”¸ å®šæ—¶ä»»åŠ¡è®¾ç½®ï¼šä½¿ç”¨cronå®ç°å®šæœŸè‡ªåŠ¨å‹ç¼©
ğŸ”¸ ç»“æœéªŒè¯æœºåˆ¶ï¼šç¡®ä¿å‹ç¼©æ–‡ä»¶çš„å®Œæ•´æ€§å’Œå¯ç”¨æ€§
ğŸ”¸ é”™è¯¯å¤„ç†ç­–ç•¥ï¼šé‡è¯•æœºåˆ¶å’Œå¤±è´¥æ¢å¤æ–¹æ¡ˆ
ğŸ”¸ æ—¥å¿—è®°å½•ç³»ç»Ÿï¼šå®Œæ•´è®°å½•å‹ç¼©è¿‡ç¨‹å’Œæ€§èƒ½æŒ‡æ ‡
ğŸ”¸ è‡ªåŠ¨åŒ–æµç¨‹ï¼šç«¯åˆ°ç«¯çš„å‹ç¼©å¤„ç†pipeline
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æ‰¹é‡å‹ç¼©çš„æ ¸å¿ƒæ€æƒ³**
```
æ•ˆç‡ä¼˜åŒ–ï¼š
- æ‰¹é‡å¤„ç†æ¯”å•ä¸ªå¤„ç†æ•ˆç‡æ›´é«˜
- åˆ†ç±»å¤„ç†æ¯”ç»Ÿä¸€å¤„ç†æ›´æ™ºèƒ½
- å¹¶è¡Œå¤„ç†æ¯”ä¸²è¡Œå¤„ç†æ›´å¿«é€Ÿ

èµ„æºå¹³è¡¡ï¼š
- å¤§æ–‡ä»¶å•ç‹¬å¤„ç†ï¼Œé¿å…å†…å­˜ä¸è¶³
- å°æ–‡ä»¶æ‰“åŒ…å¤„ç†ï¼Œæé«˜å‹ç¼©æ¯”
- ç³»ç»Ÿè´Ÿè½½ç›‘æ§ï¼Œé¿å…è¿‡è½½
```

**ğŸ”¹ å®šæ—¶ä»»åŠ¡çš„æœ€ä½³å®è·µ**
```
æ—¶é—´é€‰æ‹©ï¼š
- é¿å¼€ä¸šåŠ¡é«˜å³°æœŸï¼ˆé€šå¸¸é€‰æ‹©å‡Œæ™¨ï¼‰
- è€ƒè™‘ä»»åŠ¡æ‰§è¡Œæ—¶é—´ï¼Œé¢„ç•™ç¼“å†²
- ä¸åŒç±»å‹ä»»åŠ¡é”™å¼€æ—¶é—´

ä»»åŠ¡ç®¡ç†ï¼š
- ç›‘æ§ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€
- è®¾ç½®è¶…æ—¶å’Œå¤±è´¥é‡è¯•
- è®°å½•è¯¦ç»†çš„æ‰§è¡Œæ—¥å¿—
```

**ğŸ”¹ é”™è¯¯å¤„ç†çš„é‡è¦æ€§**
```
é—®é¢˜é¢„é˜²ï¼š
- ç³»ç»Ÿå¥åº·æ£€æŸ¥ï¼ˆç£ç›˜ç©ºé—´ã€å†…å­˜ä½¿ç”¨ï¼‰
- æƒé™éªŒè¯ï¼ˆæ–‡ä»¶è¯»å†™æƒé™ï¼‰
- ä¾èµ–æ£€æŸ¥ï¼ˆå¿…è¦å·¥å…·æ˜¯å¦å­˜åœ¨ï¼‰

æ•…éšœæ¢å¤ï¼š
- é‡è¯•æœºåˆ¶å¤„ç†ä¸´æ—¶æ•…éšœ
- å¤±è´¥å›æ»šä¿æŠ¤åŸå§‹æ•°æ®
- è¯¦ç»†æ—¥å¿—å®šä½é—®é¢˜æ ¹å› 
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ“‹ é€‚ç”¨åœºæ™¯åˆ¤æ–­**ï¼š

| åœºæ™¯ç±»å‹ | **æ¨èæ–¹æ¡ˆ** | **å…³é”®è€ƒè™‘** |
|---------|-------------|-------------|
| ğŸ”¸ **ä¸ªäººæ–‡ä»¶å¤‡ä»½** | `ç®€å•æ‰¹é‡è„šæœ¬` | `æ˜“ç”¨æ€§ï¼Œå¯é æ€§` |
| ğŸ”¸ **æœåŠ¡å™¨æ—¥å¿—å½’æ¡£** | `æŒ‰æ—¥æœŸå½’æ¡£+å®šæ—¶ä»»åŠ¡` | `å­˜å‚¨æ•ˆç‡ï¼ŒæŸ¥æ‰¾ä¾¿åˆ©` |
| ğŸ”¸ **å¤§å‹æ•°æ®ä¸­å¿ƒ** | `å®Œæ•´è‡ªåŠ¨åŒ–æµç¨‹` | `æ€§èƒ½ï¼Œç›‘æ§ï¼Œå®¹é”™` |
| ğŸ”¸ **ä¸´æ—¶æ•°æ®æ¸…ç†** | `æŒ‰å¤§å°åˆ†ç±»è„šæœ¬` | `å¤„ç†é€Ÿåº¦ï¼Œç©ºé—´é‡Šæ”¾` |

**ğŸ¯ éƒ¨ç½²å»ºè®®**ï¼š
```
å¼€å‘é˜¶æ®µï¼š
âœ… ä»ç®€å•è„šæœ¬å¼€å§‹ï¼Œé€æ­¥å¢åŠ åŠŸèƒ½
âœ… å……åˆ†æµ‹è¯•å„ç§è¾¹ç•Œæƒ…å†µ
âœ… å»ºç«‹å®Œå–„çš„æ—¥å¿—è®°å½•

ç”Ÿäº§éƒ¨ç½²ï¼š
âœ… è®¾ç½®ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶
âœ… åˆ¶å®šæ•…éšœåº”æ€¥é¢„æ¡ˆ
âœ… å®šæœŸæ£€æŸ¥å’Œä¼˜åŒ–æ€§èƒ½
```

### 8.4 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


**âš¡ å‹ç¼©æ€§èƒ½ä¼˜åŒ–**ï¼š
```
ç¡¬ä»¶å±‚é¢ï¼š
- SSDå­˜å‚¨æå‡IOæ€§èƒ½
- å……è¶³å†…å­˜é¿å…é¢‘ç¹äº¤æ¢
- å¤šæ ¸CPUæ”¯æŒå¹¶è¡Œå‹ç¼©

è½¯ä»¶å±‚é¢ï¼š
- é€‰æ‹©åˆé€‚çš„å‹ç¼©ç®—æ³•ï¼ˆé€Ÿåº¦vså‹ç¼©æ¯”ï¼‰
- å¹¶è¡Œå¤„ç†å¤§é‡å°æ–‡ä»¶
- é¢„ç­›é€‰é¿å…å¤„ç†ä¸å¿…è¦çš„æ–‡ä»¶

ç³»ç»Ÿå±‚é¢ï¼š
- é¿å…ç³»ç»Ÿç¹å¿™æ—¶æ®µæ‰§è¡Œ
- é™åˆ¶å¹¶å‘ä»»åŠ¡æ•°é‡
- ç›‘æ§ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
```

**ğŸ” ç›‘æ§æŒ‡æ ‡**ï¼š
- **å‹ç¼©æ¯”**ï¼šè¡¡é‡å‹ç¼©æ•ˆæœ
- **å¤„ç†é€Ÿåº¦**ï¼šMB/sï¼Œè¯„ä¼°æ€§èƒ½  
- **æˆåŠŸç‡**ï¼šä»»åŠ¡å®Œæˆç™¾åˆ†æ¯”
- **èµ„æºä½¿ç”¨**ï¼šCPUã€å†…å­˜ã€ç£ç›˜IO
- **é”™è¯¯é¢‘ç‡**ï¼šå¤±è´¥åŸå› åˆ†æ

### 8.5 æ‰©å±•å­¦ä¹ æ–¹å‘


**ğŸ“š è¿›é˜¶ä¸»é¢˜**ï¼š
```
é«˜çº§å‹ç¼©æŠ€æœ¯ï¼š
- å¢é‡å‹ç¼©ï¼ˆåªå‹ç¼©å˜åŒ–éƒ¨åˆ†ï¼‰
- é‡å¤æ•°æ®åˆ é™¤
- åˆ†å¸ƒå¼å‹ç¼©å¤„ç†

ç³»ç»Ÿé›†æˆï¼š
- ä¸å¤‡ä»½ç³»ç»Ÿé›†æˆ
- ä¸ç›‘æ§ç³»ç»Ÿé›†æˆ  
- ä¸äº‘å­˜å‚¨é›†æˆ

è‡ªåŠ¨åŒ–è¿ç»´ï¼š
- åŸºäºæœºå™¨å­¦ä¹ çš„æ™ºèƒ½è°ƒåº¦
- è‡ªé€‚åº”å‹ç¼©ç­–ç•¥
- é¢„æµ‹æ€§ç»´æŠ¤
```

**ğŸ› ï¸ å·¥å…·ç”Ÿæ€**ï¼š
- **7zip**ï¼šé«˜å‹ç¼©æ¯”çš„é€šç”¨å·¥å…·
- **pigz**ï¼šå¹¶è¡ŒåŒ–çš„gzipå®ç°
- **pxz**ï¼šå¹¶è¡ŒåŒ–çš„xzå®ç°
- **rsync**ï¼šå¢é‡åŒæ­¥å·¥å…·
- **duplicity**ï¼šåŠ å¯†å¤‡ä»½å·¥å…·

### 8.6 æœ€ä½³å®è·µæ€»ç»“


**âœ… è®¾è®¡åŸåˆ™**ï¼š
1. **ç®€å•å¯é **ï¼šä¼˜å…ˆä¿è¯åŠŸèƒ½æ­£ç¡®æ€§
2. **æ¨¡å—åŒ–è®¾è®¡**ï¼šä¾¿äºç»´æŠ¤å’Œæ‰©å±•
3. **å®Œå–„æ—¥å¿—**ï¼šå‡ºé—®é¢˜èƒ½å¿«é€Ÿå®šä½
4. **æ¸è¿›ä¼˜åŒ–**ï¼šä»åŸºç¡€åŠŸèƒ½å¼€å§‹é€æ­¥å®Œå–„

**âš ï¸ å¸¸è§é™·é˜±**ï¼š
- å‹ç¼©è¿‡ç¨‹ä¸­ç£ç›˜ç©ºé—´ä¸è¶³
- æƒé™é—®é¢˜å¯¼è‡´æ— æ³•è®¿é—®æ–‡ä»¶
- å¹¶å‘ä»»åŠ¡è¿‡å¤šå¯¼è‡´ç³»ç»Ÿè´Ÿè½½è¿‡é«˜
- æ²¡æœ‰éªŒè¯å‹ç¼©ç»“æœçš„å®Œæ•´æ€§

**ğŸ¯ æ ¸å¿ƒè®°å¿†**ï¼š
- **æ‰¹é‡å‹ç¼©ææ•ˆç‡ï¼Œåˆ†ç±»å¤„ç†æ›´æ™ºèƒ½**
- **å®šæ—¶ä»»åŠ¡è¦è§„åˆ’ï¼Œé”™å¼€é«˜å³°é€‰æ—¶é—´**  
- **é”™è¯¯å¤„ç†å¾ˆé‡è¦ï¼Œé‡è¯•éªŒè¯ä¸èƒ½å°‘**
- **æ—¥å¿—è®°å½•è¦è¯¦ç»†ï¼Œé—®é¢˜å®šä½æœ‰ä¾æ®**
- **è‡ªåŠ¨åŒ–æµç¨‹è¦å®Œæ•´ï¼Œç›‘æ§å‘Šè­¦ä¿ç¨³å®š**