---
title: 3、变量设置与修改命令
---
## 📚 目录

1. [变量基础概念](#1-变量基础概念)
2. [export变量导出与设置](#2-export变量导出与设置)
3. [unset变量删除与清理](#3-unset变量删除与清理)
4. [declare变量属性设置](#4-declare变量属性设置)
5. [readonly只读变量设置](#5-readonly只读变量设置)
6. [临时变量vs永久变量](#6-临时变量vs永久变量)
7. [变量值追加与修改语法](#7-变量值追加与修改语法)
8. [数组变量设置与操作](#8-数组变量设置与操作)
9. [核心要点总结](#9-核心要点总结)

---

## 1. 🔧 变量基础概念


### 1.1 什么是环境变量


**简单理解：环境变量就像系统的"记事本"**
- 存储系统和程序运行需要的重要信息
- 比如：程序安装路径、用户信息、系统设置等
- 就像你手机里的联系人列表，随时可以查看和使用

```
环境变量的作用：
┌─────────────────┐    ┌─────────────────┐
│   用户程序      │───▶│   环境变量      │
│ (需要配置信息)   │    │ (存储配置信息)   │
└─────────────────┘    └─────────────────┘
                              │
                              ▼
                       ┌─────────────────┐
                       │   系统运行      │
                       │ (读取配置执行)   │
                       └─────────────────┘
```

### 1.2 变量的分类


**🔸 本地变量（局部变量）**
- 只在当前Shell会话中有效
- 关闭终端就消失了
- 就像便签纸，临时记录用

**🔸 环境变量（全局变量）**
- 在整个系统中都能使用
- 子进程可以继承父进程的环境变量
- 就像身份证，到哪都能用

### 1.3 变量命名规则


```
✅ 正确的变量名：
MY_PATH          # 大写字母和下划线
user_name        # 小写字母和下划线
PATH123          # 字母和数字组合

❌ 错误的变量名：
123PATH          # 不能以数字开头
MY-PATH          # 不能用连字符
MY PATH          # 不能有空格
```

---

## 2. 🌍 export变量导出与设置


### 2.1 export的作用原理


**简单类比：export就像"公告栏"**
- 把变量从"私人笔记"变成"公共信息"
- 让其他程序也能看到和使用这个变量

```
变量导出过程：
本地变量 ──export──▶ 环境变量 ──继承──▶ 子进程
  (私有)             (公共)           (可使用)
```

### 2.2 export基本用法


**🔸 直接设置并导出**
```bash
export PATH="/usr/local/bin:$PATH"
export JAVA_HOME="/usr/lib/jvm/java-8-openjdk"
```

**🔸 先设置后导出**
```bash
MY_VAR="hello world"    # 设置本地变量
export MY_VAR           # 导出为环境变量
```

**🔸 查看已导出的变量**
```bash
export                  # 显示所有环境变量
export -p               # 格式化显示所有环境变量
```

### 2.3 export实际应用场景


**📁 设置程序路径**
```bash
# 添加自定义程序目录到PATH
export PATH="$HOME/bin:$PATH"
```

**☕ Java开发环境**
```bash
export JAVA_HOME="/opt/java/jdk1.8.0_271"
export PATH="$JAVA_HOME/bin:$PATH"
```

**🐍 Python环境配置**
```bash
export PYTHONPATH="/opt/myproject:$PYTHONPATH"
```

### 2.4 export使用注意事项


> **💡 重要提示：**
> - export设置的变量只在当前会话有效
> - 关闭终端后变量就消失了
> - 需要永久生效要写入配置文件

> **⚠️ 常见错误：**
> ```bash
> # 错误：等号两边有空格
> export PATH = "/usr/bin"
> 
> # 正确：等号两边不能有空格
> export PATH="/usr/bin"
> ```

---

## 3. 🗑️ unset变量删除与清理


### 3.1 unset的作用


**简单理解：unset就像"橡皮擦"**
- 彻底删除不需要的变量
- 释放内存空间
- 清理环境，避免冲突

### 3.2 unset基本语法


```bash
unset 变量名                # 删除指定变量
unset 变量名1 变量名2       # 删除多个变量
```

**🔸 删除普通变量**
```bash
MY_VAR="test"
echo $MY_VAR         # 输出：test
unset MY_VAR
echo $MY_VAR         # 输出：空（变量已删除）
```

**🔸 删除环境变量**
```bash
export TEMP_PATH="/tmp"
unset TEMP_PATH      # 删除环境变量
```

### 3.3 unset实际应用


**🧹 清理临时变量**
```bash
# 脚本结束前清理临时变量
TEMP_DIR="/tmp/myapp"
# ... 使用TEMP_DIR进行操作 ...
unset TEMP_DIR       # 清理临时变量
```

**🔄 重置环境变量**
```bash
# 重置PATH变量（危险操作，需谨慎）
unset PATH
export PATH="/usr/bin:/bin"
```

### 3.4 unset注意事项


> **⚠️ 重要警告：**
> - 不要随意删除系统重要变量如PATH、HOME等
> - 删除PATH会导致命令无法执行
> - 删除前最好备份原值

---

## 4. 📝 declare变量属性设置


### 4.1 declare的强大功能


**简单理解：declare是变量的"属性设置器"**
- 可以设置变量的类型（整数、数组等）
- 可以设置变量的权限（只读、导出等）
- 就像给变量贴上"标签"，说明它的特性

### 4.2 declare常用选项


| 选项 | 说明 | 实际用途 |
|------|------|----------|
| `-i` | 整数类型 | 数学计算 |
| `-r` | 只读属性 | 保护重要变量 |
| `-x` | 导出变量 | 等同于export |
| `-a` | 数组类型 | 存储多个值 |
| `-A` | 关联数组 | 键值对存储 |
| `-p` | 显示属性 | 查看变量信息 |

### 4.3 declare实际应用


**🔢 整数变量**
```bash
declare -i num=10
num=num+5           # 自动进行数学运算
echo $num           # 输出：15
```

**📋 数组变量**
```bash
declare -a colors=("red" "green" "blue")
echo ${colors[0]}   # 输出：red
echo ${colors[@]}   # 输出：red green blue
```

**🔐 只读变量**
```bash
declare -r CONFIG_FILE="/etc/myapp.conf"
CONFIG_FILE="other"  # 报错：只读变量不能修改
```

**🗂️ 关联数组（键值对）**
```bash
declare -A student
student["name"]="张三"
student["age"]="20"
student["major"]="计算机"

echo ${student["name"]}  # 输出：张三
```

### 4.4 查看变量属性


```bash
declare -p MY_VAR       # 查看单个变量属性
declare                 # 查看所有变量和属性
declare -i              # 只查看整数类型变量
declare -r              # 只查看只读变量
```

---

## 5. 🔒 readonly只读变量设置


### 5.1 readonly的保护作用


**简单类比：readonly就像"玻璃罩"**
- 可以看到变量内容，但不能修改
- 保护重要的系统配置不被意外改变
- 一旦设置，只能重启Shell才能解除

### 5.2 readonly基本用法


**🔸 设置只读变量**
```bash
readonly PI=3.14159
readonly USER_HOME="$HOME"
```

**🔸 导出只读环境变量**
```bash
readonly -e CONFIG_PATH="/etc/app"  # 设置并导出
```

**🔸 查看只读变量**
```bash
readonly                # 显示所有只读变量
readonly -p            # 格式化显示
```

### 5.3 readonly实际应用


**⚙️ 保护系统配置**
```bash
readonly SYSTEM_ROOT="/"
readonly LOG_DIR="/var/log/myapp"
readonly MAX_USERS=100
```

**🛡️ 脚本安全设置**
```bash
#!/bin/bash
readonly SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
readonly BACKUP_DIR="/backup"

# 后续代码无法修改这些重要路径
```

### 5.4 readonly vs declare -r


| 比较项 | readonly | declare -r |
|--------|----------|------------|
| **基本功能** | 设置只读 | 设置只读 |
| **导出功能** | 需要配合export | 可以直接导出 |
| **历史兼容** | POSIX标准 | Bash扩展 |
| **推荐使用** | 简单场景 | 复杂场景 |

---

## 6. ⏱️ 临时变量vs永久变量


### 6.1 两种变量的区别


**🕐 临时变量特点：**
- 只在当前Shell会话中存在
- 关闭终端就消失
- 适合测试和临时配置

**💾 永久变量特点：**
- 写入配置文件，重启后仍然存在
- 影响所有新打开的Shell会话
- 适合长期使用的配置

### 6.2 临时变量设置


```bash
# 直接在命令行设置
export TEMP_VAR="临时值"
export PATH="/opt/bin:$PATH"

# 查看设置结果
echo $TEMP_VAR
```

### 6.3 永久变量设置


**🔸 用户级配置文件**

```bash
# 编辑 ~/.bashrc (Ubuntu/Debian)
echo 'export JAVA_HOME="/opt/java"' >> ~/.bashrc
echo 'export PATH="$JAVA_HOME/bin:$PATH"' >> ~/.bashrc

# 编辑 ~/.bash_profile (CentOS/RHEL)
echo 'export PYTHON_PATH="/opt/python"' >> ~/.bash_profile
```

**🔸 系统级配置文件**

```bash
# 全局配置 /etc/environment
echo 'GLOBAL_VAR="系统全局变量"' | sudo tee -a /etc/environment

# 全局profile /etc/profile
echo 'export SYSTEM_PATH="/opt/system"' | sudo tee -a /etc/profile
```

### 6.4 配置文件优先级


```
配置文件加载顺序：
系统级别：/etc/profile → /etc/bash.bashrc
     ↓
用户级别：~/.bash_profile → ~/.bashrc → ~/.profile
     ↓
最终生效：后加载的覆盖先加载的同名变量
```

### 6.5 立即生效配置


```bash
# 重新加载配置文件
source ~/.bashrc       # 或者 . ~/.bashrc
source ~/.bash_profile

# 查看配置是否生效
echo $YOUR_VARIABLE
```

---

## 7. ➕ 变量值追加与修改语法


### 7.1 变量值修改方法


**🔸 直接赋值（覆盖）**
```bash
PATH="/usr/bin"        # 完全替换原值
MY_VAR="新值"          # 覆盖旧值
```

**🔸 追加到末尾**
```bash
PATH="$PATH:/opt/bin"           # 在PATH末尾添加路径
LOG_FILE="$LOG_FILE.backup"     # 在文件名后添加后缀
```

**🔸 添加到开头**
```bash
PATH="/opt/bin:$PATH"           # 在PATH开头添加路径
GREETING="Hello, $USER!"        # 在用户名前加问候
```

### 7.2 路径变量的典型操作


**📁 PATH路径管理**
```bash
# 查看当前PATH
echo $PATH

# 添加新路径到PATH末尾
export PATH="$PATH:/home/user/scripts"

# 添加新路径到PATH开头（优先级更高）
export PATH="/usr/local/bin:$PATH"

# 同时添加多个路径
export PATH="/opt/java/bin:/opt/python/bin:$PATH"
```

**🗂️ 库路径管理**
```bash
# 添加库搜索路径
export LD_LIBRARY_PATH="$LD_LIBRARY_PATH:/usr/local/lib"

# Python模块路径
export PYTHONPATH="$PYTHONPATH:/opt/myproject/lib"
```

### 7.3 字符串变量操作


**✂️ 变量值截取**
```bash
FILE_PATH="/home/user/document.txt"

# 获取文件名
echo ${FILE_PATH##*/}          # 输出：document.txt

# 获取目录路径
echo ${FILE_PATH%/*}           # 输出：/home/user

# 获取文件扩展名
echo ${FILE_PATH##*.}          # 输出：txt
```

**🔄 变量值替换**
```bash
TEXT="hello world hello"

# 替换第一个匹配
echo ${TEXT/hello/hi}          # 输出：hi world hello

# 替换所有匹配
echo ${TEXT//hello/hi}         # 输出：hi world hi
```

### 7.4 数值变量计算


```bash
# 整数运算
NUM=10
NUM=$((NUM + 5))              # NUM现在是15
NUM=$((NUM * 2))              # NUM现在是30

# 使用let命令
let NUM=NUM+10                # NUM现在是40
let NUM++                     # NUM现在是41
```

---

## 8. 📊 数组变量设置与操作


### 8.1 什么是数组变量


**简单理解：数组就像一个"收纳盒"**
- 可以存储多个相关的值
- 每个值都有自己的"编号"（索引）
- 就像书架上的书，每本书都有位置编号

```
数组结构示例：
索引：  0      1       2      3
数组：[apple] [banana] [orange] [grape]
       ↑       ↑        ↑       ↑
      第1个   第2个    第3个   第4个
```

### 8.2 普通数组操作


**🔸 数组创建**
```bash
# 方法1：直接赋值
fruits=("apple" "banana" "orange")

# 方法2：分别赋值
fruits[0]="apple"
fruits[1]="banana" 
fruits[2]="orange"

# 方法3：使用declare
declare -a colors=("red" "green" "blue")
```

**🔸 数组访问**
```bash
echo ${fruits[0]}      # 输出：apple（第一个元素）
echo ${fruits[1]}      # 输出：banana（第二个元素）
echo ${fruits[@]}      # 输出：apple banana orange（所有元素）
echo ${fruits[*]}      # 输出：apple banana orange（所有元素）
```

**🔸 数组信息获取**
```bash
echo ${#fruits[@]}     # 输出：3（数组长度）
echo ${!fruits[@]}     # 输出：0 1 2（所有索引）
```

### 8.3 数组元素操作


**➕ 添加元素**
```bash
fruits=("apple" "banana")
fruits+=("orange")              # 添加一个元素
fruits+=("grape" "pear")        # 添加多个元素
```

**❌ 删除元素**
```bash
unset fruits[1]                 # 删除索引为1的元素
unset fruits                    # 删除整个数组
```

**🔄 修改元素**
```bash
fruits[0]="red_apple"           # 修改第一个元素
```

### 8.4 关联数组（键值对）


**🗃️ 关联数组创建**
```bash
declare -A student
student["name"]="张三"
student["age"]="20"
student["major"]="计算机"
student["score"]="95"
```

**🔍 关联数组访问**
```bash
echo ${student["name"]}         # 输出：张三
echo ${student[@]}              # 输出所有值
echo ${!student[@]}             # 输出所有键
```

**🔄 关联数组遍历**
```bash
# 遍历所有键值对
for key in ${!student[@]}; do
    echo "$key: ${student[$key]}"
done
```

### 8.5 数组实际应用场景


**📁 文件批处理**
```bash
files=("config.txt" "data.csv" "log.txt")
for file in ${files[@]}; do
    if [ -f "$file" ]; then
        echo "处理文件：$file"
        # 在这里添加文件处理逻辑
    fi
done
```

**⚙️ 服务器配置**
```bash
declare -A servers
servers["web"]="192.168.1.10"
servers["db"]="192.168.1.20"
servers["cache"]="192.168.1.30"

# 批量检测服务器状态
for server in ${!servers[@]}; do
    ip=${servers[$server]}
    echo "检测$server服务器($ip)..."
    ping -c 1 $ip > /dev/null && echo "正常" || echo "异常"
done
```

---

## 9. 📋 核心要点总结


### 9.1 必须掌握的核心命令


```
🔸 export：导出环境变量，让其他程序可以使用
🔸 unset：删除不需要的变量，清理环境
🔸 declare：设置变量属性，功能最强大
🔸 readonly：保护重要变量，防止意外修改
```

### 9.2 变量类型对比


| 变量类型 | **生命周期** | **作用范围** | **使用场景** | **设置方法** |
|----------|-------------|-------------|-------------|-------------|
| **本地变量** | 当前会话 | 当前Shell | 临时配置 | `VAR=value` |
| **环境变量** | 当前会话 | 子进程可继承 | 程序配置 | `export VAR=value` |
| **永久变量** | 重启后仍存在 | 所有新会话 | 系统配置 | 写入配置文件 |
| **只读变量** | 当前会话 | 不可修改 | 保护配置 | `readonly VAR=value` |

### 9.3 常用语法速查


**🔧 变量设置**
```bash
VAR="value"              # 本地变量
export VAR="value"       # 环境变量
declare -i NUM=10        # 整数变量
readonly CONFIG="/etc"   # 只读变量
```

**🗑️ 变量删除**
```bash
unset VAR               # 删除变量
unset VAR1 VAR2         # 删除多个变量
```

**📊 数组操作**
```bash
arr=("a" "b" "c")       # 创建数组
echo ${arr[0]}          # 访问元素
echo ${arr[@]}          # 所有元素
echo ${#arr[@]}         # 数组长度
```

### 9.4 实际应用建议


**🎯 最佳实践**
- **临时测试**：使用export直接设置
- **长期使用**：写入~/.bashrc或~/.bash_profile
- **重要配置**：使用readonly保护
- **复杂数据**：使用数组或关联数组

**⚠️ 常见陷阱**
- 等号两边不能有空格：`VAR=value`✅ `VAR = value`❌
- 变量名区分大小写：`PATH`和`path`是不同变量
- unset重要系统变量会导致命令无法使用
- 修改PATH时要包含原有路径：`PATH="$PATH:/new/path"`

**🔍 调试技巧**
```bash
echo $VAR               # 查看变量值
declare -p VAR          # 查看变量属性
env | grep VAR          # 在环境变量中查找
set | grep VAR          # 在所有变量中查找
```

**💡 核心记忆**
- **export**：让变量"公开"，其他程序能用
- **unset**：像橡皮擦，彻底删除变量  
- **declare**：变量的"多功能工具"，设置各种属性
- **readonly**：给变量加"保护罩"，防止修改
- **数组**：像收纳盒，存储多个相关数据

通过掌握这些变量操作命令，你就能灵活管理Linux系统的环境配置，让系统和程序按照你的需要运行！