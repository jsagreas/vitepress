---
title: 3ã€systemctlé«˜çº§æœåŠ¡ç®¡ç†
---
## ğŸ“š ç›®å½•

1. [æœåŠ¡ä¾èµ–å…³ç³»ç®¡ç†](#1-æœåŠ¡ä¾èµ–å…³ç³»ç®¡ç†)
2. [å•å…ƒæ–‡ä»¶çŠ¶æ€ç®¡ç†](#2-å•å…ƒæ–‡ä»¶çŠ¶æ€ç®¡ç†)
3. [å¼ºåˆ¶ç»ˆæ­¢ä¸çŠ¶æ€é‡ç½®](#3-å¼ºåˆ¶ç»ˆæ­¢ä¸çŠ¶æ€é‡ç½®)
4. [æœåŠ¡å±æ€§æŸ¥çœ‹ä¸é…ç½®](#4-æœåŠ¡å±æ€§æŸ¥çœ‹ä¸é…ç½®)
5. [åŠ¨æ€å±æ€§ç®¡ç†](#5-åŠ¨æ€å±æ€§ç®¡ç†)
6. [é…ç½®è¿˜åŸä¸é¢„è®¾ç­–ç•¥](#6-é…ç½®è¿˜åŸä¸é¢„è®¾ç­–ç•¥)
7. [é«˜çº§ç®¡ç†ç»¼åˆåº”ç”¨](#7-é«˜çº§ç®¡ç†ç»¼åˆåº”ç”¨)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”— æœåŠ¡ä¾èµ–å…³ç³»ç®¡ç†


### 1.1 ä¾èµ–å…³ç³»æ¦‚è¿°


**ğŸ”¸ ä¾èµ–å…³ç³»ç±»å‹**
```
ç³»ç»ŸæœåŠ¡ä¾èµ–å±‚æ¬¡ç»“æ„ï¼š
        
        åº”ç”¨æœåŠ¡å±‚
           â†‘
      åŸºç¡€æœåŠ¡å±‚ (network, dbus)
           â†‘
      ç³»ç»Ÿæ ¸å¿ƒå±‚ (systemd-*)
           â†‘
        å†…æ ¸å±‚
```

**ä¾èµ–å…³ç³»åˆ†ç±»ï¼š**
- **Requires**ï¼šå¼ºä¾èµ–ï¼Œå¿…é¡»æˆåŠŸå¯åŠ¨
- **Wants**ï¼šå¼±ä¾èµ–ï¼Œå¤±è´¥ä¸å½±å“æœ¬æœåŠ¡
- **Before/After**ï¼šå¯åŠ¨é¡ºåºæ§åˆ¶
- **Conflicts**ï¼šå†²çªæœåŠ¡ï¼Œä¸èƒ½åŒæ—¶è¿è¡Œ

### 1.2 æŸ¥çœ‹æœåŠ¡ä¾èµ–å…³ç³»


**ğŸ”§ åŸºæœ¬ä¾èµ–æŸ¥çœ‹**
```bash
# æŸ¥çœ‹æœåŠ¡çš„ç›´æ¥ä¾èµ–
systemctl list-dependencies nginx

# æ˜¾ç¤ºå®Œæ•´ä¾èµ–æ ‘
systemctl list-dependencies nginx --all

# æŸ¥çœ‹åå‘ä¾èµ–ï¼ˆè°ä¾èµ–æ­¤æœåŠ¡ï¼‰
systemctl list-dependencies nginx --reverse
```

**ä¾èµ–å…³ç³»è¾“å‡ºè§£æï¼š**
```
nginx.service
â”œâ”€system.slice
â””â”€basic.target
  â”œâ”€paths.target
  â”œâ”€slices.target
  â”‚ â”œâ”€-.slice
  â”‚ â””â”€system.slice
  â”œâ”€sockets.target
  â”‚ â”œâ”€dbus.socket
  â”‚ â””â”€systemd-journald.socket
  â””â”€sysinit.target
    â”œâ”€dev-hugepages.mount
    â”œâ”€dev-mqueue.mount
```

### 1.3 ä¾èµ–å…³ç³»åˆ†ææŠ€å·§


| é€‰é¡¹å‚æ•° | åŠŸèƒ½æè¿° | åº”ç”¨åœºæ™¯ | ç¤ºä¾‹ |
|---------|----------|----------|------|
| `--all` | æ˜¾ç¤ºå®Œæ•´ä¾èµ–æ ‘ | æ·±åº¦æ•…éšœæ’æŸ¥ | `systemctl list-dependencies --all` |
| `--reverse` | æ˜¾ç¤ºåå‘ä¾èµ– | å½±å“è¯„ä¼° | `systemctl list-dependencies --reverse sshd` |
| `--before` | æ˜¾ç¤ºå¯åŠ¨å‰ç½®æ¡ä»¶ | å¯åŠ¨é¡ºåºåˆ†æ | `systemctl list-dependencies --before multi-user.target` |
| `--after` | æ˜¾ç¤ºå¯åŠ¨åç½®æ¡ä»¶ | ä¾èµ–é“¾åˆ†æ | `systemctl list-dependencies --after network.target` |

**ğŸ” ä¾èµ–å…³ç³»å®ç”¨åˆ†æ**
```
ä¾èµ–åˆ†ææµç¨‹å›¾ï¼š

1. æœåŠ¡å¯åŠ¨è¯·æ±‚
         â†“
2. æ£€æŸ¥ä¾èµ–å…³ç³»
         â†“
3. æŒ‰é¡ºåºå¯åŠ¨ä¾èµ–æœåŠ¡
         â†“
4. å¯åŠ¨ç›®æ ‡æœåŠ¡
         â†“
5. å¯åŠ¨ä¾èµ–æ­¤æœåŠ¡çš„æœåŠ¡
```

---

## 2. ğŸ“‹ å•å…ƒæ–‡ä»¶çŠ¶æ€ç®¡ç†


### 2.1 å•å…ƒæ–‡ä»¶çŠ¶æ€æ¦‚å¿µ


**ğŸ”¸ å•å…ƒæ–‡ä»¶çŠ¶æ€ç±»å‹**
```
å•å…ƒçŠ¶æ€åˆ†ç±»ï¼š

å¯ç”¨çŠ¶æ€ï¼š
â”œâ”€ enabled     âœ… å¼€æœºè‡ªå¯åŠ¨
â”œâ”€ disabled    âŒ ç¦ç”¨è‡ªå¯åŠ¨  
â”œâ”€ static      ğŸ“Œ é™æ€ï¼Œä¸å¯å¯ç”¨/ç¦ç”¨
â”œâ”€ masked      ğŸš« è¢«å±è”½
â””â”€ linked      ğŸ”— ç¬¦å·é“¾æ¥

è¿è¡ŒçŠ¶æ€ï¼š
â”œâ”€ active      ğŸŸ¢ è¿è¡Œä¸­
â”œâ”€ inactive    ğŸ”´ å·²åœæ­¢
â”œâ”€ failed      âŒ å¯åŠ¨å¤±è´¥
â””â”€ activating  ğŸŸ¡ å¯åŠ¨ä¸­
```

### 2.2 æŸ¥çœ‹å•å…ƒæ–‡ä»¶çŠ¶æ€


**ğŸ“Š å…¨é¢çŠ¶æ€æŸ¥çœ‹**
```bash
# æŸ¥çœ‹æ‰€æœ‰å•å…ƒæ–‡ä»¶çŠ¶æ€
systemctl list-unit-files

# æŒ‰ç±»å‹è¿‡æ»¤æŸ¥çœ‹
systemctl list-unit-files --type=service
systemctl list-unit-files --type=socket
systemctl list-unit-files --type=timer

# æŒ‰çŠ¶æ€è¿‡æ»¤æŸ¥çœ‹  
systemctl list-unit-files --state=enabled
systemctl list-unit-files --state=disabled
```

**çŠ¶æ€ç»Ÿè®¡ä¿¡æ¯ï¼š**
```
å•å…ƒæ–‡ä»¶çŠ¶æ€åˆ†å¸ƒï¼š
enabled:  127 units  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  60%
disabled:  45 units  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  21%  
static:    32 units  â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  15%
masked:     8 units  â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   4%
```

### 2.3 å•å…ƒæ–‡ä»¶çŠ¶æ€æ“ä½œ


**ğŸ”§ çŠ¶æ€ç®¡ç†æ“ä½œ**

| å‘½ä»¤ | åŠŸèƒ½ | çŠ¶æ€å˜åŒ– | æ³¨æ„äº‹é¡¹ |
|------|------|----------|----------|
| `systemctl enable` | å¯ç”¨å¼€æœºè‡ªå¯ | `disabled â†’ enabled` | åˆ›å»ºç¬¦å·é“¾æ¥ |
| `systemctl disable` | ç¦ç”¨å¼€æœºè‡ªå¯ | `enabled â†’ disabled` | åˆ é™¤ç¬¦å·é“¾æ¥ |
| `systemctl mask` | å±è”½æœåŠ¡ | `ä»»ä½•çŠ¶æ€ â†’ masked` | **ä¸å¯å¯åŠ¨** |
| `systemctl unmask` | å–æ¶ˆå±è”½ | `masked â†’ disabled` | æ¢å¤å¯ç”¨çŠ¶æ€ |

**âš ï¸ å±è”½æœåŠ¡ç‰¹æ®Šè¯´æ˜**
```
å±è”½æœºåˆ¶åŸç†ï¼š
/etc/systemd/system/service.service â†’ /dev/null

ä½œç”¨ï¼š
â€¢ å®Œå…¨é˜»æ­¢æœåŠ¡å¯åŠ¨
â€¢ é˜²æ­¢æ„å¤–å¯ç”¨
â€¢ ç”¨äºå†²çªæœåŠ¡ç®¡ç†
```

---

## 3. âš¡ å¼ºåˆ¶ç»ˆæ­¢ä¸çŠ¶æ€é‡ç½®


### 3.1 å¼ºåˆ¶ç»ˆæ­¢æœåŠ¡æœºåˆ¶


**ğŸ”¸ ç»ˆæ­¢ä¿¡å·å±‚çº§**
```
æœåŠ¡åœæ­¢ä¿¡å·çº§è”ï¼š

1. SIGTERM  â”€â”€â”€â”€â”€â”€â”€ ä¼˜é›…åœæ­¢è¯·æ±‚
         â†“ (è¶…æ—¶)
2. SIGKILL  â”€â”€â”€â”€â”€â”€â”€ å¼ºåˆ¶ç«‹å³ç»ˆæ­¢
         â†“
3. æ¸…ç†èµ„æº â”€â”€â”€â”€â”€â”€â”€ é‡Šæ”¾æ–‡ä»¶å¥æŸ„ç­‰
```

**ç»ˆæ­¢æ–¹å¼å¯¹æ¯”ï¼š**
- **systemctl stop**ï¼šæ ‡å‡†åœæ­¢æµç¨‹ï¼Œå‘é€SIGTERM
- **systemctl kill**ï¼šç›´æ¥å‘é€æŒ‡å®šä¿¡å·
- **systemctl kill --signal=KILL**ï¼šå‘é€SIGKILLå¼ºåˆ¶ç»ˆæ­¢

### 3.2 systemctl killå‘½ä»¤è¯¦è§£


**ğŸ”§ å¼ºåˆ¶ç»ˆæ­¢æ“ä½œ**
```bash
# å‘é€é»˜è®¤ç»ˆæ­¢ä¿¡å·(SIGTERM)
systemctl kill nginx

# å‘é€å¼ºåˆ¶ç»ˆæ­¢ä¿¡å·(SIGKILL)  
systemctl kill --signal=KILL nginx

# ç»ˆæ­¢æœåŠ¡çš„æ‰€æœ‰è¿›ç¨‹
systemctl kill --kill-who=all nginx

# åªç»ˆæ­¢ä¸»è¿›ç¨‹
systemctl kill --kill-who=main nginx
```

**ä¿¡å·ç±»å‹é€‰æ‹©ï¼š**

| ä¿¡å· | æ•°å€¼ | ä½œç”¨ | ä½¿ç”¨åœºæ™¯ |
|------|------|------|----------|
| `SIGTERM` | 15 | ä¼˜é›…ç»ˆæ­¢ | ğŸŸ¢ **æ¨èé»˜è®¤** |
| `SIGKILL` | 9 | å¼ºåˆ¶ç»ˆæ­¢ | âŒ **æœ€åæ‰‹æ®µ** |
| `SIGQUIT` | 3 | é€€å‡ºå¹¶è½¬å‚¨ | ğŸ” è°ƒè¯•åˆ†æ |
| `SIGUSR1/2` | 10/12 | ç”¨æˆ·è‡ªå®šä¹‰ | ğŸ”§ æœåŠ¡ç‰¹å®šæ“ä½œ |

### 3.3 å¤±è´¥çŠ¶æ€é‡ç½®ç®¡ç†


**ğŸ”„ çŠ¶æ€é‡ç½®æœºåˆ¶**
```bash
# é‡ç½®å•ä¸ªæœåŠ¡çš„å¤±è´¥çŠ¶æ€
systemctl reset-failed nginx

# é‡ç½®æ‰€æœ‰æœåŠ¡çš„å¤±è´¥çŠ¶æ€  
systemctl reset-failed

# æŸ¥çœ‹å¤±è´¥çš„æœåŠ¡åˆ—è¡¨
systemctl --failed

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡å¤±è´¥è¯¦æƒ…
systemctl status nginx --lines=50
```

**å¤±è´¥çŠ¶æ€å¤„ç†æµç¨‹ï¼š**
```
æœåŠ¡å¤±è´¥å¤„ç†æµç¨‹ï¼š

æœåŠ¡å¯åŠ¨å¤±è´¥
       â†“
è®°å½•failureçŠ¶æ€ â† æŸ¥çœ‹ï¼šsystemctl --failed
       â†“
åˆ†æå¤±è´¥åŸå›  â† æŸ¥çœ‹ï¼šsystemctl status -l
       â†“  
ä¿®å¤é…ç½®é—®é¢˜
       â†“
é‡ç½®å¤±è´¥çŠ¶æ€ â† æ‰§è¡Œï¼šsystemctl reset-failed
       â†“
é‡æ–°å¯åŠ¨æœåŠ¡ â† æ‰§è¡Œï¼šsystemctl start
```

---

## 4. ğŸ” æœåŠ¡å±æ€§æŸ¥çœ‹ä¸é…ç½®


### 4.1 systemctl showå…¨é¢å±æ€§æŸ¥çœ‹


**ğŸ”¸ æœåŠ¡å±æ€§è·å–**
```bash
# æŸ¥çœ‹æœåŠ¡çš„æ‰€æœ‰å±æ€§
systemctl show nginx

# æŸ¥çœ‹ç‰¹å®šå±æ€§
systemctl show nginx --property=ActiveState,LoadState,UnitFileState

# ä»¥é”®å€¼å¯¹æ ¼å¼æ˜¾ç¤º
systemctl show nginx --no-pager
```

**å…³é”®å±æ€§åˆ†ç±»ï¼š**

| å±æ€§ç±»åˆ« | é‡è¦å±æ€§ | å«ä¹‰è¯´æ˜ |
|----------|----------|----------|
| **çŠ¶æ€å±æ€§** | `ActiveState` | å½“å‰è¿è¡ŒçŠ¶æ€ |
| | `LoadState` | å•å…ƒæ–‡ä»¶åŠ è½½çŠ¶æ€ |
| | `UnitFileState` | å•å…ƒæ–‡ä»¶å¯ç”¨çŠ¶æ€ |
| **èµ„æºå±æ€§** | `MemoryCurrent` | å½“å‰å†…å­˜ä½¿ç”¨ |
| | `CPUUsageNSec` | CPUä½¿ç”¨æ—¶é—´ |
| **é…ç½®å±æ€§** | `ExecStart` | å¯åŠ¨å‘½ä»¤ |
| | `Restart` | é‡å¯ç­–ç•¥ |

### 4.2 å±æ€§ä¿¡æ¯è§£æä¸åº”ç”¨


**ğŸ“Š å±æ€§ä¿¡æ¯ç¤ºä¾‹è§£æ**
```
nginx.serviceå…³é”®å±æ€§ï¼š
ActiveState=active                    â† ğŸŸ¢ æœåŠ¡æ­£åœ¨è¿è¡Œ
LoadState=loaded                      â† âœ… é…ç½®æ–‡ä»¶å·²åŠ è½½
UnitFileState=enabled                 â† ğŸš€ å¼€æœºè‡ªå¯å·²å¯ç”¨
MainPID=1234                         â† ğŸ†” ä¸»è¿›ç¨‹ID
MemoryCurrent=52428800               â† ğŸ’¾ å½“å‰ä½¿ç”¨50MBå†…å­˜
ExecStart=/usr/sbin/nginx            â† ğŸ¯ å¯åŠ¨å‘½ä»¤
Restart=no                           â† ğŸ”„ ä¸è‡ªåŠ¨é‡å¯
```

**ğŸ¯ å±æ€§ç›‘æ§è„šæœ¬ç¤ºä¾‹**
```bash
#!/bin/bash
# æœåŠ¡çŠ¶æ€ç›‘æ§è„šæœ¬

SERVICE_NAME="nginx"
echo "=== $SERVICE_NAME æœåŠ¡å±æ€§ç›‘æ§ ==="
echo "è¿è¡ŒçŠ¶æ€: $(systemctl show $SERVICE_NAME --property=ActiveState --value)"
echo "å†…å­˜ä½¿ç”¨: $(systemctl show $SERVICE_NAME --property=MemoryCurrent --value | numfmt --to=iec)"
echo "å¯åŠ¨æ—¶é—´: $(systemctl show $SERVICE_NAME --property=ActiveEnterTimestamp --value)"
```

---

## 5. âš™ï¸ åŠ¨æ€å±æ€§ç®¡ç†


### 5.1 systemctl set-propertyåŠ¨æ€é…ç½®


**ğŸ”¸ åŠ¨æ€å±æ€§ä¿®æ”¹æ¦‚å¿µ**
```
åŠ¨æ€å±æ€§ç®¡ç†ç‰¹ç‚¹ï¼š
â€¢ ğŸ”¥ ç«‹å³ç”Ÿæ•ˆï¼Œæ— éœ€é‡å¯æœåŠ¡  
â€¢ ğŸ’¾ ä¸´æ—¶ä¿®æ”¹ï¼Œé‡å¯åå¤±æ•ˆ
â€¢ ğŸ”§ ä¸»è¦ç”¨äºèµ„æºé™åˆ¶è°ƒæ•´
â€¢ âš¡ é€‚åˆç´§æ€¥æ€§èƒ½è°ƒä¼˜
```

### 5.2 å¸¸ç”¨åŠ¨æ€å±æ€§è®¾ç½®


**ğŸ“Š èµ„æºé™åˆ¶åŠ¨æ€è°ƒæ•´**
```bash
# è®¾ç½®å†…å­˜é™åˆ¶
systemctl set-property nginx MemoryMax=1G

# è®¾ç½®CPUé…é¢(50%çš„CPUæ—¶é—´)
systemctl set-property nginx CPUQuota=50%

# è®¾ç½®ä»»åŠ¡æ•°é‡é™åˆ¶
systemctl set-property nginx TasksMax=100

# è®¾ç½®IOæƒé‡
systemctl set-property nginx IOWeight=200
```

**åŠ¨æ€å±æ€§ç±»åˆ«ï¼š**

| å±æ€§ç±»å‹ | å¯è®¾ç½®å±æ€§ | ä½œç”¨èŒƒå›´ | åº”ç”¨åœºæ™¯ |
|----------|------------|----------|----------|
| **å†…å­˜æ§åˆ¶** | `MemoryMax`, `MemorySwapMax` | å†…å­˜ä½¿ç”¨é™åˆ¶ | ğŸš« é˜²æ­¢å†…å­˜æ³„éœ² |
| **CPUæ§åˆ¶** | `CPUQuota`, `CPUShares` | CPUæ—¶é—´åˆ†é… | âš¡ æ€§èƒ½è°ƒä¼˜ |
| **ä»»åŠ¡æ§åˆ¶** | `TasksMax` | è¿›ç¨‹/çº¿ç¨‹é™åˆ¶ | ğŸ”’ èµ„æºä¿æŠ¤ |
| **IOæ§åˆ¶** | `IOWeight`, `IOReadBandwidth` | IOä¼˜å…ˆçº§æ§åˆ¶ | ğŸ’¿ ç£ç›˜æ€§èƒ½ |

### 5.3 åŠ¨æ€é…ç½®æŒä¹…åŒ–


**ğŸ”„ æŒä¹…åŒ–é…ç½®æ–¹æ³•**
```bash
# æ–¹æ³•1ï¼šä½¿ç”¨--runtimeå‚æ•°(ä¸´æ—¶)
systemctl set-property --runtime nginx MemoryMax=1G

# æ–¹æ³•2ï¼šç¼–è¾‘é…ç½®æ–‡ä»¶(æ°¸ä¹…)  
systemctl edit nginx
# åœ¨override.confä¸­æ·»åŠ ï¼š
[Service]
MemoryMax=1G

# æ–¹æ³•3ï¼šç›´æ¥ä¿®æ”¹é…ç½®ç›®å½•
mkdir -p /etc/systemd/system/nginx.service.d/
echo -e "[Service]\nMemoryMax=1G" > /etc/systemd/system/nginx.service.d/memory.conf
systemctl daemon-reload
```

---

## 6. ğŸ”„ é…ç½®è¿˜åŸä¸é¢„è®¾ç­–ç•¥


### 6.1 systemctl reverté…ç½®è¿˜åŸ


**ğŸ”¸ é…ç½®è¿˜åŸæœºåˆ¶**
```
é…ç½®æ–‡ä»¶å±‚æ¬¡ç»“æ„ï¼š
/usr/lib/systemd/system/nginx.service     â† ğŸ“¦ åŸå§‹é…ç½®æ–‡ä»¶
         â†“ è¦†ç›–å±‚æ¬¡
/etc/systemd/system/nginx.service         â† ğŸ”§ ç”¨æˆ·å®Œæ•´è¦†ç›–
         â†“ è¦†ç›–å±‚æ¬¡  
/etc/systemd/system/nginx.service.d/      â† âš™ï¸ ç”¨æˆ·ç‰‡æ®µè¦†ç›–
â”œâ”€â”€ override.conf                         â† systemctl editåˆ›å»º
â”œâ”€â”€ memory.conf                           â† æ‰‹åŠ¨åˆ›å»º
â””â”€â”€ custom.conf                           â† å…¶ä»–è‡ªå®šä¹‰
```

**è¿˜åŸæ“ä½œç¤ºä¾‹ï¼š**
```bash
# è¿˜åŸæœåŠ¡é…ç½®åˆ°ç³»ç»Ÿé»˜è®¤
systemctl revert nginx

# æŸ¥çœ‹è¿˜åŸå‰çš„é…ç½®å·®å¼‚
systemctl cat nginx

# è¿˜åŸåé‡æ–°åŠ è½½
systemctl daemon-reload
systemctl restart nginx
```

### 6.2 systemctl preseté¢„è®¾ç­–ç•¥


**ğŸ¯ é¢„è®¾ç­–ç•¥æ¦‚å¿µ**
```
é¢„è®¾ç­–ç•¥æ–‡ä»¶ä¼˜å…ˆçº§ï¼š
/etc/systemd/system-preset/*.preset       â† ğŸ¥‡ æœ€é«˜ä¼˜å…ˆçº§
/run/systemd/system-preset/*.preset       â† ğŸ¥ˆ è¿è¡Œæ—¶é…ç½®
/usr/lib/systemd/system-preset/*.preset   â† ğŸ¥‰ ç³»ç»Ÿé»˜è®¤
```

**é¢„è®¾ç­–ç•¥è¯­æ³•ï¼š**
```bash
# /etc/systemd/system-preset/10-custom.preset
enable httpd.service
enable nginx.service  
disable telnet.service
disable rsh.service
```

### 6.3 é¢„è®¾ç­–ç•¥åº”ç”¨


**ğŸ”§ é¢„è®¾ç­–ç•¥æ“ä½œ**
```bash
# åº”ç”¨é¢„è®¾ç­–ç•¥åˆ°æŒ‡å®šæœåŠ¡
systemctl preset nginx

# åº”ç”¨é¢„è®¾ç­–ç•¥åˆ°æ‰€æœ‰æœåŠ¡
systemctl preset-all

# æŸ¥çœ‹é¢„è®¾ç­–ç•¥çŠ¶æ€
systemctl list-unit-files | grep nginx
```

**é¢„è®¾ç­–ç•¥åº”ç”¨åœºæ™¯ï¼š**
- **ğŸ–¥ï¸ ç³»ç»Ÿåˆå§‹åŒ–**ï¼šæ‰¹é‡é…ç½®æœåŠ¡å¯ç”¨çŠ¶æ€
- **ğŸ“‹ æ ‡å‡†åŒ–éƒ¨ç½²**ï¼šç¡®ä¿ç¯å¢ƒä¸€è‡´æ€§  
- **ğŸ”’ å®‰å…¨åŠ å›º**ï¼šç¦ç”¨ä¸å¿…è¦çš„æœåŠ¡
- **âš¡ å¿«é€Ÿéƒ¨ç½²**ï¼šè‡ªåŠ¨åŒ–æœåŠ¡é…ç½®

---

## 7. ğŸš€ é«˜çº§ç®¡ç†ç»¼åˆåº”ç”¨


### 7.1 æœåŠ¡å¥åº·æ£€æŸ¥è„šæœ¬


**ğŸ“Š ç»¼åˆç›‘æ§è„šæœ¬**
```bash
#!/bin/bash
# é«˜çº§æœåŠ¡ç®¡ç†ç›‘æ§è„šæœ¬

check_service_health() {
    local service=$1
    echo "ğŸ” æ£€æŸ¥æœåŠ¡: $service"
    
    # åŸºæœ¬çŠ¶æ€æ£€æŸ¥
    if systemctl is-active $service >/dev/null 2>&1; then
        echo "  çŠ¶æ€: ğŸŸ¢ è¿è¡Œä¸­"
    else
        echo "  çŠ¶æ€: ğŸ”´ å·²åœæ­¢"
        return 1
    fi
    
    # å†…å­˜ä½¿ç”¨æ£€æŸ¥
    local memory=$(systemctl show $service --property=MemoryCurrent --value)
    if [ "$memory" != "0" ]; then
        echo "  å†…å­˜: $(echo $memory | numfmt --to=iec)"
    fi
    
    # ä¾èµ–å…³ç³»æ£€æŸ¥
    local failed_deps=$(systemctl list-dependencies $service --failed --quiet | wc -l)
    if [ $failed_deps -gt 0 ]; then
        echo "  ä¾èµ–: âš ï¸ æœ‰ $failed_deps ä¸ªå¤±è´¥ä¾èµ–"
    else
        echo "  ä¾èµ–: âœ… ä¾èµ–å…³ç³»æ­£å¸¸"
    fi
}

# ä½¿ç”¨ç¤ºä¾‹
check_service_health "nginx"
check_service_health "postgresql"
```

### 7.2 æ‰¹é‡æœåŠ¡ç®¡ç†å·¥å…·


**ğŸ”§ æ‰¹é‡æ“ä½œè„šæœ¬**
```bash
#!/bin/bash
# æ‰¹é‡æœåŠ¡ç®¡ç†å·¥å…·

WEB_SERVICES=("nginx" "apache2" "php-fpm")
DB_SERVICES=("postgresql" "mysql" "redis")

manage_service_group() {
    local action=$1
    local services=("${@:2}")
    
    echo "ğŸ“‹ æ‰§è¡Œæ‰¹é‡æ“ä½œ: $action"
    for service in "${services[@]}"; do
        if systemctl $action $service; then
            echo "  âœ… $service: $action æˆåŠŸ"
        else
            echo "  âŒ $service: $action å¤±è´¥"
        fi
    done
}

# ä½¿ç”¨ç¤ºä¾‹
case $1 in
    "web")
        manage_service_group "restart" "${WEB_SERVICES[@]}"
        ;;
    "db")  
        manage_service_group "status" "${DB_SERVICES[@]}"
        ;;
    *)
        echo "ç”¨æ³•: $0 [web|db]"
        ;;
esac
```

### 7.3 æ•…éšœæ’é™¤å·¥ä½œæµ


**ğŸš¨ æ•…éšœæ’é™¤æ­¥éª¤**
```
systemctlé«˜çº§æ•…éšœæ’é™¤æµç¨‹ï¼š

1. åŸºç¡€çŠ¶æ€æ£€æŸ¥
   â”œâ”€ systemctl status service-name
   â”œâ”€ systemctl --failed  
   â””â”€ journalctl -u service-name

2. ä¾èµ–å…³ç³»åˆ†æ
   â”œâ”€ systemctl list-dependencies service-name
   â”œâ”€ systemctl list-dependencies --reverse service-name
   â””â”€ æ£€æŸ¥ä¾èµ–æœåŠ¡çŠ¶æ€

3. é…ç½®æ–‡ä»¶éªŒè¯
   â”œâ”€ systemctl cat service-name
   â”œâ”€ æ£€æŸ¥overrideé…ç½®
   â””â”€ éªŒè¯æ–‡ä»¶æƒé™

4. èµ„æºä½¿ç”¨åˆ†æ
   â”œâ”€ systemctl show service-name --property=Memory*
   â”œâ”€ systemctl show service-name --property=CPU*
   â””â”€ ç³»ç»Ÿèµ„æºæ•´ä½“æ£€æŸ¥

5. ä¿®å¤ä¸é‡ç½®
   â”œâ”€ systemctl reset-failed
   â”œâ”€ systemctl daemon-reload
   â””â”€ systemctl restart service-name
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„é«˜çº§å‘½ä»¤


```
ğŸ”¸ ä¾èµ–ç®¡ç†: systemctl list-dependencies [--all|--reverse]
ğŸ”¸ çŠ¶æ€ç®¡ç†: systemctl list-unit-files [--state=enabled]  
ğŸ”¸ å¼ºåˆ¶ç»ˆæ­¢: systemctl kill [--signal=KILL] service-name
ğŸ”¸ çŠ¶æ€é‡ç½®: systemctl reset-failed [service-name]
ğŸ”¸ å±æ€§æŸ¥çœ‹: systemctl show service-name [--property=PropertyName]
ğŸ”¸ åŠ¨æ€é…ç½®: systemctl set-property service-name Property=Value
ğŸ”¸ é…ç½®è¿˜åŸ: systemctl revert service-name
ğŸ”¸ é¢„è®¾ç­–ç•¥: systemctl preset [--preset-mode=enable-only] service-name
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¾èµ–å…³ç³»çš„é‡è¦æ€§**
```
ç†è§£ä¾èµ–å…³ç³»æœ‰åŠ©äºï¼š
â€¢ ç³»ç»Ÿå¯åŠ¨é¡ºåºåˆ†æ
â€¢ æœåŠ¡æ•…éšœå½±å“è¯„ä¼°  
â€¢ æ€§èƒ½ä¼˜åŒ–å’Œèµ„æºè§„åˆ’
â€¢ å®‰å…¨ç­–ç•¥åˆ¶å®š
```

**ğŸ”¹ åŠ¨æ€é…ç½®ä¸æŒä¹…åŒ–**
```
é…ç½®ç®¡ç†ç­–ç•¥ï¼š
â€¢ ç´§æ€¥è°ƒæ•´ï¼šä½¿ç”¨set-propertyä¸´æ—¶ä¿®æ”¹
â€¢ æŒä¹…é…ç½®ï¼šä½¿ç”¨systemctl editåˆ›å»ºoverride
â€¢ æ‰¹é‡ç®¡ç†ï¼šä½¿ç”¨preseté¢„è®¾ç­–ç•¥
â€¢ æ¢å¤é»˜è®¤ï¼šä½¿ç”¨revertè¿˜åŸé…ç½®
```

**ğŸ”¹ ç›‘æ§ä¸æ•…éšœæ’é™¤**
```
ç›‘æ§ç»´åº¦ï¼š
â€¢ è¿è¡ŒçŠ¶æ€ï¼šactive/inactive/failed
â€¢ èµ„æºä½¿ç”¨ï¼šå†…å­˜/CPU/IO/ä»»åŠ¡æ•°
â€¢ ä¾èµ–å…³ç³»ï¼šç›´æ¥ä¾èµ–/åå‘ä¾èµ–
â€¢ é…ç½®çŠ¶æ€ï¼šenabled/disabled/masked
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ ä½¿ç”¨åœºæ™¯åˆ¤æ–­**

| åœºæ™¯ | æ¨èå‘½ä»¤ç»„åˆ | æ ¸å¿ƒç›®æ ‡ |
|------|-------------|----------|
| **ğŸš¨ æ•…éšœæ’æŸ¥** | `status` â†’ `show` â†’ `list-dependencies` | å¿«é€Ÿå®šä½é—®é¢˜ |
| **âš¡ æ€§èƒ½è°ƒä¼˜** | `show` â†’ `set-property` â†’ ç›‘æ§éªŒè¯ | åŠ¨æ€èµ„æºè°ƒæ•´ |
| **ğŸ”§ é…ç½®ç®¡ç†** | `cat` â†’ `edit` â†’ `daemon-reload` | æŒä¹…åŒ–é…ç½® |
| **ğŸ“Š ç³»ç»Ÿç›‘æ§** | `list-unit-files` â†’ `--failed` â†’ `show` | å…¨é¢çŠ¶æ€æŒæ§ |

**ğŸ§  è®°å¿†è¦ç‚¹**
```
é«˜çº§ç®¡ç†è®°å¿†å£è¯€ï¼š
ä¾èµ–å…³ç³»æŸ¥å¾—æ¸…ï¼Œlist-dependenciesæ˜¾å±‚çº§
å•å…ƒçŠ¶æ€åˆ—è¡¨æ˜ï¼Œlist-unit-filesçœ‹åˆ†æ˜  
å¼ºåˆ¶ç»ˆæ­¢killå‘½ä»¤ï¼Œreset-failedé‡ç½®é™
å±æ€§è¯¦æƒ…showå±•ç°ï¼Œset-propertyåŠ¨æ€è¡Œ
é…ç½®è¿˜åŸrevertç”¨ï¼Œpreseté¢„è®¾ç­–ç•¥åº”
```

**æ ¸å¿ƒä»·å€¼**ï¼šsystemctlé«˜çº§ç®¡ç†å‘½ä»¤æä¾›äº†æ·±å…¥çš„ç³»ç»ŸæœåŠ¡æ§åˆ¶èƒ½åŠ›ï¼Œæ˜¯Linuxç³»ç»Ÿç®¡ç†å‘˜å¿…é¡»ç†Ÿç»ƒæŒæ¡çš„é‡è¦å·¥å…·ï¼Œèƒ½å¤Ÿå®ç°ç²¾ç»†åŒ–çš„æœåŠ¡ç®¡ç†å’Œæ•…éšœæ’é™¤ã€‚