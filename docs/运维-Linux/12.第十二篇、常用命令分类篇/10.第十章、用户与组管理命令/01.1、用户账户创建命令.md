---
title: 1ã€ç”¨æˆ·è´¦æˆ·åˆ›å»ºå‘½ä»¤
---
## ğŸ“š ç›®å½•

1. [ç”¨æˆ·è´¦æˆ·åˆ›å»ºåŸºç¡€æ¦‚å¿µ](#1-ç”¨æˆ·è´¦æˆ·åˆ›å»ºåŸºç¡€æ¦‚å¿µ)
2. [useraddå‘½ä»¤è¯¦è§£](#2-useraddå‘½ä»¤è¯¦è§£)
3. [ç”¨æˆ·IDåˆ†é…æœºåˆ¶](#3-ç”¨æˆ·IDåˆ†é…æœºåˆ¶)
4. [ç”¨æˆ·ä¸»ç›®å½•ä¸æƒé™ç®¡ç†](#4-ç”¨æˆ·ä¸»ç›®å½•ä¸æƒé™ç®¡ç†)
5. [ç”¨æˆ·æ¨¡æ¿ç›®å½•åº”ç”¨](#5-ç”¨æˆ·æ¨¡æ¿ç›®å½•åº”ç”¨)
6. [æ‰¹é‡ç”¨æˆ·åˆ›å»ºå®è·µ](#6-æ‰¹é‡ç”¨æˆ·åˆ›å»ºå®è·µ)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ§‘â€ğŸ’» ç”¨æˆ·è´¦æˆ·åˆ›å»ºåŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯ç”¨æˆ·è´¦æˆ·

**ç®€å•ç†è§£**ï¼šç”¨æˆ·è´¦æˆ·å°±åƒæ˜¯ç»™æ¯ä¸ªä½¿ç”¨Linuxç³»ç»Ÿçš„äººåˆ†é…çš„"èº«ä»½è¯"ï¼Œç”¨æ¥åŒºåˆ†ä¸åŒçš„ç”¨æˆ·å’Œæ§åˆ¶ä»–ä»¬çš„æƒé™ã€‚

```
ç°å®ç”Ÿæ´»ç±»æ¯”ï¼š
é…’åº—æˆ¿é—´ç®¡ç† â†â†’ Linuxç”¨æˆ·ç®¡ç†
â”œâ”€ æˆ¿å¡ â†â†’ ç”¨æˆ·åå’Œå¯†ç 
â”œâ”€ æˆ¿é—´å· â†â†’ ç”¨æˆ·ID(UID)
â”œâ”€ æˆ¿é—´ç±»å‹ â†â†’ ç”¨æˆ·ç±»å‹(æ™®é€šç”¨æˆ·/ç®¡ç†å‘˜)
â””â”€ æˆ¿é—´æƒé™ â†â†’ æ–‡ä»¶è®¿é—®æƒé™
```

### 1.2 Linuxç”¨æˆ·ç±»å‹åˆ†ç±»


| ç”¨æˆ·ç±»å‹ | **UIDèŒƒå›´** | **ä¸»è¦ä½œç”¨** | **å…¸å‹ä¾‹å­** |
|---------|------------|-------------|-------------|
| ğŸ”´ **è¶…çº§ç”¨æˆ·** | `0` | `ç³»ç»Ÿç®¡ç†å‘˜ï¼Œæ‹¥æœ‰æ‰€æœ‰æƒé™` | `root` |
| ğŸŸ¡ **ç³»ç»Ÿç”¨æˆ·** | `1-999` | `è¿è¡Œç³»ç»ŸæœåŠ¡å’Œç¨‹åº` | `nginx, mysql, apache` |
| ğŸŸ¢ **æ™®é€šç”¨æˆ·** | `1000+` | `æ—¥å¸¸ä½¿ç”¨å’Œå·¥ä½œ` | `å¼ ä¸‰, æå››, å¼€å‘äººå‘˜` |

> ğŸ’¡ **ç†è§£è¦ç‚¹**  
> å°±åƒå…¬å¸é‡Œæœ‰è€æ¿ã€éƒ¨é—¨ç»ç†ã€æ™®é€šå‘˜å·¥ä¸€æ ·ï¼ŒLinuxä¹Ÿæœ‰ä¸åŒçº§åˆ«çš„ç”¨æˆ·æ¥ç®¡ç†ä¸åŒçš„å·¥ä½œ

### 1.3 ç”¨æˆ·è´¦æˆ·çš„å­˜å‚¨ä½ç½®


**æ ¸å¿ƒé…ç½®æ–‡ä»¶**ï¼š
```
/etc/passwd     â† ç”¨æˆ·åŸºæœ¬ä¿¡æ¯å­˜æ”¾å¤„
/etc/shadow     â† ç”¨æˆ·å¯†ç ä¿¡æ¯å­˜æ”¾å¤„  
/etc/group      â† ç”¨æˆ·ç»„ä¿¡æ¯å­˜æ”¾å¤„
/etc/gshadow    â† ç”¨æˆ·ç»„å¯†ç ä¿¡æ¯å­˜æ”¾å¤„
```

**passwdæ–‡ä»¶æ ¼å¼è§£æ**ï¼š
```
root:x:0:0:root:/root:/bin/bash
â”‚    â”‚ â”‚ â”‚  â”‚    â”‚     â””â”€ ç™»å½•Shell
â”‚    â”‚ â”‚ â”‚  â”‚    â””â”€ å®¶ç›®å½•è·¯å¾„
â”‚    â”‚ â”‚ â”‚  â””â”€ ç”¨æˆ·æè¿°ä¿¡æ¯
â”‚    â”‚ â”‚ â””â”€ ä¸»ç»„ID(GID)
â”‚    â”‚ â””â”€ ç”¨æˆ·ID(UID)
â”‚    â””â”€ å¯†ç å ä½ç¬¦(å®é™…å¯†ç åœ¨/etc/shadow)
â””â”€ ç”¨æˆ·å
```

---

## 2. âš™ï¸ useraddå‘½ä»¤è¯¦è§£


### 2.1 useraddåŸºæœ¬è¯­æ³•

```bash
useradd [é€‰é¡¹] ç”¨æˆ·å
```

> ğŸ“Œ **æ ¸å¿ƒæ¦‚å¿µ**  
> useraddå°±åƒæ˜¯"ç”¨æˆ·å·¥å‚"ï¼Œå¯ä»¥æŒ‰ç…§ä½ çš„è¦æ±‚"ç”Ÿäº§"å‡ºç¬¦åˆè§„æ ¼çš„ç”¨æˆ·è´¦æˆ·

### 2.2 å¸¸ç”¨å‚æ•°è¯¦è§£


#### ğŸ  ä¸»ç›®å½•ç›¸å…³å‚æ•°

```bash
# -d æŒ‡å®šç”¨æˆ·ä¸»ç›®å½•
useradd -d /home/zhangsan zhangsan

# -m è‡ªåŠ¨åˆ›å»ºä¸»ç›®å½•ï¼ˆæ¨èï¼‰
useradd -m lisi

# -M ä¸åˆ›å»ºä¸»ç›®å½•
useradd -M service_user
```

**å‚æ•°å«ä¹‰è§£é‡Š**ï¼š
- `-d`ï¼šå°±åƒç»™æ–°å‘˜å·¥åˆ†é…åŠå…¬å®¤ä½ç½®
- `-m`ï¼šä¸ä»…åˆ†é…ä½ç½®ï¼Œè¿˜å¸®å¿™è£…ä¿®å¥½åŠå…¬å®¤
- `-M`ï¼šåªç™»è®°èº«ä»½ï¼Œä¸åˆ†é…åŠå…¬å®¤ï¼ˆé€šå¸¸ç”¨äºç³»ç»ŸæœåŠ¡è´¦æˆ·ï¼‰

#### ğŸ†” ç”¨æˆ·IDç›¸å…³å‚æ•°

```bash
# -u æŒ‡å®šUID
useradd -u 1500 wangwu

# -g æŒ‡å®šä¸»ç»„GID
useradd -g 1000 zhaoliu

# -G æŒ‡å®šé™„åŠ ç»„
useradd -G wheel,developers qiqi
```

#### ğŸš Shellå’Œç™»å½•æ§åˆ¶

```bash
# -s æŒ‡å®šç™»å½•Shell
useradd -s /bin/bash normaluser    # å…è®¸æ­£å¸¸ç™»å½•
useradd -s /sbin/nologin sysuser   # ç¦æ­¢ç™»å½•

# -c æ·»åŠ æ³¨é‡Šä¿¡æ¯
useradd -c "ç³»ç»Ÿç®¡ç†å‘˜" admin
```

**Shellç±»å‹è¯´æ˜**ï¼š
```
/bin/bash      â† æ ‡å‡†äº¤äº’å¼Shellï¼Œå¯ä»¥æ­£å¸¸ç™»å½•ä½¿ç”¨
/sbin/nologin  â† ç¦æ­¢ç™»å½•Shellï¼Œç”¨äºç³»ç»ŸæœåŠ¡è´¦æˆ·
/bin/false     â† ä¹Ÿæ˜¯ç¦æ­¢ç™»å½•ï¼Œä½†å¤„ç†æ–¹å¼ç•¥æœ‰ä¸åŒ
```

#### â° è´¦æˆ·è¿‡æœŸæ§åˆ¶

```bash
# -e è®¾ç½®è´¦æˆ·è¿‡æœŸæ—¥æœŸï¼ˆYYYY-MM-DDæ ¼å¼ï¼‰
useradd -e 2024-12-31 temp_user

# -f è®¾ç½®å¯†ç è¿‡æœŸåè´¦æˆ·é”å®šå¤©æ•°
useradd -f 30 project_user
```

### 2.3 useraddå®Œæ•´ç¤ºä¾‹


**åˆ›å»ºæ ‡å‡†æ™®é€šç”¨æˆ·**ï¼š
```bash
useradd -m -s /bin/bash -c "å¼€å‘äººå‘˜å¼ ä¸‰" -G developers zhangsan
```

**è§£ææ­¥éª¤**ï¼š
```
1. -m           â†’ åˆ›å»º/home/zhangsanç›®å½•
2. -s /bin/bash â†’ è®¾ç½®å¯ç™»å½•çš„Shell
3. -c "..."     â†’ æ·»åŠ ç”¨æˆ·æè¿°ä¿¡æ¯
4. -G developersâ†’ åŠ å…¥developersé™„åŠ ç»„
5. zhangsan     â†’ ç”¨æˆ·å
```

**åˆ›å»ºç³»ç»ŸæœåŠ¡ç”¨æˆ·**ï¼š
```bash
useradd -r -s /sbin/nologin -c "WebæœåŠ¡ç”¨æˆ·" nginx
```

**è§£ææ­¥éª¤**ï¼š
```
1. -r              â†’ åˆ›å»ºç³»ç»Ÿç”¨æˆ·ï¼ˆUID < 1000ï¼‰
2. -s /sbin/nologin â†’ ç¦æ­¢ç™»å½•
3. -c "..."         â†’ æ·»åŠ æè¿°ä¿¡æ¯
4. nginx            â†’ ç”¨æˆ·å
```

---

## 3. ğŸ”¢ ç”¨æˆ·IDåˆ†é…æœºåˆ¶


### 3.1 UIDåˆ†é…èŒƒå›´è¯¦è§£


```
Linuxç”¨æˆ·IDåˆ†é…è¡¨ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UID = 0                             â”‚ â† è¶…çº§ç”¨æˆ·rootä¸“ç”¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ UID = 1-999                         â”‚ â† ç³»ç»Ÿç”¨æˆ·èŒƒå›´
â”‚ (apache, mysql, nginxç­‰)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ UID = 1000-60000                    â”‚ â† æ™®é€šç”¨æˆ·èŒƒå›´
â”‚ (å¼ ä¸‰ã€æå››ç­‰çœŸå®ç”¨æˆ·)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ UID = 65534                         â”‚ â† nobodyç”¨æˆ·
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 è‡ªåŠ¨åˆ†é…è§„åˆ™


**ç³»ç»Ÿé»˜è®¤åˆ†é…é€»è¾‘**ï¼š
1. **æ™®é€šç”¨æˆ·**ï¼šä»1000å¼€å§‹ï¼Œä¾æ¬¡é€’å¢æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœªä½¿ç”¨çš„UID
2. **ç³»ç»Ÿç”¨æˆ·**ï¼šä»999å¼€å§‹ï¼Œä¾æ¬¡é€’å‡æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœªä½¿ç”¨çš„UID

```bash
# æŸ¥çœ‹å½“å‰ç³»ç»ŸUIDä½¿ç”¨æƒ…å†µ
cat /etc/passwd | cut -d: -f3 | sort -n
```

### 3.3 UIDåˆ†é…æœ€ä½³å®è·µ


> âš ï¸ **æ³¨æ„äº‹é¡¹**  
> UIDå°±åƒèº«ä»½è¯å·ï¼Œä¸€æ—¦åˆ†é…åä¸å»ºè®®éšæ„æ›´æ”¹ï¼Œä¼šå½±å“æ–‡ä»¶æ‰€æœ‰æƒ

**å»ºè®®åˆ†é…ç­–ç•¥**ï¼š
```
ä¸ªäººç”¨æˆ·ï¼š    1000-1999    (zhang.san, li.siç­‰)
é¡¹ç›®ç”¨æˆ·ï¼š    2000-2999    (project1, webappç­‰)  
æµ‹è¯•ç”¨æˆ·ï¼š    3000-3999    (test1, temp_userç­‰)
ç‰¹æ®Šç”¨é€”ï¼š    4000+        (backup, monitorç­‰)
```

---

## 4. ğŸ  ç”¨æˆ·ä¸»ç›®å½•ä¸æƒé™ç®¡ç†


### 4.1 ä¸»ç›®å½•åˆ›å»ºæœºåˆ¶


**è‡ªåŠ¨åˆ›å»ºä¸»ç›®å½•è¿‡ç¨‹**ï¼š
```
ç”¨æˆ·åˆ›å»ºæµç¨‹ï¼š
useradd -m username
    â†“
1. åœ¨/homeä¸‹åˆ›å»ºusernameç›®å½•
    â†“  
2. ä»/etc/skelå¤åˆ¶æ¨¡æ¿æ–‡ä»¶
    â†“
3. è®¾ç½®ç›®å½•æ‰€æœ‰è€…ä¸ºusername
    â†“
4. è®¾ç½®ç›®å½•æƒé™ä¸º755
```

**æ‰‹åŠ¨éªŒè¯åˆ›å»ºç»“æœ**ï¼š
```bash
# åˆ›å»ºç”¨æˆ·
useradd -m testuser

# æ£€æŸ¥ä¸»ç›®å½•
ls -la /home/testuser
# è¾“å‡ºï¼šdrwx------ testuser testuser
```

### 4.2 ä¸»ç›®å½•æƒé™è¯¦è§£


**æ ‡å‡†ä¸»ç›®å½•æƒé™**ï¼š
```
drwx------  (755æƒé™)
â”‚â”‚â”‚
â”‚â”‚â”‚â””â”€ å…¶ä»–ç”¨æˆ·æƒé™ï¼šæ— ä»»ä½•æƒé™
â”‚â”‚â””â”€ ç»„ç”¨æˆ·æƒé™ï¼šæ— ä»»ä½•æƒé™  
â”‚â””â”€ ç”¨æˆ·æƒé™ï¼šè¯»ã€å†™ã€æ‰§è¡Œ
â””â”€ æ–‡ä»¶ç±»å‹ï¼šç›®å½•
```

> ğŸ’¡ **å®‰å…¨è€ƒè™‘**  
> ä¸»ç›®å½•æƒé™è®¾ç½®ä¸º700ï¼Œç¡®ä¿åªæœ‰ç”¨æˆ·æœ¬äººèƒ½è®¿é—®ï¼Œä¿æŠ¤ä¸ªäººéšç§å’Œæ•°æ®å®‰å…¨

### 4.3 ä¸»ç›®å½•ä½ç½®è‡ªå®šä¹‰


**æŒ‡å®šè‡ªå®šä¹‰ä¸»ç›®å½•**ï¼š
```bash
# åˆ›å»ºåœ¨ä¸åŒä½ç½®çš„ä¸»ç›®å½•
useradd -m -d /opt/users/developer1 developer1
useradd -m -d /var/project/webuser webuser
```

**æ‰¹é‡åˆ›å»ºéƒ¨é—¨ç”¨æˆ·**ï¼š
```bash
# ä¸ºå¼€å‘éƒ¨é—¨åˆ›å»ºç»Ÿä¸€ç›®å½•ç»“æ„
mkdir -p /home/departments/development
useradd -m -d /home/departments/development/dev1 dev1
useradd -m -d /home/departments/development/dev2 dev2
```

---

## 5. ğŸ“ ç”¨æˆ·æ¨¡æ¿ç›®å½•åº”ç”¨


### 5.1 /etc/skelç›®å½•ä½œç”¨


**æ¨¡æ¿ç›®å½•æ¦‚å¿µ**ï¼š
```
/etc/skelå°±åƒæ˜¯"æ ·æ¿æˆ¿"
â”œâ”€ æ–°ç”¨æˆ·åˆ›å»ºæ—¶ä¼šå¤åˆ¶è¿™é‡Œçš„æ‰€æœ‰æ–‡ä»¶
â”œâ”€ å¯ä»¥é¢„å…ˆé…ç½®å¥½å¸¸ç”¨çš„è®¾ç½®æ–‡ä»¶
â””â”€ å®ç°ç”¨æˆ·ç¯å¢ƒçš„æ ‡å‡†åŒ–é…ç½®
```

**é»˜è®¤æ¨¡æ¿æ–‡ä»¶**ï¼š
```bash
ls -la /etc/skel
# å…¸å‹è¾“å‡ºï¼š
# .bashrc      â† bashé…ç½®æ–‡ä»¶
# .bash_logout â† æ³¨é”€æ—¶æ‰§è¡Œçš„è„šæœ¬  
# .profile     â† ç™»å½•æ—¶ç¯å¢ƒé…ç½®
```

### 5.2 è‡ªå®šä¹‰æ¨¡æ¿æ–‡ä»¶


**æ·»åŠ å¸¸ç”¨é…ç½®åˆ°æ¨¡æ¿**ï¼š
```bash
# æ·»åŠ å¸¸ç”¨åˆ«ååˆ°æ‰€æœ‰æ–°ç”¨æˆ·
echo "alias ll='ls -la'" >> /etc/skel/.bashrc
echo "alias la='ls -A'" >> /etc/skel/.bashrc

# æ·»åŠ æ¬¢è¿ä¿¡æ¯
echo "echo 'æ¬¢è¿ä½¿ç”¨æœ¬ç³»ç»Ÿï¼'" >> /etc/skel/.bashrc
```

**åˆ›å»ºæ ‡å‡†å·¥ä½œç¯å¢ƒ**ï¼š
```bash
# ä¸ºå¼€å‘äººå‘˜åˆ›å»ºæ ‡å‡†ç›®å½•ç»“æ„
mkdir -p /etc/skel/{Documents,Downloads,Projects,Scripts}

# æ·»åŠ å¼€å‘å·¥å…·é…ç½®
cp /opt/configs/.vimrc /etc/skel/
cp /opt/configs/.gitconfig /etc/skel/
```

### 5.3 éƒ¨é—¨ä¸“ç”¨æ¨¡æ¿ç›®å½•


**ä¸ºä¸åŒéƒ¨é—¨åˆ›å»ºä¸“ç”¨æ¨¡æ¿**ï¼š
```bash
# åˆ›å»ºå¼€å‘éƒ¨é—¨æ¨¡æ¿
mkdir -p /etc/skel-dev
cp -r /etc/skel/* /etc/skel-dev/
echo "export PATH=$PATH:/opt/dev-tools" >> /etc/skel-dev/.bashrc

# ä½¿ç”¨ä¸“ç”¨æ¨¡æ¿åˆ›å»ºç”¨æˆ·
useradd -m -k /etc/skel-dev developer1
```

---

## 6. ğŸš€ æ‰¹é‡ç”¨æˆ·åˆ›å»ºå®è·µ


### 6.1 è„šæœ¬åŒ–æ‰¹é‡åˆ›å»º


**åŸºç¡€æ‰¹é‡åˆ›å»ºè„šæœ¬**ï¼š
```bash
#!/bin/bash
# æ‰¹é‡åˆ›å»ºç”¨æˆ·è„šæœ¬

# ç”¨æˆ·åˆ—è¡¨
users=("user1" "user2" "user3" "user4" "user5")

for user in "${users[@]}"; do
    # åˆ›å»ºç”¨æˆ·
    useradd -m -s /bin/bash -c "æ‰¹é‡åˆ›å»ºçš„ç”¨æˆ·$user" "$user"
    
    # è®¾ç½®é»˜è®¤å¯†ç 
    echo "$user:123456" | chpasswd
    
    # å¼ºåˆ¶é¦–æ¬¡ç™»å½•ä¿®æ”¹å¯†ç 
    passwd -e "$user"
    
    echo "ç”¨æˆ· $user åˆ›å»ºå®Œæˆ"
done
```

### 6.2 ä»CSVæ–‡ä»¶æ‰¹é‡åˆ›å»º


**CSVç”¨æˆ·æ•°æ®æ ¼å¼**ï¼š
```
username,fullname,department,shell
zhangsan,å¼ ä¸‰,å¼€å‘éƒ¨,/bin/bash
lisi,æå››,æµ‹è¯•éƒ¨,/bin/bash
wangwu,ç‹äº”,è¿ç»´éƒ¨,/bin/bash
```

**æ‰¹é‡å¤„ç†è„šæœ¬**ï¼š
```bash
#!/bin/bash
# ä»CSVæ–‡ä»¶æ‰¹é‡åˆ›å»ºç”¨æˆ·

while IFS=',' read -r username fullname department shell; do
    # è·³è¿‡æ ‡é¢˜è¡Œ
    [[ "$username" == "username" ]] && continue
    
    # åˆ›å»ºç”¨æˆ·
    useradd -m -s "$shell" -c "$fullname ($department)" "$username"
    
    # è®¾ç½®ä¸´æ—¶å¯†ç 
    echo "$username:temp123" | chpasswd
    passwd -e "$username"
    
    echo "åˆ›å»ºç”¨æˆ·: $username ($fullname)"
done < users.csv
```

### 6.3 é¡¹ç›®ç»„æ‰¹é‡ç®¡ç†


**é¡¹ç›®ç»„ç”¨æˆ·åˆ›å»ºæ¨¡æ¿**ï¼š
```bash
#!/bin/bash
# ä¸ºæ–°é¡¹ç›®åˆ›å»ºç”¨æˆ·ç»„

PROJECT_NAME="webapp"
GROUP_ID=2000
BASE_UID=2000

# åˆ›å»ºé¡¹ç›®ç»„
groupadd -g $GROUP_ID "${PROJECT_NAME}_team"

# é¡¹ç›®è§’è‰²ç”¨æˆ·åˆ—è¡¨
declare -A roles=(
    ["admin"]="é¡¹ç›®ç®¡ç†å‘˜"
    ["dev"]="å¼€å‘äººå‘˜" 
    ["test"]="æµ‹è¯•äººå‘˜"
    ["deploy"]="éƒ¨ç½²äººå‘˜"
)

# æ‰¹é‡åˆ›å»ºè§’è‰²ç”¨æˆ·
uid_counter=$BASE_UID
for role in "${!roles[@]}"; do
    username="${PROJECT_NAME}_${role}"
    
    useradd -u $uid_counter \
            -g "${PROJECT_NAME}_team" \
            -m -s /bin/bash \
            -c "${roles[$role]}" \
            "$username"
    
    ((uid_counter++))
    echo "åˆ›å»º $username: ${roles[$role]}"
done
```

---

## 7. ğŸ”§ é…ç½®æ–‡ä»¶ä¸é«˜çº§è®¾ç½®


### 7.1 /etc/default/useraddé…ç½®


**é»˜è®¤é…ç½®æ–‡ä»¶å†…å®¹**ï¼š
```bash
# æŸ¥çœ‹é»˜è®¤é…ç½®
cat /etc/default/useradd

# å…¸å‹è¾“å‡ºï¼š
GROUP=100           # é»˜è®¤ä¸»ç»„ID
HOME=/home          # é»˜è®¤ä¸»ç›®å½•åŸºç¡€è·¯å¾„  
INACTIVE=-1         # å¯†ç è¿‡æœŸåè´¦æˆ·é”å®šå¤©æ•°(-1è¡¨ç¤ºä¸é”å®š)
EXPIRE=             # é»˜è®¤è´¦æˆ·è¿‡æœŸæ—¥æœŸ(ç©ºè¡¨ç¤ºä¸è¿‡æœŸ)
SHELL=/bin/sh       # é»˜è®¤Shell
SKEL=/etc/skel      # é»˜è®¤æ¨¡æ¿ç›®å½•
CREATE_MAIL_SPOOL=yes  # æ˜¯å¦åˆ›å»ºé‚®ä»¶ç›®å½•
```

**ä¿®æ”¹å…¨å±€é»˜è®¤è®¾ç½®**ï¼š
```bash
# ä¿®æ”¹é»˜è®¤Shellä¸ºbash
sed -i 's/SHELL=\/bin\/sh/SHELL=\/bin\/bash/' /etc/default/useradd

# ä¿®æ”¹é»˜è®¤æ¨¡æ¿ç›®å½•
sed -i 's/SKEL=\/etc\/skel/SKEL=\/etc\/skel-custom/' /etc/default/useradd
```

### 7.2 ç”¨æˆ·åˆ›å»ºéªŒè¯


**å®Œæ•´éªŒè¯è„šæœ¬**ï¼š
```bash
#!/bin/bash
# ç”¨æˆ·åˆ›å»ºéªŒè¯è„šæœ¬

check_user() {
    local username=$1
    
    echo "=== éªŒè¯ç”¨æˆ· $username ==="
    
    # æ£€æŸ¥/etc/passwdæ¡ç›®
    grep "^$username:" /etc/passwd && echo "âœ“ passwdæ¡ç›®æ­£å¸¸"
    
    # æ£€æŸ¥ä¸»ç›®å½•
    [[ -d "/home/$username" ]] && echo "âœ“ ä¸»ç›®å½•å­˜åœ¨"
    
    # æ£€æŸ¥ä¸»ç›®å½•æƒé™
    ls -ld "/home/$username" | grep "^drwx------" && echo "âœ“ ç›®å½•æƒé™æ­£ç¡®"
    
    # æ£€æŸ¥Shellè®¾ç½®
    getent passwd "$username" | cut -d: -f7 | grep -E "(bash|sh)$" && echo "âœ“ Shellè®¾ç½®æ­£ç¡®"
    
    echo ""
}

# ä½¿ç”¨ç¤ºä¾‹
check_user "testuser"
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ç”¨æˆ·è´¦æˆ·æœ¬è´¨ï¼šLinuxç³»ç»Ÿçš„èº«ä»½æ ‡è¯†å’Œæƒé™æ§åˆ¶æœºåˆ¶
ğŸ”¸ useraddå‘½ä»¤ï¼šLinuxç³»ç»Ÿåˆ›å»ºç”¨æˆ·çš„æ ‡å‡†å·¥å…·
ğŸ”¸ UIDåˆ†é…æœºåˆ¶ï¼šç³»ç»Ÿç”¨æˆ·(1-999)ï¼Œæ™®é€šç”¨æˆ·(1000+)
ğŸ”¸ ä¸»ç›®å½•ç®¡ç†ï¼šç”¨æˆ·ä¸ªäººæ–‡ä»¶å’Œé…ç½®çš„å­˜å‚¨ç©ºé—´
ğŸ”¸ æ¨¡æ¿ç›®å½•ï¼šæ ‡å‡†åŒ–ç”¨æˆ·åˆå§‹ç¯å¢ƒçš„é…ç½®æ¨¡æ¿
ğŸ”¸ æ‰¹é‡ç®¡ç†ï¼šæé«˜è¿ç»´æ•ˆç‡çš„è‡ªåŠ¨åŒ–ç”¨æˆ·ç®¡ç†
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆè¦ç†è§£ç”¨æˆ·ç®¡ç†**
```
å®‰å…¨æ§åˆ¶ï¼š
- ä¸åŒç”¨æˆ·æœ‰ä¸åŒæƒé™ï¼Œä¿è¯ç³»ç»Ÿå®‰å…¨
- åˆç†åˆ†é…ç”¨æˆ·è§’è‰²ï¼Œé¿å…æƒé™æ»¥ç”¨

è¿ç»´æ•ˆç‡ï¼š
- æ‰¹é‡ç®¡ç†ç”¨æˆ·ï¼Œæé«˜å·¥ä½œæ•ˆç‡
- æ ‡å‡†åŒ–é…ç½®ï¼Œå‡å°‘é‡å¤å·¥ä½œ

ç³»ç»Ÿç¨³å®šï¼š
- ç³»ç»ŸæœåŠ¡ä½¿ç”¨ä¸“é—¨ç”¨æˆ·ï¼Œé¿å…æƒé™å†²çª
- ç”¨æˆ·éš”ç¦»ï¼Œä¸€ä¸ªç”¨æˆ·å‡ºé—®é¢˜ä¸å½±å“å…¶ä»–ç”¨æˆ·
```

**ğŸ”¹ useraddå‚æ•°é€‰æ‹©æŒ‡å¯¼**
```
æ™®é€šåŠå…¬ç”¨æˆ·ï¼šuseradd -m -s /bin/bash username
ç³»ç»ŸæœåŠ¡ç”¨æˆ·ï¼šuseradd -r -s /sbin/nologin username  
é¡¹ç›®ä¸´æ—¶ç”¨æˆ·ï¼šuseradd -m -e 2024-12-31 username
å¼€å‘æµ‹è¯•ç”¨æˆ·ï¼šuseradd -m -G developers username
```

### 8.3 å®é™…åº”ç”¨ä»·å€¼


- **ä¼ä¸šç¯å¢ƒ**ï¼šæ–°å‘˜å·¥å…¥èŒæ—¶å¿«é€Ÿåˆ›å»ºæ ‡å‡†è´¦æˆ·
- **å¼€å‘å›¢é˜Ÿ**ï¼šä¸ºä¸åŒé¡¹ç›®åˆ›å»ºä¸“ç”¨å¼€å‘ç¯å¢ƒ
- **ç³»ç»Ÿè¿ç»´**ï¼šæ‰¹é‡ç®¡ç†æœåŠ¡å™¨ç”¨æˆ·ï¼Œæé«˜è¿ç»´æ•ˆç‡
- **å®‰å…¨ç®¡æ§**ï¼šåˆç†åˆ†é…ç”¨æˆ·æƒé™ï¼Œä¿éšœç³»ç»Ÿå®‰å…¨

### 8.4 å¸¸è§é—®é¢˜æ’æŸ¥


> ğŸ” **æ•…éšœæ’æŸ¥æŒ‡å—**

**é—®é¢˜1**ï¼šç”¨æˆ·åˆ›å»ºåæ— æ³•ç™»å½•
```bash
# æ£€æŸ¥æ­¥éª¤ï¼š
1. ç¡®è®¤ç”¨æˆ·å­˜åœ¨ï¼šgrep username /etc/passwd
2. æ£€æŸ¥Shellè®¾ç½®ï¼šgetent passwd username | cut -d: -f7
3. ç¡®è®¤å¯†ç è®¾ç½®ï¼špasswd username
4. æ£€æŸ¥è´¦æˆ·é”å®šï¼špasswd -S username
```

**é—®é¢˜2**ï¼šä¸»ç›®å½•æœªåˆ›å»ºæˆ–æƒé™é”™è¯¯
```bash
# è§£å†³æ–¹æ¡ˆï¼š
1. æ‰‹åŠ¨åˆ›å»ºä¸»ç›®å½•ï¼šmkdir -p /home/username
2. å¤åˆ¶æ¨¡æ¿æ–‡ä»¶ï¼šcp -r /etc/skel/. /home/username/
3. ä¿®æ”¹æ‰€æœ‰è€…ï¼šchown -R username:username /home/username
4. è®¾ç½®æƒé™ï¼šchmod 700 /home/username
```

### 8.5 å­¦ä¹ æ£€éªŒæ¸…å•


âœ… **è‡ªæ£€æ¸…å•**ï¼š
- [ ] ç†è§£Linuxç”¨æˆ·ç±»å‹å’ŒUIDåˆ†é…è§„åˆ™
- [ ] æŒæ¡useraddå‘½ä»¤çš„å¸¸ç”¨å‚æ•°ç»„åˆ
- [ ] èƒ½å¤Ÿåˆ›å»ºä¸åŒç±»å‹çš„ç”¨æˆ·è´¦æˆ·
- [ ] ç†è§£ç”¨æˆ·ä¸»ç›®å½•å’Œæƒé™è®¾ç½®
- [ ] ä¼šä½¿ç”¨/etc/skelè‡ªå®šä¹‰ç”¨æˆ·æ¨¡æ¿
- [ ] èƒ½å¤Ÿç¼–å†™æ‰¹é‡ç”¨æˆ·åˆ›å»ºè„šæœ¬
- [ ] æŒæ¡ç”¨æˆ·åˆ›å»ºçš„éªŒè¯å’Œæ•…éšœæ’æŸ¥

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
ç”¨æˆ·ç®¡ç†ä¸‰è¦ç´ ï¼šèº«ä»½æ ‡è¯†æƒé™ç®¡æ§  
useraddåˆ›å»ºæˆ·ï¼Œå‚æ•°é€‰æ‹©è¦è®°ç‰¢
UIDåˆ†é…æœ‰è§„å¾‹ï¼Œç³»ç»Ÿæ™®é€šè¦åˆ†æ¸…
ä¸»ç›®å½•æƒé™700ï¼Œæ¨¡æ¿é…ç½®è¦ç”¨å¥½
æ‰¹é‡åˆ›å»ºæ•ˆç‡é«˜ï¼ŒéªŒè¯æ’æŸ¥ä¸èƒ½å°‘
```