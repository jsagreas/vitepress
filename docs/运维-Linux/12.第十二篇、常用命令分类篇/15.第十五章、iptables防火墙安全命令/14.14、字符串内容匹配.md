---
title: 14ã€å­—ç¬¦ä¸²å†…å®¹åŒ¹é…
---
## ğŸ“š ç›®å½•

1. [å­—ç¬¦ä¸²åŒ¹é…åŸºç¡€æ¦‚å¿µ](#1-å­—ç¬¦ä¸²åŒ¹é…åŸºç¡€æ¦‚å¿µ)
2. [stringæ¨¡å—æ ¸å¿ƒå‚æ•°](#2-stringæ¨¡å—æ ¸å¿ƒå‚æ•°)
3. [HTTPå†…å®¹è¿‡æ»¤å®æˆ˜](#3-HTTPå†…å®¹è¿‡æ»¤å®æˆ˜)
4. [URLè·¯å¾„è¿‡æ»¤é…ç½®](#4-URLè·¯å¾„è¿‡æ»¤é…ç½®)
5. [å…³é”®è¯è¿‡æ»¤è®¾ç½®](#5-å…³é”®è¯è¿‡æ»¤è®¾ç½®)
6. [ç®—æ³•é€‰æ‹©ä¸æ€§èƒ½](#6-ç®—æ³•é€‰æ‹©ä¸æ€§èƒ½)
7. [å®é™…åº”ç”¨åœºæ™¯](#7-å®é™…åº”ç”¨åœºæ™¯)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” å­—ç¬¦ä¸²åŒ¹é…åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²åŒ¹é…


**é€šä¿—ç†è§£**ï¼š
æƒ³è±¡ä½ åœ¨çœ‹ç½‘ç»œæµé‡ï¼Œå°±åƒé‚®é€’å‘˜æ£€æŸ¥åŒ…è£¹å†…å®¹ä¸€æ ·ã€‚å­—ç¬¦ä¸²åŒ¹é…åŠŸèƒ½è®©iptablesèƒ½å¤Ÿ"é€è§†"æ•°æ®åŒ…å†…éƒ¨ï¼Œæ£€æŸ¥é‡Œé¢æ˜¯å¦åŒ…å«ç‰¹å®šçš„æ–‡å­—å†…å®¹ã€‚

```
ç½‘ç»œæ•°æ®åŒ…æµåŠ¨è¿‡ç¨‹ï¼š
å®¢æˆ·ç«¯ â†’ [æ•°æ®åŒ…ï¼šåŒ…å«"ä¸‹è½½ç”µå½±"] â†’ æœåŠ¡å™¨
         â†‘
    iptablesæ£€æŸ¥å†…å®¹
    å‘ç°"ä¸‹è½½ç”µå½±"å…³é”®è¯
    æ ¹æ®è§„åˆ™å†³å®šæ”¾è¡Œæˆ–é˜»æ­¢
```

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
- **-m string**ï¼šå‘Šè¯‰iptablesä½¿ç”¨å­—ç¬¦ä¸²åŒ¹é…åŠŸèƒ½
- **--string**ï¼šæŒ‡å®šè¦æŸ¥æ‰¾çš„å…·ä½“æ–‡å­—å†…å®¹
- **--algo**ï¼šé€‰æ‹©æœç´¢ç®—æ³•ï¼ˆå°±åƒé€‰æ‹©ä¸åŒçš„æŸ¥æ‰¾æ–¹æ³•ï¼‰

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦å­—ç¬¦ä¸²åŒ¹é…


**å®é™…åº”ç”¨åœºæ™¯**ï¼š
```
ğŸ“‹ å†…å®¹è¿‡æ»¤éœ€æ±‚ï¼š
ğŸ”¸ é˜»æ­¢è®¿é—®ç‰¹å®šç½‘ç«™å†…å®¹
ğŸ”¸ é˜²æ­¢ä¸‹è½½è¿è§„æ–‡ä»¶
ğŸ”¸ ç›‘æ§æ•æ„Ÿä¿¡æ¯ä¼ è¾“
ğŸ”¸ è¿‡æ»¤åƒåœ¾é‚®ä»¶å…³é”®è¯
ğŸ”¸ é˜»æ­¢æ¶æ„è½¯ä»¶é€šä¿¡
```

**ä¸æ™®é€šè§„åˆ™çš„åŒºåˆ«**ï¼š
```
æ™®é€šè§„åˆ™ï¼šåªçœ‹IPåœ°å€å’Œç«¯å£
ä¾‹å¦‚ï¼šé˜»æ­¢è®¿é—® 192.168.1.100:80

å­—ç¬¦ä¸²åŒ¹é…ï¼šæ·±å…¥æ£€æŸ¥å†…å®¹
ä¾‹å¦‚ï¼šé˜»æ­¢åŒ…å«"ç—…æ¯’ä¸‹è½½"çš„HTTPè¯·æ±‚
```

### 1.3 å·¥ä½œåŸç†å›¾è§£


```
æ•°æ®åŒ…æ£€æŸ¥æµç¨‹ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç½‘ç»œæ•°æ®åŒ…  â”‚â”€â”€â”€â–ºâ”‚ iptables    â”‚â”€â”€â”€â–ºâ”‚  åŒ¹é…ç»“æœ    â”‚
â”‚            â”‚    â”‚ stringæ¨¡å—  â”‚    â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                   â”‚                   â”‚
      â”‚                   â”‚                   â”‚
   åŒ…å«å†…å®¹          å­—ç¬¦ä¸²æœç´¢ç®—æ³•         ACCEPT/DROP
  "æ•æ„Ÿå…³é”®è¯"        (KMP/BMç®—æ³•)          å†³å®šåŠ¨ä½œ
```

---

## 2. âš™ï¸ stringæ¨¡å—æ ¸å¿ƒå‚æ•°


### 2.1 åŸºæœ¬è¯­æ³•ç»“æ„


**å®Œæ•´è¯­æ³•æ ¼å¼**ï¼š
```bash
iptables -I INPUT -m string --string "æœç´¢å†…å®¹" --algo ç®—æ³•åç§° -j åŠ¨ä½œ
```

**å‚æ•°è¯¦è§£**ï¼š

| å‚æ•° | ä½œç”¨ | ç¤ºä¾‹ | è¯´æ˜ |
|------|------|------|------|
| **-m string** | `å¯ç”¨å­—ç¬¦ä¸²åŒ¹é…æ¨¡å—` | `-m string` | `å¿…é¡»å‚æ•°ï¼Œå‘Šè¯‰ç³»ç»Ÿè¦æ£€æŸ¥å†…å®¹` |
| **--string** | `æŒ‡å®šæœç´¢çš„æ–‡å­—` | `--string "download"` | `åŒºåˆ†å¤§å°å†™ï¼Œè¦å®Œå…¨åŒ¹é…` |
| **--algo** | `é€‰æ‹©æœç´¢ç®—æ³•` | `--algo kmp` | `kmpæˆ–bmç®—æ³•ï¼Œå½±å“æ€§èƒ½` |
| **--icase** | `å¿½ç•¥å¤§å°å†™` | `--string "HTTP" --icase` | `å¯é€‰å‚æ•°ï¼ŒHTTPå’Œhttpéƒ½åŒ¹é…` |

### 2.2 ç®—æ³•é€‰æ‹©è¯¦è§£


**ğŸ”¸ KMPç®—æ³•ï¼ˆKnuth-Morris-Prattï¼‰**
```
ç‰¹ç‚¹ï¼š
âœ… å†…å­˜å ç”¨å°‘
âœ… é€‚åˆçŸ­å­—ç¬¦ä¸²æœç´¢
âœ… é»˜è®¤æ¨èç®—æ³•
âŒ é•¿å­—ç¬¦ä¸²æœç´¢è¾ƒæ…¢

ä½¿ç”¨åœºæ™¯ï¼šæœç´¢URLè·¯å¾„ã€ç®€å•å…³é”®è¯
```

**ğŸ”¸ BMç®—æ³•ï¼ˆBoyer-Mooreï¼‰**
```
ç‰¹ç‚¹ï¼š
âœ… é•¿å­—ç¬¦ä¸²æœç´¢å¿«
âœ… é€‚åˆå¤æ‚å†…å®¹è¿‡æ»¤
âŒ å†…å­˜å ç”¨è¾ƒå¤š
âŒ çŸ­å­—ç¬¦ä¸²åè€Œæ…¢

ä½¿ç”¨åœºæ™¯ï¼šæœç´¢æ–‡ä»¶å†…å®¹ã€é‚®ä»¶æ­£æ–‡
```

### 2.3 å¤§å°å†™å¤„ç†


**é»˜è®¤è¡Œä¸ºï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰**ï¼š
```bash
# åªåŒ¹é…å°å†™"virus"
iptables -I INPUT -m string --string "virus" --algo kmp -j DROP

# "VIRUS"ã€"Virus"ä¸ä¼šè¢«åŒ¹é…
```

**å¿½ç•¥å¤§å°å†™åŒ¹é…**ï¼š
```bash
# åŒ¹é…æ‰€æœ‰å¤§å°å†™ç»„åˆ
iptables -I INPUT -m string --string "virus" --algo kmp --icase -j DROP

# "virus"ã€"VIRUS"ã€"Virus"éƒ½ä¼šè¢«åŒ¹é…
```

---

## 3. ğŸŒ HTTPå†…å®¹è¿‡æ»¤å®æˆ˜


### 3.1 é˜»æ­¢ç‰¹å®šç½‘ç«™è®¿é—®


**åœºæ™¯è¯´æ˜**ï¼š
å…¬å¸è¦æ±‚é˜»æ­¢å‘˜å·¥è®¿é—®ç¤¾äº¤ç½‘ç«™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ£€æŸ¥HTTPè¯·æ±‚ä¸­çš„Hostå¤´éƒ¨æ¥å®ç°ã€‚

**å®é™…é…ç½®**ï¼š
```bash
# é˜»æ­¢è®¿é—®Facebook
iptables -I FORWARD -m string --string "Host: www.facebook.com" --algo kmp -j DROP

# é˜»æ­¢è®¿é—®å¾®åš
iptables -I FORWARD -m string --string "Host: weibo.com" --algo kmp -j DROP

# é˜»æ­¢è®¿é—®æŠ–éŸ³ç½‘é¡µç‰ˆ
iptables -I FORWARD -m string --string "Host: www.douyin.com" --algo kmp -j DROP
```

**å·¥ä½œåŸç†è§£é‡Š**ï¼š
```
HTTPè¯·æ±‚ç¤ºä¾‹ï¼š
GET / HTTP/1.1
Host: www.facebook.com    â† iptablesæ£€æŸ¥è¿™ä¸€è¡Œ
User-Agent: Mozilla/5.0...

å½“iptableså‘ç°"Host: www.facebook.com"è¿™ä¸ªå­—ç¬¦ä¸²æ—¶ï¼Œ
å°±ä¼šæ‰§è¡ŒDROPåŠ¨ä½œï¼Œé˜»æ­¢è¿™ä¸ªè¯·æ±‚ã€‚
```

### 3.2 è¿‡æ»¤æ¶æ„è½¯ä»¶ä¸‹è½½


**é˜²æŠ¤ç›®æ ‡**ï¼šé˜»æ­¢ç”¨æˆ·ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶å’Œè„šæœ¬æ–‡ä»¶

**é…ç½®ç¤ºä¾‹**ï¼š
```bash
# é˜»æ­¢ä¸‹è½½exeæ–‡ä»¶
iptables -I FORWARD -m string --string ".exe" --algo kmp -j DROP

# é˜»æ­¢ä¸‹è½½è„šæœ¬æ–‡ä»¶
iptables -I FORWARD -m string --string ".bat" --algo kmp -j DROP
iptables -I FORWARD -m string --string ".ps1" --algo kmp -j DROP

# é˜»æ­¢ä¸‹è½½å‹ç¼©åŒ…ï¼ˆå¯èƒ½åŒ…å«ç—…æ¯’ï¼‰
iptables -I FORWARD -m string --string ".rar" --algo kmp -j DROP
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**ï¼šè¿™ç§æ–¹æ³•åªèƒ½æ£€æŸ¥æ–‡ä»¶åï¼Œä¸èƒ½æ£€æŸ¥æ–‡ä»¶å†…å®¹ã€‚æ¶æ„è½¯ä»¶å¯èƒ½ä¼ªè£…æˆå…¶ä»–æ–‡ä»¶ç±»å‹ã€‚

### 3.3 å†…å®¹å®‰å…¨è¿‡æ»¤


**æ•æ„Ÿè¯è¿‡æ»¤**ï¼š
```bash
# è¿‡æ»¤ä¸å½“å†…å®¹å…³é”®è¯
iptables -I FORWARD -m string --string "gambling" --algo kmp --icase -j DROP
iptables -I FORWARD -m string --string "illegal" --algo kmp --icase -j DROP

# è¿‡æ»¤å•†ä¸šæœºå¯†ç›¸å…³
iptables -I FORWARD -m string --string "confidential" --algo kmp --icase -j DROP
```

---

## 4. ğŸ“ URLè·¯å¾„è¿‡æ»¤é…ç½®


### 4.1 é˜»æ­¢ç‰¹å®šé¡µé¢è®¿é—®


**åº”ç”¨åœºæ™¯**ï¼šé˜»æ­¢è®¿é—®ç½‘ç«™çš„ç‰¹å®šåŠŸèƒ½é¡µé¢

**URLç»“æ„è§£æ**ï¼š
```
å®Œæ•´URLï¼šhttps://www.example.com/admin/login.php?user=admin
                                   â†‘
                              è·¯å¾„éƒ¨åˆ†
HTTPè¯·æ±‚ä¸­çš„è¡¨ç°ï¼š
GET /admin/login.php?user=admin HTTP/1.1
    â†‘
iptableså¯ä»¥æ£€æŸ¥è¿™éƒ¨åˆ†
```

**å®é™…é…ç½®**ï¼š
```bash
# é˜»æ­¢è®¿é—®ç®¡ç†å‘˜é¡µé¢
iptables -I FORWARD -m string --string "GET /admin" --algo kmp -j DROP

# é˜»æ­¢æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
iptables -I FORWARD -m string --string "POST /upload" --algo kmp -j DROP

# é˜»æ­¢ç”¨æˆ·æ³¨å†Œé¡µé¢
iptables -I FORWARD -m string --string "/register.php" --algo kmp -j DROP
```

### 4.2 APIæ¥å£ä¿æŠ¤


**ä¿æŠ¤æ•æ„ŸAPI**ï¼š
```bash
# é˜»æ­¢è®¿é—®ç”¨æˆ·æ•°æ®API
iptables -I FORWARD -m string --string "/api/users" --algo kmp -j DROP

# é˜»æ­¢è®¿é—®è´¢åŠ¡æ•°æ®API
iptables -I FORWARD -m string --string "/api/finance" --algo kmp -j DROP

# å…è®¸å…¬å¼€APIï¼Œé˜»æ­¢ç§æœ‰API
iptables -I FORWARD -m string --string "/api/private" --algo kmp -j DROP
```

### 4.3 æ–‡ä»¶ç±»å‹é™åˆ¶


**é™åˆ¶æ–‡ä»¶è®¿é—®**ï¼š
```bash
# é˜»æ­¢è®¿é—®é…ç½®æ–‡ä»¶
iptables -I FORWARD -m string --string ".conf" --algo kmp -j DROP
iptables -I FORWARD -m string --string ".ini" --algo kmp -j DROP

# é˜»æ­¢è®¿é—®æ•°æ®åº“å¤‡ä»½
iptables -I FORWARD -m string --string ".sql" --algo kmp -j DROP
iptables -I FORWARD -m string --string ".dump" --algo kmp -j DROP
```

---

## 5. ğŸ”‘ å…³é”®è¯è¿‡æ»¤è®¾ç½®


### 5.1 é‚®ä»¶å†…å®¹è¿‡æ»¤


**åƒåœ¾é‚®ä»¶å…³é”®è¯**ï¼š
```bash
# è¿‡æ»¤åƒåœ¾é‚®ä»¶å¸¸è§è¯æ±‡
iptables -I FORWARD -p tcp --dport 25 -m string --string "viagra" --algo kmp --icase -j DROP
iptables -I FORWARD -p tcp --dport 25 -m string --string "lottery" --algo kmp --icase -j DROP
iptables -I FORWARD -p tcp --dport 25 -m string --string "winner" --algo kmp --icase -j DROP
```

**è§£é‡Šè¯´æ˜**ï¼š
- `--dport 25`ï¼šåªæ£€æŸ¥SMTPé‚®ä»¶æµé‡ï¼ˆç«¯å£25ï¼‰
- `--icase`ï¼šå¿½ç•¥å¤§å°å†™ï¼Œ"VIAGRA"å’Œ"viagra"éƒ½ä¼šè¢«åŒ¹é…

### 5.2 èŠå¤©å†…å®¹ç›‘æ§


**å³æ—¶é€šè®¯è¿‡æ»¤**ï¼š
```bash
# è¿‡æ»¤ä¸å½“èŠå¤©å†…å®¹ï¼ˆç¤ºä¾‹ï¼Œå®é™…éœ€è¦åŠ å¯†å¤„ç†ï¼‰
iptables -I FORWARD -m string --string "password" --algo kmp --icase -j LOG --log-prefix "PASSWORD_LEAK: "

# ç›‘æ§æ•æ„Ÿä¿¡æ¯ä¼ è¾“
iptables -I FORWARD -m string --string "credit card" --algo kmp --icase -j LOG --log-prefix "SENSITIVE_INFO: "
```

> ğŸ’¡ **å®é™…åº”ç”¨è¯´æ˜**ï¼šç°ä»£èŠå¤©è½¯ä»¶å¤§å¤šä½¿ç”¨åŠ å¯†ä¼ è¾“ï¼Œå­—ç¬¦ä¸²åŒ¹é…å¯èƒ½æ— æ³•ç›´æ¥è¯»å–èŠå¤©å†…å®¹ã€‚

### 5.3 æ–‡ä»¶ä¼ è¾“ç›‘æ§


**æ•æ„Ÿæ–‡ä»¶åæ£€æµ‹**ï¼š
```bash
# æ£€æµ‹å¯ç–‘æ–‡ä»¶ä¼ è¾“
iptables -I FORWARD -m string --string "password.txt" --algo kmp --icase -j LOG
iptables -I FORWARD -m string --string "userlist.csv" --algo kmp --icase -j LOG
iptables -I FORWARD -m string --string "database.sql" --algo kmp --icase -j LOG
```

---

## 6. ğŸš€ ç®—æ³•é€‰æ‹©ä¸æ€§èƒ½


### 6.1 æ€§èƒ½å¯¹æ¯”åˆ†æ


**ç®—æ³•æ€§èƒ½è¡¨ç°**ï¼š

| ç®—æ³•ç±»å‹ | **çŸ­å­—ç¬¦ä¸²(<10å­—ç¬¦)** | **ä¸­ç­‰å­—ç¬¦ä¸²(10-50å­—ç¬¦)** | **é•¿å­—ç¬¦ä¸²(>50å­—ç¬¦)** | **å†…å­˜ä½¿ç”¨** |
|---------|-------------------|------------------------|------------------|------------|
| **KMP** | â­â­â­ | â­â­â­ | â­â­ | `ä½` |
| **BM** | â­â­ | â­â­â­ | â­â­â­â­ | `ä¸­ç­‰` |

### 6.2 ç®—æ³•é€‰æ‹©æŒ‡å¯¼


**ğŸ”¸ é€‰æ‹©KMPç®—æ³•çš„æƒ…å†µ**ï¼š
```
âœ… æœç´¢çŸ­å…³é”®è¯ï¼ˆå¦‚ï¼šexeã€batã€pdfï¼‰
âœ… æœåŠ¡å™¨å†…å­˜æœ‰é™
âœ… ç½‘ç»œæµé‡ä¸å¤§
âœ… ç®€å•çš„å†…å®¹è¿‡æ»¤éœ€æ±‚

ç¤ºä¾‹é…ç½®ï¼š
iptables -I FORWARD -m string --string ".exe" --algo kmp -j DROP
```

**ğŸ”¸ é€‰æ‹©BMç®—æ³•çš„æƒ…å†µ**ï¼š
```
âœ… æœç´¢é•¿å­—ç¬¦ä¸²ï¼ˆå¦‚ï¼šå®Œæ•´URLã€é‚®ä»¶å¤´éƒ¨ï¼‰
âœ… æœåŠ¡å™¨æ€§èƒ½è¾ƒå¥½
âœ… ç½‘ç»œæµé‡è¾ƒå¤§
âœ… å¤æ‚çš„å†…å®¹åˆ†æéœ€æ±‚

ç¤ºä¾‹é…ç½®ï¼š
iptables -I FORWARD -m string --string "Mozilla/5.0 (Windows NT 10.0; Win64; x64)" --algo bm -j DROP
```

### 6.3 æ€§èƒ½ä¼˜åŒ–å»ºè®®


**ğŸ”§ ä¼˜åŒ–ç­–ç•¥**ï¼š

1. **è§„åˆ™é¡ºåºä¼˜åŒ–**ï¼š
```bash
# é”™è¯¯åšæ³•ï¼šå…ˆæ£€æŸ¥å¤æ‚å­—ç¬¦ä¸²
iptables -I FORWARD -m string --string "very long string here..." --algo bm -j DROP
iptables -I FORWARD -p tcp --dport 80 -j DROP

# æ­£ç¡®åšæ³•ï¼šå…ˆç”¨ç®€å•æ¡ä»¶è¿‡æ»¤
iptables -I FORWARD -p tcp --dport 80 -j DROP
iptables -I FORWARD -m string --string "very long string here..." --algo bm -j DROP
```

2. **åˆç†ä½¿ç”¨é“¾**ï¼š
```bash
# åˆ›å»ºä¸“é—¨çš„å†…å®¹è¿‡æ»¤é“¾
iptables -N CONTENT_FILTER

# åªå¯¹HTTPæµé‡ä½¿ç”¨å­—ç¬¦ä¸²åŒ¹é…
iptables -I FORWARD -p tcp --dport 80 -j CONTENT_FILTER
iptables -A CONTENT_FILTER -m string --string "malware" --algo kmp -j DROP
```

---

## 7. ğŸ¯ å®é™…åº”ç”¨åœºæ™¯


### 7.1 ä¼ä¸šç½‘ç»œç®¡ç†


**åœºæ™¯ä¸€ï¼šå‘˜å·¥ä¸Šç½‘è¡Œä¸ºç®¡ç†**
```bash
#!/bin/bash
# ä¼ä¸šç½‘ç»œå†…å®¹è¿‡æ»¤è„šæœ¬

# é˜»æ­¢ç¤¾äº¤ç½‘ç«™
iptables -I FORWARD -m string --string "facebook.com" --algo kmp -j DROP
iptables -I FORWARD -m string --string "twitter.com" --algo kmp -j DROP

# é˜»æ­¢åœ¨çº¿æ¸¸æˆ
iptables -I FORWARD -m string --string "steam" --algo kmp --icase -j DROP
iptables -I FORWARD -m string --string "game" --algo kmp --icase -j DROP

# é˜»æ­¢æ–‡ä»¶ä¸‹è½½
iptables -I FORWARD -m string --string ".torrent" --algo kmp -j DROP

echo "ä¼ä¸šç½‘ç»œè¿‡æ»¤è§„åˆ™å·²ç”Ÿæ•ˆ"
```

### 7.2 å®¶åº­ç½‘ç»œä¿æŠ¤


**åœºæ™¯äºŒï¼šå®¶é•¿æ§åˆ¶**
```bash
# ä¿æŠ¤å„¿ç«¥ä¸Šç½‘å®‰å…¨
iptables -I FORWARD -m string --string "adult" --algo kmp --icase -j DROP
iptables -I FORWARD -m string --string "violence" --algo kmp --icase -j DROP

# å­¦ä¹ æ—¶é—´é™åˆ¶æ¸¸æˆ
iptables -I FORWARD -m string --string "online game" --algo kmp --icase -j DROP
```

### 7.3 æœåŠ¡å™¨å®‰å…¨é˜²æŠ¤


**åœºæ™¯ä¸‰ï¼šWebæœåŠ¡å™¨ä¿æŠ¤**
```bash
# é˜»æ­¢SQLæ³¨å…¥æ”»å‡»
iptables -I INPUT -p tcp --dport 80 -m string --string "union select" --algo kmp --icase -j DROP
iptables -I INPUT -p tcp --dport 80 -m string --string "drop table" --algo kmp --icase -j DROP

# é˜»æ­¢XSSæ”»å‡»
iptables -I INPUT -p tcp --dport 80 -m string --string "<script>" --algo kmp --icase -j DROP

# é˜»æ­¢ç›®å½•éå†æ”»å‡»
iptables -I INPUT -p tcp --dport 80 -m string --string "../" --algo kmp -j DROP
```

### 7.4 ç›‘æ§å’Œæ—¥å¿—è®°å½•


**é‡è¦æ´»åŠ¨ç›‘æ§**ï¼š
```bash
# ç›‘æ§æ•æ„Ÿæ“ä½œï¼ˆè®°å½•æ—¥å¿—ä½†ä¸é˜»æ­¢ï¼‰
iptables -I FORWARD -m string --string "password" --algo kmp --icase -j LOG --log-prefix "PASSWORD_ACCESS: "

# ç›‘æ§æ–‡ä»¶ä¸‹è½½æ´»åŠ¨
iptables -I FORWARD -m string --string "Content-Disposition: attachment" --algo kmp -j LOG --log-prefix "FILE_DOWNLOAD: "
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ å­—ç¬¦ä¸²åŒ¹é…ï¼šiptablesæ£€æŸ¥æ•°æ®åŒ…å†…å®¹çš„åŠŸèƒ½
ğŸ”¸ -m stringï¼šå¯ç”¨å­—ç¬¦ä¸²åŒ¹é…æ¨¡å—çš„å…³é”®å‚æ•°
ğŸ”¸ --stringï¼šæŒ‡å®šè¦æœç´¢çš„å…·ä½“æ–‡å­—å†…å®¹
ğŸ”¸ --algoï¼šé€‰æ‹©æœç´¢ç®—æ³•ï¼ˆkmpæˆ–bmï¼‰
ğŸ”¸ --icaseï¼šå¿½ç•¥å¤§å°å†™é€‰é¡¹
```

### 8.2 å®ç”¨é…ç½®æ¨¡æ¿


**ğŸ”¹ åŸºç¡€å†…å®¹è¿‡æ»¤æ¨¡æ¿**ï¼š
```bash
# ç½‘ç«™è®¿é—®æ§åˆ¶
iptables -I FORWARD -m string --string "Host: è¢«ç¦ç½‘ç«™" --algo kmp -j DROP

# æ–‡ä»¶ä¸‹è½½é™åˆ¶
iptables -I FORWARD -m string --string ".ç¦æ­¢æ‰©å±•å" --algo kmp -j DROP

# å…³é”®è¯è¿‡æ»¤
iptables -I FORWARD -m string --string "æ•æ„Ÿè¯æ±‡" --algo kmp --icase -j DROP
```

### 8.3 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ å­—ç¬¦ä¸²åŒ¹é…çš„å±€é™æ€§**ï¼š
```
åªèƒ½æ£€æŸ¥æ˜æ–‡ä¼ è¾“çš„å†…å®¹
æ— æ³•æ£€æŸ¥åŠ å¯†çš„HTTPSæµé‡
éœ€è¦æ¶ˆè€—è¾ƒå¤šCPUèµ„æº
å¯èƒ½å½±å“ç½‘ç»œæ€§èƒ½
```

**ğŸ”¹ ç®—æ³•é€‰æ‹©åŸåˆ™**ï¼š
```
çŸ­å­—ç¬¦ä¸² â†’ é€‰æ‹©KMPç®—æ³•
é•¿å­—ç¬¦ä¸² â†’ é€‰æ‹©BMç®—æ³•
å†…å­˜æœ‰é™ â†’ ä¼˜å…ˆKMPç®—æ³•
æ€§èƒ½è¦æ±‚é«˜ â†’ æ ¹æ®å­—ç¬¦ä¸²é•¿åº¦é€‰æ‹©
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–è¦ç‚¹**ï¼š
```
è§„åˆ™æ”¾ç½®é¡ºåºå¾ˆé‡è¦
é¿å…è¿‡å¤šå­—ç¬¦ä¸²åŒ¹é…è§„åˆ™
åˆç†ä½¿ç”¨è‡ªå®šä¹‰é“¾
å®šæœŸæ¸…ç†æ— ç”¨è§„åˆ™
```

### 8.4 å®é™…åº”ç”¨ä»·å€¼


- **ä¼ä¸šç®¡ç†**ï¼šå‘˜å·¥ä¸Šç½‘è¡Œä¸ºæ§åˆ¶ï¼Œæé«˜å·¥ä½œæ•ˆç‡
- **å®¶åº­ä¿æŠ¤**ï¼šå„¿ç«¥ä¸Šç½‘å®‰å…¨ï¼Œè¿‡æ»¤ä¸è‰¯å†…å®¹  
- **æœåŠ¡å™¨å®‰å…¨**ï¼šé˜²æ­¢Webæ”»å‡»ï¼Œä¿æŠ¤ç³»ç»Ÿå®‰å…¨
- **ç½‘ç»œç›‘æ§**ï¼šæ•æ„Ÿä¿¡æ¯ä¼ è¾“ç›‘æ§ï¼Œå®‰å…¨å®¡è®¡

### 8.5 æ³¨æ„äº‹é¡¹å’Œé™åˆ¶


> âš ï¸ **é‡è¦æé†’**ï¼š
> - å­—ç¬¦ä¸²åŒ¹é…ä¼šæ¶ˆè€—è¾ƒå¤šç³»ç»Ÿèµ„æº
> - æ— æ³•æ£€æŸ¥åŠ å¯†æµé‡ï¼ˆå¦‚HTTPSï¼‰
> - æ¶æ„ç”¨æˆ·å¯èƒ½é€šè¿‡ç¼–ç ç»•è¿‡æ£€æµ‹
> - éœ€è¦æ ¹æ®å®é™…éœ€æ±‚å¹³è¡¡å®‰å…¨æ€§å’Œæ€§èƒ½

**æ ¸å¿ƒè®°å¿†**ï¼š
- å­—ç¬¦ä¸²åŒ¹é…æ˜¯å†…å®¹çº§åˆ«çš„ç½‘ç»œè¿‡æ»¤
- åˆç†é€‰æ‹©ç®—æ³•èƒ½å¤Ÿä¼˜åŒ–æ€§èƒ½è¡¨ç°  
- é€‚ç”¨äºæ˜æ–‡åè®®çš„å†…å®¹å®‰å…¨ç®¡æ§
- ä¼ä¸šç½‘ç»œç®¡ç†çš„é‡è¦å®‰å…¨å·¥å…·