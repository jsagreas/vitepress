---
title: 4ã€å¤šå®¹å™¨åº”ç”¨é…ç½®å®è·µ
---
## ğŸ“š ç›®å½•

1. [Webåº”ç”¨å¤šå±‚æ¶æ„è®¾è®¡](#1-Webåº”ç”¨å¤šå±‚æ¶æ„è®¾è®¡)
2. [å‰ç«¯åç«¯æ•°æ®åº“å®¹å™¨é…ç½®](#2-å‰ç«¯åç«¯æ•°æ®åº“å®¹å™¨é…ç½®)
3. [å®¹å™¨é—´ç½‘ç»œé€šä¿¡é…ç½®](#3-å®¹å™¨é—´ç½‘ç»œé€šä¿¡é…ç½®)
4. [æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡](#4-æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡)
5. [æŒä¹…åŒ–æ•°æ®å­˜å‚¨ç­–ç•¥](#5-æŒä¹…åŒ–æ•°æ®å­˜å‚¨ç­–ç•¥)
6. [é…ç½®æ–‡ä»¶å¤–éƒ¨åŒ–ç®¡ç†](#6-é…ç½®æ–‡ä»¶å¤–éƒ¨åŒ–ç®¡ç†)
7. [å®¹å™¨å¥åº·æ£€æŸ¥é…ç½®](#7-å®¹å™¨å¥åº·æ£€æŸ¥é…ç½®)
8. [å¯åŠ¨é¡ºåºä¾èµ–ç®¡ç†](#8-å¯åŠ¨é¡ºåºä¾èµ–ç®¡ç†)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ—ï¸ Webåº”ç”¨å¤šå±‚æ¶æ„è®¾è®¡


### 1.1 ä»€ä¹ˆæ˜¯å¤šå±‚æ¶æ„


ğŸ’­ **ç®€å•ç†è§£**ï¼šå°±åƒç›–æ¥¼æˆ¿ä¸€æ ·ï¼Œæ¯ä¸€å±‚éƒ½æœ‰ä¸åŒçš„åŠŸèƒ½

```
ä¼ ç»ŸWebåº”ç”¨æ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    å‰ç«¯å±•ç¤ºå±‚       â”‚ â† ç”¨æˆ·çœ‹åˆ°çš„ç•Œé¢ï¼ˆHTML/CSS/JSï¼‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    åç«¯ä¸šåŠ¡å±‚       â”‚ â† å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼ˆAPIæ¥å£ï¼‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    æ•°æ®å­˜å‚¨å±‚       â”‚ â† ä¿å­˜æ•°æ®ï¼ˆæ•°æ®åº“ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ¯ä¸€å±‚éƒ½å¯ä»¥ç‹¬ç«‹è¿è¡Œåœ¨ä¸åŒçš„å®¹å™¨ä¸­ï¼
```

ğŸ” **ä¸ºä»€ä¹ˆè¦åˆ†å±‚**ï¼š
- **èŒè´£åˆ†ç¦»**ï¼šæ¯å±‚ä¸“æ³¨è‡ªå·±çš„äº‹æƒ…
- **ç‹¬ç«‹æ‰©å±•**ï¼šå“ªå±‚å‹åŠ›å¤§å°±æ‰©å±•å“ªå±‚
- **æŠ€æœ¯çµæ´»**ï¼šå‰ç«¯ç”¨Reactï¼Œåç«¯ç”¨Node.jsï¼Œæ•°æ®åº“ç”¨MySQL
- **ç»´æŠ¤æ–¹ä¾¿**ï¼šä¿®æ”¹ä¸€å±‚ä¸å½±å“å…¶ä»–å±‚

### 1.2 å®¹å™¨åŒ–å¤šå±‚æ¶æ„çš„ä¼˜åŠ¿


**ä¼ ç»Ÿéƒ¨ç½² vs å®¹å™¨åŒ–éƒ¨ç½²**ï¼š

| æ–¹é¢ | **ä¼ ç»Ÿéƒ¨ç½²** | **å®¹å™¨åŒ–éƒ¨ç½²** |
|------|------------|---------------|
| ğŸ  **ç¯å¢ƒ** | éœ€è¦é…ç½®å¤æ‚çš„æœåŠ¡å™¨ç¯å¢ƒ | æ¯ä¸ªå®¹å™¨éƒ½æ˜¯ç‹¬ç«‹çš„è¿è¡Œç¯å¢ƒ |
| ğŸ”„ **æ‰©å±•** | æ•´ä¸ªåº”ç”¨ä¸€èµ·æ‰©å±•ï¼Œæµªè´¹èµ„æº | æŒ‰éœ€æ‰©å±•å•ä¸ªæœåŠ¡ï¼Œèµ„æºåˆ©ç”¨ç‡é«˜ |
| ğŸ› ï¸ **ç»´æŠ¤** | æ›´æ–°ä¸€ä¸ªç»„ä»¶å¯èƒ½å½±å“æ•´ä¸ªç³»ç»Ÿ | æ›´æ–°å•ä¸ªå®¹å™¨ï¼Œä¸å½±å“å…¶ä»–æœåŠ¡ |
| ğŸš€ **éƒ¨ç½²** | éƒ¨ç½²å¤æ‚ï¼Œå®¹æ˜“å‡ºé”™ | æ ‡å‡†åŒ–éƒ¨ç½²ï¼Œä¸€é”®å¯åŠ¨ |

ğŸŒ° **ä¸¾ä¸ªä¾‹å­**ï¼š
```
ç”µå•†ç½‘ç«™çš„å®¹å™¨åŒ–æ¶æ„ï¼š
- å‰ç«¯å®¹å™¨ï¼šå±•ç¤ºå•†å“é¡µé¢
- åç«¯å®¹å™¨ï¼šå¤„ç†ä¸‹å•ã€æ”¯ä»˜é€»è¾‘  
- æ•°æ®åº“å®¹å™¨ï¼šå­˜å‚¨å•†å“ä¿¡æ¯ã€è®¢å•æ•°æ®
- ç¼“å­˜å®¹å™¨ï¼šRedisç¼“å­˜çƒ­é—¨å•†å“ä¿¡æ¯

åŒ11æµé‡å¤§æ—¶ï¼Œåªéœ€è¦å¤šå¯åŠ¨å‡ ä¸ªå‰ç«¯å’Œåç«¯å®¹å™¨ï¼
```

### 1.3 æ¶æ„è®¾è®¡åŸåˆ™


ğŸ¯ **æ ¸å¿ƒåŸåˆ™**ï¼š

**ğŸ“‹ å•ä¸€èŒè´£**ï¼š
- æ¯ä¸ªå®¹å™¨åªåšä¸€ä»¶äº‹æƒ…
- å‰ç«¯å®¹å™¨åªè´Ÿè´£é¡µé¢å±•ç¤º
- åç«¯å®¹å™¨åªè´Ÿè´£ä¸šåŠ¡å¤„ç†
- æ•°æ®åº“å®¹å™¨åªè´Ÿè´£æ•°æ®å­˜å‚¨

**ğŸ”— æ¾è€¦åˆ**ï¼š
- å®¹å™¨ä¹‹é—´é€šè¿‡ç½‘ç»œAPIé€šä¿¡
- ä¸ç›´æ¥è®¿é—®å…¶ä»–å®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿ
- å¯ä»¥ç‹¬ç«‹å¯åŠ¨ã€åœæ­¢ã€æ›´æ–°

**ğŸ“ˆ å¯æ‰©å±•**ï¼š
- æ ¹æ®è´Ÿè½½æƒ…å†µåŠ¨æ€å¢å‡å®¹å™¨æ•°é‡
- æ”¯æŒæ°´å¹³æ‰©å±•å’Œå‚ç›´æ‰©å±•

---

## 2. âš™ï¸ å‰ç«¯åç«¯æ•°æ®åº“å®¹å™¨é…ç½®


### 2.1 å‰ç«¯å®¹å™¨é…ç½®


ğŸ’¡ **å‰ç«¯å®¹å™¨çš„ä½œç”¨**ï¼šä¸ºç”¨æˆ·æä¾›Webé¡µé¢å’Œäº¤äº’ç•Œé¢

**åŸºæœ¬é…ç½®ç¤ºä¾‹**ï¼š
```yaml
# docker-compose.yml ä¸­çš„å‰ç«¯æœåŠ¡
frontend:
  image: nginx:alpine
  container_name: web-frontend
  ports:
    - "80:80"    # å¯¹å¤–å¼€æ”¾80ç«¯å£
  volumes:
    - ./dist:/usr/share/nginx/html  # æŒ‚è½½å‰ç«¯ä»£ç 
    - ./nginx.conf:/etc/nginx/nginx.conf  # è‡ªå®šä¹‰nginxé…ç½®
```

ğŸ”§ **å‰ç«¯å®¹å™¨çš„å…³é”®é…ç½®**ï¼š
- **ç«¯å£æ˜ å°„**ï¼š`80:80` è®©ç”¨æˆ·é€šè¿‡æµè§ˆå™¨è®¿é—®
- **é™æ€æ–‡ä»¶**ï¼šå°†æ„å»ºå¥½çš„å‰ç«¯ä»£ç æ”¾åˆ°å®¹å™¨ä¸­
- **åå‘ä»£ç†**ï¼šé…ç½®nginxè½¬å‘APIè¯·æ±‚åˆ°åç«¯å®¹å™¨

### 2.2 åç«¯å®¹å™¨é…ç½®


ğŸ·ï¸ **åç«¯å®¹å™¨çš„ä½œç”¨**ï¼šå¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œæä¾›APIæ¥å£

```yaml
backend:
  build: ./backend          # ä»æœ¬åœ°ä»£ç æ„å»ºé•œåƒ
  container_name: web-backend
  ports:
    - "3000:3000"          # APIæœåŠ¡ç«¯å£
  environment:
    - NODE_ENV=production   # ç¯å¢ƒå˜é‡
    - DATABASE_URL=mongodb://db:27017/myapp
  depends_on:
    - database             # ä¾èµ–æ•°æ®åº“å…ˆå¯åŠ¨
```

ğŸ”‘ **åç«¯é…ç½®é‡ç‚¹**ï¼š
- **ç¯å¢ƒå˜é‡**ï¼šæ•°æ®åº“è¿æ¥ã€APIå¯†é’¥ç­‰æ•æ„Ÿä¿¡æ¯
- **ä¾èµ–å…³ç³»**ï¼š`depends_on` ç¡®ä¿æ•°æ®åº“å…ˆå¯åŠ¨
- **å†…éƒ¨é€šä¿¡**ï¼šé€šè¿‡å®¹å™¨åè®¿é—®å…¶ä»–æœåŠ¡ï¼ˆå¦‚`db:27017`ï¼‰

### 2.3 æ•°æ®åº“å®¹å™¨é…ç½®


ğŸ—„ï¸ **æ•°æ®åº“å®¹å™¨çš„ä½œç”¨**ï¼šæŒä¹…åŒ–å­˜å‚¨åº”ç”¨æ•°æ®

```yaml
database:
  image: mysql:8.0
  container_name: web-database
  environment:
    MYSQL_ROOT_PASSWORD: rootpassword
    MYSQL_DATABASE: myapp
    MYSQL_USER: appuser
    MYSQL_PASSWORD: apppassword
  volumes:
    - db_data:/var/lib/mysql    # æŒä¹…åŒ–æ•°æ®
  ports:
    - "3306:3306"              # å¯é€‰ï¼šå¯¹å¤–å¼€æ”¾ï¼ˆå¼€å‘ç”¨ï¼‰
```

ğŸš¨ **æ•°æ®åº“é…ç½®é‡è¦æé†’**ï¼š
- **æ•°æ®æŒä¹…åŒ–**ï¼šå¿…é¡»ä½¿ç”¨volumesï¼Œå¦åˆ™å®¹å™¨é‡å¯æ•°æ®ä¸¢å¤±
- **å¯†ç å®‰å…¨**ï¼šç”Ÿäº§ç¯å¢ƒä¸è¦æŠŠå¯†ç å†™åœ¨é…ç½®æ–‡ä»¶é‡Œ
- **ç«¯å£å®‰å…¨**ï¼šç”Ÿäº§ç¯å¢ƒä¸è¦å¯¹å¤–å¼€æ”¾æ•°æ®åº“ç«¯å£

### 2.4 å®Œæ•´çš„ä¸‰å±‚æ¶æ„ç¤ºä¾‹


```yaml
version: '3.8'

services:
  # å‰ç«¯æœåŠ¡
  frontend:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./frontend/dist:/usr/share/nginx/html
    depends_on:
      - backend

  # åç«¯æœåŠ¡  
  backend:
    build: ./backend
    ports:
      - "3000:3000"
    environment:
      - DB_HOST=database
      - DB_NAME=myapp
    depends_on:
      - database

  # æ•°æ®åº“æœåŠ¡
  database:
    image: mysql:8.0
    environment:
      MYSQL_ROOT_PASSWORD: secret
      MYSQL_DATABASE: myapp
    volumes:
      - mysql_data:/var/lib/mysql

volumes:
  mysql_data:    # å£°æ˜æ•°æ®æŒä¹…åŒ–å·
```

---

## 3. ğŸŒ å®¹å™¨é—´ç½‘ç»œé€šä¿¡é…ç½®


### 3.1 å®¹å™¨ç½‘ç»œåŸºç¡€æ¦‚å¿µ


ğŸ¤” **ä¸ºä»€ä¹ˆéœ€è¦å®¹å™¨ç½‘ç»œ**ï¼šå®¹å™¨å°±åƒä¸åŒçš„æˆ¿é—´ï¼Œéœ€è¦ç½‘ç»œæ¥äº’ç›¸é€šè¯

ğŸ’­ **Dockerç½‘ç»œç±»å‹**ï¼š
```
Dockerç½‘ç»œæ¨¡å¼ï¼š

Bridgeç½‘ç»œï¼ˆé»˜è®¤ï¼‰ï¼š
å®¹å™¨A â†â†’ Bridge â†â†’ å®¹å™¨B
â”‚                    â”‚
â”œâ”€â”€â”€ 172.18.0.2     â””â”€â”€â”€ 172.18.0.3
â””â”€â”€â”€ frontend            backend

Hostç½‘ç»œï¼š
å®¹å™¨ç›´æ¥ä½¿ç”¨å®¿ä¸»æœºç½‘ç»œï¼ˆä¸æ¨èç”Ÿäº§ç¯å¢ƒï¼‰

Customç½‘ç»œï¼š
è‡ªå®šä¹‰ç½‘ç»œï¼Œæ›´å¥½çš„éš”ç¦»å’Œå‘½å
```

### 3.2 Docker Composeç½‘ç»œé…ç½®


âœ… **é»˜è®¤ç½‘ç»œè¡Œä¸º**ï¼š
- Docker Composeè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªç½‘ç»œ
- æ‰€æœ‰æœåŠ¡éƒ½åŠ å…¥è¿™ä¸ªç½‘ç»œ
- æœåŠ¡ä¹‹é—´å¯ä»¥é€šè¿‡**æœåŠ¡å**äº’ç›¸è®¿é—®

ğŸŒ° **å®é™…é€šä¿¡ç¤ºä¾‹**ï¼š
```yaml
services:
  frontend:
    image: nginx
    # å¯ä»¥é€šè¿‡ http://backend:3000 è®¿é—®åç«¯

  backend:
    image: node:16
    # å¯ä»¥é€šè¿‡ database:3306 è®¿é—®æ•°æ®åº“
    
  database:
    image: mysql:8.0
    # å…¶ä»–å®¹å™¨é€šè¿‡ database:3306 è¿æ¥
```

ğŸ” **æœåŠ¡å‘ç°æœºåˆ¶**ï¼š
- å®¹å™¨å = åŸŸå
- `backend` å®¹å™¨å¯ä»¥é€šè¿‡ `http://frontend` è®¿é—®å‰ç«¯
- `frontend` å®¹å™¨å¯ä»¥é€šè¿‡ `http://backend:3000` è®¿é—®åç«¯API

### 3.3 è‡ªå®šä¹‰ç½‘ç»œé…ç½®


**ä¸ºä»€ä¹ˆéœ€è¦è‡ªå®šä¹‰ç½‘ç»œ**ï¼š
- **å®‰å…¨éš”ç¦»**ï¼šä¸åŒé¡¹ç›®çš„å®¹å™¨ä¸èƒ½äº’ç›¸è®¿é—®
- **å‘½åç®¡ç†**ï¼šç»™ç½‘ç»œèµ·æœ‰æ„ä¹‰çš„åå­—
- **ç½‘ç»œç­–ç•¥**ï¼šæ›´ç²¾ç»†çš„è®¿é—®æ§åˆ¶

```yaml
version: '3.8'

networks:
  frontend-network:     # å‰ç«¯ç½‘ç»œ
  backend-network:      # åç«¯ç½‘ç»œ
  database-network:     # æ•°æ®åº“ç½‘ç»œ

services:
  frontend:
    image: nginx
    networks:
      - frontend-network
      
  backend:
    image: node:16
    networks:
      - frontend-network  # æ¥æ”¶å‰ç«¯è¯·æ±‚
      - backend-network   # è¿æ¥æ•°æ®åº“
      
  database:
    image: mysql:8.0
    networks:
      - backend-network   # åªå…è®¸åç«¯è®¿é—®
```

### 3.4 ç«¯å£æ˜ å°„å’Œå†…éƒ¨é€šä¿¡


ğŸ“Š **ç«¯å£é…ç½®è¯´æ˜**ï¼š

| é…ç½®æ–¹å¼ | **ç”¨é€”** | **ç¤ºä¾‹** | **è®¿é—®æ–¹å¼** |
|---------|---------|---------|-------------|
| `ports: "80:80"` | å¯¹å¤–æœåŠ¡ | å‰ç«¯WebæœåŠ¡ | æµè§ˆå™¨è®¿é—® `http://localhost` |
| `expose: 3000` | ä»…å†…éƒ¨è®¿é—® | åç«¯API | å…¶ä»–å®¹å™¨è®¿é—® `http://backend:3000` |
| æ— ç«¯å£é…ç½® | æ•°æ®åº“ç­‰å†…éƒ¨æœåŠ¡ | MySQL | ä»…å®¹å™¨å†…è®¿é—® `database:3306` |

ğŸ’¡ **æœ€ä½³å®è·µ**ï¼š
- **å‰ç«¯æœåŠ¡**ï¼šæ˜ å°„åˆ°ä¸»æœºç«¯å£ï¼Œç”¨æˆ·å¯è®¿é—®
- **åç«¯API**ï¼šå¯é€‰æ‹©æ˜ å°„ç«¯å£ï¼ˆå¼€å‘æ—¶æ–¹ä¾¿è°ƒè¯•ï¼‰
- **æ•°æ®åº“**ï¼šä¸æ˜ å°„ç«¯å£ï¼Œä»…å†…éƒ¨è®¿é—®æ›´å®‰å…¨

---

## 4. âš–ï¸ æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡


### 4.1 æœåŠ¡å‘ç°åŸºç¡€æ¦‚å¿µ


ğŸ·ï¸ **æœåŠ¡å‘ç°**ï¼šè®©å®¹å™¨èƒ½å¤Ÿè‡ªåŠ¨æ‰¾åˆ°å¹¶è¿æ¥åˆ°å…¶ä»–æœåŠ¡

```
ä¼ ç»Ÿæ–¹å¼ï¼š
å‰ç«¯ â†’ 192.168.1.100:3000 (åç«¯IPå†™æ­»)

å®¹å™¨æ–¹å¼ï¼š
å‰ç«¯ â†’ backend:3000 (é€šè¿‡æœåŠ¡åè‡ªåŠ¨è§£æ)
```

ğŸ” **Dockerå†…ç½®æœåŠ¡å‘ç°**ï¼š
- æ¯ä¸ªå®¹å™¨éƒ½æœ‰ä¸€ä¸ª**æœåŠ¡å**ï¼ˆservice nameï¼‰
- Dockerè‡ªåŠ¨å°†æœåŠ¡åè§£æä¸ºå®¹å™¨IP
- å®¹å™¨IPå˜åŒ–æ—¶ï¼ŒæœåŠ¡åè§£æè‡ªåŠ¨æ›´æ–°

### 4.2 è´Ÿè½½å‡è¡¡é…ç½®


ğŸ’­ **ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡**ï¼šå½“æœ‰å¤šä¸ªç›¸åŒçš„å®¹å™¨æ—¶ï¼Œè¯·æ±‚å¦‚ä½•åˆ†å‘

**ä½¿ç”¨Nginxå®ç°è´Ÿè½½å‡è¡¡**ï¼š
```yaml
services:
  nginx:
    image: nginx
    ports:
      - "80:80"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      
  backend:
    image: myapp:latest
    deploy:
      replicas: 3    # å¯åŠ¨3ä¸ªåç«¯å®¹å™¨å®ä¾‹
```

**Nginxé…ç½®æ–‡ä»¶ç¤ºä¾‹**ï¼š
```nginx
upstream backend_servers {
    server backend_1:3000;
    server backend_2:3000; 
    server backend_3:3000;
}

server {
    listen 80;
    location /api/ {
        proxy_pass http://backend_servers;
    }
}
```

### 4.3 å¥åº·æ£€æŸ¥ä¸æœåŠ¡æ³¨å†Œ


âš¡ **å¥åº·æ£€æŸ¥çš„ä½œç”¨**ï¼šç¡®ä¿åªæœ‰æ­£å¸¸å·¥ä½œçš„å®¹å™¨æ¥æ”¶è¯·æ±‚

```yaml
backend:
  image: myapp:latest
  healthcheck:
    test: ["CMD", "curl", "-f", "http://localhost:3000/health"]
    interval: 30s      # æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡
    timeout: 10s       # 10ç§’è¶…æ—¶
    retries: 3         # å¤±è´¥3æ¬¡è®¤ä¸ºä¸å¥åº·
    start_period: 40s  # å¯åŠ¨å40ç§’å¼€å§‹æ£€æŸ¥
```

ğŸ¯ **æœåŠ¡çŠ¶æ€ç®¡ç†**ï¼š
- **å¥åº·**ï¼šæ­£å¸¸æ¥æ”¶è¯·æ±‚
- **ä¸å¥åº·**ï¼šæš‚åœè½¬å‘è¯·æ±‚ï¼Œå°è¯•æ¢å¤
- **æ­»äº¡**ï¼šé‡å¯å®¹å™¨

---

## 5. ğŸ’¾ æŒä¹…åŒ–æ•°æ®å­˜å‚¨ç­–ç•¥


### 5.1 ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®æŒä¹…åŒ–


ğŸš¨ **é‡è¦ç†è§£**ï¼šå®¹å™¨æ˜¯ä¸´æ—¶çš„ï¼Œæ•°æ®éœ€è¦æ°¸ä¹…ä¿å­˜

```
å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸï¼š
åˆ›å»ºå®¹å™¨ â†’ è¿è¡Œ â†’ åœæ­¢ â†’ åˆ é™¤
     â†‘               â†“
   æ•°æ®äº§ç”Ÿ        æ•°æ®ä¸¢å¤±âŒ

æ•°æ®æŒä¹…åŒ–åï¼š
åˆ›å»ºå®¹å™¨ â†’ è¿è¡Œ â†’ åœæ­¢ â†’ åˆ é™¤
     â†‘               â†“
   æ•°æ®ä¿å­˜åˆ°å¤–éƒ¨   æ•°æ®ä»ç„¶å­˜åœ¨âœ…
```

### 5.2 Volumeæ•°æ®å·é…ç½®


ğŸ“‹ **Docker Volumeçš„ä¸‰ç§ç±»å‹**ï¼š

**1. åŒ¿åå·**ï¼š
```yaml
database:
  image: mysql:8.0
  volumes:
    - /var/lib/mysql    # Dockerè‡ªåŠ¨ç®¡ç†
```

**2. å‘½åå·**ï¼ˆæ¨èï¼‰ï¼š
```yaml
database:
  image: mysql:8.0
  volumes:
    - mysql_data:/var/lib/mysql    # æœ‰åå­—ï¼Œæ–¹ä¾¿ç®¡ç†

volumes:
  mysql_data:    # åœ¨è¿™é‡Œå£°æ˜
```

**3. ç»‘å®šæŒ‚è½½**ï¼š
```yaml
database:
  image: mysql:8.0
  volumes:
    - ./data:/var/lib/mysql    # æŒ‚è½½åˆ°å®¿ä¸»æœºç›®å½•
```

### 5.3 ä¸åŒæ•°æ®çš„å­˜å‚¨ç­–ç•¥


ğŸ—‚ï¸ **æ•°æ®åˆ†ç±»ä¸å­˜å‚¨ç­–ç•¥**ï¼š

| æ•°æ®ç±»å‹ | **ç‰¹ç‚¹** | **å­˜å‚¨æ–¹å¼** | **ç¤ºä¾‹** |
|---------|---------|-------------|---------|
| **ä¸šåŠ¡æ•°æ®** | é‡è¦ï¼Œä¸èƒ½ä¸¢å¤± | å‘½åå· | ç”¨æˆ·ä¿¡æ¯ã€è®¢å•æ•°æ® |
| **é…ç½®æ–‡ä»¶** | éœ€è¦ä¿®æ”¹ | ç»‘å®šæŒ‚è½½ | nginx.confã€app.yml |
| **æ—¥å¿—æ–‡ä»¶** | éœ€è¦æŸ¥çœ‹åˆ†æ | ç»‘å®šæŒ‚è½½ | access.logã€error.log |
| **ä¸´æ—¶æ–‡ä»¶** | å¯ä»¥é‡å»º | åŒ¿åå· | ç¼“å­˜æ–‡ä»¶ã€ä¸´æ—¶å›¾ç‰‡ |

### 5.4 æ•°æ®å¤‡ä»½ç­–ç•¥


ğŸ”„ **æ•°æ®å¤‡ä»½é…ç½®**ï¼š
```yaml
services:
  database:
    image: mysql:8.0
    volumes:
      - mysql_data:/var/lib/mysql
    
  backup:
    image: mysql:8.0
    volumes:
      - mysql_data:/var/lib/mysql:ro    # åªè¯»æŒ‚è½½
      - ./backups:/backups              # å¤‡ä»½ç›®å½•
    command: |
      sh -c "
        while true; do
          mysqldump -h database -u root -p$$MYSQL_ROOT_PASSWORD --all-databases > /backups/backup-$$(date +%Y%m%d-%H%M%S).sql
          sleep 86400  # æ¯å¤©å¤‡ä»½ä¸€æ¬¡
        done
      "
```

---

## 6. ğŸ“ é…ç½®æ–‡ä»¶å¤–éƒ¨åŒ–ç®¡ç†


### 6.1 ä¸ºä»€ä¹ˆè¦å¤–éƒ¨åŒ–é…ç½®


ğŸ’­ **é…ç½®å¤–éƒ¨åŒ–çš„å¥½å¤„**ï¼š
- **å®‰å…¨æ€§**ï¼šå¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ä¸å†™åœ¨ä»£ç é‡Œ
- **çµæ´»æ€§**ï¼šä¸åŒç¯å¢ƒï¼ˆå¼€å‘/ç”Ÿäº§ï¼‰ä½¿ç”¨ä¸åŒé…ç½®
- **ç»´æŠ¤æ€§**ï¼šä¿®æ”¹é…ç½®ä¸éœ€è¦é‡æ–°æ„å»ºé•œåƒ

### 6.2 ç¯å¢ƒå˜é‡é…ç½®


ğŸ”§ **åŸºæœ¬ç¯å¢ƒå˜é‡é…ç½®**ï¼š
```yaml
backend:
  image: myapp:latest
  environment:
    - NODE_ENV=production
    - DATABASE_URL=mysql://user:password@database:3306/myapp
    - API_SECRET_KEY=your-secret-key
```

**ä½¿ç”¨.envæ–‡ä»¶**ï¼š
```yaml
# docker-compose.yml
backend:
  image: myapp:latest
  env_file:
    - .env
```

```bash
# .envæ–‡ä»¶å†…å®¹
NODE_ENV=production
DATABASE_URL=mysql://user:password@database:3306/myapp
API_SECRET_KEY=your-secret-key
```

### 6.3 é…ç½®æ–‡ä»¶æŒ‚è½½


ğŸ“‚ **æŒ‚è½½å¤–éƒ¨é…ç½®æ–‡ä»¶**ï¼š
```yaml
services:
  nginx:
    image: nginx
    volumes:
      - ./config/nginx.conf:/etc/nginx/nginx.conf
      - ./config/ssl:/etc/nginx/ssl
      
  backend:
    image: myapp:latest
    volumes:
      - ./config/app.yml:/app/config/production.yml
```

### 6.4 Docker Secretsï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰


ğŸ”’ **å®‰å…¨çš„å¯†é’¥ç®¡ç†**ï¼š
```yaml
version: '3.8'

secrets:
  db_password:
    file: ./secrets/db_password.txt    # å¯†ç ä¿å­˜åœ¨æ–‡ä»¶ä¸­
  api_key:
    external: true                     # å¤–éƒ¨ç®¡ç†çš„å¯†é’¥

services:
  backend:
    image: myapp:latest
    secrets:
      - db_password
      - api_key
    environment:
      - DATABASE_PASSWORD_FILE=/run/secrets/db_password
```

---

## 7. ğŸ¥ å®¹å™¨å¥åº·æ£€æŸ¥é…ç½®


### 7.1 å¥åº·æ£€æŸ¥çš„é‡è¦æ€§


ğŸ¯ **å¥åº·æ£€æŸ¥çš„ä½œç”¨**ï¼šç¡®ä¿å®¹å™¨ä¸ä»…åœ¨è¿è¡Œï¼Œè€Œä¸”èƒ½æ­£å¸¸å·¥ä½œ

```
æ²¡æœ‰å¥åº·æ£€æŸ¥ï¼š
å®¹å™¨çŠ¶æ€ï¼šRunning âœ…
å®é™…çŠ¶æ€ï¼šæœåŠ¡å·²æ­»ğŸ’€
ç»“æœï¼šç”¨æˆ·è®¿é—®å¤±è´¥ğŸ˜

æœ‰å¥åº·æ£€æŸ¥ï¼š
å®¹å™¨çŠ¶æ€ï¼šUnhealthy âŒ  
è‡ªåŠ¨æ“ä½œï¼šé‡å¯å®¹å™¨ğŸ”„
ç»“æœï¼šæœåŠ¡æ¢å¤æ­£å¸¸ğŸ˜Š
```

### 7.2 å¥åº·æ£€æŸ¥é…ç½®æ–¹æ³•


**åŸºæœ¬å¥åº·æ£€æŸ¥**ï¼š
```yaml
backend:
  image: myapp:latest
  healthcheck:
    test: ["CMD", "curl", "-f", "http://localhost:3000/health"]
    interval: 30s      # æ£€æŸ¥é—´éš”
    timeout: 10s       # è¶…æ—¶æ—¶é—´
    retries: 3         # é‡è¯•æ¬¡æ•°
    start_period: 60s  # å¯åŠ¨å®½é™æœŸ
```

**æ•°æ®åº“å¥åº·æ£€æŸ¥**ï¼š
```yaml
database:
  image: mysql:8.0
  healthcheck:
    test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]
    interval: 30s
    timeout: 10s
    retries: 5
```

### 7.3 åº”ç”¨çº§å¥åº·æ£€æŸ¥


ğŸ”§ **åç«¯åº”ç”¨å¥åº·æ£€æŸ¥æ¥å£**ï¼š
```javascript
// Node.js ç¤ºä¾‹
app.get('/health', async (req, res) => {
  try {
    // æ£€æŸ¥æ•°æ®åº“è¿æ¥
    await db.query('SELECT 1');
    
    // æ£€æŸ¥å…³é”®æœåŠ¡
    const redisStatus = await redis.ping();
    
    res.json({ 
      status: 'healthy',
      timestamp: new Date().toISOString(),
      services: {
        database: 'ok',
        redis: redisStatus
      }
    });
  } catch (error) {
    res.status(500).json({ 
      status: 'unhealthy', 
      error: error.message 
    });
  }
});
```

### 7.4 å¥åº·æ£€æŸ¥æœ€ä½³å®è·µ


âš¡ **æ£€æŸ¥ç­–ç•¥å»ºè®®**ï¼š

| æœåŠ¡ç±»å‹ | **æ£€æŸ¥æ–¹æ³•** | **æ£€æŸ¥é¢‘ç‡** | **è¶…æ—¶æ—¶é—´** |
|---------|-------------|-------------|-------------|
| **å‰ç«¯** | HTTPè¯·æ±‚é¦–é¡µ | 30ç§’ | 5ç§’ |
| **APIæœåŠ¡** | å¥åº·æ£€æŸ¥æ¥å£ | 15ç§’ | 10ç§’ |
| **æ•°æ®åº“** | è¿æ¥æµ‹è¯• | 30ç§’ | 5ç§’ |
| **ç¼“å­˜** | pingå‘½ä»¤ | 30ç§’ | 3ç§’ |

---

## 8. â° å¯åŠ¨é¡ºåºä¾èµ–ç®¡ç†


### 8.1 ä¸ºä»€ä¹ˆéœ€è¦å¯åŠ¨é¡ºåº


ğŸ¤” **ä¾èµ–å…³ç³»é—®é¢˜**ï¼š
```
é”™è¯¯çš„å¯åŠ¨é¡ºåºï¼š
1. åç«¯å®¹å™¨å¯åŠ¨ â†’ å°è¯•è¿æ¥æ•°æ®åº“ â†’ å¤±è´¥âŒ
2. æ•°æ®åº“å®¹å™¨å¯åŠ¨ â†’ åç«¯å·²ç»é€€å‡ºğŸ’€

æ­£ç¡®çš„å¯åŠ¨é¡ºåºï¼š  
1. æ•°æ®åº“å®¹å™¨å¯åŠ¨ â†’ ç­‰å¾…å°±ç»ªâœ…
2. åç«¯å®¹å™¨å¯åŠ¨ â†’ è¿æ¥æˆåŠŸâœ…
3. å‰ç«¯å®¹å™¨å¯åŠ¨ â†’ ç³»ç»Ÿæ­£å¸¸âœ…
```

### 8.2 depends_onåŸºç¡€é…ç½®


```yaml
services:
  frontend:
    image: nginx
    depends_on:
      - backend      # ç­‰å¾…backendå¯åŠ¨
      
  backend:
    image: myapp:latest
    depends_on:
      - database     # ç­‰å¾…databaseå¯åŠ¨
      - redis        # ç­‰å¾…rediså¯åŠ¨
      
  database:
    image: mysql:8.0
    
  redis:
    image: redis:alpine
```

ğŸš¨ **é‡è¦æé†’**ï¼š`depends_on`åªç­‰å®¹å™¨å¯åŠ¨ï¼Œä¸ç­‰æœåŠ¡å°±ç»ªï¼

### 8.3 ç­‰å¾…æœåŠ¡å°±ç»ªçš„é…ç½®


**ä½¿ç”¨å¥åº·æ£€æŸ¥ç­‰å¾…æœåŠ¡å°±ç»ª**ï¼š
```yaml
services:
  database:
    image: mysql:8.0
    healthcheck:
      test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]
      interval: 10s
      timeout: 5s
      retries: 5
      
  backend:
    image: myapp:latest
    depends_on:
      database:
        condition: service_healthy    # ç­‰å¾…æ•°æ®åº“å¥åº·
```

**ä½¿ç”¨wait-for-itè„šæœ¬**ï¼š
```yaml
backend:
  image: myapp:latest
  depends_on:
    - database
  command: |
    sh -c "
      ./wait-for-it.sh database:3306 --timeout=60 --strict -- 
      npm start
    "
```

### 8.4 å¤æ‚ä¾èµ–å…³ç³»ç®¡ç†


ğŸ—ï¸ **å¤šå±‚ä¾èµ–ç¤ºä¾‹**ï¼š
```yaml
services:
  # åŸºç¡€è®¾æ–½å±‚
  database:
    image: mysql:8.0
    healthcheck:
      test: ["CMD", "mysqladmin", "ping"]
      
  redis:
    image: redis:alpine
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      
  # åº”ç”¨å±‚
  backend:
    image: myapp:latest
    depends_on:
      database:
        condition: service_healthy
      redis:
        condition: service_healthy
        
  # å‰ç«¯å±‚
  frontend:
    image: nginx
    depends_on:
      backend:
        condition: service_healthy
```

**å¯åŠ¨æµç¨‹**ï¼š
```
ç¬¬1æ­¥ï¼šdatabase + redis å¹¶è¡Œå¯åŠ¨
ç¬¬2æ­¥ï¼šç­‰å¾… database å’Œ redis å¥åº·æ£€æŸ¥é€šè¿‡
ç¬¬3æ­¥ï¼šbackend å¯åŠ¨ï¼Œç­‰å¾…å¥åº·æ£€æŸ¥é€šè¿‡  
ç¬¬4æ­¥ï¼šfrontend å¯åŠ¨
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å¤šå±‚æ¶æ„ï¼šå‰ç«¯+åç«¯+æ•°æ®åº“çš„åˆ†å±‚è®¾è®¡æ€è·¯
ğŸ”¸ å®¹å™¨é…ç½®ï¼šæ¯ä¸ªå®¹å™¨çš„èŒè´£åˆ’åˆ†å’ŒåŸºæœ¬é…ç½®æ–¹æ³•
ğŸ”¸ ç½‘ç»œé€šä¿¡ï¼šå®¹å™¨é—´å¦‚ä½•é€šè¿‡æœåŠ¡åäº’ç›¸è®¿é—®
ğŸ”¸ æ•°æ®æŒä¹…åŒ–ï¼šä½¿ç”¨Volumeç¡®ä¿é‡è¦æ•°æ®ä¸ä¸¢å¤±
ğŸ”¸ é…ç½®ç®¡ç†ï¼šç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶çš„å¤–éƒ¨åŒ–ç®¡ç†
ğŸ”¸ å¥åº·æ£€æŸ¥ï¼šç¡®ä¿æœåŠ¡çœŸæ­£å¯ç”¨ï¼Œä¸åªæ˜¯åœ¨è¿è¡Œ
ğŸ”¸ å¯åŠ¨é¡ºåºï¼šåˆç†å®‰æ’å®¹å™¨å¯åŠ¨é¡ºåºï¼Œé¿å…ä¾èµ–é—®é¢˜
```

### 9.2 å®é™…åº”ç”¨ä»·å€¼


ğŸ’¡ **è§£å†³çš„å®é™…é—®é¢˜**ï¼š
- **ç¯å¢ƒä¸€è‡´æ€§**ï¼šå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒå®Œå…¨ä¸€è‡´
- **å¿«é€Ÿéƒ¨ç½²**ï¼šä¸€æ¡å‘½ä»¤å¯åŠ¨æ•´ä¸ªåº”ç”¨æ ˆ
- **å¼¹æ€§æ‰©å±•**ï¼šæ ¹æ®è´Ÿè½½è‡ªåŠ¨æ‰©ç¼©å®¹
- **æ•…éšœéš”ç¦»**ï¼šä¸€ä¸ªå®¹å™¨å‡ºé—®é¢˜ä¸å½±å“å…¶ä»–å®¹å™¨
- **ç‰ˆæœ¬ç®¡ç†**ï¼šæ¯ä¸ªæœåŠ¡å¯ä»¥ç‹¬ç«‹æ›´æ–°ç‰ˆæœ¬

### 9.3 æœ€ä½³å®è·µæ€»ç»“


ğŸ¯ **é…ç½®æœ€ä½³å®è·µ**ï¼š

**å®‰å…¨æ–¹é¢**ï¼š
- æ•æ„Ÿä¿¡æ¯ç”¨ç¯å¢ƒå˜é‡æˆ–secretsç®¡ç†
- æ•°æ®åº“ç­‰å†…éƒ¨æœåŠ¡ä¸å¯¹å¤–æš´éœ²ç«¯å£
- ä½¿ç”¨érootç”¨æˆ·è¿è¡Œå®¹å™¨

**æ€§èƒ½æ–¹é¢**ï¼š
- åˆç†é…ç½®å¥åº·æ£€æŸ¥é¢‘ç‡
- ä½¿ç”¨å‘½åå·æå‡I/Oæ€§èƒ½
- æ ¹æ®æœåŠ¡ç‰¹ç‚¹é…ç½®èµ„æºé™åˆ¶

**ç»´æŠ¤æ–¹é¢**ï¼š
- ä½¿ç”¨æœ‰æ„ä¹‰çš„æœåŠ¡åå’Œå®¹å™¨å
- æ·»åŠ å¿…è¦çš„æ ‡ç­¾å’Œæ³¨é‡Š
- å®šæœŸå¤‡ä»½é‡è¦æ•°æ®

### 9.4 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


âŒ **å¸¸è§é—®é¢˜**ï¼š
1. **å®¹å™¨æ— æ³•äº’ç›¸è®¿é—®** â†’ æ£€æŸ¥ç½‘ç»œé…ç½®å’ŒæœåŠ¡å
2. **æ•°æ®ä¸¢å¤±** â†’ ç¡®ä¿ä½¿ç”¨äº†æ•°æ®å·æŒä¹…åŒ–
3. **å¯åŠ¨å¤±è´¥** â†’ æ£€æŸ¥ä¾èµ–å…³ç³»å’Œå¥åº·æ£€æŸ¥é…ç½®
4. **æ€§èƒ½é—®é¢˜** â†’ ä¼˜åŒ–èµ„æºåˆ†é…å’Œç½‘ç»œé…ç½®

âœ… **è§£å†³æ€è·¯**ï¼š
- æŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼š`docker-compose logs æœåŠ¡å`
- æ£€æŸ¥å®¹å™¨çŠ¶æ€ï¼š`docker-compose ps`
- è¿›å…¥å®¹å™¨è°ƒè¯•ï¼š`docker-compose exec æœåŠ¡å bash`
- é‡å»ºæœåŠ¡ï¼š`docker-compose up --build`

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- åˆ†å±‚æ¶æ„èŒè´£æ¸…ï¼Œå®¹å™¨é…ç½®è¦åˆç†
- ç½‘ç»œé€šä¿¡æœåŠ¡åï¼Œæ•°æ®æŒä¹…ç”¨å·æŒ‚
- é…ç½®å¤–éƒ¨ç¯å¢ƒå˜ï¼Œå¥åº·æ£€æŸ¥ä¿å¯ç”¨
- å¯åŠ¨é¡ºåºä¾èµ–æ˜ï¼Œæœ€ä½³å®è·µè®°å¿ƒé—´