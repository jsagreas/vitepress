---
title: 13ã€Secretå¯†é’¥ç®¡ç†
---
## ğŸ“š ç›®å½•

1. [SecretåŸºç¡€æ¦‚å¿µ](#1-SecretåŸºç¡€æ¦‚å¿µ)
2. [Secretèµ„æºç±»å‹åˆ†ç±»](#2-Secretèµ„æºç±»å‹åˆ†ç±»)
3. [Dockeré•œåƒæ‹‰å–å¯†é’¥](#3-Dockeré•œåƒæ‹‰å–å¯†é’¥)
4. [TLSè¯ä¹¦å¯†é’¥å­˜å‚¨](#4-TLSè¯ä¹¦å¯†é’¥å­˜å‚¨)
5. [é€šç”¨å¯†é’¥æ•°æ®å­˜å‚¨](#5-é€šç”¨å¯†é’¥æ•°æ®å­˜å‚¨)
6. [å¯†é’¥æŒ‚è½½ä½¿ç”¨æ–¹å¼](#6-å¯†é’¥æŒ‚è½½ä½¿ç”¨æ–¹å¼)
7. [å¯†é’¥æƒé™æ§åˆ¶](#7-å¯†é’¥æƒé™æ§åˆ¶)
8. [å¯†é’¥è½®è½¬æ›´æ–°ç­–ç•¥](#8-å¯†é’¥è½®è½¬æ›´æ–°ç­–ç•¥)
9. [å¯†é’¥å®‰å…¨æœ€ä½³å®è·µ](#9-å¯†é’¥å®‰å…¨æœ€ä½³å®è·µ)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” SecretåŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯Secret


**ç®€å•ç†è§£**ï¼šSecretå°±åƒä¸€ä¸ªä¿é™©ç®±ï¼Œä¸“é—¨ç”¨æ¥å­˜æ”¾æ•æ„Ÿä¿¡æ¯

```
ç°å®åœºæ™¯ç±»æ¯”ï¼š
é“¶è¡Œä¿é™©ç®± â†’ å­˜æ”¾è´µé‡ç‰©å“ã€æœºå¯†æ–‡ä»¶
Kubernetes Secret â†’ å­˜æ”¾å¯†ç ã€å¯†é’¥ã€è¯ä¹¦

å…±åŒç‰¹ç‚¹ï¼š
â€¢ å®‰å…¨å­˜å‚¨æ•æ„Ÿä¿¡æ¯
â€¢ é™åˆ¶è®¿é—®æƒé™
â€¢ ä¸æ—¥å¸¸ä½¿ç”¨çš„ç‰©å“åˆ†å¼€ç®¡ç†
```

**æ ¸å¿ƒå®šä¹‰**ï¼š
- Secretæ˜¯Kubernetesä¸­ä¸“é—¨å­˜å‚¨æ•æ„Ÿæ•°æ®çš„èµ„æºå¯¹è±¡
- ä¸ConfigMapä¸åŒï¼ŒSecretä¸“é—¨å¤„ç†æœºå¯†ä¿¡æ¯
- æ•°æ®åœ¨å­˜å‚¨æ—¶ä¼šè¿›è¡ŒBase64ç¼–ç ï¼ˆæ³¨æ„ï¼šä¸æ˜¯åŠ å¯†ï¼‰

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦Secret


**é—®é¢˜åœºæ™¯**ï¼š
```
âŒ ä¸å¥½çš„åšæ³•ï¼š
apiVersion: v1
kind: Pod
spec:
  containers:
  - name: app
    env:
    - name: DB_PASSWORD
      value: "123456"  # å¯†ç ç›´æ¥å†™åœ¨é…ç½®é‡Œï¼

é—®é¢˜ï¼š
â€¢ å¯†ç æ˜æ–‡æš´éœ²åœ¨é…ç½®æ–‡ä»¶ä¸­
â€¢ ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¼šè®°å½•å¯†ç å†å²
â€¢ æ‰€æœ‰èƒ½çœ‹åˆ°é…ç½®çš„äººéƒ½èƒ½çœ‹åˆ°å¯†ç 
```

**Secretè§£å†³æ–¹æ¡ˆ**ï¼š
```
âœ… æ­£ç¡®çš„åšæ³•ï¼š
1. å¯†ç å­˜å‚¨åœ¨Secretä¸­ï¼ˆåŠ å¯†ä¿å­˜ï¼‰
2. Podé€šè¿‡å¼•ç”¨è·å–å¯†ç 
3. å¯†ç ä¸åº”ç”¨é…ç½®åˆ†ç¦»
4. å¯ä»¥ç‹¬ç«‹ç®¡ç†å¯†ç çš„è®¿é—®æƒé™
```

### 1.3 Secretä¸ConfigMapçš„åŒºåˆ«


| å¯¹æ¯”é¡¹ç›® | **Secret** | **ConfigMap** |
|---------|------------|---------------|
| **ç”¨é€”** | å­˜å‚¨æ•æ„Ÿæ•°æ® | å­˜å‚¨é…ç½®æ•°æ® |
| **æ•°æ®ç±»å‹** | å¯†ç ã€å¯†é’¥ã€è¯ä¹¦ | é…ç½®æ–‡ä»¶ã€ç¯å¢ƒå˜é‡ |
| **å­˜å‚¨æ–¹å¼** | Base64ç¼–ç  | æ˜æ–‡å­˜å‚¨ |
| **è®¿é—®æ§åˆ¶** | æ›´ä¸¥æ ¼çš„æƒé™æ§åˆ¶ | ç›¸å¯¹å®½æ¾ |
| **é€‚ç”¨åœºæ™¯** | `æ•°æ®åº“å¯†ç ã€APIå¯†é’¥` | `åº”ç”¨é…ç½®ã€ç‰¹æ€§å¼€å…³` |

---

## 2. ğŸ“‹ Secretèµ„æºç±»å‹åˆ†ç±»


### 2.1 å†…ç½®Secretç±»å‹æ¦‚è§ˆ


```
Kuberneteså†…ç½®çš„Secretç±»å‹ï¼š

é€šç”¨ç±»å‹ï¼š
â”œâ”€â”€ Opaque                    # ç”¨æˆ·è‡ªå®šä¹‰çš„ä»»æ„æ•°æ®
â”œâ”€â”€ kubernetes.io/service-account-token  # ServiceAccountä»¤ç‰Œ

Dockerç›¸å…³ï¼š
â”œâ”€â”€ kubernetes.io/dockercfg   # Dockeré…ç½®æ–‡ä»¶
â”œâ”€â”€ kubernetes.io/dockerconfigjson  # Dockeré…ç½®JSON

TLSç›¸å…³ï¼š
â”œâ”€â”€ kubernetes.io/tls         # TLSè¯ä¹¦å’Œç§é’¥
â”œâ”€â”€ kubernetes.io/basic-auth  # åŸºç¡€è®¤è¯
â””â”€â”€ kubernetes.io/ssh-auth    # SSHè®¤è¯
```

### 2.2 å„ç±»å‹è¯¦ç»†è¯´æ˜


**Opaqueç±»å‹**ï¼š
```yaml
# æœ€å¸¸ç”¨çš„é€šç”¨ç±»å‹ï¼Œå¯ä»¥å­˜å‚¨ä»»æ„é”®å€¼å¯¹æ•°æ®
apiVersion: v1
kind: Secret
metadata:
  name: mysecret
type: Opaque  # é€šç”¨ç±»å‹ï¼Œæœ€çµæ´»
data:
  username: YWRtaW4=     # "admin" çš„ base64 ç¼–ç 
  password: MWYyZDFlMmU2N2Rm  # å¤æ‚å¯†ç çš„ç¼–ç 
```

**kubernetes.io/service-account-token**ï¼š
```yaml
# ç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºï¼Œç”¨äºPodè®¿é—®APIæœåŠ¡å™¨
apiVersion: v1
kind: Secret
type: kubernetes.io/service-account-token
metadata:
  name: default-token-xyz
  annotations:
    kubernetes.io/service-account.name: default
data:
  ca.crt: LS0tLS1CRUdJTi...    # CAè¯ä¹¦
  token: ZXlKaGJHY2lPaU...     # è®¿é—®ä»¤ç‰Œ
```

### 2.3 ç±»å‹é€‰æ‹©æŒ‡å¯¼


```
é€‰æ‹©Secretç±»å‹çš„å†³ç­–æ ‘ï¼š

å­˜å‚¨ä»€ä¹ˆæ•°æ®ï¼Ÿ
â”œâ”€â”€ Dockeré•œåƒæ‹‰å–å‡­è¯ â†’ kubernetes.io/dockerconfigjson
â”œâ”€â”€ TLSè¯ä¹¦å’Œç§é’¥ â†’ kubernetes.io/tls  
â”œâ”€â”€ åŸºç¡€ç”¨æˆ·åå¯†ç  â†’ kubernetes.io/basic-auth
â”œâ”€â”€ SSHå¯†é’¥ â†’ kubernetes.io/ssh-auth
â””â”€â”€ å…¶ä»–æ•æ„Ÿæ•°æ® â†’ Opaqueï¼ˆä¸‡èƒ½ç±»å‹ï¼‰

å®é™…å»ºè®®ï¼š
ä¸ç¡®å®šç”¨ä»€ä¹ˆç±»å‹æ—¶ï¼Œé€‰æ‹©Opaqueå°±å¯¹äº†ï¼
å®ƒæ˜¯æœ€é€šç”¨çš„ï¼Œå¯ä»¥å­˜å‚¨ä»»ä½•ç±»å‹çš„æ•æ„Ÿæ•°æ®ã€‚
```

---

## 3. ğŸ³ Dockeré•œåƒæ‹‰å–å¯†é’¥


### 3.1 ç§æœ‰é•œåƒä»“åº“çš„æŒ‘æˆ˜


**åœºæ™¯æè¿°**ï¼š
```
é—®é¢˜ï¼šä»ç§æœ‰Dockerä»“åº“æ‹‰å–é•œåƒéœ€è¦è®¤è¯

ç°å®ç±»æ¯”ï¼š
å…¬å¼€è¶…å¸‚ â†’ Docker Hubå…¬å…±é•œåƒï¼ˆæ— éœ€è´¦å·ï¼‰
ç§äººä¼šæ‰€ â†’ ç§æœ‰é•œåƒä»“åº“ï¼ˆéœ€è¦ä¼šå‘˜å¡/å¯†ç ï¼‰

æŠ€æœ¯æŒ‘æˆ˜ï¼š
â€¢ Podéœ€è¦é•œåƒæ‰èƒ½å¯åŠ¨
â€¢ ç§æœ‰ä»“åº“éœ€è¦ç”¨æˆ·åå¯†ç 
â€¢ ä¸èƒ½æŠŠå¯†ç ç›´æ¥å†™åœ¨é…ç½®é‡Œ
â€¢ éœ€è¦å®‰å…¨åœ°æä¾›è®¤è¯ä¿¡æ¯
```

### 3.2 åˆ›å»ºDocker Registry Secret


**æ–¹å¼ä¸€ï¼šå‘½ä»¤è¡Œåˆ›å»ºï¼ˆæ¨èï¼‰**
```bash
# ä½¿ç”¨kubectlå‘½ä»¤ç›´æ¥åˆ›å»º
kubectl create secret docker-registry myregistrykey \
  --docker-server=registry.example.com \
  --docker-username=myuser \
  --docker-password=mypassword \
  --docker-email=myuser@example.com

# éªŒè¯åˆ›å»ºç»“æœ
kubectl get secret myregistrykey -o yaml
```

**æ–¹å¼äºŒï¼šYAMLæ–‡ä»¶åˆ›å»º**
```yaml
apiVersion: v1
kind: Secret
metadata:
  name: myregistrykey
type: kubernetes.io/dockerconfigjson
data:
  .dockerconfigjson: eyJhdXRocyI6eyJyZWdpc3RyeS5leGFtcGxlLmNvbSI6eyJ1c2VybmFtZSI6Im15dXNlciIsInBhc3N3b3JkIjoibXlwYXNzd29yZCIsImVtYWlsIjoibXl1c2VyQGV4YW1wbGUuY29tIiwiYXV0aCI6ImJYbDFjMlZ5T20xNWNHRnpjM2R2Y21RPSJ9fX0=
```

### 3.3 åœ¨Podä¸­ä½¿ç”¨é•œåƒæ‹‰å–å¯†é’¥


**Podé…ç½®ç¤ºä¾‹**ï¼š
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: private-image-pod
spec:
  containers:
  - name: app
    image: registry.example.com/myapp:latest  # ç§æœ‰é•œåƒ
  imagePullSecrets:
  - name: myregistrykey  # å¼•ç”¨æˆ‘ä»¬åˆ›å»ºçš„Secret
```

**ServiceAccountæ–¹å¼ï¼ˆæ¨èï¼‰**ï¼š
```yaml
# 1. å°†Secretç»‘å®šåˆ°ServiceAccount
apiVersion: v1
kind: ServiceAccount
metadata:
  name: myserviceaccount
imagePullSecrets:
- name: myregistrykey

---
# 2. Podä½¿ç”¨è¯¥ServiceAccount
apiVersion: v1
kind: Pod
metadata:
  name: private-image-pod
spec:
  serviceAccountName: myserviceaccount  # è‡ªåŠ¨è·å¾—é•œåƒæ‹‰å–æƒé™
  containers:
  - name: app
    image: registry.example.com/myapp:latest
```

### 3.4 å¤šä¸ªé•œåƒä»“åº“çš„å¤„ç†


```yaml
# å¯ä»¥åŒæ—¶é…ç½®å¤šä¸ªé•œåƒä»“åº“çš„è®¤è¯ä¿¡æ¯
apiVersion: v1
kind: Secret
metadata:
  name: multi-registry-secret
type: kubernetes.io/dockerconfigjson
data:
  .dockerconfigjson: |
    {
      "auths": {
        "registry1.example.com": {
          "username": "user1",
          "password": "pass1",
          "auth": "dXNlcjE6cGFzczE="
        },
        "registry2.example.com": {
          "username": "user2", 
          "password": "pass2",
          "auth": "dXNlcjI6cGFzczI="
        }
      }
    }
```

---

## 4. ğŸ”’ TLSè¯ä¹¦å¯†é’¥å­˜å‚¨


### 4.1 TLSè¯ä¹¦çš„é‡è¦æ€§


**ç°å®åœºæ™¯ç±»æ¯”**ï¼š
```
ç½‘ç«™TLSè¯ä¹¦ = ç½‘ç«™çš„èº«ä»½è¯ + åŠ å¯†é’¥åŒ™

èº«ä»½è¯åŠŸèƒ½ï¼šè¯æ˜ç½‘ç«™èº«ä»½çš„çœŸå®æ€§
åŠ å¯†é’¥åŒ™åŠŸèƒ½ï¼šä¿æŠ¤æ•°æ®ä¼ è¾“å®‰å…¨

æ²¡æœ‰è¯ä¹¦çš„åæœï¼š
â€¢ æµè§ˆå™¨æ˜¾ç¤º"ä¸å®‰å…¨"è­¦å‘Š
â€¢ ç”¨æˆ·ä¸ä¿¡ä»»ç½‘ç«™
â€¢ æ•°æ®ä¼ è¾“å¯èƒ½è¢«çªƒå¬
```

### 4.2 TLS Secretçš„åˆ›å»º


**æ–¹å¼ä¸€ï¼šä»è¯ä¹¦æ–‡ä»¶åˆ›å»º**
```bash
# å‡è®¾ä½ æœ‰ä»¥ä¸‹æ–‡ä»¶ï¼š
# tls.crt - TLSè¯ä¹¦æ–‡ä»¶
# tls.key - ç§é’¥æ–‡ä»¶

kubectl create secret tls my-tls-secret \
  --cert=tls.crt \
  --key=tls.key
```

**æ–¹å¼äºŒï¼šYAMLé…ç½®åˆ›å»º**
```yaml
apiVersion: v1
kind: Secret
metadata:
  name: my-tls-secret
type: kubernetes.io/tls
data:
  tls.crt: LS0tLS1CRUdJTi...  # è¯ä¹¦å†…å®¹çš„base64ç¼–ç 
  tls.key: LS0tLS1CRUdJTi...  # ç§é’¥å†…å®¹çš„base64ç¼–ç 
```

### 4.3 åœ¨Ingressä¸­ä½¿ç”¨TLSè¯ä¹¦


**Ingressé…ç½®ç¤ºä¾‹**ï¼š
```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: tls-example-ingress
spec:
  tls:
  - hosts:
    - myapp.example.com
    secretName: my-tls-secret  # å¼•ç”¨TLS Secret
  rules:
  - host: myapp.example.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: my-service
            port:
              number: 80
```

### 4.4 è¯ä¹¦æ›´æ–°æµç¨‹


```
è¯ä¹¦æ›´æ–°çš„å®Œæ•´æµç¨‹ï¼š

1. ç”Ÿæˆæ–°è¯ä¹¦
   â”œâ”€â”€ ä»è¯ä¹¦é¢å‘æœºæ„è·å–æ–°è¯ä¹¦
   â””â”€â”€ ç¡®ä¿è¯ä¹¦æ ¼å¼æ­£ç¡®

2. æ›´æ–°Secret
   â”œâ”€â”€ kubectl create secret tls new-cert --cert=new.crt --key=new.key
   â””â”€â”€ kubectl patch secret my-tls-secret -p '{"data":{"tls.crt":"æ–°è¯ä¹¦base64"}}'

3. éªŒè¯æ›´æ–°
   â”œâ”€â”€ æ£€æŸ¥Ingressæ˜¯å¦ä½¿ç”¨æ–°è¯ä¹¦
   â”œâ”€â”€ æµ‹è¯•HTTPSè¿æ¥
   â””â”€â”€ ç¡®è®¤è¯ä¹¦æœ‰æ•ˆæœŸ

è‡ªåŠ¨åŒ–å»ºè®®ï¼š
ä½¿ç”¨cert-managerç­‰å·¥å…·å¯ä»¥è‡ªåŠ¨ç®¡ç†è¯ä¹¦çš„ç”³è¯·å’Œæ›´æ–°
```

---

## 5. ğŸ’¾ é€šç”¨å¯†é’¥æ•°æ®å­˜å‚¨


### 5.1 Opaqueç±»å‹çš„çµæ´»æ€§


**ä½¿ç”¨åœºæ™¯**ï¼š
```
Opaqueç±»å‹å¯ä»¥å­˜å‚¨å„ç§æ•æ„Ÿæ•°æ®ï¼š

æ•°æ®åº“ç›¸å…³ï¼š
â”œâ”€â”€ æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
â”œâ”€â”€ æ•°æ®åº“ç”¨æˆ·åå¯†ç 
â””â”€â”€ æ•°æ®åº“SSLè¯ä¹¦

APIç›¸å…³ï¼š
â”œâ”€â”€ ç¬¬ä¸‰æ–¹APIå¯†é’¥
â”œâ”€â”€ OAuthå®¢æˆ·ç«¯å¯†é’¥
â””â”€â”€ JWTç­¾åå¯†é’¥

åº”ç”¨é…ç½®ï¼š
â”œâ”€â”€ åŠ å¯†å¯†é’¥
â”œâ”€â”€ è®¸å¯è¯æ–‡ä»¶
â””â”€â”€ é…ç½®æ–‡ä»¶ä¸­çš„æ•æ„Ÿéƒ¨åˆ†
```

### 5.2 åˆ›å»ºé€šç”¨Secret


**å‘½ä»¤è¡Œåˆ›å»º**ï¼š
```bash
# ä»å­—é¢é‡åˆ›å»º
kubectl create secret generic my-secret \
  --from-literal=username=admin \
  --from-literal=password=secretpassword

# ä»æ–‡ä»¶åˆ›å»º
kubectl create secret generic my-secret \
  --from-file=config.properties \
  --from-file=license.key
```

**YAMLé…ç½®åˆ›å»º**ï¼š
```yaml
apiVersion: v1
kind: Secret
metadata:
  name: app-secrets
type: Opaque
data:
  # ä½¿ç”¨base64ç¼–ç å­˜å‚¨æ•°æ®
  database-url: bXlzcWw6Ly91c2VyOnBhc3N3b3JkQGxvY2FsaG9zdDozMzA2L215ZGI=
  api-key: YWJjZGVmZ2hpams=
  jwt-secret: c3VwZXJzZWNyZXRrZXk=
  
# æˆ–è€…ä½¿ç”¨stringDataï¼ˆè‡ªåŠ¨base64ç¼–ç ï¼‰
stringData:
  database-url: "mysql://user:password@localhost:3306/mydb"
  api-key: "abcdefghijk"  
  jwt-secret: "supersecretkey"
```

### 5.3 å¤„ç†å¤æ‚æ•°æ®ç»“æ„


**JSONé…ç½®ç¤ºä¾‹**ï¼š
```yaml
apiVersion: v1
kind: Secret
metadata:
  name: complex-config
type: Opaque
stringData:
  app-config.json: |
    {
      "database": {
        "host": "db.example.com",
        "port": 5432,
        "username": "dbuser",
        "password": "dbpass123"
      },
      "redis": {
        "host": "redis.example.com", 
        "password": "redispass456"
      },
      "external-apis": {
        "payment-gateway": "pk_live_abcdef123456",
        "email-service": "key_789xyz"
      }
    }
```

### 5.4 æ–‡ä»¶ç±»å‹æ•°æ®å­˜å‚¨


```yaml
apiVersion: v1
kind: Secret
metadata:
  name: file-secrets
type: Opaque
stringData:
  # é…ç½®æ–‡ä»¶
  nginx.conf: |
    server {
        listen 443 ssl;
        ssl_certificate /etc/ssl/server.crt;
        ssl_certificate_key /etc/ssl/server.key;
        # ... æ›´å¤šé…ç½®
    }
  
  # è„šæœ¬æ–‡ä»¶
  backup-script.sh: |
    #!/bin/bash
    export DB_PASSWORD="$DB_SECRET"
    mysqldump -u admin -p"$DB_PASSWORD" mydb > backup.sql
    
  # è®¸å¯è¯æ–‡ä»¶
  license.xml: |
    <?xml version="1.0"?>
    <license>
      <key>ABC123-DEF456-GHI789</key>
      <expiry>2025-12-31</expiry>
    </license>
```

---

## 6. ğŸ“‚ å¯†é’¥æŒ‚è½½ä½¿ç”¨æ–¹å¼


### 6.1 ç¯å¢ƒå˜é‡æ–¹å¼


**åŸºæœ¬ç¯å¢ƒå˜é‡æ³¨å…¥**ï¼š
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: secret-env-pod
spec:
  containers:
  - name: app
    image: nginx
    env:
    - name: DB_USERNAME
      valueFrom:
        secretKeyRef:
          name: app-secrets
          key: username
    - name: DB_PASSWORD
      valueFrom:
        secretKeyRef:
          name: app-secrets
          key: password
```

**æ‰¹é‡ç¯å¢ƒå˜é‡æ³¨å…¥**ï¼š
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: secret-envfrom-pod
spec:
  containers:
  - name: app
    image: nginx
    envFrom:
    - secretRef:
        name: app-secrets  # å°†Secretä¸­æ‰€æœ‰é”®å€¼å¯¹éƒ½æ³¨å…¥ä¸ºç¯å¢ƒå˜é‡
    # ç»“æœï¼šSecretä¸­çš„æ¯ä¸ªkeyéƒ½ä¼šæˆä¸ºç¯å¢ƒå˜é‡
```

### 6.2 æ–‡ä»¶æŒ‚è½½æ–¹å¼


**åŸºç¡€æ–‡ä»¶æŒ‚è½½**ï¼š
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: secret-volume-pod
spec:
  containers:
  - name: app
    image: nginx
    volumeMounts:
    - name: secret-volume
      mountPath: "/etc/secrets"  # æŒ‚è½½åˆ°å®¹å™¨å†…çš„è¿™ä¸ªè·¯å¾„
      readOnly: true
  volumes:
  - name: secret-volume
    secret:
      secretName: app-secrets
      
# ç»“æœï¼š
# /etc/secrets/username æ–‡ä»¶åŒ…å«ç”¨æˆ·å
# /etc/secrets/password æ–‡ä»¶åŒ…å«å¯†ç 
```

**é€‰æ‹©æ€§æ–‡ä»¶æŒ‚è½½**ï¼š
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: selective-secret-pod
spec:
  containers:
  - name: app
    image: nginx
    volumeMounts:
    - name: secret-volume
      mountPath: "/app/config"
  volumes:
  - name: secret-volume
    secret:
      secretName: app-secrets
      items:
      - key: database-config  # åªæŒ‚è½½è¿™ä¸ªkey
        path: db.conf         # æŒ‚è½½ä¸ºè¿™ä¸ªæ–‡ä»¶å
        mode: 0600           # è®¾ç½®æ–‡ä»¶æƒé™
      - key: api-key
        path: api/key.txt
```

### 6.3 subPathç²¾ç¡®æŒ‚è½½


```yaml
apiVersion: v1
kind: Pod
metadata:
  name: subpath-secret-pod
spec:
  containers:
  - name: app
    image: nginx
    volumeMounts:
    - name: secret-volume
      mountPath: "/etc/nginx/ssl/server.crt"  # ç²¾ç¡®æŒ‚è½½åˆ°ç‰¹å®šæ–‡ä»¶
      subPath: tls.crt                        # å¯¹åº”Secretä¸­çš„key
    - name: secret-volume  
      mountPath: "/etc/nginx/ssl/server.key"
      subPath: tls.key
  volumes:
  - name: secret-volume
    secret:
      secretName: my-tls-secret
```

### 6.4 æŒ‚è½½æ–¹å¼å¯¹æ¯”


| æŒ‚è½½æ–¹å¼ | **ä¼˜ç‚¹** | **ç¼ºç‚¹** | **é€‚ç”¨åœºæ™¯** |
|---------|----------|----------|-------------|
| **ç¯å¢ƒå˜é‡** | `ç®€å•ç›´æ¥ã€åº”ç”¨æ˜“è·å–` | `ä¸å®‰å…¨ã€æœ‰é•¿åº¦é™åˆ¶` | `ç®€å•é…ç½®ã€çŸ­å°å¯†é’¥` |
| **æ–‡ä»¶æŒ‚è½½** | `å®‰å…¨ã€æ”¯æŒå¤§æ–‡ä»¶` | `éœ€è¦è¯»å–æ–‡ä»¶æ“ä½œ` | `é…ç½®æ–‡ä»¶ã€è¯ä¹¦` |
| **subPath** | `ç²¾ç¡®æ§åˆ¶æŒ‚è½½ä½ç½®` | `é…ç½®ç¨å¤æ‚` | `ç‰¹å®šæ–‡ä»¶è·¯å¾„éœ€æ±‚` |

---

## 7. ğŸ›¡ï¸ å¯†é’¥æƒé™æ§åˆ¶


### 7.1 RBACæƒé™æ¨¡å‹


**åŸºæœ¬æƒé™æ¦‚å¿µ**ï¼š
```
Kubernetes RBAC = è§’è‰²è®¿é—®æ§åˆ¶

æ ¸å¿ƒç»„ä»¶ï¼š
â”œâ”€â”€ Role/ClusterRole     # å®šä¹‰æƒé™è§„åˆ™
â”œâ”€â”€ RoleBinding/ClusterRoleBinding  # ç»‘å®šæƒé™åˆ°ç”¨æˆ·
â””â”€â”€ ServiceAccount      # Podè¿è¡Œèº«ä»½

æƒé™ç²’åº¦ï¼š
â”œâ”€â”€ èµ„æºç±»å‹æƒé™ï¼ˆsecretsã€podsã€servicesï¼‰
â”œâ”€â”€ æ“ä½œæƒé™ï¼ˆgetã€listã€createã€updateã€deleteï¼‰
â””â”€â”€ å‘½åç©ºé—´èŒƒå›´ï¼ˆRoleï¼‰vs é›†ç¾¤èŒƒå›´ï¼ˆClusterRoleï¼‰
```

### 7.2 Secretè®¿é—®æƒé™é…ç½®


**åˆ›å»ºSecretè®¿é—®Role**ï¼š
```yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: secret-reader
  namespace: default
rules:
- apiGroups: [""]
  resources: ["secrets"]
  verbs: ["get", "list"]  # åªå…è®¸è¯»å–Secret
  resourceNames: ["app-secrets", "db-secrets"]  # é™åˆ¶ç‰¹å®šSecret

---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: secret-reader-binding
  namespace: default
subjects:
- kind: ServiceAccount
  name: app-service-account
  namespace: default
roleRef:
  kind: Role
  name: secret-reader
  apiGroup: rbac.authorization.k8s.io
```

**Podä½¿ç”¨å—é™æƒé™**ï¼š
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: restricted-pod
spec:
  serviceAccountName: app-service-account  # ä½¿ç”¨å—é™çš„ServiceAccount
  containers:
  - name: app
    image: nginx
    env:
    - name: DB_PASSWORD
      valueFrom:
        secretKeyRef:
          name: app-secrets  # åªèƒ½è®¿é—®æˆæƒçš„Secret
          key: password
```

### 7.3 å‘½åç©ºé—´éš”ç¦»


```yaml
# å¼€å‘ç¯å¢ƒå‘½åç©ºé—´çš„Secret
apiVersion: v1
kind: Secret
metadata:
  name: app-config
  namespace: development
type: Opaque
stringData:
  api-endpoint: "https://dev-api.example.com"
  debug-mode: "true"

---
# ç”Ÿäº§ç¯å¢ƒå‘½åç©ºé—´çš„Secret
apiVersion: v1
kind: Secret
metadata:
  name: app-config  # åŒåä½†åœ¨ä¸åŒå‘½åç©ºé—´
  namespace: production
type: Opaque
stringData:
  api-endpoint: "https://api.example.com"
  debug-mode: "false"
```

### 7.4 Secretè®¿é—®å®¡è®¡


**å®¡è®¡æ—¥å¿—é…ç½®**ï¼š
```yaml
# å®¡è®¡ç­–ç•¥é…ç½®ï¼Œè®°å½•Secretè®¿é—®
apiVersion: audit.k8s.io/v1
kind: Policy
rules:
- level: Metadata
  resources:
  - group: ""
    resources: ["secrets"]
  verbs: ["get", "list", "create", "update", "delete"]
  
# å®¡è®¡ç»“æœç¤ºä¾‹ï¼š
# æ—¶é—´ï¼š2024-03-15 10:30:00
# ç”¨æˆ·ï¼šsystem:serviceaccount:default:app-sa
# æ“ä½œï¼šGET /api/v1/namespaces/default/secrets/app-secrets
# ç»“æœï¼šæˆåŠŸ
```

---

## 8. ğŸ”„ å¯†é’¥è½®è½¬æ›´æ–°ç­–ç•¥


### 8.1 ä¸ºä»€ä¹ˆéœ€è¦å¯†é’¥è½®è½¬


**å®‰å…¨é£é™©**ï¼š
```
é•¿æœŸä¸å˜çš„å¯†é’¥é£é™©ï¼š

å®‰å…¨é£é™©ï¼š
â”œâ”€â”€ å¯†é’¥æ³„éœ²é£é™©ç´¯ç§¯
â”œâ”€â”€ è¢«ç ´è§£çš„å¯èƒ½æ€§å¢åŠ 
â””â”€â”€ å†…éƒ¨äººå‘˜ç¦»èŒåä»å¯è®¿é—®

åˆè§„è¦æ±‚ï¼š
â”œâ”€â”€ å®‰å…¨æ ‡å‡†è¦æ±‚å®šæœŸæ›´æ¢
â”œâ”€â”€ å®¡è®¡è¦æ±‚å¯è¿½æº¯çš„å¯†é’¥å†å²
â””â”€â”€ æœ€å°æƒé™æ—¶é—´çª—å£åŸåˆ™

ç°å®ç±»æ¯”ï¼š
å®šæœŸæ›´æ¢é“¶è¡Œå¡å¯†ç  = å®šæœŸè½®è½¬APIå¯†é’¥
æ›´æ¢é—¨é”é’¥åŒ™ï¼ˆå‘˜å·¥ç¦»èŒï¼‰ = æ›´æ–°ç³»ç»Ÿè®¿é—®å¯†é’¥
```

### 8.2 æ‰‹åŠ¨å¯†é’¥æ›´æ–°æµç¨‹


**æ­¥éª¤åŒ–æ›´æ–°è¿‡ç¨‹**ï¼š
```bash
# æ­¥éª¤1ï¼šåˆ›å»ºæ–°çš„Secretç‰ˆæœ¬
kubectl create secret generic app-secrets-v2 \
  --from-literal=username=admin \
  --from-literal=password=newpassword123

# æ­¥éª¤2ï¼šæ›´æ–°åº”ç”¨é…ç½®å¼•ç”¨æ–°Secret
kubectl patch deployment myapp -p '
{
  "spec": {
    "template": {
      "spec": {
        "volumes": [{
          "name": "secret-volume",
          "secret": {"secretName": "app-secrets-v2"}
        }]
      }
    }
  }
}'

# æ­¥éª¤3ï¼šéªŒè¯åº”ç”¨æ­£å¸¸è¿è¡Œ
kubectl rollout status deployment/myapp

# æ­¥éª¤4ï¼šåˆ é™¤æ—§Secret
kubectl delete secret app-secrets
```

### 8.3 é›¶åœæœºæ›´æ–°ç­–ç•¥


**è“ç»¿éƒ¨ç½²æ–¹å¼æ›´æ–°**ï¼š
```yaml
# 1. åˆ›å»ºæ–°ç‰ˆæœ¬Secret
apiVersion: v1
kind: Secret
metadata:
  name: app-secrets-v2
  labels:
    version: v2
type: Opaque
stringData:
  database-password: "newpassword123"

---
# 2. æ›´æ–°Deploymenté€æ­¥æ›¿æ¢
apiVersion: apps/v1
kind: Deployment
metadata:
  name: myapp
spec:
  replicas: 3
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxUnavailable: 1  # æœ€å¤š1ä¸ªPodä¸å¯ç”¨
      maxSurge: 1        # æœ€å¤šé¢å¤–1ä¸ªPod
  template:
    spec:
      containers:
      - name: app
        env:
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              name: app-secrets-v2  # æ–°ç‰ˆæœ¬Secret
              key: database-password
```

### 8.4 è‡ªåŠ¨åŒ–è½®è½¬æ–¹æ¡ˆ


**ä½¿ç”¨External Secrets Operator**ï¼š
```yaml
# ä»å¤–éƒ¨å¯†é’¥ç®¡ç†ç³»ç»Ÿè‡ªåŠ¨åŒæ­¥
apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: vault-backend
spec:
  provider:
    vault:
      server: "https://vault.example.com"
      path: "secret"
      version: "v2"

---
apiVersion: external-secrets.io/v1beta1  
kind: ExternalSecret
metadata:
  name: app-external-secret
spec:
  refreshInterval: 1h  # æ¯å°æ—¶æ£€æŸ¥æ›´æ–°
  secretStoreRef:
    name: vault-backend
    kind: SecretStore
  target:
    name: app-secrets
    creationPolicy: Owner
  data:
  - secretKey: password
    remoteRef:
      key: myapp/database
      property: password
```

### 8.5 è½®è½¬æœ€ä½³å®è·µæ—¶é—´è¡¨


```
å¯†é’¥è½®è½¬é¢‘ç‡å»ºè®®ï¼š

é«˜æ•æ„Ÿåº¦å¯†é’¥ï¼ˆæ•°æ®åº“rootå¯†ç ï¼‰ï¼š
â”œâ”€â”€ é¢‘ç‡ï¼šæ¯30å¤©
â”œâ”€â”€ æ—¶é—´ï¼šç»´æŠ¤çª—å£æœŸ
â””â”€â”€ éªŒè¯ï¼šå®Œæ•´å›å½’æµ‹è¯•

ä¸­ç­‰æ•æ„Ÿåº¦å¯†é’¥ï¼ˆAPIå¯†é’¥ï¼‰ï¼š
â”œâ”€â”€ é¢‘ç‡ï¼šæ¯90å¤©  
â”œâ”€â”€ æ—¶é—´ï¼šä½å³°æœŸ
â””â”€â”€ éªŒè¯ï¼šAPIåŠŸèƒ½æµ‹è¯•

ä½æ•æ„Ÿåº¦å¯†é’¥ï¼ˆç¼“å­˜å¯†ç ï¼‰ï¼š
â”œâ”€â”€ é¢‘ç‡ï¼šæ¯180å¤©
â”œâ”€â”€ æ—¶é—´ï¼šéšæ—¶
â””â”€â”€ éªŒè¯ï¼šåŸºç¡€è¿é€šæ€§æµ‹è¯•

è‡ªåŠ¨åŒ–ç¨‹åº¦ï¼š
é«˜é¢‘è½®è½¬ â†’ å¿…é¡»è‡ªåŠ¨åŒ–
ä½é¢‘è½®è½¬ â†’ å¯ä»¥æ‰‹åŠ¨æ“ä½œ
```

---

## 9. ğŸ”’ å¯†é’¥å®‰å…¨æœ€ä½³å®è·µ


### 9.1 å­˜å‚¨å®‰å…¨å®è·µ


**etcdåŠ å¯†é…ç½®**ï¼š
```yaml
# Kubernetesé›†ç¾¤é…ç½®ï¼šå¯ç”¨etcdé™æ€åŠ å¯†
apiVersion: apiserver.config.k8s.io/v1
kind: EncryptionConfiguration
resources:
- resources:
  - secrets
  providers:
  - aescbc:
      keys:
      - name: key1
        secret: <32å­—èŠ‚éšæœºå¯†é’¥>
  - identity: {}  # å›é€€åˆ°ä¸åŠ å¯†ï¼ˆå…¼å®¹æ€§ï¼‰
```

**Secretæœ€å°æƒé™åŸåˆ™**ï¼š
```yaml
# ä¸è¦ç»™Podè¿‡å¤§çš„Secretè®¿é—®æƒé™
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: app-secret-access
rules:
- apiGroups: [""]
  resources: ["secrets"]
  verbs: ["get"]  # åªå…è®¸è¯»å–ï¼Œä¸å…è®¸listæ‰€æœ‰Secret
  resourceNames: ["app-config-only"]  # åªèƒ½è®¿é—®ç‰¹å®šSecret
```

### 9.2 ä¼ è¾“å®‰å…¨å®è·µ


**ç½‘ç»œç­–ç•¥é™åˆ¶**ï¼š
```yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: secret-access-policy
spec:
  podSelector:
    matchLabels:
      app: sensitive-app
  policyTypes:
  - Ingress
  - Egress
  ingress: []  # ä¸å…è®¸å…¥ç«™è¿æ¥
  egress:
  - to:  # åªå…è®¸è®¿é—®ç‰¹å®šæœåŠ¡
    - podSelector:
        matchLabels:
          app: database
    ports:
    - protocol: TCP
      port: 5432
```

### 9.3 åº”ç”¨å±‚å®‰å…¨å®è·µ


**Secretä½¿ç”¨å®‰å…¨ä»£ç **ï¼š
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: secure-secret-usage
spec:
  containers:
  - name: app
    image: myapp:latest
    env:
    - name: DB_PASSWORD_FILE  # é€šè¿‡æ–‡ä»¶è·¯å¾„è€Œä¸æ˜¯ç›´æ¥å€¼
      value: "/etc/secrets/db-password"
    volumeMounts:
    - name: secret-volume
      mountPath: "/etc/secrets"
      readOnly: true  # åªè¯»æŒ‚è½½ï¼Œé˜²æ­¢æ„å¤–ä¿®æ”¹
    securityContext:
      runAsNonRoot: true  # ä¸ä½¿ç”¨rootç”¨æˆ·
      runAsUser: 1000
      allowPrivilegeEscalation: false
  volumes:
  - name: secret-volume
    secret:
      secretName: app-secrets
      defaultMode: 0400  # åªæœ‰å±ä¸»å¯è¯»
```

### 9.4 ç›‘æ§å’Œå‘Šè­¦


**Secretè®¿é—®ç›‘æ§**ï¼š
```yaml
# Prometheusç›‘æ§è§„åˆ™
groups:
- name: secret-security
  rules:
  - alert: UnauthorizedSecretAccess
    expr: |
      increase(apiserver_audit_total{
        objectRef_resource="secrets",
        verb=~"get|list",
        user_username!~"system:.*"
      }[5m]) > 0
    for: 0m
    labels:
      severity: warning
    annotations:
      summary: "æ£€æµ‹åˆ°éç³»ç»Ÿç”¨æˆ·è®¿é—®Secret"
      
  - alert: SecretCreationAnomaly  
    expr: |
      increase(apiserver_audit_total{
        objectRef_resource="secrets",
        verb="create"
      }[1h]) > 10
    for: 5m
    labels:
      severity: critical
    annotations:
      summary: "Secretåˆ›å»ºé¢‘ç‡å¼‚å¸¸"
```

### 9.5 ç¾éš¾æ¢å¤å‡†å¤‡


**Secretå¤‡ä»½ç­–ç•¥**ï¼š
```bash
#!/bin/bash
# Secretå¤‡ä»½è„šæœ¬

# 1. å¯¼å‡ºæ‰€æœ‰Secretï¼ˆæ³¨æ„å®‰å…¨å­˜å‚¨å¤‡ä»½æ–‡ä»¶ï¼‰
kubectl get secrets --all-namespaces -o yaml > secrets-backup.yaml

# 2. åŠ å¯†å¤‡ä»½æ–‡ä»¶
gpg --cipher-algo AES256 --compress-algo 1 --s2k-mode 3 \
    --s2k-digest-algo SHA512 --s2k-count 65536 --force-mdc \
    --output secrets-backup.yaml.gpg --symmetric secrets-backup.yaml

# 3. åˆ é™¤æ˜æ–‡å¤‡ä»½
rm secrets-backup.yaml

# 4. å­˜å‚¨åˆ°å®‰å…¨ä½ç½®
aws s3 cp secrets-backup.yaml.gpg s3://secure-backup-bucket/
```

**æ¢å¤éªŒè¯æµç¨‹**ï¼š
```bash
# 1. è§£å¯†å¤‡ä»½æ–‡ä»¶
gpg --output secrets-restore.yaml --decrypt secrets-backup.yaml.gpg

# 2. éªŒè¯å¤‡ä»½å®Œæ•´æ€§
kubectl apply --dry-run=client -f secrets-restore.yaml

# 3. åˆ†æ‰¹æ¢å¤ï¼ˆé¿å…ä¸€æ¬¡æ€§å¤§é‡æ“ä½œï¼‰
kubectl apply -f secrets-restore.yaml

# 4. éªŒè¯SecretåŠŸèƒ½æ­£å¸¸
kubectl get secrets --all-namespaces
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Secretæœ¬è´¨ï¼šKubernetesä¸­å­˜å‚¨æ•æ„Ÿæ•°æ®çš„ä¸“ç”¨èµ„æºå¯¹è±¡
ğŸ”¸ æ ¸å¿ƒç±»å‹ï¼šOpaqueé€šç”¨å‹ã€docker-registryé•œåƒæ‹‰å–ã€tlsè¯ä¹¦å‹
ğŸ”¸ ä½¿ç”¨æ–¹å¼ï¼šç¯å¢ƒå˜é‡æ³¨å…¥ã€æ–‡ä»¶å·æŒ‚è½½ã€subPathç²¾ç¡®æŒ‚è½½
ğŸ”¸ æƒé™æ§åˆ¶ï¼šRBACæƒé™æ¨¡å‹ã€å‘½åç©ºé—´éš”ç¦»ã€æœ€å°æƒé™åŸåˆ™
ğŸ”¸ è½®è½¬æ›´æ–°ï¼šå®šæœŸæ›´æ¢ã€é›¶åœæœºéƒ¨ç½²ã€è‡ªåŠ¨åŒ–ç®¡ç†
ğŸ”¸ å®‰å…¨å®è·µï¼šé™æ€åŠ å¯†ã€ä¼ è¾“å®‰å…¨ã€ç›‘æ§å®¡è®¡ã€å¤‡ä»½æ¢å¤
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ Secretä¸ConfigMapçš„æœ¬è´¨åŒºåˆ«**ï¼š
```
é€‰æ‹©æ ‡å‡†ï¼š
æ•°æ®æ˜¯å¦æ•æ„Ÿï¼Ÿ
â”œâ”€â”€ æ•æ„Ÿï¼ˆå¯†ç ã€è¯ä¹¦ã€APIå¯†é’¥ï¼‰â†’ Secret
â””â”€â”€ éæ•æ„Ÿï¼ˆåº”ç”¨é…ç½®ã€ç‰¹æ€§å¼€å…³ï¼‰â†’ ConfigMap

å¤„ç†æ–¹å¼ï¼š
Secret â†’ Base64ç¼–ç  + æƒé™æ§åˆ¶ + å®¡è®¡æ—¥å¿—
ConfigMap â†’ æ˜æ–‡å­˜å‚¨ + ç›¸å¯¹å®½æ¾æƒé™
```

**ğŸ”¹ æŒ‚è½½æ–¹å¼çš„é€‰æ‹©åŸåˆ™**ï¼š
```
ç¯å¢ƒå˜é‡ï¼šé€‚åˆçŸ­å°ã€ç®€å•çš„å¯†é’¥
æ–‡ä»¶æŒ‚è½½ï¼šé€‚åˆé…ç½®æ–‡ä»¶ã€è¯ä¹¦ã€å¤æ‚æ•°æ®ç»“æ„
subPathï¼šé€‚åˆéœ€è¦ç²¾ç¡®æ§åˆ¶æ–‡ä»¶è·¯å¾„çš„åœºæ™¯

å®‰å…¨æ€§ï¼šæ–‡ä»¶æŒ‚è½½ > subPath > ç¯å¢ƒå˜é‡
ä¾¿åˆ©æ€§ï¼šç¯å¢ƒå˜é‡ > subPath > æ–‡ä»¶æŒ‚è½½
```

**ğŸ”¹ å®‰å…¨å®è·µçš„å±‚æ¬¡åŒ–é˜²æŠ¤**ï¼š
```
å­˜å‚¨å±‚å®‰å…¨ï¼šetcdåŠ å¯†ã€RBACæƒé™ã€å‘½åç©ºé—´éš”ç¦»
ä¼ è¾“å±‚å®‰å…¨ï¼šTLSåŠ å¯†ã€ç½‘ç»œç­–ç•¥é™åˆ¶
åº”ç”¨å±‚å®‰å…¨ï¼šåªè¯»æŒ‚è½½ã€érootç”¨æˆ·ã€æ–‡ä»¶æƒé™æ§åˆ¶
ç›‘æ§å±‚å®‰å…¨ï¼šè®¿é—®å®¡è®¡ã€å¼‚å¸¸å‘Šè­¦ã€è¡Œä¸ºåˆ†æ
```

### 10.3 å®é™…åº”ç”¨ä»·å€¼


- **å®¹å™¨åŒ–åº”ç”¨**ï¼šå®‰å…¨ç®¡ç†åº”ç”¨å¯†é’¥å’Œé…ç½®
- **å¾®æœåŠ¡æ¶æ„**ï¼šæœåŠ¡é—´è®¤è¯å’ŒAPIå¯†é’¥ç®¡ç†
- **CI/CDæµæ°´çº¿**ï¼šé•œåƒä»“åº“è®¤è¯å’Œéƒ¨ç½²å¯†é’¥
- **æ•°æ®åº“è¿æ¥**ï¼šæ•°æ®åº“å¯†ç å’Œè¿æ¥å­—ç¬¦ä¸²ç®¡ç†
- **è¯ä¹¦ç®¡ç†**ï¼šHTTPSè¯ä¹¦çš„å­˜å‚¨å’Œè‡ªåŠ¨æ›´æ–°
- **åˆè§„è¦æ±‚**ï¼šæ»¡è¶³å®‰å…¨å®¡è®¡å’Œå¯†é’¥è½®è½¬éœ€æ±‚

### 10.4 å¸¸è§é—®é¢˜é¿å‘æŒ‡å—


```
âŒ å¸¸è§é”™è¯¯ï¼š
â€¢ æŠŠSecretå½“ConfigMapç”¨ï¼Œå­˜å‚¨éæ•æ„Ÿæ•°æ®
â€¢ åœ¨ä»£ç ä¸­ç¡¬ç¼–ç Secretåç§°å’Œkeyåç§°
â€¢ ç»™Podè¿‡å¤§çš„Secretè®¿é—®æƒé™
â€¢ é•¿æœŸä¸æ›´æ–°å¯†é’¥ï¼Œå­˜åœ¨å®‰å…¨é£é™©
â€¢ åœ¨æ—¥å¿—ä¸­æ‰“å°Secretå†…å®¹

âœ… æ­£ç¡®åšæ³•ï¼š
â€¢ æ•æ„Ÿæ•°æ®ç”¨Secretï¼Œé…ç½®æ•°æ®ç”¨ConfigMap
â€¢ é€šè¿‡ç¯å¢ƒå˜é‡ä¼ é€’Secretåç§°å’Œkey
â€¢ éµå¾ªæœ€å°æƒé™åŸåˆ™ï¼Œåªæˆæƒå¿…éœ€çš„è®¿é—®
â€¢ å®šæœŸè½®è½¬å¯†é’¥ï¼Œè‡ªåŠ¨åŒ–ç®¡ç†æµç¨‹
â€¢ ç¡®ä¿åº”ç”¨ä¸ä¼šæ„å¤–æ³„éœ²å¯†é’¥å†…å®¹
```

### 10.5 è¿›é˜¶å­¦ä¹ æ–¹å‘


```
æ·±å…¥æ–¹å‘ï¼š
â”œâ”€â”€ External Secrets Operatorï¼šé›†æˆå¤–éƒ¨å¯†é’¥ç®¡ç†ç³»ç»Ÿ
â”œâ”€â”€ Sealed Secretsï¼šGitOpsåœºæ™¯ä¸‹çš„å¯†é’¥ç®¡ç†
â”œâ”€â”€ cert-managerï¼šè‡ªåŠ¨åŒ–è¯ä¹¦ç®¡ç†å’Œæ›´æ–°
â”œâ”€â”€ Vaulté›†æˆï¼šä¼ä¸šçº§å¯†é’¥ç®¡ç†è§£å†³æ–¹æ¡ˆ
â””â”€â”€ Security Policyï¼šPod Security Standardså’Œå®‰å…¨ç­–ç•¥

å®è·µé¡¹ç›®ï¼š
â”œâ”€â”€ æ­å»ºå®Œæ•´çš„å¯†é’¥ç®¡ç†æµæ°´çº¿
â”œâ”€â”€ å®ç°è‡ªåŠ¨åŒ–å¯†é’¥è½®è½¬ç³»ç»Ÿ
â”œâ”€â”€ é›†æˆç›‘æ§å‘Šè­¦å’Œå®‰å…¨å®¡è®¡
â””â”€â”€ è®¾è®¡ç¾éš¾æ¢å¤æ–¹æ¡ˆ
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- Secretä¸“å­˜æ•æ„Ÿæ•°æ®ï¼ŒBase64ç¼–ç éåŠ å¯†
- ç¯å¢ƒå˜é‡ç®€å•ä¾¿æ·ï¼Œæ–‡ä»¶æŒ‚è½½æ›´åŠ å®‰å…¨
- æƒé™æ§åˆ¶éµå¾ªæœ€å°ï¼Œå‘½åç©ºé—´å¤©ç„¶éš”ç¦»
- å®šæœŸè½®è½¬ä¿éšœå®‰å…¨ï¼Œç›‘æ§å®¡è®¡ä¸å¯ç¼º
- å¤‡ä»½æ¢å¤é¢„æ¡ˆé½å…¨ï¼Œå®‰å…¨å®è·µå±‚å±‚é˜²æŠ¤