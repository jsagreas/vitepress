---
title: 9ã€å‘½åç©ºé—´ä¸èµ„æºéš”ç¦»
---
## ğŸ“š ç›®å½•

1. [å‘½åç©ºé—´åŸºç¡€æ¦‚å¿µ](#1-å‘½åç©ºé—´åŸºç¡€æ¦‚å¿µ)
2. [å‘½åç©ºé—´åˆ›å»ºä¸ç®¡ç†](#2-å‘½åç©ºé—´åˆ›å»ºä¸ç®¡ç†)
3. [èµ„æºé…é¢ä¸é™åˆ¶æ§åˆ¶](#3-èµ„æºé…é¢ä¸é™åˆ¶æ§åˆ¶)
4. [ç½‘ç»œç­–ç•¥ä¸éš”ç¦»](#4-ç½‘ç»œç­–ç•¥ä¸éš”ç¦»)
5. [RBACæƒé™æ§åˆ¶](#5-RBACæƒé™æ§åˆ¶)
6. [å¤šç§Ÿæˆ·éš”ç¦»è®¾è®¡](#6-å¤šç§Ÿæˆ·éš”ç¦»è®¾è®¡)
7. [è·¨å‘½åç©ºé—´é€šä¿¡](#7-è·¨å‘½åç©ºé—´é€šä¿¡)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ  å‘½åç©ºé—´åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯å‘½åç©ºé—´


**ğŸ’¡ ç”Ÿæ´»ç±»æ¯”**ï¼š
å‘½åç©ºé—´å°±åƒ**å…¬å¯“æ¥¼é‡Œçš„ä¸åŒæˆ¿é—´**ï¼Œæ¯ä¸ªæˆ¿é—´éƒ½æœ‰ç‹¬ç«‹çš„é—¨ç‰Œå·ï¼Œæˆ¿é—´å†…çš„ç‰©å“ä¸ä¼šä¸å…¶ä»–æˆ¿é—´æ··æ·†ï¼Œä½†æ•´æ ‹æ¥¼å…±äº«åŸºç¡€è®¾æ–½ï¼ˆç”µæ¢¯ã€èµ°å»Šï¼‰ã€‚

```
K8sé›†ç¾¤ = æ•´æ ‹å…¬å¯“æ¥¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‘½åç©ºé—´A (å¼€å‘ç¯å¢ƒ)        â”‚ â† 1å·æˆ¿é—´
â”‚  Pod1, Service1, Deployment1â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‘½åç©ºé—´B (æµ‹è¯•ç¯å¢ƒ)        â”‚ â† 2å·æˆ¿é—´  
â”‚  Pod2, Service2, Deployment2â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‘½åç©ºé—´C (ç”Ÿäº§ç¯å¢ƒ)        â”‚ â† 3å·æˆ¿é—´
â”‚  Pod3, Service3, Deployment3â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 å‘½åç©ºé—´çš„æ ¸å¿ƒä½œç”¨


**ğŸ¯ ä¸»è¦åŠŸèƒ½**ï¼š
- **ğŸ·ï¸ åç§°éš”ç¦»**ï¼šä¸åŒå‘½åç©ºé—´å¯ä»¥æœ‰åŒåèµ„æº
- **ğŸ”’ èµ„æºéš”ç¦»**ï¼šé™åˆ¶èµ„æºä½¿ç”¨é‡ï¼Œé˜²æ­¢ç›¸äº’å½±å“
- **ğŸ‘¥ æƒé™éš”ç¦»**ï¼šä¸åŒç”¨æˆ·åªèƒ½è®¿é—®ç‰¹å®šå‘½åç©ºé—´
- **ğŸŒ ç½‘ç»œéš”ç¦»**ï¼šé€šè¿‡ç­–ç•¥æ§åˆ¶è·¨å‘½åç©ºé—´é€šä¿¡

**ğŸ“Š é»˜è®¤å‘½åç©ºé—´**ï¼š
```
default          â† é»˜è®¤å‘½åç©ºé—´ï¼Œç”¨æˆ·åˆ›å»ºèµ„æºçš„é»˜è®¤ä½ç½®
kube-system      â† ç³»ç»Ÿç»„ä»¶ä¸“ç”¨ï¼Œå¦‚DNSã€ä»£ç†ç­‰
kube-public      â† å…¬å…±èµ„æºï¼Œæ‰€æœ‰ç”¨æˆ·å¯è¯»
kube-node-lease  â† èŠ‚ç‚¹å¿ƒè·³ä¿¡æ¯å­˜å‚¨
```

---

## 2. ğŸ› ï¸ å‘½åç©ºé—´åˆ›å»ºä¸ç®¡ç†


### 2.1 åˆ›å»ºå‘½åç©ºé—´çš„æ–¹å¼


**æ–¹å¼ä¸€ï¼šå‘½ä»¤è¡Œåˆ›å»º**
```bash
# åˆ›å»ºå¼€å‘ç¯å¢ƒå‘½åç©ºé—´
kubectl create namespace development

# åˆ›å»ºæµ‹è¯•ç¯å¢ƒå‘½åç©ºé—´  
kubectl create namespace testing

# åˆ›å»ºç”Ÿäº§ç¯å¢ƒå‘½åç©ºé—´
kubectl create namespace production
```

**æ–¹å¼äºŒï¼šYAMLæ–‡ä»¶åˆ›å»º**
```yaml
apiVersion: v1
kind: Namespace
metadata:
  name: my-app
  labels:
    environment: production
    team: backend
  annotations:
    description: "åç«¯å›¢é˜Ÿç”Ÿäº§ç¯å¢ƒ"
```

**ğŸ“‹ åº”ç”¨YAMLåˆ›å»º**ï¼š
```bash
kubectl apply -f namespace.yaml
```

### 2.2 å‘½åç©ºé—´ç®¡ç†æ“ä½œ


**æŸ¥çœ‹å‘½åç©ºé—´**ï¼š
```bash
# æŸ¥çœ‹æ‰€æœ‰å‘½åç©ºé—´
kubectl get namespaces

# æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
kubectl describe namespace development

# æŸ¥çœ‹ç‰¹å®šæ ‡ç­¾çš„å‘½åç©ºé—´
kubectl get ns -l environment=production
```

**åˆ‡æ¢å·¥ä½œå‘½åç©ºé—´**ï¼š
```bash
# è®¾ç½®å½“å‰ä¸Šä¸‹æ–‡çš„é»˜è®¤å‘½åç©ºé—´
kubectl config set-context --current --namespace=development

# æŸ¥çœ‹å½“å‰ä¸Šä¸‹æ–‡
kubectl config view --minify | grep namespace
```

**åˆ é™¤å‘½åç©ºé—´**ï¼š
```bash
# âš ï¸ æ³¨æ„ï¼šåˆ é™¤å‘½åç©ºé—´ä¼šåˆ é™¤å…¶ä¸­æ‰€æœ‰èµ„æº
kubectl delete namespace testing
```

### 2.3 å‘½åç©ºé—´æ ‡ç­¾ä¸é€‰æ‹©å™¨


**ğŸ·ï¸ æ ‡ç­¾ç®¡ç†ç­–ç•¥**ï¼š
```yaml
metadata:
  name: frontend-prod
  labels:
    app: frontend           # åº”ç”¨æ ‡è¯†
    environment: production # ç¯å¢ƒæ ‡è¯†  
    team: ui-team          # å›¢é˜Ÿæ ‡è¯†
    version: v2.0          # ç‰ˆæœ¬æ ‡è¯†
```

**é€‰æ‹©å™¨ä½¿ç”¨**ï¼š
```bash
# æŒ‰ç¯å¢ƒé€‰æ‹©
kubectl get ns -l environment=production

# æŒ‰å›¢é˜Ÿé€‰æ‹©  
kubectl get ns -l team=backend

# å¤åˆæ¡ä»¶é€‰æ‹©
kubectl get ns -l environment=production,team=backend
```

---

## 3. ğŸ“Š èµ„æºé…é¢ä¸é™åˆ¶æ§åˆ¶


### 3.1 ResourceQuotaèµ„æºé…é¢


**ğŸ¯ é…é¢æ§åˆ¶åŸç†**ï¼š
ResourceQuotaå°±åƒ**é“¶è¡Œè´¦æˆ·çš„é¢åº¦é™åˆ¶**ï¼Œæ¯ä¸ªå‘½åç©ºé—´éƒ½æœ‰å›ºå®šçš„"èµ„æºé¢„ç®—"ï¼Œä¸èƒ½è¶…æ”¯ä½¿ç”¨ã€‚

```yaml
apiVersion: v1
kind: ResourceQuota
metadata:
  name: compute-quota
  namespace: development
spec:
  hard:
    # CPUå’Œå†…å­˜é™åˆ¶
    requests.cpu: "4"           # æœ€å¤šç”³è¯·4æ ¸CPU
    requests.memory: 8Gi        # æœ€å¤šç”³è¯·8GBå†…å­˜
    limits.cpu: "8"             # æœ€å¤šé™åˆ¶8æ ¸CPU  
    limits.memory: 16Gi         # æœ€å¤šé™åˆ¶16GBå†…å­˜
    
    # Podæ•°é‡é™åˆ¶
    pods: "10"                  # æœ€å¤š10ä¸ªPod
    
    # å­˜å‚¨é™åˆ¶  
    persistentvolumeclaims: "4" # æœ€å¤š4ä¸ªPVC
    requests.storage: 100Gi     # æœ€å¤šç”³è¯·100GBå­˜å‚¨
```

**ğŸ“ˆ å¸¸ç”¨é…é¢ç±»å‹**ï¼š
```yaml
spec:
  hard:
    # ğŸ–¥ï¸ è®¡ç®—èµ„æºé…é¢
    requests.cpu: "10"
    limits.cpu: "20"
    requests.memory: 20Gi
    limits.memory: 40Gi
    
    # ğŸ“¦ å¯¹è±¡æ•°é‡é…é¢  
    pods: "20"
    services: "10"
    secrets: "10"
    configmaps: "10"
    
    # ğŸ’¾ å­˜å‚¨é…é¢
    requests.storage: 500Gi
    persistentvolumeclaims: "8"
```

### 3.2 LimitRangeèµ„æºèŒƒå›´çº¦æŸ


**ğŸ”§ å•ä¸ªèµ„æºé™åˆ¶**ï¼š
LimitRangeåƒ**æ¯ä¸ªæˆ¿é—´çš„ç”¨ç”µé™åˆ¶**ï¼Œç¡®ä¿å•ä¸ªPodä¸ä¼šè¿‡åº¦æ¶ˆè€—èµ„æºã€‚

```yaml
apiVersion: v1
kind: LimitRange
metadata:
  name: resource-limits
  namespace: development  
spec:
  limits:
  # Podçº§åˆ«é™åˆ¶
  - type: Pod
    max:
      cpu: "2"         # å•ä¸ªPodæœ€å¤§2æ ¸
      memory: 4Gi      # å•ä¸ªPodæœ€å¤§4GBå†…å­˜
    min:
      cpu: 100m        # å•ä¸ªPodæœ€å°0.1æ ¸
      memory: 128Mi    # å•ä¸ªPodæœ€å°128MBå†…å­˜
      
  # Containerçº§åˆ«é™åˆ¶  
  - type: Container
    default:
      cpu: 500m        # é»˜è®¤CPUé™åˆ¶
      memory: 512Mi    # é»˜è®¤å†…å­˜é™åˆ¶
    defaultRequest:
      cpu: 100m        # é»˜è®¤CPUè¯·æ±‚
      memory: 128Mi    # é»˜è®¤å†…å­˜è¯·æ±‚
```

**ğŸ’¡ é…é¢ç›‘æ§éªŒè¯**ï¼š
```bash
# æŸ¥çœ‹å‘½åç©ºé—´èµ„æºä½¿ç”¨æƒ…å†µ
kubectl describe quota -n development

# æŸ¥çœ‹LimitRangeè®¾ç½®
kubectl describe limitrange -n development

# æŸ¥çœ‹èµ„æºä½¿ç”¨ç»Ÿè®¡
kubectl top pods -n development
```

---

## 4. ğŸŒ ç½‘ç»œç­–ç•¥ä¸éš”ç¦»


### 4.1 NetworkPolicyç½‘ç»œéš”ç¦»


**ğŸ”’ ç½‘ç»œéš”ç¦»æ¦‚å¿µ**ï¼š
ç½‘ç»œç­–ç•¥å°±åƒ**é˜²ç«å¢™è§„åˆ™**ï¼Œæ§åˆ¶å“ªäº›Podä¹‹é—´å¯ä»¥é€šä¿¡ï¼Œå“ªäº›ä¸è¡Œã€‚

```yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: deny-all
  namespace: production
spec:
  # åº”ç”¨åˆ°æ‰€æœ‰Pod
  podSelector: {}
  
  # é»˜è®¤æ‹’ç»æ‰€æœ‰å…¥ç«™æµé‡
  policyTypes:
  - Ingress
  - Egress
```

### 4.2 å…è®¸ç‰¹å®šé€šä¿¡çš„ç½‘ç»œç­–ç•¥


**å…è®¸å‰ç«¯è®¿é—®åç«¯**ï¼š
```yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-frontend-to-backend
  namespace: production
spec:
  # åº”ç”¨åˆ°åç«¯Pod
  podSelector:
    matchLabels:
      app: backend
      
  policyTypes:
  - Ingress
  
  ingress:
  # åªå…è®¸å‰ç«¯Podè®¿é—®
  - from:
    - podSelector:
        matchLabels:
          app: frontend
    # åªå…è®¸è®¿é—®8080ç«¯å£      
    ports:
    - protocol: TCP
      port: 8080
```

**è·¨å‘½åç©ºé—´è®¿é—®æ§åˆ¶**ï¼š
```yaml
apiVersion: networking.k8s.io/v1  
kind: NetworkPolicy
metadata:
  name: allow-cross-namespace
  namespace: production
spec:
  podSelector:
    matchLabels:
      app: api-server
      
  policyTypes:
  - Ingress
  
  ingress:
  # å…è®¸developmentå‘½åç©ºé—´çš„ç‰¹å®šPodè®¿é—®
  - from:
    - namespaceSelector:
        matchLabels:
          name: development
      podSelector:
        matchLabels:
          app: test-client
```

### 4.3 ç½‘ç»œç­–ç•¥å®è·µæ¨¡å¼


**ğŸ›¡ï¸ å¸¸ç”¨éš”ç¦»æ¨¡å¼**ï¼š

| éš”ç¦»æ¨¡å¼ | **åº”ç”¨åœºæ™¯** | **ç­–ç•¥æè¿°** |
|---------|-------------|-------------|
| ğŸš« **å…¨æ‹’ç»** | `é«˜å®‰å…¨ç¯å¢ƒ` | `é»˜è®¤æ‹’ç»æ‰€æœ‰é€šä¿¡ï¼Œé€ä¸ªå¼€æ”¾` |
| ğŸ¯ **é€‰æ‹©æ€§å…è®¸** | `å¾®æœåŠ¡æ¶æ„` | `åªå…è®¸å¿…è¦çš„æœåŠ¡é—´é€šä¿¡` |
| ğŸ¢ **å¤šç§Ÿæˆ·éš”ç¦»** | `å…±äº«é›†ç¾¤` | `ä¸åŒç§Ÿæˆ·å‘½åç©ºé—´å®Œå…¨éš”ç¦»` |
| ğŸ”„ **ç¯å¢ƒéš”ç¦»** | `å¼€å‘è¿ç»´` | `å¼€å‘/æµ‹è¯•/ç”Ÿäº§ç¯å¢ƒéš”ç¦»` |

---

## 5. ğŸ‘¤ RBACæƒé™æ§åˆ¶


### 5.1 RBACåŸºæœ¬æ¦‚å¿µ


**ğŸ­ æƒé™æ§åˆ¶åŸç†**ï¼š
RBACå°±åƒ**å…¬å¸çš„æƒé™ç®¡ç†ç³»ç»Ÿ**ï¼š
- **ç”¨æˆ·(User)**ï¼šå…·ä½“çš„äººæˆ–ç³»ç»Ÿè´¦å·
- **è§’è‰²(Role)**ï¼šä¸€ç»„æƒé™çš„é›†åˆï¼Œå¦‚"å¼€å‘è€…"ã€"è¿ç»´è€…"
- **æƒé™(Permission)**ï¼šå…·ä½“èƒ½åšä»€ä¹ˆæ“ä½œ
- **ç»‘å®š(Binding)**ï¼šå°†ç”¨æˆ·å’Œè§’è‰²å…³è”èµ·æ¥

```
ç”¨æˆ· â”€â”€ç»‘å®šâ”€â”€> è§’è‰² â”€â”€åŒ…å«â”€â”€> æƒé™é›†åˆ
å¼ ä¸‰ â”€â”€â”€â”€â”€â”€â”€â”€> å¼€å‘è€… â”€â”€â”€â”€â”€â”€â”€â”€> [æŸ¥çœ‹Pod, åˆ›å»ºService]
æå›› â”€â”€â”€â”€â”€â”€â”€â”€> è¿ç»´è€… â”€â”€â”€â”€â”€â”€â”€â”€> [åˆ é™¤Pod, ç®¡ç†Node]
```

### 5.2 åˆ›å»ºè§’è‰²å’Œæƒé™


**åˆ›å»ºå‘½åç©ºé—´çº§åˆ«çš„è§’è‰²**ï¼š
```yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: development
  name: pod-reader
rules:
# å…è®¸è¯»å–Pod
- apiGroups: [""]
  resources: ["pods"]
  verbs: ["get", "watch", "list"]
  
# å…è®¸è¯»å–Service  
- apiGroups: [""]
  resources: ["services"]
  verbs: ["get", "list"]
```

**åˆ›å»ºé›†ç¾¤çº§åˆ«çš„è§’è‰²**ï¼š
```yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: node-reader
rules:
# å…è®¸è¯»å–èŠ‚ç‚¹ä¿¡æ¯
- apiGroups: [""]
  resources: ["nodes"]
  verbs: ["get", "list", "watch"]
```

### 5.3 è§’è‰²ç»‘å®š


**å°†ç”¨æˆ·ç»‘å®šåˆ°è§’è‰²**ï¼š
```yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: read-pods
  namespace: development
subjects:
# ç»‘å®šç”¨æˆ·
- kind: User
  name: jane
  apiGroup: rbac.authorization.k8s.io
# ç»‘å®šæœåŠ¡è´¦å·  
- kind: ServiceAccount
  name: default
  namespace: development
roleRef:
  kind: Role
  name: pod-reader
  apiGroup: rbac.authorization.k8s.io
```

**ğŸ”§ æƒé™éªŒè¯**ï¼š
```bash
# æ£€æŸ¥ç”¨æˆ·æƒé™
kubectl auth can-i get pods --namespace=development --as=jane

# æ£€æŸ¥æœåŠ¡è´¦å·æƒé™  
kubectl auth can-i create deployments --as=system:serviceaccount:development:default
```

---

## 6. ğŸ—ï¸ å¤šç§Ÿæˆ·éš”ç¦»è®¾è®¡


### 6.1 å¤šç§Ÿæˆ·æ¶æ„æ¨¡å¼


**ğŸ¢ ç§Ÿæˆ·éš”ç¦»ç­–ç•¥**ï¼š

```
é›†ç¾¤çº§å¤šç§Ÿæˆ·æ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           K8s Cluster               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ç§Ÿæˆ·Aç©ºé—´      â”‚    ç§Ÿæˆ·Bç©ºé—´       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚å¼€å‘ç¯å¢ƒns   â”‚â”‚  â”‚å¼€å‘ç¯å¢ƒns   â”‚  â”‚
â”‚  â”‚æµ‹è¯•ç¯å¢ƒns   â”‚â”‚  â”‚æµ‹è¯•ç¯å¢ƒns   â”‚  â”‚  
â”‚  â”‚ç”Ÿäº§ç¯å¢ƒns   â”‚â”‚  â”‚ç”Ÿäº§ç¯å¢ƒns   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 ç§Ÿæˆ·èµ„æºé…ç½®æ¨¡æ¿


**ç§Ÿæˆ·å‘½åç©ºé—´åˆ›å»ºè„šæœ¬**ï¼š
```yaml
# ç§Ÿæˆ·Açš„å¼€å‘ç¯å¢ƒ
apiVersion: v1
kind: Namespace
metadata:
  name: tenant-a-dev
  labels:
    tenant: tenant-a
    environment: development
---
# ç§Ÿæˆ·Açš„èµ„æºé…é¢
apiVersion: v1
kind: ResourceQuota
metadata:
  name: tenant-a-dev-quota
  namespace: tenant-a-dev
spec:
  hard:
    requests.cpu: "2"
    requests.memory: 4Gi
    limits.cpu: "4"  
    limits.memory: 8Gi
    pods: "10"
---
# ç§Ÿæˆ·Açš„ç½‘ç»œç­–ç•¥
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: tenant-a-isolation
  namespace: tenant-a-dev
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress
  ingress:
  # åªå…è®¸åŒç§Ÿæˆ·å‘½åç©ºé—´é€šä¿¡
  - from:
    - namespaceSelector:
        matchLabels:
          tenant: tenant-a
```

### 6.3 ç§Ÿæˆ·æƒé™ç®¡ç†


**ç§Ÿæˆ·ç®¡ç†å‘˜è§’è‰²**ï¼š
```yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: tenant-a-dev
  name: tenant-admin
rules:
# å®Œå…¨æ§åˆ¶è‡ªå·±å‘½åç©ºé—´çš„èµ„æº
- apiGroups: ["*"]
  resources: ["*"] 
  verbs: ["*"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: tenant-a-admin-binding
  namespace: tenant-a-dev
subjects:
- kind: User
  name: tenant-a-admin
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: tenant-admin
  apiGroup: rbac.authorization.k8s.io
```

---

## 7. ğŸ”— è·¨å‘½åç©ºé—´é€šä¿¡


### 7.1 æœåŠ¡å‘ç°æœºåˆ¶


**ğŸ’¡ æœåŠ¡é€šä¿¡åŸç†**ï¼š
Podä¹‹é—´é€šä¿¡å°±åƒ**æ‰“ç”µè¯**ï¼Œéœ€è¦çŸ¥é“å¯¹æ–¹çš„"ç”µè¯å·ç "ï¼ˆæœåŠ¡åå’Œå‘½åç©ºé—´ï¼‰ã€‚

**åŒå‘½åç©ºé—´å†…é€šä¿¡**ï¼š
```yaml
# åœ¨åŒä¸€å‘½åç©ºé—´å†…ï¼Œç›´æ¥ç”¨æœåŠ¡å
apiVersion: v1  
kind: Pod
metadata:
  name: client-pod
  namespace: development
spec:
  containers:
  - name: client
    image: nginx
    env:
    - name: API_URL
      value: "http://api-service:8080"  # ç›´æ¥ä½¿ç”¨æœåŠ¡å
```

**è·¨å‘½åç©ºé—´é€šä¿¡**ï¼š
```yaml
apiVersion: v1
kind: Pod  
metadata:
  name: client-pod
  namespace: development
spec:
  containers:
  - name: client
    image: nginx
    env:
    - name: API_URL
      # æ ¼å¼ï¼šæœåŠ¡å.å‘½åç©ºé—´å.svc.cluster.local
      value: "http://api-service.production.svc.cluster.local:8080"
```

### 7.2 è·¨å‘½åç©ºé—´èµ„æºå¼•ç”¨


**ConfigMapè·¨å‘½åç©ºé—´ä½¿ç”¨**ï¼š
```yaml
# åœ¨productionå‘½åç©ºé—´åˆ›å»ºConfigMap
apiVersion: v1
kind: ConfigMap
metadata:
  name: shared-config
  namespace: production
data:
  database_url: "mysql://prod-db:3306"
---
# åœ¨developmentå‘½åç©ºé—´çš„Podä¸­å¼•ç”¨
apiVersion: v1
kind: Pod
metadata:
  name: app-pod
  namespace: development  
spec:
  containers:
  - name: app
    image: myapp
    envFrom:
    # âŒ è¿™æ ·ä¸è¡Œï¼ConfigMapä¸èƒ½è·¨å‘½åç©ºé—´ç›´æ¥å¼•ç”¨
    - configMapRef:
        name: shared-config  # åªèƒ½å¼•ç”¨åŒå‘½åç©ºé—´çš„
```

**ğŸ”§ è·¨å‘½åç©ºé—´æ•°æ®å…±äº«æ–¹æ¡ˆ**ï¼š
```bash
# æ–¹æ¡ˆ1ï¼šå¤åˆ¶ConfigMapåˆ°ç›®æ ‡å‘½åç©ºé—´
kubectl get configmap shared-config -n production -o yaml | \
sed 's/namespace: production/namespace: development/' | \
kubectl apply -f -

# æ–¹æ¡ˆ2ï¼šä½¿ç”¨External Secrets Operator
# æ–¹æ¡ˆ3ï¼šä½¿ç”¨å…±äº«å­˜å‚¨å·
```

### 7.3 æœåŠ¡ç½‘æ ¼ä¸­çš„è·¨å‘½åç©ºé—´é€šä¿¡


**Istioä¸­çš„è·¨å‘½åç©ºé—´ç­–ç•¥**ï¼š
```yaml
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: cross-ns-access
  namespace: production
spec:
  # å…è®¸developmentå‘½åç©ºé—´è®¿é—®
  rules:
  - from:
    - source:
        namespaces: ["development"]
  - to:
    - operation:
        methods: ["GET", "POST"]
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ  å‘½åç©ºé—´ï¼šK8sä¸­çš„èµ„æºéš”ç¦»å•å…ƒï¼Œç±»ä¼¼ç‹¬ç«‹æˆ¿é—´
ğŸ“Š ResourceQuotaï¼šé™åˆ¶å‘½åç©ºé—´æ€»èµ„æºä½¿ç”¨é‡
ğŸ”§ LimitRangeï¼šé™åˆ¶å•ä¸ªèµ„æºçš„ä½¿ç”¨èŒƒå›´  
ğŸŒ NetworkPolicyï¼šæ§åˆ¶Podé—´ç½‘ç»œé€šä¿¡è§„åˆ™
ğŸ‘¤ RBACï¼šåŸºäºè§’è‰²çš„æƒé™è®¿é—®æ§åˆ¶
ğŸ—ï¸ å¤šç§Ÿæˆ·ï¼šåœ¨å…±äº«é›†ç¾¤ä¸­å®ç°ç§Ÿæˆ·éš”ç¦»
ğŸ”— è·¨å‘½åç©ºé—´é€šä¿¡ï¼šä½¿ç”¨å®Œæ•´åŸŸåè¿›è¡ŒæœåŠ¡å‘ç°
```

### 8.2 å…³é”®å®è·µè¦ç‚¹


**ğŸ¯ å‘½åç©ºé—´è®¾è®¡åŸåˆ™**ï¼š
```
ç¯å¢ƒéš”ç¦»ï¼šå¼€å‘/æµ‹è¯•/ç”Ÿäº§åˆ†åˆ«ä½¿ç”¨ä¸åŒå‘½åç©ºé—´
å›¢é˜Ÿéš”ç¦»ï¼šä¸åŒå›¢é˜Ÿä½¿ç”¨ç‹¬ç«‹å‘½åç©ºé—´
åº”ç”¨éš”ç¦»ï¼šå¤§å‹åº”ç”¨çš„ä¸åŒæ¨¡å—ä½¿ç”¨ç‹¬ç«‹å‘½åç©ºé—´
ç§Ÿæˆ·éš”ç¦»ï¼šå¤šç§Ÿæˆ·åœºæ™¯ä¸‹æ¯ä¸ªç§Ÿæˆ·ç‹¬ç«‹å‘½åç©ºé—´
```

**âš¡ èµ„æºç®¡æ§æœ€ä½³å®è·µ**ï¼š
```
é¢„é˜²æ€§é…é¢ï¼šæå‰è®¾ç½®ResourceQuotaé˜²æ­¢èµ„æºè€—å°½
åˆç†çš„é™åˆ¶ï¼šLimitRangeæ—¢è¦ä¿è¯æ€§èƒ½åˆè¦èŠ‚çº¦èµ„æº
ç½‘ç»œå®‰å…¨ï¼šé»˜è®¤æ‹’ç»æ‰€æœ‰é€šä¿¡ï¼ŒæŒ‰éœ€å¼€æ”¾
æƒé™æœ€å°åŒ–ï¼šåªç»™ç”¨æˆ·å¿…éœ€çš„æœ€å°æƒé™
```

**ğŸ”§ è·¨å‘½åç©ºé—´é€šä¿¡è§„åˆ™**ï¼š
```
æœåŠ¡å‘ç°æ ¼å¼ï¼šæœåŠ¡å.å‘½åç©ºé—´å.svc.cluster.local
é…ç½®å…±äº«ï¼šé€šè¿‡å¤åˆ¶æˆ–å¤–éƒ¨é…ç½®ç®¡ç†å®ç°
ç½‘ç»œç­–ç•¥ï¼šæ˜ç¡®é…ç½®è·¨å‘½åç©ºé—´è®¿é—®è§„åˆ™
å®‰å…¨è€ƒè™‘ï¼šè·¨å‘½åç©ºé—´é€šä¿¡éœ€è¦é¢å¤–éªŒè¯
```

### 8.3 æ•…éšœæ’æŸ¥æŒ‡å—


**ğŸ” å¸¸è§é—®é¢˜åŠè§£å†³**ï¼š

| é—®é¢˜ç°è±¡ | **å¯èƒ½åŸå› ** | **æ’æŸ¥æ–¹æ³•** |
|---------|-------------|-------------|
| ğŸš« **èµ„æºåˆ›å»ºå¤±è´¥** | `ResourceQuotaè¶…é™` | `kubectl describe quota -n <namespace>` |
| ğŸŒ **ç½‘ç»œä¸é€š** | `NetworkPolicyé˜»å¡` | `æ£€æŸ¥ç½‘ç»œç­–ç•¥é…ç½®` |
| ğŸ‘¤ **æƒé™è¢«æ‹’ç»** | `RBACé…ç½®é”™è¯¯` | `kubectl auth can-i <verb> <resource> --as=<user>` |
| ğŸ”— **è·¨å‘½åç©ºé—´è®¿é—®å¤±è´¥** | `æœåŠ¡åä¸å®Œæ•´` | `ä½¿ç”¨å®Œæ•´åŸŸåæ ¼å¼` |

**ğŸ§  è®°å¿†æŠ€å·§**ï¼š
```
å‘½åç©ºé—´åƒæˆ¿é—´ï¼Œèµ„æºéš”ç¦»æ›´å®‰å…¨
é…é¢é™åˆ¶é˜²è¶…æ”¯ï¼Œç½‘ç»œç­–ç•¥æ§é€šä¿¡  
RBACç®¡æƒé™ï¼Œè§’è‰²ç»‘å®šè¦è®°æ¸…
è·¨ç©ºé—´é€šä¿¡éš¾ï¼Œå®Œæ•´åŸŸåæ˜¯å…³é”®
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- å‘½åç©ºé—´æä¾›å¤šç»´åº¦èµ„æºéš”ç¦»èƒ½åŠ›
- ResourceQuotaå’ŒLimitRangeé…åˆä½¿ç”¨æ§åˆ¶èµ„æº
- NetworkPolicyå®ç°ç²¾ç»†åŒ–ç½‘ç»œè®¿é—®æ§åˆ¶
- RBACé€šè¿‡è§’è‰²ç»‘å®šå®ç°æƒé™ç®¡ç†
- è·¨å‘½åç©ºé—´é€šä¿¡éœ€è¦ä½¿ç”¨å®Œæ•´æœåŠ¡åŸŸå
- å¤šç§Ÿæˆ·è®¾è®¡éœ€è¦ç»¼åˆè€ƒè™‘èµ„æºã€ç½‘ç»œã€æƒé™éš”ç¦»