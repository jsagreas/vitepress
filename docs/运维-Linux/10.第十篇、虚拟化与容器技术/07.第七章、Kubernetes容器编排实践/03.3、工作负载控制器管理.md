---
title: 3ã€å·¥ä½œè´Ÿè½½æ§åˆ¶å™¨ç®¡ç†
---
## ğŸ“š ç›®å½•

1. [å·¥ä½œè´Ÿè½½æ§åˆ¶å™¨æ¦‚è¿°](#1-å·¥ä½œè´Ÿè½½æ§åˆ¶å™¨æ¦‚è¿°)
2. [Deploymentæ»šåŠ¨æ›´æ–°ä¸å›æ»š](#2-deploymentæ»šåŠ¨æ›´æ–°ä¸å›æ»š)
3. [ReplicaSetå‰¯æœ¬é›†ç®¡ç†](#3-replicasetå‰¯æœ¬é›†ç®¡ç†)
4. [DaemonSetèŠ‚ç‚¹å®ˆæŠ¤è¿›ç¨‹](#4-daemonsetèŠ‚ç‚¹å®ˆæŠ¤è¿›ç¨‹)
5. [StatefulSetæœ‰çŠ¶æ€åº”ç”¨](#5-statefulsetæœ‰çŠ¶æ€åº”ç”¨)
6. [Jobå’ŒCronJobä»»åŠ¡ç®¡ç†](#6-jobå’Œcronjobä»»åŠ¡ç®¡ç†)
7. [æ§åˆ¶å™¨é€‰æ‹©å™¨ä¸æ ‡ç­¾](#7-æ§åˆ¶å™¨é€‰æ‹©å™¨ä¸æ ‡ç­¾)
8. [ç›‘æ§ä¸çŠ¶æ€æ£€æŸ¥](#8-ç›‘æ§ä¸çŠ¶æ€æ£€æŸ¥)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ å·¥ä½œè´Ÿè½½æ§åˆ¶å™¨æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯å·¥ä½œè´Ÿè½½æ§åˆ¶å™¨


**ç®€å•ç†è§£**ï¼šå·¥ä½œè´Ÿè½½æ§åˆ¶å™¨å°±åƒæ˜¯Kubernetesé›†ç¾¤é‡Œçš„"ç®¡ç†å‘˜"ï¼Œä¸“é—¨è´Ÿè´£ç®¡ç†å’Œç»´æŠ¤Podçš„è¿è¡ŒçŠ¶æ€ã€‚

```
ç”Ÿæ´»ç±»æ¯”ï¼š
å·¥ä½œè´Ÿè½½æ§åˆ¶å™¨ = å·¥å‚è½¦é—´ä¸»ç®¡
Pod = å·¥äºº
ä»»åŠ¡ = ç”Ÿäº§è®¢å•

è½¦é—´ä¸»ç®¡è´Ÿè´£ï¼š
â€¢ ç¡®ä¿æœ‰è¶³å¤Ÿçš„å·¥äººåœ¨å²—
â€¢ å·¥äººç”Ÿç—…äº†ç«‹å³æ‰¾æ›¿æ¢
â€¢ æ ¹æ®è®¢å•é‡è°ƒæ•´å·¥äººæ•°é‡
â€¢ æŒ‰è®¡åˆ’å®‰æ’å·¥ä½œæ—¶é—´
```

### 1.2 æ§åˆ¶å™¨ç±»å‹ä¸€è§ˆ


**ğŸ”¸ æ ¸å¿ƒæ§åˆ¶å™¨åˆ†ç±»**

| æ§åˆ¶å™¨ç±»å‹ | **ä¸»è¦ç”¨é€”** | **é€‚ç”¨åœºæ™¯** | **Podç‰¹ç‚¹** |
|-----------|------------|-------------|-----------|
| **Deployment** | `æ— çŠ¶æ€åº”ç”¨éƒ¨ç½²` | `WebæœåŠ¡ã€APIæœåŠ¡` | `å¯éšæ„æ›¿æ¢` |
| **ReplicaSet** | `å‰¯æœ¬æ•°é‡ç®¡ç†` | `åŸºç¡€å‰¯æœ¬æ§åˆ¶` | `ç›¸åŒé…ç½®` |
| **DaemonSet** | `èŠ‚ç‚¹å®ˆæŠ¤è¿›ç¨‹` | `æ—¥å¿—æ”¶é›†ã€ç›‘æ§` | `æ¯èŠ‚ç‚¹ä¸€ä¸ª` |
| **StatefulSet** | `æœ‰çŠ¶æ€åº”ç”¨` | `æ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—` | `å›ºå®šèº«ä»½` |
| **Job** | `ä¸€æ¬¡æ€§ä»»åŠ¡` | `æ•°æ®å¤„ç†ã€å¤‡ä»½` | `è¿è¡Œå®Œå³é”€æ¯` |
| **CronJob** | `å®šæ—¶ä»»åŠ¡` | `å®šæœŸå¤‡ä»½ã€æ¸…ç†` | `æŒ‰æ—¶é—´è§¦å‘` |

### 1.3 æ§åˆ¶å™¨å·¥ä½œåŸç†


**æ ¸å¿ƒæœºåˆ¶ï¼šå£°æ˜å¼API + æ§åˆ¶å¾ªç¯**

```
æ§åˆ¶å™¨å·¥ä½œæµç¨‹ï¼š
1. ç”¨æˆ·å£°æ˜æœŸæœ›çŠ¶æ€ï¼ˆDesired Stateï¼‰
2. æ§åˆ¶å™¨è§‚å¯Ÿå½“å‰çŠ¶æ€ï¼ˆCurrent Stateï¼‰  
3. å¯¹æ¯”å·®å¼‚ï¼Œæ‰§è¡Œè°ƒæ•´åŠ¨ä½œ
4. æŒç»­ç›‘æ§ï¼Œä¿æŒçŠ¶æ€ä¸€è‡´

å®é™…ä¾‹å­ï¼š
æœŸæœ›çŠ¶æ€ï¼šè¿è¡Œ3ä¸ªnginx Pod
å½“å‰çŠ¶æ€ï¼šåªæœ‰2ä¸ªnginx Podåœ¨è¿è¡Œ
æ§åˆ¶å™¨åŠ¨ä½œï¼šç«‹å³åˆ›å»º1ä¸ªæ–°çš„nginx Pod
```

---

## 2. ğŸš€ Deploymentæ»šåŠ¨æ›´æ–°ä¸å›æ»š


### 2.1 DeploymentåŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯Deployment**ï¼šDeploymentæ˜¯ç®¡ç†æ— çŠ¶æ€åº”ç”¨æœ€é‡è¦çš„æ§åˆ¶å™¨ï¼Œå°±åƒæ˜¯åº”ç”¨ç¨‹åºçš„"ç”Ÿå‘½å‘¨æœŸç®¡å®¶"ã€‚

**ğŸ”¸ æ ¸å¿ƒåŠŸèƒ½**
- **ç‰ˆæœ¬ç®¡ç†**ï¼šè®°å½•æ¯æ¬¡éƒ¨ç½²çš„ç‰ˆæœ¬å†å²
- **æ»šåŠ¨æ›´æ–°**ï¼šæ— åœæœºæ›´æ–°åº”ç”¨ç‰ˆæœ¬
- **è‡ªåŠ¨å›æ»š**ï¼šå‘ç°é—®é¢˜å¿«é€Ÿæ¢å¤
- **å‰¯æœ¬ç®¡ç†**ï¼šè‡ªåŠ¨ç»´æŠ¤Podæ•°é‡

### 2.2 æ»šåŠ¨æ›´æ–°ç­–ç•¥è¯¦è§£


**æ»šåŠ¨æ›´æ–°åŸç†**ï¼šåƒæ¢è½®èƒä¸€æ ·ï¼Œä¸€ä¸ªä¸€ä¸ªæ›¿æ¢ï¼Œä¿è¯æœåŠ¡ä¸ä¸­æ–­ã€‚

```yaml
# æ»šåŠ¨æ›´æ–°é…ç½®ç¤ºä¾‹
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
spec:
  replicas: 6
  strategy:
    type: RollingUpdate  # æ»šåŠ¨æ›´æ–°ç­–ç•¥
    rollingUpdate:
      maxUnavailable: 1    # æœ€å¤š1ä¸ªPodä¸å¯ç”¨
      maxSurge: 2          # æœ€å¤šé¢å¤–åˆ›å»º2ä¸ªPod
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:1.20
        ports:
        - containerPort: 80
```

**ğŸ”§ æ›´æ–°ç­–ç•¥å‚æ•°è§£é‡Š**

| å‚æ•° | **å«ä¹‰** | **ä¾‹å­** |
|-----|---------|---------|
| **maxUnavailable** | `å…è®¸åŒæ—¶åœæ­¢çš„Podæ•°é‡` | `è®¾ä¸º1ï¼š6ä¸ªPodä¸­æœ€å¤š1ä¸ªåœæ­¢` |
| **maxSurge** | `å…è®¸è¶…å‡ºé¢„æœŸçš„é¢å¤–Podæ•°é‡` | `è®¾ä¸º2ï¼šæ›´æ–°æ—¶æœ€å¤š8ä¸ªPodåŒæ—¶å­˜åœ¨` |

### 2.3 æ‰§è¡Œæ»šåŠ¨æ›´æ–°


**ğŸ¯ æ›´æ–°é•œåƒç‰ˆæœ¬**

```bash
# æ–¹æ³•1ï¼šå‘½ä»¤è¡Œç›´æ¥æ›´æ–°
kubectl set image deployment/nginx-deployment nginx=nginx:1.21

# æ–¹æ³•2ï¼šç¼–è¾‘deploymenté…ç½®
kubectl edit deployment nginx-deployment

# æŸ¥çœ‹æ›´æ–°çŠ¶æ€
kubectl rollout status deployment/nginx-deployment
```

**æ»šåŠ¨æ›´æ–°è¿‡ç¨‹å¯è§†åŒ–**

```
æ›´æ–°å‰ï¼šPodçŠ¶æ€
[Pod1:v1.20] [Pod2:v1.20] [Pod3:v1.20] [Pod4:v1.20] [Pod5:v1.20] [Pod6:v1.20]

æ›´æ–°ä¸­ï¼šé€æ­¥æ›¿æ¢
[Pod1:v1.21] [Pod2:v1.21] [Pod3:v1.20] [Pod4:v1.20] [Pod5:v1.20] [Pod6:v1.20]
[Pod1:v1.21] [Pod2:v1.21] [Pod3:v1.21] [Pod4:v1.21] [Pod5:v1.20] [Pod6:v1.20]

æ›´æ–°å®Œæˆï¼šå…¨éƒ¨æ–°ç‰ˆæœ¬
[Pod1:v1.21] [Pod2:v1.21] [Pod3:v1.21] [Pod4:v1.21] [Pod5:v1.21] [Pod6:v1.21]
```

### 2.4 ç‰ˆæœ¬å›æ»šç®¡ç†


**å›æ»šæœºåˆ¶**ï¼šKubernetesä¼šè‡ªåŠ¨ä¿å­˜å†å²ç‰ˆæœ¬ï¼Œå‡ºé—®é¢˜æ—¶å¯ä»¥å¿«é€Ÿå›åˆ°ä¸Šä¸€ä¸ªç¨³å®šç‰ˆæœ¬ã€‚

```bash
# æŸ¥çœ‹éƒ¨ç½²å†å²
kubectl rollout history deployment/nginx-deployment

# æŸ¥çœ‹ç‰¹å®šç‰ˆæœ¬è¯¦æƒ…
kubectl rollout history deployment/nginx-deployment --revision=2

# å›æ»šåˆ°ä¸Šä¸€ç‰ˆæœ¬
kubectl rollout undo deployment/nginx-deployment

# å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬
kubectl rollout undo deployment/nginx-deployment --to-revision=1
```

**ğŸ”´ é‡è¦é…ç½®ï¼šå†å²ç‰ˆæœ¬ä¿ç•™**

```yaml
spec:
  revisionHistoryLimit: 10  # ä¿ç•™10ä¸ªå†å²ç‰ˆæœ¬
```

---

## 3. ğŸ“Š ReplicaSetå‰¯æœ¬é›†ç®¡ç†


### 3.1 ReplicaSetåŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯ReplicaSet**ï¼šReplicaSetå°±åƒæ˜¯"å¤å°æœºç®¡ç†å‘˜"ï¼Œç¡®ä¿å§‹ç»ˆæœ‰æŒ‡å®šæ•°é‡çš„ç›¸åŒPodåœ¨è¿è¡Œã€‚

> ğŸ’¡ **å…³é”®ç†è§£**ï¼šReplicaSeté€šå¸¸ä¸ç›´æ¥ä½¿ç”¨ï¼Œè€Œæ˜¯é€šè¿‡Deploymentè‡ªåŠ¨ç®¡ç†

### 3.2 å‰¯æœ¬æ•°é‡ç®¡ç†


**ğŸ”¸ æ‰©ç¼©å®¹æ“ä½œ**

```bash
# æ‰‹åŠ¨æ‰©å®¹åˆ°10ä¸ªå‰¯æœ¬
kubectl scale deployment nginx-deployment --replicas=10

# è‡ªåŠ¨æ‰©å®¹ï¼ˆåŸºäºCPUä½¿ç”¨ç‡ï¼‰
kubectl autoscale deployment nginx-deployment --min=3 --max=10 --cpu-percent=70
```

**æ‰©ç¼©å®¹è¿‡ç¨‹ç¤ºä¾‹**

```
æ‰©å®¹è¿‡ç¨‹ï¼ˆ3â†’6ä¸ªå‰¯æœ¬ï¼‰ï¼š
å½“å‰: [Pod1] [Pod2] [Pod3]
æ‰§è¡Œ: kubectl scale --replicas=6
ç»“æœ: [Pod1] [Pod2] [Pod3] [Pod4] [Pod5] [Pod6]

ç¼©å®¹è¿‡ç¨‹ï¼ˆ6â†’2ä¸ªå‰¯æœ¬ï¼‰ï¼š
å½“å‰: [Pod1] [Pod2] [Pod3] [Pod4] [Pod5] [Pod6] 
æ‰§è¡Œ: kubectl scale --replicas=2
ç»“æœ: [Pod1] [Pod2] (å…¶ä»–Podè¢«åˆ é™¤)
```

### 3.3 å‰¯æœ¬å¥åº·ç®¡ç†


**è‡ªåŠ¨æ›¿æ¢æœºåˆ¶**ï¼šå¦‚æœæŸä¸ªPodå‡ºç°æ•…éšœï¼ŒReplicaSetä¼šç«‹å³åˆ›å»ºæ–°çš„Podæ›¿æ¢å®ƒã€‚

```yaml
# å¥åº·æ£€æŸ¥é…ç½®
spec:
  template:
    spec:
      containers:
      - name: nginx
        image: nginx:1.20
        livenessProbe:          # å­˜æ´»æ£€æŸ¥
          httpGet:
            path: /
            port: 80
          initialDelaySeconds: 30
        readinessProbe:         # å°±ç»ªæ£€æŸ¥  
          httpGet:
            path: /
            port: 80
          initialDelaySeconds: 5
```

---

## 4. ğŸ›¡ï¸ DaemonSetèŠ‚ç‚¹å®ˆæŠ¤è¿›ç¨‹


### 4.1 DaemonSetåŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯DaemonSet**ï¼šDaemonSetå°±åƒæ˜¯"ä¿å®‰é˜Ÿé•¿"ï¼Œç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½æœ‰ä¸€ä¸ªç‰¹å®šçš„Podåœ¨è¿è¡Œã€‚

**ğŸ”¸ å…¸å‹åº”ç”¨åœºæ™¯**
- **æ—¥å¿—æ”¶é›†**ï¼šæ¯ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œæ—¥å¿—æ”¶é›†å™¨
- **ç›‘æ§ä»£ç†**ï¼šæ¯ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œç›‘æ§ç¨‹åº  
- **ç½‘ç»œæ’ä»¶**ï¼šæ¯ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œç½‘ç»œç»„ä»¶
- **å­˜å‚¨æ’ä»¶**ï¼šæ¯ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œå­˜å‚¨é©±åŠ¨

### 4.2 DaemonSeté…ç½®ç¤ºä¾‹


```yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: fluentd-logger
  labels:
    app: fluentd-logger
spec:
  selector:
    matchLabels:
      app: fluentd-logger
  template:
    metadata:
      labels:
        app: fluentd-logger
    spec:
      containers:
      - name: fluentd
        image: fluentd:latest
        resources:
          limits:
            memory: 200Mi
            cpu: 100m
        volumeMounts:
        - name: varlog
          mountPath: /var/log
          readOnly: true
      volumes:
      - name: varlog
        hostPath:
          path: /var/log
```

### 4.3 èŠ‚ç‚¹é€‰æ‹©ä¸è°ƒåº¦


**èŠ‚ç‚¹é€‰æ‹©å™¨**ï¼šå¯ä»¥æŒ‡å®šDaemonSetåªåœ¨ç‰¹å®šèŠ‚ç‚¹ä¸Šè¿è¡Œ

```yaml
spec:
  template:
    spec:
      nodeSelector:
        env: production    # åªåœ¨æ ‡ç­¾ä¸ºenv=productionçš„èŠ‚ç‚¹è¿è¡Œ
      tolerations:         # å®¹å¿æ±¡ç‚¹ï¼Œå¯ä»¥åœ¨ç‰¹æ®ŠèŠ‚ç‚¹è¿è¡Œ
      - key: node-role.kubernetes.io/master
        operator: Exists
        effect: NoSchedule
```

---

## 5. ğŸ—ƒï¸ StatefulSetæœ‰çŠ¶æ€åº”ç”¨


### 5.1 StatefulSetåŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯StatefulSet**ï¼šStatefulSetä¸“é—¨ç®¡ç†æœ‰çŠ¶æ€åº”ç”¨ï¼Œå°±åƒç®¡ç†"æœ‰å›ºå®šå·¥ä½çš„å‘˜å·¥"ï¼Œæ¯ä¸ªPodéƒ½æœ‰å›ºå®šçš„èº«ä»½å’Œå­˜å‚¨ã€‚

**ğŸ”¸ æœ‰çŠ¶æ€ vs æ— çŠ¶æ€å¯¹æ¯”**

| ç‰¹å¾ | **æ— çŠ¶æ€åº”ç”¨** | **æœ‰çŠ¶æ€åº”ç”¨** |
|-----|---------------|---------------|
| **èº«ä»½æ ‡è¯†** | `éšæœºåç§°ï¼Œå¯äº’æ¢` | `å›ºå®šåç§°ï¼Œä¸å¯äº’æ¢` |
| **æ•°æ®å­˜å‚¨** | `ä¸ä¿å­˜æ•°æ®` | `éœ€è¦æŒä¹…åŒ–æ•°æ®` |
| **å¯åŠ¨é¡ºåº** | `å¹¶è¡Œå¯åŠ¨` | `æŒ‰é¡ºåºå¯åŠ¨` |
| **å…¸å‹ä¾‹å­** | `WebæœåŠ¡å™¨` | `æ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—` |

### 5.2 StatefulSetç‰¹æ€§è¯¦è§£


**ğŸ”¸ æ ¸å¿ƒç‰¹æ€§**

```
å›ºå®šèº«ä»½æ ‡è¯†ï¼š
web-0, web-1, web-2 (åç§°å›ºå®šï¼Œé‡å»ºåä¿æŒä¸å˜)

æœ‰åºéƒ¨ç½²ï¼š
web-0 å¯åŠ¨å®Œæˆ â†’ web-1 å¯åŠ¨ â†’ web-2 å¯åŠ¨

æœ‰åºåˆ é™¤ï¼š  
web-2 åˆ é™¤ â†’ web-1 åˆ é™¤ â†’ web-0 åˆ é™¤

æŒä¹…åŒ–å­˜å‚¨ï¼š
æ¯ä¸ªPodæœ‰ç‹¬ç«‹çš„PVCï¼Œé‡å»ºåæ•°æ®ä¿ç•™
```

### 5.3 StatefulSeté…ç½®ç¤ºä¾‹


```yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: mysql-cluster
spec:
  serviceName: mysql-cluster
  replicas: 3
  selector:
    matchLabels:
      app: mysql
  template:
    metadata:
      labels:
        app: mysql
    spec:
      containers:
      - name: mysql
        image: mysql:8.0
        env:
        - name: MYSQL_ROOT_PASSWORD
          value: "password"
        volumeMounts:
        - name: mysql-data
          mountPath: /var/lib/mysql
  volumeClaimTemplates:    # ä¸ºæ¯ä¸ªPodè‡ªåŠ¨åˆ›å»ºPVC
  - metadata:
      name: mysql-data
    spec:
      accessModes: [ "ReadWriteOnce" ]
      resources:
        requests:
          storage: 10Gi
```

### 5.4 StatefulSetç½‘ç»œç®¡ç†


**Headless Service**ï¼šStatefulSetéœ€è¦é…åˆHeadless Serviceä½¿ç”¨ï¼Œæä¾›ç¨³å®šçš„ç½‘ç»œæ ‡è¯†ã€‚

```yaml
apiVersion: v1
kind: Service
metadata:
  name: mysql-cluster
spec:
  clusterIP: None    # Headless Service
  selector:
    app: mysql
  ports:
  - port: 3306
```

**ç½‘ç»œè®¿é—®æ–¹å¼**ï¼š
- `mysql-0.mysql-cluster.default.svc.cluster.local`
- `mysql-1.mysql-cluster.default.svc.cluster.local`  
- `mysql-2.mysql-cluster.default.svc.cluster.local`

---

## 6. â° Jobå’ŒCronJobä»»åŠ¡ç®¡ç†


### 6.1 Jobæ‰¹å¤„ç†ä»»åŠ¡


**ä»€ä¹ˆæ˜¯Job**ï¼šJobä¸“é—¨è¿è¡Œä¸€æ¬¡æ€§ä»»åŠ¡ï¼Œå°±åƒ"ä¸´æ—¶å·¥"ï¼Œå®Œæˆä»»åŠ¡åå°±ç»“æŸã€‚

**ğŸ”¸ Jobç±»å‹å¯¹æ¯”**

| Jobç±»å‹ | **ç‰¹ç‚¹** | **é€‚ç”¨åœºæ™¯** |
|---------|---------|-------------|
| **å•æ¬¡Job** | `è¿è¡Œä¸€æ¬¡å°±ç»“æŸ` | `æ•°æ®è¿ç§»ã€ä¸€æ¬¡æ€§è®¡ç®—` |
| **å¹¶è¡ŒJob** | `åŒæ—¶è¿è¡Œå¤šä¸ªPod` | `æ‰¹é‡æ•°æ®å¤„ç†` |
| **é˜Ÿåˆ—Job** | `å¤„ç†å·¥ä½œé˜Ÿåˆ—` | `æ¶ˆæ¯å¤„ç†ã€ä»»åŠ¡é˜Ÿåˆ—` |

### 6.2 Jobé…ç½®ç¤ºä¾‹


```yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: data-backup
spec:
  completions: 1        # éœ€è¦æˆåŠŸå®Œæˆçš„Podæ•°é‡
  parallelism: 1        # å¹¶å‘è¿è¡Œçš„Podæ•°é‡
  backoffLimit: 3       # å¤±è´¥é‡è¯•æ¬¡æ•°
  template:
    spec:
      restartPolicy: Never  # Jobçš„Podå¤±è´¥åä¸é‡å¯
      containers:
      - name: backup
        image: mysql:8.0
        command:
        - /bin/bash
        - -c
        - |
          mysqldump -h mysql-service -u root -p$MYSQL_PASSWORD \
          database_name > /backup/backup_$(date +%Y%m%d).sql
```

### 6.3 CronJobå®šæ—¶ä»»åŠ¡


**ä»€ä¹ˆæ˜¯CronJob**ï¼šCronJobæŒ‰æ—¶é—´è¡¨è‡ªåŠ¨åˆ›å»ºJobï¼Œå°±åƒ"å®šæ—¶é—¹é’Ÿ"ã€‚

**ğŸ”¸ Cronè¡¨è¾¾å¼é€ŸæŸ¥**

| è¡¨è¾¾å¼ | **å«ä¹‰** | **æ‰§è¡Œæ—¶é—´** |
|-------|---------|-------------|
| `0 2 * * *` | `æ¯å¤©å‡Œæ™¨2ç‚¹` | `02:00æ‰§è¡Œ` |
| `*/15 * * * *` | `æ¯15åˆ†é’Ÿ` | `æ¯åˆ»é’Ÿæ‰§è¡Œ` |
| `0 0 1 * *` | `æ¯æœˆ1å·` | `æœˆåˆæ‰§è¡Œ` |
| `0 6 * * 1` | `æ¯å‘¨ä¸€æ—©6ç‚¹` | `å‘¨ä¸€æ‰§è¡Œ` |

```yaml
apiVersion: batch/v1
kind: CronJob
metadata:
  name: daily-backup
spec:
  schedule: "0 2 * * *"    # æ¯å¤©å‡Œæ™¨2ç‚¹
  jobTemplate:
    spec:
      template:
        spec:
          restartPolicy: OnFailure
          containers:
          - name: backup
            image: backup-tool:latest
            command:
            - /scripts/backup.sh
  successfulJobsHistoryLimit: 3  # ä¿ç•™3ä¸ªæˆåŠŸçš„Jobè®°å½•
  failedJobsHistoryLimit: 1      # ä¿ç•™1ä¸ªå¤±è´¥çš„Jobè®°å½•
```

---

## 7. ğŸ¯ æ§åˆ¶å™¨é€‰æ‹©å™¨ä¸æ ‡ç­¾


### 7.1 æ ‡ç­¾é€‰æ‹©å™¨åŸç†


**æ ‡ç­¾é€‰æ‹©å™¨**ï¼šå°±åƒæ˜¯"äººå‘˜ç­›é€‰å™¨"ï¼Œæ§åˆ¶å™¨é€šè¿‡æ ‡ç­¾æ¥è¯†åˆ«å’Œç®¡ç†Podã€‚

**ğŸ”¸ é€‰æ‹©å™¨ç±»å‹**

```yaml
# ç›¸ç­‰æ€§é€‰æ‹©å™¨ï¼ˆmatchLabelsï¼‰
selector:
  matchLabels:
    app: nginx
    version: v1.0

# é›†åˆæ€§é€‰æ‹©å™¨ï¼ˆmatchExpressionsï¼‰  
selector:
  matchExpressions:
  - key: app
    operator: In
    values: ["nginx", "apache"]
  - key: env
    operator: NotIn  
    values: ["test"]
```

### 7.2 æ ‡ç­¾æœ€ä½³å®è·µ


**ğŸ”¸ æ¨èæ ‡ç­¾ç»“æ„**

```yaml
metadata:
  labels:
    app.kubernetes.io/name: nginx           # åº”ç”¨åç§°
    app.kubernetes.io/version: "1.20"       # åº”ç”¨ç‰ˆæœ¬
    app.kubernetes.io/component: frontend   # ç»„ä»¶ç±»å‹
    app.kubernetes.io/part-of: web-app     # æ‰€å±ç³»ç»Ÿ
    app.kubernetes.io/managed-by: kubectl   # ç®¡ç†å·¥å…·
    env: production                         # ç¯å¢ƒæ ‡è¯†
```

**æ ‡ç­¾åŒ¹é…ç¤ºä¾‹**ï¼š

```
Deploymentæ ‡ç­¾é€‰æ‹©ï¼š
selector:
  matchLabels:
    app: nginx
    env: production

åŒ¹é…çš„Podæ ‡ç­¾ï¼š
âœ… app=nginx, env=production, version=v1.0    # åŒ¹é…
âœ… app=nginx, env=production                   # åŒ¹é…  
âŒ app=nginx, env=development                  # ä¸åŒ¹é…
âŒ app=apache, env=production                  # ä¸åŒ¹é…
```

---

## 8. ğŸ“ˆ ç›‘æ§ä¸çŠ¶æ€æ£€æŸ¥


### 8.1 å·¥ä½œè´Ÿè½½çŠ¶æ€æŸ¥çœ‹


**ğŸ”¸ å¸¸ç”¨çŠ¶æ€æ£€æŸ¥å‘½ä»¤**

```bash
# æŸ¥çœ‹DeploymentçŠ¶æ€
kubectl get deployments
kubectl describe deployment nginx-deployment

# æŸ¥çœ‹PodçŠ¶æ€  
kubectl get pods -l app=nginx
kubectl describe pod <pod-name>

# æŸ¥çœ‹ReplicaSetçŠ¶æ€
kubectl get rs
kubectl describe rs <replicaset-name>

# å®æ—¶ç›‘æ§PodçŠ¶æ€
kubectl get pods --watch
```

### 8.2 å¥åº·æ£€æŸ¥é…ç½®


**ğŸ”¸ æ¢é’ˆç±»å‹å¯¹æ¯”**

| æ¢é’ˆç±»å‹ | **ä½œç”¨** | **å¤±è´¥åæœ** | **é…ç½®æ—¶æœº** |
|---------|---------|-------------|-------------|
| **livenessProbe** | `æ£€æŸ¥å®¹å™¨æ˜¯å¦å­˜æ´»` | `é‡å¯å®¹å™¨` | `å®¹å™¨å¯åŠ¨å` |
| **readinessProbe** | `æ£€æŸ¥å®¹å™¨æ˜¯å¦å°±ç»ª` | `ç§»å‡ºService` | `æ¥æ”¶æµé‡å‰` |
| **startupProbe** | `æ£€æŸ¥å®¹å™¨æ˜¯å¦å¯åŠ¨` | `é‡å¯å®¹å™¨` | `å¯åŠ¨é˜¶æ®µ` |

```yaml
spec:
  containers:
  - name: app
    image: myapp:latest
    livenessProbe:
      httpGet:
        path: /health
        port: 8080
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
    readinessProbe:
      httpGet:
        path: /ready  
        port: 8080
      initialDelaySeconds: 5
      periodSeconds: 2
```

### 8.3 æ•…éšœæ’æŸ¥æ–¹æ³•


**ğŸ”§ å¸¸è§é—®é¢˜æ’æŸ¥**

```bash
# æŸ¥çœ‹Podäº‹ä»¶
kubectl describe pod <pod-name>

# æŸ¥çœ‹Podæ—¥å¿—
kubectl logs <pod-name>
kubectl logs <pod-name> -f --tail=100

# è¿›å…¥Podè°ƒè¯•
kubectl exec -it <pod-name> -- /bin/bash

# æŸ¥çœ‹æ§åˆ¶å™¨äº‹ä»¶
kubectl describe deployment <deployment-name>
```

**ğŸš¨ å¸¸è§çŠ¶æ€è§£è¯»**

| PodçŠ¶æ€ | **å«ä¹‰** | **å¯èƒ½åŸå› ** |
|---------|---------|-------------|
| **Pending** | `ç­‰å¾…è°ƒåº¦` | `èµ„æºä¸è¶³ã€èŠ‚ç‚¹é€‰æ‹©å™¨ä¸åŒ¹é…` |
| **Running** | `æ­£å¸¸è¿è¡Œ` | `å¥åº·çŠ¶æ€` |
| **Failed** | `è¿è¡Œå¤±è´¥` | `é•œåƒé—®é¢˜ã€é…ç½®é”™è¯¯` |
| **CrashLoopBackOff** | `åå¤é‡å¯` | `åº”ç”¨å¯åŠ¨å¤±è´¥` |

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å·¥ä½œè´Ÿè½½æ§åˆ¶å™¨ï¼šK8sç®¡ç†Podçš„æ ¸å¿ƒæœºåˆ¶ï¼Œå®ç°å£°æ˜å¼ç®¡ç†
ğŸ”¸ Deploymentï¼šæ— çŠ¶æ€åº”ç”¨ç®¡ç†ï¼Œæ”¯æŒæ»šåŠ¨æ›´æ–°å’Œç‰ˆæœ¬å›æ»š
ğŸ”¸ ReplicaSetï¼šå‰¯æœ¬é›†ç®¡ç†ï¼Œç¡®ä¿Podæ•°é‡ç¬¦åˆé¢„æœŸ
ğŸ”¸ DaemonSetï¼šèŠ‚ç‚¹å®ˆæŠ¤è¿›ç¨‹ï¼Œæ¯ä¸ªèŠ‚ç‚¹è¿è¡Œä¸€ä¸ªPod
ğŸ”¸ StatefulSetï¼šæœ‰çŠ¶æ€åº”ç”¨ç®¡ç†ï¼Œæä¾›å›ºå®šèº«ä»½å’Œå­˜å‚¨
ğŸ”¸ Job/CronJobï¼šä»»åŠ¡ç®¡ç†ï¼Œä¸€æ¬¡æ€§ä»»åŠ¡å’Œå®šæ—¶ä»»åŠ¡
ğŸ”¸ æ ‡ç­¾é€‰æ‹©å™¨ï¼šæ§åˆ¶å™¨è¯†åˆ«å’Œç®¡ç†Podçš„æ ¸å¿ƒæœºåˆ¶
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æ§åˆ¶å™¨é€‰æ‹©æŒ‡å—**
```
é€‰æ‹©åŸåˆ™ï¼š
â€¢ æ— çŠ¶æ€Webåº”ç”¨ â†’ Deployment
â€¢ æ¯èŠ‚ç‚¹ä¸€ä¸ªç¨‹åº â†’ DaemonSet  
â€¢ æ•°æ®åº“/æ¶ˆæ¯é˜Ÿåˆ— â†’ StatefulSet
â€¢ æ‰¹å¤„ç†ä»»åŠ¡ â†’ Job
â€¢ å®šæ—¶å¤‡ä»½æ¸…ç† â†’ CronJob
```

**ğŸ”¹ æ›´æ–°ç­–ç•¥æœ€ä½³å®è·µ**
```
æ»šåŠ¨æ›´æ–°é…ç½®ï¼š
â€¢ maxUnavailableï¼šä¿è¯å¯ç”¨æ€§ï¼Œé€šå¸¸è®¾ä¸º25%
â€¢ maxSurgeï¼šæ§åˆ¶èµ„æºä½¿ç”¨ï¼Œé€šå¸¸è®¾ä¸º25%
â€¢ å¥åº·æ£€æŸ¥ï¼šç¡®ä¿æ–°ç‰ˆæœ¬ç¨³å®šåæ‰ç»§ç»­æ›´æ–°
```

**ğŸ”¹ ç›‘æ§æ£€æŸ¥è¦ç‚¹**
```
å¿…é¡»ç›‘æ§çš„æŒ‡æ ‡ï¼š
â€¢ Podè¿è¡ŒçŠ¶æ€å’Œé‡å¯æ¬¡æ•°
â€¢ èµ„æºä½¿ç”¨æƒ…å†µï¼ˆCPU/å†…å­˜ï¼‰  
â€¢ å¥åº·æ£€æŸ¥ç»“æœ
â€¢ å‰¯æœ¬æ•°é‡æ˜¯å¦ç¬¦åˆé¢„æœŸ
```

### 9.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ ç”Ÿäº§ç¯å¢ƒåº”ç”¨**
- **Webåº”ç”¨éƒ¨ç½²**ï¼šä½¿ç”¨Deploymentç®¡ç†å‰ç«¯å’ŒAPIæœåŠ¡
- **æ•°æ®åº“é›†ç¾¤**ï¼šä½¿ç”¨StatefulSetéƒ¨ç½²MySQLã€PostgreSQLé›†ç¾¤
- **ç›‘æ§ç³»ç»Ÿ**ï¼šä½¿ç”¨DaemonSetéƒ¨ç½²Node Exporterç­‰ç›‘æ§ä»£ç†
- **æ‰¹å¤„ç†ä½œä¸š**ï¼šä½¿ç”¨Job/CronJobæ‰§è¡Œæ•°æ®å¤„ç†å’Œå®šæ—¶ä»»åŠ¡

**ğŸ”§ è¿ç»´å®è·µ**
- **ç‰ˆæœ¬ç®¡ç†**ï¼šåˆ©ç”¨Deploymentçš„ç‰ˆæœ¬å†å²å¿«é€Ÿå›æ»š
- **å¼¹æ€§æ‰©å®¹**ï¼šæ ¹æ®è´Ÿè½½æƒ…å†µåŠ¨æ€è°ƒæ•´å‰¯æœ¬æ•°é‡
- **æ•…éšœæ¢å¤**ï¼šæ§åˆ¶å™¨è‡ªåŠ¨æ£€æµ‹å’Œæ›¿æ¢æ•…éšœPod
- **èµ„æºä¼˜åŒ–**ï¼šé€šè¿‡èµ„æºé™åˆ¶å’Œå¥åº·æ£€æŸ¥ä¼˜åŒ–é›†ç¾¤èµ„æºä½¿ç”¨

**ğŸ“ å­¦ä¹ å»ºè®®**
```
å­¦ä¹ è·¯å¾„ï¼š
1. å…ˆæŒæ¡Deploymentï¼Œç†è§£å£°æ˜å¼ç®¡ç†ç†å¿µ
2. é€šè¿‡å®é™…éƒ¨ç½²ç†è§£æ§åˆ¶å™¨å·¥ä½œåŸç†
3. å­¦ä¼šä½¿ç”¨kubectlå‘½ä»¤æŸ¥çœ‹å’Œè°ƒè¯•
4. å®è·µä¸åŒåœºæ™¯ä¸‹çš„æ§åˆ¶å™¨é€‰æ‹©
5. æŒæ¡ç”Ÿäº§ç¯å¢ƒçš„ç›‘æ§å’Œæ•…éšœæ’æŸ¥
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- Deploymentç®¡æ— çŠ¶æ€ï¼Œæ»šåŠ¨æ›´æ–°ä¿å¹³å®‰
- StatefulSetç®¡æ•°æ®åº“ï¼Œå›ºå®šèº«ä»½å¸¦å­˜å‚¨  
- DaemonSetæ¯èŠ‚ç‚¹ï¼Œæ—¥å¿—ç›‘æ§ç¦»ä¸äº†
- Jobå¤„ç†æ‰¹ä»»åŠ¡ï¼ŒCronJobå®šæ—¶è·‘
- æ ‡ç­¾é€‰æ‹©æ˜¯å…³é”®ï¼Œç›‘æ§æ£€æŸ¥ä¸èƒ½å¿˜