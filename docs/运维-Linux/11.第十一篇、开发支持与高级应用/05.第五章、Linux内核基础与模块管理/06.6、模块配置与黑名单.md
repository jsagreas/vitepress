---
title: 6ã€æ¨¡å—é…ç½®ä¸é»‘åå•
---
## ğŸ“š ç›®å½•

1. [æ¨¡å—é…ç½®ç³»ç»Ÿæ¦‚è¿°](#1-æ¨¡å—é…ç½®ç³»ç»Ÿæ¦‚è¿°)
2. [modprobeé…ç½®æ–‡ä»¶è¯¦è§£](#2-modprobeé…ç½®æ–‡ä»¶è¯¦è§£)
3. [æ¨¡å—åˆ«åä¸å‚æ•°é…ç½®](#3-æ¨¡å—åˆ«åä¸å‚æ•°é…ç½®)
4. [é»‘åå•æœºåˆ¶å®æˆ˜](#4-é»‘åå•æœºåˆ¶å®æˆ˜)
5. [é«˜çº§é…ç½®æŠ€å·§](#5-é«˜çº§é…ç½®æŠ€å·§)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”§ æ¨¡å—é…ç½®ç³»ç»Ÿæ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯æ¨¡å—é…ç½®ç³»ç»Ÿ


**é€šä¿—ç†è§£**ï¼šå°±åƒæ‰‹æœºçš„åº”ç”¨è®¾ç½®ä¸€æ ·ï¼Œæ¨¡å—é…ç½®ç³»ç»Ÿå¸®æˆ‘ä»¬ç®¡ç†å†…æ ¸æ¨¡å—çš„è¡Œä¸º

```
æƒ³è±¡ä¸€ä¸‹ï¼š
æ‰‹æœºAPP â†’ å¯ä»¥åœ¨è®¾ç½®é‡Œè°ƒæ•´è¡Œä¸º
å†…æ ¸æ¨¡å— â†’ ä¹Ÿå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶è°ƒæ•´è¡Œä¸º

æ¯”å¦‚ï¼š
- æŸä¸ªç½‘å¡é©±åŠ¨æ¨¡å—åŠ è½½æ—¶éœ€è¦ç‰¹å®šå‚æ•°
- æŸä¸ªå£°å¡æ¨¡å—å¯èƒ½å’Œç³»ç»Ÿå†²çªï¼Œéœ€è¦ç¦ç”¨
- ç»™æ¨¡å—èµ·ä¸ªå¥½è®°çš„åˆ«åæ–¹ä¾¿ä½¿ç”¨
```

**æ ¸å¿ƒä½œç”¨**ï¼š
- **å‚æ•°æ§åˆ¶**ï¼šç»™æ¨¡å—ä¼ é€’å¯åŠ¨å‚æ•°
- **åˆ«åç®¡ç†**ï¼šç»™å¤æ‚çš„æ¨¡å—åèµ·ç®€å•åˆ«å
- **é»‘åå•æ§åˆ¶**ï¼šç¦æ­¢æŸäº›æœ‰é—®é¢˜çš„æ¨¡å—åŠ è½½
- **åŠ è½½é¡ºåº**ï¼šæ§åˆ¶æ¨¡å—çš„åŠ è½½å…ˆåé¡ºåº

### 1.2 é…ç½®ç³»ç»Ÿçš„ç»„æˆç»“æ„


```
Linuxæ¨¡å—é…ç½®ç³»ç»Ÿæ¶æ„ï¼š

/etc/modprobe.conf          â† ä¸»é…ç½®æ–‡ä»¶ï¼ˆæ—§å¼ï¼Œç°åœ¨è¾ƒå°‘ç”¨ï¼‰
        |
/etc/modprobe.d/           â† é…ç½®ç›®å½•ï¼ˆç°ä»£æ¨èæ–¹å¼ï¼‰
    â”œâ”€â”€ blacklist.conf     â† é»‘åå•é…ç½®
    â”œâ”€â”€ aliases.conf       â† åˆ«åé…ç½®  
    â”œâ”€â”€ options.conf       â† å‚æ•°é…ç½®
    â””â”€â”€ custom.conf        â† è‡ªå®šä¹‰é…ç½®

å·¥ä½œæµç¨‹ï¼š
ç”¨æˆ·å‘½ä»¤ â†’ modprobe â†’ è¯»å–é…ç½® â†’ æŒ‰è§„åˆ™åŠ è½½æ¨¡å—
```

**ğŸ”¹ æ–°æ—§é…ç½®æ–¹å¼å¯¹æ¯”**

| é…ç½®æ–¹å¼ | **æ–‡ä»¶ä½ç½®** | **ä¼˜ç¼ºç‚¹** | **é€‚ç”¨åœºæ™¯** |
|---------|------------|-----------|-------------|
| ğŸ”¸ **ä¼ ç»Ÿæ–¹å¼** | `/etc/modprobe.conf` | `ç®€å•ä½†ä¸çµæ´»` | `ç®€å•ç³»ç»Ÿ` |
| ğŸ”¸ **ç°ä»£æ–¹å¼** | `/etc/modprobe.d/` | `æ¨¡å—åŒ–ï¼Œæ˜“ç®¡ç†` | `å¤æ‚ç³»ç»Ÿæ¨è` |

---

## 2. ğŸ“ modprobeé…ç½®æ–‡ä»¶è¯¦è§£


### 2.1 /etc/modprobe.confä¼ ç»Ÿé…ç½®


**æ–‡ä»¶ç‰¹ç‚¹**ï¼šä¸€ä¸ªå¤§æ–‡ä»¶åŒ…å«æ‰€æœ‰é…ç½®ï¼Œç°åœ¨é€æ¸è¢«æ·˜æ±°

```bash
# æŸ¥çœ‹æ˜¯å¦å­˜åœ¨ä¼ ç»Ÿé…ç½®æ–‡ä»¶
ls -la /etc/modprobe.conf

# å¦‚æœå­˜åœ¨ï¼ŒæŸ¥çœ‹å†…å®¹
cat /etc/modprobe.conf
```

**å…¸å‹å†…å®¹ç¤ºä¾‹**ï¼š
```
# ä¼ ç»Ÿmodprobe.confç¤ºä¾‹
alias sound-slot-0 snd-hda-intel
options snd-hda-intel model=laptop
blacklist pcspkr
install usb-storage /sbin/modprobe --ignore-install usb-storage && /bin/echo
```

### 2.2 /etc/modprobe.d/ç°ä»£é…ç½®ç›®å½•


**ç›®å½•ç‰¹ç‚¹**ï¼š
- **æ¨¡å—åŒ–ç®¡ç†**ï¼šæ¯ä¸ª`.conf`æ–‡ä»¶è´Ÿè´£ç‰¹å®šåŠŸèƒ½
- **çµæ´»æ‰©å±•**ï¼šå¯ä»¥éšæ—¶æ·»åŠ æ–°çš„é…ç½®æ–‡ä»¶  
- **æ˜“äºç»´æŠ¤**ï¼šåŠŸèƒ½åˆ†ç¦»ï¼Œä¾¿äºç®¡ç†å’Œè°ƒè¯•

**ğŸ” ç›®å½•ç»“æ„æŸ¥çœ‹**
```bash
# æŸ¥çœ‹é…ç½®ç›®å½•
ls -la /etc/modprobe.d/

# å¸¸è§æ–‡ä»¶ç¤ºä¾‹
/etc/modprobe.d/
â”œâ”€â”€ alsa-base.conf      # éŸ³é¢‘ç³»ç»Ÿé…ç½®
â”œâ”€â”€ blacklist.conf      # é€šç”¨é»‘åå•
â”œâ”€â”€ blacklist-ath_pci.conf  # ç‰¹å®šé©±åŠ¨é»‘åå•
â””â”€â”€ iwlwifi.conf        # æ— çº¿ç½‘å¡é…ç½®
```

### 2.3 é…ç½®æ–‡ä»¶è¯­æ³•è§„åˆ™


**åŸºæœ¬è¯­æ³•æ ¼å¼**ï¼š
```
æŒ‡ä»¤åç§° å‚æ•°1 å‚æ•°2 ...
```

**ğŸ”¸ æ³¨é‡Šè§„åˆ™**
```bash
# è¿™æ˜¯æ³¨é‡Šè¡Œï¼Œä»¥#å¼€å¤´
alias eth0 e1000e    # è¡Œå°¾æ³¨é‡Šä¹Ÿå¯ä»¥

# å¤šè¡Œæ³¨é‡Š
# ç¬¬ä¸€è¡Œè¯´æ˜
# ç¬¬äºŒè¡Œè¯´æ˜
```

**ğŸ”¹ é…ç½®æ–‡ä»¶å¤„ç†é¡ºåº**

```
å¤„ç†é¡ºåºï¼š
1. æŒ‰æ–‡ä»¶åå­—æ¯é¡ºåºè¯»å–/etc/modprobe.d/ç›®å½•ä¸‹æ‰€æœ‰.confæ–‡ä»¶
2. åŒåæŒ‡ä»¤ï¼Œåé¢çš„è¦†ç›–å‰é¢çš„
3. æ–‡ä»¶åå»ºè®®ç”¨æ•°å­—å‰ç¼€æ§åˆ¶é¡ºåºï¼Œå¦‚ï¼š01-base.conf, 99-custom.conf

ç¤ºä¾‹æ–‡ä»¶å‘½åï¼š
00-base.conf         â† æœ€å…ˆå¤„ç†
50-sound.conf        â† ä¸­é—´å¤„ç†  
99-blacklist.conf    â† æœ€åå¤„ç†
```

---

## 3. ğŸ·ï¸ æ¨¡å—åˆ«åä¸å‚æ•°é…ç½®


### 3.1 aliasåˆ«åé…ç½®è¯¦è§£


**ä»€ä¹ˆæ˜¯æ¨¡å—åˆ«å**ï¼šç»™å¤æ‚éš¾è®°çš„æ¨¡å—åèµ·ä¸ªç®€å•å¥½è®°çš„åå­—

```
ç”Ÿæ´»ä¾‹å­ï¼š
çœŸå®å§“åï¼šæå»ºå›½ â†’ æ˜µç§°ï¼šå°æ
æ¨¡å—çœŸåï¼šsnd-hda-intel â†’ åˆ«åï¼šsound
```

**ğŸ”§ aliasè¯­æ³•æ ¼å¼**
```bash
alias åˆ«å çœŸå®æ¨¡å—å
```

**å®ç”¨aliasé…ç½®ç¤ºä¾‹**ï¼š
```bash
# éŸ³é¢‘è®¾å¤‡åˆ«å
alias sound-slot-0 snd-hda-intel
alias sound snd-hda-intel

# ç½‘ç»œè®¾å¤‡åˆ«å  
alias eth0 e1000e
alias wifi iwlwifi

# é€šç”¨è®¾å¤‡åˆ«å
alias usb-controller ehci-hcd
alias scsi-controller ata-piix
```

**ğŸ” ä½¿ç”¨åˆ«ååŠ è½½æ¨¡å—**
```bash
# ä½¿ç”¨åˆ«ååŠ è½½ï¼ˆæ›´ç®€å•ï¼‰
modprobe sound
modprobe wifi

# ç­‰åŒäºä½¿ç”¨çœŸååŠ è½½ï¼ˆå¤æ‚ï¼‰
modprobe snd-hda-intel  
modprobe iwlwifi
```

### 3.2 optionså‚æ•°é…ç½®è¯¦è§£


**ä»€ä¹ˆæ˜¯æ¨¡å—å‚æ•°**ï¼šå°±åƒå¯åŠ¨ç¨‹åºæ—¶çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œæ§åˆ¶æ¨¡å—çš„å·¥ä½œè¡Œä¸º

```
ç±»æ¯”ç†è§£ï¼š
å¯åŠ¨ç¨‹åºï¼šfirefox --safe-mode
åŠ è½½æ¨¡å—ï¼šmodprobe snd-hda-intel model=laptop
```

**ğŸ”§ optionsè¯­æ³•æ ¼å¼**
```bash
options æ¨¡å—å å‚æ•°å=å‚æ•°å€¼ å‚æ•°å=å‚æ•°å€¼
```

**å¸¸ç”¨å‚æ•°é…ç½®ç¤ºä¾‹**ï¼š

```bash
# å£°å¡é©±åŠ¨å‚æ•°
options snd-hda-intel model=laptop          # ç¬”è®°æœ¬æ¨¡å¼
options snd-hda-intel index=0               # è®¾å¤‡ç´¢å¼•
options snd-hda-intel enable=1              # å¯ç”¨è®¾å¤‡

# æ— çº¿ç½‘å¡å‚æ•°
options iwlwifi 11n_disable=1               # ç¦ç”¨802.11n
options iwlwifi swcrypto=1                  # å¯ç”¨è½¯ä»¶åŠ å¯†
options iwlwifi debug=0x43fff               # è°ƒè¯•çº§åˆ«

# USBå­˜å‚¨å‚æ•°
options usb-storage delay_use=5             # å»¶è¿Ÿ5ç§’æ£€æµ‹
options usb-storage quirks=0123:4567:u      # ç‰¹æ®Šè®¾å¤‡å¤„ç†
```

**ğŸ”¹ å‚æ•°ç±»å‹è¯´æ˜**

| å‚æ•°ç±»å‹ | **æ ¼å¼ç¤ºä¾‹** | **è¯´æ˜** |
|---------|-------------|---------|
| ğŸ”¸ **å¸ƒå°”å€¼** | `enable=1` | `1=å¯ç”¨, 0=ç¦ç”¨` |
| ğŸ”¸ **æ•´æ•°å€¼** | `index=0` | `æ•°å­—å€¼` |
| ğŸ”¸ **å­—ç¬¦ä¸²** | `model=laptop` | `æ–‡æœ¬å€¼` |
| ğŸ”¸ **åå…­è¿›åˆ¶** | `debug=0x43fff` | `0xå¼€å¤´` |

### 3.3 æŸ¥çœ‹æ¨¡å—å‚æ•°ä¿¡æ¯


**æŸ¥çœ‹æ¨¡å—æ”¯æŒçš„å‚æ•°**ï¼š
```bash
# æŸ¥çœ‹æ¨¡å—å‚æ•°è¯´æ˜
modinfo snd-hda-intel | grep parm

# æŸ¥çœ‹å·²åŠ è½½æ¨¡å—çš„å½“å‰å‚æ•°å€¼
cat /sys/module/snd_hda_intel/parameters/*

# æŸ¥çœ‹ç‰¹å®šå‚æ•°
cat /sys/module/snd_hda_intel/parameters/model
```

---

## 4. ğŸš« é»‘åå•æœºåˆ¶å®æˆ˜


### 4.1 ä»€ä¹ˆæ˜¯æ¨¡å—é»‘åå•


**é€šä¿—ç†è§£**ï¼šå°±åƒæ‰‹æœºçš„åº”ç”¨é»‘åå•ï¼ŒæŠŠæœ‰é—®é¢˜çš„æ¨¡å—åŠ å…¥é»‘åå•ï¼Œç³»ç»Ÿå°±ä¸ä¼šè‡ªåŠ¨åŠ è½½å®ƒä»¬

```
ç°å®ä¾‹å­ï¼š
- é¤å…é»‘åå•ï¼šæ‹’ç»æœåŠ¡æŸäº›å®¢äºº
- æ¨¡å—é»‘åå•ï¼šæ‹’ç»åŠ è½½æŸäº›æ¨¡å—

å¸¸è§éœ€è¦åŠ é»‘åå•çš„æƒ…å†µï¼š
âœ— æ¨¡å—æœ‰Bugå¯¼è‡´ç³»ç»Ÿä¸ç¨³å®š
âœ— æ¨¡å—ä¸ç¡¬ä»¶ä¸å…¼å®¹
âœ— å¤šä¸ªæ¨¡å—å†²çª
âœ— å®‰å…¨è€ƒè™‘ç¦ç”¨æŸäº›åŠŸèƒ½
```

### 4.2 blacklisté»‘åå•é…ç½®


**ğŸ”§ blacklistè¯­æ³•æ ¼å¼**
```bash
blacklist æ¨¡å—å
```

**å®ç”¨é»‘åå•é…ç½®**ï¼š

**ğŸ“„ /etc/modprobe.d/blacklist.conf**
```bash
# ç¦ç”¨PCæ‰¬å£°å™¨ï¼ˆå˜Ÿå˜Ÿå£°ï¼‰
blacklist pcspkr
blacklist snd-pcsp

# ç¦ç”¨æœ‰é—®é¢˜çš„ç½‘å¡é©±åŠ¨
blacklist rtl8192cu
blacklist rtl8xxxu

# ç¦ç”¨è“ç‰™æ¨¡å—ï¼ˆç¬”è®°æœ¬çœç”µï¼‰
blacklist bluetooth
blacklist btusb

# ç¦ç”¨æŸäº›USBè®¾å¤‡
blacklist uvcvideo        # USBæ‘„åƒå¤´
blacklist usb-storage     # USBå­˜å‚¨è®¾å¤‡
```

**ğŸ”¹ é»‘åå•çš„ä½œç”¨èŒƒå›´**

```
é»‘åå•å½±å“ï¼š
âœ“ é˜»æ­¢modprobeè‡ªåŠ¨åŠ è½½
âœ“ é˜»æ­¢ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½
âœ— ä¸é˜»æ­¢æ‰‹åŠ¨insmodå¼ºåˆ¶åŠ è½½
âœ— ä¸å½±å“å·²ç»åŠ è½½çš„æ¨¡å—

æ¢å¥è¯è¯´ï¼š
é»‘åå• = æ¸©å’Œçš„ç¦ç”¨ï¼Œä¸æ˜¯å¼ºåˆ¶ç¦ç”¨
```

### 4.3 é»‘åå•ç®¡ç†å®æˆ˜


**æŸ¥çœ‹ç³»ç»Ÿé»‘åå•**ï¼š
```bash
# æŸ¥çœ‹æ‰€æœ‰é»‘åå•é…ç½®
grep -r "blacklist" /etc/modprobe.d/

# æŸ¥çœ‹ç‰¹å®šæ¨¡å—æ˜¯å¦è¢«é»‘åå•
grep "pcspkr" /etc/modprobe.d/*
```

**ä¸´æ—¶ç¦ç”¨æ¨¡å—**ï¼š
```bash
# æ–¹æ³•1ï¼šå¸è½½å·²åŠ è½½çš„æ¨¡å—
rmmod pcspkr

# æ–¹æ³•2ï¼šæ·»åŠ åˆ°é»‘åå•å¹¶å¸è½½
echo "blacklist pcspkr" >> /etc/modprobe.d/blacklist.conf
rmmod pcspkr
```

**å¼ºåˆ¶åŠ è½½é»‘åå•æ¨¡å—**ï¼š
```bash
# å³ä½¿åœ¨é»‘åå•ï¼Œä¹Ÿå¼ºåˆ¶åŠ è½½
modprobe --force pcspkr

# æˆ–è€…ç›´æ¥ä½¿ç”¨insmod
insmod /lib/modules/$(uname -r)/kernel/drivers/input/misc/pcspkr.ko
```

### 4.4 install/removeè‡ªå®šä¹‰å‘½ä»¤


**ä»€ä¹ˆæ˜¯è‡ªå®šä¹‰åŠ è½½å‘½ä»¤**ï¼šå¯ä»¥å®šåˆ¶æ¨¡å—åŠ è½½å’Œå¸è½½æ—¶æ‰§è¡Œçš„ç‰¹æ®Šæ“ä½œ

```
æƒ³è±¡åœºæ™¯ï¼š
æ™®é€šåŠ è½½ï¼šç›´æ¥åŠ è½½æ¨¡å—ï¼Œå°±åƒç›´æ¥æ‰“å¼€åº”ç”¨
è‡ªå®šä¹‰åŠ è½½ï¼šåŠ è½½å‰å…ˆåšå‡†å¤‡å·¥ä½œï¼Œå°±åƒæ‰“å¼€æ¸¸æˆå‰å…ˆæ›´æ–°é©±åŠ¨
```

**ğŸ”§ install/removeè¯­æ³•**
```bash
install æ¨¡å—å å‘½ä»¤åºåˆ—
remove æ¨¡å—å å‘½ä»¤åºåˆ—
```

**å®ç”¨è‡ªå®šä¹‰å‘½ä»¤ç¤ºä¾‹**ï¼š

```bash
# USBå­˜å‚¨è®¾å¤‡åŠ è½½æ—¶å»¶è¿Ÿå¹¶è®°å½•æ—¥å¿—
install usb-storage /sbin/modprobe --ignore-install usb-storage && \
                    /bin/echo "USB storage loaded at $(date)" >> /var/log/usb.log

# è“ç‰™æ¨¡å—åŠ è½½å‰å¯åŠ¨ç›¸å…³æœåŠ¡
install bluetooth /usr/bin/systemctl start bluetooth && \
                  /sbin/modprobe --ignore-install bluetooth

# ç½‘å¡æ¨¡å—å¸è½½æ—¶æ¸…ç†ç½‘ç»œé…ç½®
remove e1000e /sbin/ifconfig eth0 down && \
              /sbin/modprobe -r --ignore-remove e1000e

# å£°å¡æ¨¡å—åŠ è½½æ—¶è®¾ç½®éŸ³é‡
install snd-hda-intel /sbin/modprobe --ignore-install snd-hda-intel && \
                      /usr/bin/amixer set Master 50%
```

**ğŸ”¹ --ignore-install/--ignore-removeå‚æ•°è¯´æ˜**

```
å‚æ•°ä½œç”¨ï¼š
--ignore-install  â†’ å¿½ç•¥è‡ªå®šä¹‰installå‘½ä»¤ï¼Œä½¿ç”¨é»˜è®¤åŠ è½½æ–¹å¼
--ignore-remove   â†’ å¿½ç•¥è‡ªå®šä¹‰removeå‘½ä»¤ï¼Œä½¿ç”¨é»˜è®¤å¸è½½æ–¹å¼

ä¸ºä»€ä¹ˆéœ€è¦ï¼š
é˜²æ­¢é€’å½’è°ƒç”¨ï¼Œé¿å…æ— é™å¾ªç¯
install usb-storage modprobe usb-storage  â† ä¼šæ— é™é€’å½’
install usb-storage modprobe --ignore-install usb-storage  â† æ­£ç¡®
```

---

## 5. âš™ï¸ é«˜çº§é…ç½®æŠ€å·§


### 5.1 æ¨¡å—åŠ è½½é¡ºåºæ§åˆ¶


**ä¸ºä»€ä¹ˆéœ€è¦æ§åˆ¶åŠ è½½é¡ºåº**ï¼šæœ‰äº›æ¨¡å—ä¹‹é—´æœ‰ä¾èµ–å…³ç³»ï¼Œå¿…é¡»æŒ‰æ­£ç¡®é¡ºåºåŠ è½½

```
ç”Ÿæ´»ä¾‹å­ï¼š
ç©¿è¡£æœï¼šå…ˆç©¿å†…è¡£ï¼Œå†ç©¿å¤–å¥—
åŠ è½½æ¨¡å—ï¼šå…ˆåŠ è½½åŸºç¡€é©±åŠ¨ï¼Œå†åŠ è½½é«˜çº§åŠŸèƒ½æ¨¡å—

å¸¸è§ä¾èµ–å…³ç³»ï¼š
USBæ§åˆ¶å™¨ â†’ USBè®¾å¤‡é©±åŠ¨
å£°å¡åŸºç¡€é©±åŠ¨ â†’ ALSAéŸ³é¢‘ç³»ç»Ÿ
ç½‘å¡é©±åŠ¨ â†’ ç½‘ç»œåè®®æ ˆ
```

**ğŸ”§ ä¾èµ–å…³ç³»é…ç½®**

```bash
# æ–¹æ³•1ï¼šä½¿ç”¨softdepè½¯ä¾èµ–
softdep snd-hda-intel pre: snd-hda-codec
softdep bluetooth post: btusb

# æ–¹æ³•2ï¼šåœ¨installå‘½ä»¤ä¸­æ§åˆ¶é¡ºåº
install snd-hda-intel /sbin/modprobe snd-hda-codec && \
                      /sbin/modprobe --ignore-install snd-hda-intel

# æ–¹æ³•3ï¼šä½¿ç”¨æ–‡ä»¶åæ§åˆ¶é…ç½®è¯»å–é¡ºåº
# 01-base.conf    å…ˆè¯»å–åŸºç¡€é…ç½®
# 50-drivers.conf å†è¯»å–é©±åŠ¨é…ç½®
# 99-final.conf   æœ€åè¯»å–æœ€ç»ˆé…ç½®
```

### 5.2 æ¡ä»¶åŒ–é…ç½®


**æ ¹æ®ç¡¬ä»¶æ¡ä»¶åº”ç”¨ä¸åŒé…ç½®**ï¼š

```bash
# åˆ›å»ºé’ˆå¯¹ç‰¹å®šç¡¬ä»¶çš„é…ç½®æ–‡ä»¶
# /etc/modprobe.d/laptop-audio.conf
# åªåœ¨ç¬”è®°æœ¬ä¸Šåº”ç”¨çš„éŸ³é¢‘é…ç½®
options snd-hda-intel model=laptop power_save=1

# /etc/modprobe.d/desktop-audio.conf  
# åªåœ¨å°å¼æœºä¸Šåº”ç”¨çš„éŸ³é¢‘é…ç½®
options snd-hda-intel model=desktop power_save=0
```

### 5.3 è°ƒè¯•å’Œæ•…éšœæ’é™¤é…ç½®


**å¯ç”¨æ¨¡å—è°ƒè¯•åŠŸèƒ½**ï¼š

```bash
# å¯ç”¨è¯¦ç»†è°ƒè¯•ä¿¡æ¯
options iwlwifi debug=0x43fff dyndbg=+p
options usbcore autosuspend=-1 dyndbg=+p

# åˆ›å»ºè°ƒè¯•ä¸“ç”¨é…ç½®
# /etc/modprobe.d/debug.conf
options drm debug=0x1f
options i915 modeset=1 enable_dc=0
```

**ğŸ” æ•…éšœæ’é™¤æŠ€å·§**

```bash
# æµ‹è¯•é…ç½®æ–‡ä»¶è¯­æ³•
modprobe -c | grep "ä½ çš„é…ç½®"

# æŸ¥çœ‹æ¨¡å—å®é™…åŠ è½½å‚æ•°
cat /sys/module/æ¨¡å—å/parameters/*

# é‡æ–°ç”Ÿæˆinitrdï¼ˆåŒ…å«æ–°é…ç½®ï¼‰
update-initramfs -u
```

### 5.4 å®æˆ˜é…ç½®æ–‡ä»¶ç¤ºä¾‹


**ğŸ“„ /etc/modprobe.d/99-custom.conf**
```bash
# è‡ªå®šä¹‰æ¨¡å—é…ç½®æ–‡ä»¶
# ä½œè€…ï¼šç³»ç»Ÿç®¡ç†å‘˜
# æ›´æ–°ï¼š2025-09-18

# === éŸ³é¢‘é…ç½® ===
# ç¦ç”¨PCå–‡å­
blacklist pcspkr
blacklist snd-pcsp

# HDAéŸ³é¢‘é…ç½®
alias sound snd-hda-intel
options snd-hda-intel model=auto index=0 power_save=1

# === ç½‘ç»œé…ç½® ===  
# æ— çº¿ç½‘å¡é…ç½®
options iwlwifi 11n_disable=0 swcrypto=0 bt_coex_active=0

# æœ‰çº¿ç½‘å¡åˆ«å
alias eth0 e1000e

# === ç”µæºç®¡ç† ===
# USBè‡ªåŠ¨ä¼‘çœ 
options usbcore autosuspend=5

# === å®‰å…¨é…ç½® ===
# ç¦ç”¨ä¸éœ€è¦çš„åè®®
blacklist dccp
blacklist sctp
blacklist rds
blacklist tipc

# === è™šæ‹ŸåŒ–ç›¸å…³ ===
# KVMæ¨¡å—é…ç½®
options kvm ignore_msrs=1
options kvm-intel nested=1 ept=1
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ é…ç½®ç³»ç»Ÿï¼šmodprobeè¯»å–é…ç½®æ–‡ä»¶æ§åˆ¶æ¨¡å—è¡Œä¸º
ğŸ”¸ æ–‡ä»¶ä½ç½®ï¼š/etc/modprobe.d/ç›®å½•ï¼ˆæ¨èï¼‰vs /etc/modprobe.confï¼ˆæ—§å¼ï¼‰
ğŸ”¸ æ ¸å¿ƒæŒ‡ä»¤ï¼šaliasåˆ«åã€optionså‚æ•°ã€blacklisté»‘åå•
ğŸ”¸ è‡ªå®šä¹‰å‘½ä»¤ï¼šinstall/removeæ§åˆ¶åŠ è½½å¸è½½è¿‡ç¨‹
ğŸ”¸ åŠ è½½é¡ºåºï¼šé€šè¿‡ä¾èµ–å…³ç³»å’Œæ–‡ä»¶åæ§åˆ¶
```

### 6.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ é…ç½®æ–‡ä»¶çš„ä½œç”¨æœºåˆ¶**
```
é…ç½®æµç¨‹ï¼š
1. ç”¨æˆ·æ‰§è¡Œmodprobeå‘½ä»¤
2. modprobeè¯»å–/etc/modprobe.d/æ‰€æœ‰.confæ–‡ä»¶
3. æ ¹æ®é…ç½®è§„åˆ™å¤„ç†æ¨¡å—åŠ è½½
4. åº”ç”¨åˆ«åã€å‚æ•°ã€é»‘åå•ç­‰è®¾ç½®
```

**ğŸ”¹ é»‘åå• vs å½»åº•ç¦ç”¨**
```
ç†è§£è¦ç‚¹ï¼š
blacklistï¼šæ¸©å’Œç¦ç”¨ï¼Œé˜»æ­¢è‡ªåŠ¨åŠ è½½ï¼Œä½†å…è®¸æ‰‹åŠ¨å¼ºåˆ¶åŠ è½½
å½»åº•ç¦ç”¨ï¼šéœ€è¦ç»“åˆå…¶ä»–æ‰‹æ®µï¼Œå¦‚é‡å‘½åæ¨¡å—æ–‡ä»¶
```

**ğŸ”¹ ç°ä»£é…ç½®çš„ä¼˜åŠ¿**
```
/etc/modprobe.d/ ä¼˜åŠ¿ï¼š
â€¢ æ¨¡å—åŒ–ç®¡ç†ï¼Œæ¯ä¸ªåŠŸèƒ½ç‹¬ç«‹æ–‡ä»¶
â€¢ ä¾¿äºç‰ˆæœ¬æ§åˆ¶å’Œå›¢é˜Ÿåä½œ  
â€¢ æ˜“äºè°ƒè¯•å’Œæ•…éšœæ’é™¤
â€¢ æ”¯æŒåŒ…ç®¡ç†å™¨è‡ªåŠ¨æ›´æ–°
```

### 6.3 å®é™…åº”ç”¨åœºæ™¯


**ğŸ“± ç¬”è®°æœ¬ä¼˜åŒ–åœºæ™¯**
```bash
# çœç”µé…ç½®
options iwlwifi power_save=1
options snd-hda-intel power_save=1
blacklist bluetooth     # ä¸ç”¨è“ç‰™æ—¶ç¦ç”¨
```

**ğŸ–¥ï¸ æœåŠ¡å™¨ç¨³å®šæ€§åœºæ™¯**  
```bash
# ç¦ç”¨ä¸éœ€è¦çš„åŠŸèƒ½
blacklist pcspkr        # ç¦ç”¨èœ‚é¸£å™¨
blacklist usb-storage   # ç¦ç”¨USBå­˜å‚¨ï¼ˆå®‰å…¨è€ƒè™‘ï¼‰
options e1000e InterruptThrottleRate=1  # ç½‘ç»œä¼˜åŒ–
```

**ğŸ® æ¸¸æˆ/å¤šåª’ä½“åœºæ™¯**
```bash
# ä½å»¶è¿ŸéŸ³é¢‘é…ç½®
options snd-hda-intel model=generic position_fix=1
options snd-usb-audio nrpacks=1        # USBéŸ³é¢‘ä¼˜åŒ–
```

### 6.4 æ•…éšœæ’é™¤è¦ç‚¹


**ğŸ”§ å¸¸è§é—®é¢˜è¯Šæ–­**
```bash
# é…ç½®ä¸ç”Ÿæ•ˆï¼šæ£€æŸ¥æ–‡ä»¶è¯­æ³•å’Œæƒé™
modprobe -c | grep "ä½ çš„é…ç½®"

# æ¨¡å—å†²çªï¼šæŸ¥çœ‹dmesgæ—¥å¿—
dmesg | grep -i "æ¨¡å—å"

# é»‘åå•æ— æ•ˆï¼šæ£€æŸ¥æ˜¯å¦å·²ç»åŠ è½½
lsmod | grep "æ¨¡å—å"
```

**âš ï¸ æ³¨æ„äº‹é¡¹**
- ä¿®æ”¹é…ç½®åéœ€è¦é‡æ–°åŠ è½½æ¨¡å—æ‰èƒ½ç”Ÿæ•ˆ
- æŸäº›é…ç½®éœ€è¦é‡æ–°ç”Ÿæˆinitrd
- æµ‹è¯•é…ç½®æ—¶å»ºè®®å…ˆå¤‡ä»½åŸæ–‡ä»¶
- é‡è¦ç³»ç»Ÿæ¨¡å—æ…ç”¨é»‘åå•

**æ ¸å¿ƒè®°å¿†**ï¼š
- æ¨¡å—é…ç½®åƒåº”ç”¨è®¾ç½®ï¼Œæ§åˆ¶æ¨¡å—è¡Œä¸ºè¡¨ç°
- åˆ«åè®©å¤æ‚åå­—å˜ç®€å•ï¼Œå‚æ•°è®©æ¨¡å—æ›´çµæ´»  
- é»‘åå•æ¸©å’Œç¦ç”¨åæ¨¡å—ï¼Œè‡ªå®šä¹‰å‘½ä»¤æ›´å¼ºå¤§
- ç°ä»£é…ç½®åˆ†æ–‡ä»¶ç®¡ç†ï¼Œè°ƒè¯•ç»´æŠ¤éƒ½æ–¹ä¾¿