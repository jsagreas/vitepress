---
title: 11ã€ç¯å¢ƒç®¡ç†ä¸éƒ¨ç½²ç­–ç•¥
---
## ğŸ“š ç›®å½•

1. [ç¯å¢ƒç®¡ç†åŸºç¡€æ¦‚å¿µ](#1-ç¯å¢ƒç®¡ç†åŸºç¡€æ¦‚å¿µ)
2. [å¤šç¯å¢ƒç®¡ç†ç­–ç•¥](#2-å¤šç¯å¢ƒç®¡ç†ç­–ç•¥)
3. [è“ç»¿éƒ¨ç½²å®è·µ](#3-è“ç»¿éƒ¨ç½²å®è·µ)
4. [é‡‘ä¸é›€å‘å¸ƒæ¨¡å¼](#4-é‡‘ä¸é›€å‘å¸ƒæ¨¡å¼)
5. [æ»šåŠ¨æ›´æ–°ç­–ç•¥](#5-æ»šåŠ¨æ›´æ–°ç­–ç•¥)
6. [ç¯å¢ƒéš”ç¦»ä¸å®‰å…¨](#6-ç¯å¢ƒéš”ç¦»ä¸å®‰å…¨)
7. [éƒ¨ç½²å›æ»šæœºåˆ¶](#7-éƒ¨ç½²å›æ»šæœºåˆ¶)
8. [é…ç½®å·®å¼‚åŒ–ç®¡ç†](#8-é…ç½®å·®å¼‚åŒ–ç®¡ç†)
9. [éƒ¨ç½²å®¡æ‰¹æµç¨‹](#9-éƒ¨ç½²å®¡æ‰¹æµç¨‹)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ—ï¸ ç¯å¢ƒç®¡ç†åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯ç¯å¢ƒç®¡ç†


**ç®€å•ç†è§£**ï¼šç¯å¢ƒç®¡ç†å°±åƒå»ºæˆ¿å­å‰çš„è§„åˆ’è®¾è®¡ï¼Œä½ éœ€è¦å…ˆè§„åˆ’å¥½å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç­‰ä¸åŒçš„"æˆ¿é—´"ï¼Œæ¯ä¸ªæˆ¿é—´æœ‰ç‰¹å®šçš„ç”¨é€”å’Œé…ç½®ã€‚

```
ğŸ  ç¯å¢ƒç±»æ¯”ï¼š
å®¶åº­è£…ä¿® â†’ è½¯ä»¶ç¯å¢ƒ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ä¹¦æˆ¿     â†’ å¼€å‘ç¯å¢ƒ  (ä¸“å¿ƒå†™ä»£ç )
å®¢å…     â†’ æµ‹è¯•ç¯å¢ƒ  (å±•ç¤ºç»™å®¶äººçœ‹)
å§å®¤     â†’ ç”Ÿäº§ç¯å¢ƒ  (æœ€ç»ˆå±…ä½ä½¿ç”¨)
```

**ğŸ¯ æ ¸å¿ƒç›®æ ‡**ï¼š
- **éš”ç¦»æ€§**ï¼šä¸åŒç¯å¢ƒäº’ä¸å¹²æ‰°ï¼Œå°±åƒæ¯ä¸ªæˆ¿é—´éƒ½æœ‰è‡ªå·±çš„é—¨
- **ä¸€è‡´æ€§**ï¼šç¡®ä¿å„ç¯å¢ƒé…ç½®ç›¸ä¼¼ï¼Œé¿å…"å¼€å‘ç¯å¢ƒæ­£å¸¸ï¼Œç”Ÿäº§ç¯å¢ƒå‡ºé”™"
- **å¯æ§æ€§**ï¼šæ¯ä¸ªç¯å¢ƒçš„å˜æ›´éƒ½è¦æœ‰è®¡åˆ’æœ‰è®°å½•
- **å®‰å…¨æ€§**ï¼šç”Ÿäº§ç¯å¢ƒè¦æœ‰ä¸¥æ ¼çš„è®¿é—®æ§åˆ¶

### 1.2 æ ‡å‡†ç¯å¢ƒåˆ†ç±»


**ğŸ“Š å…¸å‹ç¯å¢ƒå±‚æ¬¡**ï¼š

```
ç¯å¢ƒå±‚æ¬¡å›¾ï¼š
å¼€å‘ç¯å¢ƒ (DEV) â”€â”€â”
                â”œâ”€â”€ æµ‹è¯•ç¯å¢ƒ (TEST)
é›†æˆç¯å¢ƒ (INT) â”€â”€â”˜     â”œâ”€â”€ é¢„ç”Ÿäº§ç¯å¢ƒ (STAGING)
                     â”œâ”€â”€ ç”Ÿäº§ç¯å¢ƒ (PROD)
```

| ç¯å¢ƒç±»å‹ | **ç”¨é€”** | **ç¨³å®šæ€§è¦æ±‚** | **è®¿é—®æƒé™** | **æ›´æ–°é¢‘ç‡** |
|----------|----------|----------------|--------------|--------------|
| **å¼€å‘ç¯å¢ƒ** | `ç¼–ç è°ƒè¯•` | `ä½` | `å¼€å‘äººå‘˜` | `éšæ—¶` |
| **æµ‹è¯•ç¯å¢ƒ** | `åŠŸèƒ½æµ‹è¯•` | `ä¸­` | `æµ‹è¯•äººå‘˜` | `æ¯æ—¥` |
| **é›†æˆç¯å¢ƒ** | `ç³»ç»Ÿé›†æˆ` | `ä¸­é«˜` | `é¡¹ç›®ç»„` | `æ¯å‘¨` |
| **é¢„ç”Ÿäº§ç¯å¢ƒ** | `ä¸Šçº¿éªŒè¯` | `é«˜` | `è¿ç»´äººå‘˜` | `æ¯æœˆ` |
| **ç”Ÿäº§ç¯å¢ƒ** | `ç”¨æˆ·ä½¿ç”¨` | `æé«˜` | `ä¸¥æ ¼æ§åˆ¶` | `è®¡åˆ’æ€§` |

### 1.3 ç¯å¢ƒç®¡ç†çš„æ ¸å¿ƒæŒ‘æˆ˜


**âš ï¸ å¸¸è§é—®é¢˜**ï¼š
```
é…ç½®æ¼‚ç§»ï¼š
å¼€å‘ç¯å¢ƒç”¨çš„Python 3.8ï¼Œç”Ÿäº§ç¯å¢ƒå´æ˜¯Python 3.6
ç»“æœï¼šåŠŸèƒ½åœ¨å¼€å‘ç¯å¢ƒæ­£å¸¸ï¼Œç”Ÿäº§ç¯å¢ƒæŠ¥é”™

æ•°æ®ä¸ä¸€è‡´ï¼š
æµ‹è¯•ç¯å¢ƒåªæœ‰å‡ ç™¾æ¡æ•°æ®ï¼Œç”Ÿäº§ç¯å¢ƒæœ‰å‡ ç™¾ä¸‡æ¡
ç»“æœï¼šæ€§èƒ½æµ‹è¯•ç»“æœä¸å‡†ç¡®

æƒé™æ··ä¹±ï¼š
å¼€å‘äººå‘˜å¯ä»¥ç›´æ¥ä¿®æ”¹ç”Ÿäº§ç¯å¢ƒé…ç½®
ç»“æœï¼šçº¿ä¸Šæ•…éšœé¢‘å‘
```

**âœ… è§£å†³æ€è·¯**ï¼š
- **åŸºç¡€è®¾æ–½å³ä»£ç **ï¼šç”¨ä»£ç æè¿°ç¯å¢ƒé…ç½®
- **å®¹å™¨åŒ–éƒ¨ç½²**ï¼šç¡®ä¿è¿è¡Œç¯å¢ƒä¸€è‡´æ€§
- **è‡ªåŠ¨åŒ–ç®¡é“**ï¼šå‡å°‘äººå·¥æ“ä½œé”™è¯¯
- **ä¸¥æ ¼æƒé™æ§åˆ¶**ï¼šæœ€å°æƒé™åŸåˆ™

---

## 2. ğŸŒ å¤šç¯å¢ƒç®¡ç†ç­–ç•¥


### 2.1 ç¯å¢ƒé…ç½®ç®¡ç†


**ğŸ”§ é…ç½®åˆ†ç¦»åŸåˆ™**ï¼š
ä»£ç å’Œé…ç½®è¦åˆ†å¼€ç®¡ç†ï¼Œå°±åƒè¡£æœå’Œé‹å­è¦åˆ†å¼€å­˜æ”¾ä¸€æ ·ã€‚

```
é…ç½®åˆ†ç¦»ç¤ºä¾‹ï¼š
åº”ç”¨ä»£ç  (ä¸å˜)
â”œâ”€â”€ app.py
â”œâ”€â”€ models.py
â””â”€â”€ config/
    â”œâ”€â”€ dev.yml      â† å¼€å‘ç¯å¢ƒé…ç½®
    â”œâ”€â”€ test.yml     â† æµ‹è¯•ç¯å¢ƒé…ç½®
    â”œâ”€â”€ staging.yml  â† é¢„ç”Ÿäº§é…ç½®
    â””â”€â”€ prod.yml     â† ç”Ÿäº§ç¯å¢ƒé…ç½®
```

**ğŸ’¡ é…ç½®ç®¡ç†å·¥å…·å¯¹æ¯”**ï¼š

```
ç¯å¢ƒå˜é‡æ–¹å¼ï¼š
export DATABASE_URL="postgresql://localhost/myapp_dev"
export DEBUG=true

ä¼˜ç‚¹ï¼šç®€å•ç›´æ¥ï¼Œå®¹å™¨å‹å¥½
ç¼ºç‚¹ï¼šéš¾ä»¥ç®¡ç†å¤æ‚é…ç½®

é…ç½®æ–‡ä»¶æ–¹å¼ï¼š
# config/prod.yml
database:
  host: prod-db.company.com
  port: 5432
logging:
  level: ERROR

ä¼˜ç‚¹ï¼šç»“æ„æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤
ç¼ºç‚¹ï¼šéœ€è¦é¢å¤–çš„é…ç½®ç®¡ç†
```

### 2.2 åŸºç¡€è®¾æ–½å³ä»£ç 


**ğŸ—ï¸ Infrastructure as Code (IaC)**ï¼š
æŠŠåŸºç¡€è®¾æ–½çš„é…ç½®ç”¨ä»£ç æ¥æè¿°ï¼Œå°±åƒå»ºç­‘å¸ˆç”¨å›¾çº¸æè¿°æˆ¿å±‹ç»“æ„ä¸€æ ·ã€‚

**Terraformç¤ºä¾‹**ï¼š
```hcl
# å®šä¹‰å¼€å‘ç¯å¢ƒ
resource "aws_instance" "dev_server" {
  ami           = "ami-12345678"
  instance_type = "t2.micro"
  
  tags = {
    Name = "dev-server"
    Environment = "development"
  }
}

# å®šä¹‰ç”Ÿäº§ç¯å¢ƒ
resource "aws_instance" "prod_server" {
  ami           = "ami-12345678"
  instance_type = "t3.large"
  
  tags = {
    Name = "prod-server"
    Environment = "production"
  }
}
```

**ğŸ³ Docker Composeç¯å¢ƒç®¡ç†**ï¼š
```yaml
# docker-compose.dev.yml
version: '3'
services:
  app:
    build: .
    environment:
      - DEBUG=true
      - DB_HOST=localhost
    ports:
      - "3000:3000"

# docker-compose.prod.yml  
version: '3'
services:
  app:
    image: myapp:latest
    environment:
      - DEBUG=false
      - DB_HOST=prod-db.company.com
    deploy:
      replicas: 3
```

### 2.3 ç¯å¢ƒæ•°æ®ç®¡ç†


**ğŸ—„ï¸ æ•°æ®ç­–ç•¥**ï¼š

```
æ•°æ®ç®¡ç†åŸåˆ™ï¼š
ç”Ÿäº§æ•°æ® â†’ ä¸¥æ ¼ä¿æŠ¤ï¼Œä¸å…è®¸ä¸‹è½½
æµ‹è¯•æ•°æ® â†’ è„±æ•å¤„ç†ï¼Œå®šæœŸåŒæ­¥
å¼€å‘æ•°æ® â†’ æ¨¡æ‹Ÿæ•°æ®ï¼Œä¾¿äºè°ƒè¯•

æ•°æ®åŒæ­¥æµç¨‹ï¼š
ç”Ÿäº§ç¯å¢ƒ â†’ æ•°æ®è„±æ• â†’ æµ‹è¯•ç¯å¢ƒ â†’ ç²¾ç®€é‡‡æ · â†’ å¼€å‘ç¯å¢ƒ
```

**æ•°æ®è„±æ•ç¤ºä¾‹**ï¼š
```sql
-- ç”Ÿäº§ç¯å¢ƒåŸå§‹æ•°æ®
SELECT name, phone, email FROM users;
-- å¼ ä¸‰, 13812345678, zhang@email.com

-- æµ‹è¯•ç¯å¢ƒè„±æ•æ•°æ®  
SELECT 
  CONCAT('ç”¨æˆ·', id) as name,
  CONCAT('138****', RIGHT(phone, 4)) as phone,
  CONCAT('test', id, '@test.com') as email
FROM users;
-- ç”¨æˆ·123, 138****5678, test123@test.com
```

### 2.4 ç¯å¢ƒåˆ‡æ¢æœºåˆ¶


**ğŸ”„ æ™ºèƒ½ç¯å¢ƒåˆ‡æ¢**ï¼š
```bash
# ç¯å¢ƒç®¡ç†è„šæœ¬
#!/bin/bash
switch_env() {
  case $1 in
    "dev")
      export API_URL="http://localhost:3000"
      export DB_NAME="myapp_dev"
      ;;
    "test") 
      export API_URL="https://test-api.company.com"
      export DB_NAME="myapp_test"
      ;;
    "prod")
      export API_URL="https://api.company.com"
      export DB_NAME="myapp_prod"
      ;;
  esac
  echo "å·²åˆ‡æ¢åˆ° $1 ç¯å¢ƒ"
}

# ä½¿ç”¨æ–¹å¼
switch_env dev
```

---

## 3. ğŸ”µğŸŸ¢ è“ç»¿éƒ¨ç½²å®è·µ


### 3.1 è“ç»¿éƒ¨ç½²æ ¸å¿ƒæ¦‚å¿µ


**ä»€ä¹ˆæ˜¯è“ç»¿éƒ¨ç½²ï¼Ÿ**
æƒ³è±¡ä½ æœ‰ä¸¤å¥—å®Œå…¨ç›¸åŒçš„æˆ¿å­ï¼ˆè“æˆ¿å­å’Œç»¿æˆ¿å­ï¼‰ï¼Œä½ ä½åœ¨è“æˆ¿å­é‡Œã€‚å½“éœ€è¦è£…ä¿®æ—¶ï¼Œä½ å…ˆæŠŠç»¿æˆ¿å­è£…ä¿®å¥½ï¼Œç¡®è®¤æ²¡é—®é¢˜åç›´æ¥æ¬åˆ°ç»¿æˆ¿å­ï¼Œç„¶åæŠŠè“æˆ¿å­ç©ºå‡ºæ¥å¤‡ç”¨ã€‚

```
ğŸ  è“ç»¿éƒ¨ç½²ç¤ºæ„å›¾ï¼š
éƒ¨ç½²å‰çŠ¶æ€ï¼š
è“ç¯å¢ƒ (v1.0) â†â”€â”€ ç”¨æˆ·æµé‡ (100%)
ç»¿ç¯å¢ƒ (ç©ºé—²)

éƒ¨ç½²ä¸­çŠ¶æ€ï¼š
è“ç¯å¢ƒ (v1.0) â†â”€â”€ ç”¨æˆ·æµé‡ (100%)  
ç»¿ç¯å¢ƒ (v2.0) â†â”€â”€ éƒ¨ç½²æ–°ç‰ˆæœ¬

åˆ‡æ¢åçŠ¶æ€ï¼š
è“ç¯å¢ƒ (v1.0) â†â”€â”€ å¤‡ç”¨ç¯å¢ƒ
ç»¿ç¯å¢ƒ (v2.0) â†â”€â”€ ç”¨æˆ·æµé‡ (100%)
```

### 3.2 è“ç»¿éƒ¨ç½²ä¼˜åŠ¿


**âœ… æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- **é›¶åœæœºéƒ¨ç½²**ï¼šç”¨æˆ·æ„Ÿå—ä¸åˆ°æœåŠ¡ä¸­æ–­
- **å¿«é€Ÿå›æ»š**ï¼šå‡ºé—®é¢˜æ—¶ç¬é—´åˆ‡å›åŸç‰ˆæœ¬
- **å……åˆ†æµ‹è¯•**ï¼šæ–°ç‰ˆæœ¬åœ¨çœŸå®ç¯å¢ƒä¸­é¢„å…ˆéªŒè¯
- **é™ä½é£é™©**ï¼šæ—§ç‰ˆæœ¬å§‹ç»ˆä¿æŒå¯ç”¨çŠ¶æ€

**âš–ï¸ æˆæœ¬è€ƒè™‘**ï¼š
```
èµ„æºæˆæœ¬ï¼š
éœ€è¦åŒå€çš„æœåŠ¡å™¨èµ„æº
é€‚åˆï¼šå…³é”®ä¸šåŠ¡ç³»ç»Ÿ
ä¸é€‚åˆï¼šèµ„æºç´§å¼ çš„å°é¡¹ç›®

å¤æ‚åº¦ï¼š
éœ€è¦å®Œå–„çš„ç›‘æ§å’Œåˆ‡æ¢æœºåˆ¶
é€‚åˆï¼šæˆç†Ÿçš„è¿ç»´å›¢é˜Ÿ
ä¸é€‚åˆï¼šè¿ç»´èƒ½åŠ›ä¸è¶³çš„å›¢é˜Ÿ
```

### 3.3 è“ç»¿éƒ¨ç½²å®ç°æ–¹æ¡ˆ


**ğŸ”§ è´Ÿè½½å‡è¡¡å™¨å®ç°**ï¼š
```nginx
# nginxé…ç½®ç¤ºä¾‹
upstream blue_env {
    server blue-server1:8080;
    server blue-server2:8080;
}

upstream green_env {
    server green-server1:8080;
    server green-server2:8080;
}

server {
    listen 80;
    location / {
        # å½“å‰æŒ‡å‘è“ç¯å¢ƒ
        proxy_pass http://blue_env;
        
        # éƒ¨ç½²æ—¶åˆ‡æ¢åˆ°ç»¿ç¯å¢ƒ
        # proxy_pass http://green_env;
    }
}
```

**â˜ï¸ äº‘å¹³å°å®ç°**ï¼š
```yaml
# AWS ALB Target Groups
BlueTargetGroup:
  Type: AWS::ElasticLoadBalancingV2::TargetGroup
  Properties:
    Name: blue-targets
    Port: 8080
    VpcId: !Ref VPC

GreenTargetGroup:
  Type: AWS::ElasticLoadBalancingV2::TargetGroup  
  Properties:
    Name: green-targets
    Port: 8080
    VpcId: !Ref VPC

# æµé‡åˆ‡æ¢é€šè¿‡ä¿®æ”¹Listenerè§„åˆ™å®ç°
```

### 3.4 è“ç»¿éƒ¨ç½²æµç¨‹


**ğŸ“‹ æ ‡å‡†éƒ¨ç½²æµç¨‹**ï¼š
```
éƒ¨ç½²æµç¨‹å›¾ï¼š
å‡†å¤‡é˜¶æ®µ â†’ éƒ¨ç½²é˜¶æ®µ â†’ éªŒè¯é˜¶æ®µ â†’ åˆ‡æ¢é˜¶æ®µ â†’ æ¸…ç†é˜¶æ®µ
    â†“        â†“        â†“        â†“        â†“
æ£€æŸ¥èµ„æº   éƒ¨ç½²æ–°ç‰ˆæœ¬  å¥åº·æ£€æŸ¥   åˆ‡æ¢æµé‡   å›æ”¶æ—§ç‰ˆæœ¬
ç¡®è®¤çŠ¶æ€   é¢„çƒ­åº”ç”¨   åŠŸèƒ½éªŒè¯   ç›‘æ§æŒ‡æ ‡   å¤‡ä»½æ•°æ®
```

**ğŸ” å…³é”®æ£€æŸ¥ç‚¹**ï¼š
```
éƒ¨ç½²å‰æ£€æŸ¥ï¼š
â–¡ ç»¿ç¯å¢ƒèµ„æºå°±ç»ª
â–¡ æ•°æ®åº“è¿ç§»å‡†å¤‡
â–¡ å›æ»šæ–¹æ¡ˆç¡®è®¤

éƒ¨ç½²ä¸­ç›‘æ§ï¼š
â–¡ åº”ç”¨å¯åŠ¨çŠ¶æ€
â–¡ å¥åº·æ£€æŸ¥é€šè¿‡  
â–¡ æ€§èƒ½æŒ‡æ ‡æ­£å¸¸

åˆ‡æ¢åéªŒè¯ï¼š
â–¡ ç”¨æˆ·è®¿é—®æ­£å¸¸
â–¡ æ ¸å¿ƒåŠŸèƒ½å¯ç”¨
â–¡ é”™è¯¯ç‡åœ¨é¢„æœŸèŒƒå›´
```

---

## 4. ğŸ•Šï¸ é‡‘ä¸é›€å‘å¸ƒæ¨¡å¼


### 4.1 é‡‘ä¸é›€å‘å¸ƒåŸç†


**ä¸ºä»€ä¹ˆå«é‡‘ä¸é›€å‘å¸ƒï¼Ÿ**
æ—©æœŸçŸ¿å·¥ä¸‹äº•å‰ä¼šå¸¦ä¸€åªé‡‘ä¸é›€ï¼Œå› ä¸ºé‡‘ä¸é›€å¯¹æ¯’æ°”å¾ˆæ•æ„Ÿã€‚å¦‚æœé‡‘ä¸é›€å‡ºç°å¼‚å¸¸ï¼ŒçŸ¿å·¥å°±çŸ¥é“æœ‰å±é™©éœ€è¦æ’¤é€€ã€‚é‡‘ä¸é›€å‘å¸ƒä¹Ÿæ˜¯è¿™ä¸ªé“ç† - å…ˆè®©ä¸€å°éƒ¨åˆ†ç”¨æˆ·è¯•ç”¨æ–°ç‰ˆæœ¬ï¼Œå¦‚æœæœ‰é—®é¢˜åŠæ—¶å‘ç°ã€‚

```
ğŸ¦ é‡‘ä¸é›€å‘å¸ƒç¤ºæ„å›¾ï¼š
ç¬¬ä¸€é˜¶æ®µï¼š
æ—§ç‰ˆæœ¬ â†â”€â”€ 90%ç”¨æˆ·æµé‡
æ–°ç‰ˆæœ¬ â†â”€â”€ 10%ç”¨æˆ·æµé‡ (é‡‘ä¸é›€ç”¨æˆ·)

è§‚å¯Ÿæ— å¼‚å¸¸åé€æ­¥æ‰©å¤§ï¼š
æ—§ç‰ˆæœ¬ â†â”€â”€ 50%ç”¨æˆ·æµé‡  
æ–°ç‰ˆæœ¬ â†â”€â”€ 50%ç”¨æˆ·æµé‡

æœ€ç»ˆå…¨é‡å‘å¸ƒï¼š
æ—§ç‰ˆæœ¬ â†â”€â”€ 0%ç”¨æˆ·æµé‡
æ–°ç‰ˆæœ¬ â†â”€â”€ 100%ç”¨æˆ·æµé‡
```

### 4.2 é‡‘ä¸é›€å‘å¸ƒç­–ç•¥


**ğŸ“Š æµé‡åˆ†é…ç­–ç•¥**ï¼š

| é˜¶æ®µ | **æ–°ç‰ˆæœ¬æµé‡** | **è§‚å¯Ÿæ—¶é—´** | **å…³é”®æŒ‡æ ‡** |
|------|----------------|--------------|--------------|
| **åˆå§‹** | `5%` | `30åˆ†é’Ÿ` | `é”™è¯¯ç‡ã€å“åº”æ—¶é—´` |
| **æ‰©å±•1** | `25%` | `1å°æ—¶` | `ä¸šåŠ¡æŒ‡æ ‡ã€ç”¨æˆ·åé¦ˆ` |
| **æ‰©å±•2** | `50%` | `2å°æ—¶` | `ç³»ç»Ÿç¨³å®šæ€§` |
| **å…¨é‡** | `100%` | `æŒç»­ç›‘æ§` | `æ•´ä½“æ€§èƒ½` |

**ğŸ¯ ç”¨æˆ·åˆ†ç»„ç­–ç•¥**ï¼š
```
åœ°ç†ä½ç½®åˆ†ç»„ï¼š
ä¼˜å…ˆé€‰æ‹©éæ ¸å¿ƒåœ°åŒºç”¨æˆ·
ä¾‹å¦‚ï¼šå…ˆå‘å¸ƒåˆ°æµ‹è¯•å¸‚åœºï¼Œå†æ‰©å±•åˆ°ä¸»è¦å¸‚åœº

ç”¨æˆ·ç±»å‹åˆ†ç»„ï¼š
å†…éƒ¨å‘˜å·¥ â†’ Betaç”¨æˆ· â†’ æ™®é€šç”¨æˆ· â†’ VIPç”¨æˆ·
é£é™©ä»ä½åˆ°é«˜é€æ­¥é‡Šæ”¾

åŠŸèƒ½æ¨¡å—åˆ†ç»„ï¼š
éæ ¸å¿ƒåŠŸèƒ½ â†’ æ ¸å¿ƒåŠŸèƒ½
é™ä½ä¸šåŠ¡å½±å“èŒƒå›´
```

### 4.3 é‡‘ä¸é›€å‘å¸ƒå®ç°


**ğŸ”§ åŸºäºæƒé‡çš„æµé‡æ§åˆ¶**ï¼š
```yaml
# Kubernetes Istioç¤ºä¾‹
apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: app-canary
spec:
  http:
  - match:
    - headers:
        canary-user:
          exact: "true"
    route:
    - destination:
        host: app
        subset: v2
  - route:
    - destination:
        host: app  
        subset: v1
      weight: 90
    - destination:
        host: app
        subset: v2
      weight: 10
```

**ğŸ“ˆ ç›‘æ§å’Œå‘Šè­¦**ï¼š
```bash
# å…³é”®æŒ‡æ ‡ç›‘æ§
ç›‘æ§æŒ‡æ ‡è®¾ç½®ï¼š
é”™è¯¯ç‡é˜ˆå€¼ï¼š> 1%
å“åº”æ—¶é—´ï¼š> 500ms
CPUä½¿ç”¨ç‡ï¼š> 80%
å†…å­˜ä½¿ç”¨ç‡ï¼š> 85%

è‡ªåŠ¨å›æ»šæ¡ä»¶ï¼š
if é”™è¯¯ç‡ > é˜ˆå€¼ for 5åˆ†é’Ÿ:
    è‡ªåŠ¨å›æ»šåˆ°æ—§ç‰ˆæœ¬
    å‘é€å‘Šè­¦é€šçŸ¥
    è®°å½•å›æ»šåŸå› 
```

### 4.4 A/Bæµ‹è¯•ä¸é‡‘ä¸é›€å‘å¸ƒ


**ğŸ”¬ A/Bæµ‹è¯•ç‰¹ç‚¹**ï¼š
```
é‡‘ä¸é›€å‘å¸ƒ vs A/Bæµ‹è¯•ï¼š

é‡‘ä¸é›€å‘å¸ƒï¼š
ç›®çš„ï¼šéªŒè¯æŠ€æœ¯ç¨³å®šæ€§
æŒ‡æ ‡ï¼šç³»ç»Ÿæ€§èƒ½ã€é”™è¯¯ç‡
å†³ç­–ï¼šå…¨é‡å‘å¸ƒæˆ–å›æ»š

A/Bæµ‹è¯•ï¼š
ç›®çš„ï¼šéªŒè¯ä¸šåŠ¡æ•ˆæœ  
æŒ‡æ ‡ï¼šè½¬åŒ–ç‡ã€ç”¨æˆ·è¡Œä¸º
å†³ç­–ï¼šé€‰æ‹©æ›´ä¼˜ç‰ˆæœ¬

ç»“åˆä½¿ç”¨ï¼š
å…ˆè¿›è¡Œé‡‘ä¸é›€å‘å¸ƒç¡®ä¿æŠ€æœ¯ç¨³å®š
å†è¿›è¡ŒA/Bæµ‹è¯•éªŒè¯ä¸šåŠ¡æ•ˆæœ
```

---

## 5. ğŸ”„ æ»šåŠ¨æ›´æ–°ç­–ç•¥


### 5.1 æ»šåŠ¨æ›´æ–°åŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯æ»šåŠ¨æ›´æ–°ï¼Ÿ**
å°±åƒæ›´æ¢è½®èƒä¸€æ ·ï¼Œä½ ä¸èƒ½åŒæ—¶æ¢æ‰æ‰€æœ‰è½®èƒï¼Œè€Œæ˜¯ä¸€ä¸ªä¸€ä¸ªåœ°æ¢ã€‚æ»šåŠ¨æ›´æ–°ä¹Ÿæ˜¯é€ä¸ªæ›´æ–°æœåŠ¡å™¨ï¼Œç¡®ä¿å§‹ç»ˆæœ‰å¯ç”¨çš„æœåŠ¡åœ¨è¿è¡Œã€‚

```
ğŸš— æ»šåŠ¨æ›´æ–°ç¤ºæ„å›¾ï¼š
åˆå§‹çŠ¶æ€ï¼š
æœåŠ¡å™¨1(v1) æœåŠ¡å™¨2(v1) æœåŠ¡å™¨3(v1) â† å…¨éƒ¨æä¾›æœåŠ¡

æ›´æ–°é˜¶æ®µ1ï¼š
æœåŠ¡å™¨1(v2) æœåŠ¡å™¨2(v1) æœåŠ¡å™¨3(v1) â† æ›´æ–°ç¬¬1å°
    â†‘         â†‘         â†‘
   æ–°ç‰ˆæœ¬    æ—§ç‰ˆæœ¬    æ—§ç‰ˆæœ¬

æ›´æ–°é˜¶æ®µ2ï¼š  
æœåŠ¡å™¨1(v2) æœåŠ¡å™¨2(v2) æœåŠ¡å™¨3(v1) â† æ›´æ–°ç¬¬2å°

æœ€ç»ˆçŠ¶æ€ï¼š
æœåŠ¡å™¨1(v2) æœåŠ¡å™¨2(v2) æœåŠ¡å™¨3(v2) â† å…¨éƒ¨æ›´æ–°å®Œæˆ
```

### 5.2 æ»šåŠ¨æ›´æ–°å‚æ•°é…ç½®


**âš™ï¸ å…³é”®å‚æ•°è®¾ç½®**ï¼š

```yaml
# Kubernetesæ»šåŠ¨æ›´æ–°é…ç½®
apiVersion: apps/v1
kind: Deployment
metadata:
  name: myapp
spec:
  replicas: 6
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxUnavailable: 1     # æœ€å¤š1ä¸ªä¸å¯ç”¨
      maxSurge: 2          # æœ€å¤šé¢å¤–åˆ›å»º2ä¸ª
  template:
    spec:
      containers:
      - name: app
        image: myapp:v2.0
```

**ğŸ“Š å‚æ•°å«ä¹‰è§£é‡Š**ï¼š
```
maxUnavailable: 1
å«ä¹‰ï¼šæ›´æ–°è¿‡ç¨‹ä¸­æœ€å¤šå…è®¸1ä¸ªPodä¸å¯ç”¨
ç»“æœï¼šç¡®ä¿è‡³å°‘5ä¸ªPodåœ¨è¿è¡Œ

maxSurge: 2  
å«ä¹‰ï¼šæ›´æ–°è¿‡ç¨‹ä¸­æœ€å¤šé¢å¤–åˆ›å»º2ä¸ªPod
ç»“æœï¼šæœ€å¤šåŒæ—¶æœ‰8ä¸ªPodåœ¨è¿è¡Œ

æ›´æ–°èŠ‚å¥ï¼š
ä¿å®ˆç­–ç•¥ï¼šmaxUnavailable=0, maxSurge=1 (æ…¢ä½†ç¨³)
æ¿€è¿›ç­–ç•¥ï¼šmaxUnavailable=2, maxSurge=2 (å¿«ä½†é™©)
```

### 5.3 æ»šåŠ¨æ›´æ–°å¥åº·æ£€æŸ¥


**ğŸ¥ å¥åº·æ£€æŸ¥é…ç½®**ï¼š
```yaml
# å®Œæ•´çš„å¥åº·æ£€æŸ¥é…ç½®
livenessProbe:
  httpGet:
    path: /health
    port: 8080
  initialDelaySeconds: 30
  periodSeconds: 10
  
readinessProbe:
  httpGet:
    path: /ready  
    port: 8080
  initialDelaySeconds: 5
  periodSeconds: 5
  
startupProbe:
  httpGet:
    path: /startup
    port: 8080
  initialDelaySeconds: 10
  periodSeconds: 5
  failureThreshold: 30
```

**ğŸ’¡ å¥åº·æ£€æŸ¥æœ€ä½³å®è·µ**ï¼š
```
æ£€æŸ¥å±‚æ¬¡ï¼š
å¯åŠ¨æ£€æŸ¥ â†’ ç¡®ä¿åº”ç”¨å®Œå…¨å¯åŠ¨
å°±ç»ªæ£€æŸ¥ â†’ ç¡®ä¿èƒ½å¤Ÿå¤„ç†è¯·æ±‚  
å­˜æ´»æ£€æŸ¥ â†’ ç¡®ä¿åº”ç”¨æŒç»­å¥åº·

æ£€æŸ¥å†…å®¹ï¼š
â–¡ åº”ç”¨è¿›ç¨‹çŠ¶æ€
â–¡ æ•°æ®åº“è¿æ¥
â–¡ å¤–éƒ¨ä¾èµ–æœåŠ¡
â–¡ å…³é”®é…ç½®åŠ è½½
```

### 5.4 æ»šåŠ¨æ›´æ–°æ•…éšœå¤„ç†


**ğŸš¨ å¸¸è§æ•…éšœåœºæ™¯**ï¼š
```
å¯åŠ¨å¤±è´¥ï¼š
ç°è±¡ï¼šæ–°ç‰ˆæœ¬Podæ— æ³•æ­£å¸¸å¯åŠ¨
å¤„ç†ï¼šè‡ªåŠ¨åœæ­¢æ›´æ–°ï¼Œä¿æŒæ—§ç‰ˆæœ¬è¿è¡Œ

å¥åº·æ£€æŸ¥å¤±è´¥ï¼š
ç°è±¡ï¼šæ–°ç‰ˆæœ¬å¯åŠ¨ä½†å¥åº·æ£€æŸ¥ä¸é€šè¿‡
å¤„ç†ï¼šç§»é™¤æœ‰é—®é¢˜çš„Podï¼Œä¸æ¥æ”¶æµé‡

æ€§èƒ½ä¸‹é™ï¼š
ç°è±¡ï¼šæ–°ç‰ˆæœ¬å“åº”æ—¶é—´æ˜æ˜¾å¢åŠ 
å¤„ç†ï¼šæš‚åœæ›´æ–°ï¼Œåˆ†ææ€§èƒ½é—®é¢˜
```

**ğŸ”§ æ•…éšœæ¢å¤æœºåˆ¶**ï¼š
```bash
# kubectlæ»šåŠ¨æ›´æ–°æ“ä½œ
# æš‚åœæ›´æ–°
kubectl rollout pause deployment/myapp

# æ£€æŸ¥æ›´æ–°çŠ¶æ€
kubectl rollout status deployment/myapp

# å›æ»šåˆ°ä¸Šä¸€ç‰ˆæœ¬
kubectl rollout undo deployment/myapp

# å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬
kubectl rollout undo deployment/myapp --to-revision=3
```

---

## 6. ğŸ”’ ç¯å¢ƒéš”ç¦»ä¸å®‰å…¨


### 6.1 ç½‘ç»œéš”ç¦»ç­–ç•¥


**ğŸŒ ç½‘ç»œåˆ†å±‚è®¾è®¡**ï¼š
```
ç½‘ç»œéš”ç¦»æ¶æ„ï¼š
DMZåŒºåŸŸ (å¯¹å¤–æœåŠ¡)
â”œâ”€â”€ WebæœåŠ¡å™¨ (80/443ç«¯å£)
â””â”€â”€ è´Ÿè½½å‡è¡¡å™¨

åº”ç”¨åŒºåŸŸ (å†…éƒ¨å¤„ç†)  
â”œâ”€â”€ åº”ç”¨æœåŠ¡å™¨ (8080ç«¯å£)
â””â”€â”€ APIç½‘å…³

æ•°æ®åŒºåŸŸ (æ•°æ®å­˜å‚¨)
â”œâ”€â”€ æ•°æ®åº“æœåŠ¡å™¨ (3306ç«¯å£)
â””â”€â”€ ç¼“å­˜æœåŠ¡å™¨ (6379ç«¯å£)
```

**ğŸ”¥ é˜²ç«å¢™è§„åˆ™ç¤ºä¾‹**ï¼š
```bash
# iptablesç½‘ç»œéš”ç¦»è§„åˆ™
# å…è®¸Webå±‚è®¿é—®åº”ç”¨å±‚
iptables -A FORWARD -s 10.1.1.0/24 -d 10.1.2.0/24 -p tcp --dport 8080 -j ACCEPT

# å…è®¸åº”ç”¨å±‚è®¿é—®æ•°æ®å±‚
iptables -A FORWARD -s 10.1.2.0/24 -d 10.1.3.0/24 -p tcp --dport 3306 -j ACCEPT

# ç¦æ­¢Webå±‚ç›´æ¥è®¿é—®æ•°æ®å±‚
iptables -A FORWARD -s 10.1.1.0/24 -d 10.1.3.0/24 -j DROP
```

### 6.2 å®¹å™¨åŒ–éš”ç¦»


**ğŸ³ Dockerå®‰å…¨å®è·µ**ï¼š
```yaml
# å®‰å…¨çš„Dockeré…ç½®
version: '3'
services:
  app:
    image: myapp:latest
    user: "1000:1000"        # érootç”¨æˆ·è¿è¡Œ
    read_only: true          # åªè¯»æ–‡ä»¶ç³»ç»Ÿ
    tmpfs:
      - /tmp               # ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿ
    cap_drop:
      - ALL                # ç§»é™¤æ‰€æœ‰ç‰¹æƒ
    cap_add:  
      - NET_BIND_SERVICE   # åªæ·»åŠ å¿…è¦ç‰¹æƒ
    networks:
      - app-network        # ä¸“ç”¨ç½‘ç»œ
```

**ğŸ” æƒé™æœ€å°åŒ–**ï¼š
```dockerfile
# Dockerfileå®‰å…¨æ„å»º
FROM alpine:3.14
RUN addgroup -g 1000 appuser && \
    adduser -u 1000 -G appuser -s /bin/sh -D appuser

COPY --chown=appuser:appuser app /app
USER appuser
WORKDIR /app

# ç§»é™¤ä¸å¿…è¦çš„è½¯ä»¶åŒ…
RUN apk del curl wget
```

### 6.3 å¯†é’¥å’Œé…ç½®ç®¡ç†


**ğŸ—ï¸ å¯†é’¥ç®¡ç†ç­–ç•¥**ï¼š
```
å¯†é’¥ç®¡ç†å±‚æ¬¡ï¼š
å¼€å‘ç¯å¢ƒï¼šæ˜æ–‡é…ç½®æ–‡ä»¶ (ä»…ç”¨äºå¼€å‘)
æµ‹è¯•ç¯å¢ƒï¼šç¯å¢ƒå˜é‡ (åŸºæœ¬ä¿æŠ¤)
ç”Ÿäº§ç¯å¢ƒï¼šä¸“ç”¨å¯†é’¥ç®¡ç†ç³»ç»Ÿ (ä¸¥æ ¼åŠ å¯†)

å¯†é’¥è½®æ¢ï¼š
æ•°æ®åº“å¯†ç ï¼šæ¯å­£åº¦æ›´æ¢
APIå¯†é’¥ï¼šæ¯æœˆæ›´æ¢  
SSLè¯ä¹¦ï¼šåˆ°æœŸå‰30å¤©æ›´æ¢
```

**â˜ï¸ äº‘ç«¯å¯†é’¥ç®¡ç†**ï¼š
```yaml
# AWS Secrets Manageré›†æˆ
apiVersion: v1
kind: Secret
metadata:
  name: db-credentials
  annotations:
    secrets-store.csi.x-k8s.io/used: "true"
data:
  # å®é™…å¯†é’¥ä»AWS Secrets Managerè·å–
  username: <base64-encoded>
  password: <base64-encoded>
```

### 6.4 å®¡è®¡å’Œç›‘æ§


**ğŸ“Š å®‰å…¨ç›‘æ§æŒ‡æ ‡**ï¼š
```
è®¿é—®ç›‘æ§ï¼š
â€¢ å¼‚å¸¸ç™»å½•å°è¯•
â€¢ æƒé™æå‡æ“ä½œ
â€¢ æ•æ„Ÿæ–‡ä»¶è®¿é—®

ç½‘ç»œç›‘æ§ï¼š  
â€¢ å¼‚å¸¸æµé‡æ¨¡å¼
â€¢ æœªæˆæƒè¿æ¥å°è¯•
â€¢ æ•°æ®ä¼ è¾“å¼‚å¸¸

ç³»ç»Ÿç›‘æ§ï¼š
â€¢ è¿›ç¨‹å¼‚å¸¸å¯åŠ¨
â€¢ æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥
â€¢ ç³»ç»Ÿè°ƒç”¨ç›‘æ§
```

---

## 7. âª éƒ¨ç½²å›æ»šæœºåˆ¶


### 7.1 å›æ»šç­–ç•¥è®¾è®¡


**ğŸ¯ å›æ»šå†³ç­–çŸ©é˜µ**ï¼š

| é—®é¢˜ç±»å‹ | **ä¸¥é‡ç¨‹åº¦** | **å½±å“èŒƒå›´** | **å›æ»šç­–ç•¥** | **å“åº”æ—¶é—´** |
|----------|--------------|--------------|--------------|--------------|
| **æ€§èƒ½ä¸‹é™** | `ä¸­` | `éƒ¨åˆ†ç”¨æˆ·` | `é€æ­¥å›æ»š` | `30åˆ†é’Ÿ` |
| **åŠŸèƒ½æ•…éšœ** | `é«˜` | `æ ¸å¿ƒåŠŸèƒ½` | `ç«‹å³å›æ»š` | `5åˆ†é’Ÿ` |
| **å®‰å…¨æ¼æ´** | `æé«˜` | `å…¨éƒ¨ç”¨æˆ·` | `ç´§æ€¥å›æ»š` | `1åˆ†é’Ÿ` |
| **æ•°æ®é”™è¯¯** | `æé«˜` | `æ•°æ®å®Œæ•´æ€§` | `æ•°æ®æ¢å¤+å›æ»š` | `ç«‹å³` |

### 7.2 è‡ªåŠ¨å›æ»šæœºåˆ¶


**ğŸ¤– æ™ºèƒ½å›æ»šè§¦å‘**ï¼š
```yaml
# è‡ªåŠ¨å›æ»šé…ç½®ç¤ºä¾‹
apiVersion: argoproj.io/v1alpha1
kind: Rollout
metadata:
  name: myapp-rollout
spec:
  strategy:
    canary:
      analysis:
        templates:
        - templateName: error-rate
        args:
        - name: service-name
          value: myapp
      steps:
      - setWeight: 10
      - pause: {duration: 5m}
      - analysis:
          templates:
          - templateName: error-rate
          args:
          - name: error-threshold
            value: "0.05"  # 5%é”™è¯¯ç‡è§¦å‘å›æ»š
```

**ğŸ“ˆ ç›‘æ§æŒ‡æ ‡é…ç½®**ï¼š
```yaml
# Prometheuså‘Šè­¦è§„åˆ™
groups:
- name: deployment.rules
  rules:
  - alert: HighErrorRate
    expr: rate(http_requests_total{status=~"5.."}[5m]) > 0.05
    for: 2m
    annotations:
      summary: "é”™è¯¯ç‡è¿‡é«˜ï¼Œè§¦å‘è‡ªåŠ¨å›æ»š"
      
  - alert: HighLatency  
    expr: histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m])) > 0.5
    for: 3m
    annotations:
      summary: "å“åº”å»¶è¿Ÿè¿‡é«˜ï¼Œè€ƒè™‘å›æ»š"
```

### 7.3 æ•°æ®åº“å›æ»šå¤„ç†


**ğŸ—„ï¸ æ•°æ®åº“è¿ç§»å›æ»š**ï¼š
```sql
-- å‰å‘è¿ç§» (å‡çº§æ—¶æ‰§è¡Œ)
-- 001_add_user_email.up.sql
ALTER TABLE users ADD COLUMN email VARCHAR(255);
CREATE INDEX idx_users_email ON users(email);

-- åå‘è¿ç§» (å›æ»šæ—¶æ‰§è¡Œ)  
-- 001_add_user_email.down.sql
DROP INDEX idx_users_email;
ALTER TABLE users DROP COLUMN email;
```

**ğŸ’¡ æ•°æ®å®‰å…¨ç­–ç•¥**ï¼š
```
æ•°æ®åº“å›æ»šåŸåˆ™ï¼š
1. åªå…è®¸å‘åå…¼å®¹çš„æ•°æ®åº“å˜æ›´
2. æ–°å¢å­—æ®µè¦æœ‰é»˜è®¤å€¼
3. åˆ é™¤æ“ä½œè¦å…ˆæ ‡è®°å†åˆ é™¤
4. é‡è¦å˜æ›´è¦åˆ†é˜¶æ®µæ‰§è¡Œ

æ•°æ®å¤‡ä»½ç­–ç•¥ï¼š
éƒ¨ç½²å‰ï¼šåˆ›å»ºæ•°æ®åº“å¿«ç…§
éƒ¨ç½²ä¸­ï¼šå®æ—¶å¢é‡å¤‡ä»½
å›æ»šæ—¶ï¼šæ¢å¤åˆ°å¿«ç…§+é‡æ”¾æ—¥å¿—
```

### 7.4 å›æ»šéªŒè¯å’Œæµ‹è¯•


**âœ… å›æ»šæµ‹è¯•æ¸…å•**ï¼š
```
å›æ»šå‰å‡†å¤‡ï¼š
â–¡ ç¡®è®¤å›æ»šç‰ˆæœ¬å¯ç”¨
â–¡ æ£€æŸ¥æ•°æ®åº“å…¼å®¹æ€§
â–¡ å‡†å¤‡å›æ»šè„šæœ¬
â–¡ é€šçŸ¥ç›¸å…³äººå‘˜

å›æ»šæ‰§è¡Œï¼š
â–¡ åœæ­¢æ–°ç‰ˆæœ¬æµé‡
â–¡ æ‰§è¡Œå›æ»šæ“ä½œ
â–¡ éªŒè¯æœåŠ¡å¯ç”¨æ€§
â–¡ æ£€æŸ¥å…³é”®åŠŸèƒ½

å›æ»šåéªŒè¯ï¼š
â–¡ ç”¨æˆ·è®¿é—®æ­£å¸¸
â–¡ æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥
â–¡ æ€§èƒ½æŒ‡æ ‡æ¢å¤
â–¡ æ—¥å¿—æ— å¼‚å¸¸é”™è¯¯
```

---

## 8. âš™ï¸ é…ç½®å·®å¼‚åŒ–ç®¡ç†


### 8.1 é…ç½®ç®¡ç†æ¶æ„


**ğŸ—ï¸ åˆ†å±‚é…ç½®æ¨¡å‹**ï¼š
```
é…ç½®å±‚æ¬¡ç»“æ„ï¼š
å…¨å±€é…ç½® (Global)
â”œâ”€â”€ åŒºåŸŸé…ç½® (Region)
â”‚   â”œâ”€â”€ ç¯å¢ƒé…ç½® (Environment)  
â”‚   â”‚   â”œâ”€â”€ åº”ç”¨é…ç½® (Application)
â”‚   â”‚   â””â”€â”€ æœåŠ¡é…ç½® (Service)
```

**ğŸ“ é…ç½®æ–‡ä»¶ç»„ç»‡**ï¼š
```
config/
â”œâ”€â”€ global/
â”‚   â”œâ”€â”€ default.yml          # å…¨å±€é»˜è®¤é…ç½®
â”‚   â””â”€â”€ security.yml         # å®‰å…¨ç›¸å…³é…ç½®
â”œâ”€â”€ environments/
â”‚   â”œâ”€â”€ dev.yml             # å¼€å‘ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ test.yml            # æµ‹è¯•ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ staging.yml         # é¢„ç”Ÿäº§é…ç½®
â”‚   â””â”€â”€ prod.yml            # ç”Ÿäº§ç¯å¢ƒé…ç½®
â””â”€â”€ applications/
    â”œâ”€â”€ web-app.yml         # Webåº”ç”¨é…ç½®
    â”œâ”€â”€ api-service.yml     # APIæœåŠ¡é…ç½®
    â””â”€â”€ worker.yml          # åå°ä»»åŠ¡é…ç½®
```

### 8.2 é…ç½®ç»§æ‰¿å’Œè¦†ç›–


**ğŸ”— é…ç½®åˆå¹¶è§„åˆ™**ï¼š
```yaml
# global/default.yml
database:
  host: localhost
  port: 5432
  timeout: 30
logging:
  level: INFO

# environments/prod.yml  
database:
  host: prod-db.company.com  # è¦†ç›–ä¸»æœº
  # portå’Œtimeoutç»§æ‰¿é»˜è®¤å€¼
logging:
  level: ERROR               # è¦†ç›–æ—¥å¿—çº§åˆ«

# æœ€ç»ˆç”Ÿäº§ç¯å¢ƒé…ç½®
database:
  host: prod-db.company.com
  port: 5432
  timeout: 30
logging:
  level: ERROR
```

### 8.3 åŠ¨æ€é…ç½®ç®¡ç†


**ğŸ”„ é…ç½®çƒ­æ›´æ–°**ï¼š
```yaml
# Spring Cloud Configç¤ºä¾‹
spring:
  cloud:
    config:
      server:
        git:
          uri: https://github.com/company/config-repo
          search-paths: '{application}'
      
# é…ç½®ä»“åº“ç»“æ„  
config-repo/
â”œâ”€â”€ myapp/
â”‚   â”œâ”€â”€ myapp-dev.yml
â”‚   â”œâ”€â”€ myapp-test.yml
â”‚   â””â”€â”€ myapp-prod.yml
```

**ğŸ“¡ é…ç½®æ¨é€æœºåˆ¶**ï¼š
```bash
# Consulé…ç½®ç®¡ç†
consul kv put config/myapp/database/host "new-db-host.com"
consul kv put config/myapp/cache/ttl "3600"

# åº”ç”¨ç›‘å¬é…ç½®å˜æ›´
consul watch -type=key -key=config/myapp/ ./reload-config.sh
```

### 8.4 é…ç½®å®‰å…¨å’Œå®¡è®¡


**ğŸ” æ•æ„Ÿé…ç½®å¤„ç†**ï¼š
```yaml
# ä½¿ç”¨é…ç½®æ¨¡æ¿
database:
  host: "${DB_HOST}"
  username: "${DB_USER}"  
  password: "${DB_PASSWORD}"

# ç¯å¢ƒå˜é‡æ³¨å…¥
export DB_HOST="prod-db.company.com"
export DB_USER="app_user"
export DB_PASSWORD="$(vault kv get -field=password secret/db)"
```

**ğŸ“‹ é…ç½®å˜æ›´å®¡è®¡**ï¼š
```json
{
  "timestamp": "2024-01-15T10:30:00Z",
  "user": "admin@company.com",
  "action": "UPDATE",
  "resource": "config/prod/database",
  "old_value": "old-db.company.com",
  "new_value": "new-db.company.com",
  "reason": "æ•°æ®åº“è¿ç§»",
  "approved_by": "ops-manager@company.com"
}
```

---

## 9. ğŸ“‹ éƒ¨ç½²å®¡æ‰¹æµç¨‹


### 9.1 å®¡æ‰¹æµç¨‹è®¾è®¡


**ğŸ”„ å¤šçº§å®¡æ‰¹æµç¨‹**ï¼š
```
å®¡æ‰¹æµç¨‹å›¾ï¼š
å¼€å‘æäº¤ â†’ ä»£ç å®¡æŸ¥ â†’ è‡ªåŠ¨æµ‹è¯• â†’ å®‰å…¨æ‰«æ â†’ æŠ€æœ¯å®¡æ‰¹ â†’ ä¸šåŠ¡å®¡æ‰¹ â†’ è¿ç»´éƒ¨ç½²
    â†“         â†“         â†“         â†“         â†“         â†“         â†“
 åˆ›å»ºPR     åŒè¡Œè¯„å®¡    CI/CD     å®‰å…¨å›¢é˜Ÿ   æŠ€æœ¯ç»ç†   äº§å“ç»ç†   è¿ç»´å·¥ç¨‹å¸ˆ
```

**ğŸ‘¥ å®¡æ‰¹è§’è‰²å®šä¹‰**ï¼š

| è§’è‰² | **èŒè´£** | **å®¡æ‰¹å†…å®¹** | **ç´§æ€¥æƒ…å†µæƒé™** |
|------|----------|--------------|------------------|
| **å¼€å‘äººå‘˜** | `ä»£ç ç¼–å†™` | `åŠŸèƒ½å®ç°` | `çƒ­ä¿®å¤æäº¤` |
| **æŠ€æœ¯Lead** | `æŠ€æœ¯å®¡æŸ¥` | `æ¶æ„è®¾è®¡` | `æŠ€æœ¯é£é™©è¯„ä¼°` |
| **äº§å“ç»ç†** | `ä¸šåŠ¡å®¡æŸ¥` | `åŠŸèƒ½éœ€æ±‚` | `ä¸šåŠ¡å½±å“è¯„ä¼°` |
| **è¿ç»´å·¥ç¨‹å¸ˆ** | `éƒ¨ç½²æ‰§è¡Œ` | `è¿ç»´é£é™©` | `ç´§æ€¥å›æ»š` |
| **å®‰å…¨å›¢é˜Ÿ** | `å®‰å…¨å®¡æŸ¥` | `å®‰å…¨æ¼æ´` | `å®‰å…¨äº‹ä»¶å¤„ç†` |

### 9.2 è‡ªåŠ¨åŒ–å®¡æ‰¹


**ğŸ¤– è‡ªåŠ¨å®¡æ‰¹æ¡ä»¶**ï¼š
```yaml
# GitHub Actionså®¡æ‰¹å·¥ä½œæµ
name: Auto Approval
on:
  pull_request:
    types: [opened, synchronize]

jobs:
  auto-approve:
    if: |
      github.actor == 'dependabot[bot]' ||
      (
        contains(github.event.pull_request.labels.*.name, 'hotfix') &&
        github.event.pull_request.changed_files < 5 &&
        !contains(github.event.pull_request.title, 'database')
      )
    steps:
      - name: Auto approve
        uses: hmarr/auto-approve-action@v2
```

**ğŸ” è´¨é‡é—¨ç¦**ï¼š
```yaml
# è´¨é‡æ£€æŸ¥é…ç½®
quality_gates:
  code_coverage: "> 80%"
  security_scan: "no_high_severity"
  performance_test: "pass"
  integration_test: "pass"
  
auto_approval_conditions:
  - all_quality_gates_pass: true
  - changed_files: "< 10"
  - no_database_changes: true
  - approval_from: ["tech-lead", "security-team"]
```

### 9.3 ç´§æ€¥å‘å¸ƒæµç¨‹


**ğŸš¨ ç´§æ€¥å‘å¸ƒé€šé“**ï¼š
```
ç´§æ€¥å‘å¸ƒæµç¨‹ï¼š
å‘ç°é—®é¢˜ â†’ è¯„ä¼°å½±å“ â†’ åˆ¶å®šæ–¹æ¡ˆ â†’ å¿«é€Ÿå®¡æ‰¹ â†’ ç«‹å³éƒ¨ç½² â†’ äº‹åå®¡æŸ¥
    â†“         â†“         â†“         â†“         â†“         â†“
  ç›‘æ§å‘Šè­¦   å½±å“åˆ†æ   ä¿®å¤ä»£ç    ç”µè¯å®¡æ‰¹   çƒ­ä¿®å¤   å¤ç›˜æ€»ç»“
```

**âš¡ ç´§æ€¥æƒé™ç®¡ç†**ï¼š
```bash
# ç´§æ€¥è®¿é—®æƒé™è„šæœ¬
#!/bin/bash
grant_emergency_access() {
  local user=$1
  local duration=$2  # å°æ—¶
  local reason=$3
  
  # è®°å½•ç´§æ€¥è®¿é—®
  echo "$(date): $user granted emergency access for $duration hours. Reason: $reason" >> /var/log/emergency_access.log
  
  # æˆäºˆä¸´æ—¶æƒé™
  sudo usermod -aG prod-deploy $user
  
  # è®¾ç½®æƒé™è¿‡æœŸ
  echo "sudo deluser $user prod-deploy" | at now + $duration hours
  
  # å‘é€é€šçŸ¥
  slack-notify "ğŸš¨ Emergency access granted to $user for $duration hours"
}
```

### 9.4 å®¡æ‰¹å·¥å…·é›†æˆ


**ğŸ”§ å®¡æ‰¹ç³»ç»Ÿé›†æˆ**ï¼š
```yaml
# Tekton Pipelineå®¡æ‰¹é›†æˆ
apiVersion: tekton.dev/v1beta1
kind: Pipeline
metadata:
  name: deployment-pipeline
spec:
  tasks:
  - name: code-review
    taskRef:
      name: github-pr-check
  - name: security-scan
    taskRef:
      name: security-scanner
    runAfter: ["code-review"]
  - name: manual-approval
    taskRef:
      name: manual-approval-task
    runAfter: ["security-scan"]
    params:
    - name: approvers
      value: ["tech-lead@company.com", "security@company.com"]
  - name: deploy
    taskRef:
      name: deploy-task
    runAfter: ["manual-approval"]
```

**ğŸ“± ç§»åŠ¨ç«¯å®¡æ‰¹**ï¼š
```json
{
  "approval_request": {
    "id": "req-12345",
    "title": "ç”Ÿäº§ç¯å¢ƒçƒ­ä¿®å¤éƒ¨ç½²",
    "description": "ä¿®å¤ç”¨æˆ·ç™»å½•é—®é¢˜",
    "severity": "high",
    "estimated_impact": "5åˆ†é’Ÿåœæœºæ—¶é—´",
    "approvers": [
      {
        "name": "æŠ€æœ¯ç»ç†",
        "email": "tech-lead@company.com",
        "required": true
      }
    ],
    "deadline": "2024-01-15T15:00:00Z",
    "auto_approve_after": "2024-01-15T15:30:00Z"
  }
}
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ ç¯å¢ƒç®¡ç†ï¼šå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒçš„åˆ†ç¦»å’Œé…ç½®ç®¡ç†
ğŸ”¸ è“ç»¿éƒ¨ç½²ï¼šé›¶åœæœºéƒ¨ç½²ï¼Œå¿«é€Ÿåˆ‡æ¢ï¼Œå³æ—¶å›æ»š
ğŸ”¸ é‡‘ä¸é›€å‘å¸ƒï¼šæ¸è¿›å¼å‘å¸ƒï¼Œé£é™©å¯æ§ï¼Œé€æ­¥éªŒè¯
ğŸ”¸ æ»šåŠ¨æ›´æ–°ï¼šé€ä¸ªæ›´æ–°ï¼Œä¿æŒæœåŠ¡å¯ç”¨æ€§
ğŸ”¸ ç¯å¢ƒéš”ç¦»ï¼šç½‘ç»œã€æƒé™ã€æ•°æ®çš„å¤šå±‚éš”ç¦»
ğŸ”¸ å›æ»šæœºåˆ¶ï¼šè‡ªåŠ¨åŒ–å›æ»šï¼Œæ•°æ®å®‰å…¨ï¼Œå¿«é€Ÿæ¢å¤
ğŸ”¸ é…ç½®ç®¡ç†ï¼šåˆ†å±‚é…ç½®ï¼ŒåŠ¨æ€æ›´æ–°ï¼Œå®‰å…¨å­˜å‚¨
ğŸ”¸ å®¡æ‰¹æµç¨‹ï¼šå¤šçº§å®¡æ‰¹ï¼Œè‡ªåŠ¨åŒ–è´¨é‡é—¨ç¦ï¼Œç´§æ€¥é€šé“
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ éƒ¨ç½²ç­–ç•¥é€‰æ‹©åŸåˆ™**ï¼š
```
è“ç»¿éƒ¨ç½²ï¼š
âœ… é€‚ç”¨ï¼šå…³é”®ä¸šåŠ¡ç³»ç»Ÿï¼Œèµ„æºå……è¶³
âŒ ä¸é€‚ç”¨ï¼šèµ„æºå—é™ï¼Œç®€å•åº”ç”¨

é‡‘ä¸é›€å‘å¸ƒï¼š
âœ… é€‚ç”¨ï¼šç”¨æˆ·æ•æ„ŸåŠŸèƒ½ï¼Œæ¸è¿›éªŒè¯
âŒ ä¸é€‚ç”¨ï¼šå†…éƒ¨å·¥å…·ï¼Œç´§æ€¥ä¿®å¤

æ»šåŠ¨æ›´æ–°ï¼š
âœ… é€‚ç”¨ï¼šå¾®æœåŠ¡æ¶æ„ï¼Œå®¹å™¨åŒ–åº”ç”¨
âŒ ä¸é€‚ç”¨ï¼šå•ä½“åº”ç”¨ï¼ŒçŠ¶æ€ä¿æŒ
```

**ğŸ”¹ ç¯å¢ƒç®¡ç†æœ€ä½³å®è·µ**ï¼š
```
ä¸€è‡´æ€§åŸåˆ™ï¼š
â€¢ åŸºç¡€è®¾æ–½å³ä»£ç 
â€¢ å®¹å™¨åŒ–éƒ¨ç½²
â€¢ è‡ªåŠ¨åŒ–é…ç½®

å®‰å…¨æ€§åŸåˆ™ï¼š
â€¢ æœ€å°æƒé™è®¿é—®
â€¢ ç½‘ç»œåˆ†å±‚éš”ç¦»
â€¢ æ•æ„Ÿä¿¡æ¯åŠ å¯†

å¯è§‚æµ‹æ€§åŸåˆ™ï¼š
â€¢ å…¨é“¾è·¯ç›‘æ§
â€¢ å®¡è®¡æ—¥å¿—è®°å½•
â€¢ æ€§èƒ½æŒ‡æ ‡è¿½è¸ª
```

**ğŸ”¹ ç°ä»£éƒ¨ç½²å‘å±•è¶‹åŠ¿**ï¼š
```
è‡ªåŠ¨åŒ–ç¨‹åº¦æå‡ï¼š
â€¢ CI/CDå…¨æµç¨‹è‡ªåŠ¨åŒ–
â€¢ æ™ºèƒ½è´¨é‡é—¨ç¦
â€¢ è‡ªåŠ¨å›æ»šå†³ç­–

äº‘åŸç”ŸæŠ€æœ¯é‡‡ç”¨ï¼š
â€¢ å®¹å™¨ç¼–æ’å¹³å°
â€¢ æœåŠ¡ç½‘æ ¼
â€¢ æ— æœåŠ¡å™¨æ¶æ„

å®‰å…¨å·¦ç§»ï¼š
â€¢ å¼€å‘é˜¶æ®µé›†æˆå®‰å…¨æ£€æŸ¥
â€¢ è‡ªåŠ¨åŒ–å®‰å…¨æ‰«æ
â€¢ é›¶ä¿¡ä»»ç½‘ç»œæ¶æ„
```

### 10.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ’¼ ä¼ä¸šå®æ–½è·¯çº¿å›¾**ï¼š
```
ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€å»ºè®¾
â€¢ å»ºç«‹æ ‡å‡†åŒ–ç¯å¢ƒ
â€¢ å®æ–½åŸºæœ¬CI/CD
â€¢ å®Œå–„ç›‘æ§ä½“ç³»

ç¬¬äºŒé˜¶æ®µï¼šæµç¨‹ä¼˜åŒ–
â€¢ å¼•å…¥è“ç»¿éƒ¨ç½²
â€¢ å®æ–½é‡‘ä¸é›€å‘å¸ƒ
â€¢ è‡ªåŠ¨åŒ–å›æ»š

ç¬¬ä¸‰é˜¶æ®µï¼šé«˜çº§ç‰¹æ€§
â€¢ å¤šé›†ç¾¤ç®¡ç†
â€¢ æ™ºèƒ½åŒ–éƒ¨ç½²
â€¢ å…¨é¢å®‰å…¨é›†æˆ
```

**ğŸ› ï¸ æŠ€æœ¯é€‰å‹å»ºè®®**ï¼š
```
å°å‹å›¢é˜Ÿï¼š
â€¢ Docker + Docker Compose
â€¢ GitLab CI/CD
â€¢ ç®€å•çš„è„šæœ¬åŒ–éƒ¨ç½²

ä¸­å‹å›¢é˜Ÿï¼š
â€¢ Kubernetes + Helm
â€¢ Jenkins/GitHub Actions
â€¢ åŸºç¡€è®¾æ–½å³ä»£ç 

å¤§å‹ä¼ä¸šï¼š
â€¢ ä¼ä¸šçº§å®¹å™¨å¹³å°
â€¢ å®Œæ•´DevOpså·¥å…·é“¾
â€¢ å¤šäº‘éƒ¨ç½²ç­–ç•¥
```

**ğŸ¯ å…³é”®æŒ‡æ ‡ç›‘æ§**ï¼š
```
éƒ¨ç½²æˆåŠŸç‡ï¼š> 95%
éƒ¨ç½²æ—¶é—´ï¼š< 30åˆ†é’Ÿ
å›æ»šæ—¶é—´ï¼š< 5åˆ†é’Ÿ
æœåŠ¡å¯ç”¨æ€§ï¼š> 99.9%
å¹³å‡æ¢å¤æ—¶é—´ï¼š< 15åˆ†é’Ÿ
```

### 10.4 å­¦ä¹ å»ºè®®å’Œå‘å±•æ–¹å‘


**ğŸ“š å­¦ä¹ è·¯å¾„å»ºè®®**ï¼š
```
åŸºç¡€é˜¶æ®µï¼š
â€¢ æŒæ¡LinuxåŸºæœ¬æ“ä½œ
â€¢ ç†è§£ç½‘ç»œå’Œç³»ç»Ÿæ¦‚å¿µ
â€¢ å­¦ä¹ å®¹å™¨æŠ€æœ¯åŸºç¡€

è¿›é˜¶é˜¶æ®µï¼š
â€¢ æ·±å…¥å­¦ä¹ Kubernetes
â€¢ æŒæ¡CI/CDå·¥å…·é“¾
â€¢ ç†è§£äº‘åŸç”Ÿæ¶æ„

é«˜çº§é˜¶æ®µï¼š
â€¢ ç ”ç©¶åˆ†å¸ƒå¼ç³»ç»Ÿ
â€¢ å­¦ä¹ SREå®è·µ
â€¢ å…³æ³¨æ–°æŠ€æœ¯è¶‹åŠ¿
```

**ğŸš€ æŠ€æœ¯å‘å±•è¶‹åŠ¿**ï¼š
```
GitOpsï¼š
â€¢ å£°æ˜å¼é…ç½®ç®¡ç†
â€¢ Gitä½œä¸ºå•ä¸€äº‹å®æ¥æº
â€¢ è‡ªåŠ¨åŒ–åŒæ­¥æœºåˆ¶

å¹³å°å·¥ç¨‹ï¼š
â€¢ å†…éƒ¨å¼€å‘è€…å¹³å°
â€¢ è‡ªæœåŠ¡éƒ¨ç½²èƒ½åŠ›
â€¢ æ ‡å‡†åŒ–å·¥å…·é“¾

AIè¿ç»´ï¼š
â€¢ æ™ºèƒ½æ•…éšœé¢„æµ‹
â€¢ è‡ªåŠ¨åŒ–é—®é¢˜ä¿®å¤
â€¢ ä¼˜åŒ–èµ„æºè°ƒåº¦
```

**ğŸ’¡ å®è·µå»ºè®®**ï¼š
```
å¼€å§‹å®è·µï¼š
â€¢ ä»å°é¡¹ç›®å¼€å§‹
â€¢ é€æ­¥å¼•å…¥è‡ªåŠ¨åŒ–
â€¢ é‡è§†ç›‘æ§å’Œæ—¥å¿—

å›¢é˜Ÿåä½œï¼š
â€¢ å»ºç«‹æ ‡å‡†æµç¨‹
â€¢ åŠ å¼ºæ²Ÿé€šåè°ƒ
â€¢ æŒç»­æ”¹è¿›ä¼˜åŒ–

æŠ€èƒ½æå‡ï¼š
â€¢ å‚ä¸å¼€æºé¡¹ç›®
â€¢ å­¦ä¹ æœ€ä½³å®è·µ
â€¢ å…³æ³¨ç¤¾åŒºåŠ¨æ€
```

**ğŸ§  è®°å¿†è¦ç‚¹**ï¼š
- ç¯å¢ƒç®¡ç†æ˜¯DevOpsçš„åŸºç¡€ï¼Œç¡®ä¿ä¸€è‡´æ€§å’Œå¯æ§æ€§
- éƒ¨ç½²ç­–ç•¥è¦æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©ï¼Œæ²¡æœ‰ä¸‡èƒ½æ–¹æ¡ˆ
- å®‰å…¨å’Œéš”ç¦»åœ¨æ¯ä¸ªç¯èŠ‚éƒ½è¦è€ƒè™‘ï¼Œä¸èƒ½äº‹åè¡¥æ•‘
- è‡ªåŠ¨åŒ–æ˜¯è¶‹åŠ¿ï¼Œä½†è¦å¾ªåºæ¸è¿›ï¼Œé¿å…è¿‡åº¦å¤æ‚åŒ–
- ç›‘æ§å’Œæ—¥å¿—æ˜¯è¿ç»´çš„çœ¼ç›ï¼Œå¿…é¡»åšåˆ°å…¨è¦†ç›–

**æ ¸å¿ƒç†å¿µ**ï¼šç°ä»£ç¯å¢ƒç®¡ç†å’Œéƒ¨ç½²ç­–ç•¥çš„æ ¸å¿ƒæ˜¯é€šè¿‡è‡ªåŠ¨åŒ–ã€æ ‡å‡†åŒ–å’Œæ™ºèƒ½åŒ–æ‰‹æ®µï¼Œå®ç°é«˜æ•ˆã€å®‰å…¨ã€å¯é çš„è½¯ä»¶äº¤ä»˜ï¼Œè®©å¼€å‘å›¢é˜Ÿä¸“æ³¨äºä¸šåŠ¡ä»·å€¼åˆ›é€ ï¼Œè€Œä¸æ˜¯ç¹ççš„è¿ç»´å·¥ä½œï¼