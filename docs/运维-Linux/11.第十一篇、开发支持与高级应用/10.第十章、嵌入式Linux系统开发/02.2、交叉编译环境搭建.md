---
title: 2ã€äº¤å‰ç¼–è¯‘ç¯å¢ƒæ­å»º
---
## ğŸ“š ç›®å½•

1. [äº¤å‰ç¼–è¯‘æ¦‚å¿µä¸å¿…è¦æ€§](#1-äº¤å‰ç¼–è¯‘æ¦‚å¿µä¸å¿…è¦æ€§)
2. [å·¥å…·é“¾ç»„æˆè¯¦è§£](#2-å·¥å…·é“¾ç»„æˆè¯¦è§£)
3. [crosstool-ngå·¥å…·ä½¿ç”¨](#3-crosstool-ngå·¥å…·ä½¿ç”¨)
4. [é¢„ç¼–è¯‘å·¥å…·é“¾è·å–ä¸é…ç½®](#4-é¢„ç¼–è¯‘å·¥å…·é“¾è·å–ä¸é…ç½®)
5. [ç¼–è¯‘ç¯å¢ƒå˜é‡è®¾ç½®](#5-ç¼–è¯‘ç¯å¢ƒå˜é‡è®¾ç½®)
6. [ç›®æ ‡å¹³å°æ¶æ„é…ç½®](#6-ç›®æ ‡å¹³å°æ¶æ„é…ç½®)
7. [äº¤å‰ç¼–è¯‘éªŒè¯æµ‹è¯•](#7-äº¤å‰ç¼–è¯‘éªŒè¯æµ‹è¯•)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”„ äº¤å‰ç¼–è¯‘æ¦‚å¿µä¸å¿…è¦æ€§


### 1.1 ä»€ä¹ˆæ˜¯äº¤å‰ç¼–è¯‘


**ç®€å•ç†è§£**ï¼šäº¤å‰ç¼–è¯‘å°±æ˜¯åœ¨ä¸€å°æœºå™¨ä¸Šç¼–è¯‘å‡ºèƒ½åœ¨å¦ä¸€å°ä¸åŒæ¶æ„æœºå™¨ä¸Šè¿è¡Œçš„ç¨‹åºã€‚

```
å¼€å‘ç¯å¢ƒ â†’ ç¼–è¯‘ â†’ ç›®æ ‡ç¯å¢ƒè¿è¡Œ

PCæœº(x86_64)     ç¼–è¯‘     ARMå¼€å‘æ¿
    â†“           â€”â€”â†’        â†“
å†™ä»£ç /ç¼–è¯‘              è¿è¡Œç¨‹åº
```

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
- **å®¿ä¸»æœºï¼ˆHostï¼‰**ï¼šè¿›è¡Œç¼–è¯‘å·¥ä½œçš„æœºå™¨
- **ç›®æ ‡æœºï¼ˆTargetï¼‰**ï¼šæœ€ç»ˆè¿è¡Œç¨‹åºçš„æœºå™¨
- **æ¶æ„å·®å¼‚**ï¼šCPUæŒ‡ä»¤é›†ä¸åŒï¼ˆx86 vs ARMï¼‰

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦äº¤å‰ç¼–è¯‘


**ğŸ“± åµŒå…¥å¼è®¾å¤‡çš„é™åˆ¶**ï¼š
- **æ€§èƒ½æœ‰é™**ï¼šCPUæ€§èƒ½å¼±ï¼Œç¼–è¯‘é€Ÿåº¦ææ…¢
- **å­˜å‚¨ä¸è¶³**ï¼šæ— æ³•å®‰è£…å®Œæ•´çš„ç¼–è¯‘ç¯å¢ƒ
- **èµ„æºç¨€ç¼º**ï¼šå†…å­˜å°ï¼Œæ— æ³•è¿è¡Œå¤§å‹ç¼–è¯‘å™¨

**ğŸ’» å¼€å‘æ•ˆç‡è€ƒè™‘**ï¼š
```
æœ¬åœ°ç¼–è¯‘ï¼ˆåµŒå…¥å¼è®¾å¤‡ï¼‰ï¼š
hello.c â†’ ç¼–è¯‘5åˆ†é’Ÿ â†’ hello

äº¤å‰ç¼–è¯‘ï¼ˆPCå¼€å‘æœºï¼‰ï¼š
hello.c â†’ ç¼–è¯‘10ç§’ â†’ helloï¼ˆARMç‰ˆæœ¬ï¼‰
```

**ğŸ¯ å®é™…åº”ç”¨åœºæ™¯**ï¼š
- æ™ºèƒ½æ‰‹æœºAPPåº•å±‚å¼€å‘
- è·¯ç”±å™¨å›ºä»¶å¼€å‘
- å·¥ä¸šæ§åˆ¶è®¾å¤‡ç¨‹åº
- ç‰©è”ç½‘è®¾å¤‡è½¯ä»¶

### 1.3 äº¤å‰ç¼–è¯‘çš„å·¥ä½œåŸç†


**æ¶æ„è½¬æ¢è¿‡ç¨‹**ï¼š
```
æºä»£ç (C/C++)
      â†“
  äº¤å‰ç¼–è¯‘å™¨
      â†“
ç›®æ ‡æ¶æ„æœºå™¨ç (ARM/MIPSç­‰)
      â†“
  ä¼ è¾“åˆ°ç›®æ ‡è®¾å¤‡
      â†“
    ç›´æ¥è¿è¡Œ
```

**å…³é”®ç†è§£**ï¼š
- ç¼–è¯‘å™¨æœ¬èº«è¿è¡Œåœ¨x86ä¸Š
- ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶æ˜¯ARMæ ¼å¼
- æºç æ˜¯é€šç”¨çš„ï¼Œè¾“å‡ºæ˜¯æ¶æ„ç›¸å…³çš„

---

## 2. ğŸ”§ å·¥å…·é“¾ç»„æˆè¯¦è§£


### 2.1 äº¤å‰ç¼–è¯‘å·¥å…·é“¾æ¦‚è¿°


**å·¥å…·é“¾å®šä¹‰**ï¼šä¸€å¥—ååŒå·¥ä½œçš„ç¨‹åºå¼€å‘å·¥å…·é›†åˆï¼Œç”¨äºå°†æºä»£ç è½¬æ¢ä¸ºç›®æ ‡å¹³å°çš„å¯æ‰§è¡Œç¨‹åºã€‚

```
æºä»£ç  â†’ é¢„å¤„ç† â†’ ç¼–è¯‘ â†’ æ±‡ç¼– â†’ é“¾æ¥ â†’ å¯æ‰§è¡Œæ–‡ä»¶
  â†“        â†“       â†“      â†“      â†“        â†“
 .c      .i      .s     .o    .elf     æœ€ç»ˆç¨‹åº
```

### 2.2 æ ¸å¿ƒå·¥å…·è¯¦è§£


#### ğŸ”¨ GCCï¼ˆGNU Compiler Collectionï¼‰


**ä½œç”¨**ï¼šå°†C/C++æºä»£ç ç¼–è¯‘æˆç›®æ ‡æ¶æ„çš„æœºå™¨ç 

**å‘½åè§„å¾‹**ï¼š
```
arm-linux-gnueabihf-gcc
 â†“     â†“       â†“       â†“
æ¶æ„  æ“ä½œç³»ç»Ÿ  ABI   å·¥å…·å
```

**å¸¸è§å‰ç¼€ç¤ºä¾‹**ï¼š
- `arm-linux-gnueabihf-`ï¼šARMæ¶æ„ï¼Œç¡¬æµ®ç‚¹ABI
- `aarch64-linux-gnu-`ï¼šARM64æ¶æ„
- `mips-linux-gnu-`ï¼šMIPSæ¶æ„

#### ğŸ”— Binutilsï¼ˆBinary Utilitiesï¼‰


**æ ¸å¿ƒå·¥å…·åŒ…å«**ï¼š
- **ld**ï¼šé“¾æ¥å™¨ï¼Œå°†ç›®æ ‡æ–‡ä»¶é“¾æ¥æˆå¯æ‰§è¡Œæ–‡ä»¶
- **as**ï¼šæ±‡ç¼–å™¨ï¼Œå°†æ±‡ç¼–ä»£ç è½¬æ¢ä¸ºæœºå™¨ç 
- **objdump**ï¼šåæ±‡ç¼–å·¥å…·ï¼Œåˆ†æäºŒè¿›åˆ¶æ–‡ä»¶
- **strip**ï¼šå»é™¤è°ƒè¯•ä¿¡æ¯ï¼Œå‡å°ç¨‹åºä½“ç§¯

**å®é™…åº”ç”¨**ï¼š
```bash
# æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ä¿¡æ¯
arm-linux-gnueabihf-objdump -d hello

# å»é™¤è°ƒè¯•ä¿¡æ¯
arm-linux-gnueabihf-strip hello
```

#### ğŸ“š Cæ ‡å‡†åº“ï¼ˆglibc/uClibc/muslï¼‰


**ä½œç”¨**ï¼šæä¾›ç¨‹åºè¿è¡Œæ—¶éœ€è¦çš„åŸºç¡€å‡½æ•°åº“

**ä¸‰ç§ä¸»è¦é€‰æ‹©**ï¼š

| åº“åç§° | **ç‰¹ç‚¹** | **é€‚ç”¨åœºæ™¯** | **å¤§å°** |
|--------|---------|-------------|----------|
| **glibc** | `åŠŸèƒ½æœ€å®Œæ•´ï¼Œå…¼å®¹æ€§æœ€å¥½` | `æ¡Œé¢ç³»ç»Ÿã€æœåŠ¡å™¨` | `è¾ƒå¤§(2-3MB)` |
| **uClibc** | `ä¸“ä¸ºåµŒå…¥å¼è®¾è®¡ï¼Œä½“ç§¯å°` | `èµ„æºå—é™è®¾å¤‡` | `å¾ˆå°(å‡ ç™¾KB)` |
| **musl** | `ç°ä»£åŒ–ï¼Œå®‰å…¨æ€§å¥½` | `å®¹å™¨ã€é™æ€é“¾æ¥` | `ä¸­ç­‰(1MBå·¦å³)` |

### 2.3 å·¥å…·é“¾ç›®å½•ç»“æ„


**å…¸å‹å·¥å…·é“¾å¸ƒå±€**ï¼š
```
/opt/cross-tools/
â”œâ”€â”€ bin/                           â† äº¤å‰ç¼–è¯‘å·¥å…·
â”‚   â”œâ”€â”€ arm-linux-gnueabihf-gcc
â”‚   â”œâ”€â”€ arm-linux-gnueabihf-ld
â”‚   â””â”€â”€ arm-linux-gnueabihf-objdump
â”œâ”€â”€ arm-linux-gnueabihf/          â† ç›®æ ‡ç³»ç»Ÿæ–‡ä»¶
â”‚   â”œâ”€â”€ include/                   â† å¤´æ–‡ä»¶
â”‚   â”œâ”€â”€ lib/                       â† åº“æ–‡ä»¶
â”‚   â””â”€â”€ sys-root/                  â† æ ¹æ–‡ä»¶ç³»ç»Ÿ
â””â”€â”€ libexec/                       â† å†…éƒ¨å·¥å…·
```

---

## 3. âš™ï¸ crosstool-ngå·¥å…·ä½¿ç”¨


### 3.1 crosstool-ngç®€ä»‹


**å®šä¹‰**ï¼šcrosstool-ngæ˜¯ä¸€ä¸ªåˆ¶ä½œäº¤å‰ç¼–è¯‘å·¥å…·é“¾çš„è„šæœ¬å·¥å…·ï¼Œèƒ½å¤Ÿè‡ªåŠ¨ä¸‹è½½ã€é…ç½®ã€ç¼–è¯‘ç”Ÿæˆå®Œæ•´çš„å·¥å…·é“¾ã€‚

**ä¼˜åŠ¿ç‰¹ç‚¹**ï¼š
- ğŸ¯ **é…ç½®çµæ´»**ï¼šæ”¯æŒå¤šç§æ¶æ„å’Œåº“çš„ç»„åˆ
- ğŸš€ **è‡ªåŠ¨åŒ–ç¨‹åº¦é«˜**ï¼šä¸€é”®ç”Ÿæˆå®Œæ•´å·¥å…·é“¾
- ğŸ“¦ **ç‰ˆæœ¬ç®¡ç†**ï¼šå¯é€‰æ‹©ç‰¹å®šç‰ˆæœ¬çš„å·¥å…·ç»„ä»¶
- ğŸ”§ **å¯é‡ç°æ„å»º**ï¼šé…ç½®æ–‡ä»¶å¯ä¿å­˜å’Œåˆ†äº«

### 3.2 å®‰è£…crosstool-ng


**ç³»ç»Ÿè¦æ±‚å‡†å¤‡**ï¼š
```bash
# Ubuntu/Debianç³»ç»Ÿ
sudo apt-get install gcc g++ gperf bison flex texinfo help2man make \
    libncurses5-dev python-dev libtool-bin

# CentOS/RHELç³»ç»Ÿ  
sudo yum install gcc gcc-c++ gperf bison flex texinfo help2man make \
    ncurses-devel python-devel libtool
```

**ä¸‹è½½ä¸ç¼–è¯‘**ï¼š
```bash
# ä¸‹è½½æºç 
wget http://crosstool-ng.org/download/crosstool-ng/crosstool-ng-1.24.0.tar.xz
tar xf crosstool-ng-1.24.0.tar.xz
cd crosstool-ng-1.24.0

# é…ç½®å®‰è£…è·¯å¾„
./configure --prefix=/opt/crosstool-ng

# ç¼–è¯‘å®‰è£…
make && sudo make install

# æ·»åŠ åˆ°PATH
export PATH=/opt/crosstool-ng/bin:$PATH
```

### 3.3 ä½¿ç”¨crosstool-ngæ„å»ºå·¥å…·é“¾


**ğŸ”§ åŸºæœ¬æ„å»ºæµç¨‹**ï¼š

**æ­¥éª¤1ï¼šé€‰æ‹©é¢„è®¾é…ç½®**
```bash
# æŸ¥çœ‹å¯ç”¨çš„é¢„è®¾é…ç½®
ct-ng list-samples

# é€‰æ‹©ARM Cortex-A9é…ç½®
ct-ng arm-cortex_a9-linux-gnueabihf
```

**æ­¥éª¤2ï¼šè‡ªå®šä¹‰é…ç½®**
```bash
# è¿›å…¥å›¾å½¢åŒ–é…ç½®ç•Œé¢
ct-ng menuconfig
```

**é‡è¦é…ç½®é¡¹**ï¼š
```
Paths and misc options
â”œâ”€â”€ Working directory: ${HOME}/src          â† æ„å»ºä¸´æ—¶ç›®å½•
â”œâ”€â”€ Prefix directory: ${HOME}/x-tools       â† å·¥å…·é“¾å®‰è£…ç›®å½•
â””â”€â”€ Number of parallel jobs: 4              â† å¹¶è¡Œç¼–è¯‘æ•°

Target options  
â”œâ”€â”€ Target Architecture: arm                â† ç›®æ ‡æ¶æ„
â”œâ”€â”€ Endianness: Little endian               â† å­—èŠ‚åº
â””â”€â”€ Bitness: 32-bit                        â† ä½æ•°

Toolchain options
â”œâ”€â”€ Tuple's vendor string: unknown          â† ä¾›åº”å•†æ ‡è¯†
â””â”€â”€ Tuple's alias: arm-linux               â† å·¥å…·é“¾åˆ«å

C-library
â”œâ”€â”€ C library: glibc                       â† Cåº“é€‰æ‹©
â””â”€â”€ glibc version: 2.30                    â† åº“ç‰ˆæœ¬
```

**æ­¥éª¤3ï¼šå¼€å§‹æ„å»º**
```bash
# å¼€å§‹æ„å»ºï¼ˆéœ€è¦1-3å°æ—¶ï¼‰
ct-ng build

# æ„å»ºè¿‡ç¨‹ä¼šæ˜¾ç¤ºè¿›åº¦
[INFO ]  =================================================================
[INFO ]  Installing C library headers & start files
[INFO ]  Installing C library: 'glibc'
[INFO ]  =================================================================
```

### 3.4 æ„å»ºè¿‡ç¨‹è¯¦è§£


**ğŸ“Š æ„å»ºé˜¶æ®µè¯´æ˜**ï¼š

| é˜¶æ®µ | **è¯´æ˜** | **æ—¶é—´å æ¯”** | **ä¸»è¦å·¥ä½œ** |
|------|---------|-------------|-------------|
| **å‡†å¤‡é˜¶æ®µ** | `ä¸‹è½½æºç åŒ…` | `10%` | `ä¸‹è½½gccã€glibcç­‰æºç ` |
| **binutils** | `æ„å»ºåŸºç¡€å·¥å…·` | `15%` | `ç¼–è¯‘asã€ldç­‰å·¥å…·` |
| **gcc-stage1** | `æ„å»ºåˆå§‹ç¼–è¯‘å™¨` | `25%` | `ç¼–è¯‘åŸºç¡€gcc` |
| **libc-headers** | `å®‰è£…Cåº“å¤´æ–‡ä»¶` | `5%` | `å®‰è£…ç³»ç»Ÿè°ƒç”¨æ¥å£` |
| **gcc-stage2** | `æ„å»ºå®Œæ•´ç¼–è¯‘å™¨` | `35%` | `ç¼–è¯‘å®Œæ•´åŠŸèƒ½gcc` |
| **libc** | `æ„å»ºCæ ‡å‡†åº“` | `10%` | `ç¼–è¯‘glibc/uClibc` |

**å¸¸è§é—®é¢˜å¤„ç†**ï¼š
```bash
# å¦‚æœæ„å»ºå¤±è´¥ï¼Œæ¸…ç†åé‡è¯•
ct-ng clean

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
tail -f build.log

# æ¢å¤ä¹‹å‰çš„é…ç½®
ct-ng oldconfig
```

---

## 4. ğŸ“¦ é¢„ç¼–è¯‘å·¥å…·é“¾è·å–ä¸é…ç½®


### 4.1 è·å–é¢„ç¼–è¯‘å·¥å…·é“¾


**ä¸ºä»€ä¹ˆä½¿ç”¨é¢„ç¼–è¯‘å·¥å…·é“¾**ï¼š
- âš¡ **èŠ‚çœæ—¶é—´**ï¼šæ— éœ€å‡ å°æ—¶çš„ç¼–è¯‘è¿‡ç¨‹
- ğŸ¯ **ç¨³å®šå¯é **ï¼šç»è¿‡æµ‹è¯•éªŒè¯çš„ç‰ˆæœ¬
- ğŸ“¦ **å¼€ç®±å³ç”¨**ï¼šä¸‹è½½è§£å‹å³å¯ä½¿ç”¨

### 4.2 ä¸»è¦è·å–æ¸ é“


**ğŸ¢ å®˜æ–¹æ¸ é“**ï¼š

**ARMå®˜æ–¹å·¥å…·é“¾**ï¼š
```bash
# ä¸‹è½½ARMå®˜æ–¹GCCå·¥å…·é“¾
wget https://developer.arm.com/-/media/Files/downloads/gnu-a/10.3-2021.07/binrel/\
gcc-arm-10.3-2021.07-x86_64-arm-none-linux-gnueabihf.tar.xz

# è§£å‹åˆ°æŒ‡å®šç›®å½•
sudo tar xf gcc-arm-10.3-2021.07-x86_64-arm-none-linux-gnueabihf.tar.xz \
    -C /opt/
```

**Linaroå·¥å…·é“¾**ï¼š
```bash
# Linaroæä¾›çš„ä¼˜åŒ–ç‰ˆæœ¬
wget https://releases.linaro.org/components/toolchain/binaries/latest-7/\
arm-linux-gnueabihf/gcc-linaro-7.5.0-2019.12-x86_64_arm-linux-gnueabihf.tar.xz
```

**ğŸ§ Linuxå‘è¡Œç‰ˆåŒ…ç®¡ç†å™¨**ï¼š

**Ubuntu/Debian**ï¼š
```bash
# é€šè¿‡aptå®‰è£…
sudo apt-get install gcc-arm-linux-gnueabihf

# å®‰è£…å¤šæ¶æ„æ”¯æŒ
sudo apt-get install gcc-aarch64-linux-gnu
sudo apt-get install gcc-mips-linux-gnu
```

**CentOS/RHEL**ï¼š
```bash
# é€šè¿‡yumå®‰è£…
sudo yum install gcc-arm-linux-gnu
```

### 4.3 å·¥å…·é“¾éªŒè¯ä¸æµ‹è¯•


**ğŸ” éªŒè¯å·¥å…·é“¾å®Œæ•´æ€§**ï¼š
```bash
# æ£€æŸ¥å·¥å…·é“¾ç‰ˆæœ¬
arm-linux-gnueabihf-gcc --version

# æŸ¥çœ‹æ”¯æŒçš„æ¶æ„
arm-linux-gnueabihf-gcc -march=help

# æµ‹è¯•ç¼–è¯‘åŠŸèƒ½
echo 'int main(){return 0;}' | arm-linux-gnueabihf-gcc -x c - -o test
```

**ğŸ“‹ éªŒè¯è¾“å‡ºç¤ºä¾‹**ï¼š
```
arm-linux-gnueabihf-gcc (GNU) 10.3.1 20210621
Copyright (C) 2020 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.
```

---

## 5. ğŸŒ ç¼–è¯‘ç¯å¢ƒå˜é‡è®¾ç½®


### 5.1 ç¯å¢ƒå˜é‡çš„ä½œç”¨


**æ ¸å¿ƒç†è§£**ï¼šç¯å¢ƒå˜é‡å‘Šè¯‰ç³»ç»Ÿåœ¨å“ªé‡Œæ‰¾åˆ°äº¤å‰ç¼–è¯‘å·¥å…·ï¼Œä»¥åŠå¦‚ä½•è¿›è¡Œç¼–è¯‘é…ç½®ã€‚

**å…³é”®å˜é‡è¯´æ˜**ï¼š
- **PATH**ï¼šå·¥å…·é“¾å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„
- **CROSS_COMPILE**ï¼šäº¤å‰ç¼–è¯‘å‰ç¼€
- **ARCH**ï¼šç›®æ ‡æ¶æ„æ ‡è¯†
- **CC/CXX**ï¼šæŒ‡å®šç¼–è¯‘å™¨

### 5.2 åŸºæœ¬ç¯å¢ƒå˜é‡é…ç½®


**ğŸ“ é…ç½®è„šæœ¬ç¤ºä¾‹**ï¼š
```bash
#!/bin/bash
# setup-cross-env.sh - äº¤å‰ç¼–è¯‘ç¯å¢ƒé…ç½®è„šæœ¬

# è®¾ç½®å·¥å…·é“¾å®‰è£…è·¯å¾„
TOOLCHAIN_PATH="/opt/gcc-arm-10.3-2021.07-x86_64-arm-none-linux-gnueabihf"

# æ·»åŠ å·¥å…·é“¾åˆ°PATH
export PATH=$TOOLCHAIN_PATH/bin:$PATH

# è®¾ç½®äº¤å‰ç¼–è¯‘å‰ç¼€
export CROSS_COMPILE=arm-none-linux-gnueabihf-

# è®¾ç½®ç›®æ ‡æ¶æ„
export ARCH=arm

# è®¾ç½®ç¼–è¯‘å™¨å˜é‡
export CC=${CROSS_COMPILE}gcc
export CXX=${CROSS_COMPILE}g++
export AR=${CROSS_COMPILE}ar
export STRIP=${CROSS_COMPILE}strip

# æ˜¾ç¤ºé…ç½®ä¿¡æ¯
echo "äº¤å‰ç¼–è¯‘ç¯å¢ƒå·²é…ç½®ï¼š"
echo "CROSS_COMPILE: $CROSS_COMPILE"
echo "ARCH: $ARCH"
echo "CC: $CC"
```

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
# åŠ è½½ç¯å¢ƒé…ç½®
source setup-cross-env.sh

# æˆ–è€…ç›´æ¥åœ¨å½“å‰shellä¸­è®¾ç½®
export PATH=/opt/toolchain/bin:$PATH
export CROSS_COMPILE=arm-linux-gnueabihf-
```

### 5.3 é«˜çº§ç¯å¢ƒé…ç½®


**ğŸ”§ é’ˆå¯¹ç‰¹å®šé¡¹ç›®çš„é…ç½®**ï¼š
```bash
# ä¸ºLinuxå†…æ ¸ç¼–è¯‘è®¾ç½®
export ARCH=arm
export CROSS_COMPILE=arm-linux-gnueabihf-

# ä¸ºç”¨æˆ·ç©ºé—´ç¨‹åºè®¾ç½®
export CC=arm-linux-gnueabihf-gcc
export CXX=arm-linux-gnueabihf-g++
export PKG_CONFIG_PATH=/opt/arm-rootfs/lib/pkgconfig

# è®¾ç½®ç³»ç»Ÿæ ¹ç›®å½•ï¼ˆé¿å…é“¾æ¥åˆ°å®¿ä¸»æœºåº“ï¼‰
export SYSROOT=/opt/arm-rootfs
export CFLAGS="--sysroot=$SYSROOT"
export LDFLAGS="--sysroot=$SYSROOT"
```

**ğŸ“‹ ç¯å¢ƒé…ç½®éªŒè¯**ï¼š
```bash
# éªŒè¯ç¯å¢ƒå˜é‡
env | grep -E "(CROSS_COMPILE|ARCH|CC)"

# æµ‹è¯•ç¼–è¯‘å™¨è·¯å¾„
which ${CROSS_COMPILE}gcc

# éªŒè¯ç¼–è¯‘åŠŸèƒ½
${CC} --version
```

### 5.4 æŒä¹…åŒ–é…ç½®


**ğŸ”„ æ°¸ä¹…æ€§ç¯å¢ƒé…ç½®**ï¼š

**æ–¹æ³•1ï¼šä¿®æ”¹ç”¨æˆ·é…ç½®æ–‡ä»¶**
```bash
# ç¼–è¾‘.bashrcæ–‡ä»¶
vim ~/.bashrc

# æ·»åŠ ä»¥ä¸‹å†…å®¹
export PATH=/opt/cross-tools/bin:$PATH
export CROSS_COMPILE=arm-linux-gnueabihf-
export ARCH=arm

# é‡æ–°åŠ è½½é…ç½®
source ~/.bashrc
```

**æ–¹æ³•2ï¼šåˆ›å»ºä¸“ç”¨é…ç½®æ–‡ä»¶**
```bash
# åˆ›å»ºäº¤å‰ç¼–è¯‘é…ç½®æ–‡ä»¶
sudo vim /etc/profile.d/cross-compile.sh

# æ–‡ä»¶å†…å®¹
#!/bin/bash
export PATH=/opt/cross-tools/bin:$PATH
export CROSS_COMPILE=arm-linux-gnueabihf-
export ARCH=arm

# è®¾ç½®å¯æ‰§è¡Œæƒé™
sudo chmod +x /etc/profile.d/cross-compile.sh
```

---

## 6. ğŸ¯ ç›®æ ‡å¹³å°æ¶æ„é…ç½®


### 6.1 æ¶æ„é€‰æ‹©åŸºç¡€


**å¸¸è§åµŒå…¥å¼æ¶æ„å¯¹æ¯”**ï¼š

| æ¶æ„ | **ç‰¹ç‚¹** | **åº”ç”¨åœºæ™¯** | **ä»£è¡¨äº§å“** |
|------|---------|-------------|-------------|
| **ARM Cortex-A** | `é«˜æ€§èƒ½ï¼ŒåŠŸè€—å¹³è¡¡` | `æ™ºèƒ½æ‰‹æœºï¼Œå¹³æ¿` | `æ ‘è“æ´¾ï¼Œæ‰‹æœºå¤„ç†å™¨` |
| **ARM Cortex-M** | `è¶…ä½åŠŸè€—ï¼Œå®æ—¶æ€§` | `ç‰©è”ç½‘ï¼Œä¼ æ„Ÿå™¨` | `Arduinoï¼Œæ™ºèƒ½æ‰‹è¡¨` |
| **MIPS** | `ç®€æ´æŒ‡ä»¤é›†` | `è·¯ç”±å™¨ï¼Œç½‘ç»œè®¾å¤‡` | `OpenWRTè·¯ç”±å™¨` |
| **x86** | `å¼ºå¤§æ€§èƒ½` | `å·¥ä¸šPCï¼Œè¾¹ç¼˜è®¡ç®—` | `Intel Edison` |

### 6.2 ARMæ¶æ„è¯¦ç»†é…ç½®


**ğŸ”§ ARM Cortex-Aç³»åˆ—é…ç½®**ï¼š

**CPUæ ¸å¿ƒé€‰æ‹©**ï¼š
```bash
# é’ˆå¯¹Cortex-A9
export CFLAGS="-march=armv7-a -mtune=cortex-a9 -mfpu=neon -mfloat-abi=hard"

# é’ˆå¯¹Cortex-A53ï¼ˆ64ä½ï¼‰
export CFLAGS="-march=armv8-a -mtune=cortex-a53"

# é’ˆå¯¹Cortex-A72
export CFLAGS="-march=armv8-a -mtune=cortex-a72 -mcpu=cortex-a72"
```

**æµ®ç‚¹å¤„ç†é…ç½®**ï¼š
```
è½¯æµ®ç‚¹(soft)ï¼š    çº¯è½¯ä»¶å®ç°ï¼Œå…¼å®¹æ€§æœ€å¥½ï¼Œæ€§èƒ½æœ€ä½
ç¡¬æµ®ç‚¹(hard)ï¼š    ä½¿ç”¨ç¡¬ä»¶FPUï¼Œæ€§èƒ½æœ€é«˜ï¼Œéœ€è¦ç¡¬ä»¶æ”¯æŒ  
æ··åˆæµ®ç‚¹(softfp)ï¼šè°ƒç”¨çº¦å®šå…¼å®¹è½¯æµ®ç‚¹ï¼Œè®¡ç®—ä½¿ç”¨ç¡¬ä»¶
```

**ABIé€‰æ‹©æŒ‡å—**ï¼š
```bash
# EABI - åµŒå…¥å¼åº”ç”¨äºŒè¿›åˆ¶æ¥å£ï¼ˆæ—§ç‰ˆæœ¬ï¼‰
arm-linux-gnueabi-gcc

# EABIHF - ç¡¬æµ®ç‚¹ç‰ˆæœ¬ï¼ˆæ¨èï¼‰
arm-linux-gnueabihf-gcc

# OABI - æ—§ç‰ˆæœ¬ABIï¼ˆå·²åºŸå¼ƒï¼‰
arm-linux-gcc
```

### 6.3 å…·ä½“å¹³å°é…ç½®ç¤ºä¾‹


**ğŸ“± æ ‘è“æ´¾é…ç½®**ï¼š
```bash
# æ ‘è“æ´¾3B+é…ç½®
export ARCH=arm
export CROSS_COMPILE=arm-linux-gnueabihf-
export CFLAGS="-march=armv8-a -mtune=cortex-a53 -mfpu=crypto-neon-fp-armv8 -mfloat-abi=hard"
export KERNEL_DEFCONFIG=bcm2709_defconfig
```

**ğŸ”Œ é€šç”¨å¼€å‘æ¿é…ç½®**ï¼š
```bash
# IMX6å¼€å‘æ¿
export CFLAGS="-march=armv7-a -mtune=cortex-a9 -mfpu=neon -mfloat-abi=hard"

# å…¨å¿—H3èŠ¯ç‰‡
export CFLAGS="-march=armv7-a -mtune=cortex-a7 -mfpu=neon-vfpv4 -mfloat-abi=hard"
```

### 6.4 ç¼–è¯‘ä¼˜åŒ–é…ç½®


**ğŸš€ æ€§èƒ½ä¼˜åŒ–å‚æ•°**ï¼š
```bash
# åŸºç¡€ä¼˜åŒ–
export CFLAGS="-O2 -pipe"

# é«˜çº§ä¼˜åŒ–ï¼ˆæ³¨æ„ï¼šå¯èƒ½å½±å“è°ƒè¯•ï¼‰
export CFLAGS="-O3 -march=armv7-a -mtune=cortex-a9 -mfpu=neon -ffast-math"

# ä½“ç§¯ä¼˜åŒ–
export CFLAGS="-Os -ffunction-sections -fdata-sections"
export LDFLAGS="-Wl,--gc-sections"
```

**âš ï¸ ä¼˜åŒ–æ³¨æ„äº‹é¡¹**ï¼š
- **-O3**ï¼šæœ€é«˜ä¼˜åŒ–ï¼Œå¯èƒ½å¢åŠ ä»£ç ä½“ç§¯
- **-Os**ï¼šä½“ç§¯ä¼˜åŒ–ï¼Œé€‚åˆå­˜å‚¨å—é™è®¾å¤‡
- **-ffast-math**ï¼šå¿«é€Ÿæ•°å­¦è¿ç®—ï¼Œå¯èƒ½å½±å“ç²¾åº¦

---

## 7. âœ… äº¤å‰ç¼–è¯‘éªŒè¯æµ‹è¯•


### 7.1 åŸºç¡€ç¼–è¯‘æµ‹è¯•


**ğŸ”¨ ç®€å•ç¨‹åºæµ‹è¯•**ï¼š

**åˆ›å»ºæµ‹è¯•ç¨‹åº**ï¼š
```c
// hello.c - åŸºç¡€æµ‹è¯•ç¨‹åº
#include <stdio.h>
#include <unistd.h>
#include <sys/utsname.h>

int main() {
    struct utsname info;
    
    printf("Hello from Cross Compilation!\n");
    printf("PID: %d\n", getpid());
    
    if (uname(&info) == 0) {
        printf("System: %s\n", info.sysname);
        printf("Machine: %s\n", info.machine);
    }
    
    return 0;
}
```

**ç¼–è¯‘æµ‹è¯•**ï¼š
```bash
# ä½¿ç”¨äº¤å‰ç¼–è¯‘å™¨ç¼–è¯‘
arm-linux-gnueabihf-gcc -o hello hello.c

# æ£€æŸ¥ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶
file hello
# è¾“å‡ºï¼šhello: ELF 32-bit LSB executable, ARM, EABI5 version 1 (SYSV)
```

### 7.2 åº“ä¾èµ–æ£€æŸ¥


**ğŸ” æ£€æŸ¥åŠ¨æ€åº“ä¾èµ–**ï¼š
```bash
# æŸ¥çœ‹ç¨‹åºä¾èµ–çš„åŠ¨æ€åº“
arm-linux-gnueabihf-objdump -p hello | grep NEEDED

# æˆ–ä½¿ç”¨readelf
arm-linux-gnueabihf-readelf -d hello | grep NEEDED
```

**å…¸å‹è¾“å‡º**ï¼š
```
NEEDED               libc.so.6
NEEDED               ld-linux-armhf.so.3
```

**é™æ€ç¼–è¯‘æµ‹è¯•**ï¼š
```bash
# ç¼–è¯‘é™æ€ç‰ˆæœ¬ï¼ˆä¸ä¾èµ–åŠ¨æ€åº“ï¼‰
arm-linux-gnueabihf-gcc -static -o hello_static hello.c

# éªŒè¯æ— åŠ¨æ€åº“ä¾èµ–
arm-linux-gnueabihf-objdump -p hello_static | grep NEEDED
# åº”è¯¥æ²¡æœ‰è¾“å‡º
```

### 7.3 ç›®æ ‡è®¾å¤‡è¿è¡Œæµ‹è¯•


**ğŸ“¤ ç¨‹åºä¼ è¾“ä¸è¿è¡Œ**ï¼š

**é€šè¿‡SCPä¼ è¾“**ï¼š
```bash
# ä¼ è¾“åˆ°ç›®æ ‡è®¾å¤‡
scp hello root@192.168.1.100:/tmp/

# SSHç™»å½•ç›®æ ‡è®¾å¤‡
ssh root@192.168.1.100

# åœ¨ç›®æ ‡è®¾å¤‡ä¸Šè¿è¡Œ
cd /tmp
chmod +x hello
./hello
```

**é€šè¿‡NFSå…±äº«**ï¼š
```bash
# åœ¨å¼€å‘æœºä¸Šè®¾ç½®NFSå…±äº«
sudo apt-get install nfs-kernel-server
echo "/home/user/nfs_share *(rw,sync,no_root_squash)" >> /etc/exports
sudo exportfs -a

# ç›®æ ‡è®¾å¤‡æŒ‚è½½NFS
mount -t nfs 192.168.1.10:/home/user/nfs_share /mnt
/mnt/hello
```

### 7.4 æ€§èƒ½ä¸å…¼å®¹æ€§æµ‹è¯•


**âš¡ åŸºå‡†æµ‹è¯•ç¨‹åº**ï¼š
```c
// benchmark.c - æ€§èƒ½æµ‹è¯•
#include <stdio.h>
#include <time.h>
#include <math.h>

void cpu_test() {
    clock_t start = clock();
    volatile double result = 0;
    
    for (int i = 0; i < 1000000; i++) {
        result += sin(i) * cos(i);
    }
    
    clock_t end = clock();
    double cpu_time = ((double)(end - start)) / CLOCKS_PER_SEC;
    printf("CPUæµ‹è¯•ç”¨æ—¶: %f ç§’\n", cpu_time);
}

int main() {
    printf("å¼€å§‹æ€§èƒ½æµ‹è¯•...\n");
    cpu_test();
    printf("æµ‹è¯•å®Œæˆ\n");
    return 0;
}
```

**ç¼–è¯‘å¹¶æµ‹è¯•**ï¼š
```bash
# ç¼–è¯‘ä¼˜åŒ–ç‰ˆæœ¬
arm-linux-gnueabihf-gcc -O2 -o benchmark benchmark.c -lm

# ä¼ è¾“åˆ°ç›®æ ‡è®¾å¤‡è¿è¡Œ
scp benchmark root@target:/tmp/
```

### 7.5 é—®é¢˜æ’æŸ¥ä¸è°ƒè¯•


**ğŸ”§ å¸¸è§é—®é¢˜è§£å†³**ï¼š

**é—®é¢˜1ï¼šæ‰¾ä¸åˆ°åŠ¨æ€åº“**
```bash
# é”™è¯¯ä¿¡æ¯
./hello: error while loading shared libraries: libc.so.6: cannot open shared object file

# è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥ç›®æ ‡è®¾å¤‡çš„åº“è·¯å¾„
export LD_LIBRARY_PATH=/lib:/usr/lib
```

**é—®é¢˜2ï¼šæŒ‡ä»¤é›†ä¸å…¼å®¹**
```bash
# é”™è¯¯ä¿¡æ¯  
Illegal instruction

# è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥ç¼–è¯‘å‚æ•°æ˜¯å¦åŒ¹é…ç›®æ ‡CPU
arm-linux-gnueabihf-gcc -march=armv7-a  # è€Œä¸æ˜¯armv8-a
```

**é—®é¢˜3ï¼šæµ®ç‚¹å¤„ç†é”™è¯¯**
```bash
# æ£€æŸ¥æµ®ç‚¹ABI
arm-linux-gnueabihf-readelf -A hello | grep "FP arch"

# ç¡®ä¿ä¸ç›®æ ‡è®¾å¤‡ä¸€è‡´
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ äº¤å‰ç¼–è¯‘æœ¬è´¨ï¼šåœ¨ä¸€ç§æ¶æ„ä¸Šç¼–è¯‘å‡ºå¦ä¸€ç§æ¶æ„çš„ç¨‹åº
ğŸ”¸ å·¥å…·é“¾ç»„æˆï¼šgccç¼–è¯‘å™¨ + binutilså·¥å…·é›† + Cæ ‡å‡†åº“
ğŸ”¸ ç¯å¢ƒé…ç½®ï¼šPATHè·¯å¾„ + CROSS_COMPILEå‰ç¼€ + æ¶æ„å˜é‡
ğŸ”¸ æ¶æ„åŒ¹é…ï¼šç¼–è¯‘å‚æ•°å¿…é¡»ä¸ç›®æ ‡ç¡¬ä»¶å®Œå…¨åŒ¹é…
ğŸ”¸ éªŒè¯æµ‹è¯•ï¼šç¼–è¯‘ã€ä¼ è¾“ã€è¿è¡Œä¸‰æ­¥éªŒè¯
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ å·¥å…·é“¾é€‰æ‹©ç­–ç•¥**
```
è‡ªåˆ¶ vs é¢„ç¼–è¯‘ï¼š
â€¢ å­¦ä¹ ç›®çš„ï¼šä½¿ç”¨crosstool-ngè‡ªåˆ¶ï¼Œç†è§£åŸç†
â€¢ é¡¹ç›®å¼€å‘ï¼šä½¿ç”¨å®˜æ–¹é¢„ç¼–è¯‘ç‰ˆæœ¬ï¼ŒèŠ‚çœæ—¶é—´
â€¢ ç‰¹æ®Šéœ€æ±‚ï¼šæ ¹æ®å…·ä½“è¦æ±‚å®šåˆ¶å·¥å…·é“¾

åº“çš„é€‰æ‹©ï¼š
â€¢ glibcï¼šåŠŸèƒ½å®Œæ•´ï¼Œé€‚åˆæ€§èƒ½è¦æ±‚é«˜çš„åœºæ™¯
â€¢ uClibcï¼šä½“ç§¯å°ï¼Œé€‚åˆèµ„æºå—é™è®¾å¤‡
â€¢ muslï¼šç°ä»£åŒ–ï¼Œé€‚åˆå®¹å™¨å’Œé™æ€é“¾æ¥
```

**ğŸ”¹ ç¯å¢ƒé…ç½®æœ€ä½³å®è·µ**
```
ç¯å¢ƒéš”ç¦»ï¼š
â€¢ ä¸åŒé¡¹ç›®ä½¿ç”¨ç‹¬ç«‹çš„ç¯å¢ƒé…ç½®è„šæœ¬
â€¢ é¿å…å…¨å±€ç¯å¢ƒå˜é‡å½±å“å…¶ä»–é¡¹ç›®

è·¯å¾„ç®¡ç†ï¼š
â€¢ ä½¿ç”¨ç»å¯¹è·¯å¾„é¿å…ç¯å¢ƒä¾èµ–
â€¢ å®šæœŸéªŒè¯å·¥å…·é“¾å¯ç”¨æ€§

ç‰ˆæœ¬æ§åˆ¶ï¼š
â€¢ è®°å½•ä½¿ç”¨çš„å·¥å…·é“¾ç‰ˆæœ¬
â€¢ ä¿æŒå›¢é˜Ÿå¼€å‘ç¯å¢ƒä¸€è‡´
```

**ğŸ”¹ å¸¸è§é—®é¢˜é¢„é˜²**
```
æ¶æ„åŒ¹é…ï¼š
â€¢ è¯¦ç»†äº†è§£ç›®æ ‡ç¡¬ä»¶çš„CPUå‹å·å’Œç‰¹æ€§
â€¢ ä½¿ç”¨æ­£ç¡®çš„marchå’Œmtuneå‚æ•°
â€¢ æ³¨æ„æµ®ç‚¹å¤„ç†æ–¹å¼çš„é€‰æ‹©

åº“ä¾èµ–ï¼š
â€¢ ä¼˜å…ˆä½¿ç”¨é™æ€ç¼–è¯‘å‡å°‘ä¾èµ–
â€¢ ç¡®ä¿ç›®æ ‡è®¾å¤‡æœ‰å¿…è¦çš„åŠ¨æ€åº“
â€¢ ä½¿ç”¨SYSROOTé¿å…é“¾æ¥é”™è¯¯

è°ƒè¯•æ”¯æŒï¼š
â€¢ ç¼–è¯‘æ—¶ä¿ç•™è°ƒè¯•ä¿¡æ¯
â€¢ å‡†å¤‡å¯¹åº”çš„è°ƒè¯•å·¥å…·ï¼ˆgdbç­‰ï¼‰
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ“š å­¦ä¹ è·¯å¾„å»ºè®®**ï¼š
1. **åŸºç¡€ç†è§£**ï¼šå…ˆç†è§£äº¤å‰ç¼–è¯‘çš„å¿…è¦æ€§å’ŒåŸç†
2. **å·¥å…·ä½¿ç”¨**ï¼šä»é¢„ç¼–è¯‘å·¥å…·é“¾å¼€å§‹ï¼Œå¿«é€Ÿä¸Šæ‰‹
3. **æ·±å…¥å®šåˆ¶**ï¼šå­¦ä¹ crosstool-ngï¼Œç†è§£å·¥å…·é“¾æ„å»º
4. **é¡¹ç›®å®è·µ**ï¼šåœ¨çœŸå®é¡¹ç›®ä¸­åº”ç”¨å’Œä¼˜åŒ–

**ğŸš€ å¼€å‘æ•ˆç‡æå‡**ï¼š
- å»ºç«‹æ ‡å‡†åŒ–çš„å¼€å‘ç¯å¢ƒé…ç½®
- ç¼–å†™è‡ªåŠ¨åŒ–è„šæœ¬ç®€åŒ–é‡å¤æ“ä½œ
- ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ç®¡ç†é…ç½®æ–‡ä»¶
- å»ºç«‹æµ‹è¯•éªŒè¯æµç¨‹

**æ ¸å¿ƒè®°å¿†**ï¼š
- äº¤å‰ç¼–è¯‘æ˜¯åµŒå…¥å¼å¼€å‘çš„åŸºç¡€æŠ€èƒ½
- å·¥å…·é“¾é€‰æ‹©å½±å“å¼€å‘æ•ˆç‡å’Œäº§å“æ€§èƒ½
- ç¯å¢ƒé…ç½®éœ€è¦ç»†è‡´å‡†ç¡®ï¼Œæ¶æ„åŒ¹é…è‡³å…³é‡è¦
- éªŒè¯æµ‹è¯•æ˜¯ç¡®ä¿å·¥å…·é“¾æ­£ç¡®æ€§çš„å…³é”®æ­¥éª¤