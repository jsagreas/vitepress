---
title: 12、网络与通信配置
---
## 📚 目录

1. [嵌入式网络通信基础概念](#1-嵌入式网络通信基础概念)
2. [以太网接口配置](#2-以太网接口配置)
3. [WiFi模块集成与配置](#3-WiFi模块集成与配置)
4. [蓝牙协议栈配置](#4-蓝牙协议栈配置)
5. [CAN总线支持配置](#5-CAN总线支持配置)
6. [串口通信配置](#6-串口通信配置)
7. [USB设备支持](#7-USB设备支持)
8. [网络协议栈裁剪](#8-网络协议栈裁剪)
9. [核心要点总结](#9-核心要点总结)

---

## 1. 🌐 嵌入式网络通信基础概念


### 1.1 什么是嵌入式网络通信


**🔸 核心概念**
```
嵌入式网络通信：在资源受限的嵌入式设备上实现网络连接和数据传输
目标：让小设备也能联网，实现物联网功能
特点：功耗低、体积小、成本低、可靠性高
```

**💡 通俗理解**
> 就像给一个小型电子设备安装"网线接口"，让它能上网、能和其他设备聊天。比如智能插座能用手机控制，就是因为它有网络通信能力。

### 1.2 嵌入式网络 vs 普通电脑网络


**📊 主要区别对比**

| 特性 | **普通电脑** | **嵌入式设备** | **影响** |
|------|-------------|---------------|---------|
| 🔌 **网络接口** | `多种选择，标准接口` | `精简接口，定制化` | `需要专门驱动` |
| 💾 **内存资源** | `GB级别，充足` | `MB甚至KB级别` | `协议栈要裁剪` |
| ⚡ **功耗要求** | `不太在意` | `电池供电，极低功耗` | `需要休眠唤醒机制` |
| 🎯 **应用场景** | `通用计算` | `专用功能` | `只需要特定协议` |

### 1.3 嵌入式网络通信架构


**🏗️ 系统架构图示**
```
应用层     │ 用户程序（传感器数据采集、控制逻辑）
          ├─────────────────────────────────
协议层     │ TCP/IP、UDP、HTTP、MQTT等
          ├─────────────────────────────────  
驱动层     │ 网卡驱动、WiFi驱动、蓝牙驱动
          ├─────────────────────────────────
硬件层     │ 以太网芯片、WiFi芯片、蓝牙模块
```

**🔑 核心理解要点**
- **硬件接口**：物理连接，比如网线插口、WiFi天线
- **驱动程序**：让Linux系统认识硬件，就像安装硬件的"翻译官"  
- **协议栈**：规定数据怎么打包发送，就像快递的包装规则
- **应用程序**：实际使用网络的软件，比如网页浏览器

---

## 2. 🔌 以太网接口配置


### 2.1 以太网基础概念


**🔸 什么是以太网**
```
以太网：最常见的有线网络连接方式
物理表现：RJ45网线接口（就是家里路由器上的网线插口）
优势：稳定可靠、速度快、抗干扰强
适用场景：工业控制、固定设备联网
```

**💡 生活类比**
> 以太网就像家里的有线电话，插上线就能用，信号稳定不掉线。WiFi则像手机，方便但信号可能不稳定。

### 2.2 以太网硬件配置


**⚙️ 硬件组成**
```
PHY芯片：物理层芯片，负责电信号处理
MAC控制器：媒体访问控制，通常集成在主控芯片内
RJ45接口：物理连接器
变压器：信号隔离和阻抗匹配
```

**🔧 设备树配置示例**
```dts
&fec1 {
    pinctrl-names = "default";
    pinctrl-0 = <&pinctrl_fec1>;
    phy-mode = "rmii";
    phy-handle = <&ethphy0>;
    status = "okay";
    
    mdio {
        #address-cells = <1>;
        #size-cells = <0>;
        
        ethphy0: ethernet-phy@0 {
            reg = <0>;
            clocks = <&clks IMX6UL_CLK_ENET_REF>;
            clock-names = "rmii-ref";
        };
    };
};
```

**📝 配置说明**
- **phy-mode**: `rmii` 表示使用简化的媒体独立接口，功耗更低
- **phy-handle**: 指向具体的PHY芯片
- **mdio**: 管理数据输入输出接口，用于配置PHY芯片

### 2.3 以太网驱动配置


**🔸 内核配置选项**
```
CONFIG_NET=y                    # 网络支持
CONFIG_ETHERNET=y               # 以太网支持  
CONFIG_FEC=y                    # Freescale以太网控制器
CONFIG_PHYLIB=y                 # PHY库支持
CONFIG_MICREL_PHY=y             # Micrel PHY驱动
```

**🚀 网络接口启动流程**
```
1. 内核加载以太网驱动
2. 检测PHY芯片，建立连接
3. 创建网络接口(eth0)
4. 配置IP地址和路由
5. 启动网络服务
```

### 2.4 以太网接口管理


**💻 常用命令操作**
```bash
# 查看网络接口状态
ip link show

# 启用网络接口
ip link set eth0 up

# 配置静态IP
ip addr add 192.168.1.100/24 dev eth0
ip route add default via 192.168.1.1

# 使用DHCP自动获取IP
dhclient eth0
```

**⚠️ 常见问题排查**
```
问题1：网络接口不存在
解决：检查驱动是否正确加载 → dmesg | grep eth

问题2：无法获取IP地址  
解决：检查网线连接 → ethtool eth0

问题3：网络不通
解决：检查路由配置 → ip route show
```

---

## 3. 📶 WiFi模块集成与配置


### 3.1 WiFi基础知识


**🔸 WiFi工作原理**
```
WiFi：无线保真，使用无线电波进行数据传输
工作频段：2.4GHz（传输距离远）/ 5GHz（传输速度快）
安全协议：WEP → WPA → WPA2 → WPA3（越来越安全）
```

**🏠 生活场景理解**
> WiFi就像无线对讲机，不需要线缆连接，但需要在信号覆盖范围内。距离路由器越远，信号越弱，就像说话声音小了对方听不清。

### 3.2 WiFi模块硬件集成


**🔧 常见WiFi芯片方案**

| 芯片厂商 | **型号** | **接口** | **特点** |
|---------|---------|---------|---------|
| 🔸 **Realtek** | `RTL8188` | `SDIO/USB` | `成本低，方案成熟` |
| 🔸 **Broadcom** | `BCM43xx` | `SDIO` | `性能好，苹果常用` |
| 🔸 **ESP32** | `ESP32-S3` | `SPI` | `集成度高，自带MCU` |
| 🔸 **Qualcomm** | `QCA9377` | `PCIe` | `企业级，稳定性好` |

**📡 硬件连接示意**
```
主控芯片                WiFi模块
┌─────────┐            ┌─────────┐
│   CPU   │◄──SDIO────►│ WiFi芯片 │◄──── 天线
│         │            │         │
│  Linux  │◄──GPIO────►│ 控制引脚 │
└─────────┘            └─────────┘
```

### 3.3 WiFi驱动配置


**⚙️ 内核配置**
```
CONFIG_CFG80211=y               # 无线配置API
CONFIG_MAC80211=y               # 802.11协议栈
CONFIG_WLAN=y                   # 无线局域网支持
CONFIG_RTL8188EU=m              # RTL8188EU驱动
CONFIG_RFKILL=y                 # 射频开关控制
```

**🔸 设备树配置**
```dts
wifi: wifi@1 {
    compatible = "brcm,bcm4329-fmac";
    reg = <1>;
    interrupt-parent = <&gpio>;
    interrupts = <10 IRQ_TYPE_LEVEL_HIGH>;
    interrupt-names = "host-wake";
    brcm,drive-strength = <10>;
    status = "okay";
};
```

### 3.4 WiFi网络配置管理


**🛠️ wpa_supplicant配置**

创建WiFi配置文件 `/etc/wpa_supplicant/wpa_supplicant.conf`：
```
ctrl_interface=/var/run/wpa_supplicant
update_config=1
country=CN

network={
    ssid="你的WiFi名称"
    psk="WiFi密码"
    key_mgmt=WPA-PSK
    priority=1
}
```

**🚀 WiFi连接管理脚本**
```bash
#!/bin/bash
# WiFi连接管理

# 启动WiFi接口
ip link set wlan0 up

# 扫描可用网络
iwlist wlan0 scan | grep ESSID

# 启动wpa_supplicant
wpa_supplicant -B -i wlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf

# 获取IP地址
dhclient wlan0
```

**🔍 WiFi状态监控**
```bash
# 查看WiFi连接状态
iwconfig wlan0

# 查看信号强度
cat /proc/net/wireless

# 查看连接信息
wpa_cli status
```

---

## 4. 🔵 蓝牙协议栈配置


### 4.1 蓝牙技术概述


**🔸 蓝牙基本概念**
```
蓝牙：短距离无线通信技术
传输距离：1-10米（根据功率等级）
应用场景：设备配对、数据传输、音频传输
版本演进：经典蓝牙 → 低功耗蓝牙(BLE) → 蓝牙5.0+
```

**💡 通俗比喻**
> 蓝牙就像两个人靠得很近时的悄悄话，距离近但很私密。经典蓝牙像正常说话，BLE像耳语，省电但传输的信息有限。

### 4.2 蓝牙硬件架构


**🏗️ 蓝牙协议栈结构**
```
应用层        │ 音频播放、文件传输、设备控制
             ├────────────────────────────
GATT/GAP     │ 通用属性协议 / 通用访问协议  
             ├────────────────────────────
L2CAP        │ 逻辑链路控制和适配协议
             ├────────────────────────────
HCI          │ 主机控制接口
             ├────────────────────────────
硬件层        │ 蓝牙芯片、天线
```

**🔧 硬件接口类型**
- **UART接口**：最常用，简单可靠，适合低速应用
- **USB接口**：即插即用，适合调试和开发
- **SDIO接口**：高速传输，适合音频应用

### 4.3 BlueZ协议栈配置


**⚙️ 内核配置选项**
```
CONFIG_BT=y                     # 蓝牙支持
CONFIG_BT_RFCOMM=y              # RFCOMM协议  
CONFIG_BT_BNEP=y                # 蓝牙网络封装协议
CONFIG_BT_HIDP=y                # 人机接口设备协议
CONFIG_BT_HCIUART=y             # UART HCI驱动
CONFIG_BT_HCIUART_H4=y          # H4协议支持
```

**📦 BlueZ工具集**
```bash
# 安装BlueZ工具
apt-get install bluez bluez-utils

# 启动蓝牙服务
systemctl start bluetooth
systemctl enable bluetooth
```

### 4.4 蓝牙设备管理


**🔸 基础操作命令**
```bash
# 查看蓝牙适配器状态
hciconfig

# 启用蓝牙适配器
hciconfig hci0 up

# 扫描附近设备
hcitool scan

# 使用bluetoothctl管理
bluetoothctl
```

**🤝 设备配对流程**
```
配对过程：
1. 开启设备发现模式
2. 扫描附近蓝牙设备  
3. 发起配对请求
4. 交换密钥完成认证
5. 建立连接开始通信
```

**💻 bluetoothctl实用操作**
```bash
# 进入蓝牙控制台
bluetoothctl

# 常用命令
[bluetooth]# power on          # 开启蓝牙
[bluetooth]# discoverable on   # 设置可发现
[bluetooth]# scan on          # 开始扫描
[bluetooth]# pair XX:XX:XX    # 配对设备
[bluetooth]# connect XX:XX:XX # 连接设备
```

---

## 5. 🚗 CAN总线支持配置


### 5.1 CAN总线基础知识


**🔸 CAN总线概念**
```
CAN：Controller Area Network，控制器局域网
特点：实时性强、抗干扰好、多主机通信
应用领域：汽车电子、工业控制、医疗设备
传输距离：最远1000米（低速率时）
```

**🚗 汽车类比理解**
> CAN总线就像汽车内部的"神经系统"，发动机、变速箱、ABS等各个部件都通过这条"神经"互相通信，协调工作。

### 5.2 CAN总线物理层


**⚡ 电气特性**
```
电平标准：差分信号，CAN_H和CAN_L
逻辑"0"(显性)：CAN_H - CAN_L ≈ 2V
逻辑"1"(隐性)：CAN_H - CAN_L ≈ 0V
终端电阻：120欧姆，总线两端各一个
```

**🔌 硬件连接示意**
```
ECU1     ECU2     ECU3
 |        |        |
CAN_H ----+--------+---- CAN_H
          |
         120Ω
          |  
CAN_L ----+--------+---- CAN_L
          |
         120Ω
```

### 5.3 Linux CAN驱动配置


**⚙️ 内核配置**
```
CONFIG_CAN=y                    # CAN总线支持
CONFIG_CAN_RAW=y                # 原始CAN协议
CONFIG_CAN_BCM=y                # 广播管理器
CONFIG_CAN_DEV=y                # CAN设备驱动框架
CONFIG_CAN_SJA1000=y            # SJA1000控制器
CONFIG_CAN_FLEXCAN=y            # Freescale FlexCAN
```

**🔧 设备树配置**
```dts
can0: flexcan@2090000 {
    compatible = "fsl,imx6ul-flexcan", "fsl,imx6q-flexcan";
    reg = <0x2090000 0x4000>;
    interrupts = <GIC_SPI 110 IRQ_TYPE_LEVEL_HIGH>;
    clocks = <&clks IMX6UL_CLK_CAN1_IPG>,
             <&clks IMX6UL_CLK_CAN1_SERIAL>;
    clock-names = "ipg", "per";
    status = "okay";
};
```

### 5.4 CAN网络接口管理


**🚀 CAN接口配置**
```bash
# 设置CAN接口参数
ip link set can0 type can bitrate 500000

# 启动CAN接口
ip link set can0 up

# 查看CAN接口状态
ip link show can0
```

**📡 CAN数据收发**
```bash
# 发送CAN数据帧
cansend can0 123#DEADBEEF

# 接收CAN数据
candump can0

# 实时监控CAN流量
candump -c -a can0
```

**🔍 CAN总线调试工具**
```bash
# 显示CAN统计信息
cat /proc/net/can/stats

# CAN错误帧分析
candump can0,0:0,#FFFFFFFF

# 生成测试数据
cangen can0 -D i -g 100
```

---

## 6. 📟 串口通信配置


### 6.1 串口通信基础


**🔸 串口概念**
```
串口：串行接口，一位一位地传输数据
标准：RS232、RS485、TTL电平
应用：调试输出、传感器通信、设备控制
特点：简单可靠、成本低、传输距离适中
```

**📬 邮递员类比**
> 串口通信就像邮递员送信，一封一封按顺序送，虽然慢但很可靠。并口就像多个邮递员同时送信，快但容易出错。

### 6.2 串口硬件接口类型


**🔌 常见串口接口**

| 接口类型 | **电平** | **传输距离** | **应用场景** |
|---------|---------|-------------|-------------|
| 🔸 **TTL** | `0V/3.3V或5V` | `几米内` | `芯片间通信` |
| 🔸 **RS232** | `±12V` | `15米` | `PC串口，工业设备` |
| 🔸 **RS485** | `差分信号` | `1200米` | `工业总线，远距离` |

**⚡ 信号线说明**
```
TXD：发送数据线
RXD：接收数据线  
GND：信号地线
RTS：请求发送
CTS：清除发送
DTR：数据终端就绪
DSR：数据装置就绪
```

### 6.3 串口驱动配置


**⚙️ 内核配置**
```
CONFIG_SERIAL_8250=y            # 8250/16550串口驱动
CONFIG_SERIAL_IMX=y             # i.MX串口驱动
CONFIG_SERIAL_DEV_BUS=y         # 串口设备总线
CONFIG_TTY=y                    # TTY子系统
```

**🔧 设备树配置示例**
```dts
uart1: serial@2020000 {
    compatible = "fsl,imx6ul-uart", "fsl,imx6q-uart";
    reg = <0x2020000 0x4000>;
    interrupts = <GIC_SPI 26 IRQ_TYPE_LEVEL_HIGH>;
    clocks = <&clks IMX6UL_CLK_UART1_IPG>,
             <&clks IMX6UL_CLK_UART1_SERIAL>;
    clock-names = "ipg", "per";
    status = "okay";
};
```

### 6.4 串口应用配置


**💻 串口参数设置**
```bash
# 设置串口参数
stty -F /dev/ttyS1 115200 cs8 -cstopb -parity

# 查看串口配置
stty -F /dev/ttyS1 -a

# 测试串口通信
echo "Hello" > /dev/ttyS1
cat /dev/ttyS1
```

**📝 串口参数说明**
- **115200**: 波特率（数据传输速度）
- **cs8**: 8位数据位
- **-cstopb**: 1位停止位
- **-parity**: 无奇偶校验

**🛠️ minicom串口调试工具**
```bash
# 安装minicom
apt-get install minicom

# 配置串口
minicom -s

# 连接串口
minicom -D /dev/ttyS1 -b 115200
```

---

## 7. 🔌 USB设备支持


### 7.1 USB基础知识


**🔸 USB概念与版本**
```
USB：Universal Serial Bus，通用串行总线
版本演进：USB 1.1 → USB 2.0 → USB 3.0 → USB-C
传输模式：控制传输、批量传输、中断传输、等时传输
设备类型：HID、存储、网络、音频、视频等
```

**🚌 公交车类比**
> USB就像公交线路，主机是总站，各种设备是沿途站点。USB HUB像换乘站，可以连接更多设备。

### 7.2 USB硬件架构


**🏗️ USB系统架构**
```
USB主机控制器
├── 根HUB
    ├── USB设备1（键盘）
    ├── USB HUB
    │   ├── USB设备2（鼠标）
    │   └── USB设备3（U盘）
    └── USB设备4（摄像头）
```

**⚙️ USB控制器类型**
- **OHCI**: 开放主机控制器接口（USB 1.1）
- **UHCI**: 通用主机控制器接口（USB 1.1）
- **EHCI**: 增强主机控制器接口（USB 2.0）
- **xHCI**: 可扩展主机控制器接口（USB 3.0+）

### 7.3 USB驱动配置


**🔧 内核配置**
```
CONFIG_USB=y                    # USB支持
CONFIG_USB_EHCI_HCD=y           # EHCI主机驱动
CONFIG_USB_OHCI_HCD=y           # OHCI主机驱动
CONFIG_USB_STORAGE=y            # USB存储设备
CONFIG_USB_HID=y                # USB HID设备
CONFIG_USB_NET_AX88179_178A=y   # USB网卡驱动
```

**📦 USB设备类驱动**
```
HID设备：键盘、鼠标、游戏手柄
存储设备：U盘、移动硬盘
网络设备：USB网卡、USB转以太网
音频设备：USB音箱、USB麦克风
视频设备：USB摄像头、视频采集卡
```

### 7.4 USB设备管理


**🔍 USB设备信息查看**
```bash
# 查看USB设备列表
lsusb

# 详细设备信息
lsusb -v

# USB设备树状显示
lsusb -t

# 内核USB设备信息
cat /proc/bus/usb/devices
```

**🚀 USB设备操作**
```bash
# 挂载USB存储设备
mount /dev/sda1 /mnt/usb

# 卸载USB设备
umount /mnt/usb

# USB设备热插拔监控
udevadm monitor --udev
```

**⚠️ USB常见问题处理**
```
问题1：USB设备不识别
解决：检查驱动 → lsmod | grep usb

问题2：USB设备无法挂载
解决：检查文件系统 → fdisk -l

问题3：USB传输速度慢
解决：确认USB版本匹配 → lsusb -v
```

---

## 8. 📊 网络协议栈裁剪


### 8.1 协议栈裁剪的必要性


**🎯 为什么要裁剪**
```
资源限制：嵌入式设备内存、存储空间有限
功耗考虑：减少不必要的功能降低功耗
安全需求：减少攻击面，提高系统安全性
专用需求：只保留必要的网络功能
```

**💡 装修房子类比**
> 网络协议栈裁剪就像装修房子，不需要的房间就不要建，这样省钱、省空间，维护也简单。

### 8.2 TCP/IP协议栈组件


**🏗️ 完整协议栈结构**
```
应用层     │ HTTP、FTP、SSH、MQTT、CoAP
          ├─────────────────────────────
传输层     │ TCP、UDP、SCTP
          ├─────────────────────────────  
网络层     │ IPv4、IPv6、ICMP、ARP
          ├─────────────────────────────
链路层     │ Ethernet、WiFi、Bluetooth
```

**🔸 内核网络配置选项**
```
CONFIG_NET=y                    # 网络支持基础
CONFIG_INET=y                   # IPv4支持
CONFIG_IPV6=y                   # IPv6支持（可选）
CONFIG_TCP_CONG_CUBIC=y         # TCP拥塞控制
CONFIG_NETFILTER=y              # 防火墙支持
CONFIG_WIRELESS=y               # 无线网络支持
```

### 8.3 应用层协议裁剪


**📦 常见应用协议选择**

| 协议 | **用途** | **优势** | **适用场景** |
|------|---------|---------|-------------|
| 🔸 **HTTP** | `网页访问` | `通用性好` | `Web接口、REST API` |
| 🔸 **MQTT** | `物联网消息` | `轻量级、低功耗` | `传感器数据上报` |
| 🔸 **CoAP** | `约束设备通信` | `极简协议` | `极低功耗设备` |
| 🔸 **Modbus TCP** | `工业控制` | `工业标准` | `PLC、工控设备` |

**🚀 轻量级HTTP服务器**
```bash
# 使用busybox内置httpd
busybox httpd -p 8080 -h /var/www

# 或使用lighttpd轻量级服务器
lighttpd -f /etc/lighttpd.conf -D
```

### 8.4 内核网络功能优化


**⚙️ 最小化内核配置**
```bash
# 禁用不需要的网络协议
# CONFIG_DECNET is not set          # DECnet协议
# CONFIG_X25 is not set             # X.25协议  
# CONFIG_LAPB is not set            # LAPB协议
# CONFIG_PHONET is not set          # Nokia Phonet

# 禁用高级网络功能
# CONFIG_NET_SCHED is not set       # 流量控制
# CONFIG_NET_CLS is not set         # 分类器
# CONFIG_NETFILTER_ADVANCED is not set  # 高级防火墙
```

**🔧 运行时网络优化**
```bash
# 调整网络缓冲区大小
echo 65536 > /proc/sys/net/core/rmem_default
echo 65536 > /proc/sys/net/core/wmem_default

# 禁用不需要的网络服务
systemctl disable ssh
systemctl disable cups
systemctl disable avahi-daemon
```

### 8.5 专用协议栈构建


**🎯 IoT设备协议栈示例**
```
物联网传感器设备：
应用层：MQTT + JSON
传输层：TCP（可靠性）或UDP（实时性）
网络层：IPv4
链路层：WiFi或以太网

去除组件：
× IPv6（暂不需要）
× FTP、SSH（安全考虑）  
× 复杂路由协议
× 高级防火墙功能
```

**📊 协议栈大小对比**
```
完整协议栈：~2MB内存占用
裁剪后：~500KB内存占用
节省空间：75%

启动时间：
完整版：8-10秒
裁剪版：3-5秒
```

---

## 9. 📋 核心要点总结


### 9.1 必须掌握的核心概念


```
🔸 以太网配置：硬件接口 + 驱动 + IP配置，有线网络的基础
🔸 WiFi集成：芯片选型 + 驱动适配 + wpa_supplicant管理
🔸 蓝牙协议栈：BlueZ框架 + HCI接口 + 设备配对管理  
🔸 CAN总线：工业控制标准 + 差分信号 + 实时通信
🔸 串口通信：最基础的通信方式，调试和控制的首选
🔸 USB支持：主机控制器 + 设备类驱动 + 热插拔管理
🔸 协议栈裁剪：根据应用需求精简，节省资源提高性能
```

### 9.2 关键理解要点


**🔹 硬件与软件的配合**
```
成功的网络配置 = 硬件选型 + 驱动适配 + 应用配置
硬件：提供物理连接能力
驱动：让系统识别和控制硬件  
应用：实现具体的网络功能
```

**🔹 嵌入式网络的特殊性**
```
资源受限：
• 内存有限 → 协议栈要裁剪
• 功耗敏感 → 需要休眠唤醒机制
• 实时性要求 → 选择合适的协议

可靠性要求：
• 工业环境 → 选择抗干扰强的接口
• 长期运行 → 完善的错误处理机制
• 远程维护 → 网络诊断和恢复能力
```

**🔹 协议选择原则**
```
传输距离：
• 短距离（1-10米）→ 蓝牙、USB
• 中距离（几十米）→ WiFi
• 长距离（数百米）→ 以太网、CAN

实时性要求：
• 高实时 → CAN总线、UDP
• 中等实时 → TCP
• 低实时 → HTTP、MQTT

功耗要求：
• 极低功耗 → BLE、LoRa
• 低功耗 → WiFi休眠模式
• 不限功耗 → 以太网
```

### 9.3 实际应用场景


**🎯 典型设备网络配置**

**工业控制器**：
- 主通信：以太网（稳定可靠）
- 现场总线：CAN/RS485（抗干扰）
- 调试接口：串口
- 配置接口：WiFi（临时）

**智能家居设备**：
- 主通信：WiFi（方便配置）
- 近场通信：蓝牙（配对设置）
- 备用通信：以太网（稳定性）

**车载设备**：
- 车内通信：CAN总线（实时性）
- 外部通信：4G/5G模块
- 诊断接口：OBD（基于CAN）
- 调试接口：串口

### 9.4 配置最佳实践


**⚡ 快速配置检查清单**
- [ ] 确认硬件接口类型和引脚连接
- [ ] 编译对应的内核驱动模块
- [ ] 配置设备树文件（如果使用）
- [ ] 设置正确的网络参数
- [ ] 测试基本的连通性
- [ ] 配置开机自启动脚本
- [ ] 建立故障恢复机制

**🔧 调试技巧**
```bash
# 网络接口调试三步法
1. 检查硬件：dmesg | grep -i network
2. 确认驱动：lsmod | grep -i 驱动名
3. 测试连通：ping + tcpdump

# 串口调试
1. 确认设备文件：ls /dev/ttyS*
2. 测试环回：连接TXD和RXD
3. 监控数据：cat /dev/ttyS1

# 无线网络调试  
1. 扫描网络：iwlist scan
2. 连接状态：iwconfig
3. 日志分析：wpa_cli status
```

**🚀 性能优化建议**
- **选择合适的硬件方案**：性能与成本平衡
- **精简协议栈**：只保留必要的网络功能
- **优化缓冲区**：根据应用调整网络缓冲区大小
- **实现休眠机制**：WiFi和蓝牙的功耗管理
- **建立监控机制**：网络状态监控和自动恢复

**核心记忆口诀**：
- 硬件选型要合理，驱动适配是关键
- 协议栈配置要精简，功耗性能要平衡  
- 调试工具要熟练，问题排查有方法
- 网络配置三要素：硬件+驱动+应用配置