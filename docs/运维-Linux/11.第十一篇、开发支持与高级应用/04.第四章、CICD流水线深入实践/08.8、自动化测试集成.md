---
title: 8ã€è‡ªåŠ¨åŒ–æµ‹è¯•é›†æˆ
---
## ğŸ“š ç›®å½•

1. [è‡ªåŠ¨åŒ–æµ‹è¯•åŸºç¡€æ¦‚å¿µ](#1-è‡ªåŠ¨åŒ–æµ‹è¯•åŸºç¡€æ¦‚å¿µ)
2. [å•å…ƒæµ‹è¯•æ‰§è¡Œé…ç½®](#2-å•å…ƒæµ‹è¯•æ‰§è¡Œé…ç½®)
3. [é›†æˆæµ‹è¯•ç¯å¢ƒå‡†å¤‡](#3-é›†æˆæµ‹è¯•ç¯å¢ƒå‡†å¤‡)
4. [æµ‹è¯•è¦†ç›–ç‡æ”¶é›†ä¸åˆ†æ](#4-æµ‹è¯•è¦†ç›–ç‡æ”¶é›†ä¸åˆ†æ)
5. [æµ‹è¯•æŠ¥å‘Šç”Ÿæˆä¸å±•ç¤º](#5-æµ‹è¯•æŠ¥å‘Šç”Ÿæˆä¸å±•ç¤º)
6. [æµ‹è¯•å¤±è´¥å¤„ç†ç­–ç•¥](#6-æµ‹è¯•å¤±è´¥å¤„ç†ç­–ç•¥)
7. [å¹¶è¡Œæµ‹è¯•æ‰§è¡Œä¼˜åŒ–](#7-å¹¶è¡Œæµ‹è¯•æ‰§è¡Œä¼˜åŒ–)
8. [æµ‹è¯•æ•°æ®ç®¡ç†](#8-æµ‹è¯•æ•°æ®ç®¡ç†)
9. [æ€§èƒ½æµ‹è¯•é›†æˆ](#9-æ€§èƒ½æµ‹è¯•é›†æˆ)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ§ª è‡ªåŠ¨åŒ–æµ‹è¯•åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯CI/CDä¸­çš„è‡ªåŠ¨åŒ–æµ‹è¯•


**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
è‡ªåŠ¨åŒ–æµ‹è¯•ï¼šåœ¨ä»£ç æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿåï¼Œ
è‡ªåŠ¨è§¦å‘æ‰§è¡Œçš„å„ç§æµ‹è¯•æµç¨‹ï¼Œç¡®ä¿ä»£ç è´¨é‡
```

> ğŸ’¡ **é€šä¿—ç†è§£**ï¼šå°±åƒå·¥å‚çš„è´¨æ£€æµæ°´çº¿ï¼Œæ¯ä¸ªäº§å“ï¼ˆä»£ç ï¼‰éƒ½è¦ç»è¿‡è‡ªåŠ¨åŒ–çš„è´¨é‡æ£€æµ‹ï¼Œåˆæ ¼æ‰èƒ½è¿›å…¥ä¸‹ä¸€ç¯èŠ‚

**ğŸ”¸ æµ‹è¯•é‡‘å­—å¡”ç»“æ„**
```
        /\        â† æ‰‹åŠ¨æµ‹è¯•ï¼ˆå°‘é‡ï¼‰
       /  \
      /UIæµ‹\      â† ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆä¸­ç­‰ï¼‰
     /è¯•å±‚ \
    /______\
   /        \     â† é›†æˆæµ‹è¯•ï¼ˆè¾ƒå¤šï¼‰
  / é›†æˆæµ‹è¯• \
 /___________\
/            \    â† å•å…ƒæµ‹è¯•ï¼ˆå¤§é‡ï¼ŒåŸºç¡€ï¼‰
/  å•å…ƒæµ‹è¯•   \
/______________\
```

### 1.2 CI/CDæµ‹è¯•æµç¨‹æ¦‚è§ˆ


**ğŸ”„ å…¸å‹æµ‹è¯•æµæ°´çº¿**
```
ä»£ç æäº¤ â†’ ä»£ç æ£€æŸ¥ â†’ å•å…ƒæµ‹è¯• â†’ æ„å»ºåº”ç”¨ â†’ é›†æˆæµ‹è¯• â†’ éƒ¨ç½²æµ‹è¯•ç¯å¢ƒ â†’ ç«¯åˆ°ç«¯æµ‹è¯• â†’ æ€§èƒ½æµ‹è¯• â†’ éƒ¨ç½²ç”Ÿäº§
     â†“         â†“         â†“         â†“         â†“            â†“           â†“         â†“         â†“
   è¯­æ³•æ£€æŸ¥   å¿«é€Ÿåé¦ˆ   æ„å»ºéªŒè¯   åŠŸèƒ½éªŒè¯   ç¯å¢ƒéªŒè¯      ç”¨æˆ·ä½“éªŒ     æ€§èƒ½éªŒè¯   æœ€ç»ˆéƒ¨ç½²
```

**âš¡ æµ‹è¯•ç±»å‹åˆ’åˆ†**
- **å•å…ƒæµ‹è¯•**ï¼šæµ‹è¯•æœ€å°ä»£ç å•å…ƒï¼ˆå‡½æ•°ã€æ–¹æ³•ï¼‰
- **é›†æˆæµ‹è¯•**ï¼šæµ‹è¯•å¤šä¸ªæ¨¡å—åä½œ
- **ç«¯åˆ°ç«¯æµ‹è¯•**ï¼šæ¨¡æ‹Ÿç”¨æˆ·å®Œæ•´æ“ä½œæµç¨‹
- **æ€§èƒ½æµ‹è¯•**ï¼šéªŒè¯ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡

---

## 2. ğŸ”¬ å•å…ƒæµ‹è¯•æ‰§è¡Œé…ç½®


### 2.1 Jenkinsä¸­çš„å•å…ƒæµ‹è¯•é…ç½®


**ğŸ› ï¸ Jenkins Pipelineé…ç½®**
```groovy
pipeline {
    agent any
    
    stages {
        stage('å•å…ƒæµ‹è¯•') {
            steps {
                script {
                    // Mavené¡¹ç›®å•å…ƒæµ‹è¯•
                    sh 'mvn clean test'
                    
                    // Node.jsé¡¹ç›®å•å…ƒæµ‹è¯•
                    sh 'npm test'
                    
                    // Pythoné¡¹ç›®å•å…ƒæµ‹è¯•
                    sh 'python -m pytest tests/unit/'
                }
            }
            post {
                always {
                    // å‘å¸ƒæµ‹è¯•ç»“æœ
                    publishTestResults testResultsPattern: 'target/surefire-reports/*.xml'
                    
                    // æ”¶é›†è¦†ç›–ç‡æŠ¥å‘Š
                    publishCoverageReports(
                        adapters: [jacocoAdapter('target/site/jacoco/jacoco.xml')]
                    )
                }
            }
        }
    }
}
```

### 2.2 GitLab CIå•å…ƒæµ‹è¯•é…ç½®


**ğŸ“ .gitlab-ci.ymlé…ç½®ç¤ºä¾‹**
```yaml
# å®šä¹‰æµ‹è¯•é˜¶æ®µ
stages:
  - test
  - build
  - deploy

# å•å…ƒæµ‹è¯•ä»»åŠ¡
unit_test:
  stage: test
  image: maven:3.8-openjdk-11
  script:
    - mvn clean test
  artifacts:
    when: always
    reports:
      junit:
        - target/surefire-reports/TEST-*.xml
      coverage_report:
        coverage_format: cobertura
        path: target/site/cobertura/coverage.xml
  coverage: '/Total.*?([0-9]{1,3})%/'
```

### 2.3 ä¸åŒè¯­è¨€çš„å•å…ƒæµ‹è¯•é…ç½®


**â˜• Javaé¡¹ç›®é…ç½®**
```xml
<!-- pom.xmlä¸­çš„æµ‹è¯•é…ç½® -->
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <version>3.0.0-M7</version>
            <configuration>
                <includes>
                    <include>**/*Test.java</include>
                    <include>**/*Tests.java</include>
                </includes>
            </configuration>
        </plugin>
    </plugins>
</build>
```

**ğŸ Pythoné¡¹ç›®é…ç½®**
```yaml
# pytest.inié…ç½®æ–‡ä»¶
[tool:pytest]
testpaths = tests
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*
addopts = --cov=src --cov-report=xml --cov-report=html
```

**ğŸ“¦ Node.jsé¡¹ç›®é…ç½®**
```json
{
  "scripts": {
    "test": "jest --coverage",
    "test:watch": "jest --watch",
    "test:ci": "jest --coverage --watchAll=false"
  },
  "jest": {
    "collectCoverageFrom": [
      "src/**/*.js",
      "!src/**/*.test.js"
    ]
  }
}
```

---

## 3. ğŸ—ï¸ é›†æˆæµ‹è¯•ç¯å¢ƒå‡†å¤‡


### 3.1 æµ‹è¯•ç¯å¢ƒéš”ç¦»ç­–ç•¥


**ğŸ”¸ ç¯å¢ƒéš”ç¦»çš„é‡è¦æ€§**
> âš ï¸ **å…³é”®ç†è§£**ï¼šé›†æˆæµ‹è¯•éœ€è¦çœŸå®çš„å¤–éƒ¨ä¾èµ–ï¼ˆæ•°æ®åº“ã€APIã€æ¶ˆæ¯é˜Ÿåˆ—ï¼‰ï¼Œä½†ä¸èƒ½å½±å“ç”Ÿäº§ç¯å¢ƒ

**ğŸŒ å¸¸è§éš”ç¦»æ–¹æ¡ˆ**
```
æ–¹æ¡ˆä¸€ï¼šDockerå®¹å™¨éš”ç¦»
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åº”ç”¨å®¹å™¨      â”‚â”€â”€â”€â–¶â”‚   æ•°æ®åº“å®¹å™¨    â”‚
â”‚  (æµ‹è¯•ç‰ˆæœ¬)     â”‚    â”‚  (æµ‹è¯•æ•°æ®)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚   Rediså®¹å™¨     â”‚
          â”‚  (æµ‹è¯•ç¼“å­˜)     â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ–¹æ¡ˆäºŒï¼šæµ‹è¯•æ•°æ®åº“åˆ†ç¦»
ç”Ÿäº§æ•°æ®åº“ï¼šprod_db      æµ‹è¯•æ•°æ®åº“ï¼štest_db
    â”‚                        â”‚
    â”œâ”€ç”¨æˆ·çœŸå®æ•°æ®            â”œâ”€æ¨¡æ‹Ÿæµ‹è¯•æ•°æ®
    â”œâ”€ä¸¥æ ¼æƒé™æ§åˆ¶            â”œâ”€å¯é‡å¤åˆå§‹åŒ–
    â””â”€é«˜å¯ç”¨é…ç½®              â””â”€å¿«é€Ÿæ¸…ç†æ¢å¤
```

### 3.2 Jenkinsé›†æˆæµ‹è¯•é…ç½®


**ğŸ”§ Jenkins Pipelineé›†æˆæµ‹è¯•**
```groovy
pipeline {
    agent any
    
    stages {
        stage('å‡†å¤‡æµ‹è¯•ç¯å¢ƒ') {
            steps {
                script {
                    // å¯åŠ¨æµ‹è¯•æ•°æ®åº“
                    sh '''
                        docker run -d --name test-mysql \
                        -e MYSQL_ROOT_PASSWORD=testpass \
                        -e MYSQL_DATABASE=testdb \
                        -p 3307:3306 mysql:8.0
                    '''
                    
                    // ç­‰å¾…æ•°æ®åº“å¯åŠ¨
                    sh 'sleep 30'
                    
                    // åˆå§‹åŒ–æµ‹è¯•æ•°æ®
                    sh 'mysql -h localhost -P 3307 -u root -ptestpass testdb < test-data.sql'
                }
            }
        }
        
        stage('é›†æˆæµ‹è¯•') {
            steps {
                script {
                    // è®¾ç½®æµ‹è¯•ç¯å¢ƒå˜é‡
                    env.DB_HOST = 'localhost'
                    env.DB_PORT = '3307'
                    env.DB_NAME = 'testdb'
                    
                    // æ‰§è¡Œé›†æˆæµ‹è¯•
                    sh 'mvn verify -Dspring.profiles.active=integration-test'
                }
            }
        }
    }
    
    post {
        always {
            // æ¸…ç†æµ‹è¯•ç¯å¢ƒ
            sh 'docker stop test-mysql && docker rm test-mysql'
        }
    }
}
```

### 3.3 GitLab CIé›†æˆæµ‹è¯•é…ç½®


**ğŸ“‹ æœåŠ¡ä¾èµ–é…ç½®**
```yaml
integration_test:
  stage: test
  image: maven:3.8-openjdk-11
  services:
    - name: mysql:8.0
      alias: mysql
      variables:
        MYSQL_ROOT_PASSWORD: testpassword
        MYSQL_DATABASE: testdb
    - name: redis:6.2
      alias: redis
  variables:
    DB_HOST: mysql
    DB_PORT: 3306
    REDIS_HOST: redis
  before_script:
    # ç­‰å¾…æœåŠ¡å¯åŠ¨
    - apt-get update && apt-get install -y mysql-client
    - while ! mysqladmin ping -h mysql -u root -ptestpassword; do sleep 1; done
    # åˆå§‹åŒ–æµ‹è¯•æ•°æ®
    - mysql -h mysql -u root -ptestpassword testdb < test-schema.sql
  script:
    - mvn verify -Dspring.profiles.active=integration-test
```

### 3.4 æµ‹è¯•æ•°æ®å‡†å¤‡ç­–ç•¥


**ğŸ“Š æµ‹è¯•æ•°æ®ç®¡ç†åŸåˆ™**

| æ•°æ®ç±»å‹ | **å‡†å¤‡æ–¹å¼** | **é€‚ç”¨åœºæ™¯** | **ä¼˜ç¼ºç‚¹** |
|---------|------------|-------------|-----------|
| **é™æ€æ•°æ®** | `SQLè„šæœ¬å¯¼å…¥` | `å‚è€ƒæ•°æ®ã€é…ç½®è¡¨` | `âœ… ç¨³å®šå¯æ§ âŒ ç»´æŠ¤æˆæœ¬é«˜` |
| **åŠ¨æ€æ•°æ®** | `ä»£ç ç”Ÿæˆ` | `ç”¨æˆ·æ•°æ®ã€è®¢å•æ•°æ®` | `âœ… çµæ´»å¤šæ · âŒ å¯èƒ½ä¸å¤ŸçœŸå®` |
| **çœŸå®æ•°æ®** | `ç”Ÿäº§æ•°æ®è„±æ•` | `å¤æ‚ä¸šåŠ¡åœºæ™¯` | `âœ… çœŸå®å¯é  âŒ éšç§å®‰å…¨é£é™©` |

**ğŸ”¸ æµ‹è¯•æ•°æ®ç”Ÿæˆç¤ºä¾‹**
```java
@Component
public class TestDataBuilder {
    
    @Autowired
    private UserRepository userRepository;
    
    public void prepareTestData() {
        // æ¸…ç†æ—§æ•°æ®
        userRepository.deleteAll();
        
        // åˆ›å»ºæµ‹è¯•ç”¨æˆ·
        User testUser = User.builder()
            .username("testuser")
            .email("test@example.com")
            .password("encryptedPassword")
            .build();
            
        userRepository.save(testUser);
    }
}
```

---

## 4. ğŸ“Š æµ‹è¯•è¦†ç›–ç‡æ”¶é›†ä¸åˆ†æ


### 4.1 æµ‹è¯•è¦†ç›–ç‡åŸºæœ¬æ¦‚å¿µ


**ğŸ“‹ è¦†ç›–ç‡ç±»å‹è¯´æ˜**
```
è¡Œè¦†ç›–ç‡ï¼ˆLine Coverageï¼‰ï¼šè¢«æ‰§è¡Œçš„ä»£ç è¡Œæ•°å æ€»è¡Œæ•°çš„æ¯”ä¾‹
åˆ†æ”¯è¦†ç›–ç‡ï¼ˆBranch Coverageï¼‰ï¼šè¢«æ‰§è¡Œçš„åˆ¤æ–­åˆ†æ”¯å æ€»åˆ†æ”¯æ•°çš„æ¯”ä¾‹  
å‡½æ•°è¦†ç›–ç‡ï¼ˆFunction Coverageï¼‰ï¼šè¢«è°ƒç”¨çš„å‡½æ•°å æ€»å‡½æ•°æ•°çš„æ¯”ä¾‹
è¯­å¥è¦†ç›–ç‡ï¼ˆStatement Coverageï¼‰ï¼šè¢«æ‰§è¡Œçš„è¯­å¥å æ€»è¯­å¥æ•°çš„æ¯”ä¾‹
```

> ğŸ’¡ **é€šä¿—è§£é‡Š**ï¼šå°±åƒæ£€æŸ¥ä¸€æœ¬ä¹¦è¢«é˜…è¯»çš„ç¨‹åº¦ï¼Œçœ‹å“ªäº›ç« èŠ‚ï¼ˆå‡½æ•°ï¼‰ã€å“ªäº›æ®µè½ï¼ˆåˆ†æ”¯ï¼‰ã€å“ªäº›å¥å­ï¼ˆè¯­å¥ï¼‰è¢«è¯»è¿‡

### 4.2 Javaé¡¹ç›®è¦†ç›–ç‡é…ç½®


**â˜• JaCoCoè¦†ç›–ç‡å·¥å…·é…ç½®**
```xml
<!-- Maven JaCoCoæ’ä»¶é…ç½® -->
<plugin>
    <groupId>org.jacoco</groupId>
    <artifactId>jacoco-maven-plugin</artifactId>
    <version>0.8.8</version>
    <executions>
        <execution>
            <goals>
                <goal>prepare-agent</goal>
            </goals>
        </execution>
        <execution>
            <id>report</id>
            <phase>test</phase>
            <goals>
                <goal>report</goal>
            </goals>
        </execution>
        <execution>
            <id>check</id>
            <goals>
                <goal>check</goal>
            </goals>
            <configuration>
                <rules>
                    <rule>
                        <element>PACKAGE</element>
                        <limits>
                            <limit>
                                <counter>LINE</counter>
                                <value>COVEREDRATIO</value>
                                <minimum>0.80</minimum>
                            </limit>
                        </limits>
                    </rule>
                </rules>
            </configuration>
        </execution>
    </executions>
</plugin>
```

### 4.3 Jenkinsè¦†ç›–ç‡æŠ¥å‘Šé›†æˆ


**ğŸ“ˆ Jenkinsè¦†ç›–ç‡å±•ç¤ºé…ç½®**
```groovy
pipeline {
    stages {
        stage('æµ‹è¯•è¦†ç›–ç‡') {
            steps {
                // æ‰§è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
                sh 'mvn clean test jacoco:report'
            }
            post {
                always {
                    // å‘å¸ƒè¦†ç›–ç‡æŠ¥å‘Š
                    publishCoverageReports(
                        adapters: [
                            jacocoAdapter(
                                path: 'target/site/jacoco/jacoco.xml',
                                thresholds: [
                                    [thresholdTarget: 'Line', unhealthyThreshold: 70.0, unstableThreshold: 80.0],
                                    [thresholdTarget: 'Branch', unhealthyThreshold: 60.0, unstableThreshold: 70.0]
                                ]
                            )
                        ],
                        sourceFileResolver: sourceFiles('STORE_LAST_BUILD')
                    )
                }
            }
        }
    }
}
```

### 4.4 è¦†ç›–ç‡è´¨é‡é—¨ç¦


**ğŸš¦ è´¨é‡é—¨ç¦ç­–ç•¥**

> âš ï¸ **é‡è¦æé†’**ï¼šè¦†ç›–ç‡ä¸æ˜¯è¶Šé«˜è¶Šå¥½ï¼Œè¦å¹³è¡¡æµ‹è¯•æˆæœ¬å’Œä»£ç è´¨é‡

**ğŸ”¸ æ¨èè¦†ç›–ç‡æ ‡å‡†**
```
æ–°é¡¹ç›®ï¼š
â”œâ”€ è¡Œè¦†ç›–ç‡ï¼šâ‰¥ 80%
â”œâ”€ åˆ†æ”¯è¦†ç›–ç‡ï¼šâ‰¥ 70%  
â””â”€ æ ¸å¿ƒä¸šåŠ¡æ¨¡å—ï¼šâ‰¥ 90%

é—ç•™é¡¹ç›®ï¼š
â”œâ”€ æ•´ä½“è¦†ç›–ç‡ï¼šâ‰¥ 60%
â”œâ”€ æ–°å¢ä»£ç ï¼šâ‰¥ 85%
â””â”€ ä¿®æ”¹ä»£ç ï¼šâ‰¥ 80%

å…³é”®ç³»ç»Ÿï¼š
â”œâ”€ è¡Œè¦†ç›–ç‡ï¼šâ‰¥ 95%
â”œâ”€ åˆ†æ”¯è¦†ç›–ç‡ï¼šâ‰¥ 90%
â””â”€ å¼ºåˆ¶é—¨ç¦ï¼šè¦†ç›–ç‡ä¸‹é™ç›´æ¥å¤±è´¥
```

**ğŸ”§ GitLab CIè¦†ç›–ç‡é—¨ç¦**
```yaml
test_coverage:
  stage: test
  script:
    - mvn clean test jacoco:report
    # æå–è¦†ç›–ç‡æ•°å€¼
    - coverage=$(grep -o 'Total.*[0-9]\{1,3\}%' target/site/jacoco/index.html | grep -o '[0-9]\{1,3\}')
    - echo "ä»£ç è¦†ç›–ç‡ï¼š$coverage%"
    # è¦†ç›–ç‡æ£€æŸ¥
    - |
      if [ "$coverage" -lt "80" ]; then
        echo "âŒ è¦†ç›–ç‡ä¸è¶³80%ï¼Œå½“å‰ï¼š$coverage%"
        exit 1
      else
        echo "âœ… è¦†ç›–ç‡è¾¾æ ‡ï¼š$coverage%"
      fi
  coverage: '/Total.*?([0-9]{1,3})%/'
```

---

## 5. ğŸ“‹ æµ‹è¯•æŠ¥å‘Šç”Ÿæˆä¸å±•ç¤º


### 5.1 Jenkinsæµ‹è¯•æŠ¥å‘Šé…ç½®


**ğŸ“Š æµ‹è¯•ç»“æœå‘å¸ƒ**
```groovy
pipeline {
    post {
        always {
            // å‘å¸ƒJUnitæµ‹è¯•ç»“æœ
            publishTestResults(
                testResultsPattern: '**/target/surefire-reports/*.xml',
                allowEmptyResults: false,
                testDataPublishers: [
                    [$class: 'StabilityTestDataPublisher'],
                    [$class: 'ClaimTestDataPublisher']
                ]
            )
            
            // å‘å¸ƒHTMLæµ‹è¯•æŠ¥å‘Š
            publishHTML([
                allowMissing: false,
                alwaysLinkToLastBuild: true,
                keepAll: true,
                reportDir: 'target/site/jacoco',
                reportFiles: 'index.html',
                reportName: 'æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š',
                reportTitles: ''
            ])
        }
        
        failure {
            // æµ‹è¯•å¤±è´¥æ—¶å‘é€é‚®ä»¶é€šçŸ¥
            emailext(
                subject: "æ„å»ºå¤±è´¥ï¼š${env.JOB_NAME} - ${env.BUILD_NUMBER}",
                body: """
                æ„å»ºå¤±è´¥è¯¦æƒ…ï¼š
                é¡¹ç›®ï¼š${env.JOB_NAME}
                æ„å»ºå·ï¼š${env.BUILD_NUMBER}
                å¤±è´¥åŸå› ï¼šæµ‹è¯•æœªé€šè¿‡
                æŸ¥çœ‹è¯¦æƒ…ï¼š${env.BUILD_URL}
                """,
                to: "${env.CHANGE_AUTHOR_EMAIL}"
            )
        }
    }
}
```

### 5.2 GitLab CIæµ‹è¯•æŠ¥å‘Šé…ç½®


**ğŸ“ˆ GitLabæµ‹è¯•æŠ¥å‘Šå±•ç¤º**
```yaml
test_job:
  stage: test
  script:
    - mvn test
  artifacts:
    when: always
    reports:
      # JUnitæµ‹è¯•æŠ¥å‘Š
      junit: target/surefire-reports/TEST-*.xml
      # è¦†ç›–ç‡æŠ¥å‘Š
      coverage_report:
        coverage_format: cobertura
        path: target/site/cobertura/coverage.xml
    paths:
      # ä¿å­˜HTMLæŠ¥å‘Š
      - target/site/jacoco/
    expire_in: 1 week
  coverage: '/Total.*?([0-9]{1,3})%/'
```

### 5.3 æµ‹è¯•æŠ¥å‘Šä¼˜åŒ–å±•ç¤º


**ğŸ¨ æŠ¥å‘Šå†…å®¹ä¸°å¯ŒåŒ–**

**æµ‹è¯•æŠ¥å‘ŠåŒ…å«å†…å®¹**ï¼š
- âœ… **æµ‹è¯•æ‰§è¡Œç»Ÿè®¡**ï¼šé€šè¿‡/å¤±è´¥/è·³è¿‡çš„æµ‹è¯•æ•°é‡
- ğŸ“Š **è¦†ç›–ç‡è¶‹åŠ¿**ï¼šå†å²è¦†ç›–ç‡å˜åŒ–å›¾è¡¨  
- ğŸ” **å¤±è´¥æµ‹è¯•è¯¦æƒ…**ï¼šå…·ä½“å¤±è´¥åŸå› å’Œå †æ ˆä¿¡æ¯
- â±ï¸ **æ‰§è¡Œæ—¶é—´åˆ†æ**ï¼šæœ€æ…¢çš„æµ‹è¯•ç”¨ä¾‹
- ğŸ“ˆ **è´¨é‡è¶‹åŠ¿**ï¼šæµ‹è¯•ç¨³å®šæ€§å’Œå¯é æ€§åˆ†æ

```bash
# ç”Ÿæˆè¯¦ç»†çš„æµ‹è¯•æŠ¥å‘Š
mvn surefire-report:report-only
mvn site -DgenerateReports=false
```

**ğŸ“± æŠ¥å‘Šé€šçŸ¥ç­–ç•¥**
```
é€šçŸ¥çº§åˆ«è®¾ç½®ï¼š
ğŸ”´ ä¸¥é‡ï¼šæ‰€æœ‰æµ‹è¯•å¤±è´¥ â†’ ç«‹å³é€šçŸ¥æ‰€æœ‰äºº
ğŸŸ¡ è­¦å‘Šï¼šéƒ¨åˆ†æµ‹è¯•å¤±è´¥ â†’ é€šçŸ¥å¼€å‘å›¢é˜Ÿ  
ğŸŸ¢ ä¿¡æ¯ï¼šè¦†ç›–ç‡ä¸‹é™ â†’ é€šçŸ¥ä»£ç æäº¤è€…
ğŸ“Š å®šæœŸï¼šæ¯æ—¥è´¨é‡æŠ¥å‘Š â†’ å‘é€ç»™é¡¹ç›®ç»ç†
```

---

## 6. ğŸš¨ æµ‹è¯•å¤±è´¥å¤„ç†ç­–ç•¥


### 6.1 æµ‹è¯•å¤±è´¥åˆ†ç±»ä¸å¤„ç†


**ğŸ”¸ å¤±è´¥ç±»å‹åˆ†æ**
```
æµ‹è¯•å¤±è´¥ç±»å‹ï¼š
â”œâ”€ ä»£ç ç¼ºé™·ï¼šçœŸæ­£çš„bugï¼Œéœ€è¦ä¿®å¤ä»£ç 
â”œâ”€ æµ‹è¯•è„†å¼±ï¼šç¯å¢ƒä¾èµ–å¯¼è‡´ï¼Œéœ€è¦ä¼˜åŒ–æµ‹è¯•  
â”œâ”€ ç¯å¢ƒé—®é¢˜ï¼šåŸºç¡€è®¾æ–½æ•…éšœï¼Œéœ€è¦ä¿®å¤ç¯å¢ƒ
â””â”€ æµ‹è¯•è¿‡æ—¶ï¼šéœ€æ±‚å˜åŒ–ï¼Œéœ€è¦æ›´æ–°æµ‹è¯•
```

> ğŸ’¡ **å…³é”®ç†è§£**ï¼šä¸æ˜¯æ‰€æœ‰æµ‹è¯•å¤±è´¥éƒ½æ„å‘³ç€ä»£ç æœ‰é—®é¢˜ï¼Œè¦å­¦ä¼šåŒºåˆ†å¤±è´¥åŸå› 

### 6.2 Jenkinså¤±è´¥å¤„ç†é…ç½®


**ğŸ”§ æ™ºèƒ½é‡è¯•æœºåˆ¶**
```groovy
pipeline {
    stages {
        stage('æµ‹è¯•æ‰§è¡Œ') {
            steps {
                script {
                    // é‡è¯•æœºåˆ¶ï¼šæœ€å¤šé‡è¯•3æ¬¡
                    retry(3) {
                        sh 'mvn test'
                    }
                }
            }
        }
    }
    
    post {
        failure {
            script {
                // åˆ†æå¤±è´¥åŸå› 
                def testResults = readFile('target/surefire-reports/TEST-*.xml')
                
                if (testResults.contains('TimeoutException')) {
                    echo "â° æ£€æµ‹åˆ°è¶…æ—¶å¤±è´¥ï¼Œå¯èƒ½æ˜¯ç¯å¢ƒé—®é¢˜"
                    // è§¦å‘ç¯å¢ƒæ£€æŸ¥
                    build job: 'environment-check', wait: false
                }
                
                if (testResults.contains('ConnectionException')) {
                    echo "ğŸŒ æ£€æµ‹åˆ°è¿æ¥å¤±è´¥ï¼Œé‡å¯ç›¸å…³æœåŠ¡"
                    // é‡å¯æµ‹è¯•ç¯å¢ƒ
                    sh 'docker-compose restart'
                }
            }
        }
        
        unstable {
            echo "âš ï¸ æµ‹è¯•ä¸ç¨³å®šï¼Œä½†æ„å»ºç»§ç»­"
            // æ ‡è®°ä¸ºä¸ç¨³å®šï¼Œä¸é˜»æ–­æµæ°´çº¿
        }
    }
}
```

### 6.3 æµ‹è¯•å¤±è´¥é€šçŸ¥æœºåˆ¶


**ğŸ“§ æ™ºèƒ½é€šçŸ¥ç­–ç•¥**
```groovy
def sendFailureNotification() {
    def failureReason = analyzeFailure()
    def notificationLevel = determineNotificationLevel(failureReason)
    
    switch(notificationLevel) {
        case 'CRITICAL':
            // å…³é”®å¤±è´¥ï¼šé€šçŸ¥æ‰€æœ‰äºº
            emailext(
                subject: "ğŸš¨ ä¸¥é‡ï¼š${env.JOB_NAME} æµ‹è¯•å¤±è´¥",
                body: """
                å…³é”®æµ‹è¯•å¤±è´¥ï¼Œéœ€è¦ç«‹å³å¤„ç†ï¼š
                å¤±è´¥åŸå› ï¼š${failureReason}
                å½±å“èŒƒå›´ï¼šå¯èƒ½å½±å“ç”Ÿäº§å‘å¸ƒ
                å¤„ç†äººå‘˜ï¼šå…¨ä½“å¼€å‘å›¢é˜Ÿ
                """,
                to: "dev-team@company.com,qa-team@company.com"
            )
            break
            
        case 'WARNING':
            // ä¸€èˆ¬å¤±è´¥ï¼šé€šçŸ¥ç›¸å…³äººå‘˜
            emailext(
                subject: "âš ï¸ è­¦å‘Šï¼š${env.JOB_NAME} éƒ¨åˆ†æµ‹è¯•å¤±è´¥",
                to: "${env.CHANGE_AUTHOR_EMAIL}"
            )
            break
    }
}
```

### 6.4 è‡ªåŠ¨ä¿®å¤ç­–ç•¥


**ğŸ”„ å¸¸è§é—®é¢˜è‡ªåŠ¨ä¿®å¤**
```bash
#!/bin/bash
# æµ‹è¯•ç¯å¢ƒè‡ªåŠ¨ä¿®å¤è„šæœ¬

# æ£€æŸ¥æ•°æ®åº“è¿æ¥
if ! mysqladmin ping -h localhost; then
    echo "ğŸ”§ æ•°æ®åº“è¿æ¥å¤±è´¥ï¼Œé‡å¯æ•°æ®åº“æœåŠ¡"
    systemctl restart mysql
fi

# æ¸…ç†æµ‹è¯•æ•°æ®
mysql -e "DELETE FROM test_data WHERE created_at < DATE_SUB(NOW(), INTERVAL 1 DAY);"

# æ£€æŸ¥ç£ç›˜ç©ºé—´
DISK_USAGE=$(df / | awk 'NR==2 {print $5}' | sed 's/%//')
if [ $DISK_USAGE -gt 90 ]; then
    echo "ğŸ’¾ ç£ç›˜ç©ºé—´ä¸è¶³ï¼Œæ¸…ç†ä¸´æ—¶æ–‡ä»¶"
    find /tmp -type f -mtime +7 -delete
    docker system prune -f
fi

# é‡ç½®æµ‹è¯•ç¯å¢ƒ
docker-compose down && docker-compose up -d
```

---

## 7. âš¡ å¹¶è¡Œæµ‹è¯•æ‰§è¡Œä¼˜åŒ–


### 7.1 å¹¶è¡Œæµ‹è¯•çš„ä¼˜åŠ¿ä¸æŒ‘æˆ˜


**ğŸ“ˆ å¹¶è¡Œæµ‹è¯•æ”¶ç›Šåˆ†æ**
```
ä¸²è¡Œæ‰§è¡Œï¼šTest1 â†’ Test2 â†’ Test3 â†’ Test4 (æ€»æ—¶é—´ï¼š40åˆ†é’Ÿ)
    â”œâ”€ Test1: 10åˆ†é’Ÿ
    â”œâ”€ Test2: 15åˆ†é’Ÿ  
    â”œâ”€ Test3: 8åˆ†é’Ÿ
    â””â”€ Test4: 7åˆ†é’Ÿ

å¹¶è¡Œæ‰§è¡Œï¼šå¹¶è¡Œ4ä¸ªçº¿ç¨‹ (æ€»æ—¶é—´ï¼š15åˆ†é’Ÿ)
Thread1: Test1 (10åˆ†é’Ÿ) 
Thread2: Test2 (15åˆ†é’Ÿ) â† æœ€é•¿çš„å†³å®šæ€»æ—¶é—´
Thread3: Test3 (8åˆ†é’Ÿ)  
Thread4: Test4 (7åˆ†é’Ÿ)  

æ—¶é—´èŠ‚çœï¼š40åˆ†é’Ÿ â†’ 15åˆ†é’Ÿ (èŠ‚çœ62.5%)
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**ï¼šå¹¶è¡Œæµ‹è¯•å¯èƒ½å¼•å…¥èµ„æºç«äº‰ã€æ•°æ®å†²çªç­‰é—®é¢˜

### 7.2 Jenkinså¹¶è¡Œæµ‹è¯•é…ç½®


**ğŸ”§ Jenkinså¹¶è¡ŒPipeline**
```groovy
pipeline {
    agent none
    
    stages {
        stage('å¹¶è¡Œæµ‹è¯•') {
            parallel {
                stage('å•å…ƒæµ‹è¯•') {
                    agent { label 'test-node-1' }
                    steps {
                        sh 'mvn test -Dtest=*UnitTest'
                    }
                }
                
                stage('é›†æˆæµ‹è¯•') {
                    agent { label 'test-node-2' }
                    steps {
                        sh 'mvn test -Dtest=*IntegrationTest'
                    }
                }
                
                stage('ç«¯åˆ°ç«¯æµ‹è¯•') {
                    agent { label 'test-node-3' }
                    steps {
                        sh 'mvn test -Dtest=*E2ETest'
                    }
                }
            }
        }
    }
}
```

### 7.3 Mavenå¹¶è¡Œæµ‹è¯•é…ç½®


**âš¡ Maven Surefireå¹¶è¡Œé…ç½®**
```xml
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-surefire-plugin</artifactId>
    <configuration>
        <!-- å¹¶è¡Œæ‰§è¡Œæ¨¡å¼ -->
        <parallel>methods</parallel>
        <!-- çº¿ç¨‹æ•°é…ç½® -->
        <threadCount>4</threadCount>
        <!-- æ¯ä¸ªæ ¸å¿ƒçš„çº¿ç¨‹æ•° -->
        <perCoreThreadCount>true</perCoreThreadCount>
        <!-- å¹¶è¡Œæµ‹è¯•è¶…æ—¶ -->
        <parallelTestsTimeoutInSeconds>300</parallelTestsTimeoutInSeconds>
        
        <!-- æµ‹è¯•åˆ†ç»„ï¼Œé¿å…å†²çª -->
        <groups>unit,integration</groups>
        <excludedGroups>slow</excludedGroups>
    </configuration>
</plugin>
```

### 7.4 å¹¶è¡Œæµ‹è¯•æœ€ä½³å®è·µ


**ğŸ¯ é¿å…æµ‹è¯•å†²çªç­–ç•¥**

| å†²çªç±»å‹ | **è§£å†³æ–¹æ¡ˆ** | **å®ç°æ–¹å¼** |
|---------|------------|-------------|
| **æ•°æ®åº“å†²çª** | `æ•°æ®éš”ç¦»` | `æ¯ä¸ªçº¿ç¨‹ä½¿ç”¨ç‹¬ç«‹æ•°æ®åº“schema` |
| **ç«¯å£å†²çª** | `åŠ¨æ€ç«¯å£` | `éšæœºåˆ†é…å¯ç”¨ç«¯å£` |
| **æ–‡ä»¶å†²çª** | `ä¸´æ—¶ç›®å½•` | `ä¸ºæ¯ä¸ªæµ‹è¯•åˆ›å»ºç‹¬ç«‹ä¸´æ—¶ç›®å½•` |
| **ç¼“å­˜å†²çª** | `å‘½åç©ºé—´` | `ä½¿ç”¨çº¿ç¨‹IDä½œä¸ºç¼“å­˜keyå‰ç¼€` |

**ğŸ”¸ æµ‹è¯•éš”ç¦»ç¤ºä¾‹**
```java
@TestMethodOrder(OrderAnnotation.class)
public class ParallelTest {
    
    // ä¸ºæ¯ä¸ªæµ‹è¯•çº¿ç¨‹åˆ›å»ºç‹¬ç«‹çš„æ•°æ®æº
    @TestConfiguration
    static class TestConfig {
        @Bean
        @Primary
        public DataSource testDataSource() {
            String threadId = Thread.currentThread().getName();
            String dbName = "test_db_" + threadId.replaceAll("[^a-zA-Z0-9]", "");
            
            return DataSourceBuilder.create()
                .url("jdbc:h2:mem:" + dbName + ";DB_CLOSE_DELAY=-1")
                .driverClassName("org.h2.Driver")
                .build();
        }
    }
}
```

---

## 8. ğŸ’¾ æµ‹è¯•æ•°æ®ç®¡ç†


### 8.1 æµ‹è¯•æ•°æ®ç­–ç•¥æ¦‚è§ˆ


**ğŸ”¸ æµ‹è¯•æ•°æ®ç®¡ç†æŒ‘æˆ˜**
```
æŒ‘æˆ˜æ¸…å•ï¼š
â”œâ”€ æ•°æ®ä¸€è‡´æ€§ï¼šæ¯æ¬¡æµ‹è¯•éƒ½è¦æœ‰ç›¸åŒçš„åˆå§‹çŠ¶æ€
â”œâ”€ æ•°æ®éš”ç¦»ï¼šä¸åŒæµ‹è¯•ä¹‹é—´ä¸èƒ½ç›¸äº’å½±å“  
â”œâ”€ æ•°æ®çœŸå®æ€§ï¼šæµ‹è¯•æ•°æ®è¦è´´è¿‘ç”Ÿäº§ç¯å¢ƒ
â”œâ”€ æ•°æ®å®‰å…¨ï¼šä¸èƒ½ä½¿ç”¨çœŸå®ç”¨æˆ·æ•°æ®
â””â”€ æ•°æ®ç»´æŠ¤ï¼šæµ‹è¯•æ•°æ®è¦æ˜“äºæ›´æ–°ç»´æŠ¤
```

> ğŸ’¡ **æ ¸å¿ƒåŸåˆ™**ï¼šæµ‹è¯•æ•°æ®åº”è¯¥æ˜¯**å¯é¢„æµ‹çš„ã€å¯é‡å¤çš„ã€å¯ç»´æŠ¤çš„**

### 8.2 æ•°æ®åº“æµ‹è¯•æ•°æ®ç®¡ç†


**ğŸ—„ï¸ æ•°æ®åº“åˆå§‹åŒ–ç­–ç•¥**
```sql
-- æµ‹è¯•æ•°æ®åˆå§‹åŒ–è„šæœ¬ (test-data.sql)

-- æ¸…ç†æ—§æ•°æ®
TRUNCATE TABLE orders;
TRUNCATE TABLE users;
TRUNCATE TABLE products;

-- æ’å…¥æµ‹è¯•ç”¨æˆ·
INSERT INTO users (id, username, email, status) VALUES
(1, 'testuser1', 'test1@example.com', 'ACTIVE'),
(2, 'testuser2', 'test2@example.com', 'ACTIVE'),
(3, 'testuser3', 'test3@example.com', 'INACTIVE');

-- æ’å…¥æµ‹è¯•å•†å“
INSERT INTO products (id, name, price, stock) VALUES
(1, 'æµ‹è¯•å•†å“A', 99.99, 100),
(2, 'æµ‹è¯•å•†å“B', 199.99, 50),
(3, 'æµ‹è¯•å•†å“C', 299.99, 0);

-- æ’å…¥æµ‹è¯•è®¢å•
INSERT INTO orders (id, user_id, product_id, quantity, status) VALUES
(1, 1, 1, 2, 'COMPLETED'),
(2, 2, 2, 1, 'PENDING'),
(3, 1, 3, 1, 'CANCELLED');
```

### 8.3 æµ‹è¯•æ•°æ®æ„å»ºå™¨æ¨¡å¼


**ğŸ—ï¸ Javaæµ‹è¯•æ•°æ®æ„å»ºå™¨**
```java
// æµ‹è¯•æ•°æ®æ„å»ºå™¨ï¼Œè®©æµ‹è¯•æ•°æ®åˆ›å»ºæ›´çµæ´»
public class TestDataBuilder {
    
    public static UserBuilder user() {
        return new UserBuilder();
    }
    
    public static class UserBuilder {
        private User user = new User();
        
        public UserBuilder withName(String name) {
            user.setName(name);
            return this;
        }
        
        public UserBuilder withEmail(String email) {
            user.setEmail(email);
            return this;
        }
        
        public UserBuilder active() {
            user.setStatus(UserStatus.ACTIVE);
            return this;
        }
        
        public User build() {
            // è®¾ç½®é»˜è®¤å€¼
            if (user.getName() == null) {
                user.setName("é»˜è®¤æµ‹è¯•ç”¨æˆ·");
            }
            if (user.getEmail() == null) {
                user.setEmail("test@example.com");
            }
            return user;
        }
    }
}

// ä½¿ç”¨ç¤ºä¾‹
@Test
public void testUserCreation() {
    // åˆ›å»ºæ´»è·ƒç”¨æˆ·
    User activeUser = TestDataBuilder.user()
        .withName("å¼ ä¸‰")
        .withEmail("zhangsan@test.com")
        .active()
        .build();
        
    // åˆ›å»ºé»˜è®¤ç”¨æˆ·ï¼ˆä½¿ç”¨é»˜è®¤å€¼ï¼‰
    User defaultUser = TestDataBuilder.user().build();
}
```

### 8.4 æµ‹è¯•æ•°æ®ç‰ˆæœ¬ç®¡ç†


**ğŸ“‹ æ•°æ®è¿ç§»è„šæœ¬ç®¡ç†**
```bash
# æµ‹è¯•æ•°æ®ç‰ˆæœ¬ç®¡ç†ç›®å½•ç»“æ„
test-data/
â”œâ”€â”€ migrations/
â”‚   â”œâ”€â”€ V1.0.0__initial_test_data.sql
â”‚   â”œâ”€â”€ V1.1.0__add_product_categories.sql
â”‚   â””â”€â”€ V1.2.0__update_user_profiles.sql
â”œâ”€â”€ fixtures/
â”‚   â”œâ”€â”€ users.json
â”‚   â”œâ”€â”€ products.json
â”‚   â””â”€â”€ orders.json
â””â”€â”€ generators/
    â”œâ”€â”€ generate_test_users.py
    â””â”€â”€ generate_test_orders.py
```

**ğŸ”„ æ•°æ®é‡ç½®è„šæœ¬**
```bash
#!/bin/bash
# reset-test-data.sh - é‡ç½®æµ‹è¯•æ•°æ®è„šæœ¬

echo "ğŸ”„ é‡ç½®æµ‹è¯•æ•°æ®..."

# åœæ­¢åº”ç”¨æœåŠ¡
docker-compose stop app

# é‡ç½®æ•°æ®åº“
mysql -h localhost -u root -p$DB_PASSWORD << EOF
DROP DATABASE IF EXISTS testdb;
CREATE DATABASE testdb;
USE testdb;
SOURCE test-schema.sql;
SOURCE test-data.sql;
EOF

# é‡å¯åº”ç”¨æœåŠ¡
docker-compose start app

echo "âœ… æµ‹è¯•æ•°æ®é‡ç½®å®Œæˆ"
```

---

## 9. ğŸš€ æ€§èƒ½æµ‹è¯•é›†æˆ


### 9.1 æ€§èƒ½æµ‹è¯•åŸºç¡€æ¦‚å¿µ


**ğŸ“Š æ€§èƒ½æµ‹è¯•ç±»å‹è¯´æ˜**
```
è´Ÿè½½æµ‹è¯•ï¼šæ¨¡æ‹Ÿæ­£å¸¸é¢„æœŸè´Ÿè½½ï¼ŒéªŒè¯ç³»ç»Ÿç¨³å®šæ€§
å‹åŠ›æµ‹è¯•ï¼šé€æ­¥å¢åŠ è´Ÿè½½ï¼Œæ‰¾åˆ°ç³»ç»Ÿæ€§èƒ½ä¸´ç•Œç‚¹  
å³°å€¼æµ‹è¯•ï¼šæ¨¡æ‹Ÿçªå‘é«˜å³°æµé‡ï¼Œæµ‹è¯•ç³»ç»Ÿå¼¹æ€§
å®¹é‡æµ‹è¯•ï¼šç¡®å®šç³»ç»Ÿæœ€å¤§å¤„ç†èƒ½åŠ›
ç¨³å®šæ€§æµ‹è¯•ï¼šé•¿æ—¶é—´è¿è¡Œï¼Œæ£€æµ‹å†…å­˜æ³„æ¼ç­‰é—®é¢˜
```

> ğŸ’¡ **é€šä¿—ç†è§£**ï¼šå°±åƒæµ‹è¯•æ±½è½¦æ€§èƒ½ï¼Œè¦æµ‹è¯•æ­£å¸¸è¡Œé©¶ã€é«˜é€Ÿè¡Œé©¶ã€æ»¡è½½è¡Œé©¶ç­‰ä¸åŒæƒ…å†µä¸‹çš„è¡¨ç°

### 9.2 JMeteræ€§èƒ½æµ‹è¯•é›†æˆ


**ğŸ”§ Jenkinsé›†æˆJMeter**
```groovy
pipeline {
    stages {
        stage('æ€§èƒ½æµ‹è¯•') {
            steps {
                script {
                    // å¯åŠ¨åº”ç”¨æœåŠ¡
                    sh 'docker-compose up -d app'
                    
                    // ç­‰å¾…æœåŠ¡å¯åŠ¨
                    sh 'sleep 30'
                    
                    // æ‰§è¡ŒJMeteræ€§èƒ½æµ‹è¯•
                    sh '''
                        jmeter -n -t performance-test.jmx \
                        -l results.jtl \
                        -e -o performance-report/
                    '''
                }
            }
            post {
                always {
                    // å‘å¸ƒæ€§èƒ½æµ‹è¯•æŠ¥å‘Š
                    publishHTML([
                        allowMissing: false,
                        alwaysLinkToLastBuild: true,
                        keepAll: true,
                        reportDir: 'performance-report',
                        reportFiles: 'index.html',
                        reportName: 'æ€§èƒ½æµ‹è¯•æŠ¥å‘Š'
                    ])
                    
                    // åˆ†ææ€§èƒ½æŒ‡æ ‡
                    script {
                        def avgResponseTime = sh(
                            script: "grep 'Avg:' results.jtl | awk '{sum+=\$2; count++} END {print sum/count}'",
                            returnStdout: true
                        ).trim()
                        
                        if (avgResponseTime.toFloat() > 1000) {
                            error "âŒ å¹³å‡å“åº”æ—¶é—´è¿‡é•¿ï¼š${avgResponseTime}ms"
                        } else {
                            echo "âœ… æ€§èƒ½æµ‹è¯•é€šè¿‡ï¼Œå¹³å‡å“åº”æ—¶é—´ï¼š${avgResponseTime}ms"
                        }
                    }
                }
            }
        }
    }
}
```

### 9.3 æ€§èƒ½åŸºå‡†çº¿è®¾å®š


**ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡é—¨ç¦**
```yaml
# æ€§èƒ½åŸºå‡†é…ç½® (performance-thresholds.yml)
performance_criteria:
  response_time:
    avg_threshold: 500ms      # å¹³å‡å“åº”æ—¶é—´
    p95_threshold: 1000ms     # 95%å“åº”æ—¶é—´
    max_threshold: 2000ms     # æœ€å¤§å“åº”æ—¶é—´
    
  throughput:
    min_rps: 100              # æœ€å°æ¯ç§’è¯·æ±‚æ•°
    target_rps: 500           # ç›®æ ‡æ¯ç§’è¯·æ±‚æ•°
    
  error_rate:
    max_error_rate: 1%        # æœ€å¤§é”™è¯¯ç‡
    
  resource_usage:
    max_cpu: 80%              # æœ€å¤§CPUä½¿ç”¨ç‡
    max_memory: 85%           # æœ€å¤§å†…å­˜ä½¿ç”¨ç‡
```

### 9.4 æ€§èƒ½æµ‹è¯•æœ€ä½³å®è·µ


**ğŸ¯ æ€§èƒ½æµ‹è¯•ç­–ç•¥**

**æµ‹è¯•ç¯å¢ƒè¦æ±‚**ï¼š
- âœ… **ç¡¬ä»¶è§„æ ¼**ï¼šä¸ç”Ÿäº§ç¯å¢ƒä¿æŒä¸€è‡´
- âœ… **ç½‘ç»œæ¡ä»¶**ï¼šæ¨¡æ‹ŸçœŸå®ç½‘ç»œå»¶è¿Ÿ
- âœ… **æ•°æ®è§„æ¨¡**ï¼šä½¿ç”¨æ¥è¿‘ç”Ÿäº§çš„æ•°æ®é‡
- âœ… **å¹¶å‘æ¨¡å¼**ï¼šæ¨¡æ‹ŸçœŸå®ç”¨æˆ·è¡Œä¸º

**ğŸ”¸ æ€§èƒ½ç›‘æ§é›†æˆ**
```bash
# æ€§èƒ½ç›‘æ§è„šæœ¬
#!/bin/bash

# å¯åŠ¨ç³»ç»Ÿç›‘æ§
nohup top -b -d 1 > cpu-usage.log &
nohup iostat -x 1 > disk-io.log &
nohup free -s 1 > memory-usage.log &

# æ‰§è¡Œæ€§èƒ½æµ‹è¯•
jmeter -n -t load-test.jmx -l results.jtl

# ç”Ÿæˆæ€§èƒ½æŠ¥å‘Š
python generate-performance-report.py \
  --jmeter-results results.jtl \
  --cpu-log cpu-usage.log \
  --memory-log memory-usage.log \
  --output-dir performance-report/
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æµ‹è¯•é‡‘å­—å¡”ï¼šå•å…ƒæµ‹è¯•(åŸºç¡€) â†’ é›†æˆæµ‹è¯•(ä¸­å±‚) â†’ ç«¯åˆ°ç«¯æµ‹è¯•(é¡¶å±‚)
ğŸ”¸ æµ‹è¯•ç±»å‹ï¼šåŠŸèƒ½æµ‹è¯•ã€æ€§èƒ½æµ‹è¯•ã€å®‰å…¨æµ‹è¯•å„æœ‰ç”¨é€”
ğŸ”¸ æµ‹è¯•ç¯å¢ƒï¼šéš”ç¦»æ€§ã€å¯é‡å¤æ€§ã€çœŸå®æ€§çš„å¹³è¡¡
ğŸ”¸ è¦†ç›–ç‡æŒ‡æ ‡ï¼šè¡Œè¦†ç›–ç‡ã€åˆ†æ”¯è¦†ç›–ç‡ã€å‡½æ•°è¦†ç›–ç‡å«ä¹‰
ğŸ”¸ å¤±è´¥å¤„ç†ï¼šåŒºåˆ†ä»£ç é—®é¢˜ã€ç¯å¢ƒé—®é¢˜ã€æµ‹è¯•é—®é¢˜
ğŸ”¸ å¹¶è¡Œä¼˜åŒ–ï¼šèµ„æºéš”ç¦»ã€æ•°æ®éš”ç¦»é¿å…å†²çª
ğŸ”¸ æ•°æ®ç®¡ç†ï¼šå¯é¢„æµ‹ã€å¯é‡å¤ã€å¯ç»´æŠ¤åŸåˆ™
ğŸ”¸ æ€§èƒ½åŸºå‡†ï¼šå“åº”æ—¶é—´ã€ååé‡ã€é”™è¯¯ç‡æŒ‡æ ‡
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆéœ€è¦è‡ªåŠ¨åŒ–æµ‹è¯•**
```
è´¨é‡ä¿éšœï¼š
- åŠæ—©å‘ç°é—®é¢˜ï¼Œé™ä½ä¿®å¤æˆæœ¬
- ä¿è¯æ¯æ¬¡å‘å¸ƒçš„ä»£ç è´¨é‡
- å‡å°‘ç”Ÿäº§ç¯å¢ƒbug

æ•ˆç‡æå‡ï¼š
- è§£æ”¾äººå·¥é‡å¤æµ‹è¯•å·¥ä½œ  
- 24å°æ—¶æ— äººå€¼å®ˆæ‰§è¡Œ
- å¿«é€Ÿåé¦ˆå¼€å‘ç»“æœ

ä¿¡å¿ƒå»ºç«‹ï¼š
- é‡æ„ä»£ç æ—¶æœ‰å®‰å…¨ç½‘
- æ–°åŠŸèƒ½ä¸ä¼šç ´åæ—§åŠŸèƒ½
- æŒç»­é›†æˆæŒç»­éƒ¨ç½²çš„åŸºç¡€
```

**ğŸ”¹ æµ‹è¯•ç­–ç•¥çš„å¹³è¡¡ç‚¹**
```
é€Ÿåº¦ vs å…¨é¢æ€§ï¼š
- å¿«é€Ÿæµ‹è¯•ï¼šå¿«é€Ÿåé¦ˆï¼Œè¦†ç›–æ ¸å¿ƒè·¯å¾„
- å…¨é¢æµ‹è¯•ï¼šè¦†ç›–è¾¹ç•Œæƒ…å†µï¼Œä½†æ‰§è¡Œè¾ƒæ…¢

æˆæœ¬ vs æ”¶ç›Šï¼š
- æµ‹è¯•ç»´æŠ¤æˆæœ¬è¦åˆç†
- å…³é”®ä¸šåŠ¡åŠŸèƒ½é‡ç‚¹æµ‹è¯•
- ä¸è¦ä¸ºäº†è¦†ç›–ç‡è€Œæµ‹è¯•

ç¨³å®šæ€§ vs çœŸå®æ€§ï¼š
- ç¨³å®šçš„æµ‹è¯•ç¯å¢ƒä¾¿äºè°ƒè¯•
- çœŸå®çš„ç¯å¢ƒå‘ç°æ›´å¤šé—®é¢˜
```

### 10.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ’¼ é€‚ç”¨åœºæ™¯åˆ¤æ–­**ï¼š
- âœ… **é€‚åˆè‡ªåŠ¨åŒ–**ï¼šé‡å¤æ‰§è¡Œã€å›å½’æµ‹è¯•ã€æ ¸å¿ƒåŠŸèƒ½
- âš ï¸ **è°¨æ…è‡ªåŠ¨åŒ–**ï¼šUIé¢‘ç¹å˜åŒ–ã€å¤æ‚ç”¨æˆ·äº¤äº’
- âŒ **ä¸é€‚åˆè‡ªåŠ¨åŒ–**ï¼šæ¢ç´¢æ€§æµ‹è¯•ã€ç”¨æˆ·ä½“éªŒæµ‹è¯•

**ğŸ”§ å·¥å…·é€‰æ‹©å»ºè®®**ï¼š
- **Jenkins**ï¼šæˆç†Ÿç¨³å®šï¼Œæ’ä»¶ä¸°å¯Œï¼Œé€‚åˆå¤æ‚åœºæ™¯
- **GitLab CI**ï¼šä¸Gitæ·±åº¦é›†æˆï¼Œé…ç½®ç®€å•ï¼Œé€‚åˆä¸­å°é¡¹ç›®
- **è¦†ç›–ç‡å·¥å…·**ï¼šJaCoCo(Java)ã€Coverage.py(Python)ã€Jest(Node.js)

**ğŸ“Š ç›‘æ§æŒ‡æ ‡é‡ç‚¹**ï¼š
- **æˆåŠŸç‡**ï¼šæ¯æ—¥æ„å»ºæˆåŠŸç‡ > 95%
- **æ‰§è¡Œæ—¶é—´**ï¼šæµ‹è¯•æ‰§è¡Œæ—¶é—´æ§åˆ¶åœ¨åˆç†èŒƒå›´
- **è¦†ç›–ç‡è¶‹åŠ¿**ï¼šé¿å…è¦†ç›–ç‡æŒç»­ä¸‹é™
- **å¤±è´¥åˆ†æ**ï¼šå¿«é€Ÿå®šä½å’Œè§£å†³æµ‹è¯•å¤±è´¥

### 10.4 å¸¸è§é—®é¢˜ä¸è§£å†³


```
æµ‹è¯•æ‰§è¡Œæ…¢ï¼š
â†’ å®æ–½å¹¶è¡Œæµ‹è¯•
â†’ ä¼˜åŒ–æµ‹è¯•ç”¨ä¾‹
â†’ ä½¿ç”¨æµ‹è¯•åˆ†å±‚ç­–ç•¥

æµ‹è¯•ä¸ç¨³å®šï¼š
â†’ æ”¹å–„æµ‹è¯•ç¯å¢ƒéš”ç¦»
â†’ å¢åŠ é‡è¯•æœºåˆ¶  
â†’ ä¿®å¤è„†å¼±çš„æµ‹è¯•ç”¨ä¾‹

ç»´æŠ¤æˆæœ¬é«˜ï¼š
â†’ é‡‡ç”¨é¡µé¢å¯¹è±¡æ¨¡å¼
â†’ æé«˜æµ‹è¯•ä»£ç å¤ç”¨
â†’ å®šæœŸé‡æ„æµ‹è¯•ä»£ç 

ç¯å¢ƒé—®é¢˜é¢‘å‘ï¼š
â†’ å®¹å™¨åŒ–æµ‹è¯•ç¯å¢ƒ
â†’ åŸºç¡€è®¾æ–½å³ä»£ç 
â†’ è‡ªåŠ¨åŒ–ç¯å¢ƒä¿®å¤
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- æµ‹è¯•é‡‘å­—å¡”ç¨³åŸºç¡€ï¼Œå•å…ƒé›†æˆç«¯åˆ°ç«¯
- ç¯å¢ƒéš”ç¦»æ•°æ®æ¸…ï¼Œå¹¶è¡Œæ‰§è¡Œæ•ˆç‡é«˜  
- è¦†ç›–é—¨ç¦è´¨é‡ä¿ï¼Œå¤±è´¥å¤„ç†è¦æ™ºèƒ½
- æŒç»­ç›‘æ§è¶‹åŠ¿æï¼Œè‡ªåŠ¨ä¿®å¤å‡äººå·¥