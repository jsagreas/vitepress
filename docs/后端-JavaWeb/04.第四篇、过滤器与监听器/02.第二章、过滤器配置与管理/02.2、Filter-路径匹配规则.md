---
title: 2、Filter-路径匹配规则
---
## 📚 目录

1. [路径匹配基础概念](#1-路径匹配基础概念)
2. [url-pattern精确匹配](#2-url-pattern精确匹配)
3. [通配符匹配规则](#3-通配符匹配规则)
4. [servlet-name绑定](#4-servlet-name绑定)
5. [扩展名匹配](#5-扩展名匹配)
6. [路径层级匹配](#6-路径层级匹配)
7. [优先级规则详解](#7-优先级规则详解)
8. [实际应用场景](#8-实际应用场景)
9. [核心要点总结](#9-核心要点总结)

---

## 1. 🎯 路径匹配基础概念


### 1.1 什么是路径匹配


**简单理解**：就像门卫一样，过滤器需要知道"我应该拦截哪些请求"，路径匹配就是告诉过滤器"什么样的网址我需要处理"。

```
比如你开了一家店：
- 有些客户我要特殊接待（VIP客户）
- 有些客户按正常流程处理  
- 路径匹配就是告诉店员："什么样的客户需要特殊处理"
```

**核心作用**：
- 🎯 **确定拦截范围** - 过滤器应该处理哪些请求
- ⚡ **提高处理效率** - 只处理需要的请求，避免不必要的处理
- 🔒 **精确控制** - 可以针对不同类型的请求做不同处理

### 1.2 路径匹配的工作原理


```
用户请求流程：
浏览器 → 发送请求(/user/login) → 服务器检查过滤器配置 → 匹配成功 → 执行过滤器

配置示例：
<url-pattern>/user/*</url-pattern>  ← 这就是路径匹配规则
```

**匹配过程**：
1. **接收请求** - 用户访问网页，服务器收到请求
2. **检查配置** - 服务器查看web.xml中的过滤器配置  
3. **模式匹配** - 将请求路径与url-pattern进行比较
4. **执行过滤** - 匹配成功的过滤器开始工作

---

## 2. 🎯 url-pattern精确匹配


### 2.1 精确匹配概念


**什么是精确匹配**：就像家门牌号一样，必须完全一模一样才能匹配。

```xml
<!-- 只匹配 /login 这个具体路径 -->
<filter-mapping>
    <filter-name>LoginFilter</filter-name>
    <url-pattern>/login</url-pattern>
</filter-mapping>
```

**匹配规则**：
- ✅ **完全相同** - 请求路径必须与配置完全一致
- ❌ **不能有差异** - 多一个字符或少一个字符都不匹配
- 🔍 **区分大小写** - `/Login`和`/login`是不同的路径

### 2.2 精确匹配示例


| 配置的url-pattern | ✅ 匹配的请求 | ❌ 不匹配的请求 |
|------------------|-------------|----------------|
| `/login` | `/login` | `/login/`, `/Login`, `/login.jsp` |
| `/user/profile` | `/user/profile` | `/user`, `/user/profile/edit` |
| `/admin/dashboard` | `/admin/dashboard` | `/admin`, `/admin/dashboard.html` |

```xml
<!-- 实际配置示例 -->
<filter>
    <filter-name>LoginCheckFilter</filter-name>
    <filter-class>com.example.LoginCheckFilter</filter-class>
</filter>

<filter-mapping>
    <filter-name>LoginCheckFilter</filter-name>
    <url-pattern>/admin/login</url-pattern>  <!-- 只拦截管理员登录页面 -->
</filter-mapping>
```

### 2.3 精确匹配的应用场景


**🎯 适用场景**：
- **特定页面控制** - 只对某个具体页面进行处理
- **关键接口保护** - 对重要的API接口进行单独控制
- **精确权限控制** - 需要对特定路径进行特殊处理

**实际应用**：
```xml
<!-- 示例：只对支付接口进行安全检查 -->
<filter-mapping>
    <filter-name>PaymentSecurityFilter</filter-name>
    <url-pattern>/api/payment/process</url-pattern>
</filter-mapping>
```

---

## 3. 🌟 通配符匹配规则


### 3.1 通配符的基本概念


**通配符匹配**：就像说"所有姓张的人"一样，用`*`号来代表"任意内容"。

```
生活中的类比：
- 张* → 张三、张四、张五（所有姓张的）
- *市 → 北京市、上海市、深圳市（所有以市结尾的）
```

**JavaWeb中的通配符**：
- `*` **星号** - 代表任意长度的任意字符
- 只能用在路径的开头或结尾，不能在中间

### 3.2 前缀匹配（路径匹配）


**格式**：`/路径前缀/*`

```xml
<!-- 匹配所有以/user开头的请求 -->
<url-pattern>/user/*</url-pattern>
```

**匹配示例**：

| 配置 | ✅ 匹配 | ❌ 不匹配 |
|------|---------|----------|
| `/user/*` | `/user/login`<br>`/user/profile`<br>`/user/list/all` | `/admin/user`<br>`/userinfo`<br>`/login` |
| `/admin/*` | `/admin/`<br>`/admin/dashboard`<br>`/admin/user/list` | `/user/admin`<br>`/administrator` |

```xml
<!-- 实际配置：管理后台所有页面都需要权限检查 -->
<filter-mapping>
    <filter-name>AdminAuthFilter</filter-name>
    <url-pattern>/admin/*</url-pattern>
</filter-mapping>
```

### 3.3 根路径匹配


**特殊情况**：`/*` 匹配所有请求

```xml
<!-- 拦截网站的所有请求 -->
<url-pattern>/*</url-pattern>
```

**⚠️ 注意事项**：
- **性能影响** - 每个请求都会经过这个过滤器
- **谨慎使用** - 容易影响系统性能
- **常用场景** - 字符编码过滤器、日志记录过滤器

```xml
<!-- 典型应用：字符编码过滤器 -->
<filter>
    <filter-name>CharacterEncodingFilter</filter-name>
    <filter-class>com.example.CharacterEncodingFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>CharacterEncodingFilter</filter-name>
    <url-pattern>/*</url-pattern>  <!-- 所有请求都需要设置编码 -->
</filter-mapping>
```

---

## 4. 🔗 servlet-name绑定


### 4.1 servlet-name绑定概念


**什么是servlet-name绑定**：不是根据访问路径，而是根据具体的Servlet名称来决定是否拦截。

```
类比理解：
路径匹配 → 按门牌号找房子（/user/login）
servlet-name绑定 → 按房主姓名找房子（UserServlet）
```

**工作原理**：
1. **请求到达** - 用户访问某个路径
2. **路径映射** - 服务器找到处理这个路径的Servlet
3. **名称匹配** - 检查这个Servlet的名称是否在过滤器绑定列表中
4. **执行过滤** - 名称匹配则执行过滤器

### 4.2 servlet-name绑定配置


```xml
<!-- 先定义一个Servlet -->
<servlet>
    <servlet-name>UserServlet</servlet-name>
    <servlet-class>com.example.UserServlet</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>UserServlet</servlet-name>
    <url-pattern>/user/action</url-pattern>
</servlet-mapping>

<!-- 过滤器绑定到这个Servlet -->
<filter-mapping>
    <filter-name>UserFilter</filter-name>
    <servlet-name>UserServlet</servlet-name>  <!-- 绑定到UserServlet -->
</filter-mapping>
```

**绑定关系图**：
```
请求流程：
用户访问 /user/action → 找到 UserServlet → 检查过滤器绑定 → 发现UserFilter绑定了UserServlet → 执行过滤器
```

### 4.3 servlet-name绑定的优势


**🎯 主要优势**：
- **精确控制** - 只针对特定的Servlet进行过滤
- **灵活配置** - 可以一个过滤器绑定多个Servlet
- **维护方便** - Servlet路径改变不影响过滤器配置

```xml
<!-- 一个过滤器绑定多个Servlet -->
<filter-mapping>
    <filter-name>SecurityFilter</filter-name>
    <servlet-name>UserServlet</servlet-name>
</filter-mapping>
<filter-mapping>
    <filter-name>SecurityFilter</filter-name>
    <servlet-name>AdminServlet</servlet-name>
</filter-mapping>
```

**应用场景**：
- **模块化开发** - 按功能模块配置过滤器
- **权限分离** - 不同Servlet需要不同的权限检查
- **特殊处理** - 某些Servlet需要特殊的预处理或后处理

---

## 5. 📁 扩展名匹配


### 5.1 扩展名匹配概念


**扩展名匹配**：根据文件的后缀名来决定是否拦截，就像"所有.doc文件用Word打开"一样。

```
生活中的类比：
- 所有.mp3文件 → 音乐播放器处理
- 所有.jpg文件 → 图片查看器处理
- 所有.jsp文件 → JSP过滤器处理
```

**格式规则**：`*.扩展名`

### 5.2 扩展名匹配配置


```xml
<!-- 匹配所有JSP页面 -->
<filter-mapping>
    <filter-name>JSPFilter</filter-name>
    <url-pattern>*.jsp</url-pattern>
</filter-mapping>

<!-- 匹配所有do请求（一般是Servlet请求） -->
<filter-mapping>
    <filter-name>ActionFilter</filter-name>
    <url-pattern>*.do</url-pattern>
</filter-mapping>
```

**匹配示例表格**：

| 配置 | ✅ 匹配的请求 | ❌ 不匹配的请求 |
|------|-------------|----------------|
| `*.jsp` | `/login.jsp`<br>`/user/profile.jsp`<br>`/admin/dashboard.jsp` | `/login.html`<br>`/user/profile`<br>`/jsp/test` |
| `*.do` | `/user.do`<br>`/login.do`<br>`/admin/user.do` | `/user.action`<br>`/do/test`<br>`/user.jsp` |
| `*.action` | `/user.action`<br>`/admin/login.action` | `/user.do`<br>`/action/test` |

### 5.3 扩展名匹配应用场景


**🔧 典型应用**：

```xml
<!-- 所有JSP页面统一设置字符编码 -->
<filter>
    <filter-name>JSPEncodingFilter</filter-name>
    <filter-class>com.example.JSPEncodingFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>JSPEncodingFilter</filter-name>
    <url-pattern>*.jsp</url-pattern>
</filter-mapping>

<!-- 所有API接口统一进行日志记录 -->
<filter-mapping>
    <filter-name>APILogFilter</filter-name>
    <url-pattern>*.api</url-pattern>
</filter-mapping>
```

**实际使用场景**：
- **JSP页面处理** - 统一处理所有JSP页面的编码、权限等
- **API接口管理** - 对所有API接口进行统一的日志记录、权限检查
- **文件上传处理** - 对特定类型的文件请求进行处理
- **静态资源过滤** - 对图片、CSS、JS等静态资源进行特殊处理

---

## 6. 🏗️ 路径层级匹配


### 6.1 路径层级的概念


**路径层级**：就像文件夹的层级结构，网址也有层级关系。

```
文件系统类比：
C:/用户/张三/文档/工作/报告.docx
网址层级：
/user/profile/edit/personal
层级1: user
层级2: profile  
层级3: edit
层级4: personal
```

### 6.2 不同层级的匹配规则


**层级匹配示例**：

```xml
<!-- 一级路径匹配 -->
<url-pattern>/user/*</url-pattern>
<!-- 匹配：/user/xxx，但不限制xxx的内容和层级 -->

<!-- 多级路径的精确匹配 -->
<url-pattern>/user/profile/edit</url-pattern>
<!-- 只匹配：/user/profile/edit -->
```

**匹配层级对比**：

| 配置类型 | 配置示例 | 匹配范围 | 实际匹配 |
|---------|----------|----------|----------|
| 一级通配 | `/user/*` | user下的所有 | `/user/login`<br>`/user/profile`<br>`/user/admin/panel` |
| 二级精确 | `/user/profile` | 精确匹配 | 只匹配`/user/profile` |
| 二级通配 | `/user/admin/*` | user/admin下的所有 | `/user/admin/login`<br>`/user/admin/dashboard` |

### 6.3 层级匹配的实际应用


```xml
<!-- 用户相关的所有页面 -->
<filter-mapping>
    <filter-name>UserAreaFilter</filter-name>
    <url-pattern>/user/*</url-pattern>
</filter-mapping>

<!-- 管理后台的具体功能模块 -->
<filter-mapping>
    <filter-name>AdminUserFilter</filter-name>
    <url-pattern>/admin/user/*</url-pattern>
</filter-mapping>

<!-- API接口按版本分组 -->
<filter-mapping>
    <filter-name>APIv1Filter</filter-name>
    <url-pattern>/api/v1/*</url-pattern>
</filter-mapping>
```

**层级规划建议**：
```
建议的路径层级结构：
/模块名/功能组/具体功能

示例：
/user/profile/edit     - 用户资料编辑
/user/account/setting  - 账户设置
/admin/user/list      - 管理员-用户列表
/admin/system/config  - 管理员-系统配置
/api/v1/user/info     - API v1版本-用户信息
```

---

## 7. ⚖️ 优先级规则详解


### 7.1 匹配优先级概念


**为什么需要优先级**：当一个请求可能匹配多个过滤器配置时，系统需要知道按什么顺序执行。

```
比如请求：/user/login.jsp

可能匹配的配置：
1. /user/login.jsp     (精确匹配)
2. /user/*            (路径匹配)  
3. *.jsp              (扩展名匹配)
4. /*                 (全局匹配)

问题：哪个优先级更高？
```

### 7.2 优先级排序规则


**JavaWeb过滤器优先级顺序**（从高到低）：

```
优先级排序：
1️⃣ 精确匹配 > 2️⃣ 路径匹配 > 3️⃣ 扩展名匹配 > 4️⃣ 默认匹配(/)
```

**详细说明**：

| 优先级 | 匹配类型 | 示例 | 说明 |
|--------|----------|------|------|
| **最高** | 精确匹配 | `/user/login` | 完全一致的路径 |
| **第二** | 路径匹配 | `/user/*` | 路径前缀匹配 |  
| **第三** | 扩展名匹配 | `*.jsp` | 文件扩展名匹配 |
| **最低** | 默认匹配 | `/` | 兜底匹配 |

### 7.3 优先级实际示例


**场景模拟**：用户访问`/user/profile.jsp`

```xml
<!-- 配置了多个过滤器 -->
<filter-mapping>
    <filter-name>Filter1</filter-name>
    <url-pattern>/user/profile.jsp</url-pattern>  <!-- 精确匹配 -->
</filter-mapping>

<filter-mapping>
    <filter-name>Filter2</filter-name>
    <url-pattern>/user/*</url-pattern>           <!-- 路径匹配 -->
</filter-mapping>

<filter-mapping>
    <filter-name>Filter3</filter-name>
    <url-pattern>*.jsp</url-pattern>             <!-- 扩展名匹配 -->
</filter-mapping>

<filter-mapping>
    <filter-name>Filter4</filter-name>
    <url-pattern>/*</url-pattern>                <!-- 全局匹配 -->
</filter-mapping>
```

**执行结果**：
```
1. Filter1 先执行 (精确匹配优先级最高)
2. Filter2 再执行 (路径匹配次之)
3. Filter3 接着执行 (扩展名匹配)  
4. Filter4 最后执行 (全局匹配优先级最低)
```

### 7.4 同级优先级的处理


**同级别的配置**：在web.xml中的**声明顺序**决定执行顺序

```xml
<!-- 两个都是路径匹配，按声明顺序执行 -->
<filter-mapping>
    <filter-name>UserFilter</filter-name>      <!-- 先执行 -->
    <url-pattern>/user/*</url-pattern>
</filter-mapping>

<filter-mapping>
    <filter-name>SecurityFilter</filter-name>   <!-- 后执行 -->
    <url-pattern>/user/*</url-pattern>
</filter-mapping>
```

**⚠️ 重要提醒**：
- **顺序很重要** - 过滤器的执行顺序会影响最终结果
- **合理规划** - 应该根据业务逻辑合理安排过滤器顺序
- **避免冲突** - 多个过滤器修改同一内容时要特别注意

---

## 8. 🎪 实际应用场景


### 8.1 权限控制场景


```xml
<!-- 管理后台权限控制 -->
<filter>
    <filter-name>AdminAuthFilter</filter-name>
    <filter-class>com.example.AdminAuthFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>AdminAuthFilter</filter-name>
    <url-pattern>/admin/*</url-pattern>  <!-- 所有管理页面都需要权限检查 -->
</filter-mapping>

<!-- VIP用户专区 -->
<filter-mapping>
    <filter-name>VIPAuthFilter</filter-name>
    <url-pattern>/vip/*</url-pattern>
</filter-mapping>

<!-- 登录页面不需要权限检查 -->
<filter-mapping>
    <filter-name>LoginFilter</filter-name>
    <url-pattern>/admin/login</url-pattern>  <!-- 精确匹配登录页 -->
</filter-mapping>
```

### 8.2 功能模块分组


```xml
<!-- 用户模块 -->
<filter-mapping>
    <filter-name>UserModuleFilter</filter-name>
    <url-pattern>/user/*</url-pattern>
</filter-mapping>

<!-- 订单模块 -->  
<filter-mapping>
    <filter-name>OrderModuleFilter</filter-name>
    <url-pattern>/order/*</url-pattern>
</filter-mapping>

<!-- API接口分组 -->
<filter-mapping>
    <filter-name>APILogFilter</filter-name>
    <url-pattern>/api/*</url-pattern>
</filter-mapping>
```

### 8.3 文件类型处理


```xml
<!-- 图片文件处理 -->
<filter-mapping>
    <filter-name>ImageFilter</filter-name>
    <url-pattern>*.jpg</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>ImageFilter</filter-name>
    <url-pattern>*.png</url-pattern>
</filter-mapping>

<!-- JSP页面统一处理 -->
<filter-mapping>
    <filter-name>JSPFilter</filter-name>
    <url-pattern>*.jsp</url-pattern>
</filter-mapping>

<!-- 下载文件处理 -->
<filter-mapping>
    <filter-name>DownloadFilter</filter-name>
    <url-pattern>*.zip</url-pattern>
</filter-mapping>
```

### 8.4 复合配置策略


```xml
<!-- 策略组合示例 -->

<!-- 1. 全局字符编码过滤器（最底层） -->
<filter-mapping>
    <filter-name>EncodingFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>

<!-- 2. 管理后台权限控制（中层） -->
<filter-mapping>
    <filter-name>AdminAuthFilter</filter-name>
    <url-pattern>/admin/*</url-pattern>
</filter-mapping>

<!-- 3. 特殊页面单独处理（顶层） -->
<filter-mapping>
    <filter-name>SpecialPageFilter</filter-name>
    <url-pattern>/admin/special-page</url-pattern>
</filter-mapping>
```

---

## 9. 📋 核心要点总结


### 9.1 必须掌握的核心概念


```
🎯 路径匹配的本质：告诉过滤器"拦截哪些请求"
🔍 匹配类型：精确匹配、通配符匹配、扩展名匹配、servlet-name绑定
⚖️ 优先级规则：精确 > 路径 > 扩展名 > 默认
🎪 实际应用：权限控制、模块分组、文件类型处理
```

### 9.2 关键理解要点


**🔹 匹配类型的选择原则**
```
精确匹配：用于特定页面的特殊处理
路径匹配：用于模块化的功能分组
扩展名匹配：用于文件类型的统一处理  
servlet-name绑定：用于精确的Servlet控制
```

**🔹 优先级规则的记忆方法**
```
记忆口诀：越具体优先级越高
精确匹配 → 最具体（完全一样）
路径匹配 → 较具体（前缀一样）
扩展名匹配 → 一般具体（后缀一样）
默认匹配 → 最不具体（什么都匹配）
```

### 9.3 实际应用指导


**🔧 配置规划建议**：
```
1. 全局过滤器（编码、日志）→ 使用 /*
2. 模块过滤器（权限、功能）→ 使用 /模块名/*  
3. 特殊页面处理 → 使用精确匹配
4. 文件类型处理 → 使用 *.扩展名
```

**⚠️ 常见注意事项**：
- **性能考虑** - 避免过多的`/*`全局过滤器
- **顺序规划** - 合理安排过滤器的执行顺序
- **冲突避免** - 注意多个过滤器之间的相互影响
- **测试验证** - 配置完成后要充分测试各种路径

**💡 最佳实践**：
- **模块化配置** - 按业务功能模块组织过滤器
- **分层设计** - 基础功能用通配符，特殊功能用精确匹配
- **文档记录** - 详细记录每个过滤器的作用和匹配规则
- **定期维护** - 随着业务发展及时调整过滤器配置

**核心记忆**：
- 路径匹配就是告诉过滤器"管哪些请求"
- 越具体的匹配规则优先级越高
- 合理的配置能让系统更高效、更安全
- 实际应用中要根据业务需求灵活选择匹配方式