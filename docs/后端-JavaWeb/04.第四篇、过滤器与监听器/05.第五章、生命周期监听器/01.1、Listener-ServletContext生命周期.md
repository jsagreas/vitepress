---
title: 1ã€Listener-ServletContextç”Ÿå‘½å‘¨æœŸ
---
## ğŸ“š ç›®å½•

1. [ç”Ÿå‘½å‘¨æœŸç›‘å¬å™¨æ¦‚è¿°](#1-ç”Ÿå‘½å‘¨æœŸç›‘å¬å™¨æ¦‚è¿°)
2. [ServletContextListeneræ¥å£è¯¦è§£](#2-ServletContextListeneræ¥å£è¯¦è§£)
3. [åº”ç”¨å¯åŠ¨ç›‘å¬å¤„ç†](#3-åº”ç”¨å¯åŠ¨ç›‘å¬å¤„ç†)
4. [åº”ç”¨é”€æ¯ç›‘å¬å¤„ç†](#4-åº”ç”¨é”€æ¯ç›‘å¬å¤„ç†)
5. [å…¨å±€èµ„æºç®¡ç†å®æˆ˜](#5-å…¨å±€èµ„æºç®¡ç†å®æˆ˜)
6. [å¯åŠ¨å¤±è´¥å¤„ç†ç­–ç•¥](#6-å¯åŠ¨å¤±è´¥å¤„ç†ç­–ç•¥)
7. [æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹](#7-æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒŸ ç”Ÿå‘½å‘¨æœŸç›‘å¬å™¨æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯ç”Ÿå‘½å‘¨æœŸç›‘å¬å™¨


**é€šä¿—ç†è§£**ï¼šå°±åƒæˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­çš„"ç®¡å®¶"ä¸€æ ·ï¼Œç›‘å¬å™¨è´Ÿè´£åœ¨Webåº”ç”¨å¯åŠ¨å’Œå…³é—­æ—¶åšä¸€äº›é‡è¦çš„äº‹æƒ…ã€‚

```
ç°å®ç”Ÿæ´»ç±»æ¯”ï¼š
å•†åº—ç®¡å®¶çš„èŒè´£ï¼š
å¼€é—¨å‰ â†’ æ‰“å¼€ç”µæºã€å‡†å¤‡å•†å“ã€æ£€æŸ¥è®¾å¤‡
å…³é—¨å â†’ å…³é—­ç”µæºã€æ¸…ç‚¹è´§ç‰©ã€é”å¥½é—¨çª—

ServletContextç”Ÿå‘½å‘¨æœŸç›‘å¬å™¨ï¼š
åº”ç”¨å¯åŠ¨å‰ â†’ åˆå§‹åŒ–èµ„æºã€åŠ è½½é…ç½®ã€å‡†å¤‡ç¯å¢ƒ  
åº”ç”¨å…³é—­å‰ â†’ æ¸…ç†èµ„æºã€ä¿å­˜æ•°æ®ã€é‡Šæ”¾è¿æ¥
```

**æ ¸å¿ƒä½œç”¨**ï¼š
- ğŸ”¸ **åº”ç”¨å¯åŠ¨æ—¶**ï¼šåšå¥½å‡†å¤‡å·¥ä½œï¼Œè®©åº”ç”¨èƒ½æ­£å¸¸è¿è¡Œ
- ğŸ”¸ **åº”ç”¨å…³é—­æ—¶**ï¼šåšå¥½æ”¶å°¾å·¥ä½œï¼Œé¿å…èµ„æºæ³„éœ²
- ğŸ”¸ **å…¨å±€ç®¡ç†**ï¼šå¤„ç†æ•´ä¸ªåº”ç”¨éƒ½éœ€è¦çš„å…¬å…±èµ„æº

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦ç”Ÿå‘½å‘¨æœŸç›‘å¬å™¨


**å®é™…éœ€æ±‚åœºæ™¯**ï¼š
```
ğŸ¯ å…¸å‹åº”ç”¨åœºæ™¯ï¼š

æ•°æ®åº“è¿æ¥æ± åˆå§‹åŒ–ï¼š
- åº”ç”¨å¯åŠ¨æ—¶åˆ›å»ºè¿æ¥æ± 
- åº”ç”¨å…³é—­æ—¶å…³é—­æ‰€æœ‰è¿æ¥

å®šæ—¶ä»»åŠ¡ç®¡ç†ï¼š
- å¯åŠ¨æ—¶å¼€å¯å®šæ—¶ä»»åŠ¡
- å…³é—­æ—¶åœæ­¢æ‰€æœ‰ä»»åŠ¡

ç¼“å­˜ç³»ç»Ÿåˆå§‹åŒ–ï¼š
- å¯åŠ¨æ—¶é¢„çƒ­ç¼“å­˜
- å…³é—­æ—¶æŒä¹…åŒ–ç¼“å­˜æ•°æ®

ç³»ç»Ÿé…ç½®åŠ è½½ï¼š
- å¯åŠ¨æ—¶åŠ è½½é…ç½®æ–‡ä»¶
- è¿è¡Œä¸­ç›‘æ§é…ç½®å˜åŒ–
```

### 1.3 ç”Ÿå‘½å‘¨æœŸç›‘å¬å™¨çš„å·¥ä½œæ—¶æœº


**æ—¶æœºå›¾ç¤º**ï¼š
```
Webå®¹å™¨å¯åŠ¨æµç¨‹ï¼š

1. å®¹å™¨å¯åŠ¨
   â†“
2. åˆ›å»ºServletContextå¯¹è±¡
   â†“
3. ğŸ”¥ è§¦å‘contextInitializedäº‹ä»¶ â† æˆ‘ä»¬åœ¨è¿™é‡Œåšåˆå§‹åŒ–
   â†“
4. åˆå§‹åŒ–Servlet
   â†“
5. åº”ç”¨æ­£å¸¸è¿è¡Œ
   â†“
6. å®¹å™¨å‡†å¤‡å…³é—­
   â†“
7. ğŸ”¥ è§¦å‘contextDestroyedäº‹ä»¶ â† æˆ‘ä»¬åœ¨è¿™é‡Œåšæ¸…ç†
   â†“
8. é”€æ¯ServletContextå¯¹è±¡
   â†“
9. å®¹å™¨å…³é—­
```

---

## 2. ğŸ”§ ServletContextListeneræ¥å£è¯¦è§£


### 2.1 æ¥å£åŸºæœ¬ç»“æ„


**æ¥å£å®šä¹‰**ï¼š
```java
package javax.servlet;

public interface ServletContextListener extends EventListener {
    // åº”ç”¨å¯åŠ¨æ—¶è°ƒç”¨
    void contextInitialized(ServletContextEvent event);
    
    // åº”ç”¨é”€æ¯æ—¶è°ƒç”¨
    void contextDestroyed(ServletContextEvent event);
}
```

**é€šä¿—è§£é‡Š**ï¼š
- è¿™ä¸ªæ¥å£å°±åƒä¸€ä¸ª**çº¦å®š**ï¼Œå‘Šè¯‰æˆ‘ä»¬éœ€è¦å®ç°å“ªä¸¤ä¸ªæ–¹æ³•
- `contextInitialized` = "ä¸Šä¸‹æ–‡åˆå§‹åŒ–å®Œæˆ" = åº”ç”¨å¯åŠ¨äº†
- `contextDestroyed` = "ä¸Šä¸‹æ–‡è¢«é”€æ¯" = åº”ç”¨è¦å…³é—­äº†

### 2.2 ServletContextEventäº‹ä»¶å¯¹è±¡


**äº‹ä»¶å¯¹è±¡çš„ä½œç”¨**ï¼š
```java
public class ServletContextEvent extends EventObject {
    // è·å–ServletContextå¯¹è±¡
    public ServletContext getServletContext() { ... }
}
```

**å®é™…ä½¿ç”¨ç¤ºä¾‹**ï¼š
```java
@Override
public void contextInitialized(ServletContextEvent event) {
    // è·å–ServletContextï¼Œè¿™æ˜¯æ•´ä¸ªWebåº”ç”¨çš„ä¸Šä¸‹æ–‡ç¯å¢ƒ
    ServletContext context = event.getServletContext();
    
    // å¯ä»¥é€šè¿‡contextåšå¾ˆå¤šäº‹æƒ…ï¼š
    // 1. è·å–åº”ç”¨çš„çœŸå®è·¯å¾„
    String realPath = context.getRealPath("/");
    
    // 2. è®¾ç½®å…¨å±€å±æ€§
    context.setAttribute("appStartTime", new Date());
    
    // 3. è·å–åˆå§‹åŒ–å‚æ•°
    String dbUrl = context.getInitParameter("database.url");
}
```

### 2.3 åˆ›å»ºç›‘å¬å™¨çš„åŸºæœ¬æ­¥éª¤


**æ­¥éª¤æ¦‚è§ˆ**ï¼š
```
ç¬¬1æ­¥ï¼šåˆ›å»ºJavaç±»
ç¬¬2æ­¥ï¼šå®ç°ServletContextListeneræ¥å£  
ç¬¬3æ­¥ï¼šé‡å†™ä¸¤ä¸ªæ ¸å¿ƒæ–¹æ³•
ç¬¬4æ­¥ï¼šé…ç½®ç›‘å¬å™¨ï¼ˆæ³¨è§£æˆ–XMLï¼‰
ç¬¬5æ­¥ï¼šéƒ¨ç½²æµ‹è¯•
```

**æœ€ç®€å•çš„ç›‘å¬å™¨ç¤ºä¾‹**ï¼š
```java
// ä½¿ç”¨æ³¨è§£æ–¹å¼é…ç½®ï¼Œç®€å•ç›´æ¥
@WebListener
public class AppLifecycleListener implements ServletContextListener {
    
    @Override
    public void contextInitialized(ServletContextEvent event) {
        System.out.println("ğŸš€ Webåº”ç”¨å¯åŠ¨äº†ï¼");
        // åœ¨è¿™é‡Œåšå¯åŠ¨æ—¶çš„å·¥ä½œ
    }
    
    @Override
    public void contextDestroyed(ServletContextEvent event) {
        System.out.println("ğŸ›‘ Webåº”ç”¨è¦å…³é—­äº†ï¼");
        // åœ¨è¿™é‡Œåšå…³é—­æ—¶çš„å·¥ä½œ
    }
}
```

---

## 3. ğŸš€ åº”ç”¨å¯åŠ¨ç›‘å¬å¤„ç†


### 3.1 contextInitializedæ–¹æ³•è¯¦è§£


**æ–¹æ³•ä½œç”¨æ—¶æœº**ï¼š
- âœ… **ServletContextåˆ›å»ºå®Œæˆåç«‹å³è°ƒç”¨**
- âœ… **åœ¨æ‰€æœ‰Servletåˆå§‹åŒ–ä¹‹å‰è°ƒç”¨**  
- âœ… **æ•´ä¸ªåº”ç”¨ä¸­åªä¼šè°ƒç”¨ä¸€æ¬¡**

**å…¸å‹çš„åˆå§‹åŒ–ä»»åŠ¡**ï¼š

#### ğŸ“‹ ç³»ç»Ÿé…ç½®åŠ è½½

```java
@Override
public void contextInitialized(ServletContextEvent event) {
    ServletContext context = event.getServletContext();
    
    // 1. åŠ è½½æ•°æ®åº“é…ç½®
    Properties dbConfig = new Properties();
    try {
        // ä»ç±»è·¯å¾„åŠ è½½é…ç½®æ–‡ä»¶
        InputStream input = getClass().getResourceAsStream("/db.properties");
        dbConfig.load(input);
        
        // å°†é…ç½®å­˜å‚¨åˆ°åº”ç”¨ä¸Šä¸‹æ–‡ä¸­ï¼Œä¾›å…¶ä»–ç»„ä»¶ä½¿ç”¨
        context.setAttribute("dbConfig", dbConfig);
        
        System.out.println("âœ… æ•°æ®åº“é…ç½®åŠ è½½æˆåŠŸ");
    } catch (IOException e) {
        System.err.println("âŒ é…ç½®æ–‡ä»¶åŠ è½½å¤±è´¥: " + e.getMessage());
    }
}
```

#### ğŸ”— æ•°æ®åº“è¿æ¥æ± åˆå§‹åŒ–

```java
@Override
public void contextInitialized(ServletContextEvent event) {
    ServletContext context = event.getServletContext();
    
    try {
        // åˆ›å»ºæ•°æ®åº“è¿æ¥æ± ï¼ˆè¿™é‡Œç”¨HikariCPåšç¤ºä¾‹ï¼‰
        HikariConfig config = new HikariConfig();
        config.setJdbcUrl("jdbc:mysql://localhost:3306/mydb");
        config.setUsername("root");
        config.setPassword("password");
        config.setMaximumPoolSize(20); // æœ€å¤§20ä¸ªè¿æ¥
        
        HikariDataSource dataSource = new HikariDataSource(config);
        
        // å°†è¿æ¥æ± å­˜å‚¨åˆ°ä¸Šä¸‹æ–‡ä¸­
        context.setAttribute("dataSource", dataSource);
        
        System.out.println("âœ… æ•°æ®åº“è¿æ¥æ± åˆå§‹åŒ–æˆåŠŸï¼Œæœ€å¤§è¿æ¥æ•°ï¼š20");
    } catch (Exception e) {
        System.err.println("âŒ æ•°æ®åº“è¿æ¥æ± åˆå§‹åŒ–å¤±è´¥: " + e.getMessage());
    }
}
```

### 3.2 å¯åŠ¨æ—¶é—´è®°å½•ä¸ç›‘æ§


**å¯åŠ¨æ—¶é—´ç»Ÿè®¡**ï¼š
```java
@WebListener
public class StartupMonitorListener implements ServletContextListener {
    
    @Override
    public void contextInitialized(ServletContextEvent event) {
        long startTime = System.currentTimeMillis();
        ServletContext context = event.getServletContext();
        
        System.out.println("ğŸ“… åº”ç”¨å¯åŠ¨æ—¶é—´: " + new Date());
        
        // æ¨¡æ‹Ÿä¸€äº›åˆå§‹åŒ–å·¥ä½œ
        initializeResources(context);
        
        long endTime = System.currentTimeMillis();
        long duration = endTime - startTime;
        
        // è®°å½•å¯åŠ¨è€—æ—¶
        context.setAttribute("startupDuration", duration);
        System.out.println("â±ï¸ åº”ç”¨å¯åŠ¨è€—æ—¶: " + duration + "æ¯«ç§’");
    }
    
    private void initializeResources(ServletContext context) {
        // æ¨¡æ‹Ÿå„ç§èµ„æºåˆå§‹åŒ–
        try {
            Thread.sleep(1000); // æ¨¡æ‹Ÿ1ç§’çš„åˆå§‹åŒ–æ—¶é—´
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
    }
    
    @Override
    public void contextDestroyed(ServletContextEvent event) {
        System.out.println("ğŸ‘‹ åº”ç”¨æ­£åœ¨å…³é—­...");
    }
}
```

### 3.3 ç³»ç»Ÿå¥åº·æ£€æŸ¥


**å¯åŠ¨æ—¶è‡ªæ£€æœºåˆ¶**ï¼š
```java
@Override
public void contextInitialized(ServletContextEvent event) {
    ServletContext context = event.getServletContext();
    boolean systemHealthy = true;
    
    // 1. æ£€æŸ¥å¿…è¦çš„ç›®å½•æ˜¯å¦å­˜åœ¨
    String uploadPath = context.getRealPath("/uploads");
    File uploadDir = new File(uploadPath);
    if (!uploadDir.exists()) {
        if (uploadDir.mkdirs()) {
            System.out.println("âœ… åˆ›å»ºä¸Šä¼ ç›®å½•æˆåŠŸ: " + uploadPath);
        } else {
            System.err.println("âŒ åˆ›å»ºä¸Šä¼ ç›®å½•å¤±è´¥: " + uploadPath);
            systemHealthy = false;
        }
    }
    
    // 2. æ£€æŸ¥æ•°æ®åº“è¿æ¥
    if (!testDatabaseConnection()) {
        System.err.println("âŒ æ•°æ®åº“è¿æ¥æµ‹è¯•å¤±è´¥");
        systemHealthy = false;
    } else {
        System.out.println("âœ… æ•°æ®åº“è¿æ¥æ­£å¸¸");
    }
    
    // 3. è®¾ç½®ç³»ç»ŸçŠ¶æ€æ ‡å¿—
    context.setAttribute("systemHealthy", systemHealthy);
    
    if (systemHealthy) {
        System.out.println("ğŸ‰ ç³»ç»Ÿå¯åŠ¨å®Œæˆï¼Œæ‰€æœ‰æ£€æŸ¥é€šè¿‡ï¼");
    } else {
        System.err.println("âš ï¸ ç³»ç»Ÿå¯åŠ¨å®Œæˆï¼Œä½†å­˜åœ¨é—®é¢˜ï¼Œè¯·æ£€æŸ¥æ—¥å¿—");
    }
}

private boolean testDatabaseConnection() {
    // ç®€å•çš„æ•°æ®åº“è¿æ¥æµ‹è¯•
    try {
        // è¿™é‡Œç®€åŒ–å¤„ç†ï¼Œå®é™…åº”è¯¥ä»è¿æ¥æ± è·å–è¿æ¥æµ‹è¯•
        return true;
    } catch (Exception e) {
        return false;
    }
}
```

---

## 4. ğŸ›‘ åº”ç”¨é”€æ¯ç›‘å¬å¤„ç†


### 4.1 contextDestroyedæ–¹æ³•è¯¦è§£


**æ–¹æ³•è°ƒç”¨æ—¶æœº**ï¼š
- âœ… **åº”ç”¨æ­£å¸¸å…³é—­æ—¶è°ƒç”¨**
- âœ… **æœåŠ¡å™¨å…³é—­æ—¶è°ƒç”¨**
- âœ… **åº”ç”¨é‡æ–°éƒ¨ç½²æ—¶è°ƒç”¨**

**é”€æ¯æ—¶çš„æ ¸å¿ƒä»»åŠ¡**ï¼š

#### ğŸ”Œ èµ„æºè¿æ¥é‡Šæ”¾

```java
@Override
public void contextDestroyed(ServletContextEvent event) {
    ServletContext context = event.getServletContext();
    
    // 1. å…³é—­æ•°æ®åº“è¿æ¥æ± 
    HikariDataSource dataSource = (HikariDataSource) context.getAttribute("dataSource");
    if (dataSource != null && !dataSource.isClosed()) {
        dataSource.close();
        System.out.println("âœ… æ•°æ®åº“è¿æ¥æ± å·²å…³é—­");
    }
    
    // 2. å…³é—­å…¶ä»–èµ„æºè¿æ¥
    closeRedisConnection(context);
    closeElasticsearchConnection(context);
    
    System.out.println("ğŸ”Œ æ‰€æœ‰èµ„æºè¿æ¥å·²é‡Šæ”¾");
}

private void closeRedisConnection(ServletContext context) {
    // å…³é—­Redisè¿æ¥çš„ç¤ºä¾‹ä»£ç 
    Object redisPool = context.getAttribute("redisPool");
    if (redisPool != null) {
        // å®é™…å…³é—­é€»è¾‘
        System.out.println("âœ… Redisè¿æ¥æ± å·²å…³é—­");
    }
}
```

#### â° å®šæ—¶ä»»åŠ¡åœæ­¢

```java
@Override
public void contextDestroyed(ServletContextEvent event) {
    ServletContext context = event.getServletContext();
    
    // åœæ­¢æ‰€æœ‰å®šæ—¶ä»»åŠ¡
    ScheduledExecutorService scheduler = 
        (ScheduledExecutorService) context.getAttribute("scheduler");
    
    if (scheduler != null && !scheduler.isShutdown()) {
        scheduler.shutdown(); // æ¸©å’Œå…³é—­
        
        try {
            // ç­‰å¾…30ç§’è®©ä»»åŠ¡å®Œæˆ
            if (!scheduler.awaitTermination(30, TimeUnit.SECONDS)) {
                scheduler.shutdownNow(); // å¼ºåˆ¶å…³é—­
                System.out.println("âš ï¸ å¼ºåˆ¶å…³é—­å®šæ—¶ä»»åŠ¡");
            } else {
                System.out.println("âœ… å®šæ—¶ä»»åŠ¡å·²æ­£å¸¸å…³é—­");
            }
        } catch (InterruptedException e) {
            scheduler.shutdownNow();
            Thread.currentThread().interrupt();
        }
    }
}
```

### 4.2 ä¼˜é›…å…³é—­å¤„ç†


**å…³é—­é¡ºåºçš„é‡è¦æ€§**ï¼š
```java
@Override
public void contextDestroyed(ServletContextEvent event) {
    System.out.println("ğŸ›‘ å¼€å§‹åº”ç”¨å…³é—­æµç¨‹...");
    
    try {
        // ç¬¬1æ­¥ï¼šåœæ­¢æ¥æ”¶æ–°è¯·æ±‚ï¼ˆå¦‚æœæœ‰è´Ÿè½½å‡è¡¡å™¨ï¼‰
        markApplicationAsShuttingDown();
        
        // ç¬¬2æ­¥ï¼šç­‰å¾…ç°æœ‰è¯·æ±‚å¤„ç†å®Œæˆ
        waitForActiveRequestsToComplete();
        
        // ç¬¬3æ­¥ï¼šåœæ­¢å®šæ—¶ä»»åŠ¡
        stopScheduledTasks();
        
        // ç¬¬4æ­¥ï¼šä¿å­˜é‡è¦æ•°æ®
        saveImportantData();
        
        // ç¬¬5æ­¥ï¼šé‡Šæ”¾èµ„æºè¿æ¥
        closeAllConnections();
        
        System.out.println("âœ… åº”ç”¨å…³é—­æµç¨‹å®Œæˆ");
        
    } catch (Exception e) {
        System.err.println("âŒ å…³é—­è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯: " + e.getMessage());
    }
}

private void waitForActiveRequestsToComplete() {
    // ç»™æ­£åœ¨å¤„ç†çš„è¯·æ±‚ä¸€äº›æ—¶é—´å®Œæˆ
    try {
        Thread.sleep(5000); // ç­‰å¾…5ç§’
        System.out.println("â±ï¸ ç­‰å¾…ç°æœ‰è¯·æ±‚å¤„ç†å®Œæˆ");
    } catch (InterruptedException e) {
        Thread.currentThread().interrupt();
    }
}
```

---

## 5. ğŸŒ å…¨å±€èµ„æºç®¡ç†å®æˆ˜


### 5.1 æ•°æ®åº“è¿æ¥æ± ç®¡ç†


**å®Œæ•´çš„è¿æ¥æ± ç”Ÿå‘½å‘¨æœŸç®¡ç†**ï¼š
```java
@WebListener
public class DatabaseManager implements ServletContextListener {
    
    private static final String DATASOURCE_KEY = "appDataSource";
    
    @Override
    public void contextInitialized(ServletContextEvent event) {
        ServletContext context = event.getServletContext();
        
        try {
            // ä»web.xmlæˆ–æ³¨è§£ä¸­è·å–æ•°æ®åº“é…ç½®
            String dbUrl = context.getInitParameter("db.url");
            String dbUser = context.getInitParameter("db.username"); 
            String dbPassword = context.getInitParameter("db.password");
            
            // åˆ›å»ºè¿æ¥æ± é…ç½®
            HikariConfig config = new HikariConfig();
            config.setJdbcUrl(dbUrl);
            config.setUsername(dbUser);
            config.setPassword(dbPassword);
            
            // è¿æ¥æ± ä¼˜åŒ–é…ç½®
            config.setMaximumPoolSize(20);        // æœ€å¤§è¿æ¥æ•°
            config.setMinimumIdle(5);             // æœ€å°ç©ºé—²è¿æ¥
            config.setConnectionTimeout(30000);   // è¿æ¥è¶…æ—¶30ç§’
            config.setIdleTimeout(600000);        // ç©ºé—²è¶…æ—¶10åˆ†é’Ÿ
            config.setMaxLifetime(1800000);       // è¿æ¥æœ€å¤§å­˜æ´»30åˆ†é’Ÿ
            
            // åˆ›å»ºæ•°æ®æº
            HikariDataSource dataSource = new HikariDataSource(config);
            
            // æµ‹è¯•è¿æ¥
            try (Connection conn = dataSource.getConnection()) {
                System.out.println("âœ… æ•°æ®åº“è¿æ¥æ± åˆ›å»ºæˆåŠŸ");
                System.out.println("ğŸ“Š è¿æ¥æ± çŠ¶æ€: æœ€å¤§=" + config.getMaximumPoolSize() + 
                                 ", æœ€å°ç©ºé—²=" + config.getMinimumIdle());
            }
            
            // å­˜å‚¨åˆ°ä¸Šä¸‹æ–‡
            context.setAttribute(DATASOURCE_KEY, dataSource);
            
        } catch (Exception e) {
            System.err.println("âŒ æ•°æ®åº“è¿æ¥æ± åˆå§‹åŒ–å¤±è´¥: " + e.getMessage());
            throw new RuntimeException("æ— æ³•åˆå§‹åŒ–æ•°æ®åº“è¿æ¥æ± ", e);
        }
    }
    
    @Override
    public void contextDestroyed(ServletContextEvent event) {
        ServletContext context = event.getServletContext();
        
        // å…³é—­è¿æ¥æ± 
        HikariDataSource dataSource = (HikariDataSource) context.getAttribute(DATASOURCE_KEY);
        if (dataSource != null && !dataSource.isClosed()) {
            dataSource.close();
            System.out.println("âœ… æ•°æ®åº“è¿æ¥æ± å·²å…³é—­");
        }
    }
    
    // æä¾›ç»™å…¶ä»–ç»„ä»¶ä½¿ç”¨çš„é™æ€æ–¹æ³•
    public static DataSource getDataSource(ServletContext context) {
        return (DataSource) context.getAttribute(DATASOURCE_KEY);
    }
}
```

### 5.2 é…ç½®æ–‡ä»¶ç®¡ç†


**é›†ä¸­åŒ–é…ç½®ç®¡ç†**ï¼š
```java
@WebListener
public class ConfigurationManager implements ServletContextListener {
    
    private static final String CONFIG_KEY = "appConfig";
    
    @Override
    public void contextInitialized(ServletContextEvent event) {
        ServletContext context = event.getServletContext();
        
        // åˆ›å»ºé…ç½®å¯¹è±¡
        Properties appConfig = new Properties();
        
        try {
            // åŠ è½½å¤šä¸ªé…ç½®æ–‡ä»¶
            loadConfigFile(appConfig, "/database.properties");
            loadConfigFile(appConfig, "/redis.properties"); 
            loadConfigFile(appConfig, "/application.properties");
            
            // å¤„ç†ç¯å¢ƒå˜é‡è¦†ç›–
            loadEnvironmentOverrides(appConfig);
            
            // å­˜å‚¨é…ç½®
            context.setAttribute(CONFIG_KEY, appConfig);
            
            // æ‰“å°å…³é”®é…ç½®ä¿¡æ¯ï¼ˆæ³¨æ„ä¸è¦æ‰“å°æ•æ„Ÿä¿¡æ¯ï¼‰
            System.out.println("âœ… é…ç½®æ–‡ä»¶åŠ è½½å®Œæˆ");
            System.out.println("ğŸ“‹ å½“å‰ç¯å¢ƒ: " + appConfig.getProperty("app.environment", "development"));
            
        } catch (Exception e) {
            System.err.println("âŒ é…ç½®æ–‡ä»¶åŠ è½½å¤±è´¥: " + e.getMessage());
            throw new RuntimeException("æ— æ³•åŠ è½½åº”ç”¨é…ç½®", e);
        }
    }
    
    private void loadConfigFile(Properties config, String fileName) throws IOException {
        try (InputStream input = getClass().getResourceAsStream(fileName)) {
            if (input != null) {
                config.load(input);
                System.out.println("ğŸ“ å·²åŠ è½½é…ç½®æ–‡ä»¶: " + fileName);
            } else {
                System.out.println("âš ï¸ é…ç½®æ–‡ä»¶ä¸å­˜åœ¨: " + fileName);
            }
        }
    }
    
    private void loadEnvironmentOverrides(Properties config) {
        // å…è®¸ç¯å¢ƒå˜é‡è¦†ç›–é…ç½®æ–‡ä»¶ä¸­çš„å€¼
        String dbUrl = System.getenv("DB_URL");
        if (dbUrl != null) {
            config.setProperty("db.url", dbUrl);
            System.out.println("ğŸ”„ ä½¿ç”¨ç¯å¢ƒå˜é‡è¦†ç›–æ•°æ®åº“URL");
        }
    }
    
    @Override
    public void contextDestroyed(ServletContextEvent event) {
        System.out.println("ğŸ“‹ é…ç½®ç®¡ç†å™¨å·²æ¸…ç†");
    }
    
    // è·å–é…ç½®çš„å·¥å…·æ–¹æ³•
    public static String getConfig(ServletContext context, String key) {
        Properties config = (Properties) context.getAttribute(CONFIG_KEY);
        return config != null ? config.getProperty(key) : null;
    }
    
    public static String getConfig(ServletContext context, String key, String defaultValue) {
        Properties config = (Properties) context.getAttribute(CONFIG_KEY);
        return config != null ? config.getProperty(key, defaultValue) : defaultValue;
    }
}
```

### 5.3 ç¼“å­˜ç³»ç»Ÿåˆå§‹åŒ–


**å†…å­˜ç¼“å­˜ç®¡ç†ç¤ºä¾‹**ï¼š
```java
@WebListener  
public class CacheManager implements ServletContextListener {
    
    private static final String CACHE_KEY = "appCache";
    
    @Override
    public void contextInitialized(ServletContextEvent event) {
        ServletContext context = event.getServletContext();
        
        // åˆ›å»ºç®€å•çš„å†…å­˜ç¼“å­˜ï¼ˆå®é™…é¡¹ç›®ä¸­å¯èƒ½ç”¨Redisã€Ehcacheç­‰ï¼‰
        Map<String, Object> cache = new ConcurrentHashMap<>();
        
        // é¢„åŠ è½½ä¸€äº›å¸¸ç”¨æ•°æ®
        preloadCacheData(cache);
        
        // å­˜å‚¨ç¼“å­˜å¼•ç”¨
        context.setAttribute(CACHE_KEY, cache);
        
        System.out.println("âœ… ç¼“å­˜ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ");
        System.out.println("ğŸ“Š é¢„åŠ è½½ç¼“å­˜é¡¹æ•°é‡: " + cache.size());
    }
    
    private void preloadCacheData(Map<String, Object> cache) {
        // é¢„åŠ è½½å­—å…¸æ•°æ®ã€é…ç½®ä¿¡æ¯ç­‰
        cache.put("app.version", "1.0.0");
        cache.put("app.name", "æˆ‘çš„Webåº”ç”¨");
        cache.put("cache.init.time", System.currentTimeMillis());
        
        // è¿™é‡Œå¯ä»¥ä»æ•°æ®åº“åŠ è½½ä¸€äº›å¸¸ç”¨çš„å­—å…¸æ•°æ®
        // loadDictionaryData(cache);
    }
    
    @Override
    public void contextDestroyed(ServletContextEvent event) {
        ServletContext context = event.getServletContext();
        
        @SuppressWarnings("unchecked")
        Map<String, Object> cache = (Map<String, Object>) context.getAttribute(CACHE_KEY);
        
        if (cache != null) {
            // ä¿å­˜é‡è¦ç¼“å­˜æ•°æ®åˆ°æŒä¹…åŒ–å­˜å‚¨ï¼ˆå¦‚æœéœ€è¦ï¼‰
            saveCacheData(cache);
            
            // æ¸…ç©ºç¼“å­˜
            cache.clear();
            System.out.println("âœ… ç¼“å­˜å·²æ¸…ç†");
        }
    }
    
    private void saveCacheData(Map<String, Object> cache) {
        // è¿™é‡Œå¯ä»¥å°†é‡è¦çš„ç¼“å­˜æ•°æ®ä¿å­˜åˆ°æ•°æ®åº“æˆ–æ–‡ä»¶
        System.out.println("ğŸ’¾ ç¼“å­˜æ•°æ®å·²ä¿å­˜");
    }
    
    // å·¥å…·æ–¹æ³•
    @SuppressWarnings("unchecked")
    public static Map<String, Object> getCache(ServletContext context) {
        return (Map<String, Object>) context.getAttribute(CACHE_KEY);
    }
}
```

---

## 6. âš ï¸ å¯åŠ¨å¤±è´¥å¤„ç†ç­–ç•¥


### 6.1 å¼‚å¸¸å¤„ç†ä¸æ¢å¤æœºåˆ¶


**å¥å£®çš„å¯åŠ¨è¿‡ç¨‹**ï¼š
```java
@WebListener
public class RobustStartupListener implements ServletContextListener {
    
    @Override
    public void contextInitialized(ServletContextEvent event) {
        ServletContext context = event.getServletContext();
        List<String> initErrors = new ArrayList<>();
        
        // 1. æ•°æ®åº“åˆå§‹åŒ–ï¼ˆå…³é”®ç»„ä»¶ï¼‰
        if (!initDatabase(context)) {
            initErrors.add("æ•°æ®åº“åˆå§‹åŒ–å¤±è´¥");
        }
        
        // 2. ç¼“å­˜åˆå§‹åŒ–ï¼ˆå¯é€‰ç»„ä»¶ï¼‰
        if (!initCache(context)) {
            initErrors.add("ç¼“å­˜åˆå§‹åŒ–å¤±è´¥ï¼ˆå½±å“æ€§èƒ½ï¼Œä½†ä¸å½±å“åŸºæœ¬åŠŸèƒ½ï¼‰");
            // è®¾ç½®é™çº§æ ‡å¿—
            context.setAttribute("cacheAvailable", false);
        }
        
        // 3. å¤–éƒ¨æœåŠ¡è¿æ¥ï¼ˆå¯é€‰ç»„ä»¶ï¼‰
        if (!initExternalServices(context)) {
            initErrors.add("å¤–éƒ¨æœåŠ¡è¿æ¥å¤±è´¥ï¼ˆéƒ¨åˆ†åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨ï¼‰");
            context.setAttribute("externalServicesAvailable", false);
        }
        
        // 4. æ ¹æ®é”™è¯¯æƒ…å†µå†³å®šå¯åŠ¨ç­–ç•¥
        handleStartupResult(context, initErrors);
    }
    
    private boolean initDatabase(ServletContext context) {
        try {
            // æ•°æ®åº“åˆå§‹åŒ–é€»è¾‘
            System.out.println("ğŸ”— æ­£åœ¨åˆå§‹åŒ–æ•°æ®åº“è¿æ¥...");
            
            // æ¨¡æ‹Ÿæ•°æ®åº“è¿æ¥æµ‹è¯•
            Thread.sleep(1000);
            
            context.setAttribute("databaseAvailable", true);
            System.out.println("âœ… æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ");
            return true;
            
        } catch (Exception e) {
            System.err.println("âŒ æ•°æ®åº“åˆå§‹åŒ–å¤±è´¥: " + e.getMessage());
            context.setAttribute("databaseAvailable", false);
            return false;
        }
    }
    
    private boolean initCache(ServletContext context) {
        try {
            System.out.println("ğŸ’¾ æ­£åœ¨åˆå§‹åŒ–ç¼“å­˜ç³»ç»Ÿ...");
            
            // æ¨¡æ‹Ÿç¼“å­˜åˆå§‹åŒ–
            Thread.sleep(500);
            
            context.setAttribute("cacheAvailable", true);
            System.out.println("âœ… ç¼“å­˜ç³»ç»Ÿåˆå§‹åŒ–æˆåŠŸ");
            return true;
            
        } catch (Exception e) {
            System.err.println("âš ï¸ ç¼“å­˜ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥: " + e.getMessage());
            context.setAttribute("cacheAvailable", false);
            return false;
        }
    }
    
    private boolean initExternalServices(ServletContext context) {
        try {
            System.out.println("ğŸŒ æ­£åœ¨è¿æ¥å¤–éƒ¨æœåŠ¡...");
            
            // æ¨¡æ‹Ÿå¤–éƒ¨æœåŠ¡è¿æ¥
            Thread.sleep(800);
            
            context.setAttribute("externalServicesAvailable", true);
            System.out.println("âœ… å¤–éƒ¨æœåŠ¡è¿æ¥æˆåŠŸ");
            return true;
            
        } catch (Exception e) {
            System.err.println("âš ï¸ å¤–éƒ¨æœåŠ¡è¿æ¥å¤±è´¥: " + e.getMessage());
            context.setAttribute("externalServicesAvailable", false);
            return false;
        }
    }
    
    private void handleStartupResult(ServletContext context, List<String> errors) {
        if (errors.isEmpty()) {
            // å®Œç¾å¯åŠ¨
            context.setAttribute("appStatus", "HEALTHY");
            System.out.println("ğŸ‰ åº”ç”¨å¯åŠ¨æˆåŠŸï¼Œæ‰€æœ‰ç»„ä»¶æ­£å¸¸ï¼");
            
        } else if ((Boolean) context.getAttribute("databaseAvailable")) {
            // æ•°æ®åº“æ­£å¸¸ï¼Œå…¶ä»–ç»„ä»¶å¯èƒ½æœ‰é—®é¢˜ï¼Œä½†åº”ç”¨å¯ä»¥è¿è¡Œ
            context.setAttribute("appStatus", "DEGRADED");
            System.out.println("âš ï¸ åº”ç”¨å¯åŠ¨å®Œæˆï¼Œä½†å­˜åœ¨ä»¥ä¸‹é—®é¢˜:");
            for (String error : errors) {
                System.out.println("   - " + error);
            }
            System.out.println("âœ… æ ¸å¿ƒåŠŸèƒ½å¯æ­£å¸¸ä½¿ç”¨");
            
        } else {
            // æ•°æ®åº“éƒ½è¿ä¸ä¸Šï¼Œåº”ç”¨æ— æ³•æ­£å¸¸å·¥ä½œ
            context.setAttribute("appStatus", "FAILED");
            System.err.println("âŒ åº”ç”¨å¯åŠ¨å¤±è´¥ï¼Œæ ¸å¿ƒç»„ä»¶å¼‚å¸¸:");
            for (String error : errors) {
                System.err.println("   - " + error);
            }
            
            // å¯ä»¥é€‰æ‹©æŠ›å‡ºå¼‚å¸¸é˜»æ­¢åº”ç”¨å¯åŠ¨
            // throw new RuntimeException("åº”ç”¨å¯åŠ¨å¤±è´¥");
        }
    }
    
    @Override
    public void contextDestroyed(ServletContextEvent event) {
        System.out.println("ğŸ›‘ åº”ç”¨å…³é—­ä¸­...");
    }
}
```

### 6.2 å¯åŠ¨çŠ¶æ€ç›‘æ§


**åº”ç”¨å¥åº·çŠ¶æ€æ£€æŸ¥**ï¼š
```java
@WebServlet("/health")
public class HealthCheckServlet extends HttpServlet {
    
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) 
            throws ServletException, IOException {
        
        ServletContext context = getServletContext();
        
        // è·å–åº”ç”¨çŠ¶æ€
        String appStatus = (String) context.getAttribute("appStatus");
        Boolean dbAvailable = (Boolean) context.getAttribute("databaseAvailable");
        Boolean cacheAvailable = (Boolean) context.getAttribute("cacheAvailable");
        
        // æ„å»ºå¥åº·æ£€æŸ¥å“åº”
        resp.setContentType("application/json;charset=UTF-8");
        
        if ("HEALTHY".equals(appStatus)) {
            resp.setStatus(200);
            resp.getWriter().println("{");
            resp.getWriter().println("  \"status\": \"healthy\",");
            resp.getWriter().println("  \"database\": true,");
            resp.getWriter().println("  \"cache\": " + cacheAvailable + ",");
            resp.getWriter().println("  \"message\": \"æ‰€æœ‰ç³»ç»Ÿæ­£å¸¸\"");
            resp.getWriter().println("}");
            
        } else if ("DEGRADED".equals(appStatus)) {
            resp.setStatus(200); // ä»ç„¶å¯ä»¥æœåŠ¡ï¼Œä½†æœ‰è­¦å‘Š
            resp.getWriter().println("{");
            resp.getWriter().println("  \"status\": \"degraded\",");
            resp.getWriter().println("  \"database\": " + dbAvailable + ",");
            resp.getWriter().println("  \"cache\": " + cacheAvailable + ",");
            resp.getWriter().println("  \"message\": \"éƒ¨åˆ†åŠŸèƒ½å—é™ï¼Œä½†æ ¸å¿ƒåŠŸèƒ½æ­£å¸¸\"");
            resp.getWriter().println("}");
            
        } else {
            resp.setStatus(503); // æœåŠ¡ä¸å¯ç”¨
            resp.getWriter().println("{");
            resp.getWriter().println("  \"status\": \"failed\",");
            resp.getWriter().println("  \"database\": " + dbAvailable + ",");
            resp.getWriter().println("  \"cache\": " + cacheAvailable + ",");
            resp.getWriter().println("  \"message\": \"ç³»ç»Ÿå¼‚å¸¸ï¼Œè¯·è”ç³»ç®¡ç†å‘˜\"");
            resp.getWriter().println("}");
        }
    }
}
```

---

## 7. ğŸ’¡ æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹


### 7.1 æ€§èƒ½ä¼˜åŒ–å»ºè®®


**å¯åŠ¨æ€§èƒ½ä¼˜åŒ–**ï¼š

| ä¼˜åŒ–é¡¹ç›® | **é—®é¢˜** | **è§£å†³æ–¹æ¡ˆ** | **æ•ˆæœ** |
|---------|----------|-------------|----------|
| ğŸ”¸ **å¹¶è¡Œåˆå§‹åŒ–** | `ä¸²è¡Œåˆå§‹åŒ–è€—æ—¶é•¿` | `æ— ä¾èµ–çš„ç»„ä»¶å¯ä»¥å¹¶è¡Œåˆå§‹åŒ–` | `å‡å°‘30-50%å¯åŠ¨æ—¶é—´` |
| ğŸ”¸ **æ‡’åŠ è½½** | `å¯åŠ¨æ—¶åŠ è½½æ‰€æœ‰æ•°æ®` | `åªåŠ è½½å¿…è¦æ•°æ®ï¼Œå…¶ä»–å»¶è¿ŸåŠ è½½` | `å‡å°‘å†…å­˜å ç”¨` |
| ğŸ”¸ **è¿æ¥æ± é¢„çƒ­** | `é¦–æ¬¡è¯·æ±‚æ…¢` | `å¯åŠ¨æ—¶åˆ›å»ºæœ€å°è¿æ¥æ•°` | `æå‡é¦–æ¬¡å“åº”é€Ÿåº¦` |
| ğŸ”¸ **é…ç½®ç¼“å­˜** | `é‡å¤è¯»å–é…ç½®æ–‡ä»¶` | `å¯åŠ¨æ—¶ä¸€æ¬¡æ€§åŠ è½½åˆ°å†…å­˜` | `å‡å°‘IOæ“ä½œ` |

**å¹¶è¡Œåˆå§‹åŒ–ç¤ºä¾‹**ï¼š
```java
@Override
public void contextInitialized(ServletContextEvent event) {
    ServletContext context = event.getServletContext();
    
    // ä½¿ç”¨çº¿ç¨‹æ± å¹¶è¡Œåˆå§‹åŒ–ç‹¬ç«‹ç»„ä»¶
    ExecutorService executor = Executors.newFixedThreadPool(3);
    
    // æäº¤åˆå§‹åŒ–ä»»åŠ¡
    Future<Boolean> dbTask = executor.submit(() -> initDatabase(context));
    Future<Boolean> cacheTask = executor.submit(() -> initCache(context));
    Future<Boolean> configTask = executor.submit(() -> loadConfig(context));
    
    try {
        // ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆï¼ˆæœ€å¤šç­‰å¾…30ç§’ï¼‰
        boolean dbOk = dbTask.get(30, TimeUnit.SECONDS);
        boolean cacheOk = cacheTask.get(30, TimeUnit.SECONDS);  
        boolean configOk = configTask.get(30, TimeUnit.SECONDS);
        
        System.out.println("âœ… å¹¶è¡Œåˆå§‹åŒ–å®Œæˆ: DB=" + dbOk + ", Cache=" + cacheOk + ", Config=" + configOk);
        
    } catch (Exception e) {
        System.err.println("âŒ åˆå§‹åŒ–è¶…æ—¶æˆ–å¼‚å¸¸: " + e.getMessage());
    } finally {
        executor.shutdown();
    }
}
```

### 7.2 å¸¸è§é™·é˜±ä¸é¿å…æ–¹æ³•


**âš ï¸ å¸¸è§é—®é¢˜åˆ—è¡¨**ï¼š

```
1. åˆå§‹åŒ–é¡ºåºé—®é¢˜ï¼š
âŒ é”™è¯¯ï¼šAç»„ä»¶ä¾èµ–Bç»„ä»¶ï¼Œä½†Aå…ˆåˆå§‹åŒ–
âœ… æ­£ç¡®ï¼šå»ºç«‹æ˜ç¡®çš„ä¾èµ–å…³ç³»ï¼ŒæŒ‰ä¾èµ–é¡ºåºåˆå§‹åŒ–

2. èµ„æºæ³„éœ²é—®é¢˜ï¼š
âŒ é”™è¯¯ï¼šåªåœ¨åˆå§‹åŒ–æ—¶åˆ›å»ºèµ„æºï¼Œé”€æ¯æ—¶å¿˜è®°é‡Šæ”¾
âœ… æ­£ç¡®ï¼šæ¯ä¸ªåˆ›å»ºçš„èµ„æºéƒ½è¦æœ‰å¯¹åº”çš„æ¸…ç†ä»£ç 

3. å¼‚å¸¸å¤„ç†ä¸å½“ï¼š
âŒ é”™è¯¯ï¼šåˆå§‹åŒ–å¼‚å¸¸ç›´æ¥æŠ›å‡ºï¼Œå¯¼è‡´åº”ç”¨æ— æ³•å¯åŠ¨
âœ… æ­£ç¡®ï¼šåŒºåˆ†å…³é”®ç»„ä»¶å’Œå¯é€‰ç»„ä»¶ï¼Œé‡‡ç”¨é™çº§ç­–ç•¥

4. é…ç½®ç¡¬ç¼–ç ï¼š
âŒ é”™è¯¯ï¼šå°†é…ç½®ä¿¡æ¯ç¡¬ç¼–ç åœ¨ç›‘å¬å™¨ä¸­
âœ… æ­£ç¡®ï¼šä»é…ç½®æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡è¯»å–é…ç½®
```

### 7.3 ç›‘å¬å™¨é…ç½®æ–¹å¼å¯¹æ¯”


**æ³¨è§£é…ç½® vs XMLé…ç½®**ï¼š

| é…ç½®æ–¹å¼ | **ä¼˜ç‚¹** | **ç¼ºç‚¹** | **é€‚ç”¨åœºæ™¯** |
|---------|----------|----------|-------------|
| ğŸ”¸ **@WebListeneræ³¨è§£** | `ç®€å•ç›´æ¥ï¼Œä»£ç å³é…ç½®` | `ä¿®æ”¹éœ€è¦é‡æ–°ç¼–è¯‘` | `å¼€å‘é˜¶æ®µï¼Œé…ç½®ç®€å•çš„é¡¹ç›®` |
| ğŸ”¸ **web.xmlé…ç½®** | `æ— éœ€é‡æ–°ç¼–è¯‘ï¼Œçµæ´»é…ç½®` | `é…ç½®ç›¸å¯¹å¤æ‚` | `ç”Ÿäº§ç¯å¢ƒï¼Œéœ€è¦çµæ´»é…ç½®çš„é¡¹ç›®` |

**XMLé…ç½®ç¤ºä¾‹**ï¼š
```xml
<!-- web.xmlä¸­é…ç½®ç›‘å¬å™¨ -->
<web-app>
    <!-- é…ç½®åˆå§‹åŒ–å‚æ•° -->
    <context-param>
        <param-name>database.url</param-name>
        <param-value>jdbc:mysql://localhost:3306/mydb</param-value>
    </context-param>
    
    <context-param>
        <param-name>database.username</param-name>
        <param-value>root</param-value>
    </context-param>
    
    <!-- é…ç½®ç›‘å¬å™¨ -->
    <listener>
        <listener-class>com.example.AppLifecycleListener</listener-class>
    </listener>
</web-app>
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ServletContextListenerï¼šWebåº”ç”¨ç”Ÿå‘½å‘¨æœŸç›‘å¬çš„æ ¸å¿ƒæ¥å£
ğŸ”¸ contextInitializedï¼šåº”ç”¨å¯åŠ¨æ—¶è°ƒç”¨ï¼Œåšåˆå§‹åŒ–å·¥ä½œ
ğŸ”¸ contextDestroyedï¼šåº”ç”¨å…³é—­æ—¶è°ƒç”¨ï¼Œåšæ¸…ç†å·¥ä½œ  
ğŸ”¸ ServletContextï¼šæ•´ä¸ªWebåº”ç”¨çš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œç”¨äºå…±äº«æ•°æ®
ğŸ”¸ å…¨å±€èµ„æºç®¡ç†ï¼šæ•°æ®åº“è¿æ¥æ± ã€ç¼“å­˜ã€é…ç½®æ–‡ä»¶ç­‰çš„ç»Ÿä¸€ç®¡ç†
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ç”Ÿå‘½å‘¨æœŸç›‘å¬å™¨çš„æœ¬è´¨ä½œç”¨**ï¼š
```
å°±åƒä¸€ä¸ª"ç®¡å®¶"ï¼š
- å¼€é—¨è¥ä¸šå‰ï¼šå‡†å¤‡å¥½ä¸€åˆ‡å¿…éœ€å“ï¼ˆåˆå§‹åŒ–èµ„æºï¼‰
- å…³é—¨æ­‡ä¸šæ—¶ï¼šæ”¶æ‹¾å¥½ä¸€åˆ‡ç‰©å“ï¼ˆæ¸…ç†èµ„æºï¼‰
- ç¡®ä¿åº”ç”¨ï¼šæœ‰åºå¯åŠ¨ï¼Œä¼˜é›…å…³é—­
```

**ğŸ”¹ èµ„æºç®¡ç†çš„é‡è¦æ€§**ï¼š
```
ä¸ºä»€ä¹ˆè¦ç»Ÿä¸€ç®¡ç†èµ„æºï¼š
- é¿å…é‡å¤åˆ›å»ºï¼šå¤šä¸ªServletå…±ç”¨ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± 
- ç¡®ä¿æ­£ç¡®é‡Šæ”¾ï¼šé˜²æ­¢å†…å­˜æ³„éœ²å’Œè¿æ¥è€—å°½  
- æé«˜æ€§èƒ½ï¼šé¢„å…ˆåˆå§‹åŒ–ï¼Œå‡å°‘è¯·æ±‚æ—¶çš„ç­‰å¾…æ—¶é—´
```

**ğŸ”¹ å¼‚å¸¸å¤„ç†ç­–ç•¥**ï¼š
```
å¯åŠ¨å¤±è´¥çš„å¤„ç†åŸåˆ™ï¼š
- å…³é”®ç»„ä»¶å¤±è´¥ï¼šé˜»æ­¢åº”ç”¨å¯åŠ¨æˆ–æ ‡è®°ä¸ºä¸å¯ç”¨
- å¯é€‰ç»„ä»¶å¤±è´¥ï¼šè®°å½•è­¦å‘Šï¼Œå¯ç”¨é™çº§æ¨¡å¼
- æä¾›å¥åº·æ£€æŸ¥ï¼šè®©å¤–éƒ¨ç³»ç»Ÿäº†è§£åº”ç”¨çŠ¶æ€
```

### 8.3 å®é™…åº”ç”¨åœºæ™¯


**ğŸ“‹ å…¸å‹ä½¿ç”¨åœºæ™¯**ï¼š
- **æ•°æ®åº“è¿æ¥æ± **ï¼šåº”ç”¨å¯åŠ¨æ—¶åˆ›å»ºï¼Œå…³é—­æ—¶é‡Šæ”¾
- **å®šæ—¶ä»»åŠ¡è°ƒåº¦**ï¼šå¯åŠ¨æ—¶å¼€å¯ä»»åŠ¡ï¼Œå…³é—­æ—¶åœæ­¢ä»»åŠ¡
- **ç¼“å­˜é¢„çƒ­**ï¼šå¯åŠ¨æ—¶åŠ è½½çƒ­ç‚¹æ•°æ®åˆ°ç¼“å­˜
- **ç³»ç»Ÿç›‘æ§**ï¼šå¯åŠ¨æ—¶åˆå§‹åŒ–ç›‘æ§ç»„ä»¶ï¼Œæ”¶é›†è¿è¡Œæ•°æ®
- **å¤–éƒ¨æœåŠ¡è¿æ¥**ï¼šå¯åŠ¨æ—¶å»ºç«‹é•¿è¿æ¥ï¼Œå…³é—­æ—¶æ–­å¼€è¿æ¥

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
ç›‘å¬å™¨ç®¡å®¶èŒè´£é‡ï¼Œ
å¯åŠ¨åˆå§‹åŒ–èµ„æºï¼Œ
å…³é—­æ¸…ç†é˜²æ³„éœ²ï¼Œ
å¼‚å¸¸å¤„ç†è¦å‘¨å…¨ã€‚
```

**æœ€ç»ˆå»ºè®®**ï¼š
- âœ… **å…ˆæŒæ¡åŸºç¡€æ¦‚å¿µ**ï¼Œç†è§£ç›‘å¬å™¨çš„ä½œç”¨å’Œæ—¶æœº
- âœ… **ä»ç®€å•ç¤ºä¾‹å¼€å§‹**ï¼Œé€æ­¥å¢åŠ å¤æ‚çš„èµ„æºç®¡ç†é€»è¾‘  
- âœ… **æ³¨é‡å¼‚å¸¸å¤„ç†**ï¼Œè®©åº”ç”¨åœ¨å„ç§æƒ…å†µä¸‹éƒ½èƒ½ç¨³å®šè¿è¡Œ
- âœ… **å…³æ³¨æ€§èƒ½ä¼˜åŒ–**ï¼Œåˆç†ä½¿ç”¨å¹¶è¡Œåˆå§‹åŒ–å’Œæ‡’åŠ è½½ç­–ç•¥