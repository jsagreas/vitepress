---
title: 3ã€Listener-å®Œæ•´åˆ†ç±»ä½“ç³»
---
## ğŸ“š ç›®å½•

1. [ç›‘å¬å™¨åˆ†ç±»æ¦‚è¿°](#1-ç›‘å¬å™¨åˆ†ç±»æ¦‚è¿°)
2. [ç”Ÿå‘½å‘¨æœŸç›‘å¬å™¨](#2-ç”Ÿå‘½å‘¨æœŸç›‘å¬å™¨)
3. [å±æ€§å˜åŒ–ç›‘å¬å™¨](#3-å±æ€§å˜åŒ–ç›‘å¬å™¨)
4. [ä¼šè¯æ¿€æ´»ç›‘å¬å™¨](#4-ä¼šè¯æ¿€æ´»ç›‘å¬å™¨)
5. [è¯·æ±‚ç›‘å¬å™¨](#5-è¯·æ±‚ç›‘å¬å™¨)
6. [å¼‚æ­¥ç›‘å¬å™¨](#6-å¼‚æ­¥ç›‘å¬å™¨)
7. [ç›‘å¬å™¨æ¥å£ç»§æ‰¿å…³ç³»](#7-ç›‘å¬å™¨æ¥å£ç»§æ‰¿å…³ç³»)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ç›‘å¬å™¨åˆ†ç±»æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯ç›‘å¬å™¨åˆ†ç±»

**ç®€å•ç†è§£**ï¼šç›‘å¬å™¨å°±åƒæ˜¯"å®ˆé—¨å‘˜"ï¼Œä¸åŒçš„ç›‘å¬å™¨è´Ÿè´£ç›‘å¬ä¸åŒçš„"é—¨"

æƒ³è±¡ä¸€ä¸‹ç°å®ç”Ÿæ´»ä¸­çš„åœºæ™¯ï¼š
- ğŸ  **æˆ¿å±‹ç®¡ç†å‘˜**ï¼šç›‘å¬æˆ¿å­çš„å»ºé€ ã€æ‹†é™¤
- ğŸ‘¥ **å®¢äººæ¥å¾…å‘˜**ï¼šç›‘å¬å®¢äººçš„åˆ°æ¥ã€ç¦»å¼€  
- ğŸ“¦ **ç‰©å“ç®¡ç†å‘˜**ï¼šç›‘å¬ç‰©å“çš„å¢åŠ ã€åˆ é™¤
- ğŸš— **åœè½¦ç®¡ç†å‘˜**ï¼šç›‘å¬è½¦è¾†çš„åœæ”¾ã€ç§»èµ°

åœ¨JavaWebä¸­ï¼Œç›‘å¬å™¨ä¹Ÿæ˜¯ç±»ä¼¼çš„æ¦‚å¿µï¼Œåªæ˜¯ç›‘å¬çš„æ˜¯Webåº”ç”¨ä¸­å‘ç”Ÿçš„å„ç§äº‹ä»¶ã€‚

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦åˆ†ç±»

**æ ¸å¿ƒåŸå› **ï¼šä¸åŒçš„ä¸šåŠ¡éœ€æ±‚éœ€è¦ç›‘å¬ä¸åŒçš„äº‹ä»¶

```
å®é™…å¼€å‘åœºæ™¯ï¼š

åœ¨çº¿è´­ç‰©ç½‘ç«™éœ€æ±‚ï¼š
ğŸ”¹ ç”¨æˆ·è®¿é—®ç»Ÿè®¡ â†’ éœ€è¦ç›‘å¬ä¼šè¯åˆ›å»º/é”€æ¯
ğŸ”¹ è´­ç‰©è½¦æ•°æ®ç®¡ç† â†’ éœ€è¦ç›‘å¬ä¼šè¯å±æ€§å˜åŒ–  
ğŸ”¹ ç³»ç»Ÿèµ„æºç›‘æ§ â†’ éœ€è¦ç›‘å¬åº”ç”¨å¯åŠ¨/å…³é—­
ğŸ”¹ ç”¨æˆ·æ“ä½œè®°å½• â†’ éœ€è¦ç›‘å¬è¯·æ±‚å¤„ç†è¿‡ç¨‹
```

### 1.3 ç›‘å¬å™¨åˆ†ç±»å…¨æ™¯å›¾


```
JavaWebç›‘å¬å™¨åˆ†ç±»ä½“ç³»ï¼š

ğŸ“± Webåº”ç”¨çº§åˆ«
â”œâ”€â”€ ServletContextListener (åº”ç”¨ç”Ÿå‘½å‘¨æœŸ)
â””â”€â”€ ServletContextAttributeListener (åº”ç”¨å±æ€§å˜åŒ–)

ğŸ‘¤ ä¼šè¯çº§åˆ«  
â”œâ”€â”€ HttpSessionListener (ä¼šè¯ç”Ÿå‘½å‘¨æœŸ)
â”œâ”€â”€ HttpSessionAttributeListener (ä¼šè¯å±æ€§å˜åŒ–)
â”œâ”€â”€ HttpSessionActivationListener (ä¼šè¯æ¿€æ´»/é’åŒ–)
â””â”€â”€ HttpSessionBindingListener (å±æ€§ç»‘å®š/è§£ç»‘)

ğŸ“ è¯·æ±‚çº§åˆ«
â”œâ”€â”€ ServletRequestListener (è¯·æ±‚ç”Ÿå‘½å‘¨æœŸ)
â””â”€â”€ ServletRequestAttributeListener (è¯·æ±‚å±æ€§å˜åŒ–)

âš¡ å¼‚æ­¥çº§åˆ«
â””â”€â”€ AsyncListener (å¼‚æ­¥è¯·æ±‚ç›‘å¬)
```

---

## 2. ğŸ¢ ç”Ÿå‘½å‘¨æœŸç›‘å¬å™¨


### 2.1 ä»€ä¹ˆæ˜¯ç”Ÿå‘½å‘¨æœŸç›‘å¬å™¨

**é€šä¿—è§£é‡Š**ï¼šç”Ÿå‘½å‘¨æœŸç›‘å¬å™¨å°±åƒæ˜¯"å‡ºç”Ÿè¯æ˜"å’Œ"æ­»äº¡è¯æ˜"çš„è®°å½•å‘˜

> ğŸ’¡ **ç”Ÿæ´»ç±»æ¯”**ï¼š
> - åŒ»é™¢çš„å‡ºç”Ÿç™»è®°å‘˜ï¼šè®°å½•å©´å„¿å‡ºç”Ÿ
> - æ®¡ä»ªé¦†çš„ç™»è®°å‘˜ï¼šè®°å½•æ­»äº¡ä¿¡æ¯
> - ç”Ÿå‘½å‘¨æœŸç›‘å¬å™¨ï¼šè®°å½•Webç»„ä»¶çš„"å‡ºç”Ÿ"å’Œ"æ­»äº¡"

### 2.2 ServletContextListenerï¼ˆåº”ç”¨çº§ç”Ÿå‘½å‘¨æœŸï¼‰


**ä½œç”¨**ï¼šç›‘å¬æ•´ä¸ªWebåº”ç”¨çš„å¯åŠ¨å’Œå…³é—­

```java
@WebListener
public class AppLifecycleListener implements ServletContextListener {
    
    @Override
    public void contextInitialized(ServletContextEvent sce) {
        System.out.println("ğŸš€ Webåº”ç”¨å¯åŠ¨äº†ï¼");
        // åœ¨è¿™é‡Œåšåº”ç”¨åˆå§‹åŒ–å·¥ä½œ
        // æ¯”å¦‚ï¼šåŠ è½½é…ç½®æ–‡ä»¶ã€åˆå§‹åŒ–æ•°æ®åº“è¿æ¥æ± 
    }
    
    @Override
    public void contextDestroyed(ServletContextEvent sce) {
        System.out.println("ğŸ›‘ Webåº”ç”¨å…³é—­äº†ï¼");  
        // åœ¨è¿™é‡Œåšæ¸…ç†å·¥ä½œ
        // æ¯”å¦‚ï¼šå…³é—­æ•°æ®åº“è¿æ¥ã€æ¸…ç†ç¼“å­˜
    }
}
```

**å®é™…åº”ç”¨åœºæ™¯**ï¼š
- ğŸ”§ **ç³»ç»Ÿåˆå§‹åŒ–**ï¼šåŠ è½½é…ç½®æ–‡ä»¶ã€å»ºç«‹æ•°æ®åº“è¿æ¥
- ğŸ“Š **ç»Ÿè®¡åŠŸèƒ½**ï¼šè®°å½•åº”ç”¨è¿è¡Œæ—¶é—´
- ğŸ§¹ **èµ„æºæ¸…ç†**ï¼šåº”ç”¨å…³é—­æ—¶é‡Šæ”¾èµ„æº

### 2.3 HttpSessionListenerï¼ˆä¼šè¯çº§ç”Ÿå‘½å‘¨æœŸï¼‰


**ä½œç”¨**ï¼šç›‘å¬ç”¨æˆ·ä¼šè¯çš„åˆ›å»ºå’Œé”€æ¯

```java
@WebListener  
public class SessionLifecycleListener implements HttpSessionListener {
    
    private static int onlineUsers = 0;
    
    @Override
    public void sessionCreated(HttpSessionEvent se) {
        onlineUsers++;
        System.out.println("ğŸ‘¤ æ–°ç”¨æˆ·ä¸Šçº¿ï¼Œå½“å‰åœ¨çº¿ï¼š" + onlineUsers + "äºº");
    }
    
    @Override
    public void sessionDestroyed(HttpSessionEvent se) {
        onlineUsers--;
        System.out.println("ğŸ‘‹ ç”¨æˆ·ç¦»çº¿ï¼Œå½“å‰åœ¨çº¿ï¼š" + onlineUsers + "äºº");
    }
}
```

**å®é™…åº”ç”¨åœºæ™¯**ï¼š
- ğŸ“ˆ **åœ¨çº¿äººæ•°ç»Ÿè®¡**ï¼šå®æ—¶æ˜¾ç¤ºç½‘ç«™åœ¨çº¿ç”¨æˆ·æ•°
- ğŸ **æ¬¢è¿/å‘Šåˆ«**ï¼šç”¨æˆ·é¦–æ¬¡è®¿é—®çš„æ¬¢è¿ä¿¡æ¯
- ğŸ“ **è¡Œä¸ºè®°å½•**ï¼šè®°å½•ç”¨æˆ·è®¿é—®æ—¥å¿—

### 2.4 ServletRequestListenerï¼ˆè¯·æ±‚çº§ç”Ÿå‘½å‘¨æœŸï¼‰


**ä½œç”¨**ï¼šç›‘å¬æ¯ä¸ªHTTPè¯·æ±‚çš„å¼€å§‹å’Œç»“æŸ

```java
@WebListener
public class RequestLifecycleListener implements ServletRequestListener {
    
    @Override
    public void requestInitialized(ServletRequestEvent sre) {
        String uri = ((HttpServletRequest)sre.getServletRequest()).getRequestURI();
        System.out.println("ğŸ“¥ æ”¶åˆ°è¯·æ±‚ï¼š" + uri);
    }
    
    @Override
    public void requestDestroyed(ServletRequestEvent sre) {
        System.out.println("ğŸ“¤ è¯·æ±‚å¤„ç†å®Œæˆ");
    }
}
```

**å®é™…åº”ç”¨åœºæ™¯**ï¼š
- â±ï¸ **æ€§èƒ½ç›‘æ§**ï¼šç»Ÿè®¡è¯·æ±‚å¤„ç†æ—¶é—´
- ğŸ“Š **è®¿é—®ç»Ÿè®¡**ï¼šè®°å½•é¡µé¢è®¿é—®æ¬¡æ•°
- ğŸ” **è¯·æ±‚æ—¥å¿—**ï¼šè®°å½•ç”¨æˆ·æ“ä½œè½¨è¿¹

---

## 3. ğŸ“ å±æ€§å˜åŒ–ç›‘å¬å™¨


### 3.1 ä»€ä¹ˆæ˜¯å±æ€§å˜åŒ–ç›‘å¬å™¨

**é€šä¿—è§£é‡Š**ï¼šå±æ€§å˜åŒ–ç›‘å¬å™¨å°±åƒæ˜¯"ä»“åº“ç®¡ç†å‘˜"ï¼Œä¸“é—¨è®°å½•ç‰©å“çš„è¿›å‡º

> ğŸ’¡ **ç”Ÿæ´»ç±»æ¯”**ï¼š
> - è¶…å¸‚æ”¶é“¶å‘˜ï¼šè®°å½•å•†å“çš„å¢åŠ ã€å‡å°‘
> - å›¾ä¹¦ç®¡ç†å‘˜ï¼šè®°å½•å›¾ä¹¦çš„å€Ÿå‡ºã€å½’è¿˜  
> - å±æ€§ç›‘å¬å™¨ï¼šè®°å½•æ•°æ®çš„æ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤

### 3.2 ServletContextAttributeListenerï¼ˆåº”ç”¨å±æ€§å˜åŒ–ï¼‰


**ä½œç”¨**ï¼šç›‘å¬åº”ç”¨çº§åˆ«çš„æ•°æ®å˜åŒ–

```java
@WebListener
public class AppAttributeListener implements ServletContextAttributeListener {
    
    @Override
    public void attributeAdded(ServletContextAttributeEvent event) {
        String name = event.getName();
        Object value = event.getValue();
        System.out.println("ğŸ“‹ åº”ç”¨ä¸­æ·»åŠ äº†æ•°æ®ï¼š" + name + " = " + value);
    }
    
    @Override  
    public void attributeRemoved(ServletContextAttributeEvent event) {
        System.out.println("ğŸ—‘ï¸ åº”ç”¨ä¸­åˆ é™¤äº†æ•°æ®ï¼š" + event.getName());
    }
    
    @Override
    public void attributeReplaced(ServletContextAttributeEvent event) {
        System.out.println("âœï¸ åº”ç”¨ä¸­ä¿®æ”¹äº†æ•°æ®ï¼š" + event.getName());
    }
}
```

**å®é™…åº”ç”¨åœºæ™¯**ï¼š
- ğŸ“Š **ç¼“å­˜ç›‘æ§**ï¼šç›‘æ§åº”ç”¨çº§ç¼“å­˜çš„å˜åŒ–
- ğŸ”§ **é…ç½®ç®¡ç†**ï¼šç›‘å¬ç³»ç»Ÿé…ç½®çš„æ›´æ–°
- ğŸ“ˆ **æ•°æ®ç»Ÿè®¡**ï¼šç»Ÿè®¡å…¨å±€æ•°æ®çš„å˜åŒ–æƒ…å†µ

### 3.3 HttpSessionAttributeListenerï¼ˆä¼šè¯å±æ€§å˜åŒ–ï¼‰


**ä½œç”¨**ï¼šç›‘å¬ç”¨æˆ·ä¼šè¯ä¸­æ•°æ®çš„å˜åŒ–

```java
@WebListener
public class SessionAttributeListener implements HttpSessionAttributeListener {
    
    @Override
    public void attributeAdded(HttpSessionBindingEvent event) {
        String name = event.getName();
        Object value = event.getValue();
        System.out.println("ğŸ›’ ç”¨æˆ·æ·»åŠ äº†æ•°æ®ï¼š" + name);
        
        // ä¾‹å¦‚ï¼šç”¨æˆ·æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦
        if("cart".equals(name)) {
            System.out.println("è´­ç‰©è½¦æœ‰æ–°å•†å“äº†ï¼");
        }
    }
    
    @Override
    public void attributeRemoved(HttpSessionBindingEvent event) {
        System.out.println("âŒ ç”¨æˆ·åˆ é™¤äº†æ•°æ®ï¼š" + event.getName());
    }
    
    @Override  
    public void attributeReplaced(HttpSessionBindingEvent event) {
        System.out.println("ğŸ”„ ç”¨æˆ·ä¿®æ”¹äº†æ•°æ®ï¼š" + event.getName());
    }
}
```

**å®é™…åº”ç”¨åœºæ™¯**ï¼š
- ğŸ›ï¸ **è´­ç‰©è½¦ç®¡ç†**ï¼šç›‘å¬è´­ç‰©è½¦å•†å“çš„å¢åˆ æ”¹
- ğŸ‘¤ **ç”¨æˆ·ä¿¡æ¯**ï¼šç›‘å¬ç”¨æˆ·ç™»å½•çŠ¶æ€å˜åŒ–
- ğŸ¯ **ä¸ªæ€§åŒ–æ¨è**ï¼šæ ¹æ®ç”¨æˆ·è¡Œä¸ºè°ƒæ•´æ¨èå†…å®¹

### 3.4 ServletRequestAttributeListenerï¼ˆè¯·æ±‚å±æ€§å˜åŒ–ï¼‰


**ä½œç”¨**ï¼šç›‘å¬å•æ¬¡è¯·æ±‚ä¸­æ•°æ®çš„å˜åŒ–

```java
@WebListener
public class RequestAttributeListener implements ServletRequestAttributeListener {
    
    @Override
    public void attributeAdded(ServletRequestAttributeEvent srae) {
        String name = srae.getName();
        System.out.println("ğŸ“„ è¯·æ±‚ä¸­æ·»åŠ äº†æ•°æ®ï¼š" + name);
    }
    
    @Override
    public void attributeRemoved(ServletRequestAttributeEvent srae) {
        System.out.println("ğŸ—‚ï¸ è¯·æ±‚ä¸­åˆ é™¤äº†æ•°æ®ï¼š" + srae.getName());
    }
    
    @Override
    public void attributeReplaced(ServletRequestAttributeEvent srae) {
        System.out.println("ğŸ“ è¯·æ±‚ä¸­ä¿®æ”¹äº†æ•°æ®ï¼š" + srae.getName());
    }
}
```

**å®é™…åº”ç”¨åœºæ™¯**ï¼š
- ğŸ” **è¯·æ±‚è·Ÿè¸ª**ï¼šè·Ÿè¸ªè¯·æ±‚å¤„ç†è¿‡ç¨‹ä¸­çš„æ•°æ®æµè½¬
- ğŸ› **è°ƒè¯•å·¥å…·**ï¼šå¼€å‘é˜¶æ®µç›‘æ§è¯·æ±‚æ•°æ®å˜åŒ–
- ğŸ“Š **æ€§èƒ½åˆ†æ**ï¼šåˆ†æè¯·æ±‚å¤„ç†çš„å¤æ‚åº¦

---

## 4. ğŸ’¾ ä¼šè¯æ¿€æ´»ç›‘å¬å™¨


### 4.1 ä»€ä¹ˆæ˜¯ä¼šè¯æ¿€æ´»ç›‘å¬å™¨

**é€šä¿—è§£é‡Š**ï¼šä¼šè¯æ¿€æ´»ç›‘å¬å™¨å°±åƒæ˜¯"å†·å†»åº“ç®¡ç†å‘˜"

> ğŸ’¡ **ç”Ÿæ´»ç±»æ¯”**ï¼š
> - ğŸ¥¶ **å†·å†»é£Ÿå“**ï¼šä¸å¸¸ç”¨æ—¶æ”¾å†°ç®±å†·å†»ä¿å­˜
> - ğŸ”¥ **è§£å†»åŠ çƒ­**ï¼šéœ€è¦ä½¿ç”¨æ—¶æ‹¿å‡ºæ¥è§£å†»
> - ğŸ’¾ **ä¼šè¯é’åŒ–**ï¼šä¸æ´»è·ƒçš„ç”¨æˆ·æ•°æ®å­˜åˆ°ç¡¬ç›˜
> - âš¡ **ä¼šè¯æ¿€æ´»**ï¼šç”¨æˆ·å›æ¥æ—¶ä»ç¡¬ç›˜åŠ è½½åˆ°å†…å­˜

### 4.2 ä¸ºä»€ä¹ˆéœ€è¦ä¼šè¯æ¿€æ´»/é’åŒ–

**æ ¸å¿ƒé—®é¢˜**ï¼šæœåŠ¡å™¨å†…å­˜æœ‰é™ï¼Œä½†ç”¨æˆ·å¯èƒ½å¾ˆå¤š

```
åœºæ™¯è¯´æ˜ï¼š

ç”µå•†ç½‘ç«™æœ‰10000ä¸ªç”¨æˆ·ï¼š
ğŸ˜° é—®é¢˜ï¼šæ¯ä¸ªç”¨æˆ·ä¼šè¯å ç”¨2MBå†…å­˜
       10000 Ã— 2MB = 20GBå†…å­˜ï¼ˆæœåŠ¡å™¨æ‰¿å—ä¸äº†ï¼‰

ğŸ˜Š è§£å†³ï¼šåªæŠŠæ´»è·ƒç”¨æˆ·çš„æ•°æ®æ”¾å†…å­˜ä¸­
       ä¸æ´»è·ƒçš„ç”¨æˆ·æ•°æ®æš‚æ—¶ä¿å­˜åˆ°ç¡¬ç›˜
       ç”¨æˆ·å›æ¥æ—¶å†åŠ è½½åˆ°å†…å­˜
```

### 4.3 HttpSessionActivationListenerå®ç°


**ä½œç”¨**ï¼šç›‘å¬ä¼šè¯åœ¨å†…å­˜å’Œç¡¬ç›˜ä¹‹é—´çš„è½¬ç§»

```java
// éœ€è¦è¢«åºåˆ—åŒ–çš„ç”¨æˆ·æ•°æ®ç±»
public class UserInfo implements Serializable, HttpSessionActivationListener {
    private String username;
    private List<String> shoppingCart;
    
    @Override
    public void sessionWillPassivate(HttpSessionEvent se) {
        System.out.println("ğŸ’¤ ç”¨æˆ·æ•°æ®å³å°†ä¼‘çœ åˆ°ç¡¬ç›˜ï¼š" + username);
        // å¯ä»¥åœ¨è¿™é‡Œåšä¸€äº›å‡†å¤‡å·¥ä½œ
    }
    
    @Override  
    public void sessionDidActivate(HttpSessionEvent se) {
        System.out.println("ğŸ˜Š ç”¨æˆ·æ•°æ®ä»ç¡¬ç›˜å”¤é†’ï¼š" + username);
        // å¯ä»¥åœ¨è¿™é‡Œåšä¸€äº›æ¢å¤å·¥ä½œ
    }
}
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```java
// åœ¨Servletä¸­ä½¿ç”¨
UserInfo userInfo = new UserInfo("å¼ ä¸‰");
session.setAttribute("userInfo", userInfo);
// å½“ç”¨æˆ·é•¿æ—¶é—´ä¸æ´»è·ƒæ—¶ï¼ŒuserInfoä¼šè¢«é’åŒ–åˆ°ç¡¬ç›˜
// ç”¨æˆ·å†æ¬¡è®¿é—®æ—¶ï¼ŒuserInfoä¼šè¢«æ¿€æ´»åˆ°å†…å­˜
```

**å®é™…åº”ç”¨åœºæ™¯**ï¼š
- ğŸ’° **èŠ‚çœå†…å­˜**ï¼šå¤§é‡ç”¨æˆ·æ—¶é¿å…å†…å­˜æº¢å‡º
- ğŸ“ˆ **æé«˜æ€§èƒ½**ï¼šæ´»è·ƒç”¨æˆ·äº«å—æ›´å¿«çš„å“åº”é€Ÿåº¦  
- ğŸ”„ **æ•°æ®æŒä¹…åŒ–**ï¼šå³ä½¿æœåŠ¡å™¨é‡å¯ä¹Ÿä¸ä¸¢å¤±ç”¨æˆ·æ•°æ®

---

## 5. ğŸ“¡ è¯·æ±‚ç›‘å¬å™¨


### 5.1 è¯·æ±‚ç›‘å¬å™¨çš„ç‰¹ç‚¹

**æ ¸å¿ƒç‰¹ç‚¹**ï¼šæ¯ä¸ªHTTPè¯·æ±‚éƒ½ä¼šè§¦å‘

> âš ï¸ **æ³¨æ„**ï¼š
> è¯·æ±‚ç›‘å¬å™¨è§¦å‘é¢‘ç‡å¾ˆé«˜ï¼Œéœ€è¦æ³¨æ„æ€§èƒ½å½±å“
> å°±åƒé«˜é€Ÿå…¬è·¯æ”¶è´¹ç«™ï¼Œæ¯è¾†è½¦éƒ½è¦ç»è¿‡

### 5.2 ServletRequestListenerè¯¦è§£


**è§¦å‘æ—¶æœº**ï¼š
- **requestInitialized**ï¼šè¯·æ±‚å¼€å§‹å¤„ç†æ—¶
- **requestDestroyed**ï¼šè¯·æ±‚å¤„ç†å®Œæˆæ—¶

```java
@WebListener
public class RequestMonitor implements ServletRequestListener {
    
    @Override
    public void requestInitialized(ServletRequestEvent sre) {
        HttpServletRequest request = (HttpServletRequest) sre.getServletRequest();
        
        // è®°å½•è¯·æ±‚å¼€å§‹æ—¶é—´
        long startTime = System.currentTimeMillis();
        request.setAttribute("startTime", startTime);
        
        // è®°å½•è¯·æ±‚ä¿¡æ¯
        String method = request.getMethod();
        String uri = request.getRequestURI();
        System.out.println("ğŸ”„ å¼€å§‹å¤„ç†è¯·æ±‚ï¼š" + method + " " + uri);
    }
    
    @Override
    public void requestDestroyed(ServletRequestEvent sre) {
        HttpServletRequest request = (HttpServletRequest) sre.getServletRequest();
        
        // è®¡ç®—è¯·æ±‚å¤„ç†æ—¶é—´
        Long startTime = (Long) request.getAttribute("startTime");
        if (startTime != null) {
            long duration = System.currentTimeMillis() - startTime;
            System.out.println("âœ… è¯·æ±‚å¤„ç†å®Œæˆï¼Œè€—æ—¶ï¼š" + duration + "ms");
        }
    }
}
```

**å®é™…åº”ç”¨åœºæ™¯**ï¼š
- â±ï¸ **æ€§èƒ½ç›‘æ§**ï¼šç»Ÿè®¡æ¯ä¸ªè¯·æ±‚çš„å¤„ç†æ—¶é—´
- ğŸ“Š **è®¿é—®ç»Ÿè®¡**ï¼šè®°å½•APIè°ƒç”¨æ¬¡æ•°å’Œé¢‘ç‡
- ğŸ” **é—®é¢˜æ’æŸ¥**ï¼šè®°å½•æ…¢è¯·æ±‚ï¼Œä¾¿äºä¼˜åŒ–

---

## 6. âš¡ å¼‚æ­¥ç›‘å¬å™¨


### 6.1 ä»€ä¹ˆæ˜¯å¼‚æ­¥ç›‘å¬å™¨

**é€šä¿—è§£é‡Š**ï¼šå¼‚æ­¥ç›‘å¬å™¨ä¸“é—¨å¤„ç†"å¼‚æ­¥è¯·æ±‚"

> ğŸ’¡ **ç”Ÿæ´»ç±»æ¯”**ï¼š
> - ğŸ• **åŒæ­¥è®¢é¤**ï¼šç‚¹é¤åä¸€ç›´ç­‰åˆ°æ‹¿åˆ°é£Ÿç‰©æ‰ç¦»å¼€
> - ğŸ“± **å¼‚æ­¥è®¢é¤**ï¼šç‚¹é¤åå…ˆå»åšåˆ«çš„äº‹ï¼Œé¤å¥½äº†å†é€šçŸ¥ä½ 
> - âš¡ **å¼‚æ­¥è¯·æ±‚**ï¼šæœåŠ¡å™¨æ¥æ”¶è¯·æ±‚åï¼Œä¸ç«‹å³å“åº”ï¼Œå¤„ç†å®Œå†é€šçŸ¥

### 6.2 ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥å¤„ç†

**æ ¸å¿ƒé—®é¢˜**ï¼šæœ‰äº›ä¸šåŠ¡å¤„ç†æ—¶é—´å¾ˆé•¿

```
ä¸šåŠ¡åœºæ™¯å¯¹æ¯”ï¼š

ğŸƒâ€â™‚ï¸ å¿«é€Ÿä¸šåŠ¡ï¼ˆé€‚åˆåŒæ­¥ï¼‰ï¼š
- æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼š50ms
- æ˜¾ç¤ºå•†å“åˆ—è¡¨ï¼š100ms  
- ç”¨æˆ·ç™»å½•éªŒè¯ï¼š80ms

ğŸŒ è€—æ—¶ä¸šåŠ¡ï¼ˆé€‚åˆå¼‚æ­¥ï¼‰ï¼š
- å‘é€é‚®ä»¶ï¼š5-10ç§’
- ç”ŸæˆPDFæŠ¥å‘Šï¼š30ç§’-5åˆ†é’Ÿ
- æ•°æ®æ‰¹é‡å¤„ç†ï¼šå‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶
```

### 6.3 AsyncListenerå®ç°


**ä½œç”¨**ï¼šç›‘å¬å¼‚æ­¥è¯·æ±‚çš„å„ä¸ªé˜¶æ®µ

```java
@WebListener
public class AsyncRequestListener implements AsyncListener {
    
    @Override
    public void onComplete(AsyncEvent event) throws IOException {
        System.out.println("ğŸ‰ å¼‚æ­¥å¤„ç†å®Œæˆï¼");
        // å¼‚æ­¥ä»»åŠ¡æˆåŠŸå®Œæˆ
    }
    
    @Override
    public void onTimeout(AsyncEvent event) throws IOException {
        System.out.println("â° å¼‚æ­¥å¤„ç†è¶…æ—¶ï¼");
        // å¤„ç†è¶…æ—¶æƒ…å†µ
        event.getAsyncContext().getResponse().getWriter()
              .write("è¯·æ±‚å¤„ç†è¶…æ—¶ï¼Œè¯·ç¨åå†è¯•");
    }
    
    @Override
    public void onError(AsyncEvent event) throws IOException {
        System.out.println("âŒ å¼‚æ­¥å¤„ç†å‡ºé”™ï¼š" + event.getThrowable().getMessage());
        // å¤„ç†é”™è¯¯æƒ…å†µ
    }
    
    @Override
    public void onStartAsync(AsyncEvent event) throws IOException {
        System.out.println("ğŸš€ å¼‚æ­¥å¤„ç†å¼€å§‹ï¼");
        // å¼‚æ­¥å¤„ç†å¼€å§‹
    }
}
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```java
// åœ¨Servletä¸­ä½¿ç”¨å¼‚æ­¥å¤„ç†
@WebServlet(value = "/async", asyncSupported = true)
public class AsyncServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        // å¼€å¯å¼‚æ­¥å¤„ç†
        AsyncContext asyncContext = request.startAsync();
        asyncContext.setTimeout(30000); // 30ç§’è¶…æ—¶
        asyncContext.addListener(new AsyncRequestListener());
        
        // åœ¨å¦ä¸€ä¸ªçº¿ç¨‹ä¸­å¤„ç†è€—æ—¶ä»»åŠ¡
        CompletableFuture.runAsync(() -> {
            try {
                // æ¨¡æ‹Ÿè€—æ—¶ä¸šåŠ¡
                Thread.sleep(5000);
                
                // å¤„ç†å®Œæˆåå“åº”
                PrintWriter writer = asyncContext.getResponse().getWriter();
                writer.write("å¼‚æ­¥å¤„ç†å®Œæˆï¼");
                asyncContext.complete();
                
            } catch (Exception e) {
                e.printStackTrace();
            }
        });
    }
}
```

**å®é™…åº”ç”¨åœºæ™¯**ï¼š
- ğŸ“§ **é‚®ä»¶å‘é€**ï¼šæ³¨å†ŒæˆåŠŸåå‘é€ç¡®è®¤é‚®ä»¶
- ğŸ“Š **æŠ¥è¡¨ç”Ÿæˆ**ï¼šå¤§é‡æ•°æ®çš„ç»Ÿè®¡åˆ†æ
- ğŸ”„ **æ•°æ®åŒæ­¥**ï¼šä¸ç¬¬ä¸‰æ–¹ç³»ç»Ÿçš„æ•°æ®äº¤äº’

---

## 7. ğŸ—ï¸ ç›‘å¬å™¨æ¥å£ç»§æ‰¿å…³ç³»


### 7.1 æ¥å£ç»§æ‰¿ä½“ç³»å›¾


```
ç›‘å¬å™¨æ¥å£ç»§æ‰¿å…³ç³»ï¼š

java.util.EventListener (æ ¹æ¥å£)
â”‚
â”œâ”€â”€ ServletContextListener
â”œâ”€â”€ ServletContextAttributeListener  
â”œâ”€â”€ HttpSessionListener
â”œâ”€â”€ HttpSessionAttributeListener
â”œâ”€â”€ HttpSessionActivationListener
â”œâ”€â”€ HttpSessionBindingListener
â”œâ”€â”€ ServletRequestListener
â”œâ”€â”€ ServletRequestAttributeListener
â””â”€â”€ AsyncListener

ç‰¹æ®Šè¯´æ˜ï¼š
ğŸ”¸ æ‰€æœ‰ç›‘å¬å™¨æ¥å£éƒ½ç»§æ‰¿è‡ª EventListener
ğŸ”¸ EventListener æ˜¯ç©ºæ¥å£ï¼Œä»…ç”¨äºæ ‡è¯†
ğŸ”¸ HttpSessionBindingListener æ¯”è¾ƒç‰¹æ®Šï¼Œä¸éœ€è¦æ³¨å†Œ
```

### 7.2 ç›‘å¬å™¨åˆ†ç±»çŸ©é˜µ


| ç›‘å¬å™¨ç±»å‹ | ç”Ÿå‘½å‘¨æœŸç›‘å¬ | å±æ€§å˜åŒ–ç›‘å¬ | ç‰¹æ®ŠåŠŸèƒ½ |
|-----------|------------|-------------|---------|
| **Applicationçº§** | ServletContextListener | ServletContextAttributeListener | - |
| **Sessionçº§** | HttpSessionListener | HttpSessionAttributeListener | HttpSessionActivationListener |
| **Requestçº§** | ServletRequestListener | ServletRequestAttributeListener | - |
| **å¼‚æ­¥çº§** | - | - | AsyncListener |
| **ç»‘å®šçº§** | - | - | HttpSessionBindingListener |

### 7.3 ç›‘å¬å™¨å·¥ä½œå±‚æ¬¡


```
Webåº”ç”¨è¿è¡Œå±‚æ¬¡ç»“æ„ï¼š

ğŸ¢ Application (åº”ç”¨çº§åˆ«)
â”œâ”€â”€ ğŸ“Š ServletContextListener
â””â”€â”€ ğŸ“‹ ServletContextAttributeListener

ğŸ‘¥ Session (ä¼šè¯çº§åˆ«)  
â”œâ”€â”€ ğŸ” HttpSessionListener
â”œâ”€â”€ ğŸ“¦ HttpSessionAttributeListener  
â”œâ”€â”€ ğŸ’¾ HttpSessionActivationListener
â””â”€â”€ ğŸ”— HttpSessionBindingListener

ğŸ“„ Request (è¯·æ±‚çº§åˆ«)
â”œâ”€â”€ ğŸ“¥ ServletRequestListener
â””â”€â”€ ğŸ“ ServletRequestAttributeListener

âš¡ Async (å¼‚æ­¥çº§åˆ«)
â””â”€â”€ ğŸš€ AsyncListener
```

### 7.4 ç›‘å¬å™¨æ³¨å†Œæ–¹å¼å¯¹æ¯”


| æ³¨å†Œæ–¹å¼ | é€‚ç”¨ç›‘å¬å™¨ | ç‰¹ç‚¹ | ç¤ºä¾‹ |
|---------|-----------|------|------|
| **@WebListeneræ³¨è§£** | å¤§éƒ¨åˆ†ç›‘å¬å™¨ | ç®€å•æ–¹ä¾¿ | `@WebListener` |
| **web.xmlé…ç½®** | å¤§éƒ¨åˆ†ç›‘å¬å™¨ | ä¼ ç»Ÿæ–¹å¼ | `<listener>` |
| **è‡ªåŠ¨è§¦å‘** | HttpSessionBindingListener | æ— éœ€æ³¨å†Œ | å¯¹è±¡å®ç°æ¥å£å³å¯ |

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 ç›‘å¬å™¨åˆ†ç±»æ€»è§ˆ


```
ğŸ“Š æŒ‰ç›‘å¬å¯¹è±¡åˆ†ç±»ï¼š
ğŸ”¸ Applicationç›‘å¬å™¨ï¼šç›‘å¬æ•´ä¸ªWebåº”ç”¨
ğŸ”¸ Sessionç›‘å¬å™¨ï¼šç›‘å¬ç”¨æˆ·ä¼šè¯
ğŸ”¸ Requestç›‘å¬å™¨ï¼šç›‘å¬HTTPè¯·æ±‚
ğŸ”¸ Asyncç›‘å¬å™¨ï¼šç›‘å¬å¼‚æ­¥å¤„ç†

ğŸ“‹ æŒ‰ç›‘å¬äº‹ä»¶åˆ†ç±»ï¼š
ğŸ”¸ ç”Ÿå‘½å‘¨æœŸç›‘å¬å™¨ï¼šç›‘å¬åˆ›å»º/é”€æ¯äº‹ä»¶
ğŸ”¸ å±æ€§å˜åŒ–ç›‘å¬å™¨ï¼šç›‘å¬æ•°æ®å¢åˆ æ”¹äº‹ä»¶  
ğŸ”¸ ç‰¹æ®ŠåŠŸèƒ½ç›‘å¬å™¨ï¼šç›‘å¬æ¿€æ´»/é’åŒ–ç­‰ç‰¹æ®Šäº‹ä»¶
```

### 8.2 é€‰æ‹©ç›‘å¬å™¨çš„åŸåˆ™


**ğŸ¯ æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©**ï¼š
- **ç»Ÿè®¡åœ¨çº¿äººæ•°** â†’ HttpSessionListener
- **ç›‘æ§ç³»ç»Ÿæ€§èƒ½** â†’ ServletRequestListener  
- **ç®¡ç†è´­ç‰©è½¦æ•°æ®** â†’ HttpSessionAttributeListener
- **å¤„ç†è€—æ—¶ä»»åŠ¡** â†’ AsyncListener

**âš¡ æ ¹æ®æ€§èƒ½è€ƒè™‘é€‰æ‹©**ï¼š
- **é«˜é¢‘è§¦å‘**ï¼šRequestçº§ç›‘å¬å™¨è¦æ…ç”¨
- **ä½é¢‘è§¦å‘**ï¼šApplicationçº§ç›‘å¬å™¨å½±å“å°
- **å†…å­˜ä¼˜åŒ–**ï¼šè€ƒè™‘ä½¿ç”¨Sessionæ¿€æ´»ç›‘å¬å™¨

### 8.3 ç›‘å¬å™¨ä½¿ç”¨æœ€ä½³å®è·µ


> ğŸ’¡ **æœ€ä½³å®è·µå»ºè®®**ï¼š
> 
> 1. **é€‰æ‹©åˆé€‚çš„çº§åˆ«**ï¼šä¸è¦ç”¨é«˜çº§åˆ«ç›‘å¬å™¨åšä½çº§åˆ«çš„äº‹
> 2. **é¿å…é‡å¤ç›‘å¬**ï¼šå¤šä¸ªç›‘å¬å™¨ä¸è¦åšé‡å¤çš„å·¥ä½œ  
> 3. **æ³¨æ„æ€§èƒ½å½±å“**ï¼šRequestçº§ç›‘å¬å™¨è¦ç‰¹åˆ«æ³¨æ„æ€§èƒ½
> 4. **åˆç†ä½¿ç”¨å¼‚æ­¥**ï¼šè€—æ—¶æ“ä½œä¸€å®šè¦ç”¨å¼‚æ­¥ç›‘å¬å™¨
> 5. **åšå¥½å¼‚å¸¸å¤„ç†**ï¼šç›‘å¬å™¨å¼‚å¸¸ä¸èƒ½å½±å“ä¸»ä¸šåŠ¡

### 8.4 å®é™…å¼€å‘ä¸­çš„åº”ç”¨ä»·å€¼


**ğŸš€ æå‡ç”¨æˆ·ä½“éªŒ**ï¼š
- é€šè¿‡ä¼šè¯ç›‘å¬å™¨å®ç°åœ¨çº¿äººæ•°æ˜¾ç¤º
- é€šè¿‡å¼‚æ­¥ç›‘å¬å™¨é¿å…é¡µé¢é•¿æ—¶é—´ç­‰å¾…
- é€šè¿‡å±æ€§ç›‘å¬å™¨å®ç°æ•°æ®å®æ—¶åŒæ­¥

**ğŸ”§ ä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½**ï¼š
- é€šè¿‡è¯·æ±‚ç›‘å¬å™¨ç›‘æ§ç³»ç»Ÿæ€§èƒ½ç“¶é¢ˆ
- é€šè¿‡æ¿€æ´»ç›‘å¬å™¨èŠ‚çœæœåŠ¡å™¨å†…å­˜  
- é€šè¿‡åº”ç”¨ç›‘å¬å™¨åˆç†åˆå§‹åŒ–ç³»ç»Ÿèµ„æº

**ğŸ“Š å¢å¼ºç³»ç»Ÿç›‘æ§**ï¼š
- æ”¶é›†ç”¨æˆ·è¡Œä¸ºæ•°æ®
- ç›‘æ§ç³»ç»Ÿè¿è¡ŒçŠ¶æ€
- åŠæ—¶å‘ç°å’Œå¤„ç†å¼‚å¸¸

> ğŸ¯ **æ ¸å¿ƒè®°å¿†**ï¼š
> - **ç›‘å¬å™¨æ˜¯è§‚å¯Ÿè€…**ï¼šä¸“é—¨è§‚å¯ŸWebåº”ç”¨ä¸­å‘ç”Ÿçš„å„ç§äº‹ä»¶
> - **åˆ†ç±»å¾ˆé‡è¦**ï¼šä¸åŒçš„ç›‘å¬å™¨è§£å†³ä¸åŒå±‚é¢çš„é—®é¢˜
> - **åˆç†é€‰æ‹©ä½¿ç”¨**ï¼šæ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©åˆé€‚çš„ç›‘å¬å™¨ç±»å‹
> - **æ€§èƒ½è¦è€ƒè™‘**ï¼šé«˜é¢‘è§¦å‘çš„ç›‘å¬å™¨è¦æ ¼å¤–æ³¨æ„æ€§èƒ½å½±å“