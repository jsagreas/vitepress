---
title: 3ã€Filter-è®¿é—®æ—¥å¿—ä¸ç›‘æ§
---
## ğŸ“š ç›®å½•

1. [è®¿é—®æ—¥å¿—ç›‘æ§æ¦‚è¿°](#1-è®¿é—®æ—¥å¿—ç›‘æ§æ¦‚è¿°)
2. [è¯·æ±‚ä¿¡æ¯æ”¶é›†](#2-è¯·æ±‚ä¿¡æ¯æ”¶é›†)
3. [å“åº”æ—¶é—´ç»Ÿè®¡](#3-å“åº”æ—¶é—´ç»Ÿè®¡)
4. [ç”¨æˆ·è®¿é—®åˆ†æ](#4-ç”¨æˆ·è®¿é—®åˆ†æ)
5. [æ€§èƒ½ç›‘æ§å®ç°](#5-æ€§èƒ½ç›‘æ§å®ç°)
6. [æ—¥å¿—ç®¡ç†ä¸å­˜å‚¨](#6-æ—¥å¿—ç®¡ç†ä¸å­˜å‚¨)
7. [å®æˆ˜ç»¼åˆæ¡ˆä¾‹](#7-å®æˆ˜ç»¼åˆæ¡ˆä¾‹)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” è®¿é—®æ—¥å¿—ç›‘æ§æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯è®¿é—®æ—¥å¿—ç›‘æ§


**ç®€å•ç†è§£**ï¼šå°±åƒé—¨å«è®°å½•è¿›å‡ºäººå‘˜ä¿¡æ¯ä¸€æ ·ï¼Œè®¿é—®æ—¥å¿—ç›‘æ§å°±æ˜¯è®°å½•æ¯ä¸€ä¸ªç”¨æˆ·è®¿é—®ç½‘ç«™çš„è¯¦ç»†ä¿¡æ¯ã€‚

```
ç°å®ç”Ÿæ´»ç±»æ¯”ï¼š
å°åŒºé—¨å«ç™»è®°æœ¬ â†’ ç½‘ç«™è®¿é—®æ—¥å¿—
è®°å½•å†…å®¹ï¼š
- è®¿å®¢å§“å     â†’ ç”¨æˆ·IPåœ°å€
- æ¥è®¿æ—¶é—´     â†’ è®¿é—®æ—¶é—´  
- è®¿é—®æ¥¼æ ‹     â†’ è®¿é—®çš„é¡µé¢
- åœç•™æ—¶é•¿     â†’ å“åº”æ—¶é—´
- è”ç³»æ–¹å¼     â†’ æµè§ˆå™¨ä¿¡æ¯
```

**ğŸ”¸ ä¸ºä»€ä¹ˆéœ€è¦è®¿é—®æ—¥å¿—ç›‘æ§ï¼Ÿ**

- **ğŸ” äº†è§£ç”¨æˆ·è¡Œä¸º**ï¼šçŸ¥é“ç”¨æˆ·æœ€å–œæ¬¢è®¿é—®å“ªäº›é¡µé¢
- **âš¡ å‘ç°æ€§èƒ½é—®é¢˜**ï¼šæ‰¾å‡ºå“åº”æ…¢çš„é¡µé¢å¹¶ä¼˜åŒ–  
- **ğŸ”’ å®‰å…¨é˜²æŠ¤**ï¼šåŠæ—¶å‘ç°å¼‚å¸¸è®¿é—®å’Œæ”»å‡»è¡Œä¸º
- **ğŸ“Š æ•°æ®åˆ†æ**ï¼šä¸ºäº§å“æ”¹è¿›æä¾›æ•°æ®æ”¯æŒ
- **ğŸš¨ æ•…éšœæ’æŸ¥**ï¼šå‡ºç°é—®é¢˜æ—¶èƒ½å¿«é€Ÿå®šä½åŸå› 

### 1.2 è®¿é—®æ—¥å¿—åŒ…å«çš„æ ¸å¿ƒä¿¡æ¯


```
ä¸€æ¡å®Œæ•´çš„è®¿é—®æ—¥å¿—é€šå¸¸åŒ…å«ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è®¿é—®æ—¶é—´: 2025-01-16 14:30:25          â”‚
â”‚ å®¢æˆ·ç«¯IP: 192.168.1.100                â”‚  
â”‚ è¯·æ±‚æ–¹æ³•: GET                           â”‚
â”‚ è®¿é—®è·¯å¾„: /user/profile                â”‚
â”‚ å“åº”çŠ¶æ€: 200                           â”‚
â”‚ å“åº”æ—¶é—´: 156ms                         â”‚
â”‚ æµè§ˆå™¨ä¿¡æ¯: Chrome/96.0                 â”‚
â”‚ æ¥æºé¡µé¢: https://example.com/home     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 è¿‡æ»¤å™¨å®ç°ç›‘æ§çš„ä¼˜åŠ¿


**ğŸ”¸ ä¸ºä»€ä¹ˆç”¨è¿‡æ»¤å™¨è€Œä¸æ˜¯å…¶ä»–æ–¹å¼ï¼Ÿ**

```
å…¶ä»–æ–¹å¼çš„å±€é™æ€§ï¼š

æ–¹å¼ä¸€ï¼šåœ¨æ¯ä¸ªServletä¸­æ‰‹å†™æ—¥å¿—ä»£ç 
âŒ ä»£ç é‡å¤ï¼Œç»´æŠ¤å›°éš¾
âŒ å®¹æ˜“é—æ¼ï¼Œä¸å¤Ÿç»Ÿä¸€
âŒ ä¿®æ”¹éº»çƒ¦ï¼Œå½±å“ä¸šåŠ¡é€»è¾‘

æ–¹å¼äºŒï¼šä½¿ç”¨AOPåˆ‡é¢
âš ï¸ é…ç½®å¤æ‚ï¼Œå­¦ä¹ æˆæœ¬é«˜
âš ï¸ ä¾èµ–Springæ¡†æ¶

è¿‡æ»¤å™¨æ–¹å¼çš„ä¼˜åŠ¿ï¼š
âœ… è‡ªåŠ¨æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼Œæ— é—æ¼
âœ… ä»£ç é›†ä¸­ï¼Œç»´æŠ¤ç®€å•
âœ… ä¸å½±å“ä¸šåŠ¡é€»è¾‘
âœ… é…ç½®çµæ´»ï¼Œæ˜“äºå¼€å…³
```

---

## 2. ğŸ“Š è¯·æ±‚ä¿¡æ¯æ”¶é›†


### 2.1 åŸºæœ¬è¯·æ±‚ä¿¡æ¯è·å–


**ğŸ”¸ IPåœ°å€è·å–çš„æ­£ç¡®æ–¹æ³•**

å¾ˆå¤šæ–°æ‰‹ç›´æ¥ç”¨ `request.getRemoteAddr()` è·å–IPï¼Œä½†è¿™æ ·å¯èƒ½æ‹¿ä¸åˆ°çœŸå®IPã€‚

```java
public class AccessLogFilter implements Filter {
    
    /**
     * è·å–çœŸå®IPåœ°å€çš„å®Œæ•´æ–¹æ³•
     * ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¹ˆå¤æ‚ï¼Ÿå› ä¸ºç”¨æˆ·å¯èƒ½é€šè¿‡ä»£ç†æœåŠ¡å™¨è®¿é—®
     */
    private String getRealIpAddress(HttpServletRequest request) {
        String ip = null;
        
        // 1. å…ˆæ£€æŸ¥X-Forwarded-Forè¯·æ±‚å¤´ï¼ˆæœ€å¸¸ç”¨ï¼‰
        ip = request.getHeader("X-Forwarded-For");
        if (isValidIp(ip)) {
            // X-Forwarded-Forå¯èƒ½åŒ…å«å¤šä¸ªIPï¼Œå–ç¬¬ä¸€ä¸ª
            return ip.split(",")[0].trim();
        }
        
        // 2. æ£€æŸ¥X-Real-IPè¯·æ±‚å¤´ï¼ˆNginxå¸¸ç”¨ï¼‰
        ip = request.getHeader("X-Real-IP");
        if (isValidIp(ip)) {
            return ip;
        }
        
        // 3. æ£€æŸ¥å…¶ä»–ä»£ç†æœåŠ¡å™¨è®¾ç½®çš„è¯·æ±‚å¤´
        ip = request.getHeader("Proxy-Client-IP");
        if (isValidIp(ip)) return ip;
        
        ip = request.getHeader("WL-Proxy-Client-IP");
        if (isValidIp(ip)) return ip;
        
        // 4. æœ€åä½¿ç”¨ç›´è¿IP
        return request.getRemoteAddr();
    }
    
    /**
     * åˆ¤æ–­IPæ˜¯å¦æœ‰æ•ˆ
     * unknownè¡¨ç¤ºé€šè¿‡ä»£ç†ä½†æ— æ³•è·å–çœŸå®IP
     */
    private boolean isValidIp(String ip) {
        return ip != null && 
               ip.length() > 0 && 
               !"unknown".equalsIgnoreCase(ip);
    }
}
```

**ğŸ”¸ ç”¨æˆ·ä»£ç†ä¿¡æ¯è§£æ**

User-AgentåŒ…å«äº†ç”¨æˆ·æµè§ˆå™¨ã€æ“ä½œç³»ç»Ÿç­‰é‡è¦ä¿¡æ¯ï¼š

```java
/**
 * è§£æç”¨æˆ·ä»£ç†ä¿¡æ¯
 * User-Agentåƒæ˜¯ç”¨æˆ·çš„"èº«ä»½è¯"ï¼Œå‘Šè¯‰æœåŠ¡å™¨å®¢æˆ·ç«¯çš„è¯¦ç»†ä¿¡æ¯
 */
private Map<String, String> parseUserAgent(HttpServletRequest request) {
    String userAgent = request.getHeader("User-Agent");
    Map<String, String> info = new HashMap<>();
    
    if (userAgent == null) {
        info.put("browser", "Unknown");
        info.put("os", "Unknown");
        return info;
    }
    
    // ç®€å•çš„æµè§ˆå™¨è¯†åˆ«ï¼ˆå®é™…é¡¹ç›®å¯ä½¿ç”¨ä¸“é—¨çš„åº“ï¼‰
    if (userAgent.contains("Chrome")) {
        info.put("browser", "Chrome");
    } else if (userAgent.contains("Firefox")) {
        info.put("browser", "Firefox");
    } else if (userAgent.contains("Safari")) {
        info.put("browser", "Safari");
    } else {
        info.put("browser", "Other");
    }
    
    // æ“ä½œç³»ç»Ÿè¯†åˆ«
    if (userAgent.contains("Windows")) {
        info.put("os", "Windows");
    } else if (userAgent.contains("Mac")) {
        info.put("os", "Mac");
    } else if (userAgent.contains("Linux")) {
        info.put("os", "Linux");
    } else {
        info.put("os", "Other");
    }
    
    return info;
}
```

### 2.2 è¯·æ±‚å‚æ•°è®°å½•


**ğŸ”¸ å®‰å…¨åœ°è®°å½•è¯·æ±‚å‚æ•°**

è®°å½•å‚æ•°æ—¶è¦æ³¨æ„éšç§ä¿æŠ¤ï¼Œå¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ä¸èƒ½æ˜æ–‡è®°å½•ï¼š

```java
/**
 * å®‰å…¨åœ°è·å–è¯·æ±‚å‚æ•°
 * æ•æ„Ÿå‚æ•°ä¼šè¢«é®ç½©å¤„ç†ï¼Œä¿æŠ¤ç”¨æˆ·éšç§
 */
private String getRequestParameters(HttpServletRequest request) {
    Map<String, String[]> paramMap = request.getParameterMap();
    if (paramMap.isEmpty()) {
        return "æ— å‚æ•°";
    }
    
    StringBuilder params = new StringBuilder();
    // éœ€è¦é®ç½©çš„æ•æ„Ÿå‚æ•°å
    Set<String> sensitiveParams = new HashSet<>(Arrays.asList(
        "password", "pwd", "token", "secret", "key"
    ));
    
    for (Map.Entry<String, String[]> entry : paramMap.entrySet()) {
        String paramName = entry.getKey();
        String[] values = entry.getValue();
        
        if (params.length() > 0) {
            params.append("&");
        }
        
        params.append(paramName).append("=");
        
        // æ•æ„Ÿå‚æ•°é®ç½©å¤„ç†
        if (sensitiveParams.contains(paramName.toLowerCase())) {
            params.append("***");
        } else {
            params.append(String.join(",", values));
        }
    }
    
    return params.toString();
}
```

---

## 3. â±ï¸ å“åº”æ—¶é—´ç»Ÿè®¡


### 3.1 æ—¶é—´æµ‹é‡çš„åŸºæœ¬åŸç†


**ğŸ”¸ ç†è§£å“åº”æ—¶é—´æµ‹é‡**

å“åº”æ—¶é—´å°±åƒè®¡æ—¶ç§’è¡¨ï¼Œè®°å½•ä»ç”¨æˆ·å‘èµ·è¯·æ±‚åˆ°æœåŠ¡å™¨è¿”å›å“åº”çš„æ€»è€—æ—¶ï¼š

```
æ—¶é—´æµ‹é‡è¿‡ç¨‹ï¼š
ç”¨æˆ·ç‚¹å‡»é“¾æ¥ â”€â”€â–¶ å¼€å§‹è®¡æ—¶ â”€â”€â–¶ æœåŠ¡å™¨å¤„ç† â”€â”€â–¶ åœæ­¢è®¡æ—¶ â”€â”€â–¶ è®¡ç®—è€—æ—¶

Filterçš„æµ‹é‡æ—¶æœºï¼š
è¯·æ±‚åˆ°è¾¾Filter â”€â”€â–¶ è®°å½•å¼€å§‹æ—¶é—´ â”€â”€â–¶ è°ƒç”¨åç»­å¤„ç† â”€â”€â–¶ è¿”å›Filter â”€â”€â–¶ è®¡ç®—æ€»è€—æ—¶
```

### 3.2 ç²¾ç¡®çš„æ—¶é—´ç»Ÿè®¡å®ç°


```java
@WebFilter("/*")
public class ResponseTimeFilter implements Filter {
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                        FilterChain chain) throws IOException, ServletException {
        
        HttpServletRequest httpRequest = (HttpServletRequest) request;
        HttpServletResponse httpResponse = (HttpServletResponse) response;
        
        // 1. è®°å½•å¼€å§‹æ—¶é—´ï¼ˆä½¿ç”¨çº³ç§’çº§ç²¾åº¦ï¼‰
        long startTime = System.nanoTime();
        
        try {
            // 2. ç»§ç»­æ‰§è¡Œåç»­å¤„ç†
            chain.doFilter(request, response);
            
        } finally {
            // 3. è®¡ç®—å“åº”æ—¶é—´ï¼ˆç¡®ä¿ä¸€å®šä¼šæ‰§è¡Œï¼‰
            long endTime = System.nanoTime();
            long responseTimeNanos = endTime - startTime;
            
            // è½¬æ¢ä¸ºæ¯«ç§’ï¼Œä¿ç•™3ä½å°æ•°
            double responseTimeMs = responseTimeNanos / 1_000_000.0;
            
            // 4. è®°å½•æ—¥å¿—
            logResponseTime(httpRequest, httpResponse, responseTimeMs);
        }
    }
    
    /**
     * è®°å½•å“åº”æ—¶é—´æ—¥å¿—
     */
    private void logResponseTime(HttpServletRequest request, 
                               HttpServletResponse response, 
                               double responseTime) {
        
        String logMessage = String.format(
            "[å“åº”æ—¶é—´ç»Ÿè®¡] %s %s - %d - %.3f ms", 
            request.getMethod(),           // GET/POST
            request.getRequestURI(),       // è¯·æ±‚è·¯å¾„  
            response.getStatus(),          // å“åº”çŠ¶æ€ç 
            responseTime                   // å“åº”æ—¶é—´
        );
        
        // æ ¹æ®å“åº”æ—¶é—´åˆ¤æ–­æ€§èƒ½ç­‰çº§
        if (responseTime > 3000) {
            logger.warn("âš ï¸ æ…¢è¯·æ±‚: " + logMessage);
        } else if (responseTime > 1000) {
            logger.info("ğŸŸ¡ è¾ƒæ…¢: " + logMessage);
        } else {
            logger.info("âœ… æ­£å¸¸: " + logMessage);
        }
    }
}
```

**ğŸ”¸ ä¸ºä»€ä¹ˆä½¿ç”¨finallyå—ï¼Ÿ**

```java
// âŒ ä¸å¥½çš„å†™æ³•
long startTime = System.currentTimeMillis();
chain.doFilter(request, response);
long endTime = System.currentTimeMillis();
// å¦‚æœå¤„ç†è¿‡ç¨‹ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œè¿™è¡Œä»£ç ä¸ä¼šæ‰§è¡Œï¼

// âœ… æ­£ç¡®çš„å†™æ³•  
long startTime = System.currentTimeMillis();
try {
    chain.doFilter(request, response);
} finally {
    long endTime = System.currentTimeMillis();
    // æ— è®ºæ˜¯å¦æœ‰å¼‚å¸¸ï¼Œè¿™é‡Œéƒ½ä¼šæ‰§è¡Œ
}
```

### 3.3 æ€§èƒ½åˆ†çº§é¢„è­¦


åŸºäºå“åº”æ—¶é—´è¿›è¡Œæ€§èƒ½åˆ†çº§ï¼Œå¸®åŠ©å¿«é€Ÿè¯†åˆ«é—®é¢˜ï¼š

```java
/**
 * æ€§èƒ½ç­‰çº§è¯„ä¼°
 * å°±åƒä½“æ£€æŠ¥å‘Šä¸€æ ·ï¼Œç»™æ¯ä¸ªè¯·æ±‚çš„æ€§èƒ½æ‰“åˆ†
 */
private void evaluatePerformance(double responseTime, String uri) {
    PerformanceLevel level;
    String emoji;
    String suggestion;
    
    if (responseTime < 100) {
        level = PerformanceLevel.EXCELLENT;
        emoji = "ğŸš€";
        suggestion = "æ€§èƒ½ä¼˜ç§€";
    } else if (responseTime < 500) {
        level = PerformanceLevel.GOOD;
        emoji = "âœ…";
        suggestion = "æ€§èƒ½è‰¯å¥½";
    } else if (responseTime < 1000) {
        level = PerformanceLevel.NORMAL;
        emoji = "ğŸŸ¡";
        suggestion = "æ€§èƒ½ä¸€èˆ¬ï¼Œå¯ä»¥ä¼˜åŒ–";
    } else if (responseTime < 3000) {
        level = PerformanceLevel.SLOW;
        emoji = "âš ï¸";
        suggestion = "å“åº”è¾ƒæ…¢ï¼Œéœ€è¦ä¼˜åŒ–";
    } else {
        level = PerformanceLevel.VERY_SLOW;
        emoji = "ğŸ”´";
        suggestion = "ä¸¥é‡æ€§èƒ½é—®é¢˜ï¼Œæ€¥éœ€ä¼˜åŒ–";
    }
    
    logger.info("{} [{}] {} - {:.2f}ms - {}", 
        emoji, level, uri, responseTime, suggestion);
}

enum PerformanceLevel {
    EXCELLENT, GOOD, NORMAL, SLOW, VERY_SLOW
}
```

---

## 4. ğŸ‘¤ ç”¨æˆ·è®¿é—®åˆ†æ


### 4.1 è®¿é—®æ¥æºåˆ†æ


**ğŸ”¸ ç†è§£Refererçš„ä½œç”¨**

Refererå‘Šè¯‰æˆ‘ä»¬ç”¨æˆ·æ˜¯ä»å“ªä¸ªé¡µé¢è·³è½¬è¿‡æ¥çš„ï¼Œå°±åƒé—®è·¯æ—¶è¯´"æˆ‘ä»å“ªé‡Œæ¥"ï¼š

```java
/**
 * åˆ†æè®¿é—®æ¥æº
 * Refererå°±åƒ"æ¥è·¯"ï¼Œå‘Šè¯‰æˆ‘ä»¬ç”¨æˆ·çš„ä¸Šä¸€ç«™æ˜¯å“ªé‡Œ
 */
private void analyzeReferrer(HttpServletRequest request) {
    String referer = request.getHeader("Referer");
    
    if (referer == null || referer.isEmpty()) {
        logger.info("ğŸ“ ç›´æ¥è®¿é—® - ç”¨æˆ·ç›´æ¥è¾“å…¥ç½‘å€æˆ–æ”¶è—å¤¹è®¿é—®");
        return;
    }
    
    try {
        URL refererUrl = new URL(referer);
        String refererHost = refererUrl.getHost();
        String currentHost = request.getServerName();
        
        if (refererHost.equals(currentHost)) {
            logger.info("ğŸ”„ ç«™å†…è·³è½¬ - ä» {} è·³è½¬åˆ°å½“å‰é¡µé¢", referer);
        } else {
            logger.info("ğŸŒ å¤–éƒ¨æ¥æº - ä»å¤–éƒ¨ç½‘ç«™ {} è®¿é—®", refererHost);
            
            // åˆ†ææ˜¯å¦æ¥è‡ªæœç´¢å¼•æ“
            analyzeSearchEngine(refererHost, referer);
        }
        
    } catch (Exception e) {
        logger.warn("âš ï¸ æ— æ³•è§£ææ¥æºåœ°å€: {}", referer);
    }
}

/**
 * è¯†åˆ«æœç´¢å¼•æ“æ¥æº
 */
private void analyzeSearchEngine(String host, String referer) {
    Map<String, String> searchEngines = Map.of(
        "google.com", "Googleæœç´¢",
        "baidu.com", "ç™¾åº¦æœç´¢", 
        "bing.com", "å¿…åº”æœç´¢",
        "sogou.com", "æœç‹—æœç´¢"
    );
    
    for (Map.Entry<String, String> entry : searchEngines.entrySet()) {
        if (host.contains(entry.getKey())) {
            logger.info("ğŸ” æœç´¢å¼•æ“æ¥æº - {}", entry.getValue());
            return;
        }
    }
}
```

### 4.2 ä¼šè¯è·Ÿè¸ªåˆ†æ


**ğŸ”¸ ç”¨æˆ·ä¼šè¯çš„æ¦‚å¿µ**

ä¼šè¯å°±åƒç”¨æˆ·åœ¨ç½‘ç«™ä¸Šçš„"ä¸€æ¬¡è´­ç‰©è¡Œç¨‹"ï¼Œä»è¿›å…¥åˆ°ç¦»å¼€çš„æ•´ä¸ªè¿‡ç¨‹ï¼š

```java
/**
 * ä¼šè¯ä¿¡æ¯åˆ†æ
 * ä¼šè¯åƒæ˜¯ç”¨æˆ·çš„"è´­ç‰©è½¦"ï¼Œè®°å½•è¿™æ¬¡è®¿é—®çš„æ‰€æœ‰æ´»åŠ¨
 */
private void analyzeSession(HttpServletRequest request) {
    HttpSession session = request.getSession(false);
    
    if (session == null) {
        logger.info("ğŸ‘¤ æ–°è®¿å®¢ - é¦–æ¬¡è®¿é—®ï¼Œå°šæœªå»ºç«‹ä¼šè¯");
        return;
    }
    
    // ä¼šè¯åŸºæœ¬ä¿¡æ¯
    String sessionId = session.getId();
    long createTime = session.getCreationTime();
    long lastAccessTime = session.getLastAccessedTime();
    int maxInactiveInterval = session.getMaxInactiveInterval();
    
    // è®¡ç®—ä¼šè¯æŒç»­æ—¶é—´
    long sessionDuration = System.currentTimeMillis() - createTime;
    long idleTime = System.currentTimeMillis() - lastAccessTime;
    
    logger.info("ğŸ”— ä¼šè¯ä¿¡æ¯:");
    logger.info("  ID: {}", sessionId.substring(0, 8) + "..."); // åªæ˜¾ç¤ºå‰8ä½
    logger.info("  æŒç»­æ—¶é—´: {} åˆ†é’Ÿ", sessionDuration / 60000);
    logger.info("  ç©ºé—²æ—¶é—´: {} ç§’", idleTime / 1000);
    logger.info("  è¶…æ—¶è®¾ç½®: {} åˆ†é’Ÿ", maxInactiveInterval / 60);
    
    // ç»Ÿè®¡ä¼šè¯ä¸­çš„é¡µé¢è®¿é—®æ•°
    Integer pageViews = (Integer) session.getAttribute("pageViews");
    if (pageViews == null) {
        pageViews = 0;
    }
    pageViews++;
    session.setAttribute("pageViews", pageViews);
    
    logger.info("  é¡µé¢æµè§ˆæ•°: {} é¡µ", pageViews);
}
```

---

## 5. ğŸ“ˆ æ€§èƒ½ç›‘æ§å®ç°


### 5.1 ç³»ç»Ÿèµ„æºç›‘æ§


**ğŸ”¸ ç›‘æ§æœåŠ¡å™¨èµ„æºä½¿ç”¨æƒ…å†µ**

é™¤äº†å“åº”æ—¶é—´ï¼Œè¿˜è¦å…³æ³¨æœåŠ¡å™¨çš„"å¥åº·çŠ¶å†µ"ï¼š

```java
/**
 * ç³»ç»Ÿèµ„æºç›‘æ§
 * å°±åƒç»™æœåŠ¡å™¨åšä½“æ£€ï¼Œæ£€æŸ¥CPUã€å†…å­˜ç­‰å„é¡¹æŒ‡æ ‡
 */
private void monitorSystemResources() {
    // è·å–è¿è¡Œæ—¶ä¿¡æ¯
    Runtime runtime = Runtime.getRuntime();
    MemoryMXBean memoryBean = ManagementFactory.getMemoryMXBean();
    OperatingSystemMXBean osBean = ManagementFactory.getOperatingSystemMXBean();
    
    // å†…å­˜ä½¿ç”¨æƒ…å†µ
    long totalMemory = runtime.totalMemory();      // æ€»å†…å­˜
    long freeMemory = runtime.freeMemory();        // ç©ºé—²å†…å­˜  
    long usedMemory = totalMemory - freeMemory;    // å·²ç”¨å†…å­˜
    long maxMemory = runtime.maxMemory();          // æœ€å¤§å¯ç”¨å†…å­˜
    
    double memoryUsagePercent = (double) usedMemory / maxMemory * 100;
    
    // CPUè´Ÿè½½ï¼ˆå¦‚æœå¯è·å–ï¼‰
    double cpuLoad = osBean.getProcessCpuLoad() * 100;
    
    // çº¿ç¨‹æ•°ç»Ÿè®¡
    ThreadMXBean threadBean = ManagementFactory.getThreadMXBean();
    int threadCount = threadBean.getThreadCount();
    
    // æ€§èƒ½æŠ¥å‘Š
    logger.info("ğŸ“Š ç³»ç»Ÿèµ„æºçŠ¶å†µ:");
    logger.info("  å†…å­˜ä½¿ç”¨: {:.1f}% ({}/{} MB)", 
        memoryUsagePercent,
        usedMemory / 1024 / 1024,
        maxMemory / 1024 / 1024);
    logger.info("  CPUè´Ÿè½½: {:.1f}%", cpuLoad);
    logger.info("  æ´»åŠ¨çº¿ç¨‹: {} ä¸ª", threadCount);
    
    // èµ„æºé¢„è­¦
    if (memoryUsagePercent > 80) {
        logger.warn("âš ï¸ å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜: {:.1f}%", memoryUsagePercent);
    }
    if (cpuLoad > 80) {
        logger.warn("âš ï¸ CPUè´Ÿè½½è¿‡é«˜: {:.1f}%", cpuLoad);
    }
}
```

### 5.2 å¹¶å‘è®¿é—®ç›‘æ§


**ğŸ”¸ ç›‘æ§åŒæ—¶åœ¨çº¿ç”¨æˆ·æ•°**

```java
public class ConcurrentAccessMonitor {
    
    // ä½¿ç”¨åŸå­è®¡æ•°å™¨ï¼Œçº¿ç¨‹å®‰å…¨
    private static final AtomicInteger concurrentUsers = new AtomicInteger(0);
    private static final AtomicInteger totalRequests = new AtomicInteger(0);
    
    /**
     * è®°å½•ç”¨æˆ·è®¿é—®å¼€å§‹
     */
    public static void recordAccessStart() {
        int current = concurrentUsers.incrementAndGet();
        int total = totalRequests.incrementAndGet();
        
        logger.info("ğŸ‘¥ å¹¶å‘ç›‘æ§: å½“å‰åœ¨çº¿ {} äººï¼Œç´¯è®¡è¯·æ±‚ {} æ¬¡", current, total);
        
        // å¹¶å‘æ•°é¢„è­¦
        if (current > 100) {
            logger.warn("âš ï¸ å¹¶å‘ç”¨æˆ·æ•°è¾ƒé«˜: {} äºº", current);
        }
    }
    
    /**
     * è®°å½•ç”¨æˆ·è®¿é—®ç»“æŸ
     */
    public static void recordAccessEnd() {
        int current = concurrentUsers.decrementAndGet();
        logger.debug("ğŸ‘¤ ç”¨æˆ·ç¦»å¼€ï¼Œå½“å‰åœ¨çº¿: {} äºº", current);
    }
    
    /**
     * è·å–å½“å‰ç»Ÿè®¡ä¿¡æ¯
     */
    public static Map<String, Integer> getStatistics() {
        Map<String, Integer> stats = new HashMap<>();
        stats.put("concurrent", concurrentUsers.get());
        stats.put("total", totalRequests.get());
        return stats;
    }
}
```

---

## 6. ğŸ’¾ æ—¥å¿—ç®¡ç†ä¸å­˜å‚¨


### 6.1 æ—¥å¿—æ ¼å¼è®¾è®¡


**ğŸ”¸ è®¾è®¡æ˜“è¯»çš„æ—¥å¿—æ ¼å¼**

æ—¥å¿—æ ¼å¼è¦è§„èŒƒç»Ÿä¸€ï¼Œæ–¹ä¾¿åç»­åˆ†æï¼š

```java
/**
 * è®¿é—®æ—¥å¿—å®ä½“ç±»
 * å®šä¹‰æ ‡å‡†çš„æ—¥å¿—è®°å½•æ ¼å¼
 */
public class AccessLogEntry {
    private String timestamp;        // è®¿é—®æ—¶é—´
    private String clientIp;         // å®¢æˆ·ç«¯IP
    private String method;           // è¯·æ±‚æ–¹æ³•
    private String uri;              // è¯·æ±‚è·¯å¾„
    private String queryString;      // æŸ¥è¯¢å‚æ•°
    private int statusCode;          // å“åº”çŠ¶æ€ç 
    private double responseTime;     // å“åº”æ—¶é—´(ms)
    private String userAgent;        // ç”¨æˆ·ä»£ç†
    private String referer;          // æ¥æºé¡µé¢
    private String sessionId;        // ä¼šè¯ID
    
    /**
     * æ ¼å¼åŒ–ä¸ºæ˜“è¯»çš„æ—¥å¿—å­—ç¬¦ä¸²
     * ä½¿ç”¨åˆ¶è¡¨ç¬¦åˆ†éš”ï¼Œæ–¹ä¾¿Excelç­‰å·¥å…·å¯¼å…¥åˆ†æ
     */
    public String toLogString() {
        return String.join("\t",
            timestamp,
            clientIp,
            method,
            uri,
            queryString != null ? queryString : "-",
            String.valueOf(statusCode),
            String.format("%.3f", responseTime),
            userAgent,
            referer != null ? referer : "-",
            sessionId.substring(0, 8) + "..."  // åªæ˜¾ç¤ºéƒ¨åˆ†ä¼šè¯ID
        );
    }
    
    /**
     * æ ¼å¼åŒ–ä¸ºJSONæ ¼å¼ï¼ˆä¾¿äºç¨‹åºå¤„ç†ï¼‰
     */
    public String toJson() {
        return String.format(
            "{\"timestamp\":\"%s\",\"ip\":\"%s\",\"method\":\"%s\"," +
            "\"uri\":\"%s\",\"status\":%d,\"responseTime\":%.3f}",
            timestamp, clientIp, method, uri, statusCode, responseTime
        );
    }
}
```

### 6.2 æ—¥å¿—è½®è½¬ä¸å­˜å‚¨


**ğŸ”¸ é˜²æ­¢æ—¥å¿—æ–‡ä»¶è¿‡å¤§**

æ—¥å¿—æ–‡ä»¶ä¼šè¶Šæ¥è¶Šå¤§ï¼Œéœ€è¦å®šæœŸ"æ¢æœ¬å­"ï¼š

```java
/**
 * æ—¥å¿—è½®è½¬ç®¡ç†å™¨
 * å°±åƒæ¢ç¬”è®°æœ¬ä¸€æ ·ï¼Œå®šæœŸåˆ›å»ºæ–°çš„æ—¥å¿—æ–‡ä»¶
 */
public class LogRotationManager {
    
    private static final String LOG_DIR = "logs/access/";
    private static final long MAX_FILE_SIZE = 10 * 1024 * 1024; // 10MB
    private PrintWriter currentWriter;
    private String currentLogFile;
    
    public LogRotationManager() {
        // åˆ›å»ºæ—¥å¿—ç›®å½•
        new File(LOG_DIR).mkdirs();
        createNewLogFile();
    }
    
    /**
     * å†™å…¥æ—¥å¿—è®°å½•
     */
    public synchronized void writeLog(AccessLogEntry entry) {
        // æ£€æŸ¥æ˜¯å¦éœ€è¦è½®è½¬
        checkRotation();
        
        if (currentWriter != null) {
            currentWriter.println(entry.toLogString());
            currentWriter.flush(); // ç«‹å³å†™å…¥ç£ç›˜
        }
    }
    
    /**
     * æ£€æŸ¥æ˜¯å¦éœ€è¦åˆ›å»ºæ–°çš„æ—¥å¿—æ–‡ä»¶
     */
    private void checkRotation() {
        File currentFile = new File(currentLogFile);
        
        // æ–‡ä»¶è¶…è¿‡å¤§å°é™åˆ¶æ—¶è½®è½¬
        if (currentFile.exists() && currentFile.length() > MAX_FILE_SIZE) {
            closeCurrentWriter();
            archiveCurrentLog();
            createNewLogFile();
            logger.info("ğŸ“ æ—¥å¿—è½®è½¬ - åˆ›å»ºæ–°çš„æ—¥å¿—æ–‡ä»¶: {}", currentLogFile);
        }
    }
    
    /**
     * åˆ›å»ºæ–°çš„æ—¥å¿—æ–‡ä»¶
     */
    private void createNewLogFile() {
        String timestamp = new SimpleDateFormat("yyyyMMdd_HHmmss").format(new Date());
        currentLogFile = LOG_DIR + "access_" + timestamp + ".log";
        
        try {
            currentWriter = new PrintWriter(new FileWriter(currentLogFile, true));
            // å†™å…¥æ—¥å¿—æ–‡ä»¶å¤´éƒ¨
            currentWriter.println("# è®¿é—®æ—¥å¿—æ–‡ä»¶ - " + new Date());
            currentWriter.println("# æ ¼å¼: æ—¶é—´\tIP\tæ–¹æ³•\tURI\tå‚æ•°\tçŠ¶æ€ç \tå“åº”æ—¶é—´\tæµè§ˆå™¨\tæ¥æº\tä¼šè¯ID");
        } catch (IOException e) {
            logger.error("âŒ åˆ›å»ºæ—¥å¿—æ–‡ä»¶å¤±è´¥: {}", e.getMessage());
        }
    }
    
    /**
     * å½’æ¡£å½“å‰æ—¥å¿—æ–‡ä»¶
     */
    private void archiveCurrentLog() {
        // å¯ä»¥å‹ç¼©æ—§æ—¥å¿—æ–‡ä»¶ä»¥èŠ‚çœç©ºé—´
        String archiveName = currentLogFile.replace(".log", "_archived.log.gz");
        // å®é™…é¡¹ç›®ä¸­å¯ä»¥ä½¿ç”¨gzipå‹ç¼©
        logger.info("ğŸ“¦ æ—¥å¿—å½’æ¡£: {} -> {}", currentLogFile, archiveName);
    }
}
```

---

## 7. ğŸ¯ å®æˆ˜ç»¼åˆæ¡ˆä¾‹


### 7.1 å®Œæ•´çš„è®¿é—®æ—¥å¿—ç›‘æ§è¿‡æ»¤å™¨


å°†å‰é¢æ‰€æœ‰åŠŸèƒ½æ•´åˆæˆä¸€ä¸ªå®Œæ•´çš„ç›‘æ§è¿‡æ»¤å™¨ï¼š

```java
@WebFilter(filterName = "AccessLogFilter", urlPatterns = "/*")
public class ComprehensiveAccessLogFilter implements Filter {
    
    private static final Logger logger = LoggerFactory.getLogger(ComprehensiveAccessLogFilter.class);
    private LogRotationManager logManager;
    
    @Override
    public void init(FilterConfig filterConfig) throws ServletException {
        logManager = new LogRotationManager();
        logger.info("ğŸš€ è®¿é—®æ—¥å¿—ç›‘æ§è¿‡æ»¤å™¨å¯åŠ¨æˆåŠŸ");
    }
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                        FilterChain chain) throws IOException, ServletException {
        
        HttpServletRequest httpRequest = (HttpServletRequest) request;
        HttpServletResponse httpResponse = (HttpServletResponse) response;
        
        // è®°å½•è®¿é—®å¼€å§‹
        ConcurrentAccessMonitor.recordAccessStart();
        long startTime = System.nanoTime();
        
        try {
            // ç»§ç»­å¤„ç†è¯·æ±‚
            chain.doFilter(request, response);
            
        } finally {
            // è®¡ç®—å“åº”æ—¶é—´
            long responseTimeNanos = System.nanoTime() - startTime;
            double responseTimeMs = responseTimeNanos / 1_000_000.0;
            
            // åˆ›å»ºæ—¥å¿—è®°å½•
            AccessLogEntry logEntry = createLogEntry(httpRequest, httpResponse, responseTimeMs);
            
            // å†™å…¥æ—¥å¿—
            logManager.writeLog(logEntry);
            
            // æ§åˆ¶å°è¾“å‡ºï¼ˆå¼€å‘ç¯å¢ƒï¼‰
            logToConsole(logEntry);
            
            // è®°å½•è®¿é—®ç»“æŸ
            ConcurrentAccessMonitor.recordAccessEnd();
            
            // å®šæœŸè¾“å‡ºç³»ç»ŸçŠ¶æ€ï¼ˆæ¯100æ¬¡è¯·æ±‚ï¼‰
            if (ConcurrentAccessMonitor.getStatistics().get("total") % 100 == 0) {
                monitorSystemResources();
            }
        }
    }
    
    /**
     * åˆ›å»ºå®Œæ•´çš„æ—¥å¿—è®°å½•
     */
    private AccessLogEntry createLogEntry(HttpServletRequest request, 
                                        HttpServletResponse response, 
                                        double responseTime) {
        AccessLogEntry entry = new AccessLogEntry();
        
        // åŸºæœ¬ä¿¡æ¯
        entry.setTimestamp(new SimpleDateFormat("yyyy-MM-dd HH:mm:ss.SSS").format(new Date()));
        entry.setClientIp(getRealIpAddress(request));
        entry.setMethod(request.getMethod());
        entry.setUri(request.getRequestURI());
        entry.setQueryString(request.getQueryString());
        entry.setStatusCode(response.getStatus());
        entry.setResponseTime(responseTime);
        
        // å®¢æˆ·ç«¯ä¿¡æ¯
        entry.setUserAgent(request.getHeader("User-Agent"));
        entry.setReferer(request.getHeader("Referer"));
        
        // ä¼šè¯ä¿¡æ¯
        HttpSession session = request.getSession(false);
        if (session != null) {
            entry.setSessionId(session.getId());
        }
        
        return entry;
    }
    
    /**
     * æ§åˆ¶å°æ—¥å¿—è¾“å‡º
     */
    private void logToConsole(AccessLogEntry entry) {
        String emoji = getStatusEmoji(entry.getStatusCode());
        String timeColor = getTimeColor(entry.getResponseTime());
        
        logger.info("{} {} {} {} - {} - {}ms {}", 
            emoji,
            entry.getMethod(),
            entry.getUri(),
            entry.getClientIp(),
            entry.getStatusCode(),
            String.format("%.3f", entry.getResponseTime()),
            timeColor
        );
    }
    
    /**
     * æ ¹æ®çŠ¶æ€ç è¿”å›å¯¹åº”emoji
     */
    private String getStatusEmoji(int statusCode) {
        if (statusCode >= 200 && statusCode < 300) {
            return "âœ…"; // æˆåŠŸ
        } else if (statusCode >= 300 && statusCode < 400) {
            return "ğŸ”„"; // é‡å®šå‘
        } else if (statusCode >= 400 && statusCode < 500) {
            return "âŒ"; // å®¢æˆ·ç«¯é”™è¯¯
        } else if (statusCode >= 500) {
            return "ğŸ’¥"; // æœåŠ¡å™¨é”™è¯¯
        }
        return "â“"; // æœªçŸ¥
    }
    
    /**
     * æ ¹æ®å“åº”æ—¶é—´è¿”å›é¢œè‰²æ ‡è¯†
     */
    private String getTimeColor(double responseTime) {
        if (responseTime < 100) return "ğŸŸ¢";      // å¾ˆå¿«
        if (responseTime < 500) return "ğŸŸ¡";      // æ­£å¸¸
        if (responseTime < 1000) return "ğŸŸ ";     // è¾ƒæ…¢
        return "ğŸ”´";                               // å¾ˆæ…¢
    }
    
    // ... å…¶ä»–è¾…åŠ©æ–¹æ³•ï¼ˆgetRealIpAddressç­‰ï¼‰...
}
```

### 7.2 é…ç½®æ–‡ä»¶ç¤ºä¾‹


**web.xmlé…ç½®**ï¼š

```xml
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
         version="4.0">
    
    <!-- è®¿é—®æ—¥å¿—ç›‘æ§è¿‡æ»¤å™¨ -->
    <filter>
        <filter-name>AccessLogFilter</filter-name>
        <filter-class>com.example.filter.ComprehensiveAccessLogFilter</filter-class>
        
        <!-- é…ç½®å‚æ•° -->
        <init-param>
            <param-name>logLevel</param-name>
            <param-value>INFO</param-value>
        </init-param>
        <init-param>
            <param-name>excludePatterns</param-name>
            <param-value>*.css,*.js,*.jpg,*.png,*.gif</param-value>
        </init-param>
    </filter>
    
    <filter-mapping>
        <filter-name>AccessLogFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>
    
</web-app>
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ”¸ è®¿é—®æ—¥å¿—ç›‘æ§çš„æœ¬è´¨**
- è®°å½•ç”¨æˆ·è®¿é—®ç½‘ç«™çš„è¯¦ç»†ä¿¡æ¯ï¼Œå°±åƒé—¨å«ç™»è®°æœ¬
- é€šè¿‡è¿‡æ»¤å™¨è‡ªåŠ¨æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼Œæ— éœ€ä¿®æ”¹ä¸šåŠ¡ä»£ç 
- åŒ…å«æ—¶é—´ã€IPã€è¯·æ±‚ä¿¡æ¯ã€å“åº”çŠ¶æ€ã€è€—æ—¶ç­‰æ ¸å¿ƒæ•°æ®

**ğŸ”¸ å…³é”®æŠ€æœ¯è¦ç‚¹**
```
IPåœ°å€è·å–: è€ƒè™‘ä»£ç†æœåŠ¡å™¨ï¼Œä½¿ç”¨X-Forwarded-Forç­‰è¯·æ±‚å¤´
å“åº”æ—¶é—´æµ‹é‡: ä½¿ç”¨System.nanoTime()è·å¾—çº³ç§’çº§ç²¾åº¦
å‚æ•°è®°å½•: æ•æ„Ÿå‚æ•°éœ€è¦é®ç½©å¤„ç†ï¼Œä¿æŠ¤ç”¨æˆ·éšç§
æ—¥å¿—è½®è½¬: é˜²æ­¢å•ä¸ªæ–‡ä»¶è¿‡å¤§ï¼Œå®šæœŸåˆ›å»ºæ–°æ–‡ä»¶
å¹¶å‘ç›‘æ§: ä½¿ç”¨AtomicIntegerä¿è¯çº¿ç¨‹å®‰å…¨çš„è®¡æ•°
```

### 8.2 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ ä¸šåŠ¡ä»·å€¼**
- **ğŸ” ç”¨æˆ·è¡Œä¸ºåˆ†æ**: äº†è§£ç”¨æˆ·æœ€å¸¸è®¿é—®çš„åŠŸèƒ½
- **âš¡ æ€§èƒ½ä¼˜åŒ–æŒ‡å¯¼**: å‘ç°å“åº”æ…¢çš„é¡µé¢è¿›è¡Œä¼˜åŒ–
- **ğŸ”’ å®‰å…¨ç›‘æ§**: è¯†åˆ«å¼‚å¸¸è®¿é—®æ¨¡å¼å’Œæ½œåœ¨æ”»å‡»
- **ğŸ“Š æ•°æ®é©±åŠ¨å†³ç­–**: ä¸ºäº§å“æ”¹è¿›æä¾›æ•°æ®æ”¯æŒ

**ğŸ› ï¸ æŠ€æœ¯ä»·å€¼**
- **ğŸš¨ æ•…éšœå®šä½**: å¿«é€Ÿæ‰¾åˆ°å‡ºé—®é¢˜çš„åŠŸèƒ½æ¨¡å—
- **ğŸ“ˆ å®¹é‡è§„åˆ’**: æ ¹æ®è®¿é—®é‡è¶‹åŠ¿è§„åˆ’æœåŠ¡å™¨èµ„æº  
- **ğŸ”§ ç³»ç»Ÿè°ƒä¼˜**: åŸºäºçœŸå®æ•°æ®è¿›è¡Œç³»ç»Ÿå‚æ•°ä¼˜åŒ–

### 8.3 æœ€ä½³å®è·µå»ºè®®


**âœ… æ¨èåšæ³•**
```
æ—¥å¿—å†…å®¹: è®°å½•å…³é”®ä¿¡æ¯ï¼Œä½†é¿å…æ•æ„Ÿæ•°æ®æ³„éœ²
æ€§èƒ½å½±å“: å¼‚æ­¥å†™å…¥æ—¥å¿—ï¼Œä¸é˜»å¡æ­£å¸¸è¯·æ±‚å¤„ç†
å­˜å‚¨ç­–ç•¥: å®šæœŸè½®è½¬å’Œæ¸…ç†ï¼Œé¿å…ç£ç›˜ç©ºé—´è€—å°½
ç›‘æ§å‘Šè­¦: è®¾ç½®é˜ˆå€¼ï¼ŒåŠæ—¶å‘ç°æ€§èƒ½é—®é¢˜
æ•°æ®åˆ†æ: å®šæœŸåˆ†ææ—¥å¿—ï¼ŒæŒ–æ˜æœ‰ä»·å€¼çš„ä¿¡æ¯
```

**âŒ é¿å…é—®é¢˜**
```
è¿‡åº¦è®°å½•: ä¸è¦è®°å½•æ‰€æœ‰ç»†èŠ‚ï¼Œé‡ç‚¹å…³æ³¨æœ‰ä»·å€¼çš„ä¿¡æ¯
åŒæ­¥å†™å…¥: é¿å…åŒæ­¥å†™å…¥å¤§é‡æ—¥å¿—å½±å“æ€§èƒ½
å¿½ç•¥å¼‚å¸¸: ä½¿ç”¨finallyå—ç¡®ä¿ç›‘æ§ä»£ç ä¸€å®šæ‰§è¡Œ
æ•æ„Ÿä¿¡æ¯: å¯†ç ç­‰æ•æ„Ÿå‚æ•°å¿…é¡»é®ç½©æˆ–ä¸è®°å½•
èµ„æºæ³„éœ²: åŠæ—¶å…³é—­æ–‡ä»¶æµç­‰èµ„æº
```

### 8.4 æ‰©å±•å­¦ä¹ æ–¹å‘


**ğŸš€ è¿›é˜¶æ–¹å‘**
1. **ELKæ—¥å¿—åˆ†æ**: ä½¿ç”¨Elasticsearch + Logstash + Kibanaè¿›è¡Œæ—¥å¿—åˆ†æ
2. **å®æ—¶ç›‘æ§**: é›†æˆGrafanaç­‰å·¥å…·å®ç°å®æ—¶ç›‘æ§é¢æ¿
3. **æœºå™¨å­¦ä¹ **: ä½¿ç”¨MLç®—æ³•åˆ†æè®¿é—®æ¨¡å¼ï¼Œé¢„æµ‹å¼‚å¸¸è¡Œä¸º
4. **åˆ†å¸ƒå¼è·Ÿè¸ª**: åœ¨å¾®æœåŠ¡ç¯å¢ƒä¸­å®ç°é“¾è·¯è¿½è¸ª

**ğŸ’¡ æ ¸å¿ƒè®°å¿†è¦ç‚¹**
- è®¿é—®æ—¥å¿—åƒé—¨å«è®°å½•ï¼Œè®°å½•è°ã€ä½•æ—¶ã€åšä»€ä¹ˆã€ç»“æœå¦‚ä½•
- è¿‡æ»¤å™¨æ˜¯æœ€ä½³å®ç°æ–¹å¼ï¼Œè‡ªåŠ¨æ‹¦æˆªæ— é—æ¼
- å“åº”æ—¶é—´æµ‹é‡è¦ç²¾ç¡®ï¼Œä½¿ç”¨finallyç¡®ä¿æ‰§è¡Œ
- æ•æ„Ÿä¿¡æ¯è¦ä¿æŠ¤ï¼Œæ—¥å¿—æ–‡ä»¶è¦è½®è½¬
- æ•°æ®æœ‰ä»·å€¼ï¼Œåˆ†ææ‰æœ‰æ„ä¹‰