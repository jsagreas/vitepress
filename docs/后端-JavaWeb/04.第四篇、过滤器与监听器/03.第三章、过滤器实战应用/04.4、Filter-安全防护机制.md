---
title: 4ã€Filter-å®‰å…¨é˜²æŠ¤æœºåˆ¶
---
## ğŸ“š ç›®å½•

1. [å®‰å…¨é˜²æŠ¤æ¦‚è¿°](#1-å®‰å…¨é˜²æŠ¤æ¦‚è¿°)
2. [XSSè·¨ç«™è„šæœ¬é˜²æŠ¤](#2-XSSè·¨ç«™è„šæœ¬é˜²æŠ¤)
3. [SQLæ³¨å…¥é¢„é˜²](#3-SQLæ³¨å…¥é¢„é˜²)
4. [CSRFè·¨ç«™è¯·æ±‚ä¼ªé€ é˜²æŠ¤](#4-CSRFè·¨ç«™è¯·æ±‚ä¼ªé€ é˜²æŠ¤)
5. [æ•æ„Ÿè¯è¿‡æ»¤æœºåˆ¶](#5-æ•æ„Ÿè¯è¿‡æ»¤æœºåˆ¶)
6. [æ¶æ„è¯·æ±‚æ‹¦æˆª](#6-æ¶æ„è¯·æ±‚æ‹¦æˆª)
7. [é¢‘ç‡é™åˆ¶æ§åˆ¶](#7-é¢‘ç‡é™åˆ¶æ§åˆ¶)
8. [é»‘åå•ç®¡ç†ç³»ç»Ÿ](#8-é»‘åå•ç®¡ç†ç³»ç»Ÿ)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ›¡ï¸ å®‰å…¨é˜²æŠ¤æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯Webå®‰å…¨é˜²æŠ¤


**é€šä¿—ç†è§£**ï¼šå°±åƒç»™ä½ çš„æˆ¿å­è£…ä¸Šé—¨é”ã€é˜²ç›—çª—ä¸€æ ·ï¼ŒWebå®‰å…¨é˜²æŠ¤å°±æ˜¯ç»™ä½ çš„ç½‘ç«™åŠ ä¸Šå„ç§"å®‰å…¨é—¨"ï¼Œé˜²æ­¢åäººè¿›æ¥æç ´åã€‚

```
æ²¡æœ‰é˜²æŠ¤çš„ç½‘ç«™ = æ•å¼€å¤§é—¨çš„æˆ¿å­
æœ‰é˜²æŠ¤çš„ç½‘ç«™ = è£…äº†å„ç§å®‰å…¨è®¾å¤‡çš„æˆ¿å­

æˆ¿å­å®‰å…¨è®¾å¤‡               ç½‘ç«™å®‰å…¨é˜²æŠ¤
    é—¨é”          â†’        ç™»å½•éªŒè¯
    é˜²ç›—çª—        â†’        XSSé˜²æŠ¤
    ç›‘æ§æ‘„åƒå¤´    â†’        è®¿é—®æ—¥å¿—
    é—¨ç¦ç³»ç»Ÿ      â†’        è®¿é—®é¢‘ç‡é™åˆ¶
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦è¿‡æ»¤å™¨åšå®‰å…¨é˜²æŠ¤


**æ ¸å¿ƒåŸå› **ï¼šè¿‡æ»¤å™¨èƒ½åœ¨è¯·æ±‚åˆ°è¾¾çœŸæ­£çš„ä¸šåŠ¡ä»£ç ä¹‹å‰å°±æŠŠå±é™©çš„ä¸œè¥¿æ‹¦æˆªæ‰ï¼Œå°±åƒå®‰æ£€ä¸€æ ·ã€‚

> ğŸ’¡ **ç”Ÿæ´»æ¯”å–»**ï¼šè¿‡æ»¤å™¨å°±åƒæœºåœºå®‰æ£€ï¼Œåœ¨ä½ ä¸Šé£æœºå‰å°±æŠŠå±é™©ç‰©å“æŸ¥å‡ºæ¥ï¼Œè€Œä¸æ˜¯ç­‰ä½ ä¸Šäº†é£æœºæ‰å‘ç°é—®é¢˜ã€‚

**è¿‡æ»¤å™¨çš„å®‰å…¨ä¼˜åŠ¿**ï¼š
- âœ… **ç»Ÿä¸€é˜²æŠ¤**ï¼šä¸€ä¸ªåœ°æ–¹å†™ä»£ç ï¼Œå…¨ç«™éƒ½å—ä¿æŠ¤
- âœ… **æå‰æ‹¦æˆª**ï¼šåœ¨ä¸šåŠ¡é€»è¾‘æ‰§è¡Œå‰å°±é˜»æ­¢æ”»å‡»
- âœ… **é€æ˜å¤„ç†**ï¼šä¸šåŠ¡ä»£ç ä¸éœ€è¦å…³å¿ƒå®‰å…¨ç»†èŠ‚
- âœ… **å¯é…ç½®**ï¼šå¯ä»¥çµæ´»å¼€å¯å…³é—­ä¸åŒçš„é˜²æŠ¤åŠŸèƒ½

### 1.3 å¸¸è§Webå®‰å…¨å¨èƒ


```
Webå®‰å…¨å¨èƒå…¨æ™¯å›¾ï¼š

ç”¨æˆ·æµè§ˆå™¨ â†â†’ ç½‘ç»œä¼ è¾“ â†â†’ WebæœåŠ¡å™¨ â†â†’ æ•°æ®åº“
     â†“           â†“           â†“         â†“
   XSSæ”»å‡»    æ•°æ®åŠ«æŒ    æ¶æ„è¯·æ±‚   SQLæ³¨å…¥
   CSRF       DDoS       æ–‡ä»¶ä¸Šä¼    æƒé™ç»•è¿‡
```

| æ”»å‡»ç±»å‹ | **ç®€å•ç†è§£** | **å±å®³ç¨‹åº¦** | **é˜²æŠ¤æ–¹å¼** |
|---------|-------------|-------------|-------------|
| ğŸ­ **XSS** | `æ¶æ„è„šæœ¬ä¼ªè£…æˆæ­£å¸¸å†…å®¹` | `é«˜` | `å†…å®¹è¿‡æ»¤+è½¬ä¹‰` |
| ğŸ’‰ **SQLæ³¨å…¥** | `æ¶æ„SQLä»£ç æ··å…¥æŸ¥è¯¢` | `æé«˜` | `å‚æ•°æ£€æŸ¥+é¢„ç¼–è¯‘` |
| ğŸª **CSRF** | `å†’å……ç”¨æˆ·æ‰§è¡Œæ“ä½œ` | `é«˜` | `ä»¤ç‰ŒéªŒè¯` |
| ğŸš« **æ•æ„Ÿè¯** | `å‘å¸ƒè¿ç¦å†…å®¹` | `ä¸­` | `å…³é”®è¯è¿‡æ»¤` |
| ğŸ”¨ **æ¶æ„è¯·æ±‚** | `å¼‚å¸¸è®¿é—®æ¨¡å¼` | `ä¸­é«˜` | `è¡Œä¸ºåˆ†æ` |
| âš¡ **é¢‘ç‡æ”»å‡»** | `çŸ­æ—¶é—´å¤§é‡è¯·æ±‚` | `é«˜` | `è®¿é—®é™åˆ¶` |

---

## 2. ğŸ­ XSSè·¨ç«™è„šæœ¬é˜²æŠ¤


### 2.1 ä»€ä¹ˆæ˜¯XSSæ”»å‡»


**é€šä¿—è§£é‡Š**ï¼šXSSå°±åƒæœ‰äººåœ¨ä½ çš„ç•™è¨€æ¿ä¸Šå†™äº†çœ‹èµ·æ¥æ­£å¸¸çš„è¯ï¼Œä½†å®é™…ä¸Šè—ç€æ¶æ„ä»£ç ï¼Œå½“åˆ«äººçœ‹åˆ°è¿™æ¡ç•™è¨€æ—¶ï¼Œæ¶æ„ä»£ç å°±ä¼šæ‰§è¡Œã€‚

```
æ­£å¸¸ç•™è¨€ï¼šä½ å¥½ï¼Œæ¬¢è¿æ¥åˆ°æˆ‘çš„ç½‘ç«™ï¼
æ¶æ„ç•™è¨€ï¼šä½ å¥½ï¼Œæ¬¢è¿æ¥åˆ°æˆ‘çš„ç½‘ç«™ï¼<script>å·å–ç”¨æˆ·ä¿¡æ¯çš„ä»£ç </script>

å½“å…¶ä»–ç”¨æˆ·çœ‹åˆ°è¿™æ¡"ç•™è¨€"æ—¶ï¼Œæ¶æ„è„šæœ¬å°±ä¼šåœ¨ä»–ä»¬çš„æµè§ˆå™¨ä¸­æ‰§è¡Œ
```

### 2.2 XSSæ”»å‡»çš„ç±»å‹


**ğŸ”¸ å­˜å‚¨å‹XSSï¼ˆæœ€å±é™©ï¼‰**
```
æ”»å‡»è¿‡ç¨‹ï¼š
1. é»‘å®¢åœ¨è¯„è®ºåŒºæäº¤æ¶æ„è„šæœ¬
2. æœåŠ¡å™¨æŠŠæ¶æ„è„šæœ¬å­˜åˆ°æ•°æ®åº“
3. å…¶ä»–ç”¨æˆ·è®¿é—®é¡µé¢æ—¶ï¼Œæ¶æ„è„šæœ¬æ‰§è¡Œ
4. ç”¨æˆ·çš„cookieã€å¯†ç ç­‰è¢«ç›—å–

æ¯”å–»ï¼šåœ¨å…¬å‘Šæ è´´äº†æœ‰æ¯’çš„çº¸æ¡ï¼Œæ¯ä¸ªçœ‹åˆ°çš„äººéƒ½ä¸­æ¯’
```

**ğŸ”¸ åå°„å‹XSS**
```
æ”»å‡»è¿‡ç¨‹ï¼š
1. é»‘å®¢æ„é€ åŒ…å«æ¶æ„è„šæœ¬çš„é“¾æ¥
2. è¯±å¯¼ç”¨æˆ·ç‚¹å‡»è¿™ä¸ªé“¾æ¥
3. æœåŠ¡å™¨æŠŠæ¶æ„è„šæœ¬åŸæ ·è¿”å›ç»™ç”¨æˆ·
4. æ¶æ„è„šæœ¬åœ¨ç”¨æˆ·æµè§ˆå™¨æ‰§è¡Œ

æ¯”å–»ï¼šé•œå­åå°„ï¼Œä½ å¯¹ç€é•œå­åšä»€ä¹ˆï¼Œé•œå­å°±åå°„ä»€ä¹ˆ
```

### 2.3 XSSé˜²æŠ¤è¿‡æ»¤å™¨å®ç°


```java
/**
 * XSSæ”»å‡»é˜²æŠ¤è¿‡æ»¤å™¨
 * æ ¸å¿ƒæ€è·¯ï¼šæŠŠç”¨æˆ·è¾“å…¥ä¸­çš„å±é™©å­—ç¬¦è½¬ä¹‰æˆå®‰å…¨å­—ç¬¦
 */
public class XssFilter implements Filter {
    
    // éœ€è¦è¿‡æ»¤çš„å±é™©å­—ç¬¦æ¨¡å¼
    private static final String[] DANGEROUS_PATTERNS = {
        "<script", "</script", "javascript:", "vbscript:", 
        "onclick=", "onerror=", "onload=", "<iframe"
    };
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                        FilterChain chain) throws IOException, ServletException {
        
        // ä½¿ç”¨è£…é¥°å™¨æ¨¡å¼åŒ…è£…è¯·æ±‚ï¼Œæ‹¦æˆªå‚æ•°è·å–
        XssRequestWrapper wrappedRequest = new XssRequestWrapper(
            (HttpServletRequest) request);
        
        chain.doFilter(wrappedRequest, response);
    }
}
```

**XSSè¯·æ±‚åŒ…è£…ç±»**ï¼š
```java
public class XssRequestWrapper extends HttpServletRequestWrapper {
    
    public XssRequestWrapper(HttpServletRequest request) {
        super(request);
    }
    
    // é‡å†™è·å–å‚æ•°çš„æ–¹æ³•ï¼Œè‡ªåŠ¨æ¸…ç†XSS
    @Override
    public String getParameter(String name) {
        String value = super.getParameter(name);
        return cleanXss(value);
    }
    
    @Override
    public String[] getParameterValues(String name) {
        String[] values = super.getParameterValues(name);
        if (values != null) {
            for (int i = 0; i < values.length; i++) {
                values[i] = cleanXss(values[i]);
            }
        }
        return values;
    }
    
    // æ¸…ç†XSSçš„æ ¸å¿ƒæ–¹æ³•
    private String cleanXss(String value) {
        if (value == null) return null;
        
        // 1. ç§»é™¤å±é™©æ ‡ç­¾
        value = value.replaceAll("(?i)<script.*?>.*?</script>", "");
        value = value.replaceAll("(?i)<iframe.*?>.*?</iframe>", "");
        
        // 2. è½¬ä¹‰å±é™©å­—ç¬¦
        value = value.replace("<", "&lt;")
                    .replace(">", "&gt;")
                    .replace("\"", "&quot;")
                    .replace("'", "&#39;")
                    .replace("&", "&amp;");
        
        // 3. ç§»é™¤javascriptäº‹ä»¶
        value = value.replaceAll("(?i)javascript:", "");
        value = value.replaceAll("(?i)on\\w+\\s*=", "");
        
        return value;
    }
}
```

### 2.4 XSSé˜²æŠ¤é…ç½®


```xml
<!-- web.xmlä¸­é…ç½®XSSé˜²æŠ¤ -->
<filter>
    <filter-name>XssFilter</filter-name>
    <filter-class>com.example.filter.XssFilter</filter-class>
    <init-param>
        <param-name>strict-mode</param-name>
        <param-value>true</param-value> <!-- ä¸¥æ ¼æ¨¡å¼ï¼šæ›´ä¸¥æ ¼çš„è¿‡æ»¤ -->
    </init-param>
</filter>
<filter-mapping>
    <filter-name>XssFilter</filter-name>
    <url-pattern>/*</url-pattern> <!-- æ‰€æœ‰è¯·æ±‚éƒ½è¿›è¡ŒXSSæ£€æŸ¥ -->
</filter-mapping>
```

> âš ï¸ **é‡è¦æé†’**ï¼šXSSé˜²æŠ¤è¦åœ¨ç¼–ç è½¬æ¢ä¹‹å‰è¿›è¡Œï¼Œå¦åˆ™å¯èƒ½æ— æ•ˆï¼

---

## 3. ğŸ’‰ SQLæ³¨å…¥é¢„é˜²


### 3.1 ä»€ä¹ˆæ˜¯SQLæ³¨å…¥æ”»å‡»


**é€šä¿—è§£é‡Š**ï¼šSQLæ³¨å…¥å°±åƒæœ‰äººåœ¨å¡«å†™è¡¨æ ¼æ—¶ï¼Œä¸æŒ‰è§„åˆ™å¡«å†™ï¼Œè€Œæ˜¯å†™äº†ä¸€äº›ç‰¹æ®Šçš„"å’’è¯­"ï¼Œè®©è®¡ç®—æœºæ‰§è¡Œäº†ä¸è¯¥æ‰§è¡Œçš„æ•°æ®åº“æ“ä½œã€‚

```
æ­£å¸¸æŸ¥è¯¢ï¼šSELECT * FROM users WHERE username = 'å¼ ä¸‰'
æ¶æ„æ³¨å…¥ï¼šSELECT * FROM users WHERE username = 'å¼ ä¸‰' OR 1=1; DROP TABLE users; --

ç»“æœï¼šä¸ä»…æŸ¥è¯¢äº†ç”¨æˆ·ï¼Œè¿˜æŠŠæ•´ä¸ªç”¨æˆ·è¡¨åˆ é™¤äº†ï¼
```

**ç”Ÿæ´»æ¯”å–»**ï¼š
- æ­£å¸¸æƒ…å†µï¼šä½ å»å›¾ä¹¦é¦†è¯´"æˆ‘è¦å€Ÿã€Šè¥¿æ¸¸è®°ã€‹"
- SQLæ³¨å…¥ï¼šä½ å»å›¾ä¹¦é¦†è¯´"æˆ‘è¦å€Ÿã€Šè¥¿æ¸¸è®°ã€‹ï¼Œé¡ºä¾¿æŠŠæ‰€æœ‰ä¹¦éƒ½çƒ§äº†"

### 3.2 SQLæ³¨å…¥çš„å±å®³


```
SQLæ³¨å…¥æ”»å‡»å±å®³ç­‰çº§ï¼š

ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ æ•°æ®æ³„éœ²ï¼šè·å–æ‰€æœ‰ç”¨æˆ·å¯†ç ã€ä¸ªäººä¿¡æ¯
ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥   æ•°æ®ç¯¡æ”¹ï¼šä¿®æ”¹æ•°æ®åº“ä¸­çš„é‡è¦æ•°æ®
ğŸ”¥ğŸ”¥ğŸ”¥     æƒé™æå‡ï¼šè·å¾—ç®¡ç†å‘˜æƒé™
ğŸ”¥ğŸ”¥       æœåŠ¡æ‹’ç»ï¼šåˆ é™¤é‡è¦è¡¨ï¼Œå¯¼è‡´ç³»ç»Ÿå´©æºƒ
```

### 3.3 SQLæ³¨å…¥é˜²æŠ¤è¿‡æ»¤å™¨


```java
/**
 * SQLæ³¨å…¥é˜²æŠ¤è¿‡æ»¤å™¨
 * æ£€æµ‹å’Œæ‹¦æˆªåŒ…å«SQLæ³¨å…¥é£é™©çš„è¯·æ±‚
 */
public class SqlInjectionFilter implements Filter {
    
    // SQLæ³¨å…¥å¸¸ç”¨å…³é”®è¯ï¼ˆè½¬å°å†™æ£€æµ‹ï¼‰
    private static final String[] SQL_KEYWORDS = {
        "select", "insert", "update", "delete", "drop", "create",
        "alter", "exec", "execute", "union", "script", "declare"
    };
    
    // SQLæ³¨å…¥å¸¸ç”¨ç¬¦å·æ¨¡å¼
    private static final String[] SQL_PATTERNS = {
        "'", "\"", ";", "/*", "*/", "$$", "@", 
        "char", "nchar", "varchar", "nvarchar",
        "or 1=1", "and 1=1", "1' or '1'='1"
    };
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                        FilterChain chain) throws IOException, ServletException {
        
        HttpServletRequest httpRequest = (HttpServletRequest) request;
        HttpServletResponse httpResponse = (HttpServletResponse) response;
        
        // æ£€æŸ¥æ‰€æœ‰å‚æ•°æ˜¯å¦åŒ…å«SQLæ³¨å…¥
        if (containsSqlInjection(httpRequest)) {
            // è®°å½•æ”»å‡»æ—¥å¿—
            logSqlInjectionAttempt(httpRequest);
            
            // è¿”å›é”™è¯¯é¡µé¢
            httpResponse.sendError(HttpServletResponse.SC_BAD_REQUEST, 
                "æ£€æµ‹åˆ°éæ³•è¯·æ±‚ï¼Œè¯·æ±‚å·²è¢«æ‹’ç»");
            return;
        }
        
        chain.doFilter(request, response);
    }
    
    // æ£€æµ‹æ˜¯å¦åŒ…å«SQLæ³¨å…¥
    private boolean containsSqlInjection(HttpServletRequest request) {
        // æ£€æŸ¥æ‰€æœ‰å‚æ•°
        Map<String, String[]> params = request.getParameterMap();
        for (String[] values : params.values()) {
            for (String value : values) {
                if (isSqlInjection(value)) {
                    return true;
                }
            }
        }
        
        // æ£€æŸ¥URLè·¯å¾„
        String uri = request.getRequestURI();
        return isSqlInjection(uri);
    }
    
    // åˆ¤æ–­å•ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ…å«SQLæ³¨å…¥
    private boolean isSqlInjection(String input) {
        if (input == null) return false;
        
        String lowerInput = input.toLowerCase();
        
        // æ£€æŸ¥å±é™©çš„SQLå…³é”®è¯ç»„åˆ
        for (String keyword : SQL_KEYWORDS) {
            if (lowerInput.contains(keyword)) {
                // è¿›ä¸€æ­¥æ£€æŸ¥æ˜¯å¦æ˜¯çœŸæ­£çš„SQLè¯­å¥
                if (containsMultipleKeywords(lowerInput) || 
                    containsDangerousPattern(lowerInput)) {
                    return true;
                }
            }
        }
        
        return false;
    }
    
    // æ£€æŸ¥æ˜¯å¦åŒ…å«å¤šä¸ªSQLå…³é”®è¯ï¼ˆæé«˜å‡†ç¡®æ€§ï¼‰
    private boolean containsMultipleKeywords(String input) {
        int keywordCount = 0;
        for (String keyword : SQL_KEYWORDS) {
            if (input.contains(keyword)) {
                keywordCount++;
                if (keywordCount >= 2) return true;
            }
        }
        return false;
    }
}
```

### 3.4 SQLæ³¨å…¥é˜²æŠ¤æœ€ä½³å®è·µ


> ğŸ’¡ **é˜²æŠ¤ç­–ç•¥ç»„åˆæ‹³**ï¼š

**ğŸ¥Š ç¬¬ä¸€æ‹›ï¼šå‚æ•°é¢„ç¼–è¯‘**
```java
// âŒ é”™è¯¯æ–¹å¼ï¼šå­—ç¬¦ä¸²æ‹¼æ¥ï¼ˆå±é™©ï¼ï¼‰
String sql = "SELECT * FROM users WHERE username = '" + username + "'";

// âœ… æ­£ç¡®æ–¹å¼ï¼šé¢„ç¼–è¯‘è¯­å¥ï¼ˆå®‰å…¨ï¼ï¼‰  
String sql = "SELECT * FROM users WHERE username = ?";
PreparedStatement pstmt = conn.prepareStatement(sql);
pstmt.setString(1, username);
```

**ğŸ¥Š ç¬¬äºŒæ‹›ï¼šè¾“å…¥éªŒè¯**
```java
// ç”¨æ­£åˆ™è¡¨è¾¾å¼éªŒè¯è¾“å…¥æ ¼å¼
if (!username.matches("^[a-zA-Z0-9_]{3,20}$")) {
    throw new IllegalArgumentException("ç”¨æˆ·åæ ¼å¼ä¸æ­£ç¡®");
}
```

**ğŸ¥Š ç¬¬ä¸‰æ‹›ï¼šæƒé™æœ€å°åŒ–**
```java
// æ•°æ®åº“ç”¨æˆ·åªç»™å¿…è¦çš„æƒé™ï¼Œä¸è¦ç»™DROPã€CREATEç­‰å±é™©æƒé™
```

---

## 4. ğŸª CSRFè·¨ç«™è¯·æ±‚ä¼ªé€ é˜²æŠ¤


### 4.1 ä»€ä¹ˆæ˜¯CSRFæ”»å‡»


**é€šä¿—è§£é‡Š**ï¼šCSRFå°±åƒæœ‰äººå†’å……ä½ çš„èº«ä»½å»é“¶è¡Œè½¬è´¦ã€‚ä½ åœ¨é“¶è¡Œç½‘ç«™ç™»å½•åï¼Œé»‘å®¢é€šè¿‡æŠ€æœ¯æ‰‹æ®µè®©ä½ åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹æ‰§è¡Œäº†è½¬è´¦æ“ä½œã€‚

```
CSRFæ”»å‡»æµç¨‹ï¼š
1. ä½ ç™»å½•äº†é“¶è¡Œç½‘ç«™ï¼ˆè·å¾—äº†èº«ä»½å‡­è¯ï¼‰
2. ä½ åˆè®¿é—®äº†æ¶æ„ç½‘ç«™ï¼ˆæ²¡æœ‰é€€å‡ºé“¶è¡Œç½‘ç«™ï¼‰
3. æ¶æ„ç½‘ç«™å·å·å‘é“¶è¡Œç½‘ç«™å‘èµ·è½¬è´¦è¯·æ±‚
4. é“¶è¡Œç½‘ç«™è®¤ä¸ºæ˜¯ä½ æœ¬äººæ“ä½œï¼ˆå› ä¸ºæœ‰èº«ä»½å‡­è¯ï¼‰
5. ä½ çš„é’±è¢«å·å·è½¬èµ°äº†

å°±åƒå°å·å¤åˆ¶äº†ä½ çš„é’¥åŒ™ï¼Œè¶ä½ ä¸æ³¨æ„å·å·è¿›å…¥ä½ å®¶
```

### 4.2 CSRFé˜²æŠ¤åŸç†


**æ ¸å¿ƒæ€è·¯**ï¼šç»™æ¯ä¸ªé‡è¦æ“ä½œåŠ ä¸Š"æš—å·"ï¼ˆTokenï¼‰ï¼Œåªæœ‰çŸ¥é“æš—å·çš„æ‰æ˜¯çœŸæ­£çš„ç”¨æˆ·ã€‚

```
é˜²æŠ¤æœºåˆ¶ï¼š

æ²¡æœ‰é˜²æŠ¤ï¼š
ç”¨æˆ· â†’ è¯·æ±‚è½¬è´¦ â†’ é“¶è¡Œæ‰§è¡Œ âœ“ï¼ˆå±é™©ï¼ï¼‰
é»‘å®¢ â†’ è¯·æ±‚è½¬è´¦ â†’ é“¶è¡Œæ‰§è¡Œ âœ“ï¼ˆè¢«æ”»å‡»ï¼ï¼‰

æœ‰CSRFé˜²æŠ¤ï¼š
ç”¨æˆ· â†’ è¯·æ±‚è½¬è´¦+æ­£ç¡®Token â†’ é“¶è¡Œæ‰§è¡Œ âœ“ï¼ˆå®‰å…¨ï¼ï¼‰
é»‘å®¢ â†’ è¯·æ±‚è½¬è´¦+é”™è¯¯Token â†’ é“¶è¡Œæ‹’ç» âœ—ï¼ˆé˜²æŠ¤æˆåŠŸï¼ï¼‰
```

### 4.3 CSRFé˜²æŠ¤è¿‡æ»¤å™¨å®ç°


```java
/**
 * CSRFé˜²æŠ¤è¿‡æ»¤å™¨
 * ä¸ºæ¯ä¸ªç”¨æˆ·ä¼šè¯ç”Ÿæˆå”¯ä¸€ä»¤ç‰Œï¼ŒéªŒè¯è¯·æ±‚çš„åˆæ³•æ€§
 */
public class CsrfFilter implements Filter {
    
    private static final String CSRF_TOKEN_NAME = "csrf_token";
    private static final String CSRF_HEADER_NAME = "X-CSRF-Token";
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                        FilterChain chain) throws IOException, ServletException {
        
        HttpServletRequest httpRequest = (HttpServletRequest) request;
        HttpServletResponse httpResponse = (HttpServletResponse) response;
        
        String method = httpRequest.getMethod();
        
        // åªå¯¹å†™æ“ä½œè¿›è¡ŒCSRFæ£€æŸ¥ï¼ˆGETè¯·æ±‚ä¸æ£€æŸ¥ï¼‰
        if ("POST".equalsIgnoreCase(method) || 
            "PUT".equalsIgnoreCase(method) || 
            "DELETE".equalsIgnoreCase(method)) {
            
            if (!isValidCsrfToken(httpRequest)) {
                httpResponse.sendError(HttpServletResponse.SC_FORBIDDEN, 
                    "CSRF TokenéªŒè¯å¤±è´¥ï¼Œè¯·æ±‚è¢«æ‹’ç»");
                return;
            }
        }
        
        // ä¸ºæ¯ä¸ªå“åº”æ·»åŠ æ–°çš„CSRF Token
        addCsrfTokenToResponse(httpRequest, httpResponse);
        
        chain.doFilter(request, response);
    }
    
    // éªŒè¯CSRF Tokenæ˜¯å¦æœ‰æ•ˆ
    private boolean isValidCsrfToken(HttpServletRequest request) {
        // ä»è¯·æ±‚ä¸­è·å–Tokenï¼ˆå¯èƒ½åœ¨è¡¨å•å‚æ•°æˆ–è¯·æ±‚å¤´ä¸­ï¼‰
        String requestToken = request.getParameter(CSRF_TOKEN_NAME);
        if (requestToken == null) {
            requestToken = request.getHeader(CSRF_HEADER_NAME);
        }
        
        // ä»Sessionä¸­è·å–é¢„æœŸçš„Token
        HttpSession session = request.getSession();
        String sessionToken = (String) session.getAttribute(CSRF_TOKEN_NAME);
        
        // éªŒè¯Tokenæ˜¯å¦åŒ¹é…
        return requestToken != null && requestToken.equals(sessionToken);
    }
    
    // ç”Ÿæˆæ–°çš„CSRF Token
    private String generateCsrfToken() {
        return UUID.randomUUID().toString();
    }
    
    // åœ¨å“åº”ä¸­æ·»åŠ CSRF Token
    private void addCsrfTokenToResponse(HttpServletRequest request, 
                                       HttpServletResponse response) {
        HttpSession session = request.getSession();
        String newToken = generateCsrfToken();
        session.setAttribute(CSRF_TOKEN_NAME, newToken);
        
        // åœ¨å“åº”å¤´ä¸­æ·»åŠ Tokenï¼Œä¾›å‰ç«¯JavaScriptä½¿ç”¨
        response.setHeader(CSRF_HEADER_NAME, newToken);
    }
}
```

### 4.4 å‰ç«¯å¦‚ä½•ä½¿ç”¨CSRF Token


**åœ¨HTMLè¡¨å•ä¸­ä½¿ç”¨**ï¼š
```html
<form action="/transfer" method="post">
    <!-- éšè—å­—æ®µåŒ…å«CSRF Token -->
    <input type="hidden" name="csrf_token" value="${sessionScope.csrf_token}">
    <input type="text" name="amount" placeholder="è½¬è´¦é‡‘é¢">
    <button type="submit">è½¬è´¦</button>
</form>
```

**åœ¨Ajaxè¯·æ±‚ä¸­ä½¿ç”¨**ï¼š
```javascript
// ä»å“åº”å¤´æˆ–é¡µé¢ä¸­è·å–CSRF Token
var csrfToken = $('meta[name="csrf-token"]').attr('content');

$.ajaxSetup({
    beforeSend: function(xhr) {
        xhr.setRequestHeader('X-CSRF-Token', csrfToken);
    }
});

// å‘èµ·Ajaxè¯·æ±‚æ—¶ä¼šè‡ªåŠ¨å¸¦ä¸ŠCSRF Token
$.post('/api/transfer', {amount: 1000}, function(response) {
    console.log('è½¬è´¦æˆåŠŸ');
});
```

---

## 5. ğŸ”¤ æ•æ„Ÿè¯è¿‡æ»¤æœºåˆ¶


### 5.1 ä¸ºä»€ä¹ˆéœ€è¦æ•æ„Ÿè¯è¿‡æ»¤


**é€šä¿—ç†è§£**ï¼šå°±åƒç”µè§†å°æœ‰å®¡æŸ¥åˆ¶åº¦ï¼Œä¸èƒ½æ’­æ”¾ä¸åˆé€‚çš„å†…å®¹ï¼Œç½‘ç«™ä¹Ÿéœ€è¦è¿‡æ»¤ä¸åˆé€‚çš„è¯æ±‡ï¼Œä¿è¯å†…å®¹å¥åº·ã€‚

```
åº”ç”¨åœºæ™¯ï¼š
ğŸ—¨ï¸ è®ºå›è¯„è®ºï¼šé˜²æ­¢å‘å¸ƒè¿æ³•è¿è§„è¨€è®º
ğŸ“ æ–‡ç« å‘å¸ƒï¼šç¡®ä¿å†…å®¹ç¬¦åˆå¹³å°è§„èŒƒ  
ğŸ’¬ èŠå¤©ç³»ç»Ÿï¼šè¥é€ è‰¯å¥½çš„äº¤æµç¯å¢ƒ
ğŸ›’ å•†å“åç§°ï¼šé¿å…è™šå‡å®£ä¼ ç”¨è¯
```

### 5.2 æ•æ„Ÿè¯æ£€æµ‹ç®—æ³•


**ğŸ”¸ ç®€å•åŒ¹é…æ³•**ï¼ˆé€‚åˆè¯åº“è¾ƒå°ï¼‰ï¼š
```
ä¼˜ç‚¹ï¼šå®ç°ç®€å•ï¼Œæ˜“äºç†è§£
ç¼ºç‚¹ï¼šæ•ˆç‡ä½ï¼Œæ— æ³•å¤„ç†å˜å½¢è¯

æ£€æµ‹è¿‡ç¨‹ï¼š
è¾“å…¥æ–‡æœ¬ï¼š"è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ–‡æœ¬"
æ•æ„Ÿè¯åº“ï¼š["æµ‹è¯•", "æ–‡æœ¬"]  
ç»“æœï¼šå‘ç°2ä¸ªæ•æ„Ÿè¯
```

**ğŸ”¸ ACè‡ªåŠ¨æœºç®—æ³•**ï¼ˆæ¨èï¼Œé€‚åˆå¤§è¯åº“ï¼‰ï¼š
```
ä¼˜ç‚¹ï¼šæ•ˆç‡é«˜ï¼Œå¯ä»¥ä¸€æ¬¡æ‰«ææ£€æµ‹å¤šä¸ªå…³é”®è¯
ç¼ºç‚¹ï¼šå®ç°å¤æ‚ï¼Œå†…å­˜å ç”¨è¾ƒå¤§

é€‚ç”¨åœºæ™¯ï¼šæ•æ„Ÿè¯è¶…è¿‡1000ä¸ªæ—¶ä½¿ç”¨
```

### 5.3 æ•æ„Ÿè¯è¿‡æ»¤å™¨å®ç°


```java
/**
 * æ•æ„Ÿè¯è¿‡æ»¤å™¨
 * æ£€æµ‹å’Œæ›¿æ¢ç”¨æˆ·è¾“å…¥ä¸­çš„æ•æ„Ÿè¯æ±‡
 */
public class SensitiveWordFilter implements Filter {
    
    // æ•æ„Ÿè¯åº“ï¼ˆå®é™…é¡¹ç›®ä¸­ä»æ•°æ®åº“æˆ–é…ç½®æ–‡ä»¶åŠ è½½ï¼‰
    private Set<String> sensitiveWords;
    private SensitiveWordProcessor processor;
    
    @Override
    public void init(FilterConfig config) throws ServletException {
        // åˆå§‹åŒ–æ•æ„Ÿè¯åº“
        loadSensitiveWords();
        processor = new SensitiveWordProcessor(sensitiveWords);
    }
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                        FilterChain chain) throws IOException, ServletException {
        
        // åŒ…è£…è¯·æ±‚ï¼Œæ‹¦æˆªå‚æ•°è·å–
        SensitiveWordRequestWrapper wrapper = 
            new SensitiveWordRequestWrapper((HttpServletRequest) request, processor);
        
        chain.doFilter(wrapper, response);
    }
    
    // åŠ è½½æ•æ„Ÿè¯åº“
    private void loadSensitiveWords() {
        sensitiveWords = new HashSet<>();
        // è¿™é‡Œç®€åŒ–å¤„ç†ï¼Œå®é™…é¡¹ç›®ä¸­ä»é…ç½®æ–‡ä»¶æˆ–æ•°æ®åº“è¯»å–
        sensitiveWords.add("æ•æ„Ÿè¯1");
        sensitiveWords.add("æ•æ„Ÿè¯2");
        sensitiveWords.add("è¿ç¦è¯");
    }
}
```

**æ•æ„Ÿè¯å¤„ç†å™¨**ï¼š
```java
public class SensitiveWordProcessor {
    
    private Set<String> sensitiveWords;
    private String replacement = "***"; // æ›¿æ¢å­—ç¬¦
    
    public SensitiveWordProcessor(Set<String> sensitiveWords) {
        this.sensitiveWords = sensitiveWords;
    }
    
    // æ£€æµ‹æ–‡æœ¬æ˜¯å¦åŒ…å«æ•æ„Ÿè¯
    public boolean containsSensitiveWord(String text) {
        if (text == null || text.isEmpty()) return false;
        
        String lowerText = text.toLowerCase();
        for (String word : sensitiveWords) {
            if (lowerText.contains(word.toLowerCase())) {
                return true;
            }
        }
        return false;
    }
    
    // æ›¿æ¢æ•æ„Ÿè¯
    public String replaceSensitiveWords(String text) {
        if (text == null || text.isEmpty()) return text;
        
        String result = text;
        for (String word : sensitiveWords) {
            // ä½¿ç”¨æ­£åˆ™æ›¿æ¢ï¼Œå¿½ç•¥å¤§å°å†™
            result = result.replaceAll("(?i)" + Pattern.quote(word), replacement);
        }
        return result;
    }
    
    // è·å–æ–‡æœ¬ä¸­çš„æ•æ„Ÿè¯åˆ—è¡¨
    public List<String> findSensitiveWords(String text) {
        List<String> found = new ArrayList<>();
        if (text == null || text.isEmpty()) return found;
        
        String lowerText = text.toLowerCase();
        for (String word : sensitiveWords) {
            if (lowerText.contains(word.toLowerCase())) {
                found.add(word);
            }
        }
        return found;
    }
}
```

### 5.4 æ•æ„Ÿè¯è¿‡æ»¤ç­–ç•¥


> ğŸ“‹ **å¤„ç†ç­–ç•¥å¯¹æ¯”**ï¼š

| ç­–ç•¥ | **æè¿°** | **é€‚ç”¨åœºæ™¯** | **ç”¨æˆ·ä½“éªŒ** |
|------|---------|-------------|-------------|
| ğŸš« **ç›´æ¥æ‹’ç»** | `å‘ç°æ•æ„Ÿè¯å°±æ‹’ç»è¯·æ±‚` | `ä¸¥æ ¼ç®¡æ§çš„å¹³å°` | `è¾ƒå·®ï¼Œç”¨æˆ·ä¸çŸ¥é“å“ªé‡Œæœ‰é—®é¢˜` |
| â­ **æ›¿æ¢å­—ç¬¦** | `ç”¨***æ›¿æ¢æ•æ„Ÿè¯` | `ä¸€èˆ¬æ€§å†…å®¹å¹³å°` | `è¾ƒå¥½ï¼Œç”¨æˆ·èƒ½çœ‹åˆ°å¤„ç†ç»“æœ` |
| âœï¸ **æç¤ºä¿®æ”¹** | `æç¤ºç”¨æˆ·ä¿®æ”¹å†…å®¹` | `åˆ›ä½œç±»å¹³å°` | `æœ€å¥½ï¼Œç”¨æˆ·å¯ä»¥è‡ªä¸»è°ƒæ•´` |
| ğŸ“‹ **äººå·¥å®¡æ ¸** | `æ ‡è®°ä¸ºå¾…å®¡æ ¸çŠ¶æ€` | `é‡è¦å†…å®¹å‘å¸ƒ` | `ä¸€èˆ¬ï¼Œéœ€è¦ç­‰å¾…å®¡æ ¸` |

---

## 6. ğŸš« æ¶æ„è¯·æ±‚æ‹¦æˆª


### 6.1 ä»€ä¹ˆæ˜¯æ¶æ„è¯·æ±‚


**é€šä¿—ç†è§£**ï¼šæ¶æ„è¯·æ±‚å°±åƒæœ‰äººæ•…æ„åœ¨å•†åº—é‡Œæ£ä¹±ï¼Œæ¯”å¦‚æ•…æ„è¯¢é—®ä¸å­˜åœ¨çš„å•†å“ã€åœ¨è¿‡é“é‡Œä¹±è·‘ã€æˆ–è€…ä¸€ç›´æŒ‰é—¨é“ƒä¸ä¹°ä¸œè¥¿ã€‚

```
æ­£å¸¸è¯·æ±‚ vs æ¶æ„è¯·æ±‚ï¼š

æ­£å¸¸ç”¨æˆ·ï¼š
- æµè§ˆç½‘é¡µ â†’ ç‚¹å‡»é“¾æ¥ â†’ å¡«å†™è¡¨å• â†’ æäº¤
- è¯·æ±‚æœ‰é€»è¾‘ï¼Œç¬¦åˆæ­£å¸¸ä½¿ç”¨æµç¨‹

æ¶æ„ç”¨æˆ·ï¼š  
- ç›´æ¥è®¿é—®ç®¡ç†é¡µé¢
- å°è¯•å„ç§ä¸å­˜åœ¨çš„URL
- æäº¤è¶…å¤§æ–‡ä»¶
- å‘é€ç•¸å½¢æ•°æ®
```

### 6.2 æ¶æ„è¯·æ±‚çš„è¯†åˆ«ç‰¹å¾


```
ğŸ” æ¶æ„è¯·æ±‚è¯†åˆ«æŒ‡æ ‡ï¼š

ğŸ“Š è®¿é—®æ¨¡å¼å¼‚å¸¸ï¼š
- çŸ­æ—¶é—´å†…å¤§é‡è¯·æ±‚
- è®¿é—®å¤§é‡ä¸å­˜åœ¨çš„é¡µé¢  
- æŒ‰å­—å…¸é¡ºåºå°è¯•URL

ğŸ“‹ è¯·æ±‚å†…å®¹å¼‚å¸¸ï¼š
- è¯·æ±‚å¤´ä¿¡æ¯ä¸æ­£å¸¸
- æäº¤è¶…é•¿å‚æ•°
- åŒ…å«æ¶æ„è„šæœ¬ä»£ç 

ğŸŒ æ¥æºå¼‚å¸¸ï¼š
- æ¥è‡ªå·²çŸ¥æ¶æ„IP
- æ²¡æœ‰æ­£å¸¸çš„Referer
- User-Agentä¿¡æ¯å¯ç–‘
```

### 6.3 æ¶æ„è¯·æ±‚æ‹¦æˆªè¿‡æ»¤å™¨


```java
/**
 * æ¶æ„è¯·æ±‚æ‹¦æˆªè¿‡æ»¤å™¨
 * æ£€æµ‹å¹¶é˜»æ­¢å„ç§å¼‚å¸¸çš„è®¿é—®è¡Œä¸º
 */
public class MaliciousRequestFilter implements Filter {
    
    // æ¶æ„ç‰¹å¾é…ç½®
    private static final int MAX_PARAM_LENGTH = 1000;      // å‚æ•°æœ€å¤§é•¿åº¦
    private static final int MAX_URL_LENGTH = 500;         // URLæœ€å¤§é•¿åº¦  
    private static final String[] BLOCKED_EXTENSIONS = {   // ç¦æ­¢è®¿é—®çš„æ–‡ä»¶ç±»å‹
        ".jsp", ".jspx", ".do", ".action"
    };
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                        FilterChain chain) throws IOException, ServletException {
        
        HttpServletRequest httpRequest = (HttpServletRequest) request;
        HttpServletResponse httpResponse = (HttpServletResponse) response;
        
        // æ£€æŸ¥æ˜¯å¦ä¸ºæ¶æ„è¯·æ±‚
        MaliciousCheckResult checkResult = checkMaliciousRequest(httpRequest);
        
        if (checkResult.isMalicious()) {
            // è®°å½•æ¶æ„è¯·æ±‚æ—¥å¿—
            logMaliciousRequest(httpRequest, checkResult.getReason());
            
            // è¿”å›é”™è¯¯å“åº”
            httpResponse.sendError(HttpServletResponse.SC_BAD_REQUEST, 
                "æ£€æµ‹åˆ°å¼‚å¸¸è¯·æ±‚ï¼š" + checkResult.getReason());
            return;
        }
        
        chain.doFilter(request, response);
    }
    
    // æ£€æŸ¥æ¶æ„è¯·æ±‚çš„ç»¼åˆæ–¹æ³•
    private MaliciousCheckResult checkMaliciousRequest(HttpServletRequest request) {
        
        // 1. æ£€æŸ¥URLé•¿åº¦
        String uri = request.getRequestURI();
        if (uri.length() > MAX_URL_LENGTH) {
            return MaliciousCheckResult.malicious("URLé•¿åº¦è¶…è¿‡é™åˆ¶");
        }
        
        // 2. æ£€æŸ¥ç¦æ­¢è®¿é—®çš„æ–‡ä»¶ç±»å‹
        for (String ext : BLOCKED_EXTENSIONS) {
            if (uri.toLowerCase().endsWith(ext)) {
                return MaliciousCheckResult.malicious("å°è¯•è®¿é—®ç¦æ­¢çš„æ–‡ä»¶ç±»å‹");
            }
        }
        
        // 3. æ£€æŸ¥å‚æ•°é•¿åº¦
        Map<String, String[]> params = request.getParameterMap();
        for (Map.Entry<String, String[]> entry : params.entrySet()) {
            for (String value : entry.getValue()) {
                if (value != null && value.length() > MAX_PARAM_LENGTH) {
                    return MaliciousCheckResult.malicious("å‚æ•°é•¿åº¦è¶…è¿‡é™åˆ¶");
                }
            }
        }
        
        // 4. æ£€æŸ¥User-Agent
        String userAgent = request.getHeader("User-Agent");
        if (userAgent == null || userAgent.trim().isEmpty()) {
            return MaliciousCheckResult.malicious("ç¼ºå°‘User-Agentä¿¡æ¯");
        }
        
        // 5. æ£€æŸ¥å¯ç–‘çš„User-Agent
        if (isSuspiciousUserAgent(userAgent)) {
            return MaliciousCheckResult.malicious("å¯ç–‘çš„User-Agent");
        }
        
        return MaliciousCheckResult.normal();
    }
    
    // æ£€æŸ¥å¯ç–‘çš„User-Agent
    private boolean isSuspiciousUserAgent(String userAgent) {
        String[] suspiciousAgents = {
            "sqlmap", "nmap", "nikto", "curl", "wget", 
            "python", "scanner", "bot"
        };
        
        String lowerUserAgent = userAgent.toLowerCase();
        for (String suspicious : suspiciousAgents) {
            if (lowerUserAgent.contains(suspicious)) {
                return true;
            }
        }
        return false;
    }
}

// æ£€æŸ¥ç»“æœå°è£…ç±»
class MaliciousCheckResult {
    private boolean malicious;
    private String reason;
    
    public static MaliciousCheckResult malicious(String reason) {
        return new MaliciousCheckResult(true, reason);
    }
    
    public static MaliciousCheckResult normal() {
        return new MaliciousCheckResult(false, "æ­£å¸¸è¯·æ±‚");
    }
    
    // æ„é€ æ–¹æ³•å’Œgetteræ–¹æ³•...
}
```

---

## 7. âš¡ é¢‘ç‡é™åˆ¶æ§åˆ¶


### 7.1 ä¸ºä»€ä¹ˆéœ€è¦é¢‘ç‡é™åˆ¶


**é€šä¿—ç†è§£**ï¼šå°±åƒè¶…å¸‚é™è´­ä¸€æ ·ï¼Œé˜²æ­¢æœ‰äººæ¶æ„æŠ¢è´­æˆ–è€…å ç”¨è¿‡å¤šèµ„æºï¼Œå½±å“å…¶ä»–é¡¾å®¢çš„æ­£å¸¸è´­ä¹°ã€‚

```
æ²¡æœ‰é¢‘ç‡é™åˆ¶çš„é—®é¢˜ï¼š
ğŸ”¥ æ¶æ„åˆ·æ–°ï¼šç”¨æˆ·ç–¯ç‹‚åˆ·æ–°é¡µé¢ï¼Œæ¶ˆè€—æœåŠ¡å™¨èµ„æº
ğŸ”¥ æš´åŠ›ç ´è§£ï¼šå°è¯•å¤§é‡å¯†ç ç»„åˆç ´è§£è´¦æˆ·  
ğŸ”¥ åƒåœ¾ä¿¡æ¯ï¼šçŸ­æ—¶é—´å‘é€å¤§é‡åƒåœ¾è¯„è®º
ğŸ”¥ æ¥å£æ»¥ç”¨ï¼šè°ƒç”¨ä»˜è´¹APIæ¥å£æ¶æ„æ¶ˆè´¹

æœ‰é¢‘ç‡é™åˆ¶çš„å¥½å¤„ï¼š
âœ… ä¿æŠ¤æœåŠ¡å™¨æ€§èƒ½
âœ… æé«˜ç³»ç»Ÿç¨³å®šæ€§  
âœ… é˜²æ­¢æ¶æ„æ”»å‡»
âœ… ä¿è¯æ­£å¸¸ç”¨æˆ·ä½“éªŒ
```

### 7.2 é¢‘ç‡é™åˆ¶ç®—æ³•


**ğŸª£ ä»¤ç‰Œæ¡¶ç®—æ³•**ï¼ˆæ¨èï¼‰ï¼š
```
å·¥ä½œåŸç†ï¼ˆç”Ÿæ´»æ¯”å–»ï¼‰ï¼š
æƒ³è±¡æœ‰ä¸€ä¸ªæ°´æ¡¶ï¼Œæ¯ç§’é’Ÿå¾€é‡Œé¢ä¸¢ä¸€ä¸ªä»¤ç‰Œ
ç”¨æˆ·æ¯æ¬¡è¯·æ±‚éœ€è¦æ¶ˆè€—ä¸€ä¸ªä»¤ç‰Œ
å¦‚æœæ¡¶é‡Œæ²¡æœ‰ä»¤ç‰Œï¼Œå°±æ‹’ç»è¯·æ±‚

ä¼˜ç‚¹ï¼šå…è®¸çŸ­æ—¶é—´çš„çªå‘æµé‡
ç¼ºç‚¹ï¼šå®ç°ç›¸å¯¹å¤æ‚
```

**â° æ—¶é—´çª—å£ç®—æ³•**ï¼ˆç®€å•ï¼‰ï¼š
```
å·¥ä½œåŸç†ï¼š
åœ¨å›ºå®šæ—¶é—´çª—å£å†…ï¼ˆæ¯”å¦‚1åˆ†é’Ÿï¼‰ï¼Œé™åˆ¶è¯·æ±‚æ¬¡æ•°
è¶…è¿‡é™åˆ¶å°±æ‹’ç»åç»­è¯·æ±‚

ä¼˜ç‚¹ï¼šå®ç°ç®€å•ï¼Œå®¹æ˜“ç†è§£
ç¼ºç‚¹ï¼šå¯èƒ½å‡ºç°çªå‘æµé‡é—®é¢˜
```

### 7.3 é¢‘ç‡é™åˆ¶è¿‡æ»¤å™¨å®ç°


```java
/**
 * é¢‘ç‡é™åˆ¶è¿‡æ»¤å™¨
 * åŸºäºIPåœ°å€é™åˆ¶ç”¨æˆ·çš„è®¿é—®é¢‘ç‡
 */
public class RateLimitFilter implements Filter {
    
    // ä½¿ç”¨ConcurrentHashMapå­˜å‚¨æ¯ä¸ªIPçš„è®¿é—®è®°å½•
    private final Map<String, RateLimitInfo> rateLimitMap = new ConcurrentHashMap<>();
    
    // é…ç½®å‚æ•°
    private int maxRequests = 100;     // æ¯åˆ†é’Ÿæœ€å¤§è¯·æ±‚æ•°
    private long timeWindow = 60000;   // æ—¶é—´çª—å£ï¼š60ç§’
    
    @Override
    public void init(FilterConfig config) throws ServletException {
        // ä»é…ç½®æ–‡ä»¶è¯»å–é™åˆ¶å‚æ•°
        String maxReq = config.getInitParameter("max-requests");
        if (maxReq != null) {
            maxRequests = Integer.parseInt(maxReq);
        }
        
        // å¯åŠ¨æ¸…ç†çº¿ç¨‹ï¼Œå®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®
        startCleanupThread();
    }
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                        FilterChain chain) throws IOException, ServletException {
        
        HttpServletRequest httpRequest = (HttpServletRequest) request;
        HttpServletResponse httpResponse = (HttpServletResponse) response;
        
        String clientIP = getClientIP(httpRequest);
        
        if (!isRequestAllowed(clientIP)) {
            // è¶…è¿‡é¢‘ç‡é™åˆ¶ï¼Œè¿”å›429çŠ¶æ€ç 
            httpResponse.setStatus(429); // Too Many Requests
            httpResponse.getWriter().write("è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•");
            return;
        }
        
        chain.doFilter(request, response);
    }
    
    // æ£€æŸ¥è¯·æ±‚æ˜¯å¦è¢«å…è®¸
    private boolean isRequestAllowed(String clientIP) {
        long currentTime = System.currentTimeMillis();
        
        RateLimitInfo info = rateLimitMap.compute(clientIP, (ip, existing) -> {
            if (existing == null) {
                // ç¬¬ä¸€æ¬¡è®¿é—®
                return new RateLimitInfo(currentTime, 1);
            }
            
            // æ£€æŸ¥æ˜¯å¦åœ¨æ—¶é—´çª—å£å†…
            if (currentTime - existing.getWindowStart() < timeWindow) {
                // åœ¨å½“å‰æ—¶é—´çª—å£å†…ï¼Œå¢åŠ è¯·æ±‚è®¡æ•°
                existing.incrementCount();
                return existing;
            } else {
                // æ–°çš„æ—¶é—´çª—å£ï¼Œé‡ç½®è®¡æ•°
                return new RateLimitInfo(currentTime, 1);
            }
        });
        
        return info.getRequestCount() <= maxRequests;
    }
    
    // è·å–å®¢æˆ·ç«¯çœŸå®IP
    private String getClientIP(HttpServletRequest request) {
        // è€ƒè™‘ä»£ç†æœåŠ¡å™¨çš„æƒ…å†µ
        String ip = request.getHeader("X-Forwarded-For");
        if (ip == null || ip.isEmpty() || "unknown".equalsIgnoreCase(ip)) {
            ip = request.getHeader("X-Real-IP");
        }
        if (ip == null || ip.isEmpty() || "unknown".equalsIgnoreCase(ip)) {
            ip = request.getRemoteAddr();
        }
        return ip;
    }
    
    // å¯åŠ¨æ¸…ç†çº¿ç¨‹
    private void startCleanupThread() {
        Thread cleanupThread = new Thread(() -> {
            while (true) {
                try {
                    Thread.sleep(timeWindow); // æ¯ä¸ªæ—¶é—´çª—å£æ¸…ç†ä¸€æ¬¡
                    cleanupExpiredEntries();
                } catch (InterruptedException e) {
                    Thread.currentThread().interrupt();
                    break;
                }
            }
        });
        cleanupThread.setDaemon(true);
        cleanupThread.start();
    }
    
    // æ¸…ç†è¿‡æœŸæ•°æ®
    private void cleanupExpiredEntries() {
        long currentTime = System.currentTimeMillis();
        rateLimitMap.entrySet().removeIf(entry -> 
            currentTime - entry.getValue().getWindowStart() > timeWindow);
    }
}

// é¢‘ç‡é™åˆ¶ä¿¡æ¯ç±»
class RateLimitInfo {
    private long windowStart;  // æ—¶é—´çª—å£å¼€å§‹æ—¶é—´
    private int requestCount;  // å½“å‰è¯·æ±‚æ•°é‡
    
    public RateLimitInfo(long windowStart, int requestCount) {
        this.windowStart = windowStart;
        this.requestCount = requestCount;
    }
    
    public void incrementCount() {
        this.requestCount++;
    }
    
    // getteræ–¹æ³•...
}
```

### 7.4 é¢‘ç‡é™åˆ¶é…ç½®ç¤ºä¾‹


```xml
<!-- web.xmlä¸­é…ç½®é¢‘ç‡é™åˆ¶ -->
<filter>
    <filter-name>RateLimitFilter</filter-name>
    <filter-class>com.example.filter.RateLimitFilter</filter-class>
    <init-param>
        <param-name>max-requests</param-name>
        <param-value>60</param-value> <!-- æ¯åˆ†é’Ÿæœ€å¤š60æ¬¡è¯·æ±‚ -->
    </init-param>
    <init-param>
        <param-name>time-window</param-name>
        <param-value>60000</param-value> <!-- 60ç§’æ—¶é—´çª—å£ -->
    </init-param>
</filter>
<filter-mapping>
    <filter-name>RateLimitFilter</filter-name>
    <url-pattern>/api/*</url-pattern> <!-- åªå¯¹APIæ¥å£é™åˆ¶é¢‘ç‡ -->
</filter-mapping>
```

---

## 8. ğŸ“‹ é»‘åå•ç®¡ç†ç³»ç»Ÿ


### 8.1 ä»€ä¹ˆæ˜¯é»‘åå•ç³»ç»Ÿ


**é€šä¿—ç†è§£**ï¼šé»‘åå•å°±åƒå•†åº—çš„"ç¦å…¥åå•"ï¼ŒæŠŠé‚£äº›æ£ä¹±çš„é¡¾å®¢è®°å½•ä¸‹æ¥ï¼Œä¸‹æ¬¡ä»–ä»¬æ¥çš„æ—¶å€™ç›´æ¥æ‹’ç»å…¥å†…ã€‚

```
é»‘åå•ç³»ç»Ÿç»„æˆï¼š
ğŸš« IPé»‘åå•ï¼šé˜»æ­¢ç‰¹å®šIPåœ°å€çš„è®¿é—®
ğŸš« ç”¨æˆ·é»‘åå•ï¼šé˜»æ­¢ç‰¹å®šç”¨æˆ·è´¦å·çš„æ“ä½œ  
ğŸš« åŸŸåé»‘åå•ï¼šé˜»æ­¢ç‰¹å®šç½‘ç«™çš„å¼•ç”¨
ğŸš« å…³é”®è¯é»‘åå•ï¼šé˜»æ­¢åŒ…å«ç‰¹å®šè¯æ±‡çš„è¯·æ±‚
```

### 8.2 é»‘åå•çš„æ•°æ®æ¥æº


```
é»‘åå•æ¥æºæ¸ é“ï¼š
ğŸ“Š è‡ªåŠ¨æ£€æµ‹ï¼šç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«å¼‚å¸¸è¡Œä¸º
ğŸ‘® äººå·¥æ·»åŠ ï¼šç®¡ç†å‘˜æ‰‹åŠ¨åŠ å…¥é»‘åå•
ğŸŒ ç¬¬ä¸‰æ–¹ï¼šä»å®‰å…¨æœºæ„è·å–æ¶æ„IPåˆ—è¡¨
ğŸ“ˆ è¡Œä¸ºåˆ†æï¼šåŸºäºç”¨æˆ·è¡Œä¸ºæ¨¡å¼åˆ¤æ–­
```

### 8.3 é»‘åå•è¿‡æ»¤å™¨å®ç°


```java
/**
 * é»‘åå•ç®¡ç†è¿‡æ»¤å™¨
 * ç»´æŠ¤å’Œæ£€æŸ¥å„ç§ç±»å‹çš„é»‘åå•
 */
public class BlacklistFilter implements Filter {
    
    private BlacklistManager blacklistManager;
    
    @Override
    public void init(FilterConfig config) throws ServletException {
        blacklistManager = new BlacklistManager();
        // åŠ è½½é»‘åå•æ•°æ®
        blacklistManager.loadBlacklists();
    }
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                        FilterChain chain) throws IOException, ServletException {
        
        HttpServletRequest httpRequest = (HttpServletRequest) request;
        HttpServletResponse httpResponse = (HttpServletResponse) response;
        
        // æ£€æŸ¥æ˜¯å¦åœ¨é»‘åå•ä¸­
        BlacklistCheckResult result = blacklistManager.checkRequest(httpRequest);
        
        if (result.isBlocked()) {
            // è®°å½•æ‹¦æˆªæ—¥å¿—
            logBlockedRequest(httpRequest, result);
            
            httpResponse.sendError(HttpServletResponse.SC_FORBIDDEN, 
                "è®¿é—®è¢«æ‹’ç»ï¼š" + result.getReason());
            return;
        }
        
        chain.doFilter(request, response);
    }
}

/**
 * é»‘åå•ç®¡ç†å™¨
 */
class BlacklistManager {
    
    // å„ç§ç±»å‹çš„é»‘åå•
    private Set<String> ipBlacklist = new HashSet<>();
    private Set<String> userBlacklist = new HashSet<>();
    private Set<String> refererBlacklist = new HashSet<>();
    private Map<String, Long> temporaryBlacklist = new ConcurrentHashMap<>();
    
    // åŠ è½½é»‘åå•æ•°æ®
    public void loadBlacklists() {
        loadIPBlacklist();
        loadUserBlacklist();
        loadRefererBlacklist();
    }
    
    // æ£€æŸ¥è¯·æ±‚æ˜¯å¦åº”è¯¥è¢«é˜»æ­¢
    public BlacklistCheckResult checkRequest(HttpServletRequest request) {
        
        // 1. æ£€æŸ¥IPé»‘åå•
        String clientIP = getClientIP(request);
        if (ipBlacklist.contains(clientIP)) {
            return BlacklistCheckResult.blocked("IPåœ°å€åœ¨é»‘åå•ä¸­");
        }
        
        // 2. æ£€æŸ¥ä¸´æ—¶é»‘åå•ï¼ˆåŸºäºæ—¶é—´çš„ï¼‰
        if (isInTemporaryBlacklist(clientIP)) {
            return BlacklistCheckResult.blocked("IPåœ°å€è¢«ä¸´æ—¶å°ç¦");
        }
        
        // 3. æ£€æŸ¥ç”¨æˆ·é»‘åå•
        String username = getUsernameFromSession(request);
        if (username != null && userBlacklist.contains(username)) {
            return BlacklistCheckResult.blocked("ç”¨æˆ·è´¦å·åœ¨é»‘åå•ä¸­");
        }
        
        // 4. æ£€æŸ¥Refereré»‘åå•
        String referer = request.getHeader("Referer");
        if (referer != null && isRefererBlocked(referer)) {
            return BlacklistCheckResult.blocked("æ¥æºç½‘ç«™åœ¨é»‘åå•ä¸­");
        }
        
        return BlacklistCheckResult.allowed();
    }
    
    // æ·»åŠ IPåˆ°ä¸´æ—¶é»‘åå•ï¼ˆè‡ªåŠ¨è¿‡æœŸï¼‰
    public void addToTemporaryBlacklist(String ip, long durationMinutes) {
        long expireTime = System.currentTimeMillis() + (durationMinutes * 60 * 1000);
        temporaryBlacklist.put(ip, expireTime);
    }
    
    // æ£€æŸ¥æ˜¯å¦åœ¨ä¸´æ—¶é»‘åå•ä¸­
    private boolean isInTemporaryBlacklist(String ip) {
        Long expireTime = temporaryBlacklist.get(ip);
        if (expireTime == null) return false;
        
        if (System.currentTimeMillis() > expireTime) {
            // å·²è¿‡æœŸï¼Œä»ä¸´æ—¶é»‘åå•ä¸­ç§»é™¤
            temporaryBlacklist.remove(ip);
            return false;
        }
        return true;
    }
    
    // æ£€æŸ¥Refereræ˜¯å¦è¢«é˜»æ­¢
    private boolean isRefererBlocked(String referer) {
        for (String blockedDomain : refererBlacklist) {
            if (referer.toLowerCase().contains(blockedDomain.toLowerCase())) {
                return true;
            }
        }
        return false;
    }
    
    // ä»æ•°æ®åº“æˆ–é…ç½®æ–‡ä»¶åŠ è½½IPé»‘åå•
    private void loadIPBlacklist() {
        // è¿™é‡Œç®€åŒ–å¤„ç†ï¼Œå®é™…é¡¹ç›®ä¸­ä»æ•°æ®åº“è¯»å–
        ipBlacklist.add("192.168.1.100"); // ç¤ºä¾‹æ¶æ„IP
        ipBlacklist.add("10.0.0.50");
    }
    
    // åŠ è½½ç”¨æˆ·é»‘åå•
    private void loadUserBlacklist() {
        userBlacklist.add("malicious_user");
        userBlacklist.add("spam_bot");
    }
    
    // åŠ è½½Refereré»‘åå•
    private void loadRefererBlacklist() {
        refererBlacklist.add("malicious-site.com");
        refererBlacklist.add("spam-referrer.net");
    }
}

// é»‘åå•æ£€æŸ¥ç»“æœç±»
class BlacklistCheckResult {
    private boolean blocked;
    private String reason;
    
    public static BlacklistCheckResult blocked(String reason) {
        return new BlacklistCheckResult(true, reason);
    }
    
    public static BlacklistCheckResult allowed() {
        return new BlacklistCheckResult(false, "å…è®¸è®¿é—®");
    }
    
    // æ„é€ æ–¹æ³•å’Œgetteræ–¹æ³•...
}
```

### 8.4 æ™ºèƒ½é»‘åå•ç­–ç•¥


> ğŸ’¡ **è‡ªåŠ¨åŒ–é»‘åå•ç®¡ç†**ï¼š

**ğŸ¤– è‡ªåŠ¨åŠ å…¥ç­–ç•¥**ï¼š
```java
public class AutoBlacklistStrategy {
    
    // å¼‚å¸¸è¡Œä¸ºæ£€æµ‹
    public void detectAbnormalBehavior(String ip, HttpServletRequest request) {
        // çŸ­æ—¶é—´å†…å¤§é‡404è¯·æ±‚
        if (is404RequestsExcessive(ip)) {
            blacklistManager.addToTemporaryBlacklist(ip, 30); // å°ç¦30åˆ†é’Ÿ
        }
        
        // å°è¯•è®¿é—®æ•æ„Ÿè·¯å¾„
        if (isSensitivePathAccess(request.getRequestURI())) {
            blacklistManager.addToTemporaryBlacklist(ip, 60); // å°ç¦1å°æ—¶
        }
        
        // ç™»å½•å¤±è´¥è¿‡å¤š
        if (isLoginFailureExcessive(ip)) {
            blacklistManager.addToTemporaryBlacklist(ip, 120); // å°ç¦2å°æ—¶
        }
    }
}
```

**ğŸ“Š é»‘åå•ç­‰çº§ç®¡ç†**ï¼š
```java
public enum BlacklistLevel {
    TEMPORARY(30),    // ä¸´æ—¶å°ç¦ï¼š30åˆ†é’Ÿ
    SHORT_TERM(1440), // çŸ­æœŸå°ç¦ï¼š24å°æ—¶  
    LONG_TERM(10080), // é•¿æœŸå°ç¦ï¼š7å¤©
    PERMANENT(-1);    // æ°¸ä¹…å°ç¦
    
    private final int durationMinutes;
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å®‰å…¨é˜²æŠ¤æ€ç»´ï¼šé¢„é˜²èƒœäºæ²»ç–—ï¼Œåœ¨é—®é¢˜å‘ç”Ÿå‰å°±é˜»æ­¢
ğŸ”¸ è¿‡æ»¤å™¨ä¼˜åŠ¿ï¼šç»Ÿä¸€å¤„ç†ï¼Œæå‰æ‹¦æˆªï¼Œé€æ˜é˜²æŠ¤
ğŸ”¸ XSSé˜²æŠ¤ï¼šè½¬ä¹‰å±é™©å­—ç¬¦ï¼Œé˜²æ­¢æ¶æ„è„šæœ¬æ‰§è¡Œ
ğŸ”¸ SQLæ³¨å…¥é˜²æŠ¤ï¼šå‚æ•°æ ¡éªŒ+é¢„ç¼–è¯‘è¯­å¥åŒé‡ä¿é™©
ğŸ”¸ CSRFé˜²æŠ¤ï¼šä»¤ç‰ŒéªŒè¯ï¼Œç¡®ä¿è¯·æ±‚æ¥è‡ªåˆæ³•ç”¨æˆ·
ğŸ”¸ æ•æ„Ÿè¯è¿‡æ»¤ï¼šç»´æŠ¤è‰¯å¥½çš„å†…å®¹ç¯å¢ƒ
ğŸ”¸ é¢‘ç‡é™åˆ¶ï¼šé˜²æ­¢æ¶æ„åˆ·æ–°å’Œæš´åŠ›æ”»å‡»
ğŸ”¸ é»‘åå•ç®¡ç†ï¼šè®°ä½åäººï¼Œæ‹’ç»é‡å¤ä¼¤å®³
```

### 9.2 å®‰å…¨é˜²æŠ¤æœ€ä½³å®è·µ


**ğŸ›¡ï¸ é˜²æŠ¤å±‚æ¬¡åŒ–**ï¼š
```
ç¬¬1å±‚ï¼šç½‘ç»œé˜²æŠ¤ï¼ˆé˜²ç«å¢™ã€DDoSé˜²æŠ¤ï¼‰
ç¬¬2å±‚ï¼šæœåŠ¡å™¨é˜²æŠ¤ï¼ˆè¿‡æ»¤å™¨å®‰å…¨æ£€æŸ¥ï¼‰  
ç¬¬3å±‚ï¼šåº”ç”¨é˜²æŠ¤ï¼ˆä¸šåŠ¡é€»è¾‘æ ¡éªŒï¼‰
ç¬¬4å±‚ï¼šæ•°æ®é˜²æŠ¤ï¼ˆæ•°æ®åº“æƒé™æ§åˆ¶ï¼‰

å°±åƒå¤ä»£åŸæ± çš„å¤šé‡é˜²çº¿ï¼Œä¸€å±‚è¢«çªç ´è¿˜æœ‰ä¸‹ä¸€å±‚
```

**âš¡ æ€§èƒ½ä¸å®‰å…¨å¹³è¡¡**ï¼š
```
å®‰å…¨çº§åˆ«   æ£€æŸ¥å¤æ‚åº¦   æ€§èƒ½å½±å“   é€‚ç”¨åœºæ™¯
 ä½        ç®€å•       å¾ˆå°      ä¸€èˆ¬ç½‘ç«™  
 ä¸­        ä¸­ç­‰       å°        å•†ä¸šç½‘ç«™
 é«˜        å¤æ‚       ä¸­ç­‰      é‡‘èç½‘ç«™
 æé«˜      å¾ˆå¤æ‚     è¾ƒå¤§      å†›å·¥ç³»ç»Ÿ
```

**ğŸ”„ æŒç»­æ”¹è¿›ç­–ç•¥**ï¼š
```
ç›‘æ§ â†’ åˆ†æ â†’ ä¼˜åŒ– â†’ ç›‘æ§

ğŸ“Š ç›‘æ§å…³é”®æŒ‡æ ‡ï¼š
- æ”»å‡»æ‹¦æˆªç‡
- è¯¯æŠ¥ç‡  
- ç³»ç»Ÿæ€§èƒ½å½±å“
- ç”¨æˆ·ä½“éªŒåé¦ˆ

ğŸ“ˆ æŒç»­ä¼˜åŒ–ï¼š
- æ ¹æ®æ—¥å¿—è°ƒæ•´è¿‡æ»¤è§„åˆ™
- å®šæœŸæ›´æ–°é»‘åå•æ•°æ®
- ä¼˜åŒ–ç®—æ³•æé«˜æ€§èƒ½
- å…³æ³¨æ–°çš„å®‰å…¨å¨èƒ
```

### 9.3 å¼€å‘å»ºè®®


**ğŸ’» ç¼–ç å®è·µ**ï¼š
- **å¤šå±‚æ ¡éªŒ**ï¼šå‰ç«¯æ ¡éªŒ+åç«¯æ ¡éªŒ+æ•°æ®åº“æ ¡éªŒ
- **æ—¥å¿—è®°å½•**ï¼šè¯¦ç»†è®°å½•å®‰å…¨äº‹ä»¶ï¼Œä¾¿äºè¿½è¸ªåˆ†æ
- **é…ç½®å¤–éƒ¨åŒ–**ï¼šå®‰å…¨è§„åˆ™å¯é…ç½®ï¼Œä¾¿äºè°ƒæ•´
- **æµ‹è¯•è¦†ç›–**ï¼šç¼–å†™å®‰å…¨æµ‹è¯•ç”¨ä¾‹ï¼Œç¡®ä¿é˜²æŠ¤æœ‰æ•ˆ

**ğŸ¯ éƒ¨ç½²å»ºè®®**ï¼š
- **åˆ†ç¯å¢ƒé…ç½®**ï¼šå¼€å‘ç¯å¢ƒå®½æ¾ï¼Œç”Ÿäº§ç¯å¢ƒä¸¥æ ¼
- **ç›‘æ§å‘Šè­¦**ï¼šè®¾ç½®å®‰å…¨äº‹ä»¶å‘Šè­¦æœºåˆ¶
- **å®šæœŸæ›´æ–°**ï¼šåŠæ—¶æ›´æ–°å®‰å…¨è§„åˆ™å’Œé»‘åå•
- **åº”æ€¥é¢„æ¡ˆ**ï¼šå‡†å¤‡å®‰å…¨äº‹ä»¶çš„åº”å¯¹æµç¨‹

**æ ¸å¿ƒè®°å¿†**ï¼š
- Webå®‰å…¨é˜²æŠ¤è¦å…¨é¢è€ƒè™‘ï¼Œä¸èƒ½é¡¾æ­¤å¤±å½¼
- è¿‡æ»¤å™¨æ˜¯å®ç°ç»Ÿä¸€å®‰å…¨é˜²æŠ¤çš„æœ€ä½³ä½ç½®
- å®‰å…¨æ€§å’Œæ˜“ç”¨æ€§éœ€è¦å¹³è¡¡ï¼Œè¿‡åº¦é˜²æŠ¤å½±å“ç”¨æˆ·ä½“éªŒ
- æŒç»­ç›‘æ§å’Œæ”¹è¿›æ˜¯å®‰å…¨é˜²æŠ¤çš„é•¿æœŸä»»åŠ¡