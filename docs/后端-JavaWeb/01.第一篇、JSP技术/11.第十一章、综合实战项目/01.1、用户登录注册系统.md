---
title: 1ã€ç”¨æˆ·ç™»å½•æ³¨å†Œç³»ç»Ÿ
---
## ğŸ“š ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°ä¸å‡†å¤‡å·¥ä½œ](#1-é¡¹ç›®æ¦‚è¿°ä¸å‡†å¤‡å·¥ä½œ)
2. [ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½å®ç°](#2-ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½å®ç°)
3. [ç”¨æˆ·ç™»å½•åŠŸèƒ½å®ç°](#3-ç”¨æˆ·ç™»å½•åŠŸèƒ½å®ç°)
4. [è¡¨å•æ•°æ®æ ¡éªŒ](#4-è¡¨å•æ•°æ®æ ¡éªŒ)
5. [ä¼šè¯çŠ¶æ€ç®¡ç†](#5-ä¼šè¯çŠ¶æ€ç®¡ç†)
6. [æƒé™æ§åˆ¶åŸºç¡€](#6-æƒé™æ§åˆ¶åŸºç¡€)
7. [å®Œæ•´é¡¹ç›®æ¼”ç¤º](#7-å®Œæ•´é¡¹ç›®æ¼”ç¤º)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ é¡¹ç›®æ¦‚è¿°ä¸å‡†å¤‡å·¥ä½œ


### 1.1 ä»€ä¹ˆæ˜¯ç”¨æˆ·ç™»å½•æ³¨å†Œç³»ç»Ÿ


**ç®€å•ç†è§£**ï¼šå°±åƒæˆ‘ä»¬å¹³æ—¶ä½¿ç”¨QQã€å¾®ä¿¡ä¸€æ ·ï¼Œéœ€è¦å…ˆæ³¨å†Œè´¦å·ï¼Œç„¶åç”¨è´¦å·å¯†ç ç™»å½•ä½¿ç”¨ã€‚

```
ç”¨æˆ·ä½¿ç”¨æµç¨‹ï¼š
æ–°ç”¨æˆ·ï¼šå¡«å†™æ³¨å†Œè¡¨å• â†’ æäº¤æ•°æ® â†’ ç³»ç»Ÿä¿å­˜ â†’ æ³¨å†ŒæˆåŠŸ
è€ç”¨æˆ·ï¼šè¾“å…¥ç”¨æˆ·åå¯†ç  â†’ ç³»ç»ŸéªŒè¯ â†’ éªŒè¯é€šè¿‡ â†’ ç™»å½•æˆåŠŸ
```

**æ ¸å¿ƒåŠŸèƒ½æ¨¡å—**ï¼š
- ğŸ”¸ **ç”¨æˆ·æ³¨å†Œ**ï¼šè®©æ–°ç”¨æˆ·åˆ›å»ºè´¦å·
- ğŸ”¸ **ç”¨æˆ·ç™»å½•**ï¼šéªŒè¯ç”¨æˆ·èº«ä»½
- ğŸ”¸ **æ•°æ®æ ¡éªŒ**ï¼šç¡®ä¿è¾“å…¥çš„ä¿¡æ¯ç¬¦åˆè¦æ±‚
- ğŸ”¸ **ä¼šè¯ç®¡ç†**ï¼šè®°ä½ç”¨æˆ·å·²ç»ç™»å½•çš„çŠ¶æ€
- ğŸ”¸ **æƒé™æ§åˆ¶**ï¼šåŒºåˆ†ä¸åŒç”¨æˆ·èƒ½è®¿é—®çš„é¡µé¢

### 1.2 é¡¹ç›®æŠ€æœ¯æ¶æ„


**æŠ€æœ¯æ ˆç»„åˆ**ï¼š
```
å‰ç«¯é¡µé¢ï¼šHTML + CSS + JavaScriptï¼ˆåŸºç¡€ç¾åŒ–å’Œæ ¡éªŒï¼‰
æœåŠ¡ç«¯ï¼šJSP + Servletï¼ˆå¤„ç†ä¸šåŠ¡é€»è¾‘ï¼‰
æ•°æ®å­˜å‚¨ï¼šMySQLæ•°æ®åº“ï¼ˆä¿å­˜ç”¨æˆ·ä¿¡æ¯ï¼‰
ä¼šè¯ç®¡ç†ï¼šHttpSessionï¼ˆè®°å½•ç™»å½•çŠ¶æ€ï¼‰
```

**æ–‡ä»¶ç»“æ„é¢„è§ˆ**ï¼š
```
WebContent/
â”œâ”€â”€ WEB-INF/
â”‚   â”œâ”€â”€ web.xml                 â† é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ lib/                    â† jaråŒ…å­˜æ”¾
â”œâ”€â”€ css/
â”‚   â””â”€â”€ style.css              â† æ ·å¼æ–‡ä»¶
â”œâ”€â”€ js/
â”‚   â””â”€â”€ validation.js          â† å‰ç«¯æ ¡éªŒ
â”œâ”€â”€ register.jsp               â† æ³¨å†Œé¡µé¢
â”œâ”€â”€ login.jsp                  â† ç™»å½•é¡µé¢
â”œâ”€â”€ welcome.jsp                â† ç™»å½•æˆåŠŸé¡µé¢
â””â”€â”€ index.jsp                  â† é¦–é¡µ
```

### 1.3 æ•°æ®åº“è®¾è®¡


**ç”¨æˆ·è¡¨ç»“æ„**ï¼ˆç®€å•å®ç”¨ï¼‰ï¼š
```sql
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) NOT NULL UNIQUE,    -- ç”¨æˆ·åï¼ˆå”¯ä¸€ï¼‰
    password VARCHAR(100) NOT NULL,          -- å¯†ç 
    email VARCHAR(100),                      -- é‚®ç®±
    phone VARCHAR(20),                       -- æ‰‹æœºå·
    register_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP  -- æ³¨å†Œæ—¶é—´
);
```

> **ğŸ’¡ è®¾è®¡è¯´æ˜**ï¼š
> - `id`ï¼šä¸»é”®ï¼Œè‡ªå¢é•¿ï¼Œæ¯ä¸ªç”¨æˆ·å”¯ä¸€æ ‡è¯†
> - `username`ï¼šç”¨æˆ·åï¼Œè®¾ç½®UNIQUEç¡®ä¿ä¸é‡å¤
> - `password`ï¼šå¯†ç ï¼Œå®é™…é¡¹ç›®ä¸­éœ€è¦åŠ å¯†å­˜å‚¨
> - å…¶ä»–å­—æ®µï¼šæ‰©å±•ä¿¡æ¯ï¼Œæ ¹æ®éœ€è¦æ·»åŠ 

---

## 2. ğŸ“ ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½å®ç°


### 2.1 æ³¨å†Œé¡µé¢è®¾è®¡


**register.jsp - æ³¨å†Œè¡¨å•**ï¼š
```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ç”¨æˆ·æ³¨å†Œ</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <h2>ğŸ” ç”¨æˆ·æ³¨å†Œ</h2>
        
        <%-- æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ --%>
        <% String error = (String)request.getAttribute("error"); %>
        <% if(error != null) { %>
            <div class="error-msg">âŒ <%= error %></div>
        <% } %>
        
        <form action="RegisterServlet" method="post" onsubmit="return validateForm()">
            <div class="form-group">
                <label>ç”¨æˆ·åï¼š</label>
                <input type="text" name="username" id="username" required>
                <span class="hint">3-20ä¸ªå­—ç¬¦ï¼Œå­—æ¯æ•°å­—ä¸‹åˆ’çº¿</span>
            </div>
            
            <div class="form-group">
                <label>å¯†ç ï¼š</label>
                <input type="password" name="password" id="password" required>
                <span class="hint">è‡³å°‘6ä½å­—ç¬¦</span>
            </div>
            
            <div class="form-group">
                <label>ç¡®è®¤å¯†ç ï¼š</label>
                <input type="password" name="confirmPassword" id="confirmPassword" required>
            </div>
            
            <div class="form-group">
                <label>é‚®ç®±ï¼š</label>
                <input type="email" name="email" id="email">
            </div>
            
            <div class="form-actions">
                <button type="submit">ç«‹å³æ³¨å†Œ</button>
                <a href="login.jsp" class="link">å·²æœ‰è´¦å·ï¼Ÿå»ç™»å½•</a>
            </div>
        </form>
    </div>
</body>
</html>
```

**å…³é”®è®¾è®¡è¦ç‚¹**ï¼š
- ğŸ”¸ ä½¿ç”¨`method="post"`ï¼šå¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ä¸èƒ½ç”¨GETæ–¹å¼ä¼ è¾“
- ğŸ”¸ `required`å±æ€§ï¼šHTML5åŸºç¡€æ ¡éªŒï¼Œå¿…å¡«é¡¹ä¸èƒ½ä¸ºç©º
- ğŸ”¸ é”™è¯¯æç¤ºæ˜¾ç¤ºï¼šç”¨JSPè„šæœ¬æ˜¾ç¤ºåç«¯ä¼ æ¥çš„é”™è¯¯ä¿¡æ¯
- ğŸ”¸ ç”¨æˆ·ä½“éªŒä¼˜åŒ–ï¼šæä¾›è¾“å…¥æç¤ºå’Œé¡µé¢é—´è·³è½¬é“¾æ¥

### 2.2 æ³¨å†Œä¸šåŠ¡å¤„ç†


**RegisterServlet.java - æ³¨å†Œé€»è¾‘å¤„ç†**ï¼š
```java
@WebServlet("/RegisterServlet")
public class RegisterServlet extends HttpServlet {
    
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        // è®¾ç½®ç¼–ç ï¼Œé˜²æ­¢ä¸­æ–‡ä¹±ç 
        request.setCharacterEncoding("UTF-8");
        response.setContentType("text/html;charset=UTF-8");
        
        // 1. è·å–è¡¨å•æ•°æ®
        String username = request.getParameter("username");
        String password = request.getParameter("password");
        String confirmPassword = request.getParameter("confirmPassword");
        String email = request.getParameter("email");
        
        // 2. æ•°æ®æ ¡éªŒ
        if(!validateInput(username, password, confirmPassword, request)) {
            return; // æ ¡éªŒå¤±è´¥ï¼Œç›´æ¥è¿”å›
        }
        
        // 3. æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
        UserDAO userDAO = new UserDAO();
        if(userDAO.isUserExists(username)) {
            request.setAttribute("error", "ç”¨æˆ·åå·²å­˜åœ¨ï¼Œè¯·é€‰æ‹©å…¶ä»–ç”¨æˆ·å");
            request.getRequestDispatcher("register.jsp").forward(request, response);
            return;
        }
        
        // 4. ä¿å­˜ç”¨æˆ·ä¿¡æ¯åˆ°æ•°æ®åº“
        User user = new User(username, password, email);
        boolean success = userDAO.saveUser(user);
        
        if(success) {
            // æ³¨å†ŒæˆåŠŸï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢
            response.sendRedirect("login.jsp?msg=æ³¨å†ŒæˆåŠŸï¼Œè¯·ç™»å½•");
        } else {
            // æ³¨å†Œå¤±è´¥
            request.setAttribute("error", "æ³¨å†Œå¤±è´¥ï¼Œè¯·é‡è¯•");
            request.getRequestDispatcher("register.jsp").forward(request, response);
        }
    }
    
    // è¾“å…¥æ•°æ®æ ¡éªŒæ–¹æ³•
    private boolean validateInput(String username, String password, 
                                String confirmPassword, HttpServletRequest request) {
        
        if(username == null || username.trim().length() < 3) {
            request.setAttribute("error", "ç”¨æˆ·åè‡³å°‘3ä¸ªå­—ç¬¦");
            try {
                request.getRequestDispatcher("register.jsp").forward(request, 
                    ((ServletResponse) request).getResponse());
            } catch (Exception e) { }
            return false;
        }
        
        if(!password.equals(confirmPassword)) {
            request.setAttribute("error", "ä¸¤æ¬¡å¯†ç è¾“å…¥ä¸ä¸€è‡´");
            return false;
        }
        
        return true;
    }
}
```

**æ ¸å¿ƒå¤„ç†æµç¨‹è§£é‡Š**ï¼š
1. **æ•°æ®æ¥æ”¶**ï¼šç”¨`request.getParameter()`è·å–è¡¨å•æ•°æ®
2. **æ•°æ®æ ¡éªŒ**ï¼šæ£€æŸ¥ç”¨æˆ·åé•¿åº¦ã€å¯†ç ä¸€è‡´æ€§ç­‰
3. **å”¯ä¸€æ€§æ£€æŸ¥**ï¼šæŸ¥è¯¢æ•°æ®åº“ç¡®ä¿ç”¨æˆ·åä¸é‡å¤
4. **æ•°æ®ä¿å­˜**ï¼šè°ƒç”¨DAOå±‚ä¿å­˜åˆ°æ•°æ®åº“
5. **ç»“æœåé¦ˆ**ï¼šæˆåŠŸè·³è½¬ç™»å½•é¡µï¼Œå¤±è´¥æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯

### 2.3 æ•°æ®è®¿é—®å±‚å®ç°


**UserDAO.java - æ•°æ®åº“æ“ä½œ**ï¼š
```java
public class UserDAO {
    
    // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
    public boolean isUserExists(String username) {
        String sql = "SELECT COUNT(*) FROM users WHERE username = ?";
        
        try(Connection conn = DBUtil.getConnection();
            PreparedStatement ps = conn.prepareStatement(sql)) {
            
            ps.setString(1, username);
            ResultSet rs = ps.executeQuery();
            
            if(rs.next()) {
                return rs.getInt(1) > 0;  // å¤§äº0è¯´æ˜å­˜åœ¨
            }
            
        } catch(SQLException e) {
            e.printStackTrace();
        }
        
        return false;
    }
    
    // ä¿å­˜æ–°ç”¨æˆ·
    public boolean saveUser(User user) {
        String sql = "INSERT INTO users(username, password, email) VALUES(?, ?, ?)";
        
        try(Connection conn = DBUtil.getConnection();
            PreparedStatement ps = conn.prepareStatement(sql)) {
            
            ps.setString(1, user.getUsername());
            ps.setString(2, user.getPassword());  // å®é™…é¡¹ç›®éœ€è¦åŠ å¯†
            ps.setString(3, user.getEmail());
            
            int rows = ps.executeUpdate();
            return rows > 0;  // å½±å“è¡Œæ•°å¤§äº0è¡¨ç¤ºæˆåŠŸ
            
        } catch(SQLException e) {
            e.printStackTrace();
            return false;
        }
    }
}
```

**DAOå±‚è®¾è®¡ç†å¿µ**ï¼š
- ğŸ”¸ **èŒè´£å•ä¸€**ï¼šåªè´Ÿè´£æ•°æ®åº“æ“ä½œï¼Œä¸å¤„ç†ä¸šåŠ¡é€»è¾‘
- ğŸ”¸ **èµ„æºç®¡ç†**ï¼šä½¿ç”¨try-with-resourcesè‡ªåŠ¨å…³é—­è¿æ¥
- ğŸ”¸ **å¼‚å¸¸å¤„ç†**ï¼šæ•è·SQLå¼‚å¸¸ï¼Œä¿è¯ç¨‹åºç¨³å®šæ€§
- ğŸ”¸ **è¿”å›å€¼æ˜ç¡®**ï¼šç”¨booleanæ˜ç¡®è¡¨ç¤ºæ“ä½œæˆåŠŸä¸å¦

---

## 3. ğŸ”‘ ç”¨æˆ·ç™»å½•åŠŸèƒ½å®ç°


### 3.1 ç™»å½•é¡µé¢è®¾è®¡


**login.jsp - ç™»å½•è¡¨å•**ï¼š
```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ç”¨æˆ·ç™»å½•</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <h2>ğŸ”“ ç”¨æˆ·ç™»å½•</h2>
        
        <%-- æ˜¾ç¤ºæ¶ˆæ¯ï¼ˆæ³¨å†ŒæˆåŠŸæç¤ºç­‰ï¼‰ --%>
        <% String msg = request.getParameter("msg"); %>
        <% if(msg != null) { %>
            <div class="success-msg">âœ… <%= msg %></div>
        <% } %>
        
        <%-- æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ --%>
        <% String error = (String)request.getAttribute("error"); %>
        <% if(error != null) { %>
            <div class="error-msg">âŒ <%= error %></div>
        <% } %>
        
        <form action="LoginServlet" method="post">
            <div class="form-group">
                <label>ç”¨æˆ·åï¼š</label>
                <input type="text" name="username" required 
                       value="<%= request.getParameter("username") != null ? 
                              request.getParameter("username") : "" %>">
            </div>
            
            <div class="form-group">
                <label>å¯†ç ï¼š</label>
                <input type="password" name="password" required>
            </div>
            
            <div class="form-group">
                <label>
                    <input type="checkbox" name="rememberMe" value="true"> 
                    è®°ä½æˆ‘ï¼ˆ7å¤©å†…å…ç™»å½•ï¼‰
                </label>
            </div>
            
            <div class="form-actions">
                <button type="submit">ç«‹å³ç™»å½•</button>
                <a href="register.jsp" class="link">æ²¡æœ‰è´¦å·ï¼Ÿå»æ³¨å†Œ</a>
            </div>
        </form>
    </div>
</body>
</html>
```

**é¡µé¢è®¾è®¡äº®ç‚¹**ï¼š
- ğŸ”¸ **ä¿ç•™ç”¨æˆ·å**ï¼šç™»å½•å¤±è´¥æ—¶ä¿ç•™ä¹‹å‰è¾“å…¥çš„ç”¨æˆ·å
- ğŸ”¸ **æ¶ˆæ¯åŒºåˆ†**ï¼šæˆåŠŸæ¶ˆæ¯ç”¨ç»¿è‰²ï¼Œé”™è¯¯æ¶ˆæ¯ç”¨çº¢è‰²
- ğŸ”¸ **è®°ä½æˆ‘åŠŸèƒ½**ï¼šä¸ºåç»­CookieåŠŸèƒ½é¢„ç•™æ¥å£
- ğŸ”¸ **å‹å¥½æç¤º**ï¼šæä¾›æ³¨å†Œé¡µé¢è·³è½¬é“¾æ¥

### 3.2 ç™»å½•éªŒè¯é€»è¾‘


**LoginServlet.java - ç™»å½•å¤„ç†**ï¼š
```java
@WebServlet("/LoginServlet")
public class LoginServlet extends HttpServlet {
    
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        request.setCharacterEncoding("UTF-8");
        response.setContentType("text/html;charset=UTF-8");
        
        // 1. è·å–ç™»å½•ä¿¡æ¯
        String username = request.getParameter("username");
        String password = request.getParameter("password");
        String rememberMe = request.getParameter("rememberMe");
        
        // 2. åŸºæœ¬æ ¡éªŒ
        if(username == null || password == null || 
           username.trim().isEmpty() || password.trim().isEmpty()) {
            request.setAttribute("error", "ç”¨æˆ·åå’Œå¯†ç ä¸èƒ½ä¸ºç©º");
            request.getRequestDispatcher("login.jsp").forward(request, response);
            return;
        }
        
        // 3. éªŒè¯ç”¨æˆ·èº«ä»½
        UserDAO userDAO = new UserDAO();
        User user = userDAO.validateUser(username, password);
        
        if(user != null) {
            // ç™»å½•æˆåŠŸå¤„ç†
            handleLoginSuccess(request, response, user, rememberMe);
        } else {
            // ç™»å½•å¤±è´¥å¤„ç†
            request.setAttribute("error", "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯");
            request.getRequestDispatcher("login.jsp").forward(request, response);
        }
    }
    
    // ç™»å½•æˆåŠŸåçš„å¤„ç†
    private void handleLoginSuccess(HttpServletRequest request, HttpServletResponse response, 
                                  User user, String rememberMe) throws IOException {
        
        // åˆ›å»ºä¼šè¯ï¼Œä¿å­˜ç”¨æˆ·ä¿¡æ¯
        HttpSession session = request.getSession();
        session.setAttribute("currentUser", user);
        session.setAttribute("username", user.getUsername());
        
        // å¦‚æœå‹¾é€‰äº†"è®°ä½æˆ‘"
        if("true".equals(rememberMe)) {
            Cookie userCookie = new Cookie("username", user.getUsername());
            userCookie.setMaxAge(7 * 24 * 60 * 60); // 7å¤©
            userCookie.setPath("/");
            response.addCookie(userCookie);
        }
        
        // è·³è½¬åˆ°æ¬¢è¿é¡µé¢
        response.sendRedirect("welcome.jsp");
    }
}
```

**UserDAO.java - ç”¨æˆ·éªŒè¯æ–¹æ³•**ï¼š
```java
// éªŒè¯ç”¨æˆ·ç™»å½•
public User validateUser(String username, String password) {
    String sql = "SELECT * FROM users WHERE username = ? AND password = ?";
    
    try(Connection conn = DBUtil.getConnection();
        PreparedStatement ps = conn.prepareStatement(sql)) {
        
        ps.setString(1, username);
        ps.setString(2, password);
        
        ResultSet rs = ps.executeQuery();
        
        if(rs.next()) {
            // æ‰¾åˆ°åŒ¹é…ç”¨æˆ·ï¼Œåˆ›å»ºUserå¯¹è±¡è¿”å›
            User user = new User();
            user.setId(rs.getInt("id"));
            user.setUsername(rs.getString("username"));
            user.setEmail(rs.getString("email"));
            user.setRegisterTime(rs.getTimestamp("register_time"));
            return user;
        }
        
    } catch(SQLException e) {
        e.printStackTrace();
    }
    
    return null; // æ²¡æ‰¾åˆ°åŒ¹é…ç”¨æˆ·
}
```

**ç™»å½•æµç¨‹è¯¦è§£**ï¼š

```
ç”¨æˆ·ç™»å½•éªŒè¯æµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¾“å…¥ç”¨æˆ·å  â”‚â”€â”€â”€â–¶â”‚  æäº¤è¡¨å•    â”‚â”€â”€â”€â–¶â”‚  åç«¯æ¥æ”¶    â”‚
â”‚  è¾“å…¥å¯†ç     â”‚    â”‚  åˆ°Servlet   â”‚    â”‚  éªŒè¯æ•°æ®    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è·³è½¬æ¬¢è¿é¡µ  â”‚â—€â”€â”€â”€â”‚  åˆ›å»ºä¼šè¯    â”‚â—€â”€â”€â”€â”‚  æ•°æ®åº“éªŒè¯  â”‚
â”‚  æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯â”‚    â”‚  ä¿å­˜çŠ¶æ€    â”‚    â”‚  ç”¨æˆ·å¯†ç     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. âœ… è¡¨å•æ•°æ®æ ¡éªŒ


### 4.1 å‰ç«¯JavaScriptæ ¡éªŒ


**validation.js - å®¢æˆ·ç«¯æ ¡éªŒ**ï¼š
```javascript
// è¡¨å•æäº¤å‰æ ¡éªŒ
function validateForm() {
    var username = document.getElementById('username').value;
    var password = document.getElementById('password').value;
    var confirmPassword = document.getElementById('confirmPassword').value;
    
    // ç”¨æˆ·åæ ¡éªŒ
    if(username.length < 3 || username.length > 20) {
        alert('âŒ ç”¨æˆ·åå¿…é¡»æ˜¯3-20ä¸ªå­—ç¬¦');
        return false;
    }
    
    // ç”¨æˆ·ååªèƒ½åŒ…å«å­—æ¯æ•°å­—ä¸‹åˆ’çº¿
    var usernamePattern = /^[a-zA-Z0-9_]+$/;
    if(!usernamePattern.test(username)) {
        alert('âŒ ç”¨æˆ·ååªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿');
        return false;
    }
    
    // å¯†ç é•¿åº¦æ ¡éªŒ
    if(password.length < 6) {
        alert('âŒ å¯†ç è‡³å°‘6ä¸ªå­—ç¬¦');
        return false;
    }
    
    // ç¡®è®¤å¯†ç æ ¡éªŒ
    if(password !== confirmPassword) {
        alert('âŒ ä¸¤æ¬¡å¯†ç è¾“å…¥ä¸ä¸€è‡´');
        return false;
    }
    
    return true; // æ‰€æœ‰æ ¡éªŒé€šè¿‡
}

// å®æ—¶å¯†ç å¼ºåº¦æ£€æµ‹
function checkPasswordStrength() {
    var password = document.getElementById('password').value;
    var strengthDiv = document.getElementById('password-strength');
    
    if(password.length === 0) {
        strengthDiv.innerHTML = '';
        return;
    }
    
    var strength = 0;
    if(password.length >= 6) strength++;
    if(/[a-z]/.test(password)) strength++;
    if(/[A-Z]/.test(password)) strength++;
    if(/[0-9]/.test(password)) strength++;
    if(/[^a-zA-Z0-9]/.test(password)) strength++;
    
    var strengthText = ['å¾ˆå¼±', 'å¼±', 'ä¸€èˆ¬', 'å¼º', 'å¾ˆå¼º'];
    var strengthColor = ['#ff4444', '#ff8844', '#ffaa44', '#44ff88', '#44aa88'];
    
    strengthDiv.innerHTML = `å¯†ç å¼ºåº¦ï¼š<span style="color: ${strengthColor[strength-1]}">${strengthText[strength-1]}</span>`;
}
```

### 4.2 åç«¯æœåŠ¡å™¨æ ¡éªŒ


**InputValidator.java - æœåŠ¡ç«¯æ ¡éªŒå·¥å…·ç±»**ï¼š
```java
public class InputValidator {
    
    // ç”¨æˆ·åæ ¡éªŒ
    public static String validateUsername(String username) {
        if(username == null || username.trim().isEmpty()) {
            return "ç”¨æˆ·åä¸èƒ½ä¸ºç©º";
        }
        
        if(username.length() < 3 || username.length() > 20) {
            return "ç”¨æˆ·åå¿…é¡»æ˜¯3-20ä¸ªå­—ç¬¦";
        }
        
        if(!username.matches("^[a-zA-Z0-9_]+$")) {
            return "ç”¨æˆ·ååªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿";
        }
        
        return null; // æ ¡éªŒé€šè¿‡
    }
    
    // å¯†ç æ ¡éªŒ
    public static String validatePassword(String password) {
        if(password == null || password.trim().isEmpty()) {
            return "å¯†ç ä¸èƒ½ä¸ºç©º";
        }
        
        if(password.length() < 6) {
            return "å¯†ç è‡³å°‘6ä¸ªå­—ç¬¦";
        }
        
        return null;
    }
    
    // é‚®ç®±æ ¡éªŒ
    public static String validateEmail(String email) {
        if(email != null && !email.trim().isEmpty()) {
            String emailPattern = "^[A-Za-z0-9+_.-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$";
            if(!email.matches(emailPattern)) {
                return "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®";
            }
        }
        return null;
    }
    
    // ç»¼åˆæ ¡éªŒæ–¹æ³•
    public static Map<String, String> validateRegisterForm(String username, String password, 
                                                          String confirmPassword, String email) {
        Map<String, String> errors = new HashMap<>();
        
        String usernameError = validateUsername(username);
        if(usernameError != null) {
            errors.put("username", usernameError);
        }
        
        String passwordError = validatePassword(password);
        if(passwordError != null) {
            errors.put("password", passwordError);
        }
        
        if(!password.equals(confirmPassword)) {
            errors.put("confirmPassword", "ä¸¤æ¬¡å¯†ç è¾“å…¥ä¸ä¸€è‡´");
        }
        
        String emailError = validateEmail(email);
        if(emailError != null) {
            errors.put("email", emailError);
        }
        
        return errors;
    }
}
```

### 4.3 æ ¡éªŒæœ€ä½³å®è·µ


**åŒé‡æ ¡éªŒæœºåˆ¶**ï¼š

```
å‰ç«¯æ ¡éªŒï¼ˆå®¢æˆ·ç«¯ï¼‰ï¼š
â”œâ”€â”€ ä¼˜ç‚¹ï¼šå“åº”å¿«ï¼Œç”¨æˆ·ä½“éªŒå¥½
â”œâ”€â”€ ç¼ºç‚¹ï¼šå¯ä»¥è¢«ç»•è¿‡ï¼Œä¸å®‰å…¨
â””â”€â”€ ä½œç”¨ï¼šæå‡ç”¨æˆ·ä½“éªŒï¼Œå‡å°‘æœåŠ¡å™¨è´Ÿæ‹…

åç«¯æ ¡éªŒï¼ˆæœåŠ¡å™¨ç«¯ï¼‰ï¼š
â”œâ”€â”€ ä¼˜ç‚¹ï¼šå®‰å…¨å¯é ï¼Œä¸èƒ½è¢«ç»•è¿‡
â”œâ”€â”€ ç¼ºç‚¹ï¼šéœ€è¦ç½‘ç»œè¯·æ±‚ï¼Œå“åº”ç¨æ…¢
â””â”€â”€ ä½œç”¨ï¼šä¿è¯æ•°æ®å®‰å…¨å’Œä¸€è‡´æ€§

æœ€ä½³å®è·µï¼šå‰ç«¯ + åç«¯ åŒé‡æ ¡éªŒ
```

**æ ¡éªŒè§„åˆ™å¯¹æ¯”è¡¨**ï¼š

| æ ¡éªŒé¡¹ç›® | **å‰ç«¯è§„åˆ™** | **åç«¯è§„åˆ™** | **ç›®çš„** |
|---------|-------------|-------------|---------|
| ç”¨æˆ·å | 3-20å­—ç¬¦ï¼Œå­—æ¯æ•°å­—ä¸‹åˆ’çº¿ | åŒå‰ç«¯ + æ•°æ®åº“å”¯ä¸€æ€§æ£€æŸ¥ | ç¡®ä¿æ ¼å¼å’Œå”¯ä¸€æ€§ |
| å¯†ç  | è‡³å°‘6ä½ | åŒå‰ç«¯ + å¼ºåº¦æ£€æµ‹ | ä¿è¯å®‰å…¨æ€§ |
| é‚®ç®± | HTML5æ ¼å¼æ ¡éªŒ | æ­£åˆ™è¡¨è¾¾å¼ç²¾ç¡®æ ¡éªŒ | ç¡®ä¿æ ¼å¼æ­£ç¡® |
| å¿…å¡«é¡¹ | requiredå±æ€§ | nullå’Œç©ºå­—ç¬¦ä¸²æ£€æŸ¥ | ä¿è¯æ•°æ®å®Œæ•´æ€§ |

---

## 5. ğŸ­ ä¼šè¯çŠ¶æ€ç®¡ç†


### 5.1 HttpSessionåŸºç¡€åº”ç”¨


**ä»€ä¹ˆæ˜¯ä¼šè¯ç®¡ç†**ï¼Ÿ
> ç®€å•ç†è§£ï¼šå°±åƒä½ åœ¨é“¶è¡ŒåŠä¸šåŠ¡ï¼Œå·¥ä½œäººå‘˜è®¤è¯†ä½ ï¼ŒçŸ¥é“ä½ æ˜¯VIPå®¢æˆ·ï¼Œè¿™å°±æ˜¯"è®°ä½çŠ¶æ€"ã€‚HTTPæ˜¯æ— çŠ¶æ€çš„ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œä¼šè¯ç®¡ç†å°±æ˜¯è®©æœåŠ¡å™¨"è®°ä½"ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ã€‚

**Sessionå·¥ä½œåŸç†**ï¼š
```
Sessionæœºåˆ¶å·¥ä½œæµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·ç™»å½•  â”‚â”€â”€â”€â–¶â”‚  åˆ›å»ºSession  â”‚â”€â”€â”€â–¶â”‚  è¿”å›SessionID â”‚
â”‚  éªŒè¯æˆåŠŸ  â”‚    â”‚  å­˜å‚¨ç”¨æˆ·ä¿¡æ¯  â”‚    â”‚  (é€šè¿‡Cookie)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœåŠ¡å™¨æŸ¥æ‰¾â”‚â—€â”€â”€â”€â”‚  åç»­è¯·æ±‚     â”‚â—€â”€â”€â”€â”‚  æµè§ˆå™¨å‘é€   â”‚
â”‚  Session   â”‚    â”‚  æºå¸¦SessionIDâ”‚    â”‚  SessionID   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ç™»å½•çŠ¶æ€ä¿æŒå®ç°


**ä¼šè¯ç®¡ç†å·¥å…·ç±» - SessionManager.java**ï¼š
```java
public class SessionManager {
    
    // åˆ›å»ºç”¨æˆ·ä¼šè¯
    public static void createUserSession(HttpServletRequest request, User user) {
        HttpSession session = request.getSession();
        
        // ä¿å­˜ç”¨æˆ·ä¿¡æ¯åˆ°ä¼šè¯
        session.setAttribute("currentUser", user);
        session.setAttribute("username", user.getUsername());
        session.setAttribute("userId", user.getId());
        session.setAttribute("loginTime", new Date());
        
        // è®¾ç½®ä¼šè¯è¶…æ—¶æ—¶é—´ï¼ˆ30åˆ†é’Ÿï¼‰
        session.setMaxInactiveInterval(30 * 60);
    }
    
    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
    public static boolean isUserLoggedIn(HttpServletRequest request) {
        HttpSession session = request.getSession(false);
        
        if(session == null) {
            return false;
        }
        
        User currentUser = (User) session.getAttribute("currentUser");
        return currentUser != null;
    }
    
    // è·å–å½“å‰ç™»å½•ç”¨æˆ·
    public static User getCurrentUser(HttpServletRequest request) {
        HttpSession session = request.getSession(false);
        
        if(session != null) {
            return (User) session.getAttribute("currentUser");
        }
        
        return null;
    }
    
    // ç”¨æˆ·ç™»å‡ºï¼Œæ¸…é™¤ä¼šè¯
    public static void logout(HttpServletRequest request) {
        HttpSession session = request.getSession(false);
        
        if(session != null) {
            session.invalidate(); // é”€æ¯ä¼šè¯
        }
    }
}
```

### 5.3 ä¼šè¯çŠ¶æ€æ£€æŸ¥è¿‡æ»¤å™¨


**LoginCheckFilter.java - ç™»å½•çŠ¶æ€è¿‡æ»¤å™¨**ï¼š
```java
@WebFilter("/protected/*") // ä¿æŠ¤/protected/ç›®å½•ä¸‹çš„æ‰€æœ‰é¡µé¢
public class LoginCheckFilter implements Filter {
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                        FilterChain chain) throws IOException, ServletException {
        
        HttpServletRequest httpRequest = (HttpServletRequest) request;
        HttpServletResponse httpResponse = (HttpServletResponse) response;
        
        // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
        if(!SessionManager.isUserLoggedIn(httpRequest)) {
            // æœªç™»å½•ï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢
            httpResponse.sendRedirect(httpRequest.getContextPath() + "/login.jsp");
            return;
        }
        
        // å·²ç™»å½•ï¼Œå…è®¸è®¿é—®
        chain.doFilter(request, response);
    }
}
```

**ä½¿ç”¨è¿‡æ»¤å™¨çš„å¥½å¤„**ï¼š
- ğŸ”¸ **ç»Ÿä¸€ç®¡ç†**ï¼šä¸€ä¸ªåœ°æ–¹æ§åˆ¶æ‰€æœ‰éœ€è¦ç™»å½•çš„é¡µé¢
- ğŸ”¸ **è‡ªåŠ¨æ‹¦æˆª**ï¼šä¸éœ€è¦åœ¨æ¯ä¸ªé¡µé¢éƒ½å†™æ£€æŸ¥ä»£ç 
- ğŸ”¸ **é…ç½®çµæ´»**ï¼šé€šè¿‡æ³¨è§£æˆ–web.xmlé…ç½®æ‹¦æˆªè·¯å¾„

### 5.4 æ¬¢è¿é¡µé¢å®ç°


**welcome.jsp - ç™»å½•æˆåŠŸé¡µé¢**ï¼š
```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ page import="java.text.SimpleDateFormat" %>
<%
    // æ£€æŸ¥ç™»å½•çŠ¶æ€
    User currentUser = (User) session.getAttribute("currentUser");
    if(currentUser == null) {
        response.sendRedirect("login.jsp");
        return;
    }
    
    Date loginTime = (Date) session.getAttribute("loginTime");
    SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
%>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ç”¨æˆ·ä¸­å¿ƒ</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <div class="user-header">
            <h2>ğŸ‰ æ¬¢è¿ï¼Œ<%= currentUser.getUsername() %>ï¼</h2>
            <div class="user-info">
                <p>ğŸ“§ é‚®ç®±ï¼š<%= currentUser.getEmail() != null ? currentUser.getEmail() : "æœªè®¾ç½®" %></p>
                <p>â° ç™»å½•æ—¶é—´ï¼š<%= sdf.format(loginTime) %></p>
                <p>ğŸ• ä¼šè¯IDï¼š<%= session.getId().substring(0, 8) %>...</p>
            </div>
        </div>
        
        <div class="actions">
            <a href="profile.jsp" class="btn">ä¸ªäººèµ„æ–™</a>
            <a href="changePassword.jsp" class="btn">ä¿®æ”¹å¯†ç </a>
            <a href="LogoutServlet" class="btn logout-btn">å®‰å…¨é€€å‡º</a>
        </div>
        
        <div class="session-info">
            <h3>ä¼šè¯çŠ¶æ€ä¿¡æ¯</h3>
            <ul>
                <li>ä¼šè¯åˆ›å»ºæ—¶é—´ï¼š<%= sdf.format(new Date(session.getCreationTime())) %></li>
                <li>æœ€åè®¿é—®æ—¶é—´ï¼š<%= sdf.format(new Date(session.getLastAccessedTime())) %></li>
                <li>ä¼šè¯è¶…æ—¶æ—¶é—´ï¼š<%= session.getMaxInactiveInterval() / 60 %> åˆ†é’Ÿ</li>
            </ul>
        </div>
    </div>
</body>
</html>
```

---

## 6. ğŸ” æƒé™æ§åˆ¶åŸºç¡€


### 6.1 ç”¨æˆ·è§’è‰²è®¾è®¡


**ç®€å•çš„è§’è‰²æƒé™æ¨¡å‹**ï¼š
```
ç”¨æˆ·è§’è‰²åˆ†ç±»ï¼š
â”œâ”€â”€ æ™®é€šç”¨æˆ· (USER)
â”‚   â”œâ”€â”€ æŸ¥çœ‹ä¸ªäººä¿¡æ¯
â”‚   â”œâ”€â”€ ä¿®æ”¹ä¸ªäººèµ„æ–™
â”‚   â””â”€â”€ ä¿®æ”¹å¯†ç 
â”‚
â”œâ”€â”€ ç®¡ç†å‘˜ (ADMIN)
â”‚   â”œâ”€â”€ æ™®é€šç”¨æˆ·çš„æ‰€æœ‰æƒé™
â”‚   â”œâ”€â”€ æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨
â”‚   â”œâ”€â”€ åˆ é™¤ç”¨æˆ·
â”‚   â””â”€â”€ ç³»ç»Ÿè®¾ç½®
â”‚
â””â”€â”€ è¶…çº§ç®¡ç†å‘˜ (SUPER_ADMIN)
    â”œâ”€â”€ ç®¡ç†å‘˜çš„æ‰€æœ‰æƒé™
    â”œâ”€â”€ ç”¨æˆ·è§’è‰²ç®¡ç†
    â””â”€â”€ ç³»ç»Ÿç»´æŠ¤
```

**æ•°æ®åº“è¡¨ç»“æ„æ‰©å±•**ï¼š
```sql
-- ç”¨æˆ·è¡¨æ·»åŠ è§’è‰²å­—æ®µ
ALTER TABLE users ADD COLUMN role VARCHAR(20) DEFAULT 'USER';

-- è§’è‰²æƒé™è¡¨ï¼ˆå¯é€‰ï¼Œç”¨äºå¤æ‚æƒé™æ§åˆ¶ï¼‰
CREATE TABLE roles (
    id INT PRIMARY KEY AUTO_INCREMENT,
    role_name VARCHAR(50) NOT NULL,
    description VARCHAR(200)
);

CREATE TABLE permissions (
    id INT PRIMARY KEY AUTO_INCREMENT,
    permission_name VARCHAR(50) NOT NULL,
    resource VARCHAR(100),        -- èµ„æºè·¯å¾„
    action VARCHAR(20)            -- æ“ä½œç±»å‹ï¼šREAD, WRITE, DELETE
);
```

### 6.2 æƒé™æ£€æŸ¥å®ç°


**PermissionManager.java - æƒé™ç®¡ç†å·¥å…·**ï¼š
```java
public class PermissionManager {
    
    // ç”¨æˆ·è§’è‰²æšä¸¾
    public enum UserRole {
        USER("æ™®é€šç”¨æˆ·"),
        ADMIN("ç®¡ç†å‘˜"), 
        SUPER_ADMIN("è¶…çº§ç®¡ç†å‘˜");
        
        private String description;
        
        UserRole(String description) {
            this.description = description;
        }
        
        public String getDescription() {
            return description;
        }
    }
    
    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰è®¿é—®æƒé™
    public static boolean hasPermission(User user, String resource) {
        if(user == null) {
            return false;
        }
        
        UserRole userRole = UserRole.valueOf(user.getRole());
        
        switch(userRole) {
            case SUPER_ADMIN:
                return true; // è¶…çº§ç®¡ç†å‘˜å¯ä»¥è®¿é—®æ‰€æœ‰èµ„æº
                
            case ADMIN:
                // ç®¡ç†å‘˜å¯ä»¥è®¿é—®é™¤è¶…çº§ç®¡ç†å‘˜ä¸“ç”¨é¡µé¢å¤–çš„æ‰€æœ‰é¡µé¢
                return !resource.startsWith("/superadmin/");
                
            case USER:
            default:
                // æ™®é€šç”¨æˆ·åªèƒ½è®¿é—®ç”¨æˆ·ç›¸å…³é¡µé¢
                return resource.startsWith("/user/") || 
                       resource.equals("/welcome.jsp") ||
                       resource.equals("/profile.jsp");
        }
    }
    
    // æ£€æŸ¥æ˜¯å¦æ˜¯ç®¡ç†å‘˜
    public static boolean isAdmin(User user) {
        if(user == null) return false;
        
        UserRole role = UserRole.valueOf(user.getRole());
        return role == UserRole.ADMIN || role == UserRole.SUPER_ADMIN;
    }
}
```

### 6.3 æƒé™è¿‡æ»¤å™¨å®ç°


**AuthorizationFilter.java - æƒé™æ§åˆ¶è¿‡æ»¤å™¨**ï¼š
```java
@WebFilter("/*")
public class AuthorizationFilter implements Filter {
    
    // ä¸éœ€è¦æƒé™æ£€æŸ¥çš„é¡µé¢
    private static final List<String> PUBLIC_PAGES = Arrays.asList(
        "/login.jsp", "/register.jsp", "/index.jsp", 
        "/LoginServlet", "/RegisterServlet", "/css/", "/js/"
    );
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                        FilterChain chain) throws IOException, ServletException {
        
        HttpServletRequest httpRequest = (HttpServletRequest) request;
        HttpServletResponse httpResponse = (HttpServletResponse) response;
        
        String requestURI = httpRequest.getRequestURI();
        String contextPath = httpRequest.getContextPath();
        String path = requestURI.substring(contextPath.length());
        
        // æ£€æŸ¥æ˜¯å¦æ˜¯å…¬å¼€é¡µé¢
        if(isPublicPage(path)) {
            chain.doFilter(request, response);
            return;
        }
        
        // è·å–å½“å‰ç”¨æˆ·
        User currentUser = SessionManager.getCurrentUser(httpRequest);
        
        // æ£€æŸ¥ç™»å½•çŠ¶æ€
        if(currentUser == null) {
            httpResponse.sendRedirect(contextPath + "/login.jsp");
            return;
        }
        
        // æ£€æŸ¥è®¿é—®æƒé™
        if(!PermissionManager.hasPermission(currentUser, path)) {
            httpResponse.sendError(HttpServletResponse.SC_FORBIDDEN, "æ²¡æœ‰è®¿é—®æƒé™");
            return;
        }
        
        // æœ‰æƒé™ï¼Œç»§ç»­å¤„ç†
        chain.doFilter(request, response);
    }
    
    private boolean isPublicPage(String path) {
        return PUBLIC_PAGES.stream().anyMatch(path::startsWith);
    }
}
```

### 6.4 åŸºäºè§’è‰²çš„é¡µé¢æ˜¾ç¤º


**åœ¨JSPä¸­æ ¹æ®è§’è‰²æ˜¾ç¤ºä¸åŒå†…å®¹**ï¼š
```jsp
<%
    User currentUser = (User) session.getAttribute("currentUser");
    boolean isAdmin = PermissionManager.isAdmin(currentUser);
%>

<div class="user-menu">
    <h3>åŠŸèƒ½èœå•</h3>
    <ul>
        <li><a href="profile.jsp">ğŸ“ ä¸ªäººèµ„æ–™</a></li>
        <li><a href="changePassword.jsp">ğŸ”‘ ä¿®æ”¹å¯†ç </a></li>
        
        <% if(isAdmin) { %>
            <li class="admin-only">
                <a href="admin/userList.jsp">ğŸ‘¥ ç”¨æˆ·ç®¡ç†</a>
            </li>
            <li class="admin-only">
                <a href="admin/systemSettings.jsp">âš™ï¸ ç³»ç»Ÿè®¾ç½®</a>
            </li>
        <% } %>
        
        <% if("SUPER_ADMIN".equals(currentUser.getRole())) { %>
            <li class="superadmin-only">
                <a href="superadmin/roleManage.jsp">ğŸ­ è§’è‰²ç®¡ç†</a>
            </li>
        <% } %>
    </ul>
</div>
```

**æƒé™æ§åˆ¶å±‚çº§å›¾**ï¼š
```
é¡µé¢è®¿é—®æƒé™æ§åˆ¶ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    å…¬å¼€é¡µé¢      â”‚  â† æ‰€æœ‰äººå¯è®¿é—®
â”‚  login.jsp      â”‚
â”‚  register.jsp   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·é¡µé¢       â”‚  â† ç™»å½•ç”¨æˆ·å¯è®¿é—®  
â”‚  welcome.jsp    â”‚
â”‚  profile.jsp    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç®¡ç†å‘˜é¡µé¢     â”‚  â† ç®¡ç†å‘˜åŠä»¥ä¸Šå¯è®¿é—®
â”‚  userList.jsp   â”‚
â”‚  settings.jsp   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¶…ç®¡ä¸“ç”¨é¡µé¢    â”‚  â† ä»…è¶…çº§ç®¡ç†å‘˜å¯è®¿é—®
â”‚  roleManage.jsp â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. ğŸš€ å®Œæ•´é¡¹ç›®æ¼”ç¤º


### 7.1 é¡¹ç›®ç›®å½•ç»“æ„


```
WebLoginSystem/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ com/example/servlet/
â”‚   â”‚   â”œâ”€â”€ LoginServlet.java
â”‚   â”‚   â”œâ”€â”€ RegisterServlet.java
â”‚   â”‚   â””â”€â”€ LogoutServlet.java
â”‚   â”œâ”€â”€ com/example/dao/
â”‚   â”‚   â”œâ”€â”€ UserDAO.java
â”‚   â”‚   â””â”€â”€ DBUtil.java
â”‚   â”œâ”€â”€ com/example/model/
â”‚   â”‚   â””â”€â”€ User.java
â”‚   â”œâ”€â”€ com/example/util/
â”‚   â”‚   â”œâ”€â”€ SessionManager.java
â”‚   â”‚   â”œâ”€â”€ PermissionManager.java
â”‚   â”‚   â””â”€â”€ InputValidator.java
â”‚   â””â”€â”€ com/example/filter/
â”‚       â”œâ”€â”€ LoginCheckFilter.java
â”‚       â””â”€â”€ AuthorizationFilter.java
â”‚
â”œâ”€â”€ WebContent/
â”‚   â”œâ”€â”€ WEB-INF/
â”‚   â”‚   â”œâ”€â”€ web.xml
â”‚   â”‚   â””â”€â”€ lib/
â”‚   â”‚       â””â”€â”€ mysql-connector-java-8.0.33.jar
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â””â”€â”€ validation.js
â”‚   â”œâ”€â”€ index.jsp
â”‚   â”œâ”€â”€ login.jsp
â”‚   â”œâ”€â”€ register.jsp
â”‚   â”œâ”€â”€ welcome.jsp
â”‚   â””â”€â”€ protected/
â”‚       â”œâ”€â”€ profile.jsp
â”‚       â””â”€â”€ admin/
â”‚           â””â”€â”€ userList.jsp
```

### 7.2 æ ¸å¿ƒé…ç½®æ–‡ä»¶


**web.xml - é¡¹ç›®é…ç½®**ï¼š
```xml
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="4.0">
    <display-name>ç”¨æˆ·ç™»å½•æ³¨å†Œç³»ç»Ÿ</display-name>
    
    <!-- æ¬¢è¿é¡µé¢è®¾ç½® -->
    <welcome-file-list>
        <welcome-file>index.jsp</welcome-file>
    </welcome-file-list>
    
    <!-- ä¼šè¯è¶…æ—¶è®¾ç½®ï¼ˆ30åˆ†é’Ÿï¼‰ -->
    <session-config>
        <session-timeout>30</session-timeout>
    </session-config>
    
    <!-- é”™è¯¯é¡µé¢é…ç½® -->
    <error-page>
        <error-code>404</error-code>
        <location>/error/404.jsp</location>
    </error-page>
    
    <error-page>
        <error-code>403</error-code>
        <location>/error/403.jsp</location>
    </error-page>
</web-app>
```

### 7.3 æ•°æ®åº“è¿æ¥å·¥å…·


**DBUtil.java - æ•°æ®åº“è¿æ¥ç®¡ç†**ï¼š
```java
public class DBUtil {
    private static final String URL = "jdbc:mysql://localhost:3306/logindb?useSSL=false&serverTimezone=UTC";
    private static final String USERNAME = "root";
    private static final String PASSWORD = "123456";
    
    static {
        try {
            Class.forName("com.mysql.cj.jdbc.Driver");
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        }
    }
    
    public static Connection getConnection() throws SQLException {
        return DriverManager.getConnection(URL, USERNAME, PASSWORD);
    }
    
    // æµ‹è¯•æ•°æ®åº“è¿æ¥
    public static boolean testConnection() {
        try (Connection conn = getConnection()) {
            return conn != null && !conn.isClosed();
        } catch (SQLException e) {
            e.printStackTrace();
            return false;
        }
    }
}
```

### 7.4 ç”¨æˆ·å®ä½“ç±»


**User.java - ç”¨æˆ·æ•°æ®æ¨¡å‹**ï¼š
```java
public class User {
    private int id;
    private String username;
    private String password;
    private String email;
    private String role = "USER"; // é»˜è®¤æ™®é€šç”¨æˆ·
    private Timestamp registerTime;
    
    // æ„é€ æ–¹æ³•
    public User() {}
    
    public User(String username, String password, String email) {
        this.username = username;
        this.password = password;
        this.email = email;
    }
    
    // Getterå’ŒSetteræ–¹æ³•ï¼ˆçœç•¥å…·ä½“å®ç°ï¼‰
    // ...
    
    @Override
    public String toString() {
        return String.format("User{id=%d, username='%s', email='%s', role='%s'}", 
                           id, username, email, role);
    }
}
```

### 7.5 ç™»å‡ºåŠŸèƒ½å®ç°


**LogoutServlet.java - ç™»å‡ºå¤„ç†**ï¼š
```java
@WebServlet("/LogoutServlet")
public class LogoutServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        // é”€æ¯ä¼šè¯
        SessionManager.logout(request);
        
        // æ¸…é™¤"è®°ä½æˆ‘"Cookie
        Cookie userCookie = new Cookie("username", "");
        userCookie.setMaxAge(0);
        userCookie.setPath("/");
        response.addCookie(userCookie);
        
        // è·³è½¬åˆ°ç™»å½•é¡µé¢
        response.sendRedirect("login.jsp?msg=æ‚¨å·²å®‰å…¨é€€å‡º");
    }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ç”¨æˆ·æ³¨å†Œï¼šè¡¨å•æ•°æ®æ”¶é›†ã€éªŒè¯ã€æ•°æ®åº“ä¿å­˜
ğŸ”¸ ç”¨æˆ·ç™»å½•ï¼šèº«ä»½éªŒè¯ã€ä¼šè¯åˆ›å»ºã€çŠ¶æ€ä¿æŒ
ğŸ”¸ æ•°æ®æ ¡éªŒï¼šå‰ç«¯ä½“éªŒä¼˜åŒ– + åç«¯å®‰å…¨ä¿éšœ
ğŸ”¸ ä¼šè¯ç®¡ç†ï¼šHttpSessionæœºåˆ¶ã€ç™»å½•çŠ¶æ€ç»´æŠ¤
ğŸ”¸ æƒé™æ§åˆ¶ï¼šè§’è‰²åŒºåˆ†ã€èµ„æºè®¿é—®æ§åˆ¶
ğŸ”¸ è¿‡æ»¤å™¨åº”ç”¨ï¼šç»Ÿä¸€çš„æƒé™æ£€æŸ¥å’ŒçŠ¶æ€ç®¡ç†
```

### 8.2 å…³é”®æŠ€æœ¯ç†è§£è¦ç‚¹


**ğŸ”¹ MVCæ¶æ„åœ¨ç™»å½•ç³»ç»Ÿä¸­çš„ä½“ç°**
```
Modelï¼ˆæ¨¡å‹å±‚ï¼‰ï¼š
â””â”€â”€ User.java, UserDAO.java - æ•°æ®æ¨¡å‹å’Œæ•°æ®è®¿é—®

Viewï¼ˆè§†å›¾å±‚ï¼‰ï¼š  
â””â”€â”€ login.jsp, register.jsp - ç”¨æˆ·ç•Œé¢å±•ç¤º

Controllerï¼ˆæ§åˆ¶å±‚ï¼‰ï¼š
â””â”€â”€ LoginServlet, RegisterServlet - ä¸šåŠ¡é€»è¾‘å¤„ç†

ä¼˜åŠ¿ï¼šèŒè´£åˆ†ç¦»ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•
```

**ğŸ”¹ ä¼šè¯ç®¡ç†çš„æ ¸å¿ƒæœºåˆ¶**
```
ä¼šè¯ç”Ÿå‘½å‘¨æœŸï¼š
åˆ›å»º â†’ ä½¿ç”¨ â†’ è¶…æ—¶/é”€æ¯

å…³é”®æ“ä½œï¼š
- session.setAttribute() - ä¿å­˜æ•°æ®
- session.getAttribute() - è·å–æ•°æ®  
- session.invalidate() - é”€æ¯ä¼šè¯
- session.setMaxInactiveInterval() - è®¾ç½®è¶…æ—¶

å®‰å…¨è€ƒè™‘ï¼š
- ä¼šè¯IDçš„éšæœºæ€§å’Œå®‰å…¨æ€§
- ä¼šè¯è¶…æ—¶æ—¶é—´çš„åˆç†è®¾ç½®
- æ•æ„Ÿæ“ä½œçš„ä¼šè¯éªŒè¯
```

**ğŸ”¹ å®‰å…¨æ€§è®¾è®¡åŸåˆ™**
```
è¾“å…¥éªŒè¯ï¼š
- å‰ç«¯æ ¡éªŒï¼šç”¨æˆ·ä½“éªŒ
- åç«¯æ ¡éªŒï¼šå®‰å…¨ä¿éšœ
- æ°¸è¿œä¸ä¿¡ä»»å®¢æˆ·ç«¯è¾“å…¥

æƒé™æ§åˆ¶ï¼š
- æœ€å°æƒé™åŸåˆ™
- é»˜è®¤æ‹’ç»ç­–ç•¥
- åˆ†å±‚æƒé™éªŒè¯

å¯†ç å®‰å…¨ï¼š
- å¯†ç å¼ºåº¦è¦æ±‚
- å­˜å‚¨æ—¶åŠ å¯†å¤„ç†ï¼ˆMD5/SHA/BCryptï¼‰
- ä¼ è¾“æ—¶HTTPSä¿æŠ¤
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ é¡¹ç›®æ‰©å±•æ–¹å‘**
- **é‚®ç®±éªŒè¯**ï¼šæ³¨å†Œæ—¶å‘é€éªŒè¯é‚®ä»¶
- **æ‰¾å›å¯†ç **ï¼šé€šè¿‡é‚®ç®±æˆ–æ‰‹æœºé‡ç½®å¯†ç 
- **è®°ä½ç™»å½•**ï¼šCookieå®ç°7å¤©å…ç™»å½•
- **éªŒè¯ç **ï¼šé˜²æ­¢æš´åŠ›ç ´è§£å’Œæœºå™¨æ³¨å†Œ
- **OAuthé›†æˆ**ï¼šå¾®ä¿¡ã€QQç­‰ç¬¬ä¸‰æ–¹ç™»å½•

**ğŸ”§ æ€§èƒ½ä¼˜åŒ–å»ºè®®**
- **æ•°æ®åº“è¿æ¥æ± **ï¼šé¿å…é¢‘ç¹åˆ›å»ºæ•°æ®åº“è¿æ¥
- **ç¼“å­˜æœºåˆ¶**ï¼šRedisç¼“å­˜ç”¨æˆ·ä¼šè¯ä¿¡æ¯
- **åˆ†é¡µæŸ¥è¯¢**ï¼šç”¨æˆ·åˆ—è¡¨åˆ†é¡µæ˜¾ç¤º
- **å¼‚æ­¥å¤„ç†**ï¼šé‚®ä»¶å‘é€ç­‰è€—æ—¶æ“ä½œå¼‚æ­¥åŒ–

**ğŸš€ éƒ¨ç½²è¿ç»´è¦ç‚¹**
- **ç¯å¢ƒé…ç½®**ï¼šå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒåˆ†ç¦»
- **æ—¥å¿—è®°å½•**ï¼šç™»å½•è¡Œä¸ºã€å¼‚å¸¸æ“ä½œè®°å½•
- **ç›‘æ§å‘Šè­¦**ï¼šå¼‚å¸¸ç™»å½•ã€ç³»ç»Ÿé”™è¯¯ç›‘æ§
- **å¤‡ä»½ç­–ç•¥**ï¼šæ•°æ®åº“å®šæœŸå¤‡ä»½

### 8.4 å¸¸è§é—®é¢˜è§£å†³


**ğŸ”¸ ä¸­æ–‡ä¹±ç é—®é¢˜**
```java
// è¯·æ±‚å’Œå“åº”ç¼–ç è®¾ç½®
request.setCharacterEncoding("UTF-8");
response.setContentType("text/html;charset=UTF-8");
```

**ğŸ”¸ ä¼šè¯ä¸¢å¤±é—®é¢˜**
```java
// æ£€æŸ¥ä¼šè¯æ˜¯å¦å­˜åœ¨
HttpSession session = request.getSession(false);
if(session == null || session.getAttribute("currentUser") == null) {
    // é‡æ–°ç™»å½•
}
```

**ğŸ”¸ å¯†ç å®‰å…¨å­˜å‚¨**
```java
// ä½¿ç”¨BCryptåŠ å¯†å¯†ç 
String hashedPassword = BCrypt.hashpw(password, BCrypt.gensalt());
boolean isValid = BCrypt.checkpw(inputPassword, hashedPassword);
```

### 8.5 å­¦ä¹ è¿›é˜¶è·¯çº¿


```
åŸºç¡€æŒæ¡ï¼š
âœ… JSPåŸºæœ¬è¯­æ³•å’ŒæŒ‡ä»¤
âœ… Servletç”Ÿå‘½å‘¨æœŸå’Œæ˜ å°„
âœ… HTTPè¯·æ±‚å“åº”æœºåˆ¶
âœ… æ•°æ®åº“åŸºæœ¬æ“ä½œ

è¿›é˜¶å­¦ä¹ ï¼š
ğŸ”¹ Filterå’ŒListeneråº”ç”¨
ğŸ”¹ AJAXå¼‚æ­¥è¯·æ±‚å¤„ç†
ğŸ”¹ æ–‡ä»¶ä¸Šä¼ ä¸‹è½½
ğŸ”¹ RESTful APIè®¾è®¡

é«˜çº§åº”ç”¨ï¼š
ğŸš€ Spring Frameworkæ•´åˆ
ğŸš€ å¾®æœåŠ¡æ¶æ„è®¾è®¡
ğŸš€ åˆ†å¸ƒå¼ä¼šè¯ç®¡ç†
ğŸš€ OAuth2.0è®¤è¯æˆæƒ
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- ç”¨æˆ·æ³¨å†Œå…ˆæ ¡éªŒï¼Œæ•°æ®åº“å­˜å‚¨è¦å®‰å…¨
- ç™»å½•éªŒè¯åˆ›ä¼šè¯ï¼ŒçŠ¶æ€ä¿æŒé Session  
- å‰åæ ¡éªŒåŒä¿é™©ï¼Œæƒé™æ§åˆ¶åˆ†è§’è‰²
- MVCåˆ†å±‚èŒè´£æ˜ï¼Œè¿‡æ»¤å™¨ç»Ÿä¸€ç®¡æ§åˆ¶