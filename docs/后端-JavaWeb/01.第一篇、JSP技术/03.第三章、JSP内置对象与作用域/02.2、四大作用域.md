---
title: 2ã€å››å¤§ä½œç”¨åŸŸ
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸ](#1-ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸ)
2. [Pageä½œç”¨åŸŸè¯¦è§£](#2-pageä½œç”¨åŸŸè¯¦è§£)
3. [Requestä½œç”¨åŸŸè¯¦è§£](#3-requestä½œç”¨åŸŸè¯¦è§£)  
4. [Sessionä½œç”¨åŸŸè¯¦è§£](#4-sessionä½œç”¨åŸŸè¯¦è§£)
5. [Applicationä½œç”¨åŸŸè¯¦è§£](#5-applicationä½œç”¨åŸŸè¯¦è§£)
6. [ä½œç”¨åŸŸå¯¹æ¯”ä¸é€‰æ‹©](#6-ä½œç”¨åŸŸå¯¹æ¯”ä¸é€‰æ‹©)
7. [å®é™…åº”ç”¨åœºæ™¯](#7-å®é™…åº”ç”¨åœºæ™¯)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸ


### 1.1 ä½œç”¨åŸŸçš„æœ¬è´¨ç†è§£


**ç®€å•æ¥è¯´**ï¼Œä½œç”¨åŸŸå°±æ˜¯**æ•°æ®å­˜æ´»çš„èŒƒå›´**ï¼Œå°±åƒä¸åŒå¤§å°çš„æˆ¿é—´ï¼š
- æœ‰äº›æ•°æ®åªèƒ½åœ¨**å°æˆ¿é—´**ï¼ˆå½“å‰é¡µé¢ï¼‰é‡Œç”¨
- æœ‰äº›æ•°æ®èƒ½åœ¨**æ•´å¥—æˆ¿å­**ï¼ˆç”¨æˆ·ä¼šè¯ï¼‰é‡Œå…±äº«  
- æœ‰äº›æ•°æ®åœ¨**æ•´ä¸ªå°åŒº**ï¼ˆåº”ç”¨ç¨‹åºï¼‰éƒ½èƒ½è®¿é—®

> ğŸ’¡ **ç”Ÿæ´»æ¯”å–»**ï¼šæƒ³è±¡ä½ æœ‰ä¸åŒçš„å‚¨ç‰©ç©ºé—´
> - **æ¡Œå­æŠ½å±‰**ï¼šåªæœ‰ååœ¨è¿™å¼ æ¡Œå­å‰æ‰èƒ½ç”¨ï¼ˆpageä½œç”¨åŸŸï¼‰
> - **éšèº«èƒŒåŒ…**ï¼šèµ°åˆ°å“ªå¸¦åˆ°å“ªï¼ˆrequestä½œç”¨åŸŸï¼‰
> - **ä¸ªäººæˆ¿é—´**ï¼šä½ åœ¨å®¶é‡Œéƒ½èƒ½ç”¨ï¼ˆsessionä½œç”¨åŸŸï¼‰
> - **å…¬å…±ä»“åº“**ï¼šæ‰€æœ‰äººéƒ½èƒ½ç”¨ï¼ˆapplicationä½œç”¨åŸŸï¼‰

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦ä¸åŒä½œç”¨åŸŸ


```
ç”¨æˆ·è®¿é—®ç½‘ç«™çš„è¿‡ç¨‹ï¼š

æµè§ˆå™¨ â”€â”€[è¯·æ±‚]â”€â”€â†’ æœåŠ¡å™¨ â”€â”€[å¤„ç†]â”€â”€â†’ æ•°æ®åº“
       â†â”€â”€[å“åº”]â”€â”€        â†â”€â”€[æ•°æ®]â”€â”€

é—®é¢˜ï¼šæ•°æ®è¦åœ¨ä»€ä¹ˆæ—¶å€™ã€ä»€ä¹ˆåœ°æ–¹èƒ½è¢«è®¿é—®ï¼Ÿ
```

**å®é™…éœ€æ±‚åœºæ™¯**ï¼š
- ğŸ“ **ä¸´æ—¶è®¡ç®—ç»“æœ** â†’ åªåœ¨å½“å‰é¡µé¢ç”¨ï¼ˆpageï¼‰
- ğŸ”„ **è¡¨å•æäº¤æ•°æ®** â†’ ä»æäº¤åˆ°å¤„ç†å®Œæˆï¼ˆrequestï¼‰  
- ğŸ‘¤ **ç”¨æˆ·ç™»å½•ä¿¡æ¯** â†’ æ•´ä¸ªä¼šè¯æœŸé—´ï¼ˆsessionï¼‰
- ğŸŒ **ç³»ç»Ÿé…ç½®ä¿¡æ¯** â†’ æ•´ä¸ªåº”ç”¨ç¨‹åºï¼ˆapplicationï¼‰

### 1.3 JSPå››å¤§ä½œç”¨åŸŸæ¦‚è§ˆ


| ä½œç”¨åŸŸ | å¯¹è±¡ç±»å‹ | **ç”Ÿå­˜æ—¶é—´** | **ä½¿ç”¨åœºæ™¯** |
|--------|----------|-------------|-------------|
| ğŸ”¹ **page** | `PageContext` | `å½“å‰é¡µé¢æ‰§è¡ŒæœŸé—´` | `ä¸´æ—¶æ•°æ®ã€è®¡ç®—ç»“æœ` |
| ğŸ”¸ **request** | `HttpServletRequest` | `ä¸€æ¬¡è¯·æ±‚-å“åº”å‘¨æœŸ` | `è¡¨å•æ•°æ®ã€é¡µé¢è·³è½¬ä¼ å€¼` |
| ğŸ”¶ **session** | `HttpSession` | `ç”¨æˆ·ä¼šè¯æœŸé—´` | `ç™»å½•ä¿¡æ¯ã€è´­ç‰©è½¦` |
| ğŸ”· **application** | `ServletContext` | `åº”ç”¨å¯åŠ¨åˆ°å…³é—­` | `é…ç½®ä¿¡æ¯ã€è®¡æ•°å™¨` |

---

## 2. ğŸ“„ Pageä½œç”¨åŸŸè¯¦è§£


### 2.1 Pageä½œç”¨åŸŸçš„ç‰¹ç‚¹


**Pageä½œç”¨åŸŸ**æ˜¯æœ€å°çš„ä½œç”¨åŸŸï¼Œå°±åƒ**ä¾¿ç­¾çº¸**ä¸Šçš„ä¿¡æ¯ï¼š

```
é¡µé¢æ‰§è¡Œæµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JSPé¡µé¢å¼€å§‹æ‰§è¡Œ  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  pageä½œç”¨åŸŸæ¿€æ´»   â”‚ â† æ•°æ®å¯ä»¥å­˜å–
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é¡µé¢å¤„ç†ä¸šåŠ¡é€»è¾‘  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  
â”‚  ç”ŸæˆHTMLå“åº”     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é¡µé¢æ‰§è¡Œå®Œæ¯•     â”‚ â† pageæ•°æ®é”€æ¯
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- â° **ç”Ÿå­˜æœŸ**ï¼šä»é¡µé¢å¼€å§‹æ‰§è¡Œåˆ°æ‰§è¡Œå®Œæ¯•
- ğŸ¯ **ä½¿ç”¨èŒƒå›´**ï¼šä»…é™å½“å‰JSPé¡µé¢
- ğŸ—‘ï¸ **é”€æ¯æ—¶æœº**ï¼šé¡µé¢å“åº”å‘é€å®Œæ¯•åç«‹å³é”€æ¯

### 2.2 PageContextå¯¹è±¡è¯¦è§£


**PageContext**æ˜¯pageä½œç”¨åŸŸçš„è½½ä½“ï¼Œå®ƒå°±åƒé¡µé¢çš„**ç®¡å®¶**ï¼š

```java
// å­˜å‚¨æ•°æ®åˆ°pageä½œç”¨åŸŸ
pageContext.setAttribute("userName", "å¼ ä¸‰");

// ä»pageä½œç”¨åŸŸè·å–æ•°æ®  
String name = (String) pageContext.getAttribute("userName");
```

**PageContextçš„ç‰¹æ®Šèƒ½åŠ›**ï¼š
- ğŸ›ï¸ **ä¸‡èƒ½é¥æ§å™¨**ï¼šå¯ä»¥è®¿é—®æ‰€æœ‰å…¶ä»–ä½œç”¨åŸŸ
- ğŸ”„ **ä¾¿æ·æ–¹æ³•**ï¼šæä¾›ç®€åŒ–çš„å­˜å–æ“ä½œ
- ğŸ“Š **ä½œç”¨åŸŸç®¡ç†**ï¼šå¯ä»¥æŒ‡å®šå…·ä½“çš„ä½œç”¨åŸŸæ“ä½œ

```java
// PageContextè®¿é—®å…¶ä»–ä½œç”¨åŸŸ
pageContext.setAttribute("data", "å€¼", PageContext.REQUEST_SCOPE);
pageContext.setAttribute("data", "å€¼", PageContext.SESSION_SCOPE);
pageContext.setAttribute("data", "å€¼", PageContext.APPLICATION_SCOPE);
```

### 2.3 Pageä½œç”¨åŸŸå®é™…åº”ç”¨


**é€‚ç”¨åœºæ™¯**ï¼š
- âœ… **é¡µé¢å†…è®¡ç®—**ï¼šä¸´æ—¶å˜é‡ã€è®¡ç®—ç»“æœ
- âœ… **æ•°æ®æ ¼å¼åŒ–**ï¼šæ—¥æœŸæ ¼å¼ã€æ•°å­—å¤„ç†
- âœ… **å¾ªç¯å˜é‡**ï¼šforå¾ªç¯ä¸­çš„è®¡æ•°å™¨

```jsp
<%-- è®¡ç®—å•†å“æ€»ä»·ç¤ºä¾‹ --%>
<%
    double price = 99.9;
    int quantity = 3;
    // å­˜å‚¨åˆ°pageä½œç”¨åŸŸ
    pageContext.setAttribute("totalPrice", price * quantity);
%>

<p>å•†å“æ€»ä»·ï¼š<%=pageContext.getAttribute("totalPrice")%> å…ƒ</p>
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**ï¼š
> - Pageä½œç”¨åŸŸçš„æ•°æ®ä¸èƒ½è·¨é¡µé¢ä¼ é€’
> - é€‚åˆå­˜å‚¨é¡µé¢å†…éƒ¨çš„ä¸´æ—¶æ•°æ®
> - ä¸è¦å­˜å‚¨éœ€è¦ä¼ é€’çš„é‡è¦ä¿¡æ¯

---

## 3. ğŸ”„ Requestä½œç”¨åŸŸè¯¦è§£


### 3.1 Requestä½œç”¨åŸŸçš„å·¥ä½œåŸç†


**Requestä½œç”¨åŸŸ**å°±åƒ**å¿«é€’åŒ…è£¹**ï¼Œä»å‘é€åˆ°æ¥æ”¶çš„æ•´ä¸ªè¿‡ç¨‹ä¸­éƒ½å­˜åœ¨ï¼š

```
Requestä½œç”¨åŸŸç”Ÿå‘½å‘¨æœŸï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·ç‚¹å‡»é“¾æ¥/æäº¤è¡¨å•                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æµè§ˆå™¨  â”‚â”€â”€â”€â†’â”‚  æœåŠ¡å™¨   â”‚â”€â”€â”€â†’â”‚ JSPé¡µé¢ â”‚ â”‚ â† requestæ•°æ®å­˜æ´»
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å“åº”å‘é€ç»™æµè§ˆå™¨                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â† requestæ•°æ®é”€æ¯
```

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
- ğŸš€ **ä¸€æ¬¡å®Œæ•´è¯·æ±‚**ï¼šä»ç”¨æˆ·å‘èµ·åˆ°æœåŠ¡å™¨å“åº”å®Œæ¯•
- ğŸ“¦ **æ•°æ®ä¼ é€’**ï¼šå¯ä»¥åœ¨è½¬å‘è¿‡ç¨‹ä¸­æºå¸¦æ•°æ®
- ğŸ”— **è·¨é¡µé¢å…±äº«**ï¼šé€šè¿‡è½¬å‘åœ¨å¤šä¸ªé¡µé¢é—´å…±äº«

### 2 HttpServletRequestå¯¹è±¡è¯¦è§£


**HttpServletRequest**æ˜¯requestä½œç”¨åŸŸçš„æ ¸å¿ƒï¼ŒåŒ…å«äº†**è¯·æ±‚çš„æ‰€æœ‰ä¿¡æ¯**ï¼š

```java
// å­˜å‚¨æ•°æ®åˆ°requestä½œç”¨åŸŸ
request.setAttribute("userInfo", user);

// è·å–æ•°æ®
User user = (User) request.getAttribute("userInfo");

// è·å–è¯·æ±‚å‚æ•°ï¼ˆç”¨æˆ·æäº¤çš„è¡¨å•æ•°æ®ï¼‰
String username = request.getParameter("username");
```

**Requestå¯¹è±¡çš„ä¸°å¯ŒåŠŸèƒ½**ï¼š

```
Requestå¯¹è±¡åŒ…å«çš„ä¿¡æ¯ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   HTTPè¯·æ±‚å¤´ä¿¡æ¯    â”‚ â† User-Agentã€Acceptç­‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   è¯·æ±‚å‚æ•°æ•°æ®      â”‚ â† è¡¨å•æäº¤çš„æ•°æ®
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   è¯·æ±‚æ–¹æ³•          â”‚ â† GETã€POSTç­‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   è¯·æ±‚è·¯å¾„          â”‚ â† URLè·¯å¾„ä¿¡æ¯
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   è‡ªå®šä¹‰å±æ€§        â”‚ â† setAttributeè®¾ç½®çš„æ•°æ®
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 Requestä½œç”¨åŸŸå…¸å‹åº”ç”¨


**è¡¨å•å¤„ç†æµç¨‹**ï¼š
```
ç”¨æˆ·å¡«å†™è¡¨å• â†’ æäº¤åˆ°Servlet â†’ å¤„ç†æ•°æ® â†’ è½¬å‘åˆ°JSPæ˜¾ç¤ºç»“æœ

ç¬¬1æ­¥ï¼šè¡¨å•é¡µé¢ï¼ˆform.jspï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·åï¼š[______] â”‚
â”‚ å¯†ç ï¼š  [______] â”‚
â”‚     [æäº¤]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬2æ­¥ï¼šå¤„ç†Servlet
å¤„ç†ç™»å½•é€»è¾‘ â†’ å°†ç»“æœå­˜å…¥request â†’ è½¬å‘åˆ°ç»“æœé¡µé¢

ç¬¬3æ­¥ï¼šç»“æœé¡µé¢ï¼ˆresult.jspï¼‰
æ˜¾ç¤ºrequestä¸­çš„å¤„ç†ç»“æœ
```

```jsp
<%-- å¤„ç†ç™»å½•çš„JSPé¡µé¢ç¤ºä¾‹ --%>
<%
    // è·å–è¡¨å•æäº¤çš„æ•°æ®
    String username = request.getParameter("username");
    String password = request.getParameter("password");
    
    // å¤„ç†ç™»å½•é€»è¾‘
    if ("admin".equals(username) && "123456".equals(password)) {
        // ç™»å½•æˆåŠŸï¼Œå­˜å‚¨ä¿¡æ¯åˆ°requestä½œç”¨åŸŸ
        request.setAttribute("loginResult", "ç™»å½•æˆåŠŸ");
        request.setAttribute("welcomeMsg", "æ¬¢è¿æ‚¨ï¼Œ" + username);
    } else {
        request.setAttribute("loginResult", "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯");
    }
%>

<h2>ç™»å½•ç»“æœ</h2>
<p style="color: green;"><%=request.getAttribute("loginResult")%></p>
<p><%=request.getAttribute("welcomeMsg")%></p>
```

**é¡µé¢è·³è½¬ä¸­çš„æ•°æ®ä¼ é€’**ï¼š
```java
// åœ¨Servletä¸­å¤„ç†æ•°æ®å¹¶è½¬å‘
protected void doPost(HttpServletRequest request, HttpServletResponse response) {
    // å¤„ç†ä¸šåŠ¡é€»è¾‘
    List<Product> products = productService.getAllProducts();
    
    // å­˜å‚¨æ•°æ®åˆ°requestä½œç”¨åŸŸ
    request.setAttribute("productList", products);
    request.setAttribute("totalCount", products.size());
    
    // è½¬å‘åˆ°JSPé¡µé¢æ˜¾ç¤º
    request.getRequestDispatcher("/productList.jsp").forward(request, response);
}
```

> ğŸ”§ **å®è·µæç¤º**ï¼š
> - Requestä½œç”¨åŸŸæœ€é€‚åˆå¤„ç†è¡¨å•æäº¤
> - é€šè¿‡è½¬å‘ï¼ˆforwardï¼‰å¯ä»¥ä¿æŒrequestæ•°æ®
> - é‡å®šå‘ï¼ˆredirectï¼‰ä¼šä¸¢å¤±requestæ•°æ®

---

## 4. ğŸ‘¤ Sessionä½œç”¨åŸŸè¯¦è§£


### 4.1 Sessionä¼šè¯çš„æ¦‚å¿µ


**Session**å°±åƒä½ åœ¨**é“¶è¡Œçš„ä¼šè¯**ï¼š
- ä½ èµ°è¿›é“¶è¡Œï¼Œå·¥ä½œäººå‘˜è®¤è¯†ä½ ï¼ˆå»ºç«‹ä¼šè¯ï¼‰
- åœ¨é“¶è¡ŒåŠäº‹æœŸé—´ï¼Œä»–ä»¬è®°å¾—ä½ æ˜¯è°ï¼ˆä¼šè¯ä¿æŒï¼‰  
- ä½ ç¦»å¼€é“¶è¡Œï¼Œä¼šè¯ç»“æŸï¼ˆä¼šè¯é”€æ¯ï¼‰

```
Sessionç”Ÿå‘½å‘¨æœŸç¤ºæ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·é¦–æ¬¡è®¿é—®ç½‘ç«™                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ æµè§ˆå™¨  â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ æœåŠ¡å™¨ç«¯     â”‚  â”‚
â”‚  â”‚ Cookie  â”‚  ä¼šè¯ID   â”‚ Sessionå¯¹è±¡ â”‚  â”‚ â† Sessionæ•°æ®å­˜å‚¨
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç”¨æˆ·åœ¨å¤šä¸ªé¡µé¢é—´æµè§ˆ                    â”‚ â† Sessionæ•°æ®å…±äº«
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¼šè¯è¶…æ—¶/ç”¨æˆ·å…³é—­æµè§ˆå™¨                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â† Sessionæ•°æ®é”€æ¯
```

### 4.2 HttpSessionå¯¹è±¡è¯¦è§£


**HttpSession**æ˜¯sessionä½œç”¨åŸŸçš„è½½ä½“ï¼Œå­˜å‚¨**ç”¨æˆ·çº§åˆ«**çš„æ•°æ®ï¼š

```java
// è·å–sessionå¯¹è±¡ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
HttpSession session = request.getSession();

// å­˜å‚¨ç”¨æˆ·ä¿¡æ¯
session.setAttribute("currentUser", "å¼ ä¸‰");
session.setAttribute("loginTime", new Date());

// è·å–ç”¨æˆ·ä¿¡æ¯  
String user = (String) session.getAttribute("currentUser");
```

**Sessionçš„æ ¸å¿ƒæ–¹æ³•**ï¼š

| æ–¹æ³• | **ä½œç”¨** | **ç¤ºä¾‹** |
|------|---------|---------|
| `setAttribute(key, value)` | `å­˜å‚¨æ•°æ®` | `session.setAttribute("user", "å¼ ä¸‰")` |
| `getAttribute(key)` | `è·å–æ•°æ®` | `String user = (String) session.getAttribute("user")` |
| `removeAttribute(key)` | `åˆ é™¤æ•°æ®` | `session.removeAttribute("user")` |
| `invalidate()` | `é”€æ¯ä¼šè¯` | `session.invalidate()` |
| `getId()` | `è·å–ä¼šè¯ID` | `String id = session.getId()` |
| `setMaxInactiveInterval()` | `è®¾ç½®è¶…æ—¶` | `session.setMaxInactiveInterval(1800)` |

### 4.3 Sessionçš„å·¥ä½œæœºåˆ¶


**Session IDçš„ä¼ é€’æ–¹å¼**ï¼š

```
æ–¹å¼1ï¼šCookieä¼ é€’ï¼ˆæœ€å¸¸ç”¨ï¼‰
æµè§ˆå™¨ â†â”€[Set-Cookie: JSESSIONID=ABC123]â”€â”€ æœåŠ¡å™¨
æµè§ˆå™¨ â”€â”€[Cookie: JSESSIONID=ABC123]â”€â”€â”€â”€â†’ æœåŠ¡å™¨

æ–¹å¼2ï¼šURLé‡å†™ï¼ˆCookieè¢«ç¦ç”¨æ—¶ï¼‰
http://localhost:8080/app/page.jsp;jsessionid=ABC123
```

**Sessionå­˜å‚¨ç¤ºæ„å›¾**ï¼š
```
æœåŠ¡å™¨å†…å­˜ä¸­çš„Sessionå­˜å‚¨ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Sessionç®¡ç†å™¨                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SessionID: ABC123                   â”‚
â”‚ â”œâ”€â”€ currentUser: "å¼ ä¸‰"             â”‚
â”‚ â”œâ”€â”€ loginTime: "2024-01-01 10:00"   â”‚
â”‚ â””â”€â”€ shoppingCart: [å•†å“1, å•†å“2]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SessionID: DEF456                   â”‚  
â”‚ â”œâ”€â”€ currentUser: "æå››"             â”‚
â”‚ â””â”€â”€ lastVisit: "2024-01-01 09:30"   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 Sessionå®é™…åº”ç”¨åœºæ™¯


**ç”¨æˆ·ç™»å½•ç®¡ç†**ï¼š
```jsp
<%-- ç™»å½•å¤„ç†é¡µé¢ --%>
<%
    String username = request.getParameter("username");
    String password = request.getParameter("password");
    
    // éªŒè¯ç”¨æˆ·ç™»å½•
    if (userService.validateUser(username, password)) {
        // ç™»å½•æˆåŠŸï¼Œå­˜å‚¨åˆ°session
        session.setAttribute("loginUser", username);
        session.setAttribute("loginTime", new Date());
        session.setMaxInactiveInterval(30 * 60); // 30åˆ†é’Ÿè¶…æ—¶
        
        response.sendRedirect("welcome.jsp");
    } else {
        // ç™»å½•å¤±è´¥
        request.setAttribute("errorMsg", "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯");
        request.getRequestDispatcher("login.jsp").forward(request, response);
    }
%>
```

**è´­ç‰©è½¦åŠŸèƒ½**ï¼š
```jsp
<%-- æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦ --%>
<%
    String productId = request.getParameter("productId");
    
    // è·å–è´­ç‰©è½¦ï¼ˆå¦‚æœæ²¡æœ‰åˆ™åˆ›å»ºæ–°çš„ï¼‰
    List<String> cart = (List<String>) session.getAttribute("shoppingCart");
    if (cart == null) {
        cart = new ArrayList<String>();
        session.setAttribute("shoppingCart", cart);
    }
    
    // æ·»åŠ å•†å“
    cart.add(productId);
    
    // æ˜¾ç¤ºè´­ç‰©è½¦å•†å“æ•°é‡
    int cartSize = cart.size();
%>

<p>è´­ç‰©è½¦ä¸­æœ‰ <%=cartSize%> ä»¶å•†å“</p>
```

**ç”¨æˆ·æƒé™æ§åˆ¶**ï¼š
```jsp
<%-- æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½• --%>
<%
    String loginUser = (String) session.getAttribute("loginUser");
    if (loginUser == null) {
        // ç”¨æˆ·æœªç™»å½•ï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢
        response.sendRedirect("login.jsp");
        return;
    }
%>

<h2>æ¬¢è¿æ‚¨ï¼Œ<%=loginUser%>ï¼</h2>
<p>æ‚¨çš„ä¼šè¯IDï¼š<%=session.getId()%></p>

<a href="logout.jsp">é€€å‡ºç™»å½•</a>
```

> ğŸ’¡ **æœ€ä½³å®è·µ**ï¼š
> - æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ç”¨æˆ·IDã€æƒé™ï¼‰é€‚åˆå­˜å‚¨åœ¨Session
> - åˆç†è®¾ç½®Sessionè¶…æ—¶æ—¶é—´
> - ç”¨æˆ·é€€å‡ºæ—¶åŠæ—¶é”€æ¯Session
> - ä¸è¦åœ¨Sessionä¸­å­˜å‚¨è¿‡å¤šæ•°æ®

---

## 5. ğŸŒ Applicationä½œç”¨åŸŸè¯¦è§£


### 5.1 Applicationä½œç”¨åŸŸçš„ç‰¹ç‚¹


**Applicationä½œç”¨åŸŸ**å°±åƒ**å…¬å¸çš„å…¬å‘Šæ¿**ï¼š
- æ‰€æœ‰å‘˜å·¥ï¼ˆç”¨æˆ·ï¼‰éƒ½èƒ½çœ‹åˆ°
- ä¿¡æ¯ä¸€ç›´å­˜åœ¨ï¼Œç›´åˆ°å…¬å¸å…³é—­ï¼ˆåº”ç”¨åœæ­¢ï¼‰
- é€‚åˆå­˜å‚¨å…¨å±€å…±äº«çš„ä¿¡æ¯

```
Applicationä½œç”¨åŸŸç”Ÿå‘½å‘¨æœŸï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Webåº”ç”¨å¯åŠ¨                        â”‚ â† Applicationå¯¹è±¡åˆ›å»º
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ç”¨æˆ·A   â”‚  â”‚ ç”¨æˆ·B   â”‚  â”‚ ç”¨æˆ·C â”‚â”‚ â† æ‰€æœ‰ç”¨æˆ·å…±äº«æ•°æ®
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Webåº”ç”¨å…³é—­                        â”‚ â† Applicationå¯¹è±¡é”€æ¯
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ServletContextå¯¹è±¡è¯¦è§£


**ServletContext**æ˜¯applicationä½œç”¨åŸŸçš„è½½ä½“ï¼Œä»£è¡¨æ•´ä¸ª**Webåº”ç”¨ç¨‹åº**ï¼š

```java
// è·å–ServletContextå¯¹è±¡
ServletContext application = request.getServletContext();
// æˆ–è€…åœ¨JSPä¸­ç›´æ¥ä½¿ç”¨å†…ç½®å¯¹è±¡
// application.setAttribute("key", "value");

// å­˜å‚¨å…¨å±€æ•°æ®
application.setAttribute("appName", "æˆ‘çš„ç½‘ç«™");
application.setAttribute("visitorCount", 0);

// è·å–å…¨å±€æ•°æ®
String appName = (String) application.getAttribute("appName");
```

**ServletContextçš„æ ¸å¿ƒåŠŸèƒ½**ï¼š

```
ServletContextçš„ä½œç”¨èŒƒå›´ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Webåº”ç”¨ç¨‹åº                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚     æ‰€æœ‰JSPé¡µé¢å’ŒServlet       â”‚ â”‚ â† å…±äº«applicationæ•°æ®
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚JSP1 â”‚ â”‚JSP2 â”‚ â”‚Servlet1 â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ServletContextçš„ä¸°å¯Œæ–¹æ³•**ï¼š

| æ–¹æ³•ç±»å‹ | **æ–¹æ³•** | **ä½œç”¨** |
|---------|---------|---------|
| **æ•°æ®å­˜å–** | `setAttribute/getAttribute` | `å­˜å‚¨/è·å–å…±äº«æ•°æ®` |
| **åº”ç”¨ä¿¡æ¯** | `getContextPath()` | `è·å–åº”ç”¨æ ¹è·¯å¾„` |
| **åº”ç”¨ä¿¡æ¯** | `getServerInfo()` | `è·å–æœåŠ¡å™¨ä¿¡æ¯` |
| **åˆå§‹åŒ–å‚æ•°** | `getInitParameter()` | `è·å–web.xmlä¸­çš„é…ç½®` |
| **èµ„æºè®¿é—®** | `getRealPath()` | `è·å–èµ„æºçš„çœŸå®è·¯å¾„` |

### 5.3 Applicationä½œç”¨åŸŸå…¸å‹åº”ç”¨


**ç½‘ç«™è®¿é—®è®¡æ•°å™¨**ï¼š
```jsp
<%-- ç»Ÿè®¡ç½‘ç«™è®¿é—®äººæ•° --%>
<%
    // è·å–å½“å‰è®¿é—®æ¬¡æ•°
    Integer visitCount = (Integer) application.getAttribute("visitCount");
    if (visitCount == null) {
        visitCount = 0;
    }
    
    // å¢åŠ è®¿é—®æ¬¡æ•°
    visitCount++;
    application.setAttribute("visitCount", visitCount);
%>

<div style="text-align: center; margin: 20px;">
    <h3>æ¬¢è¿è®¿é—®æˆ‘çš„ç½‘ç«™ï¼</h3>
    <p>æ‚¨æ˜¯ç¬¬ <strong style="color: red;"><%=visitCount%></strong> ä½è®¿å®¢</p>
</div>
```

**å…¨å±€é…ç½®ä¿¡æ¯**ï¼š
```jsp
<%-- åœ¨åº”ç”¨å¯åŠ¨æ—¶è®¾ç½®é…ç½®ä¿¡æ¯ --%>
<%
    // è®¾ç½®ç½‘ç«™åŸºæœ¬ä¿¡æ¯
    application.setAttribute("siteName", "æˆ‘çš„åšå®¢ç½‘ç«™");
    application.setAttribute("version", "1.0.0");
    application.setAttribute("author", "å¼ ä¸‰");
    
    // è®¾ç½®ç³»ç»Ÿé…ç½®
    application.setAttribute("maxUploadSize", 10 * 1024 * 1024); // 10MB
    application.setAttribute("allowedFileTypes", "jpg,png,gif,pdf");
%>

<!-- åœ¨ä»»ä½•é¡µé¢éƒ½å¯ä»¥ä½¿ç”¨è¿™äº›é…ç½® -->
<footer>
    <p>&copy; 2024 <%=application.getAttribute("siteName")%> 
       ç‰ˆæœ¬ï¼š<%=application.getAttribute("version")%></p>
</footer>
```

**åœ¨çº¿ç”¨æˆ·ç»Ÿè®¡**ï¼š
```jsp
<%-- ç»Ÿè®¡åœ¨çº¿ç”¨æˆ·æ•° --%>
<%
    // ç”¨æˆ·ç™»å½•æ—¶
    String username = (String) session.getAttribute("currentUser");
    if (username != null) {
        // è·å–åœ¨çº¿ç”¨æˆ·åˆ—è¡¨
        Set<String> onlineUsers = (Set<String>) application.getAttribute("onlineUsers");
        if (onlineUsers == null) {
            onlineUsers = new HashSet<String>();
            application.setAttribute("onlineUsers", onlineUsers);
        }
        
        // æ·»åŠ å½“å‰ç”¨æˆ·
        onlineUsers.add(username);
    }
    
    // æ˜¾ç¤ºåœ¨çº¿äººæ•°
    Set<String> users = (Set<String>) application.getAttribute("onlineUsers");
    int onlineCount = users != null ? users.size() : 0;
%>

<div class="online-stats">
    <span>åœ¨çº¿äººæ•°ï¼š<%=onlineCount%></span>
</div>
```

**ç³»ç»Ÿå…¬å‘Š**ï¼š
```jsp
<%-- ç®¡ç†å‘˜å‘å¸ƒç³»ç»Ÿå…¬å‘Š --%>
<%
    String userRole = (String) session.getAttribute("userRole");
    if ("admin".equals(userRole)) {
        String announcement = request.getParameter("announcement");
        if (announcement != null && !announcement.trim().isEmpty()) {
            // å­˜å‚¨ç³»ç»Ÿå…¬å‘Š
            application.setAttribute("systemAnnouncement", announcement);
            application.setAttribute("announcementTime", new Date());
        }
    }
    
    // æ˜¾ç¤ºç³»ç»Ÿå…¬å‘Š
    String notice = (String) application.getAttribute("systemAnnouncement");
    Date noticeTime = (Date) application.getAttribute("announcementTime");
%>

<% if (notice != null) { %>
<div class="announcement" style="background: #fff3cd; padding: 10px; border: 1px solid #ffeaa7; margin: 10px 0;">
    <h4>ğŸ“¢ ç³»ç»Ÿå…¬å‘Š</h4>
    <p><%=notice%></p>
    <small>å‘å¸ƒæ—¶é—´ï¼š<%=noticeTime%></small>
</div>
<% } %>
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**ï¼š
> - Applicationæ•°æ®è¢«æ‰€æœ‰ç”¨æˆ·å…±äº«ï¼Œæ³¨æ„çº¿ç¨‹å®‰å…¨
> - ä¸è¦å­˜å‚¨è¿‡å¤šæ•°æ®ï¼Œå½±å“æœåŠ¡å™¨å†…å­˜
> - æ•æ„Ÿä¿¡æ¯ä¸è¦å­˜å‚¨åœ¨Applicationä¸­
> - åº”ç”¨é‡å¯æ—¶Applicationæ•°æ®ä¼šä¸¢å¤±

---

## 6. âš–ï¸ ä½œç”¨åŸŸå¯¹æ¯”ä¸é€‰æ‹©


### 6.1 å››å¤§ä½œç”¨åŸŸå®Œæ•´å¯¹æ¯”


```
ä½œç”¨åŸŸå¤§å°å…³ç³»ï¼ˆä»å°åˆ°å¤§ï¼‰ï¼š
page â†’ request â†’ session â†’ application

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Applicationä½œç”¨åŸŸ                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚              Sessionä½œç”¨åŸŸ                      â”‚â”‚  
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚  â”‚  â”‚            Requestä½œç”¨åŸŸ                    â”‚â”‚â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚â”‚
â”‚  â”‚  â”‚  â”‚          Pageä½œç”¨åŸŸ                     â”‚â”‚â”‚â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 è¯¦ç»†å¯¹æ¯”è¡¨


| ä½œç”¨åŸŸ | **ç”Ÿå­˜æ—¶é—´** | **æ•°æ®å…±äº«èŒƒå›´** | **å…¸å‹åº”ç”¨** | **æ³¨æ„äº‹é¡¹** |
|--------|-------------|----------------|-------------|-------------|
| ğŸ”¹ **page** | `é¡µé¢æ‰§è¡ŒæœŸé—´` | `å½“å‰é¡µé¢å†…éƒ¨` | `ä¸´æ—¶å˜é‡ã€è®¡ç®—ç»“æœ` | `ä¸èƒ½è·¨é¡µé¢ä¼ é€’` |
| ğŸ”¸ **request** | `ä¸€æ¬¡è¯·æ±‚å‘¨æœŸ` | `è½¬å‘çš„é¡µé¢é—´` | `è¡¨å•æ•°æ®ã€é¡µé¢ä¼ å€¼` | `é‡å®šå‘ä¼šä¸¢å¤±æ•°æ®` |
| ğŸ”¶ **session** | `ç”¨æˆ·ä¼šè¯æœŸé—´` | `åŒä¸€ç”¨æˆ·çš„æ‰€æœ‰é¡µé¢` | `ç™»å½•ä¿¡æ¯ã€è´­ç‰©è½¦` | `æ³¨æ„å†…å­˜å ç”¨` |
| ğŸ”· **application** | `åº”ç”¨è¿è¡ŒæœŸé—´` | `æ‰€æœ‰ç”¨æˆ·å’Œé¡µé¢` | `é…ç½®ä¿¡æ¯ã€è®¡æ•°å™¨` | `æ³¨æ„çº¿ç¨‹å®‰å…¨` |

### 6.3 ä½œç”¨åŸŸé€‰æ‹©å†³ç­–æ ‘


```
é€‰æ‹©ä½œç”¨åŸŸçš„æ€è€ƒè¿‡ç¨‹ï¼š

æ•°æ®éœ€è¦è·¨é¡µé¢ä½¿ç”¨å—ï¼Ÿ
â”œâ”€ ä¸éœ€è¦ â”€â”€â†’ é€‰æ‹© page ä½œç”¨åŸŸ
â””â”€ éœ€è¦
   â”œâ”€ åªåœ¨ä¸€æ¬¡è¯·æ±‚ä¸­ä½¿ç”¨ â”€â”€â†’ é€‰æ‹© request ä½œç”¨åŸŸ
   â””â”€ éœ€è¦ä¿æŒæ›´é•¿æ—¶é—´
      â”œâ”€ ç”¨æˆ·çº§åˆ«çš„æ•°æ® â”€â”€â†’ é€‰æ‹© session ä½œç”¨åŸŸ  
      â””â”€ å…¨å±€å…±äº«æ•°æ® â”€â”€â†’ é€‰æ‹© application ä½œç”¨åŸŸ
```

### 6.4 å¸¸è§ä½¿ç”¨è¯¯åŒº


> âŒ **é”™è¯¯ç”¨æ³•1**ï¼šæŠŠæ‰€æœ‰æ•°æ®éƒ½æ”¾åœ¨sessionä¸­
> ```java
> // é”™è¯¯ï¼šä¸´æ—¶æ•°æ®ä¹Ÿæ”¾session
> session.setAttribute("tempResult", calculation);
> ```
> âœ… **æ­£ç¡®åšæ³•**ï¼šä¸´æ—¶æ•°æ®ç”¨pageæˆ–request
> ```java
> // æ­£ç¡®ï¼šä¸´æ—¶æ•°æ®ç”¨pageä½œç”¨åŸŸ
> pageContext.setAttribute("tempResult", calculation);
> ```

> âŒ **é”™è¯¯ç”¨æ³•2**ï¼šç”¨applicationå­˜å‚¨ç”¨æˆ·ä¸ªäººæ•°æ®
> ```java
> // é”™è¯¯ï¼šä¸ªäººæ•°æ®æ”¾applicationï¼Œæ‰€æœ‰ç”¨æˆ·éƒ½èƒ½çœ‹åˆ°
> application.setAttribute("userCart", userShoppingCart);
> ```
> âœ… **æ­£ç¡®åšæ³•**ï¼šä¸ªäººæ•°æ®ç”¨session
> ```java
> // æ­£ç¡®ï¼šä¸ªäººæ•°æ®ç”¨sessionä½œç”¨åŸŸ
> session.setAttribute("userCart", userShoppingCart);
> ```

---

## 7. ğŸš€ å®é™…åº”ç”¨åœºæ™¯


### 7.1 ç”¨æˆ·ç™»å½•å®Œæ•´æµç¨‹


**ç™»å½•æµç¨‹ä¸­çš„ä½œç”¨åŸŸä½¿ç”¨**ï¼š

```
ç”¨æˆ·ç™»å½•çš„å®Œæ•´è¿‡ç¨‹ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç™»å½•è¡¨å•   â”‚â”€â”€â”€â†’â”‚   éªŒè¯å¤„ç†   â”‚â”€â”€â”€â†’â”‚   ä¸»é¡µæ˜¾ç¤º   â”‚
â”‚ (login.jsp) â”‚    â”‚(loginCheck.jsp)â”‚   â”‚ (main.jsp)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                    â”‚                    â”‚
   æ— ä½œç”¨åŸŸ           request+session         session
```

**ç¬¬1æ­¥ï¼šç™»å½•è¡¨å•é¡µé¢**
```jsp
<%-- login.jspï¼šç®€å•çš„ç™»å½•è¡¨å• --%>
<form action="loginCheck.jsp" method="post">
    <p>ç”¨æˆ·åï¼š<input type="text" name="username" required></p>
    <p>å¯†ç ï¼š<input type="password" name="password" required></p>
    <p><input type="submit" value="ç™»å½•"></p>
</form>

<% 
    // æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ï¼ˆæ¥è‡ªrequestä½œç”¨åŸŸï¼‰
    String errorMsg = (String) request.getAttribute("errorMsg");
    if (errorMsg != null) {
%>
    <p style="color: red;"><%=errorMsg%></p>
<% } %>
```

**ç¬¬2æ­¥ï¼šç™»å½•éªŒè¯å¤„ç†**
```jsp
<%-- loginCheck.jspï¼šå¤„ç†ç™»å½•é€»è¾‘ --%>
<%
    // ä»requestä¸­è·å–è¡¨å•æ•°æ®
    String username = request.getParameter("username");
    String password = request.getParameter("password");
    
    // ç®€å•çš„ç”¨æˆ·éªŒè¯ï¼ˆå®é™…é¡¹ç›®ä¸­åº”è¯¥æŸ¥æ•°æ®åº“ï¼‰
    if ("admin".equals(username) && "123456".equals(password)) {
        // ç™»å½•æˆåŠŸï¼šå°†ç”¨æˆ·ä¿¡æ¯å­˜å‚¨åˆ°session
        session.setAttribute("currentUser", username);
        session.setAttribute("loginTime", new java.util.Date());
        session.setAttribute("userRole", "admin");
        
        // æ›´æ–°å…¨å±€ç»Ÿè®¡ï¼ˆapplicationä½œç”¨åŸŸï¼‰
        Integer loginCount = (Integer) application.getAttribute("totalLoginCount");
        if (loginCount == null) loginCount = 0;
        application.setAttribute("totalLoginCount", loginCount + 1);
        
        // è·³è½¬åˆ°ä¸»é¡µ
        response.sendRedirect("main.jsp");
        
    } else {
        // ç™»å½•å¤±è´¥ï¼šé”™è¯¯ä¿¡æ¯å­˜å‚¨åˆ°requestï¼Œè½¬å‘å›ç™»å½•é¡µ
        request.setAttribute("errorMsg", "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼");
        request.getRequestDispatcher("login.jsp").forward(request, response);
    }
%>
```

**ç¬¬3æ­¥ï¼šä¸»é¡µæ˜¾ç¤º**
```jsp
<%-- main.jspï¼šç™»å½•åçš„ä¸»é¡µ --%>
<%
    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•ï¼ˆä»sessionè·å–ï¼‰
    String currentUser = (String) session.getAttribute("currentUser");
    if (currentUser == null) {
        // ç”¨æˆ·æœªç™»å½•ï¼Œè·³è½¬åˆ°ç™»å½•é¡µ
        response.sendRedirect("login.jsp");
        return;
    }
    
    // è·å–ç™»å½•æ—¶é—´
    java.util.Date loginTime = (java.util.Date) session.getAttribute("loginTime");
    
    // è·å–å…¨å±€ç»Ÿè®¡ä¿¡æ¯
    Integer totalLogins = (Integer) application.getAttribute("totalLoginCount");
%>

<div class="welcome-panel">
    <h2>æ¬¢è¿æ‚¨ï¼Œ<%=currentUser%>ï¼</h2>
    <p>ç™»å½•æ—¶é—´ï¼š<%=loginTime%></p>
    <p>ç³»ç»Ÿæ€»ç™»å½•æ¬¡æ•°ï¼š<%=totalLogins%></p>
    
    <a href="logout.jsp">å®‰å…¨é€€å‡º</a>
</div>
```

### 7.2 ç”µå•†è´­ç‰©è½¦å®ç°


**è´­ç‰©è½¦åŠŸèƒ½ä¸­çš„ä½œç”¨åŸŸåº”ç”¨**ï¼š

```jsp
<%-- å•†å“åˆ—è¡¨é¡µé¢ï¼šaddToCart.jsp --%>
<%
    String productId = request.getParameter("productId");
    String productName = request.getParameter("productName");
    String productPrice = request.getParameter("productPrice");
    
    if (productId != null) {
        // ä»sessionè·å–è´­ç‰©è½¦
        Map<String, Map<String, String>> cart = 
            (Map<String, Map<String, String>>) session.getAttribute("shoppingCart");
            
        if (cart == null) {
            cart = new HashMap<String, Map<String, String>>();
            session.setAttribute("shoppingCart", cart);
        }
        
        // æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦
        Map<String, String> product = new HashMap<String, String>();
        product.put("name", productName);
        product.put("price", productPrice);
        cart.put(productId, product);
        
        // æç¤ºä¿¡æ¯å­˜å‚¨åˆ°requestï¼ˆæ˜¾ç¤ºä¸€æ¬¡ï¼‰
        request.setAttribute("successMsg", "å•†å“å·²æ·»åŠ åˆ°è´­ç‰©è½¦ï¼");
    }
    
    // æ˜¾ç¤ºè´­ç‰©è½¦å•†å“æ•°é‡
    Map<String, Map<String, String>> userCart = 
        (Map<String, Map<String, String>>) session.getAttribute("shoppingCart");
    int cartSize = (userCart != null) ? userCart.size() : 0;
%>

<div class="cart-info">
    <span>è´­ç‰©è½¦ (<%=cartSize%> ä»¶å•†å“)</span>
    <% 
        String successMsg = (String) request.getAttribute("successMsg");
        if (successMsg != null) {
    %>
        <span style="color: green;"><%=successMsg%></span>
    <% } %>
</div>
```

### 7.3 æƒé™æ§åˆ¶ç³»ç»Ÿ


**åŸºäºä½œç”¨åŸŸçš„æƒé™ç®¡ç†**ï¼š

```jsp
<%-- æƒé™æ£€æŸ¥é€šç”¨é¡µé¢ï¼šcheckPermission.jsp --%>
<%
    // æ£€æŸ¥ç”¨æˆ·ç™»å½•çŠ¶æ€
    String currentUser = (String) session.getAttribute("currentUser");
    String userRole = (String) session.getAttribute("userRole");
    
    // è·å–å½“å‰é¡µé¢éœ€è¦çš„æƒé™ï¼ˆä»requestå‚æ•°è·å–ï¼‰
    String requiredPermission = request.getParameter("permission");
    
    boolean hasPermission = false;
    
    if (currentUser != null) {
        // æ ¹æ®ç”¨æˆ·è§’è‰²åˆ¤æ–­æƒé™
        if ("admin".equals(userRole)) {
            hasPermission = true; // ç®¡ç†å‘˜æ‹¥æœ‰æ‰€æœ‰æƒé™
        } else if ("user".equals(userRole) && "read".equals(requiredPermission)) {
            hasPermission = true; // æ™®é€šç”¨æˆ·åªæœ‰è¯»æƒé™
        }
    }
    
    // å°†æƒé™æ£€æŸ¥ç»“æœå­˜å‚¨åˆ°request
    request.setAttribute("hasPermission", hasPermission);
    request.setAttribute("currentUser", currentUser);
    request.setAttribute("userRole", userRole);
%>
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ä½œç”¨åŸŸæœ¬è´¨ï¼šæ•°æ®å­˜æ´»å’Œå…±äº«çš„èŒƒå›´è¾¹ç•Œ
ğŸ”¸ å››å¤§ä½œç”¨åŸŸï¼špage < request < session < application
ğŸ”¸ å¯¹è±¡è½½ä½“ï¼šPageContextã€HttpServletRequestã€HttpSessionã€ServletContext  
ğŸ”¸ åŸºæœ¬æ–¹æ³•ï¼šsetAttribute()å’ŒgetAttribute()æ–¹æ³•å¯¹
ğŸ”¸ ç”Ÿå‘½å‘¨æœŸï¼šæ¯ç§ä½œç”¨åŸŸéƒ½æœ‰ç‰¹å®šçš„åˆ›å»ºå’Œé”€æ¯æ—¶æœº
ğŸ”¸ åº”ç”¨åœºæ™¯ï¼šæ ¹æ®æ•°æ®ç‰¹æ€§é€‰æ‹©åˆé€‚çš„ä½œç”¨åŸŸ
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä½œç”¨åŸŸé€‰æ‹©çš„æ ¸å¿ƒåŸåˆ™**
```
æ•°æ®ç‰¹æ€§å†³å®šä½œç”¨åŸŸé€‰æ‹©ï¼š
- ä¸´æ—¶æ€§æ•°æ® â†’ pageä½œç”¨åŸŸ
- ä¼ é€’æ€§æ•°æ® â†’ requestä½œç”¨åŸŸ  
- ç”¨æˆ·æ€§æ•°æ® â†’ sessionä½œç”¨åŸŸ
- å…¨å±€æ€§æ•°æ® â†’ applicationä½œç”¨åŸŸ
```

**ğŸ”¹ ä½œç”¨åŸŸçš„ç”Ÿå‘½å‘¨æœŸç†è§£**
```
è®°å¿†å£è¯€ï¼š
- pageéšé¡µé¢ï¼šé¡µé¢æ‰§è¡Œå®Œå°±æ¶ˆå¤±
- requestè·Ÿè¯·æ±‚ï¼šä¸€æ¬¡è¯·æ±‚å“åº”å‘¨æœŸ
- sessionä¼´ç”¨æˆ·ï¼šç”¨æˆ·ä¼šè¯æœŸé—´ä¿æŒ
- applicationé™ªåº”ç”¨ï¼šåº”ç”¨å¯åŠ¨åˆ°å…³é—­
```

**ğŸ”¹ æ•°æ®å­˜å–çš„æ ‡å‡†æ¨¡å¼**
```java
// å­˜å‚¨æ•°æ®çš„ç»Ÿä¸€æ¨¡å¼
ä½œç”¨åŸŸå¯¹è±¡.setAttribute("é”®å", æ•°æ®å€¼);

// è·å–æ•°æ®çš„ç»Ÿä¸€æ¨¡å¼  
æ•°æ®ç±»å‹ å˜é‡å = (æ•°æ®ç±»å‹) ä½œç”¨åŸŸå¯¹è±¡.getAttribute("é”®å");
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼åŸåˆ™


**âœ… æœ€ä½³å®è·µ**
- ä¼˜å…ˆä½¿ç”¨å°èŒƒå›´ä½œç”¨åŸŸï¼Œé¿å…æ•°æ®æ±¡æŸ“
- sessionä¸­ä¸è¦å­˜å‚¨è¿‡å¤šæ•°æ®ï¼Œå½±å“æœåŠ¡å™¨æ€§èƒ½
- applicationä½œç”¨åŸŸè¦è€ƒè™‘çº¿ç¨‹å®‰å…¨é—®é¢˜
- åŠæ—¶æ¸…ç†ä¸éœ€è¦çš„ä½œç”¨åŸŸæ•°æ®

**âŒ å¸¸è§è¯¯åŒº**
- ä¸è¦æ»¥ç”¨å¤§èŒƒå›´ä½œç”¨åŸŸå­˜å‚¨ä¸´æ—¶æ•°æ®
- ä¸è¦åœ¨applicationä¸­å­˜å‚¨ç”¨æˆ·ä¸ªäººä¿¡æ¯
- ä¸è¦å¿˜è®°æ£€æŸ¥ä½œç”¨åŸŸæ•°æ®çš„ç©ºå€¼æƒ…å†µ
- ä¸è¦æ··æ·†è½¬å‘ï¼ˆforwardï¼‰å’Œé‡å®šå‘ï¼ˆredirectï¼‰å¯¹requestä½œç”¨åŸŸçš„å½±å“

**ğŸ¯ åº”ç”¨åœºæ™¯æ€»ç»“**
- **è¡¨å•å¤„ç†**ï¼šrequestä½œç”¨åŸŸä¼ é€’è¡¨å•æ•°æ®å’Œå¤„ç†ç»“æœ
- **ç”¨æˆ·ç®¡ç†**ï¼šsessionä½œç”¨åŸŸç»´æŠ¤ç™»å½•çŠ¶æ€å’Œä¸ªäººä¿¡æ¯
- **ç³»ç»Ÿé…ç½®**ï¼šapplicationä½œç”¨åŸŸå­˜å‚¨å…¨å±€é…ç½®å’Œç»Ÿè®¡ä¿¡æ¯
- **é¡µé¢è®¡ç®—**ï¼špageä½œç”¨åŸŸå¤„ç†é¡µé¢å†…éƒ¨çš„ä¸´æ—¶æ•°æ®

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- ä½œç”¨åŸŸæ˜¯JSPæ•°æ®ç®¡ç†çš„åŸºç¡€ï¼Œç†è§£ç”Ÿå‘½å‘¨æœŸæ˜¯å…³é”®
- åˆç†é€‰æ‹©ä½œç”¨åŸŸèƒ½æé«˜åº”ç”¨æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ
- setAttributeå’ŒgetAttributeæ˜¯æ“ä½œæ‰€æœ‰ä½œç”¨åŸŸçš„é€šç”¨æ–¹æ³•
- å®é™…å¼€å‘ä¸­è¦æ ¹æ®æ•°æ®ç‰¹æ€§é€‰æ‹©æœ€é€‚åˆçš„ä½œç”¨åŸŸ