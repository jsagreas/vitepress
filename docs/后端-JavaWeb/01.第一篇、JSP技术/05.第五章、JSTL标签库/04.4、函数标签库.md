---
title: 4、函数标签库
---
## 📚 目录

1. [JSTL函数标签库概述](#1-JSTL函数标签库概述)
2. [基础配置与引入](#2-基础配置与引入)
3. [字符串长度函数](#3-字符串长度函数)
4. [字符串判断函数](#4-字符串判断函数)
5. [字符串操作函数](#5-字符串操作函数)
6. [字符串处理函数](#6-字符串处理函数)
7. [实际应用案例](#7-实际应用案例)
8. [核心要点总结](#8-核心要点总结)

---

## 1. 🌟 JSTL函数标签库概述


### 1.1 什么是JSTL函数标签库


**简单理解**：就像JavaScript中有各种字符串方法一样，JSTL函数标签库为我们在JSP页面中提供了**专门处理字符串的工具函数**。

```
想象一下：
JavaScript中: str.length、str.indexOf()、str.substring()
JSTL函数中: fn:length、fn:indexOf、fn:substring

作用完全一样，只是使用场景不同！
```

### 1.2 为什么需要函数标签库


**实际问题**：在JSP页面中，我们经常需要：
- 检查用户名长度是否合适
- 判断邮箱是否包含@符号
- 截取文章标题显示前30个字符
- 替换敏感词汇

**传统做法的问题**：
```jsp
<!-- 传统做法：在JSP中写Java代码 -->
<% 
String username = (String)request.getAttribute("username");
if(username != null && username.length() > 0) {
    // 处理逻辑...
}
%>
```
这样写代码**混乱、难维护、不优雅**！

**JSTL函数的优势**：
```jsp
<!-- 使用JSTL函数：简洁、清晰、易读 -->
<c:if test="${fn:length(username) > 0}">
    用户名：${fn:substring(username, 0, 10)}...
</c:if>
```

### 1.3 函数标签库的特点


```
🎯 核心特点：
• 专门处理字符串操作
• 语法简洁，易于理解  
• 与EL表达式完美结合
• 无需写复杂的Java代码
• 提高JSP页面的可读性
```

---

## 2. 🔧 基础配置与引入


### 2.1 引入函数标签库


在JSP页面顶部添加标签库声明：

```jsp
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
```

**解释说明**：
- `prefix="fn"`：给函数标签库起个简短的别名叫"fn"
- 就像给一个很长的类名起个简称一样，方便使用

### 2.2 完整的页面引入示例


```jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>

<!DOCTYPE html>
<html>
<head>
    <title>JSTL函数标签库演示</title>
</head>
<body>
    <!-- 这里就可以使用fn:xxx函数了 -->
</body>
</html>
```

### 2.3 依赖说明


**Maven项目需要的依赖**：
```xml
<dependency>
    <groupId>javax.servlet</groupId>
    <artifactId>jstl</artifactId>
    <version>1.2</version>
</dependency>
```

---

## 3. 📏 字符串长度函数


### 3.1 fn:length 基本用法


**作用**：获取字符串、数组或集合的长度

```jsp
<!-- 基本语法 -->
${fn:length(要检查的内容)}
```

### 3.2 实际使用示例


```jsp
<!-- 准备测试数据 -->
<c:set var="username" value="张三丰" />
<c:set var="email" value="zhangsan@example.com" />
<c:set var="emptyStr" value="" />

<!-- 使用fn:length获取长度 -->
<p>用户名长度：${fn:length(username)}</p>          <!-- 输出：3 -->
<p>邮箱长度：${fn:length(email)}</p>              <!-- 输出：18 -->
<p>空字符串长度：${fn:length(emptyStr)}</p>        <!-- 输出：0 -->
```

### 3.3 实际应用场景


**场景1：验证用户输入**
```jsp
<c:choose>
    <c:when test="${fn:length(username) == 0}">
        <span style="color:red;">用户名不能为空</span>
    </c:when>
    <c:when test="${fn:length(username) > 20}">
        <span style="color:red;">用户名不能超过20个字符</span>
    </c:when>
    <c:otherwise>
        <span style="color:green;">用户名格式正确</span>
    </c:otherwise>
</c:choose>
```

**场景2：控制显示内容长度**
```jsp
<!-- 如果标题太长，显示省略号 -->
<c:choose>
    <c:when test="${fn:length(articleTitle) > 30}">
        <h3>${fn:substring(articleTitle, 0, 30)}...</h3>
    </c:when>
    <c:otherwise>
        <h3>${articleTitle}</h3>
    </c:otherwise>
</c:choose>
```

### 3.4 注意事项


```
📝 重要提醒：
• fn:length对null值返回0，不会报错
• 中文字符算1个长度（不是字节长度）
• 可以用于字符串、数组、List、Set等集合类型
```

---

## 4. 🔍 字符串判断函数


### 4.1 三个重要的判断函数


```
核心函数：
• fn:contains     → 是否包含某个子字符串
• fn:startsWith   → 是否以某个字符串开头  
• fn:endsWith     → 是否以某个字符串结尾
```

### 4.2 fn:contains 包含判断


**作用**：检查字符串是否包含指定的子字符串

```jsp
<!-- 基本语法 -->
${fn:contains(原字符串, 要查找的子字符串)}
```

**实际使用**：
```jsp
<c:set var="email" value="user@gmail.com" />
<c:set var="phone" value="13812345678" />

<!-- 判断邮箱格式 -->
<c:if test="${fn:contains(email, '@')}">
    <span>邮箱格式看起来正确</span>
</c:if>

<!-- 判断手机号 -->
<c:if test="${fn:contains(phone, '138')}">
    <span>这是138开头的手机号</span>
</c:if>
```

### 4.3 fn:startsWith 开头判断


**作用**：检查字符串是否以指定字符串开头

```jsp
<c:set var="url" value="https://www.example.com" />
<c:set var="filename" value="report.pdf" />

<!-- 判断是否是安全链接 -->
<c:if test="${fn:startsWith(url, 'https://')}">
    <span style="color:green;">安全链接</span>
</c:if>

<!-- 判断文件类型 -->
<c:if test="${fn:startsWith(filename, 'report')}">
    <span>这是一个报告文件</span>
</c:if>
```

### 4.4 fn:endsWith 结尾判断


**作用**：检查字符串是否以指定字符串结尾

```jsp
<c:set var="imageName" value="avatar.jpg" />
<c:set var="docName" value="manual.pdf" />

<!-- 判断是否是图片文件 -->
<c:choose>
    <c:when test="${fn:endsWith(imageName, '.jpg') || fn:endsWith(imageName, '.png')}">
        <img src="${imageName}" alt="用户头像" />
    </c:when>
    <c:otherwise>
        <span>不是图片文件</span>
    </c:otherwise>
</c:choose>
```

### 4.5 实际应用案例


**案例：智能文件类型识别**
```jsp
<c:set var="files" value="${requestScope.fileList}" />

<table border="1">
    <tr><th>文件名</th><th>类型</th><th>操作</th></tr>
    <c:forEach var="file" items="${files}">
        <tr>
            <td>${file.name}</td>
            <td>
                <c:choose>
                    <c:when test="${fn:endsWith(file.name, '.jpg') || fn:endsWith(file.name, '.png')}">
                        📸 图片文件
                    </c:when>
                    <c:when test="${fn:endsWith(file.name, '.pdf')}">
                        📄 PDF文档
                    </c:when>
                    <c:when test="${fn:endsWith(file.name, '.txt')}">
                        📝 文本文件
                    </c:when>
                    <c:otherwise>
                        📎 其他文件
                    </c:otherwise>
                </c:choose>
            </td>
            <td>
                <c:if test="${fn:contains(file.name, 'temp')}">
                    <button>删除临时文件</button>
                </c:if>
            </td>
        </tr>
    </c:forEach>
</table>
```

---

## 5. ✂️ 字符串操作函数


### 5.1 fn:indexOf 查找位置


**作用**：查找子字符串在原字符串中第一次出现的位置

```jsp
<!-- 基本语法 -->
${fn:indexOf(原字符串, 要查找的子字符串)}
```

**返回值说明**：
- 找到了：返回位置索引（从0开始）
- 没找到：返回-1

**实际使用**：
```jsp
<c:set var="email" value="user@gmail.com" />

<!-- 找到@符号的位置 -->
<c:set var="atPosition" value="${fn:indexOf(email, '@')}" />

<c:if test="${atPosition != -1}">
    <p>@符号在第 ${atPosition + 1} 个位置</p>
    <p>用户名部分：${fn:substring(email, 0, atPosition)}</p>
</c:if>
```

### 5.2 fn:substring 字符串截取


**作用**：截取字符串的一部分

```jsp
<!-- 两种语法 -->
${fn:substring(原字符串, 开始位置, 结束位置)}
${fn:substring(原字符串, 开始位置, -1)}  <!-- 截取到末尾 -->
```

**使用示例**：
```jsp
<c:set var="longText" value="这是一篇很长的文章标题，需要进行截取处理" />

<!-- 截取前10个字符 -->
<h3>${fn:substring(longText, 0, 10)}...</h3>

<!-- 截取中间部分 -->
<p>中间部分：${fn:substring(longText, 5, 15)}</p>

<!-- 截取后面部分 -->
<p>后面部分：${fn:substring(longText, 10, -1)}</p>
```

### 5.3 实际应用：智能摘要生成


```jsp
<c:set var="articles" value="${requestScope.articleList}" />

<div class="article-list">
    <c:forEach var="article" items="${articles}">
        <div class="article-item">
            <!-- 标题处理：超过30字符显示省略号 -->
            <h3>
                <c:choose>
                    <c:when test="${fn:length(article.title) > 30}">
                        ${fn:substring(article.title, 0, 30)}...
                    </c:when>
                    <c:otherwise>
                        ${article.title}
                    </c:otherwise>
                </c:choose>
            </h3>
            
            <!-- 内容摘要：显示前100字符 -->
            <p class="summary">
                ${fn:substring(article.content, 0, 100)}
                <c:if test="${fn:length(article.content) > 100}">...</c:if>
            </p>
            
            <!-- 作者信息处理 -->
            <div class="author">
                作者：
                <c:choose>
                    <c:when test="${fn:contains(article.author, '@')}">
                        <!-- 如果是邮箱，只显示@前面的部分 -->
                        ${fn:substring(article.author, 0, fn:indexOf(article.author, '@'))}
                    </c:when>
                    <c:otherwise>
                        ${article.author}
                    </c:otherwise>
                </c:choose>
            </div>
        </div>
    </c:forEach>
</div>
```

---

## 6. 🔄 字符串处理函数


### 6.1 fn:replace 字符串替换


**作用**：将字符串中的指定内容替换为新内容

```jsp
<!-- 基本语法 -->
${fn:replace(原字符串, 要替换的内容, 新内容)}
```

**实际使用**：
```jsp
<c:set var="userInput" value="这是一个该死的测试" />

<!-- 过滤敏感词 -->
<c:set var="cleanText" value="${fn:replace(userInput, '该死', '***')}" />
<p>处理后：${cleanText}</p>  <!-- 输出：这是一个***的测试 -->

<!-- 格式化处理 -->
<c:set var="phone" value="138-1234-5678" />
<c:set var="cleanPhone" value="${fn:replace(phone, '-', '')}" />
<p>纯数字手机号：${cleanPhone}</p>  <!-- 输出：13812345678 -->
```

### 6.2 fn:trim 去除空格


**作用**：去除字符串开头和结尾的空格

```jsp
<c:set var="messyInput" value="  用户输入的内容  " />

<!-- 清理空格 -->
<c:set var="cleanInput" value="${fn:trim(messyInput)}" />

<p>原始输入："${messyInput}"</p>      <!-- 显示：  用户输入的内容   -->
<p>处理后："${cleanInput}"</p>        <!-- 显示：用户输入的内容 -->
<p>长度对比：${fn:length(messyInput)} vs ${fn:length(cleanInput)}</p>
```

### 6.3 组合使用：数据清理管道


```jsp
<!-- 模拟用户提交的脏数据 -->
<c:set var="rawComment" value="  这个产品真他妈的好用！！！  " />

<!-- 数据清理流水线 -->
<c:set var="step1" value="${fn:trim(rawComment)}" />          <!-- 去除前后空格 -->
<c:set var="step2" value="${fn:replace(step1, '他妈的', '***')}" />  <!-- 过滤敏感词 -->
<c:set var="step3" value="${fn:replace(step2, '！！！', '！')}" />     <!-- 减少重复符号 -->

<div class="comment-processing">
    <h4>评论处理过程：</h4>
    <p><strong>原始数据：</strong>"${rawComment}"</p>
    <p><strong>去除空格：</strong>"${step1}"</p>
    <p><strong>过滤敏感词：</strong>"${step2}"</p>
    <p><strong>最终结果：</strong>"${step3}"</p>
</div>
```

### 6.4 实际应用：用户资料显示


```jsp
<c:set var="user" value="${sessionScope.currentUser}" />

<div class="user-profile">
    <h3>个人资料</h3>
    
    <!-- 用户名处理 -->
    <p><strong>用户名：</strong>
        <c:set var="displayName" value="${fn:trim(user.username)}" />
        <c:choose>
            <c:when test="${fn:length(displayName) > 15}">
                ${fn:substring(displayName, 0, 15)}...
            </c:when>
            <c:otherwise>
                ${displayName}
            </c:otherwise>
        </c:choose>
    </p>
    
    <!-- 邮箱处理：隐藏部分信息 -->
    <p><strong>邮箱：</strong>
        <c:if test="${fn:contains(user.email, '@')}">
            <c:set var="emailParts" value="${fn:indexOf(user.email, '@')}" />
            <c:set var="username" value="${fn:substring(user.email, 0, emailParts)}" />
            <c:set var="domain" value="${fn:substring(user.email, emailParts, -1)}" />
            
            <!-- 只显示用户名的前3位和后1位 -->
            <c:choose>
                <c:when test="${fn:length(username) > 4}">
                    ${fn:substring(username, 0, 3)}***${fn:substring(username, fn:length(username)-1, -1)}${domain}
                </c:when>
                <c:otherwise>
                    ${user.email}
                </c:otherwise>
            </c:choose>
        </c:if>
    </p>
    
    <!-- 个人简介处理 -->
    <p><strong>个人简介：</strong>
        <c:set var="bio" value="${fn:trim(user.biography)}" />
        <c:choose>
            <c:when test="${fn:length(bio) == 0}">
                <em>暂无个人简介</em>
            </c:when>
            <c:when test="${fn:length(bio) > 100}">
                ${fn:substring(bio, 0, 100)}... 
                <a href="javascript:void(0)" onclick="showFullBio()">查看全部</a>
            </c:when>
            <c:otherwise>
                ${bio}
            </c:otherwise>
        </c:choose>
    </p>
</div>
```

---

## 7. 🎯 实际应用案例


### 7.1 搜索结果高亮显示


```jsp
<!-- 假设用户搜索关键词为 "Java" -->
<c:set var="keyword" value="${param.keyword}" />
<c:set var="searchResults" value="${requestScope.searchResults}" />

<div class="search-results">
    <h3>搜索 "${keyword}" 的结果</h3>
    
    <c:forEach var="result" items="${searchResults}">
        <div class="result-item">
            <h4>
                <!-- 在标题中高亮关键词 -->
                <c:choose>
                    <c:when test="${fn:contains(result.title, keyword)}">
                        ${fn:replace(result.title, keyword, '<mark>'.concat(keyword).concat('</mark>'))}
                    </c:when>
                    <c:otherwise>
                        ${result.title}
                    </c:otherwise>
                </c:choose>
            </h4>
            
            <p class="result-summary">
                <!-- 截取包含关键词的部分作为摘要 -->
                <c:choose>
                    <c:when test="${fn:contains(result.content, keyword)}">
                        <c:set var="keywordPos" value="${fn:indexOf(result.content, keyword)}" />
                        <c:set var="startPos" value="${keywordPos - 50}" />
                        <c:if test="${startPos < 0}">
                            <c:set var="startPos" value="0" />
                        </c:if>
                        
                        <c:set var="excerpt" value="${fn:substring(result.content, startPos, startPos + 200)}" />
                        ...${fn:replace(excerpt, keyword, '<mark>'.concat(keyword).concat('</mark>'))}...
                    </c:when>
                    <c:otherwise>
                        ${fn:substring(result.content, 0, 200)}...
                    </c:otherwise>
                </c:choose>
            </p>
        </div>
    </c:forEach>
</div>
```

### 7.2 文件上传验证


```jsp
<form action="upload" method="post" enctype="multipart/form-data">
    <div class="file-upload">
        <h4>文件上传</h4>
        
        <!-- 使用JavaScript获取文件名，然后用JSTL验证 -->
        <input type="file" id="fileInput" name="uploadFile" onchange="validateFile(this)" />
        
        <!-- 显示验证结果的区域 -->
        <div id="fileValidation"></div>
        
        <script>
        function validateFile(input) {
            const fileName = input.files[0]?.name || '';
            // 将文件名传递给后台验证
            if (fileName) {
                document.getElementById('fileValidation').innerHTML = 
                    `<p>选择的文件：${fileName}</p>`;
            }
        }
        </script>
        
        <!-- 服务器端验证（如果是提交后的页面） -->
        <c:if test="${not empty param.fileName}">
            <c:set var="fileName" value="${param.fileName}" />
            <div class="validation-result">
                <c:choose>
                    <c:when test="${fn:endsWith(fileName, '.jpg') || 
                                   fn:endsWith(fileName, '.jpeg') || 
                                   fn:endsWith(fileName, '.png')}">
                        <span style="color: green;">✓ 图片格式正确</span>
                    </c:when>
                    <c:when test="${fn:length(fileName) > 100}">
                        <span style="color: red;">✗ 文件名过长</span>
                    </c:when>
                    <c:when test="${fn:contains(fileName, ' ')}">
                        <span style="color: orange;">⚠ 建议文件名不包含空格</span>
                    </c:when>
                    <c:otherwise>
                        <span style="color: red;">✗ 不支持的文件格式</span>
                    </c:otherwise>
                </c:choose>
            </div>
        </c:if>
    </div>
    
    <button type="submit">上传文件</button>
</form>
```

### 7.3 社交媒体内容处理


```jsp
<c:set var="posts" value="${requestScope.userPosts}" />

<div class="social-feed">
    <c:forEach var="post" items="${posts}">
        <div class="post-item">
            <!-- 处理@提及和#话题标签 -->
            <div class="post-content">
                <c:set var="content" value="${post.content}" />
                
                <!-- 简单处理@用户提及 -->
                <c:choose>
                    <c:when test="${fn:contains(content, '@')}">
                        <c:set var="processedContent" 
                               value="${fn:replace(content, '@', '<span class=\"mention\">@</span>')}" />
                    </c:when>
                    <c:otherwise>
                        <c:set var="processedContent" value="${content}" />
                    </c:otherwise>
                </c:choose>
                
                <!-- 处理#话题标签 -->
                <c:if test="${fn:contains(processedContent, '#')}">
                    <c:set var="processedContent" 
                           value="${fn:replace(processedContent, '#', '<span class=\"hashtag\">#</span>')}" />
                </c:if>
                
                <!-- 显示处理后的内容 -->
                <p>${processedContent}</p>
            </div>
            
            <!-- 内容统计信息 -->
            <div class="post-stats">
                <small>
                    字数：${fn:length(post.content)} | 
                    <c:set var="mentionCount" value="0" />
                    <c:if test="${fn:contains(post.content, '@')}">
                        提及：有 | 
                    </c:if>
                    <c:if test="${fn:contains(post.content, '#')}">
                        话题：有
                    </c:if>
                </small>
            </div>
            
            <!-- 内容截断显示 -->
            <c:if test="${fn:length(post.content) > 200}">
                <div class="post-preview">
                    ${fn:substring(post.content, 0, 200)}...
                    <a href="post/${post.id}">查看全文</a>
                </div>
            </c:if>
        </div>
    </c:forEach>
</div>
```

---

## 8. 📋 核心要点总结


### 8.1 必须掌握的核心概念


```
🔸 JSTL函数标签库本质：JSP页面中的字符串处理工具集
🔸 引入方式：<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
🔸 基本语法：${fn:函数名(参数1, 参数2, ...)}
🔸 核心作用：让JSP页面处理字符串更简单、更优雅
```

### 8.2 八大常用函数速记


| 函数名 | **作用** | **返回值** | **使用场景** |
|--------|----------|-----------|-------------|
| `fn:length` | `获取长度` | `数字` | `验证输入、控制显示` |
| `fn:contains` | `是否包含` | `true/false` | `内容检查、格式验证` |
| `fn:startsWith` | `是否开头` | `true/false` | `类型判断、URL检查` |
| `fn:endsWith` | `是否结尾` | `true/false` | `文件类型、格式检查` |
| `fn:indexOf` | `查找位置` | `数字(-1表示未找到)` | `字符串分析、内容定位` |
| `fn:substring` | `字符串截取` | `字符串` | `内容摘要、长度控制` |
| `fn:replace` | `内容替换` | `字符串` | `敏感词过滤、格式化` |
| `fn:trim` | `去除空格` | `字符串` | `数据清理、格式规范` |

### 8.3 实际应用的核心思路


**🔹 数据验证思路**
```
用户输入 → fn:length检查长度 → fn:contains检查格式 → 显示结果
例如：邮箱验证 = fn:length > 0 && fn:contains('@') && fn:contains('.')
```

**🔹 内容展示思路**
```
原始内容 → fn:length判断长度 → fn:substring截取 → 优雅显示
例如：标题显示 = 超过30字符就截取前30个 + "..."
```

**🔹 数据处理思路**
```
脏数据 → fn:trim去空格 → fn:replace替换 → 清洁数据
例如：用户输入 = 去空格 → 过滤敏感词 → 格式化符号
```

### 8.4 使用注意事项


```
📝 重要提醒：
• 所有函数都对null值安全，不会抛异常
• fn:length计算的是字符数，不是字节数
• fn:substring的索引从0开始，包含开始位置，不包含结束位置
• fn:indexOf返回-1表示没找到
• 函数可以嵌套使用，但要注意可读性
• 复杂的字符串处理建议在后台Java代码中完成
```

### 8.5 最佳实践建议


**✅ 推荐做法**：
- 简单的字符串操作用JSTL函数
- 复杂的业务逻辑放在后台处理
- 多个函数组合时注意代码可读性
- 充分利用`<c:set>`变量存储中间结果

**❌ 避免的做法**：
- 在JSP中写复杂的字符串处理逻辑
- 过度嵌套函数导致代码难读
- 忽略null值的处理
- 把所有逻辑都放在JSP页面中

### 8.6 记忆口诀


```
JSTL函数很简单，字符处理最方便
length长度contains含，startsWith开头看
endsWith结尾判断，indexOf位置找
substring截取段，replace替换好
trim空格全去掉，八大函数要记牢
```

**核心理解**：
- JSTL函数标签库就是为JSP页面提供的"字符串工具箱"
- 让我们在不写Java代码的情况下轻松处理字符串
- 是构建用户友好界面的重要工具
- 掌握这8个函数，90%的字符串处理需求都能搞定