---
title: 3、格式化标签库
---
## 📚 目录

1. [格式化标签库概述](#1-格式化标签库概述)
2. [日期格式化标签](#2-日期格式化标签)
3. [数字格式化标签](#3-数字格式化标签)
4. [本地化与国际化](#4-本地化与国际化)
5. [时区处理](#5-时区处理)
6. [实战应用场景](#6-实战应用场景)
7. [核心要点总结](#7-核心要点总结)

---

## 1. 🎯 格式化标签库概述


### 1.1 什么是格式化标签库


**简单理解**：格式化标签库就像一个专门用来"美化"数据显示的工具箱。

```
想象一个场景：
原始数据：2024-09-24 15:30:45.123
用户看到：2024年9月24日 下午3:30

原始数据：123456.789
用户看到：¥123,456.79
```

**核心作用**：
- 🔸 **日期美化**：把系统日期变成用户友好的格式
- 🔸 **数字美化**：把普通数字变成货币、百分比等格式
- 🔸 **多语言支持**：根据用户地区显示不同格式
- 🔸 **减少Java代码**：在JSP页面直接格式化，不用写复杂的Java代码

### 1.2 引入格式化标签库


**第一步：添加依赖**
```xml
<!-- 在web.xml或者项目中确保有JSTL库 -->
```

**第二步：在JSP页面引入**
```jsp
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
```

**理解要点**：
- `fmt` 是我们给这个标签库起的别名，可以自定义
- 引入后就能使用 `<fmt:xxx>` 这样的标签了

---

## 2. 📅 日期格式化标签


### 2.1 基础日期格式化 - `<fmt:formatDate>`


**这个标签是干什么的**：把Java的Date对象变成好看的日期字符串

**基本语法结构**：
```jsp
<fmt:formatDate value="${日期对象}" pattern="显示格式"/>
```

### 2.2 常用日期格式模式


| 🕐 **格式符号** | **含义** | **示例效果** |
|----------------|----------|-------------|
| `yyyy` | 4位年份 | `2024` |
| `MM` | 2位月份 | `09` |
| `dd` | 2位日期 | `24` |
| `HH` | 24小时制小时 | `15` |
| `mm` | 分钟 | `30` |
| `ss` | 秒钟 | `45` |

**💡 实用示例**：
```jsp
<!-- 假设有一个日期对象 ${currentDate} -->

<!-- 完整日期时间 -->
<fmt:formatDate value="${currentDate}" pattern="yyyy年MM月dd日 HH:mm:ss"/>
输出：2024年09月24日 15:30:45

<!-- 只显示日期 -->
<fmt:formatDate value="${currentDate}" pattern="yyyy-MM-dd"/>
输出：2024-09-24

<!-- 中文友好格式 -->
<fmt:formatDate value="${currentDate}" pattern="MM月dd日 下午HH:mm"/>
输出：09月24日 下午15:30
```

### 2.3 预定义的日期样式


**为什么要预定义样式**：不用记住复杂的pattern，直接用简单的关键词

```jsp
<!-- 使用type和dateStyle属性 -->
<fmt:formatDate value="${currentDate}" type="date" dateStyle="full"/>
<fmt:formatDate value="${currentDate}" type="time" timeStyle="short"/>
<fmt:formatDate value="${currentDate}" type="both" dateStyle="medium" timeStyle="medium"/>
```

**样式对照表**：

| **样式** | **日期效果** | **时间效果** |
|----------|-------------|-------------|
| `full` | `2024年9月24日星期二` | `下午03时30分45秒 CST` |
| `long` | `2024年9月24日` | `下午03时30分45秒` |
| `medium` | `2024年9月24日` | `15:30:45` |
| `short` | `24/9/24` | `下午3:30` |

### 2.4 实际应用场景


**📝 用户评论时间显示**：
```jsp
<!-- 用户评论 -->
<div class="comment">
    <p>${comment.content}</p>
    <small>发布时间：<fmt:formatDate value="${comment.createTime}" pattern="MM月dd日 HH:mm"/></small>
</div>
```

**📊 订单管理页面**：
```jsp
<table>
    <tr>
        <th>订单号</th>
        <th>下单时间</th>
        <th>状态</th>
    </tr>
    <c:forEach var="order" items="${orderList}">
    <tr>
        <td>${order.orderNo}</td>
        <td><fmt:formatDate value="${order.createTime}" pattern="yyyy-MM-dd HH:mm"/></td>
        <td>${order.status}</td>
    </tr>
    </c:forEach>
</table>
```

---

## 3. 💰 数字格式化标签


### 3.1 基础数字格式化 - `<fmt:formatNumber>`


**这个标签解决什么问题**：
- 普通数字：`123456.789`
- 格式化后：`¥123,456.79` 或者 `123,456.79%`

**基本语法**：
```jsp
<fmt:formatNumber value="${数字}" type="格式类型"/>
```

### 3.2 数字格式化类型详解


**🔸 普通数字格式（number）**
```jsp
<fmt:formatNumber value="123456.789" type="number"/>
输出：123,456.789

<!-- 控制小数位数 -->
<fmt:formatNumber value="123.456789" type="number" maxFractionDigits="2"/>
输出：123.46

<fmt:formatNumber value="123.4" type="number" minFractionDigits="2"/>
输出：123.40
```

**🔸 货币格式（currency）**
```jsp
<fmt:formatNumber value="123456.78" type="currency"/>
输出：¥123,456.78 (中文环境下)

<!-- 指定货币符号 -->
<fmt:formatNumber value="123456.78" type="currency" currencySymbol="$"/>
输出：$123,456.78
```

**🔸 百分比格式（percent）**
```jsp
<fmt:formatNumber value="0.856" type="percent"/>
输出：85.6%

<fmt:formatNumber value="0.856" type="percent" maxFractionDigits="1"/>
输出：85.6%
```

### 3.3 数字格式化属性详解


| **属性名** | **作用** | **示例** |
|-----------|----------|----------|
| `maxIntegerDigits` | 最大整数位数 | `value="12345" maxIntegerDigits="3"` → `345` |
| `minIntegerDigits` | 最小整数位数 | `value="45" minIntegerDigits="4"` → `0045` |
| `maxFractionDigits` | 最大小数位数 | `value="3.14159" maxFractionDigits="2"` → `3.14` |
| `minFractionDigits` | 最小小数位数 | `value="3.1" minFractionDigits="2"` → `3.10` |
| `groupingUsed` | 是否使用千分位分隔符 | `value="123456" groupingUsed="false"` → `123456` |

### 3.4 实际应用示例


**💳 电商网站价格显示**：
```jsp
<div class="product">
    <h3>${product.name}</h3>
    <p class="price">
        价格：<fmt:formatNumber value="${product.price}" type="currency"/>
    </p>
    <p class="discount">
        折扣：<fmt:formatNumber value="${product.discountRate}" type="percent"/>
    </p>
</div>
```

**📈 统计报表显示**：
```jsp
<div class="statistics">
    <p>总销售额：<fmt:formatNumber value="${totalSales}" type="currency"/></p>
    <p>增长率：<fmt:formatNumber value="${growthRate}" type="percent" maxFractionDigits="1"/></p>
    <p>用户数量：<fmt:formatNumber value="${userCount}" type="number" groupingUsed="true"/></p>
</div>
```

---

## 4. 🌍 本地化与国际化（i18n）


### 4.1 什么是本地化和国际化


**通俗理解**：
- **国际化（i18n）**：让网站能支持多种语言和地区格式
- **本地化**：根据用户所在地区显示相应的格式

```
同一个数字在不同地区的显示：
中国用户看到：¥123,456.78
美国用户看到：$123,456.78
欧洲用户看到：€123.456,78
```

### 4.2 设置和获取地区信息


**🔸 设置当前地区**
```jsp
<fmt:setLocale value="zh_CN"/>  <!-- 中文（中国） -->
<fmt:setLocale value="en_US"/>  <!-- 英文（美国） -->
<fmt:setLocale value="ja_JP"/>  <!-- 日文（日本） -->
```

**🔸 根据地区格式化**
```jsp
<!-- 中文环境 -->
<fmt:setLocale value="zh_CN"/>
<fmt:formatNumber value="123456.78" type="currency"/>
输出：¥123,456.78

<!-- 美国环境 -->
<fmt:setLocale value="en_US"/>
<fmt:formatNumber value="123456.78" type="currency"/>
输出：$123,456.78
```

### 4.3 资源包的使用


**什么是资源包**：存放不同语言文字的配置文件

**📁 创建资源包文件**：
```
src/main/resources/
  ├── messages_zh_CN.properties  (中文)
  ├── messages_en_US.properties  (英文)
  └── messages_ja_JP.properties  (日文)
```

**📝 资源包内容示例**：
```properties
# messages_zh_CN.properties
welcome.message=欢迎访问我们的网站
product.name=商品名称
product.price=价格

# messages_en_US.properties
welcome.message=Welcome to our website
product.name=Product Name
product.price=Price
```

**🔸 在JSP中使用资源包**
```jsp
<!-- 设置资源包 -->
<fmt:setBundle basename="messages"/>

<!-- 使用消息 -->
<h1><fmt:message key="welcome.message"/></h1>
<p><fmt:message key="product.name"/>：${product.name}</p>
```

### 4.4 带参数的国际化消息


**📝 资源包文件**：
```properties
# messages_zh_CN.properties
user.greeting=你好，{0}！欢迎回来。
order.summary=您的订单 {0} 总金额为 {1}

# messages_en_US.properties
user.greeting=Hello, {0}! Welcome back.
order.summary=Your order {0} total amount is {1}
```

**🔸 JSP中使用**：
```jsp
<fmt:message key="user.greeting">
    <fmt:param value="${user.name}"/>
</fmt:message>

<fmt:message key="order.summary">
    <fmt:param value="${order.orderNo}"/>
    <fmt:param><fmt:formatNumber value="${order.totalAmount}" type="currency"/></fmt:param>
</fmt:message>
```

---

## 5. 🌐 时区处理


### 5.1 时区问题的理解


**为什么需要时区处理**：
```
服务器在北京（东八区）：2024-09-24 15:30:00
美国用户看到应该是：2024-09-24 03:30:00
日本用户看到应该是：2024-09-24 16:30:00
```

**时区的本质**：同一个时刻，不同地区显示的时间不同

### 5.2 设置时区


**🔸 设置当前时区**
```jsp
<fmt:setTimeZone value="Asia/Shanghai"/>    <!-- 中国时区 -->
<fmt:setTimeZone value="America/New_York"/> <!-- 美国东部时区 -->
<fmt:setTimeZone value="Europe/London"/>    <!-- 英国时区 -->
```

**🔸 在特定时区下格式化时间**
```jsp
<!-- 设置时区变量 -->
<fmt:setTimeZone value="America/New_York" var="nyTimeZone"/>

<!-- 使用指定时区格式化 -->
<fmt:formatDate value="${currentDate}" pattern="yyyy-MM-dd HH:mm:ss" timeZone="${nyTimeZone}"/>
```

### 5.3 实际应用场景


**📱 全球用户的活动时间显示**：
```jsp
<c:forEach var="activity" items="${activityList}">
    <div class="activity-item">
        <h4>${activity.title}</h4>
        <p class="time-info">
            <!-- 显示用户当地时间 -->
            开始时间：
            <fmt:formatDate value="${activity.startTime}" 
                           pattern="MM月dd日 HH:mm" 
                           timeZone="${userTimeZone}"/>
        </p>
    </div>
</c:forEach>
```

**⏰ 会议系统时区转换**：
```jsp
<div class="meeting-info">
    <h3>${meeting.title}</h3>
    <div class="time-zones">
        <p>北京时间：
            <fmt:setTimeZone value="Asia/Shanghai"/>
            <fmt:formatDate value="${meeting.startTime}" pattern="HH:mm"/>
        </p>
        <p>纽约时间：
            <fmt:setTimeZone value="America/New_York"/>
            <fmt:formatDate value="${meeting.startTime}" pattern="HH:mm"/>
        </p>
        <p>伦敦时间：
            <fmt:setTimeZone value="Europe/London"/>
            <fmt:formatDate value="${meeting.startTime}" pattern="HH:mm"/>
        </p>
    </div>
</div>
```

---

## 6. 🚀 实战应用场景


### 6.1 电商网站商品展示页


```jsp
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>

<!-- 设置用户地区 -->
<fmt:setLocale value="${user.locale}"/>

<div class="product-list">
    <c:forEach var="product" items="${productList}">
        <div class="product-card">
            <img src="${product.imageUrl}" alt="${product.name}">
            <h3>${product.name}</h3>
            
            <!-- 价格格式化 -->
            <p class="price">
                <span class="current-price">
                    <fmt:formatNumber value="${product.price}" type="currency"/>
                </span>
                <c:if test="${product.originalPrice > product.price}">
                    <span class="original-price">
                        <fmt:formatNumber value="${product.originalPrice}" type="currency"/>
                    </span>
                </c:if>
            </p>
            
            <!-- 折扣显示 -->
            <c:if test="${product.discountRate > 0}">
                <span class="discount">
                    <fmt:formatNumber value="${product.discountRate}" type="percent"/>优惠
                </span>
            </c:if>
            
            <!-- 上架时间 -->
            <p class="publish-time">
                上架时间：<fmt:formatDate value="${product.publishTime}" pattern="yyyy-MM-dd"/>
            </p>
        </div>
    </c:forEach>
</div>
```

### 6.2 用户订单管理页面


```jsp
<div class="order-management">
    <h2>我的订单</h2>
    
    <table class="order-table">
        <thead>
            <tr>
                <th>订单号</th>
                <th>下单时间</th>
                <th>订单金额</th>
                <th>状态</th>
            </tr>
        </thead>
        <tbody>
            <c:forEach var="order" items="${orderList}">
                <tr>
                    <td>${order.orderNo}</td>
                    <td>
                        <fmt:formatDate value="${order.createTime}" 
                                       pattern="yyyy年MM月dd日 HH:mm"/>
                    </td>
                    <td class="amount">
                        <fmt:formatNumber value="${order.totalAmount}" type="currency"/>
                    </td>
                    <td>
                        <span class="status-${order.status}">${order.statusName}</span>
                    </td>
                </tr>
            </c:forEach>
        </tbody>
    </table>
</div>
```

### 6.3 多语言支持的用户中心


```jsp
<!-- 根据用户选择的语言设置地区 -->
<fmt:setLocale value="${sessionScope.userLanguage}"/>
<fmt:setBundle basename="messages"/>

<div class="user-center">
    <h1><fmt:message key="user.center.title"/></h1>
    
    <div class="user-info">
        <h3><fmt:message key="user.basic.info"/></h3>
        <p>
            <fmt:message key="user.register.date"/>：
            <fmt:formatDate value="${user.registerDate}" type="date" dateStyle="medium"/>
        </p>
        <p>
            <fmt:message key="user.last.login"/>：
            <fmt:formatDate value="${user.lastLoginTime}" 
                           pattern="yyyy-MM-dd HH:mm"
                           timeZone="${user.timeZone}"/>
        </p>
    </div>
    
    <div class="account-summary">
        <h3><fmt:message key="account.summary"/></h3>
        <p>
            <fmt:message key="account.balance"/>：
            <fmt:formatNumber value="${user.accountBalance}" type="currency"/>
        </p>
        <p>
            <fmt:message key="total.spending"/>：
            <fmt:formatNumber value="${user.totalSpending}" type="currency"/>
        </p>
    </div>
</div>
```

---

## 7. 📋 核心要点总结


### 7.1 必须掌握的核心标签


```
🔸 <fmt:formatDate>：日期时间格式化，让日期显示更友好
🔸 <fmt:formatNumber>：数字格式化，支持货币、百分比等格式
🔸 <fmt:setLocale>：设置地区，影响格式化的显示效果
🔸 <fmt:setTimeZone>：设置时区，处理全球用户的时间显示
🔸 <fmt:message>：国际化消息，支持多语言网站
```

### 7.2 关键理解要点


**🔹 格式化标签的价值**
```
解决问题：
• 原始数据对用户不友好
• 不同地区用户需要不同的格式
• 减少在Java代码中处理格式化逻辑

核心优势：
• 在JSP页面直接处理，代码更清晰
• 支持国际化，一套代码适应多个地区
• 提供丰富的格式化选项
```

**🔹 国际化的重要性**
```
现实需求：
• 网站面向全球用户
• 不同国家有不同的数字、日期格式习惯
• 多语言支持是必需的

解决方案：
• 使用资源包管理多语言文字
• 根据用户地区自动选择合适的格式
• 提供时区转换功能
```

**🔹 实际应用原则**
```
选择合适的格式：
• 日期：根据应用场景选择详细程度
• 数字：根据数据类型选择格式（货币、百分比等）
• 国际化：预先规划支持哪些地区和语言

性能考虑：
• 格式化操作相对轻量，但大量数据时要注意
• 资源包会被缓存，不用担心重复加载
• 时区转换涉及计算，合理使用
```

### 7.3 最佳实践建议


**🎯 开发建议**
- ✅ **统一格式标准**：在项目中制定统一的日期、数字显示格式
- ✅ **国际化预留**：即使暂时只支持一种语言，也要考虑后续扩展
- ✅ **用户体验优先**：格式化的目的是让用户更容易理解
- ✅ **测试不同地区**：确保在不同locale下显示正常

**⚠️ 常见陷阱**
- ❌ **忽略时区问题**：服务器时区和用户时区不一致
- ❌ **硬编码格式**：直接在Java代码中处理格式化
- ❌ **过度格式化**：不必要的地方也进行复杂格式化
- ❌ **资源包管理混乱**：多语言文件维护不及时

**核心记忆口诀**：
- 日期数字要美化，format标签来帮忙
- 多语言网站国际化，locale设置不能忘  
- 时区处理很重要，全球用户要考量
- 用户体验放第一，格式清晰易阅读