---
title: 1ã€SQLæ³¨å…¥é˜²æŠ¤
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯SQLæ³¨å…¥æ”»å‡»](#1-ä»€ä¹ˆæ˜¯SQLæ³¨å…¥æ”»å‡»)
2. [SQLæ³¨å…¥çš„å±å®³ä¸åŸç†](#2-SQLæ³¨å…¥çš„å±å®³ä¸åŸç†)
3. [PreparedStatementé˜²æŠ¤æœºåˆ¶](#3-PreparedStatementé˜²æŠ¤æœºåˆ¶)
4. [å‚æ•°åŒ–æŸ¥è¯¢æœ€ä½³å®è·µ](#4-å‚æ•°åŒ–æŸ¥è¯¢æœ€ä½³å®è·µ)
5. [è¾“å…¥éªŒè¯ä¸è¿‡æ»¤ç­–ç•¥](#5-è¾“å…¥éªŒè¯ä¸è¿‡æ»¤ç­–ç•¥)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ä»€ä¹ˆæ˜¯SQLæ³¨å…¥æ”»å‡»


### 1.1 ç”Ÿæ´»åŒ–ç†è§£SQLæ³¨å…¥


**ğŸ  ç”Ÿæ´»ç±»æ¯”**
```
æƒ³è±¡ä½ å®¶çš„é—¨é”æ˜¯å£°æ§çš„ï¼Œä½ è¯´"å¼€é—¨ï¼Œæˆ‘æ˜¯ä¸»äºº"å°±èƒ½å¼€é—¨
ä½†æ˜¯åäººå­¦ä¼šäº†ä½ çš„è¯ï¼Œä¹Ÿè¯´"å¼€é—¨ï¼Œæˆ‘æ˜¯ä¸»äºº"ï¼Œç»“æœé—¨å°±å¼€äº†
è¿™å°±åƒSQLæ³¨å…¥ï¼šåäºº"ä¼ªè£…"æˆæ­£å¸¸çš„æ•°æ®ï¼Œéª—è¿‡äº†ç³»ç»Ÿ
```

**ğŸ’¡ æŠ€æœ¯å«ä¹‰**
SQLæ³¨å…¥å°±æ˜¯ï¼š**åäººåœ¨æ­£å¸¸çš„è¾“å…¥æ¡†é‡Œï¼Œå·å·å¡è¿›äº†SQLä»£ç ï¼Œè®©ä½ çš„ç¨‹åºæ‰§è¡Œäº†ä¸è¯¥æ‰§è¡Œçš„æ•°æ®åº“æ“ä½œ**

### 1.2 SQLæ³¨å…¥çš„ç®€å•ä¾‹å­


**ğŸ­ åœºæ™¯æ¼”ç¤ºï¼šç”¨æˆ·ç™»å½•**
```
æ­£å¸¸æƒ…å†µï¼š
ç”¨æˆ·è¾“å…¥ï¼šç”¨æˆ·å: admin    å¯†ç : 123456
ç¨‹åºç”ŸæˆSQLï¼šSELECT * FROM users WHERE name='admin' AND password='123456'
ç»“æœï¼šæ­£å¸¸ç™»å½•

æ¶æ„æ³¨å…¥ï¼š
ç”¨æˆ·è¾“å…¥ï¼šç”¨æˆ·å: admin' --    å¯†ç : éšä¾¿è¾“å…¥
ç¨‹åºç”ŸæˆSQLï¼šSELECT * FROM users WHERE name='admin' --' AND password='éšä¾¿è¾“å…¥'
ç»“æœï¼š-- åé¢çš„å†…å®¹è¢«æ³¨é‡Šæ‰äº†ï¼Œä¸éœ€è¦å¯†ç å°±èƒ½ç™»å½•ï¼
```

**âš ï¸ é—®é¢˜æœ¬è´¨**
ç¨‹åºæŠŠç”¨æˆ·è¾“å…¥çš„å†…å®¹**ç›´æ¥æ‹¼æ¥**åˆ°SQLè¯­å¥é‡Œï¼Œæ²¡æœ‰åŒºåˆ†"æ•°æ®"å’Œ"SQLä»£ç "

### 1.3 ä¸ºä»€ä¹ˆä¼šå‘ç”ŸSQLæ³¨å…¥


**âŒ å±é™©çš„åšæ³•**
```java
// è¿™æ ·å†™æ˜¯éå¸¸å±é™©çš„ï¼
String username = request.getParameter("username");
String password = request.getParameter("password");

// ç›´æ¥æ‹¼æ¥ç”¨æˆ·è¾“å…¥ - è¿™å°±æ˜¯é—®é¢˜æ‰€åœ¨ï¼
String sql = "SELECT * FROM users WHERE name='" + username + 
             "' AND password='" + password + "'";
```

**ğŸ” é—®é¢˜åˆ†æ**
1. **å­—ç¬¦ä¸²æ‹¼æ¥**ï¼šæŠŠç”¨æˆ·è¾“å…¥ç›´æ¥åŠ åˆ°SQLé‡Œ
2. **æ²¡æœ‰éªŒè¯**ï¼šä¸æ£€æŸ¥ç”¨æˆ·è¾“å…¥æ˜¯å¦åˆæ³•
3. **æ²¡æœ‰è½¬ä¹‰**ï¼šç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚å•å¼•å·ï¼‰æ²¡æœ‰å¤„ç†
4. **æƒé™è¿‡å¤§**ï¼šæ•°æ®åº“è´¦å·æƒé™å¤ªé«˜

---

## 2. âš ï¸ SQLæ³¨å…¥çš„å±å®³ä¸åŸç†


### 2.1 SQLæ³¨å…¥èƒ½é€ æˆä»€ä¹ˆæŸå¤±


**ğŸ’€ ä¸»è¦å±å®³**

| å±å®³ç±»å‹ | **å…·ä½“å½±å“** | **å®ä¾‹è¯´æ˜** |
|---------|-------------|-------------|
| ğŸ”“ **ç»•è¿‡ç™»å½•** | `ä¸éœ€è¦å¯†ç ç›´æ¥ç™»å½•` | `é»‘å®¢å†’å……ç®¡ç†å‘˜è¿›å…¥ç³»ç»Ÿ` |
| ğŸ“‚ **æ•°æ®æ³„éœ²** | `å·å–æ•æ„Ÿä¿¡æ¯` | `è·å–ç”¨æˆ·å¯†ç ã€é“¶è¡Œå¡å·ç­‰` |
| ğŸ—‘ï¸ **æ•°æ®ç ´å** | `åˆ é™¤æˆ–ä¿®æ”¹æ•°æ®` | `åˆ é™¤æ•´ä¸ªç”¨æˆ·è¡¨` |
| ğŸ‘‘ **æƒé™æå‡** | `è·å¾—ç®¡ç†å‘˜æƒé™` | `æ™®é€šç”¨æˆ·å˜æˆè¶…çº§ç®¡ç†å‘˜` |
| ğŸ’» **ç³»ç»Ÿæ§åˆ¶** | `æ‰§è¡Œç³»ç»Ÿå‘½ä»¤` | `åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…åé—¨ç¨‹åº` |

### 2.2 å¸¸è§çš„SQLæ³¨å…¥ç±»å‹


**ğŸ”¸ è”åˆæŸ¥è¯¢æ³¨å…¥**
```sql
-- æ­£å¸¸æŸ¥è¯¢ï¼šæŸ¥æ‰¾æŒ‡å®šç”¨æˆ·
SELECT * FROM users WHERE id = 1

-- æ¶æ„æ³¨å…¥ï¼šè·å–æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯
SELECT * FROM users WHERE id = 1 UNION SELECT username,password FROM admin_users
```

**ğŸ”¸ å¸ƒå°”ç›²æ³¨**
```sql
-- é€šè¿‡çœŸå‡åˆ¤æ–­æ¥çŒœæµ‹æ•°æ®åº“å†…å®¹
SELECT * FROM users WHERE id = 1 AND 1=1  -- è¿”å›ç»“æœï¼ˆçœŸï¼‰
SELECT * FROM users WHERE id = 1 AND 1=2  -- æ— ç»“æœï¼ˆå‡ï¼‰
-- é»‘å®¢é€šè¿‡è¿™ç§æ–¹å¼ä¸€ç‚¹ç‚¹çŒœå‡ºæ•°æ®åº“ç»“æ„
```

**ğŸ”¸ æ—¶é—´ç›²æ³¨**
```sql
-- é€šè¿‡å»¶æ—¶æ¥åˆ¤æ–­æ¡ä»¶æ˜¯å¦æˆç«‹
SELECT * FROM users WHERE id = 1 AND SLEEP(5)  -- å¦‚æœæ¡ä»¶æˆç«‹ï¼Œé¡µé¢å»¶è¿Ÿ5ç§’
```

### 2.3 SQLæ³¨å…¥æ”»å‡»æµç¨‹


**ğŸ”„ æ”»å‡»æ­¥éª¤å›¾**
```
ç¬¬1æ­¥ï¼šä¿¡æ¯æ”¶é›†
   â†“
é»‘å®¢æµ‹è¯•è¾“å…¥æ¡† â†’ å¯»æ‰¾æ³¨å…¥ç‚¹ â†’ åˆ¤æ–­æ•°æ®åº“ç±»å‹
   â†“
ç¬¬2æ­¥ï¼šæ¼æ´åˆ©ç”¨
   â†“
æ„é€ æ¶æ„SQL â†’ ç»•è¿‡éªŒè¯ â†’ è·å–æ•æ„Ÿæ•°æ®
   â†“
ç¬¬3æ­¥ï¼šæƒé™æ‰©å¤§
   â†“
æå‡æƒé™ â†’ æ¤å…¥åé—¨ â†’ é•¿æœŸæ§åˆ¶
```

---

## 3. ğŸ›¡ï¸ PreparedStatementé˜²æŠ¤æœºåˆ¶


### 3.1 ä»€ä¹ˆæ˜¯PreparedStatement


**ğŸ”¸ ç®€å•ç†è§£**
PreparedStatementå°±åƒæ˜¯ä¸€ä¸ª**æ¨¡æ¿**ï¼š
- ä½ å…ˆå®šä¹‰SQLè¯­å¥çš„"æ¡†æ¶"ï¼Œç”¨`?`æ ‡è®°éœ€è¦å¡«å…¥æ•°æ®çš„åœ°æ–¹
- ç„¶åå†æŠŠå…·ä½“çš„æ•°æ®"å®‰å…¨åœ°"å¡«åˆ°`?`ä½ç½®ä¸Š
- è¿™æ ·æ•°æ®å°±æ°¸è¿œæ˜¯æ•°æ®ï¼Œä¸ä¼šè¢«å½“æˆSQLä»£ç æ‰§è¡Œ

### 3.2 PreparedStatement vs Statement


**âš–ï¸ å®‰å…¨æ€§å¯¹æ¯”**

| å¯¹æ¯”é¡¹ | **Statement** | **PreparedStatement** |
|-------|---------------|---------------------|
| ğŸ”’ **å®‰å…¨æ€§** | `å®¹æ˜“SQLæ³¨å…¥` | `æœ‰æ•ˆé˜²æ­¢SQLæ³¨å…¥` |
| âš¡ **æ€§èƒ½** | `æ¯æ¬¡éƒ½è¦ç¼–è¯‘SQL` | `é¢„ç¼–è¯‘ï¼Œæ‰§è¡Œå¿«` |
| ğŸ’» **æ˜“ç”¨æ€§** | `å­—ç¬¦ä¸²æ‹¼æ¥éº»çƒ¦` | `å‚æ•°è®¾ç½®ç®€å•` |
| ğŸ¯ **æ¨èåº¦** | `ä¸æ¨èä½¿ç”¨` | `å¼ºçƒˆæ¨è` |

**ğŸ”´ å±é™©çš„Statementç”¨æ³•**
```java
// âŒ ä¸å®‰å…¨çš„åšæ³• - åƒä¸‡åˆ«è¿™æ ·å†™ï¼
String sql = "SELECT * FROM users WHERE name='" + username + "'";
Statement stmt = conn.createStatement();
ResultSet rs = stmt.executeQuery(sql);
```

**ğŸŸ¢ å®‰å…¨çš„PreparedStatementç”¨æ³•**
```java
// âœ… å®‰å…¨çš„åšæ³• - æ¨èè¿™æ ·å†™
String sql = "SELECT * FROM users WHERE name=? AND password=?";
PreparedStatement pstmt = conn.prepareStatement(sql);
pstmt.setString(1, username);    // ç¬¬1ä¸ª?çš„å€¼
pstmt.setString(2, password);    // ç¬¬2ä¸ª?çš„å€¼
ResultSet rs = pstmt.executeQuery();
```

### 3.3 PreparedStatementå·¥ä½œåŸç†


**ğŸ”§ å·¥ä½œæœºåˆ¶å›¾**
```
ç”¨æˆ·è¾“å…¥: admin' OR '1'='1
       â†“
PreparedStatementå¤„ç†è¿‡ç¨‹:
       â†“
ç¬¬1æ­¥: SQLæ¨¡æ¿ â†’ SELECT * FROM users WHERE name=? AND password=?
ç¬¬2æ­¥: å‚æ•°ç»‘å®š â†’ æŠŠ "admin' OR '1'='1" å½“ä½œæ™®é€šå­—ç¬¦ä¸²
ç¬¬3æ­¥: å®‰å…¨æ‰§è¡Œ â†’ æŸ¥æ‰¾ç”¨æˆ·åä¸º "admin' OR '1'='1" çš„ç”¨æˆ·ï¼ˆå½“ç„¶æ‰¾ä¸åˆ°ï¼‰
       â†“
ç»“æœ: æ”»å‡»å¤±è´¥ï¼Œç³»ç»Ÿå®‰å…¨ï¼
```

**ğŸ’¡ å…³é”®ç†è§£**
- PreparedStatementæŠŠSQLè¯­å¥å’Œå‚æ•°**åˆ†å¼€å¤„ç†**
- å‚æ•°æ°¸è¿œè¢«å½“ä½œ**æ•°æ®**ï¼Œä¸ä¼šè¢«å½“ä½œ**SQLä»£ç **
- å°±ç®—å‚æ•°é‡Œæœ‰SQLå…³é”®å­—ï¼Œä¹Ÿåªæ˜¯æ™®é€šæ–‡å­—

### 3.4 PreparedStatementå®è·µç¤ºä¾‹


**ğŸ¯ ç”¨æˆ·ç™»å½•å®‰å…¨å®ç°**
```java
public class UserLoginDAO {
    
    // âœ… å®‰å…¨çš„ç™»å½•éªŒè¯æ–¹æ³•
    public User login(String username, String password) {
        String sql = "SELECT id, username, role FROM users WHERE username=? AND password=?";
        
        try (PreparedStatement pstmt = connection.prepareStatement(sql)) {
            // è®¾ç½®å‚æ•° - ä»»ä½•è¾“å…¥éƒ½ä¼šè¢«å½“ä½œæ™®é€šå­—ç¬¦ä¸²
            pstmt.setString(1, username);
            pstmt.setString(2, password);
            
            ResultSet rs = pstmt.executeQuery();
            
            if (rs.next()) {
                User user = new User();
                user.setId(rs.getInt("id"));
                user.setUsername(rs.getString("username"));
                user.setRole(rs.getString("role"));
                return user;
            }
        } catch (SQLException e) {
            logger.error("ç™»å½•æŸ¥è¯¢å¤±è´¥", e);
        }
        
        return null;  // ç™»å½•å¤±è´¥
    }
}
```

---

## 4. ğŸ” å‚æ•°åŒ–æŸ¥è¯¢æœ€ä½³å®è·µ


### 4.1 å„ç§æ•°æ®ç±»å‹çš„å‚æ•°è®¾ç½®


**ğŸ“‹ å‚æ•°ç±»å‹å¯¹ç…§è¡¨**

| Javaç±»å‹ | **PreparedStatementæ–¹æ³•** | **ä½¿ç”¨ç¤ºä¾‹** |
|----------|-------------------------|-------------|
| `String` | `setString(ä½ç½®, å€¼)` | `pstmt.setString(1, "å¼ ä¸‰")` |
| `int` | `setInt(ä½ç½®, å€¼)` | `pstmt.setInt(2, 25)` |
| `long` | `setLong(ä½ç½®, å€¼)` | `pstmt.setLong(3, 1000L)` |
| `double` | `setDouble(ä½ç½®, å€¼)` | `pstmt.setDouble(4, 99.5)` |
| `Date` | `setTimestamp(ä½ç½®, å€¼)` | `pstmt.setTimestamp(5, new Timestamp(date.getTime()))` |
| `boolean` | `setBoolean(ä½ç½®, å€¼)` | `pstmt.setBoolean(6, true)` |

### 4.2 å¤æ‚æŸ¥è¯¢çš„å‚æ•°åŒ–å¤„ç†


**ğŸ” æ¨¡ç³ŠæŸ¥è¯¢**
```java
// âœ… æ­£ç¡®çš„æ¨¡ç³ŠæŸ¥è¯¢å†™æ³•
public List<User> searchUsers(String keyword) {
    String sql = "SELECT * FROM users WHERE username LIKE ?";
    
    try (PreparedStatement pstmt = connection.prepareStatement(sql)) {
        // åœ¨Javaä»£ç ä¸­å¤„ç†é€šé…ç¬¦ï¼Œè€Œä¸æ˜¯åœ¨SQLä¸­æ‹¼æ¥
        pstmt.setString(1, "%" + keyword + "%");
        
        ResultSet rs = pstmt.executeQuery();
        // å¤„ç†ç»“æœ...
    }
}
```

**ğŸ“Š INå­å¥å¤„ç†**
```java
// âœ… å¤„ç†å¤šä¸ªIDæŸ¥è¯¢
public List<User> getUsersByIds(List<Integer> userIds) {
    if (userIds.isEmpty()) return new ArrayList<>();
    
    // æ ¹æ®å‚æ•°ä¸ªæ•°åŠ¨æ€æ„å»ºSQL
    StringBuilder sql = new StringBuilder("SELECT * FROM users WHERE id IN (");
    for (int i = 0; i < userIds.size(); i++) {
        sql.append("?");
        if (i < userIds.size() - 1) sql.append(",");
    }
    sql.append(")");
    
    try (PreparedStatement pstmt = connection.prepareStatement(sql.toString())) {
        // è®¾ç½®æ¯ä¸ªå‚æ•°
        for (int i = 0; i < userIds.size(); i++) {
            pstmt.setInt(i + 1, userIds.get(i));
        }
        
        ResultSet rs = pstmt.executeQuery();
        // å¤„ç†ç»“æœ...
    }
}
```

### 4.3 åŠ¨æ€SQLçš„å®‰å…¨æ„å»º


**ğŸ¯ æ¡ä»¶æŸ¥è¯¢ç¤ºä¾‹**
```java
public List<User> searchUsers(String name, Integer age, String role) {
    StringBuilder sql = new StringBuilder("SELECT * FROM users WHERE 1=1");
    List<Object> params = new ArrayList<>();
    
    // åŠ¨æ€æ·»åŠ æŸ¥è¯¢æ¡ä»¶
    if (name != null && !name.trim().isEmpty()) {
        sql.append(" AND username LIKE ?");
        params.add("%" + name + "%");
    }
    
    if (age != null) {
        sql.append(" AND age = ?");
        params.add(age);
    }
    
    if (role != null && !role.trim().isEmpty()) {
        sql.append(" AND role = ?");
        params.add(role);
    }
    
    try (PreparedStatement pstmt = connection.prepareStatement(sql.toString())) {
        // è®¾ç½®æ‰€æœ‰å‚æ•°
        for (int i = 0; i < params.size(); i++) {
            pstmt.setObject(i + 1, params.get(i));
        }
        
        ResultSet rs = pstmt.executeQuery();
        // å¤„ç†ç»“æœ...
    }
}
```

---

## 5. ğŸ›¡ï¸ è¾“å…¥éªŒè¯ä¸è¿‡æ»¤ç­–ç•¥


### 5.1 è¾“å…¥éªŒè¯çš„é‡è¦æ€§


**ğŸ”¸ é˜²æŠ¤å±‚æ¬¡å›¾**
```
ç”¨æˆ·è¾“å…¥
    â†“
ç¬¬1å±‚ï¼šå‰ç«¯éªŒè¯ (JavaScript)     â† ç”¨æˆ·ä½“éªŒï¼Œå¯ä»¥ç»•è¿‡
    â†“
ç¬¬2å±‚ï¼šåç«¯éªŒè¯ (Java)          â† æ ¸å¿ƒé˜²æŠ¤ï¼Œå¿…é¡»æœ‰
    â†“
ç¬¬3å±‚ï¼šå‚æ•°åŒ–æŸ¥è¯¢               â† æœ€åä¸€é“é˜²çº¿
    â†“
æ•°æ®åº“
```

**ğŸ’¡ å…³é”®ç†è§£**
- **å‰ç«¯éªŒè¯**ï¼šä¸»è¦ä¸ºäº†ç”¨æˆ·ä½“éªŒï¼Œé˜²å›å­ä¸é˜²å°äºº
- **åç«¯éªŒè¯**ï¼šçœŸæ­£çš„å®‰å…¨é˜²æŠ¤ï¼Œç»å¯¹ä¸èƒ½çœ
- **å‚æ•°åŒ–æŸ¥è¯¢**ï¼šå³ä½¿å‰é¢éªŒè¯æœ‰æ¼æ´ï¼Œè¿™é‡Œä¹Ÿèƒ½æ‹¦ä½

### 5.2 è¾“å…¥éªŒè¯ç­–ç•¥


**ğŸ“‹ éªŒè¯æ£€æŸ¥æ¸…å•**

| éªŒè¯ç±»å‹ | **æ£€æŸ¥å†…å®¹** | **å®ç°æ–¹å¼** |
|---------|-------------|-------------|
| ğŸ”¢ **é•¿åº¦éªŒè¯** | `å­—ç¬¦ä¸²ä¸èƒ½å¤ªé•¿` | `if (input.length() > 50) æ‹’ç»` |
| ğŸ”¤ **æ ¼å¼éªŒè¯** | `é‚®ç®±ã€ç”µè¯å·ç æ ¼å¼` | `æ­£åˆ™è¡¨è¾¾å¼éªŒè¯` |
| ğŸ“ **å­—ç¬¦é›†éªŒè¯** | `åªå…è®¸ç‰¹å®šå­—ç¬¦` | `ç™½åå•è¿‡æ»¤` |
| ğŸš« **é»‘åå•è¿‡æ»¤** | `æ‹’ç»å±é™©å­—ç¬¦` | `æ£€æµ‹SQLå…³é”®å­—` |
| ğŸ¯ **ä¸šåŠ¡é€»è¾‘éªŒè¯** | `æ•°æ®åˆç†æ€§` | `å¹´é¾„ä¸èƒ½æ˜¯è´Ÿæ•°` |

### 5.3 ç™½åå•è¿‡æ»¤å®ç°


**âœ… æ¨èåšæ³•ï¼šç™½åå•éªŒè¯**
```java
public class InputValidator {
    
    // ç”¨æˆ·ååªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿
    public static boolean isValidUsername(String username) {
        if (username == null || username.trim().isEmpty()) {
            return false;
        }
        
        // é•¿åº¦æ£€æŸ¥
        if (username.length() < 3 || username.length() > 20) {
            return false;
        }
        
        // å­—ç¬¦é›†æ£€æŸ¥ï¼šåªå…è®¸å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿
        return username.matches("^[a-zA-Z0-9_]+$");
    }
    
    // é‚®ç®±æ ¼å¼éªŒè¯
    public static boolean isValidEmail(String email) {
        if (email == null || email.trim().isEmpty()) {
            return false;
        }
        
        String emailPattern = "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$";
        return email.matches(emailPattern);
    }
    
    // å¹´é¾„éªŒè¯
    public static boolean isValidAge(Integer age) {
        return age != null && age >= 0 && age <= 150;
    }
}
```

### 5.4 SQLå…³é”®å­—é»‘åå•æ£€æµ‹


**âš ï¸ è¾…åŠ©é˜²æŠ¤ï¼šå±é™©å­—ç¬¦æ£€æµ‹**
```java
public class SQLInjectionDetector {
    
    // å¸¸è§SQLæ³¨å…¥å…³é”®å­—
    private static final String[] DANGEROUS_WORDS = {
        "SELECT", "INSERT", "UPDATE", "DELETE", "DROP", "CREATE",
        "ALTER", "EXEC", "EXECUTE", "UNION", "SCRIPT",
        "--", "/*", "*/", ";", "'", "\""
    };
    
    public static boolean containsSQLKeywords(String input) {
        if (input == null) return false;
        
        String upperInput = input.toUpperCase();
        for (String keyword : DANGEROUS_WORDS) {
            if (upperInput.contains(keyword)) {
                return true;
            }
        }
        return false;
    }
    
    // ä½¿ç”¨ç¤ºä¾‹
    public static String sanitizeInput(String input) {
        if (input == null) return null;
        
        // æ£€æµ‹å±é™©å­—ç¬¦
        if (containsSQLKeywords(input)) {
            throw new IllegalArgumentException("è¾“å…¥åŒ…å«éæ³•å­—ç¬¦ï¼");
        }
        
        // å»é™¤é¦–å°¾ç©ºæ ¼
        return input.trim();
    }
}
```

### 5.5 ç»¼åˆé˜²æŠ¤ç¤ºä¾‹


**ğŸ¯ å®Œæ•´çš„å®‰å…¨ç™»å½•å®ç°**
```java
@WebServlet("/login")
public class LoginServlet extends HttpServlet {
    
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        String username = request.getParameter("username");
        String password = request.getParameter("password");
        
        try {
            // ç¬¬1æ­¥ï¼šè¾“å…¥éªŒè¯
            validateLoginInput(username, password);
            
            // ç¬¬2æ­¥ï¼šå®‰å…¨æŸ¥è¯¢
            User user = userDAO.login(username, password);
            
            if (user != null) {
                // ç™»å½•æˆåŠŸ
                HttpSession session = request.getSession();
                session.setAttribute("user", user);
                response.sendRedirect("dashboard.jsp");
            } else {
                // ç™»å½•å¤±è´¥
                request.setAttribute("error", "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯");
                request.getRequestDispatcher("login.jsp").forward(request, response);
            }
            
        } catch (IllegalArgumentException e) {
            // éªŒè¯å¤±è´¥
            request.setAttribute("error", e.getMessage());
            request.getRequestDispatcher("login.jsp").forward(request, response);
        }
    }
    
    private void validateLoginInput(String username, String password) {
        // ç©ºå€¼æ£€æŸ¥
        if (username == null || username.trim().isEmpty()) {
            throw new IllegalArgumentException("ç”¨æˆ·åä¸èƒ½ä¸ºç©º");
        }
        if (password == null || password.trim().isEmpty()) {
            throw new IllegalArgumentException("å¯†ç ä¸èƒ½ä¸ºç©º");
        }
        
        // é•¿åº¦æ£€æŸ¥
        if (username.length() > 50) {
            throw new IllegalArgumentException("ç”¨æˆ·åå¤ªé•¿");
        }
        if (password.length() > 100) {
            throw new IllegalArgumentException("å¯†ç å¤ªé•¿");
        }
        
        // æ ¼å¼éªŒè¯
        if (!InputValidator.isValidUsername(username)) {
            throw new IllegalArgumentException("ç”¨æˆ·åæ ¼å¼ä¸æ­£ç¡®");
        }
        
        // SQLæ³¨å…¥æ£€æµ‹
        if (SQLInjectionDetector.containsSQLKeywords(username) ||
            SQLInjectionDetector.containsSQLKeywords(password)) {
            throw new IllegalArgumentException("è¾“å…¥åŒ…å«éæ³•å­—ç¬¦");
        }
    }
}
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ SQLæ³¨å…¥æœ¬è´¨ï¼šæŠŠç”¨æˆ·è¾“å…¥å½“ä½œSQLä»£ç æ‰§è¡Œ
ğŸ”¸ æ ¹æœ¬åŸå› ï¼šå­—ç¬¦ä¸²æ‹¼æ¥SQLï¼Œæ²¡æœ‰åŒºåˆ†æ•°æ®å’Œä»£ç 
ğŸ”¸ é˜²æŠ¤æ ¸å¿ƒï¼šä½¿ç”¨PreparedStatementå‚æ•°åŒ–æŸ¥è¯¢
ğŸ”¸ éªŒè¯ç­–ç•¥ï¼šå‰ç«¯éªŒè¯+åç«¯éªŒè¯+å‚æ•°åŒ–æŸ¥è¯¢ä¸‰å±‚é˜²æŠ¤
ğŸ”¸ æœ€ä½³å®è·µï¼šç™½åå•éªŒè¯ä¼˜äºé»‘åå•è¿‡æ»¤
```

### 6.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆPreparedStatementå®‰å…¨**
```
å…³é”®æœºåˆ¶ï¼š
- SQLæ¨¡æ¿ä¸å‚æ•°åˆ†ç¦»å¤„ç†
- å‚æ•°æ°¸è¿œè¢«å½“ä½œæ•°æ®ï¼Œä¸ä¼šå½“ä½œä»£ç 
- é¢„ç¼–è¯‘æœºåˆ¶é˜²æ­¢ä»£ç æ³¨å…¥
- ç±»å‹å®‰å…¨çš„å‚æ•°ç»‘å®š
```

**ğŸ”¹ è¾“å…¥éªŒè¯çš„æ­£ç¡®æ€è·¯**
```
éªŒè¯åŸåˆ™ï¼š
- æ°¸è¿œä¸ä¿¡ä»»ç”¨æˆ·è¾“å…¥
- å‰ç«¯éªŒè¯æ˜¯ä½“éªŒï¼Œåç«¯éªŒè¯æ˜¯å®‰å…¨
- ç™½åå•æ¯”é»‘åå•æ›´å®‰å…¨
- å¤šå±‚é˜²æŠ¤æ¯”å•ä¸€é˜²æŠ¤æ›´å¯é 
```

**ğŸ”¹ å¼€å‘ä¸­çš„æ³¨æ„äº‹é¡¹**
```
å®è·µè¦ç‚¹ï¼š
- ç»å¯¹ä¸è¦ç”¨å­—ç¬¦ä¸²æ‹¼æ¥SQL
- æ¯ä¸ªå‚æ•°éƒ½è¦ç»è¿‡éªŒè¯
- æ•°æ®åº“è´¦å·æƒé™æœ€å°åŒ–
- è®°å½•å¹¶ç›‘æ§å¼‚å¸¸è®¿é—®
```

### 6.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ å¼€å‘æ£€æŸ¥æ¸…å•**
- âœ… æ‰€æœ‰SQLæŸ¥è¯¢éƒ½ç”¨PreparedStatement
- âœ… ç”¨æˆ·è¾“å…¥éƒ½ç»è¿‡éªŒè¯å’Œè¿‡æ»¤  
- âœ… é”™è¯¯ä¿¡æ¯ä¸æ³„éœ²ç³»ç»Ÿä¿¡æ¯
- âœ… æ•°æ®åº“è¿æ¥è´¦å·æƒé™æœ€å°
- âœ… å®šæœŸè¿›è¡Œå®‰å…¨æµ‹è¯•

**ğŸ“š å­¦ä¹ å»ºè®®**
- **ç†è§£åŸç†**ï¼šçŸ¥é“SQLæ³¨å…¥æ˜¯æ€ä¹ˆå‘ç”Ÿçš„
- **æŒæ¡é˜²æŠ¤**ï¼šä¼šæ­£ç¡®ä½¿ç”¨PreparedStatement
- **å…»æˆä¹ æƒ¯**ï¼šæ¯æ¬¡å†™æ•°æ®åº“ä»£ç éƒ½è€ƒè™‘å®‰å…¨æ€§
- **æŒç»­å­¦ä¹ **ï¼šäº†è§£æœ€æ–°çš„å®‰å…¨å¨èƒå’Œé˜²æŠ¤æ–¹æ³•

**âš ï¸ å¸¸è§è¯¯åŒº**
```
âŒ è®¤ä¸ºå‰ç«¯éªŒè¯å°±å¤Ÿäº†
âŒ åªè¿‡æ»¤å•å¼•å·ï¼Œå¿½ç•¥å…¶ä»–å±é™©å­—ç¬¦
âŒ ä»¥ä¸ºç”¨äº†PreparedStatementå°±ä¸‡æ— ä¸€å¤±
âŒ é”™è¯¯ä¿¡æ¯æš´éœ²å¤ªå¤šç³»ç»Ÿç»†èŠ‚
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- **SQLæ³¨å…¥** = ç”¨æˆ·è¾“å…¥å˜æˆäº†SQLä»£ç 
- **PreparedStatement** = æ•°æ®å’Œä»£ç åˆ†å¼€å¤„ç†
- **è¾“å…¥éªŒè¯** = å¤šå±‚é˜²æŠ¤ï¼Œç™½åå•ä¼˜å…ˆ
- **å®‰å…¨æ„è¯†** = æ°¸è¿œä¸ä¿¡ä»»ç”¨æˆ·è¾“å…¥