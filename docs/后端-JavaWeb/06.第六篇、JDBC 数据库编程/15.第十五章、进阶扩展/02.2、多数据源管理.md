---
title: 2ã€å¤šæ•°æ®æºç®¡ç†
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯å¤šæ•°æ®æºç®¡ç†](#1-ä»€ä¹ˆæ˜¯å¤šæ•°æ®æºç®¡ç†)
2. [ä¸ºä»€ä¹ˆéœ€è¦å¤šæ•°æ®æº](#2-ä¸ºä»€ä¹ˆéœ€è¦å¤šæ•°æ®æº)
3. [å¤šæ•°æ®æºé…ç½®å®ç°](#3-å¤šæ•°æ®æºé…ç½®å®ç°)
4. [åŠ¨æ€æ•°æ®æºåˆ‡æ¢](#4-åŠ¨æ€æ•°æ®æºåˆ‡æ¢)
5. [è¯»å†™åˆ†ç¦»æ¦‚å¿µä¸å®ç°](#5-è¯»å†™åˆ†ç¦»æ¦‚å¿µä¸å®ç°)
6. [ä¸»ä»æ•°æ®åº“æ¶æ„](#6-ä¸»ä»æ•°æ®åº“æ¶æ„)
7. [è·¯ç”±ç­–ç•¥è®¾è®¡](#7-è·¯ç”±ç­–ç•¥è®¾è®¡)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ä»€ä¹ˆæ˜¯å¤šæ•°æ®æºç®¡ç†


### 1.1 åŸºæœ¬æ¦‚å¿µç†è§£


**ğŸ”¸ ç®€å•ç†è§£ï¼šå°±åƒä½¿ç”¨å¤šä¸ªä»“åº“**

æƒ³è±¡ä½ å¼€äº†ä¸€å®¶è¶…å¸‚ï¼Œæœ‰å¥½å‡ ä¸ªä»“åº“ï¼š
- ä¸»ä»“åº“ï¼šå­˜æ”¾æ—¥ç”¨å“
- å†·è—ä»“åº“ï¼šå­˜æ”¾ç”Ÿé²œé£Ÿå“  
- ç‰¹æ®Šä»“åº“ï¼šå­˜æ”¾è´µé‡å•†å“

å¤šæ•°æ®æºå°±æ˜¯è¿™æ ·ï¼Œä¸€ä¸ªåº”ç”¨ç¨‹åºè¿æ¥å¤šä¸ªæ•°æ®åº“ï¼Œæ¯ä¸ªæ•°æ®åº“å­˜å‚¨ä¸åŒç±»å‹çš„æ•°æ®æˆ–è€…æ‰¿æ‹…ä¸åŒçš„èŒè´£ã€‚

**ğŸ”¸ ä¸“ä¸šå®šä¹‰**

å¤šæ•°æ®æºç®¡ç†æ˜¯æŒ‡åœ¨ä¸€ä¸ªJavaåº”ç”¨ä¸­åŒæ—¶è¿æ¥å’Œç®¡ç†å¤šä¸ªæ•°æ®åº“çš„æŠ€æœ¯ã€‚æ¯ä¸ªæ•°æ®åº“å¯ä»¥æ˜¯ä¸åŒç±»å‹ï¼ˆMySQLã€Oracleã€PostgreSQLç­‰ï¼‰æˆ–ç›¸åŒç±»å‹ä½†ç”¨é€”ä¸åŒçš„æ•°æ®åº“å®ä¾‹ã€‚

### 1.2 ç°å®åœºæ™¯ä¸¾ä¾‹


**ğŸŒ° ç”µå•†ç½‘ç«™çš„æ•°æ®åˆ†å¸ƒ**

```
ç”¨æˆ·æ•°æ®åº“    â†  å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ã€ç™»å½•æ•°æ®
    â†“
è®¢å•æ•°æ®åº“    â†  å­˜å‚¨è®¢å•ã€æ”¯ä»˜ä¿¡æ¯
    â†“  
å•†å“æ•°æ®åº“    â†  å­˜å‚¨å•†å“ä¿¡æ¯ã€åº“å­˜
    â†“
æ—¥å¿—æ•°æ®åº“    â†  å­˜å‚¨æ“ä½œæ—¥å¿—ã€è®¿é—®è®°å½•
```

æ¯ä¸ªæ•°æ®åº“ä¸“é—¨è´Ÿè´£ä¸€ç±»æ•°æ®ï¼Œè¿™æ ·å¯ä»¥ï¼š
- **æ•°æ®éš”ç¦»**ï¼šä¸åŒä¸šåŠ¡çš„æ•°æ®åˆ†å¼€å­˜å‚¨
- **æ€§èƒ½ä¼˜åŒ–**ï¼šé’ˆå¯¹ä¸åŒæ•°æ®ç‰¹ç‚¹ä¼˜åŒ–æ•°æ®åº“
- **ç»´æŠ¤æ–¹ä¾¿**ï¼šæŸä¸ªæ•°æ®åº“å‡ºé—®é¢˜ä¸å½±å“å…¶ä»–åŠŸèƒ½

---

## 2. ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦å¤šæ•°æ®æº


### 2.1 ä¸šåŠ¡éœ€æ±‚é©±åŠ¨


**ğŸ”¸ æ•°æ®åˆ†ç¦»éœ€æ±‚**

| ä¸šåŠ¡åœºæ™¯ | **æ•°æ®ç‰¹ç‚¹** | **ä¸ºä»€ä¹ˆè¦åˆ†ç¦»** | **å®é™…å¥½å¤„** |
|---------|------------|----------------|-------------|
| ğŸ›ï¸ **ç”¨æˆ·ç®¡ç†** | `é¢‘ç¹è¯»å–ï¼Œå°‘é‡å†™å…¥` | `ç”¨æˆ·ä¿¡æ¯ç›¸å¯¹ç¨³å®š` | `å¯ä»¥é’ˆå¯¹è¯»ä¼˜åŒ–` |
| ğŸ“¦ **è®¢å•å¤„ç†** | `å¤§é‡å†™å…¥ï¼Œäº‹åŠ¡è¦æ±‚é«˜` | `è®¢å•æ•°æ®å¢é•¿å¿«` | `ç‹¬ç«‹æ‰©å®¹å’Œå¤‡ä»½` |
| ğŸ“Š **æ•°æ®åˆ†æ** | `å¤§é‡å†å²æ•°æ®æŸ¥è¯¢` | `åˆ†ææŸ¥è¯¢å¾ˆæ¶ˆè€—èµ„æº` | `ä¸å½±å“ä¸šåŠ¡æ•°æ®åº“` |
| ğŸ“ **æ—¥å¿—è®°å½•** | `åªå†™å…¥ï¼Œå¶å°”æŸ¥è¯¢` | `æ•°æ®é‡å·¨å¤§` | `å¯ä»¥ç”¨ä¸“é—¨çš„æ—¥å¿—åº“` |

**ğŸ”¸ æŠ€æœ¯æ¶æ„éœ€æ±‚**

ç°ä»£åº”ç”¨è¶Šæ¥è¶Šå¤æ‚ï¼Œå•ä¸€æ•°æ®åº“éš¾ä»¥æ»¡è¶³æ‰€æœ‰éœ€æ±‚ï¼š

```
ä¼ ç»Ÿå•æ•°æ®åº“é—®é¢˜ï¼š
æ‰€æœ‰æ•°æ®æ··åœ¨ä¸€èµ· â†’ æ€§èƒ½ç“¶é¢ˆ â†’ ç»´æŠ¤å›°éš¾ â†’ æ‰©å±•å—é™

å¤šæ•°æ®æºä¼˜åŠ¿ï¼š
ä¸“åº“ä¸“ç”¨ â†’ æ€§èƒ½æå‡ â†’ ç»´æŠ¤ç®€åŒ– â†’ çµæ´»æ‰©å±•
```

### 2.2 æ€§èƒ½å’Œå¯é æ€§è€ƒè™‘


**ğŸ”¸ è¯»å†™åˆ†ç¦»æå‡æ€§èƒ½**

> ğŸ’¡ **é€šä¿—è§£é‡Š**  
> å°±åƒå›¾ä¹¦é¦†åˆ†ä¸ºå€Ÿä¹¦å¤„å’Œè¿˜ä¹¦å¤„ï¼Œå€Ÿä¹¦çš„äººå¤šï¼Œä¸“é—¨å®‰æ’å‡ ä¸ªçª—å£å¤„ç†å€Ÿä¹¦ï¼›è¿˜ä¹¦çš„äººå°‘ï¼Œä¸€ä¸ªçª—å£å°±å¤Ÿäº†ã€‚æ•°æ®åº“ä¹Ÿæ˜¯ä¸€æ ·ï¼Œè¯»æ“ä½œå¤šå°±å¤šæå‡ ä¸ª"è¯»æ•°æ®åº“"ï¼Œå†™æ“ä½œå°‘å°±ç”¨ä¸€ä¸ª"å†™æ•°æ®åº“"ã€‚

**ğŸ”¸ æ•…éšœéš”ç¦»é™ä½é£é™©**

```
å•æ•°æ®åº“é£é™©ï¼š
æ•°æ®åº“å´©æºƒ â†’ æ•´ä¸ªç³»ç»Ÿç˜«ç—ª

å¤šæ•°æ®æºä¼˜åŠ¿ï¼š
ç”¨æˆ·æ•°æ®åº“å´©æºƒ â†’ åªå½±å“ç™»å½•åŠŸèƒ½
è®¢å•æ•°æ®åº“æ­£å¸¸ â†’ è€ç”¨æˆ·è¿˜èƒ½ä¸‹å•
å•†å“æ•°æ®åº“æ­£å¸¸ â†’ å•†å“å±•ç¤ºä¸å—å½±å“
```

---

## 3. âš™ï¸ å¤šæ•°æ®æºé…ç½®å®ç°


### 3.1 åŸºç¡€é…ç½®æ–¹å¼


**ğŸ”¸ ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡å¤šä¸ªæ•°æ®æºé…ç½®**

```properties
# application.properties

# ä¸»æ•°æ®åº“é…ç½®ï¼ˆç”¨æˆ·æ•°æ®ï¼‰
spring.datasource.primary.url=jdbc:mysql://localhost:3306/user_db
spring.datasource.primary.username=root
spring.datasource.primary.password=123456
spring.datasource.primary.driver-class-name=com.mysql.cj.jdbc.Driver

# æ¬¡è¦æ•°æ®åº“é…ç½®ï¼ˆè®¢å•æ•°æ®ï¼‰
spring.datasource.secondary.url=jdbc:mysql://localhost:3306/order_db
spring.datasource.secondary.username=root
spring.datasource.secondary.password=123456
spring.datasource.secondary.driver-class-name=com.mysql.cj.jdbc.Driver
```

**ğŸ”¸ ç¬¬äºŒæ­¥ï¼šåˆ›å»ºæ•°æ®æºBean**

```java
@Configuration
public class DataSourceConfig {
    
    /**
     * ğŸ”¸ ä¸»æ•°æ®æº - å¤„ç†ç”¨æˆ·ç›¸å…³æ•°æ®
     */
    @Bean
    @Primary  // æ ‡è®°ä¸ºä¸»è¦æ•°æ®æº
    @ConfigurationProperties("spring.datasource.primary")
    public DataSource primaryDataSource() {
        return DataSourceBuilder.create().build();
    }
    
    /**
     * ğŸ”¸ æ¬¡è¦æ•°æ®æº - å¤„ç†è®¢å•ç›¸å…³æ•°æ®  
     */
    @Bean
    @ConfigurationProperties("spring.datasource.secondary")
    public DataSource secondaryDataSource() {
        return DataSourceBuilder.create().build();
    }
}
```

> ğŸ’¡ **æ–°æ‰‹ç†è§£è¦ç‚¹**  
> `@Primary` å°±åƒç»™æ•°æ®æºè´´ä¸ª"é»˜è®¤"æ ‡ç­¾ï¼Œå½“ç³»ç»Ÿä¸çŸ¥é“ç”¨å“ªä¸ªæ•°æ®æºæ—¶ï¼Œå°±ç”¨è¿™ä¸ªã€‚å°±åƒä½ æœ‰å¤šæŠŠé’¥åŒ™ï¼Œä½†æœ‰ä¸€æŠŠæ˜¯å¸¸ç”¨çš„ä¸»é’¥åŒ™ã€‚

### 3.2 ä½¿ç”¨ä¸åŒæ•°æ®æº


**ğŸ”¸ æ–¹æ³•ä¸€ï¼šé€šè¿‡JdbcTemplateä½¿ç”¨**

```java
@Service
public class UserService {
    
    @Autowired
    @Qualifier("primaryDataSource")
    private DataSource userDataSource;
    
    private JdbcTemplate userJdbcTemplate;
    
    @PostConstruct
    public void init() {
        this.userJdbcTemplate = new JdbcTemplate(userDataSource);
    }
    
    /**
     * ä»ç”¨æˆ·æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯
     */
    public User findUserById(Long id) {
        String sql = "SELECT * FROM user WHERE id = ?";
        return userJdbcTemplate.queryForObject(sql, 
            new Object[]{id}, 
            new UserRowMapper());
    }
}
```

**ğŸ”¸ æ–¹æ³•äºŒï¼šé€šè¿‡ä¸åŒçš„DAOç±»ä½¿ç”¨**

```java
// ç”¨æˆ·æ•°æ®è®¿é—®ç±»
@Repository
public class UserDao {
    @Autowired
    @Qualifier("primaryDataSource") 
    private DataSource dataSource;
    
    // ç”¨æˆ·ç›¸å…³çš„æ•°æ®åº“æ“ä½œ
}

// è®¢å•æ•°æ®è®¿é—®ç±»  
@Repository
public class OrderDao {
    @Autowired
    @Qualifier("secondaryDataSource")
    private DataSource dataSource;
    
    // è®¢å•ç›¸å…³çš„æ•°æ®åº“æ“ä½œ
}
```

---

## 4. ğŸ”„ åŠ¨æ€æ•°æ®æºåˆ‡æ¢


### 4.1 ä»€ä¹ˆæ˜¯åŠ¨æ€åˆ‡æ¢


**ğŸ”¸ ç”Ÿæ´»åœºæ™¯ç†è§£**

æƒ³è±¡ä½ æœ‰ä¸€ä¸ªä¸‡èƒ½é¥æ§å™¨ï¼Œå¯ä»¥æ§åˆ¶å®¶é‡Œæ‰€æœ‰ç”µå™¨ï¼š
- æŒ‰"ç”µè§†"é”® â†’ æ§åˆ¶ç”µè§†
- æŒ‰"ç©ºè°ƒ"é”® â†’ æ§åˆ¶ç©ºè°ƒ  
- æŒ‰"éŸ³å“"é”® â†’ æ§åˆ¶éŸ³å“

åŠ¨æ€æ•°æ®æºåˆ‡æ¢å°±åƒè¿™ä¸ªä¸‡èƒ½é¥æ§å™¨ï¼Œç¨‹åºè¿è¡Œæ—¶å¯ä»¥æ ¹æ®éœ€è¦"åˆ‡æ¢é¢‘é“"ï¼Œè¿æ¥åˆ°ä¸åŒçš„æ•°æ®åº“ã€‚

**ğŸ”¸ æŠ€æœ¯å®ç°åŸç†**

```
ç¨‹åºæ‰§è¡Œæµç¨‹ï¼š
1. åˆ¤æ–­å½“å‰æ“ä½œç±»å‹ï¼ˆç”¨æˆ·æ“ä½œï¼Ÿè®¢å•æ“ä½œï¼Ÿï¼‰
2. è‡ªåŠ¨åˆ‡æ¢åˆ°å¯¹åº”çš„æ•°æ®æº
3. æ‰§è¡Œæ•°æ®åº“æ“ä½œ
4. æ“ä½œå®Œæˆåå¯ä»¥åˆ‡æ¢å›é»˜è®¤æ•°æ®æº
```

### 4.2 å®ç°åŠ¨æ€åˆ‡æ¢


**ğŸ”¸ ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæ•°æ®æºè·¯ç”±ç±»**

```java
/**
 * ğŸ”¸ åŠ¨æ€æ•°æ®æºè·¯ç”±å™¨
 * ä½œç”¨ï¼šæ ¹æ®å½“å‰çº¿ç¨‹çš„æ ‡è¯†ï¼Œå†³å®šä½¿ç”¨å“ªä¸ªæ•°æ®æº
 */
public class DynamicDataSource extends AbstractRoutingDataSource {
    
    // çº¿ç¨‹æœ¬åœ°å˜é‡ï¼Œå­˜å‚¨å½“å‰çº¿ç¨‹åº”è¯¥ä½¿ç”¨çš„æ•°æ®æºæ ‡è¯†
    private static final ThreadLocal<String> contextHolder = new ThreadLocal<>();
    
    /**
     * è®¾ç½®å½“å‰çº¿ç¨‹ä½¿ç”¨çš„æ•°æ®æº
     */
    public static void setDataSource(String dataSourceKey) {
        contextHolder.set(dataSourceKey);
    }
    
    /**
     * è·å–å½“å‰çº¿ç¨‹çš„æ•°æ®æºæ ‡è¯†
     */
    public static String getDataSource() {
        return contextHolder.get();
    }
    
    /**
     * æ¸…ç†å½“å‰çº¿ç¨‹çš„æ•°æ®æºè®¾ç½®
     */
    public static void clearDataSource() {
        contextHolder.remove();
    }
    
    /**
     * Springè°ƒç”¨æ­¤æ–¹æ³•å†³å®šä½¿ç”¨å“ªä¸ªæ•°æ®æº
     */
    @Override
    protected Object determineCurrentLookupKey() {
        return getDataSource();
    }
}
```

> ğŸ§  **è®°å¿†æŠ€å·§**  
> ThreadLocalå°±åƒæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å°çº¸æ¡ï¼Œä¸Šé¢å†™ç€"å½“å‰è¦ç”¨å“ªä¸ªæ•°æ®åº“"ï¼Œäº’ä¸å¹²æ‰°ã€‚

**ğŸ”¸ ç¬¬äºŒæ­¥ï¼šé…ç½®åŠ¨æ€æ•°æ®æº**

```java
@Configuration
public class DynamicDataSourceConfig {
    
    @Bean
    public DataSource dynamicDataSource() {
        DynamicDataSource dynamicDataSource = new DynamicDataSource();
        
        // è®¾ç½®é»˜è®¤æ•°æ®æº
        dynamicDataSource.setDefaultTargetDataSource(primaryDataSource());
        
        // è®¾ç½®æ‰€æœ‰æ•°æ®æºçš„æ˜ å°„
        Map<Object, Object> targetDataSources = new HashMap<>();
        targetDataSources.put("primary", primaryDataSource());    // ç”¨æˆ·æ•°æ®åº“
        targetDataSources.put("secondary", secondaryDataSource()); // è®¢å•æ•°æ®åº“
        
        dynamicDataSource.setTargetDataSources(targetDataSources);
        
        return dynamicDataSource;
    }
}
```

**ğŸ”¸ ç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨åŠ¨æ€æ•°æ®æº**

```java
@Service
public class BusinessService {
    
    /**
     * å¤„ç†ç”¨æˆ·ç›¸å…³ä¸šåŠ¡
     */
    public User getUserInfo(Long userId) {
        // åˆ‡æ¢åˆ°ç”¨æˆ·æ•°æ®åº“
        DynamicDataSource.setDataSource("primary");
        
        try {
            // æ‰§è¡Œç”¨æˆ·æ•°æ®æŸ¥è¯¢
            return userDao.findById(userId);
        } finally {
            // æ¸…ç†æ•°æ®æºè®¾ç½®ï¼Œé¿å…å½±å“å…¶ä»–æ“ä½œ
            DynamicDataSource.clearDataSource();
        }
    }
    
    /**
     * å¤„ç†è®¢å•ç›¸å…³ä¸šåŠ¡
     */
    public Order getOrderInfo(Long orderId) {
        // åˆ‡æ¢åˆ°è®¢å•æ•°æ®åº“
        DynamicDataSource.setDataSource("secondary");
        
        try {
            return orderDao.findById(orderId);
        } finally {
            DynamicDataSource.clearDataSource();
        }
    }
}
```

---

## 5. ğŸ“– è¯»å†™åˆ†ç¦»æ¦‚å¿µä¸å®ç°


### 5.1 è¯»å†™åˆ†ç¦»æ˜¯ä»€ä¹ˆ


**ğŸ”¸ ç”Ÿæ´»ä¸­çš„è¯»å†™åˆ†ç¦»**

æƒ³è±¡ä¸€ä¸ªå›¾ä¹¦é¦†çš„ç®¡ç†æ–¹å¼ï¼š
- **å†™æ“ä½œï¼ˆå€Ÿä¹¦ã€è¿˜ä¹¦ã€æ–°ä¹¦å…¥åº“ï¼‰**ï¼šåœ¨æœåŠ¡å°ç»Ÿä¸€å¤„ç†ï¼Œéœ€è¦æ›´æ–°å›¾ä¹¦çŠ¶æ€
- **è¯»æ“ä½œï¼ˆæŸ¥æ‰¾å›¾ä¹¦ã€é˜…è¯»ï¼‰**ï¼šåœ¨é˜…è§ˆå®¤è¿›è¡Œï¼Œä¸éœ€è¦æ”¹å˜ä»»ä½•ä¿¡æ¯

æ•°æ®åº“çš„è¯»å†™åˆ†ç¦»ä¹Ÿæ˜¯è¿™ä¸ªé“ç†ï¼š
- **å†™æ“ä½œ**ï¼šç»Ÿä¸€åœ¨ä¸»æ•°æ®åº“è¿›è¡Œ
- **è¯»æ“ä½œ**ï¼šåˆ†æ•£åˆ°å¤šä¸ªä»æ•°æ®åº“è¿›è¡Œ

```
ç”¨æˆ·è¯·æ±‚å¤„ç†æµç¨‹ï¼š

å†™è¯·æ±‚ï¼ˆå¢åˆ æ”¹ï¼‰â†’ ä¸»æ•°æ®åº“ï¼ˆMasterï¼‰
                      â†“
                  æ•°æ®åŒæ­¥
                      â†“
è¯»è¯·æ±‚ï¼ˆæŸ¥è¯¢ï¼‰  â†’ ä»æ•°æ®åº“ï¼ˆSlave1ã€Slave2ã€Slave3ï¼‰
```

### 5.2 è¯»å†™åˆ†ç¦»çš„å¥½å¤„


**ğŸ”¸ æ€§èƒ½æå‡çš„åŸç†**

| æ–¹é¢ | **å•æ•°æ®åº“** | **è¯»å†™åˆ†ç¦»** | **æ€§èƒ½æå‡** |
|-----|-------------|-------------|-------------|
| ğŸ“Š **å¹¶å‘å¤„ç†** | `æ‰€æœ‰è¯·æ±‚æ’é˜Ÿç­‰å¾…` | `è¯»å†™è¯·æ±‚åˆ†å¼€å¤„ç†` | `å¹¶å‘èƒ½åŠ›å¤§å¹…æå‡` |
| ğŸš€ **å“åº”é€Ÿåº¦** | `å†™æ“ä½œé˜»å¡è¯»æ“ä½œ` | `è¯»æ“ä½œä¸å—å†™æ“ä½œå½±å“` | `æŸ¥è¯¢å“åº”æ›´å¿«` |
| ğŸ’¾ **èµ„æºåˆ©ç”¨** | `å•æœºèµ„æºæœ‰é™` | `å¤šæœºèµ„æºåˆ†æ‹…è´Ÿè½½` | `æ•´ä½“èµ„æºåˆ©ç”¨ç‡é«˜` |

**ğŸ”¸ å®é™…æ•°æ®å¯¹æ¯”**

```
ç½‘ç«™è®¿é—®ç‰¹ç‚¹ç»Ÿè®¡ï¼š
è¯»æ“ä½œï¼ˆæŸ¥è¯¢ï¼‰ï¼š80-90%
å†™æ“ä½œï¼ˆå¢åˆ æ”¹ï¼‰ï¼š10-20%

è¯»å†™åˆ†ç¦»æ•ˆæœï¼š
- æŸ¥è¯¢å“åº”æ—¶é—´ï¼šä»å¹³å‡200msé™åˆ°50ms
- ç³»ç»Ÿå¹¶å‘é‡ï¼šä»1000äººåœ¨çº¿æå‡åˆ°5000äººåœ¨çº¿
- æ•°æ®åº“CPUä½¿ç”¨ç‡ï¼šä»90%é™åˆ°60%
```

### 5.3 è¯»å†™åˆ†ç¦»å®ç°


**ğŸ”¸ åŸºäºæ³¨è§£çš„è¯»å†™åˆ†ç¦»**

```java
// è‡ªå®šä¹‰æ³¨è§£ï¼Œæ ‡è®°è¯»æ“ä½œ
@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface ReadOnly {
}

// è‡ªå®šä¹‰æ³¨è§£ï¼Œæ ‡è®°å†™æ“ä½œ
@Target(ElementType.METHOD) 
@Retention(RetentionPolicy.RUNTIME)
public @interface WriteOnly {
}
```

**ğŸ”¸ AOPåˆ‡é¢å®ç°è‡ªåŠ¨åˆ‡æ¢**

```java
@Aspect
@Component
public class DataSourceAspect {
    
    /**
     * ğŸ”¸ æ‹¦æˆªæ ‡è®°äº†@ReadOnlyçš„æ–¹æ³•
     */
    @Before("@annotation(readOnly)")
    public void setReadDataSource(ReadOnly readOnly) {
        // è‡ªåŠ¨åˆ‡æ¢åˆ°è¯»æ•°æ®æºï¼ˆä»åº“ï¼‰
        DynamicDataSource.setDataSource("slave");
        System.out.println("åˆ‡æ¢åˆ°è¯»æ•°æ®åº“");
    }
    
    /**
     * ğŸ”¸ æ‹¦æˆªæ ‡è®°äº†@WriteOnlyçš„æ–¹æ³•
     */
    @Before("@annotation(writeOnly)")
    public void setWriteDataSource(WriteOnly writeOnly) {
        // è‡ªåŠ¨åˆ‡æ¢åˆ°å†™æ•°æ®æºï¼ˆä¸»åº“ï¼‰
        DynamicDataSource.setDataSource("master");
        System.out.println("åˆ‡æ¢åˆ°å†™æ•°æ®åº“");
    }
    
    /**
     * ğŸ”¸ æ–¹æ³•æ‰§è¡Œå®Œæ¯•åæ¸…ç†
     */
    @After("@annotation(ReadOnly) || @annotation(WriteOnly)")
    public void clearDataSource() {
        DynamicDataSource.clearDataSource();
        System.out.println("æ¸…ç†æ•°æ®æºè®¾ç½®");
    }
}
```

**ğŸ”¸ ä¸šåŠ¡ä»£ç ä½¿ç”¨**

```java
@Service
public class ProductService {
    
    /**
     * æŸ¥è¯¢å•†å“ä¿¡æ¯ - ä½¿ç”¨è¯»åº“
     */
    @ReadOnly
    public Product getProductById(Long id) {
        // è¿™ä¸ªæ–¹æ³•ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°ä»æ•°æ®åº“æ‰§è¡Œ
        return productDao.findById(id);
    }
    
    /**
     * æ·»åŠ æ–°å•†å“ - ä½¿ç”¨å†™åº“
     */
    @WriteOnly
    public void addProduct(Product product) {
        // è¿™ä¸ªæ–¹æ³•ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°ä¸»æ•°æ®åº“æ‰§è¡Œ
        productDao.save(product);
    }
    
    /**
     * æ›´æ–°å•†å“ä¿¡æ¯ - ä½¿ç”¨å†™åº“
     */
    @WriteOnly
    public void updateProduct(Product product) {
        productDao.update(product);
    }
}
```

> ğŸ’¡ **æ–°æ‰‹æ³¨æ„**  
> ä½¿ç”¨æ³¨è§£åï¼Œä½ åªéœ€è¦åœ¨æ–¹æ³•ä¸ŠåŠ @ReadOnlyæˆ–@WriteOnlyï¼Œç³»ç»Ÿå°±ä¼šè‡ªåŠ¨é€‰æ‹©åˆé€‚çš„æ•°æ®åº“ï¼Œä¸éœ€è¦æ‰‹åŠ¨åˆ‡æ¢ï¼

---

## 6. ğŸ—ï¸ ä¸»ä»æ•°æ®åº“æ¶æ„


### 6.1 ä¸»ä»æ¶æ„åŸç†


**ğŸ”¸ ä¸»ä»å…³ç³»ç†è§£**

```
ä¸»æ•°æ®åº“æ¶æ„å›¾ï¼š

        åº”ç”¨ç¨‹åº
           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”‚             â”‚
    â–¼             â–¼
ä¸»æ•°æ®åº“        ä»æ•°æ®åº“1
(Master)       (Slave1)
å†™æ“ä½œ           è¯»æ“ä½œ
    â”‚             â–²
    â”‚   æ•°æ®åŒæ­¥    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
      ä»æ•°æ®åº“2
      (Slave2)
       è¯»æ“ä½œ
```

**ğŸ”¸ å·¥ä½œæµç¨‹è¯´æ˜**

1. **å†™æ“ä½œæµç¨‹**ï¼š
   ```
   ç”¨æˆ·æäº¤æ•°æ® â†’ åº”ç”¨ç¨‹åº â†’ ä¸»æ•°æ®åº“ â†’ æ•°æ®å†™å…¥æˆåŠŸ
                                   â†“
                              æ•°æ®åŒæ­¥åˆ°ä»åº“
   ```

2. **è¯»æ“ä½œæµç¨‹**ï¼š
   ```
   ç”¨æˆ·æŸ¥è¯¢æ•°æ® â†’ åº”ç”¨ç¨‹åº â†’ ä»æ•°æ®åº“ â†’ è¿”å›æŸ¥è¯¢ç»“æœ
   ```

3. **æ•°æ®åŒæ­¥æœºåˆ¶**ï¼š
   ```
   ä¸»åº“æ•°æ®å˜æ›´ â†’ ç”ŸæˆäºŒè¿›åˆ¶æ—¥å¿— â†’ ä¼ è¾“ç»™ä»åº“ â†’ ä»åº“åº”ç”¨å˜æ›´
   ```

### 6.2 ä¸»ä»åŒæ­¥çš„æŒ‘æˆ˜


**ğŸ”¸ æ•°æ®ä¸€è‡´æ€§é—®é¢˜**

> âš ï¸ **é‡è¦æ¦‚å¿µ**  
> ä¸»ä»åŒæ­¥ä¸æ˜¯ç¬æ—¶çš„ï¼ä»æ•°æ®å†™å…¥ä¸»åº“åˆ°åŒæ­¥åˆ°ä»åº“ï¼Œæœ‰ä¸€ä¸ªæ—¶é—´å·®ï¼ˆé€šå¸¸å‡ æ¯«ç§’åˆ°å‡ ç§’ï¼‰ã€‚

**å®é™…åœºæ™¯ä¸¾ä¾‹**ï¼š
```
æ—¶é—´è½´ï¼š
10:00:00 - ç”¨æˆ·åœ¨ä¸»åº“æ·»åŠ äº†ä¸€æ¡å•†å“ä¿¡æ¯
10:00:01 - æ•°æ®å¼€å§‹åŒæ­¥åˆ°ä»åº“ï¼ˆåŒæ­¥ä¸­...ï¼‰
10:00:02 - ç”¨æˆ·ç«‹å³æŸ¥è¯¢è¯¥å•†å“ä¿¡æ¯ï¼ˆæŸ¥è¯¢ä»åº“ï¼‰
ç»“æœï¼šæŸ¥è¯¢ä¸åˆ°ï¼å› ä¸ºæ•°æ®è¿˜æ²¡åŒæ­¥å®Œæˆ
```

**ğŸ”¸ è§£å†³æ–¹æ¡ˆ**

| è§£å†³æ–¹æ¡ˆ | **åŸç†** | **é€‚ç”¨åœºæ™¯** | **ä¼˜ç¼ºç‚¹** |
|---------|---------|-------------|-----------|
| ğŸ”¸ **å¼ºåˆ¶è¯»ä¸»åº“** | `é‡è¦æ“ä½œåç«‹å³è¯»ä¸»åº“` | `è®¢å•æ”¯ä»˜åæŸ¥è¯¢` | `ä¿è¯ä¸€è‡´æ€§ï¼Œä½†å¢åŠ ä¸»åº“å‹åŠ›` |
| ğŸ”¸ **å»¶è¿Ÿè¯»å–** | `å†™æ“ä½œåç­‰å¾…å‡ ç§’å†è¯»` | `ç”¨æˆ·å‘è¡¨è¯„è®ºåæŸ¥çœ‹` | `ç®€å•æœ‰æ•ˆï¼Œä½†ç”¨æˆ·ä½“éªŒå·®` |
| ğŸ”¸ **ç¼“å­˜æœºåˆ¶** | `å†™å…¥æ—¶åŒæ—¶æ›´æ–°ç¼“å­˜` | `ç”¨æˆ·ä¿¡æ¯ä¿®æ”¹` | `å“åº”å¿«ï¼Œä½†éœ€è¦ç»´æŠ¤ç¼“å­˜` |

### 6.3 ä¸»ä»åˆ‡æ¢å’Œæ•…éšœå¤„ç†


**ğŸ”¸ ä¸»åº“æ•…éšœæ—¶çš„å¤„ç†**

```
æ­£å¸¸çŠ¶æ€ï¼š
ä¸»åº“ï¼ˆå†™ï¼‰ â†’ ä»åº“1ï¼ˆè¯»ï¼‰ â†’ ä»åº“2ï¼ˆè¯»ï¼‰

ä¸»åº“æ•…éšœï¼š
ä¸»åº“ï¼ˆâŒæ•…éšœï¼‰ â†’ ä»åº“1ï¼ˆğŸ”„å‡çº§ä¸ºä¸»åº“ï¼‰ â†’ ä»åº“2ï¼ˆè¯»ï¼‰

æ¢å¤æµç¨‹ï¼š
1. æ£€æµ‹ä¸»åº“æ•…éšœ
2. é€‰æ‹©ä¸€ä¸ªä»åº“å‡çº§ä¸ºæ–°ä¸»åº“  
3. å…¶ä»–ä»åº“æŒ‡å‘æ–°ä¸»åº“
4. åº”ç”¨ç¨‹åºè¿æ¥åˆ‡æ¢åˆ°æ–°ä¸»åº“
```

**ğŸ”¸ è‡ªåŠ¨æ•…éšœåˆ‡æ¢å®ç°æ€è·¯**

```java
@Component
public class DatabaseHealthMonitor {
    
    /**
     * å®šæœŸæ£€æŸ¥æ•°æ®åº“å¥åº·çŠ¶æ€
     */
    @Scheduled(fixedRate = 5000) // æ¯5ç§’æ£€æŸ¥ä¸€æ¬¡
    public void checkDatabaseHealth() {
        
        // æ£€æŸ¥ä¸»åº“æ˜¯å¦å¯ç”¨
        if (!checkMasterDatabase()) {
            System.out.println("ä¸»åº“æ•…éšœï¼Œå¯åŠ¨æ•…éšœè½¬ç§»...");
            
            // 1. æ ‡è®°ä¸»åº“ä¸ºä¸å¯ç”¨
            markMasterAsUnavailable();
            
            // 2. é€‰æ‹©æœ€åˆé€‚çš„ä»åº“ä½œä¸ºæ–°ä¸»åº“
            DataSource newMaster = selectBestSlave();
            
            // 3. æ›´æ–°æ•°æ®æºé…ç½®
            updateDataSourceConfiguration(newMaster);
            
            // 4. é€šçŸ¥ç›¸å…³æœåŠ¡
            notifyServiceAboutFailover();
        }
    }
    
    private boolean checkMasterDatabase() {
        try {
            // ç®€å•çš„è¿æ¥æµ‹è¯•
            Connection conn = masterDataSource.getConnection();
            conn.close();
            return true;
        } catch (Exception e) {
            return false;
        }
    }
}
```

---

## 7. ğŸ§­ è·¯ç”±ç­–ç•¥è®¾è®¡


### 7.1 ä»€ä¹ˆæ˜¯è·¯ç”±ç­–ç•¥


**ğŸ”¸ ç”Ÿæ´»ä¸­çš„è·¯ç”±ç†è§£**

è·¯ç”±å°±åƒGPSå¯¼èˆªç³»ç»Ÿï¼š
- **ç›®çš„åœ°ç¡®å®š**ï¼šä½ è¦å»å“ªé‡Œï¼ˆè¯»æ“ä½œè¿˜æ˜¯å†™æ“ä½œï¼‰
- **è·¯çº¿é€‰æ‹©**ï¼šé€‰æ‹©æœ€ä¼˜è·¯å¾„ï¼ˆé€‰æ‹©å“ªä¸ªæ•°æ®åº“ï¼‰
- **åŠ¨æ€è°ƒæ•´**ï¼šæ ¹æ®å®æ—¶æƒ…å†µè°ƒæ•´ï¼ˆæ•°æ®åº“è´Ÿè½½æƒ…å†µï¼‰

æ•°æ®åº“è·¯ç”±ç­–ç•¥å°±æ˜¯å†³å®š"è¿™ä¸ªè¯·æ±‚åº”è¯¥å‘é€åˆ°å“ªä¸ªæ•°æ®åº“"çš„è§„åˆ™ã€‚

### 7.2 å¸¸è§è·¯ç”±ç­–ç•¥


**ğŸ”¸ åŸºäºæ“ä½œç±»å‹çš„è·¯ç”±**

```java
public class OperationTypeRouter {
    
    public String routeDataSource(String operation) {
        
        // å†™æ“ä½œè·¯ç”±åˆ°ä¸»åº“
        if (operation.startsWith("INSERT") || 
            operation.startsWith("UPDATE") || 
            operation.startsWith("DELETE")) {
            return "master";
        }
        
        // è¯»æ“ä½œè·¯ç”±åˆ°ä»åº“
        if (operation.startsWith("SELECT")) {
            return selectSlaveDataSource();
        }
        
        // é»˜è®¤ä½¿ç”¨ä¸»åº“
        return "master";
    }
    
    /**
     * ğŸ”¸ ä»å¤šä¸ªä»åº“ä¸­é€‰æ‹©ä¸€ä¸ª
     */
    private String selectSlaveDataSource() {
        // ç®€å•è½®è¯¢ç­–ç•¥
        String[] slaves = {"slave1", "slave2", "slave3"};
        int index = (int) (System.currentTimeMillis() % slaves.length);
        return slaves[index];
    }
}
```

**ğŸ”¸ åŸºäºè´Ÿè½½å‡è¡¡çš„è·¯ç”±**

```java
public class LoadBalanceRouter {
    
    // è®°å½•æ¯ä¸ªæ•°æ®åº“çš„è¿æ¥æ•°
    private Map<String, Integer> connectionCounts = new ConcurrentHashMap<>();
    
    /**
     * é€‰æ‹©è¿æ¥æ•°æœ€å°‘çš„ä»åº“
     */
    public String selectLeastConnectedSlave() {
        
        String[] slaves = {"slave1", "slave2", "slave3"};
        String selectedSlave = slaves[0];
        int minConnections = connectionCounts.getOrDefault(selectedSlave, 0);
        
        // æ‰¾åˆ°è¿æ¥æ•°æœ€å°‘çš„ä»åº“
        for (String slave : slaves) {
            int connections = connectionCounts.getOrDefault(slave, 0);
            if (connections < minConnections) {
                minConnections = connections;
                selectedSlave = slave;
            }
        }
        
        // å¢åŠ è¯¥ä»åº“çš„è¿æ¥è®¡æ•°
        connectionCounts.put(selectedSlave, minConnections + 1);
        
        return selectedSlave;
    }
}
```

### 7.3 æ™ºèƒ½è·¯ç”±ç­–ç•¥


**ğŸ”¸ åŸºäºåœ°ç†ä½ç½®çš„è·¯ç”±**

```
ç”¨æˆ·è¯·æ±‚å¤„ç†ï¼š

åŒ—äº¬ç”¨æˆ·è¯·æ±‚ â†’ è·¯ç”±åˆ°åŒ—äº¬æ•°æ®åº“
ä¸Šæµ·ç”¨æˆ·è¯·æ±‚ â†’ è·¯ç”±åˆ°ä¸Šæµ·æ•°æ®åº“  
å¹¿å·ç”¨æˆ·è¯·æ±‚ â†’ è·¯ç”±åˆ°å¹¿å·æ•°æ®åº“

ä¼˜ç‚¹ï¼šå“åº”é€Ÿåº¦å¿«ï¼Œç½‘ç»œå»¶è¿Ÿå°
```

**ğŸ”¸ åŸºäºä¸šåŠ¡ç±»å‹çš„è·¯ç”±**

| ä¸šåŠ¡ç±»å‹ | **è·¯ç”±ç­–ç•¥** | **åŸå› ** |
|---------|-------------|---------|
| ğŸ›’ **å•†å“æµè§ˆ** | `å°±è¿‘çš„è¯»åº“` | `è®¿é—®é‡å¤§ï¼Œå¯¹ä¸€è‡´æ€§è¦æ±‚ä¸é«˜` |
| ğŸ’³ **æ”¯ä»˜è®¢å•** | `ä¸»åº“ï¼Œä¸”äº‹åŠ¡éš”ç¦»` | `æ•°æ®ä¸€è‡´æ€§è¦æ±‚æé«˜` |
| ğŸ“Š **æ•°æ®æŠ¥è¡¨** | `ä¸“é—¨çš„åˆ†æåº“` | `æŸ¥è¯¢å¤æ‚ï¼Œä¸å½±å“ä¸šåŠ¡åº“æ€§èƒ½` |
| ğŸ“ **ç”¨æˆ·è¯„è®º** | `è¯»ä»åº“ï¼Œå†™ä¸»åº“` | `å…è®¸çŸ­æš‚çš„æ•°æ®å»¶è¿Ÿ` |

**ğŸ”¸ ç»¼åˆè·¯ç”±ç­–ç•¥å®ç°**

```java
@Component
public class SmartDataSourceRouter {
    
    /**
     * ğŸ”¸ æ™ºèƒ½è·¯ç”±å†³ç­–
     */
    public String determineDataSource(String operation, String userLocation, String businessType) {
        
        // 1. é¦–å…ˆåˆ¤æ–­æ˜¯è¯»è¿˜æ˜¯å†™
        boolean isWriteOperation = isWriteOperation(operation);
        
        if (isWriteOperation) {
            // å†™æ“ä½œå¿…é¡»è·¯ç”±åˆ°ä¸»åº“
            return "master";
        }
        
        // 2. è¯»æ“ä½œçš„æ™ºèƒ½è·¯ç”±
        return routeReadOperation(userLocation, businessType);
    }
    
    private String routeReadOperation(String userLocation, String businessType) {
        
        // æ ¹æ®ä¸šåŠ¡ç±»å‹é€‰æ‹©åˆé€‚çš„æ•°æ®åº“ç±»å‹
        if ("analytics".equals(businessType)) {
            // æ•°æ®åˆ†æç±»è¯·æ±‚è·¯ç”±åˆ°åˆ†æä¸“ç”¨åº“
            return "analytics-slave";
        }
        
        // æ ¹æ®ç”¨æˆ·åœ°ç†ä½ç½®é€‰æ‹©å°±è¿‘çš„ä»åº“
        if ("beijing".equals(userLocation)) {
            return "beijing-slave";
        } else if ("shanghai".equals(userLocation)) {
            return "shanghai-slave";
        }
        
        // é»˜è®¤é€‰æ‹©è´Ÿè½½æœ€å°çš„ä»åº“
        return selectLeastLoadedSlave();
    }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å¤šæ•°æ®æºï¼šä¸€ä¸ªåº”ç”¨è¿æ¥å¤šä¸ªæ•°æ®åº“ï¼Œä¸“åº“ä¸“ç”¨
ğŸ”¸ åŠ¨æ€åˆ‡æ¢ï¼šç¨‹åºè¿è¡Œæ—¶æ ¹æ®éœ€è¦è‡ªåŠ¨é€‰æ‹©æ•°æ®åº“
ğŸ”¸ è¯»å†™åˆ†ç¦»ï¼šå†™æ“ä½œç”¨ä¸»åº“ï¼Œè¯»æ“ä½œç”¨ä»åº“ï¼Œæå‡æ€§èƒ½
ğŸ”¸ ä¸»ä»æ¶æ„ï¼šä¸€ä¸»å¤šä»ï¼Œæ•°æ®ä»ä¸»åº“åŒæ­¥åˆ°ä»åº“
ğŸ”¸ è·¯ç”±ç­–ç•¥ï¼šå†³å®šè¯·æ±‚å‘é€åˆ°å“ªä¸ªæ•°æ®åº“çš„è§„åˆ™
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ å¤šæ•°æ®æºçš„æœ¬è´¨**
```
æ ¸å¿ƒæ€æƒ³ï¼šä¸“ä¸šçš„äº‹äº¤ç»™ä¸“ä¸šçš„åº“æ¥åš
å®ç°æ–¹å¼ï¼šé…ç½®å¤šä¸ªDataSource + åŠ¨æ€åˆ‡æ¢æœºåˆ¶
åº”ç”¨ä»·å€¼ï¼šæ€§èƒ½æå‡ + æ•°æ®éš”ç¦» + ç³»ç»Ÿå¯é æ€§
```

**ğŸ”¹ è¯»å†™åˆ†ç¦»çš„å…³é”®ç‚¹**
```
ä¸ºä»€ä¹ˆæœ‰æ•ˆï¼šè¯»æ“ä½œå 80-90%ï¼Œåˆ†ç¦»åå¤§å¹…æå‡å¹¶å‘
æ³¨æ„äº‹é¡¹ï¼šä¸»ä»åŒæ­¥æœ‰å»¶è¿Ÿï¼Œéœ€è¦å¤„ç†æ•°æ®ä¸€è‡´æ€§
å®ç°æŠ€å·§ï¼šAOP + æ³¨è§£ï¼Œè‡ªåŠ¨è·¯ç”±åˆ°åˆé€‚çš„æ•°æ®åº“
```

**ğŸ”¹ è·¯ç”±ç­–ç•¥çš„è®¾è®¡åŸåˆ™**
```
ä¸šåŠ¡ä¼˜å…ˆï¼šæ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹é€‰æ‹©åˆé€‚çš„è·¯ç”±è§„åˆ™
æ€§èƒ½è€ƒè™‘ï¼šè´Ÿè½½å‡è¡¡ï¼Œé¿å…å•ç‚¹å‹åŠ›è¿‡å¤§
å®¹é”™èƒ½åŠ›ï¼šæ•…éšœæ—¶èƒ½è‡ªåŠ¨åˆ‡æ¢åˆ°å¯ç”¨æ•°æ®åº“
```

### 8.3 å®é™…åº”ç”¨å»ºè®®


**ğŸ¯ ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å¤šæ•°æ®æº**
- âœ… ç”¨æˆ·é‡è¶…è¿‡1ä¸‡ï¼Œæ•°æ®åº“å‹åŠ›å¤§
- âœ… ä¸šåŠ¡å¤æ‚ï¼Œä¸åŒç±»å‹æ•°æ®ç‰¹ç‚¹å·®å¼‚æ˜æ˜¾  
- âœ… å¯¹ç³»ç»Ÿå¯ç”¨æ€§è¦æ±‚é«˜ï¼Œéœ€è¦å®¹é”™èƒ½åŠ›
- âŒ å°é¡¹ç›®ï¼Œç”¨æˆ·é‡å°‘ï¼Œå•åº“å®Œå…¨å¤Ÿç”¨

**ğŸ”§ å®æ–½æ­¥éª¤å»ºè®®**
1. **ç¬¬ä¸€é˜¶æ®µ**ï¼šé…ç½®å¤šæ•°æ®æºï¼ŒæŒ‰ä¸šåŠ¡ç±»å‹åˆ†åº“
2. **ç¬¬äºŒé˜¶æ®µ**ï¼šå®ç°è¯»å†™åˆ†ç¦»ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½
3. **ç¬¬ä¸‰é˜¶æ®µ**ï¼šå¢åŠ æ™ºèƒ½è·¯ç”±ï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒ
4. **ç¬¬å››é˜¶æ®µ**ï¼šå®Œå–„ç›‘æ§å’Œæ•…éšœåˆ‡æ¢æœºåˆ¶

**âš ï¸ å¸¸è§è¯¯åŒºé¿å…**
```
âŒ è¯¯åŒº1ï¼šä¸ºäº†å¤šæ•°æ®æºè€Œå¤šæ•°æ®æºï¼Œå¢åŠ ç³»ç»Ÿå¤æ‚åº¦
âœ… æ­£ç¡®ï¼šæ ¹æ®å®é™…ä¸šåŠ¡éœ€æ±‚å’Œæ€§èƒ½ç“¶é¢ˆæ¥å†³å®š

âŒ è¯¯åŒº2ï¼šå¿½ç•¥æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼Œå¯¼è‡´ä¸šåŠ¡é€»è¾‘é”™è¯¯
âœ… æ­£ç¡®ï¼šé‡è¦ä¸šåŠ¡å¼ºåˆ¶è¯»ä¸»åº“ï¼Œæˆ–ä½¿ç”¨ç¼“å­˜æœºåˆ¶

âŒ è¯¯åŒº3ï¼šé…ç½®å®Œå°±ä¸ç®¡ï¼Œæ²¡æœ‰ç›‘æ§å’Œç»´æŠ¤æœºåˆ¶
âœ… æ­£ç¡®ï¼šå»ºç«‹å®Œå–„çš„ç›‘æ§ï¼Œå®šæœŸæ£€æŸ¥åŒæ­¥çŠ¶æ€
```

### 8.4 å­¦ä¹ è¿›é˜¶æ–¹å‘


**ğŸ“ˆ æ·±å…¥å­¦ä¹ å»ºè®®**
1. **åˆ†å¸ƒå¼äº‹åŠ¡**ï¼šå­¦ä¹ å¦‚ä½•åœ¨å¤šæ•°æ®æºç¯å¢ƒä¸‹ä¿è¯äº‹åŠ¡ä¸€è‡´æ€§
2. **æ•°æ®åº“ä¸­é—´ä»¶**ï¼šäº†è§£MyCATã€Sharding-JDBCç­‰ä¸“ä¸šå·¥å…·
3. **å¾®æœåŠ¡æ¶æ„**ï¼šåœ¨å¾®æœåŠ¡ç¯å¢ƒä¸‹çš„æ•°æ®åº“è®¾è®¡æ¨¡å¼
4. **æ•°æ®åº“ä¼˜åŒ–**ï¼šMySQLä¸»ä»å¤åˆ¶åŸç†å’Œæ€§èƒ½è°ƒä¼˜

**ğŸ’¡ è®°å¿†å£è¯€**ï¼š
- å¤šæºåˆ†ç¦»ä¸“åº“ç”¨ï¼Œè¯»å†™åˆ†ç¦»æ€§èƒ½å‡
- ä¸»ä»æ¶æ„ä¿å¯é ï¼Œæ™ºèƒ½è·¯ç”±ä½“éªŒå¥½
- ç›‘æ§æ•…éšœè¦å¤„ç†ï¼Œæ•°æ®ä¸€è‡´æ˜¯å…³é”®

> ğŸ¯ **å­¦ä¹ æ£€éªŒ**  
> èƒ½å¤Ÿç‹¬ç«‹é…ç½®ä¸€ä¸ªç®€å•çš„è¯»å†™åˆ†ç¦»ç¯å¢ƒï¼Œç†è§£æ•°æ®è·¯ç”±çš„åŸºæœ¬åŸç†ï¼ŒçŸ¥é“åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹éœ€è¦ä½¿ç”¨å¤šæ•°æ®æºï¼Œè¿™å°±ç®—æŒæ¡äº†æ ¸å¿ƒæ¦‚å¿µï¼