---
title: 4ã€æŸ¥è¯¢ç»“æœåŠ¨æ€æ˜ å°„
---
## ğŸ“š ç›®å½•

1. [åŠ¨æ€æ˜ å°„åŸºç¡€æ¦‚å¿µ](#1-åŠ¨æ€æ˜ å°„åŸºç¡€æ¦‚å¿µ)
2. [åå°„æœºåˆ¶åœ¨æ˜ å°„ä¸­çš„åº”ç”¨](#2-åå°„æœºåˆ¶åœ¨æ˜ å°„ä¸­çš„åº”ç”¨)
3. [æ‰‹åŠ¨å®ç°é€šç”¨æ˜ å°„å™¨](#3-æ‰‹åŠ¨å®ç°é€šç”¨æ˜ å°„å™¨)
4. [åŠ¨æ€åˆ—æ˜ å°„å¤„ç†](#4-åŠ¨æ€åˆ—æ˜ å°„å¤„ç†)
5. [è½»é‡çº§ORMæ€æƒ³](#5-è½»é‡çº§ORMæ€æƒ³)
6. [å®é™…åº”ç”¨åœºæ™¯](#6-å®é™…åº”ç”¨åœºæ™¯)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ åŠ¨æ€æ˜ å°„åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯åŠ¨æ€æ˜ å°„


**åŠ¨æ€æ˜ å°„**å°±åƒä¸€ä¸ªèªæ˜çš„ç¿»è¯‘å‘˜ï¼Œèƒ½è‡ªåŠ¨æŠŠæ•°æ®åº“çš„æŸ¥è¯¢ç»“æœè½¬æ¢æˆæˆ‘ä»¬æƒ³è¦çš„Javaå¯¹è±¡ï¼Œè€Œä¸”ä¸ç”¨æˆ‘ä»¬äº‹å…ˆå‘Šè¯‰å®ƒå…·ä½“æ€ä¹ˆè½¬æ¢ã€‚

```java
// ä¼ ç»Ÿæ–¹å¼ - æ‰‹åŠ¨æ˜ å°„ï¼ˆéº»çƒ¦ï¼‰
ResultSet rs = statement.executeQuery("SELECT id, name, age FROM user");
while(rs.next()) {
    User user = new User();
    user.setId(rs.getInt("id"));        // æ¯ä¸ªå­—æ®µéƒ½è¦æ‰‹å†™
    user.setName(rs.getString("name"));
    user.setAge(rs.getInt("age"));
}

// åŠ¨æ€æ˜ å°„ - è‡ªåŠ¨è½¬æ¢ï¼ˆè½»æ¾ï¼‰
List<User> users = dynamicMapper.queryList("SELECT id, name, age FROM user", User.class);
// å°±è¿™ä¹ˆç®€å•ï¼è‡ªåŠ¨å¸®æˆ‘ä»¬è½¬æ¢å¥½äº†
```

**ğŸ”¸ åŠ¨æ€æ˜ å°„çš„æ ¸å¿ƒä»·å€¼**
- **å‡å°‘é‡å¤ä»£ç **ï¼šä¸ç”¨ä¸ºæ¯ä¸ªæŸ¥è¯¢éƒ½å†™æ˜ å°„ä»£ç 
- **æé«˜å¼€å‘æ•ˆç‡**ï¼šå†™ä¸€æ¬¡æ˜ å°„é€»è¾‘ï¼Œåˆ°å¤„ä½¿ç”¨
- **é™ä½å‡ºé”™æ¦‚ç‡**ï¼šè‡ªåŠ¨æ˜ å°„å‡å°‘äººå·¥é”™è¯¯
- **ä»£ç æ›´ç®€æ´**ï¼šä¸“æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œä¸ç”¨å…³å¿ƒæŠ€æœ¯ç»†èŠ‚

### 1.2 åŠ¨æ€æ˜ å°„ VS ä¼ ç»Ÿæ˜ å°„


```
ä¼ ç»Ÿæ‰‹åŠ¨æ˜ å°„çš„é—®é¢˜ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¯ä¸ªæŸ¥è¯¢éƒ½è¦å†™æ˜ å°„ä»£ç            â”‚
â”‚ â†“                               â”‚
â”‚ ä»£ç é‡å¤å¤šï¼Œç»´æŠ¤å›°éš¾             â”‚
â”‚ â†“                               â”‚
â”‚ å­—æ®µå˜åŒ–æ—¶éœ€è¦ä¿®æ”¹å¤šå¤„           â”‚
â”‚ â†“                               â”‚
â”‚ å®¹æ˜“å‡ºé”™ï¼Œè°ƒè¯•å›°éš¾               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åŠ¨æ€æ˜ å°„çš„ä¼˜åŠ¿ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å†™ä¸€æ¬¡æ˜ å°„é€»è¾‘                   â”‚
â”‚ â†“                               â”‚
â”‚ è‡ªåŠ¨é€‚åº”ä¸åŒçš„æŸ¥è¯¢               â”‚
â”‚ â†“                               â”‚
â”‚ å­—æ®µå˜åŒ–è‡ªåŠ¨å¤„ç†                 â”‚
â”‚ â†“                               â”‚
â”‚ ä»£ç ç®€æ´ï¼Œæ˜“äºç»´æŠ¤               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ğŸ” åå°„æœºåˆ¶åœ¨æ˜ å°„ä¸­çš„åº”ç”¨


### 2.1 åå°„æœºåˆ¶ç®€å•ç†è§£


**åå°„**å°±åƒä¸€é¢é­”é•œï¼Œèƒ½è®©ç¨‹åºåœ¨è¿è¡Œæ—¶"çœ‹åˆ°"ç±»çš„å†…éƒ¨ç»“æ„ï¼ŒåŒ…æ‹¬å±æ€§ã€æ–¹æ³•ç­‰ï¼Œå¹¶ä¸”èƒ½åŠ¨æ€åœ°æ“ä½œè¿™äº›å†…å®¹ã€‚

```java
// åå°„çš„é­”æ³•æ¼”ç¤º
public class ReflectionDemo {
    public static void main(String[] args) throws Exception {
        // 1. è·å–ç±»çš„"é•œåƒ"
        Class<User> userClass = User.class;
        
        // 2. é€šè¿‡"é•œåƒ"åˆ›å»ºå¯¹è±¡
        User user = userClass.newInstance();
        
        // 3. è·å–å±æ€§ä¿¡æ¯
        Field nameField = userClass.getDeclaredField("name");
        nameField.setAccessible(true);  // æ‰“å¼€è®¿é—®æƒé™
        
        // 4. åŠ¨æ€è®¾ç½®å±æ€§å€¼
        nameField.set(user, "å¼ ä¸‰");
        
        System.out.println(user.getName());  // è¾“å‡ºï¼šå¼ ä¸‰
    }
}
```

**ğŸ’¡ åå°„åœ¨æ˜ å°„ä¸­çš„ä½œç”¨**
```
æ•°æ®åº“æŸ¥è¯¢ç»“æœ    â†’    åå°„åˆ†æç›®æ ‡ç±»    â†’    è‡ªåŠ¨æ˜ å°„
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id: 1       â”‚      â”‚ å‘ç°Userç±»æœ‰ â”‚      â”‚ user.setId(1) â”‚
â”‚ name: "å¼ ä¸‰" â”‚  â†’   â”‚ idå±æ€§      â”‚  â†’   â”‚ user.setName() â”‚
â”‚ age: 25     â”‚      â”‚ nameå±æ€§    â”‚      â”‚ user.setAge() â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ ageå±æ€§     â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 åå°„æ“ä½œæ ¸å¿ƒä»£ç 


```java
public class ReflectionUtil {
    
    // è·å–ç±»çš„æ‰€æœ‰å±æ€§ï¼ˆåŒ…æ‹¬ç§æœ‰çš„ï¼‰
    public static Field[] getAllFields(Class<?> clazz) {
        return clazz.getDeclaredFields();
    }
    
    // æ ¹æ®å±æ€§åè·å–å±æ€§
    public static Field getField(Class<?> clazz, String fieldName) {
        try {
            Field field = clazz.getDeclaredField(fieldName);
            field.setAccessible(true);  // è®¾ç½®å¯è®¿é—®ç§æœ‰å±æ€§
            return field;
        } catch (Exception e) {
            return null;
        }
    }
    
    // ç»™å¯¹è±¡çš„å±æ€§è®¾ç½®å€¼
    public static void setFieldValue(Object obj, String fieldName, Object value) {
        try {
            Field field = getField(obj.getClass(), fieldName);
            if (field != null) {
                field.set(obj, value);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    
    // è·å–å¯¹è±¡å±æ€§çš„å€¼
    public static Object getFieldValue(Object obj, String fieldName) {
        try {
            Field field = getField(obj.getClass(), fieldName);
            return field != null ? field.get(obj) : null;
        } catch (Exception e) {
            return null;
        }
    }
}
```

---

## 3. ğŸ› ï¸ æ‰‹åŠ¨å®ç°é€šç”¨æ˜ å°„å™¨


### 3.1 é€šç”¨æ˜ å°„å™¨è®¾è®¡æ€è·¯


æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ª"ä¸‡èƒ½æ˜ å°„å™¨"ï¼Œå®ƒèƒ½æŠŠä»»ä½•æŸ¥è¯¢ç»“æœè½¬æ¢æˆä»»ä½•Javaå¯¹è±¡ã€‚å°±åƒä¸€ä¸ªä¸‡èƒ½å……ç”µå™¨ï¼Œé€‚é…æ‰€æœ‰è®¾å¤‡ã€‚

```
è®¾è®¡æ€è·¯æµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æ‰§è¡ŒSQLæŸ¥è¯¢   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. åˆ†æç›®æ ‡ç±»    â”‚  â† ç”¨åå°„çœ‹çœ‹ç›®æ ‡ç±»æœ‰å“ªäº›å±æ€§
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. åŒ¹é…åˆ—åå±æ€§  â”‚  â† æ•°æ®åº“åˆ—å VS Javaå±æ€§å
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. è‡ªåŠ¨ç±»å‹è½¬æ¢  â”‚  â† æ•°æ®åº“ç±»å‹ â†’ Javaç±»å‹
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. åˆ›å»ºå¹¶è¿”å›å¯¹è±¡ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 åŸºç¡€ç‰ˆé€šç”¨æ˜ å°„å™¨å®ç°


```java
public class SimpleMapper {
    
    /**
     * é€šç”¨æŸ¥è¯¢æ–¹æ³• - è¿”å›å¯¹è±¡åˆ—è¡¨
     * @param sql SQLè¯­å¥
     * @param clazz ç›®æ ‡ç±»å‹
     * @return å¯¹è±¡åˆ—è¡¨
     */
    public static <T> List<T> queryList(String sql, Class<T> clazz) {
        List<T> results = new ArrayList<>();
        
        try (Connection conn = getConnection();
             PreparedStatement stmt = conn.prepareStatement(sql);
             ResultSet rs = stmt.executeQuery()) {
            
            // è·å–ç»“æœé›†çš„åˆ—ä¿¡æ¯
            ResultSetMetaData metaData = rs.getMetaData();
            int columnCount = metaData.getColumnCount();
            
            // è·å–ç›®æ ‡ç±»çš„æ‰€æœ‰å±æ€§
            Field[] fields = clazz.getDeclaredFields();
            Map<String, Field> fieldMap = new HashMap<>();
            for (Field field : fields) {
                field.setAccessible(true);
                fieldMap.put(field.getName().toLowerCase(), field);
            }
            
            // å¤„ç†æ¯ä¸€è¡Œæ•°æ®
            while (rs.next()) {
                T obj = clazz.newInstance();  // åˆ›å»ºå¯¹è±¡å®ä¾‹
                
                // éå†æ¯ä¸€åˆ—
                for (int i = 1; i <= columnCount; i++) {
                    String columnName = metaData.getColumnName(i).toLowerCase();
                    Object columnValue = rs.getObject(i);
                    
                    // æŸ¥æ‰¾å¯¹åº”çš„å±æ€§
                    Field field = fieldMap.get(columnName);
                    if (field != null && columnValue != null) {
                        // è®¾ç½®å±æ€§å€¼
                        field.set(obj, convertValue(columnValue, field.getType()));
                    }
                }
                
                results.add(obj);
            }
            
        } catch (Exception e) {
            e.printStackTrace();
        }
        
        return results;
    }
    
    /**
     * ç±»å‹è½¬æ¢æ–¹æ³•
     */
    private static Object convertValue(Object value, Class<?> targetType) {
        if (value == null) return null;
        
        // å¦‚æœç±»å‹å·²ç»åŒ¹é…ï¼Œç›´æ¥è¿”å›
        if (targetType.isAssignableFrom(value.getClass())) {
            return value;
        }
        
        // å­—ç¬¦ä¸²è½¬æ¢
        if (targetType == String.class) {
            return value.toString();
        }
        
        // æ•°å­—ç±»å‹è½¬æ¢
        if (targetType == Integer.class || targetType == int.class) {
            return Integer.valueOf(value.toString());
        }
        
        if (targetType == Long.class || targetType == long.class) {
            return Long.valueOf(value.toString());
        }
        
        // å¯ä»¥ç»§ç»­æ·»åŠ å…¶ä»–ç±»å‹è½¬æ¢...
        
        return value;
    }
}
```

### 3.3 ä½¿ç”¨é€šç”¨æ˜ å°„å™¨


```java
// å®šä¹‰ä¸€ä¸ªç”¨æˆ·ç±»
public class User {
    private Integer id;
    private String name;
    private Integer age;
    private String email;
    
    // getterå’Œsetteræ–¹æ³•...
}

// ä½¿ç”¨é€šç”¨æ˜ å°„å™¨
public class MapperTest {
    public static void main(String[] args) {
        // æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·
        List<User> users = SimpleMapper.queryList(
            "SELECT id, name, age, email FROM users", 
            User.class
        );
        
        // æ¡ä»¶æŸ¥è¯¢ä¹Ÿå¾ˆç®€å•
        List<User> adults = SimpleMapper.queryList(
            "SELECT id, name, age, email FROM users WHERE age >= 18", 
            User.class
        );
        
        // æ‰“å°ç»“æœ
        users.forEach(user -> {
            System.out.println("ç”¨æˆ·ï¼š" + user.getName() + ", å¹´é¾„ï¼š" + user.getAge());
        });
    }
}
```

---

## 4. ğŸ›ï¸ åŠ¨æ€åˆ—æ˜ å°„å¤„ç†


### 4.1 åˆ—åä¸å±æ€§åæ˜ å°„ç­–ç•¥


åœ¨å®é™…å¼€å‘ä¸­ï¼Œæ•°æ®åº“åˆ—åå’ŒJavaå±æ€§åç»å¸¸ä¸ä¸€è‡´ï¼Œæˆ‘ä»¬éœ€è¦æ™ºèƒ½çš„æ˜ å°„ç­–ç•¥ã€‚

```java
public class ColumnMapper {
    
    /**
     * åˆ—åæ˜ å°„ç­–ç•¥æšä¸¾
     */
    public enum MappingStrategy {
        EXACT,           // ç²¾ç¡®åŒ¹é…ï¼šuser_name â†’ user_name
        CAMEL_CASE,      // é©¼å³°è½¬æ¢ï¼šuser_name â†’ userName  
        IGNORE_CASE,     // å¿½ç•¥å¤§å°å†™ï¼šUSER_NAME â†’ username
        CUSTOM           // è‡ªå®šä¹‰æ˜ å°„
    }
    
    /**
     * æ ¹æ®ç­–ç•¥è½¬æ¢åˆ—ååˆ°å±æ€§å
     */
    public static String mapColumnToField(String columnName, MappingStrategy strategy) {
        switch (strategy) {
            case EXACT:
                return columnName;
                
            case CAMEL_CASE:
                return toCamelCase(columnName);
                
            case IGNORE_CASE:
                return columnName.toLowerCase();
                
            default:
                return columnName;
        }
    }
    
    /**
     * ä¸‹åˆ’çº¿è½¬é©¼å³°å‘½å
     * user_name â†’ userName
     */
    private static String toCamelCase(String columnName) {
        if (columnName == null || !columnName.contains("_")) {
            return columnName;
        }
        
        StringBuilder result = new StringBuilder();
        boolean toUpperCase = false;
        
        for (char c : columnName.toCharArray()) {
            if (c == '_') {
                toUpperCase = true;
            } else {
                if (toUpperCase) {
                    result.append(Character.toUpperCase(c));
                    toUpperCase = false;
                } else {
                    result.append(Character.toLowerCase(c));
                }
            }
        }
        
        return result.toString();
    }
}
```

### 4.2 å¢å¼ºç‰ˆé€šç”¨æ˜ å°„å™¨


```java
public class EnhancedMapper {
    
    public static <T> List<T> queryList(String sql, Class<T> clazz, 
                                       ColumnMapper.MappingStrategy strategy) {
        List<T> results = new ArrayList<>();
        
        try (Connection conn = getConnection();
             PreparedStatement stmt = conn.prepareStatement(sql);
             ResultSet rs = stmt.executeQuery()) {
            
            // è·å–ç»“æœé›†ä¿¡æ¯
            ResultSetMetaData metaData = rs.getMetaData();
            int columnCount = metaData.getColumnCount();
            
            // æ„å»ºå±æ€§æ˜ å°„è¡¨
            Map<String, Field> fieldMap = buildFieldMap(clazz);
            
            // æ„å»ºåˆ—ååˆ°å±æ€§åçš„æ˜ å°„
            Map<String, String> columnToFieldMap = new HashMap<>();
            for (int i = 1; i <= columnCount; i++) {
                String columnName = metaData.getColumnName(i);
                String fieldName = ColumnMapper.mapColumnToField(columnName, strategy);
                columnToFieldMap.put(columnName, fieldName);
            }
            
            // å¤„ç†ç»“æœé›†
            while (rs.next()) {
                T obj = clazz.newInstance();
                
                for (int i = 1; i <= columnCount; i++) {
                    String columnName = metaData.getColumnName(i);
                    Object columnValue = rs.getObject(i);
                    
                    String fieldName = columnToFieldMap.get(columnName);
                    Field field = fieldMap.get(fieldName.toLowerCase());
                    
                    if (field != null && columnValue != null) {
                        Object convertedValue = TypeConverter.convert(columnValue, field.getType());
                        field.set(obj, convertedValue);
                    }
                }
                
                results.add(obj);
            }
            
        } catch (Exception e) {
            e.printStackTrace();
        }
        
        return results;
    }
    
    /**
     * æ„å»ºç±»çš„å±æ€§æ˜ å°„è¡¨
     */
    private static Map<String, Field> buildFieldMap(Class<?> clazz) {
        Map<String, Field> fieldMap = new HashMap<>();
        Field[] fields = clazz.getDeclaredFields();
        
        for (Field field : fields) {
            field.setAccessible(true);
            fieldMap.put(field.getName().toLowerCase(), field);
        }
        
        return fieldMap;
    }
}
```

### 4.3 å®é™…åº”ç”¨ç¤ºä¾‹


```java
// æ•°æ®åº“è¡¨ç»“æ„
/*
CREATE TABLE user_info (
    user_id INT PRIMARY KEY,
    user_name VARCHAR(50),
    user_age INT,
    email_address VARCHAR(100)
);
*/

// Javaå®ä½“ç±»
public class UserInfo {
    private Integer userId;      // å¯¹åº” user_id
    private String userName;     // å¯¹åº” user_name  
    private Integer userAge;     // å¯¹åº” user_age
    private String emailAddress; // å¯¹åº” email_address
    
    // getterå’Œsetter...
}

// ä½¿ç”¨å¢å¼ºç‰ˆæ˜ å°„å™¨
public class TestEnhancedMapper {
    public static void main(String[] args) {
        // ä½¿ç”¨é©¼å³°è½¬æ¢ç­–ç•¥
        List<UserInfo> users = EnhancedMapper.queryList(
            "SELECT user_id, user_name, user_age, email_address FROM user_info",
            UserInfo.class,
            ColumnMapper.MappingStrategy.CAMEL_CASE
        );
        
        // è‡ªåŠ¨å®Œæˆæ˜ å°„ï¼š
        // user_id â†’ userId
        // user_name â†’ userName
        // user_age â†’ userAge  
        // email_address â†’ emailAddress
        
        users.forEach(user -> {
            System.out.println("ID: " + user.getUserId() + 
                             ", å§“å: " + user.getUserName() + 
                             ", å¹´é¾„: " + user.getUserAge());
        });
    }
}
```

---

## 5. ğŸ’¡ è½»é‡çº§ORMæ€æƒ³


### 5.1 ä»€ä¹ˆæ˜¯ORM


**ORMï¼ˆObject-Relational Mappingï¼‰**å°±æ˜¯å¯¹è±¡å…³ç³»æ˜ å°„ï¼Œç®€å•è¯´å°±æ˜¯è®©æˆ‘ä»¬ç”¨é¢å‘å¯¹è±¡çš„æ–¹å¼æ¥æ“ä½œæ•°æ®åº“ï¼Œä¸ç”¨å†™å¤æ‚çš„SQLè¯­å¥ã€‚

```
ä¼ ç»Ÿæ–¹å¼ï¼šæˆ‘ä»¬ç›´æ¥å’Œæ•°æ®åº“"è¯´è¯"
ç¨‹åºå‘˜ â†’ SQLè¯­å¥ â†’ æ•°æ®åº“

ORMæ–¹å¼ï¼šORMå¸®æˆ‘ä»¬"ç¿»è¯‘"
ç¨‹åºå‘˜ â†’ Javaå¯¹è±¡æ“ä½œ â†’ ORMç¿»è¯‘ â†’ SQLè¯­å¥ â†’ æ•°æ®åº“
```

**ğŸ”¸ ORMçš„æ ¸å¿ƒä»·å€¼**
- **ç®€åŒ–å¼€å‘**ï¼šç”¨å¯¹è±¡æ“ä½œä»£æ›¿SQLç¼–å†™
- **å‡å°‘é”™è¯¯**ï¼šè‡ªåŠ¨å¤„ç†SQLè¯­æ³•å’Œç±»å‹è½¬æ¢
- **æé«˜æ•ˆç‡**ï¼šä¸“æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œä¸ç”¨å…³å¿ƒåº•å±‚ç»†èŠ‚
- **æ˜“äºç»´æŠ¤**ï¼šé¢å‘å¯¹è±¡çš„ä»£ç æ›´å®¹æ˜“ç†è§£å’Œä¿®æ”¹

### 5.2 è½»é‡çº§ORMè®¾è®¡


```java
/**
 * è½»é‡çº§ORMæ ¸å¿ƒç±»
 */
public class LightORM {
    
    private static final Map<Class<?>, TableInfo> tableCache = new HashMap<>();
    
    /**
     * ä¿å­˜å¯¹è±¡åˆ°æ•°æ®åº“
     */
    public static <T> boolean save(T entity) {
        try {
            TableInfo tableInfo = getTableInfo(entity.getClass());
            String sql = buildInsertSQL(tableInfo);
            
            try (Connection conn = getConnection();
                 PreparedStatement stmt = conn.prepareStatement(sql)) {
                
                // è®¾ç½®å‚æ•°å€¼
                int paramIndex = 1;
                for (FieldInfo field : tableInfo.getFields()) {
                    Object value = field.getField().get(entity);
                    stmt.setObject(paramIndex++, value);
                }
                
                return stmt.executeUpdate() > 0;
            }
            
        } catch (Exception e) {
            e.printStackTrace();
            return false;
        }
    }
    
    /**
     * æ ¹æ®IDæŸ¥è¯¢å¯¹è±¡
     */
    public static <T> T findById(Class<T> clazz, Object id) {
        try {
            TableInfo tableInfo = getTableInfo(clazz);
            String sql = "SELECT * FROM " + tableInfo.getTableName() + 
                        " WHERE " + tableInfo.getIdField().getColumnName() + " = ?";
            
            try (Connection conn = getConnection();
                 PreparedStatement stmt = conn.prepareStatement(sql)) {
                
                stmt.setObject(1, id);
                try (ResultSet rs = stmt.executeQuery()) {
                    if (rs.next()) {
                        return mapResultToObject(rs, clazz, tableInfo);
                    }
                }
            }
            
        } catch (Exception e) {
            e.printStackTrace();
        }
        
        return null;
    }
    
    /**
     * æ›´æ–°å¯¹è±¡
     */
    public static <T> boolean update(T entity) {
        try {
            TableInfo tableInfo = getTableInfo(entity.getClass());
            String sql = buildUpdateSQL(tableInfo);
            
            try (Connection conn = getConnection();
                 PreparedStatement stmt = conn.prepareStatement(sql)) {
                
                int paramIndex = 1;
                
                // è®¾ç½®æ›´æ–°å­—æ®µçš„å€¼
                for (FieldInfo field : tableInfo.getFields()) {
                    if (!field.isIdField()) {
                        Object value = field.getField().get(entity);
                        stmt.setObject(paramIndex++, value);
                    }
                }
                
                // è®¾ç½®WHEREæ¡ä»¶çš„IDå€¼
                Object idValue = tableInfo.getIdField().getField().get(entity);
                stmt.setObject(paramIndex, idValue);
                
                return stmt.executeUpdate() > 0;
            }
            
        } catch (Exception e) {
            e.printStackTrace();
            return false;
        }
    }
}
```

### 5.3 è¡¨ä¿¡æ¯ç¼“å­˜è®¾è®¡


```java
/**
 * è¡¨ä¿¡æ¯ç±» - ç¼“å­˜è¡¨å’Œå­—æ®µçš„æ˜ å°„å…³ç³»
 */
public class TableInfo {
    private String tableName;           // è¡¨å
    private FieldInfo idField;          // ä¸»é”®å­—æ®µ
    private List<FieldInfo> fields;     // æ‰€æœ‰å­—æ®µ
    
    // getterå’Œsetter...
}

/**
 * å­—æ®µä¿¡æ¯ç±»
 */
public class FieldInfo {
    private Field field;        // Javaå­—æ®µ
    private String columnName;  // æ•°æ®åº“åˆ—å
    private boolean isIdField;  // æ˜¯å¦ä¸»é”®
    
    // getterå’Œsetter...
}

/**
 * è¡¨ä¿¡æ¯è§£æå™¨
 */
public class TableInfoParser {
    
    public static TableInfo parseTableInfo(Class<?> clazz) {
        TableInfo tableInfo = new TableInfo();
        
        // è§£æè¡¨åï¼ˆå¯ä»¥é€šè¿‡æ³¨è§£æˆ–ç±»åï¼‰
        String tableName = getTableName(clazz);
        tableInfo.setTableName(tableName);
        
        // è§£æå­—æ®µä¿¡æ¯
        List<FieldInfo> fields = new ArrayList<>();
        Field[] declaredFields = clazz.getDeclaredFields();
        
        for (Field field : declaredFields) {
            field.setAccessible(true);
            
            FieldInfo fieldInfo = new FieldInfo();
            fieldInfo.setField(field);
            fieldInfo.setColumnName(getColumnName(field));
            fieldInfo.setIdField(isIdField(field));
            
            fields.add(fieldInfo);
            
            // è®°å½•ä¸»é”®å­—æ®µ
            if (fieldInfo.isIdField()) {
                tableInfo.setIdField(fieldInfo);
            }
        }
        
        tableInfo.setFields(fields);
        return tableInfo;
    }
    
    private static String getTableName(Class<?> clazz) {
        // ç®€å•å®ç°ï¼šç±»åè½¬æ¢ä¸ºè¡¨å
        String className = clazz.getSimpleName();
        return className.toLowerCase();
    }
    
    private static String getColumnName(Field field) {
        // ç®€å•å®ç°ï¼šå­—æ®µåå°±æ˜¯åˆ—å
        return field.getName();
    }
    
    private static boolean isIdField(Field field) {
        // ç®€å•å®ç°ï¼šåä¸ºidçš„å­—æ®µå°±æ˜¯ä¸»é”®
        return "id".equals(field.getName());
    }
}
```

---

## 6. ğŸš€ å®é™…åº”ç”¨åœºæ™¯


### 6.1 Webåº”ç”¨ä¸­çš„ä½¿ç”¨åœºæ™¯


**åœºæ™¯1ï¼šç”¨æˆ·ç®¡ç†ç³»ç»Ÿ**

```java
// ç”¨æˆ·å®ä½“ç±»
public class User {
    private Integer id;
    private String username;
    private String password;
    private String email;
    private Date createTime;
    
    // getterå’Œsetter...
}

// ç”¨æˆ·æœåŠ¡ç±»
public class UserService {
    
    // ç”¨æˆ·æ³¨å†Œ
    public boolean register(String username, String password, String email) {
        User user = new User();
        user.setUsername(username);
        user.setPassword(password);
        user.setEmail(email);
        user.setCreateTime(new Date());
        
        // ä½¿ç”¨è½»é‡çº§ORMä¿å­˜
        return LightORM.save(user);
    }
    
    // ç”¨æˆ·ç™»å½•éªŒè¯
    public User login(String username, String password) {
        // ä½¿ç”¨é€šç”¨æ˜ å°„å™¨æŸ¥è¯¢
        List<User> users = EnhancedMapper.queryList(
            "SELECT * FROM user WHERE username = ? AND password = ?",
            User.class,
            ColumnMapper.MappingStrategy.CAMEL_CASE
        );
        
        return users.isEmpty() ? null : users.get(0);
    }
    
    // è·å–æ‰€æœ‰ç”¨æˆ·
    public List<User> getAllUsers() {
        return EnhancedMapper.queryList(
            "SELECT id, username, email, create_time FROM user ORDER BY create_time DESC",
            User.class,
            ColumnMapper.MappingStrategy.CAMEL_CASE
        );
    }
}
```

**åœºæ™¯2ï¼šå•†å“ç®¡ç†ç³»ç»Ÿ**

```java
// å•†å“å®ä½“
public class Product {
    private Long productId;
    private String productName;
    private BigDecimal price;
    private Integer stock;
    private String category;
    
    // getterå’Œsetter...
}

// å•†å“æœåŠ¡
public class ProductService {
    
    // æŒ‰åˆ†ç±»æŸ¥è¯¢å•†å“
    public List<Product> getProductsByCategory(String category) {
        return EnhancedMapper.queryList(
            "SELECT product_id, product_name, price, stock, category " +
            "FROM product WHERE category = ? AND stock > 0",
            Product.class,
            ColumnMapper.MappingStrategy.CAMEL_CASE
        );
    }
    
    // å•†å“æœç´¢
    public List<Product> searchProducts(String keyword) {
        return EnhancedMapper.queryList(
            "SELECT * FROM product WHERE product_name LIKE ? OR category LIKE ?",
            Product.class,
            ColumnMapper.MappingStrategy.CAMEL_CASE
        );
    }
}
```

### 6.2 æ€§èƒ½ä¼˜åŒ–æŠ€å·§


**æŠ€å·§1ï¼šè¿æ¥æ± ç®¡ç†**

```java
public class ConnectionManager {
    
    private static final String URL = "jdbc:mysql://localhost:3306/test";
    private static final String USER = "root";
    private static final String PASSWORD = "password";
    
    // ç®€å•çš„è¿æ¥æ± ï¼ˆå®é™…é¡¹ç›®å»ºè®®ä½¿ç”¨ä¸“ä¸šè¿æ¥æ± å¦‚HikariCPï¼‰
    private static final Queue<Connection> connectionPool = new LinkedList<>();
    private static final int MAX_POOL_SIZE = 10;
    
    static {
        try {
            Class.forName("com.mysql.cj.jdbc.Driver");
            // åˆå§‹åŒ–è¿æ¥æ± 
            for (int i = 0; i < MAX_POOL_SIZE; i++) {
                connectionPool.offer(DriverManager.getConnection(URL, USER, PASSWORD));
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    
    public static Connection getConnection() throws SQLException {
        Connection conn = connectionPool.poll();
        if (conn == null || conn.isClosed()) {
            conn = DriverManager.getConnection(URL, USER, PASSWORD);
        }
        return conn;
    }
    
    public static void returnConnection(Connection conn) {
        if (conn != null && connectionPool.size() < MAX_POOL_SIZE) {
            try {
                if (!conn.isClosed()) {
                    connectionPool.offer(conn);
                }
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }
    }
}
```

**æŠ€å·§2ï¼šç¼“å­˜æœºåˆ¶**

```java
public class CacheableMapper {
    
    private static final Map<String, Object> queryCache = new HashMap<>();
    private static final long CACHE_EXPIRE_TIME = 5 * 60 * 1000; // 5åˆ†é’Ÿ
    
    public static <T> List<T> queryListWithCache(String sql, Class<T> clazz) {
        String cacheKey = sql + "_" + clazz.getName();
        CacheItem cacheItem = (CacheItem) queryCache.get(cacheKey);
        
        // æ£€æŸ¥ç¼“å­˜æ˜¯å¦å­˜åœ¨ä¸”æœªè¿‡æœŸ
        if (cacheItem != null && 
            System.currentTimeMillis() - cacheItem.getCreateTime() < CACHE_EXPIRE_TIME) {
            return (List<T>) cacheItem.getData();
        }
        
        // ç¼“å­˜ä¸å­˜åœ¨æˆ–å·²è¿‡æœŸï¼Œé‡æ–°æŸ¥è¯¢
        List<T> result = EnhancedMapper.queryList(sql, clazz, 
                                                ColumnMapper.MappingStrategy.CAMEL_CASE);
        
        // å­˜å…¥ç¼“å­˜
        queryCache.put(cacheKey, new CacheItem(result, System.currentTimeMillis()));
        
        return result;
    }
    
    private static class CacheItem {
        private Object data;
        private long createTime;
        
        public CacheItem(Object data, long createTime) {
            this.data = data;
            this.createTime = createTime;
        }
        
        // getteræ–¹æ³•...
    }
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ åŠ¨æ€æ˜ å°„ï¼šè‡ªåŠ¨å°†æŸ¥è¯¢ç»“æœè½¬æ¢ä¸ºJavaå¯¹è±¡çš„æŠ€æœ¯
ğŸ”¸ åå°„æœºåˆ¶ï¼šç¨‹åºè¿è¡Œæ—¶åˆ†æå’Œæ“ä½œç±»ç»“æ„çš„èƒ½åŠ›
ğŸ”¸ é€šç”¨æ˜ å°„å™¨ï¼šä¸€å¥—ä»£ç é€‚é…å¤šç§æŸ¥è¯¢ç»“æœçš„æ˜ å°„å·¥å…·
ğŸ”¸ åˆ—åæ˜ å°„ï¼šå¤„ç†æ•°æ®åº“åˆ—åä¸Javaå±æ€§åä¸ä¸€è‡´çš„ç­–ç•¥
ğŸ”¸ è½»é‡çº§ORMï¼šç®€åŒ–çš„å¯¹è±¡å…³ç³»æ˜ å°„å®ç°æ€è·¯
```

### 7.2 å…³é”®æŠ€æœ¯ç†è§£


**ğŸ”¹ åå°„æŠ€æœ¯çš„æ ¸å¿ƒä½œç”¨**
```
åœ¨åŠ¨æ€æ˜ å°„ä¸­çš„ä»·å€¼ï¼š
â€¢ è¿è¡Œæ—¶è·å–ç±»çš„å±æ€§ä¿¡æ¯
â€¢ åŠ¨æ€åˆ›å»ºå¯¹è±¡å®ä¾‹
â€¢ è‡ªåŠ¨è®¾ç½®å¯¹è±¡å±æ€§å€¼
â€¢ å®ç°é€šç”¨çš„æ˜ å°„é€»è¾‘
```

**ğŸ”¹ æ˜ å°„ç­–ç•¥çš„é€‰æ‹©**
```
ä¸åŒåœºæ™¯çš„æœ€ä½³ç­–ç•¥ï¼š
â€¢ åˆ—åå®Œå…¨åŒ¹é…ï¼šä½¿ç”¨EXACTç­–ç•¥
â€¢ æ•°æ®åº“ä½¿ç”¨ä¸‹åˆ’çº¿å‘½åï¼šä½¿ç”¨CAMEL_CASEç­–ç•¥  
â€¢ å¤§å°å†™ä¸æ•æ„Ÿï¼šä½¿ç”¨IGNORE_CASEç­–ç•¥
â€¢ å¤æ‚æ˜ å°„å…³ç³»ï¼šä½¿ç”¨CUSTOMç­–ç•¥
```

### 7.3 å®é™…å¼€å‘ä»·å€¼


**ğŸ’¡ å¼€å‘æ•ˆç‡æå‡**
- **å‡å°‘é‡å¤ä»£ç **ï¼šä¸€å¥—æ˜ å°„é€»è¾‘å¤„ç†æ‰€æœ‰æŸ¥è¯¢
- **é™ä½ç»´æŠ¤æˆæœ¬**ï¼šå­—æ®µå˜åŒ–æ—¶è‡ªåŠ¨é€‚é…
- **æé«˜å¼€å‘é€Ÿåº¦**ï¼šä¸“æ³¨ä¸šåŠ¡é€»è¾‘è€ŒéæŠ€æœ¯ç»†èŠ‚

**ğŸš€ ä»£ç è´¨é‡æ”¹å–„**  
- **å‡å°‘äººå·¥é”™è¯¯**ï¼šè‡ªåŠ¨å¤„ç†ç±»å‹è½¬æ¢å’Œå­—æ®µæ˜ å°„
- **ç»Ÿä¸€ç¼–ç é£æ ¼**ï¼šæ ‡å‡†åŒ–çš„æ•°æ®è®¿é—®æ–¹å¼
- **ä¾¿äºæµ‹è¯•**ï¼šæ¸…æ™°çš„è¾“å…¥è¾“å‡ºæ¥å£

### 7.4 å­¦ä¹ è·¯å¾„å»ºè®®


**ğŸ“š å­¦ä¹ é¡ºåº**
1. **æŒæ¡åå°„åŸºç¡€** â†’ ç†è§£åŠ¨æ€æ“ä½œç±»çš„åŸç†
2. **å®ç°ç®€å•æ˜ å°„** â†’ æ‰‹åŠ¨ç¼–å†™åŸºç¡€æ˜ å°„é€»è¾‘
3. **å¤„ç†å¤æ‚åœºæ™¯** â†’ åˆ—åè½¬æ¢ã€ç±»å‹è½¬æ¢ç­‰
4. **æ€§èƒ½ä¼˜åŒ–** â†’ ç¼“å­˜ã€è¿æ¥æ± ç­‰é«˜çº§ç‰¹æ€§
5. **å®é™…é¡¹ç›®åº”ç”¨** â†’ åœ¨çœŸå®é¡¹ç›®ä¸­ä½¿ç”¨å’Œä¼˜åŒ–

**ğŸ› ï¸ å®è·µå»ºè®®**
- ä»ç®€å•çš„å•è¡¨æŸ¥è¯¢å¼€å§‹ç»ƒä¹ 
- é€æ­¥å¢åŠ å¤æ‚åº¦ï¼ˆå…³è”æŸ¥è¯¢ã€åˆ†é¡µç­‰ï¼‰
- å…³æ³¨æ€§èƒ½å’Œå†…å­˜ä½¿ç”¨æƒ…å†µ
- å­¦ä¹ ä¸»æµORMæ¡†æ¶çš„è®¾è®¡æ€è·¯

**æ ¸å¿ƒè®°å¿†**ï¼š
- åŠ¨æ€æ˜ å°„æ˜¯è‡ªåŠ¨åŒ–çš„æ•°æ®è½¬æ¢æŠ€æœ¯
- åå°„æ˜¯å®ç°åŠ¨æ€æ˜ å°„çš„æ ¸å¿ƒå·¥å…·
- é€šç”¨æ˜ å°„å™¨è®©ä»£ç æ›´ç®€æ´é«˜æ•ˆ
- åˆé€‚çš„æ˜ å°„ç­–ç•¥è§£å†³å‘½åå·®å¼‚é—®é¢˜
- è½»é‡çº§ORMæ€æƒ³æŒ‡å¯¼å®é™…å¼€å‘