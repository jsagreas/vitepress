---
title: 2ã€åˆ†é¡µæŸ¥è¯¢é€šç”¨æ–¹æ¡ˆ
---
## ğŸ“š ç›®å½•

1. [åˆ†é¡µæŸ¥è¯¢åŸºæœ¬æ¦‚å¿µ](#1-åˆ†é¡µæŸ¥è¯¢åŸºæœ¬æ¦‚å¿µ)
2. [LIMIT/OFFSETè¯­æ³•è¯¦è§£](#2-limitoffsetè¯­æ³•è¯¦è§£)
3. [åˆ†é¡µå…¬å¼è®¡ç®—åŸç†](#3-åˆ†é¡µå…¬å¼è®¡ç®—åŸç†)
4. [åç§»æ€§èƒ½é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ](#4-åç§»æ€§èƒ½é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ)
5. [ä¸»é”®æ¸¸æ ‡åˆ†é¡µå®ç°](#5-ä¸»é”®æ¸¸æ ‡åˆ†é¡µå®ç°)
6. [åˆ†é¡µæœ€ä½³å®è·µæŒ‡å—](#6-åˆ†é¡µæœ€ä½³å®è·µæŒ‡å—)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ åˆ†é¡µæŸ¥è¯¢åŸºæœ¬æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯åˆ†é¡µæŸ¥è¯¢


**ç®€å•ç†è§£**ï¼šå°±åƒç¿»ä¹¦ä¸€æ ·ï¼Œä¸€é¡µä¸€é¡µåœ°æ˜¾ç¤ºæ•°æ®ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§æŠŠæ‰€æœ‰æ•°æ®éƒ½æ˜¾ç¤ºå‡ºæ¥ã€‚

```
æƒ³è±¡åœºæ™¯ï¼š
ç”µå•†ç½‘ç«™æœ‰10ä¸‡ä»¶å•†å“
- ä¸åˆ†é¡µï¼šä¸€æ¬¡æ˜¾ç¤º10ä¸‡ä»¶ â†’ é¡µé¢å¡æ­»ã€ç”¨æˆ·ä½“éªŒå·®
- åˆ†é¡µï¼šæ¯é¡µæ˜¾ç¤º20ä»¶ â†’ æ€»å…±5000é¡µï¼Œç”¨æˆ·å¯ä»¥ç¿»é¡µæµè§ˆ

ç°å®ç±»æ¯”ï¼š
ğŸ“– çœ‹ä¹¦ï¼šä¸€æœ¬500é¡µçš„ä¹¦ï¼Œæˆ‘ä»¬ä¸€é¡µä¸€é¡µç¿»çœ‹
ğŸª è¶…å¸‚ï¼šå•†å“åˆ†è´§æ¶æ‘†æ”¾ï¼Œé¡¾å®¢é€ä¸ªè´§æ¶æµè§ˆ
ğŸ“º ç”µè§†èŠ‚ç›®ï¼šåˆ†é›†æ’­æ”¾ï¼Œè€Œä¸æ˜¯è¿ç»­æ’­48å°æ—¶
```

### 1.2 åˆ†é¡µçš„æ ¸å¿ƒè¦ç´ 


**åˆ†é¡µä¸‰è¦ç´ **ï¼šæ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡ï¼Ÿå½“å‰ç¬¬å‡ é¡µï¼Ÿæ€»å…±å¤šå°‘æ¡ï¼Ÿ

```
æ ¸å¿ƒå‚æ•°è¯´æ˜ï¼š

pageSize (æ¯é¡µå¤§å°)ï¼š
- å«ä¹‰ï¼šæ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡è®°å½•
- å¸¸ç”¨å€¼ï¼š10ã€20ã€50ã€100
- é€‰æ‹©åŸåˆ™ï¼šæ—¢ä¸èƒ½å¤ªå°‘ï¼ˆç”¨æˆ·é¢‘ç¹ç¿»é¡µï¼‰ï¼Œä¹Ÿä¸èƒ½å¤ªå¤šï¼ˆé¡µé¢åŠ è½½æ…¢ï¼‰

pageNum (é¡µç )ï¼š
- å«ä¹‰ï¼šå½“å‰æ˜¾ç¤ºç¬¬å‡ é¡µ
- ä»1å¼€å§‹è®¡æ•°ï¼šç¬¬1é¡µã€ç¬¬2é¡µã€ç¬¬3é¡µ...
- ç”¨æˆ·ç‚¹å‡»é¡µç æŒ‰é’®æ—¶ä¼ é€’çš„å€¼

totalCount (æ€»è®°å½•æ•°)ï¼š
- å«ä¹‰ï¼šæ•°æ®åº“ä¸­ç¬¦åˆæ¡ä»¶çš„æ€»è®°å½•æ•°
- ç”¨é€”ï¼šè®¡ç®—æ€»é¡µæ•°ã€æ˜¾ç¤º"å…±æ‰¾åˆ°XXXæ¡è®°å½•"
- è·å–æ–¹å¼ï¼šæ‰§è¡ŒCOUNT(*)æŸ¥è¯¢
```

**åˆ†é¡µè®¡ç®—å…³ç³»**ï¼š
```
åŸºç¡€å…¬å¼ï¼š
æ€»é¡µæ•° = æ€»è®°å½•æ•° Ã· æ¯é¡µå¤§å°ï¼ˆå‘ä¸Šå–æ•´ï¼‰
èµ·å§‹ä½ç½® = (å½“å‰é¡µç  - 1) Ã— æ¯é¡µå¤§å°

ä¸¾ä¾‹è¯´æ˜ï¼š
æ€»è®°å½•æ•° = 156æ¡
æ¯é¡µæ˜¾ç¤º = 20æ¡
æ€»é¡µæ•° = âŒˆ156 Ã· 20âŒ‰ = 8é¡µ

ç”¨æˆ·è¦çœ‹ç¬¬3é¡µï¼š
èµ·å§‹ä½ç½® = (3 - 1) Ã— 20 = 40
æ„æ€æ˜¯ï¼šè·³è¿‡å‰40æ¡è®°å½•ï¼Œä»ç¬¬41æ¡å¼€å§‹å–20æ¡
```

### 1.3 åˆ†é¡µçš„ä¸šåŠ¡ä»·å€¼


**ğŸ”¸ ç”¨æˆ·ä½“éªŒæå‡**
- é¡µé¢åŠ è½½é€Ÿåº¦å¿«ï¼ˆåªåŠ è½½ä¸€é¡µæ•°æ®ï¼‰
- ç•Œé¢ç®€æ´æ¸…æ™°ï¼ˆé¿å…ä¿¡æ¯è¿‡è½½ï¼‰
- æ“ä½œå“åº”è¿…é€Ÿï¼ˆå‡å°‘ç­‰å¾…æ—¶é—´ï¼‰

**ğŸ”¸ ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–**
- å‡å°‘æ•°æ®åº“æŸ¥è¯¢å‹åŠ›ï¼ˆæ¯æ¬¡åªæŸ¥å°‘é‡æ•°æ®ï¼‰
- é™ä½ç½‘ç»œä¼ è¾“å¼€é”€ï¼ˆä¼ è¾“æ•°æ®é‡å°ï¼‰
- èŠ‚çœæœåŠ¡å™¨å†…å­˜å ç”¨ï¼ˆå¤„ç†æ•°æ®é‡å°‘ï¼‰

**ğŸ”¸ ä¸šåŠ¡åœºæ™¯é€‚åº”**
- æœç´¢ç»“æœå±•ç¤ºï¼ˆç™¾åº¦æœç´¢ã€å•†å“æœç´¢ï¼‰
- æ•°æ®åˆ—è¡¨ç®¡ç†ï¼ˆç”¨æˆ·ç®¡ç†ã€è®¢å•ç®¡ç†ï¼‰
- å†…å®¹æµè§ˆå¯¼èˆªï¼ˆæ–°é—»åˆ—è¡¨ã€æ–‡ç« åˆ—è¡¨ï¼‰

---

## 2. ğŸ“– LIMIT/OFFSETè¯­æ³•è¯¦è§£


### 2.1 LIMITåŸºç¡€è¯­æ³•


**LIMITè¯­æ³•ä½œç”¨**ï¼šé™åˆ¶æŸ¥è¯¢ç»“æœè¿”å›çš„è®°å½•æ•°é‡

```sql
-- åŸºç¡€è¯­æ³•æ ¼å¼
SELECT * FROM è¡¨å LIMIT æ•°é‡;

-- å®é™…ä¾‹å­ï¼šåªè¦å‰5æ¡ç”¨æˆ·è®°å½•
SELECT * FROM users LIMIT 5;
```

```
æ‰§è¡Œè¿‡ç¨‹è§£é‡Šï¼š
1. æ•°æ®åº“æ‰§è¡ŒæŸ¥è¯¢ï¼šSELECT * FROM users
2. åœ¨æ‰€æœ‰ç»“æœä¸­å–å‰5æ¡
3. è¿”å›è¿™5æ¡è®°å½•ç»™åº”ç”¨ç¨‹åº

å°±åƒè¯´ï¼š"ç»™æˆ‘ç”¨æˆ·è¡¨çš„æ•°æ®ï¼Œä½†æ˜¯åªè¦å‰5ä¸ªå°±å¤Ÿäº†"
```

### 2.2 OFFSETåç§»è¯­æ³•


**OFFSETä½œç”¨**ï¼šè·³è¿‡æŒ‡å®šæ•°é‡çš„è®°å½•ï¼Œä»æŸä¸ªä½ç½®å¼€å§‹å–æ•°æ®

```sql
-- å®Œæ•´è¯­æ³•æ ¼å¼
SELECT * FROM è¡¨å LIMIT æ•°é‡ OFFSET è·³è¿‡æ•°é‡;

-- å®é™…ä¾‹å­ï¼šè·³è¿‡å‰10æ¡ï¼Œå–æ¥ä¸‹æ¥çš„5æ¡
SELECT * FROM users LIMIT 5 OFFSET 10;
```

```
æ‰§è¡Œè¿‡ç¨‹å›¾ç¤ºï¼š

æ•°æ®åº“è®°å½•ï¼š[1][2][3][4][5][6][7][8][9][10][11][12][13][14][15]...
                                    â†‘
                                è·³è¿‡å‰10æ¡
                                          [11][12][13][14][15]
                                            â†‘
                                        å–è¿™5æ¡è®°å½•

ç»“æœï¼šè¿”å›ç¬¬11ã€12ã€13ã€14ã€15æ¡è®°å½•
```

### 2.3 åˆ†é¡µæŸ¥è¯¢å®ç°


**åˆ†é¡µSQLæ„å»º**ï¼š

```sql
-- ç¬¬1é¡µï¼šæ˜¾ç¤ºå‰20æ¡
SELECT * FROM products LIMIT 20 OFFSET 0;

-- ç¬¬2é¡µï¼šè·³è¿‡å‰20æ¡ï¼Œæ˜¾ç¤ºæ¥ä¸‹æ¥20æ¡  
SELECT * FROM products LIMIT 20 OFFSET 20;

-- ç¬¬3é¡µï¼šè·³è¿‡å‰40æ¡ï¼Œæ˜¾ç¤ºæ¥ä¸‹æ¥20æ¡
SELECT * FROM products LIMIT 20 OFFSET 40;
```

**Javaä»£ç å®ç°**ï¼š
```java
public class PaginationExample {
    // åˆ†é¡µæŸ¥è¯¢æ–¹æ³•
    public List<Product> getProductsByPage(int pageNum, int pageSize) {
        // è®¡ç®—åç§»é‡
        int offset = (pageNum - 1) * pageSize;
        
        String sql = "SELECT * FROM products LIMIT ? OFFSET ?";
        
        // ä½¿ç”¨PreparedStatementæ‰§è¡ŒæŸ¥è¯¢
        try (PreparedStatement stmt = connection.prepareStatement(sql)) {
            stmt.setInt(1, pageSize);    // è®¾ç½®LIMITå‚æ•°
            stmt.setInt(2, offset);      // è®¾ç½®OFFSETå‚æ•°
            
            ResultSet rs = stmt.executeQuery();
            return convertToProductList(rs);
        }
    }
}
```

### 2.4 ä¸åŒæ•°æ®åº“çš„è¯­æ³•å·®å¼‚


**MySQLè¯­æ³•**ï¼š
```sql
-- MySQLæ ‡å‡†è¯­æ³•
SELECT * FROM users LIMIT 20 OFFSET 40;

-- MySQLç®€åŒ–è¯­æ³•ï¼ˆOFFSETåœ¨å‰ï¼‰
SELECT * FROM users LIMIT 40, 20;
```

**å…¶ä»–æ•°æ®åº“å¯¹æ¯”**ï¼š

| æ•°æ®åº“ | **åˆ†é¡µè¯­æ³•** | **ç¤ºä¾‹** |
|--------|-------------|----------|
| **MySQL** | `LIMIT size OFFSET skip` | `LIMIT 20 OFFSET 40` |
| **PostgreSQL** | `LIMIT size OFFSET skip` | `LIMIT 20 OFFSET 40` |
| **SQL Server** | `OFFSET skip ROWS FETCH NEXT size ROWS ONLY` | `OFFSET 40 ROWS FETCH NEXT 20 ROWS ONLY` |
| **Oracle** | `ROWNUM` æˆ– `ROW_NUMBER()` | è¾ƒå¤æ‚ï¼Œéœ€å­æŸ¥è¯¢ |

> **æ–°æ‰‹æç¤º**ï¼šå­¦ä¹ æ—¶é‡ç‚¹æŒæ¡MySQLçš„LIMIT/OFFSETè¯­æ³•ï¼Œå› ä¸ºå®ƒæœ€ç®€å•æ˜“æ‡‚ï¼Œå…¶ä»–æ•°æ®åº“çš„è¯­æ³•å¯ä»¥åç»­å­¦ä¹ æ—¶å†äº†è§£ã€‚

---

## 3. ğŸ§® åˆ†é¡µå…¬å¼è®¡ç®—åŸç†


### 3.1 æ ¸å¿ƒè®¡ç®—å…¬å¼


**åˆ†é¡µè®¡ç®—çš„æ•°å­¦åŸç†**ï¼š

```
åˆ†é¡µè®¡ç®—å…¬å¼ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OFFSET = (pageNum - 1) Ã— pageSize  â”‚
â”‚ LIMIT = pageSize                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¸ºä»€ä¹ˆè¦å‡1ï¼Ÿ
- é¡µç ä»1å¼€å§‹è®¡æ•°ï¼ˆç¬¬1é¡µã€ç¬¬2é¡µ...ï¼‰
- æ•°ç»„ç´¢å¼•ä»0å¼€å§‹è®¡æ•°ï¼ˆ0ã€1ã€2...ï¼‰
- æ‰€ä»¥éœ€è¦è½¬æ¢ï¼šé¡µç 1 â†’ åç§»0ï¼Œé¡µç 2 â†’ åç§»20
```

### 3.2 è®¡ç®—è¿‡ç¨‹è¯¦è§£


**å®é™…è®¡ç®—ç¤ºä¾‹**ï¼š

```
åœºæ™¯è®¾ç½®ï¼š
- æ€»è®°å½•æ•°ï¼š156æ¡å•†å“
- æ¯é¡µæ˜¾ç¤ºï¼š20æ¡å•†å“
- ç”¨æˆ·è¦çœ‹ï¼šç¬¬4é¡µ

æ­¥éª¤1ï¼šè®¡ç®—åç§»é‡
OFFSET = (4 - 1) Ã— 20 = 3 Ã— 20 = 60

æ­¥éª¤2ï¼šæ„å»ºSQL
SELECT * FROM products LIMIT 20 OFFSET 60;

æ­¥éª¤3ï¼šç†è§£å«ä¹‰
è·³è¿‡å‰60æ¡è®°å½•ï¼Œå–æ¥ä¸‹æ¥çš„20æ¡
å³ï¼šç¬¬61-80æ¡è®°å½•å°±æ˜¯ç¬¬4é¡µçš„å†…å®¹
```

**å¯è§†åŒ–ç†è§£**ï¼š
```
è®°å½•åˆ†å¸ƒå›¾ï¼š
ç¬¬1é¡µ: [1-20]    â† OFFSET=0,  LIMIT=20
ç¬¬2é¡µ: [21-40]   â† OFFSET=20, LIMIT=20  
ç¬¬3é¡µ: [41-60]   â† OFFSET=40, LIMIT=20
ç¬¬4é¡µ: [61-80]   â† OFFSET=60, LIMIT=20  â† ç”¨æˆ·è¦çœ‹çš„é¡µ
ç¬¬5é¡µ: [81-100]  â† OFFSET=80, LIMIT=20
...
```

### 3.3 è¾¹ç•Œæƒ…å†µå¤„ç†


**æœ€åä¸€é¡µçš„ç‰¹æ®Šæƒ…å†µ**ï¼š

```java
public class PaginationCalculator {
    
    public PaginationInfo calculatePagination(int totalCount, int pageNum, int pageSize) {
        // è®¡ç®—æ€»é¡µæ•°ï¼ˆå‘ä¸Šå–æ•´ï¼‰
        int totalPages = (int) Math.ceil((double) totalCount / pageSize);
        
        // å¤„ç†é¡µç è¾¹ç•Œ
        if (pageNum < 1) pageNum = 1;
        if (pageNum > totalPages) pageNum = totalPages;
        
        // è®¡ç®—åç§»é‡
        int offset = (pageNum - 1) * pageSize;
        
        // è®¡ç®—å½“å‰é¡µå®é™…è®°å½•æ•°
        int currentPageSize = pageSize;
        if (pageNum == totalPages) {
            // æœ€åä¸€é¡µå¯èƒ½ä¸è¶³pageSizeæ¡è®°å½•
            int remaining = totalCount - offset;
            currentPageSize = Math.min(remaining, pageSize);
        }
        
        return new PaginationInfo(pageNum, pageSize, totalCount, totalPages, offset);
    }
}
```

**è¾¹ç•Œæƒ…å†µç¤ºä¾‹**ï¼š
```
åœºæ™¯ï¼šæ€»è®°å½•156æ¡ï¼Œæ¯é¡µ20æ¡ï¼Œå…±8é¡µ

æ­£å¸¸é¡µï¼ˆç¬¬4é¡µï¼‰ï¼š
- è®°å½•èŒƒå›´ï¼š61-80
- å®é™…è®°å½•æ•°ï¼š20æ¡

æœ€åé¡µï¼ˆç¬¬8é¡µï¼‰ï¼š
- è®°å½•èŒƒå›´ï¼š141-156  
- å®é™…è®°å½•æ•°ï¼š16æ¡ï¼ˆä¸è¶³20æ¡ï¼‰
- è®¡ç®—ï¼š156 - 140 = 16æ¡
```

### 3.4 åˆ†é¡µä¿¡æ¯å°è£…


**åˆ†é¡µä¿¡æ¯ç±»è®¾è®¡**ï¼š

```java
public class PageResult<T> {
    private int pageNum;        // å½“å‰é¡µç 
    private int pageSize;       // æ¯é¡µå¤§å°
    private long totalCount;    // æ€»è®°å½•æ•°
    private int totalPages;     // æ€»é¡µæ•°
    private List<T> data;       // å½“å‰é¡µæ•°æ®
    
    // æ„é€ æ–¹æ³•
    public PageResult(int pageNum, int pageSize, long totalCount, List<T> data) {
        this.pageNum = pageNum;
        this.pageSize = pageSize;
        this.totalCount = totalCount;
        this.data = data;
        // è®¡ç®—æ€»é¡µæ•°
        this.totalPages = (int) Math.ceil((double) totalCount / pageSize);
    }
    
    // åˆ¤æ–­æ˜¯å¦æœ‰ä¸Šä¸€é¡µ
    public boolean hasPrevious() {
        return pageNum > 1;
    }
    
    // åˆ¤æ–­æ˜¯å¦æœ‰ä¸‹ä¸€é¡µ
    public boolean hasNext() {
        return pageNum < totalPages;
    }
    
    // è·å–ä¸Šä¸€é¡µé¡µç 
    public int getPreviousPageNum() {
        return hasPrevious() ? pageNum - 1 : 1;
    }
    
    // è·å–ä¸‹ä¸€é¡µé¡µç 
    public int getNextPageNum() {
        return hasNext() ? pageNum + 1 : totalPages;
    }
}
```

---

## 4. âš ï¸ åç§»æ€§èƒ½é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


### 4.1 OFFSETæ€§èƒ½é—®é¢˜åŸç†


**ä¸ºä»€ä¹ˆOFFSETæ…¢ï¼Ÿ**

```
OFFSETå·¥ä½œåŸç†ï¼š
1. æ•°æ®åº“æ‰«æä»ç¬¬1æ¡è®°å½•å¼€å§‹
2. é€æ¡æ•°è¿‡OFFSETæŒ‡å®šçš„æ•°é‡
3. ä¸¢å¼ƒè¿™äº›è®°å½•ï¼ˆä½†ä»ç„¶è¦å¤„ç†å®ƒä»¬ï¼‰
4. ä»OFFSET+1ä½ç½®å¼€å§‹è¿”å›LIMITæ¡è®°å½•

é—®é¢˜æ‰€åœ¨ï¼š
OFFSETè¶Šå¤§ â†’ éœ€è¦è·³è¿‡çš„è®°å½•è¶Šå¤š â†’ å¤„ç†æ—¶é—´è¶Šé•¿

å®é™…å¯¹æ¯”ï¼š
ç¬¬1é¡µï¼šOFFSET 0     â†’ å¾ˆå¿«ï¼Œç›´æ¥å–å‰20æ¡
ç¬¬100é¡µï¼šOFFSET 1980 â†’ è¾ƒæ…¢ï¼Œéœ€è¦è·³è¿‡1980æ¡è®°å½•
ç¬¬5000é¡µï¼šOFFSET 99980 â†’ å¾ˆæ…¢ï¼Œéœ€è¦è·³è¿‡99980æ¡è®°å½•
```

**æ€§èƒ½æµ‹è¯•å¯¹æ¯”**ï¼š
```
æµ‹è¯•ç¯å¢ƒï¼š100ä¸‡æ¡è®°å½•ï¼Œæ¯é¡µ20æ¡

ç¬¬1é¡µæŸ¥è¯¢æ—¶é—´ï¼š    5ms
ç¬¬1000é¡µæŸ¥è¯¢æ—¶é—´ï¼š  50ms  
ç¬¬10000é¡µæŸ¥è¯¢æ—¶é—´ï¼š 500ms
ç¬¬50000é¡µæŸ¥è¯¢æ—¶é—´ï¼š 2500ms

ç»“è®ºï¼šé¡µç è¶Šå¤§ï¼ŒæŸ¥è¯¢è¶Šæ…¢ï¼Œå‘ˆçº¿æ€§å¢é•¿è¶‹åŠ¿
```

### 4.2 æ·±åº¦åˆ†é¡µçš„é—®é¢˜åœºæ™¯


**ä»€ä¹ˆæ˜¯æ·±åº¦åˆ†é¡µ**ï¼šç”¨æˆ·æŸ¥çœ‹å¾ˆé åçš„é¡µç ï¼Œæ¯”å¦‚ç¬¬1000é¡µã€ç¬¬5000é¡µ

```
ç°å®åœºæ™¯åˆ†æï¼š

âŒ é—®é¢˜åœºæ™¯ï¼š
- ç”µå•†æœç´¢ï¼š"æ‰‹æœº"æœç´¢ç»“æœ100ä¸‡æ¡ï¼Œç”¨æˆ·ç¿»åˆ°ç¬¬5000é¡µ
- æ–°é—»ç½‘ç«™ï¼šå†å²æ–°é—»æŸ¥çœ‹ï¼Œç”¨æˆ·è¦çœ‹3å¹´å‰çš„æ–°é—»
- æ•°æ®å¯¼å‡ºï¼šç®¡ç†å‘˜è¦å¯¼å‡ºæ‰€æœ‰æ•°æ®ï¼ŒæŒ‰é¡µéå†

âœ… å®é™…æƒ…å†µï¼š
- 99%çš„ç”¨æˆ·åªçœ‹å‰å‡ é¡µç»“æœ
- å¾ˆå°‘æœ‰ç”¨æˆ·ä¼šç¿»åˆ°ç¬¬100é¡µä»¥å
- æ·±åº¦åˆ†é¡µå¾€å¾€æ˜¯çˆ¬è™«æˆ–å¼‚å¸¸è¡Œä¸º
```

### 4.3 ç´¢å¼•ä¼˜åŒ–æ–¹æ¡ˆ


**ä¸»é”®ç´¢å¼•ä¼˜åŒ–**ï¼šåˆ©ç”¨ä¸»é”®çš„æœ‰åºæ€§ï¼Œé¿å…OFFSETè®¡ç®—

```sql
-- ä¼ ç»ŸOFFSETæ–¹å¼ï¼ˆæ…¢ï¼‰
SELECT * FROM products ORDER BY id LIMIT 20 OFFSET 10000;

-- ä¸»é”®èŒƒå›´æŸ¥è¯¢æ–¹å¼ï¼ˆå¿«ï¼‰
SELECT * FROM products WHERE id > 10000 ORDER BY id LIMIT 20;
```

**ä¼˜åŒ–åŸç†è§£é‡Š**ï¼š
```
ä¼ ç»Ÿæ–¹å¼é—®é¢˜ï¼š
1. éœ€è¦æ’åºæ‰€æœ‰è®°å½•
2. è·³è¿‡å‰10000æ¡è®°å½•ï¼ˆä½†ä»è¦å¤„ç†å®ƒä»¬ï¼‰
3. è¿”å›æ¥ä¸‹æ¥20æ¡

ä¼˜åŒ–æ–¹å¼åŸç†ï¼š
1. ç›´æ¥åˆ©ç”¨ä¸»é”®ç´¢å¼•å®šä½åˆ°id>10000çš„ä½ç½®
2. ä»è¯¥ä½ç½®å¼€å§‹å–20æ¡è®°å½•
3. é¿å…äº†è·³è¿‡å¤§é‡è®°å½•çš„å¼€é”€
```

### 4.4 æ¸¸æ ‡åˆ†é¡µå®ç°


**æ¸¸æ ‡åˆ†é¡µæ¦‚å¿µ**ï¼šè®°ä½ä¸Šä¸€é¡µçš„æœ€åä¸€æ¡è®°å½•ä½ç½®ï¼Œä»è¯¥ä½ç½®ç»§ç»­æŸ¥è¯¢

```java
public class CursorPagination {
    
    // ç¬¬ä¸€é¡µæŸ¥è¯¢ï¼ˆæ²¡æœ‰æ¸¸æ ‡ï¼‰
    public PageResult<Product> getFirstPage(int pageSize) {
        String sql = "SELECT * FROM products ORDER BY id LIMIT ?";
        
        try (PreparedStatement stmt = connection.prepareStatement(sql)) {
            stmt.setInt(1, pageSize);
            ResultSet rs = stmt.executeQuery();
            
            List<Product> products = convertToList(rs);
            
            // è®°å½•æœ€åä¸€æ¡è®°å½•çš„idä½œä¸ºæ¸¸æ ‡
            Long nextCursor = products.isEmpty() ? null : 
                            products.get(products.size() - 1).getId();
            
            return new PageResult<>(products, nextCursor);
        }
    }
    
    // åç»­é¡µæŸ¥è¯¢ï¼ˆä½¿ç”¨æ¸¸æ ‡ï¼‰
    public PageResult<Product> getNextPage(Long cursor, int pageSize) {
        String sql = "SELECT * FROM products WHERE id > ? ORDER BY id LIMIT ?";
        
        try (PreparedStatement stmt = connection.prepareStatement(sql)) {
            stmt.setLong(1, cursor);
            stmt.setInt(2, pageSize);
            ResultSet rs = stmt.executeQuery();
            
            List<Product> products = convertToList(rs);
            
            // æ›´æ–°æ¸¸æ ‡ä¸ºå½“å‰é¡µæœ€åä¸€æ¡è®°å½•çš„id
            Long nextCursor = products.isEmpty() ? null : 
                            products.get(products.size() - 1).getId();
            
            return new PageResult<>(products, nextCursor);
        }
    }
}
```

**æ¸¸æ ‡åˆ†é¡µçš„ä¼˜ç¼ºç‚¹**ï¼š

| æ–¹é¢ | **ä¼˜ç‚¹** | **ç¼ºç‚¹** |
|------|----------|----------|
| **æ€§èƒ½** | æŸ¥è¯¢é€Ÿåº¦ç¨³å®šï¼Œä¸å—é¡µç å½±å“ | éœ€è¦é¢å¤–å­˜å‚¨æ¸¸æ ‡ä¿¡æ¯ |
| **ä½“éªŒ** | é€‚åˆæ— é™æ»šåŠ¨åœºæ™¯ | æ— æ³•è·³è½¬åˆ°ä»»æ„é¡µ |
| **å®ç°** | ä»£ç é€»è¾‘ç›¸å¯¹ç®€å• | éœ€è¦å®¢æˆ·ç«¯ç»´æŠ¤æ¸¸æ ‡çŠ¶æ€ |
| **é€‚ç”¨** | æ—¶é—´çº¿ã€æ¶ˆæ¯åˆ—è¡¨ç­‰åœºæ™¯ | ä¸é€‚åˆä¼ ç»Ÿç¿»é¡µåœºæ™¯ |

---

## 5. ğŸ¯ ä¸»é”®æ¸¸æ ‡åˆ†é¡µå®ç°


### 5.1 æ¸¸æ ‡åˆ†é¡µçš„æ ¸å¿ƒæ€æƒ³


**åŸºæœ¬åŸç†**ï¼šä¸ä½¿ç”¨OFFSETè·³è¿‡è®°å½•ï¼Œè€Œæ˜¯åŸºäºä¸Šä¸€é¡µçš„æœ€åä¸€æ¡è®°å½•ç»§ç»­æŸ¥è¯¢

```
ä¼ ç»Ÿåˆ†é¡µ vs æ¸¸æ ‡åˆ†é¡µï¼š

ä¼ ç»Ÿåˆ†é¡µæ€è·¯ï¼š
"ç»™æˆ‘ç¬¬100é¡µçš„æ•°æ®" â†’ è·³è¿‡å‰99é¡µï¼Œå–ç¬¬100é¡µ

æ¸¸æ ‡åˆ†é¡µæ€è·¯ï¼š  
"ç»™æˆ‘idå¤§äº12345çš„æ¥ä¸‹æ¥20æ¡æ•°æ®" â†’ ç›´æ¥ä»id=12345ä½ç½®å¼€å§‹å–

ä¼˜åŠ¿å¯¹æ¯”ï¼š
ä¼ ç»Ÿæ–¹å¼ï¼šéœ€è¦æ•°æ¸…æ¥šå‰99é¡µæœ‰å¤šå°‘æ¡è®°å½•
æ¸¸æ ‡æ–¹å¼ï¼šç›´æ¥æ‰¾åˆ°èµ·å§‹ä½ç½®ï¼Œç«‹å³å¼€å§‹å–æ•°æ®
```

### 5.2 æ¸¸æ ‡åˆ†é¡µå®Œæ•´å®ç°


**æ•°æ®åº“è¡¨ç»“æ„**ï¼š
```sql
CREATE TABLE products (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(255) NOT NULL,
    price DECIMAL(10,2) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- é‡è¦ï¼šç¡®ä¿æœ‰ä¸»é”®ç´¢å¼•ï¼Œæ¸¸æ ‡åˆ†é¡µä¾èµ–ç´¢å¼•æ€§èƒ½
```

**Javaå®Œæ•´å®ç°**ï¼š
```java
public class CursorPaginationDao {
    
    // åˆ†é¡µç»“æœå°è£…ç±»
    public static class CursorPageResult<T> {
        private List<T> data;           // å½“å‰é¡µæ•°æ®
        private String nextCursor;      // ä¸‹ä¸€é¡µæ¸¸æ ‡
        private boolean hasNext;        // æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€é¡µ
        
        public CursorPageResult(List<T> data, String nextCursor, boolean hasNext) {
            this.data = data;
            this.nextCursor = nextCursor;
            this.hasNext = hasNext;
        }
        
        // getteræ–¹æ³•...
    }
    
    // è·å–ç¬¬ä¸€é¡µæ•°æ®
    public CursorPageResult<Product> getFirstPage(int pageSize) {
        String sql = "SELECT * FROM products ORDER BY id ASC LIMIT ?";
        
        try (PreparedStatement stmt = connection.prepareStatement(sql)) {
            stmt.setInt(1, pageSize + 1); // å¤šæŸ¥1æ¡åˆ¤æ–­æ˜¯å¦æœ‰ä¸‹ä¸€é¡µ
            
            ResultSet rs = stmt.executeQuery();
            List<Product> products = new ArrayList<>();
            
            while (rs.next()) {
                products.add(convertToProduct(rs));
            }
            
            // åˆ¤æ–­æ˜¯å¦æœ‰ä¸‹ä¸€é¡µ
            boolean hasNext = products.size() > pageSize;
            if (hasNext) {
                products.remove(products.size() - 1); // ç§»é™¤å¤šæŸ¥çš„é‚£ä¸€æ¡
            }
            
            // ç”Ÿæˆä¸‹ä¸€é¡µæ¸¸æ ‡
            String nextCursor = products.isEmpty() ? null : 
                              String.valueOf(products.get(products.size() - 1).getId());
            
            return new CursorPageResult<>(products, nextCursor, hasNext);
        }
    }
    
    // æ ¹æ®æ¸¸æ ‡è·å–ä¸‹ä¸€é¡µæ•°æ®
    public CursorPageResult<Product> getNextPage(String cursor, int pageSize) {
        String sql = "SELECT * FROM products WHERE id > ? ORDER BY id ASC LIMIT ?";
        
        try (PreparedStatement stmt = connection.prepareStatement(sql)) {
            stmt.setLong(1, Long.parseLong(cursor));
            stmt.setInt(2, pageSize + 1);
            
            ResultSet rs = stmt.executeQuery();
            List<Product> products = new ArrayList<>();
            
            while (rs.next()) {
                products.add(convertToProduct(rs));
            }
            
            boolean hasNext = products.size() > pageSize;
            if (hasNext) {
                products.remove(products.size() - 1);
            }
            
            String nextCursor = products.isEmpty() ? null : 
                              String.valueOf(products.get(products.size() - 1).getId());
            
            return new CursorPageResult<>(products, nextCursor, hasNext);
        }
    }
}
```

### 5.3 å¤åˆæ¡ä»¶çš„æ¸¸æ ‡åˆ†é¡µ


**å¤šå­—æ®µæ’åºçš„æ¸¸æ ‡å¤„ç†**ï¼š

```java
public class ComplexCursorPagination {
    
    // å¤åˆæ¸¸æ ‡ä¿¡æ¯
    public static class Cursor {
        private Timestamp createdAt;    // åˆ›å»ºæ—¶é—´
        private Long id;                // ä¸»é”®IDï¼ˆç”¨äºæ’åºç¨³å®šæ€§ï¼‰
        
        public Cursor(Timestamp createdAt, Long id) {
            this.createdAt = createdAt;
            this.id = id;
        }
        
        // åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²ï¼ˆç”¨äºä¼ è¾“ï¼‰
        public String toString() {
            return createdAt.getTime() + "," + id;
        }
        
        // ä»å­—ç¬¦ä¸²ååºåˆ—åŒ–
        public static Cursor fromString(String cursorStr) {
            String[] parts = cursorStr.split(",");
            return new Cursor(
                new Timestamp(Long.parseLong(parts[0])), 
                Long.parseLong(parts[1])
            );
        }
    }
    
    // æŒ‰åˆ›å»ºæ—¶é—´é™åºåˆ†é¡µ
    public CursorPageResult<Product> getProductsByTime(String cursorStr, int pageSize) {
        String sql;
        PreparedStatement stmt;
        
        if (cursorStr == null) {
            // ç¬¬ä¸€é¡µ
            sql = "SELECT * FROM products ORDER BY created_at DESC, id DESC LIMIT ?";
            stmt = connection.prepareStatement(sql);
            stmt.setInt(1, pageSize + 1);
        } else {
            // åç»­é¡µ
            Cursor cursor = Cursor.fromString(cursorStr);
            sql = """
                SELECT * FROM products 
                WHERE (created_at < ?) OR (created_at = ? AND id < ?)
                ORDER BY created_at DESC, id DESC 
                LIMIT ?
                """;
            
            stmt = connection.prepareStatement(sql);
            stmt.setTimestamp(1, cursor.createdAt);
            stmt.setTimestamp(2, cursor.createdAt);
            stmt.setLong(3, cursor.id);
            stmt.setInt(4, pageSize + 1);
        }
        
        // æ‰§è¡ŒæŸ¥è¯¢å’Œç»“æœå¤„ç†ï¼ˆä¸å‰é¢ç±»ä¼¼ï¼‰...
    }
}
```

### 5.4 æ¸¸æ ‡åˆ†é¡µçš„æœ€ä½³å®è·µ


**é€‚ç”¨åœºæ™¯åˆ¤æ–­**ï¼š

```
âœ… é€‚åˆæ¸¸æ ‡åˆ†é¡µçš„åœºæ™¯ï¼š
- æ—¶é—´çº¿å±•ç¤ºï¼ˆæœ‹å‹åœˆã€å¾®åšï¼‰
- æ¶ˆæ¯åˆ—è¡¨ï¼ˆèŠå¤©è®°å½•ï¼‰
- å®æ—¶æ•°æ®æµï¼ˆæ—¥å¿—æŸ¥çœ‹ï¼‰
- æ— é™æ»šåŠ¨åŠ è½½
- æ‰‹æœºAppçš„åˆ—è¡¨å±•ç¤º

âŒ ä¸é€‚åˆæ¸¸æ ‡åˆ†é¡µçš„åœºæ™¯ï¼š
- éœ€è¦è·³è½¬åˆ°ä»»æ„é¡µçš„åœºæ™¯
- éœ€è¦æ˜¾ç¤ºé¡µç å¯¼èˆªçš„åœºæ™¯
- éœ€è¦åå‘ç¿»é¡µçš„åœºæ™¯
- æ•°æ®ç»å¸¸å˜åŒ–çš„åœºæ™¯
```

**å®ç°æ³¨æ„äº‹é¡¹**ï¼š

> **ğŸ”¸ ç´¢å¼•è¦æ±‚**ï¼šæ¸¸æ ‡å­—æ®µå¿…é¡»æœ‰ç´¢å¼•ï¼Œå¦åˆ™æ€§èƒ½ä¼˜åŠ¿æ¶ˆå¤±
> 
> **ğŸ”¸ æ’åºç¨³å®š**ï¼šä½¿ç”¨ä¸»é”®ä½œä¸ºç¬¬äºŒæ’åºå­—æ®µï¼Œç¡®ä¿ç»“æœç¨³å®š
> 
> **ğŸ”¸ æ¸¸æ ‡åŠ å¯†**ï¼šç”Ÿäº§ç¯å¢ƒå»ºè®®å¯¹æ¸¸æ ‡è¿›è¡Œç¼–ç ï¼Œé¿å…æš´éœ²å†…éƒ¨ä¿¡æ¯
> 
> **ğŸ”¸ è¾¹ç•Œå¤„ç†**ï¼šæ³¨æ„å¤„ç†ç¬¬ä¸€é¡µå’Œæœ€åä¸€é¡µçš„ç‰¹æ®Šæƒ…å†µ

---

## 6. ğŸ† åˆ†é¡µæœ€ä½³å®è·µæŒ‡å—


### 6.1 åœºæ™¯é€‰æ‹©ç­–ç•¥


**ä¸åŒåœºæ™¯çš„åˆ†é¡µæ–¹æ¡ˆé€‰æ‹©**ï¼š

```
ä¸šåŠ¡åœºæ™¯åˆ†æçŸ©é˜µï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ä½¿ç”¨åœºæ™¯     â”‚   æ•°æ®é‡     â”‚   ç”¨æˆ·è¡Œä¸º   â”‚   æ¨èæ–¹æ¡ˆ   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æœç´¢ç»“æœå±•ç¤º    â”‚ ä¸­ç­‰(ä¸‡çº§)   â”‚ æµè§ˆå‰å‡ é¡µ   â”‚ OFFSETåˆ†é¡µ   â”‚
â”‚ å•†å“åˆ—è¡¨æµè§ˆ    â”‚ å¤§é‡(åä¸‡çº§) â”‚ é¡ºåºæµè§ˆ     â”‚ æ¸¸æ ‡åˆ†é¡µ     â”‚
â”‚ åå°æ•°æ®ç®¡ç†    â”‚ ä¸­ç­‰         â”‚ éšæ„è·³è½¬     â”‚ OFFSETåˆ†é¡µ   â”‚
â”‚ ç§»åŠ¨ç«¯åˆ—è¡¨      â”‚ ä»»æ„         â”‚ å‘ä¸‹æ»‘åŠ¨     â”‚ æ¸¸æ ‡åˆ†é¡µ     â”‚
â”‚ æ•°æ®å¯¼å‡ºé¢„è§ˆ    â”‚ å¤§é‡         â”‚ é¡ºåºæŸ¥çœ‹     â”‚ æ¸¸æ ‡åˆ†é¡µ     â”‚
â”‚ å†å²è®°å½•æŸ¥çœ‹    â”‚ å¤§é‡         â”‚ æŒ‰æ—¶é—´æµè§ˆ   â”‚ æ¸¸æ ‡åˆ†é¡µ     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 æ€§èƒ½ä¼˜åŒ–æŠ€å·§


**æ•°æ®åº“å±‚é¢ä¼˜åŒ–**ï¼š

```sql
-- 1. ç¡®ä¿æ’åºå­—æ®µæœ‰ç´¢å¼•
CREATE INDEX idx_products_created_at ON products(created_at, id);

-- 2. åªæŸ¥è¯¢å¿…è¦å­—æ®µï¼ˆé¿å…SELECT *ï¼‰
SELECT id, name, price FROM products 
WHERE id > ? ORDER BY id LIMIT ?;

-- 3. ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼ˆæ‰€æœ‰éœ€è¦å­—æ®µéƒ½åœ¨ç´¢å¼•ä¸­ï¼‰
CREATE INDEX idx_products_cover ON products(id, name, price, created_at);
```

**åº”ç”¨å±‚é¢ä¼˜åŒ–**ï¼š

```java
public class PaginationOptimizer {
    
    // 1. ç¼“å­˜æ€»è®°å½•æ•°ï¼ˆé¿å…æ¯æ¬¡COUNTæŸ¥è¯¢ï¼‰
    @Cacheable(value = "productCount", key = "#searchCondition")
    public long getProductCount(String searchCondition) {
        // COUNTæŸ¥è¯¢é€šå¸¸æ¯”è¾ƒæ…¢ï¼Œç»“æœå¯ä»¥ç¼“å­˜ä¸€æ®µæ—¶é—´
        String sql = "SELECT COUNT(*) FROM products WHERE name LIKE ?";
        // æ‰§è¡ŒæŸ¥è¯¢...
    }
    
    // 2. åˆ†é¡µå‚æ•°æ ¡éªŒ
    public PaginationParams validateParams(int pageNum, int pageSize) {
        // é™åˆ¶æ¯é¡µæœ€å¤§æ•°é‡ï¼Œé˜²æ­¢æ¶æ„è¯·æ±‚
        int maxPageSize = 100;
        pageSize = Math.min(pageSize, maxPageSize);
        
        // é¡µç æœ€å°ä¸º1
        pageNum = Math.max(pageNum, 1);
        
        // å¯ä»¥è®¾ç½®æœ€å¤§é¡µç é™åˆ¶
        int maxPageNum = 1000;
        pageNum = Math.min(pageNum, maxPageNum);
        
        return new PaginationParams(pageNum, pageSize);
    }
    
    // 3. æ·±åº¦åˆ†é¡µæ£€æµ‹å’Œå¤„ç†
    public boolean isDeepPagination(int pageNum, int pageSize) {
        int offset = (pageNum - 1) * pageSize;
        int deepPaginationThreshold = 10000; // åç§»é‡è¶…è¿‡1ä¸‡è®¤ä¸ºæ˜¯æ·±åº¦åˆ†é¡µ
        
        return offset > deepPaginationThreshold;
    }
}
```

### 6.3 ç”¨æˆ·ä½“éªŒä¼˜åŒ–


**å‰ç«¯å±•ç¤ºä¼˜åŒ–**ï¼š

```java
public class PaginationUI {
    
    // åˆ†é¡µå¯¼èˆªæ ç”Ÿæˆ
    public List<Integer> generatePageNumbers(int currentPage, int totalPages) {
        List<Integer> pageNumbers = new ArrayList<>();
        int maxDisplayPages = 10; // æœ€å¤šæ˜¾ç¤º10ä¸ªé¡µç 
        
        if (totalPages <= maxDisplayPages) {
            // æ€»é¡µæ•°ä¸å¤šï¼Œæ˜¾ç¤ºæ‰€æœ‰é¡µç 
            for (int i = 1; i <= totalPages; i++) {
                pageNumbers.add(i);
            }
        } else {
            // æ€»é¡µæ•°å¾ˆå¤šï¼Œæ™ºèƒ½æ˜¾ç¤ºé¡µç 
            int start = Math.max(1, currentPage - 4);
            int end = Math.min(totalPages, currentPage + 5);
            
            // ç¡®ä¿æ˜¾ç¤ºè¶³å¤Ÿçš„é¡µç 
            if (end - start < 9) {
                if (start == 1) {
                    end = Math.min(totalPages, start + 9);
                } else {
                    start = Math.max(1, end - 9);
                }
            }
            
            for (int i = start; i <= end; i++) {
                pageNumbers.add(i);
            }
        }
        
        return pageNumbers;
    }
    
    // ç”Ÿæˆåˆ†é¡µä¿¡æ¯æ‘˜è¦
    public String generatePaginationSummary(int pageNum, int pageSize, long totalCount) {
        int start = (pageNum - 1) * pageSize + 1;
        int end = Math.min(pageNum * pageSize, (int) totalCount);
        
        return String.format("æ˜¾ç¤ºç¬¬ %d-%d æ¡è®°å½•ï¼Œå…± %d æ¡", start, end, totalCount);
    }
}
```

### 6.4 é”™è¯¯å¤„ç†å’Œè¾¹ç•Œæƒ…å†µ


**å¥å£®æ€§å¤„ç†**ï¼š

```java
public class RobustPagination {
    
    public PageResult<Product> safeGetProducts(Integer pageNum, Integer pageSize) {
        try {
            // å‚æ•°é»˜è®¤å€¼å¤„ç†
            if (pageNum == null || pageNum < 1) pageNum = 1;
            if (pageSize == null || pageSize < 1) pageSize = 20;
            
            // é˜²æ­¢è¿‡å¤§çš„pageSizeå½±å“æ€§èƒ½
            pageSize = Math.min(pageSize, 100);
            
            // è·å–æ€»è®°å½•æ•°
            long totalCount = getProductCount();
            if (totalCount == 0) {
                // æ²¡æœ‰æ•°æ®æ—¶è¿”å›ç©ºç»“æœ
                return new PageResult<>(pageNum, pageSize, 0, new ArrayList<>());
            }
            
            // è®¡ç®—æ€»é¡µæ•°
            int totalPages = (int) Math.ceil((double) totalCount / pageSize);
            
            // é¡µç è¶…å‡ºèŒƒå›´æ—¶ï¼Œé‡å®šå‘åˆ°æœ€åä¸€é¡µ
            if (pageNum > totalPages) {
                pageNum = totalPages;
            }
            
            // æ‰§è¡ŒæŸ¥è¯¢
            List<Product> products = queryProducts(pageNum, pageSize);
            
            return new PageResult<>(pageNum, pageSize, totalCount, products);
            
        } catch (SQLException e) {
            // æ•°æ®åº“å¼‚å¸¸å¤„ç†
            logger.error("åˆ†é¡µæŸ¥è¯¢å¼‚å¸¸", e);
            throw new ServiceException("æŸ¥è¯¢å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•");
        }
    }
    
    // åˆ†é¡µå‚æ•°å®‰å…¨æ ¡éªŒ
    private void validatePaginationParams(int pageNum, int pageSize) throws ValidationException {
        if (pageNum < 1) {
            throw new ValidationException("é¡µç å¿…é¡»å¤§äº0");
        }
        if (pageSize < 1 || pageSize > 100) {
            throw new ValidationException("æ¯é¡µè®°å½•æ•°å¿…é¡»åœ¨1-100ä¹‹é—´");
        }
    }
}
```

### 6.5 ç›‘æ§å’Œæ€§èƒ½è°ƒä¼˜


**åˆ†é¡µæ€§èƒ½ç›‘æ§**ï¼š

```java
@Component
public class PaginationMonitor {
    
    private final MeterRegistry meterRegistry;
    
    public PageResult<T> monitoredQuery(String queryType, Supplier<PageResult<T>> querySupplier) {
        Timer.Sample sample = Timer.start(meterRegistry);
        
        try {
            PageResult<T> result = querySupplier.get();
            
            // è®°å½•æŸ¥è¯¢æˆåŠŸæŒ‡æ ‡
            meterRegistry.counter("pagination.query.success", "type", queryType).increment();
            
            // è®°å½•æ·±åº¦åˆ†é¡µæƒ…å†µ
            if (result.getPageNum() > 100) {
                meterRegistry.counter("pagination.deep.page", "type", queryType).increment();
            }
            
            return result;
            
        } catch (Exception e) {
            // è®°å½•æŸ¥è¯¢å¤±è´¥æŒ‡æ ‡
            meterRegistry.counter("pagination.query.error", "type", queryType).increment();
            throw e;
        } finally {
            sample.stop(Timer.builder("pagination.query.duration")
                    .tag("type", queryType)
                    .register(meterRegistry));
        }
    }
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ åˆ†é¡µæœ¬è´¨ï¼šåƒç¿»ä¹¦ä¸€æ ·åˆ†æ‰¹æ˜¾ç¤ºæ•°æ®ï¼Œæå‡ç”¨æˆ·ä½“éªŒå’Œç³»ç»Ÿæ€§èƒ½
ğŸ”¸ æ ¸å¿ƒå‚æ•°ï¼špageNum(é¡µç )ã€pageSize(æ¯é¡µå¤§å°)ã€totalCount(æ€»è®°å½•æ•°)  
ğŸ”¸ LIMIT/OFFSETï¼šMySQLåˆ†é¡µçš„åŸºç¡€è¯­æ³•ï¼ŒLIMITé™åˆ¶æ•°é‡ï¼ŒOFFSETè·³è¿‡è®°å½•
ğŸ”¸ è®¡ç®—å…¬å¼ï¼šOFFSET = (pageNum - 1) Ã— pageSize
ğŸ”¸ æ€§èƒ½é—®é¢˜ï¼šOFFSETè¶Šå¤§æŸ¥è¯¢è¶Šæ…¢ï¼Œæ·±åº¦åˆ†é¡µéœ€è¦ç‰¹æ®Šå¤„ç†
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸¤ç§åˆ†é¡µæ–¹å¼çš„é€‰æ‹©**
```
OFFSETåˆ†é¡µï¼š
é€‚ç”¨åœºæ™¯ï¼šæ•°æ®é‡ä¸­ç­‰ã€éœ€è¦è·³è½¬ä»»æ„é¡µã€ä¼ ç»Ÿç½‘ç«™
ä¼˜ç‚¹ï¼šå®ç°ç®€å•ã€æ”¯æŒéšæœºè·³è½¬  
ç¼ºç‚¹ï¼šæ·±åº¦åˆ†é¡µæ€§èƒ½å·®

æ¸¸æ ‡åˆ†é¡µï¼š
é€‚ç”¨åœºæ™¯ï¼šæ•°æ®é‡å¤§ã€é¡ºåºæµè§ˆã€ç§»åŠ¨ç«¯åº”ç”¨
ä¼˜ç‚¹ï¼šæ€§èƒ½ç¨³å®šã€ä¸å—æ•°æ®é‡å½±å“
ç¼ºç‚¹ï¼šä¸æ”¯æŒè·³è½¬ä»»æ„é¡µ
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–çš„æ ¸å¿ƒæ€è·¯**
```
æ•°æ®åº“ä¼˜åŒ–ï¼š
- ä¸ºæ’åºå­—æ®µå»ºç«‹ç´¢å¼•
- é¿å…SELECT *ï¼ŒåªæŸ¥è¯¢å¿…è¦å­—æ®µ
- ä½¿ç”¨è¦†ç›–ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢

åº”ç”¨ä¼˜åŒ–ï¼š
- ç¼“å­˜æ€»è®°å½•æ•°ï¼Œå‡å°‘COUNTæŸ¥è¯¢
- é™åˆ¶pageSizeæœ€å¤§å€¼ï¼Œé˜²æ­¢æ¶æ„è¯·æ±‚
- æ·±åº¦åˆ†é¡µæ£€æµ‹å’Œé™çº§å¤„ç†
```

**ğŸ”¹ å®é™…åº”ç”¨çš„æœ€ä½³å®è·µ**
```
åœºæ™¯åŒ¹é…åŸåˆ™ï¼š
- æœç´¢ç»“æœé¡µ â†’ OFFSETåˆ†é¡µï¼ˆç”¨æˆ·ä¸»è¦çœ‹å‰å‡ é¡µï¼‰
- æ¶ˆæ¯åˆ—è¡¨é¡µ â†’ æ¸¸æ ‡åˆ†é¡µï¼ˆæŒ‰æ—¶é—´é¡ºåºæŸ¥çœ‹ï¼‰
- ç®¡ç†åå°é¡µ â†’ OFFSETåˆ†é¡µï¼ˆéœ€è¦è·³è½¬åŠŸèƒ½ï¼‰
- æ‰‹æœºAppåˆ—è¡¨ â†’ æ¸¸æ ‡åˆ†é¡µï¼ˆæ— é™æ»šåŠ¨åŠ è½½ï¼‰
```

### 7.3 æ–°æ‰‹å­¦ä¹ è·¯å¾„å»ºè®®


**ğŸ¯ å­¦ä¹ é¡ºåºå»ºè®®**
1. **å…ˆæŒæ¡åŸºç¡€**ï¼šç†è§£åˆ†é¡µæ¦‚å¿µå’ŒLIMIT/OFFSETè¯­æ³•
2. **ç»ƒä¹ è®¡ç®—**ï¼šç†Ÿç»ƒæŒæ¡åç§»é‡è®¡ç®—å…¬å¼  
3. **ä»£ç å®ç°**ï¼šç”¨JDBCå®ç°åŸºæœ¬çš„åˆ†é¡µæŸ¥è¯¢
4. **æ€§èƒ½è®¤çŸ¥**ï¼šäº†è§£æ·±åº¦åˆ†é¡µçš„æ€§èƒ½é—®é¢˜
5. **æ–¹æ¡ˆå¯¹æ¯”**ï¼šå­¦ä¹ æ¸¸æ ‡åˆ†é¡µçš„å®ç°åŸç†
6. **å®é™…åº”ç”¨**ï¼šæ ¹æ®ä¸åŒåœºæ™¯é€‰æ‹©åˆé€‚çš„åˆ†é¡µæ–¹æ¡ˆ

**ğŸ”§ åŠ¨æ‰‹ç»ƒä¹ å»ºè®®**
```
ç»ƒä¹ 1ï¼šå®ç°åŸºç¡€åˆ†é¡µ
- å»ºç«‹æµ‹è¯•è¡¨ï¼Œæ’å…¥1000æ¡æ•°æ®
- å®ç°pageNumå’ŒpageSizeå‚æ•°çš„åˆ†é¡µæŸ¥è¯¢
- è®¡ç®—å¹¶æ˜¾ç¤ºæ€»é¡µæ•°

ç»ƒä¹ 2ï¼šæ€§èƒ½å¯¹æ¯”æµ‹è¯•  
- æµ‹è¯•ç¬¬1é¡µvsç¬¬100é¡µçš„æŸ¥è¯¢æ—¶é—´
- è§‚å¯ŸOFFSETå¯¹æ€§èƒ½çš„å½±å“

ç»ƒä¹ 3ï¼šæ¸¸æ ‡åˆ†é¡µå®ç°
- æ”¹å†™ä¸ºæ¸¸æ ‡åˆ†é¡µæ–¹å¼
- å¯¹æ¯”ä¸¤ç§æ–¹å¼çš„æ€§èƒ½å·®å¼‚
```

### 7.4 å®é™…å¼€å‘æ³¨æ„äº‹é¡¹


**ğŸ› ï¸ ä»£ç è´¨é‡è¦æ±‚**
- **å‚æ•°æ ¡éªŒ**ï¼šå¯¹pageNumå’ŒpageSizeè¿›è¡Œè¾¹ç•Œæ£€æŸ¥
- **å¼‚å¸¸å¤„ç†**ï¼šå¦¥å–„å¤„ç†æ•°æ®åº“å¼‚å¸¸å’Œè¾¹ç•Œæƒ…å†µ
- **æ€§èƒ½ç›‘æ§**ï¼šè®°å½•åˆ†é¡µæŸ¥è¯¢çš„æ‰§è¡Œæ—¶é—´å’Œæ·±åº¦åˆ†é¡µæƒ…å†µ
- **ç”¨æˆ·ä½“éªŒ**ï¼šæä¾›å‹å¥½çš„åˆ†é¡µå¯¼èˆªå’Œç»“æœæ‘˜è¦

**ğŸ“Š ç”Ÿäº§ç¯å¢ƒè€ƒè™‘**
- **å®‰å…¨é˜²æŠ¤**ï¼šé™åˆ¶æœ€å¤§pageSizeï¼Œé˜²æ­¢æ¶æ„å¤§é‡æŸ¥è¯¢
- **ç¼“å­˜ç­–ç•¥**ï¼šåˆç†ç¼“å­˜æ€»è®°å½•æ•°ï¼Œå‡å°‘COUNTæŸ¥è¯¢é¢‘ç‡
- **é™çº§æ–¹æ¡ˆ**ï¼šæ·±åº¦åˆ†é¡µæ—¶æä¾›æœç´¢å»ºè®®æˆ–ç­›é€‰æ¡ä»¶
- **ç›‘æ§å‘Šè­¦**ï¼šç›‘æ§æ…¢æŸ¥è¯¢ï¼ŒåŠæ—¶å‘ç°æ€§èƒ½é—®é¢˜

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
åˆ†é¡µæŸ¥è¯¢è¦è®°ç‰¢ï¼ŒLIMIT OFFSETæ˜¯åŸºç¡€
åç§»å…¬å¼å¾ˆç®€å•ï¼Œé¡µç å‡ä¸€ä¹˜å¤§å°
æ·±åº¦åˆ†é¡µæ€§èƒ½å·®ï¼Œæ¸¸æ ‡æ–¹æ¡ˆæ¥è§£å†³
åœºæ™¯ä¸åŒé€‰æ–¹æ¡ˆï¼Œç”¨æˆ·ä½“éªŒæœ€é‡è¦
```