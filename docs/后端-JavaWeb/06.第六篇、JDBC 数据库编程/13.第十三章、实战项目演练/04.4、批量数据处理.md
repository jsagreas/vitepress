---
title: 4ã€æ‰¹é‡æ•°æ®å¤„ç†
---
## ğŸ“š ç›®å½•

1. [æ‰¹é‡æ•°æ®å¤„ç†æ¦‚è¿°](#1-æ‰¹é‡æ•°æ®å¤„ç†æ¦‚è¿°)
2. [æ‰¹é‡å¯¼å…¥ä¼˜åŒ–æŠ€æœ¯](#2-æ‰¹é‡å¯¼å…¥ä¼˜åŒ–æŠ€æœ¯)
3. [å¤§æ–‡ä»¶åˆ†æ‰¹å¤„ç†ç­–ç•¥](#3-å¤§æ–‡ä»¶åˆ†æ‰¹å¤„ç†ç­–ç•¥)
4. [å†…å­˜æ§åˆ¶ä¸æ€§èƒ½ä¼˜åŒ–](#4-å†…å­˜æ§åˆ¶ä¸æ€§èƒ½ä¼˜åŒ–)
5. [è¿›åº¦ç›‘æ§ä¸å¼‚å¸¸æ¢å¤](#5-è¿›åº¦ç›‘æ§ä¸å¼‚å¸¸æ¢å¤)
6. [å®æˆ˜é¡¹ç›®æ¼”ç»ƒ](#6-å®æˆ˜é¡¹ç›®æ¼”ç»ƒ)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ’¡ æ‰¹é‡æ•°æ®å¤„ç†æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯æ‰¹é‡æ•°æ®å¤„ç†


**ğŸ”¸ é€šä¿—ç†è§£**
æƒ³è±¡ä¸€ä¸‹ï¼Œä½ éœ€è¦æŠŠ1ä¸‡å¼ åç‰‡çš„ä¿¡æ¯å½•å…¥åˆ°ç”µè„‘é‡Œã€‚å¦‚æœä¸€å¼ ä¸€å¼ åœ°å½•å…¥ï¼Œä¸ä»…ç´¯äººï¼Œæ•ˆç‡ä¹Ÿå¾ˆä½ã€‚æ‰¹é‡æ•°æ®å¤„ç†å°±åƒæ˜¯æ‰¾åˆ°äº†ä¸€ç§å¿«é€Ÿå½•å…¥çš„æ–¹æ³•ï¼Œå¯ä»¥ä¸€æ¬¡æ€§å¤„ç†å¾ˆå¤šæ•°æ®ï¼Œå¤§å¤§æé«˜å·¥ä½œæ•ˆç‡ã€‚

**ğŸ”¸ æŠ€æœ¯å®šä¹‰**
æ‰¹é‡æ•°æ®å¤„ç†æ˜¯æŒ‡ä¸€æ¬¡æ€§å¤„ç†å¤§é‡æ•°æ®è®°å½•çš„æŠ€æœ¯ï¼Œè€Œä¸æ˜¯ä¸€æ¡ä¸€æ¡åœ°å•ç‹¬å¤„ç†ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯æŠŠå¤šä¸ªæ“ä½œæ‰“åŒ…åœ¨ä¸€èµ·æ‰§è¡Œï¼Œå‡å°‘æ•°æ®åº“äº¤äº’æ¬¡æ•°ï¼Œæé«˜å¤„ç†æ•ˆç‡ã€‚

```
ä¼ ç»Ÿå•æ¡å¤„ç† vs æ‰¹é‡å¤„ç†å¯¹æ¯”ï¼š

å•æ¡å¤„ç†ï¼š                æ‰¹é‡å¤„ç†ï¼š
ç”¨æˆ· â†’ æ•°æ®åº“             ç”¨æˆ· â†’ æ•°æ®åº“
 â†“      â†‘                 â†“      â†‘ 
å¤„ç†1æ¡æ•°æ®               å¤„ç†1000æ¡æ•°æ®
 â†“      â†‘                 â†“      â†‘
ç”¨æˆ· â†’ æ•°æ®åº“             ç”¨æˆ· â†’ æ•°æ®åº“
...é‡å¤1000æ¬¡...          å®Œæˆï¼

è€—æ—¶ï¼š1000æ¬¡ç½‘ç»œå¾€è¿”        è€—æ—¶ï¼š1æ¬¡ç½‘ç»œå¾€è¿”
```

### 1.2 ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ‰¹é‡å¤„ç†


**ğŸš€ æ€§èƒ½ä¼˜åŠ¿å¯¹æ¯”**

| **å¤„ç†æ–¹å¼** | **ç½‘ç»œå¼€é”€** | **å¤„ç†æ—¶é—´** | **èµ„æºæ¶ˆè€—** | **é€‚ç”¨åœºæ™¯** |
|-------------|-------------|-------------|-------------|-------------|
| **å•æ¡å¤„ç†** | `é«˜ï¼ˆé¢‘ç¹è¿æ¥ï¼‰` | `æ…¢ï¼ˆä¸²è¡Œæ‰§è¡Œï¼‰` | `ä½ï¼ˆå†…å­˜å ç”¨å°ï¼‰` | `å°‘é‡æ•°æ®` |
| **æ‰¹é‡å¤„ç†** | `ä½ï¼ˆä¸€æ¬¡è¿æ¥ï¼‰` | `å¿«ï¼ˆæ‰¹é‡æ‰§è¡Œï¼‰` | `ä¸­ï¼ˆç¼“å­˜æ•°æ®ï¼‰` | `å¤§é‡æ•°æ®` |

**ğŸ“Š å®é™…æ•ˆæœå¯¹æ¯”**
```
å¤„ç†10000æ¡ç”¨æˆ·æ•°æ®ï¼š
- å•æ¡å¤„ç†ï¼šçº¦30åˆ†é’Ÿ
- æ‰¹é‡å¤„ç†ï¼šçº¦2åˆ†é’Ÿ
- æ€§èƒ½æå‡ï¼š15å€ï¼
```

### 1.3 æ‰¹é‡å¤„ç†çš„åº”ç”¨åœºæ™¯


**ğŸ¯ å¸¸è§ä¸šåŠ¡åœºæ™¯**

```
å®é™…åº”ç”¨ä¸¾ä¾‹ï¼š

ğŸ“ˆ ç”µå•†ç³»ç»Ÿï¼š
â€¢ å¯¼å…¥å•†å“ä¿¡æ¯ï¼ˆä»·æ ¼ã€åº“å­˜æ›´æ–°ï¼‰
â€¢ å¤„ç†è®¢å•æ•°æ®ï¼ˆæ‰¹é‡å‘è´§ï¼‰
â€¢ ç”¨æˆ·æ•°æ®åŒæ­¥ï¼ˆä¼šå‘˜ä¿¡æ¯æ›´æ–°ï¼‰

ğŸ¢ ä¼ä¸šç®¡ç†ï¼š
â€¢ å‘˜å·¥ä¿¡æ¯æ‰¹é‡å¯¼å…¥
â€¢ å·¥èµ„æ•°æ®æ‰¹é‡è®¡ç®—
â€¢ è€ƒå‹¤è®°å½•æ‰¹é‡å¤„ç†

ğŸ“š æ•™è‚²ç³»ç»Ÿï¼š
â€¢ å­¦ç”Ÿæˆç»©æ‰¹é‡å½•å…¥
â€¢ è¯¾ç¨‹ä¿¡æ¯æ‰¹é‡æ›´æ–°
â€¢ æ¯•ä¸šè¯ä¹¦æ‰¹é‡ç”Ÿæˆ
```

---

## 2. âš¡ æ‰¹é‡å¯¼å…¥ä¼˜åŒ–æŠ€æœ¯


### 2.1 JDBCæ‰¹é‡æ“ä½œåŸºç¡€


**ğŸ”§ Statementæ‰¹é‡æ“ä½œ**

Statementçš„æ‰¹é‡æ“ä½œå°±åƒå‡†å¤‡ä¸€ä¸ªè´­ç‰©æ¸…å•ï¼ŒæŠŠè¦ä¹°çš„ä¸œè¥¿éƒ½å†™ä¸‹æ¥ï¼Œç„¶åä¸€æ¬¡æ€§å»è¶…å¸‚è´­ä¹°ï¼Œè€Œä¸æ˜¯æƒ³åˆ°ä»€ä¹ˆå°±è·‘ä¸€æ¬¡è¶…å¸‚ã€‚

```java
// åŸºç¡€æ‰¹é‡æ’å…¥ç¤ºä¾‹
public void batchInsertUsers(List<User> users) {
    String sql = "INSERT INTO users (name, email, age) VALUES (?, ?, ?)";
    
    try (Connection conn = getConnection();
         PreparedStatement ps = conn.prepareStatement(sql)) {
        
        // å…³é—­è‡ªåŠ¨æäº¤ï¼Œæ‰‹åŠ¨æ§åˆ¶äº‹åŠ¡
        conn.setAutoCommit(false);
        
        for (User user : users) {
            ps.setString(1, user.getName());
            ps.setString(2, user.getEmail());
            ps.setInt(3, user.getAge());
            ps.addBatch(); // æ·»åŠ åˆ°æ‰¹é‡æ“ä½œä¸­
        }
        
        // æ‰§è¡Œæ‰¹é‡æ“ä½œ
        int[] results = ps.executeBatch();
        conn.commit(); // æäº¤äº‹åŠ¡
        
        System.out.println("æˆåŠŸæ’å…¥ " + results.length + " æ¡è®°å½•");
        
    } catch (SQLException e) {
        System.out.println("æ‰¹é‡æ’å…¥å¤±è´¥ï¼š" + e.getMessage());
    }
}
```

**ğŸ’¡ æ ¸å¿ƒç†è§£è¦ç‚¹**
- `addBatch()`ï¼šæŠŠSQLè¯­å¥æ·»åŠ åˆ°"å¾…å¤„ç†æ¸…å•"ä¸­
- `executeBatch()`ï¼šä¸€æ¬¡æ€§æ‰§è¡Œæ¸…å•ä¸­çš„æ‰€æœ‰SQLè¯­å¥
- `setAutoCommit(false)`ï¼šé˜²æ­¢å•æ¡å¤±è´¥å½±å“æ•´ä¸ªæ‰¹é‡æ“ä½œ

### 2.2 æ‰¹é‡æ“ä½œçš„ä¸‰ç§æ¨¡å¼


**ğŸ“‹ æ‰¹é‡æ“ä½œæ¨¡å¼å¯¹æ¯”**

```
æ‰¹é‡æ“ä½œçš„ä¸‰ç§å¢ƒç•Œï¼š

ğŸ¥‰ é’é“œçº§ - Statementæ‰¹é‡ï¼š
String sql1 = "INSERT INTO users VALUES (1, 'Alice', 25)";
String sql2 = "INSERT INTO users VALUES (2, 'Bob', 30)";
stmt.addBatch(sql1);
stmt.addBatch(sql2);
stmt.executeBatch();

ğŸ¥ˆ ç™½é“¶çº§ - PreparedStatementæ‰¹é‡ï¼š
String sql = "INSERT INTO users VALUES (?, ?, ?)";
ps.setInt(1, 1); ps.setString(2, "Alice"); ps.setInt(3, 25);
ps.addBatch();
ps.setInt(1, 2); ps.setString(2, "Bob"); ps.setInt(3, 30);
ps.addBatch();
ps.executeBatch();

ğŸ¥‡ é»„é‡‘çº§ - å¯é‡ç”¨æ‰¹å¤„ç†å™¨ï¼š
BatchProcessor<User> processor = new BatchProcessor<>();
processor.addBatch(users);
processor.execute();
```

### 2.3 æ‰¹é‡å¤„ç†æ€§èƒ½ä¼˜åŒ–æŠ€å·§


**ğŸ”¥ å…³é”®ä¼˜åŒ–ç­–ç•¥**

> **ä¼˜åŒ–æŠ€å·§1ï¼šåˆç†è®¾ç½®æ‰¹é‡å¤§å°**
> 
> å°±åƒæ¬å®¶æ—¶é€‰æ‹©åˆé€‚å¤§å°çš„ç®±å­ï¼Œå¤ªå°éœ€è¦æ¬å¾ˆå¤šæ¬¡ï¼Œå¤ªå¤§åˆæ¬ä¸åŠ¨ã€‚æ‰¹é‡å¤„ç†ä¹Ÿéœ€è¦æ‰¾åˆ°æœ€é€‚åˆçš„æ•°é‡ã€‚

```java
public class BatchSizeOptimizer {
    // æ¨èçš„æ‰¹é‡å¤§å°é…ç½®
    private static final int SMALL_BATCH = 100;    // å°æ‰¹é‡ï¼šå†…å­˜ç´§å¼ æ—¶
    private static final int MEDIUM_BATCH = 1000;  // ä¸­æ‰¹é‡ï¼šå¸¸è§„æƒ…å†µ
    private static final int LARGE_BATCH = 5000;   // å¤§æ‰¹é‡ï¼šå†…å­˜å……è¶³æ—¶
    
    public void smartBatchInsert(List<User> users) {
        int batchSize = calculateOptimalBatchSize(users.size());
        
        for (int i = 0; i < users.size(); i += batchSize) {
            int end = Math.min(i + batchSize, users.size());
            List<User> batch = users.subList(i, end);
            processBatch(batch);
            
            // æ˜¾ç¤ºè¿›åº¦
            System.out.printf("å·²å¤„ç†: %d/%d (%.1f%%)\n", 
                end, users.size(), (double)end/users.size()*100);
        }
    }
    
    private int calculateOptimalBatchSize(int totalSize) {
        if (totalSize < 1000) return SMALL_BATCH;
        if (totalSize < 10000) return MEDIUM_BATCH;
        return LARGE_BATCH;
    }
}
```

**âš¡ æ€§èƒ½ä¼˜åŒ–è¦ç‚¹æ€»ç»“**

| **ä¼˜åŒ–æ–¹å‘** | **å…·ä½“åšæ³•** | **æ€§èƒ½æå‡** | **æ³¨æ„äº‹é¡¹** |
|-------------|-------------|-------------|-------------|
| **æ‰¹é‡å¤§å°** | `1000-5000æ¡ä¸ºä½³` | `10-50å€` | `é¿å…å†…å­˜æº¢å‡º` |
| **äº‹åŠ¡æ§åˆ¶** | `æ‰‹åŠ¨æäº¤äº‹åŠ¡` | `3-5å€` | `å¼‚å¸¸æ—¶å›æ»š` |
| **è¿æ¥å¤ç”¨** | `ä½¿ç”¨è¿æ¥æ± ` | `2-3å€` | `åŠæ—¶é‡Šæ”¾è¿æ¥` |
| **SQLä¼˜åŒ–** | `ä½¿ç”¨PreparedStatement` | `20-30%` | `é˜²æ­¢SQLæ³¨å…¥` |

---

## 3. ğŸ“ å¤§æ–‡ä»¶åˆ†æ‰¹å¤„ç†ç­–ç•¥


### 3.1 å¤§æ–‡ä»¶å¤„ç†çš„æŒ‘æˆ˜


**ğŸ¤” ä¸ºä»€ä¹ˆå¤§æ–‡ä»¶å¤„ç†å›°éš¾**

æƒ³è±¡ä½ è¦åƒä¸€ä¸ªå·¨å¤§çš„è›‹ç³•ï¼Œå¦‚æœä¸€å£åä¸‹å»è‚¯å®šä¼šå™åˆ°ã€‚èªæ˜çš„åšæ³•æ˜¯åˆ‡æˆå°å—ï¼Œä¸€å—ä¸€å—åœ°åƒã€‚å¤§æ–‡ä»¶å¤„ç†ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ã€‚

```
å¤§æ–‡ä»¶å¤„ç†é¢ä¸´çš„é—®é¢˜ï¼š

é—®é¢˜1ï¼šå†…å­˜ä¸è¶³
10GBçš„CSVæ–‡ä»¶ â†’ ä¸€æ¬¡æ€§åŠ è½½ â†’ å†…å­˜çˆ†ç‚¸ ğŸ’¥

é—®é¢˜2ï¼šå¤„ç†æ—¶é—´é•¿
100ä¸‡æ¡æ•°æ® â†’ å•çº¿ç¨‹å¤„ç† â†’ ç”¨æˆ·ç­‰å¾…ç„¦è™‘ ğŸ˜°

é—®é¢˜3ï¼šå¼‚å¸¸ä¸­æ–­
å¤„ç†åˆ°ç¬¬50ä¸‡æ¡æ—¶å‡ºé”™ â†’ ä»å¤´å¼€å§‹ â†’ å‰åŠŸå°½å¼ƒ ğŸ˜­

è§£å†³æ–¹æ¡ˆï¼šåˆ†æ‰¹å¤„ç†
10GBæ–‡ä»¶ â†’ åˆ†æˆ100ä¸ª100MBå°å— â†’ é€å—å¤„ç† â†’ ç¨³å®šå¯æ§ ğŸ˜Š
```

### 3.2 æ–‡ä»¶åˆ†æ‰¹è¯»å–æŠ€æœ¯


**ğŸ“– æµå¼è¯»å– vs å…¨é‡è¯»å–**

```java
// âŒ é”™è¯¯åšæ³•ï¼šå…¨é‡è¯»å–ï¼ˆå†…å­˜æ€æ‰‹ï¼‰
public void badFileProcessing(String filename) {
    try {
        List<String> allLines = Files.readAllLines(Paths.get(filename));
        // å¦‚æœæ–‡ä»¶æœ‰100ä¸‡è¡Œï¼Œè¿™é‡Œå°±ä¼šåˆ›å»º100ä¸‡ä¸ªStringå¯¹è±¡
        for (String line : allLines) {
            processLine(line);
        }
    } catch (IOException e) {
        e.printStackTrace();
    }
}

// âœ… æ­£ç¡®åšæ³•ï¼šæµå¼è¯»å–ï¼ˆå†…å­˜å‹å¥½ï¼‰
public void goodFileProcessing(String filename) {
    try (BufferedReader reader = Files.newBufferedReader(Paths.get(filename))) {
        String line;
        int count = 0;
        List<String> batch = new ArrayList<>();
        
        while ((line = reader.readLine()) != null) {
            batch.add(line);
            count++;
            
            // æ¯1000è¡Œå¤„ç†ä¸€æ¬¡
            if (count % 1000 == 0) {
                processBatch(batch);
                batch.clear(); // æ¸…ç©ºæ‰¹é‡ï¼Œé‡Šæ”¾å†…å­˜
                System.out.println("å·²å¤„ç† " + count + " è¡Œæ•°æ®");
            }
        }
        
        // å¤„ç†å‰©ä½™æ•°æ®
        if (!batch.isEmpty()) {
            processBatch(batch);
        }
        
    } catch (IOException e) {
        System.out.println("æ–‡ä»¶å¤„ç†å¤±è´¥ï¼š" + e.getMessage());
    }
}
```

### 3.3 CSVæ–‡ä»¶æ‰¹é‡å¯¼å…¥å®æˆ˜


**ğŸ“Š CSVæ–‡ä»¶å¯¼å…¥å®Œæ•´æ–¹æ¡ˆ**

CSVæ–‡ä»¶å¯¼å…¥å°±åƒæŠŠExcelè¡¨æ ¼çš„æ•°æ®æ¬åˆ°æ•°æ®åº“é‡Œï¼Œéœ€è¦ä¸€è¡Œä¸€è¡Œåœ°è¯»å–ï¼Œç„¶åè½¬æ¢æˆæ•°æ®åº“èƒ½ç†è§£çš„æ ¼å¼ã€‚

```java
public class CSVBatchImporter {
    private static final int BATCH_SIZE = 1000;
    
    public void importUserCSV(String csvFile) {
        try (BufferedReader reader = Files.newBufferedReader(Paths.get(csvFile));
             Connection conn = getConnection()) {
            
            conn.setAutoCommit(false);
            String sql = "INSERT INTO users (name, email, age) VALUES (?, ?, ?)";
            
            try (PreparedStatement ps = conn.prepareStatement(sql)) {
                String line = reader.readLine(); // è·³è¿‡æ ‡é¢˜è¡Œ
                line = reader.readLine(); // å¼€å§‹è¯»å–æ•°æ®
                
                int batchCount = 0;
                int totalCount = 0;
                
                while (line != null) {
                    String[] fields = line.split(",");
                    
                    // æ•°æ®éªŒè¯
                    if (fields.length >= 3) {
                        ps.setString(1, fields[0].trim());
                        ps.setString(2, fields[1].trim());
                        ps.setInt(3, Integer.parseInt(fields[2].trim()));
                        ps.addBatch();
                        
                        batchCount++;
                        totalCount++;
                        
                        // è¾¾åˆ°æ‰¹é‡å¤§å°æ—¶æ‰§è¡Œ
                        if (batchCount >= BATCH_SIZE) {
                            ps.executeBatch();
                            conn.commit();
                            ps.clearBatch();
                            
                            System.out.println("å·²å¯¼å…¥ " + totalCount + " æ¡è®°å½•");
                            batchCount = 0;
                        }
                    }
                    
                    line = reader.readLine();
                }
                
                // å¤„ç†å‰©ä½™æ•°æ®
                if (batchCount > 0) {
                    ps.executeBatch();
                    conn.commit();
                }
                
                System.out.println("å¯¼å…¥å®Œæˆï¼Œæ€»è®¡ " + totalCount + " æ¡è®°å½•");
                
            }
        } catch (Exception e) {
            System.out.println("CSVå¯¼å…¥å¤±è´¥ï¼š" + e.getMessage());
        }
    }
}
```

**ğŸ¯ CSVå¤„ç†å…³é”®ç‚¹**

> **æ•°æ®éªŒè¯å¾ˆé‡è¦**
> - æ£€æŸ¥å¿…å¡«å­—æ®µæ˜¯å¦ä¸ºç©º
> - éªŒè¯æ•°æ®æ ¼å¼æ˜¯å¦æ­£ç¡®
> - å¤„ç†ç‰¹æ®Šå­—ç¬¦å’Œç¼–ç é—®é¢˜
> 
> **é”™è¯¯å¤„ç†è¦å‹å¥½**
> - è®°å½•å‡ºé”™çš„è¡Œå·å’ŒåŸå› 
> - è·³è¿‡é”™è¯¯æ•°æ®ç»§ç»­å¤„ç†
> - ç”Ÿæˆé”™è¯¯æŠ¥å‘Šä¾›åç»­ä¿®æ­£

---

## 4. ğŸ§  å†…å­˜æ§åˆ¶ä¸æ€§èƒ½ä¼˜åŒ–


### 4.1 å†…å­˜ç®¡ç†åŸºç¡€æ¦‚å¿µ


**ğŸ” Javaå†…å­˜åŒºåŸŸè§£æ**

Javaç¨‹åºçš„å†…å­˜å°±åƒä¸€ä¸ªå¤§ä»“åº“ï¼Œåˆ†æˆä¸åŒçš„åŒºåŸŸå­˜æ”¾ä¸åŒçš„ä¸œè¥¿ã€‚ç†è§£è¿™äº›åŒºåŸŸæœ‰åŠ©äºæˆ‘ä»¬ä¼˜åŒ–æ‰¹é‡å¤„ç†çš„æ€§èƒ½ã€‚

```
Javaå†…å­˜ç»“æ„ç®€åŒ–å›¾ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  JVMå†…å­˜ç©ºé—´                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     å †å†…å­˜       â”‚     æ ˆå†…å­˜       â”‚   æ–¹æ³•åŒº    â”‚
â”‚   (å­˜å¯¹è±¡)      â”‚   (å­˜æ–¹æ³•è°ƒç”¨)   â”‚  (å­˜ç±»ä¿¡æ¯)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ ç”¨æˆ·å¯¹è±¡      â”‚ â€¢ å±€éƒ¨å˜é‡      â”‚ â€¢ ç±»å®šä¹‰    â”‚
â”‚ â€¢ æ•°ç»„         â”‚ â€¢ æ–¹æ³•å‚æ•°      â”‚ â€¢ å¸¸é‡æ±     â”‚
â”‚ â€¢ å­—ç¬¦ä¸²       â”‚ â€¢ æ–¹æ³•è°ƒç”¨æ ˆ    â”‚ â€¢ é™æ€å˜é‡  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ’¡ æ‰¹é‡å¤„ç†ä¸­çš„å†…å­˜ä½¿ç”¨**

```java
public class MemoryAwareProcessor {
    
    public void memoryFriendlyBatchProcess(String filename) {
        // è·å–å½“å‰å¯ç”¨å†…å­˜
        Runtime runtime = Runtime.getRuntime();
        long maxMemory = runtime.maxMemory();
        long totalMemory = runtime.totalMemory();
        long freeMemory = runtime.freeMemory();
        long availableMemory = maxMemory - (totalMemory - freeMemory);
        
        System.out.println("å¯ç”¨å†…å­˜: " + (availableMemory / 1024 / 1024) + "MB");
        
        // æ ¹æ®å¯ç”¨å†…å­˜åŠ¨æ€è°ƒæ•´æ‰¹é‡å¤§å°
        int batchSize = calculateBatchSize(availableMemory);
        
        List<String> batch = new ArrayList<>(batchSize);
        
        try (BufferedReader reader = Files.newBufferedReader(Paths.get(filename))) {
            String line;
            while ((line = reader.readLine()) != null) {
                batch.add(line);
                
                if (batch.size() >= batchSize) {
                    processBatch(batch);
                    batch.clear(); // ç«‹å³æ¸…ç©ºï¼Œé‡Šæ”¾å†…å­˜
                    
                    // å»ºè®®JVMè¿›è¡Œåƒåœ¾å›æ”¶
                    if (isMemoryLow()) {
                        System.gc();
                        Thread.sleep(100); // ç»™GCä¸€ç‚¹æ—¶é—´
                    }
                }
            }
        } catch (Exception e) {
            System.out.println("å¤„ç†å¤±è´¥ï¼š" + e.getMessage());
        }
    }
    
    private boolean isMemoryLow() {
        Runtime runtime = Runtime.getRuntime();
        long freeMemory = runtime.freeMemory();
        long totalMemory = runtime.totalMemory();
        return (freeMemory * 100.0 / totalMemory) < 20; // å¯ç”¨å†…å­˜å°‘äº20%
    }
}
```

### 4.2 å†…å­˜ä¼˜åŒ–ç­–ç•¥


**ğŸš€ äº”å¤§å†…å­˜ä¼˜åŒ–æŠ€å·§**

| **ä¼˜åŒ–ç­–ç•¥** | **å…·ä½“æ–¹æ³•** | **æ•ˆæœ** | **é€‚ç”¨åœºæ™¯** |
|-------------|-------------|---------|-------------|
| **åŠæ—¶é‡Šæ”¾** | `å¤„ç†å®Œå°±æ¸…ç©ºé›†åˆ` | `é¿å…å†…å­˜ç´¯ç§¯` | `æ‰€æœ‰æ‰¹é‡å¤„ç†` |
| **å¯¹è±¡å¤ç”¨** | `é‡ç”¨StringBuilderç­‰å¯¹è±¡` | `å‡å°‘GCå‹åŠ›` | `å­—ç¬¦ä¸²æ“ä½œå¤š` |
| **æ‡’åŠ è½½** | `éœ€è¦æ—¶æ‰åˆ›å»ºå¯¹è±¡` | `é™ä½å³°å€¼å†…å­˜` | `å¤§å¯¹è±¡å¤„ç†` |
| **æµå¼å¤„ç†** | `é€è¡Œè¯»å–ä¸å…¨é‡åŠ è½½` | `æ’å®šå†…å­˜ä½¿ç”¨` | `å¤§æ–‡ä»¶å¤„ç†` |
| **åˆ†æ‰¹å¤„ç†** | `æ•°æ®åˆ†å°æ‰¹æ¬¡å¤„ç†` | `å†…å­˜å¯æ§` | `æµ·é‡æ•°æ®` |

**âš¡ å†…å­˜ç›‘æ§å®ç”¨å·¥å…·**

```java
public class MemoryMonitor {
    
    public static void printMemoryUsage(String stage) {
        Runtime runtime = Runtime.getRuntime();
        long totalMemory = runtime.totalMemory();
        long freeMemory = runtime.freeMemory();
        long usedMemory = totalMemory - freeMemory;
        
        System.out.printf("[%s] å†…å­˜ä½¿ç”¨: %dMB / %dMB (%.1f%%)\n",
            stage,
            usedMemory / 1024 / 1024,
            totalMemory / 1024 / 1024,
            (double)usedMemory / totalMemory * 100
        );
    }
    
    // ä½¿ç”¨ç¤ºä¾‹
    public void monitoredBatchProcess() {
        printMemoryUsage("å¼€å§‹å¤„ç†");
        
        // æ‰§è¡Œæ‰¹é‡å¤„ç†
        processBatch();
        
        printMemoryUsage("å¤„ç†å®Œæˆ");
        
        // æ¸…ç†èµ„æº
        cleanup();
        
        printMemoryUsage("èµ„æºæ¸…ç†å");
    }
}
```

### 4.3 æ•°æ®åº“è¿æ¥ä¼˜åŒ–


**ğŸ”Œ è¿æ¥æ± ä½¿ç”¨æœ€ä½³å®è·µ**

æ•°æ®åº“è¿æ¥å°±åƒæ°´ç®¡ï¼Œæ¯æ¬¡éƒ½é‡æ–°æ¥æ°´ç®¡å¾ˆéº»çƒ¦ï¼Œæœ€å¥½æ˜¯å‡†å¤‡ä¸€ä¸ªæ°´ç®¡æ± ï¼Œéœ€è¦æ—¶å°±å€Ÿç”¨ï¼Œç”¨å®Œå°±è¿˜å›å»ã€‚

```java
public class ConnectionPoolExample {
    // ä½¿ç”¨HikariCPè¿æ¥æ± ï¼ˆé«˜æ€§èƒ½è¿æ¥æ± ï¼‰
    private HikariDataSource dataSource;
    
    public void initConnectionPool() {
        HikariConfig config = new HikariConfig();
        config.setJdbcUrl("jdbc:mysql://localhost:3306/testdb");
        config.setUsername("username");
        config.setPassword("password");
        
        // è¿æ¥æ± é…ç½®
        config.setMaximumPoolSize(20);      // æœ€å¤§è¿æ¥æ•°
        config.setMinimumIdle(5);           // æœ€å°ç©ºé—²è¿æ¥æ•°
        config.setConnectionTimeout(30000); // è¿æ¥è¶…æ—¶æ—¶é—´
        config.setIdleTimeout(600000);      // ç©ºé—²è¿æ¥è¶…æ—¶æ—¶é—´
        config.setMaxLifetime(1800000);     // è¿æ¥æœ€å¤§å­˜æ´»æ—¶é—´
        
        dataSource = new HikariDataSource(config);
    }
    
    public void efficientBatchProcess(List<User> users) {
        // ä»è¿æ¥æ± è·å–è¿æ¥
        try (Connection conn = dataSource.getConnection()) {
            conn.setAutoCommit(false);
            
            String sql = "INSERT INTO users (name, email) VALUES (?, ?)";
            try (PreparedStatement ps = conn.prepareStatement(sql)) {
                
                for (int i = 0; i < users.size(); i++) {
                    User user = users.get(i);
                    ps.setString(1, user.getName());
                    ps.setString(2, user.getEmail());
                    ps.addBatch();
                    
                    // æ¯1000æ¡æäº¤ä¸€æ¬¡
                    if ((i + 1) % 1000 == 0) {
                        ps.executeBatch();
                        conn.commit();
                        ps.clearBatch();
                    }
                }
                
                // å¤„ç†å‰©ä½™æ•°æ®
                ps.executeBatch();
                conn.commit();
                
            }
        } catch (SQLException e) {
            System.out.println("æ‰¹é‡å¤„ç†å¤±è´¥ï¼š" + e.getMessage());
        }
        // è¿æ¥è‡ªåŠ¨å½’è¿˜ç»™è¿æ¥æ± 
    }
}
```

---

## 5. ğŸ“Š è¿›åº¦ç›‘æ§ä¸å¼‚å¸¸æ¢å¤


### 5.1 è¿›åº¦ç›‘æ§ç³»ç»Ÿè®¾è®¡


**ğŸ“ˆ è¿›åº¦ç›‘æ§çš„é‡è¦æ€§**

æƒ³è±¡ä½ åœ¨ä¸‹è½½ä¸€ä¸ªå¤§æ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰è¿›åº¦æ¡ï¼Œä½ ä¸çŸ¥é“è¿˜è¦ç­‰å¤šä¹…ï¼Œä¼šå¾ˆç„¦è™‘ã€‚æ‰¹é‡æ•°æ®å¤„ç†ä¹Ÿæ˜¯ä¸€æ ·ï¼Œç”¨æˆ·éœ€è¦çŸ¥é“å¤„ç†è¿›å±•å¦‚ä½•ã€‚

```java
public class ProgressMonitor {
    private long totalRecords;
    private long processedRecords;
    private long startTime;
    private long lastReportTime;
    
    public ProgressMonitor(long totalRecords) {
        this.totalRecords = totalRecords;
        this.processedRecords = 0;
        this.startTime = System.currentTimeMillis();
        this.lastReportTime = startTime;
    }
    
    public void updateProgress(int batchSize) {
        processedRecords += batchSize;
        long currentTime = System.currentTimeMillis();
        
        // æ¯5ç§’æŠ¥å‘Šä¸€æ¬¡è¿›åº¦
        if (currentTime - lastReportTime >= 5000) {
            reportProgress();
            lastReportTime = currentTime;
        }
    }
    
    private void reportProgress() {
        double percentage = (double) processedRecords / totalRecords * 100;
        long elapsed = System.currentTimeMillis() - startTime;
        long estimated = processedRecords > 0 ? 
            elapsed * totalRecords / processedRecords : 0;
        long remaining = estimated - elapsed;
        
        System.out.printf("è¿›åº¦: %d/%d (%.1f%%) | å·²ç”¨æ—¶: %s | é¢„è®¡å‰©ä½™: %s\n",
            processedRecords, totalRecords, percentage,
            formatTime(elapsed), formatTime(remaining));
        
        // ç»˜åˆ¶ç®€å•çš„è¿›åº¦æ¡
        drawProgressBar(percentage);
    }
    
    private void drawProgressBar(double percentage) {
        int barLength = 50;
        int filled = (int) (barLength * percentage / 100);
        
        StringBuilder bar = new StringBuilder("[");
        for (int i = 0; i < barLength; i++) {
            if (i < filled) {
                bar.append("â–ˆ");
            } else {
                bar.append("â–‘");
            }
        }
        bar.append(String.format("] %.1f%%", percentage));
        
        System.out.println(bar.toString());
    }
    
    private String formatTime(long milliseconds) {
        long seconds = milliseconds / 1000;
        long minutes = seconds / 60;
        long hours = minutes / 60;
        
        if (hours > 0) {
            return String.format("%dæ—¶%dåˆ†%dç§’", hours, minutes % 60, seconds % 60);
        } else if (minutes > 0) {
            return String.format("%dåˆ†%dç§’", minutes, seconds % 60);
        } else {
            return String.format("%dç§’", seconds);
        }
    }
}
```

### 5.2 å¼‚å¸¸å¤„ç†ä¸æ¢å¤æœºåˆ¶


**ğŸ›¡ï¸ å¼‚å¸¸æ¢å¤ç­–ç•¥**

æ‰¹é‡å¤„ç†è¿‡ç¨‹ä¸­å¯èƒ½é‡åˆ°å„ç§é—®é¢˜ï¼Œå°±åƒå¼€è½¦æ—¶é‡åˆ°çº¢ç»¿ç¯ï¼Œéœ€è¦æœ‰åº”å¯¹æ–¹æ¡ˆã€‚

```java
public class RobustBatchProcessor {
    private static final String CHECKPOINT_FILE = "batch_checkpoint.txt";
    
    public void resilientBatchProcess(String inputFile) {
        // 1. æ£€æŸ¥æ˜¯å¦æœ‰ä¹‹å‰çš„æ£€æŸ¥ç‚¹
        long startPosition = loadCheckpoint();
        
        try (BufferedReader reader = Files.newBufferedReader(Paths.get(inputFile));
             Connection conn = getConnection()) {
            
            // è·³åˆ°ä¸Šæ¬¡å¤„ç†çš„ä½ç½®
            for (long i = 0; i < startPosition; i++) {
                reader.readLine();
            }
            
            conn.setAutoCommit(false);
            String sql = "INSERT INTO users (name, email) VALUES (?, ?)";
            
            try (PreparedStatement ps = conn.prepareStatement(sql)) {
                String line;
                long currentPosition = startPosition;
                int batchCount = 0;
                
                while ((line = reader.readLine()) != null) {
                    currentPosition++;
                    
                    try {
                        // è§£ææ•°æ®
                        String[] fields = line.split(",");
                        ps.setString(1, fields[0]);
                        ps.setString(2, fields[1]);
                        ps.addBatch();
                        
                        batchCount++;
                        
                        // æ‰¹é‡æ‰§è¡Œ
                        if (batchCount >= 1000) {
                            ps.executeBatch();
                            conn.commit();
                            ps.clearBatch();
                            
                            // ä¿å­˜æ£€æŸ¥ç‚¹
                            saveCheckpoint(currentPosition);
                            
                            batchCount = 0;
                        }
                        
                    } catch (Exception e) {
                        // è®°å½•é”™è¯¯è¡Œä½†ç»§ç»­å¤„ç†
                        logError(currentPosition, line, e.getMessage());
                        conn.rollback(); // å›æ»šå½“å‰æ‰¹æ¬¡
                        ps.clearBatch();
                        batchCount = 0;
                    }
                }
                
                // å¤„ç†å‰©ä½™æ•°æ®
                if (batchCount > 0) {
                    ps.executeBatch();
                    conn.commit();
                }
                
                // å¤„ç†å®Œæˆï¼Œåˆ é™¤æ£€æŸ¥ç‚¹
                deleteCheckpoint();
                
            }
        } catch (Exception e) {
            System.out.println("æ‰¹é‡å¤„ç†å¼‚å¸¸ï¼š" + e.getMessage());
        }
    }
    
    private long loadCheckpoint() {
        try {
            if (Files.exists(Paths.get(CHECKPOINT_FILE))) {
                String content = Files.readString(Paths.get(CHECKPOINT_FILE));
                return Long.parseLong(content.trim());
            }
        } catch (IOException e) {
            System.out.println("è¯»å–æ£€æŸ¥ç‚¹å¤±è´¥ï¼š" + e.getMessage());
        }
        return 0;
    }
    
    private void saveCheckpoint(long position) {
        try {
            Files.writeString(Paths.get(CHECKPOINT_FILE), String.valueOf(position));
        } catch (IOException e) {
            System.out.println("ä¿å­˜æ£€æŸ¥ç‚¹å¤±è´¥ï¼š" + e.getMessage());
        }
    }
    
    private void logError(long position, String data, String error) {
        String logEntry = String.format("è¡Œå·: %d, æ•°æ®: %s, é”™è¯¯: %s\n", 
            position, data, error);
        try {
            Files.writeString(Paths.get("error_log.txt"), logEntry, 
                StandardOpenOption.CREATE, StandardOpenOption.APPEND);
        } catch (IOException e) {
            System.out.println("å†™å…¥é”™è¯¯æ—¥å¿—å¤±è´¥ï¼š" + e.getMessage());
        }
    }
}
```

### 5.3 å¤šçº¿ç¨‹å¹¶å‘å¤„ç†


**âš¡ å¹¶å‘å¤„ç†æå‡æ€§èƒ½**

æƒ³è±¡ä½ è¦æ´—å¾ˆå¤šç›˜å­ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªäººæ´—ä¼šå¾ˆæ…¢ï¼Œå¦‚æœå‡ ä¸ªäººä¸€èµ·æ´—å°±å¿«å¤šäº†ã€‚å¤šçº¿ç¨‹å¤„ç†ä¹Ÿæ˜¯è¿™ä¸ªé“ç†ã€‚

```java
public class ConcurrentBatchProcessor {
    private ExecutorService executor;
    private final int THREAD_COUNT = 4;
    
    public void concurrentProcess(List<User> allUsers) {
        executor = Executors.newFixedThreadPool(THREAD_COUNT);
        
        // å°†æ•°æ®åˆ†æˆå¤šä¸ªéƒ¨åˆ†
        int totalSize = allUsers.size();
        int chunkSize = totalSize / THREAD_COUNT;
        
        List<Future<Integer>> futures = new ArrayList<>();
        
        for (int i = 0; i < THREAD_COUNT; i++) {
            int start = i * chunkSize;
            int end = (i == THREAD_COUNT - 1) ? totalSize : (i + 1) * chunkSize;
            List<User> chunk = allUsers.subList(start, end);
            
            // æäº¤ä»»åŠ¡åˆ°çº¿ç¨‹æ± 
            Future<Integer> future = executor.submit(() -> {
                return processChunk(chunk, i + 1);
            });
            futures.add(future);
        }
        
        // ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ
        int totalProcessed = 0;
        for (int i = 0; i < futures.size(); i++) {
            try {
                int processed = futures.get(i).get();
                totalProcessed += processed;
                System.out.println("çº¿ç¨‹ " + (i + 1) + " å¤„ç†å®Œæˆï¼Œå¤„ç†æ•°é‡ï¼š" + processed);
            } catch (Exception e) {
                System.out.println("çº¿ç¨‹ " + (i + 1) + " å¤„ç†å¤±è´¥ï¼š" + e.getMessage());
            }
        }
        
        System.out.println("æ€»è®¡å¤„ç†ï¼š" + totalProcessed + " æ¡è®°å½•");
        
        executor.shutdown();
    }
    
    private int processChunk(List<User> users, int threadId) {
        try (Connection conn = getConnection()) {
            conn.setAutoCommit(false);
            String sql = "INSERT INTO users (name, email) VALUES (?, ?)";
            
            try (PreparedStatement ps = conn.prepareStatement(sql)) {
                for (int i = 0; i < users.size(); i++) {
                    User user = users.get(i);
                    ps.setString(1, user.getName());
                    ps.setString(2, user.getEmail());
                    ps.addBatch();
                    
                    if ((i + 1) % 500 == 0) {
                        ps.executeBatch();
                        conn.commit();
                        ps.clearBatch();
                        
                        System.out.printf("çº¿ç¨‹%d: å·²å¤„ç† %d/%d\n", 
                            threadId, i + 1, users.size());
                    }
                }
                
                ps.executeBatch();
                conn.commit();
                
                return users.size();
                
            }
        } catch (Exception e) {
            System.out.println("çº¿ç¨‹" + threadId + "å¤„ç†å¼‚å¸¸ï¼š" + e.getMessage());
            return 0;
        }
    }
}
```

---

## 6. ğŸ› ï¸ å®æˆ˜é¡¹ç›®æ¼”ç»ƒ


### 6.1 å®Œæ•´çš„ç”¨æˆ·æ•°æ®å¯¼å…¥ç³»ç»Ÿ


è®©æˆ‘ä»¬æŠŠå‰é¢å­¦åˆ°çš„çŸ¥è¯†æ•´åˆèµ·æ¥ï¼Œåšä¸€ä¸ªå®Œæ•´çš„ç”¨æˆ·æ•°æ®å¯¼å…¥ç³»ç»Ÿã€‚è¿™ä¸ªç³»ç»Ÿå¯ä»¥å¤„ç†å¤§æ–‡ä»¶ã€ç›‘æ§è¿›åº¦ã€å¤„ç†å¼‚å¸¸ï¼Œå°±åƒä¸€ä¸ªçœŸæ­£çš„ä¼ä¸šçº§åº”ç”¨ã€‚

```java
public class UserImportSystem {
    private ProgressMonitor progressMonitor;
    private ErrorLogger errorLogger;
    private DataSource dataSource;
    
    public void importUsersFromCSV(String csvFile) {
        System.out.println("å¼€å§‹å¯¼å…¥ç”¨æˆ·æ•°æ®...");
        
        // 1. å…ˆç»Ÿè®¡æ€»è¡Œæ•°
        long totalLines = countLines(csvFile);
        progressMonitor = new ProgressMonitor(totalLines);
        errorLogger = new ErrorLogger("user_import_errors.log");
        
        // 2. å¼€å§‹å¯¼å…¥
        int successCount = 0;
        int errorCount = 0;
        
        try (BufferedReader reader = Files.newBufferedReader(Paths.get(csvFile));
             Connection conn = dataSource.getConnection()) {
            
            conn.setAutoCommit(false);
            String sql = "INSERT INTO users (name, email, phone, department) VALUES (?, ?, ?, ?)";
            
            try (PreparedStatement ps = conn.prepareStatement(sql)) {
                
                String line = reader.readLine(); // è·³è¿‡æ ‡é¢˜è¡Œ
                List<User> batch = new ArrayList<>();
                
                while ((line = reader.readLine()) != null) {
                    try {
                        User user = parseUserFromCSV(line);
                        if (validateUser(user)) {
                            batch.add(user);
                            
                            // è¾¾åˆ°æ‰¹é‡å¤§å°æ—¶å¤„ç†
                            if (batch.size() >= 1000) {
                                int processed = processBatch(ps, batch);
                                conn.commit();
                                successCount += processed;
                                
                                progressMonitor.updateProgress(processed);
                                batch.clear();
                            }
                        } else {
                            errorCount++;
                            errorLogger.logError("æ•°æ®éªŒè¯å¤±è´¥", line);
                        }
                    } catch (Exception e) {
                        errorCount++;
                        errorLogger.logError("è§£æå¤±è´¥: " + e.getMessage(), line);
                    }
                }
                
                // å¤„ç†å‰©ä½™æ•°æ®
                if (!batch.isEmpty()) {
                    int processed = processBatch(ps, batch);
                    conn.commit();
                    successCount += processed;
                }
                
            }
            
        } catch (Exception e) {
            System.out.println("å¯¼å…¥è¿‡ç¨‹å¼‚å¸¸ï¼š" + e.getMessage());
        }
        
        // 3. è¾“å‡ºæœ€ç»ˆç»“æœ
        System.out.println("\n=== å¯¼å…¥å®Œæˆ ===");
        System.out.println("æˆåŠŸå¯¼å…¥ï¼š" + successCount + " æ¡è®°å½•");
        System.out.println("å¤±è´¥è®°å½•ï¼š" + errorCount + " æ¡");
        System.out.println("æˆåŠŸç‡ï¼š" + String.format("%.1f%%", 
            (double)successCount / (successCount + errorCount) * 100));
        
        if (errorCount > 0) {
            System.out.println("é”™è¯¯è¯¦æƒ…è¯·æŸ¥çœ‹ï¼šuser_import_errors.log");
        }
    }
    
    private User parseUserFromCSV(String line) {
        String[] fields = line.split(",");
        User user = new User();
        user.setName(fields[0].trim());
        user.setEmail(fields[1].trim());
        user.setPhone(fields[2].trim());
        user.setDepartment(fields[3].trim());
        return user;
    }
    
    private boolean validateUser(User user) {
        // å§“åä¸èƒ½ä¸ºç©º
        if (user.getName() == null || user.getName().trim().isEmpty()) {
            return false;
        }
        
        // é‚®ç®±æ ¼å¼éªŒè¯
        if (!user.getEmail().contains("@")) {
            return false;
        }
        
        // æ‰‹æœºå·é•¿åº¦éªŒè¯
        if (user.getPhone().length() != 11) {
            return false;
        }
        
        return true;
    }
    
    private int processBatch(PreparedStatement ps, List<User> users) throws SQLException {
        for (User user : users) {
            ps.setString(1, user.getName());
            ps.setString(2, user.getEmail());
            ps.setString(3, user.getPhone());
            ps.setString(4, user.getDepartment());
            ps.addBatch();
        }
        
        int[] results = ps.executeBatch();
        ps.clearBatch();
        
        return results.length;
    }
}
```

### 6.2 æ€§èƒ½æµ‹è¯•ä¸ä¼˜åŒ–


**ğŸ“Š æ€§èƒ½å¯¹æ¯”æµ‹è¯•**

```java
public class PerformanceTest {
    
    public void comparePerformance() {
        List<User> testData = generateTestData(10000);
        
        System.out.println("=== æ€§èƒ½æµ‹è¯•å¼€å§‹ ===");
        
        // æµ‹è¯•1ï¼šå•æ¡æ’å…¥
        long startTime = System.currentTimeMillis();
        singleInsert(testData);
        long singleTime = System.currentTimeMillis() - startTime;
        
        // æµ‹è¯•2ï¼šæ‰¹é‡æ’å…¥
        startTime = System.currentTimeMillis();
        batchInsert(testData);
        long batchTime = System.currentTimeMillis() - startTime;
        
        // æµ‹è¯•3ï¼šä¼˜åŒ–æ‰¹é‡æ’å…¥
        startTime = System.currentTimeMillis();
        optimizedBatchInsert(testData);
        long optimizedTime = System.currentTimeMillis() - startTime;
        
        // è¾“å‡ºç»“æœ
        System.out.println("\n=== æ€§èƒ½æµ‹è¯•ç»“æœ ===");
        System.out.printf("å•æ¡æ’å…¥: %dæ¯«ç§’\n", singleTime);
        System.out.printf("æ‰¹é‡æ’å…¥: %dæ¯«ç§’ (æå‡ %.1fx)\n", 
            batchTime, (double)singleTime / batchTime);
        System.out.printf("ä¼˜åŒ–æ‰¹é‡: %dæ¯«ç§’ (æå‡ %.1fx)\n", 
            optimizedTime, (double)singleTime / optimizedTime);
    }
    
    private List<User> generateTestData(int count) {
        List<User> users = new ArrayList<>();
        for (int i = 0; i < count; i++) {
            User user = new User();
            user.setName("ç”¨æˆ·" + i);
            user.setEmail("user" + i + "@example.com");
            users.add(user);
        }
        return users;
    }
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ¯ æ‰¹é‡å¤„ç†æ ¸å¿ƒç†è§£**
```
æ‰¹é‡å¤„ç† = æ‰“åŒ…å¤„ç† = æ•ˆç‡æå‡
â€¢ æŠŠå¤šä¸ªæ“ä½œæ‰“åŒ…åœ¨ä¸€èµ·æ‰§è¡Œ
â€¢ å‡å°‘æ•°æ®åº“äº¤äº’æ¬¡æ•°
â€¢ å¤§å¹…æå‡å¤„ç†æ•ˆç‡
â€¢ éœ€è¦åˆç†æ§åˆ¶å†…å­˜ä½¿ç”¨
```

**âš¡ å…³é”®æŠ€æœ¯è¦ç‚¹**
- **addBatch()** - æ·»åŠ åˆ°æ‰¹é‡æ“ä½œé˜Ÿåˆ—
- **executeBatch()** - æ‰§è¡Œæ‰€æœ‰æ‰¹é‡æ“ä½œ
- **åˆ†æ‰¹å¤„ç†** - é˜²æ­¢å†…å­˜æº¢å‡º
- **äº‹åŠ¡æ§åˆ¶** - ç¡®ä¿æ•°æ®ä¸€è‡´æ€§
- **å¼‚å¸¸æ¢å¤** - ä¿è¯å¤„ç†çš„å¥å£®æ€§

### 7.2 æ€§èƒ½ä¼˜åŒ–æœ€ä½³å®è·µ


**ğŸš€ æ€§èƒ½ä¼˜åŒ–æ£€æŸ¥æ¸…å•**
- âœ… ä½¿ç”¨PreparedStatementè€ŒéStatement
- âœ… åˆç†è®¾ç½®æ‰¹é‡å¤§å°ï¼ˆ1000-5000æ¡ï¼‰
- âœ… æ‰‹åŠ¨æ§åˆ¶äº‹åŠ¡æäº¤
- âœ… ä½¿ç”¨è¿æ¥æ± ç®¡ç†æ•°æ®åº“è¿æ¥
- âœ… åŠæ—¶é‡Šæ”¾å†…å­˜èµ„æº
- âœ… æ·»åŠ è¿›åº¦ç›‘æ§å’Œå¼‚å¸¸å¤„ç†

### 7.3 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


**â“ æ–°æ‰‹å¸¸è§ç–‘é—®è§£ç­”**

> **Q: æ‰¹é‡å¤§å°è®¾ç½®å¤šå°‘åˆé€‚ï¼Ÿ**
> A: ä¸€èˆ¬1000-5000æ¡æ¯”è¾ƒåˆé€‚ï¼Œå¤ªå°æ•ˆæœä¸æ˜æ˜¾ï¼Œå¤ªå¤§å¯èƒ½å†…å­˜æº¢å‡ºã€‚

> **Q: å¤„ç†è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸æ€ä¹ˆåŠï¼Ÿ**
> A: ä½¿ç”¨æ£€æŸ¥ç‚¹æœºåˆ¶ï¼Œè®°å½•å¤„ç†ä½ç½®ï¼Œå¼‚å¸¸åå¯ä»¥ä»æ–­ç‚¹ç»§ç»­å¤„ç†ã€‚

> **Q: å¦‚ä½•çŸ¥é“å¤„ç†è¿›åº¦ï¼Ÿ**
> A: å®ç°è¿›åº¦ç›‘æ§ï¼Œå®šæœŸè¾“å‡ºå¤„ç†è¿›åº¦å’Œå‰©ä½™æ—¶é—´ä¼°ç®—ã€‚

### 7.4 å®é™…åº”ç”¨ä»·å€¼


**ğŸ’¼ ä¼ä¸šçº§åº”ç”¨åœºæ™¯**
- **æ•°æ®è¿ç§»** - ä»æ—§ç³»ç»Ÿè¿ç§»æ•°æ®åˆ°æ–°ç³»ç»Ÿ
- **æ‰¹é‡å¯¼å…¥** - Excelæ–‡ä»¶æ•°æ®å¯¼å…¥åˆ°æ•°æ®åº“
- **æ•°æ®åŒæ­¥** - å®šæœŸåŒæ­¥å¤–éƒ¨æ•°æ®æº
- **æŠ¥è¡¨ç”Ÿæˆ** - æ‰¹é‡ç”Ÿæˆç”¨æˆ·æŠ¥è¡¨æ•°æ®

**ğŸ¯ å­¦ä¹ è¿›é˜¶å»ºè®®**
1. **ç†Ÿç»ƒæŒæ¡JDBCæ‰¹é‡æ“ä½œAPI**
2. **ç†è§£æ•°æ®åº“äº‹åŠ¡å’Œé”æœºåˆ¶**
3. **å­¦ä¹ å¤šçº¿ç¨‹å¹¶å‘å¤„ç†æŠ€æœ¯**
4. **äº†è§£æ•°æ®åº“æ€§èƒ½è°ƒä¼˜çŸ¥è¯†**
5. **æŒæ¡åˆ†å¸ƒå¼æ‰¹å¤„ç†æ¡†æ¶ï¼ˆå¦‚Spring Batchï¼‰**

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
```
æ‰¹é‡å¤„ç†ä¸‰æ­¥èµ°ï¼š
1. å‡†å¤‡æ•°æ®ï¼ˆaddBatchï¼‰
2. æ‰¹é‡æ‰§è¡Œï¼ˆexecuteBatchï¼‰  
3. æäº¤äº‹åŠ¡ï¼ˆcommitï¼‰

å†…å­˜æ§åˆ¶ä¸¤åŸåˆ™ï¼š
1. åŠæ—¶æ¸…ç©ºé›†åˆé‡Šæ”¾å†…å­˜
2. æ ¹æ®å¯ç”¨å†…å­˜åŠ¨æ€è°ƒæ•´æ‰¹é‡å¤§å°

å¼‚å¸¸å¤„ç†ä¸‰ä¿éšœï¼š
1. æ£€æŸ¥ç‚¹æœºåˆ¶æ”¯æŒæ–­ç‚¹ç»­ä¼ 
2. é”™è¯¯æ—¥å¿—è®°å½•é—®é¢˜è¯¦æƒ…
3. äº‹åŠ¡å›æ»šä¿è¯æ•°æ®ä¸€è‡´æ€§
```

**å®æˆ˜åº”ç”¨å£è¯€**ï¼š
```
æ‰¹é‡å¤„ç†æ•ˆç‡é«˜ï¼Œå†…å­˜æ§åˆ¶å¾ˆé‡è¦
åˆ†æ‰¹è¯»å–é˜²æº¢å‡ºï¼Œå¼‚å¸¸å¤„ç†è¦åšå¥½  
è¿›åº¦ç›‘æ§ç”¨æˆ·çˆ±ï¼Œæ£€æŸ¥ç‚¹æœºåˆ¶ä¸å¯å°‘
è¿æ¥æ± é‡Œå–è¿æ¥ï¼Œäº‹åŠ¡æäº¤åˆ«å¿˜æ‰
```