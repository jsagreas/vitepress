---
title: 1、对象选择与属性绑定
---
## 📚 目录

1. [对象绑定基础概念](#1-对象绑定基础概念)
2. [th:object对象绑定](#2-th-object对象绑定)
3. [对象作用域](#3-对象作用域)
4. [属性访问语法](#4-属性访问语法)
5. [嵌套对象处理](#5-嵌套对象处理)
6. [null值安全处理](#6-null值安全处理)
7. [对象方法调用](#7-对象方法调用)
8. [静态方法调用](#8-静态方法调用)
9. [核心要点总结](#9-核心要点总结)

---

## 1. 🎯 对象绑定基础概念


### 1.1 什么是对象绑定


**通俗理解**：就像给表单贴标签一样，告诉Thymeleaf"接下来我要操作这个对象"

```
现实场景类比：
填写快递单时，你先写上收件人信息（对象绑定）
然后逐一填写：姓名、电话、地址（属性访问）

Thymeleaf中：
先用 th:object 指定操作对象
再用 *{} 访问对象的各个属性
```

**核心作用**：
- 🔸 简化代码：避免重复写对象名
- 🔸 提高可读性：清晰表达数据结构
- 🔸 表单处理：方便处理表单数据绑定

### 1.2 为什么需要对象绑定


**没有对象绑定的写法**：
```html
<p>姓名：<span th:text="${user.name}"></span></p>
<p>年龄：<span th:text="${user.age}"></span></p>
<p>邮箱：<span th:text="${user.email}"></span></p>
```

**使用对象绑定后**：
```html
<div th:object="${user}">
  <p>姓名：<span th:text="*{name}"></span></p>
  <p>年龄：<span th:text="*{age}"></span></p>
  <p>邮箱：<span th:text="*{email}"></span></p>
</div>
```

> 💡 **关键理解**：`th:object` 就像设置了一个"当前工作对象"，后续的 `*{}` 都是基于这个对象来访问属性

---

## 2. 📦 th:object对象绑定


### 2.1 基本语法规则


**语法格式**：
```html
<标签 th:object="${对象表达式}">
  <!-- 在这个标签范围内，使用 *{} 访问对象属性 -->
</标签>
```

**语法要点**：
- ✅ `th:object` 必须使用 `${}` 表达式
- ✅ 绑定后，内部使用 `*{}` 访问属性
- ✅ `*{}` 等价于 `${对象.属性}`

### 2.2 实际应用示例


**Java后端代码**：
```java
@GetMapping("/user")
public String getUserInfo(Model model) {
    User user = new User("张三", 25, "zhangsan@example.com");
    model.addAttribute("user", user);
    return "userInfo";
}
```

**Thymeleaf模板**：
```html
<!-- 方式1：不使用对象绑定 -->
<div>
  <h3>用户信息</h3>
  <p>姓名：<span th:text="${user.name}">默认姓名</span></p>
  <p>年龄：<span th:text="${user.age}">0</span></p>
  <p>邮箱：<span th:text="${user.email}">默认邮箱</span></p>
</div>

<!-- 方式2：使用对象绑定（推荐） -->
<div th:object="${user}">
  <h3>用户信息</h3>
  <p>姓名：<span th:text="*{name}">默认姓名</span></p>
  <p>年龄：<span th:text="*{age}">0</span></p>
  <p>邮箱：<span th:text="*{email}">默认邮箱</span></p>
</div>
```

### 2.3 表单绑定的典型场景


**表单数据绑定**：
```html
<form th:action="@{/user/save}" th:object="${user}" method="post">
  <label>姓名：<input type="text" th:field="*{name}" /></label>
  <label>年龄：<input type="number" th:field="*{age}" /></label>
  <label>邮箱：<input type="email" th:field="*{email}" /></label>
  <button type="submit">提交</button>
</form>
```

> ⚠️ **注意**：`th:field` 会自动生成 `id`、`name` 和 `value` 属性，非常适合表单处理

---

## 3. 🔍 对象作用域


### 3.1 作用域范围说明


**作用域概念**：`th:object` 绑定的对象只在当前标签及其子标签内有效

```
作用域示意图：

<div th:object="${user}">        ← 绑定user对象
  ┌─────────────────────────┐
  │ <p th:text="*{name}">   │   ← 可以使用*{name}
  │ <div>                   │
  │   <span th:text="*{age}">│  ← 可以使用*{age}
  │ </div>                  │
  └─────────────────────────┘
</div>
<p th:text="*{name}">            ← ❌错误！超出作用域
```

### 3.2 作用域实际示例


```html
<!-- 正确：在作用域内使用 -->
<div th:object="${user}">
  <p th:text="*{name}"></p>
  <div>
    <span th:text="*{email}"></span>  <!-- ✅ 正确 -->
  </div>
</div>

<!-- 错误：超出作用域 -->
<div th:object="${user}">
  <p th:text="*{name}"></p>
</div>
<p th:text="*{email}"></p>  <!-- ❌ 错误：user对象已失效 -->

<!-- 正确：重新绑定 -->
<div th:object="${user}">
  <p th:text="*{name}"></p>
</div>
<div th:object="${user}">  <!-- ✅ 重新绑定 -->
  <p th:text="*{email}"></p>
</div>
```

### 3.3 作用域嵌套规则


**对象绑定可以嵌套**：
```html
<div th:object="${company}">
  <h3 th:text="*{companyName}">公司名称</h3>
  
  <!-- 内部重新绑定另一个对象 -->
  <div th:object="${company.manager}">
    <p>经理姓名：<span th:text="*{name}"></span></p>
    <p>经理年龄：<span th:text="*{age}"></span></p>
  </div>
  
  <!-- 回到外层对象 -->
  <p th:text="*{address}">公司地址</p>
</div>
```

> 💡 **理解要点**：内层绑定会"覆盖"外层绑定，退出内层后恢复外层绑定

---

## 4. 📝 属性访问语法


### 4.1 三种访问方式对比


| 语法 | 说明 | 使用场景 | 示例 |
|------|------|---------|------|
| `${}` | **变量表达式** | 直接访问模型对象 | `${user.name}` |
| `*{}` | **选择表达式** | 访问 `th:object` 绑定对象的属性 | `*{name}` |
| `@{}` | **URL表达式** | 生成URL链接 | `@{/user/info}` |

### 4.2 ${}和*{}的等价关系


**关键理解**：
```html
<!-- 这两种写法完全等价 -->
<div th:object="${user}">
  <p th:text="*{name}"></p>
  <!-- 等同于 -->
  <p th:text="${user.name}"></p>
</div>
```

**转换规则**：
```
*{属性} = ${当前对象.属性}

如果 th:object="${user}"
则 *{name} = ${user.name}
   *{age}  = ${user.age}
```

### 4.3 属性访问的高级用法


**链式访问**：
```html
<div th:object="${user}">
  <!-- 直接访问属性 -->
  <p th:text="*{name}"></p>
  
  <!-- 访问嵌套属性 -->
  <p th:text="*{address.city}"></p>
  
  <!-- 调用getter方法 -->
  <p th:text="*{getFullName()}"></p>
</div>
```

**混合使用**：
```html
<div th:object="${user}">
  <!-- 使用选择表达式 -->
  <p th:text="*{name}"></p>
  
  <!-- 需要访问其他对象时，用变量表达式 -->
  <p th:text="${company.name}"></p>
  
  <!-- 组合使用 -->
  <p th:text="*{name} + ' - ' + ${company.name}"></p>
</div>
```

---

## 5. 🏗️ 嵌套对象处理


### 5.1 嵌套对象结构说明


**Java对象结构**：
```java
class User {
    private String name;
    private Address address;  // 嵌套对象
    // getters and setters
}

class Address {
    private String city;
    private String street;
    private String zipCode;
    // getters and setters
}
```

**对象关系图**：
```
User 对象
├── name (String)
└── address (Address对象)
    ├── city (String)
    ├── street (String)
    └── zipCode (String)
```

### 5.2 访问嵌套对象的方式


**方式1：直接链式访问**（推荐）
```html
<div th:object="${user}">
  <p>姓名：<span th:text="*{name}"></span></p>
  <p>城市：<span th:text="*{address.city}"></span></p>
  <p>街道：<span th:text="*{address.street}"></span></p>
  <p>邮编：<span th:text="*{address.zipCode}"></span></p>
</div>
```

**方式2：重新绑定子对象**
```html
<div th:object="${user}">
  <p>姓名：<span th:text="*{name}"></span></p>
  
  <!-- 绑定嵌套的address对象 -->
  <div th:object="*{address}">
    <p>城市：<span th:text="*{city}"></span></p>
    <p>街道：<span th:text="*{street}"></span></p>
    <p>邮编：<span th:text="*{zipCode}"></span></p>
  </div>
</div>
```

### 5.3 深层嵌套处理


**多层嵌套对象**：
```java
class Company {
    private String companyName;
    private Department department;
}

class Department {
    private String deptName;
    private Manager manager;
}

class Manager {
    private String name;
    private int age;
}
```

**Thymeleaf访问**：
```html
<div th:object="${company}">
  <h2 th:text="*{companyName}"></h2>
  
  <!-- 方式1：链式访问 -->
  <p>部门：<span th:text="*{department.deptName}"></span></p>
  <p>经理：<span th:text="*{department.manager.name}"></span></p>
  
  <!-- 方式2：逐层绑定 -->
  <div th:object="*{department}">
    <p>部门：<span th:text="*{deptName}"></span></p>
    <div th:object="*{manager}">
      <p>经理：<span th:text="*{name}"></span></p>
      <p>年龄：<span th:text="*{age}"></span></p>
    </div>
  </div>
</div>
```

---

## 6. 🛡️ null值安全处理


### 6.1 null值问题说明


**常见问题场景**：
```java
User user = new User();
user.setName("张三");
// 注意：address 为 null，没有设置值
model.addAttribute("user", user);
```

**直接访问会报错**：
```html
<!-- ❌ 如果address为null，这会报错 -->
<p th:text="*{address.city}"></p>
```

### 6.2 安全访问符 ?.


**语法格式**：使用 `?.` 代替 `.` 进行安全访问

```html
<div th:object="${user}">
  <!-- 普通访问：address为null会报错 -->
  <p th:text="*{address.city}"></p>
  
  <!-- 安全访问：address为null返回null，不报错 -->
  <p th:text="*{address?.city}"></p>
</div>
```

**工作原理**：
```
正常访问：  user.address.city  → address为null → 报错
安全访问：  user.address?.city → address为null → 返回null → 不报错
```

### 6.3 多层安全访问


**深层嵌套的安全处理**：
```html
<div th:object="${company}">
  <!-- 单层安全访问 -->
  <p th:text="*{department?.deptName}"></p>
  
  <!-- 多层安全访问 -->
  <p th:text="*{department?.manager?.name}"></p>
  
  <!-- 每一层都可能为null，都需要安全访问符 -->
  <p th:text="*{department?.manager?.contact?.phone}"></p>
</div>
```

### 6.4 null值的默认值处理


**使用默认值操作符**：
```html
<div th:object="${user}">
  <!-- 如果address为null，显示"未设置" -->
  <p th:text="*{address?.city} ?: '未设置'"></p>
  
  <!-- 如果整个address对象为null，显示"暂无地址信息" -->
  <p th:text="*{address?.city ?: address?.street ?: '暂无地址信息'}"></p>
</div>
```

> ⚠️ **最佳实践**：对于可能为null的嵌套对象，始终使用 `?.` 安全访问符

---

## 7. 🔧 对象方法调用


### 7.1 调用对象方法基础


**Java对象定义**：
```java
class User {
    private String firstName;
    private String lastName;
    
    // 普通方法
    public String getFullName() {
        return firstName + " " + lastName;
    }
    
    // 带参数的方法
    public String formatName(String separator) {
        return firstName + separator + lastName;
    }
    
    // 判断方法
    public boolean isAdult() {
        return age >= 18;
    }
}
```

**Thymeleaf调用方法**：
```html
<div th:object="${user}">
  <!-- 调用无参方法 -->
  <p th:text="*{getFullName()}"></p>
  
  <!-- 调用带参方法 -->
  <p th:text="*{formatName('-')}"></p>
  
  <!-- 调用判断方法 -->
  <p th:if="*{isAdult()}">已成年</p>
</div>
```

### 7.2 方法调用的语法规则


**调用规则**：
- ✅ 方法名后必须加 `()`
- ✅ 参数放在括号内，字符串用单引号
- ✅ 可以传递变量和表达式作为参数

**示例说明**：
```html
<div th:object="${user}">
  <!-- 无参方法 -->
  <p th:text="*{getName()}"></p>
  
  <!-- 单参数方法 -->
  <p th:text="*{formatAge('岁')}"></p>
  
  <!-- 多参数方法 -->
  <p th:text="*{calculateScore(80, 90)}"></p>
  
  <!-- 传递变量作为参数 -->
  <p th:text="*{formatName(${separator})}"></p>
</div>
```

### 7.3 getter方法的简化调用


**自动识别getter方法**：
```html
<div th:object="${user}">
  <!-- 标准写法 -->
  <p th:text="*{getName()}"></p>
  
  <!-- 简化写法（Thymeleaf自动调用getName()） -->
  <p th:text="*{name}"></p>
  
  <!-- 这两种写法完全等价 -->
</div>
```

**转换规则**：
```
*{name}     → 自动调用 getName()
*{age}      → 自动调用 getAge()
*{isAdult}  → 自动调用 isAdult() 或 getIsAdult()
```

### 7.4 链式方法调用


**连续调用多个方法**：
```html
<div th:object="${user}">
  <!-- 调用方法后再访问属性 -->
  <p th:text="*{getAddress().getCity()}"></p>
  
  <!-- 等价的简化写法 -->
  <p th:text="*{address.city}"></p>
  
  <!-- 方法调用+安全访问 -->
  <p th:text="*{getAddress()?.getCity()}"></p>
</div>
```

---

## 8. ⚡ 静态方法调用


### 8.1 静态方法调用语法


**语法格式**：
```
T(完整类名).静态方法名(参数)
```

**Java静态方法定义**：
```java
public class StringUtils {
    public static boolean isEmpty(String str) {
        return str == null || str.trim().isEmpty();
    }
    
    public static String capitalize(String str) {
        if (isEmpty(str)) return str;
        return str.substring(0, 1).toUpperCase() + str.substring(1);
    }
}
```

**Thymeleaf调用静态方法**：
```html
<!-- 调用自定义工具类的静态方法 -->
<p th:if="${T(com.example.util.StringUtils).isEmpty(user.name)}">
  姓名为空
</p>

<p th:text="${T(com.example.util.StringUtils).capitalize(user.name)}">
  首字母大写的姓名
</p>
```

### 8.2 常用JDK静态方法


**Math类方法**：
```html
<!-- 取最大值 -->
<p th:text="${T(java.lang.Math).max(score1, score2)}"></p>

<!-- 四舍五入 -->
<p th:text="${T(java.lang.Math).round(price)}"></p>

<!-- 随机数 -->
<p th:text="${T(java.lang.Math).random()}"></p>
```

**String类方法**：
```html
<!-- 格式化字符串 -->
<p th:text="${T(java.lang.String).format('姓名：%s，年龄：%d', name, age)}"></p>

<!-- 字符串连接 -->
<p th:text="${T(java.lang.String).join('-', list)}"></p>
```

**LocalDate日期处理**：
```html
<!-- 获取当前日期 -->
<p th:text="${T(java.time.LocalDate).now()}"></p>

<!-- 解析日期字符串 -->
<p th:text="${T(java.time.LocalDate).parse('2024-01-20')}"></p>
```

### 8.3 静态方法的实际应用


**场景1：日期格式化**
```html
<div th:object="${order}">
  <p>订单号：<span th:text="*{orderNo}"></span></p>
  <p>下单时间：
    <span th:text="${T(java.time.format.DateTimeFormatter)
      .ofPattern('yyyy-MM-dd HH:mm:ss')
      .format(order.createTime)}">
    </span>
  </p>
</div>
```

**场景2：数值计算**
```html
<div th:object="${product}">
  <p>原价：<span th:text="*{originalPrice}"></span></p>
  <p>折扣价：
    <span th:text="${T(java.lang.Math).round(product.originalPrice * 0.8)}">
    </span>
  </p>
</div>
```

**场景3：条件判断**
```html
<!-- 使用工具类进行复杂判断 -->
<div th:if="${T(org.springframework.util.StringUtils).hasText(user.email)}">
  <p>邮箱：<span th:text="${user.email}"></span></p>
</div>
```

> 💡 **使用建议**：虽然可以调用静态方法，但复杂逻辑建议在后端处理，模板只负责展示

---

## 9. 📋 核心要点总结


### 9.1 必须掌握的核心概念


```
🔸 对象绑定：th:object="${对象}" 设定当前操作对象
🔸 属性访问：*{属性} 访问绑定对象的属性
🔸 作用域：对象绑定在当前标签及子标签内有效
🔸 嵌套访问：*{对象.属性} 或 *{对象?.属性}（安全访问）
🔸 方法调用：*{方法名()} 调用对象方法
🔸 静态方法：T(类名).方法名() 调用静态方法
```

### 9.2 语法对比速查表


| 语法 | 含义 | 使用场景 | 示例 |
|------|------|---------|------|
| `${}` | 变量表达式 | 访问模型数据 | `${user.name}` |
| `*{}` | 选择表达式 | 访问绑定对象属性 | `*{name}` |
| `.` | 属性访问 | 访问对象属性 | `*{address.city}` |
| `?.` | 安全访问 | 避免null异常 | `*{address?.city}` |
| `?:` | 默认值 | null时使用默认值 | `*{name ?: '匿名'}` |
| `()` | 方法调用 | 调用对象方法 | `*{getName()}` |
| `T()` | 类型引用 | 调用静态方法 | `T(Math).max(a,b)` |

### 9.3 常见应用场景总结


**表单数据绑定**：
```html
<form th:action="@{/save}" th:object="${user}" method="post">
  <input type="text" th:field="*{name}" />
  <input type="email" th:field="*{email}" />
  <button type="submit">保存</button>
</form>
```

**数据展示**：
```html
<div th:object="${user}">
  <h3 th:text="*{name}"></h3>
  <p th:text="*{address?.city ?: '未知城市'}"></p>
</div>
```

**条件判断**：
```html
<div th:object="${user}">
  <p th:if="*{isVip()}">VIP用户</p>
  <p th:unless="*{address?.city}">地址信息不完整</p>
</div>
```

### 9.4 最佳实践建议


> ✅ **推荐做法**：
> - 表单使用 `th:object` + `th:field` 组合
> - 嵌套对象优先使用链式访问 `*{obj.prop}`
> - 可能为null的属性使用安全访问符 `?.`
> - 简单逻辑用Thymeleaf，复杂逻辑放后端

> ❌ **避免事项**：
> - 避免在模板中编写复杂业务逻辑
> - 避免过度使用静态方法调用
> - 避免深层嵌套（超过3层）

**核心记忆口诀**：
```
对象绑定用object，星号访问更简洁
嵌套属性用点连，安全访问问号见
方法调用加括号，静态方法T引导
```