---
title: 2、循环状态变量与控制
---
## 📚 目录

1. [循环状态对象概述](#1-循环状态对象概述)
2. [index索引值详解](#2-index索引值详解)
3. [count计数值详解](#3-count计数值详解)
4. [size集合大小详解](#4-size集合大小详解)
5. [first首元素判断](#5-first首元素判断)
6. [last尾元素判断](#6-last尾元素判断)
7. [even偶数行判断](#7-even偶数行判断)
8. [odd奇数行判断](#8-odd奇数行判断)
9. [实战应用场景](#9-实战应用场景)
10. [核心要点总结](#10-核心要点总结)

---

## 1. 🎯 循环状态对象概述


### 1.1 什么是循环状态对象


**通俗理解**：当你用Thymeleaf遍历一个列表时，就像在数人头一样。循环状态对象（iterStat）就是一个"记录员"，它会告诉你：
- 现在数到第几个了（索引）
- 这是第几个人（计数）
- 总共有多少人（大小）
- 这是不是第一个/最后一个人
- 当前是奇数行还是偶数行

```
想象场景：
你在给100个学生发奖状
- 需要知道当前是第几个学生（index）
- 需要知道已经发了几张（count）
- 需要知道总共要发几张（size）
- 第一个学生要特别欢迎（first）
- 最后一个学生要说结束语（last）
- 奇数行和偶数行用不同颜色区分（odd/even）
```

### 1.2 如何使用状态对象


**基本语法**：
```html
<tr th:each="user, iterStat : ${userList}">
    <!-- user是当前元素，iterStat是状态对象 -->
</tr>
```

**语法拆解**：
- `user`：当前循环的元素（就像当前这个学生）
- `iterStat`：状态对象（记录当前循环的各种信息）
- `${userList}`：要遍历的集合（所有学生的列表）

> 💡 **小提示**：状态对象的名字可以自定义，但习惯上用 `iterStat`、`stat`、`status` 这样的名字

### 1.3 状态对象包含的属性


| 属性名 | 作用说明 | 返回类型 | 使用场景 |
|--------|---------|---------|---------|
| **index** | 当前元素的索引（从0开始） | `int` | 需要知道位置序号 |
| **count** | 当前元素的计数（从1开始） | `int` | 显示"第几个" |
| **size** | 集合的总大小 | `int` | 显示总数、计算进度 |
| **first** | 是否是第一个元素 | `boolean` | 首行特殊处理 |
| **last** | 是否是最后一个元素 | `boolean` | 尾行特殊处理 |
| **even** | 是否是偶数行 | `boolean` | 隔行变色 |
| **odd** | 是否是奇数行 | `boolean` | 隔行变色 |

---

## 2. 🔢 index索引值详解


### 2.1 index是什么


**通俗解释**：index就是"第几个位置"，从0开始数。

```
现实类比：
教室座位号：  0号  1号  2号  3号  4号
学生姓名：   张三  李四  王五  赵六  孙七
            ↑
         index=0（第一个位置）
```

**核心特点**：
- 🔸 从 **0** 开始计数
- 🔸 第一个元素的 index = 0
- 🔸 第二个元素的 index = 1
- 🔸 第n个元素的 index = n-1

### 2.2 index的常见用途


**用途1：显示位置序号**
```html
<tr th:each="user, stat : ${userList}">
    <td th:text="${stat.index}">0</td>
    <td th:text="${user.name}">张三</td>
</tr>
```

**渲染结果**：
```
索引  姓名
0    张三
1    李四
2    王五
```

**用途2：数组下标访问**
```html
<div th:each="item, stat : ${items}">
    <span>第[[${stat.index}]]个</span>
    <span>对应数组位置：items[[[${stat.index}]]]</span>
</div>
```

**用途3：CSS类名动态生成**
```html
<div th:each="card, stat : ${cards}" 
     th:class="'card-' + ${stat.index}">
    <!-- 生成 card-0, card-1, card-2 等类名 -->
</div>
```

### 2.3 实战案例：带序号的表格


```html
<table>
    <tr th:each="product, stat : ${products}">
        <!-- 方式1：直接显示index -->
        <td th:text="${stat.index}">0</td>
        
        <!-- 方式2：index+1显示人类习惯的序号 -->
        <td th:text="${stat.index + 1}">1</td>
        
        <td th:text="${product.name}">商品名</td>
        <td th:text="${product.price}">价格</td>
    </tr>
</table>
```

---

## 3. 📊 count计数值详解


### 3.1 count是什么


**通俗解释**：count就是"第几个"，从1开始数，符合人类的计数习惯。

```
人类计数习惯：
第1个  第2个  第3个  第4个  第5个
张三   李四   王五   赵六   孙七
↑
count=1（第一个）
```

**count vs index 对比**：

| 对比项 | **index（索引）** | **count（计数）** |
|--------|------------------|------------------|
| 起始值 | `0` | `1` |
| 第一个元素 | `0` | `1` |
| 第五个元素 | `4` | `5` |
| 使用场景 | 程序员思维、数组访问 | 用户展示、序号显示 |

### 3.2 count的常见用途


**用途1：显示自然序号**
```html
<tr th:each="student, stat : ${students}">
    <td th:text="${stat.count}">1</td>
    <td th:text="${student.name}">姓名</td>
    <td th:text="${student.score}">分数</td>
</tr>
```

**渲染结果**：
```
序号  姓名    分数
1     张三    95
2     李四    88
3     王五    92
```

**用途2：进度计算**
```html
<div th:each="step, stat : ${steps}">
    <p>步骤 [[${stat.count}]]/[[${stat.size}]]</p>
    <p>进度：[[${stat.count * 100 / stat.size}]]%</p>
</div>
```

**用途3：分页显示**
```html
<!-- 假设每页10条，当前第2页 -->
<tr th:each="item, stat : ${pageItems}">
    <!-- 全局序号 = (当前页-1)*每页数量 + count -->
    <td th:text="${(currentPage - 1) * 10 + stat.count}">11</td>
    <td th:text="${item.title}">标题</td>
</tr>
```

### 3.3 什么时候用count，什么时候用index


> 💡 **选择建议**：
> - 给**用户看**的序号 → 用 `count`（从1开始，符合习惯）
> - **程序逻辑**使用 → 用 `index`（从0开始，数组下标）

```html
<!-- 用户看到的序号：用count -->
<td>第 [[${stat.count}]] 名</td>

<!-- CSS类名、数组访问：用index -->
<div th:class="'item-' + ${stat.index}"></div>
```

---

## 4. 📏 size集合大小详解


### 4.1 size是什么


**通俗解释**：size就是告诉你"一共有多少个元素"，整个循环过程中这个值是固定的。

```
班级人数统计：
总人数(size) = 50人
当前点名到(count) = 25人
还剩(size - count) = 25人
```

**核心特点**：
- 🔸 表示集合的**总数量**
- 🔸 在循环中**保持不变**
- 🔸 可用于计算**进度、百分比**

### 4.2 size的常见用途


**用途1：显示总数**
```html
<p>共有 [[${stat.size}]] 条记录</p>

<ul th:each="item, stat : ${items}">
    <li>[[${item.name}]] (共[[${stat.size}]]项)</li>
</ul>
```

**用途2：计算进度百分比**
```html
<div th:each="task, stat : ${tasks}">
    <span>任务 [[${stat.count}]]/[[${stat.size}]]</span>
    <!-- 计算完成百分比 -->
    <span>[[${stat.count * 100 / stat.size}]]%</span>
    <progress th:value="${stat.count}" th:max="${stat.size}"></progress>
</div>
```

**用途3：判断集合是否为空**
```html
<div th:if="${stat.size == 0}">
    暂无数据
</div>

<div th:if="${stat.size > 0}">
    共找到 [[${stat.size}]] 条结果
</div>
```

### 4.3 实战案例：购物车商品统计


```html
<div class="cart-header">
    <h3>购物车（共[[${stat.size}]]件商品）</h3>
</div>

<table>
    <tr th:each="item, stat : ${cartItems}">
        <td>[[${stat.count}]]</td>
        <td>[[${item.name}]]</td>
        <td>[[${item.price}]]</td>
        <td>[[${item.quantity}]]</td>
    </tr>
    <tr>
        <td colspan="4">
            已选择 [[${stat.size}]] 种商品
        </td>
    </tr>
</table>
```

---

## 5. 🎬 first首元素判断


### 5.1 first是什么


**通俗解释**：first就像问"这是第一个吗？"，如果是第一个返回true，否则返回false。

```
队列场景：
第1个人 → first = true  (是队首)
第2个人 → first = false
第3个人 → first = false
...
```

**核心特点**：
- 🔸 只有**第一个元素**是 `true`
- 🔸 其他所有元素都是 `false`
- 🔸 用于**首行特殊处理**

### 5.2 first的常见用途


**用途1：首行添加特殊样式**
```html
<tr th:each="user, stat : ${users}"
    th:class="${stat.first} ? 'first-row' : ''">
    <td>[[${user.name}]]</td>
</tr>
```

**用途2：只在第一行显示某些内容**
```html
<div th:each="item, stat : ${items}">
    <!-- 只在第一个元素显示标题 -->
    <h3 th:if="${stat.first}">商品列表</h3>
    <p>[[${item.name}]]</p>
</div>
```

**用途3：第一个元素不加分隔符**
```html
<span th:each="tag, stat : ${tags}">
    <!-- 第一个前面不加逗号 -->
    <span th:if="${!stat.first}">, </span>
    [[${tag}]]
</span>
```

**渲染结果**：`Java, Python, JavaScript`

### 5.3 实战案例：面包屑导航


```html
<nav class="breadcrumb">
    <span th:each="path, stat : ${pathList}">
        <!-- 第一个元素添加home图标 -->
        <i th:if="${stat.first}" class="icon-home"></i>
        
        <!-- 非第一个元素前加分隔符 -->
        <span th:if="${!stat.first}"> > </span>
        
        <a th:href="${path.url}" th:text="${path.name}">首页</a>
    </span>
</nav>
```

**渲染效果**：`🏠 首页 > 产品中心 > 电子产品`

---

## 6. 🏁 last尾元素判断


### 6.1 last是什么


**通俗解释**：last就像问"这是最后一个吗？"，如果是最后一个返回true，否则返回false。

```
队列场景：
第1个人 → last = false
第2个人 → last = false
...
最后1个 → last = true  (是队尾)
```

**核心特点**：
- 🔸 只有**最后一个元素**是 `true`
- 🔸 其他所有元素都是 `false`
- 🔸 用于**尾行特殊处理**

### 6.2 last的常见用途


**用途1：最后一行不加分割线**
```html
<div th:each="item, stat : ${items}">
    <div class="item-content">[[${item.name}]]</div>
    <!-- 不是最后一个才加分割线 -->
    <hr th:if="${!stat.last}" />
</div>
```

**用途2：最后一个元素特殊样式**
```html
<li th:each="menu, stat : ${menus}"
    th:class="${stat.last} ? 'last-item' : ''">
    [[${menu.name}]]
</li>
```

**用途3：最后一个不加逗号**
```html
<span th:each="author, stat : ${authors}">
    [[${author}]]<span th:if="${!stat.last}">, </span>
</span>
```

**渲染结果**：`张三, 李四, 王五`

### 6.3 实战案例：标签列表


```html
<div class="tags">
    <span th:each="tag, stat : ${tags}" 
          th:class="${stat.last} ? 'tag last-tag' : 'tag'">
        [[${tag.name}]]
        <!-- 最后一个不显示逗号 -->
        <span th:if="${!stat.last}">,</span>
    </span>
</div>
```

---

## 7. ⚪ even偶数行判断


### 7.1 even是什么


**通俗解释**：even就是判断"当前是不是偶数行"，注意这里的"偶数"是按count来算的。

```
理解even的计数方式：
count=1 (第1个) → even = false (奇数)
count=2 (第2个) → even = true  (偶数) ✓
count=3 (第3个) → even = false (奇数)
count=4 (第4个) → even = true  (偶数) ✓
```

> ⚠️ **重要提醒**：even是根据`count`判断的，count从1开始，所以第1个是奇数，第2个才是偶数

**核心特点**：
- 🔸 基于 `count` 判断（不是index）
- 🔸 第2、4、6...个元素为 `true`
- 🔸 第1、3、5...个元素为 `false`

### 7.2 even的常见用途


**用途1：表格隔行变色**
```html
<tr th:each="row, stat : ${dataList}"
    th:class="${stat.even} ? 'even-row' : 'odd-row'">
    <td>[[${row.name}]]</td>
    <td>[[${row.value}]]</td>
</tr>
```

**对应CSS**：
```css
.even-row { background-color: #f0f0f0; }
.odd-row  { background-color: #ffffff; }
```

**用途2：列表隔行背景**
```html
<div th:each="item, stat : ${items}"
     th:style="${stat.even} ? 'background: #f9f9f9' : ''">
    [[${item.content}]]
</div>
```

**用途3：双列布局**
```html
<div th:each="card, stat : ${cards}"
     th:class="${stat.even} ? 'right-column' : 'left-column'">
    [[${card.title}]]
</div>
```

### 7.3 实战案例：数据表格


```html
<table class="data-table">
    <thead>
        <tr>
            <th>序号</th>
            <th>姓名</th>
            <th>成绩</th>
        </tr>
    </thead>
    <tbody>
        <tr th:each="student, stat : ${students}"
            th:class="${stat.even} ? 'bg-gray' : 'bg-white'">
            <td>[[${stat.count}]]</td>
            <td>[[${student.name}]]</td>
            <td>[[${student.score}]]</td>
        </tr>
    </tbody>
</table>
```

**视觉效果**：
```
序号  姓名    成绩
1     张三    95   (白色背景)
2     李四    88   (灰色背景)
3     王五    92   (白色背景)
4     赵六    87   (灰色背景)
```

---

## 8. ⚫ odd奇数行判断


### 8.1 odd是什么


**通俗解释**：odd就是判断"当前是不是奇数行"，和even正好相反。

```
理解odd的计数方式：
count=1 (第1个) → odd = true  (奇数) ✓
count=2 (第2个) → odd = false (偶数)
count=3 (第3个) → odd = true  (奇数) ✓
count=4 (第4个) → odd = false (偶数)
```

**核心特点**：
- 🔸 基于 `count` 判断（不是index）
- 🔸 第1、3、5...个元素为 `true`
- 🔸 第2、4、6...个元素为 `false`
- 🔸 与 `even` 互补（一个true另一个必定false）

### 8.2 odd与even的关系


| count值 | odd结果 | even结果 | 说明 |
|---------|---------|----------|------|
| `1` | `true` | `false` | 第1个（奇数） |
| `2` | `false` | `true` | 第2个（偶数） |
| `3` | `true` | `false` | 第3个（奇数） |
| `4` | `false` | `true` | 第4个（偶数） |

> 💡 **记忆技巧**：`odd + even` 永远一个true一个false，就像开关

### 8.3 odd的常见用途


**用途1：奇数行高亮**
```html
<div th:each="msg, stat : ${messages}"
     th:class="${stat.odd} ? 'highlight' : ''">
    [[${msg.content}]]
</div>
```

**用途2：奇偶行不同图标**
```html
<li th:each="task, stat : ${tasks}">
    <!-- 奇数行显示星星，偶数行显示圆点 -->
    <i th:class="${stat.odd} ? 'icon-star' : 'icon-circle'"></i>
    [[${task.title}]]
</li>
```

**用途3：左右交替布局**
```html
<div th:each="feature, stat : ${features}"
     th:class="${stat.odd} ? 'align-left' : 'align-right'">
    <img th:src="${feature.image}" />
    <p>[[${feature.description}]]</p>
</div>
```

### 8.4 实战案例：聊天对话框


```html
<div class="chat-container">
    <div th:each="message, stat : ${chatMessages}"
         th:class="${stat.odd} ? 'message-left' : 'message-right'">
        
        <div class="avatar" th:class="${stat.odd} ? 'avatar-user' : 'avatar-bot'">
            <img th:src="${stat.odd} ? '/user.png' : '/bot.png'" />
        </div>
        
        <div class="bubble" th:class="${stat.odd} ? 'bubble-blue' : 'bubble-gray'">
            [[${message.text}]]
        </div>
    </div>
</div>
```

**视觉效果**：
```
用户(左对齐, 蓝色气泡)：你好！
机器人(右对齐, 灰色气泡)：您好，有什么可以帮您？
用户(左对齐, 蓝色气泡)：我想查询订单
机器人(右对齐, 灰色气泡)：请提供订单号
```

---

## 9. 🚀 实战应用场景


### 9.1 综合案例：订单列表


```html
<div class="order-list">
    <!-- 显示总数 -->
    <h3>我的订单 (共[[${stat.size}]]个)</h3>
    
    <div th:each="order, stat : ${orders}"
         th:class="${stat.even} ? 'order-card even' : 'order-card odd'">
        
        <!-- 序号显示 -->
        <div class="order-number">
            订单 [[${stat.count}]]/[[${stat.size}]]
        </div>
        
        <!-- 第一个订单显示徽章 -->
        <span th:if="${stat.first}" class="badge">最新</span>
        
        <!-- 订单信息 -->
        <div class="order-info">
            <p>订单号：[[${order.id}]]</p>
            <p>金额：[[${order.amount}]]</p>
        </div>
        
        <!-- 最后一个不显示分割线 -->
        <hr th:if="${!stat.last}" />
    </div>
</div>
```

### 9.2 综合案例：步骤进度条


```html
<div class="steps">
    <div th:each="step, stat : ${steps}"
         th:class="${stat.odd} ? 'step step-odd' : 'step step-even'">
        
        <!-- 步骤编号 -->
        <div class="step-number">[[${stat.count}]]</div>
        
        <!-- 步骤内容 -->
        <div class="step-content">
            <h4>[[${step.title}]]</h4>
            <p>[[${step.description}]]</p>
        </div>
        
        <!-- 进度百分比 -->
        <div class="step-progress">
            [[${stat.count * 100 / stat.size}]]% 完成
        </div>
        
        <!-- 不是最后一步显示箭头 -->
        <div th:if="${!stat.last}" class="arrow">→</div>
    </div>
</div>
```

### 9.3 常见场景速查表


| 场景需求 | 使用的状态属性 | 示例 |
|---------|---------------|------|
| 显示"第几条" | `count` | `第[[${stat.count}]]条` |
| 数组下标访问 | `index` | `arr[[[${stat.index}]]]` |
| 显示总条数 | `size` | `共[[${stat.size}]]条` |
| 计算进度 | `count + size` | `[[${stat.count*100/stat.size}]]%` |
| 首行特殊处理 | `first` | `th:if="${stat.first}"` |
| 尾行特殊处理 | `last` | `th:if="${stat.last}"` |
| 隔行变色 | `even / odd` | `th:class="${stat.even} ? 'gray' : 'white'"` |
| 添加分隔符 | `!last` | `<span th:if="${!stat.last}">,</span>` |

---

## 10. 📋 核心要点总结


### 10.1 必须掌握的核心概念


```
🔸 状态对象：循环中的"记录员"，记录各种循环信息
🔸 index：从0开始的索引，用于程序逻辑
🔸 count：从1开始的计数，用于用户展示
🔸 size：集合总大小，用于计算进度
🔸 first/last：首尾判断，用于特殊处理
🔸 even/odd：奇偶判断，用于隔行效果
```

### 10.2 关键区别理解


**index vs count**：
```
index：0, 1, 2, 3... (程序员视角，从0开始)
count：1, 2, 3, 4... (用户视角，从1开始)

选择原则：
- 给用户看 → 用count
- 程序逻辑 → 用index
```

**even vs odd**：
```
even：第2、4、6...个为true (偶数行)
odd： 第1、3、5...个为true (奇数行)

记忆：
- even = 偶数 = 双数
- odd = 奇数 = 单数
```

**first vs last**：
```
first：只有第1个是true
last： 只有最后1个是true

应用：
- first → 首行标题、特殊图标
- last → 去除分隔符、结束标记
```

### 10.3 实用技巧总结


**技巧1：组合使用**
```html
<!-- first + count：第一个显示总数 -->
<div th:if="${stat.first}">共[[${stat.size}]]项</div>

<!-- even + last：最后一个偶数行特殊处理 -->
<div th:if="${stat.even and stat.last}">...</div>
```

**技巧2：计算进度**
```html
<!-- 完成百分比 -->
[[${stat.count * 100 / stat.size}]]%

<!-- 剩余数量 -->
还剩 [[${stat.size - stat.count}]] 项
```

**技巧3：条件样式**
```html
<!-- 三元表达式 -->
th:class="${stat.even} ? 'even-row' : 'odd-row'"

<!-- 多条件判断 -->
th:class="${stat.first} ? 'first' : (${stat.last} ? 'last' : '')"
```

### 10.4 常见错误避坑


> ⚠️ **错误1**：混淆index和count
```html
❌ 错误：<td>第[[${stat.index}]]个</td>  (从0开始，用户困惑)
✅ 正确：<td>第[[${stat.count}]]个</td>  (从1开始，符合习惯)
```

> ⚠️ **错误2**：忘记even/odd基于count
```html
❌ 误解：index=0是偶数，所以even=true
✅ 正确：count=1是奇数，所以odd=true
```

> ⚠️ **错误3**：状态对象名字写错
```html
❌ 错误：th:each="item : ${list}"  (没有定义状态对象)
        使用${stat.index}会报错
        
✅ 正确：th:each="item, stat : ${list}"  (明确定义stat)
        可以使用${stat.index}
```

### 10.5 学习建议


**记忆口诀**：
```
index从零count从一，
size总数不会变。
first只认第一个，
last只认最后边。
even偶数二四六，
odd奇数一三五。
```

**实践建议**：
- ✅ 多写多练，每个属性都试一遍
- ✅ 先理解概念，再背语法
- ✅ 对照效果，加深印象
- ✅ 结合实际场景应用

**调试技巧**：
```html
<!-- 调试时显示所有状态信息 -->
<div th:each="item, stat : ${list}">
    index=[[${stat.index}]], 
    count=[[${stat.count}]], 
    size=[[${stat.size}]], 
    first=[[${stat.first}]], 
    last=[[${stat.last}]], 
    even=[[${stat.even}]], 
    odd=[[${stat.odd}]]
</div>
```