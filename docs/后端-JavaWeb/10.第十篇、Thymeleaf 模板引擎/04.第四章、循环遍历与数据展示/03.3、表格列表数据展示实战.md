---
title: 3、表格列表数据展示实战
---
## 📚 目录

1. [动态表格渲染](#1-动态表格渲染)
2. [列表数据展示](#2-列表数据展示)
3. [分页数据处理](#3-分页数据处理)
4. [排序功能实现](#4-排序功能实现)
5. [筛选条件展示](#5-筛选条件展示)
6. [空数据与状态处理](#6-空数据与状态处理)
7. [核心要点总结](#7-核心要点总结)

---

## 1. 📊 动态表格渲染


### 1.1 什么是动态表格渲染


**通俗理解**：就像Excel表格一样，后端给你一堆数据，你要在网页上把它们按行按列显示出来。数据可能有几十条、几百条，但代码只需要写一次，Thymeleaf会自动帮你循环生成表格。

```
想象一下：
后端数据：[{姓名:"张三", 年龄:25}, {姓名:"李四", 年龄:30}, ...]
↓ Thymeleaf处理
网页显示：
┌────────┬────────┐
│  姓名  │  年龄  │
├────────┼────────┤
│  张三  │   25   │
│  李四  │   30   │
└────────┴────────┘
```

### 1.2 基础表格循环


**核心语法**：`th:each` 是循环的关键

```html
<!-- 后端Controller传来的数据：List<User> userList -->

<table>
  <thead>
    <tr>
      <th>编号</th>
      <th>姓名</th>
      <th>年龄</th>
      <th>邮箱</th>
    </tr>
  </thead>
  <tbody>
    <!-- th:each 循环遍历用户列表 -->
    <tr th:each="user : ${userList}">
      <td th:text="${user.id}">1</td>
      <td th:text="${user.name}">张三</td>
      <td th:text="${user.age}">25</td>
      <td th:text="${user.email}">test@example.com</td>
    </tr>
  </tbody>
</table>
```

**语法解释**：
- `th:each="user : ${userList}"` → 从userList中每次拿出一个user对象
- `${user.id}` → 获取当前user的id属性
- 就像for循环：`for(User user : userList) { ... }`

### 1.3 获取循环状态信息


**实际需求**：表格需要显示序号、区分奇偶行颜色、判断是否是最后一行

```html
<tr th:each="user, stat : ${userList}" 
    th:class="${stat.odd} ? 'odd-row' : 'even-row'">
  <!-- stat 是状态变量，包含循环信息 -->
  <td th:text="${stat.index + 1}">1</td>  <!-- 序号（从0开始+1） -->
  <td th:text="${user.name}">张三</td>
  <td th:text="${user.age}">25</td>
  <td>
    <span th:if="${stat.last}" style="color: red;">最后一条</span>
  </td>
</tr>
```

**stat 状态对象包含的信息**：

| 属性 | 含义 | 示例 |
|------|------|------|
| **index** | 当前索引（从0开始） | 0, 1, 2... |
| **count** | 当前计数（从1开始） | 1, 2, 3... |
| **size** | 总数量 | 100 |
| **odd** | 是否奇数行 | true/false |
| **even** | 是否偶数行 | true/false |
| **first** | 是否第一条 | true/false |
| **last** | 是否最后一条 | true/false |

### 1.4 嵌套表格处理


**场景**：订单表格，每个订单下面有多个商品明细

```html
<!-- 订单主表 -->
<table>
  <tr th:each="order : ${orderList}">
    <td colspan="4">
      <strong>订单号：</strong>
      <span th:text="${order.orderNo}">20230923001</span>
    </td>
  </tr>
  <!-- 订单明细子表 -->
  <tr th:each="item : ${order.items}">
    <td></td>  <!-- 空列用于缩进 -->
    <td th:text="${item.productName}">商品名称</td>
    <td th:text="${item.quantity}">数量</td>
    <td th:text="${item.price}">价格</td>
  </tr>
</table>
```

**展示效果**：
```
订单号：20230923001
  ├─ 苹果手机    1    5999
  ├─ 手机壳      2    29
  └─ 充电器      1    99
订单号：20230923002
  └─ 笔记本电脑  1    6999
```

---

## 2. 📝 列表数据展示


### 2.1 无序列表展示


**使用场景**：标签展示、技能列表、通知消息等

```html
<!-- 用户技能列表 -->
<ul>
  <li th:each="skill : ${user.skills}" th:text="${skill}">Java</li>
</ul>

<!-- 带图标的列表 -->
<ul class="skill-list">
  <li th:each="skill, stat : ${user.skills}">
    <span th:class="${stat.first} ? 'icon-star' : 'icon-dot'"></span>
    <span th:text="${skill}">Java</span>
  </li>
</ul>
```

### 2.2 有序列表展示


**使用场景**：步骤说明、排行榜、流程展示

```html
<!-- 任务步骤 -->
<ol>
  <li th:each="step : ${taskSteps}">
    <strong th:text="${step.title}">步骤标题</strong>
    <p th:text="${step.description}">步骤说明</p>
  </li>
</ol>

<!-- 排行榜（带名次样式） -->
<ol>
  <li th:each="user, stat : ${rankList}" 
      th:class="${stat.count <= 3} ? 'top-three' : ''">
    <span class="rank" th:text="${stat.count}">1</span>
    <span th:text="${user.name}">用户名</span>
    <span th:text="${user.score}">99分</span>
  </li>
</ol>
```

### 2.3 定义列表展示


**使用场景**：术语解释、属性说明、FAQ问答

```html
<dl th:each="faq : ${faqList}">
  <dt th:text="${faq.question}">问题标题</dt>
  <dd th:text="${faq.answer}">问题答案</dd>
</dl>
```

**展示效果**：
```
什么是Thymeleaf？
  Thymeleaf是一个现代化的Java模板引擎...
  
如何循环数据？
  使用th:each属性进行数据循环...
```

### 2.4 卡片式列表


**使用场景**：商品展示、文章列表、用户卡片

```html
<div class="card-container">
  <div class="card" th:each="product : ${productList}">
    <img th:src="${product.imageUrl}" alt="商品图片">
    <h3 th:text="${product.name}">商品名称</h3>
    <p class="price">
      ¥<span th:text="${product.price}">99.00</span>
    </p>
    <span class="tag" 
          th:if="${product.isNew}" 
          th:text="'新品'">新品</span>
  </div>
</div>
```

---

## 3. 📄 分页数据处理


### 3.1 分页的基本概念


**什么是分页**？
假如数据库有1000条用户数据，一次性全显示会很卡。分页就是每次只显示一部分（比如10条），用户点"下一页"再显示下10条。

```
数据库：1000条记录
         ↓ 分页
第1页：显示 1-10 条    ← 当前显示
第2页：显示 11-20条
第3页：显示 21-30条
...
第100页：991-1000条
```

### 3.2 后端分页对象


**Java后端常用的分页对象**：

```java
public class PageInfo<T> {
    private List<T> list;      // 当前页的数据
    private int pageNum;       // 当前页码
    private int pageSize;      // 每页显示数量
    private long total;        // 总记录数
    private int pages;         // 总页数
    
    // 是否有上一页、下一页
    public boolean hasPreviousPage() {
        return pageNum > 1;
    }
    public boolean hasNextPage() {
        return pageNum < pages;
    }
}
```

### 3.3 分页数据展示


```html
<!-- 表格数据 -->
<table>
  <tr th:each="user : ${pageInfo.list}">
    <td th:text="${user.name}">用户名</td>
    <td th:text="${user.email}">邮箱</td>
  </tr>
</table>

<!-- 分页信息 -->
<div class="page-info">
  共 <strong th:text="${pageInfo.total}">100</strong> 条记录，
  当前第 <strong th:text="${pageInfo.pageNum}">1</strong> 页，
  共 <strong th:text="${pageInfo.pages}">10</strong> 页
</div>
```

### 3.4 分页导航栏


```html
<div class="pagination">
  <!-- 上一页按钮 -->
  <a th:if="${pageInfo.hasPreviousPage}" 
     th:href="@{/users(page=${pageInfo.pageNum - 1})}"
     class="page-btn">上一页</a>
  <span th:unless="${pageInfo.hasPreviousPage}" 
        class="page-btn disabled">上一页</span>
  
  <!-- 页码列表 -->
  <a th:each="pageNum : ${#numbers.sequence(1, pageInfo.pages)}"
     th:href="@{/users(page=${pageNum})}"
     th:text="${pageNum}"
     th:class="${pageNum == pageInfo.pageNum} ? 'active' : ''"
     class="page-num">1</a>
  
  <!-- 下一页按钮 -->
  <a th:if="${pageInfo.hasNextPage}" 
     th:href="@{/users(page=${pageInfo.pageNum + 1})}"
     class="page-btn">下一页</a>
  <span th:unless="${pageInfo.hasNextPage}" 
        class="page-btn disabled">下一页</span>
</div>
```

**效果示意**：
```
共100条记录，当前第3页，共10页
[上一页] [1] [2] [3] [4] [5] ... [10] [下一页]
              ↑当前页高亮
```

### 3.5 简化版分页（只显示部分页码）


```html
<!-- 只显示当前页前后2页 -->
<div class="pagination">
  <a th:if="${pageInfo.hasPreviousPage}" 
     th:href="@{/users(page=${pageInfo.pageNum - 1})}">«</a>
  
  <!-- 首页 -->
  <a th:if="${pageInfo.pageNum > 3}" 
     th:href="@{/users(page=1)}">1</a>
  <span th:if="${pageInfo.pageNum > 4}">...</span>
  
  <!-- 当前页前后2页 -->
  <th:block th:each="i : ${#numbers.sequence(
      pageInfo.pageNum - 2 > 0 ? pageInfo.pageNum - 2 : 1, 
      pageInfo.pageNum + 2 < pageInfo.pages ? pageInfo.pageNum + 2 : pageInfo.pages
    )}">
    <a th:href="@{/users(page=${i})}" 
       th:text="${i}"
       th:class="${i == pageInfo.pageNum} ? 'active' : ''">1</a>
  </th:block>
  
  <!-- 末页 -->
  <span th:if="${pageInfo.pageNum < pageInfo.pages - 3}">...</span>
  <a th:if="${pageInfo.pageNum < pageInfo.pages - 2}" 
     th:href="@{/users(page=${pageInfo.pages})}" 
     th:text="${pageInfo.pages}">10</a>
  
  <a th:if="${pageInfo.hasNextPage}" 
     th:href="@{/users(page=${pageInfo.pageNum + 1})}">»</a>
</div>
```

**效果**：
```
当前第5页时显示：
[«] [1] [...] [3] [4] [5] [6] [7] [...] [10] [»]
                    ↑当前页
```

---

## 4. 🔄 排序功能实现


### 4.1 排序的概念


**什么是排序**？
就是按某个字段重新排列数据，比如按价格从低到高、按时间从新到旧。

```
原始数据：
ID   姓名   年龄
1    张三   25
2    李四   30
3    王五   20

按年龄升序 ↓
ID   姓名   年龄
3    王五   20  ← 最小
1    张三   25
2    李四   30  ← 最大
```

### 4.2 单字段排序


```html
<table>
  <thead>
    <tr>
      <th>
        <a th:href="@{/users(sort='name', order='asc')}">
          姓名
          <span th:if="${sort == 'name' && order == 'asc'}">▲</span>
          <span th:if="${sort == 'name' && order == 'desc'}">▼</span>
        </a>
      </th>
      <th>
        <a th:href="@{/users(sort='age', order='asc')}">
          年龄
          <span th:if="${sort == 'age' && order == 'asc'}">▲</span>
          <span th:if="${sort == 'age' && order == 'desc'}">▼</span>
        </a>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr th:each="user : ${userList}">
      <td th:text="${user.name}">张三</td>
      <td th:text="${user.age}">25</td>
    </tr>
  </tbody>
</table>
```

**工作流程**：
```
用户点击"姓名"列 
  ↓
发送请求：/users?sort=name&order=asc
  ↓
后端排序后返回数据
  ↓
页面显示升序箭头▲
```

### 4.3 智能切换排序方向


```html
<!-- 点击同一列，自动切换升序/降序 -->
<th th:each="column : ${['name', 'age', 'createTime']}">
  <a th:href="@{/users(
       sort=${column},
       order=${sort == column && order == 'asc' ? 'desc' : 'asc'}
     )}">
    <span th:text="${column}">列名</span>
    <span th:if="${sort == column}">
      <span th:if="${order == 'asc'}">▲</span>
      <span th:if="${order == 'desc'}">▼</span>
    </span>
  </a>
</th>
```

**逻辑说明**：
- 如果当前是按name升序，点击name列 → 切换为降序
- 如果当前是按age排序，点击name列 → 按name升序

### 4.4 排序与分页结合


```html
<!-- 保持排序状态的分页链接 -->
<div class="pagination">
  <a th:href="@{/users(
       page=${pageInfo.pageNum - 1},
       sort=${sort},
       order=${order}
     )}"
     th:if="${pageInfo.hasPreviousPage}">上一页</a>
  
  <a th:each="i : ${#numbers.sequence(1, pageInfo.pages)}"
     th:href="@{/users(
       page=${i},
       sort=${sort},
       order=${order}
     )}"
     th:text="${i}"
     th:class="${i == pageInfo.pageNum} ? 'active' : ''">1</a>
  
  <a th:href="@{/users(
       page=${pageInfo.pageNum + 1},
       sort=${sort},
       order=${order}
     )}"
     th:if="${pageInfo.hasNextPage}">下一页</a>
</div>
```

---

## 5. 🔍 筛选条件展示


### 5.1 筛选条件的作用


**为什么需要筛选**？
数据太多时，用户想快速找到符合条件的记录。比如在1000个用户中找"年龄25-30岁"的"男性"用户。

```
全部数据：1000条
  ↓ 应用筛选条件
性别=男：500条
  ↓ 继续筛选
年龄25-30：50条  ← 最终结果
```

### 5.2 基础筛选表单


```html
<form th:action="@{/users}" method="get">
  <!-- 姓名搜索 -->
  <input type="text" 
         name="name" 
         th:value="${param.name}"
         placeholder="搜索姓名">
  
  <!-- 年龄范围 -->
  <input type="number" 
         name="minAge" 
         th:value="${param.minAge}"
         placeholder="最小年龄">
  <span>-</span>
  <input type="number" 
         name="maxAge" 
         th:value="${param.maxAge}"
         placeholder="最大年龄">
  
  <!-- 性别选择 -->
  <select name="gender">
    <option value="">全部</option>
    <option value="male" 
            th:selected="${param.gender == 'male'}">男</option>
    <option value="female" 
            th:selected="${param.gender == 'female'}">女</option>
  </select>
  
  <button type="submit">搜索</button>
</form>
```

**关键点**：
- `th:value="${param.name}"` → 保持上次搜索的内容
- `th:selected` → 保持下拉框的选中状态

### 5.3 已选条件标签展示


**效果**：像淘宝筛选后显示的"可删除标签"

```html
<div class="filter-tags" th:if="${not #strings.isEmpty(param.name) 
                                   or not #strings.isEmpty(param.gender)}">
  <span>已选条件：</span>
  
  <!-- 姓名筛选标签 -->
  <span class="tag" th:if="${not #strings.isEmpty(param.name)}">
    姓名：<strong th:text="${param.name}">张三</strong>
    <a th:href="@{/users(
         gender=${param.gender},
         minAge=${param.minAge},
         maxAge=${param.maxAge}
       )}">×</a>
  </span>
  
  <!-- 性别筛选标签 -->
  <span class="tag" th:if="${not #strings.isEmpty(param.gender)}">
    性别：<strong th:text="${param.gender == 'male' ? '男' : '女'}">男</strong>
    <a th:href="@{/users(
         name=${param.name},
         minAge=${param.minAge},
         maxAge=${param.maxAge}
       )}">×</a>
  </span>
  
  <!-- 清空所有条件 -->
  <a th:href="@{/users}" class="clear-all">清空</a>
</div>
```

**展示效果**：
```
已选条件：[姓名：张三 ×] [性别：男 ×] [清空]
```

### 5.4 筛选条件与分页、排序结合


```html
<!-- 分页链接要带上所有筛选条件 -->
<a th:href="@{/users(
     page=${pageInfo.pageNum + 1},
     sort=${sort},
     order=${order},
     name=${param.name},
     gender=${param.gender},
     minAge=${param.minAge},
     maxAge=${param.maxAge}
   )}"
   th:if="${pageInfo.hasNextPage}">下一页</a>
```

**简化写法（使用th:with）**：
```html
<div th:with="baseParams=${
       'name=' + (param.name ?: '') + 
       '&gender=' + (param.gender ?: '') +
       '&minAge=' + (param.minAge ?: '') +
       '&maxAge=' + (param.maxAge ?: '')
     }">
  <a th:href="@{/users(page=${i}, sort=${sort}, order=${order})} + '&' + ${baseParams}">
    链接
  </a>
</div>
```

---

## 6. 🚫 空数据与状态处理


### 6.1 空数据提示


**场景**：查询结果为空时，给用户友好的提示

```html
<!-- 方式1：使用th:if -->
<div th:if="${#lists.isEmpty(userList)}" class="empty-state">
  <img src="/images/empty.png" alt="暂无数据">
  <p>暂时没有找到用户数据</p>
  <a th:href="@{/users}">返回列表</a>
</div>

<table th:unless="${#lists.isEmpty(userList)}">
  <tr th:each="user : ${userList}">
    <td th:text="${user.name}">用户名</td>
  </tr>
</table>
```

**方式2：更优雅的写法**

```html
<th:block th:if="${not #lists.isEmpty(userList)}">
  <!-- 有数据时显示表格 -->
  <table>
    <tr th:each="user : ${userList}">
      <td th:text="${user.name}">用户名</td>
    </tr>
  </table>
</th:block>

<th:block th:if="${#lists.isEmpty(userList)}">
  <!-- 无数据时显示提示 -->
  <div class="empty-tip">
    <p>😔 暂无数据</p>
    <p th:if="${not #strings.isEmpty(param.name)}">
      没有找到姓名包含 "<strong th:text="${param.name}">张三</strong>" 的用户
    </p>
  </div>
</th:block>
```

### 6.2 加载状态处理


**场景**：数据还在加载时显示"加载中..."

```html
<!-- 后端传来loading状态 -->
<div th:if="${loading}" class="loading">
  <div class="spinner"></div>
  <p>加载中，请稍候...</p>
</div>

<div th:unless="${loading}">
  <!-- 数据加载完成后显示 -->
  <table th:if="${not #lists.isEmpty(userList)}">
    <tr th:each="user : ${userList}">
      <td th:text="${user.name}">用户名</td>
    </tr>
  </table>
</div>
```

### 6.3 错误状态提示


```html
<!-- 后端传来错误信息 -->
<div th:if="${errorMsg}" class="error-alert">
  <span class="icon">⚠️</span>
  <span th:text="${errorMsg}">加载失败，请重试</span>
  <button onclick="location.reload()">重新加载</button>
</div>
```

### 6.4 多状态综合处理


```html
<!-- 统一的状态处理 -->
<div th:switch="${dataStatus}">
  <!-- 加载中 -->
  <div th:case="'loading'" class="state-loading">
    <div class="spinner"></div>
    <p>努力加载中...</p>
  </div>
  
  <!-- 加载成功 -->
  <div th:case="'success'">
    <table th:if="${not #lists.isEmpty(userList)}">
      <tr th:each="user : ${userList}">
        <td th:text="${user.name}">用户名</td>
      </tr>
    </table>
    <div th:if="${#lists.isEmpty(userList)}" class="empty">
      暂无数据
    </div>
  </div>
  
  <!-- 加载失败 -->
  <div th:case="'error'" class="state-error">
    <p>❌ 加载失败</p>
    <button onclick="retry()">重试</button>
  </div>
</div>
```

### 6.5 数据为null的处理


**常见问题**：对象为null时，直接取属性会报错

```html
<!-- ❌ 错误写法：user可能为null -->
<p th:text="${user.name}">姓名</p>

<!-- ✅ 正确写法1：先判断非null -->
<p th:if="${user != null}" th:text="${user.name}">姓名</p>

<!-- ✅ 正确写法2：使用Elvis运算符 -->
<p th:text="${user?.name} ?: '未知'">姓名</p>

<!-- ✅ 正确写法3：使用默认值 -->
<p th:text="${user?.name} ?: '暂无姓名'">姓名</p>
```

**安全取值链**：
```html
<!-- 多层对象嵌套 -->
<p th:text="${order?.user?.address?.city} ?: '未填写城市'">北京</p>
```

---

## 7. 📋 核心要点总结


### 7.1 必须掌握的核心知识


```
🔸 动态表格：th:each循环 + stat状态对象
🔸 列表展示：ul/ol/dl + 卡片式布局
🔸 分页处理：PageInfo对象 + 分页导航
🔸 排序功能：URL参数传递 + 排序图标
🔸 筛选条件：表单提交 + 条件标签展示
🔸 状态处理：空数据/加载中/错误提示
```

### 7.2 关键理解要点


**🔹 循环遍历的本质**
```
th:each="user : ${userList}"
↓ 相当于Java中
for(User user : userList) {
    // 渲染这个tr标签
}
```

**🔹 分页的核心逻辑**
```
总数据：1000条
每页显示：10条
总页数：1000 ÷ 10 = 100页

当前第5页：
  显示：第41-50条数据
  上一页：第4页
  下一页：第6页
```

**🔹 URL参数的保持**
```
用户操作流程：
搜索"张三" → /users?name=张三
点击第2页 → /users?name=张三&page=2
按年龄排序 → /users?name=张三&page=2&sort=age&order=asc

关键：每个链接都要带上已有的参数！
```

### 7.3 实际应用技巧


**💡 性能优化建议**
- 分页时设置合理的pageSize（10-50条）
- 筛选条件不要过多（3-5个足够）
- 排序字段要建立数据库索引

**💡 用户体验提升**
- 空数据时给出明确提示和操作建议
- 加载时显示加载动画
- 筛选后显示已选条件标签
- 支持清空筛选条件

**💡 常见错误避免**
- 遍历时忘记判断list是否为空 → `th:if="${not #lists.isEmpty(list)}"`
- 对象为null时直接取属性 → 使用`?.`安全导航
- 分页链接丢失筛选参数 → 所有链接都要带上已有参数
- stat变量名重复 → 嵌套循环要用不同的stat名称

### 7.4 完整示例对照


**需求**：用户列表 + 搜索 + 分页 + 排序

```html
<!-- 1. 搜索表单 -->
<form th:action="@{/users}" method="get">
  <input type="text" name="keyword" th:value="${param.keyword}">
  <button type="submit">搜索</button>
</form>

<!-- 2. 已选条件 -->
<div th:if="${not #strings.isEmpty(param.keyword)}">
  关键词：<strong th:text="${param.keyword}"></strong>
  <a th:href="@{/users}">×</a>
</div>

<!-- 3. 数据表格 -->
<table th:if="${not #lists.isEmpty(pageInfo.list)}">
  <thead>
    <tr>
      <th>序号</th>
      <th>
        <a th:href="@{/users(
             keyword=${param.keyword},
             sort='name',
             order=${sort=='name' && order=='asc' ? 'desc' : 'asc'}
           )}">
          姓名
          <span th:if="${sort=='name'}" 
                th:text="${order=='asc' ? '▲' : '▼'}"></span>
        </a>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr th:each="user, stat : ${pageInfo.list}">
      <td th:text="${stat.count}">1</td>
      <td th:text="${user.name}">张三</td>
    </tr>
  </tbody>
</table>

<!-- 4. 空数据提示 -->
<div th:if="${#lists.isEmpty(pageInfo.list)}" class="empty">
  😔 没有找到相关用户
</div>

<!-- 5. 分页导航 -->
<div class="pagination">
  <a th:if="${pageInfo.hasPreviousPage}"
     th:href="@{/users(
       page=${pageInfo.pageNum - 1},
       keyword=${param.keyword},
       sort=${sort},
       order=${order}
     )}">上一页</a>
  
  <a th:each="i : ${#numbers.sequence(1, pageInfo.pages)}"
     th:href="@{/users(
       page=${i},
       keyword=${param.keyword},
       sort=${sort},
       order=${order}
     )}"
     th:text="${i}"
     th:class="${i == pageInfo.pageNum ? 'active' : ''}">1</a>
  
  <a th:if="${pageInfo.hasNextPage}"
     th:href="@{/users(
       page=${pageInfo.pageNum + 1},
       keyword=${param.keyword},
       sort=${sort},
       order=${order}
     )}">下一页</a>
</div>
```

**核心记忆口诀**：
```
循环遍历用each，状态信息靠stat
分页数据配PageInfo，导航链接带参数
排序方向能切换，筛选条件要保持
空数据要提示，加载状态别忘记
安全取值用问号，判空处理是关键
```