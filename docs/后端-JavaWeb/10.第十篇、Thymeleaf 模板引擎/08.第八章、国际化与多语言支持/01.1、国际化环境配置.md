---
title: 1ã€å›½é™…åŒ–ç¯å¢ƒé…ç½®
---
## ğŸ“š ç›®å½•

1. [å›½é™…åŒ–åŸºç¡€æ¦‚å¿µ](#1-å›½é™…åŒ–åŸºç¡€æ¦‚å¿µ)
2. [MessageSourceæ¶ˆæ¯æºé…ç½®](#2-messagesourceæ¶ˆæ¯æºé…ç½®)
3. [æ¶ˆæ¯èµ„æºæ–‡ä»¶ç®¡ç†](#3-æ¶ˆæ¯èµ„æºæ–‡ä»¶ç®¡ç†)
4. [åŒºåŸŸè§£æå™¨é…ç½®](#4-åŒºåŸŸè§£æå™¨é…ç½®)
5. [è¯­è¨€åˆ‡æ¢å®ç°](#5-è¯­è¨€åˆ‡æ¢å®ç°)
6. [ç¼–ç ä¸ç¼“å­˜ä¼˜åŒ–](#6-ç¼–ç ä¸ç¼“å­˜ä¼˜åŒ–)
7. [å®æˆ˜åº”ç”¨æ¡ˆä¾‹](#7-å®æˆ˜åº”ç”¨æ¡ˆä¾‹)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ å›½é™…åŒ–åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯å›½é™…åŒ–ï¼ˆi18nï¼‰


**é€šä¿—ç†è§£**ï¼š
æƒ³è±¡ä½ å¼€å‘äº†ä¸€ä¸ªç”µå•†ç½‘ç«™ï¼Œä¸­å›½ç”¨æˆ·çœ‹åˆ°çš„æ˜¯"è´­ä¹°"æŒ‰é’®ï¼Œç¾å›½ç”¨æˆ·çœ‹åˆ°çš„æ˜¯"Buy"æŒ‰é’®ï¼Œæ—¥æœ¬ç”¨æˆ·çœ‹åˆ°çš„æ˜¯"è³¼å…¥"æŒ‰é’®ã€‚è¿™å°±æ˜¯å›½é™…åŒ–ï¼

```
åŒä¸€ä¸ªç½‘ç«™ï¼Œä¸åŒè¯­è¨€æ˜¾ç¤ºï¼š

ä¸­æ–‡ç•Œé¢ï¼š              è‹±æ–‡ç•Œé¢ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¬¢è¿ç™»å½•    â”‚        â”‚  Welcome     â”‚
â”‚  ç”¨æˆ·åï¼š    â”‚        â”‚  Username:   â”‚
â”‚  å¯†ç ï¼š      â”‚        â”‚  Password:   â”‚
â”‚  [ç™»å½•]      â”‚        â”‚  [Login]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
- **i18n**ï¼šinternationalizationçš„ç¼©å†™ï¼ˆiå’Œnä¹‹é—´æœ‰18ä¸ªå­—æ¯ï¼‰
- **ç›®çš„**ï¼šè®©åŒä¸€ä¸ªåº”ç”¨æ”¯æŒå¤šç§è¯­è¨€ï¼Œæ— éœ€ä¿®æ”¹ä»£ç 
- **åŸç†**ï¼šæ–‡å­—å†…å®¹ä¸ä»£ç åˆ†ç¦»ï¼Œæ ¹æ®ç”¨æˆ·è¯­è¨€åŠ¨æ€åŠ è½½å¯¹åº”æ–‡æœ¬

### 1.2 å›½é™…åŒ–ä¸‰è¦ç´ 


**ğŸ”¸ Localeï¼ˆåŒºåŸŸè®¾ç½®ï¼‰**
```
Locale = è¯­è¨€ + å›½å®¶/åœ°åŒº

zh_CN â†’ ä¸­æ–‡-ä¸­å›½ï¼ˆç®€ä½“ä¸­æ–‡ï¼‰
zh_TW â†’ ä¸­æ–‡-å°æ¹¾ï¼ˆç¹ä½“ä¸­æ–‡ï¼‰
en_US â†’ è‹±è¯­-ç¾å›½
en_GB â†’ è‹±è¯­-è‹±å›½
ja_JP â†’ æ—¥è¯­-æ—¥æœ¬
```

**ğŸ”¸ æ¶ˆæ¯èµ„æºæ–‡ä»¶**
```
å­˜æ”¾ä¸åŒè¯­è¨€çš„æ–‡æœ¬å†…å®¹ï¼š

messages_zh_CN.properties â†’ ä¸­æ–‡æ–‡æœ¬
messages_en_US.properties â†’ è‹±æ–‡æ–‡æœ¬
messages_ja_JP.properties â†’ æ—¥æ–‡æ–‡æœ¬
```

**ğŸ”¸ æ¶ˆæ¯è§£æå™¨**
```
æ ¹æ®ç”¨æˆ·çš„Localeï¼Œæ‰¾åˆ°å¯¹åº”çš„èµ„æºæ–‡ä»¶
æŠŠå ä½ç¬¦æ›¿æ¢æˆå®é™…æ–‡æœ¬
```

### 1.3 Spring Bootä¸­çš„å›½é™…åŒ–æµç¨‹


```
ç”¨æˆ·è®¿é—®
   â†“
è¯†åˆ«ç”¨æˆ·è¯­è¨€åå¥½ï¼ˆé€šè¿‡æµè§ˆå™¨/Session/Cookieç­‰ï¼‰
   â†“
è®¾ç½®å½“å‰Locale
   â†“
ä»å¯¹åº”çš„èµ„æºæ–‡ä»¶åŠ è½½æ–‡æœ¬
   â†“
æ¸²æŸ“åˆ°é¡µé¢
```

---

## 2. âš™ï¸ MessageSourceæ¶ˆæ¯æºé…ç½®


### 2.1 MessageSourceæ˜¯ä»€ä¹ˆ


**ç®€å•ç†è§£**ï¼š
MessageSourceå°±åƒä¸€ä¸ª"å¤šè¯­è¨€ç¿»è¯‘å™¨"ï¼Œä½ ç»™å®ƒä¸€ä¸ªkeyï¼ˆæ¯”å¦‚"login.welcome"ï¼‰ï¼Œå®ƒæ ¹æ®å½“å‰è¯­è¨€è¿”å›å¯¹åº”çš„æ–‡æœ¬ã€‚

```java
// ä½ è¿™æ ·ç”¨
messageSource.getMessage("login.welcome", null, locale);

// ä¸­æ–‡ç¯å¢ƒè¿”å›ï¼š"æ¬¢è¿ç™»å½•"
// è‹±æ–‡ç¯å¢ƒè¿”å›ï¼š"Welcome"
```

### 2.2 é…ç½®MessageSourceï¼ˆæ–¹å¼ä¸€ï¼šè‡ªåŠ¨é…ç½®ï¼‰


**application.ymlé…ç½®**ï¼š
```yaml
spring:
  messages:
    # èµ„æºæ–‡ä»¶åŸºç¡€åç§°ï¼ˆä¸å«è¯­è¨€åç¼€ï¼‰
    basename: i18n/messages
    # ç¼–ç æ ¼å¼
    encoding: UTF-8
    # ç¼“å­˜æ—¶é•¿ï¼ˆ-1è¡¨ç¤ºæ°¸ä¹…ç¼“å­˜ï¼Œå¼€å‘æ—¶è®¾ä¸º0ï¼‰
    cache-duration: -1
    # æ‰¾ä¸åˆ°æ¶ˆæ¯æ—¶æ˜¯å¦æŠ›å¼‚å¸¸
    fallback-to-system-locale: true
```

**ğŸ“ å¯¹åº”çš„æ–‡ä»¶ç»“æ„**ï¼š
```
resources/
  â””â”€â”€ i18n/
      â”œâ”€â”€ messages.properties           # é»˜è®¤è¯­è¨€ï¼ˆé€šå¸¸æ˜¯è‹±æ–‡ï¼‰
      â”œâ”€â”€ messages_zh_CN.properties     # ä¸­æ–‡
      â”œâ”€â”€ messages_en_US.properties     # è‹±æ–‡
      â””â”€â”€ messages_ja_JP.properties     # æ—¥æ–‡
```

### 2.3 é…ç½®MessageSourceï¼ˆæ–¹å¼äºŒï¼šæ‰‹åŠ¨é…ç½®ï¼‰


**ä»€ä¹ˆæ—¶å€™éœ€è¦æ‰‹åŠ¨é…ç½®ï¼Ÿ**
- éœ€è¦å¤šä¸ªæ¶ˆæ¯æºï¼ˆæ¯”å¦‚é”™è¯¯æ¶ˆæ¯ã€é‚®ä»¶æ¨¡æ¿åˆ†å¼€ï¼‰
- éœ€è¦è‡ªå®šä¹‰ç¼“å­˜ç­–ç•¥
- éœ€è¦ç‰¹æ®Šçš„æ¶ˆæ¯è§£æé€»è¾‘

**Javaé…ç½®ç±»**ï¼š
```java
@Configuration
public class I18nConfig {
    
    @Bean
    public MessageSource messageSource() {
        ResourceBundleMessageSource messageSource = 
            new ResourceBundleMessageSource();
        
        // è®¾ç½®èµ„æºæ–‡ä»¶åŸºç¡€å
        messageSource.setBasenames("i18n/messages", "i18n/errors");
        
        // è®¾ç½®ç¼–ç 
        messageSource.setDefaultEncoding("UTF-8");
        
        // è®¾ç½®ç¼“å­˜æ—¶é•¿ï¼ˆç§’ï¼‰
        messageSource.setCacheSeconds(3600);
        
        // æ‰¾ä¸åˆ°æ¶ˆæ¯æ—¶ä½¿ç”¨codeæœ¬èº«
        messageSource.setUseCodeAsDefaultMessage(true);
        
        return messageSource;
    }
}
```

**å¤šæ¶ˆæ¯æºç¤ºä¾‹**ï¼š
```
resources/
  â””â”€â”€ i18n/
      â”œâ”€â”€ messages_zh_CN.properties      # é€šç”¨æ¶ˆæ¯
      â”œâ”€â”€ messages_en_US.properties
      â”œâ”€â”€ errors_zh_CN.properties        # é”™è¯¯æ¶ˆæ¯
      â”œâ”€â”€ errors_en_US.properties
      â”œâ”€â”€ validation_zh_CN.properties    # éªŒè¯æ¶ˆæ¯
      â””â”€â”€ validation_en_US.properties
```

### 2.4 MessageSourceçš„ä¸‰ç§å®ç°


| å®ç°ç±» | **é€‚ç”¨åœºæ™¯** | **ç‰¹ç‚¹** |
|--------|------------|----------|
| `ResourceBundleMessageSource` | æ ‡å‡†é…ç½®æ–‡ä»¶ | ä½¿ç”¨JDKçš„ResourceBundleï¼Œæ€§èƒ½å¥½ |
| `ReloadableResourceBundleMessageSource` | æ”¯æŒçƒ­åŠ è½½ | å¯ä»¥åŠ¨æ€åˆ·æ–°ï¼Œé€‚åˆå¼€å‘ç¯å¢ƒ |
| `StaticMessageSource` | æµ‹è¯•åœºæ™¯ | ç¨‹åºä¸­ç›´æ¥æ·»åŠ æ¶ˆæ¯ï¼Œç”¨äºå•å…ƒæµ‹è¯• |

**å¯çƒ­åŠ è½½çš„é…ç½®**ï¼š
```java
@Bean
public ReloadableResourceBundleMessageSource messageSource() {
    ReloadableResourceBundleMessageSource source = 
        new ReloadableResourceBundleMessageSource();
    
    source.setBasename("classpath:i18n/messages");
    source.setDefaultEncoding("UTF-8");
    source.setCacheSeconds(10);  // 10ç§’åˆ·æ–°ä¸€æ¬¡
    
    return source;
}
```

---

## 3. ğŸ“„ æ¶ˆæ¯èµ„æºæ–‡ä»¶ç®¡ç†


### 3.1 èµ„æºæ–‡ä»¶å‘½åè§„åˆ™


**æ ‡å‡†å‘½åæ ¼å¼**ï¼š
```
basename_language_country.properties

ç¤ºä¾‹ï¼š
messages.properties          â†’ é»˜è®¤ï¼ˆfallbackï¼‰
messages_zh.properties       â†’ ä¸­æ–‡ï¼ˆæ‰€æœ‰ä¸­æ–‡åœ°åŒºï¼‰
messages_zh_CN.properties    â†’ ä¸­æ–‡-ä¸­å›½
messages_zh_TW.properties    â†’ ä¸­æ–‡-å°æ¹¾
messages_en.properties       â†’ è‹±æ–‡ï¼ˆæ‰€æœ‰è‹±æ–‡åœ°åŒºï¼‰
messages_en_US.properties    â†’ è‹±æ–‡-ç¾å›½
messages_en_GB.properties    â†’ è‹±æ–‡-è‹±å›½
```

**æŸ¥æ‰¾ä¼˜å…ˆçº§**ï¼š
```
è¯·æ±‚ï¼šzh_CNï¼ˆä¸­æ–‡-ä¸­å›½ï¼‰

æŸ¥æ‰¾é¡ºåºï¼š
messages_zh_CN.properties  â† ä¼˜å…ˆ
     â†“ï¼ˆæ‰¾ä¸åˆ°ï¼‰
messages_zh.properties     â† æ¬¡ä¹‹
     â†“ï¼ˆæ‰¾ä¸åˆ°ï¼‰
messages.properties        â† é»˜è®¤
```

### 3.2 èµ„æºæ–‡ä»¶å†…å®¹ç¼–å†™


**messages_zh_CN.properties**ï¼š
```properties
# ç™»å½•é¡µé¢
login.title=ç”¨æˆ·ç™»å½•
login.username=ç”¨æˆ·å
login.password=å¯†ç 
login.remember=è®°ä½æˆ‘
login.submit=ç™»å½•
login.welcome=æ¬¢è¿ï¼Œ{0}ï¼

# æŒ‰é’®
btn.save=ä¿å­˜
btn.cancel=å–æ¶ˆ
btn.delete=åˆ é™¤
btn.edit=ç¼–è¾‘

# éªŒè¯æ¶ˆæ¯
validation.required={0}ä¸èƒ½ä¸ºç©º
validation.email.invalid=è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€
validation.password.length=å¯†ç é•¿åº¦å¿…é¡»åœ¨{0}åˆ°{1}ä¹‹é—´

# é”™è¯¯æ¶ˆæ¯
error.404=é¡µé¢æœªæ‰¾åˆ°
error.500=æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
error.network=ç½‘ç»œè¿æ¥å¤±è´¥
```

**messages_en_US.properties**ï¼š
```properties
# Login page
login.title=User Login
login.username=Username
login.password=Password
login.remember=Remember Me
login.submit=Login
login.welcome=Welcome, {0}!

# Buttons
btn.save=Save
btn.cancel=Cancel
btn.delete=Delete
btn.edit=Edit

# Validation messages
validation.required={0} is required
validation.email.invalid=Please enter a valid email address
validation.password.length=Password length must be between {0} and {1}

# Error messages
error.404=Page Not Found
error.500=Internal Server Error
error.network=Network Connection Failed
```

### 3.3 å ä½ç¬¦ä½¿ç”¨æŠ€å·§


**ğŸ”¸ ç®€å•å ä½ç¬¦**ï¼š
```properties
# å•ä¸ªå‚æ•°
welcome.message=æ¬¢è¿ï¼Œ{0}ï¼
# ä½¿ç”¨ï¼šmessageSource.getMessage("welcome.message", new Object[]{"å¼ ä¸‰"}, locale)
# ç»“æœï¼šæ¬¢è¿ï¼Œå¼ ä¸‰ï¼

# å¤šä¸ªå‚æ•°
user.info=ç”¨æˆ·{0}ï¼Œå¹´é¾„{1}ï¼Œæ¥è‡ª{2}
# ä½¿ç”¨ï¼šmessageSource.getMessage("user.info", new Object[]{"æå››", 25, "åŒ—äº¬"}, locale)
# ç»“æœï¼šç”¨æˆ·æå››ï¼Œå¹´é¾„25ï¼Œæ¥è‡ªåŒ—äº¬
```

**ğŸ”¸ å‘½åå ä½ç¬¦ï¼ˆæ‰©å±•ï¼‰**ï¼š
```properties
# ä½¿ç”¨MessageFormat
order.summary=è®¢å•å·ï¼š{0}ï¼Œé‡‘é¢ï¼š{1, number, currency}ï¼Œæ—¶é—´ï¼š{2, date, long}

# ç»“æœç¤ºä¾‹ï¼š
# è®¢å•å·ï¼š20231215001ï¼Œé‡‘é¢ï¼šÂ¥199.00ï¼Œæ—¶é—´ï¼š2023å¹´12æœˆ15æ—¥
```

### 3.4 èµ„æºæ–‡ä»¶ç»„ç»‡æœ€ä½³å®è·µ


**æŒ‰æ¨¡å—æ‹†åˆ†**ï¼š
```
i18n/
  â”œâ”€â”€ common/              # é€šç”¨æ¶ˆæ¯
  â”‚   â”œâ”€â”€ messages_zh_CN.properties
  â”‚   â””â”€â”€ messages_en_US.properties
  â”œâ”€â”€ user/                # ç”¨æˆ·æ¨¡å—
  â”‚   â”œâ”€â”€ user_zh_CN.properties
  â”‚   â””â”€â”€ user_en_US.properties
  â”œâ”€â”€ order/               # è®¢å•æ¨¡å—
  â”‚   â”œâ”€â”€ order_zh_CN.properties
  â”‚   â””â”€â”€ order_en_US.properties
  â””â”€â”€ validation/          # éªŒè¯æ¶ˆæ¯
      â”œâ”€â”€ validation_zh_CN.properties
      â””â”€â”€ validation_en_US.properties
```

**é…ç½®å¤šä¸ªbasename**ï¼š
```java
messageSource.setBasenames(
    "i18n/common/messages",
    "i18n/user/user",
    "i18n/order/order",
    "i18n/validation/validation"
);
```

---

## 4. ğŸ”§ åŒºåŸŸè§£æå™¨é…ç½®


### 4.1 åŒºåŸŸè§£æå™¨æ˜¯ä»€ä¹ˆ


**é€šä¿—ç†è§£**ï¼š
åŒºåŸŸè§£æå™¨å°±åƒä¸€ä¸ª"ä¾¦æ¢"ï¼Œå®ƒè´Ÿè´£åˆ¤æ–­ç”¨æˆ·æƒ³è¦å“ªç§è¯­è¨€ã€‚åˆ¤æ–­ä¾æ®å¯ä»¥æ˜¯ï¼š
- æµè§ˆå™¨è®¾ç½®çš„è¯­è¨€
- URLä¸­çš„è¯­è¨€å‚æ•°
- Sessionä¸­ä¿å­˜çš„è¯­è¨€
- Cookieä¸­è®°ä½çš„è¯­è¨€

### 4.2 å››ç§å¸¸ç”¨è§£æå™¨


**ğŸ”¸ AcceptHeaderLocaleResolverï¼ˆé»˜è®¤ï¼‰**
```
å·¥ä½œåŸç†ï¼šè¯»å–æµè§ˆå™¨çš„Accept-Languageè¯·æ±‚å¤´

æµè§ˆå™¨è®¾ç½®ï¼šä¸­æ–‡
    â†“
Accept-Language: zh-CN,zh;q=0.9
    â†“
ä½¿ç”¨ä¸­æ–‡èµ„æºæ–‡ä»¶

ä¼˜ç‚¹ï¼šæ— éœ€é¢å¤–é…ç½®
ç¼ºç‚¹ï¼šç”¨æˆ·æ— æ³•åœ¨ç½‘ç«™ä¸Šåˆ‡æ¢è¯­è¨€
```

**é…ç½®æ–¹å¼**ï¼š
```java
@Bean
public LocaleResolver localeResolver() {
    AcceptHeaderLocaleResolver resolver = new AcceptHeaderLocaleResolver();
    resolver.setDefaultLocale(Locale.SIMPLIFIED_CHINESE);  // é»˜è®¤ä¸­æ–‡
    return resolver;
}
```

**ğŸ”¸ SessionLocaleResolverï¼ˆæ¨èï¼‰**
```
å·¥ä½œåŸç†ï¼šè¯­è¨€åå¥½ä¿å­˜åœ¨Sessionä¸­

ç”¨æˆ·é€‰æ‹©è¯­è¨€
    â†“
ä¿å­˜åˆ°Session
    â†“
æ¯æ¬¡è¯·æ±‚ä»Sessionè¯»å–
    â†“
Sessionè¿‡æœŸåé‡ç½®

ä¼˜ç‚¹ï¼šç”¨æˆ·å¯ä»¥åˆ‡æ¢è¯­è¨€
ç¼ºç‚¹ï¼šSessionè¿‡æœŸåéœ€é‡æ–°é€‰æ‹©
```

**é…ç½®æ–¹å¼**ï¼š
```java
@Bean
public LocaleResolver localeResolver() {
    SessionLocaleResolver resolver = new SessionLocaleResolver();
    // è®¾ç½®é»˜è®¤è¯­è¨€
    resolver.setDefaultLocale(Locale.SIMPLIFIED_CHINESE);
    return resolver;
}
```

**ğŸ”¸ CookieLocaleResolver**
```
å·¥ä½œåŸç†ï¼šè¯­è¨€åå¥½ä¿å­˜åœ¨Cookieä¸­

ç”¨æˆ·é€‰æ‹©è¯­è¨€
    â†“
ä¿å­˜åˆ°Cookie
    â†“
ä¸‹æ¬¡è®¿é—®è‡ªåŠ¨è¯»å–
    â†“
æŒä¹…åŒ–ä¿å­˜ï¼ˆå¯è®¾ç½®è¿‡æœŸæ—¶é—´ï¼‰

ä¼˜ç‚¹ï¼šå…³é—­æµè§ˆå™¨åä¾ç„¶è®°ä½
ç¼ºç‚¹ï¼šç”¨æˆ·æ¸…é™¤Cookieåéœ€é‡æ–°é€‰æ‹©
```

**é…ç½®æ–¹å¼**ï¼š
```java
@Bean
public LocaleResolver localeResolver() {
    CookieLocaleResolver resolver = new CookieLocaleResolver();
    resolver.setDefaultLocale(Locale.SIMPLIFIED_CHINESE);
    resolver.setCookieName("language");  // Cookieåç§°
    resolver.setCookieMaxAge(3600 * 24 * 30);  // 30å¤©
    return resolver;
}
```

**ğŸ”¸ FixedLocaleResolver**
```
å·¥ä½œåŸç†ï¼šå›ºå®šä½¿ç”¨æŸç§è¯­è¨€ï¼Œä¸å…è®¸åˆ‡æ¢

é€‚ç”¨åœºæ™¯ï¼š
- å•ä¸€è¯­è¨€ç½‘ç«™
- å†…éƒ¨ç®¡ç†ç³»ç»Ÿ
- æµ‹è¯•ç¯å¢ƒ
```

**é…ç½®æ–¹å¼**ï¼š
```java
@Bean
public LocaleResolver localeResolver() {
    FixedLocaleResolver resolver = new FixedLocaleResolver();
    resolver.setDefaultLocale(Locale.SIMPLIFIED_CHINESE);
    return resolver;
}
```

### 4.3 è§£æå™¨å¯¹æ¯”é€‰æ‹©


| è§£æå™¨ | **æŒä¹…æ€§** | **å¯åˆ‡æ¢** | **é€‚ç”¨åœºæ™¯** |
|--------|----------|----------|------------|
| `AcceptHeaderLocaleResolver` | æ¯æ¬¡è¯·æ±‚ | âŒ | ç®€å•åœºæ™¯ï¼Œä¸éœ€åˆ‡æ¢ |
| `SessionLocaleResolver` | SessionæœŸé—´ | âœ… | ä¸€èˆ¬Webåº”ç”¨ |
| `CookieLocaleResolver` | Cookieæœ‰æ•ˆæœŸ | âœ… | éœ€è¦é•¿æœŸè®°ä½è¯­è¨€ |
| `FixedLocaleResolver` | æ°¸ä¹…å›ºå®š | âŒ | å•è¯­è¨€ç³»ç»Ÿ |

---

## 5. ğŸ”„ è¯­è¨€åˆ‡æ¢å®ç°


### 5.1 æ·»åŠ è¯­è¨€åˆ‡æ¢æ‹¦æˆªå™¨


**æ‹¦æˆªå™¨é…ç½®**ï¼š
```java
@Configuration
public class WebMvcConfig implements WebMvcConfigurer {
    
    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        // æ·»åŠ è¯­è¨€åˆ‡æ¢æ‹¦æˆªå™¨
        LocaleChangeInterceptor interceptor = new LocaleChangeInterceptor();
        interceptor.setParamName("lang");  // URLå‚æ•°å
        registry.addInterceptor(interceptor);
    }
    
    @Bean
    public LocaleResolver localeResolver() {
        SessionLocaleResolver resolver = new SessionLocaleResolver();
        resolver.setDefaultLocale(Locale.SIMPLIFIED_CHINESE);
        return resolver;
    }
}
```

**å·¥ä½œåŸç†**ï¼š
```
ç”¨æˆ·ç‚¹å‡»"English"é“¾æ¥
    â†“
URL: /index?lang=en_US
    â†“
æ‹¦æˆªå™¨æ•è·langå‚æ•°
    â†“
è®¾ç½®Localeä¸ºen_US
    â†“
ä¿å­˜åˆ°Sessionï¼ˆæˆ–Cookieï¼‰
    â†“
é¡µé¢åˆ·æ–°ä¸ºè‹±æ–‡
```

### 5.2 é¡µé¢åˆ‡æ¢å®ç°


**HTMLè¯­è¨€åˆ‡æ¢èœå•**ï¼š
```html
<!-- è¯­è¨€åˆ‡æ¢ä¸‹æ‹‰èœå• -->
<div class="language-selector">
    <select id="langSelect" onchange="changeLanguage(this.value)">
        <option value="zh_CN" th:selected="${#locale.language == 'zh'}">
            ğŸ‡¨ğŸ‡³ ç®€ä½“ä¸­æ–‡
        </option>
        <option value="en_US" th:selected="${#locale.language == 'en'}">
            ğŸ‡ºğŸ‡¸ English
        </option>
        <option value="ja_JP" th:selected="${#locale.language == 'ja'}">
            ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª
        </option>
    </select>
</div>

<script>
function changeLanguage(lang) {
    // ä¿æŒå½“å‰é¡µé¢ï¼Œåªæ”¹å˜langå‚æ•°
    let currentUrl = new URL(window.location.href);
    currentUrl.searchParams.set('lang', lang);
    window.location.href = currentUrl.toString();
}
</script>
```

**é“¾æ¥æ–¹å¼åˆ‡æ¢**ï¼š
```html
<!-- é¡¶éƒ¨è¯­è¨€åˆ‡æ¢é“¾æ¥ -->
<div class="lang-switch">
    <a th:href="@{''(lang='zh_CN')}" 
       th:classappend="${#locale.language == 'zh'} ? 'active' : ''">
        ä¸­æ–‡
    </a>
    <span>|</span>
    <a th:href="@{''(lang='en_US')}"
       th:classappend="${#locale.language == 'en'} ? 'active' : ''">
        English
    </a>
    <span>|</span>
    <a th:href="@{''(lang='ja_JP')}"
       th:classappend="${#locale.language == 'ja'} ? 'active' : ''">
        æ—¥æœ¬èª
    </a>
</div>
```

### 5.3 Controllerä¸­æ‰‹åŠ¨åˆ‡æ¢


**Javaä»£ç åˆ‡æ¢è¯­è¨€**ï¼š
```java
@Controller
public class LanguageController {
    
    @Autowired
    private LocaleResolver localeResolver;
    
    @GetMapping("/changeLanguage")
    public String changeLanguage(
            @RequestParam String lang,
            HttpServletRequest request,
            HttpServletResponse response) {
        
        // è§£æè¯­è¨€å‚æ•°
        Locale locale = Locale.forLanguageTag(lang.replace("_", "-"));
        
        // è®¾ç½®Locale
        localeResolver.setLocale(request, response, locale);
        
        // é‡å®šå‘åˆ°ä¹‹å‰çš„é¡µé¢
        String referer = request.getHeader("Referer");
        return "redirect:" + (referer != null ? referer : "/");
    }
}
```

---

## 6. ğŸ” ç¼–ç ä¸ç¼“å­˜ä¼˜åŒ–


### 6.1 ç¼–ç æ ¼å¼é…ç½®


**ä¸ºä»€ä¹ˆè¦è®¾ç½®ç¼–ç ï¼Ÿ**
```
é—®é¢˜åœºæ™¯ï¼š
resourcesæ–‡ä»¶é»˜è®¤ä½¿ç”¨ISO-8859-1ç¼–ç 
ä¸­æ–‡ä¼šæ˜¾ç¤ºä¸ºä¹±ç ï¼š
login.welcome=æ¬¢è¿ â†’ login.welcome=\u6b22\u8fce

è§£å†³æ–¹æ¡ˆï¼š
è®¾ç½®UTF-8ç¼–ç 
```

**application.ymlé…ç½®**ï¼š
```yaml
spring:
  messages:
    encoding: UTF-8
```

**IDEAè‡ªåŠ¨è½¬æ¢è®¾ç½®**ï¼š
```
Settings â†’ File Encodings
  â†’ Default encoding for properties files: UTF-8
  â†’ âœ… Transparent native-to-ascii conversion
```

**native2asciiå·¥å…·ï¼ˆä¸æ¨èï¼‰**ï¼š
```bash
# æ‰‹åŠ¨è½¬æ¢ï¼ˆå·²è¿‡æ—¶ï¼‰
native2ascii -encoding UTF-8 messages_zh_CN.properties messages_zh_CN_encoded.properties
```

### 6.2 ç¼“å­˜ç­–ç•¥é…ç½®


**å¼€å‘ç¯å¢ƒï¼ˆå…³é—­ç¼“å­˜ï¼‰**ï¼š
```yaml
spring:
  messages:
    cache-duration: 0  # æ¯æ¬¡éƒ½é‡æ–°åŠ è½½
```

```java
// æˆ–è€…ä»£ç é…ç½®
@Bean
@Profile("dev")
public ReloadableResourceBundleMessageSource messageSource() {
    ReloadableResourceBundleMessageSource source = 
        new ReloadableResourceBundleMessageSource();
    source.setBasename("classpath:i18n/messages");
    source.setDefaultEncoding("UTF-8");
    source.setCacheSeconds(0);  // å¼€å‘ç¯å¢ƒä¸ç¼“å­˜
    return source;
}
```

**ç”Ÿäº§ç¯å¢ƒï¼ˆå¯ç”¨ç¼“å­˜ï¼‰**ï¼š
```yaml
spring:
  messages:
    cache-duration: 3600  # ç¼“å­˜1å°æ—¶
```

```java
@Bean
@Profile("prod")
public ResourceBundleMessageSource messageSource() {
    ResourceBundleMessageSource source = 
        new ResourceBundleMessageSource();
    source.setBasename("i18n/messages");
    source.setDefaultEncoding("UTF-8");
    source.setCacheSeconds(3600);  // ç”Ÿäº§ç¯å¢ƒç¼“å­˜
    return source;
}
```

**ç¼“å­˜åˆ·æ–°æœºåˆ¶**ï¼š
```java
@RestController
@RequestMapping("/admin")
public class CacheController {
    
    @Autowired
    private ReloadableResourceBundleMessageSource messageSource;
    
    @PostMapping("/clearCache")
    public String clearMessageCache() {
        messageSource.clearCache();
        return "æ¶ˆæ¯ç¼“å­˜å·²æ¸…é™¤";
    }
}
```

---

## 7. ğŸ’¡ å®æˆ˜åº”ç”¨æ¡ˆä¾‹


### 7.1 å®Œæ•´ç™»å½•é¡µé¢å›½é™…åŒ–


**login.html**ï¼š
```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="#{login.title}">ç™»å½•</title>
</head>
<body>
    <!-- è¯­è¨€åˆ‡æ¢ -->
    <div class="lang-switch">
        <a th:href="@{/login(lang='zh_CN')}">ä¸­æ–‡</a> |
        <a th:href="@{/login(lang='en_US')}">English</a>
    </div>
    
    <!-- ç™»å½•è¡¨å• -->
    <form th:action="@{/login}" method="post">
        <h2 th:text="#{login.title}">ç”¨æˆ·ç™»å½•</h2>
        
        <div>
            <label th:text="#{login.username}">ç”¨æˆ·åï¼š</label>
            <input type="text" name="username" 
                   th:placeholder="#{login.username.placeholder}"/>
        </div>
        
        <div>
            <label th:text="#{login.password}">å¯†ç ï¼š</label>
            <input type="password" name="password"
                   th:placeholder="#{login.password.placeholder}"/>
        </div>
        
        <div>
            <label>
                <input type="checkbox" name="remember"/>
                <span th:text="#{login.remember}">è®°ä½æˆ‘</span>
            </label>
        </div>
        
        <button type="submit" th:text="#{login.submit}">ç™»å½•</button>
        
        <!-- é”™è¯¯æ¶ˆæ¯ -->
        <p th:if="${error}" th:text="#{${error}}" class="error"></p>
    </form>
</body>
</html>
```

**èµ„æºæ–‡ä»¶**ï¼š
```properties
# messages_zh_CN.properties
login.title=ç”¨æˆ·ç™»å½•
login.username=ç”¨æˆ·å
login.password=å¯†ç 
login.username.placeholder=è¯·è¾“å…¥ç”¨æˆ·å
login.password.placeholder=è¯·è¾“å…¥å¯†ç 
login.remember=è®°ä½æˆ‘
login.submit=ç™»å½•
login.error.invalid=ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯

# messages_en_US.properties
login.title=User Login
login.username=Username
login.password=Password
login.username.placeholder=Please enter username
login.password.placeholder=Please enter password
login.remember=Remember Me
login.submit=Login
login.error.invalid=Invalid username or password
```

### 7.2 è¡¨å•éªŒè¯æ¶ˆæ¯å›½é™…åŒ–


**Userå®ä½“**ï¼š
```java
public class User {
    
    @NotBlank(message = "{validation.username.required}")
    @Size(min = 3, max = 20, message = "{validation.username.length}")
    private String username;
    
    @NotBlank(message = "{validation.password.required}")
    @Pattern(regexp = "^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d]{8,}$",
             message = "{validation.password.pattern}")
    private String password;
    
    @Email(message = "{validation.email.invalid}")
    private String email;
}
```

**éªŒè¯æ¶ˆæ¯æ–‡ä»¶**ï¼š
```properties
# validation_zh_CN.properties
validation.username.required=ç”¨æˆ·åä¸èƒ½ä¸ºç©º
validation.username.length=ç”¨æˆ·åé•¿åº¦å¿…é¡»åœ¨3åˆ°20ä¹‹é—´
validation.password.required=å¯†ç ä¸èƒ½ä¸ºç©º
validation.password.pattern=å¯†ç å¿…é¡»åŒ…å«å­—æ¯å’Œæ•°å­—ï¼Œè‡³å°‘8ä½
validation.email.invalid=é‚®ç®±æ ¼å¼ä¸æ­£ç¡®

# validation_en_US.properties
validation.username.required=Username is required
validation.username.length=Username length must be between 3 and 20
validation.password.required=Password is required
validation.password.pattern=Password must contain letters and numbers, at least 8 characters
validation.email.invalid=Invalid email format
```

### 7.3 åŠ¨æ€å‚æ•°æ¶ˆæ¯


**Controller**ï¼š
```java
@Controller
public class UserController {
    
    @Autowired
    private MessageSource messageSource;
    
    @GetMapping("/user/{id}")
    public String showUser(@PathVariable Long id, Model model, Locale locale) {
        User user = userService.getById(id);
        
        // ä½¿ç”¨å¸¦å‚æ•°çš„æ¶ˆæ¯
        String welcomeMsg = messageSource.getMessage(
            "user.welcome", 
            new Object[]{user.getName()}, 
            locale
        );
        
        model.addAttribute("welcomeMsg", welcomeMsg);
        model.addAttribute("user", user);
        return "user/detail";
    }
}
```

**Thymeleafä¸­ä½¿ç”¨**ï¼š
```html
<!-- æ–¹å¼1ï¼šé€šè¿‡Controllerä¼ é€’ -->
<h2 th:text="${welcomeMsg}"></h2>

<!-- æ–¹å¼2ï¼šç›´æ¥åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ -->
<h2 th:text="#{user.welcome(${user.name})}"></h2>

<!-- æ–¹å¼3ï¼šå¤šä¸ªå‚æ•° -->
<p th:text="#{user.info(${user.name}, ${user.age}, ${user.city})}"></p>
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å›½é™…åŒ–é…ç½®æ£€æŸ¥æ¸…å•


> âœ… **å¿…é¡»é…ç½®çš„å†…å®¹**

**1. MessageSourceé…ç½®**
```yaml
spring:
  messages:
    basename: i18n/messages
    encoding: UTF-8
    cache-duration: 3600
```

**2. LocaleResolveré€‰æ‹©**
```java
// æ¨èï¼šSessionLocaleResolver
@Bean
public LocaleResolver localeResolver() {
    SessionLocaleResolver resolver = new SessionLocaleResolver();
    resolver.setDefaultLocale(Locale.SIMPLIFIED_CHINESE);
    return resolver;
}
```

**3. è¯­è¨€åˆ‡æ¢æ‹¦æˆªå™¨**
```java
@Override
public void addInterceptors(InterceptorRegistry registry) {
    LocaleChangeInterceptor interceptor = new LocaleChangeInterceptor();
    interceptor.setParamName("lang");
    registry.addInterceptor(interceptor);
}
```

### 8.2 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


**â“ ä¸­æ–‡ä¹±ç é—®é¢˜**
```
åŸå› ï¼špropertiesæ–‡ä»¶ç¼–ç ä¸æ˜¯UTF-8
è§£å†³ï¼š
1. è®¾ç½®spring.messages.encoding=UTF-8
2. IDEAè®¾ç½®é€æ˜è½¬æ¢
3. æ–‡ä»¶ä¿å­˜ä¸ºUTF-8æ ¼å¼
```

**â“ è¯­è¨€åˆ‡æ¢ä¸ç”Ÿæ•ˆ**
```
åŸå› ï¼šæ²¡æœ‰é…ç½®LocaleChangeInterceptor
è§£å†³ï¼šæ·»åŠ æ‹¦æˆªå™¨å¹¶è®¾ç½®å‚æ•°å
```

**â“ æ¶ˆæ¯æ‰¾ä¸åˆ°æ˜¾ç¤º??key??**
```
åŸå› ï¼š
1. èµ„æºæ–‡ä»¶è·¯å¾„é”™è¯¯
2. keyæ‹¼å†™é”™è¯¯
3. ç¼“å­˜æœªåˆ·æ–°

è§£å†³ï¼š
1. æ£€æŸ¥basenameé…ç½®
2. æ ¸å¯¹keyåç§°
3. å¼€å‘ç¯å¢ƒå…³é—­ç¼“å­˜
```

**â“ é»˜è®¤è¯­è¨€ä¸ç”Ÿæ•ˆ**
```
åŸå› ï¼šLocaleResolveré»˜è®¤è¯­è¨€è®¾ç½®é”™è¯¯
è§£å†³ï¼š
resolver.setDefaultLocale(Locale.SIMPLIFIED_CHINESE);
```

### 8.3 æœ€ä½³å®è·µå»ºè®®


**ğŸ”¸ èµ„æºæ–‡ä»¶ç»„ç»‡**
- æŒ‰æ¨¡å—æ‹†åˆ†èµ„æºæ–‡ä»¶
- ä½¿ç”¨æœ‰æ„ä¹‰çš„keyå‘½åï¼ˆå¦‚ï¼š`module.page.element`ï¼‰
- ä¿æŒå„è¯­è¨€æ–‡ä»¶çš„keyä¸€è‡´

**ğŸ”¸ æ€§èƒ½ä¼˜åŒ–**
- ç”Ÿäº§ç¯å¢ƒå¯ç”¨ç¼“å­˜
- å¼€å‘ç¯å¢ƒå…³é—­ç¼“å­˜æˆ–è®¾ç½®çŸ­æ—¶ç¼“å­˜
- åˆç†è®¾ç½®æ¶ˆæ¯æºçš„æ•°é‡

**ğŸ”¸ ç”¨æˆ·ä½“éªŒ**
- æä¾›æ˜æ˜¾çš„è¯­è¨€åˆ‡æ¢å…¥å£
- è®°ä½ç”¨æˆ·çš„è¯­è¨€åå¥½
- æä¾›é»˜è®¤è¯­è¨€fallback

**ğŸ”¸ å¼€å‘è§„èŒƒ**
- æ‰€æœ‰æ–‡æœ¬éƒ½é€šè¿‡æ¶ˆæ¯æºè·å–ï¼Œä¸ç¡¬ç¼–ç 
- éªŒè¯æ¶ˆæ¯ç»Ÿä¸€ç®¡ç†
- ä¿æŒèµ„æºæ–‡ä»¶çš„å®Œæ•´æ€§ï¼ˆæ‰€æœ‰è¯­è¨€éƒ½è¦æœ‰å¯¹åº”keyï¼‰

### 8.4 å¿«é€Ÿè®°å¿†è¦ç‚¹


> ğŸ§  **å›½é™…åŒ–ä¸‰æ­¥èµ°**

```
1ï¸âƒ£ é…ç½®MessageSource
   â””â†’ æŒ‡å®šèµ„æºæ–‡ä»¶ä½ç½®å’Œç¼–ç 

2ï¸âƒ£ é…ç½®LocaleResolver  
   â””â†’ å†³å®šå¦‚ä½•è¯†åˆ«ç”¨æˆ·è¯­è¨€

3ï¸âƒ£ æ·»åŠ åˆ‡æ¢æ‹¦æˆªå™¨
   â””â†’ è®©ç”¨æˆ·å¯ä»¥åˆ‡æ¢è¯­è¨€
```

> ğŸ“ **èµ„æºæ–‡ä»¶è§„åˆ™**

```
å‘½åæ ¼å¼ï¼šbasename_language_country.properties
æŸ¥æ‰¾é¡ºåºï¼šç²¾ç¡®åŒ¹é… â†’ è¯­è¨€åŒ¹é… â†’ é»˜è®¤æ–‡ä»¶
ç¼–ç è¦æ±‚ï¼šUTF-8ï¼ˆé¿å…ä¹±ç ï¼‰
```

> ğŸ¯ **Thymeleafä½¿ç”¨**

```html
<!-- ç®€å•æ¶ˆæ¯ -->
<p th:text="#{message.key}"></p>

<!-- å¸¦å‚æ•° -->
<p th:text="#{message.key(${param})}"></p>

<!-- å½“å‰è¯­è¨€ -->
<span th:text="${#locale.language}"></span>
```

**æ ¸å¿ƒè®°ä½**ï¼šå›½é™…åŒ–å°±æ˜¯è®©ä¸€å¥—ä»£ç æ”¯æŒå¤šç§è¯­è¨€ï¼Œé€šè¿‡é…ç½®æ–‡ä»¶ç®¡ç†ä¸åŒè¯­è¨€çš„æ–‡æœ¬ï¼Œæ ¹æ®ç”¨æˆ·åå¥½åŠ¨æ€åˆ‡æ¢æ˜¾ç¤ºå†…å®¹ï¼