---
title: 3、条件渲染与逻辑控制
---
## 📚 目录

1. [什么是条件渲染](#1-什么是条件渲染)
2. [th:if条件判断](#2-th-if条件判断)
3. [th:unless反向判断](#3-th-unless反向判断)
4. [th:switch分支选择](#4-th-switch分支选择)
5. [逻辑运算符详解](#5-逻辑运算符详解)
6. [比较运算符使用](#6-比较运算符使用)
7. [条件表达式组合](#7-条件表达式组合)
8. [实战应用场景](#8-实战应用场景)
9. [核心要点总结](#9-核心要点总结)

---

## 1. 🎯 什么是条件渲染


### 1.1 基本概念


**条件渲染**是什么意思？简单说就是**根据某个条件来决定是否显示页面内容**。

🌰 **生活中的例子**：
```
就像你去餐厅点餐：
- 如果你是VIP会员 → 显示会员专享菜单
- 如果你不是会员 → 只显示普通菜单

这就是条件渲染的思想！
```

### 1.2 为什么需要条件渲染


**🔸 实际开发场景**：

| 场景 | **需求** | **解决方案** |
|------|---------|-------------|
| 🔐 **用户权限** | `管理员看到更多功能` | `根据角色显示不同内容` |
| 📊 **数据状态** | `有数据显示列表，无数据显示提示` | `条件判断数据是否存在` |
| 💰 **会员系统** | `VIP显示特权，普通用户隐藏` | `根据会员等级控制显示` |
| 🎨 **主题切换** | `白天/夜间模式不同样式` | `条件判断当前主题` |

### 1.3 Thymeleaf的条件控制工具箱


```
Thymeleaf提供了4个核心工具：

┌─────────────────────────────────────┐
│   th:if      → 条件为真时显示        │
│   th:unless  → 条件为假时显示        │
│   th:switch  → 多分支选择            │
│   th:case    → 分支条件（配合switch）│
└─────────────────────────────────────┘
```

---

## 2. ✅ th:if条件判断


### 2.1 基本用法


**th:if** 的意思是："如果条件成立，就显示这个元素"

**🔸 基本语法**：
```html
<标签 th:if="条件表达式">内容</标签>
```

**💡 简单示例**：
```html
<!-- 如果用户已登录，显示欢迎信息 -->
<div th:if="${user != null}">
    欢迎回来，<span th:text="${user.name}">用户</span>！
</div>

<!-- 如果分数大于60，显示及格提示 -->
<p th:if="${score >= 60}">恭喜你，考试及格了！</p>
```

### 2.2 条件判断的"真"与"假"


**🤔 什么情况算"真"，什么算"假"？**

**✅ 这些情况被认为是"真"**：
```
• 布尔值 true
• 数字不为 0
• 字符不为 '0'
• 字符串不为 "false"、"off" 或 "no"
• 对象不为 null
```

**❌ 这些情况被认为是"假"**：
```
• 布尔值 false
• 数字 0
• 字符 '0'
• 字符串 "false"、"off"、"no"
• null 值
```

**🔍 实例对比**：
```html
<!-- 这些都会显示 -->
<p th:if="${true}">显示✓</p>
<p th:if="${1}">显示✓</p>
<p th:if="${'yes'}">显示✓</p>

<!-- 这些都不显示 -->
<p th:if="${false}">不显示✗</p>
<p th:if="${0}">不显示✗</p>
<p th:if="${null}">不显示✗</p>
```

### 2.3 常见判断场景


**🔸 判断对象是否存在**：
```html
<!-- 检查用户对象是否为null -->
<div th:if="${user != null}">
    用户信息：<span th:text="${user.email}"></span>
</div>
```

**🔸 判断集合是否为空**：
```html
<!-- 检查列表是否有数据 -->
<div th:if="${!products.isEmpty()}">
    <p>共找到 <span th:text="${products.size()}"></span> 个商品</p>
</div>
```

**🔸 判断字符串内容**：
```html
<!-- 检查状态值 -->
<span th:if="${status == 'success'}" class="badge-success">成功</span>
```

---

## 3. 🔄 th:unless反向判断


### 3.1 什么是反向判断


**th:unless** 的意思是："如果条件**不**成立，就显示这个元素"

💡 **理解要点**：`th:unless` 等于 `th:if` 的相反逻辑

```
th:if="${condition}"     → 条件为真时显示
th:unless="${condition}" → 条件为假时显示
```

### 3.2 对比学习


**🔸 用if实现**：
```html
<p th:if="${user == null}">请先登录</p>
```

**🔸 用unless实现（效果完全一样）**：
```html
<p th:unless="${user != null}">请先登录</p>
```

🧠 **记忆技巧**：unless = "除非"，除非条件成立，否则显示

### 3.3 实际应用示例


**🔸 显示提示信息**：
```html
<!-- 当列表为空时，显示"暂无数据" -->
<div th:unless="${products != null and !products.isEmpty()}">
    <p class="text-muted">暂无商品数据</p>
</div>
```

**🔸 权限控制**：
```html
<!-- 不是管理员时，隐藏管理按钮 -->
<button th:unless="${user.role == 'admin'}">普通用户按钮</button>
```

### 3.4 if vs unless 选择建议


| 场景 | **推荐使用** | **原因** |
|------|------------|---------|
| 🟢 **正向逻辑** | `th:if` | `逻辑更清晰，易理解` |
| 🔴 **反向逻辑** | `th:unless` | `避免双重否定，代码简洁` |
| 💡 **提示信息** | `th:unless` | `"没有XX时显示提示"更自然` |

---

## 4. 🔀 th:switch分支选择


### 4.1 为什么需要switch


**问题场景**：当有多个条件需要判断时，用if会很繁琐

```html
<!-- 用多个if实现（不推荐） -->
<p th:if="${status == 'pending'}">待处理</p>
<p th:if="${status == 'processing'}">处理中</p>
<p th:if="${status == 'completed'}">已完成</p>
<p th:if="${status == 'cancelled'}">已取消</p>
```

**💡 更好的方案**：使用 `th:switch` + `th:case`

### 4.2 基本语法结构


```html
<div th:switch="要判断的值">
    <p th:case="值1">匹配值1时显示</p>
    <p th:case="值2">匹配值2时显示</p>
    <p th:case="值3">匹配值3时显示</p>
    <p th:case="*">都不匹配时显示（默认情况）</p>
</div>
```

**🔸 语法说明**：
- `th:switch`：放在外层标签，指定要判断的变量
- `th:case`：放在内层标签，指定匹配的值
- `th:case="*"`：类似Java的default，都不匹配时执行

### 4.3 实战示例


**🔸 订单状态显示**：
```html
<div th:switch="${order.status}">
    <span th:case="'pending'" class="badge-warning">
        ⏳ 待支付
    </span>
    <span th:case="'paid'" class="badge-info">
        💳 已支付
    </span>
    <span th:case="'shipping'" class="badge-primary">
        🚚 配送中
    </span>
    <span th:case="'completed'" class="badge-success">
        ✅ 已完成
    </span>
    <span th:case="*" class="badge-secondary">
        ❓ 未知状态
    </span>
</div>
```

**🔸 用户等级徽章**：
```html
<div th:switch="${user.level}">
    <img th:case="1" src="/img/bronze.png" alt="青铜会员"/>
    <img th:case="2" src="/img/silver.png" alt="白银会员"/>
    <img th:case="3" src="/img/gold.png" alt="黄金会员"/>
    <img th:case="*" src="/img/normal.png" alt="普通用户"/>
</div>
```

### 4.4 switch使用注意事项


> ⚠️ **重要提醒**
> - switch只会匹配**第一个**符合条件的case
> - case的值要用**单引号**包裹字符串
> - `th:case="*"` 要放在**最后**作为默认选项

---

## 5. 🔗 逻辑运算符详解


### 5.1 三大逻辑运算符


Thymeleaf支持3种逻辑运算符，用来组合多个条件：

| 运算符 | **含义** | **示例** | **说明** |
|--------|---------|---------|---------|
| `and` | **与** | `${a and b}` | `两个条件都为真` |
| `or` | **或** | `${a or b}` | `至少一个条件为真` |
| `not` | **非** | `${not a}` | `条件取反` |

### 5.2 and运算符（与）


**💡 含义**：所有条件都必须满足

```html
<!-- 必须同时是会员且积分大于100 -->
<div th:if="${user.isMember and user.points > 100}">
    🎁 恭喜获得专属礼品！
</div>

<!-- 年龄在18-60之间 -->
<p th:if="${age >= 18 and age <= 60}">
    符合申请条件
</p>
```

**🔸 真值表**：
```
true  and true  = true  ✅
true  and false = false ❌
false and true  = false ❌
false and false = false ❌
```

### 5.3 or运算符（或）


**💡 含义**：只要有一个条件满足即可

```html
<!-- 是管理员或者是VIP会员 -->
<div th:if="${user.isAdmin or user.isVip}">
    进入专属通道 →
</div>

<!-- 支付方式是支付宝或微信 -->
<span th:if="${payment == 'alipay' or payment == 'wechat'}">
    扫码支付
</span>
```

**🔸 真值表**：
```
true  or true  = true  ✅
true  or false = true  ✅
false or true  = true  ✅
false or false = false ❌
```

### 5.4 not运算符（非）


**💡 含义**：条件取反

```html
<!-- 不是管理员 -->
<p th:if="${not user.isAdmin}">
    您没有管理权限
</p>

<!-- 列表不为空 -->
<div th:if="${not #lists.isEmpty(products)}">
    商品列表...
</div>
```

**🔸 真值表**：
```
not true  = false
not false = true
```

### 5.5 运算符组合使用


```html
<!-- 复杂条件：(是会员 且 积分>50) 或者 是管理员 -->
<div th:if="${(user.isMember and user.points > 50) or user.isAdmin}">
    享受折扣优惠
</div>

<!-- 年龄检查：不在18-60范围内 -->
<p th:if="${not (age >= 18 and age <= 60)}">
    年龄不符合要求
</p>
```

---

## 6. ⚖️ 比较运算符使用


### 6.1 六大比较运算符


| 符号形式 | **文本形式** | **含义** | **示例** |
|---------|------------|---------|---------|
| `>` | `gt` | **大于** | `${age > 18}` 或 `${age gt 18}` |
| `<` | `lt` | **小于** | `${price < 100}` 或 `${price lt 100}` |
| `>=` | `ge` | **大于等于** | `${score >= 60}` 或 `${score ge 60}` |
| `<=` | `le` | **小于等于** | `${count <= 10}` 或 `${count le 10}` |
| `==` | `eq` | **等于** | `${status == 'ok'}` 或 `${status eq 'ok'}` |
| `!=` | `ne` | **不等于** | `${type != 'admin'}` 或 `${type ne 'admin'}` |

### 6.2 为什么有两种写法？


**🤔 符号形式 vs 文本形式**

```html
<!-- 符号形式（常用） -->
<p th:if="${age > 18}">成年人</p>

<!-- 文本形式（XML安全） -->
<p th:if="${age gt 18}">成年人</p>
```

**💡 使用建议**：
- 普通HTML中：推荐用**符号形式**（`>` `<` `==`），更直观
- XML文件中：必须用**文本形式**（`gt` `lt` `eq`），因为`<`和`>`在XML中有特殊含义

### 6.3 数字比较示例


```html
<!-- 价格区间判断 -->
<span th:if="${price < 100}" class="price-low">
    💰 实惠价
</span>
<span th:if="${price >= 100 and price < 500}" class="price-mid">
    💎 中档价
</span>
<span th:if="${price >= 500}" class="price-high">
    👑 高端价
</span>

<!-- 库存预警 -->
<div th:if="${stock <= 10}" class="alert-warning">
    ⚠️ 库存不足，仅剩 <span th:text="${stock}"></span> 件
</div>
```

### 6.4 字符串比较示例


```html
<!-- 状态判断 -->
<span th:if="${order.status == 'completed'}">
    ✅ 订单已完成
</span>

<!-- 用户角色判断 -->
<button th:if="${user.role != 'guest'}">
    发表评论
</button>

<!-- 支付方式判断 -->
<img th:if="${payMethod eq 'alipay'}" src="/img/alipay.png"/>
```

### 6.5 比较运算注意事项


> 💡 **实用技巧**
> - 字符串比较要用**单引号**包裹：`${status == 'ok'}`
> - null值比较要用`== null`或`!= null`
> - 数字比较不需要引号：`${age > 18}`

---

## 7. 🧩 条件表达式组合


### 7.1 三元运算符（条件表达式）


**💡 语法格式**：`条件 ? 值1 : 值2`

**含义**：如果条件成立返回值1，否则返回值2

```html
<!-- 根据性别显示称呼 -->
<p th:text="${user.gender == 'male' ? '先生' : '女士'}">称呼</p>

<!-- 根据库存显示状态 -->
<span th:text="${stock > 0 ? '有货' : '缺货'}">状态</span>

<!-- 根据分数显示等级 -->
<span th:text="${score >= 90 ? '优秀' : (score >= 60 ? '及格' : '不及格')}">
    等级
</span>
```

### 7.2 Elvis运算符（默认值）


**💡 语法格式**：`值 ?: 默认值`

**含义**：如果值不为null就用该值，否则用默认值

```html
<!-- 用户名为空时显示"游客" -->
<p>欢迎，<span th:text="${user.name ?: '游客'}"></span></p>

<!-- 头像为空时用默认头像 -->
<img th:src="${user.avatar ?: '/img/default-avatar.png'}"/>

<!-- 描述为空时显示提示 -->
<p th:text="${product.desc ?: '暂无描述'}">描述</p>
```

**🔸 对比理解**：
```html
<!-- 完整写法 -->
<p th:text="${name != null ? name : '未知'}">姓名</p>

<!-- Elvis简化写法（效果一样） -->
<p th:text="${name ?: '未知'}">姓名</p>
```

### 7.3 复杂条件组合


**🔸 多层嵌套三元表达式**：
```html
<!-- 根据VIP等级显示不同折扣 -->
<span th:text="${user.vipLevel == 3 ? '7折' : 
               (user.vipLevel == 2 ? '8折' : 
               (user.vipLevel == 1 ? '9折' : '原价'))}">
    折扣
</span>
```

**🔸 逻辑运算符+三元运算符**：
```html
<!-- 会员且积分>100显示特权，否则显示普通 -->
<div th:class="${user.isMember and user.points > 100 ? 'vip-privilege' : 'normal'}">
    会员专区
</div>
```

**🔸 Elvis运算符+三元运算符**：
```html
<!-- 有评分显示星级，无评分显示"暂无" -->
<span th:text="${product.rating != null ? product.rating + '星' : '暂无评分'}">
    评分
</span>

<!-- 简化写法 -->
<span th:text="${(product.rating ?: 0) + '星'}">评分</span>
```

---

## 8. 🚀 实战应用场景


### 8.1 用户权限控制


```html
<!-- 根据用户角色显示不同菜单 -->
<nav>
    <!-- 所有用户都能看到 -->
    <a href="/home">首页</a>
    <a href="/products">商品</a>
    
    <!-- 只有登录用户能看到 -->
    <a th:if="${user != null}" href="/orders">我的订单</a>
    <a th:if="${user != null}" href="/profile">个人中心</a>
    
    <!-- 只有管理员能看到 -->
    <a th:if="${user != null and user.role == 'admin'}" href="/admin">
        管理后台
    </a>
    
    <!-- 未登录显示登录按钮 -->
    <a th:if="${user == null}" href="/login">登录</a>
    
    <!-- 已登录显示退出按钮 -->
    <a th:if="${user != null}" href="/logout">退出</a>
</nav>
```

### 8.2 数据展示与提示


```html
<!-- 商品列表 -->
<div th:if="${products != null and !products.isEmpty()}">
    <div th:each="product : ${products}">
        <h3 th:text="${product.name}">商品名</h3>
        <p th:text="${product.price}">价格</p>
        
        <!-- 库存状态 -->
        <span th:switch="${product.stock}">
            <span th:case="0" class="text-danger">已售罄</span>
            <span th:case="*">
                <span th:if="${product.stock le 10}" class="text-warning">
                    仅剩<span th:text="${product.stock}"></span>件
                </span>
                <span th:unless="${product.stock le 10}" class="text-success">
                    库存充足
                </span>
            </span>
        </span>
    </div>
</div>

<!-- 空数据提示 -->
<div th:unless="${products != null and !products.isEmpty()}" class="empty-tips">
    <p>😔 暂无商品数据</p>
</div>
```

### 8.3 表单验证提示


```html
<form>
    <div>
        <label>用户名：</label>
        <input type="text" name="username"/>
        <!-- 错误提示 -->
        <span th:if="${errors != null and errors.containsKey('username')}" 
              class="error-msg">
            ❌ <span th:text="${errors['username']}"></span>
        </span>
    </div>
    
    <div>
        <label>年龄：</label>
        <input type="number" name="age"/>
        <!-- 年龄验证提示 -->
        <span th:if="${age != null}">
            <span th:if="${age lt 18}" class="text-warning">
                ⚠️ 未成年用户
            </span>
            <span th:if="${age ge 18 and age le 60}" class="text-success">
                ✅ 符合要求
            </span>
            <span th:if="${age gt 60}" class="text-info">
                💼 老年用户
            </span>
        </span>
    </div>
</form>
```

### 8.4 支付状态显示


```html
<div class="order-status" th:switch="${order.paymentStatus}">
    <div th:case="'pending'">
        <span class="badge badge-warning">⏳ 待支付</span>
        <button class="btn-pay">立即支付</button>
        <p class="countdown">
            剩余时间：<span th:text="${order.remainTime}">30</span>分钟
        </p>
    </div>
    
    <div th:case="'paid'">
        <span class="badge badge-success">✅ 支付成功</span>
        <p>支付金额：¥<span th:text="${order.amount}">0</span></p>
        <p>支付时间：<span th:text="${order.payTime}">时间</span></p>
    </div>
    
    <div th:case="'refunded'">
        <span class="badge badge-info">💰 已退款</span>
        <p>退款原因：<span th:text="${order.refundReason ?: '用户主动退款'}"></span></p>
    </div>
    
    <div th:case="'cancelled'">
        <span class="badge badge-secondary">❌ 已取消</span>
        <p th:if="${order.cancelReason != null}">
            取消原因：<span th:text="${order.cancelReason}"></span>
        </p>
    </div>
    
    <div th:case="*">
        <span class="badge badge-dark">❓ 未知状态</span>
    </div>
</div>
```

---

## 9. 📋 核心要点总结


### 9.1 四大核心语法对比


| 语法 | **使用场景** | **典型示例** | **记忆技巧** |
|------|------------|-------------|-------------|
| `th:if` | **条件为真时显示** | `登录后显示用户名` | `if = 如果` |
| `th:unless` | **条件为假时显示** | `未登录显示登录按钮` | `unless = 除非` |
| `th:switch` | **多分支选择** | `订单状态显示` | `switch = 开关选择` |
| `th:case` | **具体分支条件** | `配合switch使用` | `case = 情况` |

### 9.2 运算符速查表


**🔸 逻辑运算符**：
```
and  → 且（都满足）
or   → 或（满足一个即可）
not  → 非（取反）
```

**🔸 比较运算符**：
```
>   (gt)  → 大于
<   (lt)  → 小于
>=  (ge)  → 大于等于
<=  (le)  → 小于等于
==  (eq)  → 等于
!=  (ne)  → 不等于
```

**🔸 特殊运算符**：
```
? :     → 三元运算符（条件 ? 值1 : 值2）
?:      → Elvis运算符（值 ?: 默认值）
```

### 9.3 实用开发技巧


> 💡 **最佳实践**
> 
> 1️⃣ **选择合适的语法**：简单判断用`if`，反向逻辑用`unless`，多分支用`switch`
> 
> 2️⃣ **合理组合运算符**：逻辑清晰，避免过度嵌套
> 
> 3️⃣ **处理null值**：使用`!= null`或Elvis运算符`?:`防止空指针
> 
> 4️⃣ **字符串比较**：记得加单引号 `${status == 'ok'}`
> 
> 5️⃣ **可读性优先**：复杂条件建议在Controller中处理，视图层保持简洁

### 9.4 常见错误避免


⚠️ **注意事项**：

| 错误示例 | **正确示例** | **说明** |
|---------|------------|---------|
| `th:if="user != null"` | `th:if="${user != null}"` | `必须用${}`包裹表达式` |
| `th:if="${status == ok}"` | `th:if="${status == 'ok'}"` | `字符串要用单引号` |
| `th:switch="${status}" th:case="ok"` | `外层switch，内层case` | `switch和case分开写` |
| `th:if="${age > 18 && age < 60}"` | `th:if="${age > 18 and age < 60}"` | `用and不用&&` |

### 9.5 学习检验清单


**📈 掌握程度自测**：

- [ ] 能说出`th:if`和`th:unless`的区别
- [ ] 会使用`th:switch`处理多分支场景
- [ ] 掌握`and`、`or`、`not`的使用
- [ ] 熟悉6种比较运算符的两种写法
- [ ] 能灵活使用三元运算符和Elvis运算符
- [ ] 可以处理复杂的条件组合表达式
- [ ] 能在实际项目中应用权限控制和状态显示

**🧠 记忆口诀**：
```
if真unless假，switch多选巧分叉
and且or或not非，比较运算符号齐
三元问号冒号接，Elvis双问默认值
条件组合逻辑清，实战应用显神奇
```

**🔗 扩展学习**：
- 下一节：[循环遍历与集合操作](#循环遍历)
- 相关概念：[表达式工具对象](#工具对象) | [内置对象使用](#内置对象)