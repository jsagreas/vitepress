---
title: 1、标准表达式体系详解
---
## 📚 目录

1. [表达式体系概览](#1-表达式体系概览)
2. [变量表达式 ${}](#2-变量表达式)
3. [选择表达式 *{}](#3-选择表达式)
4. [消息表达式 #{}](#4-消息表达式)
5. [链接表达式 @{}](#5-链接表达式)
6. [片段表达式 ~{}](#6-片段表达式)
7. [表达式优先级与嵌套](#7-表达式优先级与嵌套)
8. [核心要点总结](#8-核心要点总结)

---

## 1. 🎯 表达式体系概览


### 1.1 什么是Thymeleaf表达式


**通俗理解**：Thymeleaf表达式就是在HTML模板中"取值"和"操作数据"的方式，类似于在模板中写的"小代码片段"。

```
普通HTML：<p>用户名</p>
加上表达式：<p th:text="${username}">用户名</p>
             ↑
          这就是表达式！用来获取后端传来的username数据
```

**为什么需要表达式**：
- 🔸 后端传来的数据需要显示在页面上
- 🔸 需要根据数据动态改变页面内容
- 🔸 需要拼接URL、读取配置、引用公共片段等

### 1.2 五种核心表达式一览


| 表达式符号 | 名称 | 主要用途 | 记忆口诀 |
|---------|------|---------|---------|
| `${}` | 变量表达式 | 获取后端数据 | 💰 美元符号-取值 |
| `*{}` | 选择表达式 | 在选定对象上取值 | ⭐ 星号-选中对象 |
| `#{}` | 消息表达式 | 读取国际化配置 | #️⃣ 井号-配置文本 |
| `@{}` | 链接表达式 | 生成URL链接 | 🔗 @符号-网址 |
| `~{}` | 片段表达式 | 引用模板片段 | 🧩 波浪号-拼图块 |

### 1.3 表达式的使用场景


```
📄 页面开发流程：
Controller（控制器）→ Model（数据） → Template（模板）→ 浏览器
                      ↓
                  使用表达式取值

实际案例：
用户登录 → 后端返回user对象 → 模板用${user.name}显示用户名
```

---

## 2. 💰 变量表达式 ${}


### 2.1 基本概念


**核心定义**：变量表达式用`${}`包裹，用于获取后端传递到模板的数据。

**工作原理**：
```
后端代码流程：
Controller: model.addAttribute("username", "张三");
             ↓
模板中使用：th:text="${username}"
             ↓
最终显示：  张三
```

### 2.2 基础用法


#### 🔹 简单变量获取


```html
<!-- 后端传递：model.addAttribute("message", "欢迎使用Thymeleaf"); -->

<!-- 显示文本 -->
<p th:text="${message}">默认消息</p>
<!-- 结果：<p>欢迎使用Thymeleaf</p> -->

<!-- 设置属性值 -->
<input type="text" th:value="${message}" />
<!-- 结果：<input type="text" value="欢迎使用Thymeleaf" /> -->
```

**🔑 关键理解**：
- `th:text` 会替换标签内的文本内容
- `th:value` 会设置input的value属性
- `${}` 里写的是后端传来的变量名

#### 🔹 对象属性访问


```html
<!-- 后端传递User对象 -->
<!-- User user = new User("张三", 25, "beijing@example.com"); -->
<!-- model.addAttribute("user", user); -->

<!-- 方式1：点语法（推荐） -->
<p>姓名：<span th:text="${user.name}">姓名</span></p>
<p>年龄：<span th:text="${user.age}">年龄</span></p>

<!-- 方式2：中括号语法 -->
<p>邮箱：<span th:text="${user['email']}">邮箱</span></p>

<!-- 结果展示：
姓名：张三
年龄：25
邮箱：beijing@example.com
-->
```

**💡 语法对比**：
- `${user.name}` ← 调用`user.getName()`方法（常用）
- `${user['name']}` ← 也是调用`getName()`（动态属性名时用）

#### 🔹 集合数据处理


```html
<!-- 后端传递List<String>集合 -->
<!-- List<String> fruits = Arrays.asList("苹果", "香蕉", "橙子"); -->
<!-- model.addAttribute("fruits", fruits); -->

<!-- 循环展示列表 -->
<ul>
  <li th:each="fruit : ${fruits}" th:text="${fruit}">水果</li>
</ul>

<!-- 结果：
<ul>
  <li>苹果</li>
  <li>香蕉</li>
  <li>橙子</li>
</ul>
-->

<!-- 获取列表长度 -->
<p>共有 <span th:text="${fruits.size()}">0</span> 种水果</p>
<!-- 结果：共有 3 种水果 -->
```

### 2.3 高级用法


#### 🔸 内置对象访问


```html
<!-- Thymeleaf提供的内置对象 -->

<!-- 1. 获取请求参数 -->
<p th:text="${param.keyword}">搜索关键词</p>
<!-- 访问URL中的 ?keyword=xxx -->

<!-- 2. 获取Session数据 -->
<p th:text="${session.loginUser}">当前用户</p>

<!-- 3. 获取应用上下文路径 -->
<a th:href="@{${#httpServletRequest.contextPath} + '/home'}">首页</a>
```

**📋 常用内置对象**：
- `${param.xxx}` - 请求参数
- `${session.xxx}` - Session数据
- `${application.xxx}` - Application域数据

#### 🔸 运算与判断


```html
<!-- 数学运算 -->
<p>总价：<span th:text="${price * quantity}">0</span> 元</p>

<!-- 字符串拼接 -->
<p th:text="'您好，' + ${username} + '!'">欢迎</p>
<!-- 或使用 |...| 语法 -->
<p th:text="|您好，${username}！|">欢迎</p>

<!-- 三元运算 -->
<p th:text="${age >= 18} ? '成年' : '未成年'">年龄状态</p>

<!-- 空值处理（Elvis运算符） -->
<p th:text="${nickname} ?: '匿名用户'">昵称</p>
<!-- 如果nickname为null，显示"匿名用户" -->
```

### 2.4 实战场景


**场景1：用户信息展示**
```html
<!-- 后端：model.addAttribute("user", userObject); -->

<div class="user-card">
  <h3 th:text="${user.name}">用户名</h3>
  <p>年龄：<span th:text="${user.age}">0</span> 岁</p>
  <p>状态：<span th:text="${user.isVip} ? 'VIP会员' : '普通用户'">状态</span></p>
</div>
```

**场景2：商品列表展示**
```html
<!-- 后端：model.addAttribute("products", productList); -->

<table>
  <tr th:each="product : ${products}">
    <td th:text="${product.name}">商品名</td>
    <td th:text="${product.price}">价格</td>
    <td th:text="${product.stock > 0} ? '有货' : '缺货'">状态</td>
  </tr>
</table>
```

---

## 3. ⭐ 选择表达式 *{}


### 3.1 核心概念


**是什么**：选择表达式`*{}`用于在已选定的对象上获取属性，可以理解为"在某个对象内部取值"。

**与变量表达式的区别**：
```
变量表达式：每次都从根开始找
${user.name}、${user.age}、${user.email}
         ↑ 每次都要写user

选择表达式：先选定对象，再取属性  
<div th:object="${user}">
  <p th:text="*{name}"></p>  ← 直接写属性名
  <p th:text="*{age}"></p>
  <p th:text="*{email}"></p>
</div>
```

### 3.2 基本使用


#### 🔹 配合th:object使用


```html
<!-- 后端：model.addAttribute("user", userObject); -->

<!-- 方式1：使用变量表达式（重复写user） -->
<div>
  <p>姓名：<span th:text="${user.name}">姓名</span></p>
  <p>年龄：<span th:text="${user.age}">年龄</span></p>
  <p>邮箱：<span th:text="${user.email}">邮箱</span></p>
</div>

<!-- 方式2：使用选择表达式（简洁） -->
<div th:object="${user}">
  <p>姓名：<span th:text="*{name}">姓名</span></p>
  <p>年龄：<span th:text="*{age}">年龄</span></p>
  <p>邮箱：<span th:text="*{email}">邮箱</span></p>
</div>
```

**💡 优势理解**：
- ✅ 代码更简洁，不用重复写对象名
- ✅ 适合处理同一对象的多个属性
- ✅ 表单绑定时特别好用

#### 🔹 表单数据绑定


```html
<!-- 编辑用户信息表单 -->
<!-- 后端：model.addAttribute("user", userObject); -->

<form th:action="@{/user/update}" th:object="${user}" method="post">
  <input type="text" th:field="*{name}" />
  <!-- th:field 等同于同时设置 name、value、id -->
  
  <input type="number" th:field="*{age}" />
  <input type="email" th:field="*{email}" />
  
  <button type="submit">保存</button>
</form>

<!-- 最终生成：
<form action="/user/update" method="post">
  <input type="text" id="name" name="name" value="张三" />
  <input type="number" id="age" name="age" value="25" />
  <input type="email" id="email" name="email" value="zhangsan@example.com" />
  <button type="submit">保存</button>
</form>
-->
```

### 3.3 何时使用选择表达式


**✅ 适合使用的场景**：
```
场景1：表单数据绑定
<form th:object="${user}">
  <input th:field="*{name}" />
  <input th:field="*{email}" />
</form>

场景2：对象信息卡片
<div th:object="${product}">
  <h3 th:text="*{name}"></h3>
  <p th:text="*{price}"></p>
  <p th:text="*{description}"></p>
</div>

场景3：嵌套对象处理
<div th:object="${order}">
  <p th:text="*{orderNo}">订单号</p>
  <div th:object="*{user}">
    <p th:text="*{name}">用户名</p>
  </div>
</div>
```

**❌ 不建议使用的场景**：
- 只需要取一个属性值 → 直接用`${}`更清晰
- 需要访问多个不同对象 → 用`${}`避免混淆

---

## 4. #️⃣ 消息表达式 #{}


### 4.1 基本概念


**是什么**：消息表达式`#{}`用于读取国际化配置文件中的文本，实现多语言支持。

**实际应用**：
```
中文用户看到：欢迎登录
英文用户看到：Welcome to Login
日文用户看到：ログインへようこそ

这些不同语言的文本就存储在配置文件中，用#{}读取
```

### 4.2 配置文件准备


#### 📁 创建国际化文件


```
项目结构：
src/main/resources/
  ├── messages.properties           # 默认（中文）
  ├── messages_en_US.properties     # 英文
  └── messages_zh_CN.properties     # 中文
```

**messages.properties（默认中文）**：
```properties
# 用户相关
user.welcome=欢迎登录系统
user.login=登录
user.logout=退出
user.register=注册

# 表单提示
form.username=用户名
form.password=密码
form.submit=提交
```

**messages_en_US.properties（英文）**：
```properties
user.welcome=Welcome to System
user.login=Login
user.logout=Logout
user.register=Register

form.username=Username
form.password=Password
form.submit=Submit
```

### 4.3 在模板中使用


#### 🔹 基本文本获取


```html
<!-- 读取配置文件中的文本 -->
<h1 th:text="#{user.welcome}">欢迎</h1>
<!-- 根据用户浏览器语言，显示对应文本 -->

<button th:text="#{user.login}">登录</button>
<button th:text="#{user.register}">注册</button>
```

#### 🔹 带参数的消息


**配置文件**：
```properties
# {0}、{1} 是占位符
user.greeting=你好，{0}！欢迎第{1}次访问
product.info=商品{0}的价格是{1}元
```

**模板使用**：
```html
<!-- 传递参数 -->
<p th:text="#{user.greeting(${username}, ${visitCount})}">问候语</p>
<!-- 结果：你好，张三！欢迎第5次访问 -->

<p th:text="#{product.info(${product.name}, ${product.price})}">商品信息</p>
<!-- 结果：商品iPhone的价格是5999元 -->
```

### 4.4 实战应用


**场景：多语言登录页面**
```html
<div class="login-box">
  <h2 th:text="#{user.welcome}">欢迎</h2>
  
  <form th:action="@{/login}" method="post">
    <!-- 标签文本国际化 -->
    <label th:text="#{form.username}">用户名</label>
    <input type="text" name="username" th:placeholder="#{form.username}" />
    
    <label th:text="#{form.password}">密码</label>
    <input type="password" name="password" th:placeholder="#{form.password}" />
    
    <button type="submit" th:text="#{form.submit}">提交</button>
  </form>
</div>
```

**🌍 工作流程**：
```
1. 用户访问 → 浏览器发送语言偏好（Accept-Language）
2. Spring检测语言 → 选择对应配置文件
3. Thymeleaf读取 → #{} 替换为对应语言文本
4. 页面展示 → 用户看到本地化内容
```

---

## 5. 🔗 链接表达式 @{}


### 5.1 核心作用


**是什么**：链接表达式`@{}`专门用于生成URL链接，会自动处理上下文路径和参数编码。

**为什么需要**：
```
问题场景：
项目部署在 /myapp 路径下
手写链接：<a href="/home">首页</a>
实际访问：/home ❌ (404错误)
正确路径：/myapp/home ✅

使用@{}：<a th:href="@{/home}">首页</a>
自动生成：<a href="/myapp/home">首页</a> ✅
```

### 5.2 基础用法


#### 🔹 静态链接


```html
<!-- 相对于应用根路径 -->
<a th:href="@{/home}">首页</a>
<!-- 生成：/项目路径/home -->

<a th:href="@{/user/profile}">个人中心</a>
<!-- 生成：/项目路径/user/profile -->

<!-- 引用静态资源 -->
<link th:href="@{/css/style.css}" rel="stylesheet" />
<script th:src="@{/js/main.js}"></script>
<!-- 自动加上项目路径前缀 -->
```

#### 🔹 带参数的链接


```html
<!-- 方式1：路径参数（RESTful风格） -->
<a th:href="@{/user/{id}(id=${user.id})}">用户详情</a>
<!-- 假设 user.id=123 -->
<!-- 生成：/user/123 -->

<!-- 方式2：查询参数 -->
<a th:href="@{/search(keyword=${keyword},page=${page})}">搜索</a>
<!-- 假设 keyword='手机', page=2 -->
<!-- 生成：/search?keyword=%E6%89%8B%E6%9C%BA&page=2 -->
<!--           ↑ 自动URL编码 -->

<!-- 方式3：混合使用 -->
<a th:href="@{/product/{id}(id=${product.id},from='list')}">商品详情</a>
<!-- 生成：/product/456?from=list -->
```

#### 🔹 动态URL拼接


```html
<!-- 使用变量拼接 -->
<a th:href="@{${baseUrl} + '/api/data'}">API接口</a>

<!-- 条件拼接 -->
<a th:href="@{/user(id=${user.id}, view=${user.isVip ? 'vip' : 'normal'})}">
  查看详情
</a>
```

### 5.3 实战应用场景


**场景1：分页链接**
```html
<!-- 分页导航 -->
<div th:if="${page.hasPrevious}">
  <a th:href="@{/list(page=${page.number - 1})}">上一页</a>
</div>

<span th:each="i : ${#numbers.sequence(1, page.totalPages)}">
  <a th:href="@{/list(page=${i})}" 
     th:text="${i}"
     th:classappend="${i == page.number} ? 'active'">1</a>
</span>

<div th:if="${page.hasNext}">
  <a th:href="@{/list(page=${page.number + 1})}">下一页</a>
</div>
```

**场景2：表单提交地址**
```html
<!-- 编辑表单 -->
<form th:action="@{/user/update/{id}(id=${user.id})}" method="post">
  <input type="text" name="name" th:value="${user.name}" />
  <button type="submit">保存</button>
</form>
<!-- 提交到：/user/update/123 -->
```

**场景3：图片资源链接**
```html
<!-- 用户头像 -->
<img th:src="@{/upload/avatar/{filename}(filename=${user.avatar})}" 
     alt="头像" />
<!-- 生成：/upload/avatar/user123.jpg -->
```

### 5.4 协议与外部链接


```html
<!-- 外部链接（保持原样） -->
<a th:href="@{http://www.example.com}">外部网站</a>
<!-- 生成：http://www.example.com -->

<!-- 协议相对链接 -->
<a th:href="@{//cdn.example.com/lib.js}">CDN资源</a>
<!-- 生成：//cdn.example.com/lib.js -->
```

---

## 6. 🧩 片段表达式 ~{}


### 6.1 基本概念


**是什么**：片段表达式`~{}`用于引用模板片段，实现页面模块化和复用。

**现实类比**：
```
就像搭积木：
- 定义积木块（模板片段）：头部、底部、侧边栏
- 拼装积木（引用片段）：不同页面组合不同积木块
```

### 6.2 定义和引用片段


#### 🔹 定义片段（th:fragment）


**fragments/common.html（公共片段文件）**：
```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>

<!-- 定义头部片段 -->
<header th:fragment="header">
  <nav>
    <a th:href="@{/}">首页</a>
    <a th:href="@{/products}">商品</a>
    <a th:href="@{/about}">关于</a>
  </nav>
</header>

<!-- 定义底部片段 -->
<footer th:fragment="footer">
  <p>&copy; 2025 我的网站</p>
</footer>

<!-- 带参数的片段 -->
<div th:fragment="userCard(user)">
  <h3 th:text="${user.name}">用户名</h3>
  <p th:text="${user.email}">邮箱</p>
</div>

</body>
</html>
```

#### 🔹 引用片段


**index.html（使用片段）**：
```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>首页</title>
</head>
<body>

<!-- 方式1：th:insert（插入片段） -->
<div th:insert="~{fragments/common :: header}"></div>

<!-- 方式2：th:replace（替换当前标签） -->
<div th:replace="~{fragments/common :: footer}"></div>

<!-- 方式3：简写（省略~{}） -->
<div th:insert="fragments/common :: header"></div>

<!-- 引用带参数的片段 -->
<div th:replace="fragments/common :: userCard(${currentUser})"></div>

</body>
</html>
```

**🔑 区别理解**：
```
th:insert - 保留外层div，片段插入其中
<div>
  <header>...</header>  ← 片段内容
</div>

th:replace - 替换整个div标签
<header>...</header>  ← 直接替换
```

### 6.3 片段选择器


```html
<!-- 按id选择片段 -->
<div id="mySection">内容</div>
引用：th:insert="~{templateName :: #mySection}"

<!-- 按class选择 -->
<div class="card">内容</div>
引用：th:insert="~{templateName :: .card}"

<!-- 按标签选择 -->
<header>内容</header>
引用：th:insert="~{templateName :: header}"
```

### 6.4 实战场景


**场景1：页面布局复用**
```html
<!-- layout.html（布局模板） -->
<html th:fragment="layout(title, content)">
<head>
  <title th:text="${title}">默认标题</title>
</head>
<body>
  <header th:replace="fragments/common :: header"></header>
  
  <main th:replace="${content}"></main>
  
  <footer th:replace="fragments/common :: footer"></footer>
</body>
</html>

<!-- 使用布局 -->
<html th:replace="layout :: layout('首页', ~{::main})">
<main>
  <h1>首页内容</h1>
  <p>这里是具体页面内容</p>
</main>
</html>
```

**场景2：动态组件加载**
```html
<!-- 根据条件加载不同片段 -->
<div th:replace="${user.isVip} ? 
                 ~{fragments/vip :: vipCard} : 
                 ~{fragments/normal :: normalCard}">
</div>
```

---

## 7. 🎯 表达式优先级与嵌套


### 7.1 表达式优先级


**运算符优先级表**（从高到低）：

| 优先级 | 运算符 | 说明 | 示例 |
|-------|--------|------|------|
| 1 | `()` | 括号 | `(a + b) * c` |
| 2 | `!` `.` `[]` | 取反、属性访问 | `!flag` `user.name` |
| 3 | `*` `/` `%` | 乘除取模 | `price * 0.8` |
| 4 | `+` `-` | 加减 | `total + tax` |
| 5 | `>` `<` `>=` `<=` | 比较 | `age >= 18` |
| 6 | `==` `!=` | 相等判断 | `status == 'active'` |
| 7 | `and` | 逻辑与 | `age >= 18 and verified` |
| 8 | `or` | 逻辑或 | `isVip or isAdmin` |
| 9 | `?:` | 三元运算 | `age >= 18 ? '成年' : '未成年'` |

**💡 记忆技巧**：
```
括号最优先，点号紧随后
先乘除后加减，比较再判等
逻辑与在或前，三元最后算
```

### 7.2 表达式嵌套使用


#### 🔹 基础嵌套


```html
<!-- 在变量表达式中使用链接表达式 -->
<a th:href="@{${dynamicPath}}">动态链接</a>

<!-- 在消息表达式中使用变量 -->
<p th:text="#{user.greeting(${username})}">问候</p>

<!-- 在选择表达式中使用变量 -->
<div th:object="${user}">
  <p th:text="*{level > 5 ? #{vip.title} : #{normal.title}}">等级</p>
</div>
```

#### 🔹 复杂嵌套示例


```html
<!-- 示例1：条件+链接+参数 -->
<a th:href="@{${user.isVip ? '/vip/dashboard' : '/user/dashboard'}
            (id=${user.id}, token=${session.token})}">
  进入控制台
</a>

<!-- 示例2：循环+选择+消息 -->
<div th:each="product : ${products}" th:object="${product}">
  <h3 th:text="*{name}">商品名</h3>
  <p th:text="#{product.price} + ': ' + *{price} + #{currency.yuan}">价格</p>
  <span th:if="*{stock > 0}" th:text="#{product.inStock}">有货</span>
  <span th:unless="*{stock > 0}" th:text="#{product.outStock}">缺货</span>
</div>

<!-- 示例3：片段+参数+条件 -->
<div th:replace="~{fragments/card :: 
                  ${user.type == 'vip' ? 'vipCard' : 'normalCard'}
                  (user=${user}, showDetail=${showDetail})}">
</div>
```

### 7.3 嵌套最佳实践


**✅ 推荐写法**：
```html
<!-- 1. 逻辑清晰，适当换行 -->
<a th:href="@{/product/{id}(
              id=${product.id},
              source=${source},
              ref=${referrer}
            )}">
  查看详情
</a>

<!-- 2. 复杂逻辑提前在Controller处理 -->
<!-- 后端：model.addAttribute("dashboardUrl", user.getDashboardUrl()); -->
<a th:href="@{${dashboardUrl}}">控制台</a>

<!-- 3. 使用工具对象简化 -->
<p th:text="${#strings.concat(user.firstName, ' ', user.lastName)}">姓名</p>
```

**❌ 避免的写法**：
```html
<!-- 嵌套过深，难以维护 -->
<a th:href="@{${user.isVip ? (user.level > 5 ? '/vip/premium' : '/vip/normal') : (user.verified ? '/user/verified' : '/user/guest')}(id=${user.id})}">链接</a>

<!-- 建议：在Controller中处理复杂逻辑 -->
```

### 7.4 表达式组合技巧


**技巧1：字符串拼接**
```html
<!-- 方式1：+ 运算符 -->
<p th:text="'欢迎，' + ${user.name} + '！'">欢迎</p>

<!-- 方式2：竖线语法（推荐） -->
<p th:text="|欢迎，${user.name}！|">欢迎</p>

<!-- 方式3：工具方法 -->
<p th:text="${#strings.concat('欢迎，', user.name, '！')}">欢迎</p>
```

**技巧2：空值安全处理**
```html
<!-- Elvis运算符（?:） -->
<p th:text="${user.nickname} ?: '匿名用户'">昵称</p>

<!-- 安全导航（?.） -->
<p th:text="${user?.address?.city}">城市</p>
<!-- 如果user或address为null，不会报错 -->

<!-- 默认值设置 -->
<p th:text="${config.title} ?: 'Default Title'">标题</p>
```

**技巧3：条件渲染组合**
```html
<!-- 复杂条件判断 -->
<div th:if="${user != null and user.isActive and user.emailVerified}">
  <p>已激活账户</p>
</div>

<!-- Switch-Case风格 -->
<div th:switch="${user.role}">
  <p th:case="'admin'" th:text="#{role.admin}">管理员</p>
  <p th:case="'user'" th:text="#{role.user}">普通用户</p>
  <p th:case="*" th:text="#{role.guest}">访客</p>
</div>
```

---

## 8. 📋 核心要点总结


### 8.1 五种表达式对比


| 表达式 | 语法 | 核心作用 | 使用场景 | 记忆要点 |
|--------|------|---------|---------|---------|
| **变量** | `${}` | 获取后端数据 | 显示数据、条件判断 | 💰 最常用，从Model取值 |
| **选择** | `*{}` | 在选定对象取值 | 表单绑定、对象信息展示 | ⭐ 配合th:object使用 |
| **消息** | `#{}` | 读取配置文本 | 国际化、多语言 | #️⃣ 文本配置化 |
| **链接** | `@{}` | 生成URL | 页面跳转、资源引用 | 🔗 自动处理路径 |
| **片段** | `~{}` | 引用模板片段 | 页面复用、模块化 | 🧩 组件化开发 |

### 8.2 表达式选择指南


**📌 使用决策树**：
```
需要显示后端数据？
├─ 是 → 只显示一个对象的多个属性？
│        ├─ 是 → 用*{} + th:object
│        └─ 否 → 用${}
│
需要多语言支持？
├─ 是 → 用#{}读取配置文件
│
需要生成链接？
├─ 是 → 用@{}自动处理路径
│
需要复用页面模块？
└─ 是 → 用~{}引用片段
```

### 8.3 核心记忆口诀


```
💰 美元符号取数据，后端传值它来拿
⭐ 星号选择定对象，表单绑定最方便
#️⃣ 井号消息配置化，多语言文本全靠它
🔗 at符号拼链接，路径参数自动加
🧩 波浪引用模板片，页面复用模块化
```

### 8.4 常见错误与注意事项


**⚠️ 易错点1：变量表达式vs选择表达式**
```html
<!-- ❌ 错误：没有th:object就用*{} -->
<p th:text="*{user.name}">姓名</p>

<!-- ✅ 正确：有th:object才用*{} -->
<div th:object="${user}">
  <p th:text="*{name}">姓名</p>
</div>
```

**⚠️ 易错点2：链接表达式的路径**
```html
<!-- ❌ 错误：手动拼接项目路径 -->
<a href="/myapp/home">首页</a>

<!-- ✅ 正确：用@{}自动处理 -->
<a th:href="@{/home}">首页</a>
```

**⚠️ 易错点3：片段引用的路径**
```html
<!-- ❌ 错误：路径写法错误 -->
<div th:replace="common.html :: header"></div>

<!-- ✅ 正确：使用相对路径 -->
<div th:replace="fragments/common :: header"></div>
<!-- 或完整路径 -->
<div th:replace="~{fragments/common :: header}"></div>
```

### 8.5 性能优化建议


**🚀 优化技巧**：
```
1. 复杂逻辑在Controller处理
   ✅ 后端：model.addAttribute("isVipUser", user.isVip());
   ✅ 模板：th:if="${isVipUser}"
   ❌ 避免：th:if="${user.level > 5 and user.verified and user.paymentOk}"

2. 善用片段复用
   ✅ 定义公共片段，多处引用
   ❌ 避免：每个页面重复写相同代码

3. 合理使用选择表达式
   ✅ 同一对象多个属性用*{}
   ❌ 避免：每次都写完整的${user.xxx}

4. 国际化文本集中管理
   ✅ 所有文本放配置文件
   ❌ 避免：中英文混杂在模板中
```

### 8.6 学习路径建议


**📚 学习顺序**：
```
第1步：掌握变量表达式${} 
      ↓ 这是基础，最常用
第2步：理解选择表达式*{}
      ↓ 表单开发必备
第3步：学习链接表达式@{}
      ↓ 页面导航必须
第4步：了解消息表达式#{}
      ↓ 国际化项目需要
第5步：掌握片段表达式~{}
      ↓ 页面复用提效
第6步：练习嵌套组合
      ↓ 解决复杂场景
```

**🎯 实践建议**：
- 每学一个表达式，写3-5个实例代码
- 对比不同表达式的使用场景
- 尝试组合使用解决实际问题
- 查看项目中的实际用法学习

---

**🎓 下一步学习**：
- 📖 深入学习Thymeleaf工具对象（#strings、#dates等）
- 🔧 掌握条件判断和循环语法
- 🎨 学习布局和模板继承
- 🚀 实战项目中综合运用