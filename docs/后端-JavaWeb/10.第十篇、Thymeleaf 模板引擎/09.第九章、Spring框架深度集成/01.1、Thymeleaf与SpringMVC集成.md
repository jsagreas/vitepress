---
title: 1ã€Thymeleafä¸SpringMVCé›†æˆ
---
## ğŸ“š ç›®å½•

1. [Spring MVCé›†æˆæ¦‚è¿°](#1-spring-mvcé›†æˆæ¦‚è¿°)
2. [è§†å›¾è§£æå™¨é…ç½®](#2-è§†å›¾è§£æå™¨é…ç½®)
3. [Controlleræ•°æ®ä¼ é€’](#3-controlleræ•°æ®ä¼ é€’)
4. [Modelå¯¹è±¡æ·±å…¥](#4-modelå¯¹è±¡æ·±å…¥)
5. [ModelAndViewå¯¹è±¡è¯¦è§£](#5-modelandviewå¯¹è±¡è¯¦è§£)
6. [RedirectAttributesä½¿ç”¨](#6-redirectattributesä½¿ç”¨)
7. [Flashå±æ€§æœºåˆ¶](#7-flashå±æ€§æœºåˆ¶)
8. [è¯·æ±‚è½¬å‘ä¸é‡å®šå‘](#8-è¯·æ±‚è½¬å‘ä¸é‡å®šå‘)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ Spring MVCé›†æˆæ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯Thymeleafä¸Spring MVCé›†æˆ


**é€šä¿—ç†è§£**ï¼š
> ğŸ­ **å·¥å‚ç±»æ¯”**ï¼šSpring MVCæ˜¯å·¥å‚çš„ç”Ÿäº§çº¿ï¼ˆå¤„ç†è¯·æ±‚ï¼‰ï¼ŒThymeleafæ˜¯åŒ…è£…è½¦é—´ï¼ˆæ¸²æŸ“é¡µé¢ï¼‰ã€‚é›†æˆå°±æ˜¯è®©å®ƒä»¬æ— ç¼åä½œï¼ŒæŠŠæ•°æ®æ¼‚äº®åœ°å±•ç¤ºç»™ç”¨æˆ·ã€‚

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
```
ç”¨æˆ·è¯·æ±‚ â†’ Spring MVCå¤„ç† â†’ å‡†å¤‡æ•°æ® â†’ Thymeleafæ¸²æŸ“ â†’ è¿”å›HTMLé¡µé¢

ç®€å•è¯´å°±æ˜¯ï¼š
- Spring MVCè´Ÿè´£"åšäº‹"ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰
- Thymeleafè´Ÿè´£"å±•ç¤º"ï¼ˆé¡µé¢æ¸²æŸ“ï¼‰
- é›†æˆè®©å®ƒä»¬é…åˆé»˜å¥‘
```

### 1.2 ä¸ºä»€ä¹ˆè¦é›†æˆ


**ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿**ï¼š

| ä¼ ç»ŸJSPæ–¹å¼ | Thymeleafé›†æˆæ–¹å¼ |
|------------|------------------|
| `éœ€è¦Servletå®¹å™¨` | `å¯ä»¥ç‹¬ç«‹é¢„è§ˆHTML` |
| `è¯­æ³•æ··ä¹±ï¼Œéš¾ç»´æŠ¤` | `çº¯HTMLè¯­æ³•ï¼Œä¼˜é›…æ¸…æ™°` |
| `å‰åç«¯è€¦åˆä¸¥é‡` | `æ¨¡æ¿å¯ç‹¬ç«‹å¼€å‘æµ‹è¯•` |
| `æ€§èƒ½è¾ƒä½` | `ç¼–è¯‘åæ€§èƒ½æ›´å¥½` |

**å®é™…ä»·å€¼**ï¼š
- **å¼€å‘æ•ˆç‡** â¬†ï¸ï¼šå‰ç«¯å¯ä»¥å…ˆå†™é™æ€é¡µé¢ï¼Œåç«¯å†å¡«æ•°æ®
- **ä»£ç è´¨é‡** â¬†ï¸ï¼šæ¨¡æ¿ä»£ç æ›´æ¸…æ™°æ˜“è¯»
- **å›¢é˜Ÿåä½œ** â¬†ï¸ï¼šå‰åç«¯åˆ†ç¦»æ›´å½»åº•

---

## 2. âš™ï¸ è§†å›¾è§£æå™¨é…ç½®


### 2.1 é…ç½®çš„æœ¬è´¨æ˜¯ä»€ä¹ˆ


**ğŸ”¸ æ ¸å¿ƒç†è§£**ï¼š
```
è§†å›¾è§£æå™¨ = ç¿»è¯‘å®˜

ä½ åœ¨Controllerå†™ï¼šreturn "user/list"
è§†å›¾è§£æå™¨ç¿»è¯‘æˆï¼š/templates/user/list.html

å°±åƒä½ è¯´"å»åƒé¥­"ï¼Œç¿»è¯‘å®˜çŸ¥é“ä½ è¦å»"é¤å…"ä¸€æ ·
```

### 2.2 Spring Bootè‡ªåŠ¨é…ç½®ï¼ˆæ¨èæ–¹å¼ï¼‰


**application.ymlé…ç½®**ï¼š
```yaml
spring:
  thymeleaf:
    # æ¨¡æ¿æ–‡ä»¶å­˜æ”¾ä½ç½®
    prefix: classpath:/templates/
    # æ¨¡æ¿æ–‡ä»¶åç¼€
    suffix: .html
    # æ¨¡æ¿ç¼–ç 
    encoding: UTF-8
    # å¼€å‘æ—¶å…³é—­ç¼“å­˜ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®å¼€å¯
    cache: false
    # æ¨¡æ¿æ¨¡å¼
    mode: HTML
```

**ğŸ” é…ç½®é¡¹è¯¦è§£**ï¼š

| é…ç½®é¡¹ | **ä½œç”¨è¯´æ˜** | **æ¨èå€¼** |
|-------|-------------|-----------|
| `prefix` | `æ¨¡æ¿æ–‡ä»¶å¤¹è·¯å¾„` | `classpath:/templates/` |
| `suffix` | `æ–‡ä»¶æ‰©å±•å` | `.html` |
| `cache` | `æ˜¯å¦ç¼“å­˜æ¨¡æ¿` | `å¼€å‘falseï¼Œç”Ÿäº§true` |
| `mode` | `æ¨¡æ¿è§£ææ¨¡å¼` | `HTML`ï¼ˆæ ‡å‡†æ¨¡å¼ï¼‰ |
| `encoding` | `æ–‡ä»¶ç¼–ç ` | `UTF-8` |

**ğŸ’¡ é…ç½®ç”Ÿæ•ˆè¿‡ç¨‹**ï¼š
```
1. Spring Bootå¯åŠ¨
2. æ‰«æåˆ°thymeleafä¾èµ–
3. è‡ªåŠ¨åˆ›å»ºè§†å›¾è§£æå™¨
4. è¯»å–application.ymlé…ç½®
5. æ³¨å†Œåˆ°Springå®¹å™¨
```

### 2.3 ä¼ ç»ŸXMLé…ç½®æ–¹å¼


```xml
<!-- Springé…ç½®æ–‡ä»¶ applicationContext.xml -->
<bean id="templateResolver" 
      class="org.thymeleaf.spring5.templateresolver.SpringResourceTemplateResolver">
    <!-- æ¨¡æ¿è·¯å¾„å‰ç¼€ -->
    <property name="prefix" value="/WEB-INF/templates/"/>
    <!-- æ¨¡æ¿åç¼€ -->
    <property name="suffix" value=".html"/>
    <!-- æ¨¡æ¿æ¨¡å¼ -->
    <property name="templateMode" value="HTML"/>
    <!-- å­—ç¬¦ç¼–ç  -->
    <property name="characterEncoding" value="UTF-8"/>
</bean>

<!-- æ¨¡æ¿å¼•æ“ -->
<bean id="templateEngine" 
      class="org.thymeleaf.spring5.SpringTemplateEngine">
    <property name="templateResolver" ref="templateResolver"/>
</bean>

<!-- è§†å›¾è§£æå™¨ -->
<bean class="org.thymeleaf.spring5.view.ThymeleafViewResolver">
    <property name="templateEngine" ref="templateEngine"/>
    <property name="characterEncoding" value="UTF-8"/>
</bean>
```

**ğŸ”¹ é…ç½®ä¸‰ä»¶å¥—ç†è§£**ï¼š
```
TemplateResolverï¼ˆæ¨¡æ¿è§£æå™¨ï¼‰
    â†“
TemplateEngineï¼ˆæ¨¡æ¿å¼•æ“ï¼‰
    â†“
ViewResolverï¼ˆè§†å›¾è§£æå™¨ï¼‰

å°±åƒï¼šåŸæ–™ â†’ åŠ å·¥è®¾å¤‡ â†’ æˆå“åŒ…è£…
```

---

## 3. ğŸ“¡ Controlleræ•°æ®ä¼ é€’


### 3.1 æ•°æ®ä¼ é€’çš„æœ¬è´¨


**é€šä¿—ç†è§£**ï¼š
> ğŸ“¦ **å¿«é€’ç±»æ¯”**ï¼šControlleræ˜¯å‘è´§æ–¹ï¼ŒThymeleafæ˜¯æ”¶è´§æ–¹ï¼Œæ•°æ®å°±æ˜¯åŒ…è£¹ã€‚éœ€è¦æ˜ç¡®å‘ä»€ä¹ˆã€æ€ä¹ˆå‘ã€å‘åˆ°å“ªé‡Œã€‚

### 3.2 å¸¸ç”¨æ•°æ®ä¼ é€’æ–¹å¼


**æ–¹å¼ä¸€ï¼šç›´æ¥ä¼ é€’å‚æ•°**
```java
@Controller
public class UserController {
    
    @GetMapping("/user/detail")
    public String userDetail(Model model) {
        // æ–¹å¼1ï¼šæ·»åŠ å•ä¸ªå±æ€§
        model.addAttribute("username", "å¼ ä¸‰");
        model.addAttribute("age", 25);
        
        return "user/detail"; // è¿”å›æ¨¡æ¿è·¯å¾„
    }
}
```

**æ–¹å¼äºŒï¼šä¼ é€’å¯¹è±¡**
```java
@GetMapping("/user/info")
public String userInfo(Model model) {
    // åˆ›å»ºç”¨æˆ·å¯¹è±¡
    User user = new User("æå››", 28, "admin");
    
    // ä¼ é€’æ•´ä¸ªå¯¹è±¡
    model.addAttribute("user", user);
    
    return "user/info";
}
```

**æ–¹å¼ä¸‰ï¼šä¼ é€’é›†åˆ**
```java
@GetMapping("/user/list")
public String userList(Model model) {
    // å‡†å¤‡ç”¨æˆ·åˆ—è¡¨
    List<User> users = Arrays.asList(
        new User("å¼ ä¸‰", 25, "user"),
        new User("æå››", 28, "admin"),
        new User("ç‹äº”", 30, "guest")
    );
    
    model.addAttribute("userList", users);
    return "user/list";
}
```

### 3.3 Thymeleafæ¨¡æ¿æ¥æ”¶æ•°æ®


```html
<!-- user/detail.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>ç”¨æˆ·è¯¦æƒ…</title>
</head>
<body>
    <!-- æ¥æ”¶ç®€å•å±æ€§ -->
    <p>å§“åï¼š<span th:text="${username}">é»˜è®¤å§“å</span></p>
    <p>å¹´é¾„ï¼š<span th:text="${age}">0</span></p>
    
    <!-- æ¥æ”¶å¯¹è±¡å±æ€§ -->
    <p>ç”¨æˆ·åï¼š<span th:text="${user.username}"></span></p>
    <p>è§’è‰²ï¼š<span th:text="${user.role}"></span></p>
    
    <!-- éå†é›†åˆ -->
    <table>
        <tr th:each="user : ${userList}">
            <td th:text="${user.username}"></td>
            <td th:text="${user.age}"></td>
        </tr>
    </table>
</body>
</html>
```

**ğŸ”‘ å…³é”®ç†è§£**ï¼š
- `${username}` â† Controllerä¸­çš„ `model.addAttribute("username", ...)`
- å±æ€§åå¿…é¡»ä¸€è‡´ï¼Œå¤§å°å†™æ•æ„Ÿ
- å¯¹è±¡ç”¨`.`è®¿é—®å±æ€§ï¼š`${user.username}`

---

## 4. ğŸ¯ Modelå¯¹è±¡æ·±å…¥


### 4.1 Modelæ˜¯ä»€ä¹ˆ


**æœ¬è´¨ç†è§£**ï¼š
```
Model = æ•°æ®çš„ä¸´æ—¶å­˜æ”¾ç®±

Controllerå¤„ç†è¯·æ±‚æ—¶ï¼š
1. åˆ›å»ºä¸€ä¸ªä¸´æ—¶ç®±å­ï¼ˆModelï¼‰
2. å¾€ç®±å­é‡Œæ”¾æ•°æ®ï¼ˆaddAttributeï¼‰
3. æŠŠç®±å­äº¤ç»™Thymeleaf
4. Thymeleafä»ç®±å­å–æ•°æ®æ¸²æŸ“é¡µé¢
5. è¯·æ±‚ç»“æŸï¼Œç®±å­é”€æ¯
```

### 4.2 Modelçš„å¤šç§å½¢å¼


**å½¢å¼å¯¹æ¯”è¡¨**ï¼š

| ç±»å‹ | **ä½¿ç”¨åœºæ™¯** | **ç‰¹ç‚¹** |
|------|------------|---------|
| `Model` | `æœ€å¸¸ç”¨` | `ç®€å•è½»é‡ï¼Œåªè´Ÿè´£ä¼ æ•°æ®` |
| `ModelMap` | `éœ€è¦Mapæ“ä½œ` | `ç»§æ‰¿LinkedHashMapï¼Œæœ‰åº` |
| `Map<String,Object>` | `ä¹ æƒ¯ç”¨Map` | `åŸç”ŸMapï¼Œçµæ´»` |

**ä»£ç ç¤ºä¾‹**ï¼š
```java
// æ–¹å¼1ï¼šä½¿ç”¨Modelï¼ˆæ¨èï¼‰
@GetMapping("/demo1")
public String demo1(Model model) {
    model.addAttribute("msg", "Hello");
    return "demo";
}

// æ–¹å¼2ï¼šä½¿ç”¨ModelMap
@GetMapping("/demo2")
public String demo2(ModelMap modelMap) {
    modelMap.addAttribute("msg", "Hello");
    return "demo";
}

// æ–¹å¼3ï¼šä½¿ç”¨Map
@GetMapping("/demo3")
public String demo3(Map<String, Object> map) {
    map.put("msg", "Hello");
    return "demo";
}
```

**ğŸ’¡ é€‰æ‹©å»ºè®®**ï¼š
- æ–°æ‰‹æ¨èç”¨ **Model**ï¼Œæœ€ç®€å•ç›´è§‚
- ä¸‰ç§æ–¹å¼åº•å±‚éƒ½ä¸€æ ·ï¼Œé€‰è‡ªå·±ä¹ æƒ¯çš„å³å¯

### 4.3 Modelçš„é«˜çº§ç”¨æ³•


**é“¾å¼æ·»åŠ **ï¼š
```java
@GetMapping("/user/profile")
public String profile(Model model) {
    model.addAttribute("name", "å¼ ä¸‰")
         .addAttribute("age", 25)
         .addAttribute("email", "zhang@example.com");
    return "user/profile";
}
```

**æ‰¹é‡æ·»åŠ **ï¼š
```java
@GetMapping("/user/batch")
public String batch(Model model) {
    Map<String, Object> data = new HashMap<>();
    data.put("name", "æå››");
    data.put("age", 28);
    data.put("city", "åŒ—äº¬");
    
    model.addAllAttributes(data);
    return "user/batch";
}
```

---

## 5. ğŸ“‹ ModelAndViewå¯¹è±¡è¯¦è§£


### 5.1 ModelAndViewæ˜¯ä»€ä¹ˆ


**æ ¸å¿ƒç†è§£**ï¼š
```
ModelAndView = Model + View çš„ç»„åˆåŒ…

æ™®é€šæ–¹å¼ï¼š
Modelè´Ÿè´£è£…æ•°æ®ï¼ŒStringè´Ÿè´£æŒ‡å®šè§†å›¾
éœ€è¦åˆ†å¼€å†™ï¼Œç¨æ˜¾å•°å—¦

ModelAndViewæ–¹å¼ï¼š
æ•°æ®å’Œè§†å›¾æ‰“åŒ…åœ¨ä¸€èµ·
ä¸€æ¬¡æå®šï¼Œæ›´ç®€æ´
```

**å¯¹æ¯”ç¤ºæ„**ï¼š
```
æ™®é€šæ–¹å¼ï¼š
Controller â†’ Modelï¼ˆæ•°æ®ï¼‰+ return "view"ï¼ˆè§†å›¾ï¼‰

ModelAndViewæ–¹å¼ï¼š
Controller â†’ ModelAndViewï¼ˆæ•°æ®+è§†å›¾ä¸€èµ·ï¼‰
```

### 5.2 åŸºæœ¬ä½¿ç”¨æ–¹æ³•


**æ–¹å¼ä¸€ï¼šæ„é€ æ—¶æŒ‡å®šè§†å›¾**
```java
@GetMapping("/user/show1")
public ModelAndView show1() {
    // åˆ›å»ºæ—¶å°±æŒ‡å®šè§†å›¾åç§°
    ModelAndView mav = new ModelAndView("user/show");
    
    // æ·»åŠ æ•°æ®
    mav.addObject("username", "å¼ ä¸‰");
    mav.addObject("age", 25);
    
    return mav;
}
```

**æ–¹å¼äºŒï¼šåç»­è®¾ç½®è§†å›¾**
```java
@GetMapping("/user/show2")
public ModelAndView show2() {
    ModelAndView mav = new ModelAndView();
    
    // å…ˆæ·»åŠ æ•°æ®
    mav.addObject("username", "æå››");
    mav.addObject("age", 28);
    
    // åè®¾ç½®è§†å›¾
    mav.setViewName("user/show");
    
    return mav;
}
```

**æ–¹å¼ä¸‰ï¼šæ·»åŠ å¯¹è±¡**
```java
@GetMapping("/user/show3")
public ModelAndView show3() {
    User user = new User("ç‹äº”", 30, "manager");
    
    ModelAndView mav = new ModelAndView("user/show");
    mav.addObject("user", user);
    
    return mav;
}
```

### 5.3 ModelAndView vs Modelå¯¹æ¯”


| ç‰¹æ€§ | **Modelæ–¹å¼** | **ModelAndViewæ–¹å¼** |
|-----|--------------|---------------------|
| `ä»£ç é£æ ¼` | `åˆ†ç¦»å¼ï¼Œæ•°æ®å’Œè§†å›¾åˆ†å¼€` | `ç»„åˆå¼ï¼Œæ•°æ®è§†å›¾ä¸€ä½“` |
| `è¿”å›å€¼` | `Stringï¼ˆè§†å›¾åï¼‰` | `ModelAndViewå¯¹è±¡` |
| `çµæ´»æ€§` | `è¾ƒé«˜ï¼Œå¯åŠ¨æ€å†³å®šè§†å›¾` | `è¾ƒä½ï¼Œéœ€æå‰ç¡®å®š` |
| `æ¨èåœºæ™¯` | `ç®€å•æ•°æ®ä¼ é€’` | `å¤æ‚é€»è¾‘ï¼Œæ•°æ®è§†å›¾ç»Ÿä¸€ç®¡ç†` |

**ğŸ¯ ä½¿ç”¨å»ºè®®**ï¼š
- **ç®€å•åœºæ™¯** â†’ ç”¨Modelï¼Œä»£ç æ›´æ¸…çˆ½
- **å¤æ‚åœºæ™¯** â†’ ç”¨ModelAndViewï¼Œé€»è¾‘æ›´æ¸…æ™°
- **å›¢é˜Ÿè§„èŒƒ** â†’ ç»Ÿä¸€é£æ ¼æœ€é‡è¦

---

## 6. ğŸ”„ RedirectAttributesä½¿ç”¨


### 6.1 ä¸ºä»€ä¹ˆéœ€è¦RedirectAttributes


**é—®é¢˜åœºæ™¯**ï¼š
```
ç”¨æˆ·æäº¤è¡¨å• â†’ ä¿å­˜æˆåŠŸ â†’ è·³è½¬åˆ°åˆ—è¡¨é¡µ â†’ æ˜¾ç¤º"ä¿å­˜æˆåŠŸ"æ¶ˆæ¯

é—®é¢˜æ¥äº†ï¼š
é‡å®šå‘åï¼ŒåŸæ¥çš„Modelæ•°æ®ä¼šä¸¢å¤±
å¦‚ä½•æŠŠ"ä¿å­˜æˆåŠŸ"çš„æ¶ˆæ¯ä¼ åˆ°ä¸‹ä¸€ä¸ªé¡µé¢ï¼Ÿ
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
> ğŸ **ç¤¼ç‰©ç›’ç±»æ¯”**ï¼šModelåƒæ™®é€šç›’å­ï¼Œè¯·æ±‚ç»“æŸå°±æ‰”äº†ã€‚RedirectAttributesåƒé¡ºä¸°å¿«é€’ï¼Œèƒ½æŠŠæ•°æ®é€åˆ°ä¸‹ä¸€ä¸ªåœ°å€ã€‚

### 6.2 RedirectAttributesçš„ä¸¤ç§å±æ€§


**å±æ€§ç±»å‹å¯¹æ¯”**ï¼š

| ç±»å‹ | **ä½œç”¨** | **URLä¸­æ˜¾ç¤º** | **ä½¿ç”¨åœºæ™¯** |
|-----|---------|--------------|-------------|
| `addAttribute` | `ä¼ é€’æ™®é€šå‚æ•°` | `âœ… æ˜¾ç¤º` | `å¯ä»¥æš´éœ²çš„æ•°æ®ï¼ˆå¦‚IDï¼‰` |
| `addFlashAttribute` | `ä¼ é€’ä¸´æ—¶æ•°æ®` | `âŒ ä¸æ˜¾ç¤º` | `æ•æ„Ÿæˆ–ä¸´æ—¶æ¶ˆæ¯` |

### 6.3 å®é™…ä½¿ç”¨ç¤ºä¾‹


**åœºæ™¯ï¼šä¿å­˜ç”¨æˆ·åé‡å®šå‘**
```java
@Controller
@RequestMapping("/user")
public class UserController {
    
    // ä¿å­˜ç”¨æˆ·
    @PostMapping("/save")
    public String saveUser(User user, RedirectAttributes attr) {
        // æ¨¡æ‹Ÿä¿å­˜æ“ä½œ
        userService.save(user);
        
        // æ–¹å¼1ï¼šæ™®é€šå±æ€§ï¼ˆURLå¯è§ï¼‰
        attr.addAttribute("id", user.getId());
        
        // æ–¹å¼2ï¼šFlashå±æ€§ï¼ˆURLä¸å¯è§ï¼‰
        attr.addFlashAttribute("message", "ä¿å­˜æˆåŠŸï¼");
        attr.addFlashAttribute("type", "success");
        
        // é‡å®šå‘åˆ°åˆ—è¡¨é¡µ
        return "redirect:/user/list";
    }
    
    // åˆ—è¡¨é¡µæ¥æ”¶æ•°æ®
    @GetMapping("/list")
    public String list(Model model) {
        // Flashå±æ€§ä¼šè‡ªåŠ¨æ·»åŠ åˆ°Modelä¸­
        // æ¨¡æ¿å¯ä»¥ç›´æ¥ä½¿ç”¨ ${message} å’Œ ${type}
        return "user/list";
    }
}
```

**URLæ•ˆæœå¯¹æ¯”**ï¼š
```
ä½¿ç”¨ addAttributeï¼š
http://localhost:8080/user/list?id=123

ä½¿ç”¨ addFlashAttributeï¼š
http://localhost:8080/user/list
ï¼ˆURLå¹²å‡€ï¼Œä½†æ•°æ®å·²ä¼ é€’ï¼‰
```

**æ¨¡æ¿æ¥æ”¶ç¤ºä¾‹**ï¼š
```html
<!-- user/list.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
    <!-- æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯ -->
    <div th:if="${message}" th:class="${'alert-' + type}">
        <span th:text="${message}"></span>
    </div>
    
    <!-- æ¥æ”¶URLå‚æ•° -->
    <p>ç”¨æˆ·ID: <span th:text="${param.id}"></span></p>
</body>
</html>
```

---

## 7. âš¡ Flashå±æ€§æœºåˆ¶


### 7.1 Flashå±æ€§çš„æœ¬è´¨


**æ ¸å¿ƒç†è§£**ï¼š
```
Flashå±æ€§ = ä¸€æ¬¡æ€§çš„ä¸´æ—¶æ•°æ®

ç‰¹ç‚¹ï¼š
1. é‡å®šå‘æ—¶æºå¸¦æ•°æ®
2. ä¸‹ä¸€æ¬¡è¯·æ±‚æ—¶å¯ç”¨
3. ä½¿ç”¨åç«‹å³é”€æ¯
4. URLä¸­ä¸æ˜¾ç¤º

å°±åƒï¼šé˜…åå³ç„šçš„æ¶ˆæ¯
```

**ç”Ÿå‘½å‘¨æœŸå›¾ç¤º**ï¼š
```
è¯·æ±‚1ï¼ˆä¿å­˜ï¼‰               è¯·æ±‚2ï¼ˆåˆ—è¡¨ï¼‰
    â†“                          â†“
addFlashAttribute         è‡ªåŠ¨æ·»åŠ åˆ°Model
    â†“                          â†“
å­˜å…¥Session                ä»Sessionå–å‡º
    â†“                          â†“
redirect                    ä½¿ç”¨åé”€æ¯
```

### 7.2 Flashå±æ€§ vs æ™®é€šSession


| ç‰¹æ€§ | **Flashå±æ€§** | **æ™®é€šSession** |
|-----|--------------|----------------|
| `ç”Ÿå‘½å‘¨æœŸ` | `ä»…ä¸‹æ¬¡è¯·æ±‚` | `æ•´ä¸ªä¼šè¯æœŸé—´` |
| `ç®¡ç†æ–¹å¼` | `è‡ªåŠ¨ç®¡ç†` | `éœ€æ‰‹åŠ¨æ¸…ç†` |
| `ä½¿ç”¨åœºæ™¯` | `ä¸€æ¬¡æ€§æ¶ˆæ¯` | `ç”¨æˆ·ç™»å½•çŠ¶æ€ç­‰` |
| `å†…å­˜å ç”¨` | `æå°` | `æŒç»­å ç”¨` |

### 7.3 å…¸å‹åº”ç”¨åœºæ™¯


**åœºæ™¯1ï¼šè¡¨å•æäº¤åé¦ˆ**
```java
@PostMapping("/user/update")
public String update(User user, RedirectAttributes attr) {
    try {
        userService.update(user);
        attr.addFlashAttribute("msg", "æ›´æ–°æˆåŠŸ");
        attr.addFlashAttribute("msgType", "success");
    } catch (Exception e) {
        attr.addFlashAttribute("msg", "æ›´æ–°å¤±è´¥ï¼š" + e.getMessage());
        attr.addFlashAttribute("msgType", "error");
    }
    return "redirect:/user/list";
}
```

**åœºæ™¯2ï¼šåˆ é™¤ç¡®è®¤æ¶ˆæ¯**
```java
@PostMapping("/user/delete/{id}")
public String delete(@PathVariable Long id, RedirectAttributes attr) {
    User user = userService.findById(id);
    userService.delete(id);
    
    attr.addFlashAttribute("deletedUser", user.getUsername());
    attr.addFlashAttribute("message", "ç”¨æˆ·å·²åˆ é™¤");
    
    return "redirect:/user/list";
}
```

**ğŸ” å®æˆ˜æŠ€å·§**ï¼š
```
âœ… æ¨èä½¿ç”¨Flashå±æ€§çš„åœºæ™¯ï¼š
- è¡¨å•æäº¤æˆåŠŸ/å¤±è´¥æ¶ˆæ¯
- æ“ä½œç¡®è®¤æç¤º
- ä¸´æ—¶é”™è¯¯ä¿¡æ¯
- éœ€è¦ä¼ é€’ä½†ä¸æƒ³åœ¨URLæ˜¾ç¤ºçš„æ•°æ®

âŒ ä¸é€‚åˆä½¿ç”¨çš„åœºæ™¯ï¼š
- éœ€è¦å¤šæ¬¡è®¿é—®çš„æ•°æ®
- ç”¨æˆ·çŠ¶æ€ä¿¡æ¯
- éœ€è¦æŒä¹…åŒ–çš„æ•°æ®
```

---

## 8. ğŸ”€ è¯·æ±‚è½¬å‘ä¸é‡å®šå‘


### 8.1 æ ¸å¿ƒåŒºåˆ«ç†è§£


**ç”Ÿæ´»ç±»æ¯”**ï¼š
```
è¯·æ±‚è½¬å‘ï¼ˆForwardï¼‰= å…¬å¸å†…éƒ¨è½¬æ¥ç”µè¯
- ä½ æ‰“ç»™å‰å°ï¼Œå‰å°å¸®ä½ è½¬åˆ°é”€å”®éƒ¨
- å¯¹å¤–åªæœ‰ä¸€æ¬¡é€šè¯
- ä½ ä¸çŸ¥é“è¢«è½¬äº†

é‡å®šå‘ï¼ˆRedirectï¼‰= é‡æ–°æ‹¨æ‰“æ–°å·ç 
- å‰å°å‘Šè¯‰ä½ é”€å”®éƒ¨å·ç 
- ä½ æŒ‚æ–­é‡æ–°æ‹¨æ‰“
- ä¸¤æ¬¡ç‹¬ç«‹é€šè¯
```

**æŠ€æœ¯å¯¹æ¯”è¡¨**ï¼š

| ç‰¹æ€§ | **è¯·æ±‚è½¬å‘ï¼ˆForwardï¼‰** | **é‡å®šå‘ï¼ˆRedirectï¼‰** |
|-----|----------------------|----------------------|
| `è¯·æ±‚æ¬¡æ•°` | `1æ¬¡` | `2æ¬¡` |
| `æµè§ˆå™¨åœ°å€æ ` | `ä¸å˜` | `æ”¹å˜` |
| `è¯·æ±‚åŸŸæ•°æ®` | `å…±äº«` | `ä¸å…±äº«` |
| `é€‚ç”¨èŒƒå›´` | `åªèƒ½å†…éƒ¨è·³è½¬` | `å¯è·³è½¬ä»»æ„URL` |
| `æ€§èƒ½` | `å¿«` | `ç¨æ…¢` |

### 8.2 è¯·æ±‚è½¬å‘ç”¨æ³•


**è¯­æ³•æ ¼å¼**ï¼š
```java
// æ–¹å¼1ï¼šè¿”å›å­—ç¬¦ä¸²
return "forward:/user/list";

// æ–¹å¼2ï¼šä½¿ç”¨ModelAndView
ModelAndView mav = new ModelAndView("forward:/user/detail");
```

**å®Œæ•´ç¤ºä¾‹**ï¼š
```java
@Controller
@RequestMapping("/order")
public class OrderController {
    
    // æäº¤è®¢å•
    @PostMapping("/submit")
    public String submit(Order order, Model model) {
        // ä¿å­˜è®¢å•
        orderService.save(order);
        
        // è½¬å‘åˆ°è®¢å•è¯¦æƒ…ï¼ˆæ•°æ®å…±äº«ï¼‰
        model.addAttribute("order", order);
        model.addAttribute("message", "è®¢å•æäº¤æˆåŠŸ");
        
        return "forward:/order/detail";
    }
    
    // è®¢å•è¯¦æƒ…ï¼ˆæ¥æ”¶è½¬å‘çš„æ•°æ®ï¼‰
    @RequestMapping("/detail")
    public String detail(Model model) {
        // å¯ä»¥ç›´æ¥ä½¿ç”¨è½¬å‘è¿‡æ¥çš„æ•°æ®
        // modelä¸­å·²ç»æœ‰orderå’Œmessage
        return "order/detail";
    }
}
```

**ğŸ” æ•°æ®æµåŠ¨ç¤ºæ„**ï¼š
```
ç”¨æˆ·æäº¤è¡¨å•
    â†“
/order/submitï¼ˆå¤„ç†+å‡†å¤‡æ•°æ®ï¼‰
    â†“ forwardï¼ˆæºå¸¦Modelæ•°æ®ï¼‰
/order/detailï¼ˆæ¥æ”¶æ•°æ®+æ¸²æŸ“é¡µé¢ï¼‰
    â†“
è¿”å›HTMLç»™ç”¨æˆ·

æµè§ˆå™¨åœ°å€æ ï¼š/order/submitï¼ˆå§‹ç»ˆä¸å˜ï¼‰
```

### 8.3 é‡å®šå‘ç”¨æ³•


**è¯­æ³•æ ¼å¼**ï¼š
```java
// æ–¹å¼1ï¼šè¿”å›å­—ç¬¦ä¸²
return "redirect:/user/list";

// æ–¹å¼2ï¼šä½¿ç”¨ModelAndView
ModelAndView mav = new ModelAndView("redirect:/user/list");
```

**å®Œæ•´ç¤ºä¾‹**ï¼š
```java
@Controller
@RequestMapping("/product")
public class ProductController {
    
    // æ·»åŠ å•†å“
    @PostMapping("/add")
    public String add(Product product, RedirectAttributes attr) {
        // ä¿å­˜å•†å“
        productService.save(product);
        
        // é‡å®šå‘åˆ°åˆ—è¡¨ï¼ˆä½¿ç”¨RedirectAttributesä¼ é€’æ¶ˆæ¯ï¼‰
        attr.addFlashAttribute("successMsg", "å•†å“æ·»åŠ æˆåŠŸ");
        attr.addAttribute("categoryId", product.getCategoryId());
        
        return "redirect:/product/list";
    }
    
    // å•†å“åˆ—è¡¨
    @GetMapping("/list")
    public String list(@RequestParam Long categoryId, Model model) {
        // åŠ è½½å•†å“åˆ—è¡¨
        List<Product> products = productService.findByCategory(categoryId);
        model.addAttribute("products", products);
        
        // successMsgä¼šè‡ªåŠ¨ä»Flashå±æ€§æ·»åŠ åˆ°Model
        return "product/list";
    }
}
```

**ğŸ” æ•°æ®æµåŠ¨ç¤ºæ„**ï¼š
```
ç”¨æˆ·æäº¤è¡¨å•
    â†“
/product/addï¼ˆå¤„ç†ä¸šåŠ¡é€»è¾‘ï¼‰
    â†“ redirectï¼ˆå‘é€302å“åº”ï¼‰
æµè§ˆå™¨æ¥æ”¶é‡å®šå‘æŒ‡ä»¤
    â†“
æµè§ˆå™¨å‘èµ·æ–°è¯·æ±‚ï¼š/product/list?categoryId=1
    â†“
/product/listï¼ˆå¤„ç†æ–°è¯·æ±‚ï¼‰
    â†“
è¿”å›HTMLç»™ç”¨æˆ·

æµè§ˆå™¨åœ°å€æ ï¼š/product/list?categoryId=1
```

### 8.4 é€‰æ‹©ä½¿ç”¨å»ºè®®


**ğŸ¯ ä½¿ç”¨å†³ç­–æ ‘**ï¼š

```
æ•°æ®æäº¤åè¦æ˜¾ç¤ºç»“æœï¼Ÿ
    â†“
   æ˜¯ â†’ ç”¨æˆ·å¯èƒ½åˆ·æ–°é¡µé¢ï¼Ÿ
         â†“
        æ˜¯ â†’ ç”¨é‡å®šå‘ï¼ˆé˜²æ­¢é‡å¤æäº¤ï¼‰
        å¦ â†’ ç”¨è¯·æ±‚è½¬å‘ï¼ˆæ€§èƒ½æ›´å¥½ï¼‰
    â†“
   å¦ â†’ ä»…éœ€å†…éƒ¨è·³è½¬ï¼Ÿ
         â†“
        æ˜¯ â†’ ç”¨è¯·æ±‚è½¬å‘
        å¦ â†’ ç”¨é‡å®šå‘
```

**ğŸ“‹ åœºæ™¯é€ŸæŸ¥è¡¨**ï¼š

| åœºæ™¯ | **æ¨èæ–¹å¼** | **åŸå› ** |
|-----|------------|---------|
| `è¡¨å•æäº¤åè·³è½¬` | `Redirect` | `é˜²æ­¢åˆ·æ–°é‡å¤æäº¤` |
| `å†…éƒ¨é€»è¾‘è·³è½¬` | `Forward` | `æ€§èƒ½å¥½ï¼Œæ•°æ®å…±äº«` |
| `å¤–éƒ¨URLè·³è½¬` | `Redirect` | `Forwardæ— æ³•è·¨åŸŸ` |
| `ç™»å½•åè·³é¦–é¡µ` | `Redirect` | `åœ°å€æ æ›´æ–°ï¼Œä½“éªŒå¥½` |
| `é”™è¯¯é¡µé¢è·³è½¬` | `Forward` | `ä¿ç•™é”™è¯¯ä¿¡æ¯` |

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ”¸ é…ç½®ç†è§£**ï¼š
```
è§†å›¾è§£æå™¨ = è·¯å¾„ç¿»è¯‘å™¨
prefix + é€»è¾‘è§†å›¾å + suffix = å®é™…æ¨¡æ¿è·¯å¾„
/templates/ + "user/list" + .html = /templates/user/list.html
```

**ğŸ”¸ æ•°æ®ä¼ é€’é“¾**ï¼š
```
Controller â†’ Model/ModelAndView â†’ ViewResolver â†’ Thymeleaf â†’ HTML

å…³é”®ç‚¹ï¼š
- Controllerå‡†å¤‡æ•°æ®
- Model/ModelAndViewè£…è½½æ•°æ®
- è§†å›¾è§£æå™¨å®šä½æ¨¡æ¿
- Thymeleafæ¸²æŸ“é¡µé¢
```

**ğŸ”¸ é‡å®šå‘vsè½¬å‘**ï¼š
```
Forwardï¼šå†…éƒ¨è½¬æ¥ï¼Œæ•°æ®å…±äº«ï¼Œä¸€æ¬¡è¯·æ±‚
Redirectï¼šé‡æ–°è¯·æ±‚ï¼Œæ•°æ®éš”ç¦»ï¼Œä¸¤æ¬¡è¯·æ±‚

è®°å¿†å£è¯€ï¼š
è½¬å‘å¿«é€Ÿå†…éƒ¨ä¼ ï¼Œé‡å®šå‘å®‰å…¨å¤–éƒ¨è¿
```

### 9.2 å®æˆ˜ç»éªŒæ€»ç»“


**âœ… æœ€ä½³å®è·µ**ï¼š
```
1. å¼€å‘ç¯å¢ƒå…³é—­æ¨¡æ¿ç¼“å­˜
   spring.thymeleaf.cache=false

2. è¡¨å•æäº¤åç”¨é‡å®šå‘
   é˜²æ­¢åˆ·æ–°é‡å¤æäº¤

3. æ•æ„Ÿæ•°æ®ç”¨Flashå±æ€§
   ä¸åœ¨URLæš´éœ²ä¿¡æ¯

4. å¤æ‚æ•°æ®ç”¨ModelAndView
   ä»£ç ç»“æ„æ›´æ¸…æ™°

5. å†…éƒ¨è·³è½¬ç”¨è¯·æ±‚è½¬å‘
   æ€§èƒ½æ›´å¥½
```

**âŒ å¸¸è§é”™è¯¯**ï¼š
```
1. å¿˜è®°é…ç½®æ¨¡æ¿è·¯å¾„
   ç»“æœï¼š404æ‰¾ä¸åˆ°æ¨¡æ¿

2. Modelå±æ€§åä¸æ¨¡æ¿ä¸ä¸€è‡´
   ç»“æœï¼šæ•°æ®æ˜¾ç¤ºä¸å‡ºæ¥

3. é‡å®šå‘åç›´æ¥ç”¨Modelä¼ æ•°æ®
   ç»“æœï¼šæ•°æ®ä¸¢å¤±

4. Flashå±æ€§ä½¿ç”¨åå†æ¬¡è®¿é—®
   ç»“æœï¼šæ•°æ®å·²é”€æ¯

5. è½¬å‘å’Œé‡å®šå‘æ··æ·†ä½¿ç”¨
   ç»“æœï¼šé€»è¾‘é”™è¯¯
```

### 9.3 è®°å¿†æŠ€å·§


**ğŸ§  æ ¸å¿ƒå£è¯€**ï¼š
```
è§†å›¾é…ç½®å®šè·¯å¾„ï¼Œå‰ç¼€åç¼€æ‹¼å®Œæ•´
Modelè£…æ•°æ®ä¼ æ¨¡æ¿ï¼Œå±æ€§åç§°è¦å¯¹åº”
è½¬å‘å¿«é€Ÿå…±äº«å¼ºï¼Œé‡å®šå‘å®‰å…¨é˜²é‡æ”¾
Flashå±æ€§ä¸€æ¬¡ç”¨ï¼ŒRedirectAttributesé€æ•°æ®é€š
```

**ğŸ“Š çŸ¥è¯†å›¾è°±**ï¼š
```
Spring MVCé›†æˆ
    â”œâ”€â”€ é…ç½®å±‚
    â”‚   â”œâ”€â”€ è§†å›¾è§£æå™¨
    â”‚   â”œâ”€â”€ æ¨¡æ¿å¼•æ“
    â”‚   â””â”€â”€ è‡ªåŠ¨é…ç½®
    â”‚
    â”œâ”€â”€ æ•°æ®ä¼ é€’
    â”‚   â”œâ”€â”€ Model
    â”‚   â”œâ”€â”€ ModelAndView
    â”‚   â””â”€â”€ RedirectAttributes
    â”‚
    â”œâ”€â”€ è·³è½¬æ–¹å¼
    â”‚   â”œâ”€â”€ è¯·æ±‚è½¬å‘ï¼ˆforwardï¼‰
    â”‚   â””â”€â”€ é‡å®šå‘ï¼ˆredirectï¼‰
    â”‚
    â””â”€â”€ Flashæœºåˆ¶
        â”œâ”€â”€ addFlashAttribute
        â””â”€â”€ ä¸€æ¬¡æ€§æ•°æ®ä¼ é€’
```

### 9.4 å­¦ä¹ æ£€æŸ¥æ¸…å•


**âœ… è‡ªæˆ‘æ£€æµ‹**ï¼š
- [ ] èƒ½é…ç½®Thymeleafè§†å›¾è§£æå™¨
- [ ] ç†è§£Modelã€ModelAndViewåŒºåˆ«
- [ ] ä¼šä½¿ç”¨RedirectAttributesä¼ é€’æ•°æ®
- [ ] æ¸…æ¥šForwardå’ŒRedirectçš„åŒºåˆ«
- [ ] æŒæ¡Flashå±æ€§çš„ä½¿ç”¨åœºæ™¯
- [ ] èƒ½è§£å†³å¸¸è§çš„404å’Œæ•°æ®ä¼ é€’é—®é¢˜

**ğŸ¯ å®æˆ˜ç»ƒä¹ å»ºè®®**ï¼š
1. æ­å»ºä¸€ä¸ªç®€å•çš„ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ
2. å®ç°å¢åˆ æ”¹æŸ¥åŠŸèƒ½
3. ä½¿ç”¨é‡å®šå‘+Flashå±æ€§æ˜¾ç¤ºæ“ä½œç»“æœ
4. ä½“ä¼šè½¬å‘å’Œé‡å®šå‘çš„åŒºåˆ«

---

**ğŸ“ å­¦ä¹ å¯„è¯­**ï¼š
> Thymeleafä¸Spring MVCçš„é›†æˆæ˜¯Webå¼€å‘çš„åŸºç¡€ï¼ŒæŒæ¡å®ƒå°±åƒå­¦ä¼šäº†å¦‚ä½•ç”¨ç”»ç¬”åœ¨ç”»å¸ƒä¸Šä½œç”»ã€‚å¤šåŠ¨æ‰‹å®è·µï¼Œç†è®ºç»“åˆå®é™…ï¼Œä½ ä¼šå‘ç°åŸæ¥Webå¼€å‘ä¹Ÿå¯ä»¥è¿™ä¹ˆä¼˜é›…ï¼