---
title: 3、c_set与c_remove变量操作
---
## 📚 目录

1. [变量操作标签概述](#1-变量操作标签概述)
2. [c:set标签详解](#2-c-set标签详解)
3. [c:remove标签详解](#3-c-remove标签详解)
4. [作用域管理详解](#4-作用域管理详解)
5. [对象属性操作](#5-对象属性操作)
6. [实际应用场景](#6-实际应用场景)
7. [核心要点总结](#7-核心要点总结)

---

## 1. 🎯 变量操作标签概述


### 1.1 什么是变量操作标签


**简单理解**：就像我们在Java代码中定义变量和删除变量一样，JSTL提供了在JSP页面中操作变量的标签。

```
想象一个场景：
在JSP页面中，我们需要：
- 创建一个变量存储用户名 → 用c:set
- 计算一个结果并保存 → 用c:set  
- 用完后清理变量 → 用c:remove
```

### 1.2 核心标签介绍


**两个主要标签**：

| 标签名 | **作用** | **类比理解** |
|--------|---------|-------------|
| `<c:set>` | `设置/创建变量` | `就像Java中的 String name = "张三"` |
| `<c:remove>` | `删除变量` | `把变量从内存中清除掉` |

### 1.3 为什么需要这些标签


**实际开发中的需求**：
- 📝 **临时计算**：页面中需要临时存储计算结果
- 🔄 **数据处理**：对从后台传来的数据进行加工
- 🎯 **条件判断**：根据不同情况设置不同的变量值
- 🧹 **内存管理**：及时清理不再需要的变量

---

## 2. 📝 c:set标签详解


### 2.1 基本语法格式


**两种常用写法**：

```jsp
<!-- 写法1：直接设置值 -->
<c:set var="变量名" value="变量值" scope="作用域"/>

<!-- 写法2：标签体内容作为值 -->
<c:set var="变量名" scope="作用域">
    这里的内容会作为变量的值
</c:set>
```

### 2.2 核心属性详解


#### 🔤 var属性 - 变量名


**作用**：指定要创建的变量名称

```jsp
<!-- 创建一个叫userName的变量 -->
<c:set var="userName" value="张三"/>

<!-- 就相当于Java中的 -->
<%-- String userName = "张三"; --%>
```

**⚠️ 注意**：
- 变量名要符合Java标识符规范
- 建议使用驼峰命名：`userName`、`userAge`

#### 💎 value属性 - 变量值


**作用**：指定变量的值

```jsp
<!-- 设置字符串值 -->
<c:set var="message" value="欢迎来到我的网站"/>

<!-- 设置数字值 -->
<c:set var="age" value="25"/>

<!-- 使用EL表达式设置值 -->
<c:set var="currentUser" value="${sessionScope.user}"/>

<!-- 计算结果作为值 -->
<c:set var="total" value="${price * quantity}"/>
```

#### 🌐 scope属性 - 作用域


**作用**：指定变量存储在哪个作用域中

**四种作用域选择**：

```
作用域理解（从小到大）：
┌─────────────┐
│ page（页面）  │ ← 只在当前页面有效
├─────────────┤
│ request     │ ← 一次请求期间有效
├─────────────┤  
│ session     │ ← 用户会话期间有效
├─────────────┤
│ application │ ← 整个应用期间有效
└─────────────┘
```

**使用示例**：

```jsp
<!-- 页面级变量（默认） -->
<c:set var="pageVar" value="页面变量" scope="page"/>

<!-- 请求级变量 -->
<c:set var="requestVar" value="请求变量" scope="request"/>

<!-- 会话级变量 -->
<c:set var="sessionVar" value="会话变量" scope="session"/>

<!-- 应用级变量 -->
<c:set var="appVar" value="应用变量" scope="application"/>
```

### 2.3 实际使用示例


#### 📊 基础变量设置


```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>

<!-- 设置用户信息 -->
<c:set var="userName" value="张三" scope="session"/>
<c:set var="userAge" value="25"/>
<c:set var="isVip" value="true"/>

<!-- 在页面中使用这些变量 -->
<h2>用户信息</h2>
<p>姓名：${userName}</p>
<p>年龄：${userAge}</p>
<p>VIP用户：${isVip}</p>
```

#### 🔢 计算型变量设置


```jsp
<!-- 假设从后台传来商品信息 -->
<c:set var="price" value="99.8"/>
<c:set var="quantity" value="3"/>
<c:set var="discount" value="0.8"/>

<!-- 计算总价 -->
<c:set var="subtotal" value="${price * quantity}"/>
<c:set var="finalTotal" value="${subtotal * discount}"/>

<div class="order-summary">
    <p>单价：￥${price}</p>
    <p>数量：${quantity}</p>
    <p>小计：￥${subtotal}</p>
    <p>折扣后总价：￥${finalTotal}</p>
</div>
```

#### 🎨 标签体内容作为值


```jsp
<!-- 使用标签体设置复杂内容 -->
<c:set var="welcomeMessage">
    <div class="welcome">
        <h3>欢迎 ${user.name} 回来！</h3>
        <p>您上次登录时间：${user.lastLoginTime}</p>
    </div>
</c:set>

<!-- 然后在页面中使用 -->
${welcomeMessage}
```

---

## 3. 🗑️ c:remove标签详解


### 3.1 基本语法格式


```jsp
<!-- 删除指定作用域中的变量 -->
<c:remove var="变量名" scope="作用域"/>

<!-- 删除所有作用域中的同名变量（不推荐） -->
<c:remove var="变量名"/>
```

### 3.2 核心属性说明


#### 🎯 var属性 - 要删除的变量名


```jsp
<!-- 删除名为userName的变量 -->
<c:remove var="userName" scope="session"/>
```

#### 🌐 scope属性 - 指定作用域


**为什么要指定作用域**：
- 不同作用域可能有同名变量
- 精确删除避免误删
- 提高程序的可控性

```jsp
<!-- 只删除session作用域中的userName -->
<c:remove var="userName" scope="session"/>

<!-- 只删除request作用域中的userName -->
<c:remove var="userName" scope="request"/>
```

### 3.3 删除操作示例


#### 🧹 基础删除操作


```jsp
<!-- 先设置变量 -->
<c:set var="tempData" value="临时数据" scope="request"/>
<c:set var="tempData" value="会话数据" scope="session"/>

<!-- 使用变量 -->
<p>请求中的数据：${requestScope.tempData}</p>
<p>会话中的数据：${sessionScope.tempData}</p>

<!-- 删除特定作用域的变量 -->
<c:remove var="tempData" scope="request"/>

<!-- 现在只能看到会话中的数据 -->
<p>删除后：${tempData}</p> <!-- 会显示"会话数据" -->
```

#### 🔄 条件性删除


```jsp
<!-- 根据条件决定是否删除变量 -->
<c:if test="${user.isGuest}">
    <!-- 如果是游客，删除个人信息 -->
    <c:remove var="personalInfo" scope="session"/>
    <c:remove var="shoppingCart" scope="session"/>
</c:if>
```

#### 🎯 批量清理示例


```jsp
<!-- 用户退出时清理所有用户相关变量 -->
<c:remove var="currentUser" scope="session"/>
<c:remove var="userPermissions" scope="session"/>
<c:remove var="userPreferences" scope="session"/>
<c:remove var="shoppingCart" scope="session"/>

<p>用户已安全退出！</p>
```

---

## 4. 🏠 作用域管理详解


### 4.1 四种作用域的生命周期


**生命周期对比图**：

```
时间轴:  页面创建 → 页面结束 → 请求结束 → 会话结束 → 应用关闭
        ├────────┤
        page作用域
        ├─────────────────┤  
        request作用域
        ├──────────────────────────────────┤
        session作用域
        ├─────────────────────────────────────────────────────┤
        application作用域
```

### 4.2 作用域选择策略


| 使用场景 | **推荐作用域** | **理由** |
|---------|-------------|---------|
| `页面临时计算` | **page** | `计算完就不需要了` |
| `表单数据处理` | **request** | `一次请求处理完就行` |
| `用户登录信息` | **session** | `用户在线期间都需要` |
| `系统配置信息` | **application** | `所有用户共享` |

### 4.3 作用域实际应用示例


```jsp
<%-- 购物网站的变量管理示例 --%>

<!-- 页面级：临时计算 -->
<c:set var="itemCount" value="${fn:length(cartItems)}" scope="page"/>

<!-- 请求级：本次操作的结果 -->
<c:set var="operationResult" value="商品添加成功" scope="request"/>

<!-- 会话级：用户状态 -->
<c:set var="currentUser" value="${loginUser}" scope="session"/>
<c:set var="cartTotal" value="${calculateTotal}" scope="session"/>

<!-- 应用级：系统配置 -->
<c:set var="siteName" value="我的购物网站" scope="application"/>
<c:set var="maxUploadSize" value="10485760" scope="application"/>
```

---

## 5. 🎯 对象属性操作


### 5.1 target和property属性


**除了设置变量，还可以设置对象的属性**：

```jsp
<!-- 设置对象的属性值 -->
<c:set target="对象" property="属性名" value="新值"/>
```

### 5.2 操作JavaBean属性


**假设有一个User对象**：

```jsp
<!-- 创建或获取User对象 -->
<jsp:useBean id="user" class="com.example.User" scope="request"/>

<!-- 设置User对象的属性 -->
<c:set target="${user}" property="name" value="李四"/>
<c:set target="${user}" property="age" value="30"/>
<c:set target="${user}" property="email" value="lisi@example.com"/>

<!-- 显示设置后的结果 -->
<p>用户名：${user.name}</p>
<p>年龄：${user.age}</p>
<p>邮箱：${user.email}</p>
```

### 5.3 操作Map集合


```jsp
<!-- 创建一个Map -->
<c:set var="userInfo" value="${{}}"/>

<!-- 向Map中添加键值对 -->
<c:set target="${userInfo}" property="username" value="张三"/>
<c:set target="${userInfo}" property="role" value="管理员"/>

<!-- 使用Map中的值 -->
<p>用户：${userInfo.username}</p>
<p>角色：${userInfo.role}</p>
```

---

## 6. 🚀 实际应用场景


### 6.1 用户登录状态管理


```jsp
<%-- 用户登录处理页面 --%>

<!-- 验证登录后设置用户信息 -->
<c:if test="${loginSuccess}">
    <c:set var="currentUser" value="${user}" scope="session"/>
    <c:set var="isLoggedIn" value="true" scope="session"/>
    <c:set var="loginTime" value="${now}" scope="session"/>
</c:if>

<!-- 用户退出时清理 -->
<c:if test="${param.action == 'logout'}">
    <c:remove var="currentUser" scope="session"/>
    <c:remove var="isLoggedIn" scope="session"/>
    <c:remove var="loginTime" scope="session"/>
</c:if>
```

### 6.2 购物车金额计算


```jsp
<%-- 购物车页面的价格计算 --%>

<!-- 初始化总价 -->
<c:set var="totalAmount" value="0" scope="page"/>

<!-- 遍历购物车商品累加价格 -->
<c:forEach items="${cartItems}" var="item">
    <c:set var="itemTotal" value="${item.price * item.quantity}"/>
    <c:set var="totalAmount" value="${totalAmount + itemTotal}"/>
    
    <div class="cart-item">
        <span>${item.name}</span>
        <span>￥${item.price} × ${item.quantity} = ￥${itemTotal}</span>
    </div>
</c:forEach>

<!-- 计算优惠后价格 -->
<c:set var="discount" value="${user.vip ? 0.9 : 1.0}"/>
<c:set var="finalAmount" value="${totalAmount * discount}"/>

<div class="total-section">
    <p>商品总价：￥${totalAmount}</p>
    <c:if test="${user.vip}">
        <p>VIP折扣：9折</p>
    </c:if>
    <p><strong>实付金额：￥${finalAmount}</strong></p>
</div>
```

### 6.3 表单数据预处理


```jsp
<%-- 表单提交前的数据处理 --%>

<!-- 获取表单数据并进行处理 -->
<c:set var="originalName" value="${param.userName}"/>
<c:set var="trimmedName" value="${fn:trim(originalName)}"/>
<c:set var="upperName" value="${fn:toUpperCase(trimmedName)}"/>

<!-- 验证数据 -->
<c:set var="isValidName" value="${fn:length(trimmedName) > 0}"/>
<c:set var="isValidEmail" value="${fn:contains(param.email, '@')}"/>

<!-- 根据验证结果设置消息 -->
<c:choose>
    <c:when test="${isValidName && isValidEmail}">
        <c:set var="message" value="数据验证通过" scope="request"/>
    </c:when>
    <c:otherwise>
        <c:set var="message" value="请检查输入数据" scope="request"/>
    </c:otherwise>
</c:choose>
```

### 6.4 页面主题切换


```jsp
<%-- 网站主题切换功能 --%>

<!-- 根据用户偏好设置主题 -->
<c:choose>
    <c:when test="${param.theme == 'dark'}">
        <c:set var="cssTheme" value="dark-theme.css" scope="session"/>
        <c:set var="bodyClass" value="dark" scope="session"/>
    </c:when>
    <c:when test="${param.theme == 'light'}">
        <c:set var="cssTheme" value="light-theme.css" scope="session"/>
        <c:set var="bodyClass" value="light" scope="session"/>
    </c:when>
    <c:otherwise>
        <!-- 使用默认主题 -->
        <c:set var="cssTheme" value="default-theme.css" scope="session"/>
        <c:set var="bodyClass" value="default" scope="session"/>
    </c:otherwise>
</c:choose>

<!-- 在HTML中应用主题 -->
<html>
<head>
    <link rel="stylesheet" href="css/${cssTheme}">
</head>
<body class="${bodyClass}">
    <!-- 页面内容 -->
</body>
</html>
```

---

## 7. 📋 核心要点总结


### 7.1 必须掌握的基本概念


```
🔸 c:set：在JSP页面中创建和设置变量的标签
🔸 c:remove：删除不需要的变量，释放内存
🔸 作用域：page < request < session < application
🔸 变量操作：既可以设置简单值，也可以操作对象属性
🔸 内存管理：及时清理不需要的变量是好习惯
```

### 7.2 关键理解要点


**🔹 c:set的两种用法**
```
直接设置值：<c:set var="name" value="张三"/>
标签体设置：<c:set var="html">复杂的HTML内容</c:set>
```

**🔹 作用域选择原则**
```
能用小的就不用大的：
- 临时计算 → page
- 一次请求 → request  
- 用户会话 → session
- 全局共享 → application
```

**🔹 什么时候需要c:remove**
```
用户退出 → 清理用户信息
操作完成 → 清理临时变量
内存优化 → 清理大对象
安全考虑 → 清理敏感数据
```

### 7.3 实际开发建议


**💡 最佳实践**：
- ✅ **明确作用域**：总是指定scope属性
- ✅ **及时清理**：不需要的变量要删除
- ✅ **命名规范**：使用有意义的变量名
- ✅ **避免覆盖**：注意同名变量的覆盖问题

**⚠️ 常见误区**：
- ❌ 不指定作用域（默认page可能不够用）
- ❌ 忘记清理临时变量（浪费内存）
- ❌ 在循环中重复设置同一变量
- ❌ 混淆EL表达式和JSTL标签的使用场景

### 7.4 记忆口诀


```
🎯 变量操作很简单：
set设置remove删，
作用域要选对，
page小request中，
session存用户，
application全局用。
用完记得要清理，
内存安全都重要！
```

**核心记住**：
- **c:set** = 创建/设置变量，就像Java中的赋值
- **c:remove** = 删除变量，释放内存空间  
- **scope** = 变量的生存范围，选择合适很重要
- **实际应用** = 登录状态、购物车、临时计算都离不开它们