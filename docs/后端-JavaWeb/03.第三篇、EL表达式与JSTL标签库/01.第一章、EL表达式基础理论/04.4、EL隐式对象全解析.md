---
title: 4ã€ELéšå¼å¯¹è±¡å…¨è§£æ
---
## ğŸ“š ç›®å½•

1. [ELéšå¼å¯¹è±¡æ¦‚è¿°](#1-ELéšå¼å¯¹è±¡æ¦‚è¿°)
2. [ä½œç”¨åŸŸç›¸å…³éšå¼å¯¹è±¡](#2-ä½œç”¨åŸŸç›¸å…³éšå¼å¯¹è±¡)
3. [è¯·æ±‚å‚æ•°éšå¼å¯¹è±¡](#3-è¯·æ±‚å‚æ•°éšå¼å¯¹è±¡)
4. [è¯·æ±‚å¤´éšå¼å¯¹è±¡](#4-è¯·æ±‚å¤´éšå¼å¯¹è±¡)
5. [Cookieéšå¼å¯¹è±¡](#5-Cookieéšå¼å¯¹è±¡)
6. [å…¶ä»–é‡è¦éšå¼å¯¹è±¡](#6-å…¶ä»–é‡è¦éšå¼å¯¹è±¡)
7. [éšå¼å¯¹è±¡ç»¼åˆåº”ç”¨](#7-éšå¼å¯¹è±¡ç»¼åˆåº”ç”¨)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒŸ ELéšå¼å¯¹è±¡æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯ELéšå¼å¯¹è±¡


**ğŸ”¸ é€šä¿—ç†è§£**
ELéšå¼å¯¹è±¡å°±åƒæ˜¯JSPé¡µé¢ä¸­çš„"ç°æˆå·¥å…·ç®±"ï¼Œä¸éœ€è¦ä½ è‡ªå·±åˆ›å»ºï¼Œç›´æ¥å°±èƒ½ä½¿ç”¨ã€‚

```
æ¯”å¦‚ç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼š
ä½ è¿›å…¥é…’åº—æˆ¿é—´ï¼Œé‡Œé¢å·²ç»å‡†å¤‡å¥½äº†ï¼š
- ç”µè§†é¥æ§å™¨ (pageScope)
- æˆ¿é—´ç”µè¯ (param)  
- æœåŠ¡æŒ‡å— (header)
- è¿·ä½ å†°ç®± (cookie)

è¿™äº›éƒ½æ˜¯"éšå¼"å‡†å¤‡å¥½çš„ï¼Œä¸ç”¨ä½ è‡ªå·±å¸¦ï¼
```

**ğŸ”¸ æŠ€æœ¯å®šä¹‰**
éšå¼å¯¹è±¡æ˜¯ELè¡¨è¾¾å¼æä¾›çš„é¢„å®šä¹‰å¯¹è±¡ï¼Œç”¨äºè®¿é—®JSPé¡µé¢çš„å„ç§æ•°æ®å’Œä¿¡æ¯ï¼Œæ— éœ€æ˜¾å¼å£°æ˜å³å¯ç›´æ¥ä½¿ç”¨ã€‚

### 1.2 éšå¼å¯¹è±¡çš„åˆ†ç±»ä½“ç³»


```
ELéšå¼å¯¹è±¡å…¨å®¶ç¦ï¼š
â”Œâ”€ ä½œç”¨åŸŸè®¿é—®ç±»
â”‚  â”œâ”€ pageScope     (é¡µé¢ä½œç”¨åŸŸ)
â”‚  â”œâ”€ requestScope  (è¯·æ±‚ä½œç”¨åŸŸ) 
â”‚  â”œâ”€ sessionScope  (ä¼šè¯ä½œç”¨åŸŸ)
â”‚  â””â”€ applicationScope (åº”ç”¨ä½œç”¨åŸŸ)
â”œâ”€ è¯·æ±‚å‚æ•°ç±»
â”‚  â”œâ”€ param         (å•å€¼å‚æ•°)
â”‚  â””â”€ paramValues   (å¤šå€¼å‚æ•°)
â”œâ”€ è¯·æ±‚å¤´ç±»  
â”‚  â”œâ”€ header        (å•å€¼å¤´ä¿¡æ¯)
â”‚  â””â”€ headerValues  (å¤šå€¼å¤´ä¿¡æ¯)
â”œâ”€ Cookieç±»
â”‚  â””â”€ cookie        (Cookieå¯¹è±¡)
â””â”€ å…¶ä»–å·¥å…·ç±»
   â”œâ”€ initParam     (åˆå§‹åŒ–å‚æ•°)
   â””â”€ pageContext   (é¡µé¢ä¸Šä¸‹æ–‡)
```

### 1.3 ä¸ºä»€ä¹ˆéœ€è¦éšå¼å¯¹è±¡


**ğŸ¯ è§£å†³çš„æ ¸å¿ƒé—®é¢˜**
- **ç®€åŒ–è®¿é—®**ï¼šä¸ç”¨å†™å¤æ‚çš„Javaä»£ç è·å–æ•°æ®
- **ç»Ÿä¸€æ¥å£**ï¼šæä¾›ä¸€è‡´çš„æ•°æ®è®¿é—®æ–¹å¼  
- **ç±»å‹å®‰å…¨**ï¼šé¿å…å¼ºåˆ¶ç±»å‹è½¬æ¢çš„éº»çƒ¦

**ğŸ’¡ å¯¹æ¯”è¯´æ˜**

| ä¼ ç»Ÿæ–¹å¼ | ELéšå¼å¯¹è±¡æ–¹å¼ | ä¼˜åŠ¿ |
|---------|---------------|------|
| `request.getParameter("name")` | `${param.name}` | **ç®€æ´ç›´è§‚** |
| `session.getAttribute("user")` | `${sessionScope.user}` | **æ˜“äºç†è§£** |
| `request.getHeader("User-Agent")` | `${header['User-Agent']}` | **è¯­æ³•ç»Ÿä¸€** |

---

## 2. ğŸ“¦ ä½œç”¨åŸŸç›¸å…³éšå¼å¯¹è±¡


### 2.1 å››å¤§ä½œç”¨åŸŸå¯¹è±¡è¯¦è§£


**ğŸ  ä½œç”¨åŸŸæ¦‚å¿µå›é¡¾**

```
æƒ³è±¡ä¸€ä¸ªå…¬å¸çš„ä¿¡æ¯ä¼ é€’ï¼š

pageScope     â†’ ä¸ªäººåŠå…¬æ¡Œ (å½“å‰é¡µé¢)
requestScope  â†’ éƒ¨é—¨ä¼šè®®å®¤ (ä¸€æ¬¡è¯·æ±‚)  
sessionScope  â†’ ä¸ªäººå‚¨ç‰©æŸœ (ä¸€æ¬¡ä¼šè¯)
applicationScope â†’ å…¬å¸å…¬å‘Šæ¿ (æ•´ä¸ªåº”ç”¨)
```

### 2.2 pageScope - é¡µé¢ä½œç”¨åŸŸ


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**
pageScopeç”¨äºè®¿é—®é¡µé¢ä½œç”¨åŸŸä¸­çš„å±æ€§ï¼Œç”Ÿå‘½å‘¨æœŸä»…é™äºå½“å‰JSPé¡µé¢ã€‚

**ğŸ”§ ä½¿ç”¨ç¤ºä¾‹**

```jsp
<%-- è®¾ç½®é¡µé¢ä½œç”¨åŸŸå±æ€§ --%>
<%
pageContext.setAttribute("userName", "å¼ ä¸‰");
pageContext.setAttribute("userAge", 25);
%>

<%-- ä½¿ç”¨pageScopeè®¿é—® --%>
<p>ç”¨æˆ·å§“åï¼š${pageScope.userName}</p>
<p>ç”¨æˆ·å¹´é¾„ï¼š${pageScope.userAge}</p>

<%-- ç®€åŒ–å†™æ³•(ELè‡ªåŠ¨æŸ¥æ‰¾) --%>
<p>ç”¨æˆ·ä¿¡æ¯ï¼š${userName}, ${userAge}å²</p>
```

**âš¡ ç‰¹ç‚¹è¯´æ˜**
- **ç”Ÿå‘½å‘¨æœŸ**ï¼šé¡µé¢å¼€å§‹åˆ°ç»“æŸ
- **ä½¿ç”¨åœºæ™¯**ï¼šä¸´æ—¶æ•°æ®å­˜å‚¨ï¼Œé¡µé¢å†…éƒ¨è®¡ç®—ç»“æœ
- **è®¿é—®èŒƒå›´**ï¼šä»…å½“å‰é¡µé¢

### 2.3 requestScope - è¯·æ±‚ä½œç”¨åŸŸ  


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**
requestScopeç”¨äºè®¿é—®è¯·æ±‚ä½œç”¨åŸŸä¸­çš„å±æ€§ï¼Œä¸€æ¬¡HTTPè¯·æ±‚çš„ç”Ÿå‘½å‘¨æœŸã€‚

**ğŸ”§ Servletä¸­è®¾ç½®æ•°æ®**

```java
// UserServlet.java
@WebServlet("/user")
public class UserServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, 
                        HttpServletResponse response) {
        // è®¾ç½®è¯·æ±‚ä½œç”¨åŸŸæ•°æ®
        request.setAttribute("currentUser", "æå››");
        request.setAttribute("userRole", "ç®¡ç†å‘˜");
        
        // è½¬å‘åˆ°JSPé¡µé¢
        request.getRequestDispatcher("/user.jsp")
               .forward(request, response);
    }
}
```

**ğŸ”§ JSPä¸­ä½¿ç”¨æ•°æ®**

```jsp
<!-- user.jsp -->
<div class="user-info">
    <h3>å½“å‰ç”¨æˆ·ï¼š${requestScope.currentUser}</h3>
    <p>ç”¨æˆ·è§’è‰²ï¼š${requestScope.userRole}</p>
    
    <%-- ç®€åŒ–è®¿é—® --%>
    <p>æ¬¢è¿ ${currentUser}ï¼</p>
</div>
```

**ğŸ’¡ å®é™…åº”ç”¨åœºæ™¯**
- **è¡¨å•å¤„ç†**ï¼šæ˜¾ç¤ºæäº¤åçš„ç»“æœ
- **æ•°æ®ä¼ é€’**ï¼šServletå‘JSPä¼ é€’å¤„ç†ç»“æœ
- **é”™è¯¯ä¿¡æ¯**ï¼šæ˜¾ç¤ºéªŒè¯å¤±è´¥çš„æç¤º

### 2.4 sessionScope - ä¼šè¯ä½œç”¨åŸŸ


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**
sessionScopeç”¨äºè®¿é—®ä¼šè¯ä½œç”¨åŸŸä¸­çš„å±æ€§ï¼Œç”¨æˆ·ä¸€æ¬¡è®¿é—®ä¼šè¯çš„ç”Ÿå‘½å‘¨æœŸã€‚

**ğŸ”§ ç™»å½•åŠŸèƒ½ç¤ºä¾‹**

```java
// LoginServlet.java
@WebServlet("/login")
public class LoginServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, 
                         HttpServletResponse response) {
        String username = request.getParameter("username");
        String password = request.getParameter("password");
        
        // éªŒè¯ç”¨æˆ·ä¿¡æ¯
        if ("admin".equals(username) && "123456".equals(password)) {
            // ç™»å½•æˆåŠŸï¼Œå­˜å‚¨åˆ°session
            HttpSession session = request.getSession();
            session.setAttribute("loginUser", username);
            session.setAttribute("loginTime", new Date());
            
            response.sendRedirect("welcome.jsp");
        }
    }
}
```

**ğŸ”§ JSPé¡µé¢ä½¿ç”¨**

```jsp
<!-- welcome.jsp -->
<%-- æ£€æŸ¥æ˜¯å¦ç™»å½• --%>
<c:if test="${empty sessionScope.loginUser}">
    <c:redirect url="login.jsp"/>
</c:if>

<div class="welcome-panel">
    <h2>æ¬¢è¿å›æ¥ï¼Œ${sessionScope.loginUser}ï¼</h2>
    <p>ç™»å½•æ—¶é—´ï¼š${sessionScope.loginTime}</p>
    
    <%-- å¯¼èˆªèœå• --%>
    <nav>
        <a href="profile.jsp">ä¸ªäººä¿¡æ¯</a>
        <a href="logout">é€€å‡ºç™»å½•</a>
    </nav>
</div>
```

**ğŸ¯ å…¸å‹åº”ç”¨åœºæ™¯**
- **ç”¨æˆ·ç™»å½•çŠ¶æ€**ï¼šä¿å­˜ç™»å½•ç”¨æˆ·ä¿¡æ¯
- **è´­ç‰©è½¦åŠŸèƒ½**ï¼šå­˜å‚¨ç”¨æˆ·é€‰æ‹©çš„å•†å“
- **ç”¨æˆ·åå¥½**ï¼šè®°ä½ç”¨æˆ·çš„è®¾ç½®é€‰é¡¹

### 2.5 applicationScope - åº”ç”¨ä½œç”¨åŸŸ


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**
applicationScopeç”¨äºè®¿é—®åº”ç”¨ä½œç”¨åŸŸä¸­çš„å±æ€§ï¼Œæ•´ä¸ªWebåº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸã€‚

**ğŸ”§ åº”ç”¨åˆå§‹åŒ–é…ç½®**

```java
// AppInitServlet.java (å¯åŠ¨æ—¶åŠ è½½)
@WebServlet(value = "/init", loadOnStartup = 1)
public class AppInitServlet extends HttpServlet {
    public void init() {
        ServletContext application = getServletContext();
        
        // è®¾ç½®åº”ç”¨çº§é…ç½®ä¿¡æ¯
        application.setAttribute("appName", "å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ");
        application.setAttribute("version", "v2.1.0");
        application.setAttribute("onlineUsers", 0);
    }
}
```

**ğŸ”§ JSPä¸­æ˜¾ç¤ºåº”ç”¨ä¿¡æ¯**

```jsp
<!-- footer.jsp (å…¬å…±é¡µè„š) -->
<footer class="app-footer">
    <div class="app-info">
        <span>${applicationScope.appName}</span>
        <span>ç‰ˆæœ¬ï¼š${applicationScope.version}</span>
        <span>åœ¨çº¿ç”¨æˆ·ï¼š${applicationScope.onlineUsers}äºº</span>
    </div>
    <p>&copy; 2024 ç‰ˆæƒæ‰€æœ‰</p>
</footer>
```

**âš™ï¸ å®é™…åº”ç”¨åœºæ™¯**
- **å…¨å±€é…ç½®**ï¼šç³»ç»Ÿåç§°ã€ç‰ˆæœ¬ä¿¡æ¯
- **ç»Ÿè®¡ä¿¡æ¯**ï¼šåœ¨çº¿ç”¨æˆ·æ•°ã€è®¿é—®é‡
- **ç¼“å­˜æ•°æ®**ï¼šå¸¸ç”¨çš„æŸ¥è¯¢ç»“æœ

---

## 3. ğŸ“ è¯·æ±‚å‚æ•°éšå¼å¯¹è±¡


### 3.1 param - å•å€¼å‚æ•°å¯¹è±¡


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**
paramå¯¹è±¡ç”¨äºè·å–HTTPè¯·æ±‚ä¸­çš„å•ä¸ªå‚æ•°å€¼ï¼Œç›¸å½“äº `request.getParameter()` çš„ç®€åŒ–ç‰ˆæœ¬ã€‚

**ğŸ”§ HTMLè¡¨å•ç¤ºä¾‹**

```html
<!-- search.html -->
<form action="search.jsp" method="get">
    <input type="text" name="keyword" placeholder="æœç´¢å…³é”®è¯">
    <input type="hidden" name="category" value="books">
    <input type="submit" value="æœç´¢">
</form>
```

**ğŸ”§ JSPè·å–å‚æ•°**

```jsp
<!-- search.jsp -->
<div class="search-result">
    <h3>æœç´¢ç»“æœ</h3>
    
    <%-- ä½¿ç”¨paramè·å–å‚æ•° --%>
    <p>æœç´¢å…³é”®è¯ï¼š<strong>${param.keyword}</strong></p>
    <p>æœç´¢åˆ†ç±»ï¼š${param.category}</p>
    
    <%-- URLç¤ºä¾‹: search.jsp?keyword=Java&category=books --%>
    <%-- è¾“å‡º: æœç´¢å…³é”®è¯ï¼šJava, æœç´¢åˆ†ç±»ï¼šbooks --%>
</div>
```

**ğŸ’¡ å¸¸ç”¨è®¿é—®æ–¹å¼å¯¹æ¯”**

| ä¼ ç»ŸJSPæ–¹å¼ | EL paramæ–¹å¼ | è¯´æ˜ |
|------------|-------------|------|
| `request.getParameter("name")` | `${param.name}` | **ç›´æ¥å±æ€§è®¿é—®** |
| `request.getParameter("user-id")` | `${param['user-id']}` | **åŒ…å«ç‰¹æ®Šå­—ç¬¦ç”¨[]** |

### 3.2 paramValues - å¤šå€¼å‚æ•°å¯¹è±¡


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**  
paramValueså¯¹è±¡ç”¨äºè·å–åŒåçš„å¤šä¸ªå‚æ•°å€¼ï¼Œè¿”å›å­—ç¬¦ä¸²æ•°ç»„ï¼Œç›¸å½“äº `request.getParameterValues()` çš„ç®€åŒ–ç‰ˆæœ¬ã€‚

**ğŸ”§ å¤é€‰æ¡†è¡¨å•ç¤ºä¾‹**

```html
<!-- hobby.html -->
<form action="profile.jsp" method="post">
    <h4>é€‰æ‹©ä½ çš„çˆ±å¥½ï¼š</h4>
    <label><input type="checkbox" name="hobby" value="reading">é˜…è¯»</label>
    <label><input type="checkbox" name="hobby" value="music">éŸ³ä¹</label>
    <label><input type="checkbox" name="hobby" value="sports">è¿åŠ¨</label>
    <label><input type="checkbox" name="hobby" value="travel">æ—…è¡Œ</label>
    
    <input type="submit" value="æäº¤">
</form>
```

**ğŸ”§ JSPå¤„ç†å¤šå€¼å‚æ•°**

```jsp
<!-- profile.jsp -->
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>

<div class="hobby-display">
    <h4>ä½ çš„çˆ±å¥½ï¼š</h4>
    
    <%-- æ–¹å¼1ï¼šæ˜¾ç¤ºç¬¬ä¸€ä¸ªå€¼ --%>
    <p>ç¬¬ä¸€ä¸ªçˆ±å¥½ï¼š${paramValues.hobby[0]}</p>
    
    <%-- æ–¹å¼2ï¼šå¾ªç¯æ˜¾ç¤ºæ‰€æœ‰å€¼ --%>
    <ul>
        <c:forEach var="h" items="${paramValues.hobby}">
            <li>${h}</li>
        </c:forEach>
    </ul>
    
    <%-- æ–¹å¼3ï¼šæ£€æŸ¥æ˜¯å¦ä¸ºç©º --%>
    <c:choose>
        <c:when test="${empty paramValues.hobby}">
            <p>ä½ è¿˜æ²¡æœ‰é€‰æ‹©ä»»ä½•çˆ±å¥½</p>
        </c:when>
        <c:otherwise>
            <p>ä½ é€‰æ‹©äº† ${paramValues.hobby.length} ä¸ªçˆ±å¥½</p>
        </c:otherwise>
    </c:choose>
</div>
```

**ğŸ¯ å…¸å‹ä½¿ç”¨åœºæ™¯**
- **å¤é€‰æ¡†å¤„ç†**ï¼šè·å–ç”¨æˆ·çš„å¤šé€‰é¡¹
- **å¤šæ–‡ä»¶ä¸Šä¼ **ï¼šå¤„ç†åŒåçš„æ–‡ä»¶è¾“å…¥
- **æ ‡ç­¾ç³»ç»Ÿ**ï¼šè·å–å¤šä¸ªæ ‡ç­¾å€¼

---

## 4. ğŸŒ è¯·æ±‚å¤´éšå¼å¯¹è±¡


### 4.1 header - å•å€¼è¯·æ±‚å¤´


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**
headerå¯¹è±¡ç”¨äºè·å–HTTPè¯·æ±‚å¤´çš„å•ä¸ªå€¼ï¼Œç›¸å½“äº `request.getHeader()` çš„ç®€åŒ–ç‰ˆæœ¬ã€‚

**ğŸ”§ è·å–å¸¸ç”¨è¯·æ±‚å¤´**

```jsp
<div class="request-info">
    <h4>æµè§ˆå™¨ä¿¡æ¯ï¼š</h4>
    
    <%-- è·å–ç”¨æˆ·ä»£ç† --%>
    <p>æµè§ˆå™¨ï¼š${header['User-Agent']}</p>
    
    <%-- è·å–æ¥æºé¡µé¢ --%>
    <p>æ¥æºé¡µé¢ï¼š${header.Referer}</p>
    
    <%-- è·å–å®¢æˆ·ç«¯IP(éƒ¨åˆ†æƒ…å†µ) --%>
    <p>å®¢æˆ·ç«¯IPï¼š${header['X-Real-IP']}</p>
    
    <%-- è·å–æ¥å—çš„å†…å®¹ç±»å‹ --%>
    <p>æ¥å—ç±»å‹ï¼š${header.Accept}</p>
</div>
```

**ğŸ’¡ è®¿é—®æ–¹å¼è¯´æ˜**

```
è¯·æ±‚å¤´åç§°çš„è®¿é—®è§„åˆ™ï¼š

æ ‡å‡†æ ‡è¯†ç¬¦æ ¼å¼ï¼š${header.Accept}
åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼š  ${header['User-Agent']}
åŒ…å«è¿å­—ç¬¦ï¼š    ${header['X-Forwarded-For']}
```

### 4.2 headerValues - å¤šå€¼è¯·æ±‚å¤´


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**
headerValueså¯¹è±¡ç”¨äºè·å–å¯èƒ½æœ‰å¤šä¸ªå€¼çš„HTTPè¯·æ±‚å¤´ï¼Œè¿”å›å­—ç¬¦ä¸²æ•°ç»„ã€‚

**ğŸ”§ å¤„ç†å¤šå€¼è¯·æ±‚å¤´**

```jsp
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>

<div class="header-analysis">
    <h4>è¯¦ç»†è¯·æ±‚å¤´åˆ†æï¼š</h4>
    
    <%-- Acceptè¯·æ±‚å¤´å¯èƒ½æœ‰å¤šä¸ªå€¼ --%>
    <h5>æ¥å—çš„å†…å®¹ç±»å‹ï¼š</h5>
    <ul>
        <c:forEach var="acceptType" items="${headerValues.Accept}">
            <li>${acceptType}</li>
        </c:forEach>
    </ul>
    
    <%-- Accept-Languageå¯èƒ½æœ‰å¤šä¸ªå€¼ --%>
    <h5>æ¥å—çš„è¯­è¨€ï¼š</h5>
    <c:forEach var="lang" items="${headerValues['Accept-Language']}">
        <span class="language-tag">${lang}</span>
    </c:forEach>
</div>
```

**ğŸ›  å®é™…åº”ç”¨åœºæ™¯**

```jsp
<%-- æ ¹æ®è¯·æ±‚å¤´å®ç°åŠŸèƒ½ --%>

<%-- 1. ç§»åŠ¨ç«¯æ£€æµ‹ --%>
<c:set var="userAgent" value="${header['User-Agent']}"/>
<c:choose>
    <c:when test="${fn:contains(userAgent, 'Mobile')}">
        <%-- åŠ è½½ç§»åŠ¨ç«¯æ ·å¼ --%>
        <link rel="stylesheet" href="mobile.css">
    </c:when>
    <c:otherwise>
        <%-- åŠ è½½æ¡Œé¢ç«¯æ ·å¼ --%>
        <link rel="stylesheet" href="desktop.css">
    </c:otherwise>
</c:choose>

<%-- 2. è¯­è¨€æœ¬åœ°åŒ– --%>
<c:set var="acceptLang" value="${header['Accept-Language']}"/>
<c:choose>
    <c:when test="${fn:startsWith(acceptLang, 'zh')}">
        <c:set var="locale" value="zh_CN"/>
    </c:when>
    <c:otherwise>
        <c:set var="locale" value="en_US"/>
    </c:otherwise>
</c:choose>
```

---

## 5. ğŸª Cookieéšå¼å¯¹è±¡


### 5.1 cookieå¯¹è±¡åŸºç¡€


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**
cookieå¯¹è±¡ç”¨äºè®¿é—®å®¢æˆ·ç«¯å‘é€çš„Cookieä¿¡æ¯ï¼Œæ¯ä¸ªCookieéƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«åç§°å’Œå€¼ã€‚

**ğŸ”§ Cookieçš„åˆ›å»ºä¸è¯»å–**

```java
// åˆ›å»ºCookie (åœ¨Servletä¸­)
@WebServlet("/setCookie")
public class CookieServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, 
                        HttpServletResponse response) {
        // åˆ›å»ºè®°ä½ç”¨æˆ·åçš„Cookie
        Cookie usernameCookie = new Cookie("rememberedUser", "å¼ ä¸‰");
        usernameCookie.setMaxAge(7 * 24 * 60 * 60); // 7å¤©æœ‰æ•ˆ
        response.addCookie(usernameCookie);
        
        // åˆ›å»ºä¸»é¢˜è®¾ç½®Cookie  
        Cookie themeCookie = new Cookie("theme", "dark");
        themeCookie.setMaxAge(30 * 24 * 60 * 60); // 30å¤©æœ‰æ•ˆ
        response.addCookie(themeCookie);
        
        response.sendRedirect("welcome.jsp");
    }
}
```

**ğŸ”§ JSPä¸­è¯»å–Cookie**

```jsp
<div class="user-preferences">
    <h4>ä¸ªäººè®¾ç½®ï¼š</h4>
    
    <%-- è¯»å–ç”¨æˆ·åCookie --%>
    <c:choose>
        <c:when test="${not empty cookie.rememberedUser}">
            <p>è®°ä½çš„ç”¨æˆ·ï¼š${cookie.rememberedUser.value}</p>
        </c:when>
        <c:otherwise>
            <p>æ²¡æœ‰è®°ä½ç”¨æˆ·å</p>
        </c:otherwise>
    </c:choose>
    
    <%-- è¯»å–ä¸»é¢˜è®¾ç½®Cookie --%>
    <c:set var="currentTheme" value="${cookie.theme.value}"/>
    <p>å½“å‰ä¸»é¢˜ï¼š
        <c:choose>
            <c:when test="${currentTheme eq 'dark'}">æ·±è‰²æ¨¡å¼</c:when>
            <c:when test="${currentTheme eq 'light'}">æµ…è‰²æ¨¡å¼</c:when>
            <c:otherwise>é»˜è®¤æ¨¡å¼</c:otherwise>
        </c:choose>
    </p>
</div>
```

### 5.2 Cookieçš„é«˜çº§åº”ç”¨


**ğŸ›  è´­ç‰©è½¦Cookieç¤ºä¾‹**

```jsp
<%-- æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦Cookie --%>
<%
// åœ¨Servletä¸­è®¾ç½®è´­ç‰©è½¦Cookie
String cartItems = "å•†å“1:2,å•†å“2:1,å•†å“3:3"; // å•†å“:æ•°é‡æ ¼å¼
Cookie cartCookie = new Cookie("shoppingCart", cartItems);
cartCookie.setMaxAge(24 * 60 * 60); // 1å¤©æœ‰æ•ˆ
response.addCookie(cartCookie);
%>

<%-- JSPä¸­æ˜¾ç¤ºè´­ç‰©è½¦ --%>
<div class="shopping-cart">
    <h4>æˆ‘çš„è´­ç‰©è½¦ï¼š</h4>
    
    <c:choose>
        <c:when test="${not empty cookie.shoppingCart}">
            <%-- è§£æè´­ç‰©è½¦Cookieå†…å®¹ --%>
            <c:set var="cartData" value="${cookie.shoppingCart.value}"/>
            <c:forEach var="item" items="${fn:split(cartData, ',')}">
                <c:set var="itemInfo" value="${fn:split(item, ':')}"/>
                <div class="cart-item">
                    <span>å•†å“ï¼š${itemInfo[0]}</span>
                    <span>æ•°é‡ï¼š${itemInfo[1]}</span>
                </div>
            </c:forEach>
        </c:when>
        <c:otherwise>
            <p>è´­ç‰©è½¦ä¸ºç©º</p>
        </c:otherwise>
    </c:choose>
</div>
```

**ğŸ¯ Cookieçš„å…¸å‹åº”ç”¨**
- **ç”¨æˆ·åå¥½**ï¼šä¸»é¢˜ã€è¯­è¨€ç­‰è®¾ç½®
- **è‡ªåŠ¨ç™»å½•**ï¼šè®°ä½ç”¨æˆ·ååŠŸèƒ½
- **è´­ç‰©è½¦**ï¼šä¸´æ—¶å­˜å‚¨é€‰è´­å•†å“
- **è®¿é—®ç»Ÿè®¡**ï¼šè®°å½•ç”¨æˆ·è®¿é—®ä¿¡æ¯

---

## 6. ğŸ”§ å…¶ä»–é‡è¦éšå¼å¯¹è±¡


### 6.1 initParam - åˆå§‹åŒ–å‚æ•°


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**
initParamå¯¹è±¡ç”¨äºè®¿é—®Webåº”ç”¨çš„åˆå§‹åŒ–å‚æ•°ï¼Œè¿™äº›å‚æ•°åœ¨web.xmlä¸­é…ç½®ã€‚

**ğŸ”§ web.xmlé…ç½®**

```xml
<!-- web.xml -->
<web-app>
    <!-- é…ç½®åº”ç”¨åˆå§‹åŒ–å‚æ•° -->
    <context-param>
        <param-name>databaseDriver</param-name>
        <param-value>com.mysql.cj.jdbc.Driver</param-value>
    </context-param>
    
    <context-param>
        <param-name>maxUploadSize</param-name>
        <param-value>10485760</param-value> <!-- 10MB -->
    </context-param>
    
    <context-param>
        <param-name>adminEmail</param-name>
        <param-value>admin@example.com</param-value>
    </context-param>
</web-app>
```

**ğŸ”§ JSPä¸­ä½¿ç”¨åˆå§‹åŒ–å‚æ•°**

```jsp
<div class="system-config">
    <h4>ç³»ç»Ÿé…ç½®ä¿¡æ¯ï¼š</h4>
    
    <%-- æ˜¾ç¤ºæ•°æ®åº“é©±åŠ¨ --%>
    <p>æ•°æ®åº“é©±åŠ¨ï¼š${initParam.databaseDriver}</p>
    
    <%-- æ˜¾ç¤ºä¸Šä¼ é™åˆ¶ --%>
    <p>æœ€å¤§ä¸Šä¼ å¤§å°ï¼š${initParam.maxUploadSize} å­—èŠ‚</p>
    
    <%-- æ˜¾ç¤ºç®¡ç†å‘˜é‚®ç®± --%>
    <p>ç®¡ç†å‘˜é‚®ç®±ï¼š
        <a href="mailto:${initParam.adminEmail}">
            ${initParam.adminEmail}
        </a>
    </p>
    
    <%-- æ ¹æ®é…ç½®æ˜¾ç¤ºä¸åŒå†…å®¹ --%>
    <c:choose>
        <c:when test="${initParam.maxUploadSize > 5242880}">
            <p class="info">âœ… æ”¯æŒå¤§æ–‡ä»¶ä¸Šä¼ </p>
        </c:when>
        <c:otherwise>
            <p class="warning">âš ï¸ æ–‡ä»¶ä¸Šä¼ å—é™</p>
        </c:otherwise>
    </c:choose>
</div>
```

### 6.2 pageContext - é¡µé¢ä¸Šä¸‹æ–‡


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**
pageContextæ˜¯æœ€å¼ºå¤§çš„éšå¼å¯¹è±¡ï¼Œå®ƒæä¾›äº†å¯¹JSPé¡µé¢æ‰€æœ‰å¯¹è±¡çš„è®¿é—®ï¼Œç›¸å½“äº"ä¸‡èƒ½é’¥åŒ™"ã€‚

**ğŸ”§ pageContextçš„å¸¸ç”¨åŠŸèƒ½**

```jsp
<div class="page-context-demo">
    <h4>é¡µé¢ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼š</h4>
    
    <%-- è·å–è¯·æ±‚ä¿¡æ¯ --%>
    <p>è¯·æ±‚æ–¹æ³•ï¼š${pageContext.request.method}</p>
    <p>è¯·æ±‚URLï¼š${pageContext.request.requestURL}</p>
    <p>æœåŠ¡å™¨åï¼š${pageContext.request.serverName}</p>
    <p>ç«¯å£å·ï¼š${pageContext.request.serverPort}</p>
    
    <%-- è·å–ä¼šè¯ä¿¡æ¯ --%>
    <p>ä¼šè¯IDï¼š${pageContext.session.id}</p>
    <p>ä¼šè¯åˆ›å»ºæ—¶é—´ï¼š${pageContext.session.creationTime}</p>
    
    <%-- è·å–åº”ç”¨ä¿¡æ¯ --%>
    <p>åº”ç”¨ä¸Šä¸‹æ–‡è·¯å¾„ï¼š${pageContext.servletContext.contextPath}</p>
    <p>æœåŠ¡å™¨ä¿¡æ¯ï¼š${pageContext.servletContext.serverInfo}</p>
</div>
```

**ğŸ›  pageContextçš„é«˜çº§ç”¨æ³•**

```jsp
<%-- åŠ¨æ€æ„å»ºURL --%>
<c:set var="basePath" 
       value="${pageContext.request.scheme}://${pageContext.request.serverName}:${pageContext.request.serverPort}${pageContext.request.contextPath}/"/>

<div class="dynamic-links">
    <p>åŸºç¡€è·¯å¾„ï¼š${basePath}</p>
    
    <%-- æ„å»ºå®Œæ•´é“¾æ¥ --%>
    <a href="${basePath}user/profile.jsp">ä¸ªäººèµ„æ–™</a>
    <a href="${basePath}product/list.jsp">å•†å“åˆ—è¡¨</a>
    
    <%-- æ„å»ºå›¾ç‰‡è·¯å¾„ --%>
    <img src="${basePath}images/logo.png" alt="ç½‘ç«™Logo">
</div>

<%-- æ¡ä»¶åˆ¤æ–­åº”ç”¨ --%>
<c:choose>
    <c:when test="${pageContext.request.secure}">
        <p class="secure">ğŸ”’ å®‰å…¨è¿æ¥ (HTTPS)</p>
    </c:when>
    <c:otherwise>
        <p class="warning">âš ï¸ æ™®é€šè¿æ¥ (HTTP)</p>
    </c:otherwise>
</c:choose>
```

---

## 7. ğŸ¯ éšå¼å¯¹è±¡ç»¼åˆåº”ç”¨


### 7.1 ç”¨æˆ·ç™»å½•çŠ¶æ€æ£€æŸ¥


```jsp
<%-- ç»¼åˆåº”ç”¨ï¼šå®Œæ•´çš„ç”¨æˆ·çŠ¶æ€æ£€æŸ¥é¡µé¢ --%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>

<div class="user-status-panel">
    <%-- 1. æ£€æŸ¥ç™»å½•çŠ¶æ€ --%>
    <c:choose>
        <c:when test="${not empty sessionScope.currentUser}">
            <%-- å·²ç™»å½•ç”¨æˆ·ä¿¡æ¯ --%>
            <div class="logged-in-info">
                <h3>æ¬¢è¿ï¼Œ${sessionScope.currentUser.username}ï¼</h3>
                <p>ç”¨æˆ·ç±»å‹ï¼š${sessionScope.currentUser.role}</p>
                <p>ç™»å½•æ—¶é—´ï¼š${sessionScope.loginTime}</p>
                
                <%-- æ˜¾ç¤ºè®°ä½çš„åå¥½è®¾ç½® --%>
                <c:if test="${not empty cookie.theme}">
                    <p>åå¥½ä¸»é¢˜ï¼š${cookie.theme.value}</p>
                </c:if>
            </div>
        </c:when>
        <c:otherwise>
            <%-- æœªç™»å½•ç”¨æˆ·å¤„ç† --%>
            <div class="guest-info">
                <h3>æ¸¸å®¢è®¿é—®</h3>
                
                <%-- æ£€æŸ¥æ˜¯å¦æœ‰è®°ä½çš„ç”¨æˆ·å --%>
                <c:if test="${not empty cookie.rememberedUser}">
                    <p>ä¸Šæ¬¡ç™»å½•ç”¨æˆ·ï¼š${cookie.rememberedUser.value}</p>
                    <a href="login.jsp?user=${cookie.rememberedUser.value}">
                        å¿«é€Ÿç™»å½•
                    </a>
                </c:if>
                
                <%-- æ˜¾ç¤ºç™»å½•æç¤º --%>
                <c:if test="${not empty param.from}">
                    <p class="notice">è¯·å…ˆç™»å½•åè®¿é—® ${param.from} é¡µé¢</p>
                </c:if>
            </div>
        </c:otherwise>
    </c:choose>
    
    <%-- 2. æ˜¾ç¤ºè®¿é—®ä¿¡æ¯ --%>
    <div class="access-info">
        <h4>è®¿é—®ä¿¡æ¯ï¼š</h4>
        <p>è®¿é—®é¡µé¢ï¼š${pageContext.request.requestURI}</p>
        <p>æ¥æºé¡µé¢ï¼š${header.Referer}</p>
        <p>æµè§ˆå™¨ï¼š${fn:substring(header['User-Agent'], 0, 50)}...</p>
        
        <%-- ç§»åŠ¨ç«¯é€‚é…æç¤º --%>
        <c:if test="${fn:contains(header['User-Agent'], 'Mobile')}">
            <p class="mobile-tip">ğŸ“± æ£€æµ‹åˆ°ç§»åŠ¨è®¾å¤‡è®¿é—®</p>
        </c:if>
    </div>
</div>
```

### 7.2 è¡¨å•æ•°æ®å¤„ç†ä¸éªŒè¯


```jsp
<%-- ç»¼åˆåº”ç”¨ï¼šç”¨æˆ·æ³¨å†Œè¡¨å•å¤„ç† --%>
<div class="registration-form">
    <h3>ç”¨æˆ·æ³¨å†Œ</h3>
    
    <%-- æ˜¾ç¤ºæäº¤çš„æ•°æ®ï¼ˆç”¨äºç¡®è®¤ï¼‰ --%>
    <c:if test="${not empty param.username}">
        <div class="form-data-preview">
            <h4>æäº¤çš„ä¿¡æ¯ï¼š</h4>
            <p>ç”¨æˆ·åï¼š${param.username}</p>
            <p>é‚®ç®±ï¼š${param.email}</p>
            <p>å¹´é¾„ï¼š${param.age}</p>
            
            <%-- æ˜¾ç¤ºé€‰æ‹©çš„çˆ±å¥½ --%>
            <c:if test="${not empty paramValues.hobbies}">
                <p>å…´è¶£çˆ±å¥½ï¼š
                    <c:forEach var="hobby" items="${paramValues.hobbies}" varStatus="status">
                        ${hobby}<c:if test="${!status.last}">, </c:if>
                    </c:forEach>
                </p>
            </c:if>
            
            <%-- æ˜¾ç¤ºæ€§åˆ«é€‰æ‹© --%>
            <p>æ€§åˆ«ï¼š
                <c:choose>
                    <c:when test="${param.gender eq 'M'}">ç”·</c:when>
                    <c:when test="${param.gender eq 'F'}">å¥³</c:when>
                    <c:otherwise>æœªé€‰æ‹©</c:otherwise>
                </c:choose>
            </p>
        </div>
    </c:if>
    
    <%-- è¡¨å•éªŒè¯é”™è¯¯æ˜¾ç¤º --%>
    <c:if test="${not empty requestScope.errors}">
        <div class="error-messages">
            <h4>âŒ è¯·ä¿®æ­£ä»¥ä¸‹é”™è¯¯ï¼š</h4>
            <c:forEach var="error" items="${requestScope.errors}">
                <p class="error">${error}</p>
            </c:forEach>
        </div>
    </c:if>
    
    <%-- æˆåŠŸæç¤º --%>
    <c:if test="${not empty requestScope.success}">
        <div class="success-message">
            <p class="success">âœ… ${requestScope.success}</p>
        </div>
    </c:if>
</div>
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ELéšå¼å¯¹è±¡æœ¬è´¨ï¼šJSPé¡µé¢çš„"ç°æˆå·¥å…·ç®±"ï¼Œæ— éœ€åˆ›å»ºç›´æ¥ä½¿ç”¨
ğŸ”¸ å››å¤§ä½œç”¨åŸŸå¯¹è±¡ï¼špageScopeã€requestScopeã€sessionScopeã€applicationScope
ğŸ”¸ å‚æ•°è®¿é—®å¯¹è±¡ï¼šparam(å•å€¼)ã€paramValues(å¤šå€¼)
ğŸ”¸ è¯·æ±‚å¤´å¯¹è±¡ï¼šheader(å•å€¼)ã€headerValues(å¤šå€¼)  
ğŸ”¸ Cookieå¯¹è±¡ï¼šcookieï¼Œè®¿é—®å®¢æˆ·ç«¯Cookieä¿¡æ¯
ğŸ”¸ å…¶ä»–é‡è¦å¯¹è±¡ï¼šinitParam(åˆå§‹åŒ–å‚æ•°)ã€pageContext(ä¸‡èƒ½å¯¹è±¡)
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä½œç”¨åŸŸçš„é€‰æ‹©åŸåˆ™**
```
æ•°æ®ç”Ÿå‘½å‘¨æœŸå†³å®šé€‰æ‹©ï¼š
- ä¸´æ—¶è®¡ç®—ç»“æœ â†’ pageScope
- è¯·æ±‚å¤„ç†ç»“æœ â†’ requestScope  
- ç”¨æˆ·ä¼šè¯ä¿¡æ¯ â†’ sessionScope
- å…¨å±€é…ç½®ä¿¡æ¯ â†’ applicationScope
```

**ğŸ”¹ å‚æ•°è®¿é—®çš„æ³¨æ„äº‹é¡¹**
```
è®¿é—®è§„åˆ™ï¼š
- æ ‡å‡†æ ‡è¯†ç¬¦ï¼š${param.username}
- ç‰¹æ®Šå­—ç¬¦ï¼š  ${param['user-name']}
- å¤šå€¼å‚æ•°ï¼š  ${paramValues.hobby[0]}
- ç©ºå€¼æ£€æŸ¥ï¼š  ${empty param.username}
```

**ğŸ”¹ éšå¼å¯¹è±¡çš„æ€§èƒ½è€ƒè™‘**
```
æœ€ä½³å®è·µï¼š
- ä¼˜å…ˆä½¿ç”¨ç®€åŒ–è¯­æ³•ï¼š${username} è€Œä¸æ˜¯ ${requestScope.username}
- æ˜ç¡®ä½œç”¨åŸŸå¯æé«˜æŸ¥æ‰¾æ•ˆç‡
- Cookieè®¿é—®è¦è€ƒè™‘å®¢æˆ·ç«¯ç¦ç”¨æƒ…å†µ
- pageContextåŠŸèƒ½å¼ºå¤§ä½†è¦é€‚åº¦ä½¿ç”¨
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ å¼€å‘å»ºè®®**
- **æ•°æ®ä¼ é€’**ï¼šServletä½¿ç”¨requestè®¾ç½®æ•°æ®ï¼ŒJSPç”¨ELæ˜¾ç¤º
- **ç”¨æˆ·çŠ¶æ€**ï¼šç™»å½•ä¿¡æ¯æ”¾sessionï¼Œä¸´æ—¶çŠ¶æ€æ”¾request
- **ç³»ç»Ÿé…ç½®**ï¼šweb.xmlé…ç½®å‚æ•°ç”¨initParamè®¿é—®
- **å®¢æˆ·ç«¯ä¿¡æ¯**ï¼šç”¨headerå’Œcookieè·å–æµè§ˆå™¨å’Œç”¨æˆ·åå¥½

**ğŸ›  è°ƒè¯•æŠ€å·§**
- **æ•°æ®æ£€æŸ¥**ï¼š`${empty param.username}` æ£€æŸ¥å‚æ•°æ˜¯å¦å­˜åœ¨
- **ç±»å‹è½¬æ¢**ï¼šELè‡ªåŠ¨å¤„ç†åŸºæœ¬ç±»å‹è½¬æ¢
- **å®‰å…¨è®¿é—®**ï¼šä½¿ç”¨JSTLçš„`<c:out>`é˜²æ­¢XSSæ”»å‡»
- **é”™è¯¯å¤„ç†**ï¼šç»“åˆJSTLæ¡ä»¶æ ‡ç­¾å¤„ç†å„ç§æƒ…å†µ

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- **ä½œç”¨åŸŸå¯¹è±¡**ï¼špageâ†’requestâ†’sessionâ†’applicationï¼Œç”Ÿå‘½å‘¨æœŸé€’å¢
- **å‚æ•°å¯¹è±¡**ï¼šparamå–å•å€¼ï¼ŒparamValueså–å¤šå€¼
- **è¯·æ±‚ä¿¡æ¯**ï¼šheaderå–è¯·æ±‚å¤´ï¼Œcookieå–å®¢æˆ·ç«¯æ•°æ®  
- **ä¸‡èƒ½å¯¹è±¡**ï¼špageContextå¯ä»¥è®¿é—®é¡µé¢æ‰€æœ‰ä¿¡æ¯
- **ç®€åŒ–åŸåˆ™**ï¼šELéšå¼å¯¹è±¡è®©JSPé¡µé¢æ›´ç®€æ´æ˜“è¯»