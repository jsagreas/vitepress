---
title: 1、fmt国际化与本地化基础
---
## 📚 目录

1. [国际化与本地化基本概念](#1-国际化与本地化基本概念)
2. [JSTL fmt标签库核心标签](#2-JSTL-fmt标签库核心标签)
3. [资源文件配置与管理](#3-资源文件配置与管理)
4. [区域设置与切换机制](#4-区域设置与切换机制)
5. [消息获取与参数传递](#5-消息获取与参数传递)
6. [实际开发应用场景](#6-实际开发应用场景)
7. [核心要点总结](#7-核心要点总结)

---

## 1. 🌍 国际化与本地化基本概念


### 1.1 什么是国际化和本地化


**🔸 国际化（Internationalization，简称i18n）**
```
国际化就是让你的网站能够支持多种语言和地区
比如：同一个网站既能显示中文，也能显示英文、日文等
```

**🔸 本地化（Localization，简称l10n）**
```
本地化就是针对特定地区进行适配
包括：语言翻译、货币格式、日期格式、数字格式等
```

**💡 通俗理解**
```
国际化：设计房子时预留好电线管道（为多语言做准备）
本地化：根据不同地区接不同规格的电器（适配具体语言）

举个例子：
淘宝网站 → 中国版本显示"购买"，美国版本显示"Buy Now"
这就是国际化和本地化的体现
```

### 1.2 为什么需要国际化


**🎯 实际需求场景**
- **电商网站**：服务全球用户，需要多语言支持
- **企业官网**：面向国际市场，提升用户体验
- **软件产品**：扩大用户群体，增加市场竞争力

**📈 带来的好处**
```
用户体验提升：用户看到熟悉的语言更容易理解
市场扩张：能够进入更多国家和地区
品牌形象：显得更加专业和国际化
```

### 1.3 国际化技术架构


**🏗️ 基本实现思路**
```
1. 把所有显示文字提取出来，放到配置文件
2. 根据用户的语言偏好，选择对应的配置文件
3. 页面显示时，从配置文件读取文字内容

传统做法：
<h1>欢迎访问</h1>  ❌ 文字写死了

国际化做法：
<h1><fmt:message key="welcome" /></h1>  ✅ 从配置读取
```

---

## 2. 🏷️ JSTL fmt标签库核心标签


### 2.1 fmt标签库概述


**🔸 什么是fmt标签库**
```
fmt = Format（格式化）
JSTL的fmt标签库专门用来处理国际化和格式化问题
就像一个翻译官，帮你把内容转换成不同语言和格式
```

**📦 核心标签一览**
```
区域控制标签：
• <fmt:setLocale>     - 设置当前语言区域
• <fmt:requestEncoding> - 设置请求编码

资源文件标签：
• <fmt:setBundle>     - 绑定资源文件
• <fmt:bundle>        - 临时使用资源文件

消息获取标签：
• <fmt:message>       - 获取国际化消息
• <fmt:param>         - 传递消息参数
```

### 2.2 `<fmt:setLocale>` 区域设置标签


**🔸 标签作用**
```
设置当前页面使用哪种语言和地区
就像告诉系统"我现在要说中文"或"我现在要说英文"
```

**💻 基本用法**
```jsp
<!-- 设置为中文（中国） -->
<fmt:setLocale value="zh_CN" />

<!-- 设置为英文（美国） -->
<fmt:setLocale value="en_US" />

<!-- 设置为日文（日本） -->
<fmt:setLocale value="ja_JP" />
```

**🔧 属性说明**
| 属性 | 作用 | 示例 |
|------|------|------|
| `value` | **指定区域代码** | `"zh_CN"` `"en_US"` |
| `variant` | **指定方言变体** | 很少使用 |
| `scope` | **作用范围** | `page` `request` `session` `application` |

**💡 区域代码规则**
```
格式：语言代码_国家代码

常用区域代码：
zh_CN  - 中文（中国大陆）
zh_TW  - 中文（台湾）
en_US  - 英文（美国）
en_GB  - 英文（英国）
ja_JP  - 日文（日本）
ko_KR  - 韩文（韩国）
```

### 2.3 `<fmt:setBundle>` 资源包绑定标签


**🔸 标签作用**
```
告诉系统要使用哪个资源文件来获取翻译内容
就像指定要使用哪本词典来查找翻译
```

**💻 基本用法**
```jsp
<!-- 绑定名为messages的资源文件 -->
<fmt:setBundle basename="messages" />

<!-- 绑定指定路径的资源文件 -->
<fmt:setBundle basename="com.example.i18n.messages" />

<!-- 绑定资源文件并指定变量名 -->
<fmt:setBundle basename="messages" var="bundle" />
```

**🔧 属性详解**
| 属性 | 作用 | 必需 | 示例 |
|------|------|------|------|
| `basename` | **资源文件基础名** | ✅ | `"messages"` |
| `var` | **存储bundle的变量名** | ❌ | `"bundle"` |
| `scope` | **变量存储范围** | ❌ | `"request"` |

### 2.4 `<fmt:bundle>` 临时资源包标签


**🔸 标签作用**
```
在标签体内临时使用指定的资源文件
相当于临时换一本词典，用完就换回去
```

**💻 使用示例**
```jsp
<!-- 默认使用messages资源文件 -->
<fmt:setBundle basename="messages" />

<!-- 临时使用error资源文件 -->
<fmt:bundle basename="error">
    <fmt:message key="login.failed" />
    <fmt:message key="password.wrong" />
</fmt:bundle>

<!-- 又回到默认的messages资源文件 -->
<fmt:message key="welcome" />
```

### 2.5 `<fmt:message>` 消息获取标签


**🔸 标签作用**
```
从资源文件中获取对应语言的文字内容
这是最核心的标签，就像查词典获取翻译
```

**💻 基本用法**
```jsp
<!-- 获取简单消息 -->
<fmt:message key="welcome" />

<!-- 获取消息并设置默认值 -->
<fmt:message key="title" var="pageTitle">
    <fmt:param value="默认标题" />
</fmt:message>

<!-- 使用指定的bundle获取消息 -->
<fmt:message bundle="${bundle}" key="error.message" />
```

**🔧 重要属性**
| 属性 | 作用 | 示例 |
|------|------|------|
| `key` | **资源文件中的键名** | `"welcome"` `"user.name"` |
| `var` | **存储消息的变量名** | `"msg"` |
| `bundle` | **指定使用的资源包** | `${bundle}` |

---

## 3. 📁 资源文件配置与管理


### 3.1 资源文件命名规范


**🔸 文件命名规则**
```
基础格式：basename_language_country.properties

具体示例：
messages.properties          - 默认文件（通常是英文）
messages_zh_CN.properties   - 中文（简体）
messages_zh_TW.properties   - 中文（繁体）
messages_en_US.properties   - 英文（美国）
messages_ja_JP.properties   - 日文（日本）
```

**💡 文件查找优先级**
```
用户设置区域为zh_CN时，系统查找顺序：
1. messages_zh_CN.properties     ← 最精确匹配
2. messages_zh.properties        ← 语言匹配
3. messages.properties           ← 默认文件

找到就停止，找不到继续找下一个
```

### 3.2 资源文件内容格式


**📝 properties文件格式**
```
# messages_zh_CN.properties（中文资源文件）
welcome=欢迎访问我们的网站
user.login=用户登录
user.name=用户名
user.password=密码
user.login.success=登录成功！欢迎 {0}
user.login.failed=登录失败，请检查用户名和密码
page.title=网站首页
menu.home=首页
menu.about=关于我们
menu.contact=联系我们
```

```
# messages_en_US.properties（英文资源文件）
welcome=Welcome to our website
user.login=User Login
user.name=Username
user.password=Password
user.login.success=Login successful! Welcome {0}
user.login.failed=Login failed, please check username and password
page.title=Website Home
menu.home=Home
menu.about=About Us
menu.contact=Contact Us
```

**⚠️ 重要注意事项**
```
中文资源文件需要转换成Unicode编码：
原文：用户名=用户名
转换后：user.name=\u7528\u6237\u540d

或者使用UTF-8编码保存文件（推荐）
```

### 3.3 项目中的文件存放位置


**📂 标准目录结构**
```
src/main/resources/
    ├── messages.properties              # 默认资源文件
    ├── messages_zh_CN.properties       # 中文资源文件
    ├── messages_en_US.properties       # 英文资源文件
    └── com/example/i18n/
        ├── error.properties             # 错误消息资源文件
        └── error_zh_CN.properties      # 中文错误消息
```

**🔧 配置web.xml**
```xml
<!-- 设置默认编码 -->
<context-param>
    <param-name>javax.servlet.jsp.jstl.fmt.locale</param-name>
    <param-value>zh_CN</param-value>
</context-param>

<context-param>
    <param-name>javax.servlet.jsp.jstl.fmt.localizationContext</param-name>
    <param-value>messages</param-value>
</context-param>
```

---

## 4. 🌐 区域设置与切换机制


### 4.1 Locale区域对象详解


**🔸 什么是Locale**
```
Locale就是一个代表特定地区和语言的对象
包含了语言、国家、方言等信息
就像身份证一样，标识了用户的"语言身份"
```

**💻 Locale对象构成**
```
Locale结构：
┌─────────────────┐
│     Locale      │
├─────────────────┤
│ 语言码: zh, en  │
│ 国家码: CN, US  │
│ 变体码: 很少用   │
└─────────────────┘

示例：
new Locale("zh", "CN")  → 中文（中国）
new Locale("en", "US")  → 英文（美国）
```

**🔧 获取用户Locale的方式**
```jsp
<!-- 方式1：从请求中获取浏览器语言设置 -->
<%
    Locale userLocale = request.getLocale();
    out.println("用户语言偏好：" + userLocale);
%>

<!-- 方式2：手动设置 -->
<fmt:setLocale value="zh_CN" scope="session"/>

<!-- 方式3：从参数获取 -->
<%
    String lang = request.getParameter("lang");
    if(lang != null) {
        if("zh".equals(lang)) {
            request.getSession().setAttribute("locale", new Locale("zh", "CN"));
        } else if("en".equals(lang)) {
            request.getSession().setAttribute("locale", new Locale("en", "US"));
        }
    }
%>
```

### 4.2 动态语言切换实现


**🔄 语言切换流程图**
```
用户访问页面
    ↓
检查是否有语言参数
    ↓
如果有参数 → 设置新的Locale → 存储到session
    ↓
如果没有参数 → 使用session中的Locale → 如果没有使用默认
    ↓
根据Locale加载对应资源文件
    ↓
显示对应语言的页面内容
```

**💻 完整切换实现**
```jsp
<%-- 语言切换处理 --%>
<%
    String lang = request.getParameter("lang");
    if (lang != null && !lang.isEmpty()) {
        Locale locale = null;
        switch(lang) {
            case "zh":
                locale = new Locale("zh", "CN");
                break;
            case "en":
                locale = new Locale("en", "US");
                break;
            default:
                locale = Locale.getDefault();
        }
        session.setAttribute("locale", locale);
    }
%>

<%-- 设置当前页面使用的语言 --%>
<fmt:setLocale value="${sessionScope.locale != null ? sessionScope.locale : 'zh_CN'}" />
<fmt:setBundle basename="messages" />

<!DOCTYPE html>
<html>
<head>
    <title><fmt:message key="page.title" /></title>
</head>
<body>
    <%-- 语言切换链接 --%>
    <div class="language-switch">
        <a href="?lang=zh">中文</a> | 
        <a href="?lang=en">English</a>
    </div>
    
    <%-- 页面内容 --%>
    <h1><fmt:message key="welcome" /></h1>
    <p><fmt:message key="site.description" /></p>
</body>
</html>
```

### 4.3 区域信息的作用范围


**📊 scope作用域对比**
| 作用域 | 生命周期 | 使用场景 | 示例 |
|--------|----------|----------|------|
| `page` | **当前页面** | 页面内临时设置 | 特殊页面临时切换语言 |
| `request` | **单次请求** | 请求期间有效 | 表单处理页面 |
| `session` | **用户会话** | 用户访问期间保持 | **最常用**，记住用户语言偏好 |
| `application` | **整个应用** | 应用启动到关闭 | 设置应用默认语言 |

**💡 实际使用建议**
```
推荐使用session作用域：
• 用户选择语言后，在整个访问过程中保持
• 切换页面时不需要重新设置
• 符合用户使用习惯
```

---

## 5. 💬 消息获取与参数传递


### 5.1 基础消息获取


**🔸 简单消息获取**
```jsp
<!-- 最基本的用法 -->
<h1><fmt:message key="welcome" /></h1>

<!-- 等价的写法 -->
<fmt:message key="welcome" var="welcomeMsg" />
<h1>${welcomeMsg}</h1>
```

**💻 实际应用示例**
```jsp
<fmt:setLocale value="zh_CN" />
<fmt:setBundle basename="messages" />

<div class="header">
    <h1><fmt:message key="site.title" /></h1>
    <nav>
        <a href="/"><fmt:message key="menu.home" /></a>
        <a href="/about"><fmt:message key="menu.about" /></a>
        <a href="/contact"><fmt:message key="menu.contact" /></a>
    </nav>
</div>
```

### 5.2 带参数的消息处理


**🔸 什么是参数化消息**
```
有时候消息中需要插入动态内容，比如：
"欢迎 张三 登录系统"
其中"张三"是动态变化的用户名

资源文件中这样定义：
welcome.user=欢迎 {0} 登录系统

{0} 就是参数占位符，第一个参数
{1} 就是第二个参数，以此类推
```

**💻 `<fmt:param>` 参数传递**
```jsp
<!-- 单个参数 -->
<fmt:message key="welcome.user">
    <fmt:param value="${user.name}" />
</fmt:message>

<!-- 多个参数 -->
<fmt:message key="order.summary">
    <fmt:param value="${order.id}" />
    <fmt:param value="${order.amount}" />
    <fmt:param value="${order.date}" />
</fmt:message>
```

**📝 对应的资源文件**
```
# messages_zh_CN.properties
welcome.user=欢迎 {0} 登录系统
order.summary=订单号：{0}，金额：{1} 元，日期：{2}

# messages_en_US.properties
welcome.user=Welcome {0} to login
order.summary=Order ID: {0}, Amount: ${1}, Date: {2}
```

### 5.3 复杂参数处理示例


**🔧 实际业务场景**
```jsp
<%-- 用户信息显示 --%>
<div class="user-info">
    <fmt:message key="user.info.title">
        <fmt:param value="${user.name}" />
        <fmt:param value="${user.level}" />
    </fmt:message>
</div>

<%-- 商品信息显示 --%>
<div class="product-info">
    <fmt:message key="product.price.info">
        <fmt:param value="${product.name}" />
        <fmt:param value="${product.price}" />
        <fmt:param value="${product.discount}" />
    </fmt:message>
</div>

<%-- 错误消息显示 --%>
<c:if test="${not empty error}">
    <div class="error-message">
        <fmt:message key="error.${error.code}">
            <fmt:param value="${error.field}" />
            <fmt:param value="${error.value}" />
        </fmt:message>
    </div>
</c:if>
```

**📋 对应资源文件内容**
```
# messages_zh_CN.properties
user.info.title={0} 您好！您是 {1} 级用户
product.price.info=商品 {0} 的价格是 ¥{1}，折扣：{2}%
error.invalid.format=字段 {0} 的值 "{1}" 格式不正确

# messages_en_US.properties  
user.info.title=Hello {0}! You are a {1} level user
product.price.info=Product {0} costs ${1}, discount: {2}%
error.invalid.format=Field {0} value "{1}" has invalid format
```

---

## 6. 🚀 实际开发应用场景


### 6.1 电商网站多语言支持


**🛒 电商场景分析**
```
需要国际化的内容：
• 网站导航菜单
• 商品分类名称  
• 购物流程提示
• 错误提示信息
• 邮件通知模板
```

**💻 电商页面实现**
```jsp
<%-- 购物车页面 --%>
<fmt:setBundle basename="shop" />

<div class="shopping-cart">
    <h2><fmt:message key="cart.title" /></h2>
    
    <c:if test="${empty cart.items}">
        <p class="empty-cart"><fmt:message key="cart.empty" /></p>
    </c:if>
    
    <c:if test="${not empty cart.items}">
        <table class="cart-table">
            <thead>
                <tr>
                    <th><fmt:message key="cart.product" /></th>
                    <th><fmt:message key="cart.price" /></th>
                    <th><fmt:message key="cart.quantity" /></th>
                    <th><fmt:message key="cart.total" /></th>
                </tr>
            </thead>
            <tbody>
                <c:forEach items="${cart.items}" var="item">
                    <tr>
                        <td>${item.productName}</td>
                        <td>¥${item.price}</td>
                        <td>${item.quantity}</td>
                        <td>¥${item.total}</td>
                    </tr>
                </c:forEach>
            </tbody>
        </table>
        
        <div class="cart-summary">
            <fmt:message key="cart.total.amount">
                <fmt:param value="${cart.totalAmount}" />
            </fmt:message>
        </div>
        
        <div class="cart-actions">
            <button class="btn-primary">
                <fmt:message key="cart.checkout" />
            </button>
        </div>
    </c:if>
</div>
```

### 6.2 用户注册表单验证消息


**📝 表单验证场景**
```jsp
<%-- 用户注册页面 --%>
<fmt:setBundle basename="validation" />

<form action="register" method="post">
    <div class="form-group">
        <label><fmt:message key="form.username" />:</label>
        <input type="text" name="username" value="${param.username}" />
        <c:if test="${not empty errors.username}">
            <span class="error">
                <fmt:message key="error.${errors.username}" />
            </span>
        </c:if>
    </div>
    
    <div class="form-group">
        <label><fmt:message key="form.email" />:</label>
        <input type="email" name="email" value="${param.email}" />
        <c:if test="${not empty errors.email}">
            <span class="error">
                <fmt:message key="error.${errors.email}">
                    <fmt:param value="${param.email}" />
                </fmt:message>
            </span>
        </c:if>
    </div>
    
    <div class="form-group">
        <label><fmt:message key="form.password" />:</label>
        <input type="password" name="password" />
        <c:if test="${not empty errors.password}">
            <span class="error">
                <fmt:message key="error.${errors.password}" />
            </span>
        </c:if>
    </div>
    
    <button type="submit">
        <fmt:message key="form.submit.register" />
    </button>
</form>
```

**📋 验证消息资源文件**
```
# validation_zh_CN.properties
form.username=用户名
form.email=邮箱地址
form.password=密码
form.submit.register=立即注册

error.required=此字段不能为空
error.username.length=用户名长度必须在3-20个字符之间
error.email.invalid=邮箱地址 "{0}" 格式不正确
error.password.weak=密码强度太弱，请包含字母和数字

# validation_en_US.properties
form.username=Username
form.email=Email Address
form.password=Password
form.submit.register=Register Now

error.required=This field is required
error.username.length=Username must be between 3-20 characters
error.email.invalid=Email address "{0}" is invalid
error.password.weak=Password is too weak, please include letters and numbers
```

### 6.3 系统通知与邮件模板


**📧 邮件通知场景**
```jsp
<%-- 邮件模板JSP --%>
<fmt:setBundle basename="email" />

<div class="email-template">
    <h2><fmt:message key="email.welcome.subject" /></h2>
    
    <p>
        <fmt:message key="email.welcome.greeting">
            <fmt:param value="${user.name}" />
        </fmt:message>
    </p>
    
    <p><fmt:message key="email.welcome.content" /></p>
    
    <div class="email-action">
        <fmt:message key="email.welcome.action.text" />
        <a href="${activationLink}">
            <fmt:message key="email.welcome.action.link" />
        </a>
    </div>
    
    <div class="email-footer">
        <p><fmt:message key="email.footer.thanks" /></p>
        <p>
            <fmt:message key="email.footer.team">
                <fmt:param value="${company.name}" />
            </fmt:message>
        </p>
    </div>
</div>
```

---

## 7. 📋 核心要点总结


### 7.1 必须掌握的核心概念


```
🔸 国际化(i18n)：让应用支持多种语言和地区
🔸 本地化(l10n)：针对特定地区进行内容适配
🔸 Locale对象：表示特定语言和地区的标识符
🔸 ResourceBundle：存储不同语言版本文字内容的资源文件
🔸 fmt标签库：JSTL提供的国际化和格式化标签集合
```

### 7.2 关键标签使用要点


**🔹 标签使用优先级**
```
1. 首先设置区域：<fmt:setLocale>
2. 然后绑定资源：<fmt:setBundle>  
3. 最后获取消息：<fmt:message>

这个顺序不能错，就像先选择词典再查单词
```

**🔹 资源文件管理原则**
```
命名规范：basename_language_country.properties
查找优先级：精确匹配 > 语言匹配 > 默认文件
内容格式：key=value格式，支持参数占位符{0}{1}...
编码要求：中文需要UTF-8编码或Unicode转义
```

**🔹 实用开发建议**
```
作用域选择：通常使用session保存用户语言偏好
参数传递：<fmt:param>按顺序对应{0}{1}{2}...
错误处理：提供默认值防止key找不到
性能考虑：合理组织资源文件，避免过大文件
```

### 7.3 常见应用模式


**🎯 标准国际化流程**
```
1. 提取所有显示文字到资源文件
2. 创建不同语言版本的资源文件
3. 页面使用fmt标签替换硬编码文字
4. 实现语言切换功能
5. 测试各语言版本显示效果
```

**⚠️ 开发注意事项**
```
文件编码：确保资源文件使用正确编码
键名规范：使用有意义的键名，如user.login而非msg1
参数顺序：fmt:param的顺序要与资源文件中{0}{1}对应
默认语言：always provide默认资源文件作为后备
测试覆盖：测试所有支持语言的显示效果
```

### 7.4 实际价值与应用场景


- **电商平台**：商品信息、购物流程的多语言支持
- **企业网站**：官网内容、产品介绍的国际化展示
- **管理系统**：操作界面、提示信息的本地化适配
- **移动应用**：H5页面的多语言用户体验优化

**核心记忆口诀**：
```
国际化开发要记牢：
区域设置是基础，资源文件要管好
消息获取用fmt标签，参数传递按顺序
用户体验最重要，多语言支持不可少
```