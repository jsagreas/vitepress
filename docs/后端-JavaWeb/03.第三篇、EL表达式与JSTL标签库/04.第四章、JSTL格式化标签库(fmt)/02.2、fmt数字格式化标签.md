---
title: 2、fmt数字格式化标签
---
## 📚 目录

1. [fmt数字格式化核心概念](#1-fmt数字格式化核心概念)
2. [formatNumber标签详解](#2-formatNumber标签详解)
3. [数字格式类型深入解析](#3-数字格式类型深入解析)
4. [自定义格式模式](#4-自定义格式模式)
5. [parseNumber数字解析](#5-parseNumber数字解析)
6. [实际应用场景](#6-实际应用场景)
7. [核心要点总结](#7-核心要点总结)

---

## 1. 🔢 fmt数字格式化核心概念


### 1.1 什么是数字格式化


**🎯 核心理解**
数字格式化就是把原始的数字变成用户看起来更友好的样子。

```
原始数字：1234567.89
格式化后：￥1,234,567.89  （货币格式）
格式化后：123,456,789%   （百分比格式）
格式化后：1,234,567.89   （普通数字，带千分位）
```

**💡 为什么需要格式化**
```
实际应用场景：
🏪 电商网站：商品价格显示成 ￥99.00 而不是 99.0
📊 报表系统：增长率显示成 25.5% 而不是 0.255
💰 银行系统：余额显示成 1,000,000.00 而不是 1000000
📈 数据展示：大数字显示成 1,234,567 而不是 1234567
```

### 1.2 fmt标签库的作用


**🔧 fmt标签库的本质**
fmt是JSP标准标签库中专门处理格式化的部分，就像一个专业的"数字美容师"。

```
核心功能：
✅ 数字格式化：让数字显示更漂亮
✅ 日期格式化：让日期显示更友好  
✅ 国际化支持：适应不同国家的格式习惯
✅ 数字解析：把格式化的字符串还原成数字
```

### 1.3 使用前的准备工作


**📋 引入fmt标签库**
```jsp
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
```

**🔸 理解这行代码**
- `taglib`：告诉JSP我要使用标签库
- `prefix="fmt"`：给这个标签库起个简短的名字
- `uri="..."`：指明这个标签库的身份证号

---

## 2. 🎨 formatNumber标签详解


### 2.1 基本语法结构


**📝 标签语法**
```jsp
<fmt:formatNumber 
    value="要格式化的数字"
    type="格式类型"
    pattern="自定义格式"
    groupingUsed="是否分组显示"
    var="存储结果的变量名"
/>
```

**🔸 核心属性说明**
| 属性名 | **作用** | **常用值** | **是否必需** |
|--------|---------|-----------|-------------|
| `value` | `要格式化的数字` | `数字或EL表达式` | `✅必需` |
| `type` | `格式化类型` | `number/currency/percent` | `可选` |
| `pattern` | `自定义格式模式` | `#,##0.00等` | `可选` |
| `groupingUsed` | `是否使用千分位` | `true/false` | `可选` |
| `var` | `结果存储变量` | `变量名` | `可选` |

### 2.2 最简单的使用方式


**🚀 快速上手示例**

```jsp
<!-- 最基础的数字格式化 -->
原始数字：${price}
格式化后：<fmt:formatNumber value="${price}" />

<!-- 实际页面效果 -->
原始数字：1234567.89
格式化后：1,234,567.89
```

**💡 这里发生了什么**
1. `${price}` 是一个EL表达式，取出存储的数字
2. `<fmt:formatNumber>` 标签自动给数字加上千分位逗号
3. 默认保留小数位，让数字看起来更整齐

### 2.3 存储格式化结果


**📦 使用var属性存储结果**

```jsp
<!-- 格式化并存储到变量中 -->
<fmt:formatNumber value="${price}" var="formattedPrice" />

<!-- 在其他地方使用格式化结果 -->
<p>商品价格：${formattedPrice}</p>
<p>优惠价格：${formattedPrice}</p>
```

**🔸 什么时候用var属性**
- ✅ 同一个格式化结果要在多处使用
- ✅ 需要在JavaScript中使用格式化结果
- ✅ 复杂的页面布局中需要传递格式化数据

---

## 3. 📊 数字格式类型深入解析


### 3.1 number类型 - 普通数字格式


**🔢 number类型详解**
```jsp
<!-- 基础数字格式化 -->
<fmt:formatNumber value="1234567.89" type="number" />
输出：1,234,567.89

<!-- 控制小数位数 -->
<fmt:formatNumber value="1234.5" type="number" maxFractionDigits="3" />
输出：1,234.500

<!-- 最少小数位数 -->
<fmt:formatNumber value="1234" type="number" minFractionDigits="2" />  
输出：1,234.00
```

**📋 number类型常用属性**
| 属性 | **作用** | **示例** |
|------|---------|---------|
| `maxIntegerDigits` | `最大整数位数` | `value="12345" maxIntegerDigits="3"` → `345` |
| `minIntegerDigits` | `最小整数位数` | `value="123" minIntegerDigits="5"` → `00,123` |
| `maxFractionDigits` | `最大小数位数` | `value="3.14159" maxFractionDigits="2"` → `3.14` |
| `minFractionDigits` | `最小小数位数` | `value="3.1" minFractionDigits="3"` → `3.100` |

### 3.2 currency类型 - 货币格式


**💰 currency类型详解**
```jsp
<!-- 基础货币格式 -->
<fmt:formatNumber value="1234.56" type="currency" />
输出：$1,234.56 (美国环境下)

<!-- 指定货币代码 -->
<fmt:formatNumber value="1234.56" type="currency" currencyCode="CNY" />
输出：￥1,234.56

<!-- 使用货币符号 -->
<fmt:formatNumber value="1234.56" type="currency" currencySymbol="￥" />
输出：￥1,234.56
```

**🌍 常见货币代码**
```
💸 货币格式对照表：
CNY → ￥ (人民币)
USD → $ (美元)  
EUR → € (欧元)
JPY → ¥ (日元)
GBP → £ (英镑)
```

**🎯 实际应用场景**
```jsp
<!-- 电商商品价格展示 -->
<c:forEach items="${products}" var="product">
    <div class="product">
        <h3>${product.name}</h3>
        <p class="price">
            价格：<fmt:formatNumber value="${product.price}" type="currency" currencySymbol="￥" />
        </p>
    </div>
</c:forEach>
```

### 3.3 percent类型 - 百分比格式


**📈 percent类型详解**
```jsp
<!-- 小数转百分比 -->
<fmt:formatNumber value="0.255" type="percent" />
输出：25.5%

<!-- 控制百分比精度 -->
<fmt:formatNumber value="0.23456" type="percent" maxFractionDigits="2" />
输出：23.46%

<!-- 整数百分比显示 -->
<fmt:formatNumber value="0.8556" type="percent" maxFractionDigits="0" />
输出：86%
```

**📊 百分比使用要点**
```
重要理解：
0.25 → 25%    (小数自动乘以100)
0.1234 → 12.34%   (保留两位小数)
1.5 → 150%    (大于1的情况)

⚠️ 常见错误：
如果数据库存的是 25，不要直接用percent格式
应该先除以100：${rate/100} 或者预处理数据
```

**🎯 实际应用场景**
```jsp
<!-- 数据报表中的增长率 -->
<table class="report">
    <tr>
        <td>销售增长率</td>
        <td><fmt:formatNumber value="${growthRate}" type="percent" maxFractionDigits="2" /></td>
    </tr>
    <tr>
        <td>市场占有率</td>
        <td><fmt:formatNumber value="${marketShare}" type="percent" maxFractionDigits="1" /></td>
    </tr>
</table>
```

---

## 4. 🎨 自定义格式模式


### 4.1 pattern属性的强大功能


**🔧 什么是pattern**
pattern就像一个模板，告诉系统"我要什么样子的格式"。

```
基础概念：
# → 数字位，如果没有数字就不显示
0 → 数字位，如果没有数字就显示0  
, → 千分位分隔符
. → 小数点
% → 百分号
```

### 4.2 常用pattern模式


**📋 实用pattern模式大全**

```jsp
<!-- 基础模式 -->
<fmt:formatNumber value="1234.5" pattern="#,##0.00" />
输出：1,234.50

<!-- 货币模式 -->  
<fmt:formatNumber value="1234.5" pattern="￥#,##0.00" />
输出：￥1,234.50

<!-- 百分比模式 -->
<fmt:formatNumber value="0.255" pattern="#0.0%" />
输出：25.5%

<!-- 科学计数法 -->
<fmt:formatNumber value="1234567" pattern="0.00E0" />
输出：1.23E6
```

**🎯 pattern模式对照表**
| 模式 | **示例输入** | **输出结果** | **应用场景** |
|------|------------|------------|------------|
| `#,##0` | `1234.567` | `1,235` | `整数显示，四舍五入` |
| `#,##0.00` | `1234.5` | `1,234.50` | `保留两位小数` |
| `￥#,##0.00` | `1234.5` | `￥1,234.50` | `人民币格式` |
| `#0.0%` | `0.255` | `25.5%` | `百分比，一位小数` |
| `000000` | `123` | `000123` | `固定位数，前置补零` |

### 4.3 复杂pattern应用


**🚀 高级pattern应用**

```jsp
<!-- 正负数不同格式 -->
<fmt:formatNumber value="-1234.56" pattern="￥#,##0.00;负￥#,##0.00" />
输出：负￥1,234.56

<!-- 零值特殊处理 -->
<fmt:formatNumber value="0" pattern="#,##0.00;负#,##0.00;零" />
输出：零

<!-- 条件格式 -->
<fmt:formatNumber value="1000000" pattern="#,##0万;#,##0" />
输出：100万
```

**💡 pattern规则解析**
```
格式规则：正数格式;负数格式;零值格式

示例解析：
"#,##0.00;负#,##0.00;零"
│      │        │    └─ 当值为0时显示"零"  
│      │        └─ 负数时显示"负"加数字
│      └─ 正数时的格式
└─ 基础数字格式
```

---

## 5. 🔄 parseNumber数字解析


### 5.1 parseNumber的作用


**🔄 什么是数字解析**
parseNumber的作用正好与formatNumber相反，它把格式化的字符串变回纯数字。

```
格式化过程：1234.56 → "￥1,234.56"
解析过程："￥1,234.56" → 1234.56

实际应用：
用户输入："1,234.56" 
解析结果：1234.56 (可以用于计算)
```

### 5.2 parseNumber基本使用


**📝 基础语法**
```jsp
<fmt:parseNumber 
    value="要解析的字符串"
    type="解析类型" 
    pattern="解析模式"
    var="存储结果的变量"
/>
```

**🚀 实用示例**
```jsp
<!-- 解析带逗号的数字 -->
<fmt:parseNumber value="1,234.56" var="number1" />
解析结果：${number1} → 1234.56

<!-- 解析货币格式 -->
<fmt:parseNumber value="￥1,234.56" type="currency" var="amount" />
解析结果：${amount} → 1234.56

<!-- 解析百分比 -->
<fmt:parseNumber value="25.5%" type="percent" var="rate" />
解析结果：${rate} → 0.255
```

### 5.3 实际应用场景


**🎯 表单数据处理**
```jsp
<!-- 用户提交的价格数据 -->
<c:set var="userPrice" value="${param.price}" /> <!-- 用户输入：1,234.56 -->

<!-- 解析为数字进行计算 -->
<fmt:parseNumber value="${userPrice}" var="numericPrice" />

<!-- 计算税后价格 -->
<c:set var="taxRate" value="0.1" />
<c:set var="finalPrice" value="${numericPrice * (1 + taxRate)}" />

<!-- 显示结果 -->
<p>原价：<fmt:formatNumber value="${numericPrice}" type="currency" currencySymbol="￥" /></p>
<p>税后：<fmt:formatNumber value="${finalPrice}" type="currency" currencySymbol="￥" /></p>
```

---

## 6. 💼 实际应用场景


### 6.1 电商购物车应用


**🛒 完整购物车示例**

```jsp
<!-- 购物车商品列表 -->
<table class="cart-table">
    <thead>
        <tr>
            <th>商品名称</th>
            <th>单价</th>
            <th>数量</th>
            <th>小计</th>
        </tr>
    </thead>
    <tbody>
        <c:forEach items="${cartItems}" var="item">
            <tr>
                <td>${item.productName}</td>
                <td><fmt:formatNumber value="${item.price}" type="currency" currencySymbol="￥" /></td>
                <td>${item.quantity}</td>
                <td>
                    <c:set var="subtotal" value="${item.price * item.quantity}" />
                    <fmt:formatNumber value="${subtotal}" type="currency" currencySymbol="￥" />
                </td>
            </tr>
        </c:forEach>
    </tbody>
    <tfoot>
        <tr class="total-row">
            <td colspan="3">总计</td>
            <td><fmt:formatNumber value="${cartTotal}" type="currency" currencySymbol="￥" /></td>
        </tr>
    </tfoot>
</table>
```

### 6.2 数据统计报表


**📊 销售报表应用**

```jsp
<!-- 月度销售报表 -->
<div class="sales-report">
    <h2>月度销售统计</h2>
    
    <div class="summary-cards">
        <div class="card">
            <h3>总销售额</h3>
            <p class="amount">
                <fmt:formatNumber value="${monthlySales}" type="currency" currencySymbol="￥" />
            </p>
        </div>
        
        <div class="card">
            <h3>环比增长</h3>
            <p class="growth">
                <fmt:formatNumber value="${growthRate}" type="percent" maxFractionDigits="1" />
            </p>
        </div>
        
        <div class="card">
            <h3>平均客单价</h3>
            <p class="average">
                <fmt:formatNumber value="${avgOrderValue}" pattern="￥#,##0.00" />
            </p>
        </div>
    </div>
</div>
```

### 6.3 用户输入验证与处理


**🔍 表单数据处理流程**

```jsp
<!-- 用户输入处理示例 -->
<c:choose>
    <c:when test="${not empty param.amount}">
        <!-- 尝试解析用户输入的金额 -->
        <c:catch var="parseError">
            <fmt:parseNumber value="${param.amount}" var="parsedAmount" />
        </c:catch>
        
        <c:choose>
            <c:when test="${empty parseError}">
                <!-- 解析成功，显示格式化结果 -->
                <p>✅ 输入金额：<fmt:formatNumber value="${parsedAmount}" type="currency" currencySymbol="￥" /></p>
                
                <!-- 进行业务计算 -->
                <c:set var="serviceFee" value="${parsedAmount * 0.05}" />
                <p>服务费 (5%)：<fmt:formatNumber value="${serviceFee}" type="currency" currencySymbol="￥" /></p>
                
                <c:set var="total" value="${parsedAmount + serviceFee}" />
                <p>总计：<fmt:formatNumber value="${total}" type="currency" currencySymbol="￥" /></p>
            </c:when>
            <c:otherwise>
                <!-- 解析失败，显示错误信息 -->
                <p class="error">❌ 请输入有效的金额格式</p>
            </c:otherwise>
        </c:choose>
    </c:when>
</c:choose>
```

---

## 7. 📋 核心要点总结


### 7.1 必须掌握的核心概念


```
🔸 数字格式化的作用：让数字显示更友好，提升用户体验
🔸 formatNumber核心属性：value(数值)、type(类型)、pattern(模式)
🔸 三种格式类型：number(普通)、currency(货币)、percent(百分比)
🔸 parseNumber作用：将格式化字符串解析回数字，用于计算
🔸 pattern模式：自定义数字显示格式的强大工具
```

### 7.2 关键理解要点


**🔹 格式化类型的选择**
```
使用原则：
💰 显示价格 → 使用 currency 类型
📊 显示比率 → 使用 percent 类型  
🔢 普通数字 → 使用 number 类型
🎨 特殊需求 → 使用 pattern 自定义
```

**🔹 pattern模式的理解**
```
模式符号含义：
# → 可选数字位 (123 用 ### → 123)
0 → 必需数字位 (123 用 000000 → 000123)  
, → 千分位分隔符
. → 小数点
% → 百分号
文字 → 直接显示的文字
```

**🔹 数据流向理解**
```
完整流程：
原始数据 → formatNumber格式化 → 用户友好显示
用户输入 → parseNumber解析 → 程序可用数据
```

### 7.3 实际应用指导


**💡 最佳实践建议**
```
✅ 推荐做法：
• 价格显示统一使用货币格式
• 百分比数据注意小数和百分数的转换
• 大数字使用千分位分隔符提高可读性
• 关键数据保留适当的小数位数

❌ 避免的问题：
• 不要在所有地方都显示过多小数位
• 注意百分比数据的数值范围 (0-1 vs 0-100)
• 解析用户输入时要处理可能的异常
• 不要忽略国际化的货币符号差异
```

**🎯 记忆要点**
```
核心记忆：
1️⃣ formatNumber = 数字变漂亮
2️⃣ parseNumber = 字符串变数字  
3️⃣ type属性 = 选择显示类型
4️⃣ pattern属性 = 自定义显示格式
5️⃣ 货币用currency，比率用percent
```

### 7.4 调试和问题解决


**🔧 常见问题及解决**
```
问题：百分比显示不正确
解决：检查数据范围，0.25显示为25%，25显示为2500%

问题：货币符号显示异常  
解决：明确指定currencySymbol="￥"

问题：parseNumber解析失败
解决：使用<c:catch>捕获异常，提供用户友好的错误提示

问题：数字精度丢失
解决：合理设置maxFractionDigits和minFractionDigits
```

**核心记忆口诀**：
- 数字格式化，用户体验佳
- formatNumber显示美，parseNumber解析回
- 货币百分有类型，pattern模式最灵活
- 千分逗号加可读，小数精度要控制