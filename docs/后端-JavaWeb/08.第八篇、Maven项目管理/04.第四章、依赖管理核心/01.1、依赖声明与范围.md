---
title: 1、依赖声明与范围
---
## 📚 目录

1. [什么是依赖管理](#1-什么是依赖管理)
2. [依赖声明基础](#2-依赖声明基础)
3. [依赖范围详解](#3-依赖范围详解)
4. [依赖坐标系统](#4-依赖坐标系统)
5. [实际应用场景](#5-实际应用场景)
6. [核心要点总结](#6-核心要点总结)

---

## 1. 🎯 什么是依赖管理


### 1.1 生活中的依赖关系


想象一下做菜的场景：
```
做红烧肉需要：
├── 五花肉（主材料）
├── 生抽、老抽（调料）
├── 糖、盐（基础调料）
├── 葱姜蒜（配菜）
└── 锅具（工具）

如果缺少任何一样，菜就做不成功
```

**Maven依赖管理就是这个道理**：
- 🏗️ **你的项目**就像要做的菜
- 📦 **jar包**就像做菜的材料
- 🔧 **Maven**就像智能管家，帮你自动准备所有材料

### 1.2 为什么需要依赖管理


**传统方式的痛苦**：
```
❌ 手动下载jar包 → 容易下错版本
❌ 复制到lib目录 → 项目文件夹臃肿
❌ 配置classpath → 路径配置复杂
❌ 版本冲突 → 不知道哪个包有问题
❌ 团队协作 → 每个人环境不一样
```

**Maven方式的便利**：
```
✅ 一个配置文件搞定 → pom.xml
✅ 自动下载jar包 → 不用手动找
✅ 自动管理版本 → 避免冲突
✅ 统一团队环境 → 大家用相同的包
✅ 项目更干净 → 只有源代码
```

---

## 2. 📝 依赖声明基础


### 2.1 dependency标签的作用


`<dependency>` 标签就像**购物清单**，告诉Maven你需要什么：

```xml
<dependencies>
    <!-- 这就是一个依赖声明 -->
    <dependency>
        <groupId>mysql</groupId>           <!-- 厂商名 -->
        <artifactId>mysql-connector-java</artifactId>  <!-- 产品名 -->
        <version>8.0.33</version>          <!-- 版本号 -->
    </dependency>
</dependencies>
```

**通俗理解**：
- **就像网购**：你在购物车里加商品，Maven帮你下单配送
- **购物清单**：`<dependencies>` 是整个清单，每个 `<dependency>` 是一行商品
- **商品信息**：厂商+产品+版本，确保买对东西

### 2.2 依赖声明的位置


```xml
<project>
    <groupId>com.example</groupId>
    <artifactId>my-web-project</artifactId>
    <version>1.0.0</version>
    
    <!-- 依赖声明必须放在这里 -->
    <dependencies>
        <!-- 所有需要的jar包都在这里声明 -->
    </dependencies>
</project>
```

> 💡 **新手提醒**：`<dependencies>` 标签必须放在 `<project>` 根标签下，和 `<groupId>` 这些标签平级

---

## 3. 🔍 依赖范围详解


### 3.1 为什么需要依赖范围


**生活场景类比**：
```
工作场景：
├── 办公室用品 → 只在公司用（provided）
├── 个人物品 → 到哪都要带（compile）  
├── 健身用品 → 只在健身房用（test）
└── 临时用品 → 用完就扔（runtime）
```

**Maven也一样**，不同的jar包在不同时候需要：
- 🏢 **编译时需要** - 写代码时要用
- 🏃 **运行时需要** - 程序跑起来时要用  
- 🧪 **测试时需要** - 跑单元测试时要用
- 📦 **打包时需要** - 部署到服务器时要用

### 3.2 compile - 默认范围（最常用）


**含义**：编译、运行、测试、打包都需要

```xml
<dependency>
    <groupId>mysql</groupId>
    <artifactId>mysql-connector-java</artifactId>
    <version>8.0.33</version>
    <!-- 不写scope，默认就是compile -->
    <scope>compile</scope>
</dependency>
```

**什么时候用**：
- ✅ 数据库驱动（MySQL、PostgreSQL）
- ✅ 工具类库（Apache Commons、Guava）
- ✅ 日志框架（Logback、Log4j）
- ✅ JSON处理（Jackson、Gson）

**通俗理解**：就像**手机**，工作生活都离不开，到哪都要带着

### 3.3 provided - 容器提供（Web开发常用）


**含义**：编译和测试时需要，但运行时由容器提供

```xml
<dependency>
    <groupId>javax.servlet</groupId>
    <artifactId>javax.servlet-api</artifactId>
    <version>4.0.1</version>
    <scope>provided</scope>
</dependency>
```

**生活场景**：
```
就像公司提供的：
├── 办公电脑 → 上班时用，下班不带走
├── 打印机 → 需要时用，但不用买
├── 会议室 → 开会时用，公司提供
└── 网络环境 → 必须要有，但不用自己搭建
```

**什么时候用**：
- ✅ Servlet API - Tomcat已经有了
- ✅ JSP API - Web容器提供
- ✅ JUnit（某些情况） - IDE已集成

**通俗理解**：就像**公司WiFi**，办公时必须用，但不用自己装

### 3.4 runtime - 运行时依赖


**含义**：运行时需要，但编译时不需要

```xml
<dependency>
    <groupId>mysql</groupId>
    <artifactId>mysql-connector-java</artifactId>
    <version>8.0.33</version>
    <scope>runtime</scope>
</dependency>
```

**典型场景**：
```
数据库驱动的使用：

编译时：
├── 只需要JDBC接口（JDK自带）
└── 不需要具体的MySQL驱动类

运行时：
├── 需要MySQL驱动实现
└── 通过反射动态加载
```

**什么时候用**：
- ✅ 数据库驱动包
- ✅ 日志实现包（SLF4J的具体实现）
- ✅ 一些运行时才确定的包

### 3.5 test - 测试专用


**含义**：只在测试时需要

```xml
<dependency>
    <groupId>junit</groupId>
    <artifactId>junit</artifactId>
    <version>4.13.2</version>
    <scope>test</scope>
</dependency>
```

**什么时候用**：
- ✅ JUnit测试框架
- ✅ Mockito模拟工具
- ✅ 测试数据库（H2、HSQLDB）

**通俗理解**：就像**体检设备**，只有体检时才用，平时不需要

### 3.6 system - 系统依赖（很少用）


**含义**：类似provided，但jar包位置由你指定

```xml
<dependency>
    <groupId>com.example</groupId>
    <artifactId>custom-lib</artifactId>
    <version>1.0</version>
    <scope>system</scope>
    <systemPath>${basedir}/lib/custom-lib.jar</systemPath>
</dependency>
```

> ⚠️ **新手注意**：system范围很少用，因为不利于项目移植，尽量避免

### 3.7 import - 导入范围（高级用法）


**含义**：只能用在dependencyManagement中，用于导入BOM

```xml
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-dependencies</artifactId>
            <version>2.7.0</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
    </dependencies>
</dependencyManagement>
```

> 💡 **新手提示**：这是高级用法，初学阶段了解即可

---

## 4. 🎯 依赖坐标系统


### 4.1 Maven坐标的三要素


**就像快递地址**，每个jar包都有唯一标识：

```
现实地址：
├── 省份 → groupId（组织/公司）
├── 城市 → artifactId（项目名称）  
└── 门牌号 → version（版本号）

Maven坐标：
├── groupId → 通常是公司域名反写
├── artifactId → 具体的项目或模块名
└── version → 版本号
```

### 4.2 坐标命名规则


**groupId命名**：
```xml
<!-- 公司域名反写 -->
<groupId>com.alibaba</groupId>          <!-- 阿里巴巴 -->
<groupId>org.springframework</groupId>   <!-- Spring官方 -->
<groupId>org.apache.commons</groupId>    <!-- Apache基金会 -->
<groupId>mysql</groupId>                 <!-- MySQL官方 -->
```

**artifactId命名**：
```xml
<!-- 项目或模块的具体名称 -->
<artifactId>fastjson</artifactId>        <!-- 阿里的JSON库 -->
<artifactId>spring-core</artifactId>     <!-- Spring核心模块 -->
<artifactId>commons-lang3</artifactId>   <!-- Apache工具包 -->
<artifactId>mysql-connector-java</artifactId>  <!-- MySQL驱动 -->
```

**version命名**：
```xml
<!-- 版本号命名规范 -->
<version>1.2.83</version>      <!-- 主版本.次版本.修订版本 -->
<version>2.7.0-RELEASE</version>   <!-- 带发布状态 -->
<version>3.0.0-SNAPSHOT</version>  <!-- 开发版本 -->
```

### 4.3 完整依赖示例


```xml
<dependencies>
    <!-- MySQL数据库驱动 -->
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>8.0.33</version>
    </dependency>
    
    <!-- 阿里巴巴JSON处理 -->
    <dependency>
        <groupId>com.alibaba</groupId>
        <artifactId>fastjson</artifactId>
        <version>1.2.83</version>
    </dependency>
    
    <!-- JUnit测试框架 -->
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.13.2</version>
        <scope>test</scope>
    </dependency>
</dependencies>
```

---

## 5. 🚀 实际应用场景


### 5.1 Web项目常用依赖配置


```xml
<dependencies>
    <!-- Servlet API - Web开发必需 -->
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>javax.servlet-api</artifactId>
        <version>4.0.1</version>
        <scope>provided</scope>  <!-- Tomcat提供 -->
    </dependency>
    
    <!-- MySQL驱动 - 数据库连接 -->
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>8.0.33</version>
        <scope>runtime</scope>   <!-- 运行时加载 -->
    </dependency>
    
    <!-- Jackson - JSON处理 -->
    <dependency>
        <groupId>com.fasterxml.jackson.core</groupId>
        <artifactId>jackson-databind</artifactId>
        <version>2.15.2</version>
        <!-- 默认compile，编译运行都需要 -->
    </dependency>
    
    <!-- JUnit - 单元测试 -->
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.13.2</version>
        <scope>test</scope>      <!-- 只测试时需要 -->
    </dependency>
</dependencies>
```

### 5.2 不同范围的使用时机


| 依赖范围 | **编译时** | **测试时** | **运行时** | **打包时** | **典型用途** |
|---------|-----------|-----------|-----------|-----------|-------------|
| 🔵 **compile** | `✅` | `✅` | `✅` | `✅` | `工具库、框架核心` |
| 🟡 **provided** | `✅` | `✅` | `❌` | `❌` | `Servlet API、JSP API` |
| 🟢 **runtime** | `❌` | `✅` | `✅` | `✅` | `数据库驱动、日志实现` |
| 🟣 **test** | `❌` | `✅` | `❌` | `❌` | `JUnit、Mockito` |
| 🔴 **system** | `✅` | `✅` | `❌` | `❌` | `本地jar包（不推荐）` |

### 5.3 常见问题与解决


**问题1**：编译时找不到类
```xml
<!-- 错误：数据库驱动设置为provided -->
<dependency>
    <groupId>mysql</groupId>
    <artifactId>mysql-connector-java</artifactId>
    <version>8.0.33</version>
    <scope>provided</scope>  ❌
</dependency>

<!-- 正确：应该用runtime或compile -->
<scope>runtime</scope>  ✅
```

**问题2**：Web应用启动时jar包冲突
```xml
<!-- 错误：Servlet API用compile -->
<dependency>
    <groupId>javax.servlet</groupId>
    <artifactId>javax.servlet-api</artifactId>
    <version>4.0.1</version>
    <!-- 默认compile会打包到war中 -->  ❌
</dependency>

<!-- 正确：应该用provided -->
<scope>provided</scope>  ✅
```

---

## 6. 📋 核心要点总结


### 6.1 必须掌握的核心概念


```
🔸 依赖管理：Maven自动下载和管理项目所需的jar包
🔸 dependency标签：声明项目需要的外部jar包
🔸 依赖坐标：groupId + artifactId + version 唯一标识jar包
🔸 依赖范围：控制jar包在不同阶段的可见性
🔸 scope属性：决定依赖在什么时候需要
```

### 6.2 依赖范围使用指南


**🎯 选择标准**：
```
compile（默认）：
├── 什么时候用：工具库、框架核心、业务代码需要的包
├── 典型例子：Jackson、MyBatis、Spring核心包
└── 记忆方法：最常用，默认选择

provided：  
├── 什么时候用：容器已提供的包
├── 典型例子：Servlet API、JSP API
└── 记忆方法：公司提供的设备，不用自己买

runtime：
├── 什么时候用：运行时才需要，编译时不直接使用
├── 典型例子：数据库驱动、日志实现
└── 记忆方法：幕后工作者，默默提供服务

test：
├── 什么时候用：只有测试时才需要
├── 典型例子：JUnit、Mockito、测试数据库
└── 记忆方法：体检设备，平时用不到
```

### 6.3 实践建议


**🔧 配置技巧**：
- **Web项目模板**：Servlet API用provided，数据库驱动用runtime
- **版本管理**：尽量使用稳定版本，避免SNAPSHOT
- **坐标查找**：使用[Maven Central](https://search.maven.org/)查找准确坐标
- **依赖清理**：定期检查不用的依赖，保持pom.xml整洁

**⚠️ 常见错误**：
- 不要把Servlet API设置为compile，会导致jar包冲突
- 不要把JUnit设置为compile，会增加打包体积
- 注意版本兼容性，不要随意升级大版本

**💡 学习建议**：
- 从常用的几个依赖开始练习
- 理解每个范围的使用场景
- 动手实践，观察不同范围的效果
- 遇到问题时先检查依赖范围是否正确

**核心记忆口诀**：
- Maven管依赖，自动很方便
- 坐标三要素，定位不会错  
- 范围要选对，编译运行清
- provided容器供，runtime后台撑