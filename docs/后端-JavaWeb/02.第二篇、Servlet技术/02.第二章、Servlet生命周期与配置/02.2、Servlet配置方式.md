---
title: 2ã€Servleté…ç½®æ–¹å¼
---
## ğŸ“š ç›®å½•

1. [Servleté…ç½®æ¦‚è¿°](#1-Servleté…ç½®æ¦‚è¿°)
2. [web.xmlä¼ ç»Ÿé…ç½®æ–¹å¼](#2-webxmlä¼ ç»Ÿé…ç½®æ–¹å¼)
3. [@WebServletæ³¨è§£é…ç½®](#3-WebServletæ³¨è§£é…ç½®)
4. [URLæ˜ å°„è§„åˆ™è¯¦è§£](#4-URLæ˜ å°„è§„åˆ™è¯¦è§£)
5. [å¯åŠ¨é¡ºåºæ§åˆ¶](#5-å¯åŠ¨é¡ºåºæ§åˆ¶)
6. [åˆå§‹åŒ–å‚æ•°é…ç½®](#6-åˆå§‹åŒ–å‚æ•°é…ç½®)
7. [é…ç½®ä¼˜å…ˆçº§ä¸æœ€ä½³å®è·µ](#7-é…ç½®ä¼˜å…ˆçº§ä¸æœ€ä½³å®è·µ)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ Servleté…ç½®æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯Servleté…ç½®

**é€šä¿—ç†è§£**ï¼šå°±åƒç»™ä½ å®¶å®‰è£…é—¨ç‰Œå·ä¸€æ ·ï¼ŒServleté…ç½®å°±æ˜¯å‘Šè¯‰WebæœåŠ¡å™¨"å½“ç”¨æˆ·è®¿é—®å“ªä¸ªç½‘å€æ—¶ï¼Œåº”è¯¥è°ƒç”¨å“ªä¸ªServletæ¥å¤„ç†"ã€‚

```
ç”¨æˆ·è®¿é—®ï¼šhttp://localhost:8080/myapp/login
    â†“
æœåŠ¡å™¨æŸ¥çœ‹é…ç½®ï¼šå“¦ï¼Œ/loginè¿™ä¸ªè·¯å¾„å¯¹åº”LoginServlet
    â†“  
è°ƒç”¨LoginServletæ¥å¤„ç†è¿™ä¸ªè¯·æ±‚
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦é…ç½®

**ğŸ”¸ æ ¸å¿ƒä½œç”¨**ï¼š
- **URLæ˜ å°„**ï¼šå»ºç«‹ç½‘å€è·¯å¾„å’ŒServletä¹‹é—´çš„å¯¹åº”å…³ç³»
- **å‚æ•°ä¼ é€’**ï¼šç»™Servletä¼ é€’ä¸€äº›åˆå§‹åŒ–å‚æ•°
- **å¯åŠ¨æ§åˆ¶**ï¼šå†³å®šServletä»€ä¹ˆæ—¶å€™è¢«åˆ›å»º
- **è®¿é—®æ§åˆ¶**ï¼šæ§åˆ¶å“ªäº›è·¯å¾„å¯ä»¥è®¿é—®

**ç”Ÿæ´»ç±»æ¯”**ï¼š
```
é…ç½®Servlet = è®¾ç½®å¿«é€’æŠ•é€’è§„åˆ™
URLè·¯å¾„ = æ”¶ä»¶åœ°å€
Servlet = æ”¶ä»¶äºº
é…ç½®æ–‡ä»¶ = æŠ•é€’è§„åˆ™è¡¨

å½“å¿«é€’ï¼ˆè¯·æ±‚ï¼‰åˆ°è¾¾æ—¶ï¼Œå¿«é€’å‘˜ï¼ˆæœåŠ¡å™¨ï¼‰æŸ¥çœ‹è§„åˆ™è¡¨ï¼Œ
çŸ¥é“è¿™ä¸ªåœ°å€çš„åŒ…è£¹åº”è¯¥ç»™è°ï¼ˆå“ªä¸ªServletï¼‰
```

### 1.3 é…ç½®æ–¹å¼å¯¹æ¯”


| é…ç½®æ–¹å¼ | **ä¼˜ç‚¹** | **ç¼ºç‚¹** | **é€‚ç”¨åœºæ™¯** |
|---------|---------|---------|-------------|
| ğŸ—‚ï¸ **web.xmlé…ç½®** | `é›†ä¸­ç®¡ç†ï¼Œç»“æ„æ¸…æ™°` | `é…ç½®ç¹çï¼Œä¿®æ”¹éœ€é‡å¯` | `å¤§å‹é¡¹ç›®ï¼Œå¤æ‚é…ç½®` |
| ğŸ“‹ **@WebServletæ³¨è§£** | `ç®€æ´æ–¹ä¾¿ï¼Œå°±è¿‘é…ç½®` | `åˆ†æ•£ç®¡ç†ï¼Œéš¾ä»¥ç»Ÿè§ˆ` | `å°å‹é¡¹ç›®ï¼Œç®€å•é…ç½®` |

---

## 2. ğŸ“„ web.xmlä¼ ç»Ÿé…ç½®æ–¹å¼


### 2.1 web.xmlæ˜¯ä»€ä¹ˆ

**é€šä¿—è§£é‡Š**ï¼š`web.xml`å°±åƒæ˜¯ä¸€ä¸ªWebåº”ç”¨çš„"æˆ·å£æœ¬"ï¼Œè®°å½•äº†è¿™ä¸ªåº”ç”¨çš„åŸºæœ¬ä¿¡æ¯å’Œè§„åˆ™ã€‚

**ğŸ“ æ–‡ä»¶ä½ç½®**ï¼š
```
é¡¹ç›®ç»“æ„ï¼š
MyWebApp/
  â”œâ”€â”€ src/
  â”œâ”€â”€ WebContent/
      â””â”€â”€ WEB-INF/
          â””â”€â”€ web.xml  â† å°±åœ¨è¿™é‡Œï¼
```

### 2.2 åŸºæœ¬é…ç½®è¯­æ³•


**ğŸ”¸ å®Œæ•´é…ç½®ç¤ºä¾‹**ï¼š
```xml
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee" version="3.0">
    
    <!-- ç¬¬ä¸€æ­¥ï¼šå£°æ˜Servlet -->
    <servlet>
        <servlet-name>LoginServlet</servlet-name>
        <servlet-class>com.example.LoginServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    
    <!-- ç¬¬äºŒæ­¥ï¼šæ˜ å°„URL -->
    <servlet-mapping>
        <servlet-name>LoginServlet</servlet-name>
        <url-pattern>/login</url-pattern>
    </servlet-mapping>
    
</web-app>
```

**ğŸ”¹ é…ç½®æ­¥éª¤è§£æ**ï¼š
```
æ­¥éª¤1ï¼š<servlet>æ ‡ç­¾
ä½œç”¨ï¼šå‘æœåŠ¡å™¨ä»‹ç»"æˆ‘æœ‰ä¸€ä¸ªå«LoginServletçš„å‘˜å·¥"
å†…å®¹ï¼šå‘˜å·¥å§“å(servlet-name)å’Œå‘˜å·¥èƒ½åŠ›(servlet-class)

æ­¥éª¤2ï¼š<servlet-mapping>æ ‡ç­¾  
ä½œç”¨ï¼šå‘Šè¯‰æœåŠ¡å™¨"å½“å®¢æˆ·è®¿é—®/loginæ—¶ï¼Œè®©LoginServletå¤„ç†"
å†…å®¹ï¼šå‘˜å·¥å§“å(servlet-name)å’Œå·¥ä½œèŒƒå›´(url-pattern)
```

### 2.3 é…ç½®æ ‡ç­¾è¯¦è§£


**ğŸ¯ æ ¸å¿ƒæ ‡ç­¾å«ä¹‰**ï¼š

| æ ‡ç­¾ | **ä½œç”¨** | **é€šä¿—ç†è§£** | **ç¤ºä¾‹** |
|-----|---------|-------------|---------|
| `<servlet-name>` | Servletçš„åˆ«å | ç»™å‘˜å·¥èµ·ä¸ªå·¥å· | `LoginServlet` |
| `<servlet-class>` | Servletçš„å®Œæ•´ç±»å | å‘˜å·¥çš„çœŸå®å§“å | `com.example.LoginServlet` |
| `<url-pattern>` | URLåŒ¹é…æ¨¡å¼ | å‘˜å·¥è´Ÿè´£çš„å·¥ä½œèŒƒå›´ | `/login` |
| `<load-on-startup>` | å¯åŠ¨é¡ºåº | å‘˜å·¥ä¸Šç­çš„å…ˆåé¡ºåº | `1` |

**âš ï¸ å¸¸è§é”™è¯¯**ï¼š
```xml
<!-- âŒ é”™è¯¯å†™æ³• -->
<servlet-name>LoginServlet</servlet-name>
<servlet-mapping>
    <servlet-name>loginServlet</servlet-name>  <!-- å¤§å°å†™ä¸åŒ¹é…ï¼ -->
</servlet-mapping>

<!-- âœ… æ­£ç¡®å†™æ³• -->
<servlet-name>LoginServlet</servlet-name>
<servlet-mapping>
    <servlet-name>LoginServlet</servlet-name>  <!-- å®Œå…¨ä¸€è‡´ -->
</servlet-mapping>
```

### 2.4 å¤šä¸ªURLæ˜ å°„


**ä¸€ä¸ªServletå¤„ç†å¤šä¸ªè·¯å¾„**ï¼š
```xml
<servlet>
    <servlet-name>UserServlet</servlet-name>
    <servlet-class>com.example.UserServlet</servlet-class>
</servlet>

<!-- ä¸€ä¸ªServletå¯ä»¥æœ‰å¤šä¸ªæ˜ å°„ -->
<servlet-mapping>
    <servlet-name>UserServlet</servlet-name>
    <url-pattern>/user/login</url-pattern>
</servlet-mapping>

<servlet-mapping>
    <servlet-name>UserServlet</servlet-name>
    <url-pattern>/user/register</url-pattern>
</servlet-mapping>
```

**ç”Ÿæ´»ç±»æ¯”**ï¼š
```
å°±åƒä¸€ä¸ªå¤šæ‰å¤šè‰ºçš„å‘˜å·¥ï¼š
- å¼ ä¸‰æ—¢èƒ½å¤„ç†ç™»å½•ä¸šåŠ¡(/login)
- ä¹Ÿèƒ½å¤„ç†æ³¨å†Œä¸šåŠ¡(/register)  
- è¿˜èƒ½å¤„ç†ä¸ªäººä¿¡æ¯ä¸šåŠ¡(/profile)
```

---

## 3. ğŸ“‹ @WebServletæ³¨è§£é…ç½®


### 3.1 æ³¨è§£é…ç½®çš„ä¼˜åŠ¿

**é€šä¿—ç†è§£**ï¼šå¦‚æœè¯´web.xmlæ˜¯"é›†ä¸­åŠå…¬"ï¼Œé‚£ä¹ˆæ³¨è§£å°±æ˜¯"å°±è¿‘åŠå…¬"â€”â€”é…ç½®ä¿¡æ¯ç›´æ¥å†™åœ¨Servletç±»ä¸Šï¼Œæ›´åŠ ç›´è§‚æ–¹ä¾¿ã€‚

### 3.2 åŸºæœ¬æ³¨è§£è¯­æ³•


**ğŸ”¸ æœ€ç®€å•çš„é…ç½®**ï¼š
```java
@WebServlet("/login")
public class LoginServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, 
                        HttpServletResponse response) {
        // å¤„ç†ç™»å½•è¯·æ±‚
    }
}
```

**ğŸ”¸ å®Œæ•´é…ç½®ç¤ºä¾‹**ï¼š
```java
@WebServlet(
    name = "LoginServlet",           // Servletåç§°
    urlPatterns = {"/login", "/signin"},  // æ”¯æŒå¤šä¸ªURL
    loadOnStartup = 1,               // å¯åŠ¨é¡ºåº
    initParams = {                   // åˆå§‹åŒ–å‚æ•°
        @WebInitParam(name = "encoding", value = "UTF-8"),
        @WebInitParam(name = "timeout", value = "30")
    }
)
public class LoginServlet extends HttpServlet {
    // Servletå®ç°ä»£ç 
}
```

### 3.3 æ³¨è§£å±æ€§è¯¦è§£


**ğŸ¯ ä¸»è¦å±æ€§è¯´æ˜**ï¼š

| å±æ€§ | **ç±»å‹** | **ä½œç”¨** | **é€šä¿—ç†è§£** |
|-----|---------|---------|-------------|
| `value` / `urlPatterns` | `String[]` | URLè·¯å¾„ | è¿™ä¸ªå‘˜å·¥è´Ÿè´£å“ªäº›å·¥ä½œ |
| `name` | `String` | Servletåç§° | ç»™å‘˜å·¥èµ·ä¸ªå·¥å· |
| `loadOnStartup` | `int` | å¯åŠ¨é¡ºåº | å‘˜å·¥ä¸Šç­çš„å…ˆåé¡ºåº |
| `initParams` | `WebInitParam[]` | åˆå§‹åŒ–å‚æ•° | ç»™å‘˜å·¥çš„å·¥ä½œæŒ‡å¯¼æ‰‹å†Œ |

**ğŸ”¹ å®ç”¨æŠ€å·§**ï¼š
```java
// æŠ€å·§1ï¼šå¤šè·¯å¾„æ˜ å°„
@WebServlet({"/user", "/user/*", "/member"})

// æŠ€å·§2ï¼šé€šé…ç¬¦ä½¿ç”¨
@WebServlet("/api/*")  // åŒ¹é… /api/login, /api/register ç­‰

// æŠ€å·§3ï¼šæ–‡ä»¶æ‰©å±•ååŒ¹é…
@WebServlet("*.do")    // åŒ¹é…æ‰€æœ‰.doç»“å°¾çš„è¯·æ±‚
```

### 3.4 æ³¨è§£vsé…ç½®æ–‡ä»¶å¯¹æ¯”


**ğŸ”„ åŒæ ·åŠŸèƒ½çš„ä¸¤ç§å†™æ³•**ï¼š

```java
// æ³¨è§£æ–¹å¼
@WebServlet(
    name = "UserServlet",
    urlPatterns = "/user",
    loadOnStartup = 1
)
public class UserServlet extends HttpServlet { }
```

```xml
<!-- web.xmlæ–¹å¼ -->
<servlet>
    <servlet-name>UserServlet</servlet-name>
    <servlet-class>com.example.UserServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>UserServlet</servlet-name>
    <url-pattern>/user</url-pattern>
</servlet-mapping>
```

---

## 4. ğŸ—ºï¸ URLæ˜ å°„è§„åˆ™è¯¦è§£


### 4.1 URLæ˜ å°„çš„å·¥ä½œåŸç†

**é€šä¿—ç†è§£**ï¼šURLæ˜ å°„å°±åƒç»™æ¯ä¸ªæˆ¿é—´è´´é—¨ç‰Œå·ï¼Œå½“æœ‰äººæŒ‰é—¨é“ƒï¼ˆå‘è¯·æ±‚ï¼‰æ—¶ï¼ŒæœåŠ¡å™¨æ ¹æ®é—¨ç‰Œå·ï¼ˆURLï¼‰æ‰¾åˆ°å¯¹åº”çš„æˆ¿é—´ï¼ˆServletï¼‰ã€‚

```
ç”¨æˆ·è¯·æ±‚æµç¨‹ï¼š
æµè§ˆå™¨å‘èµ·è¯·æ±‚ â†’ æœåŠ¡å™¨æ¥æ”¶URL â†’ æŸ¥æ‰¾åŒ¹é…è§„åˆ™ â†’ æ‰¾åˆ°å¯¹åº”Servlet â†’ æ‰§è¡Œå¤„ç†
```

### 4.2 æ˜ å°„è§„åˆ™ç±»å‹


**ğŸ¯ å››ç§ä¸»è¦æ˜ å°„æ–¹å¼**ï¼š

| æ˜ å°„ç±»å‹ | **æ ¼å¼** | **åŒ¹é…è§„åˆ™** | **ä¼˜å…ˆçº§** |
|---------|---------|-------------|-----------|
| ğŸ¯ **ç²¾ç¡®åŒ¹é…** | `/login` | å®Œå…¨ç›¸ç­‰ | **æœ€é«˜** |
| ğŸ“ **è·¯å¾„åŒ¹é…** | `/user/*` | è·¯å¾„å‰ç¼€åŒ¹é… | **é«˜** |
| ğŸ“„ **æ‰©å±•ååŒ¹é…** | `*.jsp` | æ–‡ä»¶æ‰©å±•ååŒ¹é… | **ä¸­** |
| ğŸŒŸ **é»˜è®¤åŒ¹é…** | `/` | å…¶ä»–éƒ½ä¸åŒ¹é…æ—¶ | **æœ€ä½** |

### 4.3 ç²¾ç¡®åŒ¹é…è¯¦è§£


**ğŸ”¸ ç²¾ç¡®åŒ¹é…ç‰¹ç‚¹**ï¼š
- è·¯å¾„å¿…é¡»å®Œå…¨ä¸€è‡´
- ä¼˜å…ˆçº§æœ€é«˜ï¼Œä¼˜å…ˆåŒ¹é…

```java
@WebServlet("/login")  // åªåŒ¹é… /login
@WebServlet("/user/profile")  // åªåŒ¹é… /user/profile
```

**åŒ¹é…ç¤ºä¾‹**ï¼š
```
URL: http://localhost:8080/app/login
æ˜ å°„: /login  
ç»“æœ: âœ… åŒ¹é…æˆåŠŸ

URL: http://localhost:8080/app/login/
æ˜ å°„: /login
ç»“æœ: âŒ åŒ¹é…å¤±è´¥ (å¤šäº†ä¸ªæ–œæ )
```

### 4.4 è·¯å¾„åŒ¹é…è¯¦è§£


**ğŸ”¸ è·¯å¾„åŒ¹é…è§„åˆ™**ï¼š
- ä»¥`/*`ç»“å°¾çš„æ¨¡å¼
- åŒ¹é…æŒ‡å®šè·¯å¾„ä¸‹çš„æ‰€æœ‰å­è·¯å¾„

```java
@WebServlet("/user/*")
```

**åŒ¹é…èŒƒå›´å›¾ç¤º**ï¼š
```
/user/*  å¯ä»¥åŒ¹é…ï¼š
  âœ… /user/login
  âœ… /user/register  
  âœ… /user/profile/edit
  âœ… /user/admin/delete
  
ä¸èƒ½åŒ¹é…ï¼š
  âŒ /login
  âŒ /admin/user
```

### 4.5 æ‰©å±•ååŒ¹é…è¯¦è§£


**ğŸ”¸ æ‰©å±•ååŒ¹é…ç‰¹ç‚¹**ï¼š
- ä»¥`*`å¼€å¤´ï¼Œæ‰©å±•åç»“å°¾
- æ ¹æ®æ–‡ä»¶æ‰©å±•ååŒ¹é…

```java
@WebServlet("*.do")   // åŒ¹é…æ‰€æœ‰.doè¯·æ±‚
@WebServlet("*.action")  // åŒ¹é…æ‰€æœ‰.actionè¯·æ±‚
```

**å®é™…åº”ç”¨åœºæ™¯**ï¼š
```
*.jsp â†’ JSPé¡µé¢å¤„ç†
*.do  â†’ Strutsæ¡†æ¶å¸¸ç”¨
*.action â†’ å¦ä¸€ç§Actionæ¨¡å¼
*.api â†’ RESTful APIæ¥å£
```

### 4.6 åŒ¹é…ä¼˜å…ˆçº§å®ä¾‹


**ğŸ”„ å½“å¤šä¸ªè§„åˆ™éƒ½èƒ½åŒ¹é…æ—¶çš„ä¼˜å…ˆé¡ºåº**ï¼š

```java
// å‡è®¾æœ‰ä»¥ä¸‹é…ç½®
@WebServlet("/user/login")     // ç²¾ç¡®åŒ¹é…
class LoginServlet { }

@WebServlet("/user/*")         // è·¯å¾„åŒ¹é…  
class UserServlet { }

@WebServlet("*.do")           // æ‰©å±•ååŒ¹é…
class ActionServlet { }

@WebServlet("/")              // é»˜è®¤åŒ¹é…
class DefaultServlet { }
```

**åŒ¹é…æµ‹è¯•**ï¼š
```
è¯·æ±‚: /user/login
åŒ¹é…ç»“æœ: LoginServlet (ç²¾ç¡®åŒ¹é…ä¼˜å…ˆçº§æœ€é«˜)

è¯·æ±‚: /user/register  
åŒ¹é…ç»“æœ: UserServlet (è·¯å¾„åŒ¹é…)

è¯·æ±‚: /test.do
åŒ¹é…ç»“æœ: ActionServlet (æ‰©å±•ååŒ¹é…)

è¯·æ±‚: /other/page
åŒ¹é…ç»“æœ: DefaultServlet (é»˜è®¤åŒ¹é…)
```

---

## 5. ğŸš€ å¯åŠ¨é¡ºåºæ§åˆ¶


### 5.1 ä»€ä¹ˆæ˜¯å¯åŠ¨é¡ºåº

**é€šä¿—ç†è§£**ï¼šå°±åƒå…¬å¸ä¸Šç­ä¸€æ ·ï¼Œæœ‰äº›é‡è¦å‘˜å·¥éœ€è¦æ—©ç‚¹åˆ°ï¼Œæœ‰äº›å¯ä»¥æ™šç‚¹æ¥ã€‚`load-on-startup`å°±æ˜¯è§„å®šServletçš„"ä¸Šç­æ—¶é—´"ã€‚

**ğŸ”¸ é»˜è®¤è¡Œä¸º**ï¼š
```
æ­£å¸¸æƒ…å†µï¼šServletåœ¨ç¬¬ä¸€æ¬¡è¢«è®¿é—®æ—¶æ‰åˆ›å»ºï¼ˆæ‡’åŠ è½½ï¼‰
è®¾ç½®å¯åŠ¨é¡ºåºï¼šServletåœ¨æœåŠ¡å™¨å¯åŠ¨æ—¶å°±åˆ›å»ºï¼ˆé¢„åŠ è½½ï¼‰
```

### 5.2 å¯åŠ¨é¡ºåºé…ç½®


**æ³¨è§£æ–¹å¼**ï¼š
```java
@WebServlet(value = "/init", loadOnStartup = 1)
public class InitServlet extends HttpServlet {
    public void init() {
        System.out.println("InitServletå¯åŠ¨äº†ï¼");
        // æ‰§è¡Œä¸€äº›åˆå§‹åŒ–å·¥ä½œ
    }
}
```

**web.xmlæ–¹å¼**ï¼š
```xml
<servlet>
    <servlet-name>InitServlet</servlet-name>
    <servlet-class>com.example.InitServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
```

### 5.3 å¯åŠ¨é¡ºåºè§„åˆ™


**ğŸ¯ æ•°å€¼å«ä¹‰**ï¼š

| æ•°å€¼èŒƒå›´ | **å«ä¹‰** | **å¯åŠ¨æ—¶æœº** |
|---------|---------|-------------|
| `< 0` | ä¸è‡ªåŠ¨å¯åŠ¨ | ç¬¬ä¸€æ¬¡è®¿é—®æ—¶åˆ›å»º |
| `= 0` | è‡ªåŠ¨å¯åŠ¨ | æœåŠ¡å™¨å¯åŠ¨æ—¶åˆ›å»º |
| `> 0` | æŒ‰æ•°å€¼é¡ºåºå¯åŠ¨ | æ•°å€¼è¶Šå°è¶Šå…ˆå¯åŠ¨ |

**ğŸ”¹ å¯åŠ¨é¡ºåºç¤ºä¾‹**ï¼š
```java
@WebServlet(value = "/database", loadOnStartup = 1)
class DatabaseServlet { }  // ç¬¬ä¸€ä¸ªå¯åŠ¨ï¼ˆæ•°æ®åº“è¿æ¥ï¼‰

@WebServlet(value = "/config", loadOnStartup = 2)  
class ConfigServlet { }    // ç¬¬äºŒä¸ªå¯åŠ¨ï¼ˆé…ç½®åŠ è½½ï¼‰

@WebServlet(value = "/cache", loadOnStartup = 3)
class CacheServlet { }     // ç¬¬ä¸‰ä¸ªå¯åŠ¨ï¼ˆç¼“å­˜åˆå§‹åŒ–ï¼‰

@WebServlet("/normal")     // é»˜è®¤-1ï¼Œè®¿é—®æ—¶æ‰å¯åŠ¨
class NormalServlet { }
```

### 5.4 å®é™…åº”ç”¨åœºæ™¯


**ğŸ’¡ å…¸å‹ä½¿ç”¨åœºæ™¯**ï¼š
```
ğŸ”¸ æ•°æ®åº“è¿æ¥åˆå§‹åŒ– â†’ loadOnStartup = 1
ğŸ”¸ é…ç½®æ–‡ä»¶åŠ è½½     â†’ loadOnStartup = 2  
ğŸ”¸ ç¼“å­˜ç³»ç»Ÿå¯åŠ¨     â†’ loadOnStartup = 3
ğŸ”¸ å®šæ—¶ä»»åŠ¡å¯åŠ¨     â†’ loadOnStartup = 4
ğŸ”¸ æ™®é€šä¸šåŠ¡Servlet â†’ é»˜è®¤å€¼ï¼ˆè®¿é—®æ—¶å¯åŠ¨ï¼‰
```

**âš ï¸ æ³¨æ„äº‹é¡¹**ï¼š
- å¯åŠ¨é¡ºåºServletä¼šå¢åŠ æœåŠ¡å™¨å¯åŠ¨æ—¶é—´
- åªå¯¹éœ€è¦é¢„åˆå§‹åŒ–çš„Servletä½¿ç”¨
- æ•°å€¼ç›¸åŒæ—¶å¯åŠ¨é¡ºåºä¸ç¡®å®š

---

## 6. âš™ï¸ åˆå§‹åŒ–å‚æ•°é…ç½®


### 6.1 ä»€ä¹ˆæ˜¯åˆå§‹åŒ–å‚æ•°

**é€šä¿—ç†è§£**ï¼šåˆå§‹åŒ–å‚æ•°å°±åƒç»™å‘˜å·¥çš„"å·¥ä½œæ‰‹å†Œ"ï¼Œé‡Œé¢å†™ç€è¿™ä¸ªå‘˜å·¥å·¥ä½œæ—¶éœ€è¦çŸ¥é“çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ¯”å¦‚æ•°æ®åº“åœ°å€ã€ç¼–ç æ ¼å¼ç­‰ã€‚

**ğŸ”¸ å‚æ•°ç‰¹ç‚¹**ï¼š
- åœ¨Servletåˆ›å»ºæ—¶è®¾ç½®ï¼Œè¿è¡ŒæœŸé—´ä¸å˜
- æ¯ä¸ªServletéƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å‚æ•°
- é€šå¸¸ç”¨äºé…ç½®æ•°æ®åº“è¿æ¥ã€æ–‡ä»¶è·¯å¾„ç­‰

### 6.2 æ³¨è§£æ–¹å¼é…ç½®å‚æ•°


```java
@WebServlet(
    urlPatterns = "/database",
    initParams = {
        @WebInitParam(name = "driver", value = "com.mysql.jdbc.Driver"),
        @WebInitParam(name = "url", value = "jdbc:mysql://localhost:3306/test"),
        @WebInitParam(name = "username", value = "root"),
        @WebInitParam(name = "password", value = "123456")
    }
)
public class DatabaseServlet extends HttpServlet {
    
    private String driver, url, username, password;
    
    @Override
    public void init() throws ServletException {
        // è·å–åˆå§‹åŒ–å‚æ•°
        driver = getInitParameter("driver");
        url = getInitParameter("url"); 
        username = getInitParameter("username");
        password = getInitParameter("password");
        
        System.out.println("æ•°æ®åº“é…ç½®åŠ è½½å®Œæˆ");
    }
}
```

### 6.3 web.xmlæ–¹å¼é…ç½®å‚æ•°


```xml
<servlet>
    <servlet-name>DatabaseServlet</servlet-name>
    <servlet-class>com.example.DatabaseServlet</servlet-class>
    
    <!-- åˆå§‹åŒ–å‚æ•° -->
    <init-param>
        <param-name>driver</param-name>
        <param-value>com.mysql.jdbc.Driver</param-value>
    </init-param>
    
    <init-param>
        <param-name>url</param-name>
        <param-value>jdbc:mysql://localhost:3306/test</param-value>
    </init-param>
    
    <init-param>
        <param-name>username</param-name>
        <param-value>root</param-value>
    </init-param>
    
</servlet>
```

### 6.4 å‚æ•°è·å–ä¸ä½¿ç”¨


**ğŸ”¸ åœ¨init()æ–¹æ³•ä¸­è·å–**ï¼š
```java
public class ConfigServlet extends HttpServlet {
    
    private String encoding;
    private int timeout;
    
    @Override
    public void init() throws ServletException {
        // è·å–å­—ç¬¦ä¸²å‚æ•°
        encoding = getInitParameter("encoding");
        
        // è·å–æ•°å­—å‚æ•°ï¼ˆéœ€è¦è½¬æ¢ï¼‰
        String timeoutStr = getInitParameter("timeout");
        timeout = Integer.parseInt(timeoutStr);
        
        // æ£€æŸ¥å‚æ•°æ˜¯å¦å­˜åœ¨
        if (encoding == null) {
            encoding = "UTF-8";  // è®¾ç½®é»˜è®¤å€¼
        }
    }
    
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) {
        // ä½¿ç”¨é…ç½®å‚æ•°
        resp.setCharacterEncoding(encoding);
        // å…¶ä»–ä¸šåŠ¡é€»è¾‘...
    }
}
```

### 6.5 å…¨å±€å‚æ•°vsåˆå§‹åŒ–å‚æ•°


**ğŸ”„ ä¸¤ç§å‚æ•°ç±»å‹å¯¹æ¯”**ï¼š

| å‚æ•°ç±»å‹ | **ä½œç”¨èŒƒå›´** | **é…ç½®æ–¹å¼** | **è·å–æ–¹æ³•** |
|---------|-------------|-------------|-------------|
| ğŸ¯ **åˆå§‹åŒ–å‚æ•°** | å•ä¸ªServlet | `@WebInitParam`æˆ–`<init-param>` | `getInitParameter()` |
| ğŸŒ **å…¨å±€å‚æ•°** | æ•´ä¸ªWebåº”ç”¨ | `<context-param>` | `getServletContext().getInitParameter()` |

**å…¨å±€å‚æ•°é…ç½®ç¤ºä¾‹**ï¼š
```xml
<!-- web.xmlä¸­é…ç½®å…¨å±€å‚æ•° -->
<context-param>
    <param-name>globalEncoding</param-name>
    <param-value>UTF-8</param-value>
</context-param>

<context-param>
    <param-name>appVersion</param-name>
    <param-value>1.0.0</param-value>
</context-param>
```

**è·å–å…¨å±€å‚æ•°**ï¼š
```java
public class MyServlet extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) {
        // è·å–å…¨å±€å‚æ•°
        String encoding = getServletContext().getInitParameter("globalEncoding");
        String version = getServletContext().getInitParameter("appVersion");
    }
}
```

---

## 7. ğŸ¯ é…ç½®ä¼˜å…ˆçº§ä¸æœ€ä½³å®è·µ


### 7.1 é…ç½®ä¼˜å…ˆçº§è§„åˆ™

**å½“åŒæ—¶å­˜åœ¨æ³¨è§£å’Œweb.xmlé…ç½®æ—¶ï¼Œè°è¯´äº†ç®—ï¼Ÿ**

**ğŸ”¸ ä¼˜å…ˆçº§é¡ºåº**ï¼š
```
1. web.xmlé…ç½® (ä¼˜å…ˆçº§æœ€é«˜)
2. @WebServletæ³¨è§£é…ç½® (ä¼˜å…ˆçº§è¾ƒä½)

åŸå› ï¼šweb.xmlè¢«è®¤ä¸ºæ˜¯æ›´æ­£å¼çš„é…ç½®æ–‡ä»¶ï¼Œ
     å…·æœ‰è¦†ç›–æ³¨è§£é…ç½®çš„èƒ½åŠ›
```

**å®é™…æµ‹è¯•ç¤ºä¾‹**ï¼š
```java
// æ³¨è§£é…ç½®
@WebServlet(value = "/test", loadOnStartup = 2)
public class TestServlet extends HttpServlet { }
```

```xml
<!-- web.xmlé…ç½® -->
<servlet>
    <servlet-name>TestServlet</servlet-name>
    <servlet-class>com.example.TestServlet</servlet-class>
    <load-on-startup>1</load-on-startup>  <!-- è¿™ä¸ªä¼šç”Ÿæ•ˆ -->
</servlet>
<servlet-mapping>
    <servlet-name>TestServlet</servlet-name>
    <url-pattern>/test</url-pattern>
</servlet-mapping>
```

**ç»“æœ**ï¼š`loadOnStartup = 1`ç”Ÿæ•ˆï¼Œæ³¨è§£ä¸­çš„`loadOnStartup = 2`è¢«è¦†ç›–ã€‚

### 7.2 æ··åˆé…ç½®ç­–ç•¥


**ğŸ¯ æ¨èåšæ³•**ï¼š
```
âœ… ç®€å•é¡¹ç›®ï¼šç»Ÿä¸€ä½¿ç”¨æ³¨è§£é…ç½®
âœ… å¤æ‚é¡¹ç›®ï¼šç»Ÿä¸€ä½¿ç”¨web.xmlé…ç½®  
âœ… æ··åˆé¡¹ç›®ï¼šæ ¸å¿ƒé…ç½®ç”¨web.xmlï¼Œç®€å•é…ç½®ç”¨æ³¨è§£
âŒ é¿å…ï¼šåŒä¸€ä¸ªServletæ—¢ç”¨æ³¨è§£åˆç”¨web.xml
```

### 7.3 æœ€ä½³å®è·µæŒ‡å—


**ğŸ”¸ æ³¨è§£é…ç½®æœ€ä½³å®è·µ**ï¼š
```java
// âœ… å¥½çš„æ³¨è§£é…ç½®
@WebServlet(
    name = "UserController",           // æ˜ç¡®çš„åç§°
    urlPatterns = {"/user/*"},         // æ¸…æ™°çš„URLæ¨¡å¼
    loadOnStartup = 1,                 // æ˜ç¡®å¯åŠ¨é¡ºåº
    initParams = {                     // å¿…è¦çš„å‚æ•°
        @WebInitParam(name = "encoding", value = "UTF-8")
    }
)
public class UserController extends HttpServlet {
    // å®ç°ä»£ç 
}

// âŒ ä¸å¥½çš„æ³¨è§£é…ç½®  
@WebServlet("/usr")  // URLä¸å¤Ÿæ¸…æ™°
public class UsrCtrl extends HttpServlet { }  // ç±»åä¸è§„èŒƒ
```

**ğŸ”¸ web.xmlé…ç½®æœ€ä½³å®è·µ**ï¼š
```xml
<!-- âœ… å¥½çš„XMLé…ç½®ï¼šæœ‰æ³¨é‡Šï¼Œç»“æ„æ¸…æ™° -->
<web-app>
    <!-- ç”¨æˆ·ç®¡ç†ç›¸å…³Servlet -->
    <servlet>
        <servlet-name>UserController</servlet-name>
        <servlet-class>com.myapp.controller.UserController</servlet-class>
        <load-on-startup>1</load-on-startup>
        
        <!-- æ•°æ®åº“è¿æ¥å‚æ•° -->
        <init-param>
            <param-name>dbUrl</param-name>
            <param-value>jdbc:mysql://localhost:3306/userdb</param-value>
        </init-param>
    </servlet>
    
    <servlet-mapping>
        <servlet-name>UserController</servlet-name>
        <url-pattern>/user/*</url-pattern>
    </servlet-mapping>
</web-app>
```

### 7.4 å¸¸è§é…ç½®é”™è¯¯


**âš ï¸ å…¸å‹é”™è¯¯æ¡ˆä¾‹**ï¼š

```java
// âŒ é”™è¯¯1ï¼šURLæ¨¡å¼å†²çª
@WebServlet("/user/*")
class UserServlet { }

@WebServlet("/user/login")  // ä¼šè¢«ä¸Šé¢çš„æ¨¡å¼è¦†ç›–
class LoginServlet { }

// âœ… æ­£ç¡®åšæ³•ï¼šé¿å…æ¨¡å¼å†²çª
@WebServlet("/user/general/*") 
class UserServlet { }

@WebServlet("/user/login")     // ç²¾ç¡®åŒ¹é…ï¼Œä¼˜å…ˆçº§é«˜
class LoginServlet { }
```

```xml
<!-- âŒ é”™è¯¯2ï¼šservlet-nameä¸åŒ¹é… -->
<servlet>
    <servlet-name>UserServlet</servlet-name>  
    <servlet-class>com.example.UserServlet</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>userServlet</servlet-name>  <!-- å¤§å°å†™é”™è¯¯ï¼ -->
    <url-pattern>/user</url-pattern>
</servlet-mapping>
```

### 7.5 é…ç½®éªŒè¯æ–¹æ³•


**ğŸ” å¦‚ä½•éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®**ï¼š

1. **å¯åŠ¨æ—¥å¿—æ£€æŸ¥**ï¼š
```
ä¿¡æ¯: Servlet UserController loaded and initialized
ä¿¡æ¯: Mapping url-pattern /user/* to servlet UserController
```

2. **è®¿é—®æµ‹è¯•**ï¼š
```java
// åœ¨Servletä¸­æ·»åŠ æ—¥å¿—
@Override
public void init() {
    System.out.println("Servletåˆå§‹åŒ–æˆåŠŸ: " + getServletName());
    System.out.println("åˆå§‹åŒ–å‚æ•°: " + getInitParameter("encoding"));
}

@Override
protected void doGet(HttpServletRequest req, HttpServletResponse resp) {
    System.out.println("å¤„ç†è¯·æ±‚: " + req.getRequestURI());
}
```

3. **æœåŠ¡å™¨ç®¡ç†ç•Œé¢**ï¼š
å¤§éƒ¨åˆ†WebæœåŠ¡å™¨éƒ½æä¾›ç®¡ç†ç•Œé¢ï¼Œå¯ä»¥æŸ¥çœ‹å·²éƒ¨ç½²çš„Servletä¿¡æ¯ã€‚

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Servleté…ç½®ï¼šå»ºç«‹URLå’ŒServletä¹‹é—´çš„æ˜ å°„å…³ç³»
ğŸ”¸ ä¸¤ç§é…ç½®æ–¹å¼ï¼šweb.xmlé›†ä¸­é…ç½® vs @WebServletæ³¨è§£é…ç½®
ğŸ”¸ URLæ˜ å°„è§„åˆ™ï¼šç²¾ç¡®åŒ¹é… > è·¯å¾„åŒ¹é… > æ‰©å±•ååŒ¹é… > é»˜è®¤åŒ¹é…
ğŸ”¸ å¯åŠ¨é¡ºåºï¼šloadOnStartupæ§åˆ¶Servletåˆ›å»ºæ—¶æœº
ğŸ”¸ åˆå§‹åŒ–å‚æ•°ï¼šç»™Servletä¼ é€’é…ç½®ä¿¡æ¯
ğŸ”¸ é…ç½®ä¼˜å…ˆçº§ï¼šweb.xml > æ³¨è§£é…ç½®
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ é…ç½®æ–¹å¼é€‰æ‹©åŸåˆ™**ï¼š
```
å°å‹é¡¹ç›® â†’ æ³¨è§£é…ç½®ï¼ˆç®€å•ç›´æ¥ï¼‰
å¤§å‹é¡¹ç›® â†’ web.xmlé…ç½®ï¼ˆé›†ä¸­ç®¡ç†ï¼‰
æ··åˆé¡¹ç›® â†’ æ ¹æ®å¤æ‚åº¦åˆ†åˆ«é€‰æ‹©
```

**ğŸ”¹ URLæ˜ å°„çš„æœ¬è´¨**ï¼š
```
æœ¬è´¨ï¼šå»ºç«‹"ç½‘å€"å’Œ"å¤„ç†å™¨"çš„å¯¹åº”å…³ç³»
ç›®çš„ï¼šè®©æœåŠ¡å™¨çŸ¥é“"ä»€ä¹ˆè¯·æ±‚æ‰¾è°å¤„ç†"
å…³é”®ï¼šåŒ¹é…è§„åˆ™çš„ä¼˜å…ˆçº§å’Œå‡†ç¡®æ€§
```

**ğŸ”¹ å¯åŠ¨é¡ºåºçš„åº”ç”¨åœºæ™¯**ï¼š
```
éœ€è¦é¢„åŠ è½½ï¼šæ•°æ®åº“è¿æ¥ã€é…ç½®åŠ è½½ã€ç¼“å­˜åˆå§‹åŒ–
æŒ‰éœ€åŠ è½½ï¼šæ™®é€šä¸šåŠ¡Servletã€ç”¨æˆ·äº¤äº’Servlet
```

### 8.3 å®é™…åº”ç”¨å»ºè®®


**ğŸ’¡ é…ç½®è§„èŒƒ**ï¼š
- ä½¿ç”¨æœ‰æ„ä¹‰çš„servlet-name
- URLæ¨¡å¼è¦æ¸…æ™°æ˜“æ‡‚ï¼Œé¿å…å†²çª
- åˆå§‹åŒ–å‚æ•°è¦æœ‰é»˜è®¤å€¼å¤„ç†
- æ·»åŠ å¿…è¦çš„æ³¨é‡Šè¯´æ˜

**ğŸ¯ æ€§èƒ½ä¼˜åŒ–**ï¼š
- ä¸æ˜¯æ‰€æœ‰Servletéƒ½éœ€è¦è®¾ç½®å¯åŠ¨é¡ºåº
- åˆç†ä½¿ç”¨è·¯å¾„åŒ¹é…ï¼Œå‡å°‘é…ç½®æ•°é‡
- é¿å…è¿‡äºå¤æ‚çš„URLæ¨¡å¼

**ğŸ”§ è°ƒè¯•æŠ€å·§**ï¼š
- åœ¨init()æ–¹æ³•ä¸­æ·»åŠ æ—¥å¿—è¾“å‡º
- æ£€æŸ¥servlet-nameçš„ä¸€è‡´æ€§
- éªŒè¯URLæ¨¡å¼çš„åŒ¹é…æ•ˆæœ
- æµ‹è¯•å‚æ•°è·å–æ˜¯å¦æ­£ç¡®

### 8.4 å­¦ä¹ æ£€æŸ¥æ¸…å•


**â˜ æ¦‚å¿µç†è§£**ï¼š
- [ ] ç†è§£Servleté…ç½®çš„ä½œç”¨å’Œå¿…è¦æ€§
- [ ] æŒæ¡ä¸¤ç§é…ç½®æ–¹å¼çš„ä¼˜ç¼ºç‚¹
- [ ] æ˜ç™½URLæ˜ å°„è§„åˆ™å’Œä¼˜å…ˆçº§

**â˜ å®è·µæŠ€èƒ½**ï¼š  
- [ ] èƒ½å¤Ÿç¼–å†™web.xmlé…ç½®
- [ ] èƒ½å¤Ÿä½¿ç”¨@WebServletæ³¨è§£
- [ ] èƒ½å¤Ÿè®¾ç½®å¯åŠ¨é¡ºåºå’Œåˆå§‹åŒ–å‚æ•°

**â˜ é—®é¢˜è§£å†³**ï¼š
- [ ] èƒ½å¤Ÿè¯Šæ–­é…ç½®å†²çªé—®é¢˜
- [ ] çŸ¥é“å¦‚ä½•éªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆ
- [ ] äº†è§£å¸¸è§é”™è¯¯çš„è§£å†³æ–¹æ³•

**æ ¸å¿ƒè®°å¿†**ï¼š
- Servleté…ç½®å»ºç«‹URLå’Œå¤„ç†å™¨çš„æ¡¥æ¢
- ä¸¤ç§é…ç½®æ–¹å¼å„æœ‰é€‚ç”¨åœºæ™¯ï¼Œweb.xmlä¼˜å…ˆçº§æ›´é«˜
- URLæ˜ å°„éµå¾ªç²¾ç¡®ä¼˜å…ˆçš„åŸåˆ™
- å¯åŠ¨é¡ºåºå’Œåˆå§‹åŒ–å‚æ•°ç”¨äºç‰¹æ®Šéœ€æ±‚
- é…ç½®è¦è§„èŒƒï¼Œè°ƒè¯•è¦ç»†å¿ƒ