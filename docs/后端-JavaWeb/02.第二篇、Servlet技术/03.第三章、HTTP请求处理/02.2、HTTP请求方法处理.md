---
title: 2ã€HTTPè¯·æ±‚æ–¹æ³•å¤„ç†
---
## ğŸ“š ç›®å½•

1. [HTTPè¯·æ±‚æ–¹æ³•æ¦‚è¿°](#1-HTTPè¯·æ±‚æ–¹æ³•æ¦‚è¿°)
2. [doGet()æ–¹æ³•è¯¦è§£](#2-doGetæ–¹æ³•è¯¦è§£)
3. [doPost()æ–¹æ³•è¯¦è§£](#3-doPostæ–¹æ³•è¯¦è§£)
4. [doPut()å’ŒdoDelete()æ–¹æ³•](#4-doPutå’ŒdoDeleteæ–¹æ³•)
5. [RESTfulé£æ ¼æ”¯æŒ](#5-RESTfulé£æ ¼æ”¯æŒ)
6. [æ–¹æ³•è°ƒç”¨æœºåˆ¶åŸç†](#6-æ–¹æ³•è°ƒç”¨æœºåˆ¶åŸç†)
7. [å®é™…åº”ç”¨ä¸æœ€ä½³å®è·µ](#7-å®é™…åº”ç”¨ä¸æœ€ä½³å®è·µ)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ HTTPè¯·æ±‚æ–¹æ³•æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯HTTPè¯·æ±‚æ–¹æ³•


**é€šä¿—ç†è§£**ï¼šHTTPè¯·æ±‚æ–¹æ³•å°±åƒæ˜¯ä½ å¯¹æœåŠ¡å™¨è¯´è¯çš„"è¯­æ°”"å’Œ"ç›®çš„"

```
ç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼š
ğŸ“– GET   = "æˆ‘æƒ³çœ‹çœ‹æœ‰ä»€ä¹ˆ"     â†’ æŸ¥çœ‹å•†å“
ğŸ“ POST  = "æˆ‘è¦æäº¤ä¸€äº›ä¸œè¥¿"   â†’ ä¸‹è®¢å•
âœï¸ PUT   = "æˆ‘è¦å®Œæ•´æ›´æ–°æŸä¸ªä¸œè¥¿" â†’ ä¿®æ”¹ä¸ªäººèµ„æ–™
ğŸ—‘ï¸ DELETE = "æˆ‘è¦åˆ é™¤æŸä¸ªä¸œè¥¿"  â†’ åˆ é™¤æ–‡ç« 

ç½‘ç»œä¸–ç•Œä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†ï¼
```

### 1.2 Servletä¸­çš„æ–¹æ³•å¯¹åº”å…³ç³»


**ğŸ”¸ æ ¸å¿ƒæ˜ å°„æœºåˆ¶**
```
HTTPè¯·æ±‚æ–¹æ³•  â†â†’  Servletä¸­çš„æ–¹æ³•
    GET      â†â†’  doGet()
    POST     â†â†’  doPost()
    PUT      â†â†’  doPut()
    DELETE   â†â†’  doDelete()
    HEAD     â†â†’  doHead()
    OPTIONS  â†â†’  doOptions()
```

> ğŸ’¡ **å…³é”®ç†è§£**ï¼šå½“æµè§ˆå™¨å‘é€GETè¯·æ±‚æ—¶ï¼ŒServletå®¹å™¨ä¼šè‡ªåŠ¨è°ƒç”¨ä½ çš„`doGet()`æ–¹æ³•ã€‚è¿™æ˜¯Servletçš„æ ¸å¿ƒå·¥ä½œåŸç†ï¼

### 1.3 ä¸ºä»€ä¹ˆè¦åŒºåˆ†ä¸åŒçš„æ–¹æ³•


**å®é™…æ„ä¹‰**ï¼š
- âœ… **è¯­ä¹‰æ¸…æ™°**ï¼šçœ‹æ–¹æ³•åå°±çŸ¥é“è¦åšä»€ä¹ˆ
- âœ… **åŠŸèƒ½åˆ†ç¦»**ï¼šä¸åŒæ“ä½œç”¨ä¸åŒæ–¹æ³•å¤„ç†
- âœ… **ç¬¦åˆè§„èŒƒ**ï¼šéµå¾ªHTTPåè®®æ ‡å‡†
- âœ… **ä¾¿äºç»´æŠ¤**ï¼šä»£ç ç»“æ„æ›´æ¸…æ™°

---

## 2. ğŸ“– doGet()æ–¹æ³•è¯¦è§£


### 2.1 doGet()æ–¹æ³•çš„ä½œç”¨


**ğŸ”¸ æ ¸å¿ƒç”¨é€”**ï¼šå¤„ç†HTTP GETè¯·æ±‚ï¼Œä¸»è¦ç”¨äº**è·å–æ•°æ®**

> ğŸ“ **é€šä¿—è§£é‡Š**ï¼šdoGet()å°±åƒå•†åº—çš„"å±•ç¤ºæŸœ"ï¼Œå®¢æˆ·æ¥äº†æƒ³çœ‹çœ‹æœ‰ä»€ä¹ˆå•†å“ï¼Œä½ å°±æŠŠå•†å“å±•ç¤ºç»™ä»–çœ‹

### 2.2 doGet()æ–¹æ³•é‡å†™


```java
@WebServlet("/product")
public class ProductServlet extends HttpServlet {
    
    // é‡å†™doGetæ–¹æ³• - å¤„ç†GETè¯·æ±‚
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        // è®¾ç½®å“åº”å†…å®¹ç±»å‹
        response.setContentType("text/html;charset=UTF-8");
        
        // æ¨¡æ‹Ÿè·å–å•†å“ä¿¡æ¯
        String productName = "iPhone 15";
        double price = 7999.0;
        
        // è·å–è¾“å‡ºæµ
        PrintWriter out = response.getWriter();
        
        // è¿”å›å•†å“ä¿¡æ¯ç»™å®¢æˆ·ç«¯
        out.println("<h2>å•†å“ä¿¡æ¯</h2>");
        out.println("<p>å•†å“åç§°ï¼š" + productName + "</p>");
        out.println("<p>ä»·æ ¼ï¼š" + price + "å…ƒ</p>");
        
        out.close();
    }
}
```

### 2.3 GETè¯·æ±‚çš„ç‰¹ç‚¹


| ç‰¹ç‚¹ | è¯´æ˜ | ä¸¾ä¾‹ |
|------|------|------|
| **æ•°æ®ä½ç½®** | å‚æ•°åœ¨URLä¸­ | `?name=å¼ ä¸‰&age=25` |
| **æ•°æ®å¤§å°** | æœ‰é•¿åº¦é™åˆ¶ | é€šå¸¸ä¸è¶…è¿‡2KB |
| **å®‰å…¨æ€§** | å‚æ•°å¯è§ | å¯†ç ä¸é€‚åˆç”¨GET |
| **ç¼“å­˜** | å¯ä»¥è¢«ç¼“å­˜ | æµè§ˆå™¨ä¼šç¼“å­˜GETè¯·æ±‚ |
| **å¹‚ç­‰æ€§** | å¤šæ¬¡è¯·æ±‚ç»“æœç›¸åŒ | åˆ·æ–°é¡µé¢ä¸ä¼šé‡å¤æäº¤ |

### 2.4 è·å–GETè¯·æ±‚å‚æ•°


```java
@Override
protected void doGet(HttpServletRequest request, HttpServletResponse response) 
        throws ServletException, IOException {
    
    // è·å–URLå‚æ•°ï¼š/product?id=123&category=phone
    String productId = request.getParameter("id");        // "123"
    String category = request.getParameter("category");   // "phone"
    
    response.setContentType("text/html;charset=UTF-8");
    PrintWriter out = response.getWriter();
    
    out.println("<h3>æ‚¨æŸ¥çœ‹çš„å•†å“</h3>");
    out.println("<p>å•†å“IDï¼š" + productId + "</p>");
    out.println("<p>åˆ†ç±»ï¼š" + category + "</p>");
}
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**ï¼šGETè¯·æ±‚çš„å‚æ•°ä¼šæ˜¾ç¤ºåœ¨åœ°å€æ ä¸­ï¼Œæ‰€ä»¥ä¸è¦ç”¨GETä¼ é€’æ•æ„Ÿä¿¡æ¯å¦‚å¯†ç 

---

## 3. ğŸ“ doPost()æ–¹æ³•è¯¦è§£


### 3.1 doPost()æ–¹æ³•çš„ä½œç”¨


**ğŸ”¸ æ ¸å¿ƒç”¨é€”**ï¼šå¤„ç†HTTP POSTè¯·æ±‚ï¼Œä¸»è¦ç”¨äº**æäº¤æ•°æ®**

> ğŸ“ **é€šä¿—è§£é‡Š**ï¼šdoPost()å°±åƒé‚®å±€çš„"æ”¶ä»¶çª—å£"ï¼Œå®¢æˆ·å¸¦ç€åŒ…è£¹æ¥å¯„ä»¶ï¼Œä½ è¦æ¥æ”¶å¹¶å¤„ç†è¿™ä¸ªåŒ…è£¹

### 3.2 doPost()æ–¹æ³•é‡å†™


```java
@WebServlet("/register")
public class RegisterServlet extends HttpServlet {
    
    // é‡å†™doPostæ–¹æ³• - å¤„ç†POSTè¯·æ±‚
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        // è®¾ç½®è¯·æ±‚ç¼–ç ï¼ˆè§£å†³ä¸­æ–‡ä¹±ç ï¼‰
        request.setCharacterEncoding("UTF-8");
        response.setContentType("text/html;charset=UTF-8");
        
        // è·å–è¡¨å•æ•°æ®
        String username = request.getParameter("username");
        String password = request.getParameter("password");
        String email = request.getParameter("email");
        
        // å¤„ç†æ³¨å†Œé€»è¾‘ï¼ˆæ¨¡æ‹Ÿï¼‰
        boolean success = processRegistration(username, password, email);
        
        PrintWriter out = response.getWriter();
        if (success) {
            out.println("<h2>æ³¨å†ŒæˆåŠŸï¼</h2>");
            out.println("<p>æ¬¢è¿æ‚¨ï¼Œ" + username + "ï¼</p>");
        } else {
            out.println("<h2>æ³¨å†Œå¤±è´¥</h2>");
            out.println("<p>è¯·æ£€æŸ¥è¾“å…¥ä¿¡æ¯</p>");
        }
    }
    
    // æ¨¡æ‹Ÿæ³¨å†Œå¤„ç†
    private boolean processRegistration(String username, String password, String email) {
        // å®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šè¿æ¥æ•°æ®åº“
        return username != null && password != null && email != null;
    }
}
```

### 3.3 POSTè¯·æ±‚çš„ç‰¹ç‚¹


```
POST vs GET å¯¹æ¯”ï¼š

GETè¯·æ±‚ï¼šå°±åƒæ˜ä¿¡ç‰‡
ğŸ“® å†…å®¹å†™åœ¨å¤–é¢ï¼ˆURLä¸­ï¼‰
ğŸ“ å†…å®¹æœ‰é™ï¼ˆé•¿åº¦é™åˆ¶ï¼‰  
ğŸ‘ï¸ åˆ«äººèƒ½çœ‹è§ï¼ˆä¸å®‰å…¨ï¼‰

POSTè¯·æ±‚ï¼šå°±åƒä¿¡å°
ğŸ“© å†…å®¹è£…åœ¨é‡Œé¢ï¼ˆè¯·æ±‚ä½“ä¸­ï¼‰
ğŸ“¦ å†…å®¹è¾ƒå¤šï¼ˆå‡ ä¹æ— é™åˆ¶ï¼‰
ğŸ”’ åˆ«äººçœ‹ä¸è§ï¼ˆç›¸å¯¹å®‰å…¨ï¼‰
```

### 3.4 å¤„ç†è¡¨å•æ•°æ®


```java
@Override
protected void doPost(HttpServletRequest request, HttpServletResponse response) 
        throws ServletException, IOException {
    
    request.setCharacterEncoding("UTF-8");
    
    // è·å–å•ä¸ªå€¼
    String name = request.getParameter("name");
    
    // è·å–å¤šä¸ªå€¼ï¼ˆå¦‚å¤é€‰æ¡†ï¼‰
    String[] hobbies = request.getParameterValues("hobby");
    
    // è·å–æ‰€æœ‰å‚æ•°å
    Enumeration<String> paramNames = request.getParameterNames();
    
    response.setContentType("text/html;charset=UTF-8");
    PrintWriter out = response.getWriter();
    
    out.println("<h3>æ‚¨æäº¤çš„ä¿¡æ¯ï¼š</h3>");
    out.println("<p>å§“åï¼š" + name + "</p>");
    
    if (hobbies != null) {
        out.println("<p>çˆ±å¥½ï¼š");
        for (String hobby : hobbies) {
            out.println(hobby + " ");
        }
        out.println("</p>");
    }
}
```

---

## 4. âœï¸ doPut()å’ŒdoDelete()æ–¹æ³•


### 4.1 doPut()æ–¹æ³•è¯¦è§£


**ğŸ”¸ æ ¸å¿ƒç”¨é€”**ï¼šå¤„ç†HTTP PUTè¯·æ±‚ï¼Œç”¨äº**å®Œæ•´æ›´æ–°**èµ„æº

> ğŸ“ **é€šä¿—è§£é‡Š**ï¼šdoPut()å°±åƒ"æ¢æ–°"ï¼ŒæŠŠæ•´ä¸ªä¸œè¥¿æ›¿æ¢æˆæ–°çš„

```java
@WebServlet("/user/*")
public class UserServlet extends HttpServlet {
    
    @Override
    protected void doPut(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        // ä»URLä¸­è·å–ç”¨æˆ·IDï¼š/user/123
        String pathInfo = request.getPathInfo(); // "/123"
        String userId = pathInfo.substring(1);   // "123"
        
        // è·å–è¦æ›´æ–°çš„ç”¨æˆ·æ•°æ®ï¼ˆé€šå¸¸æ˜¯JSONæ ¼å¼ï¼‰
        StringBuilder jsonBuilder = new StringBuilder();
        String line;
        try (BufferedReader reader = request.getReader()) {
            while ((line = reader.readLine()) != null) {
                jsonBuilder.append(line);
            }
        }
        
        String userData = jsonBuilder.toString();
        
        // å¤„ç†æ›´æ–°é€»è¾‘ï¼ˆæ¨¡æ‹Ÿï¼‰
        boolean success = updateUser(userId, userData);
        
        response.setContentType("application/json;charset=UTF-8");
        PrintWriter out = response.getWriter();
        
        if (success) {
            out.println("{\"message\": \"ç”¨æˆ·ä¿¡æ¯æ›´æ–°æˆåŠŸ\"}");
        } else {
            response.setStatus(HttpServletResponse.SC_BAD_REQUEST);
            out.println("{\"error\": \"æ›´æ–°å¤±è´¥\"}");
        }
    }
    
    private boolean updateUser(String userId, String userData) {
        // å®é™…ä¼šæ›´æ–°æ•°æ®åº“
        return true;
    }
}
```

### 4.2 doDelete()æ–¹æ³•è¯¦è§£


**ğŸ”¸ æ ¸å¿ƒç”¨é€”**ï¼šå¤„ç†HTTP DELETEè¯·æ±‚ï¼Œç”¨äº**åˆ é™¤**èµ„æº

> ğŸ“ **é€šä¿—è§£é‡Š**ï¼šdoDelete()å°±åƒ"åƒåœ¾æ¡¶"ï¼ŒæŠŠä¸è¦çš„ä¸œè¥¿æ‰”æ‰

```java
@Override
protected void doDelete(HttpServletRequest request, HttpServletResponse response) 
        throws ServletException, IOException {
    
    // è·å–è¦åˆ é™¤çš„èµ„æºID
    String pathInfo = request.getPathInfo(); // "/123"
    String userId = pathInfo.substring(1);   // "123"
    
    // å¤„ç†åˆ é™¤é€»è¾‘
    boolean success = deleteUser(userId);
    
    response.setContentType("application/json;charset=UTF-8");
    PrintWriter out = response.getWriter();
    
    if (success) {
        response.setStatus(HttpServletResponse.SC_OK);
        out.println("{\"message\": \"ç”¨æˆ·åˆ é™¤æˆåŠŸ\"}");
    } else {
        response.setStatus(HttpServletResponse.SC_NOT_FOUND);
        out.println("{\"error\": \"ç”¨æˆ·ä¸å­˜åœ¨\"}");
    }
}

private boolean deleteUser(String userId) {
    // å®é™…ä¼šä»æ•°æ®åº“åˆ é™¤
    return true;
}
```

---

## 5. ğŸš€ RESTfulé£æ ¼æ”¯æŒ


### 5.1 ä»€ä¹ˆæ˜¯RESTfulé£æ ¼


**é€šä¿—ç†è§£**ï¼šRESTfulå°±åƒæ˜¯ç½‘ç»œä¸–ç•Œçš„"æ ‡å‡†åŒ–æ“ä½œæ‰‹å†Œ"

```
ä¼ ç»Ÿæ–¹å¼ vs RESTfulæ–¹å¼å¯¹æ¯”ï¼š

ä¼ ç»Ÿæ–¹å¼ï¼ˆåƒæ˜¯"æš—å·"ï¼‰ï¼š
/getUserById?id=123     â† è·å–ç”¨æˆ·
/addUser               â† æ·»åŠ ç”¨æˆ·
/updateUser            â† æ›´æ–°ç”¨æˆ·
/deleteUser?id=123     â† åˆ é™¤ç”¨æˆ·

RESTfulæ–¹å¼ï¼ˆåƒæ˜¯"æ ‡å‡†è¯­è¨€"ï¼‰ï¼š
GET    /user/123       â† è·å–ç”¨æˆ·123
POST   /user           â† æ·»åŠ æ–°ç”¨æˆ·
PUT    /user/123       â† æ›´æ–°ç”¨æˆ·123
DELETE /user/123       â† åˆ é™¤ç”¨æˆ·123
```

### 5.2 RESTfulé£æ ¼çš„ä¼˜åŠ¿


> ğŸ’¡ **å…³é”®ç†è§£**ï¼šURLè¡¨ç¤º"èµ„æºæ˜¯ä»€ä¹ˆ"ï¼ŒHTTPæ–¹æ³•è¡¨ç¤º"è¦åšä»€ä¹ˆæ“ä½œ"

**ğŸ“Š RESTfulä¼˜åŠ¿å¯¹æ¯”**

| æ–¹é¢ | ä¼ ç»Ÿæ–¹å¼ | RESTfulæ–¹å¼ |
|------|---------|-----------|
| **URLå«ä¹‰** | è¡¨ç¤ºæ“ä½œ | è¡¨ç¤ºèµ„æº |
| **æ“ä½œæ ‡è¯†** | URLä¸­ä½“ç° | HTTPæ–¹æ³•ä½“ç° |
| **ç†è§£éš¾åº¦** | éœ€è¦è®°å¿†å„ç§URL | ç»Ÿä¸€è§„èŒƒï¼Œå®¹æ˜“ç†è§£ |
| **æ‰©å±•æ€§** | æ–°æ“ä½œéœ€è¦æ–°URL | å¤ç”¨ç°æœ‰èµ„æºURL |

### 5.3 å®ç°RESTfulé£æ ¼çš„Servlet


```java
@WebServlet("/api/products/*")
public class ProductRestServlet extends HttpServlet {
    
    // GET /api/products/123 - è·å–å•†å“
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        String productId = getResourceId(request);
        response.setContentType("application/json;charset=UTF-8");
        PrintWriter out = response.getWriter();
        
        if (productId != null) {
            // è·å–å•ä¸ªå•†å“
            out.println("{\"id\":" + productId + ",\"name\":\"å•†å“" + productId + "\"}");
        } else {
            // è·å–å•†å“åˆ—è¡¨
            out.println("[{\"id\":1,\"name\":\"å•†å“1\"},{\"id\":2,\"name\":\"å•†å“2\"}]");
        }
    }
    
    // POST /api/products - åˆ›å»ºå•†å“
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        // å¤„ç†åˆ›å»ºé€»è¾‘
        response.setContentType("application/json;charset=UTF-8");
        response.setStatus(HttpServletResponse.SC_CREATED);
        PrintWriter out = response.getWriter();
        out.println("{\"message\":\"å•†å“åˆ›å»ºæˆåŠŸ\",\"id\":123}");
    }
    
    // PUT /api/products/123 - æ›´æ–°å•†å“
    @Override
    protected void doPut(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        String productId = getResourceId(request);
        // å¤„ç†æ›´æ–°é€»è¾‘
        
        response.setContentType("application/json;charset=UTF-8");
        PrintWriter out = response.getWriter();
        out.println("{\"message\":\"å•†å“" + productId + "æ›´æ–°æˆåŠŸ\"}");
    }
    
    // DELETE /api/products/123 - åˆ é™¤å•†å“
    @Override
    protected void doDelete(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        String productId = getResourceId(request);
        // å¤„ç†åˆ é™¤é€»è¾‘
        
        response.setContentType("application/json;charset=UTF-8");
        PrintWriter out = response.getWriter();
        out.println("{\"message\":\"å•†å“" + productId + "åˆ é™¤æˆåŠŸ\"}");
    }
    
    // è¾…åŠ©æ–¹æ³•ï¼šä»URLä¸­æå–èµ„æºID
    private String getResourceId(HttpServletRequest request) {
        String pathInfo = request.getPathInfo();
        return (pathInfo != null && pathInfo.length() > 1) ? pathInfo.substring(1) : null;
    }
}
```

---

## 6. âš™ï¸ æ–¹æ³•è°ƒç”¨æœºåˆ¶åŸç†


### 6.1 Servletå®¹å™¨çš„è°ƒç”¨æµç¨‹


**ğŸ”¸ å®Œæ•´è°ƒç”¨é“¾è·¯**

```
å®¢æˆ·ç«¯è¯·æ±‚ â†’ Servletå®¹å™¨ â†’ service()æ–¹æ³• â†’ å…·ä½“çš„doXxx()æ–¹æ³•

è¯¦ç»†æµç¨‹å›¾ï¼š
å®¢æˆ·ç«¯                    Servletå®¹å™¨                HttpServlet
   |                         |                         |
   |--[1]å‘é€HTTPè¯·æ±‚-------->|                         |
   |   GET /user             |                         |
   |                         |--[2]è°ƒç”¨service()------>|
   |                         |                         |--[3]åˆ¤æ–­è¯·æ±‚æ–¹æ³•
   |                         |                         |
   |                         |<--[4]è°ƒç”¨doGet()--------|
   |                         |                         |
   |<--[5]è¿”å›å“åº”ç»“æœ-------|                         |
```

### 6.2 service()æ–¹æ³•çš„å·¥ä½œåŸç†


**é€šä¿—ç†è§£**ï¼šservice()æ–¹æ³•å°±åƒæ˜¯"æ€»è°ƒåº¦å‘˜"ï¼Œæ ¹æ®ä¸åŒçš„è¯·æ±‚ç±»å‹åˆ†å‘ç»™å¯¹åº”çš„ä¸“é—¨å¤„ç†å‘˜

```java
// HttpServletä¸­service()æ–¹æ³•çš„ç®€åŒ–é€»è¾‘
protected void service(HttpServletRequest req, HttpServletResponse resp) 
        throws ServletException, IOException {
    
    // è·å–HTTPè¯·æ±‚æ–¹æ³•
    String method = req.getMethod();
    
    // æ ¹æ®æ–¹æ³•ç±»å‹åˆ†å‘åˆ°å¯¹åº”çš„å¤„ç†æ–¹æ³•
    if ("GET".equals(method)) {
        doGet(req, resp);           // åˆ†å‘ç»™doGet()
    } else if ("POST".equals(method)) {
        doPost(req, resp);          // åˆ†å‘ç»™doPost()
    } else if ("PUT".equals(method)) {
        doPut(req, resp);           // åˆ†å‘ç»™doPut()
    } else if ("DELETE".equals(method)) {
        doDelete(req, resp);        // åˆ†å‘ç»™doDelete()
    } else {
        // ä¸æ”¯æŒçš„æ–¹æ³•è¿”å›405é”™è¯¯
        resp.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED);
    }
}
```

### 6.3 æ–¹æ³•é‡å†™çš„é‡è¦æ€§


> âš ï¸ **é‡è¦æé†’**ï¼šå¦‚æœä½ ä¸é‡å†™å¯¹åº”çš„doXxx()æ–¹æ³•ï¼Œå®¢æˆ·ç«¯ä¼šæ”¶åˆ°"405 Method Not Allowed"é”™è¯¯

**ğŸ”¸ é»˜è®¤è¡Œä¸ºè¯´æ˜**

```
HttpServletä¸­é»˜è®¤çš„doXxx()æ–¹æ³•å®ç°ï¼š

protected void doGet(HttpServletRequest req, HttpServletResponse resp) 
        throws ServletException, IOException {
    // é»˜è®¤è¿”å›405é”™è¯¯
    resp.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED);
}
```

**ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡ï¼Ÿ**
- âœ… **æ˜ç¡®æ„å›¾**ï¼šå¼ºåˆ¶å¼€å‘è€…æ˜ç¡®æ”¯æŒå“ªäº›HTTPæ–¹æ³•
- âœ… **é¿å…è¯¯æ“ä½œ**ï¼šé˜²æ­¢æ„å¤–å¤„ç†ä¸åº”è¯¥æ”¯æŒçš„è¯·æ±‚æ–¹æ³•
- âœ… **ç¬¦åˆè§„èŒƒ**ï¼šéµå¾ªHTTPåè®®çš„è§„èŒƒè¦æ±‚

---

## 7. ğŸ› ï¸ å®é™…åº”ç”¨ä¸æœ€ä½³å®è·µ


### 7.1 å¤„ç†å¤šç§è¯·æ±‚æ–¹æ³•çš„ç­–ç•¥


**â­ ç­–ç•¥ä¸€ï¼šåŒä¸€ä¸ªServletå¤„ç†å¤šç§æ–¹æ³•**

```java
@WebServlet("/api/user/*")
public class UserApiServlet extends HttpServlet {
    
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // æŸ¥è¯¢ç”¨æˆ·
        handleUserQuery(request, response);
    }
    
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // åˆ›å»ºç”¨æˆ·
        handleUserCreate(request, response);
    }
    
    @Override
    protected void doPut(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // æ›´æ–°ç”¨æˆ·
        handleUserUpdate(request, response);
    }
    
    @Override
    protected void doDelete(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // åˆ é™¤ç”¨æˆ·
        handleUserDelete(request, response);
    }
    
    // æå–å…¬å…±çš„å“åº”è®¾ç½®æ–¹æ³•
    private void setupJsonResponse(HttpServletResponse response) {
        response.setContentType("application/json;charset=UTF-8");
        response.setHeader("Access-Control-Allow-Origin", "*");
    }
}
```

### 7.2 é”™è¯¯å¤„ç†å’ŒçŠ¶æ€ç 


**ğŸ”¸ å¸¸ç”¨HTTPçŠ¶æ€ç å«ä¹‰**

| çŠ¶æ€ç  | å«ä¹‰ | ä½¿ç”¨åœºæ™¯ |
|--------|------|----------|
| **200** | OK | è¯·æ±‚æˆåŠŸ |
| **201** | Created | èµ„æºåˆ›å»ºæˆåŠŸ |
| **400** | Bad Request | è¯·æ±‚å‚æ•°é”™è¯¯ |
| **404** | Not Found | èµ„æºä¸å­˜åœ¨ |
| **405** | Method Not Allowed | ä¸æ”¯æŒçš„HTTPæ–¹æ³• |
| **500** | Internal Server Error | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

```java
@Override
protected void doGet(HttpServletRequest request, HttpServletResponse response) 
        throws ServletException, IOException {
    
    try {
        String userId = getResourceId(request);
        
        if (userId == null) {
            // 400 - å‚æ•°é”™è¯¯
            response.setStatus(HttpServletResponse.SC_BAD_REQUEST);
            sendErrorResponse(response, "ç¼ºå°‘ç”¨æˆ·IDå‚æ•°");
            return;
        }
        
        User user = userService.findById(userId);
        
        if (user == null) {
            // 404 - ç”¨æˆ·ä¸å­˜åœ¨
            response.setStatus(HttpServletResponse.SC_NOT_FOUND);
            sendErrorResponse(response, "ç”¨æˆ·ä¸å­˜åœ¨");
            return;
        }
        
        // 200 - æˆåŠŸè¿”å›ç”¨æˆ·ä¿¡æ¯
        response.setStatus(HttpServletResponse.SC_OK);
        sendSuccessResponse(response, user);
        
    } catch (Exception e) {
        // 500 - æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
        response.setStatus(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);
        sendErrorResponse(response, "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯");
    }
}

private void sendErrorResponse(HttpServletResponse response, String message) 
        throws IOException {
    response.setContentType("application/json;charset=UTF-8");
    PrintWriter out = response.getWriter();
    out.println("{\"error\":\"" + message + "\"}");
}
```

### 7.3 è·¨åŸŸè¯·æ±‚å¤„ç†


```java
@WebServlet("/api/*")
public class BaseApiServlet extends HttpServlet {
    
    // å¤„ç†é¢„æ£€è¯·æ±‚ï¼ˆOPTIONSæ–¹æ³•ï¼‰
    @Override
    protected void doOptions(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        // è®¾ç½®è·¨åŸŸå“åº”å¤´
        setCorsHeaders(response);
        response.setStatus(HttpServletResponse.SC_OK);
    }
    
    // è®¾ç½®è·¨åŸŸå“åº”å¤´çš„å…¬å…±æ–¹æ³•
    protected void setCorsHeaders(HttpServletResponse response) {
        response.setHeader("Access-Control-Allow-Origin", "*");
        response.setHeader("Access-Control-Allow-Methods", "GET, POST, PUT, DELETE, OPTIONS");
        response.setHeader("Access-Control-Allow-Headers", "Content-Type, Authorization");
        response.setHeader("Access-Control-Max-Age", "3600");
    }
    
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        setCorsHeaders(response);  // æ¯ä¸ªæ–¹æ³•éƒ½è®¾ç½®è·¨åŸŸå¤´
        // å¤„ç†GETè¯·æ±‚é€»è¾‘...
    }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ HTTPæ–¹æ³•æ˜ å°„ï¼šæ¯ç§HTTPæ–¹æ³•å¯¹åº”ä¸€ä¸ªdoXxx()æ–¹æ³•
ğŸ”¸ æ–¹æ³•é‡å†™ï¼šå¿…é¡»é‡å†™å¯¹åº”æ–¹æ³•æ‰èƒ½å¤„ç†ç›¸åº”çš„HTTPè¯·æ±‚
ğŸ”¸ è°ƒç”¨æœºåˆ¶ï¼šservice()â†’doXxx()çš„è‡ªåŠ¨åˆ†å‘æœºåˆ¶
ğŸ”¸ RESTfulé£æ ¼ï¼šURLè¡¨ç¤ºèµ„æºï¼ŒHTTPæ–¹æ³•è¡¨ç¤ºæ“ä½œ
ğŸ”¸ çŠ¶æ€ç ä½¿ç”¨ï¼šæ­£ç¡®ä½¿ç”¨HTTPçŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚å¤„ç†ç»“æœ
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ å„æ–¹æ³•çš„ä½¿ç”¨åœºæ™¯**
```
doGet()ï¼š   æŸ¥çœ‹ã€è·å–ã€å±•ç¤º â†’ "æˆ‘è¦çœ‹"
doPost()ï¼š  æäº¤ã€åˆ›å»ºã€æ–°å¢ â†’ "æˆ‘è¦äº¤"  
doPut()ï¼š   å®Œæ•´æ›´æ–°ã€æ›¿æ¢ â†’ "æˆ‘è¦æ¢"
doDelete()ï¼šåˆ é™¤ã€ç§»é™¤    â†’ "æˆ‘è¦åˆ "
```

**ğŸ”¹ æ–¹æ³•é€‰æ‹©åŸåˆ™**
```
âœ… è·å–æ•°æ® â†’ ç”¨GETï¼ˆå¹‚ç­‰ï¼Œå¯ç¼“å­˜ï¼‰
âœ… æäº¤è¡¨å• â†’ ç”¨POSTï¼ˆä¸å¹‚ç­‰ï¼Œæ•°æ®åœ¨è¯·æ±‚ä½“ï¼‰
âœ… å®Œæ•´æ›´æ–° â†’ ç”¨PUTï¼ˆå¹‚ç­‰ï¼Œæ›¿æ¢æ•´ä¸ªèµ„æºï¼‰
âœ… åˆ é™¤èµ„æº â†’ ç”¨DELETEï¼ˆå¹‚ç­‰ï¼Œåˆ é™¤æ“ä½œï¼‰
```

**ğŸ”¹ RESTfulè®¾è®¡æ€ç»´**
```
ä¼ ç»Ÿæ€ç»´ï¼šURLæè¿°åŠ¨ä½œ
RESTfulæ€ç»´ï¼šURLæè¿°èµ„æº + HTTPæ–¹æ³•æè¿°åŠ¨ä½œ

ä¾‹å¦‚ï¼š
ä¼ ç»Ÿï¼š/deleteUser?id=123
RESTfulï¼šDELETE /user/123
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ“Š å¼€å‘å»ºè®®**

| åœºæ™¯ | æ¨èåšæ³• | æ³¨æ„äº‹é¡¹ |
|------|---------|---------|
| **ç®€å•ç½‘ç«™** | ä¸»è¦ç”¨GET/POST | è¡¨å•ç”¨POSTï¼Œé“¾æ¥ç”¨GET |
| **APIå¼€å‘** | å®ç°å®Œæ•´çš„RESTful | æ­£ç¡®ä½¿ç”¨HTTPçŠ¶æ€ç  |
| **ç§»åŠ¨ç«¯æ¥å£** | æ”¯æŒæ‰€æœ‰HTTPæ–¹æ³• | æ³¨æ„è·¨åŸŸå’Œå®‰å…¨æ€§ |

**ğŸ”§ ç¼–ç æœ€ä½³å®è·µ**
- âœ… **å‚æ•°éªŒè¯**ï¼šå§‹ç»ˆéªŒè¯è¯·æ±‚å‚æ•°çš„æœ‰æ•ˆæ€§
- âœ… **å¼‚å¸¸å¤„ç†**ï¼šç”¨try-catchå¤„ç†å¯èƒ½çš„å¼‚å¸¸
- âœ… **çŠ¶æ€ç **ï¼šæ ¹æ®å¤„ç†ç»“æœè¿”å›åˆé€‚çš„HTTPçŠ¶æ€ç 
- âœ… **å“åº”æ ¼å¼**ï¼šAPIç»Ÿä¸€ä½¿ç”¨JSONæ ¼å¼å“åº”
- âœ… **ç¼–ç è®¾ç½®**ï¼šè®¾ç½®æ­£ç¡®çš„å­—ç¬¦ç¼–ç é¿å…ä¹±ç 

### 8.4 å¸¸è§é—®é¢˜è§£å†³


**â“ é—®é¢˜1ï¼šä¸ºä»€ä¹ˆæ”¶åˆ°405é”™è¯¯ï¼Ÿ**
```
åŸå› ï¼šæ²¡æœ‰é‡å†™å¯¹åº”çš„doXxx()æ–¹æ³•
è§£å†³ï¼šé‡å†™ä½ è¦æ”¯æŒçš„HTTPæ–¹æ³•å¯¹åº”çš„doXxx()æ–¹æ³•
```

**â“ é—®é¢˜2ï¼šPOSTè¯·æ±‚ä¸­æ–‡ä¹±ç ï¼Ÿ**
```
åŸå› ï¼šæ²¡æœ‰è®¾ç½®è¯·æ±‚ç¼–ç 
è§£å†³ï¼šåœ¨doPost()å¼€å§‹åŠ ä¸Š request.setCharacterEncoding("UTF-8");
```

**â“ é—®é¢˜3ï¼šå¦‚ä½•æ”¯æŒRESTfulé£æ ¼ï¼Ÿ**
```
æ–¹æ³•ï¼šé‡å†™å¤šä¸ªdoXxx()æ–¹æ³•ï¼Œç”¨pathInfoè·å–èµ„æºID
å…³é”®ï¼šURLè®¾è®¡è¦ä½“ç°èµ„æºå±‚æ¬¡ç»“æ„
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- HTTPæ–¹æ³•å¯¹åº”Servletæ–¹æ³•ï¼Œä¸é‡å†™å°±ä¸æ”¯æŒ
- GETæŸ¥çœ‹POSTæäº¤ï¼ŒPUTæ›´æ–°DELETEåˆ é™¤
- service()æ˜¯æ€»è°ƒåº¦ï¼Œæ ¹æ®æ–¹æ³•è‡ªåŠ¨åˆ†å‘
- RESTfulè®©APIæ›´è§„èŒƒï¼ŒURLè¡¨ç¤ºèµ„æºæ–¹æ³•è¡¨ç¤ºæ“ä½œ