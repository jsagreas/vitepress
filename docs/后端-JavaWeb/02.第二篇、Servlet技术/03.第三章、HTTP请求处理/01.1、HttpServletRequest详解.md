---
title: 1、HttpServletRequest详解
---
## 📚 目录

1. [HttpServletRequest概述](#1-HttpServletRequest概述)
2. [获取请求参数](#2-获取请求参数)
3. [获取请求头信息](#3-获取请求头信息)
4. [获取请求路径信息](#4-获取请求路径信息)
5. [请求体数据读取](#5-请求体数据读取)
6. [字符编码处理](#6-字符编码处理)
7. [请求方法判断](#7-请求方法判断)
8. [实战应用示例](#8-实战应用示例)
9. [核心要点总结](#9-核心要点总结)

---

## 1. 🌐 HttpServletRequest概述


### 1.1 什么是HttpServletRequest


**简单理解**：HttpServletRequest就像是一个"信封"，里面装着浏览器发送给服务器的所有信息。

```
浏览器发送请求就像寄信：
┌─────────────────────────────────┐
│        HTTP请求信息              │
│  ┌─────────────────────────────┐ │
│  │ 收件人：/login (请求路径)     │ │
│  │ 信件内容：用户名=admin       │ │  
│  │          密码=123456        │ │
│  │ 信封信息：浏览器类型等        │ │
│  └─────────────────────────────┘ │
└─────────────────────────────────┘
        ↓
HttpServletRequest对象帮我们"拆信"
```

**核心作用**：
- 📦 **获取用户数据**：表单提交的用户名、密码等
- 🏷️ **获取请求信息**：来自哪个页面、用什么浏览器等
- 📍 **获取路径信息**：用户访问的具体网址
- 📄 **读取请求内容**：上传的文件、JSON数据等

### 1.2 HttpServletRequest在Servlet中的位置


```
用户请求处理流程：
浏览器 → Web服务器 → Servlet容器 → 我们的Servlet
        ↓
    创建HttpServletRequest对象
        ↓
    传递给doGet()或doPost()方法
```

**为什么需要它**：
- 🎯 **统一接口**：不管什么浏览器发来的请求，都用同样的方法处理
- 🔧 **封装复杂性**：HTTP协议很复杂，HttpServletRequest帮我们简化了
- 💡 **面向对象**：把请求变成一个对象，操作更方便

---

## 2. 📝 获取请求参数


### 2.1 getParameter()方法详解


**什么是请求参数**？
就是用户在表单中填写的数据，或者网址后面跟着的参数。

```html
<!-- HTML表单示例 -->
<form action="/login" method="post">
    用户名：<input type="text" name="username">
    密码：<input type="password" name="password">
    <input type="submit" value="登录">
</form>
```

**在Servlet中获取这些参数**：

```java
@WebServlet("/login")
public class LoginServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) {
        // 获取用户填写的用户名和密码
        String username = request.getParameter("username");
        String password = request.getParameter("password");
        
        System.out.println("用户名：" + username);
        System.out.println("密码：" + password);
    }
}
```

> 💡 **新手重点**：`getParameter("参数名")`中的参数名必须和HTML表单中的`name`属性一致！

### 2.2 getParameterValues()处理多选框


**什么时候用**：当用户可以选择多个选项时，比如兴趣爱好。

```html
<!-- 多选框示例 -->
<form action="/register" method="post">
    兴趣爱好：
    <input type="checkbox" name="hobby" value="reading">阅读
    <input type="checkbox" name="hobby" value="music">音乐  
    <input type="checkbox" name="hobby" value="sports">运动
</form>
```

```java
// 获取多个相同名称的参数
String[] hobbies = request.getParameterValues("hobby");
if (hobbies != null) {
    for (String hobby : hobbies) {
        System.out.println("爱好：" + hobby);
    }
}
```

### 2.3 参数获取最佳实践


| 方法 | **使用场景** | **返回结果** | **注意事项** |
|------|------------|-------------|-------------|
| `getParameter()` | `单个值参数` | `String` | `没有参数时返回null` |
| `getParameterValues()` | `多值参数(复选框)` | `String[]` | `没有参数时返回null` |
| `getParameterMap()` | `获取所有参数` | `Map<String,String[]>` | `适合动态处理参数` |

> ⚠️ **常见新手错误**：忘记检查null值，直接使用可能导致程序崩溃！

```java
// 正确的做法
String username = request.getParameter("username");
if (username != null && !username.isEmpty()) {
    // 处理用户名
} else {
    // 处理用户名为空的情况
}
```

---

## 3. 📋 获取请求头信息


### 3.1 什么是请求头


**通俗解释**：请求头就像信封上的各种标记，告诉服务器一些额外信息。

```
HTTP请求头就像快递单信息：
┌─────────────────────────────────┐
│ 发件人信息：Mozilla/5.0(浏览器)  │ ← User-Agent
│ 包裹内容：text/html             │ ← Accept  
│ 包裹大小：1024字节              │ ← Content-Length
│ 发件地址：192.168.1.100         │ ← 客户端IP
└─────────────────────────────────┘
```

### 3.2 getHeader()方法使用


**常用请求头获取**：

```java
@WebServlet("/info")
public class RequestInfoServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) {
        // 获取用户的浏览器信息
        String userAgent = request.getHeader("User-Agent");
        System.out.println("用户浏览器：" + userAgent);
        
        // 获取用户从哪个页面过来的
        String referer = request.getHeader("Referer");
        System.out.println("来源页面：" + referer);
        
        // 获取客户端IP地址
        String clientIP = request.getRemoteAddr();
        System.out.println("客户端IP：" + clientIP);
    }
}
```

### 3.3 实用的请求头应用


| 请求头名称 | **作用说明** | **实际应用** |
|-----------|------------|-------------|
| `User-Agent` | `浏览器和设备信息` | `判断是手机还是电脑访问` |
| `Referer` | `来源页面地址` | `防盗链，统计来源` |
| `Accept-Language` | `用户语言偏好` | `网站国际化` |
| `Cookie` | `用户状态信息` | `保持登录状态` |

> 💡 **实战提示**：通过User-Agent可以判断用户是用手机还是电脑访问，从而显示不同的页面！

---

## 4. 📍 获取请求路径信息


### 4.1 理解URL的各个部分


**URL组成部分解析**：
```
完整URL：http://localhost:8080/myapp/user/login?id=123

┌─────────────────────────────────────────────────────┐
│ http://     协议                                     │
│ localhost   服务器地址                               │  
│ 8080        端口号                                   │
│ /myapp      应用上下文路径(Context Path)              │
│ /user/login 具体请求路径                             │
│ ?id=123     查询参数                                 │
└─────────────────────────────────────────────────────┘
```

### 4.2 获取路径信息的方法


```java
@WebServlet("/user/profile")
public class PathInfoServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) {
        // 获取应用的根路径，比如：/myapp
        String contextPath = request.getContextPath();
        
        // 获取Servlet映射路径，比如：/user/profile  
        String servletPath = request.getServletPath();
        
        // 获取完整的请求URI，比如：/myapp/user/profile
        String requestURI = request.getRequestURI();
        
        // 获取完整的请求URL
        String requestURL = request.getRequestURL().toString();
        
        System.out.println("应用根路径：" + contextPath);
        System.out.println("Servlet路径：" + servletPath);
        System.out.println("请求URI：" + requestURI);
        System.out.println("完整URL：" + requestURL);
    }
}
```

### 4.3 路径信息的实际用途


**应用场景对比**：

| 方法 | **返回示例** | **主要用途** |
|------|------------|-------------|
| `getContextPath()` | `/myapp` | `构建相对路径，页面跳转` |
| `getServletPath()` | `/user/profile` | `确定当前访问的功能` |
| `getRequestURI()` | `/myapp/user/profile` | `日志记录，统计分析` |
| `getRequestURL()` | `http://localhost:8080/myapp/user/profile` | `生成完整链接` |

> 🎯 **新手重点**：最常用的是`getContextPath()`，用来构建页面中的链接地址！

---

## 5. 📄 请求体数据读取


### 5.1 什么是请求体


**简单理解**：请求体就是"信件的正文内容"，包含用户发送的主要数据。

```
HTTP请求结构：
┌─────────────────────────────────┐
│        请求头信息                │ ← getHeader()获取
├─────────────────────────────────┤
│        空行分隔                  │
├─────────────────────────────────┤
│        请求体内容                │ ← getInputStream()获取
│    用户名=admin&密码=123456      │   或getReader()获取
└─────────────────────────────────┘
```

### 5.2 使用InputStream读取二进制数据


**什么时候用**：上传文件、图片等二进制数据时使用。

```java
@WebServlet("/upload")  
public class FileUploadServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) {
        try {
            // 获取请求体的输入流
            InputStream inputStream = request.getInputStream();
            
            // 读取数据到字节数组
            byte[] buffer = new byte[1024];
            int bytesRead = inputStream.read(buffer);
            
            System.out.println("读取了 " + bytesRead + " 字节数据");
            
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

### 5.3 使用Reader读取文本数据


**什么时候用**：接收JSON数据、XML数据等文本格式时使用。

```java
@WebServlet("/api/data")
public class ApiServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) {
        try {
            // 设置字符编码
            request.setCharacterEncoding("UTF-8");
            
            // 获取请求体的字符流
            BufferedReader reader = request.getReader();
            StringBuilder jsonData = new StringBuilder();
            String line;
            
            // 逐行读取JSON数据
            while ((line = reader.readLine()) != null) {
                jsonData.append(line);
            }
            
            System.out.println("接收到JSON数据：" + jsonData.toString());
            
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

> ⚠️ **重要注意**：`getInputStream()`和`getReader()`不能同时使用，选择其中一个！

---

## 6. 🔤 字符编码处理


### 6.1 为什么需要处理编码


**编码问题的根源**：
```
用户输入中文：你好
↓ 浏览器编码(UTF-8)：E4BDA0E5A5BD  
↓ 网络传输
↓ 服务器接收
↓ 如果不设置编码，可能显示：ä½ å¥½
```

**常见的编码问题现象**：
- 中文显示成问号：`???`
- 中文显示成乱码：`ä½ å¥½`
- 部分中文正常，部分乱码

### 6.2 setCharacterEncoding()方法详解


**使用方法**：必须在读取参数之前设置编码！

```java
@WebServlet("/message")
public class MessageServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) {
        // 第一步：设置请求编码（必须在getParameter之前）
        try {
            request.setCharacterEncoding("UTF-8");
        } catch (UnsupportedEncodingException e) {
            e.printStackTrace();
        }
        
        // 第二步：获取参数
        String message = request.getParameter("message");
        String author = request.getParameter("author");
        
        System.out.println("消息内容：" + message);
        System.out.println("作者：" + author);
    }
}
```

### 6.3 编码处理最佳实践


**完整的编码处理方案**：

```java
public class EncodingFilter implements Filter {
    public void doFilter(ServletRequest request, ServletResponse response, 
                        FilterChain chain) throws IOException, ServletException {
        
        // 统一设置请求和响应的编码
        request.setCharacterEncoding("UTF-8");
        response.setCharacterEncoding("UTF-8");
        response.setContentType("text/html;charset=UTF-8");
        
        chain.doFilter(request, response);
    }
}
```

> 💡 **经验分享**：建议在项目中使用过滤器统一处理编码，避免每个Servlet都要设置！

**编码设置时机对比**：

| 时机 | **效果** | **推荐度** |
|------|---------|-----------|
| `每个Servlet中设置` | `只影响当前Servlet` | `⭐⭐` |
| `使用Filter统一设置` | `影响整个应用` | `⭐⭐⭐⭐⭐` |
| `web.xml中配置` | `服务器级别设置` | `⭐⭐⭐⭐` |

---

## 7. 🎯 请求方法判断


### 7.1 HTTP请求方法概述


**常用HTTP方法对比**：

```
HTTP请求方法就像不同的"办事方式"：
┌─────────────────────────────────────────┐
│ GET请求  → 就像"查看"，获取信息          │
│ POST请求 → 就像"提交"，发送数据          │  
│ PUT请求  → 就像"更新"，修改数据          │
│ DELETE请求→ 就像"删除"，删除数据         │
└─────────────────────────────────────────┘
```

### 7.2 getMethod()方法使用


```java
@WebServlet("/user")
public class UserServlet extends HttpServlet {
    
    // 处理所有类型的请求
    protected void service(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        String method = request.getMethod();
        System.out.println("请求方法：" + method);
        
        // 根据请求方法执行不同操作
        switch (method) {
            case "GET":
                handleGet(request, response);
                break;
            case "POST":
                handlePost(request, response);
                break;
            case "PUT":
                handlePut(request, response);
                break;
            case "DELETE":
                handleDelete(request, response);
                break;
            default:
                response.sendError(405, "不支持的请求方法");
        }
    }
    
    private void handleGet(HttpServletRequest request, HttpServletResponse response) {
        System.out.println("处理GET请求：查看用户信息");
    }
    
    private void handlePost(HttpServletRequest request, HttpServletResponse response) {
        System.out.println("处理POST请求：创建新用户");
    }
}
```

### 7.3 请求方法的实际应用


**RESTful API设计模式**：

| HTTP方法 | **操作类型** | **实际含义** | **示例** |
|----------|-------------|-------------|----------|
| `GET` | `查询` | `获取数据，不修改服务器状态` | `GET /user/123 获取用户信息` |
| `POST` | `创建` | `提交数据，创建新资源` | `POST /user 创建新用户` |
| `PUT` | `更新` | `更新整个资源` | `PUT /user/123 更新用户信息` |
| `DELETE` | `删除` | `删除资源` | `DELETE /user/123 删除用户` |

> 🎯 **新手理解**：GET就像"看"，POST就像"做"，一个是获取信息，一个是提交数据！

---

## 8. 🚀 实战应用示例


### 8.1 用户登录完整示例


```java
@WebServlet("/login")
public class LoginServlet extends HttpServlet {
    
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        // 1. 设置编码
        request.setCharacterEncoding("UTF-8");
        response.setContentType("text/html;charset=UTF-8");
        
        // 2. 获取请求参数
        String username = request.getParameter("username");
        String password = request.getParameter("password");
        String rememberMe = request.getParameter("rememberMe");
        
        // 3. 参数验证
        if (username == null || username.trim().isEmpty()) {
            response.getWriter().write("用户名不能为空");
            return;
        }
        
        // 4. 获取客户端信息（用于日志）
        String clientIP = request.getRemoteAddr();
        String userAgent = request.getHeader("User-Agent");
        
        // 5. 模拟登录验证
        if ("admin".equals(username) && "123456".equals(password)) {
            // 登录成功
            System.out.println("用户" + username + "登录成功，IP：" + clientIP);
            response.getWriter().write("登录成功！");
        } else {
            // 登录失败
            System.out.println("用户" + username + "登录失败，IP：" + clientIP);
            response.getWriter().write("用户名或密码错误！");
        }
    }
}
```

### 8.2 文件上传信息获取


```java
@WebServlet("/fileinfo")
public class FileInfoServlet extends HttpServlet {
    
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        // 获取上传文件的相关信息
        String contentType = request.getContentType();
        int contentLength = request.getContentLength();
        
        System.out.println("文件类型：" + contentType);
        System.out.println("文件大小：" + contentLength + " 字节");
        
        // 检查文件大小限制（比如限制10MB）
        if (contentLength > 10 * 1024 * 1024) {
            response.getWriter().write("文件太大，不能超过10MB");
            return;
        }
        
        // 检查文件类型（只允许图片）
        if (contentType != null && contentType.startsWith("image/")) {
            response.getWriter().write("文件上传成功");
        } else {
            response.getWriter().write("只能上传图片文件");
        }
    }
}
```

---

## 9. 📋 核心要点总结


### 9.1 必须掌握的核心概念


```
🔸 HttpServletRequest：封装HTTP请求信息的对象
🔸 getParameter()：获取表单参数的基本方法
🔸 getHeader()：获取请求头信息，了解客户端状态
🔸 请求路径方法：getContextPath()最常用
🔸 请求体读取：InputStream读二进制，Reader读文本
🔸 编码设置：setCharacterEncoding()解决中文乱码
🔸 请求方法：getMethod()判断GET/POST等
```

### 9.2 新手常见问题及解决


**🔹 中文乱码问题**
```java
// 错误做法：先获取参数再设置编码
String name = request.getParameter("name"); // 已经乱码了
request.setCharacterEncoding("UTF-8");      // 设置无效

// 正确做法：先设置编码再获取参数  
request.setCharacterEncoding("UTF-8");      // 先设置编码
String name = request.getParameter("name"); // 获取正确的中文
```

**🔹 参数为空的处理**
```java
// 危险做法：不检查null
String age = request.getParameter("age");
int userAge = Integer.parseInt(age); // 可能抛异常

// 安全做法：先检查再转换
String age = request.getParameter("age");
int userAge = 0;
if (age != null && !age.isEmpty()) {
    userAge = Integer.parseInt(age);
}
```

**🔹 请求方法的选择**
```java
// 获取数据用GET
@Override
protected void doGet(HttpServletRequest request, HttpServletResponse response) {
    // 查询用户信息、显示页面等
}

// 提交数据用POST  
@Override
protected void doPost(HttpServletRequest request, HttpServletResponse response) {
    // 用户注册、登录、上传文件等
}
```

### 9.3 实际开发建议


**🎯 开发最佳实践**：
- **统一编码处理**：使用Filter统一设置UTF-8编码
- **参数验证**：永远不要相信用户输入，做好验证
- **安全考虑**：获取客户端IP用于日志和安全控制
- **异常处理**：用try-catch包装可能出错的操作

**💡 学习进阶路线**：
1. ✅ 掌握基本的参数获取和请求信息获取
2. ✅ 理解HTTP请求的完整结构  
3. ⏭️ 学习HttpServletResponse响应处理
4. ⏭️ 学习Session和Cookie状态管理
5. ⏭️ 学习Filter和Listener高级功能

### 9.4 记忆要点


**核心方法快速记忆**：
- `getParameter("参数名")` → 获取表单数据
- `getHeader("请求头名")` → 获取浏览器信息  
- `getContextPath()` → 获取应用根路径
- `getMethod()` → 判断GET还是POST
- `setCharacterEncoding("UTF-8")` → 解决中文问题

> 🎯 **学习重点**：HttpServletRequest是处理用户请求的核心，掌握好参数获取和编码处理，就能解决大部分Web开发中的请求处理问题！