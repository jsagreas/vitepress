---
title: 2ã€Servletä¸JSPé…åˆ
---
## ğŸ“š ç›®å½•

1. [Servletä¸JSPåä½œåŸºç¡€](#1-servletä¸jspåä½œåŸºç¡€)
2. [Servletå¤„ç†ä¸šåŠ¡é€»è¾‘](#2-servletå¤„ç†ä¸šåŠ¡é€»è¾‘)
3. [JSPå±•ç¤ºè§†å›¾æ•°æ®](#3-jspå±•ç¤ºè§†å›¾æ•°æ®)
4. [ELè¡¨è¾¾å¼ä¼ å€¼æœºåˆ¶](#4-elè¡¨è¾¾å¼ä¼ å€¼æœºåˆ¶)
5. [JSTLæ ‡ç­¾åº“ä½¿ç”¨](#5-jstlæ ‡ç­¾åº“ä½¿ç”¨)
6. [è¯·æ±‚è½¬å‘ä¼ é€’æ•°æ®](#6-è¯·æ±‚è½¬å‘ä¼ é€’æ•°æ®)
7. [é¡µé¢è·³è½¬æ§åˆ¶](#7-é¡µé¢è·³è½¬æ§åˆ¶)
8. [å®Œæ•´æ¡ˆä¾‹æ¼”ç¤º](#8-å®Œæ•´æ¡ˆä¾‹æ¼”ç¤º)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¤ Servletä¸JSPåä½œåŸºç¡€


### 1.1 ä»€ä¹ˆæ˜¯Servletä¸JSPé…åˆ


**ğŸ’¡ ç”Ÿæ´»åŒ–ç†è§£ï¼š**
æƒ³è±¡ä¸€å®¶é¤å…çš„è¿ä½œæ¨¡å¼ï¼š
```
å®¢äººç‚¹é¤ â†’ æœåŠ¡å‘˜è®°å½• â†’ åå¨åˆ¶ä½œ â†’ æœåŠ¡å‘˜ä¸Šèœ â†’ å®¢äººç”¨é¤

å¯¹åº”JavaWebï¼š
ç”¨æˆ·è¯·æ±‚ â†’ Servletæ¥æ”¶ â†’ å¤„ç†ä¸šåŠ¡ â†’ JSPå±•ç¤º â†’ ç”¨æˆ·çœ‹åˆ°é¡µé¢
```

**ğŸ”¸ åä½œæœ¬è´¨ï¼š**
- **Servletï¼ˆåå¨ï¼‰**ï¼šä¸“é—¨å¤„ç†å¤æ‚çš„ä¸šåŠ¡é€»è¾‘
- **JSPï¼ˆæœåŠ¡å‘˜ï¼‰**ï¼šä¸“é—¨è´Ÿè´£ç¾è§‚åœ°å±•ç¤ºæ•°æ®
- **é…åˆå·¥ä½œ**ï¼šå„å¸å…¶èŒï¼Œåˆ†å·¥æ˜ç¡®

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦è¿™ç§é…åˆ


**âŒ ä¸é…åˆçš„é—®é¢˜ï¼š**
```java
// å…¨éƒ¨å†™åœ¨Servleté‡Œ - å¤ªä¹±äº†ï¼
public void doGet(HttpServletRequest req, HttpServletResponse resp) {
    resp.getWriter().println("<html><head><title>ç”¨æˆ·åˆ—è¡¨</title></head>");
    resp.getWriter().println("<body><h1>æ‰€æœ‰ç”¨æˆ·</h1>");
    // å¤„ç†ä¸šåŠ¡é€»è¾‘
    List<User> users = userService.getAllUsers();
    // ç»§ç»­å†™HTML... ä»£ç åˆé•¿åˆä¹±
}
```

**âœ… é…åˆåçš„ä¼˜åŠ¿ï¼š**
```
åˆ†å·¥æ˜ç¡®ï¼š
â€¢ Servletï¼šåªç®¡ä¸šåŠ¡å¤„ç†ï¼Œä¸ç®¡é¡µé¢æ˜¾ç¤º
â€¢ JSPï¼šåªç®¡é¡µé¢å±•ç¤ºï¼Œä¸ç®¡å¤æ‚è®¡ç®—

ä»£ç æ¸…æ™°ï¼š
â€¢ Javaä»£ç å’ŒHTMLä»£ç åˆ†ç¦»
â€¢ ç¨‹åºå‘˜å†™ä¸šåŠ¡ï¼Œå‰ç«¯å†™é¡µé¢

ç»´æŠ¤æ–¹ä¾¿ï¼š
â€¢ ä¿®æ”¹é¡µé¢æ ·å¼ä¸å½±å“ä¸šåŠ¡é€»è¾‘
â€¢ ä¿®æ”¹ä¸šåŠ¡é€»è¾‘ä¸å½±å“é¡µé¢å¸ƒå±€
```

### 1.3 åä½œçš„åŸºæœ¬æµç¨‹


**ğŸ”„ æ ‡å‡†æµç¨‹å›¾ï¼š**
```
â‘ ç”¨æˆ·è¯·æ±‚
    â†“
â‘¡Servletæ¥æ”¶è¯·æ±‚
    â†“
â‘¢å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼ˆæŸ¥æ•°æ®åº“ã€è®¡ç®—ç­‰ï¼‰
    â†“
â‘£å°†æ•°æ®æ”¾å…¥è¯·æ±‚åŸŸ
    â†“
â‘¤è½¬å‘åˆ°JSPé¡µé¢
    â†“
â‘¥JSPå–å‡ºæ•°æ®å¹¶å±•ç¤º
    â†“
â‘¦è¿”å›å®Œæ•´é¡µé¢ç»™ç”¨æˆ·
```

---

## 2. âš™ï¸ Servletå¤„ç†ä¸šåŠ¡é€»è¾‘


### 2.1 Servletçš„èŒè´£å®šä½


**ğŸ¯ Servletåº”è¯¥åšä»€ä¹ˆï¼š**
- æ¥æ”¶ç”¨æˆ·è¯·æ±‚å‚æ•°
- è°ƒç”¨ä¸šåŠ¡å±‚å¤„ç†æ•°æ®
- å‡†å¤‡å±•ç¤ºæ‰€éœ€çš„æ•°æ®
- å†³å®šè·³è½¬åˆ°å“ªä¸ªé¡µé¢

**ğŸš« Servletä¸åº”è¯¥åšä»€ä¹ˆï¼š**
- ä¸è¦å†™HTMLä»£ç 
- ä¸è¦å…³å¿ƒé¡µé¢æ ·å¼
- ä¸è¦å¤„ç†å¤æ‚çš„é¡µé¢é€»è¾‘

### 2.2 å…¸å‹çš„Servletä¸šåŠ¡å¤„ç†


**ğŸ“ ç”¨æˆ·ç®¡ç†ç¤ºä¾‹ï¼š**
```java
@WebServlet("/user")
public class UserServlet extends HttpServlet {
    private UserService userService = new UserService();
    
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) 
            throws ServletException, IOException {
        
        // 1. è·å–è¯·æ±‚å‚æ•°
        String action = req.getParameter("action");
        
        if ("list".equals(action)) {
            // 2. å¤„ç†ä¸šåŠ¡é€»è¾‘
            List<User> userList = userService.getAllUsers();
            
            // 3. å°†æ•°æ®æ”¾å…¥è¯·æ±‚åŸŸ
            req.setAttribute("users", userList);
            req.setAttribute("totalCount", userList.size());
            
            // 4. è½¬å‘åˆ°JSPå±•ç¤º
            req.getRequestDispatcher("/pages/user-list.jsp").forward(req, resp);
        }
    }
}
```

**ğŸ” ä»£ç è¯¦è§£ï¼š**
- `req.getParameter("action")`ï¼šè·å–ç”¨æˆ·æƒ³è¦åšä»€ä¹ˆæ“ä½œ
- `userService.getAllUsers()`ï¼šè°ƒç”¨ä¸šåŠ¡å±‚è·å–æ•°æ®
- `req.setAttribute()`ï¼šæŠŠæ•°æ®"æ‰“åŒ…"ç»™JSPä½¿ç”¨
- `req.getRequestDispatcher().forward()`ï¼šè½¬å‘ç»™JSPé¡µé¢

### 2.3 æ•°æ®å‡†å¤‡çš„æœ€ä½³å®è·µ


**ğŸ“¦ æ•°æ®å‡†å¤‡ç­–ç•¥ï¼š**
```java
// å‡†å¤‡é¡µé¢æ‰€éœ€çš„æ‰€æœ‰æ•°æ®
req.setAttribute("currentUser", currentUser);     // å½“å‰ç™»å½•ç”¨æˆ·
req.setAttribute("userList", userList);           // ç”¨æˆ·åˆ—è¡¨
req.setAttribute("pageNo", pageNo);               // å½“å‰é¡µç 
req.setAttribute("totalPages", totalPages);       // æ€»é¡µæ•°
req.setAttribute("searchKeyword", keyword);       // æœç´¢å…³é”®è¯
```

**ğŸ’¡ æ•°æ®ç»„ç»‡æŠ€å·§ï¼š**
```java
// æ–¹æ³•1ï¼šç›´æ¥æ”¾å…¥åŸºç¡€æ•°æ®
req.setAttribute("users", userList);

// æ–¹æ³•2ï¼šæ”¾å…¥åŒ…è£…å¯¹è±¡ï¼ˆæ¨èï¼‰
Map<String, Object> data = new HashMap<>();
data.put("users", userList);
data.put("totalCount", userList.size());
data.put("hasNextPage", currentPage < totalPages);
req.setAttribute("pageData", data);
```

---

## 3. ğŸ–¼ï¸ JSPå±•ç¤ºè§†å›¾æ•°æ®


### 3.1 JSPçš„èŒè´£å®šä½


**ğŸ¨ JSPåº”è¯¥åšä»€ä¹ˆï¼š**
- æ¥æ”¶Servletä¼ æ¥çš„æ•°æ®
- ç¾è§‚åœ°å±•ç¤ºæ•°æ®
- æä¾›ç”¨æˆ·äº¤äº’ç•Œé¢
- å¤„ç†é¡µé¢è·³è½¬é“¾æ¥

**ğŸš« JSPä¸åº”è¯¥åšä»€ä¹ˆï¼š**
- ä¸è¦å†™å¤æ‚çš„Javaä¸šåŠ¡é€»è¾‘
- ä¸è¦ç›´æ¥è¿æ¥æ•°æ®åº“
- ä¸è¦åšæ•°æ®è®¡ç®—å¤„ç†

### 3.2 JSPåŸºç¡€æ•°æ®å±•ç¤º


**ğŸ“„ ç®€å•åˆ—è¡¨å±•ç¤ºï¼š**
```jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <title>ç”¨æˆ·åˆ—è¡¨</title>
</head>
<body>
    <h2>ç”¨æˆ·ç®¡ç†</h2>
    
    <!-- æ˜¾ç¤ºæ€»æ•° -->
    <p>å…±æœ‰ç”¨æˆ·ï¼š${totalCount} äºº</p>
    
    <!-- ç”¨æˆ·åˆ—è¡¨è¡¨æ ¼ -->
    <table border="1">
        <tr>
            <th>ID</th>
            <th>ç”¨æˆ·å</th>
            <th>é‚®ç®±</th>
            <th>æ“ä½œ</th>
        </tr>
        
        <!-- éå†ç”¨æˆ·åˆ—è¡¨ -->
        <c:forEach var="user" items="${users}">
            <tr>
                <td>${user.id}</td>
                <td>${user.username}</td>
                <td>${user.email}</td>
                <td>
                    <a href="/user?action=edit&id=${user.id}">ç¼–è¾‘</a>
                    <a href="/user?action=delete&id=${user.id}">åˆ é™¤</a>
                </td>
            </tr>
        </c:forEach>
    </table>
</body>
</html>
```

### 3.3 JSPé¡µé¢ç»„ç»‡ç»“æ„


**ğŸ—ï¸ æ¨èçš„é¡µé¢ç»“æ„ï¼š**
```jsp
<%-- 1. é¡µé¢æŒ‡ä»¤å’Œå¯¼å…¥ --%>
<%@ page contentType="text/html;charset=UTF-8" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>

<html>
<head>
    <title>é¡µé¢æ ‡é¢˜</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <%-- 2. é¡µé¢å¤´éƒ¨ --%>
    <div class="header">
        <h1>ç³»ç»Ÿåç§°</h1>
        <div class="user-info">æ¬¢è¿ï¼Œ${currentUser.username}</div>
    </div>
    
    <%-- 3. ä¸»è¦å†…å®¹åŒºåŸŸ --%>
    <div class="content">
        <!-- è¿™é‡Œæ”¾ä¸»è¦å†…å®¹ -->
    </div>
    
    <%-- 4. é¡µé¢åº•éƒ¨ --%>
    <div class="footer">
        <p>&copy; 2024 å…¬å¸åç§°</p>
    </div>
</body>
</html>
```

---

## 4. ğŸ“¨ ELè¡¨è¾¾å¼ä¼ å€¼æœºåˆ¶


### 4.1 ä»€ä¹ˆæ˜¯ELè¡¨è¾¾å¼


**ğŸ’¡ é€šä¿—è§£é‡Šï¼š**
ELè¡¨è¾¾å¼å°±åƒæ˜¯ä¸€ä¸ª**æ™ºèƒ½å–å¿«é€’çš„å·¥å…·**ï¼š
```
ServletæŠŠæ•°æ®æ”¾å…¥"å¿«é€’æŸœ"ï¼ˆè¯·æ±‚åŸŸï¼‰
JSPç”¨ELè¡¨è¾¾å¼"å–å¿«é€’"ï¼ˆè·å–æ•°æ®ï¼‰
æ ¼å¼ï¼š${å¿«é€’å•å·}
```

**ğŸ”¸ ELè¡¨è¾¾å¼åŸºæœ¬è¯­æ³•ï¼š**
```jsp
<!-- åŸºæœ¬æ ¼å¼ -->
${å˜é‡å}

<!-- å®é™…ä½¿ç”¨ -->
${user.name}        <!-- ç­‰ä»·äºï¼šuser.getName() -->
${user.age}         <!-- ç­‰ä»·äºï¼šuser.getAge() -->
${users.size()}     <!-- è°ƒç”¨é›†åˆçš„æ–¹æ³• -->
```

### 4.2 ELè¡¨è¾¾å¼çš„æ•°æ®æ¥æº


**ğŸ“ å››å¤§ä½œç”¨åŸŸæœç´¢é¡ºåºï¼š**
```
ELè¡¨è¾¾å¼ ${userName} çš„æœç´¢é¡ºåºï¼š

1. pageScope     (é¡µé¢åŸŸ) - æœ€å°èŒƒå›´
2. requestScope  (è¯·æ±‚åŸŸ) - ä¸€æ¬¡è¯·æ±‚å†…æœ‰æ•ˆ  â† æœ€å¸¸ç”¨
3. sessionScope  (ä¼šè¯åŸŸ) - æ•´ä¸ªä¼šè¯æœŸé—´æœ‰æ•ˆ
4. applicationScope (åº”ç”¨åŸŸ) - æ•´ä¸ªåº”ç”¨æœŸé—´æœ‰æ•ˆ
```

**ğŸ” æ˜ç¡®æŒ‡å®šä½œç”¨åŸŸï¼š**
```jsp
${requestScope.userName}    <!-- åªä»è¯·æ±‚åŸŸä¸­å– -->
${sessionScope.currentUser} <!-- åªä»ä¼šè¯åŸŸä¸­å– -->
${param.userId}             <!-- ç›´æ¥ä»è¯·æ±‚å‚æ•°ä¸­å– -->
```

### 4.3 ELè¡¨è¾¾å¼çš„é«˜çº§ç”¨æ³•


**âš¡ å¸¸ç”¨è¡¨è¾¾å¼ï¼š**

| è¡¨è¾¾å¼ç±»å‹ | ç¤ºä¾‹ | è¯´æ˜ |
|-----------|------|------|
| **å¯¹è±¡å±æ€§** | `${user.name}` | è·å–å¯¹è±¡å±æ€§ |
| **é›†åˆå…ƒç´ ** | `${users[0].name}` | è·å–é›†åˆç¬¬ä¸€ä¸ªå…ƒç´  |
| **Mapå€¼** | `${dataMap.count}` | è·å–Mapä¸­çš„å€¼ |
| **è¯·æ±‚å‚æ•°** | `${param.userId}` | è·å–è¯·æ±‚å‚æ•° |
| **ç©ºå€¼åˆ¤æ–­** | `${empty userList}` | åˆ¤æ–­æ˜¯å¦ä¸ºç©º |

**ğŸ›¡ï¸ ç©ºå€¼å®‰å…¨å¤„ç†ï¼š**
```jsp
<!-- å®‰å…¨æ˜¾ç¤ºï¼Œé¿å…ç©ºæŒ‡é’ˆ -->
ç”¨æˆ·åï¼š${empty user ? 'æœªç™»å½•' : user.name}

<!-- æ¡ä»¶æ˜¾ç¤º -->
<c:if test="${not empty user}">
    æ¬¢è¿ï¼Œ${user.name}ï¼
</c:if>
```

---

## 5. ğŸ·ï¸ JSTLæ ‡ç­¾åº“ä½¿ç”¨


### 5.1 ä»€ä¹ˆæ˜¯JSTLæ ‡ç­¾åº“


**ğŸ’¡ é€šä¿—ç†è§£ï¼š**
JSTLå°±åƒæ˜¯JSPé¡µé¢çš„**æ™ºèƒ½åŠ©æ‰‹å·¥å…·ç®±**ï¼š
```
æ™®é€šHTMLï¼šåªèƒ½æ˜¾ç¤ºé™æ€å†…å®¹
JSPè„šæœ¬ï¼šå¯ä»¥å†™Javaä»£ç ï¼Œä½†å¾ˆä¹±
JSTLæ ‡ç­¾ï¼šæä¾›ç®€å•æ ‡ç­¾å®Œæˆå¤æ‚åŠŸèƒ½
```

**ğŸ“¦ JSTLæ ¸å¿ƒæ ‡ç­¾åº“ï¼š**
```jsp
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
```

### 5.2 JSTLæ ¸å¿ƒæ ‡ç­¾è¯¦è§£


**ğŸ”„ æ¡ä»¶åˆ¤æ–­æ ‡ç­¾ï¼š**
```jsp
<!-- ifæ ‡ç­¾ï¼šç®€å•æ¡ä»¶åˆ¤æ–­ -->
<c:if test="${user.age >= 18}">
    <span style="color: green">å·²æˆå¹´</span>
</c:if>

<!-- chooseæ ‡ç­¾ï¼šå¤šæ¡ä»¶åˆ¤æ–­ï¼ˆç±»ä¼¼switchï¼‰ -->
<c:choose>
    <c:when test="${user.level == 'VIP'}">
        <span class="vip">VIPç”¨æˆ·</span>
    </c:when>
    <c:when test="${user.level == 'GOLD'}">
        <span class="gold">é»„é‡‘ç”¨æˆ·</span>
    </c:when>
    <c:otherwise>
        <span class="normal">æ™®é€šç”¨æˆ·</span>
    </c:otherwise>
</c:choose>
```

**ğŸ” å¾ªç¯éå†æ ‡ç­¾ï¼š**
```jsp
<!-- forEachï¼šéå†é›†åˆ -->
<c:forEach var="user" items="${userList}" varStatus="status">
    <tr class="${status.index % 2 == 0 ? 'even' : 'odd'}">
        <td>${status.index + 1}</td>  <!-- åºå· -->
        <td>${user.name}</td>
        <td>${user.email}</td>
    </tr>
</c:forEach>

<!-- forEachï¼šæŒ‡å®šèŒƒå›´å¾ªç¯ -->
<c:forEach var="i" begin="1" end="${totalPages}">
    <a href="/user?page=${i}" class="${i == currentPage ? 'current' : ''}">
        ${i}
    </a>
</c:forEach>
```

### 5.3 JSTLå®ç”¨æŠ€å·§


**ğŸ“Š å¾ªç¯çŠ¶æ€ä¿¡æ¯ï¼š**
```jsp
<c:forEach var="item" items="${list}" varStatus="s">
    ç¬¬${s.index + 1}è¡Œï¼Œ
    <c:if test="${s.first}">è¿™æ˜¯ç¬¬ä¸€è¡Œ</c:if>
    <c:if test="${s.last}">è¿™æ˜¯æœ€åä¸€è¡Œ</c:if>
    
    <!-- s.index: ä»0å¼€å§‹çš„ç´¢å¼• -->
    <!-- s.count: ä»1å¼€å§‹çš„è®¡æ•° -->
    <!-- s.first: æ˜¯å¦ç¬¬ä¸€ä¸ª -->
    <!-- s.last: æ˜¯å¦æœ€åä¸€ä¸ª -->
</c:forEach>
```

**ğŸ› ï¸ å˜é‡è®¾ç½®å’Œè¾“å‡ºï¼š**
```jsp
<!-- setï¼šè®¾ç½®å˜é‡ -->
<c:set var="welcomeMsg" value="æ¬¢è¿è®¿é—®æˆ‘ä»¬çš„ç½‘ç«™" />

<!-- outï¼šè¾“å‡ºå†…å®¹ï¼ˆè‡ªåŠ¨è½¬ä¹‰HTMLï¼‰ -->
<c:out value="${user.description}" default="æš‚æ— æè¿°" />
```

---

## 6. ğŸšš è¯·æ±‚è½¬å‘ä¼ é€’æ•°æ®


### 6.1 è¯·æ±‚è½¬å‘çš„å·¥ä½œåŸç†


**ğŸ’¡ ç”Ÿæ´»åŒ–ç±»æ¯”ï¼š**
è¯·æ±‚è½¬å‘å°±åƒ**å†…éƒ¨éƒ¨é—¨åä½œ**ï¼š
```
å®¢æˆ·æ‰¾å‰å° â†’ å‰å°è½¬ç»™ä¸šåŠ¡éƒ¨é—¨ â†’ ä¸šåŠ¡éƒ¨é—¨å¤„ç† â†’ ç»Ÿä¸€å›å¤å®¢æˆ·

ç”¨æˆ·è¯·æ±‚ â†’ Servletæ¥æ”¶ â†’ å¤„ç†ä¸šåŠ¡ â†’ è½¬å‘ç»™JSP â†’ è¿”å›é¡µé¢
```

**ğŸ”„ è½¬å‘è¿‡ç¨‹ç¤ºæ„å›¾ï¼š**
```
æµè§ˆå™¨                 WebæœåŠ¡å™¨
   |                      |
   |--â‘ å‘é€è¯·æ±‚----------->|
   |                      |--â‘¡Servletå¤„ç†
   |                      |--â‘¢è½¬å‘ç»™JSP
   |                      |--â‘£JSPç”Ÿæˆé¡µé¢
   |<-----â‘¤è¿”å›é¡µé¢-------|
   
æ³¨æ„ï¼šæµè§ˆå™¨åœ°å€æ ä¸å˜ï¼Œç”¨æˆ·æ„Ÿè§‰åªè¯·æ±‚äº†ä¸€æ¬¡
```

### 6.2 è½¬å‘çš„å…·ä½“å®ç°


**ğŸ“¤ Servletä¸­çš„è½¬å‘ï¼š**
```java
@WebServlet("/product")
public class ProductServlet extends HttpServlet {
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) 
            throws ServletException, IOException {
        
        // 1. å¤„ç†ä¸šåŠ¡é€»è¾‘
        String productId = req.getParameter("id");
        Product product = productService.getById(productId);
        List<Review> reviews = reviewService.getByProductId(productId);
        
        // 2. å‡†å¤‡å±•ç¤ºæ•°æ®
        req.setAttribute("product", product);
        req.setAttribute("reviews", reviews);
        req.setAttribute("reviewCount", reviews.size());
        
        // 3. è½¬å‘åˆ°JSPé¡µé¢
        String jspPage = "/pages/product-detail.jsp";
        req.getRequestDispatcher(jspPage).forward(req, resp);
    }
}
```

### 6.3 æ•°æ®ä¼ é€’çš„æœ€ä½³å®è·µ


**ğŸ“¦ æ•°æ®ä¼ é€’ç­–ç•¥ï¼š**

| æ•°æ®ç±»å‹ | ä¼ é€’æ–¹å¼ | ä½¿ç”¨åœºæ™¯ |
|---------|----------|----------|
| **å•ä¸ªå¯¹è±¡** | `req.setAttribute("user", user)` | æ˜¾ç¤ºç”¨æˆ·è¯¦æƒ… |
| **é›†åˆæ•°æ®** | `req.setAttribute("list", list)` | æ˜¾ç¤ºåˆ—è¡¨ |
| **çŠ¶æ€ä¿¡æ¯** | `req.setAttribute("message", "ä¿å­˜æˆåŠŸ")` | æ“ä½œæç¤º |
| **åˆ†é¡µä¿¡æ¯** | `req.setAttribute("pageInfo", pageInfo)` | åˆ†é¡µæ˜¾ç¤º |

**ğŸ¯ ç»Ÿä¸€æ•°æ®ä¼ é€’è§„èŒƒï¼š**
```java
// æ¨èï¼šä½¿ç”¨ç»Ÿä¸€çš„æ•°æ®åŒ…è£…
Map<String, Object> model = new HashMap<>();
model.put("user", user);
model.put("permissions", permissions);
model.put("message", "æ“ä½œæˆåŠŸ");

req.setAttribute("model", model);
```

---

## 7. ğŸ§­ é¡µé¢è·³è½¬æ§åˆ¶


### 7.1 è·³è½¬æ–¹å¼çš„é€‰æ‹©


**ğŸ”€ ä¸¤ç§è·³è½¬æ–¹å¼å¯¹æ¯”ï¼š**

| å¯¹æ¯”é¡¹ | **è½¬å‘ï¼ˆForwardï¼‰** | **é‡å®šå‘ï¼ˆRedirectï¼‰** |
|-------|-------------------|---------------------|
| **åœ°å€æ ** | ä¸å˜ | æ”¹å˜ |
| **è¯·æ±‚æ¬¡æ•°** | 1æ¬¡ | 2æ¬¡ |
| **æ•°æ®ä¼ é€’** | å¯ä»¥ä¼ é€’ | ä¸èƒ½ä¼ é€’è¯·æ±‚åŸŸæ•°æ® |
| **ä½¿ç”¨åœºæ™¯** | æŸ¥è¯¢æ˜¾ç¤º | å¢åˆ æ”¹åè·³è½¬ |

### 7.2 è½¬å‘è·³è½¬çš„åº”ç”¨


**â¡ï¸ é€‚åˆè½¬å‘çš„åœºæ™¯ï¼š**
```java
// åœºæ™¯1ï¼šæŸ¥è¯¢æ•°æ®åæ˜¾ç¤º
@WebServlet("/user/list")
public class UserListServlet extends HttpServlet {
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) 
            throws ServletException, IOException {
        
        // æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨
        List<User> users = userService.getAllUsers();
        req.setAttribute("users", users);
        
        // è½¬å‘åˆ°åˆ—è¡¨é¡µé¢
        req.getRequestDispatcher("/pages/user-list.jsp").forward(req, resp);
    }
}
```

**ğŸ¨ JSPä¸­çš„è½¬å‘é“¾æ¥ï¼š**
```jsp
<!-- æŸ¥è¯¢ç±»é“¾æ¥ä½¿ç”¨GETï¼Œä¼šè½¬å‘åˆ°æ˜¾ç¤ºé¡µé¢ -->
<a href="/user/detail?id=${user.id}">æŸ¥çœ‹è¯¦æƒ…</a>
<a href="/product/list?category=electronics">ç”µå­äº§å“</a>

<!-- è¡¨å•æäº¤åé€šå¸¸è½¬å‘åˆ°ç»“æœé¡µé¢ -->
<form action="/user/search" method="get">
    <input type="text" name="keyword" placeholder="æœç´¢ç”¨æˆ·">
    <button type="submit">æœç´¢</button>
</form>
```

### 7.3 é‡å®šå‘è·³è½¬çš„åº”ç”¨


**ğŸ”„ é€‚åˆé‡å®šå‘çš„åœºæ™¯ï¼š**
```java
// åœºæ™¯ï¼šå¢åˆ æ”¹æ“ä½œåè·³è½¬
@WebServlet("/user/save")
public class UserSaveServlet extends HttpServlet {
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) 
            throws ServletException, IOException {
        
        // ä¿å­˜ç”¨æˆ·ä¿¡æ¯
        User user = new User();
        user.setName(req.getParameter("name"));
        user.setEmail(req.getParameter("email"));
        
        userService.save(user);
        
        // é‡å®šå‘åˆ°ç”¨æˆ·åˆ—è¡¨é¡µï¼ˆé˜²æ­¢é‡å¤æäº¤ï¼‰
        resp.sendRedirect("/user/list");
    }
}
```

**âš ï¸ é‡å®šå‘æ³¨æ„äº‹é¡¹ï¼š**
```java
// é”™è¯¯ï¼šé‡å®šå‘åæ•°æ®ä¸¢å¤±
userService.save(user);
req.setAttribute("message", "ä¿å­˜æˆåŠŸ"); // è¿™ä¸ªæ•°æ®ä¼šä¸¢å¤±
resp.sendRedirect("/user/list");

// æ­£ç¡®ï¼šä½¿ç”¨Sessionä¼ é€’æ¶ˆæ¯
userService.save(user);
req.getSession().setAttribute("message", "ä¿å­˜æˆåŠŸ");
resp.sendRedirect("/user/list");
```

---

## 8. ğŸ¯ å®Œæ•´æ¡ˆä¾‹æ¼”ç¤º


### 8.1 æ¡ˆä¾‹éœ€æ±‚è¯´æ˜


**ğŸ“‹ å­¦ç”Ÿç®¡ç†ç³»ç»Ÿæ¡ˆä¾‹ï¼š**
- æ˜¾ç¤ºå­¦ç”Ÿåˆ—è¡¨
- æ·»åŠ æ–°å­¦ç”Ÿ
- ç¼–è¾‘å­¦ç”Ÿä¿¡æ¯
- åˆ é™¤å­¦ç”Ÿè®°å½•

### 8.2 Servletæ§åˆ¶å™¨å®ç°


**ğŸ® StudentServlet.javaï¼š**
```java
@WebServlet("/student")
public class StudentServlet extends HttpServlet {
    private StudentService studentService = new StudentService();
    
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) 
            throws ServletException, IOException {
        
        String action = req.getParameter("action");
        
        if ("list".equals(action) || action == null) {
            showStudentList(req, resp);
        } else if ("add".equals(action)) {
            showAddForm(req, resp);
        } else if ("edit".equals(action)) {
            showEditForm(req, resp);
        }
    }
    
    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) 
            throws ServletException, IOException {
        
        String action = req.getParameter("action");
        
        if ("save".equals(action)) {
            saveStudent(req, resp);
        } else if ("update".equals(action)) {
            updateStudent(req, resp);
        } else if ("delete".equals(action)) {
            deleteStudent(req, resp);
        }
    }
    
    // æ˜¾ç¤ºå­¦ç”Ÿåˆ—è¡¨
    private void showStudentList(HttpServletRequest req, HttpServletResponse resp) 
            throws ServletException, IOException {
        
        List<Student> students = studentService.getAllStudents();
        req.setAttribute("students", students);
        req.setAttribute("totalCount", students.size());
        
        req.getRequestDispatcher("/pages/student-list.jsp").forward(req, resp);
    }
    
    // ä¿å­˜æ–°å­¦ç”Ÿ
    private void saveStudent(HttpServletRequest req, HttpServletResponse resp) 
            throws IOException {
        
        Student student = new Student();
        student.setName(req.getParameter("name"));
        student.setAge(Integer.parseInt(req.getParameter("age")));
        student.setGrade(req.getParameter("grade"));
        
        studentService.save(student);
        
        // é‡å®šå‘åˆ°åˆ—è¡¨é¡µ
        resp.sendRedirect("/student?action=list");
    }
}
```

### 8.3 JSPè§†å›¾é¡µé¢å®ç°


**ğŸ“„ student-list.jspï¼š**
```jsp
<%@ page contentType="text/html;charset=UTF-8" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<html>
<head>
    <title>å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ</title>
    <style>
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        th { background-color: #f2f2f2; }
        .btn { padding: 5px 10px; text-decoration: none; color: white; border-radius: 3px; }
        .btn-add { background-color: #28a745; }
        .btn-edit { background-color: #007bff; }
        .btn-delete { background-color: #dc3545; }
    </style>
</head>
<body>
    <div class="container">
        <h2>å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ</h2>
        
        <!-- æ“ä½œæŒ‰é’® -->
        <div class="toolbar">
            <a href="/student?action=add" class="btn btn-add">æ·»åŠ å­¦ç”Ÿ</a>
            <span>å…±æœ‰å­¦ç”Ÿï¼š${totalCount} äºº</span>
        </div>
        
        <!-- å­¦ç”Ÿåˆ—è¡¨ -->
        <table>
            <thead>
                <tr>
                    <th>åºå·</th>
                    <th>å§“å</th>
                    <th>å¹´é¾„</th>
                    <th>å¹´çº§</th>
                    <th>æ“ä½œ</th>
                </tr>
            </thead>
            <tbody>
                <c:choose>
                    <c:when test="${not empty students}">
                        <c:forEach var="student" items="${students}" varStatus="status">
                            <tr>
                                <td>${status.index + 1}</td>
                                <td>${student.name}</td>
                                <td>${student.age}</td>
                                <td>${student.grade}</td>
                                <td>
                                    <a href="/student?action=edit&id=${student.id}" class="btn btn-edit">ç¼–è¾‘</a>
                                    <a href="/student?action=delete&id=${student.id}" 
                                       class="btn btn-delete" 
                                       onclick="return confirm('ç¡®å®šè¦åˆ é™¤å—ï¼Ÿ')">åˆ é™¤</a>
                                </td>
                            </tr>
                        </c:forEach>
                    </c:when>
                    <c:otherwise>
                        <tr>
                            <td colspan="5">æš‚æ— å­¦ç”Ÿæ•°æ®</td>
                        </tr>
                    </c:otherwise>
                </c:choose>
            </tbody>
        </table>
    </div>
</body>
</html>
```

### 8.4 æ•°æ®æµè½¬å®Œæ•´è¿‡ç¨‹


**ğŸ”„ å®Œæ•´çš„æ•°æ®æµè½¬ï¼š**
```
â‘  ç”¨æˆ·è®¿é—®ï¼šhttp://localhost:8080/student?action=list

â‘¡ StudentServletæ¥æ”¶è¯·æ±‚ï¼š
   - è§£æactionå‚æ•°
   - è°ƒç”¨showStudentListæ–¹æ³•

â‘¢ Servletå¤„ç†ä¸šåŠ¡ï¼š
   - è°ƒç”¨StudentServiceè·å–æ•°æ®
   - å°†æ•°æ®æ”¾å…¥è¯·æ±‚åŸŸ

â‘£ è½¬å‘åˆ°JSPï¼š
   - req.getRequestDispatcher("/pages/student-list.jsp").forward(req, resp)

â‘¤ JSPæ¸²æŸ“é¡µé¢ï¼š
   - ä½¿ç”¨ELè¡¨è¾¾å¼è·å–æ•°æ®ï¼š${students}
   - ä½¿ç”¨JSTLæ ‡ç­¾éå†ï¼š<c:forEach>
   - ç”Ÿæˆæœ€ç»ˆHTML

â‘¥ è¿”å›ç»™ç”¨æˆ·ï¼š
   - å®Œæ•´çš„HTMLé¡µé¢
   - ç”¨æˆ·çœ‹åˆ°å­¦ç”Ÿåˆ—è¡¨
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ”¸ åˆ†å·¥åä½œæ¨¡å¼ï¼š**
```
ServletèŒè´£ï¼š
âœ… æ¥æ”¶è¯·æ±‚å‚æ•°
âœ… å¤„ç†ä¸šåŠ¡é€»è¾‘
âœ… å‡†å¤‡æ˜¾ç¤ºæ•°æ®
âœ… æ§åˆ¶é¡µé¢è·³è½¬

JSPèŒè´£ï¼š
âœ… æ¥æ”¶æ•°æ®å¹¶å±•ç¤º
âœ… æä¾›ç”¨æˆ·ç•Œé¢
âœ… å¤„ç†é¡µé¢æ ·å¼
âœ… ç”Ÿæˆæœ€ç»ˆHTML
```

**ğŸ”¸ æ•°æ®ä¼ é€’æœºåˆ¶ï¼š**
```
è¯·æ±‚åŸŸä¼ é€’ï¼šreq.setAttribute() â†’ ${å±æ€§å}
ELè¡¨è¾¾å¼å–å€¼ï¼š${å¯¹è±¡.å±æ€§}ã€${é›†åˆ[ç´¢å¼•]}
JSTLæ ‡ç­¾æ§åˆ¶ï¼š<c:if>ã€<c:forEach>ã€<c:choose>
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆè¦åˆ†ç¦»ï¼š**
```
ä»£ç èŒè´£æ¸…æ™°ï¼š
â€¢ Servletä¸“æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œä¸ç®¡é¡µé¢æ˜¾ç¤º
â€¢ JSPä¸“æ³¨é¡µé¢å±•ç¤ºï¼Œä¸ç®¡å¤æ‚è®¡ç®—

ç»´æŠ¤æ›´å®¹æ˜“ï¼š
â€¢ ä¿®æ”¹ä¸šåŠ¡é€»è¾‘ä¸å½±å“é¡µé¢
â€¢ ä¿®æ”¹é¡µé¢æ ·å¼ä¸å½±å“ä¸šåŠ¡

å›¢é˜Ÿåä½œå‹å¥½ï¼š
â€¢ åç«¯ç¨‹åºå‘˜å†™Servlet
â€¢ å‰ç«¯è®¾è®¡å¸ˆå†™JSPé¡µé¢
```

**ğŸ”¹ æ•°æ®ä¼ é€’çš„æœ¬è´¨ï¼š**
```
è¯·æ±‚åŸŸå°±åƒä¸€ä¸ª"æ•°æ®ç®±å­"ï¼š
â€¢ ServletæŠŠæ•°æ®æ”¾è¿›ç®±å­
â€¢ JSPä»ç®±å­é‡Œå–å‡ºæ•°æ®
â€¢ ä¸€æ¬¡è¯·æ±‚æœŸé—´ç®±å­ä¸€ç›´å­˜åœ¨

ELè¡¨è¾¾å¼æ˜¯"æ™ºèƒ½é’¥åŒ™"ï¼š
â€¢ è‡ªåŠ¨åœ¨å››ä¸ªåŸŸä¸­æŸ¥æ‰¾æ•°æ®
â€¢ è‡ªåŠ¨è°ƒç”¨getteræ–¹æ³•
â€¢ è‡ªåŠ¨å¤„ç†ç©ºå€¼æƒ…å†µ
```

### 9.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ å¼€å‘æµç¨‹å»ºè®®ï¼š**
```
1. åˆ†æéœ€æ±‚
   â†“
2. è®¾è®¡Servletå¤„ç†é€»è¾‘
   â†“  
3. ç¡®å®šéœ€è¦ä¼ é€’çš„æ•°æ®
   â†“
4. è®¾è®¡JSPé¡µé¢å¸ƒå±€
   â†“
5. ç¼–å†™Servletä»£ç 
   â†“
6. ç¼–å†™JSPé¡µé¢
   â†“
7. æµ‹è¯•æ•°æ®ä¼ é€’
```

**ğŸ“ ç¼–ç è§„èŒƒå»ºè®®ï¼š**
```
Servletç¼–ç è§„èŒƒï¼š
â€¢ ä¸€ä¸ªServletå¤„ç†ä¸€ç±»ä¸šåŠ¡
â€¢ ä½¿ç”¨actionå‚æ•°åŒºåˆ†å…·ä½“æ“ä½œ
â€¢ ç»Ÿä¸€çš„æ•°æ®å‡†å¤‡æ ¼å¼
â€¢ æ˜ç¡®çš„è·³è½¬é€»è¾‘

JSPç¼–ç è§„èŒƒï¼š
â€¢ å¯¼å…¥å¿…è¦çš„æ ‡ç­¾åº“
â€¢ ä½¿ç”¨ELè¡¨è¾¾å¼è€ŒéJavaä»£ç 
â€¢ åˆç†ä½¿ç”¨JSTLæ ‡ç­¾
â€¢ ä¿æŒé¡µé¢ç»“æ„æ¸…æ™°
```

**ğŸ”§ å¸¸è§é—®é¢˜è§£å†³ï¼š**
```
æ•°æ®è·å–ä¸åˆ°ï¼š
â€¢ æ£€æŸ¥å±æ€§åæ˜¯å¦ä¸€è‡´
â€¢ æ£€æŸ¥æ˜¯å¦æ­£ç¡®è½¬å‘
â€¢ æ£€æŸ¥ELè¡¨è¾¾å¼è¯­æ³•

é¡µé¢æ˜¾ç¤ºå¼‚å¸¸ï¼š
â€¢ æ£€æŸ¥JSTLæ ‡ç­¾åº“å¯¼å…¥
â€¢ æ£€æŸ¥é›†åˆæ˜¯å¦ä¸ºç©º
â€¢ ä½¿ç”¨c:chooseå¤„ç†ç©ºæ•°æ®

ä¸­æ–‡ä¹±ç é—®é¢˜ï¼š
â€¢ è®¾ç½®è¯·æ±‚ç¼–ç ï¼šreq.setCharacterEncoding("UTF-8")
â€¢ è®¾ç½®é¡µé¢ç¼–ç ï¼š<%@ page contentType="text/html;charset=UTF-8" %>
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- Servletåšå¤§å¨ï¼ŒJSPå½“æœåŠ¡å‘˜
- æ•°æ®æ”¾è¯·æ±‚åŸŸï¼ŒELè¡¨è¾¾å¼æ¥å–
- JSTLæ ‡ç­¾æ§åˆ¶æµï¼Œè½¬å‘é‡å®šå‘è¦åˆ†æ¸…
- å„å¸å…¶èŒåˆ†å·¥æ˜ï¼Œç»´æŠ¤å¼€å‘éƒ½è½»æ¾