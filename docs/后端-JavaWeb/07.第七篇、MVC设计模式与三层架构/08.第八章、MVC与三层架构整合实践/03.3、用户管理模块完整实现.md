---
title: 3ã€ç”¨æˆ·ç®¡ç†æ¨¡å—å®Œæ•´å®ç°
---
## ğŸ“š ç›®å½•

1. [ç”¨æˆ·ç®¡ç†æ¨¡å—æ¦‚è¿°](#1-ç”¨æˆ·ç®¡ç†æ¨¡å—æ¦‚è¿°)
2. [ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½å®ç°](#2-ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½å®ç°)
3. [ç”¨æˆ·ç™»å½•éªŒè¯æœºåˆ¶](#3-ç”¨æˆ·ç™»å½•éªŒè¯æœºåˆ¶)
4. [ä¿¡æ¯ä¿®æ”¹æ›´æ–°åŠŸèƒ½](#4-ä¿¡æ¯ä¿®æ”¹æ›´æ–°åŠŸèƒ½)
5. [æ•°æ®éªŒè¯æœºåˆ¶](#5-æ•°æ®éªŒè¯æœºåˆ¶)
6. [ä¼šè¯ç®¡ç†è¯¦è§£](#6-ä¼šè¯ç®¡ç†è¯¦è§£)
7. [æƒé™æ§åˆ¶ç³»ç»Ÿ](#7-æƒé™æ§åˆ¶ç³»ç»Ÿ)
8. [å®Œæ•´é¡¹ç›®æ•´åˆ](#8-å®Œæ•´é¡¹ç›®æ•´åˆ)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ‘¥ ç”¨æˆ·ç®¡ç†æ¨¡å—æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯ç”¨æˆ·ç®¡ç†æ¨¡å—


> ğŸ“Œ **æ ¸å¿ƒæ¦‚å¿µ**  
> ç”¨æˆ·ç®¡ç†æ¨¡å—å°±åƒä¸€ä¸ª"æ•°å­—èº«ä»½è¯ç®¡ç†ç³»ç»Ÿ"ï¼Œè´Ÿè´£ç”¨æˆ·çš„æ³¨å†Œã€ç™»å½•ã€ä¿¡æ¯ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ï¼Œæ˜¯å‡ ä¹æ‰€æœ‰Webåº”ç”¨çš„å¿…å¤‡ç»„ä»¶

**é€šä¿—ç†è§£**ï¼š
```
ç”Ÿæ´»ä¸­çš„ç±»æ¯”ï¼š
é…’åº—å‰å°ç³»ç»Ÿ â†’ ç”¨æˆ·ç®¡ç†æ¨¡å—
â”œâ”€â”€ å®¢æˆ·ç™»è®°å…¥ä½ â†’ ç”¨æˆ·æ³¨å†Œ
â”œâ”€â”€ éªŒè¯èº«ä»½ä¿¡æ¯ â†’ ç™»å½•éªŒè¯  
â”œâ”€â”€ æ›´æ–°å®¢æˆ·èµ„æ–™ â†’ ä¿¡æ¯ä¿®æ”¹
â”œâ”€â”€ ç®¡ç†æˆ¿é—´æƒé™ â†’ æƒé™æ§åˆ¶
â””â”€â”€ è·Ÿè¸ªå…¥ä½çŠ¶æ€ â†’ ä¼šè¯ç®¡ç†
```

### 1.2 ç”¨æˆ·ç®¡ç†çš„æ ¸å¿ƒåŠŸèƒ½


**ğŸ”¸ å…­å¤§æ ¸å¿ƒåŠŸèƒ½**ï¼š

| åŠŸèƒ½æ¨¡å— | **ä½œç”¨è¯´æ˜** | **ç”Ÿæ´»ç±»æ¯”** | **æŠ€æœ¯è¦ç‚¹** |
|---------|------------|-------------|-------------|
| ğŸ†” **ç”¨æˆ·æ³¨å†Œ** | æ–°ç”¨æˆ·åˆ›å»ºè´¦å· | åŠç†é“¶è¡Œå¡ | æ•°æ®éªŒè¯ã€å¯†ç åŠ å¯† |
| ğŸ” **ç™»å½•éªŒè¯** | éªŒè¯ç”¨æˆ·èº«ä»½ | åˆ·å¡è¿›é—¨ | å¯†ç æ ¡éªŒã€çŠ¶æ€ç®¡ç† |
| âœï¸ **ä¿¡æ¯ä¿®æ”¹** | æ›´æ–°ä¸ªäººèµ„æ–™ | ä¿®æ”¹è”ç³»æ–¹å¼ | æ•°æ®æ›´æ–°ã€æƒé™æ£€æŸ¥ |
| âœ… **æ•°æ®éªŒè¯** | ç¡®ä¿ä¿¡æ¯æ­£ç¡® | èº«ä»½è¯æ ¼å¼æ£€æŸ¥ | å‰åç«¯æ ¡éªŒã€è§„åˆ™å¼•æ“ |
| ğŸ• **ä¼šè¯ç®¡ç†** | è·Ÿè¸ªç™»å½•çŠ¶æ€ | ä¿æŒç™»å½•çŠ¶æ€ | Sessionã€Cookieç®¡ç† |
| ğŸ›¡ï¸ **æƒé™æ§åˆ¶** | æ§åˆ¶è®¿é—®æƒé™ | VIPä¼šå‘˜ç‰¹æƒ | è§’è‰²ç®¡ç†ã€è®¿é—®æ§åˆ¶ |

### 1.3 MVCæ¶æ„åœ¨ç”¨æˆ·ç®¡ç†ä¸­çš„ä½“ç°


```
ç”¨æˆ·ç®¡ç†ç³»ç»Ÿæ¶æ„å›¾ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           å‰ç«¯é¡µé¢ (View)         â”‚
â”‚  ç™»å½•é¡µé¢ | æ³¨å†Œé¡µé¢ | ä¸ªäººä¸­å¿ƒ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ HTTPè¯·æ±‚/å“åº”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        æ§åˆ¶å™¨å±‚ (Controller)      â”‚
â”‚  UserController | LoginControllerâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ ä¸šåŠ¡è°ƒç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ä¸šåŠ¡å±‚ (Service)         â”‚
â”‚  UserService | AuthService      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ æ•°æ®è®¿é—®
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ•°æ®å±‚ (DAO)            â”‚
â”‚  UserDAO | æ•°æ®åº“æ“ä½œ           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ğŸ“ ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½å®ç°


### 2.1 æ³¨å†Œæµç¨‹è®¾è®¡


**ğŸ”„ å®Œæ•´æ³¨å†Œæµç¨‹**ï¼š
```
ç”¨æˆ·æ³¨å†Œæµç¨‹å›¾ï¼š
ç”¨æˆ· â†’ å¡«å†™æ³¨å†Œè¡¨å• â†’ å‰ç«¯éªŒè¯ â†’ æäº¤åˆ°åå° â†’ åç«¯éªŒè¯ â†’ ä¿å­˜æ•°æ®åº“ â†’ è¿”å›ç»“æœ

è¯¦ç»†æ­¥éª¤ï¼š
[1] ç”¨æˆ·è®¿é—®æ³¨å†Œé¡µé¢
[2] å¡«å†™ï¼šç”¨æˆ·åã€å¯†ç ã€é‚®ç®±ã€æ‰‹æœºå·
[3] å‰ç«¯JSéªŒè¯æ ¼å¼
[4] æäº¤è¡¨å•åˆ°RegisterController  
[5] åç«¯éªŒè¯æ•°æ®åˆæ³•æ€§
[6] æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
[7] å¯†ç åŠ å¯†å¤„ç†
[8] å­˜å‚¨åˆ°æ•°æ®åº“
[9] è¿”å›æ³¨å†Œç»“æœ
```

### 2.2 æ•°æ®åº“è®¾è®¡


**ç”¨æˆ·è¡¨ç»“æ„è®¾è®¡**ï¼š
```sql
-- ç”¨æˆ·åŸºç¡€ä¿¡æ¯è¡¨
CREATE TABLE user (
    id INT PRIMARY KEY AUTO_INCREMENT,    -- ç”¨æˆ·IDï¼ˆä¸»é”®ï¼‰
    username VARCHAR(50) UNIQUE NOT NULL, -- ç”¨æˆ·åï¼ˆå”¯ä¸€ï¼‰
    password VARCHAR(255) NOT NULL,       -- å¯†ç ï¼ˆåŠ å¯†åï¼‰
    email VARCHAR(100) UNIQUE,            -- é‚®ç®±ï¼ˆå¯é€‰ï¼‰
    phone VARCHAR(20),                    -- æ‰‹æœºå·
    real_name VARCHAR(50),                -- çœŸå®å§“å
    status TINYINT DEFAULT 1,             -- çŠ¶æ€ï¼š1-æ­£å¸¸ï¼Œ0-ç¦ç”¨
    create_time DATETIME DEFAULT NOW(),   -- åˆ›å»ºæ—¶é—´
    update_time DATETIME DEFAULT NOW()    -- æ›´æ–°æ—¶é—´
);
```

> ğŸ’¡ **è®¾è®¡è¦ç‚¹è¯´æ˜**  
> - `id`ä½¿ç”¨è‡ªå¢ä¸»é”®ï¼Œç¡®ä¿å”¯ä¸€æ€§
> - `username`å’Œ`email`è®¾ç½®UNIQUEçº¦æŸï¼Œé˜²æ­¢é‡å¤
> - `password`ä½¿ç”¨VARCHAR(255)å­˜å‚¨åŠ å¯†åçš„å¯†ç 
> - `status`å­—æ®µæ–¹ä¾¿åæœŸåšç”¨æˆ·ç¦ç”¨åŠŸèƒ½

### 2.3 å®ä½“ç±»è®¾è®¡


```java
// ç”¨æˆ·å®ä½“ç±»
public class User {
    private Integer id;
    private String username;
    private String password;
    private String email;
    private String phone;
    private String realName;
    private Integer status;
    private Date createTime;
    private Date updateTime;
    
    // æ„é€ æ–¹æ³•
    public User() {}
    
    public User(String username, String password) {
        this.username = username;
        this.password = password;
        this.status = 1;  // é»˜è®¤æ­£å¸¸çŠ¶æ€
    }
    
    // getterå’Œsetteræ–¹æ³•ï¼ˆçœç•¥å…·ä½“å®ç°ï¼‰
    // toStringæ–¹æ³•ï¼ˆçœç•¥ï¼‰
}
```

### 2.4 æ³¨å†ŒåŠŸèƒ½æ ¸å¿ƒå®ç°


**ğŸ”¸ æ§åˆ¶å™¨å±‚å®ç°**ï¼š
```java
@WebServlet("/register")
public class RegisterController extends HttpServlet {
    
    private UserService userService = new UserService();
    
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // 1. è·å–å‰ç«¯æ•°æ®
        String username = request.getParameter("username");
        String password = request.getParameter("password");
        String email = request.getParameter("email");
        String phone = request.getParameter("phone");
        
        try {
            // 2. åˆ›å»ºç”¨æˆ·å¯¹è±¡
            User user = new User();
            user.setUsername(username);
            user.setPassword(password);
            user.setEmail(email);
            user.setPhone(phone);
            
            // 3. è°ƒç”¨ä¸šåŠ¡å±‚æ³¨å†Œ
            boolean success = userService.register(user);
            
            if (success) {
                response.getWriter().write("{\"code\":200,\"message\":\"æ³¨å†ŒæˆåŠŸ\"}");
            } else {
                response.getWriter().write("{\"code\":400,\"message\":\"æ³¨å†Œå¤±è´¥\"}");
            }
            
        } catch (Exception e) {
            response.getWriter().write("{\"code\":500,\"message\":\"ç³»ç»Ÿé”™è¯¯\"}");
        }
    }
}
```

**ğŸ”¸ ä¸šåŠ¡å±‚å®ç°**ï¼š
```java
public class UserService {
    
    private UserDAO userDAO = new UserDAO();
    
    public boolean register(User user) {
        // 1. éªŒè¯ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
        if (userDAO.findByUsername(user.getUsername()) != null) {
            throw new RuntimeException("ç”¨æˆ·åå·²å­˜åœ¨");
        }
        
        // 2. å¯†ç åŠ å¯†å¤„ç†
        String encryptedPassword = MD5Utils.encrypt(user.getPassword());
        user.setPassword(encryptedPassword);
        
        // 3. ä¿å­˜åˆ°æ•°æ®åº“
        return userDAO.save(user) > 0;
    }
}
```

> âš ï¸ **å®‰å…¨æ³¨æ„**  
> å¯†ç ç»ä¸èƒ½æ˜æ–‡å­˜å‚¨ï¼å¿…é¡»å…ˆåŠ å¯†å†ä¿å­˜åˆ°æ•°æ®åº“

---

## 3. ğŸ” ç”¨æˆ·ç™»å½•éªŒè¯æœºåˆ¶


### 3.1 ç™»å½•éªŒè¯æµç¨‹


**ç™»å½•éªŒè¯çš„æ ¸å¿ƒé€»è¾‘**ï¼š
```
ç™»å½•éªŒè¯æµç¨‹ï¼š
ç”¨æˆ·è¾“å…¥è´¦å·å¯†ç  â†’ å‰ç«¯åŸºç¡€éªŒè¯ â†’ åç«¯éªŒè¯ â†’ æ•°æ®åº“æŸ¥è¯¢ â†’ å¯†ç æ¯”è¾ƒ â†’ åˆ›å»ºä¼šè¯

å…·ä½“æ­¥éª¤ï¼š
[1] ç”¨æˆ·åœ¨ç™»å½•é¡µé¢è¾“å…¥ç”¨æˆ·åå’Œå¯†ç 
[2] å‰ç«¯éªŒè¯ï¼šéç©ºæ£€æŸ¥ã€æ ¼å¼éªŒè¯
[3] æäº¤åˆ°LoginController
[4] åç«¯æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢æ•°æ®åº“
[5] å°†è¾“å…¥å¯†ç åŠ å¯†åä¸æ•°æ®åº“å¯†ç å¯¹æ¯”
[6] éªŒè¯æˆåŠŸï¼šåˆ›å»ºSessionï¼Œè·³è½¬åˆ°ä¸»é¡µ
[7] éªŒè¯å¤±è´¥ï¼šè¿”å›é”™è¯¯ä¿¡æ¯
```

### 3.2 ç™»å½•æ§åˆ¶å™¨å®ç°


```java
@WebServlet("/login")
public class LoginController extends HttpServlet {
    
    private UserService userService = new UserService();
    
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        // 1. è·å–ç™»å½•å‚æ•°
        String username = request.getParameter("username");
        String password = request.getParameter("password");
        
        try {
            // 2. è°ƒç”¨ä¸šåŠ¡å±‚éªŒè¯
            User user = userService.login(username, password);
            
            if (user != null) {
                // 3. ç™»å½•æˆåŠŸ - åˆ›å»ºä¼šè¯
                HttpSession session = request.getSession();
                session.setAttribute("user", user);
                session.setMaxInactiveInterval(30 * 60); // 30åˆ†é’Ÿè¶…æ—¶
                
                response.sendRedirect("index.jsp");
            } else {
                // 4. ç™»å½•å¤±è´¥
                request.setAttribute("error", "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯");
                request.getRequestDispatcher("login.jsp").forward(request, response);
            }
            
        } catch (Exception e) {
            request.setAttribute("error", "ç™»å½•è¿‡ç¨‹å‘ç”Ÿé”™è¯¯");
            request.getRequestDispatcher("login.jsp").forward(request, response);
        }
    }
}
```

### 3.3 ç™»å½•ä¸šåŠ¡é€»è¾‘


```java
public class UserService {
    
    private UserDAO userDAO = new UserDAO();
    
    public User login(String username, String password) {
        // 1. æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ç”¨æˆ·
        User user = userDAO.findByUsername(username);
        
        if (user == null) {
            return null; // ç”¨æˆ·ä¸å­˜åœ¨
        }
        
        // 2. éªŒè¯ç”¨æˆ·çŠ¶æ€
        if (user.getStatus() != 1) {
            throw new RuntimeException("è´¦å·å·²è¢«ç¦ç”¨");
        }
        
        // 3. éªŒè¯å¯†ç 
        String encryptedPassword = MD5Utils.encrypt(password);
        if (encryptedPassword.equals(user.getPassword())) {
            return user; // ç™»å½•æˆåŠŸ
        }
        
        return null; // å¯†ç é”™è¯¯
    }
}
```

### 3.4 è®°ä½ç™»å½•çŠ¶æ€


**ä½¿ç”¨Cookieå®ç°"è®°ä½æˆ‘"åŠŸèƒ½**ï¼š
```java
// åœ¨LoginControllerä¸­æ·»åŠ 
String remember = request.getParameter("remember");

if ("true".equals(remember)) {
    // åˆ›å»ºCookieä¿å­˜ç”¨æˆ·åï¼ˆæ³¨æ„ï¼šä¸è¦ä¿å­˜å¯†ç ï¼‰
    Cookie usernameCookie = new Cookie("rememberedUser", username);
    usernameCookie.setMaxAge(7 * 24 * 60 * 60); // 7å¤©æœ‰æ•ˆ
    usernameCookie.setPath("/");
    response.addCookie(usernameCookie);
}
```

> ğŸ“Œ **å®‰å…¨æé†’**  
> Cookieä¸­ç»ä¸èƒ½å­˜å‚¨å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ï¼Œåªèƒ½å­˜å‚¨ç”¨æˆ·åç­‰å…¬å¼€ä¿¡æ¯

---

## 4. âœï¸ ä¿¡æ¯ä¿®æ”¹æ›´æ–°åŠŸèƒ½


### 4.1 ä¸ªäººä¿¡æ¯ä¿®æ”¹æµç¨‹


**ä¿¡æ¯ä¿®æ”¹çš„ä¸šåŠ¡æµç¨‹**ï¼š
```
ä¿¡æ¯ä¿®æ”¹æµç¨‹ï¼š
ç™»å½•çŠ¶æ€æ£€æŸ¥ â†’ åŠ è½½å½“å‰ä¿¡æ¯ â†’ ç”¨æˆ·ä¿®æ”¹ â†’ æ•°æ®éªŒè¯ â†’ æ›´æ–°æ•°æ®åº“ â†’ åˆ·æ–°Session

è¯¦ç»†è¯´æ˜ï¼š
[1] ç”¨æˆ·å¿…é¡»å…ˆç™»å½•ï¼ˆæƒé™æ£€æŸ¥ï¼‰
[2] æ˜¾ç¤ºå½“å‰ä¸ªäººä¿¡æ¯åœ¨è¡¨å•ä¸­
[3] ç”¨æˆ·ä¿®æ”¹éœ€è¦æ›´æ–°çš„å­—æ®µ
[4] å‰ç«¯éªŒè¯ä¿®æ”¹åçš„æ•°æ®æ ¼å¼
[5] åç«¯éªŒè¯æ•°æ®æœ‰æ•ˆæ€§å’Œå”¯ä¸€æ€§
[6] æ›´æ–°æ•°æ®åº“ä¸­çš„ç”¨æˆ·ä¿¡æ¯  
[7] åŒæ­¥æ›´æ–°Sessionä¸­çš„ç”¨æˆ·ä¿¡æ¯
[8] è¿”å›ä¿®æ”¹ç»“æœç»™å‰ç«¯
```

### 4.2 ä¿¡æ¯ä¿®æ”¹é¡µé¢è®¾è®¡


**å‰ç«¯é¡µé¢å…³é”®ä»£ç **ï¼š
```html
<!-- ä¸ªäººä¿¡æ¯ä¿®æ”¹è¡¨å• -->
<form action="updateProfile" method="post" id="profileForm">
    <div class="form-group">
        <label>ç”¨æˆ·åï¼š</label>
        <input type="text" name="username" value="${user.username}" readonly>
        <small>ç”¨æˆ·åä¸èƒ½ä¿®æ”¹</small>
    </div>
    
    <div class="form-group">
        <label>çœŸå®å§“åï¼š</label>
        <input type="text" name="realName" value="${user.realName}">
    </div>
    
    <div class="form-group">
        <label>é‚®ç®±ï¼š</label>
        <input type="email" name="email" value="${user.email}">
    </div>
    
    <div class="form-group">
        <label>æ‰‹æœºå·ï¼š</label>
        <input type="text" name="phone" value="${user.phone}">
    </div>
    
    <button type="submit">ä¿å­˜ä¿®æ”¹</button>
</form>
```

### 4.3 ä¿¡æ¯ä¿®æ”¹æ§åˆ¶å™¨


```java
@WebServlet("/updateProfile")
public class UpdateProfileController extends HttpServlet {
    
    private UserService userService = new UserService();
    
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        // 1. æ£€æŸ¥ç™»å½•çŠ¶æ€
        HttpSession session = request.getSession();
        User currentUser = (User) session.getAttribute("user");
        
        if (currentUser == null) {
            response.sendRedirect("login.jsp");
            return;
        }
        
        // 2. è·å–ä¿®æ”¹çš„æ•°æ®
        String realName = request.getParameter("realName");
        String email = request.getParameter("email");
        String phone = request.getParameter("phone");
        
        try {
            // 3. æ›´æ–°ç”¨æˆ·ä¿¡æ¯
            currentUser.setRealName(realName);
            currentUser.setEmail(email);
            currentUser.setPhone(phone);
            
            boolean success = userService.updateProfile(currentUser);
            
            if (success) {
                // 4. æ›´æ–°Sessionä¸­çš„ç”¨æˆ·ä¿¡æ¯
                session.setAttribute("user", currentUser);
                request.setAttribute("message", "ä¿¡æ¯ä¿®æ”¹æˆåŠŸ");
            } else {
                request.setAttribute("error", "ä¿®æ”¹å¤±è´¥ï¼Œè¯·é‡è¯•");
            }
            
        } catch (Exception e) {
            request.setAttribute("error", "ä¿®æ”¹è¿‡ç¨‹å‘ç”Ÿé”™è¯¯ï¼š" + e.getMessage());
        }
        
        request.getRequestDispatcher("profile.jsp").forward(request, response);
    }
}
```

### 4.4 å¯†ç ä¿®æ”¹åŠŸèƒ½


**å•ç‹¬çš„å¯†ç ä¿®æ”¹é€»è¾‘**ï¼š
```java
@WebServlet("/changePassword")
public class ChangePasswordController extends HttpServlet {
    
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        HttpSession session = request.getSession();
        User user = (User) session.getAttribute("user");
        
        String oldPassword = request.getParameter("oldPassword");
        String newPassword = request.getParameter("newPassword");
        String confirmPassword = request.getParameter("confirmPassword");
        
        try {
            // 1. éªŒè¯åŸå¯†ç æ˜¯å¦æ­£ç¡®
            String encryptedOldPassword = MD5Utils.encrypt(oldPassword);
            if (!encryptedOldPassword.equals(user.getPassword())) {
                request.setAttribute("error", "åŸå¯†ç è¾“å…¥é”™è¯¯");
                request.getRequestDispatcher("changePassword.jsp").forward(request, response);
                return;
            }
            
            // 2. éªŒè¯æ–°å¯†ç ç¡®è®¤
            if (!newPassword.equals(confirmPassword)) {
                request.setAttribute("error", "ä¸¤æ¬¡è¾“å…¥çš„æ–°å¯†ç ä¸ä¸€è‡´");
                request.getRequestDispatcher("changePassword.jsp").forward(request, response);
                return;
            }
            
            // 3. æ›´æ–°å¯†ç 
            boolean success = userService.changePassword(user.getId(), newPassword);
            
            if (success) {
                request.setAttribute("message", "å¯†ç ä¿®æ”¹æˆåŠŸï¼Œè¯·é‡æ–°ç™»å½•");
                session.invalidate(); // æ¸…é™¤Sessionï¼Œè¦æ±‚é‡æ–°ç™»å½•
            }
            
        } catch (Exception e) {
            request.setAttribute("error", "å¯†ç ä¿®æ”¹å¤±è´¥");
        }
        
        request.getRequestDispatcher("changePassword.jsp").forward(request, response);
    }
}
```

---

## 5. âœ… æ•°æ®éªŒè¯æœºåˆ¶


### 5.1 æ•°æ®éªŒè¯çš„é‡è¦æ€§


> ğŸ“Œ **ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®éªŒè¯**  
> æ•°æ®éªŒè¯å°±åƒ"é£Ÿå“å®‰å…¨æ£€æŸ¥"ï¼Œç¡®ä¿è¿›å…¥ç³»ç»Ÿçš„æ•°æ®æ˜¯å®‰å…¨ã€æ­£ç¡®ã€å®Œæ•´çš„ï¼Œé˜²æ­¢æ¶æ„æ•°æ®ç ´åç³»ç»Ÿ

**æ•°æ®éªŒè¯çš„åŒé‡ä¿æŠ¤**ï¼š
```
å‰ç«¯éªŒè¯ + åç«¯éªŒè¯ = å®Œæ•´ä¿æŠ¤

å‰ç«¯éªŒè¯ï¼ˆç¬¬ä¸€é“é˜²çº¿ï¼‰ï¼š
â”œâ”€â”€ æå‡ç”¨æˆ·ä½“éªŒï¼ˆå³æ—¶åé¦ˆï¼‰
â”œâ”€â”€ å‡å°‘æœåŠ¡å™¨å‹åŠ›
â””â”€â”€ åŸºç¡€æ ¼å¼æ£€æŸ¥

åç«¯éªŒè¯ï¼ˆæ ¸å¿ƒé˜²çº¿ï¼‰ï¼š
â”œâ”€â”€ å®‰å…¨æ€§ä¿éšœï¼ˆä¸å¯ç»•è¿‡ï¼‰
â”œâ”€â”€ ä¸šåŠ¡è§„åˆ™éªŒè¯
â””â”€â”€ æ•°æ®å®Œæ•´æ€§æ£€æŸ¥
```

### 5.2 å‰ç«¯éªŒè¯å®ç°


**JavaScriptè¡¨å•éªŒè¯**ï¼š
```javascript
// æ³¨å†Œè¡¨å•éªŒè¯
function validateRegisterForm() {
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    const email = document.getElementById('email').value;
    
    // ç”¨æˆ·åéªŒè¯
    if (username.length < 3 || username.length > 20) {
        showError('ç”¨æˆ·åé•¿åº¦å¿…é¡»åœ¨3-20ä¸ªå­—ç¬¦ä¹‹é—´');
        return false;
    }
    
    // å¯†ç å¼ºåº¦éªŒè¯
    if (password.length < 6) {
        showError('å¯†ç é•¿åº¦è‡³å°‘6ä½');
        return false;
    }
    
    // é‚®ç®±æ ¼å¼éªŒè¯
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (email && !emailRegex.test(email)) {
        showError('é‚®ç®±æ ¼å¼ä¸æ­£ç¡®');
        return false;
    }
    
    return true;
}

function showError(message) {
    const errorDiv = document.getElementById('error-message');
    errorDiv.innerHTML = message;
    errorDiv.style.display = 'block';
}
```

### 5.3 åç«¯éªŒè¯å·¥å…·ç±»


**é€šç”¨éªŒè¯å·¥å…·ç±»**ï¼š
```java
public class ValidationUtils {
    
    // éªŒè¯ç”¨æˆ·åæ ¼å¼
    public static boolean isValidUsername(String username) {
        if (username == null || username.trim().isEmpty()) {
            return false;
        }
        
        // é•¿åº¦æ£€æŸ¥ï¼š3-20ä½
        if (username.length() < 3 || username.length() > 20) {
            return false;
        }
        
        // åªå…è®¸å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿
        return username.matches("^[a-zA-Z0-9_]+$");
    }
    
    // éªŒè¯é‚®ç®±æ ¼å¼
    public static boolean isValidEmail(String email) {
        if (email == null || email.trim().isEmpty()) {
            return true; // é‚®ç®±ä¸ºå¯é€‰é¡¹
        }
        
        String emailRegex = "^[A-Za-z0-9+_.-]+@([A-Za-z0-9.-]+\\.[A-Za-z]{2,})$";
        return email.matches(emailRegex);
    }
    
    // éªŒè¯æ‰‹æœºå·æ ¼å¼ï¼ˆç®€å•éªŒè¯ï¼‰
    public static boolean isValidPhone(String phone) {
        if (phone == null || phone.trim().isEmpty()) {
            return true; // æ‰‹æœºå·ä¸ºå¯é€‰é¡¹
        }
        
        return phone.matches("^1[3-9]\\d{9}$"); // 11ä½æ‰‹æœºå·
    }
    
    // éªŒè¯å¯†ç å¼ºåº¦
    public static boolean isValidPassword(String password) {
        if (password == null) return false;
        
        // æœ€å°‘6ä½ï¼ŒåŒ…å«å­—æ¯å’Œæ•°å­—
        return password.length() >= 6 && 
               password.matches(".*[a-zA-Z].*") && 
               password.matches(".*\\d.*");
    }
}
```

### 5.4 ä¸šåŠ¡å±‚éªŒè¯å¢å¼º


**åœ¨UserServiceä¸­åŠ å…¥éªŒè¯**ï¼š
```java
public class UserService {
    
    public boolean register(User user) {
        // 1. åŸºç¡€æ•°æ®éªŒè¯
        validateUserData(user);
        
        // 2. ä¸šåŠ¡è§„åˆ™éªŒè¯
        if (userDAO.findByUsername(user.getUsername()) != null) {
            throw new BusinessException("ç”¨æˆ·åå·²å­˜åœ¨");
        }
        
        if (user.getEmail() != null && userDAO.findByEmail(user.getEmail()) != null) {
            throw new BusinessException("é‚®ç®±å·²è¢«æ³¨å†Œ");
        }
        
        // 3. æ•°æ®å¤„ç†å’Œä¿å­˜
        user.setPassword(MD5Utils.encrypt(user.getPassword()));
        return userDAO.save(user) > 0;
    }
    
    private void validateUserData(User user) {
        if (!ValidationUtils.isValidUsername(user.getUsername())) {
            throw new ValidationException("ç”¨æˆ·åæ ¼å¼ä¸æ­£ç¡®");
        }
        
        if (!ValidationUtils.isValidPassword(user.getPassword())) {
            throw new ValidationException("å¯†ç å¼ºåº¦ä¸å¤Ÿ");
        }
        
        if (!ValidationUtils.isValidEmail(user.getEmail())) {
            throw new ValidationException("é‚®ç®±æ ¼å¼ä¸æ­£ç¡®");
        }
        
        if (!ValidationUtils.isValidPhone(user.getPhone())) {
            throw new ValidationException("æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®");
        }
    }
}
```

---

## 6. ğŸ• ä¼šè¯ç®¡ç†è¯¦è§£


### 6.1 ä»€ä¹ˆæ˜¯ä¼šè¯ç®¡ç†


> ğŸ“Œ **ä¼šè¯ç®¡ç†æ¦‚å¿µ**  
> ä¼šè¯ç®¡ç†å°±åƒ"å›¾ä¹¦é¦†çš„å€Ÿä¹¦å¡ç³»ç»Ÿ"ï¼Œå¸®åŠ©æœåŠ¡å™¨è®°ä½æ¯ä¸ªç”¨æˆ·çš„èº«ä»½å’ŒçŠ¶æ€ï¼Œè®©ç”¨æˆ·åœ¨ç½‘ç«™ä¸Š"ä¿æŒç™»å½•"

**ä¼šè¯çš„ç”Ÿå‘½å‘¨æœŸ**ï¼š
```
ä¼šè¯ç”Ÿå‘½å‘¨æœŸï¼š
ç”¨æˆ·è®¿é—®ç½‘ç«™ â†’ åˆ›å»ºä¼šè¯ â†’ ä¿æŒçŠ¶æ€ â†’ ç”¨æˆ·æ´»åŠ¨ â†’ ä¼šè¯è¿‡æœŸ/æ³¨é”€ â†’ é”€æ¯ä¼šè¯

æŠ€æœ¯å®ç°ï¼š
æµè§ˆå™¨ â†â†’ SessionID(Cookie) â†â†’ æœåŠ¡å™¨Sessionå­˜å‚¨
         â†‘                    â†‘
      ç”¨æˆ·çŠ¶æ€è·Ÿè¸ª          æœåŠ¡å™¨ç«¯æ•°æ®å­˜å‚¨
```

### 6.2 SessionåŸºç¡€æ“ä½œ


**Sessionçš„åŸºæœ¬ä½¿ç”¨**ï¼š
```java
// åœ¨æ§åˆ¶å™¨ä¸­æ“ä½œSession
public class SessionController extends HttpServlet {
    
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        // 1. è·å–Sessionï¼ˆå¦‚æœä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»ºï¼‰
        HttpSession session = request.getSession();
        
        // 2. å­˜å‚¨ç”¨æˆ·ä¿¡æ¯åˆ°Session
        User user = new User("å¼ ä¸‰", "admin");
        session.setAttribute("user", user);
        session.setAttribute("loginTime", new Date());
        
        // 3. è®¾ç½®Sessionè¶…æ—¶æ—¶é—´ï¼ˆç§’ä¸ºå•ä½ï¼‰
        session.setMaxInactiveInterval(30 * 60); // 30åˆ†é’Ÿ
        
        // 4. ä»Sessionä¸­è·å–æ•°æ®
        User currentUser = (User) session.getAttribute("user");
        
        // 5. ç§»é™¤Sessionä¸­çš„ç‰¹å®šå±æ€§
        session.removeAttribute("tempData");
        
        // 6. é”€æ¯æ•´ä¸ªSessionï¼ˆé€€å‡ºç™»å½•ï¼‰
        // session.invalidate();
    }
}
```

### 6.3 ç™»å½•çŠ¶æ€æ£€æŸ¥è¿‡æ»¤å™¨


**ç»Ÿä¸€çš„ç™»å½•æ£€æŸ¥æœºåˆ¶**ï¼š
```java
@WebFilter("/*") // æ‹¦æˆªæ‰€æœ‰è¯·æ±‚
public class LoginCheckFilter implements Filter {
    
    // ä¸éœ€è¦ç™»å½•å°±èƒ½è®¿é—®çš„é¡µé¢
    private String[] excludeUrls = {
        "/login.jsp", "/register.jsp", "/login", "/register",
        "/css/", "/js/", "/images/", "/index.jsp"
    };
    
    public void doFilter(ServletRequest req, ServletResponse resp, 
                        FilterChain chain) throws IOException, ServletException {
        
        HttpServletRequest request = (HttpServletRequest) req;
        HttpServletResponse response = (HttpServletResponse) resp;
        
        String requestURI = request.getRequestURI();
        
        // 1. æ£€æŸ¥æ˜¯å¦æ˜¯éœ€è¦è·³è¿‡çš„URL
        if (shouldSkip(requestURI)) {
            chain.doFilter(request, response);
            return;
        }
        
        // 2. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
        HttpSession session = request.getSession(false);
        User user = null;
        
        if (session != null) {
            user = (User) session.getAttribute("user");
        }
        
        if (user != null) {
            // å·²ç™»å½•ï¼Œç»§ç»­å¤„ç†
            chain.doFilter(request, response);
        } else {
            // æœªç™»å½•ï¼Œé‡å®šå‘åˆ°ç™»å½•é¡µé¢
            response.sendRedirect(request.getContextPath() + "/login.jsp");
        }
    }
    
    private boolean shouldSkip(String uri) {
        for (String excludeUrl : excludeUrls) {
            if (uri.contains(excludeUrl)) {
                return true;
            }
        }
        return false;
    }
}
```

### 6.4 é€€å‡ºç™»å½•åŠŸèƒ½


**å®‰å…¨çš„é€€å‡ºç™»å½•å®ç°**ï¼š
```java
@WebServlet("/logout")
public class LogoutController extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        // 1. è·å–å½“å‰Session
        HttpSession session = request.getSession(false);
        
        if (session != null) {
            // 2. è®°å½•é€€å‡ºæ—¥å¿—ï¼ˆå¯é€‰ï¼‰
            User user = (User) session.getAttribute("user");
            if (user != null) {
                System.out.println("ç”¨æˆ· " + user.getUsername() + " é€€å‡ºç™»å½•");
            }
            
            // 3. é”€æ¯Session
            session.invalidate();
        }
        
        // 4. æ¸…é™¤"è®°ä½æˆ‘"Cookie
        Cookie cookie = new Cookie("rememberedUser", "");
        cookie.setMaxAge(0); // ç«‹å³è¿‡æœŸ
        cookie.setPath("/");
        response.addCookie(cookie);
        
        // 5. é‡å®šå‘åˆ°é¦–é¡µæˆ–ç™»å½•é¡µ
        response.sendRedirect("index.jsp");
    }
}
```

---

## 7. ğŸ›¡ï¸ æƒé™æ§åˆ¶ç³»ç»Ÿ


### 7.1 æƒé™æ§åˆ¶æ¦‚å¿µ


> ğŸ“Œ **æƒé™æ§åˆ¶ç†è§£**  
> æƒé™æ§åˆ¶å°±åƒ"å…¬å¸é—¨ç¦ç³»ç»Ÿ"ï¼Œä¸åŒçº§åˆ«çš„å‘˜å·¥èƒ½è¿›å…¥ä¸åŒçš„åŠå…¬åŒºåŸŸï¼Œç¡®ä¿ç³»ç»Ÿèµ„æºçš„å®‰å…¨è®¿é—®

**æƒé™æ§åˆ¶æ¨¡å‹**ï¼š
```
RBACæƒé™æ¨¡å‹ï¼ˆåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼‰ï¼š
ç”¨æˆ·(User) â†’ è§’è‰²(Role) â†’ æƒé™(Permission) â†’ èµ„æº(Resource)

ç¤ºä¾‹ï¼š
å¼ ä¸‰(ç”¨æˆ·) â†’ ç®¡ç†å‘˜(è§’è‰²) â†’ ç”¨æˆ·ç®¡ç†æƒé™ â†’ å¯ä»¥å¢åˆ æ”¹æŸ¥ç”¨æˆ·
æå››(ç”¨æˆ·) â†’ æ™®é€šç”¨æˆ·(è§’è‰²) â†’ æŸ¥çœ‹æƒé™ â†’ åªèƒ½æŸ¥çœ‹è‡ªå·±çš„ä¿¡æ¯
```

### 7.2 æƒé™è¡¨è®¾è®¡


**æƒé™ç›¸å…³æ•°æ®è¡¨**ï¼š
```sql
-- è§’è‰²è¡¨
CREATE TABLE role (
    id INT PRIMARY KEY AUTO_INCREMENT,
    role_name VARCHAR(50) NOT NULL,         -- è§’è‰²åç§°
    description VARCHAR(200),               -- è§’è‰²æè¿°
    create_time DATETIME DEFAULT NOW()
);

-- ç”¨æˆ·è§’è‰²å…³ç³»è¡¨
CREATE TABLE user_role (
    user_id INT,                           -- ç”¨æˆ·ID
    role_id INT,                           -- è§’è‰²ID
    PRIMARY KEY (user_id, role_id),
    FOREIGN KEY (user_id) REFERENCES user(id),
    FOREIGN KEY (role_id) REFERENCES role(id)
);

-- åˆå§‹åŒ–è§’è‰²æ•°æ®
INSERT INTO role (role_name, description) VALUES 
('admin', 'ç³»ç»Ÿç®¡ç†å‘˜'),
('user', 'æ™®é€šç”¨æˆ·'),
('guest', 'è®¿å®¢ç”¨æˆ·');
```

### 7.3 æƒé™æ£€æŸ¥å·¥å…·ç±»


**æƒé™éªŒè¯å·¥å…·ç±»**ï¼š
```java
public class PermissionUtils {
    
    private static UserRoleDAO userRoleDAO = new UserRoleDAO();
    
    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æŒ‡å®šè§’è‰²
    public static boolean hasRole(Integer userId, String roleName) {
        List<String> userRoles = userRoleDAO.findRolesByUserId(userId);
        return userRoles.contains(roleName);
    }
    
    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ˜¯ç®¡ç†å‘˜
    public static boolean isAdmin(User user) {
        return hasRole(user.getId(), "admin");
    }
    
    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å¯ä»¥è®¿é—®æŒ‡å®šèµ„æº
    public static boolean canAccess(User user, String resource) {
        // ç®¡ç†å‘˜å¯ä»¥è®¿é—®æ‰€æœ‰èµ„æº
        if (isAdmin(user)) {
            return true;
        }
        
        // æ ¹æ®å…·ä½“ä¸šåŠ¡è§„åˆ™åˆ¤æ–­
        switch (resource) {
            case "userManagement":
                return hasRole(user.getId(), "admin");
            case "profile":
                return true; // æ‰€æœ‰ç™»å½•ç”¨æˆ·éƒ½å¯ä»¥è®¿é—®ä¸ªäººèµ„æ–™
            default:
                return false;
        }
    }
}
```

### 7.4 æƒé™æ§åˆ¶è¿‡æ»¤å™¨


**åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶**ï¼š
```java
@WebFilter("/admin/*") // åªæ‹¦æˆªç®¡ç†å‘˜é¡µé¢
public class AdminPermissionFilter implements Filter {
    
    public void doFilter(ServletRequest req, ServletResponse resp, 
                        FilterChain chain) throws IOException, ServletException {
        
        HttpServletRequest request = (HttpServletRequest) req;
        HttpServletResponse response = (HttpServletResponse) resp;
        
        // 1. è·å–å½“å‰ç™»å½•ç”¨æˆ·
        HttpSession session = request.getSession(false);
        User user = null;
        
        if (session != null) {
            user = (User) session.getAttribute("user");
        }
        
        // 2. æ£€æŸ¥æ˜¯å¦å·²ç™»å½•
        if (user == null) {
            response.sendRedirect(request.getContextPath() + "/login.jsp");
            return;
        }
        
        // 3. æ£€æŸ¥æ˜¯å¦æœ‰ç®¡ç†å‘˜æƒé™
        if (!PermissionUtils.isAdmin(user)) {
            response.setStatus(HttpServletResponse.SC_FORBIDDEN);
            request.setAttribute("error", "è®¿é—®è¢«æ‹’ç»ï¼šæ‚¨æ²¡æœ‰ç®¡ç†å‘˜æƒé™");
            request.getRequestDispatcher("/error.jsp").forward(request, response);
            return;
        }
        
        // 4. æƒé™éªŒè¯é€šè¿‡ï¼Œç»§ç»­å¤„ç†
        chain.doFilter(request, response);
    }
}
```

### 7.5 é¡µé¢æƒé™æ§åˆ¶


**åœ¨JSPé¡µé¢ä¸­æ§åˆ¶æ˜¾ç¤ºå†…å®¹**ï¼š
```html
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>

<!-- å¼•å…¥æƒé™æ£€æŸ¥çš„è‡ªå®šä¹‰æ ‡ç­¾æˆ–åœ¨é¡µé¢ä¸­ç›´æ¥åˆ¤æ–­ -->
<div class="user-menu">
    <h3>ä¸ªäººä¸­å¿ƒ</h3>
    
    <!-- æ‰€æœ‰ç”¨æˆ·éƒ½èƒ½çœ‹åˆ°çš„é€‰é¡¹ -->
    <a href="profile.jsp">ä¸ªäººèµ„æ–™</a>
    <a href="changePassword.jsp">ä¿®æ”¹å¯†ç </a>
    
    <!-- åªæœ‰ç®¡ç†å‘˜èƒ½çœ‹åˆ°çš„é€‰é¡¹ -->
    <c:if test="${sessionScope.user.role == 'admin'}">
        <a href="admin/userList.jsp">ç”¨æˆ·ç®¡ç†</a>
        <a href="admin/systemConfig.jsp">ç³»ç»Ÿé…ç½®</a>
    </c:if>
</div>
```

---

## 8. ğŸ”„ å®Œæ•´é¡¹ç›®æ•´åˆ


### 8.1 é¡¹ç›®ç»“æ„ç»„ç»‡


**æ ‡å‡†çš„MVCé¡¹ç›®ç»“æ„**ï¼š
```
user-management-system/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ controller/          # æ§åˆ¶å™¨å±‚
â”‚   â”‚   â”œâ”€â”€ LoginController.java
â”‚   â”‚   â”œâ”€â”€ RegisterController.java
â”‚   â”‚   â”œâ”€â”€ UpdateProfileController.java
â”‚   â”‚   â””â”€â”€ LogoutController.java
â”‚   â”œâ”€â”€ service/            # ä¸šåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ UserService.java
â”‚   â”‚   â””â”€â”€ AuthService.java
â”‚   â”œâ”€â”€ dao/               # æ•°æ®è®¿é—®å±‚
â”‚   â”‚   â”œâ”€â”€ UserDAO.java
â”‚   â”‚   â””â”€â”€ UserRoleDAO.java
â”‚   â”œâ”€â”€ entity/            # å®ä½“ç±»
â”‚   â”‚   â”œâ”€â”€ User.java
â”‚   â”‚   â””â”€â”€ Role.java
â”‚   â”œâ”€â”€ filter/            # è¿‡æ»¤å™¨
â”‚   â”‚   â”œâ”€â”€ LoginCheckFilter.java
â”‚   â”‚   â””â”€â”€ AdminPermissionFilter.java
â”‚   â””â”€â”€ utils/             # å·¥å…·ç±»
â”‚       â”œâ”€â”€ MD5Utils.java
â”‚       â”œâ”€â”€ ValidationUtils.java
â”‚       â””â”€â”€ PermissionUtils.java
â”œâ”€â”€ web/
â”‚   â”œâ”€â”€ WEB-INF/
â”‚   â”‚   â””â”€â”€ web.xml
â”‚   â”œâ”€â”€ css/               # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ js/                # JavaScriptæ–‡ä»¶
â”‚   â”œâ”€â”€ index.jsp          # é¦–é¡µ
â”‚   â”œâ”€â”€ login.jsp          # ç™»å½•é¡µé¢
â”‚   â”œâ”€â”€ register.jsp       # æ³¨å†Œé¡µé¢
â”‚   â”œâ”€â”€ profile.jsp        # ä¸ªäººèµ„æ–™é¡µé¢
â”‚   â””â”€â”€ admin/             # ç®¡ç†å‘˜é¡µé¢ç›®å½•
â””â”€â”€ lib/                   # ä¾èµ–çš„jaråŒ…
```

### 8.2 å®Œæ•´çš„ç™»å½•æ³¨å†Œæµç¨‹


**ç”¨æˆ·æ“ä½œå®Œæ•´æµç¨‹å›¾**ï¼š
```
å®Œæ•´ç”¨æˆ·ç®¡ç†æµç¨‹ï¼š

æ–°ç”¨æˆ·æ³¨å†Œæµç¨‹ï¼š
è®¿é—®ç½‘ç«™ â†’ ç‚¹å‡»æ³¨å†Œ â†’ å¡«å†™ä¿¡æ¯ â†’ éªŒè¯æ•°æ® â†’ ä¿å­˜æ•°æ®åº“ â†’ æ³¨å†ŒæˆåŠŸ

ç”¨æˆ·ç™»å½•æµç¨‹ï¼š
è¾“å…¥è´¦å·å¯†ç  â†’ éªŒè¯èº«ä»½ â†’ åˆ›å»ºSession â†’ è·³è½¬é¦–é¡µ

ä¿¡æ¯ç®¡ç†æµç¨‹ï¼š
ç™»å½•æ£€æŸ¥ â†’ æ˜¾ç¤ºå½“å‰ä¿¡æ¯ â†’ ä¿®æ”¹æ•°æ® â†’ éªŒè¯æ›´æ–° â†’ ä¿å­˜å˜æ›´

æƒé™æ§åˆ¶æµç¨‹ï¼š
è¯·æ±‚èµ„æº â†’ æ£€æŸ¥ç™»å½• â†’ éªŒè¯æƒé™ â†’ å…è®¸/æ‹’ç»è®¿é—®

ä¼šè¯ç®¡ç†æµç¨‹ï¼š
åˆ›å»ºä¼šè¯ â†’ ä¿æŒçŠ¶æ€ â†’ è¶…æ—¶æ£€æŸ¥ â†’ è‡ªåŠ¨/æ‰‹åŠ¨é€€å‡º
```

### 8.3 é”™è¯¯å¤„ç†æœºåˆ¶


**ç»Ÿä¸€çš„é”™è¯¯å¤„ç†ç­–ç•¥**ï¼š
```java
// è‡ªå®šä¹‰å¼‚å¸¸ç±»
public class BusinessException extends RuntimeException {
    private int code;
    private String message;
    
    public BusinessException(String message) {
        super(message);
        this.code = 400;
        this.message = message;
    }
    
    public BusinessException(int code, String message) {
        super(message);
        this.code = code;
        this.message = message;
    }
    
    // getteræ–¹æ³•...
}

// å…¨å±€å¼‚å¸¸å¤„ç†è¿‡æ»¤å™¨
@WebFilter("/*")
public class ExceptionHandlerFilter implements Filter {
    
    public void doFilter(ServletRequest req, ServletResponse resp, 
                        FilterChain chain) throws IOException, ServletException {
        try {
            chain.doFilter(req, resp);
        } catch (BusinessException e) {
            handleBusinessException(req, resp, e);
        } catch (Exception e) {
            handleSystemException(req, resp, e);
        }
    }
    
    private void handleBusinessException(ServletRequest req, ServletResponse resp, 
                                       BusinessException e) throws ServletException, IOException {
        req.setAttribute("errorCode", e.getCode());
        req.setAttribute("errorMessage", e.getMessage());
        req.getRequestDispatcher("/error.jsp").forward(req, resp);
    }
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ç”¨æˆ·ç®¡ç†æ¨¡å—ï¼šWebåº”ç”¨çš„æ ¸å¿ƒåŸºç¡€åŠŸèƒ½ï¼Œå¤„ç†ç”¨æˆ·çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸ
ğŸ”¸ æ³¨å†Œç™»å½•ï¼šç”¨æˆ·èº«ä»½çš„å»ºç«‹å’ŒéªŒè¯ï¼Œæ˜¯ç”¨æˆ·è¿›å…¥ç³»ç»Ÿçš„é—¨æˆ·
ğŸ”¸ æ•°æ®éªŒè¯ï¼šç¡®ä¿æ•°æ®å®‰å…¨å’Œå®Œæ•´çš„åŒé‡ä¿éšœæœºåˆ¶
ğŸ”¸ ä¼šè¯ç®¡ç†ï¼šç»´æŒç”¨æˆ·ç™»å½•çŠ¶æ€çš„æ ¸å¿ƒæŠ€æœ¯
ğŸ”¸ æƒé™æ§åˆ¶ï¼šä¿æŠ¤ç³»ç»Ÿèµ„æºï¼Œå®ç°å®‰å…¨è®¿é—®çš„å…³é”®æœºåˆ¶
ğŸ”¸ MVCæ•´åˆï¼šå„å±‚åè°ƒé…åˆï¼Œå®ç°å®Œæ•´çš„ä¸šåŠ¡åŠŸèƒ½
```

### 9.2 å…³é”®æŠ€æœ¯è¦ç‚¹


**ğŸ”¹ å®‰å…¨æ€§æœ€ä½³å®è·µ**ï¼š
```
å¯†ç å®‰å…¨ï¼š
â€¢ ç»ä¸æ˜æ–‡å­˜å‚¨å¯†ç ï¼Œå¿…é¡»åŠ å¯†
â€¢ ä½¿ç”¨å¼ºå¯†ç ç­–ç•¥
â€¢ å®ç°å¯†ç ä¿®æ”¹åŠŸèƒ½

ä¼šè¯å®‰å…¨ï¼š
â€¢ è®¾ç½®åˆç†çš„Sessionè¶…æ—¶æ—¶é—´
â€¢ æ•æ„Ÿæ“ä½œåæ¸…é™¤Session
â€¢ é˜²æ­¢SessionåŠ«æŒ

æ•°æ®éªŒè¯ï¼š
â€¢ å‰ç«¯éªŒè¯æå‡ä½“éªŒï¼Œåç«¯éªŒè¯ä¿è¯å®‰å…¨
â€¢ ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼éªŒè¯æ ¼å¼
â€¢ å®ç°ä¸šåŠ¡è§„åˆ™éªŒè¯
```

**ğŸ”¹ ç”¨æˆ·ä½“éªŒä¼˜åŒ–**ï¼š
```
æ“ä½œåé¦ˆï¼š
â€¢ åŠæ—¶çš„æˆåŠŸ/å¤±è´¥æç¤º
â€¢ å‹å¥½çš„é”™è¯¯ä¿¡æ¯æ˜¾ç¤º
â€¢ è¡¨å•æ•°æ®çš„åˆç†ä¿ç•™

åŠŸèƒ½ä¾¿åˆ©ï¼š
â€¢ "è®°ä½æˆ‘"åŠŸèƒ½
â€¢ å¯†ç å¼ºåº¦æç¤º
â€¢ è‡ªåŠ¨è¡¨å•éªŒè¯
```

### 9.3 å®é™…å¼€å‘ä»·å€¼


**ğŸ¯ é¡¹ç›®åº”ç”¨åœºæ™¯**ï¼š
- **ç”µå•†ç½‘ç«™**ï¼šç”¨æˆ·æ³¨å†Œè´­ä¹°å•†å“ï¼Œä¸ªäººè®¢å•ç®¡ç†
- **å†…å®¹ç®¡ç†**ï¼šä½œè€…æ³¨å†Œå‘å¸ƒæ–‡ç« ï¼Œè¯»è€…è¯„è®ºäº’åŠ¨  
- **ä¼ä¸šç³»ç»Ÿ**ï¼šå‘˜å·¥ç™»å½•ä½¿ç”¨åŠå…¬ç³»ç»Ÿï¼Œæƒé™åˆ†çº§ç®¡ç†
- **æ•™è‚²å¹³å°**ï¼šå­¦ç”Ÿæ³¨å†Œé€‰è¯¾ï¼Œæ•™å¸ˆç®¡ç†æˆç»©æƒé™

**ğŸ”§ å¼€å‘å®è·µç»éªŒ**ï¼š
- **æ¨¡å—åŒ–è®¾è®¡**ï¼šæ¯ä¸ªåŠŸèƒ½ç‹¬ç«‹å¼€å‘ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•
- **å®‰å…¨ä¼˜å…ˆ**ï¼šä»è®¾è®¡é˜¶æ®µå°±è€ƒè™‘å®‰å…¨é—®é¢˜ï¼Œè€Œä¸æ˜¯äº‹åè¡¥æ•‘
- **ç”¨æˆ·ä½“éªŒ**ï¼šç«™åœ¨ç”¨æˆ·è§’åº¦æ€è€ƒåŠŸèƒ½è®¾è®¡å’Œäº¤äº’æµç¨‹
- **å¯æ‰©å±•æ€§**ï¼šé¢„ç•™æ¥å£å’Œæ‰©å±•ç‚¹ï¼Œæ–¹ä¾¿åæœŸåŠŸèƒ½å¢åŠ 

**æ ¸å¿ƒè®°å¿†**ï¼š
- ç”¨æˆ·ç®¡ç†æ˜¯Webå¼€å‘çš„åŸºç¡€æ ¸å¿ƒï¼Œå¿…é¡»æ‰å®æŒæ¡
- å®‰å…¨æ€§å’Œç”¨æˆ·ä½“éªŒåŒç­‰é‡è¦ï¼Œä¸å¯ååºŸ
- MVCæ¶æ„è®©ä»£ç æ›´æ¸…æ™°ï¼Œåˆ†å·¥æ›´æ˜ç¡®
- æ•°æ®éªŒè¯æ˜¯åŒé‡ä¿é™©ï¼Œå‰åç«¯ç¼ºä¸€ä¸å¯
- æƒé™æ§åˆ¶ä¿æŠ¤ç³»ç»Ÿï¼Œä¼šè¯ç®¡ç†ç»´æŒçŠ¶æ€

---

> ğŸ“ **å­¦ä¹ å»ºè®®**  
> ç”¨æˆ·ç®¡ç†æ¨¡å—æ˜¯Webå¼€å‘çš„æ ¸å¿ƒåŸºç¡€ï¼Œå»ºè®®é€šè¿‡å®é™…ç¼–ç ç»ƒä¹ æ¥æŒæ¡ã€‚ä»ç®€å•çš„ç™»å½•æ³¨å†Œå¼€å§‹ï¼Œé€æ­¥æ·»åŠ éªŒè¯ã€æƒé™ç­‰é«˜çº§åŠŸèƒ½ï¼Œæœ€ç»ˆå½¢æˆå®Œæ•´çš„ç”¨æˆ·ç®¡ç†ç³»ç»Ÿã€‚