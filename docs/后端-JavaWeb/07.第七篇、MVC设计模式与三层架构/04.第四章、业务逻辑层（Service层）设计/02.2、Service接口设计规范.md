---
title: 2ã€Serviceæ¥å£è®¾è®¡è§„èŒƒ
---
## ğŸ“š ç›®å½•

1. [Serviceå±‚çš„ä½œç”¨ä¸å®šä½](#1-Serviceå±‚çš„ä½œç”¨ä¸å®šä½)
2. [æ¥å£å®šä¹‰åŸåˆ™](#2-æ¥å£å®šä¹‰åŸåˆ™)
3. [æ–¹æ³•ç²’åº¦è®¾è®¡](#3-æ–¹æ³•ç²’åº¦è®¾è®¡)
4. [ä¸šåŠ¡è¯­ä¹‰è¡¨è¾¾](#4-ä¸šåŠ¡è¯­ä¹‰è¡¨è¾¾)
5. [å‚æ•°å°è£…ç­–ç•¥](#5-å‚æ•°å°è£…ç­–ç•¥)
6. [è¿”å›ç»“æœè®¾è®¡](#6-è¿”å›ç»“æœè®¾è®¡)
7. [å¼‚å¸¸å£°æ˜è§„èŒƒ](#7-å¼‚å¸¸å£°æ˜è§„èŒƒ)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ Serviceå±‚çš„ä½œç”¨ä¸å®šä½


### 1.1 ä»€ä¹ˆæ˜¯Serviceå±‚


**é€šä¿—ç†è§£**ï¼šæƒ³è±¡ä½ å¼€äº†ä¸€å®¶é¤å…
- **Controller** å°±åƒæœåŠ¡å‘˜ï¼šæ¥å¾…å®¢äººï¼Œè®°å½•ç‚¹é¤è¦æ±‚
- **Service** å°±åƒå¨å¸ˆé•¿ï¼šè´Ÿè´£å…·ä½“åšèœï¼Œåè°ƒå„ç§åŸæ–™å’Œå·¥åº
- **Dao** å°±åƒä»“åº“ç®¡ç†å‘˜ï¼šè´Ÿè´£å–èœã€å­˜èœ

```
ç”¨æˆ·è¯·æ±‚æµå‘ï¼š
å®¢æˆ·ç‚¹é¤ â†’ æœåŠ¡å‘˜è®°å½• â†’ å¨å¸ˆé•¿åˆ¶ä½œ â†’ ä»“åº“å–æ–™ â†’ å®Œæˆä¸Šèœ

ç³»ç»Ÿè¯·æ±‚æµå‘ï¼š
ç”¨æˆ·æ“ä½œ â†’ Controlleræ¥æ”¶ â†’ Serviceå¤„ç† â†’ Daoæ“ä½œæ•°æ® â†’ è¿”å›ç»“æœ
```

### 1.2 Serviceå±‚åœ¨ä¸‰å±‚æ¶æ„ä¸­çš„ä½ç½®


**æ¶æ„ä½ç½®å›¾**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Presentation  â”‚ â† è¡¨ç°å±‚(Controller)
â”‚      Layer      â”‚   è´Ÿè´£æ¥æ”¶è¯·æ±‚ï¼Œè¿”å›å“åº”
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    Business     â”‚ â† ä¸šåŠ¡é€»è¾‘å±‚(Service)  
â”‚     Layer       â”‚   è´Ÿè´£ä¸šåŠ¡å¤„ç†ï¼Œæ ¸å¿ƒé€»è¾‘
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Persistence   â”‚ â† æ•°æ®è®¿é—®å±‚(Dao)
â”‚     Layer       â”‚   è´Ÿè´£æ•°æ®æ“ä½œï¼Œå¢åˆ æ”¹æŸ¥
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 ä¸ºä»€ä¹ˆè¦æœ‰Serviceå±‚


**æ²¡æœ‰Serviceå±‚çš„é—®é¢˜**ï¼š
```java
// âŒ ç›´æ¥åœ¨Controllerä¸­å†™ä¸šåŠ¡é€»è¾‘
@RestController
public class UserController {
    public String register(User user) {
        // éªŒè¯ç”¨æˆ·åæ˜¯å¦é‡å¤
        if(userDao.findByUsername(user.getUsername()) != null) {
            return "ç”¨æˆ·åå·²å­˜åœ¨";
        }
        // åŠ å¯†å¯†ç 
        user.setPassword(MD5.encode(user.getPassword()));
        // è®¾ç½®é»˜è®¤è§’è‰²
        user.setRole("USER");
        // ä¿å­˜ç”¨æˆ·
        userDao.save(user);
        // å‘é€æ¬¢è¿é‚®ä»¶
        emailService.sendWelcomeEmail(user.getEmail());
        return "æ³¨å†ŒæˆåŠŸ";
    }
}
```

**é—®é¢˜åˆ†æ**ï¼š
- ğŸ”¸ **èŒè´£æ··ä¹±**ï¼šControlleræ—¢è¦å¤„ç†HTTPè¯·æ±‚ï¼Œåˆè¦å¤„ç†ä¸šåŠ¡é€»è¾‘
- ğŸ”¸ **ä»£ç é‡å¤**ï¼šå…¶ä»–åœ°æ–¹éœ€è¦ç”¨æˆ·æ³¨å†Œé€»è¾‘æ—¶ï¼Œåªèƒ½å¤åˆ¶ä»£ç 
- ğŸ”¸ **æµ‹è¯•å›°éš¾**ï¼šä¸šåŠ¡é€»è¾‘å’ŒWebç¯å¢ƒç»‘å®šï¼Œéš¾ä»¥å•ç‹¬æµ‹è¯•
- ğŸ”¸ **ç»´æŠ¤å›°éš¾**ï¼šä¸šåŠ¡å˜æ›´æ—¶éœ€è¦ä¿®æ”¹å¤šä¸ªController

---

## 2. ğŸ“‹ æ¥å£å®šä¹‰åŸåˆ™


### 2.1 å•ä¸€èŒè´£åŸåˆ™


**åŸåˆ™è¯´æ˜**ï¼šæ¯ä¸ªServiceæ¥å£åº”è¯¥åªè´Ÿè´£ä¸€ä¸ªä¸šåŠ¡é¢†åŸŸ

```java
// âœ… è‰¯å¥½çš„æ¥å£è®¾è®¡ - èŒè´£å•ä¸€
public interface UserService {
    // åªè´Ÿè´£ç”¨æˆ·ç›¸å…³çš„ä¸šåŠ¡æ“ä½œ
    User register(UserRegisterDTO registerDTO);
    User login(String username, String password);
    boolean updateProfile(Long userId, UserProfileDTO profileDTO);
    boolean resetPassword(String email);
}

public interface OrderService {
    // åªè´Ÿè´£è®¢å•ç›¸å…³çš„ä¸šåŠ¡æ“ä½œ
    Order createOrder(OrderCreateDTO orderDTO);
    boolean cancelOrder(Long orderId, String reason);
    List<Order> getUserOrders(Long userId, int page, int size);
}

// âŒ é”™è¯¯çš„æ¥å£è®¾è®¡ - èŒè´£æ··ä¹±
public interface BusinessService {
    // ä»€ä¹ˆéƒ½åšï¼ŒèŒè´£ä¸æ¸…
    User registerUser(User user);
    Order createOrder(Order order);
    Product addProduct(Product product);
    // ... æ··åˆäº†å¤šç§ä¸šåŠ¡
}
```

### 2.2 æ¥å£ä¸å®ç°åˆ†ç¦»åŸåˆ™


**ä¸ºä»€ä¹ˆè¦å®šä¹‰æ¥å£**ï¼š
- ğŸ”¸ **çµæ´»æ›¿æ¢**ï¼šå¯ä»¥æœ‰å¤šç§å®ç°æ–¹å¼
- ğŸ”¸ **æ–¹ä¾¿æµ‹è¯•**ï¼šå¯ä»¥ç”¨Mockå¯¹è±¡æ›¿ä»£çœŸå®å®ç°
- ğŸ”¸ **é™ä½è€¦åˆ**ï¼šè°ƒç”¨æ–¹åªä¾èµ–æ¥å£ï¼Œä¸ä¾èµ–å…·ä½“å®ç°

```java
// æ¥å£å®šä¹‰
public interface UserService {
    User findById(Long id);
}

// æ•°æ®åº“å®ç°
@Service("dbUserService")
public class DatabaseUserServiceImpl implements UserService {
    public User findById(Long id) {
        return userDao.findById(id);
    }
}

// ç¼“å­˜å®ç°  
@Service("cacheUserService")
public class CacheUserServiceImpl implements UserService {
    public User findById(Long id) {
        return redisTemplate.get("user:" + id);
    }
}
```

### 2.3 æ¥å£å‘½åè§„èŒƒ


| **æ“ä½œç±»å‹** | **å‘½åè§„èŒƒ** | **ç¤ºä¾‹** | **å«ä¹‰è¯´æ˜** |
|-------------|-------------|----------|-------------|
| **æŸ¥è¯¢å•ä¸ª** | `findXxx` / `getXxx` | `findById(Long id)` | æ ¹æ®æ¡ä»¶æŸ¥æ‰¾å•ä¸ªå¯¹è±¡ |
| **æŸ¥è¯¢åˆ—è¡¨** | `listXxx` / `findAllXxx` | `listUsersByRole(String role)` | æŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„å¯¹è±¡åˆ—è¡¨ |
| **åˆ†é¡µæŸ¥è¯¢** | `pageXxx` | `pageUsers(int page, int size)` | åˆ†é¡µæŸ¥è¯¢å¯¹è±¡ |
| **æ–°å¢** | `create` / `add` / `save` | `createUser(UserDTO dto)` | åˆ›å»ºæ–°çš„å¯¹è±¡ |
| **ä¿®æ”¹** | `update` / `modify` | `updateUserProfile(UserDTO dto)` | ä¿®æ”¹å·²æœ‰å¯¹è±¡ |
| **åˆ é™¤** | `delete` / `remove` | `deleteUser(Long id)` | åˆ é™¤æŒ‡å®šå¯¹è±¡ |
| **ä¸šåŠ¡æ“ä½œ** | **åŠ¨è¯+åè¯** | `resetPassword` / `activateUser` | å…·ä½“çš„ä¸šåŠ¡æ“ä½œ |

---

## 3. âš™ï¸ æ–¹æ³•ç²’åº¦è®¾è®¡


### 3.1 ä»€ä¹ˆæ˜¯æ–¹æ³•ç²’åº¦


**é€šä¿—è§£é‡Š**ï¼šæ–¹æ³•ç²’åº¦å°±åƒåšèœçš„æ­¥éª¤ç»†åˆ†ç¨‹åº¦
- **ç²—ç²’åº¦**ï¼šç›´æ¥æä¾›"åšä¸€æ¡Œèœ"çš„æ–¹æ³•
- **ç»†ç²’åº¦**ï¼šæä¾›"åˆ‡èœ"ã€"ç‚’èœ"ã€"è£…ç›˜"ç­‰å°æ­¥éª¤æ–¹æ³•
- **åˆé€‚ç²’åº¦**ï¼šæä¾›"åšçº¢çƒ§è‚‰"ã€"åšé’èœæ±¤"ç­‰å•ä¸ªèœå“æ–¹æ³•

### 3.2 ç²—ç²’åº¦æ–¹æ³•è®¾è®¡


**é€‚ç”¨åœºæ™¯**ï¼šå®Œæ•´çš„ä¸šåŠ¡æµç¨‹ï¼Œå¤–éƒ¨è°ƒç”¨è€…ä¸å…³å¿ƒå†…éƒ¨æ­¥éª¤

```java
// âœ… åˆé€‚çš„ç²—ç²’åº¦æ–¹æ³•
public interface UserService {
    /**
     * ç”¨æˆ·æ³¨å†Œå®Œæ•´æµç¨‹
     * åŒ…æ‹¬ï¼šéªŒè¯ã€åŠ å¯†ã€ä¿å­˜ã€å‘é‚®ä»¶ç­‰æ‰€æœ‰æ­¥éª¤
     */
    RegisterResult register(UserRegisterDTO registerDTO);
}

@Service
public class UserServiceImpl implements UserService {
    public RegisterResult register(UserRegisterDTO registerDTO) {
        // 1. éªŒè¯ç”¨æˆ·åå”¯ä¸€æ€§
        if (isUsernameExists(registerDTO.getUsername())) {
            return RegisterResult.fail("ç”¨æˆ·åå·²å­˜åœ¨");
        }
        
        // 2. å¯†ç åŠ å¯†
        String encryptedPassword = passwordEncoder.encode(registerDTO.getPassword());
        
        // 3. åˆ›å»ºç”¨æˆ·å¯¹è±¡
        User user = new User();
        user.setUsername(registerDTO.getUsername());
        user.setPassword(encryptedPassword);
        user.setEmail(registerDTO.getEmail());
        user.setStatus("ACTIVE");
        
        // 4. ä¿å­˜åˆ°æ•°æ®åº“
        User savedUser = userDao.save(user);
        
        // 5. å‘é€æ¬¢è¿é‚®ä»¶
        emailService.sendWelcomeEmail(savedUser.getEmail());
        
        return RegisterResult.success(savedUser);
    }
}
```

### 3.3 ç»†ç²’åº¦æ–¹æ³•è®¾è®¡


**é€‚ç”¨åœºæ™¯**ï¼šéœ€è¦çµæ´»ç»„åˆçš„åŸºç¡€æ“ä½œ

```java
public interface UserService {
    // ç»†ç²’åº¦çš„åŸºç¡€æ“ä½œæ–¹æ³•
    boolean isUsernameExists(String username);
    boolean isEmailExists(String email);
    User createUser(UserCreateDTO createDTO);
    boolean updateUserStatus(Long userId, String status);
    boolean sendActivationEmail(String email);
    
    // ç»„åˆä½¿ç”¨çš„ä¸šåŠ¡æ–¹æ³•
    default RegisterResult register(UserRegisterDTO registerDTO) {
        // å¯ä»¥çµæ´»ç»„åˆåŸºç¡€æ–¹æ³•
        if (isUsernameExists(registerDTO.getUsername())) {
            return RegisterResult.fail("ç”¨æˆ·åå·²å­˜åœ¨");
        }
        
        if (isEmailExists(registerDTO.getEmail())) {
            return RegisterResult.fail("é‚®ç®±å·²å­˜åœ¨");
        }
        
        User user = createUser(convertToCreateDTO(registerDTO));
        sendActivationEmail(user.getEmail());
        
        return RegisterResult.success(user);
    }
}
```

### 3.4 æ–¹æ³•ç²’åº¦é€‰æ‹©æŒ‡å¯¼


```
é€‰æ‹©åŸåˆ™ï¼š

ğŸ”¸ å¯¹å¤–æ¥å£ â†’ ç²—ç²’åº¦
- æä¾›å®Œæ•´çš„ä¸šåŠ¡åŠŸèƒ½
- éšè—å†…éƒ¨å®ç°ç»†èŠ‚
- å‡å°‘å¤–éƒ¨è°ƒç”¨çš„å¤æ‚åº¦

ğŸ”¸ å†…éƒ¨æ–¹æ³• â†’ ç»†ç²’åº¦  
- èŒè´£å•ä¸€ï¼Œä¾¿äºå¤ç”¨
- æ–¹ä¾¿å•å…ƒæµ‹è¯•
- æ”¯æŒçµæ´»ç»„åˆ

ğŸ”¸ åˆ¤æ–­æ ‡å‡†ï¼š
- å¦‚æœæ–¹æ³•ç»å¸¸è¢«å•ç‹¬è°ƒç”¨ â†’ æå–ä¸ºå…¬å…±æ–¹æ³•
- å¦‚æœæ–¹æ³•é€»è¾‘å¤æ‚ â†’ æ‹†åˆ†ä¸ºå¤šä¸ªå°æ–¹æ³•  
- å¦‚æœæ–¹æ³•éœ€è¦åœ¨å¤šå¤„ä½¿ç”¨ â†’ è®¾è®¡ä¸ºç»†ç²’åº¦æ–¹æ³•
```

---

## 4. ğŸ¨ ä¸šåŠ¡è¯­ä¹‰è¡¨è¾¾


### 4.1 ä»€ä¹ˆæ˜¯ä¸šåŠ¡è¯­ä¹‰


**é€šä¿—è§£é‡Š**ï¼šä¸šåŠ¡è¯­ä¹‰å°±æ˜¯è®©æ–¹æ³•åå­—èƒ½å¤Ÿæ¸…æ¥šè¡¨è¾¾"è¿™ä¸ªæ–¹æ³•æ˜¯å¹²ä»€ä¹ˆçš„"

```java
// âŒ è¯­ä¹‰ä¸æ¸…çš„æ–¹æ³•å
public interface UserService {
    boolean process(User user);      // å¤„ç†ä»€ä¹ˆï¼Ÿ
    void handle(Long id);           // å¤„ç†ä»€ä¹ˆæ“ä½œï¼Ÿ
    User get(String param);         // æ ¹æ®ä»€ä¹ˆè·å–ï¼Ÿ
    boolean check(User user);       // æ£€æŸ¥ä»€ä¹ˆï¼Ÿ
}

// âœ… è¯­ä¹‰æ¸…æ™°çš„æ–¹æ³•å  
public interface UserService {
    boolean activateUser(Long userId);           // æ¿€æ´»ç”¨æˆ·
    void lockUserAccount(Long userId);           // é”å®šç”¨æˆ·è´¦æˆ·
    User findUserByEmail(String email);          // æ ¹æ®é‚®ç®±æŸ¥æ‰¾ç”¨æˆ·
    boolean validateUserCredentials(User user);  // éªŒè¯ç”¨æˆ·å‡­è¯
}
```

### 4.2 ä¸šåŠ¡åŠ¨è¯çš„é€‰æ‹©


**å¸¸ç”¨ä¸šåŠ¡åŠ¨è¯å¯¹ç…§è¡¨**ï¼š

| **ä¸šåŠ¡åœºæ™¯** | **æ¨èåŠ¨è¯** | **ç¤ºä¾‹æ–¹æ³•** | **è¯­ä¹‰è¯´æ˜** |
|-------------|-------------|-------------|-------------|
| **æ¿€æ´»/å¯ç”¨** | `activate` | `activateUser()` | ä½¿æŸä¸ªå¯¹è±¡å˜ä¸ºå¯ç”¨çŠ¶æ€ |
| **ç¦ç”¨/åœç”¨** | `disable` / `deactivate` | `disableUser()` | ä½¿æŸä¸ªå¯¹è±¡å˜ä¸ºä¸å¯ç”¨çŠ¶æ€ |
| **é”å®š** | `lock` | `lockAccount()` | ä¸´æ—¶é™åˆ¶è®¿é—® |
| **è§£é”** | `unlock` | `unlockAccount()` | è§£é™¤è®¿é—®é™åˆ¶ |
| **é‡ç½®** | `reset` | `resetPassword()` | æ¢å¤åˆ°åˆå§‹çŠ¶æ€ |
| **éªŒè¯** | `validate` / `verify` | `validateCode()` | æ£€æŸ¥æ˜¯å¦ç¬¦åˆè¦æ±‚ |
| **æˆæƒ** | `authorize` | `authorizeUser()` | ç»™äºˆæŸç§æƒé™ |
| **å®¡æ ¸** | `audit` / `review` | `auditOrder()` | äººå·¥å®¡æŸ¥ç¡®è®¤ |

### 4.3 é¢†åŸŸç‰¹å®šçš„è¯­ä¹‰è¡¨è¾¾


```java
// ç”µå•†ä¸šåŠ¡çš„è¯­ä¹‰è¡¨è¾¾
public interface OrderService {
    Order submitOrder(OrderSubmitDTO submitDTO);    // æäº¤è®¢å•
    boolean cancelOrder(Long orderId);               // å–æ¶ˆè®¢å•  
    boolean confirmOrder(Long orderId);              // ç¡®è®¤è®¢å•
    boolean shipOrder(Long orderId);                 // å‘è´§
    boolean completeOrder(Long orderId);             // å®Œæˆè®¢å•
    boolean refundOrder(Long orderId, String reason); // é€€æ¬¾
}

// ç”¨æˆ·ç®¡ç†ä¸šåŠ¡çš„è¯­ä¹‰è¡¨è¾¾
public interface UserService {
    User registerUser(UserRegisterDTO registerDTO);     // æ³¨å†Œç”¨æˆ·
    boolean authenticateUser(String username, String password); // è®¤è¯ç”¨æˆ·
    void activateUserAccount(Long userId);               // æ¿€æ´»è´¦æˆ·
    void suspendUserAccount(Long userId, String reason); // æš‚åœè´¦æˆ·
    void resetUserPassword(String email);                // é‡ç½®å¯†ç 
    boolean changeUserPassword(Long userId, String oldPwd, String newPwd); // ä¿®æ”¹å¯†ç 
}
```

### 4.4 é¿å…æŠ€æœ¯æœ¯è¯­æ³„éœ²


```java
// âŒ æš´éœ²äº†æŠ€æœ¯å®ç°ç»†èŠ‚
public interface UserService {
    User selectUserFromDB(Long id);        // æš´éœ²äº†æ•°æ®åº“æ“ä½œ
    boolean insertUserToDatabase(User user); // æš´éœ²äº†å…·ä½“å­˜å‚¨æ–¹å¼
    void updateUserInRedis(User user);      // æš´éœ²äº†ç¼“å­˜å®ç°
}

// âœ… å…³æ³¨ä¸šåŠ¡å«ä¹‰ï¼Œéšè—æŠ€æœ¯å®ç°
public interface UserService {
    User findUserById(Long id);            // ä¸šåŠ¡è¯­ä¹‰ï¼šæŸ¥æ‰¾ç”¨æˆ·
    User createUser(UserCreateDTO dto);    // ä¸šåŠ¡è¯­ä¹‰ï¼šåˆ›å»ºç”¨æˆ·  
    boolean updateUserProfile(User user);  // ä¸šåŠ¡è¯­ä¹‰ï¼šæ›´æ–°ç”¨æˆ·ä¿¡æ¯
}
```

---

## 5. ğŸ“¦ å‚æ•°å°è£…ç­–ç•¥


### 5.1 ä¸ºä»€ä¹ˆè¦å°è£…å‚æ•°


**é—®é¢˜åœºæ™¯**ï¼šå‚æ•°è¿‡å¤šå¯¼è‡´çš„é—®é¢˜
```java
// âŒ å‚æ•°è¿‡å¤šï¼Œéš¾ä»¥ç»´æŠ¤
public User createUser(String username, String password, String email, 
                      String phone, String address, String city, 
                      String province, String zipCode, Date birthDate,
                      String gender, String occupation) {
    // å‚æ•°å¤ªå¤šï¼Œå®¹æ˜“ä¼ é”™
}

// è°ƒç”¨æ—¶å®¹æ˜“å‡ºé”™
userService.createUser("å¼ ä¸‰", "123456", "zhang@email.com", 
                      "13800138000", "æŸæŸè¡—é“", "åŒ—äº¬", 
                      "åŒ—äº¬å¸‚", "100000", new Date(), 
                      "ç”·", "ç¨‹åºå‘˜"); // å‚æ•°é¡ºåºå®¹æ˜“ææ··
```

### 5.2 DTOå‚æ•°å°è£…


**DTOï¼ˆData Transfer Objectï¼‰**ï¼šæ•°æ®ä¼ è¾“å¯¹è±¡ï¼Œä¸“é—¨ç”¨æ¥å°è£…å‚æ•°

```java
// âœ… ä½¿ç”¨DTOå°è£…å‚æ•°
public class UserCreateDTO {
    private String username;
    private String password;
    private String email;
    private String phone;
    
    // åœ°å€ä¿¡æ¯å•ç‹¬å°è£…
    private AddressDTO address;
    
    // ä¸ªäººä¿¡æ¯å•ç‹¬å°è£…  
    private PersonalInfoDTO personalInfo;
    
    // æ„é€ æ–¹æ³•ã€getter/setterçœç•¥
}

public class AddressDTO {
    private String street;
    private String city;
    private String province;
    private String zipCode;
}

public class PersonalInfoDTO {
    private Date birthDate;
    private String gender;
    private String occupation;
}

// Serviceæ¥å£å˜å¾—ç®€æ´
public interface UserService {
    User createUser(UserCreateDTO createDTO);
}
```

### 5.3 å‚æ•°æ ¡éªŒå°è£…


**åœ¨DTOä¸­æ·»åŠ æ ¡éªŒæ³¨è§£**ï¼š
```java
public class UserRegisterDTO {
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @Size(min = 3, max = 20, message = "ç”¨æˆ·åé•¿åº¦å¿…é¡»åœ¨3-20ä¹‹é—´")
    private String username;
    
    @NotBlank(message = "å¯†ç ä¸èƒ½ä¸ºç©º")
    @Size(min = 6, message = "å¯†ç é•¿åº¦ä¸èƒ½å°‘äº6ä½")
    private String password;
    
    @NotBlank(message = "é‚®ç®±ä¸èƒ½ä¸ºç©º")
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String email;
    
    @Pattern(regexp = "^1[3-9]\\d{9}$", message = "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®")
    private String phone;
    
    // getter/setterçœç•¥
}
```

### 5.4 å‚æ•°åˆ†ç»„å°è£…ç­–ç•¥


**æŒ‰ä¸šåŠ¡åœºæ™¯åˆ†ç»„**ï¼š
```java
// ç”¨æˆ·æ³¨å†Œæ—¶éœ€è¦çš„å‚æ•°
public class UserRegisterDTO {
    private String username;
    private String password;
    private String email;
    private String phone;
    private String verifyCode; // éªŒè¯ç 
}

// ç”¨æˆ·æ›´æ–°èµ„æ–™æ—¶éœ€è¦çš„å‚æ•°
public class UserUpdateDTO {
    private Long userId;       // å¿…é¡»æœ‰IDæ ‡è¯†
    private String nickname;
    private String avatar;
    private String bio;        // ä¸ªäººç®€ä»‹
    // æ³¨æ„ï¼šä¸åŒ…å«æ•æ„Ÿä¿¡æ¯å¦‚å¯†ç 
}

// ç”¨æˆ·ç™»å½•æ—¶éœ€è¦çš„å‚æ•°
public class UserLoginDTO {
    private String username;   // å¯ä»¥æ˜¯ç”¨æˆ·åæˆ–é‚®ç®±æˆ–æ‰‹æœºå·
    private String password;
    private String loginType;  // ç™»å½•æ–¹å¼ï¼šusername/email/phone
    private boolean rememberMe; // æ˜¯å¦è®°ä½ç™»å½•
}
```

### 5.5 å‚æ•°ä¼ é€’çš„æœ€ä½³å®è·µ


```java
// âœ… å¥½çš„å‚æ•°è®¾è®¡
public interface OrderService {
    // 1. ä½¿ç”¨å…·ä½“çš„DTOç±»å‹ï¼Œå«ä¹‰æ˜ç¡®
    Order createOrder(OrderCreateDTO createDTO);
    
    // 2. ç®€å•æŸ¥è¯¢å¯ä»¥ç›´æ¥ç”¨åŸºæœ¬ç±»å‹  
    Order findOrderById(Long orderId);
    
    // 3. å¤æ‚æŸ¥è¯¢ä½¿ç”¨æ¡ä»¶å¯¹è±¡
    List<Order> searchOrders(OrderSearchCondition condition);
    
    // 4. æ‰¹é‡æ“ä½œä½¿ç”¨é›†åˆ
    boolean batchUpdateOrderStatus(List<Long> orderIds, String status);
}

// âŒ ä¸å¥½çš„å‚æ•°è®¾è®¡
public interface OrderService {
    // 1. ä½¿ç”¨Mapä¼ å‚ï¼Œå«ä¹‰ä¸æ˜ç¡®
    Order createOrder(Map<String, Object> params);
    
    // 2. å‚æ•°è¿‡å¤š
    List<Order> searchOrders(String status, Date startDate, Date endDate,
                           String customerName, String productName, 
                           Double minAmount, Double maxAmount,
                           int page, int size);
}
```

---

## 6. ğŸ è¿”å›ç»“æœè®¾è®¡


### 6.1 ç»Ÿä¸€è¿”å›ç»“æœæ ¼å¼


**ä¸ºä»€ä¹ˆè¦ç»Ÿä¸€è¿”å›æ ¼å¼**ï¼š
- ğŸ”¸ **å‰ç«¯å¤„ç†ç»Ÿä¸€**ï¼šå‰ç«¯å¯ä»¥ç”¨ç›¸åŒçš„æ–¹å¼å¤„ç†æ‰€æœ‰æ¥å£è¿”å›
- ğŸ”¸ **é”™è¯¯å¤„ç†ç»Ÿä¸€**ï¼šæˆåŠŸå’Œå¤±è´¥çš„å¤„ç†é€»è¾‘ä¸€è‡´
- ğŸ”¸ **æ‰©å±•æ€§å¥½**ï¼šå¯ä»¥æ–¹ä¾¿åœ°æ·»åŠ çŠ¶æ€ç ã€æ¶ˆæ¯ç­‰ä¿¡æ¯

```java
// ç»Ÿä¸€è¿”å›ç»“æœç±»
public class ServiceResult<T> {
    private boolean success;    // æ˜¯å¦æˆåŠŸ
    private String message;     // æç¤ºæ¶ˆæ¯
    private T data;            // è¿”å›æ•°æ®
    private String errorCode;   // é”™è¯¯ç ï¼ˆå¯é€‰ï¼‰
    
    // æˆåŠŸæ—¶çš„é™æ€æ–¹æ³•
    public static <T> ServiceResult<T> success(T data) {
        ServiceResult<T> result = new ServiceResult<>();
        result.success = true;
        result.data = data;
        result.message = "æ“ä½œæˆåŠŸ";
        return result;
    }
    
    public static <T> ServiceResult<T> success(T data, String message) {
        ServiceResult<T> result = new ServiceResult<>();
        result.success = true;
        result.data = data;
        result.message = message;
        return result;
    }
    
    // å¤±è´¥æ—¶çš„é™æ€æ–¹æ³•
    public static <T> ServiceResult<T> fail(String message) {
        ServiceResult<T> result = new ServiceResult<>();
        result.success = false;
        result.message = message;
        return result;
    }
    
    public static <T> ServiceResult<T> fail(String message, String errorCode) {
        ServiceResult<T> result = new ServiceResult<>();
        result.success = false;
        result.message = message;
        result.errorCode = errorCode;
        return result;
    }
    
    // getter/setterçœç•¥
}
```

### 6.2 Serviceæ–¹æ³•çš„è¿”å›è®¾è®¡


```java
public interface UserService {
    // 1. åˆ›å»ºæ“ä½œ - è¿”å›åˆ›å»ºçš„å¯¹è±¡
    ServiceResult<User> createUser(UserCreateDTO createDTO);
    
    // 2. æŸ¥è¯¢å•ä¸ª - å¯èƒ½æŸ¥ä¸åˆ°ï¼Œç”¨Optionalæˆ–nullè¡¨ç¤º
    ServiceResult<User> findUserById(Long userId);
    
    // 3. æŸ¥è¯¢åˆ—è¡¨ - è¿”å›åˆ—è¡¨ï¼Œæ²¡æœ‰æ•°æ®æ—¶è¿”å›ç©ºåˆ—è¡¨
    ServiceResult<List<User>> findUsersByRole(String role);
    
    // 4. åˆ†é¡µæŸ¥è¯¢ - è¿”å›åˆ†é¡µå¯¹è±¡
    ServiceResult<PageResult<User>> pageUsers(int page, int size);
    
    // 5. æ›´æ–°æ“ä½œ - è¿”å›æ˜¯å¦æˆåŠŸ
    ServiceResult<Boolean> updateUser(UserUpdateDTO updateDTO);
    
    // 6. åˆ é™¤æ“ä½œ - è¿”å›æ˜¯å¦æˆåŠŸ
    ServiceResult<Boolean> deleteUser(Long userId);
    
    // 7. ä¸šåŠ¡æ“ä½œ - è¿”å›æ“ä½œç»“æœ
    ServiceResult<String> resetPassword(String email);
}
```

### 6.3 åˆ†é¡µç»“æœå°è£…


```java
// åˆ†é¡µç»“æœå°è£…ç±»
public class PageResult<T> {
    private List<T> records;        // å½“å‰é¡µæ•°æ®
    private long total;             // æ€»è®°å½•æ•°
    private int page;               // å½“å‰é¡µç 
    private int size;               // æ¯é¡µå¤§å°
    private int totalPages;         // æ€»é¡µæ•°
    private boolean hasNext;        // æ˜¯å¦æœ‰ä¸‹ä¸€é¡µ
    private boolean hasPrevious;    // æ˜¯å¦æœ‰ä¸Šä¸€é¡µ
    
    public PageResult(List<T> records, long total, int page, int size) {
        this.records = records;
        this.total = total;
        this.page = page;
        this.size = size;
        this.totalPages = (int) Math.ceil((double) total / size);
        this.hasNext = page < totalPages;
        this.hasPrevious = page > 1;
    }
    
    // getter/setterçœç•¥
}

// ä½¿ç”¨ç¤ºä¾‹
public ServiceResult<PageResult<User>> pageUsers(int page, int size) {
    // æŸ¥è¯¢æ€»æ•°
    long total = userDao.countAll();
    
    // æŸ¥è¯¢å½“å‰é¡µæ•°æ®
    List<User> users = userDao.findByPage((page - 1) * size, size);
    
    // å°è£…åˆ†é¡µç»“æœ
    PageResult<User> pageResult = new PageResult<>(users, total, page, size);
    
    return ServiceResult.success(pageResult);
}
```

### 6.4 ä¸åŒåœºæ™¯çš„è¿”å›è®¾è®¡


```java
public interface OrderService {
    
    // åœºæ™¯1ï¼šå¯èƒ½å¤±è´¥çš„æ“ä½œï¼Œéœ€è¦è¿”å›å…·ä½“åŸå› 
    ServiceResult<Order> submitOrder(OrderSubmitDTO submitDTO);
    // è¿”å›ç¤ºä¾‹ï¼š
    // æˆåŠŸï¼šServiceResult.success(order)
    // å¤±è´¥ï¼šServiceResult.fail("åº“å­˜ä¸è¶³")
    
    // åœºæ™¯2ï¼šæŸ¥è¯¢æ“ä½œï¼Œå¯èƒ½æŸ¥ä¸åˆ°æ•°æ®
    ServiceResult<Order> findOrderById(Long orderId);
    // è¿”å›ç¤ºä¾‹ï¼š
    // æ‰¾åˆ°ï¼šServiceResult.success(order)  
    // æ²¡æ‰¾åˆ°ï¼šServiceResult.success(null) æˆ– ServiceResult.fail("è®¢å•ä¸å­˜åœ¨")
    
    // åœºæ™¯3ï¼šç®€å•çš„æˆåŠŸå¤±è´¥åˆ¤æ–­
    ServiceResult<Boolean> cancelOrder(Long orderId);
    // è¿”å›ç¤ºä¾‹ï¼š
    // æˆåŠŸï¼šServiceResult.success(true)
    // å¤±è´¥ï¼šServiceResult.fail("è®¢å•å·²å‘è´§ï¼Œæ— æ³•å–æ¶ˆ")
    
    // åœºæ™¯4ï¼šéœ€è¦è¿”å›å¤„ç†ç»“æœä¿¡æ¯
    ServiceResult<String> processRefund(Long orderId, String reason);
    // è¿”å›ç¤ºä¾‹ï¼š
    // æˆåŠŸï¼šServiceResult.success("é€€æ¬¾ç”³è¯·å·²æäº¤ï¼Œé¢„è®¡3-5ä¸ªå·¥ä½œæ—¥åˆ°è´¦")
    // å¤±è´¥ï¼šServiceResult.fail("è®¢å•çŠ¶æ€ä¸å…è®¸é€€æ¬¾")
}
```

---

## 7. âš ï¸ å¼‚å¸¸å£°æ˜è§„èŒƒ


### 7.1 ä¸ºä»€ä¹ˆè¦å£°æ˜å¼‚å¸¸


**å¼‚å¸¸çš„ä½œç”¨**ï¼šå‘Šè¯‰è°ƒç”¨è€…"è¿™ä¸ªæ–¹æ³•å¯èƒ½å‡ºç°ä»€ä¹ˆé—®é¢˜"

```java
// æ²¡æœ‰å¼‚å¸¸å£°æ˜çš„é—®é¢˜
public User findUserById(Long id) {
    // å¦‚æœæ•°æ®åº“è¿æ¥å¤±è´¥ä¼šæ€æ ·ï¼Ÿ
    // å¦‚æœç”¨æˆ·ä¸å­˜åœ¨ä¼šæ€æ ·ï¼Ÿ
    // è°ƒç”¨è€…æ— æ³•é¢„çŸ¥å¯èƒ½çš„é—®é¢˜
    return userDao.findById(id);
}

// æœ‰å¼‚å¸¸å£°æ˜çš„å¥½å¤„
public User findUserById(Long id) throws UserNotFoundException, DataAccessException {
    // è°ƒç”¨è€…çŸ¥é“å¯èƒ½å‡ºç°çš„é—®é¢˜ï¼Œå¯ä»¥æå‰å‡†å¤‡å¤„ç†æ–¹æ¡ˆ
    User user = userDao.findById(id);
    if (user == null) {
        throw new UserNotFoundException("ç”¨æˆ·ä¸å­˜åœ¨ï¼ŒIDï¼š" + id);
    }
    return user;
}
```

### 7.2 ä¸šåŠ¡å¼‚å¸¸è®¾è®¡


**è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ç±»**ï¼š
```java
// åŸºç¡€ä¸šåŠ¡å¼‚å¸¸ç±»
public class BusinessException extends RuntimeException {
    private String errorCode;
    
    public BusinessException(String message) {
        super(message);
    }
    
    public BusinessException(String errorCode, String message) {
        super(message);
        this.errorCode = errorCode;
    }
    
    public String getErrorCode() {
        return errorCode;
    }
}

// ç”¨æˆ·ç›¸å…³å¼‚å¸¸
public class UserException extends BusinessException {
    public UserException(String message) {
        super(message);
    }
    
    public UserException(String errorCode, String message) {
        super(errorCode, message);
    }
}

// å…·ä½“çš„ç”¨æˆ·å¼‚å¸¸
public class UserNotFoundException extends UserException {
    public UserNotFoundException(String message) {
        super("USER_NOT_FOUND", message);
    }
}

public class UserAlreadyExistsException extends UserException {
    public UserAlreadyExistsException(String message) {
        super("USER_ALREADY_EXISTS", message);
    }
}

public class InvalidPasswordException extends UserException {
    public InvalidPasswordException(String message) {
        super("INVALID_PASSWORD", message);
    }
}
```

### 7.3 å¼‚å¸¸å£°æ˜çš„å±‚æ¬¡è®¾è®¡


```java
public interface UserService {
    
    // 1. å£°æ˜å…·ä½“çš„ä¸šåŠ¡å¼‚å¸¸
    User register(UserRegisterDTO registerDTO) 
        throws UserAlreadyExistsException, InvalidEmailException;
    
    // 2. å£°æ˜å¯èƒ½çš„ç³»ç»Ÿå¼‚å¸¸  
    User findUserById(Long userId) 
        throws UserNotFoundException;
    
    // 3. ç™»å½•æ–¹æ³•å¯èƒ½æŠ›å‡ºå¤šç§å¼‚å¸¸
    User login(String username, String password) 
        throws UserNotFoundException, InvalidPasswordException, 
               AccountLockedException;
    
    // 4. ä¸ç¡®å®šå…·ä½“å¼‚å¸¸æ—¶ï¼Œå£°æ˜åŸºç¡€å¼‚å¸¸
    boolean updateUserProfile(UserUpdateDTO updateDTO) 
        throws BusinessException;
}
```

### 7.4 å¼‚å¸¸å¤„ç†æœ€ä½³å®è·µ


```java
@Service
public class UserServiceImpl implements UserService {
    
    @Override
    public User register(UserRegisterDTO registerDTO) 
            throws UserAlreadyExistsException {
        
        try {
            // 1. æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å­˜åœ¨
            if (userDao.existsByUsername(registerDTO.getUsername())) {
                throw new UserAlreadyExistsException("ç”¨æˆ·åå·²å­˜åœ¨ï¼š" + registerDTO.getUsername());
            }
            
            // 2. æ£€æŸ¥é‚®ç®±æ˜¯å¦å­˜åœ¨
            if (userDao.existsByEmail(registerDTO.getEmail())) {
                throw new UserAlreadyExistsException("é‚®ç®±å·²è¢«æ³¨å†Œï¼š" + registerDTO.getEmail());
            }
            
            // 3. åˆ›å»ºç”¨æˆ·
            User user = new User();
            user.setUsername(registerDTO.getUsername());
            user.setPassword(passwordEncoder.encode(registerDTO.getPassword()));
            user.setEmail(registerDTO.getEmail());
            
            // 4. ä¿å­˜ç”¨æˆ·
            return userDao.save(user);
            
        } catch (DataAccessException e) {
            // 5. æ•°æ®åº“å¼‚å¸¸è½¬æ¢ä¸ºä¸šåŠ¡å¼‚å¸¸
            throw new BusinessException("ç”¨æˆ·æ³¨å†Œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•");
        }
    }
}
```

### 7.5 å¼‚å¸¸ä¸è¿”å›å€¼çš„é€‰æ‹©


```java
// æ–¹å¼1ï¼šä½¿ç”¨å¼‚å¸¸è¡¨ç¤ºé”™è¯¯
public User findUserById(Long userId) throws UserNotFoundException {
    User user = userDao.findById(userId);
    if (user == null) {
        throw new UserNotFoundException("ç”¨æˆ·ä¸å­˜åœ¨ï¼ŒIDï¼š" + userId);
    }
    return user;
}

// æ–¹å¼2ï¼šä½¿ç”¨è¿”å›å€¼è¡¨ç¤ºé”™è¯¯
public ServiceResult<User> findUserById(Long userId) {
    User user = userDao.findById(userId);
    if (user == null) {
        return ServiceResult.fail("ç”¨æˆ·ä¸å­˜åœ¨");
    }
    return ServiceResult.success(user);
}

// é€‰æ‹©åŸåˆ™ï¼š
// ğŸ”¸ é¢„æœŸä¼šå‡ºç°çš„ä¸šåŠ¡æƒ…å†µ â†’ ä½¿ç”¨è¿”å›å€¼
// ğŸ”¸ ä¸åº”è¯¥å‡ºç°çš„é”™è¯¯æƒ…å†µ â†’ ä½¿ç”¨å¼‚å¸¸
// ğŸ”¸ éœ€è¦ä¸­æ–­ç¨‹åºæµç¨‹çš„ â†’ ä½¿ç”¨å¼‚å¸¸
// ğŸ”¸ å¯ä»¥æ­£å¸¸å¤„ç†çš„ â†’ ä½¿ç”¨è¿”å›å€¼
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„è®¾è®¡åŸåˆ™


```
ğŸ”¸ å•ä¸€èŒè´£ï¼šæ¯ä¸ªServiceæ¥å£åªè´Ÿè´£ä¸€ä¸ªä¸šåŠ¡é¢†åŸŸ
ğŸ”¸ æ¥å£åˆ†ç¦»ï¼šå®šä¹‰æ¥å£ä¸å®ç°åˆ†ç¦»ï¼Œä¾¿äºæµ‹è¯•å’Œæ›¿æ¢
ğŸ”¸ è¯­ä¹‰æ¸…æ™°ï¼šæ–¹æ³•åè¦èƒ½å‡†ç¡®è¡¨è¾¾ä¸šåŠ¡å«ä¹‰
ğŸ”¸ å‚æ•°å°è£…ï¼šä½¿ç”¨DTOå°è£…å¤æ‚å‚æ•°ï¼Œé¿å…å‚æ•°è¿‡å¤š
ğŸ”¸ è¿”å›ç»Ÿä¸€ï¼šä½¿ç”¨ç»Ÿä¸€çš„è¿”å›ç»“æœæ ¼å¼
ğŸ”¸ å¼‚å¸¸æ˜ç¡®ï¼šå£°æ˜å¯èƒ½çš„å¼‚å¸¸ï¼Œå¸®åŠ©è°ƒç”¨è€…å¤„ç†
```

### 8.2 è®¾è®¡æ£€æŸ¥æ¸…å•


**æ¥å£è®¾è®¡è‡ªæ£€**ï¼š
- âœ… æ–¹æ³•åæ˜¯å¦æ¸…æ¥šè¡¨è¾¾äº†ä¸šåŠ¡å«ä¹‰ï¼Ÿ
- âœ… å‚æ•°æ˜¯å¦åˆç†å°è£…ï¼Œé¿å…äº†è¿‡å¤šå‚æ•°ï¼Ÿ
- âœ… è¿”å›å€¼æ˜¯å¦åŒ…å«äº†å¿…è¦çš„ä¿¡æ¯ï¼Ÿ
- âœ… å¼‚å¸¸å£°æ˜æ˜¯å¦è¦†ç›–äº†å¯èƒ½çš„é”™è¯¯åœºæ™¯ï¼Ÿ
- âœ… æ–¹æ³•ç²’åº¦æ˜¯å¦é€‚åˆè°ƒç”¨åœºæ™¯ï¼Ÿ

**å¸¸è§è®¾è®¡é—®é¢˜**ï¼š
- âŒ æ–¹æ³•åä½¿ç”¨æŠ€æœ¯æœ¯è¯­è€Œéä¸šåŠ¡æœ¯è¯­
- âŒ å‚æ•°è¿‡å¤šå¯¼è‡´è°ƒç”¨å¤æ‚
- âŒ è¿”å›å€¼ä¿¡æ¯ä¸è¶³ï¼Œæ— æ³•åˆ¤æ–­æ“ä½œç»“æœ
- âŒ æ²¡æœ‰è€ƒè™‘å¼‚å¸¸å¤„ç†
- âŒ æ–¹æ³•èŒè´£ä¸å•ä¸€ï¼Œåšäº†å¤ªå¤šäº‹æƒ…

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ä»éœ€æ±‚åˆ°æ¥å£çš„è®¾è®¡æµç¨‹**ï¼š

```
1. åˆ†æä¸šåŠ¡éœ€æ±‚
   â†“
2. è¯†åˆ«ä¸šåŠ¡é¢†åŸŸ
   â†“  
3. ç¡®å®šæ–¹æ³•ç²’åº¦
   â†“
4. è®¾è®¡å‚æ•°å’Œè¿”å›å€¼
   â†“
5. å£°æ˜å¯èƒ½çš„å¼‚å¸¸
   â†“
6. ç¼–å†™æ¥å£æ–‡æ¡£
```

**è®¾è®¡ç¤ºä¾‹**ï¼š
```java
// éœ€æ±‚ï¼šç”¨æˆ·æ³¨å†ŒåŠŸèƒ½
// 1. ä¸šåŠ¡é¢†åŸŸï¼šç”¨æˆ·ç®¡ç†
// 2. æ–¹æ³•ç²’åº¦ï¼šå®Œæ•´çš„æ³¨å†Œæµç¨‹
// 3. å‚æ•°ï¼šæ³¨å†Œä¿¡æ¯DTO
// 4. è¿”å›å€¼ï¼šæ³¨å†Œç»“æœ
// 5. å¼‚å¸¸ï¼šç”¨æˆ·å·²å­˜åœ¨å¼‚å¸¸

public interface UserService {
    /**
     * ç”¨æˆ·æ³¨å†Œ
     * @param registerDTO æ³¨å†Œä¿¡æ¯
     * @return æ³¨å†Œç»“æœï¼ŒåŒ…å«ç”¨æˆ·ä¿¡æ¯
     * @throws UserAlreadyExistsException ç”¨æˆ·åæˆ–é‚®ç®±å·²å­˜åœ¨
     * @throws InvalidEmailException é‚®ç®±æ ¼å¼ä¸æ­£ç¡®
     */
    ServiceResult<User> register(UserRegisterDTO registerDTO) 
        throws UserAlreadyExistsException, InvalidEmailException;
}
```

### 8.4 ä¸å…¶ä»–å±‚çš„åä½œ


**Serviceä¸Controllerçš„åä½œ**ï¼š
```java
@RestController
public class UserController {
    @Autowired
    private UserService userService;
    
    @PostMapping("/users/register")
    public ResponseEntity<?> register(@RequestBody UserRegisterDTO registerDTO) {
        try {
            ServiceResult<User> result = userService.register(registerDTO);
            if (result.isSuccess()) {
                return ResponseEntity.ok(result);
            } else {
                return ResponseEntity.badRequest().body(result);
            }
        } catch (UserAlreadyExistsException e) {
            return ResponseEntity.badRequest()
                .body(ServiceResult.fail(e.getMessage()));
        }
    }
}
```

**Serviceä¸Daoçš„åä½œ**ï¼š
```java
@Service
public class UserServiceImpl implements UserService {
    @Autowired
    private UserDao userDao;
    
    @Override
    public ServiceResult<User> register(UserRegisterDTO registerDTO) {
        // Serviceè´Ÿè´£ä¸šåŠ¡é€»è¾‘
        // Daoè´Ÿè´£æ•°æ®æ“ä½œ
        if (userDao.existsByUsername(registerDTO.getUsername())) {
            return ServiceResult.fail("ç”¨æˆ·åå·²å­˜åœ¨");
        }
        
        User user = convertToUser(registerDTO);
        User savedUser = userDao.save(user);
        
        return ServiceResult.success(savedUser);
    }
}
```

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- Serviceæ¥å£æ˜¯ä¸šåŠ¡é€»è¾‘çš„æŠ½è±¡è¡¨è¾¾
- å¥½çš„æ¥å£è®¾è®¡è®©ä»£ç è‡ªè§£é‡Š
- å‚æ•°å°è£…å’Œè¿”å›ç»Ÿä¸€æ˜¯å·¥ç¨‹åŒ–çš„åŸºç¡€
- å¼‚å¸¸å¤„ç†æ˜¯å¥å£®æ€§çš„ä¿éšœ
- æ¥å£è®¾è®¡è¦ç«™åœ¨è°ƒç”¨è€…è§’åº¦æ€è€ƒ