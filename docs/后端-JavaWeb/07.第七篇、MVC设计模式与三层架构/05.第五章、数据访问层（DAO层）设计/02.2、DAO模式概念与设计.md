---
title: 2ã€DAOæ¨¡å¼æ¦‚å¿µä¸è®¾è®¡
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯DAOè®¾è®¡æ¨¡å¼](#1-ä»€ä¹ˆæ˜¯DAOè®¾è®¡æ¨¡å¼)
2. [DAOæ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³](#2-DAOæ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³)
3. [DAOæ¥å£è®¾è®¡åŸåˆ™](#3-DAOæ¥å£è®¾è®¡åŸåˆ™)
4. [DAOå®ç°åˆ†ç¦»ç­–ç•¥](#4-DAOå®ç°åˆ†ç¦»ç­–ç•¥)
5. [æ•°æ®åº“æ— å…³æ€§å®ç°](#5-æ•°æ®åº“æ— å…³æ€§å®ç°)
6. [å·¥å‚æ¨¡å¼åœ¨DAOä¸­çš„åº”ç”¨](#6-å·¥å‚æ¨¡å¼åœ¨DAOä¸­çš„åº”ç”¨)
7. [ç­–ç•¥æ¨¡å¼ä¼˜åŒ–DAOè®¾è®¡](#7-ç­–ç•¥æ¨¡å¼ä¼˜åŒ–DAOè®¾è®¡)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ä»€ä¹ˆæ˜¯DAOè®¾è®¡æ¨¡å¼


### 1.1 DAOæ¨¡å¼çš„é€šä¿—è§£é‡Š


**ä»€ä¹ˆæ˜¯DAOï¼Ÿ** ğŸ¤”
```
DAO = Data Access Objectï¼ˆæ•°æ®è®¿é—®å¯¹è±¡ï¼‰

é€šä¿—æ¯”å–»ï¼š
DAOå°±åƒæ˜¯"æ•°æ®åº“ç®¡å®¶"
- ä½ æƒ³è¦ä»€ä¹ˆæ•°æ®ï¼Œå‘Šè¯‰ç®¡å®¶å°±è¡Œ
- ç®¡å®¶çŸ¥é“æ€ä¹ˆå»æ•°æ®åº“å–æ•°æ®
- ä½ ä¸ç”¨å…³å¿ƒæ•°æ®æ˜¯ä»MySQLè¿˜æ˜¯Oracleå–å‡ºæ¥çš„
- ç®¡å®¶å¤„ç†æ‰€æœ‰"è„æ´»ç´¯æ´»"ï¼Œç»™ä½ å¹²å‡€çš„ç»“æœ
```

**ä¸ºä»€ä¹ˆéœ€è¦DAOï¼Ÿ** ğŸ’­
```
æ²¡æœ‰DAOçš„ç—›è‹¦ï¼š
Controllerå±‚ â†’ ç›´æ¥å†™SQL â†’ æ•°æ®åº“
- SQLè¯­å¥åˆ°å¤„éƒ½æ˜¯ï¼Œå¾ˆä¹±
- æ¢ä¸ªæ•°æ®åº“è¦æ”¹Nå¤šåœ°æ–¹  
- ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®åº“æ“ä½œæ··åœ¨ä¸€èµ·
- ä»£ç é‡å¤ï¼Œç»´æŠ¤å›°éš¾

æœ‰äº†DAOçš„å¥½å¤„ï¼š
Controllerå±‚ â†’ DAOæ¥å£ â†’ DAOå®ç° â†’ æ•°æ®åº“
- ä¸šåŠ¡é€»è¾‘æ¸…çˆ½ï¼Œåªå…³å¿ƒ"è¦ä»€ä¹ˆæ•°æ®"
- æ•°æ®åº“æ“ä½œç»Ÿä¸€ç®¡ç†
- æ¢æ•°æ®åº“åªéœ€è¦æ¢DAOå®ç°
- ä»£ç å¤ç”¨æ€§å¼ºï¼Œç»´æŠ¤ç®€å•
```

### 1.2 DAOåœ¨ä¸‰å±‚æ¶æ„ä¸­çš„ä½ç½®


```
Webå±‚ï¼ˆè¡¨ç°å±‚ï¼‰
    â†“ è°ƒç”¨
Serviceå±‚ï¼ˆä¸šåŠ¡å±‚ï¼‰
    â†“ è°ƒç”¨  
DAOå±‚ï¼ˆæ•°æ®è®¿é—®å±‚ï¼‰ â† æˆ‘ä»¬åœ¨è¿™é‡Œï¼
    â†“ è®¿é—®
æ•°æ®åº“å±‚
```

**DAOå±‚çš„èŒè´£ï¼š** ğŸ¯
- ğŸ”¸ **ä¸“é—¨è´Ÿè´£æ•°æ®åº“æ“ä½œ**ï¼šå¢åˆ æ”¹æŸ¥ï¼ˆCRUDï¼‰
- ğŸ”¸ **å±è”½æ•°æ®åº“å·®å¼‚**ï¼šè®©ä¸Šå±‚ä¸ç”¨å…³å¿ƒç”¨çš„ä»€ä¹ˆæ•°æ®åº“
- ğŸ”¸ **æä¾›ç»Ÿä¸€æ¥å£**ï¼šserviceå±‚è°ƒç”¨æ—¶å°±åƒè°ƒç”¨æ™®é€šæ–¹æ³•
- ğŸ”¸ **å¤„ç†æ•°æ®è½¬æ¢**ï¼šæŠŠæ•°æ®åº“è®°å½•è½¬æˆJavaå¯¹è±¡

---

## 2. ğŸ’¡ DAOæ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³


### 2.1 æ¥å£ä¸å®ç°åˆ†ç¦»


**æ ¸å¿ƒæ€æƒ³ï¼šå®šä¹‰åšä»€ä¹ˆï¼Œåˆ†ç¦»æ€ä¹ˆåš** ğŸ¨

```java
// ğŸ“‹ å®šä¹‰"åšä»€ä¹ˆ" - DAOæ¥å£
public interface UserDao {
    User findById(int id);        // æˆ‘è¦æ ¹æ®IDæ‰¾ç”¨æˆ·
    List<User> findAll();         // æˆ‘è¦æ‰¾æ‰€æœ‰ç”¨æˆ·  
    void save(User user);         // æˆ‘è¦ä¿å­˜ç”¨æˆ·
    void delete(int id);          // æˆ‘è¦åˆ é™¤ç”¨æˆ·
}

// ğŸ”§ å®ç°"æ€ä¹ˆåš" - MySQLå®ç°
public class UserDaoMySQLImpl implements UserDao {
    // å…·ä½“çš„MySQLæ“ä½œä»£ç 
}

// ğŸ”§ å®ç°"æ€ä¹ˆåš" - Oracleå®ç°  
public class UserDaoOracleImpl implements UserDao {
    // å…·ä½“çš„Oracleæ“ä½œä»£ç 
}
```

**è¿™æ ·åšçš„å¥½å¤„ï¼š** âœ¨
- **ä¸šåŠ¡å±‚åªçœ‹æ¥å£**ï¼š`UserDao userDao = ?` ä¸ç®¡å…·ä½“å®ç°
- **éšæ—¶åˆ‡æ¢å®ç°**ï¼šMySQL â†’ Oracle åªéœ€è¦æ¢ä¸ªå®ç°ç±»
- **ä¾¿äºæµ‹è¯•**ï¼šå¯ä»¥å†™ä¸ªå‡çš„å®ç°ç±»ç”¨äºæµ‹è¯•
- **ä»£ç æ›´æ¸…æ™°**ï¼šæ¥å£è¡¨è¾¾ä¸šåŠ¡éœ€æ±‚ï¼Œå®ç°å¤„ç†æŠ€æœ¯ç»†èŠ‚

### 2.2 å•ä¸€èŒè´£åŸåˆ™


```
ä¸€ä¸ªDAOç±»åªè´Ÿè´£ä¸€ä¸ªå®ä½“çš„æ•°æ®æ“ä½œ

âœ… æ­£ç¡®åšæ³•ï¼š
UserDao     â†’ åªå¤„ç†Userç›¸å…³çš„æ•°æ®æ“ä½œ
ProductDao  â†’ åªå¤„ç†Productç›¸å…³çš„æ•°æ®æ“ä½œ  
OrderDao    â†’ åªå¤„ç†Orderç›¸å…³çš„æ•°æ®æ“ä½œ

âŒ é”™è¯¯åšæ³•ï¼š
AllDao â†’ å¤„ç†æ‰€æœ‰è¡¨çš„æ“ä½œï¼ˆå¤ªä¹±äº†ï¼ï¼‰
```

### 2.3 ä¾èµ–å€’ç½®åŸåˆ™


```
é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼Œéƒ½åº”è¯¥ä¾èµ–æŠ½è±¡

Serviceå±‚ï¼ˆé«˜å±‚ï¼‰â†’ ä¾èµ– â†’ DAOæ¥å£ï¼ˆæŠ½è±¡ï¼‰
                         â†‘
                    DAOå®ç°ç±»ï¼ˆä½å±‚ï¼‰
```

---

## 3. ğŸ“ DAOæ¥å£è®¾è®¡åŸåˆ™


### 3.1 æ ‡å‡†CRUDæ“ä½œè®¾è®¡


**åŸºç¡€æ“ä½œæ¨¡æ¿ï¼š** ğŸ“

```java
public interface BaseDao<T> {
    // ğŸ” æŸ¥è¯¢æ“ä½œ
    T findById(Integer id);
    List<T> findAll();
    List<T> findByCondition(Map<String, Object> params);
    
    // ğŸ’¾ ä¿å­˜æ“ä½œ
    void save(T entity);
    void update(T entity);
    
    // ğŸ—‘ï¸ åˆ é™¤æ“ä½œ
    void deleteById(Integer id);
    void delete(T entity);
    
    // ğŸ“Š ç»Ÿè®¡æ“ä½œ
    long count();
}
```

### 3.2 ä¸šåŠ¡ç›¸å…³æ–¹æ³•è®¾è®¡


**æ ¹æ®å…·ä½“ä¸šåŠ¡æ·»åŠ ç‰¹æ®Šæ–¹æ³•ï¼š** ğŸ¯

```java
public interface UserDao extends BaseDao<User> {
    // ğŸ” ç™»å½•ç›¸å…³
    User findByUsernameAndPassword(String username, String password);
    
    // ğŸ“§ é‚®ç®±ç›¸å…³
    User findByEmail(String email);
    boolean existsByEmail(String email);
    
    // ğŸ“Š ç»Ÿè®¡ç›¸å…³
    long countByStatus(String status);
    List<User> findActiveUsers();
}
```

### 3.3 æ–¹æ³•å‘½åè§„èŒƒ


| ğŸ¯ **æ“ä½œç±»å‹** | **å‘½åæ¨¡å¼** | **ç¤ºä¾‹** | **å«ä¹‰** |
|-------------|------------|---------|---------|
| ğŸ” **æŸ¥è¯¢å•ä¸ª** | `findBy...` | `findById(id)` | æ ¹æ®æ¡ä»¶æŸ¥æ‰¾ä¸€ä¸ª |
| ğŸ” **æŸ¥è¯¢å¤šä¸ª** | `findBy...` | `findByStatus(status)` | æ ¹æ®æ¡ä»¶æŸ¥æ‰¾å¤šä¸ª |
| ğŸ” **æŸ¥è¯¢æ‰€æœ‰** | `findAll` | `findAll()` | æŸ¥æ‰¾æ‰€æœ‰è®°å½• |
| âœ… **å­˜åœ¨åˆ¤æ–­** | `existsBy...` | `existsByEmail(email)` | åˆ¤æ–­æ˜¯å¦å­˜åœ¨ |
| ğŸ“Š **ç»Ÿè®¡æ•°é‡** | `countBy...` | `countByStatus(status)` | ç»Ÿè®¡æ•°é‡ |
| ğŸ’¾ **ä¿å­˜** | `save` | `save(user)` | ä¿å­˜å®ä½“ |
| ğŸ”„ **æ›´æ–°** | `update` | `update(user)` | æ›´æ–°å®ä½“ |
| ğŸ—‘ï¸ **åˆ é™¤** | `deleteBy...` | `deleteById(id)` | æ ¹æ®æ¡ä»¶åˆ é™¤ |

---

## 4. ğŸ”„ DAOå®ç°åˆ†ç¦»ç­–ç•¥


### 4.1 å®ç°ç±»å‘½åè§„èŒƒ


```java
æ¥å£åï¼šUserDao
å®ç°ç±»å‘½åæ¨¡å¼ï¼š
- UserDaoImpl         // é€šç”¨å®ç°
- UserDaoMySQLImpl    // MySQLä¸“ç”¨å®ç°  
- UserDaoJdbcImpl     // JDBCå®ç°
- UserDaoHibernateImpl // Hibernateå®ç°
```

### 4.2 åŸºç¡€JDBCå®ç°ç¤ºä¾‹


```java
public class UserDaoJdbcImpl implements UserDao {
    private DataSource dataSource;
    
    // ğŸ” æ ¹æ®IDæŸ¥è¯¢ç”¨æˆ·
    @Override
    public User findById(Integer id) {
        String sql = "SELECT * FROM user WHERE id = ?";
        try (Connection conn = dataSource.getConnection();
             PreparedStatement pstmt = conn.prepareStatement(sql)) {
            
            pstmt.setInt(1, id);
            ResultSet rs = pstmt.executeQuery();
            
            if (rs.next()) {
                return mapResultSetToUser(rs);
            }
            return null;
        } catch (SQLException e) {
            throw new RuntimeException("æŸ¥è¯¢ç”¨æˆ·å¤±è´¥", e);
        }
    }
    
    // ğŸ’¾ ä¿å­˜ç”¨æˆ·
    @Override
    public void save(User user) {
        String sql = "INSERT INTO user (username, email, password) VALUES (?, ?, ?)";
        try (Connection conn = dataSource.getConnection();
             PreparedStatement pstmt = conn.prepareStatement(sql)) {
            
            pstmt.setString(1, user.getUsername());
            pstmt.setString(2, user.getEmail());  
            pstmt.setString(3, user.getPassword());
            pstmt.executeUpdate();
            
        } catch (SQLException e) {
            throw new RuntimeException("ä¿å­˜ç”¨æˆ·å¤±è´¥", e);
        }
    }
    
    // ğŸ”„ ResultSetè½¬Userå¯¹è±¡çš„å·¥å…·æ–¹æ³•
    private User mapResultSetToUser(ResultSet rs) throws SQLException {
        User user = new User();
        user.setId(rs.getInt("id"));
        user.setUsername(rs.getString("username"));
        user.setEmail(rs.getString("email"));
        user.setPassword(rs.getString("password"));
        return user;
    }
}
```

### 4.3 ä¸åŒå®ç°çš„ç‰¹ç‚¹å¯¹æ¯”


| ğŸ”§ **å®ç°æ–¹å¼** | **ä¼˜ç‚¹** | **ç¼ºç‚¹** | **é€‚ç”¨åœºæ™¯** |
|-------------|---------|---------|-------------|
| ğŸŸ¢ **JDBC** | æ€§èƒ½é«˜ï¼Œæ§åˆ¶çµæ´» | ä»£ç ç¹çï¼ŒSQLç¡¬ç¼–ç  | æ€§èƒ½è¦æ±‚é«˜çš„åœºæ™¯ |
| ğŸŸ¡ **MyBatis** | SQLçµæ´»ï¼Œé…ç½®ç®€å• | éœ€è¦å†™SQL | å¤æ‚æŸ¥è¯¢è¾ƒå¤š |
| ğŸŸ  **Hibernate** | å¼€å‘æ•ˆç‡é«˜ï¼Œé¢å‘å¯¹è±¡ | æ€§èƒ½å¼€é”€å¤§ | å¿«é€Ÿå¼€å‘åœºæ™¯ |
| ğŸ”µ **JPA** | æ ‡å‡†åŒ–ï¼Œæ˜“è¿ç§» | å­¦ä¹ æˆæœ¬é«˜ | ä¼ä¸šçº§åº”ç”¨ |

---

## 5. ğŸŒ æ•°æ®åº“æ— å…³æ€§å®ç°


### 5.1 ä»€ä¹ˆæ˜¯æ•°æ®åº“æ— å…³æ€§


**æ•°æ®åº“æ— å…³æ€§çš„å«ä¹‰ï¼š** ğŸ­
```
ä½ çš„åº”ç”¨ç¨‹åºä¸åº”è¯¥"ç»‘å®š"åˆ°ç‰¹å®šçš„æ•°æ®åº“ä¸Š

æ¯”å¦‚ï¼š
ä»Šå¤©ç”¨MySQLå¼€å‘ â†’ æ˜å¤©è¦æ¢æˆOracle â†’ ä»£ç ä¸ç”¨å¤§æ”¹
ä»Šå¤©ç”¨Oracle â†’ æ˜å¤©è¦æ¢æˆPostgreSQL â†’ åªæ¢DAOå®ç°
```

### 5.2 å®ç°æ•°æ®åº“æ— å…³æ€§çš„æ–¹æ³•


**æ–¹æ³•ä¸€ï¼šæ ‡å‡†SQL + æ¥å£æŠ½è±¡** ğŸ“

```java
// ä½¿ç”¨æ ‡å‡†SQLï¼Œé¿å…æ•°æ®åº“ç‰¹æœ‰è¯­æ³•
public class UserDaoStandardImpl implements UserDao {
    
    @Override
    public List<User> findAll() {
        // âœ… æ ‡å‡†SQL - æ‰€æœ‰æ•°æ®åº“éƒ½æ”¯æŒ
        String sql = "SELECT id, username, email FROM user ORDER BY id";
        // å®ç°ä»£ç ...
    }
    
    @Override  
    public List<User> findByPage(int page, int size) {
        // âŒ é¿å…æ•°æ®åº“ç‰¹æœ‰çš„åˆ†é¡µè¯­æ³•
        // MySQL: LIMIT offset, count
        // Oracle: ROWNUM  
        // PostgreSQL: LIMIT count OFFSET offset
        
        // âœ… åœ¨DAOå®ç°ä¸­å¤„ç†ä¸åŒæ•°æ®åº“çš„åˆ†é¡µå·®å¼‚
        String sql = buildPageSql(page, size);
        // å®ç°ä»£ç ...
    }
}
```

**æ–¹æ³•äºŒï¼šé…ç½®é©±åŠ¨çš„æ•°æ®åº“åˆ‡æ¢** âš™ï¸

```properties
# application.properties
database.type=mysql
database.url=jdbc:mysql://localhost:3306/mydb
database.driver=com.mysql.cj.jdbc.Driver

# åˆ‡æ¢åˆ°Oracleåªéœ€è¦æ”¹é…ç½®
# database.type=oracle  
# database.url=jdbc:oracle:thin:@localhost:1521:xe
# database.driver=oracle.jdbc.driver.OracleDriver
```

### 5.3 æ•°æ®åº“å·®å¼‚å¤„ç†ç­–ç•¥


```java
public class DatabaseDialect {
    
    // ğŸ”§ æ ¹æ®æ•°æ®åº“ç±»å‹ç”Ÿæˆä¸åŒçš„åˆ†é¡µSQL
    public String buildPageSql(String baseSql, int page, int size, String dbType) {
        switch (dbType.toLowerCase()) {
            case "mysql":
                return baseSql + " LIMIT " + (page * size) + ", " + size;
            case "oracle": 
                return "SELECT * FROM (SELECT ROWNUM rn, t.* FROM (" + baseSql + 
                       ") t WHERE ROWNUM <= " + ((page + 1) * size) + 
                       ") WHERE rn > " + (page * size);
            case "postgresql":
                return baseSql + " LIMIT " + size + " OFFSET " + (page * size);
            default:
                throw new UnsupportedOperationException("ä¸æ”¯æŒçš„æ•°æ®åº“ç±»å‹: " + dbType);
        }
    }
}
```

---

## 6. ğŸ­ å·¥å‚æ¨¡å¼åœ¨DAOä¸­çš„åº”ç”¨


### 6.1 ä¸ºä»€ä¹ˆè¦ç”¨å·¥å‚æ¨¡å¼


**ä¸ç”¨å·¥å‚æ¨¡å¼çš„é—®é¢˜ï¼š** âŒ
```java
// Serviceå±‚ä»£ç ï¼Œç›´æ¥newå®ç°ç±»
public class UserService {
    private UserDao userDao = new UserDaoMySQLImpl(); // ç¡¬ç¼–ç ï¼
    
    // è¦æ¢æˆOracleï¼Ÿ è¦æ”¹ä»£ç ï¼
    // private UserDao userDao = new UserDaoOracleImpl();
}
```

**ä½¿ç”¨å·¥å‚æ¨¡å¼çš„å¥½å¤„ï¼š** âœ…
```java
// Serviceå±‚ä»£ç ï¼Œé€šè¿‡å·¥å‚è·å–
public class UserService {
    private UserDao userDao = DaoFactory.getUserDao(); // çµæ´»ï¼
    
    // æ¢æ•°æ®åº“ï¼Ÿ åªéœ€è¦æ”¹å·¥å‚é…ç½®ï¼
}
```

### 6.2 ç®€å•å·¥å‚å®ç°


```java
public class DaoFactory {
    private static String databaseType = "mysql"; // å¯ä»é…ç½®æ–‡ä»¶è¯»å–
    
    // ğŸ­ è·å–UserDaoå®ä¾‹
    public static UserDao getUserDao() {
        switch (databaseType) {
            case "mysql":
                return new UserDaoMySQLImpl();
            case "oracle":
                return new UserDaoOracleImpl();
            case "h2":
                return new UserDaoH2Impl(); // æµ‹è¯•ç”¨
            default:
                throw new RuntimeException("ä¸æ”¯æŒçš„æ•°æ®åº“ç±»å‹: " + databaseType);
        }
    }
    
    // ğŸ­ è·å–ProductDaoå®ä¾‹
    public static ProductDao getProductDao() {
        switch (databaseType) {
            case "mysql":
                return new ProductDaoMySQLImpl();
            case "oracle": 
                return new ProductDaoOracleImpl();
            default:
                throw new RuntimeException("ä¸æ”¯æŒçš„æ•°æ®åº“ç±»å‹: " + databaseType);
        }
    }
}
```

### 6.3 æŠ½è±¡å·¥å‚å®ç°


```java
// ğŸ­ æŠ½è±¡å·¥å‚æ¥å£
public interface DaoAbstractFactory {
    UserDao createUserDao();
    ProductDao createProductDao();
    OrderDao createOrderDao();
}

// ğŸ­ MySQLå·¥å‚å®ç°
public class MySQLDaoFactory implements DaoAbstractFactory {
    @Override
    public UserDao createUserDao() {
        return new UserDaoMySQLImpl();
    }
    
    @Override
    public ProductDao createProductDao() {
        return new ProductDaoMySQLImpl();
    }
    
    @Override
    public OrderDao createOrderDao() {
        return new OrderDaoMySQLImpl();
    }
}

// ğŸ­ Oracleå·¥å‚å®ç°
public class OracleDaoFactory implements DaoAbstractFactory {
    @Override
    public UserDao createUserDao() {
        return new UserDaoOracleImpl();
    }
    
    @Override
    public ProductDao createProductDao() {
        return new ProductDaoOracleImpl();
    }
    
    @Override
    public OrderDao createOrderDao() {
        return new OrderDaoOracleImpl();
    }
}
```

---

## 7. ğŸ¯ ç­–ç•¥æ¨¡å¼ä¼˜åŒ–DAOè®¾è®¡


### 7.1 ç­–ç•¥æ¨¡å¼è§£å†³ä»€ä¹ˆé—®é¢˜


**é—®é¢˜åœºæ™¯ï¼š** ğŸ¤”
```
åŒä¸€ä¸ªæ•°æ®æ“ä½œï¼Œå¯èƒ½æœ‰å¤šç§å®ç°ç­–ç•¥ï¼š
- æŸ¥è¯¢ç”¨æˆ·ï¼šå¯ä»¥ä»æ•°æ®åº“æŸ¥ï¼Œä¹Ÿå¯ä»¥ä»ç¼“å­˜æŸ¥  
- ä¿å­˜æ•°æ®ï¼šå¯ä»¥ç«‹å³ä¿å­˜ï¼Œä¹Ÿå¯ä»¥æ‰¹é‡ä¿å­˜
- åˆ é™¤æ“ä½œï¼šå¯ä»¥ç‰©ç†åˆ é™¤ï¼Œä¹Ÿå¯ä»¥é€»è¾‘åˆ é™¤

æ€ä¹ˆè®©è¿™äº›ç­–ç•¥å¯ä»¥è‡ªç”±åˆ‡æ¢ï¼Ÿ
```

### 7.2 ç­–ç•¥æ¨¡å¼å®ç°


```java
// ğŸ¯ æŸ¥è¯¢ç­–ç•¥æ¥å£
public interface QueryStrategy<T> {
    T execute(Object... params);
}

// ğŸ¯ æ•°æ®åº“æŸ¥è¯¢ç­–ç•¥
public class DatabaseQueryStrategy implements QueryStrategy<User> {
    @Override
    public User execute(Object... params) {
        Integer id = (Integer) params[0];
        // ä»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·
        return queryFromDatabase(id);
    }
}

// ğŸ¯ ç¼“å­˜æŸ¥è¯¢ç­–ç•¥  
public class CacheQueryStrategy implements QueryStrategy<User> {
    @Override
    public User execute(Object... params) {
        Integer id = (Integer) params[0];
        // å…ˆä»ç¼“å­˜æŸ¥è¯¢
        User user = queryFromCache(id);
        if (user == null) {
            // ç¼“å­˜æ²¡æœ‰ï¼Œä»æ•°æ®åº“æŸ¥è¯¢å¹¶æ”¾å…¥ç¼“å­˜
            user = queryFromDatabase(id);
            putToCache(id, user);
        }
        return user;
    }
}

// ğŸ¯ ä½¿ç”¨ç­–ç•¥çš„DAOå®ç°
public class UserDaoWithStrategy implements UserDao {
    private QueryStrategy<User> queryStrategy;
    
    // ğŸ”§ å¯ä»¥åŠ¨æ€è®¾ç½®æŸ¥è¯¢ç­–ç•¥
    public void setQueryStrategy(QueryStrategy<User> strategy) {
        this.queryStrategy = strategy;
    }
    
    @Override
    public User findById(Integer id) {
        return queryStrategy.execute(id);
    }
}
```

### 7.3 ç­–ç•¥æ¨¡å¼çš„å®é™…åº”ç”¨


```java
// ğŸ’¼ åœ¨Serviceä¸­ä½¿ç”¨
public class UserService {
    private UserDaoWithStrategy userDao;
    
    public User getUserById(Integer id) {
        // ğŸ¯ æ ¹æ®ä¸åŒæƒ…å†µé€‰æ‹©ä¸åŒç­–ç•¥
        if (isHighFrequencyQuery()) {
            // é«˜é¢‘æŸ¥è¯¢ç”¨ç¼“å­˜ç­–ç•¥
            userDao.setQueryStrategy(new CacheQueryStrategy());
        } else {
            // æ™®é€šæŸ¥è¯¢ç”¨æ•°æ®åº“ç­–ç•¥  
            userDao.setQueryStrategy(new DatabaseQueryStrategy());
        }
        
        return userDao.findById(id);
    }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ DAOæœ¬è´¨ï¼šæ•°æ®è®¿é—®å¯¹è±¡ï¼Œä¸“é—¨è´Ÿè´£æ•°æ®åº“æ“ä½œçš„"ç®¡å®¶"
ğŸ”¸ æ ¸å¿ƒæ€æƒ³ï¼šæ¥å£ä¸å®ç°åˆ†ç¦»ï¼Œä¸šåŠ¡é€»è¾‘ä¸æ•°æ®è®¿é—®åˆ†ç¦»  
ğŸ”¸ è®¾è®¡åŸåˆ™ï¼šå•ä¸€èŒè´£ã€ä¾èµ–å€’ç½®ã€å¼€é—­åŸåˆ™
ğŸ”¸ å‘½åè§„èŒƒï¼šfind/exists/count/save/update/delete + Byæ¡ä»¶
ğŸ”¸ å®ç°åˆ†ç¦»ï¼šä¸€ä¸ªæ¥å£å¤šä¸ªå®ç°ï¼Œæ ¹æ®éœ€è¦é€‰æ‹©
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆè¦ç”¨DAOæ¨¡å¼**
```
è§£å†³çš„æ ¸å¿ƒé—®é¢˜ï¼š
- ä¸šåŠ¡é€»è¾‘ä¸æ•°æ®è®¿é—®æ··åˆ â†’ èŒè´£åˆ†ç¦»
- SQLä»£ç åˆ°å¤„éƒ½æ˜¯ â†’ ç»Ÿä¸€ç®¡ç†
- æ•°æ®åº“å‚å•†ç»‘å®š â†’ å®ç°æ— å…³æ€§
- ä»£ç é‡å¤å†—ä½™ â†’ å¤ç”¨æ€§æå‡
```

**ğŸ”¹ æ¥å£è®¾è®¡çš„é‡è¦æ€§**
```
å¥½çš„æ¥å£è®¾è®¡ï¼š
- è¡¨è¾¾ä¸šåŠ¡æ„å›¾ï¼šfindActiveUsers() æ¯” findByStatus("active") æ›´æ¸…æ™°
- éšè—å®ç°ç»†èŠ‚ï¼šè°ƒç”¨æ–¹ä¸å…³å¿ƒæ˜¯MySQLè¿˜æ˜¯Oracle
- ä¾¿äºæ‰©å±•ï¼šæ–°å¢æ–¹æ³•ä¸å½±å“ç°æœ‰å®ç°
- åˆ©äºæµ‹è¯•ï¼šå¯ä»¥Mockæ¥å£è¿›è¡Œå•å…ƒæµ‹è¯•
```

**ğŸ”¹ å·¥å‚æ¨¡å¼çš„ä»·å€¼**
```
è§£å†³çš„é—®é¢˜ï¼š
- é¿å…Serviceå±‚ç¡¬ç¼–ç ä¾èµ–å…·ä½“å®ç°
- æ”¯æŒé…ç½®é©±åŠ¨çš„å®ç°åˆ‡æ¢  
- é›†ä¸­ç®¡ç†å¯¹è±¡åˆ›å»ºé€»è¾‘
- ä¾¿äºä¾èµ–æ³¨å…¥å’ŒIOCå®¹å™¨é›†æˆ
```

### 8.3 å®é™…å¼€å‘æŒ‡å¯¼


**ğŸ¯ DAOè®¾è®¡æœ€ä½³å®è·µ**
- âœ… ä¸€ä¸ªå®ä½“ä¸€ä¸ªDAOæ¥å£
- âœ… ç»§æ‰¿BaseDaoè·å¾—åŸºç¡€CRUDæ–¹æ³•
- âœ… æ ¹æ®ä¸šåŠ¡éœ€æ±‚æ·»åŠ ç‰¹æ®ŠæŸ¥è¯¢æ–¹æ³•
- âœ… ä½¿ç”¨å·¥å‚æ¨¡å¼ç®¡ç†DAOå®ä¾‹åˆ›å»º
- âœ… é€šè¿‡é…ç½®æ–‡ä»¶æ§åˆ¶å®ç°åˆ‡æ¢

**ğŸš€ æ€§èƒ½ä¼˜åŒ–å»ºè®®**
- âš¡ åˆç†è®¾è®¡æ‰¹é‡æ“ä½œæ–¹æ³•ï¼š`saveBatch(List<T>)`
- âš¡ æä¾›åˆ†é¡µæŸ¥è¯¢æ”¯æŒï¼š`findByPage(int page, int size)`
- âš¡ ç¼“å­˜å¸¸ç”¨æŸ¥è¯¢ç»“æœï¼šç»“åˆç­–ç•¥æ¨¡å¼å®ç°
- âš¡ ä½¿ç”¨è¿æ¥æ± ç®¡ç†æ•°æ®åº“è¿æ¥

**ğŸ”§ å¸¸è§é”™è¯¯é¿å…**
- âŒ ä¸è¦åœ¨DAOä¸­å†™ä¸šåŠ¡é€»è¾‘
- âŒ ä¸è¦è®©DAOä¾èµ–Serviceå±‚  
- âŒ ä¸è¦åœ¨æ¥å£ä¸­ä½¿ç”¨æ•°æ®åº“ç‰¹æœ‰ç±»å‹
- âŒ ä¸è¦å¿˜è®°å¤„ç†å¼‚å¸¸å’Œèµ„æºé‡Šæ”¾

### 8.4 å­¦ä¹ è¿›é˜¶è·¯çº¿


```
ğŸŸ¢ å…¥é—¨é˜¶æ®µï¼š
ç†è§£DAOæ¦‚å¿µ â†’ æ‰‹å†™JDBCå®ç° â†’ å­¦ä¼šæ¥å£è®¾è®¡

ğŸŸ¡ è¿›é˜¶é˜¶æ®µï¼š  
æŒæ¡å·¥å‚æ¨¡å¼ â†’ äº†è§£ç­–ç•¥æ¨¡å¼ â†’ å­¦ä¹ ORMæ¡†æ¶

ğŸ”´ é«˜çº§é˜¶æ®µï¼š
è®¾è®¡é€šç”¨BaseDao â†’ å®ç°æ•°æ®åº“æ— å…³æ€§ â†’ é›†æˆSpring IOC
```

**æ ¸å¿ƒè®°å¿†å£è¯€ï¼š**
```
DAOæ¨¡å¼èŒè´£æ¸…ï¼Œæ¥å£å®ç°è¦åˆ†ç¦»
å·¥å‚åˆ›å»ºå¥½ç®¡ç†ï¼Œç­–ç•¥åˆ‡æ¢æ›´çµæ´»  
æ•°æ®è®¿é—®ä¸“ä¸šåŒ–ï¼Œä¸šåŠ¡é€»è¾‘ä¸å‚ä¸
```