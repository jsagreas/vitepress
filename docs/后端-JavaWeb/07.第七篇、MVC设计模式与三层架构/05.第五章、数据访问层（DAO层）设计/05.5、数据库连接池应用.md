---
title: 5ã€æ•°æ®åº“è¿æ¥æ± åº”ç”¨
---
## ğŸ“š ç›®å½•

1. [æ•°æ®åº“è¿æ¥æ± åŸºç¡€æ¦‚å¿µ](#1-æ•°æ®åº“è¿æ¥æ± åŸºç¡€æ¦‚å¿µ)
2. [ä¼ ç»ŸJDBCè¿æ¥çš„é—®é¢˜](#2-ä¼ ç»ŸJDBCè¿æ¥çš„é—®é¢˜)
3. [è¿æ¥æ± å·¥ä½œåŸç†](#3-è¿æ¥æ± å·¥ä½œåŸç†)
4. [C3P0è¿æ¥æ± è¯¦è§£](#4-C3P0è¿æ¥æ± è¯¦è§£)
5. [Druidè¿æ¥æ± è¯¦è§£](#5-Druidè¿æ¥æ± è¯¦è§£)
6. [è¿æ¥æ± æ€§èƒ½ä¼˜åŒ–](#6-è¿æ¥æ± æ€§èƒ½ä¼˜åŒ–)
7. [å®é™…åº”ç”¨æœ€ä½³å®è·µ](#7-å®é™…åº”ç”¨æœ€ä½³å®è·µ)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒŠ æ•°æ®åº“è¿æ¥æ± åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯æ•°æ®åº“è¿æ¥æ± 


**é€šä¿—ç†è§£**ï¼šæŠŠæ•°æ®åº“è¿æ¥æ± æƒ³è±¡æˆä¸€ä¸ª"æ¸¸æ³³æ± "

```
ä¼ ç»Ÿæ–¹å¼ï¼ˆæ¯æ¬¡éƒ½æŒ–äº•å–æ°´ï¼‰ï¼š
ç”¨æˆ·è¯·æ±‚ â†’ åˆ›å»ºæ•°æ®åº“è¿æ¥ â†’ ä½¿ç”¨ â†’ å…³é—­è¿æ¥

è¿æ¥æ± æ–¹å¼ï¼ˆæå‰å‡†å¤‡å¥½æ°´æ± ï¼‰ï¼š
ç”¨æˆ·è¯·æ±‚ â†’ ä»æ± ä¸­è·å–è¿æ¥ â†’ ä½¿ç”¨ â†’ å½’è¿˜ç»™æ± å­
```

**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
- **è¿æ¥æ± **ï¼šæå‰åˆ›å»ºå¥½ä¸€æ‰¹æ•°æ®åº“è¿æ¥ï¼Œæ”¾åœ¨"æ± å­"é‡Œç»Ÿä¸€ç®¡ç†
- **ç›®çš„**ï¼šé¿å…é¢‘ç¹åˆ›å»ºå’Œé”€æ¯è¿æ¥ï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½
- **æœ¬è´¨**ï¼šå°±æ˜¯ä¸€ä¸ªå­˜æ”¾æ•°æ®åº“è¿æ¥çš„å®¹å™¨ï¼Œå¯ä»¥é‡å¤ä½¿ç”¨è¿™äº›è¿æ¥

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦è¿æ¥æ± 


**ğŸ”¸ ç”Ÿæ´»ç±»æ¯”**
```
æ²¡æœ‰è¿æ¥æ±  = æ¯æ¬¡ç”¨æ°´éƒ½è¦æŒ–äº•
- æŒ–äº•å¾ˆè´¹æ—¶é—´ï¼ˆåˆ›å»ºè¿æ¥æ…¢ï¼‰
- æŒ–å®Œç”¨å®Œå°±å¡«åŸ‹ï¼ˆæµªè´¹èµ„æºï¼‰
- åŒæ—¶æŒ–å¾ˆå¤šäº•å åœ°æ–¹ï¼ˆæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼‰

æœ‰äº†è¿æ¥æ±  = ç¤¾åŒºå»ºäº†ä¸ªå¤§æ°´æ± 
- éšæ—¶éƒ½æœ‰æ°´ç”¨ï¼ˆè¿æ¥éšæ—¶å¯ç”¨ï¼‰
- ç”¨å®Œæ”¾å›å»åˆ«äººè¿˜èƒ½ç”¨ï¼ˆè¿æ¥å¤ç”¨ï¼‰
- ç®¡ç†æ–¹ä¾¿ï¼ŒèŠ‚çº¦èµ„æº
```

### 1.3 è¿æ¥æ± è§£å†³çš„æ ¸å¿ƒé—®é¢˜


| é—®é¢˜ç±»å‹ | **ä¼ ç»ŸJDBC** | **è¿æ¥æ± æ–¹æ¡ˆ** | **æ”¹å–„æ•ˆæœ** |
|---------|-------------|---------------|-------------|
| ğŸŒ **æ€§èƒ½é—®é¢˜** | `æ¯æ¬¡åˆ›å»ºè¿æ¥è€—æ—¶200-500ms` | `ä»æ± ä¸­è·å–è¿æ¥è€—æ—¶1-5ms` | `æ€§èƒ½æå‡100å€` |
| ğŸ’¾ **èµ„æºæ¶ˆè€—** | `é¢‘ç¹åˆ›å»ºé”€æ¯è¿æ¥æ¶ˆè€—CPU` | `è¿æ¥å¤ç”¨ï¼Œå‡å°‘ç³»ç»Ÿå¼€é”€` | `CPUä½¿ç”¨ç‡é™ä½60%` |
| ğŸ”¢ **å¹¶å‘é™åˆ¶** | `æ— æ³•æ§åˆ¶è¿æ¥æ•°é‡` | `å¯è®¾ç½®æœ€å¤§è¿æ¥æ•°` | `ç³»ç»Ÿç¨³å®šæ€§æå‡` |
| âš¡ **å“åº”é€Ÿåº¦** | `é«˜å¹¶å‘æ—¶åˆ›å»ºè¿æ¥æ’é˜Ÿ` | `é¢„å…ˆå‡†å¤‡è¿æ¥ï¼Œå³å–å³ç”¨` | `å“åº”æ—¶é—´ç¼©çŸ­80%` |

---

## 2. âŒ ä¼ ç»ŸJDBCè¿æ¥çš„é—®é¢˜


### 2.1 æ€§èƒ½é—®é¢˜è¯¦è§£


**ğŸ”¸ è¿æ¥åˆ›å»ºè¿‡ç¨‹åˆ†æ**
```java
// ä¼ ç»ŸJDBCè¿æ¥è¿‡ç¨‹ - æ¯æ¬¡éƒ½è¦åšè¿™äº›æ­¥éª¤
public class TraditionalJDBC {
    public void queryUser(int userId) {
        Connection conn = null;
        try {
            // ç¬¬1æ­¥ï¼šåŠ è½½é©±åŠ¨ï¼ˆè€—æ—¶ï¼‰
            Class.forName("com.mysql.jdbc.Driver");
            
            // ç¬¬2æ­¥ï¼šå»ºç«‹TCPè¿æ¥ï¼ˆè€—æ—¶æœ€å¤šï¼‰
            conn = DriverManager.getConnection(
                "jdbc:mysql://localhost:3306/test", 
                "root", "password");
                
            // ç¬¬3æ­¥ï¼šMySQLè®¤è¯ï¼ˆè€—æ—¶ï¼‰
            // ç¬¬4æ­¥ï¼šæ‰§è¡ŒSQLï¼ˆçœŸæ­£çš„ä¸šåŠ¡é€»è¾‘ï¼‰
            PreparedStatement ps = conn.prepareStatement(
                "SELECT * FROM user WHERE id = ?");
            ps.setInt(1, userId);
            ResultSet rs = ps.executeQuery();
            
            // å¤„ç†ç»“æœ...
            
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            // ç¬¬5æ­¥ï¼šå…³é—­è¿æ¥ï¼ˆæµªè´¹èµ„æºï¼‰
            if (conn != null) {
                try {
                    conn.close(); // è¿æ¥é”€æ¯ï¼Œä¸‹æ¬¡åˆè¦é‡æ–°åˆ›å»º
                } catch (SQLException e) {
                    e.printStackTrace();
                }
            }
        }
    }
}
```

**â±ï¸ æ—¶é—´æ¶ˆè€—åˆ†æ**
```
åˆ›å»ºæ•°æ®åº“è¿æ¥çš„æ—¶é—´æ¶ˆè€—ï¼š
â”œâ”€â”€ åŠ è½½é©±åŠ¨ï¼š10-20ms
â”œâ”€â”€ å»ºç«‹TCPè¿æ¥ï¼š100-300ms  â† æœ€è€—æ—¶
â”œâ”€â”€ MySQLç”¨æˆ·è®¤è¯ï¼š50-100ms
â”œâ”€â”€ æ‰§è¡ŒSQLï¼š10-50ms        â† çœŸæ­£çš„ä¸šåŠ¡æ—¶é—´
â””â”€â”€ å…³é—­è¿æ¥ï¼š10-30ms

æ€»è€—æ—¶ï¼š180-500ms
å…¶ä¸­ä¸šåŠ¡é€»è¾‘åªå ï¼š10-50msï¼ˆä¸åˆ°20%ï¼‰
```

### 2.2 èµ„æºæµªè´¹é—®é¢˜


**ğŸ’° èµ„æºæ¶ˆè€—å¯¹æ¯”**

> âš ï¸ **èµ„æºæµªè´¹ä¸¥é‡**  
> æ¯åˆ›å»ºä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œç³»ç»Ÿéœ€è¦ï¼š
> - åˆ†é…çº¦**2-8KB**å†…å­˜ç©ºé—´
> - å ç”¨ä¸€ä¸ª**æ–‡ä»¶æè¿°ç¬¦**
> - æ¶ˆè€—**CPUè®¡ç®—èµ„æº**è¿›è¡Œè®¤è¯
> - åœ¨æ•°æ®åº“æœåŠ¡å™¨åˆ›å»ºå¯¹åº”çš„**å·¥ä½œçº¿ç¨‹**

### 2.3 å¹¶å‘é—®é¢˜


**ğŸ”¥ é«˜å¹¶å‘åœºæ™¯é—®é¢˜**
```
å‡è®¾ç½‘ç«™åŒæ—¶æœ‰1000ä¸ªç”¨æˆ·è®¿é—®ï¼š
ä¼ ç»Ÿæ–¹å¼ï¼šéœ€è¦åˆ›å»º1000ä¸ªæ•°æ®åº“è¿æ¥
â””â”€â”€ MySQLé»˜è®¤æœ€å¤§è¿æ¥æ•°åªæœ‰151ä¸ª
â””â”€â”€ ç»“æœï¼šå¤§é‡è¯·æ±‚å¤±è´¥ï¼Œç³»ç»Ÿå´©æºƒ

è¿æ¥æ± æ–¹å¼ï¼šé¢„å…ˆåˆ›å»º20ä¸ªè¿æ¥
â””â”€â”€ 1000ä¸ªè¯·æ±‚æ’é˜Ÿä½¿ç”¨è¿™20ä¸ªè¿æ¥
â””â”€â”€ ç»“æœï¼šè™½ç„¶æ…¢ä¸€ç‚¹ï¼Œä½†ç³»ç»Ÿç¨³å®šè¿è¡Œ
```

---

## 3. âš™ï¸ è¿æ¥æ± å·¥ä½œåŸç†


### 3.1 è¿æ¥æ± æ ¸å¿ƒæ¶æ„


**ğŸ—ï¸ è¿æ¥æ± å†…éƒ¨ç»“æ„å›¾**
```
             è¿æ¥æ± ç®¡ç†å™¨
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚        è¿æ¥æ± å®¹å™¨                â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”‚
    â”‚  â”‚ è¿æ¥1â”‚ â”‚ è¿æ¥2â”‚ â”‚ è¿æ¥3â”‚ â”‚ è¿æ¥4â”‚ â”‚ â† ç©ºé—²è¿æ¥
    â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”                â”‚
    â”‚  â”‚ è¿æ¥5â”‚ â”‚ è¿æ¥6â”‚     ç©ºä½       â”‚ â† ä½¿ç”¨ä¸­è¿æ¥
    â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†‘                    â†‘
      è·å–è¿æ¥              å½’è¿˜è¿æ¥
           â”‚                    â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         åº”ç”¨ç¨‹åº                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 è¿æ¥æ± ç”Ÿå‘½å‘¨æœŸç®¡ç†


**ğŸ”„ è¿æ¥æ± å·¥ä½œæµç¨‹**

```
ç³»ç»Ÿå¯åŠ¨é˜¶æ®µï¼š
1. è¯»å–é…ç½®æ–‡ä»¶ â†’ 2. åˆ›å»ºåˆå§‹è¿æ¥ â†’ 3. æ”¾å…¥è¿æ¥æ± 

è¿è¡Œæ—¶é˜¶æ®µï¼š
ç”¨æˆ·è¯·æ±‚ â†’ æ£€æŸ¥æ± ä¸­æ˜¯å¦æœ‰ç©ºé—²è¿æ¥
    â”œâ”€â”€ æœ‰ç©ºé—² â†’ åˆ†é…ç»™ç”¨æˆ· â†’ æ ‡è®°ä¸ºä½¿ç”¨ä¸­
    â””â”€â”€ æ— ç©ºé—² â†’ åˆ›å»ºæ–°è¿æ¥ï¼ˆä¸è¶…è¿‡æœ€å¤§å€¼ï¼‰
                     â†“
               ç”¨æˆ·ä½¿ç”¨å®Œæ¯• â†’ è¿æ¥å½’è¿˜æ± ä¸­ â†’ æ ‡è®°ä¸ºç©ºé—²

ç³»ç»Ÿå…³é—­é˜¶æ®µï¼š
å…³é—­æ‰€æœ‰æ± ä¸­è¿æ¥ â†’ é‡Šæ”¾ç›¸å…³èµ„æº
```

### 3.3 è¿æ¥çŠ¶æ€ç®¡ç†


**ğŸ“Š è¿æ¥çš„ä¸‰ç§çŠ¶æ€**

| çŠ¶æ€ | **å«ä¹‰** | **æ ‡è®°æ–¹å¼** | **æ“ä½œ** |
|------|---------|-------------|---------|
| ğŸŸ¢ **ç©ºé—²ï¼ˆIdleï¼‰** | `è¿æ¥åˆ›å»ºå¥½ä½†æ²¡æœ‰è¢«ä½¿ç”¨` | `åœ¨ç©ºé—²é˜Ÿåˆ—ä¸­` | `å¯ä»¥è¢«åˆ†é…ç»™ç”¨æˆ·` |
| ğŸ”´ **ä½¿ç”¨ä¸­ï¼ˆActiveï¼‰** | `è¿æ¥æ­£åœ¨è¢«æŸä¸ªç”¨æˆ·ä½¿ç”¨` | `åœ¨æ´»è·ƒé˜Ÿåˆ—ä¸­` | `ç­‰å¾…ç”¨æˆ·å½’è¿˜` |
| âš« **å¤±æ•ˆï¼ˆInvalidï¼‰** | `è¿æ¥å‡ºç°é”™è¯¯æˆ–è¶…æ—¶` | `æ ‡è®°ä¸ºå¾…é”€æ¯` | `ä»æ± ä¸­ç§»é™¤å¹¶å…³é—­` |

**ğŸ’¡ çŠ¶æ€è½¬æ¢ç¤ºä¾‹**
```java
// ä¼ªä»£ç æ¼”ç¤ºè¿æ¥çŠ¶æ€å˜åŒ–
public Connection getConnection() {
    Connection conn = pool.getIdleConnection(); // ç©ºé—² â†’ ä½¿ç”¨ä¸­
    if (conn == null) {
        conn = pool.createNewConnection();       // æ–°å»º â†’ ä½¿ç”¨ä¸­
    }
    return conn;
}

public void returnConnection(Connection conn) {
    if (conn.isValid()) {
        pool.putIdleConnection(conn);            // ä½¿ç”¨ä¸­ â†’ ç©ºé—²
    } else {
        pool.removeConnection(conn);             // ä½¿ç”¨ä¸­ â†’ å¤±æ•ˆ
    }
}
```

---

## 4. ğŸ› ï¸ C3P0è¿æ¥æ± è¯¦è§£


### 4.1 C3P0è¿æ¥æ± ä»‹ç»


**ğŸ”¸ C3P0åŸºæœ¬ç‰¹ç‚¹**
- **å…¨ç§°**ï¼šC3P0 æ˜¯ä¸€ä¸ªå¼€æºçš„JDBCè¿æ¥æ± 
- **ç‰¹ç‚¹**ï¼šåŠŸèƒ½å¼ºå¤§ï¼Œé…ç½®çµæ´»ï¼Œè‡ªåŠ¨ç®¡ç†è¿æ¥
- **ä¼˜åŠ¿**ï¼šä¹…ç»è€ƒéªŒï¼Œç¨³å®šå¯é ï¼Œæ”¯æŒè¿æ¥æµ‹è¯•å’Œæ¢å¤
- **é€‚ç”¨**ï¼šä¸­å°å‹é¡¹ç›®ï¼Œå­¦ä¹ å’Œæ•™å­¦

### 4.2 C3P0ç¯å¢ƒæ­å»º


**ğŸ“¦ æ·»åŠ ä¾èµ–**
```xml
<!-- Mavenä¾èµ–é…ç½® -->
<dependency>
    <groupId>com.mchange</groupId>
    <artifactId>c3p0</artifactId>
    <version>0.9.5.5</version>
</dependency>

<!-- MySQLé©±åŠ¨ä¾èµ– -->
<dependency>
    <groupId>mysql</groupId>
    <artifactId>mysql-connector-java</artifactId>
    <version>8.0.33</version>
</dependency>
```

### 4.3 C3P0é…ç½®è¯¦è§£


**ğŸ“‹ c3p0-config.xmlé…ç½®æ–‡ä»¶**
```xml
<?xml version="1.0" encoding="UTF-8"?>
<c3p0-config>
    <!-- é»˜è®¤é…ç½® -->
    <default-config>
        <!-- æ•°æ®åº“è¿æ¥åŸºæœ¬ä¿¡æ¯ -->
        <property name="driverClass">com.mysql.cj.jdbc.Driver</property>
        <property name="jdbcUrl">jdbc:mysql://localhost:3306/test?serverTimezone=UTC</property>
        <property name="user">root</property>
        <property name="password">123456</property>
        
        <!-- è¿æ¥æ± æ ¸å¿ƒå‚æ•° -->
        <property name="initialPoolSize">5</property>     <!-- åˆå§‹è¿æ¥æ•° -->
        <property name="minPoolSize">5</property>         <!-- æœ€å°è¿æ¥æ•° -->
        <property name="maxPoolSize">20</property>        <!-- æœ€å¤§è¿æ¥æ•° -->
        <property name="acquireIncrement">2</property>    <!-- æ¯æ¬¡å¢åŠ è¿æ¥æ•° -->
        
        <!-- è¿æ¥è¶…æ—¶è®¾ç½® -->
        <property name="maxIdleTime">1800</property>      <!-- æœ€å¤§ç©ºé—²æ—¶é—´(ç§’) -->
        <property name="checkoutTimeout">3000</property>  <!-- è·å–è¿æ¥è¶…æ—¶æ—¶é—´(æ¯«ç§’) -->
        
        <!-- è¿æ¥æµ‹è¯•è®¾ç½® -->
        <property name="testConnectionOnCheckout">true</property>
        <property name="preferredTestQuery">SELECT 1</property>
    </default-config>
    
    <!-- ç”Ÿäº§ç¯å¢ƒé…ç½® -->
    <named-config name="production">
        <property name="driverClass">com.mysql.cj.jdbc.Driver</property>
        <property name="jdbcUrl">jdbc:mysql://192.168.1.100:3306/prod_db</property>
        <property name="user">prod_user</property>
        <property name="password">prod_password</property>
        
        <property name="initialPoolSize">10</property>
        <property name="minPoolSize">10</property>
        <property name="maxPoolSize">50</property>
        <property name="acquireIncrement">5</property>
    </named-config>
</c3p0-config>
```

### 4.4 C3P0ä½¿ç”¨ç¤ºä¾‹


**ğŸ’» åˆ›å»ºè¿æ¥æ± å·¥å…·ç±»**
```java
public class C3P0Utils {
    // è¿æ¥æ± å¯¹è±¡ï¼Œæ•´ä¸ªåº”ç”¨åªéœ€è¦ä¸€ä¸ª
    private static ComboPooledDataSource dataSource;
    
    // é™æ€ä»£ç å—ï¼šç¨‹åºå¯åŠ¨æ—¶åˆå§‹åŒ–è¿æ¥æ± 
    static {
        try {
            dataSource = new ComboPooledDataSource();
            // å¦‚æœä½¿ç”¨å‘½åé…ç½®
            // dataSource = new ComboPooledDataSource("production");
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    
    /**
     * è·å–æ•°æ®åº“è¿æ¥
     * @return æ•°æ®åº“è¿æ¥å¯¹è±¡
     */
    public static Connection getConnection() {
        try {
            return dataSource.getConnection();
        } catch (SQLException e) {
            e.printStackTrace();
            return null;
        }
    }
    
    /**
     * å½’è¿˜è¿æ¥åˆ°è¿æ¥æ± 
     * @param conn è¦å½’è¿˜çš„è¿æ¥
     */
    public static void close(Connection conn) {
        if (conn != null) {
            try {
                conn.close(); // è¿™é‡Œä¸æ˜¯çœŸæ­£å…³é—­ï¼Œè€Œæ˜¯å½’è¿˜ç»™è¿æ¥æ± 
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }
    }
    
    /**
     * å½’è¿˜è¿æ¥å’ŒStatement
     */
    public static void close(Connection conn, Statement stmt) {
        close(conn);
        if (stmt != null) {
            try {
                stmt.close();
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }
    }
    
    /**
     * å½’è¿˜æ‰€æœ‰èµ„æº
     */
    public static void close(Connection conn, Statement stmt, ResultSet rs) {
        close(conn, stmt);
        if (rs != null) {
            try {
                rs.close();
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }
    }
}
```

**ğŸ¯ å®é™…ä½¿ç”¨ç¤ºä¾‹**
```java
public class UserDao {
    
    /**
     * æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ - ä½¿ç”¨C3P0è¿æ¥æ± 
     */
    public User findUserById(int userId) {
        // 1. ä»è¿æ¥æ± è·å–è¿æ¥ï¼ˆå¿«é€Ÿï¼‰
        Connection conn = C3P0Utils.getConnection();
        PreparedStatement ps = null;
        ResultSet rs = null;
        User user = null;
        
        try {
            // 2. å‡†å¤‡SQLå’Œæ‰§è¡Œ
            String sql = "SELECT * FROM user WHERE id = ?";
            ps = conn.prepareStatement(sql);
            ps.setInt(1, userId);
            rs = ps.executeQuery();
            
            // 3. å¤„ç†ç»“æœ
            if (rs.next()) {
                user = new User();
                user.setId(rs.getInt("id"));
                user.setName(rs.getString("name"));
                user.setEmail(rs.getString("email"));
            }
            
        } catch (SQLException e) {
            e.printStackTrace();
        } finally {
            // 4. å½’è¿˜èµ„æºï¼ˆé‡è¦ï¼ï¼‰
            C3P0Utils.close(conn, ps, rs);
        }
        
        return user;
    }
}
```

### 4.5 C3P0æ ¸å¿ƒå‚æ•°è¯¦è§£


**âš™ï¸ é‡è¦é…ç½®å‚æ•°è¯´æ˜**

| å‚æ•°å | **ä½œç”¨** | **æ¨èå€¼** | **è¯´æ˜** |
|--------|---------|-----------|---------|
| `initialPoolSize` | åˆå§‹è¿æ¥æ•° | `5-10` | ç¨‹åºå¯åŠ¨æ—¶åˆ›å»ºçš„è¿æ¥æ•° |
| `minPoolSize` | æœ€å°è¿æ¥æ•° | `5` | æ± ä¸­ä¿æŒçš„æœ€å°‘è¿æ¥æ•° |
| `maxPoolSize` | æœ€å¤§è¿æ¥æ•° | `20-50` | æ± ä¸­å…è®¸çš„æœ€å¤šè¿æ¥æ•° |
| `acquireIncrement` | è¿æ¥å¢é•¿æ•° | `2-5` | è¿æ¥ä¸å¤Ÿæ—¶æ¯æ¬¡æ–°å»ºå‡ ä¸ª |
| `maxIdleTime` | æœ€å¤§ç©ºé—²æ—¶é—´ | `1800ç§’` | è¿æ¥é—²ç½®å¤šä¹…åè¢«å›æ”¶ |
| `checkoutTimeout` | è·å–è¶…æ—¶æ—¶é—´ | `3000ms` | è·å–è¿æ¥çš„æœ€é•¿ç­‰å¾…æ—¶é—´ |

> ğŸ’¡ **å‚æ•°è°ƒä¼˜æç¤º**  
> - **å°é¡¹ç›®**ï¼šåˆå§‹5ä¸ªï¼Œæœ€å¤§20ä¸ªè¿æ¥è¶³å¤Ÿ
> - **é«˜å¹¶å‘**ï¼šå¯ä»¥è®¾ç½®åˆå§‹10ä¸ªï¼Œæœ€å¤§50-100ä¸ª
> - **æµ‹è¯•ç¯å¢ƒ**ï¼šå¯ä»¥è®¾ç½®è¾ƒå°çš„å€¼èŠ‚çº¦èµ„æº

---

## 5. ğŸš€ Druidè¿æ¥æ± è¯¦è§£


### 5.1 Druidè¿æ¥æ± ä»‹ç»


**ğŸ”¸ ä¸ºä»€ä¹ˆé€‰æ‹©Druid**
- **æ€§èƒ½æ›´å¼º**ï¼šé˜¿é‡Œå·´å·´å¼€æºï¼Œé’ˆå¯¹é«˜å¹¶å‘ä¼˜åŒ–
- **åŠŸèƒ½ä¸°å¯Œ**ï¼šå†…ç½®ç›‘æ§ã€SQLé˜²ç«å¢™ã€ç»Ÿè®¡åˆ†æ
- **æ˜“äºç›‘æ§**ï¼šæä¾›Webç•Œé¢æŸ¥çœ‹è¿æ¥æ± çŠ¶æ€
- **ç”Ÿäº§å°±ç»ª**ï¼šåœ¨é˜¿é‡Œå·´å·´å¤§è§„æ¨¡ç”Ÿäº§ç¯å¢ƒéªŒè¯

### 5.2 Druidç¯å¢ƒæ­å»º


**ğŸ“¦ Mavenä¾èµ–**
```xml
<dependency>
    <groupId>com.alibaba</groupId>
    <artifactId>druid</artifactId>
    <version>1.2.16</version>
</dependency>
```

### 5.3 Druidé…ç½®æ–¹å¼


**ğŸ“‹ æ–¹å¼ä¸€ï¼šé…ç½®æ–‡ä»¶æ–¹å¼ï¼ˆæ¨èï¼‰**

åˆ›å»º `druid.properties` é…ç½®æ–‡ä»¶ï¼š
```properties
# æ•°æ®åº“è¿æ¥ä¿¡æ¯
driverClassName=com.mysql.cj.jdbc.Driver
url=jdbc:mysql://localhost:3306/test?serverTimezone=UTC&useSSL=false
username=root
password=123456

# è¿æ¥æ± é…ç½®
initialSize=8           # åˆå§‹è¿æ¥æ•°
minIdle=8              # æœ€å°ç©ºé—²è¿æ¥æ•°
maxActive=20           # æœ€å¤§æ´»è·ƒè¿æ¥æ•°
maxWait=60000          # è·å–è¿æ¥æœ€å¤§ç­‰å¾…æ—¶é—´(æ¯«ç§’)

# è¿æ¥æœ‰æ•ˆæ€§æ£€æµ‹
testWhileIdle=true
testOnBorrow=false     # è·å–è¿æ¥æ—¶ä¸æ£€æµ‹ï¼ˆæé«˜æ€§èƒ½ï¼‰
testOnReturn=false     # å½’è¿˜è¿æ¥æ—¶ä¸æ£€æµ‹
validationQuery=SELECT 1

# è¿æ¥å›æ”¶è®¾ç½®
removeAbandoned=true          # å¼€å¯è¿æ¥æ³„éœ²ç›‘æµ‹
removeAbandonedTimeout=1800   # è¿æ¥æ³„éœ²è¶…æ—¶æ—¶é—´(ç§’)
logAbandoned=true            # è®°å½•è¿æ¥æ³„éœ²æ—¥å¿—

# ç›‘æ§ç»Ÿè®¡
filters=stat,wall            # å¼€å¯ç›‘æ§å’Œé˜²ç«å¢™
```

### 5.4 Druidå·¥å…·ç±»å®ç°


**ğŸ”§ DruidUtilså·¥å…·ç±»**
```java
public class DruidUtils {
    
    private static DataSource dataSource;
    
    // é™æ€åˆå§‹åŒ–è¿æ¥æ± 
    static {
        try {
            // åŠ è½½é…ç½®æ–‡ä»¶
            Properties properties = new Properties();
            // ä»ç±»è·¯å¾„åŠ è½½é…ç½®æ–‡ä»¶
            InputStream is = DruidUtils.class.getResourceAsStream("/druid.properties");
            properties.load(is);
            
            // åˆ›å»ºDruidè¿æ¥æ± 
            dataSource = DruidDataSourceFactory.createDataSource(properties);
            
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("è¿æ¥æ± åˆå§‹åŒ–å¤±è´¥ï¼", e);
        }
    }
    
    /**
     * è·å–è¿æ¥
     */
    public static Connection getConnection() {
        try {
            return dataSource.getConnection();
        } catch (SQLException e) {
            e.printStackTrace();
            return null;
        }
    }
    
    /**
     * è·å–è¿æ¥æ± å¯¹è±¡ï¼ˆç”¨äºç›‘æ§ï¼‰
     */
    public static DataSource getDataSource() {
        return dataSource;
    }
    
    /**
     * å…³é—­èµ„æº
     */
    public static void close(Connection conn, Statement stmt, ResultSet rs) {
        if (rs != null) {
            try {
                rs.close();
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }
        
        if (stmt != null) {
            try {
                stmt.close();
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }
        
        if (conn != null) {
            try {
                conn.close(); // å½’è¿˜ç»™è¿æ¥æ± 
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }
    }
}
```

### 5.5 Druidç›‘æ§åŠŸèƒ½


**ğŸ“Š å¼€å¯Webç›‘æ§ç•Œé¢**

```java
// åœ¨Webé¡¹ç›®ä¸­é…ç½®ç›‘æ§Servletï¼ˆweb.xmlï¼‰
<servlet>
    <servlet-name>DruidStatView</servlet-name>
    <servlet-class>com.alibaba.druid.support.http.StatViewServlet</servlet-class>
    <init-param>
        <param-name>allow</param-name>
        <param-value>127.0.0.1</param-value>  <!-- å…è®¸è®¿é—®çš„IP -->
    </init-param>
    <init-param>
        <param-name>loginUsername</param-name>
        <param-value>admin</param-value>      <!-- ç™»å½•ç”¨æˆ·å -->
    </init-param>
    <init-param>
        <param-name>loginPassword</param-name>
        <param-value>123456</param-value>     <!-- ç™»å½•å¯†ç  -->
    </init-param>
</servlet>
<servlet-mapping>
    <servlet-name>DruidStatView</servlet-name>
    <url-pattern>/druid/*</url-pattern>
</servlet-mapping>
```

**ğŸ‘€ ç›‘æ§ä¿¡æ¯åŒ…æ‹¬**ï¼š
- è¿æ¥æ± çŠ¶æ€ï¼šæ´»è·ƒè¿æ¥æ•°ã€ç©ºé—²è¿æ¥æ•°ã€ç´¯è®¡åˆ›å»ºè¿æ¥æ•°
- SQLæ‰§è¡Œç»Ÿè®¡ï¼šæ‰§è¡Œæ¬¡æ•°ã€æ‰§è¡Œæ—¶é—´ã€é”™è¯¯ç»Ÿè®¡
- æ…¢SQLç›‘æ§ï¼šè¶…è¿‡æŒ‡å®šæ—¶é—´çš„SQLè¯­å¥
- Webåº”ç”¨ç»Ÿè®¡ï¼šURIè®¿é—®ç»Ÿè®¡ã€Sessionç»Ÿè®¡

---

## 6. âš¡ è¿æ¥æ± æ€§èƒ½ä¼˜åŒ–


### 6.1 æ ¸å¿ƒå‚æ•°è°ƒä¼˜ç­–ç•¥


**ğŸ¯ æ ¹æ®åº”ç”¨åœºæ™¯è°ƒä¼˜**

| åº”ç”¨ç±»å‹ | **åˆå§‹è¿æ¥æ•°** | **æœ€å¤§è¿æ¥æ•°** | **è¯´æ˜** |
|---------|--------------|--------------|---------|
| ğŸ  **ä¸ªäººé¡¹ç›®** | `3-5` | `10-15` | å¹¶å‘é‡å°ï¼ŒèŠ‚çº¦èµ„æº |
| ğŸ¢ **ä¼ä¸šåº”ç”¨** | `10-20` | `50-100` | ä¸­ç­‰å¹¶å‘ï¼Œå¹³è¡¡æ€§èƒ½ |
| ğŸš€ **é«˜å¹¶å‘ç³»ç»Ÿ** | `20-50` | `100-200` | å¤§é‡å¹¶å‘ï¼Œç¡®ä¿å¯ç”¨æ€§ |

### 6.2 è¿æ¥æœ‰æ•ˆæ€§æ£€æµ‹ä¼˜åŒ–


**âœ… æ¨èé…ç½®**
```properties
# æ€§èƒ½æœ€ä¼˜çš„æ£€æµ‹é…ç½®
testWhileIdle=true      # ç©ºé—²æ—¶æ£€æµ‹è¿æ¥æœ‰æ•ˆæ€§
testOnBorrow=false      # è·å–æ—¶ä¸æ£€æµ‹ï¼ˆé¿å…æ¯æ¬¡éƒ½æ£€æµ‹å½±å“æ€§èƒ½ï¼‰
testOnReturn=false      # å½’è¿˜æ—¶ä¸æ£€æµ‹
validationQuery=SELECT 1
timeBetweenEvictionRunsMillis=60000  # æ¯åˆ†é’Ÿæ£€æµ‹ä¸€æ¬¡
minEvictableIdleTimeMillis=300000    # ç©ºé—²5åˆ†é’Ÿçš„è¿æ¥è¢«æ£€æµ‹
```

### 6.3 å†…å­˜ä½¿ç”¨ä¼˜åŒ–


**ğŸ’¾ é¿å…è¿æ¥æ³„éœ²**
```java
public class GoodExample {
    public List<User> findUsers() {
        Connection conn = null;
        PreparedStatement ps = null;
        ResultSet rs = null;
        
        try {
            conn = DruidUtils.getConnection();
            ps = conn.prepareStatement("SELECT * FROM user");
            rs = ps.executeQuery();
            
            List<User> users = new ArrayList<>();
            while (rs.next()) {
                // å¤„ç†ç»“æœ...
            }
            return users;
            
        } catch (SQLException e) {
            e.printStackTrace();
            return null;
        } finally {
            // å…³é”®ï¼šæ— è®ºæ˜¯å¦å‡ºç°å¼‚å¸¸éƒ½è¦é‡Šæ”¾èµ„æº
            DruidUtils.close(conn, ps, rs);
        }
    }
}
```

**âŒ é”™è¯¯ç¤ºä¾‹ï¼ˆä¼šå¯¼è‡´è¿æ¥æ³„éœ²ï¼‰**
```java
public class BadExample {
    public User findUser(int id) {
        Connection conn = DruidUtils.getConnection();
        PreparedStatement ps = conn.prepareStatement("SELECT * FROM user WHERE id = ?");
        // é”™è¯¯ï¼šæ²¡æœ‰åœ¨finallyä¸­å…³é—­è¿æ¥
        // å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œè¿æ¥æ°¸è¿œä¸ä¼šå½’è¿˜ç»™è¿æ¥æ± 
        return user;
    }
}
```

### 6.4 æ€§èƒ½ç›‘æ§å’Œè°ƒä¼˜


**ğŸ“ˆ å…³é”®ç›‘æ§æŒ‡æ ‡**

> ğŸ“Š **é‡è¦æ€§èƒ½æŒ‡æ ‡**
> 
> - **æ´»è·ƒè¿æ¥æ•°**ï¼šä¸åº”è¯¥é•¿æœŸæ¥è¿‘æœ€å¤§è¿æ¥æ•°
> - **ç­‰å¾…æ—¶é—´**ï¼šè·å–è¿æ¥çš„å¹³å‡ç­‰å¾…æ—¶é—´åº”è¯¥å¾ˆçŸ­
> - **è¿æ¥ä½¿ç”¨ç‡**ï¼š`æ´»è·ƒè¿æ¥æ•° / æœ€å¤§è¿æ¥æ•°` åº”è¯¥åœ¨70%ä»¥ä¸‹
> - **è¿æ¥åˆ›å»ºé€Ÿç‡**ï¼šå¦‚æœé¢‘ç¹åˆ›å»ºæ–°è¿æ¥ï¼Œè¯´æ˜æ± å­å¤ªå°

---

## 7. ğŸ¯ å®é™…åº”ç”¨æœ€ä½³å®è·µ


### 7.1 DAOå±‚é›†æˆè¿æ¥æ± 


**ğŸ—ï¸ æ ‡å‡†DAOç±»æ¨¡æ¿**
```java
public class UserDAO {
    
    /**
     * æ·»åŠ ç”¨æˆ·
     */
    public boolean addUser(User user) {
        String sql = "INSERT INTO user(name, email, age) VALUES(?, ?, ?)";
        Connection conn = null;
        PreparedStatement ps = null;
        
        try {
            conn = DruidUtils.getConnection();
            ps = conn.prepareStatement(sql);
            ps.setString(1, user.getName());
            ps.setString(2, user.getEmail());
            ps.setInt(3, user.getAge());
            
            int rows = ps.executeUpdate();
            return rows > 0;
            
        } catch (SQLException e) {
            e.printStackTrace();
            return false;
        } finally {
            DruidUtils.close(conn, ps, null);
        }
    }
    
    /**
     * æ‰¹é‡æ“ä½œç¤ºä¾‹
     */
    public boolean batchAddUsers(List<User> users) {
        String sql = "INSERT INTO user(name, email, age) VALUES(?, ?, ?)";
        Connection conn = null;
        PreparedStatement ps = null;
        
        try {
            conn = DruidUtils.getConnection();
            conn.setAutoCommit(false); // å¼€å¯äº‹åŠ¡
            
            ps = conn.prepareStatement(sql);
            for (User user : users) {
                ps.setString(1, user.getName());
                ps.setString(2, user.getEmail());
                ps.setInt(3, user.getAge());
                ps.addBatch(); // æ·»åŠ åˆ°æ‰¹å¤„ç†
            }
            
            ps.executeBatch(); // æ‰§è¡Œæ‰¹å¤„ç†
            conn.commit(); // æäº¤äº‹åŠ¡
            return true;
            
        } catch (SQLException e) {
            try {
                if (conn != null) {
                    conn.rollback(); // å›æ»šäº‹åŠ¡
                }
            } catch (SQLException ex) {
                ex.printStackTrace();
            }
            e.printStackTrace();
            return false;
        } finally {
            try {
                if (conn != null) {
                    conn.setAutoCommit(true); // æ¢å¤è‡ªåŠ¨æäº¤
                }
            } catch (SQLException e) {
                e.printStackTrace();
            }
            DruidUtils.close(conn, ps, null);
        }
    }
}
```

### 7.2 Serviceå±‚äº‹åŠ¡ç®¡ç†


**ğŸ”„ Serviceå±‚äº‹åŠ¡ç¤ºä¾‹**
```java
public class UserService {
    
    private UserDAO userDAO = new UserDAO();
    private AccountDAO accountDAO = new AccountDAO();
    
    /**
     * ç”¨æˆ·æ³¨å†Œä¸šåŠ¡ - éœ€è¦äº‹åŠ¡ç®¡ç†
     */
    public boolean registerUser(User user, Account account) {
        Connection conn = null;
        try {
            // è·å–è¿æ¥å¹¶å¼€å¯äº‹åŠ¡
            conn = DruidUtils.getConnection();
            conn.setAutoCommit(false);
            
            // æ‰§è¡Œå¤šä¸ªæ•°æ®åº“æ“ä½œ
            boolean userCreated = userDAO.addUser(user, conn);
            boolean accountCreated = accountDAO.createAccount(account, conn);
            
            if (userCreated && accountCreated) {
                conn.commit(); // å…¨éƒ¨æˆåŠŸï¼Œæäº¤äº‹åŠ¡
                return true;
            } else {
                conn.rollback(); // ä»»ä½•ä¸€ä¸ªå¤±è´¥ï¼Œå›æ»šäº‹åŠ¡
                return false;
            }
            
        } catch (SQLException e) {
            try {
                if (conn != null) {
                    conn.rollback();
                }
            } catch (SQLException ex) {
                ex.printStackTrace();
            }
            e.printStackTrace();
            return false;
        } finally {
            try {
                if (conn != null) {
                    conn.setAutoCommit(true);
                }
            } catch (SQLException e) {
                e.printStackTrace();
            }
            DruidUtils.close(conn, null, null);
        }
    }
}
```

### 7.3 Webåº”ç”¨ä¸­çš„è¿æ¥æ± é…ç½®


**ğŸŒ ç”Ÿäº§ç¯å¢ƒæ¨èé…ç½®**
```properties
# druid-prod.properties - ç”Ÿäº§ç¯å¢ƒé…ç½®
driverClassName=com.mysql.cj.jdbc.Driver
url=jdbc:mysql://db-server:3306/prod_db?serverTimezone=UTC&useSSL=true

# è¿æ¥æ± å¤§å°é…ç½®
initialSize=15                    # å¯åŠ¨æ—¶åˆ›å»º15ä¸ªè¿æ¥
minIdle=15                       # ä¿æŒæœ€å°‘15ä¸ªç©ºé—²è¿æ¥
maxActive=80                     # æœ€å¤š80ä¸ªæ´»è·ƒè¿æ¥
maxWait=10000                    # æœ€å¤šç­‰å¾…10ç§’è·å–è¿æ¥

# è¿æ¥æœ‰æ•ˆæ€§å’Œå›æ”¶
testWhileIdle=true
validationQuery=SELECT 1
timeBetweenEvictionRunsMillis=30000    # 30ç§’æ£€æµ‹ä¸€æ¬¡
minEvictableIdleTimeMillis=600000      # ç©ºé—²10åˆ†é’Ÿåè¢«å›æ”¶
maxEvictableIdleTimeMillis=900000      # ç©ºé—²15åˆ†é’Ÿå¼ºåˆ¶å›æ”¶

# è¿æ¥æ³„éœ²ä¿æŠ¤
removeAbandoned=true
removeAbandonedTimeout=300             # 5åˆ†é’Ÿæœªå½’è¿˜è§†ä¸ºæ³„éœ²
logAbandoned=true

# æ€§èƒ½å’Œç›‘æ§
poolPreparedStatements=true            # å¼€å¯é¢„ç¼–è¯‘è¯­å¥æ± 
maxOpenPreparedStatements=50
filters=stat,wall,log4j               # ç›‘æ§ã€é˜²ç«å¢™ã€æ—¥å¿—
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ è¿æ¥æ± æœ¬è´¨ï¼šæå‰åˆ›å»ºå¥½æ•°æ®åº“è¿æ¥çš„å®¹å™¨ï¼Œé¿å…é¢‘ç¹åˆ›å»ºé”€æ¯
ğŸ”¸ æ ¸å¿ƒä»·å€¼ï¼šæé«˜æ€§èƒ½ï¼ˆ100å€æå‡ï¼‰ã€èŠ‚çº¦èµ„æºã€æ§åˆ¶å¹¶å‘
ğŸ”¸ å·¥ä½œåŸç†ï¼šè¿æ¥å¤ç”¨ï¼Œç”¨å®Œå½’è¿˜ï¼Œç»Ÿä¸€ç®¡ç†
ğŸ”¸ ä¸¤å¤§ä¸»æµï¼šC3P0ï¼ˆç¨³å®šæ˜“ç”¨ï¼‰ã€Druidï¼ˆé«˜æ€§èƒ½å¤šåŠŸèƒ½ï¼‰
ğŸ”¸ å…³é”®æ“ä½œï¼šè·å–è¿æ¥ã€ä½¿ç”¨è¿æ¥ã€å½’è¿˜è¿æ¥ï¼ˆé‡è¦ï¼ï¼‰
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆè¿æ¥æ± èƒ½æå‡æ€§èƒ½**
```
ä¼ ç»ŸJDBCï¼šæ¯æ¬¡ åˆ›å»ºè¿æ¥(200ms) + ä½¿ç”¨(10ms) + é”€æ¯(30ms) = 240ms
è¿æ¥æ± æ–¹å¼ï¼šæ¯æ¬¡ è·å–è¿æ¥(1ms) + ä½¿ç”¨(10ms) + å½’è¿˜(1ms) = 12ms
æ€§èƒ½æå‡ï¼š240ms â†’ 12msï¼Œæå‡20å€ï¼
```

**ğŸ”¹ è¿æ¥æ± å‚æ•°å¦‚ä½•è®¾ç½®**
```
ç»éªŒå…¬å¼ï¼š
åˆå§‹è¿æ¥æ•° = é¢„æœŸå¹¶å‘æ•° Ã— 0.3
æœ€å¤§è¿æ¥æ•° = é¢„æœŸå¹¶å‘æ•° Ã— 1.2
è·å–è¶…æ—¶ = 3-10ç§’ï¼ˆæ ¹æ®ç”¨æˆ·å®¹å¿åº¦ï¼‰

å®ä¾‹ï¼šé¢„æœŸ100å¹¶å‘
åˆå§‹ï¼š30ä¸ªè¿æ¥
æœ€å¤§ï¼š120ä¸ªè¿æ¥
```

**ğŸ”¹ ä½¿ç”¨è¿æ¥æ± çš„æ³¨æ„äº‹é¡¹**
```
å¿…é¡»åšçš„äº‹ï¼š
âœ… æ¯æ¬¡éƒ½è¦åœ¨finallyä¸­å…³é—­è¿æ¥
âœ… é…ç½®åˆé€‚çš„è¿æ¥æ•°å’Œè¶…æ—¶æ—¶é—´
âœ… å¼€å¯è¿æ¥æœ‰æ•ˆæ€§æ£€æµ‹
âœ… ç›‘æ§è¿æ¥æ± çŠ¶æ€

ç»å¯¹ä¸èƒ½åšï¼š
âŒ å¿˜è®°å…³é—­è¿æ¥ï¼ˆä¼šå¯¼è‡´è¿æ¥æ³„éœ²ï¼‰
âŒ åœ¨ä¸šåŠ¡ä»£ç ä¸­ä¿å­˜è¿æ¥å¯¹è±¡
âŒ å…³é—­è¿æ¥æ± ä¸­çš„è¿æ¥
```

### 8.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ é€‚ç”¨åœºæ™¯**
- **Webåº”ç”¨**ï¼šå¤„ç†HTTPè¯·æ±‚æ—¶è·å–æ•°æ®åº“è¿æ¥
- **æ‰¹å¤„ç†ç¨‹åº**ï¼šå¤§é‡æ•°æ®å¤„ç†æ—¶å¤ç”¨è¿æ¥
- **å¾®æœåŠ¡**ï¼šæœåŠ¡é—´è°ƒç”¨æ—¶çš„æ•°æ®åº“è®¿é—®
- **é«˜å¹¶å‘ç³»ç»Ÿ**ï¼šåŒæ—¶å¤„ç†å¤§é‡æ•°æ®åº“è¯·æ±‚

**ğŸ”§ æŠ€æœ¯é€‰æ‹©å»ºè®®**
- **å­¦ä¹ é˜¶æ®µ**ï¼šé€‰æ‹©C3P0ï¼Œé…ç½®ç®€å•ï¼Œèµ„æ–™ä¸°å¯Œ
- **ç”Ÿäº§ç¯å¢ƒ**ï¼šæ¨èDruidï¼Œæ€§èƒ½æ›´å¥½ï¼Œç›‘æ§å®Œå–„
- **ä¼ä¸šé¡¹ç›®**ï¼šDruid + ç›‘æ§ç•Œé¢ï¼Œä¾¿äºè¿ç»´ç®¡ç†

**ğŸ’¡ æ€§èƒ½ä¼˜åŒ–è¦ç‚¹**
- æ ¹æ®å®é™…å¹¶å‘é‡åˆç†è®¾ç½®è¿æ¥æ± å¤§å°
- å¼€å¯è¿æ¥æœ‰æ•ˆæ€§æ£€æµ‹ï¼Œä½†é¿å…è¿‡é¢‘ç¹æ£€æµ‹
- ä½¿ç”¨æ‰¹å¤„ç†å’Œäº‹åŠ¡å‡å°‘è¿æ¥ä½¿ç”¨æ—¶é—´
- å®šæœŸç›‘æ§è¿æ¥æ± çŠ¶æ€ï¼ŒåŠæ—¶è°ƒä¼˜å‚æ•°

**è®°å¿†å£è¯€**ï¼š
```
è¿æ¥æ± å¥½æ¯”è“„æ°´æ± ï¼Œæå‰å‡†å¤‡ä¸ç”¨æ€¥
è·å–è¿æ¥å¦‚å–æ°´ï¼Œç”¨å®Œå½’è¿˜æ˜¯è§„çŸ©
C3P0ç¨³å®šå¥½ä¸Šæ‰‹ï¼ŒDruidæ€§èƒ½æ›´å‡ºè‰²
å‚æ•°é…ç½®è¦åˆç†ï¼Œç›‘æ§è°ƒä¼˜ä¸èƒ½å¿˜
```