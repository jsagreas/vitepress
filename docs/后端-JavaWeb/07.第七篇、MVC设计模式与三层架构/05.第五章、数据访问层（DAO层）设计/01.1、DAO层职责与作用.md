---
title: 1ã€DAOå±‚èŒè´£ä¸ä½œç”¨
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯DAOå±‚](#1-ä»€ä¹ˆæ˜¯daoå±‚)
2. [DAOå±‚çš„æ ¸å¿ƒèŒè´£](#2-daoå±‚çš„æ ¸å¿ƒèŒè´£)
3. [CRUDæ“ä½œè¯¦è§£](#3-crudæ“ä½œè¯¦è§£)
4. [DAOå±‚è®¾è®¡æ¨¡å¼](#4-daoå±‚è®¾è®¡æ¨¡å¼)
5. [æ•°æ®æŒä¹…åŒ–åŸç†](#5-æ•°æ®æŒä¹…åŒ–åŸç†)
6. [å®é™…å¼€å‘ç¤ºä¾‹](#6-å®é™…å¼€å‘ç¤ºä¾‹)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ä»€ä¹ˆæ˜¯DAOå±‚


### 1.1 DAOçš„é€šä¿—ç†è§£


**ğŸ”¸ ç”Ÿæ´»ä¸­çš„ç±»æ¯”**
```
æƒ³è±¡ä½ è¦å»é“¶è¡ŒåŠä¸šåŠ¡ï¼š
ä½ ï¼ˆä¸šåŠ¡å±‚ï¼‰â†” é“¶è¡ŒæŸœå‘˜ï¼ˆDAOå±‚ï¼‰â†” é“¶è¡Œé‡‘åº“ï¼ˆæ•°æ®åº“ï¼‰

ä½ ä¸èƒ½ç›´æ¥è¿›é‡‘åº“æ‹¿é’±ï¼Œå¿…é¡»é€šè¿‡æŸœå‘˜
æŸœå‘˜ä¸“é—¨è´Ÿè´£ï¼šå­˜é’±ã€å–é’±ã€æŸ¥ä½™é¢ã€è½¬è´¦
è¿™å°±æ˜¯DAOçš„ä½œç”¨ï¼
```

**ğŸ“‹ DAOçš„æ­£å¼å®šä¹‰**
- **DAO**ï¼šData Access Objectï¼ˆæ•°æ®è®¿é—®å¯¹è±¡ï¼‰
- **æœ¬è´¨**ï¼šä¸“é—¨è´Ÿè´£ä¸æ•°æ®åº“æ‰“äº¤é“çš„ä¸€å±‚
- **ä½œç”¨**ï¼šæŠŠå¤æ‚çš„æ•°æ®åº“æ“ä½œåŒ…è£…æˆç®€å•çš„æ–¹æ³•è°ƒç”¨

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦DAOå±‚


**ğŸš« æ²¡æœ‰DAOå±‚çš„é—®é¢˜**
```
ä¸šåŠ¡ä»£ç ä¸­ç›´æ¥å†™SQLï¼š

public class UserService {
    public User getUserById(int id) {
        // ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®åº“ä»£ç æ··åœ¨ä¸€èµ·ï¼Œå¾ˆä¹±ï¼
        Connection conn = DriverManager.getConnection(...);
        PreparedStatement ps = conn.prepareStatement("SELECT * FROM users WHERE id=?");
        ps.setInt(1, id);
        ResultSet rs = ps.executeQuery();
        // ... è¿˜è¦å¤„ç†ç»“æœé›†è½¬æ¢
    }
}

é—®é¢˜ï¼š
âŒ ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®è®¿é—®æ··ä¹±
âŒ SQLæ•£è½åœ¨å„å¤„ï¼Œéš¾ä»¥ç»´æŠ¤
âŒ é‡å¤ä»£ç å¤ªå¤š
âŒ æ•°æ®åº“è¿æ¥ç®¡ç†æ··ä¹±
```

**âœ… æœ‰DAOå±‚çš„å¥½å¤„**
```
æ¸…æ™°çš„åˆ†å·¥ï¼š

public class UserService {           // ä¸šåŠ¡å±‚ï¼šåªå…³å¿ƒä¸šåŠ¡é€»è¾‘
    private UserDAO userDAO;
    
    public User getUserById(int id) {
        return userDAO.findById(id);  // ç®€å•è°ƒç”¨ï¼Œä¸éœ€è¦çŸ¥é“SQLç»†èŠ‚
    }
}

public class UserDAO {               // DAOå±‚ï¼šä¸“é—¨å¤„ç†æ•°æ®åº“æ“ä½œ
    public User findById(int id) {
        // æ‰€æœ‰SQLå’Œæ•°æ®åº“æ“ä½œéƒ½åœ¨è¿™é‡Œ
    }
}

ä¼˜åŠ¿ï¼š
âœ… èŒè´£åˆ†ç¦»ï¼Œä»£ç æ¸…æ™°
âœ… SQLé›†ä¸­ç®¡ç†
âœ… å¤ç”¨æ€§å¼º
âœ… ä¾¿äºæµ‹è¯•å’Œç»´æŠ¤
```

### 1.3 DAOå±‚åœ¨ä¸‰å±‚æ¶æ„ä¸­çš„ä½ç½®


```
ç”¨æˆ·è¯·æ±‚å¤„ç†æµç¨‹ï¼š

æµè§ˆå™¨è¯·æ±‚
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è¡¨ç¤ºå±‚(View)   â”‚  â† JSPã€Servletå¤„ç†ç”¨æˆ·ç•Œé¢
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸šåŠ¡é€»è¾‘å±‚(BLL) â”‚  â† Serviceå¤„ç†ä¸šåŠ¡è§„åˆ™
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®è®¿é—®å±‚(DAL) â”‚  â† DAOå¤„ç†æ•°æ®åº“æ“ä½œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
  æ•°æ®åº“(MySQL)
```

---

## 2. âš™ï¸ DAOå±‚çš„æ ¸å¿ƒèŒè´£


### 2.1 ä¸»è¦èŒè´£ä¸€è§ˆè¡¨


| èŒè´£ç±»å‹ | **å…·ä½“ä»»åŠ¡** | **é€šä¿—è§£é‡Š** | **ä»£ç ä½“ç°** |
|---------|------------|-------------|-------------|
| ğŸ” **æ•°æ®æŸ¥è¯¢** | `ä»æ•°æ®åº“è¯»å–æ•°æ®` | `å»ä»“åº“æ‰¾ä¸œè¥¿` | `findById()ã€findAll()` |
| â• **æ•°æ®æ’å…¥** | `å‘æ•°æ®åº“æ·»åŠ æ–°è®°å½•` | `å¾€ä»“åº“æ”¾æ–°ä¸œè¥¿` | `save()ã€insert()` |
| âœï¸ **æ•°æ®æ›´æ–°** | `ä¿®æ”¹æ•°æ®åº“ä¸­çš„è®°å½•` | `æ›´æ¢ä»“åº“é‡Œçš„ä¸œè¥¿` | `update()ã€modify()` |
| âŒ **æ•°æ®åˆ é™¤** | `åˆ é™¤æ•°æ®åº“ä¸­çš„è®°å½•` | `ä»ä»“åº“æ‹¿èµ°ä¸œè¥¿` | `delete()ã€remove()` |

### 2.2 SQLå°è£…çš„ä½œç”¨


**ğŸ”¸ å°è£…å‰åå¯¹æ¯”**

```java
// âŒ ä¸šåŠ¡å±‚ç›´æ¥å†™SQLï¼ˆä¸å¥½çš„åšæ³•ï¼‰
public class UserService {
    public List<User> getActiveUsers() {
        String sql = "SELECT id, username, email FROM users WHERE status = 'ACTIVE' ORDER BY create_time DESC";
        // ... å¤æ‚çš„JDBCæ“ä½œ
    }
}

// âœ… DAOå±‚å°è£…SQLï¼ˆå¥½çš„åšæ³•ï¼‰
public class UserService {
    private UserDAO userDAO;
    
    public List<User> getActiveUsers() {
        return userDAO.findActiveUsers();  // ç®€æ´æ˜äº†
    }
}

public class UserDAO {
    public List<User> findActiveUsers() {
        String sql = "SELECT id, username, email FROM users WHERE status = ? ORDER BY create_time DESC";
        // SQLå’Œæ•°æ®åº“æ“ä½œéƒ½å°è£…åœ¨è¿™é‡Œ
    }
}
```

**ğŸ’¡ å°è£…çš„å¥½å¤„**
- **ç®€åŒ–è°ƒç”¨**ï¼šä¸šåŠ¡å±‚è°ƒç”¨æ–¹æ³•å°±åƒè¯´è¯ä¸€æ ·è‡ªç„¶
- **éšè—å¤æ‚æ€§**ï¼šä¸éœ€è¦çŸ¥é“å…·ä½“çš„SQLè¯­å¥
- **ç»Ÿä¸€ç®¡ç†**ï¼šæ‰€æœ‰SQLéƒ½åœ¨DAOä¸­ï¼Œä¾¿äºç»´æŠ¤
- **å‚æ•°å®‰å…¨**ï¼šé˜²æ­¢SQLæ³¨å…¥æ”»å‡»

### 2.3 æ•°æ®åº“äº¤äº’ç®¡ç†


**ğŸ”— è¿æ¥ç®¡ç†èŒè´£**
```
DAOå±‚éœ€è¦å¤„ç†çš„æ•°æ®åº“ç›¸å…³å·¥ä½œï¼š

1. ğŸ“¡ æ•°æ®åº“è¿æ¥ç®¡ç†
   - è·å–è¿æ¥
   - é‡Šæ”¾è¿æ¥
   - è¿æ¥æ± ä½¿ç”¨

2. ğŸ› ï¸ äº‹åŠ¡å¤„ç†
   - å¼€å¯äº‹åŠ¡
   - æäº¤äº‹åŠ¡
   - å›æ»šäº‹åŠ¡

3. ğŸ”„ ç»“æœé›†å¤„ç†
   - ResultSetè½¬Javaå¯¹è±¡
   - æ•°æ®ç±»å‹è½¬æ¢
   - å¼‚å¸¸å¤„ç†
```

---

## 3. ğŸ“ CRUDæ“ä½œè¯¦è§£


### 3.1 CRUDæ˜¯ä»€ä¹ˆ


**ğŸ”¸ CRUDå…¨ç§°ä¸å«ä¹‰**
```
C - Create  (åˆ›å»º/æ–°å¢)  â† å¾€æ•°æ®åº“æ·»åŠ æ•°æ®
R - Read    (è¯»å–/æŸ¥è¯¢)  â† ä»æ•°æ®åº“è·å–æ•°æ®  
U - Update  (æ›´æ–°/ä¿®æ”¹)  â† ä¿®æ”¹æ•°æ®åº“ä¸­çš„æ•°æ®
D - Delete  (åˆ é™¤)      â† ä»æ•°æ®åº“åˆ é™¤æ•°æ®

è¿™å››ä¸ªæ“ä½œè¦†ç›–äº†å¯¹æ•°æ®çš„æ‰€æœ‰åŸºæœ¬éœ€æ±‚ï¼
```

**ğŸ’­ ç”Ÿæ´»ä¸­çš„CRUDä¾‹å­**
```
ä»¥"å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ"ä¸ºä¾‹ï¼š

Create: æ–°å­¦ç”Ÿå…¥å­¦ï¼Œå½•å…¥å­¦ç”Ÿä¿¡æ¯
Read:   æŸ¥çœ‹å­¦ç”Ÿçš„æˆç»©å•ã€ä¸ªäººä¿¡æ¯
Update: å­¦ç”Ÿæ¢äº†ç”µè¯å·ç ï¼Œæ›´æ–°è”ç³»æ–¹å¼  
Delete: å­¦ç”Ÿæ¯•ä¸šäº†ï¼Œä»åœ¨æ ¡ç”Ÿè¡¨ä¸­åˆ é™¤
```

### 3.2 å„æ“ä½œè¯¦ç»†è¯´æ˜


#### â• Createæ“ä½œï¼ˆæ–°å¢ï¼‰


**åŸºæœ¬æ¦‚å¿µ**ï¼šæŠŠæ–°çš„æ•°æ®è®°å½•æ’å…¥åˆ°æ•°æ®åº“è¡¨ä¸­

```java
// ç”¨æˆ·æ³¨å†Œçš„ä¾‹å­
public class UserDAO {
    
    // æ–°å¢ç”¨æˆ·æ–¹æ³•
    public boolean addUser(User user) {
        String sql = "INSERT INTO users(username, password, email) VALUES(?, ?, ?)";
        
        // é€šä¿—ç†è§£ï¼šæŠŠç”¨æˆ·ä¿¡æ¯å†™å…¥æ•°æ®åº“è¿™æœ¬"èŠ±åå†Œ"
        try (Connection conn = getConnection();
             PreparedStatement ps = conn.prepareStatement(sql)) {
            
            ps.setString(1, user.getUsername());  // è®¾ç½®ç”¨æˆ·å
            ps.setString(2, user.getPassword());  // è®¾ç½®å¯†ç   
            ps.setString(3, user.getEmail());     // è®¾ç½®é‚®ç®±
            
            int result = ps.executeUpdate();      // æ‰§è¡Œæ’å…¥
            return result > 0;                    // è¿”å›æ˜¯å¦æˆåŠŸ
        }
    }
}
```

#### ğŸ” Readæ“ä½œï¼ˆæŸ¥è¯¢ï¼‰


**åŸºæœ¬æ¦‚å¿µ**ï¼šä»æ•°æ®åº“ä¸­è¯»å–æ•°æ®ï¼Œå¯èƒ½æ˜¯ä¸€æ¡è®°å½•æˆ–å¤šæ¡è®°å½•

```java
public class UserDAO {
    
    // æ ¹æ®IDæŸ¥è¯¢å•ä¸ªç”¨æˆ·
    public User findById(int userId) {
        String sql = "SELECT id, username, email FROM users WHERE id = ?";
        
        // é€šä¿—ç†è§£ï¼šæ ¹æ®å­¦å·æ‰¾åˆ°å¯¹åº”çš„å­¦ç”Ÿä¿¡æ¯
        try (Connection conn = getConnection();
             PreparedStatement ps = conn.prepareStatement(sql)) {
            
            ps.setInt(1, userId);
            ResultSet rs = ps.executeQuery();
            
            if (rs.next()) {
                // æŠŠæ•°æ®åº“è®°å½•è½¬æ¢æˆJavaå¯¹è±¡
                User user = new User();
                user.setId(rs.getInt("id"));
                user.setUsername(rs.getString("username"));
                user.setEmail(rs.getString("email"));
                return user;
            }
        }
        return null;  // æ²¡æ‰¾åˆ°è¿”å›null
    }
    
    // æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·
    public List<User> findAll() {
        String sql = "SELECT id, username, email FROM users";
        List<User> users = new ArrayList<>();
        
        // é€šä¿—ç†è§£ï¼šæŠŠæ•´ä¸ªç­çº§çš„å­¦ç”Ÿåå•éƒ½æ‹¿å‡ºæ¥
        // ... ç±»ä¼¼çš„æ•°æ®åº“æ“ä½œ
        return users;
    }
}
```

#### âœï¸ Updateæ“ä½œï¼ˆæ›´æ–°ï¼‰


**åŸºæœ¬æ¦‚å¿µ**ï¼šä¿®æ”¹æ•°æ®åº“ä¸­å·²å­˜åœ¨çš„è®°å½•

```java
public class UserDAO {
    
    // æ›´æ–°ç”¨æˆ·ä¿¡æ¯
    public boolean updateUser(User user) {
        String sql = "UPDATE users SET username = ?, email = ? WHERE id = ?";
        
        // é€šä¿—ç†è§£ï¼šæ‰¾åˆ°å¯¹åº”å­¦ç”Ÿï¼Œä¿®æ”¹ä»–çš„ä¿¡æ¯
        try (Connection conn = getConnection();
             PreparedStatement ps = conn.prepareStatement(sql)) {
            
            ps.setString(1, user.getUsername());  // æ–°ç”¨æˆ·å
            ps.setString(2, user.getEmail());     // æ–°é‚®ç®±
            ps.setInt(3, user.getId());           // æ ¹æ®IDå®šä½è¦ä¿®æ”¹çš„è®°å½•
            
            int result = ps.executeUpdate();
            return result > 0;
        }
    }
}
```

#### âŒ Deleteæ“ä½œï¼ˆåˆ é™¤ï¼‰


**åŸºæœ¬æ¦‚å¿µ**ï¼šä»æ•°æ®åº“ä¸­ç§»é™¤è®°å½•

```java
public class UserDAO {
    
    // åˆ é™¤ç”¨æˆ·
    public boolean deleteUser(int userId) {
        String sql = "DELETE FROM users WHERE id = ?";
        
        // é€šä¿—ç†è§£ï¼šæŠŠæŸä¸ªå­¦ç”Ÿçš„æ¡£æ¡ˆä»æ¡£æ¡ˆæŸœä¸­æ‹¿èµ°
        try (Connection conn = getConnection();
             PreparedStatement ps = conn.prepareStatement(sql)) {
            
            ps.setInt(1, userId);
            int result = ps.executeUpdate();
            return result > 0;
        }
    }
}
```

### 3.3 CRUDæ“ä½œçš„ä½¿ç”¨æµç¨‹


```
å…¸å‹çš„ä¸šåŠ¡å¤„ç†æµç¨‹ï¼š

ç”¨æˆ·æ³¨å†Œæµç¨‹ï¼š
1. ç”¨æˆ·å¡«å†™æ³¨å†Œè¡¨å•
2. Controlleræ¥æ”¶è¯·æ±‚ â†’ ServiceéªŒè¯æ•°æ® â†’ DAO.addUser() â†’ æ•°æ®åº“

ç”¨æˆ·ç™»å½•æµç¨‹ï¼š  
1. ç”¨æˆ·è¾“å…¥ç”¨æˆ·åå¯†ç 
2. Controlleræ¥æ”¶è¯·æ±‚ â†’ ServiceéªŒè¯é€»è¾‘ â†’ DAO.findByUsername() â†’ æ•°æ®åº“

ä¿®æ”¹èµ„æ–™æµç¨‹ï¼š
1. ç”¨æˆ·ä¿®æ”¹ä¸ªäººä¿¡æ¯
2. Controlleræ¥æ”¶è¯·æ±‚ â†’ Serviceä¸šåŠ¡å¤„ç† â†’ DAO.updateUser() â†’ æ•°æ®åº“

æ³¨é”€è´¦æˆ·æµç¨‹ï¼š
1. ç”¨æˆ·ç”³è¯·æ³¨é”€
2. Controlleræ¥æ”¶è¯·æ±‚ â†’ Serviceç¡®è®¤å¤„ç† â†’ DAO.deleteUser() â†’ æ•°æ®åº“
```

---

## 4. ğŸ—ï¸ DAOå±‚è®¾è®¡æ¨¡å¼


### 4.1 æ¥å£ä¸å®ç°åˆ†ç¦»


**ğŸ”¸ è®¾è®¡æ€æƒ³**
```
ä¸ºä»€ä¹ˆè¦æ¥å£ä¸å®ç°åˆ†ç¦»ï¼Ÿ

ç±»æ¯”ï¼šç”µå™¨æ’åº§æ ‡å‡†
- æ’åº§æ¥å£ï¼šç»Ÿä¸€çš„ä¸‰å­”ã€ä¸¤å­”æ ‡å‡†
- å…·ä½“å®ç°ï¼šä¸åŒå“ç‰Œçš„æ’åº§ï¼Œä½†éƒ½éµå¾ªæ ‡å‡†
- å¥½å¤„ï¼šä»»ä½•ç¬¦åˆæ ‡å‡†çš„ç”µå™¨éƒ½èƒ½æ’å…¥ä½¿ç”¨

DAOè®¾è®¡ä¹Ÿæ˜¯å¦‚æ­¤ï¼š
- DAOæ¥å£ï¼šå®šä¹‰ç»Ÿä¸€çš„æ•°æ®è®¿é—®æ–¹æ³•
- DAOå®ç°ï¼šå…·ä½“çš„æ•°æ®åº“æ“ä½œä»£ç 
- å¥½å¤„ï¼šå¯ä»¥éšæ—¶æ›´æ¢æ•°æ®åº“è€Œä¸å½±å“ä¸šåŠ¡é€»è¾‘
```

**ğŸ“‹ æ ‡å‡†DAOè®¾è®¡ç»“æ„**

```java
// 1. å®šä¹‰DAOæ¥å£ï¼ˆè§„èŒƒï¼‰
public interface UserDAO {
    // å®šä¹‰éœ€è¦çš„æ•°æ®è®¿é—®æ–¹æ³•ï¼Œä¸å…³å¿ƒå…·ä½“å®ç°
    boolean save(User user);
    User findById(int id);
    List<User> findAll();
    boolean update(User user);
    boolean delete(int id);
}

// 2. æä¾›å…·ä½“å®ç°ï¼ˆMySQLç‰ˆæœ¬ï¼‰
public class UserDAOImpl implements UserDAO {
    
    @Override
    public boolean save(User user) {
        // MySQLå…·ä½“å®ç°
        String sql = "INSERT INTO users...";
        // ... å…·ä½“ä»£ç 
    }
    
    @Override
    public User findById(int id) {
        // MySQLå…·ä½“å®ç°
        String sql = "SELECT * FROM users WHERE id = ?";
        // ... å…·ä½“ä»£ç 
    }
    
    // ... å…¶ä»–æ–¹æ³•å®ç°
}

// 3. ä¸šåŠ¡å±‚ä½¿ç”¨æ¥å£ï¼Œä¸ä¾èµ–å…·ä½“å®ç°
public class UserService {
    private UserDAO userDAO = new UserDAOImpl();  // é¢å‘æ¥å£ç¼–ç¨‹
    
    public void registerUser(User user) {
        userDAO.save(user);  // è°ƒç”¨æ¥å£æ–¹æ³•
    }
}
```

### 4.2 å¯¹è±¡å…³ç³»æ˜ å°„åŸç†


**ğŸ”¸ ä»€ä¹ˆæ˜¯å¯¹è±¡å…³ç³»æ˜ å°„**
```
å¯¹è±¡å…³ç³»æ˜ å°„ï¼ˆORMï¼‰ï¼šObject-Relational Mapping

é—®é¢˜ï¼š
- Javaä¸­æœ‰å¯¹è±¡ï¼šUserå¯¹è±¡æœ‰idã€nameã€emailå±æ€§
- æ•°æ®åº“ä¸­æœ‰è¡¨ï¼šusersè¡¨æœ‰idã€nameã€emailå­—æ®µ
- å¦‚ä½•è®©å¯¹è±¡å’Œæ•°æ®åº“è®°å½•å¯¹åº”èµ·æ¥ï¼Ÿ

ORMå°±æ˜¯è§£å†³è¿™ä¸ªå¯¹åº”å…³ç³»çš„ï¼
```

**ğŸ’¡ æ˜ å°„å…³ç³»ç¤ºä¾‹**

```java
// Javaå¯¹è±¡
public class User {
    private int id;        // å¯¹åº”æ•°æ®åº“ users.id å­—æ®µ
    private String name;   // å¯¹åº”æ•°æ®åº“ users.name å­—æ®µ  
    private String email;  // å¯¹åº”æ•°æ®åº“ users.email å­—æ®µ
}

// æ•°æ®åº“è¡¨ç»“æ„
/*
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,    -- å¯¹åº” User.id
    name VARCHAR(50),                     -- å¯¹åº” User.name
    email VARCHAR(100)                    -- å¯¹åº” User.email
);
*/

// DAOä¸­çš„æ˜ å°„è½¬æ¢
public class UserDAO {
    
    // æ•°æ®åº“è®°å½• â†’ Javaå¯¹è±¡ï¼ˆæŸ¥è¯¢æ—¶ï¼‰
    private User mapRowToUser(ResultSet rs) throws SQLException {
        User user = new User();
        user.setId(rs.getInt("id"));           // æ•°æ®åº“å­—æ®µæ˜ å°„åˆ°å¯¹è±¡å±æ€§
        user.setName(rs.getString("name"));
        user.setEmail(rs.getString("email"));
        return user;
    }
    
    // Javaå¯¹è±¡ â†’ æ•°æ®åº“è®°å½•ï¼ˆæ’å…¥/æ›´æ–°æ—¶ï¼‰
    public boolean save(User user) {
        String sql = "INSERT INTO users(name, email) VALUES(?, ?)";
        // å¯¹è±¡å±æ€§æ˜ å°„åˆ°SQLå‚æ•°
        ps.setString(1, user.getName());
        ps.setString(2, user.getEmail());
    }
}
```

### 4.3 DAOå·¥å‚æ¨¡å¼


**ğŸ”¸ å·¥å‚æ¨¡å¼çš„ä½œç”¨**

```java
// é—®é¢˜ï¼šå¦‚æœç›´æ¥newå®ç°ç±»ï¼Œè€¦åˆåº¦å¤ªé«˜
public class UserService {
    private UserDAO userDAO = new UserDAOImpl();  // å†™æ­»äº†å…·ä½“å®ç°
}

// è§£å†³ï¼šä½¿ç”¨å·¥å‚æ¨¡å¼
public class DAOFactory {
    
    public static UserDAO getUserDAO() {
        // å¯ä»¥æ ¹æ®é…ç½®è¿”å›ä¸åŒçš„å®ç°
        String dbType = ConfigManager.getDbType();
        
        if ("mysql".equals(dbType)) {
            return new MySQLUserDAOImpl();
        } else if ("oracle".equals(dbType)) {
            return new OracleUserDAOImpl();
        }
        return new MySQLUserDAOImpl();  // é»˜è®¤å®ç°
    }
}

// ä¸šåŠ¡å±‚ä½¿ç”¨å·¥å‚è·å–DAO
public class UserService {
    private UserDAO userDAO = DAOFactory.getUserDAO();  // è§£è€¦äº†ï¼
}
```

---

## 5. ğŸ’¾ æ•°æ®æŒä¹…åŒ–åŸç†


### 5.1 ä»€ä¹ˆæ˜¯æ•°æ®æŒä¹…åŒ–


**ğŸ”¸ æŒä¹…åŒ–çš„é€šä¿—ç†è§£**
```
ç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼š
- å†™æ—¥è®°ï¼šæŠŠä»Šå¤©çš„ç»å†å†™åœ¨æ—¥è®°æœ¬ä¸Šï¼Œæ˜å¤©è¿˜èƒ½çœ‹åˆ°
- å­˜é“¶è¡Œï¼šæŠŠé’±å­˜åœ¨é“¶è¡Œï¼Œéšæ—¶å¯ä»¥å–å‡ºæ¥
- æ‹ç…§ç‰‡ï¼šæŠŠç¾å¥½æ—¶å…‰æ‹ä¸‹æ¥ï¼Œå¤šå¹´åè¿˜èƒ½å›å¿†

æ•°æ®æŒä¹…åŒ–å°±æ˜¯ï¼š
æŠŠç¨‹åºä¸­çš„æ•°æ®æ°¸ä¹…ä¿å­˜èµ·æ¥ï¼Œç¨‹åºå…³é—­åæ•°æ®ä¸ä¸¢å¤±
```

**ğŸ“Š æ•°æ®å­˜å‚¨æ–¹å¼å¯¹æ¯”**

| å­˜å‚¨æ–¹å¼ | **æŒä¹…æ€§** | **è®¿é—®é€Ÿåº¦** | **å­˜å‚¨é‡** | **ä½¿ç”¨åœºæ™¯** |
|---------|-----------|-------------|-----------|-------------|
| ğŸ§  **å†…å­˜** | `ç¨‹åºç»“æŸå°±ä¸¢å¤±` | `æå¿«` | `æœ‰é™` | `ä¸´æ—¶æ•°æ®ã€ç¼“å­˜` |
| ğŸ“„ **æ–‡ä»¶** | `æ°¸ä¹…ä¿å­˜` | `ä¸€èˆ¬` | `è¾ƒå¤§` | `é…ç½®ã€æ—¥å¿—` |
| ğŸ—„ï¸ **æ•°æ®åº“** | `æ°¸ä¹…ä¿å­˜` | `å¿«` | `å¾ˆå¤§` | `ä¸šåŠ¡æ•°æ®` |

### 5.2 ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®æŒä¹…åŒ–


**ğŸš« æ²¡æœ‰æŒä¹…åŒ–çš„é—®é¢˜**
```java
// åªæŠŠæ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­
public class UserService {
    private List<User> users = new ArrayList<>();  // å†…å­˜ä¸­çš„æ•°æ®
    
    public void addUser(User user) {
        users.add(user);  // åªåŠ åˆ°å†…å­˜åˆ—è¡¨
    }
}

é—®é¢˜ï¼š
âŒ ç¨‹åºé‡å¯ï¼Œæ‰€æœ‰ç”¨æˆ·æ•°æ®éƒ½æ²¡äº†
âŒ å¤šä¸ªç¨‹åºå®ä¾‹æ— æ³•å…±äº«æ•°æ®  
âŒ æ•°æ®æ— æ³•é•¿æœŸä¿å­˜
âŒ æ— æ³•å¤„ç†å¤§é‡æ•°æ®
```

**âœ… æœ‰æŒä¹…åŒ–çš„å¥½å¤„**
```java
// æ•°æ®ä¿å­˜åˆ°æ•°æ®åº“
public class UserDAO {
    
    public void addUser(User user) {
        String sql = "INSERT INTO users...";
        // æ•°æ®ä¿å­˜åˆ°æ•°æ®åº“æ–‡ä»¶ä¸­
    }
}

å¥½å¤„ï¼š
âœ… ç¨‹åºé‡å¯æ•°æ®ä»ç„¶å­˜åœ¨
âœ… å¤šä¸ªç¨‹åºå¯ä»¥å…±äº«åŒä¸€ä»½æ•°æ®
âœ… æ•°æ®å®‰å…¨ï¼Œæœ‰å¤‡ä»½æœºåˆ¶  
âœ… å¯ä»¥å¤„ç†æµ·é‡æ•°æ®
```

### 5.3 DAOåœ¨æŒä¹…åŒ–ä¸­çš„ä½œç”¨


```
æ•°æ®æŒä¹…åŒ–æµç¨‹ï¼š

Javaç¨‹åºä¸­çš„æ•°æ®
    â†“ (é€šè¿‡DAOå±‚)
è½¬æ¢ä¸ºSQLè¯­å¥
    â†“  
å­˜å‚¨åˆ°æ•°æ®åº“æ–‡ä»¶
    â†“
æŒä¹…åŒ–å®Œæˆ

DAOå±‚åœ¨å…¶ä¸­çš„ä½œç”¨ï¼š
ğŸ”„ æ•°æ®æ ¼å¼è½¬æ¢ï¼šJavaå¯¹è±¡ â†” æ•°æ®åº“è®°å½•
ğŸ› ï¸ SQLè¯­å¥ç”Ÿæˆï¼šæ ¹æ®æ“ä½œç”Ÿæˆå¯¹åº”çš„SQL
ğŸ”— æ•°æ®åº“è¿æ¥ç®¡ç†ï¼šå¤„ç†è¿æ¥ã€äº‹åŠ¡ç­‰
âš¡ å¼‚å¸¸å¤„ç†ï¼šå¤„ç†æ•°æ®åº“æ“ä½œå¼‚å¸¸
```

---

## 6. ğŸ› ï¸ å®é™…å¼€å‘ç¤ºä¾‹


### 6.1 å®Œæ•´çš„ç”¨æˆ·ç®¡ç†DAO


**ğŸ”¸ å®ä½“ç±»å®šä¹‰**
```java
public class User {
    private int id;
    private String username;
    private String password;
    private String email;
    private Date createTime;
    
    // æ„é€ æ–¹æ³•
    public User() {}
    
    public User(String username, String password, String email) {
        this.username = username;
        this.password = password;
        this.email = email;
        this.createTime = new Date();
    }
    
    // getterå’Œsetteræ–¹æ³•ï¼ˆçœç•¥å…·ä½“ä»£ç ï¼‰
}
```

**ğŸ”¸ DAOæ¥å£å®šä¹‰**
```java
public interface UserDAO {
    
    // åŸºæœ¬CRUDæ“ä½œ
    boolean save(User user);                    // ä¿å­˜ç”¨æˆ·
    User findById(int id);                     // æ ¹æ®IDæŸ¥æ‰¾
    User findByUsername(String username);       // æ ¹æ®ç”¨æˆ·åæŸ¥æ‰¾
    List<User> findAll();                      // æŸ¥æ‰¾æ‰€æœ‰ç”¨æˆ·
    boolean update(User user);                 // æ›´æ–°ç”¨æˆ·
    boolean delete(int id);                    // åˆ é™¤ç”¨æˆ·
    
    // ä¸šåŠ¡ç›¸å…³æŸ¥è¯¢
    List<User> findByEmailDomain(String domain);  // æ ¹æ®é‚®ç®±åŸŸåæŸ¥æ‰¾
    int countUsers();                              // ç»Ÿè®¡ç”¨æˆ·æ•°é‡
}
```

**ğŸ”¸ DAOå…·ä½“å®ç°**
```java
public class UserDAOImpl implements UserDAO {
    
    // æ•°æ®åº“è¿æ¥å·¥å…·æ–¹æ³•
    private Connection getConnection() throws SQLException {
        // å®é™…é¡¹ç›®ä¸­ä¼šä½¿ç”¨è¿æ¥æ± 
        return DriverManager.getConnection(
            "jdbc:mysql://localhost:3306/webapp", 
            "root", 
            "password"
        );
    }
    
    @Override
    public boolean save(User user) {
        String sql = "INSERT INTO users(username, password, email, create_time) VALUES(?, ?, ?, ?)";
        
        try (Connection conn = getConnection();
             PreparedStatement ps = conn.prepareStatement(sql)) {
            
            ps.setString(1, user.getUsername());
            ps.setString(2, user.getPassword());
            ps.setString(3, user.getEmail());
            ps.setTimestamp(4, new Timestamp(user.getCreateTime().getTime()));
            
            return ps.executeUpdate() > 0;
            
        } catch (SQLException e) {
            e.printStackTrace();
            return false;
        }
    }
    
    @Override
    public User findById(int id) {
        String sql = "SELECT * FROM users WHERE id = ?";
        
        try (Connection conn = getConnection();
             PreparedStatement ps = conn.prepareStatement(sql)) {
            
            ps.setInt(1, id);
            ResultSet rs = ps.executeQuery();
            
            if (rs.next()) {
                return mapRowToUser(rs);  // è½¬æ¢ä¸ºUserå¯¹è±¡
            }
            
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return null;
    }
    
    // ç»“æœé›†è½¬å¯¹è±¡çš„è¾…åŠ©æ–¹æ³•
    private User mapRowToUser(ResultSet rs) throws SQLException {
        User user = new User();
        user.setId(rs.getInt("id"));
        user.setUsername(rs.getString("username"));
        user.setPassword(rs.getString("password"));
        user.setEmail(rs.getString("email"));
        user.setCreateTime(rs.getTimestamp("create_time"));
        return user;
    }
}
```

### 6.2 åœ¨ä¸šåŠ¡å±‚ä¸­ä½¿ç”¨DAO


```java
public class UserService {
    private UserDAO userDAO = new UserDAOImpl();
    
    // ç”¨æˆ·æ³¨å†Œä¸šåŠ¡
    public boolean registerUser(String username, String password, String email) {
        
        // 1. ä¸šåŠ¡éªŒè¯
        if (username == null || username.trim().isEmpty()) {
            return false;  // ç”¨æˆ·åä¸èƒ½ä¸ºç©º
        }
        
        // 2. æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
        User existUser = userDAO.findByUsername(username);
        if (existUser != null) {
            return false;  // ç”¨æˆ·åå·²å­˜åœ¨
        }
        
        // 3. åˆ›å»ºæ–°ç”¨æˆ·å¹¶ä¿å­˜
        User newUser = new User(username, password, email);
        return userDAO.save(newUser);
    }
    
    // ç”¨æˆ·ç™»å½•éªŒè¯
    public User loginUser(String username, String password) {
        User user = userDAO.findByUsername(username);
        
        if (user != null && user.getPassword().equals(password)) {
            return user;  // ç™»å½•æˆåŠŸ
        }
        
        return null;  // ç™»å½•å¤±è´¥
    }
}
```

### 6.3 å®Œæ•´çš„é¡¹ç›®ç»“æ„


```
é¡¹ç›®ç»“æ„ç¤ºä¾‹ï¼š
src/
â”œâ”€â”€ entity/                 # å®ä½“ç±»
â”‚   â””â”€â”€ User.java
â”œâ”€â”€ dao/                   # DAOå±‚
â”‚   â”œâ”€â”€ UserDAO.java       # DAOæ¥å£
â”‚   â””â”€â”€ impl/
â”‚       â””â”€â”€ UserDAOImpl.java  # DAOå®ç°
â”œâ”€â”€ service/               # ä¸šåŠ¡å±‚  
â”‚   â””â”€â”€ UserService.java
â”œâ”€â”€ servlet/               # æ§åˆ¶å±‚
â”‚   â””â”€â”€ UserServlet.java
â””â”€â”€ util/                  # å·¥å…·ç±»
    â””â”€â”€ DBUtil.java        # æ•°æ®åº“è¿æ¥å·¥å…·
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ DAOæœ¬è´¨ï¼šä¸“é—¨è´Ÿè´£æ•°æ®åº“æ“ä½œçš„ä¸€å±‚ï¼Œåƒé“¶è¡ŒæŸœå‘˜ä¸€æ ·
ğŸ”¸ ä¸»è¦èŒè´£ï¼šCRUDæ“ä½œï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰+ SQLå°è£… + æ•°æ®è½¬æ¢
ğŸ”¸ è®¾è®¡åŸåˆ™ï¼šæ¥å£ä¸å®ç°åˆ†ç¦»ï¼ŒèŒè´£å•ä¸€ï¼Œæ˜“äºç»´æŠ¤
ğŸ”¸ æ ¸å¿ƒä»·å€¼ï¼šç®€åŒ–ä¸šåŠ¡å±‚è°ƒç”¨ï¼Œç»Ÿä¸€ç®¡ç†æ•°æ®è®¿é—®é€»è¾‘
ğŸ”¸ æŒä¹…åŒ–ä½œç”¨ï¼šæŠŠå†…å­˜ä¸­çš„æ•°æ®æ°¸ä¹…ä¿å­˜åˆ°æ•°æ®åº“
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ DAOå±‚çš„ä»·å€¼**
```
è§£å†³çš„æ ¸å¿ƒé—®é¢˜ï¼š
- è®©ä¸šåŠ¡é€»è¾‘ä¸æ•°æ®åº“æ“ä½œåˆ†ç¦»
- è®©å¤æ‚çš„SQLæ“ä½œå˜æˆç®€å•çš„æ–¹æ³•è°ƒç”¨  
- è®©æ•°æ®åº“è®¿é—®ä»£ç é›†ä¸­ç®¡ç†å’Œå¤ç”¨
- è®©ç³»ç»Ÿæ›´å®¹æ˜“æµ‹è¯•å’Œç»´æŠ¤
```

**ğŸ”¹ CRUDæ“ä½œçš„å®è´¨**
```
CRUDä¸æ˜¯é«˜æ·±çš„æ¦‚å¿µï¼Œå°±æ˜¯å¯¹æ•°æ®çš„åŸºæœ¬æ“ä½œï¼š
- Createï¼šå¾€æ•°æ®åº“"å†™å…¥"æ–°æ•°æ®
- Readï¼šä»æ•°æ®åº“"è¯»å–"æ•°æ®
- Updateï¼šåœ¨æ•°æ®åº“ä¸­"ä¿®æ”¹"æ•°æ®  
- Deleteï¼šä»æ•°æ®åº“ä¸­"åˆ é™¤"æ•°æ®

æ‰€æœ‰ä¸šåŠ¡æœ€ç»ˆéƒ½å¯ä»¥å½’ç»“ä¸ºè¿™å››ç§æ“ä½œçš„ç»„åˆ
```

**ğŸ”¹ å¯¹è±¡å…³ç³»æ˜ å°„çš„é‡è¦æ€§**
```
æ ¸å¿ƒä½œç”¨ï¼š
- è®©Javaå¯¹è±¡å’Œæ•°æ®åº“è¡¨å»ºç«‹å¯¹åº”å…³ç³»
- è®©ç¨‹åºå‘˜ç”¨é¢å‘å¯¹è±¡çš„æ–¹å¼æ“ä½œæ•°æ®
- è®©æ•°æ®åœ¨å¯¹è±¡å’Œè¡¨ä¹‹é—´è‡ªåŠ¨è½¬æ¢
- ç®€åŒ–äº†æ•°æ®è®¿é—®çš„å¤æ‚åº¦
```

### 7.3 å®é™…å¼€å‘æŒ‡å¯¼


**ğŸ’¡ DAOè®¾è®¡æœ€ä½³å®è·µ**
- **æ¥å£å…ˆè¡Œ**ï¼šå…ˆå®šä¹‰æ¥å£ï¼Œå†å†™å®ç°
- **æ–¹æ³•å‘½å**ï¼šfindByIdã€saveã€updateç­‰è¯­ä¹‰åŒ–å‘½å
- **å¼‚å¸¸å¤„ç†**ï¼šå¦¥å–„å¤„ç†æ•°æ®åº“å¼‚å¸¸ï¼Œä¸èƒ½è®©ç¨‹åºå´©æºƒ
- **èµ„æºç®¡ç†**ï¼šåŠæ—¶å…³é—­æ•°æ®åº“è¿æ¥ï¼Œé¿å…å†…å­˜æ³„æ¼

**ğŸ¯ å¸¸è§åº”ç”¨åœºæ™¯**
- **ç”¨æˆ·ç³»ç»Ÿ**ï¼šæ³¨å†Œã€ç™»å½•ã€ä¸ªäººèµ„æ–™ç®¡ç†
- **å•†å“ç®¡ç†**ï¼šå•†å“å¢åˆ æ”¹æŸ¥ã€åˆ†ç±»ç®¡ç†
- **è®¢å•å¤„ç†**ï¼šè®¢å•åˆ›å»ºã€çŠ¶æ€æ›´æ–°ã€å†å²æŸ¥è¯¢
- **å†…å®¹ç®¡ç†**ï¼šæ–‡ç« å‘å¸ƒã€è¯„è®ºç®¡ç†ã€æ ‡ç­¾åˆ†ç±»

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- DAOä¸“é—¨ç®¡æ•°æ®ï¼Œå¢åˆ æ”¹æŸ¥å®ƒå…¨åŒ…
- æ¥å£å®ç°è¦åˆ†ç¦»ï¼Œä¸šåŠ¡æ•°æ®ä¸æ··ä¹±
- å¯¹è±¡è®°å½•ç›¸æ˜ å°„ï¼ŒæŒä¹…å­˜å‚¨æ˜¯å…³é”®