---
title: 4ã€å®‰å…¨æ€§è€ƒè™‘
---
## ğŸ“š ç›®å½•

1. [Webå®‰å…¨åŸºç¡€è®¤çŸ¥](#1-Webå®‰å…¨åŸºç¡€è®¤çŸ¥)
2. [SQLæ³¨å…¥é˜²æŠ¤ç­–ç•¥](#2-SQLæ³¨å…¥é˜²æŠ¤ç­–ç•¥)
3. [XSSæ”»å‡»é˜²å¾¡æœºåˆ¶](#3-XSSæ”»å‡»é˜²å¾¡æœºåˆ¶)
4. [CSRFé˜²æŠ¤æŠ€æœ¯](#4-CSRFé˜²æŠ¤æŠ€æœ¯)
5. [è¾“å…¥éªŒè¯ä¸æ•°æ®è¿‡æ»¤](#5-è¾“å…¥éªŒè¯ä¸æ•°æ®è¿‡æ»¤)
6. [æƒé™æ§åˆ¶ä¸è®¿é—®ç®¡ç†](#6-æƒé™æ§åˆ¶ä¸è®¿é—®ç®¡ç†)
7. [æ•°æ®åŠ å¯†ä¸ä¼ è¾“å®‰å…¨](#7-æ•°æ®åŠ å¯†ä¸ä¼ è¾“å®‰å…¨)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ›¡ï¸ Webå®‰å…¨åŸºç¡€è®¤çŸ¥


### 1.1 ä¸ºä»€ä¹ˆWebå®‰å…¨å¦‚æ­¤é‡è¦


æƒ³è±¡ä¸€ä¸‹ä½ çš„ç½‘ç«™å°±åƒæ˜¯ä¸€æ ‹æˆ¿å­ï¼š

```
æ™®é€šæˆ¿å­çš„å®‰å…¨è€ƒè™‘ï¼š               Webåº”ç”¨çš„å®‰å…¨è€ƒè™‘ï¼š
ğŸ  é”å¥½é—¨çª—                     â†’ ğŸ” ç”¨æˆ·è®¤è¯
ğŸšª è®¿å®¢ç™»è®°                     â†’ ğŸ“ æƒé™æ§åˆ¶
ğŸ”’ è´µé‡ç‰©å“ä¿é™©æŸœ               â†’ ğŸ›¡ï¸ æ•°æ®åŠ å¯†
ğŸ‘® 24å°æ—¶ç›‘æ§                   â†’ ğŸ“Š æ—¥å¿—ç›‘æ§
ğŸš¨ é˜²ç›—æŠ¥è­¦ç³»ç»Ÿ                 â†’ âš ï¸ å¼‚å¸¸æ£€æµ‹
```

**å®‰å…¨å¨èƒçš„ç°å®å½±å“ï¼š**
- **æ•°æ®æ³„éœ²**ï¼šç”¨æˆ·éšç§ä¿¡æ¯è¢«çªƒå–
- **ç»æµæŸå¤±**ï¼šä¼ä¸šå£°èª‰å—æŸï¼Œé¢ä¸´ç½šæ¬¾
- **æœåŠ¡ä¸­æ–­**ï¼šç½‘ç«™è¢«æ”»å‡»å¯¼è‡´æ— æ³•æ­£å¸¸è¿è¡Œ
- **æ³•å¾‹è´£ä»»**ï¼šè¿åæ•°æ®ä¿æŠ¤æ³•å¾‹æ³•è§„

### 1.2 å¸¸è§Webå®‰å…¨å¨èƒæ¦‚è§ˆ


**ğŸ¯ Webå®‰å…¨å¨èƒåˆ†ç±»ï¼š**

```
Webå®‰å…¨å¨èƒä½“ç³»ï¼š
â”œâ”€â”€ æ³¨å…¥æ”»å‡»
â”‚   â”œâ”€â”€ SQLæ³¨å…¥ (æœ€å±é™©)
â”‚   â”œâ”€â”€ NoSQLæ³¨å…¥
â”‚   â””â”€â”€ å‘½ä»¤æ³¨å…¥
â”œâ”€â”€ è·¨ç«™æ”»å‡»  
â”‚   â”œâ”€â”€ XSSæ”»å‡» (æœ€å¸¸è§)
â”‚   â””â”€â”€ CSRFæ”»å‡»
â”œâ”€â”€ è®¤è¯ç ´è§£
â”‚   â”œâ”€â”€ æš´åŠ›ç ´è§£
â”‚   â”œâ”€â”€ ä¼šè¯åŠ«æŒ
â”‚   â””â”€â”€ æƒé™æå‡
â””â”€â”€ å…¶ä»–å¨èƒ
    â”œâ”€â”€ æ–‡ä»¶ä¸Šä¼ æ¼æ´
    â”œâ”€â”€ ä¿¡æ¯æ³„éœ²
    â””â”€â”€ æ‹’ç»æœåŠ¡æ”»å‡»
```

### 1.3 å®‰å…¨é˜²æŠ¤çš„æ ¸å¿ƒæ€æƒ³


**é˜²å¾¡ç­–ç•¥å››å¤§åŸåˆ™ï¼š**

| åŸåˆ™ | **å«ä¹‰** | **å®ç°æ–¹å¼** | **ä¸¾ä¾‹** |
|------|----------|-------------|----------|
| ğŸ›¡ï¸ **çºµæ·±é˜²å¾¡** | `å¤šå±‚é˜²æŠ¤ï¼Œå±‚å±‚æŠŠå…³` | `å‰ç«¯éªŒè¯+åç«¯éªŒè¯+æ•°æ®åº“çº¦æŸ` | `ç”¨æˆ·è¾“å…¥ä¸‰é‡æ£€æŸ¥` |
| ğŸ”’ **æœ€å°æƒé™** | `åªç»™å¿…éœ€çš„æƒé™` | `è§’è‰²åˆ†ç¦»ï¼Œæƒé™åˆ†çº§` | `æ™®é€šç”¨æˆ·ä¸èƒ½åˆ é™¤æ•°æ®` |
| âœ… **ç™½åå•æœºåˆ¶** | `åªå…è®¸å®‰å…¨çš„å†…å®¹` | `é¢„å®šä¹‰å®‰å…¨åˆ—è¡¨` | `åªå…è®¸ç‰¹å®šæ–‡ä»¶ç±»å‹ä¸Šä¼ ` |
| ğŸ” **æŒç»­ç›‘æ§** | `å®æ—¶å‘ç°å¼‚å¸¸è¡Œä¸º` | `æ—¥å¿—è®°å½•+å¼‚å¸¸å‘Šè­¦` | `ç™»å½•å¤±è´¥æ¬¡æ•°ç›‘æ§` |

---

## 2. ğŸ’‰ SQLæ³¨å…¥é˜²æŠ¤ç­–ç•¥


### 2.1 ä»€ä¹ˆæ˜¯SQLæ³¨å…¥


**é€šä¿—ç†è§£ï¼š**
SQLæ³¨å…¥å°±åƒæ˜¯æœ‰äººåœ¨ä½ çš„å¯¹è¯ä¸­å·å·æ’å…¥äº†æ¶æ„æŒ‡ä»¤ã€‚

```
æ­£å¸¸å¯¹è¯ï¼š
ä½ ï¼š"è¯·å¸®æˆ‘æŸ¥æ‰¾åå­—å«å¼ ä¸‰çš„ç”¨æˆ·"
ç³»ç»Ÿï¼š"å¥½çš„ï¼ŒæŸ¥æ‰¾å¼ ä¸‰"

SQLæ³¨å…¥æ”»å‡»ï¼š
é»‘å®¢ï¼š"è¯·å¸®æˆ‘æŸ¥æ‰¾åå­—å«å¼ ä¸‰' OR '1'='1çš„ç”¨æˆ·"
ç³»ç»Ÿï¼š"å¥½çš„ï¼ŒæŸ¥æ‰¾å¼ ä¸‰ OR 1=1" (ç»“æœï¼šè¿”å›æ‰€æœ‰ç”¨æˆ·ï¼)
```

**å±é™©çš„SQLæ³¨å…¥ç¤ºä¾‹ï¼š**
```java
// âŒ å±é™©çš„ä»£ç å†™æ³•
String username = request.getParameter("username");
String sql = "SELECT * FROM users WHERE username = '" + username + "'";

// å¦‚æœç”¨æˆ·è¾“å…¥ï¼šadmin'; DROP TABLE users; --
// å®é™…æ‰§è¡Œçš„SQLå˜æˆï¼š
// SELECT * FROM users WHERE username = 'admin'; DROP TABLE users; --'
// ç»“æœï¼šç”¨æˆ·è¡¨è¢«åˆ é™¤ï¼
```

### 2.2 SQLæ³¨å…¥é˜²æŠ¤æœ€ä½³å®è·µ


**ğŸ”¸ æ–¹æ³•ä¸€ï¼šé¢„ç¼–è¯‘è¯­å¥ï¼ˆæ¨èï¼‰**

```java
// âœ… å®‰å…¨çš„é¢„ç¼–è¯‘è¯­å¥
public User getUserByName(String username) {
    String sql = "SELECT * FROM users WHERE username = ?";
    
    try (PreparedStatement pstmt = connection.prepareStatement(sql)) {
        // å‚æ•°è‡ªåŠ¨è½¬ä¹‰ï¼Œé˜²æ­¢æ³¨å…¥
        pstmt.setString(1, username);
        ResultSet rs = pstmt.executeQuery();
        
        if (rs.next()) {
            return new User(rs.getString("username"), rs.getString("email"));
        }
    } catch (SQLException e) {
        logger.error("æŸ¥è¯¢ç”¨æˆ·å¤±è´¥", e);
    }
    return null;
}
```

**ä¸ºä»€ä¹ˆé¢„ç¼–è¯‘èƒ½é˜²æ³¨å…¥ï¼š**
```
é¢„ç¼–è¯‘è¿‡ç¨‹ï¼š
1. æ•°æ®åº“å…ˆç¼–è¯‘SQLæ¨¡æ¿ï¼š"SELECT * FROM users WHERE username = ?"
2. åç»­åªä¼ å‚æ•°ï¼Œå‚æ•°è¢«å½“ä½œçº¯æ•°æ®å¤„ç†
3. æ¶æ„SQLä»£ç è¢«å½“ä½œæ™®é€šå­—ç¬¦ä¸²ï¼Œä¸ä¼šæ‰§è¡Œ

å°±åƒå¡«ç©ºé¢˜ï¼š
é¢˜ç›®ï¼š"æˆ‘çš„åå­—æ˜¯____"
æ— è®ºå¡«ä»€ä¹ˆï¼Œéƒ½åªæ˜¯ç­”æ¡ˆï¼Œä¸ä¼šæ”¹å˜é¢˜ç›®æœ¬èº«
```

**ğŸ”¸ æ–¹æ³•äºŒï¼šè¾“å…¥éªŒè¯ä¸è¿‡æ»¤**

```java
// âœ… è¾“å…¥éªŒè¯ç¤ºä¾‹
public class InputValidator {
    
    // ç”¨æˆ·ååªå…è®¸å­—æ¯æ•°å­—ä¸‹åˆ’çº¿
    private static final Pattern USERNAME_PATTERN = 
        Pattern.compile("^[a-zA-Z0-9_]{3,20}$");
    
    public boolean isValidUsername(String username) {
        if (username == null || username.trim().isEmpty()) {
            return false;
        }
        return USERNAME_PATTERN.matcher(username).matches();
    }
    
    // è¿‡æ»¤å±é™©å­—ç¬¦
    public String sanitizeInput(String input) {
        if (input == null) return "";
        
        // ç§»é™¤SQLå…³é”®å­—å’Œç‰¹æ®Šå­—ç¬¦
        return input.replaceAll("(?i)(union|select|drop|delete|insert|update)", "")
                   .replaceAll("[';\"\\\\]", "");
    }
}
```

### 2.3 MyBatisä¸­çš„SQLæ³¨å…¥é˜²æŠ¤


**å®‰å…¨ä½¿ç”¨MyBatisï¼š**

```xml
<!-- âœ… å®‰å…¨ï¼šä½¿ç”¨#{}å‚æ•°ç»‘å®š -->
<select id="getUserByName" resultType="User">
    SELECT * FROM users WHERE username = #{username}
</select>

<!-- âŒ å±é™©ï¼šä½¿ç”¨${}å­—ç¬¦ä¸²æ‹¼æ¥ -->
<select id="getUserByNameUnsafe" resultType="User">
    SELECT * FROM users WHERE username = '${username}'
</select>
```

**#{}å’Œ${}çš„åŒºåˆ«ï¼š**
```
#{username}ï¼š
- ç¼–è¯‘æˆï¼šSELECT * FROM users WHERE username = ?
- å‚æ•°å€¼ï¼š'admin'
- å®‰å…¨ï¼šå‚æ•°è¢«æ­£ç¡®è½¬ä¹‰

${username}ï¼š
- ç¼–è¯‘æˆï¼šSELECT * FROM users WHERE username = 'admin'
- ç›´æ¥å­—ç¬¦ä¸²æ›¿æ¢
- å±é™©ï¼šå¯èƒ½è¢«æ³¨å…¥æ”»å‡»
```

---

## 3. ğŸ­ XSSæ”»å‡»é˜²å¾¡æœºåˆ¶


### 3.1 ä»€ä¹ˆæ˜¯XSSæ”»å‡»


**XSS (Cross-Site Scripting) é€šä¿—è§£é‡Šï¼š**
XSSå°±åƒæ˜¯æœ‰äººåœ¨ä½ çš„ç½‘é¡µé‡Œå·å·æ”¾äº†ä¸€ä¸ª"æœ¨é©¬ç¨‹åº"ã€‚

```
ç”Ÿæ´»ä¸­çš„ç±»æ¯”ï¼š
ä½ åœ¨è®ºå›å‘å¸–ï¼šæˆ‘ä»Šå¤©å¾ˆå¼€å¿ƒï¼
é»‘å®¢å‘å¸–ï¼šæˆ‘ä»Šå¤©å¾ˆå¼€å¿ƒï¼<script>å·å–ä½ çš„å¯†ç ()</script>

å½“åˆ«äººçœ‹åˆ°é»‘å®¢çš„å¸–å­æ—¶ï¼Œæ¶æ„ä»£ç å°±ä¼šåœ¨ä»–ä»¬æµè§ˆå™¨ä¸­æ‰§è¡Œ
```

**XSSæ”»å‡»çš„ä¸‰ç§ç±»å‹ï¼š**

```
XSSæ”»å‡»åˆ†ç±»ï¼š
â”œâ”€â”€ ğŸ¯ åå°„å‹XSS (æœ€å¸¸è§)
â”‚   â””â”€â”€ æ¶æ„ä»£ç åœ¨URLä¸­ï¼Œç‚¹å‡»é“¾æ¥å°±ä¸­æ‹›
â”œâ”€â”€ ğŸ’¾ å­˜å‚¨å‹XSS (æœ€å±é™©)  
â”‚   â””â”€â”€ æ¶æ„ä»£ç å­˜åœ¨æ•°æ®åº“ï¼Œæ‰€æœ‰è®¿é—®è€…éƒ½ä¸­æ‹›
â””â”€â”€ ğŸ”„ DOMå‹XSS
    â””â”€â”€ æ¶æ„ä»£ç ç›´æ¥æ“ä½œç½‘é¡µDOMå…ƒç´ 
```

### 3.2 XSSæ”»å‡»å®ä¾‹ä¸å±å®³


**å±é™©çš„ä»£ç ç¤ºä¾‹ï¼š**
```jsp
<!-- âŒ å±é™©ï¼šç›´æ¥è¾“å‡ºç”¨æˆ·è¾“å…¥ -->
<%
String username = request.getParameter("name");
%>
<h1>æ¬¢è¿, <%= username %>!</h1>

<!-- å¦‚æœç”¨æˆ·è®¿é—®ï¼š
http://example.com/welcome.jsp?name=<script>alert('XSSæ”»å‡»!')</script>
é¡µé¢ä¼šæ‰§è¡Œæ¶æ„JavaScriptä»£ç  -->
```

**XSSæ”»å‡»çš„å±å®³ï¼š**
- **çªƒå–Cookie**ï¼šè·å–ç”¨æˆ·ç™»å½•çŠ¶æ€
- **åŠ«æŒè´¦æˆ·**ï¼šä»¥ç”¨æˆ·èº«ä»½æ‰§è¡Œæ“ä½œ
- **é’“é±¼æ¬ºè¯ˆ**ï¼šé‡å®šå‘åˆ°æ¶æ„ç½‘ç«™
- **é”®ç›˜è®°å½•**ï¼šçªƒå–ç”¨æˆ·è¾“å…¥çš„æ•æ„Ÿä¿¡æ¯

### 3.3 XSSé˜²å¾¡ç­–ç•¥


**ğŸ”¸ ç­–ç•¥ä¸€ï¼šè¾“å‡ºç¼–ç ï¼ˆæœ€é‡è¦ï¼‰**

```java
// âœ… å®‰å…¨çš„è¾“å‡ºç¼–ç 
public class XSSProtection {
    
    public static String encodeHtml(String input) {
        if (input == null) return "";
        
        return input.replace("&", "&amp;")
                   .replace("<", "&lt;")
                   .replace(">", "&gt;")
                   .replace("\"", "&quot;")
                   .replace("'", "&#x27;")
                   .replace("/", "&#x2F;");
    }
    
    public static String encodeJavaScript(String input) {
        if (input == null) return "";
        
        return input.replace("\\", "\\\\")
                   .replace("\"", "\\\"")
                   .replace("'", "\\'")
                   .replace("\n", "\\n")
                   .replace("\r", "\\r");
    }
}
```

**åœ¨JSPä¸­å®‰å…¨è¾“å‡ºï¼š**
```jsp
<!-- âœ… å®‰å…¨ï¼šä½¿ç”¨JSTLçš„fn:escapeXml -->
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %>
<h1>æ¬¢è¿, ${fn:escapeXml(username)}!</h1>

<!-- âœ… å®‰å…¨ï¼šè‡ªå®šä¹‰ç¼–ç å‡½æ•° -->
<h1>æ¬¢è¿, <%= XSSProtection.encodeHtml(username) %>!</h1>
```

**ğŸ”¸ ç­–ç•¥äºŒï¼šå†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆCSPï¼‰**

```html
<!-- åœ¨HTMLå¤´éƒ¨æ·»åŠ CSPç­–ç•¥ -->
<meta http-equiv="Content-Security-Policy" 
      content="default-src 'self'; script-src 'self' 'unsafe-inline';">

<!-- æˆ–è€…åœ¨HTTPå“åº”å¤´ä¸­æ·»åŠ  -->
```

```java
// åœ¨Servletä¸­è®¾ç½®CSPå“åº”å¤´
public class SecurityFilter implements Filter {
    public void doFilter(ServletRequest request, ServletResponse response, 
                        FilterChain chain) throws IOException, ServletException {
        
        HttpServletResponse httpResponse = (HttpServletResponse) response;
        
        // è®¾ç½®å†…å®¹å®‰å…¨ç­–ç•¥
        httpResponse.setHeader("Content-Security-Policy", 
            "default-src 'self'; script-src 'self'");
        
        chain.doFilter(request, response);
    }
}
```

**ğŸ”¸ ç­–ç•¥ä¸‰ï¼šè¾“å…¥éªŒè¯ä¸è¿‡æ»¤**

```java
// âœ… è¾“å…¥éªŒè¯å’Œæ¸…ç†
public class InputSanitizer {
    
    // ç§»é™¤HTMLæ ‡ç­¾
    public static String removeHtmlTags(String input) {
        if (input == null) return "";
        
        // ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ç§»é™¤HTMLæ ‡ç­¾
        return input.replaceAll("<[^>]*>", "");
    }
    
    // ç™½åå•éªŒè¯ï¼šåªå…è®¸å®‰å…¨å­—ç¬¦
    public static boolean isValidUserInput(String input) {
        if (input == null) return false;
        
        // åªå…è®¸å­—æ¯ã€æ•°å­—ã€ç©ºæ ¼å’ŒåŸºæœ¬æ ‡ç‚¹
        Pattern safePattern = Pattern.compile("^[a-zA-Z0-9\\s.,!?-]+$");
        return safePattern.matcher(input).matches();
    }
}
```

---

## 4. ğŸ”„ CSRFé˜²æŠ¤æŠ€æœ¯


### 4.1 ä»€ä¹ˆæ˜¯CSRFæ”»å‡»


**CSRF (Cross-Site Request Forgery) é€šä¿—ç†è§£ï¼š**
CSRFå°±åƒæ˜¯æœ‰äººå†’å……ä½ å»é“¶è¡Œå–é’±ã€‚

```
ç”Ÿæ´»ä¸­çš„CSRFæ”»å‡»ï¼š
1. ä½ ç™»å½•äº†ç½‘ä¸Šé“¶è¡Œï¼ˆè·å¾—äº†"é“¶è¡Œå¡"ï¼‰
2. ä½ è®¿é—®äº†ä¸€ä¸ªæ¶æ„ç½‘ç«™
3. æ¶æ„ç½‘ç«™å·å·ç”¨ä½ çš„"é“¶è¡Œå¡"è½¬è´¦
4. é“¶è¡Œè®¤ä¸ºæ˜¯ä½ æœ¬äººæ“ä½œï¼ˆå› ä¸ºæœ‰"é“¶è¡Œå¡"ï¼‰

Webä¸­çš„CSRFæ”»å‡»ï¼š
1. ä½ ç™»å½•äº†ç½‘ç«™Aï¼ˆæµè§ˆå™¨ä¿å­˜äº†Cookieï¼‰
2. ä½ è®¿é—®äº†æ¶æ„ç½‘ç«™B
3. ç½‘ç«™Bå·å·å‘é€è¯·æ±‚ç»™ç½‘ç«™A
4. ç½‘ç«™Aè®¤ä¸ºæ˜¯ä½ çš„æ“ä½œï¼ˆå› ä¸ºæœ‰Cookieï¼‰
```

### 4.2 CSRFæ”»å‡»å®ä¾‹


**å±é™©çš„è½¬è´¦æ“ä½œï¼š**
```html
<!-- æ­£å¸¸çš„è½¬è´¦è¡¨å• -->
<form action="/transfer" method="post">
    <input name="to" value="friend@email.com">
    <input name="amount" value="100">
    <button type="submit">è½¬è´¦</button>
</form>
```

**æ¶æ„ç½‘ç«™çš„CSRFæ”»å‡»ï¼š**
```html
<!-- æ¶æ„ç½‘ç«™çš„éšè—æ”»å‡» -->
<img src="http://yourbank.com/transfer?to=hacker@evil.com&amount=1000" 
     style="display:none;">
     
<!-- æˆ–è€…è‡ªåŠ¨æäº¤çš„è¡¨å• -->
<form action="http://yourbank.com/transfer" method="post" id="evilForm">
    <input name="to" value="hacker@evil.com">
    <input name="amount" value="1000">
</form>
<script>
    document.getElementById('evilForm').submit();
</script>
```

### 4.3 CSRFé˜²æŠ¤å®ç°


**ğŸ”¸ æ–¹æ³•ä¸€ï¼šCSRF Tokenï¼ˆæœ€å¸¸ç”¨ï¼‰**

```java
// CSRF Tokenç”Ÿæˆå™¨
public class CSRFTokenManager {
    private static final String CSRF_TOKEN_NAME = "csrfToken";
    
    // ç”Ÿæˆéšæœºtoken
    public static String generateToken() {
        return UUID.randomUUID().toString();
    }
    
    // åœ¨Sessionä¸­ä¿å­˜token
    public static void saveToken(HttpSession session, String token) {
        session.setAttribute(CSRF_TOKEN_NAME, token);
    }
    
    // éªŒè¯token
    public static boolean validateToken(HttpSession session, String submittedToken) {
        String sessionToken = (String) session.getAttribute(CSRF_TOKEN_NAME);
        return sessionToken != null && sessionToken.equals(submittedToken);
    }
}
```

**åœ¨JSPä¸­ä½¿ç”¨CSRF Tokenï¼š**
```jsp
<%
    // ç”Ÿæˆå¹¶ä¿å­˜CSRF Token
    String csrfToken = CSRFTokenManager.generateToken();
    CSRFTokenManager.saveToken(session, csrfToken);
%>

<!-- åœ¨è¡¨å•ä¸­æ·»åŠ éšè—çš„CSRF Token -->
<form action="/transfer" method="post">
    <input type="hidden" name="csrfToken" value="<%= csrfToken %>">
    <input name="to" placeholder="æ”¶æ¬¾äºº">
    <input name="amount" placeholder="é‡‘é¢">
    <button type="submit">è½¬è´¦</button>
</form>
```

**åœ¨Servletä¸­éªŒè¯CSRF Tokenï¼š**
```java
@WebServlet("/transfer")
public class TransferServlet extends HttpServlet {
    
    protected void doPost(HttpServletRequest request, 
                         HttpServletResponse response) throws IOException {
        
        String submittedToken = request.getParameter("csrfToken");
        
        // éªŒè¯CSRF Token
        if (!CSRFTokenManager.validateToken(request.getSession(), submittedToken)) {
            response.sendError(HttpServletResponse.SC_FORBIDDEN, "CSRFæ”»å‡»æ£€æµ‹");
            return;
        }
        
        // TokenéªŒè¯é€šè¿‡ï¼Œæ‰§è¡Œè½¬è´¦é€»è¾‘
        String to = request.getParameter("to");
        String amount = request.getParameter("amount");
        
        // ... æ‰§è¡Œè½¬è´¦
        
        response.getWriter().write("è½¬è´¦æˆåŠŸ");
    }
}
```

**ğŸ”¸ æ–¹æ³•äºŒï¼šéªŒè¯Refererå¤´**

```java
// éªŒè¯è¯·æ±‚æ¥æº
public class RefererValidator {
    
    public static boolean isValidReferer(HttpServletRequest request) {
        String referer = request.getHeader("Referer");
        String serverName = request.getServerName();
        
        // æ£€æŸ¥Refereræ˜¯å¦æ¥è‡ªåŒä¸€åŸŸå
        if (referer != null && referer.startsWith("http://" + serverName)) {
            return true;
        }
        
        return false;
    }
}
```

**ğŸ”¸ æ–¹æ³•ä¸‰ï¼šåŒé‡CookieéªŒè¯**

```java
// åŒé‡CookieéªŒè¯
public class DoubleCookieCSRF {
    
    public static void setCSRFCookie(HttpServletResponse response) {
        String token = UUID.randomUUID().toString();
        
        // è®¾ç½®HttpOnly=falseçš„Cookieï¼ˆJavaScriptå¯è¯»å–ï¼‰
        Cookie csrfCookie = new Cookie("CSRF-TOKEN", token);
        csrfCookie.setHttpOnly(false);
        csrfCookie.setSecure(true); // HTTPSç¯å¢ƒ
        response.addCookie(csrfCookie);
    }
    
    public static boolean validateCSRFToken(HttpServletRequest request) {
        // ä»Cookieä¸­è·å–token
        String cookieToken = getCookieValue(request, "CSRF-TOKEN");
        
        // ä»è¯·æ±‚å¤´ä¸­è·å–tokenï¼ˆç”±JavaScriptè®¾ç½®ï¼‰
        String headerToken = request.getHeader("X-CSRF-TOKEN");
        
        return cookieToken != null && cookieToken.equals(headerToken);
    }
    
    private static String getCookieValue(HttpServletRequest request, String name) {
        Cookie[] cookies = request.getCookies();
        if (cookies != null) {
            for (Cookie cookie : cookies) {
                if (name.equals(cookie.getName())) {
                    return cookie.getValue();
                }
            }
        }
        return null;
    }
}
```

---

## 5. ğŸ” è¾“å…¥éªŒè¯ä¸æ•°æ®è¿‡æ»¤


### 5.1 è¾“å…¥éªŒè¯çš„é‡è¦æ€§


**ä¸ºä»€ä¹ˆè¦éªŒè¯è¾“å…¥ï¼š**

```
ç”¨æˆ·è¾“å…¥å°±åƒæ˜¯è¿›å…¥ä½ å®¶çš„è®¿å®¢ï¼š
ğŸ  ä½ å®¶çš„é—¨å«æ£€æŸ¥ï¼š
   â”œâ”€â”€ èº«ä»½éªŒè¯ â†’ è¾“å…¥æ ¼å¼éªŒè¯
   â”œâ”€â”€ å®‰å…¨æ£€æŸ¥ â†’ æ¶æ„å†…å®¹è¿‡æ»¤  
   â”œâ”€â”€ ç‰©å“æ£€æŸ¥ â†’ æ•°æ®é•¿åº¦é™åˆ¶
   â””â”€â”€ è®¿é—®æƒé™ â†’ ä¸šåŠ¡é€»è¾‘éªŒè¯

æ²¡æœ‰éªŒè¯çš„åæœï¼š
âŒ åäººè¿›å…¥ä½ å®¶ â†’ æ¶æ„ç”¨æˆ·æ”»å‡»ç³»ç»Ÿ
âŒ å¸¦å…¥å±é™©å“ â†’ æ¶æ„ä»£ç æ³¨å…¥
âŒ ç ´åå®¶å…· â†’ ç³»ç»Ÿæ•°æ®è¢«ç¯¡æ”¹
```

### 5.2 å‰ç«¯è¾“å…¥éªŒè¯


**HTML5å†…ç½®éªŒè¯ï¼š**
```html
<!-- åŸºç¡€è¾“å…¥éªŒè¯ -->
<form>
    <!-- å¿…å¡«éªŒè¯ -->
    <input type="email" name="email" required 
           placeholder="è¯·è¾“å…¥é‚®ç®±åœ°å€">
    
    <!-- é•¿åº¦éªŒè¯ -->
    <input type="text" name="username" required
           minlength="3" maxlength="20" 
           placeholder="ç”¨æˆ·å(3-20å­—ç¬¦)">
    
    <!-- æ•°å­—èŒƒå›´éªŒè¯ -->
    <input type="number" name="age" 
           min="18" max="100" 
           placeholder="å¹´é¾„(18-100)">
    
    <!-- æ­£åˆ™è¡¨è¾¾å¼éªŒè¯ -->
    <input type="text" name="phone" 
           pattern="^1[3-9]\d{9}$" 
           placeholder="æ‰‹æœºå·ç ">
    
    <button type="submit">æäº¤</button>
</form>
```

**JavaScriptè‡ªå®šä¹‰éªŒè¯ï¼š**
```javascript
// è¡¨å•éªŒè¯å‡½æ•°
function validateForm() {
    const email = document.getElementById('email').value;
    const username = document.getElementById('username').value;
    const age = document.getElementById('age').value;
    
    // é‚®ç®±æ ¼å¼éªŒè¯
    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailPattern.test(email)) {
        alert('é‚®ç®±æ ¼å¼ä¸æ­£ç¡®');
        return false;
    }
    
    // ç”¨æˆ·åéªŒè¯ï¼ˆåªå…è®¸å­—æ¯æ•°å­—ä¸‹åˆ’çº¿ï¼‰
    const usernamePattern = /^[a-zA-Z0-9_]{3,20}$/;
    if (!usernamePattern.test(username)) {
        alert('ç”¨æˆ·ååªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼Œé•¿åº¦3-20ä½');
        return false;
    }
    
    // å¹´é¾„éªŒè¯
    if (age < 18 || age > 100) {
        alert('å¹´é¾„å¿…é¡»åœ¨18-100ä¹‹é—´');
        return false;
    }
    
    return true;
}
```

### 5.3 åç«¯è¾“å…¥éªŒè¯ï¼ˆå…³é”®ï¼‰


**ğŸ”¸ åŸºç¡€éªŒè¯å·¥å…·ç±»ï¼š**
```java
public class ValidationUtils {
    
    // éªŒè¯é‚®ç®±æ ¼å¼
    public static boolean isValidEmail(String email) {
        if (email == null || email.trim().isEmpty()) {
            return false;
        }
        
        String emailPattern = "^[A-Za-z0-9+_.-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$";
        return Pattern.matches(emailPattern, email);
    }
    
    // éªŒè¯æ‰‹æœºå·
    public static boolean isValidPhone(String phone) {
        if (phone == null) return false;
        
        String phonePattern = "^1[3-9]\\d{9}$";
        return Pattern.matches(phonePattern, phone);
    }
    
    // éªŒè¯å­—ç¬¦ä¸²é•¿åº¦
    public static boolean isValidLength(String str, int minLen, int maxLen) {
        if (str == null) return false;
        
        int length = str.trim().length();
        return length >= minLen && length <= maxLen;
    }
    
    // éªŒè¯æ•°å­—èŒƒå›´
    public static boolean isValidRange(int value, int min, int max) {
        return value >= min && value <= max;
    }
    
    // æ£€æŸ¥æ˜¯å¦åŒ…å«å±é™©å­—ç¬¦
    public static boolean containsDangerousChars(String input) {
        if (input == null) return false;
        
        String[] dangerous = {"<script>", "</script>", "javascript:", 
                             "<iframe>", "onclick=", "onerror="};
        
        String lowerInput = input.toLowerCase();
        for (String danger : dangerous) {
            if (lowerInput.contains(danger)) {
                return true;
            }
        }
        return false;
    }
}
```

**ğŸ”¸ Bean Validationï¼ˆJSR-303ï¼‰ä½¿ç”¨ï¼š**

```java
// ä½¿ç”¨æ³¨è§£è¿›è¡ŒéªŒè¯
public class User {
    
    @NotNull(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @Size(min = 3, max = 20, message = "ç”¨æˆ·åé•¿åº¦å¿…é¡»åœ¨3-20ä¹‹é—´")
    @Pattern(regexp = "^[a-zA-Z0-9_]+$", message = "ç”¨æˆ·ååªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿")
    private String username;
    
    @NotNull(message = "é‚®ç®±ä¸èƒ½ä¸ºç©º")
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String email;
    
    @NotNull(message = "å¹´é¾„ä¸èƒ½ä¸ºç©º")
    @Min(value = 18, message = "å¹´é¾„ä¸èƒ½å°äº18")
    @Max(value = 100, message = "å¹´é¾„ä¸èƒ½å¤§äº100")
    private Integer age;
    
    @Pattern(regexp = "^1[3-9]\\d{9}$", message = "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®")
    private String phone;
    
    // getterå’Œsetteræ–¹æ³•...
}
```

**åœ¨Servletä¸­ä½¿ç”¨Bean Validationï¼š**
```java
@WebServlet("/register")
public class RegisterServlet extends HttpServlet {
    
    private Validator validator;
    
    @Override
    public void init() throws ServletException {
        ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
        validator = factory.getValidator();
    }
    
    protected void doPost(HttpServletRequest request, 
                         HttpServletResponse response) throws IOException {
        
        // åˆ›å»ºç”¨æˆ·å¯¹è±¡
        User user = new User();
        user.setUsername(request.getParameter("username"));
        user.setEmail(request.getParameter("email"));
        user.setAge(Integer.parseInt(request.getParameter("age")));
        user.setPhone(request.getParameter("phone"));
        
        // è¿›è¡ŒéªŒè¯
        Set<ConstraintViolation<User>> violations = validator.validate(user);
        
        if (!violations.isEmpty()) {
            // éªŒè¯å¤±è´¥ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯
            List<String> errors = new ArrayList<>();
            for (ConstraintViolation<User> violation : violations) {
                errors.add(violation.getMessage());
            }
            
            request.setAttribute("errors", errors);
            request.getRequestDispatcher("/register.jsp").forward(request, response);
            return;
        }
        
        // éªŒè¯é€šè¿‡ï¼Œä¿å­˜ç”¨æˆ·
        // ... ä¿å­˜é€»è¾‘
        
        response.getWriter().write("æ³¨å†ŒæˆåŠŸ");
    }
}
```

### 5.4 æ–‡ä»¶ä¸Šä¼ å®‰å…¨éªŒè¯


**å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ éªŒè¯ï¼š**
```java
@MultipartConfig(maxFileSize = 1024 * 1024 * 10) // 10MBé™åˆ¶
@WebServlet("/upload")
public class FileUploadServlet extends HttpServlet {
    
    // å…è®¸çš„æ–‡ä»¶ç±»å‹
    private static final Set<String> ALLOWED_TYPES = Set.of(
        "image/jpeg", "image/png", "image/gif", 
        "application/pdf", "text/plain"
    );
    
    // å…è®¸çš„æ–‡ä»¶æ‰©å±•å
    private static final Set<String> ALLOWED_EXTENSIONS = Set.of(
        ".jpg", ".jpeg", ".png", ".gif", ".pdf", ".txt"
    );
    
    protected void doPost(HttpServletRequest request, 
                         HttpServletResponse response) throws IOException, ServletException {
        
        Part filePart = request.getPart("file");
        
        if (filePart == null || filePart.getSize() == 0) {
            response.getWriter().write("è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶");
            return;
        }
        
        // éªŒè¯æ–‡ä»¶å¤§å°
        if (filePart.getSize() > 10 * 1024 * 1024) {
            response.getWriter().write("æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡10MB");
            return;
        }
        
        // éªŒè¯æ–‡ä»¶ç±»å‹
        String contentType = filePart.getContentType();
        if (!ALLOWED_TYPES.contains(contentType)) {
            response.getWriter().write("ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹");
            return;
        }
        
        // éªŒè¯æ–‡ä»¶æ‰©å±•å
        String fileName = getFileName(filePart);
        String extension = getFileExtension(fileName);
        if (!ALLOWED_EXTENSIONS.contains(extension.toLowerCase())) {
            response.getWriter().write("ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼");
            return;
        }
        
        // ç”Ÿæˆå®‰å…¨çš„æ–‡ä»¶å
        String safeFileName = generateSafeFileName(fileName);
        String uploadPath = getServletContext().getRealPath("/uploads/");
        
        // ä¿å­˜æ–‡ä»¶
        filePart.write(uploadPath + safeFileName);
        
        response.getWriter().write("æ–‡ä»¶ä¸Šä¼ æˆåŠŸ: " + safeFileName);
    }
    
    private String getFileName(Part part) {
        String contentDisposition = part.getHeader("Content-Disposition");
        String[] tokens = contentDisposition.split(";");
        
        for (String token : tokens) {
            if (token.trim().startsWith("filename")) {
                return token.substring(token.indexOf("=") + 2, token.length() - 1);
            }
        }
        return "";
    }
    
    private String getFileExtension(String fileName) {
        int lastDot = fileName.lastIndexOf(".");
        return lastDot > 0 ? fileName.substring(lastDot) : "";
    }
    
    private String generateSafeFileName(String originalName) {
        // ç§»é™¤è·¯å¾„åˆ†éš”ç¬¦å’Œå±é™©å­—ç¬¦
        String safeName = originalName.replaceAll("[^a-zA-Z0-9._-]", "");
        
        // æ·»åŠ æ—¶é—´æˆ³é¿å…é‡å
        String timestamp = String.valueOf(System.currentTimeMillis());
        String extension = getFileExtension(safeName);
        String nameWithoutExt = safeName.replace(extension, "");
        
        return nameWithoutExt + "_" + timestamp + extension;
    }
}
```

---

## 6. ğŸ‘‘ æƒé™æ§åˆ¶ä¸è®¿é—®ç®¡ç†


### 6.1 æƒé™æ§åˆ¶åŸºæœ¬æ¦‚å¿µ


**æƒé™æ§åˆ¶å°±åƒæ˜¯å…¬å¸çš„é—¨ç¦ç³»ç»Ÿï¼š**

```
å…¬å¸é—¨ç¦ç³»ç»Ÿï¼š                   Webæƒé™æ§åˆ¶ï¼š
ğŸ¢ å¤§é—¨åˆ·å¡è¿›å…¥               â†’ ğŸ” ç”¨æˆ·ç™»å½•è®¤è¯
ğŸ“‹ ä¸åŒæ¥¼å±‚éœ€è¦ä¸åŒæƒé™       â†’ ğŸ­ è§’è‰²æƒé™ç®¡ç†  
ğŸ‘® ä¿å®‰æ£€æŸ¥èº«ä»½               â†’ ğŸ›¡ï¸ ä¼šè¯çŠ¶æ€éªŒè¯
ğŸ“ è®¿é—®è®°å½•ç™»è®°               â†’ ğŸ“Š æ“ä½œæ—¥å¿—è®°å½•
ğŸš« ç¦æ­¢è¿›å…¥ç‰¹å®šåŒºåŸŸ           â†’ âš ï¸ è®¿é—®æ‹’ç»å¤„ç†
```

**æƒé™æ§åˆ¶çš„æ ¸å¿ƒè¦ç´ ï¼š**

| è¦ç´  | **ä½œç”¨** | **å®ç°æ–¹å¼** | **ä¸¾ä¾‹** |
|------|----------|-------------|----------|
| ğŸ” **èº«ä»½è®¤è¯** | `ç¡®è®¤ä½ æ˜¯è°` | `ç”¨æˆ·åå¯†ç éªŒè¯` | `ç™»å½•ç³»ç»Ÿ` |
| ğŸ­ **è§’è‰²ç®¡ç†** | `ç¡®å®šä½ çš„èº«ä»½` | `ç”¨æˆ·è§’è‰²åˆ†é…` | `ç®¡ç†å‘˜ã€æ™®é€šç”¨æˆ·` |
| ğŸ›¡ï¸ **æƒé™éªŒè¯** | `ç¡®è®¤ä½ èƒ½åšä»€ä¹ˆ` | `æ“ä½œæƒé™æ£€æŸ¥` | `åˆ é™¤æ–‡ä»¶æƒé™` |
| ğŸ“Š **å®¡è®¡è®°å½•** | `è®°å½•ä½ åšäº†ä»€ä¹ˆ` | `æ“ä½œæ—¥å¿—è®°å½•` | `ç™»å½•ã€åˆ é™¤è®°å½•` |

### 6.2 åŸºäºè§’è‰²çš„æƒé™æ§åˆ¶ï¼ˆRBACï¼‰


**RBACæƒé™æ¨¡å‹ï¼š**

```
RBACæƒé™æ¨¡å‹ç»“æ„ï¼š
ç”¨æˆ·(User) â†â†’ è§’è‰²(Role) â†â†’ æƒé™(Permission) â†â†’ èµ„æº(Resource)

ä¸¾ä¾‹ï¼š
å¼ ä¸‰(ç”¨æˆ·) â†â†’ ç®¡ç†å‘˜(è§’è‰²) â†â†’ åˆ é™¤æƒé™(æƒé™) â†â†’ ç”¨æˆ·æ•°æ®(èµ„æº)
æå››(ç”¨æˆ·) â†â†’ ç¼–è¾‘è€…(è§’è‰²) â†â†’ ç¼–è¾‘æƒé™(æƒé™) â†â†’ æ–‡ç« æ•°æ®(èµ„æº)
ç‹äº”(ç”¨æˆ·) â†â†’ è®¿å®¢(è§’è‰²) â†â†’ æŸ¥çœ‹æƒé™(æƒé™) â†â†’ å…¬å¼€æ•°æ®(èµ„æº)
```

**æƒé™ç®¡ç†æ•°æ®åº“è®¾è®¡ï¼š**
```sql
-- ç”¨æˆ·è¡¨
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    email VARCHAR(100),
    status ENUM('active', 'inactive') DEFAULT 'active',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- è§’è‰²è¡¨
CREATE TABLE roles (
    id INT PRIMARY KEY AUTO_INCREMENT,
    role_name VARCHAR(50) UNIQUE NOT NULL,
    description TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- æƒé™è¡¨
CREATE TABLE permissions (
    id INT PRIMARY KEY AUTO_INCREMENT,
    permission_name VARCHAR(50) UNIQUE NOT NULL,
    resource VARCHAR(50),
    action VARCHAR(50),
    description TEXT
);

-- ç”¨æˆ·è§’è‰²å…³è”è¡¨
CREATE TABLE user_roles (
    user_id INT,
    role_id INT,
    PRIMARY KEY (user_id, role_id),
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (role_id) REFERENCES roles(id)
);

-- è§’è‰²æƒé™å…³è”è¡¨
CREATE TABLE role_permissions (
    role_id INT,
    permission_id INT,
    PRIMARY KEY (role_id, permission_id),
    FOREIGN KEY (role_id) REFERENCES roles(id),
    FOREIGN KEY (permission_id) REFERENCES permissions(id)
);
```

### 6.3 Session-basedæƒé™éªŒè¯å®ç°


**ç™»å½•éªŒè¯ä¸æƒé™è®¾ç½®ï¼š**
```java
@WebServlet("/login")
public class LoginServlet extends HttpServlet {
    
    protected void doPost(HttpServletRequest request, 
                         HttpServletResponse response) throws IOException, ServletException {
        
        String username = request.getParameter("username");
        String password = request.getParameter("password");
        
        // ç”¨æˆ·è®¤è¯
        User user = authenticateUser(username, password);
        if (user == null) {
            request.setAttribute("error", "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯");
            request.getRequestDispatcher("/login.jsp").forward(request, response);
            return;
        }
        
        // è·å–ç”¨æˆ·è§’è‰²å’Œæƒé™
        List<String> roles = getUserRoles(user.getId());
        List<String> permissions = getUserPermissions(user.getId());
        
        // å°†ç”¨æˆ·ä¿¡æ¯å­˜å‚¨åˆ°Session
        HttpSession session = request.getSession();
        session.setAttribute("currentUser", user);
        session.setAttribute("userRoles", roles);
        session.setAttribute("userPermissions", permissions);
        
        // è®°å½•ç™»å½•æ—¥å¿—
        logUserActivity(user.getId(), "LOGIN", request.getRemoteAddr());
        
        response.sendRedirect("/dashboard");
    }
    
    private User authenticateUser(String username, String password) {
        // ä»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·
        // éªŒè¯å¯†ç ï¼ˆä½¿ç”¨BCryptç­‰å®‰å…¨çš„å“ˆå¸Œç®—æ³•ï¼‰
        // è¿”å›ç”¨æˆ·å¯¹è±¡æˆ–null
        return null; // ç®€åŒ–ç¤ºä¾‹
    }
    
    private List<String> getUserRoles(int userId) {
        // æŸ¥è¯¢ç”¨æˆ·è§’è‰²
        return new ArrayList<>(); // ç®€åŒ–ç¤ºä¾‹
    }
    
    private List<String> getUserPermissions(int userId) {
        // æŸ¥è¯¢ç”¨æˆ·æƒé™
        return new ArrayList<>(); // ç®€åŒ–ç¤ºä¾‹
    }
    
    private void logUserActivity(int userId, String action, String ipAddress) {
        // è®°å½•ç”¨æˆ·æ“ä½œæ—¥å¿—
    }
}
```

**æƒé™éªŒè¯è¿‡æ»¤å™¨ï¼š**
```java
@WebFilter("/*")
public class AuthorizationFilter implements Filter {
    
    // ä¸éœ€è¦ç™»å½•å°±èƒ½è®¿é—®çš„é¡µé¢
    private static final Set<String> PUBLIC_PATHS = Set.of(
        "/login", "/register", "/", "/css/", "/js/", "/images/"
    );
    
    // éœ€è¦ç‰¹å®šæƒé™çš„é¡µé¢
    private static final Map<String, String> PROTECTED_PATHS = Map.of(
        "/admin/users", "USER_MANAGEMENT",
        "/admin/roles", "ROLE_MANAGEMENT", 
        "/user/delete", "DELETE_USER",
        "/user/edit", "EDIT_USER"
    );
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                        FilterChain chain) throws IOException, ServletException {
        
        HttpServletRequest httpRequest = (HttpServletRequest) request;
        HttpServletResponse httpResponse = (HttpServletResponse) response;
        
        String requestPath = httpRequest.getRequestURI();
        
        // æ£€æŸ¥æ˜¯å¦ä¸ºå…¬å¼€èµ„æº
        if (isPublicResource(requestPath)) {
            chain.doFilter(request, response);
            return;
        }
        
        // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»å½•
        HttpSession session = httpRequest.getSession(false);
        if (session == null || session.getAttribute("currentUser") == null) {
            httpResponse.sendRedirect("/login");
            return;
        }
        
        // æ£€æŸ¥ç‰¹å®šé¡µé¢çš„æƒé™
        String requiredPermission = PROTECTED_PATHS.get(requestPath);
        if (requiredPermission != null) {
            @SuppressWarnings("unchecked")
            List<String> userPermissions = (List<String>) session.getAttribute("userPermissions");
            
            if (userPermissions == null || !userPermissions.contains(requiredPermission)) {
                httpResponse.sendError(HttpServletResponse.SC_FORBIDDEN, "æ²¡æœ‰è®¿é—®æƒé™");
                return;
            }
        }
        
        chain.doFilter(request, response);
    }
    
    private boolean isPublicResource(String path) {
        return PUBLIC_PATHS.stream().anyMatch(path::startsWith);
    }
}
```

**æƒé™éªŒè¯å·¥å…·ç±»ï¼š**
```java
public class PermissionChecker {
    
    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰ç‰¹å®šæƒé™
    public static boolean hasPermission(HttpSession session, String permission) {
        @SuppressWarnings("unchecked")
        List<String> userPermissions = (List<String>) session.getAttribute("userPermissions");
        
        return userPermissions != null && userPermissions.contains(permission);
    }
    
    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰ç‰¹å®šè§’è‰²
    public static boolean hasRole(HttpSession session, String role) {
        @SuppressWarnings("unchecked")
        List<String> userRoles = (List<String>) session.getAttribute("userRoles");
        
        return userRoles != null && userRoles.contains(role);
    }
    
    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ä¸ºç®¡ç†å‘˜
    public static boolean isAdmin(HttpSession session) {
        return hasRole(session, "ADMIN");
    }
    
    // è·å–å½“å‰ç”¨æˆ·
    public static User getCurrentUser(HttpSession session) {
        return (User) session.getAttribute("currentUser");
    }
}
```

**åœ¨JSPä¸­ä½¿ç”¨æƒé™æ§åˆ¶ï¼š**
```jsp
<%@ page import="com.example.utils.PermissionChecker" %>

<!-- æ£€æŸ¥æ˜¯å¦æœ‰åˆ é™¤æƒé™ -->
<% if (PermissionChecker.hasPermission(session, "DELETE_USER")) { %>
    <button onclick="deleteUser()">åˆ é™¤ç”¨æˆ·</button>
<% } %>

<!-- æ£€æŸ¥æ˜¯å¦ä¸ºç®¡ç†å‘˜ -->
<% if (PermissionChecker.isAdmin(session)) { %>
    <a href="/admin/dashboard">ç®¡ç†åå°</a>
<% } %>

<!-- æ˜¾ç¤ºå½“å‰ç”¨æˆ·ä¿¡æ¯ -->
<%
    User currentUser = PermissionChecker.getCurrentUser(session);
    if (currentUser != null) {
%>
    <p>æ¬¢è¿ï¼Œ<%= currentUser.getUsername() %>!</p>
<% } %>
```

---

## 7. ğŸ” æ•°æ®åŠ å¯†ä¸ä¼ è¾“å®‰å…¨


### 7.1 å¯†ç å®‰å…¨å­˜å‚¨


**ä¸ºä»€ä¹ˆä¸èƒ½æ˜æ–‡å­˜å‚¨å¯†ç ï¼š**

```
å¯†ç å­˜å‚¨æ–¹æ¡ˆå¯¹æ¯”ï¼š

âŒ æ˜æ–‡å­˜å‚¨ï¼š
æ•°æ®åº“ï¼špassword = "123456"
é£é™©ï¼šæ•°æ®åº“æ³„éœ² = å¯†ç å…¨éƒ¨æ³„éœ²

âŒ ç®€å•MD5ï¼š  
æ•°æ®åº“ï¼špassword = MD5("123456")
é£é™©ï¼šå½©è™¹è¡¨æ”»å‡»ï¼Œç›¸åŒå¯†ç MD5ç›¸åŒ

âœ… åŠ ç›å“ˆå¸Œï¼š
æ•°æ®åº“ï¼šsalt = "randomString", password = BCrypt("123456" + salt)
å®‰å…¨ï¼šå³ä½¿æ•°æ®åº“æ³„éœ²ï¼Œä¹Ÿå¾ˆéš¾ç ´è§£åŸå§‹å¯†ç 
```

**ä½¿ç”¨BCryptå®‰å…¨å­˜å‚¨å¯†ç ï¼š**
```java
public class PasswordUtils {
    
    // åŠ å¯†å¯†ç 
    public static String hashPassword(String plainPassword) {
        // BCryptè‡ªåŠ¨ç”Ÿæˆç›å€¼ï¼Œå¼ºåº¦ä¸º12
        return BCrypt.hashpw(plainPassword, BCrypt.gensalt(12));
    }
    
    // éªŒè¯å¯†ç 
    public static boolean verifyPassword(String plainPassword, String hashedPassword) {
        return BCrypt.checkpw(plainPassword, hashedPassword);
    }
    
    // æ£€æŸ¥å¯†ç å¼ºåº¦
    public static boolean isStrongPassword(String password) {
        if (password == null || password.length() < 8) {
            return false;
        }
        
        // è‡³å°‘åŒ…å«ï¼šå¤§å†™å­—æ¯ã€å°å†™å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šå­—ç¬¦
        String pattern = "^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$";
        return Pattern.matches(pattern, password);
    }
}
```

**ç”¨æˆ·æ³¨å†Œæ—¶çš„å¯†ç å¤„ç†ï¼š**
```java
@WebServlet("/register")
public class RegisterServlet extends HttpServlet {
    
    protected void doPost(HttpServletRequest request, 
                         HttpServletResponse response) throws IOException, ServletException {
        
        String username = request.getParameter("username");
        String plainPassword = request.getParameter("password");
        String confirmPassword = request.getParameter("confirmPassword");
        
        // éªŒè¯å¯†ç å¼ºåº¦
        if (!PasswordUtils.isStrongPassword(plainPassword)) {
            request.setAttribute("error", 
                "å¯†ç å¿…é¡»åŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—å’Œç‰¹æ®Šå­—ç¬¦ï¼Œé•¿åº¦è‡³å°‘8ä½");
            request.getRequestDispatcher("/register.jsp").forward(request, response);
            return;
        }
        
        // ç¡®è®¤å¯†ç ä¸€è‡´æ€§
        if (!plainPassword.equals(confirmPassword)) {
            request.setAttribute("error", "ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´");
            request.getRequestDispatcher("/register.jsp").forward(request, response);
            return;
        }
        
        // åŠ å¯†å¯†ç 
        String hashedPassword = PasswordUtils.hashPassword(plainPassword);
        
        // ä¿å­˜ç”¨æˆ·ï¼ˆå¯†ç å·²åŠ å¯†ï¼‰
        User user = new User(username, hashedPassword);
        boolean success = userDAO.save(user);
        
        if (success) {
            response.sendRedirect("/login?registered=true");
        } else {
            request.setAttribute("error", "æ³¨å†Œå¤±è´¥ï¼Œè¯·é‡è¯•");
            request.getRequestDispatcher("/register.jsp").forward(request, response);
        }
    }
}
```

### 7.2 HTTPSé…ç½®ä¸ä½¿ç”¨


**ä¸ºä»€ä¹ˆéœ€è¦HTTPSï¼š**

```
HTTP vs HTTPSæ•°æ®ä¼ è¾“ï¼š

HTTP (ä¸å®‰å…¨)ï¼š
æµè§ˆå™¨ ----[æ˜æ–‡æ•°æ®]----> æœåŠ¡å™¨
       â†‘                  â†‘
    é»‘å®¢å¯ä»¥æ‹¦æˆªå¹¶è¯»å–æ‰€æœ‰æ•°æ®

HTTPS (å®‰å…¨)ï¼š
æµè§ˆå™¨ ----[åŠ å¯†æ•°æ®]----> æœåŠ¡å™¨
       â†‘                  â†‘
    é»‘å®¢æ‹¦æˆªåˆ°çš„æ˜¯åŠ å¯†å†…å®¹ï¼Œæ— æ³•è¯»å–
```

**åœ¨Tomcatä¸­é…ç½®HTTPSï¼š**
```xml
<!-- server.xmlé…ç½® -->
<Connector port="8443" protocol="org.apache.coyote.http11.Http11NioProtocol"
           maxThreads="150" SSLEnabled="true">
    <SSLHostConfig>
        <Certificate certificateKeystoreFile="conf/localhost-rsa.jks"
                     certificateKeystorePassword="changeit"
                     type="RSA" />
    </SSLHostConfig>
</Connector>
```

**å¼ºåˆ¶ä½¿ç”¨HTTPSçš„è¿‡æ»¤å™¨ï¼š**
```java
@WebFilter("/*")
public class HTTPSEnforceFilter implements Filter {
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, 
                        FilterChain chain) throws IOException, ServletException {
        
        HttpServletRequest httpRequest = (HttpServletRequest) request;
        HttpServletResponse httpResponse = (HttpServletResponse) response;
        
        // æ£€æŸ¥æ˜¯å¦ä¸ºHTTPSè¯·æ±‚
        if (!httpRequest.isSecure() && !isLocalhost(httpRequest)) {
            // é‡å®šå‘åˆ°HTTPS
            String httpsURL = "https://" + httpRequest.getServerName() + 
                             ":8443" + httpRequest.getRequestURI();
            
            if (httpRequest.getQueryString() != null) {
                httpsURL += "?" + httpRequest.getQueryString();
            }
            
            httpResponse.sendRedirect(httpsURL);
            return;
        }
        
        // è®¾ç½®å®‰å…¨å“åº”å¤´
        httpResponse.setHeader("Strict-Transport-Security", 
                              "max-age=31536000; includeSubDomains");
        httpResponse.setHeader("X-Content-Type-Options", "nosniff");
        httpResponse.setHeader("X-Frame-Options", "DENY");
        httpResponse.setHeader("X-XSS-Protection", "1; mode=block");
        
        chain.doFilter(request, response);
    }
    
    private boolean isLocalhost(HttpServletRequest request) {
        String serverName = request.getServerName();
        return "localhost".equals(serverName) || "127.0.0.1".equals(serverName);
    }
}
```

### 7.3 æ•æ„Ÿæ•°æ®åŠ å¯†


**æ•°æ®åº“æ•æ„Ÿå­—æ®µåŠ å¯†ï¼š**
```java
public class EncryptionUtils {
    
    private static final String ALGORITHM = "AES";
    private static final String TRANSFORMATION = "AES/ECB/PKCS5Padding";
    private static final String SECRET_KEY = "MySecretKey12345"; // å®é™…åº”ç”¨ä¸­åº”è¯¥ä»é…ç½®æ–‡ä»¶è¯»å–
    
    // åŠ å¯†
    public static String encrypt(String plainText) {
        try {
            Cipher cipher = Cipher.getInstance(TRANSFORMATION);
            SecretKeySpec keySpec = new SecretKeySpec(SECRET_KEY.getBytes(), ALGORITHM);
            cipher.init(Cipher.ENCRYPT_MODE, keySpec);
            
            byte[] encrypted = cipher.doFinal(plainText.getBytes());
            return Base64.getEncoder().encodeToString(encrypted);
            
        } catch (Exception e) {
            throw new RuntimeException("åŠ å¯†å¤±è´¥", e);
        }
    }
    
    // è§£å¯†
    public static String decrypt(String encryptedText) {
        try {
            Cipher cipher = Cipher.getInstance(TRANSFORMATION);
            SecretKeySpec keySpec = new SecretKeySpec(SECRET_KEY.getBytes(), ALGORITHM);
            cipher.init(Cipher.DECRYPT_MODE, keySpec);
            
            byte[] decoded = Base64.getDecoder().decode(encryptedText);
            byte[] decrypted = cipher.doFinal(decoded);
            
            return new String(decrypted);
            
        } catch (Exception e) {
            throw new RuntimeException("è§£å¯†å¤±è´¥", e);
        }
    }
}
```

**åœ¨å®ä½“ç±»ä¸­ä½¿ç”¨åŠ å¯†ï¼š**
```java
public class User {
    private int id;
    private String username;
    private String password; // ä½¿ç”¨BCryptå“ˆå¸Œ
    private String email;
    private String phoneNumber; // éœ€è¦åŠ å¯†çš„æ•æ„Ÿä¿¡æ¯
    private String idCard; // éœ€è¦åŠ å¯†çš„æ•æ„Ÿä¿¡æ¯
    
    // è·å–åŠ å¯†åçš„æ‰‹æœºå·
    public String getEncryptedPhoneNumber() {
        return phoneNumber != null ? EncryptionUtils.encrypt(phoneNumber) : null;
    }
    
    // è®¾ç½®æ‰‹æœºå·ï¼ˆè‡ªåŠ¨è§£å¯†ï¼‰
    public void setEncryptedPhoneNumber(String encryptedPhone) {
        this.phoneNumber = encryptedPhone != null ? EncryptionUtils.decrypt(encryptedPhone) : null;
    }
    
    // è·å–åŠ å¯†åçš„èº«ä»½è¯å·
    public String getEncryptedIdCard() {
        return idCard != null ? EncryptionUtils.encrypt(idCard) : null;
    }
    
    // è®¾ç½®èº«ä»½è¯å·ï¼ˆè‡ªåŠ¨è§£å¯†ï¼‰
    public void setEncryptedIdCard(String encryptedIdCard) {
        this.idCard = encryptedIdCard != null ? EncryptionUtils.decrypt(encryptedIdCard) : null;
    }
    
    // getterå’Œsetteræ–¹æ³•...
}
```

### 7.4 Sessionå®‰å…¨é…ç½®


**å®‰å…¨çš„Sessioné…ç½®ï¼š**
```xml
<!-- web.xmlä¸­é…ç½®Sessionå®‰å…¨ -->
<session-config>
    <!-- Sessionè¶…æ—¶æ—¶é—´ï¼ˆ30åˆ†é’Ÿï¼‰ -->
    <session-timeout>30</session-timeout>
    
    <cookie-config>
        <!-- åªèƒ½é€šè¿‡HTTPè®¿é—®ï¼Œé˜²æ­¢XSSçªƒå–Cookie -->
        <http-only>true</http-only>
        
        <!-- åªåœ¨HTTPSä¸‹ä¼ è¾“ -->
        <secure>true</secure>
        
        <!-- ä¸¥æ ¼çš„åŒç«™Cookieç­–ç•¥ -->
        <same-site>strict</same-site>
    </cookie-config>
</session-config>
```

**Sessionç®¡ç†å·¥å…·ï¼š**
```java
public class SessionManager {
    
    // åˆ›å»ºå®‰å…¨çš„Session
    public static void createSecureSession(HttpServletRequest request, User user) {
        // é”€æ¯æ—§Sessionï¼Œåˆ›å»ºæ–°Sessionï¼ˆé˜²æ­¢Sessionå›ºå®šæ”»å‡»ï¼‰
        HttpSession oldSession = request.getSession(false);
        if (oldSession != null) {
            oldSession.invalidate();
        }
        
        HttpSession newSession = request.getSession(true);
        
        // å­˜å‚¨ç”¨æˆ·ä¿¡æ¯
        newSession.setAttribute("currentUser", user);
        newSession.setAttribute("loginTime", new Date());
        newSession.setAttribute("lastActivity", new Date());
        
        // è®¾ç½®Sessionè¶…æ—¶ï¼ˆ30åˆ†é’Ÿï¼‰
        newSession.setMaxInactiveInterval(30 * 60);
    }
    
    // æ›´æ–°æœ€åæ´»åŠ¨æ—¶é—´
    public static void updateLastActivity(HttpSession session) {
        if (session != null) {
            session.setAttribute("lastActivity", new Date());
        }
    }
    
    // æ£€æŸ¥Sessionæ˜¯å¦æœ‰æ•ˆ
    public static boolean isValidSession(HttpSession session) {
        if (session == null) {
            return false;
        }
        
        User user = (User) session.getAttribute("currentUser");
        Date lastActivity = (Date) session.getAttribute("lastActivity");
        
        if (user == null || lastActivity == null) {
            return false;
        }
        
        // æ£€æŸ¥æ˜¯å¦è¶…è¿‡æœ€å¤§ç©ºé—²æ—¶é—´
        long idleTime = System.currentTimeMillis() - lastActivity.getTime();
        long maxIdleTime = session.getMaxInactiveInterval() * 1000L;
        
        return idleTime <= maxIdleTime;
    }
    
    // å®‰å…¨é€€å‡º
    public static void logout(HttpSession session) {
        if (session != null) {
            session.invalidate();
        }
    }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„å®‰å…¨æ¦‚å¿µ


```
ğŸ”¸ Webå®‰å…¨å¨èƒï¼šSQLæ³¨å…¥ã€XSSã€CSRFæ˜¯ä¸‰å¤§ä¸»è¦å¨èƒ
ğŸ”¸ é˜²å¾¡ç­–ç•¥ï¼šçºµæ·±é˜²å¾¡ã€æœ€å°æƒé™ã€ç™½åå•ã€æŒç»­ç›‘æ§
ğŸ”¸ è¾“å…¥éªŒè¯ï¼šå‰ç«¯éªŒè¯ç”¨æˆ·ä½“éªŒï¼Œåç«¯éªŒè¯ä¿è¯å®‰å…¨
ğŸ”¸ æƒé™æ§åˆ¶ï¼šè®¤è¯ï¼ˆä½ æ˜¯è°ï¼‰+ æˆæƒï¼ˆä½ èƒ½åšä»€ä¹ˆï¼‰
ğŸ”¸ æ•°æ®ä¿æŠ¤ï¼šå¯†ç åŠ å¯†å­˜å‚¨ã€æ•æ„Ÿæ•°æ®åŠ å¯†ä¼ è¾“
ğŸ”¸ ä¼ è¾“å®‰å…¨ï¼šHTTPSåŠ å¯†é€šä¿¡ã€å®‰å…¨å“åº”å¤´è®¾ç½®
```

### 8.2 å…³é”®é˜²æŠ¤è¦ç‚¹


**ğŸ”¹ SQLæ³¨å…¥é˜²æŠ¤æ ¸å¿ƒ**
```
æœ€ä½³å®è·µï¼š
â€¢ æ°¸è¿œä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥ï¼ˆPreparedStatementï¼‰
â€¢ æ°¸è¿œä¸è¦æ‹¼æ¥SQLå­—ç¬¦ä¸²
â€¢ è¾“å…¥éªŒè¯ï¼šé•¿åº¦ã€æ ¼å¼ã€å­—ç¬¦é›†é™åˆ¶
â€¢ æ•°æ®åº“æƒé™ï¼šä½¿ç”¨æœ€å°æƒé™åŸåˆ™
```

**ğŸ”¹ XSSé˜²æŠ¤æ ¸å¿ƒ**
```
é˜²æŠ¤ç­–ç•¥ï¼š
â€¢ è¾“å‡ºç¼–ç ï¼šæ‰€æœ‰ç”¨æˆ·è¾“å…¥åœ¨é¡µé¢æ˜¾ç¤ºå‰éƒ½è¦ç¼–ç 
â€¢ è¾“å…¥éªŒè¯ï¼šæ‹’ç»åŒ…å«è„šæœ¬æ ‡ç­¾çš„è¾“å…¥
â€¢ CSPç­–ç•¥ï¼šé™åˆ¶è„šæœ¬æ¥æºå’Œæ‰§è¡Œ
â€¢ HttpOnly Cookieï¼šé˜²æ­¢JavaScriptè®¿é—®æ•æ„ŸCookie
```

**ğŸ”¹ CSRFé˜²æŠ¤æ ¸å¿ƒ**
```
é˜²æŠ¤æœºåˆ¶ï¼š
â€¢ CSRF Tokenï¼šæ¯ä¸ªè¡¨å•éƒ½åŒ…å«éšæœºtoken
â€¢ æ£€æŸ¥Refererï¼šéªŒè¯è¯·æ±‚æ¥æº
â€¢ åŒé‡CookieéªŒè¯ï¼šJavaScriptè®¾ç½®è¯·æ±‚å¤´token
â€¢ é‡è¦æ“ä½œäºŒæ¬¡ç¡®è®¤ï¼šæ•æ„Ÿæ“ä½œéœ€è¦å†æ¬¡éªŒè¯
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ å®‰å…¨æ£€æŸ¥æ¸…å•**
```
ä»£ç å®¡æŸ¥è¦ç‚¹ï¼š
âœ… æ‰€æœ‰ç”¨æˆ·è¾“å…¥éƒ½è¿›è¡Œäº†éªŒè¯å’Œè¿‡æ»¤
âœ… æ•°æ®åº“æ“ä½œä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥
âœ… é¡µé¢è¾“å‡ºè¿›è¡Œäº†HTMLç¼–ç 
âœ… é‡è¦æ“ä½œæœ‰CSRFä¿æŠ¤
âœ… å¯†ç ä½¿ç”¨äº†å¼ºåŠ å¯†ç®—æ³•å­˜å‚¨
âœ… Sessioné…ç½®äº†å®‰å…¨å‚æ•°
âœ… å¯ç”¨äº†HTTPSä¼ è¾“åŠ å¯†
âœ… è®¾ç½®äº†å®‰å…¨å“åº”å¤´

è¿è¡Œæ—¶ç›‘æ§ï¼š
âœ… å¼‚å¸¸ç™»å½•å°è¯•å‘Šè­¦
âœ… SQLæ³¨å…¥æ”»å‡»æ£€æµ‹
âœ… å¼‚å¸¸æ–‡ä»¶ä¸Šä¼ ç›‘æ§
âœ… æ•æ„Ÿæ“ä½œå®¡è®¡æ—¥å¿—
```

**ğŸ”§ å¼€å‘å»ºè®®**
```
å®‰å…¨å¼€å‘ä¹ æƒ¯ï¼š
â€¢ æ°¸è¿œä¸ä¿¡ä»»ç”¨æˆ·è¾“å…¥
â€¢ ä½¿ç”¨æˆç†Ÿçš„å®‰å…¨æ¡†æ¶å’Œå·¥å…·
â€¢ å®šæœŸæ›´æ–°ä¾èµ–åº“ç‰ˆæœ¬
â€¢ è¿›è¡Œå®‰å…¨ä»£ç å®¡æŸ¥
â€¢ éƒ¨ç½²å‰è¿›è¡Œå®‰å…¨æµ‹è¯•

å¸¸ç”¨å®‰å…¨å·¥å…·ï¼š
â€¢ OWASP ZAPï¼šWebåº”ç”¨å®‰å…¨æ‰«æ
â€¢ SonarQubeï¼šä»£ç å®‰å…¨åˆ†æ
â€¢ Burp Suiteï¼šæ¸—é€æµ‹è¯•å·¥å…·
â€¢ SSL Labsï¼šHTTPSé…ç½®æ£€æµ‹
```

### 8.4 è®°å¿†è¦ç‚¹


**ğŸ§  å®‰å…¨è®°å¿†å£è¯€**
```
"è¾“å…¥éªŒè¯è¦ä¸¥æ ¼ï¼Œè¾“å‡ºç¼–ç é˜²æ³¨å…¥
CSRFä»¤ç‰Œä¸èƒ½å°‘ï¼ŒHTTPSåŠ å¯†ä¿ä¼ è¾“
å¯†ç åŠ ç›BCryptå­˜ï¼Œæƒé™æ§åˆ¶åˆ†çº§æ¸…
æ—¥å¿—ç›‘æ§è¦åˆ°ä½ï¼Œå®‰å…¨æ„è¯†è®°å¿ƒä¸­"
```

**âš ï¸ å®‰å…¨çº¢çº¿**
```
ç»å¯¹ä¸èƒ½åšçš„äº‹ï¼š
âŒ æ˜æ–‡å­˜å‚¨å¯†ç 
âŒ ç›´æ¥æ‹¼æ¥SQLè¯­å¥
âŒ ä¸éªŒè¯ç”¨æˆ·è¾“å…¥
âŒ ä¸è¿‡æ»¤é¡µé¢è¾“å‡º
âŒ å¿½ç•¥HTTPSè¯ä¹¦è­¦å‘Š
âŒ ä½¿ç”¨å¼±åŠ å¯†ç®—æ³•
âŒ æš´éœ²æ•æ„Ÿä¿¡æ¯
âŒ è·³è¿‡æƒé™éªŒè¯
```

**æ ¸å¿ƒç†è§£**ï¼š
- Webå®‰å…¨æ˜¯ä¸€ä¸ªç³»ç»Ÿå·¥ç¨‹ï¼Œéœ€è¦å¤šå±‚é˜²æŠ¤
- å®‰å…¨ä¸æ˜¯ä¸€æ¬¡æ€§å·¥ä½œï¼Œéœ€è¦æŒç»­å…³æ³¨å’Œæ”¹è¿›
- ç”¨æˆ·è¾“å…¥æ˜¯æœ€å¤§çš„é£é™©æºï¼Œå¿…é¡»ä¸¥æ ¼éªŒè¯å’Œè¿‡æ»¤
- æƒé™æ§åˆ¶æ˜¯ä¿æŠ¤ç³»ç»Ÿèµ„æºçš„æœ€åä¸€é“é˜²çº¿
- åŠ å¯†æŠ€æœ¯æ˜¯ä¿æŠ¤æ•°æ®å®‰å…¨çš„é‡è¦æ‰‹æ®µ
- å®‰å…¨é…ç½®å’Œç›‘æ§åŒæ ·é‡è¦