---
title: 5、gitattributes文件配置
---
## 📚 目录

1. [.gitattributes文件概述](#1-gitattributes文件概述)
2. [基础语法规则](#2-基础语法规则)
3. [文本属性配置](#3-文本属性配置)
4. [行结束符管理](#4-行结束符管理)
5. [合并策略控制](#5-合并策略控制)
6. [差异显示定制](#6-差异显示定制)
7. [导出控制配置](#7-导出控制配置)
8. [过滤器配置](#8-过滤器配置)
9. [语言检测设置](#9-语言检测设置)
10. [二进制文件处理](#10-二进制文件处理)
11. [核心要点总结](#11-核心要点总结)

---

## 1. 🎯 .gitattributes文件概述


### 1.1 什么是.gitattributes


**简单理解**：`.gitattributes`就像是Git的"文件管家"，它告诉Git怎么处理不同类型的文件。

```
把它想象成一个文件分类表：
📄 这些是文本文件，换行符要统一
🖼️这些是图片文件，不要尝试合并
📊 这些是数据文件，用特殊方式处理
🔧 这些是配置文件，需要特别小心
```

### 1.2 为什么需要.gitattributes


> 💡 **核心作用**  
> 解决团队协作中的文件处理问题，让Git知道如何"聪明地"处理不同文件

**主要解决的问题**：
- **换行符混乱**：Windows用`CRLF`，Mac/Linux用`LF`
- **合并冲突**：某些文件不应该自动合并
- **编码问题**：二进制文件被误认为文本文件
- **语言识别**：GitHub统计项目语言不准确

### 1.3 文件位置和作用范围


```
项目文件结构：
my-project/
├── .gitattributes      ← 作用于整个项目
├── src/
│   └── .gitattributes  ← 只作用于src目录
└── docs/
    └── README.md

作用优先级：
1. 最近的.gitattributes文件优先
2. 子目录的配置覆盖父目录
3. 全局配置文件最低优先级
```

---

## 2. 📝 基础语法规则


### 2.1 基本语法格式


**.gitattributes语法结构**：
```
模式 属性1 属性2=值 -属性3
```

**语法说明**：
- **模式**：文件路径匹配规则
- **属性**：要设置的属性名
- **属性=值**：为属性设置具体值
- **-属性**：取消某个属性

### 2.2 路径模式匹配


> 📖 **路径匹配规则**  
> 支持通配符和正则表达式，类似.gitignore文件

**常用模式示例**：
```gitattributes
# 匹配所有.txt文件
*.txt text

# 匹配特定目录下的文件
docs/*.md text

# 匹配多级目录
**/*.js text

# 匹配单个字符
data?.csv text

# 排除某些文件
*.log !important.log text
```

### 2.3 属性设置方式


| 设置方式 | **含义** | **示例** |
|---------|---------|---------|
| `属性` | 设置为true | `text` |
| `属性=值` | 设置具体值 | `eol=lf` |
| `-属性` | 取消属性 | `-text` |
| `!属性` | 重置为未设置 | `!text` |

---

## 3. 📄 文本属性配置


### 3.1 文本属性的三种状态


> 🎯 **核心概念**  
> `text`属性告诉Git这个文件是文本还是二进制

**三种设置方式**：

| 设置 | **含义** | **适用场景** |
|------|---------|-------------|
| `text` | 强制作为文本处理 | 确定是文本的文件 |
| `text=auto` | 让Git自动判断 | 不确定的文件类型 |
| `-text` | 强制作为二进制 | 确定是二进制的文件 |

### 3.2 实际配置示例


```gitattributes
# 源代码文件 - 明确指定为文本
*.js text
*.css text
*.html text
*.md text

# 配置文件 - 自动检测
*.json text=auto
*.xml text=auto

# 二进制文件 - 明确排除
*.png -text
*.jpg -text
*.exe -text
*.dll -text
```

### 3.3 文本检测的重要性


> ⚠️ **重要提醒**  
> 错误的文本/二进制分类会导致文件损坏

**常见问题**：
```
错误设置的后果：
1. 图片被当作文本 → 换行符转换 → 文件损坏
2. 文本被当作二进制 → 无法合并 → 协作困难
3. 编码问题 → 中文乱码 → 内容丢失
```

---

## 4. 🔄 行结束符管理


### 4.1 行结束符的跨平台问题


**不同系统的换行符**：
```
Windows:   CRLF (\r\n)  ← 回车+换行
Mac/Linux: LF (\n)      ← 只有换行
老Mac:     CR (\r)      ← 只有回车(已废弃)
```

> 💭 **形象理解**  
> 就像不同国家的人写信的格式不同，换行符也是各有各的习惯

### 4.2 eol属性配置


**统一换行符设置**：
```gitattributes
# 强制使用LF换行符(推荐)
*.txt text eol=lf
*.js text eol=lf
*.css text eol=lf

# 强制使用CRLF换行符
*.bat text eol=crlf
*.cmd text eol=crlf

# 让Git自动处理
*.md text=auto
```

### 4.3 推荐的换行符策略


> 🎯 **最佳实践**  
> 统一使用LF换行符，避免跨平台问题

```gitattributes
# 推荐配置：所有文本文件使用LF
* text=auto eol=lf

# 特殊情况：Windows批处理文件必须用CRLF
*.bat text eol=crlf
*.cmd text eol=crlf

# 二进制文件不处理换行符
*.png binary
*.jpg binary
*.exe binary
```

**配置效果**：
```
设置前的混乱：
file1.txt: CRLF (Windows开发者提交)
file2.txt: LF   (Mac开发者提交)
file3.txt: CRLF (另一个Windows开发者)

设置后的统一：
file1.txt: LF   (统一换行符)
file2.txt: LF   (统一换行符) 
file3.txt: LF   (统一换行符)
```

---

## 5. 🤝 合并策略控制


### 5.1 merge属性的作用


> 📖 **合并策略概念**  
> 控制Git在合并分支时如何处理冲突文件

**三种合并策略**：

| 策略 | **含义** | **适用场景** |
|------|---------|-------------|
| `merge` | 正常三方合并 | 普通文本文件 |
| `merge=binary` | 不尝试合并 | 二进制文件 |
| `merge=union` | 保留双方内容 | 日志文件 |

### 5.2 自定义合并策略


**特殊文件的合并设置**：
```gitattributes
# 自动生成的文件 - 不要合并
package-lock.json merge=ours
yarn.lock merge=ours

# 数据库文件 - 二进制合并
*.db merge=binary
*.sqlite merge=binary

# 日志文件 - 联合合并(保留所有内容)
*.log merge=union

# 版本文件 - 使用自定义驱动
VERSION merge=version-merge
```

### 5.3 实际应用示例


> 💡 **实用技巧**  
> 对于经常冲突的文件，设置合适的合并策略能减少手动解决冲突的工作

**场景示例**：
```
问题：package-lock.json经常冲突
原因：自动生成的文件，结构复杂

解决方案：
# .gitattributes
package-lock.json merge=ours

效果：
- 合并时自动使用本分支的版本
- 避免复杂的冲突解决
- 合并后重新运行npm install即可
```

---

## 6. 👁️ 差异显示定制


### 6.1 diff属性的作用


**控制文件差异显示**：
```gitattributes
# 文本文件正常显示差异
*.txt diff

# 二进制文件不显示内容差异
*.png diff=false
*.jpg diff=false

# 使用特定的差异驱动
*.pdf diff=pdf
*.doc diff=word
```

### 6.2 特殊文件的差异处理


> 🔧 **实用配置**  
> 为不同类型的文件配置合适的差异显示方式

**常见配置示例**：
```gitattributes
# 图片文件 - 只显示元信息
*.png diff=image
*.jpg diff=image
*.gif diff=image

# 压缩文件 - 不显示内容
*.zip diff=false
*.tar.gz diff=false

# 办公文档 - 使用专门工具
*.docx diff=word
*.xlsx diff=excel
*.pptx diff=powerpoint

# 密钥文件 - 不显示内容(安全考虑)
*.key diff=false
*.pem diff=false
```

### 6.3 自定义差异驱动


**配置示例**：
```bash
# Git配置中定义差异驱动
git config diff.word.textconv "pandoc --to=plain"
git config diff.pdf.textconv "pdftotext"
```

```gitattributes
# .gitattributes中使用
*.docx diff=word
*.pdf diff=pdf
```

---

## 7. 📦 导出控制配置


### 7.1 export-ignore属性


> 📖 **导出控制概念**  
> 决定哪些文件在创建归档时被排除

**基本用法**：
```gitattributes
# 开发文件 - 不包含在发布包中
.gitignore export-ignore
.gitattributes export-ignore
README.dev.md export-ignore

# 测试文件 - 不包含在发布包中
tests/ export-ignore
spec/ export-ignore
*.test.js export-ignore

# 开发工具配置
.eslintrc export-ignore
.prettierrc export-ignore
webpack.dev.js export-ignore
```

### 7.2 export-subst属性


**变量替换功能**：
```gitattributes
# 版本文件 - 自动替换Git信息
version.txt export-subst
```

**version.txt文件内容**：
```
Version: $Format:%H$
Date: $Format:%ci$
Tag: $Format:%d$
```

**导出后的效果**：
```
Version: a1b2c3d4e5f6...
Date: 2025-09-21 14:30:00 +0800
Tag: (tag: v1.0.0)
```

### 7.3 实际应用场景


> 💡 **使用技巧**  
> 合理使用导出控制，让发布包更简洁专业

**完整配置示例**：
```gitattributes
# 项目根目录文件
.gitignore export-ignore
.gitattributes export-ignore
.github/ export-ignore
.vscode/ export-ignore

# 开发依赖
node_modules/ export-ignore
vendor/ export-ignore

# 文档和测试
docs/ export-ignore
tests/ export-ignore
examples/ export-ignore

# 构建工具
gulpfile.js export-ignore
webpack.config.js export-ignore
package-lock.json export-ignore

# 版本信息自动替换
VERSION export-subst
```

---

## 8. 🔧 过滤器配置


### 8.1 filter属性概念


> 📖 **过滤器机制**  
> 在文件进出Git仓库时进行自动处理

**两个阶段**：
```
文件流向：
工作目录 --[clean]--> Git仓库 --[smudge]--> 工作目录

clean过滤器：  清理敏感信息，压缩内容
smudge过滤器：恢复完整内容，解压数据
```

### 8.2 过滤器配置示例


**密钥文件过滤**：
```bash
# Git配置
git config filter.remove-keys.clean 'sed "s/SECRET_KEY=.*/SECRET_KEY=***/"'
git config filter.remove-keys.smudge cat
```

```gitattributes
# .gitattributes
config/secrets.env filter=remove-keys
```

### 8.3 实用过滤器场景


> ⚠️ **注意事项**  
> 过滤器配置需要在团队成员间保持一致

**常见应用**：
```gitattributes
# 配置文件脱敏
*.env filter=env-clean
config/database.yml filter=db-clean

# 大文件压缩
*.log filter=compress
*.dump filter=compress

# 自动格式化
*.json filter=json-format
*.xml filter=xml-format
```

---

## 9. 🌐 语言检测设置


### 9.1 linguist-language属性


> 📊 **语言统计概念**  
> 影响GitHub项目语言统计和语法高亮

**基本用法**：
```gitattributes
# 指定文件语言
*.vue linguist-language=Vue
*.ts linguist-language=TypeScript
*.jsx linguist-language=JavaScript

# 排除某些文件的统计
vendor/ linguist-vendored
node_modules/ linguist-vendored
*.min.js linguist-generated
```

### 9.2 语言检测属性


| 属性 | **作用** | **示例** |
|------|---------|---------|
| `linguist-language` | 指定语言类型 | `linguist-language=Python` |
| `linguist-vendored` | 标记为第三方代码 | `vendor/` |
| `linguist-generated` | 标记为生成的代码 | `*.min.js` |
| `linguist-documentation` | 标记为文档 | `docs/` |

### 9.3 项目统计优化


> 🎯 **统计准确性**  
> 正确配置语言检测，让项目统计更准确

**完整配置示例**：
```gitattributes
# 正确识别特殊文件
*.vue linguist-language=Vue
*.ts linguist-language=TypeScript
*.tsx linguist-language=TypeScript
Dockerfile linguist-language=Dockerfile

# 排除第三方代码
vendor/ linguist-vendored
node_modules/ linguist-vendored
bower_components/ linguist-vendored
lib/ linguist-vendored

# 排除生成的文件
dist/ linguist-generated
build/ linguist-generated
*.min.js linguist-generated
*.min.css linguist-generated

# 排除文档文件
docs/ linguist-documentation
*.md linguist-documentation
```

---

## 10. 💾 二进制文件处理


### 10.1 binary属性


> 📖 **二进制文件概念**  
> 明确告诉Git某些文件是二进制格式，不要尝试文本处理

**binary属性等同于**：
```gitattributes
# 这两种写法效果相同
*.png binary

# 等同于
*.png -text -diff -merge
```

### 10.2 常见二进制文件配置


```gitattributes
# 图片文件
*.png binary
*.jpg binary
*.jpeg binary
*.gif binary
*.bmp binary
*.tiff binary
*.ico binary
*.svg binary

# 音视频文件
*.mp3 binary
*.mp4 binary
*.avi binary
*.mov binary
*.wav binary
*.flac binary

# 办公文档
*.pdf binary
*.doc binary
*.docx binary
*.xls binary
*.xlsx binary
*.ppt binary
*.pptx binary

# 压缩文件
*.zip binary
*.rar binary
*.7z binary
*.tar.gz binary

# 可执行文件
*.exe binary
*.dll binary
*.so binary
*.dylib binary
```

### 10.3 二进制文件的Git处理


> 💡 **处理特点**  
> 二进制文件在Git中的特殊处理方式

**Git对二进制文件的处理**：
```
存储方式：
- 完整存储每个版本
- 不进行差异计算
- 占用更多存储空间

操作限制：
- 不能查看文件差异
- 不能自动合并冲突
- 冲突时需要手动选择版本
```

---

## 11. 📋 核心要点总结


### 11.1 必须掌握的核心概念


> 🎯 **核心理解**  
> .gitattributes是Git的文件分类管理工具

```
🔸 .gitattributes作用：告诉Git如何处理不同类型的文件
🔸 文本属性：控制文件的文本/二进制识别
🔸 换行符管理：统一跨平台的换行符问题
🔸 合并策略：控制文件冲突时的合并方式
🔸 语言检测：影响GitHub的项目语言统计
🔸 二进制处理：明确标识不需要文本处理的文件
```

### 11.2 实用配置模板


> 🔧 **通用模板**  
> 适用于大多数项目的基础配置

```gitattributes
# 基础配置 - 所有文本文件统一换行符
* text=auto eol=lf

# Windows特殊文件
*.bat text eol=crlf
*.cmd text eol=crlf

# 源代码文件
*.js text
*.ts text
*.jsx text
*.tsx text
*.css text
*.scss text
*.html text
*.vue text
*.py text
*.java text
*.c text
*.cpp text
*.h text

# 配置文件
*.json text
*.yml text
*.yaml text
*.xml text
*.md text
*.txt text

# 二进制文件
*.png binary
*.jpg binary
*.jpeg binary
*.gif binary
*.ico binary
*.pdf binary
*.zip binary
*.tar.gz binary
*.exe binary
*.dll binary

# 第三方代码排除统计
node_modules/ linguist-vendored
vendor/ linguist-vendored
*.min.js linguist-generated
*.min.css linguist-generated

# 特殊合并策略
package-lock.json merge=ours
yarn.lock merge=ours
*.db merge=binary

# 导出时排除
.gitignore export-ignore
.gitattributes export-ignore
.github/ export-ignore
tests/ export-ignore
docs/ export-ignore
```

### 11.3 最佳实践建议


> 📝 **实践要点**  
> 在实际项目中应用.gitattributes的建议

**配置原则**：
1. **从简到繁**：先配置基础的文本/二进制分类
2. **逐步完善**：根据项目需要添加特殊配置
3. **团队一致**：确保所有成员使用相同配置
4. **定期检查**：验证配置是否按预期工作

**常见问题避免**：
- **不要过度配置**：只配置必要的文件类型
- **注意路径匹配**：使用正确的通配符语法
- **测试配置效果**：提交后检查文件是否正确处理
- **文档化配置**：为复杂配置添加注释说明

### 11.4 学习检查点


> 📋 **自测清单**  
> 检验对.gitattributes的理解程度

**基础理解**：
- [ ] 知道.gitattributes的作用和位置
- [ ] 理解文本属性的三种设置方式
- [ ] 掌握换行符统一的配置方法
- [ ] 了解二进制文件的标识方法

**进阶应用**：
- [ ] 能够配置合并策略避免冲突
- [ ] 会设置语言检测优化项目统计
- [ ] 理解导出控制的使用场景
- [ ] 知道过滤器的基本概念

**实践能力**：
- [ ] 能为新项目编写合适的.gitattributes
- [ ] 会根据文件类型调整配置
- [ ] 能解决跨平台换行符问题
- [ ] 知道如何调试属性配置

**核心记忆口诀**：
```
文件分类要明确，文本二进制分清楚
换行符号要统一，合并策略防冲突
语言检测助统计，导出控制更专业
```