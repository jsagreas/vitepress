---
title: 4ã€æ•°æ®åº“ä¸æ–‡ä»¶åŠ å¯†
---
## ğŸ“š ç›®å½•

1. [æ•°æ®åº“åŠ å¯†ç­–ç•¥](#1-æ•°æ®åº“åŠ å¯†ç­–ç•¥)
2. [æ–‡ä»¶ç³»ç»ŸåŠ å¯†](#2-æ–‡ä»¶ç³»ç»ŸåŠ å¯†)
3. [æ•æ„Ÿå­—æ®µè„±æ•](#3-æ•æ„Ÿå­—æ®µè„±æ•)
4. [é…ç½®æ–‡ä»¶åŠ å¯†](#4-é…ç½®æ–‡ä»¶åŠ å¯†)
5. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#5-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ—„ï¸ æ•°æ®åº“åŠ å¯†ç­–ç•¥


### 1.1 ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®åº“åŠ å¯†


**ç°å®é—®é¢˜**ï¼š
æƒ³è±¡ä¸€ä¸‹ï¼Œä½ çš„å…¬å¸å­˜å‚¨ç€ç”¨æˆ·çš„èº«ä»½è¯å·ã€é“¶è¡Œå¡å·ã€å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ã€‚å¦‚æœé»‘å®¢å…¥ä¾µäº†æ•°æ®åº“ï¼Œç›´æ¥å°±èƒ½çœ‹åˆ°æ‰€æœ‰æ˜æ–‡æ•°æ®ï¼Œè¿™å°†æ˜¯ç¾éš¾æ€§çš„ã€‚

```
æ²¡æœ‰åŠ å¯†çš„æ•°æ®åº“ï¼š
ç”¨æˆ·è¡¨
ID | å§“å   | èº«ä»½è¯å·        | é“¶è¡Œå¡å·
1  | å¼ ä¸‰   | 110101199001011234 | 6222021234567890
2  | æå››   | 220102199002022345 | 6222021234567891

é»‘å®¢å…¥ä¾µåç›´æ¥çœ‹åˆ°æ‰€æœ‰æ•æ„Ÿä¿¡æ¯ï¼ğŸ’€
```

**åŠ å¯†åçš„æ•ˆæœ**ï¼š
```
åŠ å¯†åçš„æ•°æ®åº“ï¼š
ç”¨æˆ·è¡¨
ID | å§“å   | èº«ä»½è¯å·(åŠ å¯†)          | é“¶è¡Œå¡å·(åŠ å¯†)
1  | å¼ ä¸‰   | AES256$kx9f2m...      | AES256$mn8k3p...
2  | æå››   | AES256$pk2n8v...      | AES256$qw7r2s...

å³ä½¿è¢«ç›—ä¹Ÿæ— æ³•ç›´æ¥ä½¿ç”¨ï¼ğŸ”’
```

### 1.2 æ•°æ®åº“åŠ å¯†çš„å±‚æ¬¡


#### ğŸ” é€æ˜æ•°æ®åŠ å¯†ï¼ˆTDEï¼‰


**ä»€ä¹ˆæ˜¯TDE**ï¼š
TDEå°±åƒç»™æ•´ä¸ªæ•°æ®åº“æ–‡ä»¶åŠ äº†ä¸€æŠŠå¤§é”ï¼Œæ‰€æœ‰æ•°æ®åœ¨å­˜å‚¨åˆ°ç¡¬ç›˜æ—¶è‡ªåŠ¨åŠ å¯†ï¼Œè¯»å–æ—¶è‡ªåŠ¨è§£å¯†ã€‚

```
TDEå·¥ä½œåŸç†ï¼š

åº”ç”¨ç¨‹åº â†â†’ æ•°æ®åº“å¼•æ“ â†â†’ å­˜å‚¨å¼•æ“ â†â†’ ç£ç›˜æ–‡ä»¶
    â†‘           â†‘            â†‘           â†‘
  æ˜æ–‡æ•°æ®    æ­£å¸¸SQL      è‡ªåŠ¨åŠ å¯†    åŠ å¯†æ–‡ä»¶

ç”¨æˆ·æ„Ÿå—ï¼šå®Œå…¨é€æ˜ï¼Œä¸éœ€è¦ä¿®æ”¹ä»»ä½•ä»£ç 
å®‰å…¨æ•ˆæœï¼šå³ä½¿æœ‰äººå·èµ°ç¡¬ç›˜ï¼Œä¹Ÿæ— æ³•ç›´æ¥è¯»å–æ•°æ®
```

**TDEä¼˜åŠ¿**ï¼š
- âœ… **å¯¹åº”ç”¨é€æ˜**ï¼šä¸éœ€è¦ä¿®æ”¹ç°æœ‰ä»£ç 
- âœ… **å…¨é‡ä¿æŠ¤**ï¼šæ•´ä¸ªæ•°æ®åº“éƒ½è¢«åŠ å¯†
- âœ… **æ€§èƒ½è¾ƒå¥½**ï¼šç¡¬ä»¶çº§åˆ«çš„åŠ å¯†è§£å¯†

**TDEå±€é™**ï¼š
- âŒ **æƒé™å†…å¯è§**ï¼šæœ‰æ•°æ®åº“æƒé™çš„ç”¨æˆ·ä»èƒ½çœ‹åˆ°æ˜æ–‡
- âŒ **å†…å­˜æ˜æ–‡**ï¼šæ•°æ®åœ¨å†…å­˜ä¸­ä»æ˜¯æ˜æ–‡çŠ¶æ€

#### ğŸ¯ å­—æ®µçº§åŠ å¯†


**ä»€ä¹ˆæ˜¯å­—æ®µçº§åŠ å¯†**ï¼š
åªå¯¹ç‰¹å®šçš„æ•æ„Ÿå­—æ®µè¿›è¡ŒåŠ å¯†ï¼Œå°±åƒåªç»™é‡è¦çš„æŠ½å±‰ä¸Šé”ã€‚

```java
// ç®€å•çš„å­—æ®µåŠ å¯†ç¤ºä¾‹
public class UserService {
    private AESUtil aesUtil = new AESUtil();
    
    // ä¿å­˜ç”¨æˆ·æ—¶åŠ å¯†æ•æ„Ÿå­—æ®µ
    public void saveUser(User user) {
        // èº«ä»½è¯å·åŠ å¯†
        String encryptedIdCard = aesUtil.encrypt(user.getIdCard());
        user.setIdCard(encryptedIdCard);
        
        // é“¶è¡Œå¡å·åŠ å¯†
        String encryptedBankCard = aesUtil.encrypt(user.getBankCard());
        user.setBankCard(encryptedBankCard);
        
        userRepository.save(user);
    }
    
    // æŸ¥è¯¢ç”¨æˆ·æ—¶è§£å¯†æ•æ„Ÿå­—æ®µ
    public User getUser(Long id) {
        User user = userRepository.findById(id);
        
        // è§£å¯†èº«ä»½è¯å·
        String idCard = aesUtil.decrypt(user.getIdCard());
        user.setIdCard(idCard);
        
        return user;
    }
}
```

**å­—æ®µçº§åŠ å¯†çš„ç­–ç•¥**ï¼š

| åŠ å¯†ç­–ç•¥ | **é€‚ç”¨åœºæ™¯** | **ç‰¹ç‚¹** | **ç¤ºä¾‹** |
|---------|------------|----------|---------|
| ğŸ”´ **å¼ºåŠ å¯†** | `ç»å¯¹æœºå¯†` | `ä¸å¯é€†ï¼Œæ— æ³•æŸ¥è¯¢` | `ç”¨æˆ·å¯†ç ` |
| ğŸŸ¡ **å¯é€†åŠ å¯†** | `éœ€è¦è§£å¯†æ˜¾ç¤º` | `å¯åŠ è§£å¯†ï¼Œå½±å“æŸ¥è¯¢` | `èº«ä»½è¯å·` |
| ğŸŸ¢ **å•å‘å“ˆå¸Œ** | `åªéœ€éªŒè¯` | `ä¸å¯é€†ï¼Œæ”¯æŒæ¯”è¾ƒ` | `å¯†ç éªŒè¯` |

### 1.3 æ•°æ®åº“åŠ å¯†å®ç°æ–¹æ¡ˆ


#### ğŸ’¾ MySQLåŠ å¯†å®ç°


```sql
-- 1. é€æ˜æ•°æ®åŠ å¯†ï¼ˆMySQL 8.0+ï¼‰
-- å¯ç”¨TDE
ALTER INSTANCE ROTATE INNODB MASTER KEY;

-- åˆ›å»ºåŠ å¯†è¡¨
CREATE TABLE sensitive_data (
    id INT PRIMARY KEY,
    name VARCHAR(100),
    credit_card VARBINARY(256)
) ENCRYPTION='Y';

-- 2. åº”ç”¨å±‚åŠ å¯†
-- ä½¿ç”¨AESåŠ å¯†å‡½æ•°
INSERT INTO users (name, id_card) VALUES 
('å¼ ä¸‰', AES_ENCRYPT('110101199001011234', 'my-secret-key'));

-- æŸ¥è¯¢æ—¶è§£å¯†
SELECT name, AES_DECRYPT(id_card, 'my-secret-key') as id_card 
FROM users WHERE id = 1;
```

#### ğŸ¯ åŠ å¯†å¯†é’¥ç®¡ç†


**å¯†é’¥ç®¡ç†çš„ä¸‰ä¸ªå±‚æ¬¡**ï¼š

```
1. åº”ç”¨å±‚ç®¡ç†ï¼ˆä¸æ¨èï¼‰
åº”ç”¨ä»£ç  â†’ ç¡¬ç¼–ç å¯†é’¥ âŒ ä¸å®‰å…¨

2. é…ç½®æ–‡ä»¶ç®¡ç†ï¼ˆä¸€èˆ¬ï¼‰
åº”ç”¨ä»£ç  â†’ é…ç½®æ–‡ä»¶ â†’ å¯†é’¥ âš ï¸ éœ€è¦ä¿æŠ¤é…ç½®æ–‡ä»¶

3. ä¸“ä¸šå¯†é’¥ç®¡ç†ï¼ˆæ¨èï¼‰
åº”ç”¨ä»£ç  â†’ KMSæœåŠ¡ â†’ å¯†é’¥ âœ… ä¸“ä¸šå®‰å…¨
```

**å¯†é’¥è½®æ¢æœºåˆ¶**ï¼š
```java
public class KeyRotationService {
    // æ”¯æŒå¤šä¸ªå¯†é’¥ç‰ˆæœ¬
    private Map<String, String> keyVersions = new HashMap<>();
    
    public String encryptWithCurrentKey(String data) {
        String currentKey = getCurrentKey();
        String encrypted = encrypt(data, currentKey);
        return "v2:" + encrypted; // æ ‡è®°å¯†é’¥ç‰ˆæœ¬
    }
    
    public String decrypt(String encryptedData) {
        if (encryptedData.startsWith("v2:")) {
            return decrypt(encryptedData.substring(3), getKeyV2());
        } else if (encryptedData.startsWith("v1:")) {
            return decrypt(encryptedData.substring(3), getKeyV1());
        }
        throw new IllegalArgumentException("æœªçŸ¥å¯†é’¥ç‰ˆæœ¬");
    }
}
```

---

## 2. ğŸ“‚ æ–‡ä»¶ç³»ç»ŸåŠ å¯†


### 2.1 æ–‡ä»¶åŠ å¯†çš„å¿…è¦æ€§


**å®é™…åœºæ™¯**ï¼š
- **ğŸ“„ åˆåŒæ–‡æ¡£**ï¼šå•†ä¸šæœºå¯†ä¸èƒ½æ³„éœ²
- **ğŸ’° è´¢åŠ¡æŠ¥è¡¨**ï¼šæ•æ„Ÿè´¢åŠ¡æ•°æ®
- **ğŸ‘¤ å‘˜å·¥æ¡£æ¡ˆ**ï¼šä¸ªäººéšç§ä¿¡æ¯
- **ğŸ”§ æºä»£ç **ï¼šæ ¸å¿ƒæŠ€æœ¯èµ„äº§

### 2.2 æ–‡ä»¶åŠ å¯†æ–¹å¼å¯¹æ¯”


#### ğŸ”’ æ“ä½œç³»ç»Ÿçº§åŠ å¯†


**Windows BitLocker**ï¼š
```
æ•´ä¸ªç¡¬ç›˜åŠ å¯†ï¼š
C:\ é©±åŠ¨å™¨ â†’ BitLockeråŠ å¯† â†’ å¼€æœºè¾“å…¥å¯†ç è§£é”

ä¼˜ç‚¹ï¼š
âœ… ç®€å•æ˜“ç”¨ï¼Œç³»ç»Ÿçº§æ”¯æŒ
âœ… é€æ˜åŠ å¯†ï¼Œä¸å½±å“ä½¿ç”¨
âœ… é˜²æ­¢ç¡¬ç›˜è¢«ç›—åæ•°æ®æ³„éœ²

ç¼ºç‚¹ï¼š
âŒ ç³»ç»Ÿå¯åŠ¨åæ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯æ˜æ–‡
âŒ æ— æ³•ç²¾ç»†æ§åˆ¶å•ä¸ªæ–‡ä»¶
```

**Linuxæ–‡ä»¶ç³»ç»ŸåŠ å¯†**ï¼š
```bash
# åˆ›å»ºåŠ å¯†åˆ†åŒº
sudo cryptsetup luksFormat /dev/sdb1

# æ‰“å¼€åŠ å¯†åˆ†åŒº
sudo cryptsetup luksOpen /dev/sdb1 encrypted_disk

# æŒ‚è½½ä½¿ç”¨
sudo mount /dev/mapper/encrypted_disk /mnt/encrypted
```

#### ğŸ“ åº”ç”¨å±‚æ–‡ä»¶åŠ å¯†


```java
public class FileEncryption {
    private static final String ALGORITHM = "AES/CBC/PKCS5Padding";
    
    // åŠ å¯†æ–‡ä»¶
    public void encryptFile(String inputFile, String outputFile, String password) {
        try {
            // ç”Ÿæˆå¯†é’¥
            SecretKey key = generateKey(password);
            
            // åˆå§‹åŒ–åŠ å¯†å™¨
            Cipher cipher = Cipher.getInstance(ALGORITHM);
            cipher.init(Cipher.ENCRYPT_MODE, key);
            
            // è¯»å–åŸæ–‡ä»¶ï¼ŒåŠ å¯†åå†™å…¥æ–°æ–‡ä»¶
            try (FileInputStream fis = new FileInputStream(inputFile);
                 FileOutputStream fos = new FileOutputStream(outputFile)) {
                
                byte[] buffer = new byte[8192];
                int bytesRead;
                
                while ((bytesRead = fis.read(buffer)) != -1) {
                    byte[] encrypted = cipher.update(buffer, 0, bytesRead);
                    if (encrypted != null) {
                        fos.write(encrypted);
                    }
                }
                
                // å†™å…¥æœ€ç»ˆå—
                byte[] finalBlock = cipher.doFinal();
                if (finalBlock != null) {
                    fos.write(finalBlock);
                }
            }
        } catch (Exception e) {
            throw new RuntimeException("æ–‡ä»¶åŠ å¯†å¤±è´¥", e);
        }
    }
    
    // è§£å¯†æ–‡ä»¶
    public void decryptFile(String inputFile, String outputFile, String password) {
        // ç±»ä¼¼åŠ å¯†è¿‡ç¨‹ï¼Œä½¿ç”¨DECRYPT_MODE
    }
}
```

### 2.3 æ–‡ä»¶åŠ å¯†æœ€ä½³å®è·µ


#### ğŸ¯ åˆ†çº§åŠ å¯†ç­–ç•¥


```
ğŸ“Š æ–‡ä»¶æ•æ„Ÿçº§åˆ«åˆ†ç±»ï¼š

ğŸ”´ æœºå¯†çº§ï¼ˆTop Secretï¼‰
â””â”€â”€ æ ¸å¿ƒç®—æ³•ä»£ç ã€å•†ä¸šæœºå¯†
    â”œâ”€â”€ åŠ å¯†ï¼šAES-256 + RSAå¯†é’¥äº¤æ¢
    â”œâ”€â”€ è®¿é—®ï¼šä»…æ ¸å¿ƒå›¢é˜Ÿ
    â””â”€â”€ å­˜å‚¨ï¼šç¦»çº¿åŠ å¯†å­˜å‚¨

ğŸŸ¡ æ•æ„Ÿçº§ï¼ˆSensitiveï¼‰  
â””â”€â”€ å®¢æˆ·èµ„æ–™ã€è´¢åŠ¡æ•°æ®
    â”œâ”€â”€ åŠ å¯†ï¼šAES-128
    â”œâ”€â”€ è®¿é—®ï¼šç›¸å…³éƒ¨é—¨æˆæƒ
    â””â”€â”€ å­˜å‚¨ï¼šåŠ å¯†æ•°æ®åº“

ğŸŸ¢ å†…éƒ¨çº§ï¼ˆInternalï¼‰
â””â”€â”€ ä¸€èˆ¬ä¸šåŠ¡æ–‡æ¡£
    â”œâ”€â”€ åŠ å¯†ï¼šç®€å•åŠ å¯†
    â”œâ”€â”€ è®¿é—®ï¼šå‘˜å·¥å¯è§
    â””â”€â”€ å­˜å‚¨ï¼šæ™®é€šå­˜å‚¨
```

#### ğŸ” åŠ å¯†æ–‡ä»¶å‘½åè§„èŒƒ


```
åŠ å¯†æ–‡ä»¶å‘½åç¤ºä¾‹ï¼š

åŸæ–‡ä»¶ï¼šcontract_2024_alibaba.pdf
åŠ å¯†æ–‡ä»¶ï¼šcontract_2024_alibaba.pdf.aes256

å…ƒæ•°æ®æ–‡ä»¶ï¼šcontract_2024_alibaba.pdf.meta
å†…å®¹ï¼š
{
  "algorithm": "AES-256-CBC",
  "created": "2024-01-15T10:30:00Z", 
  "owner": "legal_dept",
  "classification": "confidential"
}
```

---

## 3. ğŸ­ æ•æ„Ÿå­—æ®µè„±æ•


### 3.1 ä»€ä¹ˆæ˜¯æ•°æ®è„±æ•


**é€šä¿—ç†è§£**ï¼š
æ•°æ®è„±æ•å°±æ˜¯æŠŠçœŸå®çš„æ•æ„Ÿæ•°æ®"æ‰“ç "ï¼Œè®©å®ƒçœ‹èµ·æ¥åƒçœŸçš„ï¼Œä½†åˆä¸æ˜¯çœŸçš„ã€‚å°±åƒç”µè§†ä¸Šç»™äººè„¸æ‰“é©¬èµ›å…‹ä¸€æ ·ã€‚

```
è„±æ•å‰åå¯¹æ¯”ï¼š

çœŸå®æ•°æ®ï¼š
å§“åï¼šå¼ ä¸‰ä¸°    æ‰‹æœºï¼š13812345678    èº«ä»½è¯ï¼š110101199001011234

è„±æ•æ•°æ®ï¼š
å§“åï¼šå¼ **      æ‰‹æœºï¼š138****5678    èº«ä»½è¯ï¼š1101**********1234

ç‰¹ç‚¹ï¼šä¿ç•™æ ¼å¼ï¼Œéšè—å…³é”®ä¿¡æ¯
```

### 3.2 è„±æ•ç­–ç•¥ä¸æ–¹æ³•


#### ğŸ¯ å¸¸è§è„±æ•è§„åˆ™


| æ•°æ®ç±»å‹ | **è„±æ•è§„åˆ™** | **ç¤ºä¾‹** | **ç”¨é€”** |
|---------|------------|----------|---------|
| ğŸ“± **æ‰‹æœºå·** | `å‰3å4ä¸­é—´*` | `138****5678` | `å®¢æœæŸ¥è¯¢` |
| ğŸ†” **èº«ä»½è¯** | `å‰6å4ä¸­é—´*` | `110101********1234` | `å®åéªŒè¯` |
| ğŸ’³ **é“¶è¡Œå¡** | `å‰4å4ä¸­é—´*` | `6222****5678` | `æ”¯ä»˜æ˜¾ç¤º` |
| ğŸ“§ **é‚®ç®±** | `@å‰ä¿ç•™é¦–æœ«å­—ç¬¦` | `z***g@qq.com` | `æ‰¾å›å¯†ç ` |
| ğŸ  **åœ°å€** | `ä¿ç•™çœå¸‚åŒº` | `åŒ—äº¬å¸‚æœé˜³åŒº***` | `é…é€åŒºåŸŸ` |

#### ğŸ’» è„±æ•å®ç°ä»£ç 


```java
public class DataMasking {
    
    // æ‰‹æœºå·è„±æ•
    public static String maskPhone(String phone) {
        if (phone == null || phone.length() != 11) {
            return phone;
        }
        return phone.substring(0, 3) + "****" + phone.substring(7);
    }
    
    // èº«ä»½è¯è„±æ•  
    public static String maskIdCard(String idCard) {
        if (idCard == null || idCard.length() != 18) {
            return idCard;
        }
        return idCard.substring(0, 6) + "********" + idCard.substring(14);
    }
    
    // é“¶è¡Œå¡è„±æ•
    public static String maskBankCard(String bankCard) {
        if (bankCard == null || bankCard.length() < 8) {
            return bankCard;
        }
        return bankCard.substring(0, 4) + 
               "*".repeat(bankCard.length() - 8) + 
               bankCard.substring(bankCard.length() - 4);
    }
    
    // é‚®ç®±è„±æ•
    public static String maskEmail(String email) {
        if (email == null || !email.contains("@")) {
            return email;
        }
        
        String[] parts = email.split("@");
        String username = parts[0];
        String domain = parts[1];
        
        if (username.length() <= 2) {
            return "*".repeat(username.length()) + "@" + domain;
        }
        
        return username.charAt(0) + 
               "*".repeat(username.length() - 2) + 
               username.charAt(username.length() - 1) + 
               "@" + domain;
    }
}
```

### 3.3 åŠ¨æ€è„±æ•ä¸é™æ€è„±æ•


#### ğŸ”„ åŠ¨æ€è„±æ•


**ä»€ä¹ˆæ˜¯åŠ¨æ€è„±æ•**ï¼š
æ•°æ®åº“é‡Œå­˜çš„æ˜¯çœŸå®æ•°æ®ï¼Œä½†æ ¹æ®ç”¨æˆ·æƒé™ï¼ŒæŸ¥è¯¢æ—¶è‡ªåŠ¨è„±æ•æ˜¾ç¤ºã€‚

```java
@Service
public class UserQueryService {
    
    @Autowired
    private UserRepository userRepository;
    
    // æ ¹æ®æƒé™è¿”å›ä¸åŒçº§åˆ«çš„æ•°æ®
    public UserDTO getUserInfo(Long userId, String userRole) {
        User user = userRepository.findById(userId);
        UserDTO dto = new UserDTO();
        
        dto.setName(user.getName());
        
        // æ ¹æ®è§’è‰²å†³å®šè„±æ•çº§åˆ«
        switch (userRole) {
            case "ADMIN":
                // ç®¡ç†å‘˜çœ‹åˆ°å®Œæ•´ä¿¡æ¯
                dto.setPhone(user.getPhone());
                dto.setIdCard(user.getIdCard());
                break;
                
            case "CUSTOMER_SERVICE":
                // å®¢æœåªèƒ½çœ‹åˆ°éƒ¨åˆ†ä¿¡æ¯
                dto.setPhone(DataMasking.maskPhone(user.getPhone()));
                dto.setIdCard(DataMasking.maskIdCard(user.getIdCard()));
                break;
                
            case "GUEST":
                // è®¿å®¢çœ‹ä¸åˆ°æ•æ„Ÿä¿¡æ¯
                dto.setPhone("***********");
                dto.setIdCard("******************");
                break;
        }
        
        return dto;
    }
}
```

#### ğŸ“Š é™æ€è„±æ•


**ä»€ä¹ˆæ˜¯é™æ€è„±æ•**ï¼š
ç›´æ¥æŠŠæ•°æ®åº“é‡Œçš„æ•æ„Ÿæ•°æ®æ›¿æ¢æˆè„±æ•æ•°æ®ï¼Œç”¨äºæµ‹è¯•ç¯å¢ƒã€‚

```sql
-- ç”Ÿäº§ç¯å¢ƒæ•°æ®è„±æ•è„šæœ¬ï¼ˆç”¨äºæµ‹è¯•ç¯å¢ƒï¼‰

-- æ‰‹æœºå·è„±æ•
UPDATE users SET 
phone = CONCAT(
    SUBSTRING(phone, 1, 3),
    '****', 
    SUBSTRING(phone, 8, 4)
);

-- èº«ä»½è¯è„±æ•
UPDATE users SET 
id_card = CONCAT(
    SUBSTRING(id_card, 1, 6),
    '********',
    SUBSTRING(id_card, 15, 4) 
);

-- é‚®ç®±è„±æ•
UPDATE users SET 
email = CONCAT(
    SUBSTRING(email, 1, 1),
    '***',
    SUBSTRING(email, POSITION('@' IN email))
);
```

### 3.4 è„±æ•å·¥å…·ä¸æœ€ä½³å®è·µ


#### ğŸ› ï¸ ä¸“ä¸šè„±æ•å·¥å…·


```
ä¼ä¸šçº§è„±æ•å·¥å…·å¯¹æ¯”ï¼š

ğŸ¢ å•†ä¸šå·¥å…·ï¼š
â”œâ”€â”€ IBM InfoSphere Optim
â”œâ”€â”€ Oracle Data Masking  
â””â”€â”€ Microsoft SSIS

ğŸ”“ å¼€æºå·¥å…·ï¼š
â”œâ”€â”€ Apache Griffin
â”œâ”€â”€ DataMasker
â””â”€â”€ è‡ªç ”è„±æ•ç»„ä»¶

é€‰æ‹©æ ‡å‡†ï¼š
âœ… è„±æ•è§„åˆ™ä¸°å¯Œ
âœ… æ€§èƒ½è¡¨ç°è‰¯å¥½  
âœ… æ”¯æŒå¤šæ•°æ®æº
âœ… å¯é…ç½®æ€§å¼º
```

---

## 4. âš™ï¸ é…ç½®æ–‡ä»¶åŠ å¯†


### 4.1 ä¸ºä»€ä¹ˆè¦åŠ å¯†é…ç½®æ–‡ä»¶


**å…¸å‹é—®é¢˜åœºæ™¯**ï¼š
```properties
# application.propertiesï¼ˆæœªåŠ å¯†ï¼‰
database.url=jdbc:mysql://localhost:3306/mydb
database.username=root
database.password=123456

redis.host=localhost
redis.password=myredispwd

aws.accessKey=AKIAIOSFODNN7EXAMPLE
aws.secretKey=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
```

**é£é™©**ï¼š
- ğŸš¨ **æºç æ³„éœ²**ï¼šé…ç½®æ–‡ä»¶è¢«æäº¤åˆ°Git
- ğŸš¨ **æœåŠ¡å™¨å…¥ä¾µ**ï¼šé»‘å®¢ç›´æ¥è¯»å–é…ç½®æ–‡ä»¶
- ğŸš¨ **å†…éƒ¨æ³„éœ²**ï¼šè¿ç»´äººå‘˜å¯ä»¥çœ‹åˆ°æ‰€æœ‰å¯†ç 

### 4.2 é…ç½®æ–‡ä»¶åŠ å¯†æ–¹æ¡ˆ


#### ğŸ” Spring Booté…ç½®åŠ å¯†


**ä½¿ç”¨jasyptè¿›è¡Œé…ç½®åŠ å¯†**ï¼š
```xml
<!-- pom.xml -->
<dependency>
    <groupId>com.github.ulisesbocchio</groupId>
    <artifactId>jasypt-spring-boot-starter</artifactId>
    <version>3.0.4</version>
</dependency>
```

```properties
# application.propertiesï¼ˆåŠ å¯†åï¼‰
database.url=jdbc:mysql://localhost:3306/mydb
database.username=root
database.password=ENC(K8rJx2zKz8fG7Ybv9Qw3Er5Ty6Uip1As)

redis.host=localhost  
redis.password=ENC(Mn8Hx3zKy9fG2Ybv8Qw4Er2Ty7Uip9Zx)

aws.accessKey=ENC(Lp7Jx4zKz1fG5Ybv3Qw7Er9Ty2Uip6Cv)
aws.secretKey=ENC(Qw9Kx5zKy2fG8Ybv1Qw2Er4Ty8Uip3Bm)
```

**åŠ å¯†å·¥å…·**ï¼š
```java
public class ConfigEncryptor {
    public static void main(String[] args) {
        // åˆ›å»ºåŠ å¯†å™¨
        StandardPBEStringEncryptor encryptor = new StandardPBEStringEncryptor();
        encryptor.setPassword("mySecretKey"); // ä¸»å¯†é’¥
        encryptor.setAlgorithm("PBEWithMD5AndDES");
        
        // åŠ å¯†æ•æ„Ÿé…ç½®
        String password = "123456";
        String encrypted = encryptor.encrypt(password);
        System.out.println("åŠ å¯†å: ENC(" + encrypted + ")");
        
        // éªŒè¯è§£å¯†
        String decrypted = encryptor.decrypt(encrypted);
        System.out.println("è§£å¯†å: " + decrypted);
    }
}
```

**å¯åŠ¨æ—¶æŒ‡å®šä¸»å¯†é’¥**ï¼š
```bash
# æ–¹å¼1ï¼šç¯å¢ƒå˜é‡
export JASYPT_ENCRYPTOR_PASSWORD=mySecretKey
java -jar myapp.jar

# æ–¹å¼2ï¼šå¯åŠ¨å‚æ•°
java -jar myapp.jar --jasypt.encryptor.password=mySecretKey

# æ–¹å¼3ï¼šç³»ç»Ÿå±æ€§
java -Djasypt.encryptor.password=mySecretKey -jar myapp.jar
```

#### ğŸŒŸ ç¯å¢ƒå˜é‡æ–¹å¼


```yaml
# application.yml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/mydb
    username: ${DB_USERNAME:root}
    password: ${DB_PASSWORD:defaultpwd}
    
redis:
  host: ${REDIS_HOST:localhost}
  password: ${REDIS_PASSWORD:defaultpwd}
```

**Dockeréƒ¨ç½²æ—¶è®¾ç½®ç¯å¢ƒå˜é‡**ï¼š
```bash
# docker-compose.yml
version: '3'
services:
  myapp:
    image: myapp:latest
    environment:
      - DB_USERNAME=prod_user
      - DB_PASSWORD=complex_password_123
      - REDIS_PASSWORD=redis_secret_456
    env_file:
      - .env.prod  # ä»æ–‡ä»¶åŠ è½½ç¯å¢ƒå˜é‡
```

### 4.3 å¯†é’¥ç®¡ç†ç­–ç•¥


#### ğŸ”‘ åˆ†å±‚å¯†é’¥ç®¡ç†


```
å¯†é’¥ç®¡ç†å±‚æ¬¡ï¼š

1ï¸âƒ£ åº”ç”¨å±‚å¯†é’¥
â””â”€â”€ ç”¨äºåŠ å¯†ä¸šåŠ¡æ•°æ®
    â”œâ”€â”€ æ•°æ®åº“å­—æ®µåŠ å¯†
    â””â”€â”€ æ–‡ä»¶åŠ å¯†

2ï¸âƒ£ é…ç½®å±‚å¯†é’¥  
â””â”€â”€ ç”¨äºåŠ å¯†é…ç½®æ–‡ä»¶
    â”œâ”€â”€ æ•°æ®åº“è¿æ¥å¯†ç 
    â””â”€â”€ ç¬¬ä¸‰æ–¹APIå¯†é’¥

3ï¸âƒ£ ä¸»å¯†é’¥ï¼ˆKEKï¼‰
â””â”€â”€ ç”¨äºåŠ å¯†å…¶ä»–å¯†é’¥
    â”œâ”€â”€ å­˜å‚¨åœ¨å®‰å…¨ç¡¬ä»¶ä¸­
    â””â”€â”€ æˆ–ä¸“ä¸šå¯†é’¥ç®¡ç†æœåŠ¡
```

#### ğŸ¢ ä¼ä¸šçº§å¯†é’¥ç®¡ç†


```java
// ä½¿ç”¨äº‘æœåŠ¡å•†çš„å¯†é’¥ç®¡ç†æœåŠ¡
public class CloudKMSService {
    
    private KMSClient kmsClient;
    
    // ä»äº‘KMSè·å–å¯†é’¥
    public String getDecryptionKey(String keyId) {
        DecryptRequest request = DecryptRequest.builder()
            .keyId(keyId)
            .build();
            
        DecryptResponse response = kmsClient.decrypt(request);
        return new String(response.plaintext().asByteArray());
    }
    
    // åŠ å¯†é…ç½®å€¼
    public String encryptConfigValue(String value, String keyId) {
        EncryptRequest request = EncryptRequest.builder()
            .keyId(keyId)
            .plaintext(SdkBytes.fromUtf8String(value))
            .build();
            
        EncryptResponse response = kmsClient.encrypt(request);
        return Base64.getEncoder().encodeToString(
            response.ciphertextBlob().asByteArray()
        );
    }
}
```

### 4.4 é…ç½®æ–‡ä»¶å®‰å…¨æœ€ä½³å®è·µ


#### âœ… å®‰å…¨æ£€æŸ¥æ¸…å•


```
ğŸ” é…ç½®æ–‡ä»¶å®‰å…¨æ£€æŸ¥ï¼š

ğŸ“ æ•æ„Ÿä¿¡æ¯è¯†åˆ«
â”œâ”€â”€ [ ] æ•°æ®åº“å¯†ç 
â”œâ”€â”€ [ ] Rediså¯†ç   
â”œâ”€â”€ [ ] ç¬¬ä¸‰æ–¹APIå¯†é’¥
â”œâ”€â”€ [ ] JWTç­¾åå¯†é’¥
â””â”€â”€ [ ] åŠ å¯†saltå€¼

ğŸ”’ åŠ å¯†æªæ–½
â”œâ”€â”€ [ ] æ•æ„Ÿé…ç½®å·²åŠ å¯†
â”œâ”€â”€ [ ] å¯†é’¥ç‹¬ç«‹ç®¡ç†
â”œâ”€â”€ [ ] ç¯å¢ƒéš”ç¦»é…ç½®
â””â”€â”€ [ ] è®¿é—®æƒé™æ§åˆ¶

ğŸš« å®‰å…¨ç¦å¿Œ
â”œâ”€â”€ [ ] å¯†ç æ˜æ–‡å­˜å‚¨
â”œâ”€â”€ [ ] é…ç½®æ–‡ä»¶æäº¤Git
â”œâ”€â”€ [ ] ç”Ÿäº§å¯†é’¥å†™æ­»ä»£ç 
â””â”€â”€ [ ] åŒä¸€å¯†é’¥å¤šç¯å¢ƒå¤ç”¨
```

#### ğŸ¯ å¼€å‘è¿ç»´åˆ†ç¦»


```
é…ç½®ç®¡ç†èŒè´£åˆ†ç¦»ï¼š

ğŸ‘¨â€ğŸ’» å¼€å‘äººå‘˜ï¼š
â”œâ”€â”€ ç¼–å†™é…ç½®æ¨¡æ¿
â”œâ”€â”€ å®šä¹‰é…ç½®è§„èŒƒ
â””â”€â”€ ä½¿ç”¨å ä½ç¬¦

ğŸ‘¨â€ğŸ”§ è¿ç»´äººå‘˜ï¼š
â”œâ”€â”€ ç®¡ç†ç”Ÿäº§å¯†é’¥
â”œâ”€â”€ éƒ¨ç½²æ—¶æ³¨å…¥é…ç½®
â””â”€â”€ ç›‘æ§é…ç½®å®‰å…¨

ğŸ¢ å®‰å…¨å›¢é˜Ÿï¼š
â”œâ”€â”€ åˆ¶å®šåŠ å¯†ç­–ç•¥
â”œâ”€â”€ å®¡è®¡é…ç½®å®‰å…¨
â””â”€â”€ å¯†é’¥è½®æ¢ç®¡ç†
```

---

## 5. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 5.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æ•°æ®åº“åŠ å¯†ï¼šé€æ˜åŠ å¯†ä¿æŠ¤å­˜å‚¨ï¼Œå­—æ®µåŠ å¯†ä¿æŠ¤å†…å®¹
ğŸ”¸ æ–‡ä»¶ç³»ç»ŸåŠ å¯†ï¼šç³»ç»Ÿçº§å…¨ç›˜åŠ å¯† vs åº”ç”¨çº§æ–‡ä»¶åŠ å¯†
ğŸ”¸ æ•°æ®è„±æ•ï¼šä¿æŠ¤æ•æ„Ÿä¿¡æ¯ï¼Œæ”¯æŒä¸šåŠ¡ä½¿ç”¨
ğŸ”¸ é…ç½®æ–‡ä»¶åŠ å¯†ï¼šé˜²æ­¢å¯†é’¥æ³„éœ²ï¼Œå®‰å…¨éƒ¨ç½²åº”ç”¨
```

### 5.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ åŠ å¯†ç­–ç•¥é€‰æ‹©**
```
æ•°æ®æ•æ„Ÿç¨‹åº¦ï¼š
é«˜æ•æ„Ÿ â†’ å¼ºåŠ å¯† + ä¸¥æ ¼è®¿é—®æ§åˆ¶
ä¸­æ•æ„Ÿ â†’ æ ‡å‡†åŠ å¯† + è§’è‰²æƒé™
ä½æ•æ„Ÿ â†’ ç®€å•åŠ å¯† + åŸºç¡€ä¿æŠ¤

æ€§èƒ½è¦æ±‚ï¼š
é«˜æ€§èƒ½ â†’ ç¡¬ä»¶åŠ é€Ÿ + ç®—æ³•ä¼˜åŒ–
ä¸€èˆ¬æ€§èƒ½ â†’ æ ‡å‡†å®ç°
ä½æ€§èƒ½è¦æ±‚ â†’ å¯æ¥å—å¤æ‚åŠ å¯†
```

**ğŸ”¹ å¯†é’¥ç®¡ç†åŸåˆ™**
```
åˆ†ç¦»åŸåˆ™ï¼šå¯†é’¥ä¸æ•°æ®åˆ†å¼€å­˜å‚¨
è½®æ¢åŸåˆ™ï¼šå®šæœŸæ›´æ¢åŠ å¯†å¯†é’¥
æœ€å°æƒé™ï¼šæŒ‰éœ€åˆ†é…å¯†é’¥è®¿é—®æƒé™
å®¡è®¡åŸåˆ™ï¼šè®°å½•æ‰€æœ‰å¯†é’¥æ“ä½œ
```

**ğŸ”¹ è„±æ•ä¸åŠ å¯†çš„åŒºåˆ«**
```
è„±æ•ï¼šéšè—æ•æ„Ÿä¿¡æ¯ï¼Œä¸å¯é€†
ç”¨é€”ï¼šå±•ç¤ºã€æµ‹è¯•ã€åˆ†æ

åŠ å¯†ï¼šä¿æŠ¤æ•°æ®å®‰å…¨ï¼Œå¯é€†
ç”¨é€”ï¼šå­˜å‚¨ã€ä¼ è¾“ã€å¤‡ä»½
```

### 5.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ ä¼ä¸šå®æ–½å»ºè®®**

```
å®æ–½ä¼˜å…ˆçº§ï¼š
1ï¸âƒ£ é…ç½®æ–‡ä»¶åŠ å¯†ï¼ˆç«‹å³å®æ–½ï¼‰
2ï¸âƒ£ æ•°æ®åº“æ•æ„Ÿå­—æ®µåŠ å¯†
3ï¸âƒ£ æ–‡ä»¶ç³»ç»ŸåŠ å¯†
4ï¸âƒ£ æ•°æ®è„±æ•ç­–ç•¥

æŠ€æœ¯é€‰å‹ï¼š
å°å‹ä¼ä¸š â†’ å¼€æºå·¥å…· + ç®€å•å®ç°
ä¸­å‹ä¼ä¸š â†’ äº‘æœåŠ¡ + æ ‡å‡†æ–¹æ¡ˆ  
å¤§å‹ä¼ä¸š â†’ ä¸“ä¸šäº§å“ + å®šåˆ¶å¼€å‘
```

**ğŸ› ï¸ å¸¸è§é—®é¢˜è§£å†³**

```
æ€§èƒ½é—®é¢˜ï¼š
- é€‰æ‹©ç¡¬ä»¶åŠ é€Ÿç®—æ³•
- æ‰¹é‡å¤„ç†å‡å°‘å¼€é”€
- ç¼“å­˜è§£å¯†ç»“æœ

å…¼å®¹é—®é¢˜ï¼š
- æ¸è¿›å¼å‡çº§ç­–ç•¥
- ç‰ˆæœ¬å…¼å®¹è®¾è®¡  
- å›æ»šæ–¹æ¡ˆå‡†å¤‡

è¿ç»´é—®é¢˜ï¼š
- è‡ªåŠ¨åŒ–å¯†é’¥ç®¡ç†
- ç›‘æ§å‘Šè­¦æœºåˆ¶
- åº”æ€¥å“åº”æµç¨‹
```

### 5.4 å®‰å…¨æ³¨æ„äº‹é¡¹


```
ğŸš¨ å¸¸è§å®‰å…¨é™·é˜±ï¼š

å¯†é’¥ç¡¬ç¼–ç ï¼š
âŒ String key = "mySecretKey123";
âœ… String key = System.getenv("ENCRYPTION_KEY");

å¼±åŠ å¯†ç®—æ³•ï¼š
âŒ DESã€MD5
âœ… AES-256ã€SHA-256

å¯†é’¥é‡ç”¨ï¼š
âŒ æ‰€æœ‰æ•°æ®ç”¨åŒä¸€å¯†é’¥
âœ… ä¸åŒæ•°æ®ç”¨ä¸åŒå¯†é’¥

æƒé™è¿‡å®½ï¼š
âŒ æ‰€æœ‰äººéƒ½èƒ½è§£å¯†
âœ… æœ€å°æƒé™åŸåˆ™
```

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- **æ•°æ®åº“åŠ å¯†**ï¼šTDEé€æ˜ä¿æŠ¤ï¼Œå­—æ®µåŠ å¯†ç²¾ç¡®æ§åˆ¶
- **æ–‡ä»¶åŠ å¯†**ï¼šç³»ç»Ÿçº§ç®€å•ï¼Œåº”ç”¨çº§çµæ´»
- **æ•°æ®è„±æ•**ï¼šæ˜¾ç¤ºéšè—ï¼Œæµ‹è¯•å®‰å…¨ï¼Œæƒé™åˆ†çº§
- **é…ç½®åŠ å¯†**ï¼šå¯†é’¥åˆ†ç¦»ï¼Œç¯å¢ƒéš”ç¦»ï¼Œè¿ç»´å®‰å…¨