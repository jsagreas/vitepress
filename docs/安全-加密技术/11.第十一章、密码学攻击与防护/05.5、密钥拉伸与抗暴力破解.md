---
title: 5ã€å¯†é’¥æ‹‰ä¼¸ä¸æŠ—æš´åŠ›ç ´è§£
---
## ğŸ“š ç›®å½•

1. [å¯†é’¥æ‹‰ä¼¸åŸºæœ¬æ¦‚å¿µ](#1-å¯†é’¥æ‹‰ä¼¸åŸºæœ¬æ¦‚å¿µ)
2. [PBKDF2ç®—æ³•è¯¦è§£](#2-pbkdf2ç®—æ³•è¯¦è§£)
3. [bcryptè‡ªé€‚åº”åŠ å¯†](#3-bcryptè‡ªé€‚åº”åŠ å¯†)
4. [Argon2ç°ä»£å¯†é’¥æ‹‰ä¼¸](#4-argon2ç°ä»£å¯†é’¥æ‹‰ä¼¸)
5. [scryptå†…å­˜å›°éš¾å‡½æ•°](#5-scryptå†…å­˜å›°éš¾å‡½æ•°)
6. [å‚æ•°è°ƒä¼˜ä¸å®‰å…¨é…ç½®](#6-å‚æ•°è°ƒä¼˜ä¸å®‰å…¨é…ç½®)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” å¯†é’¥æ‹‰ä¼¸åŸºæœ¬æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯å¯†é’¥æ‹‰ä¼¸


**ğŸ”¸ æ ¸å¿ƒå®šä¹‰**
```
å¯†é’¥æ‹‰ä¼¸ï¼ˆKey Stretchingï¼‰ï¼š
ä¸€ç§è®©å¯†ç å˜å¾—æ›´éš¾ç ´è§£çš„æŠ€æœ¯
é€šè¿‡å¢åŠ è®¡ç®—å¤æ‚åº¦ï¼Œè®©æš´åŠ›ç ´è§£å˜å¾—å›°éš¾

ç®€å•ç†è§£ï¼š
æŠŠç®€å•å¯†ç å˜æˆå¤æ‚å¯†é’¥çš„è¿‡ç¨‹
å°±åƒæŠŠä¸€æ ¹æ©¡çš®ç­‹æ‹‰é•¿ä¸€æ ·ï¼Œå¢åŠ ç ´è§£çš„"è·ç¦»"
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦å¯†é’¥æ‹‰ä¼¸


**ğŸš« ä¼ ç»Ÿå¯†ç å­˜å‚¨çš„é—®é¢˜**
```
ç›´æ¥å­˜å‚¨å¯†ç é—®é¢˜ï¼š
ç”¨æˆ·å¯†ç : "123456"
MD5åŠ å¯†: e10adc3949ba59abbe56e057f20f883e
é—®é¢˜: é»‘å®¢æœ‰å½©è™¹è¡¨ï¼Œç§’ç ´ï¼

ä¼ ç»ŸåŠ ç›é—®é¢˜ï¼š
å¯†ç : "123456" + ç›: "abc"
MD5: "123456abc" â†’ å“ˆå¸Œå€¼
é—®é¢˜: è®¡ç®—é€Ÿåº¦å¤ªå¿«ï¼Œæš´åŠ›ç ´è§£ä»ç„¶å¯è¡Œ
```

**ğŸ’¡ å¯†é’¥æ‹‰ä¼¸çš„è§£å†³æ€è·¯**
```
æ ¸å¿ƒæ€æƒ³ï¼šè®©è®¡ç®—å˜æ…¢ï¼

æ™®é€šå“ˆå¸Œï¼š1æ¬¡è®¡ç®—
å¯†é’¥æ‹‰ä¼¸ï¼š10000æ¬¡è®¡ç®—

æ”»å‡»è€…ç ´è§£æ—¶é—´ï¼š
- åŸæ¥ï¼š1ç§’ç ´è§£1000ä¸‡ä¸ªå¯†ç 
- ç°åœ¨ï¼š1ç§’åªèƒ½ç ´è§£1000ä¸ªå¯†ç 
- æ•ˆæœï¼šç ´è§£éš¾åº¦å¢åŠ 10000å€ï¼
```

### 1.3 å¯†é’¥æ‹‰ä¼¸çš„å·¥ä½œåŸç†


**âš™ï¸ åŸºæœ¬å·¥ä½œæµç¨‹**
```
è¾“å…¥å¯†ç : "mypassword"
     â†“
æ·»åŠ ç›å€¼: "mypassword" + "randomsalt"
     â†“
ç¬¬1æ¬¡å“ˆå¸Œ: hash1 = SHA256(password + salt)
     â†“
ç¬¬2æ¬¡å“ˆå¸Œ: hash2 = SHA256(hash1)
     â†“
... é‡å¤10000æ¬¡ ...
     â†“
æœ€ç»ˆç»“æœ: ç»è¿‡10000æ¬¡è®¡ç®—çš„å¼ºå¯†é’¥

æ—¶é—´å¯¹æ¯”ï¼š
- æ™®é€šç”¨æˆ·ç™»å½•ï¼š0.1ç§’ï¼ˆå¯æ¥å—ï¼‰
- æš´åŠ›ç ´è§£ï¼šéœ€è¦10000å€æ—¶é—´ï¼ˆä¸å¯æ¥å—ï¼‰
```

### 1.4 å¯†é’¥æ‹‰ä¼¸çš„æ ¸å¿ƒä¼˜åŠ¿


**ğŸ›¡ï¸ å®‰å…¨ä¼˜åŠ¿åˆ†æ**
```
æŠ—æš´åŠ›ç ´è§£ï¼š
- è®¡ç®—æ—¶é—´æˆæœ¬å¤§å¹…å¢åŠ 
- è®©å­—å…¸æ”»å‡»å˜å¾—ä¸ç°å®
- å³ä½¿è·å¾—æ•°æ®åº“ä¹Ÿéš¾ä»¥ç ´è§£

è‡ªé€‚åº”å®‰å…¨ï¼š
- å¯æ ¹æ®ç¡¬ä»¶æ€§èƒ½è°ƒæ•´éš¾åº¦
- è®¡ç®—æœºè¶Šå¿«ï¼Œå¯ä»¥è®¾ç½®æ›´é«˜éš¾åº¦
- å§‹ç»ˆä¿æŒè¶³å¤Ÿçš„å®‰å…¨è¾¹é™…

å‘å‰å…¼å®¹ï¼š
- è€å¯†ç å¯ä»¥å‡çº§åˆ°æ–°æ ‡å‡†
- ä¸éœ€è¦ç”¨æˆ·é‡æ–°è®¾ç½®å¯†ç 
- æ¸è¿›å¼æå‡å®‰å…¨æ€§
```

---

## 2. ğŸ”„ PBKDF2ç®—æ³•è¯¦è§£


### 2.1 PBKDF2åŸºæœ¬æ¦‚å¿µ


**ğŸ”¸ ç®—æ³•å…¨ç§°ä¸å®šä¹‰**
```
PBKDF2: Password-Based Key Derivation Function 2
ä¸­æ–‡: åŸºäºå¯†ç çš„å¯†é’¥æ´¾ç”Ÿå‡½æ•°ç¬¬2ç‰ˆ

æ ¸å¿ƒç‰¹ç‚¹ï¼š
âœ… åŸºäºHMACçš„è¿­ä»£è®¡ç®—
âœ… æ ‡å‡†åŒ–ç®—æ³•ï¼ˆRFC 2898ï¼‰
âœ… å¹¿æ³›æ”¯æŒï¼Œå…¼å®¹æ€§å¥½
âœ… å¯è°ƒèŠ‚è¿­ä»£æ¬¡æ•°
```

### 2.2 PBKDF2å·¥ä½œåŸç†


**âš™ï¸ ç®—æ³•æµç¨‹è¯¦è§£**
```
PBKDF2ç®—æ³•æ­¥éª¤ï¼š

è¾“å…¥å‚æ•°ï¼š
- å¯†ç  (Password)
- ç›å€¼ (Salt) 
- è¿­ä»£æ¬¡æ•° (Iterations)
- å¯†é’¥é•¿åº¦ (Key Length)
- å“ˆå¸Œå‡½æ•° (é€šå¸¸æ˜¯HMAC-SHA256)

è®¡ç®—è¿‡ç¨‹ï¼š
ç¬¬1è½®: U1 = HMAC(å¯†ç , ç›å€¼ + è®¡æ•°å™¨)
ç¬¬2è½®: U2 = HMAC(å¯†ç , U1)
ç¬¬3è½®: U3 = HMAC(å¯†ç , U2)
...
ç¬¬Nè½®: UN = HMAC(å¯†ç , UN-1)

æœ€ç»ˆç»“æœ: U1 âŠ• U2 âŠ• U3 âŠ• ... âŠ• UN
```

**ğŸ“Š å›¾è§£PBKDF2è¿‡ç¨‹**
```
å¯†ç  + ç›å€¼
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   HMAC-1    â”‚ â†’ U1
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   HMAC-2    â”‚ â†’ U2
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   HMAC-3    â”‚ â†’ U3
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
    ...
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   HMAC-N    â”‚ â†’ UN
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
U1âŠ•U2âŠ•U3âŠ•...âŠ•UN = æœ€ç»ˆå¯†é’¥
```

### 2.3 PBKDF2ä»£ç å®ç°


**ğŸ’» Pythonå®ç°ç¤ºä¾‹**
```python
import hashlib
import os
from hmac import new as hmac_new

def pbkdf2_simple(password, salt, iterations, key_length):
    """
    ç®€åŒ–çš„PBKDF2å®ç°ï¼Œä¾¿äºç†è§£
    """
    password = password.encode('utf-8')
    salt = salt.encode('utf-8')
    
    # ç¬¬ä¸€æ¬¡HMACè®¡ç®—
    result = hmac_new(password, salt + b'\x00\x00\x00\x01', hashlib.sha256).digest()
    temp = result
    
    # è¿­ä»£è®¡ç®—
    for i in range(1, iterations):
        temp = hmac_new(password, temp, hashlib.sha256).digest()
        # XORæ“ä½œ
        result = bytes(a ^ b for a, b in zip(result, temp))
    
    return result[:key_length]

# ä½¿ç”¨ç¤ºä¾‹
password = "mypassword123"
salt = "randomsalt456"
iterations = 10000
key_length = 32

derived_key = pbkdf2_simple(password, salt, iterations, key_length)
print(f"æ´¾ç”Ÿå¯†é’¥: {derived_key.hex()}")
```

### 2.4 PBKDF2å®é™…åº”ç”¨


**ğŸ› ï¸ å¯†ç å­˜å‚¨åº”ç”¨**
```python
import hashlib
import secrets

class PBKDF2PasswordManager:
    def __init__(self, iterations=100000):
        self.iterations = iterations
    
    def hash_password(self, password):
        """å¯¹å¯†ç è¿›è¡ŒPBKDF2å“ˆå¸Œ"""
        # ç”Ÿæˆéšæœºç›å€¼
        salt = secrets.token_hex(16)
        
        # PBKDF2è®¡ç®—
        key = hashlib.pbkdf2_hmac(
            'sha256',
            password.encode('utf-8'),
            salt.encode('utf-8'),
            self.iterations
        )
        
        # è¿”å›: è¿­ä»£æ¬¡æ•°:ç›å€¼:å“ˆå¸Œå€¼
        return f"{self.iterations}:{salt}:{key.hex()}"
    
    def verify_password(self, password, stored_hash):
        """éªŒè¯å¯†ç """
        iterations, salt, stored_key = stored_hash.split(':')
        
        # ä½¿ç”¨ç›¸åŒå‚æ•°é‡æ–°è®¡ç®—
        key = hashlib.pbkdf2_hmac(
            'sha256',
            password.encode('utf-8'),
            salt.encode('utf-8'),
            int(iterations)
        )
        
        return key.hex() == stored_key

# ä½¿ç”¨ç¤ºä¾‹
pm = PBKDF2PasswordManager()

# æ³¨å†Œæ—¶å­˜å‚¨å¯†ç 
user_password = "MySecurePassword123"
stored_hash = pm.hash_password(user_password)
print(f"å­˜å‚¨çš„å“ˆå¸Œ: {stored_hash}")

# ç™»å½•æ—¶éªŒè¯å¯†ç 
is_valid = pm.verify_password("MySecurePassword123", stored_hash)
print(f"å¯†ç éªŒè¯: {is_valid}")
```

### 2.5 PBKDF2å‚æ•°é€‰æ‹©


**âš¡ è¿­ä»£æ¬¡æ•°å»ºè®®**
```
PBKDF2è¿­ä»£æ¬¡æ•°æ¨èï¼ˆ2024å¹´æ ‡å‡†ï¼‰ï¼š

ä½å®‰å…¨éœ€æ±‚: 100,000 æ¬¡
- é€‚ç”¨åœºæ™¯: å†…éƒ¨ç³»ç»Ÿ
- è®¡ç®—æ—¶é—´: ~100ms

ä¸­ç­‰å®‰å…¨: 200,000 æ¬¡  
- é€‚ç”¨åœºæ™¯: æ™®é€šWebåº”ç”¨
- è®¡ç®—æ—¶é—´: ~200ms

é«˜å®‰å…¨éœ€æ±‚: 500,000+ æ¬¡
- é€‚ç”¨åœºæ™¯: é‡‘èã€åŒ»ç–—ç³»ç»Ÿ  
- è®¡ç®—æ—¶é—´: ~500ms

è°ƒæ•´åŸåˆ™:
ç›®æ ‡æ˜¯è®©æœåŠ¡å™¨è®¡ç®—æ—¶é—´åœ¨100-500msä¹‹é—´
æ—¢ä¸å½±å“ç”¨æˆ·ä½“éªŒï¼Œåˆèƒ½æœ‰æ•ˆé˜²å¾¡æ”»å‡»
```

---

## 3. ğŸ”’ bcryptè‡ªé€‚åº”åŠ å¯†


### 3.1 bcryptåŸºæœ¬æ¦‚å¿µ


**ğŸ”¸ bcryptç®—æ³•ç‰¹ç‚¹**
```
bcryptå…¨ç§°: Blowfish Crypt
è®¾è®¡ç†å¿µ: ä¸“é—¨ä¸ºå¯†ç å“ˆå¸Œè®¾è®¡çš„ç®—æ³•

æ ¸å¿ƒä¼˜åŠ¿:
âœ… è‡ªé€‚åº”æˆæœ¬: å¯æ ¹æ®ç¡¬ä»¶æ€§èƒ½è°ƒæ•´
âœ… å†…ç½®ç›å€¼: è‡ªåŠ¨ç”Ÿæˆéšæœºç›
âœ… æŠ—å½©è™¹è¡¨: æ¯ä¸ªå¯†ç éƒ½æœ‰å”¯ä¸€ç›å€¼
âœ… æ—¶é—´éªŒè¯: ç»è¿‡20å¤šå¹´å®æˆ˜æ£€éªŒ
```

### 3.2 bcryptå·¥ä½œåŸç†


**âš™ï¸ ç®—æ³•æµç¨‹**
```
bcryptå·¥ä½œæµç¨‹:

1. ç”Ÿæˆç›å€¼:
   - è‡ªåŠ¨ç”Ÿæˆ128ä½éšæœºç›
   - åŒ…å«åœ¨æœ€ç»ˆè¾“å‡ºä¸­

2. æˆæœ¬å› å­:
   - cost = 12 æ„å‘³ç€ 2^12 = 4096 è½®è®¡ç®—
   - æ¯å¢åŠ 1ï¼Œè®¡ç®—æ—¶é—´ç¿»å€

3. BlowfishåŠ å¯†:
   - ä½¿ç”¨å¯†ç ä½œä¸ºå¯†é’¥
   - å¯¹å›ºå®šå­—ç¬¦ä¸²è¿›è¡Œå¤šè½®åŠ å¯†
   - äº§ç”Ÿ192ä½å“ˆå¸Œå€¼

4. æ ¼å¼åŒ–è¾“å‡º:
   $2a$12$saltsaltsaltsal.hashhashhash
   $2a: ç‰ˆæœ¬æ ‡è¯†
   $12: æˆæœ¬å› å­
   $salt: 22å­—ç¬¦ç›å€¼  
   hash: 31å­—ç¬¦å“ˆå¸Œå€¼
```

**ğŸ“Š bcryptç»“æ„å›¾è§£**
```
å¯†ç : "mypassword"
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”Ÿæˆéšæœºç›å€¼    â”‚ â†’ salt (128ä½)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æˆæœ¬å› å­ cost=12 â”‚ â†’ 2^12 = 4096è½®
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BlowfishåŠ å¯†   â”‚ â†’ é‡å¤4096æ¬¡
â”‚  å¯†é’¥=password  â”‚
â”‚  æ•°æ®="OrpheanB"â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
$2a$12$saltsalt...$.hashhash...
```

### 3.3 bcryptä»£ç å®ç°


**ğŸ’» Pythonä½¿ç”¨bcrypt**
```python
import bcrypt

class BcryptPasswordManager:
    def __init__(self, rounds=12):
        """
        rounds: æˆæœ¬å› å­ (æ¨è10-15)
        rounds=12 æ„å‘³ç€ 2^12 = 4096 è½®è®¡ç®—
        """
        self.rounds = rounds
    
    def hash_password(self, password):
        """å¯¹å¯†ç è¿›è¡Œbcryptå“ˆå¸Œ"""
        # ç”Ÿæˆç›å€¼å¹¶å“ˆå¸Œ
        salt = bcrypt.gensalt(rounds=self.rounds)
        hashed = bcrypt.hashpw(password.encode('utf-8'), salt)
        return hashed.decode('utf-8')
    
    def verify_password(self, password, hashed):
        """éªŒè¯å¯†ç """
        return bcrypt.checkpw(
            password.encode('utf-8'), 
            hashed.encode('utf-8')
        )
    
    def get_cost(self, hashed):
        """è·å–å“ˆå¸Œçš„æˆæœ¬å› å­"""
        # ä»$2a$12$...ä¸­æå–æˆæœ¬å› å­
        parts = hashed.split('$')
        return int(parts[2])

# ä½¿ç”¨ç¤ºä¾‹
pm = BcryptPasswordManager(rounds=12)

# å“ˆå¸Œå¯†ç 
password = "MySecurePassword123"
hashed = pm.hash_password(password)
print(f"bcryptå“ˆå¸Œ: {hashed}")
# è¾“å‡º: $2b$12$xyz...abc

# éªŒè¯å¯†ç 
is_valid = pm.verify_password("MySecurePassword123", hashed)
print(f"å¯†ç éªŒè¯: {is_valid}")

# æŸ¥çœ‹æˆæœ¬å› å­
cost = pm.get_cost(hashed)
print(f"æˆæœ¬å› å­: {cost}")
```

### 3.4 bcryptè‡ªé€‚åº”ç‰¹æ€§


**ğŸ¯ è‡ªé€‚åº”æˆæœ¬è°ƒæ•´**
```python
import time
import bcrypt

def benchmark_bcrypt_cost():
    """æµ‹è¯•ä¸åŒæˆæœ¬å› å­çš„è®¡ç®—æ—¶é—´"""
    password = "testpassword123"
    
    print("bcryptæˆæœ¬å› å­æ€§èƒ½æµ‹è¯•:")
    print("æˆæœ¬å› å­ | è®¡ç®—æ—¶é—´ | å®‰å…¨çº§åˆ«")
    print("-" * 35)
    
    for cost in range(8, 16):
        start_time = time.time()
        
        # ç”Ÿæˆå“ˆå¸Œ
        salt = bcrypt.gensalt(rounds=cost)
        hashed = bcrypt.hashpw(password.encode(), salt)
        
        end_time = time.time()
        duration = end_time - start_time
        
        # è¯„ä¼°å®‰å…¨çº§åˆ«
        if duration < 0.1:
            level = "åä½"
        elif duration < 0.3:
            level = "é€‚ä¸­"
        elif duration < 1.0:
            level = "è¾ƒé«˜"
        else:
            level = "å¾ˆé«˜"
        
        print(f"   {cost:2d}    | {duration:.3f}s  | {level}")

# è¿è¡Œæµ‹è¯•
benchmark_bcrypt_cost()

# ç¤ºä¾‹è¾“å‡º:
# æˆæœ¬å› å­ | è®¡ç®—æ—¶é—´ | å®‰å…¨çº§åˆ«
# -----------------------------------
#    8     | 0.015s  | åä½
#   10     | 0.065s  | åä½  
#   12     | 0.251s  | é€‚ä¸­
#   14     | 1.043s  | å¾ˆé«˜
```

### 3.5 bcryptæœ€ä½³å®è·µ


**âš¡ æˆæœ¬å› å­é€‰æ‹©æŒ‡å—**
```
bcryptæˆæœ¬å› å­æ¨è (2024å¹´):

Webåº”ç”¨: cost = 12
- è®¡ç®—æ—¶é—´: ~250ms
- å®‰å…¨æ€§: æŠµå¾¡ç°æœ‰GPUæ”»å‡»

é«˜å®‰å…¨åº”ç”¨: cost = 14
- è®¡ç®—æ—¶é—´: ~1s
- å®‰å…¨æ€§: æŠµå¾¡ä¸“ä¸šæ”»å‡»è®¾å¤‡

ç§»åŠ¨åº”ç”¨: cost = 10-11  
- è®¡ç®—æ—¶é—´: ~100ms
- å¹³è¡¡æ€§èƒ½ä¸å®‰å…¨

é€‰æ‹©åŸåˆ™:
1. ç›®æ ‡å“åº”æ—¶é—´åœ¨100-500ms
2. å®šæœŸè¯„ä¼°å’Œè°ƒæ•´æˆæœ¬å› å­
3. è€ƒè™‘æœåŠ¡å™¨æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ
```

---

## 4. ğŸš€ Argon2ç°ä»£å¯†é’¥æ‹‰ä¼¸


### 4.1 Argon2åŸºæœ¬æ¦‚å¿µ


**ğŸ”¸ Argon2ç®—æ³•ä»‹ç»**
```
Argon2: 2015å¹´å¯†ç å“ˆå¸Œç«èµ›è·èƒœç®—æ³•
è®¾è®¡ç›®æ ‡: æŠµå¾¡GPUã€ASICã€å¹¶è¡Œæ”»å‡»

ä¸‰ä¸ªå˜ç§:
ğŸ”¸ Argon2d: æŠµå¾¡æ—¶é—´-å†…å­˜æƒè¡¡æ”»å‡»
ğŸ”¸ Argon2i: æŠµå¾¡ä¾§ä¿¡é“æ”»å‡»  
ğŸ”¸ Argon2id: æ··åˆæ¨¡å¼ï¼Œæ¨èä½¿ç”¨

æ ¸å¿ƒåˆ›æ–°:
âœ… å†…å­˜å›°éš¾: éœ€è¦å¤§é‡å†…å­˜æ‰èƒ½è®¡ç®—
âœ… å¹¶è¡ŒæŠµå¾¡: å¤šçº¿ç¨‹æ”»å‡»æ•ˆæœæœ‰é™
âœ… å‚æ•°ä¸°å¯Œ: æ—¶é—´ã€å†…å­˜ã€å¹¶è¡Œåº¦å¯è°ƒ
```

### 4.2 Argon2å·¥ä½œåŸç†


**âš™ï¸ ç®—æ³•æµç¨‹è¯¦è§£**
```
Argon2å‚æ•°è¯´æ˜:

æ—¶é—´æˆæœ¬ (t): è¿­ä»£æ¬¡æ•°
å†…å­˜æˆæœ¬ (m): ä½¿ç”¨çš„å†…å­˜é‡(KB)
å¹¶è¡Œåº¦ (p): å¹¶è¡Œçº¿ç¨‹æ•°
å¯†é’¥é•¿åº¦: è¾“å‡ºå“ˆå¸Œé•¿åº¦

è®¡ç®—æµç¨‹:
1. åˆå§‹åŒ–: åˆ›å»ºå†…å­˜å—çŸ©é˜µ
2. å¡«å……é˜¶æ®µ: ç”¨å¯†ç å’Œç›å¡«å……å†…å­˜
3. è®¡ç®—é˜¶æ®µ: åœ¨å†…å­˜ä¸­è¿›è¡Œå¤æ‚è®¡ç®—
4. è¾“å‡ºé˜¶æ®µ: ç”Ÿæˆæœ€ç»ˆå“ˆå¸Œå€¼

å†…å­˜è®¿é—®æ¨¡å¼:
- Argon2d: ä¾èµ–æ•°æ®çš„è®¿é—®æ¨¡å¼
- Argon2i: ç‹¬ç«‹äºæ•°æ®çš„è®¿é—®æ¨¡å¼
- Argon2id: å‰åŠæ®µArgon2iï¼ŒååŠæ®µArgon2d
```

**ğŸ“Š Argon2å†…å­˜å¸ƒå±€å›¾**
```
Argon2å†…å­˜çŸ©é˜µ (ç¤ºä¾‹: 4Ã—4å—)

å†…å­˜å—0  å†…å­˜å—1  å†…å­˜å—2  å†…å­˜å—3
â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”
â”‚Blockâ”‚ â”‚Blockâ”‚ â”‚Blockâ”‚ â”‚Blockâ”‚
â”‚  0  â”‚ â”‚  1  â”‚ â”‚  2  â”‚ â”‚  3  â”‚
â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜

å†…å­˜å—4  å†…å­˜å—5  å†…å­˜å—6  å†…å­˜å—7  
â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”
â”‚Blockâ”‚ â”‚Blockâ”‚ â”‚Blockâ”‚ â”‚Blockâ”‚
â”‚  4  â”‚ â”‚  5  â”‚ â”‚  6  â”‚ â”‚  7  â”‚
â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜

è®¿é—®æ¨¡å¼:
Argon2i: æŒ‰é¢„å®šé¡ºåºè®¿é—® (æŠ—ä¾§ä¿¡é“)
Argon2d: æ ¹æ®å†…å®¹å†³å®šè®¿é—® (æŠ—æ—¶é—´-å†…å­˜æƒè¡¡)
Argon2id: æ··åˆä¸¤ç§æ¨¡å¼
```

### 4.3 Argon2ä»£ç å®ç°


**ğŸ’» Pythonä½¿ç”¨Argon2**
```python
from argon2 import PasswordHasher
from argon2.exceptions import VerifyMismatchError
import time

class Argon2PasswordManager:
    def __init__(self, time_cost=3, memory_cost=65536, parallelism=1):
        """
        time_cost: æ—¶é—´æˆæœ¬ (æ¨è2-10)
        memory_cost: å†…å­˜æˆæœ¬ï¼Œå•ä½KB (æ¨è64MB = 65536)
        parallelism: å¹¶è¡Œåº¦ (æ¨è1-4)
        """
        self.hasher = PasswordHasher(
            time_cost=time_cost,
            memory_cost=memory_cost,
            parallelism=parallelism,
            hash_len=32,  # è¾“å‡º32å­—èŠ‚å“ˆå¸Œ
            salt_len=16   # 16å­—èŠ‚ç›å€¼
        )
    
    def hash_password(self, password):
        """å¯¹å¯†ç è¿›è¡ŒArgon2å“ˆå¸Œ"""
        return self.hasher.hash(password)
    
    def verify_password(self, password, hashed):
        """éªŒè¯å¯†ç """
        try:
            self.hasher.verify(hashed, password)
            return True
        except VerifyMismatchError:
            return False
    
    def needs_rehash(self, hashed):
        """æ£€æŸ¥æ˜¯å¦éœ€è¦é‡æ–°å“ˆå¸Œï¼ˆå‚æ•°å‡çº§ï¼‰"""
        return self.hasher.check_needs_rehash(hashed)

# ä½¿ç”¨ç¤ºä¾‹
pm = Argon2PasswordManager(
    time_cost=3,     # 3æ¬¡è¿­ä»£
    memory_cost=65536, # 64MBå†…å­˜
    parallelism=1    # å•çº¿ç¨‹
)

# å“ˆå¸Œå¯†ç 
password = "MySecurePassword123"
hashed = pm.hash_password(password)
print(f"Argon2å“ˆå¸Œ: {hashed}")
# è¾“å‡º: $argon2id$v=19$m=65536,t=3,p=1$xyz...$abc...

# éªŒè¯å¯†ç 
is_valid = pm.verify_password("MySecurePassword123", hashed)
print(f"å¯†ç éªŒè¯: {is_valid}")

# æ£€æŸ¥æ˜¯å¦éœ€è¦å‡çº§
needs_upgrade = pm.needs_rehash(hashed)
print(f"éœ€è¦å‡çº§: {needs_upgrade}")
```

### 4.4 Argon2æ€§èƒ½è°ƒä¼˜


**âš¡ å‚æ•°è°ƒä¼˜ç¤ºä¾‹**
```python
import time
from argon2 import PasswordHasher

def benchmark_argon2_params():
    """æµ‹è¯•ä¸åŒArgon2å‚æ•°çš„æ€§èƒ½"""
    password = "testpassword123"
    
    # æµ‹è¯•é…ç½®
    configs = [
        {"name": "å¿«é€Ÿ", "t": 1, "m": 16384, "p": 1},    # 16MB
        {"name": "æ ‡å‡†", "t": 3, "m": 65536, "p": 1},    # 64MB  
        {"name": "å®‰å…¨", "t": 5, "m": 131072, "p": 2},   # 128MB
        {"name": "é«˜å®‰å…¨", "t": 10, "m": 262144, "p": 4}  # 256MB
    ]
    
    print("Argon2å‚æ•°æ€§èƒ½æµ‹è¯•:")
    print("é…ç½®   | æ—¶é—´ | å†…å­˜  | å¹¶è¡Œ | è®¡ç®—æ—¶é—´ | æ¨èåœºæ™¯")
    print("-" * 55)
    
    for config in configs:
        hasher = PasswordHasher(
            time_cost=config["t"],
            memory_cost=config["m"], 
            parallelism=config["p"]
        )
        
        start_time = time.time()
        hashed = hasher.hash(password)
        end_time = time.time()
        
        duration = end_time - start_time
        memory_mb = config["m"] // 1024
        
        # æ¨èåœºæ™¯
        if duration < 0.1:
            scene = "ç§»åŠ¨åº”ç”¨"
        elif duration < 0.5:
            scene = "Webåº”ç”¨"
        elif duration < 2.0:
            scene = "ä¼ä¸šåº”ç”¨"
        else:
            scene = "é«˜å®‰å…¨ç³»ç»Ÿ"
        
        print(f"{config['name']:6} | {config['t']:2d}   | {memory_mb:3d}MB | "
              f"{config['p']:2d}   | {duration:.3f}s  | {scene}")

# è¿è¡Œæµ‹è¯•
benchmark_argon2_params()
```

### 4.5 Argon2æœ€ä½³å®è·µ


**ğŸ¯ æ¨èé…ç½®å‚æ•°**
```
Argon2idæ¨èé…ç½® (2024å¹´):

ç§»åŠ¨åº”ç”¨:
- æ—¶é—´æˆæœ¬: t=2
- å†…å­˜æˆæœ¬: m=32MB (32768)
- å¹¶è¡Œåº¦: p=1
- è®¡ç®—æ—¶é—´: ~100ms

Webåº”ç”¨:
- æ—¶é—´æˆæœ¬: t=3  
- å†…å­˜æˆæœ¬: m=64MB (65536)
- å¹¶è¡Œåº¦: p=1
- è®¡ç®—æ—¶é—´: ~300ms

ä¼ä¸šåº”ç”¨:
- æ—¶é—´æˆæœ¬: t=5
- å†…å­˜æˆæœ¬: m=128MB (131072)  
- å¹¶è¡Œåº¦: p=2
- è®¡ç®—æ—¶é—´: ~800ms

é€‰æ‹©ç­–ç•¥:
1. ä¼˜å…ˆè°ƒæ•´å†…å­˜æˆæœ¬ (æŠ—GPUæ”»å‡»)
2. é€‚å½“å¢åŠ æ—¶é—´æˆæœ¬
3. å¹¶è¡Œåº¦é€šå¸¸è®¾ä¸º1-2
4. å®šæœŸæ ¹æ®ç¡¬ä»¶æ€§èƒ½è°ƒæ•´
```

---

## 5. ğŸ’¾ scryptå†…å­˜å›°éš¾å‡½æ•°


### 5.1 scryptåŸºæœ¬æ¦‚å¿µ


**ğŸ”¸ scryptç®—æ³•ç‰¹ç‚¹**
```
scrypt: ç”±Colin Percivaläº2009å¹´è®¾è®¡
è®¾è®¡ç›®æ ‡: å†…å­˜å¯†é›†å‹è®¡ç®—ï¼ŒæŠ—ASICæ”»å‡»

æ ¸å¿ƒæ€æƒ³:
âœ… å†…å­˜å›°éš¾: éœ€è¦å¤§é‡å†…å­˜æ‰èƒ½é«˜æ•ˆè®¡ç®—
âœ… é¡ºåºè®¡ç®—: éš¾ä»¥å¹¶è¡ŒåŒ–
âœ… æŠ—ç¡¬ä»¶: GPUã€ASICä¼˜åŠ¿æœ‰é™
âœ… å¯è°ƒå‚æ•°: å†…å­˜å’Œæ—¶é—´æˆæœ¬å¯è°ƒ

åº”ç”¨åœºæ™¯:
- å¯†ç å“ˆå¸Œå­˜å‚¨
- æ•°å­—è´§å¸æŒ–çŸ¿ (å¦‚Litecoin)
- å¯†é’¥æ´¾ç”Ÿå‡½æ•°
```

### 5.2 scryptå·¥ä½œåŸç†


**âš™ï¸ ç®—æ³•æµç¨‹**
```
scryptå‚æ•°è¯´æ˜:
N: å†…å­˜/CPUæˆæœ¬å‚æ•° (å¿…é¡»æ˜¯2çš„å¹‚)
r: å—å¤§å°å‚æ•°
p: å¹¶è¡ŒåŒ–å‚æ•°  
dkLen: æ´¾ç”Ÿå¯†é’¥é•¿åº¦

ç®—æ³•æµç¨‹:
1. ä½¿ç”¨PBKDF2ç”Ÿæˆåˆå§‹å—
2. å†…å­˜å¡«å……é˜¶æ®µ:
   - é¡ºåºç”ŸæˆNä¸ªå†…å­˜å—
   - æ¯ä¸ªå—ä¾èµ–å‰ä¸€ä¸ªå—
3. å†…å­˜æ··åˆé˜¶æ®µ:
   - éšæœºè®¿é—®ä¹‹å‰ç”Ÿæˆçš„å—
   - è¿›è¡Œå¤æ‚çš„æ··åˆè®¡ç®—
4. æœ€ç»ˆæ´¾ç”Ÿ:
   - ä½¿ç”¨PBKDF2ç”Ÿæˆæœ€ç»ˆå¯†é’¥
```

**ğŸ“Š scryptå†…å­˜è®¿é—®æ¨¡å¼**
```
scryptå†…å­˜æ“ä½œæµç¨‹:

é˜¶æ®µ1: é¡ºåºå¡«å……å†…å­˜
Block0 â†’ Block1 â†’ Block2 â†’ ... â†’ BlockN
  â†“       â†“       â†“              â†“
[å†…å­˜] [å†…å­˜] [å†…å­˜]    ...    [å†…å­˜]

é˜¶æ®µ2: éšæœºè®¿é—®æ··åˆ  
éšæœºé€‰æ‹© â†’ Block_i â†’ æ··åˆè®¡ç®— â†’ æ›´æ–°ç»“æœ
éšæœºé€‰æ‹© â†’ Block_j â†’ æ··åˆè®¡ç®— â†’ æ›´æ–°ç»“æœ
éšæœºé€‰æ‹© â†’ Block_k â†’ æ··åˆè®¡ç®— â†’ æ›´æ–°ç»“æœ
...

ç‰¹ç‚¹:
- å¿…é¡»ä¿ç•™æ‰€æœ‰ä¸­é—´ç»“æœ
- æ— æ³•é¢„æµ‹è®¿é—®æ¨¡å¼
- å†…å­˜è®¿é—®æ˜¯æ€§èƒ½ç“¶é¢ˆ
```

### 5.3 scryptä»£ç å®ç°


**ğŸ’» Pythonä½¿ç”¨scrypt**
```python
import hashlib
import secrets
from Crypto.Protocol.KDF import scrypt

class ScryptPasswordManager:
    def __init__(self, N=16384, r=8, p=1):
        """
        N: CPU/å†…å­˜æˆæœ¬ (æ¨è16384)
        r: å—å¤§å° (æ¨è8)  
        p: å¹¶è¡ŒåŒ– (æ¨è1)
        """
        self.N = N
        self.r = r  
        self.p = p
        self.key_len = 32  # è¾“å‡º32å­—èŠ‚å¯†é’¥
        self.salt_len = 16 # 16å­—èŠ‚ç›å€¼
    
    def hash_password(self, password):
        """å¯¹å¯†ç è¿›è¡Œscryptå“ˆå¸Œ"""
        # ç”Ÿæˆéšæœºç›å€¼
        salt = secrets.token_bytes(self.salt_len)
        
        # scryptè®¡ç®—
        key = scrypt(
            password.encode('utf-8'),
            salt,
            self.key_len,
            self.N,
            self.r, 
            self.p
        )
        
        # æ ¼å¼: N:r:p:ç›å€¼:å“ˆå¸Œå€¼
        return f"{self.N}:{self.r}:{self.p}:{salt.hex()}:{key.hex()}"
    
    def verify_password(self, password, stored_hash):
        """éªŒè¯å¯†ç """
        parts = stored_hash.split(':')
        N, r, p = int(parts[0]), int(parts[1]), int(parts[2])
        salt = bytes.fromhex(parts[3])
        stored_key = parts[4]
        
        # é‡æ–°è®¡ç®—scrypt
        key = scrypt(
            password.encode('utf-8'),
            salt,
            self.key_len,
            N, r, p
        )
        
        return key.hex() == stored_key
    
    def estimate_memory_usage(self):
        """ä¼°ç®—å†…å­˜ä½¿ç”¨é‡"""
        # scryptå†…å­˜ä½¿ç”¨é‡ = 128 * N * r å­—èŠ‚
        memory_bytes = 128 * self.N * self.r
        memory_mb = memory_bytes / (1024 * 1024)
        return memory_mb

# ä½¿ç”¨ç¤ºä¾‹
pm = ScryptPasswordManager(N=16384, r=8, p=1)

# è®¡ç®—å†…å­˜ä½¿ç”¨é‡
memory_usage = pm.estimate_memory_usage()
print(f"é¢„è®¡å†…å­˜ä½¿ç”¨: {memory_usage:.1f} MB")

# å“ˆå¸Œå¯†ç 
password = "MySecurePassword123"
hashed = pm.hash_password(password)
print(f"scryptå“ˆå¸Œ: {hashed}")

# éªŒè¯å¯†ç 
is_valid = pm.verify_password("MySecurePassword123", hashed)
print(f"å¯†ç éªŒè¯: {is_valid}")
```

### 5.4 scryptæ€§èƒ½åˆ†æ


**âš¡ å‚æ•°æ€§èƒ½æµ‹è¯•**
```python
import time
from Crypto.Protocol.KDF import scrypt

def benchmark_scrypt_params():
    """æµ‹è¯•ä¸åŒscryptå‚æ•°çš„æ€§èƒ½"""
    password = "testpassword123"
    salt = b"testsalt12345678"
    
    # æµ‹è¯•é…ç½® (N, r, p)
    configs = [
        {"name": "è½»é‡", "N": 4096, "r": 8, "p": 1},     # 4MB
        {"name": "æ ‡å‡†", "N": 16384, "r": 8, "p": 1},    # 16MB
        {"name": "å®‰å…¨", "N": 65536, "r": 8, "p": 1},    # 64MB
        {"name": "é«˜å®‰å…¨", "N": 262144, "r": 8, "p": 1}   # 256MB
    ]
    
    print("scryptå‚æ•°æ€§èƒ½æµ‹è¯•:")
    print("é…ç½®   | Nå‚æ•°  | å†…å­˜ä½¿ç”¨ | è®¡ç®—æ—¶é—´ | æ¨èåœºæ™¯")
    print("-" * 50)
    
    for config in configs:
        # è®¡ç®—å†…å­˜ä½¿ç”¨é‡
        memory_mb = (128 * config["N"] * config["r"]) / (1024 * 1024)
        
        # æµ‹è¯•è®¡ç®—æ—¶é—´
        start_time = time.time()
        key = scrypt(
            password.encode(),
            salt,
            32,  # å¯†é’¥é•¿åº¦
            config["N"],
            config["r"],
            config["p"]
        )
        end_time = time.time()
        
        duration = end_time - start_time
        
        # æ¨èåœºæ™¯
        if duration < 0.1:
            scene = "åµŒå…¥å¼è®¾å¤‡"
        elif duration < 0.5:
            scene = "ç§»åŠ¨åº”ç”¨"
        elif duration < 2.0:
            scene = "WebæœåŠ¡"
        else:
            scene = "é«˜å®‰å…¨å­˜å‚¨"
        
        print(f"{config['name']:6} | {config['N']:6d} | {memory_mb:6.1f}MB | "
              f"{duration:.3f}s  | {scene}")

# è¿è¡Œæµ‹è¯•
benchmark_scrypt_params()
```

### 5.5 scrypt vs å…¶ä»–ç®—æ³•


**ğŸ“Š ç®—æ³•å¯¹æ¯”åˆ†æ**
```
å¯†é’¥æ‹‰ä¼¸ç®—æ³•å¯¹æ¯”:

ç‰¹æ€§å¯¹æ¯”:
ç®—æ³•     | å†…å­˜éœ€æ±‚ | è®¡ç®—æ—¶é—´ | æŠ—GPU | æŠ—ASIC | æ ‡å‡†åŒ–
---------|----------|----------|-------|--------|--------
PBKDF2   | å¾ˆä½     | ä¸­ç­‰     | ä½    | ä½     | âœ…
bcrypt   | ä½       | ä¸­ç­‰     | ä¸­    | ä¸­     | âœ…  
scrypt   | é«˜       | ä¸­ç­‰     | é«˜    | é«˜     | âœ…
Argon2   | å¯è°ƒ     | å¯è°ƒ     | é«˜    | é«˜     | âœ…

é€‰æ‹©å»ºè®®:
ä½èµ„æºç¯å¢ƒ: PBKDF2/bcrypt
æ ‡å‡†Webåº”ç”¨: bcrypt/Argon2id  
é«˜å®‰å…¨éœ€æ±‚: Argon2id/scrypt
æŠ—ç¡¬ä»¶æ”»å‡»: scrypt/Argon2

å†…å­˜ä½¿ç”¨å¯¹æ¯”:
PBKDF2: ~å‡ KB
bcrypt: ~4KB
scrypt: å‡ MBåˆ°å‡ ç™¾MB
Argon2: å‡ MBåˆ°å‡ GB
```

---

## 6. âš™ï¸ å‚æ•°è°ƒä¼˜ä¸å®‰å…¨é…ç½®


### 6.1 å‚æ•°è°ƒä¼˜ç­–ç•¥


**ğŸ¯ é€šç”¨è°ƒä¼˜åŸåˆ™**
```
è°ƒä¼˜ç›®æ ‡:
âœ… ç”¨æˆ·ä½“éªŒ: ç™»å½•æ—¶é—´ < 500ms
âœ… å®‰å…¨æ€§: æŠµå¾¡ç°æœ‰æ”»å‡»æ‰‹æ®µ
âœ… èµ„æºæ•ˆç‡: ä¸è¿‡åº¦æ¶ˆè€—æœåŠ¡å™¨èµ„æº
âœ… å¯æ‰©å±•æ€§: æ”¯æŒå‚æ•°å‡çº§

è°ƒä¼˜æµç¨‹:
1. ç¡®å®šç›®æ ‡å“åº”æ—¶é—´
2. æµ‹è¯•å½“å‰ç¡¬ä»¶æ€§èƒ½
3. é€‰æ‹©åˆé€‚çš„ç®—æ³•
4. è°ƒæ•´å…·ä½“å‚æ•°
5. å®šæœŸè¯„ä¼°å’Œå‡çº§
```

### 6.2 è‡ªé€‚åº”å‚æ•°è°ƒæ•´


**ğŸ”„ åŠ¨æ€å‚æ•°è°ƒæ•´ä»£ç **
```python
import time
from argon2 import PasswordHasher

class AdaptivePasswordManager:
    def __init__(self, target_time=0.3):
        """
        target_time: ç›®æ ‡è®¡ç®—æ—¶é—´(ç§’)
        """
        self.target_time = target_time
        self.min_memory = 32768    # æœ€å°32MB
        self.max_memory = 262144   # æœ€å¤§256MB
        self.min_time_cost = 2
        self.max_time_cost = 10
    
    def calibrate_parameters(self):
        """è‡ªåŠ¨æ ¡å‡†å‚æ•°"""
        print("æ­£åœ¨æ ¡å‡†Argon2å‚æ•°...")
        
        best_params = None
        best_time_diff = float('inf')
        
        # æµ‹è¯•ä¸åŒå‚æ•°ç»„åˆ
        for memory in [32768, 65536, 131072]:
            for time_cost in range(2, 8):
                params = {
                    'time_cost': time_cost,
                    'memory_cost': memory,
                    'parallelism': 1
                }
                
                # æµ‹è¯•è®¡ç®—æ—¶é—´
                duration = self._test_parameters(params)
                time_diff = abs(duration - self.target_time)
                
                print(f"æµ‹è¯•å‚æ•° t={time_cost}, m={memory//1024}MB: {duration:.3f}s")
                
                if time_diff < best_time_diff:
                    best_time_diff = time_diff
                    best_params = params
        
        print(f"\næœ€ä½³å‚æ•°: {best_params}")
        print(f"ç›®æ ‡æ—¶é—´: {self.target_time}s, å®é™…æ—¶é—´: {self._test_parameters(best_params):.3f}s")
        
        return best_params
    
    def _test_parameters(self, params):
        """æµ‹è¯•æŒ‡å®šå‚æ•°çš„è®¡ç®—æ—¶é—´"""
        hasher = PasswordHasher(**params)
        test_password = "calibration_test_password"
        
        start_time = time.time()
        hasher.hash(test_password)
        end_time = time.time()
        
        return end_time - start_time

# ä½¿ç”¨è‡ªé€‚åº”è°ƒä¼˜
adaptive_pm = AdaptivePasswordManager(target_time=0.3)
optimal_params = adaptive_pm.calibrate_parameters()
```

### 6.3 å®‰å…¨é…ç½®æ£€æŸ¥è¡¨


**âœ… å®‰å…¨é…ç½®æ¸…å•**
```python
def security_audit(algorithm, params):
    """å¯†é’¥æ‹‰ä¼¸å®‰å…¨å®¡è®¡"""
    print(f"ğŸ” {algorithm} å®‰å…¨é…ç½®å®¡è®¡")
    print("=" * 40)
    
    checks = []
    
    if algorithm.lower() == 'pbkdf2':
        # PBKDF2å®‰å…¨æ£€æŸ¥
        iterations = params.get('iterations', 0)
        
        if iterations >= 600000:
            checks.append("âœ… è¿­ä»£æ¬¡æ•°å……è¶³ (â‰¥600k)")
        elif iterations >= 100000:
            checks.append("âš ï¸  è¿­ä»£æ¬¡æ•°ä¸€èˆ¬ (â‰¥100k)")
        else:
            checks.append("âŒ è¿­ä»£æ¬¡æ•°è¿‡ä½ (<100k)")
            
    elif algorithm.lower() == 'bcrypt':
        # bcryptå®‰å…¨æ£€æŸ¥
        rounds = params.get('rounds', 0)
        
        if rounds >= 14:
            checks.append("âœ… æˆæœ¬å› å­å……è¶³ (â‰¥14)")
        elif rounds >= 12:
            checks.append("âš ï¸  æˆæœ¬å› å­ä¸€èˆ¬ (â‰¥12)")
        else:
            checks.append("âŒ æˆæœ¬å› å­è¿‡ä½ (<12)")
            
    elif algorithm.lower() == 'argon2':
        # Argon2å®‰å…¨æ£€æŸ¥
        memory = params.get('memory_cost', 0)
        time_cost = params.get('time_cost', 0)
        
        if memory >= 65536:  # 64MB
            checks.append("âœ… å†…å­˜æˆæœ¬å……è¶³ (â‰¥64MB)")
        else:
            checks.append("âŒ å†…å­˜æˆæœ¬ä¸è¶³ (<64MB)")
            
        if time_cost >= 3:
            checks.append("âœ… æ—¶é—´æˆæœ¬å……è¶³ (â‰¥3)")
        else:
            checks.append("âŒ æ—¶é—´æˆæœ¬ä¸è¶³ (<3)")
    
    # é€šç”¨å®‰å…¨æ£€æŸ¥
    if params.get('salt_length', 0) >= 16:
        checks.append("âœ… ç›å€¼é•¿åº¦å……è¶³ (â‰¥16å­—èŠ‚)")
    else:
        checks.append("âŒ ç›å€¼é•¿åº¦ä¸è¶³ (<16å­—èŠ‚)")
    
    if params.get('output_length', 0) >= 32:
        checks.append("âœ… è¾“å‡ºé•¿åº¦å……è¶³ (â‰¥32å­—èŠ‚)")
    else:
        checks.append("âŒ è¾“å‡ºé•¿åº¦ä¸è¶³ (<32å­—èŠ‚)")
    
    # è¾“å‡ºç»“æœ
    for check in checks:
        print(check)
    
    # å®‰å…¨è¯„åˆ†
    passed = sum(1 for check in checks if check.startswith("âœ…"))
    total = len(checks)
    score = (passed / total) * 100
    
    print(f"\nå®‰å…¨è¯„åˆ†: {score:.0f}% ({passed}/{total})")
    
    if score >= 80:
        print("ğŸŸ¢ å®‰å…¨é…ç½®è‰¯å¥½")
    elif score >= 60:
        print("ğŸŸ¡ å®‰å…¨é…ç½®ä¸€èˆ¬ï¼Œå»ºè®®æ”¹è¿›")
    else:
        print("ğŸ”´ å®‰å…¨é…ç½®ä¸è¶³ï¼Œéœ€è¦ç«‹å³æ”¹è¿›")

# ä½¿ç”¨ç¤ºä¾‹
security_audit('argon2', {
    'memory_cost': 65536,
    'time_cost': 3,
    'salt_length': 16,
    'output_length': 32
})
```

### 6.4 ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å»ºè®®


**ğŸš€ éƒ¨ç½²æœ€ä½³å®è·µ**
```python
class ProductionPasswordManager:
    """ç”Ÿäº§ç¯å¢ƒå¯†ç ç®¡ç†å™¨"""
    
    def __init__(self, environment='production'):
        self.environment = environment
        self.config = self._get_config()
    
    def _get_config(self):
        """æ ¹æ®ç¯å¢ƒè·å–é…ç½®"""
        configs = {
            'development': {
                'algorithm': 'argon2id',
                'time_cost': 2,
                'memory_cost': 32768,  # 32MB
                'parallelism': 1
            },
            'testing': {
                'algorithm': 'argon2id', 
                'time_cost': 1,
                'memory_cost': 16384,  # 16MB
                'parallelism': 1
            },
            'production': {
                'algorithm': 'argon2id',
                'time_cost': 3,
                'memory_cost': 65536,  # 64MB
                'parallelism': 1
            },
            'high_security': {
                'algorithm': 'argon2id',
                'time_cost': 5,
                'memory_cost': 131072, # 128MB
                'parallelism': 2
            }
        }
        return configs.get(self.environment, configs['production'])
    
    def get_recommendations(self):
        """è·å–éƒ¨ç½²å»ºè®®"""
        recommendations = [
            "ğŸ” å¯†é’¥æ‹‰ä¼¸é…ç½®å»ºè®®:",
            "",
            "1. ç®—æ³•é€‰æ‹©:",
            "   âœ… æ–°é¡¹ç›®: ä½¿ç”¨Argon2id",
            "   âœ… ç°æœ‰é¡¹ç›®: è€ƒè™‘ä»bcryptå‡çº§",
            "",
            "2. å‚æ•°é…ç½®:",
            f"   âœ… æ—¶é—´æˆæœ¬: {self.config['time_cost']}",
            f"   âœ… å†…å­˜æˆæœ¬: {self.config['memory_cost']//1024}MB", 
            f"   âœ… å¹¶è¡Œåº¦: {self.config['parallelism']}",
            "",
            "3. å®‰å…¨æªæ–½:",
            "   âœ… ä½¿ç”¨å¼ºéšæœºç›å€¼ç”Ÿæˆå™¨",
            "   âœ… å®šæœŸå®¡æŸ¥å’Œæ›´æ–°å‚æ•°",
            "   âœ… ç›‘æ§ç™»å½•å“åº”æ—¶é—´",
            "   âœ… å®æ–½ç™»å½•é¢‘ç‡é™åˆ¶",
            "",
            "4. è¿ç»´å»ºè®®:", 
            "   âœ… ç›‘æ§CPUå’Œå†…å­˜ä½¿ç”¨ç‡",
            "   âœ… é…ç½®é€‚å½“çš„è¶…æ—¶æ—¶é—´",
            "   âœ… å®æ–½é™çº§ç­–ç•¥", 
            "   âœ… å®šæœŸæ€§èƒ½æµ‹è¯•"
        ]
        
        return '\n'.join(recommendations)

# è·å–éƒ¨ç½²å»ºè®®
pm = ProductionPasswordManager('production')
print(pm.get_recommendations())
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ”¸ å¯†é’¥æ‹‰ä¼¸æœ¬è´¨ç†è§£**
```
æ ¸å¿ƒæ€æƒ³: è®©è®¡ç®—å˜æ…¢ï¼Œå¢åŠ ç ´è§£æˆæœ¬
å®ç°æ–¹å¼: é€šè¿‡å¤§é‡è¿­ä»£æˆ–å†…å­˜æ¶ˆè€—
ç›®æ ‡æ•ˆæœ: æ™®é€šç”¨æˆ·å¯æ¥å—ï¼Œæ”»å‡»è€…ä¸å¯è¡Œ
åº”ç”¨ä»·å€¼: åœ¨å¼±å¯†ç å’Œå¼ºå®‰å…¨ä¹‹é—´å»ºç«‹å¹³è¡¡
```

**ğŸ”¸ å››å¤§ç®—æ³•å¯¹æ¯”**
```
PBKDF2: æ ‡å‡†ç®€å•ï¼Œå…¼å®¹æ€§å¥½ï¼ŒæŠ—GPUèƒ½åŠ›ä¸€èˆ¬
bcrypt: è‡ªé€‚åº”å¼ºï¼Œä½¿ç”¨å¹¿æ³›ï¼ŒæŠ—GPUèƒ½åŠ›ä¸­ç­‰  
scrypt: å†…å­˜å›°éš¾ï¼ŒæŠ—ç¡¬ä»¶ï¼Œå‚æ•°å¤æ‚
Argon2: ç°ä»£è®¾è®¡ï¼ŒåŠŸèƒ½æœ€å…¨ï¼Œæ¨èä½¿ç”¨
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆéœ€è¦å¯†é’¥æ‹‰ä¼¸**
```
é—®é¢˜æ ¹æº: ç”¨æˆ·å¯†ç é€šå¸¸è¾ƒå¼±
æ”»å‡»ç°å®: GPUå¹¶è¡Œç ´è§£é€Ÿåº¦æå¿«
è§£å†³æ€è·¯: å¢åŠ æ¯æ¬¡å°è¯•çš„æ—¶é—´æˆæœ¬
æ•ˆæœéªŒè¯: è®©å­—å…¸æ”»å‡»å˜å¾—ä¸ç»æµ
```

**ğŸ”¹ å‚æ•°è°ƒä¼˜çš„å¹³è¡¡è‰ºæœ¯**
```
ç”¨æˆ·ä½“éªŒ: ç™»å½•æ—¶é—´ä¸èƒ½å¤ªé•¿
å®‰å…¨éœ€æ±‚: è®¡ç®—æˆæœ¬è¦è¶³å¤Ÿé«˜  
èµ„æºé™åˆ¶: æœåŠ¡å™¨è´Ÿè½½è¦å¯æ§
æœªæ¥å‘å±•: å‚æ•°è¦èƒ½é€‚åº”ç¡¬ä»¶å‘å±•
```

**ğŸ”¹ ç®—æ³•é€‰æ‹©çš„å†³ç­–å› ç´ **
```
å…¼å®¹æ€§è¦æ±‚: é€‰æ‹©PBKDF2æˆ–bcrypt
æ€§èƒ½ä¼˜å…ˆ: é€‰æ‹©bcrypt
å®‰å…¨ä¼˜å…ˆ: é€‰æ‹©Argon2idæˆ–scrypt  
èµ„æºå……è¶³: é€‰æ‹©Argon2æˆ–scrypt
```

### 7.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ ä¸åŒåœºæ™¯çš„æ¨èæ–¹æ¡ˆ**
```
ç§»åŠ¨åº”ç”¨: bcrypt (rounds=10-12) æˆ– Argon2id (è¾ƒä½å‚æ•°)
Webåº”ç”¨: bcrypt (rounds=12) æˆ– Argon2id (æ ‡å‡†å‚æ•°)
ä¼ä¸šç³»ç»Ÿ: Argon2id (é«˜å‚æ•°) æˆ– scrypt
é‡‘èç³»ç»Ÿ: Argon2id (æœ€é«˜å‚æ•°) + é¢å¤–å®‰å…¨æªæ–½

é€‰æ‹©æ ‡å‡†:
1. ä¼˜å…ˆè€ƒè™‘Argon2id (ç°ä»£æ ‡å‡†)
2. ç°æœ‰ç³»ç»Ÿå¯ç»§ç»­ä½¿ç”¨bcrypt
3. é¿å…ä½¿ç”¨çº¯PBKDF2 (é™¤éæœ‰ç‰¹æ®Šå…¼å®¹éœ€æ±‚)
4. ç»ä¸ä½¿ç”¨MD5ã€SHA1ç­‰å¿«é€Ÿå“ˆå¸Œ
```

**ğŸ”§ å®æ–½è¦ç‚¹**
```
é…ç½®åŸåˆ™:
âœ… ç›®æ ‡å“åº”æ—¶é—´: 100-500ms
âœ… å®šæœŸè¯„ä¼°: æ¯å¹´æ£€æŸ¥å‚æ•°æ˜¯å¦éœ€è¦è°ƒæ•´
âœ… æ¸è¿›å‡çº§: æ–°ç”¨æˆ·ä½¿ç”¨æ–°å‚æ•°ï¼Œè€ç”¨æˆ·é€æ­¥å‡çº§
âœ… ç›‘æ§å‘Šè­¦: ç›‘æ§å¼‚å¸¸çš„ç™»å½•æ—¶é—´

å®‰å…¨æ£€æŸ¥:
âœ… ç›å€¼éšæœºæ€§: ä½¿ç”¨å¯†ç å­¦å®‰å…¨çš„éšæœºæ•°ç”Ÿæˆå™¨
âœ… å‚æ•°å­˜å‚¨: å°†ç®—æ³•å‚æ•°ä¸å“ˆå¸Œå€¼ä¸€èµ·å­˜å‚¨
âœ… é”™è¯¯å¤„ç†: é¿å…é€šè¿‡å“åº”æ—¶é—´æ³„éœ²ä¿¡æ¯
âœ… é™åˆ¶é¢‘ç‡: å®æ–½ç™»å½•å°è¯•é¢‘ç‡é™åˆ¶
```

### 7.4 å‘å±•è¶‹åŠ¿ä¸æœªæ¥


**ğŸš€ æŠ€æœ¯å‘å±•æ–¹å‘**
```
ç¡¬ä»¶å‘å±•: GPUã€ASICç®—åŠ›æŒç»­å¢é•¿
â†’ éœ€è¦ä¸æ–­è°ƒæ•´å‚æ•°ï¼Œä¿æŒå®‰å…¨è¾¹é™…

é‡å­è®¡ç®—: å¯¹ä¼ ç»Ÿå¯†ç å­¦æ„æˆå¨èƒ  
â†’ å¯†é’¥æ‹‰ä¼¸ä»ç„¶æœ‰æ•ˆï¼Œä½†éœ€é…åˆæŠ—é‡å­ç®—æ³•

å†…å­˜æŠ€æœ¯: å†…å­˜ä»·æ ¼ä¸‹é™ï¼Œå®¹é‡å¢å¤§
â†’ å†…å­˜å›°éš¾å‡½æ•°å°†æ›´åŠ é‡è¦

ä¸“ç”¨ç¡¬ä»¶: é’ˆå¯¹å¯†ç ç ´è§£çš„ä¸“ç”¨è®¾å¤‡
â†’ éœ€è¦æ›´å¤æ‚çš„å†…å­˜è®¿é—®æ¨¡å¼
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
å¯†é’¥æ‹‰ä¼¸é˜²æš´åŠ›ï¼Œå¢åŠ æˆæœ¬æ˜¯ç›®çš„
PBKDF2æ ‡å‡†åŒ–ï¼Œbcryptè‡ªé€‚åº”
scryptè€—å†…å­˜ï¼ŒArgon2æœ€ç°ä»£
å‚æ•°è°ƒä¼˜éœ€å¹³è¡¡ï¼Œå®‰å…¨ä½“éªŒéƒ½è¦é¡¾
```

**å®è·µå»ºè®®**ï¼š
- æ–°é¡¹ç›®ç›´æ¥ä½¿ç”¨Argon2id
- ç°æœ‰é¡¹ç›®è¯„ä¼°å‡çº§å¯è¡Œæ€§  
- å‚æ•°è®¾ç½®ä»¥å®é™…æµ‹è¯•ä¸ºå‡†
- å®‰å…¨é…ç½®è¦å®šæœŸå®¡æŸ¥æ›´æ–°