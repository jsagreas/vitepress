---
title: 4、威胁模型与安全分析
---
## 📚 目录

1. [威胁建模基础概念](#1-威胁建模基础概念)
2. [威胁建模方法论](#2-威胁建模方法论)
3. [攻击者模型分析](#3-攻击者模型分析)
4. [安全需求评估](#4-安全需求评估)
5. [风险评估矩阵](#5-风险评估矩阵)
6. [安全边界定义](#6-安全边界定义)
7. [核心要点总结](#7-核心要点总结)

---

## 1. 🎯 威胁建模基础概念


### 1.1 什么是威胁建模


**💡 通俗理解**
```
威胁建模就像是给你的家做安全检查：
- 找出所有可能的入侵点（门、窗、阳台）
- 分析小偷可能怎么进来（撬锁、爬窗、钻狗洞）
- 评估损失程度（偷钱、偷电器、人身安全）
- 制定防护措施（防盗门、摄像头、报警器）
```

**🔍 核心定义**
威胁建模是一种**系统化分析安全风险**的方法，通过识别系统中的威胁、漏洞和攻击路径，来制定相应的安全防护策略。

### 1.2 为什么需要威胁建模


**🚨 现实场景对比**
```
没有威胁建模的系统 = 没有规划的防盗
✗ 只在大门装锁，窗户大开
✗ 不知道小偷从哪里来
✗ 不清楚要保护什么
✗ 被动应对，事后补救

有威胁建模的系统 = 全方位安全规划
✓ 全面分析入侵点
✓ 预测攻击方式
✓ 明确保护目标
✓ 主动防护，提前布局
```

### 1.3 威胁建模的核心要素


**📋 四大核心问题**
```
1️⃣ 我们在保护什么？（资产识别）
   💰 用户数据、商业机密、系统可用性

2️⃣ 我们在防范谁？（威胁主体）
   👤 黑客、内部员工、竞争对手

3️⃣ 他们会怎么攻击？（攻击向量）
   🔓 网络攻击、物理接触、社会工程

4️⃣ 我们如何防护？（安全控制）
   🛡️ 技术防护、管理制度、人员培训
```

---

## 2. 🔧 威胁建模方法论


### 2.1 STRIDE威胁分类法


**🔤 STRIDE含义解析**
```
S - Spoofing（欺骗）
   含义：冒充他人身份
   例子：伪造邮件地址发钓鱼邮件
   
T - Tampering（篡改）
   含义：恶意修改数据
   例子：修改银行转账金额
   
R - Repudiation（抵赖）
   含义：否认自己的行为
   例子：声称没有发送某条消息
   
I - Information Disclosure（信息泄露）
   含义：未授权访问敏感信息
   例子：数据库被脱库
   
D - Denial of Service（拒绝服务）
   含义：使系统无法正常服务
   例子：DDoS攻击让网站瘫痪
   
E - Elevation of Privilege（权限提升）
   含义：获得超出应有的权限
   例子：普通用户获得管理员权限
```

**🎯 STRIDE实际应用**
```
登录系统威胁分析：

用户登录 → [网络传输] → 服务器验证 → [数据库查询] → 返回结果

可能的威胁：
S: 攻击者冒充合法用户登录
T: 传输过程中密码被篡改
R: 用户否认自己的登录行为
I: 用户名密码在传输中被窃取
D: 大量登录请求导致服务器宕机
E: 利用登录漏洞获得系统权限
```

### 2.2 DREAD风险评估法


**🎲 DREAD评分标准**
```
D - Damage（损害程度）
   1-3分：轻微损失
   4-6分：中等损失  
   7-10分：严重损失

R - Reproducibility（可重现性）
   1-3分：很难重现
   4-6分：有一定条件可重现
   7-10分：容易重现

E - Exploitability（可利用性）
   1-3分：需要高级技能
   4-6分：需要一定技能
   7-10分：容易利用

A - Affected Users（影响用户数）
   1-3分：极少数用户
   4-6分：部分用户
   7-10分：大部分或全部用户

D - Discoverability（可发现性）
   1-3分：很难发现
   4-6分：有一定方法可发现
   7-10分：容易发现
```

**📊 实际评估示例**
```
威胁：SQL注入攻击

DREAD评分：
损害程度：9分（可能泄露所有用户数据）
可重现性：8分（掌握方法后容易重现）
可利用性：6分（需要一定的SQL知识）
影响用户：9分（影响所有用户）
可发现性：7分（通过扫描工具容易发现）

总分：(9+8+6+9+7)/5 = 7.8分（高风险）
```

### 2.3 PASTA方法论


**🍝 PASTA七步法**
```
1️⃣ 定义目标（Define Objectives）
   明确安全目标和业务需求

2️⃣ 定义技术范围（Define Technical Scope）
   确定分析的系统边界

3️⃣ 应用分解（Application Decomposition）
   将系统拆分成可分析的组件

4️⃣ 威胁分析（Threat Analysis）
   识别潜在的威胁和攻击向量

5️⃣ 漏洞分析（Vulnerability Analysis）
   找出系统中的安全弱点

6️⃣ 攻击建模（Attack Modeling）
   模拟真实的攻击场景

7️⃣ 风险分析（Risk Analysis）
   评估风险级别并制定应对策略
```

---

## 3. 👤 攻击者模型分析


### 3.1 攻击者分类


**🎭 按能力水平分类**
```
脚本小子（Script Kiddie）
技能：⭐☆☆☆☆
特点：使用现成工具，技术水平有限
动机：好奇心、炫耀
威胁：低到中等

一般黑客（Hacker）
技能：⭐⭐⭐☆☆
特点：有一定技术能力，能修改工具
动机：经济利益、挑战自我
威胁：中等

高级黑客（Advanced Hacker）
技能：⭐⭐⭐⭐☆
特点：深厚技术功底，能开发新工具
动机：经济利益、政治目的
威胁：高

国家级黑客（Nation-State Actor）
技能：⭐⭐⭐⭐⭐
特点：资源丰富，技术顶尖
动机：国家利益、情报收集
威胁：极高
```

**💼 按动机分类**
```
经济驱动型攻击者
目标：💰 金钱利益
手段：勒索软件、信用卡诈骗、加密货币挖矿
特点：追求快速变现，攻击目标广泛

政治驱动型攻击者
目标：🏛️ 政治影响
手段：网站篡改、信息泄露、服务中断
特点：针对性强，注重媒体影响

间谍驱动型攻击者
目标：🔍 情报收集
手段：长期潜伏、数据窃取、监听
特点：隐蔽性强，攻击周期长

破坏驱动型攻击者
目标：💥 纯粹破坏
手段：删除数据、破坏系统、服务中断
特点：不计后果，破坏性极强
```

### 3.2 内部威胁分析


**🏢 内部威胁类型**
```
恶意内部人员
特征：故意危害组织利益
风险：🔴 极高（权限大、了解内部）
例子：员工故意泄露客户数据牟利

无意内部人员
特征：因疏忽造成安全问题
风险：🟡 中等（数量多、难防范）
例子：员工点击钓鱼邮件导致感染

被利用内部人员
特征：被外部攻击者控制或欺骗
风险：🟠 较高（成为攻击跳板）
例子：员工账号被盗用于内部攻击
```

**🛡️ 内部威胁防护**
```
技术控制：
✓ 最小权限原则
✓ 行为监控系统
✓ 数据防泄露(DLP)
✓ 双人授权机制

管理控制：
✓ 背景调查
✓ 安全培训
✓ 定期审计
✓ 离职流程
```

### 3.3 攻击链分析


**⛓️ 网络杀伤链（Cyber Kill Chain）**
```
1️⃣ 侦察（Reconnaissance）
   攻击者收集目标信息
   
2️⃣ 武器化（Weaponization）
   制作攻击工具和载荷
   
3️⃣ 投递（Delivery）
   将攻击载荷送达目标
   
4️⃣ 利用（Exploitation）
   执行攻击代码
   
5️⃣ 安装（Installation）
   在目标系统安装后门
   
6️⃣ 命令控制（Command & Control）
   建立远程控制通道
   
7️⃣ 目标达成（Actions on Objectives）
   实现攻击目标
```

---

## 4. 📊 安全需求评估


### 4.1 CIA三元组分析


**🔐 机密性（Confidentiality）**
```
含义：确保信息只能被授权人员访问

评估问题：
🤔 哪些信息需要保密？
   - 用户个人信息
   - 商业机密
   - 系统配置信息

🤔 泄露后果有多严重？
   - 法律责任（GDPR罚款）
   - 商业损失（竞争优势丧失）
   - 声誉损害（客户信任度下降）

🤔 需要什么级别的保护？
   - 公开信息：无需加密
   - 内部信息：基础加密
   - 机密信息：强加密+访问控制
   - 绝密信息：多重加密+物理隔离
```

**✅ 完整性（Integrity）**
```
含义：确保信息的准确性和完整性

评估问题：
🤔 哪些数据不能被篡改？
   - 财务记录
   - 审计日志  
   - 数字签名

🤔 篡改后果有多严重？
   - 财务损失（错误的交易记录）
   - 法律问题（证据被篡改）
   - 系统故障（配置被破坏）

🤔 如何检测篡改？
   - 数字签名验证
   - 哈希值比较
   - 版本控制系统
   - 区块链技术
```

**🔄 可用性（Availability）**
```
含义：确保系统在需要时能够正常工作

评估问题：
🤔 系统宕机影响有多大？
   - 业务中断（电商网站无法交易）
   - 客户流失（服务不可用）
   - 声誉损害（可靠性质疑）

🤔 能容忍多长时间宕机？
   - 关键系统：几分钟
   - 重要系统：几小时
   - 一般系统：几天

🤔 需要什么级别的可用性？
   - 99.9%：年宕机8.76小时
   - 99.99%：年宕机52.56分钟
   - 99.999%：年宕机5.26分钟
```

### 4.2 安全需求优先级


**🎯 业务影响分析**
```
关键业务系统（Tier 1）
特征：直接影响核心业务
例子：支付系统、用户数据库
要求：最高安全级别
预算：不限制

重要业务系统（Tier 2）
特征：影响重要业务功能
例子：客服系统、报表系统
要求：高安全级别  
预算：充足投入

一般业务系统（Tier 3）
特征：支持日常运营
例子：内部邮件、文档系统
要求：标准安全级别
预算：合理投入

非关键系统（Tier 4）
特征：不影响核心业务
例子：测试环境、演示系统
要求：基础安全级别
预算：最小投入
```

---

## 5. 📈 风险评估矩阵


### 5.1 风险计算公式


**🧮 基础公式**
```
风险 = 威胁 × 漏洞 × 资产价值

威胁（Threat）：攻击发生的可能性
漏洞（Vulnerability）：系统被成功攻击的可能性  
资产价值（Asset Value）：资产对组织的重要程度
```

**📊 量化评估**
```
可能性等级：
很低（1分）：几乎不可能发生
低（2分）：不太可能发生
中（3分）：可能发生
高（4分）：很可能发生
很高（5分）：几乎肯定发生

影响等级：
很低（1分）：微小影响
低（2分）：轻微影响
中（3分）：中等影响
高（4分）：严重影响
很高（5分）：灾难性影响
```

### 5.2 风险矩阵可视化


**🎨 5×5风险矩阵**
```
影响程度
    ↑
很高│ 5│10│15│20│25│
高  │ 4│ 8│12│16│20│
中  │ 3│ 6│ 9│12│15│
低  │ 2│ 4│ 6│ 8│10│
很低│ 1│ 2│ 3│ 4│ 5│
    └─┴─┴─┴─┴─┴─→
     很低 低 中 高很高
         可能性

风险等级：
🟥 高风险（15-25）：立即处理
🟨 中风险（8-14）：计划处理  
🟩 低风险（1-7）：监控即可
```

### 5.3 风险处理策略


**🎯 四种基本策略**
```
🛡️ 降低（Mitigate）
适用：中高风险
方法：加强安全控制
例子：部署防火墙降低网络攻击风险

📤 转移（Transfer）
适用：高风险但难以控制
方法：购买保险、外包
例子：购买网络安全保险

🚫 避免（Avoid）
适用：风险太高无法接受
方法：停止相关活动
例子：停用存在严重漏洞的系统

✅ 接受（Accept）
适用：低风险或处理成本过高
方法：制定应急预案
例子：接受员工U盘使用的风险
```

---

## 6. 🏗️ 安全边界定义


### 6.1 网络安全边界


**🌐 传统网络边界**
```
外网 ←→ [防火墙] ←→ DMZ ←→ [防火墙] ←→ 内网

外网（Internet）
├─ 完全不可信
├─ 任何人都可能是攻击者
└─ 需要最严格的防护

DMZ（非军事区）
├─ 对外提供服务的区域
├─ Web服务器、邮件服务器
└─ 受到一定保护但仍有风险

内网（Internal Network）
├─ 相对可信的环境
├─ 内部员工和系统
└─ 需要防范内部威胁
```

**☁️ 云环境边界**
```
云安全边界更加复杂：

┌─────────────────────────────────┐
│           云服务商              │
│  ┌─────────┐  ┌─────────┐      │
│  │   IaaS  │  │   PaaS  │      │
│  └─────────┘  └─────────┘      │
│  ┌─────────────────────┐       │
│  │        SaaS         │       │
│  └─────────────────────┘       │
└─────────────────────────────────┘
          ↑        ↑
    ┌──责任边界──┐   │
    │           │   │
┌───▼───┐   ┌───▼───┐
│客户责任│   │厂商责任│
└───────┘   └───────┘
```

### 6.2 数据流边界


**📊 数据分类与边界**
```
数据分类示例：

🔴 绝密数据（Top Secret）
└─ 核心算法、商业机密
└─ 边界：加密存储+物理隔离

🟠 机密数据（Secret）  
└─ 客户信息、财务数据
└─ 边界：强加密+严格访问控制

🟡 内部数据（Internal）
└─ 员工信息、内部文档
└─ 边界：基础加密+身份认证

🟢 公开数据（Public）
└─ 产品介绍、新闻资讯  
└─ 边界：无特殊要求
```

**🔄 数据流控制**
```
数据流动路径：

输入边界 → 处理边界 → 存储边界 → 输出边界

每个边界都需要：
✓ 数据验证（格式、内容检查）
✓ 访问控制（权限验证）
✓ 审计记录（操作日志）
✓ 加密保护（传输、存储）
```

### 6.3 信任边界


**🤝 信任级别划分**
```
零信任模型：
"永不信任，始终验证"

传统模型 vs 零信任模型：

传统模型：
内网 = 可信 ❌
外网 = 不可信 ❌

零信任模型：
内网 = 不可信 ✅
外网 = 不可信 ✅
所有访问都需要验证 ✅
```

**🔍 信任验证机制**
```
持续验证原则：

1️⃣ 身份验证（Who）
   多因素认证、生物识别

2️⃣ 设备验证（What）
   设备证书、安全状态检查

3️⃣ 位置验证（Where）
   IP地址、地理位置

4️⃣ 行为验证（How）
   访问模式、异常检测

5️⃣ 时间验证（When）
   访问时间、会话超时
```

---

## 7. 📋 核心要点总结


### 7.1 必须掌握的核心概念


```
🎯 威胁建模本质：系统化分析安全风险的方法
🔧 分析方法：STRIDE威胁分类、DREAD风险评估
👤 攻击者模型：能力水平、动机分析、攻击链
📊 安全需求：CIA三元组、业务影响分析
📈 风险评估：风险矩阵、处理策略
🏗️ 安全边界：网络边界、数据边界、信任边界
```

### 7.2 关键理解要点


**🔹 威胁建模的价值**
```
主动防护 vs 被动应对：
- 提前识别风险点
- 合理分配安全资源
- 建立系统化防护体系
- 持续改进安全状况
```

**🔹 风险评估的重要性**
```
量化风险的好处：
- 帮助决策优先级
- 支持预算分配
- 证明投资价值
- 跟踪改进效果
```

**🔹 边界安全的演进**
```
传统边界 → 云环境边界 → 零信任边界
硬边界   → 软边界     → 动态边界
一次验证 → 定期验证   → 持续验证
```

### 7.3 实际应用价值


**💼 业务场景应用**
- **系统设计**：在设计阶段集成安全考虑
- **安全评估**：定期评估现有系统安全状况
- **事件响应**：快速定位和分析安全事件
- **合规管理**：满足法规和标准要求

**🛠️ 实践操作**
- **威胁识别**：使用STRIDE方法系统分析
- **风险量化**：使用DREAD进行风险评分
- **边界定义**：明确不同区域的安全要求
- **持续改进**：基于威胁情报更新模型

### 7.4 学习进阶路径


```
📖 基础掌握：
✓ 理解威胁建模基本概念
✓ 学会使用STRIDE分类
✓ 掌握基本风险评估方法

🔧 技能提升：
✓ 实践威胁建模工具
✓ 参与实际项目分析
✓ 学习高级分析方法

🚀 专业发展：
✓ 获得相关认证（CISSP、CISM）
✓ 参与行业标准制定
✓ 建立组织威胁建模体系
```

**🧠 记忆要点**
- 威胁建模四问：保护什么、防范谁、如何攻击、如何防护
- STRIDE六类威胁：欺骗、篡改、抵赖、泄露、拒服、提权
- CIA三元组：机密性、完整性、可用性
- 风险公式：威胁 × 漏洞 × 资产价值
- 零信任原则：永不信任，始终验证