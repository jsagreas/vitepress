---
title: 5、访问控制模型
---
## 📚 目录

1. [什么是访问控制](#1-什么是访问控制)
2. [自主访问控制(DAC)](#2-自主访问控制DAC)
3. [强制访问控制(MAC)](#3-强制访问控制MAC)
4. [基于角色的访问控制(RBAC)](#4-基于角色的访问控制RBAC)
5. [零信任安全模型](#5-零信任安全模型)
6. [四种模型对比分析](#6-四种模型对比分析)
7. [核心要点总结](#7-核心要点总结)

---

## 1. 🔐 什么是访问控制


### 1.1 通俗理解访问控制


**简单类比**：访问控制就像是现实生活中的"门禁系统"
```
小区门禁卡 → 只有业主能进入小区
办公室门锁 → 只有员工能进入办公区
保险柜密码 → 只有知道密码的人能打开
```

**核心作用**：控制"谁"能够访问"什么资源"，以及能够进行"什么操作"

### 1.2 访问控制的三要素


```
访问控制三要素
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│    主体     │───▶│    客体     │───▶│    权限     │
│  (Subject)  │    │  (Object)   │    │ (Permission)│
│   谁要访问   │    │   访问什么   │    │   能做什么   │
└─────────────┘    └─────────────┘    └─────────────┘
     用户              文件              读/写/执行
     进程              数据库            查询/修改
     程序              网络资源          连接/断开
```

**通俗解释**：
- **主体**：想要访问资源的人或程序（比如你想打开一个文件）
- **客体**：被访问的资源（比如那个文件本身）
- **权限**：允许进行的操作（比如只能读不能写）

### 1.3 为什么需要访问控制


**现实需求场景**：
```
🏢 公司场景：
- 财务资料只能财务部门看
- 人事档案只能HR部门访问
- 技术文档只能研发团队修改

🏠 个人场景：
- 手机相册不想让别人看
- 银行账户只有自己能操作
- 社交媒体设置朋友可见
```

---

## 2. 🏠 自主访问控制(DAC)


### 2.1 什么是自主访问控制


**DAC = Discretionary Access Control**

**通俗理解**：就像你家的房子，你是房主，你可以决定谁能进来，谁不能进来

```
房主的权力
┌──────────────┐
│   我的文件   │ ← 文件所有者
│              │
│ 我决定：     │
│ • 张三能读   │ ← 自主决定权限
│ • 李四能写   │
│ • 王五不能访问│
└──────────────┘
```

### 2.2 DAC的核心特点


**🔸 所有者说了算**
```
特点说明：
✅ 资源的拥有者可以自由决定访问权限
✅ 可以把权限分享给其他人
✅ 灵活性很高，使用简单
❌ 安全性相对较弱
```

**🔸 Windows文件权限就是典型的DAC**
```
右键文件 → 属性 → 安全
┌─────────────────────────────┐
│ 文件：important.docx        │
│                             │
│ 用户/组      权限           │
│ ├─ 张三      完全控制       │
│ ├─ 李四      读取和执行     │
│ └─ 所有人    拒绝访问       │
└─────────────────────────────┘
```

### 2.3 DAC的实际应用


**📁 文件系统权限**
```bash
# Linux文件权限（典型的DAC）
-rwxr--r-- 1 alice staff 1024 Aug 9 15:30 secret.txt
│││││││││
│││└┴┴──── 其他用户权限（只读）
││└────────  组权限（只读）  
│└─────────── 所有者权限（读写执行）
└─────────── 文件类型
```

**🌐 社交媒体隐私设置**
```
朋友圈权限设置：
┌─────────────────┐
│ 📸 我的照片     │
│                 │
│ 谁能看到：      │
│ ○ 公开          │
│ ● 仅朋友        │ ← 我决定
│ ○ 仅自己        │
│ ○ 自定义...     │
└─────────────────┘
```

### 2.4 DAC的优缺点


| 优点 ✅ | 缺点 ❌ |
|---------|---------|
| **使用简单**：普通用户容易理解 | **安全风险**：权限可能被滥用 |
| **灵活性高**：所有者自由决定 | **权限扩散**：难以控制权限传播 |
| **管理成本低**：无需集中管理 | **审计困难**：难以追踪权限变化 |

---

## 3. 🏛️ 强制访问控制(MAC)


### 3.1 什么是强制访问控制


**MAC = Mandatory Access Control**

**通俗理解**：就像军队或政府机构，不是你想看什么就能看什么，而是系统统一规定谁能看什么

```
军事机密分级
┌─────────────────┐
│   绝密文件      │ ← 只有将军级别能看
├─────────────────┤
│   机密文件      │ ← 校官级别以上能看  
├─────────────────┤
│   秘密文件      │ ← 尉官级别以上能看
├─────────────────┤
│   普通文件      │ ← 所有人都能看
└─────────────────┘

你的级别决定你能看什么，不是文件主人决定
```

### 3.2 MAC的核心原理


**🔸 安全标签系统**
```
主体标签 vs 客体标签
┌─────────────┐    ┌─────────────┐
│   用户A     │    │   文件X     │
│  机密级别   │ vs │  机密级别   │
│             │    │             │
│ 只能访问 ≤  │    │ 自己级别的  │
│ 自己级别的  │    │    资源     │
└─────────────┘    └─────────────┘
```

**🔸 不能向下看，不能向上传**
```
安全规则：
🔒 不能向上读取（No Read Up）
   - 机密级别的人不能看绝密文件
   
🔒 不能向下写入（No Write Down）  
   - 绝密级别的人不能向机密文件写数据
   - 防止机密信息泄露
```

### 3.3 MAC的实际应用


**🏛️ 政府和军事系统**
```
政府文件分级：
┌─────────────────────────────┐
│ 分类    │ 谁能访问           │
├─────────┼─────────────────────┤
│ 绝密    │ 国家领导人         │
│ 机密    │ 部级干部以上       │
│ 秘密    │ 处级干部以上       │
│ 内部    │ 政府工作人员       │
│ 公开    │ 所有公民           │
└─────────────────────────────┘
```

**💼 企业应用示例**
```bash
# SELinux（Linux的MAC实现）
# 查看文件的安全上下文
ls -Z confidential.txt
-rw-r--r--. alice alice unconfined_u:object_r:user_home_t:s0 confidential.txt
                    └─────────────────────────────────────┘
                              安全标签
```

### 3.4 MAC vs DAC 对比


```
场景对比：公司机密文件
┌─────────────────┬─────────────────┐
│      DAC        │      MAC        │
├─────────────────┼─────────────────┤
│ 文件主人说：    │ 公司制度说：    │
│ "张三可以看"    │ "总监级别以上   │
│                 │  才能看"        │
│                 │                 │
│ 主人决定权限    │ 系统强制执行    │
│ 灵活但不安全    │ 安全但不灵活    │
└─────────────────┴─────────────────┘
```

---

## 4. 👥 基于角色的访问控制(RBAC)


### 4.1 什么是RBAC


**RBAC = Role-Based Access Control**

**通俗理解**：就像公司里的职位，不同职位有不同的权限，你是什么职位就有什么权限

```
公司角色权限示例
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│    用户     │───▶│    角色     │───▶│    权限     │
└─────────────┘    └─────────────┘    └─────────────┘
      张三            财务经理           查看财务报表
      李四            人事专员           管理员工档案  
      王五            普通员工           查看自己信息
```

### 4.2 RBAC的三层结构


**🔸 用户-角色-权限 三层模型**
```
RBAC权限分配流程
┌─────────────────────────────────────────────────────┐
│                                                     │
│  👤用户层     🎭角色层        🔑权限层               │
│                                                     │
│  张三  ────▶  财务经理  ────▶  查看财务报表         │
│  李四  ────▶  人事专员  ────▶  管理员工档案         │
│  王五  ────▶  普通员工  ────▶  查看个人信息         │
│  赵六  ────▶  系统管理员 ────▶  系统配置权限        │
│                                                     │
└─────────────────────────────────────────────────────┘

优势：人员变动时，只需要改变角色分配，不用重新配置权限
```

### 4.3 RBAC的实际应用


**🏢 企业管理系统**
```
ERP系统角色设计：
┌─────────────────────────────────────┐
│ 角色名称    │ 具体权限              │
├─────────────┼───────────────────────┤
│ 总经理      │ • 查看所有报表        │
│             │ • 审批所有申请        │
│             │ • 系统配置权限        │
├─────────────┼───────────────────────┤
│ 财务经理    │ • 查看财务数据        │
│             │ • 处理财务流程        │
│             │ • 生成财务报表        │
├─────────────┼───────────────────────┤
│ 普通员工    │ • 查看个人信息        │
│             │ • 提交申请单据        │
│             │ • 查看公告通知        │
└─────────────────────────────────────┘
```

**💻 网站后台管理**
```php
// RBAC权限检查示例
function checkPermission($user, $action) {
    $userRoles = getUserRoles($user);  // 获取用户角色
    
    foreach ($userRoles as $role) {
        $permissions = getRolePermissions($role);  // 获取角色权限
        if (in_array($action, $permissions)) {
            return true;  // 有权限
        }
    }
    
    return false;  // 无权限
}
```

### 4.4 RBAC的优势


**🔸 管理效率提升**
```
传统权限管理 vs RBAC：

传统方式：
员工A离职 → 逐个撤销各系统权限（容易遗漏）
新员工入职 → 逐个分配各系统权限（容易出错）

RBAC方式：
员工A离职 → 删除用户账号（所有权限自动失效）
新员工入职 → 分配对应角色（权限自动获得）
```

---

## 5. 🛡️ 零信任安全模型


### 5.1 什么是零信任


**通俗理解**：就像疫情期间的防疫政策 - "不信任任何人，验证每个人"

```
传统安全 vs 零信任
┌─────────────────┬─────────────────┐
│   传统安全      │     零信任      │
├─────────────────┼─────────────────┤
│ 内网是安全的    │ 不信任任何网络  │
│ 外网是危险的    │ 验证每次访问    │
│                 │                 │
│ 🏰城堡模式      │ 🕵️持续验证     │
│ 一次验证到底    │ 每次都要验证    │
└─────────────────┴─────────────────┘
```

### 5.2 零信任的核心原则


**🔸 永不信任，持续验证**
```
零信任验证流程
┌─────────────────────────────────────┐
│  每次访问都要回答三个问题：         │
│                                     │
│  ❓ 你是谁？     → 身份验证         │
│  ❓ 你要做什么？ → 权限检查         │
│  ❓ 你的行为正常吗？ → 行为分析     │
│                                     │
│  只有三个都通过，才允许访问         │
└─────────────────────────────────────┘
```

**🔸 最小权限原则**
```
权限分配策略：
┌─────────────────────────────┐
│ 给予用户完成工作所需的      │
│ 最小权限，不多给一点        │
│                             │
│ 例如：                      │
│ • 财务只能访问财务系统      │
│ • 只能在工作时间访问        │
│ • 只能从办公网络访问        │
│ • 访问时间有限制            │
└─────────────────────────────┘
```

### 5.3 零信任的实现方式


**🔸 多因素认证(MFA)**
```
登录验证步骤：
第1步：输入用户名密码  ✅
第2步：手机验证码确认  ✅  
第3步：指纹或面部识别 ✅
第4步：检查设备可信度  ✅
───────────────────────────
全部通过才能登录系统 🎯
```

**🔸 动态权限调整**
```python
# 零信任权限检查示例
def zero_trust_check(user, resource, context):
    # 1. 身份验证
    if not verify_identity(user):
        return False
    
    # 2. 设备检查    
    if not is_trusted_device(context.device):
        return False
        
    # 3. 网络位置检查
    if not is_safe_network(context.network):
        return False
        
    # 4. 行为分析
    if detect_anomaly(user, context):
        return False
        
    # 5. 实时权限验证
    return check_current_permissions(user, resource)
```

### 5.4 零信任的实际应用


**🏢 企业应用场景**
```
远程办公安全：
┌─────────────────────────────────┐
│ 员工在家办公访问公司系统：      │
│                                 │
│ 1. VPN连接 + 多因素认证         │
│ 2. 设备安全检查                 │
│ 3. 实时监控访问行为             │
│ 4. 定时重新验证身份             │
│ 5. 访问权限最小化               │
└─────────────────────────────────┘
```

**☁️ 云服务安全**
```
云资源访问控制：
每次访问云服务都需要：
✅ API密钥验证
✅ IP地址白名单检查  
✅ 访问时间窗口限制
✅ 操作行为合理性分析
✅ 资源访问最小权限
```

---

## 6. 📊 四种模型对比分析


### 6.1 适用场景对比


| 模型 | 最适合的场景 | 典型应用 |
|------|------------|----------|
| **DAC** 🏠 | 个人文件管理、小型团队 | Windows文件权限、个人网盘 |
| **MAC** 🏛️ | 高机密环境、严格监管 | 政府系统、军事网络 |
| **RBAC** 👥 | 企业管理、大型组织 | 企业ERP、权限管理系统 |
| **零信任** 🛡️ | 现代企业、云环境 | 远程办公、云原生应用 |

### 6.2 安全级别对比


```
安全强度排序
┌─────────────────────────────────────┐
│ 安全级别：低 ──────────────▶ 高      │
│                                     │
│ DAC     RBAC     MAC    零信任       │
│  │       │        │       │        │
│  │       │        │       └─ 最强  │
│  │       │        └───────── 很强   │
│  │       └────────────────── 较强   │
│  └────────────────────────── 一般   │
└─────────────────────────────────────┘
```

### 6.3 实施复杂度对比


```
实施难度对比
┌─────────────────────────────────────┐
│ 复杂度：低 ──────────────▶ 高        │
│                                     │
│ DAC     RBAC     MAC    零信任       │
│  │       │        │       │        │
│  │       │        │       └─ 最复杂 │
│  │       │        └───────── 很复杂 │
│  │       └────────────────── 较复杂 │
│  └────────────────────────── 简单   │
└─────────────────────────────────────┘
```

### 6.4 选择建议


**🎯 如何选择合适的访问控制模型**

::: tip 个人用户
推荐：**DAC**
- 文件权限设置简单
- 满足基本安全需求
- 学习成本低
:::

::: warning 中小企业  
推荐：**RBAC**
- 权限管理效率高
- 适合团队协作
- 成本适中
:::

::: danger 高安全要求
推荐：**MAC + 零信任**
- 最高安全级别
- 适合敏感数据
- 成本较高但必要
:::

---

## 7. 📋 核心要点总结


### 7.1 四种模型核心特点


```
🔸 DAC（自主访问控制）
   核心：所有者决定权限
   特点：灵活简单，安全性一般
   
🔸 MAC（强制访问控制）  
   核心：系统统一控制权限
   特点：安全性高，灵活性低
   
🔸 RBAC（基于角色的访问控制）
   核心：角色决定权限
   特点：管理效率高，适合企业
   
🔸 零信任（Zero Trust）
   核心：不信任任何人，持续验证
   特点：最高安全级别，实施复杂
```

### 7.2 记忆要点


**🧠 记忆口诀**
```
DAC像房主，自己说了算
MAC像军队，等级很严格  
RBAC像公司，角色定权限
零信任最严，时时都验证
```

**🎯 选择原则**
- **个人使用** → DAC够用了
- **企业管理** → RBAC最合适  
- **高度机密** → MAC或零信任
- **现代云环境** → 零信任是趋势

### 7.3 实际应用建议


**💡 最佳实践**
1. **根据场景选择**：不是越复杂越好，合适最重要
2. **渐进式实施**：从简单模型开始，逐步升级
3. **组合使用**：可以在不同层面使用不同模型
4. **定期评估**：根据业务发展调整访问控制策略

**⚠️ 常见误区**
- ❌ 认为DAC不安全就完全不用
- ❌ 盲目追求最复杂的模型  
- ❌ 一次性实施所有安全措施
- ❌ 忽视用户体验和使用便利性

**核心理解**：访问控制就是在安全性和便利性之间找平衡，选择最适合自己场景的方案，而不是最复杂的方案。