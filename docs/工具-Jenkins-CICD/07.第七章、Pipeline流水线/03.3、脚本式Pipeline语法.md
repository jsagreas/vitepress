---
title: 3ã€è„šæœ¬å¼Pipelineè¯­æ³•
---
## ğŸ“š ç›®å½•

1. [è„šæœ¬å¼Pipelineæ¦‚è¿°](#1-è„šæœ¬å¼Pipelineæ¦‚è¿°)
2. [nodeèŠ‚ç‚¹é€‰æ‹©æœºåˆ¶](#2-nodeèŠ‚ç‚¹é€‰æ‹©æœºåˆ¶)
3. [stageé˜¶æ®µåˆ’åˆ†è®¾è®¡](#3-stageé˜¶æ®µåˆ’åˆ†è®¾è®¡)
4. [Groovyè„šæœ¬è¯­æ³•åŸºç¡€](#4-Groovyè„šæœ¬è¯­æ³•åŸºç¡€)
5. [å˜é‡ä¸å‡½æ•°ä½¿ç”¨](#5-å˜é‡ä¸å‡½æ•°ä½¿ç”¨)
6. [å¼‚å¸¸å¤„ç†æœºåˆ¶](#6-å¼‚å¸¸å¤„ç†æœºåˆ¶)
7. [çµæ´»æ§åˆ¶æµç¨‹](#7-çµæ´»æ§åˆ¶æµç¨‹)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ è„šæœ¬å¼Pipelineæ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯è„šæœ¬å¼Pipeline


**é€šä¿—ç†è§£**ï¼šè„šæœ¬å¼Pipelineå°±åƒæ˜¯ç”¨ä»£ç å†™çš„"æ–½å·¥å›¾çº¸"ï¼Œå‘Šè¯‰JenkinsæŒ‰ç…§ä»€ä¹ˆæ­¥éª¤æ¥æ„å»ºä½ çš„é¡¹ç›®ã€‚

```
ä¼ ç»Ÿç†è§£ï¼šæ‰‹å·¥æ“ä½œ        â†’    è„šæœ¬å¼Pipelineï¼šä»£ç è‡ªåŠ¨åŒ–
å·¥äººçœ‹å›¾çº¸æ‰‹å·¥å»ºæˆ¿        â†’    æœºå™¨äººæŒ‰ç¨‹åºè‡ªåŠ¨å»ºæˆ¿
å®¹æ˜“å‡ºé”™ï¼Œæ•ˆç‡ä½          â†’    å‡†ç¡®é«˜æ•ˆï¼Œå¯é‡å¤æ‰§è¡Œ
```

**æ ¸å¿ƒç‰¹ç‚¹**ï¼š
- ğŸ”¸ **ä»£ç å³é…ç½®**ï¼šç”¨Groovyä»£ç æè¿°æ•´ä¸ªæ„å»ºæµç¨‹
- ğŸ”¸ **ç‰ˆæœ¬æ§åˆ¶**ï¼šPipelineä»£ç å¯ä»¥å’Œé¡¹ç›®ä»£ç ä¸€èµ·ç®¡ç†
- ğŸ”¸ **é«˜åº¦çµæ´»**ï¼šæ”¯æŒå¤æ‚çš„é€»è¾‘æ§åˆ¶å’Œæ¡ä»¶åˆ¤æ–­
- ğŸ”¸ **å¯é‡ç”¨æ€§**ï¼šä¸€æ¬¡ç¼–å†™ï¼Œå¤šæ¬¡ä½¿ç”¨

### 1.2 è„šæœ¬å¼ vs å£°æ˜å¼Pipeline


| ç‰¹æ€§å¯¹æ¯” | **è„šæœ¬å¼Pipeline** | **å£°æ˜å¼Pipeline** |
|---------|------------------|-------------------|
| ğŸ“ **å­¦ä¹ éš¾åº¦** | `è¾ƒéš¾ï¼Œéœ€è¦GroovyåŸºç¡€` | `è¾ƒæ˜“ï¼Œç»“æ„åŒ–è¯­æ³•` |
| ğŸ”§ **çµæ´»æ€§** | `æé«˜ï¼Œå¯ä»»æ„ç¼–ç¨‹` | `è¾ƒé«˜ï¼Œæœ‰ä¸€å®šé™åˆ¶` |
| ğŸ“ **è¯­æ³•é£æ ¼** | `å‘½ä»¤å¼ï¼Œè‡ªç”±ç¼–å†™` | `å£°æ˜å¼ï¼Œç»“æ„å›ºå®š` |
| ğŸ› **è°ƒè¯•éš¾åº¦** | `å¤æ‚ï¼Œéœ€è¦ç¼–ç¨‹æ€ç»´` | `ç®€å•ï¼Œé”™è¯¯æç¤ºæ¸…æ™°` |
| ğŸ”„ **é€‚ç”¨åœºæ™¯** | `å¤æ‚é€»è¾‘ï¼Œå®šåˆ¶éœ€æ±‚` | `æ ‡å‡†æµç¨‹ï¼Œå¿«é€Ÿä¸Šæ‰‹` |

**ç®€å•è®°å¿†**ï¼š
- **è„šæœ¬å¼**ï¼šåƒå†™ç¨‹åº â†’ è‡ªç”±åº¦é«˜ï¼Œå¤æ‚åº¦é«˜
- **å£°æ˜å¼**ï¼šåƒå¡«è¡¨æ ¼ â†’ ç»“æ„æ¸…æ™°ï¼Œä¸Šæ‰‹å®¹æ˜“

### 1.3 åŸºæœ¬ç»“æ„æ¨¡æ¿


```groovy
node('æ ‡ç­¾å') {                    // â† é€‰æ‹©è¿è¡ŒèŠ‚ç‚¹
    stage('é˜¶æ®µ1åç§°') {            // â† å®šä¹‰ç¬¬ä¸€ä¸ªé˜¶æ®µ
        // å…·ä½“æ‰§è¡Œæ­¥éª¤
    }
    
    stage('é˜¶æ®µ2åç§°') {            // â† å®šä¹‰ç¬¬äºŒä¸ªé˜¶æ®µ
        // å…·ä½“æ‰§è¡Œæ­¥éª¤
    }
}
```

**ç»“æ„è§£æ**ï¼š
```
Jenkinsæµæ°´çº¿æ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Jenkins Master          â”‚ â† ä¸»æ§èŠ‚ç‚¹ï¼Œåˆ†é…ä»»åŠ¡
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  node('web-server') {          â”‚ â† é€‰æ‹©å…·ä½“æ‰§è¡ŒèŠ‚ç‚¹
â”‚    stage('æ„å»º') { ... }        â”‚ â† ç¬¬ä¸€ä¸ªå·¥ä½œé˜¶æ®µ
â”‚    stage('æµ‹è¯•') { ... }        â”‚ â† ç¬¬äºŒä¸ªå·¥ä½œé˜¶æ®µ
â”‚    stage('éƒ¨ç½²') { ... }        â”‚ â† ç¬¬ä¸‰ä¸ªå·¥ä½œé˜¶æ®µ
â”‚  }                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ğŸ–¥ï¸ nodeèŠ‚ç‚¹é€‰æ‹©æœºåˆ¶


### 2.1 nodeçš„ä½œç”¨å’Œæ„ä¹‰


**é€šä¿—è§£é‡Š**ï¼šnodeå°±åƒæ˜¯é€‰æ‹©"åœ¨å“ªå°æœºå™¨ä¸Šå¹²æ´»"ã€‚æ¯”å¦‚ä½ æœ‰å¤šå°ç”µè„‘ï¼Œä½ è¦æŒ‡å®šåœ¨å“ªå°ä¸Šè¿è¡Œä½ çš„ç¨‹åºã€‚

**ä¸ºä»€ä¹ˆéœ€è¦node**ï¼š
```
å®é™…å·¥ä½œåœºæ™¯ï¼š
ğŸ–¥ï¸ Windowsæœºå™¨  â†’  é€‚åˆ.NETé¡¹ç›®æ„å»º
ğŸ§ Linuxæœºå™¨    â†’  é€‚åˆJavaã€Pythoné¡¹ç›®
ğŸ Macæœºå™¨      â†’  é€‚åˆiOSé¡¹ç›®æ„å»º
â˜ï¸ äº‘ç«¯æœºå™¨     â†’  é€‚åˆå¤§å‹é¡¹ç›®ï¼Œèµ„æºå……è¶³
```

### 2.2 èŠ‚ç‚¹é€‰æ‹©è¯­æ³•


**åŸºç¡€è¯­æ³•**ï¼š
```groovy
// æ–¹å¼1ï¼šé€‰æ‹©ä»»æ„å¯ç”¨èŠ‚ç‚¹
node {
    // åœ¨ä»»æ„ä¸€ä¸ªå¯ç”¨çš„èŠ‚ç‚¹ä¸Šæ‰§è¡Œ
}

// æ–¹å¼2ï¼šæ ¹æ®æ ‡ç­¾é€‰æ‹©èŠ‚ç‚¹
node('linux && docker') {
    // åœ¨æœ‰linuxå’Œdockeræ ‡ç­¾çš„èŠ‚ç‚¹ä¸Šæ‰§è¡Œ
}

// æ–¹å¼3ï¼šé€‰æ‹©ç‰¹å®šèŠ‚ç‚¹
node('build-server-01') {
    // åœ¨åä¸ºbuild-server-01çš„èŠ‚ç‚¹ä¸Šæ‰§è¡Œ
}
```

### 2.3 æ ‡ç­¾ç»„åˆè§„åˆ™


**é€»è¾‘è¿ç®—ç¬¦**ï¼š
```groovy
// ANDè¿ç®—ï¼šå¿…é¡»åŒæ—¶æ»¡è¶³
node('linux && java8') {
    // æ—¢æœ‰linuxæ ‡ç­¾åˆæœ‰java8æ ‡ç­¾çš„èŠ‚ç‚¹
}

// ORè¿ç®—ï¼šæ»¡è¶³å…¶ä¸­ä¹‹ä¸€å³å¯
node('windows || mac') {
    // æœ‰windowsæ ‡ç­¾æˆ–macæ ‡ç­¾çš„èŠ‚ç‚¹
}

// NOTè¿ç®—ï¼šæ’é™¤æŸäº›èŠ‚ç‚¹
node('!windows') {
    // ä¸æ˜¯windowsçš„èŠ‚ç‚¹
}

// å¤æ‚ç»„åˆ
node('(linux || mac) && docker && !production') {
    // (Linuxæˆ–Mac) ä¸” æœ‰Docker ä¸” ä¸æ˜¯ç”Ÿäº§ç¯å¢ƒ
}
```

### 2.4 èŠ‚ç‚¹é€‰æ‹©æœ€ä½³å®è·µ


**ğŸ’¡ å®ç”¨å»ºè®®**ï¼š

| åœºæ™¯ | **æ¨èåšæ³•** | **ç¤ºä¾‹** |
|------|-------------|---------|
| ğŸ”¨ **æ„å»ºé˜¶æ®µ** | `é€‰æ‹©æ€§èƒ½å¼ºçš„èŠ‚ç‚¹` | `node('build-server')` |
| ğŸ§ª **æµ‹è¯•é˜¶æ®µ** | `é€‰æ‹©æœ‰æµ‹è¯•ç¯å¢ƒçš„èŠ‚ç‚¹` | `node('test-env')` |
| ğŸš€ **éƒ¨ç½²é˜¶æ®µ** | `é€‰æ‹©é è¿‘ç›®æ ‡ç¯å¢ƒçš„èŠ‚ç‚¹` | `node('deploy-zone')` |
| ğŸ³ **Dockeræ„å»º** | `é€‰æ‹©æœ‰Dockerçš„èŠ‚ç‚¹` | `node('docker')` |

**å¸¸è§æ ‡ç­¾å‘½åè§„åˆ™**ï¼š
```
ç¯å¢ƒç±»å‹ï¼š  development, staging, production
æ“ä½œç³»ç»Ÿï¼š  linux, windows, mac
è½¯ä»¶ç¯å¢ƒï¼š  java8, java11, nodejs, python3
ç‰¹æ®Šèƒ½åŠ›ï¼š  docker, kubernetes, android-sdk
ç¡¬ä»¶é…ç½®ï¼š  high-memory, high-cpu, ssd-storage
```

---

## 3. ğŸ“‹ stageé˜¶æ®µåˆ’åˆ†è®¾è®¡


### 3.1 stageçš„æœ¬è´¨å«ä¹‰


**å½¢è±¡ç†è§£**ï¼šstageå°±åƒæ˜¯"å·¥å‚æµæ°´çº¿çš„å·¥ä½œç«™"ï¼Œæ¯ä¸ªå·¥ä½œç«™è´Ÿè´£ä¸€ä¸ªç‰¹å®šçš„ä»»åŠ¡ã€‚

```
æ±½è½¦åˆ¶é€ æµæ°´çº¿ç±»æ¯”ï¼š
å·¥ä½œç«™1ï¼šå†²å‹è½¦é—´      â†’   stage('å‡†å¤‡ä»£ç ')
å·¥ä½œç«™2ï¼šç„Šæ¥è½¦é—´      â†’   stage('ç¼–è¯‘æ„å»º') 
å·¥ä½œç«™3ï¼šæ¶‚è£…è½¦é—´      â†’   stage('è¿è¡Œæµ‹è¯•')
å·¥ä½œç«™4ï¼šæ€»è£…è½¦é—´      â†’   stage('æ‰“åŒ…éƒ¨ç½²')
å·¥ä½œç«™5ï¼šè´¨æ£€è½¦é—´      â†’   stage('éªŒè¯æ£€æŸ¥')
```

### 3.2 æ ‡å‡†é˜¶æ®µåˆ’åˆ†


**ç»å…¸CI/CDé˜¶æ®µ**ï¼š
```groovy
node {
    stage('ğŸ”„ ä»£ç æ£€å‡º') {
        // ä»ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿè·å–æœ€æ–°ä»£ç 
        checkout scm
    }
    
    stage('ğŸ”¨ ç¼–è¯‘æ„å»º') {
        // ç¼–è¯‘æºä»£ç ï¼Œç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶
        sh 'mvn compile'
    }
    
    stage('ğŸ§ª å•å…ƒæµ‹è¯•') {
        // è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•
        sh 'mvn test'
    }
    
    stage('ğŸ“¦ æ‰“åŒ…åˆ¶å“') {
        // æ‰“åŒ…æˆå¯éƒ¨ç½²çš„æ ¼å¼
        sh 'mvn package'
    }
    
    stage('ğŸš€ éƒ¨ç½²å‘å¸ƒ') {
        // éƒ¨ç½²åˆ°ç›®æ ‡ç¯å¢ƒ
        sh 'docker deploy app.jar'
    }
}
```

### 3.3 é˜¶æ®µåˆ’åˆ†åŸåˆ™


**ğŸ¯ è®¾è®¡åŸåˆ™**ï¼š

| åŸåˆ™ | **è¯´æ˜** | **å¥½å¤„** |
|------|---------|---------|
| ğŸ”¸ **å•ä¸€èŒè´£** | `æ¯ä¸ªstageåªåšä¸€ä»¶äº‹` | `é—®é¢˜å®šä½å‡†ç¡®` |
| ğŸ”¸ **é€»è¾‘æ¸…æ™°** | `æŒ‰å·¥ä½œæµç¨‹é¡ºåºæ’åˆ—` | `æµç¨‹ç†è§£å®¹æ˜“` |
| ğŸ”¸ **å¯å¹¶è¡ŒåŒ–** | `ç‹¬ç«‹çš„stageå¯ä»¥å¹¶è¡Œ` | `æé«˜æ„å»ºé€Ÿåº¦` |
| ğŸ”¸ **æ˜“äºè°ƒè¯•** | `stageå¤±è´¥æ—¶å®¹æ˜“æ‰¾åŸå› ` | `å¿«é€Ÿé—®é¢˜è§£å†³` |

### 3.4 é«˜çº§é˜¶æ®µæ§åˆ¶


**æ¡ä»¶æ‰§è¡Œ**ï¼š
```groovy
stage('ğŸ” ä»£ç æ‰«æ') {
    when {
        branch 'main'  // åªåœ¨mainåˆ†æ”¯æ‰§è¡Œ
    }
    steps {
        sh 'sonar-scanner'
    }
}

stage('ğŸŒ ç”Ÿäº§éƒ¨ç½²') {
    when {
        allOf {
            branch 'main'
            environment name: 'DEPLOY_PROD', value: 'true'
        }
    }
    steps {
        sh 'kubectl apply -f production.yaml'
    }
}
```

---

## 4. ğŸ’» Groovyè„šæœ¬è¯­æ³•åŸºç¡€


### 4.1 Groovyè¯­è¨€ç®€ä»‹


**é€šä¿—ç†è§£**ï¼šGroovyå°±åƒæ˜¯"ç®€åŒ–ç‰ˆçš„Java"ï¼Œè¯­æ³•æ›´ç®€æ´ï¼Œä½†åŠŸèƒ½å¾ˆå¼ºå¤§ã€‚Jenkinsé€‰æ‹©å®ƒæ˜¯å› ä¸ºå®ƒæ—¢ç®€å•åˆçµæ´»ã€‚

**Groovyçš„ç‰¹ç‚¹**ï¼š
- ğŸ”¸ **Javaå…¼å®¹**ï¼šJavaä»£ç å¯ä»¥ç›´æ¥åœ¨Groovyä¸­è¿è¡Œ
- ğŸ”¸ **è¯­æ³•ç®€æ´**ï¼šå¾ˆå¤šJavaçš„ç¹çè¯­æ³•éƒ½å¯ä»¥ç®€åŒ–
- ğŸ”¸ **åŠ¨æ€ç‰¹æ€§**ï¼šæ”¯æŒåŠ¨æ€ç±»å‹ï¼Œç¼–å†™æ›´çµæ´»
- ğŸ”¸ **è„šæœ¬å‹å¥½**ï¼šéå¸¸é€‚åˆå†™è‡ªåŠ¨åŒ–è„šæœ¬

### 4.2 Pipelineä¸­çš„åŸºæœ¬è¯­æ³•


**å˜é‡å£°æ˜**ï¼š
```groovy
// å­—ç¬¦ä¸²å˜é‡
def projectName = 'my-app'
def version = "1.0.${env.BUILD_NUMBER}"

// æ•°å­—å˜é‡
def timeout = 30
def retryCount = 3

// å¸ƒå°”å˜é‡
def isProduction = false
def needsApproval = true

// åˆ—è¡¨
def servers = ['web1', 'web2', 'web3']
def environments = ['dev', 'test', 'prod']
```

**å­—ç¬¦ä¸²æ“ä½œ**ï¼š
```groovy
// å­—ç¬¦ä¸²æ‹¼æ¥
def message = "æ„å»ºé¡¹ç›®ï¼š${projectName} ç‰ˆæœ¬ï¼š${version}"

// å¤šè¡Œå­—ç¬¦ä¸²
def script = """
    echo "å¼€å§‹æ„å»º"
    mvn clean package
    echo "æ„å»ºå®Œæˆ"
"""

// æ‰§è¡Œshellå‘½ä»¤
sh "echo 'å½“å‰ç›®å½•ï¼š' && pwd"
sh "docker build -t ${projectName}:${version} ."
```

### 4.3 æ§åˆ¶æµç¨‹è¯­æ³•


**æ¡ä»¶åˆ¤æ–­**ï¼š
```groovy
// if-elseæ¡ä»¶
if (env.BRANCH_NAME == 'main') {
    echo "è¿™æ˜¯ä¸»åˆ†æ”¯ï¼Œæ‰§è¡Œå®Œæ•´æµç¨‹"
    sh 'mvn clean package'
} else {
    echo "è¿™æ˜¯ç‰¹æ€§åˆ†æ”¯ï¼Œåªæ‰§è¡Œæµ‹è¯•"
    sh 'mvn test'
}

// switchå¤šåˆ†æ”¯
switch(env.ENVIRONMENT) {
    case 'dev':
        echo "éƒ¨ç½²åˆ°å¼€å‘ç¯å¢ƒ"
        break
    case 'test':
        echo "éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ"
        break
    case 'prod':
        echo "éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ"
        break
    default:
        echo "æœªçŸ¥ç¯å¢ƒ"
}
```

**å¾ªç¯æ“ä½œ**ï¼š
```groovy
// forå¾ªç¯éå†åˆ—è¡¨
def servers = ['web1', 'web2', 'web3']
for (server in servers) {
    echo "éƒ¨ç½²åˆ°æœåŠ¡å™¨ï¼š${server}"
    sh "scp app.jar ${server}:/opt/app/"
}

// eachæ–¹æ³•éå†
servers.each { server ->
    echo "é‡å¯æœåŠ¡å™¨ï¼š${server}"
    sh "ssh ${server} 'systemctl restart app'"
}
```

### 4.4 Jenkins Pipelineä¸“ç”¨è¯­æ³•


**æ‰§è¡Œshellå‘½ä»¤**ï¼š
```groovy
// åŸºæœ¬æ‰§è¡Œ
sh 'ls -la'

// æ•è·è¾“å‡º
def result = sh(script: 'git rev-parse HEAD', returnStdout: true).trim()
echo "å½“å‰æäº¤IDï¼š${result}"

// æ£€æŸ¥æ‰§è¡Œç»“æœ
def status = sh(script: 'mvn test', returnStatus: true)
if (status == 0) {
    echo "æµ‹è¯•é€šè¿‡"
} else {
    error "æµ‹è¯•å¤±è´¥"
}
```

---

## 5. ğŸ”§ å˜é‡ä¸å‡½æ•°ä½¿ç”¨


### 5.1 å˜é‡ä½œç”¨åŸŸç†è§£


**é€šä¿—è§£é‡Š**ï¼šå˜é‡ä½œç”¨åŸŸå°±åƒæ˜¯"å˜é‡çš„ä½¿ç”¨èŒƒå›´"ï¼Œå°±åƒæˆ¿é—´çš„é’¥åŒ™ï¼Œæœ‰äº›åªèƒ½åœ¨ä¸€ä¸ªæˆ¿é—´ç”¨ï¼Œæœ‰äº›å¯ä»¥åœ¨æ•´æ ‹æ¥¼ç”¨ã€‚

```
å˜é‡ä½œç”¨åŸŸå±‚æ¬¡å›¾ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       å…¨å±€ç¯å¢ƒå˜é‡ (env)         â”‚ â† æ•´ä¸ªJenkinså¯ç”¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       Pipelineçº§åˆ«å˜é‡          â”‚ â† æ•´ä¸ªPipelineå¯ç”¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       nodeå—çº§åˆ«å˜é‡            â”‚ â† nodeå—å†…å¯ç”¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       stageå—çº§åˆ«å˜é‡           â”‚ â† stageå—å†…å¯ç”¨
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ç¯å¢ƒå˜é‡ä½¿ç”¨


**ç³»ç»Ÿå†…ç½®å˜é‡**ï¼š
```groovy
node {
    stage('ç¯å¢ƒä¿¡æ¯') {
        echo "æ„å»ºç¼–å·ï¼š${env.BUILD_NUMBER}"
        echo "æ„å»ºURLï¼š${env.BUILD_URL}"
        echo "å·¥ä½œç©ºé—´ï¼š${env.WORKSPACE}"
        echo "åˆ†æ”¯åç§°ï¼š${env.BRANCH_NAME}"
        echo "æ„å»ºåŸå› ï¼š${env.BUILD_CAUSE}"
        echo "Jenkinsä¸»é¡µï¼š${env.JENKINS_URL}"
    }
}
```

**è‡ªå®šä¹‰ç¯å¢ƒå˜é‡**ï¼š
```groovy
node {
    // æ–¹å¼1ï¼šä½¿ç”¨withEnv
    withEnv(['CUSTOM_VAR=hello', 'ANOTHER_VAR=world']) {
        sh 'echo "è‡ªå®šä¹‰å˜é‡ï¼š$CUSTOM_VAR $ANOTHER_VAR"'
    }
    
    // æ–¹å¼2ï¼šç›´æ¥è®¾ç½®
    env.PROJECT_VERSION = '2.0.0'
    env.DEPLOY_ENV = 'production'
    
    stage('ä½¿ç”¨ç¯å¢ƒå˜é‡') {
        sh "echo 'é¡¹ç›®ç‰ˆæœ¬ï¼š${env.PROJECT_VERSION}'"
        sh "echo 'éƒ¨ç½²ç¯å¢ƒï¼š${env.DEPLOY_ENV}'"
    }
}
```

### 5.3 å‚æ•°åŒ–æ„å»º


**æ¥æ”¶ç”¨æˆ·è¾“å…¥å‚æ•°**ï¼š
```groovy
// åœ¨Pipelineå¼€å¤´å®šä¹‰å‚æ•°
properties([
    parameters([
        choice(choices: ['dev', 'test', 'prod'], 
               description: 'é€‰æ‹©éƒ¨ç½²ç¯å¢ƒ', 
               name: 'ENVIRONMENT'),
        string(defaultValue: 'main', 
               description: 'æŒ‡å®šåˆ†æ”¯', 
               name: 'BRANCH_NAME'),
        booleanParam(defaultValue: false, 
                    description: 'æ˜¯å¦è·³è¿‡æµ‹è¯•', 
                    name: 'SKIP_TESTS')
    ])
])

node {
    stage('å‚æ•°å±•ç¤º') {
        echo "éƒ¨ç½²ç¯å¢ƒï¼š${params.ENVIRONMENT}"
        echo "åˆ†æ”¯åç§°ï¼š${params.BRANCH_NAME}"
        echo "è·³è¿‡æµ‹è¯•ï¼š${params.SKIP_TESTS}"
    }
    
    stage('æ¡ä»¶æ‰§è¡Œ') {
        if (!params.SKIP_TESTS) {
            echo "æ‰§è¡Œæµ‹è¯•"
            sh 'mvn test'
        } else {
            echo "è·³è¿‡æµ‹è¯•é˜¶æ®µ"
        }
    }
}
```

### 5.4 è‡ªå®šä¹‰å‡½æ•°


**åˆ›å»ºå¯é‡ç”¨å‡½æ•°**ï¼š
```groovy
// å®šä¹‰å·¥å…·å‡½æ•°
def deployToServer(serverName, appFile) {
    echo "éƒ¨ç½² ${appFile} åˆ°æœåŠ¡å™¨ ${serverName}"
    sh "scp ${appFile} ${serverName}:/opt/app/"
    sh "ssh ${serverName} 'systemctl restart app'"
}

def sendNotification(message) {
    echo "å‘é€é€šçŸ¥ï¼š${message}"
    // è¿™é‡Œå¯ä»¥é›†æˆé‚®ä»¶ã€é’‰é’‰ã€å¾®ä¿¡ç­‰é€šçŸ¥
}

node {
    stage('æ„å»º') {
        sh 'mvn clean package'
        def jarFile = "target/app-${env.BUILD_NUMBER}.jar"
    }
    
    stage('éƒ¨ç½²') {
        // ä½¿ç”¨è‡ªå®šä¹‰å‡½æ•°
        deployToServer('web-server-1', jarFile)
        deployToServer('web-server-2', jarFile)
        
        sendNotification("éƒ¨ç½²å®Œæˆï¼šç‰ˆæœ¬ ${env.BUILD_NUMBER}")
    }
}
```

### 5.5 å…±äº«åº“å‡½æ•°


**è°ƒç”¨å…±äº«åº“**ï¼š
```groovy
// åŠ è½½å…±äº«åº“
@Library('my-jenkins-library') _

node {
    stage('ä½¿ç”¨å…±äº«åº“') {
        // è°ƒç”¨å…±äº«åº“ä¸­çš„å‡½æ•°
        buildDockerImage('my-app', env.BUILD_NUMBER)
        
        // ä½¿ç”¨å…±äº«åº“çš„é€šç”¨éƒ¨ç½²æµç¨‹
        deployApplication([
            environment: 'production',
            replicas: 3,
            healthCheck: '/health'
        ])
    }
}
```

---

## 6. âš ï¸ å¼‚å¸¸å¤„ç†æœºåˆ¶


### 6.1 å¼‚å¸¸å¤„ç†çš„é‡è¦æ€§


**é€šä¿—ç†è§£**ï¼šå¼‚å¸¸å¤„ç†å°±åƒæ˜¯ç»™ä½ çš„è‡ªåŠ¨åŒ–æµç¨‹åŠ ä¸Š"ä¿é™©"ï¼Œå½“å‡ºç°é—®é¢˜æ—¶èƒ½å¤Ÿä¼˜é›…åœ°å¤„ç†ï¼Œè€Œä¸æ˜¯ç›´æ¥å´©æºƒã€‚

**ä¸ºä»€ä¹ˆéœ€è¦å¼‚å¸¸å¤„ç†**ï¼š
```
æ— å¼‚å¸¸å¤„ç†çš„åæœï¼š
âŒ ä¸€ä¸ªå°é”™è¯¯å¯¼è‡´æ•´ä¸ªæµç¨‹ä¸­æ–­
âŒ é”™è¯¯ä¿¡æ¯ä¸æ¸…æ™°ï¼Œéš¾ä»¥æ’æŸ¥é—®é¢˜  
âŒ èµ„æºæ²¡æœ‰æ­£ç¡®æ¸…ç†
âŒ å›¢é˜Ÿæˆå‘˜ä¸çŸ¥é“æ„å»ºå¤±è´¥åŸå› 

æœ‰å¼‚å¸¸å¤„ç†çš„å¥½å¤„ï¼š
âœ… é”™è¯¯æ—¶å¯ä»¥ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡
âœ… è¯¦ç»†çš„é”™è¯¯æ—¥å¿—å’Œé€šçŸ¥
âœ… è‡ªåŠ¨æ¸…ç†èµ„æº
âœ… åŠæ—¶é€šçŸ¥ç›¸å…³äººå‘˜
```

### 6.2 åŸºæœ¬å¼‚å¸¸å¤„ç†è¯­æ³•


**try-catch-finallyæ¨¡å¼**ï¼š
```groovy
node {
    stage('å¼‚å¸¸å¤„ç†ç¤ºä¾‹') {
        try {
            // å¯èƒ½å‡ºé”™çš„æ“ä½œ
            sh 'mvn clean test'
            echo "æµ‹è¯•æ‰§è¡ŒæˆåŠŸ"
            
        } catch (Exception e) {
            // å¤„ç†å¼‚å¸¸
            echo "æµ‹è¯•æ‰§è¡Œå¤±è´¥ï¼š${e.getMessage()}"
            currentBuild.result = 'UNSTABLE'  // è®¾ç½®æ„å»ºçŠ¶æ€
            
        } finally {
            // æ— è®ºæˆåŠŸå¤±è´¥éƒ½è¦æ‰§è¡Œçš„æ¸…ç†å·¥ä½œ
            echo "æ¸…ç†æµ‹è¯•ç¯å¢ƒ"
            sh 'docker-compose down'
        }
    }
}
```

### 6.3 åˆ†ç±»å¤„ç†ä¸åŒå¼‚å¸¸


**é’ˆå¯¹æ€§å¼‚å¸¸å¤„ç†**ï¼š
```groovy
node {
    stage('ç¼–è¯‘é˜¶æ®µ') {
        try {
            sh 'mvn compile'
        } catch (Exception e) {
            if (e.getMessage().contains('compilation failed')) {
                echo "âŒ ç¼–è¯‘å¤±è´¥ï¼šä»£ç è¯­æ³•é”™è¯¯"
                sendNotification("ç¼–è¯‘å¤±è´¥ï¼Œè¯·æ£€æŸ¥ä»£ç è¯­æ³•")
            } else {
                echo "âŒ ç¼–è¯‘å¤±è´¥ï¼šæœªçŸ¥é”™è¯¯"
                sendNotification("ç¼–è¯‘è¿‡ç¨‹é‡åˆ°æœªçŸ¥é”™è¯¯")
            }
            throw e  // é‡æ–°æŠ›å‡ºå¼‚å¸¸ï¼Œç»ˆæ­¢æ„å»º
        }
    }
    
    stage('æµ‹è¯•é˜¶æ®µ') {
        try {
            sh 'mvn test'
        } catch (Exception e) {
            echo "âš ï¸ æµ‹è¯•å¤±è´¥ï¼Œä½†ç»§ç»­æ„å»º"
            currentBuild.result = 'UNSTABLE'
            // ä¸é‡æ–°æŠ›å‡ºå¼‚å¸¸ï¼Œå…è®¸ç»§ç»­æ‰§è¡Œ
        }
    }
}
```

### 6.4 è¶…æ—¶å’Œé‡è¯•æœºåˆ¶


**è¶…æ—¶æ§åˆ¶**ï¼š
```groovy
node {
    stage('æœ‰è¶…æ—¶çš„ä»»åŠ¡') {
        timeout(time: 10, unit: 'MINUTES') {
            try {
                sh 'mvn clean package'
            } catch (org.jenkinsci.plugins.workflow.steps.FlowInterruptedException e) {
                echo "âŒ æ„å»ºè¶…æ—¶ï¼Œå¯èƒ½ç½‘ç»œé—®é¢˜æˆ–ä»£ç é‡å¤ªå¤§"
                currentBuild.result = 'ABORTED'
                throw e
            }
        }
    }
}
```

**é‡è¯•æœºåˆ¶**ï¼š
```groovy
node {
    stage('é‡è¯•æœºåˆ¶') {
        retry(3) {  // æœ€å¤šé‡è¯•3æ¬¡
            try {
                sh 'curl -f http://api.example.com/health'
                echo "âœ… æœåŠ¡å¥åº·æ£€æŸ¥é€šè¿‡"
            } catch (Exception e) {
                echo "âš ï¸ å¥åº·æ£€æŸ¥å¤±è´¥ï¼Œå‡†å¤‡é‡è¯•..."
                sleep 10  // ç­‰å¾…10ç§’åé‡è¯•
                throw e
            }
        }
    }
}
```

### 6.5 ä¼˜é›…çš„é”™è¯¯é€šçŸ¥


**æ„å»ºçŠ¶æ€è®¾ç½®å’Œé€šçŸ¥**ï¼š
```groovy
node {
    try {
        stage('ä¸»è¦æµç¨‹') {
            // ä¸»è¦çš„æ„å»ºé€»è¾‘
        }
        
        // æˆåŠŸæ—¶çš„å¤„ç†
        currentBuild.result = 'SUCCESS'
        sendSuccessNotification()
        
    } catch (Exception e) {
        // å¤±è´¥æ—¶çš„å¤„ç†
        currentBuild.result = 'FAILURE'
        echo "âŒ æ„å»ºå¤±è´¥ï¼š${e.getMessage()}"
        
        sendFailureNotification([
            error: e.getMessage(),
            stage: env.STAGE_NAME,
            build: env.BUILD_NUMBER
        ])
        
        throw e
        
    } finally {
        // æ¸…ç†å·¥ä½œ
        cleanWorkspace()
    }
}

def sendFailureNotification(details) {
    def message = """
    ğŸš¨ æ„å»ºå¤±è´¥é€šçŸ¥
    é¡¹ç›®ï¼š${env.JOB_NAME}
    æ„å»ºå·ï¼š${details.build}
    å¤±è´¥é˜¶æ®µï¼š${details.stage}
    é”™è¯¯ä¿¡æ¯ï¼š${details.error}
    æŸ¥çœ‹è¯¦æƒ…ï¼š${env.BUILD_URL}
    """
    
    echo message
    // è¿™é‡Œå¯ä»¥æ¥å…¥é’‰é’‰ã€ä¼ä¸šå¾®ä¿¡ã€é‚®ä»¶ç­‰
}
```

---

## 7. ğŸ® çµæ´»æ§åˆ¶æµç¨‹


### 7.1 æ¡ä»¶åˆ†æ”¯æ§åˆ¶


**é€šä¿—ç†è§£**ï¼šæµç¨‹æ§åˆ¶å°±åƒæ˜¯"è·¯å£çš„çº¢ç»¿ç¯"ï¼Œæ ¹æ®ä¸åŒæƒ…å†µé€‰æ‹©ä¸åŒçš„æ‰§è¡Œè·¯å¾„ã€‚

**åŸºäºåˆ†æ”¯çš„æ¡ä»¶æ§åˆ¶**ï¼š
```groovy
node {
    stage('ç¯å¢ƒåˆ¤æ–­') {
        echo "å½“å‰åˆ†æ”¯ï¼š${env.BRANCH_NAME}"
        
        if (env.BRANCH_NAME == 'main') {
            echo "ğŸš€ ä¸»åˆ†æ”¯ï¼šæ‰§è¡Œå®Œæ•´æµç¨‹"
            executeFullPipeline()
            
        } else if (env.BRANCH_NAME.startsWith('release/')) {
            echo "ğŸ“¦ å‘å¸ƒåˆ†æ”¯ï¼šæ‰§è¡Œå‘å¸ƒæµç¨‹"
            executeReleasePipeline()
            
        } else if (env.BRANCH_NAME.startsWith('feature/')) {
            echo "ğŸ”§ ç‰¹æ€§åˆ†æ”¯ï¼šåªæ‰§è¡Œæµ‹è¯•"
            executeTestOnly()
            
        } else {
            echo "ğŸ¤” å…¶ä»–åˆ†æ”¯ï¼šè·³è¿‡è‡ªåŠ¨åŒ–"
            echo "è·³è¿‡è‡ªåŠ¨åŒ–æµç¨‹"
        }
    }
}

def executeFullPipeline() {
    stage('å®Œæ•´æ„å»º') {
        sh 'mvn clean package'
    }
    stage('å®Œæ•´æµ‹è¯•') {
        sh 'mvn test integration-test'
    }
    stage('éƒ¨ç½²ç”Ÿäº§') {
        sh 'kubectl apply -f production.yaml'
    }
}
```

### 7.2 å¹¶è¡Œæ‰§è¡Œæ§åˆ¶


**å¹¶è¡Œä»»åŠ¡æé«˜æ•ˆç‡**ï¼š
```groovy
node {
    stage('å¹¶è¡Œä»»åŠ¡') {
        parallel(
            "å•å…ƒæµ‹è¯•": {
                echo "ğŸ§ª æ‰§è¡Œå•å…ƒæµ‹è¯•"
                sh 'mvn test'
            },
            "ä»£ç æ‰«æ": {
                echo "ğŸ” æ‰§è¡Œä»£ç è´¨é‡æ‰«æ"
                sh 'sonar-scanner'
            },
            "å®‰å…¨æ£€æŸ¥": {
                echo "ğŸ”’ æ‰§è¡Œå®‰å…¨æ£€æŸ¥"
                sh 'dependency-check.sh'
            }
        )
    }
    
    stage('æ±‡æ€»ç»“æœ') {
        echo "âœ… æ‰€æœ‰å¹¶è¡Œä»»åŠ¡å®Œæˆ"
    }
}
```

**å¹¶è¡Œæ‰§è¡Œä¸åŒç¯å¢ƒ**ï¼š
```groovy
stage('å¤šç¯å¢ƒéƒ¨ç½²') {
    parallel(
        "å¼€å‘ç¯å¢ƒ": {
            deployToEnvironment('dev', 'dev-cluster')
        },
        "æµ‹è¯•ç¯å¢ƒ": {
            deployToEnvironment('test', 'test-cluster')
        },
        "é¢„å‘ç¯å¢ƒ": {
            deployToEnvironment('staging', 'staging-cluster')
        }
    )
}

def deployToEnvironment(env, cluster) {
    echo "éƒ¨ç½²åˆ°${env}ç¯å¢ƒ"
    sh "kubectl --context=${cluster} apply -f ${env}-config.yaml"
    sh "kubectl --context=${cluster} rollout status deployment/my-app"
}
```

### 7.3 è¾“å…¥ç­‰å¾…å’Œå®¡æ‰¹


**äººå·¥å®¡æ‰¹æ§åˆ¶**ï¼š
```groovy
node {
    stage('æ„å»ºå’Œæµ‹è¯•') {
        sh 'mvn clean package test'
    }
    
    stage('ç­‰å¾…å®¡æ‰¹') {
        // è¿™é‡Œä¼šæš‚åœï¼Œç­‰å¾…äººå·¥ç¡®è®¤
        def userInput = input(
            message: 'æ˜¯å¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼Ÿ',
            parameters: [
                choice(choices: ['æ˜¯', 'å¦'], description: 'è¯·é€‰æ‹©', name: 'DEPLOY'),
                string(defaultValue: 'v1.0.0', description: 'è¾“å…¥ç‰ˆæœ¬å·', name: 'VERSION')
            ]
        )
        
        echo "ç”¨æˆ·é€‰æ‹©ï¼š${userInput.DEPLOY}"
        echo "ç‰ˆæœ¬å·ï¼š${userInput.VERSION}"
        
        if (userInput.DEPLOY == 'æ˜¯') {
            stage('ç”Ÿäº§éƒ¨ç½²') {
                echo "ğŸš€ å¼€å§‹éƒ¨ç½²ç‰ˆæœ¬ï¼š${userInput.VERSION}"
                sh "docker tag my-app:latest my-app:${userInput.VERSION}"
                sh "kubectl set image deployment/my-app app=my-app:${userInput.VERSION}"
            }
        } else {
            echo "âŒ ç”¨æˆ·å–æ¶ˆéƒ¨ç½²"
        }
    }
}
```

### 7.4 åŠ¨æ€stageç”Ÿæˆ


**æ ¹æ®é…ç½®åŠ¨æ€åˆ›å»ºé˜¶æ®µ**ï¼š
```groovy
def environments = ['dev', 'test', 'staging', 'prod']
def services = ['user-service', 'order-service', 'payment-service']

node {
    // åŠ¨æ€åˆ›å»ºéƒ¨ç½²é˜¶æ®µ
    for (env in environments) {
        if (shouldDeploy(env)) {
            stage("éƒ¨ç½²åˆ°${env}ç¯å¢ƒ") {
                deployToEnvironment(env)
            }
        }
    }
    
    // åŠ¨æ€åˆ›å»ºæœåŠ¡æµ‹è¯•é˜¶æ®µ
    def parallelTests = [:]
    for (service in services) {
        parallelTests["æµ‹è¯•${service}"] = {
            testService(service)
        }
    }
    
    stage('æœåŠ¡æµ‹è¯•') {
        parallel parallelTests
    }
}

def shouldDeploy(environment) {
    // æ ¹æ®åˆ†æ”¯å’Œç¯å¢ƒå†³å®šæ˜¯å¦éƒ¨ç½²
    if (env.BRANCH_NAME == 'main' && environment == 'prod') {
        return true
    } else if (env.BRANCH_NAME.startsWith('release/') && environment in ['dev', 'test']) {
        return true
    }
    return false
}
```

### 7.5 é”™è¯¯æ¢å¤å’Œå›æ»š


**æ™ºèƒ½é”™è¯¯æ¢å¤**ï¼š
```groovy
node {
    def lastSuccessfulVersion = getLastSuccessfulVersion()
    
    try {
        stage('éƒ¨ç½²æ–°ç‰ˆæœ¬') {
            deployNewVersion()
            
            stage('å¥åº·æ£€æŸ¥') {
                if (!healthCheck()) {
                    throw new Exception("å¥åº·æ£€æŸ¥å¤±è´¥")
                }
            }
        }
        
    } catch (Exception e) {
        echo "âŒ éƒ¨ç½²å¤±è´¥ï¼š${e.getMessage()}"
        
        stage('è‡ªåŠ¨å›æ»š') {
            echo "ğŸ”„ è‡ªåŠ¨å›æ»šåˆ°ç‰ˆæœ¬ï¼š${lastSuccessfulVersion}"
            rollbackToVersion(lastSuccessfulVersion)
            
            if (healthCheck()) {
                echo "âœ… å›æ»šæˆåŠŸï¼ŒæœåŠ¡æ¢å¤æ­£å¸¸"
                currentBuild.result = 'UNSTABLE'
            } else {
                echo "âŒ å›æ»šå¤±è´¥ï¼Œéœ€è¦äººå·¥ä»‹å…¥"
                currentBuild.result = 'FAILURE'
                throw new Exception("å›æ»šå¤±è´¥")
            }
        }
    }
}

def healthCheck() {
    try {
        sh 'curl -f http://app.example.com/health'
        return true
    } catch (Exception e) {
        return false
    }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ è„šæœ¬å¼Pipelineï¼šç”¨Groovyä»£ç ç¼–å†™çš„çµæ´»æ„å»ºæµç¨‹
ğŸ”¸ nodeèŠ‚ç‚¹é€‰æ‹©ï¼šæ ¹æ®æ ‡ç­¾å’Œèƒ½åŠ›é€‰æ‹©åˆé€‚çš„æ‰§è¡ŒèŠ‚ç‚¹
ğŸ”¸ stageé˜¶æ®µåˆ’åˆ†ï¼šå°†æ„å»ºæµç¨‹åˆ†è§£ä¸ºæ¸…æ™°çš„é€»è¾‘é˜¶æ®µ
ğŸ”¸ Groovyè¯­æ³•ï¼šæŒæ¡åŸºæœ¬çš„å˜é‡ã€æ¡ä»¶ã€å¾ªç¯è¯­æ³•
ğŸ”¸ å¼‚å¸¸å¤„ç†ï¼šä¿è¯æ„å»ºæµç¨‹çš„å¥å£®æ€§å’Œå¯é æ€§
ğŸ”¸ æµç¨‹æ§åˆ¶ï¼šæ ¹æ®æ¡ä»¶çµæ´»è°ƒæ•´æ‰§è¡Œè·¯å¾„
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ è„šæœ¬å¼Pipelineçš„æ ¸å¿ƒä»·å€¼**ï¼š
```
ä»£ç åŒ–å¥½å¤„ï¼š
âœ… ç‰ˆæœ¬æ§åˆ¶ï¼šæ„å»ºé…ç½®å¯ä»¥å’Œä»£ç ä¸€èµ·ç®¡ç†
âœ… å¯é‡ç”¨æ€§ï¼šåŒæ ·çš„Pipelineå¯ä»¥ç”¨äºå¤šä¸ªé¡¹ç›®
âœ… çµæ´»æ€§ï¼šæ”¯æŒå¤æ‚çš„ä¸šåŠ¡é€»è¾‘
âœ… å¯ç»´æŠ¤æ€§ï¼šä¾¿äºå›¢é˜Ÿåä½œå’ŒçŸ¥è¯†ä¼ æ‰¿
```

**ğŸ”¹ èŠ‚ç‚¹é€‰æ‹©ç­–ç•¥**ï¼š
```
é€‰æ‹©åŸåˆ™ï¼š
â€¢ å°±è¿‘åŸåˆ™ï¼šé€‰æ‹©è·ç¦»ç›®æ ‡ç¯å¢ƒè¿‘çš„èŠ‚ç‚¹
â€¢ èƒ½åŠ›åŸåˆ™ï¼šé€‰æ‹©æœ‰æ‰€éœ€è½¯ä»¶å’Œå·¥å…·çš„èŠ‚ç‚¹  
â€¢ æ€§èƒ½åŸåˆ™ï¼šé€‰æ‹©é…ç½®åˆé€‚çš„èŠ‚ç‚¹
â€¢ å¯ç”¨æ€§åŸåˆ™ï¼šé¿å…å•ç‚¹æ•…éšœï¼Œæœ‰å¤‡é€‰æ–¹æ¡ˆ
```

**ğŸ”¹ å¼‚å¸¸å¤„ç†æœ€ä½³å®è·µ**ï¼š
```
å¤„ç†ç­–ç•¥ï¼š
â€¢ é¢„æœŸé”™è¯¯ï¼šä¼˜é›…å¤„ç†ï¼Œç»™å‡ºæ˜ç¡®æç¤º
â€¢ æ„å¤–é”™è¯¯ï¼šè®°å½•è¯¦ç»†æ—¥å¿—ï¼ŒåŠæ—¶é€šçŸ¥
â€¢ èµ„æºæ¸…ç†ï¼šç¡®ä¿æ¯æ¬¡éƒ½èƒ½æ­£ç¡®æ¸…ç†
â€¢ ç”¨æˆ·ä½“éªŒï¼šæä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯å’Œå»ºè®®
```

### 8.3 å®é™…åº”ç”¨å»ºè®®


**ğŸ¯ å…¥é—¨å»ºè®®**ï¼š
- ä»ç®€å•çš„è„šæœ¬å¼Pipelineå¼€å§‹ï¼Œé€æ­¥å¢åŠ å¤æ‚æ€§
- å¤šä½¿ç”¨echoè¯­å¥è¾“å‡ºè°ƒè¯•ä¿¡æ¯
- å……åˆ†åˆ©ç”¨Jenkinsçš„Blue Oceanç•Œé¢æŸ¥çœ‹æ‰§è¡Œæ•ˆæœ
- å‚è€ƒå®˜æ–¹æ–‡æ¡£å’Œç¤¾åŒºæœ€ä½³å®è·µ

**ğŸ”§ è¿›é˜¶æŠ€å·§**ï¼š
- å­¦ä¼šä½¿ç”¨Jenkinså…±äº«åº“æé«˜ä»£ç é‡ç”¨æ€§
- æŒæ¡Pipelineè¯­æ³•çš„è°ƒè¯•æŠ€å·§
- äº†è§£Jenkins REST APIè¿›è¡Œå¤–éƒ¨é›†æˆ
- å­¦ä¹ Pipelineå³ä»£ç (Pipeline as Code)çš„å®Œæ•´å®è·µ

**âš ï¸ å¸¸è§é™·é˜±**ï¼š
```
é¿å…é—®é¢˜ï¼š
âŒ ä¸è¦åœ¨Pipelineä¸­ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯
âŒ ä¸è¦å¿½ç•¥å¼‚å¸¸å¤„ç†å’Œèµ„æºæ¸…ç†
âŒ ä¸è¦è¿‡åº¦å¤æ‚åŒ–ï¼Œä¿æŒä»£ç å¯è¯»æ€§
âŒ ä¸è¦å¿˜è®°æµ‹è¯•Pipelineçš„å„ç§åˆ†æ”¯æƒ…å†µ
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- è„šæœ¬å¼Pipeline = node + stage + Groovyè¯­æ³•
- é€‰å¯¹èŠ‚ç‚¹äº‹åŠåŠŸå€ï¼Œå¼‚å¸¸å¤„ç†ä¿å¹³å®‰
- æµç¨‹æ§åˆ¶å¢çµæ´»ï¼Œå¹¶è¡Œæ‰§è¡Œææ•ˆç‡
- ä»£ç å³é…ç½®å¥½ç»´æŠ¤ï¼Œå›¢é˜Ÿåä½œæ›´è½»æ¾