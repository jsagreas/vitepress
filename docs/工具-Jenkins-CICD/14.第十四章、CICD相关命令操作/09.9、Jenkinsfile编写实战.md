---
title: 9ã€Jenkinsfileç¼–å†™å®æˆ˜
---
## ğŸ“š ç›®å½•

1. [Pipelineæµæ°´çº¿åŸºç¡€æ¦‚å¿µ](#1-Pipelineæµæ°´çº¿åŸºç¡€æ¦‚å¿µ)
2. [JenkinsfileåŸºç¡€è¯­æ³•ç»“æ„](#2-JenkinsfileåŸºç¡€è¯­æ³•ç»“æ„)
3. [Agenté…ç½®è¯¦è§£](#3-Agenté…ç½®è¯¦è§£)
4. [Stagesé˜¶æ®µè®¾è®¡ä¸å®ç°](#4-Stagesé˜¶æ®µè®¾è®¡ä¸å®ç°)
5. [Stepsæ­¥éª¤ç¼–å†™æŠ€å·§](#5-Stepsæ­¥éª¤ç¼–å†™æŠ€å·§)
6. [ç¯å¢ƒå˜é‡ç®¡ç†](#6-ç¯å¢ƒå˜é‡ç®¡ç†)
7. [æ¡ä»¶æ‰§è¡Œæ§åˆ¶](#7-æ¡ä»¶æ‰§è¡Œæ§åˆ¶)
8. [å¹¶è¡Œæ‰§è¡Œç­–ç•¥](#8-å¹¶è¡Œæ‰§è¡Œç­–ç•¥)
9. [é”™è¯¯å¤„ç†æœºåˆ¶](#9-é”™è¯¯å¤„ç†æœºåˆ¶)
10. [å®æˆ˜æ¡ˆä¾‹æ€»ç»“](#10-å®æˆ˜æ¡ˆä¾‹æ€»ç»“)

---

## 1. ğŸš€ Pipelineæµæ°´çº¿åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯Pipelineæµæ°´çº¿


**ğŸ”¸ ç®€å•ç†è§£**ï¼šPipelineå°±åƒå·¥å‚çš„ç”Ÿäº§æµæ°´çº¿ï¼ŒæŠŠè½¯ä»¶ä»ä»£ç å˜æˆæœ€ç»ˆäº§å“çš„æ•´ä¸ªè¿‡ç¨‹åˆ†æˆè‹¥å¹²ä¸ªæ­¥éª¤ï¼Œæ¯ä¸ªæ­¥éª¤æŒ‰é¡ºåºæ‰§è¡Œã€‚

```
ä¼ ç»Ÿæ‰‹å·¥æ–¹å¼ï¼š
å¼€å‘è€…å†™ä»£ç  â†’ æ‰‹åŠ¨æ‰“åŒ… â†’ æ‰‹åŠ¨æµ‹è¯• â†’ æ‰‹åŠ¨éƒ¨ç½² â†’ æ‰‹åŠ¨éªŒè¯

Pipelineè‡ªåŠ¨åŒ–æ–¹å¼ï¼š
ä»£ç æäº¤ â†’ è‡ªåŠ¨ç¼–è¯‘ â†’ è‡ªåŠ¨æµ‹è¯• â†’ è‡ªåŠ¨éƒ¨ç½² â†’ è‡ªåŠ¨éªŒè¯
```

**ğŸ’¡ æ ¸å¿ƒä»·å€¼**ï¼š
- **æ ‡å‡†åŒ–**ï¼šæ¯æ¬¡æ„å»ºéƒ½æŒ‰ç›¸åŒæµç¨‹æ‰§è¡Œ
- **å¯é‡å¤**ï¼šé¿å…äººä¸ºæ“ä½œå¤±è¯¯
- **å¯è¿½è¸ª**ï¼šæ¯ä¸ªæ­¥éª¤çš„æ‰§è¡Œç»“æœéƒ½æœ‰è®°å½•
- **é«˜æ•ˆç‡**ï¼šè‡ªåŠ¨åŒ–å‡å°‘äººå·¥å¹²é¢„æ—¶é—´

### 1.2 Jenkinsfileæ˜¯ä»€ä¹ˆ


**ğŸ”¸ æœ¬è´¨å®šä¹‰**ï¼šJenkinsfileæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œç”¨ä»£ç çš„æ–¹å¼æè¿°æ•´ä¸ªCI/CDæµç¨‹ã€‚

| **ä¼ ç»Ÿæ–¹å¼** | **Jenkinsfileæ–¹å¼** |
|-------------|-------------------|
| ğŸ–±ï¸ åœ¨Jenkinsç•Œé¢ç‚¹å‡»é…ç½® | ğŸ“ ç”¨ä»£ç ç¼–å†™æµç¨‹ |
| ğŸ“‹ é…ç½®ä¿å­˜åœ¨JenkinsæœåŠ¡å™¨ | ğŸ”„ é…ç½®è·Ÿéšä»£ç ç‰ˆæœ¬ç®¡ç† |
| ğŸ”§ ä¿®æ”¹éœ€è¦ç™»å½•Jenkins | âœï¸ ä¿®æ”¹åªéœ€ç¼–è¾‘æ–‡ä»¶ |
| ğŸ‘¥ éš¾ä»¥å›¢é˜Ÿåä½œ | ğŸ¤ å¯ä»¥å›¢é˜ŸReview |

**å…³é”®ä¼˜åŠ¿**ï¼š
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šPipelineé…ç½®å¯ä»¥åƒä»£ç ä¸€æ ·è¿›è¡Œç‰ˆæœ¬ç®¡ç†
- **ä»£ç å®¡æŸ¥**ï¼šå›¢é˜Ÿæˆå‘˜å¯ä»¥Review Pipelineçš„ä¿®æ”¹
- **åˆ†æ”¯æ”¯æŒ**ï¼šä¸åŒåˆ†æ”¯å¯ä»¥æœ‰ä¸åŒçš„æ„å»ºæµç¨‹

---

## 2. ğŸ“ JenkinsfileåŸºç¡€è¯­æ³•ç»“æ„


### 2.1 å£°æ˜å¼PipelineåŸºæœ¬ç»“æ„


```groovy
pipeline {
    agent any                    // åœ¨å“ªå°æœºå™¨ä¸Šæ‰§è¡Œ
    
    environment {               // ç¯å¢ƒå˜é‡å®šä¹‰
        MY_VAR = 'hello'
    }
    
    stages {                    // æ„å»ºé˜¶æ®µ
        stage('é˜¶æ®µ1') {
            steps {             // å…·ä½“æ‰§è¡Œæ­¥éª¤
                echo 'æ‰§è¡Œç¬¬ä¸€ä¸ªé˜¶æ®µ'
            }
        }
        
        stage('é˜¶æ®µ2') {
            steps {
                echo 'æ‰§è¡Œç¬¬äºŒä¸ªé˜¶æ®µ'
            }
        }
    }
    
    post {                      // åç½®æ“ä½œ
        always {
            echo 'æ„å»ºç»“æŸ'
        }
    }
}
```

**ğŸ”¸ ç»“æ„è¯´æ˜**ï¼š
- **pipeline**ï¼šæœ€å¤–å±‚å®¹å™¨ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªPipeline
- **agent**ï¼šæŒ‡å®šåœ¨å“ªå°æœºå™¨ä¸Šè¿è¡Œ
- **stages**ï¼šåŒ…å«æ‰€æœ‰æ„å»ºé˜¶æ®µ
- **stage**ï¼šå•ä¸ªæ„å»ºé˜¶æ®µ
- **steps**ï¼šå…·ä½“çš„æ‰§è¡Œæ­¥éª¤

### 2.2 è„šæœ¬å¼Pipelineç»“æ„


```groovy
node {                          // æŒ‡å®šè¿è¡ŒèŠ‚ç‚¹
    stage('æ£€å‡ºä»£ç ') {
        checkout scm
    }
    
    stage('ç¼–è¯‘') {
        sh 'mvn compile'
    }
    
    stage('æµ‹è¯•') {
        sh 'mvn test'
    }
}
```

**ğŸ“Š ä¸¤ç§è¯­æ³•å¯¹æ¯”**ï¼š

| **ç‰¹æ€§** | **å£°æ˜å¼Pipeline** | **è„šæœ¬å¼Pipeline** |
|---------|------------------|------------------|
| **å­¦ä¹ éš¾åº¦** | â­â­ å®¹æ˜“ | â­â­â­ è¾ƒéš¾ |
| **è¯­æ³•ä¸¥æ ¼æ€§** | ğŸ”’ ç»“æ„ä¸¥æ ¼ | ğŸ”“ çµæ´»è‡ªç”± |
| **é”™è¯¯æ£€æŸ¥** | âœ… è¯­æ³•æ£€æŸ¥å¼º | âš ï¸ è¿è¡Œæ—¶æ‰å‘ç° |
| **åŠŸèƒ½å®Œæ•´æ€§** | ğŸ“‹ åŠŸèƒ½å…¨é¢ | ğŸ”§ åŠŸèƒ½æ›´å¼ºå¤§ |

> ğŸ’¡ **æ–°æ‰‹å»ºè®®**ï¼šä¼˜å…ˆä½¿ç”¨å£°æ˜å¼Pipelineï¼Œè¯­æ³•ç®€å•ã€ç»“æ„æ¸…æ™°ã€ä¸å®¹æ˜“å‡ºé”™ã€‚

### 2.3 ç¬¬ä¸€ä¸ªå®Œæ•´ç¤ºä¾‹


```groovy
pipeline {
    agent any
    
    stages {
        stage('Hello World') {
            steps {
                echo 'Hello, Jenkins Pipeline!'
                echo "å½“å‰æ„å»ºå·: ${BUILD_NUMBER}"
                echo "å½“å‰æ—¶é—´: ${new Date()}"
            }
        }
    }
}
```

**ğŸ¯ æ‰§è¡Œæ•ˆæœ**ï¼š
```
[Pipeline] Start of Pipeline
[Pipeline] echo
Hello, Jenkins Pipeline!
[Pipeline] echo
å½“å‰æ„å»ºå·: 23
[Pipeline] echo  
å½“å‰æ—¶é—´: Mon Jan 21 10:30:15 CST 2025
[Pipeline] End of Pipeline
```

---

## 3. ğŸ–¥ï¸ Agenté…ç½®è¯¦è§£


### 3.1 AgentåŸºæœ¬æ¦‚å¿µ


**ğŸ”¸ ä»€ä¹ˆæ˜¯Agent**ï¼šAgentå°±æ˜¯æ‰§è¡Œæ„å»ºä»»åŠ¡çš„"å·¥äºº"ï¼Œå¯ä»¥æ˜¯Jenkinsä¸»èŠ‚ç‚¹ï¼Œä¹Ÿå¯ä»¥æ˜¯è¿æ¥çš„ä»èŠ‚ç‚¹ã€‚

**å¸¸è§Agentç±»å‹**ï¼š

```groovy
// 1. ä»»æ„å¯ç”¨èŠ‚ç‚¹
pipeline {
    agent any
    // åœ¨ä»»ä½•å¯ç”¨çš„èŠ‚ç‚¹ä¸Šæ‰§è¡Œ
}

// 2. æŒ‡å®šæ ‡ç­¾çš„èŠ‚ç‚¹
pipeline {
    agent {
        label 'linux && java'  // éœ€è¦æœ‰linuxå’Œjavaæ ‡ç­¾çš„èŠ‚ç‚¹
    }
}

// 3. Dockerå®¹å™¨ä¸­æ‰§è¡Œ
pipeline {
    agent {
        docker {
            image 'maven:3.8.1-jdk-8'  // åœ¨Mavenå®¹å™¨ä¸­æ‰§è¡Œ
        }
    }
}

// 4. ä¸æŒ‡å®šå…¨å±€agent
pipeline {
    agent none  // æ¯ä¸ªstageå•ç‹¬æŒ‡å®š
    
    stages {
        stage('åœ¨Dockerä¸­æ‰§è¡Œ') {
            agent {
                docker 'node:16'
            }
            steps {
                sh 'node --version'
            }
        }
    }
}
```

### 3.2 å®ç”¨Agenté…ç½®æŠ€å·§


**ğŸ”§ åœºæ™¯åŒ–é…ç½®**ï¼š

```groovy
pipeline {
    agent none  // ä¸åŒé˜¶æ®µä½¿ç”¨ä¸åŒç¯å¢ƒ
    
    stages {
        stage('ä»£ç æ£€æŸ¥') {
            agent {
                docker {
                    image 'sonarlint/sonarlint-cli'
                    args '-v /tmp:/tmp'  // æŒ‚è½½ä¸´æ—¶ç›®å½•
                }
            }
            steps {
                echo 'æ‰§è¡Œä»£ç è´¨é‡æ£€æŸ¥'
            }
        }
        
        stage('ç¼–è¯‘æµ‹è¯•') {
            agent {
                label 'build-server'  // åœ¨ä¸“é—¨çš„æ„å»ºæœåŠ¡å™¨æ‰§è¡Œ
            }
            steps {
                echo 'æ‰§è¡Œç¼–è¯‘å’Œæµ‹è¯•'
            }
        }
    }
}
```

**âš¡ Agenté€‰æ‹©ç­–ç•¥**ï¼š

| **ä½¿ç”¨åœºæ™¯** | **æ¨èé…ç½®** | **ä¼˜åŠ¿** |
|-------------|-------------|---------|
| **ç®€å•é¡¹ç›®** | `agent any` | ğŸš€ å¿«é€Ÿå¼€å§‹ï¼Œæ— éœ€å¤æ‚é…ç½® |
| **å¤šè¯­è¨€é¡¹ç›®** | `agent none` + åˆ†stage | ğŸ”§ ä¸åŒè¯­è¨€ç”¨ä¸åŒç¯å¢ƒ |
| **èµ„æºéš”ç¦»** | `docker agent` | ğŸ”’ ç¯å¢ƒéš”ç¦»ï¼Œé¿å…æ±¡æŸ“ |
| **æ€§èƒ½è¦æ±‚é«˜** | `label 'high-performance'` | âš¡ ä½¿ç”¨é«˜æ€§èƒ½ä¸“ç”¨èŠ‚ç‚¹ |

---

## 4. ğŸ—ï¸ Stagesé˜¶æ®µè®¾è®¡ä¸å®ç°


### 4.1 Stageè®¾è®¡åŸåˆ™


**ğŸ¯ å•ä¸€èŒè´£åŸåˆ™**ï¼šæ¯ä¸ªstageåªåšä¸€ä»¶äº‹æƒ…ï¼ŒèŒè´£æ˜ç¡®ã€‚

```
âŒ ä¸å¥½çš„è®¾è®¡ï¼š
stage('æ„å»ºå’Œéƒ¨ç½²') {
    // æ—¢ç¼–è¯‘åˆéƒ¨ç½²ï¼ŒèŒè´£ä¸æ¸…æ™°
}

âœ… å¥½çš„è®¾è®¡ï¼š
stage('ç¼–è¯‘') { ... }
stage('æµ‹è¯•') { ... }  
stage('éƒ¨ç½²') { ... }
```

**ğŸ“‹ å…¸å‹çš„Stageæµç¨‹**ï¼š

```groovy
pipeline {
    agent any
    
    stages {
        stage('ğŸ“¥ æ£€å‡ºä»£ç ') {
            steps {
                checkout scm
                echo 'ä»£ç æ£€å‡ºå®Œæˆ'
            }
        }
        
        stage('ğŸ”§ ç¯å¢ƒå‡†å¤‡') {
            steps {
                sh 'java -version'
                sh 'mvn -version'
                echo 'ç¯å¢ƒæ£€æŸ¥å®Œæˆ'
            }
        }
        
        stage('ğŸ—ï¸ ç¼–è¯‘æ„å»º') {
            steps {
                sh 'mvn clean compile'
                echo 'ç¼–è¯‘å®Œæˆ'
            }
        }
        
        stage('ğŸ§ª å•å…ƒæµ‹è¯•') {
            steps {
                sh 'mvn test'
                echo 'æµ‹è¯•å®Œæˆ'
            }
        }
        
        stage('ğŸ“¦ æ‰“åŒ…') {
            steps {
                sh 'mvn package -DskipTests'
                echo 'æ‰“åŒ…å®Œæˆ'
            }
        }
        
        stage('ğŸš€ éƒ¨ç½²') {
            steps {
                echo 'éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ'
                // éƒ¨ç½²è„šæœ¬
            }
        }
    }
}
```

### 4.2 Stageçš„é«˜çº§ç‰¹æ€§


**ğŸ”„ æ¡ä»¶æ‰§è¡Œ**ï¼š

```groovy
stage('ç”Ÿäº§éƒ¨ç½²') {
    when {
        branch 'main'  // åªæœ‰mainåˆ†æ”¯æ‰æ‰§è¡Œ
    }
    steps {
        echo 'éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ'
    }
}

stage('å‘é€é€šçŸ¥') {
    when {
        anyOf {
            changeset "**/*.java"     // Javaæ–‡ä»¶æœ‰å˜åŒ–
            changeset "**/*.properties"  // é…ç½®æ–‡ä»¶æœ‰å˜åŒ–
        }
    }
    steps {
        echo 'å‘é€ä»£ç å˜æ›´é€šçŸ¥'
    }
}
```

**â±ï¸ è¶…æ—¶æ§åˆ¶**ï¼š

```groovy
stage('é•¿æ—¶é—´ä»»åŠ¡') {
    options {
        timeout(time: 10, unit: 'MINUTES')  // 10åˆ†é’Ÿè¶…æ—¶
    }
    steps {
        sh 'sleep 300'  // æ¨¡æ‹Ÿè€—æ—¶ä»»åŠ¡
    }
}
```

---

## 5. ğŸ”¨ Stepsæ­¥éª¤ç¼–å†™æŠ€å·§


### 5.1 å¸¸ç”¨Stepsç±»å‹


**ğŸ“ åŸºç¡€è¾“å‡º**ï¼š
```groovy
steps {
    echo 'Hello World'                    // æ™®é€šè¾“å‡º
    echo "æ„å»ºå·: ${BUILD_NUMBER}"         // ä½¿ç”¨å˜é‡
    sh 'echo "åœ¨Shellä¸­æ‰§è¡Œ"'              // Shellå‘½ä»¤
    bat 'echo "åœ¨Windowsä¸­æ‰§è¡Œ"'           // Windowså‘½ä»¤
}
```

**ğŸ“ æ–‡ä»¶æ“ä½œ**ï¼š
```groovy
steps {
    // å†™å…¥æ–‡ä»¶
    writeFile file: 'version.txt', text: "${BUILD_NUMBER}"
    
    // è¯»å–æ–‡ä»¶
    script {
        def version = readFile 'version.txt'
        echo "ç‰ˆæœ¬å·: ${version}"
    }
    
    // å¤åˆ¶æ–‡ä»¶
    sh 'cp target/*.jar /deploy/'
    
    // åˆ é™¤æ–‡ä»¶
    sh 'rm -rf target/'
}
```

**ğŸ” æ¡ä»¶åˆ¤æ–­**ï¼š
```groovy
steps {
    script {
        if (env.BRANCH_NAME == 'main') {
            echo 'è¿™æ˜¯ä¸»åˆ†æ”¯'
        } else {
            echo 'è¿™æ˜¯åŠŸèƒ½åˆ†æ”¯'
        }
        
        // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
        if (fileExists('pom.xml')) {
            echo 'è¿™æ˜¯Mavené¡¹ç›®'
            sh 'mvn clean package'
        } else if (fileExists('package.json')) {
            echo 'è¿™æ˜¯Node.jsé¡¹ç›®'
            sh 'npm install && npm run build'
        }
    }
}
```

### 5.2 é”™è¯¯å¤„ç†å’Œé‡è¯•


**ğŸ”„ é‡è¯•æœºåˆ¶**ï¼š
```groovy
steps {
    retry(3) {  // å¤±è´¥æ—¶é‡è¯•3æ¬¡
        sh 'curl -f https://api.example.com/health'
    }
    
    // å¸¦è¶…æ—¶çš„é‡è¯•
    timeout(time: 5, unit: 'MINUTES') {
        retry(3) {
            sh 'mvn test'
        }
    }
}
```

**ğŸ›¡ï¸ å¼‚å¸¸æ•è·**ï¼š
```groovy
steps {
    script {
        try {
            sh 'mvn test'
            echo 'æµ‹è¯•æˆåŠŸ'
        } catch (Exception e) {
            echo "æµ‹è¯•å¤±è´¥: ${e.getMessage()}"
            currentBuild.result = 'UNSTABLE'  // æ ‡è®°ä¸ºä¸ç¨³å®š
        }
    }
}
```

---

## 6. ğŸŒ ç¯å¢ƒå˜é‡ç®¡ç†


### 6.1 ç¯å¢ƒå˜é‡å®šä¹‰æ–¹å¼


**ğŸ”§ å…¨å±€ç¯å¢ƒå˜é‡**ï¼š
```groovy
pipeline {
    agent any
    
    environment {
        APP_NAME = 'my-application'
        VERSION = '1.0.0'
        DEPLOY_ENV = 'staging'
        
        // ä½¿ç”¨Jenkinså†…ç½®å˜é‡
        BUILD_INFO = "${JOB_NAME}-${BUILD_NUMBER}"
    }
    
    stages {
        stage('æ˜¾ç¤ºç¯å¢ƒä¿¡æ¯') {
            steps {
                echo "åº”ç”¨åç§°: ${APP_NAME}"
                echo "ç‰ˆæœ¬: ${VERSION}"
                echo "æ„å»ºä¿¡æ¯: ${BUILD_INFO}"
            }
        }
    }
}
```

**ğŸ¯ é˜¶æ®µçº§ç¯å¢ƒå˜é‡**ï¼š
```groovy
stages {
    stage('å¼€å‘ç¯å¢ƒéƒ¨ç½²') {
        environment {
            DB_URL = 'jdbc:mysql://dev-db:3306/myapp'
            API_KEY = credentials('dev-api-key')  // ä½¿ç”¨å‡­è¯
        }
        steps {
            echo "è¿æ¥æ•°æ®åº“: ${DB_URL}"
            sh 'deploy.sh dev'
        }
    }
    
    stage('ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²') {
        environment {
            DB_URL = 'jdbc:mysql://prod-db:3306/myapp'
            API_KEY = credentials('prod-api-key')
        }
        steps {
            echo "è¿æ¥æ•°æ®åº“: ${DB_URL}"
            sh 'deploy.sh prod'
        }
    }
}
```

### 6.2 åŠ¨æ€ç¯å¢ƒå˜é‡


**ğŸ“Š è®¡ç®—å¾—å‡ºçš„å˜é‡**ï¼š
```groovy
pipeline {
    agent any
    
    environment {
        // é™æ€å˜é‡
        APP_NAME = 'my-app'
    }
    
    stages {
        stage('ç”ŸæˆåŠ¨æ€å˜é‡') {
            steps {
                script {
                    // åŠ¨æ€ç”Ÿæˆç‰ˆæœ¬å·
                    env.BUILD_VERSION = "${APP_NAME}-${BUILD_NUMBER}-${new Date().format('yyyyMMdd')}"
                    
                    // æ ¹æ®åˆ†æ”¯è®¾ç½®ç¯å¢ƒ
                    if (env.BRANCH_NAME == 'main') {
                        env.DEPLOY_TARGET = 'production'
                    } else {
                        env.DEPLOY_TARGET = 'staging'
                    }
                    
                    echo "æ„å»ºç‰ˆæœ¬: ${env.BUILD_VERSION}"
                    echo "éƒ¨ç½²ç›®æ ‡: ${env.DEPLOY_TARGET}"
                }
            }
        }
    }
}
```

### 6.3 æ•æ„Ÿä¿¡æ¯ç®¡ç†


**ğŸ” ä½¿ç”¨Jenkinså‡­è¯**ï¼š

```groovy
environment {
    // ç”¨æˆ·åå¯†ç ç±»å‹å‡­è¯
    DB_CREDENTIALS = credentials('database-credentials')
    
    // ç§˜é’¥æ–‡ä»¶ç±»å‹å‡­è¯  
    SSH_KEY = credentials('ssh-private-key')
    
    // çº¯æ–‡æœ¬ç§˜é’¥ç±»å‹å‡­è¯
    API_TOKEN = credentials('api-token')
}

stages {
    stage('ä½¿ç”¨å‡­è¯') {
        steps {
            // ç”¨æˆ·åå¯†ç ä¼šè‡ªåŠ¨åˆ†è§£ä¸ºä¸¤ä¸ªå˜é‡
            echo "æ•°æ®åº“ç”¨æˆ·: ${DB_CREDENTIALS_USR}"
            // å¯†ç ä¸ä¼šåœ¨æ—¥å¿—ä¸­æ˜¾ç¤ºï¼Œæ˜¾ç¤ºä¸º ****
            sh 'mysql -u ${DB_CREDENTIALS_USR} -p${DB_CREDENTIALS_PSW} -e "show databases;"'
            
            // ä½¿ç”¨API Token
            sh 'curl -H "Authorization: Bearer ${API_TOKEN}" https://api.example.com'
        }
    }
}
```

> âš ï¸ **å®‰å…¨æé†’**ï¼šæ•æ„Ÿä¿¡æ¯ç»å¯¹ä¸è¦ç¡¬ç¼–ç åœ¨Jenkinsfileä¸­ï¼Œå¿…é¡»ä½¿ç”¨Jenkinså‡­è¯ç®¡ç†åŠŸèƒ½ã€‚

---

## 7. ğŸ›ï¸ æ¡ä»¶æ‰§è¡Œæ§åˆ¶


### 7.1 Whenæ¡ä»¶è¯­å¥


**ğŸ” åˆ†æ”¯æ¡ä»¶**ï¼š
```groovy
stage('ç”Ÿäº§éƒ¨ç½²') {
    when {
        branch 'main'  // åªåœ¨mainåˆ†æ”¯æ‰§è¡Œ
    }
    steps {
        echo 'éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ'
    }
}

stage('åŠŸèƒ½æµ‹è¯•') {
    when {
        not { branch 'main' }  // émainåˆ†æ”¯æ‰§è¡Œ
    }
    steps {
        echo 'æ‰§è¡ŒåŠŸèƒ½æµ‹è¯•'
    }
}

// å¤šåˆ†æ”¯æ¡ä»¶
stage('é¢„å‘å¸ƒæµ‹è¯•') {
    when {
        anyOf {
            branch 'main'
            branch 'release/*'
        }
    }
    steps {
        echo 'æ‰§è¡Œé¢„å‘å¸ƒæµ‹è¯•'
    }
}
```

**ğŸ“ æ–‡ä»¶å˜æ›´æ¡ä»¶**ï¼š
```groovy
stage('å‰ç«¯æ„å»º') {
    when {
        changeset "frontend/**/*"  // å‰ç«¯æ–‡ä»¶æœ‰å˜åŒ–æ—¶æ‰§è¡Œ
    }
    steps {
        dir('frontend') {
            sh 'npm install'
            sh 'npm run build'
        }
    }
}

stage('åç«¯æ„å»º') {
    when {
        changeset "backend/**/*"   // åç«¯æ–‡ä»¶æœ‰å˜åŒ–æ—¶æ‰§è¡Œ
    }
    steps {
        dir('backend') {
            sh 'mvn clean package'
        }
    }
}
```

**ğŸ·ï¸ æ ‡ç­¾å’Œç¯å¢ƒæ¡ä»¶**ï¼š
```groovy
stage('æ€§èƒ½æµ‹è¯•') {
    when {
        allOf {
            branch 'main'
            environment name: 'ENABLE_PERF_TEST', value: 'true'
        }
    }
    steps {
        echo 'æ‰§è¡Œæ€§èƒ½æµ‹è¯•'
    }
}

stage('æ ‡ç­¾å‘å¸ƒ') {
    when {
        tag pattern: "v\\d+\\.\\d+\\.\\d+", comparator: "REGEXP"
    }
    steps {
        echo "å‘å¸ƒç‰ˆæœ¬: ${TAG_NAME}"
    }
}
```

### 7.2 å¤æ‚æ¡ä»¶ç»„åˆ


**ğŸ”— é€»è¾‘ç»„åˆ**ï¼š
```groovy
stage('å¤æ‚æ¡ä»¶ç¤ºä¾‹') {
    when {
        allOf {  // æ‰€æœ‰æ¡ä»¶éƒ½æ»¡è¶³
            anyOf {  // æ»¡è¶³å…¶ä¸­ä»»ä¸€æ¡ä»¶
                branch 'main'
                branch 'develop'
            }
            not {  // ä¸æ»¡è¶³è¿™ä¸ªæ¡ä»¶
                changeset "docs/**/*"
            }
            environment name: 'DEPLOY_ENABLED', value: 'true'
        }
    }
    steps {
        echo 'æ‰§è¡Œå¤æ‚æ¡ä»¶éƒ¨ç½²'
    }
}
```

**â° æ—¶é—´æ¡ä»¶**ï¼š
```groovy
stage('å¤œé—´ä»»åŠ¡') {
    when {
        // è‡ªå®šä¹‰æ¡ä»¶
        expression {
            return new Date().hours >= 22 || new Date().hours <= 6
        }
    }
    steps {
        echo 'æ‰§è¡Œå¤œé—´ç»´æŠ¤ä»»åŠ¡'
    }
}
```

---

## 8. âš¡ å¹¶è¡Œæ‰§è¡Œç­–ç•¥


### 8.1 åŸºç¡€å¹¶è¡Œæ‰§è¡Œ


**ğŸš€ ç®€å•å¹¶è¡Œ**ï¼š
```groovy
stage('å¹¶è¡Œæµ‹è¯•') {
    parallel {
        stage('å•å…ƒæµ‹è¯•') {
            steps {
                sh 'mvn test'
                echo 'å•å…ƒæµ‹è¯•å®Œæˆ'
            }
        }
        
        stage('é›†æˆæµ‹è¯•') {
            steps {
                sh 'mvn integration-test'
                echo 'é›†æˆæµ‹è¯•å®Œæˆ'
            }
        }
        
        stage('ä»£ç æ£€æŸ¥') {
            steps {
                sh 'mvn checkstyle:check'
                echo 'ä»£ç æ£€æŸ¥å®Œæˆ'
            }
        }
    }
}
```

**ğŸ”§ ä¸åŒç¯å¢ƒå¹¶è¡Œ**ï¼š
```groovy
stage('å¤šç¯å¢ƒéƒ¨ç½²') {
    parallel {
        stage('éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ') {
            agent { label 'test-server' }
            steps {
                sh 'deploy.sh test'
                echo 'æµ‹è¯•ç¯å¢ƒéƒ¨ç½²å®Œæˆ'
            }
        }
        
        stage('éƒ¨ç½²åˆ°é¢„å‘ç¯å¢ƒ') {
            agent { label 'staging-server' }
            steps {
                sh 'deploy.sh staging'
                echo 'é¢„å‘ç¯å¢ƒéƒ¨ç½²å®Œæˆ'
            }
        }
    }
}
```

### 8.2 åŠ¨æ€å¹¶è¡Œæ‰§è¡Œ


**ğŸ“Š åŸºäºæ•°æ®çš„å¹¶è¡Œ**ï¼š
```groovy
stage('å¤šç‰ˆæœ¬æ„å»º') {
    steps {
        script {
            def versions = ['java8', 'java11', 'java17']
            def parallelStages = [:]
            
            for (version in versions) {
                def currentVersion = version  // é‡è¦ï¼šé¿å…é—­åŒ…é—®é¢˜
                parallelStages["æ„å»º-${currentVersion}"] = {
                    node {
                        echo "ä½¿ç”¨ ${currentVersion} æ„å»º"
                        sh "docker build -t myapp:${currentVersion} --build-arg JAVA_VERSION=${currentVersion} ."
                    }
                }
            }
            
            parallel parallelStages
        }
    }
}
```

### 8.3 å¹¶è¡Œæ‰§è¡Œçš„æ³¨æ„äº‹é¡¹


**âš ï¸ èµ„æºç«äº‰é˜²æŠ¤**ï¼š
```groovy
stage('å®‰å…¨çš„å¹¶è¡Œæ‰§è¡Œ') {
    parallel {
        stage('æ•°æ®åº“è¿ç§»') {
            options {
                lock('database-migration')  // ä½¿ç”¨é”é˜²æ­¢å†²çª
            }
            steps {
                sh 'flyway migrate'
            }
        }
        
        stage('ç¼“å­˜é¢„çƒ­') {
            steps {
                sh 'warm-up-cache.sh'
            }
        }
    }
}
```

**ğŸ“ˆ å¹¶è¡Œæ‰§è¡Œæ•ˆæœå¯¹æ¯”**ï¼š

| **æ‰§è¡Œæ–¹å¼** | **æ€»è€—æ—¶** | **èµ„æºåˆ©ç”¨ç‡** | **é€‚ç”¨åœºæ™¯** |
|-------------|-----------|---------------|-------------|
| **ä¸²è¡Œæ‰§è¡Œ** | ğŸŒ 15åˆ†é’Ÿ | ğŸ“Š 50% | ä»»åŠ¡é—´æœ‰ä¾èµ–å…³ç³» |
| **å¹¶è¡Œæ‰§è¡Œ** | âš¡ 8åˆ†é’Ÿ | ğŸ“ˆ 85% | ç‹¬ç«‹ä»»åŠ¡ï¼Œèµ„æºå……è¶³ |

---

## 9. ğŸ›¡ï¸ é”™è¯¯å¤„ç†æœºåˆ¶


### 9.1 Postæ‰§è¡Œå—


**ğŸ”„ æ‰§è¡Œæ—¶æœºæ§åˆ¶**ï¼š
```groovy
pipeline {
    agent any
    
    stages {
        stage('æ„å»º') {
            steps {
                sh 'mvn clean package'
            }
        }
    }
    
    post {
        always {
            echo 'æ— è®ºæˆåŠŸå¤±è´¥éƒ½ä¼šæ‰§è¡Œ'
            // æ¸…ç†å·¥ä½œç©ºé—´
            cleanWs()
        }
        
        success {
            echo 'æ„å»ºæˆåŠŸæ—¶æ‰§è¡Œ'
            // å‘é€æˆåŠŸé€šçŸ¥
            mail to: 'team@company.com',
                 subject: "æ„å»ºæˆåŠŸ: ${JOB_NAME} - ${BUILD_NUMBER}",
                 body: "æ„å»ºæˆåŠŸå®Œæˆ"
        }
        
        failure {
            echo 'æ„å»ºå¤±è´¥æ—¶æ‰§è¡Œ'
            // å‘é€å¤±è´¥é€šçŸ¥
            mail to: 'team@company.com',
                 subject: "âš ï¸ æ„å»ºå¤±è´¥: ${JOB_NAME} - ${BUILD_NUMBER}",
                 body: "æ„å»ºå¤±è´¥ï¼Œè¯·æ£€æŸ¥æ—¥å¿—"
        }
        
        unstable {
            echo 'æ„å»ºä¸ç¨³å®šæ—¶æ‰§è¡Œï¼ˆå¦‚æµ‹è¯•å¤±è´¥ä½†ç¼–è¯‘æˆåŠŸï¼‰'
        }
        
        changed {
            echo 'æ„å»ºçŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶æ‰§è¡Œ'
        }
    }
}
```

### 9.2 Try-Catché”™è¯¯å¤„ç†


**ğŸ¯ ç²¾ç¡®é”™è¯¯æ§åˆ¶**ï¼š
```groovy
stage('å®¹é”™å¤„ç†') {
    steps {
        script {
            try {
                sh 'mvn test'
                echo 'æµ‹è¯•é€šè¿‡'
            } catch (Exception e) {
                echo "æµ‹è¯•å¤±è´¥ï¼Œä½†ç»§ç»­æ„å»º: ${e.getMessage()}"
                currentBuild.result = 'UNSTABLE'
                
                // å¯ä»¥é€‰æ‹©æ€§æ‰§è¡Œä¸€äº›è¡¥æ•‘æªæ–½
                sh 'echo "æ‰§è¡Œæµ‹è¯•å¤±è´¥çš„åç»­å¤„ç†"'
            } finally {
                echo 'æ— è®ºæˆåŠŸå¤±è´¥éƒ½ä¼šæ‰§è¡Œçš„æ¸…ç†å·¥ä½œ'
                publishTestResults testResultsPattern: 'target/surefire-reports/*.xml'
            }
        }
    }
}
```

### 9.3 è¶…æ—¶å’Œé‡è¯•ç­–ç•¥


**â±ï¸ è¶…æ—¶å¤„ç†**ï¼š
```groovy
pipeline {
    agent any
    
    options {
        timeout(time: 30, unit: 'MINUTES')  // æ•´ä¸ªPipelineè¶…æ—¶
    }
    
    stages {
        stage('å¯èƒ½å¾ˆæ…¢çš„ä»»åŠ¡') {
            options {
                timeout(time: 10, unit: 'MINUTES')  // å•ä¸ªStageè¶…æ—¶
            }
            steps {
                retry(3) {  // é‡è¯•3æ¬¡
                    timeout(time: 3, unit: 'MINUTES') {  // æ¯æ¬¡å°è¯•3åˆ†é’Ÿè¶…æ—¶
                        sh 'slow-command.sh'
                    }
                }
            }
        }
    }
}
```

**ğŸ”„ æ™ºèƒ½é‡è¯•**ï¼š
```groovy
stage('æ™ºèƒ½é‡è¯•') {
    steps {
        script {
            def maxRetries = 3
            def currentRetry = 0
            def success = false
            
            while (currentRetry < maxRetries && !success) {
                try {
                    currentRetry++
                    echo "ç¬¬ ${currentRetry} æ¬¡å°è¯•"
                    
                    sh 'unstable-service-call.sh'
                    success = true
                    echo 'æ“ä½œæˆåŠŸ'
                    
                } catch (Exception e) {
                    echo "ç¬¬ ${currentRetry} æ¬¡å°è¯•å¤±è´¥: ${e.getMessage()}"
                    
                    if (currentRetry < maxRetries) {
                        echo "ç­‰å¾… ${currentRetry * 10} ç§’åé‡è¯•..."
                        sleep(currentRetry * 10)  // é€’å¢ç­‰å¾…æ—¶é—´
                    } else {
                        throw e  // æœ€åä¸€æ¬¡å°è¯•å¤±è´¥ï¼ŒæŠ›å‡ºå¼‚å¸¸
                    }
                }
            }
        }
    }
}
```

---

## 10. ğŸ“ å®æˆ˜æ¡ˆä¾‹æ€»ç»“


### 10.1 å®Œæ•´çš„Java Webé¡¹ç›®Pipeline


```groovy
pipeline {
    agent any
    
    environment {
        APP_NAME = 'my-web-app'
        REGISTRY = 'harbor.company.com'
        MAVEN_OPTS = '-Xmx1024m'
    }
    
    options {
        buildDiscarder(logRotator(numToKeepStr: '10'))  // ä¿ç•™10ä¸ªæ„å»ºå†å²
        timeout(time: 45, unit: 'MINUTES')
        skipStagesAfterUnstable()  // ä¸ç¨³å®šåè·³è¿‡åç»­é˜¶æ®µ
    }
    
    stages {
        stage('ğŸ“¥ ä»£ç æ£€å‡º') {
            steps {
                checkout scm
                script {
                    env.GIT_COMMIT_SHORT = sh(
                        script: 'git rev-parse --short HEAD',
                        returnStdout: true
                    ).trim()
                    env.BUILD_VERSION = "${APP_NAME}-${BUILD_NUMBER}-${GIT_COMMIT_SHORT}"
                }
            }
        }
        
        stage('ğŸ” ä»£ç æ£€æŸ¥') {
            parallel {
                stage('è¯­æ³•æ£€æŸ¥') {
                    steps {
                        sh 'mvn checkstyle:check'
                    }
                }
                
                stage('å®‰å…¨æ‰«æ') {
                    steps {
                        sh 'mvn org.owasp:dependency-check-maven:check'
                    }
                }
            }
        }
        
        stage('ğŸ—ï¸ ç¼–è¯‘æ„å»º') {
            steps {
                sh 'mvn clean compile'
            }
        }
        
        stage('ğŸ§ª æµ‹è¯•') {
            parallel {
                stage('å•å…ƒæµ‹è¯•') {
                    steps {
                        sh 'mvn test'
                    }
                    post {
                        always {
                            publishTestResults testResultsPattern: 'target/surefire-reports/*.xml'
                            publishCoverage adapters: [jacocoAdapter('target/site/jacoco/jacoco.xml')]
                        }
                    }
                }
                
                stage('é›†æˆæµ‹è¯•') {
                    steps {
                        sh 'mvn integration-test'
                    }
                }
            }
        }
        
        stage('ğŸ“¦ æ‰“åŒ…') {
            steps {
                sh 'mvn package -DskipTests'
                archiveArtifacts artifacts: 'target/*.jar', fingerprint: true
            }
        }
        
        stage('ğŸ³ Dockeræ„å»º') {
            when {
                anyOf {
                    branch 'main'
                    branch 'develop'
                }
            }
            steps {
                script {
                    def image = docker.build("${REGISTRY}/${APP_NAME}:${BUILD_VERSION}")
                    docker.withRegistry("https://${REGISTRY}", 'harbor-credentials') {
                        image.push()
                        image.push('latest')
                    }
                }
            }
        }
        
        stage('ğŸš€ éƒ¨ç½²') {
            when {
                branch 'main'
            }
            steps {
                script {
                    def deployEnv = env.BRANCH_NAME == 'main' ? 'production' : 'staging'
                    sh "kubectl set image deployment/${APP_NAME} ${APP_NAME}=${REGISTRY}/${APP_NAME}:${BUILD_VERSION}"
                    sh "kubectl rollout status deployment/${APP_NAME} --timeout=300s"
                }
            }
        }
    }
    
    post {
        always {
            cleanWs()  // æ¸…ç†å·¥ä½œç©ºé—´
        }
        
        success {
            script {
                if (env.BRANCH_NAME == 'main') {
                    slackSend(
                        channel: '#deployments',
                        color: 'good',
                        message: "âœ… ç”Ÿäº§éƒ¨ç½²æˆåŠŸ: ${APP_NAME} v${BUILD_VERSION}"
                    )
                }
            }
        }
        
        failure {
            slackSend(
                channel: '#alerts',
                color: 'danger',
                message: "âŒ æ„å»ºå¤±è´¥: ${JOB_NAME} - ${BUILD_NUMBER}\næŸ¥çœ‹æ—¥å¿—: ${BUILD_URL}"
            )
        }
    }
}
```

### 10.2 Pipelineæœ€ä½³å®è·µ


**âœ… æ¨èåšæ³•**ï¼š

- [x] **ç‰ˆæœ¬æ§åˆ¶**ï¼šJenkinsfileæ”¾åœ¨ä»£ç ä»“åº“ä¸­
- [x] **å®‰å…¨ç¬¬ä¸€**ï¼šæ•æ„Ÿä¿¡æ¯ä½¿ç”¨å‡­è¯ç®¡ç†
- [x] **å¿«é€Ÿåé¦ˆ**ï¼šæŠŠå¿«é€Ÿå¤±è´¥çš„æ­¥éª¤æ”¾å‰é¢
- [x] **å¹¶è¡Œä¼˜åŒ–**ï¼šç‹¬ç«‹ä»»åŠ¡å°½é‡å¹¶è¡Œæ‰§è¡Œ
- [x] **èµ„æºæ¸…ç†**ï¼šä½¿ç”¨postå—åšæ¸…ç†å·¥ä½œ
- [x] **é€šçŸ¥æœºåˆ¶**ï¼šåŠæ—¶é€šçŸ¥æ„å»ºç»“æœ
- [x] **æ—¥å¿—è®°å½•**ï¼šå…³é”®æ­¥éª¤æ·»åŠ echoè¾“å‡º

**âŒ é¿å…åšæ³•**ï¼š

- [ ] ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯
- [ ] è¿‡äºå¤æ‚çš„å•ä¸ªStage
- [ ] å¿½ç•¥é”™è¯¯å¤„ç†
- [ ] ä¸æ¸…ç†ä¸´æ—¶æ–‡ä»¶
- [ ] ç¼ºä¹é€‚å½“çš„è¶…æ—¶è®¾ç½®

### 10.3 æ€§èƒ½ä¼˜åŒ–æŠ€å·§


**âš¡ æ„å»ºæé€Ÿç­–ç•¥**ï¼š

```groovy
// 1. ä½¿ç”¨æ„å»ºç¼“å­˜
pipeline {
    agent {
        docker {
            image 'maven:3.8.1-jdk-11'
            args '-v /tmp/maven-repo:/root/.m2/repository'  // ç¼“å­˜Mavenä¾èµ–
        }
    }
}

// 2. æ¡ä»¶è·³è¿‡ä¸å¿…è¦çš„æ­¥éª¤
stage('å‰ç«¯æ„å»º') {
    when {
        changeset "frontend/**/*"  // åªæœ‰å‰ç«¯æ–‡ä»¶å˜åŒ–æ‰æ„å»º
    }
}

// 3. ä½¿ç”¨å¹¶è¡Œæ‰§è¡Œ
parallel {
    stage('åç«¯æµ‹è¯•') { ... }
    stage('å‰ç«¯æµ‹è¯•') { ... }
    stage('ä»£ç æ£€æŸ¥') { ... }
}
```

**ğŸ“Š æ€§èƒ½ç›‘æ§**ï¼š

| **ä¼˜åŒ–é¡¹** | **ä¼˜åŒ–å‰** | **ä¼˜åŒ–å** | **æå‡** |
|-----------|-----------|-----------|---------|
| æ€»æ„å»ºæ—¶é—´ | ğŸŒ 25åˆ†é’Ÿ | âš¡ 12åˆ†é’Ÿ | ğŸ“ˆ 52% |
| æµ‹è¯•é˜¶æ®µ | ğŸŒ 15åˆ†é’Ÿ | âš¡ 6åˆ†é’Ÿ | ğŸ“ˆ 60% |
| éƒ¨ç½²é˜¶æ®µ | ğŸŒ 8åˆ†é’Ÿ | âš¡ 4åˆ†é’Ÿ | ğŸ“ˆ 50% |

---

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Pipelineæµæ°´çº¿ï¼šè‡ªåŠ¨åŒ–çš„è½¯ä»¶äº¤ä»˜æµç¨‹
ğŸ”¸ Jenkinsfileï¼šç”¨ä»£ç æè¿°Pipelineçš„æ–‡æœ¬æ–‡ä»¶
ğŸ”¸ Agentï¼šæ‰§è¡Œæ„å»ºä»»åŠ¡çš„èŠ‚ç‚¹æˆ–å®¹å™¨
ğŸ”¸ Stagesï¼šæ„å»ºè¿‡ç¨‹çš„é€»è¾‘é˜¶æ®µåˆ’åˆ†
ğŸ”¸ Stepsï¼šå…·ä½“çš„æ‰§è¡Œæ­¥éª¤å’Œå‘½ä»¤
ğŸ”¸ Environmentï¼šç¯å¢ƒå˜é‡çš„å®šä¹‰å’Œä½¿ç”¨
ğŸ”¸ Whenæ¡ä»¶ï¼šæ§åˆ¶Stageçš„æ‰§è¡Œæ¡ä»¶
ğŸ”¸ Parallelï¼šå¹¶è¡Œæ‰§è¡Œæé«˜æ•ˆç‡
ğŸ”¸ Postå—ï¼šæ„å»ºåçš„æ¸…ç†å’Œé€šçŸ¥
```

### å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆè¦ç”¨Pipeline**ï¼š
- **æ ‡å‡†åŒ–**ï¼šç¡®ä¿æ¯æ¬¡æ„å»ºè¿‡ç¨‹ä¸€è‡´
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šPipelineé…ç½®å¯ä»¥åƒä»£ç ä¸€æ ·ç®¡ç†
- **å¯è§†åŒ–**ï¼šæ¸…æ™°å±•ç¤ºæ•´ä¸ªæ„å»ºæµç¨‹
- **å¯é‡å¤**ï¼šé¿å…æ‰‹å·¥æ“ä½œçš„éšæ„æ€§

**ğŸ”¹ å£°æ˜å¼vsè„šæœ¬å¼**ï¼š
- **æ–°æ‰‹æ¨è**ï¼šå£°æ˜å¼Pipelineï¼Œç»“æ„æ¸…æ™°æ˜“ç†è§£
- **é«˜çº§ç”¨æ³•**ï¼šè„šæœ¬å¼Pipelineï¼Œçµæ´»æ€§æ›´å¼º
- **æ··åˆä½¿ç”¨**ï¼šå¯ä»¥åœ¨å£°æ˜å¼ä¸­åµŒå…¥scriptå—

**ğŸ”¹ Agenté€‰æ‹©ç­–ç•¥**ï¼š
- **ç®€å•é¡¹ç›®**ï¼šä½¿ç”¨ `agent any`
- **ç¯å¢ƒéš”ç¦»**ï¼šä½¿ç”¨Docker agent
- **æ€§èƒ½è¦æ±‚**ï¼šä½¿ç”¨ä¸“ç”¨æ ‡ç­¾èŠ‚ç‚¹

### å®é™…åº”ç”¨ä»·å€¼


- **æé«˜æ•ˆç‡**ï¼šè‡ªåŠ¨åŒ–å‡å°‘äººå·¥å¹²é¢„æ—¶é—´
- **é™ä½é£é™©**ï¼šæ ‡å‡†åŒ–æµç¨‹å‡å°‘äººä¸ºé”™è¯¯
- **å¿«é€Ÿåé¦ˆ**ï¼šåŠæ—¶å‘ç°å’Œè§£å†³é—®é¢˜
- **å›¢é˜Ÿåä½œ**ï¼šPipelineé…ç½®å¯ä»¥å›¢é˜Ÿåä½œç»´æŠ¤
- **æŒç»­æ”¹è¿›**ï¼šé€šè¿‡ç‰ˆæœ¬æ§åˆ¶ä¸æ–­ä¼˜åŒ–æµç¨‹

**æ ¸å¿ƒè®°å¿†**ï¼š
- Pipelineè®©è½¯ä»¶äº¤ä»˜åƒå·¥å‚æµæ°´çº¿ä¸€æ ·æ ‡å‡†åŒ–
- JenkinsfileæŠŠæ„å»ºæµç¨‹å˜æˆå¯ç®¡ç†çš„ä»£ç 
- åˆç†ä½¿ç”¨å¹¶è¡Œå’Œæ¡ä»¶æ‰§è¡Œæé«˜æ•ˆç‡
- é”™è¯¯å¤„ç†å’Œé€šçŸ¥æœºåˆ¶ä¿è¯æµç¨‹å¯é æ€§