---
title: 4ã€æ€§èƒ½ä¼˜åŒ–
---
## ğŸ“š ç›®å½•

1. [æ€§èƒ½ä¼˜åŒ–æ¦‚è¿°](#1-æ€§èƒ½ä¼˜åŒ–æ¦‚è¿°)
2. [æ„å»ºæ€§èƒ½ä¼˜åŒ–](#2-æ„å»ºæ€§èƒ½ä¼˜åŒ–)
3. [å†…å­˜ä½¿ç”¨ä¼˜åŒ–](#3-å†…å­˜ä½¿ç”¨ä¼˜åŒ–)
4. [ç£ç›˜ç©ºé—´ç®¡ç†](#4-ç£ç›˜ç©ºé—´ç®¡ç†)
5. [ç½‘ç»œé…ç½®ä¼˜åŒ–](#5-ç½‘ç»œé…ç½®ä¼˜åŒ–)
6. [å¹¶å‘æ„å»ºæ§åˆ¶](#6-å¹¶å‘æ„å»ºæ§åˆ¶)
7. [ç¼“å­˜ç­–ç•¥é…ç½®](#7-ç¼“å­˜ç­–ç•¥é…ç½®)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸš€ æ€§èƒ½ä¼˜åŒ–æ¦‚è¿°


### 1.1 ä¸ºä»€ä¹ˆéœ€è¦æ€§èƒ½ä¼˜åŒ–


**ç”Ÿæ´»åŒ–ç±»æ¯”**ï¼šJenkinså°±åƒä¸€ä¸ªå·¥å‚çš„ç”Ÿäº§çº¿ï¼Œå¦‚æœä¸ä¼˜åŒ–ï¼Œå°±ä¼šå‡ºç°è¿™äº›é—®é¢˜ï¼š

```
æ²¡ä¼˜åŒ–çš„Jenkins = æ‹¥å µçš„å·¥å‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä»»åŠ¡å †ç§¯  â”‚  æœºå™¨å¡é¡¿        â”‚
â”‚     â†“     â”‚     â†“           â”‚
â”‚  æ„å»ºç¼“æ…¢  â”‚  èµ„æºæµªè´¹        â”‚
â”‚     â†“     â”‚     â†“           â”‚
â”‚ å¼€å‘ç­‰å¾…   â”‚  æˆæœ¬å¢åŠ         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¼˜åŒ–åçš„Jenkins = é«˜æ•ˆå·¥å‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¹¶è¡Œå¤„ç†  â”‚  èµ„æºå……è¶³        â”‚
â”‚     â†“     â”‚     â†“           â”‚
â”‚  å¿«é€Ÿæ„å»º  â”‚  ç¨³å®šè¿è¡Œ        â”‚
â”‚     â†“     â”‚     â†“           â”‚
â”‚ å›¢é˜Ÿé«˜æ•ˆ   â”‚  æˆæœ¬æ§åˆ¶        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æ€§èƒ½é—®é¢˜çš„å¸¸è§è¡¨ç°


> ğŸ“Œ **è¯†åˆ«æ€§èƒ½é—®é¢˜çš„ä¿¡å·**
> - æ„å»ºæ—¶é—´è¶Šæ¥è¶Šé•¿ï¼ˆåŸæ¥5åˆ†é’Ÿï¼Œç°åœ¨è¦20åˆ†é’Ÿï¼‰
> - Jenkinsé¡µé¢åŠ è½½æ…¢ï¼ˆç‚¹å‡»åè¦ç­‰å¾ˆä¹…ï¼‰
> - æ„å»ºç»å¸¸å¤±è´¥æˆ–ä¸­æ–­
> - æœåŠ¡å™¨èµ„æºä½¿ç”¨ç‡è¿‡é«˜

**æ€§èƒ½ç“¶é¢ˆçš„å››å¤§æ¥æº**ï¼š

| ğŸ¯ ç“¶é¢ˆç±»å‹ | **å…·ä½“è¡¨ç°** | **å½±å“ç¨‹åº¦** | **è§£å†³éš¾åº¦** |
|------------|-------------|-------------|-------------|
| ğŸ—ï¸ **æ„å»ºç“¶é¢ˆ** | å•ä¸ªä»»åŠ¡å¤ªæ…¢ | â­â­â­ | ğŸ”§ ä¸­ç­‰ |
| ğŸ’¾ **å†…å­˜ç“¶é¢ˆ** | ç³»ç»Ÿå¡æ­»å´©æºƒ | â­â­â­â­â­ | ğŸ”§ğŸ”§ è¾ƒéš¾ |
| ğŸ’¿ **ç£ç›˜ç“¶é¢ˆ** | ç©ºé—´ä¸è¶³æŠ¥é”™ | â­â­â­â­ | ğŸ”§ ç®€å• |
| ğŸŒ **ç½‘ç»œç“¶é¢ˆ** | ä¸‹è½½ä¸Šä¼ ç¼“æ…¢ | â­â­â­ | ğŸ”§ğŸ”§ğŸ”§ å›°éš¾ |

---

## 2. âš¡ æ„å»ºæ€§èƒ½ä¼˜åŒ–


### 2.1 æ„å»ºæµç¨‹ä¼˜åŒ–ç­–ç•¥


**æ ¸å¿ƒæ€æƒ³**ï¼šè®©æ„å»ºä»»åŠ¡è·‘å¾—æ›´å¿«æ›´ç¨³

```
ä¼˜åŒ–å‰çš„æ„å»ºæµç¨‹ï¼š
æ­¥éª¤1ï¼šä¸‹è½½ä»£ç      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ (8åˆ†é’Ÿ)
æ­¥éª¤2ï¼šç¼–è¯‘ä»£ç      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ (14åˆ†é’Ÿ)  
æ­¥éª¤3ï¼šè¿è¡Œæµ‹è¯•     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ (12åˆ†é’Ÿ)
æ­¥éª¤4ï¼šæ‰“åŒ…éƒ¨ç½²     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ (6åˆ†é’Ÿ)
æ€»è®¡ï¼š40åˆ†é’Ÿ

ä¼˜åŒ–åçš„æ„å»ºæµç¨‹ï¼š
æ­¥éª¤1ï¼šå¢é‡ä¸‹è½½     â–ˆâ–ˆ (2åˆ†é’Ÿ)
æ­¥éª¤2ï¼šå¹¶è¡Œç¼–è¯‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ (6åˆ†é’Ÿ)
æ­¥éª¤3ï¼šæ™ºèƒ½æµ‹è¯•     â–ˆâ–ˆâ–ˆâ–ˆ (4åˆ†é’Ÿ)  
æ­¥éª¤4ï¼šç¼“å­˜æ‰“åŒ…     â–ˆâ–ˆ (2åˆ†é’Ÿ)
æ€»è®¡ï¼š14åˆ†é’Ÿ â† æå‡äº†65%ï¼
```

### 2.2 å…·ä½“ä¼˜åŒ–æªæ–½


**ğŸ”¸ ä»£ç æ‹‰å–ä¼˜åŒ–**

```bash
# æµ…å…‹éš†ï¼šåªä¸‹è½½æœ€æ–°ä»£ç ï¼Œä¸è¦å®Œæ•´å†å²
git clone --depth=1 https://github.com/your-repo.git

# å¢é‡æ›´æ–°ï¼šå·²æœ‰ä»£ç å°±æ›´æ–°ï¼Œæ²¡æœ‰å†å…‹éš†
if [ -d ".git" ]; then
    git pull
else
    git clone --depth=1 https://github.com/your-repo.git .
fi
```

> ğŸ’¡ **é€šä¿—è§£é‡Š**  
> å°±åƒä¸‹è½½ç”µå½±ä¸€æ ·ï¼Œæµ…å…‹éš†åªä¸‹è½½ç”µå½±æœ¬èº«ï¼Œä¸ä¸‹è½½åˆ å‡ç‰‡æ®µã€èŠ±çµ®ç­‰é¢å¤–å†…å®¹

**ğŸ”¸ ç¼–è¯‘è¿‡ç¨‹ä¼˜åŒ–**

```bash
# å¹¶è¡Œç¼–è¯‘ï¼šåˆ©ç”¨å¤šæ ¸CPU
make -j$(nproc)  # Linuxç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹CPUæ ¸æ•°

# Mavenå¹¶è¡Œç¼–è¯‘
mvn clean package -T 1C  # æ¯ä¸ªCPUæ ¸å¿ƒä¸€ä¸ªçº¿ç¨‹

# Gradleå¹¶è¡Œç¼–è¯‘
./gradlew build --parallel --max-workers=4
```

**ğŸ”¸ æµ‹è¯•æ‰§è¡Œä¼˜åŒ–**

| ä¼˜åŒ–ç­–ç•¥ | **è¯´æ˜** | **é€‚ç”¨åœºæ™¯** | **æ•ˆæœ** |
|---------|---------|-------------|---------|
| ğŸ¯ **æ™ºèƒ½æµ‹è¯•** | åªæµ‹è¯•ä¿®æ”¹ç›¸å…³çš„éƒ¨åˆ† | å¤§å‹é¡¹ç›® | èŠ‚çœ70%æ—¶é—´ |
| ğŸ”„ **å¹¶è¡Œæµ‹è¯•** | å¤šä¸ªæµ‹è¯•åŒæ—¶è·‘ | æµ‹è¯•è¾ƒå¤šæ—¶ | èŠ‚çœ50%æ—¶é—´ |
| ğŸ“Š **åˆ†å±‚æµ‹è¯•** | å•å…ƒæµ‹è¯•â†’é›†æˆæµ‹è¯•â†’E2E | æ‰€æœ‰é¡¹ç›® | å¿«é€Ÿå‘ç°é—®é¢˜ |

### 2.3 æ„å»ºç¯å¢ƒä¼˜åŒ–


**ğŸ”¸ ä½¿ç”¨SSDç¡¬ç›˜**
```
ä¼ ç»Ÿç¡¬ç›˜ vs SSDå¯¹æ¯”ï¼š
æœºæ¢°ç¡¬ç›˜ï¼šâ– â– â– â– â– â– â– â– â– â–  (100MB/sè¯»å–)
SSDç¡¬ç›˜ï¼šâ– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–  (500MB/sè¯»å–)

å®é™…æ•ˆæœï¼šç¼–è¯‘é€Ÿåº¦æå‡2-3å€
```

**ğŸ”¸ é¢„è£…æ„å»ºå·¥å…·**
```bash
# åˆ¶ä½œåŒ…å«å¸¸ç”¨å·¥å…·çš„Dockeré•œåƒ
FROM openjdk:11-jdk

# é¢„è£…Mavenã€Node.jsã€Pythonç­‰
RUN apt-get update && apt-get install -y \
    maven \
    nodejs \
    python3 \
    && rm -rf /var/lib/apt/lists/*

# é¢„ä¸‹è½½ä¾èµ–åŒ…
COPY pom.xml .
RUN mvn dependency:go-offline
```

---

## 3. ğŸ§  å†…å­˜ä½¿ç”¨ä¼˜åŒ–


### 3.1 ç†è§£Jenkinså†…å­˜ä½¿ç”¨


**ç®€å•ç±»æ¯”**ï¼šJenkinsçš„å†…å­˜å°±åƒé¤å…çš„æ¡Œå­

```
å†…å­˜ä¸è¶³çš„Jenkins = æ¡Œå­å¤ªå°‘çš„é¤å…
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å®¢äººæ’é˜Ÿç­‰ä½        â”‚ â† æ„å»ºä»»åŠ¡ç­‰å¾…
â”‚ æœåŠ¡å‘˜æ‰‹å¿™è„šä¹±      â”‚ â† Jenkinså¡é¡¿
â”‚ ä¸Šèœé€Ÿåº¦æ…¢          â”‚ â† æ„å»ºé€Ÿåº¦æ…¢
â”‚ å®¢äººä¸æ»¡æ„          â”‚ â† å¼€å‘ä½“éªŒå·®
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å†…å­˜å……è¶³çš„Jenkins = æ¡Œå­å¤Ÿç”¨çš„é¤å…
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å®¢äººç«‹å³å°±åº§        â”‚ â† æ„å»ºç«‹å³å¼€å§‹
â”‚ æœåŠ¡å‘˜ä»å®¹ä¸è¿«      â”‚ â† Jenkinsç¨³å®šè¿è¡Œ
â”‚ ä¸Šèœé€Ÿåº¦å¿«          â”‚ â† æ„å»ºå¿«é€Ÿå®Œæˆ
â”‚ å®¢äººæ»¡æ„            â”‚ â† å¼€å‘ä½“éªŒå¥½
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Jenkinså †å†…å­˜é…ç½®


**ğŸ”¸ åŸºç¡€å†…å­˜é…ç½®**

```bash
# åœ¨Jenkinså¯åŠ¨è„šæœ¬ä¸­è®¾ç½®
export JAVA_OPTS="-Xms2g -Xmx4g"

# å‚æ•°å«ä¹‰ï¼š
# -Xms2gï¼šå¯åŠ¨æ—¶åˆ†é…2GBå†…å­˜ï¼ˆæœ€å°å€¼ï¼‰
# -Xmx4gï¼šæœ€å¤§å¯ä½¿ç”¨4GBå†…å­˜ï¼ˆæœ€å¤§å€¼ï¼‰
```

> ğŸ“Œ **å†…å­˜å¤§å°é€‰æ‹©æŒ‡å—**
> - **å°å›¢é˜Ÿ**ï¼ˆ<10äººï¼‰ï¼š2-4GB
> - **ä¸­ç­‰å›¢é˜Ÿ**ï¼ˆ10-50äººï¼‰ï¼š4-8GB  
> - **å¤§å›¢é˜Ÿ**ï¼ˆ>50äººï¼‰ï¼š8-16GB

**ğŸ”¸ å†…å­˜ç›‘æ§ä¸è°ƒä¼˜**

```bash
# æŸ¥çœ‹Javaè¿›ç¨‹å†…å­˜ä½¿ç”¨
jstat -gc <jenkins-pid> 1s

# è¾“å‡ºè¯´æ˜ï¼š
# S0Cï¼šç¬¬ä¸€ä¸ªå¹¸å­˜åŒºå®¹é‡
# S1Cï¼šç¬¬äºŒä¸ªå¹¸å­˜åŒºå®¹é‡  
# ECï¼šEdenåŒºå®¹é‡
# OCï¼šè€å¹´ä»£å®¹é‡
# YGCï¼šå¹´è½»ä»£GCæ¬¡æ•°
# YGCTï¼šå¹´è½»ä»£GCæ€»æ—¶é—´
```

### 3.3 é¿å…å†…å­˜æ³„æ¼


**å¸¸è§å†…å­˜æ³„æ¼åœºæ™¯**ï¼š

```
å†…å­˜æ³„æ¼çš„å…¸å‹è·¯å¾„ï¼š
æ’ä»¶åŠ è½½ â†’ å¯¹è±¡åˆ›å»º â†’ ä½¿ç”¨å®Œæ¯• â†’ å¿˜è®°é‡Šæ”¾ â†’ å†…å­˜å †ç§¯
    â†“
æ—¶é—´è¶Šé•¿ â†’ å ç”¨è¶Šå¤š â†’ æœ€ç»ˆOutOfMemoryError
```

**ğŸ”¸ é¢„é˜²æªæ–½**

| é¢„é˜²ç­–ç•¥ | **å…·ä½“åšæ³•** | **æ•ˆæœ** |
|---------|-------------|---------|
| ğŸ”„ **å®šæœŸé‡å¯** | æ¯å‘¨é‡å¯ä¸€æ¬¡Jenkins | æ¸…ç†å†…å­˜ç¢ç‰‡ |
| ğŸ§¹ **æ¸…ç†æ’ä»¶** | å¸è½½ä¸ç”¨çš„æ’ä»¶ | å‡å°‘å†…å­˜å ç”¨ |
| ğŸ“Š **ç›‘æ§å†…å­˜** | é…ç½®å†…å­˜å‘Šè­¦ | åŠæ—¶å‘ç°é—®é¢˜ |

---

## 4. ğŸ’¿ ç£ç›˜ç©ºé—´ç®¡ç†


### 4.1 ç£ç›˜ç©ºé—´çš„é‡è¦æ€§


**ç”Ÿæ´»åŒ–è§£é‡Š**ï¼šç£ç›˜ç©ºé—´å°±åƒå®¶é‡Œçš„å‚¨ç‰©é—´

```
ç£ç›˜ç©ºé—´ä¸è¶³ = å‚¨ç‰©é—´å¤ªå°
é—®é¢˜è¡¨ç°ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ–°ä¸œè¥¿æ”¾ä¸ä¸‹        â”‚ â† æ–°æ„å»ºæ— æ³•å¼€å§‹
â”‚ æ‰¾ä¸œè¥¿å¾ˆå›°éš¾        â”‚ â† æ„å»ºè®°å½•éš¾æŸ¥æ‰¾
â”‚ æ•´ä¸ªæˆ¿å­éƒ½ä¹±å¥—      â”‚ â† Jenkinsç³»ç»Ÿå´©æºƒ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åˆç†çš„ç£ç›˜ç®¡ç† = æœ‰åºçš„å‚¨ç‰©é—´
å¥½å¤„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å®šæœŸæ•´ç†æ¸…æ´        â”‚ â† è‡ªåŠ¨æ¸…ç†æ—§æ„å»º
â”‚ åˆ†ç±»å­˜æ”¾ç‰©å“        â”‚ â† æŒ‰é¡¹ç›®åˆ†ç›®å½•
â”‚ é¢„ç•™è¶³å¤Ÿç©ºé—´        â”‚ â† ç›‘æ§ä½¿ç”¨æƒ…å†µ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 æ„å»ºå†å²æ¸…ç†ç­–ç•¥


**ğŸ”¸ è‡ªåŠ¨æ¸…ç†é…ç½®**

åœ¨Jenkinsé¡¹ç›®è®¾ç½®ä¸­ï¼š

```
ä¸¢å¼ƒæ—§çš„æ„å»º âœ“

ä¿æŒæ„å»ºçš„å¤©æ•°ï¼š30å¤©
ä¿æŒæ„å»ºçš„æœ€å¤§ä¸ªæ•°ï¼š50ä¸ª

ä¿æŒåˆ¶å“çš„å¤©æ•°ï¼š7å¤©  
ä¿æŒåˆ¶å“çš„æœ€å¤§ä¸ªæ•°ï¼š10ä¸ª
```

> ğŸ’¡ **æ¸…ç†ç­–ç•¥è§£é‡Š**  
> - **å¤©æ•°é™åˆ¶**ï¼šè¶…è¿‡30å¤©çš„æ„å»ºè®°å½•è‡ªåŠ¨åˆ é™¤
> - **ä¸ªæ•°é™åˆ¶**ï¼šåªä¿ç•™æœ€è¿‘50æ¬¡æ„å»ºè®°å½•
> - **åˆ¶å“ç®¡ç†**ï¼šç¼–è¯‘äº§ç‰©åªä¿ç•™7å¤©ï¼Œé¿å…å ç”¨è¿‡å¤šç©ºé—´

**ğŸ”¸ æ‰‹åŠ¨æ¸…ç†è„šæœ¬**

```bash
#!/bin/bash
# Jenkinsç£ç›˜æ¸…ç†è„šæœ¬

JENKINS_HOME="/var/lib/jenkins"

echo "å¼€å§‹æ¸…ç†Jenkinsç£ç›˜ç©ºé—´..."

# 1. æ¸…ç†å·¥ä½œç©ºé—´ä¸´æ—¶æ–‡ä»¶
find $JENKINS_HOME/workspace -name "target" -type d -exec rm -rf {} + 2>/dev/null
find $JENKINS_HOME/workspace -name "node_modules" -type d -exec rm -rf {} + 2>/dev/null

# 2. æ¸…ç†æ—§çš„æ„å»ºè®°å½•ï¼ˆè¶…è¿‡30å¤©ï¼‰
find $JENKINS_HOME/jobs/*/builds -name "build.xml" -mtime +30 -delete

# 3. æ¸…ç†ç³»ç»Ÿæ—¥å¿—
find /var/log/jenkins -name "*.log" -mtime +7 -delete

echo "æ¸…ç†å®Œæˆï¼"
```

### 4.3 ç£ç›˜ç›‘æ§å’Œå‘Šè­¦


**ğŸ”¸ ç›‘æ§è„šæœ¬é…ç½®**

```bash
# ç£ç›˜ä½¿ç”¨ç‡æ£€æŸ¥è„šæœ¬
#!/bin/bash

DISK_USAGE=$(df -h /var/lib/jenkins | tail -1 | awk '{print $5}' | sed 's/%//')

if [ $DISK_USAGE -gt 80 ]; then
    echo "è­¦å‘Šï¼šJenkinsç£ç›˜ä½¿ç”¨ç‡è¾¾åˆ° ${DISK_USAGE}%"
    # å‘é€é‚®ä»¶æˆ–Slacké€šçŸ¥
    mail -s "Jenkinsç£ç›˜ç©ºé—´ä¸è¶³" admin@company.com < /dev/null
fi
```

---

## 5. ğŸŒ ç½‘ç»œé…ç½®ä¼˜åŒ–


### 5.1 ç½‘ç»œå¯¹Jenkinsçš„å½±å“


**ç½‘ç»œåœ¨CI/CDä¸­çš„ä½œç”¨**ï¼š

```
CI/CDç½‘ç»œæµé‡å›¾ï¼š
å¼€å‘è€… â†’ Jenkins â†’ ä»£ç ä»“åº“
   â†“         â†“         â†“
 æ¨é€ä»£ç    æ‹‰å–ä»£ç    è¿”å›ä»£ç 
   
Jenkins â†’ ä¾èµ–ä»“åº“ â†’ éƒ¨ç½²ç›®æ ‡
   â†“         â†“         â†“
ä¸‹è½½ä¾èµ–   è¿”å›åŒ…æ–‡ä»¶  ä¸Šä¼ åº”ç”¨
```

**ç½‘ç»œæ…¢çš„å½±å“**ï¼š
- ä¸‹è½½ä¾èµ–åŒ…æ—¶é—´é•¿ï¼ˆMavenã€npmåŒ…ç­‰ï¼‰
- æ‹‰å–ä»£ç ä»“åº“ç¼“æ…¢
- ä¸Šä¼ éƒ¨ç½²åŒ…åˆ°æœåŠ¡å™¨æ…¢
- Dockeré•œåƒä¸‹è½½ä¸Šä¼ æ…¢

### 5.2 ç½‘ç»œä¼˜åŒ–ç­–ç•¥


**ğŸ”¸ é…ç½®æœ¬åœ°ä»£ç†/é•œåƒ**

```bash
# Mavenä½¿ç”¨é˜¿é‡Œäº‘é•œåƒ
<mirror>
    <id>alimaven</id>
    <name>aliyun maven</name>
    <url>http://maven.aliyun.com/nexus/content/groups/public/</url>
    <mirrorOf>central</mirrorOf>
</mirror>

# npmä½¿ç”¨æ·˜å®é•œåƒ
npm config set registry https://registry.npmmirror.com

# Dockerä½¿ç”¨å›½å†…é•œåƒæº
{
  "registry-mirrors": [
    "https://hub-mirror.c.163.com",
    "https://docker.mirrors.ustc.edu.cn"
  ]
}
```

> ğŸ“Œ **é•œåƒæºçš„å¥½å¤„**  
> å°±åƒåœ¨æœ¬åœ°å¼€ä¾¿åˆ©åº—ï¼Œä¸ç”¨è·‘åˆ°è¿œå¤„çš„å¤§è¶…å¸‚ä¹°ä¸œè¥¿ï¼Œå¤§å¤§èŠ‚çœæ—¶é—´

**ğŸ”¸ ç½‘ç»œè¿æ¥æ± ä¼˜åŒ–**

```bash
# Jenkinsç³»ç»Ÿé…ç½®ä¸­è®¾ç½®
-Dhudson.diyChunking=false
-Djenkins.slaves.DefaultJnlpSlaveReceiver.disableHttpKeepAlive=false
-Dhudson.DNSMultiCast.disabled=true
```

### 5.3 è´Ÿè½½å‡è¡¡é…ç½®


**ğŸ”¸ åå‘ä»£ç†è®¾ç½®**

```nginx
# Nginxé…ç½®Jenkinsè´Ÿè½½å‡è¡¡
upstream jenkins {
    server 192.168.1.10:8080;
    server 192.168.1.11:8080;
}

server {
    listen 80;
    server_name jenkins.company.com;
    
    location / {
        proxy_pass http://jenkins;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        
        # å¢åŠ è¶…æ—¶æ—¶é—´ï¼Œé€‚åº”é•¿æ—¶é—´æ„å»º
        proxy_connect_timeout 300;
        proxy_send_timeout 300;
        proxy_read_timeout 300;
    }
}
```

---

## 6. ğŸ”„ å¹¶å‘æ„å»ºæ§åˆ¶


### 6.1 ä»€ä¹ˆæ˜¯å¹¶å‘æ„å»º


**ç”Ÿæ´»åŒ–ç±»æ¯”**ï¼šå¹¶å‘æ„å»ºå°±åƒé¤å…çš„å¨å¸ˆå®‰æ’

```
å•çº¿ç¨‹æ„å»º = åªæœ‰ä¸€ä¸ªå¨å¸ˆï¼š
ä»»åŠ¡1ï¼ˆç‚’èœï¼‰â†’ ä»»åŠ¡2ï¼ˆç…®æ±¤ï¼‰â†’ ä»»åŠ¡3ï¼ˆåšç”œå“ï¼‰
æ€»æ—¶é—´ï¼š60åˆ†é’Ÿ

å¹¶å‘æ„å»º = å¤šä¸ªå¨å¸ˆåŒæ—¶å·¥ä½œï¼š
å¨å¸ˆAï¼šä»»åŠ¡1ï¼ˆç‚’èœï¼‰    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 20åˆ†é’Ÿ
å¨å¸ˆBï¼šä»»åŠ¡2ï¼ˆç…®æ±¤ï¼‰    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 18åˆ†é’Ÿ  
å¨å¸ˆCï¼šä»»åŠ¡3ï¼ˆåšç”œå“ï¼‰  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 25åˆ†é’Ÿ
æ€»æ—¶é—´ï¼š25åˆ†é’Ÿï¼ˆæœ€é•¿çš„é‚£ä¸ªï¼‰
```

### 6.2 é…ç½®æ‰§è¡Œå™¨æ•°é‡


**ğŸ”¸ ç³»ç»Ÿçº§åˆ«é…ç½®**

åœ¨Jenkinsç³»ç»Ÿç®¡ç†ä¸­ï¼š

```
ç®¡ç†Jenkins â†’ ç³»ç»Ÿé…ç½® â†’ æ‰§è¡Œå™¨æ•°é‡

æ¨èé…ç½®ï¼š
â€¢ CPUæ ¸å¿ƒæ•° Ã— 2 ï¼ˆå¯¹äºI/Oå¯†é›†å‹ä»»åŠ¡ï¼‰
â€¢ CPUæ ¸å¿ƒæ•° Ã— 1 ï¼ˆå¯¹äºCPUå¯†é›†å‹ä»»åŠ¡ï¼‰

ç¤ºä¾‹ï¼š
4æ ¸æœåŠ¡å™¨ â†’ è®¾ç½®6-8ä¸ªæ‰§è¡Œå™¨
8æ ¸æœåŠ¡å™¨ â†’ è®¾ç½®10-16ä¸ªæ‰§è¡Œå™¨
```

**ğŸ”¸ èŠ‚ç‚¹çº§åˆ«é…ç½®**

```
èŠ‚ç‚¹ç®¡ç† â†’ é€‰æ‹©èŠ‚ç‚¹ â†’ é…ç½®

æ‰§è¡Œå™¨æ•°é‡ï¼š4
æ ‡ç­¾ï¼šlinux java maven
ä½¿ç”¨æ–¹å¼ï¼šå°½å¯èƒ½çš„ä½¿ç”¨è¿™ä¸ªèŠ‚ç‚¹
```

### 6.3 å¹¶å‘ç­–ç•¥é…ç½®


**ğŸ”¸ é¡¹ç›®å¹¶å‘è®¾ç½®**

| å¹¶å‘ç±»å‹ | **é…ç½®æ–¹å¼** | **é€‚ç”¨åœºæ™¯** | **æ³¨æ„äº‹é¡¹** |
|---------|-------------|-------------|-------------|
| ğŸš« **ç¦æ­¢å¹¶å‘** | å–æ¶ˆå‹¾é€‰"å¹¶å‘æ„å»º" | éƒ¨ç½²ä»»åŠ¡ã€æ•°æ®åº“æ“ä½œ | ç¡®ä¿æ“ä½œçš„åŸå­æ€§ |
| âœ… **å…è®¸å¹¶å‘** | å‹¾é€‰"å¹¶å‘æ„å»º" | æµ‹è¯•ä»»åŠ¡ã€ä»£ç æ£€æŸ¥ | éœ€è¦è¶³å¤Ÿèµ„æºæ”¯æŒ |
| ğŸ¯ **é™åˆ¶å¹¶å‘** | ä½¿ç”¨`Throttle`æ’ä»¶ | èµ„æºæ•æ„Ÿå‹ä»»åŠ¡ | é˜²æ­¢èµ„æºç«äº‰ |

**ğŸ”¸ èµ„æºé”å®šæœºåˆ¶**

```groovy
// Pipelineä¸­ä½¿ç”¨èµ„æºé”
pipeline {
    agent any
    
    stages {
        stage('Deploy') {
            steps {
                lock('deployment-resource') {
                    sh 'echo "éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ"'
                    sh './deploy.sh'
                }
            }
        }
    }
}
```

> ğŸ’¡ **èµ„æºé”çš„ä½œç”¨**  
> å°±åƒå…¬å…±æ´—æ‰‹é—´çš„é”ï¼Œç¡®ä¿åŒæ—¶åªæœ‰ä¸€ä¸ªäººä½¿ç”¨ï¼Œé¿å…å†²çª

---

## 7. ğŸ—„ï¸ ç¼“å­˜ç­–ç•¥é…ç½®


### 7.1 ç¼“å­˜çš„é‡è¦æ€§


**ç¼“å­˜åŸç†è§£é‡Š**ï¼š

```
æ²¡æœ‰ç¼“å­˜çš„æ„å»ºï¼š
ç¬¬1æ¬¡æ„å»ºï¼šä¸‹è½½ä¾èµ– â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ + ç¼–è¯‘ â–ˆâ–ˆâ–ˆâ–ˆ = 12åˆ†é’Ÿ
ç¬¬2æ¬¡æ„å»ºï¼šä¸‹è½½ä¾èµ– â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ + ç¼–è¯‘ â–ˆâ–ˆâ–ˆâ–ˆ = 12åˆ†é’Ÿ
ç¬¬3æ¬¡æ„å»ºï¼šä¸‹è½½ä¾èµ– â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ + ç¼–è¯‘ â–ˆâ–ˆâ–ˆâ–ˆ = 12åˆ†é’Ÿ

æœ‰ç¼“å­˜çš„æ„å»ºï¼š
ç¬¬1æ¬¡æ„å»ºï¼šä¸‹è½½ä¾èµ– â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ + ç¼–è¯‘ â–ˆâ–ˆâ–ˆâ–ˆ = 12åˆ†é’Ÿ
ç¬¬2æ¬¡æ„å»ºï¼šä½¿ç”¨ç¼“å­˜ â–ˆ + ç¼–è¯‘ â–ˆâ–ˆâ–ˆâ–ˆ = 5åˆ†é’Ÿ
ç¬¬3æ¬¡æ„å»ºï¼šä½¿ç”¨ç¼“å­˜ â–ˆ + ç¼–è¯‘ â–ˆâ–ˆâ–ˆâ–ˆ = 5åˆ†é’Ÿ
```

> ğŸ“Œ **ç¼“å­˜å°±åƒ**  
> æŠŠå¸¸ç”¨çš„å·¥å…·æ”¾åœ¨å·¥ä½œå°ä¸Šï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½å»ä»“åº“æ‹¿

### 7.2 ä¾èµ–ç¼“å­˜é…ç½®


**ğŸ”¸ Mavenä¾èµ–ç¼“å­˜**

```xml
<!-- åœ¨Jenkinsä¸­é…ç½®Mavenæœ¬åœ°ä»“åº“ -->
<settings>
    <localRepository>/var/lib/jenkins/.m2/repository</localRepository>
    
    <!-- é…ç½®é•œåƒæº -->
    <mirrors>
        <mirror>
            <id>alimaven</id>
            <name>aliyun maven</name>
            <url>http://maven.aliyun.com/nexus/content/groups/public/</url>
            <mirrorOf>central</mirrorOf>
        </mirror>
    </mirrors>
</settings>
```

**ğŸ”¸ npmä¾èµ–ç¼“å­˜**

```bash
# åœ¨æ„å»ºè„šæœ¬ä¸­é…ç½®npmç¼“å­˜
npm config set cache /var/lib/jenkins/.npm

# ä½¿ç”¨npm ciä»£æ›¿npm installï¼ˆæ›´å¿«æ›´å¯é ï¼‰
npm ci --cache=/var/lib/jenkins/.npm
```

**ğŸ”¸ Dockerå±‚ç¼“å­˜**

```dockerfile
# ä¼˜åŒ–Dockerfileå±‚é¡ºåºï¼Œå……åˆ†åˆ©ç”¨ç¼“å­˜
FROM node:14

# å…ˆå¤åˆ¶ä¾èµ–æ–‡ä»¶ï¼ˆå˜åŒ–é¢‘ç‡ä½ï¼‰
COPY package*.json ./
RUN npm ci

# å†å¤åˆ¶æºç ï¼ˆå˜åŒ–é¢‘ç‡é«˜ï¼‰
COPY . .
RUN npm run build
```

### 7.3 æ„å»ºç¼“å­˜ç­–ç•¥


**ğŸ”¸ å·¥ä½œç©ºé—´ç¼“å­˜**

```groovy
// Pipelineä¸­é…ç½®ç¼“å­˜
pipeline {
    agent any
    
    options {
        // è·³è¿‡é»˜è®¤çš„checkout
        skipDefaultCheckout(true)
    }
    
    stages {
        stage('Checkout') {
            steps {
                script {
                    // å¢é‡æ›´æ–°ä»£ç 
                    if (fileExists('.git')) {
                        sh 'git pull'
                    } else {
                        checkout scm
                    }
                }
            }
        }
        
        stage('Cache Dependencies') {
            steps {
                // æ£€æŸ¥ç¼“å­˜æ˜¯å¦å­˜åœ¨
                script {
                    if (!fileExists('node_modules')) {
                        sh 'npm ci'
                    } else {
                        echo 'ä½¿ç”¨ç°æœ‰ä¾èµ–ç¼“å­˜'
                    }
                }
            }
        }
    }
}
```

**ğŸ”¸ åˆ†å¸ƒå¼ç¼“å­˜é…ç½®**

| ç¼“å­˜ç±»å‹ | **å·¥å…·** | **é€‚ç”¨åœºæ™¯** | **é…ç½®å¤æ‚åº¦** |
|---------|---------|-------------|---------------|
| ğŸ—‚ï¸ **æœ¬åœ°ç¼“å­˜** | æ–‡ä»¶ç³»ç»Ÿ | å•æœºJenkins | ğŸ”§ ç®€å• |
| ğŸŒ **ç½‘ç»œç¼“å­˜** | NFS/Samba | å¤šèŠ‚ç‚¹é›†ç¾¤ | ğŸ”§ğŸ”§ ä¸­ç­‰ |
| â˜ï¸ **äº‘ç¼“å­˜** | S3/OSS | äº‘ç¯å¢ƒéƒ¨ç½² | ğŸ”§ğŸ”§ğŸ”§ å¤æ‚ |

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 æ€§èƒ½ä¼˜åŒ–æ ¸å¿ƒåŸåˆ™


> ğŸ“Œ **è®°ä½è¿™å››ä¸ªå…³é”®è¯**
> 1. **å¿«**ï¼šæ„å»ºè¦å¿«ï¼Œå“åº”è¦å¿«
> 2. **ç¨³**ï¼šç³»ç»Ÿè¦ç¨³å®šï¼Œä¸èƒ½ç»å¸¸å´©æºƒ
> 3. **çœ**ï¼šèŠ‚çœèµ„æºï¼Œæ§åˆ¶æˆæœ¬
> 4. **ç®€**ï¼šé…ç½®ç®€å•ï¼Œç»´æŠ¤æ–¹ä¾¿

### 8.2 ä¼˜åŒ–æ•ˆæœè¯„ä¼°


**ğŸ”¸ æ€§èƒ½æŒ‡æ ‡ç›‘æ§**

```
å…³é”®æŒ‡æ ‡ç›‘æ§æ¸…å•ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… å¹³å‡æ„å»ºæ—¶é—´ï¼š<10åˆ†é’Ÿ     â”‚
â”‚ âœ… ç³»ç»ŸCPUä½¿ç”¨ç‡ï¼š<70%      â”‚  
â”‚ âœ… å†…å­˜ä½¿ç”¨ç‡ï¼š<80%         â”‚
â”‚ âœ… ç£ç›˜ä½¿ç”¨ç‡ï¼š<85%         â”‚
â”‚ âœ… æ„å»ºæˆåŠŸç‡ï¼š>95%         â”‚
â”‚ âœ… é¡µé¢å“åº”æ—¶é—´ï¼š<3ç§’       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.3 ä¼˜åŒ–å®æ–½è·¯çº¿å›¾


**ğŸŒ± ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€ä¼˜åŒ–ï¼ˆ1-2å‘¨ï¼‰**
- æ¸…ç†ç£ç›˜ç©ºé—´
- é…ç½®ä¾èµ–ç¼“å­˜
- è°ƒæ•´å†…å­˜è®¾ç½®

**ğŸŒ¿ ç¬¬äºŒé˜¶æ®µï¼šè¿›é˜¶ä¼˜åŒ–ï¼ˆ2-4å‘¨ï¼‰**  
- ä¼˜åŒ–æ„å»ºæµç¨‹
- é…ç½®å¹¶å‘æ§åˆ¶
- è®¾ç½®ç›‘æ§å‘Šè­¦

**ğŸŒ³ ç¬¬ä¸‰é˜¶æ®µï¼šé«˜çº§ä¼˜åŒ–ï¼ˆé•¿æœŸï¼‰**
- åˆ†å¸ƒå¼æ„å»º
- è‡ªåŠ¨æ‰©ç¼©å®¹
- æ™ºèƒ½è°ƒåº¦ç­–ç•¥

### 8.4 å¸¸è§é—®é¢˜è§£å†³


**ğŸ” å¿«é€Ÿè¯Šæ–­æ¸…å•**

| é—®é¢˜ç°è±¡ | **å¯èƒ½åŸå› ** | **è§£å†³æ–¹æ¡ˆ** | **é¢„é˜²æªæ–½** |
|---------|-------------|-------------|-------------|
| æ„å»ºå¾ˆæ…¢ | ç½‘ç»œé—®é¢˜/èµ„æºä¸è¶³ | é…ç½®ç¼“å­˜/å¢åŠ èµ„æº | ç›‘æ§èµ„æºä½¿ç”¨ |
| ç»å¸¸å´©æºƒ | å†…å­˜ä¸è¶³ | å¢åŠ å†…å­˜/ä¼˜åŒ–é…ç½® | å®šæœŸé‡å¯ |
| ç£ç›˜æ»¡äº† | å†å²æ•°æ®å¤ªå¤š | æ¸…ç†æ—§æ„å»º | è‡ªåŠ¨æ¸…ç†ç­–ç•¥ |
| é¡µé¢å¡é¡¿ | æ’ä»¶å¤ªå¤š/é…ç½®ä¸å½“ | ç²¾ç®€æ’ä»¶/è°ƒä¼˜å‚æ•° | å®šæœŸæ£€æŸ¥ |

> âš¡ **æ€§èƒ½ä¼˜åŒ–é‡‘å¥**  
> "æ€§èƒ½ä¼˜åŒ–ä¸æ˜¯ä¸€æ¬¡æ€§å·¥ä½œï¼Œè€Œæ˜¯æŒç»­æ”¹è¿›çš„è¿‡ç¨‹"

**ğŸ”§ å®ç”¨å·¥å…·æ¨è**
- **ç›‘æ§å·¥å…·**ï¼š`htop`ã€`iotop`ã€`ncdu`
- **åˆ†æå·¥å…·**ï¼š`jstat`ã€`jmap`ã€`jstack`  
- **è‡ªåŠ¨åŒ–è„šæœ¬**ï¼šå®šæœŸæ¸…ç†ã€ç›‘æ§å‘Šè­¦
- **Jenkinsæ’ä»¶**ï¼šBuild Cache Pluginã€Performance Plugin

**ğŸ“š å­¦ä¹ è·¯å¾„å»ºè®®**
1. æŒæ¡Linuxç³»ç»Ÿç›‘æ§åŸºç¡€
2. ç†è§£Javaåº”ç”¨æ€§èƒ½è°ƒä¼˜
3. å­¦ä¹ Dockerå®¹å™¨ä¼˜åŒ–
4. ç ”ç©¶åˆ†å¸ƒå¼ç³»ç»Ÿè®¾è®¡

**ğŸ’¡ æœ€åæé†’**
æ€§èƒ½ä¼˜åŒ–è¦æ ¹æ®å®é™…æƒ…å†µæ¥åšï¼Œä¸è¦ä¸ºäº†ä¼˜åŒ–è€Œä¼˜åŒ–ã€‚å…ˆæ‰¾å‡ºçœŸæ­£çš„ç“¶é¢ˆï¼Œå†é’ˆå¯¹æ€§è§£å†³ï¼Œè¿™æ ·æ•ˆæœæœ€å¥½ï¼