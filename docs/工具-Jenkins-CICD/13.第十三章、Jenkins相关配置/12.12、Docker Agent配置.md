---
title: 12ã€Docker Agenté…ç½®
---
## ğŸ“š ç›®å½•

1. [Docker AgentåŸºæœ¬æ¦‚å¿µ](#1-Docker-AgentåŸºæœ¬æ¦‚å¿µ)
2. [Dockeræ’ä»¶å®‰è£…ä¸é…ç½®](#2-Dockeræ’ä»¶å®‰è£…ä¸é…ç½®)
3. [Dockeré•œåƒé…ç½®è¯¦è§£](#3-Dockeré•œåƒé…ç½®è¯¦è§£)
4. [å®¹å™¨è¿è¡Œæ—¶é…ç½®](#4-å®¹å™¨è¿è¡Œæ—¶é…ç½®)
5. [å·æŒ‚è½½ä¸æ•°æ®æŒä¹…åŒ–](#5-å·æŒ‚è½½ä¸æ•°æ®æŒä¹…åŒ–)
6. [ç½‘ç»œé…ç½®ä¸å®‰å…¨è®¾ç½®](#6-ç½‘ç»œé…ç½®ä¸å®‰å…¨è®¾ç½®)
7. [èµ„æºé™åˆ¶ä¸æ€§èƒ½ä¼˜åŒ–](#7-èµ„æºé™åˆ¶ä¸æ€§èƒ½ä¼˜åŒ–)
8. [ç¯å¢ƒå˜é‡ä¸å‚æ•°ä¼ é€’](#8-ç¯å¢ƒå˜é‡ä¸å‚æ•°ä¼ é€’)
9. [å®¹å™¨æ¸…ç†ç­–ç•¥](#9-å®¹å™¨æ¸…ç†ç­–ç•¥)
10. [å®æˆ˜é…ç½®ç¤ºä¾‹](#10-å®æˆ˜é…ç½®ç¤ºä¾‹)
11. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#11-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ³ Docker AgentåŸºæœ¬æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯Docker Agent


**é€šä¿—ç†è§£**ï¼š
æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ˜¯ä¸€ä¸ªå·¥å‚è€æ¿ï¼ˆJenkinsä¸»èŠ‚ç‚¹ï¼‰ï¼Œæœ‰å¾ˆå¤šå·¥ä½œè¦åšï¼Œä½†æ˜¯ä½ çš„å·¥å‚è®¾å¤‡æœ‰é™ã€‚è¿™æ—¶å€™ä½ æƒ³åˆ°ä¸€ä¸ªå¥½åŠæ³•ï¼š**æ¯å½“æœ‰æ–°ä»»åŠ¡æ—¶ï¼Œå°±ä¸´æ—¶æ­å»ºä¸€ä¸ªä¸“é—¨çš„å°ä½œåŠï¼ˆDockerå®¹å™¨ï¼‰æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œä»»åŠ¡å®Œæˆåå°±æ‹†æ‰è¿™ä¸ªä½œåŠ**ã€‚

```
ä¼ ç»Ÿæ–¹å¼ï¼ˆå›ºå®šAgentï¼‰ï¼š
Jenkinsä¸»èŠ‚ç‚¹ â†’ å›ºå®šçš„å·¥ä½œæœºå™¨1 â†’ ä¸€ç›´è¿è¡Œ
              â†’ å›ºå®šçš„å·¥ä½œæœºå™¨2 â†’ ä¸€ç›´è¿è¡Œ
              â†’ å›ºå®šçš„å·¥ä½œæœºå™¨3 â†’ ä¸€ç›´è¿è¡Œ

Docker Agentæ–¹å¼ï¼š
Jenkinsä¸»èŠ‚ç‚¹ â†’ éœ€è¦æ—¶åˆ›å»ºå®¹å™¨ â†’ æ‰§è¡Œä»»åŠ¡ â†’ è‡ªåŠ¨é”€æ¯
              â†’ éœ€è¦æ—¶åˆ›å»ºå®¹å™¨ â†’ æ‰§è¡Œä»»åŠ¡ â†’ è‡ªåŠ¨é”€æ¯
```

**Docker Agentçš„æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- ğŸ¯ **æŒ‰éœ€åˆ›å»º**ï¼šåªåœ¨éœ€è¦æ—¶å¯åŠ¨ï¼Œç”¨å®Œå°±é”€æ¯
- ğŸ§¹ **ç¯å¢ƒéš”ç¦»**ï¼šæ¯ä¸ªä»»åŠ¡éƒ½æœ‰ç‹¬ç«‹å¹²å‡€çš„ç¯å¢ƒ
- ğŸ“¦ **æ ‡å‡†åŒ–**ï¼šæ‰€æœ‰æ„å»ºç¯å¢ƒå®Œå…¨ä¸€è‡´
- ğŸ’° **èµ„æºèŠ‚çº¦**ï¼šä¸ç”¨çš„æ—¶å€™ä¸å ç”¨èµ„æº
- ğŸ”§ **çµæ´»é…ç½®**ï¼šå¯ä»¥ä¸ºä¸åŒé¡¹ç›®ä½¿ç”¨ä¸åŒçš„ç¯å¢ƒ

### 1.2 Docker Agentå·¥ä½œæµç¨‹


```
ğŸ”„ å®Œæ•´å·¥ä½œæµç¨‹ï¼š

1. è§¦å‘æ„å»º
   â†“
2. Jenkinsæ£€æŸ¥æ˜¯å¦éœ€è¦Agent
   â†“  
3. æ ¹æ®é…ç½®æ‹‰å–Dockeré•œåƒ
   â†“
4. åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨
   â†“
5. åœ¨å®¹å™¨å†…æ‰§è¡Œæ„å»ºä»»åŠ¡
   â†“
6. ä»»åŠ¡å®Œæˆï¼Œæ”¶é›†ç»“æœ
   â†“
7. è‡ªåŠ¨é”€æ¯å®¹å™¨
```

**å®é™…ä¾‹å­**ï¼š
> ğŸ“± **åœºæ™¯**ï¼šä½ è¦æ„å»ºä¸€ä¸ªNode.jsé¡¹ç›®
> 1. Jenkinsæ¥åˆ°æ„å»ºè¯·æ±‚
> 2. è‡ªåŠ¨æ‹‰å–`node:16-alpine`é•œåƒ
> 3. åˆ›å»ºå®¹å™¨ï¼Œå®¹å™¨å†…å·²ç»æœ‰Node.jsç¯å¢ƒ
> 4. åœ¨å®¹å™¨å†…æ‰§è¡Œ`npm install`å’Œ`npm run build`
> 5. æ„å»ºå®Œæˆï¼Œå®¹å™¨è‡ªåŠ¨åˆ é™¤

### 1.3 é€‚ç”¨åœºæ™¯åˆ†æ


| ğŸ¯ **é€‚ç”¨åœºæ™¯** | **ä¼ ç»ŸAgent** | **Docker Agent** |
|----------------|---------------|------------------|
| ğŸ—ï¸ **å¤šé¡¹ç›®æ„å»º** | âŒ ç¯å¢ƒå†²çª | âœ… å®Œå…¨éš”ç¦» |
| ğŸ”„ **å¶å‘æ„å»º** | âŒ èµ„æºæµªè´¹ | âœ… æŒ‰éœ€ä½¿ç”¨ |
| ğŸ› ï¸ **ç¯å¢ƒä¸€è‡´æ€§** | âŒ éš¾ä»¥ä¿è¯ | âœ… é•œåƒä¿è¯ |
| ğŸ§ª **æµ‹è¯•ç¯å¢ƒ** | âŒ æ±¡æŸ“é£é™© | âœ… æ¯æ¬¡å…¨æ–° |

---

## 2. ğŸ”§ Dockeræ’ä»¶å®‰è£…ä¸é…ç½®


### 2.1 Dockeræ’ä»¶å®‰è£…


**Step 1** ğŸš€ **æ’ä»¶å®‰è£…**ï¼š
1. è¿›å…¥Jenkinsç®¡ç†ç•Œé¢ï¼š`Manage Jenkins` â†’ `Manage Plugins`
2. æœç´¢å¹¶å®‰è£…ä»¥ä¸‹æ’ä»¶ï¼š
   - `Docker` - Dockeré›†æˆæ’ä»¶
   - `Docker Pipeline` - Pipelineä¸­çš„Dockeræ”¯æŒ
   - `Docker Commons` - Dockeré€šç”¨åŠŸèƒ½

**Step 2** âš™ï¸ **ç³»ç»Ÿé…ç½®**ï¼š
è¿›å…¥ `Manage Jenkins` â†’ `Configure System`

### 2.2 Docker Hosté…ç½®


**ğŸ”— è¿æ¥æ–¹å¼é…ç½®**ï¼š

**æœ¬åœ°Docker**ï¼ˆæœ€å¸¸ç”¨ï¼‰ï¼š
```
Docker Host URI: unix:///var/run/docker.sock
```
> ğŸ’¡ **è§£é‡Š**ï¼šè¿™æ˜¯å‘Šè¯‰Jenkins "Dockerå°±åœ¨æœ¬æœºä¸Šï¼Œé€šè¿‡è¿™ä¸ªsocketæ–‡ä»¶é€šä¿¡"

**è¿œç¨‹Docker**ï¼š
```
Docker Host URI: tcp://192.168.1.100:2376
```
> ğŸ’¡ **è§£é‡Š**ï¼šå¦‚æœDockeråœ¨å…¶ä»–æœºå™¨ä¸Šï¼Œå°±å¡«é‚£å°æœºå™¨çš„IPå’Œç«¯å£

**Dockerè¿æ¥æµ‹è¯•**ï¼š
é…ç½®å®Œæˆåç‚¹å‡»`Test Connection`æŒ‰é’®ï¼Œçœ‹åˆ°`Version = x.x.x`å°±è¡¨ç¤ºè¿æ¥æˆåŠŸã€‚

### 2.3 Docker Cloudé…ç½®


è¿›å…¥ `Manage Jenkins` â†’ `Manage Nodes and Clouds` â†’ `Configure Clouds`

**åŸºç¡€é…ç½®å‚æ•°**ï¼š
```
Name: docker-cloud
Docker Host URI: unix:///var/run/docker.sock
Enabled: âœ“ (å‹¾é€‰)
```

**é«˜çº§é…ç½®**ï¼š
- **Container Cap**: `10` - æœ€å¤šåŒæ—¶è¿è¡Œ10ä¸ªå®¹å™¨
- **Connect Timeout**: `60` - è¿æ¥è¶…æ—¶60ç§’
- **Read Timeout**: `60` - è¯»å–è¶…æ—¶60ç§’

---

## 3. ğŸ–¼ï¸ Dockeré•œåƒé…ç½®è¯¦è§£


### 3.1 é•œåƒé€‰æ‹©ç­–ç•¥


**ğŸ¯ é€‰æ‹©åˆé€‚çš„åŸºç¡€é•œåƒ**ï¼š

| é¡¹ç›®ç±»å‹ | æ¨èé•œåƒ | è¯´æ˜ |
|---------|---------|------|
| **Node.jsé¡¹ç›®** | `node:16-alpine` | è½»é‡çº§ï¼ŒåŒ…å«Node.js |
| **Javaé¡¹ç›®** | `openjdk:11-jdk` | åŒ…å«JDKç¼–è¯‘ç¯å¢ƒ |
| **Pythoné¡¹ç›®** | `python:3.9-slim` | è½»é‡çº§Pythonç¯å¢ƒ |
| **å‰ç«¯é¡¹ç›®** | `node:16-alpine` | é€‚åˆnpmæ„å»º |
| **é€šç”¨æ„å»º** | `jenkins/agent` | Jenkinså®˜æ–¹Agenté•œåƒ |

### 3.2 Docker Agent Templateé…ç½®


åœ¨Docker Cloudé…ç½®ä¸­æ·»åŠ `Docker Agent templates`ï¼š

**ğŸ”¸ åŸºç¡€é…ç½®**ï¼š
```
Labels: docker-node  # ç”¨äºPipelineä¸­æŒ‡å®š
Name: node-agent
Docker Image: node:16-alpine
Instance Capacity: 2  # è¿™ä¸ªæ¨¡æ¿æœ€å¤šåˆ›å»º2ä¸ªå®ä¾‹
```

**ğŸ”¸ é•œåƒæ‹‰å–é…ç½®**ï¼š
```
Pull strategy: Pull once and update latest
Pull timeout: 300  # 5åˆ†é’Ÿæ‹‰å–è¶…æ—¶
```

> ğŸ’¡ **Pull strategyè¯´æ˜**ï¼š
> - `Never pull`ï¼šä»ä¸æ‹‰å–ï¼Œä½¿ç”¨æœ¬åœ°é•œåƒ
> - `Pull once and update latest`ï¼šåªæ‹‰å–ä¸€æ¬¡ï¼Œå¦‚æœæ˜¯latestæ ‡ç­¾ä¼šæ›´æ–°
> - `Pull always`ï¼šæ¯æ¬¡éƒ½æ‹‰å–æœ€æ–°ç‰ˆæœ¬

### 3.3 é•œåƒè‡ªå®šä¹‰é…ç½®


**åˆ›å»ºè‡ªå®šä¹‰æ„å»ºé•œåƒ**ï¼š

```dockerfile
# ç¤ºä¾‹ï¼šè‡ªå®šä¹‰Node.jsæ„å»ºé•œåƒ
FROM node:16-alpine

# å®‰è£…å¸¸ç”¨æ„å»ºå·¥å…·
RUN apk add --no-cache \
    git \
    python3 \
    make \
    g++

# è®¾ç½®npmé•œåƒæº
RUN npm config set registry https://registry.npmmirror.com

# åˆ›å»ºå·¥ä½œç›®å½•
WORKDIR /workspace

# è®¾ç½®å®¹å™¨æ ‡ç­¾
LABEL maintainer="devops-team"
LABEL purpose="jenkins-node-build"
```

**ä½¿ç”¨è‡ªå®šä¹‰é•œåƒ**ï¼š
```
Docker Image: your-registry/jenkins-node-builder:latest
```

---

## 4. âš™ï¸ å®¹å™¨è¿è¡Œæ—¶é…ç½®


### 4.1 å®¹å™¨åŸºæœ¬è¿è¡Œå‚æ•°


**ğŸ”¸ Container settingsé…ç½®**ï¼š

```
Connect method: Connect with SSH  # è¿æ¥æ–¹å¼
User: jenkins  # å®¹å™¨å†…ç”¨æˆ·
```

**ğŸ”¸ Run optionsé…ç½®**ï¼š
```
# Dockerè¿è¡Œå‚æ•°
--rm  # å®¹å™¨åœæ­¢åè‡ªåŠ¨åˆ é™¤
--privileged=false  # ä¸ç»™äºˆç‰¹æƒ
--init  # ä½¿ç”¨initè¿›ç¨‹
```

> ğŸ’¡ **å‚æ•°è§£é‡Š**ï¼š
> - `--rm`ï¼šå°±åƒç”¨å®Œå³ç„šçš„é¤å…·ï¼Œå®¹å™¨ç”¨å®Œè‡ªåŠ¨æ¸…ç†
> - `--privileged`ï¼šæ˜¯å¦ç»™å®¹å™¨ç®¡ç†å‘˜æƒé™ï¼Œä¸€èˆ¬ä¸éœ€è¦
> - `--init`ï¼šè®©å®¹å™¨æœ‰ä¸ªç®¡å®¶è¿›ç¨‹ï¼Œå¤„ç†åƒµå°¸è¿›ç¨‹

### 4.2 å·¥ä½œç›®å½•é…ç½®


**Remote File System Root**ï¼š
```
/home/jenkins/workspace
```

> ğŸ“ **ä½œç”¨è¯´æ˜**ï¼šè¿™æ˜¯å®¹å™¨å†…Jenkinså·¥ä½œçš„"åŠå…¬å®¤"åœ°å€ï¼Œæ‰€æœ‰ä»£ç æ£€å‡ºå’Œæ„å»ºéƒ½åœ¨è¿™é‡Œè¿›è¡Œã€‚

### 4.3 å®¹å™¨ç”Ÿå‘½å‘¨æœŸé…ç½®


**ğŸ”¸ Idle termination time**ï¼š
```
ç©ºé—²ç»ˆæ­¢æ—¶é—´: 10  # 10åˆ†é’Ÿæ— ä»»åŠ¡è‡ªåŠ¨é”€æ¯
```

**ğŸ”¸ Usageé…ç½®**ï¼š
```
Usage: Use this node as much as possible
```

> â° **ç”Ÿå‘½å‘¨æœŸè¯´æ˜**ï¼š
> ```
> å®¹å™¨åˆ›å»º â†’ æ‰§è¡Œä»»åŠ¡ â†’ ç©ºé—²ç­‰å¾… â†’ è¶…æ—¶é”€æ¯
>    â†“          â†“         â†“         â†“
>   å¯åŠ¨       å·¥ä½œ      å¾…æœº      æ¸…ç†
> ```

---

## 5. ğŸ’¾ å·æŒ‚è½½ä¸æ•°æ®æŒä¹…åŒ–


### 5.1 å·æŒ‚è½½åŸºæœ¬æ¦‚å¿µ


**é€šä¿—ç†è§£**ï¼š
å·æŒ‚è½½å°±åƒåœ¨å®¹å™¨å’Œå®¿ä¸»æœºä¹‹é—´å¼€ä¸€æ‰‡é—¨ï¼Œè®©å®¹å™¨å¯ä»¥è®¿é—®å®¿ä¸»æœºçš„æ–‡ä»¶ï¼Œæˆ–è€…è®©å¤šä¸ªå®¹å™¨å…±äº«åŒä¸€ä¸ªæ–‡ä»¶å¤¹ã€‚

```
å®¿ä¸»æœºæ–‡ä»¶ç³»ç»Ÿ          å®¹å™¨æ–‡ä»¶ç³»ç»Ÿ
     ğŸ“                    ğŸ“
/var/jenkins_home  â†â†’  /home/jenkins
     ğŸ“                    ğŸ“  
/opt/cache         â†â†’  /cache
```

### 5.2 å¸¸ç”¨æŒ‚è½½é…ç½®


**ğŸ”¸ åœ¨Container settingsä¸­é…ç½®Volumes**ï¼š

**ç¼“å­˜ç›®å½•æŒ‚è½½**ï¼š
```
Host path: /var/jenkins_home/cache
Container path: /cache
```
> ğŸ’¡ **ç”¨é€”**ï¼šç¼“å­˜npm modulesã€mavenä¾èµ–ç­‰ï¼ŒåŠ é€Ÿæ„å»º

**Docker SocketæŒ‚è½½**ï¼ˆDocker in Dockerï¼‰ï¼š
```
Host path: /var/run/docker.sock
Container path: /var/run/docker.sock
```
> âš ï¸ **æ³¨æ„**ï¼šè¿™æ ·å®¹å™¨å†…å¯ä»¥æ“ä½œDockerï¼Œä½†è¦è°¨æ…ä½¿ç”¨

**å·¥å…·ç›®å½•æŒ‚è½½**ï¼š
```
Host path: /usr/local/bin
Container path: /usr/local/bin
Read only: âœ“
```

### 5.3 æ•°æ®æŒä¹…åŒ–ç­–ç•¥


**ğŸ“Š ä¸åŒæ•°æ®çš„å¤„ç†ç­–ç•¥**ï¼š

| æ•°æ®ç±»å‹ | æŒ‚è½½ç­–ç•¥ | åŸå›  |
|---------|---------|------|
| **æºä»£ç ** | âŒ ä¸æŒ‚è½½ | æ¯æ¬¡é‡æ–°æ£€å‡ºï¼Œä¿è¯å¹²å‡€ |
| **ä¾èµ–ç¼“å­˜** | âœ… æŒ‚è½½ | é¿å…é‡å¤ä¸‹è½½ï¼Œæå‡é€Ÿåº¦ |
| **æ„å»ºå·¥å…·** | âœ… åªè¯»æŒ‚è½½ | å…±äº«å®¿ä¸»æœºå·¥å…· |
| **æ„å»ºäº§ç‰©** | ğŸ“¤ æ„å»ºåä¼ è¾“ | é€šè¿‡archiveä¿å­˜ |

### 5.4 æŒ‚è½½é…ç½®ç¤ºä¾‹


**å®é™…é…ç½®æ¡ˆä¾‹**ï¼š
```
# åœ¨Docker Agent Templateçš„Volumesé…ç½®ï¼š

1. Mavenç¼“å­˜æŒ‚è½½
   Host: /var/jenkins_home/maven-cache
   Container: /root/.m2
   
2. NPMç¼“å­˜æŒ‚è½½  
   Host: /var/jenkins_home/npm-cache
   Container: /root/.npm
   
3. å·¥å…·æŒ‚è½½
   Host: /usr/bin/git
   Container: /usr/bin/git
   Read only: âœ“
```

---

## 6. ğŸŒ ç½‘ç»œé…ç½®ä¸å®‰å…¨è®¾ç½®


### 6.1 ç½‘ç»œæ¨¡å¼é€‰æ‹©


**ğŸ”¸ Networké…ç½®é€‰é¡¹**ï¼š

**é»˜è®¤ç½‘ç»œæ¨¡å¼**ï¼š
```
Network: bridge  # é»˜è®¤æ¡¥æ¥ç½‘ç»œ
```

**è‡ªå®šä¹‰ç½‘ç»œæ¨¡å¼**ï¼š
```
Network: jenkins-build-network  # è‡ªå®šä¹‰ç½‘ç»œ
```

> ğŸŒ **ç½‘ç»œæ¨¡å¼å¯¹æ¯”**ï¼š
> ```
> bridgeæ¨¡å¼ï¼š    å®¹å™¨ â†â†’ Dockerç½‘æ¡¥ â†â†’ å®¿ä¸»æœºç½‘ç»œ
> hostæ¨¡å¼ï¼š      å®¹å™¨ç›´æ¥ä½¿ç”¨å®¿ä¸»æœºç½‘ç»œ
> noneæ¨¡å¼ï¼š      å®¹å™¨æ— ç½‘ç»œè¿æ¥
> è‡ªå®šä¹‰ç½‘ç»œï¼š     å®¹å™¨ â†â†’ è‡ªå®šä¹‰ç½‘æ¡¥ â†â†’ å…¶ä»–å®¹å™¨
> ```

### 6.2 ç«¯å£æ˜ å°„é…ç½®


**ğŸ”¸ Port bindingsè®¾ç½®**ï¼š

**SSHç«¯å£æ˜ å°„**ï¼š
```
Host Port: 0  # 0è¡¨ç¤ºéšæœºåˆ†é…
Container Port: 22
```

**åº”ç”¨ç«¯å£æ˜ å°„**ï¼š
```
Host Port: 8080
Container Port: 8080
```

> ğŸ”Œ **ç«¯å£æ˜ å°„è¯´æ˜**ï¼š
> - `Host Port: 0`ï¼šè®©Dockerè‡ªåŠ¨åˆ†é…ç«¯å£ï¼Œé¿å…å†²çª
> - å›ºå®šç«¯å£ï¼šé€‚åˆéœ€è¦å¤–éƒ¨è®¿é—®çš„æœåŠ¡

### 6.3 å®‰å…¨é…ç½®


**ğŸ”’ å®‰å…¨è®¾ç½®æœ€ä½³å®è·µ**ï¼š

**Container settingså®‰å…¨é…ç½®**ï¼š
```
User: jenkins  # ä½¿ç”¨érootç”¨æˆ·
Privileged: âŒ # ä¸å¼€å¯ç‰¹æƒæ¨¡å¼
```

**ç¯å¢ƒéš”ç¦»**ï¼š
```
# åœ¨Pipelineä¸­é™åˆ¶ç½‘ç»œè®¿é—®
agent {
    docker {
        image 'node:16-alpine'
        args '--network none'  # æ— ç½‘ç»œè®¿é—®
    }
}
```

**èµ„æºå®‰å…¨é™åˆ¶**ï¼š
```
# åœ¨Run optionsä¸­æ·»åŠ 
--read-only  # åªè¯»æ–‡ä»¶ç³»ç»Ÿ
--tmpfs /tmp  # ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿ
--security-opt no-new-privileges  # ç¦æ­¢ææƒ
```

---

## 7. ğŸ“Š èµ„æºé™åˆ¶ä¸æ€§èƒ½ä¼˜åŒ–


### 7.1 CPUèµ„æºé™åˆ¶


**ğŸ”¸ CPUé…ç½®å‚æ•°**ï¼š

**åœ¨Run optionsä¸­é…ç½®**ï¼š
```
--cpus="2.0"  # é™åˆ¶ä½¿ç”¨2ä¸ªCPUæ ¸å¿ƒ
--cpu-shares=1024  # CPUæƒé‡ï¼Œé»˜è®¤1024
```

> ğŸ’» **CPUé™åˆ¶è¯´æ˜**ï¼š
> - `--cpus="2.0"`ï¼šæœ€å¤šä½¿ç”¨2ä¸ªCPUæ ¸å¿ƒçš„è®¡ç®—èƒ½åŠ›
> - `--cpu-shares`ï¼šå½“CPUä¸å¤Ÿæ—¶çš„ä¼˜å…ˆçº§æƒé‡

### 7.2 å†…å­˜èµ„æºé™åˆ¶


**å†…å­˜é™åˆ¶é…ç½®**ï¼š
```
--memory="2g"  # é™åˆ¶å†…å­˜ä½¿ç”¨2GB
--memory-swap="4g"  # å†…å­˜+äº¤æ¢åŒºæ€»å…±4GB
--oom-kill-disable=false  # å†…å­˜ä¸è¶³æ—¶å…è®¸killè¿›ç¨‹
```

> ğŸ§  **å†…å­˜ç®¡ç†ç­–ç•¥**ï¼š
> ```
> ç‰©ç†å†…å­˜: 2GB    |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ|
> äº¤æ¢å†…å­˜: 2GB    |â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘|
> æ€»å¯ç”¨:   4GB    |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ|
> ```

### 7.3 ç£ç›˜IOé™åˆ¶


**ç£ç›˜æ€§èƒ½é…ç½®**ï¼š
```
--device-read-bps /dev/sda:50mb  # è¯»å–é™åˆ¶50MB/s
--device-write-bps /dev/sda:30mb  # å†™å…¥é™åˆ¶30MB/s
```

### 7.4 æ€§èƒ½ä¼˜åŒ–é…ç½®


**ğŸš€ æ€§èƒ½ä¼˜åŒ–æœ€ä½³å®è·µ**ï¼š

**1. é•œåƒä¼˜åŒ–**ï¼š
```yaml
# ä½¿ç”¨å¤šé˜¶æ®µæ„å»º
FROM node:16-alpine as builder
COPY package.json .
RUN npm ci --only=production

FROM node:16-alpine
COPY --from=builder /app .
```

**2. ç¼“å­˜ç­–ç•¥**ï¼š
```
# é…ç½®æ„å»ºç¼“å­˜æŒ‚è½½
Host: /var/jenkins_home/docker-cache
Container: /var/cache
```

**3. å¹¶å‘æ§åˆ¶**ï¼š
```
Instance Capacity: 3  # å•ä¸ªæ¨¡æ¿æœ€å¤š3ä¸ªå®ä¾‹
Container Cap: 10     # æ€»å®¹å™¨æ•°é‡é™åˆ¶
```

**ğŸ“ˆ èµ„æºé…ç½®å‚è€ƒè¡¨**ï¼š

| é¡¹ç›®è§„æ¨¡ | CPUé™åˆ¶ | å†…å­˜é™åˆ¶ | å¹¶å‘æ•° | é€‚ç”¨åœºæ™¯ |
|---------|---------|---------|--------|----------|
| **å°å‹é¡¹ç›®** | 1 core | 1GB | 2-3ä¸ª | ç®€å•å‰ç«¯é¡¹ç›® |
| **ä¸­å‹é¡¹ç›®** | 2 cores | 2GB | 1-2ä¸ª | Node.js/Javaé¡¹ç›® |
| **å¤§å‹é¡¹ç›®** | 4 cores | 4GB | 1ä¸ª | å¤æ‚ç¼–è¯‘é¡¹ç›® |

---

## 8. ğŸ”§ ç¯å¢ƒå˜é‡ä¸å‚æ•°ä¼ é€’


### 8.1 ç¯å¢ƒå˜é‡é…ç½®æ–¹å¼


**ğŸ”¸ å…¨å±€ç¯å¢ƒå˜é‡**ï¼š
åœ¨Docker Agent Templateçš„`Environment Variables`ä¸­é…ç½®ï¼š

```
NODE_ENV=production
BUILD_ENV=docker
JENKINS_AGENT=true
```

**ğŸ”¸ Pipelineä¸­åŠ¨æ€è®¾ç½®**ï¼š
```groovy
pipeline {
    agent {
        docker {
            image 'node:16-alpine'
            args '-e NODE_ENV=production -e BUILD_TYPE=release'
        }
    }
    stages {
        stage('Build') {
            steps {
                script {
                    sh 'echo "å½“å‰ç¯å¢ƒ: $NODE_ENV"'
                    sh 'echo "æ„å»ºç±»å‹: $BUILD_TYPE"'
                }
            }
        }
    }
}
```

### 8.2 å¸¸ç”¨ç¯å¢ƒå˜é‡é…ç½®


**ğŸ”¸ æ„å»ºç¯å¢ƒå˜é‡**ï¼š
```bash
# æ—¶åŒºè®¾ç½®
TZ=Asia/Shanghai

# è¯­è¨€è®¾ç½®  
LANG=C.UTF-8
LC_ALL=C.UTF-8

# å·¥å…·é…ç½®
MAVEN_OPTS=-Xmx2g
NODE_OPTIONS=--max-old-space-size=4096

# ç¼“å­˜ç›®å½•
NPM_CONFIG_CACHE=/cache/npm
MAVEN_OPTS=-Dmaven.repo.local=/cache/maven
```

### 8.3 æ•æ„Ÿä¿¡æ¯å¤„ç†


**ğŸ”’ å®‰å…¨çš„å‚æ•°ä¼ é€’**ï¼š

**ä½¿ç”¨Jenkinså‡­æ®**ï¼š
```groovy
pipeline {
    agent {
        docker {
            image 'node:16-alpine'
        }
    }
    environment {
        API_KEY = credentials('api-key-id')
        DB_PASSWORD = credentials('db-password')
    }
    stages {
        stage('Deploy') {
            steps {
                sh '''
                    echo "APIå¯†é’¥å·²è®¾ç½®"
                    # ä½¿ç”¨ $API_KEY ä½†ä¸ä¼šåœ¨æ—¥å¿—ä¸­æ˜¾ç¤º
                '''
            }
        }
    }
}
```

**æ–‡ä»¶æŒ‚è½½æ–¹å¼**ï¼š
```
# æŒ‚è½½é…ç½®æ–‡ä»¶è€Œéç¯å¢ƒå˜é‡
Host path: /var/jenkins_home/secrets/config.json
Container path: /app/config.json
Read only: âœ“
```

### 8.4 å‚æ•°éªŒè¯ä¸é»˜è®¤å€¼


**ç¯å¢ƒå˜é‡éªŒè¯**ï¼š
```groovy
pipeline {
    agent {
        docker { image 'node:16-alpine' }
    }
    stages {
        stage('Validate') {
            steps {
                script {
                    // æ£€æŸ¥å¿…éœ€çš„ç¯å¢ƒå˜é‡
                    if (!env.NODE_ENV) {
                        error('NODE_ENV environment variable is required')
                    }
                    
                    // è®¾ç½®é»˜è®¤å€¼
                    env.BUILD_TYPE = env.BUILD_TYPE ?: 'debug'
                    
                    echo "ç¯å¢ƒ: ${env.NODE_ENV}"
                    echo "æ„å»ºç±»å‹: ${env.BUILD_TYPE}"
                }
            }
        }
    }
}
```

---

## 9. ğŸ§¹ å®¹å™¨æ¸…ç†ç­–ç•¥


### 9.1 è‡ªåŠ¨æ¸…ç†é…ç½®


**ğŸ”¸ å®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†**ï¼š

**ç©ºé—²ç»ˆæ­¢è®¾ç½®**ï¼š
```
Idle termination time: 10 minutes
```
> â° **è§£é‡Š**ï¼šå®¹å™¨ç©ºé—²10åˆ†é’Ÿåè‡ªåŠ¨é”€æ¯ï¼Œé‡Šæ”¾èµ„æº

**è¿æ¥ä¿æŒé…ç½®**ï¼š
```
Connection timeout: 60 seconds
```

### 9.2 é•œåƒæ¸…ç†ç­–ç•¥


**ğŸ”¸ é•œåƒç¼“å­˜ç®¡ç†**ï¼š

**æ‰‹åŠ¨æ¸…ç†è„šæœ¬**ï¼š
```bash
#!/bin/bash
# jenkins-cleanup.sh

echo "ğŸ§¹ å¼€å§‹æ¸…ç†Jenkins Dockerèµ„æº..."

# æ¸…ç†åœæ­¢çš„å®¹å™¨
docker container prune -f

# æ¸…ç†æœªä½¿ç”¨çš„é•œåƒ
docker image prune -f

# æ¸…ç†æœªä½¿ç”¨çš„å·
docker volume prune -f

# æ¸…ç†æœªä½¿ç”¨çš„ç½‘ç»œ
docker network prune -f

echo "âœ… æ¸…ç†å®Œæˆï¼"
```

**å®šæœŸæ¸…ç†Cronä»»åŠ¡**ï¼š
```bash
# æ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œæ¸…ç†
0 2 * * * /opt/jenkins/scripts/jenkins-cleanup.sh
```

### 9.3 èµ„æºç›‘æ§ä¸å‘Šè­¦


**ğŸ”¸ å®¹å™¨èµ„æºç›‘æ§**ï¼š

**Dockerç³»ç»Ÿç›‘æ§**ï¼š
```bash
# æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨
docker stats --no-stream

# æŸ¥çœ‹ç³»ç»Ÿç£ç›˜ä½¿ç”¨
docker system df

# æŸ¥çœ‹è¯¦ç»†ç©ºé—´ä½¿ç”¨
docker system df -v
```

**å‘Šè­¦é˜ˆå€¼é…ç½®**ï¼š
```yaml
# ç›‘æ§é…ç½®ç¤ºä¾‹
alerts:
  disk_usage: 80%    # ç£ç›˜ä½¿ç”¨è¶…è¿‡80%å‘Šè­¦
  container_count: 15  # å®¹å™¨æ•°é‡è¶…è¿‡15ä¸ªå‘Šè­¦
  memory_usage: 85%    # å†…å­˜ä½¿ç”¨è¶…è¿‡85%å‘Šè­¦
```

### 9.4 æ•°æ®å¤‡ä»½ä¸æ¢å¤


**ğŸ”¸ é‡è¦æ•°æ®ä¿æŠ¤**ï¼š

**æ„å»ºäº§ç‰©ä¿å­˜**ï¼š
```groovy
pipeline {
    agent {
        docker { image 'node:16-alpine' }
    }
    post {
        always {
            // ä¿å­˜æ„å»ºäº§ç‰©
            archiveArtifacts artifacts: 'dist/**', fingerprint: true
            
            // ä¿å­˜æµ‹è¯•æŠ¥å‘Š
            publishHTML([
                allowMissing: false,
                alwaysLinkToLastBuild: true,
                keepAll: true,
                reportDir: 'coverage',
                reportFiles: 'index.html',
                reportName: 'Coverage Report'
            ])
        }
    }
}
```

**é…ç½®å¤‡ä»½ç­–ç•¥**ï¼š
```bash
# å¤‡ä»½Jenkinsé…ç½®
tar -czf jenkins-config-$(date +%Y%m%d).tar.gz /var/jenkins_home/jobs
```

---

## 10. ğŸš€ å®æˆ˜é…ç½®ç¤ºä¾‹


### 10.1 å‰ç«¯é¡¹ç›®æ„å»ºé…ç½®


**ğŸ¯ Node.jsé¡¹ç›®å®Œæ•´é…ç½®**ï¼š

**Docker Agent Templateé…ç½®**ï¼š
```
Name: frontend-builder
Labels: frontend nodejs
Docker Image: node:16-alpine
Instance Capacity: 3
Remote File System Root: /home/jenkins

Environment Variables:
NODE_ENV=production
NPM_CONFIG_CACHE=/cache/npm
CI=true

Volumes:
/var/jenkins_home/npm-cache â†’ /cache/npm
/var/jenkins_home/node_modules â†’ /cache/node_modules

Run options:
--rm --memory="2g" --cpus="2.0"
```

**Pipelineä½¿ç”¨ç¤ºä¾‹**ï¼š
```groovy
pipeline {
    agent {
        label 'frontend'
    }
    
    stages {
        stage('å®‰è£…ä¾èµ–') {
            steps {
                sh '''
                    echo "ğŸ“¦ å®‰è£…é¡¹ç›®ä¾èµ–..."
                    npm ci --cache /cache/npm
                '''
            }
        }
        
        stage('ä»£ç æ£€æŸ¥') {
            steps {
                sh '''
                    echo "ğŸ” æ‰§è¡Œä»£ç æ£€æŸ¥..."
                    npm run lint
                '''
            }
        }
        
        stage('è¿è¡Œæµ‹è¯•') {
            steps {
                sh '''
                    echo "ğŸ§ª æ‰§è¡Œå•å…ƒæµ‹è¯•..."
                    npm run test:ci
                '''
            }
        }
        
        stage('æ„å»ºé¡¹ç›®') {
            steps {
                sh '''
                    echo "ğŸ—ï¸ æ„å»ºç”Ÿäº§ç‰ˆæœ¬..."
                    npm run build
                '''
            }
        }
    }
    
    post {
        always {
            // ä¿å­˜æ„å»ºäº§ç‰©
            archiveArtifacts artifacts: 'dist/**', fingerprint: true
        }
    }
}
```

### 10.2 Javaé¡¹ç›®æ„å»ºé…ç½®


**â˜• Java Mavené¡¹ç›®é…ç½®**ï¼š

**Docker Agent Templateé…ç½®**ï¼š
```
Name: java-builder
Labels: java maven
Docker Image: openjdk:11-jdk
Instance Capacity: 2

Environment Variables:
MAVEN_OPTS=-Xmx2g -XX:+UseG1GC
JAVA_OPTS=-Dfile.encoding=UTF-8

Volumes:
/var/jenkins_home/maven-repo â†’ /root/.m2/repository
/var/jenkins_home/maven-cache â†’ /root/.m2

Run options:
--rm --memory="4g" --cpus="3.0"
```

**Pipelineé…ç½®**ï¼š
```groovy
pipeline {
    agent {
        label 'java'
    }
    
    tools {
        maven 'Maven-3.8'
        jdk 'OpenJDK-11'
    }
    
    stages {
        stage('ç¼–è¯‘') {
            steps {
                sh '''
                    echo "ğŸ”¨ ç¼–è¯‘Javaé¡¹ç›®..."
                    mvn clean compile -Dmaven.repo.local=/root/.m2/repository
                '''
            }
        }
        
        stage('æµ‹è¯•') {
            steps {
                sh '''
                    echo "ğŸ§ª æ‰§è¡Œå•å…ƒæµ‹è¯•..."
                    mvn test -Dmaven.repo.local=/root/.m2/repository
                '''
            }
            post {
                always {
                    junit 'target/surefire-reports/*.xml'
                }
            }
        }
        
        stage('æ‰“åŒ…') {
            steps {
                sh '''
                    echo "ğŸ“¦ æ‰“åŒ…åº”ç”¨..."
                    mvn package -DskipTests -Dmaven.repo.local=/root/.m2/repository
                '''
            }
        }
    }
}
```

### 10.3 å¤šç¯å¢ƒæ„å»ºé…ç½®


**ğŸ”„ å¤šç¯å¢ƒéƒ¨ç½²Pipeline**ï¼š

```groovy
pipeline {
    agent {
        docker {
            image 'node:16-alpine'
            args '--rm -v /var/jenkins_home/cache:/cache'
        }
    }
    
    parameters {
        choice(
            name: 'DEPLOY_ENV',
            choices: ['dev', 'staging', 'production'],
            description: 'é€‰æ‹©éƒ¨ç½²ç¯å¢ƒ'
        )
        booleanParam(
            name: 'RUN_TESTS',
            defaultValue: true,
            description: 'æ˜¯å¦æ‰§è¡Œæµ‹è¯•'
        )
    }
    
    environment {
        NODE_ENV = "${params.DEPLOY_ENV}"
        BUILD_NUMBER = "${env.BUILD_NUMBER}"
    }
    
    stages {
        stage('ç¯å¢ƒå‡†å¤‡') {
            steps {
                script {
                    echo "ğŸš€ å‡†å¤‡${params.DEPLOY_ENV}ç¯å¢ƒæ„å»º..."
                    
                    // æ ¹æ®ç¯å¢ƒè®¾ç½®ä¸åŒé…ç½®
                    if (params.DEPLOY_ENV == 'production') {
                        env.BUILD_TYPE = 'release'
                        env.OPTIMIZE = 'true'
                    } else {
                        env.BUILD_TYPE = 'debug'  
                        env.OPTIMIZE = 'false'
                    }
                }
            }
        }
        
        stage('æ„å»º') {
            steps {
                sh '''
                    echo "ğŸ—ï¸ æ„å»ºç¯å¢ƒ: $NODE_ENV"
                    echo "ğŸ—ï¸ æ„å»ºç±»å‹: $BUILD_TYPE"
                    
                    npm ci --cache /cache/npm
                    npm run build:$NODE_ENV
                '''
            }
        }
        
        stage('æµ‹è¯•') {
            when {
                expression { params.RUN_TESTS == true }
            }
            steps {
                sh '''
                    echo "ğŸ§ª æ‰§è¡Œæµ‹è¯•..."
                    npm run test
                '''
            }
        }
        
        stage('éƒ¨ç½²') {
            steps {
                script {
                    echo "ğŸš€ éƒ¨ç½²åˆ°${params.DEPLOY_ENV}ç¯å¢ƒ..."
                    
                    if (params.DEPLOY_ENV == 'production') {
                        input message: 'ç¡®è®¤éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼Ÿ', ok: 'ç¡®è®¤éƒ¨ç½²'
                    }
                    
                    sh "npm run deploy:${params.DEPLOY_ENV}"
                }
            }
        }
    }
    
    post {
        success {
            echo "âœ… ${params.DEPLOY_ENV}ç¯å¢ƒéƒ¨ç½²æˆåŠŸï¼"
        }
        failure {
            echo "âŒ ${params.DEPLOY_ENV}ç¯å¢ƒéƒ¨ç½²å¤±è´¥ï¼"
        }
    }
}
```

---

## 11. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 11.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Docker Agentæœ¬è´¨ï¼šæŒ‰éœ€åˆ›å»ºçš„ä¸´æ—¶æ„å»ºç¯å¢ƒ
ğŸ”¸ æ’ä»¶é…ç½®ï¼šDocker + Docker Pipeline + Docker Commons
ğŸ”¸ é•œåƒé€‰æ‹©ï¼šæ ¹æ®é¡¹ç›®æŠ€æœ¯æ ˆé€‰æ‹©åˆé€‚çš„åŸºç¡€é•œåƒ
ğŸ”¸ èµ„æºç®¡ç†ï¼šCPUã€å†…å­˜ã€ç£ç›˜IOçš„åˆç†é™åˆ¶
ğŸ”¸ æ•°æ®æŒä¹…åŒ–ï¼šç¼“å­˜æŒ‚è½½æå‡æ„å»ºæ•ˆç‡
ğŸ”¸ å®‰å…¨é…ç½®ï¼šéç‰¹æƒç”¨æˆ·ã€ç½‘ç»œéš”ç¦»ã€èµ„æºé™åˆ¶
ğŸ”¸ æ¸…ç†ç­–ç•¥ï¼šè‡ªåŠ¨æ¸…ç†å®¹å™¨å’Œé•œåƒï¼Œé¿å…èµ„æºæµªè´¹
```

### 11.2 å…³é”®é…ç½®è¦ç‚¹


**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥**ï¼š
```
é•œåƒä¼˜åŒ–ï¼š
â€¢ é€‰æ‹©è½»é‡çº§åŸºç¡€é•œåƒï¼ˆalpineç³»åˆ—ï¼‰
â€¢ ä½¿ç”¨å¤šé˜¶æ®µæ„å»ºå‡å°‘é•œåƒå¤§å°
â€¢ é¢„è£…å¸¸ç”¨å·¥å…·é¿å…é‡å¤ä¸‹è½½

ç¼“å­˜ç­–ç•¥ï¼š
â€¢ æŒ‚è½½ä¾èµ–ç¼“å­˜ç›®å½•ï¼ˆnpmã€mavenï¼‰
â€¢ ä½¿ç”¨Dockerå±‚ç¼“å­˜
â€¢ é…ç½®åˆç†çš„é•œåƒæ‹‰å–ç­–ç•¥

èµ„æºåˆ†é…ï¼š
â€¢ æ ¹æ®é¡¹ç›®è§„æ¨¡è®¾ç½®CPUå’Œå†…å­˜é™åˆ¶
â€¢ æ§åˆ¶å¹¶å‘å®¹å™¨æ•°é‡é¿å…èµ„æºç«äº‰
â€¢ è®¾ç½®åˆç†çš„å®¹å™¨ç©ºé—²æ—¶é—´
```

**ğŸ”¹ å®‰å…¨æœ€ä½³å®è·µ**ï¼š
```
æƒé™æ§åˆ¶ï¼š
â€¢ ä½¿ç”¨érootç”¨æˆ·è¿è¡Œå®¹å™¨
â€¢ ä¸å¼€å¯ç‰¹æƒæ¨¡å¼
â€¢ åªè¯»æŒ‚è½½ç³»ç»Ÿç›®å½•

ç½‘ç»œå®‰å…¨ï¼š
â€¢ ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œéš”ç¦»
â€¢ é™åˆ¶å®¹å™¨ç½‘ç»œè®¿é—®
â€¢ æ•æ„Ÿä¿¡æ¯ä½¿ç”¨Jenkinså‡­æ®ç®¡ç†

æ•°æ®ä¿æŠ¤ï¼š
â€¢ æ„å»ºäº§ç‰©åŠæ—¶å½’æ¡£
â€¢ æ•æ„Ÿé…ç½®æ–‡ä»¶å•ç‹¬æŒ‚è½½
â€¢ å®šæœŸå¤‡ä»½é‡è¦æ•°æ®
```

### 11.3 å¸¸è§é—®é¢˜è§£å†³


**â“ å¸¸è§é…ç½®é—®é¢˜**ï¼š

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| **å®¹å™¨å¯åŠ¨å¤±è´¥** | é•œåƒä¸å­˜åœ¨æˆ–æƒé™é—®é¢˜ | æ£€æŸ¥é•œåƒåç§°ï¼Œç¡®è®¤Dockerè¿æ¥ |
| **æ„å»ºé€Ÿåº¦æ…¢** | æ²¡æœ‰é…ç½®ç¼“å­˜ | æŒ‚è½½ä¾èµ–ç¼“å­˜ç›®å½• |
| **èµ„æºä¸è¶³** | å®¹å™¨é™åˆ¶è¿‡ä½ | å¢åŠ CPUå’Œå†…å­˜é™åˆ¶ |
| **ç½‘ç»œè¿æ¥é—®é¢˜** | ç½‘ç»œé…ç½®é”™è¯¯ | æ£€æŸ¥ç½‘ç»œæ¨¡å¼å’ŒDNSè®¾ç½® |

**ğŸ”§ è°ƒè¯•æŠ€å·§**ï¼š
```bash
# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs <container_id>

# è¿›å…¥è¿è¡Œä¸­çš„å®¹å™¨
docker exec -it <container_id> /bin/sh

# æ£€æŸ¥å®¹å™¨èµ„æºä½¿ç”¨
docker stats <container_id>

# æµ‹è¯•é•œåƒæ˜¯å¦æ­£å¸¸
docker run --rm -it <image_name> /bin/sh
```

### 11.4 å®é™…åº”ç”¨ä»·å€¼


- **ç¯å¢ƒä¸€è‡´æ€§**ï¼šæ¯æ¬¡æ„å»ºéƒ½ä½¿ç”¨ç›¸åŒçš„ç¯å¢ƒï¼Œé¿å…"åœ¨æˆ‘æœºå™¨ä¸Šèƒ½è·‘"çš„é—®é¢˜
- **èµ„æºæ•ˆç‡**ï¼šæŒ‰éœ€åˆ›å»ºé”€æ¯ï¼Œæ¯”ä¼ ç»Ÿå›ºå®šAgentèŠ‚çœèµ„æº
- **æ‰©å±•æ€§å¼º**ï¼šå¯ä»¥æ ¹æ®è´Ÿè½½è‡ªåŠ¨æ‰©å®¹ï¼Œæ”¯æŒå¤§è§„æ¨¡å¹¶å‘æ„å»º
- **ç»´æŠ¤ç®€å•**ï¼šä¸éœ€è¦ç»´æŠ¤æ„å»ºæœåŠ¡å™¨ç¯å¢ƒï¼Œä¸€åˆ‡éƒ½åœ¨ä»£ç ä¸­å®šä¹‰

**ğŸ¯ é€‚ç”¨åœºæ™¯**ï¼š
- **å¤šæŠ€æœ¯æ ˆé¡¹ç›®**ï¼šä¸åŒé¡¹ç›®ä½¿ç”¨ä¸åŒçš„æ„å»ºç¯å¢ƒ
- **ä¸´æ—¶æ„å»ºéœ€æ±‚**ï¼šå¶å‘çš„æ„å»ºä»»åŠ¡ï¼Œä¸æƒ³å ç”¨å›ºå®šèµ„æº
- **ç¯å¢ƒéš”ç¦»éœ€æ±‚**ï¼šéœ€è¦å®Œå…¨éš”ç¦»çš„æ„å»ºç¯å¢ƒ
- **äº‘åŸç”Ÿé¡¹ç›®**ï¼šå®¹å™¨åŒ–éƒ¨ç½²çš„é¡¹ç›®å¤©ç„¶é€‚åˆ

**æ ¸å¿ƒè®°å¿†**ï¼š
- Docker Agent = æŒ‰éœ€åˆ›å»ºçš„ä¸´æ—¶å·¥ä½œç¯å¢ƒ
- é•œåƒé€‰æ‹©è¦åŒ¹é…é¡¹ç›®æŠ€æœ¯æ ˆ
- ç¼“å­˜æŒ‚è½½æ˜¯æå‡æ„å»ºé€Ÿåº¦çš„å…³é”®
- èµ„æºé™åˆ¶é˜²æ­¢å•ä¸ªæ„å»ºå½±å“æ•´ä½“æ€§èƒ½
- å®‰å…¨é…ç½®ä¿æŠ¤ç³»ç»Ÿå’Œæ•°æ®å®‰å…¨
- è‡ªåŠ¨æ¸…ç†é¿å…èµ„æºæµªè´¹