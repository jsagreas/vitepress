---
title: 4ã€ä»£ç è´¨é‡æ£€æŸ¥
---
## ğŸ“š ç›®å½•


1. [ä»£ç è´¨é‡æ£€æŸ¥æ¦‚è¿°](#1-ä»£ç è´¨é‡æ£€æŸ¥æ¦‚è¿°)
2. [ä»£ç æ£€å‡ºç­–ç•¥](#2-ä»£ç æ£€å‡ºç­–ç•¥)
3. [å˜æ›´æ£€æµ‹æœºåˆ¶](#3-å˜æ›´æ£€æµ‹æœºåˆ¶)
4. [ä»£ç åˆå¹¶æ£€æŸ¥](#4-ä»£ç åˆå¹¶æ£€æŸ¥)
5. [Pull Requestæ„å»º](#5-pull-requestæ„å»º)
6. [ä»£ç è´¨é‡é—¨ç¦](#6-ä»£ç è´¨é‡é—¨ç¦)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” ä»£ç è´¨é‡æ£€æŸ¥æ¦‚è¿°



### 1.1 ä»€ä¹ˆæ˜¯ä»£ç è´¨é‡æ£€æŸ¥



**ğŸ¯ ç®€å•ç†è§£**ï¼šä»£ç è´¨é‡æ£€æŸ¥å°±åƒæ˜¯ç»™ä»£ç åš"ä½“æ£€"ï¼Œè‡ªåŠ¨æ£€æŸ¥ä»£ç æœ‰æ²¡æœ‰é—®é¢˜

```
ä¼ ç»Ÿå¼€å‘æ¨¡å¼ï¼š
å¼€å‘è€…å†™ä»£ç  â†’ æ‰‹åŠ¨æµ‹è¯• â†’ å‘ç°é—®é¢˜ â†’ ä¿®æ”¹ä»£ç 
é—®é¢˜ï¼šå‘ç°é—®é¢˜å¤ªæ™šï¼Œä¿®å¤æˆæœ¬é«˜

CI/CDæ¨¡å¼ï¼š
å¼€å‘è€…å†™ä»£ç  â†’ è‡ªåŠ¨æ£€æŸ¥ â†’ ç«‹å³å‘ç°é—®é¢˜ â†’ å¿«é€Ÿä¿®å¤
ä¼˜åŠ¿ï¼šé—®é¢˜æ—©å‘ç°ï¼Œä¿®å¤æˆæœ¬ä½
```

### 1.2 ä¸ºä»€ä¹ˆè¦åšä»£ç è´¨é‡æ£€æŸ¥



**ğŸ’¡ å®é™…ä»·å€¼**ï¼š
- **æå‰å‘ç°é—®é¢˜**ï¼šåœ¨ä»£ç åˆå¹¶å‰å°±å‘ç°æ½œåœ¨bug
- **ç»Ÿä¸€ä»£ç è§„èŒƒ**ï¼šç¡®ä¿å›¢é˜Ÿä»£ç é£æ ¼ä¸€è‡´
- **å‡å°‘äººå·¥å®¡æŸ¥è´Ÿæ‹…**ï¼šæœºå™¨å…ˆç­›é€‰ï¼Œäººå·¥é‡ç‚¹å…³æ³¨
- **æé«˜ä»£ç è´¨é‡**ï¼šé•¿æœŸç»´æŠ¤é¡¹ç›®çš„ä»£ç å¥åº·åº¦

### 1.3 Jenkinsä¸­çš„è´¨é‡æ£€æŸ¥æµç¨‹



```
ä»£ç æäº¤æµç¨‹å›¾ï¼š

å¼€å‘è€…æœ¬åœ°         Gitä»“åº“           JenkinsæœåŠ¡å™¨        è´¨é‡æ£€æŸ¥å·¥å…·
    |                 |                    |                    |
    |--[1]æäº¤ä»£ç ---->|                    |                    |
    |                 |--[2]è§¦å‘æ„å»º------>|                    |
    |                 |                    |--[3]æ£€å‡ºä»£ç ------>|
    |                 |                    |<--[4]æ£€æŸ¥ç»“æœ------|
    |                 |<--[5]åé¦ˆç»“æœ------|                    |
    |<--[6]é€šçŸ¥ç»“æœ----|                    |                    |
```

**ğŸ­ æ ¸å¿ƒæ£€æŸ¥ç±»å‹**ï¼š
- `ğŸ”¸ è¯­æ³•æ£€æŸ¥`ï¼šä»£ç æ˜¯å¦ç¬¦åˆè¯­æ³•è§„èŒƒ
- `ğŸ”¸ é£æ ¼æ£€æŸ¥`ï¼šä»£ç æ ¼å¼æ˜¯å¦ç»Ÿä¸€
- `ğŸ”¸ å®‰å…¨æ£€æŸ¥`ï¼šæ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´
- `ğŸ”¸ é‡å¤åº¦æ£€æŸ¥`ï¼šæ˜¯å¦æœ‰é‡å¤ä»£ç 
- `ğŸ”¸ å¤æ‚åº¦æ£€æŸ¥`ï¼šä»£ç æ˜¯å¦è¿‡äºå¤æ‚

---

## 2. ğŸ“ ä»£ç æ£€å‡ºç­–ç•¥



### 2.1 ä»€ä¹ˆæ˜¯ä»£ç æ£€å‡ºç­–ç•¥



**ğŸ’­ é€šä¿—è§£é‡Š**ï¼šä»£ç æ£€å‡ºç­–ç•¥å°±æ˜¯Jenkinsä»Gitä»“åº“è·å–ä»£ç çš„"æ–¹å¼æ–¹æ³•"

**ğŸ”§ å¸¸è§ç­–ç•¥å¯¹æ¯”**ï¼š

| ç­–ç•¥ç±»å‹ | **å·¥ä½œåŸç†** | **ä½¿ç”¨åœºæ™¯** | **ä¼˜ç¼ºç‚¹** |
|---------|------------|-------------|-----------|
| ğŸ”„ **å®Œæ•´æ£€å‡º** | `ä¸‹è½½å®Œæ•´ä»£ç åº“` | `é¦–æ¬¡æ„å»ºã€å¤§å˜æ›´` | `âœ… å®Œæ•´ âŒ æ…¢` |
| âš¡ **å¢é‡æ£€å‡º** | `åªä¸‹è½½å˜æ›´éƒ¨åˆ†` | `æ—¥å¸¸å¼€å‘æ„å»º` | `âœ… å¿«é€Ÿ âŒ å¯èƒ½ä¸å®Œæ•´` |
| ğŸ¯ **æµ…å…‹éš†** | `åªä¸‹è½½æœ€æ–°ç‰ˆæœ¬` | `å¿«é€ŸéªŒè¯` | `âœ… æå¿« âŒ ç¼ºå°‘å†å²` |
| ğŸ“¦ **ç¨€ç–æ£€å‡º** | `åªä¸‹è½½æŒ‡å®šç›®å½•` | `å¤§å‹é¡¹ç›®éƒ¨åˆ†æ„å»º` | `âœ… èŠ‚çœç©ºé—´ âŒ é…ç½®å¤æ‚` |

### 2.2 Jenkinsä¸­çš„æ£€å‡ºé…ç½®



**ğŸ”§ åŸºç¡€æ£€å‡ºé…ç½®**ï¼š
```groovy
pipeline {
    agent any
    stages {
        stage('ä»£ç æ£€å‡º') {
            steps {
                // æ ‡å‡†Gitæ£€å‡º
                git branch: 'main', 
                    credentialsId: 'git-credentials',
                    url: 'https://github.com/your-project.git'
                
                // æ˜¾ç¤ºæ£€å‡ºä¿¡æ¯
                sh 'git log --oneline -5'
            }
        }
    }
}
```

**âš¡ ä¼˜åŒ–æ£€å‡ºç­–ç•¥**ï¼š
```groovy
pipeline {
    agent any
    stages {
        stage('æ™ºèƒ½æ£€å‡º') {
            steps {
                script {
                    // æ£€æŸ¥æ˜¯å¦ä¸ºé¦–æ¬¡æ„å»º
                    if (env.BUILD_NUMBER == '1') {
                        echo "ğŸš€ é¦–æ¬¡æ„å»ºï¼Œæ‰§è¡Œå®Œæ•´æ£€å‡º"
                        checkout scm
                    } else {
                        echo "âš¡ å¢é‡æ„å»ºï¼Œä¼˜åŒ–æ£€å‡º"
                        checkout([
                            $class: 'GitSCM',
                            branches: [[name: '*/main']],
                            extensions: [
                                [$class: 'CloneOption', 
                                 shallow: true, 
                                 depth: 1]
                            ]
                        ])
                    }
                }
            }
        }
    }
}
```

### 2.3 æ£€å‡ºç­–ç•¥æœ€ä½³å®è·µ



**ğŸ“‹ é€‰æ‹©æŒ‡å—**ï¼š

```
é¡¹ç›®è§„æ¨¡åˆ¤æ–­ï¼š
â”œâ”€â”€ å°å‹é¡¹ç›® (< 100MB)
â”‚   â””â”€â”€ æ¨èï¼šå®Œæ•´æ£€å‡º
â”‚       â””â”€â”€ åŸå› ï¼šé€Ÿåº¦å·®å¼‚ä¸å¤§ï¼Œä¿è¯å®Œæ•´æ€§
â”‚
â”œâ”€â”€ ä¸­å‹é¡¹ç›® (100MB - 1GB)  
â”‚   â””â”€â”€ æ¨èï¼šæµ…å…‹éš† + å¢é‡æ›´æ–°
â”‚       â””â”€â”€ åŸå› ï¼šå¹³è¡¡é€Ÿåº¦å’Œå®Œæ•´æ€§
â”‚
â””â”€â”€ å¤§å‹é¡¹ç›® (> 1GB)
    â””â”€â”€ æ¨èï¼šç¨€ç–æ£€å‡º + æ™ºèƒ½ç­–ç•¥
        â””â”€â”€ åŸå› ï¼šæ˜¾è‘—æå‡æ•ˆç‡
```

**ğŸ¯ å®ç”¨æŠ€å·§**ï¼š
- **å®šæ—¶æ¸…ç†**ï¼šå®šæœŸæ¸…ç†å·¥ä½œç©ºé—´ï¼Œé¿å…ç´¯ç§¯åƒåœ¾æ–‡ä»¶
- **å¹¶è¡Œæ£€å‡º**ï¼šå¤šåˆ†æ”¯é¡¹ç›®å¯å¹¶è¡Œæ£€å‡ºä¸åŒåˆ†æ”¯
- **ç¼“å­˜ç­–ç•¥**ï¼šåˆ©ç”¨Jenkinså·¥ä½œç©ºé—´ç¼“å­˜å‡å°‘é‡å¤ä¸‹è½½

---

## 3. ğŸ”„ å˜æ›´æ£€æµ‹æœºåˆ¶



### 3.1 å˜æ›´æ£€æµ‹çš„å·¥ä½œåŸç†



**ğŸ’¡ ç®€å•ç†è§£**ï¼šå˜æ›´æ£€æµ‹å°±æ˜¯Jenkinsè‡ªåŠ¨å‘ç°"ä»£ç æœ‰æ²¡æœ‰æ›´æ–°"çš„æœºåˆ¶

```
å˜æ›´æ£€æµ‹æµç¨‹ï¼š

Gitä»“åº“çŠ¶æ€å˜åŒ–ï¼š
commit A â”€â”€â†’ commit B â”€â”€â†’ commit C
   |           |           |
   |           |           â””â”€â”€ [æ–°æäº¤] è§¦å‘æ„å»º
   |           â””â”€â”€ [ä¸Šæ¬¡æ„å»ºçš„ä½ç½®]
   â””â”€â”€ [æ›´æ—©çš„æäº¤]

Jenkinsæ£€æµ‹é€»è¾‘ï¼š
1. è®°å½•ä¸Šæ¬¡æ„å»ºçš„commit ID
2. å®šæœŸæ£€æŸ¥ä»“åº“æœ€æ–°commit ID  
3. å‘ç°ä¸åŒ â†’ è§¦å‘æ–°æ„å»º
4. æ›´æ–°è®°å½•çš„commit ID
```

### 3.2 è§¦å‘æœºåˆ¶é…ç½®



**âš ï¸ é‡è¦æ¦‚å¿µ**ï¼š
- **è½®è¯¢è§¦å‘**ï¼šJenkinså®šæ—¶æ£€æŸ¥ä»£ç æ›´æ–°
- **Hookè§¦å‘**ï¼šGitä»“åº“ä¸»åŠ¨é€šçŸ¥Jenkins
- **æ‰‹åŠ¨è§¦å‘**ï¼šå¼€å‘è€…æ‰‹åŠ¨å¯åŠ¨æ„å»º

**ğŸ”§ è½®è¯¢é…ç½®ç¤ºä¾‹**ï¼š
```groovy
pipeline {
    agent any
    triggers {
        // æ¯5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡ä»£ç å˜æ›´
        pollSCM('H/5 * * * *')
    }
    stages {
        stage('æ£€æµ‹å˜æ›´') {
            when {
                changeset "src/**"  // åªå…³æ³¨srcç›®å½•å˜æ›´
            }
            steps {
                echo "ğŸ“ æ£€æµ‹åˆ°ä»£ç å˜æ›´ï¼Œå¼€å§‹æ„å»º"
                sh 'git diff HEAD~1 --name-only'
            }
        }
    }
}
```

**âš¡ Webhooké…ç½®æµç¨‹**ï¼š

```
Gitä»“åº“è®¾ç½®ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GitHub/GitLab Repository Settings  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Webhooks                           â”‚
â”‚ â”œâ”€â”€ URL: http://jenkins:8080/      â”‚
â”‚ â”‚        github-webhook/           â”‚
â”‚ â”œâ”€â”€ Events: Push, Pull Request     â”‚  
â”‚ â””â”€â”€ Secret: [å®‰å…¨å¯†é’¥]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Jenkins Job Configuration          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Build Triggers                     â”‚
â”‚ â˜‘ GitHub hook trigger for         â”‚
â”‚   GITScm polling                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 æ™ºèƒ½å˜æ›´è¿‡æ»¤



**ğŸ¯ ç›®æ ‡**ï¼šé¿å…ä¸å¿…è¦çš„æ„å»ºï¼Œæé«˜æ•ˆç‡

```groovy
pipeline {
    agent any
    stages {
        stage('æ™ºèƒ½è¿‡æ»¤') {
            steps {
                script {
                    // è·å–å˜æ›´æ–‡ä»¶åˆ—è¡¨
                    def changedFiles = sh(
                        script: 'git diff --name-only HEAD~1',
                        returnStdout: true
                    ).trim().split('\n')
                    
                    // æ£€æŸ¥æ˜¯å¦åŒ…å«é‡è¦æ–‡ä»¶
                    def hasCodeChanges = changedFiles.any { file ->
                        file.startsWith('src/') || 
                        file.endsWith('.java') ||
                        file.endsWith('.js')
                    }
                    
                    if (!hasCodeChanges) {
                        echo "â­ï¸ åªæœ‰æ–‡æ¡£æ›´æ–°ï¼Œè·³è¿‡æ„å»º"
                        currentBuild.result = 'NOT_BUILT'
                        return
                    }
                    
                    echo "âœ… å‘ç°ä»£ç å˜æ›´ï¼Œç»§ç»­æ„å»º"
                }
            }
        }
    }
}
```

**ğŸ“Š è¿‡æ»¤ç­–ç•¥é…ç½®**ï¼š

| æ–‡ä»¶ç±»å‹ | **æ˜¯å¦è§¦å‘æ„å»º** | **å¤„ç†ç­–ç•¥** |
|---------|----------------|-------------|
| `*.md` | âŒ å¦ | `æ–‡æ¡£æ›´æ–°ï¼Œè·³è¿‡æ„å»º` |
| `*.txt` | âŒ å¦ | `è¯´æ˜æ–‡ä»¶ï¼Œè·³è¿‡æ„å»º` |
| `src/**` | âœ… æ˜¯ | `æºç å˜æ›´ï¼Œç«‹å³æ„å»º` |
| `test/**` | âœ… æ˜¯ | `æµ‹è¯•ä»£ç ï¼Œæ‰§è¡Œæµ‹è¯•` |
| `config/**` | âš¡ æœ‰æ¡ä»¶ | `é…ç½®å˜æ›´ï¼Œæ£€æŸ¥åå†³å®š` |

---

## 4. ğŸ”€ ä»£ç åˆå¹¶æ£€æŸ¥



### 4.1 åˆå¹¶æ£€æŸ¥çš„é‡è¦æ€§



**ğŸ’­ ä¸ºä»€ä¹ˆéœ€è¦åˆå¹¶æ£€æŸ¥**ï¼š
- **é¿å…ç ´åä¸»åˆ†æ”¯**ï¼šç¡®ä¿åˆå¹¶çš„ä»£ç ä¸ä¼šå¼•å…¥é—®é¢˜
- **å›¢é˜Ÿåä½œä¿éšœ**ï¼šå¤šäººå¼€å‘æ—¶é¿å…å†²çª
- **è´¨é‡æ§åˆ¶å…³å£**ï¼šåœ¨åˆå¹¶å‰æœ€åä¸€æ¬¡è´¨é‡æŠŠå…³

```
ä»£ç åˆå¹¶æµç¨‹ï¼š

å¼€å‘åˆ†æ”¯ (feature/new-feature)
    |
    |-- [å¼€å‘å®Œæˆ] åˆ›å»ºåˆå¹¶è¯·æ±‚
    |
    â–¼
åˆå¹¶æ£€æŸ¥é˜¶æ®µ
    |-- é™æ€ä»£ç åˆ†æ
    |-- å•å…ƒæµ‹è¯•æ‰§è¡Œ  
    |-- é›†æˆæµ‹è¯•éªŒè¯
    |-- å†²çªæ£€æµ‹
    |
    â–¼
ä¸»åˆ†æ”¯ (main/master)
    |-- [æ£€æŸ¥é€šè¿‡] è‡ªåŠ¨åˆå¹¶
    |-- [æ£€æŸ¥å¤±è´¥] æ‹’ç»åˆå¹¶
```

### 4.2 åˆå¹¶å‰è‡ªåŠ¨æ£€æŸ¥



**ğŸ”§ åŸºç¡€åˆå¹¶æ£€æŸ¥Pipeline**ï¼š
```groovy
pipeline {
    agent any
    stages {
        stage('åˆå¹¶å‰æ£€æŸ¥') {
            parallel {
                stage('ä»£ç è´¨é‡') {
                    steps {
                        echo "ğŸ” æ‰§è¡Œä»£ç è´¨é‡æ£€æŸ¥"
                        // é™æ€ä»£ç åˆ†æ
                        sh 'npm run lint'
                        // ä»£ç æ ¼å¼æ£€æŸ¥
                        sh 'npm run format:check'
                    }
                }
                stage('å•å…ƒæµ‹è¯•') {
                    steps {
                        echo "ğŸ§ª æ‰§è¡Œå•å…ƒæµ‹è¯•"
                        sh 'npm test'
                        // å‘å¸ƒæµ‹è¯•æŠ¥å‘Š
                        publishTestResults testResultsPattern: 'test-results.xml'
                    }
                }
                stage('å†²çªæ£€æµ‹') {
                    steps {
                        echo "âš”ï¸ æ£€æŸ¥åˆå¹¶å†²çª"
                        script {
                            def result = sh(
                                script: 'git merge-tree $(git merge-base HEAD origin/main) HEAD origin/main',
                                returnStatus: true
                            )
                            if (result != 0) {
                                error "âŒ å‘ç°åˆå¹¶å†²çªï¼Œè¯·å…ˆè§£å†³å†²çª"
                            }
                        }
                    }
                }
            }
        }
    }
}
```

### 4.3 åˆ†æ”¯ä¿æŠ¤è§„åˆ™



**ğŸ›¡ï¸ ä¿æŠ¤è§„åˆ™è®¾ç½®**ï¼š

```
Gitä»“åº“åˆ†æ”¯ä¿æŠ¤é…ç½®ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Branch Protection Rules            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Branch name pattern: main          â”‚
â”‚                                    â”‚
â”‚ â˜‘ Require pull request reviews    â”‚
â”‚   â””â”€â”€ Required approving reviews: 1â”‚
â”‚                                    â”‚
â”‚ â˜‘ Require status checks to pass   â”‚
â”‚   â”œâ”€â”€ Jenkins CI Build            â”‚
â”‚   â”œâ”€â”€ Code Quality Check          â”‚
â”‚   â””â”€â”€ Unit Tests                  â”‚
â”‚                                    â”‚
â”‚ â˜‘ Require up-to-date branches     â”‚
â”‚ â˜‘ Include administrators          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ“‹ æ£€æŸ¥é¡¹ç›®æ¸…å•**ï¼š

```
â˜ ä»£ç ç¼–è¯‘é€šè¿‡
â˜ å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡  
â˜ ä»£ç è¦†ç›–ç‡è¾¾æ ‡ (>80%)
â˜ é™æ€ä»£ç åˆ†ææ— ä¸¥é‡é—®é¢˜
â˜ å®‰å…¨æ‰«ææ— é«˜å±æ¼æ´
â˜ è‡³å°‘ä¸€äººä»£ç å®¡æŸ¥é€šè¿‡
â˜ æ— åˆå¹¶å†²çª
â˜ åˆ†æ”¯åŸºäºæœ€æ–°ä¸»åˆ†æ”¯
```

---

## 5. ğŸ“¬ Pull Requestæ„å»º



### 5.1 PRæ„å»ºçš„å·¥ä½œæµç¨‹



**ğŸ’¡ ä»€ä¹ˆæ˜¯PRæ„å»º**ï¼šå½“å¼€å‘è€…æäº¤Pull Requestæ—¶ï¼ŒJenkinsè‡ªåŠ¨å¯¹è¿™ä¸ªPRè¿›è¡Œæ„å»ºå’Œæµ‹è¯•

```
PRæ„å»ºå®Œæ•´æµç¨‹ï¼š

å¼€å‘è€…æ“ä½œ              GitHub/GitLab           Jenkins
     |                        |                    |
     |--[1]åˆ›å»ºPR------------>|                    |
     |                        |--[2]Webhook------->|
     |                        |                    |--[3]åˆ›å»ºä¸´æ—¶æ„å»º
     |                        |                    |--[4]æ£€å‡ºPRä»£ç 
     |                        |                    |--[5]æ‰§è¡Œæµ‹è¯•
     |                        |<--[6]å›æŠ¥ç»“æœ------|
     |<--[7]æ˜¾ç¤ºçŠ¶æ€----------|                    |
```

### 5.2 PRæ„å»ºé…ç½®



**ğŸ”§ å¤šåˆ†æ”¯Pipelineé…ç½®**ï¼š
```groovy
pipeline {
    agent any
    stages {
        stage('PRéªŒè¯') {
            when {
                changeRequest()  // åªåœ¨PRæ—¶æ‰§è¡Œ
            }
            parallel {
                stage('å¿«é€Ÿæ£€æŸ¥') {
                    steps {
                        echo "âš¡ PRå¿«é€ŸéªŒè¯å¼€å§‹"
                        echo "ğŸ“ PRæ ‡é¢˜: ${env.CHANGE_TITLE}"
                        echo "ğŸ‘¤ PRä½œè€…: ${env.CHANGE_AUTHOR}"
                        
                        // æ£€æŸ¥PRæ ‡é¢˜æ ¼å¼
                        script {
                            if (!env.CHANGE_TITLE.matches(/^(feat|fix|docs|style|refactor|test|chore):.+/)) {
                                error "âŒ PRæ ‡é¢˜æ ¼å¼ä¸æ­£ç¡®ï¼Œè¯·ä½¿ç”¨: type: description"
                            }
                        }
                    }
                }
                stage('ä»£ç è´¨é‡') {
                    steps {
                        echo "ğŸ” PRä»£ç è´¨é‡æ£€æŸ¥"
                        sh 'npm run lint -- --format=checkstyle > lint-results.xml'
                        publishCheckStyleResults pattern: 'lint-results.xml'
                    }
                }
                stage('å¢é‡æµ‹è¯•') {
                    steps {
                        echo "ğŸ§ª æ‰§è¡Œå¢é‡æµ‹è¯•"
                        script {
                            // åªæµ‹è¯•å˜æ›´ç›¸å…³çš„æ–‡ä»¶
                            def changedFiles = sh(
                                script: 'git diff origin/main --name-only',
                                returnStdout: true
                            ).trim()
                            echo "ğŸ“ å˜æ›´æ–‡ä»¶: ${changedFiles}"
                        }
                        sh 'npm run test:changed'
                    }
                }
            }
        }
    }
    post {
        always {
            // å‘PRæ·»åŠ æ„å»ºç»“æœè¯„è®º
            script {
                if (env.CHANGE_ID) {
                    def message = """
# ğŸ¤– æ„å»ºç»“æœ



**æ„å»ºçŠ¶æ€**: ${currentBuild.result ?: 'SUCCESS'}
**æ„å»ºæ—¶é—´**: ${currentBuild.duration}ms
**æ„å»ºé“¾æ¥**: [æŸ¥çœ‹è¯¦æƒ…](${env.BUILD_URL})

## æ£€æŸ¥é¡¹ç›®


- âœ… ä»£ç æ ¼å¼æ£€æŸ¥
- âœ… å•å…ƒæµ‹è¯•
- âœ… é™æ€åˆ†æ
                    """
                    pullRequest.comment(message)
                }
            }
        }
    }
}
```

### 5.3 PRçŠ¶æ€åé¦ˆ



**ğŸ“Š çŠ¶æ€åé¦ˆæœºåˆ¶**ï¼š

```
GitHub PRé¡µé¢çŠ¶æ€æ˜¾ç¤ºï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Pull Request #123                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Some checks haven't completed yet   â”‚
â”‚                                    â”‚
â”‚ âœ… Jenkins/PR-Build                â”‚
â”‚ â³ Jenkins/Code-Quality (running)   â”‚
â”‚ âŒ Jenkins/Security-Scan (failed)   â”‚
â”‚ â­ï¸ Jenkins/Deploy-Test (skipped)    â”‚
â”‚                                    â”‚
â”‚ [ğŸš« Merge blocked by failing checks] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ¯ çŠ¶æ€ç±»å‹è¯´æ˜**ï¼š
- `âœ… æˆåŠŸ`ï¼šæ£€æŸ¥é€šè¿‡ï¼Œå¯ä»¥åˆå¹¶
- `âŒ å¤±è´¥`ï¼šæ£€æŸ¥å¤±è´¥ï¼Œé˜»æ­¢åˆå¹¶
- `â³ è¿›è¡Œä¸­`ï¼šæ£€æŸ¥æ­£åœ¨æ‰§è¡Œ
- `â­ï¸ è·³è¿‡`ï¼šæ£€æŸ¥è¢«è·³è¿‡
- `ğŸ”„ æ’é˜Ÿä¸­`ï¼šç­‰å¾…æ‰§è¡Œ

---

## 6. ğŸšª ä»£ç è´¨é‡é—¨ç¦



### 6.1 ä»€ä¹ˆæ˜¯è´¨é‡é—¨ç¦



**ğŸ’­ é€šä¿—ç†è§£**ï¼šè´¨é‡é—¨ç¦å°±åƒæ˜¯ä»£ç è¿›å…¥ä¸»åˆ†æ”¯å‰çš„"å®‰æ£€é—¨"ï¼Œåªæœ‰è¾¾åˆ°æ ‡å‡†çš„ä»£ç æ‰èƒ½é€šè¿‡

```
è´¨é‡é—¨ç¦æ¦‚å¿µå›¾ï¼š

å¼€å‘ä»£ç  â”€â”€â†’ [è´¨é‡é—¨ç¦] â”€â”€â†’ ä¸»åˆ†æ”¯
              â”‚
              â”œâ”€â”€ ä»£ç è¦†ç›–ç‡ â‰¥ 80%
              â”œâ”€â”€ ä»£ç é‡å¤ç‡ â‰¤ 5%  
              â”œâ”€â”€ ä¸¥é‡bugæ•°é‡ = 0
              â”œâ”€â”€ å®‰å…¨æ¼æ´ = 0
              â””â”€â”€ ä»£ç è§„èŒƒæ£€æŸ¥é€šè¿‡
              
å¦‚æœä»»ä½•ä¸€é¡¹ä¸è¾¾æ ‡ â†’ ğŸš« æ‹’ç»åˆå¹¶
```

### 6.2 é—¨ç¦è§„åˆ™é…ç½®



**ğŸ“ è´¨é‡æ ‡å‡†è®¾ç½®**ï¼š

| è´¨é‡æŒ‡æ ‡ | **é€šè¿‡æ ‡å‡†** | **æ£€æŸ¥å·¥å…·** | **ä¸¥é‡ç¨‹åº¦** |
|---------|------------|-------------|-------------|
| `ä»£ç è¦†ç›–ç‡` | `â‰¥ 80%` | `JaCoCo/Istanbul` | `ğŸ”´ é˜»æ–­` |
| `é‡å¤ä»£ç ç‡` | `â‰¤ 5%` | `SonarQube` | `ğŸŸ¡ è­¦å‘Š` |
| `ä¸¥é‡Bug` | `= 0ä¸ª` | `é™æ€åˆ†æå·¥å…·` | `ğŸ”´ é˜»æ–­` |
| `å®‰å…¨æ¼æ´` | `= 0ä¸ª` | `å®‰å…¨æ‰«æå·¥å…·` | `ğŸ”´ é˜»æ–­` |
| `ä»£ç è§„èŒƒ` | `100%é€šè¿‡` | `ESLint/Checkstyle` | `ğŸŸ¡ è­¦å‘Š` |

**ğŸ”§ é—¨ç¦Pipelineå®ç°**ï¼š
```groovy
pipeline {
    agent any
    stages {
        stage('è´¨é‡é—¨ç¦æ£€æŸ¥') {
            parallel {
                stage('è¦†ç›–ç‡æ£€æŸ¥') {
                    steps {
                        echo "ğŸ“Š æ£€æŸ¥ä»£ç è¦†ç›–ç‡"
                        sh 'npm run test:coverage'
                        script {
                            def coverage = sh(
                                script: "grep -o 'Lines.*: [0-9.]*%' coverage/lcov-report/index.html | grep -o '[0-9.]*%' | head -1 | tr -d '%'",
                                returnStdout: true
                            ).trim() as Double
                            
                            echo "ğŸ“ˆ å½“å‰è¦†ç›–ç‡: ${coverage}%"
                            if (coverage < 80) {
                                error "âŒ ä»£ç è¦†ç›–ç‡ä¸è¶³: ${coverage}% < 80%"
                            }
                        }
                    }
                }
                stage('ä»£ç è´¨é‡') {
                    steps {
                        echo "ğŸ” SonarQubeè´¨é‡åˆ†æ"
                        script {
                            def qualityGate = sh(
                                script: 'sonar-scanner -Dsonar.qualitygate.wait=true',
                                returnStatus: true
                            )
                            
                            if (qualityGate != 0) {
                                error "âŒ SonarQubeè´¨é‡é—¨ç¦æ£€æŸ¥å¤±è´¥"
                            }
                        }
                    }
                }
                stage('å®‰å…¨æ‰«æ') {
                    steps {
                        echo "ğŸ›¡ï¸ å®‰å…¨æ¼æ´æ‰«æ"
                        sh 'npm audit --audit-level=high'
                        sh 'npm run security:scan'
                    }
                }
            }
        }
    }
}
```

### 6.3 é—¨ç¦é€šçŸ¥æœºåˆ¶



**ğŸ“¢ å¤šæ¸ é“é€šçŸ¥é…ç½®**ï¼š

```groovy
post {
    failure {
        script {
            // é‚®ä»¶é€šçŸ¥
            emailext (
                subject: "ğŸš¨ è´¨é‡é—¨ç¦æ£€æŸ¥å¤±è´¥ - ${env.JOB_NAME}",
                body: """
                æ„å»ºé¡¹ç›®: ${env.JOB_NAME}
                æ„å»ºç¼–å·: ${env.BUILD_NUMBER}
                å¤±è´¥åŸå› : ä»£ç è´¨é‡ä¸è¾¾æ ‡
                æŸ¥çœ‹è¯¦æƒ…: ${env.BUILD_URL}
                """,
                to: "${env.CHANGE_AUTHOR_EMAIL}"
            )
            
            // Slacké€šçŸ¥
            slackSend(
                color: 'danger',
                message: "âŒ è´¨é‡é—¨ç¦å¤±è´¥: ${env.JOB_NAME} #${env.BUILD_NUMBER}"
            )
            
            // ä¼ä¸šå¾®ä¿¡é€šçŸ¥
            script {
                def webhook = "https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=YOUR_KEY"
                sh """
                curl -X POST ${webhook} \
                -H 'Content-Type: application/json' \
                -d '{
                    "msgtype": "text",
                    "text": {
                        "content": "ğŸš¨ ä»£ç è´¨é‡é—¨ç¦æ£€æŸ¥å¤±è´¥\\né¡¹ç›®: ${env.JOB_NAME}\\nè¯¦æƒ…: ${env.BUILD_URL}"
                    }
                }'
                """
            }
        }
    }
    success {
        echo "âœ… è´¨é‡é—¨ç¦æ£€æŸ¥é€šè¿‡ï¼Œä»£ç è´¨é‡è¾¾æ ‡"
    }
}
```

### 6.4 é—¨ç¦ä¼˜åŒ–ç­–ç•¥



**âš¡ æ€§èƒ½ä¼˜åŒ–**ï¼š
- **å¹¶è¡Œæ‰§è¡Œ**ï¼šå¤šä¸ªæ£€æŸ¥é¡¹å¹¶è¡Œè¿è¡Œï¼Œç¼©çŸ­æ£€æŸ¥æ—¶é—´
- **å¢é‡æ£€æŸ¥**ï¼šåªæ£€æŸ¥å˜æ›´éƒ¨åˆ†ï¼Œæé«˜æ•ˆç‡
- **ç¼“å­˜æœºåˆ¶**ï¼šç¼“å­˜ä¾èµ–å’Œæ£€æŸ¥ç»“æœ
- **åˆ†å±‚æ£€æŸ¥**ï¼šå¿«é€Ÿæ£€æŸ¥åœ¨å‰ï¼Œè€—æ—¶æ£€æŸ¥åœ¨å

**ğŸ¯ è§„åˆ™è°ƒä¼˜**ï¼š
```
é—¨ç¦ä¸¥æ ¼ç¨‹åº¦è°ƒæ•´ï¼š
â”œâ”€â”€ ğŸ”´ ä¸¥æ ¼æ¨¡å¼ (ç”Ÿäº§ç¯å¢ƒ)
â”‚   â”œâ”€â”€ è¦†ç›–ç‡ â‰¥ 90%
â”‚   â”œâ”€â”€ é›¶å®¹å¿Bug
â”‚   â””â”€â”€ å®Œæ•´å®‰å…¨æ‰«æ
â”‚
â”œâ”€â”€ ğŸŸ¡ æ ‡å‡†æ¨¡å¼ (æµ‹è¯•ç¯å¢ƒ)  
â”‚   â”œâ”€â”€ è¦†ç›–ç‡ â‰¥ 80%
â”‚   â”œâ”€â”€ ä¸¥é‡Bug = 0
â”‚   â””â”€â”€ åŸºç¡€å®‰å…¨æ£€æŸ¥
â”‚
â””â”€â”€ ğŸŸ¢ å®½æ¾æ¨¡å¼ (å¼€å‘ç¯å¢ƒ)
    â”œâ”€â”€ è¦†ç›–ç‡ â‰¥ 60%
    â”œâ”€â”€ ä»£ç è§„èŒƒæ£€æŸ¥
    â””â”€â”€ åŸºç¡€åŠŸèƒ½æµ‹è¯•
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“



### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ



```
ğŸ”¸ ä»£ç è´¨é‡æ£€æŸ¥ï¼šè‡ªåŠ¨åŒ–çš„ä»£ç "ä½“æ£€"ï¼Œç¡®ä¿ä»£ç å¥åº·
ğŸ”¸ æ£€å‡ºç­–ç•¥ï¼šä»Gitè·å–ä»£ç çš„ä¸åŒæ–¹å¼ï¼Œå½±å“æ„å»ºæ•ˆç‡
ğŸ”¸ å˜æ›´æ£€æµ‹ï¼šè‡ªåŠ¨å‘ç°ä»£ç æ›´æ–°çš„æœºåˆ¶ï¼Œè§¦å‘æ„å»ºæµç¨‹
ğŸ”¸ åˆå¹¶æ£€æŸ¥ï¼šä»£ç åˆå¹¶å‰çš„è´¨é‡æŠŠå…³ï¼Œä¿æŠ¤ä¸»åˆ†æ”¯ç¨³å®šæ€§
ğŸ”¸ PRæ„å»ºï¼šPull Requestçš„è‡ªåŠ¨åŒ–éªŒè¯ï¼Œæå‡åä½œæ•ˆç‡
ğŸ”¸ è´¨é‡é—¨ç¦ï¼šä»£ç è´¨é‡çš„æœ€åé˜²çº¿ï¼Œåªæ”¾è¡Œè¾¾æ ‡ä»£ç 
```

### 7.2 å®ç”¨æ“ä½œæŠ€å·§



**ğŸ¯ æ–°æ‰‹å®¹æ˜“çŠ¯çš„é”™è¯¯**ï¼š
- âŒ **è¿‡åº¦æ£€æŸ¥**ï¼šæ‰€æœ‰æ£€æŸ¥éƒ½è®¾ç½®æœ€ä¸¥æ ¼æ ‡å‡†ï¼Œå¯¼è‡´æ•ˆç‡ä½ä¸‹
- âŒ **å¿½ç•¥å¢é‡**ï¼šæ¯æ¬¡éƒ½å…¨é‡æ£€æŸ¥ï¼Œæµªè´¹æ—¶é—´èµ„æº
- âŒ **ç¼ºå°‘é€šçŸ¥**ï¼šæ£€æŸ¥å¤±è´¥äº†ä½†å¼€å‘è€…ä¸çŸ¥é“
- âŒ **ä¸€åˆ€åˆ‡è§„åˆ™**ï¼šæ‰€æœ‰é¡¹ç›®ç”¨ç›¸åŒçš„è´¨é‡æ ‡å‡†

**âœ… æœ€ä½³å®è·µå»ºè®®**ï¼š
- ğŸ¯ **åˆ†å±‚æ£€æŸ¥**ï¼šå¿«é€Ÿæ£€æŸ¥å…ˆè¡Œï¼Œå¤æ‚æ£€æŸ¥å¹¶è¡Œ
- ğŸ“Š **æ¸è¿›æå‡**ï¼šè´¨é‡æ ‡å‡†é€æ­¥æé«˜ï¼Œé¿å…ä¸€æ¬¡æ€§è¦æ±‚è¿‡é«˜
- ğŸ”” **åŠæ—¶åé¦ˆ**ï¼šå¤šæ¸ é“é€šçŸ¥ç¡®ä¿é—®é¢˜èƒ½è¢«åŠæ—¶å‘ç°
- ğŸ¨ **ä¸ªæ€§åŒ–é…ç½®**ï¼šä¸åŒé¡¹ç›®é‡‡ç”¨ä¸åŒçš„è´¨é‡é—¨ç¦æ ‡å‡†

### 7.3 æ•…éšœæ’æŸ¥æŒ‡å—



**ğŸ”§ å¸¸è§é—®é¢˜è§£å†³**ï¼š

```
é—®é¢˜ï¼šæ„å»ºæ€»æ˜¯å¤±è´¥ï¼Œä»£ç è¦†ç›–ç‡è¾¾ä¸åˆ°æ ‡å‡†
è§£å†³ï¼š
â”œâ”€â”€ æ£€æŸ¥æµ‹è¯•ç”¨ä¾‹æ˜¯å¦å®Œæ•´
â”œâ”€â”€ ç¡®è®¤è¦†ç›–ç‡è®¡ç®—æ–¹å¼æ­£ç¡®
â”œâ”€â”€ é€‚å½“è°ƒæ•´è¦†ç›–ç‡é˜ˆå€¼
â””â”€â”€ æ·»åŠ å¿…è¦çš„å•å…ƒæµ‹è¯•

é—®é¢˜ï¼šGitæ£€å‡ºé€Ÿåº¦å¾ˆæ…¢
è§£å†³ï¼š  
â”œâ”€â”€ ä½¿ç”¨æµ…å…‹éš†å‡å°‘ä¸‹è½½é‡
â”œâ”€â”€ é…ç½®Gitç¼“å­˜æœºåˆ¶
â”œâ”€â”€ æ£€æŸ¥ç½‘ç»œè¿æ¥çŠ¶å†µ
â””â”€â”€ è€ƒè™‘è¿ç§»åˆ°æ›´è¿‘çš„GitæœåŠ¡å™¨

é—®é¢˜ï¼šè´¨é‡é—¨ç¦æ£€æŸ¥å¤ªä¸¥æ ¼ï¼Œå½±å“å¼€å‘æ•ˆç‡
è§£å†³ï¼š
â”œâ”€â”€ åŒºåˆ†ä¸åŒç¯å¢ƒçš„æ£€æŸ¥æ ‡å‡†
â”œâ”€â”€ å¿«é€Ÿåé¦ˆæœºåˆ¶ï¼Œæ—©å‘ç°æ—©è§£å†³
â”œâ”€â”€ å¢é‡æ£€æŸ¥å‡å°‘ä¸å¿…è¦çš„å…¨é‡æ‰«æ
â””â”€â”€ å›¢é˜Ÿåå•†åˆ¶å®šåˆç†çš„è´¨é‡æ ‡å‡†
```

### 7.4 è¿›é˜¶å­¦ä¹ æ–¹å‘



**ğŸ“š æ·±å…¥å­¦ä¹ å»ºè®®**ï¼š
- **å·¥å…·é›†æˆ**ï¼šå­¦ä¹ SonarQubeã€JaCoCoç­‰è´¨é‡å·¥å…·çš„æ·±åº¦é…ç½®
- **è‡ªå®šä¹‰æ£€æŸ¥**ï¼šç¼–å†™ç¬¦åˆå›¢é˜Ÿéœ€æ±‚çš„è‡ªå®šä¹‰æ£€æŸ¥è§„åˆ™
- **æ€§èƒ½ä¼˜åŒ–**ï¼šæŒæ¡å¤§å‹é¡¹ç›®çš„æ„å»ºæ€§èƒ½ä¼˜åŒ–æŠ€å·§
- **å®‰å…¨å®è·µ**ï¼šäº†è§£DevSecOpsä¸­çš„å®‰å…¨æ£€æŸ¥æœ€ä½³å®è·µ

**ğŸš€ å®è·µé¡¹ç›®å»ºè®®**ï¼š
1. å»ºç«‹ä¸€ä¸ªå¤šåˆ†æ”¯çš„ç¤ºä¾‹é¡¹ç›®ï¼Œé…ç½®å®Œæ•´çš„è´¨é‡æ£€æŸ¥æµç¨‹
2. å°è¯•é›†æˆä¸åŒçš„ä»£ç è´¨é‡å·¥å…·ï¼Œå¯¹æ¯”æ•ˆæœ
3. è®¾è®¡é€‚åˆå°å›¢é˜Ÿçš„è½»é‡çº§è´¨é‡é—¨ç¦æ–¹æ¡ˆ
4. å®è·µPRæ„å»ºçš„å®Œæ•´å·¥ä½œæµç¨‹

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
ä»£ç è´¨é‡è¦æŠŠå…³ï¼Œæ£€å‡ºç­–ç•¥é€‰å¯¹è·¯
å˜æ›´æ£€æµ‹è§¦å‘å‡†ï¼Œåˆå¹¶æ£€æŸ¥ä¿ä¸»å¹²  
PRæ„å»ºè‡ªåŠ¨åŒ–ï¼Œè´¨é‡é—¨ç¦æ˜¯é˜²çº¿
å·¥å…·é…ç½®è¦åˆç†ï¼Œå›¢é˜Ÿåä½œæ•ˆç‡é«˜
```