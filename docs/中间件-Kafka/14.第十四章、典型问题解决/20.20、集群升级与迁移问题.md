---
title: 20ã€é›†ç¾¤å‡çº§ä¸è¿ç§»é—®é¢˜
---
## ğŸ“š ç›®å½•

1. [å‡çº§ä¸è¿ç§»åŸºç¡€æ¦‚å¿µ](#1-å‡çº§ä¸è¿ç§»åŸºç¡€æ¦‚å¿µ)
2. [æ»šåŠ¨å‡çº§ç­–ç•¥](#2-æ»šåŠ¨å‡çº§ç­–ç•¥)
3. [ç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥](#3-ç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥)
4. [æ•°æ®è¿ç§»æ–¹æ¡ˆ](#4-æ•°æ®è¿ç§»æ–¹æ¡ˆ)
5. [åˆ†åŒºé‡åˆ†é…æ“ä½œ](#5-åˆ†åŒºé‡åˆ†é…æ“ä½œ)
6. [é…ç½®å‚æ•°è¿ç§»](#6-é…ç½®å‚æ•°è¿ç§»)
7. [å®¢æˆ·ç«¯å‡çº§ç­–ç•¥](#7-å®¢æˆ·ç«¯å‡çº§ç­–ç•¥)
8. [å›é€€åº”æ€¥é¢„æ¡ˆ](#8-å›é€€åº”æ€¥é¢„æ¡ˆ)
9. [å‡çº§éªŒè¯ä¸ç›‘æ§](#9-å‡çº§éªŒè¯ä¸ç›‘æ§)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸš€ å‡çº§ä¸è¿ç§»åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯Kafkaé›†ç¾¤å‡çº§


**ç®€å•ç†è§£**ï¼šå°±åƒç»™ä½ çš„æ‰‹æœºå‡çº§ç³»ç»Ÿä¸€æ ·ï¼ŒKafkaé›†ç¾¤å‡çº§å°±æ˜¯æŠŠè¿è¡Œçš„Kafkaç‰ˆæœ¬ä»è€ç‰ˆæœ¬æ›´æ–°åˆ°æ–°ç‰ˆæœ¬ã€‚

```
å‡çº§å‰ï¼šKafka 2.8.0 é›†ç¾¤
å‡çº§åï¼šKafka 3.4.0 é›†ç¾¤

ç±»æ¯”ç†è§£ï¼š
æ‰‹æœºç³»ç»Ÿï¼šiOS 15 â†’ iOS 17
Kafkaé›†ç¾¤ï¼š2.8.0 â†’ 3.4.0
```

### 1.2 ä¸ºä»€ä¹ˆè¦å‡çº§Kafka


**ğŸ”¸ ä¸»è¦åŸå› **
- **æ€§èƒ½æå‡**ï¼šæ–°ç‰ˆæœ¬é€šå¸¸æœ‰æ›´å¥½çš„æ€§èƒ½è¡¨ç°
- **å®‰å…¨ä¿®å¤**ï¼šä¿®å¤å·²çŸ¥çš„å®‰å…¨æ¼æ´
- **æ–°åŠŸèƒ½**ï¼šè·å¾—æ–°çš„ç‰¹æ€§å’Œæ”¹è¿›
- **Bugä¿®å¤**ï¼šè§£å†³æ—§ç‰ˆæœ¬çš„å·²çŸ¥é—®é¢˜
- **å®˜æ–¹æ”¯æŒ**ï¼šä¿æŒåœ¨å®˜æ–¹æ”¯æŒçš„ç‰ˆæœ¬èŒƒå›´å†…

### 1.3 å‡çº§çš„é£é™©ä¸æŒ‘æˆ˜


**âš ï¸ ä¸»è¦é£é™©**
```
ä¸šåŠ¡é£é™©ï¼š
â€¢ æœåŠ¡ä¸­æ–­ï¼šå‡çº§è¿‡ç¨‹ä¸­å¯èƒ½å½±å“ä¸šåŠ¡
â€¢ æ•°æ®ä¸¢å¤±ï¼šæ“ä½œä¸å½“å¯èƒ½å¯¼è‡´æ•°æ®é—®é¢˜
â€¢ æ€§èƒ½ä¸‹é™ï¼šæ–°ç‰ˆæœ¬å¯èƒ½å­˜åœ¨æ€§èƒ½å›é€€

æŠ€æœ¯é£é™©ï¼š
â€¢ å…¼å®¹æ€§é—®é¢˜ï¼šå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ç‰ˆæœ¬ä¸åŒ¹é…
â€¢ é…ç½®å†²çªï¼šæ–°æ—§ç‰ˆæœ¬é…ç½®å‚æ•°å·®å¼‚
â€¢ å›é€€å›°éš¾ï¼šå‡çº§åå›é€€å¤æ‚
```

### 1.4 å‡çº§ç­–ç•¥é€‰æ‹©


**ğŸ¯ å¸¸è§å‡çº§ç­–ç•¥å¯¹æ¯”**

| ç­–ç•¥ç±»å‹ | **é€‚ç”¨åœºæ™¯** | **ä¸šåŠ¡å½±å“** | **å¤æ‚åº¦** | **é£é™©ç­‰çº§** |
|---------|------------|-------------|-----------|-------------|
| **æ»šåŠ¨å‡çº§** | `ç”Ÿäº§ç¯å¢ƒæ¨è` | `æœ€å°å½±å“` | `ä¸­ç­‰` | `ğŸŸ¡ä½é£é™©` |
| **è“ç»¿éƒ¨ç½²** | `èµ„æºå……è¶³ç¯å¢ƒ` | `å‡ ä¹æ— å½±å“` | `é«˜` | `ğŸŸ¢æä½é£é™©` |
| **åœæœºå‡çº§** | `æµ‹è¯•ç¯å¢ƒ` | `å®Œå…¨ä¸­æ–­` | `ä½` | `ğŸ”´é«˜é£é™©` |

---

## 2. ğŸ”„ æ»šåŠ¨å‡çº§ç­–ç•¥


### 2.1 æ»šåŠ¨å‡çº§åŸºæœ¬åŸç†


**æ ¸å¿ƒæ€æƒ³**ï¼šä¸€å°ä¸€å°åœ°å‡çº§ï¼Œä¿è¯é›†ç¾¤å§‹ç»ˆæœ‰èŠ‚ç‚¹åœ¨å·¥ä½œ

```
æ»šåŠ¨å‡çº§è¿‡ç¨‹ç¤ºæ„ï¼š

åˆå§‹çŠ¶æ€ï¼š
[Broker1-v2.8] [Broker2-v2.8] [Broker3-v2.8]
      â†“              â†“              â†“
     è¿è¡Œ            è¿è¡Œ            è¿è¡Œ

ç¬¬ä¸€æ­¥ï¼šå‡çº§Broker1
[Broker1-v3.4] [Broker2-v2.8] [Broker3-v2.8]
      â†“              â†“              â†“
     è¿è¡Œ            è¿è¡Œ            è¿è¡Œ

ç¬¬äºŒæ­¥ï¼šå‡çº§Broker2
[Broker1-v3.4] [Broker2-v3.4] [Broker3-v2.8]
      â†“              â†“              â†“
     è¿è¡Œ            è¿è¡Œ            è¿è¡Œ

ç¬¬ä¸‰æ­¥ï¼šå‡çº§Broker3
[Broker1-v3.4] [Broker2-v3.4] [Broker3-v3.4]
      â†“              â†“              â†“
     è¿è¡Œ            è¿è¡Œ            è¿è¡Œ
```

### 2.2 æ»šåŠ¨å‡çº§è¯¦ç»†æ­¥éª¤


**ğŸ“‹ æ ‡å‡†å‡çº§æµç¨‹**

```
ğŸ”¸ å‡†å¤‡é˜¶æ®µï¼ˆPre-Upgradeï¼‰
1. å¤‡ä»½é…ç½®æ–‡ä»¶å’Œæ•°æ®
2. æ£€æŸ¥é›†ç¾¤å¥åº·çŠ¶æ€
3. éªŒè¯ç‰ˆæœ¬å…¼å®¹æ€§
4. å‡†å¤‡æ–°ç‰ˆæœ¬å®‰è£…åŒ…

ğŸ”¸ æ‰§è¡Œé˜¶æ®µï¼ˆUpgradeï¼‰
5. é€å°åœæ­¢BrokeræœåŠ¡
6. æ›´æ–°KafkaäºŒè¿›åˆ¶æ–‡ä»¶
7. æ›´æ–°é…ç½®æ–‡ä»¶
8. å¯åŠ¨æ–°ç‰ˆæœ¬Broker

ğŸ”¸ éªŒè¯é˜¶æ®µï¼ˆPost-Upgradeï¼‰
9. æ£€æŸ¥Brokerå¯åŠ¨çŠ¶æ€
10. éªŒè¯é›†ç¾¤åŠŸèƒ½æ­£å¸¸
11. ç›‘æ§æ€§èƒ½æŒ‡æ ‡
12. ç¡®è®¤å®¢æˆ·ç«¯è¿æ¥æ­£å¸¸
```

### 2.3 æ»šåŠ¨å‡çº§æ“ä½œç¤ºä¾‹


**ç¬¬ä¸€å°Brokerå‡çº§è¿‡ç¨‹**

```bash
# 1. åœæ­¢å½“å‰Brokerï¼ˆå‡è®¾æ˜¯broker-1ï¼‰
systemctl stop kafka

# 2. å¤‡ä»½å½“å‰ç‰ˆæœ¬
cp -r /opt/kafka /opt/kafka-backup-2.8.0

# 3. ä¸‹è½½å¹¶è§£å‹æ–°ç‰ˆæœ¬
wget https://downloads.apache.org/kafka/3.4.0/kafka_2.13-3.4.0.tgz
tar -xzf kafka_2.13-3.4.0.tgz
mv kafka_2.13-3.4.0 /opt/kafka-3.4.0

# 4. æ›´æ–°è½¯é“¾æ¥
rm /opt/kafka
ln -s /opt/kafka-3.4.0 /opt/kafka

# 5. å¤åˆ¶é…ç½®æ–‡ä»¶
cp /opt/kafka-backup-2.8.0/config/server.properties /opt/kafka/config/

# 6. å¯åŠ¨æ–°ç‰ˆæœ¬
systemctl start kafka

# 7. æ£€æŸ¥å¯åŠ¨çŠ¶æ€
systemctl status kafka
tail -f /opt/kafka/logs/server.log
```

### 2.4 å‡çº§æ—¶é—´çª—å£è§„åˆ’


**â° æ—¶é—´å®‰æ’å»ºè®®**

```
æ€»å‡çº§æ—¶é—´ä¼°ç®—ï¼š
â€¢ 3èŠ‚ç‚¹é›†ç¾¤ï¼šçº¦2-3å°æ—¶
â€¢ 5èŠ‚ç‚¹é›†ç¾¤ï¼šçº¦3-4å°æ—¶  
â€¢ 10èŠ‚ç‚¹é›†ç¾¤ï¼šçº¦5-6å°æ—¶

å•ä¸ªBrokerå‡çº§æ—¶é—´ï¼š
â€¢ åœæ­¢æœåŠ¡ï¼š1-2åˆ†é’Ÿ
â€¢ å®‰è£…æ–°ç‰ˆæœ¬ï¼š5-10åˆ†é’Ÿ
â€¢ å¯åŠ¨éªŒè¯ï¼š3-5åˆ†é’Ÿ
â€¢ æ€»è®¡ï¼š15-20åˆ†é’Ÿ/å°

å»ºè®®æ—¶é—´çª—å£ï¼š
ğŸŒ™ å¤œé—´ä½å³°æœŸï¼šå‡Œæ™¨2-6ç‚¹
ğŸ“… å‘¨æœ«éå·¥ä½œæ—¶é—´
ğŸ¯ ä¸šåŠ¡é‡æœ€å°çš„æ—¶æ®µ
```

---

## 3. ğŸ” ç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥


### 3.1 ç‰ˆæœ¬å…¼å®¹æ€§åŸºç¡€


**ä»€ä¹ˆæ˜¯ç‰ˆæœ¬å…¼å®¹æ€§**ï¼šç®€å•è¯´å°±æ˜¯æ–°è€ç‰ˆæœ¬èƒ½ä¸èƒ½"å’Œç¦ç›¸å¤„"

```
å…¼å®¹æ€§åˆ†ç±»ï¼š

å‘å‰å…¼å®¹ï¼š
æ–°ç‰ˆæœ¬èƒ½å¤„ç†è€ç‰ˆæœ¬çš„æ•°æ®å’Œè¯·æ±‚
ä¾‹ï¼šKafka 3.4 èƒ½å¤„ç† 2.8 çš„æ¶ˆæ¯æ ¼å¼

å‘åå…¼å®¹ï¼š
è€ç‰ˆæœ¬èƒ½å¤„ç†æ–°ç‰ˆæœ¬çš„æ•°æ®å’Œè¯·æ±‚
ä¾‹ï¼šKafka 2.8 èƒ½å¤„ç† 3.4 çš„éƒ¨åˆ†æ–°ç‰¹æ€§ï¼ˆé€šå¸¸ä¸æ”¯æŒï¼‰

åè®®å…¼å®¹ï¼š
å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´çš„é€šä¿¡åè®®å…¼å®¹
ä¾‹ï¼š2.8ç‰ˆæœ¬å®¢æˆ·ç«¯è¿æ¥3.4ç‰ˆæœ¬æœåŠ¡ç«¯
```

### 3.2 Kafkaç‰ˆæœ¬å…¼å®¹æ€§çŸ©é˜µ


**ğŸ“Š ä¸»è¦ç‰ˆæœ¬å…¼å®¹æ€§å¯¹ç…§**

| å‡çº§è·¯å¾„ | **ç›´æ¥å‡çº§** | **éœ€è¦ä¸­é—´ç‰ˆæœ¬** | **å»ºè®®ç­–ç•¥** |
|---------|------------|----------------|-------------|
| `2.6 â†’ 2.8` | âœ… **æ”¯æŒ** | `æ— éœ€ä¸­é—´ç‰ˆæœ¬` | `ç›´æ¥æ»šåŠ¨å‡çº§` |
| `2.8 â†’ 3.0` | âœ… **æ”¯æŒ** | `æ— éœ€ä¸­é—´ç‰ˆæœ¬` | `ç›´æ¥æ»šåŠ¨å‡çº§` |
| `3.0 â†’ 3.4` | âœ… **æ”¯æŒ** | `æ— éœ€ä¸­é—´ç‰ˆæœ¬` | `ç›´æ¥æ»šåŠ¨å‡çº§` |
| `2.4 â†’ 3.4` | âš ï¸ **è°¨æ…** | `å»ºè®®2.4â†’2.8â†’3.4` | `åˆ†æ­¥å‡çº§` |
| `1.x â†’ 3.x` | âŒ **ä¸å»ºè®®** | `å¿…é¡»åˆ†æ­¥å‡çº§` | `é€æ­¥å‡çº§` |

### 3.3 å…¼å®¹æ€§æ£€æŸ¥å·¥å…·


**ğŸ”§ æ£€æŸ¥æ–¹æ³•å’Œå·¥å…·**

```bash
# 1. æŸ¥çœ‹å½“å‰ç‰ˆæœ¬
kafka-broker-api-versions.sh --bootstrap-server localhost:9092

# 2. æ£€æŸ¥æ¶ˆæ¯æ ¼å¼ç‰ˆæœ¬
kafka-log-dirs.sh --bootstrap-server localhost:9092 \
  --describe --json | grep "logStartOffset"

# 3. éªŒè¯å®¢æˆ·ç«¯å…¼å®¹æ€§
kafka-console-producer.sh --bootstrap-server localhost:9092 \
  --topic test-topic --producer.config client.properties

# 4. æ£€æŸ¥åè®®ç‰ˆæœ¬æ”¯æŒ
kafka-configs.sh --bootstrap-server localhost:9092 \
  --describe --entity-type brokers
```

### 3.4 å®¢æˆ·ç«¯å…¼å®¹æ€§è€ƒè™‘


**ğŸ“± å®¢æˆ·ç«¯ç‰ˆæœ¬åŒ¹é…åŸåˆ™**

```
å…¼å®¹æ€§è§„åˆ™ï¼š
â€¢ å®¢æˆ·ç«¯ç‰ˆæœ¬ â‰¤ æœåŠ¡ç«¯ç‰ˆæœ¬ï¼ˆæ¨èï¼‰
â€¢ å®¢æˆ·ç«¯æ¯”æœåŠ¡ç«¯æ–°1-2ä¸ªå°ç‰ˆæœ¬ï¼ˆé€šå¸¸å¯ç”¨ï¼‰
â€¢ å®¢æˆ·ç«¯æ¯”æœåŠ¡ç«¯æ–°å¾ˆå¤šç‰ˆæœ¬ï¼ˆå¯èƒ½æœ‰é—®é¢˜ï¼‰

ç¤ºä¾‹è¯´æ˜ï¼š
æœåŠ¡ç«¯ï¼šKafka 3.4.0
âœ… å®¢æˆ·ç«¯ 3.4.0 - å®Œç¾åŒ¹é…
âœ… å®¢æˆ·ç«¯ 3.2.0 - æ¨èé…ç½®
âš ï¸ å®¢æˆ·ç«¯ 3.5.0 - éœ€è¦æµ‹è¯•
âŒ å®¢æˆ·ç«¯ 4.0.0 - ä¸å»ºè®®ä½¿ç”¨
```

---

## 4. ğŸ“¦ æ•°æ®è¿ç§»æ–¹æ¡ˆ


### 4.1 æ•°æ®è¿ç§»åŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯æ•°æ®è¿ç§»**ï¼šæŠŠæ•°æ®ä»ä¸€ä¸ªKafkaé›†ç¾¤æ¬åˆ°å¦ä¸€ä¸ªKafkaé›†ç¾¤ï¼Œå°±åƒæ¬å®¶ä¸€æ ·ã€‚

```
è¿ç§»åœºæ™¯ç¤ºä¾‹ï¼š

åœºæ™¯1ï¼šé›†ç¾¤å‡çº§è¿ç§»
è€é›†ç¾¤ï¼šKafka 2.8 + è€ç¡¬ä»¶
æ–°é›†ç¾¤ï¼šKafka 3.4 + æ–°ç¡¬ä»¶

åœºæ™¯2ï¼šè·¨æœºæˆ¿è¿ç§»  
æºé›†ç¾¤ï¼šæœºæˆ¿Açš„Kafkaé›†ç¾¤
ç›®æ ‡é›†ç¾¤ï¼šæœºæˆ¿Bçš„Kafkaé›†ç¾¤

åœºæ™¯3ï¼šæ¶æ„ä¼˜åŒ–è¿ç§»
åŸé›†ç¾¤ï¼šå•æœºæˆ¿3èŠ‚ç‚¹
æ–°é›†ç¾¤ï¼šå¤šæœºæˆ¿6èŠ‚ç‚¹
```

### 4.2 æ•°æ®è¿ç§»ç­–ç•¥é€‰æ‹©


**ğŸ¯ ä¸»è¦è¿ç§»æ–¹æ¡ˆå¯¹æ¯”**

| æ–¹æ¡ˆç±»å‹ | **å®ç°æ–¹å¼** | **æ•°æ®ä¸€è‡´æ€§** | **ä¸šåŠ¡å½±å“** | **é€‚ç”¨åœºæ™¯** |
|---------|------------|--------------|-------------|-------------|
| **MirrorMaker** | `å®˜æ–¹å·¥å…·åŒæ­¥` | `æœ€ç»ˆä¸€è‡´` | `æœ€å°å½±å“` | `ç”Ÿäº§ç¯å¢ƒæ¨è` |
| **Kafka Connect** | `è¿æ¥å™¨å¤åˆ¶` | `å¼ºä¸€è‡´` | `è¾ƒå°å½±å“` | `å¤æ‚è½¬æ¢éœ€æ±‚` |
| **åœæœºè¿ç§»** | `ç›´æ¥æ•°æ®æ‹·è´` | `å®Œå…¨ä¸€è‡´` | `å®Œå…¨ä¸­æ–­` | `æµ‹è¯•ç¯å¢ƒ` |
| **åŒå†™æ–¹æ¡ˆ** | `åº”ç”¨å±‚åŒå†™` | `åº”ç”¨æ§åˆ¶` | `ä¸­ç­‰å½±å“` | `æ¸è¿›å¼è¿ç§»` |

### 4.3 MirrorMakerè¿ç§»å®è·µ


**ğŸ”§ MirrorMaker 2.0é…ç½®ç¤ºä¾‹**

```properties
# mm2.properties - MirrorMaker 2.0é…ç½®
clusters = source, target
source.bootstrap.servers = old-kafka1:9092,old-kafka2:9092
target.bootstrap.servers = new-kafka1:9092,new-kafka2:9092

# å¤åˆ¶é…ç½®
source->target.enabled = true
source->target.topics = .*
source->target.groups = .*

# æ€§èƒ½è°ƒä¼˜
tasks.max = 4
replication.factor = 3
offset.lag.max = 1000

# å®‰å…¨é…ç½®ï¼ˆå¦‚æœéœ€è¦ï¼‰
source.security.protocol = PLAINTEXT
target.security.protocol = PLAINTEXT
```

**å¯åŠ¨MirrorMaker**

```bash
# å¯åŠ¨MirrorMaker 2.0
kafka-mirror-maker.sh --consumer.config source.properties \
  --producer.config target.properties \
  --whitelist "topic1|topic2|topic3"

# ç›‘æ§å¤åˆ¶è¿›åº¦
kafka-consumer-groups.sh --bootstrap-server new-kafka1:9092 \
  --describe --group mirror-maker-group
```

### 4.4 è¿ç§»è¿›åº¦ç›‘æ§


**ğŸ“Š ç›‘æ§å…³é”®æŒ‡æ ‡**

```
æ•°æ®å¤åˆ¶ç›‘æ§ï¼š
â€¢ æ¶ˆæ¯å¤åˆ¶å»¶è¿Ÿï¼šlag å€¼
â€¢ å¤åˆ¶ååé‡ï¼šrecords/second
â€¢ é”™è¯¯ç‡ï¼šfailed tasks
â€¢ å®Œæˆè¿›åº¦ï¼šoffset å¯¹æ¯”

ç›‘æ§å‘½ä»¤ç¤ºä¾‹ï¼š
# æ£€æŸ¥æ¶ˆè´¹ç»„å»¶è¿Ÿ
kafka-consumer-groups.sh --bootstrap-server target:9092 \
  --describe --group mm2-group

# ç›‘æ§Topicæ•°æ®é‡
kafka-log-dirs.sh --bootstrap-server target:9092 \
  --describe --json | jq '.brokers[].logDirs[].partitions'
```

---

## 5. ğŸ”€ åˆ†åŒºé‡åˆ†é…æ“ä½œ


### 5.1 åˆ†åŒºé‡åˆ†é…åŸºç¡€æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯åˆ†åŒºé‡åˆ†é…**ï¼šå°±åƒé‡æ–°åˆ†é…æˆ¿é—´ä¸€æ ·ï¼ŒæŠŠæ¶ˆæ¯åˆ†åŒºåœ¨ä¸åŒBrokerä¹‹é—´é‡æ–°åˆ†å¸ƒã€‚

```
é‡åˆ†é…å‰ï¼š
Broker1: [partition-0, partition-3]
Broker2: [partition-1, partition-4]  
Broker3: [partition-2, partition-5]

é‡åˆ†é…åï¼š
Broker1: [partition-0, partition-1]
Broker2: [partition-2, partition-3]
Broker3: [partition-4, partition-5]

ç›®çš„ï¼šè´Ÿè½½å‡è¡¡ï¼Œä¼˜åŒ–æ€§èƒ½
```

### 5.2 ä»€ä¹ˆæ—¶å€™éœ€è¦é‡åˆ†é…


**ğŸ¯ é‡åˆ†é…è§¦å‘åœºæ™¯**

```
é›†ç¾¤æ‰©å®¹ï¼š
â€¢ æ–°å¢BrokerèŠ‚ç‚¹å
â€¢ éœ€è¦åˆ©ç”¨æ–°èŠ‚ç‚¹èµ„æº
â€¢ å¹³è¡¡é›†ç¾¤è´Ÿè½½

é›†ç¾¤ç¼©å®¹ï¼š
â€¢ ä¸‹çº¿éƒ¨åˆ†Broker
â€¢ è¿ç§»åˆ†åŒºåˆ°å‰©ä½™èŠ‚ç‚¹
â€¢ é¿å…æ•°æ®ä¸¢å¤±

æ€§èƒ½ä¼˜åŒ–ï¼š
â€¢ çƒ­ç‚¹åˆ†åŒºè´Ÿè½½è¿‡é«˜
â€¢ æŸäº›Brokerè´Ÿè½½ä¸å‡
â€¢ å­˜å‚¨ç©ºé—´ä¸å¹³è¡¡
```

### 5.3 åˆ†åŒºé‡åˆ†é…æ“ä½œæ­¥éª¤


**ğŸ“‹ æ ‡å‡†é‡åˆ†é…æµç¨‹**

```bash
# 1. ç”Ÿæˆé‡åˆ†é…è®¡åˆ’
kafka-reassign-partitions.sh --bootstrap-server localhost:9092 \
  --topics-to-move-json-file topics.json \
  --broker-list "0,1,2" --generate

# topics.json å†…å®¹ç¤ºä¾‹
{
  "topics": [
    {"topic": "my-topic"}
  ],
  "version": 1
}

# 2. æ‰§è¡Œé‡åˆ†é…
kafka-reassign-partitions.sh --bootstrap-server localhost:9092 \
  --reassignment-json-file reassignment.json --execute

# 3. éªŒè¯é‡åˆ†é…è¿›åº¦
kafka-reassign-partitions.sh --bootstrap-server localhost:9092 \
  --reassignment-json-file reassignment.json --verify
```

### 5.4 é‡åˆ†é…ç›‘æ§ä¸ä¼˜åŒ–


**âš¡ æ€§èƒ½ç›‘æ§è¦ç‚¹**

```
å…³é”®ç›‘æ§æŒ‡æ ‡ï¼š
â€¢ é‡åˆ†é…è¿›åº¦ï¼špercentage complete
â€¢ ç½‘ç»œå¸¦å®½ï¼šnetwork I/O usage
â€¢ ç£ç›˜I/Oï¼šdisk read/write
â€¢ å‰¯æœ¬å»¶è¿Ÿï¼šreplica lag

æ€§èƒ½ä¼˜åŒ–å‚æ•°ï¼š
# é™åˆ¶é‡åˆ†é…å¸¦å®½ï¼ˆé¿å…å½±å“ä¸šåŠ¡ï¼‰
replica.fetch.max.bytes=1048576
num.replica.fetchers=4

# é‡åˆ†é…æœŸé—´ç›‘æ§å‘½ä»¤
while true; do
  kafka-reassign-partitions.sh --bootstrap-server localhost:9092 \
    --reassignment-json-file reassignment.json --verify
  sleep 30
done
```

---

## 6. âš™ï¸ é…ç½®å‚æ•°è¿ç§»


### 6.1 é…ç½®è¿ç§»åŸºç¡€


**é…ç½®è¿ç§»çš„é‡è¦æ€§**ï¼šå°±åƒæ¬å®¶æ—¶è¦æŠŠé‡è¦ç‰©å“éƒ½å¸¦ä¸Šï¼Œå‡çº§Kafkaæ—¶ä¹Ÿè¦æŠŠé‡è¦é…ç½®è¿ç§»è¿‡å»ã€‚

**ğŸ”¸ ä¸»è¦é…ç½®ç±»å‹**
- **Brokeré…ç½®**ï¼šserver.propertiesä¸­çš„æ ¸å¿ƒè®¾ç½®
- **Topicé…ç½®**ï¼šæ¯ä¸ªTopicçš„ç‰¹æ®Šè®¾ç½®
- **å®¢æˆ·ç«¯é…ç½®**ï¼šProducerå’ŒConsumerçš„é…ç½®
- **JVMé…ç½®**ï¼šJavaè™šæ‹Ÿæœºç›¸å…³è®¾ç½®

### 6.2 Brokeré…ç½®è¿ç§»


**ğŸ“‹ æ ¸å¿ƒé…ç½®é¡¹æ£€æŸ¥æ¸…å•**

```properties
# åŸºç¡€æ ‡è¯†é…ç½®
broker.id=1
listeners=PLAINTEXT://kafka1:9092
zookeeper.connect=zk1:2181,zk2:2181,zk3:2181

# æ•°æ®å­˜å‚¨é…ç½®  
log.dirs=/data/kafka-logs
num.network.threads=8
num.io.threads=16

# å‰¯æœ¬é…ç½®
default.replication.factor=3
min.insync.replicas=2
unclean.leader.election.enable=false

# æ€§èƒ½è°ƒä¼˜é…ç½®
socket.send.buffer.bytes=102400
socket.receive.buffer.bytes=102400
socket.request.max.bytes=104857600
```

### 6.3 ç‰ˆæœ¬å·®å¼‚é…ç½®å¤„ç†


**âš ï¸ ç‰ˆæœ¬é—´é…ç½®å˜åŒ–å¯¹ç…§**

| é…ç½®é¡¹ | **2.8ç‰ˆæœ¬** | **3.4ç‰ˆæœ¬** | **è¿ç§»å»ºè®®** |
|-------|------------|------------|-------------|
| `log.message.format.version` | `2.8-IV1` | `3.0-IV1` | `é€æ­¥å‡çº§` |
| `inter.broker.protocol.version` | `2.8-IV1` | `3.4-IV0` | `æ»šåŠ¨å‡çº§åä¿®æ”¹` |
| `group.coordinator.rebalance.protocols` | `["eager"]` | `["eager","cooperative"]` | `ä¿æŒé»˜è®¤` |

**é…ç½®è¿ç§»è„šæœ¬ç¤ºä¾‹**

```bash
#!/bin/bash
# config-migration.sh

OLD_CONFIG="/opt/kafka-2.8/config/server.properties"
NEW_CONFIG="/opt/kafka-3.4/config/server.properties"

# 1. å¤‡ä»½æ–°ç‰ˆæœ¬é»˜è®¤é…ç½®
cp $NEW_CONFIG ${NEW_CONFIG}.backup

# 2. è¿ç§»æ ¸å¿ƒé…ç½®
grep -E "^broker.id|^listeners|^zookeeper.connect" $OLD_CONFIG > temp_config
grep -E "^log.dirs|^num.network.threads" $OLD_CONFIG >> temp_config

# 3. åˆå¹¶é…ç½®æ–‡ä»¶
cat ${NEW_CONFIG}.backup temp_config > $NEW_CONFIG

# 4. æ¸…ç†ä¸´æ—¶æ–‡ä»¶
rm temp_config

echo "é…ç½®è¿ç§»å®Œæˆï¼Œè¯·æ£€æŸ¥ $NEW_CONFIG"
```

### 6.4 Topicé…ç½®è¿ç§»


**ğŸ”§ Topicé…ç½®æ£€æŸ¥ä¸è¿ç§»**

```bash
# 1. å¯¼å‡ºæ‰€æœ‰Topicé…ç½®
kafka-configs.sh --bootstrap-server localhost:9092 \
  --describe --entity-type topics > topics-config-backup.txt

# 2. æ£€æŸ¥ç‰¹æ®Šé…ç½®çš„Topic
kafka-topics.sh --bootstrap-server localhost:9092 --list | while read topic; do
  echo "=== Topic: $topic ==="
  kafka-configs.sh --bootstrap-server localhost:9092 \
    --describe --entity-type topics --entity-name $topic
done

# 3. è¿ç§»ç‰¹å®šTopicé…ç½®ï¼ˆå¦‚æœéœ€è¦ï¼‰
kafka-configs.sh --bootstrap-server localhost:9092 \
  --alter --entity-type topics --entity-name my-topic \
  --add-config retention.ms=604800000,segment.ms=86400000
```

---

## 7. ğŸ“± å®¢æˆ·ç«¯å‡çº§ç­–ç•¥


### 7.1 å®¢æˆ·ç«¯å‡çº§åŸºæœ¬åŸåˆ™


**å‡çº§ç­–ç•¥é€‰æ‹©**ï¼šå®¢æˆ·ç«¯å‡çº§æ¯”æœåŠ¡ç«¯å‡çº§æ›´çµæ´»ï¼Œä½†ä¹Ÿéœ€è¦è°¨æ…è§„åˆ’ã€‚

```
å‡çº§ä¼˜å…ˆçº§ï¼š
1. å…ˆå‡çº§æœåŠ¡ç«¯ï¼ˆKafka Brokerï¼‰
2. å†å‡çº§å®¢æˆ·ç«¯ï¼ˆProducer/Consumerï¼‰
3. æœ€åå‡çº§å‘¨è¾¹å·¥å…·ï¼ˆç›‘æ§ã€ç®¡ç†å·¥å…·ï¼‰

åŸå› ï¼šå‘å‰å…¼å®¹æ€§æ›´å¥½ä¿è¯
```

### 7.2 å®¢æˆ·ç«¯ç‰ˆæœ¬é€‰æ‹©ç­–ç•¥


**ğŸ“Š å®¢æˆ·ç«¯ç‰ˆæœ¬åŒ¹é…å»ºè®®**

| æœåŠ¡ç«¯ç‰ˆæœ¬ | **æ¨èå®¢æˆ·ç«¯ç‰ˆæœ¬** | **æœ€ä½å®¢æˆ·ç«¯ç‰ˆæœ¬** | **è¯´æ˜** |
|-----------|-------------------|-------------------|---------|
| `Kafka 3.4` | `3.4.x` | `2.8.x` | `æœ€ä½³æ€§èƒ½å’ŒåŠŸèƒ½` |
| `Kafka 3.0` | `3.0.x` | `2.6.x` | `ç¨³å®šå…¼å®¹` |
| `Kafka 2.8` | `2.8.x` | `2.4.x` | `ç”Ÿäº§ç¯å¢ƒéªŒè¯` |

### 7.3 Producerå®¢æˆ·ç«¯å‡çº§


**ğŸ”§ Java Producerå‡çº§ç¤ºä¾‹**

```java
// å‡çº§å‰ï¼šä½¿ç”¨è€ç‰ˆæœ¬ä¾èµ–
// <dependency>
//   <groupId>org.apache.kafka</groupId>  
//   <artifactId>kafka-clients</artifactId>
//   <version>2.8.0</version>
// </dependency>

// å‡çº§åï¼šä½¿ç”¨æ–°ç‰ˆæœ¬ä¾èµ–
// <dependency>
//   <groupId>org.apache.kafka</groupId>
//   <artifactId>kafka-clients</artifactId>
//   <version>3.4.0</version>
// </dependency>

// é…ç½®ä¿æŒå…¼å®¹
Properties props = new Properties();
props.put("bootstrap.servers", "localhost:9092");
props.put("key.serializer", "org.apache.kafka.common.serialization.StringSerializer");
props.put("value.serializer", "org.apache.kafka.common.serialization.StringSerializer");
// æ–°ç‰ˆæœ¬çš„é¢å¤–é…ç½®
props.put("enable.idempotence", true); // 3.0+é»˜è®¤å¼€å¯
props.put("acks", "all");

KafkaProducer<String, String> producer = new KafkaProducer<>(props);
```

### 7.4 Consumerå®¢æˆ·ç«¯å‡çº§


**ğŸ“± Consumerå‡çº§æ³¨æ„äº‹é¡¹**

```java
// Consumerç»„å‡çº§ç­–ç•¥
Properties props = new Properties();
props.put("bootstrap.servers", "localhost:9092");
props.put("group.id", "my-consumer-group");
props.put("key.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");
props.put("value.deserializer", "org.apache.kafka.common.serialization.StringDeserializer");

// é‡è¦ï¼šå‡çº§æ—¶ä¿æŒoffsetç®¡ç†å…¼å®¹
props.put("enable.auto.commit", true);
props.put("auto.commit.interval.ms", 1000);
props.put("auto.offset.reset", "latest");

// æ–°ç‰ˆæœ¬ç‰¹æ€§ï¼ˆå¯é€‰ï¼‰
props.put("partition.assignment.strategy", 
    "org.apache.kafka.clients.consumer.CooperativeStickyAssignor");

KafkaConsumer<String, String> consumer = new KafkaConsumer<>(props);
```

### 7.5 å®¢æˆ·ç«¯å‡çº§éªŒè¯


**âœ… å‡çº§åéªŒè¯æ¸…å•**

```bash
# 1. éªŒè¯è¿æ¥æ€§
kafka-console-producer.sh --bootstrap-server localhost:9092 \
  --topic test-topic

# 2. éªŒè¯æ¶ˆè´¹èƒ½åŠ›  
kafka-console-consumer.sh --bootstrap-server localhost:9092 \
  --topic test-topic --from-beginning

# 3. æ£€æŸ¥Consumer GroupçŠ¶æ€
kafka-consumer-groups.sh --bootstrap-server localhost:9092 \
  --describe --group my-consumer-group

# 4. ç›‘æ§å®¢æˆ·ç«¯æŒ‡æ ‡
# æ£€æŸ¥åº”ç”¨æ—¥å¿—ä¸­çš„è¿æ¥é”™è¯¯
# ç›‘æ§æ¶ˆæ¯å¤„ç†å»¶è¿Ÿ
# è§‚å¯Ÿå†…å­˜å’ŒCPUä½¿ç”¨æƒ…å†µ
```

---

## 8. ğŸ”™ å›é€€åº”æ€¥é¢„æ¡ˆ


### 8.1 å›é€€é¢„æ¡ˆçš„é‡è¦æ€§


**ä¸ºä»€ä¹ˆéœ€è¦å›é€€è®¡åˆ’**ï¼šå°±åƒå‡ºé—¨è¦å¸¦é›¨ä¼ä¸€æ ·ï¼Œå‡çº§ä¹Ÿè¦å‡†å¤‡"åæ‚”è¯"ã€‚

```
å›é€€åœºæ™¯ï¼š
â€¢ å‡çº§åæ€§èƒ½ä¸¥é‡ä¸‹é™
â€¢ å‘ç°ä¸¥é‡åŠŸèƒ½Bug
â€¢ å®¢æˆ·ç«¯å…¼å®¹æ€§é—®é¢˜
â€¢ æ•°æ®ä¸€è‡´æ€§é—®é¢˜
â€¢ ä¸šåŠ¡åŠŸèƒ½å¼‚å¸¸
```

### 8.2 å›é€€ç­–ç•¥åˆ†ç±»


**ğŸ¯ å›é€€æ–¹æ¡ˆé€‰æ‹©**

| å›é€€ç±»å‹ | **å›é€€é€Ÿåº¦** | **æ•°æ®é£é™©** | **é€‚ç”¨åœºæ™¯** |
|---------|------------|-------------|-------------|
| **é…ç½®å›é€€** | `æå¿«(åˆ†é’Ÿçº§)` | `æ— é£é™©` | `é…ç½®å¯¼è‡´çš„é—®é¢˜` |
| **ç‰ˆæœ¬å›é€€** | `å¿«é€Ÿ(å°æ—¶çº§)` | `ä½é£é™©` | `è½¯ä»¶Bugé—®é¢˜` |
| **æ•°æ®å›é€€** | `è¾ƒæ…¢(å°æ—¶åˆ°å¤©)` | `é«˜é£é™©` | `æ•°æ®ä¸€è‡´æ€§é—®é¢˜` |
| **å®Œå…¨é‡å»º** | `å¾ˆæ…¢(å¤©çº§)` | `æé«˜é£é™©` | `ç¾éš¾æ€§æ•…éšœ` |

### 8.3 é…ç½®å¿«é€Ÿå›é€€


**âš¡ é…ç½®çº§å›é€€æ“ä½œ**

```bash
#!/bin/bash
# quick-rollback.sh - é…ç½®å¿«é€Ÿå›é€€è„šæœ¬

# 1. åœæ­¢æœåŠ¡
systemctl stop kafka

# 2. æ¢å¤é…ç½®æ–‡ä»¶
cp /opt/kafka/config/server.properties.backup \
   /opt/kafka/config/server.properties

# 3. é‡å¯æœåŠ¡
systemctl start kafka

# 4. éªŒè¯æœåŠ¡çŠ¶æ€
sleep 10
systemctl status kafka

# 5. æ£€æŸ¥æ—¥å¿—
tail -n 50 /opt/kafka/logs/server.log

echo "é…ç½®å›é€€å®Œæˆï¼Œè¯·éªŒè¯é›†ç¾¤çŠ¶æ€"
```

### 8.4 ç‰ˆæœ¬å®Œæ•´å›é€€


**ğŸ”§ ç‰ˆæœ¬å›é€€è¯¦ç»†æ­¥éª¤**

```bash
# ç‰ˆæœ¬å›é€€æ“ä½œæµç¨‹

# 1. å‡†å¤‡é˜¶æ®µ
# ç¡®è®¤å›é€€ç‰ˆæœ¬è·¯å¾„å­˜åœ¨
ls -la /opt/kafka-backup-2.8.0/

# 2. é€å°å›é€€ï¼ˆæ»šåŠ¨å›é€€ï¼‰
# åœæ­¢å½“å‰Broker
systemctl stop kafka

# æ¢å¤è½¯é“¾æ¥åˆ°æ—§ç‰ˆæœ¬
rm /opt/kafka
ln -s /opt/kafka-backup-2.8.0 /opt/kafka

# æ¢å¤é…ç½®æ–‡ä»¶
cp /opt/kafka-backup-2.8.0/config/server.properties.prod \
   /opt/kafka/config/server.properties

# å¯åŠ¨æ—§ç‰ˆæœ¬
systemctl start kafka

# 3. éªŒè¯å›é€€ç»“æœ
# æ£€æŸ¥ç‰ˆæœ¬
kafka-broker-api-versions.sh --bootstrap-server localhost:9092

# æ£€æŸ¥é›†ç¾¤çŠ¶æ€
kafka-topics.sh --bootstrap-server localhost:9092 --list

# 4. ç›‘æ§é›†ç¾¤å¥åº·
kafka-log-dirs.sh --bootstrap-server localhost:9092 --describe
```

### 8.5 å›é€€éªŒè¯æ¸…å•


**âœ… å›é€€å®ŒæˆéªŒè¯**

```
åŠŸèƒ½éªŒè¯ï¼š
â€¢ æ‰€æœ‰Brokeræ­£å¸¸å¯åŠ¨
â€¢ Topicåˆ—è¡¨å®Œæ•´
â€¢ Producer/Consumeræ­£å¸¸å·¥ä½œ
â€¢ åˆ†åŒºçŠ¶æ€æ­£å¸¸

æ€§èƒ½éªŒè¯ï¼š
â€¢ æ¶ˆæ¯ååé‡æ¢å¤æ­£å¸¸
â€¢ å»¶è¿ŸæŒ‡æ ‡å›åˆ°åŸºçº¿
â€¢ èµ„æºä½¿ç”¨ç‡æ­£å¸¸
â€¢ æ— é”™è¯¯æ—¥å¿—

ä¸šåŠ¡éªŒè¯ï¼š
â€¢ å…³é”®ä¸šåŠ¡åŠŸèƒ½æ­£å¸¸
â€¢ æ•°æ®å¤„ç†æµç¨‹æ­£å¸¸
â€¢ ç›‘æ§å‘Šè­¦æ¶ˆå¤±
â€¢ ç”¨æˆ·åé¦ˆæ­£å¸¸
```

---

## 9. ğŸ“Š å‡çº§éªŒè¯ä¸ç›‘æ§


### 9.1 å‡çº§éªŒè¯æ¡†æ¶


**éªŒè¯çš„ä¸‰ä¸ªå±‚æ¬¡**ï¼šæŠ€æœ¯éªŒè¯ã€åŠŸèƒ½éªŒè¯ã€ä¸šåŠ¡éªŒè¯

```
éªŒè¯é‡‘å­—å¡”ï¼š

          ä¸šåŠ¡éªŒè¯
         /        \
      åŠŸèƒ½éªŒè¯    æ€§èƒ½éªŒè¯  
     /      \    /      \
  æŠ€æœ¯éªŒè¯  å…¼å®¹æ€§éªŒè¯  ç¨³å®šæ€§éªŒè¯
 /  |  \    |    |     |     \
åŸºç¡€ ç½‘ç»œ å­˜å‚¨ API åè®® å†…å­˜ CPU
```

### 9.2 æŠ€æœ¯å±‚é¢éªŒè¯


**ğŸ”§ åŸºç¡€æŠ€æœ¯éªŒè¯æ¸…å•**

```bash
# 1. é›†ç¾¤åŸºç¡€çŠ¶æ€æ£€æŸ¥
kafka-broker-api-versions.sh --bootstrap-server localhost:9092

# 2. Topicå®Œæ•´æ€§éªŒè¯
kafka-topics.sh --bootstrap-server localhost:9092 --list | wc -l
# å¯¹æ¯”å‡çº§å‰Topicæ•°é‡

# 3. åˆ†åŒºçŠ¶æ€æ£€æŸ¥
kafka-topics.sh --bootstrap-server localhost:9092 --describe | grep "PartitionCount"

# 4. å‰¯æœ¬åŒæ­¥çŠ¶æ€
kafka-replica-verification.sh --broker-list kafka1:9092,kafka2:9092,kafka3:9092

# 5. Consumer GroupçŠ¶æ€
kafka-consumer-groups.sh --bootstrap-server localhost:9092 --list
```

### 9.3 åŠŸèƒ½éªŒè¯æµ‹è¯•


**ğŸ“‹ ç«¯åˆ°ç«¯åŠŸèƒ½æµ‹è¯•**

```bash
#!/bin/bash
# functional-test.sh - åŠŸèƒ½éªŒè¯è„šæœ¬

# åˆ›å»ºæµ‹è¯•Topic
kafka-topics.sh --bootstrap-server localhost:9092 \
  --create --topic upgrade-test --partitions 3 --replication-factor 3

# ç”Ÿäº§æµ‹è¯•æ¶ˆæ¯
echo "å‡çº§æµ‹è¯•æ¶ˆæ¯ $(date)" | kafka-console-producer.sh \
  --bootstrap-server localhost:9092 --topic upgrade-test

# æ¶ˆè´¹æµ‹è¯•æ¶ˆæ¯
timeout 10s kafka-console-consumer.sh \
  --bootstrap-server localhost:9092 --topic upgrade-test --from-beginning

# æµ‹è¯•Consumer Group
kafka-console-consumer.sh --bootstrap-server localhost:9092 \
  --topic upgrade-test --group test-group &
CONSUMER_PID=$!

sleep 5
kill $CONSUMER_PID

# æ£€æŸ¥Consumer GroupçŠ¶æ€
kafka-consumer-groups.sh --bootstrap-server localhost:9092 \
  --describe --group test-group

# æ¸…ç†æµ‹è¯•Topic
kafka-topics.sh --bootstrap-server localhost:9092 \
  --delete --topic upgrade-test

echo "åŠŸèƒ½éªŒè¯å®Œæˆ"
```

### 9.4 æ€§èƒ½åŸºçº¿å¯¹æ¯”


**ğŸ“Š å…³é”®æ€§èƒ½æŒ‡æ ‡ç›‘æ§**

```
æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡ï¼š

ååé‡æŒ‡æ ‡ï¼š
â€¢ Messages/secï¼šæ¯ç§’å¤„ç†æ¶ˆæ¯æ•°
â€¢ MB/secï¼šæ¯ç§’å¤„ç†æ•°æ®é‡
â€¢ Records/secï¼šæ¯ç§’è®°å½•æ•°

å»¶è¿ŸæŒ‡æ ‡ï¼š
â€¢ Producerå»¶è¿Ÿï¼šæ¶ˆæ¯å‘é€æ—¶é—´
â€¢ Consumerå»¶è¿Ÿï¼šæ¶ˆæ¯æ¶ˆè´¹å»¶è¿Ÿ
â€¢ End-to-endå»¶è¿Ÿï¼šç«¯åˆ°ç«¯å»¶è¿Ÿ

èµ„æºæŒ‡æ ‡ï¼š
â€¢ CPUä½¿ç”¨ç‡ï¼šå¤„ç†å™¨è´Ÿè½½
â€¢ å†…å­˜ä½¿ç”¨ï¼šJVMå †å†…å­˜
â€¢ ç£ç›˜I/Oï¼šè¯»å†™æ“ä½œæ•°
â€¢ ç½‘ç»œI/Oï¼šç½‘ç»œå¸¦å®½ä½¿ç”¨
```

### 9.5 æŒç»­ç›‘æ§ç­–ç•¥


**â° å‡çº§åç›‘æ§è®¡åˆ’**

```
ç›‘æ§æ—¶é—´è¡¨ï¼š

ç¬¬1å°æ—¶ï¼šå¯†é›†ç›‘æ§
â€¢ æ¯5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡å…³é”®æŒ‡æ ‡
â€¢ å®æ—¶å…³æ³¨é”™è¯¯æ—¥å¿—
â€¢ ç›‘æ§å®¢æˆ·ç«¯è¿æ¥çŠ¶æ€

ç¬¬1å¤©ï¼šé‡ç‚¹ç›‘æ§  
â€¢ æ¯30åˆ†é’Ÿæ£€æŸ¥æ€§èƒ½æŒ‡æ ‡
â€¢ ç›‘æ§ä¸šåŠ¡å…³é”®æŒ‡æ ‡
â€¢ æ”¶é›†ç”¨æˆ·åé¦ˆ

ç¬¬1å‘¨ï¼šå¸¸è§„ç›‘æ§
â€¢ æ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡
â€¢ å¯¹æ¯”å‡çº§å‰åæ€§èƒ½
â€¢ åˆ†æè¶‹åŠ¿å˜åŒ–

ç¬¬1æœˆï¼šåŸºçº¿å»ºç«‹
â€¢ å»ºç«‹æ–°çš„æ€§èƒ½åŸºçº¿
â€¢ æ€»ç»“å‡çº§ç»éªŒ
â€¢ ä¼˜åŒ–ç›‘æ§ç­–ç•¥
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å‡çº§ç­–ç•¥ï¼šæ»šåŠ¨å‡çº§æœ€å°åŒ–ä¸šåŠ¡å½±å“ï¼Œè“ç»¿éƒ¨ç½²é£é™©æœ€ä½
ğŸ”¸ ç‰ˆæœ¬å…¼å®¹ï¼šå‘å‰å…¼å®¹æ€§å¥½ï¼Œå‘åå…¼å®¹éœ€è°¨æ…ï¼Œå®¢æˆ·ç«¯ç‰ˆæœ¬ä¸è¶…å‰å¤ªå¤š
ğŸ”¸ æ•°æ®è¿ç§»ï¼šMirrorMakeræ˜¯ä¸»æµå·¥å…·ï¼Œç›‘æ§å¤åˆ¶è¿›åº¦å¾ˆé‡è¦
ğŸ”¸ åˆ†åŒºé‡åˆ†é…ï¼šé›†ç¾¤æ‰©ç¼©å®¹å¿…å¤‡æŠ€èƒ½ï¼Œæ³¨æ„æ§åˆ¶é‡åˆ†é…é€Ÿåº¦
ğŸ”¸ é…ç½®è¿ç§»ï¼šæ ¸å¿ƒé…ç½®å¿…é¡»ä¿ç•™ï¼Œæ³¨æ„ç‰ˆæœ¬é—´å·®å¼‚
ğŸ”¸ å›é€€é¢„æ¡ˆï¼šå‡†å¤‡å……åˆ†çš„å›é€€æ–¹æ¡ˆï¼ŒéªŒè¯å›é€€è·¯å¾„å¯ç”¨
```

### 10.2 å…³é”®æ“ä½œè¦ç‚¹


**ğŸ”¹ å‡çº§å‰å‡†å¤‡**
```
æ£€æŸ¥æ¸…å•ï¼š
â€¢ ç‰ˆæœ¬å…¼å®¹æ€§ç¡®è®¤
â€¢ é…ç½®æ–‡ä»¶å¤‡ä»½
â€¢ æ•°æ®å®Œæ•´æ€§éªŒè¯
â€¢ å›é€€æ–¹æ¡ˆå‡†å¤‡
â€¢ ä¸šåŠ¡å½±å“è¯„ä¼°
â€¢ æ—¶é—´çª—å£å®‰æ’
```

**ğŸ”¹ å‡çº§è¿‡ç¨‹æ§åˆ¶**
```
æ§åˆ¶è¦ç‚¹ï¼š
â€¢ ä¸€å°ä¸€å°é€æ­¥å‡çº§
â€¢ æ¯å°å‡çº§åéªŒè¯çŠ¶æ€
â€¢ ç›‘æ§é›†ç¾¤å¥åº·æŒ‡æ ‡
â€¢ åŠæ—¶å¤„ç†å¼‚å¸¸æƒ…å†µ
â€¢ ä¿æŒä¸ä¸šåŠ¡æ–¹æ²Ÿé€š
```

**ğŸ”¹ å‡çº§åéªŒè¯**
```
éªŒè¯å±‚æ¬¡ï¼š
â€¢ æŠ€æœ¯å±‚ï¼šæœåŠ¡å¯åŠ¨ã€è¿æ¥æ­£å¸¸
â€¢ åŠŸèƒ½å±‚ï¼šç”Ÿäº§æ¶ˆè´¹æ­£å¸¸
â€¢ æ€§èƒ½å±‚ï¼šååå»¶è¿Ÿæ­£å¸¸
â€¢ ä¸šåŠ¡å±‚ï¼šä¸šåŠ¡åŠŸèƒ½æ­£å¸¸
```

### 10.3 æœ€ä½³å®è·µå»ºè®®


**ğŸ’¡ ç”Ÿäº§ç¯å¢ƒå»ºè®®**
- **å°æ­¥å¿«è·‘**ï¼šåˆ†é˜¶æ®µå‡çº§ï¼Œé™ä½é£é™©
- **å……åˆ†æµ‹è¯•**ï¼šåœ¨æµ‹è¯•ç¯å¢ƒå®Œæ•´æ¼”ç»ƒ
- **ç›‘æ§ä¸ºç‹**ï¼šå…¨ç¨‹ç›‘æ§ï¼ŒåŠæ—¶å‘ç°é—®é¢˜
- **å›é€€å‡†å¤‡**ï¼šç¡®ä¿éšæ—¶å¯ä»¥å®‰å…¨å›é€€
- **å›¢é˜Ÿåä½œ**ï¼šå¼€å‘ã€è¿ç»´ã€ä¸šåŠ¡å›¢é˜Ÿå¯†åˆ‡é…åˆ

**âš ï¸ å¸¸è§é™·é˜±é¿å…**
- ä¸è¦è·³è·ƒå¼å‡çº§å¤ªå¤šç‰ˆæœ¬
- ä¸è¦åœ¨ä¸šåŠ¡é«˜å³°æœŸå‡çº§
- ä¸è¦å¿½è§†å®¢æˆ·ç«¯å…¼å®¹æ€§
- ä¸è¦ç¼ºå°‘å……åˆ†çš„å›é€€æµ‹è¯•
- ä¸è¦å‡çº§åç«‹å³åˆ é™¤å¤‡ä»½

**ğŸ¯ æˆåŠŸå‡çº§çš„å…³é”®**
```
å‡†å¤‡å……åˆ†ï¼š
â€¢ è¯¦ç»†çš„å‡çº§è®¡åˆ’
â€¢ å®Œæ•´çš„é£é™©è¯„ä¼°  
â€¢ å……åˆ†çš„æµ‹è¯•éªŒè¯

æ‰§è¡Œæœ‰åºï¼š
â€¢ ä¸¥æ ¼æŒ‰æµç¨‹æ“ä½œ
â€¢ å®æ—¶ç›‘æ§çŠ¶æ€
â€¢ åŠæ—¶å“åº”é—®é¢˜

éªŒè¯å…¨é¢ï¼š
â€¢ å¤šå±‚æ¬¡éªŒè¯
â€¢ æ€§èƒ½åŸºçº¿å¯¹æ¯”
â€¢ ä¸šåŠ¡åŠŸèƒ½ç¡®è®¤
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- Kafkaå‡çº§éœ€è¦è°¨æ…è§„åˆ’ï¼Œæ»šåŠ¨å‡çº§æ˜¯æœ€å®‰å…¨çš„æ–¹å¼
- ç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥æ˜¯å‡çº§å‰çš„å¿…è¦æ­¥éª¤
- æ•°æ®è¿ç§»è¦é€‰æ‹©åˆé€‚å·¥å…·ï¼ŒMirrorMakeræ˜¯é¦–é€‰
- åˆ†åŒºé‡åˆ†é…å¸®åŠ©ä¼˜åŒ–é›†ç¾¤è´Ÿè½½åˆ†å¸ƒ
- å›é€€é¢„æ¡ˆæ˜¯å‡çº§å®‰å…¨ç½‘ï¼Œå¿…é¡»æå‰å‡†å¤‡å’ŒéªŒè¯