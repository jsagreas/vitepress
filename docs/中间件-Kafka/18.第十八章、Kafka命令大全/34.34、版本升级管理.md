---
title: 34ã€ç‰ˆæœ¬å‡çº§ç®¡ç†
---
## ðŸ“š ç›®å½•

1. [Kafkaç‰ˆæœ¬å‡çº§åŸºç¡€æ¦‚å¿µ](#1-kafkaç‰ˆæœ¬å‡çº§åŸºç¡€æ¦‚å¿µ)
2. [ç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥](#2-ç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥)
3. [å‡çº§å‰å‡†å¤‡ä¸ŽéªŒè¯](#3-å‡çº§å‰å‡†å¤‡ä¸ŽéªŒè¯)
4. [æ»šåŠ¨å‡çº§å®žæˆ˜æµç¨‹](#4-æ»šåŠ¨å‡çº§å®žæˆ˜æµç¨‹)
5. [åè®®ç‰ˆæœ¬ç®¡ç†](#5-åè®®ç‰ˆæœ¬ç®¡ç†)
6. [ç‰¹æ€§å¼€å…³é…ç½®](#6-ç‰¹æ€§å¼€å…³é…ç½®)
7. [å‡çº§é£Žé™©è¯„ä¼°ä¸Žå›žé€€](#7-å‡çº§é£Žé™©è¯„ä¼°ä¸Žå›žé€€)
8. [å‡çº§åŽéªŒè¯æµ‹è¯•](#8-å‡çº§åŽéªŒè¯æµ‹è¯•)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ðŸ”„ Kafkaç‰ˆæœ¬å‡çº§åŸºç¡€æ¦‚å¿µ


### 1.1 ä¸ºä»€ä¹ˆè¦å‡çº§Kafka


**å‡çº§Kafkaå°±åƒç»™æ±½è½¦ä¿å…»ä¸€æ · - è™½ç„¶è€è½¦è¿˜èƒ½å¼€ï¼Œä½†æ–°åŠŸèƒ½è®©ä½ è·‘å¾—æ›´å¿«æ›´å®‰å…¨ï¼**

å‡çº§Kafkaèƒ½å¸¦æ¥ä»€ä¹ˆå¥½å¤„ï¼š
- **æ€§èƒ½æå‡**ï¼šæ–°ç‰ˆæœ¬é€šå¸¸æœ‰æ›´å¥½çš„åžåé‡å’Œå»¶è¿Ÿè¡¨çŽ°
- **å®‰å…¨å¢žå¼º**ï¼šä¿®å¤å·²çŸ¥æ¼æ´žï¼ŒåŠ å¼ºæƒé™æŽ§åˆ¶
- **åŠŸèƒ½ä¸°å¯Œ**ï¼šæ–°å¢žå®žç”¨åŠŸèƒ½ï¼Œæå‡å¼€å‘æ•ˆçŽ‡
- **ç¨³å®šæ€§**ï¼šä¿®å¤è€ç‰ˆæœ¬çš„bugï¼Œè¿è¡Œæ›´ç¨³å®š
- **ç¤¾åŒºæ”¯æŒ**ï¼šè€ç‰ˆæœ¬é€æ¸åœæ­¢ç»´æŠ¤ï¼Œæ–°ç‰ˆæœ¬æœ‰æ›´å¥½çš„æŠ€æœ¯æ”¯æŒ

### 1.2 Kafkaç‰ˆæœ¬ç±»åž‹è§£æž


**ðŸ·ï¸ ç‰ˆæœ¬å·å‘½åè§„åˆ™**

Kafkaç‰ˆæœ¬å·é‡‡ç”¨ `ä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.ä¿®è®¢ç‰ˆæœ¬` çš„æ ¼å¼ï¼Œæ¯”å¦‚ `3.5.1`ï¼š

```
ç‰ˆæœ¬å·è§£è¯»ï¼š
3.5.1
â†‘ â†‘ â†‘
â”‚ â”‚ â””â”€â”€ ä¿®è®¢ç‰ˆæœ¬ï¼ˆPatchï¼‰ï¼šbugä¿®å¤ï¼Œå®Œå…¨å…¼å®¹
â”‚ â””â”€â”€â”€â”€ æ¬¡ç‰ˆæœ¬ï¼ˆMinorï¼‰ï¼šæ–°åŠŸèƒ½ï¼Œå‘åŽå…¼å®¹
â””â”€â”€â”€â”€â”€â”€ ä¸»ç‰ˆæœ¬ï¼ˆMajorï¼‰ï¼šé‡å¤§å˜æ›´ï¼Œå¯èƒ½ä¸å…¼å®¹

å‡çº§é£Žé™©ç­‰çº§ï¼š
ä¿®è®¢ç‰ˆæœ¬å‡çº§ï¼šðŸŸ¢ é£Žé™©å¾ˆä½Žï¼Œå¯ä»¥æ”¾å¿ƒå‡çº§
æ¬¡ç‰ˆæœ¬å‡çº§ï¼šðŸŸ¡ é£Žé™©ä¸­ç­‰ï¼Œéœ€è¦æµ‹è¯•éªŒè¯
ä¸»ç‰ˆæœ¬å‡çº§ï¼šðŸ”´ é£Žé™©è¾ƒé«˜ï¼Œéœ€è¦å……åˆ†å‡†å¤‡
```

### 1.3 å‡çº§ç­–ç•¥é€‰æ‹©


**âš–ï¸ å‡çº§æ–¹å¼å¯¹æ¯”**

| å‡çº§æ–¹å¼ | **é€‚ç”¨åœºæ™¯** | **åœæœºæ—¶é—´** | **é£Žé™©ç¨‹åº¦** | **å¤æ‚åº¦** |
|---------|-------------|-------------|-------------|-----------|
| **åœæœºå‡çº§** | `å¼€å‘/æµ‹è¯•çŽ¯å¢ƒ` | `å®Œå…¨åœæœº` | `ä½Ž` | `ç®€å•` |
| **æ»šåŠ¨å‡çº§** | `ç”Ÿäº§çŽ¯å¢ƒ` | `æ— åœæœº` | `ä¸­ç­‰` | `ä¸­ç­‰` |
| **è“ç»¿éƒ¨ç½²** | `å…³é”®ä¸šåŠ¡` | `çž¬é—´åˆ‡æ¢` | `ä½Ž` | `é«˜` |

**ðŸŽ¯ é€‰æ‹©å»ºè®®**ï¼š
- **å¼€å‘çŽ¯å¢ƒ**ï¼šç›´æŽ¥åœæœºå‡çº§ï¼Œç®€å•å¿«æ·
- **ç”Ÿäº§çŽ¯å¢ƒ**ï¼šä¼˜å…ˆé€‰æ‹©æ»šåŠ¨å‡çº§ï¼Œä¿è¯ä¸šåŠ¡è¿žç»­æ€§
- **å…³é”®ç³»ç»Ÿ**ï¼šè€ƒè™‘è“ç»¿éƒ¨ç½²ï¼Œæœ€å¤§åŒ–ç¨³å®šæ€§

---

## 2. ðŸ” ç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥


### 2.1 å…¼å®¹æ€§åŸºç¡€çŸ¥è¯†


**ä»€ä¹ˆæ˜¯å…¼å®¹æ€§ï¼Ÿ**
å°±åƒæ–°æ‰‹æœºè¦èƒ½æ’è€å……ç”µå™¨ä¸€æ ·ï¼Œæ–°ç‰ˆæœ¬Kafkaè¦èƒ½å’Œè€ç‰ˆæœ¬çš„å®¢æˆ·ç«¯ã€å·¥å…·æ­£å¸¸é€šä¿¡ã€‚

**ðŸ”— å…¼å®¹æ€§å±‚æ¬¡**ï¼š
```
å‘åŽå…¼å®¹ï¼ˆBackward Compatibleï¼‰ï¼š
æ–°æœåŠ¡å™¨ â†â†’ è€å®¢æˆ·ç«¯ âœ…
ä¾‹ï¼šKafka 3.0æœåŠ¡å™¨ + Kafka 2.8å®¢æˆ·ç«¯

å‘å‰å…¼å®¹ï¼ˆForward Compatibleï¼‰ï¼š
è€æœåŠ¡å™¨ â†â†’ æ–°å®¢æˆ·ç«¯ â“
ä¾‹ï¼šKafka 2.8æœåŠ¡å™¨ + Kafka 3.0å®¢æˆ·ç«¯ï¼ˆé€šå¸¸ä¸æŽ¨èï¼‰

åŒå‘å…¼å®¹ï¼š
æ–°è€ç‰ˆæœ¬å¯ä»¥äº’ç›¸é€šä¿¡ âœ…
```

### 2.2 ç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥å‘½ä»¤


**ðŸ”§ æ£€æŸ¥å½“å‰ç‰ˆæœ¬ä¿¡æ¯**

```bash
# æŸ¥çœ‹KafkaæœåŠ¡å™¨ç‰ˆæœ¬
kafka-broker-api-versions.sh --bootstrap-server localhost:9092

# æŸ¥çœ‹å®¢æˆ·ç«¯å·¥å…·ç‰ˆæœ¬
kafka-topics.sh --version

# æŸ¥çœ‹Javaç‰ˆæœ¬ï¼ˆKafkaè¿è¡Œä¾èµ–ï¼‰
java -version
```

**ðŸ“‹ æ”¯æŒçš„åè®®ç‰ˆæœ¬æ£€æŸ¥**

```bash
# æŸ¥çœ‹æœåŠ¡å™¨æ”¯æŒçš„APIç‰ˆæœ¬èŒƒå›´
kafka-broker-api-versions.sh --bootstrap-server localhost:9092 \
  --output json | grep -A 2 -B 2 "apiKey"

# æ£€æŸ¥ç‰¹å®šAPIçš„ç‰ˆæœ¬æ”¯æŒ
kafka-broker-api-versions.sh --bootstrap-server localhost:9092 | \
  grep "Produce\|Fetch\|Metadata"
```

### 2.3 å®¢æˆ·ç«¯å…¼å®¹æ€§éªŒè¯


**ðŸ§ª å…¼å®¹æ€§æµ‹è¯•æ–¹æ³•**

åœ¨å‡çº§å‰ï¼Œç”¨ç®€å•çš„æµ‹è¯•éªŒè¯å…¼å®¹æ€§ï¼š

```bash
# åˆ›å»ºæµ‹è¯•ä¸»é¢˜
kafka-topics.sh --bootstrap-server localhost:9092 \
  --create --topic compatibility-test --partitions 1 --replication-factor 1

# æµ‹è¯•ç”Ÿäº§æ¶ˆæ¯
echo "compatibility test message" | \
kafka-console-producer.sh --bootstrap-server localhost:9092 \
  --topic compatibility-test

# æµ‹è¯•æ¶ˆè´¹æ¶ˆæ¯
kafka-console-consumer.sh --bootstrap-server localhost:9092 \
  --topic compatibility-test --from-beginning --timeout-ms 5000
```

**âš ï¸ å¸¸è§å…¼å®¹æ€§é—®é¢˜**ï¼š
- **åºåˆ—åŒ–æ ¼å¼å˜æ›´**ï¼šå¯èƒ½å¯¼è‡´æ¶ˆæ¯æ— æ³•æ­£ç¡®è§£æž
- **APIæŽ¥å£å˜åŒ–**ï¼šè€å®¢æˆ·ç«¯å¯èƒ½æ— æ³•è°ƒç”¨æ–°æŽ¥å£
- **é…ç½®å‚æ•°åºŸå¼ƒ**ï¼šè€é…ç½®å¯èƒ½ä¸å†ç”Ÿæ•ˆ

---

## 3. ðŸ› ï¸ å‡çº§å‰å‡†å¤‡ä¸ŽéªŒè¯


### 3.1 çŽ¯å¢ƒå‡†å¤‡æ¸…å•


**ðŸ“‹ å‡çº§å‰å¿…å¤‡æ£€æŸ¥é¡¹**

```
âœ… æ•°æ®å¤‡ä»½ï¼š
â–¡ å¤‡ä»½æ‰€æœ‰ä¸»é¢˜æ•°æ®
â–¡ å¤‡ä»½ZooKeeperæ•°æ®ï¼ˆå¦‚æžœä½¿ç”¨ï¼‰
â–¡ å¤‡ä»½é…ç½®æ–‡ä»¶
â–¡ è®°å½•å½“å‰é›†ç¾¤çŠ¶æ€

âœ… èµ„æºæ£€æŸ¥ï¼š
â–¡ æ£€æŸ¥ç£ç›˜ç©ºé—´ï¼ˆè‡³å°‘å‰©ä½™30%ï¼‰
â–¡ æ£€æŸ¥å†…å­˜ä½¿ç”¨æƒ…å†µ
â–¡ æ£€æŸ¥ç½‘ç»œè¿žæŽ¥çŠ¶æ€
â–¡ ç¡®è®¤Javaç‰ˆæœ¬å…¼å®¹æ€§

âœ… ä¾èµ–ç¡®è®¤ï¼š
â–¡ å®¢æˆ·ç«¯åº”ç”¨å…¼å®¹æ€§
â–¡ ç›‘æŽ§å·¥å…·å…¼å®¹æ€§
â–¡ ç®¡ç†å·¥å…·å…¼å®¹æ€§
â–¡ ç¬¬ä¸‰æ–¹é›†æˆç»„ä»¶
```

### 3.2 å‡çº§å‰éªŒè¯å‘½ä»¤


**ðŸ” é›†ç¾¤å¥åº·çŠ¶æ€æ£€æŸ¥**

```bash
# æ£€æŸ¥é›†ç¾¤èŠ‚ç‚¹çŠ¶æ€
kafka-broker-api-versions.sh --bootstrap-server localhost:9092

# æ£€æŸ¥ä¸»é¢˜çŠ¶æ€
kafka-topics.sh --bootstrap-server localhost:9092 --list

# æ£€æŸ¥æ¶ˆè´¹è€…ç»„çŠ¶æ€
kafka-consumer-groups.sh --bootstrap-server localhost:9092 --list

# æ£€æŸ¥é›†ç¾¤æ€§èƒ½æŒ‡æ ‡
kafka-run-class.sh kafka.tools.JmxTool \
  --object-name kafka.server:type=BrokerTopicMetrics,name=MessagesInPerSec \
  --jmx-url service:jmx:rmi:///jndi/rmi://localhost:9999/jmxrmi
```

**ðŸ’¾ æ•°æ®å¤‡ä»½éªŒè¯**

```bash
# éªŒè¯ä¸»é¢˜æ•°æ®å®Œæ•´æ€§
kafka-log-dirs.sh --bootstrap-server localhost:9092 \
  --describe --json | grep -c "\"topic\""

# æ£€æŸ¥å‰¯æœ¬åŒæ­¥çŠ¶æ€
kafka-topics.sh --bootstrap-server localhost:9092 \
  --describe --under-replicated-partitions

# éªŒè¯æ¶ˆè´¹è€…ä½ç§»ä¿¡æ¯
kafka-consumer-groups.sh --bootstrap-server localhost:9092 \
  --describe --group your-consumer-group
```

### 3.3 å‡çº§è®¡åˆ’åˆ¶å®š


**ðŸ“… å‡çº§æ—¶é—´çª—å£è§„åˆ’**

```
å‡çº§æ—¶é—´é€‰æ‹©åŽŸåˆ™ï¼š
ðŸ• ä¸šåŠ¡ä½Žå³°æœŸï¼šé€‰æ‹©æµé‡æœ€å°‘çš„æ—¶é—´æ®µ
ðŸ• ç»´æŠ¤çª—å£ï¼šé¢„ç•™è¶³å¤Ÿçš„æ—¶é—´å¤„ç†æ„å¤–æƒ…å†µ
ðŸ• å›žæ»šæ—¶é—´ï¼šç¡®ä¿æœ‰è¶³å¤Ÿæ—¶é—´è¿›è¡Œå›žæ»šæ“ä½œ

å»ºè®®æ—¶é—´å®‰æŽ’ï¼š
â€¢ å°è§„æ¨¡é›†ç¾¤ï¼ˆ3èŠ‚ç‚¹ï¼‰ï¼š2-4å°æ—¶
â€¢ ä¸­ç­‰è§„æ¨¡é›†ç¾¤ï¼ˆ6-10èŠ‚ç‚¹ï¼‰ï¼š4-6å°æ—¶  
â€¢ å¤§è§„æ¨¡é›†ç¾¤ï¼ˆ10+èŠ‚ç‚¹ï¼‰ï¼š6-8å°æ—¶
```

---

## 4. ðŸš€ æ»šåŠ¨å‡çº§å®žæˆ˜æµç¨‹


### 4.1 æ»šåŠ¨å‡çº§åŸºæœ¬åŽŸç†


**ä»€ä¹ˆæ˜¯æ»šåŠ¨å‡çº§ï¼Ÿ**
å°±åƒä¿®è·¯ä¸€æ ·ï¼Œä¸èƒ½æŠŠæ‰€æœ‰è½¦é“éƒ½å°é—­ï¼Œè¦ä¸€æ¡ä¸€æ¡åœ°ä¿®ï¼Œä¿è¯äº¤é€šä¸ä¸­æ–­ã€‚

```
æ»šåŠ¨å‡çº§æµç¨‹å›¾ï¼š
èŠ‚ç‚¹1 [å‡çº§ä¸­] â† æš‚åœæœåŠ¡
èŠ‚ç‚¹2 [è¿è¡Œä¸­] â† å¤„ç†è¯·æ±‚
èŠ‚ç‚¹3 [è¿è¡Œä¸­] â† å¤„ç†è¯·æ±‚
     â†“
èŠ‚ç‚¹1 [è¿è¡Œä¸­] â† å‡çº§å®Œæˆ
èŠ‚ç‚¹2 [å‡çº§ä¸­] â† æš‚åœæœåŠ¡  
èŠ‚ç‚¹3 [è¿è¡Œä¸­] â† å¤„ç†è¯·æ±‚
     â†“
èŠ‚ç‚¹1 [è¿è¡Œä¸­] â† å‡çº§å®Œæˆ
èŠ‚ç‚¹2 [è¿è¡Œä¸­] â† å‡çº§å®Œæˆ
èŠ‚ç‚¹3 [å‡çº§ä¸­] â† æœ€åŽå‡çº§
```

### 4.2 ControllerèŠ‚ç‚¹å‡çº§


**âš¡ é‡è¦æé†’**ï¼šControllerèŠ‚ç‚¹è¦æœ€åŽå‡çº§ï¼

Controllerå°±åƒä¹é˜ŸæŒ‡æŒ¥ï¼Œè¦ç¡®ä¿æ‰€æœ‰ä¹æ‰‹éƒ½å‡çº§å®Œæ¯•åŽï¼ŒæŒ‡æŒ¥æ‰èƒ½å‡çº§ã€‚

```bash
# 1. æ‰¾å‡ºå½“å‰ControllerèŠ‚ç‚¹
kafka-metadata.sh --bootstrap-server localhost:9092 \
  --describe --entity-type brokers

# 2. æ£€æŸ¥ControllerçŠ¶æ€
echo "dump" | nc localhost 2181 | grep -i controller

# 3. å‡çº§éžControllerèŠ‚ç‚¹
# å¯¹æ¯ä¸ªéžControllerèŠ‚ç‚¹æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

# åœæ­¢KafkaæœåŠ¡
sudo systemctl stop kafka

# å¤‡ä»½å½“å‰ç‰ˆæœ¬
sudo cp -r /opt/kafka /opt/kafka-backup-$(date +%Y%m%d)

# å®‰è£…æ–°ç‰ˆæœ¬
sudo tar -xzf kafka_2.13-3.5.1.tgz -C /opt/
sudo ln -sf /opt/kafka_2.13-3.5.1 /opt/kafka

# å¯åŠ¨æœåŠ¡
sudo systemctl start kafka

# éªŒè¯èŠ‚ç‚¹å¯åŠ¨æˆåŠŸ
kafka-broker-api-versions.sh --bootstrap-server localhost:9092
```

### 4.3 å‡çº§æ­¥éª¤è¯¦è§£


**ðŸ“ å•èŠ‚ç‚¹å‡çº§è¯¦ç»†æ­¥éª¤**

**æ­¥éª¤1ï¼šå‡†å¤‡å‡çº§**
```bash
# æ£€æŸ¥èŠ‚ç‚¹çŠ¶æ€
kafka-log-dirs.sh --bootstrap-server current-node:9092 --describe

# ç¡®è®¤æ²¡æœ‰æ­£åœ¨è¿›è¡Œçš„åˆ†åŒºé‡åˆ†é…
kafka-reassign-partitions.sh --bootstrap-server localhost:9092 --list
```

**æ­¥éª¤2ï¼šä¼˜é›…åœæœº**
```bash
# å…ˆç§»é™¤èŠ‚ç‚¹çš„Leaderåˆ†åŒºï¼ˆå¯é€‰ï¼Œå‡å°‘å½±å“ï¼‰
kafka-leader-election.sh --bootstrap-server localhost:9092 \
  --election-type preferred --all-topic-partitions

# åœæ­¢KafkaæœåŠ¡
sudo systemctl stop kafka

# ç¡®è®¤è¿›ç¨‹å·²å®Œå…¨åœæ­¢
ps aux | grep kafka
```

**æ­¥éª¤3ï¼šç‰ˆæœ¬æ›¿æ¢**
```bash
# å¤‡ä»½åŽŸç‰ˆæœ¬
sudo mv /opt/kafka /opt/kafka-old

# è§£åŽ‹æ–°ç‰ˆæœ¬
sudo tar -xzf kafka_2.13-3.5.1.tgz -C /opt/
sudo mv /opt/kafka_2.13-3.5.1 /opt/kafka

# å¤åˆ¶é…ç½®æ–‡ä»¶
sudo cp /opt/kafka-old/config/server.properties /opt/kafka/config/
```

**æ­¥éª¤4ï¼šå¯åŠ¨éªŒè¯**
```bash
# å¯åŠ¨æœåŠ¡
sudo systemctl start kafka

# æ£€æŸ¥æ—¥å¿—
tail -f /opt/kafka/logs/server.log

# éªŒè¯èŠ‚ç‚¹åŠ å…¥é›†ç¾¤
kafka-broker-api-versions.sh --bootstrap-server localhost:9092
```

### 4.4 å‡çº§è¿‡ç¨‹ç›‘æŽ§


**ðŸ“Š å…³é”®ç›‘æŽ§æŒ‡æ ‡**

åœ¨å‡çº§è¿‡ç¨‹ä¸­ï¼Œè¦å¯†åˆ‡å…³æ³¨è¿™äº›æŒ‡æ ‡ï¼š

```bash
# ç›‘æŽ§é›†ç¾¤å¯ç”¨æ€§
watch -n 5 "kafka-topics.sh --bootstrap-server localhost:9092 --list | wc -l"

# ç›‘æŽ§å‰¯æœ¬åŒæ­¥çŠ¶æ€
watch -n 10 "kafka-topics.sh --bootstrap-server localhost:9092 \
  --describe --under-replicated-partitions | wc -l"

# ç›‘æŽ§æ¶ˆè´¹è€…å»¶è¿Ÿ
kafka-consumer-groups.sh --bootstrap-server localhost:9092 \
  --describe --group your-group --state
```

**ðŸš¨ å¼‚å¸¸æƒ…å†µå¤„ç†**ï¼š
- **èŠ‚ç‚¹å¯åŠ¨å¤±è´¥**ï¼šæ£€æŸ¥æ—¥å¿—ï¼Œç¡®è®¤é…ç½®æ–‡ä»¶æ­£ç¡®æ€§
- **å‰¯æœ¬åŒæ­¥å¼‚å¸¸**ï¼šç­‰å¾…åŒæ­¥å®Œæˆï¼Œä¸è¦å¼ºåˆ¶ç»§ç»­
- **æ¶ˆè´¹å»¶è¿Ÿå¢žåŠ **ï¼šå¯èƒ½æ˜¯æ­£å¸¸çŽ°è±¡ï¼Œè§‚å¯Ÿæ˜¯å¦æ¢å¤

---

## 5. ðŸ”— åè®®ç‰ˆæœ¬ç®¡ç†


### 5.1 åè®®ç‰ˆæœ¬åŸºç¡€æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯åè®®ç‰ˆæœ¬ï¼Ÿ**
å°±åƒäººè¯´è¯çš„"æ–¹è¨€"ï¼Œä¸åŒç‰ˆæœ¬çš„Kafkaå¯èƒ½è¯´ä¸åŒçš„"æ–¹è¨€"ï¼Œåè®®ç‰ˆæœ¬å°±æ˜¯ç¡®ä¿å¤§å®¶èƒ½äº’ç›¸ç†è§£ã€‚

**ðŸ“‹ ä¸»è¦åè®®ç±»åž‹**ï¼š
```
inter.broker.protocol.versionï¼š
â€¢ æŽ§åˆ¶Brokerä¹‹é—´çš„é€šä¿¡åè®®
â€¢ å†³å®šé›†ç¾¤å†…éƒ¨åŠŸèƒ½å¯ç”¨æ€§
â€¢ å‡çº§æ—¶éœ€è¦è°¨æ…Žè°ƒæ•´

log.message.format.versionï¼š
â€¢ æŽ§åˆ¶æ¶ˆæ¯åœ¨ç£ç›˜ä¸Šçš„å­˜å‚¨æ ¼å¼
â€¢ å½±å“æ¶ˆæ¯åŽ‹ç¼©å’Œæ€§èƒ½
â€¢ ä¸€æ—¦å‡çº§éš¾ä»¥å›žé€€
```

### 5.2 åè®®ç‰ˆæœ¬é…ç½®ç®¡ç†


**âš™ï¸ æŸ¥çœ‹å½“å‰åè®®ç‰ˆæœ¬**

```bash
# æŸ¥çœ‹brokeré…ç½®
kafka-configs.sh --bootstrap-server localhost:9092 \
  --entity-type brokers --entity-name 0 --describe

# æ£€æŸ¥æ¶ˆæ¯æ ¼å¼ç‰ˆæœ¬
kafka-log-dirs.sh --bootstrap-server localhost:9092 \
  --describe --json | grep -i version
```

**ðŸ”§ åè®®ç‰ˆæœ¬å‡çº§å‘½ä»¤**

```bash
# ç¬¬ä¸€é˜¶æ®µï¼šå‡çº§inter.broker.protocol.version
kafka-configs.sh --bootstrap-server localhost:9092 \
  --entity-type brokers --entity-default \
  --alter --add-config inter.broker.protocol.version=3.5

# éªŒè¯é…ç½®ç”Ÿæ•ˆ
kafka-configs.sh --bootstrap-server localhost:9092 \
  --entity-type brokers --entity-default --describe

# ç¬¬äºŒé˜¶æ®µï¼šå‡çº§log.message.format.versionï¼ˆè°¨æ…Žæ“ä½œï¼‰
kafka-configs.sh --bootstrap-server localhost:9092 \
  --entity-type brokers --entity-default \
  --alter --add-config log.message.format.version=3.5
```

### 5.3 åè®®ç‰ˆæœ¬å‡çº§ç­–ç•¥


**ðŸ“ˆ åˆ†é˜¶æ®µå‡çº§åŽŸåˆ™**

```
é˜¶æ®µåŒ–å‡çº§æµç¨‹ï¼š
1ï¸âƒ£ å…ˆå‡çº§æ‰€æœ‰Brokerçš„è½¯ä»¶ç‰ˆæœ¬
2ï¸âƒ£ å†å‡çº§inter.broker.protocol.version
3ï¸âƒ£ æœ€åŽå‡çº§log.message.format.version

æ¯ä¸ªé˜¶æ®µéƒ½è¦ï¼š
âœ… å……åˆ†æµ‹è¯•éªŒè¯
âœ… ç›‘æŽ§ç³»ç»Ÿç¨³å®šæ€§
âœ… ç¡®ä¿å¯ä»¥å›žé€€
```

**âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹**ï¼š
- **ä¸è¦è·³è·ƒå‡çº§**ï¼šæŒ‰ç…§ç‰ˆæœ¬é¡ºåºé€æ­¥å‡çº§
- **å……åˆ†æµ‹è¯•**ï¼šæ¯ä¸ªé˜¶æ®µéƒ½è¦éªŒè¯åŠŸèƒ½æ­£å¸¸
- **ç•™æœ‰å›žé€€ä½™åœ°**ï¼šå‡çº§log.message.format.versionåŽéš¾ä»¥å›žé€€

---

## 6. ðŸŽ›ï¸ ç‰¹æ€§å¼€å…³é…ç½®


### 6.1 ç‰¹æ€§å¼€å…³æœºåˆ¶


**ä»€ä¹ˆæ˜¯ç‰¹æ€§å¼€å…³ï¼Ÿ**
å°±åƒæ±½è½¦çš„åŠŸèƒ½æŒ‰é’®ï¼Œæ–°åŠŸèƒ½é»˜è®¤æ˜¯å…³é—­çš„ï¼Œéœ€è¦æ‰‹åŠ¨æ‰“å¼€ã€‚è¿™æ ·å¯ä»¥é€æ­¥å¯ç”¨æ–°åŠŸèƒ½ï¼Œç¡®ä¿ç¨³å®šæ€§ã€‚

**ðŸŽ¯ ç‰¹æ€§å¼€å…³çš„å¥½å¤„**ï¼š
- **æ¸è¿›å¼å¯ç”¨**ï¼šå¯ä»¥é€ä¸ªæµ‹è¯•æ–°åŠŸèƒ½
- **å¿«é€Ÿå›žé€€**ï¼šå‡ºé—®é¢˜æ—¶å¯ä»¥ç«‹å³å…³é—­
- **é™ä½Žé£Žé™©**ï¼šé¿å…æ–°åŠŸèƒ½å½±å“çŽ°æœ‰ä¸šåŠ¡
- **ABæµ‹è¯•**ï¼šå¯ä»¥å¯¹æ¯”æ–°æ—§åŠŸèƒ½çš„æ•ˆæžœ

### 6.2 å¸¸ç”¨ç‰¹æ€§å¼€å…³é…ç½®


**ðŸ”§ æŸ¥çœ‹å¯ç”¨ç‰¹æ€§å¼€å…³**

```bash
# æŸ¥çœ‹å½“å‰å¯ç”¨çš„ç‰¹æ€§
kafka-features.sh --bootstrap-server localhost:9092 --describe

# æŸ¥çœ‹ç‰¹å®šç‰¹æ€§çŠ¶æ€
kafka-configs.sh --bootstrap-server localhost:9092 \
  --entity-type brokers --entity-default --describe | \
  grep -i feature
```

**âš¡ å¯ç”¨/ç¦ç”¨ç‰¹æ€§ç¤ºä¾‹**

```bash
# å¯ç”¨KRaftæ¨¡å¼ç›¸å…³ç‰¹æ€§ï¼ˆKafka 3.0+ï¼‰
kafka-features.sh --bootstrap-server localhost:9092 \
  --enable --feature-name metadata.version --feature-version 1

# å¯ç”¨å¢žå¼ºçš„Producer IDç‰¹æ€§
kafka-configs.sh --bootstrap-server localhost:9092 \
  --entity-type brokers --entity-default \
  --alter --add-config producer.id.expiration.ms=86400000

# å¯ç”¨åŽ‹ç¼©ç®—æ³•ä¼˜åŒ–ç‰¹æ€§
kafka-configs.sh --bootstrap-server localhost:9092 \
  --entity-type topics --entity-name your-topic \
  --alter --add-config compression.type=zstd
```

### 6.3 é‡è¦ç‰¹æ€§é…ç½®æŒ‡å—


**ðŸ“‹ å¸¸è§ç‰¹æ€§å¼€å…³è¯´æ˜Ž**

| ç‰¹æ€§åç§° | **ä½œç”¨è¯´æ˜Ž** | **å¯ç”¨å»ºè®®** | **é£Žé™©è¯„ä¼°** |
|---------|-------------|-------------|-------------|
| **KRaft Mode** | `æ— ZooKeeperæ¨¡å¼` | `æ–°é›†ç¾¤æŽ¨è` | `ä¸­ç­‰` |
| **Incremental Rebalance** | `å¢žé‡å†å¹³è¡¡` | `æŽ¨èå¯ç”¨` | `ä½Ž` |
| **Enhanced Producer** | `å¢žå¼ºç”Ÿäº§è€…` | `ç”Ÿäº§çŽ¯å¢ƒæŽ¨è` | `ä½Ž` |
| **Tiered Storage** | `åˆ†å±‚å­˜å‚¨` | `å¤§æ•°æ®é‡åœºæ™¯` | `é«˜` |

**ðŸŽ›ï¸ ç‰¹æ€§å¯ç”¨æœ€ä½³å®žè·µ**ï¼š
```
1. å…ˆåœ¨æµ‹è¯•çŽ¯å¢ƒéªŒè¯
2. é€ä¸ªå¯ç”¨ï¼Œé¿å…æ‰¹é‡å¼€å¯
3. ç›‘æŽ§æ€§èƒ½æŒ‡æ ‡å˜åŒ–
4. å‡†å¤‡å¿«é€Ÿå›žé€€æ–¹æ¡ˆ
5. è®°å½•é…ç½®å˜æ›´åŽ†å²
```

---

## 7. âš ï¸ å‡çº§é£Žé™©è¯„ä¼°ä¸Žå›žé€€


### 7.1 å‡çº§é£Žé™©è¯†åˆ«


**ðŸŽ¯ å‡çº§é£Žé™©åˆ†ç±»**

```
æŠ€æœ¯é£Žé™©ï¼š
ðŸ”´ é«˜é£Žé™©ï¼šæ•°æ®ä¸¢å¤±ã€æœåŠ¡ä¸å¯ç”¨
ðŸŸ¡ ä¸­é£Žé™©ï¼šæ€§èƒ½ä¸‹é™ã€åŠŸèƒ½å¼‚å¸¸
ðŸŸ¢ ä½Žé£Žé™©ï¼šé…ç½®è°ƒæ•´ã€ç›‘æŽ§å½±å“

ä¸šåŠ¡é£Žé™©ï¼š
ðŸ“ˆ æµé‡é«˜å³°æœŸå‡çº§
ðŸ’° å…³é”®ä¸šåŠ¡å½±å“
â° å‡çº§æ—¶é—´çª—å£ä¸è¶³
ðŸ‘¥ äººå‘˜ç»éªŒä¸è¶³
```

### 7.2 é£Žé™©è¯„ä¼°æ£€æŸ¥


**ðŸ“‹ å‡çº§å‰é£Žé™©è¯„ä¼°æ¸…å•**

```bash
# æ£€æŸ¥é›†ç¾¤å¥åº·çŠ¶æ€
kafka-topics.sh --bootstrap-server localhost:9092 \
  --describe --under-replicated-partitions

# è¯„ä¼°å½“å‰è´Ÿè½½
kafka-run-class.sh kafka.tools.JmxTool \
  --object-name kafka.server:type=BrokerTopicMetrics,name=MessagesInPerSec

# æ£€æŸ¥ç£ç›˜ä½¿ç”¨æƒ…å†µ
df -h /var/lib/kafka/

# éªŒè¯ç½‘ç»œè¿žæŽ¥
nc -zv broker1 9092 && nc -zv broker2 9092 && nc -zv broker3 9092
```

**âš–ï¸ é£Žé™©è¯„ä¼°çŸ©é˜µ**

| é£Žé™©å› ç´  | **æ¦‚çŽ‡** | **å½±å“ç¨‹åº¦** | **é£Žé™©ç­‰çº§** | **åº”å¯¹ç­–ç•¥** |
|---------|---------|-------------|-------------|-------------|
| **é…ç½®é”™è¯¯** | `ä¸­ç­‰` | `é«˜` | `é«˜é£Žé™©` | `å……åˆ†æµ‹è¯•ï¼Œå¤‡ä»½é…ç½®` |
| **ç‰ˆæœ¬ä¸å…¼å®¹** | `ä½Ž` | `é«˜` | `ä¸­é£Žé™©` | `å…¼å®¹æ€§éªŒè¯` |
| **æ€§èƒ½ä¸‹é™** | `ä¸­ç­‰` | `ä¸­ç­‰` | `ä¸­é£Žé™©` | `æ€§èƒ½åŸºå‡†æµ‹è¯•` |
| **å·¥å…·ä¸å¯ç”¨** | `ä½Ž` | `ä½Ž` | `ä½Žé£Žé™©` | `å‡†å¤‡æ›¿ä»£å·¥å…·` |

### 7.3 å¿«é€Ÿå›žé€€æ–¹æ¡ˆ


**ðŸ”„ å›žé€€ç­–ç•¥å‡†å¤‡**

```bash
# åˆ›å»ºå›žé€€è„šæœ¬
cat > rollback.sh << 'EOF'
#!/bin/bash
# Kafkaç‰ˆæœ¬å›žé€€è„šæœ¬

echo "å¼€å§‹å›žé€€Kafkaç‰ˆæœ¬..."

# åœæ­¢å½“å‰ç‰ˆæœ¬
sudo systemctl stop kafka

# æ¢å¤æ—§ç‰ˆæœ¬
sudo rm -f /opt/kafka
sudo mv /opt/kafka-backup /opt/kafka

# æ¢å¤é…ç½®æ–‡ä»¶
sudo cp /opt/kafka-backup/config/server.properties /opt/kafka/config/

# å¯åŠ¨æœåŠ¡
sudo systemctl start kafka

echo "å›žé€€å®Œæˆï¼Œè¯·éªŒè¯æœåŠ¡çŠ¶æ€"
EOF

chmod +x rollback.sh
```

**âš¡ å¿«é€Ÿå›žé€€å‘½ä»¤**

```bash
# ç´§æ€¥æƒ…å†µä¸‹çš„å¿«é€Ÿå›žé€€
# æ­¥éª¤1ï¼šåœæ­¢æœ‰é—®é¢˜çš„èŠ‚ç‚¹
sudo systemctl stop kafka

# æ­¥éª¤2ï¼šå¿«é€Ÿæ›¿æ¢ç‰ˆæœ¬
sudo rm /opt/kafka && sudo mv /opt/kafka-old /opt/kafka

# æ­¥éª¤3ï¼šå¯åŠ¨æœåŠ¡
sudo systemctl start kafka

# æ­¥éª¤4ï¼šéªŒè¯æ¢å¤
kafka-broker-api-versions.sh --bootstrap-server localhost:9092
```

### 7.4 å›žé€€éªŒè¯æµ‹è¯•


**ðŸ§ª å›žé€€åŽéªŒè¯æ­¥éª¤**

```bash
# éªŒè¯é›†ç¾¤çŠ¶æ€
kafka-topics.sh --bootstrap-server localhost:9092 --list

# æµ‹è¯•ç”Ÿäº§æ¶ˆè´¹åŠŸèƒ½
echo "rollback test" | kafka-console-producer.sh \
  --bootstrap-server localhost:9092 --topic test-topic

kafka-console-consumer.sh --bootstrap-server localhost:9092 \
  --topic test-topic --from-beginning --timeout-ms 5000

# æ£€æŸ¥æ¶ˆè´¹è€…ç»„çŠ¶æ€
kafka-consumer-groups.sh --bootstrap-server localhost:9092 \
  --describe --group test-group
```

---

## 8. âœ… å‡çº§åŽéªŒè¯æµ‹è¯•


### 8.1 åŠŸèƒ½éªŒè¯æµ‹è¯•


**ðŸ§ª åŸºç¡€åŠŸèƒ½éªŒè¯**

å‡çº§å®ŒæˆåŽï¼Œè¦åƒä½“æ£€ä¸€æ ·å…¨é¢æ£€æŸ¥Kafkaçš„å¥åº·çŠ¶å†µï¼š

```bash
# åˆ›å»ºæµ‹è¯•ä¸»é¢˜
kafka-topics.sh --bootstrap-server localhost:9092 \
  --create --topic upgrade-verification \
  --partitions 3 --replication-factor 2

# æµ‹è¯•æ¶ˆæ¯ç”Ÿäº§
for i in {1..100}; do
  echo "Test message $i - $(date)" | \
  kafka-console-producer.sh --bootstrap-server localhost:9092 \
    --topic upgrade-verification
done

# æµ‹è¯•æ¶ˆæ¯æ¶ˆè´¹
kafka-console-consumer.sh --bootstrap-server localhost:9092 \
  --topic upgrade-verification --from-beginning \
  --timeout-ms 10000 | wc -l
```

**ðŸ“Š æ€§èƒ½åŸºå‡†æµ‹è¯•**

```bash
# ç”Ÿäº§è€…æ€§èƒ½æµ‹è¯•
kafka-producer-perf-test.sh \
  --topic upgrade-verification \
  --num-records 10000 \
  --record-size 1024 \
  --throughput 1000 \
  --producer-props bootstrap.servers=localhost:9092

# æ¶ˆè´¹è€…æ€§èƒ½æµ‹è¯•  
kafka-consumer-perf-test.sh \
  --topic upgrade-verification \
  --messages 10000 \
  --bootstrap-server localhost:9092
```

### 8.2 é›†ç¾¤çŠ¶æ€éªŒè¯


**ðŸ” é›†ç¾¤å¥åº·æ£€æŸ¥**

```bash
# æ£€æŸ¥æ‰€æœ‰BrokerçŠ¶æ€
kafka-broker-api-versions.sh --bootstrap-server localhost:9092

# éªŒè¯å‰¯æœ¬åŒæ­¥çŠ¶æ€
kafka-topics.sh --bootstrap-server localhost:9092 \
  --describe --under-replicated-partitions

# æ£€æŸ¥æ¶ˆè´¹è€…ç»„çŠ¶æ€
kafka-consumer-groups.sh --bootstrap-server localhost:9092 \
  --list | xargs -I {} kafka-consumer-groups.sh \
  --bootstrap-server localhost:9092 --describe --group {}
```

**ðŸ“ˆ ç›‘æŽ§æŒ‡æ ‡éªŒè¯**

```bash
# æ£€æŸ¥JMXæŒ‡æ ‡
kafka-run-class.sh kafka.tools.JmxTool \
  --object-name kafka.server:type=KafkaServer,name=BrokerState \
  --jmx-url service:jmx:rmi:///jndi/rmi://localhost:9999/jmxrmi

# éªŒè¯ç½‘ç»œæŒ‡æ ‡
kafka-run-class.sh kafka.tools.JmxTool \
  --object-name kafka.network:type=RequestMetrics,name=RequestsPerSec \
  --jmx-url service:jmx:rmi:///jndi/rmi://localhost:9999/jmxrmi
```

### 8.3 ä¸šåŠ¡åœºæ™¯éªŒè¯


**ðŸ’¼ æ¨¡æ‹ŸçœŸå®žä¸šåŠ¡åœºæ™¯**

```bash
# é«˜å¹¶å‘å†™å…¥æµ‹è¯•
kafka-producer-perf-test.sh \
  --topic business-test \
  --num-records 100000 \
  --record-size 2048 \
  --throughput -1 \
  --producer-props \
    bootstrap.servers=localhost:9092 \
    acks=all \
    compression.type=snappy

# å¤šæ¶ˆè´¹è€…ç»„æµ‹è¯•
for group in group1 group2 group3; do
  kafka-console-consumer.sh \
    --bootstrap-server localhost:9092 \
    --topic business-test \
    --group $group \
    --timeout-ms 5000 &
done
wait
```

### 8.4 å‡çº§æˆåŠŸç¡®è®¤


**âœ… å‡çº§å®Œæˆæ£€æŸ¥æ¸…å•**

```
åŠŸèƒ½éªŒè¯ï¼š
â–¡ æ‰€æœ‰ä¸»é¢˜å¯æ­£å¸¸è¯»å†™
â–¡ æ¶ˆè´¹è€…ç»„å·¥ä½œæ­£å¸¸
â–¡ ç®¡ç†å‘½ä»¤å“åº”æ­£å¸¸
â–¡ ç›‘æŽ§æŒ‡æ ‡æ­£å¸¸é‡‡é›†

æ€§èƒ½éªŒè¯ï¼š
â–¡ åžåé‡ç¬¦åˆé¢„æœŸ
â–¡ å»¶è¿Ÿåœ¨å¯æŽ¥å—èŒƒå›´
â–¡ èµ„æºä½¿ç”¨çŽ‡æ­£å¸¸
â–¡ é”™è¯¯çŽ‡æ— å¼‚å¸¸å¢žåŠ 

ç¨³å®šæ€§éªŒè¯ï¼š
â–¡ æœåŠ¡è¿è¡Œç¨³å®š24å°æ—¶
â–¡ æ—¥å¿—æ— å¼‚å¸¸é”™è¯¯
â–¡ å‰¯æœ¬åŒæ­¥æ­£å¸¸
â–¡ é›†ç¾¤é€‰ä¸¾ç¨³å®š
```

---

## 9. ðŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŽŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ðŸ”¸ ç‰ˆæœ¬å‡çº§æœ¬è´¨ï¼šåœ¨ä¿è¯ä¸šåŠ¡è¿žç»­æ€§å‰æä¸‹ï¼Œå®‰å…¨åœ°æ›´æ–°Kafkaç‰ˆæœ¬
ðŸ”¸ æ»šåŠ¨å‡çº§æ ¸å¿ƒï¼šé€ä¸ªèŠ‚ç‚¹å‡çº§ï¼Œé¿å…å…¨é›†ç¾¤åœæœº
ðŸ”¸ å…¼å®¹æ€§æ£€æŸ¥ï¼šç¡®ä¿æ–°è€ç‰ˆæœ¬èƒ½å¤Ÿæ­£å¸¸é€šä¿¡
ðŸ”¸ åè®®ç‰ˆæœ¬ç®¡ç†ï¼šæŽ§åˆ¶é›†ç¾¤å†…éƒ¨é€šä¿¡å’Œå­˜å‚¨æ ¼å¼
ðŸ”¸ ç‰¹æ€§å¼€å…³ï¼šé€æ­¥å¯ç”¨æ–°åŠŸèƒ½ï¼Œé™ä½Žå‡çº§é£Žé™©
ðŸ”¸ é£Žé™©è¯„ä¼°ï¼šå…¨é¢è¯„ä¼°å‡çº§å½±å“ï¼Œåˆ¶å®šåº”å¯¹ç­–ç•¥
ðŸ”¸ å›žé€€æ–¹æ¡ˆï¼šå‡†å¤‡å¿«é€Ÿæ¢å¤æœºåˆ¶ï¼Œåº”å¯¹æ„å¤–æƒ…å†µ
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ðŸ”¹ ä¸ºä»€ä¹ˆè¦åšæ»šåŠ¨å‡çº§**ï¼š
```
ä¸šåŠ¡è¿žç»­æ€§éœ€æ±‚ï¼š
â€¢ ç”Ÿäº§çŽ¯å¢ƒä¸èƒ½åœæœº
â€¢ ç”¨æˆ·ä½“éªŒä¸èƒ½ä¸­æ–­
â€¢ æ•°æ®å¤„ç†ä¸èƒ½æš‚åœ

æŠ€æœ¯å®žçŽ°åŽŸç†ï¼š
â€¢ Kafkaé›†ç¾¤å¤©ç„¶æ”¯æŒèŠ‚ç‚¹åŠ¨æ€åŠ å…¥é€€å‡º
â€¢ å‰¯æœ¬æœºåˆ¶ä¿è¯æ•°æ®å¯ç”¨æ€§
â€¢ å®¢æˆ·ç«¯è‡ªåŠ¨é‡è¿žæœºåˆ¶ä¿è¯è¿žæŽ¥ç¨³å®š
```

**ðŸ”¹ å‡çº§è¿‡ç¨‹ä¸­çš„å…³é”®å†³ç­–ç‚¹**ï¼š
```
ä½•æ—¶å‡çº§åè®®ç‰ˆæœ¬ï¼š
â€¢ æ‰€æœ‰Brokerå‡çº§å®ŒæˆåŽ
â€¢ é›†ç¾¤è¿è¡Œç¨³å®šä¸€æ®µæ—¶é—´åŽ
â€¢ å……åˆ†æµ‹è¯•éªŒè¯åŽ

å¦‚ä½•å¤„ç†å‡çº§å¼‚å¸¸ï¼š
â€¢ ç«‹å³åœæ­¢å‡çº§æµç¨‹
â€¢ åˆ†æžé—®é¢˜æ ¹æœ¬åŽŸå› 
â€¢ å¿…è¦æ—¶æ‰§è¡Œå›žé€€æ“ä½œ
â€¢ ä¿®å¤é—®é¢˜åŽé‡æ–°å‡çº§
```

**ðŸ”¹ å‡çº§æˆåŠŸçš„å…³é”®å› ç´ **ï¼š
```
å……åˆ†å‡†å¤‡ï¼š
â€¢ è¯¦ç»†çš„å‡çº§è®¡åˆ’
â€¢ å®Œæ•´çš„æ•°æ®å¤‡ä»½
â€¢ å…¨é¢çš„å…¼å®¹æ€§æµ‹è¯•

è¿‡ç¨‹æŽ§åˆ¶ï¼š
â€¢ é€æ­¥æŽ¨è¿›ï¼Œä¸æ€¥äºŽæ±‚æˆ
â€¢ æŒç»­ç›‘æŽ§ï¼ŒåŠæ—¶å‘çŽ°é—®é¢˜
â€¢ è°¨æ…Žå†³ç­–ï¼Œç¡®ä¿æ¯æ­¥æ­£ç¡®

éªŒè¯ç¡®è®¤ï¼š
â€¢ åŠŸèƒ½æµ‹è¯•å…¨é¢è¦†ç›–
â€¢ æ€§èƒ½æŒ‡æ ‡ç¬¦åˆé¢„æœŸ
â€¢ ç¨³å®šè¿è¡Œä¸€æ®µæ—¶é—´
```

### 9.3 å®žé™…åº”ç”¨æŒ‡å¯¼


**ðŸ’¼ ç”Ÿäº§çŽ¯å¢ƒå‡çº§å»ºè®®**ï¼š
```
å‡çº§å‰å‡†å¤‡ï¼ˆæå‰1-2å‘¨ï¼‰ï¼š
1. åœ¨æµ‹è¯•çŽ¯å¢ƒå®Œæ•´éªŒè¯å‡çº§æµç¨‹
2. å‡†å¤‡è¯¦ç»†çš„å‡çº§å’Œå›žé€€æ–‡æ¡£
3. åè°ƒç›¸å…³å›¢é˜Ÿï¼Œç¡®è®¤å‡çº§æ—¶é—´çª—å£
4. å‡†å¤‡ç›‘æŽ§å’ŒæŠ¥è­¦æœºåˆ¶

å‡çº§æ‰§è¡Œï¼ˆå‡çº§å½“å¤©ï¼‰ï¼š
1. å†æ¬¡ç¡®è®¤é›†ç¾¤å¥åº·çŠ¶æ€
2. æŒ‰ç…§è®¡åˆ’ä¸¥æ ¼æ‰§è¡Œå‡çº§æ­¥éª¤
3. æ¯ä¸ªæ­¥éª¤éƒ½è¦éªŒè¯æˆåŠŸåŽå†ç»§ç»­
4. é‡åˆ°é—®é¢˜åŠæ—¶æš‚åœï¼Œåˆ†æžå¤„ç†

å‡çº§åŽè·Ÿè¸ªï¼ˆå‡çº§åŽ1-2å‘¨ï¼‰ï¼š
1. å¯†åˆ‡ç›‘æŽ§é›†ç¾¤ç¨³å®šæ€§
2. å…³æ³¨ä¸šåŠ¡æŒ‡æ ‡å˜åŒ–
3. æ”¶é›†ç”¨æˆ·åé¦ˆ
4. æ€»ç»“å‡çº§ç»éªŒæ•™è®­
```

**ðŸ› ï¸ è¿ç»´æœ€ä½³å®žè·µ**ï¼š
```
è‡ªåŠ¨åŒ–å·¥å…·ï¼š
â€¢ ä½¿ç”¨è„šæœ¬è‡ªåŠ¨åŒ–å‡çº§æµç¨‹
â€¢ é›†æˆç›‘æŽ§å‘Šè­¦ï¼ŒåŠæ—¶å‘çŽ°é—®é¢˜
â€¢ å»ºç«‹æ ‡å‡†åŒ–çš„å‡çº§æ¨¡æ¿

å›¢é˜Ÿåä½œï¼š
â€¢ æ˜Žç¡®å‡çº§è¿‡ç¨‹ä¸­çš„è§’è‰²åˆ†å·¥
â€¢ å»ºç«‹æœ‰æ•ˆçš„æ²Ÿé€šæœºåˆ¶
â€¢ å‡†å¤‡åº”æ€¥è”ç³»æ–¹å¼

ç»éªŒç§¯ç´¯ï¼š
â€¢ è®°å½•æ¯æ¬¡å‡çº§çš„è¯¦ç»†è¿‡ç¨‹
â€¢ æ€»ç»“ç»éªŒæ•™è®­ï¼Œä¼˜åŒ–æµç¨‹
â€¢ å»ºç«‹çŸ¥è¯†åº“ï¼Œä¾¿äºŽå›¢é˜Ÿå­¦ä¹ 
```

### 9.4 å¸¸è§é—®é¢˜è§£ç­”


**â“ ä»€ä¹ˆæ—¶å€™å¿…é¡»åœæœºå‡çº§ï¼Ÿ**
```
å¿…é¡»åœæœºçš„æƒ…å†µï¼š
â€¢ è·¨å¤§ç‰ˆæœ¬å‡çº§ï¼ˆå¦‚2.xåˆ°3.xï¼‰
â€¢ å­˜å‚¨æ ¼å¼ä¸å…¼å®¹
â€¢ é›†ç¾¤æž¶æž„é‡å¤§è°ƒæ•´ï¼ˆå¦‚è¿ç§»åˆ°KRaftæ¨¡å¼ï¼‰
â€¢ ç¡¬ä»¶è®¾å¤‡æ›´æ¢

å»ºè®®ï¼šå³ä½¿éœ€è¦åœæœºï¼Œä¹Ÿè¦é€‰æ‹©ä¸šåŠ¡ä½Žå³°æœŸ
```

**â“ å‡çº§å¤±è´¥å¦‚ä½•å¿«é€Ÿæ¢å¤ï¼Ÿ**
```
å¿«é€Ÿæ¢å¤ç­–ç•¥ï¼š
1. ç«‹å³åœæ­¢æ­£åœ¨å‡çº§çš„èŠ‚ç‚¹
2. å°†å·²å‡çº§èŠ‚ç‚¹å›žé€€åˆ°åŽŸç‰ˆæœ¬
3. æ¢å¤åŽŸå§‹é…ç½®æ–‡ä»¶
4. é‡å¯é›†ç¾¤ï¼ŒéªŒè¯åŠŸèƒ½æ­£å¸¸
5. åˆ†æžå¤±è´¥åŽŸå› ï¼Œé‡æ–°åˆ¶å®šå‡çº§è®¡åˆ’
```

**â“ å¦‚ä½•éªŒè¯å‡çº§æ˜¯å¦æˆåŠŸï¼Ÿ**
```
æˆåŠŸæ ‡å‡†ï¼š
â€¢ æ‰€æœ‰Brokeréƒ½æ˜¯æœ€æ–°ç‰ˆæœ¬
â€¢ é›†ç¾¤åŠŸèƒ½å®Œå…¨æ­£å¸¸
â€¢ æ€§èƒ½æŒ‡æ ‡ç¬¦åˆé¢„æœŸ
â€¢ ä¸šåŠ¡åº”ç”¨è¿è¡Œæ­£å¸¸
â€¢ ç¨³å®šè¿è¡Œä¸€æ®µæ—¶é—´ï¼ˆå»ºè®®è‡³å°‘24å°æ—¶ï¼‰
```

**ðŸ§  è®°å¿†è¦ç‚¹**ï¼š
- å‡çº§å¦‚è¡ŒåŒ»ï¼Œè¯Šæ–­åœ¨å…ˆï¼Œæ²»ç–—åœ¨åŽ
- æ»šåŠ¨å‡çº§ä¿è¿žç»­ï¼Œä¸€æ­¥ä¸€éªŒè¯ä¸æ€¥
- åè®®ç‰ˆæœ¬éœ€è°¨æ…Žï¼Œå‘åŽå…¼å®¹æ˜¯åŽŸåˆ™
- é£Žé™©è¯„ä¼°è¦å…¨é¢ï¼Œå›žé€€æ–¹æ¡ˆå¿…é¡»æœ‰
- å‡çº§æˆåŠŸçœ‹ç¨³å®šï¼Œä¸åªåŠŸèƒ½è¿˜çœ‹æ€§èƒ½

**æ ¸å¿ƒç†å¿µ**ï¼šKafkaå‡çº§ä¸æ˜¯æŠ€æœ¯ç‚«æŠ€ï¼Œè€Œæ˜¯åœ¨ä¿è¯ä¸šåŠ¡ç¨³å®šçš„å‰æä¸‹ï¼Œå®‰å…¨åœ°äº«å—æ–°ç‰ˆæœ¬å¸¦æ¥çš„æ”¹è¿›ã€‚ç¨³æ‰Žç¨³æ‰“ã€æ­¥æ­¥ä¸ºè¥æ‰æ˜¯ç”Ÿäº§çŽ¯å¢ƒå‡çº§çš„æ­£é“ï¼