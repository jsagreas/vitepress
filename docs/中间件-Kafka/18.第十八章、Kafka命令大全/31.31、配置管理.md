---
title: 31ã€é…ç½®ç®¡ç†
---
## ğŸ“š ç›®å½•

1. [é…ç½®ç®¡ç†åŸºç¡€æ¦‚å¿µ](#1-é…ç½®ç®¡ç†åŸºç¡€æ¦‚å¿µ)
2. [æœåŠ¡å™¨é…ç½®è¯¦è§£](#2-æœåŠ¡å™¨é…ç½®è¯¦è§£)
3. [ç”Ÿäº§è€…é…ç½®ç®¡ç†](#3-ç”Ÿäº§è€…é…ç½®ç®¡ç†)
4. [æ¶ˆè´¹è€…é…ç½®ç®¡ç†](#4-æ¶ˆè´¹è€…é…ç½®ç®¡ç†)
5. [æ—¥å¿—é…ç½®ç®¡ç†](#5-æ—¥å¿—é…ç½®ç®¡ç†)
6. [åŠ¨æ€é…ç½®æ›´æ–°](#6-åŠ¨æ€é…ç½®æ›´æ–°)
7. [é…ç½®éªŒè¯ä¸ä¼˜åŒ–](#7-é…ç½®éªŒè¯ä¸ä¼˜åŒ–)
8. [å®æˆ˜é…ç½®æ¡ˆä¾‹](#8-å®æˆ˜é…ç½®æ¡ˆä¾‹)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”§ é…ç½®ç®¡ç†åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯Kafkaé…ç½®ç®¡ç†


**ğŸ¯ ç®€å•ç†è§£**ï¼šå°±åƒä½ ç»™æ‰‹æœºè®¾ç½®é“ƒå£°ã€å£çº¸ä¸€æ ·ï¼ŒKafkaä¹Ÿéœ€è¦å„ç§è®¾ç½®æ¥æ§åˆ¶å®ƒçš„è¡Œä¸ºã€‚

```
ç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼š
ä½ çš„æ‰‹æœº â†’ éœ€è¦è®¾ç½® â†’ é“ƒå£°ã€éŸ³é‡ã€ç½‘ç»œç­‰
Kafkaç³»ç»Ÿ â†’ éœ€è¦è®¾ç½® â†’ å­˜å‚¨ä½ç½®ã€å†…å­˜å¤§å°ã€ç½‘ç»œç«¯å£ç­‰

ç›®çš„ï¼šè®©KafkaæŒ‰ç…§ä½ çš„éœ€æ±‚å·¥ä½œ
```

**ğŸ’¡ é…ç½®æ–‡ä»¶çš„ä½œç”¨**
```
é…ç½®æ–‡ä»¶ = è¯´æ˜ä¹¦ + æ§åˆ¶é¢æ¿
- å‘Šè¯‰Kafkaæ€ä¹ˆå¯åŠ¨
- å‘Šè¯‰Kafkaç”¨å¤šå°‘å†…å­˜
- å‘Šè¯‰Kafkaæ•°æ®å­˜åœ¨å“ªé‡Œ
- å‘Šè¯‰Kafkaå¦‚ä½•å¤„ç†æ¶ˆæ¯
```

### 1.2 Kafkaé…ç½®æ–‡ä»¶å®¶æ—


**ğŸ“‚ ä¸»è¦é…ç½®æ–‡ä»¶**
```
Kafkaé…ç½®æ–‡ä»¶ç»“æ„ï¼š
kafka/
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ server.properties        â† æœåŠ¡å™¨ä¸»é…ç½®ï¼ˆæœ€é‡è¦ï¼‰
â”‚   â”œâ”€â”€ producer.properties      â† ç”Ÿäº§è€…é…ç½®
â”‚   â”œâ”€â”€ consumer.properties      â† æ¶ˆè´¹è€…é…ç½®
â”‚   â”œâ”€â”€ log4j.properties         â† æ—¥å¿—é…ç½®
â”‚   â””â”€â”€ zookeeper.properties     â† Zookeeperé…ç½®

æ¯ä¸ªæ–‡ä»¶æ§åˆ¶ä¸åŒçš„åŠŸèƒ½æ¨¡å—
```

### 1.3 é…ç½®ç®¡ç†çš„é‡è¦æ€§


**âš¡ ä¸ºä»€ä¹ˆé…ç½®å¾ˆé‡è¦**
```
âŒ é…ç½®é”™è¯¯çš„åæœï¼š
- ç³»ç»Ÿå¯åŠ¨å¤±è´¥
- æ€§èƒ½æå·®
- æ•°æ®ä¸¢å¤±
- æœåŠ¡ä¸ç¨³å®š

âœ… æ­£ç¡®é…ç½®çš„å¥½å¤„ï¼š
- ç³»ç»Ÿç¨³å®šè¿è¡Œ
- æ€§èƒ½æœ€ä¼˜
- æ•°æ®å®‰å…¨
- ä¾¿äºç»´æŠ¤
```

---

## 2. ğŸ–¥ï¸ æœåŠ¡å™¨é…ç½®è¯¦è§£


### 2.1 server.propertiesæ ¸å¿ƒé…ç½®


**ğŸ“‹ åŸºç¡€å¿…é…é¡¹ç›®**

**ğŸ”¸ æœåŠ¡å™¨èº«ä»½é…ç½®**
```properties
# ç»™æ¯ä¸ªKafkaæœåŠ¡å™¨ä¸€ä¸ªç‹¬ç‰¹çš„IDå·ï¼ˆå°±åƒèº«ä»½è¯å·ï¼‰
broker.id=0

# å‘Šè¯‰å®¢æˆ·ç«¯æ€ä¹ˆè¿æ¥åˆ°è¿™å°æœåŠ¡å™¨ï¼ˆå°±åƒé—¨ç‰Œå·ï¼‰
listeners=PLAINTEXT://localhost:9092

# å¤–éƒ¨å®¢æˆ·ç«¯è¿æ¥åœ°å€ï¼ˆå¯¹å¤–å…¬å¸ƒçš„åœ°å€ï¼‰
advertised.listeners=PLAINTEXT://localhost:9092
```

> **ğŸ’­ é€šä¿—ç†è§£**ï¼š`broker.id`å°±åƒç»™æ¯å°æœåŠ¡å™¨è´´ä¸ªåç‰Œï¼Œ`listeners`å°±åƒå‘Šè¯‰åˆ«äººä½ å®¶ä½å“ªé‡Œ

**ğŸ”¸ æ•°æ®å­˜å‚¨é…ç½®**
```properties
# æ•°æ®å­˜å‚¨ç›®å½•ï¼ˆæ•°æ®æ”¾åœ¨å“ªä¸ªæ–‡ä»¶å¤¹ï¼‰
log.dirs=/tmp/kafka-logs

# æ¯ä¸ªåˆ†åŒºæœ€å¤§å­˜å‚¨å¤šå°‘æ•°æ®ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰
log.segment.bytes=1073741824

# æ•°æ®ä¿ç•™å¤šé•¿æ—¶é—´ï¼ˆå•ä½ï¼šå°æ—¶ï¼Œ168å°æ—¶=7å¤©ï¼‰
log.retention.hours=168
```

**ğŸ”¸ ç½‘ç»œé…ç½®**
```properties
# åŒæ—¶å¤„ç†å¤šå°‘ä¸ªç½‘ç»œè¿æ¥
num.network.threads=3

# åŒæ—¶å¤„ç†å¤šå°‘ä¸ªIOæ“ä½œ
num.io.threads=8

# ç½‘ç»œç¼“å†²åŒºå¤§å°
socket.send.buffer.bytes=102400
socket.receive.buffer.bytes=102400
```

### 2.2 æ€§èƒ½è°ƒä¼˜é…ç½®


**âš¡ å†…å­˜ä¸æ€§èƒ½**
```properties
# JVMå †å†…å­˜è®¾ç½®ï¼ˆåœ¨å¯åŠ¨è„šæœ¬ä¸­ï¼‰
export KAFKA_HEAP_OPTS="-Xmx1G -Xms1G"

# å¤åˆ¶çº¿ç¨‹æ•°ï¼ˆå½±å“æ•°æ®åŒæ­¥é€Ÿåº¦ï¼‰
num.replica.fetchers=1

# é»˜è®¤åˆ†åŒºæ•°ï¼ˆæ–°topicçš„åˆ†åŒºæ•°ï¼‰
num.partitions=1

# é»˜è®¤å‰¯æœ¬æ•°ï¼ˆæ•°æ®å¤‡ä»½ä»½æ•°ï¼‰
default.replication.factor=1
```

> **âš¡ æ€§èƒ½å°è´´å£«**ï¼šå†…å­˜è¶Šå¤§ï¼Œç¼“å­˜è¶Šå¤šï¼Œæ€§èƒ½è¶Šå¥½ã€‚ä½†ä¹Ÿä¸è¦è®¾ç½®è¿‡å¤§ï¼Œç•™ç‚¹ç»™æ“ä½œç³»ç»Ÿ

### 2.3 å®‰å…¨ä¸å¯é æ€§é…ç½®


**ğŸ”’ æ•°æ®å®‰å…¨é…ç½®**
```properties
# æ˜¯å¦å…è®¸è‡ªåŠ¨åˆ›å»ºtopicï¼ˆå»ºè®®falseï¼Œæ‰‹åŠ¨åˆ›å»ºæ›´å®‰å…¨ï¼‰
auto.create.topics.enable=false

# åˆ é™¤topicåŠŸèƒ½å¼€å…³ï¼ˆå»ºè®®trueï¼Œæ–¹ä¾¿ç®¡ç†ï¼‰
delete.topic.enable=true

# æœ€å°åŒæ­¥å‰¯æœ¬æ•°ï¼ˆä¿è¯æ•°æ®ä¸ä¸¢å¤±ï¼‰
min.insync.replicas=1

# æœªæ¸…ç†çš„æ—¥å¿—ä¿ç•™æ—¶é—´
log.retention.check.interval.ms=300000
```

### 2.4 æŸ¥çœ‹å’Œä¿®æ”¹æœåŠ¡å™¨é…ç½®


**ğŸ” æŸ¥çœ‹å½“å‰é…ç½®**
```bash
# æŸ¥çœ‹brokerçš„æ‰€æœ‰é…ç½®
kafka-configs.sh --bootstrap-server localhost:9092 \
  --describe --entity-type brokers --entity-name 0

# æŸ¥çœ‹é»˜è®¤é…ç½®
kafka-configs.sh --bootstrap-server localhost:9092 \
  --describe --entity-type brokers --entity-default
```

**ğŸ”§ åŠ¨æ€ä¿®æ”¹é…ç½®**
```bash
# åŠ¨æ€ä¿®æ”¹æ—¥å¿—ä¿ç•™æ—¶é—´ï¼ˆä¸éœ€è¦é‡å¯ï¼‰
kafka-configs.sh --bootstrap-server localhost:9092 \
  --alter --entity-type brokers --entity-name 0 \
  --add-config log.retention.hours=72

# åˆ é™¤åŠ¨æ€é…ç½®ï¼ˆæ¢å¤é»˜è®¤å€¼ï¼‰
kafka-configs.sh --bootstrap-server localhost:9092 \
  --alter --entity-type brokers --entity-name 0 \
  --delete-config log.retention.hours
```

---

## 3. ğŸ“¤ ç”Ÿäº§è€…é…ç½®ç®¡ç†


### 3.1 producer.propertiesæ ¸å¿ƒé…ç½®


**ğŸ“‹ åŸºç¡€è¿æ¥é…ç½®**
```properties
# KafkaæœåŠ¡å™¨åœ°å€ï¼ˆå‘Šè¯‰ç”Ÿäº§è€…å¾€å“ªå‘æ¶ˆæ¯ï¼‰
bootstrap.servers=localhost:9092

# æ¶ˆæ¯é”®çš„åºåˆ—åŒ–æ–¹å¼ï¼ˆæŠŠé”®è½¬æ¢æˆå­—èŠ‚ï¼‰
key.serializer=org.apache.kafka.common.serialization.StringSerializer

# æ¶ˆæ¯å€¼çš„åºåˆ—åŒ–æ–¹å¼ï¼ˆæŠŠå€¼è½¬æ¢æˆå­—èŠ‚ï¼‰
value.serializer=org.apache.kafka.common.serialization.StringSerializer
```

> **ğŸ’¡ åºåˆ—åŒ–è§£é‡Š**ï¼šå°±åƒæŠŠä¸­æ–‡ç¿»è¯‘æˆè‹±æ–‡ä¸€æ ·ï¼ŒæŠŠJavaå¯¹è±¡è½¬æ¢æˆç½‘ç»œä¼ è¾“çš„å­—èŠ‚æµ

### 3.2 æ€§èƒ½ä¸å¯é æ€§é…ç½®


**âš¡ æ€§èƒ½ä¼˜åŒ–é…ç½®**
```properties
# æ‰¹é‡å‘é€å¤§å°ï¼ˆç§¯æ”’å¤šå°‘æ¶ˆæ¯ä¸€èµ·å‘é€ï¼Œæé«˜æ•ˆç‡ï¼‰
batch.size=16384

# ç­‰å¾…æ—¶é—´ï¼ˆæœ€å¤šç­‰å¤šä¹…å‘é€ä¸€æ‰¹æ¶ˆæ¯ï¼Œå•ä½ï¼šæ¯«ç§’ï¼‰
linger.ms=5

# ç¼“å†²åŒºå¤§å°ï¼ˆç”Ÿäº§è€…å†…å­˜ç¼“å†²åŒºï¼‰
buffer.memory=33554432

# å‹ç¼©ç±»å‹ï¼ˆå‡å°‘ç½‘ç»œä¼ è¾“é‡ï¼‰
compression.type=gzip
```

**ğŸ”’ å¯é æ€§é…ç½®**
```properties
# ç¡®è®¤æœºåˆ¶ï¼ˆ0=ä¸ç­‰ç¡®è®¤ï¼Œ1=leaderç¡®è®¤ï¼Œall=æ‰€æœ‰å‰¯æœ¬ç¡®è®¤ï¼‰
acks=1

# é‡è¯•æ¬¡æ•°ï¼ˆå‘é€å¤±è´¥æ—¶é‡è¯•å‡ æ¬¡ï¼‰
retries=3

# é‡è¯•é—´éš”ï¼ˆä¸¤æ¬¡é‡è¯•ä¹‹é—´ç­‰å¾…æ—¶é—´ï¼‰
retry.backoff.ms=100

# è¯·æ±‚è¶…æ—¶æ—¶é—´
request.timeout.ms=30000
```

### 3.3 ç”Ÿäº§è€…é…ç½®ç®¡ç†å‘½ä»¤


**ğŸ” æŸ¥çœ‹ç”Ÿäº§è€…é…ç½®**
```bash
# ä½¿ç”¨é…ç½®æ–‡ä»¶å¯åŠ¨ç”Ÿäº§è€…
kafka-console-producer.sh --bootstrap-server localhost:9092 \
  --topic my-topic \
  --producer.config config/producer.properties

# ç›´æ¥åœ¨å‘½ä»¤è¡ŒæŒ‡å®šé…ç½®
kafka-console-producer.sh --bootstrap-server localhost:9092 \
  --topic my-topic \
  --producer-property acks=all \
  --producer-property retries=3
```

**âš™ï¸ æµ‹è¯•ç”Ÿäº§è€…é…ç½®**
```bash
# æµ‹è¯•é«˜å¯é æ€§é…ç½®
kafka-console-producer.sh --bootstrap-server localhost:9092 \
  --topic test-topic \
  --producer-property acks=all \
  --producer-property retries=5 \
  --producer-property batch.size=1000
```

---

## 4. ğŸ“¥ æ¶ˆè´¹è€…é…ç½®ç®¡ç†


### 4.1 consumer.propertiesæ ¸å¿ƒé…ç½®


**ğŸ“‹ åŸºç¡€é…ç½®**
```properties
# KafkaæœåŠ¡å™¨åœ°å€
bootstrap.servers=localhost:9092

# æ¶ˆè´¹è€…ç»„IDï¼ˆåŒä¸€ç»„çš„æ¶ˆè´¹è€…åˆ†å·¥åä½œï¼‰
group.id=test-consumer-group

# è‡ªåŠ¨æäº¤åç§»é‡å¼€å…³
enable.auto.commit=true

# è‡ªåŠ¨æäº¤é—´éš”
auto.commit.interval.ms=1000

# é”®çš„ååºåˆ—åŒ–å™¨
key.deserializer=org.apache.kafka.common.serialization.StringDeserializer

# å€¼çš„ååºåˆ—åŒ–å™¨
value.deserializer=org.apache.kafka.common.serialization.StringDeserializer
```

### 4.2 æ¶ˆè´¹ç­–ç•¥é…ç½®


**ğŸ¯ æ¶ˆè´¹è¡Œä¸ºé…ç½®**
```properties
# ä»å“ªé‡Œå¼€å§‹æ¶ˆè´¹ï¼ˆearliest=æœ€æ—©ï¼Œlatest=æœ€æ–°ï¼‰
auto.offset.reset=latest

# ä¸€æ¬¡æ‹‰å–å¤šå°‘æ¡æ¶ˆæ¯
max.poll.records=500

# æ‹‰å–è¶…æ—¶æ—¶é—´
fetch.max.wait.ms=500

# æœ€å°æ‹‰å–å­—èŠ‚æ•°
fetch.min.bytes=1

# æœ€å¤§æ‹‰å–å­—èŠ‚æ•°
max.partition.fetch.bytes=1048576
```

> **ğŸ’­ ç†è§£auto.offset.reset**ï¼š
> - `earliest`ï¼šä»å¤´å¼€å§‹çœ‹ï¼ˆåƒä»ç¬¬ä¸€é›†å¼€å§‹çœ‹ç”µè§†å‰§ï¼‰
> - `latest`ï¼šåªçœ‹æœ€æ–°çš„ï¼ˆåƒåªçœ‹ä»Šå¤©çš„æ–°é—»ï¼‰

### 4.3 æ¶ˆè´¹è€…é…ç½®ç®¡ç†å‘½ä»¤


**ğŸ” æŸ¥çœ‹æ¶ˆè´¹è€…é…ç½®**
```bash
# ä½¿ç”¨é…ç½®æ–‡ä»¶å¯åŠ¨æ¶ˆè´¹è€…
kafka-console-consumer.sh --bootstrap-server localhost:9092 \
  --topic my-topic \
  --consumer.config config/consumer.properties

# æŸ¥çœ‹æ¶ˆè´¹è€…ç»„é…ç½®
kafka-consumer-groups.sh --bootstrap-server localhost:9092 \
  --describe --group test-consumer-group
```

**âš™ï¸ åŠ¨æ€é…ç½®æ¶ˆè´¹è€…**
```bash
# ä»æœ€æ—©å¼€å§‹æ¶ˆè´¹
kafka-console-consumer.sh --bootstrap-server localhost:9092 \
  --topic my-topic \
  --from-beginning \
  --consumer-property group.id=my-group

# é…ç½®æœ€å¤§æ‹‰å–è®°å½•æ•°
kafka-console-consumer.sh --bootstrap-server localhost:9092 \
  --topic my-topic \
  --consumer-property max.poll.records=100 \
  --consumer-property group.id=test-group
```

---

## 5. ğŸ“ æ—¥å¿—é…ç½®ç®¡ç†


### 5.1 log4j.propertiesé…ç½®è¯¦è§£


**ğŸ“‹ æ—¥å¿—çº§åˆ«é…ç½®**
```properties
# æ ¹æ—¥å¿—çº§åˆ«ï¼ˆæ§åˆ¶æ‰€æœ‰æ—¥å¿—çš„è¯¦ç»†ç¨‹åº¦ï¼‰
log4j.rootLogger=INFO, stdout, kafkaAppender

# Kafkaç‰¹å®šæ—¥å¿—çº§åˆ«
log4j.logger.kafka=INFO
log4j.logger.org.apache.kafka=INFO

# çŠ¶æ€æ›´æ”¹æ—¥å¿—ï¼ˆé‡è¦çš„çŠ¶æ€å˜åŒ–ï¼‰
log4j.logger.kafka.controller=TRACE
log4j.logger.kafka.log.LogCleaner=INFO
log4j.logger.state.change.logger=TRACE
```

**ğŸ“Š æ—¥å¿—è¾“å‡ºé…ç½®**
```properties
# æ§åˆ¶å°è¾“å‡ºé…ç½®
log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=[%d] %p %m (%c)%n

# æ–‡ä»¶è¾“å‡ºé…ç½®
log4j.appender.kafkaAppender=org.apache.log4j.DailyRollingFileAppender
log4j.appender.kafkaAppender.DatePattern='.'yyyy-MM-dd-HH
log4j.appender.kafkaAppender.File=${kafka.logs.dir}/server.log
log4j.appender.kafkaAppender.layout=org.apache.log4j.PatternLayout
log4j.appender.kafkaAppender.layout.ConversionPattern=[%d] %p %m (%c)%n
```

### 5.2 æ—¥å¿—çº§åˆ«è¯´æ˜


**ğŸ“ˆ æ—¥å¿—çº§åˆ«è¯¦è§£**
```
æ—¥å¿—çº§åˆ«ï¼ˆä»è¯¦ç»†åˆ°ç®€å•ï¼‰ï¼š
TRACE â†’ DEBUG â†’ INFO â†’ WARN â†’ ERROR

ğŸ“Š å„çº§åˆ«å«ä¹‰ï¼š
TRACE: æœ€è¯¦ç»†ï¼Œæ˜¾ç¤ºæ‰€æœ‰ç»†èŠ‚ï¼ˆè°ƒè¯•ç”¨ï¼‰
DEBUG: è°ƒè¯•ä¿¡æ¯ï¼Œå¼€å‘é˜¶æ®µç”¨
INFO:  ä¸€èˆ¬ä¿¡æ¯ï¼Œæ­£å¸¸è¿è¡ŒçŠ¶æ€
WARN:  è­¦å‘Šä¿¡æ¯ï¼Œæœ‰é—®é¢˜ä½†ä¸è‡´å‘½
ERROR: é”™è¯¯ä¿¡æ¯ï¼Œä¸¥é‡é—®é¢˜
```

> **ğŸ’¡ ç”Ÿäº§ç¯å¢ƒå»ºè®®**ï¼šä½¿ç”¨INFOçº§åˆ«ï¼Œæ—¢ä¸ä¼šä¸¢å¤±é‡è¦ä¿¡æ¯ï¼Œä¹Ÿä¸ä¼šäº§ç”Ÿè¿‡å¤šæ—¥å¿—

### 5.3 æ—¥å¿—ç®¡ç†å‘½ä»¤


**ğŸ” æŸ¥çœ‹å’Œç®¡ç†æ—¥å¿—**
```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f /path/to/kafka/logs/server.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
grep ERROR /path/to/kafka/logs/server.log

# æŸ¥çœ‹æœ€è¿‘çš„æ—¥å¿—
tail -100 /path/to/kafka/logs/server.log

# æŒ‰æ—¶é—´æŸ¥çœ‹æ—¥å¿—
grep "2024-01-21" /path/to/kafka/logs/server.log
```

---

## 6. ğŸ”„ åŠ¨æ€é…ç½®æ›´æ–°


### 6.1 åŠ¨æ€é…ç½®åŸºç¡€æ¦‚å¿µ


**ğŸ¯ ä»€ä¹ˆæ˜¯åŠ¨æ€é…ç½®**
```
é™æ€é…ç½®ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶ â†’ é‡å¯æœåŠ¡ â†’ é…ç½®ç”Ÿæ•ˆ
åŠ¨æ€é…ç½®ï¼šæ‰§è¡Œå‘½ä»¤ â†’ ç«‹å³ç”Ÿæ•ˆ â†’ æ— éœ€é‡å¯

ä¼˜åŠ¿ï¼š
âœ… æ— éœ€åœæœº
âœ… ç«‹å³ç”Ÿæ•ˆ
âœ… ä¾¿äºè°ƒè¯•
âœ… é™ä½é£é™©
```

### 6.2 æ”¯æŒåŠ¨æ€ä¿®æ”¹çš„é…ç½®é¡¹


**ğŸ“‹ å¯åŠ¨æ€ä¿®æ”¹çš„é…ç½®**

| é…ç½®ç±»å‹ | **ä¸»è¦é…ç½®é¡¹** | **è¯´æ˜** |
|---------|---------------|----------|
| ğŸ”¸ **æ€§èƒ½ç›¸å…³** | `num.io.threads`<br>`num.network.threads` | IOçº¿ç¨‹æ•°<br>ç½‘ç»œçº¿ç¨‹æ•° |
| ğŸ”¸ **æ—¥å¿—ç›¸å…³** | `log.retention.hours`<br>`log.segment.bytes` | æ—¥å¿—ä¿ç•™æ—¶é—´<br>æ®µæ–‡ä»¶å¤§å° |
| ğŸ”¸ **é™æµç›¸å…³** | `producer.purgatory.purge.interval.requests`<br>`fetch.purgatory.purge.interval.requests` | ç”Ÿäº§è€…é™æµ<br>æ¶ˆè´¹è€…é™æµ |

### 6.3 åŠ¨æ€é…ç½®ç®¡ç†å‘½ä»¤


**ğŸ”§ ä¿®æ”¹brokeré…ç½®**
```bash
# ä¿®æ”¹æ—¥å¿—ä¿ç•™æ—¶é—´ä¸º3å¤©
kafka-configs.sh --bootstrap-server localhost:9092 \
  --alter --entity-type brokers --entity-name 0 \
  --add-config log.retention.hours=72

# ä¿®æ”¹ç½‘ç»œçº¿ç¨‹æ•°
kafka-configs.sh --bootstrap-server localhost:9092 \
  --alter --entity-type brokers --entity-name 0 \
  --add-config num.network.threads=5
```

**ğŸ”§ ä¿®æ”¹topicé…ç½®**
```bash
# ä¿®æ”¹topicçš„ä¿ç•™æ—¶é—´
kafka-configs.sh --bootstrap-server localhost:9092 \
  --alter --entity-type topics --entity-name my-topic \
  --add-config retention.ms=259200000

# ä¿®æ”¹topicçš„æœ€å¤§æ¶ˆæ¯å¤§å°
kafka-configs.sh --bootstrap-server localhost:9092 \
  --alter --entity-type topics --entity-name my-topic \
  --add-config max.message.bytes=2000000
```

**ğŸ”§ ä¿®æ”¹å®¢æˆ·ç«¯é…ç½®**
```bash
# ä¿®æ”¹å®¢æˆ·ç«¯é…é¢ï¼ˆé™åˆ¶å®¢æˆ·ç«¯çš„è¯·æ±‚é€Ÿç‡ï¼‰
kafka-configs.sh --bootstrap-server localhost:9092 \
  --alter --entity-type clients --entity-name my-client \
  --add-config producer_byte_rate=1000000

# ä¿®æ”¹ç”¨æˆ·é…é¢
kafka-configs.sh --bootstrap-server localhost:9092 \
  --alter --entity-type users --entity-name my-user \
  --add-config consumer_byte_rate=2000000
```

---

## 7. âœ… é…ç½®éªŒè¯ä¸ä¼˜åŒ–


### 7.1 é…ç½®æ–‡ä»¶éªŒè¯


**ğŸ” éªŒè¯é…ç½®è¯­æ³•**
```bash
# éªŒè¯server.propertiesè¯­æ³•
kafka-run-class.sh kafka.tools.ConfigCommand \
  --verify --config-file config/server.properties

# éªŒè¯ç”Ÿäº§è€…é…ç½®
kafka-producer-perf-test.sh --topic test-topic \
  --producer.config config/producer.properties \
  --num-records 1 --record-size 100 \
  --throughput 1
```

### 7.2 é…ç½®æ€§èƒ½æµ‹è¯•


**âš¡ æµ‹è¯•é…ç½®æ•ˆæœ**
```bash
# æµ‹è¯•ç”Ÿäº§è€…æ€§èƒ½
kafka-producer-perf-test.sh \
  --topic perf-test \
  --num-records 100000 \
  --record-size 1000 \
  --throughput 10000 \
  --producer-props bootstrap.servers=localhost:9092 \
                    acks=1 \
                    batch.size=32768

# æµ‹è¯•æ¶ˆè´¹è€…æ€§èƒ½
kafka-consumer-perf-test.sh \
  --bootstrap-server localhost:9092 \
  --topic perf-test \
  --messages 100000 \
  --consumer.config config/consumer.properties
```

### 7.3 é…ç½®ä¼˜åŒ–å»ºè®®


**ğŸ“Š æ€§èƒ½ä¼˜åŒ–é…ç½®æ¨¡æ¿**

```
ğŸ”¸ é«˜ååé‡é…ç½®ï¼š
batch.size=32768
linger.ms=5
compression.type=lz4
acks=1

ğŸ”¸ ä½å»¶è¿Ÿé…ç½®ï¼š
batch.size=1
linger.ms=0
acks=1

ğŸ”¸ é«˜å¯é æ€§é…ç½®ï¼š
acks=all
retries=10
min.insync.replicas=2
```

**ğŸ’¡ é…ç½®è°ƒä¼˜æ­¥éª¤**
```
ç¬¬1æ­¥ï¼šå»ºç«‹åŸºå‡†æµ‹è¯•
ç¬¬2æ­¥ï¼šé€æ­¥è°ƒæ•´å•ä¸ªå‚æ•°
ç¬¬3æ­¥ï¼šæµ‹è¯•æ€§èƒ½å˜åŒ–
ç¬¬4æ­¥ï¼šè®°å½•æœ€ä½³é…ç½®
ç¬¬5æ­¥ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒéªŒè¯
```

---

## 8. ğŸš€ å®æˆ˜é…ç½®æ¡ˆä¾‹


### 8.1 å¼€å‘ç¯å¢ƒé…ç½®


**ğŸ”§ å¼€å‘ç¯å¢ƒserver.properties**
```properties
# åŸºç¡€é…ç½®
broker.id=0
listeners=PLAINTEXT://localhost:9092
log.dirs=/tmp/kafka-logs

# å¼€å‘ç¯å¢ƒä¼˜åŒ–
auto.create.topics.enable=true
delete.topic.enable=true
log.retention.hours=24
num.partitions=3
default.replication.factor=1

# æ€§èƒ½é…ç½®ï¼ˆé€‚åˆå•æœºå¼€å‘ï¼‰
num.network.threads=3
num.io.threads=4
socket.send.buffer.bytes=102400
socket.receive.buffer.bytes=102400
```

### 8.2 ç”Ÿäº§ç¯å¢ƒé…ç½®


**ğŸ­ ç”Ÿäº§ç¯å¢ƒserver.properties**
```properties
# åŸºç¡€é…ç½®
broker.id=1
listeners=PLAINTEXT://kafka1.company.com:9092
log.dirs=/data/kafka-logs

# ç”Ÿäº§ç¯å¢ƒå®‰å…¨é…ç½®
auto.create.topics.enable=false
delete.topic.enable=false
log.retention.hours=168
default.replication.factor=3
min.insync.replicas=2

# é«˜æ€§èƒ½é…ç½®
num.network.threads=8
num.io.threads=16
socket.send.buffer.bytes=1048576
socket.receive.buffer.bytes=1048576
num.replica.fetchers=4
```

### 8.3 é…ç½®æ¨¡æ¿ç®¡ç†


**ğŸ“ é…ç½®æ–‡ä»¶ç®¡ç†ç­–ç•¥**
```
é…ç½®æ–‡ä»¶ç‰ˆæœ¬ç®¡ç†ï¼š
config/
â”œâ”€â”€ dev/
â”‚   â”œâ”€â”€ server.properties
â”‚   â”œâ”€â”€ producer.properties
â”‚   â””â”€â”€ consumer.properties
â”œâ”€â”€ test/
â”‚   â”œâ”€â”€ server.properties
â”‚   â”œâ”€â”€ producer.properties
â”‚   â””â”€â”€ consumer.properties
â””â”€â”€ prod/
    â”œâ”€â”€ server.properties
    â”œâ”€â”€ producer.properties
    â””â”€â”€ consumer.properties

æ¯ä¸ªç¯å¢ƒç‹¬ç«‹é…ç½®ï¼Œé¿å…æ··æ·†
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„é…ç½®æ¦‚å¿µ


```
ğŸ”¸ é…ç½®æ–‡ä»¶ä½œç”¨ï¼šæ§åˆ¶Kafkaå„ä¸ªç»„ä»¶çš„è¡Œä¸º
ğŸ”¸ server.propertiesï¼šæœ€é‡è¦çš„æœåŠ¡å™¨é…ç½®æ–‡ä»¶
ğŸ”¸ åŠ¨æ€é…ç½®ï¼šä¸é‡å¯å°±èƒ½ä¿®æ”¹çš„é…ç½®é¡¹
ğŸ”¸ é…ç½®éªŒè¯ï¼šç¡®ä¿é…ç½®æ­£ç¡®çš„é‡è¦æ­¥éª¤
ğŸ”¸ ç¯å¢ƒéš”ç¦»ï¼šä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒé…ç½®
```

### 9.2 å…³é”®é…ç½®ç®¡ç†è¦ç‚¹


**ğŸ”¹ é…ç½®ä¼˜å…ˆçº§ç†è§£**
```
é…ç½®ä¼˜å…ˆçº§ï¼ˆé«˜åˆ°ä½ï¼‰ï¼š
1. åŠ¨æ€é…ç½®ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
2. å‘½ä»¤è¡Œå‚æ•°
3. é…ç½®æ–‡ä»¶
4. é»˜è®¤å€¼ï¼ˆæœ€ä½ä¼˜å…ˆçº§ï¼‰
```

**ğŸ”¹ å¸¸ç”¨é…ç½®æ¨¡å¼**
```
å¼€å‘ç¯å¢ƒï¼šç®€å•å¿«é€Ÿï¼Œè‡ªåŠ¨åˆ›å»ºtopic
æµ‹è¯•ç¯å¢ƒï¼šæ¥è¿‘ç”Ÿäº§ï¼Œä½†èµ„æºè¾ƒå°‘  
ç”Ÿäº§ç¯å¢ƒï¼šé«˜å¯é æ€§ï¼Œé«˜æ€§èƒ½ï¼Œå®‰å…¨ç¬¬ä¸€
```

### 9.3 é…ç½®ç®¡ç†æœ€ä½³å®è·µ


**âœ… æ¨èåšæ³•**
- ğŸ“ **ç‰ˆæœ¬æ§åˆ¶**ï¼šæ‰€æœ‰é…ç½®æ–‡ä»¶çº³å…¥ç‰ˆæœ¬ç®¡ç†
- ğŸ” **é…ç½®éªŒè¯**ï¼šéƒ¨ç½²å‰å¿…é¡»éªŒè¯é…ç½®
- ğŸ“Š **æ€§èƒ½æµ‹è¯•**ï¼šé…ç½®å˜æ›´åè¦æµ‹è¯•æ€§èƒ½
- ğŸ”„ **ç°åº¦å‘å¸ƒ**ï¼šé‡è¦é…ç½®åˆ†æ‰¹æ¬¡åº”ç”¨
- ğŸ“‹ **æ–‡æ¡£è®°å½•**ï¼šè®°å½•æ¯æ¬¡é…ç½®å˜æ›´çš„åŸå› 

**âŒ é¿å…åšæ³•**
- ğŸš« ç›´æ¥åœ¨ç”Ÿäº§ç¯å¢ƒè¯•éªŒé…ç½®
- ğŸš« é…ç½®å˜æ›´ä¸åšå¤‡ä»½
- ğŸš« ä¸åŒç¯å¢ƒä½¿ç”¨ç›¸åŒé…ç½®
- ğŸš« ä¿®æ”¹é…ç½®ä¸é€šçŸ¥å›¢é˜Ÿ
- ğŸš« é…ç½®å‚æ•°å«ä¹‰ä¸æ¸…æ¥šå°±ä¿®æ”¹

### 9.4 é…ç½®æ•…éšœæ’æŸ¥


**ğŸ”§ å¸¸è§é…ç½®é—®é¢˜**
```
å¯åŠ¨å¤±è´¥ï¼š
â†’ æ£€æŸ¥broker.idæ˜¯å¦å†²çª
â†’ æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
â†’ æ£€æŸ¥æ•°æ®ç›®å½•æ˜¯å¦å¯å†™

æ€§èƒ½é—®é¢˜ï¼š
â†’ æ£€æŸ¥å†…å­˜é…ç½®æ˜¯å¦åˆç†
â†’ æ£€æŸ¥ç½‘ç»œçº¿ç¨‹æ•°é…ç½®
â†’ æ£€æŸ¥ç£ç›˜IOé…ç½®

æ•°æ®ä¸¢å¤±ï¼š
â†’ æ£€æŸ¥å‰¯æœ¬æ•°é…ç½®
â†’ æ£€æŸ¥acksé…ç½®
â†’ æ£€æŸ¥min.insync.replicasé…ç½®
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- é…ç½®ç®¡ç†æ˜¯åŸºç¡€ï¼ŒæœåŠ¡å™¨é…ç½®æœ€é‡è¦
- åŠ¨æ€é…ç½®å¾ˆæ–¹ä¾¿ï¼Œç”Ÿäº§ç¯å¢ƒè¦è°¨æ…  
- ä¸åŒç¯å¢ƒä¸åŒé…ï¼Œç‰ˆæœ¬ç®¡ç†è¦åšå¥½
- é…ç½®å˜æ›´å¿…æµ‹è¯•ï¼Œæ–‡æ¡£è®°å½•ä¸èƒ½å°‘