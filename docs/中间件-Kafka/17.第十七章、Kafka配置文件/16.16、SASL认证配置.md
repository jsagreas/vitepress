---
title: 16ã€SASLè®¤è¯é…ç½®
---
## ğŸ“š ç›®å½•

1. [SASLè®¤è¯åŸºç¡€æ¦‚å¿µ](#1-SASLè®¤è¯åŸºç¡€æ¦‚å¿µ)
2. [SASLæœºåˆ¶ç±»å‹è¯¦è§£](#2-SASLæœºåˆ¶ç±»å‹è¯¦è§£)
3. [æ ¸å¿ƒé…ç½®å‚æ•°è¯¦è§£](#3-æ ¸å¿ƒé…ç½®å‚æ•°è¯¦è§£)
4. [Kerberosé…ç½®å®æˆ˜](#4-Kerberosé…ç½®å®æˆ˜)
5. [JAASé…ç½®è¯¦è§£](#5-JAASé…ç½®è¯¦è§£)
6. [å®¢æˆ·ç«¯é…ç½®æŒ‡å—](#6-å®¢æˆ·ç«¯é…ç½®æŒ‡å—)
7. [å®‰å…¨é…ç½®æœ€ä½³å®è·µ](#7-å®‰å…¨é…ç½®æœ€ä½³å®è·µ)
8. [å¸¸è§é—®é¢˜ä¸æ’é”™](#8-å¸¸è§é—®é¢˜ä¸æ’é”™)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” SASLè®¤è¯åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯SASLè®¤è¯


**ğŸ¯ ç®€å•ç†è§£**
> æƒ³è±¡ä¸€ä¸‹å…¬å¸çš„é—¨ç¦å¡ç³»ç»Ÿï¼šå‘˜å·¥éœ€è¦åˆ·å¡æ‰èƒ½è¿›å…¥åŠå…¬å®¤ï¼Œä¸åŒéƒ¨é—¨çš„äººæœ‰ä¸åŒçš„æƒé™ã€‚SASLè®¤è¯å°±æ˜¯Kafkaçš„"é—¨ç¦ç³»ç»Ÿ"ï¼Œç¡®ä¿åªæœ‰åˆæ³•ç”¨æˆ·æ‰èƒ½è®¿é—®Kafkaé›†ç¾¤ã€‚

**æ ¸å¿ƒæ¦‚å¿µ**
```
SASL = Simple Authentication and Security Layer
ä½œç”¨ï¼šæä¾›èº«ä»½éªŒè¯æœºåˆ¶ï¼Œç¡®ä¿é€šä¿¡å®‰å…¨
ç›®æ ‡ï¼šé˜²æ­¢æœªæˆæƒè®¿é—®ï¼Œä¿æŠ¤æ•°æ®å®‰å…¨
```

**ğŸ  ç”Ÿæ´»ç±»æ¯”**
```
ä¼ ç»ŸKafkaï¼ˆæ— è®¤è¯ï¼‰ï¼š
å°±åƒä¸€ä¸ªæ²¡æœ‰é—¨ç¦çš„åŠå…¬æ¥¼ï¼Œä»»ä½•äººéƒ½èƒ½è¿›å…¥

SASLè®¤è¯çš„Kafkaï¼š
å°±åƒæœ‰ä¸¥æ ¼é—¨ç¦çš„é“¶è¡Œï¼Œéœ€è¦éªŒè¯èº«ä»½æ‰èƒ½è¿›å…¥
- åˆ·å¡ï¼ˆç”¨æˆ·åå¯†ç ï¼‰
- æŒ‡çº¹ï¼ˆè¯ä¹¦è®¤è¯ï¼‰  
- äººè„¸è¯†åˆ«ï¼ˆKerberosç¥¨æ®ï¼‰
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦SASLè®¤è¯


**å®‰å…¨é£é™©åœºæ™¯**
```
âŒ æ— è®¤è¯çš„é—®é¢˜ï¼š
â€¢ ä»»ä½•äººéƒ½èƒ½è¿æ¥Kafka
â€¢ æ•°æ®å¯èƒ½è¢«æ¶æ„è¯»å–
â€¢ é‡è¦æ¶ˆæ¯å¯èƒ½è¢«ç¯¡æ”¹
â€¢ ç³»ç»Ÿå®¹æ˜“é­å—æ”»å‡»

âœ… SASLè®¤è¯çš„ä»·å€¼ï¼š
â€¢ èº«ä»½éªŒè¯ï¼šç¡®è®¤ç”¨æˆ·èº«ä»½
â€¢ è®¿é—®æ§åˆ¶ï¼šé™åˆ¶æ“ä½œæƒé™
â€¢ æ•°æ®ä¿æŠ¤ï¼šé˜²æ­¢æ•°æ®æ³„éœ²
â€¢ å®¡è®¡è¿½è¸ªï¼šè®°å½•æ“ä½œæ—¥å¿—
```

**ğŸ“Š å®‰å…¨ç­‰çº§å¯¹æ¯”**

| å®‰å…¨ç‰¹æ€§ | **æ— è®¤è¯** | **SASLè®¤è¯** | **SASL+SSL** |
|---------|-----------|-------------|-------------|
| ğŸ”’ **èº«ä»½éªŒè¯** | âŒ æ—  | âœ… æœ‰ | âœ… æœ‰ |
| ğŸ›¡ï¸ **æ•°æ®åŠ å¯†** | âŒ æ˜æ–‡ | âŒ æ˜æ–‡ | âœ… åŠ å¯† |
| ğŸ¯ **è®¿é—®æ§åˆ¶** | âŒ æ— é™åˆ¶ | âœ… å¯æ§åˆ¶ | âœ… å¯æ§åˆ¶ |
| ğŸ“ˆ **å®‰å…¨çº§åˆ«** | ğŸ”´ ä½ | ğŸŸ¡ ä¸­ | ğŸŸ¢ é«˜ |

---

## 2. ğŸ›¡ï¸ SASLæœºåˆ¶ç±»å‹è¯¦è§£


### 2.1 å¸¸ç”¨SASLæœºåˆ¶æ¦‚è§ˆ


**ğŸ“‹ æœºåˆ¶ç±»å‹æ€»è§ˆ**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           SASLè®¤è¯æœºåˆ¶                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PLAIN     â”‚ ç”¨æˆ·åå¯†ç ï¼ˆæœ€ç®€å•ï¼‰          â”‚
â”‚ SCRAM     â”‚ åŠ å¯†ç”¨æˆ·åå¯†ç ï¼ˆæ¨èï¼‰        â”‚
â”‚ GSSAPI    â”‚ Kerberosç¥¨æ®ï¼ˆä¼ä¸šçº§ï¼‰       â”‚
â”‚ OAUTHBEARERâ”‚ OAuthä»¤ç‰Œï¼ˆç°ä»£åŒ–ï¼‰         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 PLAINæœºåˆ¶è¯¦è§£


**ğŸ”¸ å·¥ä½œåŸç†**
```
ç‰¹ç‚¹ï¼šæœ€ç®€å•çš„ç”¨æˆ·åå¯†ç è®¤è¯
ä¼˜åŠ¿ï¼šé…ç½®ç®€å•ï¼Œæ˜“äºç†è§£
åŠ£åŠ¿ï¼šå¯†ç æ˜æ–‡ä¼ è¾“ï¼ˆéœ€é…åˆSSLï¼‰
é€‚ç”¨åœºæ™¯ï¼šå¼€å‘æµ‹è¯•ç¯å¢ƒ
```

**âš ï¸ å®‰å…¨æé†’**
> PLAINæœºåˆ¶ä¸‹å¯†ç æ˜¯æ˜æ–‡ä¼ è¾“çš„ï¼Œå°±åƒåœ¨ç”µè¯é‡Œå¤§å£°è¯´å‡ºé“¶è¡Œå¯†ç ä¸€æ ·ä¸å®‰å…¨ã€‚ç”Ÿäº§ç¯å¢ƒå¿…é¡»é…åˆSSLä½¿ç”¨ï¼

### 2.3 SCRAMæœºåˆ¶è¯¦è§£


**ğŸ”¸ å·¥ä½œåŸç†**
```
ç‰¹ç‚¹ï¼šåŠ å¯†çš„ç”¨æˆ·åå¯†ç è®¤è¯
ä¼˜åŠ¿ï¼šå¯†ç ç»è¿‡åŠ å¯†å¤„ç†ï¼Œæ›´å®‰å…¨
æ”¯æŒç®—æ³•ï¼šSCRAM-SHA-256, SCRAM-SHA-512
é€‚ç”¨åœºæ™¯ï¼šç”Ÿäº§ç¯å¢ƒæ¨èé€‰æ‹©
```

**ğŸ’¡ å…³é”®æ´å¯Ÿ**
> SCRAMå°±åƒé“¶è¡Œçš„å¯†ç å™¨ï¼Œæ¯æ¬¡è¾“å…¥çš„éƒ½æ˜¯åŠ å¯†åçš„"åŠ¨æ€å¯†ç "ï¼Œå³ä½¿è¢«æˆªè·ä¹Ÿæ— æ³•ç›´æ¥ä½¿ç”¨ã€‚

### 2.4 GSSAPI (Kerberos)æœºåˆ¶è¯¦è§£


**ğŸ”¸ å·¥ä½œåŸç†**
```
ç‰¹ç‚¹ï¼šåŸºäºKerberosç¥¨æ®çš„ä¼ä¸šçº§è®¤è¯
ä¼˜åŠ¿ï¼šå•ç‚¹ç™»å½•ï¼Œé«˜å®‰å…¨æ€§ï¼Œæˆç†Ÿç¨³å®š
åŠ£åŠ¿ï¼šé…ç½®å¤æ‚ï¼Œéœ€è¦KerberosæœåŠ¡å™¨
é€‚ç”¨åœºæ™¯ï¼šå¤§å‹ä¼ä¸šç¯å¢ƒ
```

**ğŸ¢ ä¼ä¸šåœºæ™¯**
> å°±åƒå…¬å¸çš„å·¥ç‰Œç³»ç»Ÿï¼Œä¸€æ¬¡åˆ·å¡ç™»å½•åï¼Œå¯ä»¥è®¿é—®æ‰€æœ‰æˆæƒçš„ç³»ç»Ÿï¼Œæ— éœ€é‡å¤è¾“å…¥å¯†ç ã€‚

---

## 3. âš™ï¸ æ ¸å¿ƒé…ç½®å‚æ•°è¯¦è§£


### 3.1 åŸºç¡€å®‰å…¨åè®®é…ç½®


**ğŸ”§ sasl.enabled.mechanisms**
```
ä½œç”¨ï¼šæŒ‡å®šå¯ç”¨çš„SASLè®¤è¯æœºåˆ¶
æ ¼å¼ï¼šæœºåˆ¶åç§°åˆ—è¡¨ï¼Œé€—å·åˆ†éš”
ç¤ºä¾‹ï¼šPLAIN,SCRAM-SHA-256,GSSAPI

# å®é™…é…ç½®ç¤ºä¾‹
sasl.enabled.mechanisms=SCRAM-SHA-256
```

**ğŸ’¡ é…ç½®å»ºè®®**
```
å¼€å‘ç¯å¢ƒï¼šPLAINï¼ˆé…åˆSSLï¼‰
ç”Ÿäº§ç¯å¢ƒï¼šSCRAM-SHA-256
ä¼ä¸šç¯å¢ƒï¼šGSSAPIï¼ˆKerberosï¼‰
```

**ğŸ”§ security.inter.broker.protocol**
```
ä½œç”¨ï¼šè®¾ç½®Brokerä¹‹é—´çš„é€šä¿¡å®‰å…¨åè®®
å¯é€‰å€¼ï¼š
- PLAINTEXTï¼šæ˜æ–‡é€šä¿¡ï¼ˆä¸æ¨èï¼‰
- SASL_PLAINTEXTï¼šSASLè®¤è¯ï¼Œæ˜æ–‡ä¼ è¾“
- SASL_SSLï¼šSASLè®¤è¯+SSLåŠ å¯†ï¼ˆæ¨èï¼‰
- SSLï¼šä»…SSLåŠ å¯†

# æ¨èé…ç½®
security.inter.broker.protocol=SASL_SSL
```

### 3.2 Brokeré—´è®¤è¯é…ç½®


**ğŸ”§ sasl.mechanism.inter.broker.protocol**
```
ä½œç”¨ï¼šæŒ‡å®šBrokeré—´ä½¿ç”¨çš„SASLæœºåˆ¶
æ³¨æ„ï¼šå¿…é¡»æ˜¯sasl.enabled.mechanismsä¸­çš„ä¸€ç§

# ç¤ºä¾‹é…ç½®
sasl.mechanism.inter.broker.protocol=SCRAM-SHA-256
```

**ğŸ” é…ç½®å…³ç³»å›¾**
```
security.inter.broker.protocol = SASL_SSL
                â†“
sasl.mechanism.inter.broker.protocol = SCRAM-SHA-256
                â†“  
sasl.enabled.mechanisms = SCRAM-SHA-256,PLAIN
```

---

## 4. ğŸ« Kerberosé…ç½®å®æˆ˜


### 4.1 KerberosåŸºç¡€é…ç½®


**ğŸ”§ æ ¸å¿ƒå‚æ•°è¯¦è§£**

**sasl.kerberos.service.name**
```
ä½œç”¨ï¼šæŒ‡å®šKafkaæœåŠ¡çš„Kerberosä¸»ä½“åç§°
é»˜è®¤å€¼ï¼škafka
è¯´æ˜ï¼šå¿…é¡»ä¸KerberosæœåŠ¡å™¨ä¸­æ³¨å†Œçš„æœåŠ¡åä¸€è‡´

# é…ç½®ç¤ºä¾‹
sasl.kerberos.service.name=kafka
```

**sasl.kerberos.kinit.cmd**
```
ä½œç”¨ï¼šæŒ‡å®škinitå‘½ä»¤çš„å®Œæ•´è·¯å¾„
ç”¨é€”ï¼šè·å–Kerberosç¥¨æ®
é»˜è®¤å€¼ï¼š/usr/bin/kinit

# é…ç½®ç¤ºä¾‹
sasl.kerberos.kinit.cmd=/usr/bin/kinit
```

### 4.2 ç¥¨æ®ç®¡ç†é…ç½®


**ğŸ« ç¥¨æ®ç”Ÿå‘½å‘¨æœŸç®¡ç†**

**sasl.kerberos.ticket.renew.window.factor**
```
ä½œç”¨ï¼šæ§åˆ¶ç¥¨æ®æ›´æ–°çš„æ—¶é—´çª—å£
å–å€¼èŒƒå›´ï¼š0.0-1.0
é»˜è®¤å€¼ï¼š0.8ï¼ˆåœ¨ç¥¨æ®80%ç”Ÿå‘½å‘¨æœŸæ—¶å¼€å§‹æ›´æ–°ï¼‰

# é…ç½®ç¤ºä¾‹
sasl.kerberos.ticket.renew.window.factor=0.8
```

**sasl.kerberos.ticket.renew.jitter**
```
ä½œç”¨ï¼šä¸ºç¥¨æ®æ›´æ–°æ·»åŠ éšæœºæŠ–åŠ¨
ç›®çš„ï¼šé¿å…æ‰€æœ‰å®¢æˆ·ç«¯åŒæ—¶æ›´æ–°ç¥¨æ®
é»˜è®¤å€¼ï¼š0.05ï¼ˆ5%çš„éšæœºæŠ–åŠ¨ï¼‰

# é…ç½®ç¤ºä¾‹  
sasl.kerberos.ticket.renew.jitter=0.05
```

**â° ç¥¨æ®æ›´æ–°æ—¶åºå›¾**
```
ç¥¨æ®ç”Ÿå‘½å‘¨æœŸï¼š  [===============================] 100%
æ›´æ–°çª—å£ï¼š      [===================] 80%-100%
éšæœºæŠ–åŠ¨ï¼š      [Â±5%]
å®é™…æ›´æ–°æ—¶é—´ï¼š  [â–ˆâ–ˆâ–ˆâ–ˆ] 78%-82%ä¹‹é—´éšæœº
```

**sasl.kerberos.min.time.before.relogin**
```
ä½œç”¨ï¼šé‡æ–°ç™»å½•çš„æœ€å°æ—¶é—´é—´éš”ï¼ˆæ¯«ç§’ï¼‰
ç›®çš„ï¼šé˜²æ­¢é¢‘ç¹é‡æ–°ç™»å½•
é»˜è®¤å€¼ï¼š60000ï¼ˆ1åˆ†é’Ÿï¼‰

# é…ç½®ç¤ºä¾‹
sasl.kerberos.min.time.before.relogin=60000
```

### 4.3 ç™»å½•åˆ·æ–°é…ç½®


**ğŸ”„ è‡ªåŠ¨åˆ·æ–°æœºåˆ¶**

**sasl.login.refresh.window.factor**
```
ä½œç”¨ï¼šæ§åˆ¶ç™»å½•åˆ·æ–°çš„æ—¶é—´çª—å£
åº”ç”¨ï¼šé€‚ç”¨äºæ‰€æœ‰SASLæœºåˆ¶
é»˜è®¤å€¼ï¼š0.8

# é…ç½®ç¤ºä¾‹
sasl.login.refresh.window.factor=0.8
```

**sasl.login.refresh.min.period.seconds**
```
ä½œç”¨ï¼šç™»å½•åˆ·æ–°çš„æœ€å°å‘¨æœŸï¼ˆç§’ï¼‰
ç›®çš„ï¼šé™åˆ¶åˆ·æ–°é¢‘ç‡
é»˜è®¤å€¼ï¼š60

# é…ç½®ç¤ºä¾‹
sasl.login.refresh.min.period.seconds=60
```

**ğŸ“Š åˆ·æ–°ç­–ç•¥å¯¹æ¯”**

| åˆ·æ–°å‚æ•° | **Kerberosç‰¹æœ‰** | **é€šç”¨SASL** | **æ¨èå€¼** |
|---------|-----------------|-------------|-----------|
| ğŸ« ticket.renew.window.factor | âœ… | âŒ | 0.8 |
| ğŸ”„ login.refresh.window.factor | âœ… | âœ… | 0.8 |
| â±ï¸ min.time.before.relogin | âœ… | âŒ | 60000ms |
| â° refresh.min.period.seconds | âœ… | âœ… | 60s |

---

## 5. ğŸ”‘ JAASé…ç½®è¯¦è§£


### 5.1 JAASé…ç½®åŸºç¡€


**ğŸ¯ ä»€ä¹ˆæ˜¯JAAS**
> JAASï¼ˆJava Authentication and Authorization Serviceï¼‰å°±åƒæ˜¯Javaä¸–ç•Œçš„"èº«ä»½è¯ç³»ç»Ÿ"ï¼Œå®šä¹‰äº†åº”ç”¨ç¨‹åºå¦‚ä½•è¿›è¡Œèº«ä»½éªŒè¯ã€‚

**sasl.jaas.config**
```
ä½œç”¨ï¼šç›´æ¥åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šJAASé…ç½®
ä¼˜åŠ¿ï¼šæ— éœ€å•ç‹¬çš„JAASé…ç½®æ–‡ä»¶
æ ¼å¼ï¼šæ¨¡å—ç±»å + å‚æ•°é…ç½®

# åŸºæœ¬è¯­æ³•
sasl.jaas.config=æ¨¡å—ç±»å required å‚æ•°1="å€¼1" å‚æ•°2="å€¼2";
```

### 5.2 ä¸åŒæœºåˆ¶çš„JAASé…ç½®


**ğŸ”§ PLAINæœºåˆ¶JAASé…ç½®**
```bash
# PLAINæœºåˆ¶é…ç½®ç¤ºä¾‹
sasl.jaas.config=org.apache.kafka.common.security.plain.PlainLoginModule required \
username="admin" \
password="admin-secret";
```

**ğŸ”’ SCRAMæœºåˆ¶JAASé…ç½®**
```bash
# SCRAMæœºåˆ¶é…ç½®ç¤ºä¾‹
sasl.jaas.config=org.apache.kafka.common.security.scram.ScramLoginModule required \
username="admin" \
password="admin-secret";
```

**ğŸ« Kerberosæœºåˆ¶JAASé…ç½®**
```bash
# Kerberosæœºåˆ¶é…ç½®ç¤ºä¾‹
sasl.jaas.config=com.sun.security.auth.module.Krb5LoginModule required \
useKeyTab=true \
storeKey=true \
keyTab="/etc/security/keytabs/kafka_server.keytab" \
principal="kafka/kafka1.example.com@EXAMPLE.COM";
```

### 5.3 JAASé…ç½®æ–‡ä»¶æ–¹å¼


**ğŸ“„ ç‹¬ç«‹JAASé…ç½®æ–‡ä»¶**
```bash
# kafka_server_jaas.conf æ–‡ä»¶å†…å®¹
KafkaServer {
    org.apache.kafka.common.security.scram.ScramLoginModule required
    username="kafka"
    password="kafka-secret";
};

KafkaClient {
    org.apache.kafka.common.security.scram.ScramLoginModule required
    username="client"
    password="client-secret";
};
```

**ğŸš€ å¯åŠ¨æ—¶æŒ‡å®šJAASæ–‡ä»¶**
```bash
# æ–¹å¼1ï¼šJVMå‚æ•°
export KAFKA_OPTS=-Djava.security.auth.login.config=/path/to/kafka_server_jaas.conf

# æ–¹å¼2ï¼šå¯åŠ¨è„šæœ¬
bin/kafka-server-start.sh config/server.properties \
-Djava.security.auth.login.config=/path/to/kafka_server_jaas.conf
```

---

## 6. ğŸ‘¥ å®¢æˆ·ç«¯é…ç½®æŒ‡å—


### 6.1 å®¢æˆ·ç«¯å›è°ƒå¤„ç†å™¨


**sasl.client.callback.handler.class**
```
ä½œç”¨ï¼šè‡ªå®šä¹‰å®¢æˆ·ç«¯è®¤è¯å›è°ƒå¤„ç†å™¨
ç”¨é€”ï¼šå®ç°å¤æ‚çš„è®¤è¯é€»è¾‘
åœºæ™¯ï¼šéœ€è¦åŠ¨æ€è·å–è®¤è¯ä¿¡æ¯æ—¶ä½¿ç”¨

# è‡ªå®šä¹‰å›è°ƒå¤„ç†å™¨ç¤ºä¾‹
sasl.client.callback.handler.class=com.example.CustomAuthCallbackHandler
```

**ğŸ’» è‡ªå®šä¹‰å›è°ƒå¤„ç†å™¨ç¤ºä¾‹**
```java
public class CustomAuthCallbackHandler implements AuthenticateCallbackHandler {
    
    @Override
    public void configure(Map<String, ?> configs, String mechanism, 
                         List<AppConfigurationEntry> jaasConfigEntries) {
        // åˆå§‹åŒ–é…ç½®
    }
    
    @Override
    public void handle(Callback[] callbacks) throws IOException, 
                                                   UnsupportedCallbackException {
        for (Callback callback : callbacks) {
            if (callback instanceof NameCallback) {
                NameCallback nc = (NameCallback) callback;
                nc.setName(getUserName()); // åŠ¨æ€è·å–ç”¨æˆ·å
            } else if (callback instanceof PasswordCallback) {
                PasswordCallback pc = (PasswordCallback) callback;
                pc.setPassword(getPassword().toCharArray()); // åŠ¨æ€è·å–å¯†ç 
            }
        }
    }
    
    @Override
    public void close() {
        // æ¸…ç†èµ„æº
    }
}
```

### 6.2 å®¢æˆ·ç«¯å®Œæ•´é…ç½®ç¤ºä¾‹


**ğŸ“‹ Producerå®¢æˆ·ç«¯é…ç½®**
```properties
# åŸºç¡€è¿æ¥é…ç½®
bootstrap.servers=localhost:9092
security.protocol=SASL_SSL

# SASLè®¤è¯é…ç½®
sasl.mechanism=SCRAM-SHA-256
sasl.jaas.config=org.apache.kafka.common.security.scram.ScramLoginModule required \
username="producer-user" \
password="producer-password";

# SSLé…ç½®ï¼ˆå¦‚æœä½¿ç”¨SASL_SSLï¼‰
ssl.truststore.location=/path/to/kafka.client.truststore.jks
ssl.truststore.password=truststore-password

# åºåˆ—åŒ–é…ç½®
key.serializer=org.apache.kafka.common.serialization.StringSerializer
value.serializer=org.apache.kafka.common.serialization.StringSerializer
```

**ğŸ“‹ Consumerå®¢æˆ·ç«¯é…ç½®**
```properties
# åŸºç¡€è¿æ¥é…ç½®
bootstrap.servers=localhost:9092
security.protocol=SASL_SSL
group.id=secure-consumer-group

# SASLè®¤è¯é…ç½®
sasl.mechanism=SCRAM-SHA-256
sasl.jaas.config=org.apache.kafka.common.security.scram.ScramLoginModule required \
username="consumer-user" \
password="consumer-password";

# SSLé…ç½®
ssl.truststore.location=/path/to/kafka.client.truststore.jks
ssl.truststore.password=truststore-password

# ååºåˆ—åŒ–é…ç½®
key.deserializer=org.apache.kafka.common.serialization.StringDeserializer
value.deserializer=org.apache.kafka.common.serialization.StringDeserializer
```

---

## 7. ğŸ† å®‰å…¨é…ç½®æœ€ä½³å®è·µ


### 7.1 ç¯å¢ƒåˆ†çº§å®‰å…¨ç­–ç•¥


**ğŸ“Š ä¸åŒç¯å¢ƒçš„å®‰å…¨é…ç½®å»ºè®®**

| ç¯å¢ƒç±»å‹ | **è®¤è¯æœºåˆ¶** | **ä¼ è¾“åŠ å¯†** | **å¯†ç ç®¡ç†** | **ç›‘æ§ç­‰çº§** |
|---------|-------------|-------------|-------------|-------------|
| ğŸ§ª **å¼€å‘ç¯å¢ƒ** | PLAIN+SSL | âœ… | ç®€å•å¯†ç  | åŸºç¡€ |
| ğŸ§ª **æµ‹è¯•ç¯å¢ƒ** | SCRAM-SHA-256 | âœ… | å¤æ‚å¯†ç  | ä¸­ç­‰ |
| ğŸ­ **ç”Ÿäº§ç¯å¢ƒ** | SCRAM-SHA-512 | âœ… | å¯†é’¥ç®¡ç† | ä¸¥æ ¼ |
| ğŸ¢ **ä¼ä¸šç¯å¢ƒ** | Kerberos | âœ… | ç»Ÿä¸€è®¤è¯ | å…¨é¢ |

### 7.2 å¯†ç å®‰å…¨ç­–ç•¥


**ğŸ” å¯†ç å¤æ‚åº¦è¦æ±‚**
```
âœ… æ¨èå¯†ç ç­–ç•¥ï¼š
â€¢ æœ€å°‘12ä½å­—ç¬¦
â€¢ åŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šå­—ç¬¦
â€¢ é¿å…ä½¿ç”¨å¸¸è§è¯å…¸å•è¯
â€¢ å®šæœŸè½®æ¢ï¼ˆå»ºè®®90å¤©ï¼‰

âŒ é¿å…çš„å¯†ç ï¼š
â€¢ admin/123456ç­‰ç®€å•å¯†ç 
â€¢ ä¸ç”¨æˆ·åç›¸åŒçš„å¯†ç 
â€¢ ç”Ÿæ—¥ã€å§“åç­‰ä¸ªäººä¿¡æ¯
â€¢ é‡å¤ä½¿ç”¨çš„å†å²å¯†ç 
```

**ğŸ”„ å¯†ç è½®æ¢ç­–ç•¥**
```
è‡ªåŠ¨è½®æ¢æµç¨‹ï¼š
1ï¸âƒ£ ç”Ÿæˆæ–°å¯†ç 
2ï¸âƒ£ æ›´æ–°Kafkaé…ç½®
3ï¸âƒ£ é‡å¯ç›¸å…³æœåŠ¡
4ï¸âƒ£ éªŒè¯è¿æ¥æ­£å¸¸
5ï¸âƒ£ åˆ é™¤æ—§å¯†ç 
```

### 7.3 ç›‘æ§ä¸å®¡è®¡


**ğŸ“Š å…³é”®ç›‘æ§æŒ‡æ ‡**
```
è®¤è¯ç›‘æ§ï¼š
â€¢ è®¤è¯æˆåŠŸç‡
â€¢ è®¤è¯å¤±è´¥æ¬¡æ•°
â€¢ å¼‚å¸¸ç™»å½•æºIP
â€¢ ç¥¨æ®è¿‡æœŸäº‹ä»¶

æ€§èƒ½ç›‘æ§ï¼š
â€¢ è®¤è¯å»¶è¿Ÿæ—¶é—´
â€¢ è¿æ¥å»ºç«‹æ—¶é—´
â€¢ ç¥¨æ®æ›´æ–°é¢‘ç‡
â€¢ å›è°ƒå¤„ç†è€—æ—¶
```

**ğŸ” å®¡è®¡æ—¥å¿—é…ç½®**
```properties
# å¯ç”¨å®‰å…¨äº‹ä»¶æ—¥å¿—
log4j.logger.kafka.authorizer.logger=INFO, authorizerAppender
log4j.additivity.kafka.authorizer.logger=false

# è®°å½•è®¤è¯äº‹ä»¶
log4j.logger.org.apache.kafka.common.security=DEBUG, securityAppender
```

---

## 8. ğŸ”§ å¸¸è§é—®é¢˜ä¸æ’é”™


### 8.1 è®¤è¯å¤±è´¥é—®é¢˜


**âŒ å¸¸è§é”™è¯¯ç—‡çŠ¶**
```
é”™è¯¯1ï¼šAuthentication failed
åŸå› ï¼šç”¨æˆ·åæˆ–å¯†ç é”™è¯¯
è§£å†³ï¼šæ£€æŸ¥JAASé…ç½®ä¸­çš„è®¤è¯ä¿¡æ¯

é”™è¯¯2ï¼šSASL authentication failed
åŸå› ï¼šSASLæœºåˆ¶ä¸åŒ¹é…
è§£å†³ï¼šç¡®ä¿å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä½¿ç”¨ç›¸åŒæœºåˆ¶
```

**ğŸ” è°ƒè¯•æ–¹æ³•**
```properties
# å¼€å¯SASLè°ƒè¯•æ—¥å¿—
-Djava.security.debug=all
-Dsun.security.krb5.debug=true

# ä¸´æ—¶å¼€å¯è¯¦ç»†æ—¥å¿—
log4j.logger.org.apache.kafka.common.security=DEBUG
```

### 8.2 Kerberosç›¸å…³é—®é¢˜


**ğŸ« ç¥¨æ®é—®é¢˜æ’æŸ¥**
```bash
# æ£€æŸ¥å½“å‰ç¥¨æ®çŠ¶æ€
klist

# æ‰‹åŠ¨è·å–ç¥¨æ®
kinit -kt /path/to/keytab principal@REALM

# æ£€æŸ¥ç¥¨æ®è¯¦ç»†ä¿¡æ¯
klist -v
```

**â° æ—¶é—´åŒæ­¥é—®é¢˜**
> Kerberoså¯¹æ—¶é—´éå¸¸æ•æ„Ÿï¼ŒæœåŠ¡å™¨æ—¶é—´å·®è¶…è¿‡5åˆ†é’Ÿå°±ä¼šè®¤è¯å¤±è´¥ã€‚è¿™å°±åƒçº¦ä¼šè¿Ÿåˆ°5åˆ†é’Ÿï¼Œå¯¹æ–¹å¯èƒ½å°±èµ°äº†ï¼

```bash
# æ£€æŸ¥ç³»ç»Ÿæ—¶é—´
date

# ä¸KDCæ—¶é—´åŒæ­¥
ntpdate kdc-server.example.com
```

### 8.3 é…ç½®éªŒè¯æ¸…å•


**âœ… éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•**
```
ğŸ”¸ ç½‘ç»œè¿é€šæ€§
- [ ] å®¢æˆ·ç«¯èƒ½è®¿é—®Kafkaç«¯å£
- [ ] é˜²ç«å¢™è§„åˆ™æ­£ç¡®é…ç½®
- [ ] DNSè§£ææ­£å¸¸

ğŸ”¸ è®¤è¯é…ç½®
- [ ] SASLæœºåˆ¶åŒ¹é…
- [ ] JAASé…ç½®æ­£ç¡®
- [ ] ç”¨æˆ·å¯†ç æœ‰æ•ˆ

ğŸ”¸ SSLé…ç½®ï¼ˆå¦‚æœä½¿ç”¨ï¼‰
- [ ] è¯ä¹¦æ–‡ä»¶å­˜åœ¨ä¸”å¯è¯»
- [ ] è¯ä¹¦æœªè¿‡æœŸ
- [ ] ä¿¡ä»»åº“é…ç½®æ­£ç¡®

ğŸ”¸ Kerberosé…ç½®ï¼ˆå¦‚æœä½¿ç”¨ï¼‰
- [ ] keytabæ–‡ä»¶æœ‰æ•ˆ
- [ ] ä¸»ä½“åç§°æ­£ç¡®
- [ ] æ—¶é—´åŒæ­¥æ­£å¸¸
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ SASLè®¤è¯ï¼šKafkaçš„"é—¨ç¦ç³»ç»Ÿ"ï¼Œç¡®ä¿åªæœ‰åˆæ³•ç”¨æˆ·èƒ½è®¿é—®
ğŸ”¸ è®¤è¯æœºåˆ¶ï¼šPLAINï¼ˆç®€å•ï¼‰ã€SCRAMï¼ˆå®‰å…¨ï¼‰ã€Kerberosï¼ˆä¼ä¸šçº§ï¼‰
ğŸ”¸ JAASé…ç½®ï¼šå®šä¹‰å¦‚ä½•è¿›è¡Œèº«ä»½éªŒè¯çš„"èº«ä»½è¯ç³»ç»Ÿ"
ğŸ”¸ å®‰å…¨åè®®ï¼šæ§åˆ¶æ•°æ®ä¼ è¾“çš„åŠ å¯†å’Œè®¤è¯æ–¹å¼
ğŸ”¸ ç¥¨æ®ç®¡ç†ï¼šKerberosçš„è‡ªåŠ¨æ›´æ–°å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†
```

### 9.2 å…³é”®é…ç½®å‚æ•°è®°å¿†


**ğŸ¯ å¿…èƒŒé…ç½®å‚æ•°**
```
åŸºç¡€å®‰å…¨ï¼š
â€¢ security.inter.broker.protocol=SASL_SSL
â€¢ sasl.enabled.mechanisms=SCRAM-SHA-256
â€¢ sasl.mechanism.inter.broker.protocol=SCRAM-SHA-256

JAASè®¤è¯ï¼š
â€¢ sasl.jaas.config=æ¨¡å—ç±»å required å‚æ•°é…ç½®;

Kerberosä¸“ç”¨ï¼š
â€¢ sasl.kerberos.service.name=kafka
â€¢ sasl.kerberos.ticket.renew.window.factor=0.8
â€¢ sasl.login.refresh.window.factor=0.8
```

### 9.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸš€ å¿«é€Ÿä¸Šæ‰‹æ­¥éª¤**
```
1ï¸âƒ£ é€‰æ‹©è®¤è¯æœºåˆ¶ï¼šå¼€å‘ç”¨PLAINï¼Œç”Ÿäº§ç”¨SCRAM
2ï¸âƒ£ é…ç½®æœåŠ¡ç«¯ï¼šè®¾ç½®security.inter.broker.protocol
3ï¸âƒ£ é…ç½®å®¢æˆ·ç«¯ï¼šè®¾ç½®sasl.jaas.config
4ï¸âƒ£ æµ‹è¯•è¿æ¥ï¼šéªŒè¯è®¤è¯æ˜¯å¦æ­£å¸¸å·¥ä½œ
5ï¸âƒ£ ç›‘æ§è¿è¡Œï¼šå…³æ³¨è®¤è¯æˆåŠŸç‡å’Œæ€§èƒ½
```

**ğŸ’¡ é€‰æ‹©å»ºè®®**
```
åœºæ™¯æ¨èï¼š
ğŸ  ä¸ªäººå­¦ä¹ ï¼šPLAIN + SSL
ğŸ¢ å°å›¢é˜Ÿï¼šSCRAM-SHA-256 + SSL  
ğŸ­ å¤§ä¼ä¸šï¼šKerberos + SSL
â˜ï¸ äº‘ç¯å¢ƒï¼šOAuth + SSLï¼ˆå¦‚æœæ”¯æŒï¼‰
```

### 9.4 å®‰å…¨æœ€ä½³å®è·µ


**ğŸ›¡ï¸ å®‰å…¨é˜²æŠ¤è¦ç‚¹**
```
å¯†ç å®‰å…¨ï¼š
â€¢ ä½¿ç”¨å¼ºå¯†ç ç­–ç•¥
â€¢ å®šæœŸè½®æ¢è®¤è¯ä¿¡æ¯
â€¢ é¿å…ç¡¬ç¼–ç å¯†ç 

ç½‘ç»œå®‰å…¨ï¼š
â€¢ ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨SSL
â€¢ é™åˆ¶ç½‘ç»œè®¿é—®æ¥æº
â€¢ ç›‘æ§å¼‚å¸¸è¿æ¥

è¿ç»´å®‰å…¨ï¼š
â€¢ å®šæœŸæ£€æŸ¥å®‰å…¨æ—¥å¿—
â€¢ åŠæ—¶æ›´æ–°å®‰å…¨è¡¥ä¸
â€¢ å»ºç«‹åº”æ€¥å“åº”æœºåˆ¶
```

**ğŸ”‘ æ ¸å¿ƒè®°å¿†å£è¯€**
> ğŸµ "SASLè®¤è¯é—¨ç¦ä¸¥ï¼ŒSCRAMåŠ å¯†æ›´å®‰å…¨ï¼ŒKerberosç¥¨æ®è¦æ›´æ–°ï¼ŒJAASé…ç½®æ˜¯å…³é”®ï¼ŒSSLä¼ è¾“é˜²çªƒå¬ï¼Œç›‘æ§æ—¥å¿—ä¿å¹³å®‰ï¼"

**ğŸ¯ å…³é”®ç†è§£**
- SASLè§£å†³çš„æ˜¯"è°èƒ½è¿æ¥"çš„é—®é¢˜
- SSLè§£å†³çš„æ˜¯"å¦‚ä½•å®‰å…¨ä¼ è¾“"çš„é—®é¢˜  
- ä¸¤è€…ç»“åˆæ‰èƒ½æ„å»ºå®Œæ•´çš„å®‰å…¨ä½“ç³»
- é…ç½®å¤æ‚ä½†å®‰å…¨ä»·å€¼å·¨å¤§
- ä¸åŒç¯å¢ƒé€‰æ‹©ä¸åŒçš„å®‰å…¨çº§åˆ«