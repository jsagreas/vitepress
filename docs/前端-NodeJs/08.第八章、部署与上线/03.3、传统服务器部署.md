---
title: 3ã€ä¼ ç»ŸæœåŠ¡å™¨éƒ¨ç½²
---
## ğŸ“š ç›®å½•

1. [æœåŠ¡å™¨ç¯å¢ƒå‡†å¤‡](#1-æœåŠ¡å™¨ç¯å¢ƒå‡†å¤‡)
2. [LinuxåŸºç¡€æ“ä½œ](#2-LinuxåŸºç¡€æ“ä½œ)
3. [æœåŠ¡å™¨å®‰å…¨é…ç½®](#3-æœåŠ¡å™¨å®‰å…¨é…ç½®)
4. [Nginxåå‘ä»£ç†](#4-Nginxåå‘ä»£ç†)
5. [åŸŸåä¸SSLé…ç½®](#5-åŸŸåä¸SSLé…ç½®)
6. [è‡ªåŠ¨åŒ–éƒ¨ç½²æµç¨‹](#6-è‡ªåŠ¨åŒ–éƒ¨ç½²æµç¨‹)
7. [æœåŠ¡ç®¡ç†ä¸ç›‘æ§](#7-æœåŠ¡ç®¡ç†ä¸ç›‘æ§)
8. [æ•…éšœæ’æŸ¥ä¸å¤‡ä»½](#8-æ•…éšœæ’æŸ¥ä¸å¤‡ä»½)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ–¥ï¸ æœåŠ¡å™¨ç¯å¢ƒå‡†å¤‡


### 1.1 ä»€ä¹ˆæ˜¯ä¼ ç»ŸæœåŠ¡å™¨éƒ¨ç½²


**ğŸ’¡ ç®€å•ç†è§£**ï¼šä¼ ç»ŸæœåŠ¡å™¨éƒ¨ç½²å°±æ˜¯æŠŠä½ å¼€å‘å¥½çš„Node.jsåº”ç”¨æ”¾åˆ°ä¸€å°çœŸæ­£çš„æœåŠ¡å™¨ä¸Šè¿è¡Œï¼Œè®©å…¨ä¸–ç•Œçš„ç”¨æˆ·éƒ½èƒ½è®¿é—®ã€‚

```
å¼€å‘ç¯å¢ƒï¼ˆä½ çš„ç”µè„‘ï¼‰        ç”Ÿäº§ç¯å¢ƒï¼ˆæœåŠ¡å™¨ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  localhost:3000 â”‚   â†’   â”‚ yoursite.com:80 â”‚
â”‚  åªæœ‰ä½ èƒ½è®¿é—®    â”‚        â”‚  å…¨ä¸–ç•Œéƒ½èƒ½è®¿é—®  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”¸ ä¼ ç»Ÿéƒ¨ç½² vs äº‘éƒ¨ç½²å¯¹æ¯”**
| æ–¹å¼ | **ä¼˜ç‚¹** | **ç¼ºç‚¹** | **é€‚ç”¨åœºæ™¯** |
|------|---------|---------|-------------|
| **ä¼ ç»ŸæœåŠ¡å™¨** | `å®Œå…¨æ§åˆ¶ï¼Œæˆæœ¬å¯æ§` | `éœ€è¦è¿ç»´çŸ¥è¯†ï¼Œé…ç½®å¤æ‚` | `ä¸­å°å‹é¡¹ç›®ï¼Œé¢„ç®—æœ‰é™` |
| **äº‘å¹³å°éƒ¨ç½²** | `ç®€å•å¿«é€Ÿï¼Œè‡ªåŠ¨æ‰©å®¹` | `æˆæœ¬è¾ƒé«˜ï¼Œä¾èµ–å¹³å°` | `å¤§å‹é¡¹ç›®ï¼Œå¿«é€Ÿä¸Šçº¿` |

### 1.2 é€‰æ‹©æœåŠ¡å™¨


**ğŸŒŸ å¸¸è§æœåŠ¡å™¨é€‰æ‹©**
```
äº‘æœåŠ¡å™¨æ¨èï¼š
ğŸ”¸ é˜¿é‡Œäº‘ ECS     - å›½å†…è®¿é—®å¿«ï¼Œæ–‡æ¡£ä¸°å¯Œ
ğŸ”¸ è…¾è®¯äº‘ CVM     - ä»·æ ¼å®æƒ ï¼Œæ–°æ‰‹å‹å¥½  
ğŸ”¸ åä¸ºäº‘ ECS     - ä¼ä¸šçº§ç¨³å®š
ğŸ”¸ DigitalOcean   - å›½å¤–ä¾¿å®œï¼Œé…ç½®ç®€å•
ğŸ”¸ AWS EC2        - åŠŸèƒ½å¼ºå¤§ï¼Œå…¨çƒéƒ¨ç½²

é…ç½®å»ºè®®ï¼ˆæ–°æ‰‹å…¥é—¨ï¼‰ï¼š
CPU: 1-2æ ¸
å†…å­˜: 2-4GB
å­˜å‚¨: 40-80GB SSD
å¸¦å®½: 1-5Mbps
```

**âš ï¸ é‡è¦æé†’**
```
ğŸ’¡ æ–°æ‰‹å»ºè®®ï¼šå…ˆç”¨ä¾¿å®œçš„äº‘æœåŠ¡å™¨ç»ƒæ‰‹
ğŸ”´ é¿å…ï¼šç›´æ¥ç”¨ä¸ªäººç”µè„‘åšæœåŠ¡å™¨
âœ… æ¨èï¼šé€‰æ‹©æœ‰æŠ€æœ¯æ”¯æŒçš„äº‘æœåŠ¡å•†
```

### 1.3 åŸºç¡€ç¯å¢ƒå®‰è£…


**ğŸ“¦ å¿…å¤‡è½¯ä»¶æ¸…å•**
```bash
# 1. æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# 2. å®‰è£… Node.js (æ¨èä½¿ç”¨ NodeSource)
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# 3. å®‰è£… PM2 (è¿›ç¨‹ç®¡ç†å™¨)
sudo npm install -g pm2

# 4. å®‰è£… Nginx (åå‘ä»£ç†)
sudo apt install nginx -y

# 5. å®‰è£… Git (ä»£ç ç®¡ç†)
sudo apt install git -y
```

**âœ… éªŒè¯å®‰è£…**
```bash
# æ£€æŸ¥ç‰ˆæœ¬
node --version    # åº”è¯¥æ˜¾ç¤º v18.x.x
npm --version     # åº”è¯¥æ˜¾ç¤ºå¯¹åº”ç‰ˆæœ¬
pm2 --version     # åº”è¯¥æ˜¾ç¤ºç‰ˆæœ¬å·
nginx -v          # åº”è¯¥æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯
```

---

## 2. ğŸ§ LinuxåŸºç¡€æ“ä½œ


### 2.1 å¿…ä¼šçš„Linuxå‘½ä»¤


**ğŸ”¸ æ–‡ä»¶å’Œç›®å½•æ“ä½œ**
```bash
# ç›®å½•å¯¼èˆª
pwd                    # æ˜¾ç¤ºå½“å‰è·¯å¾„
ls -la                 # åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬éšè—æ–‡ä»¶ï¼‰
cd /var/www           # åˆ‡æ¢åˆ°æŒ‡å®šç›®å½•
mkdir myapp           # åˆ›å»ºç›®å½•

# æ–‡ä»¶æ“ä½œ
cp app.js backup.js   # å¤åˆ¶æ–‡ä»¶
mv old.js new.js      # ç§»åŠ¨/é‡å‘½åæ–‡ä»¶
rm unwanted.js        # åˆ é™¤æ–‡ä»¶
rm -rf temp/          # åˆ é™¤ç›®å½•åŠå†…å®¹

# æ–‡ä»¶æŸ¥çœ‹
cat package.json      # æŸ¥çœ‹æ–‡ä»¶å†…å®¹
tail -f logs/app.log  # å®æ—¶æŸ¥çœ‹æ—¥å¿—
nano app.js           # ç¼–è¾‘æ–‡ä»¶
```

**ğŸ”¸ æƒé™ç®¡ç†**
```bash
# æŸ¥çœ‹æƒé™
ls -la                # æ˜¾ç¤ºæ–‡ä»¶æƒé™

# ä¿®æ”¹æƒé™
chmod 755 start.sh    # ç»™è„šæœ¬æ‰§è¡Œæƒé™
chown www-data:www-data app.js  # æ”¹å˜æ–‡ä»¶æ‰€æœ‰è€…

# ç”¨æˆ·åˆ‡æ¢
sudo su -             # åˆ‡æ¢åˆ°rootç”¨æˆ·
sudo -u www-data command  # ä»¥æŒ‡å®šç”¨æˆ·è¿è¡Œå‘½ä»¤
```

**ğŸ’¡ æƒé™è§£é‡Š**
```
æƒé™æ ¼å¼ï¼šdrwxrwxrwx
d = ç›®å½•æ ‡è¯†
rwx = æ‰€æœ‰è€…æƒé™ï¼ˆè¯»å†™æ‰§è¡Œï¼‰
rwx = ç»„æƒé™
rwx = å…¶ä»–ç”¨æˆ·æƒé™

æ•°å­—æƒé™ï¼š
7 = rwx (è¯»å†™æ‰§è¡Œ)
6 = rw- (è¯»å†™)
5 = r-x (è¯»æ‰§è¡Œ)
4 = r-- (åªè¯»)
```

### 2.2 è¿›ç¨‹å’ŒæœåŠ¡ç®¡ç†


**ğŸ”¸ è¿›ç¨‹æŸ¥çœ‹**
```bash
# æŸ¥çœ‹è¿›ç¨‹
ps aux | grep node    # æŸ¥æ‰¾Node.jsè¿›ç¨‹
top                   # å®æ—¶æŸ¥çœ‹ç³»ç»Ÿèµ„æº
htop                  # æ›´å¥½çœ‹çš„ç³»ç»Ÿç›‘æ§

# æ€æ­»è¿›ç¨‹
kill 1234            # æ€æ­»æŒ‡å®šè¿›ç¨‹ID
killall node          # æ€æ­»æ‰€æœ‰nodeè¿›ç¨‹
pkill -f "app.js"     # æŒ‰åç§°æ€æ­»è¿›ç¨‹
```

**ğŸ”¸ ç³»ç»ŸæœåŠ¡**
```bash
# æœåŠ¡ç®¡ç† (systemctl)
sudo systemctl start nginx     # å¯åŠ¨æœåŠ¡
sudo systemctl stop nginx      # åœæ­¢æœåŠ¡
sudo systemctl restart nginx   # é‡å¯æœåŠ¡
sudo systemctl status nginx    # æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo systemctl enable nginx    # å¼€æœºè‡ªå¯åŠ¨
```

---

## 3. ğŸ›¡ï¸ æœåŠ¡å™¨å®‰å…¨é…ç½®


### 3.1 åŸºç¡€å®‰å…¨è®¾ç½®


**ğŸ”¸ SSHå®‰å…¨é…ç½®**
```bash
# ç¼–è¾‘SSHé…ç½®
sudo nano /etc/ssh/sshd_config

# é‡è¦å®‰å…¨è®¾ç½®
Port 22                    # å¯ä»¥æ”¹æˆå…¶ä»–ç«¯å£
PermitRootLogin no         # ç¦æ­¢rootç›´æ¥ç™»å½•
PasswordAuthentication yes # å¯†ç ç™»å½•ï¼ˆå»ºè®®æ”¹ä¸ºnoç”¨å¯†é’¥ï¼‰
MaxAuthTries 3             # æœ€å¤§ç™»å½•å°è¯•æ¬¡æ•°

# é‡å¯SSHæœåŠ¡
sudo systemctl restart sshd
```

**ğŸ”¸ é˜²ç«å¢™é…ç½®**
```bash
# å®‰è£…å’Œé…ç½® UFW (ç®€å•é˜²ç«å¢™)
sudo ufw enable                # å¯ç”¨é˜²ç«å¢™
sudo ufw default deny incoming # é»˜è®¤æ‹’ç»å…¥ç«™
sudo ufw default allow outgoing # é»˜è®¤å…è®¸å‡ºç«™

# å¼€æ”¾å¿…è¦ç«¯å£
sudo ufw allow ssh            # SSH (22ç«¯å£)
sudo ufw allow 80             # HTTP
sudo ufw allow 443            # HTTPS
sudo ufw allow 3000           # Node.jsåº”ç”¨ç«¯å£

# æŸ¥çœ‹çŠ¶æ€
sudo ufw status
```

### 3.2 ç”¨æˆ·ç®¡ç†


**ğŸ”¸ åˆ›å»ºåº”ç”¨ç”¨æˆ·**
```bash
# åˆ›å»ºä¸“é—¨çš„åº”ç”¨ç”¨æˆ·ï¼ˆä¸ç»™sudoæƒé™ï¼‰
sudo adduser nodeapp
sudo usermod -aG www-data nodeapp

# åˆ‡æ¢åˆ°åº”ç”¨ç”¨æˆ·
sudo su - nodeapp

# åˆ›å»ºåº”ç”¨ç›®å½•
mkdir ~/myapp
cd ~/myapp
```

**ğŸ’¡ ä¸ºä»€ä¹ˆè¦åˆ›å»ºä¸“é—¨ç”¨æˆ·ï¼Ÿ**
```
å®‰å…¨åŸåˆ™ï¼šæœ€å°æƒé™åŸåˆ™
- rootç”¨æˆ·æƒé™å¤ªå¤§ï¼Œé£é™©é«˜
- åº”ç”¨ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ–‡ä»¶
- å³ä½¿è¢«æ”»å‡»ï¼Œå½±å“èŒƒå›´æœ‰é™
```

---

## 4. ğŸ”„ Nginxåå‘ä»£ç†


### 4.1 ä»€ä¹ˆæ˜¯åå‘ä»£ç†


**ğŸ’¡ ç®€å•ç†è§£**ï¼šåå‘ä»£ç†å°±åƒæ˜¯ä½ å®¶çš„é—¨å«ï¼Œå¤–é¢çš„äººè¦æ‰¾ä½ ï¼Œå…ˆé€šè¿‡é—¨å«ï¼Œé—¨å«å†è½¬å‘Šä½ ã€‚

```
ç”¨æˆ·è®¿é—®æµç¨‹ï¼š
ç”¨æˆ·æµè§ˆå™¨ â†’ Nginx(80ç«¯å£) â†’ Node.jsåº”ç”¨(3000ç«¯å£)
    â†“
www.yoursite.com â†’ æœåŠ¡å™¨:80 â†’ localhost:3000
```

**ğŸ”¸ åå‘ä»£ç†çš„å¥½å¤„**
- **ğŸ›¡ï¸ å®‰å…¨æ€§**ï¼šéšè—çœŸå®çš„åº”ç”¨æœåŠ¡å™¨
- **âš¡ æ€§èƒ½**ï¼šç¼“å­˜é™æ€æ–‡ä»¶ï¼Œå‡è½»åº”ç”¨å‹åŠ›
- **ğŸ”„ è´Ÿè½½å‡è¡¡**ï¼šå¯ä»¥åˆ†å‘è¯·æ±‚åˆ°å¤šä¸ªåº”ç”¨å®ä¾‹
- **ğŸ”’ SSLç»ˆæ­¢**ï¼šç»Ÿä¸€å¤„ç†HTTPSè¯ä¹¦

### 4.2 NginxåŸºç¡€é…ç½®


**ğŸ”¸ åŸºæœ¬é…ç½®æ–‡ä»¶**
```nginx
# /etc/nginx/sites-available/myapp
server {
    listen 80;                          # ç›‘å¬80ç«¯å£
    server_name yoursite.com;           # ä½ çš„åŸŸå
    
    # åå‘ä»£ç†åˆ°Node.jsåº”ç”¨
    location / {
        proxy_pass http://localhost:3000;    # è½¬å‘åˆ°Node.js
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
    
    # é™æ€æ–‡ä»¶ç›´æ¥æœåŠ¡
    location /static/ {
        alias /home/nodeapp/myapp/public/;
        expires 30d;                    # ç¼“å­˜30å¤©
        add_header Cache-Control "public, immutable";
    }
}
```

**ğŸ”¸ å¯ç”¨é…ç½®**
```bash
# åˆ›å»ºè½¯é“¾æ¥å¯ç”¨ç«™ç‚¹
sudo ln -s /etc/nginx/sites-available/myapp /etc/nginx/sites-enabled/

# æµ‹è¯•é…ç½®æ–‡ä»¶
sudo nginx -t

# é‡æ–°åŠ è½½é…ç½®
sudo systemctl reload nginx
```

### 4.3 è´Ÿè½½å‡è¡¡é…ç½®


**ğŸ”¸ å¤šå®ä¾‹è´Ÿè½½å‡è¡¡**
```nginx
# å®šä¹‰ä¸Šæ¸¸æœåŠ¡å™¨ç»„
upstream nodeapp {
    server localhost:3000 weight=3;    # æƒé‡3
    server localhost:3001 weight=2;    # æƒé‡2
    server localhost:3002 weight=1;    # æƒé‡1
    
    # å¥åº·æ£€æŸ¥
    keepalive 64;
}

server {
    listen 80;
    server_name yoursite.com;
    
    location / {
        proxy_pass http://nodeapp;      # ä½¿ç”¨ä¸Šæ¸¸æœåŠ¡å™¨ç»„
        # ... å…¶ä»–proxyè®¾ç½®
    }
}
```

**ğŸ’¡ è´Ÿè½½å‡è¡¡ç­–ç•¥**
```
round-robin (é»˜è®¤)ï¼šè½®è¯¢åˆ†å‘è¯·æ±‚
least_connï¼šåˆ†å‘åˆ°è¿æ¥æ•°æœ€å°‘çš„æœåŠ¡å™¨
ip_hashï¼šæ ¹æ®å®¢æˆ·ç«¯IPåˆ†å‘ï¼ˆä¼šè¯ä¿æŒï¼‰
```

---

## 5. ğŸŒ åŸŸåä¸SSLé…ç½®


### 5.1 åŸŸåé…ç½®


**ğŸ”¸ DNSè§£æè®¾ç½®**
```
åŸŸåè§£æè®°å½•ç±»å‹ï¼š
Aè®°å½•ï¼š    yoursite.com â†’ æœåŠ¡å™¨IPåœ°å€
CNAMEè®°å½•ï¼š www.yoursite.com â†’ yoursite.com
MXè®°å½•ï¼š   é‚®ä»¶æœåŠ¡å™¨ï¼ˆå¦‚æœéœ€è¦ï¼‰

DNSé…ç½®ç¤ºä¾‹ï¼š
ä¸»æœºè®°å½•    è®°å½•ç±»å‹    è®°å½•å€¼
@          A          123.456.789.123
www        CNAME      yoursite.com
```

**â° DNSç”Ÿæ•ˆæ—¶é—´**
```
ä¸€èˆ¬éœ€è¦ï¼š10åˆ†é’Ÿ - 24å°æ—¶
æ£€æŸ¥æ–¹æ³•ï¼šping yoursite.com
å¦‚æœè¿”å›ä½ çš„æœåŠ¡å™¨IPï¼Œè¯´æ˜è§£ææˆåŠŸ
```

### 5.2 SSL/HTTPSé…ç½®


**ğŸ”¸ ä»€ä¹ˆæ˜¯SSLï¼Ÿ**
```
SSL/TLSï¼šå®‰å…¨å¥—æ¥å­—å±‚ï¼Œç”¨äºåŠ å¯†ç½‘ç«™æ•°æ®ä¼ è¾“
HTTPS = HTTP + SSL
ä½œç”¨ï¼šä¿æŠ¤ç”¨æˆ·æ•°æ®ï¼Œæå‡SEOæ’åï¼Œå¢åŠ ä¿¡ä»»åº¦
```

**ğŸ”¸ ä½¿ç”¨Let's Encryptå…è´¹è¯ä¹¦**
```bash
# å®‰è£… Certbot
sudo apt install certbot python3-certbot-nginx -y

# è·å–SSLè¯ä¹¦
sudo certbot --nginx -d yoursite.com -d www.yoursite.com

# è¯ä¹¦è‡ªåŠ¨ç»­æœŸ
sudo crontab -e
# æ·»åŠ è¿™è¡Œï¼š0 12 * * * /usr/bin/certbot renew --quiet
```

**ğŸ”¸ HTTPSé…ç½®ç»“æœ**
```nginx
# Certbotä¼šè‡ªåŠ¨ä¿®æ”¹ä½ çš„Nginxé…ç½®
server {
    listen 80;
    server_name yoursite.com www.yoursite.com;
    return 301 https://$server_name$request_uri;  # é‡å®šå‘åˆ°HTTPS
}

server {
    listen 443 ssl;
    server_name yoursite.com www.yoursite.com;
    
    ssl_certificate /etc/letsencrypt/live/yoursite.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/yoursite.com/privkey.pem;
    
    # ... å…¶ä»–é…ç½®
}
```

---

## 6. ğŸ¤– è‡ªåŠ¨åŒ–éƒ¨ç½²æµç¨‹


### 6.1 Gitä»£ç ç®¡ç†


**ğŸ”¸ æœåŠ¡å™¨ç«¯Gité…ç½®**
```bash
# åœ¨æœåŠ¡å™¨ä¸Šå…‹éš†ä»£ç 
cd /home/nodeapp
git clone https://github.com/yourusername/yourapp.git myapp
cd myapp

# å®‰è£…ä¾èµ–
npm install --production

# åˆ›å»ºç¯å¢ƒé…ç½®æ–‡ä»¶
cp .env.example .env
nano .env  # ç¼–è¾‘ç”Ÿäº§ç¯å¢ƒé…ç½®
```

**ğŸ”¸ éƒ¨ç½²è„šæœ¬**
```bash
#!/bin/bash
# deploy.sh - è‡ªåŠ¨éƒ¨ç½²è„šæœ¬

echo "ğŸš€ å¼€å§‹éƒ¨ç½²..."

# 1. æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main
if [ $? -ne 0 ]; then
    echo "âŒ Gitæ‹‰å–å¤±è´¥"
    exit 1
fi

# 2. å®‰è£…/æ›´æ–°ä¾èµ–
npm install --production
if [ $? -ne 0 ]; then
    echo "âŒ ä¾èµ–å®‰è£…å¤±è´¥"
    exit 1
fi

# 3. é‡å¯åº”ç”¨
pm2 restart myapp
if [ $? -ne 0 ]; then
    echo "âŒ åº”ç”¨é‡å¯å¤±è´¥"
    exit 1
fi

echo "âœ… éƒ¨ç½²æˆåŠŸå®Œæˆï¼"
```

### 6.2 ç¯å¢ƒé…ç½®ç®¡ç†


**ğŸ”¸ ç”Ÿäº§ç¯å¢ƒé…ç½®**
```javascript
// .env ç”Ÿäº§ç¯å¢ƒé…ç½®
NODE_ENV=production
PORT=3000
DB_HOST=localhost
DB_NAME=myapp_prod
DB_USER=dbuser
DB_PASSWORD=securepassword
JWT_SECRET=your-super-secret-key
```

**ğŸ”¸ é…ç½®æ–‡ä»¶åŠ è½½**
```javascript
// config/config.js
require('dotenv').config();

module.exports = {
    port: process.env.PORT || 3000,
    environment: process.env.NODE_ENV || 'development',
    database: {
        host: process.env.DB_HOST,
        name: process.env.DB_NAME,
        user: process.env.DB_USER,
        password: process.env.DB_PASSWORD
    },
    jwt: {
        secret: process.env.JWT_SECRET
    }
};
```

---

## 7. âš™ï¸ æœåŠ¡ç®¡ç†ä¸ç›‘æ§


### 7.1 PM2è¿›ç¨‹ç®¡ç†


**ğŸ”¸ ä»€ä¹ˆæ˜¯PM2ï¼Ÿ**
```
PM2ï¼šNode.jsåº”ç”¨çš„è¿›ç¨‹ç®¡ç†å™¨
ä½œç”¨ï¼š
- åº”ç”¨å´©æºƒè‡ªåŠ¨é‡å¯
- å¤šå®ä¾‹è´Ÿè½½å‡è¡¡
- é›¶åœæœºæ—¶é—´é‡è½½
- å®æ—¶ç›‘æ§å’Œæ—¥å¿—ç®¡ç†
```

**ğŸ”¸ PM2åŸºæœ¬ä½¿ç”¨**
```bash
# å¯åŠ¨åº”ç”¨
pm2 start app.js --name "myapp"

# æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
pm2 list                    # æ‰€æœ‰è¿›ç¨‹åˆ—è¡¨
pm2 show myapp              # åº”ç”¨è¯¦ç»†ä¿¡æ¯
pm2 monit                   # å®æ—¶ç›‘æ§ç•Œé¢

# åº”ç”¨ç®¡ç†
pm2 restart myapp           # é‡å¯åº”ç”¨
pm2 stop myapp              # åœæ­¢åº”ç”¨
pm2 delete myapp            # åˆ é™¤åº”ç”¨
pm2 reload myapp            # é›¶åœæœºé‡è½½
```

**ğŸ”¸ PM2é…ç½®æ–‡ä»¶**
```javascript
// ecosystem.config.js
module.exports = {
    apps: [{
        name: 'myapp',
        script: './app.js',
        instances: 2,                    // å¯åŠ¨2ä¸ªå®ä¾‹
        exec_mode: 'cluster',            // é›†ç¾¤æ¨¡å¼
        watch: false,                    // ç”Ÿäº§ç¯å¢ƒä¸è¦å¼€å¯
        max_memory_restart: '1G',        # å†…å­˜è¾¾åˆ°1Gè‡ªåŠ¨é‡å¯
        env: {
            NODE_ENV: 'production',
            PORT: 3000
        },
        error_file: './logs/err.log',
        out_file: './logs/out.log',
        log_file: './logs/combined.log',
        time: true
    }]
};

# ä½¿ç”¨é…ç½®æ–‡ä»¶å¯åŠ¨
pm2 start ecosystem.config.js
```

### 7.2 æ—¥å¿—ç®¡ç†


**ğŸ”¸ æ—¥å¿—é…ç½®**
```bash
# æŸ¥çœ‹æ—¥å¿—
pm2 logs myapp              # å®æ—¶æŸ¥çœ‹æ—¥å¿—
pm2 logs --lines 200        # æŸ¥çœ‹æœ€è¿‘200è¡Œæ—¥å¿—

# æ—¥å¿—æ–‡ä»¶ä½ç½®
~/.pm2/logs/                # PM2é»˜è®¤æ—¥å¿—ç›®å½•
./logs/                     # åº”ç”¨è‡ªå®šä¹‰æ—¥å¿—ç›®å½•
```

**ğŸ”¸ æ—¥å¿—è½®è½¬é…ç½®**
```bash
# å®‰è£…PM2æ—¥å¿—è½®è½¬æ¨¡å—
pm2 install pm2-logrotate

# é…ç½®æ—¥å¿—è½®è½¬
pm2 set pm2-logrotate:max_size 10M        # å•ä¸ªæ–‡ä»¶æœ€å¤§10M
pm2 set pm2-logrotate:retain 7            # ä¿ç•™7ä¸ªå†å²æ–‡ä»¶
pm2 set pm2-logrotate:compress true       # å‹ç¼©å†å²æ–‡ä»¶
```

### 7.3 æ€§èƒ½ç›‘æ§


**ğŸ”¸ ç³»ç»Ÿç›‘æ§å‘½ä»¤**
```bash
# ç³»ç»Ÿèµ„æºç›‘æ§
htop                        # ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
iotop                       # ç£ç›˜IOç›‘æ§
netstat -tulpn              # ç½‘ç»œè¿æ¥çŠ¶æ€
df -h                       # ç£ç›˜ä½¿ç”¨æƒ…å†µ
free -m                     # å†…å­˜ä½¿ç”¨æƒ…å†µ
```

**ğŸ”¸ åº”ç”¨ç›‘æ§æŒ‡æ ‡**
```bash
# PM2ç›‘æ§
pm2 monit                   # å®æ—¶ç›‘æ§é¢æ¿
pm2 web                     # Webç›‘æ§ç•Œé¢(ç«¯å£9615)

# å…³é”®æŒ‡æ ‡ï¼š
- CPUä½¿ç”¨ç‡ï¼š< 80%
- å†…å­˜ä½¿ç”¨ç‡ï¼š< 80%
- å“åº”æ—¶é—´ï¼š< 500ms
- é”™è¯¯ç‡ï¼š< 1%
```

---

## 8. ğŸ”§ æ•…éšœæ’æŸ¥ä¸å¤‡ä»½


### 8.1 å¸¸è§é—®é¢˜æ’æŸ¥


**ğŸ”¸ åº”ç”¨æ— æ³•å¯åŠ¨**
```bash
# æ£€æŸ¥æ­¥éª¤
1. æŸ¥çœ‹PM2çŠ¶æ€
   pm2 list
   
2. æŸ¥çœ‹é”™è¯¯æ—¥å¿—
   pm2 logs myapp --err
   
3. æ£€æŸ¥ç«¯å£å ç”¨
   netstat -tulpn | grep :3000
   
4. æ£€æŸ¥Node.jsè¿›ç¨‹
   ps aux | grep node
   
5. æ‰‹åŠ¨å¯åŠ¨æµ‹è¯•
   node app.js
```

**ğŸ”¸ ç½‘ç«™æ— æ³•è®¿é—®**
```bash
# æ’æŸ¥é¡ºåº
1. æ£€æŸ¥NginxçŠ¶æ€
   sudo systemctl status nginx
   
2. æµ‹è¯•Nginxé…ç½®
   sudo nginx -t
   
3. æ£€æŸ¥é˜²ç«å¢™
   sudo ufw status
   
4. æ£€æŸ¥DNSè§£æ
   nslookup yoursite.com
   
5. æ£€æŸ¥SSLè¯ä¹¦
   openssl s_client -connect yoursite.com:443
```

**ğŸ”¸ æ€§èƒ½é—®é¢˜æ’æŸ¥**
```bash
# æ€§èƒ½åˆ†æ
1. æŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½
   uptime
   
2. åˆ†æå†…å­˜ä½¿ç”¨
   free -m
   cat /proc/meminfo
   
3. æ£€æŸ¥ç£ç›˜IO
   iotop
   iostat
   
4. ç½‘ç»œè¿æ¥åˆ†æ
   ss -tuln
   netstat -i
```

### 8.2 å¤‡ä»½ç­–ç•¥


**ğŸ”¸ æ•°æ®å¤‡ä»½è„šæœ¬**
```bash
#!/bin/bash
# backup.sh - æ•°æ®å¤‡ä»½è„šæœ¬

BACKUP_DIR="/backup/$(date +%Y%m%d)"
APP_DIR="/home/nodeapp/myapp"

# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p $BACKUP_DIR

# 1. å¤‡ä»½åº”ç”¨ä»£ç 
tar -czf $BACKUP_DIR/app-code.tar.gz -C $APP_DIR .

# 2. å¤‡ä»½æ•°æ®åº“ (å¦‚æœä½¿ç”¨MySQL)
mysqldump -u dbuser -p'password' myapp_prod > $BACKUP_DIR/database.sql

# 3. å¤‡ä»½é…ç½®æ–‡ä»¶
cp /etc/nginx/sites-available/myapp $BACKUP_DIR/nginx.conf
cp $APP_DIR/.env $BACKUP_DIR/env.backup

# 4. æ¸…ç†30å¤©å‰çš„å¤‡ä»½
find /backup -type d -mtime +30 -exec rm -rf {} \;

echo "å¤‡ä»½å®Œæˆï¼š$BACKUP_DIR"
```

**ğŸ”¸ è‡ªåŠ¨å¤‡ä»½è®¾ç½®**
```bash
# è®¾ç½®å®šæ—¶å¤‡ä»½
sudo crontab -e

# æ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½
0 2 * * * /home/nodeapp/scripts/backup.sh

# æ¯å‘¨æ—¥å®Œæ•´å¤‡ä»½
0 1 * * 0 /home/nodeapp/scripts/full-backup.sh
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ä¼ ç»Ÿéƒ¨ç½²æœ¬è´¨ï¼šæŠŠåº”ç”¨éƒ¨ç½²åˆ°ç‹¬ç«‹æœåŠ¡å™¨ï¼Œè·å¾—å®Œå…¨æ§åˆ¶æƒ
ğŸ”¸ åå‘ä»£ç†ä½œç”¨ï¼šNginxä½œä¸ºå‰ç«¯ä»£ç†ï¼Œæä¾›å®‰å…¨å’Œæ€§èƒ½ä¼˜åŒ–
ğŸ”¸ è¿›ç¨‹ç®¡ç†é‡è¦æ€§ï¼šPM2ç¡®ä¿åº”ç”¨ç¨³å®šè¿è¡Œå’Œæ•…éšœè‡ªåŠ¨æ¢å¤
ğŸ”¸ SSLè¯ä¹¦å¿…è¦æ€§ï¼šHTTPSæ˜¯ç°ä»£ç½‘ç«™çš„åŸºæœ¬è¦æ±‚
ğŸ”¸ ç›‘æ§ä¸å¤‡ä»½ï¼šé¢„é˜²èƒœäºæ²»ç–—ï¼Œä¸»åŠ¨ç›‘æ§å’Œå®šæœŸå¤‡ä»½
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ éƒ¨ç½²æ¶æ„ç†è§£**
```
å®Œæ•´éƒ¨ç½²æ¶æ„ï¼š
ç”¨æˆ· â†’ CDN â†’ è´Ÿè½½å‡è¡¡ â†’ Nginx â†’ Node.jsåº”ç”¨ â†’ æ•°æ®åº“

æ¯ä¸€å±‚çš„ä½œç”¨ï¼š
- CDNï¼šåŠ é€Ÿé™æ€èµ„æº
- è´Ÿè½½å‡è¡¡ï¼šåˆ†å‘æµé‡
- Nginxï¼šåå‘ä»£ç†ã€SSLç»ˆæ­¢
- Node.jsï¼šä¸šåŠ¡é€»è¾‘å¤„ç†
- æ•°æ®åº“ï¼šæ•°æ®å­˜å‚¨
```

**ğŸ”¹ å®‰å…¨æœ€ä½³å®è·µ**
```
å®‰å…¨æ£€æŸ¥æ¸…å•ï¼š
âœ… ä½¿ç”¨érootç”¨æˆ·è¿è¡Œåº”ç”¨
âœ… é…ç½®é˜²ç«å¢™åªå¼€æ”¾å¿…è¦ç«¯å£
âœ… å®šæœŸæ›´æ–°ç³»ç»Ÿå’Œè½¯ä»¶åŒ…
âœ… ä½¿ç”¨å¼ºå¯†ç å’ŒSSHå¯†é’¥
âœ… å¯ç”¨HTTPSå’Œå®‰å…¨å¤´è®¾ç½®
âœ… å®šæœŸå¤‡ä»½é‡è¦æ•°æ®
âœ… ç›‘æ§å¼‚å¸¸è®¿é—®å’Œé”™è¯¯æ—¥å¿—
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–è¦ç‚¹**
```
ä¼˜åŒ–ç­–ç•¥ï¼š
- é™æ€æ–‡ä»¶ï¼šNginxç›´æ¥æœåŠ¡ï¼Œè®¾ç½®ç¼“å­˜
- åº”ç”¨å±‚ï¼šPM2é›†ç¾¤æ¨¡å¼ï¼Œè´Ÿè½½å‡è¡¡
- æ•°æ®åº“ï¼šè¿æ¥æ± ï¼Œç´¢å¼•ä¼˜åŒ–
- ç›‘æ§ï¼šå®æ—¶ç›‘æ§å…³é”®æŒ‡æ ‡
- ç¼“å­˜ï¼šRedisç¼“å­˜çƒ­ç‚¹æ•°æ®
```

### 9.3 å®é™…éƒ¨ç½²æµç¨‹


**ğŸ“‹ æ ‡å‡†éƒ¨ç½²æ£€æŸ¥æ¸…å•**
```
ğŸ”¸ æœåŠ¡å™¨å‡†å¤‡é˜¶æ®µ
â–¡ é€‰æ‹©åˆé€‚çš„æœåŠ¡å™¨é…ç½®
â–¡ å®‰è£…Node.jsã€PM2ã€Nginxã€Git
â–¡ åˆ›å»ºåº”ç”¨ç”¨æˆ·å’Œç›®å½•
â–¡ é…ç½®åŸºç¡€å®‰å…¨è®¾ç½®

ğŸ”¸ åº”ç”¨éƒ¨ç½²é˜¶æ®µ  
â–¡ å…‹éš†ä»£ç åˆ°æœåŠ¡å™¨
â–¡ å®‰è£…ç”Ÿäº§ç¯å¢ƒä¾èµ–
â–¡ é…ç½®ç¯å¢ƒå˜é‡
â–¡ ä½¿ç”¨PM2å¯åŠ¨åº”ç”¨

ğŸ”¸ Nginxé…ç½®é˜¶æ®µ
â–¡ é…ç½®åå‘ä»£ç†
â–¡ è®¾ç½®é™æ€æ–‡ä»¶æœåŠ¡
â–¡ é…ç½®SSLè¯ä¹¦
â–¡ æµ‹è¯•é…ç½®å¹¶é‡è½½

ğŸ”¸ ç›‘æ§è¿ç»´é˜¶æ®µ
â–¡ è®¾ç½®æ€§èƒ½ç›‘æ§
â–¡ é…ç½®æ—¥å¿—ç®¡ç†
â–¡ å»ºç«‹å¤‡ä»½ç­–ç•¥
â–¡ ç¼–å†™éƒ¨ç½²è„šæœ¬
```

### 9.4 å¸¸è§éƒ¨ç½²é—®é¢˜


**â“ æ–°æ‰‹å¸¸è§é”™è¯¯**
```
æƒé™é—®é¢˜ï¼š
- ä½¿ç”¨rootç”¨æˆ·è¿è¡Œåº”ç”¨ âŒ
- æ­£ç¡®åšæ³•ï¼šåˆ›å»ºä¸“ç”¨ç”¨æˆ· âœ…

ç«¯å£å†²çªï¼š
- å¤šä¸ªåº”ç”¨ä½¿ç”¨ç›¸åŒç«¯å£ âŒ  
- æ­£ç¡®åšæ³•ï¼šä¸ºæ¯ä¸ªåº”ç”¨åˆ†é…ä¸åŒç«¯å£ âœ…

é…ç½®é”™è¯¯ï¼š
- ç›´æ¥åœ¨ç”Ÿäº§ç¯å¢ƒè°ƒè¯• âŒ
- æ­£ç¡®åšæ³•ï¼šå…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ âœ…

å¤‡ä»½ç¼ºå¤±ï¼š
- ä¸åšä»»ä½•å¤‡ä»½ âŒ
- æ­£ç¡®åšæ³•ï¼šå®šæœŸè‡ªåŠ¨å¤‡ä»½ âœ…
```

### 9.5 è¿›é˜¶å­¦ä¹ å»ºè®®


**ğŸš€ ä¸‹ä¸€æ­¥å­¦ä¹ æ–¹å‘**
```
å®¹å™¨åŒ–éƒ¨ç½²ï¼š
- Dockerå®¹å™¨åŒ–
- Docker Composeç¼–æ’
- Kubernetesé›†ç¾¤ç®¡ç†

CI/CDè‡ªåŠ¨åŒ–ï¼š
- GitLab CI/CD
- GitHub Actions
- Jenkinsè‡ªåŠ¨åŒ–éƒ¨ç½²

é«˜å¯ç”¨æ¶æ„ï¼š
- å¤šæœåŠ¡å™¨è´Ÿè½½å‡è¡¡
- æ•°æ®åº“ä¸»ä»å¤åˆ¶
- Redisé›†ç¾¤é…ç½®
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- ä¼ ç»Ÿéƒ¨ç½²é‡åœ¨æ§åˆ¶å’Œç¨³å®šï¼Œéœ€è¦æ‰å®çš„LinuxåŸºç¡€
- Nginxåå‘ä»£ç†æ˜¯webåº”ç”¨éƒ¨ç½²çš„æ ‡å‡†é…ç½®
- PM2è¿›ç¨‹ç®¡ç†ç¡®ä¿åº”ç”¨é«˜å¯ç”¨æ€§
- å®‰å…¨ã€ç›‘æ§ã€å¤‡ä»½æ˜¯ç”Ÿäº§ç¯å¢ƒçš„ä¸‰å¤§æ”¯æŸ±
- è‡ªåŠ¨åŒ–è„šæœ¬èƒ½å¤§å¤§æå‡éƒ¨ç½²æ•ˆç‡å’Œå‡å°‘äººä¸ºé”™è¯¯