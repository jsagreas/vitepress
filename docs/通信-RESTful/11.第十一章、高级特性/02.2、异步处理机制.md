---
title: 2ã€å¼‚æ­¥å¤„ç†æœºåˆ¶
---
## ğŸ“š ç›®å½•

1. [å¼‚æ­¥å¤„ç†åŸºæœ¬æ¦‚å¿µ](#1-å¼‚æ­¥å¤„ç†åŸºæœ¬æ¦‚å¿µ)
2. [å¼‚æ­¥ä»»åŠ¡RESTfulè®¾è®¡](#2-å¼‚æ­¥ä»»åŠ¡RESTfulè®¾è®¡)
3. [ä»»åŠ¡çŠ¶æ€ç®¡ç†æœºåˆ¶](#3-ä»»åŠ¡çŠ¶æ€ç®¡ç†æœºåˆ¶)
4. [é•¿æ—¶é—´è¿è¡Œä»»åŠ¡å¤„ç†](#4-é•¿æ—¶é—´è¿è¡Œä»»åŠ¡å¤„ç†)
5. [WebHookå›è°ƒæœºåˆ¶](#5-WebHookå›è°ƒæœºåˆ¶)
6. [ä»»åŠ¡é˜Ÿåˆ—é›†æˆ](#6-ä»»åŠ¡é˜Ÿåˆ—é›†æˆ)
7. [å¼‚æ­¥ç»“æœé€šçŸ¥](#7-å¼‚æ­¥ç»“æœé€šçŸ¥)
8. [å®é™…åº”ç”¨åœºæ™¯](#8-å®é™…åº”ç”¨åœºæ™¯)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ å¼‚æ­¥å¤„ç†åŸºæœ¬æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯å¼‚æ­¥å¤„ç†


**ç®€å•ç†è§£**ï¼šå°±åƒä½ å»é“¶è¡ŒåŠäº‹ï¼Œå¦‚æœä¸šåŠ¡å¤æ‚éœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œé“¶è¡Œä¸ä¼šè®©ä½ åœ¨æŸœå°ä¸€ç›´ç­‰ç€ï¼Œè€Œæ˜¯ç»™ä½ ä¸€ä¸ªå·ç ï¼Œä½ å¯ä»¥å»åšåˆ«çš„äº‹ï¼Œå¤„ç†å®Œäº†å†æ¥å–ç»“æœã€‚

```
åŒæ­¥å¤„ç†ï¼ˆä¼ ç»Ÿæ–¹å¼ï¼‰ï¼š
å®¢æˆ·ç«¯ â”€â”€â†’ æœåŠ¡å™¨ â”€â”€â†’ æ•°æ®åº“å¤„ç†ï¼ˆ5åˆ†é’Ÿï¼‰â”€â”€â†’ è¿”å›ç»“æœ
        â†‘                                    â†“
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ä¸€ç›´ç­‰å¾… â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¼‚æ­¥å¤„ç†ï¼ˆç°ä»£æ–¹å¼ï¼‰ï¼š
å®¢æˆ·ç«¯ â”€â”€â†’ æœåŠ¡å™¨ â”€â”€â†’ ç«‹å³è¿”å›ä»»åŠ¡ID
        â†‘              â†“
        â””â”€ æŸ¥è¯¢ç»“æœ â†â”€ åå°æ…¢æ…¢å¤„ç†
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥å¤„ç†


**æ ¸å¿ƒé—®é¢˜**ï¼šæœ‰äº›æ“ä½œç‰¹åˆ«è€—æ—¶ï¼Œä¸èƒ½è®©ç”¨æˆ·å‚»ç­‰

```
å¸¸è§è€—æ—¶æ“ä½œï¼š
ğŸ“Š æ•°æ®æŠ¥è¡¨ç”Ÿæˆ     â†’ å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶
ğŸ“§ æ‰¹é‡é‚®ä»¶å‘é€     â†’ å‘é€ä¸‡å°é‚®ä»¶éœ€è¦å¾ˆé•¿æ—¶é—´
ğŸ¬ è§†é¢‘æ–‡ä»¶è½¬ç      â†’ å¤§æ–‡ä»¶å¤„ç†éå¸¸è€—æ—¶
ğŸ“ æ–‡ä»¶æ‰¹é‡ä¸Šä¼      â†’ ä¸Šä¼ å‡ GBæ–‡ä»¶è¦ç­‰å¾ˆä¹…
ğŸ’¾ æ•°æ®åº“å¤§æ‰¹é‡æ“ä½œ â†’ å¤„ç†ç™¾ä¸‡æ¡æ•°æ®å¾ˆæ…¢
```

**å¼‚æ­¥å¤„ç†çš„å¥½å¤„**ï¼š
- âœ… **ç”¨æˆ·ä½“éªŒå¥½**ï¼šä¸ä¼šè®©é¡µé¢å¡æ­»
- âœ… **æœåŠ¡å™¨æ•ˆç‡é«˜**ï¼šå¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡
- âœ… **èµ„æºåˆ©ç”¨åˆç†**ï¼šé¿å…è¿æ¥é•¿æ—¶é—´å ç”¨

### 1.3 å¼‚æ­¥å¤„ç†çš„åŸºæœ¬æµç¨‹


```
ç¬¬1æ­¥ï¼šæäº¤ä»»åŠ¡
å®¢æˆ·ç«¯ï¼šæˆ‘è¦ç”Ÿæˆä¸€ä¸ªæ•°æ®æŠ¥è¡¨
æœåŠ¡å™¨ï¼šå¥½çš„ï¼Œä»»åŠ¡å·²æ¥æ”¶ï¼Œä»»åŠ¡IDæ˜¯ task_12345

ç¬¬2æ­¥ï¼šä»»åŠ¡å¤„ç†
æœåŠ¡å™¨ï¼šåœ¨åå°æ…¢æ…¢å¤„ç†ä½ çš„æŠ¥è¡¨
å®¢æˆ·ç«¯ï¼šå¯ä»¥å»åšåˆ«çš„äº‹æƒ…

ç¬¬3æ­¥ï¼šæŸ¥è¯¢è¿›åº¦
å®¢æˆ·ç«¯ï¼štask_12345 å¤„ç†å¾—æ€ä¹ˆæ ·äº†ï¼Ÿ
æœåŠ¡å™¨ï¼šå·²å®Œæˆ30%ï¼Œé¢„è®¡è¿˜éœ€è¦5åˆ†é’Ÿ

ç¬¬4æ­¥ï¼šè·å–ç»“æœ
å®¢æˆ·ç«¯ï¼štask_12345 å®Œæˆäº†å—ï¼Ÿ
æœåŠ¡å™¨ï¼šå®Œæˆäº†ï¼è¿™æ˜¯ä½ çš„æŠ¥è¡¨ä¸‹è½½é“¾æ¥
```

---

## 2. ğŸ”§ å¼‚æ­¥ä»»åŠ¡RESTfulè®¾è®¡


### 2.1 ä»»åŠ¡èµ„æºçš„URLè®¾è®¡


**æŠŠä»»åŠ¡å½“ä½œä¸€ç§èµ„æºæ¥ç®¡ç†**

```http
åŸºç¡€ä»»åŠ¡æ“ä½œï¼š
POST   /api/tasks              â†’ åˆ›å»ºæ–°ä»»åŠ¡
GET    /api/tasks/{taskId}     â†’ æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
GET    /api/tasks             â†’ è·å–ä»»åŠ¡åˆ—è¡¨
DELETE /api/tasks/{taskId}     â†’ å–æ¶ˆä»»åŠ¡

å…·ä½“ä¸šåŠ¡ä»»åŠ¡ï¼š
POST   /api/reports/generate   â†’ ç”ŸæˆæŠ¥è¡¨ä»»åŠ¡
POST   /api/emails/send-batch  â†’ æ‰¹é‡å‘é€é‚®ä»¶ä»»åŠ¡
POST   /api/files/upload       â†’ æ–‡ä»¶ä¸Šä¼ ä»»åŠ¡
```

### 2.2 åˆ›å»ºå¼‚æ­¥ä»»åŠ¡çš„APIè®¾è®¡


**åˆ›å»ºä»»åŠ¡çš„æ ‡å‡†æµç¨‹**

```http
POST /api/reports/generate
Content-Type: application/json

{
  "reportType": "sales",
  "dateRange": {
    "start": "2024-01-01",
    "end": "2024-12-31"
  },
  "format": "pdf"
}
```

**æœåŠ¡å™¨ç«‹å³è¿”å›ä»»åŠ¡ä¿¡æ¯**

```http
HTTP/1.1 202 Accepted
Content-Type: application/json

{
  "taskId": "task_12345",
  "status": "pending",
  "message": "æŠ¥è¡¨ç”Ÿæˆä»»åŠ¡å·²åˆ›å»º",
  "estimatedTime": 300,
  "statusUrl": "/api/tasks/task_12345",
  "createdAt": "2024-08-06T10:30:00Z"
}
```

> ğŸ’¡ **å…³é”®ç‚¹**ï¼šè¿”å›çŠ¶æ€ç  `202 Accepted` è¡¨ç¤º"å·²æ¥å—ä½†æœªå¤„ç†å®Œæˆ"

### 2.3 ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢APIè®¾è®¡


**æŸ¥è¯¢ä»»åŠ¡å½“å‰çŠ¶æ€**

```http
GET /api/tasks/task_12345
```

**ä¸åŒé˜¶æ®µçš„å“åº”ç¤ºä¾‹**

```http
# ä»»åŠ¡æ’é˜Ÿä¸­
{
  "taskId": "task_12345",
  "status": "pending",
  "message": "ä»»åŠ¡åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…å¤„ç†",
  "queuePosition": 3
}

# ä»»åŠ¡å¤„ç†ä¸­
{
  "taskId": "task_12345", 
  "status": "running",
  "progress": 45,
  "message": "æ­£åœ¨ç”ŸæˆæŠ¥è¡¨ï¼Œå·²å®Œæˆ45%",
  "estimatedRemaining": 180
}

# ä»»åŠ¡å®Œæˆ
{
  "taskId": "task_12345",
  "status": "completed", 
  "result": {
    "downloadUrl": "/api/files/report_12345.pdf",
    "fileSize": 2048576
  },
  "completedAt": "2024-08-06T10:35:30Z"
}
```

---

## 3. ğŸ“Š ä»»åŠ¡çŠ¶æ€ç®¡ç†æœºåˆ¶


### 3.1 æ ‡å‡†ä»»åŠ¡çŠ¶æ€å®šä¹‰


**ä»»åŠ¡çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€**

```
ä»»åŠ¡çŠ¶æ€æµè½¬å›¾ï¼š
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   pending   â”‚ â† åˆšåˆ›å»ºï¼Œç­‰å¾…å¤„ç†
                    â”‚  (ç­‰å¾…ä¸­)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
              â”Œâ”€â”€â”€â”€â†’â”‚   running   â”‚ â† æ­£åœ¨å¤„ç†ä¸­
              â”‚     â”‚  (å¤„ç†ä¸­)    â”‚
              â”‚     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
              â”‚            â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚ cancelled â”‚   â”‚  completed  â”‚ â† å¤„ç†å®Œæˆ
    â”‚ (å·²å–æ¶ˆ)   â”‚   â”‚  (å·²å®Œæˆ)    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                    â”‚   failed    â”‚ â† å¤„ç†å¤±è´¥
                    â”‚  (å¤±è´¥)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 çŠ¶æ€è¯¦ç»†è¯´æ˜


| çŠ¶æ€ | å«ä¹‰ | è¯´æ˜ | ç”¨æˆ·å¯åšä»€ä¹ˆ |
|------|------|------|-------------|
| `pending` | **ç­‰å¾…ä¸­** | ä»»åŠ¡å·²åˆ›å»ºï¼Œåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…å¤„ç† | å¯ä»¥å–æ¶ˆä»»åŠ¡ |
| `running` | **å¤„ç†ä¸­** | ä»»åŠ¡æ­£åœ¨æ‰§è¡Œï¼Œå¯èƒ½æœ‰è¿›åº¦ä¿¡æ¯ | æŸ¥çœ‹è¿›åº¦ï¼Œå¯ä»¥å–æ¶ˆ |
| `completed` | **å·²å®Œæˆ** | ä»»åŠ¡æˆåŠŸå®Œæˆï¼Œç»“æœå¯ç”¨ | ä¸‹è½½ç»“æœæ–‡ä»¶ |
| `failed` | **å¤±è´¥** | ä»»åŠ¡æ‰§è¡Œå‡ºé”™ï¼Œæœ‰é”™è¯¯ä¿¡æ¯ | æŸ¥çœ‹é”™è¯¯åŸå› ï¼Œé‡æ–°æäº¤ |
| `cancelled` | **å·²å–æ¶ˆ** | ç”¨æˆ·ä¸»åŠ¨å–æ¶ˆäº†ä»»åŠ¡ | å¯ä»¥é‡æ–°æäº¤æ–°ä»»åŠ¡ |

### 3.3 çŠ¶æ€å˜æ›´çš„RESTfulæ“ä½œ


**å–æ¶ˆæ­£åœ¨è¿è¡Œçš„ä»»åŠ¡**

```http
DELETE /api/tasks/task_12345

# å“åº”
{
  "taskId": "task_12345",
  "status": "cancelled",
  "message": "ä»»åŠ¡å·²æˆåŠŸå–æ¶ˆ"
}
```

**é‡å¯å¤±è´¥çš„ä»»åŠ¡**

```http
POST /api/tasks/task_12345/retry

# å“åº”  
{
  "taskId": "task_67890",
  "status": "pending", 
  "message": "ä»»åŠ¡å·²é‡æ–°æäº¤",
  "originalTaskId": "task_12345"
}
```

---

## 4. â±ï¸ é•¿æ—¶é—´è¿è¡Œä»»åŠ¡å¤„ç†


### 4.1 è¿›åº¦è·Ÿè¸ªæœºåˆ¶


**ä¸ºä»€ä¹ˆéœ€è¦è¿›åº¦è·Ÿè¸ª**ï¼šç”¨æˆ·éœ€è¦çŸ¥é“ä»»åŠ¡è¿›è¡Œåˆ°å“ªä¸€æ­¥äº†ï¼Œè¿˜è¦ç­‰å¤šä¹…

```http
GET /api/tasks/task_12345

{
  "taskId": "task_12345",
  "status": "running",
  "progress": {
    "percentage": 65,           // å®Œæˆç™¾åˆ†æ¯”
    "currentStep": "æ•°æ®å¤„ç†",   // å½“å‰æ‰§è¡Œæ­¥éª¤
    "totalSteps": 5,           // æ€»æ­¥éª¤æ•°
    "completedSteps": 3,       // å·²å®Œæˆæ­¥éª¤
    "estimatedRemaining": 120   // é¢„è®¡å‰©ä½™ç§’æ•°
  },
  "details": {
    "processedRecords": 65000,  // å·²å¤„ç†è®°å½•æ•°
    "totalRecords": 100000,     // æ€»è®°å½•æ•°
    "startedAt": "2024-08-06T10:30:00Z"
  }
}
```

### 4.2 ä»»åŠ¡åˆ†é˜¶æ®µå¤„ç†


**æŠŠå¤æ‚ä»»åŠ¡åˆ†è§£æˆå¤šä¸ªé˜¶æ®µ**

```
æŠ¥è¡¨ç”Ÿæˆä»»åŠ¡çš„é˜¶æ®µï¼š
â”Œâ”€ ç¬¬1é˜¶æ®µ â”€â” â”Œâ”€ ç¬¬2é˜¶æ®µ â”€â” â”Œâ”€ ç¬¬3é˜¶æ®µ â”€â” â”Œâ”€ ç¬¬4é˜¶æ®µ â”€â”
â”‚ æ•°æ®æŸ¥è¯¢  â”‚â†’â”‚ æ•°æ®è®¡ç®—  â”‚â†’â”‚ å›¾è¡¨ç”Ÿæˆ  â”‚â†’â”‚ PDFå¯¼å‡º  â”‚
â”‚ (20%)   â”‚ â”‚ (40%)   â”‚ â”‚ (25%)   â”‚ â”‚ (15%)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é˜¶æ®µè¿›åº¦çš„APIå“åº”**

```json
{
  "status": "running",
  "currentStage": "æ•°æ®è®¡ç®—",
  "stages": [
    {"name": "æ•°æ®æŸ¥è¯¢", "status": "completed", "progress": 100},
    {"name": "æ•°æ®è®¡ç®—", "status": "running", "progress": 60},
    {"name": "å›¾è¡¨ç”Ÿæˆ", "status": "pending", "progress": 0},
    {"name": "PDFå¯¼å‡º", "status": "pending", "progress": 0}
  ]
}
```

### 4.3 ä»»åŠ¡è¶…æ—¶å¤„ç†


**è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´**

```http
POST /api/reports/generate
{
  "reportType": "sales",
  "timeout": 1800  // 30åˆ†é’Ÿè¶…æ—¶
}

# å¦‚æœè¶…æ—¶ï¼Œä»»åŠ¡çŠ¶æ€å˜ä¸ºfailed
{
  "taskId": "task_12345",
  "status": "failed",
  "error": {
    "code": "TIMEOUT",
    "message": "ä»»åŠ¡æ‰§è¡Œæ—¶é—´è¶…è¿‡30åˆ†é’Ÿï¼Œå·²è‡ªåŠ¨ç»ˆæ­¢"
  }
}
```

---

## 5. ğŸ”” WebHookå›è°ƒæœºåˆ¶


### 5.1 ä»€ä¹ˆæ˜¯WebHook


**ç®€å•ç†è§£**ï¼šå°±åƒä½ åœ¨ç½‘ä¸Šè´­ç‰©ï¼Œå¿«é€’åˆ°äº†å¿«é€’å‘˜ä¼šä¸»åŠ¨ç»™ä½ æ‰“ç”µè¯ï¼Œè€Œä¸æ˜¯ä½ ä¸€ç›´æ‰“ç”µè¯é—®å¿«é€’åˆ°äº†æ²¡æœ‰ã€‚

```
ä¼ ç»Ÿæ–¹å¼ï¼ˆè½®è¯¢ï¼‰ï¼š
å®¢æˆ·ç«¯ï¼šä»»åŠ¡å®Œæˆäº†å—ï¼Ÿ  â†’ æœåŠ¡å™¨ï¼šè¿˜æ²¡æœ‰
(è¿‡1åˆ†é’Ÿ)
å®¢æˆ·ç«¯ï¼šä»»åŠ¡å®Œæˆäº†å—ï¼Ÿ  â†’ æœåŠ¡å™¨ï¼šè¿˜æ²¡æœ‰
(è¿‡1åˆ†é’Ÿ)  
å®¢æˆ·ç«¯ï¼šä»»åŠ¡å®Œæˆäº†å—ï¼Ÿ  â†’ æœåŠ¡å™¨ï¼šå®Œæˆäº†ï¼

WebHookæ–¹å¼ï¼ˆæ¨é€ï¼‰ï¼š
å®¢æˆ·ç«¯ï¼šä»»åŠ¡å®Œæˆäº†è¯·é€šçŸ¥æˆ‘  â†’ æœåŠ¡å™¨ï¼šå¥½çš„
(ä»»åŠ¡åœ¨åå°å¤„ç†...)
æœåŠ¡å™¨ï¼šä»»åŠ¡å®Œæˆäº†ï¼      â†’ å®¢æˆ·ç«¯ï¼šæ”¶åˆ°é€šçŸ¥
```

### 5.2 WebHooké…ç½®


**åˆ›å»ºä»»åŠ¡æ—¶æŒ‡å®šå›è°ƒåœ°å€**

```http
POST /api/reports/generate
{
  "reportType": "sales",
  "webhook": {
    "url": "https://yourapp.com/api/webhooks/task-completed",
    "events": ["completed", "failed"],
    "secret": "your-secret-key"
  }
}
```

### 5.3 WebHookå›è°ƒå†…å®¹


**ä»»åŠ¡å®Œæˆæ—¶çš„å›è°ƒè¯·æ±‚**

```http
POST https://yourapp.com/api/webhooks/task-completed
Content-Type: application/json
X-Webhook-Signature: sha256=abc123...

{
  "event": "task.completed",
  "taskId": "task_12345",
  "status": "completed",
  "timestamp": "2024-08-06T10:35:30Z",
  "result": {
    "downloadUrl": "/api/files/report_12345.pdf",
    "fileSize": 2048576
  }
}
```

**ä»»åŠ¡å¤±è´¥æ—¶çš„å›è°ƒè¯·æ±‚**

```http
{
  "event": "task.failed",
  "taskId": "task_12345", 
  "status": "failed",
  "timestamp": "2024-08-06T10:45:00Z",
  "error": {
    "code": "DATA_ERROR",
    "message": "æ•°æ®æºè¿æ¥å¤±è´¥"
  }
}
```

### 5.4 WebHookå®‰å…¨éªŒè¯


**éªŒè¯å›è°ƒè¯·æ±‚çš„çœŸå®æ€§**

```javascript
// æœåŠ¡å™¨ç«¯ç”Ÿæˆç­¾å
const crypto = require('crypto');
const signature = crypto
  .createHmac('sha256', 'your-secret-key')
  .update(JSON.stringify(webhookData))
  .digest('hex');

// å®¢æˆ·ç«¯éªŒè¯ç­¾å
const receivedSignature = request.headers['x-webhook-signature'];
if (signature !== receivedSignature) {
  // è¯·æ±‚ä¸æ˜¯æ¥è‡ªå¯ä¿¡æœåŠ¡å™¨
  return res.status(401).send('Unauthorized');
}
```

---

## 6. ğŸš€ ä»»åŠ¡é˜Ÿåˆ—é›†æˆ


### 6.1 ä»€ä¹ˆæ˜¯ä»»åŠ¡é˜Ÿåˆ—


**ç®€å•ç†è§£**ï¼šå°±åƒé“¶è¡Œçš„æ’é˜Ÿç³»ç»Ÿï¼Œä»»åŠ¡æŒ‰é¡ºåºæ’é˜Ÿç­‰å¾…å¤„ç†ï¼Œæœ‰å¤šä¸ªæŸœå°ï¼ˆå·¥ä½œçº¿ç¨‹ï¼‰åŒæ—¶æœåŠ¡ã€‚

```
ä»»åŠ¡é˜Ÿåˆ—ç¤ºæ„å›¾ï¼š
                  
ä»»åŠ¡æäº¤ â†’ [é˜Ÿåˆ—] â†’ [å·¥ä½œè€…1] â†’ å¤„ç†å®Œæˆ
             â†“   â†’ [å·¥ä½œè€…2] â†’ å¤„ç†å®Œæˆ  
             â†“   â†’ [å·¥ä½œè€…3] â†’ å¤„ç†å®Œæˆ
           æ›´å¤šä»»åŠ¡...
```

### 6.2 å¸¸ç”¨æ¶ˆæ¯ä¸­é—´ä»¶


**é€‰æ‹©åˆé€‚çš„é˜Ÿåˆ—ç³»ç»Ÿ**

| æŠ€æœ¯ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| **Redis** | è½»é‡çº§ï¼Œæ˜“éƒ¨ç½² | ç®€å•ä»»åŠ¡é˜Ÿåˆ—ï¼Œå°åˆ°ä¸­ç­‰è§„æ¨¡ |
| **RabbitMQ** | åŠŸèƒ½ä¸°å¯Œï¼Œå¯é æ€§é«˜ | ä¼ä¸šçº§åº”ç”¨ï¼Œå¤æ‚è·¯ç”±éœ€æ±‚ |
| **Apache Kafka** | é«˜ååé‡ï¼Œåˆ†å¸ƒå¼ | å¤§æ•°æ®å¤„ç†ï¼Œå®æ—¶æµå¤„ç† |

### 6.3 é˜Ÿåˆ—é›†æˆçš„APIè®¾è®¡


**ä»»åŠ¡ä¼˜å…ˆçº§æ”¯æŒ**

```http
POST /api/reports/generate
{
  "reportType": "sales",
  "priority": "high",     // high, normal, low
  "maxRetries": 3,        // æœ€å¤§é‡è¯•æ¬¡æ•°
  "retryDelay": 60        // é‡è¯•é—´éš”(ç§’)
}
```

**é˜Ÿåˆ—çŠ¶æ€æŸ¥è¯¢**

```http
GET /api/queue/status

{
  "queueStats": {
    "pending": 45,          // ç­‰å¾…å¤„ç†çš„ä»»åŠ¡æ•°
    "running": 8,           // æ­£åœ¨å¤„ç†çš„ä»»åŠ¡æ•°
    "completed": 1203,      // å·²å®Œæˆçš„ä»»åŠ¡æ•°
    "failed": 12            // å¤±è´¥çš„ä»»åŠ¡æ•°
  },
  "workers": {
    "active": 8,            // æ´»è·ƒå·¥ä½œè€…æ•°é‡
    "total": 10             // æ€»å·¥ä½œè€…æ•°é‡
  }
}
```

### 6.4 ä»»åŠ¡é‡è¯•æœºåˆ¶


**æ™ºèƒ½é‡è¯•ç­–ç•¥**

```json
{
  "taskId": "task_12345",
  "status": "failed",
  "retryInfo": {
    "attempt": 2,           // å½“å‰é‡è¯•æ¬¡æ•°
    "maxRetries": 3,        // æœ€å¤§é‡è¯•æ¬¡æ•°
    "nextRetryAt": "2024-08-06T11:00:00Z",
    "backoffStrategy": "exponential"  // é€€é¿ç­–ç•¥
  },
  "error": {
    "code": "NETWORK_ERROR",
    "message": "ç½‘ç»œè¿æ¥è¶…æ—¶",
    "isRetryable": true     // æ˜¯å¦å¯é‡è¯•
  }
}
```

---

## 7. ğŸ“¢ å¼‚æ­¥ç»“æœé€šçŸ¥


### 7.1 é€šçŸ¥æ–¹å¼å¯¹æ¯”


**å¤šç§é€šçŸ¥æ–¹å¼çš„ç‰¹ç‚¹**

| æ–¹å¼ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|----------|
| **è½®è¯¢** | ç®€å•å¯é  | æµªè´¹èµ„æºï¼Œå»¶è¿Ÿé«˜ | ç®€å•åº”ç”¨ï¼Œä»»åŠ¡å°‘ |
| **WebHook** | å®æ—¶æ€§å¥½ï¼Œæ•ˆç‡é«˜ | éœ€è¦å…¬ç½‘åœ°å€ | æœåŠ¡å™¨é—´é€šä¿¡ |
| **WebSocket** | åŒå‘å®æ—¶é€šä¿¡ | è¿æ¥ç®¡ç†å¤æ‚ | æµè§ˆå™¨å®æ—¶æ›´æ–° |
| **Server-Sent Events** | å•å‘æ¨é€ï¼Œç®€å• | åªèƒ½æœåŠ¡å™¨æ¨é€ | çŠ¶æ€æ›´æ–°æ¨é€ |

### 7.2 è½®è¯¢æœºåˆ¶ä¼˜åŒ–


**æ™ºèƒ½è½®è¯¢ç­–ç•¥**

```javascript
// å®¢æˆ·ç«¯æ™ºèƒ½è½®è¯¢å®ç°
class TaskPoller {
  constructor(taskId) {
    this.taskId = taskId;
    this.interval = 1000;  // åˆå§‹1ç§’è½®è¯¢ä¸€æ¬¡
    this.maxInterval = 30000;  // æœ€å¤§30ç§’è½®è¯¢ä¸€æ¬¡
  }
  
  async poll() {
    const response = await fetch(`/api/tasks/${this.taskId}`);
    const task = await response.json();
    
    if (task.status === 'completed' || task.status === 'failed') {
      return task;  // å®Œæˆï¼Œåœæ­¢è½®è¯¢
    }
    
    // åŠ¨æ€è°ƒæ•´è½®è¯¢é—´éš”
    this.interval = Math.min(this.interval * 1.5, this.maxInterval);
    setTimeout(() => this.poll(), this.interval);
  }
}
```

### 7.3 Server-Sent Eventsæ¨é€


**å®æ—¶æ¨é€ä»»åŠ¡çŠ¶æ€æ›´æ–°**

```javascript
// æœåŠ¡å™¨ç«¯ SSE å®ç°
app.get('/api/tasks/:taskId/events', (req, res) => {
  res.writeHead(200, {
    'Content-Type': 'text/event-stream',
    'Cache-Control': 'no-cache',
    'Connection': 'keep-alive'
  });
  
  // å‘é€ä»»åŠ¡çŠ¶æ€æ›´æ–°
  const sendUpdate = (task) => {
    res.write(`data: ${JSON.stringify(task)}\n\n`);
  };
  
  // ç›‘å¬ä»»åŠ¡çŠ¶æ€å˜åŒ–
  taskManager.on(`task:${req.params.taskId}`, sendUpdate);
});

// å®¢æˆ·ç«¯æ¥æ”¶æ›´æ–°
const eventSource = new EventSource('/api/tasks/task_12345/events');
eventSource.onmessage = (event) => {
  const task = JSON.parse(event.data);
  updateUI(task);
};
```

### 7.4 é‚®ä»¶å’ŒçŸ­ä¿¡é€šçŸ¥


**é‡è¦ä»»åŠ¡å®Œæˆé€šçŸ¥**

```http
POST /api/reports/generate
{
  "reportType": "sales",
  "notifications": {
    "email": "user@example.com",
    "sms": "+86138****1234",
    "conditions": ["completed", "failed"]
  }
}
```

**é€šçŸ¥æ¨¡æ¿é…ç½®**

```json
{
  "templates": {
    "email": {
      "completed": "æ‚¨çš„{{reportType}}æŠ¥è¡¨å·²ç”Ÿæˆå®Œæˆï¼Œè¯·ç‚¹å‡»ä¸‹è½½ï¼š{{downloadUrl}}",
      "failed": "å¾ˆæŠ±æ­‰ï¼Œæ‚¨çš„{{reportType}}æŠ¥è¡¨ç”Ÿæˆå¤±è´¥ï¼š{{errorMessage}}"
    },
    "sms": {
      "completed": "æŠ¥è¡¨ç”Ÿæˆå®Œæˆï¼Œè¯·ç™»å½•ç³»ç»ŸæŸ¥çœ‹",
      "failed": "æŠ¥è¡¨ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡æ–°æäº¤"
    }
  }
}
```

---

## 8. ğŸ¯ å®é™…åº”ç”¨åœºæ™¯


### 8.1 æ•°æ®æŠ¥è¡¨ç”Ÿæˆç³»ç»Ÿ


**åœºæ™¯æè¿°**ï¼šä¼ä¸šéœ€è¦ç”Ÿæˆå¤§é‡æ•°æ®æŠ¥è¡¨ï¼Œå¤„ç†æ—¶é—´ä»å‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶ä¸ç­‰

```http
# 1. æäº¤æŠ¥è¡¨ç”Ÿæˆä»»åŠ¡
POST /api/reports/generate
{
  "type": "annual_sales",
  "filters": {
    "year": 2024,
    "departments": ["sales", "marketing"]
  },
  "format": "pdf",
  "webhook": "https://company.com/webhooks/report-ready"
}

# 2. ç«‹å³è¿”å›ä»»åŠ¡ID
{
  "taskId": "report_2024_001",
  "status": "pending",
  "estimatedTime": 1800,
  "statusUrl": "/api/tasks/report_2024_001"
}

# 3. æŸ¥è¯¢å¤„ç†è¿›åº¦
GET /api/tasks/report_2024_001
{
  "status": "running", 
  "progress": 45,
  "currentStep": "æ±‡æ€»é”€å”®æ•°æ®"
}

# 4. ä»»åŠ¡å®Œæˆé€šçŸ¥
WebHook: POST https://company.com/webhooks/report-ready
{
  "taskId": "report_2024_001",
  "status": "completed",
  "downloadUrl": "/api/files/annual_sales_2024.pdf"
}
```

### 8.2 è§†é¢‘å¤„ç†æœåŠ¡


**åœºæ™¯æè¿°**ï¼šç”¨æˆ·ä¸Šä¼ è§†é¢‘éœ€è¦è½¬ç æˆå¤šç§æ ¼å¼å’Œåˆ†è¾¨ç‡

```http
# 1. æäº¤è§†é¢‘å¤„ç†ä»»åŠ¡
POST /api/videos/process
{
  "videoId": "video123",
  "operations": [
    {"type": "transcode", "format": "mp4", "quality": "1080p"},
    {"type": "thumbnail", "count": 10},
    {"type": "compress", "size": "50%"}
  ]
}

# 2. å¤„ç†è¿›åº¦è¿½è¸ª
{
  "status": "running",
  "operations": [
    {"type": "transcode", "status": "completed", "outputUrl": "/files/video123_1080p.mp4"},
    {"type": "thumbnail", "status": "running", "progress": 60},
    {"type": "compress", "status": "pending"}
  ]
}
```

### 8.3 æ‰¹é‡æ•°æ®å¯¼å…¥


**åœºæ™¯æè¿°**ï¼šå¯¼å…¥å¤§é‡Excelæ•°æ®åˆ°æ•°æ®åº“ï¼Œéœ€è¦éªŒè¯å’Œå¤„ç†

```http
# 1. æäº¤å¯¼å…¥ä»»åŠ¡
POST /api/data/import
{
  "fileUrl": "/uploads/customer_data.xlsx",
  "table": "customers",
  "options": {
    "skipErrors": false,
    "validateEmail": true
  }
}

# 2. å¯¼å…¥è¿›åº¦ä¿¡æ¯
{
  "status": "running",
  "progress": {
    "totalRows": 100000,
    "processedRows": 35000, 
    "validRows": 34500,
    "errorRows": 500
  },
  "errors": [
    {"row": 105, "message": "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®"},
    {"row": 230, "message": "å¿…å¡«å­—æ®µä¸ºç©º"}
  ]
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å¼‚æ­¥å¤„ç†æœ¬è´¨ï¼šæŠŠè€—æ—¶æ“ä½œæ”¾åˆ°åå°ï¼Œç«‹å³è¿”å›ä»»åŠ¡æ ‡è¯†
ğŸ”¸ ä»»åŠ¡çŠ¶æ€ç®¡ç†ï¼špending â†’ running â†’ completed/failed
ğŸ”¸ RESTfulè®¾è®¡ï¼šä»»åŠ¡ä½œä¸ºèµ„æºï¼Œæ”¯æŒCRUDæ“ä½œ
ğŸ”¸ é€šçŸ¥æœºåˆ¶ï¼šè½®è¯¢ã€WebHookã€SSEç­‰å¤šç§æ–¹å¼
ğŸ”¸ é˜Ÿåˆ—é›†æˆï¼šä½¿ç”¨æ¶ˆæ¯ä¸­é—´ä»¶ç®¡ç†ä»»åŠ¡é˜Ÿåˆ—
```

### 9.2 å…³é”®è®¾è®¡åŸåˆ™


**ğŸ”¹ ç”¨æˆ·ä½“éªŒä¼˜å…ˆ**
```
ç«‹å³å“åº”ï¼šä¸è®©ç”¨æˆ·ç­‰å¾…
è¿›åº¦é€æ˜ï¼šå‘Šè¯‰ç”¨æˆ·å½“å‰è¿›åº¦
ç»“æœé€šçŸ¥ï¼šä¸»åŠ¨å‘ŠçŸ¥å¤„ç†ç»“æœ
```

**ğŸ”¹ ç³»ç»Ÿå¯é æ€§**
```
çŠ¶æ€ä¸€è‡´ï¼šä»»åŠ¡çŠ¶æ€å‡†ç¡®åæ˜ å®é™…æƒ…å†µ
é”™è¯¯å¤„ç†ï¼šå¤±è´¥æ—¶æœ‰æ˜ç¡®çš„é”™è¯¯ä¿¡æ¯
é‡è¯•æœºåˆ¶ï¼šç½‘ç»œé—®é¢˜ç­‰ä¸´æ—¶æ•…éšœå¯é‡è¯•
```

**ğŸ”¹ æ€§èƒ½å¯æ‰©å±•**
```
é˜Ÿåˆ—è§£è€¦ï¼šä»»åŠ¡ç”Ÿäº§å’Œæ¶ˆè´¹åˆ†ç¦»
æ°´å¹³æ‰©å±•ï¼šå¯ä»¥å¢åŠ æ›´å¤šå·¥ä½œèŠ‚ç‚¹
èµ„æºä¼˜åŒ–ï¼šé¿å…é•¿è¿æ¥å ç”¨èµ„æº
```

### 9.3 å®é™…åº”ç”¨å»ºè®®


**é€‰æ‹©é€šçŸ¥æ–¹å¼**ï¼š
- ğŸ”„ **ç®€å•åº”ç”¨**ï¼šä½¿ç”¨æ™ºèƒ½è½®è¯¢
- ğŸ“¡ **æœåŠ¡å™¨é—´**ï¼šä½¿ç”¨WebHookå›è°ƒ  
- ğŸŒ **æµè§ˆå™¨å®æ—¶**ï¼šä½¿ç”¨SSEæˆ–WebSocket
- ğŸ“§ **é‡è¦é€šçŸ¥**ï¼šç»“åˆé‚®ä»¶/çŸ­ä¿¡

**ä»»åŠ¡è¶…æ—¶è®¾ç½®**ï¼š
- âš¡ **è½»é‡ä»»åŠ¡**ï¼š5-30åˆ†é’Ÿ
- ğŸ“Š **æŠ¥è¡¨ç”Ÿæˆ**ï¼š30åˆ†é’Ÿ-2å°æ—¶
- ğŸ¬ **è§†é¢‘å¤„ç†**ï¼š1-6å°æ—¶
- ğŸ“ **å¤§æ‰¹é‡å¯¼å…¥**ï¼šå‡ å°æ—¶åˆ°ä¸€å¤©

**é”™è¯¯å¤„ç†ç­–ç•¥**ï¼š
- ğŸ” **ä¸´æ—¶é”™è¯¯**ï¼šè‡ªåŠ¨é‡è¯•ï¼ˆç½‘ç»œè¶…æ—¶ã€èµ„æºå ç”¨ï¼‰
- ğŸš« **æ°¸ä¹…é”™è¯¯**ï¼šä¸é‡è¯•ï¼ˆæ•°æ®æ ¼å¼é”™è¯¯ã€æƒé™é—®é¢˜ï¼‰
- ğŸ“ **é”™è¯¯è®°å½•**ï¼šè¯¦ç»†è®°å½•é”™è¯¯ä¿¡æ¯ä¾›è°ƒè¯•

**æ ¸å¿ƒè®°å¿†**ï¼š
- å¼‚æ­¥å¤„ç†è§£å†³è€—æ—¶é—®é¢˜ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
- ä»»åŠ¡çŠ¶æ€ç®¡ç†æ˜¯æ ¸å¿ƒï¼Œè¿›åº¦è·Ÿè¸ªæ˜¯å…³é”®
- é€šçŸ¥æœºåˆ¶è¦å¯é ï¼ŒWebHookæ¯”è½®è¯¢æ›´é«˜æ•ˆ
- é˜Ÿåˆ—ç³»ç»Ÿä¿è¯å¯æ‰©å±•ï¼Œé‡è¯•æœºåˆ¶ä¿è¯å¯é æ€§