---
title: 1ã€å¾®æœåŠ¡æ¶æ„
---
## ğŸ“š ç›®å½•

1. [å¾®æœåŠ¡æ¶æ„æ¦‚å¿µ](#1-å¾®æœåŠ¡æ¶æ„æ¦‚å¿µ)
2. [RESTfulåœ¨å¾®æœåŠ¡ä¸­çš„ä½œç”¨](#2-RESTfulåœ¨å¾®æœåŠ¡ä¸­çš„ä½œç”¨)
3. [æœåŠ¡æ‹†åˆ†åŸåˆ™](#3-æœåŠ¡æ‹†åˆ†åŸåˆ™)
4. [æœåŠ¡é—´é€šä¿¡è®¾è®¡](#4-æœåŠ¡é—´é€šä¿¡è®¾è®¡)
5. [APIç½‘å…³çš„æ ¸å¿ƒä½œç”¨](#5-APIç½‘å…³çš„æ ¸å¿ƒä½œç”¨)
6. [æœåŠ¡å‘ç°æœºåˆ¶](#6-æœåŠ¡å‘ç°æœºåˆ¶)
7. [åˆ†å¸ƒå¼äº‹åŠ¡å¤„ç†](#7-åˆ†å¸ƒå¼äº‹åŠ¡å¤„ç†)
8. [å¾®æœåŠ¡ç›‘æ§å’Œæ²»ç†](#8-å¾®æœåŠ¡ç›‘æ§å’Œæ²»ç†)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ—ï¸ å¾®æœåŠ¡æ¶æ„æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯å¾®æœåŠ¡

**ğŸ’¡ é€šä¿—ç†è§£**ï¼šæƒ³è±¡ä¸€å®¶å¤§å…¬å¸ï¼ŒåŸæ¥æ‰€æœ‰éƒ¨é—¨éƒ½åœ¨ä¸€æ ‹æ¥¼é‡ŒåŠå…¬ï¼ˆå•ä½“åº”ç”¨ï¼‰ï¼Œç°åœ¨æŠŠå„ä¸ªéƒ¨é—¨åˆ†åˆ«æ¬åˆ°ä¸åŒçš„å°æ¥¼é‡Œï¼ˆå¾®æœåŠ¡ï¼‰ï¼Œå„è‡ªç‹¬ç«‹å·¥ä½œï¼Œéœ€è¦åä½œæ—¶é€šè¿‡ç”µè¯æˆ–é‚®ä»¶è”ç³»ã€‚

```
ä¼ ç»Ÿå•ä½“åº”ç”¨ï¼š                    å¾®æœåŠ¡æ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”
â”‚                 â”‚              â”‚ç”¨æˆ· â”‚  â”‚è®¢å• â”‚  â”‚å•†å“ â”‚
â”‚   ç”¨æˆ·ç®¡ç†      â”‚              â”‚æœåŠ¡ â”‚  â”‚æœåŠ¡ â”‚  â”‚æœåŠ¡ â”‚
â”‚   è®¢å•ç®¡ç†      â”‚     ====>    â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜
â”‚   å•†å“ç®¡ç†      â”‚                 â”‚        â”‚        â”‚
â”‚   æ”¯ä»˜ç®¡ç†      â”‚              â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”     â”‚
â”‚                 â”‚              â”‚æ”¯ä»˜ â”‚  â”‚åº“å­˜ â”‚â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚æœåŠ¡ â”‚  â”‚æœåŠ¡ â”‚
                                 â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜
```

### 1.2 å¾®æœåŠ¡çš„æ ¸å¿ƒç‰¹ç‚¹

**ğŸ”¸ ç‹¬ç«‹éƒ¨ç½²**
- æ¯ä¸ªæœåŠ¡å¯ä»¥å•ç‹¬å‘å¸ƒï¼Œä¸å½±å“å…¶ä»–æœåŠ¡
- å°±åƒå„ä¸ªéƒ¨é—¨å¯ä»¥ç‹¬ç«‹æ¬å®¶ï¼Œä¸å½±å“å…¶ä»–éƒ¨é—¨å·¥ä½œ

**ğŸ”¸ å•ä¸€èŒè´£**
- æ¯ä¸ªæœåŠ¡åªè´Ÿè´£ä¸€å—ä¸šåŠ¡
- ç”¨æˆ·æœåŠ¡åªç®¡ç”¨æˆ·ï¼Œè®¢å•æœåŠ¡åªç®¡è®¢å•

**ğŸ”¸ å»ä¸­å¿ƒåŒ–**
- æ²¡æœ‰ä¸€ä¸ª"è€å¤§"ç»Ÿç®¡æ‰€æœ‰æœåŠ¡
- å„æœåŠ¡å¹³ç­‰ï¼ŒæŒ‰éœ€è°ƒç”¨

**ğŸ”¸ æŠ€æœ¯å¤šæ ·æ€§**
- ä¸åŒæœåŠ¡å¯ä»¥ç”¨ä¸åŒç¼–ç¨‹è¯­è¨€
- AæœåŠ¡ç”¨Javaï¼ŒBæœåŠ¡ç”¨Pythonéƒ½å¯ä»¥

### 1.3 ä¸ºä»€ä¹ˆéœ€è¦å¾®æœåŠ¡

```
å•ä½“åº”ç”¨çš„é—®é¢˜ï¼š
âŒ ç³»ç»Ÿå¤ªå¤§ï¼Œæ”¹ä¸€ä¸ªå°åŠŸèƒ½è¦é‡æ–°éƒ¨ç½²æ•´ä¸ªç³»ç»Ÿ
âŒ ä¸€ä¸ªæ¨¡å—å‡ºbugï¼Œæ•´ä¸ªç³»ç»Ÿéƒ½å¯èƒ½å´©æºƒ
âŒ å›¢é˜Ÿåä½œå›°éš¾ï¼Œå¤§å®¶éƒ½åœ¨æ”¹åŒä¸€ä»½ä»£ç 
âŒ æŠ€æœ¯å‡çº§å›°éš¾ï¼Œè¦ä¹ˆå…¨å‡çº§ï¼Œè¦ä¹ˆéƒ½ä¸å‡çº§

å¾®æœåŠ¡çš„å¥½å¤„ï¼š
âœ… ç‹¬ç«‹å¼€å‘ï¼šå„å›¢é˜Ÿå¯ä»¥ç‹¬ç«‹å·¥ä½œ
âœ… ç‹¬ç«‹éƒ¨ç½²ï¼šæ”¹äº†ç”¨æˆ·æ¨¡å—ï¼Œåªéœ€è¦é‡æ–°éƒ¨ç½²ç”¨æˆ·æœåŠ¡
âœ… æ•…éšœéš”ç¦»ï¼šè®¢å•æœåŠ¡æŒ‚äº†ï¼Œç”¨æˆ·æœåŠ¡è¿˜èƒ½æ­£å¸¸å·¥ä½œ
âœ… æŠ€æœ¯çµæ´»ï¼šä¸åŒæœåŠ¡å¯ä»¥ç”¨æœ€é€‚åˆçš„æŠ€æœ¯
```

---

## 2. ğŸŒ RESTfulåœ¨å¾®æœåŠ¡ä¸­çš„ä½œç”¨


### 2.1 RESTfulä½œä¸ºæœåŠ¡é—´é€šä¿¡æ ‡å‡†

**ğŸ’¡ æ ¸å¿ƒä½œç”¨**ï¼šRESTfulå°±åƒæ˜¯å„ä¸ªå¾®æœåŠ¡ä¹‹é—´çš„"é€šç”¨è¯­è¨€"ï¼Œè®©ä¸åŒçš„æœåŠ¡èƒ½å¤Ÿäº’ç›¸ç†è§£å’Œäº¤æµã€‚

```
æœåŠ¡é—´é€šä¿¡ç¤ºä¾‹ï¼š
ç”¨æˆ·æœåŠ¡ â†’ è®¢å•æœåŠ¡ï¼šæŸ¥è¯¢ç”¨æˆ·è®¢å•
GET /api/orders?userId=123

è®¢å•æœåŠ¡ â†’ å•†å“æœåŠ¡ï¼šè·å–å•†å“ä¿¡æ¯
GET /api/products/456

æ”¯ä»˜æœåŠ¡ â†’ è®¢å•æœåŠ¡ï¼šæ›´æ–°è®¢å•çŠ¶æ€
PUT /api/orders/789/status
```

### 2.2 ç»Ÿä¸€çš„æ¥å£é£æ ¼

**ğŸ¯ å¥½å¤„**ï¼š
- **å­¦ä¹ æˆæœ¬ä½**ï¼šå¼€å‘äººå‘˜ç†Ÿæ‚‰ä¸€ä¸ªæœåŠ¡çš„APIï¼Œå°±èƒ½å¿«é€Ÿä¸Šæ‰‹å…¶ä»–æœåŠ¡
- **å·¥å…·é€šç”¨**ï¼šåŒæ ·çš„HTTPå®¢æˆ·ç«¯å¯ä»¥è°ƒç”¨æ‰€æœ‰æœåŠ¡
- **æ–‡æ¡£ç»Ÿä¸€**ï¼šæ‰€æœ‰æœåŠ¡çš„APIæ–‡æ¡£æ ¼å¼ç›¸ä¼¼

### 2.3 RESTfulåœ¨å¾®æœåŠ¡ä¸­çš„åº”ç”¨åœºæ™¯

```
ğŸ”¸ æœåŠ¡å‘ç°
GET /api/services          # è·å–æ‰€æœ‰å¯ç”¨æœåŠ¡
GET /api/services/user     # è·å–ç”¨æˆ·æœåŠ¡å®ä¾‹ä¿¡æ¯

ğŸ”¸ å¥åº·æ£€æŸ¥  
GET /api/health           # æ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ

ğŸ”¸ é…ç½®ç®¡ç†
GET /api/config           # è·å–æœåŠ¡é…ç½®
PUT /api/config           # æ›´æ–°æœåŠ¡é…ç½®

ğŸ”¸ ä¸šåŠ¡è°ƒç”¨
GET /api/users/123        # ç”¨æˆ·æœåŠ¡ï¼šè·å–ç”¨æˆ·ä¿¡æ¯
POST /api/orders          # è®¢å•æœåŠ¡ï¼šåˆ›å»ºè®¢å•
```

---

## 3. âœ‚ï¸ æœåŠ¡æ‹†åˆ†åŸåˆ™


### 3.1 æŒ‰ä¸šåŠ¡åŸŸæ‹†åˆ†

**ğŸ’¡ åŸåˆ™**ï¼šæŒ‰ç…§ä¸šåŠ¡åŠŸèƒ½æ¥åˆ’åˆ†æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡è´Ÿè´£ä¸€ä¸ªå®Œæ•´çš„ä¸šåŠ¡é¢†åŸŸã€‚

```
ç”µå•†ç³»ç»Ÿæ‹†åˆ†ç¤ºä¾‹ï¼š

åŸå§‹åŠŸèƒ½æ¨¡å—ï¼š            æ‹†åˆ†åçš„å¾®æœåŠ¡ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ç”¨æˆ·æ³¨å†Œç™»å½•  â”‚   =====> â”‚ç”¨æˆ·æœåŠ¡    â”‚ /api/users/*
â”‚ç”¨æˆ·ä¿¡æ¯ç®¡ç†  â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          
                        
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚å•†å“å±•ç¤º      â”‚   =====> â”‚å•†å“æœåŠ¡    â”‚ /api/products/*
â”‚å•†å“ç®¡ç†      â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚åº“å­˜ç®¡ç†      â”‚          
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚åº“å­˜æœåŠ¡    â”‚ /api/inventory/*
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ä¸‹å•          â”‚   =====> 
â”‚è®¢å•ç®¡ç†      â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚è®¢å•æŸ¥è¯¢      â”‚          â”‚è®¢å•æœåŠ¡    â”‚ /api/orders/*
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 å•ä¸€èŒè´£åŸåˆ™

**ğŸ¯ æ ¸å¿ƒæ€æƒ³**ï¼šä¸€ä¸ªæœåŠ¡åªåšä¸€ä»¶äº‹ï¼Œå¹¶ä¸”æŠŠè¿™ä»¶äº‹åšå¥½ã€‚

```
âœ… å¥½çš„æ‹†åˆ†ï¼š
ç”¨æˆ·æœåŠ¡ï¼šåªè´Ÿè´£ç”¨æˆ·ç›¸å…³çš„æ‰€æœ‰æ“ä½œ
- ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ä¿¡æ¯ä¿®æ”¹
- RESTfulæ¥å£ï¼š/api/users/*

è®¢å•æœåŠ¡ï¼šåªè´Ÿè´£è®¢å•ç›¸å…³çš„æ‰€æœ‰æ“ä½œ  
- åˆ›å»ºè®¢å•ã€æŸ¥è¯¢è®¢å•ã€å–æ¶ˆè®¢å•
- RESTfulæ¥å£ï¼š/api/orders/*

âŒ ä¸å¥½çš„æ‹†åˆ†ï¼š
ç”¨æˆ·æ³¨å†ŒæœåŠ¡ï¼šåªèƒ½æ³¨å†Œï¼Œä¸èƒ½ç™»å½•
ç”¨æˆ·ç™»å½•æœåŠ¡ï¼šåªèƒ½ç™»å½•ï¼Œä¸èƒ½æ³¨å†Œ
ï¼ˆæ‹†åˆ†è¿‡ç»†ï¼Œå¢åŠ å¤æ‚åº¦ï¼‰
```

### 3.3 æ•°æ®ç‹¬ç«‹åŸåˆ™

**ğŸ“Š é‡è¦åŸåˆ™**ï¼šæ¯ä¸ªæœåŠ¡éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„æ•°æ®åº“ï¼Œä¸èƒ½ç›´æ¥è®¿é—®å…¶ä»–æœåŠ¡çš„æ•°æ®åº“ã€‚

```
æœåŠ¡æ•°æ®éš”ç¦»ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ç”¨æˆ·æœåŠ¡  â”‚    â”‚è®¢å•æœåŠ¡  â”‚    â”‚å•†å“æœåŠ¡  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚              â”‚              â”‚
     â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ç”¨æˆ·æ•°æ®åº“â”‚    â”‚è®¢å•æ•°æ®åº“â”‚    â”‚å•†å“æ•°æ®åº“â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ•°æ®è®¿é—®è§„åˆ™ï¼š
âœ… ç”¨æˆ·æœåŠ¡å¯ä»¥ç›´æ¥è®¿é—®ç”¨æˆ·æ•°æ®åº“
âœ… è®¢å•æœåŠ¡éœ€è¦ç”¨æˆ·ä¿¡æ¯æ—¶ï¼Œé€šè¿‡RESTful APIè°ƒç”¨ç”¨æˆ·æœåŠ¡
âŒ è®¢å•æœåŠ¡ä¸èƒ½ç›´æ¥è¿æ¥ç”¨æˆ·æ•°æ®åº“
```

### 3.4 æœåŠ¡æ‹†åˆ†çš„RESTfulè®¾è®¡

```java
// æ‹†åˆ†å‰ï¼šå•ä½“åº”ç”¨ä¸­çš„ç”¨æˆ·è®¢å•æ¥å£
@RestController
public class UserController {
    // è·å–ç”¨æˆ·åŠå…¶è®¢å•ä¿¡æ¯ï¼ˆè¿åå•ä¸€èŒè´£ï¼‰
    @GetMapping("/users/{id}/orders")
    public UserWithOrders getUserOrders(@PathVariable Long id) {
        // åœ¨ä¸€ä¸ªæœåŠ¡ä¸­å¤„ç†ç”¨æˆ·å’Œè®¢å•é€»è¾‘
    }
}

// æ‹†åˆ†åï¼šç”¨æˆ·æœåŠ¡
@RestController
public class UserController {
    @GetMapping("/api/users/{id}")
    public User getUser(@PathVariable Long id) {
        // åªè¿”å›ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
        return userService.findById(id);
    }
}

// æ‹†åˆ†åï¼šè®¢å•æœåŠ¡
@RestController  
public class OrderController {
    @GetMapping("/api/orders")
    public List<Order> getOrdersByUser(@RequestParam Long userId) {
        // åªå¤„ç†è®¢å•ç›¸å…³é€»è¾‘
        return orderService.findByUserId(userId);
    }
}
```

---

## 4. ğŸ”„ æœåŠ¡é—´é€šä¿¡è®¾è®¡


### 4.1 åŒæ­¥é€šä¿¡ vs å¼‚æ­¥é€šä¿¡

**ğŸ’¡ é€šä¿—ç†è§£**ï¼š
- **åŒæ­¥é€šä¿¡**ï¼šæ‰“ç”µè¯ï¼Œå¿…é¡»ç­‰å¯¹æ–¹æ¥ç”µè¯å¹¶å›ç­”æ‰èƒ½ç»§ç»­
- **å¼‚æ­¥é€šä¿¡**ï¼šå‘çŸ­ä¿¡ï¼Œå‘å®Œå°±å»åšå…¶ä»–äº‹ï¼Œå¯¹æ–¹æœ‰ç©ºå†å›å¤

```
åŒæ­¥é€šä¿¡ï¼ˆRESTful HTTPè°ƒç”¨ï¼‰ï¼š
ç”¨æˆ·æœåŠ¡ â”€â”€â”€â”€[HTTP GET]â”€â”€â”€â†’ è®¢å•æœåŠ¡
         â†â”€â”€[è¿”å›è®¢å•æ•°æ®]â”€â”€

ç‰¹ç‚¹ï¼šå®æ—¶æ€§å¥½ï¼Œä½†ä¼šé˜»å¡ç­‰å¾…

å¼‚æ­¥é€šä¿¡ï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ï¼š
ç”¨æˆ·æœåŠ¡ â”€â”€[å‘æ¶ˆæ¯]â†’ æ¶ˆæ¯é˜Ÿåˆ— â”€â”€[æ¶ˆè´¹æ¶ˆæ¯]â†’ è®¢å•æœåŠ¡

ç‰¹ç‚¹ï¼šä¸ä¼šé˜»å¡ï¼Œä½†æ•°æ®å¯èƒ½æœ‰å»¶è¿Ÿ
```

### 4.2 RESTfulæœåŠ¡é—´è°ƒç”¨è®¾è®¡

```java
// è®¢å•æœåŠ¡éœ€è¦è°ƒç”¨ç”¨æˆ·æœåŠ¡è·å–ç”¨æˆ·ä¿¡æ¯
@Service
public class OrderService {
    
    @Autowired
    private RestTemplate restTemplate;  // HTTPå®¢æˆ·ç«¯
    
    public Order createOrder(Long userId, Long productId) {
        // 1. è°ƒç”¨ç”¨æˆ·æœåŠ¡éªŒè¯ç”¨æˆ·
        String userUrl = "http://user-service/api/users/" + userId;
        User user = restTemplate.getForObject(userUrl, User.class);
        
        if (user == null) {
            throw new RuntimeException("ç”¨æˆ·ä¸å­˜åœ¨");
        }
        
        // 2. è°ƒç”¨å•†å“æœåŠ¡è·å–å•†å“ä¿¡æ¯
        String productUrl = "http://product-service/api/products/" + productId;
        Product product = restTemplate.getForObject(productUrl, Product.class);
        
        // 3. åˆ›å»ºè®¢å•
        Order order = new Order(userId, productId, product.getPrice());
        return orderRepository.save(order);
    }
}
```

### 4.3 æœåŠ¡è°ƒç”¨çš„å®¹é”™å¤„ç†

```java
// ä½¿ç”¨æ–­è·¯å™¨æ¨¡å¼å¤„ç†æœåŠ¡è°ƒç”¨å¤±è´¥
@Component
public class UserServiceClient {
    
    public User getUser(Long userId) {
        try {
            // è°ƒç”¨ç”¨æˆ·æœåŠ¡
            String url = "http://user-service/api/users/" + userId;
            return restTemplate.getForObject(url, User.class);
            
        } catch (Exception e) {
            // æœåŠ¡è°ƒç”¨å¤±è´¥æ—¶çš„é™çº§å¤„ç†
            return getDefaultUser(userId);
        }
    }
    
    // é™çº§æ–¹æ³•ï¼šè¿”å›é»˜è®¤ç”¨æˆ·ä¿¡æ¯
    private User getDefaultUser(Long userId) {
        User defaultUser = new User();
        defaultUser.setId(userId);
        defaultUser.setName("ä¸´æ—¶ç”¨æˆ·");
        return defaultUser;
    }
}
```

### 4.4 æœåŠ¡é—´é€šä¿¡æœ€ä½³å®è·µ

```
ğŸ”¸ è¶…æ—¶è®¾ç½®
RestTemplate restTemplate = new RestTemplate();
// è®¾ç½®è¿æ¥è¶…æ—¶å’Œè¯»å–è¶…æ—¶
HttpComponentsClientHttpRequestFactory factory = 
    new HttpComponentsClientHttpRequestFactory();
factory.setConnectionRequestTimeout(3000);  // 3ç§’è¿æ¥è¶…æ—¶
factory.setReadTimeout(5000);               // 5ç§’è¯»å–è¶…æ—¶
restTemplate.setRequestFactory(factory);

ğŸ”¸ é‡è¯•æœºåˆ¶  
@Retryable(value = {Exception.class}, maxAttempts = 3)
public User getUser(Long userId) {
    // å¤±è´¥æ—¶è‡ªåŠ¨é‡è¯•ï¼Œæœ€å¤š3æ¬¡
}

ğŸ”¸ å¼‚å¸¸å¤„ç†
try {
    return userService.getUser(userId);
} catch (ServiceException e) {
    // è®°å½•æ—¥å¿—ï¼Œè¿”å›é»˜è®¤å€¼æˆ–æŠ›å‡ºä¸šåŠ¡å¼‚å¸¸
    log.error("è°ƒç”¨ç”¨æˆ·æœåŠ¡å¤±è´¥", e);
    throw new BusinessException("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥");
}
```

---

## 5. ğŸšª APIç½‘å…³çš„æ ¸å¿ƒä½œç”¨


### 5.1 APIç½‘å…³æ˜¯ä»€ä¹ˆ

**ğŸ’¡ å½¢è±¡æ¯”å–»**ï¼šAPIç½‘å…³å°±åƒæ˜¯ä¸€ä¸ªå¤§æ¥¼çš„å‰å°ï¼Œæ‰€æœ‰çš„è®¿å®¢éƒ½è¦å…ˆåˆ°å‰å°ç™»è®°ï¼Œç„¶åå‰å°å‘Šè¯‰ä½ è¦å»å“ªä¸ªæ¥¼å±‚æ‰¾å“ªä¸ªéƒ¨é—¨ã€‚

```
æ²¡æœ‰APIç½‘å…³ï¼š                     æœ‰APIç½‘å…³ï¼š
å®¢æˆ·ç«¯ â†’ ç”¨æˆ·æœåŠ¡                å®¢æˆ·ç«¯ â†’ APIç½‘å…³ â†’ ç”¨æˆ·æœåŠ¡
å®¢æˆ·ç«¯ â†’ è®¢å•æœåŠ¡                      â†“
å®¢æˆ·ç«¯ â†’ å•†å“æœåŠ¡                    è®¢å•æœåŠ¡
å®¢æˆ·ç«¯ â†’ æ”¯ä»˜æœåŠ¡                      â†“
                                    å•†å“æœåŠ¡
é—®é¢˜ï¼š                                â†“
- å®¢æˆ·ç«¯éœ€è¦çŸ¥é“æ‰€æœ‰æœåŠ¡åœ°å€         æ”¯ä»˜æœåŠ¡
- æ¯ä¸ªæœåŠ¡éƒ½è¦å¤„ç†è®¤è¯
- è·¨åŸŸé—®é¢˜å¤æ‚                   å¥½å¤„ï¼š
                               - ç»Ÿä¸€å…¥å£
                               - ç»Ÿä¸€è®¤è¯
                               - è·¯ç”±åˆ†å‘
```

### 5.2 è·¯ç”±åˆ†å‘åŠŸèƒ½

```yaml
# APIç½‘å…³è·¯ç”±é…ç½®ç¤ºä¾‹
routes:
  - id: user-service
    uri: http://user-service
    predicates:
      - Path=/api/users/**
      
  - id: order-service  
    uri: http://order-service
    predicates:
      - Path=/api/orders/**
      
  - id: product-service
    uri: http://product-service  
    predicates:
      - Path=/api/products/**
```

**ğŸ¯ å·¥ä½œæµç¨‹**ï¼š
```
1. å®¢æˆ·ç«¯è¯·æ±‚ï¼šGET /api/users/123
2. APIç½‘å…³æ¥æ”¶è¯·æ±‚
3. æ ¹æ®è·¯å¾„ /api/users/** åŒ¹é…åˆ°ç”¨æˆ·æœåŠ¡
4. è½¬å‘è¯·æ±‚åˆ°ï¼šhttp://user-service/api/users/123  
5. ç”¨æˆ·æœåŠ¡å¤„ç†å¹¶è¿”å›ç»“æœ
6. APIç½‘å…³å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯
```

### 5.3 ç»Ÿä¸€è®¤è¯æˆæƒ

```java
// APIç½‘å…³ä¸­çš„è®¤è¯è¿‡æ»¤å™¨
@Component
public class AuthFilter implements GlobalFilter {
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {
        ServerHttpRequest request = exchange.getRequest();
        
        // 1. è·å–è¯·æ±‚å¤´ä¸­çš„token
        String token = request.getHeaders().getFirst("Authorization");
        
        if (token == null || !isValidToken(token)) {
            // 2. tokenæ— æ•ˆï¼Œè¿”å›401é”™è¯¯
            ServerHttpResponse response = exchange.getResponse();
            response.setStatusCode(HttpStatus.UNAUTHORIZED);
            return response.setComplete();
        }
        
        // 3. tokenæœ‰æ•ˆï¼Œç»§ç»­å¤„ç†è¯·æ±‚
        return chain.filter(exchange);
    }
    
    private boolean isValidToken(String token) {
        // éªŒè¯tokençš„é€»è¾‘
        return tokenService.validate(token);
    }
}
```

### 5.4 è¯·æ±‚å“åº”å¤„ç†

```
ğŸ”¸ è¯·æ±‚é¢„å¤„ç†
- å‚æ•°éªŒè¯ï¼šæ£€æŸ¥å¿…éœ€å‚æ•°æ˜¯å¦å­˜åœ¨
- è¯·æ±‚æ—¥å¿—ï¼šè®°å½•è¯·æ±‚ä¿¡æ¯ç”¨äºç›‘æ§
- é™æµæ§åˆ¶ï¼šé˜²æ­¢æŸä¸ªå®¢æˆ·ç«¯è¯·æ±‚è¿‡äºé¢‘ç¹

ğŸ”¸ å“åº”åå¤„ç†  
- ç»Ÿä¸€æ ¼å¼ï¼šå°†æ‰€æœ‰æœåŠ¡çš„å“åº”æ ¼å¼ç»Ÿä¸€
- é”™è¯¯å¤„ç†ï¼šå°†å†…éƒ¨é”™è¯¯è½¬æ¢ä¸ºç”¨æˆ·å‹å¥½çš„é”™è¯¯ä¿¡æ¯
- å“åº”æ—¥å¿—ï¼šè®°å½•å“åº”çŠ¶æ€å’Œè€—æ—¶
```

### 5.5 APIç½‘å…³çš„RESTfulè®¾è®¡

```java
// é€šè¿‡APIç½‘å…³æš´éœ²çš„ç»Ÿä¸€RESTfulæ¥å£
public class GatewayController {
    
    // ç»Ÿä¸€çš„é”™è¯¯å“åº”æ ¼å¼
    @ExceptionHandler(Exception.class)
    public ResponseEntity<ErrorResponse> handleError(Exception e) {
        ErrorResponse error = new ErrorResponse();
        error.setCode("INTERNAL_ERROR");
        error.setMessage("æœåŠ¡æš‚æ—¶ä¸å¯ç”¨");
        error.setTimestamp(System.currentTimeMillis());
        
        return ResponseEntity.status(500).body(error);
    }
    
    // ç»Ÿä¸€çš„æˆåŠŸå“åº”æ ¼å¼
    private <T> ResponseEntity<ApiResponse<T>> success(T data) {
        ApiResponse<T> response = new ApiResponse<>();
        response.setCode("SUCCESS");
        response.setData(data);
        response.setTimestamp(System.currentTimeMillis());
        
        return ResponseEntity.ok(response);
    }
}
```

---

## 6. ğŸ” æœåŠ¡å‘ç°æœºåˆ¶


### 6.1 æœåŠ¡å‘ç°æ˜¯ä»€ä¹ˆ

**ğŸ’¡ ç”Ÿæ´»ç±»æ¯”**ï¼šå°±åƒæ‰‹æœºé€šè®¯å½•ï¼Œä½ æƒ³ç»™æœ‹å‹æ‰“ç”µè¯ï¼Œä¸éœ€è¦è®°ä½ä»–çš„ç”µè¯å·ç ï¼Œåªéœ€è¦åœ¨é€šè®¯å½•é‡Œæ‰¾åˆ°ä»–çš„åå­—ï¼Œæ‰‹æœºå°±èƒ½å¸®ä½ æ‹¨é€šç”µè¯ã€‚

```
ä¼ ç»Ÿæ–¹å¼ï¼ˆç¡¬ç¼–ç ï¼‰ï¼š              æœåŠ¡å‘ç°æ–¹å¼ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚è®¢å•æœåŠ¡  â”‚                    â”‚è®¢å•æœåŠ¡  â”‚    â”‚æœåŠ¡æ³¨å†Œä¸­å¿ƒ  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                              â”‚               â”‚
     â–¼                              â–¼               â–¼
è°ƒç”¨: http://192.168.1.100:8080   è°ƒç”¨: user-service   æŸ¥æ‰¾å®é™…åœ°å€
                                                   â†“
é—®é¢˜ï¼š                                        192.168.1.100:8080
- IPåœ°å€å˜åŒ–æ—¶éœ€è¦æ”¹ä»£ç                        192.168.1.101:8080
- æ— æ³•çŸ¥é“æœåŠ¡æ˜¯å¦å¯ç”¨                         (å¤šä¸ªå®ä¾‹ï¼Œè‡ªåŠ¨é€‰æ‹©)
```

### 6.2 æœåŠ¡æ³¨å†Œè¿‡ç¨‹

```java
// ç”¨æˆ·æœåŠ¡å¯åŠ¨æ—¶è‡ªåŠ¨æ³¨å†Œ
@SpringBootApplication
@EnableEurekaClient  // å¯ç”¨æœåŠ¡æ³¨å†Œ
public class UserServiceApplication {
    public static void main(String[] args) {
        SpringApplication.run(UserServiceApplication.class, args);
        // åº”ç”¨å¯åŠ¨åï¼Œè‡ªåŠ¨å‘æ³¨å†Œä¸­å¿ƒæ³¨å†ŒæœåŠ¡ä¿¡æ¯
    }
}

// æœåŠ¡é…ç½®ä¿¡æ¯
server:
  port: 8081
  
spring:
  application:
    name: user-service    # æœåŠ¡åç§°
    
eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/  # æ³¨å†Œä¸­å¿ƒåœ°å€
  instance:
    hostname: localhost
    prefer-ip-address: true
```

### 6.3 æœåŠ¡è°ƒç”¨è¿‡ç¨‹

```java
// è®¢å•æœåŠ¡è°ƒç”¨ç”¨æˆ·æœåŠ¡
@Service
public class OrderService {
    
    @Autowired
    private DiscoveryClient discoveryClient;  // æœåŠ¡å‘ç°å®¢æˆ·ç«¯
    
    public User getUserInfo(Long userId) {
        // 1. ä»æ³¨å†Œä¸­å¿ƒè·å–ç”¨æˆ·æœåŠ¡çš„å®ä¾‹åˆ—è¡¨
        List<ServiceInstance> instances = 
            discoveryClient.getInstances("user-service");
            
        if (instances.isEmpty()) {
            throw new RuntimeException("ç”¨æˆ·æœåŠ¡ä¸å¯ç”¨");
        }
        
        // 2. é€‰æ‹©ä¸€ä¸ªå¯ç”¨å®ä¾‹ï¼ˆè´Ÿè½½å‡è¡¡ï¼‰
        ServiceInstance instance = instances.get(0);
        String url = instance.getUri() + "/api/users/" + userId;
        
        // 3. å‘èµ·RESTfulè°ƒç”¨
        RestTemplate restTemplate = new RestTemplate();
        return restTemplate.getForObject(url, User.class);
    }
}
```

### 6.4 æœåŠ¡å¥åº·æ£€æŸ¥

```java
// æœåŠ¡å¥åº·æ£€æŸ¥ç«¯ç‚¹
@RestController
public class HealthController {
    
    @Autowired
    private DatabaseHealthIndicator dbHealth;
    
    @GetMapping("/api/health")
    public ResponseEntity<HealthStatus> checkHealth() {
        HealthStatus status = new HealthStatus();
        
        // æ£€æŸ¥æ•°æ®åº“è¿æ¥
        if (dbHealth.isHealthy()) {
            status.setStatus("UP");
            status.setDatabase("OK");
        } else {
            status.setStatus("DOWN");  
            status.setDatabase("ERROR");
            return ResponseEntity.status(503).body(status);
        }
        
        return ResponseEntity.ok(status);
    }
}

// æ³¨å†Œä¸­å¿ƒå®šæœŸè°ƒç”¨å¥åº·æ£€æŸ¥
GET /api/health
Response: {
    "status": "UP",
    "database": "OK",
    "timestamp": 1642678800000
}
```

### 6.5 è´Ÿè½½å‡è¡¡ç­–ç•¥

```
ğŸ”¸ è½®è¯¢ç­–ç•¥
ç”¨æˆ·æœåŠ¡å®ä¾‹ï¼š
- user-service-1: 192.168.1.100:8081
- user-service-2: 192.168.1.101:8081  
- user-service-3: 192.168.1.102:8081

è°ƒç”¨é¡ºåºï¼š
ç¬¬1æ¬¡è¯·æ±‚ â†’ user-service-1
ç¬¬2æ¬¡è¯·æ±‚ â†’ user-service-2
ç¬¬3æ¬¡è¯·æ±‚ â†’ user-service-3
ç¬¬4æ¬¡è¯·æ±‚ â†’ user-service-1 (å¾ªç¯)

ğŸ”¸ éšæœºç­–ç•¥
éšæœºé€‰æ‹©ä¸€ä¸ªå¯ç”¨å®ä¾‹

ğŸ”¸ æœ€å°‘è¿æ¥ç­–ç•¥  
é€‰æ‹©å½“å‰è¿æ¥æ•°æœ€å°‘çš„å®ä¾‹

ğŸ”¸ å“åº”æ—¶é—´ç­–ç•¥
é€‰æ‹©å¹³å‡å“åº”æ—¶é—´æœ€çŸ­çš„å®ä¾‹
```

---

## 7. ğŸ”„ åˆ†å¸ƒå¼äº‹åŠ¡å¤„ç†


### 7.1 åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜

**ğŸ’¡ ç”Ÿæ´»åœºæ™¯**ï¼šä½ åœ¨ç½‘ä¸Šä¹°ä¸œè¥¿ï¼Œéœ€è¦åŒæ—¶å®Œæˆï¼šæ‰£æ¬¾ï¼ˆæ”¯ä»˜æœåŠ¡ï¼‰+ å‡åº“å­˜ï¼ˆåº“å­˜æœåŠ¡ï¼‰+ åˆ›å»ºè®¢å•ï¼ˆè®¢å•æœåŠ¡ï¼‰ã€‚å¦‚æœæ‰£äº†æ¬¾ä½†æ˜¯åº“å­˜ä¸è¶³ï¼Œæ€ä¹ˆåŠï¼Ÿ

```
åˆ†å¸ƒå¼äº‹åŠ¡åœºæ™¯ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚æ”¯ä»˜æœåŠ¡  â”‚    â”‚åº“å­˜æœåŠ¡  â”‚    â”‚è®¢å•æœåŠ¡  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚              â”‚              â”‚
     â–¼              â–¼              â–¼
  æ‰£æ¬¾æˆåŠŸ         å‡åº“å­˜å¤±è´¥       è®¢å•æœªåˆ›å»º

é—®é¢˜ï¼šé’±æ‰£äº†ï¼Œä½†æ²¡ä¹°åˆ°ä¸œè¥¿ï¼
```

### 7.2 SAGAæ¨¡å¼

**ğŸ¯ æ ¸å¿ƒæ€æƒ³**ï¼šå°†ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡æ‹†åˆ†æˆå¤šä¸ªæœ¬åœ°äº‹åŠ¡ï¼Œå¦‚æœæŸä¸ªæ­¥éª¤å¤±è´¥ï¼Œå°±æ‰§è¡Œè¡¥å¿æ“ä½œæ’¤é”€ä¹‹å‰çš„æ­¥éª¤ã€‚

```
SAGAäº‹åŠ¡æµç¨‹ï¼š
æ­¥éª¤1: åˆ›å»ºè®¢å• â†’ æˆåŠŸ
æ­¥éª¤2: æ‰£å‡åº“å­˜ â†’ æˆåŠŸ  
æ­¥éª¤3: æ‰£æ¬¾æ”¯ä»˜ â†’ å¤±è´¥

è¡¥å¿æµç¨‹ï¼ˆå›æ»šï¼‰ï¼š
è¡¥å¿3: æ— éœ€è¡¥å¿ï¼ˆæ”¯ä»˜æœªæˆåŠŸï¼‰
è¡¥å¿2: æ¢å¤åº“å­˜ â†’ æ‰§è¡ŒæˆåŠŸ
è¡¥å¿1: å–æ¶ˆè®¢å• â†’ æ‰§è¡ŒæˆåŠŸ

æœ€ç»ˆç»“æœï¼šæ‰€æœ‰æ“ä½œéƒ½è¢«æ’¤é”€ï¼Œä¿æŒæ•°æ®ä¸€è‡´æ€§
```

### 7.3 SAGAæ¨¡å¼çš„RESTfulå®ç°

```java
// è®¢å•æœåŠ¡ï¼šSAGAåè°ƒå™¨
@Service
public class OrderSagaService {
    
    @Autowired
    private RestTemplate restTemplate;
    
    public void createOrderSaga(OrderRequest request) {
        List<SagaStep> steps = new ArrayList<>();
        
        try {
            // æ­¥éª¤1ï¼šåˆ›å»ºè®¢å•
            Long orderId = createOrder(request);
            steps.add(new SagaStep("order", orderId, this::cancelOrder));
            
            // æ­¥éª¤2ï¼šæ‰£å‡åº“å­˜
            reduceInventory(request.getProductId(), request.getQuantity());
            steps.add(new SagaStep("inventory", request.getProductId(), 
                     this::restoreInventory));
            
            // æ­¥éª¤3ï¼šå¤„ç†æ”¯ä»˜
            processPayment(request.getUserId(), request.getAmount());
            steps.add(new SagaStep("payment", request.getUserId(), 
                     this::refundPayment));
            
            log.info("è®¢å•åˆ›å»ºæˆåŠŸï¼š{}", orderId);
            
        } catch (Exception e) {
            // å‘ç”Ÿå¼‚å¸¸ï¼Œæ‰§è¡Œè¡¥å¿æ“ä½œ
            compensate(steps);
            throw new RuntimeException("è®¢å•åˆ›å»ºå¤±è´¥", e);
        }
    }
    
    // åˆ›å»ºè®¢å•çš„RESTfulè°ƒç”¨
    private Long createOrder(OrderRequest request) {
        String url = "http://order-service/api/orders";
        Order order = restTemplate.postForObject(url, request, Order.class);
        return order.getId();
    }
    
    // æ‰£å‡åº“å­˜çš„RESTfulè°ƒç”¨
    private void reduceInventory(Long productId, Integer quantity) {
        String url = "http://inventory-service/api/inventory/" + productId + "/reduce";
        InventoryRequest req = new InventoryRequest(quantity);
        restTemplate.put(url, req);
    }
    
    // è¡¥å¿æ“ä½œï¼šæ¢å¤åº“å­˜
    private void restoreInventory(Object productId) {
        String url = "http://inventory-service/api/inventory/" + productId + "/restore";
        restTemplate.put(url, null);
    }
}
```

### 7.4 TCCæ¨¡å¼

**ğŸ’¡ æ ¸å¿ƒæ€æƒ³**ï¼šTryï¼ˆå°è¯•ï¼‰- Confirmï¼ˆç¡®è®¤ï¼‰- Cancelï¼ˆå–æ¶ˆï¼‰ï¼Œåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µæ‰§è¡Œã€‚

```
TCCä¸¤é˜¶æ®µæ‰§è¡Œï¼š

é˜¶æ®µ1 - Tryï¼ˆé¢„å¤„ç†ï¼‰ï¼š
æ”¯ä»˜æœåŠ¡ï¼šå†»ç»“ç”¨æˆ·è´¦æˆ·é‡‘é¢ âœ…
åº“å­˜æœåŠ¡ï¼šé¢„ç•™å•†å“åº“å­˜   âœ…  
è®¢å•æœåŠ¡ï¼šåˆ›å»ºä¸´æ—¶è®¢å•   âœ…

é˜¶æ®µ2 - Confirmï¼ˆç¡®è®¤æäº¤ï¼‰ï¼š
æ”¯ä»˜æœåŠ¡ï¼šçœŸæ­£æ‰£æ¬¾       âœ…
åº“å­˜æœåŠ¡ï¼šçœŸæ­£å‡åº“å­˜     âœ…
è®¢å•æœåŠ¡ï¼šç¡®è®¤è®¢å•       âœ…

å¦‚æœä»»ä½•ä¸€æ­¥å¤±è´¥ï¼Œæ‰§è¡ŒCancelå›æ»šæ‰€æœ‰æ“ä½œ
```

### 7.5 åˆ†å¸ƒå¼äº‹åŠ¡æœ€ä½³å®è·µ

```
ğŸ”¸ é¿å…åˆ†å¸ƒå¼äº‹åŠ¡
- é‡æ–°è®¾è®¡ä¸šåŠ¡æµç¨‹ï¼Œå‡å°‘è·¨æœåŠ¡äº‹åŠ¡
- ä½¿ç”¨å¼‚æ­¥å¤„ç†ï¼Œæœ€ç»ˆä¸€è‡´æ€§

ğŸ”¸ é€‰æ‹©åˆé€‚çš„æ¨¡å¼
- ç®€å•åœºæ™¯ï¼šä½¿ç”¨SAGAæ¨¡å¼
- å¤æ‚åœºæ™¯ï¼šä½¿ç”¨TCCæ¨¡å¼
- æ€§èƒ½è¦æ±‚é«˜ï¼šæ¥å—æœ€ç»ˆä¸€è‡´æ€§

ğŸ”¸ å¹‚ç­‰æ€§è®¾è®¡
æ‰€æœ‰æ“ä½œéƒ½è¦æ”¯æŒé‡å¤æ‰§è¡Œï¼Œç»“æœä¸å˜

ğŸ”¸ è¡¥å¿æ“ä½œè®¾è®¡
æ¯ä¸ªæ­£å‘æ“ä½œéƒ½è¦æœ‰å¯¹åº”çš„è¡¥å¿æ“ä½œ

ğŸ”¸ ç›‘æ§å’Œå‘Šè­¦  
è®°å½•äº‹åŠ¡æ‰§è¡ŒçŠ¶æ€ï¼Œå¼‚å¸¸æ—¶åŠæ—¶å‘Šè­¦
```

---

## 8. ğŸ“Š å¾®æœåŠ¡ç›‘æ§å’Œæ²»ç†


### 8.1 æœåŠ¡ç›‘æ§çš„é‡è¦æ€§

**ğŸ’¡ å½¢è±¡æ¯”å–»**ï¼šå¾®æœåŠ¡ç›‘æ§å°±åƒåŒ»é™¢çš„ä½“æ£€ï¼Œå®šæœŸæ£€æŸ¥å„ä¸ª"å™¨å®˜"ï¼ˆæœåŠ¡ï¼‰æ˜¯å¦å¥åº·ï¼Œæœ‰é—®é¢˜åŠæ—¶æ²»ç–—ã€‚

```
ç›‘æ§æŒ‡æ ‡åˆ†ç±»ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚åŸºç¡€è®¾æ–½ç›‘æ§  â”‚    â”‚åº”ç”¨æ€§èƒ½ç›‘æ§  â”‚    â”‚ä¸šåŠ¡æŒ‡æ ‡ç›‘æ§  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                   â”‚
       â–¼                   â–¼                   â–¼
   CPU/å†…å­˜             APIå“åº”æ—¶é—´           è®¢å•æˆåŠŸç‡
   ç½‘ç»œ/ç£ç›˜             é”™è¯¯ç‡ç»Ÿè®¡           ç”¨æˆ·è½¬åŒ–ç‡
   æœåŠ¡å¯ç”¨æ€§             è¯·æ±‚é‡ç»Ÿè®¡           æ”¶å…¥æŒ‡æ ‡
```

### 8.2 RESTfulç›‘æ§æ¥å£è®¾è®¡

```java
// æœåŠ¡ç›‘æ§ç«¯ç‚¹
@RestController
@RequestMapping("/api/monitor")
public class MonitorController {
    
    // æœåŠ¡å¥åº·çŠ¶æ€
    @GetMapping("/health")
    public HealthInfo getHealth() {
        HealthInfo health = new HealthInfo();
        health.setStatus("UP");
        health.setTimestamp(System.currentTimeMillis());
        health.setVersion("1.0.0");
        
        // æ£€æŸ¥ä¾èµ–æœåŠ¡
        health.setDependencies(checkDependencies());
        return health;
    }
    
    // æ€§èƒ½æŒ‡æ ‡
    @GetMapping("/metrics")
    public MetricsInfo getMetrics() {
        MetricsInfo metrics = new MetricsInfo();
        metrics.setRequestCount(requestCounter.get());
        metrics.setAverageResponseTime(calculateAverageResponseTime());
        metrics.setErrorRate(calculateErrorRate());
        return metrics;
    }
    
    // é…ç½®ä¿¡æ¯
    @GetMapping("/info")
    public ServiceInfo getInfo() {
        ServiceInfo info = new ServiceInfo();
        info.setServiceName("user-service");
        info.setVersion("1.2.3");
        info.setBuildTime("2024-01-20T10:30:00");
        return info;
    }
}
```

### 8.3 åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª

**ğŸ” é—®é¢˜åœºæ™¯**ï¼šç”¨æˆ·åé¦ˆä¸‹å•å¤±è´¥ï¼Œä½†ä¸çŸ¥é“æ˜¯å“ªä¸ªæœåŠ¡å‡ºäº†é—®é¢˜ã€‚

```
é“¾è·¯è¿½è¸ªç¤ºä¾‹ï¼š
ç”¨æˆ·è¯·æ±‚ID: trace-12345

1. APIç½‘å…³     [trace-12345] æ¥æ”¶è¯·æ±‚      è€—æ—¶: 2ms
2. ç”¨æˆ·æœåŠ¡     [trace-12345] éªŒè¯ç”¨æˆ·      è€—æ—¶: 45ms  
3. å•†å“æœåŠ¡     [trace-12345] æŸ¥è¯¢å•†å“      è€—æ—¶: 23ms
4. åº“å­˜æœåŠ¡     [trace-12345] æ£€æŸ¥åº“å­˜      è€—æ—¶: 156ms âŒ è¶…æ—¶
5. è®¢å•æœåŠ¡     [trace-12345] åˆ›å»ºè®¢å•å¤±è´¥   è€—æ—¶: 0ms

é—®é¢˜å®šä½ï¼šåº“å­˜æœåŠ¡å“åº”è¶…æ—¶å¯¼è‡´æ•´ä¸ªé“¾è·¯å¤±è´¥
```

### 8.4 æœåŠ¡é™çº§å’Œç†”æ–­

```java
// ç†”æ–­å™¨é…ç½®
@Component
public class UserServiceClient {
    
    // ç†”æ–­å™¨æ³¨è§£ï¼šå¤±è´¥ç‡è¶…è¿‡50%æ—¶å¼€å¯ç†”æ–­
    @CircuitBreaker(name = "user-service", fallbackMethod = "getFallbackUser")
    @TimeLimiter(name = "user-service")
    @Retry(name = "user-service")
    public User getUser(Long userId) {
        String url = "http://user-service/api/users/" + userId;
        return restTemplate.getForObject(url, User.class);
    }
    
    // é™çº§æ–¹æ³•ï¼šæœåŠ¡ä¸å¯ç”¨æ—¶çš„å¤‡ç”¨æ–¹æ¡ˆ
    public User getFallbackUser(Long userId, Exception e) {
        log.warn("ç”¨æˆ·æœåŠ¡è°ƒç”¨å¤±è´¥ï¼Œä½¿ç”¨é™çº§æ–¹æ¡ˆ", e);
        
        User fallbackUser = new User();
        fallbackUser.setId(userId);
        fallbackUser.setName("ä¸´æ—¶ç”¨æˆ·");
        fallbackUser.setEmail("temp@example.com");
        
        return fallbackUser;
    }
}
```

### 8.5 é…ç½®ç®¡ç†

```yaml
# é…ç½®ä¸­å¿ƒçš„RESTfulæ¥å£
GET /api/config/user-service/production     # è·å–ç”¨æˆ·æœåŠ¡ç”Ÿäº§ç¯å¢ƒé…ç½®
PUT /api/config/user-service/production     # æ›´æ–°é…ç½®
POST /api/config/refresh                    # åˆ·æ–°æ‰€æœ‰æœåŠ¡é…ç½®

# åŠ¨æ€é…ç½®ç¤ºä¾‹
{
    "database": {
        "maxConnections": 100,
        "timeout": 30000
    },
    "cache": {
        "ttl": 3600,
        "maxSize": 10000
    },
    "featureFlags": {
        "newUserInterface": true,
        "advancedSearch": false
    }
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ

```
ğŸ”¸ å¾®æœåŠ¡æ¶æ„ï¼šå¤§ç³»ç»Ÿæ‹†åˆ†æˆå°æœåŠ¡ï¼Œç‹¬ç«‹å¼€å‘éƒ¨ç½²
ğŸ”¸ RESTfulé€šä¿¡ï¼šæœåŠ¡é—´é€šä¿¡çš„ç»Ÿä¸€æ ‡å‡†å’Œæ¥å£é£æ ¼
ğŸ”¸ æœåŠ¡æ‹†åˆ†ï¼šæŒ‰ä¸šåŠ¡åŸŸæ‹†åˆ†ï¼Œéµå¾ªå•ä¸€èŒè´£åŸåˆ™
ğŸ”¸ APIç½‘å…³ï¼šç»Ÿä¸€å…¥å£ï¼Œå¤„ç†è·¯ç”±ã€è®¤è¯ã€ç›‘æ§
ğŸ”¸ æœåŠ¡å‘ç°ï¼šè‡ªåŠ¨å‘ç°å’Œè°ƒç”¨å¯ç”¨çš„æœåŠ¡å®ä¾‹
ğŸ”¸ åˆ†å¸ƒå¼äº‹åŠ¡ï¼šä¿è¯è·¨æœåŠ¡æ“ä½œçš„æ•°æ®ä¸€è‡´æ€§
ğŸ”¸ æœåŠ¡æ²»ç†ï¼šç›‘æ§ã€é™çº§ã€ç†”æ–­ç­‰ä¿éšœæªæ–½
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆé€‰æ‹©å¾®æœåŠ¡æ¶æ„**
```
ä¼ ç»Ÿé—®é¢˜ï¼š
âŒ ç³»ç»Ÿåºå¤§ï¼Œç»´æŠ¤å›°éš¾
âŒ éƒ¨ç½²é£é™©é«˜ï¼Œç‰µä¸€å‘åŠ¨å…¨èº«  
âŒ æŠ€æœ¯æ ˆå›ºåŒ–ï¼Œåˆ›æ–°å›°éš¾
âŒ å›¢é˜Ÿåä½œæ•ˆç‡ä½

å¾®æœåŠ¡ä¼˜åŠ¿ï¼š
âœ… æœåŠ¡ç‹¬ç«‹ï¼Œæ•…éšœéš”ç¦»
âœ… æŠ€æœ¯å¤šæ ·åŒ–ï¼Œé€‰æ‹©çµæ´»
âœ… å›¢é˜Ÿè‡ªæ²»ï¼Œå¼€å‘æ•ˆç‡é«˜
âœ… æ‰©å±•æ€§å¥½ï¼ŒæŒ‰éœ€æ‰©å®¹
```

**ğŸ”¹ RESTfulåœ¨å¾®æœåŠ¡ä¸­çš„ä»·å€¼**
```
ç»Ÿä¸€æ ‡å‡†ï¼š
- é™ä½å­¦ä¹ æˆæœ¬ï¼Œæé«˜å¼€å‘æ•ˆç‡
- å·¥å…·é“¾é€šç”¨ï¼Œæ–‡æ¡£è§„èŒƒç»Ÿä¸€
- ä¾¿äºæµ‹è¯•å’Œè°ƒè¯•

ç®€å•å¯é ï¼š
- åŸºäºHTTPåè®®ï¼Œæˆç†Ÿç¨³å®š
- æ— çŠ¶æ€è®¾è®¡ï¼Œæ˜“äºæ‰©å±•
- è¯­ä¹‰æ¸…æ™°ï¼Œæ˜“äºç†è§£
```

**ğŸ”¹ æœåŠ¡æ‹†åˆ†çš„æ ¸å¿ƒåŸåˆ™**
```
ä¸šåŠ¡å¯¼å‘ï¼š
- æŒ‰ä¸šåŠ¡é¢†åŸŸæ‹†åˆ†ï¼Œä¸æ˜¯æŠ€æœ¯å±‚æ¬¡
- ä¸€ä¸ªæœåŠ¡å¯¹åº”ä¸€ä¸ªä¸šåŠ¡èƒ½åŠ›
- é¿å…æœåŠ¡é—´è¿‡åº¦è€¦åˆ

æ•°æ®ç‹¬ç«‹ï¼š
- æ¯ä¸ªæœåŠ¡æ‹¥æœ‰ç‹¬ç«‹çš„æ•°æ®å­˜å‚¨
- é€šè¿‡APIè®¿é—®å…¶ä»–æœåŠ¡æ•°æ®
- é¿å…æ•°æ®åº“å±‚é¢çš„è€¦åˆ

å›¢é˜ŸåŒ¹é…ï¼š
- ä¸€ä¸ªå›¢é˜Ÿè´Ÿè´£ä¸€ä¸ªæˆ–å‡ ä¸ªç›¸å…³æœåŠ¡
- å›¢é˜Ÿè§„æ¨¡æ§åˆ¶åœ¨2-8äººï¼ˆä¸¤ä¸ªæŠ«è¨åŸåˆ™ï¼‰
```

### 9.3 å®è·µåº”ç”¨æŒ‡å¯¼

```
ğŸ¯ é€‚åˆå¾®æœåŠ¡çš„åœºæ™¯ï¼š
âœ… ä¸šåŠ¡å¤æ‚ï¼Œå›¢é˜Ÿè§„æ¨¡å¤§
âœ… ä¸åŒæ¨¡å—æŠ€æœ¯æ ˆéœ€æ±‚å·®å¼‚å¤§
âœ… éœ€è¦é¢‘ç¹ç‹¬ç«‹å‘å¸ƒæŸäº›åŠŸèƒ½
âœ… å¯¹å¯æ‰©å±•æ€§è¦æ±‚é«˜

âš ï¸ ä¸é€‚åˆå¾®æœåŠ¡çš„åœºæ™¯ï¼š
âŒ ç®€å•åº”ç”¨ï¼Œå›¢é˜Ÿè§„æ¨¡å°
âŒ ä¸šåŠ¡é€»è¾‘ç´§å¯†è€¦åˆ
âŒ å¯¹æ€§èƒ½è¦æ±‚æé«˜ï¼ˆç½‘ç»œå¼€é”€æ•æ„Ÿï¼‰
âŒ è¿ç»´èƒ½åŠ›ä¸è¶³

ğŸ”§ è¿ç§»ç­–ç•¥ï¼š
1. ä»è¾¹ç•Œæ¸…æ™°çš„æ¨¡å—å¼€å§‹æ‹†åˆ†
2. å…ˆæ‹†åˆ†è¯»æ“ä½œï¼Œå†æ‹†åˆ†å†™æ“ä½œ
3. ä¿æŒAPIå‘åå…¼å®¹
4. é€æ­¥è¿ç§»æ•°æ®å­˜å‚¨
```

### 9.4 å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

```
ğŸ”¸ æœåŠ¡è°ƒç”¨å¤æ‚æ€§
é—®é¢˜ï¼šæœåŠ¡é—´è°ƒç”¨é“¾è·¯å¤æ‚ï¼Œéš¾ä»¥è°ƒè¯•
è§£å†³ï¼šå¼•å…¥APIç½‘å…³ç»Ÿä¸€ç®¡ç†ï¼Œä½¿ç”¨é“¾è·¯è¿½è¸ª

ğŸ”¸ æ•°æ®ä¸€è‡´æ€§æŒ‘æˆ˜  
é—®é¢˜ï¼šè·¨æœåŠ¡äº‹åŠ¡å¤„ç†å¤æ‚
è§£å†³ï¼šé‡‡ç”¨SAGAæ¨¡å¼æˆ–æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆ

ğŸ”¸ æœåŠ¡æ²»ç†å›°éš¾
é—®é¢˜ï¼šæœåŠ¡æ•°é‡å¤šï¼Œç›‘æ§ç®¡ç†å¤æ‚
è§£å†³ï¼šå»ºç«‹å®Œå–„çš„ç›‘æ§ä½“ç³»å’Œè‡ªåŠ¨åŒ–è¿ç»´

ğŸ”¸ ç½‘ç»œå»¶è¿Ÿå’Œæ•…éšœ
é—®é¢˜ï¼šç½‘ç»œè°ƒç”¨å¢åŠ å»¶è¿Ÿå’Œå¤±è´¥æ¦‚ç‡
è§£å†³ï¼šå®ç°ç†”æ–­é™çº§ï¼Œæä¾›å¤‡ç”¨æ–¹æ¡ˆ
```

**ğŸ’¡ æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- å¾®æœåŠ¡æ‹†åˆ†æŒ‰ä¸šåŠ¡ï¼Œç‹¬ç«‹éƒ¨ç½²å¥½ç®¡ç†
- RESTfulç»Ÿä¸€åšæ ‡å‡†ï¼ŒæœåŠ¡é€šä¿¡æ›´ç®€å•
- APIç½‘å…³æ˜¯é—¨æˆ·ï¼Œè·¯ç”±è®¤è¯ä¸€ç«™å¼
- æœåŠ¡å‘ç°æ‰¾åœ°å€ï¼Œè´Ÿè½½å‡è¡¡åˆ†æµé‡
- åˆ†å¸ƒå¼äº‹åŠ¡è¦è°¨æ…ï¼ŒSAGAè¡¥å¿ä¿ä¸€è‡´
- ç›‘æ§æ²»ç†ä¸å¯å°‘ï¼Œé™çº§ç†”æ–­ä¿ç¨³å®š