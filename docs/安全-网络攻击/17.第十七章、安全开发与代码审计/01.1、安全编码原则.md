---
title: 1ã€å®‰å…¨ç¼–ç åŸåˆ™
---
## ğŸ“š ç›®å½•

1. [å®‰å…¨ç¼–ç åŸºç¡€æ¦‚å¿µ](#1-å®‰å…¨ç¼–ç åŸºç¡€æ¦‚å¿µ)
2. [æœ€å°æƒé™åŸåˆ™å®æ–½](#2-æœ€å°æƒé™åŸåˆ™å®æ–½)
3. [è¾“å…¥éªŒè¯ä¸è¾“å‡ºç¼–ç ](#3-è¾“å…¥éªŒè¯ä¸è¾“å‡ºç¼–ç )
4. [é”™è¯¯å¤„ç†ä¸ä¿¡æ¯æ³„éœ²é˜²æŠ¤](#4-é”™è¯¯å¤„ç†ä¸ä¿¡æ¯æ³„éœ²é˜²æŠ¤)
5. [å®‰å…¨é…ç½®ç®¡ç†](#5-å®‰å…¨é…ç½®ç®¡ç†)
6. [å¯†ç ä¸å¯†é’¥ç®¡ç†](#6-å¯†ç ä¸å¯†é’¥ç®¡ç†)
7. [æ‹’ç»é»˜è®¤ä¿¡ä»»åŸåˆ™](#7-æ‹’ç»é»˜è®¤ä¿¡ä»»åŸåˆ™)
8. [é”™è¯¯ä¿¡æ¯ä¸æš´éœ²ç»†èŠ‚ç­–ç•¥](#8-é”™è¯¯ä¿¡æ¯ä¸æš´éœ²ç»†èŠ‚ç­–ç•¥)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ›¡ï¸ å®‰å…¨ç¼–ç åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯å®‰å…¨ç¼–ç 


**ç®€å•ç†è§£**ï¼šå®‰å…¨ç¼–ç å°±æ˜¯åœ¨å†™ä»£ç æ—¶ï¼Œæ—¶åˆ»è€ƒè™‘å®‰å…¨é—®é¢˜ï¼Œé˜²æ­¢é»‘å®¢åˆ©ç”¨ä»£ç æ¼æ´è¿›è¡Œæ”»å‡»ã€‚

```
æ™®é€šç¼–ç æ€ç»´ï¼š                   å®‰å…¨ç¼–ç æ€ç»´ï¼š
åŠŸèƒ½å®ç° âœ“                      åŠŸèƒ½å®ç° âœ“
                               + è¾“å…¥éªŒè¯ âœ“  
                               + æƒé™æ§åˆ¶ âœ“
                               + é”™è¯¯å¤„ç† âœ“
                               + ä¿¡æ¯ä¿æŠ¤ âœ“
```

**æ ¸å¿ƒæ€æƒ³**ï¼š
- ğŸ”¸ **é˜²å¾¡æ€§ç¼–ç¨‹**ï¼šå‡è®¾æ‰€æœ‰è¾“å…¥éƒ½æ˜¯æ¶æ„çš„
- ğŸ”¸ **çºµæ·±é˜²å¾¡**ï¼šå¤šå±‚å®‰å…¨é˜²æŠ¤æœºåˆ¶
- ğŸ”¸ **æœ€å°æš´éœ²**ï¼šåªæš´éœ²å¿…è¦çš„åŠŸèƒ½å’Œä¿¡æ¯

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦å®‰å…¨ç¼–ç 


**ç°å®åœºæ™¯å¯¹æ¯”**ï¼š
```
ä¸å®‰å…¨çš„ä»£ç ï¼š
ç”¨æˆ·ç™»å½• â†’ ç›´æ¥æŸ¥è¯¢æ•°æ®åº“ â†’ è¿”å›ç»“æœ
é—®é¢˜ï¼šSQLæ³¨å…¥ã€å¯†ç æ³„éœ²ã€æƒé™ç»•è¿‡

å®‰å…¨çš„ä»£ç ï¼š
ç”¨æˆ·ç™»å½• â†’ è¾“å…¥éªŒè¯ â†’ å‚æ•°åŒ–æŸ¥è¯¢ â†’ å¯†ç åŠ å¯†å¯¹æ¯” â†’ 
æƒé™æ£€æŸ¥ â†’ å®‰å…¨å“åº”
```

**å¸¸è§å®‰å…¨é—®é¢˜**ï¼š
- âŒ **ç›´æ¥ä¿¡ä»»ç”¨æˆ·è¾“å…¥**ï¼šå¯¼è‡´æ³¨å…¥æ”»å‡»
- âŒ **æ˜æ–‡å­˜å‚¨å¯†ç **ï¼šæ•°æ®æ³„éœ²é£é™©
- âŒ **è¿‡åº¦æƒé™æˆäºˆ**ï¼šæƒé™æ»¥ç”¨é—®é¢˜
- âŒ **è¯¦ç»†é”™è¯¯ä¿¡æ¯**ï¼šä¿¡æ¯æ³„éœ²é£é™©

---

## 2. ğŸ” æœ€å°æƒé™åŸåˆ™å®æ–½


### 2.1 æœ€å°æƒé™åŸåˆ™å«ä¹‰


**é€šä¿—è§£é‡Š**ï¼šç»™æ¯ä¸ªç”¨æˆ·ã€ç¨‹åºæˆ–ç³»ç»Ÿç»„ä»¶åˆšå¥½å¤Ÿç”¨çš„æƒé™ï¼Œä¸å¤šç»™ä¸€ç‚¹ã€‚

```
ç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼š
é“¶è¡Œå‡ºçº³å‘˜ï¼šåªèƒ½å­˜å–æ¬¾ï¼Œä¸èƒ½æ‰¹å‡†è´·æ¬¾
éƒ¨é—¨ç»ç†ï¼šå¯ä»¥æ‰¹å‡†å°é¢é¢„ç®—ï¼Œä¸èƒ½å†³å®šå…¬å¸æˆ˜ç•¥
CEOï¼šæœ‰æœ€é«˜å†³ç­–æƒ

ç¨‹åºä¸­çš„ä¾‹å­ï¼š
æ™®é€šç”¨æˆ·ï¼šåªèƒ½æŸ¥çœ‹è‡ªå·±çš„æ•°æ®
ç®¡ç†å‘˜ï¼šå¯ä»¥ç®¡ç†ç”¨æˆ·ï¼Œä½†ä¸èƒ½è®¿é—®ç³»ç»Ÿé…ç½®
è¶…çº§ç®¡ç†å‘˜ï¼šæœ‰å®Œæ•´ç³»ç»Ÿæƒé™
```

### 2.2 æƒé™æ§åˆ¶å®ç°


**ğŸ”¹ ç”¨æˆ·çº§åˆ«æƒé™æ§åˆ¶**

```java
// ç®€å•çš„æƒé™æ£€æŸ¥ç¤ºä¾‹
public class UserService {
    
    public void deleteUser(int userId, User currentUser) {
        // æ£€æŸ¥å½“å‰ç”¨æˆ·æ˜¯å¦æœ‰åˆ é™¤æƒé™
        if (!currentUser.hasRole("ADMIN")) {
            throw new SecurityException("æƒé™ä¸è¶³ï¼Œæ— æ³•åˆ é™¤ç”¨æˆ·");
        }
        
        // æ£€æŸ¥æ˜¯å¦è¯•å›¾åˆ é™¤è‡ªå·±
        if (userId == currentUser.getId()) {
            throw new SecurityException("ä¸èƒ½åˆ é™¤è‡ªå·±çš„è´¦æˆ·");
        }
        
        // æ‰§è¡Œåˆ é™¤æ“ä½œ
        userRepository.delete(userId);
    }
}
```

**ğŸ”¹ æ•°æ®åº“çº§åˆ«æƒé™æ§åˆ¶**

```sql
-- ä¸ºä¸åŒè§’è‰²åˆ›å»ºä¸åŒçš„æ•°æ®åº“ç”¨æˆ·
-- åªè¯»ç”¨æˆ·ï¼šåªèƒ½æŸ¥è¯¢
CREATE USER 'app_readonly'@'localhost' IDENTIFIED BY 'password';
GRANT SELECT ON company_db.* TO 'app_readonly'@'localhost';

-- åº”ç”¨ç”¨æˆ·ï¼šå¯ä»¥å¢åˆ æ”¹æŸ¥ï¼Œä½†ä¸èƒ½ä¿®æ”¹è¡¨ç»“æ„
CREATE USER 'app_user'@'localhost' IDENTIFIED BY 'password';  
GRANT SELECT, INSERT, UPDATE, DELETE ON company_db.* TO 'app_user'@'localhost';
```

### 2.3 æƒé™åˆ†çº§ç®¡ç†


**æƒé™ç­‰çº§åˆ’åˆ†**ï¼š
```
ğŸŸ¢ Level 1 - åŸºç¡€æƒé™ï¼šæŸ¥çœ‹å…¬å¼€ä¿¡æ¯
ğŸŸ¡ Level 2 - ç”¨æˆ·æƒé™ï¼šç®¡ç†ä¸ªäººæ•°æ®  
ğŸŸ  Level 3 - ç®¡ç†æƒé™ï¼šç®¡ç†éƒ¨é—¨æ•°æ®
ğŸ”´ Level 4 - ç³»ç»Ÿæƒé™ï¼šç³»ç»Ÿé…ç½®ç®¡ç†
```

**æƒé™æ£€æŸ¥æµç¨‹**ï¼š
```
ç”¨æˆ·è¯·æ±‚ â†’ èº«ä»½éªŒè¯ â†’ æƒé™æ£€æŸ¥ â†’ èµ„æºè®¿é—®æ§åˆ¶ â†’ æ“ä½œæ—¥å¿—
     â†“           â†“          â†“           â†“            â†“
  è°åœ¨è®¿é—®    ç¡®è®¤èº«ä»½    æ£€æŸ¥æƒé™     æ§åˆ¶èŒƒå›´      è®°å½•è¡Œä¸º
```

---

## 3. ğŸ” è¾“å…¥éªŒè¯ä¸è¾“å‡ºç¼–ç 


### 3.1 è¾“å…¥éªŒè¯çš„é‡è¦æ€§


**ä¸ºä»€ä¹ˆè¦éªŒè¯è¾“å…¥**ï¼š
```
ç”¨æˆ·è¾“å…¥çš„å†…å®¹å¯èƒ½åŒ…å«ï¼š
- æ¶æ„ä»£ç ï¼š<script>alert('XSS')</script>
- SQLæ³¨å…¥ï¼š'; DROP TABLE users; --
- æ–‡ä»¶è·¯å¾„ï¼š../../../etc/passwd
- è¶…é•¿å†…å®¹ï¼šå¯¼è‡´ç¼“å†²åŒºæº¢å‡º
```

### 3.2 è¾“å…¥éªŒè¯å®è·µ


**ğŸ”¹ ç™½åå•éªŒè¯ï¼ˆæ¨èï¼‰**

```java
public class InputValidator {
    
    // éªŒè¯ç”¨æˆ·åï¼šåªå…è®¸å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿
    public static boolean isValidUsername(String username) {
        if (username == null || username.length() < 3 || username.length() > 20) {
            return false;
        }
        return username.matches("^[a-zA-Z0-9_]+$");
    }
    
    // éªŒè¯é‚®ç®±æ ¼å¼
    public static boolean isValidEmail(String email) {
        String emailPattern = "^[A-Za-z0-9+_.-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$";
        return email != null && email.matches(emailPattern);
    }
    
    // éªŒè¯æ‰‹æœºå·
    public static boolean isValidPhone(String phone) {
        return phone != null && phone.matches("^1[3-9]\\d{9}$");
    }
}
```

**ğŸ”¹ è¾“å…¥é•¿åº¦é™åˆ¶**

```java
public class DataValidator {
    
    public static String validateAndCleanInput(String input, int maxLength) {
        // 1. æ£€æŸ¥æ˜¯å¦ä¸ºç©º
        if (input == null || input.trim().isEmpty()) {
            throw new IllegalArgumentException("è¾“å…¥ä¸èƒ½ä¸ºç©º");
        }
        
        // 2. é•¿åº¦æ£€æŸ¥
        if (input.length() > maxLength) {
            throw new IllegalArgumentException("è¾“å…¥é•¿åº¦è¶…è¿‡é™åˆ¶ï¼š" + maxLength);
        }
        
        // 3. å»é™¤é¦–å°¾ç©ºæ ¼
        return input.trim();
    }
}
```

### 3.3 è¾“å‡ºç¼–ç é˜²æŠ¤


**HTMLç¼–ç é˜²XSS**ï¼š

```java
public class OutputEncoder {
    
    // HTMLå®ä½“ç¼–ç 
    public static String encodeForHTML(String input) {
        if (input == null) return "";
        
        return input
            .replace("&", "&amp;")    // å¿…é¡»å…ˆå¤„ç†&
            .replace("<", "&lt;")
            .replace(">", "&gt;")
            .replace("\"", "&quot;")
            .replace("'", "&#x27;");
    }
    
    // JavaScriptç¼–ç 
    public static String encodeForJS(String input) {
        if (input == null) return "";
        
        StringBuilder encoded = new StringBuilder();
        for (char c : input.toCharArray()) {
            if (c < 32 || c > 126) {
                encoded.append("\\u").append(String.format("%04x", (int) c));
            } else if (c == '"' || c == '\'' || c == '\\') {
                encoded.append("\\").append(c);
            } else {
                encoded.append(c);
            }
        }
        return encoded.toString();
    }
}
```

---

## 4. âš ï¸ é”™è¯¯å¤„ç†ä¸ä¿¡æ¯æ³„éœ²é˜²æŠ¤


### 4.1 é”™è¯¯å¤„ç†çš„å®‰å…¨é—®é¢˜


**ä¸å®‰å…¨çš„é”™è¯¯ä¿¡æ¯**ï¼š
```java
// âŒ é”™è¯¯ç¤ºä¾‹ï¼šæš´éœ²äº†æ•°æ®åº“ç»“æ„
try {
    User user = userService.findByEmail(email);
} catch (SQLException e) {
    return "æ•°æ®åº“é”™è¯¯ï¼šTable 'users' doesn't exist in database 'company_db'";
}

// âŒ é”™è¯¯ç¤ºä¾‹ï¼šæš´éœ²äº†æ–‡ä»¶è·¯å¾„
try {
    File config = new File("/etc/app/config.properties");
} catch (FileNotFoundException e) {
    return "é…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼š" + e.getMessage();
}
```

**å®‰å…¨çš„é”™è¯¯å¤„ç†**ï¼š
```java
// âœ… æ­£ç¡®ç¤ºä¾‹ï¼šé€šç”¨é”™è¯¯ä¿¡æ¯
try {
    User user = userService.findByEmail(email);
} catch (SQLException e) {
    logger.error("æ•°æ®åº“æŸ¥è¯¢å¤±è´¥", e);  // è®°å½•è¯¦ç»†æ—¥å¿—
    return "ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åé‡è¯•";      // è¿”å›é€šç”¨ä¿¡æ¯
}
```

### 4.2 ç»Ÿä¸€å¼‚å¸¸å¤„ç†


```java
@ControllerAdvice
public class GlobalExceptionHandler {
    
    private static final Logger logger = LoggerFactory.getLogger(GlobalExceptionHandler.class);
    
    // å¤„ç†æ•°æ®åº“å¼‚å¸¸
    @ExceptionHandler(SQLException.class)
    public ResponseEntity<String> handleDatabaseError(SQLException e) {
        logger.error("æ•°æ®åº“æ“ä½œå¤±è´¥", e);
        return ResponseEntity.status(500).body("ç³»ç»Ÿæš‚æ—¶ä¸å¯ç”¨");
    }
    
    // å¤„ç†æƒé™å¼‚å¸¸  
    @ExceptionHandler(SecurityException.class)
    public ResponseEntity<String> handleSecurityError(SecurityException e) {
        logger.warn("å®‰å…¨å¼‚å¸¸: {}", e.getMessage());
        return ResponseEntity.status(403).body("è®¿é—®è¢«æ‹’ç»");
    }
    
    // å¤„ç†è¾“å…¥éªŒè¯å¼‚å¸¸
    @ExceptionHandler(IllegalArgumentException.class) 
    public ResponseEntity<String> handleValidationError(IllegalArgumentException e) {
        return ResponseEntity.status(400).body("è¯·æ±‚å‚æ•°é”™è¯¯");
    }
}
```

### 4.3 æ—¥å¿—å®‰å…¨ç®¡ç†


**å®‰å…¨æ—¥å¿—è®°å½•åŸåˆ™**ï¼š
```java
public class SecurityLogger {
    
    private static final Logger securityLog = LoggerFactory.getLogger("SECURITY");
    
    // è®°å½•ç™»å½•å¤±è´¥ï¼ˆä¸è®°å½•å¯†ç ï¼‰
    public static void logLoginFailure(String username, String ip) {
        securityLog.warn("ç™»å½•å¤±è´¥ - ç”¨æˆ·å: {}, IP: {}", username, ip);
    }
    
    // è®°å½•æƒé™æ£€æŸ¥å¤±è´¥
    public static void logAccessDenied(String username, String resource) {
        securityLog.warn("è®¿é—®è¢«æ‹’ç» - ç”¨æˆ·: {}, èµ„æº: {}", username, resource);
    }
    
    // âŒ ä¸è¦è®°å½•æ•æ„Ÿä¿¡æ¯
    // securityLog.info("ç”¨æˆ·å¯†ç : {}", password);  // é”™è¯¯ï¼
    // securityLog.info("ä¿¡ç”¨å¡å·: {}", cardNumber); // é”™è¯¯ï¼
}
```

---

## 5. âš™ï¸ å®‰å…¨é…ç½®ç®¡ç†


### 5.1 é…ç½®æ–‡ä»¶å®‰å…¨


**é…ç½®æ–‡ä»¶åˆ†ç¦»**ï¼š
```
é¡¹ç›®ç»“æ„ï¼š
src/
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ resources/
â”‚   â”‚   â”œâ”€â”€ application.yml          # å…¬å…±é…ç½®
â”‚   â”‚   â”œâ”€â”€ application-dev.yml      # å¼€å‘ç¯å¢ƒ
â”‚   â”‚   â”œâ”€â”€ application-prod.yml     # ç”Ÿäº§ç¯å¢ƒï¼ˆä¸åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼‰
â”‚   â””â”€â”€ java/
â””â”€â”€ config/
    â”œâ”€â”€ secrets-dev.yml              # å¼€å‘ç¯å¢ƒæ•æ„Ÿé…ç½®
    â””â”€â”€ secrets-prod.yml             # ç”Ÿäº§ç¯å¢ƒæ•æ„Ÿé…ç½®ï¼ˆå•ç‹¬ç®¡ç†ï¼‰
```

**ç¯å¢ƒå˜é‡ç®¡ç†**ï¼š
```yaml
# application.yml
datasource:
  url: ${DB_URL:jdbc:mysql://localhost:3306/testdb}
  username: ${DB_USERNAME:root}
  password: ${DB_PASSWORD:password}
  
security:
  jwt:
    secret: ${JWT_SECRET:default-secret-key}
    expiration: ${JWT_EXPIRATION:86400}
```

### 5.2 é»˜è®¤é…ç½®å®‰å…¨


**å®‰å…¨çš„é»˜è®¤é…ç½®**ï¼š
```yaml
# å®‰å…¨é…ç½®ç¤ºä¾‹
server:
  port: 8080
  servlet:
    session:
      timeout: 30m              # ä¼šè¯è¶…æ—¶30åˆ†é’Ÿ
      cookie:
        secure: true            # åªåœ¨HTTPSä¸‹ä¼ è¾“
        http-only: true         # é˜²æ­¢XSSè·å–Cookie
        
logging:
  level:
    org.springframework.security: WARN  # ä¸è®°å½•è¯¦ç»†å®‰å…¨æ—¥å¿—
    com.company.app: INFO
    
spring:
  datasource:
    hikari:
      maximum-pool-size: 10     # é™åˆ¶è¿æ¥æ± å¤§å°
      connection-timeout: 20000 # è¿æ¥è¶…æ—¶20ç§’
```

### 5.3 é…ç½®éªŒè¯


```java
@Component
public class ConfigurationValidator {
    
    @Value("${security.jwt.secret}")
    private String jwtSecret;
    
    @Value("${datasource.password}")
    private String dbPassword;
    
    @PostConstruct
    public void validateConfiguration() {
        // æ£€æŸ¥JWTå¯†é’¥å¼ºåº¦
        if (jwtSecret.length() < 32) {
            throw new IllegalStateException("JWTå¯†é’¥é•¿åº¦ä¸è¶³ï¼Œè‡³å°‘éœ€è¦32ä½");
        }
        
        // æ£€æŸ¥æ˜¯å¦ä½¿ç”¨é»˜è®¤å¯†ç 
        if ("password".equals(dbPassword) || "123456".equals(dbPassword)) {
            throw new IllegalStateException("æ£€æµ‹åˆ°å¼±å¯†ç ï¼Œè¯·ä¿®æ”¹æ•°æ®åº“å¯†ç ");
        }
    }
}
```

---

## 6. ğŸ”‘ å¯†ç ä¸å¯†é’¥ç®¡ç†


### 6.1 å¯†ç å­˜å‚¨å®‰å…¨


**é”™è¯¯çš„å¯†ç å­˜å‚¨æ–¹å¼**ï¼š
```java
// âŒ æ˜æ–‡å­˜å‚¨
user.setPassword("123456");

// âŒ ç®€å•åŠ å¯†
user.setPassword(md5(password));

// âŒ å›ºå®šç›å€¼
user.setPassword(sha256(password + "fixedSalt"));
```

**æ­£ç¡®çš„å¯†ç å­˜å‚¨æ–¹å¼**ï¼š
```java
@Service
public class PasswordService {
    
    private final BCryptPasswordEncoder encoder = new BCryptPasswordEncoder(12);
    
    // å¯†ç åŠ å¯†å­˜å‚¨
    public String encodePassword(String rawPassword) {
        // BCryptè‡ªåŠ¨ç”Ÿæˆéšæœºç›å€¼
        return encoder.encode(rawPassword);
    }
    
    // å¯†ç éªŒè¯
    public boolean verifyPassword(String rawPassword, String encodedPassword) {
        return encoder.matches(rawPassword, encodedPassword);
    }
}

// ä½¿ç”¨ç¤ºä¾‹
String hashedPassword = passwordService.encodePassword("userInput123");
// å­˜å‚¨ç»“æœï¼š$2a$12$Xv4V8J7GXzV7YG1K9oJ7Y.8L9mJ7YG1K9oJ7Y8L9mJ7YG1K9oJ7Y
```

### 6.2 å¯†é’¥ç®¡ç†å®è·µ


**å¯†é’¥ç”Ÿæˆä¸å­˜å‚¨**ï¼š
```java
public class KeyManager {
    
    // ç”Ÿæˆå®‰å…¨çš„éšæœºå¯†é’¥
    public static String generateSecretKey(int length) {
        SecureRandom random = new SecureRandom();
        byte[] key = new byte[length];
        random.nextBytes(key);
        return Base64.getEncoder().encodeToString(key);
    }
    
    // ä»ç¯å¢ƒå˜é‡è·å–å¯†é’¥
    public static String getEncryptionKey() {
        String key = System.getenv("ENCRYPTION_KEY");
        if (key == null || key.length() < 32) {
            throw new IllegalStateException("åŠ å¯†å¯†é’¥æœªé…ç½®æˆ–é•¿åº¦ä¸è¶³");
        }
        return key;
    }
}
```

### 6.3 å¯†ç ç­–ç•¥å®æ–½


```java
public class PasswordPolicy {
    
    public static boolean isStrongPassword(String password) {
        if (password == null || password.length() < 8) {
            return false;
        }
        
        boolean hasUpper = false;
        boolean hasLower = false; 
        boolean hasDigit = false;
        boolean hasSpecial = false;
        
        for (char c : password.toCharArray()) {
            if (Character.isUpperCase(c)) hasUpper = true;
            else if (Character.isLowerCase(c)) hasLower = true;
            else if (Character.isDigit(c)) hasDigit = true;
            else if ("!@#$%^&*()_+-=[]{}|;:,.<>?".indexOf(c) >= 0) hasSpecial = true;
        }
        
        return hasUpper && hasLower && hasDigit && hasSpecial;
    }
    
    public static List<String> getPasswordRequirements() {
        return Arrays.asList(
            "è‡³å°‘8ä½é•¿åº¦",
            "åŒ…å«å¤§å†™å­—æ¯", 
            "åŒ…å«å°å†™å­—æ¯",
            "åŒ…å«æ•°å­—",
            "åŒ…å«ç‰¹æ®Šå­—ç¬¦"
        );
    }
}
```

---

## 7. ğŸš« æ‹’ç»é»˜è®¤ä¿¡ä»»åŸåˆ™


### 7.1 é›¶ä¿¡ä»»åŸºæœ¬ç†å¿µ


**ä¼ ç»Ÿä¿¡ä»»æ¨¡å¼ vs é›¶ä¿¡ä»»æ¨¡å¼**ï¼š
```
ä¼ ç»Ÿæ¨¡å¼ï¼š
å†…ç½‘ = å®‰å…¨ âœ“
å¤–ç½‘ = å±é™© âŒ
ç½‘ç»œè¾¹ç•Œé˜²æŠ¤

é›¶ä¿¡ä»»æ¨¡å¼ï¼š
ä»»ä½•ç”¨æˆ· = éœ€éªŒè¯ ğŸ”
ä»»ä½•è®¾å¤‡ = éœ€éªŒè¯ ğŸ”  
ä»»ä½•ç½‘ç»œ = éœ€éªŒè¯ ğŸ”
æŒç»­éªŒè¯
```

### 7.2 èº«ä»½éªŒè¯å¼ºåŒ–


**å¤šå› ç´ è®¤è¯å®ç°**ï¼š
```java
@Service
public class AuthenticationService {
    
    // ç¬¬ä¸€æ­¥ï¼šç”¨æˆ·åå¯†ç éªŒè¯
    public boolean validateCredentials(String username, String password) {
        User user = userRepository.findByUsername(username);
        return user != null && passwordService.verifyPassword(password, user.getPassword());
    }
    
    // ç¬¬äºŒæ­¥ï¼šçŸ­ä¿¡éªŒè¯ç 
    public boolean validateSmsCode(String phone, String code) {
        String storedCode = redisTemplate.opsForValue().get("sms:" + phone);
        return code.equals(storedCode);
    }
    
    // ç¬¬ä¸‰æ­¥ï¼šè®¾å¤‡æŒ‡çº¹éªŒè¯
    public boolean validateDeviceFingerprint(String userId, String fingerprint) {
        List<String> trustedDevices = deviceRepository.getTrustedDevices(userId);
        return trustedDevices.contains(fingerprint);
    }
}
```

### 7.3 APIè®¿é—®æ§åˆ¶


```java
@RestController
public class SecureApiController {
    
    @Autowired
    private TokenValidator tokenValidator;
    
    @PostMapping("/api/sensitive-data")
    public ResponseEntity<?> getSensitiveData(
            @RequestHeader("Authorization") String token,
            @RequestHeader("X-Device-ID") String deviceId,
            HttpServletRequest request) {
        
        // 1. éªŒè¯è®¿é—®ä»¤ç‰Œ
        if (!tokenValidator.isValidToken(token)) {
            return ResponseEntity.status(401).body("æ— æ•ˆçš„è®¿é—®ä»¤ç‰Œ");
        }
        
        // 2. æ£€æŸ¥è®¾å¤‡ID
        String userId = tokenValidator.getUserId(token);
        if (!deviceValidator.isTrustedDevice(userId, deviceId)) {
            return ResponseEntity.status(403).body("æœªæˆæƒçš„è®¾å¤‡");
        }
        
        // 3. æ£€æŸ¥IPåœ°å€
        String clientIp = getClientIpAddress(request);
        if (ipBlacklistService.isBlocked(clientIp)) {
            return ResponseEntity.status(403).body("IPåœ°å€è¢«é˜»æ­¢");
        }
        
        // 4. æ£€æŸ¥è®¿é—®é¢‘ç‡
        if (rateLimitService.isExceeded(userId)) {
            return ResponseEntity.status(429).body("è®¿é—®é¢‘ç‡è¶…é™");
        }
        
        // æ‰€æœ‰æ£€æŸ¥é€šè¿‡ï¼Œè¿”å›æ•°æ®
        return ResponseEntity.ok(dataService.getSensitiveData(userId));
    }
}
```

---

## 8. ğŸ”’ é”™è¯¯ä¿¡æ¯ä¸æš´éœ²ç»†èŠ‚ç­–ç•¥


### 8.1 é€šç”¨é”™è¯¯å“åº”


**ç»Ÿä¸€é”™è¯¯å“åº”æ ¼å¼**ï¼š
```java
public class ApiResponse<T> {
    private int code;
    private String message;
    private T data;
    private String timestamp;
    
    // æˆåŠŸå“åº”
    public static <T> ApiResponse<T> success(T data) {
        return new ApiResponse<>(200, "æ“ä½œæˆåŠŸ", data, getCurrentTime());
    }
    
    // é€šç”¨é”™è¯¯å“åº”
    public static ApiResponse<?> error(int code, String message) {
        return new ApiResponse<>(code, message, null, getCurrentTime());
    }
    
    // é¢„å®šä¹‰é”™è¯¯ç±»å‹
    public static ApiResponse<?> unauthorized() {
        return error(401, "èº«ä»½éªŒè¯å¤±è´¥");
    }
    
    public static ApiResponse<?> forbidden() {
        return error(403, "è®¿é—®è¢«æ‹’ç»");
    }
    
    public static ApiResponse<?> notFound() {
        return error(404, "èµ„æºä¸å­˜åœ¨");
    }
    
    public static ApiResponse<?> serverError() {
        return error(500, "ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åé‡è¯•");
    }
}
```

### 8.2 é”™è¯¯ä»£ç æ˜ å°„


```java
public enum ErrorCode {
    // è®¤è¯ç›¸å…³
    INVALID_CREDENTIALS(1001, "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"),
    TOKEN_EXPIRED(1002, "ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•"),
    INSUFFICIENT_PRIVILEGES(1003, "æƒé™ä¸è¶³"),
    
    // å‚æ•°ç›¸å…³  
    INVALID_PARAMETER(2001, "è¯·æ±‚å‚æ•°é”™è¯¯"),
    MISSING_PARAMETER(2002, "ç¼ºå°‘å¿…è¦å‚æ•°"),
    
    // ä¸šåŠ¡ç›¸å…³
    RESOURCE_NOT_FOUND(3001, "è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨"),
    OPERATION_FAILED(3002, "æ“ä½œå¤±è´¥"),
    
    // ç³»ç»Ÿç›¸å…³
    SYSTEM_ERROR(5001, "ç³»ç»Ÿæš‚æ—¶ä¸å¯ç”¨"),
    SERVICE_UNAVAILABLE(5002, "æœåŠ¡æš‚æ—¶ä¸å¯ç”¨");
    
    private final int code;
    private final String message;
    
    ErrorCode(int code, String message) {
        this.code = code;
        this.message = message;
    }
}
```

### 8.3 å®‰å…¨æ—¥å¿—è®°å½•


```java
public class SecurityAuditLogger {
    
    private static final Logger auditLog = LoggerFactory.getLogger("AUDIT");
    
    // è®°å½•å®‰å…¨äº‹ä»¶ï¼ˆä¸åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼‰
    public static void logSecurityEvent(String eventType, String username, 
                                       String ip, boolean success) {
        Map<String, Object> event = new HashMap<>();
        event.put("timestamp", Instant.now());
        event.put("eventType", eventType);
        event.put("username", username);
        event.put("sourceIp", ip);
        event.put("success", success);
        event.put("sessionId", getCurrentSessionId());
        
        auditLog.info("å®‰å…¨äº‹ä»¶: {}", JsonUtils.toJson(event));
    }
    
    // è®°å½•æ•æ„Ÿæ“ä½œ
    public static void logSensitiveOperation(String operation, String username, 
                                           String resource) {
        auditLog.warn("æ•æ„Ÿæ“ä½œ - æ“ä½œ: {}, ç”¨æˆ·: {}, èµ„æº: {}, æ—¶é—´: {}", 
                     operation, username, resource, Instant.now());
    }
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„å®‰å…¨ç¼–ç åŸåˆ™


```
ğŸ”¸ æœ€å°æƒé™åŸåˆ™ï¼šç»™äºˆåˆšå¥½å¤Ÿç”¨çš„æƒé™ï¼Œä¸å¤šä¸å°‘
ğŸ”¸ è¾“å…¥éªŒè¯ï¼šæ°¸è¿œä¸ä¿¡ä»»ç”¨æˆ·è¾“å…¥ï¼Œä¸¥æ ¼éªŒè¯æ‰€æœ‰æ•°æ®
ğŸ”¸ è¾“å‡ºç¼–ç ï¼šé˜²æ­¢XSSç­‰æ³¨å…¥æ”»å‡»ï¼Œå¯¹è¾“å‡ºè¿›è¡Œç¼–ç 
ğŸ”¸ é”™è¯¯å¤„ç†ï¼šä¸æš´éœ²ç³»ç»Ÿå†…éƒ¨ä¿¡æ¯ï¼Œç»Ÿä¸€é”™è¯¯å“åº”
ğŸ”¸ å®‰å…¨é…ç½®ï¼šåˆç†é…ç½®ç³»ç»Ÿå‚æ•°ï¼Œé¿å…ä½¿ç”¨é»˜è®¤è®¾ç½®
ğŸ”¸ å¯†ç ç®¡ç†ï¼šä½¿ç”¨å¼ºåŠ å¯†ç®—æ³•ï¼Œå®‰å…¨å­˜å‚¨å¯†ç å’Œå¯†é’¥
ğŸ”¸ é›¶ä¿¡ä»»åŸåˆ™ï¼šä¸ä¿¡ä»»ä»»ä½•ç”¨æˆ·ã€è®¾å¤‡æˆ–ç½‘ç»œ
ğŸ”¸ ä¿¡æ¯ä¿æŠ¤ï¼šé”™è¯¯ä¿¡æ¯ä¸æš´éœ²ç³»ç»Ÿç»†èŠ‚
```

### 9.2 å®‰å…¨ç¼–ç æ£€æŸ¥æ¸…å•


**ä»£ç å®¡æŸ¥è¦ç‚¹**ï¼š
- âœ… æ‰€æœ‰ç”¨æˆ·è¾“å…¥éƒ½ç»è¿‡éªŒè¯
- âœ… æ‰€æœ‰è¾“å‡ºéƒ½ç»è¿‡ç¼–ç 
- âœ… æ•æ„Ÿæ•°æ®éƒ½ç»è¿‡åŠ å¯†
- âœ… é”™è¯¯ä¿¡æ¯ä¸æš´éœ²å†…éƒ¨ç»“æ„
- âœ… æƒé™æ£€æŸ¥è¦†ç›–æ‰€æœ‰å…³é”®æ“ä½œ
- âœ… æ—¥å¿—è®°å½•ä¸åŒ…å«æ•æ„Ÿä¿¡æ¯
- âœ… é…ç½®æ–‡ä»¶ä¸åŒ…å«ç¡¬ç¼–ç å¯†ç 
- âœ… å¼‚å¸¸å¤„ç†ç»Ÿä¸€ä¸”å®‰å…¨

### 9.3 å¸¸è§å®‰å…¨é™·é˜±


**å®¹æ˜“å¿½ç•¥çš„å®‰å…¨é—®é¢˜**ï¼š
```
âŒ ä¿¡ä»»å†…ç½‘è¯·æ±‚
âŒ ç›´æ¥æ‹¼æ¥SQLè¯­å¥  
âŒ æ˜æ–‡å­˜å‚¨å¯†ç 
âŒ è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
âŒ è¿‡åº¦çš„æƒé™æˆäºˆ
âŒ ç¡¬ç¼–ç çš„å¯†é’¥
âŒ æœªéªŒè¯çš„æ–‡ä»¶ä¸Šä¼ 
âŒ ç¼ºå°‘è®¿é—®æ§åˆ¶
```

### 9.4 å®‰å…¨å¼€å‘æœ€ä½³å®è·µ


**å¼€å‘æµç¨‹é›†æˆ**ï¼š
```
éœ€æ±‚åˆ†æ â†’ å¨èƒå»ºæ¨¡ â†’ å®‰å…¨è®¾è®¡ â†’ å®‰å…¨ç¼–ç  â†’ 
ä»£ç å®¡æŸ¥ â†’ å®‰å…¨æµ‹è¯• â†’ éƒ¨ç½²é…ç½® â†’ ç›‘æ§è¿ç»´
```

**å›¢é˜Ÿåä½œ**ï¼š
- ğŸ”¸ **å®‰å…¨åŸ¹è®­**ï¼šå®šæœŸè¿›è¡Œå®‰å…¨çŸ¥è¯†åŸ¹è®­
- ğŸ”¸ **ä»£ç è¯„å®¡**ï¼šå¼ºåˆ¶æ€§çš„å®‰å…¨ä»£ç å®¡æŸ¥
- ğŸ”¸ **å®‰å…¨å·¥å…·**ï¼šä½¿ç”¨é™æ€ä»£ç åˆ†æå·¥å…·
- ğŸ”¸ **æŒç»­æ”¹è¿›**ï¼šå»ºç«‹å®‰å…¨åé¦ˆæœºåˆ¶

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
è¾“å…¥éªŒè¯æ˜¯åŸºç¡€ï¼Œè¾“å‡ºç¼–ç é˜²æ³¨å…¥
æœ€å°æƒé™æ§èŒƒå›´ï¼Œé”™è¯¯å¤„ç†è¦ç»Ÿä¸€
å¯†ç åŠ å¯†å¼ºåº¦é«˜ï¼Œé…ç½®å®‰å…¨ä¸é»˜è®¤
é›¶ä¿¡ä»»éªŒè¯ä¸¥ï¼Œæ—¥å¿—è®°å½•ä¸æ³„å¯†
```