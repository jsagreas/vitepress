---
title: 3ã€APIå®‰å…¨é˜²æŠ¤ä½“ç³»
---
## ğŸ“š ç›®å½•

1. [APIå®‰å…¨åŸºç¡€æ¦‚å¿µ](#1-APIå®‰å…¨åŸºç¡€æ¦‚å¿µ)
2. [åç«¯å¼ºåˆ¶æƒé™æ ¡éªŒ](#2-åç«¯å¼ºåˆ¶æƒé™æ ¡éªŒ)
3. [æ¥å£åˆ†çº§ä¸æˆæƒç­–ç•¥](#3-æ¥å£åˆ†çº§ä¸æˆæƒç­–ç•¥)
4. [å‚æ•°åŠ å¯†ä¸æ•°æ®ä¿æŠ¤](#4-å‚æ•°åŠ å¯†ä¸æ•°æ®ä¿æŠ¤)
5. [æ¥å£ç­¾åéªŒè¯æœºåˆ¶](#5-æ¥å£ç­¾åéªŒè¯æœºåˆ¶)
6. [å‰ç«¯æƒé™æ ¡éªŒé™åˆ¶](#6-å‰ç«¯æƒé™æ ¡éªŒé™åˆ¶)
7. [APIç›‘æ§ä¸æ—¥å¿—å®¡è®¡](#7-APIç›‘æ§ä¸æ—¥å¿—å®¡è®¡)
8. [å®‰å…¨å¼€å‘ç”Ÿå‘½å‘¨æœŸSDL](#8-å®‰å…¨å¼€å‘ç”Ÿå‘½å‘¨æœŸSDL)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ›¡ï¸ APIå®‰å…¨åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯APIå®‰å…¨


**ğŸ” ç®€å•ç†è§£**
APIå°±åƒæ˜¯**é¤å…çš„æœåŠ¡å‘˜**ï¼Œå®¢æˆ·ï¼ˆå‰ç«¯ï¼‰é€šè¿‡æœåŠ¡å‘˜ï¼ˆAPIï¼‰å‘å¨æˆ¿ï¼ˆåç«¯ï¼‰ç‚¹é¤ã€‚APIå®‰å…¨å°±æ˜¯è¦ç¡®ä¿ï¼š
- åªæœ‰**åˆæ³•å®¢æˆ·**èƒ½ç‚¹é¤
- å®¢æˆ·åªèƒ½ç‚¹**å…è®¸çš„èœå“**
- **èœå“ä¿¡æ¯**ä¸ä¼šè¢«æ³„éœ²æˆ–ç¯¡æ”¹

**ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µ**
```
APIï¼ˆApplication Programming Interfaceï¼‰ï¼š
ç®€å•è¯´å°±æ˜¯ç¨‹åºä¹‹é—´å¯¹è¯çš„"ç¿»è¯‘å®˜"
è®©ä¸åŒçš„è½¯ä»¶èƒ½å¤Ÿäº’ç›¸äº¤æµå’Œä¼ é€’æ•°æ®

APIå®‰å…¨å¨èƒï¼š
ğŸš¨ èº«ä»½ä¼ªé€ ï¼šå‡å†’åˆæ³•ç”¨æˆ·
ğŸš¨ æƒé™è¶Šç•Œï¼šè®¿é—®ä¸è¯¥çœ‹çš„æ•°æ®  
ğŸš¨ æ•°æ®æ³„éœ²ï¼šæ•æ„Ÿä¿¡æ¯è¢«çªƒå–
ğŸš¨ æ¥å£æ»¥ç”¨ï¼šæ¶æ„å¤§é‡è°ƒç”¨
```

### 1.2 å¸¸è§APIå®‰å…¨é£é™©


**ğŸ¯ é«˜å±é£é™©åœºæ™¯**

| é£é™©ç±»å‹ | å…·ä½“è¡¨ç° | å±å®³ç¨‹åº¦ |
|---------|---------|---------|
| ğŸ”´ **æƒé™ç»•è¿‡** | ç›´æ¥è°ƒç”¨ç®¡ç†å‘˜æ¥å£ | æé«˜ |
| ğŸ”´ **æ•°æ®æ³„éœ²** | è·å–ä»–äººéšç§ä¿¡æ¯ | æé«˜ |
| ğŸŸ¡ **æ¥å£æ»¥ç”¨** | é¢‘ç¹è°ƒç”¨å¯¼è‡´æœåŠ¡å™¨å´©æºƒ | ä¸­ç­‰ |
| ğŸŸ¡ **å‚æ•°ç¯¡æ”¹** | ä¿®æ”¹è¯·æ±‚æ•°æ®è·å–éæ³•æ”¶ç›Š | ä¸­ç­‰ |

**ğŸ’€ çœŸå®æ”»å‡»ç¤ºä¾‹**
```
åœºæ™¯ï¼šæŸç”µå•†APPç”¨æˆ·ä¿¡æ¯æ¥å£
æ­£å¸¸è¯·æ±‚ï¼šGET /api/user/123  (è·å–ç”¨æˆ·123çš„ä¿¡æ¯)
æ¶æ„è¯·æ±‚ï¼šGET /api/user/456  (å°è¯•è·å–å…¶ä»–ç”¨æˆ·ä¿¡æ¯)

å¦‚æœæ²¡æœ‰æƒé™æ ¡éªŒï¼š
æ”»å‡»è€…å¯ä»¥éå†ç”¨æˆ·IDï¼Œè·å–æ‰€æœ‰ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ï¼
```

---

## 2. ğŸ”’ åç«¯å¼ºåˆ¶æƒé™æ ¡éªŒ


### 2.1 ä¸ºä»€ä¹ˆåç«¯æ ¡éªŒæ˜¯æ ¸å¿ƒ


**ğŸ¯ åŸºæœ¬åŸç†**

> **ğŸ’¡ å®‰å…¨é“å¾‹**ï¼šæ°¸è¿œä¸è¦ç›¸ä¿¡å‰ç«¯ï¼
> 
> å‰ç«¯å°±åƒå•†åº—çš„**å±•ç¤ºæŸœ**ï¼Œç¾è§‚ä½†ä¸å®‰å…¨
> åç«¯æ˜¯çœŸæ­£çš„**ä¿é™©æŸœ**ï¼Œå¿…é¡»å±‚å±‚æŠŠå…³

**âš ï¸ å‰ç«¯æ ¡éªŒçš„å±€é™æ€§**
```
å‰ç«¯æƒé™æ§åˆ¶ï¼š
âŒ ç”¨æˆ·å¯ä»¥ç¦ç”¨JavaScript
âŒ å¯ä»¥ä¿®æ”¹å‰ç«¯ä»£ç 
âŒ å¯ä»¥ç›´æ¥è°ƒç”¨APIæ¥å£
âŒ æ‰€æœ‰é€»è¾‘éƒ½æ˜¯é€æ˜çš„

åç«¯æƒé™æ§åˆ¶ï¼š
âœ… æœåŠ¡å™¨ç«¯æ‰§è¡Œï¼Œæ— æ³•ç»•è¿‡
âœ… ä»£ç ä¸å¯è§ï¼Œé€»è¾‘å®‰å…¨
âœ… æ¯æ¬¡è¯·æ±‚éƒ½ä¼šæ£€æŸ¥
âœ… æ˜¯æœ€åä¸€é“é˜²çº¿
```

### 2.2 åç«¯æƒé™æ ¡éªŒæ ¸å¿ƒæœºåˆ¶


**ğŸ”§ æƒé™æ ¡éªŒæµç¨‹**

```
å®¢æˆ·ç«¯è¯·æ±‚                åç«¯å¤„ç†æµç¨‹
     |                       |
     |--[1]å‘é€è¯·æ±‚--------->|--[èº«ä»½éªŒè¯]
     |   (å¸¦Token)           |   éªŒè¯Tokenæœ‰æ•ˆæ€§
     |                       |
     |                       |--[æƒé™æ£€æŸ¥]
     |                       |   æ£€æŸ¥æ˜¯å¦æœ‰è®¿é—®æƒé™
     |                       |
     |                       |--[ä¸šåŠ¡å¤„ç†]
     |                       |   æ‰§è¡Œå…·ä½“ä¸šåŠ¡é€»è¾‘
     |                       |
     |<--[2]è¿”å›ç»“æœ----------|--[è¿”å›æ•°æ®]
     |                       |   è¿”å›å¤„ç†ç»“æœ
```

**ğŸ’» ç®€å•ä»£ç ç¤ºä¾‹**
```java
@GetMapping("/api/user/{userId}")
public ResponseEntity getUserInfo(@PathVariable Long userId, 
                                 HttpServletRequest request) {
    // ç¬¬ä¸€æ­¥ï¼šèº«ä»½éªŒè¯
    String token = request.getHeader("Authorization");
    User currentUser = authService.validateToken(token);
    if (currentUser == null) {
        return ResponseEntity.status(401).body("æœªç™»å½•");
    }
    
    // ç¬¬äºŒæ­¥ï¼šæƒé™æ£€æŸ¥
    if (!currentUser.getId().equals(userId) && !currentUser.isAdmin()) {
        return ResponseEntity.status(403).body("æƒé™ä¸è¶³");
    }
    
    // ç¬¬ä¸‰æ­¥ï¼šä¸šåŠ¡å¤„ç†
    User userInfo = userService.getUserById(userId);
    return ResponseEntity.ok(userInfo);
}
```

### 2.3 æƒé™æ ¡éªŒæœ€ä½³å®è·µ


**ğŸ¯ é˜²æŠ¤ç­–ç•¥**

**â‘  é»˜è®¤æ‹’ç»åŸåˆ™**
```java
// âŒ é”™è¯¯åšæ³•ï¼šé»˜è®¤å…è®¸
if (user.hasPermission("admin")) {
    // å…è®¸è®¿é—®
}
// å…¶ä»–æƒ…å†µé»˜è®¤å…è®¸ - å¾ˆå±é™©ï¼

// âœ… æ­£ç¡®åšæ³•ï¼šé»˜è®¤æ‹’ç»
if (!user.hasPermission("read_user")) {
    return "æƒé™ä¸è¶³";
}
// åªæœ‰æ˜ç¡®æœ‰æƒé™æ‰å…è®¸
```

**â‘¡ å¤šå±‚æƒé™æ£€æŸ¥**
```java
// æ£€æŸ¥é¡ºåºï¼šèº«ä»½ -> è§’è‰² -> å…·ä½“æƒé™ -> æ•°æ®æƒé™
public boolean canAccessUser(User currentUser, Long targetUserId) {
    // 1. èº«ä»½æ£€æŸ¥
    if (currentUser == null) return false;
    
    // 2. è‡ªå·±çš„æ•°æ®æ€»æ˜¯å¯ä»¥è®¿é—®
    if (currentUser.getId().equals(targetUserId)) return true;
    
    // 3. ç®¡ç†å‘˜å¯ä»¥è®¿é—®æ‰€æœ‰ç”¨æˆ·
    if (currentUser.hasRole("ADMIN")) return true;
    
    // 4. éƒ¨é—¨ç»ç†å¯ä»¥è®¿é—®æœ¬éƒ¨é—¨ç”¨æˆ·
    if (currentUser.hasRole("MANAGER")) {
        return sameOrganization(currentUser, targetUserId);
    }
    
    return false; // é»˜è®¤æ‹’ç»
}
```

---

## 3. ğŸ“Š æ¥å£åˆ†çº§ä¸æˆæƒç­–ç•¥


### 3.1 æ¥å£åˆ†çº§çš„å¿…è¦æ€§


**ğŸ¯ ä¸ºä»€ä¹ˆè¦åˆ†çº§**

æƒ³è±¡ä¸€ä¸ª**å›¾ä¹¦é¦†**ï¼š
- ğŸ“– **æ™®é€šå›¾ä¹¦**ï¼šä»»ä½•äººéƒ½èƒ½å€Ÿé˜…
- ğŸ“š **çè´µå›¾ä¹¦**ï¼šéœ€è¦ç‰¹æ®Šè¯ä»¶
- ğŸ”’ **ç»å¯†æ¡£æ¡ˆ**ï¼šåªæœ‰é¦†é•¿èƒ½çœ‹

APIæ¥å£ä¹Ÿæ˜¯ä¸€æ ·ï¼Œä¸åŒçš„æ¥å£éœ€è¦**ä¸åŒçº§åˆ«çš„ä¿æŠ¤**ã€‚

**ğŸ“‹ æ¥å£æ•æ„Ÿåº¦åˆ†çº§**

| çº§åˆ« | è¯´æ˜ | ç¤ºä¾‹æ¥å£ | é˜²æŠ¤è¦æ±‚ |
|------|------|----------|----------|
| ğŸŸ¢ **L1-å…¬å¼€** | æ— æ•æ„Ÿæ•°æ® | è·å–å•†å“åˆ—è¡¨ | åŸºç¡€é™æµ |
| ğŸŸ¡ **L2-å—é™** | ç”¨æˆ·ä¸ªäººæ•°æ® | è·å–ä¸ªäººè®¢å• | èº«ä»½éªŒè¯+æƒé™æ ¡éªŒ |
| ğŸŸ  **L3-æ•æ„Ÿ** | æ¶‰åŠèµ„é‡‘æ“ä½œ | å‘èµ·è½¬è´¦ | å¼ºèº«ä»½éªŒè¯+å¤šé‡æ ¡éªŒ |
| ğŸ”´ **L4-æ ¸å¿ƒ** | ç³»ç»Ÿç®¡ç†åŠŸèƒ½ | ç”¨æˆ·æƒé™ç®¡ç† | æœ€é«˜çº§åˆ«é˜²æŠ¤ |

### 3.2 åˆ†çº§æˆæƒç­–ç•¥è®¾è®¡


**ğŸ”§ æƒé™æ¨¡å‹è®¾è®¡**

```
æƒé™å±‚æ¬¡ç»“æ„ï¼š
                        [ç³»ç»Ÿç®¡ç†å‘˜]
                             |
                    [ä¸šåŠ¡ç®¡ç†å‘˜] [å®‰å…¨ç®¡ç†å‘˜]
                         |           |
              [éƒ¨é—¨ç»ç†] [è´¢åŠ¡ç»ç†] [å®¡è®¡å‘˜]
                  |         |        |
            [æ™®é€šå‘˜å·¥] [ä¼šè®¡] [å®‰å…¨ä¸“å‘˜]
                  |
            [ä¸´æ—¶ç”¨æˆ·]
```

**ğŸ’¡ æˆæƒç­–ç•¥é…ç½®**
```java
// æ¥å£æƒé™é…ç½®ç¤ºä¾‹
@RestController
public class UserController {
    
    // L1çº§åˆ«ï¼šå…¬å¼€æ¥å£ï¼Œåªéœ€è¦åŸºç¡€é™æµ
    @GetMapping("/api/public/users/count")
    @RateLimited(requests = 1000, per = "1h") // æ¯å°æ—¶1000æ¬¡
    public Long getUserCount() {
        return userService.getPublicUserCount();
    }
    
    // L2çº§åˆ«ï¼šéœ€è¦ç™»å½•
    @GetMapping("/api/user/profile")
    @RequireAuth // éœ€è¦èº«ä»½éªŒè¯
    public UserProfile getMyProfile() {
        return userService.getCurrentUserProfile();
    }
    
    // L3çº§åˆ«ï¼šæ•æ„Ÿæ“ä½œï¼Œéœ€è¦ç‰¹æ®Šæƒé™
    @PostMapping("/api/user/transfer")
    @RequirePermission("FINANCIAL_OPERATION") // éœ€è¦è´¢åŠ¡æ“ä½œæƒé™
    @RequireSecondAuth // éœ€è¦äºŒæ¬¡éªŒè¯
    public TransferResult transfer(@RequestBody TransferRequest request) {
        return transferService.processTransfer(request);
    }
    
    // L4çº§åˆ«ï¼šæ ¸å¿ƒç®¡ç†åŠŸèƒ½
    @PostMapping("/api/admin/users/{id}/permissions")
    @RequireRole("SYSTEM_ADMIN") // éœ€è¦ç³»ç»Ÿç®¡ç†å‘˜è§’è‰²
    @AuditLog("ç”¨æˆ·æƒé™å˜æ›´") // è®°å½•å®¡è®¡æ—¥å¿—
    public void updateUserPermissions(@PathVariable Long id, 
                                    @RequestBody PermissionRequest request) {
        adminService.updateUserPermissions(id, request);
    }
}
```

### 3.3 åŠ¨æ€æƒé™æ§åˆ¶


**ğŸ¯ çµæ´»çš„æƒé™ç­–ç•¥**

**â‘  åŸºäºæ—¶é—´çš„æƒé™**
```java
// å·¥ä½œæ—¶é—´æ‰èƒ½è®¿é—®çš„æ¥å£
@GetMapping("/api/admin/sensitive-data")
@RequireWorkingHours(start = "09:00", end = "18:00")
public SensitiveData getSensitiveData() {
    return dataService.getSensitiveData();
}
```

**â‘¡ åŸºäºä½ç½®çš„æƒé™**
```java
// åªèƒ½åœ¨åŠå…¬ç½‘ç»œè®¿é—®çš„æ¥å£
@PostMapping("/api/admin/system-config")
@RequireInternalNetwork // åªå…è®¸å†…ç½‘IPè®¿é—®
public void updateSystemConfig(@RequestBody ConfigRequest request) {
    configService.updateConfig(request);
}
```

**â‘¢ åŸºäºè®¾å¤‡çš„æƒé™**
```java
// éœ€è¦å¯ä¿¡è®¾å¤‡çš„æ¥å£
@PostMapping("/api/high-value-operation")
@RequireTrustedDevice // éœ€è¦è®¾å¤‡è®¤è¯
public OperationResult performHighValueOperation() {
    return operationService.execute();
}
```

---

## 4. ğŸ” å‚æ•°åŠ å¯†ä¸æ•°æ®ä¿æŠ¤


### 4.1 ä¸ºä»€ä¹ˆéœ€è¦å‚æ•°åŠ å¯†


**ğŸ¯ æ•°æ®ä¼ è¾“é£é™©**

æƒ³è±¡ä½ åœ¨**é‚®å¯„é‡è¦æ–‡ä»¶**ï¼š
- ğŸ“® **æ˜æ–‡ä¼ è¾“**ï¼šå°±åƒç”¨é€æ˜ä¿¡å°ï¼Œä»»ä½•äººéƒ½èƒ½çœ‹åˆ°å†…å®¹
- ğŸ”’ **åŠ å¯†ä¼ è¾“**ï¼šå°±åƒç”¨ä¿é™©ç®±ï¼Œåªæœ‰æ”¶ä»¶äººèƒ½æ‰“å¼€

**âš ï¸ å¸¸è§æ•°æ®æ³„éœ²åœºæ™¯**
```
åœºæ™¯1ï¼šç½‘ç»œç›‘å¬
é»‘å®¢åœ¨Wi-Fiçƒ­ç‚¹ç›‘å¬æ•°æ®åŒ…
æ˜æ–‡å¯†ç ã€é“¶è¡Œå¡å·ç­‰æ•æ„Ÿä¿¡æ¯ç›´æ¥æš´éœ²

åœºæ™¯2ï¼šæ—¥å¿—æ³„éœ²  
æœåŠ¡å™¨æ—¥å¿—è®°å½•äº†æ˜æ–‡è¯·æ±‚å‚æ•°
å†…éƒ¨äººå‘˜æˆ–æ”»å‡»è€…è·å–æ—¥å¿—åçœ‹åˆ°æ•æ„Ÿæ•°æ®

åœºæ™¯3ï¼šç¼“å­˜æ³„éœ²
ä»£ç†æœåŠ¡å™¨æˆ–CDNç¼“å­˜äº†å«æ•æ„Ÿä¿¡æ¯çš„è¯·æ±‚
ç¼“å­˜è¢«æ”»å‡»è€…è·å–åæ•°æ®æ³„éœ²
```

### 4.2 å‚æ•°åŠ å¯†å®ç°æ–¹æ¡ˆ


**ğŸ”§ åˆ†å±‚åŠ å¯†ç­–ç•¥**

```
ä¼ è¾“å±‚åŠ å¯†ï¼ˆHTTPSï¼‰
    â†“
åº”ç”¨å±‚åŠ å¯†ï¼ˆå‚æ•°åŠ å¯†ï¼‰
    â†“
å­˜å‚¨å±‚åŠ å¯†ï¼ˆæ•°æ®åº“åŠ å¯†ï¼‰
```

**ğŸ’» ç®€å•åŠ å¯†ç¤ºä¾‹**
```java
// å‰ç«¯åŠ å¯†æ•æ„Ÿå‚æ•°
public class ParameterEncryption {
    
    // AESåŠ å¯†æ•æ„Ÿå‚æ•°
    public static String encryptParam(String plainText, String key) {
        try {
            Cipher cipher = Cipher.getInstance("AES/ECB/PKCS5Padding");
            SecretKeySpec secretKey = new SecretKeySpec(key.getBytes(), "AES");
            cipher.init(Cipher.ENCRYPT_MODE, secretKey);
            byte[] encrypted = cipher.doFinal(plainText.getBytes());
            return Base64.getEncoder().encodeToString(encrypted);
        } catch (Exception e) {
            throw new RuntimeException("åŠ å¯†å¤±è´¥", e);
        }
    }
    
    // åç«¯è§£å¯†å‚æ•°
    public static String decryptParam(String encryptedText, String key) {
        try {
            Cipher cipher = Cipher.getInstance("AES/ECB/PKCS5Padding");
            SecretKeySpec secretKey = new SecretKeySpec(key.getBytes(), "AES");
            cipher.init(Cipher.DECRYPT_MODE, secretKey);
            byte[] decrypted = cipher.doFinal(Base64.getDecoder().decode(encryptedText));
            return new String(decrypted);
        } catch (Exception e) {
            throw new RuntimeException("è§£å¯†å¤±è´¥", e);
        }
    }
}
```

### 4.3 æ•°æ®ä¿æŠ¤æœ€ä½³å®è·µ


**ğŸ›¡ï¸ æ•æ„Ÿæ•°æ®å¤„ç†åŸåˆ™**

**â‘  æ•°æ®åˆ†ç±»ä¿æŠ¤**
```java
public class UserData {
    public String username;           // æ™®é€šæ•°æ®ï¼šæ˜æ–‡å­˜å‚¨
    
    @Encrypted
    public String phoneNumber;        // æ•æ„Ÿæ•°æ®ï¼šåŠ å¯†å­˜å‚¨
    
    @Hashed
    public String password;           // æœºå¯†æ•°æ®ï¼šå“ˆå¸Œå­˜å‚¨
    
    @Masked(pattern = "****")
    public String bankCard;           // æ˜¾ç¤ºæ—¶è„±æ•
}
```

**â‘¡ ä¼ è¾“è¿‡ç¨‹ä¿æŠ¤**
```java
@PostMapping("/api/user/payment")
public PaymentResult processPayment(@RequestBody @Encrypted PaymentRequest request) {
    // è‡ªåŠ¨è§£å¯†æ•æ„Ÿå‚æ•°
    String decryptedCardNumber = request.getCardNumber();
    
    // ä¸šåŠ¡å¤„ç†æ—¶ä½¿ç”¨è§£å¯†åçš„æ•°æ®
    PaymentResult result = paymentService.process(decryptedCardNumber);
    
    // è¿”å›ç»“æœæ—¶è„±æ•
    result.setCardNumber(maskCardNumber(decryptedCardNumber));
    return result;
}
```

---

## 5. âœï¸ æ¥å£ç­¾åéªŒè¯æœºåˆ¶


### 5.1 ä»€ä¹ˆæ˜¯æ¥å£ç­¾å


**ğŸ¯ ç­¾åçš„ä½œç”¨**

æ¥å£ç­¾åå°±åƒ**æ–‡ä»¶çš„æ•°å­—å°ç« **ï¼š
- ğŸ“ **è¯æ˜èº«ä»½**ï¼šç¡®è®¤è¯·æ±‚ç¡®å®æ¥è‡ªåˆæ³•å®¢æˆ·ç«¯
- ğŸ”’ **é˜²æ­¢ç¯¡æ”¹**ï¼šç¡®ä¿æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«ä¿®æ”¹
- â° **é˜²é‡æ”¾æ”»å‡»**ï¼šé˜²æ­¢æ¶æ„é‡å¤å‘é€æ—§è¯·æ±‚

**ğŸ’¡ ç­¾åå·¥ä½œåŸç†**
```
å®¢æˆ·ç«¯ç”Ÿæˆç­¾åï¼š
è¯·æ±‚å‚æ•° + å¯†é’¥ + æ—¶é—´æˆ³ â†’ å“ˆå¸Œç®—æ³• â†’ ç­¾åå€¼

æœåŠ¡ç«¯éªŒè¯ç­¾åï¼š
æ¥æ”¶å‚æ•° + å¯†é’¥ + æ—¶é—´æˆ³ â†’ å“ˆå¸Œç®—æ³• â†’ è®¡ç®—ç­¾åå€¼
æ¯”è¾ƒè®¡ç®—å€¼ä¸æ¥æ”¶å€¼æ˜¯å¦ä¸€è‡´
```

### 5.2 ç­¾åç”Ÿæˆä¸éªŒè¯


**ğŸ”§ ç­¾åç®—æ³•å®ç°**

```java
public class SignatureUtil {
    
    // ç”Ÿæˆç­¾å
    public static String generateSignature(Map<String, String> params, 
                                         String secretKey, 
                                         long timestamp) {
        // 1. å‚æ•°æ’åº
        TreeMap<String, String> sortedParams = new TreeMap<>(params);
        
        // 2. æ„å»ºç­¾åå­—ç¬¦ä¸²
        StringBuilder signStr = new StringBuilder();
        for (Map.Entry<String, String> entry : sortedParams.entrySet()) {
            signStr.append(entry.getKey()).append("=")
                   .append(entry.getValue()).append("&");
        }
        
        // 3. æ·»åŠ æ—¶é—´æˆ³å’Œå¯†é’¥
        signStr.append("timestamp=").append(timestamp)
               .append("&key=").append(secretKey);
        
        // 4. è®¡ç®—å“ˆå¸Œå€¼
        return DigestUtils.sha256Hex(signStr.toString()).toUpperCase();
    }
    
    // éªŒè¯ç­¾å
    public static boolean verifySignature(Map<String, String> params,
                                        String receivedSignature,
                                        String secretKey,
                                        long timestamp) {
        // 1. æ£€æŸ¥æ—¶é—´æˆ³ï¼ˆé˜²é‡æ”¾æ”»å‡»ï¼‰
        long currentTime = System.currentTimeMillis() / 1000;
        if (Math.abs(currentTime - timestamp) > 300) { // 5åˆ†é’Ÿæœ‰æ•ˆæœŸ
            return false;
        }
        
        // 2. è®¡ç®—ç­¾å
        String calculatedSignature = generateSignature(params, secretKey, timestamp);
        
        // 3. æ¯”è¾ƒç­¾å
        return calculatedSignature.equals(receivedSignature);
    }
}
```

### 5.3 ç­¾åéªŒè¯æœ€ä½³å®è·µ


**ğŸ›¡ï¸ å®‰å…¨é˜²æŠ¤è¦ç‚¹**

**â‘  è¯·æ±‚ç¤ºä¾‹**
```javascript
// å‰ç«¯å‘é€ç­¾åè¯·æ±‚
const params = {
    userId: "12345",
    amount: "100.00",
    orderId: "ORDER_001"
};

const timestamp = Math.floor(Date.now() / 1000);
const signature = generateSignature(params, secretKey, timestamp);

// å‘é€è¯·æ±‚
axios.post('/api/payment', {
    ...params,
    timestamp: timestamp,
    signature: signature
});
```

**â‘¡ åç«¯éªŒè¯å¤„ç†**
```java
@PostMapping("/api/payment")
public PaymentResult payment(@RequestBody PaymentRequest request) {
    // 1. æå–ç­¾åä¿¡æ¯
    String receivedSignature = request.getSignature();
    long timestamp = request.getTimestamp();
    
    // 2. æ„å»ºå‚æ•°Mapï¼ˆæ’é™¤ç­¾åå­—æ®µï¼‰
    Map<String, String> params = new HashMap<>();
    params.put("userId", request.getUserId());
    params.put("amount", request.getAmount());
    params.put("orderId", request.getOrderId());
    
    // 3. éªŒè¯ç­¾å
    if (!SignatureUtil.verifySignature(params, receivedSignature, SECRET_KEY, timestamp)) {
        throw new SecurityException("ç­¾åéªŒè¯å¤±è´¥");
    }
    
    // 4. å¤„ç†ä¸šåŠ¡é€»è¾‘
    return paymentService.processPayment(request);
}
```

**â‘¢ é˜²é‡æ”¾æ”»å‡»**
```java
// ä½¿ç”¨Redisè®°å½•å·²å¤„ç†çš„è¯·æ±‚
@Component
public class NonceManager {
    
    @Autowired
    private RedisTemplate<String, String> redisTemplate;
    
    public boolean isNonceUsed(String nonce, long timestamp) {
        String key = "nonce:" + nonce;
        String exists = redisTemplate.opsForValue().get(key);
        
        if (exists != null) {
            return true; // é‡å¤è¯·æ±‚
        }
        
        // è®°å½•nonceï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´
        redisTemplate.opsForValue().set(key, "used", 10, TimeUnit.MINUTES);
        return false;
    }
}
```

---

## 6. ğŸš« å‰ç«¯æƒé™æ ¡éªŒé™åˆ¶


### 6.1 å‰ç«¯æƒé™æ ¡éªŒçš„é—®é¢˜


**âš ï¸ ä¸ºä»€ä¹ˆå‰ç«¯æ ¡éªŒä¸å¯é **

å‰ç«¯æƒé™æ ¡éªŒå°±åƒåœ¨**é—¨å£è´´ä¸ªå‘Šç¤º**è¯´"é—²äººå…è¿›"ï¼š
- ğŸ“ çœ‹èµ·æ¥æœ‰ç”¨ï¼Œä½†å®é™…**æ— æ³•é˜»æ­¢**çœŸæ­£çš„å…¥ä¾µè€…
- ğŸ”§ **æŠ€æœ¯äººå‘˜**å¯ä»¥è½»æ˜“ç»•è¿‡è¿™äº›é™åˆ¶
- ğŸ‘€ æ‰€æœ‰çš„**é€»è¾‘éƒ½æ˜¯é€æ˜**çš„ï¼Œæ”»å‡»è€…å¯ä»¥åˆ†æä»£ç 

**ğŸ’€ å¸¸è§ç»•è¿‡æ–¹å¼**
```
æ–¹å¼1ï¼šç¦ç”¨JavaScript
æµè§ˆå™¨è®¾ç½® â†’ ç¦ç”¨JavaScript â†’ å‰ç«¯æ ¡éªŒå¤±æ•ˆ

æ–¹å¼2ï¼šä¿®æ”¹å‰ç«¯ä»£ç   
æµè§ˆå™¨å¼€å‘è€…å·¥å…· â†’ ç¼–è¾‘JavaScript â†’ ç§»é™¤æƒé™æ£€æŸ¥

æ–¹å¼3ï¼šç›´æ¥è°ƒç”¨API
ä½¿ç”¨Postmanã€curlç­‰å·¥å…· â†’ ç»•è¿‡å‰ç«¯ç•Œé¢ç›´æ¥è°ƒç”¨æ¥å£

æ–¹å¼4ï¼šç¯¡æ”¹æœ¬åœ°å­˜å‚¨
ä¿®æ”¹localStorageä¸­çš„ç”¨æˆ·æƒé™ä¿¡æ¯ â†’ ä¼ªé€ ç®¡ç†å‘˜æƒé™
```

### 6.2 å‰ç«¯æƒé™çš„æ­£ç¡®ç”¨é€”


**âœ… å‰ç«¯æƒé™çš„åˆç†ä½¿ç”¨**

è™½ç„¶å‰ç«¯æƒé™ä¸èƒ½æä¾›çœŸæ­£çš„å®‰å…¨ä¿æŠ¤ï¼Œä½†æœ‰å…¶**ç”¨æˆ·ä½“éªŒä»·å€¼**ï¼š

**â‘  ç”¨æˆ·ä½“éªŒä¼˜åŒ–**
```javascript
// æ ¹æ®æƒé™æ˜¾ç¤º/éšè—åŠŸèƒ½æŒ‰é’®
const UserInterface = () => {
    const user = getCurrentUser();
    
    return (
        <div>
            <h1>ç”¨æˆ·ä¸­å¿ƒ</h1>
            {user.hasPermission('view_orders') && (
                <button onClick={viewOrders}>æŸ¥çœ‹è®¢å•</button>
            )}
            {user.hasPermission('manage_users') && (
                <button onClick={manageUsers}>ç”¨æˆ·ç®¡ç†</button>
            )}
        </div>
    );
};
```

**â‘¡ å‡å°‘æ— æ•ˆè¯·æ±‚**
```javascript
// å‘é€è¯·æ±‚å‰æ£€æŸ¥æƒé™
const deleteUser = async (userId) => {
    const user = getCurrentUser();
    
    // å‰ç«¯æ£€æŸ¥ï¼šé¿å…æ— æƒé™æ—¶å‘é€æ— æ•ˆè¯·æ±‚
    if (!user.hasPermission('delete_user')) {
        showMessage('æ‚¨æ²¡æœ‰åˆ é™¤ç”¨æˆ·çš„æƒé™');
        return;
    }
    
    // å‘é€è¯·æ±‚ï¼ˆåç«¯ä»éœ€éªŒè¯æƒé™ï¼‰
    try {
        await api.delete(`/users/${userId}`);
        showMessage('åˆ é™¤æˆåŠŸ');
    } catch (error) {
        if (error.status === 403) {
            showMessage('æƒé™ä¸è¶³'); // åç«¯æ‹’ç»äº†è¯·æ±‚
        }
    }
};
```

### 6.3 å‰åç«¯æƒé™åä½œ


**ğŸ”„ åŒé‡æ ¡éªŒæœºåˆ¶**

```
ç”¨æˆ·æ“ä½œæµç¨‹ï¼š
                   å‰ç«¯æ ¡éªŒ              åç«¯æ ¡éªŒ
ç”¨æˆ·ç‚¹å‡»æŒ‰é’® â†’ [æƒé™æ£€æŸ¥] â†’ å‘é€è¯·æ±‚ â†’ [æƒé™éªŒè¯] â†’ æ‰§è¡Œæ“ä½œ
     â†“           â†“            â†“           â†“           â†“
   ç‚¹å‡»æ“ä½œ   UIå±‚è¿‡æ»¤    ç½‘ç»œä¼ è¾“    æœåŠ¡ç«¯éªŒè¯   ä¸šåŠ¡æ‰§è¡Œ
   
å‰ç«¯ä½œç”¨ï¼šç”¨æˆ·ä½“éªŒä¼˜åŒ–ï¼Œå‡å°‘æ— æ•ˆè¯·æ±‚
åç«¯ä½œç”¨ï¼šçœŸæ­£çš„å®‰å…¨é˜²æŠ¤ï¼Œä¸å¯ç»•è¿‡
```

**ğŸ’» åä½œå®ç°ç¤ºä¾‹**
```java
// åç«¯ï¼šæƒé™ä¿¡æ¯API
@GetMapping("/api/user/permissions")
public UserPermissions getCurrentUserPermissions() {
    User user = getCurrentUser();
    return permissionService.getUserPermissions(user.getId());
}

// å‰ç«¯ï¼šè·å–å¹¶ä½¿ç”¨æƒé™ä¿¡æ¯
class PermissionManager {
    constructor() {
        this.permissions = [];
        this.loadPermissions();
    }
    
    async loadPermissions() {
        try {
            const response = await fetch('/api/user/permissions');
            this.permissions = await response.json();
        } catch (error) {
            console.error('åŠ è½½æƒé™ä¿¡æ¯å¤±è´¥:', error);
        }
    }
    
    hasPermission(permission) {
        return this.permissions.includes(permission);
    }
    
    // å®‰å…¨æç¤ºï¼šè¿™åªæ˜¯UIå±‚é¢çš„æ£€æŸ¥ï¼
    // çœŸæ­£çš„æƒé™æ§åˆ¶å¿…é¡»åœ¨åç«¯å®ç°
}
```

---

## 7. ğŸ“Š APIç›‘æ§ä¸æ—¥å¿—å®¡è®¡


### 7.1 ä¸ºä»€ä¹ˆéœ€è¦ç›‘æ§å®¡è®¡


**ğŸ¯ ç›‘æ§çš„ä»·å€¼**

APIç›‘æ§å°±åƒç»™ç³»ç»Ÿå®‰è£…**24å°æ—¶ç›‘æ§æ‘„åƒå¤´**ï¼š
- ğŸ‘€ **å®æ—¶ç›‘æ§**ï¼šå‘ç°å¼‚å¸¸æ´»åŠ¨å’Œæ”»å‡»è¡Œä¸º
- ğŸ“ˆ **æ€§èƒ½åˆ†æ**ï¼šäº†è§£ç³»ç»Ÿä½¿ç”¨æƒ…å†µå’Œæ€§èƒ½ç“¶é¢ˆ
- ğŸ” **é—®é¢˜è¿½è¸ª**ï¼šå‡ºç°é—®é¢˜æ—¶å¿«é€Ÿå®šä½åŸå› 
- ğŸ“‹ **åˆè§„è¦æ±‚**ï¼šæ»¡è¶³å®‰å…¨å®¡è®¡å’Œæ³•è§„è¦æ±‚

**ğŸš¨ éœ€è¦ç›‘æ§çš„å®‰å…¨äº‹ä»¶**
```
è®¤è¯ç›¸å…³ï¼š
- ç™»å½•å¤±è´¥æ¬¡æ•°å¼‚å¸¸
- å¼‚åœ°ç™»å½•è¡Œä¸º
- æš´åŠ›ç ´è§£å°è¯•

æƒé™ç›¸å…³ï¼š
- æƒé™è¶Šç•Œå°è¯•
- æ•æ„Ÿæ“ä½œæ‰§è¡Œ
- æ‰¹é‡æ•°æ®è®¿é—®

å¼‚å¸¸è¡Œä¸ºï¼š
- é«˜é¢‘ç‡æ¥å£è°ƒç”¨
- å¼‚å¸¸å‚æ•°æäº¤
- éæ­£å¸¸æ—¶é—´è®¿é—®
```

### 7.2 ç›‘æ§æŒ‡æ ‡è®¾è®¡


**ğŸ“Š å…³é”®ç›‘æ§ç»´åº¦**

| ç›‘æ§ç±»åˆ« | å…³é”®æŒ‡æ ‡ | å‘Šè­¦é˜ˆå€¼ | å¤„ç†æ–¹å¼ |
|---------|---------|----------|----------|
| ğŸ” **å®‰å…¨ç›‘æ§** | ç™»å½•å¤±è´¥ç‡ | >20%/5åˆ†é’Ÿ | è‡ªåŠ¨å°IP |
| âš¡ **æ€§èƒ½ç›‘æ§** | å“åº”æ—¶é—´ | >2ç§’ | æ€§èƒ½ä¼˜åŒ– |
| ğŸ“ˆ **æµé‡ç›‘æ§** | QPS | >1000/ç§’ | é™æµä¿æŠ¤ |
| ğŸš¨ **å¼‚å¸¸ç›‘æ§** | é”™è¯¯ç‡ | >5% | ç´§æ€¥å¤„ç† |

**ğŸ’» ç›‘æ§å®ç°ç¤ºä¾‹**
```java
@Component
public class APIMonitor {
    
    @Autowired
    private MetricsCollector metricsCollector;
    
    @Autowired
    private AlertService alertService;
    
    // è®°å½•APIè°ƒç”¨æŒ‡æ ‡
    public void recordAPICall(String apiPath, String userId, 
                             long responseTime, int statusCode) {
        // è®°å½•åŸºç¡€æŒ‡æ ‡
        metricsCollector.recordAPILatency(apiPath, responseTime);
        metricsCollector.recordAPIStatus(apiPath, statusCode);
        
        // å®‰å…¨ç›‘æ§
        if (statusCode == 401 || statusCode == 403) {
            recordSecurityEvent(apiPath, userId, "æƒé™é”™è¯¯");
        }
        
        // æ€§èƒ½ç›‘æ§
        if (responseTime > 2000) {
            recordPerformanceEvent(apiPath, responseTime, "å“åº”ç¼“æ…¢");
        }
    }
    
    // è®°å½•å®‰å…¨äº‹ä»¶
    private void recordSecurityEvent(String apiPath, String userId, String eventType) {
        SecurityEvent event = new SecurityEvent();
        event.setApiPath(apiPath);
        event.setUserId(userId);
        event.setEventType(eventType);
        event.setTimestamp(System.currentTimeMillis());
        
        // æ£€æŸ¥æ˜¯å¦éœ€è¦å‘Šè­¦
        if (isSecurityThresholdExceeded(userId, eventType)) {
            alertService.sendSecurityAlert(event);
        }
    }
}
```

### 7.3 æ—¥å¿—å®¡è®¡ä½“ç³»


**ğŸ“ å®¡è®¡æ—¥å¿—è®¾è®¡**

**â‘  æ—¥å¿—å†…å®¹æ ‡å‡†**
```java
public class AuditLog {
    private String requestId;      // è¯·æ±‚å”¯ä¸€æ ‡è¯†
    private String userId;         // ç”¨æˆ·ID
    private String apiPath;        // æ¥å£è·¯å¾„
    private String httpMethod;     // HTTPæ–¹æ³•
    private String clientIP;       // å®¢æˆ·ç«¯IP
    private String userAgent;      // æµè§ˆå™¨ä¿¡æ¯
    private Long timestamp;        // æ—¶é—´æˆ³
    private String requestParams;  // è¯·æ±‚å‚æ•°ï¼ˆè„±æ•ï¼‰
    private String responseCode;   // å“åº”ç 
    private Long processingTime;   // å¤„ç†æ—¶é—´
    private String securityLevel;  // å®‰å…¨çº§åˆ«
}
```

**â‘¡ æ•æ„Ÿæ“ä½œå®¡è®¡**
```java
@RestController
public class AdminController {
    
    @PostMapping("/api/admin/users/{id}/delete")
    @AuditRequired(level = "HIGH", description = "åˆ é™¤ç”¨æˆ·")
    public void deleteUser(@PathVariable Long id, HttpServletRequest request) {
        // è®°å½•è¯¦ç»†å®¡è®¡ä¿¡æ¯
        AuditLog auditLog = new AuditLog();
        auditLog.setUserId(getCurrentUserId());
        auditLog.setApiPath(request.getRequestURI());
        auditLog.setTargetResource("user:" + id);
        auditLog.setOperation("DELETE");
        auditLog.setSecurityLevel("HIGH");
        
        auditService.recordAudit(auditLog);
        
        // æ‰§è¡Œåˆ é™¤æ“ä½œ
        userService.deleteUser(id);
    }
}
```

**â‘¢ å®æ—¶ç›‘æ§å‘Šè­¦**
```java
@Component
public class SecurityMonitor {
    
    // æ£€æµ‹å¼‚å¸¸è¡Œä¸ºæ¨¡å¼
    @EventListener
    public void onAPICall(APICallEvent event) {
        String userId = event.getUserId();
        String apiPath = event.getApiPath();
        
        // æ£€æµ‹é«˜é¢‘è°ƒç”¨
        if (isHighFrequencyCall(userId, apiPath)) {
            alertService.sendAlert("æ£€æµ‹åˆ°é«˜é¢‘APIè°ƒç”¨", event);
        }
        
        // æ£€æµ‹æƒé™æ¢æµ‹
        if (isPermissionProbing(userId, event.getStatusCode())) {
            alertService.sendAlert("æ£€æµ‹åˆ°æƒé™æ¢æµ‹è¡Œä¸º", event);
        }
        
        // æ£€æµ‹å¼‚å¸¸æ—¶é—´è®¿é—®
        if (isOffHoursAccess(event.getTimestamp()) && 
            isSensitiveAPI(apiPath)) {
            alertService.sendAlert("æ£€æµ‹åˆ°éå·¥ä½œæ—¶é—´æ•æ„Ÿæ“ä½œ", event);
        }
    }
}
```

---

## 8. ğŸ”„ å®‰å…¨å¼€å‘ç”Ÿå‘½å‘¨æœŸSDL


### 8.1 ä»€ä¹ˆæ˜¯SDL


**ğŸ¯ SDLåŸºæœ¬æ¦‚å¿µ**

SDLï¼ˆSecurity Development Lifecycleï¼‰å°±åƒæ˜¯**è½¯ä»¶çš„å®‰å…¨ä½“æ£€åˆ¶åº¦**ï¼š
- ğŸ¥ **å®šæœŸä½“æ£€**ï¼šåœ¨å¼€å‘çš„æ¯ä¸ªé˜¶æ®µéƒ½è¿›è¡Œå®‰å…¨æ£€æŸ¥
- ğŸ” **æ—©æœŸå‘ç°**ï¼šåœ¨é—®é¢˜å˜ä¸¥é‡å‰å°±å‘ç°å¹¶è§£å†³
- ğŸ’Š **é¢„é˜²ä¸ºä¸»**ï¼šé€šè¿‡è§„èŒƒæµç¨‹é¿å…å®‰å…¨é—®é¢˜äº§ç”Ÿ

**ğŸ“‹ SDLçš„æ ¸å¿ƒåŸåˆ™**
```
å®‰å…¨å·¦ç§»ï¼šå®‰å…¨è€ƒè™‘å‰ç½®åˆ°è®¾è®¡é˜¶æ®µ
çºµæ·±é˜²å¾¡ï¼šå¤šå±‚å®‰å…¨é˜²æŠ¤æœºåˆ¶
æœ€å°æƒé™ï¼šåªç»™å¿…éœ€çš„æœ€å°æƒé™
é»˜è®¤å®‰å…¨ï¼šç³»ç»Ÿé»˜è®¤é…ç½®å°±æ˜¯å®‰å…¨çš„
```

### 8.2 SDLå„é˜¶æ®µå®‰å…¨æ´»åŠ¨


**ğŸ”„ å®Œæ•´ç”Ÿå‘½å‘¨æœŸå®‰å…¨æ´»åŠ¨**

```
éœ€æ±‚åˆ†æé˜¶æ®µ
    â†“
[å®‰å…¨éœ€æ±‚è¯†åˆ«] â†’ ç¡®å®šå®‰å…¨è¦æ±‚å’Œåˆè§„éœ€æ±‚
    â†“
è®¾è®¡é˜¶æ®µ  
    â†“
[å¨èƒå»ºæ¨¡] â†’ è¯†åˆ«æ½œåœ¨å®‰å…¨å¨èƒ
    â†“
[å®‰å…¨æ¶æ„è®¾è®¡] â†’ è®¾è®¡å®‰å…¨é˜²æŠ¤æœºåˆ¶
    â†“
å¼€å‘é˜¶æ®µ
    â†“
[å®‰å…¨ç¼–ç ] â†’ éµå¾ªå®‰å…¨ç¼–ç è§„èŒƒ
    â†“
[ä»£ç å®¡æŸ¥] â†’ äººå·¥+å·¥å…·ä»£ç å®‰å…¨æ£€æŸ¥
    â†“
æµ‹è¯•é˜¶æ®µ
    â†“
[å®‰å…¨æµ‹è¯•] â†’ æ¸—é€æµ‹è¯•ã€æ¼æ´æ‰«æ
    â†“
éƒ¨ç½²é˜¶æ®µ
    â†“
[å®‰å…¨é…ç½®] â†’ ç”Ÿäº§ç¯å¢ƒå®‰å…¨é…ç½®
    â†“
è¿ç»´é˜¶æ®µ
    â†“
[å®‰å…¨ç›‘æ§] â†’ æŒç»­å®‰å…¨ç›‘æ§å’Œå“åº”
```

### 8.3 APIå¼€å‘ä¸­çš„SDLå®è·µ


**ğŸ›¡ï¸ éœ€æ±‚åˆ†æé˜¶æ®µ**
```java
// å®‰å…¨éœ€æ±‚æ£€æŸ¥æ¸…å•
public class APISecurityRequirements {
    
    // èº«ä»½è®¤è¯éœ€æ±‚
    public enum AuthRequirement {
        PUBLIC,          // å…¬å¼€æ¥å£ï¼Œæ— éœ€è®¤è¯
        LOGIN_REQUIRED,  // éœ€è¦ç™»å½•
        STRONG_AUTH      // éœ€è¦å¼ºè®¤è¯ï¼ˆåŒå› å­ç­‰ï¼‰
    }
    
    // æƒé™æ§åˆ¶éœ€æ±‚  
    public enum AuthzRequirement {
        SELF_ONLY,       // åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®
        ROLE_BASED,      // åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
        ATTRIBUTE_BASED  // åŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶
    }
    
    // æ•°æ®ä¿æŠ¤éœ€æ±‚
    public enum DataProtection {
        NONE,            // æ— ç‰¹æ®Šè¦æ±‚
        ENCRYPT_TRANSIT, // ä¼ è¾“åŠ å¯†
        ENCRYPT_STORAGE, // å­˜å‚¨åŠ å¯†
        FULL_PROTECTION  // å…¨ç¨‹åŠ å¯†
    }
}
```

**ğŸ” è®¾è®¡é˜¶æ®µå¨èƒå»ºæ¨¡**
```java
// APIå¨èƒå»ºæ¨¡ç¤ºä¾‹
public class ThreatModel {
    
    // å¨èƒåˆ†æï¼šSTRIDEæ¨¡å‹
    public void analyzeThreat(APIEndpoint endpoint) {
        // S - Spoofing (ä¼ªé€ )
        checkSpoofingRisk(endpoint);
        
        // T - Tampering (ç¯¡æ”¹)  
        checkTamperingRisk(endpoint);
        
        // R - Repudiation (å¦è®¤)
        checkRepudiationRisk(endpoint);
        
        // I - Information Disclosure (ä¿¡æ¯æ³„éœ²)
        checkInformationDisclosureRisk(endpoint);
        
        // D - Denial of Service (æ‹’ç»æœåŠ¡)
        checkDoSRisk(endpoint);
        
        // E - Elevation of Privilege (æƒé™æå‡)
        checkPrivilegeEscalationRisk(endpoint);
    }
}
```

**âœ… å¼€å‘é˜¶æ®µå®‰å…¨æ£€æŸ¥**
```java
// å®‰å…¨ç¼–ç æ£€æŸ¥å·¥å…·
@Component
public class SecurityCodeChecker {
    
    // æ£€æŸ¥SQLæ³¨å…¥é£é™©
    public void checkSQLInjection(String sqlQuery) {
        if (containsUserInput(sqlQuery) && !isParameterized(sqlQuery)) {
            throw new SecurityViolationException("æ£€æµ‹åˆ°SQLæ³¨å…¥é£é™©");
        }
    }
    
    // æ£€æŸ¥XSSé£é™©
    public void checkXSS(String outputData) {
        if (containsHTMLTags(outputData) && !isEscaped(outputData)) {
            throw new SecurityViolationException("æ£€æµ‹åˆ°XSSé£é™©");
        }
    }
    
    // æ£€æŸ¥æ•æ„Ÿä¿¡æ¯æ³„éœ²
    public void checkSensitiveDataExposure(Object responseData) {
        if (containsSensitiveData(responseData)) {
            logger.warn("å“åº”ä¸­åŒ…å«æ•æ„Ÿæ•°æ®ï¼Œè¯·ç¡®è®¤æ˜¯å¦éœ€è¦è„±æ•");
        }
    }
}
```

**ğŸ§ª æµ‹è¯•é˜¶æ®µå®‰å…¨éªŒè¯**
```java
// è‡ªåŠ¨åŒ–å®‰å…¨æµ‹è¯•
@SpringBootTest
public class APISecurityTest {
    
    @Test
    public void testAuthenticationBypass() {
        // æµ‹è¯•æ— Tokenè®¿é—®å—ä¿æŠ¤æ¥å£
        ResponseEntity<String> response = testClient.get("/api/protected");
        assertEquals(401, response.getStatusCodeValue());
    }
    
    @Test  
    public void testAuthorizationBypass() {
        // æµ‹è¯•æ™®é€šç”¨æˆ·è®¿é—®ç®¡ç†å‘˜æ¥å£
        String userToken = loginAsNormalUser();
        ResponseEntity<String> response = testClient
            .get("/api/admin/users", userToken);
        assertEquals(403, response.getStatusCodeValue());
    }
    
    @Test
    public void testSQLInjection() {
        // æµ‹è¯•SQLæ³¨å…¥æ”»å‡»
        String maliciousInput = "'; DROP TABLE users; --";
        ResponseEntity<String> response = testClient
            .get("/api/search?query=" + maliciousInput);
        // åº”è¯¥è¿”å›æ­£å¸¸ç»“æœï¼Œä¸åº”è¯¥æ‰§è¡Œæ¶æ„SQL
        assertNotEquals(500, response.getStatusCodeValue());
    }
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„å®‰å…¨åŸåˆ™


```
ğŸ”¸ ä¿¡ä»»è¾¹ç•Œï¼šæ°¸è¿œä¸è¦ç›¸ä¿¡å®¢æˆ·ç«¯è¾“å…¥
ğŸ”¸ æ·±åº¦é˜²å¾¡ï¼šå¤šå±‚é˜²æŠ¤æœºåˆ¶ï¼Œä¸ä¾èµ–å•ç‚¹
ğŸ”¸ æœ€å°æƒé™ï¼šåªç»™å¿…éœ€çš„æœ€å°æƒé™
ğŸ”¸ é»˜è®¤æ‹’ç»ï¼šæ²¡æœ‰æ˜ç¡®å…è®¸å°±æ˜¯æ‹’ç»
ğŸ”¸ å®‰å…¨å·¦ç§»ï¼šåœ¨è®¾è®¡é˜¶æ®µå°±è€ƒè™‘å®‰å…¨
ğŸ”¸ æŒç»­ç›‘æ§ï¼šå®æ—¶ç›‘æ§å’Œå¿«é€Ÿå“åº”
```

### 9.2 APIå®‰å…¨é˜²æŠ¤å…³é”®æŠ€æœ¯


**ğŸ›¡ï¸ æ ¸å¿ƒé˜²æŠ¤æŠ€æœ¯**

| é˜²æŠ¤å±‚é¢ | å…³é”®æŠ€æœ¯ | æ ¸å¿ƒä½œç”¨ |
|---------|---------|---------|
| ğŸ” **èº«ä»½è®¤è¯** | JWT Tokenã€OAuth2 | ç¡®è®¤ç”¨æˆ·èº«ä»½ |
| ğŸšª **æƒé™æ§åˆ¶** | RBACã€ABAC | æ§åˆ¶è®¿é—®èŒƒå›´ |
| ğŸ”’ **æ•°æ®ä¿æŠ¤** | AESåŠ å¯†ã€HTTPS | ä¿æŠ¤æ•°æ®å®‰å…¨ |
| âœï¸ **è¯·æ±‚éªŒè¯** | æ•°å­—ç­¾åã€æ—¶é—´æˆ³ | é˜²ç¯¡æ”¹å’Œé‡æ”¾ |
| ğŸ“Š **ç›‘æ§å®¡è®¡** | æ—¥å¿—è®°å½•ã€å®æ—¶å‘Šè­¦ | å®‰å…¨äº‹ä»¶è¿½è¸ª |

### 9.3 å®æ–½ä¼˜å…ˆçº§å»ºè®®


**ğŸ¯ æŒ‰é‡è¦æ€§æ’åºçš„å®æ–½æ­¥éª¤**

**â­â­â­ é«˜ä¼˜å…ˆçº§ï¼ˆå¿…é¡»å®ç°ï¼‰**
```
1. åç«¯å¼ºåˆ¶æƒé™æ ¡éªŒ - å®‰å…¨åŸºç¡€
2. HTTPSä¼ è¾“åŠ å¯† - æ•°æ®ä¿æŠ¤åŸºç¡€  
3. åŸºç¡€ç›‘æ§æ—¥å¿— - é—®é¢˜è¿½è¸ªåŸºç¡€
4. è¾“å…¥å‚æ•°éªŒè¯ - é˜²æ­¢æ³¨å…¥æ”»å‡»
```

**â­â­ ä¸­ä¼˜å…ˆçº§ï¼ˆé‡è¦åŠŸèƒ½ï¼‰**
```
5. æ¥å£ç­¾åéªŒè¯ - é˜²ç¯¡æ”¹å’Œé‡æ”¾
6. å‚æ•°æ•æ„Ÿæ•°æ®åŠ å¯† - é¢å¤–æ•°æ®ä¿æŠ¤
7. è¯¦ç»†å®¡è®¡æ—¥å¿— - åˆè§„å’Œè¿½è¸ª
8. è‡ªåŠ¨åŒ–å®‰å…¨æµ‹è¯• - è´¨é‡ä¿è¯
```

**â­ ä½ä¼˜å…ˆçº§ï¼ˆä¼˜åŒ–åŠŸèƒ½ï¼‰**
```
9. å‰ç«¯æƒé™ä¼˜åŒ– - ç”¨æˆ·ä½“éªŒæå‡
10. é«˜çº§ç›‘æ§å‘Šè­¦ - è¿ç»´æ•ˆç‡æå‡
11. å®Œæ•´SDLæµç¨‹ - é•¿æœŸå®‰å…¨ä¿éšœ
```

### 9.4 å¸¸è§è¯¯åŒºä¸æœ€ä½³å®è·µ


**âŒ å¸¸è§å®‰å…¨è¯¯åŒº**
```
è¯¯åŒº1ï¼šè®¤ä¸ºHTTPSå°±å¤Ÿäº†
æ­£è§£ï¼šHTTPSåªä¿æŠ¤ä¼ è¾“ï¼Œåº”ç”¨å±‚ä»éœ€è¦æƒé™æ§åˆ¶

è¯¯åŒº2ï¼šä¾èµ–å‰ç«¯æƒé™æ§åˆ¶
æ­£è§£ï¼šå‰ç«¯åªæ˜¯ç”¨æˆ·ä½“éªŒï¼Œåç«¯å¿…é¡»å¼ºåˆ¶æ ¡éªŒ

è¯¯åŒº3ï¼šä¸€æ¬¡æ€§å®‰å…¨æªæ–½
æ­£è§£ï¼šå®‰å…¨æ˜¯æŒç»­è¿‡ç¨‹ï¼Œéœ€è¦æŒç»­ç›‘æ§å’Œæ”¹è¿›

è¯¯åŒº4ï¼šå¤åˆ¶ç²˜è´´å®‰å…¨ä»£ç 
æ­£è§£ï¼šç†è§£åŸç†ï¼Œæ ¹æ®å®é™…éœ€æ±‚å®šåˆ¶å®‰å…¨æ–¹æ¡ˆ
```

**âœ… æœ€ä½³å®è·µåŸåˆ™**
```
1. åˆ†å±‚é˜²æŠ¤ï¼šä¸è¦æŠŠå®‰å…¨å¯„æ‰˜åœ¨å•ä¸€é˜²æŠ¤æªæ–½ä¸Š
2. åŠæ—¶æ›´æ–°ï¼šå®šæœŸæ›´æ–°å®‰å…¨ç»„ä»¶å’Œä¿®å¤å·²çŸ¥æ¼æ´
3. æœ€å°æš´éœ²ï¼šåªæš´éœ²å¿…è¦çš„æ¥å£å’Œä¿¡æ¯
4. ç›‘æ§å‘Šè­¦ï¼šå»ºç«‹å®Œå–„çš„å®‰å…¨ç›‘æ§å’Œåº”æ€¥å“åº”æœºåˆ¶
5. äººå‘˜åŸ¹è®­ï¼šå®šæœŸè¿›è¡Œå®‰å…¨æ„è¯†å’ŒæŠ€èƒ½åŸ¹è®­
```

**ğŸ’¡ å®æˆ˜å»ºè®®**
- **ä»åŸºç¡€åšèµ·**ï¼šå…ˆåšå¥½æƒé™æ§åˆ¶å’Œè¾“å…¥éªŒè¯
- **é€æ­¥å®Œå–„**ï¼šæ ¹æ®ä¸šåŠ¡éœ€è¦é€æ­¥å¢åŠ å®‰å…¨æªæ–½  
- **æŒç»­å­¦ä¹ **ï¼šå…³æ³¨æœ€æ–°çš„å®‰å…¨å¨èƒå’Œé˜²æŠ¤æŠ€æœ¯
- **å®è·µæ£€éªŒ**ï¼šé€šè¿‡æ¸—é€æµ‹è¯•éªŒè¯å®‰å…¨æªæ–½æœ‰æ•ˆæ€§

**ğŸ¯ æ ¸å¿ƒè®°å¿†**
- APIå®‰å…¨çš„æœ¬è´¨æ˜¯**ç¡®ä¿åˆé€‚çš„äººåœ¨åˆé€‚çš„æ—¶é—´è®¿é—®åˆé€‚çš„æ•°æ®**
- åç«¯æƒé™æ ¡éªŒæ˜¯**ä¸å¯ç»•è¿‡çš„æœ€åé˜²çº¿**
- ç›‘æ§å®¡è®¡æ˜¯**å‘ç°å’Œè¿½è¸ªå®‰å…¨é—®é¢˜çš„çœ¼ç›**
- å®‰å…¨æ˜¯**æŒç»­çš„è¿‡ç¨‹ï¼Œä¸æ˜¯ä¸€æ¬¡æ€§çš„äº§å“**