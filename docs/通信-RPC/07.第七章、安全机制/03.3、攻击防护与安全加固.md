---
title: 3ã€æ”»å‡»é˜²æŠ¤ä¸å®‰å…¨åŠ å›º
---
## ğŸ“š ç›®å½•

1. [å¸¸è§æ”»å‡»ç±»å‹ä¸é˜²æŠ¤](#1-å¸¸è§æ”»å‡»ç±»å‹ä¸é˜²æŠ¤)
2. [è¾“å…¥éªŒè¯ä¸å‚æ•°æ ¡éªŒ](#2-è¾“å…¥éªŒè¯ä¸å‚æ•°æ ¡éªŒ)
3. [æ¥å£ç­¾åéªŒè¯æœºåˆ¶](#3-æ¥å£ç­¾åéªŒè¯æœºåˆ¶)
4. [æ•æ„Ÿæ•°æ®ä¿æŠ¤ç­–ç•¥](#4-æ•æ„Ÿæ•°æ®ä¿æŠ¤ç­–ç•¥)
5. [ç½‘ç»œå®‰å…¨éš”ç¦»](#5-ç½‘ç»œå®‰å…¨éš”ç¦»)
6. [å®‰å…¨å®¡è®¡ä½“ç³»](#6-å®‰å…¨å®¡è®¡ä½“ç³»)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ›¡ï¸ å¸¸è§æ”»å‡»ç±»å‹ä¸é˜²æŠ¤


### 1.1 é‡æ”¾æ”»å‡»é˜²æŠ¤


**ğŸ”¸ ä»€ä¹ˆæ˜¯é‡æ”¾æ”»å‡»**
é‡æ”¾æ”»å‡»å°±åƒæœ‰äºº**å·å¬**äº†ä½ å’Œæœ‹å‹çš„å¯¹è¯ï¼Œç„¶å**é‡å¤æ’­æ”¾**è¿™æ®µå¯¹è¯æ¥å†’å……ä½ ã€‚

```
æ­£å¸¸æƒ…å†µï¼š
ä½  â†’ "ç»™å¼ ä¸‰è½¬è´¦100å…ƒ" â†’ é“¶è¡Œç³»ç»Ÿ âœ…

é‡æ”¾æ”»å‡»ï¼š
æ”»å‡»è€…æˆªè·è¯·æ±‚ â†’ é‡å¤å‘é€"ç»™å¼ ä¸‰è½¬è´¦100å…ƒ" â†’ é“¶è¡Œç³»ç»Ÿ âŒ
ç»“æœï¼šé‡å¤è½¬è´¦ï¼ŒæŸå¤±é‡‘é’±
```

**â° æ—¶é—´æˆ³é˜²æŠ¤æœºåˆ¶**
```java
// ç®€å•çš„æ—¶é—´æˆ³éªŒè¯
public class TimestampValidator {
    private static final long VALID_WINDOW = 5 * 60 * 1000; // 5åˆ†é’Ÿæœ‰æ•ˆæœŸ
    
    public boolean isValidRequest(long requestTime) {
        long currentTime = System.currentTimeMillis();
        long timeDiff = Math.abs(currentTime - requestTime);
        
        // è¶…è¿‡5åˆ†é’Ÿçš„è¯·æ±‚ç›´æ¥æ‹’ç»
        return timeDiff <= VALID_WINDOW;
    }
}
```

**ğŸ’¡ å·¥ä½œåŸç†è¯´æ˜**ï¼š
- æ¯ä¸ªè¯·æ±‚éƒ½å¸¦ä¸Š**å½“å‰æ—¶é—´æˆ³**
- æœåŠ¡å™¨æ£€æŸ¥æ—¶é—´æˆ³æ˜¯å¦åœ¨**å…è®¸èŒƒå›´å†…**ï¼ˆæ¯”å¦‚5åˆ†é’Ÿï¼‰
- è¶…æ—¶çš„è¯·æ±‚ç›´æ¥æ‹’ç»ï¼Œé˜²æ­¢æ—§è¯·æ±‚è¢«é‡æ”¾

**ğŸ¯ Nonceéšæœºæ•°é˜²æŠ¤**
```java
// Nonceï¼ˆåªä½¿ç”¨ä¸€æ¬¡çš„éšæœºæ•°ï¼‰é˜²æŠ¤
public class NonceValidator {
    // å­˜å‚¨å·²ä½¿ç”¨çš„nonceï¼Œå®é™…é¡¹ç›®ä¸­ç”¨Redis
    private Set<String> usedNonces = new ConcurrentHashMap<>();
    
    public boolean validateNonce(String nonce) {
        // æ£€æŸ¥æ˜¯å¦å·²ç»ä½¿ç”¨è¿‡
        if (usedNonces.contains(nonce)) {
            return false; // é‡æ”¾æ”»å‡»
        }
        
        usedNonces.add(nonce); // è®°å½•å·²ä½¿ç”¨
        return true;
    }
}
```

**ğŸ”¹ ç»¼åˆé˜²æŠ¤ç­–ç•¥**ï¼š
```
è¯·æ±‚æ ¼å¼ï¼š
{
    "data": "è½¬è´¦ä¿¡æ¯",
    "timestamp": 1642512000000,     // æ—¶é—´æˆ³
    "nonce": "abc123random456",     // éšæœºæ•°  
    "signature": "åŠ å¯†ç­¾å"          // é˜²ç¯¡æ”¹
}

éªŒè¯æµç¨‹ï¼š
â‘  æ£€æŸ¥æ—¶é—´æˆ³æ˜¯å¦åœ¨æœ‰æ•ˆæœŸå†…
â‘¡ æ£€æŸ¥nonceæ˜¯å¦å·²è¢«ä½¿ç”¨è¿‡
â‘¢ éªŒè¯ç­¾åæ˜¯å¦æ­£ç¡®
â‘£ å¤„ç†è¯·æ±‚å¹¶è®°å½•nonce
```

### 1.2 ä¸­é—´äººæ”»å‡»é˜²æŠ¤


**ğŸ”¸ ä»€ä¹ˆæ˜¯ä¸­é—´äººæ”»å‡»**
å°±åƒä½ ç»™æœ‹å‹å†™ä¿¡ï¼Œä½†é‚®é€’å‘˜å·å·**æ‹†å¼€ä¿¡ä»¶**ï¼Œçœ‹å®Œå†…å®¹å**é‡æ–°å°å¥½**å†é€è¾¾ã€‚

```
æ­£å¸¸é€šä¿¡ï¼š
å®¢æˆ·ç«¯ â†â†’ æœåŠ¡å™¨

ä¸­é—´äººæ”»å‡»ï¼š
å®¢æˆ·ç«¯ â†â†’ æ”»å‡»è€… â†â†’ æœåŠ¡å™¨
            â†‘
        å·çœ‹ã€ç¯¡æ”¹æ•°æ®
```

**ğŸ”’ HTTPSåŠ å¯†ä¼ è¾“**
```java
// å¼ºåˆ¶ä½¿ç”¨HTTPS
@Configuration
public class SecurityConfig {
    
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) {
        return http
            .requiresChannel(channel -> 
                channel.requestMatchers("/**")
                       .requiresSecure()) // å¼ºåˆ¶HTTPS
            .build();
    }
}
```

**ğŸ“œ è¯ä¹¦éªŒè¯æœºåˆ¶**
```java
// è¯ä¹¦éªŒè¯ç¤ºä¾‹
public class CertificateValidator {
    
    public boolean validateServerCertificate(X509Certificate cert) {
        try {
            // â‘  æ£€æŸ¥è¯ä¹¦æ˜¯å¦è¿‡æœŸ
            cert.checkValidity();
            
            // â‘¡ éªŒè¯è¯ä¹¦é“¾
            cert.verify(caCertificate.getPublicKey());
            
            // â‘¢ æ£€æŸ¥åŸŸååŒ¹é…
            String serverName = getServerName();
            if (!cert.getSubjectDN().getName().contains(serverName)) {
                return false;
            }
            
            return true;
        } catch (Exception e) {
            return false; // è¯ä¹¦æ— æ•ˆ
        }
    }
}
```

### 1.3 DDoSæ”»å‡»é˜²æŠ¤


**ğŸ”¸ ä»€ä¹ˆæ˜¯DDoSæ”»å‡»**
DDoSå°±åƒå¾ˆå¤šäºº**åŒæ—¶**ç»™ä½ æ‰“ç”µè¯ï¼ŒæŠŠä½ çš„ç”µè¯çº¿**å æ»¡**ï¼Œè®©æ­£å¸¸ç”¨æˆ·æ‰“ä¸è¿›æ¥ã€‚

```
æ­£å¸¸æƒ…å†µï¼š
ç”¨æˆ·A â†’ æœåŠ¡å™¨ âœ…
ç”¨æˆ·B â†’ æœåŠ¡å™¨ âœ…  
ç”¨æˆ·C â†’ æœåŠ¡å™¨ âœ…

DDoSæ”»å‡»ï¼š
æ”»å‡»è€…1 â†’ å¤§é‡è¯·æ±‚ â†’ æœåŠ¡å™¨ âŒ
æ”»å‡»è€…2 â†’ å¤§é‡è¯·æ±‚ â†’ æœåŠ¡å™¨ âŒ  
æ”»å‡»è€…N â†’ å¤§é‡è¯·æ±‚ â†’ æœåŠ¡å™¨ âŒ
ç»“æœï¼šæœåŠ¡å™¨ç˜«ç—ªï¼Œæ­£å¸¸ç”¨æˆ·æ— æ³•è®¿é—®
```

**âš¡ é™æµé˜²æŠ¤ç­–ç•¥**
```java
// ç®€å•çš„ä»¤ç‰Œæ¡¶é™æµ
@Component
public class RateLimiter {
    
    @Autowired
    private RedisTemplate<String, String> redis;
    
    public boolean allowRequest(String clientId) {
        String key = "rate_limit:" + clientId;
        String count = redis.opsForValue().get(key);
        
        if (count == null) {
            // ç¬¬ä¸€æ¬¡è®¿é—®ï¼Œè®¾ç½®è®¡æ•°å’Œè¿‡æœŸæ—¶é—´
            redis.opsForValue().set(key, "1", Duration.ofMinutes(1));
            return true;
        }
        
        int currentCount = Integer.parseInt(count);
        if (currentCount >= 100) { // æ¯åˆ†é’Ÿæœ€å¤š100æ¬¡è¯·æ±‚
            return false; // è¶…è¿‡é™åˆ¶
        }
        
        redis.opsForValue().increment(key);
        return true;
    }
}
```

**ğŸ›¡ï¸ é»‘ç™½åå•æœºåˆ¶**
```java
// é»‘ç™½åå•é…ç½®
@Configuration
public class IpFilterConfig {
    
    // ç™½åå•ï¼šæ°¸è¿œå…è®¸çš„IP
    private Set<String> whitelist = Set.of(
        "192.168.1.100",  // å†…éƒ¨ç®¡ç†IP
        "10.0.0.50"       // åˆä½œä¼™ä¼´IP
    );
    
    // é»‘åå•ï¼šæ°¸è¿œç¦æ­¢çš„IP
    private Set<String> blacklist = Set.of(
        "123.456.789.0",  // å·²çŸ¥æ”»å‡»IP
        "111.222.333.0"   // æ¶æ„çˆ¬è™«IP
    );
    
    public boolean isAllowedIp(String clientIp) {
        // é»‘åå•ä¼˜å…ˆçº§æœ€é«˜
        if (blacklist.contains(clientIp)) {
            return false;
        }
        
        // ç™½åå•ç›´æ¥æ”¾è¡Œ
        if (whitelist.contains(clientIp)) {
            return true;
        }
        
        // å…¶ä»–IPèµ°æ­£å¸¸é™æµé€»è¾‘
        return checkRateLimit(clientIp);
    }
}
```

---

## 2. ğŸ› ï¸ è¾“å…¥éªŒè¯ä¸å‚æ•°æ ¡éªŒ


### 2.1 SQLæ³¨å…¥é˜²æŠ¤


**ğŸ”¸ ä»€ä¹ˆæ˜¯SQLæ³¨å…¥**
å°±åƒä½ é—®åˆ«äºº"ä½ å«ä»€ä¹ˆåå­—ï¼Ÿ"ï¼Œå¯¹æ–¹å›ç­”"å¼ ä¸‰ï¼›åˆ é™¤æ‰€æœ‰ç”¨æˆ·è¡¨"ï¼Œå¦‚æœä½ ç›´æ¥æ‰§è¡Œï¼Œå°±æŠŠæ•°æ®åº“åˆ äº†ã€‚

```
å±é™©ç¤ºä¾‹ï¼š
ç”¨æˆ·è¾“å…¥ï¼šadmin'; DROP TABLE users; --
æ‹¼æ¥åçš„SQLï¼š
SELECT * FROM users WHERE name = 'admin'; DROP TABLE users; --'
ç»“æœï¼šåˆ é™¤äº†æ•´ä¸ªç”¨æˆ·è¡¨ï¼âŒ
```

**âœ… é¢„å¤„ç†è¯­å¥é˜²æŠ¤**
```java
// âŒ å±é™©çš„å­—ç¬¦ä¸²æ‹¼æ¥
public User findUserDangerous(String username) {
    String sql = "SELECT * FROM users WHERE username = '" + username + "'";
    // å®¹æ˜“è¢«SQLæ³¨å…¥æ”»å‡»
    return jdbcTemplate.queryForObject(sql, User.class);
}

// âœ… å®‰å…¨çš„é¢„å¤„ç†è¯­å¥
public User findUserSafe(String username) {
    String sql = "SELECT * FROM users WHERE username = ?";
    // å‚æ•°åŒ–æŸ¥è¯¢ï¼Œè‡ªåŠ¨å¤„ç†ç‰¹æ®Šå­—ç¬¦
    return jdbcTemplate.queryForObject(sql, User.class, username);
}
```

**ğŸ”¹ è¾“å…¥è¿‡æ»¤æœºåˆ¶**
```java
// SQLæ³¨å…¥æ£€æµ‹å’Œè¿‡æ»¤
public class SqlInjectionFilter {
    
    // å±é™©å…³é”®è¯åˆ—è¡¨
    private static final String[] SQL_KEYWORDS = {
        "drop", "delete", "truncate", "exec", "execute",
        "union", "select", "insert", "update", "--", "/*"
    };
    
    public boolean containsSqlInjection(String input) {
        if (input == null) return false;
        
        String lowerInput = input.toLowerCase();
        for (String keyword : SQL_KEYWORDS) {
            if (lowerInput.contains(keyword)) {
                return true; // å‘ç°å±é™©å…³é”®è¯
            }
        }
        return false;
    }
    
    public String sanitizeInput(String input) {
        if (containsSqlInjection(input)) {
            throw new SecurityException("æ£€æµ‹åˆ°SQLæ³¨å…¥æ”»å‡»ï¼");
        }
        
        // è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦
        return input.replace("'", "''")
                   .replace("\"", "\\\"")
                   .replace(";", "");
    }
}
```

### 2.2 XSSæ”»å‡»é˜²æŠ¤


**ğŸ”¸ ä»€ä¹ˆæ˜¯XSSæ”»å‡»**
XSSå°±åƒæœ‰äººåœ¨ä½ çš„ç½‘ç«™ä¸Š**ç•™è¨€æ¿**å†™æ¶æ„ä»£ç ï¼Œå…¶ä»–ç”¨æˆ·çœ‹åˆ°ç•™è¨€æ—¶ï¼Œæ¶æ„ä»£ç å°±åœ¨ä»–ä»¬æµè§ˆå™¨é‡Œ**å·å·æ‰§è¡Œ**ã€‚

```
æ”»å‡»åœºæ™¯ï¼š
â‘ æ”»å‡»è€…åœ¨è¯„è®ºæ¡†è¾“å…¥ï¼š<script>alert('ä½ çš„å¯†ç è¢«å·äº†!')</script>
â‘¡å…¶ä»–ç”¨æˆ·æµè§ˆè¯„è®ºæ—¶ï¼Œå¼¹çª—æ‰§è¡Œ
â‘¢å®é™…æ”»å‡»ä¼šå·å–cookieã€å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯
```

**ğŸ§¹ HTMLè½¬ä¹‰é˜²æŠ¤**
```java
// XSSé˜²æŠ¤å·¥å…·ç±»
public class XssProtection {
    
    public String escapeHtml(String input) {
        if (input == null) return null;
        
        return input.replace("&", "&amp;")      // & â†’ &amp;
                   .replace("<", "&lt;")        // < â†’ &lt;
                   .replace(">", "&gt;")        // > â†’ &gt;
                   .replace("\"", "&quot;")     // " â†’ &quot;
                   .replace("'", "&#x27;");     // ' â†’ &#x27;
    }
    
    // å¤„ç†ç”¨æˆ·è¾“å…¥çš„è¯„è®º
    public String sanitizeComment(String comment) {
        // ç§»é™¤å±é™©æ ‡ç­¾
        comment = comment.replaceAll("<script.*?>.*?</script>", "");
        comment = comment.replaceAll("<.*?>", ""); // ç§»é™¤æ‰€æœ‰HTMLæ ‡ç­¾
        
        // HTMLè½¬ä¹‰
        return escapeHtml(comment);
    }
}
```

### 2.3 å‚æ•°ç±»å‹éªŒè¯


**ğŸ“‹ Bean Validationä½¿ç”¨**
```java
// ç”¨æˆ·æ³¨å†Œå‚æ•°éªŒè¯
public class UserRegisterRequest {
    
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @Size(min = 3, max = 20, message = "ç”¨æˆ·åé•¿åº¦3-20å­—ç¬¦")
    private String username;
    
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    @NotBlank(message = "é‚®ç®±ä¸èƒ½ä¸ºç©º")
    private String email;
    
    @Pattern(regexp = "^1[3-9]\\d{9}$", message = "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®")
    private String phone;
    
    @Min(value = 18, message = "å¹´é¾„ä¸èƒ½å°äº18å²")
    @Max(value = 120, message = "å¹´é¾„ä¸èƒ½å¤§äº120å²")
    private Integer age;
    
    // getter/setter...
}

// æ§åˆ¶å™¨ä¸­ä½¿ç”¨
@RestController
public class UserController {
    
    @PostMapping("/register")
    public Result register(@Valid @RequestBody UserRegisterRequest request) {
        // @Validæ³¨è§£è‡ªåŠ¨éªŒè¯ï¼Œå¤±è´¥æŠ›å¼‚å¸¸
        return userService.register(request);
    }
}
```

---

## 3. âœï¸ æ¥å£ç­¾åéªŒè¯æœºåˆ¶


### 3.1 ç­¾åéªŒè¯åŸç†


**ğŸ”¸ ä¸ºä»€ä¹ˆéœ€è¦ç­¾åéªŒè¯**
ç­¾åå°±åƒä½ çš„**æ‰‹å†™ç­¾å**ï¼Œåˆ«äººå¾ˆéš¾æ¨¡ä»¿ã€‚æ•°å­—ç­¾åç¡®ä¿ï¼š
- ğŸ“ **æ•°æ®å®Œæ•´æ€§**ï¼šå†…å®¹æ²¡æœ‰è¢«ç¯¡æ”¹
- ğŸ” **èº«ä»½è®¤è¯**ï¼šç¡®è®¤æ˜¯ä½ å‘é€çš„
- ğŸš« **ä¸å¯å¦è®¤æ€§**ï¼šä½ ä¸èƒ½å¦è®¤å‘é€è¿‡

```
ç­¾åéªŒè¯æµç¨‹ï¼š
å‘é€æ–¹ï¼šåŸå§‹æ•°æ® + ç§˜é’¥ â†’ è®¡ç®—ç­¾å â†’ å‘é€(æ•°æ®+ç­¾å)
æ¥æ”¶æ–¹ï¼šæ¥æ”¶æ•°æ® + ç§˜é’¥ â†’ é‡æ–°è®¡ç®—ç­¾å â†’ å¯¹æ¯”ç­¾åæ˜¯å¦ä¸€è‡´
```

**ğŸ”¹ HMACç­¾åå®ç°**
```java
// HMAC-SHA256ç­¾åå·¥å…·
public class SignatureUtil {
    
    public static String generateSignature(String data, String secretKey) {
        try {
            Mac mac = Mac.getInstance("HmacSHA256");
            SecretKeySpec keySpec = new SecretKeySpec(
                secretKey.getBytes(StandardCharsets.UTF_8), "HmacSHA256");
            mac.init(keySpec);
            
            byte[] hashBytes = mac.doFinal(data.getBytes(StandardCharsets.UTF_8));
            return Base64.getEncoder().encodeToString(hashBytes);
        } catch (Exception e) {
            throw new RuntimeException("ç­¾åç”Ÿæˆå¤±è´¥", e);
        }
    }
    
    public static boolean verifySignature(String data, String signature, String secretKey) {
        String expectedSignature = generateSignature(data, secretKey);
        return expectedSignature.equals(signature);
    }
}
```

### 3.2 è¯·æ±‚ç­¾åå®Œæ•´ç¤ºä¾‹


**ğŸ“ ç­¾åå‚æ•°æ„å»º**
```java
// APIè¯·æ±‚ç­¾å
public class ApiSigner {
    
    public String buildSignString(Map<String, Object> params, String timestamp, String nonce) {
        // â‘ å‚æ•°æŒ‰å­—æ¯é¡ºåºæ’åº
        TreeMap<String, Object> sortedParams = new TreeMap<>(params);
        
        // â‘¡æ„å»ºå‚æ•°å­—ç¬¦ä¸²
        StringBuilder signBuilder = new StringBuilder();
        sortedParams.forEach((key, value) -> {
            signBuilder.append(key).append("=").append(value).append("&");
        });
        
        // â‘¢æ·»åŠ æ—¶é—´æˆ³å’Œéšæœºæ•°
        signBuilder.append("timestamp=").append(timestamp).append("&");
        signBuilder.append("nonce=").append(nonce);
        
        return signBuilder.toString();
    }
    
    // å®Œæ•´çš„ç­¾åè¯·æ±‚
    public ApiRequest signRequest(Map<String, Object> params, String apiKey, String secret) {
        String timestamp = String.valueOf(System.currentTimeMillis());
        String nonce = UUID.randomUUID().toString().replace("-", "");
        
        // æ„å»ºç­¾åå­—ç¬¦ä¸²
        String signString = buildSignString(params, timestamp, nonce);
        
        // ç”Ÿæˆç­¾å
        String signature = SignatureUtil.generateSignature(signString, secret);
        
        return ApiRequest.builder()
                .params(params)
                .apiKey(apiKey)
                .timestamp(timestamp)
                .nonce(nonce)
                .signature(signature)
                .build();
    }
}
```

**ğŸ” æœåŠ¡ç«¯ç­¾åéªŒè¯**
```java
// ç­¾åéªŒè¯æ‹¦æˆªå™¨
@Component
public class SignatureInterceptor implements HandlerInterceptor {
    
    @Override
    public boolean preHandle(HttpServletRequest request, 
                           HttpServletResponse response, 
                           Object handler) {
        try {
            // â‘ æå–ç­¾åç›¸å…³å‚æ•°
            String apiKey = request.getHeader("X-API-Key");
            String timestamp = request.getHeader("X-Timestamp");
            String nonce = request.getHeader("X-Nonce");
            String signature = request.getHeader("X-Signature");
            
            // â‘¡åŸºç¡€éªŒè¯
            if (apiKey == null || signature == null) {
                response.setStatus(401);
                return false;
            }
            
            // â‘¢æ—¶é—´æˆ³éªŒè¯ï¼ˆ5åˆ†é’Ÿå†…æœ‰æ•ˆï¼‰
            long requestTime = Long.parseLong(timestamp);
            if (!isValidTimestamp(requestTime)) {
                response.setStatus(401);
                return false;
            }
            
            // â‘£è·å–APIå¯†é’¥
            String secret = getApiSecret(apiKey);
            if (secret == null) {
                response.setStatus(401);
                return false;
            }
            
            // â‘¤éªŒè¯ç­¾å
            Map<String, Object> params = extractRequestParams(request);
            String expectedSignature = calculateSignature(params, timestamp, nonce, secret);
            
            if (!signature.equals(expectedSignature)) {
                response.setStatus(401);
                return false;
            }
            
            return true; // éªŒè¯é€šè¿‡
            
        } catch (Exception e) {
            response.setStatus(500);
            return false;
        }
    }
}
```

---

## 4. ğŸ” æ•æ„Ÿæ•°æ®ä¿æŠ¤ç­–ç•¥


### 4.1 æ•°æ®åŠ å¯†ä¼ è¾“


**ğŸ”¸ å¯¹ç§°åŠ å¯†åº”ç”¨**
```java
// AESåŠ å¯†å·¥å…·
public class AesEncryption {
    private static final String ALGORITHM = "AES/CBC/PKCS5Padding";
    private static final String KEY_ALGORITHM = "AES";
    
    // åŠ å¯†æ•æ„Ÿæ•°æ®
    public static String encrypt(String plainText, String key) throws Exception {
        SecretKeySpec secretKey = new SecretKeySpec(key.getBytes(), KEY_ALGORITHM);
        Cipher cipher = Cipher.getInstance(ALGORITHM);
        
        // ç”Ÿæˆéšæœºåˆå§‹å‘é‡
        byte[] iv = new byte[16];
        new SecureRandom().nextBytes(iv);
        IvParameterSpec ivSpec = new IvParameterSpec(iv);
        
        cipher.init(Cipher.ENCRYPT_MODE, secretKey, ivSpec);
        byte[] encryptedBytes = cipher.doFinal(plainText.getBytes(StandardCharsets.UTF_8));
        
        // IV + åŠ å¯†æ•°æ® ä¸€èµ·è¿”å›
        byte[] result = new byte[iv.length + encryptedBytes.length];
        System.arraycopy(iv, 0, result, 0, iv.length);
        System.arraycopy(encryptedBytes, 0, result, iv.length, encryptedBytes.length);
        
        return Base64.getEncoder().encodeToString(result);
    }
    
    // è§£å¯†æ•æ„Ÿæ•°æ®
    public static String decrypt(String encryptedText, String key) throws Exception {
        byte[] encryptedData = Base64.getDecoder().decode(encryptedText);
        
        // æå–IVå’ŒåŠ å¯†æ•°æ®
        byte[] iv = new byte[16];
        byte[] encrypted = new byte[encryptedData.length - 16];
        System.arraycopy(encryptedData, 0, iv, 0, 16);
        System.arraycopy(encryptedData, 16, encrypted, 0, encrypted.length);
        
        SecretKeySpec secretKey = new SecretKeySpec(key.getBytes(), KEY_ALGORITHM);
        Cipher cipher = Cipher.getInstance(ALGORITHM);
        IvParameterSpec ivSpec = new IvParameterSpec(iv);
        
        cipher.init(Cipher.DECRYPT_MODE, secretKey, ivSpec);
        byte[] decryptedBytes = cipher.doFinal(encrypted);
        
        return new String(decryptedBytes, StandardCharsets.UTF_8);
    }
}
```

### 4.2 æ•æ„Ÿæ•°æ®è„±æ•


**ğŸ­ æ•°æ®è„±æ•ç­–ç•¥**
```java
// æ•æ„Ÿä¿¡æ¯è„±æ•å·¥å…·
public class DataMasking {
    
    // æ‰‹æœºå·è„±æ•ï¼š135****8888
    public static String maskPhone(String phone) {
        if (phone == null || phone.length() != 11) {
            return phone;
        }
        return phone.substring(0, 3) + "****" + phone.substring(7);
    }
    
    // èº«ä»½è¯è„±æ•ï¼š110101********1234
    public static String maskIdCard(String idCard) {
        if (idCard == null || idCard.length() < 8) {
            return idCard;
        }
        return idCard.substring(0, 6) + "********" + idCard.substring(idCard.length() - 4);
    }
    
    // é‚®ç®±è„±æ•ï¼šabc***@gmail.com
    public static String maskEmail(String email) {
        if (email == null || !email.contains("@")) {
            return email;
        }
        String[] parts = email.split("@");
        String username = parts[0];
        if (username.length() <= 3) {
            return username + "@" + parts[1];
        }
        return username.substring(0, 3) + "***@" + parts[1];
    }
    
    // é“¶è¡Œå¡è„±æ•ï¼š6225********1234
    public static String maskBankCard(String bankCard) {
        if (bankCard == null || bankCard.length() < 8) {
            return bankCard;
        }
        return bankCard.substring(0, 4) + "********" + bankCard.substring(bankCard.length() - 4);
    }
}

// åœ¨å“åº”ä¸­è‡ªåŠ¨è„±æ•
@JsonSerialize(using = PhoneMaskingSerializer.class)
public class PhoneMaskingSerializer extends JsonSerializer<String> {
    @Override
    public void serialize(String phone, JsonGenerator gen, SerializerProvider serializers) throws IOException {
        gen.writeString(DataMasking.maskPhone(phone));
    }
}
```

### 4.3 å¯†ç å®‰å…¨å­˜å‚¨


**ğŸ” å¯†ç åŠ å¯†å­˜å‚¨**
```java
// å¯†ç åŠ å¯†å·¥å…·
@Service
public class PasswordService {
    
    // ä½¿ç”¨BCryptåŠ å¯†å¯†ç 
    public String encryptPassword(String plainPassword) {
        // BCryptè‡ªåŠ¨ç”Ÿæˆsaltï¼Œæ¯æ¬¡ç»“æœéƒ½ä¸åŒ
        return BCrypt.hashpw(plainPassword, BCrypt.gensalt(12)); // å¼ºåº¦12
    }
    
    // éªŒè¯å¯†ç 
    public boolean validatePassword(String plainPassword, String hashedPassword) {
        try {
            return BCrypt.checkpw(plainPassword, hashedPassword);
        } catch (Exception e) {
            return false; // éªŒè¯å¤±è´¥
        }
    }
    
    // å¯†ç å¼ºåº¦æ£€æŸ¥
    public boolean isStrongPassword(String password) {
        if (password == null || password.length() < 8) {
            return false;
        }
        
        boolean hasUpper = password.matches(".*[A-Z].*");      // å¤§å†™å­—æ¯
        boolean hasLower = password.matches(".*[a-z].*");      // å°å†™å­—æ¯  
        boolean hasDigit = password.matches(".*\\d.*");        // æ•°å­—
        boolean hasSpecial = password.matches(".*[!@#$%^&*()].*"); // ç‰¹æ®Šå­—ç¬¦
        
        // è‡³å°‘åŒ…å«3ç§ç±»å‹
        int typeCount = (hasUpper ? 1 : 0) + (hasLower ? 1 : 0) + 
                       (hasDigit ? 1 : 0) + (hasSpecial ? 1 : 0);
        
        return typeCount >= 3;
    }
}
```

---

## 5. ğŸŒ ç½‘ç»œå®‰å…¨éš”ç¦»


### 5.1 VPCç½‘ç»œéš”ç¦»


**ğŸ”¸ ä»€ä¹ˆæ˜¯VPC**
VPCå°±åƒç»™ä½ çš„æœåŠ¡å™¨å»ºä¸€ä¸ª**ç§äººå°åŒº**ï¼Œåªæœ‰**æˆæƒçš„äºº**æ‰èƒ½è¿›å…¥ï¼Œä¸åŒå°åŒºä¹‹é—´**äº’ä¸å¹²æ‰°**ã€‚

```
ä¼ ç»Ÿç½‘ç»œï¼šæ‰€æœ‰æœåŠ¡å™¨åœ¨åŒä¸€ä¸ª"å¤§è¡—"ä¸Šï¼Œä»»ä½•äººéƒ½èƒ½è®¿é—®
    [æœåŠ¡å™¨A] â†â†’ [æœåŠ¡å™¨B] â†â†’ [æœåŠ¡å™¨C] â†â†’ å…¬ç½‘

VPCç½‘ç»œï¼šæ¯ä¸ªä¸šåŠ¡ä¸€ä¸ª"å°åŒº"ï¼Œå†…éƒ¨å®‰å…¨é€šä¿¡
    å°åŒºA: [WebæœåŠ¡] â†â†’ [åº”ç”¨æœåŠ¡]
           â†“ï¼ˆå—æ§è®¿é—®ï¼‰
    å°åŒºB: [æ•°æ®åº“] â†â†’ [ç¼“å­˜]
```

**ğŸ—ï¸ VPCé…ç½®ç¤ºä¾‹**
```yaml
# VPCç½‘ç»œè§„åˆ’
VPCé…ç½®:
  ç½‘æ®µ: 10.0.0.0/16
  
  å…¬æœ‰å­ç½‘: 10.0.1.0/24     # WebæœåŠ¡å™¨ï¼Œå¯è®¿é—®äº’è”ç½‘
    - WebæœåŠ¡å™¨: 10.0.1.10
    - è´Ÿè½½å‡è¡¡: 10.0.1.20
    
  ç§æœ‰å­ç½‘: 10.0.2.0/24     # åº”ç”¨æœåŠ¡å™¨ï¼Œä¸èƒ½ç›´æ¥è®¿é—®äº’è”ç½‘  
    - åº”ç”¨æœåŠ¡å™¨1: 10.0.2.10
    - åº”ç”¨æœåŠ¡å™¨2: 10.0.2.11
    
  æ•°æ®åº“å­ç½‘: 10.0.3.0/24   # æ•°æ®åº“ï¼Œæœ€é«˜å®‰å…¨çº§åˆ«
    - ä¸»æ•°æ®åº“: 10.0.3.10
    - å¤‡æ•°æ®åº“: 10.0.3.11
```

### 5.2 å®‰å…¨ç»„è§„åˆ™


**ğŸšª å®‰å…¨ç»„é…ç½®**
```java
// å®‰å…¨ç»„è§„åˆ™ç®¡ç†
public class SecurityGroupManager {
    
    // Webå±‚å®‰å…¨ç»„ï¼šåªå…è®¸HTTP/HTTPSè®¿é—®
    public SecurityGroup createWebSecurityGroup() {
        return SecurityGroup.builder()
                .name("web-sg")
                .description("WebæœåŠ¡å™¨å®‰å…¨ç»„")
                .inboundRules(Arrays.asList(
                    // å…è®¸HTTPè®¿é—®
                    Rule.builder()
                        .protocol("TCP")
                        .port(80)
                        .source("0.0.0.0/0")  // å…¨ç½‘å¯è®¿é—®
                        .build(),
                    // å…è®¸HTTPSè®¿é—®
                    Rule.builder()
                        .protocol("TCP")
                        .port(443)
                        .source("0.0.0.0/0")
                        .build(),
                    // å…è®¸SSHç®¡ç†ï¼ˆé™åˆ¶IPï¼‰
                    Rule.builder()
                        .protocol("TCP")
                        .port(22)
                        .source("admin.company.com") // åªå…è®¸ç®¡ç†å‘˜IP
                        .build()
                ))
                .build();
    }
    
    // åº”ç”¨å±‚å®‰å…¨ç»„ï¼šåªå…è®¸Webå±‚è®¿é—®
    public SecurityGroup createAppSecurityGroup() {
        return SecurityGroup.builder()
                .name("app-sg")
                .description("åº”ç”¨æœåŠ¡å™¨å®‰å…¨ç»„")
                .inboundRules(Arrays.asList(
                    // åªå…è®¸Webå±‚è®¿é—®åº”ç”¨ç«¯å£
                    Rule.builder()
                        .protocol("TCP")
                        .port(8080)
                        .source("sg-web")  // å¼•ç”¨Webå®‰å…¨ç»„
                        .build()
                ))
                .build();
    }
    
    // æ•°æ®åº“å®‰å…¨ç»„ï¼šåªå…è®¸åº”ç”¨å±‚è®¿é—®
    public SecurityGroup createDbSecurityGroup() {
        return SecurityGroup.builder()
                .name("db-sg")
                .description("æ•°æ®åº“å®‰å…¨ç»„")
                .inboundRules(Arrays.asList(
                    // åªå…è®¸åº”ç”¨å±‚è®¿é—®æ•°æ®åº“
                    Rule.builder()
                        .protocol("TCP")
                        .port(3306)
                        .source("sg-app")  // åªå…è®¸åº”ç”¨å®‰å…¨ç»„è®¿é—®
                        .build()
                ))
                .build();
    }
}
```

### 5.3 é˜²ç«å¢™é…ç½®


**ğŸ›¡ï¸ åº”ç”¨å±‚é˜²ç«å¢™**
```java
// WAFï¼ˆWebåº”ç”¨é˜²ç«å¢™ï¼‰è§„åˆ™
@Component
public class WebApplicationFirewall {
    
    // æ¶æ„IPé»‘åå•
    private Set<String> blockedIPs = new HashSet<>();
    
    // URLç™½åå•
    private Set<String> allowedPaths = Set.of(
        "/api/login", "/api/register", "/api/health"
    );
    
    @EventListener
    public boolean filterRequest(HttpServletRequest request) {
        String clientIP = getClientIP(request);
        String requestPath = request.getRequestURI();
        
        // â‘ æ£€æŸ¥IPé»‘åå•
        if (blockedIPs.contains(clientIP)) {
            logSecurityEvent("blocked_ip", clientIP, requestPath);
            return false;
        }
        
        // â‘¡æ£€æŸ¥è¯·æ±‚é¢‘ç‡
        if (isRateLimitExceeded(clientIP)) {
            // ä¸´æ—¶åŠ å…¥é»‘åå•
            blockedIPs.add(clientIP);
            return false;
        }
        
        // â‘¢æ£€æŸ¥URLè·¯å¾„
        if (!isAllowedPath(requestPath)) {
            logSecurityEvent("invalid_path", clientIP, requestPath);
            return false;
        }
        
        // â‘£æ£€æŸ¥è¯·æ±‚å†…å®¹
        if (containsMaliciousContent(request)) {
            logSecurityEvent("malicious_content", clientIP, requestPath);
            return false;
        }
        
        return true; // é€šè¿‡æ‰€æœ‰æ£€æŸ¥
    }
    
    private boolean containsMaliciousContent(HttpServletRequest request) {
        // æ£€æŸ¥å¸¸è§æ”»å‡»æ¨¡å¼
        String[] maliciousPatterns = {
            "script>", "javascript:", "eval(", "document.cookie",
            "union select", "drop table", "../", "..\\"
        };
        
        // æ£€æŸ¥æ‰€æœ‰å‚æ•°
        for (String param : request.getParameterMap().keySet()) {
            String value = request.getParameter(param).toLowerCase();
            for (String pattern : maliciousPatterns) {
                if (value.contains(pattern)) {
                    return true;
                }
            }
        }
        return false;
    }
}
```

---

## 6. ğŸ“Š å®‰å…¨å®¡è®¡ä½“ç³»


### 6.1 è®¿é—®æ—¥å¿—è®°å½•


**ğŸ“ å®‰å…¨æ—¥å¿—æ”¶é›†**
```java
// å®‰å…¨å®¡è®¡æ—¥å¿—
@Component
public class SecurityAuditLogger {
    
    private final Logger securityLogger = LoggerFactory.getLogger("SECURITY");
    
    // ç™»å½•å®¡è®¡
    public void logLogin(String username, String clientIP, boolean success, String reason) {
        SecurityEvent event = SecurityEvent.builder()
                .eventType("USER_LOGIN")
                .username(username)
                .clientIP(clientIP)
                .success(success)
                .reason(reason)
                .timestamp(Instant.now())
                .build();
        
        securityLogger.info("Security Event: {}", toJson(event));
        
        // å¤±è´¥ç™»å½•å‘Šè­¦
        if (!success) {
            checkFailedLoginPattern(username, clientIP);
        }
    }
    
    // APIè®¿é—®å®¡è®¡  
    public void logApiAccess(String apiKey, String endpoint, String clientIP, 
                           int responseCode, long responseTime) {
        SecurityEvent event = SecurityEvent.builder()
                .eventType("API_ACCESS")
                .apiKey(apiKey)
                .endpoint(endpoint)
                .clientIP(clientIP)
                .responseCode(responseCode)
                .responseTime(responseTime)
                .timestamp(Instant.now())
                .build();
        
        securityLogger.info("API Access: {}", toJson(event));
        
        // å¼‚å¸¸å“åº”å‘Šè­¦
        if (responseCode >= 400) {
            checkErrorPattern(apiKey, clientIP, responseCode);
        }
    }
    
    // æ•°æ®æ“ä½œå®¡è®¡
    public void logDataOperation(String username, String operation, 
                               String tableName, String recordId, Object oldValue, Object newValue) {
        SecurityEvent event = SecurityEvent.builder()
                .eventType("DATA_OPERATION")
                .username(username)
                .operation(operation)  // INSERT/UPDATE/DELETE
                .tableName(tableName)
                .recordId(recordId)
                .oldValue(toJson(oldValue))
                .newValue(toJson(newValue))
                .timestamp(Instant.now())
                .build();
        
        securityLogger.info("Data Operation: {}", toJson(event));
    }
    
    // æ£€æŸ¥å¤±è´¥ç™»å½•æ¨¡å¼
    private void checkFailedLoginPattern(String username, String clientIP) {
        // 5åˆ†é’Ÿå†…åŒä¸€IPå¤±è´¥3æ¬¡ â†’ ä¸´æ—¶å°ç¦
        // 1å°æ—¶å†…åŒä¸€ç”¨æˆ·å¤±è´¥10æ¬¡ â†’ è´¦æˆ·é”å®š
        // å®ç°å…·ä½“çš„å‘Šè­¦é€»è¾‘...
    }
}
```

### 6.2 æ“ä½œå®¡è®¡è¿½è¸ª


**ğŸ” æ“ä½œé“¾è·¯è¿½è¸ª**
```java
// æ“ä½œå®¡è®¡åˆ‡é¢
@Aspect
@Component
public class OperationAuditAspect {
    
    @Autowired
    private SecurityAuditLogger auditLogger;
    
    // æ‹¦æˆªæ‰€æœ‰æ ‡è®°äº†@Auditedçš„æ–¹æ³•
    @Around("@annotation(audited)")
    public Object auditOperation(ProceedingJoinPoint joinPoint, Audited audited) throws Throwable {
        String operationName = audited.value();
        String username = getCurrentUsername();
        Object[] args = joinPoint.getArgs();
        
        // è®°å½•æ“ä½œå¼€å§‹
        auditLogger.logOperationStart(username, operationName, args);
        
        try {
            Object result = joinPoint.proceed();
            
            // è®°å½•æ“ä½œæˆåŠŸ
            auditLogger.logOperationSuccess(username, operationName, result);
            return result;
            
        } catch (Exception e) {
            // è®°å½•æ“ä½œå¤±è´¥
            auditLogger.logOperationFailure(username, operationName, e.getMessage());
            throw e;
        }
    }
}

// ä½¿ç”¨ç¤ºä¾‹
@Service
public class UserService {
    
    @Audited("ç”¨æˆ·æ³¨å†Œ")
    public User registerUser(UserRegisterRequest request) {
        // ç”¨æˆ·æ³¨å†Œé€»è¾‘
        return userRepository.save(newUser);
    }
    
    @Audited("å¯†ç ä¿®æ”¹") 
    public void changePassword(String username, String newPassword) {
        // å¯†ç ä¿®æ”¹é€»è¾‘
        userRepository.updatePassword(username, encryptedPassword);
    }
    
    @Audited("ç”¨æˆ·åˆ é™¤")
    public void deleteUser(String username) {
        // ç”¨æˆ·åˆ é™¤é€»è¾‘
        userRepository.deleteByUsername(username);
    }
}
```

### 6.3 åˆè§„è¦æ±‚æ£€æŸ¥


**ğŸ“‹ åˆè§„æ£€æŸ¥æ¸…å•**
```java
// æ•°æ®åˆè§„æ£€æŸ¥
@Service
public class ComplianceChecker {
    
    // GDPRåˆè§„æ£€æŸ¥
    public ComplianceResult checkGdprCompliance(UserData userData) {
        List<String> violations = new ArrayList<>();
        
        // â‘ æ•°æ®æœ€å°åŒ–åŸåˆ™
        if (hasUnnecessaryData(userData)) {
            violations.add("æ”¶é›†äº†éå¿…è¦çš„ä¸ªäººæ•°æ®");
        }
        
        // â‘¡æ•°æ®ä¿ç•™æœŸé™æ£€æŸ¥
        if (isDataExpired(userData)) {
            violations.add("æ•°æ®ä¿ç•™æ—¶é—´è¶…è¿‡åˆç†æœŸé™");
        }
        
        // â‘¢ç”¨æˆ·åŒæ„æ£€æŸ¥
        if (!hasValidConsent(userData.getUserId())) {
            violations.add("ç¼ºå°‘æœ‰æ•ˆçš„ç”¨æˆ·æ•°æ®å¤„ç†åŒæ„");
        }
        
        // â‘£æ•°æ®åŠ å¯†æ£€æŸ¥
        if (!isDataEncrypted(userData)) {
            violations.add("æ•æ„Ÿæ•°æ®æœªåŠ å¯†å­˜å‚¨");
        }
        
        return ComplianceResult.builder()
                .compliant(violations.isEmpty())
                .violations(violations)
                .checkTime(Instant.now())
                .build();
    }
    
    // ç­‰çº§ä¿æŠ¤åˆè§„æ£€æŸ¥
    public ComplianceResult checkLevelProtectionCompliance() {
        List<String> violations = new ArrayList<>();
        
        // èº«ä»½é‰´åˆ«
        if (!hasStrongPasswordPolicy()) {
            violations.add("å¯†ç ç­–ç•¥ä¸ç¬¦åˆè¦æ±‚");
        }
        
        // è®¿é—®æ§åˆ¶
        if (!hasRoleBasedAccess()) {
            violations.add("ç¼ºå°‘åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶");
        }
        
        // å®‰å…¨å®¡è®¡
        if (!hasCompleteAuditLog()) {
            violations.add("å®¡è®¡æ—¥å¿—è®°å½•ä¸å®Œæ•´");
        }
        
        // æ•°æ®å®Œæ•´æ€§
        if (!hasDataIntegrityCheck()) {
            violations.add("ç¼ºå°‘æ•°æ®å®Œæ•´æ€§æ ¡éªŒ");
        }
        
        return ComplianceResult.builder()
                .compliant(violations.isEmpty())
                .violations(violations)
                .standard("ç­‰çº§ä¿æŠ¤2.0")
                .checkTime(Instant.now())
                .build();
    }
    
    // å®šæœŸåˆè§„æ£€æŸ¥ä»»åŠ¡
    @Scheduled(cron = "0 0 2 * * ?") // æ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œ
    public void dailyComplianceCheck() {
        ComplianceResult gdpr = checkGdprCompliance(getAllUserData());
        ComplianceResult levelProtection = checkLevelProtectionCompliance();
        
        // ç”Ÿæˆåˆè§„æŠ¥å‘Š
        ComplianceReport report = ComplianceReport.builder()
                .gdprResult(gdpr)
                .levelProtectionResult(levelProtection)
                .reportDate(LocalDate.now())
                .build();
        
        // å¦‚æœæœ‰è¿è§„é¡¹ï¼Œå‘é€å‘Šè­¦
        if (!gdpr.isCompliant() || !levelProtection.isCompliant()) {
            alertService.sendComplianceAlert(report);
        }
        
        // ä¿å­˜æŠ¥å‘Š
        complianceReportRepository.save(report);
    }
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„å®‰å…¨é˜²æŠ¤æ¦‚å¿µ


**ğŸ›¡ï¸ æ”»å‡»é˜²æŠ¤æ ¸å¿ƒ**
- **é‡æ”¾æ”»å‡»é˜²æŠ¤**ï¼šæ—¶é—´æˆ³+éšæœºæ•°åŒé‡éªŒè¯æœºåˆ¶
- **ä¸­é—´äººæ”»å‡»é˜²æŠ¤**ï¼šHTTPSåŠ å¯†ä¼ è¾“+è¯ä¹¦éªŒè¯
- **DDoSæ”»å‡»é˜²æŠ¤**ï¼šé™æµç­–ç•¥+é»‘ç™½åå•æœºåˆ¶

**ğŸ” æ•°æ®å®‰å…¨æ ¸å¿ƒ**
- **è¾“å…¥éªŒè¯**ï¼šSQLæ³¨å…¥ã€XSSæ”»å‡»çš„é¢„é˜²å’Œè¿‡æ»¤
- **ç­¾åéªŒè¯**ï¼šHMACç®—æ³•ç¡®ä¿æ•°æ®å®Œæ•´æ€§å’Œèº«ä»½è®¤è¯
- **æ•æ„Ÿæ•°æ®ä¿æŠ¤**ï¼šAESåŠ å¯†ä¼ è¾“+BCryptå¯†ç å­˜å‚¨+è„±æ•å±•ç¤º

### 7.2 å…³é”®å®‰å…¨æœºåˆ¶ç†è§£


**ğŸ”¹ çºµæ·±é˜²å¾¡ç­–ç•¥**
```
ç½‘ç»œå±‚ï¼šVPCéš”ç¦» + å®‰å…¨ç»„ + é˜²ç«å¢™
åº”ç”¨å±‚ï¼šè¾“å…¥éªŒè¯ + ç­¾åéªŒè¯ + æƒé™æ§åˆ¶  
æ•°æ®å±‚ï¼šåŠ å¯†å­˜å‚¨ + è®¿é—®å®¡è®¡ + å¤‡ä»½æ¢å¤
```

**ğŸ”¹ å®‰å…¨ä¸æ€§èƒ½å¹³è¡¡**
- âœ… **å¿…è¦çš„å®‰å…¨æ£€æŸ¥**ï¼šç­¾åéªŒè¯ã€è¾“å…¥è¿‡æ»¤ã€æƒé™æ ¡éªŒ
- âš ï¸ **æ€§èƒ½ä¼˜åŒ–è€ƒè™‘**ï¼šç¼“å­˜éªŒè¯ç»“æœã€å¼‚æ­¥æ—¥å¿—è®°å½•
- ğŸš« **è¿‡åº¦é˜²æŠ¤é¿å…**ï¼šè¿‡äºå¤æ‚çš„éªŒè¯å½±å“ç”¨æˆ·ä½“éªŒ

### 7.3 å®é™…åº”ç”¨æŒ‡å¯¼åŸåˆ™


**ğŸ“Š é£é™©è¯„ä¼°ä¼˜å…ˆçº§**
```
é«˜é£é™©ï¼šç”¨æˆ·è®¤è¯ã€èµ„é‡‘æ“ä½œã€æ•æ„Ÿæ•°æ®è®¿é—®
ä¸­é£é™©ï¼šä¸šåŠ¡æ•°æ®æŸ¥è¯¢ã€æ–‡ä»¶ä¸Šä¼ ä¸‹è½½  
ä½é£é™©ï¼šé™æ€é¡µé¢è®¿é—®ã€å…¬å¼€ä¿¡æ¯æŸ¥è¯¢

é˜²æŠ¤ç­–ç•¥åŒ¹é…ï¼š
é«˜é£é™© â†’ å¤šé‡éªŒè¯ + å¼ºåŠ å¯† + å®æ—¶ç›‘æ§
ä¸­é£é™© â†’ åŸºç¡€éªŒè¯ + è®¿é—®æ§åˆ¶ + å®¡è®¡æ—¥å¿—
ä½é£é™© â†’ åŸºæœ¬é˜²æŠ¤ + å¼‚å¸¸æ£€æµ‹
```

**âš¡ æœ€ä½³å®è·µè¦ç‚¹**
- **è¾“å…¥éªŒè¯**ï¼šæ°¸è¿œä¸è¦ä¿¡ä»»ç”¨æˆ·è¾“å…¥ï¼Œå…ˆéªŒè¯å†å¤„ç†
- **æƒé™æ§åˆ¶**ï¼šé»˜è®¤æ‹’ç»ï¼Œæ˜ç¡®æˆæƒï¼Œæœ€å°æƒé™åŸåˆ™
- **å¯†ç å®‰å…¨**ï¼šå¼ºåˆ¶å¤æ‚å¯†ç ï¼ŒBCryptåŠ å¯†ï¼Œå®šæœŸæ›´æ¢
- **å®¡è®¡æ—¥å¿—**ï¼šè®°å½•å…³é”®æ“ä½œï¼Œå®šæœŸåˆ†æï¼Œé•¿æœŸä¿å­˜
- **åº”æ€¥å“åº”**ï¼šåˆ¶å®šå®‰å…¨äº‹ä»¶åº”æ€¥é¢„æ¡ˆï¼Œå®šæœŸæ¼”ç»ƒ

### 7.4 å®‰å…¨å¼€å‘æ£€æŸ¥æ¸…å•


**ğŸ” å¼€å‘é˜¶æ®µæ£€æŸ¥**
- [ ] æ‰€æœ‰ç”¨æˆ·è¾“å…¥éƒ½è¿›è¡ŒéªŒè¯å’Œè¿‡æ»¤
- [ ] æ•æ„Ÿæ•°æ®ä¼ è¾“å’Œå­˜å‚¨éƒ½å·²åŠ å¯†
- [ ] å®ç°äº†å®Œæ•´çš„èº«ä»½è®¤è¯å’Œæˆæƒ
- [ ] æ·»åŠ äº†å¿…è¦çš„å®‰å…¨å®¡è®¡æ—¥å¿—
- [ ] é…ç½®äº†é€‚å½“çš„ç½‘ç»œå®‰å…¨ç­–ç•¥

**ğŸ› ï¸ æµ‹è¯•é˜¶æ®µæ£€æŸ¥**
- [ ] è¿›è¡ŒSQLæ³¨å…¥ã€XSSç­‰å®‰å…¨æµ‹è¯•
- [ ] éªŒè¯ç­¾åæœºåˆ¶å’ŒåŠ å¯†å®ç°
- [ ] æµ‹è¯•å¼‚å¸¸æƒ…å†µä¸‹çš„å®‰å…¨è¡¨ç°
- [ ] æ£€æŸ¥æ—¥å¿—è®°å½•çš„å®Œæ•´æ€§
- [ ] ç¡®è®¤åˆè§„è¦æ±‚çš„æ»¡è¶³æƒ…å†µ

**æ ¸å¿ƒå®‰å…¨ç†å¿µ**ï¼š
- å®‰å…¨æ˜¯ç³»ç»Ÿæ€§å·¥ç¨‹ï¼Œéœ€è¦å¤šå±‚é˜²æŠ¤
- é¢„é˜²ä¸ºä¸»ï¼Œæ£€æµ‹ä¸ºè¾…ï¼Œå“åº”åŠæ—¶
- å¹³è¡¡å®‰å…¨æ€§ã€å¯ç”¨æ€§å’Œæ€§èƒ½éœ€æ±‚
- æŒç»­æ”¹è¿›ï¼Œå®šæœŸè¯„ä¼°å®‰å…¨é£é™©