---
title: 2ã€é‡è¯•æœºåˆ¶è®¾è®¡
---
## ğŸ“š ç›®å½•

1. [é‡è¯•æœºåˆ¶åŸºç¡€æ¦‚å¿µ](#1-é‡è¯•æœºåˆ¶åŸºç¡€æ¦‚å¿µ)
2. [é‡è¯•çš„é€‚ç”¨åœºæ™¯](#2-é‡è¯•çš„é€‚ç”¨åœºæ™¯)
3. [é‡è¯•è§¦å‘æ¡ä»¶](#3-é‡è¯•è§¦å‘æ¡ä»¶)
4. [é‡è¯•ç­–ç•¥è¯¦è§£](#4-é‡è¯•ç­–ç•¥è¯¦è§£)
5. [å¹‚ç­‰æ€§ä¸å®‰å…¨è®¾è®¡](#5-å¹‚ç­‰æ€§ä¸å®‰å…¨è®¾è®¡)
6. [æ™ºèƒ½é‡è¯•è®¾è®¡](#6-æ™ºèƒ½é‡è¯•è®¾è®¡)
7. [é‡è¯•çš„å‰¯ä½œç”¨ä¸é˜²æŠ¤](#7-é‡è¯•çš„å‰¯ä½œç”¨ä¸é˜²æŠ¤)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ é‡è¯•æœºåˆ¶åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯é‡è¯•æœºåˆ¶


**ğŸ’¡ é€šä¿—ç†è§£**
é‡è¯•æœºåˆ¶å°±åƒ**æ‰“ç”µè¯æ²¡æ¥é€šæ—¶ä¼šå†æ‰“å‡ æ¬¡**ä¸€æ ·ã€‚åœ¨RPCè°ƒç”¨ä¸­ï¼Œå½“ç¬¬ä¸€æ¬¡è°ƒç”¨å¤±è´¥æ—¶ï¼Œç³»ç»Ÿä¼š**è‡ªåŠ¨å†è¯•å‡ æ¬¡**ï¼Œå¸Œæœ›åé¢çš„å°è¯•èƒ½æˆåŠŸã€‚

```
ç°å®ç”Ÿæ´»ä¸­çš„é‡è¯•ï¼š
ğŸª ä¹°ä¸œè¥¿åˆ·å¡å¤±è´¥ â†’ å†åˆ·ä¸€æ¬¡
ğŸ“ æ‰“ç”µè¯æ²¡æ¥é€š â†’ ç­‰ä¼šå„¿å†æ‰“
ğŸš— æ±½è½¦æ‰“ä¸ç€ç« â†’ å†è¯•å‡ æ¬¡

RPCè°ƒç”¨ä¸­çš„é‡è¯•ï¼š
å®¢æˆ·ç«¯ â†’ æœåŠ¡ç«¯ (å¤±è´¥)
å®¢æˆ·ç«¯ â†’ æœåŠ¡ç«¯ (é‡è¯•1) 
å®¢æˆ·ç«¯ â†’ æœåŠ¡ç«¯ (é‡è¯•2) âœ…
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦é‡è¯•æœºåˆ¶


**ğŸ” æ ¸å¿ƒåŸå› **
ç½‘ç»œé€šä¿¡**å¤©ç„¶ä¸ç¨³å®š**ï¼Œå°±åƒ**èµ°è·¯å¯èƒ½é‡åˆ°çº¢ç»¿ç¯**ä¸€æ ·ï¼ŒRPCè°ƒç”¨ä¹Ÿä¼šé‡åˆ°å„ç§**ä¸´æ—¶æ€§é—®é¢˜**ï¼š

```
ç½‘ç»œé—®é¢˜ï¼š
ğŸ“¡ ç½‘ç»œæŠ–åŠ¨ â†’ æ•°æ®åŒ…ä¸¢å¤±
âš¡ ç½‘ç»œæ‹¥å µ â†’ ä¼ è¾“å˜æ…¢
ğŸ”Œ ç½‘ç»œæ–­å¼€ â†’ è¿æ¥ä¸­æ–­

æœåŠ¡é—®é¢˜ï¼š
ğŸ¥ æœåŠ¡é‡å¯ â†’ æš‚æ—¶ä¸å¯ç”¨
ğŸš€ æœåŠ¡å‡çº§ â†’ çŸ­æš‚åœæœº
ğŸ“Š è´Ÿè½½è¿‡é«˜ â†’ å“åº”å˜æ…¢
```

**ğŸ’­ é‡è¯•çš„ä»·å€¼**
- **æé«˜æˆåŠŸç‡**ï¼šå¾ˆå¤šå¤±è´¥æ˜¯**ä¸´æ—¶æ€§**çš„ï¼Œé‡è¯•å°±èƒ½æˆåŠŸ
- **æ”¹å–„ç”¨æˆ·ä½“éªŒ**ï¼šç”¨æˆ·æ„Ÿè§‰ä¸åˆ°å¶å‘æ€§çš„å¤±è´¥
- **å¢å¼ºç³»ç»Ÿç¨³å®šæ€§**ï¼šè®©ç³»ç»Ÿèƒ½**è‡ªåŠ¨å¤„ç†**å¸¸è§æ•…éšœ

---

## 2. ğŸª é‡è¯•çš„é€‚ç”¨åœºæ™¯


### 2.1 ç½‘ç»œæŠ–åŠ¨åœºæ™¯


**ğŸŒŠ ä»€ä¹ˆæ˜¯ç½‘ç»œæŠ–åŠ¨**
ç½‘ç»œæŠ–åŠ¨å°±åƒ**æ‰‹æœºä¿¡å·æ—¶å¼ºæ—¶å¼±**ï¼Œç½‘ç»œè´¨é‡ä¼šçŸ­æ—¶é—´æ³¢åŠ¨ã€‚

```
å…¸å‹è¡¨ç°ï¼š
- å¶å°”çš„æ•°æ®åŒ…ä¸¢å¤±
- ç½‘ç»œå»¶è¿Ÿçªç„¶å¢å¤§
- è¿æ¥æš‚æ—¶ä¸­æ–­

é‡è¯•æ•ˆæœï¼š
ç¬¬1æ¬¡ï¼šç½‘ç»œæŠ–åŠ¨ï¼Œå¤±è´¥ âŒ
ç¬¬2æ¬¡ï¼šç½‘ç»œæ¢å¤ï¼ŒæˆåŠŸ âœ…
```

**ğŸ“ å®é™…æ¡ˆä¾‹**
```java
// æ¨¡æ‹Ÿç½‘ç»œæŠ–åŠ¨åœºæ™¯
public class NetworkExample {
    public String callService() {
        // æ¨¡æ‹Ÿï¼š90%çš„æ—¶å€™ç½‘ç»œæ­£å¸¸ï¼Œ10%çš„æ—¶å€™æŠ–åŠ¨
        if (Math.random() < 0.1) {
            throw new NetworkException("ç½‘ç»œæŠ–åŠ¨");
        }
        return "è°ƒç”¨æˆåŠŸ";
    }
}
```

### 2.2 æœåŠ¡ä¸´æ—¶ä¸å¯ç”¨


**ğŸ¥ æœåŠ¡ä¸´æ—¶ä¸å¯ç”¨çš„æƒ…å†µ**
å°±åƒ**å•†åº—ä¸´æ—¶å…³é—¨**ï¼ŒæœåŠ¡æœ‰æ—¶ä¼šçŸ­æš‚ä¸å¯ç”¨ï¼š

```
å¸¸è§åŸå› ï¼š
ğŸ”„ æœåŠ¡é‡å¯ï¼šå‡çº§ã€ç»´æŠ¤å¯¼è‡´çš„çŸ­æš‚åœæœº
ğŸ“Š è´Ÿè½½è¿‡é«˜ï¼šç¬é—´è¯·æ±‚å¤ªå¤šï¼ŒæœåŠ¡æ¥ä¸åŠå¤„ç†
ğŸ§  å†…å­˜ä¸è¶³ï¼šåƒåœ¾å›æ”¶å¯¼è‡´çš„çŸ­æš‚åœé¡¿
ğŸ”§ é…ç½®æ›´æ–°ï¼šåŠ¨æ€é…ç½®å˜æ›´æ—¶çš„çŸ­æš‚å½±å“
```

**â° æ—¶é—´ç‰¹ç‚¹**
- **æŒç»­æ—¶é—´çŸ­**ï¼šé€šå¸¸å‡ ç§’åˆ°å‡ åˆ†é’Ÿ
- **è‡ªåŠ¨æ¢å¤**ï¼šä¸éœ€è¦äººå·¥å¹²é¢„
- **é‡è¯•æœ‰æ•ˆ**ï¼šç­‰ä¸€ä¸‹å†è¯•å°±èƒ½æˆåŠŸ

### 2.3 è´Ÿè½½è¿‡é«˜åœºæ™¯


**ğŸ“ˆ ä»€ä¹ˆæ˜¯è´Ÿè½½è¿‡é«˜**
å°±åƒ**é¤å…ç”¨é¤é«˜å³°æœŸ**ï¼ŒæœåŠ¡å™¨å¤„ç†ä¸è¿‡æ¥æ‰€æœ‰è¯·æ±‚ï¼š

```
è´Ÿè½½è¿‡é«˜çš„è¡¨ç°ï¼š
â±ï¸ å“åº”æ—¶é—´å˜é•¿
âŒ éƒ¨åˆ†è¯·æ±‚è¶…æ—¶
ğŸ”„ æœåŠ¡è¿”å›"ç¨åå†è¯•"
```

**ğŸ¯ é‡è¯•çš„ä½œç”¨**
é€šè¿‡**å»¶è¿Ÿé‡è¯•**ï¼Œé”™å¼€é«˜å³°æœŸï¼Œæé«˜æˆåŠŸæ¦‚ç‡ã€‚

---

## 3. ğŸš¨ é‡è¯•è§¦å‘æ¡ä»¶


### 3.1 ç½‘ç»œå¼‚å¸¸


**ğŸŒ ç½‘ç»œå¼‚å¸¸çš„ç±»å‹**
```
è¿æ¥å¼‚å¸¸ï¼š
- ConnectExceptionï¼šæ— æ³•å»ºç«‹è¿æ¥
- ConnectTimeoutExceptionï¼šè¿æ¥è¶…æ—¶
- SocketTimeoutExceptionï¼šSocketè¶…æ—¶

ä¼ è¾“å¼‚å¸¸ï¼š
- IOExceptionï¼šIOè¯»å†™å¼‚å¸¸
- NoRouteToHostExceptionï¼šæ— æ³•åˆ°è¾¾ä¸»æœº
- UnknownHostExceptionï¼šä¸»æœºåè§£æå¤±è´¥
```

**âœ… å¯é‡è¯•çš„ç½‘ç»œå¼‚å¸¸**
```java
public boolean isRetryableNetworkException(Exception e) {
    // è¿™äº›å¼‚å¸¸é€šå¸¸æ˜¯ä¸´æ—¶æ€§çš„ï¼Œå€¼å¾—é‡è¯•
    return e instanceof ConnectException ||
           e instanceof SocketTimeoutException ||
           e instanceof ConnectTimeoutException;
}
```

### 3.2 æœåŠ¡å¼‚å¸¸


**ğŸ”§ æœåŠ¡å¼‚å¸¸çš„åˆ†ç±»**
```
ä¸´æ—¶æ€§å¼‚å¸¸ï¼ˆå¯é‡è¯•ï¼‰ï¼š
- 503 Service Unavailableï¼šæœåŠ¡æš‚æ—¶ä¸å¯ç”¨
- 502 Bad Gatewayï¼šç½‘å…³é”™è¯¯
- 504 Gateway Timeoutï¼šç½‘å…³è¶…æ—¶

æ°¸ä¹…æ€§å¼‚å¸¸ï¼ˆä¸å¯é‡è¯•ï¼‰ï¼š
- 400 Bad Requestï¼šè¯·æ±‚å‚æ•°é”™è¯¯
- 401 Unauthorizedï¼šè®¤è¯å¤±è´¥
- 403 Forbiddenï¼šæƒé™ä¸è¶³
- 404 Not Foundï¼šèµ„æºä¸å­˜åœ¨
```

**ğŸ¯ å¼‚å¸¸åˆ¤æ–­é€»è¾‘**
```java
public boolean isRetryableServiceException(int statusCode) {
    // 5xxé”™è¯¯é€šå¸¸æ˜¯æœåŠ¡å™¨ä¸´æ—¶é—®é¢˜ï¼Œå¯ä»¥é‡è¯•
    // 4xxé”™è¯¯é€šå¸¸æ˜¯å®¢æˆ·ç«¯é—®é¢˜ï¼Œé‡è¯•æ²¡æ„ä¹‰
    return statusCode >= 500 && statusCode < 600;
}
```

### 3.3 è¶…æ—¶å¼‚å¸¸


**â° è¶…æ—¶çš„ä¸¤ç§æƒ…å†µ**
```
è¯»å–è¶…æ—¶ï¼š
- æœåŠ¡å™¨å¤„ç†å¤ªæ…¢
- ç½‘ç»œä¼ è¾“å»¶è¿Ÿ
- é€šå¸¸å¯ä»¥é‡è¯•

è¿æ¥è¶…æ—¶ï¼š
- æœåŠ¡å™¨ä¸å“åº”
- ç½‘ç»œä¸é€š
- å¯ä»¥é‡è¯•å‡ æ¬¡
```

**ğŸ“Š è¶…æ—¶é‡è¯•ç­–ç•¥**
```java
public class TimeoutRetryExample {
    private final int[] timeouts = {1000, 2000, 3000}; // é€’å¢è¶…æ—¶æ—¶é—´
    
    public String callWithTimeout(int retryCount) {
        int timeout = timeouts[Math.min(retryCount, timeouts.length - 1)];
        // é‡è¯•æ—¶ä½¿ç”¨æ›´é•¿çš„è¶…æ—¶æ—¶é—´
        return httpClient.call(url, timeout);
    }
}
```

---

## 4. ğŸ”„ é‡è¯•ç­–ç•¥è¯¦è§£


### 4.1 ç«‹å³é‡è¯•


**âš¡ ä»€ä¹ˆæ˜¯ç«‹å³é‡è¯•**
å°±åƒ**ç”µæ¢¯æŒ‰é’®æ²¡ååº”å°±é©¬ä¸Šå†æŒ‰ä¸€ä¸‹**ï¼Œå¤±è´¥åç«‹å³å†è¯•ã€‚

```
é€‚ç”¨åœºæ™¯ï¼š
âœ… ç½‘ç»œç¬é—´æŠ–åŠ¨
âœ… å¶å‘æ€§æ•…éšœ
âœ… å¯¹å»¶è¿Ÿæ•æ„Ÿçš„åœºæ™¯

ä¸é€‚ç”¨åœºæ™¯ï¼š
âŒ æœåŠ¡è¿‡è½½
âŒ ç³»ç»Ÿæ€§æ•…éšœ
âŒ èµ„æºç«äº‰æ¿€çƒˆ
```

**ğŸ“ å®ç°ç¤ºä¾‹**
```java
public class ImmediateRetry {
    public String call() {
        for (int i = 0; i < 3; i++) {
            try {
                return service.call();
            } catch (Exception e) {
                if (i == 2) throw e; // æœ€åä¸€æ¬¡é‡è¯•å¤±è´¥å°±æŠ›å¼‚å¸¸
                // ç«‹å³é‡è¯•ï¼Œä¸ç­‰å¾…
            }
        }
        return null;
    }
}
```

### 4.2 å›ºå®šå»¶è¿Ÿé‡è¯•


**â±ï¸ ä»€ä¹ˆæ˜¯å›ºå®šå»¶è¿Ÿ**
å°±åƒ**æ¯éš”5åˆ†é’Ÿçœ‹ä¸€æ¬¡æ˜¯å¦æœ‰äººå›å¤æ¶ˆæ¯**ï¼Œæ¯æ¬¡é‡è¯•éƒ½ç­‰å¾…ç›¸åŒçš„æ—¶é—´ã€‚

```
å»¶è¿Ÿç­–ç•¥ï¼š
ç¬¬1æ¬¡å¤±è´¥ â†’ ç­‰å¾…2ç§’ â†’ ç¬¬1æ¬¡é‡è¯•
ç¬¬1æ¬¡é‡è¯•å¤±è´¥ â†’ ç­‰å¾…2ç§’ â†’ ç¬¬2æ¬¡é‡è¯•
ç¬¬2æ¬¡é‡è¯•å¤±è´¥ â†’ ç­‰å¾…2ç§’ â†’ ç¬¬3æ¬¡é‡è¯•
```

**ğŸ¯ ä¼˜ç¼ºç‚¹åˆ†æ**
```
ä¼˜ç‚¹ï¼š
âœ… å®ç°ç®€å•
âœ… è¡Œä¸ºå¯é¢„æµ‹
âœ… èµ„æºæ¶ˆè€—å‡åŒ€

ç¼ºç‚¹ï¼š
âŒ å¯èƒ½äº§ç”Ÿé‡è¯•é£æš´
âŒ æ— æ³•é€‚åº”ä¸åŒæ•…éšœç±»å‹
âŒ æ•ˆç‡ä¸å¤Ÿé«˜
```

**ğŸ“ å®ç°ç¤ºä¾‹**
```java
public class FixedDelayRetry {
    private final long delayMs = 2000; // å›ºå®šå»¶è¿Ÿ2ç§’
    
    public String callWithFixedDelay() {
        for (int i = 0; i < 3; i++) {
            try {
                return service.call();
            } catch (Exception e) {
                if (i == 2) throw e;
                
                try {
                    Thread.sleep(delayMs); // å›ºå®šå»¶è¿Ÿ
                } catch (InterruptedException ie) {
                    Thread.currentThread().interrupt();
                    throw new RuntimeException(ie);
                }
            }
        }
        return null;
    }
}
```

### 4.3 æŒ‡æ•°é€€é¿é‡è¯•


**ğŸ“ˆ ä»€ä¹ˆæ˜¯æŒ‡æ•°é€€é¿**
å°±åƒ**æ’é˜Ÿä¹°ç¥¨ï¼Œäººè¶Šå¤šç­‰çš„æ—¶é—´è¶Šé•¿**ï¼Œæ¯æ¬¡é‡è¯•çš„ç­‰å¾…æ—¶é—´**æˆå€å¢é•¿**ã€‚

```
é€€é¿ç­–ç•¥ï¼š
ç¬¬1æ¬¡å¤±è´¥ â†’ ç­‰å¾…1ç§’ â†’ ç¬¬1æ¬¡é‡è¯•
ç¬¬1æ¬¡é‡è¯•å¤±è´¥ â†’ ç­‰å¾…2ç§’ â†’ ç¬¬2æ¬¡é‡è¯•  
ç¬¬2æ¬¡é‡è¯•å¤±è´¥ â†’ ç­‰å¾…4ç§’ â†’ ç¬¬3æ¬¡é‡è¯•
ç¬¬3æ¬¡é‡è¯•å¤±è´¥ â†’ ç­‰å¾…8ç§’ â†’ ç¬¬4æ¬¡é‡è¯•

å…¬å¼ï¼šç­‰å¾…æ—¶é—´ = åŸºç¡€å»¶è¿Ÿ Ã— 2^é‡è¯•æ¬¡æ•°
```

**ğŸŒŸ ä¸ºä»€ä¹ˆç”¨æŒ‡æ•°é€€é¿**
```
é¿å…é‡è¯•é£æš´ï¼š
- å¤§é‡å®¢æˆ·ç«¯åŒæ—¶é‡è¯•
- ç»™æœåŠ¡ç«¯é€ æˆæ›´å¤§å‹åŠ›
- æŒ‡æ•°é€€é¿è®©é‡è¯•æ—¶é—´åˆ†æ•£

è‡ªé€‚åº”è°ƒèŠ‚ï¼š
- æ•…éšœæŒç»­æ—¶é—´çŸ­ â†’ æ—©æœŸé‡è¯•æˆåŠŸ
- æ•…éšœæŒç»­æ—¶é—´é•¿ â†’ åæœŸç»™æœåŠ¡æ›´å¤šæ¢å¤æ—¶é—´
```

**ğŸ“ å®Œæ•´å®ç°**
```java
public class ExponentialBackoffRetry {
    private final long baseDelayMs = 1000; // åŸºç¡€å»¶è¿Ÿ1ç§’
    private final int maxRetries = 5;
    private final long maxDelayMs = 30000; // æœ€å¤§å»¶è¿Ÿ30ç§’
    
    public String callWithExponentialBackoff() {
        Exception lastException = null;
        
        for (int attempt = 0; attempt <= maxRetries; attempt++) {
            try {
                return service.call();
            } catch (Exception e) {
                lastException = e;
                
                if (attempt == maxRetries) {
                    break; // æœ€åä¸€æ¬¡å°è¯•å¤±è´¥
                }
                
                // è®¡ç®—å»¶è¿Ÿæ—¶é—´ï¼šåŸºç¡€å»¶è¿Ÿ * 2^å°è¯•æ¬¡æ•°
                long delay = Math.min(
                    baseDelayMs * (1L << attempt), // 2çš„attemptæ¬¡æ–¹
                    maxDelayMs
                );
                
                try {
                    Thread.sleep(delay);
                } catch (InterruptedException ie) {
                    Thread.currentThread().interrupt();
                    throw new RuntimeException(ie);
                }
            }
        }
        
        throw new RuntimeException("é‡è¯•" + maxRetries + "æ¬¡åä»ç„¶å¤±è´¥", lastException);
    }
}
```

### 4.4 çº¿æ€§å¢é•¿é€€é¿


**ğŸ“Š ä»€ä¹ˆæ˜¯çº¿æ€§å¢é•¿**
å°±åƒ**æ¯æ¬¡å¤šç­‰ä¸€ä¼šå„¿**ï¼Œç­‰å¾…æ—¶é—´**é€æ­¥é€’å¢**ä½†ä¸æ˜¯æˆå€å¢é•¿ã€‚

```
å¢é•¿ç­–ç•¥ï¼š
ç¬¬1æ¬¡å¤±è´¥ â†’ ç­‰å¾…2ç§’ â†’ ç¬¬1æ¬¡é‡è¯•
ç¬¬1æ¬¡é‡è¯•å¤±è´¥ â†’ ç­‰å¾…4ç§’ â†’ ç¬¬2æ¬¡é‡è¯•
ç¬¬2æ¬¡é‡è¯•å¤±è´¥ â†’ ç­‰å¾…6ç§’ â†’ ç¬¬3æ¬¡é‡è¯•

å…¬å¼ï¼šç­‰å¾…æ—¶é—´ = åŸºç¡€å»¶è¿Ÿ Ã— (é‡è¯•æ¬¡æ•° + 1)
```

**ğŸ¯ é€‚ç”¨åœºæ™¯**
```
å¹³ç¼“å¢é•¿éœ€æ±‚ï¼š
- ä¸å¸Œæœ›ç­‰å¾…æ—¶é—´å¢é•¿å¤ªå¿«
- å¸Œæœ›ç»™æœåŠ¡é€‚åº¦çš„æ¢å¤æ—¶é—´
- åœ¨æŒ‡æ•°é€€é¿å’Œå›ºå®šå»¶è¿Ÿä¹‹é—´çš„æŠ˜ä¸­
```

**ğŸ“ å®ç°ç¤ºä¾‹**
```java
public class LinearBackoffRetry {
    private final long baseDelayMs = 2000; // åŸºç¡€å»¶è¿Ÿ2ç§’
    
    public String callWithLinearBackoff() {
        for (int attempt = 0; attempt < 3; attempt++) {
            try {
                return service.call();
            } catch (Exception e) {
                if (attempt == 2) throw e;
                
                // çº¿æ€§å¢é•¿ï¼š2ç§’ã€4ç§’ã€6ç§’
                long delay = baseDelayMs * (attempt + 1);
                
                try {
                    Thread.sleep(delay);
                } catch (InterruptedException ie) {
                    Thread.currentThread().interrupt();
                    throw new RuntimeException(ie);
                }
            }
        }
        return null;
    }
}
```

### 4.5 è‡ªå®šä¹‰é€€é¿ç­–ç•¥


**ğŸ¨ æ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹è®¾è®¡**
å°±åƒ**ä¸åŒçš„ç—…éœ€è¦ä¸åŒçš„æ²»ç–—æ–¹æ¡ˆ**ï¼Œä¸åŒçš„ä¸šåŠ¡åœºæ™¯éœ€è¦**å®šåˆ¶åŒ–çš„é‡è¯•ç­–ç•¥**ã€‚

```java
public class CustomRetryStrategy {
    
    // ä¸šåŠ¡è‡ªå®šä¹‰ï¼šæ ¹æ®å¼‚å¸¸ç±»å‹å†³å®šå»¶è¿Ÿæ—¶é—´
    public long calculateDelay(Exception exception, int attemptCount) {
        if (exception instanceof NetworkException) {
            // ç½‘ç»œå¼‚å¸¸ï¼šå¿«é€Ÿé‡è¯•
            return 500 * attemptCount;
        } else if (exception instanceof ServiceBusyException) {
            // æœåŠ¡å¿™ï¼šæ…¢é€Ÿé‡è¯•ï¼Œç»™æœåŠ¡æ›´å¤šæ—¶é—´
            return 5000 * attemptCount;
        } else {
            // é»˜è®¤ç­–ç•¥
            return 1000 * (1L << attemptCount);
        }
    }
    
    // ä¸šåŠ¡è‡ªå®šä¹‰ï¼šæ ¹æ®æ—¶é—´æ®µè°ƒæ•´ç­–ç•¥
    public boolean shouldRetry(int attemptCount, LocalTime currentTime) {
        // ä¸šåŠ¡é«˜å³°æœŸï¼šå‡å°‘é‡è¯•æ¬¡æ•°
        if (isBusinessPeakHour(currentTime)) {
            return attemptCount < 2;
        }
        // éé«˜å³°æœŸï¼šæ­£å¸¸é‡è¯•
        return attemptCount < 5;
    }
    
    private boolean isBusinessPeakHour(LocalTime time) {
        // å·¥ä½œæ—¶é—´9:00-18:00ç®—ä½œé«˜å³°æœŸ
        return time.isAfter(LocalTime.of(9, 0)) && 
               time.isBefore(LocalTime.of(18, 0));
    }
}
```

---

## 5. ğŸ›¡ï¸ å¹‚ç­‰æ€§ä¸å®‰å…¨è®¾è®¡


### 5.1 ä»€ä¹ˆæ˜¯å¹‚ç­‰æ€§


**ğŸ’¡ é€šä¿—ç†è§£**
å¹‚ç­‰æ€§å°±åƒ**ç”µç¯å¼€å…³**ï¼Œä¸ç®¡ä½ æŒ‰å¤šå°‘æ¬¡ï¼Œ**ç»“æœéƒ½ä¸€æ ·**ï¼š
- ç¯å¼€ç€æ—¶ï¼ŒæŒ‰å¼€å…³ â†’ ç¯è¿˜æ˜¯å¼€ç€
- ç¯å…³ç€æ—¶ï¼ŒæŒ‰å¼€å…³ â†’ ç¯è¿˜æ˜¯å…³ç€

```
å¹‚ç­‰æ“ä½œç¤ºä¾‹ï¼š
æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ â†’ æŸ¥è¯¢1æ¬¡å’ŒæŸ¥è¯¢10æ¬¡ï¼Œç»“æœä¸€æ · âœ…
è·å–å½“å‰æ—¶é—´ â†’ åœ¨åŒä¸€ç§’å†…è°ƒç”¨å¤šæ¬¡ï¼Œç»“æœä¸€æ · âœ…
åˆ é™¤æ–‡ä»¶ â†’ åˆ é™¤1æ¬¡å’Œåˆ é™¤10æ¬¡ï¼Œæ–‡ä»¶éƒ½ä¸å­˜åœ¨ âœ…

éå¹‚ç­‰æ“ä½œç¤ºä¾‹ï¼š
è½¬è´¦æ“ä½œ â†’ è½¬1æ¬¡100å…ƒå’Œè½¬10æ¬¡100å…ƒï¼Œç»“æœä¸åŒ âŒ
å‘é€çŸ­ä¿¡ â†’ å‘1æ¬¡å’Œå‘10æ¬¡ï¼Œç”¨æˆ·æ”¶åˆ°çš„çŸ­ä¿¡æ•°ä¸åŒ âŒ
åˆ›å»ºè®¢å• â†’ åˆ›å»º1æ¬¡å’Œåˆ›å»º10æ¬¡ï¼Œè®¢å•æ•°é‡ä¸åŒ âŒ
```

### 5.2 ä¸ºä»€ä¹ˆé‡è¯•éœ€è¦å¹‚ç­‰æ€§


**ğŸ”„ é‡è¯•çš„é£é™©**
```
åœºæ™¯ï¼šè½¬è´¦100å…ƒ
ç¬¬1æ¬¡è°ƒç”¨ï¼šç½‘ç»œè¶…æ—¶ï¼Œä½†æœåŠ¡ç«¯å®é™…å¤„ç†æˆåŠŸäº†
ç¬¬2æ¬¡é‡è¯•ï¼šåˆè½¬äº†100å…ƒ â†’ æ€»å…±è½¬äº†200å…ƒ âŒ

æ­£ç¡®çš„åšæ³•ï¼š
ç¬¬1æ¬¡è°ƒç”¨ï¼šè½¬è´¦100å…ƒï¼ˆä½¿ç”¨å”¯ä¸€è®¢å•å·ï¼šORDER_001ï¼‰
ç¬¬2æ¬¡é‡è¯•ï¼šè½¬è´¦100å…ƒï¼ˆè¿˜æ˜¯ä½¿ç”¨è®¢å•å·ï¼šORDER_001ï¼‰
æœåŠ¡ç«¯å‘ç°è®¢å•å·é‡å¤ â†’ ç›´æ¥è¿”å›ç¬¬ä¸€æ¬¡çš„ç»“æœ âœ…
```

**ğŸ’° å®é™…æ¡ˆä¾‹**
```java
// éå¹‚ç­‰çš„è½¬è´¦ï¼ˆå±é™©ï¼‰
public void transferMoney(String fromAccount, String toAccount, BigDecimal amount) {
    accountService.debit(fromAccount, amount);  // æ‰£é’±
    accountService.credit(toAccount, amount);   // åŠ é’±
    // é‡è¯•æ—¶ä¼šé‡å¤æ‰£é’±å’ŒåŠ é’±ï¼
}

// å¹‚ç­‰çš„è½¬è´¦ï¼ˆå®‰å…¨ï¼‰
public void transferMoneyIdempotent(String orderId, String fromAccount, 
                                   String toAccount, BigDecimal amount) {
    // å…ˆæ£€æŸ¥è®¢å•æ˜¯å¦å·²ç»å¤„ç†è¿‡
    if (transferRecordService.exists(orderId)) {
        return; // å·²ç»å¤„ç†è¿‡ï¼Œç›´æ¥è¿”å›
    }
    
    // å¤„ç†è½¬è´¦
    accountService.debit(fromAccount, amount);
    accountService.credit(toAccount, amount);
    
    // è®°å½•å¤„ç†ç»“æœ
    transferRecordService.save(orderId, "SUCCESS");
}
```

### 5.3 å¹‚ç­‰æ€§è®¾è®¡æ–¹æ¡ˆ


**ğŸ”‘ æ–¹æ¡ˆä¸€ï¼šå”¯ä¸€IDæ ‡è¯†**
```java
public class IdempotentService {
    private final Set<String> processedRequests = new ConcurrentHashMap<>();
    
    public String processRequest(String requestId, String data) {
        // æ£€æŸ¥æ˜¯å¦å·²ç»å¤„ç†è¿‡
        if (processedRequests.contains(requestId)) {
            return getStoredResult(requestId); // è¿”å›ä¹‹å‰çš„ç»“æœ
        }
        
        // å¤„ç†è¯·æ±‚
        String result = doProcess(data);
        
        // è®°å½•å¤„ç†ç»“æœ
        processedRequests.add(requestId);
        storeResult(requestId, result);
        
        return result;
    }
}
```

**ğŸª æ–¹æ¡ˆäºŒï¼šæ•°æ®åº“å”¯ä¸€çº¦æŸ**
```java
@Entity
public class PaymentOrder {
    @Id
    private String orderId;      // è®¢å•å·ï¼ˆå”¯ä¸€ï¼‰
    
    @Column(unique = true)
    private String clientOrderId; // å®¢æˆ·ç«¯è®¢å•å·ï¼ˆå”¯ä¸€ï¼‰
    
    // æ•°æ®åº“å”¯ä¸€çº¦æŸç¡®ä¿ä¸ä¼šé‡å¤åˆ›å»ºè®¢å•
}

public void createPaymentOrder(String clientOrderId, BigDecimal amount) {
    try {
        PaymentOrder order = new PaymentOrder(clientOrderId, amount);
        orderRepository.save(order); // é‡å¤çš„clientOrderIdä¼šæŠ›å¼‚å¸¸
    } catch (DataIntegrityViolationException e) {
        // è®¢å•å·²å­˜åœ¨ï¼ŒæŸ¥è¯¢å¹¶è¿”å›ç°æœ‰è®¢å•
        return orderRepository.findByClientOrderId(clientOrderId);
    }
}
```

**â° æ–¹æ¡ˆä¸‰ï¼šçŠ¶æ€æœºä¿æŠ¤**
```java
public enum OrderStatus {
    CREATED,    // å·²åˆ›å»º
    PROCESSING, // å¤„ç†ä¸­
    SUCCESS,    // æˆåŠŸ
    FAILED      // å¤±è´¥
}

public void processOrder(String orderId) {
    Order order = orderRepository.findById(orderId);
    
    // åªæœ‰CREATEDçŠ¶æ€æ‰èƒ½å¤„ç†
    if (order.getStatus() != OrderStatus.CREATED) {
        return; // å·²ç»å¤„ç†è¿‡æˆ–æ­£åœ¨å¤„ç†ä¸­
    }
    
    // å…ˆæ›´æ–°çŠ¶æ€ä¸ºå¤„ç†ä¸­
    order.setStatus(OrderStatus.PROCESSING);
    orderRepository.save(order);
    
    try {
        // æ‰§è¡Œä¸šåŠ¡é€»è¾‘
        doBusinessLogic(order);
        
        // æ›´æ–°ä¸ºæˆåŠŸçŠ¶æ€
        order.setStatus(OrderStatus.SUCCESS);
    } catch (Exception e) {
        // æ›´æ–°ä¸ºå¤±è´¥çŠ¶æ€
        order.setStatus(OrderStatus.FAILED);
        throw e;
    } finally {
        orderRepository.save(order);
    }
}
```

---

## 6. ğŸ§  æ™ºèƒ½é‡è¯•è®¾è®¡


### 6.1 åŸºäºå¼‚å¸¸ç±»å‹çš„é‡è¯•


**ğŸ¯ ä¸åŒå¼‚å¸¸ï¼Œä¸åŒç­–ç•¥**
å°±åƒ**çœ‹ç—…è¦å¯¹ç—‡ä¸‹è¯**ï¼Œä¸åŒçš„å¼‚å¸¸éœ€è¦**ä¸åŒçš„é‡è¯•ç­–ç•¥**ã€‚

```java
public class SmartRetryHandler {
    
    public RetryConfig getRetryConfig(Exception exception) {
        if (exception instanceof NetworkTimeoutException) {
            // ç½‘ç»œè¶…æ—¶ï¼šå¿«é€Ÿé‡è¯•ï¼Œå› ä¸ºå¯èƒ½å¾ˆå¿«æ¢å¤
            return new RetryConfig()
                .maxRetries(5)
                .baseDelay(500)
                .strategy(RetryStrategy.EXPONENTIAL);
                
        } else if (exception instanceof ServiceUnavailableException) {
            // æœåŠ¡ä¸å¯ç”¨ï¼šæ…¢é€Ÿé‡è¯•ï¼Œç»™æœåŠ¡æ¢å¤æ—¶é—´
            return new RetryConfig()
                .maxRetries(3)
                .baseDelay(5000)
                .strategy(RetryStrategy.FIXED);
                
        } else if (exception instanceof RateLimitException) {
            // é™æµï¼šç­‰å¾…æ›´é•¿æ—¶é—´
            return new RetryConfig()
                .maxRetries(2)
                .baseDelay(10000)
                .strategy(RetryStrategy.LINEAR);
                
        } else {
            // å…¶ä»–å¼‚å¸¸ï¼šé»˜è®¤ç­–ç•¥
            return RetryConfig.DEFAULT;
        }
    }
}
```

### 6.2 åŸºäºå†å²æˆåŠŸç‡çš„é‡è¯•


**ğŸ“Š å­¦ä¹ å†å²ï¼Œä¼˜åŒ–ç­–ç•¥**
å°±åƒ**è®°ä½å“ªæ¡è·¯ç»å¸¸å µè½¦**ï¼Œç³»ç»Ÿå¯ä»¥**å­¦ä¹ å†å²æ•°æ®**æ¥ä¼˜åŒ–é‡è¯•ç­–ç•¥ã€‚

```java
public class HistoryBasedRetry {
    private final Map<String, SuccessRateTracker> serviceStats = new ConcurrentHashMap<>();
    
    public boolean shouldRetry(String serviceName, int attemptCount) {
        SuccessRateTracker tracker = serviceStats.get(serviceName);
        
        if (tracker == null) {
            return attemptCount < 3; // é»˜è®¤é‡è¯•3æ¬¡
        }
        
        double successRate = tracker.getRecentSuccessRate();
        
        if (successRate > 0.8) {
            // æˆåŠŸç‡é«˜ï¼šå¤šé‡è¯•å‡ æ¬¡
            return attemptCount < 5;
        } else if (successRate > 0.5) {
            // æˆåŠŸç‡ä¸­ç­‰ï¼šæ­£å¸¸é‡è¯•
            return attemptCount < 3;
        } else {
            // æˆåŠŸç‡ä½ï¼šå‡å°‘é‡è¯•ï¼Œé¿å…æµªè´¹èµ„æº
            return attemptCount < 1;
        }
    }
    
    public void recordResult(String serviceName, boolean success) {
        serviceStats.computeIfAbsent(serviceName, k -> new SuccessRateTracker())
                   .record(success);
    }
}

class SuccessRateTracker {
    private final CircularBuffer<Boolean> recentResults = new CircularBuffer<>(100);
    
    public void record(boolean success) {
        recentResults.add(success);
    }
    
    public double getRecentSuccessRate() {
        List<Boolean> results = recentResults.getAll();
        if (results.isEmpty()) return 1.0;
        
        long successCount = results.stream().mapToLong(r -> r ? 1 : 0).sum();
        return (double) successCount / results.size();
    }
}
```

### 6.3 ç†”æ–­å™¨é›†æˆ


**ğŸ”Œ ç†”æ–­å™¨ + é‡è¯•çš„ç»„åˆ**
å°±åƒ**å®¶é‡Œçš„ä¿é™©ä¸**ï¼Œå½“æœåŠ¡æŒç»­å‡ºé—®é¢˜æ—¶ï¼Œ**æš‚åœé‡è¯•**ä»¥ä¿æŠ¤ç³»ç»Ÿã€‚

```
ç†”æ–­å™¨çŠ¶æ€ï¼š
ğŸŸ¢ å…³é—­çŠ¶æ€ï¼šæ­£å¸¸é‡è¯•
ğŸŸ¡ åŠå¼€çŠ¶æ€ï¼šè°¨æ…é‡è¯•ï¼ˆåªé‡è¯•1æ¬¡ï¼‰
ğŸ”´ å¼€å¯çŠ¶æ€ï¼šåœæ­¢é‡è¯•ï¼Œç›´æ¥å¤±è´¥
```

```java
public class CircuitBreakerRetry {
    private final CircuitBreaker circuitBreaker;
    private final RetryHandler retryHandler;
    
    public String callWithCircuitBreaker(String serviceName) {
        // å…ˆæ£€æŸ¥ç†”æ–­å™¨çŠ¶æ€
        if (circuitBreaker.isOpen(serviceName)) {
            throw new ServiceUnavailableException("æœåŠ¡ç†”æ–­ä¸­ï¼Œæš‚åœé‡è¯•");
        }
        
        try {
            if (circuitBreaker.isHalfOpen(serviceName)) {
                // åŠå¼€çŠ¶æ€ï¼šåªå°è¯•ä¸€æ¬¡ï¼Œä¸é‡è¯•
                return directCall(serviceName);
            } else {
                // æ­£å¸¸çŠ¶æ€ï¼šä½¿ç”¨é‡è¯•æœºåˆ¶
                return retryHandler.callWithRetry(() -> directCall(serviceName));
            }
        } catch (Exception e) {
            circuitBreaker.recordFailure(serviceName);
            throw e;
        }
    }
}
```

---

## 7. âš ï¸ é‡è¯•çš„å‰¯ä½œç”¨ä¸é˜²æŠ¤


### 7.1 é‡è¯•é£æš´é—®é¢˜


**ğŸ’¥ ä»€ä¹ˆæ˜¯é‡è¯•é£æš´**
é‡è¯•é£æš´å°±åƒ**æ‰€æœ‰äººåŒæ—¶æ¶Œå‘å‡ºå£**ï¼Œå¤§é‡å®¢æˆ·ç«¯**åŒæ—¶é‡è¯•**ï¼Œç»™æœåŠ¡ç«¯é€ æˆ**æ›´å¤§å‹åŠ›**ã€‚

```
é£æš´å½¢æˆè¿‡ç¨‹ï¼š
1. æœåŠ¡å‡ºç°é—®é¢˜ â†’ æ‰€æœ‰è¯·æ±‚éƒ½å¤±è´¥
2. æ‰€æœ‰å®¢æˆ·ç«¯åŒæ—¶é‡è¯• â†’ ç¬é—´è¯·æ±‚é‡ç¿»å€
3. æœåŠ¡å‹åŠ›æ›´å¤§ â†’ æ¢å¤å˜å¾—æ›´å›°éš¾
4. é‡è¯•ç»§ç»­å¤±è´¥ â†’ å†æ¬¡é‡è¯•ï¼Œå‹åŠ›è¿›ä¸€æ­¥å¢å¤§

ç»“æœï¼šæœ¬æ¥å¯èƒ½å¾ˆå¿«æ¢å¤çš„æœåŠ¡ï¼Œè¢«é‡è¯•"å‹å®"äº†
```

**ğŸ“Š æ•°æ®å¯¹æ¯”**
```
æ­£å¸¸æƒ…å†µï¼š
100ä¸ªå®¢æˆ·ç«¯ï¼Œæ¯ä¸ªå‘1ä¸ªè¯·æ±‚ = 100ä¸ªè¯·æ±‚

é‡è¯•é£æš´ï¼š
100ä¸ªå®¢æˆ·ç«¯ï¼Œæ¯ä¸ªé‡è¯•3æ¬¡ = 400ä¸ªè¯·æ±‚
æœåŠ¡ç«¯å‹åŠ›ç¬é—´å¢åŠ 4å€ï¼
```

### 7.2 é‡è¯•é£æš´é˜²æŠ¤ç­–ç•¥


**ğŸ›¡ï¸ ç­–ç•¥ä¸€ï¼šéšæœºå»¶è¿Ÿï¼ˆJitterï¼‰**
```java
public class JitterRetry {
    private final Random random = new Random();
    
    public long calculateDelayWithJitter(long baseDelay) {
        // åœ¨åŸºç¡€å»¶è¿Ÿçš„50%-150%ä¹‹é—´éšæœº
        double jitterFactor = 0.5 + random.nextDouble(); // 0.5-1.5
        return (long) (baseDelay * jitterFactor);
    }
    
    public String callWithJitter() {
        for (int attempt = 0; attempt < 3; attempt++) {
            try {
                return service.call();
            } catch (Exception e) {
                if (attempt == 2) throw e;
                
                long baseDelay = 1000 * (1L << attempt); // æŒ‡æ•°é€€é¿
                long actualDelay = calculateDelayWithJitter(baseDelay);
                
                sleep(actualDelay); // æ¯ä¸ªå®¢æˆ·ç«¯ç­‰å¾…æ—¶é—´ä¸åŒ
            }
        }
        return null;
    }
}
```

**ğŸ›¡ï¸ ç­–ç•¥äºŒï¼šé™åˆ¶å¹¶å‘é‡è¯•**
```java
public class ConcurrentLimitRetry {
    private final Semaphore retrySemaphore = new Semaphore(10); // æœ€å¤š10ä¸ªå¹¶å‘é‡è¯•
    
    public String callWithConcurrentLimit() {
        try {
            return service.call();
        } catch (Exception e) {
            // å°è¯•è·å–é‡è¯•è®¸å¯
            if (retrySemaphore.tryAcquire()) {
                try {
                    // æœ‰è®¸å¯æ‰èƒ½é‡è¯•
                    return retryCall();
                } finally {
                    retrySemaphore.release();
                }
            } else {
                // æ²¡æœ‰è®¸å¯ï¼Œç›´æ¥å¤±è´¥ï¼Œé¿å…åŠ é‡æœåŠ¡ç«¯å‹åŠ›
                throw new RuntimeException("é‡è¯•èµ„æºè€—å°½ï¼Œè¯·ç¨åå†è¯•");
            }
        }
    }
}
```

**ğŸ›¡ï¸ ç­–ç•¥ä¸‰ï¼šåŸºäºæœåŠ¡ç«¯åé¦ˆ**
```java
public class ServerFeedbackRetry {
    
    public String callWithServerFeedback() {
        try {
            return service.call();
        } catch (ServiceException e) {
            // æ£€æŸ¥æœåŠ¡ç«¯æ˜¯å¦å»ºè®®é‡è¯•
            String retryAfter = e.getHeader("Retry-After");
            if (retryAfter != null) {
                // æœåŠ¡ç«¯å‘Šè¯‰æˆ‘ä»¬ç­‰å¾…å¤šä¹…å†é‡è¯•
                long delay = Long.parseLong(retryAfter) * 1000;
                sleep(delay);
                return service.call();
            } else {
                // æœåŠ¡ç«¯æ²¡æœ‰ç»™å‡ºé‡è¯•å»ºè®®ï¼Œç›´æ¥å¤±è´¥
                throw e;
            }
        }
    }
}
```

### 7.3 èµ„æºæ¶ˆè€—æ§åˆ¶


**ğŸ’° é‡è¯•çš„æˆæœ¬**
é‡è¯•ä¸æ˜¯å…è´¹çš„ï¼Œéœ€è¦è€ƒè™‘**èµ„æºæ¶ˆè€—**ï¼š

```
èµ„æºæ¶ˆè€—ï¼š
ğŸ§  CPUï¼šé‡è¯•é€»è¾‘çš„è®¡ç®—å¼€é”€
ğŸ’¾ å†…å­˜ï¼šé‡è¯•çŠ¶æ€çš„å­˜å‚¨
ğŸŒ ç½‘ç»œï¼šé‡å¤çš„ç½‘ç»œè¯·æ±‚
â° æ—¶é—´ï¼šç”¨æˆ·ç­‰å¾…æ—¶é—´å¢åŠ 
```

**ğŸ¯ èµ„æºæ§åˆ¶ç­–ç•¥**
```java
public class ResourceControlRetry {
    private final AtomicInteger activeRetries = new AtomicInteger(0);
    private final int maxActiveRetries = 50; // æœ€å¤š50ä¸ªæ´»è·ƒé‡è¯•
    
    public String callWithResourceControl() {
        // æ£€æŸ¥æ´»è·ƒé‡è¯•æ•°é‡
        if (activeRetries.get() >= maxActiveRetries) {
            throw new RuntimeException("ç³»ç»Ÿé‡è¯•ç¹å¿™ï¼Œè¯·ç¨åå†è¯•");
        }
        
        try {
            return service.call();
        } catch (Exception e) {
            // å¢åŠ æ´»è·ƒé‡è¯•è®¡æ•°
            if (activeRetries.incrementAndGet() <= maxActiveRetries) {
                try {
                    return retryCall();
                } finally {
                    activeRetries.decrementAndGet(); // å‡å°‘è®¡æ•°
                }
            } else {
                activeRetries.decrementAndGet();
                throw new RuntimeException("é‡è¯•èµ„æºä¸è¶³");
            }
        }
    }
}
```

### 7.4 é‡è¯•çš„ç›‘æ§ä¸æŠ¥è­¦


**ğŸ“Š éœ€è¦ç›‘æ§çš„æŒ‡æ ‡**
```java
public class RetryMetrics {
    private final Counter retryCounter = new Counter("rpc_retry_total");
    private final Histogram retryDuration = new Histogram("rpc_retry_duration");
    private final Gauge activeRetries = new Gauge("rpc_active_retries");
    
    public void recordRetry(String serviceName, int attemptCount, 
                           boolean success, long duration) {
        // è®°å½•é‡è¯•æ¬¡æ•°
        retryCounter.increment(
            "service", serviceName,
            "attempt", String.valueOf(attemptCount),
            "success", String.valueOf(success)
        );
        
        // è®°å½•é‡è¯•è€—æ—¶
        retryDuration.observe(duration);
        
        // æ›´æ–°æ´»è·ƒé‡è¯•æ•°é‡
        activeRetries.set(getActiveRetryCount());
    }
}
```

**ğŸš¨ æŠ¥è­¦è§„åˆ™**
```
é‡è¯•ç‡è¿‡é«˜æŠ¥è­¦ï¼š
- æŸæœåŠ¡5åˆ†é’Ÿå†…é‡è¯•ç‡ > 50%
- è¯´æ˜æœåŠ¡å¯èƒ½æœ‰é—®é¢˜

é‡è¯•é£æš´æŠ¥è­¦ï¼š
- å…¨å±€é‡è¯•QPS > 1000
- å¯èƒ½å‘ç”Ÿé‡è¯•é£æš´

é‡è¯•æˆåŠŸç‡è¿‡ä½æŠ¥è­¦ï¼š
- æŸæœåŠ¡é‡è¯•æˆåŠŸç‡ < 20%
- é‡è¯•ç­–ç•¥å¯èƒ½éœ€è¦è°ƒæ•´
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ é‡è¯•æœºåˆ¶æœ¬è´¨ï¼šåœ¨ä¸ç¨³å®šç¯å¢ƒä¸­æé«˜è°ƒç”¨æˆåŠŸç‡çš„è‡ªåŠ¨åŒ–ç­–ç•¥
ğŸ”¸ é€‚ç”¨åœºæ™¯ï¼šç½‘ç»œæŠ–åŠ¨ã€æœåŠ¡ä¸´æ—¶ä¸å¯ç”¨ã€è´Ÿè½½è¿‡é«˜ç­‰ä¸´æ—¶æ€§é—®é¢˜
ğŸ”¸ è§¦å‘æ¡ä»¶ï¼šç½‘ç»œå¼‚å¸¸ã€5xxæœåŠ¡å¼‚å¸¸ã€è¶…æ—¶å¼‚å¸¸ç­‰å¯æ¢å¤é”™è¯¯
ğŸ”¸ é‡è¯•ç­–ç•¥ï¼šç«‹å³é‡è¯•ã€å›ºå®šå»¶è¿Ÿã€æŒ‡æ•°é€€é¿ã€çº¿æ€§å¢é•¿ã€è‡ªå®šä¹‰ç­–ç•¥
ğŸ”¸ å¹‚ç­‰æ€§è®¾è®¡ï¼šç¡®ä¿é‡è¯•ä¸ä¼šäº§ç”Ÿå‰¯ä½œç”¨çš„æ ¸å¿ƒä¿éšœæœºåˆ¶
ğŸ”¸ æ™ºèƒ½é‡è¯•ï¼šåŸºäºå¼‚å¸¸ç±»å‹ã€å†å²æˆåŠŸç‡çš„åŠ¨æ€é‡è¯•å†³ç­–
ğŸ”¸ å‰¯ä½œç”¨é˜²æŠ¤ï¼šé‡è¯•é£æš´é˜²æŠ¤ã€èµ„æºæ§åˆ¶ã€ç›‘æ§æŠ¥è­¦
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ é‡è¯•ä¸æ˜¯ä¸‡èƒ½è¯**
```
é€‚åˆé‡è¯•çš„åœºæ™¯ï¼š
âœ… ä¸´æ—¶æ€§é—®é¢˜ï¼šç½‘ç»œæŠ–åŠ¨ã€æœåŠ¡é‡å¯
âœ… å¯æ¢å¤é”™è¯¯ï¼šè¶…æ—¶ã€è¿æ¥å¤±è´¥
âœ… å¹‚ç­‰æ“ä½œï¼šæŸ¥è¯¢ã€åˆ é™¤ç­‰æ“ä½œ

ä¸é€‚åˆé‡è¯•çš„åœºæ™¯ï¼š
âŒ æ°¸ä¹…æ€§é”™è¯¯ï¼šå‚æ•°é”™è¯¯ã€æƒé™ä¸è¶³
âŒ éå¹‚ç­‰æ“ä½œï¼šè½¬è´¦ã€å‘çŸ­ä¿¡ï¼ˆéœ€è¦ç‰¹æ®Šå¤„ç†ï¼‰
âŒ ç³»ç»Ÿæ€§æ•…éšœï¼šæœåŠ¡å½»åº•æŒ‚æ‰
```

**ğŸ”¹ æŒ‡æ•°é€€é¿çš„æ™ºæ…§**
```
ä¸ºä»€ä¹ˆé€‰æ‹©æŒ‡æ•°é€€é¿ï¼š
- æ—©æœŸå¿«é€Ÿé‡è¯•ï¼šå¤„ç†ç¬é—´æ•…éšœ
- åæœŸæ…¢é€Ÿé‡è¯•ï¼šç»™æœåŠ¡æ¢å¤æ—¶é—´
- é¿å…é‡è¯•é£æš´ï¼šæ—¶é—´åˆ†æ•£
- è‡ªé€‚åº”ç‰¹æ€§ï¼šé€‚åº”ä¸åŒæ•…éšœæŒç»­æ—¶é—´
```

**ğŸ”¹ å¹‚ç­‰æ€§çš„é‡è¦æ€§**
```
å¹‚ç­‰æ€§è®¾è®¡åŸåˆ™ï¼š
- ä½¿ç”¨å”¯ä¸€æ ‡è¯†ï¼šè®¢å•å·ã€è¯·æ±‚ID
- çŠ¶æ€æœºä¿æŠ¤ï¼šé˜²æ­¢é‡å¤å¤„ç†
- æ•°æ®åº“çº¦æŸï¼šåˆ©ç”¨å”¯ä¸€ç´¢å¼•
- ç»“æœç¼“å­˜ï¼šè¿”å›ç›¸åŒçš„å¤„ç†ç»“æœ
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ é‡è¯•ç­–ç•¥é€‰æ‹©**
```
ç½‘ç»œè°ƒç”¨ï¼šæŒ‡æ•°é€€é¿ + éšæœºå»¶è¿Ÿ
æ•°æ®åº“æ“ä½œï¼šå›ºå®šå»¶è¿Ÿ + å°‘é‡é‡è¯•
æ¶ˆæ¯å‘é€ï¼šçº¿æ€§å¢é•¿ + çŠ¶æ€æ£€æŸ¥
æ–‡ä»¶ä¸Šä¼ ï¼šæŒ‡æ•°é€€é¿ + æ–­ç‚¹ç»­ä¼ 
```

**ğŸ›¡ï¸ ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ**
```
é…ç½®å»ºè®®ï¼š
- æœ€å¤§é‡è¯•æ¬¡æ•°ï¼š3-5æ¬¡
- åŸºç¡€å»¶è¿Ÿï¼š1-2ç§’
- æœ€å¤§å»¶è¿Ÿï¼š30-60ç§’
- æ·»åŠ éšæœºå»¶è¿Ÿï¼š20-50%

ç›‘æ§æŒ‡æ ‡ï¼š
- é‡è¯•ç‡ï¼š< 10%ä¸ºæ­£å¸¸
- é‡è¯•æˆåŠŸç‡ï¼š> 70%ä¸ºå¥åº·
- æ´»è·ƒé‡è¯•æ•°ï¼š< ç³»ç»Ÿå®¹é‡çš„10%
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- é‡è¯•æœºåˆ¶è¦æ™ºèƒ½ï¼Œä¸´æ—¶æ•…éšœæ‰é€‚ç”¨
- æŒ‡æ•°é€€é¿é¿é£æš´ï¼Œå¹‚ç­‰è®¾è®¡ä¿å®‰å…¨
- ç›‘æ§æŒ‡æ ‡è¦å®Œå–„ï¼Œå‰¯ä½œç”¨é˜²æŠ¤å…¨
- ä¸æ˜¯ä¸‡èƒ½è¦è°¨æ…ï¼Œåˆç†ä½¿ç”¨æ•ˆæœæ˜¾