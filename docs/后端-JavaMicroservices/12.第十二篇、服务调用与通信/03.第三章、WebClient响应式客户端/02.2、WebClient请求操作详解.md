---
title: 2ã€WebClientè¯·æ±‚æ“ä½œè¯¦è§£
---
## ğŸ“š ç›®å½•

1. [WebClientè¯·æ±‚æ“ä½œæ¦‚è¿°](#1-WebClientè¯·æ±‚æ“ä½œæ¦‚è¿°)
2. [GETè¯·æ±‚å®ç°](#2-GETè¯·æ±‚å®ç°)
3. [POSTè¯·æ±‚å®ç°](#3-POSTè¯·æ±‚å®ç°)
4. [PUTè¯·æ±‚å®ç°](#4-PUTè¯·æ±‚å®ç°)
5. [DELETEè¯·æ±‚å®ç°](#5-DELETEè¯·æ±‚å®ç°)
6. [è¯·æ±‚å¤´ä¸å‚æ•°è®¾ç½®](#6-è¯·æ±‚å¤´ä¸å‚æ•°è®¾ç½®)
7. [è¯·æ±‚ä½“å¤„ç†è¯¦è§£](#7-è¯·æ±‚ä½“å¤„ç†è¯¦è§£)
8. [å“åº”æ•°æ®å¤„ç†](#8-å“åº”æ•°æ®å¤„ç†)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ WebClientè¯·æ±‚æ“ä½œæ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯WebClientè¯·æ±‚æ“ä½œ


**é€šä¿—ç†è§£**ï¼šå°±åƒä½ ç”¨æ‰‹æœºAPPç‚¹å‡»æŒ‰é’®å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ä¸€æ ·ï¼ŒWebClientå°±æ˜¯ç¨‹åºä»£ç ä¸­ç”¨æ¥å‘é€HTTPè¯·æ±‚çš„å·¥å…·ã€‚

```
ä¼ ç»Ÿæ–¹å¼ï¼ˆRestTemplateï¼‰ï¼š              WebClientæ–¹å¼ï¼š
å‘è¯·æ±‚ â†’ ç­‰å¾…ç»“æœ â†’ ç»§ç»­æ‰§è¡Œ            å‘è¯·æ±‚ â†’ ç«‹å³ç»§ç»­ â†’ ç»“æœæ¥äº†å†å¤„ç†
    (é˜»å¡å¼)                              (å“åº”å¼ï¼Œä¸é˜»å¡)
```

**ğŸ”¸ æ ¸å¿ƒæ¦‚å¿µ**
- **è¯·æ±‚æ“ä½œ**ï¼šå‘å…¶ä»–æœåŠ¡å‘é€HTTPè¯·æ±‚ï¼ˆGETã€POSTã€PUTã€DELETEç­‰ï¼‰
- **å“åº”å¼**ï¼šä¸ç”¨å‚»ç­‰ç»“æœï¼Œç¨‹åºå¯ä»¥ç»§ç»­å¹²åˆ«çš„äº‹
- **é“¾å¼è°ƒç”¨**ï¼šåƒæ­ç§¯æœ¨ä¸€æ ·ï¼Œä¸€æ­¥æ­¥æ„å»ºè¯·æ±‚

### 1.2 WebClientè¯·æ±‚çš„åŸºæœ¬æµç¨‹


```
åˆ›å»ºWebClientå®ä¾‹
        â†“
é€‰æ‹©è¯·æ±‚æ–¹æ³•(GET/POST/PUT/DELETE)
        â†“
è®¾ç½®è¯·æ±‚è·¯å¾„(URI)
        â†“
é…ç½®è¯·æ±‚å‚æ•°/è¯·æ±‚å¤´/è¯·æ±‚ä½“
        â†“
å‘é€è¯·æ±‚å¹¶å¤„ç†å“åº”
        â†“
è·å–æœ€ç»ˆç»“æœ
```

**ğŸ’¡ å®é™…åº”ç”¨åœºæ™¯**
- è°ƒç”¨ç¬¬ä¸‰æ–¹APIï¼ˆå¤©æ°”æŸ¥è¯¢ã€æ”¯ä»˜æ¥å£ç­‰ï¼‰
- å¾®æœåŠ¡é—´é€šä¿¡ï¼ˆè®¢å•æœåŠ¡è°ƒç”¨åº“å­˜æœåŠ¡ï¼‰
- æ•°æ®æŠ“å–å’Œæ•´åˆ

---

## 2. ğŸ“¥ GETè¯·æ±‚å®ç°


### 2.1 GETè¯·æ±‚æ˜¯ä»€ä¹ˆ


**ç”Ÿæ´»ç±»æ¯”**ï¼šå°±åƒä½ åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ç½‘å€æŸ¥çœ‹ç½‘é¡µå†…å®¹ï¼ŒGETè¯·æ±‚å°±æ˜¯"è·å–æ•°æ®"çš„æ„æ€ã€‚

**ğŸ”¸ GETè¯·æ±‚ç‰¹ç‚¹**
- ç”¨äº**æŸ¥è¯¢æ•°æ®**ï¼Œä¸ä¼šä¿®æ”¹æœåŠ¡å™¨æ•°æ®
- å‚æ•°æ”¾åœ¨URLåœ°å€é‡Œï¼ˆçœ‹å¾—è§ï¼‰
- é€‚åˆè·å–èµ„æºã€æŸ¥è¯¢ä¿¡æ¯

### 2.2 åŸºç¡€GETè¯·æ±‚


```java
// æœ€ç®€å•çš„GETè¯·æ±‚ - è·å–ç”¨æˆ·ä¿¡æ¯
Mono<User> userMono = webClient
    .get()                              // ä½¿ç”¨GETæ–¹æ³•
    .uri("/api/users/123")              // è¯·æ±‚è·¯å¾„
    .retrieve()                         // å‘é€è¯·æ±‚
    .bodyToMono(User.class);            // å°†å“åº”è½¬ä¸ºUserå¯¹è±¡

// å®é™…ä½¿ç”¨
userMono.subscribe(user -> {
    System.out.println("ç”¨æˆ·åï¼š" + user.getName());
});
```

**ğŸ“‹ ä»£ç è¯´æ˜**
- `.get()`ï¼šå‘Šè¯‰WebClientè¿™æ˜¯ä¸ªGETè¯·æ±‚
- `.uri()`ï¼šæŒ‡å®šè¦è®¿é—®çš„åœ°å€
- `.retrieve()`ï¼šçœŸæ­£å‘é€è¯·æ±‚
- `.bodyToMono()`ï¼šæŠŠè¿”å›çš„JSONæ•°æ®è½¬æˆJavaå¯¹è±¡

### 2.3 å¸¦å‚æ•°çš„GETè¯·æ±‚


**æ–¹å¼1ï¼šè·¯å¾„å‚æ•°ï¼ˆPathVariableï¼‰**
```java
// åœºæ™¯ï¼šæ ¹æ®IDæŸ¥è¯¢è®¢å• /api/orders/{orderId}
String orderId = "ORDER001";

Mono<Order> orderMono = webClient
    .get()
    .uri("/api/orders/{id}", orderId)    // {id}ä¼šè¢«orderIdæ›¿æ¢
    .retrieve()
    .bodyToMono(Order.class);
```

**æ–¹å¼2ï¼šæŸ¥è¯¢å‚æ•°ï¼ˆRequestParamï¼‰**
```java
// åœºæ™¯ï¼šæœç´¢å•†å“ /api/products?name=æ‰‹æœº&minPrice=1000
Mono<List<Product>> productsMono = webClient
    .get()
    .uri(uriBuilder -> uriBuilder
        .path("/api/products")
        .queryParam("name", "æ‰‹æœº")      // æ·»åŠ æŸ¥è¯¢å‚æ•°
        .queryParam("minPrice", 1000)
        .build())
    .retrieve()
    .bodyToFlux(Product.class)           // å¤šä¸ªç»“æœç”¨Flux
    .collectList();                      // æ”¶é›†æˆList
```

**ğŸ¯ å‚æ•°æ–¹å¼å¯¹æ¯”**

| å‚æ•°ç±»å‹ | ä½¿ç”¨åœºæ™¯ | URLç¤ºä¾‹ |
|---------|---------|---------|
| **è·¯å¾„å‚æ•°** | è·å–ç‰¹å®šèµ„æº | `/users/123` |
| **æŸ¥è¯¢å‚æ•°** | æœç´¢ã€è¿‡æ»¤ | `/products?name=æ‰‹æœº&price=1000` |

### 2.4 GETè¯·æ±‚è¿”å›åˆ—è¡¨æ•°æ®


```java
// åœºæ™¯ï¼šè·å–æ‰€æœ‰ç”¨æˆ·åˆ—è¡¨
Flux<User> usersFlux = webClient
    .get()
    .uri("/api/users")
    .retrieve()
    .bodyToFlux(User.class);             // å¤šæ¡æ•°æ®ç”¨Flux

// å¤„ç†æ¯ä¸ªç”¨æˆ·
usersFlux.subscribe(user -> {
    System.out.println("ç”¨æˆ·ï¼š" + user.getName());
});

// æˆ–è€…æ”¶é›†æˆList
Mono<List<User>> userListMono = usersFlux.collectList();
```

**ğŸ’¡ Mono vs Fluxçš„é€‰æ‹©**
- **å•ä¸ªå¯¹è±¡** â†’ ç”¨`bodyToMono()` â†’ è¿”å›ä¸€ä¸ªç”¨æˆ·
- **å¤šä¸ªå¯¹è±¡** â†’ ç”¨`bodyToFlux()` â†’ è¿”å›ç”¨æˆ·åˆ—è¡¨

---

## 3. ğŸ“¤ POSTè¯·æ±‚å®ç°


### 3.1 POSTè¯·æ±‚æ˜¯ä»€ä¹ˆ


**ç”Ÿæ´»ç±»æ¯”**ï¼šå°±åƒå¡«å†™è¡¨å•æäº¤æ³¨å†Œä¿¡æ¯ï¼ŒPOSTè¯·æ±‚æ˜¯"æäº¤æ•°æ®"çš„æ„æ€ï¼Œé€šå¸¸ç”¨æ¥åˆ›å»ºæ–°èµ„æºã€‚

**ğŸ”¸ POSTè¯·æ±‚ç‰¹ç‚¹**
- ç”¨äº**æäº¤æ•°æ®**ï¼Œåˆ›å»ºæ–°èµ„æº
- æ•°æ®æ”¾åœ¨è¯·æ±‚ä½“é‡Œï¼ˆçœ‹ä¸è§ï¼Œæ›´å®‰å…¨ï¼‰
- å¸¸ç”¨äºç”¨æˆ·æ³¨å†Œã€è®¢å•åˆ›å»ºç­‰

### 3.2 åŸºç¡€POSTè¯·æ±‚


```java
// åœºæ™¯ï¼šåˆ›å»ºæ–°ç”¨æˆ·
User newUser = new User("å¼ ä¸‰", "zhangsan@example.com");

Mono<User> createdUserMono = webClient
    .post()                              // ä½¿ç”¨POSTæ–¹æ³•
    .uri("/api/users")
    .bodyValue(newUser)                  // è®¾ç½®è¯·æ±‚ä½“ï¼ˆè¦æäº¤çš„æ•°æ®ï¼‰
    .retrieve()
    .bodyToMono(User.class);             // è¿”å›åˆ›å»ºæˆåŠŸçš„ç”¨æˆ·

createdUserMono.subscribe(user -> {
    System.out.println("åˆ›å»ºæˆåŠŸï¼Œç”¨æˆ·IDï¼š" + user.getId());
});
```

### 3.3 æäº¤JSONæ•°æ®


```java
// åœºæ™¯ï¼šæäº¤è®¢å•
Order order = new Order();
order.setProductId("PROD123");
order.setQuantity(2);
order.setCustomerName("æå››");

Mono<OrderResult> resultMono = webClient
    .post()
    .uri("/api/orders")
    .contentType(MediaType.APPLICATION_JSON)  // å£°æ˜å‘é€JSON
    .bodyValue(order)                         // å¯¹è±¡ä¼šè‡ªåŠ¨è½¬JSON
    .retrieve()
    .bodyToMono(OrderResult.class);
```

**ğŸ“‹ è¯·æ±‚ä½“è¯´æ˜**
- `bodyValue()`ï¼šç›´æ¥ä¼ Javaå¯¹è±¡ï¼Œè‡ªåŠ¨è½¬JSON
- `contentType()`ï¼šå‘Šè¯‰æœåŠ¡å™¨å‘çš„æ˜¯JSONæ ¼å¼

### 3.4 æäº¤è¡¨å•æ•°æ®


```java
// åœºæ™¯ï¼šæ¨¡æ‹Ÿè¡¨å•æäº¤ï¼ˆåƒç½‘é¡µè¡¨å•ä¸€æ ·ï¼‰
MultiValueMap<String, String> formData = new LinkedMultiValueMap<>();
formData.add("username", "zhangsan");
formData.add("password", "123456");

Mono<String> resultMono = webClient
    .post()
    .uri("/api/login")
    .contentType(MediaType.APPLICATION_FORM_URLENCODED)  // è¡¨å•æ ¼å¼
    .bodyValue(formData)
    .retrieve()
    .bodyToMono(String.class);
```

**ğŸ¯ æ•°æ®æ ¼å¼å¯¹æ¯”**

| æ ¼å¼ç±»å‹ | ä½¿ç”¨åœºæ™¯ | ContentType |
|---------|---------|-------------|
| **JSON** | ç°ä»£APIï¼Œå¾®æœåŠ¡ | `application/json` |
| **è¡¨å•** | ä¼ ç»ŸWebè¡¨å• | `application/x-www-form-urlencoded` |
| **æ–‡ä»¶ä¸Šä¼ ** | ä¸Šä¼ å›¾ç‰‡/æ–‡ä»¶ | `multipart/form-data` |

---

## 4. ğŸ”„ PUTè¯·æ±‚å®ç°


### 4.1 PUTè¯·æ±‚æ˜¯ä»€ä¹ˆ


**ç”Ÿæ´»ç±»æ¯”**ï¼šå°±åƒä¿®æ”¹ä¸ªäººèµ„æ–™ï¼ŒPUTè¯·æ±‚æ˜¯"æ›´æ–°æ•°æ®"çš„æ„æ€ï¼Œç”¨æ¥ä¿®æ”¹å·²å­˜åœ¨çš„èµ„æºã€‚

**ğŸ”¸ PUTè¯·æ±‚ç‰¹ç‚¹**
- ç”¨äº**æ›´æ–°æ•°æ®**ï¼Œä¿®æ”¹å·²æœ‰èµ„æº
- é€šå¸¸éœ€è¦å®Œæ•´çš„èµ„æºä¿¡æ¯
- å¹‚ç­‰æ€§ï¼šå¤šæ¬¡ç›¸åŒè¯·æ±‚ç»“æœä¸€æ ·

### 4.2 åŸºç¡€PUTè¯·æ±‚


```java
// åœºæ™¯ï¼šæ›´æ–°ç”¨æˆ·ä¿¡æ¯
String userId = "123";
User updatedUser = new User("å¼ ä¸‰", "newemail@example.com");

Mono<User> resultMono = webClient
    .put()                               // ä½¿ç”¨PUTæ–¹æ³•
    .uri("/api/users/{id}", userId)
    .bodyValue(updatedUser)              // æ–°çš„ç”¨æˆ·ä¿¡æ¯
    .retrieve()
    .bodyToMono(User.class);

resultMono.subscribe(user -> {
    System.out.println("æ›´æ–°æˆåŠŸï¼š" + user.getName());
});
```

### 4.3 éƒ¨åˆ†å­—æ®µæ›´æ–°


```java
// åœºæ™¯ï¼šåªæ›´æ–°ç”¨æˆ·é‚®ç®±ï¼ˆPATCHæ›´åˆé€‚ï¼Œä½†ä¹Ÿå¯ç”¨PUTï¼‰
Map<String, Object> updates = new HashMap<>();
updates.put("email", "new@example.com");

Mono<User> resultMono = webClient
    .put()
    .uri("/api/users/{id}", "123")
    .bodyValue(updates)
    .retrieve()
    .bodyToMono(User.class);
```

**ğŸ’¡ PUT vs PATCH**
- **PUT**ï¼šé€šå¸¸è¦æ±‚ä¼ å®Œæ•´å¯¹è±¡ï¼Œæ›¿æ¢æ•´ä¸ªèµ„æº
- **PATCH**ï¼šåªä¼ è¦æ”¹çš„å­—æ®µï¼Œéƒ¨åˆ†æ›´æ–°ï¼ˆWebClientç”¨`.patch()`ï¼‰

---

## 5. ğŸ—‘ï¸ DELETEè¯·æ±‚å®ç°


### 5.1 DELETEè¯·æ±‚æ˜¯ä»€ä¹ˆ


**ç”Ÿæ´»ç±»æ¯”**ï¼šå°±åƒåˆ é™¤è´­ç‰©è½¦å•†å“ï¼ŒDELETEè¯·æ±‚æ˜¯"åˆ é™¤æ•°æ®"çš„æ„æ€ã€‚

**ğŸ”¸ DELETEè¯·æ±‚ç‰¹ç‚¹**
- ç”¨äº**åˆ é™¤æ•°æ®**
- é€šå¸¸åªéœ€è¦èµ„æºID
- æˆåŠŸåèµ„æºä¸å†å­˜åœ¨

### 5.2 åŸºç¡€DELETEè¯·æ±‚


```java
// åœºæ™¯ï¼šåˆ é™¤è®¢å•
String orderId = "ORDER123";

Mono<Void> deleteMono = webClient
    .delete()                            // ä½¿ç”¨DELETEæ–¹æ³•
    .uri("/api/orders/{id}", orderId)
    .retrieve()
    .bodyToMono(Void.class);             // åˆ é™¤é€šå¸¸æ— è¿”å›å€¼

deleteMono.subscribe(
    unused -> System.out.println("åˆ é™¤æˆåŠŸ"),
    error -> System.err.println("åˆ é™¤å¤±è´¥ï¼š" + error.getMessage())
);
```

### 5.3 æ‰¹é‡åˆ é™¤


```java
// åœºæ™¯ï¼šåˆ é™¤å¤šä¸ªå•†å“
List<String> productIds = Arrays.asList("P001", "P002", "P003");

Mono<DeleteResult> resultMono = webClient
    .delete()
    .uri(uriBuilder -> uriBuilder
        .path("/api/products")
        .queryParam("ids", String.join(",", productIds))  // ids=P001,P002,P003
        .build())
    .retrieve()
    .bodyToMono(DeleteResult.class);
```

---

## 6. âš™ï¸ è¯·æ±‚å¤´ä¸å‚æ•°è®¾ç½®


### 6.1 è¯·æ±‚å¤´æ˜¯ä»€ä¹ˆ


**é€šä¿—ç†è§£**ï¼šè¯·æ±‚å¤´å°±åƒä¿¡å°ä¸Šçš„æ ‡æ³¨ä¿¡æ¯ï¼Œå‘Šè¯‰æœåŠ¡å™¨"æˆ‘æ˜¯è°"ã€"æˆ‘è¦ä»€ä¹ˆæ ¼å¼çš„æ•°æ®"ç­‰é¢å¤–ä¿¡æ¯ã€‚

**ğŸ”¸ å¸¸ç”¨è¯·æ±‚å¤´**
- `Content-Type`ï¼šå‘Šè¯‰æœåŠ¡å™¨å‘é€çš„æ•°æ®æ ¼å¼
- `Accept`ï¼šå‘Šè¯‰æœåŠ¡å™¨æœŸæœ›è¿”å›çš„æ•°æ®æ ¼å¼
- `Authorization`ï¼šèº«ä»½è®¤è¯ä¿¡æ¯ï¼ˆä»¤ç‰Œï¼‰
- `User-Agent`ï¼šå®¢æˆ·ç«¯ä¿¡æ¯

### 6.2 è®¾ç½®è¯·æ±‚å¤´


```java
// æ–¹å¼1ï¼šå•ä¸ªè¯·æ±‚å¤´
Mono<User> userMono = webClient
    .get()
    .uri("/api/users/123")
    .header("Authorization", "Bearer token123")  // è®¾ç½®è®¤è¯token
    .header("Custom-Header", "value")            // è‡ªå®šä¹‰è¯·æ±‚å¤´
    .retrieve()
    .bodyToMono(User.class);

// æ–¹å¼2ï¼šæ‰¹é‡è®¾ç½®è¯·æ±‚å¤´
Mono<User> userMono = webClient
    .get()
    .uri("/api/users/123")
    .headers(headers -> {
        headers.add("Authorization", "Bearer token123");
        headers.add("Accept-Language", "zh-CN");
        headers.add("Custom-Header", "value");
    })
    .retrieve()
    .bodyToMono(User.class);
```

### 6.3 è®¾ç½®Acceptå’ŒContent-Type


```java
// åœºæ™¯ï¼šæŒ‡å®šæ¥æ”¶å’Œå‘é€çš„æ•°æ®æ ¼å¼
Mono<Product> productMono = webClient
    .post()
    .uri("/api/products")
    .contentType(MediaType.APPLICATION_JSON)     // å‘é€JSON
    .accept(MediaType.APPLICATION_JSON)          // æ¥æ”¶JSON
    .bodyValue(newProduct)
    .retrieve()
    .bodyToMono(Product.class);
```

**ğŸ“‹ å¸¸è§MediaType**

| MediaType | è¯´æ˜ | ç”¨é€” |
|-----------|------|------|
| `APPLICATION_JSON` | `application/json` | ç°ä»£APIæ ‡å‡†æ ¼å¼ |
| `APPLICATION_FORM_URLENCODED` | `application/x-www-form-urlencoded` | è¡¨å•æäº¤ |
| `MULTIPART_FORM_DATA` | `multipart/form-data` | æ–‡ä»¶ä¸Šä¼  |
| `TEXT_PLAIN` | `text/plain` | çº¯æ–‡æœ¬ |

### 6.4 å‚æ•°ä¼ é€’çš„ä¸‰ç§æ–¹å¼


**ğŸ¯ å‚æ•°ä¼ é€’æ–¹å¼å¯¹æ¯”**

```
1. è·¯å¾„å‚æ•°ï¼ˆPath Variableï¼‰
   /api/users/{id}  â†’  /api/users/123
   ç”¨é€”ï¼šæ ‡è¯†ç‰¹å®šèµ„æº

2. æŸ¥è¯¢å‚æ•°ï¼ˆQuery Parameterï¼‰  
   /api/users?name=å¼ ä¸‰&age=25
   ç”¨é€”ï¼šæœç´¢ã€è¿‡æ»¤ã€åˆ†é¡µ

3. è¯·æ±‚ä½“ï¼ˆRequest Bodyï¼‰
   POST /api/users
   Body: {"name":"å¼ ä¸‰","age":25}
   ç”¨é€”ï¼šæäº¤å¤æ‚æ•°æ®
```

**å®é™…åº”ç”¨ç¤ºä¾‹**
```java
// ç»„åˆä½¿ç”¨ï¼šæœç´¢+åˆ†é¡µ
Mono<PageResult> resultMono = webClient
    .get()
    .uri(uriBuilder -> uriBuilder
        .path("/api/products/search/{category}")    // è·¯å¾„å‚æ•°
        .queryParam("keyword", "æ‰‹æœº")              // æŸ¥è¯¢å‚æ•°
        .queryParam("page", 1)                     
        .queryParam("size", 20)
        .build("electronics"))                      // æ›¿æ¢{category}
    .retrieve()
    .bodyToMono(PageResult.class);
```

---

## 7. ğŸ“¦ è¯·æ±‚ä½“å¤„ç†è¯¦è§£


### 7.1 ä»€ä¹ˆæ˜¯è¯·æ±‚ä½“


**é€šä¿—ç†è§£**ï¼šè¯·æ±‚ä½“å°±æ˜¯ä½ è¦å‘é€çš„"è´§ç‰©"ï¼Œå¯ä»¥æ˜¯JSONå¯¹è±¡ã€è¡¨å•æ•°æ®ã€æ–‡ä»¶ç­‰ã€‚

**ğŸ”¸ è¯·æ±‚ä½“çš„ä½œç”¨**
- æºå¸¦è¦æäº¤çš„æ•°æ®ï¼ˆç”¨æˆ·ä¿¡æ¯ã€è®¢å•ä¿¡æ¯ç­‰ï¼‰
- åªåœ¨POSTã€PUTã€PATCHè¯·æ±‚ä¸­ä½¿ç”¨
- GETå’ŒDELETEé€šå¸¸ä¸éœ€è¦è¯·æ±‚ä½“

### 7.2 è®¾ç½®è¯·æ±‚ä½“çš„æ–¹å¼


**æ–¹å¼1ï¼šbodyValue() - ç®€å•å¯¹è±¡**
```java
// é€‚åˆï¼šç®€å•çš„Javaå¯¹è±¡
User user = new User("å¼ ä¸‰", "zhangsan@example.com");

webClient.post()
    .uri("/api/users")
    .bodyValue(user)           // è‡ªåŠ¨è½¬JSON
    .retrieve()
    .bodyToMono(User.class);
```

**æ–¹å¼2ï¼šbody() - å“åº”å¼æ•°æ®æµ**
```java
// é€‚åˆï¼šå·²ç»æ˜¯Monoæˆ–Fluxçš„æ•°æ®
Mono<User> userMono = getUserFromDatabase();

webClient.post()
    .uri("/api/users")
    .body(userMono, User.class)    // ä¼ å…¥Mono/Flux
    .retrieve()
    .bodyToMono(User.class);
```

**æ–¹å¼3ï¼šsyncBody() - å·²åºŸå¼ƒï¼Œç”¨bodyValueæ›¿ä»£**

### 7.3 ä¸åŒæ•°æ®ç±»å‹çš„è¯·æ±‚ä½“


**JSONå¯¹è±¡ï¼ˆæœ€å¸¸ç”¨ï¼‰**
```java
Order order = new Order("PROD123", 2, "å¼ ä¸‰");

webClient.post()
    .uri("/api/orders")
    .contentType(MediaType.APPLICATION_JSON)
    .bodyValue(order)              // è‡ªåŠ¨åºåˆ—åŒ–ä¸ºJSON
    .retrieve();
```

**è¡¨å•æ•°æ®**
```java
MultiValueMap<String, String> formData = new LinkedMultiValueMap<>();
formData.add("username", "zhangsan");
formData.add("password", "123456");

webClient.post()
    .uri("/api/login")
    .contentType(MediaType.APPLICATION_FORM_URLENCODED)
    .bodyValue(formData)
    .retrieve();
```

**æ–‡ä»¶ä¸Šä¼ **
```java
MultipartBodyBuilder builder = new MultipartBodyBuilder();
builder.part("file", new FileSystemResource("photo.jpg"));
builder.part("description", "ç”¨æˆ·å¤´åƒ");

webClient.post()
    .uri("/api/upload")
    .contentType(MediaType.MULTIPART_FORM_DATA)
    .bodyValue(builder.build())
    .retrieve();
```

**ğŸ”¸ bodyValue() vs body() é€‰æ‹©**

| æ–¹æ³• | ä½¿ç”¨åœºæ™¯ | ç¤ºä¾‹ |
|------|---------|------|
| `bodyValue()` | å·²æœ‰å…·ä½“å¯¹è±¡ | `bodyValue(user)` |
| `body()` | æ•°æ®æ¥è‡ªå¼‚æ­¥æµ | `body(userMono, User.class)` |

---

## 8. ğŸ“¨ å“åº”æ•°æ®å¤„ç†


### 8.1 bodyToMonoæ–¹æ³•è¯¦è§£


**ğŸ”¸ bodyToMonoæ˜¯ä»€ä¹ˆ**

é€šä¿—è¯´æ³•ï¼š`bodyToMono()`å°±æ˜¯æŠŠæœåŠ¡å™¨è¿”å›çš„æ•°æ®ï¼ˆJSONï¼‰è½¬æ¢æˆ**å•ä¸ªJavaå¯¹è±¡**ã€‚

```
æœåŠ¡å™¨è¿”å›ï¼š{"id":1,"name":"å¼ ä¸‰"}
           â†“ bodyToMono(User.class)
Javaå¯¹è±¡ï¼š  Userå¯¹è±¡(id=1, name="å¼ ä¸‰")
```

**åŸºç¡€ç”¨æ³•**
```java
// åœºæ™¯ï¼šè·å–å•ä¸ªç”¨æˆ·
Mono<User> userMono = webClient
    .get()
    .uri("/api/users/123")
    .retrieve()
    .bodyToMono(User.class);    // è½¬ä¸ºUserå¯¹è±¡

// ä½¿ç”¨ç»“æœ
userMono.subscribe(user -> {
    System.out.println("ç”¨æˆ·åï¼š" + user.getName());
});
```

**ğŸ’¡ é€‚ç”¨åœºæ™¯**
- âœ… è·å–å•ä¸ªèµ„æºï¼ˆä¸€ä¸ªç”¨æˆ·ã€ä¸€ä¸ªè®¢å•ï¼‰
- âœ… è¿”å›ç®€å•å“åº”ï¼ˆæˆåŠŸæ¶ˆæ¯ã€çŠ¶æ€ä¿¡æ¯ï¼‰
- âŒ ä¸é€‚åˆè¿”å›åˆ—è¡¨æ•°æ®ï¼ˆç”¨bodyToFluxï¼‰

### 8.2 bodyToFluxæ–¹æ³•è¯¦è§£


**ğŸ”¸ bodyToFluxæ˜¯ä»€ä¹ˆ**

é€šä¿—è¯´æ³•ï¼š`bodyToFlux()`æŠŠæœåŠ¡å™¨è¿”å›çš„**å¤šæ¡æ•°æ®**è½¬æ¢æˆJavaå¯¹è±¡æµï¼Œå¯ä»¥ä¸€ä¸ªä¸€ä¸ªå¤„ç†ã€‚

```
æœåŠ¡å™¨è¿”å›ï¼š[{"id":1,"name":"å¼ ä¸‰"},{"id":2,"name":"æå››"}]
           â†“ bodyToFlux(User.class)
å¯¹è±¡æµï¼š    User1 â†’ User2 â†’ User3...ï¼ˆåƒä¼ é€å¸¦ä¸€æ ·ï¼‰
```

**åŸºç¡€ç”¨æ³•**
```java
// åœºæ™¯ï¼šè·å–ç”¨æˆ·åˆ—è¡¨
Flux<User> usersFlux = webClient
    .get()
    .uri("/api/users")
    .retrieve()
    .bodyToFlux(User.class);     // è½¬ä¸ºUserå¯¹è±¡æµ

// é€ä¸ªå¤„ç†
usersFlux.subscribe(user -> {
    System.out.println("å¤„ç†ç”¨æˆ·ï¼š" + user.getName());
});

// æˆ–è€…æ”¶é›†æˆList
Mono<List<User>> userListMono = usersFlux.collectList();
```

**ğŸ’¡ é€‚ç”¨åœºæ™¯**
- âœ… è¿”å›åˆ—è¡¨æ•°æ®ï¼ˆç”¨æˆ·åˆ—è¡¨ã€å•†å“åˆ—è¡¨ï¼‰
- âœ… å¤§æ•°æ®æµå¼å¤„ç†ï¼ˆä¸ç”¨ç­‰å…¨éƒ¨åŠ è½½å®Œï¼‰
- âœ… éœ€è¦é€ä¸ªå¤„ç†æ•°æ®

### 8.3 bodyToMono vs bodyToFluxå¯¹æ¯”


**ğŸ¯ å¦‚ä½•é€‰æ‹©**

```
è¿”å›å•ä¸ªå¯¹è±¡ï¼Ÿ        è¿”å›å¤šä¸ªå¯¹è±¡ï¼Ÿ
    â†“                    â†“
bodyToMono()         bodyToFlux()

ç¤ºä¾‹ï¼š
è·å–ä¸€ä¸ªç”¨æˆ·   â†’  bodyToMono(User.class)
è·å–ç”¨æˆ·åˆ—è¡¨   â†’  bodyToFlux(User.class)
åˆ›å»ºè®¢å•è¿”å›   â†’  bodyToMono(Order.class)
æŸ¥è¯¢æ‰€æœ‰è®¢å•   â†’  bodyToFlux(Order.class)
```

**ä»£ç å¯¹æ¯”**
```java
// æƒ…å†µ1ï¼šè¿”å›å•ä¸ªå¯¹è±¡
Mono<User> singleUser = webClient.get()
    .uri("/api/users/123")
    .retrieve()
    .bodyToMono(User.class);        // ç”¨Mono

// æƒ…å†µ2ï¼šè¿”å›å¯¹è±¡æ•°ç»„
Flux<User> multipleUsers = webClient.get()
    .uri("/api/users")
    .retrieve()
    .bodyToFlux(User.class);        // ç”¨Flux

// æƒ…å†µ3ï¼šFluxè½¬List
Mono<List<User>> userList = multipleUsers.collectList();
```

### 8.4 å“åº”æ•°æ®çš„å…¶ä»–å¤„ç†


**è½¬æ¢ä¸ºå­—ç¬¦ä¸²**
```java
// è·å–åŸå§‹JSONå­—ç¬¦ä¸²
Mono<String> jsonMono = webClient.get()
    .uri("/api/users/123")
    .retrieve()
    .bodyToMono(String.class);      // è¿”å›åŸå§‹JSON
```

**è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ï¼ˆæ–‡ä»¶ä¸‹è½½ï¼‰**
```java
// ä¸‹è½½æ–‡ä»¶
Mono<byte[]> fileMono = webClient.get()
    .uri("/api/files/download/123")
    .retrieve()
    .bodyToMono(byte[].class);      // è¿”å›å­—èŠ‚æ•°ç»„
```

**æ— è¿”å›å€¼å¤„ç†**
```java
// åˆ é™¤æ“ä½œï¼Œæ— è¿”å›å†…å®¹
Mono<Void> deleteMono = webClient.delete()
    .uri("/api/users/123")
    .retrieve()
    .bodyToMono(Void.class);        // ç”¨Void.class
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 è¯·æ±‚æ–¹æ³•é€ŸæŸ¥è¡¨


| HTTPæ–¹æ³• | ä½œç”¨ | å¸¸ç”¨åœºæ™¯ | WebClientæ–¹æ³• |
|---------|------|---------|--------------|
| **GET** | æŸ¥è¯¢æ•°æ® | è·å–ç”¨æˆ·ã€æŸ¥è¯¢è®¢å• | `.get()` |
| **POST** | åˆ›å»ºæ•°æ® | æ³¨å†Œç”¨æˆ·ã€ä¸‹å• | `.post()` |
| **PUT** | æ›´æ–°æ•°æ® | ä¿®æ”¹èµ„æ–™ã€æ›´æ–°è®¢å• | `.put()` |
| **DELETE** | åˆ é™¤æ•°æ® | åˆ é™¤ç”¨æˆ·ã€å–æ¶ˆè®¢å• | `.delete()` |

### 9.2 å‚æ•°ä¼ é€’é€ŸæŸ¥


**ğŸ”¸ ä¸‰ç§å‚æ•°æ–¹å¼**
```java
// 1. è·¯å¾„å‚æ•° - èµ„æºæ ‡è¯†
.uri("/api/users/{id}", "123")

// 2. æŸ¥è¯¢å‚æ•° - æœç´¢è¿‡æ»¤
.uri(uriBuilder -> uriBuilder
    .path("/api/users")
    .queryParam("name", "å¼ ä¸‰")
    .build())

// 3. è¯·æ±‚ä½“ - å¤æ‚æ•°æ®
.bodyValue(userObject)
```

### 9.3 å“åº”å¤„ç†é€ŸæŸ¥


**ğŸ”¸ bodyToMono vs bodyToFlux**
```
å•ä¸ªå¯¹è±¡ â†’ bodyToMono(Class)    ä¾‹ï¼šMono<User>
å¤šä¸ªå¯¹è±¡ â†’ bodyToFlux(Class)    ä¾‹ï¼šFlux<User>
è½¬List   â†’ .collectList()       ä¾‹ï¼šMono<List<User>>
```

### 9.4 å®Œæ•´è¯·æ±‚ç¤ºä¾‹


```java
// å…¸å‹çš„POSTè¯·æ±‚å®Œæ•´æµç¨‹
public Mono<OrderResult> createOrder(CreateOrderRequest request) {
    return webClient
        .post()                                          // 1.é€‰æ‹©æ–¹æ³•
        .uri("/api/orders")                              // 2.è®¾ç½®è·¯å¾„
        .header("Authorization", "Bearer " + token)      // 3.è®¾ç½®è¯·æ±‚å¤´
        .contentType(MediaType.APPLICATION_JSON)         // 4.è®¾ç½®å†…å®¹ç±»å‹
        .bodyValue(request)                              // 5.è®¾ç½®è¯·æ±‚ä½“
        .retrieve()                                      // 6.å‘é€è¯·æ±‚
        .bodyToMono(OrderResult.class)                   // 7.å¤„ç†å“åº”
        .doOnSuccess(result -> log.info("è®¢å•åˆ›å»ºæˆåŠŸ"))  // 8.æˆåŠŸå›è°ƒ
        .doOnError(error -> log.error("åˆ›å»ºå¤±è´¥", error)); // 9.é”™è¯¯å¤„ç†
}
```

### 9.5 æœ€ä½³å®è·µå»ºè®®


**âœ… æ¨èåšæ³•**
- ä½¿ç”¨`bodyToMono`å¤„ç†å•ä¸ªå¯¹è±¡
- ä½¿ç”¨`bodyToFlux`å¤„ç†åˆ—è¡¨æ•°æ®
- æ˜ç¡®è®¾ç½®`Content-Type`å’Œ`Accept`
- è·¯å¾„å‚æ•°ç”¨äºèµ„æºæ ‡è¯†ï¼ŒæŸ¥è¯¢å‚æ•°ç”¨äºè¿‡æ»¤
- æ·»åŠ é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

**âŒ é¿å…åšæ³•**
- ä¸è¦åœ¨GETè¯·æ±‚ä¸­ä½¿ç”¨è¯·æ±‚ä½“
- ä¸è¦æ··ç”¨bodyValueå’Œbodyï¼ˆé€‰ä¸€ä¸ªç”¨ï¼‰
- ä¸è¦å¿˜è®°è®¾ç½®æ­£ç¡®çš„MediaType
- é¿å…é˜»å¡æ“ä½œï¼ˆå¦‚`.block()`ï¼‰ï¼Œä¿æŒå“åº”å¼

### 9.6 è®°å¿†å£è¯€


```
ğŸ”¸ è¯·æ±‚æ–¹æ³•å››å…„å¼Ÿï¼šGETæŸ¥POSTå¢PUTæ”¹DELETEåˆ 
ğŸ”¸ å‚æ•°ä¼ é€’ä¸‰æ–¹å¼ï¼šè·¯å¾„æ ‡è¯†æŸ¥è¯¢ç­›è¯·æ±‚ä½“ä¼ æ•°æ®
ğŸ”¸ å“åº”å¤„ç†è®°ä¸¤æ ·ï¼šå•ä¸ªMonoå¤šä¸ªFlux
ğŸ”¸ è¯·æ±‚æ„å»ºåƒæ­ç§¯æœ¨ï¼šæ–¹æ³•â†’è·¯å¾„â†’è¯·æ±‚å¤´â†’è¯·æ±‚ä½“â†’å‘é€â†’å¤„ç†
```

**ğŸ¯ æ ¸å¿ƒç†è§£**
- WebClientæ˜¯**å“åº”å¼**çš„ï¼Œä¸ä¼šé˜»å¡ç­‰å¾…
- è¯·æ±‚æ„å»ºé‡‡ç”¨**é“¾å¼è°ƒç”¨**ï¼Œæ¸…æ™°ç›´è§‚
- `bodyToMono`è¿”å›**å•ä¸ªå¯¹è±¡**ï¼Œ`bodyToFlux`è¿”å›**å¯¹è±¡æµ**
- è¯·æ±‚ä½“åªåœ¨POST/PUT/PATCHä¸­ä½¿ç”¨
- æ‰€æœ‰æ“ä½œéƒ½è¿”å›Monoæˆ–Fluxï¼Œéœ€è¦subscribeæ‰çœŸæ­£æ‰§è¡Œ