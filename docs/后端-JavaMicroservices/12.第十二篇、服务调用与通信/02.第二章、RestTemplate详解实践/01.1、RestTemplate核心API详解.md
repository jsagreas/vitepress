---
title: 1ã€RestTemplateæ ¸å¿ƒAPIè¯¦è§£
---
## ğŸ“š ç›®å½•

1. [RestTemplateæ˜¯ä»€ä¹ˆ](#1-RestTemplateæ˜¯ä»€ä¹ˆ)
2. [RestTemplateå®ä¾‹åˆ›å»º](#2-RestTemplateå®ä¾‹åˆ›å»º)
3. [GETè¯·æ±‚æ–¹æ³•è¯¦è§£](#3-GETè¯·æ±‚æ–¹æ³•è¯¦è§£)
4. [POSTè¯·æ±‚æ–¹æ³•è¯¦è§£](#4-POSTè¯·æ±‚æ–¹æ³•è¯¦è§£)
5. [PUTè¯·æ±‚æ–¹æ³•è¯¦è§£](#5-PUTè¯·æ±‚æ–¹æ³•è¯¦è§£)
6. [DELETEè¯·æ±‚æ–¹æ³•è¯¦è§£](#6-DELETEè¯·æ±‚æ–¹æ³•è¯¦è§£)
7. [exchangeé€šç”¨æ–¹æ³•](#7-exchangeé€šç”¨æ–¹æ³•)
8. [getForObjectä¸getForEntityåŒºåˆ«](#8-getForObjectä¸getForEntityåŒºåˆ«)
9. [ResponseEntityå“åº”å°è£…](#9-ResponseEntityå“åº”å°è£…)
10. [URIæ¨¡æ¿å‚æ•°ä¼ é€’](#10-URIæ¨¡æ¿å‚æ•°ä¼ é€’)
11. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#11-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ RestTemplateæ˜¯ä»€ä¹ˆ


### 1.1 é€šä¿—ç†è§£


**ğŸ”¸ ç”Ÿæ´»ä¸­çš„ç±»æ¯”**
```
æƒ³è±¡ä¸€ä¸‹ä½ å»é¥­åº—ç‚¹é¤ï¼š
ä½ ï¼ˆæœåŠ¡Aï¼‰ â€”â€”> æœåŠ¡å‘˜ â€”â€”> å¨æˆ¿ï¼ˆæœåŠ¡Bï¼‰
            ä¼ è¯ç­’        

RestTemplateå°±åƒè¿™ä¸ª"æœåŠ¡å‘˜"ï¼š
- ä½ å‘Šè¯‰å®ƒè¦ä»€ä¹ˆï¼ˆå‘é€è¯·æ±‚ï¼‰
- å®ƒå»å¨æˆ¿æ‹¿å›æ¥ï¼ˆæ¥æ”¶å“åº”ï¼‰
- ä½ ä¸ç”¨è‡ªå·±è·‘åˆ°å¨æˆ¿ï¼ˆä¸ç”¨è‡ªå·±å¤„ç†HTTPç»†èŠ‚ï¼‰
```

**ğŸ’¡ æŠ€æœ¯å®šä¹‰**
```
RestTemplateæ˜¯Springæä¾›çš„HTTPå®¢æˆ·ç«¯å·¥å…·ç±»
ä½œç”¨ï¼šè®©Javaç¨‹åºèƒ½å¤Ÿæ–¹ä¾¿åœ°è°ƒç”¨å…¶ä»–HTTPæ¥å£
æœ¬è´¨ï¼šå°è£…äº†HTTPè¯·æ±‚çš„å‘é€å’Œå“åº”çš„æ¥æ”¶

å¾®æœåŠ¡åœºæ™¯ï¼š
æœåŠ¡Aéœ€è¦è°ƒç”¨æœåŠ¡Bçš„æ¥å£ â†’ ä½¿ç”¨RestTemplateå‘é€HTTPè¯·æ±‚
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦RestTemplate


**ğŸ” è§£å†³çš„é—®é¢˜**
```
ä¼ ç»Ÿæ–¹å¼ï¼ˆä¸ç”¨RestTemplateï¼‰ï¼š
1. æ‰‹åŠ¨åˆ›å»ºHttpURLConnection
2. è®¾ç½®è¯·æ±‚å¤´ã€è¯·æ±‚ä½“
3. å‘é€è¯·æ±‚ã€è¯»å–å“åº”
4. å¤„ç†IOæµã€å…³é—­è¿æ¥
â†’ ä»£ç ç¹çï¼Œå®¹æ˜“å‡ºé”™

ä½¿ç”¨RestTemplateï¼š
ä¸€è¡Œä»£ç æå®šHTTPè¯·æ±‚
User user = restTemplate.getForObject(url, User.class);
â†’ ç®€å•ä¼˜é›…ï¼Œä¸“æ³¨ä¸šåŠ¡
```

### 1.3 RestTemplateåœ¨å¾®æœåŠ¡ä¸­çš„ä½ç½®


**ğŸ“Š å¾®æœåŠ¡é€šä¿¡æ¶æ„**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è®¢å•æœåŠ¡   â”‚          â”‚  ç”¨æˆ·æœåŠ¡   â”‚
â”‚             â”‚          â”‚             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  HTTP   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚RestTemplateâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ Controllerâ”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  è¯·æ±‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚          â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è®¢å•æœåŠ¡éœ€è¦ç”¨æˆ·ä¿¡æ¯ï¼š
1. è®¢å•æœåŠ¡ç”¨RestTemplateå‘èµ·HTTPè¯·æ±‚
2. ç”¨æˆ·æœåŠ¡çš„Controlleræ¥æ”¶è¯·æ±‚
3. è¿”å›ç”¨æˆ·æ•°æ®ç»™è®¢å•æœåŠ¡
```

---

## 2. ğŸ”§ RestTemplateå®ä¾‹åˆ›å»º


### 2.1 æœ€åŸºç¡€çš„åˆ›å»ºæ–¹å¼


**ğŸŸ¢ æ–¹å¼ä¸€ï¼šç›´æ¥newï¼ˆæœ€ç®€å•ï¼‰**
```java
// åˆ›å»ºä¸€ä¸ªé»˜è®¤çš„RestTemplate
RestTemplate restTemplate = new RestTemplate();

// ä½¿ç”¨è¯´æ˜ï¼š
// - å¼€ç®±å³ç”¨ï¼Œæ— éœ€é…ç½®
// - é€‚åˆç®€å•åœºæ™¯
// - åŠŸèƒ½æœ‰é™ï¼Œæ— æ³•å®šåˆ¶
```

**ğŸ’¡ ç†è§£è¦ç‚¹**
```
ç›´æ¥newå°±åƒä¹°ä¸€è¾†æ ‡å‡†é…ç½®çš„è½¦ï¼š
âœ… ä¼˜ç‚¹ï¼šæ‹¿åˆ°å°±èƒ½å¼€
âŒ ç¼ºç‚¹ï¼šæ— æ³•æ”¹è£…ï¼ˆè¶…æ—¶æ—¶é—´ã€è¿æ¥æ± ç­‰ï¼‰
```

### 2.2 é…ç½®åŒ–åˆ›å»ºï¼ˆæ¨èæ–¹å¼ï¼‰


**ğŸŸ¡ æ–¹å¼äºŒï¼šé€šè¿‡é…ç½®ç±»åˆ›å»º**
```java
@Configuration
public class RestTemplateConfig {
    
    @Bean
    public RestTemplate restTemplate() {
        // åˆ›å»ºå·¥å‚
        SimpleClientHttpRequestFactory factory = 
            new SimpleClientHttpRequestFactory();
        
        // è®¾ç½®è¶…æ—¶æ—¶é—´ï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰
        factory.setConnectTimeout(5000);  // è¿æ¥è¶…æ—¶5ç§’
        factory.setReadTimeout(10000);    // è¯»å–è¶…æ—¶10ç§’
        
        // ç”¨å·¥å‚åˆ›å»ºRestTemplate
        return new RestTemplate(factory);
    }
}
```

**ğŸ” é…ç½®é¡¹è§£é‡Š**
```
ConnectTimeoutï¼ˆè¿æ¥è¶…æ—¶ï¼‰ï¼š
å«ä¹‰ï¼šå»ºç«‹è¿æ¥çš„æœ€é•¿ç­‰å¾…æ—¶é—´
åœºæ™¯ï¼šç½‘ç»œä¸å¥½æ—¶ï¼Œé¿å…ä¸€ç›´ç­‰å¾…
ç¤ºä¾‹ï¼š5ç§’å†…è¿ä¸ä¸Šå°±æ”¾å¼ƒ

ReadTimeoutï¼ˆè¯»å–è¶…æ—¶ï¼‰ï¼š
å«ä¹‰ï¼šç­‰å¾…å“åº”æ•°æ®çš„æœ€é•¿æ—¶é—´
åœºæ™¯ï¼šæœåŠ¡å¤„ç†æ…¢æ—¶ï¼Œé¿å…é•¿æ—¶é—´ç­‰å¾…
ç¤ºä¾‹ï¼š10ç§’å†…æ²¡æ”¶åˆ°æ•°æ®å°±æ”¾å¼ƒ

ä¸ºä»€ä¹ˆè¦è®¾ç½®è¶…æ—¶ï¼š
ä¸è®¾ç½® â†’ å¯èƒ½æ°¸ä¹…ç­‰å¾… â†’ ç¨‹åºå¡æ­»
è®¾ç½®å â†’ è¶…æ—¶è‡ªåŠ¨æ”¾å¼ƒ â†’ å¯ä»¥é‡è¯•æˆ–é™çº§
```

### 2.3 RestTemplateä¸Springå®¹å™¨


**ğŸ”¸ ä¾èµ–æ³¨å…¥ä½¿ç”¨**
```java
@Service
public class OrderService {
    
    // æ–¹å¼1ï¼šæ„é€ å™¨æ³¨å…¥ï¼ˆæ¨èï¼‰
    private final RestTemplate restTemplate;
    
    public OrderService(RestTemplate restTemplate) {
        this.restTemplate = restTemplate;
    }
    
    // æ–¹å¼2ï¼šå­—æ®µæ³¨å…¥ï¼ˆä¸æ¨èï¼‰
    // @Autowired
    // private RestTemplate restTemplate;
}
```

**ğŸ’¡ ä¸ºä»€ä¹ˆç”¨ä¾èµ–æ³¨å…¥**
```
ä¸ç”¨ä¾èµ–æ³¨å…¥ï¼š
æ¯ä¸ªç±»éƒ½new RestTemplate() â†’ åˆ›å»ºå¤šä¸ªå®ä¾‹ â†’ æµªè´¹èµ„æº

ä½¿ç”¨ä¾èµ–æ³¨å…¥ï¼š
é…ç½®ç±»åˆ›å»ºä¸€ä¸ª â†’ Springå®¹å™¨ç®¡ç† â†’ æ‰€æœ‰ç±»å…±ç”¨
â†’ èŠ‚çœèµ„æºï¼Œç»Ÿä¸€é…ç½®
```

---

## 3. ğŸ“¥ GETè¯·æ±‚æ–¹æ³•è¯¦è§£


### 3.1 getForObject - ç›´æ¥è·å–æ•°æ®


**ğŸ”¸ æ ¸å¿ƒæ¦‚å¿µ**
```
getForObjectçš„ä½œç”¨ï¼š
å‘é€GETè¯·æ±‚ï¼Œç›´æ¥è¿”å›å“åº”ä½“çš„æ•°æ®å¯¹è±¡

é€šä¿—ç†è§£ï¼š
å°±åƒä½ é—®"ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·"ï¼Œå¯¹æ–¹ç›´æ¥å›ç­”"æ™´å¤©"
ä¸éœ€è¦é¢å¤–ä¿¡æ¯ï¼Œåªè¦ç­”æ¡ˆæœ¬èº«
```

**ğŸŸ¢ åŸºç¡€ç”¨æ³•**
```java
// åœºæ™¯ï¼šè·å–å•ä¸ªç”¨æˆ·ä¿¡æ¯
String url = "http://user-service/user/1";
User user = restTemplate.getForObject(url, User.class);

// å‚æ•°è¯´æ˜ï¼š
// urlï¼šè¦è°ƒç”¨çš„æ¥å£åœ°å€
// User.classï¼šæœŸæœ›è¿”å›çš„æ•°æ®ç±»å‹
// è¿”å›å€¼ï¼šç›´æ¥æ˜¯Userå¯¹è±¡
```

**ğŸ“Š æ–¹æ³•è°ƒç”¨æµç¨‹**
```
ä½ çš„ä»£ç                   RestTemplate              è¿œç¨‹æœåŠ¡
   |                          |                         |
   |--getForObject(url)------>|                         |
   |                          |---HTTP GETè¯·æ±‚--------->|
   |                          |                         |
   |                          |<--è¿”å›JSONæ•°æ®----------|
   |                          |                         |
   |                          |--è‡ªåŠ¨è½¬æ¢ä¸ºUserå¯¹è±¡----->|
   |<--è¿”å›Userå¯¹è±¡-----------|                         |
```

### 3.2 å¸¦è·¯å¾„å‚æ•°çš„GETè¯·æ±‚


**ğŸ”¸ åœºæ™¯ï¼šURLä¸­æœ‰åŠ¨æ€å‚æ•°**
```java
// æ–¹å¼1ï¼šä½¿ç”¨å ä½ç¬¦ {å‚æ•°å}
String url = "http://user-service/user/{id}";
User user = restTemplate.getForObject(url, User.class, 1);
//                                                      â†‘
//                                                 å‚æ•°å€¼ï¼ŒæŒ‰é¡ºåºä¼ 

// æ–¹å¼2ï¼šä½¿ç”¨Mapä¼ å‚ï¼ˆæ›´æ¸…æ™°ï¼‰
String url = "http://user-service/user/{id}/orders/{orderId}";
Map<String, Object> params = new HashMap<>();
params.put("id", 1);
params.put("orderId", 100);
User user = restTemplate.getForObject(url, User.class, params);
```

**ğŸ’¡ è·¯å¾„å‚æ•°ç†è§£**
```
ä¼ ç»Ÿæ–¹å¼ï¼š
"http://user-service/user/" + userId  // å­—ç¬¦ä¸²æ‹¼æ¥

RestTemplateæ–¹å¼ï¼š
"http://user-service/user/{id}"      // ç”¨å ä½ç¬¦
ç„¶åä¼ å…¥å‚æ•°å€¼

ä¼˜åŠ¿ï¼š
- ä»£ç æ›´æ¸…æ™°
- é¿å…æ‹¼æ¥é”™è¯¯
- å‚æ•°è‡ªåŠ¨ç¼–ç 
```

### 3.3 å¸¦æŸ¥è¯¢å‚æ•°çš„GETè¯·æ±‚


**ğŸ”¸ æŸ¥è¯¢å‚æ•°vsè·¯å¾„å‚æ•°**
```
è·¯å¾„å‚æ•°ï¼ˆPathVariableï¼‰ï¼š
http://api.com/user/1
              â†‘
            èµ„æºID

æŸ¥è¯¢å‚æ•°ï¼ˆRequestParamï¼‰ï¼š
http://api.com/users?age=20&city=beijing
                     â†‘
                  è¿‡æ»¤æ¡ä»¶
```

**ğŸ”§ æŸ¥è¯¢å‚æ•°ä¼ é€’æ–¹æ³•**
```java
// æ–¹å¼1ï¼šç›´æ¥æ‹¼æ¥åœ¨URLä¸­
String url = "http://user-service/users?age=20&city=beijing";
List<User> users = restTemplate.getForObject(url, List.class);

// æ–¹å¼2ï¼šä½¿ç”¨UriComponentsBuilderï¼ˆæ¨èï¼‰
String baseUrl = "http://user-service/users";
UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(baseUrl)
    .queryParam("age", 20)
    .queryParam("city", "beijing");
    
String url = builder.toUriString();
List<User> users = restTemplate.getForObject(url, List.class);
```

**âš¡ ä¸ºä»€ä¹ˆç”¨UriComponentsBuilder**
```
é—®é¢˜ï¼šä¸­æ–‡å‚æ•°éœ€è¦ç¼–ç 
"http://api.com/users?city=åŒ—äº¬"  âŒ å¯èƒ½ä¹±ç 

UriComponentsBuilderè‡ªåŠ¨å¤„ç†ï¼š
"http://api.com/users?city=%E5%8C%97%E4%BA%AC"  âœ… æ­£ç¡®ç¼–ç 

å…¶ä»–å¥½å¤„ï¼š
- å‚æ•°è‡ªåŠ¨ç¼–ç 
- é˜²æ­¢ç‰¹æ®Šå­—ç¬¦é—®é¢˜
- ä»£ç æ›´æ¸…æ™°
```

---

## 4. ğŸ“¤ POSTè¯·æ±‚æ–¹æ³•è¯¦è§£


### 4.1 postForObject - å‘é€æ•°æ®å¹¶è·å–ç»“æœ


**ğŸ”¸ POSTè¯·æ±‚çš„ä½œç”¨**
```
GETè¯·æ±‚ï¼šè·å–æ•°æ®ï¼ˆåªè¯»ï¼‰
POSTè¯·æ±‚ï¼šæäº¤æ•°æ®ï¼ˆå†™å…¥ï¼‰

ç”Ÿæ´»ç±»æ¯”ï¼š
GETï¼šå‘å›¾ä¹¦é¦†å€Ÿä¹¦ï¼ˆæŸ¥è¯¢ï¼‰
POSTï¼šå‘å›¾ä¹¦é¦†è¿˜ä¹¦ï¼ˆæäº¤ï¼‰
```

**ğŸŸ¢ åŸºç¡€POSTè¯·æ±‚**
```java
// åœºæ™¯ï¼šåˆ›å»ºæ–°ç”¨æˆ·
String url = "http://user-service/user";

// æ„é€ è¦æäº¤çš„æ•°æ®
User newUser = new User();
newUser.setName("å¼ ä¸‰");
newUser.setAge(25);

// å‘é€POSTè¯·æ±‚
User createdUser = restTemplate.postForObject(url, newUser, User.class);
//                                                  â†‘          â†‘
//                                            è¯·æ±‚ä½“æ•°æ®   è¿”å›ç±»å‹
```

**ğŸ“Š POSTè¯·æ±‚æµç¨‹**
```
ä½ çš„ä»£ç                   RestTemplate              è¿œç¨‹æœåŠ¡
   |                          |                         |
   |--postForObject(data)---->|                         |
   |                          |---HTTP POST------------>|
   |                          |   Content-Type: JSON    |
   |                          |   Body: {"name":"å¼ ä¸‰"}  |
   |                          |                         |
   |                          |<--è¿”å›åˆ›å»ºçš„ç”¨æˆ·---------|
   |<--è¿”å›Userå¯¹è±¡-----------|                         |
```

### 4.2 è¯·æ±‚ä½“çš„æ•°æ®æ ¼å¼


**ğŸ” å¸¸è§çš„è¯·æ±‚ä½“ç±»å‹**

**ç±»å‹1ï¼šJSONæ ¼å¼ï¼ˆæœ€å¸¸ç”¨ï¼‰**
```java
// Javaå¯¹è±¡ä¼šè‡ªåŠ¨è½¬ä¸ºJSON
User user = new User("å¼ ä¸‰", 25);
restTemplate.postForObject(url, user, User.class);

// å®é™…å‘é€çš„HTTPè¯·æ±‚ï¼š
// Content-Type: application/json
// Body: {"name":"å¼ ä¸‰","age":25}
```

**ç±»å‹2ï¼šè¡¨å•æ ¼å¼**
```java
// ä½¿ç”¨MultiValueMapè¡¨ç¤ºè¡¨å•æ•°æ®
MultiValueMap<String, String> formData = new LinkedMultiValueMap<>();
formData.add("username", "zhangsan");
formData.add("password", "123456");

// è®¾ç½®è¯·æ±‚å¤´
HttpHeaders headers = new HttpHeaders();
headers.setContentType(MediaType.APPLICATION_FORM_URLENCODED);

HttpEntity<MultiValueMap<String, String>> request = 
    new HttpEntity<>(formData, headers);
    
String result = restTemplate.postForObject(url, request, String.class);

// å®é™…å‘é€çš„HTTPè¯·æ±‚ï¼š
// Content-Type: application/x-www-form-urlencoded
// Body: username=zhangsan&password=123456
```

**ğŸ’¡ JSON vs è¡¨å•æ•°æ®**
```
JSONæ ¼å¼ï¼š
é€‚ç”¨åœºæ™¯ï¼šç°ä»£Web APIï¼Œå¾®æœåŠ¡é€šä¿¡
æ•°æ®ç»“æ„ï¼šå¯ä»¥æ˜¯å¤æ‚å¯¹è±¡ã€æ•°ç»„
ç¤ºä¾‹ï¼š{"user":{"name":"å¼ ä¸‰","age":25}}

è¡¨å•æ ¼å¼ï¼š
é€‚ç”¨åœºæ™¯ï¼šä¼ ç»ŸWebè¡¨å•ï¼Œç®€å•å‚æ•°
æ•°æ®ç»“æ„ï¼šé”®å€¼å¯¹ï¼Œä¸èƒ½åµŒå¥—
ç¤ºä¾‹ï¼šname=å¼ ä¸‰&age=25
```

### 4.3 å¸¦è¯·æ±‚å¤´çš„POSTè¯·æ±‚


**ğŸ”¸ ä»€ä¹ˆæ—¶å€™éœ€è¦è®¾ç½®è¯·æ±‚å¤´**
```
å¸¸è§åœºæ™¯ï¼š
1. éœ€è¦è®¤è¯ï¼šä¼ Token
2. æŒ‡å®šæ ¼å¼ï¼šContent-Type
3. è‡ªå®šä¹‰å¤´ï¼šä¸šåŠ¡æ ‡è¯†
```

**ğŸ”§ è®¾ç½®è¯·æ±‚å¤´çš„æ–¹æ³•**
```java
// åˆ›å»ºè¯·æ±‚å¤´
HttpHeaders headers = new HttpHeaders();
headers.setContentType(MediaType.APPLICATION_JSON);
headers.set("Authorization", "Bearer token123");
headers.set("Custom-Header", "custom-value");

// åˆ›å»ºè¯·æ±‚å®ä½“ï¼ˆè¯·æ±‚å¤´+è¯·æ±‚ä½“ï¼‰
User user = new User("å¼ ä¸‰", 25);
HttpEntity<User> request = new HttpEntity<>(user, headers);

// å‘é€å¸¦è¯·æ±‚å¤´çš„POSTè¯·æ±‚
User result = restTemplate.postForObject(url, request, User.class);
```

**ğŸ“‹ è¯·æ±‚ç»„æˆç†è§£**
```
å®Œæ•´çš„HTTP POSTè¯·æ±‚åŒ…å«ä¸‰éƒ¨åˆ†ï¼š

1. è¯·æ±‚è¡Œï¼šPOST /user HTTP/1.1
2. è¯·æ±‚å¤´ï¼š
   Content-Type: application/json
   Authorization: Bearer token123
3. è¯·æ±‚ä½“ï¼š
   {"name":"å¼ ä¸‰","age":25}

HttpEntityçš„ä½œç”¨ï¼š
æŠŠè¯·æ±‚å¤´å’Œè¯·æ±‚ä½“ç»„åˆåœ¨ä¸€èµ·
```

---

## 5. ğŸ”„ PUTè¯·æ±‚æ–¹æ³•è¯¦è§£


### 5.1 PUTè¯·æ±‚çš„ç‰¹ç‚¹


**ğŸ”¸ PUT vs POST çš„åŒºåˆ«**
```
POSTï¼šåˆ›å»ºæ–°èµ„æº
ç¤ºä¾‹ï¼šPOST /users  â†’ åˆ›å»ºæ–°ç”¨æˆ·

PUTï¼šæ›´æ–°å·²æœ‰èµ„æºï¼ˆæ›¿æ¢ï¼‰
ç¤ºä¾‹ï¼šPUT /users/1 â†’ æ›´æ–°IDä¸º1çš„ç”¨æˆ·

åŒºåˆ«è®°å¿†ï¼š
POST = æ–°å¢ï¼ˆAddï¼‰
PUT = æ›¿æ¢ï¼ˆReplaceï¼‰
```

**ğŸ’¡ RESTfulé£æ ¼ç†è§£**
```
HTTPæ–¹æ³•      æ“ä½œç±»å‹      ç¤ºä¾‹
GET          æŸ¥è¯¢         GET /users/1
POST         åˆ›å»º         POST /users
PUT          æ›´æ–°         PUT /users/1
DELETE       åˆ é™¤         DELETE /users/1
```

### 5.2 putæ–¹æ³•ä½¿ç”¨


**ğŸŸ¢ åŸºç¡€PUTè¯·æ±‚**
```java
// åœºæ™¯ï¼šæ›´æ–°ç”¨æˆ·ä¿¡æ¯
String url = "http://user-service/user/1";

// æ„é€ æ›´æ–°åçš„æ•°æ®
User updatedUser = new User();
updatedUser.setId(1);
updatedUser.setName("æå››");
updatedUser.setAge(30);

// å‘é€PUTè¯·æ±‚ï¼ˆæ— è¿”å›å€¼ï¼‰
restTemplate.put(url, updatedUser);

// æ³¨æ„ï¼šputæ–¹æ³•è¿”å›void
// å¦‚æœéœ€è¦è¿”å›å€¼ï¼Œä½¿ç”¨exchangeæ–¹æ³•
```

**âš ï¸ PUTæ–¹æ³•çš„ç‰¹æ®Šæ€§**
```
ä¸POSTä¸åŒï¼š
postForObject() â†’ æœ‰è¿”å›å€¼ï¼ˆåˆ›å»ºçš„èµ„æºï¼‰
put()          â†’ æ— è¿”å›å€¼ï¼ˆåªè¡¨ç¤ºæ›´æ–°æˆåŠŸï¼‰

ä¸ºä»€ä¹ˆæ— è¿”å›å€¼ï¼š
PUTæ˜¯å¹‚ç­‰æ“ä½œï¼Œå¤šæ¬¡æ‰§è¡Œç»“æœç›¸åŒ
é€šå¸¸åªéœ€è¦çŸ¥é“æˆåŠŸ/å¤±è´¥ï¼Œä¸éœ€è¦è¿”å›æ•°æ®

å¦‚æœéœ€è¦è¿”å›å€¼æ€ä¹ˆåŠï¼š
ä½¿ç”¨exchange()æ–¹æ³•ï¼Œåé¢ä¼šè®²
```

### 5.3 å¸¦è·¯å¾„å‚æ•°çš„PUTè¯·æ±‚


**ğŸ”§ å®é™…åº”ç”¨åœºæ™¯**
```java
// åœºæ™¯ï¼šä¿®æ”¹æŒ‡å®šç”¨æˆ·çš„æŒ‡å®šå­—æ®µ
String url = "http://user-service/user/{id}/email";
String email = "newemail@example.com";

// æ–¹å¼1ï¼šç›´æ¥ä¼ å‚æ•°å€¼
restTemplate.put(url, email, 1);

// æ–¹å¼2ï¼šç”¨Mapä¼ å‚ï¼ˆå¤šå‚æ•°æ—¶æ›´æ¸…æ™°ï¼‰
Map<String, Object> params = new HashMap<>();
params.put("id", 1);

HttpEntity<String> request = new HttpEntity<>(email);
restTemplate.put(url, request, params);
```

**ğŸ“Š æ›´æ–°æ“ä½œå¯¹æ¯”**
```
å…¨é‡æ›´æ–°ï¼ˆPUTï¼‰ï¼š
PUT /users/1
Body: {"id":1, "name":"æå››", "age":30, "email":"xxx"}
â†’ æ›¿æ¢æ•´ä¸ªèµ„æº

éƒ¨åˆ†æ›´æ–°ï¼ˆPATCHï¼Œéœ€ç”¨exchangeï¼‰ï¼š
PATCH /users/1
Body: {"email":"xxx"}
â†’ åªæ›´æ–°emailå­—æ®µ
```

---

## 6. ğŸ—‘ï¸ DELETEè¯·æ±‚æ–¹æ³•è¯¦è§£


### 6.1 DELETEè¯·æ±‚åŸºç¡€


**ğŸ”¸ DELETEè¯·æ±‚çš„ä½œç”¨**
```
ä½œç”¨ï¼šåˆ é™¤æœåŠ¡å™¨ä¸Šçš„èµ„æº
ç‰¹ç‚¹ï¼šæ“ä½œç®€å•ï¼Œé€šå¸¸ä¸éœ€è¦è¯·æ±‚ä½“

ç”Ÿæ´»ç±»æ¯”ï¼š
DELETE = æ‰”åƒåœ¾
ä¸éœ€è¦å¤æ‚æ“ä½œï¼Œåªéœ€è¦æŒ‡å®šåˆ é™¤å“ªä¸ª
```

**ğŸŸ¢ åŸºç¡€DELETEè¯·æ±‚**
```java
// åœºæ™¯ï¼šåˆ é™¤æŒ‡å®šç”¨æˆ·
String url = "http://user-service/user/1";

// å‘é€DELETEè¯·æ±‚
restTemplate.delete(url);

// æ³¨æ„ï¼šdeleteæ–¹æ³•è¿”å›void
// ä¸æŠ›å¼‚å¸¸å°±è¡¨ç¤ºåˆ é™¤æˆåŠŸ
```

### 6.2 å¸¦å‚æ•°çš„DELETEè¯·æ±‚


**ğŸ”§ è·¯å¾„å‚æ•°æ–¹å¼**
```java
// æ–¹å¼1ï¼šå ä½ç¬¦ä¼ å‚
String url = "http://user-service/user/{id}";
restTemplate.delete(url, 1);

// æ–¹å¼2ï¼šMapä¼ å‚
Map<String, Object> params = new HashMap<>();
params.put("id", 1);
restTemplate.delete(url, params);
```

**ğŸ” æŸ¥è¯¢å‚æ•°æ–¹å¼**
```java
// åœºæ™¯ï¼šæ‰¹é‡åˆ é™¤ï¼ˆé€šè¿‡æŸ¥è¯¢æ¡ä»¶ï¼‰
String url = "http://user-service/users?status=inactive";
restTemplate.delete(url);

// å®é™…åº”ç”¨ï¼š
// åˆ é™¤æ‰€æœ‰çŠ¶æ€ä¸ºinactiveçš„ç”¨æˆ·
```

### 6.3 DELETEè¯·æ±‚çš„è¿”å›å€¼å¤„ç†


**âš ï¸ ä¸ºä»€ä¹ˆDELETEæ²¡æœ‰è¿”å›å€¼**
```
è®¾è®¡ç†å¿µï¼š
DELETEæˆåŠŸ â†’ èµ„æºä¸å­˜åœ¨äº† â†’ æ— éœ€è¿”å›
DELETEå¤±è´¥ â†’ æŠ›å¼‚å¸¸ â†’ é€šè¿‡å¼‚å¸¸å¤„ç†

å¦‚ä½•åˆ¤æ–­æˆåŠŸï¼š
try {
    restTemplate.delete(url);
    // æ‰§è¡Œåˆ°è¿™é‡Œ = åˆ é™¤æˆåŠŸ
} catch (Exception e) {
    // æ•è·åˆ°å¼‚å¸¸ = åˆ é™¤å¤±è´¥
}
```

**ğŸ’¡ éœ€è¦è¿”å›å€¼æ€ä¹ˆåŠ**
```java
// æŸäº›APIåˆ é™¤åä¼šè¿”å›è¢«åˆ é™¤çš„æ•°æ®
// ä½¿ç”¨exchangeæ–¹æ³•
ResponseEntity<User> response = restTemplate.exchange(
    url,
    HttpMethod.DELETE,
    null,
    User.class
);

User deletedUser = response.getBody();
```

---

## 7. ğŸ”€ exchangeé€šç”¨æ–¹æ³•


### 7.1 exchangeæ–¹æ³•çš„å¼ºå¤§ä¹‹å¤„


**ğŸ”¸ ä¸ºä»€ä¹ˆéœ€è¦exchange**
```
å‰é¢çš„æ–¹æ³•é™åˆ¶ï¼š
getForObject   â†’ åªèƒ½GETï¼Œåªè¿”å›æ•°æ®
postForObject  â†’ åªèƒ½POSTï¼Œåªè¿”å›æ•°æ®
put            â†’ åªèƒ½PUTï¼Œæ— è¿”å›å€¼
delete         â†’ åªèƒ½DELETEï¼Œæ— è¿”å›å€¼

exchangeçš„ä¼˜åŠ¿ï¼š
âœ… æ”¯æŒæ‰€æœ‰HTTPæ–¹æ³•ï¼ˆGET/POST/PUT/DELETE/PATCHç­‰ï¼‰
âœ… å¯ä»¥è‡ªå®šä¹‰è¯·æ±‚å¤´
âœ… è¿”å›å®Œæ•´çš„ResponseEntityï¼ˆçŠ¶æ€ç +å¤´+æ•°æ®ï¼‰
âœ… çµæ´»æ€§æœ€å¼º
```

**ğŸ’¡ é€šä¿—ç†è§£**
```
getForObjectç­‰æ–¹æ³• = å¿«é¤åº—
â†’ èœå•å›ºå®šï¼Œå¿«é€Ÿç®€å•

exchangeæ–¹æ³• = å®šåˆ¶é¤å…
â†’ ä½ è¯´æ€ä¹ˆåšå°±æ€ä¹ˆåšï¼ŒåŠŸèƒ½å…¨é¢
```

### 7.2 exchangeæ–¹æ³•è¯­æ³•


**ğŸŸ¢ åŸºç¡€è¯­æ³•ç»“æ„**
```java
ResponseEntity<è¿”å›ç±»å‹> response = restTemplate.exchange(
    "urlåœ°å€",              // å‚æ•°1ï¼šè¯·æ±‚URL
    HttpMethod.GET,        // å‚æ•°2ï¼šHTTPæ–¹æ³•
    è¯·æ±‚å®ä½“,               // å‚æ•°3ï¼šHttpEntityï¼ˆè¯·æ±‚å¤´+è¯·æ±‚ä½“ï¼‰
    è¿”å›ç±»å‹.class         // å‚æ•°4ï¼šå“åº”æ•°æ®ç±»å‹
);
```

**ğŸ“Š å‚æ•°è¯¦è§£**
```
å‚æ•°1 - URLï¼š
ç¤ºä¾‹ï¼š"http://user-service/user/1"

å‚æ•°2 - HTTPæ–¹æ³•ï¼š
HttpMethod.GET      æŸ¥è¯¢
HttpMethod.POST     åˆ›å»º
HttpMethod.PUT      æ›´æ–°
HttpMethod.DELETE   åˆ é™¤
HttpMethod.PATCH    éƒ¨åˆ†æ›´æ–°

å‚æ•°3 - è¯·æ±‚å®ä½“ï¼š
null               â†’ æ— è¯·æ±‚å¤´å’Œè¯·æ±‚ä½“ï¼ˆGET/DELETEå¸¸ç”¨ï¼‰
new HttpEntity<>(data)  â†’ åªæœ‰è¯·æ±‚ä½“
new HttpEntity<>(data, headers) â†’ è¯·æ±‚ä½“+è¯·æ±‚å¤´

å‚æ•°4 - è¿”å›ç±»å‹ï¼š
User.class         â†’ å•ä¸ªå¯¹è±¡
String.class       â†’ å­—ç¬¦ä¸²
List.class         â†’ åˆ—è¡¨ï¼ˆéœ€è¦é…åˆParameterizedTypeReferenceï¼‰
```

### 7.3 exchangeå®é™…åº”ç”¨åœºæ™¯


**ğŸ”§ åœºæ™¯1ï¼šGETè¯·æ±‚è·å–å®Œæ•´å“åº”**
```java
// éœ€æ±‚ï¼šä¸ä»…è¦æ•°æ®ï¼Œè¿˜è¦çŠ¶æ€ç å’Œå“åº”å¤´
ResponseEntity<User> response = restTemplate.exchange(
    "http://user-service/user/1",
    HttpMethod.GET,
    null,  // GETè¯·æ±‚é€šå¸¸ä¸éœ€è¦è¯·æ±‚ä½“
    User.class
);

// è·å–å“åº”çš„å„ä¸ªéƒ¨åˆ†
User user = response.getBody();           // å“åº”æ•°æ®
HttpStatus status = response.getStatusCode();  // çŠ¶æ€ç ï¼š200
HttpHeaders headers = response.getHeaders();   // å“åº”å¤´
```

**ğŸ”§ åœºæ™¯2ï¼šPOSTè¯·æ±‚å¸¦è‡ªå®šä¹‰è¯·æ±‚å¤´**
```java
// éœ€æ±‚ï¼šæäº¤æ•°æ®æ—¶éœ€è¦ä¼ Token
HttpHeaders headers = new HttpHeaders();
headers.set("Authorization", "Bearer token123");
headers.setContentType(MediaType.APPLICATION_JSON);

User user = new User("å¼ ä¸‰", 25);
HttpEntity<User> request = new HttpEntity<>(user, headers);

ResponseEntity<User> response = restTemplate.exchange(
    "http://user-service/user",
    HttpMethod.POST,
    request,
    User.class
);
```

**ğŸ”§ åœºæ™¯3ï¼šPATCHéƒ¨åˆ†æ›´æ–°**
```java
// éœ€æ±‚ï¼šåªæ›´æ–°ç”¨æˆ·çš„emailå­—æ®µ
Map<String, String> updates = new HashMap<>();
updates.put("email", "newemail@example.com");

HttpEntity<Map<String, String>> request = new HttpEntity<>(updates);

ResponseEntity<User> response = restTemplate.exchange(
    "http://user-service/user/1",
    HttpMethod.PATCH,  // éƒ¨åˆ†æ›´æ–°ç”¨PATCH
    request,
    User.class
);

User updatedUser = response.getBody();
```

### 7.4 exchangeä¸ä¸“ç”¨æ–¹æ³•çš„é€‰æ‹©


**âš–ï¸ å¦‚ä½•é€‰æ‹©åˆé€‚çš„æ–¹æ³•**
```
ç®€å•åœºæ™¯ â†’ ç”¨ä¸“ç”¨æ–¹æ³•ï¼š
getForObject()  â†’ ç®€å•GETï¼Œåªè¦æ•°æ®
postForObject() â†’ ç®€å•POSTï¼Œåªè¦æ•°æ®

å¤æ‚åœºæ™¯ â†’ ç”¨exchangeï¼š
âœ… éœ€è¦è‡ªå®šä¹‰è¯·æ±‚å¤´
âœ… éœ€è¦è·å–çŠ¶æ€ç å’Œå“åº”å¤´
âœ… ä½¿ç”¨PATCHã€OPTIONSç­‰ç‰¹æ®Šæ–¹æ³•
âœ… éœ€è¦æ›´çµæ´»çš„æ§åˆ¶
```

**ğŸ“‹ æ–¹æ³•å¯¹æ¯”è¡¨**

| æ–¹æ³• | è¿”å›å†…å®¹ | é€‚ç”¨åœºæ™¯ | çµæ´»æ€§ |
|------|---------|---------|--------|
| `getForObject` | åªæœ‰æ•°æ® | ç®€å•GETæŸ¥è¯¢ | ä½ |
| `postForObject` | åªæœ‰æ•°æ® | ç®€å•POSTæäº¤ | ä½ |
| `put` | æ— è¿”å› | ç®€å•PUTæ›´æ–° | ä½ |
| `delete` | æ— è¿”å› | ç®€å•DELETEåˆ é™¤ | ä½ |
| **`exchange`** | **å®Œæ•´å“åº”** | **æ‰€æœ‰å¤æ‚åœºæ™¯** | **é«˜** |

---

## 8. ğŸ” getForObjectä¸getForEntityåŒºåˆ«


### 8.1 ä¸¤ä¸ªæ–¹æ³•çš„æ ¸å¿ƒåŒºåˆ«


**ğŸ”¸ è¿”å›å€¼çš„ä¸åŒ**
```
getForObjectï¼š
User user = restTemplate.getForObject(url, User.class);
â†’ ç›´æ¥è¿”å›æ•°æ®å¯¹è±¡

getForEntityï¼š
ResponseEntity<User> response = restTemplate.getForEntity(url, User.class);
User user = response.getBody();
â†’ è¿”å›å®Œæ•´å“åº”ï¼ˆåŒ…å«çŠ¶æ€ç ã€å¤´ã€æ•°æ®ï¼‰
```

**ğŸ’¡ ç±»æ¯”ç†è§£**
```
getForObject = ç½‘è´­æ”¶è´§
ä½ ï¼šæˆ‘è¦çš„ä¸œè¥¿å‘¢ï¼Ÿ
å¿«é€’å‘˜ï¼šç»™ä½ ï¼ˆç›´æ¥æ‰”ç»™ä½ è´§ç‰©ï¼‰

getForEntity = ç½‘è´­æ”¶è´§ï¼ˆæ­£è§„ç‰ˆï¼‰
ä½ ï¼šæˆ‘è¦çš„ä¸œè¥¿å‘¢ï¼Ÿ
å¿«é€’å‘˜ï¼šç»™ä½ ï¼ˆé€’ç»™ä½ åŒ…è£¹ï¼Œä¸Šé¢æœ‰å•å·ã€å‘è´§ä¿¡æ¯ã€è´§ç‰©ï¼‰
```

### 8.2 getForEntityçš„åº”ç”¨åœºæ™¯


**ğŸ”§ åœºæ™¯1ï¼šéœ€è¦åˆ¤æ–­HTTPçŠ¶æ€ç **
```java
ResponseEntity<User> response = restTemplate.getForEntity(
    "http://user-service/user/1",
    User.class
);

// æ ¹æ®çŠ¶æ€ç åšä¸åŒå¤„ç†
if (response.getStatusCode() == HttpStatus.OK) {
    User user = response.getBody();
    // å¤„ç†æ­£å¸¸è¿”å›çš„ç”¨æˆ·
} else if (response.getStatusCode() == HttpStatus.NOT_FOUND) {
    // ç”¨æˆ·ä¸å­˜åœ¨çš„å¤„ç†
}
```

**ğŸ”§ åœºæ™¯2ï¼šéœ€è¦è·å–å“åº”å¤´ä¿¡æ¯**
```java
ResponseEntity<byte[]> response = restTemplate.getForEntity(
    "http://file-service/download/1",
    byte[].class
);

// ä»å“åº”å¤´è·å–æ–‡ä»¶ä¿¡æ¯
HttpHeaders headers = response.getHeaders();
String fileName = headers.getFirst("Content-Disposition");
String contentType = headers.getContentType().toString();

// ä¿å­˜æ–‡ä»¶
byte[] fileData = response.getBody();
```

**ğŸ”§ åœºæ™¯3ï¼šéœ€è¦å®Œæ•´çš„å“åº”ä¿¡æ¯åšæ—¥å¿—**
```java
ResponseEntity<User> response = restTemplate.getForEntity(url, User.class);

// è®°å½•å®Œæ•´çš„å“åº”ä¿¡æ¯
log.info("è¯·æ±‚URL: {}", url);
log.info("å“åº”çŠ¶æ€: {}", response.getStatusCode());
log.info("å“åº”å¤´: {}", response.getHeaders());
log.info("å“åº”æ•°æ®: {}", response.getBody());
```

### 8.3 å¯¹æ¯”æ€»ç»“


**ğŸ“Š ä½¿ç”¨åœºæ™¯å¯¹æ¯”**

| æ–¹æ³• | è¿”å›å†…å®¹ | ä½•æ—¶ä½¿ç”¨ | ç¤ºä¾‹åœºæ™¯ |
|------|---------|---------|---------|
| `getForObject` | åªæœ‰æ•°æ® | åªå…³å¿ƒæ•°æ®æœ¬èº« | è·å–ç”¨æˆ·ä¿¡æ¯å±•ç¤º |
| `getForEntity` | çŠ¶æ€ç +å¤´+æ•°æ® | éœ€è¦å“åº”çš„å…¶ä»–ä¿¡æ¯ | æ–‡ä»¶ä¸‹è½½ã€é”™è¯¯å¤„ç† |

**ğŸ¯ é€‰æ‹©å»ºè®®**
```
å¤§éƒ¨åˆ†æƒ…å†µï¼šç”¨getForObject
â†’ ä»£ç ç®€æ´ï¼Œç›´æ¥æ‹¿åˆ°æ•°æ®

ç‰¹æ®Šæƒ…å†µï¼šç”¨getForEntity
â†’ éœ€è¦çŠ¶æ€ç åˆ¤æ–­
â†’ éœ€è¦å“åº”å¤´ä¿¡æ¯
â†’ éœ€è¦è®°å½•å®Œæ•´å“åº”æ—¥å¿—
```

---

## 9. ğŸ“¦ ResponseEntityå“åº”å°è£…


### 9.1 ResponseEntityæ˜¯ä»€ä¹ˆ


**ğŸ”¸ æ ¸å¿ƒæ¦‚å¿µ**
```
ResponseEntity = HTTPå“åº”çš„å®Œæ•´å°è£…

åŒ…å«ä¸‰éƒ¨åˆ†ï¼š
1. çŠ¶æ€ç ï¼ˆStatus Codeï¼‰ï¼š200ã€404ã€500ç­‰
2. å“åº”å¤´ï¼ˆHeadersï¼‰ï¼šContent-Typeã€è‡ªå®šä¹‰å¤´ç­‰
3. å“åº”ä½“ï¼ˆBodyï¼‰ï¼šå®é™…çš„æ•°æ®

å°±åƒå¿«é€’åŒ…è£¹ï¼š
çŠ¶æ€ç  = ç‰©æµçŠ¶æ€ï¼ˆå·²ç­¾æ”¶ã€è¿è¾“ä¸­ï¼‰
å“åº”å¤´ = åŒ…è£¹ä¿¡æ¯ï¼ˆå‘ä»¶äººã€æ”¶ä»¶äººï¼‰
å“åº”ä½“ = é‡Œé¢çš„ä¸œè¥¿ï¼ˆå®é™…å•†å“ï¼‰
```

**ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦ResponseEntity**
```
åªç”¨æ•°æ®çš„é—®é¢˜ï¼š
User user = getData();
â†’ ä¸çŸ¥é“è¯·æ±‚æ˜¯å¦çœŸçš„æˆåŠŸ
â†’ ä¸çŸ¥é“æ˜¯200è¿˜æ˜¯304ï¼ˆç¼“å­˜ï¼‰
â†’ ç¼ºå°‘ä¸Šä¸‹æ–‡ä¿¡æ¯

ç”¨ResponseEntityï¼š
ResponseEntity<User> response = getData();
â†’ çŠ¶æ€ç 200ï¼šç¡®è®¤æˆåŠŸ
â†’ å¯ä»¥è·å–ç¼“å­˜ä¿¡æ¯
â†’ å®Œæ•´çš„HTTPå“åº”ä¸Šä¸‹æ–‡
```

### 9.2 ResponseEntityçš„ç»„æˆéƒ¨åˆ†


**ğŸ” ä¸‰å¤§æ ¸å¿ƒå±æ€§**

**å±æ€§1ï¼šçŠ¶æ€ç ï¼ˆStatus Codeï¼‰**
```java
ResponseEntity<User> response = restTemplate.getForEntity(url, User.class);

// è·å–çŠ¶æ€ç å¯¹è±¡
HttpStatus status = response.getStatusCode();

// è·å–çŠ¶æ€ç æ•°å€¼
int statusCode = response.getStatusCodeValue();

// å¸¸è§çŠ¶æ€ç ï¼š
// 2xxï¼šæˆåŠŸ
//   200 OK - è¯·æ±‚æˆåŠŸ
//   201 Created - åˆ›å»ºæˆåŠŸ
// 4xxï¼šå®¢æˆ·ç«¯é”™è¯¯  
//   400 Bad Request - è¯·æ±‚å‚æ•°é”™è¯¯
//   401 Unauthorized - æœªè®¤è¯
//   404 Not Found - èµ„æºä¸å­˜åœ¨
// 5xxï¼šæœåŠ¡å™¨é”™è¯¯
//   500 Internal Server Error - æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
//   503 Service Unavailable - æœåŠ¡ä¸å¯ç”¨
```

**å±æ€§2ï¼šå“åº”å¤´ï¼ˆHeadersï¼‰**
```java
// è·å–æ‰€æœ‰å“åº”å¤´
HttpHeaders headers = response.getHeaders();

// è·å–ç‰¹å®šå“åº”å¤´
String contentType = headers.getFirst("Content-Type");
String token = headers.getFirst("Authorization");
List<String> cookies = headers.get("Set-Cookie");

// å¸¸è§å“åº”å¤´ï¼š
// Content-Typeï¼šå“åº”æ•°æ®æ ¼å¼
// Content-Lengthï¼šå“åº”æ•°æ®å¤§å°
// Set-Cookieï¼šè®¾ç½®Cookie
// Locationï¼šé‡å®šå‘åœ°å€
```

**å±æ€§3ï¼šå“åº”ä½“ï¼ˆBodyï¼‰**
```java
// è·å–å“åº”æ•°æ®
User user = response.getBody();

// åˆ¤æ–­å“åº”ä½“æ˜¯å¦å­˜åœ¨
if (response.hasBody()) {
    User user = response.getBody();
}
```

### 9.3 ResponseEntityçš„å®é™…åº”ç”¨


**ğŸ”§ åº”ç”¨1ï¼šç»Ÿä¸€å“åº”å¤„ç†**
```java
public User getUserById(Long id) {
    String url = "http://user-service/user/" + id;
    ResponseEntity<User> response = restTemplate.getForEntity(url, User.class);
    
    // æ ¹æ®çŠ¶æ€ç åšä¸åŒå¤„ç†
    if (response.getStatusCode() == HttpStatus.OK) {
        return response.getBody();  // æ­£å¸¸è¿”å›
    } else if (response.getStatusCode() == HttpStatus.NOT_FOUND) {
        throw new UserNotFoundException("ç”¨æˆ·ä¸å­˜åœ¨");
    } else {
        throw new RuntimeException("è·å–ç”¨æˆ·å¤±è´¥");
    }
}
```

**ğŸ”§ åº”ç”¨2ï¼šå¤„ç†æ–‡ä»¶ä¸‹è½½**
```java
public void downloadFile(String fileId) {
    String url = "http://file-service/download/" + fileId;
    ResponseEntity<byte[]> response = restTemplate.getForEntity(url, byte[].class);
    
    // ä»å“åº”å¤´è·å–æ–‡ä»¶å
    String disposition = response.getHeaders().getFirst("Content-Disposition");
    String fileName = extractFileName(disposition);
    
    // è·å–æ–‡ä»¶æ•°æ®
    byte[] fileData = response.getBody();
    
    // ä¿å­˜æ–‡ä»¶
    Files.write(Paths.get(fileName), fileData);
}
```

**ğŸ”§ åº”ç”¨3ï¼šå¤„ç†é‡å®šå‘**
```java
ResponseEntity<String> response = restTemplate.getForEntity(url, String.class);

// æ£€æŸ¥æ˜¯å¦é‡å®šå‘ï¼ˆ3xxçŠ¶æ€ç ï¼‰
if (response.getStatusCode().is3xxRedirection()) {
    String redirectUrl = response.getHeaders().getFirst("Location");
    // å¤„ç†é‡å®šå‘é€»è¾‘
}
```

### 9.4 ResponseEntity vs ç›´æ¥è¿”å›æ•°æ®


**âš–ï¸ é€‰æ‹©æŒ‡å—**

```
ä½¿ç”¨ResponseEntityçš„åœºæ™¯ï¼š
âœ… éœ€è¦åˆ¤æ–­HTTPçŠ¶æ€ç 
âœ… éœ€è¦è·å–å“åº”å¤´ä¿¡æ¯
âœ… éœ€è¦å®Œæ•´çš„å“åº”ä¸Šä¸‹æ–‡
âœ… åšç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†

ç›´æ¥è¿”å›æ•°æ®çš„åœºæ™¯ï¼š
âœ… ç®€å•çš„æ•°æ®è·å–
âœ… ç¡®å®šè¯·æ±‚ä¸€å®šæˆåŠŸ
âœ… ä¸éœ€è¦å“åº”çš„å…¶ä»–ä¿¡æ¯
```

**ğŸ“‹ ä»£ç é£æ ¼å¯¹æ¯”**
```java
// ç®€æ´é£æ ¼ï¼ˆåªè¦æ•°æ®ï¼‰
User user = restTemplate.getForObject(url, User.class);

// å®Œæ•´é£æ ¼ï¼ˆéœ€è¦å“åº”ä¿¡æ¯ï¼‰
ResponseEntity<User> response = restTemplate.getForEntity(url, User.class);
HttpStatus status = response.getStatusCode();
User user = response.getBody();
```

---

## 10. ğŸ”— URIæ¨¡æ¿å‚æ•°ä¼ é€’


### 10.1 URIå‚æ•°çš„ä¸¤ç§å½¢å¼


**ğŸ”¸ å½¢å¼å¯¹æ¯”**
```
è·¯å¾„å‚æ•°ï¼ˆPath Variableï¼‰ï¼š
http://api.com/users/123/orders/456
                  â†‘           â†‘
                userId     orderId
â†’ å‚æ•°æ˜¯URLè·¯å¾„çš„ä¸€éƒ¨åˆ†
â†’ é€šå¸¸è¡¨ç¤ºèµ„æºID

æŸ¥è¯¢å‚æ•°ï¼ˆQuery Parameterï¼‰ï¼š
http://api.com/users?age=20&city=beijing
                     â†‘
                 æŸ¥è¯¢æ¡ä»¶
â†’ å‚æ•°åœ¨?åé¢ï¼Œç”¨&è¿æ¥
â†’ é€šå¸¸è¡¨ç¤ºè¿‡æ»¤æ¡ä»¶ã€åˆ†é¡µç­‰
```

**ğŸ’¡ ä½•æ—¶ç”¨å“ªç§å‚æ•°**
```
è·¯å¾„å‚æ•°ï¼š
âœ… æ ‡è¯†èµ„æºï¼š/users/1
âœ… å±‚çº§å…³ç³»ï¼š/users/1/orders/2
âœ… RESTfulé£æ ¼

æŸ¥è¯¢å‚æ•°ï¼š
âœ… è¿‡æ»¤æ¡ä»¶ï¼š?status=active
âœ… åˆ†é¡µæ’åºï¼š?page=1&size=10&sort=name
âœ… å¯é€‰å‚æ•°ï¼š?keyword=xxx
```

### 10.2 è·¯å¾„å‚æ•°ä¼ é€’æ–¹å¼


**ğŸŸ¢ æ–¹å¼1ï¼šæŒ‰é¡ºåºä¼ é€’**
```java
// å•ä¸ªå‚æ•°
String url = "http://user-service/user/{id}";
User user = restTemplate.getForObject(url, User.class, 1);
//                                                      â†‘
//                                                  æŒ‰é¡ºåºä¼ å…¥

// å¤šä¸ªå‚æ•°
String url = "http://user-service/user/{userId}/order/{orderId}";
Order order = restTemplate.getForObject(url, Order.class, 1, 100);
//                                                        â†‘   â†‘
//                                                    userId orderId
```

**ğŸŸ¡ æ–¹å¼2ï¼šä½¿ç”¨Mapä¼ é€’ï¼ˆæ¨èï¼‰**
```java
String url = "http://user-service/user/{userId}/order/{orderId}";

Map<String, Object> params = new HashMap<>();
params.put("userId", 1);
params.put("orderId", 100);

Order order = restTemplate.getForObject(url, Order.class, params);

// ä¼˜åŠ¿ï¼š
// âœ… å‚æ•°åæ¸…æ™°ï¼Œä¸ä¼šææ··é¡ºåº
// âœ… å¯ä»¥åŠ¨æ€æ·»åŠ å‚æ•°
// âœ… ä»£ç å¯è¯»æ€§å¼º
```

**âš ï¸ è·¯å¾„å‚æ•°æ³¨æ„äº‹é¡¹**
```
å‚æ•°åè¦åŒ¹é…ï¼š
URLä¸­æ˜¯{userId}ï¼ŒMapçš„keyå¿…é¡»æ˜¯"userId"

ç‰¹æ®Šå­—ç¬¦å¤„ç†ï¼š
å«æœ‰ç‰¹æ®Šå­—ç¬¦çš„å‚æ•°ä¼šè‡ªåŠ¨ç¼–ç 
"å¼ ä¸‰" â†’ "%E5%BC%A0%E4%B8%89"
```

### 10.3 æŸ¥è¯¢å‚æ•°ä¼ é€’æ–¹å¼


**ğŸ”§ æ–¹å¼1ï¼šæ‰‹åŠ¨æ‹¼æ¥ï¼ˆä¸æ¨èï¼‰**
```java
String url = "http://user-service/users?age=20&city=beijing";
List<User> users = restTemplate.getForObject(url, List.class);

// é—®é¢˜ï¼š
// âŒ ä¸­æ–‡éœ€è¦æ‰‹åŠ¨ç¼–ç 
// âŒ ç‰¹æ®Šå­—ç¬¦å®¹æ˜“å‡ºé”™
// âŒ å‚æ•°å¤šäº†å¾ˆä¹±
```

**ğŸ”§ æ–¹å¼2ï¼šUriComponentsBuilderï¼ˆæ¨èï¼‰**
```java
String baseUrl = "http://user-service/users";

// æ„å»ºURI
UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(baseUrl)
    .queryParam("age", 20)
    .queryParam("city", "beijing")
    .queryParam("status", "active");

String url = builder.toUriString();
// ç»“æœï¼šhttp://user-service/users?age=20&city=beijing&status=active

List<User> users = restTemplate.getForObject(url, List.class);
```

**ğŸ’¡ UriComponentsBuilderçš„ä¼˜åŠ¿**
```
è‡ªåŠ¨ç¼–ç ï¼š
.queryParam("city", "åŒ—äº¬")
â†’ ?city=%E5%8C%97%E4%BA%AC

åŠ¨æ€å‚æ•°ï¼š
if (status != null) {
    builder.queryParam("status", status);
}

å‚æ•°æ¸…æ™°ï¼š
é“¾å¼è°ƒç”¨ï¼Œæ¯ä¸ªå‚æ•°ç‹¬ç«‹ä¸€è¡Œ
```

### 10.4 æ··åˆå‚æ•°åœºæ™¯


**ğŸ”§ è·¯å¾„å‚æ•°+æŸ¥è¯¢å‚æ•°**
```java
// åœºæ™¯ï¼šè·å–æŒ‡å®šç”¨æˆ·çš„è®¢å•åˆ—è¡¨ï¼Œå¸¦åˆ†é¡µ
String url = "http://order-service/user/{userId}/orders";

Map<String, Object> pathParams = new HashMap<>();
pathParams.put("userId", 1);

UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(url)
    .queryParam("page", 1)
    .queryParam("size", 10)
    .queryParam("status", "paid");

// æ–¹å¼1ï¼šå…ˆæ„å»ºURLï¼Œå†æ›¿æ¢è·¯å¾„å‚æ•°
String finalUrl = builder.buildAndExpand(pathParams).toUriString();

// æ–¹å¼2ï¼šä½¿ç”¨RestTemplateçš„expandæ–¹æ³•
URI uri = builder.build().expand(pathParams).toUri();
List<Order> orders = restTemplate.getForObject(uri, List.class);
```

**ğŸ“Š å‚æ•°ä¼ é€’æµç¨‹**
```
æ„å»ºè¿‡ç¨‹ï¼š
1. åŸºç¡€URLï¼šhttp://order-service/user/{userId}/orders
2. æ›¿æ¢è·¯å¾„å‚æ•°ï¼šhttp://order-service/user/1/orders
3. æ·»åŠ æŸ¥è¯¢å‚æ•°ï¼šhttp://order-service/user/1/orders?page=1&size=10

æœ€ç»ˆURLï¼š
http://order-service/user/1/orders?page=1&size=10&status=paid
```

### 10.5 å‚æ•°ä¼ é€’æœ€ä½³å®è·µ


**ğŸ¯ å®ç”¨å»ºè®®**

```
âœ… è·¯å¾„å‚æ•°ç”¨Mapï¼š
Map<String, Object> params = new HashMap<>();
params.put("id", userId);
â†’ æ¸…æ™°ï¼Œä¸ä¼šææ··é¡ºåº

âœ… æŸ¥è¯¢å‚æ•°ç”¨UriComponentsBuilderï¼š
UriComponentsBuilder.fromHttpUrl(baseUrl)
    .queryParam("key", "value")
â†’ è‡ªåŠ¨ç¼–ç ï¼Œé˜²æ­¢ç‰¹æ®Šå­—ç¬¦é—®é¢˜

âœ… å¤æ‚å‚æ•°å°è£…æˆå¯¹è±¡ï¼š
class QueryParams {
    private Integer page;
    private Integer size;
    private String keyword;
    // getters and setters
}
```

**âš ï¸ å¸¸è§é™·é˜±**
```
é™·é˜±1ï¼šå‚æ•°åæ‹¼å†™é”™è¯¯
URL: /user/{userId}
Map: params.put("userid", 1)  âŒ å¤§å°å†™ä¸ä¸€è‡´
Map: params.put("userId", 1)  âœ… ä¸¥æ ¼åŒ¹é…

é™·é˜±2ï¼šä¸­æ–‡å‚æ•°ä¸ç¼–ç 
url = baseUrl + "?name=å¼ ä¸‰"  âŒ å¯èƒ½ä¹±ç 
ä½¿ç”¨UriComponentsBuilder  âœ… è‡ªåŠ¨ç¼–ç 

é™·é˜±3ï¼šç‰¹æ®Šå­—ç¬¦æœªå¤„ç†
"?keyword=C++"  âŒ +å·ä¼šè¢«è§£æä¸ºç©ºæ ¼
"?keyword=C%2B%2B"  âœ… æ­£ç¡®ç¼–ç 
```

---

## 11. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 11.1 RestTemplateæ–¹æ³•é€ŸæŸ¥


**ğŸ”– æ ¸å¿ƒæ–¹æ³•å¯¹ç…§è¡¨**

| æ–¹æ³• | ç”¨é€” | è¿”å›å€¼ | é€‚ç”¨åœºæ™¯ |
|------|------|--------|---------|
| `getForObject` | GETæŸ¥è¯¢ | æ•°æ®å¯¹è±¡ | ç®€å•æŸ¥è¯¢ï¼Œåªè¦æ•°æ® |
| `getForEntity` | GETæŸ¥è¯¢ | å®Œæ•´å“åº” | éœ€è¦çŠ¶æ€ç ã€å“åº”å¤´ |
| `postForObject` | POSTæäº¤ | æ•°æ®å¯¹è±¡ | ç®€å•æäº¤ï¼Œåªè¦ç»“æœ |
| `postForEntity` | POSTæäº¤ | å®Œæ•´å“åº” | éœ€è¦å®Œæ•´å“åº”ä¿¡æ¯ |
| `put` | PUTæ›´æ–° | æ—  | ç®€å•å…¨é‡æ›´æ–° |
| `delete` | DELETEåˆ é™¤ | æ—  | ç®€å•åˆ é™¤æ“ä½œ |
| `exchange` | é€šç”¨æ–¹æ³• | å®Œæ•´å“åº” | å¤æ‚åœºæ™¯ï¼Œçµæ´»æ§åˆ¶ |

### 11.2 å…³é”®æ¦‚å¿µç†è§£


**ğŸ§  æ ¸å¿ƒçŸ¥è¯†ç‚¹**

```
1. RestTemplate = HTTPå®¢æˆ·ç«¯
   ä½œç”¨ï¼šåœ¨å¾®æœåŠ¡ä¸­è°ƒç”¨å…¶ä»–æœåŠ¡çš„HTTPæ¥å£
   æœ¬è´¨ï¼šå°è£…äº†HTTPè¯·æ±‚å‘é€å’Œå“åº”æ¥æ”¶

2. è¯·æ±‚çš„ä¸‰è¦ç´ ï¼š
   URLï¼šè¯·æ±‚åœ°å€ï¼ˆå«è·¯å¾„å‚æ•°ã€æŸ¥è¯¢å‚æ•°ï¼‰
   Methodï¼šè¯·æ±‚æ–¹æ³•ï¼ˆGET/POST/PUT/DELETEï¼‰
   Bodyï¼šè¯·æ±‚ä½“ï¼ˆPOST/PUTéœ€è¦ï¼‰

3. å“åº”çš„ä¸‰è¦ç´ ï¼š
   Statusï¼šçŠ¶æ€ç ï¼ˆ200æˆåŠŸï¼Œ404ä¸å­˜åœ¨ï¼‰
   Headersï¼šå“åº”å¤´ï¼ˆContent-Typeã€è‡ªå®šä¹‰å¤´ï¼‰
   Bodyï¼šå“åº”ä½“ï¼ˆå®é™…æ•°æ®ï¼‰

4. å‚æ•°ä¼ é€’ï¼š
   è·¯å¾„å‚æ•°ï¼š/users/{id} - æ ‡è¯†èµ„æº
   æŸ¥è¯¢å‚æ•°ï¼š?age=20 - è¿‡æ»¤æ¡ä»¶
```

### 11.3 æ–¹æ³•é€‰æ‹©å†³ç­–æ ‘


**ğŸŒ³ å¦‚ä½•é€‰æ‹©åˆé€‚çš„æ–¹æ³•**

```
å¼€å§‹ï¼šæˆ‘è¦å‘HTTPè¯·æ±‚

                 â†“
           
       æ˜¯å¦éœ€è¦è‡ªå®šä¹‰è¯·æ±‚å¤´ï¼Ÿ
       
    Yes â†™              â†˜ No
       
ä½¿ç”¨exchange      ä»€ä¹ˆHTTPæ–¹æ³•ï¼Ÿ
    
                 GET â†’ æ˜¯å¦éœ€è¦çŠ¶æ€ç /å“åº”å¤´ï¼Ÿ
                       Yes â†’ getForEntity
                       No  â†’ getForObject
                       
                 POST â†’ æ˜¯å¦éœ€è¦å®Œæ•´å“åº”ï¼Ÿ
                        Yes â†’ postForEntity/exchange
                        No  â†’ postForObject
                        
                 PUT â†’ ä½¿ç”¨putï¼ˆæ— è¿”å›å€¼ï¼‰
                       éœ€è¦è¿”å›å€¼ç”¨exchange
                       
                 DELETE â†’ ä½¿ç”¨deleteï¼ˆæ— è¿”å›å€¼ï¼‰
                          éœ€è¦è¿”å›å€¼ç”¨exchange
```

### 11.4 æœ€ä½³å®è·µå»ºè®®


**âœ… æ¨èåšæ³•**

```
1. ç»Ÿä¸€åˆ›å»ºRestTemplateï¼š
   @Configurationé…ç½®ç±»åˆ›å»ºBean
   â†’ å…¨å±€ç»Ÿä¸€é…ç½®è¶…æ—¶æ—¶é—´
   â†’ ä¾èµ–æ³¨å…¥å¤ç”¨

2. å‚æ•°ä¼ é€’è§„èŒƒï¼š
   è·¯å¾„å‚æ•°ç”¨Mapä¼ é€’
   æŸ¥è¯¢å‚æ•°ç”¨UriComponentsBuilder
   â†’ ä»£ç æ¸…æ™°ï¼Œé¿å…é”™è¯¯

3. å¼‚å¸¸å¤„ç†ï¼š
   try-catchæ•è·RestClientException
   æ ¹æ®çŠ¶æ€ç åšä¸šåŠ¡å¤„ç†
   â†’ æé«˜ç³»ç»Ÿå¥å£®æ€§

4. å“åº”å¤„ç†ï¼š
   ç®€å•åœºæ™¯ç”¨ForObject
   å¤æ‚åœºæ™¯ç”¨ForEntityæˆ–exchange
   â†’ æŒ‰éœ€é€‰æ‹©ï¼Œæé«˜æ•ˆç‡
```

**âŒ é¿å…çš„é”™è¯¯**

```
1. ä¸è¦æ¯æ¬¡new RestTemplate
   â†’ æµªè´¹èµ„æºï¼Œé…ç½®ä¸ç»Ÿä¸€

2. ä¸è¦æ‰‹åŠ¨æ‹¼æ¥URL
   String url = baseUrl + "?name=" + name;  âŒ
   ä½¿ç”¨UriComponentsBuilder  âœ…
   â†’ é˜²æ­¢ç¼–ç é—®é¢˜

3. ä¸è¦å¿½ç•¥å¼‚å¸¸å¤„ç†
   â†’ HTTPè°ƒç”¨å¯èƒ½å¤±è´¥ï¼Œå¿…é¡»å¤„ç†å¼‚å¸¸

4. ä¸è¦æ»¥ç”¨exchange
   ç®€å•åœºæ™¯ç”¨ä¸“ç”¨æ–¹æ³•æ›´æ¸…æ™°
   â†’ exchangeç•™ç»™å¤æ‚åœºæ™¯
```

### 11.5 å­¦ä¹ è¦ç‚¹å›é¡¾


**ğŸ¯ æ ¸å¿ƒè®°å¿†ç‚¹**

```
ğŸ“Œ RestTemplate = å¾®æœåŠ¡é—´HTTPé€šä¿¡å·¥å…·

ğŸ“Œ åˆ›å»ºæ–¹å¼ï¼š
   new RestTemplate() - ç®€å•åœºæ™¯
   @Beané…ç½®ç±» - ç”Ÿäº§ç¯å¢ƒæ¨è

ğŸ“Œ GETè¯·æ±‚ï¼š
   ForObject - åªè¦æ•°æ®
   ForEntity - è¦å®Œæ•´å“åº”

ğŸ“Œ POSTè¯·æ±‚ï¼š
   postForObject(url, data, type)
   ç¬¬äºŒä¸ªå‚æ•°æ˜¯è¯·æ±‚ä½“

ğŸ“Œ ä¸‡èƒ½æ–¹æ³•ï¼š
   exchange - æ”¯æŒæ‰€æœ‰HTTPæ–¹æ³•
   è¿”å›ResponseEntityå®Œæ•´å“åº”

ğŸ“Œ å‚æ•°ä¼ é€’ï¼š
   è·¯å¾„å‚æ•°ï¼š{id} + Map
   æŸ¥è¯¢å‚æ•°ï¼šUriComponentsBuilder
```

**ğŸ”‘ è®°å¿†å£è¯€**

```
RestTemplateå‘è¯·æ±‚ï¼Œå¾®æœåŠ¡é€šä¿¡å®ƒæœ€è¡Œ
GetæŸ¥Postæäº¤ï¼ŒPutæ›´Deleteåˆ é™¤
ForObjectç›´æ¥æ‹¿ï¼ŒForEntityä¿¡æ¯å…¨
å‚æ•°è·¯å¾„ç”¨å¤§æ‹¬å·ï¼ŒæŸ¥è¯¢é—®å·åŠ å‚æ•°
exchangeä¸‡èƒ½å¼ºï¼Œå¤æ‚åœºæ™¯é å®ƒä¸Š
```

---

**ğŸ“ å­¦ä¹ å»ºè®®**

1. **åŠ¨æ‰‹å®è·µ**ï¼šè·Ÿç€ä¾‹å­æ•²ä»£ç ï¼Œç†è§£æ¯ä¸ªæ–¹æ³•
2. **å¯¹æ¯”è®°å¿†**ï¼šForObject vs ForEntityï¼Œç†è§£åŒºåˆ«
3. **åœºæ™¯åº”ç”¨**ï¼šæƒ³æƒ³å®é™…é¡¹ç›®ä¸­æ€ä¹ˆç”¨
4. **å¼‚å¸¸å¤„ç†**ï¼šè®°å¾—åŠ try-catchï¼Œæé«˜å¥å£®æ€§

ä¸‹ä¸€æ­¥å¯ä»¥å­¦ä¹ ï¼šRestTemplateçš„é«˜çº§é…ç½®ï¼ˆè¶…æ—¶ã€é‡è¯•ã€æ‹¦æˆªå™¨ï¼‰å’ŒFeignå£°æ˜å¼HTTPå®¢æˆ·ç«¯ã€‚