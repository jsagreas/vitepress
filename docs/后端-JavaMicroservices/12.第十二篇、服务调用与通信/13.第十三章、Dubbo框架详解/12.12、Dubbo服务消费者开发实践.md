---
title: 12ã€DubboæœåŠ¡æ¶ˆè´¹è€…å¼€å‘å®è·µ
---
## ğŸ“š ç›®å½•

1. [æœåŠ¡æ¶ˆè´¹è€…æ ¸å¿ƒæ¦‚å¿µ](#1-æœåŠ¡æ¶ˆè´¹è€…æ ¸å¿ƒæ¦‚å¿µ)
2. [@Referenceæ³¨è§£è¯¦è§£](#2-Referenceæ³¨è§£è¯¦è§£)
3. [æœåŠ¡å¼•ç”¨é…ç½®](#3-æœåŠ¡å¼•ç”¨é…ç½®)
4. [æ¥å£è°ƒç”¨æ–¹å¼](#4-æ¥å£è°ƒç”¨æ–¹å¼)
5. [è¶…æ—¶ä¸é‡è¯•æœºåˆ¶](#5-è¶…æ—¶ä¸é‡è¯•æœºåˆ¶)
6. [å¼‚æ­¥è°ƒç”¨å®ç°](#6-å¼‚æ­¥è°ƒç”¨å®ç°)
7. [æ³›åŒ–è°ƒç”¨åº”ç”¨](#7-æ³›åŒ–è°ƒç”¨åº”ç”¨)
8. [å›å£°æµ‹è¯•æœºåˆ¶](#8-å›å£°æµ‹è¯•æœºåˆ¶)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ æœåŠ¡æ¶ˆè´¹è€…æ ¸å¿ƒæ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯æœåŠ¡æ¶ˆè´¹è€…


**é€šä¿—ç†è§£**ï¼šæœåŠ¡æ¶ˆè´¹è€…å°±åƒæ˜¯"ç‚¹é¤çš„é¡¾å®¢"
```
ç°å®åœºæ™¯ç±»æ¯”ï¼š
é¡¾å®¢(æ¶ˆè´¹è€…) â†’ æœåŠ¡å‘˜(Dubboæ¡†æ¶) â†’ å¨æˆ¿(æä¾›è€…)
   ç‚¹é¤          ä¼ é€’éœ€æ±‚          åšèœ

Dubboåœºæ™¯ï¼š
æ¶ˆè´¹è€…åº”ç”¨ â†’ Dubboæ¡†æ¶ â†’ æä¾›è€…åº”ç”¨
  è°ƒç”¨æ¥å£      RPCé€šä¿¡      æ‰§è¡Œä¸šåŠ¡
```

**æ ¸å¿ƒå®šä¹‰**
```
æœåŠ¡æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰ï¼š
â€¢ æ˜¯ä»€ä¹ˆï¼šè°ƒç”¨è¿œç¨‹æœåŠ¡çš„åº”ç”¨ç¨‹åº
â€¢ åšä»€ä¹ˆï¼šé€šè¿‡æ¥å£è°ƒç”¨è¿œç¨‹æœåŠ¡ï¼Œè·å–ç»“æœ
â€¢ æ€ä¹ˆåšï¼šä½¿ç”¨ @Reference æ³¨è§£å¼•ç”¨è¿œç¨‹æœåŠ¡
â€¢ æœ¬è´¨ï¼šæŠŠè¿œç¨‹è°ƒç”¨å˜å¾—åƒæœ¬åœ°æ–¹æ³•è°ƒç”¨ä¸€æ ·ç®€å•
```

### 1.2 æ¶ˆè´¹è€…å·¥ä½œåŸç†


**åŸºæœ¬æµç¨‹å›¾ç¤º**
```
æ¶ˆè´¹è€…åº”ç”¨å¯åŠ¨æµç¨‹ï¼š

1. å¯åŠ¨é˜¶æ®µ
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Springå®¹å™¨  â”‚
   â”‚   å¯åŠ¨      â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ æ‰«æ@Reference  â”‚
   â”‚ æ³¨è§£çš„æ¥å£      â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ è¿æ¥æ³¨å†Œä¸­å¿ƒ    â”‚
   â”‚ (å¦‚Zookeeper)   â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ è®¢é˜…æœåŠ¡æä¾›è€…  â”‚
   â”‚ çš„åœ°å€åˆ—è¡¨      â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ç”Ÿæˆä»£ç†å¯¹è±¡    â”‚
   â”‚ æ³¨å…¥åˆ°Beanä¸­    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. è°ƒç”¨é˜¶æ®µ
   ä¸šåŠ¡ä»£ç è°ƒç”¨ â†’ ä»£ç†æ‹¦æˆª â†’ é€‰æ‹©æä¾›è€… â†’ å‘èµ·RPCè°ƒç”¨ â†’ è¿”å›ç»“æœ
```

### 1.3 æ¶ˆè´¹è€…ä¸æä¾›è€…çš„å…³ç³»


**å…³ç³»ç¤ºæ„å›¾**
```
        æ³¨å†Œä¸­å¿ƒ(Zookeeper/Nacos)
              â†‘        â†“
           æ³¨å†Œ|        |è®¢é˜…
              |        â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ æä¾›è€…1 â”‚  â”‚ æ¶ˆè´¹è€…  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†‘           |
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       |
        â”‚ æä¾›è€…2 â”‚â†â”€â”€â”€â”€â”€â”€â”˜
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    RPCè°ƒç”¨

æ ¸å¿ƒæœºåˆ¶ï¼š
â€¢ æä¾›è€…ï¼šæŠŠæœåŠ¡åœ°å€æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒ
â€¢ æ¶ˆè´¹è€…ï¼šä»æ³¨å†Œä¸­å¿ƒè®¢é˜…æœåŠ¡åœ°å€
â€¢ è°ƒç”¨ï¼šæ¶ˆè´¹è€…ç›´æ¥è¿æ¥æä¾›è€…è¿›è¡ŒRPCé€šä¿¡
```

---

## 2. ğŸ“Œ @Referenceæ³¨è§£è¯¦è§£


### 2.1 @Referenceæ³¨è§£çš„ä½œç”¨


**æ ¸å¿ƒç†è§£**ï¼š@Referenceå°±åƒæ˜¯"è¿œç¨‹æœåŠ¡çš„é¥æ§å™¨"

```
æœ¬åœ°æ–¹æ³•è°ƒç”¨ï¼š
@Autowired
private UserService userService;  // æœ¬åœ°Bean

è¿œç¨‹æœåŠ¡è°ƒç”¨ï¼š
@Reference
private UserService userService;  // è¿œç¨‹æœåŠ¡

åŒºåˆ«å¯¹æ¯”ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å¯¹æ¯”é¡¹        â”‚  @Autowired  â”‚  @Reference  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è°ƒç”¨èŒƒå›´        â”‚  æœ¬åœ°åº”ç”¨å†…  â”‚  è·¨åº”ç”¨è¿œç¨‹  â”‚
â”‚ é€šä¿¡æ–¹å¼        â”‚  å†…å­˜è°ƒç”¨    â”‚  ç½‘ç»œRPC     â”‚
â”‚ æ€§èƒ½            â”‚  æå¿«        â”‚  æœ‰ç½‘ç»œå»¶è¿Ÿ  â”‚
â”‚ å¯é æ€§è¦æ±‚      â”‚  é«˜          â”‚  éœ€è¦å®¹é”™    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 åŸºç¡€ä½¿ç”¨æ–¹å¼


**æœ€ç®€å•çš„ç”¨æ³•**
```java
// 1. æ¶ˆè´¹è€…åªéœ€è¦æœ‰æ¥å£å®šä¹‰ï¼ˆä¸éœ€è¦å®ç°ç±»ï¼‰
public interface UserService {
    User getUserById(Long id);
}

// 2. ä½¿ç”¨@Referenceæ³¨è§£å¼•ç”¨è¿œç¨‹æœåŠ¡
@RestController
public class UserController {
    
    // è¿™ä¸ªuserServiceä¸æ˜¯æœ¬åœ°å®ç°ï¼Œè€Œæ˜¯è¿œç¨‹æœåŠ¡çš„ä»£ç†
    @Reference
    private UserService userService;
    
    @GetMapping("/user/{id}")
    public User getUser(@PathVariable Long id) {
        // çœ‹èµ·æ¥åƒæœ¬åœ°è°ƒç”¨ï¼Œå®é™…æ˜¯è¿œç¨‹RPCè°ƒç”¨
        return userService.getUserById(id);
    }
}
```

**æ ¸å¿ƒç†è§£**
```
å¹•åå‘ç”Ÿäº†ä»€ä¹ˆï¼š

æ¶ˆè´¹è€…ä»£ç ï¼š
userService.getUserById(1L);

å®é™…æ‰§è¡Œæµç¨‹ï¼š
1. ä»£ç†å¯¹è±¡æ‹¦æˆªæ–¹æ³•è°ƒç”¨
2. å°†æ–¹æ³•åã€å‚æ•°åºåˆ—åŒ–
3. é€šè¿‡ç½‘ç»œå‘é€åˆ°æä¾›è€…
4. æä¾›è€…æ‰§è¡ŒçœŸæ­£çš„æ–¹æ³•
5. ç»“æœåºåˆ—åŒ–è¿”å›
6. æ¶ˆè´¹è€…ååºåˆ—åŒ–å¾—åˆ°ç»“æœ

å¼€å‘è€…æ„ŸçŸ¥ï¼šå°±åƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·ç®€å•ï¼
```

### 2.3 @Referenceå¸¸ç”¨å±æ€§


**æ ¸å¿ƒå±æ€§è¯¦è§£**

| å±æ€§å | å«ä¹‰è¯´æ˜ | ä½¿ç”¨åœºæ™¯ | ç¤ºä¾‹å€¼ |
|--------|----------|----------|--------|
| **version** | `æœåŠ¡ç‰ˆæœ¬å·` | `åŒä¸€æ¥å£æœ‰å¤šä¸ªç‰ˆæœ¬æ—¶åŒºåˆ†` | `"1.0.0"` |
| **group** | `æœåŠ¡åˆ†ç»„` | `åŒä¸€æ¥å£ä¸åŒä¸šåŠ¡åœºæ™¯éš”ç¦»` | `"payment"` |
| **timeout** | `è°ƒç”¨è¶…æ—¶æ—¶é—´(æ¯«ç§’)` | `é˜²æ­¢è°ƒç”¨ä¸€ç›´ç­‰å¾…` | `3000` |
| **retries** | `å¤±è´¥é‡è¯•æ¬¡æ•°` | `æé«˜è°ƒç”¨æˆåŠŸç‡` | `2` |
| **loadbalance** | `è´Ÿè½½å‡è¡¡ç­–ç•¥` | `å¤šä¸ªæä¾›è€…æ—¶å¦‚ä½•é€‰æ‹©` | `"random"` |
| **async** | `æ˜¯å¦å¼‚æ­¥è°ƒç”¨` | `ä¸éœ€è¦ç«‹å³å¾—åˆ°ç»“æœ` | `true` |
| **check** | `å¯åŠ¨æ—¶æ£€æŸ¥æä¾›è€…` | `å¼€å‘ç¯å¢ƒå¯å…³é—­` | `false` |

**å®é™…é…ç½®ç¤ºä¾‹**
```java
@RestController
public class OrderController {
    
    // é…ç½®1ï¼šæŒ‡å®šç‰ˆæœ¬å’Œè¶…æ—¶
    @Reference(version = "1.0.0", timeout = 5000)
    private UserService userService;
    
    // é…ç½®2ï¼šè®¾ç½®é‡è¯•å’Œè´Ÿè½½å‡è¡¡
    @Reference(
        retries = 2,              // å¤±è´¥é‡è¯•2æ¬¡
        loadbalance = "roundrobin" // è½®è¯¢è´Ÿè½½å‡è¡¡
    )
    private ProductService productService;
    
    // é…ç½®3ï¼šå¼€å‘ç¯å¢ƒé…ç½®ï¼ˆå…³é—­æ£€æŸ¥ï¼‰
    @Reference(check = false)  // å¯åŠ¨æ—¶ä¸æ£€æŸ¥æä¾›è€…æ˜¯å¦å­˜åœ¨
    private PaymentService paymentService;
}
```

**å±æ€§ç»„åˆä½¿ç”¨å»ºè®®**
```
åœºæ™¯1ï¼šæ ¸å¿ƒæœåŠ¡è°ƒç”¨
@Reference(
    timeout = 3000,    // 3ç§’è¶…æ—¶
    retries = 2,       // é‡è¯•2æ¬¡
    check = true       // å¯åŠ¨æ£€æŸ¥
)

åœºæ™¯2ï¼šéå…³é”®æœåŠ¡è°ƒç”¨
@Reference(
    timeout = 1000,    // 1ç§’è¶…æ—¶
    retries = 0,       // ä¸é‡è¯•
    check = false      // ä¸æ£€æŸ¥
)

åœºæ™¯3ï¼šå¼‚æ­¥è°ƒç”¨
@Reference(
    async = true,      // å¼‚æ­¥è°ƒç”¨
    timeout = 5000     // ç»™è¶³æ—¶é—´
)
```

---

## 3. âš™ï¸ æœåŠ¡å¼•ç”¨é…ç½®


### 3.1 é…ç½®æ–¹å¼å¯¹æ¯”


**ä¸‰ç§é…ç½®æ–¹å¼**
```
æ–¹å¼1ï¼šæ³¨è§£é…ç½®ï¼ˆæ¨èï¼‰
ä¼˜ç‚¹ï¼šç®€å•ç›´è§‚ï¼Œé…ç½®åœ¨ä»£ç ä¸­
é€‚ç”¨ï¼šå¤§å¤šæ•°åœºæ™¯

æ–¹å¼2ï¼šXMLé…ç½®
ä¼˜ç‚¹ï¼šé›†ä¸­ç®¡ç†
é€‚ç”¨ï¼šä¼ ç»ŸSpringé¡¹ç›®

æ–¹å¼3ï¼šAPIé…ç½®
ä¼˜ç‚¹ï¼šåŠ¨æ€çµæ´»
é€‚ç”¨ï¼šéœ€è¦åŠ¨æ€åˆ›å»ºå¼•ç”¨
```

### 3.2 æ³¨è§£é…ç½®è¯¦è§£


**åŸºç¡€é…ç½®ç»“æ„**
```java
// application.yml å…¨å±€é…ç½®
dubbo:
  application:
    name: order-consumer        # æ¶ˆè´¹è€…åº”ç”¨å
  registry:
    address: zookeeper://127.0.0.1:2181  # æ³¨å†Œä¸­å¿ƒ
  consumer:
    timeout: 3000               # å…¨å±€è¶…æ—¶æ—¶é—´
    retries: 2                  # å…¨å±€é‡è¯•æ¬¡æ•°
    check: false                # å…¨å±€å¯åŠ¨æ£€æŸ¥

// Javaä»£ç ä¸­ä½¿ç”¨
@Reference  // ä¼šç»§æ‰¿å…¨å±€é…ç½®
private UserService userService;

@Reference(timeout = 5000)  // è¦†ç›–å…¨å±€é…ç½®
private OrderService orderService;
```

**é…ç½®ä¼˜å…ˆçº§ç†è§£**
```
ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼š

æ–¹æ³•çº§é…ç½® > æ¥å£çº§é…ç½® > å…¨å±€é…ç½®

ç¤ºä¾‹ï¼š
å…¨å±€é…ç½®ï¼štimeout = 3000
æ¥å£é…ç½®ï¼š@Reference(timeout = 5000)
æœ€ç»ˆç”Ÿæ•ˆï¼š5000æ¯«ç§’

ç†è§£è¦ç‚¹ï¼š
â€¢ è¶Šç²¾ç¡®çš„é…ç½®ä¼˜å…ˆçº§è¶Šé«˜
â€¢ å°±è¿‘åŸåˆ™ï¼šç¦»ä»£ç è¶Šè¿‘ä¼˜å…ˆçº§è¶Šé«˜
â€¢ çµæ´»æ€§ï¼šå¯ä»¥ä¸ºç‰¹å®šæœåŠ¡å®šåˆ¶é…ç½®
```

### 3.3 å¤šæ³¨å†Œä¸­å¿ƒé…ç½®


**ä½¿ç”¨åœºæ™¯**ï¼šä¸åŒæœåŠ¡åœ¨ä¸åŒæ³¨å†Œä¸­å¿ƒ

```java
// é…ç½®æ–‡ä»¶
dubbo:
  registries:
    beijingRegistry:
      address: zookeeper://bj.example.com:2181
    shanghaiRegistry:
      address: zookeeper://sh.example.com:2181

// ä»£ç ä¸­æŒ‡å®šæ³¨å†Œä¸­å¿ƒ
@Reference(registry = "beijingRegistry")
private UserService userService;

@Reference(registry = "shanghaiRegistry")
private ProductService productService;
```

**åº”ç”¨åœºæ™¯å›¾ç¤º**
```
æ¶ˆè´¹è€…åº”ç”¨
    â”‚
    â”œâ”€â†’ åŒ—äº¬æ³¨å†Œä¸­å¿ƒ â”€â†’ åŒ—äº¬æœºæˆ¿çš„UserService
    â”‚
    â””â”€â†’ ä¸Šæµ·æ³¨å†Œä¸­å¿ƒ â”€â†’ ä¸Šæµ·æœºæˆ¿çš„ProductService

é€‚ç”¨åœºæ™¯ï¼š
â€¢ å¤šæœºæˆ¿éƒ¨ç½²
â€¢ æœåŠ¡åˆ†åŒºéš”ç¦»
â€¢ ç¾å¤‡åˆ‡æ¢
```

---

## 4. ğŸ”„ æ¥å£è°ƒç”¨æ–¹å¼


### 4.1 åŒæ­¥è°ƒç”¨ï¼ˆé»˜è®¤æ–¹å¼ï¼‰


**å·¥ä½œåŸç†**ï¼šè°ƒç”¨åç­‰å¾…ç»“æœè¿”å›

```java
@RestController
public class UserController {
    
    @Reference
    private UserService userService;
    
    @GetMapping("/user/{id}")
    public User getUser(@PathVariable Long id) {
        // åŒæ­¥è°ƒç”¨ï¼šä¼šç­‰å¾…è¿œç¨‹æœåŠ¡è¿”å›ç»“æœ
        User user = userService.getUserById(id);
        System.out.println("è°ƒç”¨å®Œæˆï¼Œå¾—åˆ°ç»“æœ");
        return user;
    }
}
```

**æ‰§è¡Œæµç¨‹**
```
æ—¶é—´çº¿ï¼š
t0: å‘èµ·è°ƒç”¨ userService.getUserById(1L)
    â†“
t1: çº¿ç¨‹é˜»å¡ç­‰å¾…
    â†“
t2: æä¾›è€…å¤„ç†å®Œæˆ
    â†“
t3: è¿”å›ç»“æœï¼Œçº¿ç¨‹ç»§ç»­æ‰§è¡Œ
    â†“
t4: æ‰“å°"è°ƒç”¨å®Œæˆï¼Œå¾—åˆ°ç»“æœ"

ç‰¹ç‚¹ï¼šç®€å•ç›´è§‚ï¼Œä½†ä¼šé˜»å¡å½“å‰çº¿ç¨‹
```

### 4.2 å¼‚æ­¥è°ƒç”¨æ–¹å¼


**ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥**ï¼šæé«˜å“åº”é€Ÿåº¦ï¼Œä¸é˜»å¡çº¿ç¨‹

```java
// åœºæ™¯ï¼šéœ€è¦è°ƒç”¨å¤šä¸ªæœåŠ¡ï¼Œä¸æƒ³ä¸²è¡Œç­‰å¾…
@RestController
public class OrderController {
    
    @Reference(async = true)
    private UserService userService;
    
    @Reference(async = true)
    private ProductService productService;
    
    @GetMapping("/order/info/{orderId}")
    public OrderInfo getOrderInfo(@PathVariable Long orderId) {
        
        // å‘èµ·å¼‚æ­¥è°ƒç”¨ï¼ˆç«‹å³è¿”å›ï¼Œä¸ç­‰å¾…ç»“æœï¼‰
        userService.getUserById(1L);
        productService.getProductById(100L);
        
        // é€šè¿‡RpcContextè·å–å¼‚æ­¥ç»“æœ
        Future<User> userFuture = RpcContext.getContext().getFuture();
        Future<Product> productFuture = RpcContext.getContext().getFuture();
        
        try {
            // ç­‰å¾…ç»“æœï¼ˆå¯ä»¥å¹¶è¡Œç­‰å¾…ï¼‰
            User user = userFuture.get();
            Product product = productFuture.get();
            
            return new OrderInfo(user, product);
        } catch (Exception e) {
            throw new RuntimeException("è·å–ä¿¡æ¯å¤±è´¥", e);
        }
    }
}
```

**åŒæ­¥vså¼‚æ­¥å¯¹æ¯”**
```
åŒæ­¥è°ƒç”¨ï¼ˆä¸²è¡Œï¼‰ï¼š
[è°ƒç”¨ç”¨æˆ·æœåŠ¡ 2ç§’] â†’ [è°ƒç”¨å•†å“æœåŠ¡ 2ç§’] = æ€»è€—æ—¶ 4ç§’

å¼‚æ­¥è°ƒç”¨ï¼ˆå¹¶è¡Œï¼‰ï¼š
[è°ƒç”¨ç”¨æˆ·æœåŠ¡ 2ç§’]
                  } å¹¶è¡Œæ‰§è¡Œ = æ€»è€—æ—¶ 2ç§’
[è°ƒç”¨å•†å“æœåŠ¡ 2ç§’]

æ€§èƒ½æå‡ï¼š
â€¢ å¤šä¸ªæœåŠ¡è°ƒç”¨å¯ä»¥å¹¶è¡Œ
â€¢ ä¸é˜»å¡ä¸»çº¿ç¨‹
â€¢ æé«˜ç³»ç»Ÿååé‡
```

### 4.3 å•å‘è°ƒç”¨ï¼ˆFire and Forgetï¼‰


**ä½¿ç”¨åœºæ™¯**ï¼šä¸å…³å¿ƒè°ƒç”¨ç»“æœï¼Œåªç®¡å‘é€

```java
// é…ç½®å•å‘è°ƒç”¨
@Reference(sent = false, return = false)
private LogService logService;

public void processOrder(Order order) {
    // å¤„ç†è®¢å•
    order.setStatus("PROCESSED");
    
    // è®°å½•æ—¥å¿—ï¼ˆå•å‘è°ƒç”¨ï¼Œä¸ç­‰å¾…è¿”å›ï¼‰
    logService.log("è®¢å•å¤„ç†å®Œæˆï¼š" + order.getId());
    
    // ç«‹å³ç»§ç»­æ‰§è¡Œï¼Œä¸ç­‰æ—¥å¿—æœåŠ¡
}
```

**é€‚ç”¨åœºæ™¯**
```
âœ… é€‚åˆï¼š
â€¢ æ—¥å¿—è®°å½•
â€¢ æ¶ˆæ¯é€šçŸ¥
â€¢ ç»Ÿè®¡ä¸ŠæŠ¥
â€¢ ä¸é‡è¦çš„æ“ä½œ

âŒ ä¸é€‚åˆï¼š
â€¢ éœ€è¦è¿”å›å€¼çš„æ“ä½œ
â€¢ éœ€è¦ç¡®è®¤æˆåŠŸçš„æ“ä½œ
â€¢ å…³é”®ä¸šåŠ¡æµç¨‹
```

---

## 5. â±ï¸ è¶…æ—¶ä¸é‡è¯•æœºåˆ¶


### 5.1 è¶…æ—¶æœºåˆ¶è¯¦è§£


**ä¸ºä»€ä¹ˆéœ€è¦è¶…æ—¶**ï¼šé˜²æ­¢æ— é™ç­‰å¾…

```
æ²¡æœ‰è¶…æ—¶çš„é—®é¢˜ï¼š
æ¶ˆè´¹è€…è°ƒç”¨ â†’ æä¾›è€…å“åº”æ…¢/æ— å“åº” â†’ æ¶ˆè´¹è€…ä¸€ç›´ç­‰å¾… â†’ èµ„æºè€—å°½

æœ‰è¶…æ—¶ä¿æŠ¤ï¼š
æ¶ˆè´¹è€…è°ƒç”¨ â†’ ç­‰å¾…3ç§’ â†’ è¶…æ—¶å¼‚å¸¸ â†’ å¿«é€Ÿå¤±è´¥æˆ–é‡è¯•
```

**è¶…æ—¶é…ç½®å±‚çº§**
```java
// å±‚çº§1ï¼šå…¨å±€é…ç½®ï¼ˆä¼˜å…ˆçº§æœ€ä½ï¼‰
dubbo.consumer.timeout=3000

// å±‚çº§2ï¼šæ¥å£çº§é…ç½®
@Reference(timeout = 5000)
private UserService userService;

// å±‚çº§3ï¼šæ–¹æ³•çº§é…ç½®ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰
@Reference(
    methods = {
        @Method(name = "getUserById", timeout = 2000),
        @Method(name = "updateUser", timeout = 10000)
    }
)
private UserService userService;
```

**å®é™…é…ç½®ç¤ºä¾‹**
```java
@Service
public class OrderServiceImpl {
    
    @Reference(
        timeout = 3000,  // é»˜è®¤è¶…æ—¶3ç§’
        methods = {
            // æŸ¥è¯¢æ“ä½œï¼šå¿«é€Ÿè¶…æ—¶
            @Method(name = "queryOrder", timeout = 1000),
            // åˆ›å»ºæ“ä½œï¼šè¾ƒé•¿è¶…æ—¶
            @Method(name = "createOrder", timeout = 5000)
        }
    )
    private OrderService orderService;
}
```

### 5.2 é‡è¯•æœºåˆ¶è¯¦è§£


**é‡è¯•æœºåˆ¶åŸç†**
```
è°ƒç”¨æµç¨‹ï¼š
ç¬¬1æ¬¡è°ƒç”¨ â†’ å¤±è´¥ â†’ è‡ªåŠ¨é‡è¯•1æ¬¡ â†’ å¤±è´¥ â†’ è‡ªåŠ¨é‡è¯•2æ¬¡ â†’ æˆåŠŸ/å¤±è´¥

é…ç½®ç¤ºä¾‹ï¼š
@Reference(retries = 2)  // å¤±è´¥åé‡è¯•2æ¬¡ï¼Œæ€»å…±è°ƒç”¨3æ¬¡
```

**é‡è¯•é…ç½®è¦ç‚¹**

| åœºæ™¯ç±»å‹ | æ˜¯å¦é‡è¯• | é…ç½®å»ºè®® | åŸå› è¯´æ˜ |
|----------|----------|----------|----------|
| **æŸ¥è¯¢æ“ä½œ** | `âœ… å¯ä»¥é‡è¯•` | `retries = 2` | `å¹‚ç­‰æ“ä½œï¼Œå¤šæ¬¡æŸ¥è¯¢ç»“æœä¸€æ ·` |
| **åˆ é™¤æ“ä½œ** | `âœ… å¯ä»¥é‡è¯•` | `retries = 2` | `åˆ é™¤å¤šæ¬¡ç»“æœä¸€æ ·` |
| **æ–°å¢æ“ä½œ** | `âŒ ä¸èƒ½é‡è¯•` | `retries = 0` | `ä¼šé‡å¤åˆ›å»ºæ•°æ®` |
| **æ‰£æ¬¾æ“ä½œ** | `âŒ ä¸èƒ½é‡è¯•` | `retries = 0` | `ä¼šé‡å¤æ‰£æ¬¾` |

**ä»£ç é…ç½®ç¤ºä¾‹**
```java
public class PaymentController {
    
    // æŸ¥è¯¢è®¢å•ï¼šå¯ä»¥é‡è¯•
    @Reference(
        timeout = 3000,
        retries = 2,
        loadbalance = "random"
    )
    private OrderQueryService orderQueryService;
    
    // æ‰£æ¬¾æ¥å£ï¼šä¸èƒ½é‡è¯•
    @Reference(
        timeout = 5000,
        retries = 0  // å…³é”®ï¼šä¸é‡è¯•
    )
    private PaymentService paymentService;
    
    public void processPayment(Long orderId) {
        // æŸ¥è¯¢è®¢å•ï¼ˆå¤±è´¥ä¼šé‡è¯•ï¼‰
        Order order = orderQueryService.getOrder(orderId);
        
        // æ‰§è¡Œæ‰£æ¬¾ï¼ˆå¤±è´¥ä¸é‡è¯•ï¼Œé¿å…é‡å¤æ‰£æ¬¾ï¼‰
        paymentService.deduct(order.getAmount());
    }
}
```

### 5.3 è¶…æ—¶ä¸é‡è¯•ç»„åˆç­–ç•¥


**æœ€ä½³å®è·µé…ç½®**
```java
// åœºæ™¯1ï¼šæ ¸å¿ƒä¸šåŠ¡ï¼ˆé«˜å¯é æ€§è¦æ±‚ï¼‰
@Reference(
    timeout = 5000,    // è¾ƒé•¿è¶…æ—¶
    retries = 2,       // é‡è¯•2æ¬¡
    cluster = "failover"  // å¤±è´¥åˆ‡æ¢
)
private CoreService coreService;

// åœºæ™¯2ï¼šå¿«é€ŸæŸ¥è¯¢ï¼ˆé«˜æ€§èƒ½è¦æ±‚ï¼‰
@Reference(
    timeout = 1000,    // å¿«é€Ÿè¶…æ—¶
    retries = 1,       // åªé‡è¯•1æ¬¡
    cluster = "failfast"  // å¿«é€Ÿå¤±è´¥
)
private QueryService queryService;

// åœºæ™¯3ï¼šéå¹‚ç­‰æ“ä½œï¼ˆæ•°æ®ä¸€è‡´æ€§è¦æ±‚ï¼‰
@Reference(
    timeout = 10000,   // ç»™è¶³æ—¶é—´
    retries = 0,       // ä¸é‡è¯•
    cluster = "failfast"
)
private TransactionService transactionService;
```

---

## 6. ğŸš€ å¼‚æ­¥è°ƒç”¨å®ç°


### 6.1 å¼‚æ­¥è°ƒç”¨çš„ä»·å€¼


**æ€§èƒ½æå‡å¯¹æ¯”**
```
ä¸²è¡Œè°ƒç”¨åœºæ™¯ï¼š
è°ƒç”¨æœåŠ¡A(200ms) â†’ è°ƒç”¨æœåŠ¡B(200ms) â†’ è°ƒç”¨æœåŠ¡C(200ms)
æ€»è€—æ—¶ï¼š600ms

å¹¶è¡Œå¼‚æ­¥è°ƒç”¨ï¼š
â”Œâ”€ è°ƒç”¨æœåŠ¡A(200ms) â”€â”
â”œâ”€ è°ƒç”¨æœåŠ¡B(200ms) â”€â”¤ åŒæ—¶æ‰§è¡Œ
â””â”€ è°ƒç”¨æœåŠ¡C(200ms) â”€â”˜
æ€»è€—æ—¶ï¼š200ms

æ€§èƒ½æå‡ï¼š3å€
```

### 6.2 CompletableFutureå¼‚æ­¥è°ƒç”¨


**æ¨èæ–¹å¼**ï¼ˆDubbo 2.7+ï¼‰
```java
@RestController
public class AsyncController {
    
    @Reference
    private UserService userService;
    
    @Reference
    private OrderService orderService;
    
    @GetMapping("/user/order/{userId}")
    public CompletableFuture<UserOrderInfo> getUserOrderInfo(
            @PathVariable Long userId) {
        
        // å¼‚æ­¥è°ƒç”¨ç”¨æˆ·æœåŠ¡
        CompletableFuture<User> userFuture = 
            userService.getUserByIdAsync(userId);
        
        // å¼‚æ­¥è°ƒç”¨è®¢å•æœåŠ¡
        CompletableFuture<List<Order>> orderFuture = 
            orderService.getUserOrdersAsync(userId);
        
        // ç»„åˆä¸¤ä¸ªå¼‚æ­¥ç»“æœ
        return userFuture.thenCombine(orderFuture, 
            (user, orders) -> new UserOrderInfo(user, orders));
    }
}

// æœåŠ¡æ¥å£å®šä¹‰
public interface UserService {
    // å®šä¹‰å¼‚æ­¥æ–¹æ³•
    CompletableFuture<User> getUserByIdAsync(Long id);
}
```

### 6.3 å¼‚æ­¥è°ƒç”¨æœ€ä½³å®è·µ


**å®æˆ˜ç¤ºä¾‹ï¼šè®¢å•è¯¦æƒ…é¡µ**
```java
@Service
public class OrderDetailService {
    
    @Reference
    private UserService userService;
    
    @Reference
    private ProductService productService;
    
    @Reference
    private LogisticsService logisticsService;
    
    /**
     * è·å–è®¢å•è¯¦æƒ…ï¼ˆå¼‚æ­¥å¹¶è¡ŒåŠ è½½ï¼‰
     */
    public CompletableFuture<OrderDetail> getOrderDetail(Long orderId) {
        
        // 1. å¹¶è¡Œå‘èµ·ä¸‰ä¸ªå¼‚æ­¥è°ƒç”¨
        CompletableFuture<User> userFuture = 
            userService.getUserAsync(getUserId(orderId));
            
        CompletableFuture<Product> productFuture = 
            productService.getProductAsync(getProductId(orderId));
            
        CompletableFuture<Logistics> logisticsFuture = 
            logisticsService.getLogisticsAsync(orderId);
        
        // 2. ç­‰å¾…æ‰€æœ‰ç»“æœï¼Œç»„åˆæˆè®¢å•è¯¦æƒ…
        return CompletableFuture.allOf(
                userFuture, 
                productFuture, 
                logisticsFuture
            )
            .thenApply(v -> {
                User user = userFuture.join();
                Product product = productFuture.join();
                Logistics logistics = logisticsFuture.join();
                return new OrderDetail(user, product, logistics);
            });
    }
}
```

**å¼‚æ­¥è°ƒç”¨æ³¨æ„äº‹é¡¹**
```
âœ… é€‚åˆåœºæ™¯ï¼š
â€¢ éœ€è¦è°ƒç”¨å¤šä¸ªæœåŠ¡
â€¢ æœåŠ¡é—´æ— å¼ºä¾èµ–
â€¢ å¯¹å“åº”æ—¶é—´æ•æ„Ÿ

âš ï¸ æ³¨æ„äº‹é¡¹ï¼š
â€¢ éœ€è¦å¤„ç†å¼‚å¸¸æƒ…å†µ
â€¢ åˆç†è®¾ç½®è¶…æ—¶æ—¶é—´
â€¢ æ³¨æ„çº¿ç¨‹æ± èµ„æº
â€¢ åšå¥½å¼‚å¸¸é™çº§
```

---

## 7. ğŸ”§ æ³›åŒ–è°ƒç”¨åº”ç”¨


### 7.1 æ³›åŒ–è°ƒç”¨æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯æ³›åŒ–è°ƒç”¨**
```
æ™®é€šè°ƒç”¨ï¼šéœ€è¦æœåŠ¡æ¥å£çš„JaråŒ…
æ¶ˆè´¹è€…é¡¹ç›®ä¾èµ– â†’ æ¥å£JaråŒ… â†’ æ‰èƒ½è°ƒç”¨

æ³›åŒ–è°ƒç”¨ï¼šä¸éœ€è¦æ¥å£JaråŒ…
æ¶ˆè´¹è€… â†’ åªéœ€çŸ¥é“æ¥å£åã€æ–¹æ³•åã€å‚æ•° â†’ å°±èƒ½è°ƒç”¨

ç±»æ¯”ç†è§£ï¼š
æ™®é€šè°ƒç”¨ = ç”¨é¥æ§å™¨(éœ€è¦ç‰¹å®šé¥æ§å™¨)
æ³›åŒ–è°ƒç”¨ = ç”¨ä¸‡èƒ½é¥æ§å™¨(ä¸€ä¸ªé¥æ§å™¨æ§åˆ¶æ‰€æœ‰è®¾å¤‡)
```

### 7.2 æ³›åŒ–è°ƒç”¨åº”ç”¨åœºæ™¯


**å…¸å‹åœºæ™¯**
```
åœºæ™¯1ï¼šç½‘å…³æœåŠ¡
APIç½‘å…³ â†’ è½¬å‘è¯·æ±‚åˆ°å„ä¸ªå¾®æœåŠ¡
â€¢ ä¸å¯èƒ½ä¾èµ–æ‰€æœ‰æœåŠ¡çš„æ¥å£
â€¢ ä½¿ç”¨æ³›åŒ–è°ƒç”¨åŠ¨æ€è½¬å‘

åœºæ™¯2ï¼šæµ‹è¯•å¹³å°
æµ‹è¯•å·¥å…· â†’ è°ƒç”¨å„ç§æœåŠ¡è¿›è¡Œæµ‹è¯•
â€¢ ä¸éœ€è¦ä¾èµ–æ‰€æœ‰æ¥å£
â€¢ é€šè¿‡é…ç½®å°±èƒ½è°ƒç”¨

åœºæ™¯3ï¼šç›‘æ§å¹³å°
ç›‘æ§ç³»ç»Ÿ â†’ è°ƒç”¨æœåŠ¡å¥åº·æ£€æŸ¥
â€¢ é€šè¿‡æ³›åŒ–è°ƒç”¨æ¢æµ‹æœåŠ¡
```

### 7.3 æ³›åŒ–è°ƒç”¨å®ç°


**åŸºç¡€ç”¨æ³•**
```java
@RestController
public class GenericController {
    
    @Reference(interfaceName = "com.example.UserService", 
               generic = true)
    private GenericService genericService;
    
    @PostMapping("/generic/call")
    public Object genericCall(@RequestBody GenericRequest request) {
        
        // æ„é€ å‚æ•°
        Object[] params = request.getParams();
        String[] paramTypes = request.getParamTypes();
        
        // æ³›åŒ–è°ƒç”¨
        Object result = genericService.$invoke(
            request.getMethodName(),  // æ–¹æ³•å
            paramTypes,               // å‚æ•°ç±»å‹
            params                    // å‚æ•°å€¼
        );
        
        return result;
    }
}

// è¯·æ±‚å¯¹è±¡
class GenericRequest {
    private String methodName;     // "getUserById"
    private String[] paramTypes;   // ["java.lang.Long"]
    private Object[] params;       // [1L]
}
```

**å®æˆ˜ç¤ºä¾‹ï¼šAPIç½‘å…³**
```java
@Service
public class GatewayService {
    
    // é€šè¿‡é…ç½®åŠ¨æ€åˆ›å»ºæ³›åŒ–æœåŠ¡
    public Object routeRequest(String serviceName, 
                                String method, 
                                Object[] params) {
        
        // 1. åˆ›å»ºæ³›åŒ–æœåŠ¡å¼•ç”¨
        ReferenceConfig<GenericService> reference = 
            new ReferenceConfig<>();
        reference.setInterface(serviceName);
        reference.setGeneric(true);
        
        // 2. è·å–æ³›åŒ–æœåŠ¡
        GenericService genericService = reference.get();
        
        // 3. è°ƒç”¨æ–¹æ³•
        try {
            return genericService.$invoke(
                method,
                getParamTypes(params),
                params
            );
        } finally {
            // 4. é”€æ¯å¼•ç”¨
            reference.destroy();
        }
    }
    
    private String[] getParamTypes(Object[] params) {
        return Arrays.stream(params)
            .map(p -> p.getClass().getName())
            .toArray(String[]::new);
    }
}
```

### 7.4 æ³›åŒ–è°ƒç”¨ä½¿ç”¨å»ºè®®


**ä¼˜ç¼ºç‚¹å¯¹æ¯”**
```
âœ… ä¼˜ç‚¹ï¼š
â€¢ ä¸éœ€è¦ä¾èµ–æ¥å£JaråŒ…
â€¢ åŠ¨æ€è°ƒç”¨ï¼Œçµæ´»æ€§é«˜
â€¢ é€‚åˆç½‘å…³ã€æµ‹è¯•å¹³å°

âŒ ç¼ºç‚¹ï¼š
â€¢ æ²¡æœ‰ç±»å‹æ£€æŸ¥ï¼Œå®¹æ˜“å‡ºé”™
â€¢ æ€§èƒ½ç•¥ä½äºæ™®é€šè°ƒç”¨
â€¢ è°ƒè¯•å›°éš¾

ä½¿ç”¨å»ºè®®ï¼š
â€¢ ç½‘å…³å±‚ä½¿ç”¨æ³›åŒ–è°ƒç”¨
â€¢ ä¸šåŠ¡å±‚ä½¿ç”¨æ™®é€šè°ƒç”¨
â€¢ åšå¥½å‚æ•°æ ¡éªŒå’Œå¼‚å¸¸å¤„ç†
```

---

## 8. ğŸ” å›å£°æµ‹è¯•æœºåˆ¶


### 8.1 å›å£°æµ‹è¯•æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯å›å£°æµ‹è¯•**
```
å›å£°æµ‹è¯•(Echo Test)ï¼šå°±åƒå–Šå±±ï¼Œå¬å›å£°åˆ¤æ–­æœåŠ¡æ˜¯å¦æ­£å¸¸

åŸç†ï¼š
æ¶ˆè´¹è€… â†’ å‘é€ç‰¹æ®Šè¯·æ±‚ â†’ æä¾›è€…åŸæ ·è¿”å› â†’ ç¡®è®¤æœåŠ¡å¯ç”¨

ç±»æ¯”ï¼š
æ‰“ç”µè¯å‰æµ‹è¯•ï¼šå–‚ï¼Ÿèƒ½å¬åˆ°å—ï¼Ÿ
å›å£°æµ‹è¯•ï¼š$echo â†’ æœåŠ¡è¿”å›$echo â†’ è¿æ¥æ­£å¸¸
```

### 8.2 å›å£°æµ‹è¯•ä½¿ç”¨


**åŸºæœ¬ç”¨æ³•**
```java
@Service
public class HealthCheckService {
    
    @Reference
    private UserService userService;
    
    /**
     * æ£€æŸ¥æœåŠ¡æ˜¯å¦å¯ç”¨
     */
    public boolean checkService() {
        try {
            // è½¬æ¢ä¸ºEchoServiceï¼ˆæ‰€æœ‰DubboæœåŠ¡éƒ½æ”¯æŒï¼‰
            EchoService echoService = (EchoService) userService;
            
            // å‘é€å›å£°æµ‹è¯•
            Object result = echoService.$echo("health-check");
            
            // å¦‚æœè¿”å›ç›¸åŒå†…å®¹ï¼Œè¯´æ˜æœåŠ¡æ­£å¸¸
            return "health-check".equals(result);
            
        } catch (Exception e) {
            return false;
        }
    }
}
```

### 8.3 å›å£°æµ‹è¯•åº”ç”¨åœºæ™¯


**å®æˆ˜åº”ç”¨**
```java
@Component
public class ServiceMonitor {
    
    @Reference
    private OrderService orderService;
    
    @Reference
    private PaymentService paymentService;
    
    /**
     * å®šæœŸå¥åº·æ£€æŸ¥
     */
    @Scheduled(fixedRate = 30000)  // æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡
    public void healthCheck() {
        
        // æ£€æŸ¥è®¢å•æœåŠ¡
        boolean orderOk = checkService(orderService);
        log.info("è®¢å•æœåŠ¡çŠ¶æ€: {}", orderOk ? "æ­£å¸¸" : "å¼‚å¸¸");
        
        // æ£€æŸ¥æ”¯ä»˜æœåŠ¡
        boolean paymentOk = checkService(paymentService);
        log.info("æ”¯ä»˜æœåŠ¡çŠ¶æ€: {}", paymentOk ? "æ­£å¸¸" : "å¼‚å¸¸");
        
        // å¦‚æœæœåŠ¡å¼‚å¸¸ï¼Œå‘é€å‘Šè­¦
        if (!orderOk || !paymentOk) {
            sendAlert("æœåŠ¡å¼‚å¸¸å‘Šè­¦");
        }
    }
    
    private boolean checkService(Object service) {
        try {
            EchoService echo = (EchoService) service;
            Object result = echo.$echo("ping");
            return "ping".equals(result);
        } catch (Exception e) {
            return false;
        }
    }
}
```

**ä½¿ç”¨åœºæ™¯æ€»ç»“**
```
âœ… é€‚ç”¨åœºæ™¯ï¼š
â€¢ æœåŠ¡å¯åŠ¨åçš„è¿é€šæ€§æµ‹è¯•
â€¢ å®šæœŸå¥åº·æ£€æŸ¥
â€¢ æœåŠ¡é™çº§å‰çš„å¯ç”¨æ€§åˆ¤æ–­
â€¢ è´Ÿè½½å‡è¡¡å‰çš„æœåŠ¡ç­›é€‰

ğŸ’¡ ä¼˜åŠ¿ï¼š
â€¢ ä¸å½±å“ä¸šåŠ¡é€»è¾‘
â€¢ å¿«é€Ÿåˆ¤æ–­æœåŠ¡çŠ¶æ€
â€¢ æ‰€æœ‰æœåŠ¡è‡ªåŠ¨æ”¯æŒ
â€¢ ç½‘ç»œå±‚é¢çš„æ£€æµ‹
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


**æœåŠ¡æ¶ˆè´¹è€…å…³é”®çŸ¥è¯†ç‚¹**
```
ğŸ”¸ @Referenceæ³¨è§£ï¼šè¿œç¨‹æœåŠ¡çš„"é¥æ§å™¨"
ğŸ”¸ æœåŠ¡å¼•ç”¨ï¼šä»æ³¨å†Œä¸­å¿ƒè®¢é˜…æœåŠ¡åœ°å€
ğŸ”¸ ä»£ç†æœºåˆ¶ï¼šè®©è¿œç¨‹è°ƒç”¨åƒæœ¬åœ°è°ƒç”¨ä¸€æ ·ç®€å•
ğŸ”¸ è¶…æ—¶æ§åˆ¶ï¼šé˜²æ­¢æ— é™ç­‰å¾…ï¼Œå¿«é€Ÿå¤±è´¥
ğŸ”¸ é‡è¯•æœºåˆ¶ï¼šæé«˜æˆåŠŸç‡ï¼Œæ³¨æ„å¹‚ç­‰æ€§
ğŸ”¸ å¼‚æ­¥è°ƒç”¨ï¼šæå‡æ€§èƒ½ï¼Œå¹¶è¡Œå¤„ç†
ğŸ”¸ æ³›åŒ–è°ƒç”¨ï¼šæ— éœ€æ¥å£ï¼ŒåŠ¨æ€è°ƒç”¨
ğŸ”¸ å›å£°æµ‹è¯•ï¼šå¿«é€Ÿæ£€æµ‹æœåŠ¡å¯ç”¨æ€§
```

### 9.2 é…ç½®æœ€ä½³å®è·µ


**æ¨èé…ç½®æ¨¡æ¿**
```java
// æ ¸å¿ƒä¸šåŠ¡æœåŠ¡
@Reference(
    version = "1.0.0",
    timeout = 3000,
    retries = 2,
    loadbalance = "roundrobin",
    cluster = "failover",
    check = true
)
private CoreService coreService;

// æŸ¥è¯¢ç±»æœåŠ¡
@Reference(
    timeout = 1000,
    retries = 1,
    loadbalance = "leastactive",
    cluster = "failfast"
)
private QueryService queryService;

// éå¹‚ç­‰æœåŠ¡
@Reference(
    timeout = 5000,
    retries = 0,
    cluster = "failfast"
)
private TransactionService transactionService;
```

### 9.3 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


| é—®é¢˜ç°è±¡ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
|----------|----------|----------|
| **å¯åŠ¨æŠ¥é”™æ‰¾ä¸åˆ°æœåŠ¡** | `æä¾›è€…æœªå¯åŠ¨æˆ–æœªæ³¨å†Œ` | `è®¾ç½® check=false` |
| **è°ƒç”¨è¶…æ—¶** | `timeoutè®¾ç½®å¤ªçŸ­` | `å¢åŠ è¶…æ—¶æ—¶é—´æˆ–ä¼˜åŒ–æä¾›è€…æ€§èƒ½` |
| **é‡å¤æ‰£æ¬¾** | `éå¹‚ç­‰æ“ä½œè®¾ç½®äº†é‡è¯•` | `retries=0 å…³é—­é‡è¯•` |
| **æ€§èƒ½æ…¢** | `ä¸²è¡Œè°ƒç”¨å¤šä¸ªæœåŠ¡` | `ä½¿ç”¨å¼‚æ­¥è°ƒç”¨å¹¶è¡Œå¤„ç†` |
| **æ¥å£ä¾èµ–é—®é¢˜** | `éœ€è¦å¼•å…¥å¾ˆå¤šæ¥å£åŒ…` | `ä½¿ç”¨æ³›åŒ–è°ƒç”¨` |

### 9.4 å®æˆ˜å¼€å‘å»ºè®®


**å¼€å‘æµç¨‹**
```
ç¬¬1æ­¥ï¼šå®šä¹‰æœåŠ¡æ¥å£ï¼ˆæˆ–è·å–æä¾›è€…çš„æ¥å£ï¼‰
    â†“
ç¬¬2æ­¥ï¼šæ·»åŠ @Referenceæ³¨è§£å¼•ç”¨æœåŠ¡
    â†“
ç¬¬3æ­¥ï¼šé…ç½®è¶…æ—¶ã€é‡è¯•ç­‰å‚æ•°
    â†“
ç¬¬4æ­¥ï¼šç¼–å†™ä¸šåŠ¡é€»è¾‘ä»£ç 
    â†“
ç¬¬5æ­¥ï¼šæµ‹è¯•éªŒè¯ï¼ˆåŒ…æ‹¬å¼‚å¸¸æƒ…å†µï¼‰
    â†“
ç¬¬6æ­¥ï¼šç›‘æ§å’Œä¼˜åŒ–
```

**æ ¸å¿ƒè®°å¿†å£è¯€**
```
æ¶ˆè´¹æœåŠ¡ç”¨Referenceï¼Œ
è¶…æ—¶é‡è¯•è¦é…æ¸…ï¼Œ
æŸ¥è¯¢å¯é‡éå¹‚ä¸ï¼Œ
å¼‚æ­¥è°ƒç”¨ææ€§èƒ½ï¼Œ
æ³›åŒ–è°ƒç”¨å¾ˆçµæ´»ï¼Œ
å›å£°æµ‹è¯•ä¿å¥åº·ã€‚
```

### 9.5 è¿›é˜¶å­¦ä¹ æ–¹å‘


**ä¸‹ä¸€æ­¥å­¦ä¹ é‡ç‚¹**
```
âœ… å·²æŒæ¡ï¼šæœåŠ¡æ¶ˆè´¹åŸºç¡€
    â†“
ğŸ“š å»ºè®®å­¦ä¹ ï¼š
â€¢ é›†ç¾¤å®¹é”™ç­–ç•¥è¯¦è§£
â€¢ è´Ÿè½½å‡è¡¡ç®—æ³•é€‰æ‹©
â€¢ æœåŠ¡é™çº§ä¸ç†”æ–­
â€¢ åˆ†å¸ƒå¼äº‹åŠ¡å¤„ç†
â€¢ æœåŠ¡ç›‘æ§ä¸é“¾è·¯è¿½è¸ª
```