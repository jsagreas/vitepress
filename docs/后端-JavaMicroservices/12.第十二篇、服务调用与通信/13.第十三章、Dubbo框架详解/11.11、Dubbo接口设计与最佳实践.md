---
title: 11ã€Dubboæ¥å£è®¾è®¡ä¸æœ€ä½³å®è·µ
---
## ğŸ“š ç›®å½•

1. [æ¥å£è®¾è®¡åŸºç¡€ç†å¿µ](#1-æ¥å£è®¾è®¡åŸºç¡€ç†å¿µ)
2. [æ¥å£æŠ½è±¡è®¾è®¡åŸåˆ™](#2-æ¥å£æŠ½è±¡è®¾è®¡åŸåˆ™)
3. [å‚æ•°ä¸è¿”å›å€¼è®¾è®¡](#3-å‚æ•°ä¸è¿”å›å€¼è®¾è®¡)
4. [å¼‚å¸¸å¤„ç†æœºåˆ¶](#4-å¼‚å¸¸å¤„ç†æœºåˆ¶)
5. [ç‰ˆæœ¬å…¼å®¹ä¸æ¼”åŒ–](#5-ç‰ˆæœ¬å…¼å®¹ä¸æ¼”åŒ–)
6. [åºåˆ—åŒ–ä¼˜åŒ–ç­–ç•¥](#6-åºåˆ—åŒ–ä¼˜åŒ–ç­–ç•¥)
7. [æ¥å£åˆ†ç¦»ä¸å¹‚ç­‰æ€§](#7-æ¥å£åˆ†ç¦»ä¸å¹‚ç­‰æ€§)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ æ¥å£è®¾è®¡åŸºç¡€ç†å¿µ


### 1.1 ä»€ä¹ˆæ˜¯Dubboæ¥å£


**é€šä¿—ç†è§£**ï¼šDubboæ¥å£å°±åƒæ˜¯ä¸¤ä¸ªäººä¹‹é—´çš„"å¯¹è¯åè®®"

```
ç°å®åœºæ™¯ç±»æ¯”ï¼š
ä½ å»é¤å…ç‚¹é¤ï¼š
- æ¥å£ = èœå•ï¼ˆè§„å®šäº†èƒ½ç‚¹ä»€ä¹ˆèœï¼‰
- å‚æ•° = ä½ çš„ç‚¹èœéœ€æ±‚ï¼ˆå‡ ä»½ã€ä»€ä¹ˆå£å‘³ï¼‰
- è¿”å›å€¼ = æœåŠ¡å‘˜ç»™ä½ ç«¯ä¸Šçš„èœ

Dubboæ¥å£ï¼š
- æœåŠ¡æä¾›è€… = é¤å…å¨æˆ¿ï¼ˆæä¾›æœåŠ¡ï¼‰
- æœåŠ¡æ¶ˆè´¹è€… = é¡¾å®¢ï¼ˆä½¿ç”¨æœåŠ¡ï¼‰
- æ¥å£å®šä¹‰ = èœå•ï¼ˆåŒæ–¹çº¦å®šçš„è§„èŒƒï¼‰
```

**æ ¸å¿ƒä½œç”¨**ï¼š
- ğŸ”¸ **è§£è€¦åˆ**ï¼šæ¶ˆè´¹è€…ä¸éœ€è¦çŸ¥é“æä¾›è€…çš„å…·ä½“å®ç°
- ğŸ”¸ **æ ‡å‡†åŒ–**ï¼šç»Ÿä¸€çš„æœåŠ¡è°ƒç”¨è§„èŒƒ
- ğŸ”¸ **å¯æ›¿æ¢**ï¼šå®ç°å¯ä»¥éšæ—¶æ›´æ¢ï¼Œæ¥å£ä¿æŒä¸å˜

### 1.2 Dubboæ¥å£ä¸æ™®é€šJavaæ¥å£çš„åŒºåˆ«


| å¯¹æ¯”ç»´åº¦ | **æ™®é€šJavaæ¥å£** | **DubboæœåŠ¡æ¥å£** |
|---------|----------------|------------------|
| ğŸ”¸ **è°ƒç”¨æ–¹å¼** | `æœ¬åœ°æ–¹æ³•è°ƒç”¨` | `ç½‘ç»œè¿œç¨‹è°ƒç”¨` |
| ğŸ”¸ **æ€§èƒ½è€ƒè™‘** | `å‡ ä¹æ— å¼€é”€` | `éœ€è¦è€ƒè™‘ç½‘ç»œä¼ è¾“` |
| ğŸ”¸ **å‚æ•°è®¾è®¡** | `å¯ä»¥éšæ„è®¾è®¡` | `å¿…é¡»å¯åºåˆ—åŒ–` |
| ğŸ”¸ **å¼‚å¸¸å¤„ç†** | `æœ¬åœ°å¼‚å¸¸å³å¯` | `éœ€è¦åŒºåˆ†ä¸šåŠ¡å’Œç½‘ç»œå¼‚å¸¸` |
| ğŸ”¸ **ç‰ˆæœ¬ç®¡ç†** | `ä¸å¤ªéœ€è¦è€ƒè™‘` | `å¿…é¡»è€ƒè™‘å…¼å®¹æ€§` |

**å…³é”®ç†è§£**ï¼š
```
æ™®é€šæ¥å£è°ƒç”¨ï¼š
UserService service = new UserServiceImpl();
User user = service.getUser(123);  // ç›´æ¥åœ¨æœ¬åœ°JVMå†…è°ƒç”¨

Dubboæ¥å£è°ƒç”¨ï¼š
UserService service = // Dubboä»£ç†å¯¹è±¡
User user = service.getUser(123);  
// å®é™…ç»å†ï¼šåºåˆ—åŒ– â†’ ç½‘ç»œä¼ è¾“ â†’ ååºåˆ—åŒ– â†’ è¿œç¨‹æ‰§è¡Œ â†’ è¿”å›
```

### 1.3 è®¾è®¡æ¥å£æ—¶çš„æ ¸å¿ƒæ€ç»´


**ğŸ”¹ è¿œç¨‹è°ƒç”¨æ€ç»´**
```
æœ¬åœ°è°ƒç”¨ï¼šé€Ÿåº¦å¿«ï¼Œéšä¾¿è®¾è®¡
è¿œç¨‹è°ƒç”¨ï¼šé€Ÿåº¦æ…¢ï¼Œå¿…é¡»ç²¾å¿ƒè®¾è®¡

ä¸¾ä¾‹è¯´æ˜ï¼š
âŒ ä¸å¥½çš„è®¾è®¡ï¼ˆé¢‘ç¹è°ƒç”¨ï¼‰ï¼š
for(int i=0; i<1000; i++) {
    User user = userService.getUser(i);  // è°ƒç”¨1000æ¬¡ç½‘ç»œè¯·æ±‚ï¼
}

âœ… å¥½çš„è®¾è®¡ï¼ˆæ‰¹é‡è°ƒç”¨ï¼‰ï¼š
List<Integer> ids = Arrays.asList(1,2,3...1000);
List<User> users = userService.batchGetUsers(ids);  // åªè°ƒç”¨1æ¬¡ï¼
```

**ğŸ”¹ ç¨³å®šæ€§ä¼˜å…ˆæ€ç»´**
```
æ¥å£ä¸€æ—¦å‘å¸ƒï¼Œä¿®æ”¹æˆæœ¬æé«˜ï¼š
- æä¾›è€…æ”¹äº†ï¼Œæ¶ˆè´¹è€…å¿…é¡»åŒæ­¥æ›´æ–°
- å¯èƒ½æœ‰å‡ åä¸ªæ¶ˆè´¹è€…åœ¨ç”¨ä½ çš„æ¥å£
- æ¥å£è®¾è®¡è¦è€ƒè™‘æœªæ¥1-2å¹´çš„å˜åŒ–
```

---

## 2. ğŸ“ æ¥å£æŠ½è±¡è®¾è®¡åŸåˆ™


### 2.1 å•ä¸€èŒè´£åŸåˆ™


**é€šä¿—è§£é‡Š**ï¼šä¸€ä¸ªæ¥å£åªåšä¸€ä»¶äº‹ï¼Œå°±åƒä¸€ä¸ªäººåªè´Ÿè´£ä¸€ä¸ªå²—ä½

**é”™è¯¯ç¤ºä¾‹**ï¼š
```java
// âŒ å¤§æ‚çƒ©æ¥å£ï¼ˆä»€ä¹ˆéƒ½å¹²ï¼‰
public interface UserService {
    User getUser(Long id);           // ç”¨æˆ·æŸ¥è¯¢
    void saveUser(User user);        // ç”¨æˆ·ä¿å­˜
    Order getOrder(Long orderId);    // è®¢å•æŸ¥è¯¢ï¼Ÿï¼Ÿ
    void sendEmail(String email);    // å‘é‚®ä»¶ï¼Ÿï¼Ÿ
}
```

**æ­£ç¡®ç¤ºä¾‹**ï¼š
```java
// âœ… èŒè´£æ¸…æ™°çš„æ¥å£
public interface UserService {
    User getUser(Long id);
    void saveUser(User user);
    void updateUser(User user);
}

public interface OrderService {
    Order getOrder(Long orderId);
    void createOrder(Order order);
}

public interface NotificationService {
    void sendEmail(String email, String content);
    void sendSms(String phone, String content);
}
```

**ä¸ºä»€ä¹ˆè¦è¿™æ ·**ï¼š
- æ¥å£æ¸…æ™°ï¼Œæ¶ˆè´¹è€…ä¸€çœ‹å°±çŸ¥é“æ˜¯å¹²ä»€ä¹ˆçš„
- ä¿®æ”¹ä¸€ä¸ªåŠŸèƒ½ä¸ä¼šå½±å“å…¶ä»–åŠŸèƒ½
- å›¢é˜Ÿåä½œæ—¶èŒè´£åˆ†æ˜

### 2.2 æ¥å£ç²’åº¦æ§åˆ¶


**ç²’åº¦åŸåˆ™**ï¼šä¸è¦å¤ªç²—ï¼ˆä¸€ä¸ªæ–¹æ³•å¹²å¤ªå¤šäº‹ï¼‰ï¼Œä¹Ÿä¸è¦å¤ªç»†ï¼ˆä¸€ä¸ªæ–¹æ³•å¹²å¤ªå°‘äº‹ï¼‰

```
æ¥å£ç²’åº¦å¯¹æ¯”ï¼š

âŒ ç²’åº¦å¤ªç»†ï¼ˆæ•ˆç‡ä½ä¸‹ï¼‰ï¼š
UserService.getUserName(Long id);     // ç¬¬1æ¬¡ç½‘ç»œè°ƒç”¨
UserService.getUserAge(Long id);      // ç¬¬2æ¬¡ç½‘ç»œè°ƒç”¨  
UserService.getUserEmail(Long id);    // ç¬¬3æ¬¡ç½‘ç»œè°ƒç”¨
â†’ ç½‘ç»œè°ƒç”¨3æ¬¡ï¼Œå¤ªæµªè´¹äº†ï¼

âŒ ç²’åº¦å¤ªç²—ï¼ˆä¸çµæ´»ï¼‰ï¼š
UserService.getAllUserInfo(Long id);  // è¿”å›100ä¸ªå­—æ®µ
â†’ æˆ‘åªè¦å§“åï¼Œå´ä¼ è¾“äº†100ä¸ªå­—æ®µçš„æ•°æ®ï¼

âœ… ç²’åº¦åˆé€‚ï¼ˆæŒ‰åœºæ™¯è®¾è®¡ï¼‰ï¼š
UserService.getUserBasicInfo(Long id);     // åŸºç¡€ä¿¡æ¯ï¼šå§“åã€å¹´é¾„
UserService.getUserDetailInfo(Long id);    // è¯¦ç»†ä¿¡æ¯ï¼šåŒ…å«æ‰€æœ‰å­—æ®µ
UserService.batchGetUsers(List<Long> ids); // æ‰¹é‡æŸ¥è¯¢
```

**è®¾è®¡å»ºè®®**ï¼š
- ğŸŸ¢ **å¸¸ç”¨åœºæ™¯**ï¼šè®¾è®¡ä¸“é—¨çš„æ–¹æ³•
- ğŸŸ¡ **æŸ¥è¯¢åœºæ™¯**ï¼šæä¾›åŸºç¡€ç‰ˆå’Œè¯¦ç»†ç‰ˆ
- ğŸ”´ **æ‰¹é‡æ“ä½œ**ï¼šå¿…é¡»æä¾›æ‰¹é‡æ¥å£

### 2.3 é¢å‘æ¥å£è€Œéå®ç°


**æ ¸å¿ƒæ€æƒ³**ï¼šæ¥å£å®šä¹‰"åšä»€ä¹ˆ"ï¼Œå®ç°å†³å®š"æ€ä¹ˆåš"

```
æ¥å£å®šä¹‰ç»“æ„ï¼š

é¡¹ç›®ç»“æ„ï¼š
dubbo-api/          â† æ¥å£å®šä¹‰æ¨¡å—ï¼ˆç‹¬ç«‹ï¼‰
  â””â”€â”€ UserService.java
  
dubbo-provider/     â† æœåŠ¡æä¾›è€…
  â””â”€â”€ UserServiceImpl.java
  
dubbo-consumer/     â† æœåŠ¡æ¶ˆè´¹è€…
  â””â”€â”€ åªä¾èµ– dubbo-api

ä¸ºä»€ä¹ˆè¦ç‹¬ç«‹ï¼š
```

**ä¾èµ–å…³ç³»å›¾**ï¼š
```
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  dubbo-api  â”‚  â† æ¥å£å®šä¹‰ï¼ˆæœ€ç¨³å®šï¼‰
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†‘   â†‘
              â”‚   â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Provider  â”‚         â”‚ Consumer  â”‚
â”‚ (å®ç°è€…)   â”‚         â”‚ (è°ƒç”¨è€…)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®é™…å¥½å¤„**ï¼š
- æ¶ˆè´¹è€…åªéœ€è¦ä¾èµ–APIåŒ…ï¼Œä¸éœ€è¦çŸ¥é“å®ç°ç»†èŠ‚
- æä¾›è€…å¯ä»¥éšæ„æ›´æ¢å®ç°æ–¹å¼
- å¤šä¸ªæä¾›è€…å¯ä»¥å®ç°åŒä¸€ä¸ªæ¥å£

---

## 3. ğŸ“¦ å‚æ•°ä¸è¿”å›å€¼è®¾è®¡


### 3.1 å‚æ•°ä¼ é€’è§„èŒƒ


**ğŸ”¸ åŸºæœ¬åŸåˆ™**ï¼šå‚æ•°å¿…é¡»å¯åºåˆ—åŒ–

```java
// âœ… æ­£ç¡®çš„å‚æ•°ç±»å‹ï¼ˆå¯åºåˆ—åŒ–ï¼‰
public interface UserService {
    // åŸºæœ¬ç±»å‹ï¼šç›´æ¥å¯ç”¨
    User getUser(Long id);
    
    // è‡ªå®šä¹‰å¯¹è±¡ï¼šå¿…é¡»å®ç°Serializable
    void saveUser(UserDTO userDTO);
    
    // é›†åˆç±»å‹ï¼šå…ƒç´ å¿…é¡»å¯åºåˆ—åŒ–
    List<User> batchGetUsers(List<Long> ids);
}

// âŒ é”™è¯¯çš„å‚æ•°ç±»å‹
public interface BadService {
    // ä¸è¦ä¼ é€’HttpServletRequestè¿™ç§ä¸å¯åºåˆ—åŒ–çš„å¯¹è±¡
    void process(HttpServletRequest request);  âŒ
    
    // ä¸è¦ä¼ é€’InputStreamç­‰IOæµ
    void upload(InputStream file);  âŒ
}
```

**å‚æ•°å¯¹è±¡è®¾è®¡æœ€ä½³å®è·µ**ï¼š

```java
// âœ… æ¨èï¼šä½¿ç”¨DTOï¼ˆæ•°æ®ä¼ è¾“å¯¹è±¡ï¼‰
public class UserQueryDTO implements Serializable {
    private Long id;
    private String name;
    private Integer minAge;
    private Integer maxAge;
    
    // getter/setter...
}

public interface UserService {
    List<User> queryUsers(UserQueryDTO query);
}

// å¥½å¤„ï¼š
// 1. å‚æ•°æ¸…æ™°ï¼Œæ˜“äºç†è§£
// 2. æ–¹ä¾¿æ‰©å±•ï¼ˆåŠ å­—æ®µä¸å½±å“æ–¹æ³•ç­¾åï¼‰
// 3. å¯ä»¥ç»Ÿä¸€åšå‚æ•°æ ¡éªŒ
```

### 3.2 å‚æ•°æ•°é‡æ§åˆ¶


**åŸåˆ™**ï¼šå‚æ•°ä¸è¦è¶…è¿‡5ä¸ªï¼Œæœ€å¥½ç”¨å¯¹è±¡å°è£…

```java
// âŒ å‚æ•°å¤ªå¤šï¼ˆéš¾ä»¥ç»´æŠ¤ï¼‰
User queryUser(String name, Integer age, String city, 
               String phone, String email, Integer status);

// âœ… ç”¨å¯¹è±¡å°è£…ï¼ˆæ¸…æ™°æ˜“ç»´æŠ¤ï¼‰
User queryUser(UserQuery query);

// UserQueryç±»ï¼š
class UserQuery implements Serializable {
    private String name;
    private Integer age;
    private String city;
    private String phone;
    private String email;
    private Integer status;
}
```

**ä¸ºä»€ä¹ˆè¦é™åˆ¶å‚æ•°æ•°é‡**ï¼š
- å‚æ•°å¤ªå¤šå®¹æ˜“ä¼ é”™é¡ºåº
- å°†æ¥åŠ å‚æ•°éœ€è¦æ”¹æ‰€æœ‰è°ƒç”¨æ–¹
- ç”¨å¯¹è±¡å°è£…æ–¹ä¾¿æ‰©å±•

### 3.3 è¿”å›å€¼è®¾è®¡åŸåˆ™


**ğŸ”¹ ç»Ÿä¸€è¿”å›ç»“æœå°è£…**

```java
// âœ… æ¨èï¼šç»Ÿä¸€çš„è¿”å›åŒ…è£…ç±»
public class Result<T> implements Serializable {
    private boolean success;    // æ˜¯å¦æˆåŠŸ
    private String code;        // ä¸šåŠ¡çŠ¶æ€ç 
    private String message;     // æç¤ºä¿¡æ¯
    private T data;            // è¿”å›æ•°æ®
    
    // æˆåŠŸè¿”å›
    public static <T> Result<T> success(T data) {
        Result<T> result = new Result<>();
        result.setSuccess(true);
        result.setData(data);
        return result;
    }
    
    // å¤±è´¥è¿”å›
    public static <T> Result<T> fail(String code, String message) {
        Result<T> result = new Result<>();
        result.setSuccess(false);
        result.setCode(code);
        result.setMessage(message);
        return result;
    }
}

// æ¥å£ä½¿ç”¨
public interface UserService {
    Result<User> getUser(Long id);
    Result<List<User>> queryUsers(UserQuery query);
}
```

**ä½¿ç”¨ç»Ÿä¸€è¿”å›çš„å¥½å¤„**ï¼š
```
æ¶ˆè´¹è€…è°ƒç”¨ç¤ºä¾‹ï¼š
Result<User> result = userService.getUser(123L);

if(result.isSuccess()) {
    User user = result.getData();  // è·å–æ•°æ®
} else {
    log.error("è°ƒç”¨å¤±è´¥: {}", result.getMessage());
}

ä¼˜ç‚¹ï¼š
âœ… è°ƒç”¨æ–¹å¯ä»¥æ˜ç¡®çŸ¥é“æˆåŠŸè¿˜æ˜¯å¤±è´¥
âœ… å¤±è´¥æ—¶èƒ½æ‹¿åˆ°è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
âœ… ä¸šåŠ¡å¼‚å¸¸å’Œç³»ç»Ÿå¼‚å¸¸å¯ä»¥åŒºåˆ†å¤„ç†
```

### 3.4 è¿”å›å€¼ç±»å‹é€‰æ‹©


| åœºæ™¯ | **æ¨èè¿”å›ç±»å‹** | **è¯´æ˜** |
|-----|----------------|---------|
| ğŸ”¸ **å•ä¸ªå¯¹è±¡** | `Result<User>` | å¯èƒ½ä¸ºnullè¦æ˜ç¡®æ ‡è¯† |
| ğŸ”¸ **åˆ—è¡¨æ•°æ®** | `Result<List<User>>` | ç©ºåˆ—è¡¨è¿”å›ç©ºListä¸è¦null |
| ğŸ”¸ **åˆ†é¡µæ•°æ®** | `Result<PageData<User>>` | åŒ…å«æ€»æ•°å’Œæ•°æ®åˆ—è¡¨ |
| ğŸ”¸ **ç®€å•æ“ä½œ** | `Result<Boolean>` | å¢åˆ æ”¹æ“ä½œ |
| ğŸ”¸ **è®¡æ•°ç»Ÿè®¡** | `Result<Long>` | è¿”å›æ•°é‡ |

**åˆ†é¡µè¿”å›ç¤ºä¾‹**ï¼š
```java
// åˆ†é¡µæ•°æ®å°è£…
public class PageData<T> implements Serializable {
    private Long total;        // æ€»è®°å½•æ•°
    private List<T> records;   // å½“å‰é¡µæ•°æ®
    private Integer pageNum;   // å½“å‰é¡µç 
    private Integer pageSize;  // æ¯é¡µå¤§å°
}

// æ¥å£å®šä¹‰
public interface UserService {
    Result<PageData<User>> queryUserPage(UserQuery query);
}
```

---

## 4. âš ï¸ å¼‚å¸¸å¤„ç†æœºåˆ¶


### 4.1 å¼‚å¸¸åˆ†ç±»ç†è§£


**Dubboä¸­çš„å¼‚å¸¸åˆ†ä¸¤å¤§ç±»**ï¼š

```
å¼‚å¸¸åˆ†ç±»æ ‘ï¼š
                 å¼‚å¸¸
                /    \
            ä¸šåŠ¡å¼‚å¸¸   ç³»ç»Ÿå¼‚å¸¸
           /          \
    ç”¨æˆ·ä¸å­˜åœ¨      ç½‘ç»œè¶…æ—¶
    ä½™é¢ä¸è¶³        æœåŠ¡å®•æœº
    æƒé™ä¸è¶³        åºåˆ—åŒ–å¤±è´¥
```

**ä¸šåŠ¡å¼‚å¸¸**ï¼šå¯ä»¥é¢„æœŸçš„ã€æ­£å¸¸çš„ä¸šåŠ¡åœºæ™¯
- ç”¨æˆ·ä¸å­˜åœ¨
- ä½™é¢ä¸è¶³
- æƒé™ä¸å¤Ÿ
- æ•°æ®å·²å­˜åœ¨

**ç³»ç»Ÿå¼‚å¸¸**ï¼šä¸å¯é¢„æœŸçš„ã€æŠ€æœ¯å±‚é¢çš„å¼‚å¸¸
- ç½‘ç»œè¶…æ—¶
- æœåŠ¡ä¸å¯ç”¨
- æ•°æ®åº“è¿æ¥å¤±è´¥
- åºåˆ—åŒ–å¼‚å¸¸

### 4.2 å¼‚å¸¸å¤„ç†ç­–ç•¥


**ğŸ”¹ ä¸šåŠ¡å¼‚å¸¸å¤„ç†**

```java
// æ–¹å¼1ï¼šé€šè¿‡è¿”å›å€¼æ ‡è¯†ï¼ˆæ¨èï¼‰
public Result<User> getUser(Long id) {
    User user = userDao.findById(id);
    if(user == null) {
        return Result.fail("USER_NOT_FOUND", "ç”¨æˆ·ä¸å­˜åœ¨");
    }
    return Result.success(user);
}

// æ–¹å¼2ï¼šè‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸
public class BizException extends RuntimeException {
    private String code;
    
    public BizException(String code, String message) {
        super(message);
        this.code = code;
    }
}

public User getUser(Long id) {
    User user = userDao.findById(id);
    if(user == null) {
        throw new BizException("USER_NOT_FOUND", "ç”¨æˆ·ä¸å­˜åœ¨");
    }
    return user;
}
```

**æ¨èåšæ³•å¯¹æ¯”**ï¼š

| æ–¹å¼ | **ä¼˜ç‚¹** | **ç¼ºç‚¹** | **é€‚ç”¨åœºæ™¯** |
|-----|---------|---------|------------|
| âœ… **è¿”å›Result** | `æ¶ˆè´¹è€…æ˜ç¡®çŸ¥é“æˆåŠŸå¤±è´¥` | `ä»£ç ç¨å¾®ç¹ç` | `å¤§éƒ¨åˆ†ä¸šåŠ¡åœºæ™¯` |
| âš ï¸ **æŠ›å¼‚å¸¸** | `ä»£ç ç®€æ´` | `éœ€è¦æ•è·å¤„ç†` | `ä¸¥é‡é”™è¯¯åœºæ™¯` |

### 4.3 ç³»ç»Ÿå¼‚å¸¸å¤„ç†


**å…³é”®åŸåˆ™**ï¼šç³»ç»Ÿå¼‚å¸¸ä¸è¦ç›´æ¥æš´éœ²ç»™æ¶ˆè´¹è€…

```java
// âŒ ä¸å¥½çš„åšæ³•
public User getUser(Long id) {
    // æ•°æ®åº“å¼‚å¸¸ç›´æ¥æŠ›å‡ºï¼Œæ¶ˆè´¹è€…æ”¶åˆ°å¾ˆéš¾å¤„ç†
    return userDao.findById(id);  
}

// âœ… å¥½çš„åšæ³•
public Result<User> getUser(Long id) {
    try {
        User user = userDao.findById(id);
        return Result.success(user);
    } catch (Exception e) {
        log.error("æŸ¥è¯¢ç”¨æˆ·å¼‚å¸¸, id={}", id, e);
        return Result.fail("SYSTEM_ERROR", "ç³»ç»Ÿå¼‚å¸¸ï¼Œè¯·ç¨åé‡è¯•");
    }
}
```

**å¼‚å¸¸å¤„ç†æœ€ä½³å®è·µ**ï¼š
```
å¤„ç†æµç¨‹ï¼š
1. æ•è·å¼‚å¸¸ â†’ è®°å½•è¯¦ç»†æ—¥å¿—
2. è½¬æ¢å¼‚å¸¸ â†’ è¿”å›å‹å¥½æç¤º
3. åŒºåˆ†ç±»å‹ â†’ ä¸šåŠ¡å¼‚å¸¸å’Œç³»ç»Ÿå¼‚å¸¸åˆ†å¼€å¤„ç†

æ—¥å¿—è®°å½•è¦ç‚¹ï¼š
âœ… è®°å½•å…³é”®å‚æ•°ï¼šæ–¹ä¾¿é—®é¢˜æ’æŸ¥
âœ… è®°å½•å¼‚å¸¸å †æ ˆï¼šå®šä½é—®é¢˜æ ¹æº
âœ… è„±æ•å¤„ç†ï¼šä¸è®°å½•æ•æ„Ÿä¿¡æ¯
```

### 4.4 å¼‚å¸¸ä¼ æ’­æœºåˆ¶


**ç†è§£Dubboå¼‚å¸¸ä¼ æ’­**ï¼š

```
è°ƒç”¨é“¾è·¯ï¼š
Consumer â†’ [ç½‘ç»œ] â†’ Provider
   â†‘                    â†“
   â””â”€â”€â”€â”€â”€â”€ å¼‚å¸¸ä¼ é€’ â”€â”€â”€â”€â”€â”€â”˜

å¼‚å¸¸ä¼ é€’è§„åˆ™ï¼š
1. RuntimeExceptionä¼šç›´æ¥ä¼ é€’ç»™æ¶ˆè´¹è€…
2. è‡ªå®šä¹‰å¼‚å¸¸éœ€è¦åœ¨APIåŒ…ä¸­å®šä¹‰
3. æ£€æŸ¥å¼‚å¸¸ä¼šè¢«åŒ…è£…æˆRuntimeException
```

**ç¤ºä¾‹è¯´æ˜**ï¼š
```java
// APIåŒ…ä¸­å®šä¹‰å¼‚å¸¸ï¼ˆæ¶ˆè´¹è€…å’Œæä¾›è€…éƒ½èƒ½è¯†åˆ«ï¼‰
public class UserNotFoundException extends RuntimeException {
    public UserNotFoundException(String message) {
        super(message);
    }
}

// ProvideræŠ›å‡º
public User getUser(Long id) {
    User user = userDao.findById(id);
    if(user == null) {
        throw new UserNotFoundException("ç”¨æˆ·ä¸å­˜åœ¨: " + id);
    }
    return user;
}

// Consumeræ•è·
try {
    User user = userService.getUser(123L);
} catch (UserNotFoundException e) {
    // å¯ä»¥æ˜ç¡®çŸ¥é“æ˜¯ç”¨æˆ·ä¸å­˜åœ¨
    log.warn("ç”¨æˆ·ä¸å­˜åœ¨: {}", e.getMessage());
}
```

---

## 5. ğŸ”„ ç‰ˆæœ¬å…¼å®¹ä¸æ¼”åŒ–


### 5.1 ä¸ºä»€ä¹ˆè¦è€ƒè™‘ç‰ˆæœ¬å…¼å®¹


**ç°å®åœºæ™¯**ï¼š
```
ä½ çš„æœåŠ¡æœ‰10ä¸ªæ¶ˆè´¹è€…åœ¨ä½¿ç”¨ï¼š
â”œâ”€â”€ ç”µå•†ç³»ç»Ÿ
â”œâ”€â”€ è®¢å•ç³»ç»Ÿ  
â”œâ”€â”€ åº“å­˜ç³»ç»Ÿ
â”œâ”€â”€ ...
â””â”€â”€ ç¬¬ä¸‰æ–¹åˆä½œç³»ç»Ÿ

å¦‚æœä½ æ”¹äº†æ¥å£ï¼š
âŒ æ‰€æœ‰æ¶ˆè´¹è€…å¿…é¡»åŒæ—¶å‡çº§ï¼ˆå‡ ä¹ä¸å¯èƒ½ï¼‰
âœ… ä¿æŒå…¼å®¹æ€§ï¼Œæ¶ˆè´¹è€…å¯ä»¥é€æ­¥å‡çº§
```

### 5.2 ç‰ˆæœ¬æ¼”åŒ–ç­–ç•¥


**ğŸ”¹ æ–°å¢å­—æ®µï¼ˆå‘åå…¼å®¹ï¼‰**

```java
// ç‰ˆæœ¬1.0ï¼ˆåˆå§‹ç‰ˆæœ¬ï¼‰
public class UserDTO implements Serializable {
    private Long id;
    private String name;
}

// ç‰ˆæœ¬1.1ï¼ˆæ–°å¢å­—æ®µ - å…¼å®¹ï¼‰
public class UserDTO implements Serializable {
    private Long id;
    private String name;
    private Integer age;      // æ–°å¢ï¼šå¹´é¾„
    private String email;     // æ–°å¢ï¼šé‚®ç®±
}

// æ¶ˆè´¹è€…å½±å“ï¼š
æ—§æ¶ˆè´¹è€…ï¼šåªè®¤è¯†idå’Œnameï¼Œæ–°å­—æ®µè‡ªåŠ¨å¿½ç•¥ âœ…
æ–°æ¶ˆè´¹è€…ï¼šå¯ä»¥ä½¿ç”¨æ‰€æœ‰å­—æ®µ âœ…
```

**ğŸ”¹ ä¿®æ”¹å­—æ®µï¼ˆå¯èƒ½ä¸å…¼å®¹ï¼‰**

```java
// âŒ å±é™©æ“ä½œï¼šä¿®æ”¹å­—æ®µç±»å‹
public class UserDTO implements Serializable {
    private Long id;
    private String age;  // åŸæ¥æ˜¯Integerï¼Œæ”¹æˆString
}
// åæœï¼šæ—§æ¶ˆè´¹è€…ååºåˆ—åŒ–å¤±è´¥ï¼

// âœ… å®‰å…¨åšæ³•ï¼šåºŸå¼ƒæ—§å­—æ®µï¼Œæ–°å¢å­—æ®µ
public class UserDTO implements Serializable {
    private Long id;
    
    @Deprecated  // æ ‡è®°åºŸå¼ƒ
    private Integer age;
    
    private String ageStr;  // æ–°å¢å­—ç¬¦ä¸²ç±»å‹å¹´é¾„
}
```

### 5.3 æ¥å£ç‰ˆæœ¬ç®¡ç†


**Dubboç‰ˆæœ¬å·æœºåˆ¶**ï¼š

```java
// æä¾›è€…é…ç½®å¤šä¸ªç‰ˆæœ¬
@Service(version = "1.0.0")
public class UserServiceV1 implements UserService {
    public User getUser(Long id) {
        // è€ç‰ˆæœ¬å®ç°
    }
}

@Service(version = "2.0.0")
public class UserServiceV2 implements UserService {
    public User getUser(Long id) {
        // æ–°ç‰ˆæœ¬å®ç°ï¼ˆåŠ å¼ºäº†åŠŸèƒ½ï¼‰
    }
}

// æ¶ˆè´¹è€…é€‰æ‹©ç‰ˆæœ¬
@Reference(version = "1.0.0")  // ä½¿ç”¨è€ç‰ˆæœ¬
private UserService userServiceV1;

@Reference(version = "2.0.0")  // ä½¿ç”¨æ–°ç‰ˆæœ¬
private UserService userServiceV2;

@Reference(version = "*")      // éšæœºè°ƒç”¨ï¼ˆä¸æ¨èï¼‰
private UserService userService;
```

**ç‰ˆæœ¬å‡çº§æµç¨‹**ï¼š
```
æ­¥éª¤ â‘ ï¼šå‘å¸ƒæ–°ç‰ˆæœ¬æ¥å£ï¼ˆversion="2.0.0"ï¼‰
æ­¥éª¤ â‘¡ï¼šä¿æŒè€ç‰ˆæœ¬è¿è¡Œï¼ˆversion="1.0.0"ï¼‰
æ­¥éª¤ â‘¢ï¼šé€šçŸ¥æ¶ˆè´¹è€…é€æ­¥å‡çº§åˆ°æ–°ç‰ˆæœ¬
æ­¥éª¤ â‘£ï¼šæ‰€æœ‰æ¶ˆè´¹è€…å‡çº§å®Œæˆåï¼Œä¸‹çº¿è€ç‰ˆæœ¬
```

### 5.4 å…¼å®¹æ€§æ£€æŸ¥æ¸…å•


**å‘å¸ƒæ–°ç‰ˆæœ¬å‰çš„æ£€æŸ¥**ï¼š

- [ ] æ–°å¢å­—æ®µæ˜¯å¦æœ‰é»˜è®¤å€¼
- [ ] æ˜¯å¦åˆ é™¤äº†å­—æ®µï¼ˆå±é™©æ“ä½œï¼‰
- [ ] æ˜¯å¦ä¿®æ”¹äº†å­—æ®µç±»å‹ï¼ˆå±é™©æ“ä½œï¼‰
- [ ] æ˜¯å¦ä¿®æ”¹äº†æ–¹æ³•ç­¾åï¼ˆå±é™©æ“ä½œï¼‰
- [ ] è¿”å›å€¼æ˜¯å¦æ”¹å˜äº†å«ä¹‰
- [ ] å¼‚å¸¸ç±»å‹æ˜¯å¦å‘ç”Ÿå˜åŒ–

---

## 6. ğŸš€ åºåˆ—åŒ–ä¼˜åŒ–ç­–ç•¥


### 6.1 ç†è§£åºåˆ—åŒ–


**é€šä¿—è§£é‡Š**ï¼šåºåˆ—åŒ–å°±æ˜¯æŠŠå¯¹è±¡å˜æˆå¯ä»¥ä¼ è¾“çš„å­—èŠ‚æµ

```
åºåˆ—åŒ–è¿‡ç¨‹ï¼š
Javaå¯¹è±¡ â†’ [åºåˆ—åŒ–] â†’ å­—èŠ‚æ•°ç»„ â†’ [ç½‘ç»œä¼ è¾“] â†’ å­—èŠ‚æ•°ç»„ â†’ [ååºåˆ—åŒ–] â†’ Javaå¯¹è±¡

å°±åƒï¼š
å¯„å¿«é€’æ—¶æŠŠä¸œè¥¿æ‰“åŒ… â†’ è¿è¾“ â†’ åˆ°è¾¾åæ‹†åŒ…
```

### 6.2 åºåˆ—åŒ–åè®®é€‰æ‹©


**Dubboæ”¯æŒçš„åºåˆ—åŒ–æ–¹å¼**ï¼š

| åè®® | **æ€§èƒ½** | **ç©ºé—´å ç”¨** | **å…¼å®¹æ€§** | **æ¨èåœºæ™¯** |
|-----|---------|------------|-----------|------------|
| ğŸ”¸ **Hessian2** | `â­â­â­` | `â­â­â­` | `â­â­â­â­` | `é»˜è®¤é€‰æ‹©ï¼Œå¹³è¡¡æ€§å¥½` |
| ğŸ”¸ **Protobuf** | `â­â­â­â­â­` | `â­â­â­â­â­` | `â­â­` | `æ€§èƒ½è¦æ±‚æé«˜åœºæ™¯` |
| ğŸ”¸ **JSON** | `â­â­` | `â­` | `â­â­â­â­â­` | `è·¨è¯­è¨€è°ƒç”¨` |
| ğŸ”¸ **Kryo** | `â­â­â­â­` | `â­â­â­â­` | `â­â­` | `å†…éƒ¨æœåŠ¡è°ƒç”¨` |

**é…ç½®ç¤ºä¾‹**ï¼š
```xml
<!-- ä½¿ç”¨Hessian2åºåˆ—åŒ–ï¼ˆé»˜è®¤ï¼‰ -->
<dubbo:protocol name="dubbo" serialization="hessian2"/>

<!-- ä½¿ç”¨Protobufåºåˆ—åŒ–ï¼ˆé«˜æ€§èƒ½ï¼‰ -->
<dubbo:protocol name="dubbo" serialization="protobuf"/>
```

### 6.3 åºåˆ—åŒ–æ€§èƒ½ä¼˜åŒ–


**ğŸ”¹ å‡å°‘ä¼ è¾“æ•°æ®é‡**

```java
// âŒ ä¼ è¾“è¿‡å¤šæ— ç”¨æ•°æ®
public class UserVO implements Serializable {
    private Long id;
    private String name;
    private String password;      // æ•æ„Ÿä¿¡æ¯ä¸åº”è¯¥ä¼ è¾“
    private byte[] avatarData;    // å¤´åƒæ•°æ®ï¼ˆå¯èƒ½å¾ˆå¤§ï¼‰
    private List<Order> orders;   // å…³è”æ•°æ®ï¼ˆå¯èƒ½å¾ˆå¤šï¼‰
}

// âœ… æŒ‰éœ€ä¼ è¾“
public class UserBasicVO implements Serializable {
    private Long id;
    private String name;
    private String avatarUrl;     // åªä¼ URLï¼Œä¸ä¼ æ•°æ®
    // ä¸åŒ…å«æ•æ„Ÿå’Œå¤§å­—æ®µ
}

public class UserDetailVO extends UserBasicVO {
    private List<Order> recentOrders;  // åªä¼ æœ€è¿‘çš„è®¢å•
    // è¯¦ç»†ä¿¡æ¯æŒ‰éœ€åŠ è½½
}
```

**ğŸ”¹ å­—æ®µè®¾è®¡å»ºè®®**

```java
// âœ… å¥½çš„å®è·µ
public class UserDTO implements Serializable {
    
    // ä½¿ç”¨åŒ…è£…ç±»å‹ï¼ˆå¯ä»¥ä¸ºnullï¼‰
    private Long id;           // æ¨èï¼šLong
    private Integer age;       // æ¨èï¼šInteger
    
    // é¿å…ä½¿ç”¨åŸºæœ¬ç±»å‹ï¼ˆæ— æ³•ä¸ºnullï¼‰
    // private long id;        // ä¸æ¨èï¼šä¸èƒ½ä¸ºnull
    // private int age;        // ä¸æ¨èï¼šé»˜è®¤æ˜¯0
    
    // é›†åˆå­—æ®µåˆå§‹åŒ–
    private List<String> tags = new ArrayList<>();  // é¿å…null
    
    // å¤§å­—æ®µæ ‡è®°ä¸ºtransientï¼ˆä¸åºåˆ—åŒ–ï¼‰
    private transient byte[] tempData;
}
```

### 6.4 åºåˆ—åŒ–æ³¨æ„äº‹é¡¹


**å¸¸è§é—®é¢˜ä¸è§£å†³**ï¼š

```
é—®é¢˜1ï¼šserialVersionUIDç¼ºå¤±
ç°è±¡ï¼šä¿®æ”¹ç±»åååºåˆ—åŒ–å¤±è´¥
è§£å†³ï¼šæ˜¾å¼å£°æ˜serialVersionUID

public class UserDTO implements Serializable {
    private static final long serialVersionUID = 1L;  // å›ºå®šç‰ˆæœ¬å·
    // ...
}

é—®é¢˜2ï¼šå¾ªç¯ä¾èµ–
ç°è±¡ï¼šåºåˆ—åŒ–æ—¶æ ˆæº¢å‡º
è§£å†³ï¼šæ‰“æ–­å¾ªç¯å¼•ç”¨

public class User implements Serializable {
    private Long id;
    private Order order;
}

public class Order implements Serializable {
    private Long id;
    private transient User user;  // æ ‡è®°ä¸ºtransientæ‰“æ–­å¾ªç¯
}

é—®é¢˜3ï¼šæšä¸¾åºåˆ—åŒ–
æ¨èï¼šä½¿ç”¨å­—ç¬¦ä¸²æˆ–æ•°å­—ï¼Œä¸ç›´æ¥åºåˆ—åŒ–æšä¸¾

// âœ… ä½¿ç”¨å­—ç¬¦ä¸²
private String status;  // "ACTIVE", "INACTIVE"

// è€Œä¸æ˜¯
private UserStatus status;  // æšä¸¾å¯èƒ½ä¸å…¼å®¹
```

---

## 7. ğŸ¯ æ¥å£åˆ†ç¦»ä¸å¹‚ç­‰æ€§


### 7.1 æ¥å£åˆ†ç¦»åŸåˆ™


**æ ¸å¿ƒæ€æƒ³**ï¼šè¯»å†™åˆ†ç¦»ã€å‘½ä»¤æŸ¥è¯¢åˆ†ç¦»ï¼ˆCQRSï¼‰

```
æ¥å£åˆ†ç¦»æ¨¡å¼ï¼š
              UserService
                   â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                     â†“
  UserQueryService      UserCommandService
  (æŸ¥è¯¢æ¥å£)              (å‘½ä»¤æ¥å£)
  - getUser()           - createUser()
  - queryUsers()        - updateUser()
  - countUsers()        - deleteUser()
```

**ä¸ºä»€ä¹ˆè¦åˆ†ç¦»**ï¼š
- æŸ¥è¯¢æ“ä½œï¼šé¢‘ç¹ã€å¯¹æ€§èƒ½è¦æ±‚é«˜ã€å¯ä»¥ç¼“å­˜
- å‘½ä»¤æ“ä½œï¼šè¾ƒå°‘ã€å¯¹ä¸€è‡´æ€§è¦æ±‚é«˜ã€éœ€è¦äº‹åŠ¡

**ä»£ç ç¤ºä¾‹**ï¼š
```java
// æŸ¥è¯¢æ¥å£ï¼ˆåªè¯»ï¼‰
public interface UserQueryService {
    Result<User> getUser(Long id);
    Result<List<User>> queryUsers(UserQuery query);
    Result<Long> countUsers(UserQuery query);
}

// å‘½ä»¤æ¥å£ï¼ˆå†™æ“ä½œï¼‰
public interface UserCommandService {
    Result<Long> createUser(UserDTO user);
    Result<Boolean> updateUser(UserDTO user);
    Result<Boolean> deleteUser(Long id);
}
```

**åˆ†ç¦»çš„å¥½å¤„**ï¼š
- æŸ¥è¯¢æ¥å£å¯ä»¥èµ°ç¼“å­˜ï¼Œæå‡æ€§èƒ½
- å‘½ä»¤æ¥å£å¯ä»¥åŠ å¼ºæ ¡éªŒï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§
- èŒè´£æ¸…æ™°ï¼Œæ–¹ä¾¿ç»´æŠ¤

### 7.2 å¹‚ç­‰æ€§è®¾è®¡


**ä»€ä¹ˆæ˜¯å¹‚ç­‰æ€§**ï¼š

```
é€šä¿—ç†è§£ï¼š
å¤šæ¬¡æ‰§è¡ŒåŒä¸€ä¸ªæ“ä½œï¼Œç»“æœæ˜¯ä¸€æ ·çš„

ç”Ÿæ´»ä¾‹å­ï¼š
ç”µæ¢¯æŒ‰é’®ï¼šæŒ‰1æ¬¡å’ŒæŒ‰10æ¬¡æ•ˆæœä¸€æ ·ï¼ˆåˆ°è¾¾åŒä¸€æ¥¼å±‚ï¼‰
ç”µç¯å¼€å…³ï¼šå¼€ç€çš„ç¯å†æŒ‰å¼€å…³è¿˜æ˜¯å¼€ç€

æ¥å£ä¾‹å­ï¼š
âœ… å¹‚ç­‰ï¼šæŸ¥è¯¢ç”¨æˆ·ã€åˆ é™¤ç”¨æˆ·ï¼ˆåˆ é™¤åå†åˆ é™¤è¿˜æ˜¯ä¸å­˜åœ¨ï¼‰
âŒ éå¹‚ç­‰ï¼šåˆ›å»ºç”¨æˆ·ã€å¢åŠ ç§¯åˆ†ï¼ˆæ¯æ¬¡è°ƒç”¨éƒ½ä¼šæ–°å¢ï¼‰
```

**ä¸ºä»€ä¹ˆéœ€è¦å¹‚ç­‰**ï¼š
```
ç½‘ç»œè°ƒç”¨åœºæ™¯ï¼š
Consumer â†’ Provider
   â†“
è¯·æ±‚å‘é€æˆåŠŸï¼Œä½†å“åº”è¶…æ—¶äº†
Consumerä¸çŸ¥é“Provideræœ‰æ²¡æœ‰æ‰§è¡ŒæˆåŠŸ
   â†“
Consumeré‡è¯• â†’ å¦‚æœä¸å¹‚ç­‰ï¼Œä¼šé‡å¤æ‰§è¡Œï¼
```

### 7.3 å¹‚ç­‰æ€§å®ç°æ–¹æ¡ˆ


**ğŸ”¹ æ–¹æ¡ˆ1ï¼šå”¯ä¸€IDé˜²é‡**

```java
// åˆ›å»ºè®¢å•ï¼ˆéå¹‚ç­‰æ“ä½œï¼‰
public Result<Long> createOrder(OrderDTO orderDTO) {
    
    // 1. æ£€æŸ¥è®¢å•å·æ˜¯å¦å·²å­˜åœ¨
    String orderNo = orderDTO.getOrderNo();  // ä¸šåŠ¡å”¯ä¸€å·
    if(orderExists(orderNo)) {
        return Result.fail("ORDER_EXISTS", "è®¢å•å·²å­˜åœ¨");
    }
    
    // 2. åˆ›å»ºè®¢å•
    Long orderId = orderDao.insert(orderDTO);
    
    return Result.success(orderId);
}

// è°ƒç”¨æ–¹ï¼šä½¿ç”¨å”¯ä¸€ID
String orderNo = generateUniqueNo();  // ç”Ÿæˆå”¯ä¸€è®¢å•å·
orderDTO.setOrderNo(orderNo);
orderService.createOrder(orderDTO);   // ç¬¬1æ¬¡è°ƒç”¨
orderService.createOrder(orderDTO);   // é‡è¯•æ—¶ç”¨åŒä¸€ä¸ªè®¢å•å·ï¼Œä¸ä¼šé‡å¤åˆ›å»º
```

**ğŸ”¹ æ–¹æ¡ˆ2ï¼šTokenä»¤ç‰Œæœºåˆ¶**

```java
// 1. è·å–Token
public String getToken() {
    String token = UUID.randomUUID().toString();
    redis.set("token:" + token, "1", 5, TimeUnit.MINUTES);
    return token;
}

// 2. æ¶ˆè´¹Tokenæ‰§è¡Œä¸šåŠ¡
public Result<Long> createOrder(String token, OrderDTO orderDTO) {
    
    // æ£€æŸ¥å¹¶åˆ é™¤Tokenï¼ˆåŸå­æ“ä½œï¼‰
    String key = "token:" + token;
    if(!redis.del(key)) {
        return Result.fail("DUPLICATE_REQUEST", "é‡å¤è¯·æ±‚");
    }
    
    // æ‰§è¡Œä¸šåŠ¡
    Long orderId = orderDao.insert(orderDTO);
    return Result.success(orderId);
}

// è°ƒç”¨æµç¨‹
String token = orderService.getToken();      // å…ˆè·å–Token
orderService.createOrder(token, orderDTO);   // ç”¨Tokenè°ƒç”¨
orderService.createOrder(token, orderDTO);   // é‡è¯•æ—¶Tokenå·²å¤±æ•ˆ
```

**ğŸ”¹ æ–¹æ¡ˆ3ï¼šçŠ¶æ€æœºæ§åˆ¶**

```java
// è®¢å•çŠ¶æ€æµè½¬ï¼ˆå¤©ç„¶å¹‚ç­‰ï¼‰
public Result<Boolean> payOrder(Long orderId) {
    
    Order order = orderDao.findById(orderId);
    
    // æ£€æŸ¥çŠ¶æ€
    if(order.getStatus() == OrderStatus.PAID) {
        return Result.success(true);  // å·²æ”¯ä»˜ï¼Œç›´æ¥è¿”å›æˆåŠŸ
    }
    
    if(order.getStatus() != OrderStatus.CREATED) {
        return Result.fail("INVALID_STATUS", "è®¢å•çŠ¶æ€å¼‚å¸¸");
    }
    
    // çŠ¶æ€æµè½¬ï¼ˆæ•°æ®åº“å±‚é¢ä¿è¯åŸå­æ€§ï¼‰
    int rows = orderDao.updateStatus(orderId, 
                                     OrderStatus.CREATED,    // åŸçŠ¶æ€
                                     OrderStatus.PAID);      // æ–°çŠ¶æ€
    
    if(rows == 0) {
        return Result.fail("UPDATE_FAILED", "çŠ¶æ€æ›´æ–°å¤±è´¥");
    }
    
    return Result.success(true);
}
```

### 7.4 å¹‚ç­‰æ€§è®¾è®¡æ¸…å•


**ä¸åŒæ“ä½œçš„å¹‚ç­‰æ€§å¤„ç†**ï¼š

| æ“ä½œç±»å‹ | **å¤©ç„¶å¹‚ç­‰** | **å¹‚ç­‰æ–¹æ¡ˆ** |
|---------|------------|------------|
| ğŸ”¸ **æŸ¥è¯¢** | âœ… | `æ— éœ€ç‰¹æ®Šå¤„ç†` |
| ğŸ”¸ **åˆ é™¤** | âœ… | `åˆ é™¤ä¸å­˜åœ¨çš„è¿”å›æˆåŠŸ` |
| ğŸ”¸ **æ›´æ–°ï¼ˆå…¨é‡ï¼‰** | âœ… | `ç›¸åŒå†…å®¹è¦†ç›–ç»“æœä¸€æ ·` |
| ğŸ”¸ **åˆ›å»º** | âŒ | `å”¯ä¸€IDã€Tokenã€çŠ¶æ€æœº` |
| ğŸ”¸ **ç´¯åŠ ** | âŒ | `ç‰ˆæœ¬å·ã€æ¡ä»¶æ›´æ–°` |

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 æ¥å£è®¾è®¡åŸåˆ™è®°å¿†


**è®¾è®¡å£è¯€**ï¼š
```
æ¥å£è®¾è®¡è¦è°¨æ…ï¼Œå‘å¸ƒä¹‹åéš¾ä¿®æ”¹
å•ä¸€èŒè´£è¦ç‰¢è®°ï¼Œç²’åº¦æ§åˆ¶è¦é€‚ä¸­
å‚æ•°å°è£…ç”¨å¯¹è±¡ï¼Œè¿”å›ç»Ÿä¸€ç”¨Result
å¼‚å¸¸å¤„ç†è¦åŒºåˆ†ï¼Œä¸šåŠ¡ç³»ç»Ÿè¦åˆ†æ¸…
ç‰ˆæœ¬å…¼å®¹è¦è€ƒè™‘ï¼Œåºåˆ—åŒ–æ€§èƒ½è¦ä¼˜åŒ–
è¯»å†™åˆ†ç¦»èŒè´£æ˜ï¼Œå¹‚ç­‰è®¾è®¡ä¿å®‰å…¨
```

### 8.2 å…³é”®è®¾è®¡å†³ç­–


**ğŸ”¹ æ¥å£ç²’åº¦**
- âœ… æŒ‰ä¸šåŠ¡åœºæ™¯è®¾è®¡æ–¹æ³•
- âœ… æä¾›æ‰¹é‡æ“ä½œæ¥å£
- âŒ é¿å…è¿‡ç»†å’Œè¿‡ç²—

**ğŸ”¹ å‚æ•°è®¾è®¡**
- âœ… å¿…é¡»å¯åºåˆ—åŒ–
- âœ… è¶…è¿‡3ä¸ªå‚æ•°ç”¨å¯¹è±¡å°è£…
- âœ… é›†åˆå‚æ•°æä¾›é»˜è®¤å€¼

**ğŸ”¹ è¿”å›å€¼è®¾è®¡**
- âœ… ä½¿ç”¨ç»Ÿä¸€çš„ResultåŒ…è£…
- âœ… æ˜ç¡®æˆåŠŸå¤±è´¥çŠ¶æ€
- âœ… å¤±è´¥æ—¶æä¾›è¯¦ç»†ä¿¡æ¯

**ğŸ”¹ å¼‚å¸¸å¤„ç†**
- âœ… ä¸šåŠ¡å¼‚å¸¸é€šè¿‡è¿”å›å€¼
- âœ… ç³»ç»Ÿå¼‚å¸¸è®°å½•æ—¥å¿—
- âœ… ä¸æš´éœ²æŠ€æœ¯ç»†èŠ‚ç»™æ¶ˆè´¹è€…

**ğŸ”¹ ç‰ˆæœ¬æ¼”åŒ–**
- âœ… æ–°å¢å­—æ®µæ”¾æœ€å
- âœ… åºŸå¼ƒå­—æ®µæ ‡@Deprecated
- âŒ ä¸è¦åˆ é™¤å­—æ®µ
- âŒ ä¸è¦ä¿®æ”¹å­—æ®µç±»å‹

**ğŸ”¹ å¹‚ç­‰æ€§**
- âœ… æŸ¥è¯¢å’Œåˆ é™¤å¤©ç„¶å¹‚ç­‰
- âœ… åˆ›å»ºç”¨å”¯ä¸€IDæˆ–Token
- âœ… æ›´æ–°ç”¨çŠ¶æ€æœºæˆ–ç‰ˆæœ¬å·

### 8.3 å®æˆ˜æ£€æŸ¥æ¸…å•


**å‘å¸ƒæ¥å£å‰çš„è‡ªæ£€**ï¼š

- [ ] æ¥å£èŒè´£æ˜¯å¦å•ä¸€æ¸…æ™°
- [ ] å‚æ•°æ˜¯å¦éƒ½å¯åºåˆ—åŒ–
- [ ] æ˜¯å¦æä¾›äº†æ‰¹é‡æ“ä½œæ¥å£
- [ ] è¿”å›å€¼æ˜¯å¦ç”¨ResultåŒ…è£…
- [ ] å¼‚å¸¸å¤„ç†æ˜¯å¦å®Œå–„
- [ ] æ˜¯å¦è€ƒè™‘äº†ç‰ˆæœ¬å…¼å®¹æ€§
- [ ] éå¹‚ç­‰æ“ä½œæ˜¯å¦æœ‰é˜²é‡æœºåˆ¶
- [ ] æ–‡æ¡£æ³¨é‡Šæ˜¯å¦æ¸…æ™°å®Œæ•´
- [ ] æ˜¯å¦æœ‰å•å…ƒæµ‹è¯•è¦†ç›–

### 8.4 å¸¸è§é”™è¯¯æ€»ç»“


```
âŒ é”™è¯¯1ï¼šæ¥å£è®¾è®¡å¤ªéšæ„
- æ²¡è€ƒè™‘ç½‘ç»œè°ƒç”¨ç‰¹æ€§
- å‚æ•°è¿‡å¤šä¸å°è£…
- æ²¡æœ‰ç»Ÿä¸€è¿”å›æ ¼å¼

âŒ é”™è¯¯2ï¼šä¸è€ƒè™‘å…¼å®¹æ€§  
- éšæ„ä¿®æ”¹å­—æ®µç±»å‹
- åˆ é™¤å·²æœ‰å­—æ®µ
- ä¿®æ”¹æ–¹æ³•ç­¾å

âŒ é”™è¯¯3ï¼šå¿½è§†å¹‚ç­‰æ€§
- é‡å¤åˆ›å»ºæ•°æ®
- é‡å¤æ‰£æ¬¾
- é‡å¤å‘æ¶ˆæ¯

âœ… æ­£ç¡®åšæ³•ï¼š
- æŒ‰è§„èŒƒè®¾è®¡æ¥å£
- å……åˆ†è€ƒè™‘æ¼”åŒ–å’Œå…¼å®¹
- é‡è¦æ“ä½œå¿…é¡»å¹‚ç­‰
- å®Œå–„çš„æ–‡æ¡£å’Œæµ‹è¯•
```