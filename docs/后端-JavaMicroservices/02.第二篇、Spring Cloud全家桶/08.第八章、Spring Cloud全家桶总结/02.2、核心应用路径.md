---
title: 2ã€æ ¸å¿ƒåº”ç”¨è·¯å¾„
---
## ğŸ“š ç›®å½•

1. [å¾®æœåŠ¡æ¶æ„åŸºç¡€æ¦‚å¿µ](#1-å¾®æœåŠ¡æ¶æ„åŸºç¡€æ¦‚å¿µ)
2. [æ³¨å†Œä¸­å¿ƒä¸æœåŠ¡å‘ç°](#2-æ³¨å†Œä¸­å¿ƒä¸æœåŠ¡å‘ç°)
3. [æœåŠ¡è°ƒç”¨ä¸è´Ÿè½½å‡è¡¡](#3-æœåŠ¡è°ƒç”¨ä¸è´Ÿè½½å‡è¡¡)
4. [é…ç½®ä¸­å¿ƒç®¡ç†](#4-é…ç½®ä¸­å¿ƒç®¡ç†)
5. [APIç½‘å…³åº”ç”¨](#5-apiç½‘å…³åº”ç”¨)
6. [ç†”æ–­é™æµæœºåˆ¶](#6-ç†”æ–­é™æµæœºåˆ¶)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ—ï¸ å¾®æœåŠ¡æ¶æ„åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯å¾®æœåŠ¡


**ğŸ”¸ ç®€å•ç†è§£**
```
æƒ³è±¡ä¸€ä¸ªå¤§å‹å•†åŸç½‘ç«™ï¼š
ä¼ ç»Ÿå•ä½“åº”ç”¨ = ä¸€ä¸ªå·¨å¤§çš„å•†åœºï¼Œæ‰€æœ‰åŠŸèƒ½éƒ½åœ¨ä¸€æ ‹å»ºç­‘é‡Œ
å¾®æœåŠ¡æ¶æ„ = ä¸€ä¸ªå•†ä¸šè¡—ï¼Œæ¯ä¸ªåº—é“ºä¸“é—¨è´Ÿè´£ä¸€ä»¶äº‹

ç”¨æˆ·æœåŠ¡ = ä¸“é—¨ç®¡ç†ç”¨æˆ·ä¿¡æ¯çš„å°åº—
è®¢å•æœåŠ¡ = ä¸“é—¨å¤„ç†è®¢å•çš„å°åº—  
å•†å“æœåŠ¡ = ä¸“é—¨ç®¡ç†å•†å“çš„å°åº—
æ”¯ä»˜æœåŠ¡ = ä¸“é—¨å¤„ç†æ”¯ä»˜çš„å°åº—
```

**ğŸ’¡ æ ¸å¿ƒç†å¿µ**
- **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªæœåŠ¡åªåšä¸€ä»¶äº‹ï¼Œä½†è¦åšå¥½
- **ç‹¬ç«‹éƒ¨ç½²**ï¼šæ¯ä¸ªæœåŠ¡å¯ä»¥å•ç‹¬ä¸Šçº¿ï¼Œä¸å½±å“å…¶ä»–æœåŠ¡
- **æŠ€æœ¯å¤šæ ·**ï¼šä¸åŒæœåŠ¡å¯ä»¥ç”¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€å’Œæ•°æ®åº“
- **å›¢é˜Ÿè‡ªæ²»**ï¼šæ¯ä¸ªå›¢é˜Ÿå¯ä»¥ç‹¬ç«‹ç»´æŠ¤è‡ªå·±çš„æœåŠ¡

### 1.2 å¾®æœåŠ¡ vs å•ä½“åº”ç”¨å¯¹æ¯”


| å¯¹æ¯”é¡¹ç›® | **å•ä½“åº”ç”¨** | **å¾®æœåŠ¡æ¶æ„** |
|---------|------------|-------------|
| ğŸ¢ **æ¶æ„** | `ä¸€ä¸ªå¤§åº”ç”¨åŒ…å«æ‰€æœ‰åŠŸèƒ½` | `å¤šä¸ªå°æœåŠ¡ååŒå·¥ä½œ` |
| ğŸš€ **éƒ¨ç½²** | `æ•´ä½“æ‰“åŒ…ï¼Œä¸€æ¬¡éƒ¨ç½²` | `æœåŠ¡ç‹¬ç«‹éƒ¨ç½²ï¼Œäº’ä¸å½±å“` |
| ğŸ”§ **å¼€å‘** | `å›¢é˜Ÿå…±äº«ä¸€ä¸ªä»£ç åº“` | `æ¯ä¸ªå›¢é˜Ÿç»´æŠ¤è‡ªå·±çš„æœåŠ¡` |
| ğŸ“Š **æ‰©å±•** | `æ•´ä½“æ‰©å±•ï¼Œèµ„æºæµªè´¹` | `æŒ‰éœ€æ‰©å±•ï¼Œèµ„æºé«˜æ•ˆ` |
| ğŸ› **æ•…éšœ** | `ä¸€å¤„å‡ºé”™ï¼Œå…¨éƒ¨å½±å“` | `æœåŠ¡éš”ç¦»ï¼Œå±€éƒ¨æ•…éšœ` |

### 1.3 Spring Cloud å…¨å®¶æ¡¶ä»‹ç»


**ğŸŒŸ ä»€ä¹ˆæ˜¯ Spring Cloud**
```
Spring Cloud å°±åƒæ˜¯å¾®æœåŠ¡çš„"å·¥å…·ç®±"
é‡Œé¢æœ‰å„ç§ç°æˆçš„å·¥å…·ï¼Œå¸®ä½ å¿«é€Ÿæ­å»ºå¾®æœåŠ¡ç³»ç»Ÿ

å°±åƒè£…ä¿®æˆ¿å­ï¼š
- ä½ ä¸éœ€è¦è‡ªå·±åˆ¶é€ èºä¸åˆ€ã€ç”µé’»
- Spring Cloud æä¾›äº†ç°æˆçš„"å·¥å…·"
- ä½ åªéœ€è¦å­¦ä¼šæ€ä¹ˆä½¿ç”¨è¿™äº›å·¥å…·
```

**ğŸ”§ æ ¸å¿ƒç»„ä»¶ä¸€è§ˆè¡¨**

| ç»„ä»¶åç§° | **ä½œç”¨** | **ç±»æ¯”** |
|---------|---------|---------|
| ğŸ¯ **Eureka** | `æœåŠ¡æ³¨å†Œä¸å‘ç°` | `ç”µè¯ç°¿ï¼Œè®°å½•æ¯ä¸ªæœåŠ¡çš„åœ°å€` |
| ğŸ“ **Feign** | `æœåŠ¡é—´è°ƒç”¨` | `æ‰“ç”µè¯ï¼Œè®©æœåŠ¡ä¹‹é—´èƒ½å¯¹è¯` |
| âš–ï¸ **Ribbon** | `è´Ÿè½½å‡è¡¡` | `æ™ºèƒ½åˆ†é…å™¨ï¼Œåˆç†åˆ†é…è¯·æ±‚` |
| ğŸŒ **Gateway** | `APIç½‘å…³` | `é—¨å«ï¼Œç»Ÿä¸€ç®¡ç†è¿›å‡ºçš„è¯·æ±‚` |
| âš™ï¸ **Config** | `é…ç½®ä¸­å¿ƒ` | `é¥æ§å™¨ï¼Œç»Ÿä¸€æ§åˆ¶æ‰€æœ‰é…ç½®` |
| ğŸ›¡ï¸ **Hystrix** | `ç†”æ–­ä¿æŠ¤` | `ä¿é™©ä¸ï¼Œé˜²æ­¢ç³»ç»Ÿå´©æºƒ` |

---

## 2. ğŸ¯ æ³¨å†Œä¸­å¿ƒä¸æœåŠ¡å‘ç°


### 2.1 ä¸ºä»€ä¹ˆéœ€è¦æ³¨å†Œä¸­å¿ƒ


**ğŸ¤” é—®é¢˜èƒŒæ™¯**
```
æ²¡æœ‰æ³¨å†Œä¸­å¿ƒçš„å›°æ‰°ï¼š

ç”¨æˆ·æœåŠ¡æƒ³è°ƒç”¨è®¢å•æœåŠ¡ï¼š
ç”¨æˆ·æœåŠ¡ï¼šè®¢å•æœåŠ¡ä½ åœ¨å“ªé‡Œï¼ŸIPæ˜¯å¤šå°‘ï¼Ÿç«¯å£æ˜¯å¤šå°‘ï¼Ÿ
è®¢å•æœåŠ¡ï¼šæˆ‘åœ¨ 192.168.1.100:8080
ç”¨æˆ·æœåŠ¡ï¼šå¥½çš„ï¼Œæˆ‘è®°ä½äº†ï¼

é—®é¢˜æ¥äº†ï¼š
- è®¢å•æœåŠ¡é‡å¯äº†ï¼ŒIPå¯èƒ½å˜äº†
- è®¢å•æœåŠ¡æ‰©å®¹äº†ï¼Œæœ‰å¤šä¸ªå®ä¾‹
- è®¢å•æœåŠ¡æŒ‚äº†ï¼Œç”¨æˆ·æœåŠ¡è¿˜åœ¨è°ƒç”¨æ—§åœ°å€

ç»“æœï¼šç³»ç»Ÿç»å¸¸å‡ºé”™ï¼
```

**ğŸ’¡ æ³¨å†Œä¸­å¿ƒçš„è§£å†³æ–¹æ¡ˆ**
```
æœ‰äº†æ³¨å†Œä¸­å¿ƒï¼ˆæ¯”å¦‚ç”µè¯ç°¿ï¼‰ï¼š

æœåŠ¡å¯åŠ¨æ—¶ï¼š
è®¢å•æœåŠ¡ â†’ æ³¨å†Œä¸­å¿ƒï¼š"æˆ‘æ˜¯è®¢å•æœåŠ¡ï¼Œæˆ‘åœ¨ 192.168.1.100:8080"
ç”¨æˆ·æœåŠ¡ â†’ æ³¨å†Œä¸­å¿ƒï¼š"æˆ‘æ˜¯ç”¨æˆ·æœåŠ¡ï¼Œæˆ‘åœ¨ 192.168.1.101:8081"

æœåŠ¡è°ƒç”¨æ—¶ï¼š
ç”¨æˆ·æœåŠ¡ â†’ æ³¨å†Œä¸­å¿ƒï¼š"è®¢å•æœåŠ¡åœ¨å“ªé‡Œï¼Ÿ"
æ³¨å†Œä¸­å¿ƒ â†’ ç”¨æˆ·æœåŠ¡ï¼š"è®¢å•æœåŠ¡åœ¨ 192.168.1.100:8080"
ç”¨æˆ·æœåŠ¡ â†’ è®¢å•æœåŠ¡ï¼šå‘èµ·è°ƒç”¨

å°±åƒæŸ¥ç”µè¯ç°¿æ‰“ç”µè¯ä¸€æ ·ç®€å•ï¼
```

### 2.2 Eureka æ³¨å†Œä¸­å¿ƒè¯¦è§£


**ğŸ”¸ Eureka çš„è§’è‰²**

```
Eureka æ¶æ„å›¾ï¼š

    Eureka Server            æœåŠ¡æä¾›è€…          æœåŠ¡æ¶ˆè´¹è€…
   (æ³¨å†Œä¸­å¿ƒæœåŠ¡å™¨)          (æ¯”å¦‚è®¢å•æœåŠ¡)        (æ¯”å¦‚ç”¨æˆ·æœåŠ¡)
         â”‚                     â”‚                   â”‚
         â”‚â†â”€â”€â”€â”€ æ³¨å†ŒæœåŠ¡ â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
         â”‚                     â”‚                   â”‚
         â”‚â†â”€â”€â”€â”€ å¿ƒè·³æ£€æµ‹ â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
         â”‚                     â”‚                   â”‚
         â”‚                     â”‚      â”€â”€â”€â”€ å‘ç°æœåŠ¡ â”€â”€â”€â†’â”‚
         â”‚ â”€â”€â”€â”€ æœåŠ¡åˆ—è¡¨ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
```

**âš™ï¸ æ ¸å¿ƒé…ç½®è¦ç‚¹**

`Eureka Server é…ç½®`ï¼ˆæ³¨å†Œä¸­å¿ƒï¼‰ï¼š
```yaml
# è¿™æ˜¯æ³¨å†Œä¸­å¿ƒçš„é…ç½®ï¼Œå°±åƒç”µè¯ç°¿ç®¡ç†å‘˜çš„è®¾ç½®
server:
  port: 8761  # æ³¨å†Œä¸­å¿ƒçš„ç«¯å£å·

eureka:
  client:
    register-with-eureka: false  # è‡ªå·±ä¸éœ€è¦æ³¨å†Œåˆ°è‡ªå·±
    fetch-registry: false        # è‡ªå·±ä¸éœ€è¦è·å–æœåŠ¡åˆ—è¡¨
```

`æœåŠ¡æä¾›è€…é…ç½®`ï¼š
```yaml
# è¿™æ˜¯æ™®é€šæœåŠ¡çš„é…ç½®ï¼Œæ¯”å¦‚è®¢å•æœåŠ¡
spring:
  application:
    name: order-service  # æœåŠ¡åç§°ï¼Œå°±åƒä½ çš„å§“å

eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/  # æ³¨å†Œä¸­å¿ƒåœ°å€
```

### 2.3 æœåŠ¡æ³¨å†Œä¸å‘ç°æµç¨‹


**ğŸ“‹ å®Œæ•´æµç¨‹è¯´æ˜**

```
æ­¥éª¤ â‘ â‘¡â‘¢â‘£â‘¤ è¯¦ç»†æµç¨‹ï¼š

â‘  æœåŠ¡æ³¨å†Œé˜¶æ®µï¼š
   è®¢å•æœåŠ¡å¯åŠ¨ â†’ å‘Eureka Serverè¯´ï¼š"æˆ‘æ˜¯order-serviceï¼Œåœ¨8080ç«¯å£"
   
â‘¡ å¿ƒè·³ç»´æŒé˜¶æ®µï¼š
   è®¢å•æœåŠ¡æ¯30ç§’ â†’ å‘Eureka Serverè¯´ï¼š"æˆ‘è¿˜æ´»ç€ï¼"
   
â‘¢ æœåŠ¡å‘ç°é˜¶æ®µï¼š
   ç”¨æˆ·æœåŠ¡éœ€è¦è°ƒç”¨ â†’ é—®Eureka Serverï¼š"order-serviceåœ¨å“ªï¼Ÿ"
   
â‘£ è·å–æœåŠ¡åˆ—è¡¨ï¼š
   Eureka Server â†’ å‘Šè¯‰ç”¨æˆ·æœåŠ¡ï¼š"order-serviceåœ¨192.168.1.100:8080"
   
â‘¤ æœåŠ¡è°ƒç”¨é˜¶æ®µï¼š
   ç”¨æˆ·æœåŠ¡ â†’ ç›´æ¥è°ƒç”¨è®¢å•æœåŠ¡çš„æ¥å£
```

**ğŸ”¥ é‡è¦æ¦‚å¿µè§£é‡Š**

- **æœåŠ¡æ³¨å†Œ**ï¼šå°±åƒåœ¨ç”µè¯ç°¿é‡Œç•™ä¸‹è‡ªå·±çš„ç”µè¯å·ç 
- **æœåŠ¡å‘ç°**ï¼šå°±åƒæŸ¥ç”µè¯ç°¿æ‰¾åˆ«äººçš„ç”µè¯å·ç   
- **å¿ƒè·³æ£€æµ‹**ï¼šå®šæœŸæŠ¥å‘Š"æˆ‘è¿˜æ´»ç€"ï¼Œé˜²æ­¢è¢«è¯¯è®¤ä¸ºæŒ‚äº†
- **æœåŠ¡å‰”é™¤**ï¼šå¦‚æœé•¿æ—¶é—´æ²¡å¿ƒè·³ï¼Œå°±ä»ç”µè¯ç°¿é‡Œåˆ æ‰

---

## 3. ğŸ“ æœåŠ¡è°ƒç”¨ä¸è´Ÿè½½å‡è¡¡


### 3.1 æœåŠ¡é—´å¦‚ä½•é€šä¿¡


**ğŸ¤” åŸºæœ¬é—®é¢˜**
```
æƒ³è±¡ä¸¤ä¸ªäººè¦é€šè¯ï¼š

ä¼ ç»Ÿæ–¹å¼ï¼ˆRestTemplateï¼‰ï¼š
ç”¨æˆ·æœåŠ¡ï¼š"æˆ‘è¦æ‹¨æ‰“ http://192.168.1.100:8080/orders"
å°±åƒä½ è¦èƒŒä¸‹æ‰€æœ‰æœ‹å‹çš„ç”µè¯å·ç ä¸€æ ·éº»çƒ¦

Spring Cloud æ–¹å¼ï¼ˆFeignï¼‰ï¼š
ç”¨æˆ·æœåŠ¡ï¼š"æˆ‘è¦è°ƒç”¨è®¢å•æœåŠ¡çš„getOrderæ–¹æ³•"
å°±åƒä½ åªéœ€è¦è¯´"ç»™å¼ ä¸‰æ‰“ç”µè¯"ï¼Œæ‰‹æœºè‡ªåŠ¨å¸®ä½ æ‹¨å·
```

### 3.2 Feign å£°æ˜å¼æœåŠ¡è°ƒç”¨


**ğŸ”¸ Feign çš„ä½œç”¨**
```
Feign å°±åƒæ˜¯ä¸€ä¸ª"æ™ºèƒ½ç”µè¯"
ä½ åªéœ€è¦è¯´æƒ³è¦ä»€ä¹ˆï¼Œå®ƒè‡ªåŠ¨å¸®ä½ å®Œæˆè°ƒç”¨è¿‡ç¨‹

ä¸ç”¨ Feign çš„ç¹çæ–¹å¼ï¼š
1. æ‰‹åŠ¨æ„é€  HTTP è¯·æ±‚
2. æ‰‹åŠ¨è§£æ HTTP å“åº”  
3. æ‰‹åŠ¨å¤„ç†å¼‚å¸¸
4. æ‰‹åŠ¨ç®¡ç†è¿æ¥

ç”¨äº† Feign çš„ç®€å•æ–¹å¼ï¼š
1. å®šä¹‰ä¸€ä¸ªæ¥å£
2. åŠ ä¸Šæ³¨è§£
3. ç›´æ¥è°ƒç”¨æ–¹æ³•
```

**ğŸ’» Feign ä½¿ç”¨ç¤ºä¾‹**

```java
// å®šä¹‰æœåŠ¡è°ƒç”¨æ¥å£ - å°±åƒå®šä¹‰ä¸€ä¸ªç”µè¯è”ç³»äºº
@FeignClient(name = "order-service")  // è¦è°ƒç”¨çš„æœåŠ¡å
public interface OrderFeignClient {
    
    // å®šä¹‰è¦è°ƒç”¨çš„æ–¹æ³• - å°±åƒè®¾ç½®å¿«æ·æ‹¨å·
    @GetMapping("/orders/{orderId}")
    OrderInfo getOrderById(@PathVariable Long orderId);
    
    @PostMapping("/orders")
    OrderInfo createOrder(@RequestBody OrderRequest request);
}

// åœ¨ä¸šåŠ¡ä»£ç ä¸­ä½¿ç”¨ - å°±åƒç›´æ¥æ‰“ç”µè¯
@Service
public class UserService {
    
    @Autowired
    private OrderFeignClient orderFeignClient;  // æ³¨å…¥"ç”µè¯"
    
    public UserOrderInfo getUserOrder(Long userId, Long orderId) {
        // ç›´æ¥è°ƒç”¨ï¼Œå°±åƒæ‰“ç”µè¯ä¸€æ ·ç®€å•
        OrderInfo order = orderFeignClient.getOrderById(orderId);
        return new UserOrderInfo(userId, order);
    }
}
```

### 3.3 Ribbon è´Ÿè½½å‡è¡¡


**ğŸ¤” è´Ÿè½½å‡è¡¡çš„å¿…è¦æ€§**
```
ç°å®åœºæ™¯ï¼š
ä½ å¼€äº†ä¸€å®¶å¾ˆå—æ¬¢è¿çš„é¢åŒ…åº—ï¼ˆè®¢å•æœåŠ¡ï¼‰
ç”Ÿæ„å¤ªå¥½äº†ï¼Œä¸€å°æ”¶é“¶æœºå¿™ä¸è¿‡æ¥
äºæ˜¯ä½ å¢åŠ äº†3å°æ”¶é“¶æœº

é—®é¢˜æ¥äº†ï¼š
é¡¾å®¢è¿›æ¥åï¼Œè¯¥å»å“ªå°æ”¶é“¶æœºï¼Ÿ
å¦‚æœéƒ½å»ç¬¬1å°ï¼Œå…¶ä»–å°é—²ç€ï¼Œç¬¬1å°ç´¯æ­»
å¦‚æœéšä¾¿é€‰ï¼Œå¯èƒ½é€‰åˆ°åæ‰çš„é‚£å°

è´Ÿè½½å‡è¡¡å°±æ˜¯"æ™ºèƒ½åˆ†æµå‘˜"ï¼š
- å¹³å‡åˆ†é…é¡¾å®¢åˆ°å„ä¸ªæ”¶é“¶æœº
- å‘ç°å“ªå°åäº†ï¼Œå°±ä¸åˆ†é…ç»™å®ƒ
- ç¡®ä¿æ¯å°æ”¶é“¶æœºå·¥ä½œé‡å·®ä¸å¤š
```

**âš–ï¸ Ribbon è´Ÿè½½å‡è¡¡ç­–ç•¥**

| ç­–ç•¥åç§° | **å·¥ä½œåŸç†** | **é€‚ç”¨åœºæ™¯** |
|---------|-------------|-------------|
| ğŸ”„ **è½®è¯¢** | `1â†’2â†’3â†’1â†’2â†’3 å¾ªç¯` | `æœåŠ¡å™¨æ€§èƒ½ç›¸è¿‘` |
| ğŸ² **éšæœº** | `éšæœºé€‰æ‹©ä¸€ä¸ªæœåŠ¡å™¨` | `ç®€å•åœºæ™¯ï¼Œæ€§èƒ½ç›¸è¿‘` |
| âš¡ **æœ€å°‘è¿æ¥** | `é€‰æ‹©è¿æ¥æ•°æœ€å°‘çš„æœåŠ¡å™¨` | `æœåŠ¡å™¨æ€§èƒ½ä¸åŒ` |
| ğŸ¯ **åŠ æƒè½®è¯¢** | `æ ¹æ®æƒé‡åˆ†é…è¯·æ±‚` | `æœåŠ¡å™¨é…ç½®ä¸åŒ` |

**ğŸ’¡ è´Ÿè½½å‡è¡¡ç¤ºä¾‹åœºæ™¯**
```
è®¢å•æœåŠ¡æœ‰3ä¸ªå®ä¾‹ï¼š
å®ä¾‹1ï¼š192.168.1.100:8080  (æ€§èƒ½å¥½ï¼Œæƒé‡3)
å®ä¾‹2ï¼š192.168.1.101:8080  (æ€§èƒ½ä¸€èˆ¬ï¼Œæƒé‡2)  
å®ä¾‹3ï¼š192.168.1.102:8080  (æ€§èƒ½å·®ï¼Œæƒé‡1)

ä½¿ç”¨åŠ æƒè½®è¯¢ç­–ç•¥ï¼š
10ä¸ªè¯·æ±‚çš„åˆ†é…ï¼š
å®ä¾‹1ï¼š5ä¸ªè¯·æ±‚ (3/6 = 50%)
å®ä¾‹2ï¼š3ä¸ªè¯·æ±‚ (2/6 = 33%) 
å®ä¾‹3ï¼š2ä¸ªè¯·æ±‚ (1/6 = 17%)
```

---

## 4. âš™ï¸ é…ç½®ä¸­å¿ƒç®¡ç†


### 4.1 ä¸ºä»€ä¹ˆéœ€è¦é…ç½®ä¸­å¿ƒ


**ğŸ˜µ æ²¡æœ‰é…ç½®ä¸­å¿ƒçš„ç—›è‹¦**
```
æƒ³è±¡ä½ ç®¡ç†100å°æœåŠ¡å™¨ï¼š

ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜ï¼š
- æ•°æ®åº“å¯†ç è¦æ”¹ â†’ éœ€è¦ä¿®æ”¹100ä¸ªé…ç½®æ–‡ä»¶
- æ–°å¢ä¸€ä¸ªåŠŸèƒ½å¼€å…³ â†’ éœ€è¦åœ¨100ä¸ªåœ°æ–¹æ·»åŠ 
- ç”Ÿäº§ç¯å¢ƒå‡ºé—®é¢˜ â†’ éœ€è¦é‡å¯100ä¸ªæœåŠ¡
- ä¸åŒç¯å¢ƒé…ç½® â†’ éœ€è¦ç»´æŠ¤300ä¸ªæ–‡ä»¶(å¼€å‘/æµ‹è¯•/ç”Ÿäº§)

å°±åƒä½ æœ‰100å¥—æˆ¿å­ï¼Œæ¯å¥—éƒ½è¦å•ç‹¬è£…ä¿®ã€å•ç‹¬ç»´æŠ¤
æƒ³æ¢ä¸ªç¯æ³¡éƒ½è¦è·‘100ä¸ªåœ°æ–¹ï¼
```

**ğŸ’¡ é…ç½®ä¸­å¿ƒçš„è§£å†³æ–¹æ¡ˆ**
```
Spring Cloud Config å°±åƒ"æ™ºèƒ½é¥æ§å™¨"ï¼š

é›†ä¸­ç®¡ç†ï¼š
æ‰€æœ‰é…ç½®æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹ï¼ˆGitä»“åº“ï¼‰
å°±åƒæœ‰ä¸€ä¸ªä¸‡èƒ½é¥æ§å™¨ï¼Œæ§åˆ¶æ‰€æœ‰å®¶ç”µ

åŠ¨æ€æ›´æ–°ï¼š
é…ç½®æ”¹å˜åï¼ŒæœåŠ¡è‡ªåŠ¨è·å–æ–°é…ç½®
å°±åƒé¥æ§å™¨ä¸€æŒ‰ï¼Œæ‰€æœ‰ç”µè§†éƒ½æ¢å°

ç¯å¢ƒéš”ç¦»ï¼š
dev/test/prod ä¸åŒæ–‡ä»¶å¤¹
å°±åƒä¸åŒæˆ¿é—´çš„é¥æ§å™¨ï¼Œäº’ä¸å¹²æ‰°
```

### 4.2 Spring Cloud Config é…ç½®ä¸­å¿ƒ


**ğŸ”¸ Config Server æ¶æ„**

```
é…ç½®ä¸­å¿ƒæ¶æ„å›¾ï¼š

    Gitä»“åº“             Config Server           å¾®æœåŠ¡å®ä¾‹
   (é…ç½®æ–‡ä»¶)            (é…ç½®æœåŠ¡å™¨)            (å„ä¸ªä¸šåŠ¡æœåŠ¡)
      â”‚                      â”‚                      â”‚
      â”‚                      â”‚                      â”‚
   application.yml     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
   application-dev.yml â”‚  Config      â”‚              â”‚
   application-prod.ymlâ”‚  Server      â”‚              â”‚
      â”‚                â”‚  (8888)      â”‚              â”‚
      â”‚â”€â”€â”€â”€â”€â”€ æ‹‰å– â”€â”€â”€â”€â”€â”€â†’â”‚              â”‚              â”‚
                       â”‚              â”‚â†â”€â”€â”€â”€ è·å–é…ç½® â”€â”€â”¤
                       â”‚              â”‚              â”‚
                       â”‚              â”‚â”€â”€â”€â”€ è¿”å›é…ç½® â”€â”€â†’â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
```

**ğŸ“ é…ç½®æ–‡ä»¶ç»„ç»‡ç»“æ„**
```
é…ç½®ä»“åº“ç›®å½•ç»“æ„ï¼š
config-repo/
â”œâ”€â”€ application.yml              # å…¨å±€é»˜è®¤é…ç½®
â”œâ”€â”€ application-dev.yml          # å¼€å‘ç¯å¢ƒé…ç½®
â”œâ”€â”€ application-test.yml         # æµ‹è¯•ç¯å¢ƒé…ç½®
â”œâ”€â”€ application-prod.yml         # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”œâ”€â”€ order-service.yml           # è®¢å•æœåŠ¡ä¸“ç”¨é…ç½®
â”œâ”€â”€ order-service-dev.yml       # è®¢å•æœåŠ¡å¼€å‘é…ç½®
â””â”€â”€ user-service.yml            # ç”¨æˆ·æœåŠ¡ä¸“ç”¨é…ç½®

é…ç½®ä¼˜å…ˆçº§ï¼ˆé«˜åˆ°ä½ï¼‰ï¼š
order-service-dev.yml > order-service.yml > application-dev.yml > application.yml
```

### 4.3 åŠ¨æ€é…ç½®åˆ·æ–°


**ğŸ”„ é…ç½®åˆ·æ–°æœºåˆ¶**

`æ‰‹åŠ¨åˆ·æ–°æ–¹å¼`ï¼š
```java
// åœ¨éœ€è¦åˆ·æ–°é…ç½®çš„ç±»ä¸ŠåŠ æ³¨è§£
@RefreshScope  // è¿™ä¸ªæ³¨è§£è®©é…ç½®å¯ä»¥åŠ¨æ€åˆ·æ–°
@RestController
public class OrderController {
    
    @Value("${order.max-count:100}")  // ä»é…ç½®ä¸­å¿ƒè·å–
    private int maxOrderCount;
    
    @GetMapping("/config")
    public String getConfig() {
        return "å½“å‰æœ€å¤§è®¢å•æ•°ï¼š" + maxOrderCount;
    }
}
```

**âš¡ è‡ªåŠ¨åˆ·æ–°æœºåˆ¶ï¼ˆSpring Cloud Busï¼‰**
```
è‡ªåŠ¨åˆ·æ–°æµç¨‹ï¼š

â‘  å¼€å‘äººå‘˜ä¿®æ”¹Gitä»“åº“çš„é…ç½®
â‘¡ Gitä»“åº“è§¦å‘Webhooké€šçŸ¥Config Server  
â‘¢ Config Server å‘é€åˆ·æ–°æ¶ˆæ¯åˆ°æ¶ˆæ¯é˜Ÿåˆ—
â‘£ æ‰€æœ‰å¾®æœåŠ¡è®¢é˜…æ¶ˆæ¯é˜Ÿåˆ—
â‘¤ æ”¶åˆ°æ¶ˆæ¯åè‡ªåŠ¨åˆ·æ–°é…ç½®

å°±åƒç¾¤å‘çŸ­ä¿¡ï¼š
ä¸€ä¸ªäººå‘æ¶ˆæ¯ â†’ æ‰€æœ‰äººåŒæ—¶æ”¶åˆ° â†’ å¤§å®¶ä¸€èµ·æ›´æ–°
```

---

## 5. ğŸŒ APIç½‘å…³åº”ç”¨


### 5.1 ä¸ºä»€ä¹ˆéœ€è¦APIç½‘å…³


**ğŸ¤” æ²¡æœ‰ç½‘å…³çš„æ··ä¹±åœºæ™¯**
```
æƒ³è±¡ä¸€ä¸ªå°åŒºï¼š

æ²¡æœ‰é—¨å«ï¼ˆç½‘å…³ï¼‰çš„é—®é¢˜ï¼š
- å¤–å–å‘˜ä¸çŸ¥é“å“ªæ ‹æ˜¯å“ªæ ‹
- æ¨é”€å‘˜éšä¾¿è¿›ï¼Œæ‰“æ‰°ä½æˆ·
- å¿«é€’å‘˜æ‰¾ä¸åˆ°æ­£ç¡®çš„æ¥¼å±‚
- æ²¡äººæ£€æŸ¥æ¥è®¿è€…æ˜¯å¦æœ‰æƒé™
- æ¯æ ‹æ¥¼éƒ½è¦è‡ªå·±éªŒè¯èº«ä»½

æœ‰äº†é—¨å«ï¼ˆç½‘å…³ï¼‰çš„å¥½å¤„ï¼š
- ç»Ÿä¸€å…¥å£ï¼Œé—¨å«æŒ‡è·¯
- éªŒè¯èº«ä»½ï¼Œæ‹’ç»æ¨é”€å‘˜  
- è®°å½•è®¿é—®ï¼Œä¾¿äºç®¡ç†
- ç»Ÿä¸€ç®¡ç†ï¼Œå‡å°‘é‡å¤å·¥ä½œ
```

**ğŸ’¡ APIç½‘å…³çš„æ ¸å¿ƒä½œç”¨**
```
Spring Cloud Gateway å°±åƒå°åŒºçš„"æ™ºèƒ½é—¨å«"ï¼š

ğŸšª ç»Ÿä¸€å…¥å£ï¼š
   æ‰€æœ‰å¤–éƒ¨è¯·æ±‚éƒ½å…ˆåˆ°ç½‘å…³
   ç½‘å…³å†³å®šè½¬å‘ç»™å“ªä¸ªæœåŠ¡

ğŸ›¡ï¸ å®‰å…¨æ£€æŸ¥ï¼š
   éªŒè¯ç”¨æˆ·èº«ä»½å’Œæƒé™
   è¿‡æ»¤æ¶æ„è¯·æ±‚

ğŸ“Š æµé‡æ§åˆ¶ï¼š
   é™åˆ¶è®¿é—®é¢‘ç‡
   é˜²æ­¢ç³»ç»Ÿè¢«å‹å®

ğŸ“ æ—¥å¿—è®°å½•ï¼š
   è®°å½•æ‰€æœ‰è®¿é—®æ—¥å¿—
   ä¾¿äºç›‘æ§å’Œåˆ†æ
```

### 5.2 Spring Cloud Gateway


**ğŸ”¸ Gateway æ ¸å¿ƒæ¦‚å¿µ**

| æ¦‚å¿µ | **ä½œç”¨** | **ç±»æ¯”** |
|------|---------|---------|
| ğŸ›£ï¸ **Route** | `è·¯ç”±è§„åˆ™ï¼Œå†³å®šè¯·æ±‚å»å“ªé‡Œ` | `è·¯æ ‡ï¼Œå‘Šè¯‰ä½ èµ°å“ªæ¡è·¯` |
| ğŸ” **Predicate** | `åˆ¤æ–­æ¡ä»¶ï¼Œä»€ä¹ˆæƒ…å†µä¸‹åŒ¹é…` | `é—¨ç‰Œå·ï¼Œç¡®è®¤ä½ è¦æ‰¾çš„åœ°å€` |
| ğŸ”§ **Filter** | `è¿‡æ»¤å™¨ï¼Œå¤„ç†è¯·æ±‚å’Œå“åº”` | `å®‰æ£€ï¼Œæ£€æŸ¥å’Œå¤„ç†åŒ…è£¹` |

**âš™ï¸ Gateway é…ç½®ç¤ºä¾‹**

```yaml
spring:
  cloud:
    gateway:
      routes:
        # ç”¨æˆ·æœåŠ¡è·¯ç”±
        - id: user-service                    # è·¯ç”±ID
          uri: lb://user-service              # è´Ÿè½½å‡è¡¡åˆ°user-service
          predicates:
            - Path=/user/**                   # åŒ¹é… /user/ å¼€å¤´çš„è¯·æ±‚
          filters:
            - StripPrefix=1                   # å»æ‰ç¬¬ä¸€çº§è·¯å¾„å‰ç¼€
            
        # è®¢å•æœåŠ¡è·¯ç”±  
        - id: order-service
          uri: lb://order-service
          predicates:
            - Path=/order/**
            - Method=GET,POST                 # åªå…è®¸GETå’ŒPOSTè¯·æ±‚
          filters:
            - AddRequestHeader=X-Request-Source,gateway  # æ·»åŠ è¯·æ±‚å¤´
```

**ğŸ”„ è¯·æ±‚è½¬å‘æµç¨‹**
```
è¯·æ±‚è½¬å‘ç¤ºä¾‹ï¼š

å®¢æˆ·ç«¯è¯·æ±‚ï¼šGET http://gateway:9999/user/profile/123

Gatewayå¤„ç†æµç¨‹ï¼š
â‘  æ¥æ”¶è¯·æ±‚ï¼š/user/profile/123
â‘¡ åŒ¹é…è·¯ç”±ï¼šPath=/user/** åŒ¹é…æˆåŠŸ
â‘¢ ç¡®å®šç›®æ ‡ï¼šlb://user-service (è´Ÿè½½å‡è¡¡åˆ°ç”¨æˆ·æœåŠ¡)
â‘£ åº”ç”¨è¿‡æ»¤å™¨ï¼šStripPrefix=1 å»æ‰ /user
â‘¤ è½¬å‘è¯·æ±‚ï¼šGET http://user-service:8081/profile/123
â‘¥ è¿”å›å“åº”ï¼šå°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯
```

### 5.3 ç½‘å…³è¿‡æ»¤å™¨åº”ç”¨


**ğŸ”§ å…¨å±€è¿‡æ»¤å™¨ç¤ºä¾‹**

```java
// è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨ - å°±åƒç»™æ‰€æœ‰è¯·æ±‚éƒ½åšå®‰æ£€
@Component
public class AuthGlobalFilter implements GlobalFilter, Ordered {
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {
        // è·å–è¯·æ±‚ä¿¡æ¯
        ServerHttpRequest request = exchange.getRequest();
        String path = request.getURI().getPath();
        
        // æ£€æŸ¥æ˜¯å¦éœ€è¦è®¤è¯ï¼ˆç±»ä¼¼é—¨å«æ£€æŸ¥è¯ä»¶ï¼‰
        if (needAuth(path)) {
            String token = request.getHeaders().getFirst("Authorization");
            if (token == null || !isValidToken(token)) {
                // è®¤è¯å¤±è´¥ï¼Œæ‹’ç»è®¿é—®
                ServerHttpResponse response = exchange.getResponse();
                response.setStatusCode(HttpStatus.UNAUTHORIZED);
                return response.setComplete();
            }
        }
        
        // è®¤è¯é€šè¿‡ï¼Œç»§ç»­å¤„ç†ï¼ˆç±»ä¼¼é—¨å«æ”¾è¡Œï¼‰
        return chain.filter(exchange);
    }
    
    private boolean needAuth(String path) {
        // å®šä¹‰å“ªäº›è·¯å¾„éœ€è¦è®¤è¯
        return !path.startsWith("/public/");
    }
    
    private boolean isValidToken(String token) {
        // éªŒè¯tokenæ˜¯å¦æœ‰æ•ˆï¼ˆç®€åŒ–ç¤ºä¾‹ï¼‰
        return "valid-token".equals(token);
    }
    
    @Override
    public int getOrder() {
        return -100;  // ä¼˜å…ˆçº§ï¼Œæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜
    }
}
```

---

## 6. ğŸ›¡ï¸ ç†”æ–­é™æµæœºåˆ¶


### 6.1 ä¸ºä»€ä¹ˆéœ€è¦ç†”æ–­ä¿æŠ¤


**ğŸ¤” ç³»ç»Ÿå´©æºƒçš„è¿é”ååº”**
```
æ²¡æœ‰ç†”æ–­ä¿æŠ¤çš„ç¾éš¾åœºæ™¯ï¼š

æ­£å¸¸æƒ…å†µï¼š
ç”¨æˆ·æœåŠ¡ â†’ è®¢å•æœåŠ¡ â†’ åº“å­˜æœåŠ¡ â†’ æ”¯ä»˜æœåŠ¡
å¤§å®¶éƒ½æ­£å¸¸å·¥ä½œï¼Œå“åº”å¾ˆå¿«

çªå‘æƒ…å†µï¼ˆåº“å­˜æœåŠ¡æŒ‚äº†ï¼‰ï¼š
ç”¨æˆ·æœåŠ¡ â†’ è®¢å•æœåŠ¡ â†’ åº“å­˜æœåŠ¡ï¼ˆè¶…æ—¶ï¼‰
                    â†“
è®¢å•æœåŠ¡ç­‰å¾…åº“å­˜æœåŠ¡å“åº”ï¼Œçº¿ç¨‹è¢«å ç”¨
è¶Šæ¥è¶Šå¤šè¯·æ±‚ç§¯å‹åœ¨è®¢å•æœåŠ¡
è®¢å•æœåŠ¡ä¹Ÿå´©æºƒäº†

è¿é”ååº”ï¼š
åº“å­˜æœåŠ¡æŒ‚ â†’ è®¢å•æœåŠ¡å´© â†’ ç”¨æˆ·æœåŠ¡æ­» â†’ æ•´ä¸ªç³»ç»Ÿç˜«ç—ª

å°±åƒå¤šç±³è¯ºéª¨ç‰Œï¼Œä¸€ä¸ªå€’äº†ï¼Œå…¨éƒ¨è·Ÿç€å€’ï¼
```

**ğŸ’¡ ç†”æ–­å™¨çš„ä¿æŠ¤åŸç†**
```
ç†”æ–­å™¨å°±åƒå®¶é‡Œçš„"ä¿é™©ä¸"ï¼š

æ­£å¸¸æƒ…å†µï¼š
ç”µæµæ­£å¸¸ â†’ ä¿é™©ä¸é—­åˆ â†’ ç”µå™¨æ­£å¸¸å·¥ä½œ

å¼‚å¸¸æƒ…å†µï¼š  
ç”µæµè¿‡å¤§ â†’ ä¿é™©ä¸ç†”æ–­ â†’ ä¿æŠ¤å…¶ä»–ç”µå™¨ä¸è¢«çƒ§å

æœåŠ¡ç†”æ–­ï¼š
æœåŠ¡æ­£å¸¸ â†’ ç†”æ–­å™¨å…³é—­ â†’ æ­£å¸¸è°ƒç”¨æœåŠ¡
æœåŠ¡å¼‚å¸¸ â†’ ç†”æ–­å™¨æ‰“å¼€ â†’ å¿«é€Ÿè¿”å›é”™è¯¯ï¼Œä¸å†è°ƒç”¨
```

### 6.2 Hystrix ç†”æ–­å™¨è¯¦è§£


**ğŸ”¸ Hystrix ä¸‰ç§çŠ¶æ€**

```
ç†”æ–­å™¨çŠ¶æ€è½¬æ¢å›¾ï¼š

     å…³é—­çŠ¶æ€(CLOSED)           æ‰“å¼€çŠ¶æ€(OPEN)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   æ­£å¸¸è°ƒç”¨æœåŠ¡   â”‚       â”‚   ç›´æ¥è¿”å›é”™è¯¯   â”‚
    â”‚                â”‚       â”‚   ä¸è°ƒç”¨æœåŠ¡     â”‚  
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                         â”‚
           â”‚ é”™è¯¯ç‡è¶…é˜ˆå€¼               â”‚ ç­‰å¾…æ—¶é—´åˆ°
           â–¼                         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                â”‚â—„â”€â”€â”€â”€â”€â”€â”¤  åŠå¼€çŠ¶æ€(HALF)  â”‚
    â”‚                â”‚ æˆåŠŸç‡é«˜â”‚                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   å°è¯•è°ƒç”¨æœåŠ¡   â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ ä»ç„¶å¤±è´¥
                                     â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   é‡æ–°æ‰“å¼€      â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ’» Hystrix ä½¿ç”¨ç¤ºä¾‹**

```java
// åœ¨æœåŠ¡è°ƒç”¨æ–¹æ³•ä¸Šæ·»åŠ ç†”æ–­ä¿æŠ¤
@Service
public class OrderService {
    
    @Autowired
    private InventoryFeignClient inventoryClient;
    
    // æ·»åŠ ç†”æ–­å™¨æ³¨è§£
    @HystrixCommand(
        fallbackMethod = "getInventoryFallback",  // ç†”æ–­æ—¶è°ƒç”¨çš„æ–¹æ³•
        commandProperties = {
            @HystrixProperty(name = "execution.isolation.thread.timeoutInMilliseconds", value = "3000"),
            @HystrixProperty(name = "circuitBreaker.errorThresholdPercentage", value = "50"),
            @HystrixProperty(name = "circuitBreaker.requestVolumeThreshold", value = "10")
        }
    )
    public InventoryInfo getInventory(Long productId) {
        // æ­£å¸¸è°ƒç”¨åº“å­˜æœåŠ¡
        return inventoryClient.getInventory(productId);
    }
    
    // ç†”æ–­æ—¶çš„é™çº§æ–¹æ³•ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰
    public InventoryInfo getInventoryFallback(Long productId) {
        // è¿”å›é»˜è®¤å€¼æˆ–ç¼“å­˜æ•°æ®
        InventoryInfo fallback = new InventoryInfo();
        fallback.setProductId(productId);
        fallback.setStock(0);  // é»˜è®¤åº“å­˜ä¸º0
        fallback.setMessage("åº“å­˜æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œæ˜¾ç¤ºé»˜è®¤æ•°æ®");
        return fallback;
    }
}
```

### 6.3 é™æµä¿æŠ¤æœºåˆ¶


**ğŸ“Š å¸¸è§é™æµç®—æ³•**

| ç®—æ³•åç§° | **å·¥ä½œåŸç†** | **é€‚ç”¨åœºæ™¯** |
|---------|-------------|-------------|
| ğŸª£ **ä»¤ç‰Œæ¡¶** | `å›ºå®šé€Ÿç‡æ”¾ä»¤ç‰Œï¼Œæœ‰ä»¤ç‰Œæ‰èƒ½é€šè¿‡` | `å…è®¸çªå‘æµé‡` |
| ğŸª£ **æ¼æ¡¶** | `å›ºå®šé€Ÿç‡å¤„ç†è¯·æ±‚ï¼Œå¤šä½™çš„ä¸¢å¼ƒ` | `æµé‡å¹³æ»‘å¤„ç†` |
| ğŸ”¢ **è®¡æ•°å™¨** | `æ—¶é—´çª—å£å†…é™åˆ¶è¯·æ±‚æ•°é‡` | `ç®€å•åœºæ™¯` |
| ğŸ“ **æ»‘åŠ¨çª—å£** | `æ›´ç²¾ç¡®çš„æ—¶é—´çª—å£æ§åˆ¶` | `ç²¾ç¡®æ§åˆ¶` |

**ğŸ›¡ï¸ Sentinel é™æµç¤ºä¾‹**

```java
// ä½¿ç”¨ Sentinel è¿›è¡Œé™æµä¿æŠ¤
@RestController
public class OrderController {
    
    // ä½¿ç”¨æ³¨è§£æ–¹å¼é™æµ
    @SentinelResource(
        value = "createOrder",           // èµ„æºåç§°
        blockHandler = "orderBlockHandler"  // è¢«é™æµæ—¶è°ƒç”¨çš„æ–¹æ³•
    )
    @PostMapping("/orders")
    public Result<Order> createOrder(@RequestBody OrderRequest request) {
        // æ­£å¸¸çš„è®¢å•åˆ›å»ºé€»è¾‘
        Order order = orderService.createOrder(request);
        return Result.success(order);
    }
    
    // é™æµæ—¶çš„å¤„ç†æ–¹æ³•
    public Result<Order> orderBlockHandler(OrderRequest request, BlockException ex) {
        return Result.error("ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•");
    }
}
```

**âš™ï¸ é™æµè§„åˆ™é…ç½®**
```java
// ä»£ç æ–¹å¼é…ç½®é™æµè§„åˆ™
@PostConstruct  
public void initFlowRules() {
    List<FlowRule> rules = new ArrayList<>();
    
    FlowRule rule = new FlowRule();
    rule.setResource("createOrder");     // èµ„æºåç§°
    rule.setGrade(RuleConstant.FLOW_GRADE_QPS);  // æŒ‰QPSé™æµ
    rule.setCount(10);                   // æ¯ç§’æœ€å¤š10ä¸ªè¯·æ±‚
    rule.setStrategy(RuleConstant.STRATEGY_DIRECT);  // ç›´æ¥æ‹’ç»
    
    rules.add(rule);
    FlowRuleManager.loadRules(rules);   // åŠ è½½è§„åˆ™
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ å¾®æœåŠ¡æœ¬è´¨ï¼šå°†å¤§ç³»ç»Ÿæ‹†åˆ†æˆå¤šä¸ªå°æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡ç‹¬ç«‹éƒ¨ç½²è¿è¡Œ
ğŸ”¸ æ³¨å†Œä¸­å¿ƒï¼šæœåŠ¡çš„"ç”µè¯ç°¿"ï¼Œç®¡ç†æ‰€æœ‰æœåŠ¡çš„åœ°å€ä¿¡æ¯  
ğŸ”¸ æœåŠ¡è°ƒç”¨ï¼šé€šè¿‡Feignå®ç°æœåŠ¡é—´çš„è¿œç¨‹è°ƒç”¨ï¼Œåƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·ç®€å•
ğŸ”¸ è´Ÿè½½å‡è¡¡ï¼šæ™ºèƒ½åˆ†é…è¯·æ±‚åˆ°å¤šä¸ªæœåŠ¡å®ä¾‹ï¼Œé¿å…å•ç‚¹å‹åŠ›è¿‡å¤§
ğŸ”¸ é…ç½®ä¸­å¿ƒï¼šç»Ÿä¸€ç®¡ç†æ‰€æœ‰æœåŠ¡çš„é…ç½®ï¼Œæ”¯æŒåŠ¨æ€æ›´æ–°
ğŸ”¸ APIç½‘å…³ï¼šç³»ç»Ÿçš„ç»Ÿä¸€å…¥å£ï¼Œè´Ÿè´£è·¯ç”±ã€è®¤è¯ã€é™æµç­‰
ğŸ”¸ ç†”æ–­é™æµï¼šä¿æŠ¤ç³»ç»Ÿç¨³å®šæ€§ï¼Œé˜²æ­¢é›ªå´©æ•ˆåº”
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ å¾®æœåŠ¡ä¸æ˜¯ä¸‡èƒ½çš„**
```
ä¼˜åŠ¿ï¼š
âœ… æŠ€æœ¯æ ˆçµæ´»ï¼Œå›¢é˜Ÿç‹¬ç«‹å¼€å‘
âœ… æœåŠ¡ç‹¬ç«‹éƒ¨ç½²ï¼Œæ•…éšœéš”ç¦»
âœ… æŒ‰éœ€æ‰©å±•ï¼Œèµ„æºåˆ©ç”¨ç‡é«˜

æŒ‘æˆ˜ï¼š
âš ï¸ ç³»ç»Ÿå¤æ‚åº¦å¢åŠ 
âš ï¸ ç½‘ç»œé€šä¿¡å¼€é”€
âš ï¸ æ•°æ®ä¸€è‡´æ€§é—®é¢˜
âš ï¸ è¿ç»´ç›‘æ§å¤æ‚

é€‚ç”¨åœºæ™¯ï¼š
- å›¢é˜Ÿè§„æ¨¡è¾ƒå¤§ï¼ˆ>20äººï¼‰
- ä¸šåŠ¡å¤æ‚åº¦é«˜
- é«˜å¯ç”¨è¦æ±‚
- éœ€è¦ç‹¬ç«‹æŠ€æœ¯é€‰å‹
```

**ğŸ”¹ Spring Cloud ç»„ä»¶é€‰æ‹©**

| ä¸šåŠ¡åœºæ™¯ | **æ¨èç»„ä»¶** | **åŸå› ** |
|---------|-------------|---------|
| ğŸ¢ **ä¸­å°å›¢é˜Ÿ** | `Eureka + Feign + Config` | `ç®€å•å¤Ÿç”¨ï¼Œå­¦ä¹ æˆæœ¬ä½` |
| ğŸ­ **å¤§å‹ä¼ä¸š** | `Nacos + Gateway + Sentinel` | `åŠŸèƒ½å¼ºå¤§ï¼Œæ€§èƒ½æ›´å¥½` |
| â˜ï¸ **äº‘åŸç”Ÿ** | `Consul + Istio` | `ä¸K8sæ·±åº¦é›†æˆ` |

### 7.3 å®é™…åº”ç”¨å»ºè®®


**ğŸ¯ å¾®æœåŠ¡æ‹†åˆ†åŸåˆ™**
```
åˆç†æ‹†åˆ†ï¼š
âœ… æŒ‰ä¸šåŠ¡é¢†åŸŸæ‹†åˆ†ï¼ˆç”¨æˆ·ã€è®¢å•ã€å•†å“ï¼‰
âœ… å•ä¸€èŒè´£ï¼Œé«˜å†…èšä½è€¦åˆ
âœ… æ•°æ®åº“ç‹¬ç«‹ï¼Œé¿å…å…±äº«

é¿å…è¿‡åº¦æ‹†åˆ†ï¼š
âŒ ä¸è¦ä¸ºäº†æ‹†åˆ†è€Œæ‹†åˆ†
âŒ é¿å…åˆ†å¸ƒå¼äº‹åŠ¡è¿‡å¤š
âŒ è€ƒè™‘å›¢é˜Ÿç»´æŠ¤èƒ½åŠ›
```

**ğŸ”§ å¼€å‘éƒ¨ç½²å»ºè®®**
```
å¼€å‘é˜¶æ®µï¼š
1ï¸âƒ£ å…ˆåšå•ä½“åº”ç”¨ï¼Œä¸šåŠ¡ç¨³å®šåå†æ‹†åˆ†
2ï¸âƒ£ ä½¿ç”¨Dockerå®¹å™¨åŒ–éƒ¨ç½²
3ï¸âƒ£ å®Œå–„ç›‘æ§å’Œæ—¥å¿—ç³»ç»Ÿ

ç”Ÿäº§éƒ¨ç½²ï¼š
1ï¸âƒ£ æœåŠ¡æ³¨å†Œä¸­å¿ƒé›†ç¾¤éƒ¨ç½²
2ï¸âƒ£ é…ç½®ä¸­å¿ƒä½¿ç”¨Gitç®¡ç†
3ï¸âƒ£ ç½‘å…³åšé«˜å¯ç”¨éƒ¨ç½²
4ï¸âƒ£ ç†”æ–­é™æµå‚æ•°è¦è°ƒä¼˜
```

**ğŸ’¡ å­¦ä¹ è·¯å¾„å»ºè®®**

```
å­¦ä¹ é¡ºåº ğŸŸ¢å…¥é—¨ â†’ ğŸŸ¡è¿›é˜¶ â†’ ğŸ”´é«˜çº§

ç¬¬ä¸€é˜¶æ®µ ğŸŸ¢ï¼š
- Spring Boot åŸºç¡€
- å¾®æœåŠ¡æ¦‚å¿µç†è§£  
- Eureka æ³¨å†Œä¸­å¿ƒ
- Feign æœåŠ¡è°ƒç”¨

ç¬¬äºŒé˜¶æ®µ ğŸŸ¡ï¼š
- Config é…ç½®ä¸­å¿ƒ
- Gateway ç½‘å…³åº”ç”¨
- è´Ÿè½½å‡è¡¡åŸç†
- ç®€å•çš„ç†”æ–­ä¿æŠ¤

ç¬¬ä¸‰é˜¶æ®µ ğŸ”´ï¼š
- åˆ†å¸ƒå¼äº‹åŠ¡
- æœåŠ¡é“¾è·¯è¿½è¸ª
- å®¹å™¨åŒ–éƒ¨ç½²
- æ€§èƒ½è°ƒä¼˜ç›‘æ§
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
å¾®æœåŠ¡æ¶æ„è¦è®°ç‰¢ï¼Œ
æ³¨å†Œå‘ç°æ˜¯åŸºç¡€ï¼Œ
ç½‘å…³è·¯ç”±å¾ˆé‡è¦ï¼Œ
é…ç½®ç»Ÿä¸€å¥½ç®¡ç†ï¼Œ
ç†”æ–­é™æµä¿ç¨³å®šï¼Œ
å¾ªåºæ¸è¿›å­¦å¾—å¥½ï¼
```