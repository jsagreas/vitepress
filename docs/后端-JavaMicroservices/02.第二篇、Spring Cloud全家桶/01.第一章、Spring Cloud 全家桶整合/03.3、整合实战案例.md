---
title: 3ã€æ•´åˆå®æˆ˜æ¡ˆä¾‹
---
## ğŸ“š ç›®å½•

1. [ç”µå•†ç³»ç»Ÿå¾®æœåŠ¡æ¶æ„è®¾è®¡](#1-ç”µå•†ç³»ç»Ÿå¾®æœåŠ¡æ¶æ„è®¾è®¡)
2. [ç”¨æˆ·æœåŠ¡è®¾è®¡ä¸å®ç°](#2-ç”¨æˆ·æœåŠ¡è®¾è®¡ä¸å®ç°)
3. [è®¢å•æœåŠ¡è®¾è®¡ä¸å®ç°](#3-è®¢å•æœåŠ¡è®¾è®¡ä¸å®ç°)
4. [æ”¯ä»˜æœåŠ¡è®¾è®¡ä¸å®ç°](#4-æ”¯ä»˜æœåŠ¡è®¾è®¡ä¸å®ç°)
5. [åº“å­˜æœåŠ¡è®¾è®¡ä¸å®ç°](#5-åº“å­˜æœåŠ¡è®¾è®¡ä¸å®ç°)
6. [æœåŠ¡é—´é€šä¿¡æ–¹æ¡ˆ](#6-æœåŠ¡é—´é€šä¿¡æ–¹æ¡ˆ)
7. [æ•°æ®ä¸€è‡´æ€§å¤„ç†ç­–ç•¥](#7-æ•°æ®ä¸€è‡´æ€§å¤„ç†ç­–ç•¥)
8. [Spring Cloudç»„ä»¶è½åœ°å®è·µ](#8-Spring-Cloudç»„ä»¶è½åœ°å®è·µ)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸª ç”µå•†ç³»ç»Ÿå¾®æœåŠ¡æ¶æ„è®¾è®¡


### 1.1 æ•´ä½“æ¶æ„æ¦‚è§ˆ


> ğŸ’¡ **ä»€ä¹ˆæ˜¯å¾®æœåŠ¡æ¶æ„**  
> æŠŠä¸€ä¸ªå¤§å‹ç”µå•†ç³»ç»Ÿæ‹†åˆ†æˆå¤šä¸ªå°çš„ã€ç‹¬ç«‹çš„æœåŠ¡ï¼Œå°±åƒæŠŠä¸€å®¶å¤§è¶…å¸‚æ‹†åˆ†æˆä¸“é—¨çš„éƒ¨é—¨ï¼šç”¨æˆ·éƒ¨ã€è®¢å•éƒ¨ã€æ”¯ä»˜éƒ¨ã€ä»“åº“éƒ¨ï¼Œæ¯ä¸ªéƒ¨é—¨å„å¸å…¶èŒä½†èƒ½ååŒå·¥ä½œã€‚

**ğŸ—ï¸ ç³»ç»Ÿæ¶æ„å›¾ç¤º**
```
                        ç”¨æˆ·ç•Œé¢å±‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Webå‰ç«¯/APP   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   APIç½‘å…³       â”‚ â† ç»Ÿä¸€å…¥å£ï¼Œè·¯ç”±åˆ†å‘
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ç”¨æˆ·æœåŠ¡â”‚         â”‚è®¢å•æœåŠ¡ â”‚         â”‚æ”¯ä»˜æœåŠ¡ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                   â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚åº“å­˜æœåŠ¡ â”‚         â”‚  æ³¨å†Œä¸­å¿ƒ   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 å¾®æœåŠ¡æ‹†åˆ†åŸåˆ™


**ğŸ¯ æ‹†åˆ†ä¾æ®**
- **ä¸šåŠ¡è¾¹ç•Œæ¸…æ™°**ï¼šæŒ‰ç…§ä¸šåŠ¡åŠŸèƒ½åˆ’åˆ†ï¼Œæ¯”å¦‚ç”¨æˆ·ç®¡ç†ã€è®¢å•å¤„ç†ã€æ”¯ä»˜ç»“ç®—
- **æ•°æ®ç‹¬ç«‹**ï¼šæ¯ä¸ªæœåŠ¡ç®¡ç†è‡ªå·±çš„æ•°æ®ï¼Œä¸ç›´æ¥è®¿é—®å…¶ä»–æœåŠ¡çš„æ•°æ®åº“
- **å›¢é˜Ÿåˆ†å·¥**ï¼šä¸€ä¸ªå°å›¢é˜Ÿå¯ä»¥å®Œå…¨è´Ÿè´£ä¸€ä¸ªæœåŠ¡çš„å¼€å‘å’Œç»´æŠ¤
- **æŠ€æœ¯ç‹¬ç«‹**ï¼šä¸åŒæœåŠ¡å¯ä»¥é€‰æ‹©æœ€é€‚åˆçš„æŠ€æœ¯æ ˆ

> ğŸ” **ç”Ÿæ´»ç±»æ¯”**  
> å°±åƒåŒ»é™¢çš„ç§‘å®¤åˆ†å·¥ï¼šå†…ç§‘ã€å¤–ç§‘ã€å„¿ç§‘å„æœ‰ä¸“é—¨çš„åŒ»ç”Ÿå’Œè®¾å¤‡ï¼Œç—…äººæ ¹æ®ç—…æƒ…åˆ°å¯¹åº”ç§‘å®¤å°±è¯Šï¼Œç§‘å®¤é—´ä¼šç›¸äº’åä½œä½†ä¿æŒä¸“ä¸šç‹¬ç«‹ã€‚

**ğŸ“Š æœåŠ¡è§„åˆ’è¡¨**

| æœåŠ¡åç§° | æ ¸å¿ƒèŒè´£ | æ•°æ®ç®¡ç† | å¯¹å¤–æ¥å£ |
|---------|---------|---------|---------|
| ğŸ§‘â€ğŸ’¼ **ç”¨æˆ·æœåŠ¡** | `ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ä¸ªäººä¿¡æ¯ç®¡ç†` | `ç”¨æˆ·è¡¨ã€æƒé™è¡¨` | `ç”¨æˆ·è®¤è¯APIã€ç”¨æˆ·ä¿¡æ¯API` |
| ğŸ“¦ **è®¢å•æœåŠ¡** | `è®¢å•åˆ›å»ºã€æŸ¥è¯¢ã€çŠ¶æ€ç®¡ç†` | `è®¢å•è¡¨ã€è®¢å•è¯¦æƒ…è¡¨` | `ä¸‹å•APIã€è®¢å•æŸ¥è¯¢API` |
| ğŸ’³ **æ”¯ä»˜æœåŠ¡** | `æ”¯ä»˜å¤„ç†ã€é€€æ¬¾ã€è´¦å•ç®¡ç†` | `æ”¯ä»˜è®°å½•è¡¨ã€è´¦æˆ·è¡¨` | `æ”¯ä»˜APIã€é€€æ¬¾API` |
| ğŸ“¦ **åº“å­˜æœåŠ¡** | `å•†å“åº“å­˜ç®¡ç†ã€é¢„å ã€é‡Šæ”¾` | `åº“å­˜è¡¨ã€é¢„å è¡¨` | `åº“å­˜æŸ¥è¯¢APIã€åº“å­˜æ‰£å‡API` |

---

## 2. ğŸ‘¤ ç”¨æˆ·æœåŠ¡è®¾è®¡ä¸å®ç°


### 2.1 ç”¨æˆ·æœåŠ¡æ ¸å¿ƒåŠŸèƒ½


> ğŸ“– **ç”¨æˆ·æœåŠ¡çš„ä½œç”¨**  
> ç”¨æˆ·æœåŠ¡å°±åƒå•†åœºçš„ä¼šå‘˜ä¸­å¿ƒï¼Œè´Ÿè´£ç®¡ç†æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯ã€å¤„ç†ç™»å½•æ³¨å†Œã€éªŒè¯ç”¨æˆ·èº«ä»½ã€‚å…¶ä»–æœåŠ¡éœ€è¦çŸ¥é“"è°åœ¨æ“ä½œ"æ—¶ï¼Œéƒ½è¦æ‰¾ç”¨æˆ·æœåŠ¡ç¡®è®¤ã€‚

**ğŸ”‘ æ ¸å¿ƒåŠŸèƒ½æ¸…å•**
- âœ… **ç”¨æˆ·æ³¨å†Œ**ï¼šæ–°ç”¨æˆ·è´¦å·åˆ›å»º
- âœ… **ç”¨æˆ·ç™»å½•**ï¼šèº«ä»½éªŒè¯å’Œä»¤ç‰Œé¢å‘
- âœ… **ä¸ªäººä¿¡æ¯**ï¼šæŸ¥çœ‹å’Œä¿®æ”¹ç”¨æˆ·èµ„æ–™
- âœ… **æƒé™ç®¡ç†**ï¼šç”¨æˆ·è§’è‰²å’Œæƒé™æ§åˆ¶
- âœ… **å¯†ç ç®¡ç†**ï¼šå¯†ç ä¿®æ”¹ã€æ‰¾å›åŠŸèƒ½

### 2.2 æ•°æ®æ¨¡å‹è®¾è®¡


**ğŸ“‹ ç”¨æˆ·è¡¨ç»“æ„**
```sql
-- ç”¨æˆ·åŸºæœ¬ä¿¡æ¯è¡¨
CREATE TABLE users (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) UNIQUE NOT NULL COMMENT 'ç”¨æˆ·å',
    password VARCHAR(100) NOT NULL COMMENT 'å¯†ç (åŠ å¯†)',
    email VARCHAR(100) COMMENT 'é‚®ç®±',
    phone VARCHAR(20) COMMENT 'æ‰‹æœºå·',
    status INT DEFAULT 1 COMMENT 'çŠ¶æ€:1æ­£å¸¸,0ç¦ç”¨',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

### 2.3 å…³é”®æ¥å£è®¾è®¡


**ğŸ”Œ ç”¨æˆ·æœåŠ¡APIæ¥å£**

| æ¥å£è·¯å¾„ | è¯·æ±‚æ–¹å¼ | åŠŸèƒ½è¯´æ˜ | è¿”å›æ•°æ® |
|---------|---------|---------|---------|
| `/user/register` | `POST` | `ç”¨æˆ·æ³¨å†Œ` | `æ³¨å†Œç»“æœ` |
| `/user/login` | `POST` | `ç”¨æˆ·ç™»å½•` | `JWTä»¤ç‰Œ` |
| `/user/info/{id}` | `GET` | `è·å–ç”¨æˆ·ä¿¡æ¯` | `ç”¨æˆ·è¯¦æƒ…` |
| `/user/update` | `PUT` | `æ›´æ–°ç”¨æˆ·ä¿¡æ¯` | `æ›´æ–°ç»“æœ` |

**ğŸ’» ç™»å½•æ¥å£ç¤ºä¾‹ä»£ç **
```java
@RestController
@RequestMapping("/user")
public class UserController {
    
    @Autowired
    private UserService userService;
    
    // ç”¨æˆ·ç™»å½•æ¥å£
    @PostMapping("/login")
    public Result login(@RequestBody LoginRequest request) {
        // 1. éªŒè¯ç”¨æˆ·åå¯†ç 
        User user = userService.validateUser(request.getUsername(), request.getPassword());
        
        // 2. ç”ŸæˆJWTä»¤ç‰Œ
        String token = jwtUtil.generateToken(user.getId(), user.getUsername());
        
        // 3. è¿”å›ç™»å½•ç»“æœ
        return Result.success(new LoginResponse(token, user));
    }
}
```

> ğŸ’¡ **JWTä»¤ç‰Œçš„ä½œç”¨**  
> JWTå°±åƒç”µå½±é™¢çš„é—¨ç¥¨ï¼Œä¸€æ¬¡éªŒè¯åå¯ä»¥åœ¨æœ‰æ•ˆæœŸå†…è¯æ˜ä½ çš„èº«ä»½ï¼Œå…¶ä»–æœåŠ¡çœ‹åˆ°è¿™å¼ "ç¥¨"å°±çŸ¥é“ä½ æ˜¯è°ï¼Œä¸ç”¨æ¯æ¬¡éƒ½é‡æ–°éªŒè¯ã€‚

---

## 3. ğŸ“‹ è®¢å•æœåŠ¡è®¾è®¡ä¸å®ç°


### 3.1 è®¢å•æœåŠ¡ä¸šåŠ¡æµç¨‹


> ğŸ“– **è®¢å•æœåŠ¡çš„èŒè´£**  
> è®¢å•æœåŠ¡åƒå•†åœºçš„æ”¶é“¶å°ï¼Œè´Ÿè´£å¤„ç†é¡¾å®¢çš„è´­ä¹°è¯·æ±‚ï¼šè®°å½•ä¹°äº†ä»€ä¹ˆã€å¤šå°‘é’±ã€ä»€ä¹ˆæ—¶å€™ä¹°çš„ï¼Œå¹¶åè°ƒå…¶ä»–éƒ¨é—¨å®Œæˆæ•´ä¸ªè´­ä¹°æµç¨‹ã€‚

**ğŸ”„ ä¸‹å•æµç¨‹å›¾**
```
ç”¨æˆ·ä¸‹å• â†’ éªŒè¯ç”¨æˆ· â†’ æ£€æŸ¥åº“å­˜ â†’ åˆ›å»ºè®¢å• â†’ æ‰£å‡åº“å­˜ â†’ è°ƒç”¨æ”¯ä»˜ â†’ å®Œæˆè®¢å•
   â†“           â†“           â†“           â†“           â†“           â†“           â†“
[é€‰æ‹©å•†å“]  [ç”¨æˆ·æœåŠ¡]   [åº“å­˜æœåŠ¡]   [è®¢å•å…¥åº“]   [åº“å­˜æœåŠ¡]   [æ”¯ä»˜æœåŠ¡]   [è®¢å•å®Œæˆ]
```

### 3.2 è®¢å•çŠ¶æ€ç®¡ç†


**ğŸ“Š è®¢å•çŠ¶æ€æµè½¬**
```
å¾…ä»˜æ¬¾ â”€â”€æ”¯ä»˜æˆåŠŸâ”€â”€> å¾…å‘è´§ â”€â”€å•†å®¶å‘è´§â”€â”€> å¾…æ”¶è´§ â”€â”€ç”¨æˆ·ç¡®è®¤â”€â”€> å·²å®Œæˆ
  â”‚                    â”‚                    â”‚                    â”‚
  â”‚                    â”‚                    â”‚                    â”‚
  â””â”€è¶…æ—¶å–æ¶ˆâ”€> å·²å–æ¶ˆ    â””â”€ç”¨æˆ·å–æ¶ˆâ”€> å·²å–æ¶ˆ    â””â”€ç”³è¯·é€€æ¬¾â”€> é€€æ¬¾ä¸­ â”€> å·²é€€æ¬¾
```

**ğŸ¯ è®¢å•çŠ¶æ€è¯´æ˜**

| çŠ¶æ€ç  | çŠ¶æ€åç§° | å«ä¹‰è¯´æ˜ | å¯æ‰§è¡Œæ“ä½œ |
|-------|---------|---------|-----------|
| `1` | **å¾…ä»˜æ¬¾** | `è®¢å•å·²åˆ›å»ºï¼Œç­‰å¾…ç”¨æˆ·ä»˜æ¬¾` | `ä»˜æ¬¾ã€å–æ¶ˆ` |
| `2` | **å¾…å‘è´§** | `å·²ä»˜æ¬¾ï¼Œç­‰å¾…å•†å®¶å‘è´§` | `å‘è´§ã€é€€æ¬¾` |
| `3` | **å¾…æ”¶è´§** | `å·²å‘è´§ï¼Œç­‰å¾…ç”¨æˆ·æ”¶è´§` | `ç¡®è®¤æ”¶è´§ã€ç”³è¯·é€€è´§` |
| `4` | **å·²å®Œæˆ** | `äº¤æ˜“æ­£å¸¸å®Œæˆ` | `è¯„ä»·ã€å†æ¬¡è´­ä¹°` |
| `0` | **å·²å–æ¶ˆ** | `è®¢å•è¢«å–æ¶ˆ` | `åˆ é™¤è®¢å•` |

### 3.3 æ ¸å¿ƒä¸šåŠ¡é€»è¾‘


**ğŸ’» ä¸‹å•æ ¸å¿ƒä»£ç **
```java
@Service
public class OrderService {
    
    @Autowired
    private UserService userService;
    @Autowired
    private InventoryService inventoryService;
    
    // åˆ›å»ºè®¢å•çš„æ ¸å¿ƒæ–¹æ³•
    @Transactional
    public Order createOrder(CreateOrderRequest request) {
        // 1. éªŒè¯ç”¨æˆ·æ˜¯å¦å­˜åœ¨
        User user = userService.getUserById(request.getUserId());
        if (user == null) {
            throw new BusinessException("ç”¨æˆ·ä¸å­˜åœ¨");
        }
        
        // 2. æ£€æŸ¥å•†å“åº“å­˜
        boolean hasStock = inventoryService.checkStock(
            request.getProductId(), 
            request.getQuantity()
        );
        if (!hasStock) {
            throw new BusinessException("åº“å­˜ä¸è¶³");
        }
        
        // 3. åˆ›å»ºè®¢å•
        Order order = new Order();
        order.setUserId(request.getUserId());
        order.setProductId(request.getProductId());
        order.setQuantity(request.getQuantity());
        order.setAmount(calculateAmount(request));
        order.setStatus(OrderStatus.PENDING_PAYMENT);
        
        // 4. ä¿å­˜è®¢å•
        return orderRepository.save(order);
    }
}
```

---

## 4. ğŸ’³ æ”¯ä»˜æœåŠ¡è®¾è®¡ä¸å®ç°


### 4.1 æ”¯ä»˜æœåŠ¡æ ¸å¿ƒåŠŸèƒ½


> ğŸ“– **æ”¯ä»˜æœåŠ¡çš„ä½œç”¨**  
> æ”¯ä»˜æœåŠ¡å°±åƒé“¶è¡ŒæŸœå°ï¼Œä¸“é—¨å¤„ç†é’±æ¬¾ç›¸å…³çš„äº‹åŠ¡ï¼šæ”¶æ¬¾ã€é€€æ¬¾ã€æŸ¥è´¦ï¼Œç¡®ä¿æ¯ç¬”é’±çš„è¿›å‡ºéƒ½æœ‰è®°å½•ï¼Œå¹¶ä¸”å®‰å…¨å¯é ã€‚

**ğŸ’° æ”¯ä»˜æµç¨‹è®¾è®¡**
```
è®¢å•æ”¯ä»˜è¯·æ±‚ â†’ ç”Ÿæˆæ”¯ä»˜å• â†’ è°ƒç”¨ç¬¬ä¸‰æ–¹æ”¯ä»˜ â†’ æ¥æ”¶æ”¯ä»˜ç»“æœ â†’ æ›´æ–°æ”¯ä»˜çŠ¶æ€ â†’ é€šçŸ¥è®¢å•æœåŠ¡
      â†“              â†“              â†“              â†“              â†“              â†“
  [éªŒè¯è®¢å•]      [åˆ›å»ºæ”¯ä»˜è®°å½•]   [å¾®ä¿¡/æ”¯ä»˜å®]    [å¼‚æ­¥å›è°ƒ]     [çŠ¶æ€æ›´æ–°]     [è®¢å•çŠ¶æ€å˜æ›´]
```

### 4.2 æ”¯ä»˜æ–¹å¼é›†æˆ


**ğŸ”§ æ”¯ä»˜æ¸ é“é…ç½®**

| æ”¯ä»˜æ–¹å¼ | é€‚ç”¨åœºæ™¯ | é›†æˆéš¾åº¦ | ç‰¹ç‚¹è¯´æ˜ |
|---------|---------|---------|---------|
| ğŸŸ¢ **å¾®ä¿¡æ”¯ä»˜** | `ç§»åŠ¨ç«¯ã€å°ç¨‹åº` | `ä¸­ç­‰` | `ç”¨æˆ·é‡å¤§ï¼Œä½“éªŒå¥½` |
| ğŸ”µ **æ”¯ä»˜å®** | `PCç«¯ã€ç§»åŠ¨ç«¯` | `ä¸­ç­‰` | `è¦†ç›–é¢å¹¿ï¼Œå®‰å…¨æ€§é«˜` |
| ğŸ’³ **é“¶è¡Œå¡** | `å¤§é¢æ”¯ä»˜` | `å¤æ‚` | `ç›´è¿é“¶è¡Œï¼Œæ‰‹ç»­è´¹ä½` |
| ğŸ **ä½™é¢æ”¯ä»˜** | `å°é¢å¿«é€Ÿæ”¯ä»˜` | `ç®€å•` | `å†…éƒ¨ç³»ç»Ÿï¼Œå“åº”å¿«` |

### 4.3 æ”¯ä»˜å®‰å…¨ä¿éšœ


> âš ï¸ **æ”¯ä»˜å®‰å…¨é‡è¦æé†’**  
> æ”¯ä»˜æ¶‰åŠèµ„é‡‘å®‰å…¨ï¼Œå¿…é¡»åšå¥½é˜²æŠ¤æªæ–½ï¼šæ•°æ®åŠ å¯†ä¼ è¾“ã€æ¥å£ç­¾åéªŒè¯ã€é‡å¤æ”¯ä»˜æ£€æŸ¥ã€å¼‚å¸¸ç›‘æ§å‘Šè­¦ã€‚

**ğŸ›¡ï¸ å®‰å…¨æªæ–½æ¸…å•**
- âœ… **æ•°æ®åŠ å¯†**ï¼šæ•æ„Ÿä¿¡æ¯AESåŠ å¯†å­˜å‚¨
- âœ… **ç­¾åéªŒè¯**ï¼šæ¥å£è¯·æ±‚MD5ç­¾åæ ¡éªŒ
- âœ… **é˜²é‡æäº¤**ï¼šè®¢å•å·+ç”¨æˆ·IDå”¯ä¸€æ€§æ£€æŸ¥
- âœ… **é‡‘é¢æ ¡éªŒ**ï¼šå‰åç«¯é‡‘é¢ä¸€è‡´æ€§éªŒè¯
- âœ… **å¼‚å¸¸ç›‘æ§**ï¼šæ”¯ä»˜å¼‚å¸¸å®æ—¶å‘Šè­¦

**ğŸ’» æ”¯ä»˜æ ¸å¿ƒé€»è¾‘**
```java
@Service
public class PaymentService {
    
    // å¤„ç†æ”¯ä»˜è¯·æ±‚
    @Transactional
    public PaymentResult processPayment(PaymentRequest request) {
        // 1. éªŒè¯è®¢å•çŠ¶æ€
        Order order = orderService.getOrder(request.getOrderId());
        if (!order.getStatus().equals(OrderStatus.PENDING_PAYMENT)) {
            throw new BusinessException("è®¢å•çŠ¶æ€ä¸å…è®¸æ”¯ä»˜");
        }
        
        // 2. åˆ›å»ºæ”¯ä»˜è®°å½•
        Payment payment = new Payment();
        payment.setOrderId(request.getOrderId());
        payment.setAmount(order.getAmount());
        payment.setPayMethod(request.getPayMethod());
        payment.setStatus(PaymentStatus.PROCESSING);
        paymentRepository.save(payment);
        
        // 3. è°ƒç”¨ç¬¬ä¸‰æ–¹æ”¯ä»˜æ¥å£
        try {
            ThirdPayResult result = thirdPayService.pay(payment);
            return PaymentResult.success(result.getPayUrl());
        } catch (Exception e) {
            // æ”¯ä»˜å¤±è´¥ï¼Œæ›´æ–°çŠ¶æ€
            payment.setStatus(PaymentStatus.FAILED);
            paymentRepository.save(payment);
            throw new BusinessException("æ”¯ä»˜å¤„ç†å¤±è´¥");
        }
    }
}
```

---

## 5. ğŸ“¦ åº“å­˜æœåŠ¡è®¾è®¡ä¸å®ç°


### 5.1 åº“å­˜æœåŠ¡æ ¸å¿ƒèŒè´£


> ğŸ“– **åº“å­˜æœåŠ¡çš„ä½œç”¨**  
> åº“å­˜æœåŠ¡åƒä»“åº“ç®¡ç†å‘˜ï¼Œè´Ÿè´£è®°å½•å•†å“æ•°é‡ã€å¤„ç†è¿›å‡ºåº“ã€é¢„ç•™å•†å“ç»™ä¸‹å•ç”¨æˆ·ï¼Œç¡®ä¿ä¸ä¼šå‡ºç°è¶…å–æˆ–ç¼ºè´§çš„æƒ…å†µã€‚

**ğŸ“Š åº“å­˜ç®¡ç†æ ¸å¿ƒåŠŸèƒ½**
- âœ… **åº“å­˜æŸ¥è¯¢**ï¼šå®æ—¶æŸ¥çœ‹å•†å“å‰©ä½™æ•°é‡
- âœ… **åº“å­˜é¢„å **ï¼šä¸‹å•æ—¶ä¸´æ—¶é”å®šåº“å­˜
- âœ… **åº“å­˜æ‰£å‡**ï¼šæ”¯ä»˜æˆåŠŸåæ­£å¼å‡å°‘åº“å­˜
- âœ… **åº“å­˜é‡Šæ”¾**ï¼šè®¢å•å–æ¶ˆæ—¶é‡Šæ”¾é¢„å åº“å­˜
- âœ… **è¡¥è´§å…¥åº“**ï¼šé‡‡è´­å•†å“å¢åŠ åº“å­˜

### 5.2 åº“å­˜é¢„å æœºåˆ¶


> ğŸ’¡ **ä¸ºä»€ä¹ˆéœ€è¦é¢„å åº“å­˜**  
> å°±åƒç”µå½±é™¢é€‰åº§ä¸€æ ·ï¼Œä½ é€‰å®šåº§ä½åˆ°ä»˜æ¬¾å®Œæˆè¿™æ®µæ—¶é—´ï¼Œåº§ä½ä¼šä¸ºä½ ä¿ç•™ï¼Œé˜²æ­¢åˆ«äººæŠ¢å ã€‚åº“å­˜é¢„å ä¹Ÿæ˜¯è¿™ä¸ªé“ç†ï¼Œé¿å…å¤šäººåŒæ—¶ä¸‹å•åŒä¸€å•†å“æ—¶å‡ºç°è¶…å–ã€‚

**ğŸ”„ åº“å­˜é¢„å æµç¨‹**
```
ç”¨æˆ·ä¸‹å• â†’ æ£€æŸ¥åº“å­˜ â†’ é¢„å åº“å­˜ â†’ ç”¨æˆ·æ”¯ä»˜ â†’ æ‰£å‡åº“å­˜
    â†“          â†“          â†“          â†“          â†“
  [æäº¤è®¢å•]  [æŸ¥çœ‹ä½™é‡]  [ä¸´æ—¶é”å®š]  [å®Œæˆä»˜æ¬¾]  [ç¡®è®¤å‡ºåº“]
    
å¦‚æœè¶…æ—¶æœªæ”¯ä»˜ â†’ é‡Šæ”¾é¢„å  â†’ åº“å­˜æ¢å¤
```

### 5.3 é˜²æ­¢è¶…å–æ–¹æ¡ˆ


**âš¡ é«˜å¹¶å‘åº“å­˜æ‰£å‡**

| æ–¹æ¡ˆç±»å‹ | å®ç°æ–¹å¼ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|---------|---------|------|------|----------|
| ğŸ”’ **æ•°æ®åº“é”** | `SELECT FOR UPDATE` | `ç®€å•å¯é ` | `æ€§èƒ½è¾ƒä½` | `ä¸­ç­‰å¹¶å‘` |
| âš¡ **Redisé”** | `åˆ†å¸ƒå¼é”+Luaè„šæœ¬` | `æ€§èƒ½é«˜` | `å¤æ‚åº¦é«˜` | `é«˜å¹¶å‘` |
| ğŸ”¢ **ä¹è§‚é”** | `ç‰ˆæœ¬å·æœºåˆ¶` | `æ— é”ç­‰å¾…` | `é‡è¯•å¼€é”€` | `å†²çªè¾ƒå°‘` |
| ğŸ“¨ **æ¶ˆæ¯é˜Ÿåˆ—** | `å¼‚æ­¥ä¸²è¡ŒåŒ–å¤„ç†` | `å‰Šå³°å¡«è°·` | `å®æ—¶æ€§å·®` | `ç§’æ€åœºæ™¯` |

**ğŸ’» Redisåˆ†å¸ƒå¼é”å®ç°**
```java
@Service
public class InventoryService {
    
    @Autowired
    private RedisTemplate redisTemplate;
    
    // æ‰£å‡åº“å­˜ï¼ˆé˜²è¶…å–ï¼‰
    public boolean reduceInventory(Long productId, Integer quantity) {
        String lockKey = "inventory_lock_" + productId;
        String lockValue = UUID.randomUUID().toString();
        
        try {
            // 1. è·å–åˆ†å¸ƒå¼é”
            Boolean locked = redisTemplate.opsForValue()
                .setIfAbsent(lockKey, lockValue, Duration.ofSeconds(10));
            
            if (!locked) {
                return false; // è·å–é”å¤±è´¥
            }
            
            // 2. æ£€æŸ¥åº“å­˜
            Integer currentStock = getCurrentStock(productId);
            if (currentStock < quantity) {
                return false; // åº“å­˜ä¸è¶³
            }
            
            // 3. æ‰£å‡åº“å­˜
            updateStock(productId, currentStock - quantity);
            return true;
            
        } finally {
            // 4. é‡Šæ”¾é”
            releaseLock(lockKey, lockValue);
        }
    }
}
```

---

## 6. ğŸŒ æœåŠ¡é—´é€šä¿¡æ–¹æ¡ˆ


### 6.1 é€šä¿¡æ–¹å¼é€‰æ‹©


> ğŸ“– **æœåŠ¡é—´é€šä¿¡çš„é‡è¦æ€§**  
> å¾®æœåŠ¡å°±åƒä¸€ä¸ªå›¢é˜Ÿï¼Œæ¯ä¸ªæˆå‘˜éƒ½æœ‰ä¸“é—¨æŠ€èƒ½ï¼Œä½†éœ€è¦ç›¸äº’åä½œå®Œæˆå¤æ‚ä»»åŠ¡ã€‚æœåŠ¡é—´é€šä¿¡å°±æ˜¯å›¢é˜Ÿæˆå‘˜äº¤æµçš„æ–¹å¼ï¼Œé€‰æ‹©åˆé€‚çš„æ²Ÿé€šæ–¹å¼å¾ˆé‡è¦ã€‚

**ğŸ“ é€šä¿¡æ–¹å¼å¯¹æ¯”**

| é€šä¿¡æ–¹å¼ | ä½¿ç”¨åœºæ™¯ | ä¼˜ç‚¹ | ç¼ºç‚¹ | æ¨èæŒ‡æ•° |
|---------|---------|------|------|----------|
| ğŸŒ **HTTP REST** | `åŒæ­¥è°ƒç”¨ï¼Œå®æ—¶æ€§è¦æ±‚é«˜` | `ç®€å•ç›´è§‚ï¼Œæ˜“äºè°ƒè¯•` | `ç½‘ç»œå»¶è¿Ÿï¼ŒæœåŠ¡è€¦åˆ` | â­â­â­â­ |
| ğŸ“¨ **æ¶ˆæ¯é˜Ÿåˆ—** | `å¼‚æ­¥å¤„ç†ï¼Œå‰Šå³°å¡«è°·` | `è§£è€¦æ€§å¼ºï¼Œé«˜å¯ç”¨` | `å¤æ‚åº¦é«˜ï¼Œå»¶è¿Ÿè¾ƒå¤§` | â­â­â­â­â­ |
| âš¡ **RPCæ¡†æ¶** | `å†…éƒ¨é«˜é¢‘è°ƒç”¨` | `æ€§èƒ½é«˜ï¼Œç±»å‹å®‰å…¨` | `æŠ€æœ¯ç»‘å®šï¼Œè°ƒè¯•å¤æ‚` | â­â­â­ |

### 6.2 Feignè¿œç¨‹è°ƒç”¨é…ç½®


> ğŸ” **Feignæ˜¯ä»€ä¹ˆ**  
> Feignå°±åƒç»™è¿œç¨‹æœåŠ¡è°ƒç”¨ç©¿ä¸Šäº†æœ¬åœ°æ–¹æ³•çš„å¤–è¡£ï¼Œä½ è°ƒç”¨è¿œç¨‹æœåŠ¡å°±åƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·ç®€å•ï¼Œå®ƒä¼šè‡ªåŠ¨å¤„ç†ç½‘ç»œè¯·æ±‚ã€æ•°æ®è½¬æ¢ç­‰å¤æ‚è¿‡ç¨‹ã€‚

**ğŸ”§ Feignå®¢æˆ·ç«¯é…ç½®**
```java
// ç”¨æˆ·æœåŠ¡å®¢æˆ·ç«¯æ¥å£
@FeignClient(name = "user-service", fallback = UserServiceFallback.class)
public interface UserServiceClient {
    
    @GetMapping("/user/info/{userId}")
    Result<User> getUserInfo(@PathVariable("userId") Long userId);
    
    @PostMapping("/user/validate")
    Result<Boolean> validateUser(@RequestBody UserValidateRequest request);
}

// é™çº§å¤„ç†ç±»
@Component
public class UserServiceFallback implements UserServiceClient {
    
    @Override
    public Result<User> getUserInfo(Long userId) {
        return Result.error("ç”¨æˆ·æœåŠ¡æš‚æ—¶ä¸å¯ç”¨");
    }
    
    @Override
    public Result<Boolean> validateUser(UserValidateRequest request) {
        return Result.error("ç”¨æˆ·éªŒè¯æœåŠ¡æš‚æ—¶ä¸å¯ç”¨");
    }
}
```

### 6.3 æ¶ˆæ¯é˜Ÿåˆ—é›†æˆ


**ğŸ“¨ RabbitMQæ¶ˆæ¯å¤„ç†**
```java
// è®¢å•æ”¯ä»˜æˆåŠŸæ¶ˆæ¯å‘å¸ƒ
@Service
public class OrderEventPublisher {
    
    @Autowired
    private RabbitTemplate rabbitTemplate;
    
    // å‘å¸ƒè®¢å•æ”¯ä»˜æˆåŠŸäº‹ä»¶
    public void publishOrderPaidEvent(Long orderId, BigDecimal amount) {
        OrderPaidEvent event = new OrderPaidEvent(orderId, amount, System.currentTimeMillis());
        
        rabbitTemplate.convertAndSend(
            "order.exchange",      // äº¤æ¢æœº
            "order.paid",          // è·¯ç”±é”®
            event                  // æ¶ˆæ¯å†…å®¹
        );
    }
}

// åº“å­˜æœåŠ¡ç›‘å¬è®¢å•æ”¯ä»˜æ¶ˆæ¯
@RabbitListener(queues = "inventory.order.paid")
public void handleOrderPaidEvent(OrderPaidEvent event) {
    // ç¡®è®¤æ‰£å‡åº“å­˜
    inventoryService.confirmReduceInventory(event.getOrderId());
}
```

---

## 7. âš–ï¸ æ•°æ®ä¸€è‡´æ€§å¤„ç†ç­–ç•¥


### 7.1 åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜


> ğŸ“– **ä»€ä¹ˆæ˜¯æ•°æ®ä¸€è‡´æ€§é—®é¢˜**  
> æƒ³è±¡ä¸€ä¸‹é“¶è¡Œè½¬è´¦ï¼šAè´¦æˆ·æ‰£é’±å’ŒBè´¦æˆ·åŠ é’±å¿…é¡»åŒæ—¶æˆåŠŸæˆ–åŒæ—¶å¤±è´¥ã€‚åœ¨å¾®æœåŠ¡ä¸­ï¼Œä¸€ä¸ªä¸šåŠ¡å¯èƒ½æ¶‰åŠå¤šä¸ªæœåŠ¡çš„æ•°æ®ä¿®æ”¹ï¼Œå¦‚ä½•ä¿è¯è¿™äº›æ“ä½œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥ï¼Œå°±æ˜¯æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚

**ğŸ”„ ä¸‹å•è¿‡ç¨‹çš„ä¸€è‡´æ€§æŒ‘æˆ˜**
```
ä¸‹å•æµç¨‹ä¸­çš„æ•°æ®å˜æ›´ï¼š
1. è®¢å•æœåŠ¡ï¼šåˆ›å»ºè®¢å•è®°å½• âœ“
2. åº“å­˜æœåŠ¡ï¼šæ‰£å‡å•†å“åº“å­˜ âœ“  
3. ç”¨æˆ·æœåŠ¡ï¼šæ‰£å‡ç”¨æˆ·ç§¯åˆ† âœ— (å¤±è´¥)

é—®é¢˜ï¼šå‰ä¸¤æ­¥æˆåŠŸï¼Œç¬¬ä¸‰æ­¥å¤±è´¥ï¼Œå¦‚ä½•å›æ»šï¼Ÿ
```

### 7.2 Sagaåˆ†å¸ƒå¼äº‹åŠ¡æ¨¡å¼


> ğŸ’¡ **Sagaæ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³**  
> Sagaå°±åƒè¿ç¯ç”»ï¼ŒæŠŠä¸€ä¸ªå¤æ‚äº‹åŠ¡æ‹†åˆ†æˆå¤šä¸ªå°æ­¥éª¤ï¼Œæ¯ä¸ªæ­¥éª¤éƒ½å¯ä»¥ç‹¬ç«‹å®Œæˆã€‚å¦‚æœæŸä¸ªæ­¥éª¤å¤±è´¥äº†ï¼Œå°±æ‰§è¡Œç›¸åº”çš„"æ’¤é”€æ“ä½œ"ï¼ŒæŠŠä¹‹å‰çš„æ­¥éª¤é€ä¸€å›æ»šã€‚

**ğŸ¯ Sagaäº‹åŠ¡è®¾è®¡**

| æ­¥éª¤ | æ­£å‘æ“ä½œ | è¡¥å¿æ“ä½œ | æœåŠ¡ |
|-----|---------|---------|------|
| `1` | **åˆ›å»ºè®¢å•** | `åˆ é™¤è®¢å•` | `è®¢å•æœåŠ¡` |
| `2` | **æ‰£å‡åº“å­˜** | `æ¢å¤åº“å­˜` | `åº“å­˜æœåŠ¡` |
| `3` | **æ‰£å‡ç§¯åˆ†** | `æ¢å¤ç§¯åˆ†` | `ç”¨æˆ·æœåŠ¡` |
| `4` | **åˆ›å»ºæ”¯ä»˜** | `å–æ¶ˆæ”¯ä»˜` | `æ”¯ä»˜æœåŠ¡` |

**ğŸ’» Sagaäº‹åŠ¡å®ç°**
```java
@Service
public class OrderSagaService {
    
    // ä¸‹å•Sagaäº‹åŠ¡ç¼–æ’
    @SagaOrchestrationStart
    public void processOrder(CreateOrderRequest request) {
        
        // æ­¥éª¤1ï¼šåˆ›å»ºè®¢å•
        SagaManager.addStep(
            () -> orderService.createOrder(request),           // æ­£å‘æ“ä½œ
            (orderId) -> orderService.cancelOrder(orderId)     // è¡¥å¿æ“ä½œ
        );
        
        // æ­¥éª¤2ï¼šæ‰£å‡åº“å­˜
        SagaManager.addStep(
            () -> inventoryService.reduceStock(request.getProductId(), request.getQuantity()),
            (productId, quantity) -> inventoryService.restoreStock(productId, quantity)
        );
        
        // æ­¥éª¤3ï¼šæ‰£å‡ç§¯åˆ†
        SagaManager.addStep(
            () -> userService.deductPoints(request.getUserId(), request.getPoints()),
            (userId, points) -> userService.restorePoints(userId, points)
        );
        
        // æ‰§è¡ŒSagaäº‹åŠ¡
        SagaManager.execute();
    }
}
```

### 7.3 æœ€ç»ˆä¸€è‡´æ€§ä¿è¯


**ğŸ“Š ä¸€è‡´æ€§çº§åˆ«é€‰æ‹©**

| ä¸€è‡´æ€§çº§åˆ« | å®ç°æ–¹å¼ | é€‚ç”¨åœºæ™¯ | ç¤ºä¾‹ |
|-----------|---------|---------|------|
| ğŸ”´ **å¼ºä¸€è‡´æ€§** | `åˆ†å¸ƒå¼é”+2PC` | `é‡‘èäº¤æ˜“ï¼Œåº“å­˜æ‰£å‡` | `è½¬è´¦å¿…é¡»å®æ—¶æˆåŠŸ` |
| ğŸŸ¡ **æœ€ç»ˆä¸€è‡´æ€§** | `æ¶ˆæ¯é˜Ÿåˆ—+é‡è¯•` | `æ—¥å¿—è®°å½•ï¼Œç»Ÿè®¡åˆ†æ` | `è®¢å•æ•°é‡ç»Ÿè®¡` |
| ğŸŸ¢ **å¼±ä¸€è‡´æ€§** | `å¼‚æ­¥æ›´æ–°` | `ç”¨æˆ·è¡Œä¸ºåˆ†æ` | `æµè§ˆè®°å½•æ›´æ–°` |

> âš ï¸ **ä¸€è‡´æ€§æƒè¡¡åŸåˆ™**  
> ä¸æ˜¯æ‰€æœ‰æ•°æ®éƒ½éœ€è¦å¼ºä¸€è‡´æ€§ã€‚æ ¹æ®ä¸šåŠ¡é‡è¦æ€§é€‰æ‹©ï¼šæ ¸å¿ƒä¸šåŠ¡æ•°æ®è¦å¼ºä¸€è‡´ï¼Œç»Ÿè®¡åˆ†ææ•°æ®å¯ä»¥æœ€ç»ˆä¸€è‡´ï¼Œè¿™æ ·æ—¢ä¿è¯æ­£ç¡®æ€§åˆæé«˜æ€§èƒ½ã€‚

---

## 8. â˜ï¸ Spring Cloudç»„ä»¶è½åœ°å®è·µ


### 8.1 æ³¨å†Œä¸­å¿ƒ - Eurekaé…ç½®


> ğŸ“– **æ³¨å†Œä¸­å¿ƒçš„ä½œç”¨**  
> æ³¨å†Œä¸­å¿ƒå°±åƒç”µè¯ç°¿ï¼Œè®°å½•æ‰€æœ‰å¾®æœåŠ¡çš„"è”ç³»æ–¹å¼"ã€‚å½“æœåŠ¡Aè¦è°ƒç”¨æœåŠ¡Bæ—¶ï¼Œå…ˆæŸ¥æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡Bçš„åœ°å€ï¼Œç„¶åå†å‘èµ·è°ƒç”¨ã€‚

**âš™ï¸ Eureka Serveré…ç½®**
```yaml
# eureka-serveré…ç½®
server:
  port: 8761

eureka:
  instance:
    hostname: eureka-server
  client:
    register-with-eureka: false    # è‡ªå·±ä¸æ³¨å†Œè‡ªå·±
    fetch-registry: false          # ä¸æ‹‰å–æ³¨å†Œè¡¨
    service-url:
      defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/

spring:
  application:
    name: eureka-server
```

**ğŸ”Œ å¾®æœåŠ¡æ³¨å†Œé…ç½®**
```yaml
# å¾®æœåŠ¡å®¢æˆ·ç«¯é…ç½®
eureka:
  client:
    service-url:
      defaultZone: http://eureka-server:8761/eureka/
  instance:
    prefer-ip-address: true        # ä½¿ç”¨IPåœ°å€æ³¨å†Œ
    lease-renewal-interval-in-seconds: 5      # å¿ƒè·³é—´éš”
    lease-expiration-duration-in-seconds: 10  # è¿‡æœŸæ—¶é—´

spring:
  application:
    name: user-service            # æœåŠ¡åç§°
```

### 8.2 APIç½‘å…³ - Gatewayé…ç½®


> ğŸ” **APIç½‘å…³çš„ä»·å€¼**  
> APIç½‘å…³åƒå¤§æ¥¼çš„å‰å°ï¼Œæ‰€æœ‰å¤–éƒ¨è¯·æ±‚éƒ½å…ˆåˆ°å‰å°ï¼Œå‰å°è´Ÿè´£éªŒè¯èº«ä»½ã€æŒ‡å¼•æ–¹å‘ã€è®°å½•è®¿é—®ï¼Œç„¶åå°†è¯·æ±‚è½¬å‘ç»™å¯¹åº”çš„éƒ¨é—¨å¤„ç†ã€‚

**ğŸŒ Gatewayè·¯ç”±é…ç½®**
```yaml
spring:
  cloud:
    gateway:
      routes:
        # ç”¨æˆ·æœåŠ¡è·¯ç”±
        - id: user-service
          uri: lb://user-service           # è´Ÿè½½å‡è¡¡åˆ°user-service
          predicates:
            - Path=/user/**                # åŒ¹é…/user/å¼€å¤´çš„è¯·æ±‚
          filters:
            - StripPrefix=1                # å»æ‰/userå‰ç¼€
            
        # è®¢å•æœåŠ¡è·¯ç”±  
        - id: order-service
          uri: lb://order-service
          predicates:
            - Path=/order/**
          filters:
            - StripPrefix=1
            
        # æ”¯ä»˜æœåŠ¡è·¯ç”±
        - id: payment-service
          uri: lb://payment-service  
          predicates:
            - Path=/payment/**
          filters:
            - StripPrefix=1
```

### 8.3 ç†”æ–­å™¨ - Hystrixé…ç½®


> âš¡ **ç†”æ–­å™¨çš„ä¿æŠ¤æœºåˆ¶**  
> ç†”æ–­å™¨åƒç”µè·¯çš„ä¿é™©ä¸ï¼Œå½“æŸä¸ªæœåŠ¡å‡ºç°å¤§é‡å¤±è´¥æ—¶ï¼Œè‡ªåŠ¨"è·³é—¸"ï¼Œåœæ­¢å‘è¯¥æœåŠ¡å‘é€è¯·æ±‚ï¼Œé¿å…é›ªå´©æ•ˆåº”ã€‚è¿‡ä¸€æ®µæ—¶é—´åä¼šå°è¯•æ¢å¤ï¼Œå¦‚æœæœåŠ¡æ­£å¸¸äº†å°±é‡æ–°è¿é€šã€‚

**ğŸ›¡ï¸ Hystrixç†”æ–­é…ç½®**
```java
// åœ¨Feignå®¢æˆ·ç«¯æ–¹æ³•ä¸Šæ·»åŠ ç†”æ–­é…ç½®
@FeignClient(name = "user-service", fallback = UserServiceFallback.class)
public interface UserServiceClient {
    
    @HystrixCommand(
        commandProperties = {
            @HystrixProperty(name = "circuitBreaker.requestVolumeThreshold", value = "10"),     // 10ä¸ªè¯·æ±‚åå¼€å§‹è®¡ç®—
            @HystrixProperty(name = "circuitBreaker.errorThresholdPercentage", value = "60"),   // é”™è¯¯ç‡è¶…è¿‡60%
            @HystrixProperty(name = "circuitBreaker.sleepWindowInMilliseconds", value = "5000") // ç†”æ–­5ç§’åå°è¯•æ¢å¤
        }
    )
    @GetMapping("/user/info/{userId}")
    Result<User> getUserInfo(@PathVariable("userId") Long userId);
}
```

### 8.4 é…ç½®ä¸­å¿ƒ - Configé…ç½®


**âš™ï¸ é…ç½®ä¸­å¿ƒæ¶æ„**
```
Gitä»“åº“(é…ç½®æ–‡ä»¶) â†’ Config Server â†’ Config Client â†’ å¾®æœåŠ¡åº”ç”¨
      â†“                    â†“              â†“             â†“
   [å­˜å‚¨é…ç½®]           [é…ç½®æœåŠ¡]      [è·å–é…ç½®]     [åº”ç”¨é…ç½®]
```

**ğŸ“ é…ç½®æ–‡ä»¶ç®¡ç†**
```yaml
# user-service-dev.yml (å¼€å‘ç¯å¢ƒé…ç½®)
server:
  port: 8081

spring:
  datasource:
    url: jdbc:mysql://dev-db:3306/user_service
    username: dev_user
    password: dev_password

# user-service-prod.yml (ç”Ÿäº§ç¯å¢ƒé…ç½®)  
server:
  port: 8081

spring:
  datasource:
    url: jdbc:mysql://prod-db:3306/user_service
    username: prod_user  
    password: prod_password
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ¯ **å¾®æœåŠ¡æ¶æ„è®¾è®¡åŸåˆ™**
â€¢ å•ä¸€èŒè´£ï¼šæ¯ä¸ªæœåŠ¡åªè´Ÿè´£ä¸€ä¸ªä¸šåŠ¡é¢†åŸŸ
â€¢ æœåŠ¡è‡ªæ²»ï¼šç‹¬ç«‹å¼€å‘ã€éƒ¨ç½²ã€æ‰©å±•ã€ç»´æŠ¤  
â€¢ å»ä¸­å¿ƒåŒ–ï¼šé¿å…å•ç‚¹æ•…éšœï¼Œæé«˜ç³»ç»Ÿå¼¹æ€§
â€¢ æ•…éšœéš”ç¦»ï¼šä¸€ä¸ªæœåŠ¡çš„é—®é¢˜ä¸å½±å“å…¶ä»–æœåŠ¡

ğŸ”§ **Spring Cloudæ ¸å¿ƒç»„ä»¶**
â€¢ æ³¨å†Œä¸­å¿ƒ(Eureka)ï¼šæœåŠ¡å‘ç°ä¸æ³¨å†Œ
â€¢ APIç½‘å…³(Gateway)ï¼šç»Ÿä¸€å…¥å£ä¸è·¯ç”±
â€¢ é…ç½®ä¸­å¿ƒ(Config)ï¼šé›†ä¸­é…ç½®ç®¡ç†
â€¢ ç†”æ–­å™¨(Hystrix)ï¼šæ•…éšœå®¹é”™ä¿æŠ¤
â€¢ è´Ÿè½½å‡è¡¡(Ribbon)ï¼šè¯·æ±‚åˆ†å‘ç­–ç•¥
```

### 9.2 ç”µå•†ç³»ç»Ÿè®¾è®¡è¦ç‚¹


**ğŸª ä¸šåŠ¡æœåŠ¡æ‹†åˆ†**
- **ç”¨æˆ·æœåŠ¡**ï¼šèº«ä»½è®¤è¯ã€ä¸ªäººä¿¡æ¯ç®¡ç†
- **è®¢å•æœåŠ¡**ï¼šè®¢å•ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€çŠ¶æ€æµè½¬
- **æ”¯ä»˜æœåŠ¡**ï¼šæ”¯ä»˜å¤„ç†ã€èµ„é‡‘å®‰å…¨ä¿éšœ
- **åº“å­˜æœåŠ¡**ï¼šåº“å­˜ç®¡ç†ã€é˜²è¶…å–æœºåˆ¶

**ğŸ”„ æœåŠ¡åä½œæ¨¡å¼**
- **åŒæ­¥è°ƒç”¨**ï¼šFeign + HTTP RESTï¼Œé€‚åˆå®æ—¶æ€§è¦æ±‚é«˜çš„åœºæ™¯
- **å¼‚æ­¥æ¶ˆæ¯**ï¼šRabbitMQ + äº‹ä»¶é©±åŠ¨ï¼Œé€‚åˆè§£è€¦å’Œå‰Šå³°å¡«è°·
- **æ•°æ®ä¸€è‡´æ€§**ï¼šSagaæ¨¡å¼å¤„ç†åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œæœ€ç»ˆä¸€è‡´æ€§ä¿è¯

### 9.3 æŠ€æœ¯è½åœ°å…³é”®ç‚¹


**âš¡ é«˜å¯ç”¨è®¾è®¡**
```
ğŸ”¹ æœåŠ¡å¤šå®ä¾‹ï¼šé¿å…å•ç‚¹æ•…éšœ
ğŸ”¹ ç†”æ–­é™çº§ï¼šå¿«é€Ÿå¤±è´¥ï¼Œé˜²æ­¢é›ªå´©  
ğŸ”¹ è¶…æ—¶é‡è¯•ï¼šç½‘ç»œå¼‚å¸¸è‡ªåŠ¨æ¢å¤
ğŸ”¹ é™æµä¿æŠ¤ï¼šé˜²æ­¢ç³»ç»Ÿè¿‡è½½
ğŸ”¹ ç›‘æ§å‘Šè­¦ï¼šåŠæ—¶å‘ç°å’Œè§£å†³é—®é¢˜
```

**ğŸ›¡ï¸ æ•°æ®å®‰å…¨ä¿éšœ**
```
ğŸ”¹ æ¥å£ç­¾åï¼šé˜²æ­¢æ•°æ®ç¯¡æ”¹
ğŸ”¹ æ•æ„ŸåŠ å¯†ï¼šå¯†ç ã€æ”¯ä»˜ä¿¡æ¯åŠ å¯†å­˜å‚¨
ğŸ”¹ æƒé™æ§åˆ¶ï¼šåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
ğŸ”¹ å®¡è®¡æ—¥å¿—ï¼šå…³é”®æ“ä½œå…¨ç¨‹è®°å½•
ğŸ”¹ é™æµé˜²åˆ·ï¼šé˜²æ­¢æ¶æ„è¯·æ±‚æ”»å‡»
```

### 9.4 å®æˆ˜ç»éªŒæ€»ç»“


> ğŸ§  **è®°å¿†è¦ç‚¹**  
> â€¢ å¾®æœåŠ¡è®¾è®¡ï¼šæ‹†åˆ†æœ‰åº¦ï¼Œåä½œæœ‰åºï¼Œç›‘æ§æœ‰æ–¹  
> â€¢ æ•°æ®ä¸€è‡´æ€§ï¼šèƒ½å¼‚æ­¥åˆ™å¼‚æ­¥ï¼Œå¿…åŒæ­¥åˆ™åŒæ­¥ï¼Œæœ€ç»ˆä¸€è‡´æ˜¯ç›®æ ‡  
> â€¢ ç³»ç»Ÿç¨³å®šæ€§ï¼šç†”æ–­é™çº§åšä¿æŠ¤ï¼Œç›‘æ§å‘Šè­¦è¦åŠæ—¶ï¼Œå®¹é‡è§„åˆ’éœ€æå‰

**ğŸ¯ å­¦ä¹ è·¯å¾„å»ºè®®**
1. **åŸºç¡€ç†è§£**ï¼šæŒæ¡å¾®æœåŠ¡åŸºæœ¬æ¦‚å¿µå’Œè®¾è®¡åŸåˆ™
2. **ç»„ä»¶å®è·µ**ï¼šç†Ÿæ‚‰Spring Cloudå„ç»„ä»¶çš„ä½¿ç”¨æ–¹æ³•
3. **é¡¹ç›®å®æˆ˜**ï¼šé€šè¿‡ç”µå•†æ¡ˆä¾‹ç†è§£æœåŠ¡åä½œæ¨¡å¼
4. **ä¼˜åŒ–æå‡**ï¼šå­¦ä¹ æ€§èƒ½ä¼˜åŒ–ã€å®‰å…¨é˜²æŠ¤ã€ç›‘æ§è¿ç»´

> ğŸ’¡ **æ ¸å¿ƒç†å¿µ**  
> å¾®æœåŠ¡ä¸æ˜¯é“¶å¼¹ï¼Œè¦æ ¹æ®å®é™…ä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚çš„æ¶æ„ã€‚ä»ç®€å•å¼€å§‹ï¼Œé€æ­¥æ¼”è¿›ï¼Œåœ¨å®è·µä¸­å­¦ä¹ å’Œå®Œå–„ã€‚å…³é”®æ˜¯ç†è§£ä¸šåŠ¡ï¼Œè®¾è®¡åˆç†çš„æœåŠ¡è¾¹ç•Œï¼Œåšå¥½æœåŠ¡æ²»ç†ã€‚