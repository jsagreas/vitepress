---
title: 1、调度中心部署安装
---
## 📚 目录

1. [XXL-JOB是什么](#1-XXL-JOB是什么)
2. [为什么需要分布式任务调度](#2-为什么需要分布式任务调度)
3. [环境准备](#3-环境准备)
4. [数据库初始化](#4-数据库初始化)
5. [调度中心部署](#5-调度中心部署)
6. [配置文件详解](#6-配置文件详解)
7. [启动与访问](#7-启动与访问)
8. [常见问题解决](#8-常见问题解决)
9. [核心要点总结](#9-核心要点总结)

---

## 1. 🎯 XXL-JOB是什么


### 1.1 简单理解XXL-JOB

`[核心概念]` **XXL-JOB** 就像一个**智能的任务管家**，帮你管理那些需要定时执行的工作。

```
生活中的例子：
闹钟 → 每天7点叫你起床
XXL-JOB → 每天凌晨2点备份数据库

区别在于：
- 闹钟只能管理一个人
- XXL-JOB能管理成百上千台服务器的任务
```

### 1.2 XXL-JOB的核心组成


```
调度中心部署结构图：

┌──────────────┐    ┌──────────────┐    ┌──────────────┐
│   用户浏览器   │    │   调度中心     │    │   执行器节点   │
│              │    │ (管理后台)     │    │   (业务应用)   │
├──────────────┤    ├──────────────┤    ├──────────────┤
│ 任务配置界面   │◄──►│ Web管理界面   │◄──►│ 任务执行代码   │
│ 执行日志查看   │    │ 任务调度引擎   │    │ 心跳注册机制   │
│ 监控报表     │    │ MySQL存储     │    │ 执行结果上报   │
└──────────────┘    └──────────────┘    └──────────────┘
```

**🔸 调度中心**：就像公司的人事部门
- 负责管理所有的定时任务
- 决定什么时候执行哪个任务
- 监控任务执行情况

**🔸 执行器**：就像各个部门的员工
- 真正干活的地方
- 接收调度中心的指令
- 执行具体的业务逻辑

### 1.3 XXL-JOB解决了什么问题


**传统方式的痛点：**
```
单机定时任务的问题：
❌ 服务器宕机 → 任务停止执行
❌ 任务增多 → 管理混乱
❌ 执行失败 → 不知道原因
❌ 负载过高 → 无法分散处理

XXL-JOB的解决方案：
✅ 多机器备份 → 高可用保障
✅ 统一管理界面 → 清晰直观
✅ 详细执行日志 → 问题可追踪
✅ 分布式执行 → 负载均衡
```

---

## 2. 🤔 为什么需要分布式任务调度


### 2.1 业务场景举例


**📊 电商系统的定时任务需求：**

| 任务类型 | **执行时间** | **业务场景** | **传统方式问题** |
|---------|------------|-------------|-----------------|
| 🛒 **订单超时取消** | `每分钟执行` | `未付款订单30分钟后取消` | `单机处理能力有限` |
| 📊 **数据统计报表** | `每天凌晨2点` | `生成昨日销售报表` | `数据量大时容易超时` |
| 💰 **佣金结算** | `每月1号` | `计算上月推广佣金` | `计算复杂，需要分布式处理` |
| 📧 **营销邮件推送** | `每周三上午10点` | `发送会员优惠券` | `用户量大，单机发送太慢` |

### 2.2 分布式任务调度的优势


**🎯 高可用性**
```
场景：订单取消任务
传统方式：只有一台服务器执行
问题：服务器挂了，所有超时订单无法取消

分布式方式：多台服务器都能执行
优势：一台挂了，其他服务器继续工作
```

**⚖️ 负载均衡**
```
场景：发送10万封邮件
传统方式：一台机器慢慢发，需要2小时
分布式方式：10台机器同时发，只需12分钟

负载分配策略：
- 轮询：依次分配给不同机器
- 随机：随机选择机器执行
- 故障转移：机器挂了自动换到其他机器
```

---

## 3. 🛠️ 环境准备


### 3.1 基础环境要求


**💻 系统环境清单**
```
必需环境：
✅ JDK 1.8 或以上版本
✅ MySQL 5.7 或以上版本
✅ Maven 3.6 或以上版本

推荐环境：
🔸 服务器内存：至少2GB
🔸 数据库存储：至少1GB空间
🔸 网络环境：内网互通
```

### 3.2 环境检查命令


```bash
# 检查Java版本
java -version
# 期望输出：java version "1.8.0_xxx"

# 检查Maven版本  
mvn -version
# 期望输出：Apache Maven 3.6.x

# 检查MySQL版本
mysql --version
# 期望输出：mysql Ver 5.7.x 或更高
```

**⚠️ 注意事项**
> 如果是Windows系统，确保已经配置好JAVA_HOME和MAVEN_HOME环境变量

### 3.3 下载XXL-JOB源码


**📥 获取源码的方式**
```bash
# 方式一：Git克隆（推荐）
git clone https://github.com/xuxueli/xxl-job.git

# 方式二：直接下载ZIP包
# 访问：https://github.com/xuxueli/xxl-job
# 点击 Code → Download ZIP
```

**📂 源码目录结构**
```
xxl-job/
├── doc/                    # 文档目录
│   └── db/                # 数据库脚本
│       └── tables_xxl_job.sql
├── xxl-job-admin/         # 调度中心(我们要部署的)
├── xxl-job-core/          # 核心依赖包  
├── xxl-job-executor-samples/ # 执行器示例
└── pom.xml               # Maven主配置
```

---

## 4. 🗄️ 数据库初始化


### 4.1 为什么需要MySQL数据库


**数据存储需求分析：**
```
XXL-JOB需要存储的数据：
📊 任务配置信息 → 什么时候执行什么任务
📝 执行日志记录 → 任务执行成功还是失败
👥 执行器注册信息 → 有哪些机器可以执行任务
⚙️ 系统配置参数 → 调度中心的各种设置

这些数据需要持久化存储，所以必须用数据库
```

### 4.2 创建数据库


```sql
-- 1. 创建数据库（编码很重要）
CREATE DATABASE xxl_job_admin 
CHARACTER SET utf8mb4 
COLLATE utf8mb4_unicode_ci;

-- 2. 创建用户（可选，也可以用root）
CREATE USER 'xxljob'@'%' IDENTIFIED BY 'xxljob123';

-- 3. 授权
GRANT ALL PRIVILEGES ON xxl_job_admin.* TO 'xxljob'@'%';
FLUSH PRIVILEGES;
```

**🔸 编码说明**
> `utf8mb4` 是真正的UTF-8编码，支持存储emoji等特殊字符，比普通的utf8更完整

### 4.3 执行建表脚本


**📍 找到SQL脚本文件**
```
文件位置：xxl-job/doc/db/tables_xxl_job.sql
这个文件包含了XXL-JOB需要的所有数据表结构
```

**🔧 执行建表脚本**
```bash
# 方式一：命令行执行
mysql -h localhost -u root -p xxl_job_admin < tables_xxl_job.sql

# 方式二：使用MySQL客户端工具
# 1. 连接到xxl_job_admin数据库
# 2. 执行tables_xxl_job.sql文件内容
```

### 4.4 验证数据表创建


**📋 核心数据表说明**
```sql
-- 查看创建的表
SHOW TABLES;

主要数据表功能：
┌─────────────────────┬──────────────────────────────┐
│      表名           │            用途说明            │
├─────────────────────┼──────────────────────────────┤
│ xxl_job_info        │ 存储任务配置信息(最重要)       │
│ xxl_job_log         │ 存储任务执行日志              │
│ xxl_job_log_report  │ 存储执行统计报表              │
│ xxl_job_logglue     │ 存储在线编辑的脚本代码         │
│ xxl_job_registry    │ 存储执行器注册信息            │
│ xxl_job_group       │ 存储执行器分组信息            │
│ xxl_job_user        │ 存储用户登录信息              │
└─────────────────────┴──────────────────────────────┘
```

**✅ 验证数据完整性**
```sql
-- 检查是否有初始数据
SELECT COUNT(*) FROM xxl_job_group;   -- 应该有1条示例数据
SELECT COUNT(*) FROM xxl_job_user;    -- 应该有1条admin用户数据
```

---

## 5. 🚀 调度中心部署


### 5.1 调度中心是什么


**🏢 调度中心的角色定位**
```
把调度中心想象成一个"任务指挥部"：

指挥部的职责：
✅ 制定作战计划(配置定时任务)
✅ 下达执行命令(触发任务执行)  
✅ 监控战况报告(查看执行日志)
✅ 调度兵力部署(管理执行器)

对应XXL-JOB调度中心：
✅ Web管理界面 → 配置和管理任务
✅ 调度引擎 → 按时间触发任务
✅ 日志系统 → 记录执行情况
✅ 注册中心 → 管理执行器节点
```

### 5.2 编译调度中心项目


**🔨 Maven编译过程**
```bash
# 进入XXL-JOB根目录
cd xxl-job

# 编译整个项目（第一次会下载很多依赖包，耐心等待）
mvn clean package -DskipTests

# 编译成功后，调度中心的jar包位置：
# xxl-job-admin/target/xxl-job-admin-2.4.1.jar
```

**💡 编译说明**
- `clean`：清理之前的编译结果
- `package`：打包成jar文件
- `-DskipTests`：跳过测试，加快编译速度

### 5.3 Spring Boot应用本质


**📱 XXL-JOB调度中心就是一个Spring Boot Web应用**
```
Spring Boot应用的特点：
🔸 内嵌Tomcat服务器 → 不需要单独安装Web服务器
🔸 自包含jar文件 → 所有依赖都打包在一起
🔸 java -jar启动 → 启动方式简单
🔸 application.properties配置 → 配置方式标准化
```

---

## 6. ⚙️ 配置文件详解


### 6.1 配置文件位置和作用


**📍 配置文件路径**
```
xxl-job-admin/src/main/resources/application.properties

这个文件告诉调度中心：
- 使用哪个数据库
- 监听哪个端口
- 登录密码是什么
- 日志如何记录
```

### 6.2 核心配置项详解


**🔌 端口配置**
```properties
# 调度中心Web端口(默认8080)
server.port=8080

# 说明：这个端口决定了你访问管理界面的地址
# 访问地址：http://服务器IP:8080/xxl-job-admin
```

**🗄️ 数据源配置**
```properties
# MySQL数据库连接配置
spring.datasource.url=jdbc:mysql://127.0.0.1:3306/xxl_job_admin?useUnicode=true&characterEncoding=UTF-8&autoReconnect=true&serverTimezone=Asia/Shanghai
spring.datasource.username=root
spring.datasource.password=root123
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# 连接池配置(一般不用改)
spring.datasource.type=com.zaxxer.hikari.HikariDataSource
spring.datasource.hikari.minimum-idle=10
spring.datasource.hikari.maximum-pool-size=30
```

**🔐 登录配置**
```properties
# 调度中心登录用户名密码(重要！生产环境必须修改)
xxl.job.login.username=admin
xxl.job.login.password=123456

# 登录Token配置(用于内部通信加密)
xxl.job.accessToken=default_token

# ⚠️ 安全提醒：
# 生产环境必须修改默认密码和token
# 建议密码包含大小写字母、数字、特殊字符
```

**📧 邮件告警配置**
```properties
# 邮件发送配置(任务失败时发送告警邮件)
xxl.job.mail.host=smtp.qq.com
xxl.job.mail.port=25
xxl.job.mail.username=xxx@qq.com
xxl.job.mail.password=xxx
xxl.job.mail.from=xxx@qq.com

# 说明：如果不需要邮件告警，这部分可以不配置
```

### 6.3 完整配置文件示例


```properties
# ================================
# 🔸 基础服务配置
# ================================
server.port=8080
server.servlet.context-path=/xxl-job-admin

# ================================  
# 🔸 数据库配置(重要)
# ================================
spring.datasource.url=jdbc:mysql://127.0.0.1:3306/xxl_job_admin?useUnicode=true&characterEncoding=UTF-8&autoReconnect=true&serverTimezone=Asia/Shanghai
spring.datasource.username=root
spring.datasource.password=root123
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# ================================
# 🔸 登录安全配置(必须修改)
# ================================  
xxl.job.login.username=admin
xxl.job.login.password=123456
xxl.job.accessToken=your_custom_token_here

# ================================
# 🔸 日志配置
# ================================
logging.config=classpath:logback.xml
xxl.job.logretentiondays=30
```

**📝 配置修改建议**
> **生产环境必改项：**
> - `xxl.job.login.password`：修改默认密码
> - `xxl.job.accessToken`：修改默认token
> - `spring.datasource.password`：使用安全的数据库密码

---

## 7. 🎬 启动与访问


### 7.1 启动调度中心


**🚀 启动命令**
```bash
# 进入编译后的目录
cd xxl-job-admin/target

# 启动调度中心(前台启动，看到日志)
java -jar xxl-job-admin-2.4.1.jar

# 后台启动(生产环境推荐)
nohup java -jar xxl-job-admin-2.4.1.jar > xxl-job.log 2>&1 &
```

**📋 启动成功标志**
```
控制台看到这些日志说明启动成功：
✅ Started XxlJobAdminApplication in xxx seconds
✅ Tomcat started on port(s): 8080
✅ XXL-JOB remoting server start success
```

### 7.2 访问管理界面


**🌐 Web访问地址**
```
浏览器访问：http://服务器IP:8080/xxl-job-admin

默认登录账号：
用户名：admin
密码：123456
```

**🎨 管理界面功能预览**
```
登录成功后可以看到：
┌─────────────────────────────────────────────────┐
│                XXL-JOB 调度中心                  │
├─────────────────────────────────────────────────┤
│ 📊 运行报表  │  显示任务执行统计图表              │
│ 🎯 任务管理  │  创建、修改、删除定时任务          │  
│ 📝 调度日志  │  查看任务执行详细日志              │
│ 🖥️ 执行器管理 │  管理执行任务的服务器节点          │
│ 👥 用户管理  │  管理登录用户账号                 │
└─────────────────────────────────────────────────┘
```

### 7.3 验证部署成功


**✅ 部署验证清单**
```bash
# 1. 检查进程是否运行
ps aux | grep xxl-job

# 2. 检查端口是否监听
netstat -tlnp | grep 8080

# 3. 检查Web界面是否可访问
curl -I http://localhost:8080/xxl-job-admin

# 4. 检查数据库连接是否正常
# 登录管理界面 → 执行器管理 → 查看是否有示例执行器
```

---

## 8. 🔧 常见问题解决


### 8.1 启动失败问题


**❌ 问题：端口被占用**
```bash
# 现象：启动时报错 "Port 8080 was already in use"

# 解决步骤：
# 1. 查看占用端口的进程
netstat -tlnp | grep 8080
lsof -i :8080

# 2. 杀掉占用进程或换端口
kill -9 进程ID
# 或者修改application.properties中的端口号
```

**❌ 问题：数据库连接失败**
```
# 现象：启动时报错包含 "Communications link failure"

# 排查步骤：
✅ 检查MySQL是否启动：service mysql status
✅ 检查数据库是否存在：show databases;  
✅ 检查用户权限：show grants for 'root'@'localhost';
✅ 检查配置文件中的连接参数是否正确
```

**❌ 问题：找不到数据表**
```
# 现象：启动时报错 "Table 'xxl_job_admin.xxl_job_info' doesn't exist"

# 解决方案：
1. 确认是否执行了建表脚本
2. 确认连接的数据库名是否正确  
3. 重新执行tables_xxl_job.sql脚本
```

### 8.2 访问问题


**❌ 问题：无法访问管理界面**
```
# 现象：浏览器显示"无法访问此网站"

# 排查清单：
✅ 检查调度中心是否启动成功
✅ 检查防火墙是否开放8080端口
✅ 检查访问地址是否正确(包含context-path)
✅ 如果是云服务器，检查安全组规则
```

**❌ 问题：登录失败**
```
# 现象：输入用户名密码后提示登录失败

# 检查步骤：
1. 确认用户名密码是否正确(默认admin/123456)
2. 检查xxl_job_user表是否有数据
3. 查看调度中心日志是否有异常
```

### 8.3 性能优化建议


**⚡ JVM启动参数优化**
```bash
# 推荐的生产环境启动参数
java -Xms1g -Xmx2g -XX:+UseG1GC \
     -XX:G1HeapRegionSize=16m \
     -XX:+PrintGCDetails \
     -Xloggc:gc.log \
     -jar xxl-job-admin-2.4.1.jar

# 参数说明：
# -Xms1g：初始堆内存1GB
# -Xmx2g：最大堆内存2GB  
# -XX:+UseG1GC：使用G1垃圾回收器
```

---

## 9. 📋 核心要点总结


### 9.1 必须掌握的核心概念


```
🎯 XXL-JOB本质：分布式任务调度框架
🏗️ 架构组成：调度中心 + 执行器
🗄️ 数据存储：MySQL数据库(必需依赖)
🌐 部署形式：Spring Boot Web应用
⚙️ 配置核心：数据源 + 端口 + 登录认证
```

### 9.2 部署流程总结


**📋 标准部署步骤**
```
第1步：环境准备
├── ✅ 安装JDK 1.8+
├── ✅ 安装MySQL 5.7+
└── ✅ 安装Maven 3.6+

第2步：数据库初始化  
├── ✅ 创建xxl_job_admin数据库
├── ✅ 执行tables_xxl_job.sql脚本
└── ✅ 验证数据表创建成功

第3步：编译部署
├── ✅ 下载XXL-JOB源码
├── ✅ Maven编译打包
├── ✅ 修改application.properties配置
└── ✅ java -jar启动调度中心

第4步：验证部署
├── ✅ 检查进程和端口
├── ✅ 访问Web管理界面  
├── ✅ 使用admin账号登录
└── ✅ 查看各功能模块
```

### 9.3 重要配置项记忆


**🔑 生产环境必改配置**
```
数据库配置：
spring.datasource.url=数据库连接地址
spring.datasource.username=数据库用户名  
spring.datasource.password=数据库密码

安全配置：
xxl.job.login.username=管理员用户名
xxl.job.login.password=管理员密码(必须修改!)
xxl.job.accessToken=通信密钥(必须修改!)

服务配置：
server.port=Web端口号(默认8080)
```

### 9.4 故障排查思路


**🔍 问题诊断流程**
```
启动问题 → 检查日志 → 确认环境 → 验证配置
   ↓
访问问题 → 检查网络 → 确认端口 → 验证防火墙  
   ↓
功能问题 → 检查数据库 → 确认权限 → 验证数据
```

**核心记忆要点**：
- XXL-JOB调度中心本质上就是一个Spring Boot Web应用
- MySQL数据库是必需依赖，用于存储任务配置和执行日志
- 生产环境部署必须修改默认的登录密码和访问token
- 通过Web界面可以可视化管理所有的定时任务