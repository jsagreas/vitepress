---
title: 3ã€ä»»åŠ¡å‚æ•°ä¼ é€’
---
## ğŸ“š ç›®å½•

1. [ä»»åŠ¡å‚æ•°åŸºç¡€æ¦‚å¿µ](#1-ä»»åŠ¡å‚æ•°åŸºç¡€æ¦‚å¿µ)
2. [å‚æ•°é…ç½®æ–¹å¼è¯¦è§£](#2-å‚æ•°é…ç½®æ–¹å¼è¯¦è§£)
3. [XxlJobHelperå·¥å…·ç±»æ ¸å¿ƒç”¨æ³•](#3-XxlJobHelperå·¥å…·ç±»æ ¸å¿ƒç”¨æ³•)
4. [å‚æ•°è§£æå®æˆ˜æŠ€å·§](#4-å‚æ•°è§£æå®æˆ˜æŠ€å·§)
5. [åŠ¨æ€å‚æ•°ä¼ é€’æœºåˆ¶](#5-åŠ¨æ€å‚æ•°ä¼ é€’æœºåˆ¶)
6. [å‚æ•°éªŒè¯ä¸å¼‚å¸¸å¤„ç†](#6-å‚æ•°éªŒè¯ä¸å¼‚å¸¸å¤„ç†)
7. [å®é™…åº”ç”¨åœºæ™¯æ¡ˆä¾‹](#7-å®é™…åº”ç”¨åœºæ™¯æ¡ˆä¾‹)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ä»»åŠ¡å‚æ•°åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯ä»»åŠ¡å‚æ•°


**ç®€å•ç†è§£**ï¼šä»»åŠ¡å‚æ•°å°±åƒç»™ç¨‹åºä¼ é€’çš„"æŒ‡ä»¤ä¹¦"ï¼Œå‘Šè¯‰ä»»åŠ¡è¯¥æ€ä¹ˆæ‰§è¡Œã€‚

```
æ¯”å¦‚ç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼š
å¦ˆå¦ˆå¯¹ä½ è¯´ï¼š"å»ä¹°èœ" â† è¿™æ˜¯ä»»åŠ¡
"ä¹°2æ–¤è‹¹æœï¼Œ1æ–¤é¦™è•‰ï¼Œé¢„ç®—50å…ƒ" â† è¿™äº›å°±æ˜¯å‚æ•°

åœ¨XXL-JOBä¸­ï¼š
ä»»åŠ¡ï¼šæ•°æ®å¤‡ä»½
å‚æ•°ï¼š{"startDate":"2024-01-01","endDate":"2024-01-31","tableNames":["user","order"]}
```

### 1.2 å‚æ•°ä¼ é€’çš„ä½œç”¨


**ğŸ”¸ æ ¸å¿ƒä½œç”¨**ï¼š
- âœ… **çµæ´»æ§åˆ¶**ï¼šä¸åŒæ‰§è¡Œéœ€è¦ä¸åŒçš„é…ç½®
- âœ… **å¤ç”¨æ€§å¼º**ï¼šåŒä¸€ä¸ªä»»åŠ¡å¯ä»¥å¤„ç†ä¸åŒæ•°æ®
- âœ… **åŠ¨æ€è°ƒæ•´**ï¼šè¿è¡Œæ—¶å¯ä»¥ä¿®æ”¹å‚æ•°
- âœ… **æ‰¹é‡å¤„ç†**ï¼šå¯ä»¥ä¼ é€’æ‰¹é‡æ•°æ®æ ‡è¯†

**å®é™…åœºæ™¯å¯¹æ¯”**ï¼š
```
âŒ æ²¡æœ‰å‚æ•°çš„ä»»åŠ¡ï¼ˆæ­»æ¿ï¼‰ï¼š
æ¯å¤©åªèƒ½å¤‡ä»½å›ºå®šçš„3å¼ è¡¨

âœ… æœ‰å‚æ•°çš„ä»»åŠ¡ï¼ˆçµæ´»ï¼‰ï¼š
ä»Šå¤©å¤‡ä»½ç”¨æˆ·è¡¨ï¼Œæ˜å¤©å¤‡ä»½è®¢å•è¡¨
å¯ä»¥æŒ‡å®šæ—¥æœŸèŒƒå›´ï¼ŒæŒ‡å®šè¡¨å
```

### 1.3 å‚æ•°ä¼ é€’æµç¨‹å›¾


```
è°ƒåº¦ä¸­å¿ƒï¼ˆç®¡ç†å‘˜ç•Œé¢ï¼‰
         â†“
    [é…ç½®ä»»åŠ¡å‚æ•°]
         â†“
    ä»»åŠ¡è§¦å‘æ‰§è¡Œ
         â†“
æ‰§è¡Œå™¨ï¼ˆä½ çš„Javaåº”ç”¨ï¼‰
         â†“
XxlJobHelper.getJobParam()
         â†“
    [è·å–å‚æ•°ä½¿ç”¨]
```

---

## 2. âš™ï¸ å‚æ•°é…ç½®æ–¹å¼è¯¦è§£


### 2.1 åœ¨è°ƒåº¦ä¸­å¿ƒé…ç½®å‚æ•°


**ğŸ’¡ é…ç½®ä½ç½®**ï¼šXXL-JOBç®¡ç†ç•Œé¢ â†’ ä»»åŠ¡ç®¡ç† â†’ ç¼–è¾‘ä»»åŠ¡ â†’ ä»»åŠ¡å‚æ•°

**å¸¸è§é…ç½®æ ¼å¼**ï¼š

| å‚æ•°ç±»å‹ | **é…ç½®ç¤ºä¾‹** | **ä½¿ç”¨åœºæ™¯** |
|---------|-------------|-------------|
| ğŸ”¸ **ç®€å•å­—ç¬¦ä¸²** | `user_backup` | `å•ä¸€æ ‡è¯†æˆ–ç®€å•é…ç½®` |
| ğŸ”¸ **é”®å€¼å¯¹** | `date=2024-01-01&type=full` | `å¤šä¸ªç®€å•å‚æ•°` |
| ğŸ”¸ **JSONæ ¼å¼** | `{"startId":1000,"batchSize":100}` | `å¤æ‚å‚æ•°ç»“æ„` |
| ğŸ”¸ **é€—å·åˆ†éš”** | `table1,table2,table3` | `æ‰¹é‡æ•°æ®å¤„ç†` |

### 2.2 å‚æ•°é…ç½®æœ€ä½³å®è·µ


**ğŸŒŸ æ¨èæ ¼å¼ï¼šJSON**
```json
{
    "taskType": "dataBackup",
    "config": {
        "startDate": "2024-01-01",
        "endDate": "2024-01-31",
        "tables": ["user", "order", "product"],
        "batchSize": 1000
    },
    "options": {
        "enableLog": true,
        "retryTimes": 3
    }
}
```

**ğŸ“ é…ç½®åŸåˆ™**ï¼š
- âœ… **ç»“æ„æ¸…æ™°**ï¼šç”¨JSONæ ¼å¼ï¼Œå±‚æ¬¡åˆ†æ˜
- âœ… **å‘½åè§„èŒƒ**ï¼šä½¿ç”¨é©¼å³°å‘½åæˆ–ä¸‹åˆ’çº¿
- âœ… **ç±»å‹æ˜ç¡®**ï¼šæ•°å­—ç”¨æ•°å­—ï¼Œå¸ƒå°”å€¼ç”¨boolean
- âœ… **æ˜“äºç†è§£**ï¼šå‚æ•°åè¦è§åçŸ¥æ„

---

## 3. ğŸ› ï¸ XxlJobHelperå·¥å…·ç±»æ ¸å¿ƒç”¨æ³•


### 3.1 getJobParam()æ–¹æ³•è¯¦è§£


**ğŸ”¸ æ ¸å¿ƒæ–¹æ³•**ï¼š`XxlJobHelper.getJobParam()`

**ä½œç”¨è¯´æ˜**ï¼šè¿™ä¸ªæ–¹æ³•å°±åƒæ˜¯"å–å¿«é€’"ï¼Œä»è°ƒåº¦ä¸­å¿ƒå–åˆ°ä¼ é€’è¿‡æ¥çš„å‚æ•°ã€‚

```java
@XxlJob("dataBackupHandler")
public void dataBackupHandler() throws Exception {
    // è·å–ä»»åŠ¡å‚æ•° - å°±åƒæ‰“å¼€å¿«é€’åŒ…è£¹
    String jobParam = XxlJobHelper.getJobParam();
    
    // å‚æ•°ä¸ºç©ºçš„å¤„ç†
    if (jobParam == null || jobParam.trim().isEmpty()) {
        XxlJobHelper.log("æœªé…ç½®ä»»åŠ¡å‚æ•°ï¼Œä½¿ç”¨é»˜è®¤é…ç½®æ‰§è¡Œ");
        // æ‰§è¡Œé»˜è®¤é€»è¾‘
        return;
    }
    
    XxlJobHelper.log("è·å–åˆ°ä»»åŠ¡å‚æ•°: " + jobParam);
    // ç»§ç»­å¤„ç†å‚æ•°...
}
```

### 3.2 å‚æ•°è·å–çš„æ³¨æ„äº‹é¡¹


**âš ï¸ é‡è¦æé†’**ï¼š
- `getJobParam()`è¿”å›çš„æ˜¯**å­—ç¬¦ä¸²ç±»å‹**
- éœ€è¦æ‰‹åŠ¨è§£ææˆéœ€è¦çš„æ ¼å¼
- å‚æ•°å¯èƒ½ä¸ºnullæˆ–ç©ºå­—ç¬¦ä¸²ï¼Œè¦åšé˜²æŠ¤

**ğŸ” å‚æ•°çŠ¶æ€åˆ¤æ–­**ï¼š
```java
String jobParam = XxlJobHelper.getJobParam();

// å®Œæ•´çš„å‚æ•°æ£€æŸ¥
if (jobParam == null) {
    // è°ƒåº¦ä¸­å¿ƒæ²¡é…ç½®å‚æ•°
    XxlJobHelper.log("ä»»åŠ¡å‚æ•°ä¸ºnull");
} else if (jobParam.trim().isEmpty()) {
    // é…ç½®äº†ç©ºå‚æ•°
    XxlJobHelper.log("ä»»åŠ¡å‚æ•°ä¸ºç©ºå­—ç¬¦ä¸²");
} else {
    // æ­£å¸¸æƒ…å†µï¼Œæœ‰å‚æ•°å†…å®¹
    XxlJobHelper.log("ä»»åŠ¡å‚æ•°: " + jobParam);
}
```

### 3.3 æ—¥å¿—è¾“å‡ºæœ€ä½³å®è·µ


**ğŸ“Š æ—¥å¿—è®°å½•æŠ€å·§**ï¼š
```java
@XxlJob("myTaskHandler")
public void myTaskHandler() throws Exception {
    String jobParam = XxlJobHelper.getJobParam();
    
    // âœ… å¥½çš„æ—¥å¿—è®°å½•æ–¹å¼
    XxlJobHelper.log("=== ä»»åŠ¡å¼€å§‹æ‰§è¡Œ ===");
    XxlJobHelper.log("ä»»åŠ¡å‚æ•°: " + jobParam);
    
    try {
        // æ‰§è¡Œä¸šåŠ¡é€»è¾‘
        processData(jobParam);
        XxlJobHelper.log("ä»»åŠ¡æ‰§è¡ŒæˆåŠŸ");
    } catch (Exception e) {
        XxlJobHelper.log("ä»»åŠ¡æ‰§è¡Œå¤±è´¥: " + e.getMessage());
        throw e; // é‡æ–°æŠ›å‡ºå¼‚å¸¸ï¼Œè®©XXL-JOBçŸ¥é“ä»»åŠ¡å¤±è´¥äº†
    }
    
    XxlJobHelper.log("=== ä»»åŠ¡æ‰§è¡Œå®Œæˆ ===");
}
```

---

## 4. ğŸ”§ å‚æ•°è§£æå®æˆ˜æŠ€å·§


### 4.1 JSONæ ¼å¼å‚æ•°è§£æ


**æœ€å¸¸ç”¨åœºæ™¯**ï¼šå¤æ‚å‚æ•°ç»“æ„çš„è§£æ

```java
// å‡è®¾å‚æ•°æ ¼å¼
// {"startDate":"2024-01-01","batchSize":100,"tables":["user","order"]}

@XxlJob("jsonParamHandler")
public void jsonParamHandler() throws Exception {
    String jobParam = XxlJobHelper.getJobParam();
    
    if (jobParam == null || jobParam.trim().isEmpty()) {
        XxlJobHelper.log("å‚æ•°ä¸ºç©ºï¼Œä½¿ç”¨é»˜è®¤é…ç½®");
        return;
    }
    
    try {
        // ä½¿ç”¨FastJSONè§£æï¼ˆä¹Ÿå¯ä»¥ç”¨Gsonã€Jacksonï¼‰
        JSONObject paramJson = JSON.parseObject(jobParam);
        
        // è§£æå„ä¸ªå‚æ•°
        String startDate = paramJson.getString("startDate");
        Integer batchSize = paramJson.getInteger("batchSize");
        JSONArray tables = paramJson.getJSONArray("tables");
        
        XxlJobHelper.log("å¼€å§‹æ—¥æœŸ: " + startDate);
        XxlJobHelper.log("æ‰¹æ¬¡å¤§å°: " + batchSize);
        XxlJobHelper.log("è¡¨ååˆ—è¡¨: " + tables.toJSONString());
        
        // æ‰§è¡Œå…·ä½“ä¸šåŠ¡
        executeBackup(startDate, batchSize, tables);
        
    } catch (Exception e) {
        XxlJobHelper.log("å‚æ•°è§£æå¤±è´¥: " + e.getMessage());
        throw e;
    }
}
```

### 4.2 ç®€å•å­—ç¬¦ä¸²å‚æ•°è§£æ


**é€‚ç”¨åœºæ™¯**ï¼šå‚æ•°æ¯”è¾ƒç®€å•ï¼Œç”¨åˆ†éš”ç¬¦åˆ†å¼€

```java
// å‡è®¾å‚æ•°æ ¼å¼ï¼štable1,table2,table3
// æˆ–è€…ï¼šstartId=1000&endId=2000

@XxlJob("simpleParamHandler")  
public void simpleParamHandler() throws Exception {
    String jobParam = XxlJobHelper.getJobParam();
    
    if (jobParam == null || jobParam.trim().isEmpty()) {
        return;
    }
    
    // æ–¹å¼1ï¼šé€—å·åˆ†éš”çš„å¤„ç†
    if (jobParam.contains(",")) {
        String[] tables = jobParam.split(",");
        XxlJobHelper.log("éœ€è¦å¤„ç†çš„è¡¨: " + Arrays.toString(tables));
        
        for (String table : tables) {
            processTable(table.trim()); // trim()å»é™¤ç©ºæ ¼
        }
    }
    
    // æ–¹å¼2ï¼šé”®å€¼å¯¹æ ¼å¼çš„å¤„ç†  
    if (jobParam.contains("&")) {
        Map<String, String> paramMap = new HashMap<>();
        String[] pairs = jobParam.split("&");
        
        for (String pair : pairs) {
            String[] keyValue = pair.split("=");
            if (keyValue.length == 2) {
                paramMap.put(keyValue[0], keyValue[1]);
            }
        }
        
        XxlJobHelper.log("è§£æåçš„å‚æ•°: " + paramMap.toString());
    }
}
```

### 4.3 åˆ›å»ºå‚æ•°è§£æå·¥å…·ç±»


**ğŸš€ æé«˜ä»£ç å¤ç”¨æ€§**ï¼š
```java
public class JobParamUtils {
    
    /**
     * å®‰å…¨è§£æJSONå‚æ•°
     */
    public static JSONObject parseJsonParam(String jobParam) {
        if (jobParam == null || jobParam.trim().isEmpty()) {
            return new JSONObject();
        }
        
        try {
            return JSON.parseObject(jobParam);
        } catch (Exception e) {
            XxlJobHelper.log("JSONå‚æ•°è§£æå¤±è´¥: " + e.getMessage());
            return new JSONObject();
        }
    }
    
    /**
     * è§£æé€—å·åˆ†éš”çš„å‚æ•°
     */
    public static List<String> parseListParam(String jobParam) {
        if (jobParam == null || jobParam.trim().isEmpty()) {
            return new ArrayList<>();
        }
        
        return Arrays.stream(jobParam.split(","))
                    .map(String::trim)
                    .filter(s -> !s.isEmpty())
                    .collect(Collectors.toList());
    }
    
    /**
     * è§£æé”®å€¼å¯¹å‚æ•°
     */
    public static Map<String, String> parseMapParam(String jobParam) {
        Map<String, String> result = new HashMap<>();
        
        if (jobParam == null || jobParam.trim().isEmpty()) {
            return result;
        }
        
        String[] pairs = jobParam.split("&");
        for (String pair : pairs) {
            String[] keyValue = pair.split("=");
            if (keyValue.length == 2) {
                result.put(keyValue[0].trim(), keyValue[1].trim());
            }
        }
        
        return result;
    }
}
```

---

## 5. ğŸ”„ åŠ¨æ€å‚æ•°ä¼ é€’æœºåˆ¶


### 5.1 ä»€ä¹ˆæ˜¯åŠ¨æ€å‚æ•°ä¼ é€’


**é€šä¿—è§£é‡Š**ï¼šå°±åƒå¤–å–å°å“¥é€é¤æ—¶ï¼Œå¯èƒ½ä¸´æ—¶æ”¶åˆ°æ–°çš„é…é€è¦æ±‚ï¼ŒåŠ¨æ€å‚æ•°å°±æ˜¯ä»»åŠ¡æ‰§è¡Œæ—¶å¯ä»¥ä¸´æ—¶è°ƒæ•´çš„é…ç½®ã€‚

**ğŸ”¸ åº”ç”¨åœºæ™¯**ï¼š
- æ‰‹åŠ¨è§¦å‘ä»»åŠ¡æ—¶ä¸´æ—¶æŒ‡å®šå‚æ•°
- å­ä»»åŠ¡è°ƒç”¨æ—¶ä¼ é€’ä¸åŒå‚æ•°  
- ä»»åŠ¡é‡è¯•æ—¶ä½¿ç”¨ä¸åŒç­–ç•¥

### 5.2 æ‰‹åŠ¨è§¦å‘æ—¶çš„å‚æ•°ä¼ é€’


**æ“ä½œæµç¨‹**ï¼š
```
XXL-JOBç®¡ç†ç•Œé¢ â†’ ä»»åŠ¡ç®¡ç† â†’ æ“ä½œåˆ— â†’ æ‰§è¡Œä¸€æ¬¡
åœ¨å¼¹å‡ºæ¡†çš„"ä»»åŠ¡å‚æ•°"ä¸­è¾“å…¥ä¸´æ—¶å‚æ•°
```

**ä»£ç å¤„ç†æ–¹å¼**ï¼š
```java
@XxlJob("dynamicParamHandler")
public void dynamicParamHandler() throws Exception {
    String jobParam = XxlJobHelper.getJobParam();
    
    // åŠ¨æ€å‚æ•°ä¼šè¦†ç›–ä»»åŠ¡é…ç½®ä¸­çš„å›ºå®šå‚æ•°
    if (jobParam != null && !jobParam.isEmpty()) {
        XxlJobHelper.log("ä½¿ç”¨åŠ¨æ€ä¼ å…¥å‚æ•°: " + jobParam);
        JSONObject paramJson = JSON.parseObject(jobParam);
        
        // æ ¹æ®å‚æ•°ç±»å‹æ‰§è¡Œä¸åŒé€»è¾‘
        String taskType = paramJson.getString("taskType");
        switch (taskType) {
            case "urgent":
                XxlJobHelper.log("æ‰§è¡Œç´§æ€¥ä»»åŠ¡æ¨¡å¼");
                processUrgentTask(paramJson);
                break;
            case "normal":  
                XxlJobHelper.log("æ‰§è¡Œæ­£å¸¸ä»»åŠ¡æ¨¡å¼");
                processNormalTask(paramJson);
                break;
            default:
                XxlJobHelper.log("æœªçŸ¥ä»»åŠ¡ç±»å‹ï¼Œæ‰§è¡Œé»˜è®¤é€»è¾‘");
        }
    }
}
```

### 5.3 å­ä»»åŠ¡å‚æ•°ä¼ é€’


**åœºæ™¯è¯´æ˜**ï¼šä¸€ä¸ªå¤§ä»»åŠ¡æ‹†åˆ†æˆå¤šä¸ªå°ä»»åŠ¡ï¼Œæ¯ä¸ªå°ä»»åŠ¡éœ€è¦ä¸åŒå‚æ•°ã€‚

```java
@XxlJob("parentTaskHandler")
public void parentTaskHandler() throws Exception {
    XxlJobHelper.log("å¼€å§‹æ‰§è¡Œçˆ¶ä»»åŠ¡");
    
    // è·å–éœ€è¦å¤„ç†çš„æ•°æ®èŒƒå›´
    String jobParam = XxlJobHelper.getJobParam();
    JSONObject paramJson = JSON.parseObject(jobParam);
    
    int totalRecords = paramJson.getIntValue("totalRecords");
    int batchSize = paramJson.getIntValue("batchSize");
    
    // è®¡ç®—éœ€è¦åˆ†å‡ æ‰¹å¤„ç†
    int batches = (totalRecords + batchSize - 1) / batchSize;
    
    XxlJobHelper.log("æ€»è®°å½•æ•°: " + totalRecords + ", åˆ†" + batches + "æ‰¹å¤„ç†");
    
    // è§¦å‘å­ä»»åŠ¡ï¼Œæ¯ä¸ªå­ä»»åŠ¡å¤„ç†ä¸€æ‰¹æ•°æ®
    for (int i = 0; i < batches; i++) {
        int startId = i * batchSize;
        int endId = Math.min((i + 1) * batchSize - 1, totalRecords - 1);
        
        // æ„å»ºå­ä»»åŠ¡å‚æ•°
        JSONObject childParam = new JSONObject();
        childParam.put("startId", startId);
        childParam.put("endId", endId);
        childParam.put("batchIndex", i + 1);
        
        // è¿™é‡Œéœ€è¦é€šè¿‡XXL-JOB APIè§¦å‘å­ä»»åŠ¡
        // å…·ä½“å®ç°ä¾èµ–XXL-JOBçš„APIè°ƒç”¨æ–¹å¼
        XxlJobHelper.log("è§¦å‘å­ä»»åŠ¡ï¼Œå‚æ•°: " + childParam.toJSONString());
    }
}
```

---

## 6. âœ… å‚æ•°éªŒè¯ä¸å¼‚å¸¸å¤„ç†


### 6.1 å‚æ•°éªŒè¯çš„é‡è¦æ€§


**ä¸ºä»€ä¹ˆè¦éªŒè¯å‚æ•°**ï¼š
- é˜²æ­¢ç¨‹åºå› é”™è¯¯å‚æ•°è€Œå´©æºƒ
- åŠæ—©å‘ç°é…ç½®é—®é¢˜
- æä¾›å‹å¥½çš„é”™è¯¯æç¤º

### 6.2 å®Œæ•´çš„å‚æ•°éªŒè¯ç¤ºä¾‹


```java
@XxlJob("validatedParamHandler")
public void validatedParamHandler() throws Exception {
    String jobParam = XxlJobHelper.getJobParam();
    
    // ç¬¬ä¸€å±‚éªŒè¯ï¼šå‚æ•°æ˜¯å¦å­˜åœ¨
    if (jobParam == null || jobParam.trim().isEmpty()) {
        XxlJobHelper.log("âŒ ä»»åŠ¡å‚æ•°ä¸ºç©ºï¼Œæ— æ³•æ‰§è¡Œ");
        throw new RuntimeException("ä»»åŠ¡å‚æ•°ä¸èƒ½ä¸ºç©º");
    }
    
    JSONObject paramJson;
    try {
        // ç¬¬äºŒå±‚éªŒè¯ï¼šJSONæ ¼å¼æ˜¯å¦æ­£ç¡®
        paramJson = JSON.parseObject(jobParam);
    } catch (Exception e) {
        XxlJobHelper.log("âŒ å‚æ•°JSONæ ¼å¼é”™è¯¯: " + e.getMessage());
        throw new RuntimeException("å‚æ•°æ ¼å¼ä¸æ­£ç¡®ï¼Œè¯·æ£€æŸ¥JSONæ ¼å¼");
    }
    
    // ç¬¬ä¸‰å±‚éªŒè¯ï¼šå¿…éœ€å‚æ•°æ˜¯å¦å­˜åœ¨
    if (!paramJson.containsKey("startDate")) {
        XxlJobHelper.log("âŒ ç¼ºå°‘å¿…éœ€å‚æ•°: startDate");
        throw new RuntimeException("ç¼ºå°‘å¼€å§‹æ—¥æœŸå‚æ•°");
    }
    
    if (!paramJson.containsKey("batchSize")) {
        XxlJobHelper.log("âŒ ç¼ºå°‘å¿…éœ€å‚æ•°: batchSize");  
        throw new RuntimeException("ç¼ºå°‘æ‰¹æ¬¡å¤§å°å‚æ•°");
    }
    
    // ç¬¬å››å±‚éªŒè¯ï¼šå‚æ•°å€¼çš„åˆç†æ€§
    Integer batchSize = paramJson.getInteger("batchSize");
    if (batchSize == null || batchSize <= 0 || batchSize > 10000) {
        XxlJobHelper.log("âŒ batchSizeå‚æ•°å€¼ä¸åˆç†: " + batchSize);
        throw new RuntimeException("æ‰¹æ¬¡å¤§å°å¿…é¡»åœ¨1-10000ä¹‹é—´");
    }
    
    String startDate = paramJson.getString("startDate");
    if (!isValidDate(startDate)) {
        XxlJobHelper.log("âŒ startDateæ—¥æœŸæ ¼å¼é”™è¯¯: " + startDate);
        throw new RuntimeException("æ—¥æœŸæ ¼å¼åº”ä¸º: yyyy-MM-dd");
    }
    
    XxlJobHelper.log("âœ… å‚æ•°éªŒè¯é€šè¿‡ï¼Œå¼€å§‹æ‰§è¡Œä»»åŠ¡");
    
    // æ‰§è¡Œå…·ä½“ä¸šåŠ¡é€»è¾‘
    executeTask(paramJson);
}

// æ—¥æœŸæ ¼å¼éªŒè¯è¾…åŠ©æ–¹æ³•
private boolean isValidDate(String dateString) {
    try {
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
        sdf.setLenient(false);
        sdf.parse(dateString);
        return true;
    } catch (ParseException e) {
        return false;
    }
}
```

### 6.3 åˆ›å»ºé€šç”¨å‚æ•°éªŒè¯å™¨


```java
public class JobParamValidator {
    
    /**
     * éªŒè¯å¿…éœ€çš„å­—ç¬¦ä¸²å‚æ•°
     */
    public static void requireString(JSONObject params, String key) {
        if (!params.containsKey(key) || 
            params.getString(key) == null || 
            params.getString(key).trim().isEmpty()) {
            throw new RuntimeException("ç¼ºå°‘å¿…éœ€å‚æ•°: " + key);
        }
    }
    
    /**
     * éªŒè¯å¿…éœ€çš„æ•°å­—å‚æ•°
     */
    public static void requireInteger(JSONObject params, String key, int min, int max) {
        if (!params.containsKey(key)) {
            throw new RuntimeException("ç¼ºå°‘å¿…éœ€å‚æ•°: " + key);
        }
        
        Integer value = params.getInteger(key);
        if (value == null) {
            throw new RuntimeException("å‚æ•°" + key + "å¿…é¡»æ˜¯æ•°å­—");
        }
        
        if (value < min || value > max) {
            throw new RuntimeException("å‚æ•°" + key + "å¿…é¡»åœ¨" + min + "-" + max + "ä¹‹é—´");
        }
    }
    
    /**
     * éªŒè¯æ—¥æœŸæ ¼å¼
     */
    public static void requireDate(JSONObject params, String key, String format) {
        requireString(params, key);
        
        String dateString = params.getString(key);
        try {
            SimpleDateFormat sdf = new SimpleDateFormat(format);
            sdf.setLenient(false);
            sdf.parse(dateString);
        } catch (ParseException e) {
            throw new RuntimeException("å‚æ•°" + key + "æ—¥æœŸæ ¼å¼é”™è¯¯ï¼Œåº”ä¸º: " + format);
        }
    }
}
```

---

## 7. ğŸ’¼ å®é™…åº”ç”¨åœºæ™¯æ¡ˆä¾‹


### 7.1 æ•°æ®å¤‡ä»½ä»»åŠ¡


**åœºæ™¯æè¿°**ï¼šå®šæœŸå¤‡ä»½æ•°æ®åº“è¡¨ï¼Œéœ€è¦æŒ‡å®šå¤‡ä»½çš„è¡¨åå’Œæ—¥æœŸèŒƒå›´ã€‚

```java
@XxlJob("databaseBackupHandler")
public void databaseBackupHandler() throws Exception {
    String jobParam = XxlJobHelper.getJobParam();
    
    // è§£æå‚æ•°
    JSONObject params = JobParamUtils.parseJsonParam(jobParam);
    
    // å‚æ•°éªŒè¯
    JobParamValidator.requireString(params, "backupType");
    JobParamValidator.requireDate(params, "startDate", "yyyy-MM-dd");
    JobParamValidator.requireDate(params, "endDate", "yyyy-MM-dd");
    
    String backupType = params.getString("backupType");
    String startDate = params.getString("startDate");  
    String endDate = params.getString("endDate");
    
    XxlJobHelper.log("å¼€å§‹æ‰§è¡Œæ•°æ®å¤‡ä»½");
    XxlJobHelper.log("å¤‡ä»½ç±»å‹: " + backupType);
    XxlJobHelper.log("æ—¥æœŸèŒƒå›´: " + startDate + " è‡³ " + endDate);
    
    // æ ¹æ®å¤‡ä»½ç±»å‹æ‰§è¡Œä¸åŒç­–ç•¥
    switch (backupType) {
        case "full":
            XxlJobHelper.log("æ‰§è¡Œå…¨é‡å¤‡ä»½");
            performFullBackup(startDate, endDate);
            break;
        case "incremental":
            XxlJobHelper.log("æ‰§è¡Œå¢é‡å¤‡ä»½");
            performIncrementalBackup(startDate, endDate);
            break;
        default:
            throw new RuntimeException("ä¸æ”¯æŒçš„å¤‡ä»½ç±»å‹: " + backupType);
    }
    
    XxlJobHelper.log("æ•°æ®å¤‡ä»½å®Œæˆ");
}

private void performFullBackup(String startDate, String endDate) {
    // å®é™…çš„å¤‡ä»½é€»è¾‘
    XxlJobHelper.log("æ­£åœ¨æ‰§è¡Œå…¨é‡å¤‡ä»½...");
}

private void performIncrementalBackup(String startDate, String endDate) {
    // å®é™…çš„å¤‡ä»½é€»è¾‘
    XxlJobHelper.log("æ­£åœ¨æ‰§è¡Œå¢é‡å¤‡ä»½...");
}
```

**å‚æ•°é…ç½®ç¤ºä¾‹**ï¼š
```json
{
    "backupType": "full",
    "startDate": "2024-01-01",
    "endDate": "2024-01-31"
}
```

### 7.2 æ‰¹é‡æ•°æ®å¤„ç†ä»»åŠ¡


**åœºæ™¯æè¿°**ï¼šæ‰¹é‡å¤„ç†ç”¨æˆ·æ•°æ®ï¼Œéœ€è¦æŒ‡å®šå¤„ç†çš„ç”¨æˆ·IDèŒƒå›´å’Œæ‰¹æ¬¡å¤§å°ã€‚

```java
@XxlJob("batchProcessHandler")
public void batchProcessHandler() throws Exception {
    String jobParam = XxlJobHelper.getJobParam();
    JSONObject params = JobParamUtils.parseJsonParam(jobParam);
    
    // å‚æ•°éªŒè¯ä¸é»˜è®¤å€¼è®¾ç½®
    Integer startId = params.getInteger("startId");
    Integer endId = params.getInteger("endId");  
    Integer batchSize = params.getInteger("batchSize");
    
    if (startId == null) startId = 1;
    if (endId == null) endId = 10000;
    if (batchSize == null) batchSize = 100;
    
    XxlJobHelper.log("æ‰¹é‡å¤„ç†å‚æ•° - èµ·å§‹ID: " + startId + 
                    ", ç»“æŸID: " + endId + ", æ‰¹æ¬¡å¤§å°: " + batchSize);
    
    int totalProcessed = 0;
    
    // åˆ†æ‰¹å¤„ç†æ•°æ®
    for (int currentId = startId; currentId <= endId; currentId += batchSize) {
        int batchEndId = Math.min(currentId + batchSize - 1, endId);
        
        XxlJobHelper.log("å¤„ç†ç¬¬ " + currentId + " åˆ° " + batchEndId + " æ¡æ•°æ®");
        
        try {
            int processed = processBatch(currentId, batchEndId);
            totalProcessed += processed;
            
            XxlJobHelper.log("æœ¬æ‰¹æ¬¡å¤„ç†å®Œæˆï¼Œå¤„ç†äº† " + processed + " æ¡æ•°æ®");
            
            // é¿å…ä»»åŠ¡æ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Œå¯ä»¥é€‚å½“ä¼‘çœ 
            Thread.sleep(100);
            
        } catch (Exception e) {
            XxlJobHelper.log("æ‰¹æ¬¡å¤„ç†å¤±è´¥: " + e.getMessage());
            // å¯ä»¥é€‰æ‹©ç»§ç»­å¤„ç†ä¸‹ä¸€æ‰¹ï¼Œæˆ–è€…ç›´æ¥æŠ›å‡ºå¼‚å¸¸ç»ˆæ­¢
            throw e;
        }
    }
    
    XxlJobHelper.log("æ‰¹é‡å¤„ç†å®Œæˆï¼Œæ€»å…±å¤„ç†äº† " + totalProcessed + " æ¡æ•°æ®");
}

private int processBatch(int startId, int endId) {
    // å®é™…çš„æ‰¹é‡å¤„ç†é€»è¾‘
    // è¿”å›å®é™…å¤„ç†çš„æ•°æ®æ¡æ•°
    return endId - startId + 1;
}
```

**å‚æ•°é…ç½®ç¤ºä¾‹**ï¼š
```json
{
    "startId": 1000,
    "endId": 50000, 
    "batchSize": 500
}
```

### 7.3 æ–‡ä»¶æ¸…ç†ä»»åŠ¡


**åœºæ™¯æè¿°**ï¼šå®šæœŸæ¸…ç†ä¸´æ—¶æ–‡ä»¶ï¼Œéœ€è¦æŒ‡å®šæ–‡ä»¶è·¯å¾„ã€ä¿ç•™å¤©æ•°ç­‰å‚æ•°ã€‚

```java
@XxlJob("fileCleanupHandler")
public void fileCleanupHandler() throws Exception {
    String jobParam = XxlJobHelper.getJobParam();
    JSONObject params = JobParamUtils.parseJsonParam(jobParam);
    
    // è·å–æ¸…ç†é…ç½®å‚æ•°
    String cleanupPath = params.getString("cleanupPath");
    Integer keepDays = params.getInteger("keepDays");
    String filePattern = params.getString("filePattern");
    Boolean dryRun = params.getBoolean("dryRun"); // è¯•è¿è¡Œæ¨¡å¼
    
    // è®¾ç½®é»˜è®¤å€¼
    if (cleanupPath == null) cleanupPath = "/tmp";
    if (keepDays == null) keepDays = 7;
    if (filePattern == null) filePattern = "*.tmp";
    if (dryRun == null) dryRun = false;
    
    XxlJobHelper.log("æ–‡ä»¶æ¸…ç†é…ç½®:");
    XxlJobHelper.log("æ¸…ç†è·¯å¾„: " + cleanupPath);
    XxlJobHelper.log("ä¿ç•™å¤©æ•°: " + keepDays + " å¤©");
    XxlJobHelper.log("æ–‡ä»¶åŒ¹é…: " + filePattern);
    XxlJobHelper.log("è¯•è¿è¡Œæ¨¡å¼: " + (dryRun ? "æ˜¯" : "å¦"));
    
    // æ‰§è¡Œæ–‡ä»¶æ¸…ç†
    int deletedCount = performFileCleanup(cleanupPath, keepDays, filePattern, dryRun);
    
    XxlJobHelper.log("æ–‡ä»¶æ¸…ç†å®Œæˆï¼Œ" + (dryRun ? "é¢„è®¡åˆ é™¤" : "å®é™…åˆ é™¤") + 
                    " " + deletedCount + " ä¸ªæ–‡ä»¶");
}

private int performFileCleanup(String path, int keepDays, String pattern, boolean dryRun) {
    // å®é™…çš„æ–‡ä»¶æ¸…ç†é€»è¾‘
    XxlJobHelper.log("æ­£åœ¨æ¸…ç† " + path + " ç›®å½•ä¸‹çš„æ–‡ä»¶...");
    
    // æ¨¡æ‹Ÿæ¸…ç†ç»“æœ
    int deletedCount = 25;
    
    if (dryRun) {
        XxlJobHelper.log("è¯•è¿è¡Œæ¨¡å¼ï¼Œä¸ä¼šå®é™…åˆ é™¤æ–‡ä»¶");
    } else {
        XxlJobHelper.log("å®é™…æ‰§è¡Œæ–‡ä»¶åˆ é™¤æ“ä½œ");
    }
    
    return deletedCount;
}
```

**å‚æ•°é…ç½®ç¤ºä¾‹**ï¼š
```json
{
    "cleanupPath": "/app/temp",
    "keepDays": 3,
    "filePattern": "*.log",
    "dryRun": true
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å‚æ•°ä½œç”¨ï¼šè®©ä»»åŠ¡æ‰§è¡Œæ›´çµæ´»ï¼Œæ”¯æŒä¸åŒåœºæ™¯éœ€æ±‚
ğŸ”¸ è·å–æ–¹æ³•ï¼šXxlJobHelper.getJobParam() è¿”å›å­—ç¬¦ä¸²
ğŸ”¸ è§£ææ–¹å¼ï¼šJSONæ ¼å¼æœ€çµæ´»ï¼Œç®€å•æ ¼å¼æ˜“å¤„ç†  
ğŸ”¸ éªŒè¯æœºåˆ¶ï¼šå‚æ•°éªŒè¯å¾ˆé‡è¦ï¼Œé¿å…è¿è¡Œæ—¶é”™è¯¯
ğŸ”¸ åŠ¨æ€ä¼ é€’ï¼šæ”¯æŒæ‰‹åŠ¨æ‰§è¡Œæ—¶ä¸´æ—¶æŒ‡å®šå‚æ•°
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ å‚æ•°ä¼ é€’çš„æœ¬è´¨**ï¼š
```
è°ƒåº¦ä¸­å¿ƒé…ç½®å‚æ•° â†’ ä»»åŠ¡è§¦å‘æ—¶ä¼ é€’ â†’ æ‰§è¡Œå™¨è·å–ä½¿ç”¨

å°±åƒï¼š
è€æ¿ä¸‹è¾¾ä»»åŠ¡(é…ç½®å‚æ•°) â†’ æ´¾å‘ä»»åŠ¡(ä¼ é€’) â†’ å‘˜å·¥æ‰§è¡Œ(è·å–ä½¿ç”¨)
```

**ğŸ”¹ å‚æ•°æ ¼å¼é€‰æ‹©åŸåˆ™**ï¼š
```
ç®€å•åœºæ™¯ï¼šç”¨å­—ç¬¦ä¸²æˆ–é€—å·åˆ†éš”
å¤æ‚åœºæ™¯ï¼šç”¨JSONæ ¼å¼ï¼Œç»“æ„æ¸…æ™°
æ‰¹é‡å¤„ç†ï¼šç”¨æ•°ç»„æˆ–åˆ—è¡¨æ ¼å¼
é…ç½®å‹ï¼šç”¨é”®å€¼å¯¹æ ¼å¼
```

**ğŸ”¹ é”™è¯¯å¤„ç†ç­–ç•¥**ï¼š
```
å‚æ•°ä¸ºç©º â†’ ä½¿ç”¨é»˜è®¤é…ç½®æˆ–æŠ›å‡ºå¼‚å¸¸
æ ¼å¼é”™è¯¯ â†’ å‹å¥½æç¤ºï¼Œå¸®åŠ©æ’æŸ¥é—®é¢˜  
å€¼ä¸åˆç† â†’ éªŒè¯èŒƒå›´ï¼Œç»™å‡ºå»ºè®®
è§£æå¤±è´¥ â†’ è®°å½•æ—¥å¿—ï¼Œä¾¿äºè°ƒè¯•
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ“ æœ€ä½³å®è·µæ¸…å•**ï¼š
- âœ… **æ€»æ˜¯éªŒè¯å‚æ•°**ï¼šnullæ£€æŸ¥ã€æ ¼å¼éªŒè¯ã€å€¼èŒƒå›´æ£€æŸ¥
- âœ… **è¯¦ç»†è®°å½•æ—¥å¿—**ï¼šå‚æ•°å†…å®¹ã€æ‰§è¡Œæ­¥éª¤ã€ç»“æœçŠ¶æ€
- âœ… **æä¾›é»˜è®¤å€¼**ï¼šå…³é”®å‚æ•°æœ‰åˆç†çš„é»˜è®¤é…ç½®
- âœ… **å¼‚å¸¸å¤„ç†å®Œæ•´**ï¼šæ•è·å¼‚å¸¸å¹¶ç»™å‡ºæ¸…æ™°çš„é”™è¯¯ä¿¡æ¯
- âœ… **åˆ›å»ºå·¥å…·ç±»**ï¼šå°è£…å¸¸ç”¨çš„å‚æ•°è§£æå’ŒéªŒè¯é€»è¾‘

**ğŸš€ è¿›é˜¶æŠ€å·§**ï¼š
- å‚æ•°æ¨¡æ¿ï¼šä¸ºå¸¸è§åœºæ™¯æä¾›å‚æ•°é…ç½®æ¨¡æ¿
- å‚æ•°æ ¡éªŒå™¨ï¼šç»Ÿä¸€çš„å‚æ•°éªŒè¯è§„åˆ™
- åŠ¨æ€é…ç½®ï¼šæ”¯æŒè¿è¡Œæ—¶åŠ¨æ€è°ƒæ•´å‚æ•°
- å‚æ•°ç»§æ‰¿ï¼šå­ä»»åŠ¡å¯ä»¥ç»§æ‰¿çˆ¶ä»»åŠ¡çš„éƒ¨åˆ†å‚æ•°

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
å‚æ•°ä¼ é€’è¦çµæ´»ï¼ŒJSONæ ¼å¼æœ€å¸¸ç”¨
è·å–è§£æè¦ä»”ç»†ï¼ŒéªŒè¯å¤„ç†ä¸èƒ½å°‘  
æ—¥å¿—è®°å½•è¦è¯¦ç»†ï¼Œå¼‚å¸¸å¤„ç†è¦å‹å¥½
å·¥å…·å°è£…ææ•ˆç‡ï¼Œå®é™…åº”ç”¨è§çœŸç« 
```