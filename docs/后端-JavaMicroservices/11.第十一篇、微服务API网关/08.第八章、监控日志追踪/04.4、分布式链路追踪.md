---
title: 4ã€åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª](#1-ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª)
2. [Spring Cloud Sleuthé›†æˆ](#2-Spring-Cloud-Sleuthé›†æˆ)
3. [TraceIdå’ŒSpanIdè¯¦è§£](#3-TraceIdå’ŒSpanIdè¯¦è§£)
4. [ZipkinæœåŠ¡ç«¯é…ç½®](#4-ZipkinæœåŠ¡ç«¯é…ç½®)
5. [Jaegeré“¾è·¯è¿½è¸ª](#5-Jaegeré“¾è·¯è¿½è¸ª)
6. [é“¾è·¯é‡‡æ ·é…ç½®](#6-é“¾è·¯é‡‡æ ·é…ç½®)
7. [è·¨æœåŠ¡è°ƒç”¨è¿½è¸ª](#7-è·¨æœåŠ¡è°ƒç”¨è¿½è¸ª)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª


### 1.1 ä¸ºä»€ä¹ˆéœ€è¦é“¾è·¯è¿½è¸ª


**ç°å®åœºæ™¯é—®é¢˜**ï¼š
```
ä¼ ç»Ÿå•ä½“åº”ç”¨ï¼š
ç”¨æˆ·è¯·æ±‚ â†’ åº”ç”¨å¤„ç† â†’ è¿”å›ç»“æœ
é—®é¢˜å®šä½ï¼šæŸ¥çœ‹å•ä¸ªæ—¥å¿—æ–‡ä»¶å³å¯

å¾®æœåŠ¡æ¶æ„ï¼š
ç”¨æˆ·è¯·æ±‚ â†’ APIç½‘å…³ â†’ è®¢å•æœåŠ¡ â†’ åº“å­˜æœåŠ¡ â†’ æ”¯ä»˜æœåŠ¡ â†’ é€šçŸ¥æœåŠ¡
         â†“          â†“           â†“           â†“           â†“
      å„è‡ªçš„æ—¥å¿—  å„è‡ªçš„æ—¥å¿—   å„è‡ªçš„æ—¥å¿—   å„è‡ªçš„æ—¥å¿—   å„è‡ªçš„æ—¥å¿—

â— é‡åˆ°çš„å›°éš¾ï¼š
â€¢ ä¸€ä¸ªè¯·æ±‚æ¶‰åŠ10+ä¸ªæœåŠ¡ï¼Œæ—¥å¿—åˆ†æ•£åœ¨å¤šå°æœºå™¨
â€¢ å‡ºç°æ…¢è¯·æ±‚æ—¶ï¼Œä¸çŸ¥é“å¡åœ¨å“ªä¸ªç¯èŠ‚
â€¢ æœåŠ¡ä¹‹é—´è°ƒç”¨å…³ç³»å¤æ‚ï¼Œæ— æ³•å¿«é€Ÿå®šä½é—®é¢˜
â€¢ éœ€è¦ç™»å½•æ¯å°æœºå™¨æŸ¥æ—¥å¿—ï¼Œæ•ˆç‡æä½
```

**é“¾è·¯è¿½è¸ªè§£å†³çš„æ ¸å¿ƒé—®é¢˜**ï¼š
- **â‘  è¯·æ±‚è·¯å¾„å¯è§†åŒ–**ï¼šæ¸…æ¥šçœ‹åˆ°è¯·æ±‚ç»è¿‡äº†å“ªäº›æœåŠ¡
- **â‘¡ æ€§èƒ½ç“¶é¢ˆå®šä½**ï¼šå¿«é€Ÿæ‰¾å‡ºè€—æ—¶æœ€é•¿çš„æœåŠ¡ç¯èŠ‚
- **â‘¢ æ•…éšœå¿«é€Ÿæ’æŸ¥**ï¼šå‡ºé”™æ—¶ç«‹å³å®šä½æ˜¯å“ªä¸ªæœåŠ¡å‡ºäº†é—®é¢˜
- **â‘£ æœåŠ¡ä¾èµ–åˆ†æ**ï¼šäº†è§£æœåŠ¡é—´çš„è°ƒç”¨å…³ç³»å’Œä¾èµ–

### 1.2 é“¾è·¯è¿½è¸ªçš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ¯ åŸºæœ¬åŸç†**ï¼ˆç”¨å¿«é€’ç±»æ¯”ç†è§£ï¼‰ï¼š
```
å¿«é€’è¿½è¸ªç³»ç»Ÿï¼š
è®¢å•å·(TraceId) â†’ å”¯ä¸€æ ‡è¯†ä¸€æ¬¡é…é€
  â”œâ”€ æ½ä»¶(Span1) â†’ åŒ—äº¬ä»“åº“æ¥æ”¶åŒ…è£¹
  â”œâ”€ è¿è¾“(Span2) â†’ è¿è¾“åˆ°ä¸Šæµ·ä¸­è½¬ç«™
  â”œâ”€ æ´¾é€(Span3) â†’ ä¸Šæµ·å¿«é€’å‘˜é…é€
  â””â”€ ç­¾æ”¶(Span4) â†’ å®¢æˆ·ç­¾æ”¶

é“¾è·¯è¿½è¸ªç³»ç»Ÿï¼š
è¯·æ±‚ID(TraceId) â†’ å”¯ä¸€æ ‡è¯†ä¸€æ¬¡è¯·æ±‚
  â”œâ”€ ç½‘å…³å¤„ç†(Span1) â†’ API Gatewayæ¥æ”¶è¯·æ±‚
  â”œâ”€ è®¢å•å¤„ç†(Span2) â†’ Order Serviceå¤„ç†
  â”œâ”€ åº“å­˜æ£€æŸ¥(Span3) â†’ Inventory Serviceæ£€æŸ¥
  â””â”€ æ”¯ä»˜å¤„ç†(Span4) â†’ Payment Serviceæ”¯ä»˜
```

**æ ¸å¿ƒæœ¯è¯­è§£é‡Š**ï¼š

| æœ¯è¯­ | é€šä¿—ç†è§£ | æŠ€æœ¯å«ä¹‰ |
|------|---------|---------|
| **Traceï¼ˆè¿½è¸ªï¼‰** | `ä¸€æ¬¡å®Œæ•´çš„å¿«é€’é…é€` | ä¸€æ¬¡å®Œæ•´çš„è¯·æ±‚è°ƒç”¨é“¾è·¯ |
| **Spanï¼ˆè·¨åº¦ï¼‰** | `é…é€è¿‡ç¨‹çš„æŸä¸ªç¯èŠ‚` | è¯·æ±‚é“¾è·¯ä¸­çš„æŸä¸ªæœåŠ¡è°ƒç”¨ |
| **TraceIdï¼ˆè¿½è¸ªIDï¼‰** | `å¿«é€’å•å·` | å…¨å±€å”¯ä¸€çš„è¯·æ±‚æ ‡è¯† |
| **SpanIdï¼ˆè·¨åº¦IDï¼‰** | `ç¯èŠ‚ç¼–å·` | å•ä¸ªæœåŠ¡è°ƒç”¨çš„æ ‡è¯† |
| **ParentSpanId** | `ä¸Šä¸€ç¯èŠ‚ç¼–å·` | çˆ¶çº§è°ƒç”¨çš„SpanId |

### 1.3 é“¾è·¯è¿½è¸ªæ¶æ„


```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”¨æˆ·è¯·æ±‚                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚       API Gatewayï¼ˆç”ŸæˆTraceIdï¼‰    â”‚
        â”‚       TraceId: abc-123              â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    Order Service (SpanId: span-1)          â”‚
        â”‚    ç»§æ‰¿TraceId: abc-123                     â”‚
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â†“                      â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Inventory        â”‚    â”‚ Payment Service     â”‚
    â”‚ (SpanId: span-2) â”‚    â”‚ (SpanId: span-3)    â”‚
    â”‚ TraceId: abc-123 â”‚    â”‚ TraceId: abc-123    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â†“                      â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    é“¾è·¯è¿½è¸ªæ”¶é›†å™¨ï¼ˆZipkin/Jaegerï¼‰   â”‚
        â”‚    æ”¶é›†æ‰€æœ‰Spanä¿¡æ¯ï¼Œç»„è£…å®Œæ•´é“¾è·¯     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å·¥ä½œæµç¨‹**ï¼š
1. **ç”ŸæˆTraceId**ï¼šAPIç½‘å…³æ”¶åˆ°è¯·æ±‚æ—¶ç”Ÿæˆå”¯ä¸€TraceId
2. **ä¼ é€’TraceId**ï¼šTraceIdåœ¨æœåŠ¡é—´é€šè¿‡HTTP Headerä¼ é€’
3. **è®°å½•Span**ï¼šæ¯ä¸ªæœåŠ¡è®°å½•è‡ªå·±çš„Spanä¿¡æ¯
4. **ä¸ŠæŠ¥æ•°æ®**ï¼šSpanæ•°æ®å¼‚æ­¥å‘é€åˆ°è¿½è¸ªæœåŠ¡å™¨
5. **å¯è§†åŒ–å±•ç¤º**ï¼šè¿½è¸ªæœåŠ¡å™¨ç»„è£…å¹¶å±•ç¤ºå®Œæ•´è°ƒç”¨é“¾

---

## 2. ğŸš€ Spring Cloud Sleuthé›†æˆ


### 2.1 Sleuthæ˜¯ä»€ä¹ˆ


> **Spring Cloud Sleuth** æ˜¯Spring Cloudæä¾›çš„åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªè§£å†³æ–¹æ¡ˆï¼Œå®ƒèƒ½è‡ªåŠ¨ä¸ºä½ çš„å¾®æœåŠ¡æ·»åŠ TraceIdå’ŒSpanIdï¼Œæ— éœ€æ‰‹åŠ¨ç¼–ç ã€‚

**æ ¸å¿ƒç‰¹ç‚¹**ï¼š
- âœ… **è‡ªåŠ¨åŸ‹ç‚¹**ï¼šæ— éœ€ä¿®æ”¹ä¸šåŠ¡ä»£ç ï¼Œè‡ªåŠ¨æ³¨å…¥è¿½è¸ªä¿¡æ¯
- âœ… **æ—¥å¿—é›†æˆ**ï¼šè‡ªåŠ¨åœ¨æ—¥å¿—ä¸­æ·»åŠ TraceIdå’ŒSpanId
- âœ… **å¤šåè®®æ”¯æŒ**ï¼šHTTPã€æ¶ˆæ¯é˜Ÿåˆ—ã€å®šæ—¶ä»»åŠ¡éƒ½æ”¯æŒ
- âœ… **å¯æ‰©å±•**ï¼šæ”¯æŒå¤šç§è¿½è¸ªç³»ç»Ÿï¼ˆZipkinã€Jaegerç­‰ï¼‰

### 2.2 å¿«é€Ÿé›†æˆSleuth


**â‘  æ·»åŠ ä¾èµ–**ï¼š
```xml
<!-- Spring Boot 2.x ç‰ˆæœ¬ -->
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-sleuth</artifactId>
</dependency>

<!-- å¦‚æœéœ€è¦ä¸ŠæŠ¥åˆ°Zipkin -->
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-sleuth-zipkin</artifactId>
</dependency>
```

**â‘¡ é…ç½®æ–‡ä»¶**ï¼š
```yaml
spring:
  application:
    name: order-service  # æœåŠ¡åç§°ï¼Œä¼šæ˜¾ç¤ºåœ¨é“¾è·¯ä¸­
  
  sleuth:
    sampler:
      probability: 1.0  # é‡‡æ ·ç‡ï¼š1.0è¡¨ç¤º100%é‡‡æ ·ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®0.1ï¼ˆ10%ï¼‰
```

**â‘¢ æ•ˆæœå±•ç¤º**ï¼š

å¼•å…¥Sleuthåï¼Œä½ çš„æ—¥å¿—ä¼šè‡ªåŠ¨å˜æˆè¿™æ ·ï¼š
```
# åŸå§‹æ—¥å¿—
2025-09-23 10:30:45 INFO  å¤„ç†è®¢å•è¯·æ±‚

# å¼•å…¥Sleuthåçš„æ—¥å¿—
2025-09-23 10:30:45 INFO [order-service,abc123def456,span789,true] å¤„ç†è®¢å•è¯·æ±‚
                         â†‘           â†‘          â†‘        â†‘
                      æœåŠ¡å      TraceId    SpanId   æ˜¯å¦ä¸ŠæŠ¥
```

> ğŸ’¡ **ç†è§£è¦ç‚¹**ï¼šå¼•å…¥Sleuthåï¼Œæ¯æ¡æ—¥å¿—éƒ½ä¼šè‡ªåŠ¨åŠ ä¸Š`[æœåŠ¡å,TraceId,SpanId,å¯¼å‡ºæ ‡å¿—]`ï¼Œè¿™æ ·ä½ å°±èƒ½é€šè¿‡TraceIdå…³è”æ‰€æœ‰ç›¸å…³æ—¥å¿—ã€‚

### 2.3 Sleuthè‡ªåŠ¨åŸ‹ç‚¹èŒƒå›´


**è‡ªåŠ¨æ”¯æŒçš„åœºæ™¯**ï¼š
```
âœ… HTTPè°ƒç”¨ï¼šRestTemplateã€WebClientã€Feign
âœ… æ¶ˆæ¯é˜Ÿåˆ—ï¼šRabbitMQã€Kafka
âœ… å®šæ—¶ä»»åŠ¡ï¼š@Scheduled
âœ… å¼‚æ­¥è°ƒç”¨ï¼š@Async
âœ… æ•°æ®åº“è®¿é—®ï¼šJDBCï¼ˆéœ€è¦é¢å¤–é…ç½®ï¼‰
```

**ç¤ºä¾‹ä»£ç **ï¼ˆå®Œå…¨æ— ä¾µå…¥ï¼‰ï¼š
```java
@RestController
@Slf4j
public class OrderController {
    
    @Autowired
    private RestTemplate restTemplate;
    
    @GetMapping("/order/{id}")
    public String getOrder(@PathVariable String id) {
        // Sleuthä¼šè‡ªåŠ¨ï¼š
        // 1. ç”Ÿæˆæˆ–ä½¿ç”¨å·²æœ‰çš„TraceId
        // 2. åœ¨æ—¥å¿—ä¸­æ‰“å°TraceIdå’ŒSpanId
        log.info("å¼€å§‹å¤„ç†è®¢å•: {}", id);
        
        // 3. è°ƒç”¨å…¶ä»–æœåŠ¡æ—¶ï¼Œè‡ªåŠ¨ä¼ é€’TraceId
        String inventory = restTemplate.getForObject(
            "http://inventory-service/check/" + id, 
            String.class
        );
        
        log.info("åº“å­˜æ£€æŸ¥ç»“æœ: {}", inventory);
        return "è®¢å•å¤„ç†æˆåŠŸ";
    }
}
```

> âš ï¸ **æ–°æ‰‹æç¤º**ï¼šä¸Šé¢çš„ä»£ç å®Œå…¨æ²¡æœ‰å†™ä»»ä½•è¿½è¸ªç›¸å…³çš„ä»£ç ï¼Œä½†Sleuthä¼šè‡ªåŠ¨å¸®ä½ å®Œæˆè¿½è¸ªï¼Œè¿™å°±æ˜¯"è‡ªåŠ¨åŸ‹ç‚¹"çš„æ„æ€ã€‚

---

## 3. ğŸ”¢ TraceIdå’ŒSpanIdè¯¦è§£


### 3.1 TraceIdè¯¦è§£


**TraceIdæ˜¯ä»€ä¹ˆ**ï¼š
> TraceIdå°±åƒæ˜¯ä¸€æ¬¡è¯·æ±‚çš„"èº«ä»½è¯å·"ï¼Œä»è¯·æ±‚è¿›å…¥ç³»ç»Ÿåˆ°ç¦»å¼€ç³»ç»Ÿï¼Œè¿™ä¸ªIDå§‹ç»ˆä¸å˜ã€‚

**TraceIdçš„ç‰¹ç‚¹**ï¼š
```
ç‰¹å¾1: å…¨å±€å”¯ä¸€
â€¢ æ ¼å¼ç¤ºä¾‹: 5f8c3a2b9d7e6f1a
â€¢ ç”Ÿæˆç®—æ³•: é€šå¸¸ä½¿ç”¨UUIDæˆ–é›ªèŠ±ç®—æ³•
â€¢ ä½œç”¨: å”¯ä¸€æ ‡è¯†ä¸€æ¬¡å®Œæ•´çš„è¯·æ±‚é“¾è·¯

ç‰¹å¾2: å…¨é“¾è·¯ä¼ é€’
â€¢ è¯·æ±‚è¿›å…¥ç½‘å…³æ—¶ç”Ÿæˆ
â€¢ é€šè¿‡HTTP Headeråœ¨æœåŠ¡é—´ä¼ é€’
â€¢ ç›´åˆ°è¯·æ±‚å®Œæˆï¼ŒTraceIdä¸å˜

ç‰¹å¾3: æ—¥å¿—å…³è”
â€¢ æ‰€æœ‰æ—¥å¿—éƒ½å¸¦æœ‰ç›¸åŒçš„TraceId
â€¢ é€šè¿‡TraceIdå¯ä»¥æŸ¥è¯¢è¿™æ¬¡è¯·æ±‚çš„æ‰€æœ‰æ—¥å¿—
â€¢ ELKç­‰æ—¥å¿—ç³»ç»Ÿå¯ä»¥æŒ‰TraceIdèšåˆ
```

**TraceIdç”Ÿæˆä¸ä¼ é€’**ï¼š
```
ç¬¬ä¸€æ­¥ï¼šç½‘å…³ç”ŸæˆTraceId
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   API Gateway       â”‚
â”‚   ç”Ÿæˆ TraceId:     â”‚
â”‚   abc-123-def       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“

ç¬¬äºŒæ­¥ï¼šé€šè¿‡HTTP Headerä¼ é€’
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   HTTP Headers:                â”‚
â”‚   X-B3-TraceId: abc-123-def    â”‚  â† Sleuthé»˜è®¤ä½¿ç”¨çš„Header
â”‚   X-B3-SpanId: span-001        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“

ç¬¬ä¸‰æ­¥ï¼šä¸‹æ¸¸æœåŠ¡æ¥æ”¶å¹¶ç»§ç»­ä¼ é€’
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Order Service     â”‚
â”‚   è¯»å– TraceId:     â”‚
â”‚   abc-123-def       â”‚
â”‚   â†“                 â”‚
â”‚   è°ƒç”¨ä¸‹æ¸¸æœåŠ¡æ—¶     â”‚
â”‚   ç»§ç»­ä¼ é€’          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 SpanIdè¯¦è§£


**SpanIdæ˜¯ä»€ä¹ˆ**ï¼š
> SpanIdè¡¨ç¤ºä¸€æ¬¡å…·ä½“çš„æœåŠ¡è°ƒç”¨ï¼Œä¸€ä¸ªTraceåŒ…å«å¤šä¸ªSpanã€‚å°±åƒä¸€è¶Ÿæ—…è¡Œï¼ˆTraceï¼‰åŒ…å«å¤šä¸ªæ™¯ç‚¹ï¼ˆSpanï¼‰ã€‚

**Spançš„å±‚çº§å…³ç³»**ï¼š
```
Trace: abc-123 (ä¸€æ¬¡ç”¨æˆ·ä¸‹å•è¯·æ±‚)
â”‚
â”œâ”€ Span1: gateway-span (ç½‘å…³å±‚)
â”‚  â”œâ”€ å¼€å§‹æ—¶é—´: 10:00:00.000
â”‚  â””â”€ ç»“æŸæ—¶é—´: 10:00:00.050
â”‚
â”œâ”€ Span2: order-span (è®¢å•æœåŠ¡)
â”‚  â”œâ”€ çˆ¶Span: gateway-span
â”‚  â”œâ”€ å¼€å§‹æ—¶é—´: 10:00:00.010
â”‚  â””â”€ ç»“æŸæ—¶é—´: 10:00:00.045
â”‚  â”‚
â”‚  â”œâ”€ Span3: inventory-span (åº“å­˜æœåŠ¡)
â”‚  â”‚  â”œâ”€ çˆ¶Span: order-span
â”‚  â”‚  â”œâ”€ å¼€å§‹æ—¶é—´: 10:00:00.015
â”‚  â”‚  â””â”€ ç»“æŸæ—¶é—´: 10:00:00.025
â”‚  â”‚
â”‚  â””â”€ Span4: payment-span (æ”¯ä»˜æœåŠ¡)
â”‚     â”œâ”€ çˆ¶Span: order-span
â”‚     â”œâ”€ å¼€å§‹æ—¶é—´: 10:00:00.030
â”‚     â””â”€ ç»“æŸæ—¶é—´: 10:00:00.040
```

**Spanè®°å½•çš„ä¿¡æ¯**ï¼š
```yaml
å•ä¸ªSpanåŒ…å«çš„æ•°æ®ï¼š
- spanId: span-002              # å½“å‰Spançš„ID
- parentId: span-001            # çˆ¶Spançš„ID
- traceId: abc-123-def          # æ‰€å±çš„Trace ID
- name: "GET /inventory/check"  # æ“ä½œåç§°
- timestamp: 1632451200000      # å¼€å§‹æ—¶é—´æˆ³
- duration: 150                 # æŒç»­æ—¶é—´(æ¯«ç§’)
- localEndpoint:                # æœ¬åœ°æœåŠ¡ä¿¡æ¯
    serviceName: "order-service"
    ipv4: "192.168.1.10"
    port: 8080
- tags:                         # æ ‡ç­¾ä¿¡æ¯
    http.method: "GET"
    http.path: "/inventory/check"
    http.status_code: "200"
```

### 3.3 TraceIdå’ŒSpanIdçš„å…³ç³»


**å…³ç³»å¯¹æ¯”è¡¨**ï¼š

| ç»´åº¦ | TraceId | SpanId |
|------|---------|--------|
| **æ•°é‡** | ä¸€æ¬¡è¯·æ±‚åªæœ‰1ä¸ª | ä¸€æ¬¡è¯·æ±‚æœ‰å¤šä¸ª |
| **ä½œç”¨** | æ ‡è¯†æ•´ä¸ªè¯·æ±‚é“¾è·¯ | æ ‡è¯†å•æ¬¡æœåŠ¡è°ƒç”¨ |
| **ä¼ é€’** | å…¨é“¾è·¯ä¸å˜ | æ¯ä¸ªæœåŠ¡éƒ½æœ‰æ–°çš„SpanId |
| **ç±»æ¯”** | å¿«é€’å•å· | é…é€ç¯èŠ‚ç¼–å· |
| **æ—¥å¿—** | `[service,TraceId,SpanId]` | `[service,TraceId,SpanId]` |

**å®é™…æ¡ˆä¾‹ç†è§£**ï¼š
```
ç”¨æˆ·è¯·æ±‚: æŸ¥è¯¢è®¢å•è¯¦æƒ…

TraceId: trace-888 (å”¯ä¸€ä¸å˜)

æœåŠ¡è°ƒç”¨é“¾:
API Gateway    â†’ [trace-888, span-1, -]      # ç¬¬ä¸€ä¸ªSpanï¼Œæ— çˆ¶Span
   â†“
Order Service  â†’ [trace-888, span-2, span-1] # çˆ¶Spanæ˜¯span-1
   â†“
User Service   â†’ [trace-888, span-3, span-2] # çˆ¶Spanæ˜¯span-2

æ—¥å¿—ç¤ºä¾‹:
[gateway,trace-888,span-1] æ”¶åˆ°è¯·æ±‚ GET /order/123
[order-service,trace-888,span-2] æŸ¥è¯¢è®¢å• ID=123
[user-service,trace-888,span-3] æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ userId=456
```

> ğŸ’¡ **è®°å¿†æŠ€å·§**ï¼šTraceIdæ˜¯"èº«ä»½è¯"ï¼ŒSpanIdæ˜¯"è¶³è¿¹"ã€‚èº«ä»½è¯ä¸€è¾ˆå­ä¸å˜ï¼Œè¶³è¿¹æ¯åˆ°ä¸€ä¸ªåœ°æ–¹å°±ç•™ä¸€ä¸ªã€‚

---

## 4. ğŸ“Š ZipkinæœåŠ¡ç«¯é…ç½®


### 4.1 Zipkinæ˜¯ä»€ä¹ˆ


> **Zipkin** æ˜¯Twitterå¼€æºçš„åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªç³»ç»Ÿï¼Œç”¨äºæ”¶é›†ã€å­˜å‚¨ã€æŸ¥è¯¢å’Œå¯è§†åŒ–é“¾è·¯æ•°æ®ã€‚

**Zipkinçš„ä½œç”¨**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¾®æœåŠ¡é›†ç¾¤  â”‚ â”€â”€å‘é€Spanæ•°æ®â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  (ç”Ÿäº§è€…)    â”‚                   â”‚   Zipkin      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  (æ”¶é›†å™¨)     â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â†“
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚  Web UI      â”‚
                                  â”‚  (å¯è§†åŒ–)     â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ZipkinæœåŠ¡ç«¯éƒ¨ç½²


**æ–¹å¼ä¸€ï¼šDockerå¿«é€Ÿå¯åŠ¨**ï¼ˆæ¨èæ–°æ‰‹ï¼‰
```bash
# æ‹‰å–Zipkiné•œåƒ
docker pull openzipkin/zipkin

# å¯åŠ¨ZipkinæœåŠ¡
docker run -d \
  --name zipkin \
  -p 9411:9411 \
  openzipkin/zipkin

# è®¿é—®Webç•Œé¢
# http://localhost:9411
```

**æ–¹å¼äºŒï¼šä¸‹è½½JARåŒ…å¯åŠ¨**
```bash
# ä¸‹è½½æœ€æ–°ç‰ˆæœ¬
curl -sSL https://zipkin.io/quickstart.sh | bash -s

# å¯åŠ¨Zipkin
java -jar zipkin.jar

# é»˜è®¤ç«¯å£9411ï¼Œè®¿é—® http://localhost:9411
```

**Zipkiné…ç½®é¡¹è¯´æ˜**ï¼š
```bash
# å®Œæ•´å¯åŠ¨å‘½ä»¤ï¼ˆå¸¦é…ç½®ï¼‰
docker run -d \
  --name zipkin \
  -p 9411:9411 \
  -e STORAGE_TYPE=mysql \           # ä½¿ç”¨MySQLå­˜å‚¨ï¼ˆé»˜è®¤æ˜¯å†…å­˜ï¼‰
  -e MYSQL_HOST=192.168.1.100 \     # MySQLåœ°å€
  -e MYSQL_TCP_PORT=3306 \          # MySQLç«¯å£
  -e MYSQL_USER=zipkin \            # æ•°æ®åº“ç”¨æˆ·
  -e MYSQL_PASS=password \          # æ•°æ®åº“å¯†ç 
  -e MYSQL_DB=zipkin \              # æ•°æ®åº“åç§°
  openzipkin/zipkin
```

### 4.3 å¾®æœåŠ¡æ¥å…¥Zipkin


**â‘  æ·»åŠ ä¾èµ–**ï¼š
```xml
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-sleuth-zipkin</artifactId>
</dependency>
```

**â‘¡ é…ç½®ä¸ŠæŠ¥åœ°å€**ï¼š
```yaml
spring:
  zipkin:
    base-url: http://localhost:9411  # ZipkinæœåŠ¡åœ°å€
    sender:
      type: web  # å‘é€æ–¹å¼ï¼šweb(HTTP) æˆ– rabbit(æ¶ˆæ¯é˜Ÿåˆ—)
  
  sleuth:
    sampler:
      probability: 1.0  # é‡‡æ ·ç‡ï¼šå¼€å‘ç¯å¢ƒ100%ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®10%-20%
```

**â‘¢ éªŒè¯æ•ˆæœ**ï¼š

å¯åŠ¨æœåŠ¡åï¼Œè®¿é—®ä½ çš„APIï¼Œç„¶åæ‰“å¼€Zipkinç•Œé¢ï¼š
```
http://localhost:9411

ç•Œé¢æ“ä½œï¼š
1. é€‰æ‹©æœåŠ¡åç§°ï¼ˆå¦‚ï¼šorder-serviceï¼‰
2. ç‚¹å‡»"æŸ¥æ‰¾"æŒ‰é’®
3. çœ‹åˆ°é“¾è·¯è¿½è¸ªè®°å½•åˆ—è¡¨
4. ç‚¹å‡»æŸæ¡è®°å½•ï¼ŒæŸ¥çœ‹è¯¦ç»†è°ƒç”¨é“¾
```

### 4.4 Zipkinå­˜å‚¨é…ç½®


**å­˜å‚¨æ–¹å¼å¯¹æ¯”**ï¼š

| å­˜å‚¨ç±»å‹ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|---------|------|------|---------|
| **å†…å­˜å­˜å‚¨** | å¯åŠ¨å¿«ï¼Œæ— éœ€é…ç½® | é‡å¯æ•°æ®ä¸¢å¤± | å¼€å‘æµ‹è¯•ç¯å¢ƒ |
| **MySQLå­˜å‚¨** | æ•°æ®æŒä¹…åŒ–ï¼ŒæŸ¥è¯¢æ–¹ä¾¿ | æ€§èƒ½ä¸€èˆ¬ | ä¸­å°è§„æ¨¡ç”Ÿäº§ç¯å¢ƒ |
| **Elasticsearch** | æ€§èƒ½å¼ºï¼Œæ”¯æŒå¤æ‚æŸ¥è¯¢ | éœ€è¦é¢å¤–éƒ¨ç½²ES | å¤§è§„æ¨¡ç”Ÿäº§ç¯å¢ƒ |

**MySQLå­˜å‚¨é…ç½®ç¤ºä¾‹**ï¼š
```sql
-- åˆ›å»ºZipkinæ•°æ®åº“
CREATE DATABASE zipkin CHARACTER SET utf8mb4;

-- Zipkinä¼šè‡ªåŠ¨åˆ›å»ºè¡¨ï¼Œæˆ–æ‰‹åŠ¨å¯¼å…¥å»ºè¡¨SQL
-- https://github.com/openzipkin/zipkin/blob/master/zipkin-storage/mysql-v1/src/main/resources/mysql.sql
```

```yaml
# application.yml
spring:
  zipkin:
    base-url: http://localhost:9411
    storage:
      type: mysql
  datasource:
    url: jdbc:mysql://localhost:3306/zipkin
    username: root
    password: password
    driver-class-name: com.mysql.cj.jdbc.Driver
```

---

## 5. ğŸ¯ Jaegeré“¾è·¯è¿½è¸ª


### 5.1 Jaeger vs Zipkin


**Jaegeræ˜¯ä»€ä¹ˆ**ï¼š
> Jaeger æ˜¯Uberå¼€æºçš„åˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿï¼ŒåŠŸèƒ½ç±»ä¼¼Zipkinï¼Œä½†åœ¨æŸäº›æ–¹é¢æ›´å¼ºå¤§ã€‚

**å¯¹æ¯”è¡¨**ï¼š

| ç‰¹æ€§ | Zipkin | Jaeger |
|------|--------|--------|
| **å¼€æºå…¬å¸** | Twitter | Uber |
| **éƒ¨ç½²éš¾åº¦** | â­â­ ç®€å• | â­â­â­ ä¸­ç­‰ |
| **æ€§èƒ½** | â­â­â­ è‰¯å¥½ | â­â­â­â­ ä¼˜ç§€ |
| **UIç•Œé¢** | â­â­â­ ç®€æ´ | â­â­â­â­ ä¸°å¯Œ |
| **å­˜å‚¨æ”¯æŒ** | å†…å­˜/MySQL/ES | å†…å­˜/Cassandra/ES |
| **é€‚ç”¨åœºæ™¯** | ä¸­å°è§„æ¨¡ | å¤§è§„æ¨¡é«˜å¹¶å‘ |

**é€‰æ‹©å»ºè®®**ï¼š
```
é€‰æ‹©Zipkinï¼š
âœ… å›¢é˜Ÿåˆšæ¥è§¦é“¾è·¯è¿½è¸ª
âœ… å¾®æœåŠ¡è§„æ¨¡ä¸­ç­‰ï¼ˆ<50ä¸ªæœåŠ¡ï¼‰
âœ… éœ€è¦å¿«é€Ÿä¸Šæ‰‹

é€‰æ‹©Jaegerï¼š
âœ… å¤§è§„æ¨¡å¾®æœåŠ¡ï¼ˆ>50ä¸ªæœåŠ¡ï¼‰
âœ… é«˜å¹¶å‘åœºæ™¯ï¼ˆQPS > 10000ï¼‰
âœ… éœ€è¦é«˜çº§æŸ¥è¯¢å’Œåˆ†æåŠŸèƒ½
```

### 5.2 Jaegeréƒ¨ç½²


**Docker Composeéƒ¨ç½²**ï¼ˆæ¨èï¼‰ï¼š
```yaml
# docker-compose.yml
version: '3'
services:
  jaeger:
    image: jaegertracing/all-in-one:latest
    container_name: jaeger
    environment:
      - COLLECTOR_ZIPKIN_HTTP_PORT=9411  # å…¼å®¹Zipkinåè®®
    ports:
      - "5775:5775/udp"   # agentæ¥æ”¶zipkin.thriftåè®®
      - "6831:6831/udp"   # agentæ¥æ”¶jaeger.thriftåè®®
      - "6832:6832/udp"   # agentæ¥æ”¶binary thriftåè®®
      - "5778:5778"       # serve configs
      - "16686:16686"     # Web UIç«¯å£
      - "14268:14268"     # ç›´æ¥æ¥æ”¶jaeger.thriftåè®®
      - "9411:9411"       # Zipkinå…¼å®¹ç«¯å£
```

å¯åŠ¨å‘½ä»¤ï¼š
```bash
docker-compose up -d

# è®¿é—®Jaeger UI
http://localhost:16686
```

### 5.3 Spring Bootæ¥å…¥Jaeger


**æ–¹å¼ä¸€ï¼šä½¿ç”¨OpenTracingï¼ˆæ¨èï¼‰**
```xml
<!-- OpenTracingä¾èµ– -->
<dependency>
    <groupId>io.opentracing.contrib</groupId>
    <artifactId>opentracing-spring-cloud-starter</artifactId>
    <version>0.5.9</version>
</dependency>

<!-- Jaegerå®¢æˆ·ç«¯ -->
<dependency>
    <groupId>io.jaegertracing</groupId>
    <artifactId>jaeger-client</artifactId>
    <version>1.8.1</version>
</dependency>
```

**é…ç½®æ–‡ä»¶**ï¼š
```yaml
opentracing:
  jaeger:
    http-sender:
      url: http://localhost:14268/api/traces  # Jaeger Collectoråœ°å€
    
    const-sampler:
      decision: true  # é‡‡æ ·ç­–ç•¥ï¼štrueè¡¨ç¤º100%é‡‡æ ·
    
    log-spans: true  # æ˜¯å¦åœ¨æ—¥å¿—ä¸­æ‰“å°Spanä¿¡æ¯
```

**æ–¹å¼äºŒï¼šé€šè¿‡Zipkinåè®®æ¥å…¥**ï¼ˆå…¼å®¹æ–¹æ¡ˆï¼‰
```yaml
spring:
  zipkin:
    base-url: http://localhost:9411  # Jaegerçš„Zipkinå…¼å®¹ç«¯å£
  sleuth:
    sampler:
      probability: 1.0
```

> ğŸ’¡ **æ–°æ‰‹å»ºè®®**ï¼šå…ˆç”¨Zipkinåè®®æ¥å…¥ï¼ˆæ–¹å¼äºŒï¼‰ï¼Œå› ä¸ºä¸éœ€è¦é¢å¤–å­¦ä¹ OpenTracing APIï¼Œé…ç½®æ›´ç®€å•ã€‚

### 5.4 Jaeger UIä½¿ç”¨


**ç•Œé¢åŠŸèƒ½è¯´æ˜**ï¼š
```
Jaeger UIç•Œé¢ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [æœç´¢æ ]                                â”‚
â”‚  Service: [é€‰æ‹©æœåŠ¡â–¼]  Operation: [â–¼]   â”‚
â”‚  Tags: [key=value]  Duration: [> 100ms] â”‚
â”‚  â””â”€[æŸ¥æ‰¾è¿½è¸ª]                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [è¿½è¸ªåˆ—è¡¨]                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ order-service  |  200ms  | 5ä¸ªSpanâ”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ payment-service | 150ms | 3ä¸ªSpanâ”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [æ—¶é—´çº¿è§†å›¾] ï¼ˆç‚¹å‡»åå±•å¼€ï¼‰             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ API Gateway    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ      â”‚   â”‚
â”‚  â”‚  Order Service   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ          â”‚   â”‚
â”‚  â”‚   Inventory       â–ˆâ–ˆâ–ˆ            â”‚   â”‚
â”‚  â”‚   Payment          â–ˆâ–ˆâ–ˆâ–ˆ          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é«˜çº§æœç´¢æŠ€å·§**ï¼š
```
æŒ‰æœåŠ¡åæœç´¢:
Service: order-service

æŒ‰è€—æ—¶è¿‡æ»¤ï¼ˆæ‰¾æ…¢è¯·æ±‚ï¼‰:
minDuration: 1s

æŒ‰æ ‡ç­¾æœç´¢:
http.status_code=500  # æ‰¾é”™è¯¯è¯·æ±‚
error=true            # æ‰¾æœ‰é”™è¯¯çš„è¿½è¸ª

ç»„åˆæœç´¢:
Service: order-service
minDuration: 500ms
http.status_code=200
```

---

## 6. âš™ï¸ é“¾è·¯é‡‡æ ·é…ç½®


### 6.1 ä¸ºä»€ä¹ˆéœ€è¦é‡‡æ ·


**é‡‡æ ·çš„å¿…è¦æ€§**ï¼š
```
ä¸é‡‡æ ·çš„é—®é¢˜ï¼š
â€¢ æ¯ç§’10000ä¸ªè¯·æ±‚ Ã— å¹³å‡5ä¸ªSpan = 50000ä¸ªSpan/ç§’
â€¢ æ¯ä¸ªSpançº¦1KB = 50MB/ç§’çš„æ•°æ®é‡
â€¢ ä¸€å¤©äº§ç”Ÿï¼š50MB Ã— 86400 = 4.3TB æ•°æ®
â€¢ å­˜å‚¨å’ŒæŸ¥è¯¢å‹åŠ›å·¨å¤§ âŒ

é‡‡æ ·åï¼ˆ10%é‡‡æ ·ç‡ï¼‰ï¼š
â€¢ åªè®°å½•10%çš„è¯·æ±‚ = 5000ä¸ªSpan/ç§’
â€¢ æ•°æ®é‡é™ä¸ºï¼š5MB/ç§’
â€¢ ä¸€å¤©äº§ç”Ÿï¼š430GB æ•°æ®
â€¢ å¯æ¥å—çš„å­˜å‚¨æˆæœ¬ âœ…
```

> âš ï¸ **å…³é”®ç†è§£**ï¼šé‡‡æ ·ä¸æ˜¯ä¸ºäº†çœé’±ï¼Œè€Œæ˜¯ä¸ºäº†ç³»ç»Ÿå¯ç”¨æ€§ã€‚100%é‡‡æ ·ä¼šæ‹–å®è¿½è¸ªç³»ç»Ÿæœ¬èº«ã€‚

### 6.2 é‡‡æ ·ç­–ç•¥ç±»å‹


**å¸¸è§é‡‡æ ·ç­–ç•¥**ï¼š

| ç­–ç•¥ç±»å‹ | è¯´æ˜ | é€‚ç”¨åœºæ™¯ | é…ç½®ç¤ºä¾‹ |
|---------|------|---------|---------|
| **å›ºå®šæ¯”ä¾‹** | æŒ‰å›ºå®šç™¾åˆ†æ¯”é‡‡æ · | æµé‡ç¨³å®šçš„æœåŠ¡ | `probability: 0.1` (10%) |
| **é€Ÿç‡é™åˆ¶** | æ¯ç§’æœ€å¤šNæ¡ | é«˜å¹¶å‘æœåŠ¡ | `rate: 100` (æ¯ç§’100æ¡) |
| **è‡ªé€‚åº”** | æ ¹æ®è´Ÿè½½åŠ¨æ€è°ƒæ•´ | æµé‡æ³¢åŠ¨å¤§çš„åœºæ™¯ | éœ€è¦è‡ªå®šä¹‰å®ç° |
| **å…¨é‡é‡‡æ ·** | è®°å½•æ‰€æœ‰è¯·æ±‚ | å¼€å‘/æµ‹è¯•ç¯å¢ƒ | `probability: 1.0` (100%) |

### 6.3 Sleuthé‡‡æ ·é…ç½®


**åŸºäºæ¦‚ç‡çš„é‡‡æ ·**ï¼š
```yaml
spring:
  sleuth:
    sampler:
      probability: 0.1  # 10%çš„è¯·æ±‚è¢«é‡‡æ ·
      
# ä¸åŒç¯å¢ƒçš„é…ç½®å»ºè®®ï¼š
# å¼€å‘ç¯å¢ƒ: probability: 1.0    (100%ï¼Œæ–¹ä¾¿è°ƒè¯•)
# æµ‹è¯•ç¯å¢ƒ: probability: 0.5    (50%ï¼Œå¹³è¡¡æ€§èƒ½å’Œè¦†ç›–)
# ç”Ÿäº§ç¯å¢ƒ: probability: 0.1    (10%ï¼Œé™ä½è´Ÿè½½)
```

**åŸºäºé€Ÿç‡çš„é‡‡æ ·**ï¼š
```java
@Configuration
public class TracingConfig {
    
    @Bean
    public Sampler rateLimitingSampler() {
        return new RateLimitingSampler(100); // æ¯ç§’æœ€å¤š100ä¸ªTrace
    }
}
```

**è‡ªå®šä¹‰é‡‡æ ·ç­–ç•¥**ï¼š
```java
@Component
public class CustomSampler implements Sampler {
    
    @Override
    public boolean isSampled(long traceId) {
        // ç¤ºä¾‹ï¼šåªé‡‡æ ·å¥‡æ•°TraceId
        return traceId % 2 == 1;
    }
}
```

### 6.4 æ™ºèƒ½é‡‡æ ·ç­–ç•¥


**åœºæ™¯ä¸€ï¼šé”™è¯¯å¿…é‡‡æ ·**
```java
@Component
public class ErrorSampler implements Sampler {
    
    private final Tracer tracer;
    
    @Override
    public boolean isSampled(long traceId) {
        // åŸºç¡€é‡‡æ ·ç‡10%
        if (Math.random() < 0.1) {
            return true;
        }
        
        // å¦‚æœå½“å‰Spanæœ‰é”™è¯¯ï¼Œå¼ºåˆ¶é‡‡æ ·
        Span currentSpan = tracer.currentSpan();
        if (currentSpan != null) {
            return currentSpan.tags().containsKey("error");
        }
        
        return false;
    }
}
```

**åœºæ™¯äºŒï¼šæ…¢è¯·æ±‚å¿…é‡‡æ ·**
```yaml
spring:
  sleuth:
    sampler:
      probability: 0.1  # åŸºç¡€é‡‡æ ·ç‡
    
    # æ…¢è¯·æ±‚å®šä¹‰ï¼ˆè‡ªå®šä¹‰é€»è¾‘ï¼‰
    slow-request-threshold: 1000ms  # è¶…è¿‡1ç§’çš„è¯·æ±‚
```

```java
@Aspect
@Component
public class SlowRequestSampler {
    
    @Around("@annotation(org.springframework.web.bind.annotation.GetMapping)")
    public Object sampleSlowRequest(ProceedingJoinPoint pjp) throws Throwable {
        long start = System.currentTimeMillis();
        Object result = pjp.proceed();
        long duration = System.currentTimeMillis() - start;
        
        // è¶…è¿‡é˜ˆå€¼ï¼Œå¼ºåˆ¶è®°å½•
        if (duration > 1000) {
            Span span = tracer.currentSpan();
            span.tag("slow", "true");
            span.tag("duration", duration + "ms");
        }
        
        return result;
    }
}
```

**æ¨èé…ç½®ç»„åˆ**ï¼š
```yaml
spring:
  sleuth:
    sampler:
      probability: ${TRACE_SAMPLE_RATE:0.1}  # åŸºç¡€é‡‡æ ·ç‡ï¼Œç¯å¢ƒå˜é‡å¯è¦†ç›–
    
    # ç‰¹æ®Šè§„åˆ™ï¼ˆéœ€è‡ªå®šä¹‰å®ç°ï¼‰
    web:
      additional-skip-pattern: /health|/metrics  # å¥åº·æ£€æŸ¥ä¸é‡‡æ ·
    
    async:
      enabled: true  # å¼‚æ­¥è°ƒç”¨è¿½è¸ª
    
    scheduled:
      enabled: true  # å®šæ—¶ä»»åŠ¡è¿½è¸ª
```

---

## 7. ğŸ”— è·¨æœåŠ¡è°ƒç”¨è¿½è¸ª


### 7.1 HTTPè°ƒç”¨è¿½è¸ª


**è‡ªåŠ¨è¿½è¸ªçš„HTTPå®¢æˆ·ç«¯**ï¼š
```
âœ… RestTemplate    ï¼ˆSpringåŸç”Ÿï¼‰
âœ… WebClient       ï¼ˆSpring WebFluxï¼‰
âœ… Feign           ï¼ˆå£°æ˜å¼HTTPå®¢æˆ·ç«¯ï¼‰
âœ… OkHttp          ï¼ˆéœ€è¦é¢å¤–é…ç½®ï¼‰
âœ… Apache HttpClientï¼ˆéœ€è¦é¢å¤–é…ç½®ï¼‰
```

**RestTemplateè¿½è¸ªç¤ºä¾‹**ï¼š
```java
@Configuration
public class RestTemplateConfig {
    
    @Bean
    @LoadBalanced  // æ”¯æŒæœåŠ¡å‘ç°
    public RestTemplate restTemplate() {
        return new RestTemplate();
        // Sleuthä¼šè‡ªåŠ¨ä¸ºRestTemplateæ·»åŠ æ‹¦æˆªå™¨
        // è‡ªåŠ¨ä¼ é€’TraceIdå’ŒSpanId
    }
}

@Service
public class OrderService {
    
    @Autowired
    private RestTemplate restTemplate;
    
    public String createOrder(String userId) {
        // è°ƒç”¨ç”¨æˆ·æœåŠ¡ï¼ˆè‡ªåŠ¨ä¼ é€’è¿½è¸ªä¿¡æ¯ï¼‰
        String userInfo = restTemplate.getForObject(
            "http://user-service/users/" + userId,
            String.class
        );
        
        // è°ƒç”¨åº“å­˜æœåŠ¡ï¼ˆè‡ªåŠ¨ä¼ é€’è¿½è¸ªä¿¡æ¯ï¼‰
        String inventory = restTemplate.getForObject(
            "http://inventory-service/check",
            String.class
        );
        
        return "è®¢å•åˆ›å»ºæˆåŠŸ";
    }
}
```

**è¿½è¸ªä¿¡æ¯ä¼ é€’åŸç†**ï¼š
```
å®¢æˆ·ç«¯å‘é€è¯·æ±‚æ—¶çš„Header:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GET /users/123                  â”‚
â”‚ Host: user-service              â”‚
â”‚ X-B3-TraceId: abc123def         â”‚  â† Sleuthè‡ªåŠ¨æ·»åŠ 
â”‚ X-B3-SpanId: span-002           â”‚  â† Sleuthè‡ªåŠ¨æ·»åŠ 
â”‚ X-B3-ParentSpanId: span-001     â”‚  â† çˆ¶Span ID
â”‚ X-B3-Sampled: 1                 â”‚  â† æ˜¯å¦é‡‡æ ·
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 Feignè°ƒç”¨è¿½è¸ª


**Feigné…ç½®**ï¼ˆå®Œå…¨è‡ªåŠ¨ï¼‰ï¼š
```java
// 1. æ·»åŠ ä¾èµ–
// <dependency>
//     <groupId>org.springframework.cloud</groupId>
//     <artifactId>spring-cloud-starter-openfeign</artifactId>
// </dependency>

// 2. å¯ç”¨Feign
@SpringBootApplication
@EnableFeignClients
public class OrderApplication {
    public static void main(String[] args) {
        SpringApplication.run(OrderApplication.class, args);
    }
}

// 3. å®šä¹‰Feignæ¥å£ï¼ˆæ— éœ€ä»»ä½•è¿½è¸ªä»£ç ï¼‰
@FeignClient(name = "user-service")
public interface UserServiceClient {
    
    @GetMapping("/users/{id}")
    UserDTO getUser(@PathVariable("id") String id);
}

// 4. ä½¿ç”¨Feignï¼ˆSleuthè‡ªåŠ¨ä¼ é€’TraceIdï¼‰
@Service
public class OrderService {
    
    @Autowired
    private UserServiceClient userServiceClient;
    
    public void createOrder(String userId) {
        UserDTO user = userServiceClient.getUser(userId);
        // Sleuthå·²ç»è‡ªåŠ¨åœ¨HTTP Headerä¸­ä¼ é€’äº†TraceId
    }
}
```

### 7.3 æ¶ˆæ¯é˜Ÿåˆ—è¿½è¸ª


**RabbitMQè¿½è¸ªé…ç½®**ï¼š
```yaml
spring:
  rabbitmq:
    host: localhost
    port: 5672
    username: guest
    password: guest
  
  sleuth:
    messaging:
      rabbit:
        enabled: true  # å¯ç”¨RabbitMQè¿½è¸ª
```

**å‘é€æ¶ˆæ¯ï¼ˆè‡ªåŠ¨è¿½è¸ªï¼‰**ï¼š
```java
@Service
public class OrderProducer {
    
    @Autowired
    private RabbitTemplate rabbitTemplate;
    
    public void sendOrder(Order order) {
        // Sleuthä¼šè‡ªåŠ¨å°†TraceIdæ”¾å…¥æ¶ˆæ¯Header
        rabbitTemplate.convertAndSend(
            "order-exchange",
            "order.created",
            order
        );
    }
}
```

**æ¶ˆè´¹æ¶ˆæ¯ï¼ˆè‡ªåŠ¨è¿½è¸ªï¼‰**ï¼š
```java
@Service
public class OrderConsumer {
    
    @RabbitListener(queues = "order-queue")
    public void handleOrder(Order order) {
        // Sleuthä¼šè‡ªåŠ¨ä»æ¶ˆæ¯Headerè¯»å–TraceId
        // å¹¶åˆ›å»ºæ–°çš„Spanï¼Œçˆ¶Spanæ˜¯å‘é€æ¶ˆæ¯çš„Span
        log.info("å¤„ç†è®¢å•: {}", order);
    }
}
```

**æ¶ˆæ¯è¿½è¸ªåŸç†**ï¼š
```
æ¶ˆæ¯ç”Ÿäº§è€…:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RabbitMQ Message Headers        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ X-B3-TraceId: abc-123       â”‚â”‚  â† è‡ªåŠ¨æ³¨å…¥
â”‚ â”‚ X-B3-SpanId: span-producer  â”‚â”‚
â”‚ â”‚ X-B3-Sampled: 1             â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚ Body: {"orderId": "123"}        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ é€šè¿‡MQä¼ é€’
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¶ˆæ¯æ¶ˆè´¹è€…                       â”‚
â”‚ è¯»å–Headerä¸­çš„TraceId            â”‚
â”‚ åˆ›å»ºå­Span: span-consumer        â”‚
â”‚ ParentSpan: span-producer        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.4 å¼‚æ­¥è°ƒç”¨è¿½è¸ª


**@Asyncæ–¹æ³•è¿½è¸ª**ï¼š
```java
@Configuration
@EnableAsync
public class AsyncConfig {
    
    @Bean
    public Executor taskExecutor() {
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        executor.setCorePoolSize(5);
        executor.setMaxPoolSize(10);
        executor.setQueueCapacity(100);
        executor.initialize();
        return executor;
    }
}

@Service
public class NotificationService {
    
    @Async
    public void sendNotification(String orderId) {
        // Sleuthä¼šè‡ªåŠ¨å°†çˆ¶çº¿ç¨‹çš„TraceIdä¼ é€’åˆ°å¼‚æ­¥çº¿ç¨‹
        log.info("å‘é€é€šçŸ¥ï¼Œè®¢å•ID: {}", orderId);
        
        // è¿™é‡Œçš„æ—¥å¿—ä¼šæ‰“å°ç›¸åŒçš„TraceId
        // [notification-service,abc-123,span-async,true]
    }
}
```

**æ‰‹åŠ¨ä¼ é€’TraceContextï¼ˆé«˜çº§ç”¨æ³•ï¼‰**ï¼š
```java
@Service
public class OrderService {
    
    @Autowired
    private Tracer tracer;
    
    public void processOrder(String orderId) {
        // è·å–å½“å‰Traceä¸Šä¸‹æ–‡
        TraceContext context = tracer.currentSpan().context();
        
        // æ–°çº¿ç¨‹ä¸­ä½¿ç”¨
        CompletableFuture.runAsync(() -> {
            try (Tracer.SpanInScope ws = tracer.withSpanInScope(
                tracer.toSpan(context))) {
                
                // è¿™é‡Œçš„æ“ä½œä¼šå…³è”åˆ°åŸTrace
                log.info("å¼‚æ­¥å¤„ç†è®¢å•: {}", orderId);
            }
        });
    }
}
```

### 7.5 æ•°æ®åº“è°ƒç”¨è¿½è¸ª


**JDBCè¿½è¸ªé…ç½®**ï¼š
```xml
<!-- æ·»åŠ æ•°æ®åº“è¿½è¸ªä¾èµ– -->
<dependency>
    <groupId>io.opentracing.contrib</groupId>
    <artifactId>opentracing-jdbc</artifactId>
    <version>0.2.15</version>
</dependency>
```

```yaml
spring:
  datasource:
    # ä½¿ç”¨è¿½è¸ªåŒ…è£…çš„é©±åŠ¨
    driver-class-name: io.opentracing.contrib.jdbc.TracingDriver
    url: jdbc:tracing:mysql://localhost:3306/test
    #     â†‘ æ·»åŠ  tracing: å‰ç¼€
```

**æ•ˆæœå±•ç¤º**ï¼š
```
è¿½è¸ªç•Œé¢ä¼šæ˜¾ç¤ºSQLæ‰§è¡Œæ—¶é—´:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ order-service                  â”‚
â”‚ â”œâ”€ SELECT * FROM orders        â”‚  â† SQL Span
â”‚ â”‚  Duration: 15ms              â”‚
â”‚ â”œâ”€ UPDATE inventory SET...     â”‚  â† SQL Span
â”‚ â”‚  Duration: 8ms               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ”‘ åŸºç¡€æ¦‚å¿µ**ï¼š
```
âœ… é“¾è·¯è¿½è¸ªï¼šè§£å†³å¾®æœåŠ¡è°ƒç”¨é“¾è·¯å¯è§†åŒ–å’Œé—®é¢˜å®šä½
âœ… TraceIdï¼šå…¨å±€å”¯ä¸€çš„è¯·æ±‚æ ‡è¯†ï¼Œå…¨é“¾è·¯ä¸å˜
âœ… SpanIdï¼šå•ä¸ªæœåŠ¡è°ƒç”¨çš„æ ‡è¯†ï¼Œæ¯ä¸ªæœåŠ¡ä¸€ä¸ªæ–°Span
âœ… é‡‡æ ·ï¼šé™ä½æ•°æ®é‡ï¼Œç”Ÿäº§ç¯å¢ƒå¿…é¡»é…ç½®
```

**ğŸ”‘ æŠ€æœ¯é€‰å‹**ï¼š
```
Sleuthï¼šè‡ªåŠ¨åŸ‹ç‚¹ï¼Œæ— ä¾µå…¥é›†æˆ
Zipkinï¼šè½»é‡çº§ï¼Œé€‚åˆä¸­å°è§„æ¨¡
Jaegerï¼šé«˜æ€§èƒ½ï¼Œé€‚åˆå¤§è§„æ¨¡é«˜å¹¶å‘
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**â‘  é“¾è·¯è¿½è¸ªçš„ä»·å€¼**ï¼š
```
é—®é¢˜å®šä½ï¼šå¿«é€Ÿæ‰¾åˆ°æ…¢è¯·æ±‚ã€é”™è¯¯è¯·æ±‚çš„æ ¹å› 
æ€§èƒ½ä¼˜åŒ–ï¼šç›´è§‚çœ‹åˆ°å“ªä¸ªç¯èŠ‚è€—æ—¶é•¿
ä¾èµ–åˆ†æï¼šäº†è§£æœåŠ¡é—´çš„è°ƒç”¨å…³ç³»
```

**â‘¡ TraceIdä¼ é€’æœºåˆ¶**ï¼š
```
HTTPè°ƒç”¨ï¼šé€šè¿‡HTTP Headerä¼ é€’ï¼ˆX-B3-TraceIdï¼‰
æ¶ˆæ¯é˜Ÿåˆ—ï¼šé€šè¿‡æ¶ˆæ¯Headerä¼ é€’
å¼‚æ­¥è°ƒç”¨ï¼šé€šè¿‡ThreadLocalä¼ é€’
```

**â‘¢ é‡‡æ ·ç­–ç•¥**ï¼š
```
å¼€å‘ç¯å¢ƒï¼š100%é‡‡æ ·ï¼ˆprobability: 1.0ï¼‰
ç”Ÿäº§ç¯å¢ƒï¼š10%-20%é‡‡æ ·ï¼ˆprobability: 0.1ï¼‰
ç‰¹æ®Šè§„åˆ™ï¼šé”™è¯¯å’Œæ…¢è¯·æ±‚å¼ºåˆ¶é‡‡æ ·
```

### 8.3 å®é™…åº”ç”¨å»ºè®®


**ğŸ› ï¸ å®æ–½æ­¥éª¤**ï¼š
```
ç¬¬ä¸€æ­¥ï¼šå¼•å…¥Sleuthä¾èµ–ï¼ŒéªŒè¯TraceIdç”Ÿæˆ
ç¬¬äºŒæ­¥ï¼šéƒ¨ç½²Zipkin/JaegeræœåŠ¡ç«¯
ç¬¬ä¸‰æ­¥ï¼šé…ç½®å¾®æœåŠ¡ä¸ŠæŠ¥è¿½è¸ªæ•°æ®
ç¬¬å››æ­¥ï¼šè°ƒæ•´é‡‡æ ·ç‡ï¼Œä¼˜åŒ–æ€§èƒ½
ç¬¬äº”æ­¥ï¼šæ¥å…¥ç›‘æ§å‘Šè­¦ï¼ŒåŠæ—¶å‘ç°é—®é¢˜
```

**âš ï¸ å¸¸è§é—®é¢˜**ï¼š

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|---------|
| çœ‹ä¸åˆ°è¿½è¸ªæ•°æ® | é‡‡æ ·ç‡ä¸º0æˆ–æœªé…ç½®ä¸ŠæŠ¥åœ°å€ | æ£€æŸ¥`probability`å’Œ`base-url` |
| TraceIdæ–­é“¾ | è‡ªå®šä¹‰HTTPå®¢æˆ·ç«¯æœªé›†æˆSleuth | ä½¿ç”¨RestTemplateæˆ–Feign |
| æ€§èƒ½ä¸‹é™ | 100%é‡‡æ ·å¯¼è‡´å¤§é‡æ•°æ®ä¸ŠæŠ¥ | è°ƒæ•´é‡‡æ ·ç‡åˆ°10%-20% |
| å¼‚æ­¥è°ƒç”¨ä¸¢å¤±TraceId | æœªé…ç½®å¼‚æ­¥è¿½è¸ª | å¯ç”¨`spring.sleuth.async.enabled` |

**ğŸ’¡ æœ€ä½³å®è·µ**ï¼š
```
âœ… ç»Ÿä¸€ä½¿ç”¨Sleuthè‡ªåŠ¨åŸ‹ç‚¹ï¼Œé¿å…æ‰‹åŠ¨ç¼–ç 
âœ… ç”Ÿäº§ç¯å¢ƒå¿…é¡»é…ç½®åˆç†çš„é‡‡æ ·ç‡
âœ… ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—å­˜å‚¨è¿½è¸ªæ•°æ®ï¼Œæé«˜å¯é æ€§
âœ… å®šæœŸæ¸…ç†å†å²è¿½è¸ªæ•°æ®ï¼Œé¿å…å­˜å‚¨çˆ†æ»¡
âœ… ç»“åˆæ—¥å¿—ç³»ç»Ÿï¼ˆELKï¼‰ï¼Œå®ç°æ—¥å¿—ä¸é“¾è·¯å…³è”
```

**ğŸ¯ è¿›é˜¶å­¦ä¹ æ–¹å‘**ï¼š
- è‡ªå®šä¹‰Spanæ ‡ç­¾å’Œäº‹ä»¶
- å®ç°ä¸šåŠ¡çº§åˆ«çš„é“¾è·¯è¿½è¸ª
- è¿½è¸ªæ•°æ®çš„ç»Ÿè®¡åˆ†æå’Œå¯è§†åŒ–
- ä¸APMç³»ç»Ÿï¼ˆå¦‚Skywalkingï¼‰é›†æˆ

---

> ğŸ’¡ **è®°å¿†å£è¯€**ï¼š  
> å¾®æœåŠ¡è°ƒç”¨é“¾è·¯é•¿ï¼Œè¿½è¸ªç³»ç»Ÿæ¥å¸®å¿™  
> TraceIdå…¨ç¨‹ä¸å˜æ ·ï¼ŒSpanIdæ¯ç«™è®°ä¸€ç«   
> Sleuthè‡ªåŠ¨åŸ‹ç‚¹å¼ºï¼ŒZipkinå±•ç¤ºå¯è§†åŒ–  
> é‡‡æ ·é…ç½®è¦åˆç†ï¼Œç”Ÿäº§ç¯å¢ƒåˆ«å¿˜é™