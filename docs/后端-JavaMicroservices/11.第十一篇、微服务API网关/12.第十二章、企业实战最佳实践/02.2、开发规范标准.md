---
title: 2ã€å¼€å‘è§„èŒƒæ ‡å‡†
---
## ğŸ“š ç›®å½•

1. [ä»£ç è§„èŒƒæ ‡å‡†](#1-ä»£ç è§„èŒƒæ ‡å‡†)
2. [é…ç½®å‘½åè§„èŒƒ](#2-é…ç½®å‘½åè§„èŒƒ)
3. [æ³¨é‡Šæ–‡æ¡£è§„èŒƒ](#3-æ³¨é‡Šæ–‡æ¡£è§„èŒƒ)
4. [ç‰ˆæœ¬ç®¡ç†è§„èŒƒ](#4-ç‰ˆæœ¬ç®¡ç†è§„èŒƒ)
5. [æµ‹è¯•ç”¨ä¾‹è§„èŒƒ](#5-æµ‹è¯•ç”¨ä¾‹è§„èŒƒ)
6. [ä»£ç å®¡æŸ¥æµç¨‹](#6-ä»£ç å®¡æŸ¥æµç¨‹)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ“ ä»£ç è§„èŒƒæ ‡å‡†


### 1.1 ä¸ºä»€ä¹ˆéœ€è¦ä»£ç è§„èŒƒ


**é€šä¿—ç†è§£**ï¼šå°±åƒå†™å­—è¦å·¥æ•´ä¸€æ ·ï¼Œå†™ä»£ç ä¹Ÿè¦æœ‰ç»Ÿä¸€çš„"ç¬”è¿¹"

```
æƒ³è±¡ä¸€ä¸ªåœºæ™¯ï¼š
ä½ æ¥æ‰‹åˆ«äººçš„ä»£ç  â†’ æ¯ä¸ªäººé£æ ¼ä¸åŒ â†’ çœ‹ä¸æ‡‚ã€æ”¹ä¸äº†
æœ‰äº†è§„èŒƒ â†’ æ‰€æœ‰äººå†™æ³•ä¸€è‡´ â†’ å®¹æ˜“ç†è§£ã€å¥½ç»´æŠ¤

ä»£ç è§„èŒƒçš„ä»·å€¼ï¼š
âœ… å›¢é˜Ÿåä½œæ›´é¡ºç•…ï¼ˆå¤§å®¶éƒ½çœ‹å¾—æ‡‚ï¼‰
âœ… å‡å°‘ä½çº§é”™è¯¯ï¼ˆç»Ÿä¸€æ ‡å‡†å°‘çŠ¯é”™ï¼‰
âœ… æé«˜ä»£ç è´¨é‡ï¼ˆä¸“ä¸šåŒ–ã€è§„èŒƒåŒ–ï¼‰
âœ… é™ä½ç»´æŠ¤æˆæœ¬ï¼ˆæ–°äººä¹Ÿèƒ½å¿«é€Ÿä¸Šæ‰‹ï¼‰
```

### 1.2 åŒ…ç»“æ„è§„èŒƒ


**ğŸ—ï¸ æ ‡å‡†åŒ…ç»“æ„**ï¼ˆæŒ‰åŠŸèƒ½åˆ†å±‚ï¼‰

```
com.company.gateway
â”œâ”€â”€ config/          # é…ç½®ç±»ï¼ˆå„ç§é…ç½®éƒ½æ”¾è¿™ï¼‰
â”œâ”€â”€ filter/          # è¿‡æ»¤å™¨ï¼ˆå¤„ç†è¯·æ±‚çš„æ‹¦æˆªé€»è¾‘ï¼‰
â”œâ”€â”€ handler/         # å¤„ç†å™¨ï¼ˆå…·ä½“ä¸šåŠ¡å¤„ç†ï¼‰
â”œâ”€â”€ service/         # ä¸šåŠ¡æœåŠ¡ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰
â”œâ”€â”€ util/            # å·¥å…·ç±»ï¼ˆå…¬å…±æ–¹æ³•ï¼‰
â”œâ”€â”€ constant/        # å¸¸é‡ç±»ï¼ˆä¸å˜çš„å€¼ï¼‰
â”œâ”€â”€ exception/       # å¼‚å¸¸ç±»ï¼ˆé”™è¯¯å¤„ç†ï¼‰
â””â”€â”€ model/           # æ•°æ®æ¨¡å‹
    â”œâ”€â”€ dto/         # æ•°æ®ä¼ è¾“å¯¹è±¡
    â”œâ”€â”€ vo/          # è§†å›¾å¯¹è±¡
    â””â”€â”€ entity/      # å®ä½“å¯¹è±¡
```

**ğŸ’¡ åŒ…å‘½ååŸåˆ™**

| è§„åˆ™ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **å…¨å°å†™** | åŒ…åå¿…é¡»å…¨éƒ¨å°å†™ | `com.company.gateway` âœ…<br>`com.Company.Gateway` âŒ |
| **æœ‰æ„ä¹‰** | åç§°è¦èƒ½è¯´æ˜ç”¨é€” | `filter` âœ…ï¼ˆè¿‡æ»¤å™¨ï¼‰<br>`abc` âŒï¼ˆçœ‹ä¸æ‡‚ï¼‰ |
| **ç®€æ´** | ä¸è¦å¤ªé•¿ï¼Œ2-3ä¸ªå•è¯ | `authfilter` âœ…<br>`authenticationfilterconfig` âŒ |

### 1.3 ç±»å‘½åè§„èŒƒ


**ğŸ¯ æ ¸å¿ƒåŸåˆ™**ï¼šè§åçŸ¥æ„ï¼ˆçœ‹åˆ°åå­—å°±çŸ¥é“æ˜¯å¹²ä»€ä¹ˆçš„ï¼‰

```
ç±»å‘½åå…¬å¼ = åŠŸèƒ½æè¿° + ç±»å‹åç¼€

å¸¸è§åç¼€ï¼š
â€¢ Config    â†’ é…ç½®ç±»
â€¢ Filter    â†’ è¿‡æ»¤å™¨
â€¢ Handler   â†’ å¤„ç†å™¨
â€¢ Service   â†’ æœåŠ¡ç±»
â€¢ Util      â†’ å·¥å…·ç±»
â€¢ Constants â†’ å¸¸é‡ç±»
â€¢ Exception â†’ å¼‚å¸¸ç±»
```

**ğŸ“‹ å‘½åç¤ºä¾‹å¯¹æ¯”**

| ç±»å‹ | âŒ é”™è¯¯ç¤ºä¾‹ | âœ… æ­£ç¡®ç¤ºä¾‹ | è¯´æ˜ |
|------|------------|------------|------|
| é…ç½®ç±» | `GatewayConf` | `GatewayConfig` | ä½¿ç”¨å®Œæ•´å•è¯ |
| è¿‡æ»¤å™¨ | `Auth` | `AuthFilter` | åŠ ä¸Šç±»å‹åç¼€ |
| å¸¸é‡ç±» | `Const` | `GatewayConstants` | æ˜ç¡®å¸¸é‡ç”¨é€” |
| å¼‚å¸¸ç±» | `MyException` | `GatewayException` | è¯´æ˜å¼‚å¸¸æ¥æº |

**ğŸ”§ å®æˆ˜ç¤ºä¾‹**

```java
// âœ… å¥½çš„å‘½åï¼šä¸€çœ‹å°±æ‡‚
public class JwtAuthFilter implements GatewayFilter {
    // JWTè®¤è¯è¿‡æ»¤å™¨
}

public class RateLimitConfig {
    // é™æµé…ç½®ç±»
}

// âŒ ä¸å¥½çš„å‘½åï¼šçœ‹ä¸æ‡‚
public class JF implements GatewayFilter {
    // ä»€ä¹ˆé¬¼ï¼Ÿ
}

public class RLC {
    // å®Œå…¨ä¸çŸ¥é“å¹²å˜›çš„
}
```

### 1.4 æ–¹æ³•å‘½åè§„èŒƒ


**ğŸ“Œ åŸºæœ¬è§„åˆ™**

```
æ–¹æ³•å‘½å = åŠ¨è¯ + åè¯ï¼ˆè¯´æ˜åšä»€ä¹ˆäº‹ï¼‰

å¸¸ç”¨åŠ¨è¯å‰ç¼€ï¼š
â€¢ get    â†’ è·å–æ•°æ®
â€¢ set    â†’ è®¾ç½®æ•°æ®
â€¢ is/has â†’ åˆ¤æ–­çŠ¶æ€
â€¢ create â†’ åˆ›å»ºå¯¹è±¡
â€¢ delete â†’ åˆ é™¤æ•°æ®
â€¢ update â†’ æ›´æ–°æ•°æ®
â€¢ query  â†’ æŸ¥è¯¢æ•°æ®
â€¢ handle â†’ å¤„ç†é€»è¾‘
```

**ğŸ¨ å‘½åå¯¹ç…§è¡¨**

| åŠŸèƒ½ | âŒ ä¸è§„èŒƒ | âœ… è§„èŒƒå‘½å | 
|------|----------|------------|
| è·å–ç”¨æˆ· | `user()` | `getUser()` |
| åˆ¤æ–­ç™»å½• | `login()` | `isLogin()` |
| å¤„ç†è¯·æ±‚ | `doSomething()` | `handleRequest()` |
| éªŒè¯Token | `check()` | `validateToken()` |

**ğŸ’» ä»£ç ç¤ºä¾‹**

```java
// âœ… è§„èŒƒçš„æ–¹æ³•å‘½å
public class AuthService {
    
    // è·å–ç”¨æˆ·ä¿¡æ¯
    public UserInfo getUserInfo(String userId) { }
    
    // éªŒè¯Tokenæ˜¯å¦æœ‰æ•ˆ
    public boolean validateToken(String token) { }
    
    // åˆ·æ–°Token
    public String refreshToken(String oldToken) { }
}

// âŒ ä¸è§„èŒƒçš„å‘½å
public class AuthService {
    
    public UserInfo user(String userId) { }  // ä¸çŸ¥é“æ˜¯è·å–è¿˜æ˜¯åˆ›å»º
    
    public boolean check(String token) { }   // æ£€æŸ¥ä»€ä¹ˆï¼Ÿ
    
    public String renew(String token) { }    // æ›´æ–°ä»€ä¹ˆï¼Ÿ
}
```

### 1.5 å˜é‡å‘½åè§„èŒƒ


**ğŸ”¤ å‘½åå±‚æ¬¡**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¸¸é‡ï¼šUPPER_CASEï¼ˆå…¨å¤§å†™ä¸‹åˆ’çº¿ï¼‰ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç±»æˆå‘˜ï¼šlowerCamelCaseï¼ˆå°é©¼å³°ï¼‰ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å±€éƒ¨å˜é‡ï¼šlowerCamelCaseï¼ˆå°é©¼å³°ï¼‰â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ“ å®ä¾‹è¯´æ˜**

```java
public class GatewayConfig {
    
    // âœ… å¸¸é‡ï¼šå…¨å¤§å†™+ä¸‹åˆ’çº¿
    private static final int MAX_RETRY_COUNT = 3;
    private static final String DEFAULT_CHARSET = "UTF-8";
    
    // âœ… æˆå‘˜å˜é‡ï¼šå°é©¼å³°
    private String gatewayName;
    private int connectionTimeout;
    
    // âœ… å±€éƒ¨å˜é‡ï¼šå°é©¼å³°ï¼Œè¦æœ‰æ„ä¹‰
    public void process() {
        String userName = getUser();      // ç”¨æˆ·å
        int retryCount = 0;               // é‡è¯•æ¬¡æ•°
        boolean isValid = validate();     // æ˜¯å¦æœ‰æ•ˆ
    }
    
    // âŒ é”™è¯¯ç¤ºä¾‹
    private String GatewayName;           // æˆå‘˜å˜é‡ä¸ç”¨å¤§å†™å¼€å¤´
    private final int max = 3;            // å¸¸é‡è¦å…¨å¤§å†™
    String s = "test";                    // å˜é‡åå¤ªçŸ­ï¼Œä¸çŸ¥é“å«ä¹‰
}
```

---

## 2. âš™ï¸ é…ç½®å‘½åè§„èŒƒ


### 2.1 é…ç½®æ–‡ä»¶è§„èŒƒ


**ğŸ”¸ é…ç½®æ–‡ä»¶ç±»å‹é€‰æ‹©**

```
å¼€å‘ç¯å¢ƒ â†’ application-dev.yml
æµ‹è¯•ç¯å¢ƒ â†’ application-test.yml  
ç”Ÿäº§ç¯å¢ƒ â†’ application-prod.yml

ä¸ºä»€ä¹ˆç”¨ YAML æ ¼å¼ï¼Ÿ
âœ… å±‚æ¬¡æ¸…æ™°ï¼ˆç¼©è¿›è¡¨ç¤ºå±‚çº§ï¼‰
âœ… æ˜“è¯»æ˜“å†™ï¼ˆæ¯”propertiesæ›´ç›´è§‚ï¼‰
âœ… æ”¯æŒå¤æ‚ç»“æ„ï¼ˆåˆ—è¡¨ã€åµŒå¥—å¯¹è±¡ï¼‰
```

### 2.2 é…ç½®é¡¹å‘½åè§„èŒƒ


**ğŸ“‹ å‘½åè§„åˆ™**

| è§„åˆ™ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **å°å†™+æ¨ªçº¿** | å•è¯ç”¨`-`è¿æ¥ | `gateway-name` âœ…<br>`gatewayName` âŒ |
| **å±‚çº§æ¸…æ™°** | ç”¨ç¼©è¿›è¡¨ç¤ºå±‚çº§ | è§ä¸‹æ–¹ç¤ºä¾‹ |
| **æœ‰æ„ä¹‰** | åç§°èƒ½è¯´æ˜ç”¨é€” | `timeout` âœ…<br>`t` âŒ |

**ğŸ”§ æ ‡å‡†é…ç½®ç¤ºä¾‹**

```yaml
# âœ… è§„èŒƒçš„é…ç½®å†™æ³•
spring:
  application:
    name: api-gateway          # åº”ç”¨åç§°
  cloud:
    gateway:
      routes:
        - id: user-service     # è·¯ç”±ID
          uri: lb://user-service
          predicates:
            - Path=/user/**    # è·¯å¾„åŒ¹é…
          filters:
            - StripPrefix=1    # å»é™¤å‰ç¼€
            
# ç½‘å…³é…ç½®
gateway:
  config:
    timeout: 5000              # è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
    retry-count: 3             # é‡è¯•æ¬¡æ•°
    max-connections: 100       # æœ€å¤§è¿æ¥æ•°
    
# é™æµé…ç½®
rate-limit:
  enabled: true                # æ˜¯å¦å¯ç”¨
  redis-key-prefix: gateway:   # Redisé”®å‰ç¼€
  default-capacity: 100        # é»˜è®¤å®¹é‡
```

**ğŸ’¡ é…ç½®åˆ†ç»„å»ºè®®**

```
åŸºæœ¬é…ç½® â†’ åº”ç”¨åã€ç«¯å£ç­‰åŸºç¡€ä¿¡æ¯
è·¯ç”±é…ç½® â†’ å¾®æœåŠ¡è·¯ç”±è§„åˆ™
è¿‡æ»¤é…ç½® â†’ å„ç§è¿‡æ»¤å™¨è®¾ç½®
å®‰å…¨é…ç½® â†’ è®¤è¯ã€æˆæƒç›¸å…³
ç›‘æ§é…ç½® â†’ æ—¥å¿—ã€æŒ‡æ ‡é‡‡é›†
```

---

## 3. ğŸ“– æ³¨é‡Šæ–‡æ¡£è§„èŒƒ


### 3.1 ä¸ºä»€ä¹ˆè¦å†™æ³¨é‡Š


**é€šä¿—ç†è§£**ï¼šä»£ç æ˜¯ç»™æœºå™¨çœ‹çš„ï¼Œæ³¨é‡Šæ˜¯ç»™äººçœ‹çš„

```
åœºæ™¯å¯¹æ¯”ï¼š

æ²¡æœ‰æ³¨é‡Šï¼š
public void process(String data) {
    // è¿™æ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿä¸ºä»€ä¹ˆè¿™ä¹ˆå†™ï¼Ÿ
}

æœ‰æ³¨é‡Šï¼š
/**
 * å¤„ç†ç”¨æˆ·è¯·æ±‚æ•°æ®
 * @param data ç”¨æˆ·æäº¤çš„JSONæ•°æ®
 */
public void process(String data) {
    // ç°åœ¨æ¸…æ¥šäº†ï¼
}
```

**ğŸ¯ æ³¨é‡Šçš„ä¸‰ä¸ªå±‚æ¬¡**

| å±‚æ¬¡ | ä½œç”¨ | ç¤ºä¾‹ |
|------|------|------|
| **ç±»æ³¨é‡Š** | è¯´æ˜ç±»çš„èŒè´£ | è¿™ä¸ªç±»æ˜¯å¹²ä»€ä¹ˆçš„ |
| **æ–¹æ³•æ³¨é‡Š** | è¯´æ˜æ–¹æ³•åŠŸèƒ½ | è¿™ä¸ªæ–¹æ³•åšä»€ä¹ˆäº‹ |
| **è¡Œå†…æ³¨é‡Š** | è¯´æ˜å¤æ‚é€»è¾‘ | ä¸ºä»€ä¹ˆè¿™æ ·å†™ |

### 3.2 ç±»æ³¨é‡Šè§„èŒƒ


**ğŸ“ æ ‡å‡†æ ¼å¼**

```java
/**
 * ç±»çš„åŠŸèƒ½æè¿°ï¼ˆä¸€å¥è¯è¯´æ¸…æ¥šï¼‰
 * 
 * è¯¦ç»†è¯´æ˜ï¼ˆå¯é€‰ï¼‰ï¼š
 * 1. è¿™ä¸ªç±»çš„ä¸»è¦èŒè´£
 * 2. ä½¿ç”¨åœºæ™¯
 * 3. æ³¨æ„äº‹é¡¹
 * 
 * @author ä½œè€…å
 * @date åˆ›å»ºæ—¥æœŸ
 * @version ç‰ˆæœ¬å·
 */
public class JwtAuthFilter implements GatewayFilter {
    // ç±»çš„å®ç°
}
```

**ğŸ”§ å®æˆ˜ç¤ºä¾‹**

```java
/**
 * JWTè®¤è¯è¿‡æ»¤å™¨
 * 
 * åŠŸèƒ½ï¼š
 * 1. ä»è¯·æ±‚å¤´ä¸­æå–JWT Token
 * 2. éªŒè¯Tokençš„æœ‰æ•ˆæ€§
 * 3. è§£æTokenè·å–ç”¨æˆ·ä¿¡æ¯
 * 
 * ä½¿ç”¨åœºæ™¯ï¼š
 * - éœ€è¦èº«ä»½éªŒè¯çš„APIæ¥å£
 * - å¾®æœåŠ¡é—´çš„å®‰å…¨è°ƒç”¨
 * 
 * @author å¼ ä¸‰
 * @date 2025-09-23
 * @version 1.0
 */
public class JwtAuthFilter implements GatewayFilter {
    // å®ç°ä»£ç 
}
```

### 3.3 æ–¹æ³•æ³¨é‡Šè§„èŒƒ


**ğŸ“Œ å®Œæ•´æ³¨é‡Šæ¨¡æ¿**

```java
/**
 * æ–¹æ³•åŠŸèƒ½æè¿°ï¼ˆåšä»€ä¹ˆï¼‰
 * 
 * @param å‚æ•°å å‚æ•°è¯´æ˜
 * @return è¿”å›å€¼è¯´æ˜
 * @throws å¼‚å¸¸ç±»å‹ å¼‚å¸¸è¯´æ˜
 */
```

**ğŸ’» å®ä¾‹ä»£ç **

```java
/**
 * éªŒè¯JWT Tokençš„æœ‰æ•ˆæ€§
 * 
 * @param token JWTä»¤ç‰Œå­—ç¬¦ä¸²
 * @return true-Tokenæœ‰æ•ˆï¼Œfalse-Tokenæ— æ•ˆ
 * @throws TokenExpiredException Tokenå·²è¿‡æœŸæ—¶æŠ›å‡º
 */
public boolean validateToken(String token) throws TokenExpiredException {
    // éªŒè¯é€»è¾‘
    return true;
}

/**
 * åˆ·æ–°è¿‡æœŸçš„Token
 * 
 * @param oldToken æ—§çš„Token
 * @return æ–°ç”Ÿæˆçš„Token
 */
public String refreshToken(String oldToken) {
    // åˆ·æ–°é€»è¾‘
    return newToken;
}
```

### 3.4 è¡Œå†…æ³¨é‡Šè§„èŒƒ


**ğŸ” ä»€ä¹ˆæ—¶å€™å†™è¡Œå†…æ³¨é‡Š**

```
éœ€è¦æ³¨é‡Šçš„æƒ…å†µï¼š
âœ… å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ï¼ˆä¸å¥½ç†è§£çš„åœ°æ–¹ï¼‰
âœ… ç‰¹æ®Šçš„å¤„ç†æ–¹å¼ï¼ˆä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼‰
âœ… é‡è¦çš„è®¡ç®—å…¬å¼ï¼ˆå…¬å¼å«ä¹‰ï¼‰
âœ… ä¸´æ—¶çš„è§£å†³æ–¹æ¡ˆï¼ˆåç»­è¦ä¼˜åŒ–ï¼‰

ä¸éœ€è¦æ³¨é‡Šçš„æƒ…å†µï¼š
âŒ æ˜¾è€Œæ˜“è§çš„ä»£ç ï¼ˆçœ‹å°±æ‡‚çš„ï¼‰
âŒ è‡ªè§£é‡Šçš„å˜é‡åï¼ˆåå­—è¯´æ˜äº†ä¸€åˆ‡ï¼‰
```

**ğŸ“ æ³¨é‡Šç¤ºä¾‹**

```java
public void handleRequest(ServerHttpRequest request) {
    
    // âœ… å¥½çš„æ³¨é‡Šï¼šè¯´æ˜ä¸ºä»€ä¹ˆ
    // ä»è¯·æ±‚å¤´è·å–Tokenï¼Œä¼˜å…ˆä½¿ç”¨Authorizationå¤´
    String token = request.getHeaders().getFirst("Authorization");
    
    // å¦‚æœæ²¡æœ‰Authorizationå¤´ï¼Œå°è¯•ä»Cookieä¸­è·å–ï¼ˆå…¼å®¹è€ç‰ˆæœ¬ï¼‰
    if (token == null) {
        token = getCookieToken(request);
    }
    
    // âœ… å¤æ‚é€»è¾‘çš„æ³¨é‡Š
    // é™æµç®—æ³•ï¼šä»¤ç‰Œæ¡¶ç®—æ³•
    // æ¯ç§’ç”Ÿæˆ100ä¸ªä»¤ç‰Œï¼Œæ¡¶å®¹é‡200
    // å¦‚æœæ¡¶æ»¡ï¼Œæ–°ä»¤ç‰Œä¼šè¢«ä¸¢å¼ƒ
    if (!rateLimiter.tryAcquire()) {
        throw new RateLimitException("è¯·æ±‚è¿‡äºé¢‘ç¹");
    }
    
    // âŒ ä¸å¥½çš„æ³¨é‡Šï¼šåºŸè¯
    int count = 0;  // å®šä¹‰countå˜é‡
    count++;        // countåŠ 1
}
```

---

## 4. ğŸ“¦ ç‰ˆæœ¬ç®¡ç†è§„èŒƒ


### 4.1 Gitåˆ†æ”¯ç®¡ç†


**ğŸŒ³ æ ‡å‡†åˆ†æ”¯æ¨¡å‹**

```
masterï¼ˆä¸»åˆ†æ”¯ï¼‰
    â†“
developï¼ˆå¼€å‘åˆ†æ”¯ï¼‰
    â†“
feature/xxxï¼ˆåŠŸèƒ½åˆ†æ”¯ï¼‰
    â†“
release/x.x.xï¼ˆå‘å¸ƒåˆ†æ”¯ï¼‰
    â†“
hotfix/xxxï¼ˆä¿®å¤åˆ†æ”¯ï¼‰
```

**ğŸ’¡ å„åˆ†æ”¯ç”¨é€”**

| åˆ†æ”¯ç±»å‹ | ç”¨é€” | å‘½åè§„èŒƒ | ç”Ÿå‘½å‘¨æœŸ |
|---------|------|----------|---------|
| **master** | ç”Ÿäº§ç¯å¢ƒä»£ç  | `master` | æ°¸ä¹… |
| **develop** | å¼€å‘ä¸»åˆ†æ”¯ | `develop` | æ°¸ä¹… |
| **feature** | æ–°åŠŸèƒ½å¼€å‘ | `feature/åŠŸèƒ½å` | ä¸´æ—¶ |
| **release** | é¢„å‘å¸ƒç‰ˆæœ¬ | `release/ç‰ˆæœ¬å·` | ä¸´æ—¶ |
| **hotfix** | ç´§æ€¥ä¿®å¤ | `hotfix/é—®é¢˜æè¿°` | ä¸´æ—¶ |

**ğŸ”§ åˆ†æ”¯æ“ä½œæµç¨‹**

```bash
# 1. å¼€å‘æ–°åŠŸèƒ½
git checkout develop                    # åˆ‡åˆ°å¼€å‘åˆ†æ”¯
git pull origin develop                 # æ‹‰å–æœ€æ–°ä»£ç 
git checkout -b feature/jwt-auth        # åˆ›å»ºåŠŸèƒ½åˆ†æ”¯

# 2. å¼€å‘å®Œæˆååˆå¹¶
git checkout develop                    # åˆ‡å›å¼€å‘åˆ†æ”¯
git merge feature/jwt-auth              # åˆå¹¶åŠŸèƒ½åˆ†æ”¯
git push origin develop                 # æ¨é€åˆ°è¿œç¨‹

# 3. å‡†å¤‡å‘å¸ƒ
git checkout -b release/1.0.0           # åˆ›å»ºå‘å¸ƒåˆ†æ”¯
# æµ‹è¯•ã€ä¿®å¤bug

# 4. å‘å¸ƒåˆ°ç”Ÿäº§
git checkout master                     # åˆ‡åˆ°ä¸»åˆ†æ”¯
git merge release/1.0.0                 # åˆå¹¶å‘å¸ƒåˆ†æ”¯
git tag v1.0.0                          # æ‰“ç‰ˆæœ¬æ ‡ç­¾
```

### 4.2 æäº¤ä¿¡æ¯è§„èŒƒ


**ğŸ“ æ ‡å‡†æ ¼å¼**

```
<type>(<scope>): <subject>

<body>

<footer>
```

**ğŸ”¤ æäº¤ç±»å‹è¯´æ˜**

| ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **feat** | æ–°åŠŸèƒ½ | `feat(auth): æ·»åŠ JWTè®¤è¯` |
| **fix** | ä¿®å¤bug | `fix(filter): ä¿®å¤ç©ºæŒ‡é’ˆå¼‚å¸¸` |
| **docs** | æ–‡æ¡£æ›´æ–° | `docs(readme): æ›´æ–°å®‰è£…è¯´æ˜` |
| **style** | ä»£ç æ ¼å¼ | `style: ç»Ÿä¸€ä»£ç ç¼©è¿›` |
| **refactor** | é‡æ„ä»£ç  | `refactor(service): ä¼˜åŒ–æŸ¥è¯¢é€»è¾‘` |
| **test** | æµ‹è¯•ç›¸å…³ | `test(auth): æ·»åŠ å•å…ƒæµ‹è¯•` |
| **chore** | æ„å»º/å·¥å…· | `chore: æ›´æ–°ä¾èµ–ç‰ˆæœ¬` |

**âœ… å¥½çš„æäº¤ç¤ºä¾‹**

```bash
# å®Œæ•´æäº¤ä¿¡æ¯
git commit -m "feat(auth): æ·»åŠ JWT TokenéªŒè¯åŠŸèƒ½

- å®ç°Tokenç”Ÿæˆå’ŒéªŒè¯
- æ·»åŠ Tokenè¿‡æœŸæ—¶é—´é…ç½®
- æ”¯æŒTokenåˆ·æ–°æœºåˆ¶

Closes #123"

# ç®€å•æäº¤ä¿¡æ¯
git commit -m "fix(filter): ä¿®å¤è®¤è¯è¿‡æ»¤å™¨ç©ºæŒ‡é’ˆå¼‚å¸¸"
```

**âŒ ä¸å¥½çš„æäº¤ç¤ºä¾‹**

```bash
git commit -m "ä¿®æ”¹"          # å¤ªç®€å•ï¼Œä¸çŸ¥é“æ”¹äº†ä»€ä¹ˆ
git commit -m "update"        # è‹±æ–‡ä¹Ÿè¦è¯´æ˜æ”¹äº†ä»€ä¹ˆ
git commit -m "fix bug"       # ä»€ä¹ˆbugï¼Ÿåœ¨å“ªé‡Œï¼Ÿ
```

---

## 5. ğŸ§ª æµ‹è¯•ç”¨ä¾‹è§„èŒƒ


### 5.1 æµ‹è¯•åˆ†å±‚


**ğŸ¯ æµ‹è¯•é‡‘å­—å¡”**

```
        /\
       /  \  E2Eæµ‹è¯•ï¼ˆå°‘é‡ï¼‰
      /â”€â”€â”€â”€\  
     /      \ é›†æˆæµ‹è¯•ï¼ˆé€‚é‡ï¼‰
    /â”€â”€â”€â”€â”€â”€â”€â”€\
   /          \ å•å…ƒæµ‹è¯•ï¼ˆå¤§é‡ï¼‰
  /â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\
```

**ğŸ“Š æµ‹è¯•ç±»å‹å¯¹æ¯”**

| æµ‹è¯•ç±»å‹ | è¦†ç›–èŒƒå›´ | æ•°é‡å æ¯” | æ‰§è¡Œé€Ÿåº¦ |
|---------|---------|---------|---------|
| **å•å…ƒæµ‹è¯•** | å•ä¸ªæ–¹æ³•/ç±» | 70% | å¿« âš¡âš¡âš¡ |
| **é›†æˆæµ‹è¯•** | å¤šä¸ªç»„ä»¶ | 20% | ä¸­ç­‰ âš¡âš¡ |
| **E2Eæµ‹è¯•** | å®Œæ•´æµç¨‹ | 10% | æ…¢ âš¡ |

### 5.2 å•å…ƒæµ‹è¯•è§„èŒƒ


**ğŸ”§ æµ‹è¯•ç±»å‘½å**

```
æµ‹è¯•ç±»å = è¢«æµ‹è¯•ç±»å + Test

ç¤ºä¾‹ï¼š
AuthService.java â†’ AuthServiceTest.java
JwtFilter.java   â†’ JwtFilterTest.java
```

**ğŸ“ æµ‹è¯•æ–¹æ³•å‘½å**

```
æ–¹æ³•åæ ¼å¼ï¼štest + æ–¹æ³•å + åœºæ™¯

ç¤ºä¾‹ï¼š
testValidateToken_Success()        # æµ‹è¯•éªŒè¯TokenæˆåŠŸ
testValidateToken_Expired()        # æµ‹è¯•Tokenè¿‡æœŸ
testValidateToken_Invalid()        # æµ‹è¯•Tokenæ— æ•ˆ
```

**ğŸ’» æµ‹è¯•ä»£ç ç¤ºä¾‹**

```java
@SpringBootTest
class AuthServiceTest {
    
    @Autowired
    private AuthService authService;
    
    /**
     * æµ‹è¯•ï¼šTokenéªŒè¯æˆåŠŸçš„æƒ…å†µ
     */
    @Test
    void testValidateToken_Success() {
        // 1. å‡†å¤‡æµ‹è¯•æ•°æ®
        String validToken = "eyJhbGc...";
        
        // 2. æ‰§è¡Œæµ‹è¯•
        boolean result = authService.validateToken(validToken);
        
        // 3. éªŒè¯ç»“æœ
        assertTrue(result, "æœ‰æ•ˆTokenåº”è¯¥éªŒè¯é€šè¿‡");
    }
    
    /**
     * æµ‹è¯•ï¼šTokenè¿‡æœŸçš„æƒ…å†µ
     */
    @Test
    void testValidateToken_Expired() {
        String expiredToken = "expired_token";
        
        // éªŒè¯æ˜¯å¦æŠ›å‡ºé¢„æœŸå¼‚å¸¸
        assertThrows(TokenExpiredException.class, 
            () -> authService.validateToken(expiredToken));
    }
}
```

### 5.3 æµ‹è¯•è¦†ç›–ç‡è¦æ±‚


**ğŸ¯ è¦†ç›–ç‡ç›®æ ‡**

```
æ ¸å¿ƒä¸šåŠ¡ä»£ç ï¼šâ‰¥ 80%
å·¥å…·ç±»ä»£ç ï¼šâ‰¥ 90%
é…ç½®ç±»ä»£ç ï¼šâ‰¥ 60%
æ€»ä½“è¦†ç›–ç‡ï¼šâ‰¥ 70%
```

**ğŸ’¡ æé«˜è¦†ç›–ç‡æŠ€å·§**

- âœ… æ­£å¸¸åœºæ™¯æµ‹è¯•ï¼ˆåŠŸèƒ½æ­£å¸¸å·¥ä½œï¼‰
- âœ… å¼‚å¸¸åœºæ™¯æµ‹è¯•ï¼ˆå„ç§é”™è¯¯æƒ…å†µï¼‰
- âœ… è¾¹ç•Œå€¼æµ‹è¯•ï¼ˆä¸´ç•Œæ¡ä»¶ï¼‰
- âœ… ç©ºå€¼æµ‹è¯•ï¼ˆnullå¤„ç†ï¼‰

---

## 6. ğŸ” ä»£ç å®¡æŸ¥æµç¨‹


### 6.1 ä¸ºä»€ä¹ˆè¦ä»£ç å®¡æŸ¥


**é€šä¿—ç†è§£**ï¼šå°±åƒä½œæ–‡è¦è€å¸ˆæ‰¹æ”¹ï¼Œä»£ç ä¹Ÿéœ€è¦åŒäº‹æ£€æŸ¥

```
ä»£ç å®¡æŸ¥çš„å¥½å¤„ï¼š
âœ… å‘ç°æ½œåœ¨é—®é¢˜ï¼ˆå¤šä¸€åŒçœ¼ç›å°‘ä¸€ä¸ªbugï¼‰
âœ… ç»Ÿä¸€ä»£ç é£æ ¼ï¼ˆå›¢é˜Ÿå†™æ³•ä¿æŒä¸€è‡´ï¼‰
âœ… çŸ¥è¯†å…±äº«ï¼ˆäº’ç›¸å­¦ä¹ æé«˜ï¼‰
âœ… æé«˜ä»£ç è´¨é‡ï¼ˆå€’é€¼å†™å¥½ä»£ç ï¼‰
```

### 6.2 å®¡æŸ¥æ£€æŸ¥æ¸…å•


**ğŸ“‹ åŠŸèƒ½æ€§æ£€æŸ¥**

- [ ] åŠŸèƒ½æ˜¯å¦ç¬¦åˆéœ€æ±‚
- [ ] ä¸šåŠ¡é€»è¾‘æ˜¯å¦æ­£ç¡®
- [ ] å¼‚å¸¸å¤„ç†æ˜¯å¦å®Œå–„
- [ ] è¾¹ç•Œæ¡ä»¶æ˜¯å¦è€ƒè™‘

**ğŸ¨ ä»£ç è´¨é‡æ£€æŸ¥**

- [ ] å‘½åæ˜¯å¦è§„èŒƒæ˜“æ‡‚
- [ ] ä»£ç æ˜¯å¦ç®€æ´æ¸…æ™°
- [ ] æ˜¯å¦æœ‰é‡å¤ä»£ç 
- [ ] æ³¨é‡Šæ˜¯å¦å……åˆ†

**ğŸ”’ å®‰å…¨æ€§æ£€æŸ¥**

- [ ] æ˜¯å¦æœ‰SQLæ³¨å…¥é£é™©
- [ ] æ•æ„Ÿä¿¡æ¯æ˜¯å¦åŠ å¯†
- [ ] æƒé™éªŒè¯æ˜¯å¦å®Œæ•´
- [ ] è¾“å…¥æ˜¯å¦åšéªŒè¯

**âš¡ æ€§èƒ½æ£€æŸ¥**

- [ ] æ˜¯å¦æœ‰æ€§èƒ½ç“¶é¢ˆ
- [ ] æ•°æ®åº“æŸ¥è¯¢æ˜¯å¦ä¼˜åŒ–
- [ ] æ˜¯å¦æœ‰å†…å­˜æ³„æ¼é£é™©
- [ ] ç¼“å­˜ä½¿ç”¨æ˜¯å¦åˆç†

### 6.3 å®¡æŸ¥æµç¨‹


**ğŸ”„ æ ‡å‡†å®¡æŸ¥æµç¨‹**

```
1. æäº¤ä»£ç  â†’ å¼€å‘äººå‘˜åˆ›å»ºPull Request
   â†“
2. è‡ªåŠ¨æ£€æŸ¥ â†’ CI/CDè¿è¡Œæµ‹è¯•å’Œä»£ç æ‰«æ
   â†“
3. äººå·¥å®¡æŸ¥ â†’ èµ„æ·±å¼€å‘è€…Reviewä»£ç 
   â†“
4. ä¿®æ”¹åé¦ˆ â†’ æ ¹æ®å»ºè®®ä¿®æ”¹ä»£ç 
   â†“
5. å†æ¬¡å®¡æŸ¥ â†’ ç¡®è®¤ä¿®æ”¹åé€šè¿‡
   â†“
6. åˆå¹¶ä»£ç  â†’ åˆå¹¶åˆ°ç›®æ ‡åˆ†æ”¯
```

**ğŸ’¬ å®¡æŸ¥è¯„è®ºè§„èŒƒ**

```markdown
âœ… å¥½çš„è¯„è®ºï¼š
"å»ºè®®å°†æ­¤æ–¹æ³•æ‹†åˆ†ä¸ºä¸¤ä¸ªï¼Œæé«˜å¯è¯»æ€§"
"è¿™é‡Œå¯èƒ½æœ‰ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œå»ºè®®åŠ åˆ¤æ–­"
"å˜é‡åuserNameæ¯”nameæ›´æ¸…æ™°"

âŒ ä¸å¥½çš„è¯„è®ºï¼š
"è¿™ä»£ç ä¸è¡Œ"ï¼ˆæ²¡è¯´å“ªé‡Œä¸è¡Œï¼‰
"é‡å†™"ï¼ˆæ²¡è¯´ä¸ºä»€ä¹ˆé‡å†™ï¼‰
"å¤ªçƒ‚äº†"ï¼ˆä¼¤äººä¸”æ— ç”¨ï¼‰
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 è§„èŒƒçš„æ ¸å¿ƒä»·å€¼


```
ğŸ¯ ç»Ÿä¸€æ ‡å‡† â†’ å›¢é˜Ÿåä½œæ›´é«˜æ•ˆ
ğŸ¯ å‡å°‘é”™è¯¯ â†’ ä»£ç è´¨é‡æ›´å¯é 
ğŸ¯ ä¾¿äºç»´æŠ¤ â†’ åæœŸæ”¹åŠ¨æ›´å®¹æ˜“
ğŸ¯ çŸ¥è¯†ä¼ æ‰¿ â†’ æ–°äººä¸Šæ‰‹æ›´å¿«é€Ÿ
```

### 7.2 å¿…é¡»éµå®ˆçš„è§„èŒƒ


**ä»£ç è§„èŒƒè¦ç‚¹**
- âœ… åŒ…åå…¨å°å†™ï¼Œç±»åå¤§é©¼å³°
- âœ… æ–¹æ³•åå°é©¼å³°ï¼Œå¸¸é‡å…¨å¤§å†™
- âœ… è§åçŸ¥æ„ï¼Œä¸ç”¨æ‹¼éŸ³ç¼©å†™

**é…ç½®è§„èŒƒè¦ç‚¹**
- âœ… é…ç½®é¡¹ç”¨æ¨ªçº¿åˆ†éš”
- âœ… å±‚æ¬¡æ¸…æ™°ï¼Œåˆ†ç±»æ˜ç¡®
- âœ… æ³¨é‡Šè¯´æ˜ï¼Œä¾¿äºç†è§£

**æ³¨é‡Šè§„èŒƒè¦ç‚¹**
- âœ… ç±»å’Œæ–¹æ³•å¿…é¡»æœ‰æ³¨é‡Š
- âœ… å¤æ‚é€»è¾‘è¦å†™è¯´æ˜
- âœ… æ³¨é‡Šè¦è¯´æ˜ä¸ºä»€ä¹ˆ

**ç‰ˆæœ¬ç®¡ç†è¦ç‚¹**
- âœ… åˆ†æ”¯å‘½åè§„èŒƒç»Ÿä¸€
- âœ… æäº¤ä¿¡æ¯æ¸…æ™°æ˜äº†
- âœ… ä»£ç å®¡æŸ¥è®¤çœŸè´Ÿè´£

**æµ‹è¯•è§„èŒƒè¦ç‚¹**
- âœ… æ ¸å¿ƒåŠŸèƒ½å¿…é¡»æµ‹è¯•
- âœ… å¼‚å¸¸åœºæ™¯è¦è¦†ç›–
- âœ… æµ‹è¯•ç”¨ä¾‹è¦æ¸…æ™°

### 7.3 å¿«é€Ÿè®°å¿†å£è¯€


```
ğŸ“Œ å‘½åè¦è§„èŒƒï¼Œä¸€çœ‹å°±æ˜ç™½
ğŸ“Œ æ³¨é‡Šè¦æ¸…æ¥šï¼Œç»´æŠ¤ä¸è¿·è·¯
ğŸ“Œ æµ‹è¯•è¦å®Œæ•´ï¼Œè´¨é‡æœ‰ä¿éšœ
ğŸ“Œ å®¡æŸ¥è¦è®¤çœŸï¼Œé—®é¢˜æ—©å‘ç°
ğŸ“Œ è§„èŒƒè®°å¿ƒä¸­ï¼Œåä½œæ›´é¡ºç•…
```

### 7.4 å®æˆ˜å»ºè®®


**ğŸ”¸ æ–°æ‰‹èµ·æ­¥**
1. å…ˆå­¦ä¼šåŸºæœ¬å‘½åè§„èŒƒï¼ˆæœ€å®¹æ˜“ä¸Šæ‰‹ï¼‰
2. å…»æˆå†™æ³¨é‡Šçš„ä¹ æƒ¯ï¼ˆè¾¹å†™è¾¹æ³¨é‡Šï¼‰
3. å­¦ä¼šç”¨Gitç®¡ç†ä»£ç ï¼ˆæ¯å¤©éƒ½è¦ç”¨ï¼‰

**ğŸ”¸ è¿›é˜¶æå‡**
1. å­¦ä¼šå†™æµ‹è¯•ç”¨ä¾‹ï¼ˆæé«˜ä»£ç è´¨é‡ï¼‰
2. å‚ä¸ä»£ç å®¡æŸ¥ï¼ˆå‘é«˜æ‰‹å­¦ä¹ ï¼‰
3. æ€»ç»“æœ€ä½³å®è·µï¼ˆå½¢æˆè‡ªå·±çš„è§„èŒƒï¼‰

**ğŸ”¸ æŒç»­æ”¹è¿›**
- å®šæœŸreviewå›¢é˜Ÿè§„èŒƒ
- æ ¹æ®é¡¹ç›®å®é™…è°ƒæ•´
- å·¥å…·è¾…åŠ©è‡ªåŠ¨æ£€æŸ¥

> **ğŸ’¡ æ¸©é¦¨æç¤º**ï¼š
> è§„èŒƒä¸æ˜¯é™åˆ¶åˆ›é€ åŠ›ï¼Œè€Œæ˜¯è®©å›¢é˜Ÿåä½œæ›´é¡ºç•…ã€‚
> åˆšå¼€å§‹å¯èƒ½è§‰å¾—éº»çƒ¦ï¼Œå…»æˆä¹ æƒ¯åä¼šå‘ç°å¾ˆæœ‰ä»·å€¼ã€‚
> è®°ä½ï¼šå†™ä»£ç æ˜¯å†™ç»™äººçœ‹çš„ï¼Œé¡ºä¾¿è®©æœºå™¨æ‰§è¡Œï¼