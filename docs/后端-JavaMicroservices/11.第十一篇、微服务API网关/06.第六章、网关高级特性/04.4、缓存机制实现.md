---
title: 4ã€ç¼“å­˜æœºåˆ¶å®ç°
---
## ğŸ“š ç›®å½•

1. [ç¼“å­˜æœºåˆ¶åŸºç¡€æ¦‚å¿µ](#1-ç¼“å­˜æœºåˆ¶åŸºç¡€æ¦‚å¿µ)
2. [å“åº”ç¼“å­˜é…ç½®](#2-å“åº”ç¼“å­˜é…ç½®)
3. [ç¼“å­˜é”®ç”Ÿæˆç­–ç•¥](#3-ç¼“å­˜é”®ç”Ÿæˆç­–ç•¥)
4. [ç¼“å­˜è¿‡æœŸæœºåˆ¶](#4-ç¼“å­˜è¿‡æœŸæœºåˆ¶)
5. [ç¼“å­˜å¤±æ•ˆç­–ç•¥](#5-ç¼“å­˜å¤±æ•ˆç­–ç•¥)
6. [ç¼“å­˜ç©¿é€é˜²æŠ¤](#6-ç¼“å­˜ç©¿é€é˜²æŠ¤)
7. [ç¼“å­˜é›ªå´©é˜²æŠ¤](#7-ç¼“å­˜é›ªå´©é˜²æŠ¤)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ç¼“å­˜æœºåˆ¶åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯ç½‘å…³ç¼“å­˜


**é€šä¿—ç†è§£**ï¼š
æƒ³è±¡ä½ æ˜¯ä¸€å®¶é¤å…çš„æœåŠ¡å‘˜ï¼Œæ¯æ¬¡å®¢äººç‚¹èœéƒ½è¦è·‘åˆ°åå¨å»é—®ã€‚å¦‚æœå¾ˆå¤šå®¢äººç‚¹åŒæ ·çš„èœï¼Œä½ è·‘æ¥è·‘å»å°±å¾ˆç´¯ã€‚è¿™æ—¶å€™èªæ˜çš„åšæ³•æ˜¯ï¼šæŠŠä»Šæ—¥èœå•è®°åœ¨å°æœ¬å­ä¸Šï¼Œå®¢äººé—®çš„æ—¶å€™ç›´æ¥å‘Šè¯‰ä»–ä»¬ï¼Œä¸ç”¨æ¯æ¬¡éƒ½è·‘åå¨ã€‚

```
æ²¡æœ‰ç¼“å­˜çš„æƒ…å†µï¼š
å®¢æˆ·ç«¯ â†’ ç½‘å…³ â†’ åç«¯æœåŠ¡ï¼ˆæ¯æ¬¡éƒ½è¦è¯·æ±‚ï¼‰
         â†“
      å“åº”æ—¶é—´ï¼š100ms

æœ‰ç¼“å­˜çš„æƒ…å†µï¼š
å®¢æˆ·ç«¯ â†’ ç½‘å…³ï¼ˆç›´æ¥ä»ç¼“å­˜è¿”å›ï¼‰
         â†“
      å“åº”æ—¶é—´ï¼š5msï¼ˆå¿«äº†20å€ï¼ï¼‰
```

**æ ¸å¿ƒå®šä¹‰**ï¼š
- ç½‘å…³ç¼“å­˜å°±æ˜¯åœ¨APIç½‘å…³å±‚é¢å­˜å‚¨åç«¯æœåŠ¡çš„å“åº”ç»“æœ
- å½“ç›¸åŒè¯·æ±‚å†æ¬¡åˆ°æ¥æ—¶ï¼Œç›´æ¥è¿”å›ç¼“å­˜çš„ç»“æœ
- é¿å…é‡å¤è®¿é—®åç«¯æœåŠ¡ï¼Œæå‡å“åº”é€Ÿåº¦

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦ç½‘å…³ç¼“å­˜


**å®é™…åœºæ™¯ä¸¾ä¾‹**ï¼š

```
ç”µå•†é¦–é¡µåœºæ™¯ï¼š
- å•†å“åˆ†ç±»ä¿¡æ¯ï¼šå˜åŒ–é¢‘ç‡ä½ï¼Œè®¿é—®é‡å¤§
- çƒ­é—¨å•†å“åˆ—è¡¨ï¼š1å°æ—¶æ›´æ–°ä¸€æ¬¡
- ç”¨æˆ·æ¯æ¬¡åˆ·æ–°éƒ½è¯·æ±‚è¿™äº›æ•°æ®

æ²¡æœ‰ç¼“å­˜ï¼š
100ä¸‡ç”¨æˆ· Ã— æ¯äºº3ä¸ªè¯·æ±‚ = 300ä¸‡æ¬¡åç«¯è°ƒç”¨

ä½¿ç”¨ç¼“å­˜ï¼š
ç¬¬1ä¸ªè¯·æ±‚è®¿é—®åç«¯ï¼Œåç»­99ä¸‡9999ä¸ªè¯·æ±‚ç›´æ¥èµ°ç¼“å­˜
åç«¯å‹åŠ›é™ä½99.9999%ï¼
```

**ç¼“å­˜çš„æ ¸å¿ƒä»·å€¼**ï¼š
- âš¡ **æå‡æ€§èƒ½**ï¼šå“åº”é€Ÿåº¦ä»100msé™åˆ°5ms
- ğŸ›¡ï¸ **é™ä½è´Ÿè½½**ï¼šå‡å°‘åç«¯æœåŠ¡å‹åŠ›
- ğŸ’° **èŠ‚çœæˆæœ¬**ï¼šå‡å°‘æœåŠ¡å™¨èµ„æºæ¶ˆè€—
- ğŸ”„ **æé«˜å¯ç”¨æ€§**ï¼šåç«¯æš‚æ—¶æ•…éšœæ—¶ä»å¯å“åº”

### 1.3 ç½‘å…³ç¼“å­˜çš„å·¥ä½œæµç¨‹


```
è¯·æ±‚å¤„ç†æµç¨‹ï¼š

å®¢æˆ·ç«¯è¯·æ±‚
    â†“
[1] ç½‘å…³æ¥æ”¶è¯·æ±‚
    â†“
[2] ç”Ÿæˆç¼“å­˜é”®ï¼ˆæ ¹æ®URLã€å‚æ•°ç­‰ï¼‰
    â†“
[3] æ£€æŸ¥ç¼“å­˜æ˜¯å¦å­˜åœ¨
    â†“
[ç¼“å­˜å‘½ä¸­] --------â†’ [ç›´æ¥è¿”å›ç¼“å­˜æ•°æ®] â†’ å®¢æˆ·ç«¯ï¼ˆå¿«é€Ÿå“åº”ï¼‰
    â†“
[ç¼“å­˜æœªå‘½ä¸­]
    â†“
[4] è½¬å‘è¯·æ±‚åˆ°åç«¯æœåŠ¡
    â†“
[5] è·å–åç«¯å“åº”
    â†“
[6] å­˜å…¥ç¼“å­˜ï¼ˆè®¾ç½®è¿‡æœŸæ—¶é—´ï¼‰
    â†“
[7] è¿”å›å“åº”ç»™å®¢æˆ·ç«¯
```

---

## 2. ğŸ”§ å“åº”ç¼“å­˜é…ç½®


### 2.1 åŸºç¡€ç¼“å­˜é…ç½®


**Spring Cloud Gateway ç¼“å­˜é…ç½®**ï¼š

```yaml
spring:
  cloud:
    gateway:
      routes:
        - id: product-service
          uri: lb://product-service
          predicates:
            - Path=/api/products/**
          filters:
            # å¯ç”¨æœ¬åœ°ç¼“å­˜
            - LocalResponseCache=5m,100MB
          metadata:
            response-cache:
              # ç¼“å­˜æ—¶é•¿ï¼š5åˆ†é’Ÿ
              timeToLive: 300s
              # ç¼“å­˜å¤§å°é™åˆ¶ï¼š100MB
              maxSize: 100MB
```

**é…ç½®è¯´æ˜**ï¼š
- `timeToLive`ï¼šç¼“å­˜æ•°æ®ä¿ç•™æ—¶é—´ï¼ˆç§’ï¼‰
- `maxSize`ï¼šç¼“å­˜å ç”¨çš„æœ€å¤§å†…å­˜ç©ºé—´
- è¶…è¿‡æ—¶é—´æˆ–ç©ºé—´é™åˆ¶æ—¶ï¼Œè‡ªåŠ¨æ¸…ç†æ—§æ•°æ®

### 2.2 Redisç¼“å­˜é…ç½®


**ä¸ºä»€ä¹ˆç”¨Redis**ï¼š
- æœ¬åœ°ç¼“å­˜åªåœ¨å•ä¸ªç½‘å…³å®ä¾‹æœ‰æ•ˆ
- Redisç¼“å­˜å¯ä»¥åœ¨å¤šä¸ªç½‘å…³å®ä¾‹é—´å…±äº«
- æ”¯æŒæ›´å¤§çš„ç¼“å­˜å®¹é‡

```yaml
spring:
  redis:
    host: localhost
    port: 6379
    database: 0
    # è¿æ¥æ± é…ç½®
    lettuce:
      pool:
        max-active: 8    # æœ€å¤§è¿æ¥æ•°
        max-idle: 8      # æœ€å¤§ç©ºé—²è¿æ¥
        min-idle: 2      # æœ€å°ç©ºé—²è¿æ¥
```

**ç¼“å­˜è¿‡æ»¤å™¨å®ç°**ï¼š

```java
@Component
public class RedisCacheFilter implements GlobalFilter, Ordered {
    
    @Autowired
    private RedisTemplate<String, String> redisTemplate;
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, 
                             GatewayFilterChain chain) {
        String cacheKey = generateCacheKey(exchange.getRequest());
        
        // 1. å°è¯•ä»Redisè·å–ç¼“å­˜
        String cachedResponse = redisTemplate.opsForValue().get(cacheKey);
        
        if (cachedResponse != null) {
            // ç¼“å­˜å‘½ä¸­ï¼Œç›´æ¥è¿”å›
            return writeResponse(exchange, cachedResponse);
        }
        
        // 2. ç¼“å­˜æœªå‘½ä¸­ï¼Œè¯·æ±‚åç«¯å¹¶ç¼“å­˜å“åº”
        return chain.filter(exchange).then(
            Mono.fromRunnable(() -> {
                String response = getResponseBody(exchange);
                // ç¼“å­˜5åˆ†é’Ÿ
                redisTemplate.opsForValue()
                    .set(cacheKey, response, 5, TimeUnit.MINUTES);
            })
        );
    }
    
    @Override
    public int getOrder() {
        return -1; // ä¼˜å…ˆçº§æœ€é«˜
    }
}
```

### 2.3 ç¼“å­˜è§„åˆ™é…ç½®


**é’ˆå¯¹ä¸åŒæ¥å£çš„ç¼“å­˜ç­–ç•¥**ï¼š

| æ¥å£ç±»å‹ | ç¼“å­˜æ—¶é•¿ | è¯´æ˜ |
|---------|---------|------|
| **å•†å“åˆ†ç±»** | `1å°æ—¶` | æ•°æ®å˜åŒ–å°‘ï¼Œå¯é•¿æ—¶é—´ç¼“å­˜ |
| **å•†å“åˆ—è¡¨** | `5åˆ†é’Ÿ` | åº“å­˜å¯èƒ½å˜åŒ–ï¼Œé€‚ä¸­ç¼“å­˜ |
| **å•†å“è¯¦æƒ…** | `30ç§’` | ä»·æ ¼å¯èƒ½å˜åŒ–ï¼ŒçŸ­æ—¶é—´ç¼“å­˜ |
| **ç”¨æˆ·è®¢å•** | `ä¸ç¼“å­˜` | å®æ—¶æ€§è¦æ±‚é«˜ |
| **æ”¯ä»˜æ¥å£** | `ä¸ç¼“å­˜` | ç»å¯¹ä¸èƒ½ç¼“å­˜ |

```yaml
spring:
  cloud:
    gateway:
      routes:
        # å•†å“åˆ†ç±»ï¼šé•¿æ—¶é—´ç¼“å­˜
        - id: category-cache
          uri: lb://product-service
          predicates:
            - Path=/api/categories/**
          filters:
            - LocalResponseCache=1h,50MB
        
        # å•†å“åˆ—è¡¨ï¼šä¸­ç­‰ç¼“å­˜
        - id: product-list-cache
          uri: lb://product-service
          predicates:
            - Path=/api/products/list/**
          filters:
            - LocalResponseCache=5m,100MB
        
        # è®¢å•æ¥å£ï¼šä¸ç¼“å­˜
        - id: order-no-cache
          uri: lb://order-service
          predicates:
            - Path=/api/orders/**
          filters:
            - name: RequestRateLimiter
```

---

## 3. ğŸ”‘ ç¼“å­˜é”®ç”Ÿæˆç­–ç•¥


### 3.1 ä»€ä¹ˆæ˜¯ç¼“å­˜é”®


**é€šä¿—ç†è§£**ï¼š
ç¼“å­˜é”®å°±åƒå›¾ä¹¦é¦†çš„ä¹¦ç±ç¼–å·ï¼Œé€šè¿‡è¿™ä¸ªç¼–å·å¯ä»¥å¿«é€Ÿæ‰¾åˆ°å¯¹åº”çš„ä¹¦ã€‚åœ¨ç¼“å­˜ç³»ç»Ÿä¸­ï¼Œç¼“å­˜é”®ç”¨æ¥å”¯ä¸€æ ‡è¯†ä¸€ä»½ç¼“å­˜æ•°æ®ã€‚

```
å›¾ä¹¦é¦†çš„ä¾‹å­ï¼š
ä¹¦ç±ç¼–å·ï¼šA-001-2024
  â†“
æ‰¾åˆ°å¯¹åº”çš„ä¹¦

ç¼“å­˜ç³»ç»Ÿçš„ä¾‹å­ï¼š
ç¼“å­˜é”®ï¼š/api/products?id=123&type=hot
  â†“
æ‰¾åˆ°å¯¹åº”çš„ç¼“å­˜æ•°æ®
```

### 3.2 åŸºç¡€é”®ç”Ÿæˆç­–ç•¥


**æœ€ç®€å•çš„æ–¹å¼ï¼šä½¿ç”¨å®Œæ•´URL**

```java
public class SimpleCacheKeyGenerator {
    
    public String generateKey(ServerHttpRequest request) {
        // ç›´æ¥ä½¿ç”¨å®Œæ•´çš„è¯·æ±‚è·¯å¾„ä½œä¸ºé”®
        // ä¾‹å¦‚ï¼š/api/products/123
        return request.getURI().getPath();
    }
}
```

**é—®é¢˜**ï¼š
- `/api/products?id=123&type=hot` 
- `/api/products?type=hot&id=123`
- è¿™ä¸¤ä¸ªè¯·æ±‚å‚æ•°ç›¸åŒä½†é¡ºåºä¸åŒï¼Œä¼šè¢«å½“ä½œä¸åŒçš„ç¼“å­˜é”®ï¼

### 3.3 å‚æ•°æ’åºç­–ç•¥


**è§£å†³å‚æ•°é¡ºåºé—®é¢˜**ï¼š

```java
public class SortedCacheKeyGenerator {
    
    public String generateKey(ServerHttpRequest request) {
        String path = request.getURI().getPath();
        
        // 1. è·å–æ‰€æœ‰æŸ¥è¯¢å‚æ•°
        MultiValueMap<String, String> params = 
            request.getQueryParams();
        
        // 2. å‚æ•°æ’åºï¼ˆæŒ‰å­—æ¯é¡ºåºï¼‰
        TreeMap<String, String> sortedParams = new TreeMap<>();
        params.forEach((key, values) -> {
            sortedParams.put(key, String.join(",", values));
        });
        
        // 3. æ‹¼æ¥æˆç¼“å­˜é”®
        // ç»“æœï¼š/api/products?id=123&type=hot
        StringBuilder keyBuilder = new StringBuilder(path);
        if (!sortedParams.isEmpty()) {
            keyBuilder.append("?");
            sortedParams.forEach((k, v) -> 
                keyBuilder.append(k).append("=").append(v).append("&")
            );
            // ç§»é™¤æœ€åçš„ &
            keyBuilder.setLength(keyBuilder.length() - 1);
        }
        
        return keyBuilder.toString();
    }
}
```

### 3.4 åŒ…å«ç”¨æˆ·ä¿¡æ¯çš„é”®ç­–ç•¥


**åœºæ™¯**ï¼šä¸åŒç”¨æˆ·çœ‹åˆ°çš„æ•°æ®ä¸åŒ

```java
public class UserAwareCacheKeyGenerator {
    
    public String generateKey(ServerHttpRequest request) {
        String path = request.getURI().getPath();
        
        // 1. è·å–ç”¨æˆ·IDï¼ˆä»Tokenæˆ–Headerä¸­ï¼‰
        String userId = request.getHeaders()
            .getFirst("X-User-ID");
        
        // 2. è·å–æ’åºåçš„å‚æ•°
        String params = getSortedParams(request);
        
        // 3. ç»„åˆç¼“å­˜é”®
        // ç»“æœï¼šuser:1001:/api/products?type=hot
        return String.format("user:%s:%s%s", 
            userId, path, params);
    }
}
```

**é€‚ç”¨åœºæ™¯**ï¼š
- âœ… ç”¨æˆ·è´­ç‰©è½¦ï¼šæ¯ä¸ªç”¨æˆ·çœ‹åˆ°è‡ªå·±çš„è´­ç‰©è½¦
- âœ… ä¸ªæ€§åŒ–æ¨èï¼šæ¯ä¸ªç”¨æˆ·çš„æ¨èç»“æœä¸åŒ
- âŒ å•†å“åˆ†ç±»ï¼šæ‰€æœ‰ç”¨æˆ·çœ‹åˆ°çš„éƒ½ä¸€æ ·ï¼Œä¸éœ€è¦ç”¨æˆ·ID

### 3.5 è‡ªå®šä¹‰é”®ç­–ç•¥é…ç½®


```java
@Configuration
public class CacheKeyConfig {
    
    @Bean
    public KeyResolver customKeyResolver() {
        return exchange -> {
            ServerHttpRequest request = exchange.getRequest();
            String path = request.getURI().getPath();
            
            // æ ¹æ®ä¸åŒè·¯å¾„ä½¿ç”¨ä¸åŒç­–ç•¥
            if (path.startsWith("/api/user")) {
                // ç”¨æˆ·ç›¸å…³æ¥å£ï¼šåŒ…å«ç”¨æˆ·ID
                return Mono.just(generateUserKey(request));
            } else if (path.startsWith("/api/products")) {
                // å•†å“æ¥å£ï¼šåªç”¨è·¯å¾„å’Œæ’åºå‚æ•°
                return Mono.just(generateProductKey(request));
            } else {
                // é»˜è®¤ç­–ç•¥
                return Mono.just(generateDefaultKey(request));
            }
        };
    }
}
```

---

## 4. â° ç¼“å­˜è¿‡æœŸæœºåˆ¶


### 4.1 è¿‡æœŸæœºåˆ¶çš„å¿…è¦æ€§


**ä¸ºä»€ä¹ˆæ•°æ®è¦è¿‡æœŸ**ï¼š

```
åœºæ™¯ï¼šå•†å“ä»·æ ¼æ›´æ–°
[9:00] å•†å“åŸä»·ï¼š100å…ƒ â†’ ç¼“å­˜
[9:30] è¿è¥è°ƒæ•´ä»·æ ¼ï¼š80å…ƒï¼ˆåç«¯å·²æ›´æ–°ï¼‰
[9:31] ç”¨æˆ·è®¿é—® â†’ ç¼“å­˜è¿”å›ï¼š100å…ƒï¼ˆé”™è¯¯ï¼ï¼‰

å¦‚æœç¼“å­˜ä¸è¿‡æœŸï¼Œç”¨æˆ·æ°¸è¿œçœ‹åˆ°çš„æ˜¯æ—§ä»·æ ¼ï¼
```

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
- ç¼“å­˜ä¸èƒ½æ°¸ä¹…å­˜åœ¨
- éœ€è¦å®šæœŸæ›´æ–°ä»¥ä¿è¯æ•°æ®å‡†ç¡®æ€§
- å¹³è¡¡"æ€§èƒ½"å’Œ"æ•°æ®æ–°é²œåº¦"

### 4.2 TTLè¿‡æœŸç­–ç•¥


**TTLï¼ˆTime To Liveï¼‰ï¼šç”Ÿå­˜æ—¶é—´**

```java
@Component
public class TTLCacheManager {
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    // è®¾ç½®å›ºå®šè¿‡æœŸæ—¶é—´
    public void cacheWithTTL(String key, Object value, long ttl) {
        redisTemplate.opsForValue()
            .set(key, value, ttl, TimeUnit.SECONDS);
    }
    
    // ç¤ºä¾‹ï¼šç¼“å­˜å•†å“ä¿¡æ¯5åˆ†é’Ÿ
    public void cacheProduct(String productId, Product product) {
        String key = "product:" + productId;
        cacheWithTTL(key, product, 300); // 5åˆ†é’Ÿ = 300ç§’
    }
}
```

**ä¸åŒä¸šåŠ¡çš„TTLå»ºè®®**ï¼š

| æ•°æ®ç±»å‹ | TTLæ—¶é•¿ | åŸå›  |
|---------|---------|------|
| **ç³»ç»Ÿé…ç½®** | `24å°æ—¶` | å‡ ä¹ä¸å˜ |
| **å•†å“åˆ†ç±»** | `1å°æ—¶` | å˜åŒ–å¾ˆå°‘ |
| **å•†å“åº“å­˜** | `30ç§’` | å®æ—¶æ€§è¦æ±‚é«˜ |
| **ç”¨æˆ·Token** | `2å°æ—¶` | å®‰å…¨æ€§è€ƒè™‘ |

### 4.3 LRUè¿‡æœŸç­–ç•¥


**LRUï¼ˆLeast Recently Usedï¼‰ï¼šæœ€è¿‘æœ€å°‘ä½¿ç”¨**

```
åŸç†ï¼šåƒæ•´ç†ä¹¦æ¶
- ä¹¦æ¶ç©ºé—´æœ‰é™ï¼ˆç¼“å­˜ç©ºé—´æœ‰é™ï¼‰
- æœ€è¿‘æ²¡çœ‹çš„ä¹¦æ‰”æ‰ï¼ˆæœ€å°‘ä½¿ç”¨çš„ç¼“å­˜åˆ é™¤ï¼‰
- æ–°ä¹¦æ”¾è¿›æ¥ï¼ˆæ–°ç¼“å­˜æ•°æ®è¿›æ¥ï¼‰

ç¤ºä¾‹ï¼š
[ç¬¬1æ­¥] ç¼“å­˜ï¼šA B C D Eï¼ˆå·²æ»¡ï¼‰
[ç¬¬2æ­¥] è®¿é—®ï¼šA Cï¼ˆAå’ŒCå˜ä¸ºæœ€è¿‘ä½¿ç”¨ï¼‰
[ç¬¬3æ­¥] æ–°æ•°æ®Fè¦è¿›æ¥ï¼Œåˆ é™¤æœ€ä¹…æœªç”¨çš„B
[ç»“æœ] ç¼“å­˜ï¼šA C D E F
```

**Redis LRUé…ç½®**ï¼š

```yaml
# Redisé…ç½®æ–‡ä»¶
maxmemory 100mb           # æœ€å¤§å†…å­˜100MB
maxmemory-policy allkeys-lru  # ä½¿ç”¨LRUç­–ç•¥
```

**Javaä»£ç å®ç°**ï¼š

```java
@Configuration
public class RedisConfig {
    
    @Bean
    public RedisCacheConfiguration cacheConfiguration() {
        return RedisCacheConfiguration.defaultCacheConfig()
            // é»˜è®¤è¿‡æœŸæ—¶é—´10åˆ†é’Ÿ
            .entryTtl(Duration.ofMinutes(10))
            // ç¼“å­˜ç©ºå€¼é˜²æ­¢ç©¿é€
            .disableCachingNullValues();
    }
}
```

### 4.4 ä¸»åŠ¨åˆ·æ–°ç­–ç•¥


**åœºæ™¯**ï¼šæ•°æ®æ›´æ–°æ—¶ä¸»åŠ¨æ¸…é™¤ç¼“å­˜

```java
@Service
public class ProductService {
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    // æ›´æ–°å•†å“æ—¶åˆ é™¤ç¼“å­˜
    public void updateProduct(String productId, Product product) {
        // 1. æ›´æ–°æ•°æ®åº“
        productRepository.save(product);
        
        // 2. åˆ é™¤ç›¸å…³ç¼“å­˜
        String cacheKey = "product:" + productId;
        redisTemplate.delete(cacheKey);
        
        // 3. å¯é€‰ï¼šç«‹å³é¢„çƒ­æ–°ç¼“å­˜
        redisTemplate.opsForValue()
            .set(cacheKey, product, 5, TimeUnit.MINUTES);
    }
}
```

---

## 5. ğŸ”„ ç¼“å­˜å¤±æ•ˆç­–ç•¥


### 5.1 ç¼“å­˜å¤±æ•ˆçš„å¸¸è§åœºæ™¯


**ä»€ä¹ˆæ—¶å€™éœ€è¦è®©ç¼“å­˜å¤±æ•ˆ**ï¼š

```
åœºæ™¯1ï¼šæ•°æ®æ›´æ–°
å•†å“ä»·æ ¼ä»100å…ƒæ”¹ä¸º80å…ƒ
â†’ å¿…é¡»ç«‹å³å¤±æ•ˆæ—§ç¼“å­˜

åœºæ™¯2ï¼šç”¨æˆ·æ“ä½œ
ç”¨æˆ·åˆ é™¤äº†è´­ç‰©è½¦å•†å“
â†’ å¿…é¡»æ¸…é™¤è¯¥ç”¨æˆ·çš„è´­ç‰©è½¦ç¼“å­˜

åœºæ™¯3ï¼šç³»ç»Ÿç»´æŠ¤
å‘å¸ƒæ–°ç‰ˆæœ¬ã€ä¿®å¤Bug
â†’ å¯èƒ½éœ€è¦æ¸…ç©ºæ‰€æœ‰ç¼“å­˜
```

### 5.2 å•ä¸ªç¼“å­˜å¤±æ•ˆ


```java
@Service
public class CacheInvalidationService {
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    // åˆ é™¤å•ä¸ªç¼“å­˜
    public void invalidateSingle(String key) {
        redisTemplate.delete(key);
    }
    
    // ç¤ºä¾‹ï¼šå•†å“æ›´æ–°ååˆ é™¤ç¼“å­˜
    public void onProductUpdate(String productId) {
        String key = "product:" + productId;
        invalidateSingle(key);
    }
}
```

### 5.3 æ‰¹é‡å¤±æ•ˆç­–ç•¥


**åœºæ™¯**ï¼šå•†å“åˆ†ç±»ä¸‹æ‰€æœ‰å•†å“éƒ½è¦å¤±æ•ˆ

```java
@Service
public class BatchInvalidationService {
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    // åˆ é™¤æŒ‡å®šå‰ç¼€çš„æ‰€æœ‰ç¼“å­˜
    public void invalidateByPattern(String pattern) {
        // æŸ¥æ‰¾æ‰€æœ‰åŒ¹é…çš„key
        // ä¾‹å¦‚ï¼šproduct:category:1:*
        Set<String> keys = redisTemplate.keys(pattern);
        
        if (keys != null && !keys.isEmpty()) {
            // æ‰¹é‡åˆ é™¤
            redisTemplate.delete(keys);
        }
    }
    
    // ç¤ºä¾‹ï¼šæŸåˆ†ç±»ä¸‹æ‰€æœ‰å•†å“å¤±æ•ˆ
    public void invalidateCategory(String categoryId) {
        String pattern = "product:category:" + categoryId + ":*";
        invalidateByPattern(pattern);
    }
}
```

### 5.4 å»¶è¿ŸåŒåˆ ç­–ç•¥


**è§£å†³å¹¶å‘é—®é¢˜**ï¼š

```
é—®é¢˜åœºæ™¯ï¼š
[æ—¶åˆ»1] çº¿ç¨‹Aè¯»å–æ—§æ•°æ®ï¼ˆprice=100ï¼‰
[æ—¶åˆ»2] çº¿ç¨‹Bæ›´æ–°æ•°æ®ï¼ˆprice=80ï¼‰å¹¶åˆ é™¤ç¼“å­˜
[æ—¶åˆ»3] çº¿ç¨‹AæŠŠæ—§æ•°æ®å†™å…¥ç¼“å­˜ï¼ˆprice=100ï¼Œé”™è¯¯ï¼ï¼‰
[æ—¶åˆ»4] åç»­è¯·æ±‚éƒ½è¯»åˆ°é”™è¯¯çš„ç¼“å­˜

å»¶è¿ŸåŒåˆ æ–¹æ¡ˆï¼š
[æ—¶åˆ»1] åˆ é™¤ç¼“å­˜
[æ—¶åˆ»2] æ›´æ–°æ•°æ®åº“
[æ—¶åˆ»3] å»¶è¿Ÿ500ms
[æ—¶åˆ»4] å†æ¬¡åˆ é™¤ç¼“å­˜
```

**ä»£ç å®ç°**ï¼š

```java
@Service
public class DoubleDeleteService {
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    @Async
    public void delayedDelete(String key, long delayMillis) {
        try {
            // å»¶è¿ŸæŒ‡å®šæ—¶é—´
            Thread.sleep(delayMillis);
            // å†æ¬¡åˆ é™¤
            redisTemplate.delete(key);
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
    }
    
    public void updateWithDoubleDelete(String productId, Product product) {
        String key = "product:" + productId;
        
        // ç¬¬ä¸€æ¬¡åˆ é™¤
        redisTemplate.delete(key);
        
        // æ›´æ–°æ•°æ®åº“
        productRepository.save(product);
        
        // å»¶è¿Ÿç¬¬äºŒæ¬¡åˆ é™¤ï¼ˆ500msåï¼‰
        delayedDelete(key, 500);
    }
}
```

---

## 6. ğŸ›¡ï¸ ç¼“å­˜ç©¿é€é˜²æŠ¤


### 6.1 ä»€ä¹ˆæ˜¯ç¼“å­˜ç©¿é€


**é€šä¿—ç†è§£**ï¼š

```
æ­£å¸¸æƒ…å†µï¼š
å®¢æˆ·ç«¯ â†’ ç½‘å…³ï¼ˆæŸ¥ç¼“å­˜ï¼Œæœ‰æ•°æ®ï¼‰â†’ è¿”å›

ç¼“å­˜ç©¿é€ï¼š
æ¶æ„ç”¨æˆ·æŸ¥è¯¢ä¸å­˜åœ¨çš„æ•°æ®
å®¢æˆ·ç«¯ â†’ ç½‘å…³ï¼ˆæŸ¥ç¼“å­˜ï¼Œæ²¡æœ‰ï¼‰â†’ æ•°æ®åº“ï¼ˆä¹Ÿæ²¡æœ‰ï¼‰â†’ è¿”å›ç©º
æ¯æ¬¡è¯·æ±‚éƒ½æ‰“åˆ°æ•°æ®åº“ï¼

æ”»å‡»ç¤ºä¾‹ï¼š
/api/product?id=999999ï¼ˆä¸å­˜åœ¨ï¼‰
/api/product?id=999998ï¼ˆä¸å­˜åœ¨ï¼‰
/api/product?id=999997ï¼ˆä¸å­˜åœ¨ï¼‰
...
æ•°æ®åº“è¢«å‹å®ï¼
```

### 6.2 å¸ƒéš†è¿‡æ»¤å™¨é˜²æŠ¤


**åŸç†**ï¼šåœ¨æŸ¥ç¼“å­˜å‰å…ˆè¿‡æ»¤

```
å¸ƒéš†è¿‡æ»¤å™¨å·¥ä½œæµç¨‹ï¼š

[å‡†å¤‡é˜¶æ®µ]
æŠŠæ‰€æœ‰å­˜åœ¨çš„å•†å“IDåŠ å…¥å¸ƒéš†è¿‡æ»¤å™¨
ID: 1, 2, 3, 100, 200 â†’ å¸ƒéš†è¿‡æ»¤å™¨

[è¯·æ±‚å¤„ç†]
è¯·æ±‚ID=999999
  â†“
å¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­ï¼šä¸å­˜åœ¨
  â†“
ç›´æ¥è¿”å›ç©ºï¼Œä¸æŸ¥æ•°æ®åº“
```

**ä»£ç å®ç°**ï¼š

```java
@Component
public class BloomFilterCache {
    
    // åˆå§‹åŒ–å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆé¢„è®¡10ä¸‡ä¸ªå…ƒç´ ï¼Œè¯¯åˆ¤ç‡0.01%ï¼‰
    private BloomFilter<String> bloomFilter = 
        BloomFilter.create(
            Funnels.stringFunnel(Charset.defaultCharset()),
            100000,
            0.0001
        );
    
    // ç³»ç»Ÿå¯åŠ¨æ—¶åŠ è½½æ‰€æœ‰å•†å“ID
    @PostConstruct
    public void init() {
        List<String> productIds = productRepository.findAllIds();
        productIds.forEach(bloomFilter::put);
    }
    
    // æ£€æŸ¥æ˜¯å¦å¯èƒ½å­˜åœ¨
    public boolean mightExist(String productId) {
        return bloomFilter.mightContain(productId);
    }
}

@Component
public class CachePenetrationFilter implements GlobalFilter {
    
    @Autowired
    private BloomFilterCache bloomFilterCache;
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, 
                             GatewayFilterChain chain) {
        String productId = getProductId(exchange);
        
        // å¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­
        if (!bloomFilterCache.mightExist(productId)) {
            // è‚¯å®šä¸å­˜åœ¨ï¼Œç›´æ¥è¿”å›
            return writeEmptyResponse(exchange);
        }
        
        // å¯èƒ½å­˜åœ¨ï¼Œç»§ç»­å¤„ç†
        return chain.filter(exchange);
    }
}
```

### 6.3 ç©ºå€¼ç¼“å­˜ç­–ç•¥


**åŸç†**ï¼šå³ä½¿æ•°æ®ä¸å­˜åœ¨ï¼Œä¹Ÿç¼“å­˜è¿™ä¸ª"ç©ºç»“æœ"

```java
@Service
public class NullValueCacheService {
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    public Product getProduct(String productId) {
        String key = "product:" + productId;
        
        // 1. æŸ¥ç¼“å­˜
        Object cached = redisTemplate.opsForValue().get(key);
        
        // ç¼“å­˜ä¸­æœ‰ç‰¹æ®Šçš„ç©ºå€¼æ ‡è®°
        if ("NULL".equals(cached)) {
            return null; // è¿™æ˜¯ä¸å­˜åœ¨çš„æ•°æ®
        }
        
        if (cached != null) {
            return (Product) cached; // æ­£å¸¸ç¼“å­˜æ•°æ®
        }
        
        // 2. æŸ¥æ•°æ®åº“
        Product product = productRepository.findById(productId);
        
        if (product == null) {
            // æ•°æ®ä¸å­˜åœ¨ï¼Œç¼“å­˜ç©ºå€¼ï¼ˆçŸ­æ—¶é—´ï¼Œå¦‚5åˆ†é’Ÿï¼‰
            redisTemplate.opsForValue()
                .set(key, "NULL", 5, TimeUnit.MINUTES);
            return null;
        }
        
        // 3. æ­£å¸¸ç¼“å­˜
        redisTemplate.opsForValue()
            .set(key, product, 30, TimeUnit.MINUTES);
        return product;
    }
}
```

**æ³¨æ„äº‹é¡¹**ï¼š
- ç©ºå€¼ç¼“å­˜æ—¶é—´è¦çŸ­ï¼ˆ5åˆ†é’Ÿï¼‰
- é˜²æ­¢æ–°å¢æ•°æ®åç”¨æˆ·çœ‹åˆ°"ä¸å­˜åœ¨"

---

## 7. â„ï¸ ç¼“å­˜é›ªå´©é˜²æŠ¤


### 7.1 ä»€ä¹ˆæ˜¯ç¼“å­˜é›ªå´©


**é€šä¿—ç†è§£**ï¼š

```
æ­£å¸¸æƒ…å†µï¼š
1000ä¸ªç¼“å­˜ï¼Œé™†ç»­è¿‡æœŸï¼Œå‹åŠ›åˆ†æ•£
[9:00] 100ä¸ªè¿‡æœŸ â†’ æ•°æ®åº“å¤„ç†100ä¸ªè¯·æ±‚
[9:05] 100ä¸ªè¿‡æœŸ â†’ æ•°æ®åº“å¤„ç†100ä¸ªè¯·æ±‚
...

ç¼“å­˜é›ªå´©ï¼š
1000ä¸ªç¼“å­˜åŒæ—¶è¿‡æœŸï¼
[9:00] 1000ä¸ªåŒæ—¶è¿‡æœŸ â†’ æ•°æ®åº“ç¬é—´æ‰¿å—1000ä¸ªè¯·æ±‚
         â†“
      æ•°æ®åº“å´©æºƒï¼
```

**çœŸå®åœºæ™¯**ï¼š
```
ç”µå•†å¤§ä¿ƒæ´»åŠ¨ï¼š
[0ç‚¹] æ´»åŠ¨å¼€å§‹ï¼Œå¤§é‡ç”¨æˆ·è®¿é—®
[0ç‚¹] ç¼“å­˜é¢„çƒ­ï¼Œ1000ä¸ªå•†å“ç¼“å­˜éƒ½è®¾ç½®5åˆ†é’Ÿ
[0:05] 1000ä¸ªç¼“å­˜åŒæ—¶å¤±æ•ˆ
[0:05] æ‰€æœ‰è¯·æ±‚æ‰“åˆ°æ•°æ®åº“
      â†’ æ•°æ®åº“å´©æºƒï¼Œç½‘ç«™ç˜«ç—ª
```

### 7.2 è¿‡æœŸæ—¶é—´éšæœºåŒ–


**è§£å†³æ–¹æ¡ˆ**ï¼šè®©ç¼“å­˜åœ¨ä¸åŒæ—¶é—´è¿‡æœŸ

```java
@Service
public class AntiAvalancheService {
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    private Random random = new Random();
    
    public void cacheWithRandomExpire(String key, Object value, 
                                      long baseSeconds) {
        // åŸºç¡€æ—¶é—´ + éšæœºæ—¶é—´ï¼ˆ0-30%ï¼‰
        long randomSeconds = (long) (baseSeconds * random.nextDouble() * 0.3);
        long finalTTL = baseSeconds + randomSeconds;
        
        redisTemplate.opsForValue()
            .set(key, value, finalTTL, TimeUnit.SECONDS);
    }
    
    // ç¤ºä¾‹ï¼šç¼“å­˜å•†å“
    public void cacheProduct(String productId, Product product) {
        String key = "product:" + productId;
        // åŸºç¡€5åˆ†é’Ÿ + éšæœº0-90ç§’
        cacheWithRandomExpire(key, product, 300);
        // å®é™…è¿‡æœŸæ—¶é—´ï¼š5åˆ†é’Ÿåˆ°6åˆ†åŠä¹‹é—´
    }
}
```

**æ•ˆæœå¯¹æ¯”**ï¼š

```
å›ºå®šè¿‡æœŸæ—¶é—´ï¼š
[0:05:00] 1000ä¸ªç¼“å­˜åŒæ—¶è¿‡æœŸ âš ï¸

éšæœºè¿‡æœŸæ—¶é—´ï¼š
[0:05:00] 100ä¸ªè¿‡æœŸ
[0:05:15] 150ä¸ªè¿‡æœŸ
[0:05:30] 120ä¸ªè¿‡æœŸ
...
å‹åŠ›å¹³æ»‘åˆ†æ•£ âœ…
```

### 7.3 çƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸ


**ç­–ç•¥**ï¼šæ ¸å¿ƒæ•°æ®é€»è¾‘ä¸Šä¸è¿‡æœŸ

```java
@Service
public class HotDataCacheService {
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    // ç¼“å­˜çƒ­ç‚¹æ•°æ®
    public void cacheHotData(String key, Object value) {
        HotDataWrapper wrapper = new HotDataWrapper();
        wrapper.setData(value);
        wrapper.setExpireTime(System.currentTimeMillis() + 300000); // 5åˆ†é’Ÿ
        
        // Redisä¸­ä¸è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆæ°¸ä¸è¿‡æœŸï¼‰
        redisTemplate.opsForValue().set(key, wrapper);
    }
    
    // è·å–æ•°æ®
    public Object getHotData(String key) {
        HotDataWrapper wrapper = 
            (HotDataWrapper) redisTemplate.opsForValue().get(key);
        
        if (wrapper == null) {
            return null;
        }
        
        // æ£€æŸ¥é€»è¾‘è¿‡æœŸæ—¶é—´
        if (wrapper.getExpireTime() < System.currentTimeMillis()) {
            // é€»è¾‘ä¸Šå·²è¿‡æœŸï¼Œå¼‚æ­¥æ›´æ–°
            asyncRefreshCache(key);
            // ä»è¿”å›æ—§æ•°æ®ï¼ˆä¿è¯å¯ç”¨æ€§ï¼‰
            return wrapper.getData();
        }
        
        return wrapper.getData();
    }
    
    @Async
    public void asyncRefreshCache(String key) {
        // å¼‚æ­¥ä»æ•°æ®åº“åŠ è½½æ–°æ•°æ®
        Object newData = loadFromDatabase(key);
        cacheHotData(key, newData);
    }
}

// åŒ…è£…ç±»
class HotDataWrapper {
    private Object data;        // çœŸå®æ•°æ®
    private Long expireTime;    // é€»è¾‘è¿‡æœŸæ—¶é—´
    // getter/setter...
}
```

### 7.4 å¤šçº§ç¼“å­˜æ¶æ„


**æ¶æ„è®¾è®¡**ï¼š

```
ä¸‰çº§ç¼“å­˜æ¶æ„ï¼š

å®¢æˆ·ç«¯è¯·æ±‚
    â†“
[L1: æœ¬åœ°ç¼“å­˜] JVMå†…å­˜ï¼Œè¶…å¿«ï¼ˆ1msï¼‰
    â†“ æœªå‘½ä¸­
[L2: Redisç¼“å­˜] ç½‘ç»œç¼“å­˜ï¼Œå¿«ï¼ˆ5msï¼‰
    â†“ æœªå‘½ä¸­
[L3: æ•°æ®åº“] æŒä¹…åŒ–å­˜å‚¨ï¼Œæ…¢ï¼ˆ100msï¼‰
    â†“
è¿”å›æ•°æ®å¹¶é€å±‚å›å¡«ç¼“å­˜
```

**ä»£ç å®ç°**ï¼š

```java
@Service
public class MultiLevelCacheService {
    
    // L1ï¼šæœ¬åœ°ç¼“å­˜ï¼ˆCaffeineï¼‰
    private Cache<String, Object> localCache = Caffeine.newBuilder()
        .maximumSize(1000)
        .expireAfterWrite(1, TimeUnit.MINUTES)
        .build();
    
    // L2ï¼šRedisç¼“å­˜
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    public Object getData(String key) {
        // 1. æŸ¥L1æœ¬åœ°ç¼“å­˜
        Object data = localCache.getIfPresent(key);
        if (data != null) {
            return data;
        }
        
        // 2. æŸ¥L2 Redisç¼“å­˜
        data = redisTemplate.opsForValue().get(key);
        if (data != null) {
            // å›å¡«L1
            localCache.put(key, data);
            return data;
        }
        
        // 3. æŸ¥æ•°æ®åº“
        data = loadFromDatabase(key);
        if (data != null) {
            // å›å¡«L2ï¼ˆ5åˆ†é’Ÿï¼‰
            redisTemplate.opsForValue()
                .set(key, data, 5, TimeUnit.MINUTES);
            // å›å¡«L1ï¼ˆ1åˆ†é’Ÿï¼‰
            localCache.put(key, data);
        }
        
        return data;
    }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ç¼“å­˜ä½œç”¨ï¼šæå‡æ€§èƒ½ã€é™ä½è´Ÿè½½ã€èŠ‚çœæˆæœ¬
ğŸ”¸ å·¥ä½œæµç¨‹ï¼šæ£€æŸ¥ç¼“å­˜ â†’ å‘½ä¸­è¿”å› / æœªå‘½ä¸­æŸ¥åº“
ğŸ”¸ ç¼“å­˜é”®ï¼šå”¯ä¸€æ ‡è¯†ç¼“å­˜æ•°æ®ï¼Œéœ€è€ƒè™‘å‚æ•°æ’åºã€ç”¨æˆ·ä¿¡æ¯
ğŸ”¸ è¿‡æœŸæœºåˆ¶ï¼šTTLå›ºå®šæ—¶é—´ã€LRUæ·˜æ±°ç­–ç•¥ã€ä¸»åŠ¨åˆ·æ–°
ğŸ”¸ å¤±æ•ˆç­–ç•¥ï¼šå•ä¸ªå¤±æ•ˆã€æ‰¹é‡å¤±æ•ˆã€å»¶è¿ŸåŒåˆ 
ğŸ”¸ ç©¿é€é˜²æŠ¤ï¼šå¸ƒéš†è¿‡æ»¤å™¨ã€ç©ºå€¼ç¼“å­˜
ğŸ”¸ é›ªå´©é˜²æŠ¤ï¼šéšæœºè¿‡æœŸã€çƒ­ç‚¹æ°¸ä¸è¿‡æœŸã€å¤šçº§ç¼“å­˜
```

### 8.2 å®é™…åº”ç”¨å†³ç­–æŒ‡å—


**ç¼“å­˜æ—¶é•¿é€‰æ‹©**ï¼š
```
âœ… ç³»ç»Ÿé…ç½®ã€åˆ†ç±»ä¿¡æ¯ â†’ 1å°æ—¶ä»¥ä¸Š
âœ… å•†å“åˆ—è¡¨ã€æ¨èæ•°æ® â†’ 5-10åˆ†é’Ÿ
âœ… åº“å­˜ã€ä»·æ ¼ä¿¡æ¯ â†’ 30ç§’-1åˆ†é’Ÿ
âŒ è®¢å•ã€æ”¯ä»˜ä¿¡æ¯ â†’ ä¸ç¼“å­˜
```

**ç¼“å­˜é”®ç­–ç•¥é€‰æ‹©**ï¼š
```
âœ… å…¬å…±æ•°æ®ï¼ˆå•†å“åˆ†ç±»ï¼‰â†’ ç®€å•è·¯å¾„é”®
âœ… ç”¨æˆ·æ•°æ®ï¼ˆè´­ç‰©è½¦ï¼‰â†’ åŒ…å«ç”¨æˆ·ID
âœ… å¤æ‚æŸ¥è¯¢ â†’ å‚æ•°æ’åºåç»„åˆ
```

**é˜²æŠ¤ç­–ç•¥é€‰æ‹©**ï¼š
```
é˜²ç©¿é€ï¼š
â†’ æŸ¥è¯¢é‡å¤§ï¼šå¸ƒéš†è¿‡æ»¤å™¨ï¼ˆå†…å­˜å ç”¨å°ï¼‰
â†’ ç®€å•åœºæ™¯ï¼šç©ºå€¼ç¼“å­˜ï¼ˆå®ç°ç®€å•ï¼‰

é˜²é›ªå´©ï¼š
â†’ å¿…å¤‡ï¼šè¿‡æœŸæ—¶é—´éšæœºåŒ–
â†’ çƒ­ç‚¹æ•°æ®ï¼šæ°¸ä¸è¿‡æœŸ + å¼‚æ­¥åˆ·æ–°
â†’ é«˜å¯ç”¨ï¼šå¤šçº§ç¼“å­˜æ¶æ„
```

### 8.3 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


**Q1ï¼šç¼“å­˜å’Œæ•°æ®åº“æ•°æ®ä¸ä¸€è‡´æ€ä¹ˆåŠï¼Ÿ**
```
æ–¹æ¡ˆï¼šå»¶è¿ŸåŒåˆ 
1. æ›´æ–°å‰åˆ é™¤ç¼“å­˜
2. æ›´æ–°æ•°æ®åº“
3. å»¶è¿Ÿ500mså†åˆ é™¤ä¸€æ¬¡ç¼“å­˜
```

**Q2ï¼šç¼“å­˜å ç”¨å†…å­˜å¤ªå¤§æ€ä¹ˆåŠï¼Ÿ**
```
æ–¹æ¡ˆ1ï¼šä½¿ç”¨LRUç­–ç•¥è‡ªåŠ¨æ·˜æ±°
æ–¹æ¡ˆ2ï¼šè®¾ç½®Redisæœ€å¤§å†…å­˜é™åˆ¶
æ–¹æ¡ˆ3ï¼šåªç¼“å­˜çƒ­ç‚¹æ•°æ®
```

**Q3ï¼šå¦‚ä½•çŸ¥é“ç¼“å­˜æ˜¯å¦æœ‰æ•ˆï¼Ÿ**
```
ç›‘æ§æŒ‡æ ‡ï¼š
- ç¼“å­˜å‘½ä¸­ç‡ï¼šå‘½ä¸­æ¬¡æ•° / æ€»è¯·æ±‚æ•°
- ç›®æ ‡ï¼š>80% ä¸ºè‰¯å¥½
- <50% éœ€è¦ä¼˜åŒ–ç¼“å­˜ç­–ç•¥
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- ç¼“å­˜æé€Ÿåº¦ï¼Œè¿‡æœŸä¿æ–°é²œ
- ç©¿é€ç”¨è¿‡æ»¤ï¼Œé›ªå´©è¦åˆ†æ•£
- é”®è¦è®¾è®¡å¥½ï¼Œå¤±æ•ˆè¦åŠæ—¶
- å¤šçº§æ›´å¯é ï¼Œç›‘æ§ä¸èƒ½å°‘