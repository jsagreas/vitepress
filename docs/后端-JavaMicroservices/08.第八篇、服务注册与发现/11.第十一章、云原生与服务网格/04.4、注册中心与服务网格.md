---
title: 4ã€æ³¨å†Œä¸­å¿ƒä¸æœåŠ¡ç½‘æ ¼
---
## ğŸ“š ç›®å½•

1. [æœåŠ¡ç½‘æ ¼åŸºç¡€æ¦‚å¿µ](#1-æœåŠ¡ç½‘æ ¼åŸºç¡€æ¦‚å¿µ)
2. [IstioæœåŠ¡ç½‘æ ¼](#2-IstioæœåŠ¡ç½‘æ ¼)
3. [Consul Connect](#3-Consul-Connect)
4. [LinkerdæœåŠ¡ç½‘æ ¼](#4-LinkerdæœåŠ¡ç½‘æ ¼)
5. [Envoyä»£ç†é›†æˆ](#5-Envoyä»£ç†é›†æˆ)
6. [Sidecaræ¨¡å¼è¯¦è§£](#6-Sidecaræ¨¡å¼è¯¦è§£)
7. [æ§åˆ¶å¹³é¢ä¸æ•°æ®å¹³é¢](#7-æ§åˆ¶å¹³é¢ä¸æ•°æ®å¹³é¢)
8. [å»æ³¨å†Œä¸­å¿ƒåŒ–è¶‹åŠ¿](#8-å»æ³¨å†Œä¸­å¿ƒåŒ–è¶‹åŠ¿)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ æœåŠ¡ç½‘æ ¼åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯æœåŠ¡ç½‘æ ¼


**ğŸ”¸ é€šä¿—ç†è§£**
æƒ³è±¡ä¸€ä¸‹ï¼Œä½ çš„å¾®æœåŠ¡å°±åƒåŸå¸‚é‡Œçš„å„ä¸ªå•†åº—ï¼Œä»¥å‰æ¯ä¸ªå•†åº—éƒ½è¦è‡ªå·±ç®¡ç†é…é€ã€å®‰å…¨æ£€æŸ¥ã€æµé‡ç»Ÿè®¡ç­‰å·¥ä½œã€‚æœåŠ¡ç½‘æ ¼å°±åƒæ˜¯ç»Ÿä¸€çš„å¿«é€’å’Œç‰©æµå…¬å¸ï¼Œå¸®ä½ å¤„ç†è¿™äº›é€šç”¨çš„äº‹æƒ…ï¼Œè®©å•†åº—åªä¸“æ³¨åšç”Ÿæ„æœ¬èº«ã€‚

```
ä¼ ç»Ÿå¾®æœåŠ¡è°ƒç”¨ï¼š
æœåŠ¡A ----ç›´æ¥è°ƒç”¨----> æœåŠ¡B
(è‡ªå·±å¤„ç†é‡è¯•ã€è¶…æ—¶ã€è´Ÿè½½å‡è¡¡ç­‰)

æœåŠ¡ç½‘æ ¼è°ƒç”¨ï¼š
æœåŠ¡A --> [ä»£ç†A] ===ç½‘æ ¼å±‚=== [ä»£ç†B] --> æœåŠ¡B
           (ç»Ÿä¸€å¤„ç†æ‰€æœ‰é€šä¿¡é€»è¾‘)
```

**ğŸ’¡ æ ¸å¿ƒå®šä¹‰**
- **æœåŠ¡ç½‘æ ¼**ï¼šä¸“é—¨å¤„ç†æœåŠ¡é—´é€šä¿¡çš„åŸºç¡€è®¾æ–½å±‚
- **èŒè´£**ï¼šæµé‡ç®¡ç†ã€å®‰å…¨ã€å¯è§‚æµ‹æ€§
- **ç‰¹ç‚¹**ï¼šå¯¹ä¸šåŠ¡ä»£ç æ— ä¾µå…¥ï¼Œé€æ˜åŒ–ç®¡ç†

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡ç½‘æ ¼


**ä¼ ç»Ÿæ³¨å†Œä¸­å¿ƒçš„å±€é™**

| é—®é¢˜ | **ä¼ ç»Ÿæ–¹å¼** | **æœåŠ¡ç½‘æ ¼æ–¹å¼** |
|------|------------|----------------|
| ğŸ“ **ä»£ç ä¾µå…¥** | `éœ€è¦å¼•å…¥SDKï¼Œä¿®æ”¹ä»£ç ` | `æ— éœ€ä¿®æ”¹ä¸šåŠ¡ä»£ç ` |
| ğŸ”§ **åŠŸèƒ½å‡çº§** | `æ¯ä¸ªæœåŠ¡éƒ½è¦é‡æ–°å‘å¸ƒ` | `ç»Ÿä¸€é…ç½®ï¼Œå³åˆ»ç”Ÿæ•ˆ` |
| ğŸŒ **å¤šè¯­è¨€æ”¯æŒ** | `æ¯ç§è¯­è¨€è¦å•ç‹¬å®ç°` | `ç»Ÿä¸€ä»£ç†ï¼Œè¯­è¨€æ— å…³` |
| ğŸ“Š **æµé‡æ§åˆ¶** | `ä»£ç å±‚é¢å®ç°ï¼Œå¤æ‚` | `é…ç½®é©±åŠ¨ï¼Œçµæ´»ç®€å•` |
| ğŸ” **å®‰å…¨é€šä¿¡** | `å„æœåŠ¡è‡ªå·±å¤„ç†` | `ç½‘æ ¼ç»Ÿä¸€ç®¡ç†åŠ å¯†` |

**ğŸ¯ æœåŠ¡ç½‘æ ¼è§£å†³çš„ç—›ç‚¹**
- âœ… **ä¸šåŠ¡è§£è€¦**ï¼šä¸šåŠ¡ä»£ç ä¸ç”¨å…³å¿ƒæœåŠ¡é—´é€šä¿¡ç»†èŠ‚
- âœ… **ç»Ÿä¸€ç®¡ç†**ï¼šæµé‡ç­–ç•¥ã€å®‰å…¨ç­–ç•¥é›†ä¸­é…ç½®
- âœ… **è¯­è¨€æ— å…³**ï¼šJavaã€Goã€PythonæœåŠ¡éƒ½èƒ½æ¥å…¥
- âœ… **åŠŸèƒ½ä¸°å¯Œ**ï¼šæä¾›æ›´å¼ºå¤§çš„æµé‡æ²»ç†èƒ½åŠ›

### 1.3 æœåŠ¡ç½‘æ ¼æ¶æ„å…¨æ™¯


```
åº”ç”¨å±‚(ä¸šåŠ¡æœåŠ¡)
    â†“
æ•°æ®å¹³é¢(Sidecarä»£ç†)
    â†“
æ§åˆ¶å¹³é¢(ç®¡ç†é…ç½®)
    â†“
åŸºç¡€è®¾æ–½(K8s/VM)

å…·ä½“æ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            æ§åˆ¶å¹³é¢ (Control Plane)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ é…ç½®ç®¡ç†  â”‚  â”‚ è¯ä¹¦ç®¡ç†  â”‚  â”‚ é¥æµ‹æ”¶é›†  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“ (ä¸‹å‘é…ç½®)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            æ•°æ®å¹³é¢ (Data Plane)           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ æœåŠ¡A     â”‚        â”‚ æœåŠ¡B     â”‚        â”‚
â”‚  â”‚ [Sidecar]â”‚<======>â”‚ [Sidecar]â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. âš™ï¸ IstioæœåŠ¡ç½‘æ ¼


### 2.1 Istioæ˜¯ä»€ä¹ˆ


**ğŸ”¸ ç®€å•ç†è§£**
Istioå°±åƒæ˜¯ç»™ä½ çš„å¾®æœåŠ¡é›†ç¾¤è¯·äº†ä¸€ä¸ªè¶…çº§ç®¡å®¶ï¼Œå®ƒè´Ÿè´£ï¼š
- ğŸ“‹ **æµé‡æŒ‡æŒ¥**ï¼šå‘Šè¯‰è¯·æ±‚è¯¥å»å“ªé‡Œ
- ğŸ” **å®‰å…¨å®ˆå«**ï¼šä¿æŠ¤æœåŠ¡é—´é€šä¿¡å®‰å…¨
- ğŸ“Š **æ•°æ®ç»Ÿè®¡**ï¼šè®°å½•æ‰€æœ‰æœåŠ¡è°ƒç”¨æƒ…å†µ

**æ ¸å¿ƒç»„ä»¶**
```
Istioæ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pilot (æµé‡ç®¡ç†)                      â”‚
â”‚  - æœåŠ¡å‘ç°                            â”‚
â”‚  - æµé‡è·¯ç”±è§„åˆ™                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Citadel (å®‰å…¨è®¤è¯)                    â”‚
â”‚  - è¯ä¹¦ç®¡ç†                            â”‚
â”‚  - èº«ä»½è®¤è¯                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Galley (é…ç½®ç®¡ç†)                     â”‚
â”‚  - é…ç½®éªŒè¯                            â”‚
â”‚  - é…ç½®åˆ†å‘                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ (æ§åˆ¶)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Envoy Sidecar (æ¯ä¸ªæœåŠ¡æ—è¾¹)          â”‚
â”‚  - æ‹¦æˆªæ‰€æœ‰æµé‡                        â”‚
â”‚  - æ‰§è¡Œæ§åˆ¶å¹³é¢ç­–ç•¥                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Istioä¸æ³¨å†Œä¸­å¿ƒé›†æˆ


**ğŸ”¸ é›†æˆæ¨¡å¼**

Istioå¯ä»¥å¯¹æ¥ç°æœ‰çš„æ³¨å†Œä¸­å¿ƒï¼š

```java
// 1. Istioå¯¹æ¥Nacosç¤ºä¾‹
apiVersion: networking.istio.io/v1alpha3
kind: ServiceEntry
metadata:
  name: nacos-services
spec:
  hosts:
  - "*.nacos.svc.cluster.local"
  location: MESH_INTERNAL
  resolution: DNS
  endpoints:
  - address: nacos-server.default.svc.cluster.local
    ports:
      http: 8848
```

**é›†æˆæµç¨‹**
```
æ­¥éª¤è¯´æ˜ï¼š

1ï¸âƒ£ æœåŠ¡å¯åŠ¨æ³¨å†Œåˆ°Nacos
   â””â”€> UserServiceå‘Nacosæ³¨å†Œ

2ï¸âƒ£ IstioåŒæ­¥æœåŠ¡ä¿¡æ¯
   â””â”€> Pilotä»Nacosè·å–æœåŠ¡åˆ—è¡¨

3ï¸âƒ£ ç”ŸæˆEnvoyé…ç½®
   â””â”€> Pilotç”Ÿæˆè·¯ç”±è§„åˆ™æ¨é€ç»™Sidecar

4ï¸âƒ£ æµé‡æŒ‰è§„åˆ™è½¬å‘
   â””â”€> Sidecaræ ¹æ®é…ç½®è½¬å‘è¯·æ±‚
```

### 2.3 Istioæµé‡ç®¡ç†


**ğŸ¯ è™šæ‹ŸæœåŠ¡ï¼ˆVirtualServiceï¼‰**

è¿™æ˜¯Istioçš„"äº¤é€šæŒ‡æŒ¥å®˜"ï¼Œå‘Šè¯‰æµé‡è¯¥èµ°å“ªæ¡è·¯ã€‚

```yaml
# æŒ‰ç‰ˆæœ¬åˆ†æµç¤ºä¾‹
apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: user-service-route
spec:
  hosts:
  - user-service
  http:
  - match:
    - headers:
        version:
          exact: v2
    route:
    - destination:
        host: user-service
        subset: v2
  - route:
    - destination:
        host: user-service
        subset: v1
      weight: 90
    - destination:
        host: user-service
        subset: v2
      weight: 10
```

**ğŸ”¸ é€šä¿—è§£é‡Š**
- **è™šæ‹ŸæœåŠ¡**ï¼šå®šä¹‰"æµé‡æ€ä¹ˆèµ°"çš„è§„åˆ™
- **ç›®æ ‡è§„åˆ™**ï¼šå®šä¹‰"æµé‡å¯ä»¥å»å“ªäº›åœ°æ–¹"
- **ç½‘å…³**ï¼šå®šä¹‰"å¤–éƒ¨æµé‡å¦‚ä½•è¿›æ¥"

---

## 3. ğŸ”— Consul Connect


### 3.1 Consul Connectæ ¸å¿ƒæ¦‚å¿µ


**ğŸ”¸ ä»€ä¹ˆæ˜¯Consul Connect**

Consul Connectæ˜¯Consulå†…ç½®çš„æœåŠ¡ç½‘æ ¼åŠŸèƒ½ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ï¼š
- ğŸ¯ **åŸç”Ÿé›†æˆ**ï¼šä¸éœ€è¦é¢å¤–å®‰è£…ç»„ä»¶
- ğŸ” **å®‰å…¨ä¸ºå…ˆ**ï¼šé»˜è®¤mTLSåŠ å¯†é€šä¿¡
- ğŸ“¦ **ç®€å•æ˜“ç”¨**ï¼šé…ç½®ç®€å•ï¼Œä¸Šæ‰‹å¿«

**ä¸Istioçš„åŒºåˆ«**
```
Consul Connectï¼š
- è½»é‡çº§ï¼Œé€‚åˆä¸­å°è§„æ¨¡
- ä¸Consulæ³¨å†Œä¸­å¿ƒæ·±åº¦é›†æˆ
- é…ç½®ç›¸å¯¹ç®€å•

Istioï¼š
- åŠŸèƒ½å¼ºå¤§ï¼Œé€‚åˆå¤§è§„æ¨¡
- ç‹¬ç«‹äºæ³¨å†Œä¸­å¿ƒ
- é…ç½®å¤æ‚ä½†çµæ´»
```

### 3.2 Consul Connectå·¥ä½œåŸç†


```
é€šä¿¡æµç¨‹ï¼š

å®¢æˆ·ç«¯åº”ç”¨
    â†“
Connect Proxy (æœ¬åœ°ä»£ç†)
    â†“ mTLSåŠ å¯†
ç½‘ç»œä¼ è¾“
    â†“ mTLSè§£å¯†
Connect Proxy (æœåŠ¡ç«¯ä»£ç†)
    â†“
ç›®æ ‡æœåŠ¡
```

**ğŸ”¸ é…ç½®ç¤ºä¾‹**

```hcl
# å¯ç”¨Connectçš„æœåŠ¡å®šä¹‰
service {
  name = "user-service"
  port = 8080
  
  connect {
    sidecar_service {
      proxy {
        upstreams = [
          {
            destination_name = "order-service"
            local_bind_port  = 9090
          }
        ]
      }
    }
  }
}
```

**é€šä¿—è§£é‡Š**ï¼š
- `user-service`æ˜¯ä½ çš„ä¸šåŠ¡æœåŠ¡
- `sidecar_service`æ˜¯æ—è¾¹çš„ä»£ç†
- `upstreams`å®šä¹‰"æˆ‘è¦è°ƒç”¨è°"
- è°ƒç”¨`localhost:9090`ä¼šè‡ªåŠ¨è½¬åˆ°`order-service`

### 3.3 Consul Connectå®æˆ˜


**Javaåº”ç”¨é›†æˆç¤ºä¾‹**

```java
@Service
public class UserService {
    
    // ä¸ç”¨å…³å¿ƒæœåŠ¡å‘ç°ï¼Œç›´æ¥è°ƒç”¨æœ¬åœ°ç«¯å£
    @Value("${order.service.url:http://localhost:9090}")
    private String orderServiceUrl;
    
    public Order getOrder(Long orderId) {
        // Connectä»£ç†è‡ªåŠ¨è½¬å‘åˆ°order-service
        return restTemplate.getForObject(
            orderServiceUrl + "/orders/" + orderId, 
            Order.class
        );
    }
}
```

**ğŸ”¸ å…³é”®ä¼˜åŠ¿**
- âœ… ä»£ç æ— éœ€æ”¹åŠ¨ï¼Œåªéœ€é…ç½®
- âœ… è‡ªåŠ¨mTLSåŠ å¯†ï¼Œå®‰å…¨æœ‰ä¿éšœ
- âœ… æœåŠ¡é—´è°ƒç”¨å˜æˆ"æœ¬åœ°è°ƒç”¨"çš„æ„Ÿè§‰

---

## 4. ğŸš€ LinkerdæœåŠ¡ç½‘æ ¼


### 4.1 Linkerdç‰¹ç‚¹


**ğŸ”¸ ä»€ä¹ˆæ˜¯Linkerd**

Linkerdæ˜¯æœ€è½»é‡çº§çš„æœåŠ¡ç½‘æ ¼ï¼Œå®ƒçš„å£å·æ˜¯"ç®€å•ã€å®‰å…¨ã€å¿«é€Ÿ"ã€‚

**æ ¸å¿ƒç‰¹è‰²**
```
Linkerdè®¾è®¡å“²å­¦ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æç®€è®¾è®¡            â”‚
â”‚  - å®‰è£…ç®€å•          â”‚
â”‚  - é…ç½®ç®€æ´          â”‚
â”‚  - èµ„æºå ç”¨å°‘        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å®‰å…¨ç¬¬ä¸€            â”‚
â”‚  - é»˜è®¤mTLS          â”‚
â”‚  - é›¶ä¿¡ä»»æ¶æ„        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ€§èƒ½ä¼˜å¼‚            â”‚
â”‚  - Rustå®ç°          â”‚
â”‚  - ä½å»¶è¿Ÿ            â”‚
â”‚  - å°å†…å­˜å ç”¨        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Linkerd vs Istioå¯¹æ¯”


| ç‰¹æ€§ | **Linkerd** | **Istio** |
|------|-----------|----------|
| ğŸ¯ **å¤æ‚åº¦** | `ç®€å•ï¼Œå¿«é€Ÿä¸Šæ‰‹` | `åŠŸèƒ½å¼ºå¤§ï¼Œå­¦ä¹ æ›²çº¿é™¡` |
| ğŸ’¾ **èµ„æºå ç”¨** | `æä½ï¼Œçº¦10-20MB/Pod` | `è¾ƒé«˜ï¼Œçº¦50-100MB/Pod` |
| âš¡ **æ€§èƒ½** | `å»¶è¿Ÿæä½(å¾®ç§’çº§)` | `å»¶è¿Ÿç¨é«˜(æ¯«ç§’çº§)` |
| ğŸ”§ **åŠŸèƒ½** | `æ ¸å¿ƒåŠŸèƒ½é½å…¨` | `åŠŸèƒ½éå¸¸ä¸°å¯Œ` |
| ğŸ“Š **å¯è§‚æµ‹æ€§** | `å†…ç½®å®Œå–„` | `éœ€é…åˆå…¶ä»–å·¥å…·` |

### 4.3 Linkerdå®æˆ˜


**è‡ªåŠ¨æ³¨å…¥Sidecar**

```bash
# ä¸ºå‘½åç©ºé—´å¯ç”¨è‡ªåŠ¨æ³¨å…¥
kubectl annotate namespace default linkerd.io/inject=enabled

# éƒ¨ç½²åº”ç”¨ï¼Œè‡ªåŠ¨æ³¨å…¥ä»£ç†
kubectl apply -f user-service.yaml
```

**æµé‡åˆ†å‰²ç¤ºä¾‹**

```yaml
# é‡‘ä¸é›€å‘å¸ƒé…ç½®
apiVersion: split.smi-spec.io/v1alpha1
kind: TrafficSplit
metadata:
  name: user-service-split
spec:
  service: user-service
  backends:
  - service: user-service-v1
    weight: 900  # 90%æµé‡
  - service: user-service-v2
    weight: 100  # 10%æµé‡
```

---

## 5. ğŸ”Œ Envoyä»£ç†é›†æˆ


### 5.1 Envoyæ˜¯ä»€ä¹ˆ


**ğŸ”¸ é€šä¿—ç†è§£**

Envoyå°±åƒæ˜¯ä¸€ä¸ªè¶…çº§æ™ºèƒ½çš„"é—¨å«"ï¼Œç«™åœ¨æ¯ä¸ªæœåŠ¡é—¨å£ï¼š
- ğŸ“¬ **æ¥æ”¶è¯·æ±‚**ï¼šæ‰€æœ‰è¿›å‡ºæœåŠ¡çš„æµé‡éƒ½ç»è¿‡å®ƒ
- ğŸ” **æ£€æŸ¥å¤„ç†**ï¼šæŒ‰è§„åˆ™å¤„ç†ï¼ˆé‡è¯•ã€è¶…æ—¶ã€è´Ÿè½½å‡è¡¡ç­‰ï¼‰
- ğŸ“Š **è®°å½•æŠ¥å‘Š**ï¼šç»Ÿè®¡æµé‡ä¿¡æ¯ä¸ŠæŠ¥

```
è¯·æ±‚æµç¨‹ï¼š
å¤–éƒ¨è¯·æ±‚
   â†“
Envoyä»£ç†
   â”œâ”€> è´Ÿè½½å‡è¡¡é€‰æ‹©å®ä¾‹
   â”œâ”€> ç†”æ–­æ£€æŸ¥
   â”œâ”€> é‡è¯•é€»è¾‘
   â”œâ”€> è¶…æ—¶æ§åˆ¶
   â†“
åç«¯æœåŠ¡
```

### 5.2 Envoyæ ¸å¿ƒåŠŸèƒ½


**ğŸ¯ ä¸»è¦èƒ½åŠ›**

```yaml
# Envoyé…ç½®ç¤ºä¾‹
static_resources:
  listeners:
  - name: listener_0
    address:
      socket_address:
        address: 0.0.0.0
        port_value: 10000
    filter_chains:
    - filters:
      - name: envoy.filters.network.http_connection_manager
        typed_config:
          "@type": type.googleapis.com/envoy.extensions.filters.network.http_connection_manager.v3.HttpConnectionManager
          stat_prefix: ingress_http
          route_config:
            name: local_route
            virtual_hosts:
            - name: backend
              domains: ["*"]
              routes:
              - match:
                  prefix: "/"
                route:
                  cluster: user_service
          http_filters:
          - name: envoy.filters.http.router
  clusters:
  - name: user_service
    connect_timeout: 0.25s
    type: STRICT_DNS
    lb_policy: ROUND_ROBIN
    load_assignment:
      cluster_name: user_service
      endpoints:
      - lb_endpoints:
        - endpoint:
            address:
              socket_address:
                address: user-service
                port_value: 8080
```

**ğŸ”¸ é…ç½®è¦ç‚¹è¯´æ˜**
- `listeners`ï¼šç›‘å¬å“ªä¸ªç«¯å£æ¥æ”¶æµé‡
- `routes`ï¼šæµé‡åŒ¹é…å’Œè½¬å‘è§„åˆ™
- `clusters`ï¼šåç«¯æœåŠ¡é›†ç¾¤å®šä¹‰
- `lb_policy`ï¼šè´Ÿè½½å‡è¡¡ç­–ç•¥

### 5.3 Envoyä¸æ³¨å†Œä¸­å¿ƒé›†æˆ


**åŠ¨æ€æœåŠ¡å‘ç°**

```java
// xDS APIé›†æˆç¤ºä¾‹
public class EnvoyNacosIntegration {
    
    // Envoyé€šè¿‡xDS APIåŠ¨æ€è·å–æœåŠ¡åˆ—è¡¨
    public void syncFromNacos() {
        // 1. ä»Nacosè·å–æœåŠ¡å®ä¾‹
        List<Instance> instances = 
            namingService.getAllInstances("user-service");
        
        // 2. è½¬æ¢ä¸ºEnvoy Endpointæ ¼å¼
        List<Endpoint> endpoints = instances.stream()
            .map(this::toEnvoyEndpoint)
            .collect(Collectors.toList());
        
        // 3. é€šè¿‡xDSæ¨é€ç»™Envoy
        edsService.pushEndpoints("user-service", endpoints);
    }
    
    private Endpoint toEnvoyEndpoint(Instance instance) {
        return Endpoint.newBuilder()
            .setAddress(Address.newBuilder()
                .setSocketAddress(SocketAddress.newBuilder()
                    .setAddress(instance.getIp())
                    .setPortValue(instance.getPort())
                    .build())
                .build())
            .build();
    }
}
```

---

## 6. ğŸ­ Sidecaræ¨¡å¼è¯¦è§£


### 6.1 Sidecaræ¨¡å¼æ ¸å¿ƒæ€æƒ³


**ğŸ”¸ ç”Ÿæ´»åŒ–ç±»æ¯”**

æƒ³è±¡ä½ éª‘æ‘©æ‰˜è½¦ï¼Œæ—è¾¹åŠ äº†ä¸€ä¸ªè¾¹è½¦ï¼ˆSidecarï¼‰ï¼š
- ğŸï¸ **ä¸»è½¦**ï¼šä½ çš„ä¸šåŠ¡æœåŠ¡ï¼Œä¸“å¿ƒè·‘ä¸»çº¿
- ğŸ›º **è¾¹è½¦**ï¼šä»£ç†æœåŠ¡ï¼Œå¤„ç†è¾…åŠ©å·¥ä½œ

```
ä¼ ç»Ÿæ¨¡å¼ï¼š
[ä¸šåŠ¡æœåŠ¡+æ‰€æœ‰åŠŸèƒ½] 
å¤ªé‡äº†ï¼Œéš¾ç»´æŠ¤

Sidecaræ¨¡å¼ï¼š
[ä¸šåŠ¡æœåŠ¡] + [Sidecarä»£ç†]
èŒè´£åˆ†ç¦»ï¼Œå„å¸å…¶èŒ
```

### 6.2 Sidecarå·¥ä½œåŸç†


```
Podå†…éƒ¨ç»“æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Kubernetes Pod        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ä¸šåŠ¡å®¹å™¨   â”‚  â”‚Sidecarå®¹å™¨  â”‚  â”‚
â”‚  â”‚          â”‚  â”‚            â”‚  â”‚
â”‚  â”‚user-     â”‚  â”‚envoy-      â”‚  â”‚
â”‚  â”‚service   â”‚  â”‚proxy       â”‚  â”‚
â”‚  â”‚          â”‚  â”‚            â”‚  â”‚
â”‚  â”‚:8080     â”‚  â”‚:15001      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚       â†‘              â†‘          â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚            å…±äº«ç½‘ç»œ              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æµé‡æ‹¦æˆªæœºåˆ¶**

```bash
# iptablesè§„åˆ™è‡ªåŠ¨é‡å®šå‘æµé‡
# å‡ºç«™æµé‡ â†’ Sidecar
iptables -t nat -A OUTPUT -p tcp \
  -j REDIRECT --to-port 15001

# å…¥ç«™æµé‡ â†’ Sidecar  
iptables -t nat -A PREROUTING -p tcp \
  -j REDIRECT --to-port 15006
```

### 6.3 Sidecaræ³¨å…¥æ–¹å¼


**ğŸ¯ è‡ªåŠ¨æ³¨å…¥ï¼ˆæ¨èï¼‰**

```yaml
# ç»™å‘½åç©ºé—´æ‰“æ ‡ç­¾ï¼Œè‡ªåŠ¨æ³¨å…¥
apiVersion: v1
kind: Namespace
metadata:
  name: default
  labels:
    istio-injection: enabled
```

**æ‰‹åŠ¨æ³¨å…¥**

```bash
# æ‰‹åŠ¨ä¸ºDeploymentæ³¨å…¥Sidecar
istioctl kube-inject -f user-service.yaml | kubectl apply -f -
```

**Javaåº”ç”¨é…ç½®**

```java
@Configuration
public class SidecarConfig {
    
    // åº”ç”¨é…ç½®æŒ‡å‘æœ¬åœ°Sidecar
    @Bean
    public RestTemplate restTemplate() {
        RestTemplate template = new RestTemplate();
        
        // æ‰€æœ‰å¤–éƒ¨è°ƒç”¨éƒ½èµ°Sidecarä»£ç†
        // Sidecarä¼šè‡ªåŠ¨å¤„ç†æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡
        return template;
    }
}

// ä½¿ç”¨æ—¶ä¸éœ€è¦å…³å¿ƒæœåŠ¡åœ°å€
@Service
public class OrderService {
    
    @Autowired
    private RestTemplate restTemplate;
    
    public User getUser(Long userId) {
        // ç›´æ¥ä½¿ç”¨æœåŠ¡åï¼ŒSidecarè‡ªåŠ¨è§£æ
        return restTemplate.getForObject(
            "http://user-service/users/" + userId,
            User.class
        );
    }
}
```

---

## 7. ğŸ›ï¸ æ§åˆ¶å¹³é¢ä¸æ•°æ®å¹³é¢


### 7.1 æ§åˆ¶å¹³é¢ï¼ˆControl Planeï¼‰


**ğŸ”¸ é€šä¿—ç†è§£**

æ§åˆ¶å¹³é¢å°±åƒæ˜¯"æŒ‡æŒ¥ä¸­å¿ƒ"ï¼Œè´Ÿè´£ï¼š
- ğŸ“‹ **åˆ¶å®šç­–ç•¥**ï¼šå®šä¹‰æµé‡æ€ä¹ˆèµ°
- ğŸ“¡ **ä¸‹å‘é…ç½®**ï¼šæŠŠè§„åˆ™æ¨é€ç»™ä»£ç†
- ğŸ“Š **æ”¶é›†ä¿¡æ¯**ï¼šæ±‡æ€»ç›‘æ§æ•°æ®

```
æ§åˆ¶å¹³é¢èŒè´£ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é…ç½®ç®¡ç† (Pilot)          â”‚
â”‚  - æœåŠ¡å‘ç°               â”‚
â”‚  - æµé‡è§„åˆ™               â”‚
â”‚  - è·¯ç”±é…ç½®               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è¯ä¹¦ç®¡ç† (Citadel)        â”‚
â”‚  - èº«ä»½è®¤è¯               â”‚
â”‚  - è¯ä¹¦é¢å‘               â”‚
â”‚  - å¯†é’¥è½®æ¢               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç­–ç•¥æ‰§è¡Œ (Mixer)          â”‚
â”‚  - è®¿é—®æ§åˆ¶               â”‚
â”‚  - é…é¢ç®¡ç†               â”‚
â”‚  - é¥æµ‹æ”¶é›†               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 æ•°æ®å¹³é¢ï¼ˆData Planeï¼‰


**ğŸ”¸ é€šä¿—ç†è§£**

æ•°æ®å¹³é¢å°±åƒæ˜¯"æ‰§è¡Œè€…"ï¼Œè´Ÿè´£ï¼š
- ğŸš¦ **è½¬å‘æµé‡**ï¼šå®é™…å¤„ç†è¯·æ±‚
- ğŸ” **æ‰§è¡Œç­–ç•¥**ï¼šåº”ç”¨æ§åˆ¶å¹³é¢çš„è§„åˆ™
- ğŸ“ˆ **ä¸ŠæŠ¥æ•°æ®**ï¼šå‘é€ç›‘æ§æŒ‡æ ‡

```
æ•°æ®å¹³é¢ç»„æˆï¼š
æ¯ä¸ªæœåŠ¡æ—çš„Sidecarä»£ç†
   â†“
æ‰§è¡Œæ§åˆ¶å¹³é¢ä¸‹å‘çš„é…ç½®
   â†“
å¤„ç†å®é™…çš„æœåŠ¡é—´é€šä¿¡
```

### 7.3 æ§åˆ¶å¹³é¢ä¸æ•°æ®å¹³é¢äº¤äº’


**xDSåè®®**

```
é…ç½®ä¸‹å‘æµç¨‹ï¼š

1ï¸âƒ£ ç®¡ç†å‘˜é…ç½®æµé‡è§„åˆ™
   â””â”€> kubectl apply -f virtualservice.yaml

2ï¸âƒ£ æ§åˆ¶å¹³é¢ç”Ÿæˆé…ç½®
   â””â”€> Pilotå¤„ç†å¹¶ç”ŸæˆEnvoyé…ç½®

3ï¸âƒ£ é€šè¿‡xDSæ¨é€
   â””â”€> ä½¿ç”¨gRPC streamæ¨é€é…ç½®

4ï¸âƒ£ æ•°æ®å¹³é¢åº”ç”¨é…ç½®
   â””â”€> EnvoyåŠ¨æ€åŠ è½½æ–°é…ç½®

5ï¸âƒ£ é…ç½®ç«‹å³ç”Ÿæ•ˆ
   â””â”€> æ— éœ€é‡å¯æœåŠ¡
```

**Javaåº”ç”¨è§†è§’**

```java
// åº”ç”¨ä»£ç å®Œå…¨ä¸æ„ŸçŸ¥æ§åˆ¶å¹³é¢
@RestController
public class UserController {
    
    @Autowired
    private OrderServiceClient orderClient;
    
    @GetMapping("/users/{id}/orders")
    public List<Order> getUserOrders(@PathVariable Long id) {
        // è¿™ä¸ªè°ƒç”¨èƒŒåï¼š
        // 1. Sidecaræ‹¦æˆªè¯·æ±‚
        // 2. æŸ¥è¯¢æ§åˆ¶å¹³é¢è·å–è·¯ç”±è§„åˆ™
        // 3. æŒ‰è§„åˆ™é€‰æ‹©ç›®æ ‡å®ä¾‹
        // 4. è½¬å‘è¯·æ±‚å¹¶è¿”å›
        return orderClient.getOrdersByUserId(id);
    }
}
```

---

## 8. ğŸŒŠ å»æ³¨å†Œä¸­å¿ƒåŒ–è¶‹åŠ¿


### 8.1 ä¸ºä»€ä¹ˆè¦å»æ³¨å†Œä¸­å¿ƒåŒ–


**ğŸ”¸ ä¼ ç»Ÿæ³¨å†Œä¸­å¿ƒçš„é—®é¢˜**

```
ä¼ ç»Ÿæ¶æ„ç—›ç‚¹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡           â”‚
â”‚  - SDKä¾µå…¥æ€§å¼º           â”‚
â”‚  - å‡çº§å›°éš¾             â”‚
â”‚  - å¤šè¯­è¨€æ”¯æŒå·®          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ³¨å†Œä¸­å¿ƒå•ç‚¹            â”‚
â”‚  - æˆä¸ºæ€§èƒ½ç“¶é¢ˆ          â”‚
â”‚  - æ•…éšœå½±å“å¤§            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é…ç½®ç®¡ç†åˆ†æ•£            â”‚
â”‚  - æµé‡è§„åˆ™éš¾ç»Ÿä¸€        â”‚
â”‚  - è¿ç»´å¤æ‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æœåŠ¡ç½‘æ ¼çš„ä¼˜åŠ¿**

| ç»´åº¦ | **ä¼ ç»Ÿæ³¨å†Œä¸­å¿ƒ** | **æœåŠ¡ç½‘æ ¼** |
|------|----------------|------------|
| ğŸ”§ **æœåŠ¡å‘ç°** | `å®¢æˆ·ç«¯SDK` | `Sidecarä»£ç†ï¼Œé€æ˜åŒ–` |
| ğŸŒ **å¤šè¯­è¨€** | `æ¯ç§è¯­è¨€å•ç‹¬å®ç°` | `ç»Ÿä¸€ä»£ç†ï¼Œè¯­è¨€æ— å…³` |
| ğŸ“Š **æµé‡æ²»ç†** | `ä»£ç å±‚é¢å®ç°` | `é…ç½®é©±åŠ¨ï¼Œçµæ´»` |
| ğŸ” **å®‰å…¨é€šä¿¡** | `åº”ç”¨å±‚å¤„ç†` | `ç½‘æ ¼å±‚ç»Ÿä¸€mTLS` |
| ğŸ¯ **è¿ç»´å¤æ‚åº¦** | `è¾ƒé«˜` | `é›†ä¸­ç®¡ç†ï¼Œç®€åŒ–è¿ç»´` |

### 8.2 æ¸è¿›å¼è¿ç§»ç­–ç•¥


**ğŸ¯ ä»æ³¨å†Œä¸­å¿ƒåˆ°æœåŠ¡ç½‘æ ¼**

```
è¿ç§»é˜¶æ®µï¼š

é˜¶æ®µä¸€ï¼šå…±å­˜æ¨¡å¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Nacos/Eureka           â”‚
â”‚  (ä¿ç•™åŸæœ‰æœåŠ¡å‘ç°)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœåŠ¡ç½‘æ ¼                â”‚
â”‚  (æ–°å¢æµé‡æ²»ç†åŠŸèƒ½)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é˜¶æ®µäºŒï¼šé€æ­¥è¿ç§»
- æ–°æœåŠ¡ç›´æ¥ç”¨æœåŠ¡ç½‘æ ¼
- è€æœåŠ¡ä¿æŒä¸å˜
- ç½‘æ ¼æ¡¥æ¥ä¸¤è¾¹é€šä¿¡

é˜¶æ®µä¸‰ï¼šå®Œå…¨ç½‘æ ¼åŒ–
- æ³¨å†Œä¸­å¿ƒä»…åšæœåŠ¡æ³¨å†Œ
- æœåŠ¡å‘ç°äº¤ç»™ç½‘æ ¼
- æµé‡æ²»ç†å®Œå…¨ç”±ç½‘æ ¼ç®¡ç†
```

**å®æˆ˜é…ç½®ç¤ºä¾‹**

```yaml
# Istioå¯¹æ¥Nacosé…ç½®
apiVersion: networking.istio.io/v1alpha3
kind: ServiceEntry
metadata:
  name: nacos-registry
spec:
  hosts:
  - "*.service.consul"
  location: MESH_INTERNAL
  ports:
  - number: 8080
    name: http
    protocol: HTTP
  resolution: DNS
```

### 8.3 KubernetesåŸç”ŸæœåŠ¡å‘ç°


**ğŸ”¸ äº‘åŸç”Ÿè¶‹åŠ¿**

åœ¨Kubernetesç¯å¢ƒä¸‹ï¼ŒæœåŠ¡ç½‘æ ¼ç›´æ¥å¯¹æ¥K8s Serviceï¼š

```yaml
# ä¸éœ€è¦å¤–éƒ¨æ³¨å†Œä¸­å¿ƒ
apiVersion: v1
kind: Service
metadata:
  name: user-service
spec:
  selector:
    app: user-service
  ports:
  - port: 8080
    targetPort: 8080
```

**å·¥ä½œæµç¨‹**
```
K8såŸç”ŸæœåŠ¡å‘ç°ï¼š

1ï¸âƒ£ Podå¯åŠ¨è‡ªåŠ¨æ³¨å†Œ
   â””â”€> Kubeleté€šçŸ¥APIServer

2ï¸âƒ£ ServiceåŠ¨æ€æ›´æ–°Endpoints
   â””â”€> æ— éœ€é¢å¤–æ³¨å†Œä¸­å¿ƒ

3ï¸âƒ£ æœåŠ¡ç½‘æ ¼åŒæ­¥ä¿¡æ¯
   â””â”€> æ§åˆ¶å¹³é¢ç›‘å¬K8s API

4ï¸âƒ£ é…ç½®æ¨é€åˆ°Sidecar
   â””â”€> Envoyè·å–æœ€æ–°æœåŠ¡åˆ—è¡¨

5ï¸âƒ£ æµé‡æŒ‰è§„åˆ™è½¬å‘
   â””â”€> å®Œå…¨ç”±ç½‘æ ¼æ§åˆ¶
```

**Javaåº”ç”¨é›¶æ”¹åŠ¨**

```java
// åº”ç”¨ä»£ç ä¸éœ€è¦ä»»ä½•æœåŠ¡å‘ç°é€»è¾‘
@Service
public class UserService {
    
    @Autowired
    private RestTemplate restTemplate;
    
    public Order getOrder(Long orderId) {
        // ç›´æ¥ä½¿ç”¨K8s Serviceåç§°
        // ç½‘æ ¼è‡ªåŠ¨è§£æå’Œè´Ÿè½½å‡è¡¡
        return restTemplate.getForObject(
            "http://order-service/orders/" + orderId,
            Order.class
        );
    }
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 æœåŠ¡ç½‘æ ¼æ ¸å¿ƒæ¦‚å¿µ


**ğŸ”¸ å¿…é¡»ç†è§£çš„è¦ç‚¹**
```
âœ… æœåŠ¡ç½‘æ ¼æ˜¯åŸºç¡€è®¾æ–½å±‚ï¼Œå¯¹ä¸šåŠ¡é€æ˜
âœ… Sidecaræ¨¡å¼æ˜¯æ ¸å¿ƒï¼Œæ¯ä¸ªæœåŠ¡é…ä¸€ä¸ªä»£ç†
âœ… æ§åˆ¶å¹³é¢ç®¡ç­–ç•¥ï¼Œæ•°æ®å¹³é¢æ‰§è¡Œç­–ç•¥
âœ… æµé‡æ²»ç†èƒ½åŠ›è¿œè¶…ä¼ ç»Ÿæ³¨å†Œä¸­å¿ƒ
âœ… å®‰å…¨é€šä¿¡é»˜è®¤å¼€å¯ï¼Œæ— éœ€åº”ç”¨å±‚å¤„ç†
```

### 9.2 ä¸‰å¤§ä¸»æµæ–¹æ¡ˆå¯¹æ¯”


| æ–¹æ¡ˆ | **é€‚ç”¨åœºæ™¯** | **æ ¸å¿ƒä¼˜åŠ¿** | **å­¦ä¹ æˆæœ¬** |
|------|------------|------------|------------|
| ğŸŒŸ **Istio** | `å¤§è§„æ¨¡K8sé›†ç¾¤` | `åŠŸèƒ½æœ€å¼ºå¤§ï¼Œç”Ÿæ€ä¸°å¯Œ` | `è¾ƒé«˜` |
| ğŸ”— **Consul Connect** | `VM+K8sæ··åˆç¯å¢ƒ` | `ä¸Consulæ·±åº¦é›†æˆ` | `ä¸­ç­‰` |
| ğŸš€ **Linkerd** | `è¿½æ±‚æç®€å’Œæ€§èƒ½` | `èµ„æºå ç”¨å°‘ï¼Œä¸Šæ‰‹å¿«` | `è¾ƒä½` |

### 9.3 å…³é”®æŠ€æœ¯ç†è§£


**ğŸ¯ Sidecaræ¨¡å¼**
```
æ ¸å¿ƒæ€æƒ³ï¼šèŒè´£åˆ†ç¦»
- ä¸šåŠ¡å®¹å™¨ï¼šåªå…³æ³¨ä¸šåŠ¡é€»è¾‘
- Sidecarå®¹å™¨ï¼šå¤„ç†é€šä¿¡ç»†èŠ‚
- ä¸¤è€…å…±äº«ç½‘ç»œç©ºé—´
- æµé‡é€æ˜æ‹¦æˆªè½¬å‘
```

**ğŸ¯ æ§åˆ¶å¹³é¢ä¸æ•°æ®å¹³é¢**
```
æ§åˆ¶å¹³é¢ï¼šå¤§è„‘ï¼Œåˆ¶å®šç­–ç•¥
- é…ç½®ç®¡ç†
- è¯ä¹¦é¢å‘
- ç­–ç•¥ä¸‹å‘

æ•°æ®å¹³é¢ï¼šæ‰‹è„šï¼Œæ‰§è¡Œç­–ç•¥
- æµé‡è½¬å‘
- è§„åˆ™åº”ç”¨
- æŒ‡æ ‡ä¸ŠæŠ¥
```

### 9.4 å»æ³¨å†Œä¸­å¿ƒåŒ–è¶‹åŠ¿


**æ¼”è¿›è·¯å¾„**
```
ä¼ ç»Ÿæ–¹å¼ï¼š
åº”ç”¨ â†’ SDK â†’ æ³¨å†Œä¸­å¿ƒ â†’ æœåŠ¡å‘ç°

ç°ä»£æ–¹å¼ï¼š
åº”ç”¨ â†’ Sidecar â†’ æœåŠ¡ç½‘æ ¼ â†’ è‡ªåŠ¨å‘ç°

æœªæ¥æ–¹å‘ï¼š
åº”ç”¨ â†’ K8s Service â†’ ç½‘æ ¼æ§åˆ¶
(å®Œå…¨æ— æ„ŸçŸ¥)
```

**å®è·µå»ºè®®**

> âš ï¸ **æ³¨æ„äº‹é¡¹**
> - å°è§„æ¨¡ç³»ç»Ÿå…ˆç”¨ä¼ ç»Ÿæ³¨å†Œä¸­å¿ƒï¼Œå¤Ÿç”¨å°±å¥½
> - ä¸­å¤§è§„æ¨¡æˆ–å¤šè¯­è¨€åœºæ™¯ï¼Œè€ƒè™‘æœåŠ¡ç½‘æ ¼
> - Kubernetesç¯å¢ƒä¼˜å…ˆé€‰æ‹©æœåŠ¡ç½‘æ ¼
> - æ¸è¿›å¼è¿ç§»ï¼Œä¸è¦ä¸€æ­¥åˆ°ä½

> ğŸ’¡ **æœ€ä½³å®è·µ**
> - æ–°é¡¹ç›®ç›´æ¥ä¸ŠæœåŠ¡ç½‘æ ¼
> - è€é¡¹ç›®é€æ­¥è¿ç§»ï¼Œå…ˆå…±å­˜åæ›¿æ¢
> - å……åˆ†åˆ©ç”¨ç½‘æ ¼çš„æµé‡æ²»ç†èƒ½åŠ›
> - é‡è§†å®‰å…¨æ€§ï¼Œå¯ç”¨mTLS
> - åšå¥½ç›‘æ§å’Œå¯è§‚æµ‹æ€§

### 9.5 å­¦ä¹ è·¯çº¿å»ºè®®


**å…¥é—¨é˜¶æ®µ**
```
1ï¸âƒ£ ç†è§£æœåŠ¡ç½‘æ ¼åŸºæœ¬æ¦‚å¿µ
2ï¸âƒ£ æŒæ¡Sidecaræ¨¡å¼åŸç†
3ï¸âƒ£ åŠ¨æ‰‹å®è·µLinkerdï¼ˆæœ€ç®€å•ï¼‰
```

**è¿›é˜¶é˜¶æ®µ**
```
1ï¸âƒ£ æ·±å…¥å­¦ä¹ Istioæ¶æ„
2ï¸âƒ£ æŒæ¡æµé‡ç®¡ç†å„ç§è§„åˆ™
3ï¸âƒ£ ç†è§£xDSåè®®å’ŒåŠ¨æ€é…ç½®
```

**é«˜çº§é˜¶æ®µ**
```
1ï¸âƒ£ ç ”ç©¶Envoyå†…éƒ¨æœºåˆ¶
2ï¸âƒ£ è‡ªå®šä¹‰æ‰©å±•å’Œæ’ä»¶å¼€å‘
3ï¸âƒ£ å¤šé›†ç¾¤å’Œæ··åˆäº‘æ–¹æ¡ˆ
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- æœåŠ¡ç½‘æ ¼æ˜¯å¾®æœåŠ¡é€šä¿¡çš„ä¸“ç”¨åŸºç¡€è®¾æ–½
- Sidecaræ¨¡å¼å®ç°ä¸šåŠ¡ä¸æ²»ç†åˆ†ç¦»
- æ§åˆ¶å¹³é¢ç®¡ç­–ç•¥ï¼Œæ•°æ®å¹³é¢æ‰§è¡Œç­–ç•¥
- å»æ³¨å†Œä¸­å¿ƒåŒ–æ˜¯äº‘åŸç”Ÿæ¼”è¿›è¶‹åŠ¿
- é€‰æ‹©æ–¹æ¡ˆè¦ç»“åˆå®é™…åœºæ™¯å’Œå›¢é˜Ÿèƒ½åŠ›