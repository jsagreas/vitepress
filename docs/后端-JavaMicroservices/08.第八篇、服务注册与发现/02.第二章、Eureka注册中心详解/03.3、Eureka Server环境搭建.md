---
title: 3ã€Eureka Serverç¯å¢ƒæ­å»º
---
## ğŸ“š ç›®å½•

1. [ç¯å¢ƒå‡†å¤‡ä¸ä¾èµ–é…ç½®](#1-ç¯å¢ƒå‡†å¤‡ä¸ä¾èµ–é…ç½®)
2. [å¯åŠ¨ç±»ä¸æ ¸å¿ƒæ³¨è§£](#2-å¯åŠ¨ç±»ä¸æ ¸å¿ƒæ³¨è§£)
3. [é…ç½®æ–‡ä»¶è¯¦è§£](#3-é…ç½®æ–‡ä»¶è¯¦è§£)
4. [å•æœºæ¨¡å¼éƒ¨ç½²](#4-å•æœºæ¨¡å¼éƒ¨ç½²)
5. [é›†ç¾¤æ¨¡å¼é…ç½®](#5-é›†ç¾¤æ¨¡å¼é…ç½®)
6. [å®‰å…¨è®¤è¯é…ç½®](#6-å®‰å…¨è®¤è¯é…ç½®)
7. [ç›‘æ§ç«¯ç‚¹é…ç½®](#7-ç›‘æ§ç«¯ç‚¹é…ç½®)
8. [JVMå‚æ•°ä¼˜åŒ–](#8-JVMå‚æ•°ä¼˜åŒ–)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”§ ç¯å¢ƒå‡†å¤‡ä¸ä¾èµ–é…ç½®


### 1.1 åŸºç¡€ç¯å¢ƒè¦æ±‚


**å¿…å¤‡æ¡ä»¶**ï¼š
```
âœ… JDKç‰ˆæœ¬ï¼šJDK 8 æˆ–ä»¥ä¸Š
âœ… æ„å»ºå·¥å…·ï¼šMaven 3.x æˆ– Gradle 6.x
âœ… Spring Bootï¼š2.3.x æˆ–ä»¥ä¸Š
âœ… Spring Cloudï¼šHoxton.SR8 æˆ–ä»¥ä¸Š
```

**ç‰ˆæœ¬å¯¹åº”å…³ç³»**ï¼š

| Spring Bootç‰ˆæœ¬ | **Spring Cloudç‰ˆæœ¬** | **æ¨èæ­é…** |
|----------------|---------------------|-------------|
| `2.3.x` | `Hoxton.SR8` | `ç¨³å®šç”Ÿäº§ç¯å¢ƒ` |
| `2.4.x` | `2020.0.x (Ilford)` | `æ–°ç‰¹æ€§å°é²œ` |
| `2.6.x` | `2021.0.x (Jubilee)` | `é•¿æœŸæ”¯æŒç‰ˆæœ¬` |
| `2.7.x` | `2021.0.x` | `æœ€æ–°ç¨³å®šç‰ˆ` |

### 1.2 Mavenä¾èµ–é…ç½®


**å®Œæ•´pom.xmlé…ç½®**ï¼š

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project>
    <!-- çˆ¶ä¾èµ–ï¼šSpring Boot -->
    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>2.6.13</version>
    </parent>

    <properties>
        <java.version>1.8</java.version>
        <spring-cloud.version>2021.0.5</spring-cloud.version>
    </properties>

    <dependencies>
        <!-- Eureka Serveræ ¸å¿ƒä¾èµ– -->
        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-starter-netflix-eureka-server</artifactId>
        </dependency>
    </dependencies>

    <!-- ç‰ˆæœ¬ç®¡ç† -->
    <dependencyManagement>
        <dependencies>
            <dependency>
                <groupId>org.springframework.cloud</groupId>
                <artifactId>spring-cloud-dependencies</artifactId>
                <version>${spring-cloud.version}</version>
                <type>pom</type>
                <scope>import</scope>
            </dependency>
        </dependencies>
    </dependencyManagement>
</project>
```

**ä¾èµ–è¯´æ˜**ï¼š
```
spring-cloud-starter-netflix-eureka-serverï¼š
â”œâ”€ Eureka Serveræ ¸å¿ƒåº“
â”œâ”€ Webå®¹å™¨ï¼ˆTomcatï¼‰
â”œâ”€ æœåŠ¡æ³¨å†Œç®¡ç†åŠŸèƒ½
â””â”€ æ§åˆ¶å°UIç•Œé¢

è¿™ä¸€ä¸ªä¾èµ–å°±åŒ…å«äº†æ‰€æœ‰éœ€è¦çš„åŠŸèƒ½ï¼
```

**å¯é€‰ä¾èµ–**ï¼š
```xml
<!-- å®‰å…¨è®¤è¯ï¼ˆå¯é€‰ï¼‰ -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-security</artifactId>
</dependency>

<!-- å¥åº·ç›‘æ§ï¼ˆå¯é€‰ï¼‰ -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-actuator</artifactId>
</dependency>
```

---

## 2. ğŸš€ å¯åŠ¨ç±»ä¸æ ¸å¿ƒæ³¨è§£


### 2.1 @EnableEurekaServeræ³¨è§£è¯¦è§£


**æ ¸å¿ƒå¯åŠ¨ç±»**ï¼š

```java
package com.example.eureka;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.netflix.eureka.server.EnableEurekaServer;

@SpringBootApplication
@EnableEurekaServer  // è¿™ä¸€è¡Œæ˜¯å…³é”®ï¼
public class EurekaServerApplication {
    
    public static void main(String[] args) {
        SpringApplication.run(EurekaServerApplication.class, args);
    }
}
```

**æ³¨è§£ä½œç”¨è§£æ**ï¼š

```
@EnableEurekaServeråšäº†ä»€ä¹ˆï¼Ÿ

ç¬¬1æ­¥ï¼šè‡ªåŠ¨è£…é…
    â†’ åŠ è½½EurekaServerAutoConfiguration
    â†’ åˆå§‹åŒ–æ³¨å†Œè¡¨ï¼ˆConcurrentHashMapï¼‰
    â†’ å¯åŠ¨å®šæ—¶ä»»åŠ¡ï¼ˆæœåŠ¡å‰”é™¤ã€è‡ªæˆ‘ä¿æŠ¤æ£€æŸ¥ï¼‰

ç¬¬2æ­¥ï¼šå¯åŠ¨WebæœåŠ¡
    â†’ æš´éœ²REST APIï¼ˆ/eureka/appsï¼‰
    â†’ å¯åŠ¨ç®¡ç†ç•Œé¢ï¼ˆhttp://localhost:8761ï¼‰

ç¬¬3æ­¥ï¼šåˆå§‹åŒ–é›†ç¾¤åŒæ­¥
    â†’ å¦‚æœé…ç½®äº†é›†ç¾¤èŠ‚ç‚¹
    â†’ å»ºç«‹èŠ‚ç‚¹é—´çš„é€šä¿¡è¿æ¥

åªéœ€è¦è¿™ä¸€ä¸ªæ³¨è§£ï¼ŒEureka Serverå°±å¯åŠ¨äº†ï¼
```

**å¸¸è§è¯¯åŒº**ï¼š
```
âŒ é”™è¯¯å†™æ³•1ï¼šå¿˜è®°æ·»åŠ æ³¨è§£
@SpringBootApplication
public class EurekaServerApplication { ... }
â†’ ç»“æœï¼šåªæ˜¯æ™®é€šSpring Bootåº”ç”¨ï¼Œæ²¡æœ‰EurekaåŠŸèƒ½

âŒ é”™è¯¯å†™æ³•2ï¼šæ··ç”¨Clientå’ŒServeræ³¨è§£
@EnableEurekaServer
@EnableEurekaClient  // ä¸è¦åŒæ—¶ä½¿ç”¨ï¼
â†’ ç»“æœï¼šåŠŸèƒ½å†²çªï¼Œå¯åŠ¨å¼‚å¸¸

âœ… æ­£ç¡®å†™æ³•ï¼š
@SpringBootApplication
@EnableEurekaServer  // Serverç«¯åªéœ€è¦è¿™ä¸€ä¸ª
```

---

## 3. ğŸ“ é…ç½®æ–‡ä»¶è¯¦è§£


### 3.1 application.ymlå®Œæ•´é…ç½®


**åŸºç¡€é…ç½®æ¨¡æ¿**ï¼š

```yaml
server:
  port: 8761  # Eurekaé»˜è®¤ç«¯å£

spring:
  application:
    name: eureka-server  # åº”ç”¨åç§°

eureka:
  instance:
    hostname: localhost  # ä¸»æœºå
    
  client:
    register-with-eureka: false  # ä¸æ³¨å†Œè‡ªå·±
    fetch-registry: false        # ä¸æ‹‰å–æ³¨å†Œè¡¨
    service-url:
      defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/
      
  server:
    enable-self-preservation: true  # å¼€å¯è‡ªæˆ‘ä¿æŠ¤
    eviction-interval-timer-in-ms: 60000  # å‰”é™¤é—´éš”60ç§’
```

### 3.2 æ ¸å¿ƒé…ç½®é¡¹è¯¦è§£


**ğŸ”¸ instanceé…ç½®ï¼ˆå®ä¾‹é…ç½®ï¼‰**ï¼š

| é…ç½®é¡¹ | **é»˜è®¤å€¼** | **è¯´æ˜** | **å»ºè®®** |
|--------|----------|---------|---------|
| `hostname` | `localhost` | `Eureka Serverä¸»æœºå` | `ç”Ÿäº§ç¯å¢ƒç”¨çœŸå®IP` |
| `prefer-ip-address` | `false` | `æ˜¯å¦ä½¿ç”¨IPæ³¨å†Œ` | `é›†ç¾¤ç¯å¢ƒå»ºè®®true` |
| `ip-address` | `è‡ªåŠ¨è·å–` | `æ‰‹åŠ¨æŒ‡å®šIPåœ°å€` | `å¤šç½‘å¡ç¯å¢ƒä½¿ç”¨` |
| `instance-id` | `è‡ªåŠ¨ç”Ÿæˆ` | `å®ä¾‹å”¯ä¸€æ ‡è¯†` | `è‡ªå®šä¹‰ä¾¿äºè¯†åˆ«` |

**ğŸ”¸ clienté…ç½®ï¼ˆå®¢æˆ·ç«¯é…ç½®ï¼‰**ï¼š

```yaml
eureka:
  client:
    # æ˜¯å¦æ³¨å†Œè‡ªå·±åˆ°Eurekaï¼ˆServerç«¯è®¾ä¸ºfalseï¼‰
    register-with-eureka: false
    
    # æ˜¯å¦ä»Eurekaæ‹‰å–æ³¨å†Œè¡¨ï¼ˆServerç«¯è®¾ä¸ºfalseï¼‰
    fetch-registry: false
    
    # æ³¨å†Œä¸­å¿ƒåœ°å€
    service-url:
      defaultZone: http://localhost:8761/eureka/
    
    # æ‹‰å–æ³¨å†Œè¡¨é—´éš”ï¼ˆæ¯«ç§’ï¼‰
    registry-fetch-interval-seconds: 30
```

**ä¸ºä»€ä¹ˆServerç«¯è¦è®¾ç½®è¿™ä¸¤ä¸ªfalseï¼Ÿ**

```
åœºæ™¯1ï¼šregister-with-eureka: false
åŸå› ï¼šEureka Serveræœ¬èº«æ˜¯æ³¨å†Œä¸­å¿ƒï¼Œä¸éœ€è¦æŠŠè‡ªå·±æ³¨å†Œåˆ°è‡ªå·±
å¦‚æœè®¾ä¸ºtrueï¼šè‡ªå·±æ³¨å†Œè‡ªå·±ï¼Œæ²¡æœ‰æ„ä¹‰ä¸”æµªè´¹èµ„æº

åœºæ™¯2ï¼šfetch-registry: false  
åŸå› ï¼šServerç«¯ç»´æŠ¤çš„å°±æ˜¯æ³¨å†Œè¡¨ï¼Œä¸éœ€è¦ä»è‡ªå·±æ‹‰å–
å¦‚æœè®¾ä¸ºtrueï¼šè‡ªå·±ä»è‡ªå·±æ‹‰å–ï¼Œå¤šæ­¤ä¸€ä¸¾

âš ï¸ æ³¨æ„ï¼šè¿™ä¸¤ä¸ªé…ç½®åªåœ¨Serverç«¯è®¾ä¸ºfalse
         Clientç«¯å¿…é¡»è®¾ä¸ºtrueï¼
```

**ğŸ”¸ serveré…ç½®ï¼ˆæœåŠ¡ç«¯é…ç½®ï¼‰**ï¼š

```yaml
eureka:
  server:
    # è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼
    enable-self-preservation: true
    renewal-percent-threshold: 0.85
    
    # æœåŠ¡å‰”é™¤
    eviction-interval-timer-in-ms: 60000
    
    # å“åº”ç¼“å­˜
    response-cache-update-interval-ms: 30000
    response-cache-auto-expiration-in-seconds: 180
    
    # é›†ç¾¤åŒæ­¥
    peer-eureka-nodes-update-interval-ms: 10000
```

### 3.3 ç¯å¢ƒå·®å¼‚åŒ–é…ç½®


**å¼€å‘ç¯å¢ƒé…ç½®**ï¼š
```yaml
# application-dev.yml
eureka:
  server:
    enable-self-preservation: false  # å…³é—­ä¿æŠ¤ï¼Œæ–¹ä¾¿æµ‹è¯•
    eviction-interval-timer-in-ms: 10000  # å¿«é€Ÿå‰”é™¤
  instance:
    lease-renewal-interval-in-seconds: 5  # å¿«é€Ÿå¿ƒè·³
    lease-expiration-duration-in-seconds: 10  # å¿«é€Ÿè¿‡æœŸ
```

**ç”Ÿäº§ç¯å¢ƒé…ç½®**ï¼š
```yaml
# application-prod.yml
eureka:
  server:
    enable-self-preservation: true  # å¼€å¯ä¿æŠ¤
    eviction-interval-timer-in-ms: 60000
  instance:
    lease-renewal-interval-in-seconds: 30
    lease-expiration-duration-in-seconds: 90
```

---

## 4. ğŸ’» å•æœºæ¨¡å¼éƒ¨ç½²


### 4.1 å•æœºæ¨¡å¼é…ç½®


**å®Œæ•´é…ç½®æ–‡ä»¶**ï¼š

```yaml
server:
  port: 8761

spring:
  application:
    name: eureka-server-standalone

eureka:
  instance:
    hostname: localhost
    
  client:
    register-with-eureka: false  # å•æœºä¸æ³¨å†Œè‡ªå·±
    fetch-registry: false        # å•æœºä¸æ‹‰å–æ³¨å†Œè¡¨
    service-url:
      defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/
```

**å¯åŠ¨æ–¹å¼**ï¼š
```bash
# æ–¹å¼1ï¼šIDEAç›´æ¥è¿è¡Œ
å³é”® EurekaServerApplication â†’ Run

# æ–¹å¼2ï¼šMavenå‘½ä»¤
mvn spring-boot:run

# æ–¹å¼3ï¼šæ‰“åŒ…è¿è¡Œ
mvn clean package
java -jar eureka-server.jar
```

### 4.2 è®¿é—®æ§åˆ¶å°


**æ§åˆ¶å°åœ°å€**ï¼š`http://localhost:8761`

**æ§åˆ¶å°ç•Œé¢è¯´æ˜**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Eureka Dashboard            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  System Status                      â”‚
â”‚  Environment: test                  â”‚
â”‚  Data center: default               â”‚
â”‚  Current time: 2025-09-23 11:30:00 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Instances currently registered     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Application    Status      â”‚   â”‚
â”‚  â”‚  ORDER-SERVICE  UP(1)      â”‚   â”‚
â”‚  â”‚  USER-SERVICE   UP(2)      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  General Info                       â”‚
â”‚  total-avail-memory: 1024mb        â”‚
â”‚  registered-replicas: N/A          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¸¸è§å¯åŠ¨é—®é¢˜**ï¼š

```
é—®é¢˜1ï¼šç«¯å£è¢«å ç”¨
é”™è¯¯ä¿¡æ¯ï¼šPort 8761 is already in use
è§£å†³æ–¹æ¡ˆï¼š
  æ–¹æ³•1ï¼šä¿®æ”¹ç«¯å£ server.port: 8762
  æ–¹æ³•2ï¼šæ€æ‰å ç”¨è¿›ç¨‹ netstat -ano | findstr 8761

é—®é¢˜2ï¼šä¾èµ–å†²çª
é”™è¯¯ä¿¡æ¯ï¼šClassNotFoundException: EurekaServerAutoConfiguration
è§£å†³æ–¹æ¡ˆï¼š
  æ£€æŸ¥ç‰ˆæœ¬åŒ¹é…å…³ç³»ï¼Œç¡®ä¿Spring Bootå’ŒSpring Cloudç‰ˆæœ¬å…¼å®¹

é—®é¢˜3ï¼šæ— æ³•è®¿é—®æ§åˆ¶å°
æ£€æŸ¥é¡¹ï¼š
  âœ… æœåŠ¡æ˜¯å¦å¯åŠ¨æˆåŠŸ
  âœ… ç«¯å£æ˜¯å¦æ­£ç¡®
  âœ… é˜²ç«å¢™æ˜¯å¦å¼€æ”¾
```

---

## 5. ğŸŒ é›†ç¾¤æ¨¡å¼é…ç½®


### 5.1 é›†ç¾¤æ¨¡å¼åŸç†


**ä¸ºä»€ä¹ˆéœ€è¦é›†ç¾¤ï¼Ÿ**

```
å•æœºæ¨¡å¼çš„é—®é¢˜ï¼š
âŒ å•ç‚¹æ•…éšœï¼šEurekaæŒ‚äº†ï¼Œæ‰€æœ‰æœåŠ¡éƒ½æ‰¾ä¸åˆ°å½¼æ­¤
âŒ æ€§èƒ½ç“¶é¢ˆï¼šæ‰€æœ‰è¯·æ±‚é›†ä¸­åœ¨ä¸€å°æœºå™¨
âŒ æ— æ³•æ‰©å±•ï¼šæµé‡å¢å¤§æ— æ³•æ¨ªå‘æ‰©å±•

é›†ç¾¤æ¨¡å¼çš„ä¼˜åŠ¿ï¼š
âœ… é«˜å¯ç”¨ï¼šä¸€å°æŒ‚äº†è¿˜æœ‰å…¶ä»–èŠ‚ç‚¹
âœ… è´Ÿè½½åˆ†æ‹…ï¼šè¯·æ±‚åˆ†æ•£åˆ°å¤šä¸ªèŠ‚ç‚¹
âœ… æ•°æ®åŒæ­¥ï¼šèŠ‚ç‚¹é—´äº’ç›¸å¤åˆ¶æ³¨å†Œè¡¨
```

**é›†ç¾¤æ¶æ„ç¤ºæ„**ï¼š

```
         å®¢æˆ·ç«¯æœåŠ¡
        /    |    \
       /     |     \
Eureka-1  Eureka-2  Eureka-3
    \       |       /
     \      |      /
      äº’ç›¸æ³¨å†ŒåŒæ­¥
      
ç‰¹ç‚¹ï¼š
â€¢ æ¯ä¸ªEurekaéƒ½æ³¨å†Œåˆ°å…¶ä»–Eureka
â€¢ ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹éƒ½æœ‰å®Œæ•´çš„æ³¨å†Œè¡¨
â€¢ å®¢æˆ·ç«¯å¯ä»¥è¿æ¥ä»»æ„èŠ‚ç‚¹
```

### 5.2 ä¸‰èŠ‚ç‚¹é›†ç¾¤é…ç½®


**èŠ‚ç‚¹1é…ç½®ï¼ˆeureka-server-1ï¼‰**ï¼š

```yaml
server:
  port: 8761

spring:
  application:
    name: eureka-server
    
eureka:
  instance:
    hostname: eureka-server-1
    
  client:
    register-with-eureka: true  # é›†ç¾¤æ¨¡å¼è¦æ³¨å†Œ
    fetch-registry: true        # é›†ç¾¤æ¨¡å¼è¦æ‹‰å–
    service-url:
      # æ³¨å†Œåˆ°å…¶ä»–ä¸¤ä¸ªèŠ‚ç‚¹
      defaultZone: http://eureka-server-2:8762/eureka/,http://eureka-server-3:8763/eureka/
```

**èŠ‚ç‚¹2é…ç½®ï¼ˆeureka-server-2ï¼‰**ï¼š

```yaml
server:
  port: 8762

spring:
  application:
    name: eureka-server
    
eureka:
  instance:
    hostname: eureka-server-2
    
  client:
    register-with-eureka: true
    fetch-registry: true
    service-url:
      defaultZone: http://eureka-server-1:8761/eureka/,http://eureka-server-3:8763/eureka/
```

**èŠ‚ç‚¹3é…ç½®ï¼ˆeureka-server-3ï¼‰**ï¼š

```yaml
server:
  port: 8763

spring:
  application:
    name: eureka-server
    
eureka:
  instance:
    hostname: eureka-server-3
    
  client:
    register-with-eureka: true
    fetch-registry: true
    service-url:
      defaultZone: http://eureka-server-1:8761/eureka/,http://eureka-server-2:8762/eureka/
```

### 5.3 hostsæ–‡ä»¶é…ç½®


**Windowsç³»ç»Ÿ**ï¼š
```bash
# ç¼–è¾‘ C:\Windows\System32\drivers\etc\hosts
127.0.0.1 eureka-server-1
127.0.0.1 eureka-server-2
127.0.0.1 eureka-server-3
```

**Linux/Macç³»ç»Ÿ**ï¼š
```bash
# ç¼–è¾‘ /etc/hosts
127.0.0.1 eureka-server-1
127.0.0.1 eureka-server-2
127.0.0.1 eureka-server-3
```

### 5.4 å®¢æˆ·ç«¯è¿æ¥é›†ç¾¤


**æœåŠ¡æä¾›è€…é…ç½®**ï¼š

```yaml
eureka:
  client:
    service-url:
      # é…ç½®å¤šä¸ªæ³¨å†Œä¸­å¿ƒï¼Œç”¨é€—å·åˆ†éš”
      defaultZone: http://eureka-server-1:8761/eureka/,http://eureka-server-2:8762/eureka/,http://eureka-server-3:8763/eureka/
```

**å®¢æˆ·ç«¯è¿æ¥ç­–ç•¥**ï¼š
```
è¿æ¥é€»è¾‘ï¼š
1. å°è¯•è¿æ¥ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆeureka-server-1ï¼‰
   â†“
2. å¦‚æœå¤±è´¥ï¼Œå°è¯•ç¬¬äºŒä¸ªï¼ˆeureka-server-2ï¼‰
   â†“
3. å¦‚æœå¤±è´¥ï¼Œå°è¯•ç¬¬ä¸‰ä¸ªï¼ˆeureka-server-3ï¼‰
   â†“
4. å…¨éƒ¨å¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°ç¼“å­˜

ä¼˜åŠ¿ï¼šä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹å¯ç”¨å³å¯æ­£å¸¸å·¥ä½œ
```

---

## 6. ğŸ” å®‰å…¨è®¤è¯é…ç½®


### 6.1 æ·»åŠ Securityä¾èµ–


```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-security</artifactId>
</dependency>
```

### 6.2 é…ç½®ç”¨æˆ·è®¤è¯


**application.ymlé…ç½®**ï¼š

```yaml
spring:
  security:
    user:
      name: admin           # ç”¨æˆ·å
      password: admin123    # å¯†ç 

eureka:
  client:
    service-url:
      # å¸¦è®¤è¯çš„URLæ ¼å¼
      defaultZone: http://admin:admin123@localhost:8761/eureka/
```

### 6.3 å…³é—­CSRFä¿æŠ¤


**é…ç½®ç±»**ï¼š

```java
@Configuration
@EnableWebSecurity
public class WebSecurityConfig extends WebSecurityConfigurerAdapter {
    
    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.csrf().disable()  // å…³é—­CSRF
            .authorizeRequests()
            .anyRequest().authenticated()
            .and()
            .httpBasic();  // ä½¿ç”¨HTTP Basicè®¤è¯
    }
}
```

**ä¸ºä»€ä¹ˆè¦å…³é—­CSRFï¼Ÿ**

```
CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰ä¿æŠ¤æœºåˆ¶ï¼š
â€¢ é»˜è®¤å¼€å¯ï¼Œä¼šæ‹¦æˆªPOSTè¯·æ±‚
â€¢ Eurekaå®¢æˆ·ç«¯æ³¨å†Œæ˜¯POSTè¯·æ±‚
â€¢ å®¢æˆ·ç«¯æ²¡æœ‰CSRF Token
â€¢ å¯¼è‡´æ³¨å†Œå¤±è´¥

å…³é—­CSRFçš„å½±å“ï¼š
âš ï¸ å®‰å…¨æ€§ç•¥æœ‰é™ä½
âœ… å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼è¡¥å¿ï¼ˆIPç™½åå•ã€ç½‘ç»œéš”ç¦»ï¼‰
âœ… å†…ç½‘ç¯å¢ƒé£é™©å¯æ§
```

---

## 7. ğŸ“Š ç›‘æ§ç«¯ç‚¹é…ç½®


### 7.1 Actuatorå¥åº·æ£€æŸ¥


**æ·»åŠ ä¾èµ–**ï¼š
```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-actuator</artifactId>
</dependency>
```

**é…ç½®æ–‡ä»¶**ï¼š
```yaml
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics  # æš´éœ²ç«¯ç‚¹
  endpoint:
    health:
      show-details: always  # æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
```

### 7.2 å¸¸ç”¨ç›‘æ§ç«¯ç‚¹


**ç«¯ç‚¹åˆ—è¡¨**ï¼š

| ç«¯ç‚¹ | **è·¯å¾„** | **ä½œç”¨** |
|------|---------|---------|
| **å¥åº·æ£€æŸ¥** | `/actuator/health` | `æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€` |
| **åŸºæœ¬ä¿¡æ¯** | `/actuator/info` | `æ˜¾ç¤ºåº”ç”¨åŸºæœ¬ä¿¡æ¯` |
| **æ€§èƒ½æŒ‡æ ‡** | `/actuator/metrics` | `CPUã€å†…å­˜ã€çº¿ç¨‹ç­‰æŒ‡æ ‡` |
| **æ³¨å†Œä¿¡æ¯** | `/eureka/apps` | `æŸ¥çœ‹æ³¨å†Œçš„æœåŠ¡åˆ—è¡¨` |

**å¥åº·æ£€æŸ¥ç¤ºä¾‹**ï¼š
```bash
# è®¿é—®å¥åº·æ£€æŸ¥ç«¯ç‚¹
GET http://localhost:8761/actuator/health

# å“åº”ç¤ºä¾‹
{
  "status": "UP",
  "components": {
    "diskSpace": {
      "status": "UP",
      "details": {
        "total": 250685575168,
        "free": 100000000000
      }
    },
    "eureka": {
      "status": "UP",
      "details": {
        "applications": 3
      }
    }
  }
}
```

---

## 8. âš¡ JVMå‚æ•°ä¼˜åŒ–


### 8.1 åŸºç¡€JVMå‚æ•°


**å¯åŠ¨å‘½ä»¤**ï¼š
```bash
java -Xms1024m -Xmx2048m \
     -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=256m \
     -XX:+UseG1GC \
     -XX:MaxGCPauseMillis=200 \
     -jar eureka-server.jar
```

**å‚æ•°è¯´æ˜**ï¼š

| å‚æ•° | **ä½œç”¨** | **æ¨èå€¼** |
|------|---------|-----------|
| `-Xms` | `åˆå§‹å †å†…å­˜` | `1024mï¼ˆç”Ÿäº§2048mï¼‰` |
| `-Xmx` | `æœ€å¤§å †å†…å­˜` | `2048mï¼ˆç”Ÿäº§4096mï¼‰` |
| `-XX:MetaspaceSize` | `å…ƒç©ºé—´åˆå§‹å¤§å°` | `128m` |
| `-XX:MaxMetaspaceSize` | `å…ƒç©ºé—´æœ€å¤§å€¼` | `256m` |
| `-XX:+UseG1GC` | `ä½¿ç”¨G1åƒåœ¾å›æ”¶å™¨` | `å»ºè®®å¼€å¯` |

### 8.2 ä¸åŒåœºæ™¯çš„ä¼˜åŒ–é…ç½®


**å°è§„æ¨¡ç¯å¢ƒï¼ˆ<50ä¸ªæœåŠ¡ï¼‰**ï¼š
```bash
java -Xms512m -Xmx1024m \
     -XX:+UseG1GC \
     -jar eureka-server.jar
```

**ä¸­ç­‰è§„æ¨¡ï¼ˆ50-200ä¸ªæœåŠ¡ï¼‰**ï¼š
```bash
java -Xms2048m -Xmx4096m \
     -XX:MetaspaceSize=256m \
     -XX:MaxMetaspaceSize=512m \
     -XX:+UseG1GC \
     -XX:MaxGCPauseMillis=200 \
     -jar eureka-server.jar
```

**å¤§è§„æ¨¡ç¯å¢ƒï¼ˆ>200ä¸ªæœåŠ¡ï¼‰**ï¼š
```bash
java -Xms4096m -Xmx8192m \
     -XX:MetaspaceSize=512m \
     -XX:MaxMetaspaceSize=1024m \
     -XX:+UseG1GC \
     -XX:MaxGCPauseMillis=100 \
     -XX:+HeapDumpOnOutOfMemoryError \
     -XX:HeapDumpPath=/logs/eureka-heap.dump \
     -jar eureka-server.jar
```

### 8.3 æ€§èƒ½ç›‘æ§ä¸è°ƒä¼˜


**å…³é”®æŒ‡æ ‡ç›‘æ§**ï¼š
```
âœ… å †å†…å­˜ä½¿ç”¨ç‡ï¼šä¿æŒåœ¨70%ä»¥ä¸‹
âœ… GCé¢‘ç‡ï¼šFull GC < 1æ¬¡/å°æ—¶
âœ… GCåœé¡¿æ—¶é—´ï¼š< 200ms
âœ… çº¿ç¨‹æ•°ï¼š< 500ä¸ª
âœ… CPUä½¿ç”¨ç‡ï¼š< 60%
```

**å¸¸è§æ€§èƒ½é—®é¢˜**ï¼š

```
é—®é¢˜1ï¼šé¢‘ç¹Full GC
åŸå› ï¼šå †å†…å­˜ä¸è¶³
è§£å†³ï¼šå¢å¤§-Xmxå‚æ•°

é—®é¢˜2ï¼šå†…å­˜æ³„æ¼
åŸå› ï¼šæ³¨å†Œè¡¨æ•°æ®æœªæ¸…ç†
è§£å†³ï¼šé…ç½®åˆç†çš„å‰”é™¤é—´éš”

é—®é¢˜3ï¼šå“åº”å˜æ…¢
åŸå› ï¼šæ³¨å†ŒæœåŠ¡æ•°è¿‡å¤š
è§£å†³ï¼šå¼€å¯å“åº”ç¼“å­˜ï¼Œè°ƒæ•´ç¼“å­˜æ—¶é—´
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 æ­å»ºæ­¥éª¤é€Ÿè®°


```
ç¬¬1æ­¥ï¼šæ·»åŠ ä¾èµ–
    spring-cloud-starter-netflix-eureka-server

ç¬¬2æ­¥ï¼šå¯ç”¨æ³¨è§£
    @EnableEurekaServer

ç¬¬3æ­¥ï¼šé…ç½®æ–‡ä»¶
    å•æœºæ¨¡å¼ï¼šregister-with-eureka=false
    é›†ç¾¤æ¨¡å¼ï¼šregister-with-eureka=true

ç¬¬4æ­¥ï¼šå¯åŠ¨æœåŠ¡
    è®¿é—® http://localhost:8761
```

### 9.2 å…³é”®é…ç½®å¯¹ç…§è¡¨


| åœºæ™¯ | **register-with-eureka** | **fetch-registry** | **service-url** |
|------|------------------------|-------------------|-----------------|
| **å•æœºServer** | `false` | `false` | `æŒ‡å‘è‡ªå·±` |
| **é›†ç¾¤Server** | `true` | `true` | `æŒ‡å‘å…¶ä»–èŠ‚ç‚¹` |
| **Clientç«¯** | `true` | `true` | `æŒ‡å‘Server` |

### 9.3 ç¯å¢ƒé…ç½®å»ºè®®


**å¼€å‘ç¯å¢ƒ**ï¼š
```
âœ… å•æœºéƒ¨ç½²
âœ… å…³é—­è‡ªæˆ‘ä¿æŠ¤
âœ… å¿«é€Ÿå‰”é™¤ï¼ˆ10ç§’ï¼‰
âœ… ä¸é…ç½®å®‰å…¨è®¤è¯
```

**ç”Ÿäº§ç¯å¢ƒ**ï¼š
```
âœ… é›†ç¾¤éƒ¨ç½²ï¼ˆè‡³å°‘3èŠ‚ç‚¹ï¼‰
âœ… å¼€å¯è‡ªæˆ‘ä¿æŠ¤
âœ… æ­£å¸¸å‰”é™¤ï¼ˆ60ç§’ï¼‰
âœ… é…ç½®å®‰å…¨è®¤è¯
âœ… é…ç½®JVMå‚æ•°
âœ… å¼€å¯ç›‘æ§ç«¯ç‚¹
```

### 9.4 å¸¸è§é—®é¢˜è‡ªæ£€æ¸…å•


**å¯åŠ¨é—®é¢˜**ï¼š
```
â˜‘ï¸ ä¾èµ–ç‰ˆæœ¬æ˜¯å¦å…¼å®¹ï¼Ÿ
â˜‘ï¸ @EnableEurekaServeræ³¨è§£æ˜¯å¦æ·»åŠ ï¼Ÿ
â˜‘ï¸ ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼Ÿ
â˜‘ï¸ é…ç½®æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼Ÿ
```

**é›†ç¾¤é—®é¢˜**ï¼š
```
â˜‘ï¸ hostsæ–‡ä»¶æ˜¯å¦é…ç½®ï¼Ÿ
â˜‘ï¸ service-urlæ˜¯å¦æŒ‡å‘å…¶ä»–èŠ‚ç‚¹ï¼Ÿ
â˜‘ï¸ register-with-eurekaæ˜¯å¦ä¸ºtrueï¼Ÿ
â˜‘ï¸ èŠ‚ç‚¹é—´ç½‘ç»œæ˜¯å¦è¿é€šï¼Ÿ
```

**æ€§èƒ½é—®é¢˜**ï¼š
```
â˜‘ï¸ JVMå†…å­˜æ˜¯å¦å……è¶³ï¼Ÿ
â˜‘ï¸ GCæ˜¯å¦é¢‘ç¹ï¼Ÿ
â˜‘ï¸ æ³¨å†ŒæœåŠ¡æ•°æ˜¯å¦è¿‡å¤šï¼Ÿ
â˜‘ï¸ å‰”é™¤é—´éš”æ˜¯å¦åˆç†ï¼Ÿ
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
Serveræ­å»ºä¸‰æ­¥èµ°ï¼Œä¾èµ–æ³¨è§£é…ç½®å…¨
å•æœºé›†ç¾¤åŒºåˆ«å¤§ï¼Œregisterå‚æ•°è¦è®°ç‰¢
å®‰å…¨è®¤è¯åŠ Securityï¼ŒCSRFè®°å¾—è¦å…³é—­
ç›‘æ§ä¼˜åŒ–ä¸èƒ½å°‘ï¼ŒJVMå‚æ•°è°ƒåˆ°å¥½
```