---
title: 2ã€æœåŠ¡è°ƒç”¨å®¢æˆ·ç«¯é›†æˆ
---
## ğŸ“š ç›®å½•

1. [æœåŠ¡è°ƒç”¨å®¢æˆ·ç«¯æ¦‚è¿°](#1-æœåŠ¡è°ƒç”¨å®¢æˆ·ç«¯æ¦‚è¿°)
2. [RestTemplateé›†æˆ](#2-RestTemplateé›†æˆ)
3. [WebClienté›†æˆ](#3-WebClienté›†æˆ)
4. [OpenFeignå£°æ˜å¼è°ƒç”¨](#4-OpenFeignå£°æ˜å¼è°ƒç”¨)
5. [HTTPå®¢æˆ·ç«¯é…ç½®](#5-HTTPå®¢æˆ·ç«¯é…ç½®)
6. [è¶…æ—¶é…ç½®ç®¡ç†](#6-è¶…æ—¶é…ç½®ç®¡ç†)
7. [å¼‚å¸¸å¤„ç†ç­–ç•¥](#7-å¼‚å¸¸å¤„ç†ç­–ç•¥)
8. [é‡è¯•æœºåˆ¶å®ç°](#8-é‡è¯•æœºåˆ¶å®ç°)
9. [ç†”æ–­å™¨é›†æˆ](#9-ç†”æ–­å™¨é›†æˆ)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ æœåŠ¡è°ƒç”¨å®¢æˆ·ç«¯æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯æœåŠ¡è°ƒç”¨å®¢æˆ·ç«¯


**é€šä¿—ç†è§£**ï¼š
```
ç”Ÿæ´»ä¸­çš„åœºæ™¯ï¼š
ä½ åœ¨é¤å…ç‚¹é¤ â†’ æœåŠ¡å‘˜è®°å½• â†’ å¨æˆ¿åšèœ â†’ æœåŠ¡å‘˜é€æ¥
                â†‘
            è¿™å°±æ˜¯"è°ƒç”¨å®¢æˆ·ç«¯"çš„è§’è‰²

å¾®æœåŠ¡åœºæ™¯ï¼š
è®¢å•æœåŠ¡è°ƒç”¨åº“å­˜æœåŠ¡ â†’ æ£€æŸ¥åº“å­˜ â†’ è¿”å›ç»“æœ
              â†‘
         éœ€è¦ä¸€ä¸ª"å®¢æˆ·ç«¯"æ¥å‘èµ·è¿™ä¸ªè°ƒç”¨
```

**æ ¸å¿ƒå®šä¹‰**ï¼š
```
æœåŠ¡è°ƒç”¨å®¢æˆ·ç«¯ = å‘èµ·HTTPè¯·æ±‚çš„å·¥å…·
ä½œç”¨ï¼šè®©ä¸€ä¸ªæœåŠ¡èƒ½å¤Ÿè°ƒç”¨å¦ä¸€ä¸ªæœåŠ¡çš„æ¥å£
æœ¬è´¨ï¼šå°è£…HTTPé€šä¿¡çš„å¤æ‚ç»†èŠ‚ï¼Œæä¾›ç®€å•æ˜“ç”¨çš„API
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡è°ƒç”¨å®¢æˆ·ç«¯


**ğŸ¯ è§£å†³çš„é—®é¢˜**ï¼š

```
é—®é¢˜1ï¼šæœåŠ¡é—´å¦‚ä½•é€šä¿¡ï¼Ÿ
ä¼ ç»Ÿæ–¹å¼ï¼šæ‰‹åŠ¨æ‹¼æ¥URLã€è®¾ç½®è¯·æ±‚å¤´ã€è§£æå“åº”
å®¢æˆ·ç«¯æ–¹å¼ï¼šè‡ªåŠ¨å®Œæˆè¿™äº›ç¹çå·¥ä½œ

é—®é¢˜2ï¼šå¦‚ä½•å®ç°è´Ÿè½½å‡è¡¡ï¼Ÿ
ä¼ ç»Ÿæ–¹å¼ï¼šè‡ªå·±ç»´æŠ¤æœåŠ¡å™¨åˆ—è¡¨
å®¢æˆ·ç«¯æ–¹å¼ï¼šè‡ªåŠ¨ä»æ³¨å†Œä¸­å¿ƒè·å–å¯ç”¨æœåŠ¡

é—®é¢˜3ï¼šå¦‚ä½•å¤„ç†å¤±è´¥ï¼Ÿ
ä¼ ç»Ÿæ–¹å¼ï¼šæ‰‹åŠ¨ç¼–å†™é‡è¯•ã€ç†”æ–­é€»è¾‘
å®¢æˆ·ç«¯æ–¹å¼ï¼šå†…ç½®å®¹é”™æœºåˆ¶
```

### 1.3 ä¸‰ç§ä¸»æµå®¢æˆ·ç«¯å¯¹æ¯”


| å®¢æˆ·ç«¯ç±»å‹ | **ç‰¹ç‚¹** | **é€‚ç”¨åœºæ™¯** | **å­¦ä¹ éš¾åº¦** |
|-----------|---------|-------------|-------------|
| ğŸ”§ **RestTemplate** | `åŒæ­¥é˜»å¡ï¼ŒSpringä¼ ç»Ÿå·¥å…·` | `ç®€å•çš„HTTPè°ƒç”¨` | â­ ç®€å• |
| âš¡ **WebClient** | `å¼‚æ­¥éé˜»å¡ï¼Œå“åº”å¼ç¼–ç¨‹` | `é«˜å¹¶å‘ã€æµå¼å¤„ç†` | â­â­ ä¸­ç­‰ |
| ğŸ¯ **OpenFeign** | `å£°æ˜å¼è°ƒç”¨ï¼Œä»£ç æœ€ç®€æ´` | `å¾®æœåŠ¡é—´è°ƒç”¨` | â­â­â­ éœ€è¦ç†è§£ |

**ğŸ”— è°ƒç”¨æµç¨‹å¯¹æ¯”**ï¼š
```
RestTemplateæµç¨‹ï¼š
æœåŠ¡A â†’ RestTemplate â†’ æ‰‹åŠ¨æŒ‡å®šURL â†’ æœåŠ¡B

WebClientæµç¨‹ï¼š
æœåŠ¡A â†’ WebClient â†’ å¼‚æ­¥å¤„ç† â†’ æœåŠ¡B

OpenFeignæµç¨‹ï¼š
æœåŠ¡A â†’ æ¥å£å®šä¹‰ â†’ Feignè‡ªåŠ¨å®ç° â†’ æœåŠ¡B
```

---

## 2. ğŸ”§ RestTemplateé›†æˆ


### 2.1 RestTemplateåŸºæœ¬æ¦‚å¿µ


**ğŸ’¡ é€šä¿—ç†è§£**ï¼š
```
RestTemplateå°±åƒä¸€ä¸ª"å¿«é€’å‘˜"ï¼š
- ä½ ç»™ä»–åŒ…è£¹ï¼ˆè¯·æ±‚æ•°æ®ï¼‰
- å‘Šè¯‰ä»–åœ°å€ï¼ˆURLï¼‰
- ä»–å¸®ä½ é€åˆ°ç›®çš„åœ°å¹¶å¸¦å›å›æ‰§ï¼ˆå“åº”ï¼‰

ç‰¹ç‚¹ï¼š
âœ… åŒæ­¥è°ƒç”¨ï¼šå‘å‡ºè¯·æ±‚åç­‰å¾…å“åº”
âœ… ç®€å•ç›´æ¥ï¼šä»£ç æ˜“æ‡‚
âŒ é˜»å¡çº¿ç¨‹ï¼šç­‰å¾…æœŸé—´å½“å‰çº¿ç¨‹ä¸èƒ½åšå…¶ä»–äº‹
```

### 2.2 é…ç½®ä¸ä½¿ç”¨


**ğŸ“¦ ä¾èµ–é…ç½®**ï¼š
```xml
<!-- Spring Webå·²åŒ…å«RestTemplate -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
</dependency>
```

**âš™ï¸ åŸºç¡€é…ç½®ç±»**ï¼š
```java
@Configuration
public class RestTemplateConfig {
    
    @Bean
    @LoadBalanced  // å¼€å¯è´Ÿè½½å‡è¡¡
    public RestTemplate restTemplate() {
        return new RestTemplate();
    }
}
```

> **ğŸ”‘ å…³é”®ç‚¹**ï¼š`@LoadBalanced`æ³¨è§£è®©RestTemplateå…·å¤‡ä»æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡å¹¶è´Ÿè½½å‡è¡¡çš„èƒ½åŠ›

### 2.3 åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹


**ğŸ“ GETè¯·æ±‚**ï¼š
```java
@Service
public class OrderService {
    
    @Autowired
    private RestTemplate restTemplate;
    
    // æ–¹å¼1ï¼šç›´æ¥è·å–å¯¹è±¡
    public Product getProduct(Long id) {
        String url = "http://product-service/product/" + id;
        return restTemplate.getForObject(url, Product.class);
    }
    
    // æ–¹å¼2ï¼šè·å–å®Œæ•´å“åº”ï¼ˆåŒ…å«çŠ¶æ€ç ã€å“åº”å¤´ï¼‰
    public ResponseEntity<Product> getProductDetail(Long id) {
        String url = "http://product-service/product/" + id;
        return restTemplate.getForEntity(url, Product.class);
    }
}
```

**ğŸ“ POSTè¯·æ±‚**ï¼š
```java
// æäº¤è®¢å•
public Order createOrder(OrderDTO orderDTO) {
    String url = "http://order-service/order/create";
    return restTemplate.postForObject(url, orderDTO, Order.class);
}
```

**ğŸ” URLæ„å»ºæŠ€å·§**ï¼š
```java
// ä½¿ç”¨å ä½ç¬¦ï¼ˆæ¨èï¼‰
String url = "http://product-service/product/{id}";
Product product = restTemplate.getForObject(url, Product.class, productId);

// ä½¿ç”¨UriComponentsBuilderæ„å»ºå¤æ‚URL
String url = UriComponentsBuilder
    .fromHttpUrl("http://product-service/product/search")
    .queryParam("keyword", "æ‰‹æœº")
    .queryParam("page", 1)
    .toUriString();
```

### 2.4 è´Ÿè½½å‡è¡¡åŸç†


**ğŸ”„ å·¥ä½œæœºåˆ¶**ï¼š
```
è°ƒç”¨æµç¨‹ï¼š
1. ä»£ç ä¸­å†™æœåŠ¡åï¼šhttp://product-service/xxx
2. RestTemplateæ‹¦æˆªè¯·æ±‚
3. ä»Eurekaè·å–product-serviceçš„å®ä¾‹åˆ—è¡¨
   ä¾‹å¦‚ï¼š[192.168.1.10:8081, 192.168.1.11:8081]
4. ä½¿ç”¨è´Ÿè½½å‡è¡¡ç®—æ³•é€‰æ‹©ä¸€ä¸ªå®ä¾‹
5. æ›¿æ¢URLï¼šhttp://192.168.1.10:8081/xxx
6. å‘èµ·çœŸå®HTTPè¯·æ±‚
```

**âš–ï¸ è´Ÿè½½å‡è¡¡ç­–ç•¥**ï¼š
```java
// è‡ªå®šä¹‰è´Ÿè½½å‡è¡¡ç­–ç•¥
@Configuration
public class LoadBalanceConfig {
    
    @Bean
    public IRule ribbonRule() {
        // è½®è¯¢ç­–ç•¥ï¼ˆé»˜è®¤ï¼‰
        return new RoundRobinRule();
        
        // éšæœºç­–ç•¥
        // return new RandomRule();
        
        // é‡è¯•ç­–ç•¥
        // return new RetryRule();
    }
}
```

---

## 3. âš¡ WebClienté›†æˆ


### 3.1 WebClientåŸºæœ¬æ¦‚å¿µ


**ğŸ’¡ é€šä¿—ç†è§£**ï¼š
```
RestTemplate vs WebClientï¼š

RestTemplateåƒ"åŒæ­¥å¿«é€’"ï¼š
å¯„å¿«é€’ â†’ ç­‰å¾…é€è¾¾ â†’ æ”¶åˆ°å›æ‰§ â†’ ç»§ç»­å·¥ä½œ
         (æœŸé—´ä¸èƒ½åšå…¶ä»–äº‹)

WebClientåƒ"å¼‚æ­¥å¤–å–"ï¼š
ç‚¹å¤–å– â†’ ç»§ç»­å·¥ä½œ â†’ å¤–å–åˆ°äº†é€šçŸ¥ä½ 
        (æœŸé—´å¯ä»¥åšå…¶ä»–äº‹)
```

**ğŸ¯ æ ¸å¿ƒç‰¹ç‚¹**ï¼š
```
âœ… éé˜»å¡ï¼šä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹
âœ… å“åº”å¼ï¼šåŸºäºReactorå“åº”å¼ç¼–ç¨‹
âœ… é«˜æ€§èƒ½ï¼šé€‚åˆé«˜å¹¶å‘åœºæ™¯
âœ… æµå¼å¤„ç†ï¼šæ”¯æŒæœåŠ¡ç«¯æ¨é€ï¼ˆSSEï¼‰
```

### 3.2 é…ç½®ä¸ä½¿ç”¨


**ğŸ“¦ ä¾èµ–é…ç½®**ï¼š
```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-webflux</artifactId>
</dependency>
```

**âš™ï¸ é…ç½®ç±»**ï¼š
```java
@Configuration
public class WebClientConfig {
    
    @Bean
    public WebClient.Builder webClientBuilder() {
        return WebClient.builder();
    }
    
    @Bean
    @LoadBalanced  // æ”¯æŒè´Ÿè½½å‡è¡¡
    public WebClient webClient(WebClient.Builder builder) {
        return builder.build();
    }
}
```

### 3.3 åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹


**ğŸ“ GETè¯·æ±‚ï¼ˆå“åº”å¼ï¼‰**ï¼š
```java
@Service
public class ProductService {
    
    @Autowired
    private WebClient webClient;
    
    // è¿”å›Monoï¼ˆå•ä¸ªç»“æœï¼‰
    public Mono<Product> getProduct(Long id) {
        return webClient.get()
            .uri("http://product-service/product/{id}", id)
            .retrieve()
            .bodyToMono(Product.class);
    }
    
    // è¿”å›Fluxï¼ˆå¤šä¸ªç»“æœï¼‰
    public Flux<Product> getAllProducts() {
        return webClient.get()
            .uri("http://product-service/product/list")
            .retrieve()
            .bodyToFlux(Product.class);
    }
}
```

**ğŸ“ POSTè¯·æ±‚**ï¼š
```java
public Mono<Order> createOrder(OrderDTO orderDTO) {
    return webClient.post()
        .uri("http://order-service/order/create")
        .bodyValue(orderDTO)  // è¯·æ±‚ä½“
        .retrieve()
        .bodyToMono(Order.class);
}
```

**ğŸ”„ å“åº”å¼è°ƒç”¨é“¾**ï¼š
```java
// è°ƒç”¨å¤šä¸ªæœåŠ¡å¹¶ç»„åˆç»“æœ
public Mono<OrderResult> processOrder(Long orderId) {
    return getOrder(orderId)  // 1. è·å–è®¢å•
        .flatMap(order -> getProduct(order.getProductId())  // 2. è·å–å•†å“
            .map(product -> {
                // 3. ç»„åˆç»“æœ
                OrderResult result = new OrderResult();
                result.setOrder(order);
                result.setProduct(product);
                return result;
            })
        );
}
```

### 3.4 é˜»å¡ä¸éé˜»å¡å¯¹æ¯”


**â±ï¸ æ€§èƒ½å¯¹æ¯”**ï¼š
```
åœºæ™¯ï¼šè°ƒç”¨3ä¸ªæœåŠ¡ï¼Œæ¯ä¸ªè€—æ—¶1ç§’

RestTemplateï¼ˆåŒæ­¥ï¼‰ï¼š
è°ƒç”¨A(1ç§’) â†’ è°ƒç”¨B(1ç§’) â†’ è°ƒç”¨C(1ç§’) = æ€»å…±3ç§’

WebClientï¼ˆå¼‚æ­¥ï¼‰ï¼š
åŒæ—¶è°ƒç”¨Aã€Bã€C â†’ ç­‰å¾…æœ€æ…¢çš„å®Œæˆ = æ€»å…±1ç§’
```

---

## 4. ğŸ¯ OpenFeignå£°æ˜å¼è°ƒç”¨


### 4.1 FeignåŸºæœ¬æ¦‚å¿µ


**ğŸ’¡ é€šä¿—ç†è§£**ï¼š
```
ä¼ ç»Ÿè°ƒç”¨æ–¹å¼ï¼š
éœ€è¦å†™å¾ˆå¤šä»£ç ï¼šåˆ›å»ºå®¢æˆ·ç«¯ã€æ‹¼æ¥URLã€è®¾ç½®å‚æ•°...

Feignæ–¹å¼ï¼š
åªéœ€è¦å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œå‰©ä¸‹çš„Feignå¸®ä½ åšï¼

å°±åƒç‚¹å¤–å–ï¼š
ä¼ ç»Ÿï¼šè‡ªå·±å»é¥­åº—ã€ç‚¹èœã€ç­‰å¾…ã€å–é¤
Feignï¼šåœ¨APPä¸Šç‚¹å‡»å‡ ä¸‹ï¼Œå¤–å–è‡ªåŠ¨é€æ¥
```

**ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿**ï¼š
```
âœ… å£°æ˜å¼ï¼šæ¥å£å®šä¹‰å³è°ƒç”¨å®ç°
âœ… ç®€æ´ï¼šä»£ç é‡æœ€å°‘
âœ… é›†æˆå¥½ï¼šå¤©ç„¶æ”¯æŒSpring Cloud
âœ… åŠŸèƒ½å¼ºï¼šè‡ªåŠ¨æ”¯æŒè´Ÿè½½å‡è¡¡ã€ç†”æ–­ã€é‡è¯•
```

### 4.2 å¿«é€Ÿå…¥é—¨


**ğŸ“¦ ä¾èµ–é…ç½®**ï¼š
```xml
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-openfeign</artifactId>
</dependency>
```

**âš™ï¸ å¯ç”¨Feign**ï¼š
```java
@SpringBootApplication
@EnableFeignClients  // å¯ç”¨Feignå®¢æˆ·ç«¯æ‰«æ
public class OrderApplication {
    public static void main(String[] args) {
        SpringApplication.run(OrderApplication.class, args);
    }
}
```

### 4.3 æ¥å£å®šä¹‰


**ğŸ“ åŸºç¡€æ¥å£**ï¼š
```java
@FeignClient(name = "product-service")  // æŒ‡å®šæœåŠ¡å
public interface ProductClient {
    
    // GETè¯·æ±‚
    @GetMapping("/product/{id}")
    Product getProduct(@PathVariable("id") Long id);
    
    // POSTè¯·æ±‚
    @PostMapping("/product/create")
    Product createProduct(@RequestBody ProductDTO dto);
    
    // å¸¦æŸ¥è¯¢å‚æ•°
    @GetMapping("/product/search")
    List<Product> searchProducts(@RequestParam("keyword") String keyword);
}
```

**ğŸ”§ ä½¿ç”¨æ¥å£**ï¼š
```java
@Service
public class OrderService {
    
    @Autowired
    private ProductClient productClient;  // æ³¨å…¥Feignå®¢æˆ·ç«¯
    
    public void createOrder(Long productId) {
        // åƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·ç®€å•ï¼
        Product product = productClient.getProduct(productId);
        
        // å¤„ç†ä¸šåŠ¡é€»è¾‘...
    }
}
```

### 4.4 é«˜çº§é…ç½®


**âš™ï¸ è‡ªå®šä¹‰é…ç½®ç±»**ï¼š
```java
@Configuration
public class FeignConfig {
    
    // é…ç½®æ—¥å¿—çº§åˆ«
    @Bean
    public Logger.Level feignLogLevel() {
        return Logger.Level.FULL;  // è®°å½•å®Œæ•´è¯·æ±‚å“åº”
    }
    
    // é…ç½®è¶…æ—¶æ—¶é—´
    @Bean
    public Request.Options options() {
        return new Request.Options(
            5000,  // è¿æ¥è¶…æ—¶5ç§’
            10000  // è¯»å–è¶…æ—¶10ç§’
        );
    }
}
```

**ğŸ“ åº”ç”¨é…ç½®**ï¼š
```java
@FeignClient(
    name = "product-service",
    configuration = FeignConfig.class  // ä½¿ç”¨è‡ªå®šä¹‰é…ç½®
)
public interface ProductClient {
    // ...
}
```

### 4.5 Feignå·¥ä½œåŸç†


**ğŸ” æ‰§è¡Œæµç¨‹**ï¼š
```
è°ƒç”¨æµç¨‹ï¼š
1. ä»£ç è°ƒç”¨ï¼šproductClient.getProduct(1L)
2. Feignæ‹¦æˆªï¼šæ£€æµ‹åˆ°@FeignClientæ³¨è§£
3. æ„å»ºè¯·æ±‚ï¼š
   - æœåŠ¡åï¼šproduct-service
   - è·¯å¾„ï¼š/product/1
   - æ–¹æ³•ï¼šGET
4. è´Ÿè½½å‡è¡¡ï¼šä»æ³¨å†Œä¸­å¿ƒè·å–å®ä¾‹å¹¶é€‰æ‹©
5. å‘èµ·è°ƒç”¨ï¼šhttp://192.168.1.10:8081/product/1
6. è¿”å›ç»“æœï¼šå°†JSONè½¬æ¢ä¸ºProductå¯¹è±¡
```

---

## 5. ğŸ› ï¸ HTTPå®¢æˆ·ç«¯é…ç½®


### 5.1 åº•å±‚HTTPå®¢æˆ·ç«¯é€‰æ‹©


**ğŸ”§ å¯é€‰çš„HTTPå®¢æˆ·ç«¯**ï¼š

| å®¢æˆ·ç«¯ | **ç‰¹ç‚¹** | **æ€§èƒ½** | **ä½¿ç”¨åœºæ™¯** |
|--------|---------|---------|-------------|
| **HttpURLConnection** | `JDKè‡ªå¸¦ï¼Œæ— éœ€ä¾èµ–` | â­â­ ä¸€èˆ¬ | `ç®€å•åœºæ™¯` |
| **Apache HttpClient** | `åŠŸèƒ½ä¸°å¯Œï¼Œç¨³å®š` | â­â­â­ è‰¯å¥½ | `ä¼ä¸šçº§åº”ç”¨` |
| **OkHttp** | `ç°ä»£åŒ–ï¼Œæ€§èƒ½å¥½` | â­â­â­â­ ä¼˜ç§€ | `é«˜æ€§èƒ½è¦æ±‚` |

**ğŸ“¦ åˆ‡æ¢åˆ°OkHttp**ï¼š
```xml
<!-- æ·»åŠ ä¾èµ– -->
<dependency>
    <groupId>io.github.openfeign</groupId>
    <artifactId>feign-okhttp</artifactId>
</dependency>
```

```yaml
# application.ymlé…ç½®
feign:
  okhttp:
    enabled: true  # å¯ç”¨OkHttp
  httpclient:
    enabled: false  # ç¦ç”¨é»˜è®¤HttpClient
```

### 5.2 è¿æ¥æ± é…ç½®


**ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦è¿æ¥æ± **ï¼š
```
æ²¡æœ‰è¿æ¥æ± ï¼š
æ¯æ¬¡è¯·æ±‚ â†’ å»ºç«‹TCPè¿æ¥ â†’ å‘é€è¯·æ±‚ â†’ å…³é—­è¿æ¥
           (è€—æ—¶100ms)      (è€—æ—¶10ms)

æœ‰è¿æ¥æ± ï¼š
é¦–æ¬¡è¯·æ±‚ â†’ å»ºç«‹è¿æ¥ â†’ æ”¾å…¥æ± ä¸­
åç»­è¯·æ±‚ â†’ ä»æ± ä¸­å– â†’ å‘é€è¯·æ±‚ï¼ˆçœå»100msï¼‰
```

**âš™ï¸ OkHttpè¿æ¥æ± é…ç½®**ï¼š
```java
@Configuration
public class OkHttpConfig {
    
    @Bean
    public okhttp3.OkHttpClient okHttpClient() {
        return new okhttp3.OkHttpClient.Builder()
            .connectionPool(new ConnectionPool(
                50,              // æœ€å¤§ç©ºé—²è¿æ¥æ•°
                5,               // è¿æ¥å­˜æ´»æ—¶é—´
                TimeUnit.MINUTES // æ—¶é—´å•ä½
            ))
            .connectTimeout(5, TimeUnit.SECONDS)  // è¿æ¥è¶…æ—¶
            .readTimeout(10, TimeUnit.SECONDS)    // è¯»å–è¶…æ—¶
            .writeTimeout(10, TimeUnit.SECONDS)   // å†™å…¥è¶…æ—¶
            .build();
    }
}
```

### 5.3 è¯·æ±‚æ‹¦æˆªå™¨


**ğŸ” æ‹¦æˆªå™¨çš„ä½œç”¨**ï¼š
```
è¯·æ±‚å‘å‡ºå‰ï¼š
â†’ æ·»åŠ è®¤è¯Token
â†’ æ·»åŠ è¿½è¸ªID
â†’ è®°å½•è¯·æ±‚æ—¥å¿—

å“åº”è¿”å›åï¼š
â†’ ç»Ÿä¸€å¤„ç†é”™è¯¯
â†’ è®°å½•å“åº”æ—¶é—´
â†’ è§£å¯†å“åº”æ•°æ®
```

**ğŸ“ è‡ªå®šä¹‰æ‹¦æˆªå™¨**ï¼š
```java
@Component
public class FeignRequestInterceptor implements RequestInterceptor {
    
    @Override
    public void apply(RequestTemplate template) {
        // æ·»åŠ è¯·æ±‚å¤´
        template.header("Authorization", "Bearer xxx");
        
        // æ·»åŠ è¿½è¸ªID
        String traceId = MDC.get("traceId");
        if (traceId != null) {
            template.header("X-Trace-Id", traceId);
        }
        
        // è®°å½•è¯·æ±‚æ—¥å¿—
        log.info("Feignè¯·æ±‚: {} {}", template.method(), template.url());
    }
}
```

---

## 6. â±ï¸ è¶…æ—¶é…ç½®ç®¡ç†


### 6.1 è¶…æ—¶çš„é‡è¦æ€§


**ğŸ’¡ ä¸ºä»€ä¹ˆè¦è®¾ç½®è¶…æ—¶**ï¼š
```
æ²¡æœ‰è¶…æ—¶çš„é—®é¢˜ï¼š
è°ƒç”¨æœåŠ¡B â†’ Bå“åº”æ…¢(30ç§’) â†’ å½“å‰çº¿ç¨‹è¢«å ç”¨30ç§’
                              â†“
                        å…¶ä»–è¯·æ±‚ä¹Ÿå˜æ…¢ï¼Œç³»ç»Ÿé›ªå´©

è®¾ç½®è¶…æ—¶åï¼š
è°ƒç”¨æœåŠ¡B â†’ è¶…è¿‡3ç§’æœªå“åº” â†’ ç«‹å³å¤±è´¥ â†’ é‡Šæ”¾çº¿ç¨‹
                            â†“
                     ä¸å½±å“å…¶ä»–è¯·æ±‚
```

### 6.2 å¤šå±‚çº§è¶…æ—¶é…ç½®


**ğŸ”§ è¶…æ—¶é…ç½®çš„ä¸‰ä¸ªå±‚æ¬¡**ï¼š

```
å±‚æ¬¡1: å…¨å±€é…ç½®ï¼ˆé»˜è®¤ï¼‰
  â†“
å±‚æ¬¡2: æœåŠ¡çº§é…ç½®ï¼ˆé’ˆå¯¹æŸä¸ªæœåŠ¡ï¼‰
  â†“  
å±‚æ¬¡3: æ–¹æ³•çº§é…ç½®ï¼ˆé’ˆå¯¹æŸä¸ªæ¥å£æ–¹æ³•ï¼‰

ä¼˜å…ˆçº§ï¼šæ–¹æ³•çº§ > æœåŠ¡çº§ > å…¨å±€
```

**ğŸ“ é…ç½®ç¤ºä¾‹**ï¼š
```yaml
# application.yml
feign:
  client:
    config:
      default:  # å…¨å±€é…ç½®
        connectTimeout: 5000   # è¿æ¥è¶…æ—¶5ç§’
        readTimeout: 10000     # è¯»å–è¶…æ—¶10ç§’
      
      product-service:  # é’ˆå¯¹product-serviceçš„é…ç½®
        connectTimeout: 3000
        readTimeout: 8000
```

**ğŸ”§ ä»£ç çº§é…ç½®**ï¼š
```java
@FeignClient(
    name = "product-service",
    configuration = ProductFeignConfig.class
)
public interface ProductClient {
    // ...
}

@Configuration
class ProductFeignConfig {
    @Bean
    public Request.Options options() {
        return new Request.Options(
            3000,  // è¿æ¥è¶…æ—¶
            8000   // è¯»å–è¶…æ—¶
        );
    }
}
```

### 6.3 è¶…æ—¶æœ€ä½³å®è·µ


**ğŸ¯ æ¨èé…ç½®å€¼**ï¼š

| æœåŠ¡ç±»å‹ | **è¿æ¥è¶…æ—¶** | **è¯»å–è¶…æ—¶** | **è¯´æ˜** |
|---------|------------|------------|---------|
| **æŸ¥è¯¢æœåŠ¡** | `2-3ç§’` | `5-10ç§’` | `å¿«é€Ÿå“åº”` |
| **å†™å…¥æœåŠ¡** | `3-5ç§’` | `10-20ç§’` | `å…è®¸è¾ƒé•¿å¤„ç†` |
| **æ‰¹é‡æ“ä½œ** | `5ç§’` | `30-60ç§’` | `éœ€è¦æ›´é•¿æ—¶é—´` |
| **å¤–éƒ¨API** | `5ç§’` | `15ç§’` | `ç½‘ç»œä¸ç¨³å®š` |

---

## 7. ğŸš¨ å¼‚å¸¸å¤„ç†ç­–ç•¥


### 7.1 å¸¸è§å¼‚å¸¸ç±»å‹


**âš ï¸ è°ƒç”¨å¤±è´¥çš„æƒ…å†µ**ï¼š
```
ç½‘ç»œå¼‚å¸¸ï¼š
â†’ è¿æ¥è¶…æ—¶ï¼šæ‰¾ä¸åˆ°æœåŠ¡
â†’ è¯»å–è¶…æ—¶ï¼šæœåŠ¡å“åº”æ…¢
â†’ ç½‘ç»œä¸­æ–­ï¼šç½‘ç»œæ•…éšœ

ä¸šåŠ¡å¼‚å¸¸ï¼š
â†’ 4xxé”™è¯¯ï¼šå®¢æˆ·ç«¯è¯·æ±‚é”™è¯¯
â†’ 5xxé”™è¯¯ï¼šæœåŠ¡ç«¯å¤„ç†é”™è¯¯

å…¶ä»–å¼‚å¸¸ï¼š
â†’ æœåŠ¡é™çº§ï¼šç†”æ–­å™¨è§¦å‘
â†’ ç¼–ç å¼‚å¸¸ï¼šæ•°æ®è½¬æ¢å¤±è´¥
```

### 7.2 å…¨å±€å¼‚å¸¸å¤„ç†


**ğŸ“ Feignå¼‚å¸¸è§£ç å™¨**ï¼š
```java
@Component
public class FeignErrorDecoder implements ErrorDecoder {
    
    @Override
    public Exception decode(String methodKey, Response response) {
        int status = response.status();
        
        // æ ¹æ®çŠ¶æ€ç è¿”å›ä¸åŒå¼‚å¸¸
        if (status >= 400 && status < 500) {
            // 4xxå®¢æˆ·ç«¯é”™è¯¯
            return new BusinessException("è¯·æ±‚å‚æ•°é”™è¯¯");
        }
        
        if (status >= 500 && status < 600) {
            // 5xxæœåŠ¡ç«¯é”™è¯¯
            return new ServiceException("æœåŠ¡æš‚æ—¶ä¸å¯ç”¨");
        }
        
        // é»˜è®¤å¤„ç†
        return new RuntimeException("è°ƒç”¨å¤±è´¥: " + status);
    }
}
```

**ğŸ”§ æ³¨å†Œè§£ç å™¨**ï¼š
```java
@Configuration
public class FeignConfig {
    
    @Bean
    public ErrorDecoder errorDecoder() {
        return new FeignErrorDecoder();
    }
}
```

### 7.3 ä¼˜é›…é™çº§å¤„ç†


**ğŸ’¡ ä»€ä¹ˆæ˜¯æœåŠ¡é™çº§**ï¼š
```
æ­£å¸¸æƒ…å†µï¼š
è°ƒç”¨å•†å“æœåŠ¡ â†’ è¿”å›å•†å“ä¿¡æ¯ â†’ å±•ç¤ºç»™ç”¨æˆ·

é™çº§æƒ…å†µï¼š
è°ƒç”¨å•†å“æœåŠ¡å¤±è´¥ â†’ è¿”å›é»˜è®¤ä¿¡æ¯ â†’ ä¸å½±å“ä¸»æµç¨‹

ä¾‹å¦‚ï¼š
å•†å“è¯¦æƒ…è·å–å¤±è´¥ â†’ æ˜¾ç¤º"å•†å“ä¿¡æ¯åŠ è½½ä¸­..."
åº“å­˜æŸ¥è¯¢å¤±è´¥ â†’ æ˜¾ç¤º"è¯·ç¨åæŸ¥çœ‹åº“å­˜"
```

**ğŸ“ å®ç°Fallback**ï¼š
```java
// 1. å®šä¹‰é™çº§ç±»
@Component
public class ProductClientFallback implements ProductClient {
    
    @Override
    public Product getProduct(Long id) {
        // è¿”å›é™çº§æ•°æ®
        Product product = new Product();
        product.setId(id);
        product.setName("å•†å“ä¿¡æ¯æš‚æ—¶æ— æ³•è·å–");
        product.setStatus("UNAVAILABLE");
        return product;
    }
}

// 2. åœ¨Feignæ¥å£æŒ‡å®šFallback
@FeignClient(
    name = "product-service",
    fallback = ProductClientFallback.class  // æŒ‡å®šé™çº§ç±»
)
public interface ProductClient {
    @GetMapping("/product/{id}")
    Product getProduct(@PathVariable Long id);
}
```

---

## 8. ğŸ”„ é‡è¯•æœºåˆ¶å®ç°


### 8.1 é‡è¯•çš„å¿…è¦æ€§


**ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦é‡è¯•**ï¼š
```
ç½‘ç»œæ˜¯ä¸ç¨³å®šçš„ï¼š
ç¬¬1æ¬¡è°ƒç”¨ â†’ ç½‘ç»œæŠ–åŠ¨å¤±è´¥
ç¬¬2æ¬¡è°ƒç”¨ â†’ æˆåŠŸ

åˆç†é‡è¯•å¯ä»¥æé«˜æˆåŠŸç‡ï¼Œä½†è¦æ³¨æ„ï¼š
âœ… é€‚åˆé‡è¯•ï¼šæŸ¥è¯¢æ“ä½œ
âŒ ä¸é€‚åˆé‡è¯•ï¼šæ‰£æ¬¾ã€åˆ›å»ºè®¢å•ç­‰æ“ä½œï¼ˆå¯èƒ½é‡å¤ï¼‰
```

### 8.2 Feigné‡è¯•é…ç½®


**ğŸ“ è‡ªå®šä¹‰é‡è¯•å™¨**ï¼š
```java
@Configuration
public class FeignRetryConfig {
    
    @Bean
    public Retryer feignRetryer() {
        return new Retryer.Default(
            100,   // é‡è¯•é—´éš”èµ·å§‹å€¼(ms)
            1000,  // é‡è¯•é—´éš”æœ€å¤§å€¼(ms)
            3      // æœ€å¤§é‡è¯•æ¬¡æ•°
        );
    }
}
```

**ğŸ” é‡è¯•æµç¨‹**ï¼š
```
è¯·æ±‚æµç¨‹ï¼š
ç¬¬1æ¬¡è°ƒç”¨ â†’ å¤±è´¥
  â†“ ç­‰å¾…100ms
ç¬¬2æ¬¡è°ƒç”¨ â†’ å¤±è´¥  
  â†“ ç­‰å¾…200ms
ç¬¬3æ¬¡è°ƒç”¨ â†’ æˆåŠŸ/æœ€ç»ˆå¤±è´¥
```

### 8.3 æ¡ä»¶æ€§é‡è¯•


**ğŸ“ åªå¯¹ç‰¹å®šå¼‚å¸¸é‡è¯•**ï¼š
```java
public class CustomRetryer implements Retryer {
    
    private int attempt = 1;
    private final int maxAttempts = 3;
    
    @Override
    public void continueOrPropagate(RetryableException e) {
        if (attempt++ >= maxAttempts) {
            throw e;  // è¾¾åˆ°æœ€å¤§æ¬¡æ•°ï¼ŒæŠ›å‡ºå¼‚å¸¸
        }
        
        // åªå¯¹ç½‘ç»œå¼‚å¸¸é‡è¯•ï¼Œä¸šåŠ¡å¼‚å¸¸ä¸é‡è¯•
        if (e.getCause() instanceof SocketTimeoutException) {
            try {
                Thread.sleep(100 * attempt);  // é€æ­¥å»¶é•¿ç­‰å¾…æ—¶é—´
            } catch (InterruptedException ex) {
                throw e;
            }
        } else {
            throw e;  // å…¶ä»–å¼‚å¸¸ä¸é‡è¯•
        }
    }
    
    @Override
    public Retryer clone() {
        return new CustomRetryer();
    }
}
```

**âš ï¸ é‡è¯•æ³¨æ„äº‹é¡¹**ï¼š
```
âŒ å±é™©æ“ä½œï¼š
â€¢ æ‰£æ¬¾æ¥å£é‡è¯• â†’ å¯èƒ½æ‰£æ¬¾å¤šæ¬¡
â€¢ åˆ›å»ºè®¢å•é‡è¯• â†’ å¯èƒ½åˆ›å»ºé‡å¤è®¢å•
â€¢ å‘é€çŸ­ä¿¡é‡è¯• â†’ å¯èƒ½å‘é€å¤šæ¬¡

âœ… å®‰å…¨æ“ä½œï¼š
â€¢ æŸ¥è¯¢æ“ä½œ â†’ å¯ä»¥é‡è¯•
â€¢ å¹‚ç­‰æ“ä½œ â†’ å¯ä»¥é‡è¯•ï¼ˆå¤šæ¬¡è°ƒç”¨ç»“æœç›¸åŒï¼‰
```

---

## 9. ğŸ›¡ï¸ ç†”æ–­å™¨é›†æˆ


### 9.1 ç†”æ–­å™¨åŸºæœ¬æ¦‚å¿µ


**ğŸ’¡ é€šä¿—ç†è§£**ï¼š
```
ç†”æ–­å™¨åƒå®¶é‡Œçš„"ä¿é™©ä¸"ï¼š

æ­£å¸¸æƒ…å†µï¼š
ç”µæµæ­£å¸¸ â†’ ä¿é™©ä¸å¯¼é€š â†’ ç”µå™¨æ­£å¸¸å·¥ä½œ

å¼‚å¸¸æƒ…å†µï¼š
ç”µæµè¿‡å¤§ â†’ ä¿é™©ä¸ç†”æ–­ â†’ åˆ‡æ–­ç”µè·¯ä¿æŠ¤å®¶ç”µ

å¾®æœåŠ¡ç†”æ–­ï¼š
è°ƒç”¨æ­£å¸¸ â†’ ç†”æ–­å™¨å…³é—­ â†’ æ­£å¸¸è°ƒç”¨
è°ƒç”¨é¢‘ç¹å¤±è´¥ â†’ ç†”æ–­å™¨æ‰“å¼€ â†’ å¿«é€Ÿå¤±è´¥ï¼Œä¸å†è°ƒç”¨
```

**ğŸ”„ ç†”æ–­å™¨çŠ¶æ€è½¬æ¢**ï¼š
```
çŠ¶æ€æµè½¬ï¼š

    [å…³é—­] â†â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” [åŠå¼€]
      â†“                    â†‘
   å¤±è´¥æ¬¡æ•°è¿‡å¤š           æˆåŠŸæ¬¡æ•°è¾¾æ ‡
      â†“                    â†‘
    [æ‰“å¼€] â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â†’ [åŠå¼€]
           ç­‰å¾…ä¸€æ®µæ—¶é—´
```

### 9.2 Resilience4jé›†æˆ


**ğŸ“¦ æ·»åŠ ä¾èµ–**ï¼š
```xml
<dependency>
    <groupId>io.github.resilience4j</groupId>
    <artifactId>resilience4j-spring-boot2</artifactId>
</dependency>
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-circuitbreaker-resilience4j</artifactId>
</dependency>
```

**âš™ï¸ é…ç½®ç†”æ–­å™¨**ï¼š
```yaml
resilience4j:
  circuitbreaker:
    instances:
      productService:  # ä¸ºproductæœåŠ¡é…ç½®ç†”æ–­
        slidingWindowSize: 10           # æ»‘åŠ¨çª—å£å¤§å°
        failureRateThreshold: 50        # å¤±è´¥ç‡é˜ˆå€¼50%
        waitDurationInOpenState: 10000  # æ‰“å¼€çŠ¶æ€ç­‰å¾…10ç§’
        permittedNumberOfCallsInHalfOpenState: 3  # åŠå¼€çŠ¶æ€å…è®¸3æ¬¡è°ƒç”¨
```

### 9.3 ä½¿ç”¨ç†”æ–­å™¨


**ğŸ“ æ–¹å¼1ï¼šæ³¨è§£æ–¹å¼**ï¼š
```java
@Service
public class ProductService {
    
    @Autowired
    private ProductClient productClient;
    
    @CircuitBreaker(
        name = "productService",
        fallbackMethod = "getProductFallback"  // ç†”æ–­åè°ƒç”¨çš„æ–¹æ³•
    )
    public Product getProduct(Long id) {
        return productClient.getProduct(id);
    }
    
    // é™çº§æ–¹æ³•ï¼ˆæ–¹æ³•ç­¾åè¦ä¸€è‡´ï¼Œå¯å¤šä¸€ä¸ªThrowableå‚æ•°ï¼‰
    public Product getProductFallback(Long id, Throwable t) {
        log.error("è·å–å•†å“å¤±è´¥ï¼Œè¿›å…¥é™çº§: {}", t.getMessage());
        
        Product fallback = new Product();
        fallback.setId(id);
        fallback.setName("å•†å“æœåŠ¡æš‚æ—¶ä¸å¯ç”¨");
        return fallback;
    }
}
```

**ğŸ“ æ–¹å¼2ï¼šç¼–ç¨‹å¼**ï¼š
```java
@Service
public class ProductService {
    
    @Autowired
    private CircuitBreakerRegistry registry;
    
    public Product getProduct(Long id) {
        CircuitBreaker circuitBreaker = registry.circuitBreaker("productService");
        
        return circuitBreaker.executeSupplier(() -> {
            // å®é™…è°ƒç”¨
            return productClient.getProduct(id);
        });
    }
}
```

### 9.4 ç†”æ–­å™¨ç›‘æ§


**ğŸ“Š ç›‘æ§æŒ‡æ ‡**ï¼š
```yaml
management:
  endpoints:
    web:
      exposure:
        include: health,circuitbreakers
  health:
    circuitbreakers:
      enabled: true
```

è®¿é—®ç›‘æ§ç«¯ç‚¹ï¼š
```
http://localhost:8080/actuator/circuitbreakers
http://localhost:8080/actuator/health
```

**ğŸ” ç†”æ–­å™¨çŠ¶æ€æŸ¥è¯¢**ï¼š
```java
@RestController
@RequestMapping("/actuator")
public class CircuitBreakerController {
    
    @Autowired
    private CircuitBreakerRegistry registry;
    
    @GetMapping("/circuit-status")
    public Map<String, String> getCircuitBreakerStatus() {
        Map<String, String> status = new HashMap<>();
        
        registry.getAllCircuitBreakers().forEach(cb -> {
            status.put(cb.getName(), cb.getState().toString());
        });
        
        return status;
    }
}
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 ä¸‰ç§å®¢æˆ·ç«¯é€‰æ‹©æŒ‡å—


**ğŸ¯ æŠ€æœ¯é€‰å‹å†³ç­–æ ‘**ï¼š
```
ä½ çš„é¡¹ç›®éœ€è¦ä»€ä¹ˆï¼Ÿ

åœºæ™¯1: ç®€å•çš„HTTPè°ƒç”¨ï¼Œå›¢é˜Ÿç†Ÿæ‚‰Spring
â†’ é€‰æ‹© RestTemplate âœ…

åœºæ™¯2: é«˜å¹¶å‘ï¼Œéœ€è¦å¼‚æ­¥å¤„ç†
â†’ é€‰æ‹© WebClient âš¡

åœºæ™¯3: å¾®æœåŠ¡é—´è°ƒç”¨ï¼Œè¿½æ±‚ä»£ç ç®€æ´
â†’ é€‰æ‹© OpenFeign ğŸ¯
```

### 10.2 é…ç½®ä¼˜å…ˆçº§


**âš–ï¸ é…ç½®è¦†ç›–é¡ºåº**ï¼š
```
ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼š
1. æ–¹æ³•çº§é…ç½®ï¼ˆ@FeignClientæ–¹æ³•ä¸Šçš„é…ç½®ï¼‰
2. ç±»çº§é…ç½®ï¼ˆ@FeignClientçš„configurationï¼‰
3. æœåŠ¡çº§é…ç½®ï¼ˆapplication.ymlä¸­çš„æœåŠ¡é…ç½®ï¼‰
4. å…¨å±€é…ç½®ï¼ˆapplication.ymlä¸­çš„defaulté…ç½®ï¼‰
5. é»˜è®¤é…ç½®ï¼ˆFeignå†…ç½®é»˜è®¤å€¼ï¼‰
```

### 10.3 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒè¦ç‚¹


**ğŸ”‘ å…³é”®çŸ¥è¯†æ¸…å•**ï¼š
```
âœ… å®¢æˆ·ç«¯é€‰æ‹©ï¼š
â€¢ RestTemplateï¼šåŒæ­¥ç®€å•
â€¢ WebClientï¼šå¼‚æ­¥é«˜æ€§èƒ½
â€¢ Feignï¼šå£°æ˜å¼æœ€ä¼˜é›…

âœ… è¶…æ—¶é…ç½®ï¼š
â€¢ è¿æ¥è¶…æ—¶ï¼š3-5ç§’
â€¢ è¯»å–è¶…æ—¶ï¼šæ ¹æ®ä¸šåŠ¡10-30ç§’
â€¢ åˆ†å±‚é…ç½®ï¼šå…¨å±€â†’æœåŠ¡â†’æ–¹æ³•

âœ… å®¹é”™æœºåˆ¶ï¼š
â€¢ å¼‚å¸¸å¤„ç†ï¼šErrorDecoderç»Ÿä¸€å¤„ç†
â€¢ æœåŠ¡é™çº§ï¼šFallbackæä¾›å¤‡ç”¨æ–¹æ¡ˆ
â€¢ é‡è¯•æœºåˆ¶ï¼šåªå¯¹å®‰å…¨æ“ä½œé‡è¯•
â€¢ ç†”æ–­ä¿æŠ¤ï¼šé˜²æ­¢é›ªå´©æ•ˆåº”

âœ… æ€§èƒ½ä¼˜åŒ–ï¼š
â€¢ è¿æ¥æ± ï¼šå¤ç”¨TCPè¿æ¥
â€¢ HTTPå®¢æˆ·ç«¯ï¼šé€‰æ‹©OkHttp
â€¢ è´Ÿè½½å‡è¡¡ï¼šè‡ªåŠ¨åˆ†å‘è¯·æ±‚
```

### 10.4 æœ€ä½³å®è·µå»ºè®®


**ğŸ’¡ å®æˆ˜ç»éªŒ**ï¼š

**DOï¼ˆæ¨èåšæ³•ï¼‰**ï¼š
```
âœ… è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´
âœ… ä¸ºå…³é”®æœåŠ¡é…ç½®ç†”æ–­å™¨
âœ… æŸ¥è¯¢æ“ä½œå¯ä»¥é‡è¯•
âœ… ä½¿ç”¨è¿æ¥æ± æé«˜æ€§èƒ½
âœ… è®°å½•å®Œæ•´çš„è°ƒç”¨æ—¥å¿—
âœ… ç›‘æ§ç†”æ–­å™¨çŠ¶æ€
```

**DON'Tï¼ˆé¿å…åšæ³•ï¼‰**ï¼š
```
âŒ æ— é™åˆ¶é‡è¯•
âŒ å†™æ“ä½œéšæ„é‡è¯•
âŒ ä¸è®¾ç½®è¶…æ—¶
âŒ å¿½ç•¥å¼‚å¸¸å¤„ç†
âŒ ä¸åšæœåŠ¡é™çº§
âŒ ä¸ç›‘æ§è°ƒç”¨æƒ…å†µ
```

### 10.5 æ•…éšœæ’æŸ¥æ€è·¯


**ğŸ” é—®é¢˜è¯Šæ–­æµç¨‹**ï¼š
```
é—®é¢˜1: è°ƒç”¨è¶…æ—¶
â†’ æ£€æŸ¥è¶…æ—¶é…ç½®æ˜¯å¦åˆç†
â†’ æŸ¥çœ‹æœåŠ¡å“åº”æ—¶é—´
â†’ æ£€æŸ¥ç½‘ç»œçŠ¶å†µ

é—®é¢˜2: è°ƒç”¨å¤±è´¥
â†’ æŸ¥çœ‹å¼‚å¸¸å †æ ˆ
â†’ æ£€æŸ¥æœåŠ¡æ˜¯å¦å¯ç”¨
â†’ éªŒè¯è¯·æ±‚å‚æ•°

é—®é¢˜3: ç†”æ–­å™¨é¢‘ç¹æ‰“å¼€
â†’ æ£€æŸ¥å¤±è´¥ç‡é˜ˆå€¼
â†’ åˆ†ææœåŠ¡ç¨³å®šæ€§
â†’ ä¼˜åŒ–è¶…æ—¶é…ç½®
```

**æ ¸å¿ƒè®°å¿†**ï¼š
```
æœåŠ¡è°ƒç”¨ä¸‰è¦ç´ ï¼šå®¢æˆ·ç«¯ã€é…ç½®ã€å®¹é”™
RestTemplateåŒæ­¥ç®€å•ï¼ŒWebClientå¼‚æ­¥é«˜æ•ˆï¼ŒFeignå£°æ˜ä¼˜é›…
è¶…æ—¶å¿…è®¾é˜²é˜»å¡ï¼Œé™çº§é‡è¯•ä¿å¯ç”¨
ç†”æ–­æœºåˆ¶æ˜¯ä¿é™©ï¼Œç›‘æ§æ—¥å¿—ä¸èƒ½å°‘
```