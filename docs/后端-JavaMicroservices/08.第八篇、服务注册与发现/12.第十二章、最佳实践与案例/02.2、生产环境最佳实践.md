---
title: 2ã€ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ
---
## ğŸ“š ç›®å½•

1. [éƒ¨ç½²æ¶æ„è®¾è®¡](#1-éƒ¨ç½²æ¶æ„è®¾è®¡)
2. [é…ç½®ç®¡ç†è§„èŒƒ](#2-é…ç½®ç®¡ç†è§„èŒƒ)
3. [ç›‘æ§å‘Šè­¦ä½“ç³»](#3-ç›‘æ§å‘Šè­¦ä½“ç³»)
4. [æ•…éšœåº”æ€¥é¢„æ¡ˆ](#4-æ•…éšœåº”æ€¥é¢„æ¡ˆ)
5. [æ€§èƒ½è°ƒä¼˜ç»éªŒ](#5-æ€§èƒ½è°ƒä¼˜ç»éªŒ)
6. [å®‰å…¨åŠ å›ºæªæ–½](#6-å®‰å…¨åŠ å›ºæªæ–½)
7. [è¿ç»´è‡ªåŠ¨åŒ–](#7-è¿ç»´è‡ªåŠ¨åŒ–)
8. [å›¢é˜Ÿåä½œæœºåˆ¶](#8-å›¢é˜Ÿåä½œæœºåˆ¶)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ—ï¸ éƒ¨ç½²æ¶æ„è®¾è®¡


### 1.1 ä»€ä¹ˆæ˜¯éƒ¨ç½²æ¶æ„


**é€šä¿—ç†è§£**ï¼šå°±åƒå»ºæˆ¿å­éœ€è¦å…ˆè®¾è®¡å›¾çº¸ï¼Œå¾®æœåŠ¡ä¸Šçº¿å‰ä¹Ÿè¦è§„åˆ’å¥½"æ€ä¹ˆæ‘†æ”¾è¿™äº›æœåŠ¡"ã€‚

éƒ¨ç½²æ¶æ„å°±æ˜¯ï¼š
- å†³å®šæœåŠ¡å™¨è¯¥ä¹°å‡ å°
- æ¯å°æœåŠ¡å™¨ä¸Šè·‘ä»€ä¹ˆæœåŠ¡
- æœåŠ¡ä¹‹é—´æ€ä¹ˆè¿æ¥
- å‡ºé—®é¢˜äº†æ€ä¹ˆåŠ

**æ ¸å¿ƒç›®æ ‡**ï¼š
```
âœ… é«˜å¯ç”¨ï¼šä¸èƒ½å› ä¸ºä¸€å°æœºå™¨åäº†æ•´ä¸ªç³»ç»Ÿå°±æŒ‚
âœ… é«˜æ€§èƒ½ï¼šè®¿é—®é€Ÿåº¦è¦å¿«ï¼Œèƒ½æ‰¿å—å¤§é‡ç”¨æˆ·
âœ… æ˜“ç»´æŠ¤ï¼šå‡ºé—®é¢˜èƒ½å¿«é€Ÿå®šä½å’Œä¿®å¤
âœ… å¯æ‰©å±•ï¼šä¸šåŠ¡å¢é•¿æ—¶èƒ½æ–¹ä¾¿åœ°åŠ æœºå™¨
```

### 1.2 æ³¨å†Œä¸­å¿ƒé›†ç¾¤éƒ¨ç½²


**ä¸ºä»€ä¹ˆè¦é›†ç¾¤éƒ¨ç½²**ï¼š

æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªæ³¨å†Œä¸­å¿ƒï¼ˆæ¯”å¦‚Nacosï¼‰ï¼Œå°±åƒåªæœ‰ä¸€ä¸ªé€šè®¯å½•ç®¡ç†å‘˜ï¼š
- ä»–ç”Ÿç—…äº†ï¼Œæ‰€æœ‰äººéƒ½æ‰¾ä¸åˆ°è”ç³»æ–¹å¼
- ä»–å¤ªå¿™äº†ï¼Œå¤§å®¶æ’é˜Ÿç­‰ä»–æŸ¥å·ç 

æ‰€ä»¥è¦**å¤šä¸ªç®¡ç†å‘˜ä¸€èµ·å·¥ä½œ**ï¼š

```
é›†ç¾¤éƒ¨ç½²æ¶æ„ï¼ˆæ¨èè‡³å°‘3ä¸ªèŠ‚ç‚¹ï¼‰ï¼š

         [è´Ÿè½½å‡è¡¡å™¨]
         /    |    \
        /     |     \
    Nacos1  Nacos2  Nacos3
       \      |      /
        \     |     /
      [å…±äº«æ•°æ®åº“ MySQL]
```

**å…³é”®é…ç½®è¦ç‚¹**ï¼š

| é…ç½®é¡¹ | è¯´æ˜ | æ¨èå€¼ |
|--------|------|--------|
| **èŠ‚ç‚¹æ•°é‡** | æ³¨å†Œä¸­å¿ƒæœåŠ¡å™¨ä¸ªæ•° | `3ä¸ªæˆ–5ä¸ªï¼ˆå¥‡æ•°ï¼‰` |
| **éƒ¨ç½²ä½ç½®** | æ˜¯å¦è·¨æœºæˆ¿ | `åˆ†å¸ƒåœ¨ä¸åŒæœºæˆ¿` |
| **æ•°æ®å­˜å‚¨** | ç”¨ä»€ä¹ˆä¿å­˜æ•°æ® | `å¤–ç½®MySQLæ•°æ®åº“` |
| **å†…å­˜é…ç½®** | æ¯ä¸ªèŠ‚ç‚¹å†…å­˜ | `è‡³å°‘2GB` |

**éƒ¨ç½²ç¤ºä¾‹ï¼ˆNacosé›†ç¾¤ï¼‰**ï¼š

```properties
# application.propertiesï¼ˆæ¯ä¸ªèŠ‚ç‚¹éƒ½è¦é…ç½®ï¼‰

# é›†ç¾¤é…ç½®æ–‡ä»¶ä½ç½®
nacos.cluster.conf=cluster.conf

# æ•°æ®åº“é…ç½®ï¼ˆ3ä¸ªèŠ‚ç‚¹å…±ç”¨ä¸€ä¸ªæ•°æ®åº“ï¼‰
spring.datasource.platform=mysql
db.num=1
db.url.0=jdbc:mysql://192.168.1.100:3306/nacos_config
db.user.0=nacos
db.password.0=nacos123
```

cluster.conf æ–‡ä»¶å†…å®¹ï¼š
```
# åˆ—å‡ºæ‰€æœ‰é›†ç¾¤èŠ‚ç‚¹çš„IPå’Œç«¯å£
192.168.1.101:8848
192.168.1.102:8848
192.168.1.103:8848
```

### 1.3 å¾®æœåŠ¡åˆ†å±‚éƒ¨ç½²


**ä»€ä¹ˆæ˜¯åˆ†å±‚éƒ¨ç½²**ï¼š

å°±åƒå…¬å¸é‡Œçš„ç»„ç»‡æ¶æ„ï¼Œä¸èƒ½æ‰€æœ‰äººéƒ½æŒ¤åœ¨ä¸€ä¸ªåŠå…¬å®¤ï¼Œè¦æŒ‰èŒèƒ½åˆ†å±‚ï¼š

```
ç”¨æˆ·å±‚
  â†“
[ç½‘å…³å±‚]  â† ç»Ÿä¸€å…¥å£ï¼Œåšèº«ä»½éªŒè¯å’Œè·¯ç”±
  â†“
[ä¸šåŠ¡æœåŠ¡å±‚]  â† è®¢å•æœåŠ¡ã€ç”¨æˆ·æœåŠ¡ã€å•†å“æœåŠ¡ç­‰
  â†“
[åŸºç¡€æœåŠ¡å±‚]  â† çŸ­ä¿¡æœåŠ¡ã€æ”¯ä»˜æœåŠ¡ç­‰
  â†“
[æ•°æ®å±‚]  â† MySQLã€Redisç­‰
```

**åˆ†å±‚çš„å¥½å¤„**ï¼š

âœ… **èŒè´£æ¸…æ™°**ï¼šæ¯å±‚åšè‡ªå·±çš„äº‹ï¼Œä¸ä¼šä¹±
âœ… **ä¾¿äºæ‰©å®¹**ï¼šå“ªå±‚å‹åŠ›å¤§å°±åŠ å“ªå±‚çš„æœºå™¨
âœ… **å®‰å…¨éš”ç¦»**ï¼šå¤–éƒ¨ä¸èƒ½ç›´æ¥è®¿é—®ä¸šåŠ¡æœåŠ¡

**å…¸å‹éƒ¨ç½²æ–¹æ¡ˆ**ï¼š

```
DMZåŒºï¼ˆå¯¹å¤–æš´éœ²ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç½‘å…³é›†ç¾¤ï¼ˆ3å°ï¼‰              â”‚
â”‚  Nginxè´Ÿè½½å‡è¡¡ï¼ˆ2å°ï¼‰         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
å†…ç½‘åŒºï¼ˆä¸šåŠ¡æ ¸å¿ƒï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è®¢å•æœåŠ¡ï¼ˆ5å°ï¼‰              â”‚
â”‚  ç”¨æˆ·æœåŠ¡ï¼ˆ3å°ï¼‰              â”‚
â”‚  å•†å“æœåŠ¡ï¼ˆ3å°ï¼‰              â”‚
â”‚  æ³¨å†Œä¸­å¿ƒï¼ˆ3å°ï¼‰              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
æ•°æ®åŒºï¼ˆæ•°æ®å­˜å‚¨ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MySQLä¸»ä»ï¼ˆ1ä¸»2ä»ï¼‰          â”‚
â”‚  Redisé›†ç¾¤ï¼ˆ6å°ï¼‰             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.4 å®¹å™¨åŒ–éƒ¨ç½²ï¼ˆDocker + Kubernetesï¼‰


**ä»€ä¹ˆæ˜¯å®¹å™¨åŒ–éƒ¨ç½²**ï¼š

ä¼ ç»Ÿæ–¹å¼ï¼šåƒç§Ÿæˆ¿å­ï¼Œæ¯ä¸ªæœåŠ¡è¦ä¸€æ•´å¥—æˆ¿ï¼ˆè™šæ‹Ÿæœºï¼‰
å®¹å™¨åŒ–ï¼šåƒä½èƒ¶å›Šæ—…é¦†ï¼Œæ¯ä¸ªæœåŠ¡åªè¦ä¸€ä¸ªå°æ ¼å­ï¼ˆå®¹å™¨ï¼‰ï¼ŒèŠ‚çœèµ„æº

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š

```
å¿«é€Ÿå¯åŠ¨ï¼šå‡ ç§’é’Ÿå°±èƒ½å¯åŠ¨ä¸€ä¸ªæœåŠ¡ï¼ˆä¼ ç»Ÿè™šæ‹Ÿæœºè¦å‡ åˆ†é’Ÿï¼‰
èµ„æºèŠ‚çœï¼š10ä¸ªå®¹å™¨å¯èƒ½åªç”¨1å°æœåŠ¡å™¨ï¼ˆä¼ ç»Ÿè¦10å°è™šæ‹Ÿæœºï¼‰
ç‰ˆæœ¬ç®¡ç†ï¼šåƒGitä¸€æ ·ç®¡ç†æœåŠ¡ç‰ˆæœ¬
è‡ªåŠ¨æ¢å¤ï¼šæœåŠ¡æŒ‚äº†è‡ªåŠ¨é‡å¯
```

**K8Séƒ¨ç½²æ¶æ„ç¤ºä¾‹**ï¼š

```
Kubernetesé›†ç¾¤
â”œâ”€â”€ MasterèŠ‚ç‚¹ï¼ˆç®¡ç†å¤§è„‘ï¼‰
â”‚   â”œâ”€â”€ è°ƒåº¦å™¨ï¼šå†³å®šå®¹å™¨è·‘åœ¨å“ªå°æœºå™¨
â”‚   â”œâ”€â”€ æ§åˆ¶å™¨ï¼šä¿è¯æœåŠ¡æ•°é‡æ­£ç¡®
â”‚   â””â”€â”€ APIæœåŠ¡ï¼šæ¥æ”¶æ“ä½œå‘½ä»¤
â”‚
â””â”€â”€ WorkerèŠ‚ç‚¹ï¼ˆå¹²æ´»çš„ï¼‰
    â”œâ”€â”€ Node1
    â”‚   â”œâ”€â”€ Pod: è®¢å•æœåŠ¡-1
    â”‚   â”œâ”€â”€ Pod: è®¢å•æœåŠ¡-2
    â”‚   â””â”€â”€ Pod: ç”¨æˆ·æœåŠ¡-1
    â”‚
    â”œâ”€â”€ Node2
    â”‚   â”œâ”€â”€ Pod: è®¢å•æœåŠ¡-3
    â”‚   â”œâ”€â”€ Pod: å•†å“æœåŠ¡-1
    â”‚   â””â”€â”€ Pod: Nacos-1
    â”‚
    â””â”€â”€ Node3
        â”œâ”€â”€ Pod: å•†å“æœåŠ¡-2
        â””â”€â”€ Pod: Nacos-2
```

**é…ç½®æ–‡ä»¶ç¤ºä¾‹ï¼ˆè®¢å•æœåŠ¡ï¼‰**ï¼š

```yaml
# order-service-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: order-service
spec:
  replicas: 3  # è¿è¡Œ3ä¸ªå‰¯æœ¬
  selector:
    matchLabels:
      app: order-service
  template:
    metadata:
      labels:
        app: order-service
    spec:
      containers:
      - name: order-service
        image: order-service:1.0.0
        ports:
        - containerPort: 8080
        env:
        - name: SPRING_PROFILES_ACTIVE
          value: "prod"
        resources:
          requests:
            memory: "512Mi"
            cpu: "500m"
          limits:
            memory: "1Gi"
            cpu: "1000m"
```

---

## 2. âš™ï¸ é…ç½®ç®¡ç†è§„èŒƒ


### 2.1 ä¸ºä»€ä¹ˆéœ€è¦é…ç½®ç®¡ç†


**é—®é¢˜åœºæ™¯**ï¼š

ä½ å¼€å‘äº†ä¸€ä¸ªè®¢å•æœåŠ¡ï¼Œåœ¨ä¸åŒç¯å¢ƒè¿è¡Œï¼š
- å¼€å‘ç¯å¢ƒï¼šè¿æ¥æµ‹è¯•æ•°æ®åº“ `192.168.1.10`
- æµ‹è¯•ç¯å¢ƒï¼šè¿æ¥æµ‹è¯•æ•°æ®åº“ `192.168.2.10`
- ç”Ÿäº§ç¯å¢ƒï¼šè¿æ¥æ­£å¼æ•°æ®åº“ `10.0.1.100`

å¦‚æœæŠŠé…ç½®å†™æ­»åœ¨ä»£ç é‡Œï¼Œæ¯æ¬¡æ¢ç¯å¢ƒéƒ½è¦æ”¹ä»£ç é‡æ–°æ‰“åŒ…ï¼Œ**å¤ªéº»çƒ¦è¿˜å®¹æ˜“å‡ºé”™**ï¼

**é…ç½®ç®¡ç†å°±æ˜¯**ï¼šæŠŠè¿™äº›"å¯èƒ½å˜åŒ–çš„å‚æ•°"å•ç‹¬å­˜æ”¾ï¼Œéœ€è¦æ—¶åŠ¨æ€è¯»å–ã€‚

### 2.2 é…ç½®åˆ†å±‚ç®¡ç†


**é…ç½®åˆ†ç±»**ï¼š

```
é…ç½®å±‚æ¬¡ï¼ˆä»é€šç”¨åˆ°ä¸“ç”¨ï¼‰ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å…¨å±€é…ç½®               â”‚  â† æ‰€æœ‰æœåŠ¡éƒ½ç”¨çš„é…ç½®
â”‚  ï¼ˆå¦‚ï¼šæ³¨å†Œä¸­å¿ƒåœ°å€ï¼‰    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åº”ç”¨é…ç½®               â”‚  â† æŸä¸ªæœåŠ¡ä¸“ç”¨çš„é…ç½®
â”‚  ï¼ˆå¦‚ï¼šè®¢å•æœåŠ¡é…ç½®ï¼‰    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç¯å¢ƒé…ç½®               â”‚  â† ç‰¹å®šç¯å¢ƒçš„é…ç½®
â”‚  ï¼ˆdev/test/prodï¼‰      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Nacosé…ç½®ç¤ºä¾‹**ï¼š

å‘½åç©ºé—´åˆ’åˆ†ï¼š
```
Namespace: devï¼ˆå¼€å‘ç¯å¢ƒï¼‰
  â”œâ”€â”€ Group: DEFAULT_GROUP
  â”‚   â”œâ”€â”€ common.yamlï¼ˆå…¨å±€é…ç½®ï¼‰
  â”‚   â”œâ”€â”€ order-service.yamlï¼ˆè®¢å•æœåŠ¡é…ç½®ï¼‰
  â”‚   â””â”€â”€ user-service.yamlï¼ˆç”¨æˆ·æœåŠ¡é…ç½®ï¼‰
  
Namespace: prodï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
  â”œâ”€â”€ Group: DEFAULT_GROUP
  â”‚   â”œâ”€â”€ common.yaml
  â”‚   â”œâ”€â”€ order-service.yaml
  â”‚   â””â”€â”€ user-service.yaml
```

**é…ç½®æ–‡ä»¶å†…å®¹ç¤ºä¾‹**ï¼š

common.yamlï¼ˆå…¨å±€é…ç½®ï¼‰ï¼š
```yaml
# æ‰€æœ‰æœåŠ¡å…±ç”¨çš„é…ç½®
spring:
  redis:
    host: ${redis.host}
    port: 6379
    
logging:
  level:
    root: INFO
```

order-service.yamlï¼ˆè®¢å•æœåŠ¡é…ç½®ï¼‰ï¼š
```yaml
# è®¢å•æœåŠ¡ä¸“ç”¨é…ç½®
server:
  port: 8081
  
spring:
  datasource:
    url: jdbc:mysql://${db.host}:3306/order_db
    username: ${db.username}
    password: ${db.password}
```

### 2.3 é…ç½®å®‰å…¨ç®¡ç†


**æ•æ„Ÿä¿¡æ¯åŠ å¯†**ï¼š

æ•°æ®åº“å¯†ç ã€APIå¯†é’¥è¿™äº›æ•æ„Ÿä¿¡æ¯ä¸èƒ½æ˜æ–‡å­˜å‚¨ï¼

**åŠ å¯†æ–¹æ¡ˆ**ï¼š

æ–¹æ¡ˆ1ï¼šä½¿ç”¨JasyptåŠ å¯†
```yaml
# åŠ å¯†åçš„é…ç½®
spring:
  datasource:
    password: ENC(8xKvfX9Z8kLmNg7dKs...)  # åŠ å¯†åçš„å¯†ç 
```

å¯åŠ¨æ—¶æä¾›è§£å¯†å¯†é’¥ï¼š
```bash
java -jar order-service.jar --jasypt.encryptor.password=mySecretKey
```

æ–¹æ¡ˆ2ï¼šä½¿ç”¨é…ç½®ä¸­å¿ƒçš„åŠ å¯†åŠŸèƒ½
```yaml
# Nacosæ”¯æŒKMSåŠ å¯†
cipher:
  aes: ${CIPHER}fIwN8Yf9Zk8qW...
```

**æƒé™æ§åˆ¶**ï¼š

```
é…ç½®è®¿é—®æƒé™è®¾è®¡ï¼š

å¼€å‘äººå‘˜ï¼šåªèƒ½è¯»å–devç¯å¢ƒé…ç½®
æµ‹è¯•äººå‘˜ï¼šå¯ä»¥ä¿®æ”¹testç¯å¢ƒé…ç½®
è¿ç»´äººå‘˜ï¼šå¯ä»¥ä¿®æ”¹prodç¯å¢ƒé…ç½®
æ™®é€šæœåŠ¡ï¼šåªèƒ½è¯»å–è‡ªå·±çš„é…ç½®
```

### 2.4 é…ç½®å˜æ›´æµç¨‹


**æ ‡å‡†å˜æ›´æµç¨‹**ï¼š

```
é…ç½®å˜æ›´æµç¨‹ï¼š

1. æäº¤ç”³è¯·
   â†“
2. ä»£ç å®¡æŸ¥ï¼ˆReviewï¼‰
   â†“
3. åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯
   â†“
4. ç°åº¦å‘å¸ƒï¼ˆå…ˆç»™10%çš„æœåŠ¡å™¨ï¼‰
   â†“
5. è§‚å¯Ÿç›‘æ§æŒ‡æ ‡
   â†“
6. å…¨é‡å‘å¸ƒï¼ˆæ²¡é—®é¢˜å°±å…¨éƒ¨æ›´æ–°ï¼‰
   â†“
7. è®°å½•å˜æ›´æ—¥å¿—
```

**é…ç½®å›æ»šæœºåˆ¶**ï¼š

Nacosè‡ªå¸¦ç‰ˆæœ¬ç®¡ç†ï¼š
```
é…ç½®å†å²ç‰ˆæœ¬ï¼š
â”œâ”€â”€ v1: 2024-01-15 10:30ï¼ˆå½“å‰ç‰ˆæœ¬ï¼‰
â”œâ”€â”€ v2: 2024-01-14 15:20
â””â”€â”€ v3: 2024-01-10 09:00

å‘ç°é—®é¢˜ï¼Ÿä¸€é”®å›æ»šåˆ°v2ï¼
```

---

## 3. ğŸ“Š ç›‘æ§å‘Šè­¦ä½“ç³»


### 3.1 ç›‘æ§çš„é‡è¦æ€§


**ä¸ºä»€ä¹ˆè¦ç›‘æ§**ï¼š

å°±åƒå¼€è½¦è¦çœ‹ä»ªè¡¨ç›˜ï¼š
- é€Ÿåº¦è¡¨ï¼šç³»ç»Ÿç°åœ¨å¤„ç†å¤šå¿«
- æ²¹é‡è¡¨ï¼šèµ„æºè¿˜å‰©å¤šå°‘
- è­¦å‘Šç¯ï¼šå“ªé‡Œå‡ºé—®é¢˜äº†

æ²¡æœ‰ç›‘æ§ï¼Œç³»ç»Ÿå‡ºé—®é¢˜ä½ éƒ½ä¸çŸ¥é“ï¼

**ç›‘æ§ç»´åº¦**ï¼š

```
å››å¤§ç›‘æ§ç»´åº¦ï¼ˆé»„é‡‘æŒ‡æ ‡ï¼‰ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. å»¶è¿Ÿï¼ˆLatencyï¼‰              â”‚
â”‚    å“åº”æ—¶é—´æ˜¯å¦æ­£å¸¸ï¼Ÿ            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. æµé‡ï¼ˆTrafficï¼‰              â”‚
â”‚    è®¿é—®é‡æœ‰å¤šå¤§ï¼Ÿ                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. é”™è¯¯ï¼ˆErrorsï¼‰               â”‚
â”‚    å¤±è´¥ç‡æ˜¯å¤šå°‘ï¼Ÿ                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. é¥±å’Œåº¦ï¼ˆSaturationï¼‰         â”‚
â”‚    èµ„æºç”¨äº†å¤šå°‘ï¼Ÿ                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ç›‘æ§æŒ‡æ ‡è®¾è®¡


**æœåŠ¡çº§åˆ«ç›‘æ§**ï¼š

| æŒ‡æ ‡ç±»å‹ | å…·ä½“æŒ‡æ ‡ | æ­£å¸¸èŒƒå›´ | å‘Šè­¦é˜ˆå€¼ |
|---------|---------|---------|---------|
| **æ€§èƒ½æŒ‡æ ‡** | å¹³å‡å“åº”æ—¶é—´ | `< 100ms` | `> 500ms` |
| **æ€§èƒ½æŒ‡æ ‡** | P99å“åº”æ—¶é—´ | `< 200ms` | `> 1000ms` |
| **å¯ç”¨æ€§æŒ‡æ ‡** | æˆåŠŸç‡ | `> 99.9%` | `< 99%` |
| **æµé‡æŒ‡æ ‡** | QPS | `ä¾ä¸šåŠ¡` | `è¶…è¿‡å®¹é‡80%` |
| **èµ„æºæŒ‡æ ‡** | CPUä½¿ç”¨ç‡ | `< 70%` | `> 85%` |
| **èµ„æºæŒ‡æ ‡** | å†…å­˜ä½¿ç”¨ç‡ | `< 80%` | `> 90%` |

**æ³¨å†Œä¸­å¿ƒç›‘æ§**ï¼š

```
Nacosç›‘æ§é‡ç‚¹ï¼š

âœ“ æœåŠ¡æ³¨å†Œæ•°é‡ï¼šæ˜¯å¦æœ‰æœåŠ¡å¤§é‡ä¸‹çº¿
âœ“ å¿ƒè·³å¤±è´¥ç‡ï¼šç½‘ç»œæ˜¯å¦æœ‰é—®é¢˜
âœ“ é…ç½®æ¨é€å»¶è¿Ÿï¼šé…ç½®æ›´æ–°æ˜¯å¦åŠæ—¶
âœ“ å®ä¾‹å¥åº·åº¦ï¼šæœ‰å¤šå°‘å®ä¾‹åœ¨çº¿
```

**ç›‘æ§æ•°æ®æµè½¬**ï¼š

```
åº”ç”¨æœåŠ¡
   â†“ï¼ˆæš´éœ²æŒ‡æ ‡ï¼‰
Prometheusï¼ˆé‡‡é›†å­˜å‚¨ï¼‰
   â†“ï¼ˆæŸ¥è¯¢åˆ†æï¼‰
Grafanaï¼ˆå¯è§†åŒ–å±•ç¤ºï¼‰
   â†“ï¼ˆå‘Šè­¦è§„åˆ™ï¼‰
AlertManagerï¼ˆå‘é€å‘Šè­¦ï¼‰
   â†“
çŸ­ä¿¡/é‚®ä»¶/é’‰é’‰é€šçŸ¥
```

### 3.3 æ—¥å¿—ç›‘æ§


**æ—¥å¿—çº§åˆ«è§„èŒƒ**ï¼š

```
ERRORï¼šç³»ç»Ÿå‡ºé”™äº†ï¼Œéœ€è¦ç«‹å³å¤„ç†
WARNï¼šæ½œåœ¨é—®é¢˜ï¼Œéœ€è¦å…³æ³¨
INFOï¼šé‡è¦çš„ä¸šåŠ¡æµç¨‹ä¿¡æ¯
DEBUGï¼šè°ƒè¯•ä¿¡æ¯ï¼ˆç”Ÿäº§ç¯å¢ƒå…³é—­ï¼‰
```

**æ—¥å¿—æ”¶é›†æ¶æ„**ï¼š

```
å¾®æœåŠ¡å®ä¾‹
   â†“ï¼ˆè¾“å‡ºæ—¥å¿—ï¼‰
Filebeatï¼ˆæ—¥å¿—é‡‡é›†ï¼‰
   â†“ï¼ˆä¼ è¾“ï¼‰
Kafkaï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ç¼“å†²ï¼‰
   â†“ï¼ˆæ¶ˆè´¹ï¼‰
Logstashï¼ˆå¤„ç†è¿‡æ»¤ï¼‰
   â†“ï¼ˆå­˜å‚¨ï¼‰
Elasticsearchï¼ˆæœç´¢å¼•æ“ï¼‰
   â†“ï¼ˆå±•ç¤ºï¼‰
Kibanaï¼ˆå¯è§†åŒ–åˆ†æï¼‰
```

**å…³é”®æ—¥å¿—è®°å½•**ï¼š

```java
// ä¸šåŠ¡æ—¥å¿—ç¤ºä¾‹
@Service
public class OrderService {
    
    private static final Logger log = LoggerFactory.getLogger(OrderService.class);
    
    public Order createOrder(OrderDTO dto) {
        // è®°å½•å…³é”®ä¸šåŠ¡æ“ä½œ
        log.info("åˆ›å»ºè®¢å•å¼€å§‹, userId={}, productId={}", 
                 dto.getUserId(), dto.getProductId());
        
        try {
            Order order = doCreateOrder(dto);
            
            // è®°å½•æˆåŠŸç»“æœ
            log.info("è®¢å•åˆ›å»ºæˆåŠŸ, orderId={}, amount={}", 
                     order.getId(), order.getAmount());
            return order;
            
        } catch (Exception e) {
            // è®°å½•é”™è¯¯è¯¦æƒ…
            log.error("è®¢å•åˆ›å»ºå¤±è´¥, userId={}, reason={}", 
                      dto.getUserId(), e.getMessage(), e);
            throw e;
        }
    }
}
```

### 3.4 å‘Šè­¦ç­–ç•¥


**å‘Šè­¦çº§åˆ«åˆ’åˆ†**ï¼š

| çº§åˆ« | è¯´æ˜ | å“åº”æ—¶é—´ | é€šçŸ¥æ–¹å¼ |
|------|------|---------|---------|
| **P0è‡´å‘½** | ç³»ç»Ÿå®Œå…¨ä¸å¯ç”¨ | `ç«‹å³å“åº”` | `ç”µè¯+çŸ­ä¿¡+é’‰é’‰` |
| **P1ç´§æ€¥** | æ ¸å¿ƒåŠŸèƒ½å¼‚å¸¸ | `5åˆ†é’Ÿå†…` | `çŸ­ä¿¡+é’‰é’‰` |
| **P2é‡è¦** | éƒ¨åˆ†åŠŸèƒ½å—å½±å“ | `30åˆ†é’Ÿå†…` | `é’‰é’‰+é‚®ä»¶` |
| **P3ä¸€èˆ¬** | æ½œåœ¨é£é™© | `å·¥ä½œæ—¶é—´å†…` | `é‚®ä»¶` |

**å‘Šè­¦è§„åˆ™ç¤ºä¾‹**ï¼š

```yaml
# Prometheuså‘Šè­¦è§„åˆ™
groups:
- name: microservice-alerts
  rules:
  # æœåŠ¡å®•æœºå‘Šè­¦
  - alert: ServiceDown
    expr: up{job="order-service"} == 0
    for: 1m
    labels:
      severity: P0
    annotations:
      summary: "è®¢å•æœåŠ¡å®•æœº"
      
  # å“åº”æ—¶é—´è¿‡æ…¢å‘Šè­¦
  - alert: HighLatency
    expr: http_request_duration_seconds{quantile="0.99"} > 1
    for: 5m
    labels:
      severity: P1
    annotations:
      summary: "P99å“åº”æ—¶é—´è¶…è¿‡1ç§’"
      
  # CPUä½¿ç”¨ç‡è¿‡é«˜å‘Šè­¦
  - alert: HighCPU
    expr: process_cpu_usage > 0.85
    for: 10m
    labels:
      severity: P2
    annotations:
      summary: "CPUä½¿ç”¨ç‡è¶…è¿‡85%"
```

**é˜²æ­¢å‘Šè­¦é£æš´**ï¼š

```
å‘Šè­¦æ”¶æ•›ç­–ç•¥ï¼š

1. å‘Šè­¦åˆå¹¶ï¼š5åˆ†é’Ÿå†…åŒç±»å‘Šè­¦åªå‘é€1æ¬¡
2. å‘Šè­¦å‡çº§ï¼šP2çº§åˆ«15åˆ†é’Ÿæœªå¤„ç†è‡ªåŠ¨å‡çº§åˆ°P1
3. å‘Šè­¦æŠ‘åˆ¶ï¼šæœåŠ¡å™¨å®•æœºæ—¶ï¼ŒæŠ‘åˆ¶è¯¥æœåŠ¡å™¨ä¸Šæ‰€æœ‰æœåŠ¡çš„å‘Šè­¦
4. é™é»˜æœŸï¼šç»´æŠ¤æœŸé—´æš‚åœå‘Šè­¦
```

---

## 4. ğŸš¨ æ•…éšœåº”æ€¥é¢„æ¡ˆ


### 4.1 å¸¸è§æ•…éšœåœºæ™¯


**æ•…éšœåˆ†ç±»**ï¼š

```
æ•…éšœé‡‘å­—å¡”ï¼ˆæŒ‰å½±å“èŒƒå›´ï¼‰ï¼š

        [æœºæˆ¿çº§æ•…éšœ]  â† æ•´ä¸ªæ•°æ®ä¸­å¿ƒä¸å¯ç”¨
           /    \
      [æœåŠ¡å™¨æ•…éšœ]  â† å•å°æˆ–å¤šå°æœåŠ¡å™¨å®•æœº
        /      \
   [æœåŠ¡æ•…éšœ]  â† æŸä¸ªå¾®æœåŠ¡å¼‚å¸¸
      /    \
  [æ¥å£æ•…éšœ]  â† æŸä¸ªAPIæŠ¥é”™
```

**é«˜é¢‘æ•…éšœåœºæ™¯**ï¼š

| æ•…éšœç±»å‹ | å…¸å‹è¡¨ç° | å¸¸è§åŸå›  |
|---------|---------|---------|
| **æœåŠ¡é›ªå´©** | å¤§é‡æœåŠ¡åŒæ—¶ä¸å¯ç”¨ | `æŸæœåŠ¡æ•…éšœå¯¼è‡´è¿é”ååº”` |
| **æ³¨å†Œä¸­å¿ƒæ•…éšœ** | æœåŠ¡æ— æ³•æ³¨å†Œå‘ç° | `Nacosé›†ç¾¤å…¨æŒ‚` |
| **ç½‘ç»œåˆ†åŒº** | éƒ¨åˆ†æœåŠ¡é€šä¿¡ä¸­æ–­ | `äº¤æ¢æœºæ•…éšœ` |
| **æ•°æ®åº“è¿æ¥æ± è€—å°½** | æœåŠ¡å“åº”è¶…æ—¶ | `æ…¢SQLå¯¼è‡´è¿æ¥ä¸é‡Šæ”¾` |
| **å†…å­˜æº¢å‡º** | æœåŠ¡é¢‘ç¹é‡å¯ | `å†…å­˜æ³„æ¼` |

### 4.2 åº”æ€¥å“åº”æµç¨‹


**æ ‡å‡†åº”æ€¥æµç¨‹**ï¼š

```
æ•…éšœå“åº”SOPï¼ˆæ ‡å‡†æ“ä½œæµç¨‹ï¼‰ï¼š

1. æ•…éšœå‘ç°ï¼ˆ1åˆ†é’Ÿå†…ï¼‰
   â”œâ”€ ç›‘æ§å‘Šè­¦è§¦å‘
   â”œâ”€ ç”¨æˆ·æŠ•è¯‰
   â””â”€ å·¡æ£€å‘ç°

2. æ•…éšœå®šçº§ï¼ˆ2åˆ†é’Ÿå†…ï¼‰
   â”œâ”€ åˆ¤æ–­å½±å“èŒƒå›´
   â”œâ”€ ç¡®å®šä¼˜å…ˆçº§ï¼ˆP0/P1/P2ï¼‰
   â””â”€ å†³å®šå“åº”å›¢é˜Ÿ

3. åº”æ€¥å¤„ç†ï¼ˆ10åˆ†é’Ÿå†…ï¼‰
   â”œâ”€ éš”ç¦»æ•…éšœæœåŠ¡
   â”œâ”€ å¯ç”¨é™çº§ç­–ç•¥
   â””â”€ åˆ‡æ¢å¤‡ç”¨ç³»ç»Ÿ

4. æ ¹å› åˆ†æï¼ˆ1å°æ—¶å†…ï¼‰
   â”œâ”€ æŸ¥çœ‹æ—¥å¿—
   â”œâ”€ åˆ†æç›‘æ§æ•°æ®
   â””â”€ å®šä½é—®é¢˜æ ¹æº

5. é—®é¢˜ä¿®å¤ï¼ˆä¾é—®é¢˜è€Œå®šï¼‰
   â”œâ”€ ç´§æ€¥ä¿®å¤
   â”œâ”€ ç°åº¦éªŒè¯
   â””â”€ å…¨é‡ä¸Šçº¿

6. å¤ç›˜æ€»ç»“ï¼ˆ3å¤©å†…ï¼‰
   â”œâ”€ ç¼–å†™æ•…éšœæŠ¥å‘Š
   â”œâ”€ åˆ¶å®šæ”¹è¿›æªæ–½
   â””â”€ æ›´æ–°åº”æ€¥é¢„æ¡ˆ
```

### 4.3 é™çº§ç†”æ–­ç­–ç•¥


**ä»€ä¹ˆæ˜¯é™çº§**ï¼š

å°±åƒé£æœºé‡åˆ°ç´§æ€¥æƒ…å†µè¦æŠ›å¼ƒè´§ç‰©ä¿è¯äººå‘˜å®‰å…¨ï¼Œç³»ç»Ÿä¹Ÿè¦åœ¨å…³é”®æ—¶åˆ»æ”¾å¼ƒæ¬¡è¦åŠŸèƒ½ä¿è¯æ ¸å¿ƒåŠŸèƒ½ã€‚

**é™çº§ç¤ºä¾‹**ï¼š

```
ç”µå•†å¤§ä¿ƒåœºæ™¯ï¼š

æ­£å¸¸æƒ…å†µï¼š
  æŸ¥çœ‹å•†å“ â†’ æ¨èç›¸ä¼¼å•†å“ â†’ æ˜¾ç¤ºè¯„è®º â†’ åŠ å…¥è´­ç‰©è½¦

ç³»ç»Ÿå‹åŠ›å¤§æ—¶é™çº§ï¼š
  æŸ¥çœ‹å•†å“ â†’ [å…³é—­æ¨è] â†’ [å…³é—­è¯„è®º] â†’ åŠ å…¥è´­ç‰©è½¦
  
ä¿è¯æ ¸å¿ƒåŠŸèƒ½"ä¸‹å•è´­ä¹°"å¯ç”¨ï¼
```

**Sentinelé™çº§é…ç½®**ï¼š

```java
@Service
public class ProductService {
    
    // é™æµè§„åˆ™ï¼šQPSè¶…è¿‡100å°±é™æµ
    @SentinelResource(
        value = "getProduct",
        blockHandler = "handleBlock",
        fallback = "handleFallback"
    )
    public Product getProduct(Long id) {
        // æ­£å¸¸ä¸šåŠ¡é€»è¾‘
        return productMapper.selectById(id);
    }
    
    // è¢«é™æµæ—¶çš„é™çº§æ–¹æ³•
    public Product handleBlock(Long id, BlockException e) {
        // è¿”å›ç¼“å­˜æ•°æ®
        return redisTemplate.opsForValue().get("product:" + id);
    }
    
    // å¼‚å¸¸æ—¶çš„å…œåº•æ–¹æ³•
    public Product handleFallback(Long id, Throwable e) {
        // è¿”å›é»˜è®¤å•†å“
        return Product.builder()
                .id(id)
                .name("å•†å“æš‚æ—¶æ— æ³•æŸ¥çœ‹")
                .build();
    }
}
```

**ç†”æ–­è§„åˆ™é…ç½®**ï¼š

```yaml
# Sentinelç†”æ–­è§„åˆ™
spring:
  cloud:
    sentinel:
      transport:
        dashboard: localhost:8080
      
# ç†”æ–­è§„åˆ™
- resource: getProduct
  grade: DEGRADE_GRADE_EXCEPTION_RATIO  # å¼‚å¸¸æ¯”ä¾‹ç­–ç•¥
  count: 0.5  # å¼‚å¸¸æ¯”ä¾‹è¶…è¿‡50%
  timeWindow: 10  # ç†”æ–­10ç§’
  minRequestAmount: 5  # æœ€å°‘è¯·æ±‚5æ¬¡
```

### 4.4 åº”æ€¥å·¥å…·ç®±


**å¿«é€Ÿè¯Šæ–­å‘½ä»¤**ï¼š

```bash
# 1. æŸ¥çœ‹æœåŠ¡çŠ¶æ€
kubectl get pods -n production

# 2. æŸ¥çœ‹å®æ—¶æ—¥å¿—
kubectl logs -f order-service-xxx --tail=100

# 3. æŸ¥çœ‹èµ„æºä½¿ç”¨
kubectl top pods

# 4. è¿›å…¥å®¹å™¨æ’æŸ¥
kubectl exec -it order-service-xxx -- /bin/bash

# 5. æŸ¥çœ‹ç½‘ç»œè¿æ¥
netstat -antp | grep 8080

# 6. æŸ¥çœ‹çº¿ç¨‹æ ˆ
jstack <pid> > thread_dump.txt

# 7. å¯¼å‡ºå†…å­˜å¿«ç…§
jmap -dump:format=b,file=heap.hprof <pid>
```

**åº”æ€¥è„šæœ¬ç¤ºä¾‹**ï¼š

```bash
#!/bin/bash
# æœåŠ¡ç´§æ€¥é‡å¯è„šæœ¬

SERVICE_NAME="order-service"

echo "å¼€å§‹é‡å¯ $SERVICE_NAME ..."

# 1. æ‘˜é™¤æµé‡
kubectl scale deployment $SERVICE_NAME --replicas=0

# 2. ç­‰å¾…ç°æœ‰è¯·æ±‚å¤„ç†å®Œ
sleep 30

# 3. å¯åŠ¨æ–°å®ä¾‹
kubectl scale deployment $SERVICE_NAME --replicas=3

# 4. ç­‰å¾…å°±ç»ª
kubectl wait --for=condition=ready pod -l app=$SERVICE_NAME --timeout=300s

echo "$SERVICE_NAME é‡å¯å®Œæˆï¼"
```

---

## 5. âš¡ æ€§èƒ½è°ƒä¼˜ç»éªŒ


### 5.1 æ€§èƒ½ç“¶é¢ˆè¯†åˆ«


**æ€§èƒ½é—®é¢˜åˆ†ç±»**ï¼š

```
æ€§èƒ½é—®é¢˜ä¸‰å¤§ç±»ï¼š

1. å“åº”æ…¢
   â”œâ”€ æ•°æ®åº“æ…¢SQL
   â”œâ”€ ç½‘ç»œå»¶è¿Ÿ
   â””â”€ ä»£ç é€»è¾‘å¤æ‚

2. ååé‡ä½
   â”œâ”€ çº¿ç¨‹æ± é…ç½®å°
   â”œâ”€ è¿æ¥æ± ä¸å¤Ÿ
   â””â”€ èµ„æºç«äº‰

3. èµ„æºå ç”¨é«˜
   â”œâ”€ å†…å­˜æ³„æ¼
   â”œâ”€ CPUé£™é«˜
   â””â”€ è¿æ¥æ•°è¿‡å¤š
```

**æ€§èƒ½åˆ†æå·¥å…·**ï¼š

| å·¥å…· | ç”¨é€” | ä½¿ç”¨åœºæ™¯ |
|------|------|---------|
| **JProfiler** | Javaæ€§èƒ½åˆ†æ | `å®šä½CPUã€å†…å­˜çƒ­ç‚¹` |
| **Arthas** | åœ¨çº¿è¯Šæ–­ | `çº¿ä¸Šé—®é¢˜å®æ—¶æ’æŸ¥` |
| **SkyWalking** | é“¾è·¯è¿½è¸ª | `åˆ†ææ…¢è¯·æ±‚è·¯å¾„` |
| **JMeter** | å‹åŠ›æµ‹è¯• | `è¯„ä¼°ç³»ç»Ÿå®¹é‡` |

### 5.2 JVMè°ƒä¼˜


**å†…å­˜é…ç½®ä¼˜åŒ–**ï¼š

```bash
# ç”Ÿäº§ç¯å¢ƒJVMå‚æ•°æ¨è

java -jar order-service.jar \
  -Xms4g \                    # åˆå§‹å †å†…å­˜4G
  -Xmx4g \                    # æœ€å¤§å †å†…å­˜4Gï¼ˆä¸Xmsç›¸åŒï¼Œé¿å…åŠ¨æ€æ‰©å®¹ï¼‰
  -Xmn2g \                    # å¹´è½»ä»£2G
  -XX:MetaspaceSize=256m \    # å…ƒç©ºé—´åˆå§‹å¤§å°
  -XX:MaxMetaspaceSize=512m \ # å…ƒç©ºé—´æœ€å¤§512M
  -XX:+UseG1GC \              # ä½¿ç”¨G1åƒåœ¾å›æ”¶å™¨
  -XX:MaxGCPauseMillis=200 \  # GCåœé¡¿æ—¶é—´ç›®æ ‡200ms
  -XX:+HeapDumpOnOutOfMemoryError \  # OOMæ—¶è‡ªåŠ¨å¯¼å‡ºå †è½¬å‚¨
  -XX:HeapDumpPath=/logs/heapdump.hprof
```

**GCè°ƒä¼˜ç»éªŒ**ï¼š

```
é€‰æ‹©åˆé€‚çš„GCç®—æ³•ï¼š

æœåŠ¡ç±»å‹              æ¨èGC          åŸå› 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å“åº”æ—¶é—´æ•æ„Ÿ          G1GC           åœé¡¿æ—¶é—´å¯æ§
å¤§å †å†…å­˜(>8G)         ZGC            ä½å»¶è¿Ÿ(<10ms)
é«˜ååé‡è¦æ±‚          Parallel GC     ååé‡ä¼˜å…ˆ
å°å †å†…å­˜(<2G)         Serial GC      ç®€å•é«˜æ•ˆ
```

**ç›‘æ§GCæŒ‡æ ‡**ï¼š

```bash
# å¼€å¯GCæ—¥å¿—
-XX:+PrintGCDetails \
-XX:+PrintGCDateStamps \
-Xloggc:/logs/gc.log

# å…³é”®æŒ‡æ ‡
è§‚å¯Ÿé¡¹            æ­£å¸¸èŒƒå›´         å‘Šè­¦é˜ˆå€¼
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
YGCé¢‘ç‡           æ¯åˆ†é’Ÿ<10æ¬¡      æ¯åˆ†é’Ÿ>30æ¬¡
YGCè€—æ—¶           <50ms           >100ms
FGCé¢‘ç‡           æ¯å°æ—¶<1æ¬¡       æ¯å°æ—¶>3æ¬¡
FGCè€—æ—¶           <500ms          >1000ms
```

### 5.3 æ•°æ®åº“ä¼˜åŒ–


**è¿æ¥æ± é…ç½®**ï¼š

```yaml
spring:
  datasource:
    hikari:
      # æœ€å°ç©ºé—²è¿æ¥æ•°
      minimum-idle: 10
      # æœ€å¤§è¿æ¥æ•°ï¼ˆæ ¹æ®å¹¶å‘é‡è°ƒæ•´ï¼‰
      maximum-pool-size: 50
      # è¿æ¥è¶…æ—¶æ—¶é—´
      connection-timeout: 30000
      # ç©ºé—²è¿æ¥å­˜æ´»æ—¶é—´
      idle-timeout: 600000
      # è¿æ¥æœ€å¤§å­˜æ´»æ—¶é—´
      max-lifetime: 1800000
```

**æ…¢SQLä¼˜åŒ–**ï¼š

```sql
-- ä¼˜åŒ–å‰ï¼šå…¨è¡¨æ‰«æ
SELECT * FROM orders WHERE user_id = 123 AND status = 'PAID';

-- ä¼˜åŒ–åï¼šæ·»åŠ ç´¢å¼•
CREATE INDEX idx_user_status ON orders(user_id, status);

-- åªæŸ¥å¿…è¦å­—æ®µ
SELECT id, order_no, amount FROM orders 
WHERE user_id = 123 AND status = 'PAID';
```

**æŸ¥è¯¢ä¼˜åŒ–æŠ€å·§**ï¼š

| ä¼˜åŒ–æ‰‹æ®µ | è¯´æ˜ | æ•ˆæœ |
|---------|------|------|
| **ç´¢å¼•ä¼˜åŒ–** | ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µåŠ ç´¢å¼• | `æŸ¥è¯¢é€Ÿåº¦æå‡10-100å€` |
| **åˆ†é¡µä¼˜åŒ–** | ä½¿ç”¨æ¸¸æ ‡åˆ†é¡µä»£æ›¿offset | `å¤§åç§»é‡æŸ¥è¯¢æé€Ÿ` |
| **è¯»å†™åˆ†ç¦»** | è¯»æ“ä½œèµ°ä»åº“ | `å‡è½»ä¸»åº“å‹åŠ›` |
| **ç¼“å­˜çƒ­ç‚¹æ•°æ®** | Redisç¼“å­˜å¸¸ç”¨æ•°æ® | `å‡å°‘æ•°æ®åº“æŸ¥è¯¢` |

### 5.4 ç½‘ç»œä¼˜åŒ–


**HTTPè¿æ¥ä¼˜åŒ–**ï¼š

```yaml
# Feignå®¢æˆ·ç«¯é…ç½®ä¼˜åŒ–
feign:
  httpclient:
    enabled: true
    max-connections: 200        # æœ€å¤§è¿æ¥æ•°
    max-connections-per-route: 50  # æ¯ä¸ªè·¯ç”±æœ€å¤§è¿æ¥
    connection-timeout: 2000    # è¿æ¥è¶…æ—¶2ç§’
    
  client:
    config:
      default:
        connectTimeout: 2000    # è¿æ¥è¶…æ—¶
        readTimeout: 5000       # è¯»å–è¶…æ—¶
        
# å¯ç”¨HTTPè¿æ¥æ± 
ribbon:
  MaxConnectionsPerHost: 50
  MaxTotalConnections: 200
```

**è¶…æ—¶æ—¶é—´è®¾ç½®**ï¼š

```
è¶…æ—¶æ—¶é—´é‡‘å­—å¡”ï¼ˆå±‚å±‚é€’å‡ï¼‰ï¼š

[ç½‘å…³å±‚] 30ç§’
   â†“
[ä¸šåŠ¡æœåŠ¡] 20ç§’
   â†“
[è°ƒç”¨ä¸‹æ¸¸] 10ç§’
   â†“
[æ•°æ®åº“æŸ¥è¯¢] 5ç§’

åŸåˆ™ï¼šä¸Šæ¸¸è¶…æ—¶ > ä¸‹æ¸¸è¶…æ—¶ + ç¼“å†²æ—¶é—´
```

---

## 6. ğŸ”’ å®‰å…¨åŠ å›ºæªæ–½


### 6.1 è®¤è¯é‰´æƒ


**ä»€ä¹ˆæ˜¯è®¤è¯å’Œé‰´æƒ**ï¼š

- **è®¤è¯ï¼ˆAuthenticationï¼‰**ï¼šä½ æ˜¯è°ï¼ŸéªŒè¯èº«ä»½
- **é‰´æƒï¼ˆAuthorizationï¼‰**ï¼šä½ èƒ½å¹²ä»€ä¹ˆï¼ŸéªŒè¯æƒé™

å°±åƒè¿›å°åŒºï¼š
```
1. è®¤è¯ï¼šé—¨å«çœ‹ä½ çš„èº«ä»½è¯ï¼ˆç¡®è®¤ä½ æ˜¯è°ï¼‰
2. é‰´æƒï¼šæŸ¥ä¸šä¸»åå•ï¼ˆç¡®è®¤ä½ èƒ½ä¸èƒ½è¿›ï¼‰
```

**JWT Tokenæ–¹æ¡ˆ**ï¼š

```
JWTè®¤è¯æµç¨‹ï¼š

ç”¨æˆ·ç™»å½•
   â†“
ç”ŸæˆJWT Tokenï¼ˆåŒ…å«ç”¨æˆ·ä¿¡æ¯ï¼‰
   â†“
è¿”å›ç»™å®¢æˆ·ç«¯
   â†“
åç»­è¯·æ±‚æºå¸¦Token
   â†“
ç½‘å…³éªŒè¯Token
   â†“
è§£æç”¨æˆ·ä¿¡æ¯
   â†“
è®¿é—®ä¸šåŠ¡æœåŠ¡
```

**Tokené…ç½®ç¤ºä¾‹**ï¼š

```java
@Configuration
public class JwtConfig {
    
    @Value("${jwt.secret}")
    private String secret;
    
    @Value("${jwt.expiration}")
    private Long expiration; // è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰
    
    // ç”ŸæˆToken
    public String generateToken(User user) {
        return Jwts.builder()
            .setSubject(user.getUsername())
            .claim("userId", user.getId())
            .claim("roles", user.getRoles())
            .setIssuedAt(new Date())
            .setExpiration(new Date(System.currentTimeMillis() + expiration * 1000))
            .signWith(SignatureAlgorithm.HS512, secret)
            .compact();
    }
    
    // éªŒè¯Token
    public boolean validateToken(String token) {
        try {
            Jwts.parser()
                .setSigningKey(secret)
                .parseClaimsJws(token);
            return true;
        } catch (Exception e) {
            return false;
        }
    }
}
```

### 6.2 æ¥å£é˜²æŠ¤


**é™æµä¿æŠ¤**ï¼š

```java
// ä½¿ç”¨Sentinelé™æµ
@RestController
public class OrderController {
    
    // é™åˆ¶æ¯ç§’æœ€å¤šå¤„ç†100ä¸ªè¯·æ±‚
    @SentinelResource(value = "createOrder", 
                      blockHandler = "handleBlock")
    @PostMapping("/order")
    public Result createOrder(@RequestBody OrderDTO dto) {
        return orderService.create(dto);
    }
    
    // é™æµæ—¶çš„å¤„ç†
    public Result handleBlock(OrderDTO dto, BlockException e) {
        return Result.error("ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•");
    }
}
```

**é˜²é‡æ”¾æ”»å‡»**ï¼š

```java
// æ¥å£é˜²é‡æ”¾
@Component
public class ReplayAttackInterceptor implements HandlerInterceptor {
    
    @Autowired
    private RedisTemplate redisTemplate;
    
    @Override
    public boolean preHandle(HttpServletRequest request, 
                            HttpServletResponse response, 
                            Object handler) {
        String nonce = request.getHeader("X-Nonce");  // éšæœºæ•°
        String timestamp = request.getHeader("X-Timestamp");  // æ—¶é—´æˆ³
        
        // 1. æ£€æŸ¥æ—¶é—´æˆ³ï¼ˆ5åˆ†é’Ÿå†…æœ‰æ•ˆï¼‰
        long now = System.currentTimeMillis();
        if (Math.abs(now - Long.parseLong(timestamp)) > 300000) {
            response.setStatus(401);
            return false;
        }
        
        // 2. æ£€æŸ¥nonceæ˜¯å¦ä½¿ç”¨è¿‡
        String key = "nonce:" + nonce;
        if (redisTemplate.hasKey(key)) {
            response.setStatus(401);
            return false;
        }
        
        // 3. è®°å½•nonceï¼ˆ5åˆ†é’Ÿè¿‡æœŸï¼‰
        redisTemplate.opsForValue().set(key, "1", 5, TimeUnit.MINUTES);
        return true;
    }
}
```

### 6.3 æ•°æ®å®‰å…¨


**æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨**ï¼š

```java
// å¯†ç åŠ å¯†
@Service
public class UserService {
    
    // ä½¿ç”¨BCryptåŠ å¯†å¯†ç 
    public void registerUser(String username, String password) {
        String encryptedPassword = BCrypt.hashpw(password, BCrypt.gensalt());
        
        User user = new User();
        user.setUsername(username);
        user.setPassword(encryptedPassword);  // å­˜å‚¨åŠ å¯†åçš„å¯†ç 
        userMapper.insert(user);
    }
    
    // éªŒè¯å¯†ç 
    public boolean login(String username, String password) {
        User user = userMapper.selectByUsername(username);
        return BCrypt.checkpw(password, user.getPassword());
    }
}
```

**ä¼ è¾“åŠ å¯†**ï¼š

```yaml
# å¯ç”¨HTTPS
server:
  port: 8443
  ssl:
    enabled: true
    key-store: classpath:keystore.p12
    key-store-password: yourpassword
    key-store-type: PKCS12
```

### 6.4 å®‰å…¨å®¡è®¡


**æ“ä½œæ—¥å¿—è®°å½•**ï¼š

```java
@Aspect
@Component
public class AuditLogAspect {
    
    @Autowired
    private AuditLogService auditLogService;
    
    @Around("@annotation(auditLog)")
    public Object recordAuditLog(ProceedingJoinPoint pjp, AuditLog auditLog) {
        AuditLogEntity log = new AuditLogEntity();
        log.setOperationType(auditLog.operation());
        log.setOperator(getCurrentUser());
        log.setOperateTime(new Date());
        log.setIpAddress(getClientIp());
        
        try {
            Object result = pjp.proceed();
            log.setStatus("SUCCESS");
            return result;
        } catch (Exception e) {
            log.setStatus("FAILED");
            log.setErrorMsg(e.getMessage());
            throw e;
        } finally {
            auditLogService.save(log);
        }
    }
}

// ä½¿ç”¨ç¤ºä¾‹
@AuditLog(operation = "åˆ é™¤è®¢å•")
@DeleteMapping("/order/{id}")
public Result deleteOrder(@PathVariable Long id) {
    orderService.delete(id);
    return Result.success();
}
```

---

## 7. ğŸ¤– è¿ç»´è‡ªåŠ¨åŒ–


### 7.1 CI/CDæµç¨‹


**ä»€ä¹ˆæ˜¯CI/CD**ï¼š

- **CIï¼ˆæŒç»­é›†æˆï¼‰**ï¼šä»£ç æäº¤åè‡ªåŠ¨ç¼–è¯‘ã€æµ‹è¯•
- **CDï¼ˆæŒç»­äº¤ä»˜ï¼‰**ï¼šè‡ªåŠ¨éƒ¨ç½²åˆ°æµ‹è¯•/ç”Ÿäº§ç¯å¢ƒ

å°±åƒæµæ°´çº¿ç”Ÿäº§ï¼š
```
ä»£ç æäº¤ â†’ è‡ªåŠ¨æµ‹è¯• â†’ è‡ªåŠ¨æ‰“åŒ… â†’ è‡ªåŠ¨éƒ¨ç½² â†’ è‡ªåŠ¨éªŒè¯
```

**å®Œæ•´CI/CDæµç¨‹**ï¼š

```
GitLab Pipelineæµç¨‹ï¼š

1. ä»£ç æäº¤
   â†“
2. è§¦å‘Pipeline
   â”œâ”€ ä»£ç æ£€æŸ¥ï¼ˆSonarQubeï¼‰
   â”œâ”€ å•å…ƒæµ‹è¯•
   â””â”€ ç¼–è¯‘æ‰“åŒ…
   â†“
3. æ„å»ºDockeré•œåƒ
   â†“
4. æ¨é€åˆ°é•œåƒä»“åº“
   â†“
5. éƒ¨ç½²åˆ°K8Sæµ‹è¯•ç¯å¢ƒ
   â†“
6. è‡ªåŠ¨åŒ–æµ‹è¯•
   â†“
7. äººå·¥å®¡æ‰¹
   â†“
8. éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
   â†“
9. å¥åº·æ£€æŸ¥
```

**GitLab CIé…ç½®ç¤ºä¾‹**ï¼š

```yaml
# .gitlab-ci.yml
stages:
  - build
  - test
  - deploy

variables:
  IMAGE_NAME: order-service
  
# ç¼–è¯‘æ‰“åŒ…
build:
  stage: build
  script:
    - mvn clean package -DskipTests
    - docker build -t $IMAGE_NAME:$CI_COMMIT_SHORT_SHA .
    - docker push $IMAGE_NAME:$CI_COMMIT_SHORT_SHA
    
# è¿è¡Œæµ‹è¯•
test:
  stage: test
  script:
    - mvn test
    
# éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ
deploy-test:
  stage: deploy
  script:
    - kubectl set image deployment/$IMAGE_NAME 
        $IMAGE_NAME=$IMAGE_NAME:$CI_COMMIT_SHORT_SHA 
        -n test
  only:
    - develop
    
# éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼ˆéœ€è¦æ‰‹åŠ¨è§¦å‘ï¼‰
deploy-prod:
  stage: deploy
  script:
    - kubectl set image deployment/$IMAGE_NAME 
        $IMAGE_NAME=$IMAGE_NAME:$CI_COMMIT_SHORT_SHA 
        -n production
  when: manual
  only:
    - master
```

### 7.2 è“ç»¿éƒ¨ç½²


**ä»€ä¹ˆæ˜¯è“ç»¿éƒ¨ç½²**ï¼š

åŒæ—¶ç»´æŠ¤ä¸¤å¥—ç¯å¢ƒï¼š
- **è“ç¯å¢ƒ**ï¼šå½“å‰ç”Ÿäº§ç¯å¢ƒ
- **ç»¿ç¯å¢ƒ**ï¼šæ–°ç‰ˆæœ¬ç¯å¢ƒ

éƒ¨ç½²æ—¶ä¸€é”®åˆ‡æ¢ï¼Œå‡ºé—®é¢˜ç«‹å³å›æ»šã€‚

```
éƒ¨ç½²æµç¨‹ï¼š

1. è“ç¯å¢ƒå¤„ç†æµé‡ï¼ˆv1.0ï¼‰
   â†“
2. åœ¨ç»¿ç¯å¢ƒéƒ¨ç½²æ–°ç‰ˆæœ¬ï¼ˆv2.0ï¼‰
   â†“
3. æµ‹è¯•ç»¿ç¯å¢ƒ
   â†“
4. åˆ‡æ¢æµé‡åˆ°ç»¿ç¯å¢ƒ
   â†“
5. è§‚å¯Ÿç›‘æ§æŒ‡æ ‡
   â†“
6. æ­£å¸¸ï¼Ÿè“ç¯å¢ƒå‡çº§ä¸ºv2.0
   æœ‰é—®é¢˜ï¼Ÿåˆ‡å›è“ç¯å¢ƒ
```

**K8Så®ç°è“ç»¿éƒ¨ç½²**ï¼š

```yaml
# blue-deployment.yamlï¼ˆè“ç¯å¢ƒï¼‰
apiVersion: apps/v1
kind: Deployment
metadata:
  name: order-service-blue
spec:
  replicas: 3
  selector:
    matchLabels:
      app: order-service
      version: blue
  template:
    metadata:
      labels:
        app: order-service
        version: blue
    spec:
      containers:
      - name: order-service
        image: order-service:v1.0
        
---
# green-deployment.yamlï¼ˆç»¿ç¯å¢ƒï¼‰
apiVersion: apps/v1
kind: Deployment
metadata:
  name: order-service-green
spec:
  replicas: 3
  selector:
    matchLabels:
      app: order-service
      version: green
  template:
    metadata:
      labels:
        app: order-service
        version: green
    spec:
      containers:
      - name: order-service
        image: order-service:v2.0
        
---
# service.yamlï¼ˆåˆ‡æ¢ç‰ˆæœ¬åªéœ€ä¿®æ”¹selectorï¼‰
apiVersion: v1
kind: Service
metadata:
  name: order-service
spec:
  selector:
    app: order-service
    version: blue  # æ”¹ä¸ºgreenå³å¯åˆ‡æ¢
  ports:
  - port: 8080
```

### 7.3 è‡ªåŠ¨æ‰©ç¼©å®¹


**æ°´å¹³æ‰©ç¼©å®¹ï¼ˆHPAï¼‰**ï¼š

æ ¹æ®CPUã€å†…å­˜ç­‰æŒ‡æ ‡è‡ªåŠ¨å¢å‡Podæ•°é‡ã€‚

```yaml
# hpa.yaml
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: order-service-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: order-service
  minReplicas: 3    # æœ€å°‘3ä¸ªå®ä¾‹
  maxReplicas: 10   # æœ€å¤š10ä¸ªå®ä¾‹
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70  # CPUè¶…è¿‡70%å°±æ‰©å®¹
  - type: Resource
    resource:
      name: memory
      target:
        type: Utilization
        averageUtilization: 80  # å†…å­˜è¶…è¿‡80%å°±æ‰©å®¹
```

**å®šæ—¶æ‰©ç¼©å®¹**ï¼š

```yaml
# ä¸šåŠ¡é«˜å³°æœŸæå‰æ‰©å®¹
apiVersion: batch/v1
kind: CronJob
metadata:
  name: scale-up-job
spec:
  schedule: "0 9 * * *"  # æ¯å¤©9ç‚¹
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: kubectl
            image: kubectl:latest
            command:
            - kubectl
            - scale
            - deployment/order-service
            - --replicas=10
```

---

## 8. ğŸ‘¥ å›¢é˜Ÿåä½œæœºåˆ¶


### 8.1 å¼€å‘è§„èŒƒ


**ä»£ç è§„èŒƒ**ï¼š

```java
// å¥½çš„ä»£ç ç¤ºä¾‹
@Service
public class OrderService {
    
    private static final Logger log = LoggerFactory.getLogger(OrderService.class);
    
    /**
     * åˆ›å»ºè®¢å•
     * @param dto è®¢å•ä¿¡æ¯
     * @return è®¢å•ID
     * @throws BusinessException ä¸šåŠ¡å¼‚å¸¸
     */
    @Transactional(rollbackFor = Exception.class)
    public Long createOrder(OrderDTO dto) {
        // 1. å‚æ•°æ ¡éªŒ
        validateOrderDTO(dto);
        
        // 2. ä¸šåŠ¡é€»è¾‘
        Order order = buildOrder(dto);
        orderMapper.insert(order);
        
        // 3. å‘é€æ¶ˆæ¯
        sendOrderMessage(order);
        
        log.info("è®¢å•åˆ›å»ºæˆåŠŸ, orderId={}", order.getId());
        return order.getId();
    }
    
    private void validateOrderDTO(OrderDTO dto) {
        Assert.notNull(dto.getUserId(), "ç”¨æˆ·IDä¸èƒ½ä¸ºç©º");
        Assert.notNull(dto.getProductId(), "å•†å“IDä¸èƒ½ä¸ºç©º");
    }
}
```

**åˆ†æ”¯ç®¡ç†è§„èŒƒ**ï¼š

```
Gitåˆ†æ”¯ç­–ç•¥ï¼š

masterï¼ˆä¸»åˆ†æ”¯ï¼‰
  â†“ï¼ˆå®šæœŸåˆå¹¶ï¼‰
releaseï¼ˆé¢„å‘å¸ƒåˆ†æ”¯ï¼‰
  â†“ï¼ˆå®šæœŸåˆå¹¶ï¼‰
developï¼ˆå¼€å‘åˆ†æ”¯ï¼‰
  â†‘ï¼ˆåŠŸèƒ½å¼€å‘ï¼‰
feature/xxxï¼ˆåŠŸèƒ½åˆ†æ”¯ï¼‰
  â†‘ï¼ˆbugä¿®å¤ï¼‰
hotfix/xxxï¼ˆç´§æ€¥ä¿®å¤åˆ†æ”¯ï¼‰
```

### 8.2 æ–‡æ¡£ç®¡ç†


**å¿…å¤‡æ–‡æ¡£æ¸…å•**ï¼š

| æ–‡æ¡£ç±»å‹ | å†…å®¹ | ç»´æŠ¤é¢‘ç‡ |
|---------|------|---------|
| **æ¥å£æ–‡æ¡£** | APIè¯´æ˜ã€å‚æ•°ã€ç¤ºä¾‹ | `æ¯æ¬¡æ¥å£å˜æ›´` |
| **éƒ¨ç½²æ–‡æ¡£** | éƒ¨ç½²æ­¥éª¤ã€é…ç½®è¯´æ˜ | `ç‰ˆæœ¬å‘å¸ƒæ—¶` |
| **è¿ç»´æ‰‹å†Œ** | å¸¸è§é—®é¢˜ã€å¤„ç†æ–¹æ³• | `æœˆåº¦æ›´æ–°` |
| **æ¶æ„æ–‡æ¡£** | ç³»ç»Ÿè®¾è®¡ã€æŠ€æœ¯é€‰å‹ | `å­£åº¦è¯„å®¡` |

**æ¥å£æ–‡æ¡£ç¤ºä¾‹**ï¼š

```java
@Api(tags = "è®¢å•ç®¡ç†")
@RestController
@RequestMapping("/api/order")
public class OrderController {
    
    @ApiOperation("åˆ›å»ºè®¢å•")
    @ApiImplicitParams({
        @ApiImplicitParam(name = "userId", value = "ç”¨æˆ·ID", required = true),
        @ApiImplicitParam(name = "productId", value = "å•†å“ID", required = true),
        @ApiImplicitParam(name = "quantity", value = "è´­ä¹°æ•°é‡", required = true)
    })
    @PostMapping
    public Result<Long> createOrder(@RequestBody OrderDTO dto) {
        Long orderId = orderService.createOrder(dto);
        return Result.success(orderId);
    }
}
```

### 8.3 å€¼ç­æœºåˆ¶


**å€¼ç­èŒè´£**ï¼š

```
å€¼ç­å·¥ç¨‹å¸ˆèŒè´£ï¼š

1. ç›‘æ§å‘Šè­¦å“åº”
   â”œâ”€ åŠæ—¶å¤„ç†å‘Šè­¦
   â”œâ”€ å‡çº§é‡å¤§é—®é¢˜
   â””â”€ è®°å½•å¤„ç†è¿‡ç¨‹

2. æ—¥å¸¸å·¡æ£€
   â”œâ”€ æ£€æŸ¥æœåŠ¡çŠ¶æ€
   â”œâ”€ æŸ¥çœ‹ç›‘æ§æŒ‡æ ‡
   â””â”€ å¤„ç†ç”¨æˆ·åé¦ˆ

3. é—®é¢˜åè°ƒ
   â”œâ”€ å¬é›†ç›¸å…³äººå‘˜
   â”œâ”€ ç»„ç»‡æ•…éšœå¤„ç†
   â””â”€ è·Ÿè¿›é—®é¢˜è§£å†³

4. äº¤æ¥å·¥ä½œ
   â”œâ”€ æœªè§£å†³é—®é¢˜äº¤æ¥
   â”œâ”€ å€¼ç­æ—¥å¿—è®°å½•
   â””â”€ ç»éªŒæ€»ç»“åˆ†äº«
```

**å€¼ç­æ’ç­è¡¨**ï¼š

| æ—¶é—´æ®µ | ä¸€çº¿å€¼ç­ | äºŒçº¿æ”¯æŒ | å¤‡æ³¨ |
|--------|---------|---------|------|
| **å·¥ä½œæ—¥ç™½ç­** | å¼ ä¸‰ | æå›› | `9:00-18:00` |
| **å·¥ä½œæ—¥å¤œç­** | ç‹äº” | èµµå…­ | `18:00-æ¬¡æ—¥9:00` |
| **å‘¨æœ«å…¨å¤©** | è½®å€¼ | æ¶æ„å¸ˆ | `24å°æ—¶` |

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒçŸ¥è¯†


```
ç”Ÿäº§ç¯å¢ƒå…³é”®è¦ç´ ï¼š

ğŸ”¸ éƒ¨ç½²æ¶æ„ï¼šé›†ç¾¤éƒ¨ç½²ã€åˆ†å±‚éš”ç¦»ã€å®¹å™¨åŒ–
ğŸ”¸ é…ç½®ç®¡ç†ï¼šåˆ†å±‚ç®¡ç†ã€åŠ å¯†å­˜å‚¨ã€ç‰ˆæœ¬æ§åˆ¶
ğŸ”¸ ç›‘æ§å‘Šè­¦ï¼šå…¨æ–¹ä½ç›‘æ§ã€åˆ†çº§å‘Šè­¦ã€å¿«é€Ÿå“åº”
ğŸ”¸ åº”æ€¥é¢„æ¡ˆï¼šæ•…éšœåˆ†çº§ã€å¿«é€Ÿæ¢å¤ã€é™çº§ç†”æ–­
ğŸ”¸ æ€§èƒ½è°ƒä¼˜ï¼šJVMè°ƒä¼˜ã€æ•°æ®åº“ä¼˜åŒ–ã€ç½‘ç»œä¼˜åŒ–
ğŸ”¸ å®‰å…¨åŠ å›ºï¼šè®¤è¯é‰´æƒã€æ¥å£é˜²æŠ¤ã€æ•°æ®åŠ å¯†
ğŸ”¸ è‡ªåŠ¨åŒ–ï¼šCI/CDã€è“ç»¿éƒ¨ç½²ã€è‡ªåŠ¨æ‰©ç¼©å®¹
ğŸ”¸ å›¢é˜Ÿåä½œï¼šè§„èŒƒåˆ¶åº¦ã€æ–‡æ¡£å®Œå–„ã€å€¼ç­æœºåˆ¶
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ é«˜å¯ç”¨æ¶æ„è®¾è®¡**
```
æ ¸å¿ƒåŸåˆ™ï¼š
- æ— å•ç‚¹æ•…éšœï¼šä»»ä½•ç»„ä»¶éƒ½è¦æœ‰å†—ä½™
- æ•…éšœéš”ç¦»ï¼šä¸€ä¸ªæœåŠ¡å‡ºé—®é¢˜ä¸å½±å“å…¶ä»–
- å¿«é€Ÿæ¢å¤ï¼šæ•…éšœåèƒ½è‡ªåŠ¨æˆ–å¿«é€Ÿæ¢å¤
- é™çº§ä¿åº•ï¼šæ ¸å¿ƒåŠŸèƒ½å¿…é¡»ä¿è¯å¯ç”¨
```

**ğŸ”¹ ç›‘æ§å‘Šè­¦æœ€ä½³å®è·µ**
```
ç›‘æ§é‡‘å­—å¡”ï¼š
- åŸºç¡€ç›‘æ§ï¼šCPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œ
- åº”ç”¨ç›‘æ§ï¼šQPSã€å“åº”æ—¶é—´ã€é”™è¯¯ç‡
- ä¸šåŠ¡ç›‘æ§ï¼šè®¢å•é‡ã€æ”¯ä»˜æˆåŠŸç‡ç­‰
- ç”¨æˆ·ä½“éªŒï¼šé¡µé¢åŠ è½½æ—¶é—´ã€å¯ç”¨æ€§
```

**ğŸ”¹ æ•…éšœå¤„ç†å››æ­¥æ³•**
```
1. å¿«é€Ÿæ­¢æŸï¼šå…ˆæ¢å¤æœåŠ¡ï¼Œå†æŸ¥åŸå› 
2. å®šä½æ ¹å› ï¼šé€šè¿‡æ—¥å¿—ã€ç›‘æ§æ‰¾é—®é¢˜
3. å½»åº•ä¿®å¤ï¼šä»æ ¹æœ¬ä¸Šè§£å†³é—®é¢˜
4. å¤ç›˜æ”¹è¿›ï¼šé¿å…åŒç±»é—®é¢˜å†æ¬¡å‘ç”Ÿ
```

### 9.3 å®æˆ˜ç»éªŒæ€»ç»“


**âœ… æœ€ä½³å®è·µ**
- æ³¨å†Œä¸­å¿ƒè‡³å°‘éƒ¨ç½²3ä¸ªèŠ‚ç‚¹ï¼Œåˆ†å¸ƒåœ¨ä¸åŒæœºæˆ¿
- é…ç½®å˜æ›´å¿…é¡»ç»è¿‡æµ‹è¯•ç¯å¢ƒéªŒè¯
- å‘Šè­¦åˆ†çº§å“åº”ï¼ŒP0çº§åˆ«å¿…é¡»ç”µè¯é€šçŸ¥
- å®šæœŸè¿›è¡Œæ•…éšœæ¼”ç»ƒï¼Œæå‡åº”æ€¥èƒ½åŠ›
- JVMå‚æ•°æ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹è°ƒæ•´ï¼Œä¸è¦ç…§æ¬
- æ‰€æœ‰æ¥å£éƒ½è¦æœ‰é™æµã€é™çº§ã€ç†”æ–­ä¿æŠ¤
- CI/CDæµç¨‹è¦åŒ…å«è‡ªåŠ¨åŒ–æµ‹è¯•
- é‡è¦æ“ä½œå¿…é¡»è®°å½•å®¡è®¡æ—¥å¿—

**âŒ å¸¸è§é™·é˜±**
- æ‰€æœ‰æœåŠ¡éƒ¨ç½²åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼ˆå•ç‚¹æ•…éšœï¼‰
- æ•æ„Ÿé…ç½®æ˜æ–‡å­˜å‚¨ï¼ˆå®‰å…¨éšæ‚£ï¼‰
- æ²¡æœ‰å‘Šè­¦æˆ–å‘Šè­¦å¤ªå¤šå¯¼è‡´éº»ç—¹ï¼ˆç›‘æ§å¤±æ•ˆï¼‰
- æ•…éšœå‘ç”Ÿæ—¶æ‰æƒ³èµ·æ²¡æœ‰åº”æ€¥é¢„æ¡ˆï¼ˆæªæ‰‹ä¸åŠï¼‰
- ç›²ç›®è¿½æ±‚æ€§èƒ½å¿½è§†ç¨³å®šæ€§ï¼ˆæœ¬æœ«å€’ç½®ï¼‰
- æƒé™ç®¡ç†æ··ä¹±ï¼Œæ‰€æœ‰äººéƒ½æ˜¯ç®¡ç†å‘˜ï¼ˆå®‰å…¨é£é™©ï¼‰
- æ‰‹å·¥éƒ¨ç½²å®¹æ˜“å‡ºé”™ï¼ˆæ•ˆç‡ä½ä¸”ä¸å¯é ï¼‰
- æ–‡æ¡£é•¿æœŸä¸æ›´æ–°æˆä¸ºæ‘†è®¾ï¼ˆå¤±å»ä»·å€¼ï¼‰

**ğŸ’¡ æ ¸å¿ƒè®°å¿†å£è¯€**
```
é«˜å¯ç”¨æ¶æ„ä¸å•ç‚¹ï¼Œç›‘æ§å‘Šè­¦è¦å…¨é¢
é…ç½®ç®¡ç†åˆ†å±‚çº§ï¼Œæ•æ„Ÿæ•°æ®å¿…åŠ å¯†
æ•…éšœé¢„æ¡ˆæ—©å‡†å¤‡ï¼Œé™çº§ç†”æ–­æ˜¯ä¿é™©
æ€§èƒ½è°ƒä¼˜éœ€å®æµ‹ï¼Œå®‰å…¨åŠ å›ºä¸èƒ½å¿˜
è‡ªåŠ¨éƒ¨ç½²ææ•ˆç‡ï¼Œå›¢é˜Ÿåä½œé è§„èŒƒ
```

**ğŸ¯ å®é™…åº”ç”¨ä»·å€¼**
- **ç”µå•†åœºæ™¯**ï¼šå¤§ä¿ƒæœŸé—´è‡ªåŠ¨æ‰©å®¹ï¼Œæ•…éšœå¿«é€Ÿé™çº§
- **é‡‘èç³»ç»Ÿ**ï¼šä¸¥æ ¼çš„å®‰å…¨å®¡è®¡ï¼Œå®Œå–„çš„åº”æ€¥é¢„æ¡ˆ
- **ç¤¾äº¤å¹³å°**ï¼šå…¨é“¾è·¯ç›‘æ§ï¼Œé—®é¢˜ç§’çº§å®šä½
- **ä¼ä¸šåº”ç”¨**ï¼šè§„èŒƒçš„CI/CDæµç¨‹ï¼Œé«˜æ•ˆçš„å›¢é˜Ÿåä½œ

**æ ¸å¿ƒç†å¿µ**ï¼š
> ç”Ÿäº§ç¯å¢ƒæ— å°äº‹ï¼Œç¨³å®šå‹å€’ä¸€åˆ‡ã€‚æå‰è§„åˆ’ã€å……åˆ†å‡†å¤‡ã€å¿«é€Ÿå“åº”ã€æŒç»­æ”¹è¿›ï¼Œæ‰èƒ½ä¿è¯ç³»ç»Ÿç¨³å®šå¯é è¿è¡Œã€‚