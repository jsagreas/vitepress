---
title: 3ã€OAuth2.0åŸºæœ¬æµç¨‹
---
## ðŸ“š ç›®å½•

1. [OAuth2.0æ˜¯ä»€ä¹ˆ](#1-OAuth2.0æ˜¯ä»€ä¹ˆ)
2. [OAuth2.0æŽˆæƒæµç¨‹è¯¦è§£](#2-OAuth2.0æŽˆæƒæµç¨‹è¯¦è§£)
3. [Tokenäº¤æ¢æœºåˆ¶](#3-Tokenäº¤æ¢æœºåˆ¶)
4. [æŽˆæƒç çš„ä½œç”¨](#4-æŽˆæƒç çš„ä½œç”¨)
5. [è®¿é—®ä»¤ç‰Œè¯¦è§£](#5-è®¿é—®ä»¤ç‰Œè¯¦è§£)
6. [é‡å®šå‘URIæœºåˆ¶](#6-é‡å®šå‘URIæœºåˆ¶)
7. [Tokenç”Ÿå‘½å‘¨æœŸç®¡ç†](#7-Tokenç”Ÿå‘½å‘¨æœŸç®¡ç†)
8. [å®‰å…¨è€ƒè™‘è¦ç‚¹](#8-å®‰å…¨è€ƒè™‘è¦ç‚¹)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ðŸ” OAuth2.0æ˜¯ä»€ä¹ˆ


### 1.1 ç”Ÿæ´»ä¸­çš„æŽˆæƒåœºæ™¯


**å…ˆä»Žä¸€ä¸ªç”Ÿæ´»ä¾‹å­ç†è§£OAuth2.0**ï¼š

æƒ³è±¡ä½ è¦åŽ»é“¶è¡ŒåŠžç†ä¸šåŠ¡ï¼Œä½†è‡ªå·±æ²¡æ—¶é—´ï¼ŒäºŽæ˜¯å§”æ‰˜æœ‹å‹å°æŽåŽ»å¸®å¿™ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š

```
ä½ çš„æŽˆæƒè¿‡ç¨‹ï¼š
1. ä½ å†™ä¸€å¼ æŽˆæƒä¹¦ï¼ˆæŽˆæƒç ï¼‰
2. å°æŽæ‹¿ç€æŽˆæƒä¹¦åŽ»é“¶è¡Œ
3. é“¶è¡ŒéªŒè¯æŽˆæƒä¹¦ï¼Œç»™å°æŽä¸´æ—¶å‡­è¯ï¼ˆè®¿é—®ä»¤ç‰Œï¼‰
4. å°æŽç”¨ä¸´æ—¶å‡­è¯åŠžç†å…·ä½“ä¸šåŠ¡
5. åŠžå®Œäº‹ï¼Œä¸´æ—¶å‡­è¯è‡ªåŠ¨å¤±æ•ˆ

å…³é”®ç‚¹ï¼š
âœ… ä½ æ²¡æœ‰æŠŠé“¶è¡Œå¯†ç å‘Šè¯‰å°æŽ
âœ… æŽˆæƒä¹¦æœ‰æ˜Žç¡®çš„æƒé™èŒƒå›´ï¼ˆåªèƒ½æŸ¥ä½™é¢ï¼Œä¸èƒ½å–æ¬¾ï¼‰
âœ… ä¸´æ—¶å‡­è¯æœ‰æ—¶é—´é™åˆ¶
âœ… ä½ å¯ä»¥éšæ—¶æ’¤é”€æŽˆæƒ
```

**OAuth2.0å°±æ˜¯è¿™ä¸ªæ€æƒ³åœ¨äº’è”ç½‘ä¸Šçš„åº”ç”¨**ï¼

### 1.2 OAuth2.0çš„æ ¸å¿ƒç†å¿µ


**OAuth2.0æ˜¯ä»€ä¹ˆï¼Ÿ**
ä¸€å¥è¯è¯´æ¸…æ¥šï¼š**OAuth2.0æ˜¯ä¸€ç§æŽˆæƒæ¡†æž¶ï¼Œè®©ä½ å¯ä»¥æŽˆæƒç¬¬ä¸‰æ–¹åº”ç”¨è®¿é—®ä½ çš„èµ„æºï¼Œè€Œä¸éœ€è¦æŠŠå¯†ç å‘Šè¯‰å®ƒ**ã€‚

```
ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜ï¼š
âŒ ç”¨æˆ·åœºæ™¯ï¼šæƒ³ç”¨ç¾Žå›¾ç§€ç§€ä¿®æ”¹å¾®ä¿¡å¤´åƒ
âŒ ä¼ ç»Ÿåšæ³•ï¼šæŠŠå¾®ä¿¡è´¦å·å¯†ç å‘Šè¯‰ç¾Žå›¾ç§€ç§€
âŒ å®‰å…¨éšæ‚£ï¼š
   â€¢ ç¾Žå›¾ç§€ç§€èŽ·å¾—äº†ä½ å¾®ä¿¡çš„å…¨éƒ¨æƒé™
   â€¢ å¯†ç æ³„éœ²é£Žé™©
   â€¢ æ— æ³•æ’¤é”€æŽˆæƒ
   â€¢ å¯†ç ä¿®æ”¹åŽç¾Žå›¾ç§€ç§€ä¹Ÿèƒ½ç”¨

OAuth2.0çš„è§£å†³æ–¹æ¡ˆï¼š
âœ… ç”¨æˆ·åœºæ™¯ï¼šè¿˜æ˜¯ç”¨ç¾Žå›¾ç§€ç§€ä¿®æ”¹å¾®ä¿¡å¤´åƒ
âœ… OAuth2.0åšæ³•ï¼šå¾®ä¿¡ç»™ç¾Žå›¾ç§€ç§€å‘ä¸€ä¸ªä¸´æ—¶ä»¤ç‰Œ
âœ… å®‰å…¨ä¼˜åŠ¿ï¼š
   â€¢ ä»¤ç‰Œåªæœ‰è¯»å†™å¤´åƒçš„æƒé™ï¼Œçœ‹ä¸äº†èŠå¤©è®°å½•
   â€¢ ä»¤ç‰Œæœ‰æ—¶æ•ˆæ€§ï¼Œè‡ªåŠ¨è¿‡æœŸ
   â€¢ å¯ä»¥éšæ—¶æ’¤é”€ä»¤ç‰Œ
   â€¢ å¯†ç æ°¸è¿œä¸ä¼šæš´éœ²
```

### 1.3 OAuth2.0çš„å››ä¸ªè§’è‰²


åœ¨OAuth2.0çš„ä¸–ç•Œé‡Œï¼Œæœ‰å››ä¸ªå…³é”®è§’è‰²åœ¨"å”±æˆ"ï¼š

```
ðŸŽ­ OAuth2.0å››å¤§è§’è‰²ï¼š

1. èµ„æºæ‹¥æœ‰è€… (Resource Owner) - ä½ 
   â””â”€ å°±æ˜¯æ‹¥æœ‰æ•°æ®çš„ç”¨æˆ·æœ¬äºº
   â””â”€ ä¾‹å­ï¼šä½ æ˜¯å¾®ä¿¡è´¦å·çš„ä¸»äºº

2. å®¢æˆ·ç«¯ (Client) - ç¬¬ä¸‰æ–¹åº”ç”¨
   â””â”€ æƒ³è¦è®¿é—®ç”¨æˆ·èµ„æºçš„åº”ç”¨
   â””â”€ ä¾‹å­ï¼šç¾Žå›¾ç§€ç§€App

3. æŽˆæƒæœåŠ¡å™¨ (Authorization Server) - å‘è¯æœºå…³
   â””â”€ è´Ÿè´£éªŒè¯ç”¨æˆ·èº«ä»½å¹¶å‘æ”¾ä»¤ç‰Œ
   â””â”€ ä¾‹å­ï¼šå¾®ä¿¡çš„æŽˆæƒç™»å½•æœåŠ¡å™¨

4. èµ„æºæœåŠ¡å™¨ (Resource Server) - èµ„æºä¿ç®¡è€…
   â””â”€ å­˜å‚¨ç”¨æˆ·èµ„æºï¼ŒéªŒè¯ä»¤ç‰ŒåŽæä¾›æ•°æ®
   â””â”€ ä¾‹å­ï¼šå¾®ä¿¡å­˜å‚¨å¤´åƒçš„æœåŠ¡å™¨

è§’è‰²åä½œæµç¨‹ï¼š
èµ„æºæ‹¥æœ‰è€… â†’ æŽˆæƒç»™å®¢æˆ·ç«¯ â†’ å®¢æˆ·ç«¯å‘æŽˆæƒæœåŠ¡å™¨ç”³è¯·ä»¤ç‰Œ 
â†’ æ‹¿åˆ°ä»¤ç‰ŒåŽå‘èµ„æºæœåŠ¡å™¨è¯·æ±‚æ•°æ®
```

---

## 2. ðŸ”„ OAuth2.0æŽˆæƒæµç¨‹è¯¦è§£


### 2.1 æŽˆæƒç æ¨¡å¼å®Œæ•´æµç¨‹


æŽˆæƒç æ¨¡å¼æ˜¯OAuth2.0ä¸­**æœ€å®‰å…¨ã€æœ€å¸¸ç”¨**çš„æŽˆæƒæ–¹å¼ã€‚æˆ‘ä»¬ç”¨ä¸€ä¸ªå®Œæ•´çš„åœºæ™¯æ¥ç†è§£ï¼š

**åœºæ™¯**ï¼šä½ æƒ³ç”¨"æ¯æ—¥ä¸€å›¾"ç½‘ç«™å±•ç¤ºä½ çš„å¾®ä¿¡æœ‹å‹åœˆç…§ç‰‡

```
ðŸ“± å®Œæ•´æŽˆæƒæµç¨‹å›¾ï¼š

ç”¨æˆ·(ä½ )          æ¯æ—¥ä¸€å›¾ç½‘ç«™        å¾®ä¿¡æŽˆæƒæœåŠ¡å™¨      å¾®ä¿¡èµ„æºæœåŠ¡å™¨
  â”‚                   â”‚                    â”‚                  â”‚
  â”‚â”€â”€1.è®¿é—®ç½‘ç«™â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                  â”‚
  â”‚                   â”‚                    â”‚                  â”‚
  â”‚<â”€2.è·³è½¬åˆ°å¾®ä¿¡ç™»å½•â”€â”€â”‚â”€â”€å¼•å¯¼ç™»å½•æŽˆæƒâ”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
  â”‚                   â”‚                    â”‚                  â”‚
  â”‚â”€â”€3.è¾“å…¥å¾®ä¿¡è´¦å·å¯†ç â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
  â”‚                   â”‚                    â”‚                  â”‚
  â”‚<â”€4.ç¡®è®¤æŽˆæƒé¡µé¢â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
  â”‚  "æ¯æ—¥ä¸€å›¾æƒ³è®¿é—®ä½ çš„æœ‹å‹åœˆç…§ç‰‡"          â”‚                  â”‚
  â”‚                   â”‚                    â”‚                  â”‚
  â”‚â”€â”€5.ç‚¹å‡»åŒæ„æŽˆæƒâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
  â”‚                   â”‚                    â”‚                  â”‚
  â”‚<â”€6.å¸¦ç€æŽˆæƒç è·³å›žâ”€â”¤<â”€â”€è¿”å›žæŽˆæƒç â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
  â”‚  (é‡å®šå‘)          â”‚  code=ABC123       â”‚                  â”‚
  â”‚                   â”‚                    â”‚                  â”‚
  â”‚                   â”‚â”€â”€7.ç”¨æŽˆæƒç æ¢ä»¤ç‰Œâ”€â”€â”€>â”‚                  â”‚
  â”‚                   â”‚  code+å¯†é’¥          â”‚                  â”‚
  â”‚                   â”‚                    â”‚                  â”‚
  â”‚                   â”‚<â”€8.è¿”å›žè®¿é—®ä»¤ç‰Œâ”€â”€â”€â”€â”€â”¤                  â”‚
  â”‚                   â”‚  access_token       â”‚                  â”‚
  â”‚                   â”‚                    â”‚                  â”‚
  â”‚                   â”‚â”€â”€9.ç”¨ä»¤ç‰ŒèŽ·å–ç…§ç‰‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                   â”‚  token=XYZ789                          â”‚
  â”‚                   â”‚                                        â”‚
  â”‚                   â”‚<â”€10.è¿”å›žç…§ç‰‡æ•°æ®â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                   â”‚                                        â”‚
  â”‚<â”€11.å±•ç¤ºç…§ç‰‡â”€â”€â”€â”€â”€â”€â”€â”¤                                        â”‚
```

### 2.2 æµç¨‹æ­¥éª¤è¯¦è§£


è®©æˆ‘ä»¬æŠŠæ¯ä¸€æ­¥éƒ½è¯´æ¸…æ¥šï¼š

**ðŸ”¸ æ­¥éª¤1-2ï¼šå‘èµ·æŽˆæƒè¯·æ±‚**
```
ä½ ç‚¹å‡»"æ¯æ—¥ä¸€å›¾"ç½‘ç«™çš„"å¾®ä¿¡ç™»å½•"æŒ‰é’®

æ¯æ—¥ä¸€å›¾æž„é€ ä¸€ä¸ªæŽˆæƒURLï¼š
https://wx.qq.com/oauth/authorize?
  response_type=code              â† è¯´æ˜Žæˆ‘è¦æŽˆæƒç 
  &client_id=æ¯æ—¥ä¸€å›¾çš„åº”ç”¨ID      â† è¡¨æ˜Žè‡ªå·±çš„èº«ä»½
  &redirect_uri=http://daily.com/callback  â† æŽˆæƒåŽè·³å›žå“ªé‡Œ
  &scope=photos                   â† ç”³è¯·çš„æƒé™èŒƒå›´
  &state=xyz123                   â† é˜²æ­¢CSRFæ”»å‡»çš„éšæœºå€¼

ç„¶åŽæµè§ˆå™¨è·³è½¬åˆ°è¿™ä¸ªURLï¼ˆè·³åˆ°å¾®ä¿¡ç™»å½•é¡µï¼‰
```

**ðŸ”¸ æ­¥éª¤3-5ï¼šç”¨æˆ·æŽˆæƒ**
```
åœ¨å¾®ä¿¡çš„æŽˆæƒé¡µé¢ï¼š
1. ä½ è¾“å…¥å¾®ä¿¡è´¦å·å¯†ç ï¼ˆæ³¨æ„ï¼šå¯†ç åªç»™å¾®ä¿¡ï¼Œæ²¡ç»™æ¯æ—¥ä¸€å›¾ï¼‰
2. å¾®ä¿¡éªŒè¯ä½ çš„èº«ä»½
3. æ˜¾ç¤ºæŽˆæƒç¡®è®¤é¡µï¼š
   "æ¯æ—¥ä¸€å›¾ æƒ³è¦è®¿é—®ï¼š
    âœ“ ä½ çš„æœ‹å‹åœˆç…§ç‰‡
    âœ“ ä½ çš„æ˜µç§°å’Œå¤´åƒ"
4. ä½ ç‚¹å‡»"åŒæ„æŽˆæƒ"
```

**ðŸ”¸ æ­¥éª¤6ï¼šèŽ·å¾—æŽˆæƒç **
```
å¾®ä¿¡ç”Ÿæˆä¸€ä¸ªæŽˆæƒç ï¼ˆçŸ­æœŸæœ‰æ•ˆï¼Œä¸€èˆ¬10åˆ†é’Ÿï¼‰
æŽˆæƒç ï¼šABC123XYZ

å¾®ä¿¡æŠŠä½ çš„æµè§ˆå™¨é‡å®šå‘å›žæ¯æ—¥ä¸€å›¾ï¼š
http://daily.com/callback?
  code=ABC123XYZ              â† è¿™å°±æ˜¯æŽˆæƒç 
  &state=xyz123               â† éªŒè¯stateé˜²ç¯¡æ”¹

æ­¤æ—¶æ¯æ—¥ä¸€å›¾æ‹¿åˆ°äº†æŽˆæƒç ï¼Œä½†è¿˜ä¸èƒ½è®¿é—®ä½ çš„ç…§ç‰‡
```

**ðŸ”¸ æ­¥éª¤7-8ï¼šç”¨æŽˆæƒç æ¢è®¿é—®ä»¤ç‰Œ**
```
æ¯æ—¥ä¸€å›¾åœ¨åŽå°ï¼ˆæ³¨æ„ï¼šä¸æ˜¯æµè§ˆå™¨ï¼‰å‘å¾®ä¿¡å‘è¯·æ±‚ï¼š

POST https://wx.qq.com/oauth/token
å‚æ•°ï¼š
  grant_type=authorization_code   â† è¯´æ˜Žç”¨æŽˆæƒç æ¢ä»¤ç‰Œ
  code=ABC123XYZ                  â† åˆšæ‰æ‹¿åˆ°çš„æŽˆæƒç 
  client_id=æ¯æ—¥ä¸€å›¾çš„åº”ç”¨ID
  client_secret=æ¯æ—¥ä¸€å›¾çš„å¯†é’¥    â† è¯æ˜Žæ˜¯æ¯æ—¥ä¸€å›¾æœ¬äºº
  redirect_uri=http://daily.com/callback

å¾®ä¿¡éªŒè¯é€šè¿‡åŽè¿”å›žï¼š
{
  "access_token": "XYZ789...",     â† è®¿é—®ä»¤ç‰Œ
  "token_type": "Bearer",
  "expires_in": 3600,              â† æœ‰æ•ˆæœŸ1å°æ—¶
  "refresh_token": "DEF456...",    â† åˆ·æ–°ä»¤ç‰Œ
  "scope": "photos"
}
```

**ðŸ”¸ æ­¥éª¤9-10ï¼šè®¿é—®èµ„æº**
```
æ¯æ—¥ä¸€å›¾ç”¨è®¿é—®ä»¤ç‰Œè¯·æ±‚ä½ çš„ç…§ç‰‡ï¼š

GET https://wx.qq.com/api/photos
Header: Authorization: Bearer XYZ789...

å¾®ä¿¡èµ„æºæœåŠ¡å™¨ï¼š
1. éªŒè¯ä»¤ç‰Œæœ‰æ•ˆæ€§
2. æ£€æŸ¥ä»¤ç‰Œæƒé™ï¼ˆç¡®å®žæœ‰photosæƒé™ï¼‰
3. è¿”å›žç…§ç‰‡æ•°æ®

æ¯æ—¥ä¸€å›¾æ”¶åˆ°ç…§ç‰‡æ•°æ®ï¼Œå±•ç¤ºç»™ä½ çœ‹
```

### 2.3 ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆå¤æ‚ï¼Ÿ


ä½ å¯èƒ½ä¼šé—®ï¼šä¸ºä»€ä¹ˆä¸ç›´æŽ¥ç»™è®¿é—®ä»¤ç‰Œï¼Œè¦å…ˆç»™æŽˆæƒç å†æ¢ä»¤ç‰Œï¼Ÿ

```
ðŸ¤” æŽˆæƒç æ¨¡å¼çš„å®‰å…¨è®¾è®¡ï¼š

é—®é¢˜ï¼šå¦‚æžœç›´æŽ¥è¿”å›žè®¿é—®ä»¤ç‰Œä¼šæ€Žæ ·ï¼Ÿ
å±é™©åœºæ™¯ï¼š
  é‡å®šå‘URL: http://daily.com/callback?access_token=XYZ789
  â†‘ è¿™ä¸ªURLä¼šè®°å½•åœ¨ï¼š
     â€¢ æµè§ˆå™¨åŽ†å²
     â€¢ æœåŠ¡å™¨æ—¥å¿—
     â€¢ å¯èƒ½è¢«æµè§ˆå™¨æ’ä»¶è¯»å–
     â€¢ å¯èƒ½è¢«ç½‘ç»œä»£ç†çœ‹åˆ°

æŽˆæƒç çš„å®‰å…¨ä¼˜åŠ¿ï¼š
âœ… æŽˆæƒç åªèƒ½ç”¨ä¸€æ¬¡ï¼Œç”¨å®Œå°±å¤±æ•ˆ
âœ… æŽˆæƒç æœ‰æ•ˆæœŸå¾ˆçŸ­ï¼ˆ10åˆ†é’Ÿï¼‰
âœ… æŽˆæƒç æœ¬èº«ä¸èƒ½è®¿é—®èµ„æº
âœ… æ¢ä»¤ç‰Œæ—¶éœ€è¦client_secretï¼ˆåªæœ‰æœåŠ¡å™¨çŸ¥é“ï¼‰
âœ… æ¢ä»¤ç‰Œçš„è¯·æ±‚åœ¨åŽç«¯å®Œæˆï¼Œä¸ç»è¿‡æµè§ˆå™¨

ä¸¤æ­¥éªŒè¯ï¼š
ç¬¬ä¸€æ­¥ï¼šæµè§ˆå™¨ç«¯æ‹¿æŽˆæƒç ï¼ˆå¯ä»¥æš´éœ²ï¼‰
ç¬¬äºŒæ­¥ï¼šæœåŠ¡å™¨ç«¯ç”¨æŽˆæƒç +å¯†é’¥æ¢ä»¤ç‰Œï¼ˆå®‰å…¨ï¼‰
```

---

## 3. ðŸ”„ Tokenäº¤æ¢æœºåˆ¶


### 3.1 ä»€ä¹ˆæ˜¯Tokenäº¤æ¢


**Tokenäº¤æ¢çš„æœ¬è´¨**ï¼šå°±æ˜¯ç”¨**ä¸´æ—¶å‡­è¯**ï¼ˆæŽˆæƒç ï¼‰æ¢å–**æ­£å¼å‡­è¯**ï¼ˆè®¿é—®ä»¤ç‰Œï¼‰çš„è¿‡ç¨‹ã€‚

```
ç±»æ¯”ç†è§£ï¼š
æŽˆæƒç  = æè´§å•
  â€¢ åªæ˜¯ä¸ªå‡­æ®ï¼Œæœ¬èº«ä¸èƒ½ç”¨
  â€¢ æœ‰æ•ˆæœŸçŸ­
  â€¢ åªèƒ½ç”¨ä¸€æ¬¡

è®¿é—®ä»¤ç‰Œ = å®žé™…çš„è´§ç‰©æå–å¡
  â€¢ å¯ä»¥ç›´æŽ¥ä½¿ç”¨
  â€¢ æœ‰æ•ˆæœŸç›¸å¯¹è¾ƒé•¿
  â€¢ å¯ä»¥åå¤ä½¿ç”¨ï¼ˆç›´åˆ°è¿‡æœŸï¼‰
```

### 3.2 Tokenäº¤æ¢çš„è¯¦ç»†è¿‡ç¨‹


**ðŸ”§ äº¤æ¢è¯·æ±‚çš„æž„æˆ**ï¼š

```
HTTPè¯·æ±‚ç»“æž„ï¼š
POST /oauth/token HTTP/1.1
Host: authorization-server.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code     â† æŽˆæƒç±»åž‹ï¼šæŽˆæƒç æ¨¡å¼
&code=ABC123XYZ                   â† åˆšèŽ·å¾—çš„æŽˆæƒç 
&redirect_uri=http://client.com/callback  â† å¿…é¡»ä¸Žä¹‹å‰ä¸€è‡´
&client_id=CLIENT_ID              â† å®¢æˆ·ç«¯æ ‡è¯†
&client_secret=CLIENT_SECRET      â† å®¢æˆ·ç«¯å¯†é’¥

å…³é”®ç‚¹è§£æžï¼š
1. grant_typeï¼šå‘Šè¯‰æœåŠ¡å™¨è¿™æ˜¯æŽˆæƒç æ¢ä»¤ç‰Œ
2. codeï¼šä¸€æ¬¡æ€§ä½¿ç”¨çš„æŽˆæƒç 
3. redirect_uriï¼šå®‰å…¨æ ¡éªŒï¼Œå¿…é¡»ä¸Žç”³è¯·æ—¶ä¸€è‡´
4. client_secretï¼šè¯æ˜Žä½ æ˜¯åˆæ³•çš„å®¢æˆ·ç«¯
```

**ðŸ“¦ æˆåŠŸå“åº”çš„ç»“æž„**ï¼š

```
HTTPå“åº”ï¼š
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "Bearer",
  "expires_in": 3600,
  "refresh_token": "tGzv3JOkF0XG5Qx2TlKWIA",
  "scope": "read write"
}

å­—æ®µè¯¦è§£ï¼š
access_tokenï¼šè®¿é—®ä»¤ç‰Œï¼Œè®¿é—®èµ„æºæ—¶ç”¨
  â”œâ”€ æ ¼å¼ï¼šé€šå¸¸æ˜¯JWTæˆ–éšæœºå­—ç¬¦ä¸²
  â””â”€ ç”¨æ³•ï¼šæ”¾åœ¨HTTP Headerä¸­

token_typeï¼šä»¤ç‰Œç±»åž‹
  â””â”€ Bearerï¼šè¡¨ç¤º"æŒæœ‰è€…ä»¤ç‰Œ"ï¼Œè°æ‹¿ç€è°å°±èƒ½ç”¨

expires_inï¼šè¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰
  â”œâ”€ 3600 = 1å°æ—¶
  â””â”€ è¿‡æœŸåŽéœ€è¦ç”¨refresh_tokenåˆ·æ–°

refresh_tokenï¼šåˆ·æ–°ä»¤ç‰Œ
  â”œâ”€ ç”¨äºŽèŽ·å–æ–°çš„access_token
  â””â”€ æœ‰æ•ˆæœŸé€šå¸¸æ›´é•¿ï¼ˆå‡ å¤©åˆ°å‡ ä¸ªæœˆï¼‰

scopeï¼šå®žé™…èŽ·å¾—çš„æƒé™
  â””â”€ å¯èƒ½å°‘äºŽç”³è¯·çš„æƒé™
```

### 3.3 Tokenäº¤æ¢çš„å®‰å…¨æœºåˆ¶


**ðŸ” å¤šé‡éªŒè¯ä¿éšœ**ï¼š

```
æŽˆæƒæœåŠ¡å™¨çš„éªŒè¯æ­¥éª¤ï¼š

éªŒè¯1ï¼šæŽˆæƒç æœ‰æ•ˆæ€§
  âœ“ æŽˆæƒç æ˜¯å¦å­˜åœ¨
  âœ“ æŽˆæƒç æ˜¯å¦å·²ä½¿ç”¨ï¼ˆé˜²æ­¢é‡æ”¾æ”»å‡»ï¼‰
  âœ“ æŽˆæƒç æ˜¯å¦è¿‡æœŸï¼ˆé€šå¸¸10åˆ†é’Ÿï¼‰

éªŒè¯2ï¼šå®¢æˆ·ç«¯èº«ä»½
  âœ“ client_idæ˜¯å¦åˆæ³•
  âœ“ client_secretæ˜¯å¦æ­£ç¡®
  âœ“ å®¢æˆ·ç«¯æ˜¯å¦æœ‰æƒé™ä½¿ç”¨æ­¤æŽˆæƒç 

éªŒè¯3ï¼šé‡å®šå‘URI
  âœ“ redirect_uriå¿…é¡»ä¸Žç”³è¯·æŽˆæƒç æ—¶å®Œå…¨ä¸€è‡´
  âœ“ é˜²æ­¢æŽˆæƒç è¢«åŠ«æŒåˆ°å…¶ä»–ç½‘ç«™

éªŒè¯4ï¼šæŽˆæƒç ç»‘å®š
  âœ“ æŽˆæƒç æ˜¯å¦æ˜¯é¢å‘ç»™è¿™ä¸ªclient_idçš„
  âœ“ é˜²æ­¢æŽˆæƒç è¢«å…¶ä»–å®¢æˆ·ç«¯ç›—ç”¨

å…¨éƒ¨é€šè¿‡æ‰å‘æ”¾è®¿é—®ä»¤ç‰Œï¼
```

### 3.4 åˆ·æ–°ä»¤ç‰Œçš„ä½¿ç”¨


å½“è®¿é—®ä»¤ç‰Œè¿‡æœŸåŽï¼Œä¸éœ€è¦ç”¨æˆ·é‡æ–°æŽˆæƒï¼Œå¯ä»¥ç”¨åˆ·æ–°ä»¤ç‰ŒèŽ·å–æ–°çš„è®¿é—®ä»¤ç‰Œï¼š

```
åˆ·æ–°ä»¤ç‰Œçš„å·¥ä½œæµç¨‹ï¼š

1. è®¿é—®ä»¤ç‰Œè¿‡æœŸ
å®¢æˆ·ç«¯è¯·æ±‚èµ„æºæ—¶ï¼Œèµ„æºæœåŠ¡å™¨è¿”å›žï¼š
HTTP 401 Unauthorized
{
  "error": "invalid_token",
  "error_description": "The access token expired"
}

2. ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œ
å®¢æˆ·ç«¯å‘æŽˆæƒæœåŠ¡å™¨å‘èµ·åˆ·æ–°è¯·æ±‚ï¼š
POST /oauth/token
grant_type=refresh_token          â† ä½¿ç”¨åˆ·æ–°æ¨¡å¼
&refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
&client_id=CLIENT_ID
&client_secret=CLIENT_SECRET

3. èŽ·å¾—æ–°ä»¤ç‰Œ
æŽˆæƒæœåŠ¡å™¨è¿”å›žï¼š
{
  "access_token": "æ–°çš„è®¿é—®ä»¤ç‰Œ",
  "token_type": "Bearer",
  "expires_in": 3600,
  "refresh_token": "æ–°çš„åˆ·æ–°ä»¤ç‰Œ",  â† å¯èƒ½æ›´æ–°ï¼Œä¹Ÿå¯èƒ½ä¸å˜
  "scope": "read write"
}

4. ç”¨æ–°ä»¤ç‰Œç»§ç»­è®¿é—®èµ„æº
```

---

## 4. ðŸŽ« æŽˆæƒç çš„ä½œç”¨


### 4.1 æŽˆæƒç æ˜¯ä»€ä¹ˆ


**ç®€å•ç†è§£**ï¼šæŽˆæƒç å°±åƒæ˜¯ä¸€å¼ "æè´§å•"ï¼Œå®ƒæœ¬èº«ä¸æ˜¯ä½ è¦çš„ä¸œè¥¿ï¼Œä½†å¯ä»¥ç”¨å®ƒåŽ»æ¢å–ä½ çœŸæ­£éœ€è¦çš„ä¸œè¥¿ã€‚

```
æŽˆæƒç çš„ç‰¹å¾ï¼š

ðŸ“ å½¢å¼ï¼š
  é€šå¸¸æ˜¯ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²
  ç¤ºä¾‹ï¼šSplxlOBeZQQYbYS6WxSbIA

â° æ—¶æ•ˆæ€§ï¼š
  æœ‰æ•ˆæœŸå¾ˆçŸ­ï¼šé€šå¸¸5-10åˆ†é’Ÿ
  ä¸€æ¬¡æ€§ä½¿ç”¨ï¼šç”¨å®Œç«‹å³ä½œåºŸ

ðŸ”— ç»‘å®šå…³ç³»ï¼š
  ç»‘å®šåˆ°ç‰¹å®šçš„å®¢æˆ·ç«¯ï¼ˆclient_idï¼‰
  ç»‘å®šåˆ°ç‰¹å®šçš„é‡å®šå‘URI
  ç»‘å®šåˆ°ç‰¹å®šçš„ç”¨æˆ·ä¼šè¯
```

### 4.2 ä¸ºä»€ä¹ˆéœ€è¦æŽˆæƒç 


**æŽˆæƒç å­˜åœ¨çš„æ ¸å¿ƒåŽŸå› **ï¼š**å®‰å…¨æ€§**ï¼

```
ðŸ” è®¾è®¡æ€è€ƒï¼šä¸ºä»€ä¹ˆä¸ç›´æŽ¥ç»™è®¿é—®ä»¤ç‰Œï¼Ÿ

åœºæ™¯å¯¹æ¯”ï¼š

âŒ ç›´æŽ¥è¿”å›žè®¿é—®ä»¤ç‰Œçš„é—®é¢˜ï¼š
å¾®ä¿¡æŽˆæƒåŽç›´æŽ¥é‡å®šå‘ï¼š
http://daily.com/callback?access_token=XYZ789

é£Žé™©ï¼š
1. URLæš´éœ²é£Žé™©
   â€¢ æµè§ˆå™¨åŽ†å²è®°å½•ä¼šä¿å­˜å®Œæ•´URL
   â€¢ HTTP Refererå¤´å¯èƒ½æ³„éœ²URL
   â€¢ æµè§ˆå™¨æ’ä»¶å¯èƒ½è¯»å–URL
   â€¢ ä¸­é—´ä»£ç†æœåŠ¡å™¨ä¼šè®°å½•URL

2. æ— æ³•éªŒè¯å®¢æˆ·ç«¯
   â€¢ ä»»ä½•æ‹¿åˆ°è¿™ä¸ªURLçš„äººéƒ½èƒ½ç”¨ä»¤ç‰Œ
   â€¢ æ— æ³•ç¡®è®¤æ˜¯å¦æ˜¯åˆæ³•å®¢æˆ·ç«¯æŽ¥æ”¶

âœ… ä½¿ç”¨æŽˆæƒç çš„ä¼˜åŠ¿ï¼š
å¾®ä¿¡æŽˆæƒåŽé‡å®šå‘ï¼š
http://daily.com/callback?code=ABC123

å®‰å…¨æ€§ï¼š
1. æŽˆæƒç æ³„éœ²å½±å“æœ‰é™
   â€¢ æŽˆæƒç æœ¬èº«ä¸èƒ½è®¿é—®èµ„æº
   â€¢ å¿…é¡»é…åˆclient_secretæ‰èƒ½æ¢ä»¤ç‰Œ
   â€¢ client_secretåªåœ¨æœåŠ¡å™¨ç«¯ï¼Œæµè§ˆå™¨çœ‹ä¸åˆ°

2. åŒé‡éªŒè¯æœºåˆ¶
   â€¢ å‰ç«¯ï¼šç”¨æˆ·æŽˆæƒ â†’ å¾—åˆ°æŽˆæƒç 
   â€¢ åŽç«¯ï¼šæŽˆæƒç  + å¯†é’¥ â†’ å¾—åˆ°ä»¤ç‰Œ

3. ä¸€æ¬¡æ€§ä½¿ç”¨
   â€¢ å³ä½¿æŽˆæƒç è¢«æˆªèŽ·ï¼Œä½¿ç”¨ä¸€æ¬¡å°±å¤±æ•ˆ
   â€¢ æ”»å‡»è€…æ‹¿åˆ°ä¹Ÿæ²¡ç”¨
```

### 4.3 æŽˆæƒç çš„å·¥ä½œåŽŸç†


**ðŸ”§ æŽˆæƒç çš„ç”Ÿæˆä¸ŽéªŒè¯**ï¼š

```
ç”Ÿæˆè¿‡ç¨‹ï¼ˆæŽˆæƒæœåŠ¡å™¨ï¼‰ï¼š
1. ç”¨æˆ·åŒæ„æŽˆæƒ
2. æŽˆæƒæœåŠ¡å™¨ç”ŸæˆéšæœºæŽˆæƒç 
3. åœ¨æœåŠ¡å™¨å­˜å‚¨æŽˆæƒç åŠå…³è”ä¿¡æ¯ï¼š
   {
     code: "ABC123",
     client_id: "æ¯æ—¥ä¸€å›¾ID",
     user_id: "å¼ ä¸‰ID",
     redirect_uri: "http://daily.com/callback",
     scope: "photos",
     expires_at: "2024-01-01 10:10:00",
     used: false
   }
4. å°†æŽˆæƒç é™„åœ¨é‡å®šå‘URLè¿”å›ž

éªŒè¯è¿‡ç¨‹ï¼ˆå®¢æˆ·ç«¯æ¢ä»¤ç‰Œæ—¶ï¼‰ï¼š
1. å®¢æˆ·ç«¯æäº¤æŽˆæƒç  + client_secret
2. æŽˆæƒæœåŠ¡å™¨æ£€æŸ¥ï¼š
   âœ“ æŽˆæƒç æ˜¯å¦å­˜åœ¨
   âœ“ æ˜¯å¦å·²è¿‡æœŸ
   âœ“ æ˜¯å¦å·²ä½¿ç”¨
   âœ“ client_idæ˜¯å¦åŒ¹é…
   âœ“ redirect_uriæ˜¯å¦ä¸€è‡´
3. éªŒè¯é€šè¿‡åŽï¼š
   â€¢ æ ‡è®°æŽˆæƒç ä¸ºå·²ä½¿ç”¨
   â€¢ ç”Ÿæˆå¹¶è¿”å›žè®¿é—®ä»¤ç‰Œ
   â€¢ åˆ é™¤æˆ–å½’æ¡£æŽˆæƒç 
```

### 4.4 æŽˆæƒç çš„å®‰å…¨é˜²æŠ¤


**ðŸ›¡ï¸ é’ˆå¯¹æŽˆæƒç çš„å®‰å…¨æŽªæ–½**ï¼š

```
é˜²æŠ¤æŽªæ–½ä¸€ï¼šPKCEï¼ˆå¢žå¼ºå®‰å…¨æ€§ï¼‰
PKCE = Proof Key for Code Exchange

åŽŸç†ï¼šå³ä½¿client_secretæ³„éœ²ï¼Œä¹Ÿèƒ½ä¿è¯å®‰å…¨

æµç¨‹ï¼š
1. å®¢æˆ·ç«¯ç”Ÿæˆéšæœºcode_verifier
2. è®¡ç®—code_challenge = SHA256(code_verifier)
3. ç”³è¯·æŽˆæƒç æ—¶å¸¦ä¸Šcode_challenge
4. æ¢ä»¤ç‰Œæ—¶å¸¦ä¸ŠåŽŸå§‹çš„code_verifier
5. æœåŠ¡å™¨éªŒè¯ï¼šSHA256(code_verifier) == code_challenge

å¥½å¤„ï¼š
â€¢ ç§»åŠ¨Appæ²¡æœ‰å®‰å…¨çš„åœ°æ–¹å­˜å‚¨client_secret
â€¢ PKCEè®©æŽˆæƒç ä¸Žç‰¹å®šè®¾å¤‡ç»‘å®š
â€¢ å³ä½¿æŽˆæƒç è¢«æˆªèŽ·ä¹Ÿæ— æ³•ä½¿ç”¨

é˜²æŠ¤æŽªæ–½äºŒï¼šStateå‚æ•°ï¼ˆé˜²CSRFï¼‰
æµç¨‹ï¼š
1. ç”³è¯·æŽˆæƒå‰ç”Ÿæˆéšæœºstate
2. å­˜å‚¨åœ¨sessionä¸­
3. é‡å®šå‘å›žæ¥æ—¶éªŒè¯stateæ˜¯å¦ä¸€è‡´

é˜²æŠ¤æŽªæ–½ä¸‰ï¼šçŸ­æœŸæœ‰æ•ˆ
â€¢ æŽˆæƒç 5-10åˆ†é’Ÿè‡ªåŠ¨è¿‡æœŸ
â€¢ å‡å°è¢«æ”»å‡»çš„æ—¶é—´çª—å£

é˜²æŠ¤æŽªæ–½å››ï¼šä¸€æ¬¡æ€§ä½¿ç”¨
â€¢ ä½¿ç”¨åŽç«‹å³ä½œåºŸ
â€¢ å°è¯•é‡å¤ä½¿ç”¨ä¼šè§¦å‘å®‰å…¨è­¦æŠ¥
â€¢ å¯èƒ½æ’¤é”€å·²å‘æ”¾çš„ä»¤ç‰Œ
```

---

## 5. ðŸŽŸï¸ è®¿é—®ä»¤ç‰Œè¯¦è§£


### 5.1 è®¿é—®ä»¤ç‰Œæ˜¯ä»€ä¹ˆ


**è®¿é—®ä»¤ç‰Œï¼ˆAccess Tokenï¼‰**ï¼šå°±åƒæ˜¯ä¸€å¼ **æœ‰æœŸé™çš„é€šè¡Œè¯**ï¼ŒæŒæœ‰å®ƒå°±èƒ½è®¿é—®ç‰¹å®šçš„èµ„æºã€‚

```
è®¿é—®ä»¤ç‰Œçš„æœ¬è´¨ï¼š

ðŸŽ« é€šè¡Œè¯ç±»æ¯”ï¼š
  â€¢ æ¼”å”±ä¼šé—¨ç¥¨ï¼šåªèƒ½çœ‹è¿™åœºæ¼”å‡ºï¼Œè¿‡æœŸä½œåºŸ
  â€¢ è®¿é—®ä»¤ç‰Œï¼šåªèƒ½è®¿é—®ç‰¹å®šèµ„æºï¼Œæœ‰æ—¶é—´é™åˆ¶

ðŸ”‘ å…³é”®ç‰¹æ€§ï¼š
  1. ä»£è¡¨æŽˆæƒï¼šè¯æ˜Žç”¨æˆ·å·²æŽˆæƒå®¢æˆ·ç«¯è®¿é—®
  2. æºå¸¦æƒé™ï¼šåŒ…å«å¯ä»¥åšä»€ä¹ˆçš„ä¿¡æ¯
  3. æœ‰æ—¶æ•ˆæ€§ï¼šè‡ªåŠ¨è¿‡æœŸï¼Œéœ€è¦åˆ·æ–°
  4. å¯æ’¤é”€æ€§ï¼šç”¨æˆ·æˆ–æœåŠ¡å™¨å¯ä»¥éšæ—¶æ’¤é”€
```

### 5.2 è®¿é—®ä»¤ç‰Œçš„ç±»åž‹


**ðŸ“‹ ä¸¤ç§ä¸»è¦ä»¤ç‰Œæ ¼å¼**ï¼š

```
ç±»åž‹1ï¼šä¸é€æ˜Žä»¤ç‰Œï¼ˆOpaque Tokenï¼‰
å¤–è§‚ï¼šéšæœºå­—ç¬¦ä¸²
ç¤ºä¾‹ï¼š2YotnFZFEjr1zCsicMWpAA

ç‰¹ç‚¹ï¼š
âœ“ ä»¤ç‰Œæœ¬èº«ä¸åŒ…å«ä¿¡æ¯
âœ“ èµ„æºæœåŠ¡å™¨éœ€è¦è°ƒç”¨æŽˆæƒæœåŠ¡å™¨éªŒè¯
âœ“ å¯ä»¥éšæ—¶æ’¤é”€
âœ“ æœåŠ¡å™¨ç«¯å­˜å‚¨ä»¤ç‰Œä¿¡æ¯

éªŒè¯æµç¨‹ï¼š
èµ„æºæœåŠ¡å™¨æ”¶åˆ°ä»¤ç‰Œ
  â†“
è°ƒç”¨æŽˆæƒæœåŠ¡å™¨éªŒè¯æŽ¥å£
  â†“
æŽˆæƒæœåŠ¡å™¨è¿”å›žä»¤ç‰Œä¿¡æ¯ï¼ˆç”¨æˆ·ã€æƒé™ã€è¿‡æœŸæ—¶é—´ï¼‰
  â†“
èµ„æºæœåŠ¡å™¨å†³å®šæ˜¯å¦å…è®¸è®¿é—®

ç±»åž‹2ï¼šJWTä»¤ç‰Œï¼ˆè‡ªåŒ…å«ä»¤ç‰Œï¼‰
å¤–è§‚ï¼šä¸‰æ®µå¼å­—ç¬¦ä¸²ï¼ˆHeader.Payload.Signatureï¼‰
ç¤ºä¾‹ï¼šeyJhbGci...ï¼ˆå¾ˆé•¿çš„å­—ç¬¦ä¸²ï¼‰

ç‰¹ç‚¹ï¼š
âœ“ ä»¤ç‰Œè‡ªèº«åŒ…å«ç”¨æˆ·ä¿¡æ¯å’Œæƒé™
âœ“ èµ„æºæœåŠ¡å™¨å¯ä»¥æœ¬åœ°éªŒè¯
âœ“ æ— éœ€è°ƒç”¨æŽˆæƒæœåŠ¡å™¨
âœ“ æ€§èƒ½æ›´å¥½

JWTç»“æž„ï¼š
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9    â† Headerï¼ˆç®—æ³•ä¿¡æ¯ï¼‰
.eyJzdWIiOiJ1c2VyMTIzIiwic2NvcGUiOiJyZWFkIn0    â† Payloadï¼ˆç”¨æˆ·ä¿¡æ¯ï¼‰
.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c    â† Signatureï¼ˆç­¾åï¼‰

è§£ç åŽçš„å†…å®¹ï¼š
{
  "sub": "user123",      // ç”¨æˆ·ID
  "scope": "read write", // æƒé™èŒƒå›´
  "exp": 1640995200,     // è¿‡æœŸæ—¶é—´
  "iat": 1640991600      // ç­¾å‘æ—¶é—´
}
```

### 5.3 è®¿é—®ä»¤ç‰Œçš„ä½¿ç”¨æ–¹å¼


**ðŸ”§ å¦‚ä½•åœ¨è¯·æ±‚ä¸­æºå¸¦ä»¤ç‰Œ**ï¼š

```
æ–¹å¼1ï¼šHTTP Headerï¼ˆæŽ¨èï¼‰
GET /api/photos HTTP/1.1
Host: api.example.com
Authorization: Bearer eyJhbGci...

ä¼˜ç‚¹ï¼š
âœ“ ç¬¦åˆHTTPæ ‡å‡†
âœ“ ä¸ä¼šè¢«è®°å½•åœ¨URLä¸­
âœ“ å®‰å…¨æ€§æœ€å¥½

æ–¹å¼2ï¼šPOSTè¯·æ±‚ä½“ï¼ˆä¸æŽ¨èï¼‰
POST /api/photos HTTP/1.1
Host: api.example.com
Content-Type: application/x-www-form-urlencoded

access_token=eyJhbGci...

é—®é¢˜ï¼š
âœ— åªé€‚ç”¨äºŽPOSTè¯·æ±‚
âœ— å®¹æ˜“è¢«æ—¥å¿—è®°å½•

æ–¹å¼3ï¼šURLå‚æ•°ï¼ˆä¸æŽ¨èï¼Œä»…ç‰¹æ®Šæƒ…å†µï¼‰
GET /api/photos?access_token=eyJhbGci... HTTP/1.1

é—®é¢˜ï¼š
âœ— ä¼šè¢«è®°å½•åœ¨æœåŠ¡å™¨æ—¥å¿—
âœ— ä¼šä¿å­˜åœ¨æµè§ˆå™¨åŽ†å²
âœ— å¯èƒ½é€šè¿‡Refereræ³„éœ²
```

### 5.4 è®¿é—®ä»¤ç‰Œçš„éªŒè¯æµç¨‹


**ðŸ” èµ„æºæœåŠ¡å™¨å¦‚ä½•éªŒè¯ä»¤ç‰Œ**ï¼š

```
éªŒè¯æ­¥éª¤ï¼ˆä¸é€æ˜Žä»¤ç‰Œï¼‰ï¼š

1. æå–ä»¤ç‰Œ
ä»ŽHTTP Headerä¸­èŽ·å–ï¼š
Authorization: Bearer TOKEN
è§£æžå‡ºTOKENéƒ¨åˆ†

2. è°ƒç”¨æŽˆæƒæœåŠ¡å™¨éªŒè¯
POST /oauth/introspect
token=TOKEN
client_id=RESOURCE_SERVER_ID
client_secret=SECRET

3. æŽˆæƒæœåŠ¡å™¨è¿”å›žä»¤ç‰Œä¿¡æ¯
{
  "active": true,           // ä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆ
  "scope": "read write",    // æƒé™èŒƒå›´
  "client_id": "app123",    // å“ªä¸ªåº”ç”¨ç”³è¯·çš„
  "username": "user123",    // ç”¨æˆ·æ ‡è¯†
  "exp": 1640995200         // è¿‡æœŸæ—¶é—´
}

4. èµ„æºæœåŠ¡å™¨å†³ç­–
if (active && scopeåŒ…å«æ‰€éœ€æƒé™ && æœªè¿‡æœŸ) {
  // å…è®¸è®¿é—®èµ„æº
} else {
  // è¿”å›ž401 Unauthorized
}

éªŒè¯æ­¥éª¤ï¼ˆJWTä»¤ç‰Œï¼‰ï¼š

1. æå–JWTä»¤ç‰Œ

2. éªŒè¯ç­¾å
ç”¨å…¬é’¥éªŒè¯ç­¾åæ˜¯å¦æ­£ç¡®
ç¡®ä¿ä»¤ç‰Œæœªè¢«ç¯¡æ”¹

3. æ£€æŸ¥å£°æ˜Žï¼ˆClaimsï¼‰
â€¢ expï¼šæ£€æŸ¥æ˜¯å¦è¿‡æœŸ
â€¢ scopeï¼šæ£€æŸ¥æƒé™æ˜¯å¦è¶³å¤Ÿ
â€¢ audï¼šæ£€æŸ¥ä»¤ç‰Œçš„å—ä¼—æ˜¯å¦æ­£ç¡®

4. ç›´æŽ¥å†³ç­–ï¼ˆæ— éœ€è°ƒç”¨æŽˆæƒæœåŠ¡å™¨ï¼‰
```

---

## 6. ðŸ”€ é‡å®šå‘URIæœºåˆ¶


### 6.1 é‡å®šå‘URIçš„æ¦‚å¿µ


**é‡å®šå‘URIï¼ˆRedirect URIï¼‰**ï¼šå°±åƒæ˜¯**å›žä¿¡åœ°å€**ï¼Œå‘Šè¯‰æŽˆæƒæœåŠ¡å™¨æŽˆæƒå®ŒæˆåŽæŠŠç”¨æˆ·é€åˆ°å“ªé‡Œã€‚

```
ç”Ÿæ´»ç±»æ¯”ï¼š
ä½ åŽ»é“¶è¡ŒåŠžä¸šåŠ¡ï¼Œéœ€è¦å›žæ‰§
é“¶è¡Œé—®ï¼šåŠžå®Œä¸šåŠ¡æŠŠå›žæ‰§å¯„åˆ°å“ªï¼Ÿ
ä½ è¯´ï¼šå¯„åˆ°æˆ‘å®¶åœ°å€xxx

OAuth2.0ä¸­ï¼š
å®¢æˆ·ç«¯åŽ»æŽˆæƒæœåŠ¡å™¨ç”³è¯·æŽˆæƒ
æŽˆæƒæœåŠ¡å™¨é—®ï¼šæŽˆæƒå®ŒæˆåŽè·³è½¬åˆ°å“ªï¼Ÿ
å®¢æˆ·ç«¯è¯´ï¼šè·³è½¬åˆ° http://myapp.com/callback
```

### 6.2 é‡å®šå‘URIçš„å·¥ä½œæµç¨‹


**ðŸ”„ å®Œæ•´çš„é‡å®šå‘è¿‡ç¨‹**ï¼š

```
é˜¶æ®µ1ï¼šå‘èµ·æŽˆæƒè¯·æ±‚ï¼ˆå®¢æˆ·ç«¯ â†’ æŽˆæƒæœåŠ¡å™¨ï¼‰
ç”¨æˆ·ç‚¹å‡»"å¾®ä¿¡ç™»å½•"æŒ‰é’®

å®¢æˆ·ç«¯æž„é€ æŽˆæƒURLï¼š
https://wx.qq.com/oauth/authorize?
  response_type=code
  &client_id=APP_ID
  &redirect_uri=http%3A%2F%2Fmyapp.com%2Fcallback  â† URLç¼–ç åŽçš„é‡å®šå‘åœ°å€
  &scope=read_photos
  &state=random123

æµè§ˆå™¨è·³è½¬åˆ°è¿™ä¸ªURL

é˜¶æ®µ2ï¼šç”¨æˆ·æŽˆæƒï¼ˆæŽˆæƒæœåŠ¡å™¨ï¼‰
ç”¨æˆ·ç™»å½•å¹¶åŒæ„æŽˆæƒ

é˜¶æ®µ3ï¼šé‡å®šå‘è¿”å›žï¼ˆæŽˆæƒæœåŠ¡å™¨ â†’ å®¢æˆ·ç«¯ï¼‰
æŽˆæƒæœåŠ¡å™¨æž„é€ é‡å®šå‘å“åº”ï¼š
HTTP/1.1 302 Found
Location: http://myapp.com/callback?code=AUTH_CODE&state=random123

æµè§ˆå™¨è‡ªåŠ¨è·³è½¬åˆ°è¿™ä¸ªåœ°å€

é˜¶æ®µ4ï¼šå®¢æˆ·ç«¯å¤„ç†å›žè°ƒ
å®¢æˆ·ç«¯çš„ /callback æŽ¥å£æŽ¥æ”¶è¯·æ±‚
æå–codeå’Œstateå‚æ•°
ç”¨codeæ¢å–è®¿é—®ä»¤ç‰Œ
```

### 6.3 é‡å®šå‘URIçš„å®‰å…¨æœºåˆ¶


**ðŸ” ä¸ºä»€ä¹ˆé‡å®šå‘URIå¦‚æ­¤é‡è¦ï¼Ÿ**

```
å®‰å…¨å¨èƒï¼šé‡å®šå‘URIåŠ«æŒæ”»å‡»

æ”»å‡»åœºæ™¯ï¼š
1. é»‘å®¢æ³¨å†Œä¸€ä¸ªæ¶æ„åº”ç”¨ï¼Œredirect_uriè®¾ä¸º http://evil.com
2. é»‘å®¢è¯±å¯¼ç”¨æˆ·è®¿é—®æ­£å¸¸åº”ç”¨çš„æŽˆæƒé“¾æŽ¥ï¼Œä½†å·å·æ”¹äº†redirect_uri
3. ç”¨æˆ·åŒæ„æŽˆæƒåŽï¼ŒæŽˆæƒç è¢«å‘åˆ° http://evil.com
4. é»‘å®¢æ‹¿åˆ°æŽˆæƒç ï¼Œå†’å……æ­£å¸¸åº”ç”¨æ¢å–ä»¤ç‰Œ

é˜²æŠ¤æŽªæ–½ï¼š

æŽªæ–½1ï¼šç™½åå•éªŒè¯
æŽˆæƒæœåŠ¡å™¨å­˜å‚¨é¢„æ³¨å†Œçš„redirect_uriï¼š
{
  "client_id": "APP123",
  "redirect_uris": [
    "http://myapp.com/callback",
    "http://myapp.com/oauth/callback"
  ]
}

æŽˆæƒæ—¶ä¸¥æ ¼æ£€æŸ¥ï¼š
if (è¯·æ±‚çš„redirect_uri ä¸åœ¨ç™½åå•) {
  æ‹’ç»æŽˆæƒè¯·æ±‚
}

æŽªæ–½2ï¼šç²¾ç¡®åŒ¹é…
ä¸å…è®¸ï¼š
ç”³è¯·æ—¶ï¼šhttp://myapp.com/callback
ä½¿ç”¨æ—¶ï¼šhttp://myapp.com/callback?extra=param
(é™¤éžæ˜Žç¡®é…ç½®å…è®¸å‚æ•°)

å¿…é¡»å®Œå…¨ä¸€è‡´ï¼š
ç”³è¯·æ—¶ï¼šhttp://myapp.com/callback
ä½¿ç”¨æ—¶ï¼šhttp://myapp.com/callback
âœ“ é€šè¿‡éªŒè¯

æŽªæ–½3ï¼šHTTPSå¼ºåˆ¶
ç”Ÿäº§çŽ¯å¢ƒå¿…é¡»ä½¿ç”¨HTTPSï¼š
âœ“ https://myapp.com/callback
âœ— http://myapp.com/callbackï¼ˆä¸å®‰å…¨ï¼‰

æœ¬åœ°å¼€å‘ä¾‹å¤–ï¼š
âœ“ http://localhost:3000/callbackï¼ˆå…è®¸ï¼‰
âœ“ http://127.0.0.1:3000/callbackï¼ˆå…è®¸ï¼‰
```

### 6.4 é‡å®šå‘URIçš„æœ€ä½³å®žè·µ


**ðŸ’¡ å®žé™…å¼€å‘å»ºè®®**ï¼š

```
å»ºè®®1ï¼šä½¿ç”¨ä¸“é—¨çš„å›žè°ƒè·¯å¾„
å¥½çš„åšæ³•ï¼š
âœ“ http://myapp.com/oauth/callback
âœ“ http://myapp.com/auth/wechat/callback

ä¸å¥½çš„åšæ³•ï¼š
âœ— http://myapp.com/ï¼ˆé¦–é¡µå½“å›žè°ƒï¼‰
âœ— http://myapp.com/api/userï¼ˆä¸šåŠ¡æŽ¥å£å½“å›žè°ƒï¼‰

åŽŸå› ï¼š
â€¢ èŒè´£æ¸…æ™°ï¼Œæ˜“äºŽç®¡ç†
â€¢ å®‰å…¨ç­–ç•¥ç‹¬ç«‹é…ç½®
â€¢ æ—¥å¿—å’Œç›‘æŽ§æ›´æ–¹ä¾¿

å»ºè®®2ï¼šå‚æ•°ä¼ é€’ç­–ç•¥
éœ€è¦ä¼ é€’é¢å¤–ä¿¡æ¯æ—¶ä½¿ç”¨stateï¼š
stateå‚æ•°çš„å†…å®¹ï¼š
â€¢ å¯ä»¥åŒ…å«ç”¨æˆ·ä¼šè¯æ ‡è¯†
â€¢ å¯ä»¥åŒ…å«è·³è½¬å‰çš„é¡µé¢åœ°å€
â€¢ å¿…é¡»åŠ å¯†æˆ–ç­¾åé˜²æ­¢ç¯¡æ”¹

ç¤ºä¾‹ï¼š
const state = encrypt({
  session_id: 'user_session_123',
  return_url: '/user/profile'
})

æŽˆæƒURLï¼š
?state=encrypted_state_string

å›žè°ƒå¤„ç†ï¼š
const data = decrypt(state)
// æ¢å¤ç”¨æˆ·ä¼šè¯ï¼Œè·³è½¬åˆ°åŽŸé¡µé¢

å»ºè®®3ï¼šç§»åŠ¨åº”ç”¨å¤„ç†
ç§»åŠ¨Appçš„é‡å®šå‘URIç‰¹æ®Šå¤„ç†ï¼š
â€¢ iOSï¼šä½¿ç”¨Universal Links
  myapp://oauth/callback
  
â€¢ Androidï¼šä½¿ç”¨App Links
  https://myapp.com/oauth/callback
  (é…ç½®intent-filter)

â€¢ æ·±åº¦é“¾æŽ¥ï¼š
  myapp://oauth/callback
```

---

## 7. â° Tokenç”Ÿå‘½å‘¨æœŸç®¡ç†


### 7.1 Tokençš„ç”Ÿå‘½é˜¶æ®µ


**Tokençš„ä¸€ç”Ÿ**ï¼šä»Žå‡ºç”Ÿåˆ°æ¶ˆäº¡çš„å®Œæ•´è¿‡ç¨‹

```
ðŸ“… Tokenç”Ÿå‘½å‘¨æœŸï¼š

é˜¶æ®µ1: å‡ºç”Ÿï¼ˆåˆ›å»ºï¼‰
æ—¶é—´ï¼šç”¨æˆ·æŽˆæƒå®Œæˆï¼Œå®¢æˆ·ç«¯æ¢å–ä»¤ç‰Œæ—¶
å†…å®¹ï¼š
{
  "access_token": "xyz...",
  "expires_in": 3600,        // 1å°æ—¶åŽè¿‡æœŸ
  "refresh_token": "abc...",
  "token_type": "Bearer"
}

é˜¶æ®µ2: é’å¹´ï¼ˆæ´»è·ƒä½¿ç”¨ï¼‰
æ—¶é—´ï¼šä»¤ç‰Œæœ‰æ•ˆæœŸå†…
è¡Œä¸ºï¼š
â€¢ å®¢æˆ·ç«¯ç”¨access_tokenè®¿é—®èµ„æº
â€¢ èµ„æºæœåŠ¡å™¨éªŒè¯å¹¶æä¾›æ•°æ®
â€¢ ç”¨æˆ·æ­£å¸¸ä½¿ç”¨åº”ç”¨åŠŸèƒ½

é˜¶æ®µ3: è¡°è€ï¼ˆå³å°†è¿‡æœŸï¼‰
æ—¶é—´ï¼šæŽ¥è¿‘expires_inæ—¶é—´
ç­–ç•¥ï¼š
â€¢ æå‰åˆ·æ–°ä»¤ç‰Œï¼ˆå¦‚å‰©ä½™10%æ—¶é—´ï¼‰
â€¢ é¿å…åœ¨ç”¨æˆ·æ“ä½œæ—¶çªç„¶å¤±æ•ˆ

é˜¶æ®µ4: æ­»äº¡ï¼ˆè¿‡æœŸ/æ’¤é”€ï¼‰
è¿‡æœŸåŽŸå› ï¼š
â€¢ æ—¶é—´åˆ°æœŸï¼ˆè‡ªç„¶æ­»äº¡ï¼‰
â€¢ ç”¨æˆ·ä¸»åŠ¨æ’¤é”€ï¼ˆå®‰å…¨éœ€æ±‚ï¼‰
â€¢ æ£€æµ‹åˆ°å¼‚å¸¸è¡Œä¸ºï¼ˆå¼ºåˆ¶æ’¤é”€ï¼‰
â€¢ åˆ·æ–°ä»¤ç‰Œæ—¶æ—§ä»¤ç‰Œå¤±æ•ˆï¼ˆæ›´æ–°æ¢ä»£ï¼‰
```

### 7.2 è®¿é—®ä»¤ç‰Œçš„è¿‡æœŸå¤„ç†


**â° ä»¤ç‰Œè¿‡æœŸçš„æ£€æµ‹ä¸Žå¤„ç†**ï¼š

```
åœºæ™¯ï¼šç”¨æˆ·æ­£åœ¨ä½¿ç”¨åº”ç”¨ï¼Œçªç„¶ä»¤ç‰Œè¿‡æœŸäº†

æ£€æµ‹æ–¹å¼1ï¼šè¢«åŠ¨æ£€æµ‹
å®¢æˆ·ç«¯è¯·æ±‚èµ„æºï¼š
GET /api/photos
Authorization: Bearer expired_token

èµ„æºæœåŠ¡å™¨å“åº”ï¼š
HTTP/1.1 401 Unauthorized
{
  "error": "invalid_token",
  "error_description": "The access token expired"
}

å®¢æˆ·ç«¯å¤„ç†ï¼š
1. æ•èŽ·401é”™è¯¯
2. åˆ¤æ–­æ˜¯å¦å› ä¸ºä»¤ç‰Œè¿‡æœŸ
3. å°è¯•åˆ·æ–°ä»¤ç‰Œ
4. é‡è¯•åŽŸè¯·æ±‚

æ£€æµ‹æ–¹å¼2ï¼šä¸»åŠ¨æ£€æµ‹ï¼ˆæ›´å¥½ï¼‰
å®¢æˆ·ç«¯è®°å½•ä»¤ç‰ŒèŽ·å–æ—¶é—´ï¼š
token_obtained_at = å½“å‰æ—¶é—´
token_expires_in = 3600ç§’

åœ¨å‘èµ·è¯·æ±‚å‰æ£€æŸ¥ï¼š
if (å½“å‰æ—¶é—´ > token_obtained_at + token_expires_in) {
  // ä»¤ç‰Œå·²è¿‡æœŸï¼Œå…ˆåˆ·æ–°
  refresh_access_token()
} else if (å‰©ä½™æ—¶é—´ < 600ç§’) {
  // å¿«è¿‡æœŸäº†ï¼ŒåŽå°åˆ·æ–°
  background_refresh_token()
}
// ç„¶åŽå†å‘èµ·å®žé™…è¯·æ±‚

ä¼˜åŠ¿ï¼š
âœ“ é¿å…ç”¨æˆ·æ„ŸçŸ¥åˆ°é”™è¯¯
âœ“ ç”¨æˆ·ä½“éªŒæ›´æµç•…
âœ“ å‡å°‘å¤±è´¥é‡è¯•
```

### 7.3 åˆ·æ–°ä»¤ç‰Œçš„ç®¡ç†


**ðŸ”„ åˆ·æ–°ä»¤ç‰Œçš„ä½¿ç”¨ç­–ç•¥**ï¼š

```
ç­–ç•¥1ï¼šé™é»˜åˆ·æ–°ï¼ˆç”¨æˆ·æ— æ„ŸçŸ¥ï¼‰
åœºæ™¯ï¼šç”¨æˆ·æ­£åœ¨ä½¿ç”¨åº”ç”¨

å®žçŽ°ï¼š
// å®šæ—¶æ£€æŸ¥ä»¤ç‰ŒçŠ¶æ€
setInterval(() => {
  const remaining = token_expires_at - Date.now()
  
  if (remaining < 5 * 60 * 1000) {  // å°‘äºŽ5åˆ†é’Ÿ
    refreshTokenInBackground()
  }
}, 60000)  // æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡

async function refreshTokenInBackground() {
  try {
    const response = await fetch('/oauth/token', {
      method: 'POST',
      body: new URLSearchParams({
        grant_type: 'refresh_token',
        refresh_token: stored_refresh_token,
        client_id: CLIENT_ID,
        client_secret: CLIENT_SECRET
      })
    })
    
    const tokens = await response.json()
    // æ›´æ–°å­˜å‚¨çš„ä»¤ç‰Œ
    updateTokens(tokens)
  } catch (error) {
    // åˆ·æ–°å¤±è´¥ï¼Œå¯èƒ½éœ€è¦é‡æ–°ç™»å½•
    handleRefreshFailure()
  }
}

ç­–ç•¥2ï¼šåˆ·æ–°ä»¤ç‰Œçš„å®‰å…¨å­˜å‚¨
Webåº”ç”¨ï¼š
âœ“ å­˜å‚¨åœ¨HttpOnly Cookieä¸­ï¼ˆé˜²XSSï¼‰
âœ“ ä½¿ç”¨SameSiteå±žæ€§ï¼ˆé˜²CSRFï¼‰
âœ— ä¸è¦å­˜åœ¨localStorageï¼ˆæ˜“å—XSSæ”»å‡»ï¼‰

ç§»åŠ¨åº”ç”¨ï¼š
âœ“ ä½¿ç”¨ç³»ç»ŸKeychain/Keystore
âœ“ åŠ å¯†å­˜å‚¨

ç­–ç•¥3ï¼šåˆ·æ–°ä»¤ç‰Œçš„è½®æ¢
æ¯æ¬¡åˆ·æ–°éƒ½æ›´æ–°refresh_tokenï¼š

è¯·æ±‚ï¼š
POST /oauth/token
grant_type=refresh_token
refresh_token=OLD_REFRESH_TOKEN

å“åº”ï¼š
{
  "access_token": "æ–°çš„è®¿é—®ä»¤ç‰Œ",
  "refresh_token": "æ–°çš„åˆ·æ–°ä»¤ç‰Œ",  â† æ³¨æ„è¿™é‡Œ
  "expires_in": 3600
}

æ—§çš„refresh_tokenç«‹å³å¤±æ•ˆ

å¥½å¤„ï¼š
â€¢ å¦‚æžœåˆ·æ–°ä»¤ç‰Œæ³„éœ²ï¼Œæ”»å‡»è€…åªèƒ½ç”¨ä¸€æ¬¡
â€¢ æ­£å¸¸å®¢æˆ·ç«¯ç”¨äº†æ–°ä»¤ç‰Œï¼Œæ”»å‡»è€…çš„æ—§ä»¤ç‰Œå¤±æ•ˆ
â€¢ æ£€æµ‹åˆ°é‡æ”¾æ”»å‡»æ—¶å¯ä»¥æ’¤é”€æ‰€æœ‰ä»¤ç‰Œ
```

### 7.4 ä»¤ç‰Œæ’¤é”€æœºåˆ¶


**ðŸš« å¦‚ä½•åºŸé™¤ä»¤ç‰Œ**ï¼š

```
æ’¤é”€åœºæ™¯ï¼š
1. ç”¨æˆ·ä¸»åŠ¨é€€å‡ºç™»å½•
2. ç”¨æˆ·åœ¨è®¾ç½®ä¸­æ’¤é”€åº”ç”¨æŽˆæƒ
3. æ£€æµ‹åˆ°è´¦å·å¼‚å¸¸
4. ä¿®æ”¹å¯†ç åŽæ’¤é”€æ‰€æœ‰ä»¤ç‰Œ

æ’¤é”€æ–¹å¼1ï¼šå®¢æˆ·ç«¯å‘èµ·æ’¤é”€
POST /oauth/revoke
token=è¦æ’¤é”€çš„ä»¤ç‰Œ
token_type_hint=access_token  // æˆ– refresh_token
client_id=CLIENT_ID
client_secret=CLIENT_SECRET

æœåŠ¡å™¨å¤„ç†ï¼š
â€¢ å°†ä»¤ç‰ŒåŠ å…¥é»‘åå•
â€¢ å¦‚æžœæ˜¯refresh_tokenï¼ŒåŒæ—¶æ’¤é”€å…³è”çš„access_token
â€¢ è¿”å›žæˆåŠŸå“åº”

æ’¤é”€æ–¹å¼2ï¼šç”¨æˆ·åœ¨æŽˆæƒæœåŠ¡å™¨æ’¤é”€
ç”¨æˆ·åœ¨å¾®ä¿¡è®¾ç½®ä¸­ï¼š
"å·²æŽˆæƒçš„åº”ç”¨" â†’ "æ¯æ—¥ä¸€å›¾" â†’ "å–æ¶ˆæŽˆæƒ"

æ•ˆæžœï¼š
â€¢ æ’¤é”€è¯¥åº”ç”¨çš„æ‰€æœ‰ä»¤ç‰Œ
â€¢ åˆ é™¤æŽˆæƒè®°å½•
â€¢ ä¸‹æ¬¡ä½¿ç”¨éœ€è¦é‡æ–°æŽˆæƒ

æ’¤é”€åŽçš„å¤„ç†ï¼š
å®¢æˆ·ç«¯æ£€æµ‹åˆ°ä»¤ç‰Œè¢«æ’¤é”€ï¼š
1. æ¸…é™¤æœ¬åœ°å­˜å‚¨çš„ä»¤ç‰Œ
2. æ¸…é™¤ç”¨æˆ·ä¼šè¯
3. å¼•å¯¼ç”¨æˆ·é‡æ–°ç™»å½•/æŽˆæƒ
```

---

## 8. ðŸ›¡ï¸ å®‰å…¨è€ƒè™‘è¦ç‚¹


### 8.1 å¸¸è§å®‰å…¨å¨èƒ


**âš ï¸ OAuth2.0é¢ä¸´çš„ä¸»è¦å¨èƒ**ï¼š

```
å¨èƒ1ï¼šæŽˆæƒç æ‹¦æˆªæ”»å‡»
æ”»å‡»è¿‡ç¨‹ï¼š
1. é»‘å®¢è¯±å¯¼ç”¨æˆ·æŽˆæƒ
2. æ‹¦æˆªé‡å®šå‘URLä¸­çš„æŽˆæƒç 
3. ç”¨æŽˆæƒç æ¢å–ä»¤ç‰Œ

é˜²å¾¡æŽªæ–½ï¼š
âœ“ ä½¿ç”¨PKCEï¼ˆç§»åŠ¨åº”ç”¨å¿…é¡»ï¼‰
âœ“ éªŒè¯redirect_uri
âœ“ æŽˆæƒç çŸ­æœŸæœ‰æ•ˆä¸”ä¸€æ¬¡æ€§
âœ“ åŽç«¯äº¤æ¢ä»¤ç‰Œæ—¶éªŒè¯client_secret

å¨èƒ2ï¼šä»¤ç‰Œæ³„éœ²
æ³„éœ²é€”å¾„ï¼š
â€¢ å­˜å‚¨åœ¨ä¸å®‰å…¨çš„åœ°æ–¹ï¼ˆlocalStorageï¼‰
â€¢ åœ¨URLä¸­ä¼ é€’ä»¤ç‰Œ
â€¢ æ—¥å¿—è®°å½•äº†ä»¤ç‰Œ
â€¢ XSSæ”»å‡»çªƒå–ä»¤ç‰Œ

é˜²å¾¡æŽªæ–½ï¼š
âœ“ HTTPSä¼ è¾“
âœ“ HttpOnly Cookieå­˜å‚¨
âœ“ ä»¤ç‰ŒåŠ å¯†å­˜å‚¨
âœ“ çŸ­æœŸæœ‰æ•ˆæœŸ
âœ“ åŠæ—¶åˆ·æ–°ä»¤ç‰Œ

å¨èƒ3ï¼šCSRFæ”»å‡»
æ”»å‡»åœºæ™¯ï¼š
é»‘å®¢è¯±å¯¼ç”¨æˆ·ç‚¹å‡»ï¼š
http://victim.com/oauth/callback?code=HACKER_CODE

ç”¨æˆ·çš„æµè§ˆå™¨ä¼šç”¨é»‘å®¢çš„æŽˆæƒç å®ŒæˆæŽˆæƒ
ç»“æžœï¼šç”¨æˆ·çš„è´¦å·ç»‘å®šäº†é»‘å®¢çš„ç¬¬ä¸‰æ–¹è´¦å·

é˜²å¾¡æŽªæ–½ï¼š
âœ“ ä½¿ç”¨stateå‚æ•°
âœ“ éªŒè¯stateçš„å®Œæ•´æ€§
âœ“ å°†stateç»‘å®šåˆ°ç”¨æˆ·ä¼šè¯

å¨èƒ4ï¼šé‡å®šå‘URIç¯¡æ”¹
æ”»å‡»ï¼š
æ­£å¸¸ï¼šredirect_uri=http://myapp.com/callback
ç¯¡æ”¹ï¼šredirect_uri=http://evil.com

é˜²å¾¡ï¼š
âœ“ é¢„æ³¨å†Œredirect_uriç™½åå•
âœ“ ä¸¥æ ¼åŒ¹é…ï¼Œä¸å…è®¸é€šé…ç¬¦
âœ“ HTTPSå¼ºåˆ¶è¦æ±‚
```

### 8.2 PKCEå¢žå¼ºå®‰å…¨


**ðŸ” PKCEè¯¦ç»†åŽŸç†**ï¼ˆç§»åŠ¨åº”ç”¨å’Œå•é¡µåº”ç”¨å¿…å¤‡ï¼‰ï¼š

```
PKCEå…¨ç§°ï¼šProof Key for Code Exchange
ä¸­æ–‡ï¼šæŽˆæƒç äº¤æ¢çš„è¯æ˜Žå¯†é’¥

ä¸ºä»€ä¹ˆéœ€è¦PKCEï¼Ÿ
é—®é¢˜ï¼šç§»åŠ¨Appæ— æ³•å®‰å…¨å­˜å‚¨client_secret
â€¢ Appè¢«åç¼–è¯‘ï¼Œsecretæš´éœ²
â€¢ æ”»å‡»è€…å¯ä»¥ç”¨secretæ¢å–ä»¤ç‰Œ

PKCEè§£å†³æ–¹æ¡ˆï¼šä¸ä¾èµ–client_secret

å®Œæ•´æµç¨‹ï¼š

æ­¥éª¤1ï¼šå®¢æˆ·ç«¯ç”Ÿæˆéšæœºç 
code_verifier = éšæœºç”Ÿæˆçš„å­—ç¬¦ä¸²ï¼ˆ43-128ä¸ªå­—ç¬¦ï¼‰
ç¤ºä¾‹ï¼šdBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk

æ­¥éª¤2ï¼šè®¡ç®—æŒ‘æˆ˜ç 
code_challenge = BASE64URL(SHA256(code_verifier))
ç¤ºä¾‹ï¼šE9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM

æ­¥éª¤3ï¼šç”³è¯·æŽˆæƒç æ—¶å¸¦ä¸ŠæŒ‘æˆ˜ç 
GET /oauth/authorize?
  response_type=code
  &client_id=CLIENT_ID
  &redirect_uri=REDIRECT_URI
  &code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
  &code_challenge_method=S256    â† ä½¿ç”¨SHA256ç®—æ³•

æ­¥éª¤4ï¼šèŽ·å¾—æŽˆæƒç 
ï¼ˆæ­£å¸¸æµç¨‹ï¼‰

æ­¥éª¤5ï¼šæ¢å–ä»¤ç‰Œæ—¶å¸¦ä¸ŠåŽŸå§‹éšæœºç 
POST /oauth/token
grant_type=authorization_code
&code=AUTHORIZATION_CODE
&redirect_uri=REDIRECT_URI
&client_id=CLIENT_ID
&code_verifier=dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk

æ­¥éª¤6ï¼šæœåŠ¡å™¨éªŒè¯
è®¡ç®—ï¼šBASE64URL(SHA256(æ”¶åˆ°çš„code_verifier))
å¯¹æ¯”ï¼šæ˜¯å¦ç­‰äºŽä¹‹å‰çš„code_challenge
åŒ¹é…æ‰å‘æ”¾ä»¤ç‰Œ

å®‰å…¨æ€§åˆ†æžï¼š
âœ“ æ”»å‡»è€…å³ä½¿æ‹¦æˆªäº†æŽˆæƒç ï¼Œä¹Ÿæ²¡æœ‰code_verifier
âœ“ code_verifieråªåœ¨å®¢æˆ·ç«¯ï¼Œä¸ä¼ è¾“åˆ°æµè§ˆå™¨
âœ“ æ¯æ¬¡æŽˆæƒéƒ½ç”Ÿæˆæ–°çš„éšæœºç 
âœ“ ä¸éœ€è¦client_secretä¹Ÿèƒ½ä¿è¯å®‰å…¨
```

### 8.3 æœ€ä½³å®‰å…¨å®žè·µ


**âœ… å¼€å‘ä¸­çš„å®‰å…¨æ¸…å•**ï¼š

```
æœåŠ¡ç«¯å®‰å…¨ï¼š

1. HTTPSå¼ºåˆ¶
âœ“ æ‰€æœ‰OAuthç«¯ç‚¹å¿…é¡»HTTPS
âœ“ é‡å®šå‘URIå¿…é¡»HTTPSï¼ˆæœ¬åœ°å¼€å‘é™¤å¤–ï¼‰
âœ“ é…ç½®HSTSå¤´éƒ¨

2. å‚æ•°éªŒè¯
âœ“ ç™½åå•éªŒè¯redirect_uri
âœ“ éªŒè¯scopeèŒƒå›´
âœ“ æ£€æŸ¥client_idå’Œclient_secret
âœ“ éªŒè¯stateå‚æ•°

3. ä»¤ç‰Œç®¡ç†
âœ“ è®¿é—®ä»¤ç‰ŒçŸ­æœŸæœ‰æ•ˆï¼ˆ1å°æ—¶ï¼‰
âœ“ åˆ·æ–°ä»¤ç‰Œé•¿æœŸæœ‰æ•ˆä½†å¯æ’¤é”€
âœ“ å®žçŽ°ä»¤ç‰Œè½®æ¢
âœ“ è®°å½•ä»¤ç‰Œä½¿ç”¨æ—¥å¿—

4. é™æµä¿æŠ¤
âœ“ é™åˆ¶æŽˆæƒè¯·æ±‚é¢‘çŽ‡
âœ“ é™åˆ¶ä»¤ç‰Œåˆ·æ–°é¢‘çŽ‡
âœ“ æ£€æµ‹å¼‚å¸¸è¡Œä¸º

å®¢æˆ·ç«¯å®‰å…¨ï¼š

1. ä»¤ç‰Œå­˜å‚¨
âœ“ Web: HttpOnly Cookie + SameSite
âœ“ ç§»åŠ¨: ç³»ç»ŸKeychain/Keystore
âœ— ä¸ç”¨localStorageå­˜å‚¨æ•æ„Ÿä»¤ç‰Œ

2. ä»¤ç‰Œä½¿ç”¨
âœ“ åªåœ¨HTTPSä¸‹ä¼ è¾“
âœ“ ä½¿ç”¨Authorization Header
âœ— ä¸åœ¨URLå‚æ•°ä¸­ä¼ é€’

3. å¼‚å¸¸å¤„ç†
âœ“ ä»¤ç‰Œè¿‡æœŸè‡ªåŠ¨åˆ·æ–°
âœ“ åˆ·æ–°å¤±è´¥å¼•å¯¼é‡æ–°ç™»å½•
âœ“ æ£€æµ‹ä»¤ç‰Œè¢«æ’¤é”€

4. ä»£ç å®‰å…¨
âœ“ ä¸åœ¨å‰ç«¯ä»£ç å†™æ­»client_secret
âœ“ ä½¿ç”¨çŽ¯å¢ƒå˜é‡ç®¡ç†æ•æ„Ÿä¿¡æ¯
âœ“ å®šæœŸæ›´æ–°ä¾èµ–åº“
```

### 8.4 å®‰å…¨å®¡è®¡å»ºè®®


**ðŸ” å¦‚ä½•æ£€æŸ¥ç³»ç»Ÿå®‰å…¨æ€§**ï¼š

```
å®¡è®¡æ£€æŸ¥é¡¹ï¼š

OAuthé…ç½®æ£€æŸ¥ï¼š
â–¡ redirect_uriæ˜¯å¦æœ‰ç™½åå•
â–¡ æ˜¯å¦å¼ºåˆ¶HTTPS
â–¡ client_secretæ˜¯å¦å®‰å…¨å­˜å‚¨
â–¡ æ˜¯å¦å®žçŽ°äº†PKCEï¼ˆç§»åŠ¨/SPAåº”ç”¨ï¼‰
â–¡ stateå‚æ•°æ˜¯å¦æ­£ç¡®ä½¿ç”¨

ä»¤ç‰Œå®‰å…¨æ£€æŸ¥ï¼š
â–¡ è®¿é—®ä»¤ç‰Œæœ‰æ•ˆæœŸæ˜¯å¦åˆç†
â–¡ åˆ·æ–°ä»¤ç‰Œæ˜¯å¦è½®æ¢
â–¡ ä»¤ç‰Œæ˜¯å¦åŠ å¯†å­˜å‚¨
â–¡ æ˜¯å¦æœ‰ä»¤ç‰Œæ’¤é”€æœºåˆ¶
â–¡ æ•æ„Ÿæ“ä½œæ˜¯å¦é‡æ–°éªŒè¯

ä¼ è¾“å®‰å…¨æ£€æŸ¥ï¼š
â–¡ æ˜¯å¦å…¨ç¨‹HTTPS
â–¡ è¯ä¹¦æ˜¯å¦æœ‰æ•ˆ
â–¡ æ˜¯å¦ç¦ç”¨äº†ä¸å®‰å…¨çš„åè®®ç‰ˆæœ¬
â–¡ æ•æ„Ÿæ•°æ®æ˜¯å¦åŠ å¯†ä¼ è¾“

æ—¥å¿—ç›‘æŽ§ï¼š
â–¡ æ˜¯å¦è®°å½•æŽˆæƒå¤±è´¥
â–¡ æ˜¯å¦ç›‘æŽ§å¼‚å¸¸ä»¤ç‰Œä½¿ç”¨
â–¡ æ˜¯å¦æœ‰å®‰å…¨å‘Šè­¦æœºåˆ¶
â–¡ æ—¥å¿—ä¸­æ˜¯å¦è¿‡æ»¤äº†æ•æ„Ÿä¿¡æ¯

å®šæœŸå¤æŸ¥ï¼š
â€¢ æ¯å­£åº¦å®¡è®¡ä¸€æ¬¡OAuthé…ç½®
â€¢ åŠæ—¶æ›´æ–°å®‰å…¨è¡¥ä¸
â€¢ å…³æ³¨OAuthå®‰å…¨å…¬å‘Š
â€¢ è¿›è¡Œæ¸—é€æµ‹è¯•
```

---

## 9. ðŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŽŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ðŸ”¸ OAuth2.0æœ¬è´¨ï¼šæŽˆæƒæ¡†æž¶ï¼Œè®©ç¬¬ä¸‰æ–¹åº”ç”¨èŽ·å¾—æœ‰é™è®¿é—®æƒé™
ðŸ”¸ å››å¤§è§’è‰²ï¼šèµ„æºæ‹¥æœ‰è€…ã€å®¢æˆ·ç«¯ã€æŽˆæƒæœåŠ¡å™¨ã€èµ„æºæœåŠ¡å™¨
ðŸ”¸ æŽˆæƒç æ¨¡å¼ï¼šæœ€å®‰å…¨çš„æŽˆæƒæ–¹å¼ï¼Œé€šè¿‡ä¸¤æ­¥éªŒè¯ä¿è¯å®‰å…¨
ðŸ”¸ æŽˆæƒç ä½œç”¨ï¼šä¸´æ—¶å‡­è¯ï¼Œæœ¬èº«ä¸èƒ½ç”¨ï¼Œéœ€è¦é…åˆå¯†é’¥æ¢ä»¤ç‰Œ
ðŸ”¸ è®¿é—®ä»¤ç‰Œï¼šå®žé™…çš„é€šè¡Œè¯ï¼Œç”¨æ¥è®¿é—®èµ„æº
ðŸ”¸ åˆ·æ–°ä»¤ç‰Œï¼šç”¨äºŽèŽ·å–æ–°çš„è®¿é—®ä»¤ç‰Œï¼Œé¿å…é¢‘ç¹æŽˆæƒ
ðŸ”¸ é‡å®šå‘URIï¼šæŽˆæƒå®ŒæˆåŽçš„å›žè°ƒåœ°å€ï¼Œå¿…é¡»é¢„æ³¨å†Œå’ŒéªŒè¯
ðŸ”¸ ä»¤ç‰Œç”Ÿå‘½å‘¨æœŸï¼šåˆ›å»ºã€ä½¿ç”¨ã€åˆ·æ–°ã€æ’¤é”€çš„å®Œæ•´è¿‡ç¨‹
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ðŸ”¹ OAuth2.0è§£å†³äº†ä»€ä¹ˆé—®é¢˜**ï¼š
```
ä¼ ç»Ÿé—®é¢˜ï¼š
â€¢ ç¬¬ä¸‰æ–¹åº”ç”¨éœ€è¦ç”¨æˆ·å¯†ç æ‰èƒ½è®¿é—®èµ„æº
â€¢ å¯†ç æ³„éœ²é£Žé™©é«˜
â€¢ æƒé™æ— æ³•é™åˆ¶
â€¢ æŽˆæƒæ— æ³•æ’¤é”€

OAuth2.0æ–¹æ¡ˆï¼š
â€¢ ç”¨æˆ·åªåœ¨æŽˆæƒæœåŠ¡å™¨è¾“å…¥å¯†ç 
â€¢ ç¬¬ä¸‰æ–¹åº”ç”¨èŽ·å¾—æœ‰é™æƒé™çš„ä»¤ç‰Œ
â€¢ å¯ä»¥è®¾ç½®ä»¤ç‰Œæƒé™èŒƒå›´å’Œæœ‰æ•ˆæœŸ
â€¢ ç”¨æˆ·å¯ä»¥éšæ—¶æ’¤é”€æŽˆæƒ
```

**ðŸ”¹ ä¸ºä»€ä¹ˆéœ€è¦æŽˆæƒç è¿™ä¸€æ­¥**ï¼š
```
å®‰å…¨è®¾è®¡ï¼š
â€¢ æµè§ˆå™¨ç«¯ä¼ é€’æŽˆæƒç ï¼ˆå¯ä»¥æš´éœ²ï¼‰
â€¢ æœåŠ¡å™¨ç«¯ç”¨æŽˆæƒç +å¯†é’¥æ¢ä»¤ç‰Œï¼ˆå®‰å…¨ï¼‰
â€¢ å³ä½¿æŽˆæƒç è¢«æˆªèŽ·ï¼Œæ²¡æœ‰å¯†é’¥ä¹Ÿæ— æ³•ä½¿ç”¨
â€¢ æŽˆæƒç ä¸€æ¬¡æ€§ä½¿ç”¨ï¼ŒçŸ­æœŸæœ‰æ•ˆ
```

**ðŸ”¹ è®¿é—®ä»¤ç‰Œvsåˆ·æ–°ä»¤ç‰Œçš„åŒºåˆ«**ï¼š
```
è®¿é—®ä»¤ç‰Œï¼š
â€¢ ç”¨é€”ï¼šç›´æŽ¥è®¿é—®èµ„æº
â€¢ æœ‰æ•ˆæœŸï¼šçŸ­ï¼ˆé€šå¸¸1å°æ—¶ï¼‰
â€¢ ä¼ è¾“ï¼šæ¯æ¬¡è¯·æ±‚éƒ½è¦å¸¦ä¸Š
â€¢ é£Žé™©ï¼šç»å¸¸ä¼ è¾“ï¼Œæ³„éœ²é£Žé™©è¾ƒé«˜

åˆ·æ–°ä»¤ç‰Œï¼š
â€¢ ç”¨é€”ï¼šèŽ·å–æ–°çš„è®¿é—®ä»¤ç‰Œ
â€¢ æœ‰æ•ˆæœŸï¼šé•¿ï¼ˆå‡ å¤©åˆ°å‡ ä¸ªæœˆï¼‰
â€¢ ä¼ è¾“ï¼šåªåœ¨åˆ·æ–°æ—¶ä½¿ç”¨
â€¢ é£Žé™©ï¼šä¼ è¾“å°‘ï¼Œç›¸å¯¹å®‰å…¨
```

### 9.3 å®žé™…åº”ç”¨æŒ‡å¯¼


**ðŸ’¼ å¼€å‘å®žè·µå»ºè®®**ï¼š

```
åŽç«¯å¼€å‘ï¼š
1. å®žçŽ°æ ‡å‡†OAuth2.0ç«¯ç‚¹
   â€¢ /oauth/authorize - æŽˆæƒç«¯ç‚¹
   â€¢ /oauth/token - ä»¤ç‰Œç«¯ç‚¹
   â€¢ /oauth/revoke - æ’¤é”€ç«¯ç‚¹

2. å®‰å…¨é…ç½®
   â€¢ å¼ºåˆ¶HTTPS
   â€¢ éªŒè¯redirect_uriç™½åå•
   â€¢ å®žçŽ°ä»¤ç‰ŒåŠ å¯†å­˜å‚¨
   â€¢ æ·»åŠ é™æµä¿æŠ¤

3. æ—¥å¿—ç›‘æŽ§
   â€¢ è®°å½•æŽˆæƒè¡Œä¸º
   â€¢ ç›‘æŽ§å¼‚å¸¸è®¿é—®
   â€¢ å®šæœŸå®‰å…¨å®¡è®¡

å‰ç«¯å¼€å‘ï¼š
1. æŽˆæƒæµç¨‹å®žçŽ°
   â€¢ æž„é€ æŽˆæƒURLè·³è½¬
   â€¢ å¤„ç†å›žè°ƒèŽ·å–æŽˆæƒç 
   â€¢ å‘é€åˆ°åŽç«¯æ¢å–ä»¤ç‰Œ

2. ä»¤ç‰Œç®¡ç†
   â€¢ å®‰å…¨å­˜å‚¨ä»¤ç‰Œ
   â€¢ ç›‘æŽ§ä»¤ç‰Œè¿‡æœŸ
   â€¢ è‡ªåŠ¨åˆ·æ–°æœºåˆ¶

3. é”™è¯¯å¤„ç†
   â€¢ 401é”™è¯¯è§¦å‘åˆ·æ–°
   â€¢ åˆ·æ–°å¤±è´¥é‡æ–°ç™»å½•
   â€¢ å‹å¥½çš„é”™è¯¯æç¤º

ç§»åŠ¨å¼€å‘ï¼š
1. ä½¿ç”¨PKCEå¢žå¼ºå®‰å…¨
2. ç³»ç»ŸKeychainå­˜å‚¨ä»¤ç‰Œ
3. æ·±åº¦é“¾æŽ¥å¤„ç†å›žè°ƒ
4. åŽå°è‡ªåŠ¨åˆ·æ–°ä»¤ç‰Œ
```

### 9.4 å¸¸è§é—®é¢˜è§£ç­”


**â“ ä¸ºä»€ä¹ˆä¸ç›´æŽ¥ç”¨å¯†ç æ¢ä»¤ç‰Œï¼Ÿ**
```
OAuth2.0ç¡®å®žæœ‰"å¯†ç æ¨¡å¼"(Resource Owner Password Credentials)
ä½†è¿™è¿èƒŒäº†OAuth2.0çš„åˆè¡·ï¼š

å¯†ç æ¨¡å¼é—®é¢˜ï¼š
â€¢ ç¬¬ä¸‰æ–¹åº”ç”¨æ‹¿åˆ°äº†ç”¨æˆ·å¯†ç 
â€¢ æ— æ³•é™åˆ¶åº”ç”¨æƒé™
â€¢ ç”¨æˆ·ä¿®æ”¹å¯†ç åŽåº”ç”¨è¿˜èƒ½ç”¨
â€¢ ä¸é€‚åˆç¬¬ä¸‰æ–¹åº”ç”¨

å»ºè®®ï¼š
â€¢ ä»…åœ¨è‡ªå®¶åº”ç”¨é—´ä½¿ç”¨ï¼ˆå¦‚å®˜æ–¹Appï¼‰
â€¢ ä¼˜å…ˆä½¿ç”¨æŽˆæƒç æ¨¡å¼
â€¢ ç¬¬ä¸‰æ–¹åº”ç”¨ç¦ç”¨å¯†ç æ¨¡å¼
```

**â“ ä»¤ç‰Œæœ‰æ•ˆæœŸè¯¥è®¾ç½®å¤šé•¿ï¼Ÿ**
```
æŽ¨èé…ç½®ï¼š
â€¢ è®¿é—®ä»¤ç‰Œï¼š1å°æ—¶
  - è¶³å¤Ÿå®Œæˆå¤§éƒ¨åˆ†æ“ä½œ
  - æ³„éœ²å½±å“æœ‰é™
  
â€¢ åˆ·æ–°ä»¤ç‰Œï¼š30å¤©
  - ç”¨æˆ·ä¸€ä¸ªæœˆå†…æ— éœ€é‡æ–°æŽˆæƒ
  - é•¿æœŸä¸ç”¨è‡ªåŠ¨è¿‡æœŸ

ç‰¹æ®Šåœºæ™¯ï¼š
â€¢ é«˜å®‰å…¨åœºæ™¯ï¼šè®¿é—®ä»¤ç‰Œ5-15åˆ†é’Ÿ
â€¢ ç§»åŠ¨åº”ç”¨ï¼šè®¿é—®ä»¤ç‰Œå¯ä»¥çŸ­è‡³å‡ åˆ†é’Ÿï¼ˆæœ‰åˆ·æ–°ä»¤ç‰Œï¼‰
â€¢ å†…éƒ¨ç³»ç»Ÿï¼šå¯ä»¥é€‚å½“å»¶é•¿
```

**â“ å¦‚ä½•åˆ¤æ–­ä½¿ç”¨å“ªç§æŽˆæƒæ¨¡å¼ï¼Ÿ**
```
é€‰æ‹©æŒ‡å—ï¼š

æŽˆæƒç æ¨¡å¼(æŽ¨è)ï¼š
âœ“ ä¼ ç»ŸWebåº”ç”¨
âœ“ æœ‰åŽç«¯æœåŠ¡å™¨
âœ“ èƒ½å®‰å…¨å­˜å‚¨client_secret

æŽˆæƒç +PKCEï¼š
âœ“ å•é¡µåº”ç”¨(SPA)
âœ“ ç§»åŠ¨åº”ç”¨
âœ“ æ— æ³•å®‰å…¨å­˜å‚¨client_secret

éšå¼æ¨¡å¼(ä¸æŽ¨èï¼Œå·²åºŸå¼ƒ)ï¼š
âœ— ä¸å®‰å…¨ï¼Œè¢«PKCEå–ä»£

å®¢æˆ·ç«¯å‡­è¯æ¨¡å¼ï¼š
âœ“ æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡
âœ“ æ— ç”¨æˆ·å‚ä¸Žçš„åœºæ™¯
```

**ðŸ§  è®°å¿†è¦ç‚¹**ï¼š
- OAuth2.0 = æŽˆæƒæ¡†æž¶ï¼Œä¸æ˜¯å¯†ç 
- æŽˆæƒç  = æè´§å•ï¼Œæ¢å–çœŸæ­£çš„ä»¤ç‰Œ
- è®¿é—®ä»¤ç‰Œ = çŸ­æœŸé€šè¡Œè¯
- åˆ·æ–°ä»¤ç‰Œ = ç»­ç­¾å·¥å…·
- HTTPS + PKCE = ç§»åŠ¨åº”ç”¨æ ‡é…
- å®‰å…¨æ£€æŸ¥è´¯ç©¿æ•´ä¸ªæµç¨‹

**æ ¸å¿ƒç†å¿µ**ï¼šOAuth2.0çš„è®¾è®¡å“²å­¦æ˜¯**å®‰å…¨çš„å§”æ‰˜æŽˆæƒ**ï¼Œæ°¸è¿œè®°ä½ï¼šç¬¬ä¸‰æ–¹åº”ç”¨ä¸åº”è¯¥çŸ¥é“ç”¨æˆ·å¯†ç ï¼Œä»¤ç‰Œæ˜¯æœ‰é™æƒé™å’Œæœ‰é™æ—¶é—´çš„ï¼Œå®‰å…¨æ€§é€šè¿‡å¤šå±‚éªŒè¯ä¿éšœï¼