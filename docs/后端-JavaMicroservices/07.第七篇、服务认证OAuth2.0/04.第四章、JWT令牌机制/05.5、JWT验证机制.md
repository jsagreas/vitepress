---
title: 5ã€JWTéªŒè¯æœºåˆ¶
---
## ğŸ“š ç›®å½•

1. [JWTéªŒè¯æ˜¯ä»€ä¹ˆ](#1-JWTéªŒè¯æ˜¯ä»€ä¹ˆ)
2. [TokenéªŒè¯æµç¨‹è¯¦è§£](#2-TokenéªŒè¯æµç¨‹è¯¦è§£)
3. [ç­¾åæ ¡éªŒæœºåˆ¶](#3-ç­¾åæ ¡éªŒæœºåˆ¶)
4. [è¿‡æœŸæ£€æŸ¥æœºåˆ¶](#4-è¿‡æœŸæ£€æŸ¥æœºåˆ¶)
5. [ClaimséªŒè¯è§„åˆ™](#5-ClaimséªŒè¯è§„åˆ™)
6. [é˜²ç¯¡æ”¹å®‰å…¨æœºåˆ¶](#6-é˜²ç¯¡æ”¹å®‰å…¨æœºåˆ¶)
7. [å¸¸è§éªŒè¯é”™è¯¯ä¸å¤„ç†](#7-å¸¸è§éªŒè¯é”™è¯¯ä¸å¤„ç†)
8. [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#8-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” JWTéªŒè¯æ˜¯ä»€ä¹ˆ


### 1.1 éªŒè¯çš„æœ¬è´¨ç†è§£


**é€šä¿—ç†è§£ï¼šJWTéªŒè¯å°±åƒæ£€æŸ¥"é€šè¡Œè¯"**

```
ç”Ÿæ´»åœºæ™¯ç±»æ¯”ï¼š
è¿›å…¥å°åŒº = è®¿é—®å¾®æœåŠ¡
é—¨ç¦å¡ = JWTä»¤ç‰Œ

ä¿å®‰æ£€æŸ¥é—¨ç¦å¡ï¼š
âœ… å¡æ˜¯çœŸçš„å—ï¼Ÿï¼ˆç­¾åæ ¡éªŒï¼‰
âœ… å¡è¿‡æœŸäº†å—ï¼Ÿï¼ˆæ—¶é—´æ£€æŸ¥ï¼‰
âœ… å¡ä¸Šä¿¡æ¯å¯¹å—ï¼Ÿï¼ˆæ•°æ®éªŒè¯ï¼‰
âœ… å¡è¢«æ¶‚æ”¹è¿‡å—ï¼Ÿï¼ˆé˜²ç¯¡æ”¹ï¼‰
```

**ä¸“ä¸šå®šä¹‰ï¼š**
> JWTéªŒè¯æ˜¯æœåŠ¡ç«¯æ£€æŸ¥ä»¤ç‰Œ**åˆæ³•æ€§ã€æœ‰æ•ˆæ€§ã€å®Œæ•´æ€§**çš„è¿‡ç¨‹ï¼Œç¡®ä¿è¯·æ±‚æ¥è‡ªå¯ä¿¡ç”¨æˆ·ä¸”æ•°æ®æœªè¢«ç¯¡æ”¹ã€‚

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦JWTéªŒè¯


**æ ¸å¿ƒé—®é¢˜ï¼š** å¦‚ä½•ç¡®ä¿æ¥æ”¶åˆ°çš„Tokenæ˜¯å®‰å…¨å¯ä¿¡çš„ï¼Ÿ

```
ä¸éªŒè¯çš„é£é™©ï¼š
âŒ ä¼ªé€ Tokenï¼šæ”»å‡»è€…è‡ªå·±ç”Ÿæˆå‡ä»¤ç‰Œ
âŒ ç¯¡æ”¹æ•°æ®ï¼šä¿®æ”¹Tokenä¸­çš„ç”¨æˆ·æƒé™
âŒ è¿‡æœŸTokenï¼šä½¿ç”¨å·²å¤±æ•ˆçš„æ—§ä»¤ç‰Œ
âŒ é‡æ”¾æ”»å‡»ï¼šæˆªè·Tokenåå¤ä½¿ç”¨

éªŒè¯çš„ä»·å€¼ï¼š
âœ… èº«ä»½ç¡®è®¤ï¼šç¡®ä¿ç”¨æˆ·èº«ä»½çœŸå®
âœ… æƒé™æ§åˆ¶ï¼šéªŒè¯ç”¨æˆ·æ“ä½œæƒé™
âœ… æ•°æ®å®Œæ•´ï¼šä¿è¯ä¿¡æ¯æœªè¢«ä¿®æ”¹
âœ… å®‰å…¨é˜²æŠ¤ï¼šæŠµå¾¡å„ç±»æ”»å‡»
```

---

## 2. ğŸ”„ TokenéªŒè¯æµç¨‹è¯¦è§£


### 2.1 å®Œæ•´éªŒè¯æµç¨‹


**éªŒè¯æµç¨‹å›¾ç¤ºï¼š**
```
å®¢æˆ·ç«¯è¯·æ±‚                           æœåŠ¡ç«¯éªŒè¯
   |                                    |
   |--- [1] æºå¸¦JWT Token ------------->|
   |    Header: Authorization          |
   |                                    |
   |                              [2] æå–Token
   |                                    |
   |                              [3] è§£æç»“æ„
   |                             Header.Payload.Signature
   |                                    |
   |                              [4] ç­¾åæ ¡éªŒ
   |                              ç”¨å¯†é’¥é‡æ–°è®¡ç®—ç­¾å
   |                                    â†“
   |                              ç­¾åä¸€è‡´ï¼Ÿ
   |                             â†™Yes        â†˜No
   |                        [5] æ£€æŸ¥è¿‡æœŸ    è¿”å›401é”™è¯¯
   |                             â†“
   |                        æ—¶é—´æœ‰æ•ˆï¼Ÿ
   |                       â†™Yes      â†˜No
   |                  [6] ClaimséªŒè¯  è¿”å›401é”™è¯¯
   |                       â†“
   |                  æ•°æ®åˆæ³•ï¼Ÿ
   |                 â†™Yes      â†˜No
   |            [7] éªŒè¯é€šè¿‡   è¿”å›403é”™è¯¯
   |                 â†“
   |<------- è¿”å›ä¸šåŠ¡æ•°æ® -------|
```

### 2.2 éªŒè¯æ­¥éª¤è¯¦è§£


**æ­¥éª¤1ï¼šæå–Token**
```java
// ä»HTTPè¯·æ±‚å¤´ä¸­æå–JWT
String authHeader = request.getHeader("Authorization");

// æ£€æŸ¥æ ¼å¼ï¼šBearer <token>
if (authHeader != null && authHeader.startsWith("Bearer ")) {
    String token = authHeader.substring(7); // å»æ‰"Bearer "å‰ç¼€
}
```

**æ­¥éª¤2ï¼šè§£æTokenç»“æ„**
```java
// JWTç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œç”¨.åˆ†éš”
String[] parts = token.split("\\.");

if (parts.length != 3) {
    throw new JwtException("Tokenæ ¼å¼é”™è¯¯");
}

String headerBase64 = parts[0];   // Header
String payloadBase64 = parts[1];  // Payload
String signature = parts[2];      // Signature
```

**æ­¥éª¤3-7ï¼šæ ¸å¿ƒéªŒè¯é€»è¾‘**
- **ç­¾åæ ¡éªŒ** â†’ ç¡®ä¿Tokenæœªè¢«ç¯¡æ”¹
- **è¿‡æœŸæ£€æŸ¥** â†’ ç¡®ä¿Tokenåœ¨æœ‰æ•ˆæœŸå†…
- **ClaimséªŒè¯** â†’ ç¡®ä¿ä¸šåŠ¡æ•°æ®åˆæ³•

---

## 3. ğŸ” ç­¾åæ ¡éªŒæœºåˆ¶


### 3.1 ç­¾åæ ¡éªŒåŸç†


**æ ¸å¿ƒæ¦‚å¿µï¼šç­¾åæ˜¯Tokençš„"é˜²ä¼ªæ ‡è¯†"**

```
ç­¾åç”Ÿæˆè¿‡ç¨‹ï¼ˆå‘æ”¾Tokenæ—¶ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ç¼–ç Headerå’ŒPayload              â”‚
â”‚    base64(Header) + "." + base64(Payload) â”‚
â”‚                                     â”‚
â”‚ 2. ä½¿ç”¨å¯†é’¥å’Œç®—æ³•è®¡ç®—ç­¾å           â”‚
â”‚    HMACSHA256(                      â”‚
â”‚      base64UrlEncode(header) + "." +â”‚
â”‚      base64UrlEncode(payload),      â”‚
â”‚      secret_key                     â”‚
â”‚    )                                â”‚
â”‚                                     â”‚
â”‚ 3. æ‹¼æ¥æˆå®Œæ•´JWT                    â”‚
â”‚    Header.Payload.Signature         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç­¾åéªŒè¯è¿‡ç¨‹ï¼ˆæ¥æ”¶Tokenæ—¶ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æå–Tokenä¸­çš„ç­¾åéƒ¨åˆ†            â”‚
â”‚    signature = parts[2]             â”‚
â”‚                                     â”‚
â”‚ 2. ç”¨ç›¸åŒå¯†é’¥é‡æ–°è®¡ç®—ç­¾å           â”‚
â”‚    expectedSignature = HMACSHA256(  â”‚
â”‚      parts[0] + "." + parts[1],     â”‚
â”‚      secret_key                     â”‚
â”‚    )                                â”‚
â”‚                                     â”‚
â”‚ 3. å¯¹æ¯”ç­¾å                         â”‚
â”‚    if (signature == expectedSignature) â”‚
â”‚       âœ… éªŒè¯é€šè¿‡                    â”‚
â”‚    else                             â”‚
â”‚       âŒ Tokenè¢«ç¯¡æ”¹                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ç­¾åç®—æ³•é€‰æ‹©


| ç®—æ³•ç±»å‹ | **ç®—æ³•åç§°** | **å®‰å…¨æ€§** | **é€Ÿåº¦** | **åº”ç”¨åœºæ™¯** |
|---------|------------|-----------|---------|-------------|
| å¯¹ç§°ç®—æ³• | `HS256` | ä¸­ç­‰ | å¿« | å•ä½“åº”ç”¨ã€å†…éƒ¨æœåŠ¡ |
| å¯¹ç§°ç®—æ³• | `HS512` | è¾ƒé«˜ | å¿« | å®‰å…¨è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ |
| éå¯¹ç§°ç®—æ³• | `RS256` | é«˜ | æ…¢ | å¾®æœåŠ¡ã€å…¬é’¥åˆ†å‘ |
| éå¯¹ç§°ç®—æ³• | `ES256` | é«˜ | ä¸­ç­‰ | ç§»åŠ¨åº”ç”¨ã€æ€§èƒ½æ•æ„Ÿ |

**é€‰æ‹©å»ºè®®ï¼š**
```
å†…éƒ¨å¾®æœåŠ¡é€šä¿¡ï¼š
â†’ ä½¿ç”¨HS256ï¼ˆå¯¹ç§°åŠ å¯†ï¼Œå¯†é’¥å†…éƒ¨å…±äº«ï¼‰
â†’ ä¼˜ç‚¹ï¼šé€Ÿåº¦å¿«ï¼Œå®ç°ç®€å•
â†’ æ³¨æ„ï¼šå¯†é’¥å¿…é¡»ä¸¥æ ¼ä¿å¯†

å¯¹å¤–å¼€æ”¾APIï¼š
â†’ ä½¿ç”¨RS256ï¼ˆéå¯¹ç§°åŠ å¯†ï¼Œå…¬é’¥å…¬å¼€ï¼‰
â†’ ä¼˜ç‚¹ï¼šç§é’¥åªåœ¨æˆæƒæœåŠ¡å™¨ï¼Œæ›´å®‰å…¨
â†’ é€‚åˆï¼šç¬¬ä¸‰æ–¹é›†æˆã€å¤šæ–¹éªŒè¯
```

### 3.3 ç­¾åéªŒè¯å®ç°


```java
// ä½¿ç”¨JWTåº“éªŒè¯ç­¾å
import io.jsonwebtoken.*;

public boolean validateSignature(String token) {
    try {
        // è§£æå¹¶éªŒè¯Tokenï¼ˆè‡ªåŠ¨éªŒè¯ç­¾åï¼‰
        Claims claims = Jwts.parserBuilder()
            .setSigningKey(secretKey)  // è®¾ç½®å¯†é’¥
            .build()
            .parseClaimsJws(token)     // è§£æToken
            .getBody();
        
        return true; // ç­¾åéªŒè¯é€šè¿‡
        
    } catch (SignatureException e) {
        // ç­¾åä¸åŒ¹é… - Tokenè¢«ç¯¡æ”¹
        log.error("ç­¾åéªŒè¯å¤±è´¥ï¼šTokenå¯èƒ½è¢«ç¯¡æ”¹");
        return false;
    }
}
```

---

## 4. â° è¿‡æœŸæ£€æŸ¥æœºåˆ¶


### 4.1 æ—¶é—´æœ‰æ•ˆæ€§éªŒè¯


**æ ¸å¿ƒå­—æ®µï¼š**
- **`exp`** (Expiration Time) - è¿‡æœŸæ—¶é—´
- **`nbf`** (Not Before) - ç”Ÿæ•ˆæ—¶é—´  
- **`iat`** (Issued At) - ç­¾å‘æ—¶é—´

```
æ—¶é—´éªŒè¯é€»è¾‘ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å½“å‰æ—¶é—´ï¼š2025-01-15 14:30:00       â”‚
â”‚                                     â”‚
â”‚ Tokenæ—¶é—´ä¿¡æ¯ï¼š                     â”‚
â”‚   iat: 2025-01-15 14:00:00 (ç­¾å‘)  â”‚
â”‚   nbf: 2025-01-15 14:00:00 (ç”Ÿæ•ˆ)  â”‚
â”‚   exp: 2025-01-15 16:00:00 (è¿‡æœŸ)  â”‚
â”‚                                     â”‚
â”‚ éªŒè¯æ¡ä»¶ï¼š                          â”‚
â”‚   âœ… å½“å‰æ—¶é—´ >= nbfï¼ˆå·²ç”Ÿæ•ˆï¼‰       â”‚
â”‚   âœ… å½“å‰æ—¶é—´ < expï¼ˆæœªè¿‡æœŸï¼‰        â”‚
â”‚                                     â”‚
â”‚ å¦‚æœä»»ä¸€æ¡ä»¶ä¸æ»¡è¶³ â†’ Tokenæ— æ•ˆ      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 è¿‡æœŸæ£€æŸ¥å®ç°


```java
public boolean checkExpiration(String token) {
    try {
        Claims claims = Jwts.parserBuilder()
            .setSigningKey(secretKey)
            .build()
            .parseClaimsJws(token)
            .getBody();
        
        // è·å–è¿‡æœŸæ—¶é—´
        Date expiration = claims.getExpiration();
        
        // åˆ¤æ–­æ˜¯å¦è¿‡æœŸ
        if (expiration.before(new Date())) {
            log.warn("Tokenå·²è¿‡æœŸï¼š{}", expiration);
            return false;
        }
        
        return true;
        
    } catch (ExpiredJwtException e) {
        // JWTåº“è‡ªåŠ¨æ£€æµ‹åˆ°è¿‡æœŸ
        log.error("Tokenè¿‡æœŸå¼‚å¸¸");
        return false;
    }
}
```

### 4.3 è¿‡æœŸæ—¶é—´è®¾ç½®ç­–ç•¥


**ä¸åŒåœºæ™¯çš„æœ‰æ•ˆæœŸè®¾ç½®ï¼š**

| åœºæ™¯ç±»å‹ | **æœ‰æ•ˆæœŸ** | **åˆ·æ–°ç­–ç•¥** | **è¯´æ˜** |
|---------|----------|------------|---------|
| è®¿é—®ä»¤ç‰Œ(Access Token) | `15åˆ†é’Ÿ` | ä½¿ç”¨Refresh Tokenåˆ·æ–° | çŸ­æœŸæœ‰æ•ˆï¼Œé™ä½é£é™© |
| åˆ·æ–°ä»¤ç‰Œ(Refresh Token) | `7å¤©` | é‡æ–°ç™»å½• | ç”¨äºè·å–æ–°Access Token |
| è®°ä½æˆ‘åŠŸèƒ½ | `30å¤©` | æ»‘åŠ¨è¿‡æœŸ | æ¯æ¬¡ä½¿ç”¨å»¶é•¿æœ‰æ•ˆæœŸ |
| ä¸´æ—¶Token | `5åˆ†é’Ÿ` | ä¸åˆ·æ–° | é‚®ç®±éªŒè¯ã€å¯†ç é‡ç½® |

**æ»‘åŠ¨è¿‡æœŸç¤ºä¾‹ï¼š**
```java
// æ¯æ¬¡éªŒè¯æˆåŠŸåå»¶é•¿è¿‡æœŸæ—¶é—´
public String renewTokenIfNeeded(String token) {
    Claims claims = parseToken(token);
    Date expiration = claims.getExpiration();
    Date now = new Date();
    
    // å¦‚æœå‰©ä½™æ—¶é—´ä¸è¶³ä¸€åŠï¼Œé‡æ–°ç­¾å‘
    long remaining = expiration.getTime() - now.getTime();
    long total = expiration.getTime() - claims.getIssuedAt().getTime();
    
    if (remaining < total / 2) {
        return generateNewToken(claims); // é‡æ–°ç”ŸæˆToken
    }
    
    return token; // ä¿æŒåŸToken
}
```

---

## 5. ğŸ“‹ ClaimséªŒè¯è§„åˆ™


### 5.1 Claimsæ˜¯ä»€ä¹ˆ


**é€šä¿—ç†è§£ï¼šClaimså°±æ˜¯Tokené‡Œçš„"ä¿¡æ¯å­—æ®µ"**

```
JWT Payloadä¸­çš„Claimsï¼š
{
  // æ ‡å‡†Claimsï¼ˆJWTè§„èŒƒå®šä¹‰ï¼‰
  "iss": "auth-service",        // ç­¾å‘è€…
  "sub": "user123",             // ä¸»é¢˜ï¼ˆç”¨æˆ·IDï¼‰
  "aud": "api-service",         // æ¥æ”¶è€…
  "exp": 1705324800,            // è¿‡æœŸæ—¶é—´
  "iat": 1705320000,            // ç­¾å‘æ—¶é—´
  
  // è‡ªå®šä¹‰Claimsï¼ˆä¸šåŠ¡æ•°æ®ï¼‰
  "username": "å¼ ä¸‰",
  "role": "admin",
  "permissions": ["read", "write"]
}
```

### 5.2 æ ¸å¿ƒClaimséªŒè¯


**éªŒè¯é¡¹ç›®æ¸…å•ï¼š**

```
âœ… å¿…é¡»éªŒè¯çš„Claimsï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. issï¼ˆç­¾å‘è€…ï¼‰éªŒè¯                â”‚
â”‚    â†’ ç¡®ä¿Tokenæ¥è‡ªå¯ä¿¡çš„æˆæƒæœåŠ¡å™¨   â”‚
â”‚                                    â”‚
â”‚ 2. audï¼ˆæ¥æ”¶è€…ï¼‰éªŒè¯                â”‚
â”‚    â†’ ç¡®ä¿Tokenæ˜¯å‘ç»™å½“å‰æœåŠ¡çš„       â”‚
â”‚                                    â”‚
â”‚ 3. expï¼ˆè¿‡æœŸæ—¶é—´ï¼‰éªŒè¯              â”‚
â”‚    â†’ ç¡®ä¿Tokenæœªè¿‡æœŸ                â”‚
â”‚                                    â”‚
â”‚ 4. subï¼ˆä¸»é¢˜ï¼‰éªŒè¯                  â”‚
â”‚    â†’ ç¡®ä¿ç”¨æˆ·IDå­˜åœ¨ä¸”æœ‰æ•ˆ           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš¡ å¯é€‰éªŒè¯çš„Claimsï¼š
- nbfï¼ˆç”Ÿæ•ˆæ—¶é—´ï¼‰ï¼šé˜²æ­¢æå‰ä½¿ç”¨
- jtiï¼ˆToken IDï¼‰ï¼šé˜²æ­¢é‡æ”¾æ”»å‡»
- è‡ªå®šä¹‰Claimsï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚éªŒè¯
```

### 5.3 ClaimséªŒè¯å®ç°


```java
public void validateClaims(String token) {
    Claims claims = parseToken(token);
    
    // 1. éªŒè¯ç­¾å‘è€…
    String issuer = claims.getIssuer();
    if (!"auth-service".equals(issuer)) {
        throw new JwtException("ç­¾å‘è€…ä¸åŒ¹é…");
    }
    
    // 2. éªŒè¯æ¥æ”¶è€…
    String audience = claims.getAudience();
    if (!"api-service".equals(audience)) {
        throw new JwtException("æ¥æ”¶è€…ä¸åŒ¹é…");
    }
    
    // 3. éªŒè¯ç”¨æˆ·ID
    String userId = claims.getSubject();
    if (userId == null || userId.isEmpty()) {
        throw new JwtException("ç”¨æˆ·IDç¼ºå¤±");
    }
    
    // 4. éªŒè¯è‡ªå®šä¹‰Claimsï¼ˆå¯é€‰ï¼‰
    String role = (String) claims.get("role");
    if (role == null) {
        throw new JwtException("è§’è‰²ä¿¡æ¯ç¼ºå¤±");
    }
}
```

### 5.4 ä¸šåŠ¡ClaimséªŒè¯ç¤ºä¾‹


```java
// éªŒè¯ç”¨æˆ·æƒé™
public boolean hasPermission(String token, String requiredPermission) {
    Claims claims = parseToken(token);
    
    // è·å–æƒé™åˆ—è¡¨
    List<String> permissions = claims.get("permissions", List.class);
    
    // æ£€æŸ¥æ˜¯å¦åŒ…å«æ‰€éœ€æƒé™
    return permissions != null && permissions.contains(requiredPermission);
}

// éªŒè¯ç”¨æˆ·è§’è‰²
public boolean hasRole(String token, String requiredRole) {
    Claims claims = parseToken(token);
    String role = (String) claims.get("role");
    return requiredRole.equals(role);
}
```

---

## 6. ğŸ›¡ï¸ é˜²ç¯¡æ”¹å®‰å…¨æœºåˆ¶


### 6.1 ç¯¡æ”¹æ”»å‡»åŸç†


**æ”»å‡»åœºæ™¯ç¤ºä¾‹ï¼š**

```
åŸå§‹Tokenï¼ˆæ™®é€šç”¨æˆ·ï¼‰ï¼š
Header.Payload.Signature
{
  "userId": "123",
  "role": "user"          â† æ™®é€šç”¨æˆ·
}

æ”»å‡»è€…å°è¯•ç¯¡æ”¹ï¼š
{
  "userId": "123",
  "role": "admin"         â† ä¿®æ”¹ä¸ºç®¡ç†å‘˜
}

ä¸ºä»€ä¹ˆç¯¡æ”¹ä¼šå¤±è´¥ï¼Ÿ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ä¿®æ”¹Payloadåï¼Œé‡æ–°ç¼–ç           â”‚
â”‚    newPayload = base64(ä¿®æ”¹åçš„æ•°æ®) â”‚
â”‚                                    â”‚
â”‚ 2. æ‹¼æ¥ç¯¡æ”¹åçš„Token                â”‚
â”‚    Header.newPayload.åŸå§‹Signature â”‚
â”‚                                    â”‚
â”‚ 3. æœåŠ¡å™¨éªŒè¯ç­¾å                   â”‚
â”‚    è®¡ç®—ï¼šHMAC(Header.newPayload)   â”‚
â”‚    å¯¹æ¯”ï¼šåŸå§‹Signature              â”‚
â”‚    ç»“æœï¼šâŒ ä¸åŒ¹é…ï¼                 â”‚
â”‚                                    â”‚
â”‚ â†’ éªŒè¯å¤±è´¥ï¼Œæ”»å‡»è¢«é˜»æ­¢              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 é˜²ç¯¡æ”¹æ ¸å¿ƒæœºåˆ¶


**ä¸‰é‡ä¿æŠ¤æœºåˆ¶ï¼š**

```
ğŸ”’ æœºåˆ¶1ï¼šå¯†é’¥ä¿æŠ¤
â†’ ç­¾åéœ€è¦å¯†é’¥ï¼Œæ”»å‡»è€…æ— æ³•è·å–
â†’ å³ä½¿ä¿®æ”¹Payloadï¼Œä¹Ÿæ— æ³•ç”Ÿæˆæ­£ç¡®ç­¾å

ğŸ”’ æœºåˆ¶2ï¼šç­¾åç»‘å®š
â†’ ç­¾åä¸Headerå’ŒPayloadç»‘å®š
â†’ ä»»ä½•ä¿®æ”¹éƒ½ä¼šå¯¼è‡´ç­¾åå¤±è´¥

ğŸ”’ æœºåˆ¶3ï¼šå®Œæ•´æ€§æ ¡éªŒ
â†’ éªŒè¯æ—¶é‡æ–°è®¡ç®—ç­¾å
â†’ ç¡®ä¿æ•°æ®æœªè¢«ä¿®æ”¹
```

### 6.3 å¸¸è§ç¯¡æ”¹æ‰‹æ®µä¸é˜²å¾¡


| æ”»å‡»æ–¹å¼ | **æ”»å‡»æ‰‹æ®µ** | **é˜²å¾¡æªæ–½** |
|---------|------------|-------------|
| ä¿®æ”¹Payload | è§£ç åä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ | ç­¾åéªŒè¯è‡ªåŠ¨å¤±è´¥ |
| ä¼ªé€ ç­¾å | å°è¯•çŒœæµ‹æˆ–æš´åŠ›ç ´è§£å¯†é’¥ | ä½¿ç”¨å¼ºå¯†é’¥ï¼ˆ256ä½ä»¥ä¸Šï¼‰ |
| ç®—æ³•æ›¿æ¢ | å°†RS256æ”¹ä¸ºHS256 | ä¸¥æ ¼éªŒè¯ç®—æ³•ç±»å‹ |
| é‡æ”¾æ”»å‡» | æˆªè·Tokenåå¤ä½¿ç”¨ | æ·»åŠ jtiå­—æ®µé˜²é‡æ”¾ |

**é˜²é‡æ”¾æ”»å‡»å®ç°ï¼š**
```java
// ä½¿ç”¨Token IDé˜²æ­¢é‡æ”¾
private Set<String> usedTokenIds = new ConcurrentHashSet<>();

public boolean validateTokenId(String token) {
    Claims claims = parseToken(token);
    String jti = claims.getId(); // è·å–Token ID
    
    // æ£€æŸ¥æ˜¯å¦å·²ä½¿ç”¨è¿‡
    if (usedTokenIds.contains(jti)) {
        log.warn("æ£€æµ‹åˆ°é‡æ”¾æ”»å‡»ï¼šToken IDå·²ä½¿ç”¨");
        return false;
    }
    
    // æ ‡è®°ä¸ºå·²ä½¿ç”¨
    usedTokenIds.add(jti);
    return true;
}
```

---

## 7. âš ï¸ å¸¸è§éªŒè¯é”™è¯¯ä¸å¤„ç†


### 7.1 éªŒè¯å¼‚å¸¸åˆ†ç±»


**å¼‚å¸¸ç±»å‹é€ŸæŸ¥è¡¨ï¼š**

| å¼‚å¸¸ç±»å‹ | **é”™è¯¯åŸå› ** | **HTTPçŠ¶æ€ç ** | **å¤„ç†å»ºè®®** |
|---------|------------|--------------|-------------|
| `SignatureException` | ç­¾åéªŒè¯å¤±è´¥ | `401` | Tokenè¢«ç¯¡æ”¹ï¼Œæ‹’ç»è®¿é—® |
| `ExpiredJwtException` | Tokenå·²è¿‡æœŸ | `401` | æç¤ºé‡æ–°ç™»å½•æˆ–åˆ·æ–°Token |
| `MalformedJwtException` | Tokenæ ¼å¼é”™è¯¯ | `400` | æ£€æŸ¥Tokenæ ¼å¼ |
| `UnsupportedJwtException` | ä¸æ”¯æŒçš„ç®—æ³• | `400` | ä½¿ç”¨æ­£ç¡®çš„ç­¾åç®—æ³• |
| `IllegalArgumentException` | Tokenä¸ºç©ºæˆ–null | `400` | æ£€æŸ¥è¯·æ±‚å¤´ |

### 7.2 é”™è¯¯å¤„ç†æœ€ä½³å®è·µ


```java
@Component
public class JwtValidator {
    
    public ValidateResult validate(String token) {
        try {
            // æ‰§è¡ŒéªŒè¯
            Claims claims = Jwts.parserBuilder()
                .setSigningKey(secretKey)
                .build()
                .parseClaimsJws(token)
                .getBody();
            
            return ValidateResult.success(claims);
            
        } catch (SignatureException e) {
            // ç­¾åéªŒè¯å¤±è´¥
            return ValidateResult.error(401, "ç­¾åéªŒè¯å¤±è´¥ï¼ŒTokenå¯èƒ½è¢«ç¯¡æ”¹");
            
        } catch (ExpiredJwtException e) {
            // Tokenè¿‡æœŸ
            return ValidateResult.error(401, "Tokenå·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•");
            
        } catch (MalformedJwtException e) {
            // æ ¼å¼é”™è¯¯
            return ValidateResult.error(400, "Tokenæ ¼å¼é”™è¯¯");
            
        } catch (Exception e) {
            // å…¶ä»–å¼‚å¸¸
            log.error("TokenéªŒè¯å¼‚å¸¸", e);
            return ValidateResult.error(500, "TokenéªŒè¯å¤±è´¥");
        }
    }
}
```

### 7.3 ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º


```java
@RestControllerAdvice
public class JwtExceptionHandler {
    
    @ExceptionHandler(JwtException.class)
    public ResponseEntity<ErrorResponse> handleJwtException(JwtException e) {
        
        ErrorResponse response = new ErrorResponse();
        
        if (e instanceof ExpiredJwtException) {
            // è¿‡æœŸé”™è¯¯
            response.setCode(401);
            response.setMessage("ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•");
            response.setAction("redirect_to_login"); // å‰ç«¯è·³è½¬ç™»å½•é¡µ
            
        } else if (e instanceof SignatureException) {
            // ç­¾åé”™è¯¯
            response.setCode(401);
            response.setMessage("è®¤è¯å¤±è´¥ï¼Œè¯·é‡æ–°ç™»å½•");
            
        } else {
            // å…¶ä»–é”™è¯¯
            response.setCode(400);
            response.setMessage("è¯·æ±‚éªŒè¯å¤±è´¥");
        }
        
        return ResponseEntity.status(response.getCode()).body(response);
    }
}
```

---

## 8. âš¡ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


### 8.1 éªŒè¯æ€§èƒ½ç“¶é¢ˆåˆ†æ


**æ€§èƒ½æ¶ˆè€—ç‚¹ï¼š**
```
JWTéªŒè¯æµç¨‹çš„è€—æ—¶åˆ†å¸ƒï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Tokenè§£æ        â†’ 5%         â”‚
â”‚ 2. ç­¾åè®¡ç®—         â†’ 70%        â”‚ â† ä¸»è¦ç“¶é¢ˆ
â”‚ 3. æ—¶é—´æ£€æŸ¥         â†’ 5%         â”‚
â”‚ 4. Claimsæå–       â†’ 10%        â”‚
â”‚ 5. ä¸šåŠ¡é€»è¾‘éªŒè¯     â†’ 10%        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é—®é¢˜ï¼š
æ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦é‡æ–°è®¡ç®—ç­¾å
â†’ CPUå¯†é›†å‹æ“ä½œ
â†’ é«˜å¹¶å‘æ—¶æ€§èƒ½ä¸‹é™
```

### 8.2 ç¼“å­˜ä¼˜åŒ–ç­–ç•¥


**æ–¹æ¡ˆ1ï¼šéªŒè¯ç»“æœç¼“å­˜**
```java
@Component
public class CachedJwtValidator {
    
    // ä½¿ç”¨æœ¬åœ°ç¼“å­˜å­˜å‚¨éªŒè¯ç»“æœ
    private final Cache<String, Claims> tokenCache = CacheBuilder.newBuilder()
        .maximumSize(10000)              // æœ€å¤šç¼“å­˜1ä¸‡ä¸ªToken
        .expireAfterWrite(5, TimeUnit.MINUTES) // 5åˆ†é’Ÿåè¿‡æœŸ
        .build();
    
    public Claims validateWithCache(String token) {
        // å…ˆæŸ¥ç¼“å­˜
        Claims cached = tokenCache.getIfPresent(token);
        if (cached != null) {
            return cached; // ç¼“å­˜å‘½ä¸­ï¼Œç›´æ¥è¿”å›
        }
        
        // ç¼“å­˜æœªå‘½ä¸­ï¼Œæ‰§è¡ŒéªŒè¯
        Claims claims = performValidation(token);
        
        // å­˜å…¥ç¼“å­˜
        tokenCache.put(token, claims);
        
        return claims;
    }
}
```

**æ–¹æ¡ˆ2ï¼šRedisåˆ†å¸ƒå¼ç¼“å­˜**
```java
@Component
public class RedisJwtValidator {
    
    @Autowired
    private RedisTemplate<String, Claims> redisTemplate;
    
    public Claims validateWithRedis(String token) {
        String cacheKey = "jwt:validated:" + DigestUtils.md5Hex(token);
        
        // æŸ¥è¯¢Redisç¼“å­˜
        Claims cached = redisTemplate.opsForValue().get(cacheKey);
        if (cached != null) {
            return cached;
        }
        
        // æ‰§è¡ŒéªŒè¯
        Claims claims = performValidation(token);
        
        // ç¼“å­˜åˆ°Redisï¼ˆè®¾ç½®åˆç†è¿‡æœŸæ—¶é—´ï¼‰
        long expireSeconds = (claims.getExpiration().getTime() - System.currentTimeMillis()) / 1000;
        redisTemplate.opsForValue().set(cacheKey, claims, expireSeconds, TimeUnit.SECONDS);
        
        return claims;
    }
}
```

### 8.3 ç®—æ³•ä¼˜åŒ–


**é€‰æ‹©é«˜æ€§èƒ½ç®—æ³•ï¼š**

| ç®—æ³• | **é€Ÿåº¦** | **å®‰å…¨æ€§** | **æ¨èåœºæ™¯** |
|------|---------|----------|-------------|
| HS256 | âš¡âš¡âš¡ | â­â­â­ | å†…éƒ¨æœåŠ¡ï¼Œæ€§èƒ½ä¼˜å…ˆ |
| HS512 | âš¡âš¡ | â­â­â­â­ | å¹³è¡¡æ€§èƒ½ä¸å®‰å…¨ |
| RS256 | âš¡ | â­â­â­â­â­ | å¯¹å¤–APIï¼Œå®‰å…¨ä¼˜å…ˆ |

**æ€§èƒ½å¯¹æ¯”ï¼š**
```
ç›¸åŒç¡¬ä»¶ç¯å¢ƒä¸‹ï¼Œ1000æ¬¡ç­¾åéªŒè¯è€—æ—¶ï¼š
HS256ï¼šçº¦ 50ms   â† æœ€å¿«
HS512ï¼šçº¦ 80ms
RS256ï¼šçº¦ 300ms  â† æœ€æ…¢

å»ºè®®ï¼š
- å†…éƒ¨å¾®æœåŠ¡ï¼šä¼˜å…ˆä½¿ç”¨HS256
- å¯¹å¤–æ¥å£ï¼šä½¿ç”¨RS256ä¿è¯å®‰å…¨
```

### 8.4 å¹¶å‘ä¼˜åŒ–


**çº¿ç¨‹å®‰å…¨çš„éªŒè¯å™¨ï¼š**
```java
@Component
public class ThreadSafeValidator {
    
    // å¤ç”¨Parserï¼Œé¿å…é‡å¤åˆ›å»º
    private final JwtParser jwtParser;
    
    public ThreadSafeValidator(@Value("${jwt.secret}") String secret) {
        this.jwtParser = Jwts.parserBuilder()
            .setSigningKey(secret)
            .build();
    }
    
    public Claims validate(String token) {
        // JwtParseræ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥å¹¶å‘ä½¿ç”¨
        return jwtParser.parseClaimsJws(token).getBody();
    }
}
```

**æ‰¹é‡éªŒè¯ä¼˜åŒ–ï¼š**
```java
// ä½¿ç”¨CompletableFutureå¹¶è¡ŒéªŒè¯å¤šä¸ªToken
public Map<String, Claims> validateBatch(List<String> tokens) {
    List<CompletableFuture<Pair<String, Claims>>> futures = tokens.stream()
        .map(token -> CompletableFuture.supplyAsync(() -> {
            Claims claims = validate(token);
            return Pair.of(token, claims);
        }))
        .collect(Collectors.toList());
    
    return futures.stream()
        .map(CompletableFuture::join)
        .collect(Collectors.toMap(Pair::getKey, Pair::getValue));
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ” JWTéªŒè¯æœ¬è´¨ï¼š
â†’ æ£€æŸ¥Tokençš„åˆæ³•æ€§ã€æœ‰æ•ˆæ€§ã€å®Œæ•´æ€§
â†’ ç¡®ä¿è¯·æ±‚æ¥è‡ªå¯ä¿¡ç”¨æˆ·ä¸”æ•°æ®æœªè¢«ç¯¡æ”¹

ğŸ”„ å®Œæ•´éªŒè¯æµç¨‹ï¼š
æå–Token â†’ è§£æç»“æ„ â†’ ç­¾åæ ¡éªŒ â†’ è¿‡æœŸæ£€æŸ¥ â†’ ClaimséªŒè¯

ğŸ” ä¸‰å¤§æ ¸å¿ƒéªŒè¯ï¼š
1. ç­¾åæ ¡éªŒï¼šé˜²æ­¢Tokenè¢«ç¯¡æ”¹
2. è¿‡æœŸæ£€æŸ¥ï¼šç¡®ä¿Tokenåœ¨æœ‰æ•ˆæœŸå†…
3. ClaimséªŒè¯ï¼šç¡®ä¿ä¸šåŠ¡æ•°æ®åˆæ³•
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆç­¾åèƒ½é˜²ç¯¡æ”¹ï¼Ÿ**
```
ç­¾åæœºåˆ¶åŸç†ï¼š
â†’ ç­¾å = HMAC(Header + Payload, å¯†é’¥)
â†’ ä¿®æ”¹Payloadåï¼Œç­¾åå¿…ç„¶ä¸åŒ¹é…
â†’ æ”»å‡»è€…æ— å¯†é’¥ï¼Œæ— æ³•ç”Ÿæˆæ­£ç¡®ç­¾å
â†’ å› æ­¤ä»»ä½•ç¯¡æ”¹éƒ½ä¼šè¢«æ£€æµ‹åˆ°
```

**ğŸ”¹ å¦‚ä½•å¹³è¡¡å®‰å…¨ä¸æ€§èƒ½ï¼Ÿ**
```
ç­–ç•¥é€‰æ‹©ï¼š
å†…éƒ¨æœåŠ¡ï¼šHS256 + çŸ­æœŸToken + ç»“æœç¼“å­˜
å¯¹å¤–APIï¼šRS256 + é•¿æœŸToken + Redisç¼“å­˜

ä¼˜åŒ–é‡ç‚¹ï¼š
â†’ ç¼“å­˜éªŒè¯ç»“æœï¼ˆæœ€æœ‰æ•ˆï¼‰
â†’ é€‰æ‹©åˆé€‚ç®—æ³•ï¼ˆå½±å“è¾ƒå¤§ï¼‰
â†’ å¤ç”¨è§£æå™¨å¯¹è±¡ï¼ˆé¿å…é‡å¤åˆ›å»ºï¼‰
```

**ğŸ”¹ å¸¸è§é”™è¯¯å¦‚ä½•å¤„ç†ï¼Ÿ**
```
é”™è¯¯åˆ†ç±»å¤„ç†ï¼š
SignatureException â†’ 401ï¼ŒTokenç¯¡æ”¹ï¼Œæ‹’ç»è®¿é—®
ExpiredJwtException â†’ 401ï¼ŒTokenè¿‡æœŸï¼Œæç¤ºåˆ·æ–°
MalformedJwtException â†’ 400ï¼Œæ ¼å¼é”™è¯¯ï¼Œæ£€æŸ¥è¯·æ±‚

ç”¨æˆ·ä½“éªŒä¼˜åŒ–ï¼š
â†’ æä¾›æ¸…æ™°çš„é”™è¯¯æç¤º
â†’ è‡ªåŠ¨è·³è½¬ç™»å½•é¡µ
â†’ æ”¯æŒTokenè‡ªåŠ¨åˆ·æ–°
```

### 9.3 å®æˆ˜æœ€ä½³å®è·µ


**âœ… éªŒè¯è§„èŒƒï¼š**
```
1. å§‹ç»ˆéªŒè¯ç­¾åï¼šé˜²æ­¢ç¯¡æ”¹
2. æ£€æŸ¥è¿‡æœŸæ—¶é—´ï¼šé¿å…æ—§Tokenä½¿ç”¨
3. éªŒè¯issuerå’Œaudienceï¼šç¡®ä¿Tokenæ¥æºåˆæ³•
4. ä½¿ç”¨ç™½åå•æœºåˆ¶ï¼šé™åˆ¶Tokenä½¿ç”¨èŒƒå›´
5. è®°å½•éªŒè¯æ—¥å¿—ï¼šä¾¿äºå®‰å…¨å®¡è®¡
```

**âœ… æ€§èƒ½ä¼˜åŒ–ï¼š**
```
1. å¯ç”¨ç»“æœç¼“å­˜ï¼šå‡å°‘é‡å¤éªŒè¯
2. é€‰æ‹©åˆé€‚ç®—æ³•ï¼šå¹³è¡¡å®‰å…¨ä¸é€Ÿåº¦
3. å¤ç”¨è§£æå™¨ï¼šé¿å…å¯¹è±¡åˆ›å»ºå¼€é”€
4. å¼‚æ­¥éªŒè¯ï¼šæé«˜å¹¶å‘å¤„ç†èƒ½åŠ›
```

**âœ… å®‰å…¨åŠ å›ºï¼š**
```
1. ä½¿ç”¨å¼ºå¯†é’¥ï¼šè‡³å°‘256ä½
2. å®šæœŸè½®æ¢å¯†é’¥ï¼šé™ä½æ³„éœ²é£é™©
3. æ·»åŠ jtiå­—æ®µï¼šé˜²æ­¢é‡æ”¾æ”»å‡»
4. é™åˆ¶Tokenæœ‰æ•ˆæœŸï¼šç¼©å°æ”»å‡»çª—å£
5. ç›‘æ§å¼‚å¸¸éªŒè¯ï¼šåŠæ—¶å‘ç°æ”»å‡»
```

### 9.4 å­¦ä¹ è·¯å¾„å»ºè®®


```
ğŸ“š å­¦ä¹ é˜¶æ®µè§„åˆ’ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬1å‘¨ï¼šç†è§£éªŒè¯åŸç†               â”‚
â”‚  â†’ JWTç»“æ„ã€ç­¾åæœºåˆ¶ã€éªŒè¯æµç¨‹    â”‚
â”‚                                  â”‚
â”‚ ç¬¬2å‘¨ï¼šæŒæ¡æ ¸å¿ƒéªŒè¯               â”‚
â”‚  â†’ ç­¾åæ ¡éªŒã€è¿‡æœŸæ£€æŸ¥ã€ClaimséªŒè¯ â”‚
â”‚                                  â”‚
â”‚ ç¬¬3å‘¨ï¼šå®æˆ˜åº”ç”¨                   â”‚
â”‚  â†’ é›†æˆåˆ°é¡¹ç›®ã€å¼‚å¸¸å¤„ç†ã€æ—¥å¿—è®°å½• â”‚
â”‚                                  â”‚
â”‚ ç¬¬4å‘¨ï¼šæ€§èƒ½ä¼˜åŒ–                   â”‚
â”‚  â†’ ç¼“å­˜ç­–ç•¥ã€ç®—æ³•é€‰æ‹©ã€å¹¶å‘ä¼˜åŒ–   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ’¡ æ ¸å¿ƒè®°å¿†å£è¯€ï¼š**
```
ç­¾åæ ¡éªŒé˜²ç¯¡æ”¹ï¼Œè¿‡æœŸæ£€æŸ¥ä¿æ—¶æ•ˆ
ClaimséªŒè¯ä¿åˆæ³•ï¼Œä¸‰é‡æœºåˆ¶ä¿å®‰å…¨
ç¼“å­˜ç»“æœææ€§èƒ½ï¼Œå¼‚å¸¸å¤„ç†è¦å‹å¥½
å¯†é’¥è½®æ¢é™é£é™©ï¼Œæ—¥å¿—ç›‘æ§ä¿å®¡è®¡
```

---

**ğŸ“š ç›¸å…³ç¬”è®°æ¨èï¼š**
- JWTä»¤ç‰Œç”Ÿæˆæœºåˆ¶
- OAuth2.0æˆæƒæµç¨‹
- å¾®æœåŠ¡å®‰å…¨æ¶æ„è®¾è®¡
- Tokenåˆ·æ–°ç­–ç•¥è¯¦è§£