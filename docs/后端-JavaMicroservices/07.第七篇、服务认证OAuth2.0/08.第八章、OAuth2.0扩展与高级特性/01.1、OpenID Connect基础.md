---
title: 1ã€OpenID ConnectåŸºç¡€
---
## ðŸ“š ç›®å½•

1. [OpenID Connectæ ¸å¿ƒæ¦‚å¿µ](#1-OpenID-Connectæ ¸å¿ƒæ¦‚å¿µ)
2. [OIDCä¸ŽOAuth2çš„å…³ç³»](#2-OIDCä¸ŽOAuth2çš„å…³ç³»)
3. [ID Tokenè¯¦è§£](#3-ID-Tokenè¯¦è§£)
4. [UserInfoç”¨æˆ·ä¿¡æ¯ç«¯ç‚¹](#4-UserInfoç”¨æˆ·ä¿¡æ¯ç«¯ç‚¹)
5. [æ ‡å‡†Claimsä½“ç³»](#5-æ ‡å‡†Claimsä½“ç³»)
6. [OIDCè®¤è¯æµç¨‹](#6-OIDCè®¤è¯æµç¨‹)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ðŸ” OpenID Connectæ ¸å¿ƒæ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯OpenID Connect


> **é€šä¿—ç†è§£**ï¼šæƒ³è±¡ä½ åŽ»ä¸€ä¸ªæ–°çš„å•†åœºï¼Œå•†åœºä¸ä»…è¦çŸ¥é“"ä½ èƒ½ä¸èƒ½è¿›"ï¼ˆæŽˆæƒï¼‰ï¼Œè¿˜è¦çŸ¥é“"ä½ æ˜¯è°"ï¼ˆèº«ä»½è®¤è¯ï¼‰ã€‚OAuth2.0åªè§£å†³äº†"ä½ èƒ½ä¸èƒ½è¿›"çš„é—®é¢˜ï¼Œè€ŒOpenID Connectåœ¨æ­¤åŸºç¡€ä¸Šå¢žåŠ äº†"ä½ æ˜¯è°"çš„åŠŸèƒ½ã€‚

**ðŸ”¸ OIDCæ˜¯ä»€ä¹ˆ**

OpenID Connectï¼ˆç®€ç§°OIDCï¼‰æ˜¯ä¸€ä¸ª**èº«ä»½è®¤è¯åè®®**ï¼Œå®ƒå»ºç«‹åœ¨OAuth2.0ä¹‹ä¸Šï¼Œä¸“é—¨ç”¨æ¥è§£å†³"ç”¨æˆ·æ˜¯è°"çš„é—®é¢˜ã€‚

```
ç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼š

OAuth2.0 = é—¨ç¦å¡
- åªå‘Šè¯‰ä½ ï¼šå¯ä»¥è¿›å…¥å¤§æ¥¼
- ä½†ä¸çŸ¥é“ï¼šä½ å…·ä½“æ˜¯è°

OpenID Connect = é—¨ç¦å¡ + èº«ä»½è¯
- å‘Šè¯‰ä½ ï¼šå¯ä»¥è¿›å…¥å¤§æ¥¼ï¼ˆæŽˆæƒï¼‰
- è¿˜å‘Šè¯‰ä½ ï¼šä½ æ˜¯å¼ ä¸‰ï¼Œå‘˜å·¥å·001ï¼ˆèº«ä»½ï¼‰
```

**ðŸŽ¯ ä¸ºä»€ä¹ˆéœ€è¦OIDC**

| **åœºæ™¯** | **OAuth2.0èƒ½åšä»€ä¹ˆ** | **OIDCé¢å¤–æä¾›ä»€ä¹ˆ** |
|---------|-------------------|-------------------|
| ç”¨æˆ·ç™»å½•ç½‘ç«™ | èŽ·å–è®¿é—®æƒé™ | èŽ·å–ç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼ˆå§“åã€é‚®ç®±ç­‰ï¼‰ |
| ç¬¬ä¸‰æ–¹åº”ç”¨ | è®¿é—®ç”¨æˆ·èµ„æº | çŸ¥é“å½“å‰ç™»å½•çš„æ˜¯å“ªä¸ªç”¨æˆ· |
| å•ç‚¹ç™»å½• | å…±äº«è®¿é—®ä»¤ç‰Œ | å…±äº«ç”¨æˆ·èº«ä»½ï¼Œä¸€æ¬¡ç™»å½•åˆ°å¤„è¯†åˆ« |

### 1.2 OIDCçš„æ ¸å¿ƒä½œç”¨


**ðŸ“‹ èº«ä»½å±‚ï¼ˆIdentity Layerï¼‰**

OIDCåœ¨OAuth2.0çš„åŸºç¡€ä¸Šå¢žåŠ äº†ä¸€ä¸ª"èº«ä»½å±‚"ï¼Œè¿™ä¸ªèº«ä»½å±‚ä¸»è¦åšä¸‰ä»¶äº‹ï¼š

```
èº«ä»½å±‚çš„ä¸‰å¤§åŠŸèƒ½ï¼š

1ï¸âƒ£ èº«ä»½è®¤è¯ï¼ˆAuthenticationï¼‰
   â†“ å›žç­”é—®é¢˜ï¼šè¿™ä¸ªäººæ˜¯è°ï¼Ÿ
   â†“ æä¾›ä¿¡æ¯ï¼šç”¨æˆ·IDã€å§“åã€é‚®ç®±ç­‰

2ï¸âƒ£ æ ‡å‡†åŒ–ç”¨æˆ·ä¿¡æ¯ï¼ˆStandardized User Infoï¼‰
   â†“ å›žç­”é—®é¢˜ï¼šç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯æœ‰å“ªäº›ï¼Ÿ
   â†“ æä¾›ä¿¡æ¯ï¼šç»Ÿä¸€çš„ç”¨æˆ·ä¿¡æ¯æ ¼å¼

3ï¸âƒ£ å®‰å…¨ä»¤ç‰Œï¼ˆID Tokenï¼‰
   â†“ å›žç­”é—®é¢˜ï¼šå¦‚ä½•å®‰å…¨ä¼ é€’ç”¨æˆ·èº«ä»½ï¼Ÿ
   â†“ æä¾›ä¿¡æ¯ï¼šç»è¿‡ç­¾åçš„èº«ä»½ä»¤ç‰Œ
```

**ðŸ’¡ è®¤è¯åè®®çš„æœ¬è´¨**

OIDCè¢«ç§°ä¸º"è®¤è¯åè®®"ï¼Œè€ŒOAuth2.0æ˜¯"æŽˆæƒåè®®"ï¼ŒåŒºåˆ«åœ¨äºŽï¼š

| **åè®®ç±»åž‹** | **ä¸»è¦ç›®çš„** | **æ ¸å¿ƒé—®é¢˜** | **å…¸åž‹è¾“å‡º** |
|------------|------------|------------|------------|
| **OAuth2.0æŽˆæƒ** | å…è®¸è®¿é—®èµ„æº | "ä½ èƒ½åšä»€ä¹ˆï¼Ÿ" | Access Tokenï¼ˆè®¿é—®ä»¤ç‰Œï¼‰ |
| **OIDCè®¤è¯** | ç¡®è®¤ç”¨æˆ·èº«ä»½ | "ä½ æ˜¯è°ï¼Ÿ" | ID Tokenï¼ˆèº«ä»½ä»¤ç‰Œï¼‰ |

---

## 2. ðŸ”— OIDCä¸ŽOAuth2çš„å…³ç³»


### 2.1 OIDCå¦‚ä½•æ‰©å±•OAuth2


> **å½¢è±¡æ¯”å–»**ï¼šå¦‚æžœOAuth2.0æ˜¯ä¸€è¾†æ±½è½¦çš„åº•ç›˜å’Œå¼•æ“Žï¼Œé‚£ä¹ˆOIDCå°±æ˜¯åœ¨è¿™ä¸ªåŸºç¡€ä¸ŠåŠ è£…äº†å¯¼èˆªç³»ç»Ÿå’Œæ™ºèƒ½åº§èˆ±ã€‚åº•ç›˜ä¾ç„¶æ˜¯OAuth2.0ï¼Œä½†åŠŸèƒ½æ›´å¼ºå¤§äº†ã€‚

**ðŸ—ï¸ OIDCçš„æž¶æž„å…³ç³»**

```
OpenID Connectæž¶æž„å›¾ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          OpenID Connect (èº«ä»½è®¤è¯å±‚)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â€¢ ID Tokenï¼ˆèº«ä»½ä»¤ç‰Œï¼‰                   â”‚  â”‚
â”‚  â”‚  â€¢ UserInfo Endpointï¼ˆç”¨æˆ·ä¿¡æ¯ç«¯ç‚¹ï¼‰      â”‚  â”‚
â”‚  â”‚  â€¢ Standard Claimsï¼ˆæ ‡å‡†å£°æ˜Žï¼‰            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          OAuth 2.0 (æŽˆæƒæ¡†æž¶)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â€¢ Authorization Codeï¼ˆæŽˆæƒç ï¼‰           â”‚  â”‚
â”‚  â”‚  â€¢ Access Tokenï¼ˆè®¿é—®ä»¤ç‰Œï¼‰               â”‚  â”‚
â”‚  â”‚  â€¢ Refresh Tokenï¼ˆåˆ·æ–°ä»¤ç‰Œï¼‰              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ðŸ”¸ OIDCæ˜¯OAuth2çš„æ‰©å±•**

OIDCå¹¶ä¸æ˜¯æ›¿ä»£OAuth2.0ï¼Œè€Œæ˜¯**åœ¨OAuth2.0åŸºç¡€ä¸Šå¢žåŠ åŠŸèƒ½**ï¼š

```
æ‰©å±•æ–¹å¼å¯¹æ¯”ï¼š

çº¯OAuth2.0æµç¨‹ï¼š
ç”¨æˆ· â†’ æŽˆæƒæœåŠ¡å™¨ â†’ è¿”å›žAccess Token â†’ è®¿é—®èµ„æº

OIDCæµç¨‹ï¼š
ç”¨æˆ· â†’ æŽˆæƒæœåŠ¡å™¨ â†’ è¿”å›žAccess Token + ID Token â†’ æ—¢èƒ½è®¿é—®èµ„æºåˆçŸ¥é“èº«ä»½
```

**ðŸ“Š å…³é”®åŒºåˆ«å¯¹æ¯”**

| **å¯¹æ¯”ç»´åº¦** | **OAuth2.0** | **OpenID Connect** |
|------------|-------------|-------------------|
| **æ ¸å¿ƒç›®æ ‡** | æŽˆæƒï¼ˆä½ èƒ½åšä»€ä¹ˆï¼‰ | è®¤è¯ï¼ˆä½ æ˜¯è°ï¼‰ |
| **ä¸»è¦ä»¤ç‰Œ** | Access Token | Access Token + ID Token |
| **ç”¨æˆ·ä¿¡æ¯** | éœ€è¦è‡ªå·±å®šä¹‰èŽ·å–æ–¹å¼ | æ ‡å‡†çš„UserInfoç«¯ç‚¹ |
| **é€‚ç”¨åœºæ™¯** | APIè®¿é—®æŽˆæƒ | ç”¨æˆ·ç™»å½•ã€å•ç‚¹ç™»å½• |
| **ä¿¡æ¯æ ¼å¼** | æ²¡æœ‰ç»Ÿä¸€æ ‡å‡† | æ ‡å‡†åŒ–çš„Claims |

### 2.2 èº«ä»½è®¤è¯çš„å¢žå¼º


**ðŸŽ¯ OIDCå¦‚ä½•å¢žå¼ºèº«ä»½è®¤è¯**

ä¼ ç»ŸOAuth2.0çš„é—®é¢˜ï¼š
```
é—®é¢˜åœºæ™¯ï¼š
1. ç”¨æˆ·é€šè¿‡å¾®ä¿¡ç™»å½•ä½ çš„ç½‘ç«™
2. OAuth2.0è¿”å›žäº†Access Token
3. ä½ çš„ç½‘ç«™èƒ½è®¿é—®ç”¨æˆ·çš„å¾®ä¿¡èµ„æ–™äº†
4. ä½†æ˜¯ï¼šä½ è¿˜è¦è‡ªå·±è°ƒç”¨å¾®ä¿¡APIåŽ»æŸ¥ç”¨æˆ·æ˜¯è°

ç¼ºç‚¹ï¼š
âŒ æ¯ä¸ªå¹³å°çš„ç”¨æˆ·ä¿¡æ¯æŽ¥å£ä¸ä¸€æ ·
âŒ è¿”å›žçš„æ•°æ®æ ¼å¼ä¸ç»Ÿä¸€
âŒ éœ€è¦é¢å¤–çš„HTTPè¯·æ±‚
âŒ æ²¡æœ‰æ ‡å‡†åŒ–çš„èº«ä»½éªŒè¯æµç¨‹
```

OIDCçš„è§£å†³æ–¹æ¡ˆï¼š
```
OIDCæ”¹è¿›ï¼š
1. ç”¨æˆ·é€šè¿‡OIDCç™»å½•
2. ç›´æŽ¥è¿”å›žAccess Token + ID Token
3. ID Tokené‡Œå·²ç»åŒ…å«äº†ç”¨æˆ·èº«ä»½ä¿¡æ¯
4. ä¸éœ€è¦é¢å¤–è¯·æ±‚ï¼Œç›´æŽ¥è§£æžID Tokenå°±çŸ¥é“ç”¨æˆ·æ˜¯è°

ä¼˜ç‚¹ï¼š
âœ… æ ‡å‡†åŒ–çš„èº«ä»½ä¿¡æ¯æ ¼å¼
âœ… ä¸€æ¬¡è¯·æ±‚èŽ·å–æ‰€æœ‰ä¿¡æ¯
âœ… å†…ç½®å®‰å…¨éªŒè¯æœºåˆ¶
âœ… è·¨å¹³å°ç»Ÿä¸€çš„è®¤è¯æµç¨‹
```

---

## 3. ðŸŽ« ID Tokenè¯¦è§£


### 3.1 ID Tokenæ˜¯ä»€ä¹ˆ


> **ç”Ÿæ´»åŒ–ç†è§£**ï¼šID Tokenå°±åƒä½ çš„"æ•°å­—èº«ä»½è¯"ï¼Œå®ƒä¸ä»…è¯æ˜Žäº†ä½ çš„èº«ä»½ï¼Œè¿˜æºå¸¦äº†ä½ çš„åŸºæœ¬ä¿¡æ¯ï¼Œè€Œä¸”è¿˜æœ‰é˜²ä¼ªæ ‡è®°ï¼ˆç­¾åï¼‰é˜²æ­¢è¢«ä¼ªé€ ã€‚

**ðŸ”¸ ID Tokençš„æœ¬è´¨**

ID Tokenæ˜¯ä¸€ä¸ª**JWTæ ¼å¼çš„ä»¤ç‰Œ**ï¼Œä¸“é—¨ç”¨æ¥ä¼ é€’ç”¨æˆ·çš„èº«ä»½ä¿¡æ¯ã€‚

```
ID Tokençš„ç»„æˆç»“æž„ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            ID Token (JWT)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Header    â”‚   Payload   â”‚  Signature   â”‚
â”‚  (å¤´éƒ¨ä¿¡æ¯)  â”‚  (èº«ä»½ä¿¡æ¯)  â”‚   (ç­¾å)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ ç®—æ³•ç±»åž‹   â”‚ â€¢ ç”¨æˆ·ID     â”‚ â€¢ é˜²ç¯¡æ”¹éªŒè¯ â”‚
â”‚ â€¢ ä»¤ç‰Œç±»åž‹   â”‚ â€¢ å§“å       â”‚ â€¢ æœåŠ¡å™¨ç­¾å â”‚
â”‚             â”‚ â€¢ é‚®ç®±       â”‚              â”‚
â”‚             â”‚ â€¢ è¿‡æœŸæ—¶é—´   â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ðŸ’¡ ä¸ºä»€ä¹ˆç”¨JWTæ ¼å¼**

JWTï¼ˆJSON Web Tokenï¼‰éžå¸¸é€‚åˆåšID Tokenï¼Œå› ä¸ºï¼š

| **JWTç‰¹æ€§** | **å¯¹ID Tokençš„å¥½å¤„** |
|-----------|-------------------|
| **è‡ªåŒ…å«** | ä»¤ç‰Œæœ¬èº«åŒ…å«æ‰€æœ‰ä¿¡æ¯ï¼Œæ— éœ€æŸ¥æ•°æ®åº“ |
| **å¯éªŒè¯** | é€šè¿‡ç­¾åé˜²æ­¢ä¼ªé€ å’Œç¯¡æ”¹ |
| **è·¨å¹³å°** | JSONæ ¼å¼ï¼Œä»»ä½•è¯­è¨€éƒ½èƒ½è§£æž |
| **æ˜“ä¼ è¾“** | Base64ç¼–ç ï¼Œå¯ä»¥æ”¾åœ¨HTTPå¤´ä¸­ |

### 3.2 ID Tokençš„å†…å®¹


**ðŸ“‹ æ ‡å‡†ID Tokenç¤ºä¾‹**

```json
{
  "iss": "https://auth.example.com",     // ç­¾å‘è€…
  "sub": "user123",                       // ç”¨æˆ·å”¯ä¸€æ ‡è¯†
  "aud": "my-client-app",                 // æŽ¥æ”¶è€…ï¼ˆå®¢æˆ·ç«¯IDï¼‰
  "exp": 1735689600,                      // è¿‡æœŸæ—¶é—´
  "iat": 1735686000,                      // ç­¾å‘æ—¶é—´
  "name": "å¼ ä¸‰",                         // ç”¨æˆ·å§“å
  "email": "zhangsan@example.com",       // é‚®ç®±
  "email_verified": true,                 // é‚®ç®±æ˜¯å¦éªŒè¯
  "picture": "https://example.com/avatar.jpg"  // å¤´åƒ
}
```

**ðŸ” å­—æ®µå«ä¹‰è§£é‡Š**

| **å­—æ®µå** | **ä¸­æ–‡å«ä¹‰** | **é€šä¿—è§£é‡Š** | **å¿…éœ€æ€§** |
|----------|------------|------------|----------|
| `iss` | ç­¾å‘è€… | è°é¢å‘çš„è¿™ä¸ªèº«ä»½è¯ | âœ…å¿…éœ€ |
| `sub` | ä¸»é¢˜ï¼ˆç”¨æˆ·IDï¼‰ | è¿™ä¸ªèº«ä»½è¯æ˜¯è°çš„ | âœ…å¿…éœ€ |
| `aud` | å—ä¼—ï¼ˆå®¢æˆ·ç«¯ï¼‰ | è¿™ä¸ªèº«ä»½è¯ç»™è°çœ‹çš„ | âœ…å¿…éœ€ |
| `exp` | è¿‡æœŸæ—¶é—´ | èº«ä»½è¯çš„æœ‰æ•ˆæœŸ | âœ…å¿…éœ€ |
| `iat` | ç­¾å‘æ—¶é—´ | ä»€ä¹ˆæ—¶å€™é¢å‘çš„ | âœ…å¿…éœ€ |
| `name` | å§“å | ç”¨æˆ·çš„çœŸå®žå§“å | å¯é€‰ |
| `email` | é‚®ç®± | ç”¨æˆ·çš„ç”µå­é‚®ç®± | å¯é€‰ |

### 3.3 å¦‚ä½•ä½¿ç”¨ID Token


**ðŸ”§ éªŒè¯å’Œè§£æžæµç¨‹**

```
ID Tokenä½¿ç”¨æµç¨‹ï¼š

æ­¥éª¤1ï¼šæŽ¥æ”¶ID Token
å®¢æˆ·ç«¯ â† æŽˆæƒæœåŠ¡å™¨å‘é€ID Token

æ­¥éª¤2ï¼šéªŒè¯ç­¾å
æ£€æŸ¥ç­¾å â†’ ç¡®è®¤Tokenæœªè¢«ç¯¡æ”¹

æ­¥éª¤3ï¼šéªŒè¯å£°æ˜Ž
- æ£€æŸ¥expï¼ˆæ˜¯å¦è¿‡æœŸï¼‰
- æ£€æŸ¥audï¼ˆæ˜¯å¦æ˜¯å‘ç»™æˆ‘çš„ï¼‰
- æ£€æŸ¥issï¼ˆæ˜¯å¦æ¥è‡ªå¯ä¿¡çš„æŽˆæƒæœåŠ¡å™¨ï¼‰

æ­¥éª¤4ï¼šæå–ç”¨æˆ·ä¿¡æ¯
è§£æžPayload â†’ èŽ·å–ç”¨æˆ·IDã€å§“åã€é‚®ç®±ç­‰

æ­¥éª¤5ï¼šå»ºç«‹ä¼šè¯
æ ¹æ®ç”¨æˆ·ä¿¡æ¯åˆ›å»ºæœ¬åœ°ä¼šè¯
```

**ç®€åŒ–ä»£ç ç¤ºä¾‹**

```java
// éªŒè¯å’Œè§£æžID Token
public UserInfo parseIdToken(String idToken) {
    // 1. éªŒè¯ç­¾åï¼ˆä½¿ç”¨æŽˆæƒæœåŠ¡å™¨çš„å…¬é’¥ï¼‰
    if (!verifySignature(idToken)) {
        throw new SecurityException("ID Tokenç­¾åæ— æ•ˆ");
    }
    
    // 2. è§£æžJWT
    Claims claims = parseJWT(idToken);
    
    // 3. éªŒè¯æ—¶æ•ˆæ€§
    if (claims.getExpiration().before(new Date())) {
        throw new TokenExpiredException("ID Tokenå·²è¿‡æœŸ");
    }
    
    // 4. æå–ç”¨æˆ·ä¿¡æ¯
    UserInfo user = new UserInfo();
    user.setUserId(claims.getSubject());
    user.setName(claims.get("name", String.class));
    user.setEmail(claims.get("email", String.class));
    
    return user;
}
```

---

## 4. ðŸ‘¤ UserInfoç”¨æˆ·ä¿¡æ¯ç«¯ç‚¹


### 4.1 UserInfoç«¯ç‚¹çš„ä½œç”¨


> **ç±»æ¯”ç†è§£**ï¼šID Tokenå°±åƒèº«ä»½è¯ï¼Œä¸Šé¢æœ‰åŸºæœ¬ä¿¡æ¯ã€‚è€ŒUserInfoç«¯ç‚¹å°±åƒæˆ·ç±æ¡£æ¡ˆï¼Œèƒ½æŸ¥åˆ°æ›´è¯¦ç»†çš„ä¿¡æ¯ã€‚

**ðŸ”¸ ä¸ºä»€ä¹ˆéœ€è¦UserInfoç«¯ç‚¹**

è™½ç„¶ID Tokenå·²ç»åŒ…å«äº†ç”¨æˆ·ä¿¡æ¯ï¼Œä½†æœ‰æ—¶å€™è¿˜éœ€è¦UserInfoç«¯ç‚¹ï¼ŒåŽŸå› æ˜¯ï¼š

| **åœºæ™¯** | **ID Tokençš„é™åˆ¶** | **UserInfoç«¯ç‚¹çš„ä¼˜åŠ¿** |
|---------|------------------|---------------------|
| **ä¿¡æ¯é‡å¤§** | Tokenå¤ªå¤§ä¼šå½±å“ä¼ è¾“ | æŒ‰éœ€èŽ·å–ï¼Œä¸é™å¤§å° |
| **å®žæ—¶æ€§** | Tokenæœ‰ç¼“å­˜æœŸ | æ€»æ˜¯è¿”å›žæœ€æ–°ä¿¡æ¯ |
| **æ•æ„Ÿä¿¡æ¯** | ä¸é€‚åˆæ”¾åœ¨Tokenä¸­ | é€šè¿‡APIå®‰å…¨ä¼ è¾“ |

**ðŸ“ UserInfoç«¯ç‚¹æ˜¯ä»€ä¹ˆ**

UserInfoæ˜¯ä¸€ä¸ª**æ ‡å‡†çš„HTTPæŽ¥å£**ï¼Œå®¢æˆ·ç«¯æ‹¿ç€Access TokenåŽ»è¯·æ±‚ï¼Œå°±èƒ½èŽ·å–ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ã€‚

```
UserInfoè¯·æ±‚æµç¨‹ï¼š

å®¢æˆ·ç«¯                           æŽˆæƒæœåŠ¡å™¨
  |                                  |
  |--[1] GET /userinfo------------->|
  |    Header: Authorization: Bearer |
  |           <access_token>         |
  |                                  |
  |<-[2] è¿”å›žç”¨æˆ·ä¿¡æ¯----------------|
  |    { "sub": "user123",          |
  |      "name": "å¼ ä¸‰",             |
  |      "email": "..." }            |
```

### 4.2 å¦‚ä½•è°ƒç”¨UserInfo


**ðŸ”§ æ ‡å‡†è°ƒç”¨æ–¹å¼**

UserInfoç«¯ç‚¹çš„è°ƒç”¨éžå¸¸ç®€å•ï¼Œå°±æ˜¯ä¸€ä¸ªæ™®é€šçš„HTTP GETè¯·æ±‚ï¼š

```http
GET /userinfo HTTP/1.1
Host: auth.example.com
Authorization: Bearer ya29.a0AfH6SMBx...
```

**å“åº”ç¤ºä¾‹**

```json
{
  "sub": "user123",
  "name": "å¼ ä¸‰",
  "given_name": "ä¸‰",
  "family_name": "å¼ ",
  "email": "zhangsan@example.com",
  "email_verified": true,
  "picture": "https://example.com/avatar.jpg",
  "locale": "zh-CN"
}
```

**ðŸ’¡ ä¸ŽID Tokençš„é…åˆä½¿ç”¨**

```
ç»„åˆä½¿ç”¨ç­–ç•¥ï¼š

åœºæ™¯1ï¼šå¿«é€Ÿç™»å½•
â†’ åªç”¨ID Token
â†’ è§£æžTokenèŽ·å–åŸºæœ¬ä¿¡æ¯ï¼ˆç”¨æˆ·IDã€å§“åï¼‰
â†’ ä¸éœ€è¦é¢å¤–è¯·æ±‚

åœºæ™¯2ï¼šå®Œæ•´èµ„æ–™
â†’ ID Token + UserInfo
â†’ ID TokenèŽ·å–åŸºæœ¬èº«ä»½
â†’ å†è°ƒç”¨UserInfoèŽ·å–è¯¦ç»†èµ„æ–™

åœºæ™¯3ï¼šå®žæ—¶æ›´æ–°
â†’ å®šæœŸè°ƒç”¨UserInfo
â†’ èŽ·å–æœ€æ–°çš„ç”¨æˆ·çŠ¶æ€ï¼ˆå¦‚é‚®ç®±éªŒè¯çŠ¶æ€ï¼‰
```

---

## 5. ðŸ“ æ ‡å‡†Claimsä½“ç³»


### 5.1 ä»€ä¹ˆæ˜¯Claims


> **é€šä¿—è§£é‡Š**ï¼šClaimså°±æ˜¯"å£°æ˜Ž"æˆ–"æ–­è¨€"ï¼Œå¯ä»¥ç†è§£ä¸º"ç”¨æˆ·ä¿¡æ¯çš„å­—æ®µ"ã€‚æ¯”å¦‚å£°æ˜Ž"è¿™ä¸ªç”¨æˆ·çš„åå­—æ˜¯å¼ ä¸‰"ï¼Œ"è¿™ä¸ªç”¨æˆ·çš„é‚®ç®±æ˜¯xxx"ã€‚

**ðŸ”¸ Claimsçš„æœ¬è´¨**

Claimsæ˜¯ä¸€ç»„**é”®å€¼å¯¹**ï¼Œç”¨æ¥æè¿°ç”¨æˆ·çš„å„ç§å±žæ€§å’Œä¿¡æ¯ã€‚

```
Claimså°±åƒå¡«è¡¨ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ç”¨æˆ·ä¿¡æ¯ç™»è®°è¡¨          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å§“å(name):    å¼ ä¸‰         â”‚
â”‚ é‚®ç®±(email):   xxx@xx.com  â”‚
â”‚ ç”Ÿæ—¥(birthday): 1990-01-01 â”‚
â”‚ æ€§åˆ«(gender):  male        â”‚
â”‚ ç”µè¯(phone):   138xxxx     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ¯ä¸€è¡Œå°±æ˜¯ä¸€ä¸ªClaim
```

### 5.2 OIDCæ ‡å‡†Claimsåˆ†ç±»


**ðŸ“‹ Claimsçš„ä¸‰ä¸ªçº§åˆ«**

OIDCå®šä¹‰äº†ä¸‰ç±»æ ‡å‡†Claimsï¼š

| **Claimsç±»åž‹** | **åŒ…å«èŒƒå›´** | **ä½¿ç”¨åœºæ™¯** |
|--------------|------------|------------|
| **1ï¸âƒ£ åŸºç¡€Claims** | å¿…éœ€çš„æ ¸å¿ƒä¿¡æ¯ | æ‰€æœ‰OIDCå®žçŽ°éƒ½å¿…é¡»æ”¯æŒ |
| **2ï¸âƒ£ æ ‡å‡†Claims** | å¸¸ç”¨çš„ç”¨æˆ·å±žæ€§ | å¯é€‰ï¼Œä½†æ ¼å¼ç»Ÿä¸€ |
| **3ï¸âƒ£ è‡ªå®šä¹‰Claims** | ä¸šåŠ¡ç‰¹å®šä¿¡æ¯ | å„åº”ç”¨è‡ªå·±å®šä¹‰ |

**ðŸ”¸ åŸºç¡€Claimsï¼ˆå¿…éœ€ï¼‰**

```
5ä¸ªæ ¸å¿ƒClaimsï¼š

iss (Issuer)          â†’ ä»¤ç‰Œç­¾å‘è€…
sub (Subject)         â†’ ç”¨æˆ·å”¯ä¸€æ ‡è¯†
aud (Audience)        â†’ ä»¤ç‰ŒæŽ¥æ”¶è€…
exp (Expiration Time) â†’ è¿‡æœŸæ—¶é—´
iat (Issued At)       â†’ ç­¾å‘æ—¶é—´
```

**ðŸ”¸ æ ‡å‡†ç”¨æˆ·ä¿¡æ¯Claims**

OIDCå®šä¹‰äº†ä¸€å¥—æ ‡å‡†çš„ç”¨æˆ·ä¿¡æ¯å­—æ®µï¼š

| **Claimåç§°** | **ä¸­æ–‡å«ä¹‰** | **ç¤ºä¾‹å€¼** | **è¯´æ˜Ž** |
|--------------|------------|-----------|---------|
| `name` | å…¨å | "å¼ ä¸‰" | å®Œæ•´å§“å |
| `given_name` | å | "ä¸‰" | åå­— |
| `family_name` | å§“ | "å¼ " | å§“æ° |
| `email` | é‚®ç®± | "zhangsan@example.com" | ç”µå­é‚®ç®± |
| `email_verified` | é‚®ç®±å·²éªŒè¯ | true | é‚®ç®±æ˜¯å¦éªŒè¯è¿‡ |
| `phone_number` | ç”µè¯ | "+86-138-0000-0000" | æ‰‹æœºå· |
| `picture` | å¤´åƒ | "https://..." | ç”¨æˆ·å¤´åƒURL |
| `locale` | è¯­è¨€ | "zh-CN" | é¦–é€‰è¯­è¨€ |
| `gender` | æ€§åˆ« | "male" | æ€§åˆ« |
| `birthdate` | ç”Ÿæ—¥ | "1990-01-01" | å‡ºç”Ÿæ—¥æœŸ |

### 5.3 Claimsçš„æ ‡å‡†åŒ–æ„ä¹‰


**ðŸŽ¯ ä¸ºä»€ä¹ˆè¦æ ‡å‡†åŒ–**

```
æ²¡æœ‰æ ‡å‡†åŒ–çš„é—®é¢˜ï¼š

å¾®ä¿¡è¿”å›žï¼š{ "nickname": "å¼ ä¸‰" }
QQè¿”å›žï¼š  { "name": "å¼ ä¸‰" }
å¾®åšè¿”å›žï¼š{ "screen_name": "å¼ ä¸‰" }

å¼€å‘è€…ï¼šðŸ˜« æ¯ä¸ªå¹³å°éƒ½è¦å†™ä¸åŒçš„ä»£ç ï¼

æœ‰äº†OIDCæ ‡å‡†ï¼š

å¾®ä¿¡ï¼š{ "name": "å¼ ä¸‰" }
QQï¼š  { "name": "å¼ ä¸‰" }
å¾®åšï¼š{ "name": "å¼ ä¸‰" }

å¼€å‘è€…ï¼šðŸ˜Š ä¸€å¥—ä»£ç å¤„ç†æ‰€æœ‰å¹³å°ï¼
```

**ðŸ’¡ æ ‡å‡†åŒ–çš„å¥½å¤„**

| **å¥½å¤„** | **å…·ä½“ä½“çŽ°** |
|---------|------------|
| **äº’æ“ä½œæ€§** | ä¸åŒOIDCæä¾›å•†ä¹‹é—´å¯ä»¥æ— ç¼åˆ‡æ¢ |
| **å¼€å‘æ•ˆçŽ‡** | ä¸€å¥—ä»£ç é€‚é…æ‰€æœ‰OIDCæœåŠ¡ |
| **é™ä½Žæˆæœ¬** | ä¸éœ€è¦ä¸ºæ¯ä¸ªå¹³å°å•ç‹¬é€‚é… |
| **æ˜“äºŽç»´æŠ¤** | ç»Ÿä¸€çš„æ•°æ®æ ¼å¼ï¼Œç»´æŠ¤ç®€å• |

---

## 6. ðŸ”„ OIDCè®¤è¯æµç¨‹


### 6.1 å®Œæ•´è®¤è¯æµç¨‹


**ðŸ“Š OIDCæŽˆæƒç æµç¨‹**

```
OIDCå®Œæ•´è®¤è¯æµç¨‹å›¾ï¼š

ç”¨æˆ·              å®¢æˆ·ç«¯åº”ç”¨          æŽˆæƒæœåŠ¡å™¨         èµ„æºæœåŠ¡å™¨
 |                   |                    |                  |
 |--[1]ç‚¹å‡»ç™»å½•------>|                    |                  |
 |                   |                    |                  |
 |<--[2]é‡å®šå‘åˆ°-----|                    |                  |
 |   æŽˆæƒé¡µé¢        |                    |                  |
 |                   |                    |                  |
 |------[3]è¾“å…¥è´¦å·å¯†ç ---------------->|                  |
 |                   |                    |                  |
 |<-----[4]è¿”å›žæŽˆæƒç --------------------|                  |
 |   (redirect_uri?code=xxx)             |                  |
 |                   |                    |                  |
 |--[5]æäº¤æŽˆæƒç ---->|                    |                  |
 |                   |                    |                  |
 |                   |--[6]ç”¨codeæ¢token->|                  |
 |                   |                    |                  |
 |                   |<-[7]è¿”å›žtokens-----|                  |
 |                   |  â€¢ Access Token    |                  |
 |                   |  â€¢ ID Token        |                  |
 |                   |  â€¢ Refresh Token   |                  |
 |                   |                    |                  |
 |                   |--[8]ç”¨Access Tokenè®¿é—®------------->|
 |                   |                    |                  |
 |                   |<-[9]è¿”å›žç”¨æˆ·èµ„æº-------------------|
 |                   |                    |                  |
 |<--[10]ç™»å½•æˆåŠŸ-----|                    |                  |
```

### 6.2 å…³é”®æ­¥éª¤è¯¦è§£


**ðŸ”¸ æ­¥éª¤6ï¼šæ¢å–ä»¤ç‰Œçš„è¯·æ±‚**

è¿™æ˜¯OIDCå’ŒOAuth2.0æœ€å¤§çš„ä¸åŒç‚¹ï¼ŒOIDCä¼š**åŒæ—¶è¿”å›žä¸‰ç§ä»¤ç‰Œ**ï¼š

```http
POST /token HTTP/1.1
Host: auth.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code
&code=SplxlOBeZQQYbYS6WxSbIA
&redirect_uri=https://client.example.com/callback
&client_id=my_client_id
&client_secret=my_client_secret
```

**å“åº”å†…å®¹**

```json
{
  "access_token": "SlAV32hkKG",
  "token_type": "Bearer",
  "expires_in": 3600,
  "refresh_token": "8xLOxBtZp8",
  "id_token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

**ðŸ’¡ ä¸‰ç§ä»¤ç‰Œçš„ç”¨é€”**

| **ä»¤ç‰Œç±»åž‹** | **ä¸»è¦ç”¨é€”** | **ä½¿ç”¨æ–¹å¼** |
|------------|------------|------------|
| **Access Token** | è®¿é—®èµ„æºæœåŠ¡å™¨ | æ”¾åœ¨HTTP Authorizationå¤´ |
| **ID Token** | èŽ·å–ç”¨æˆ·èº«ä»½ | è§£æžJWTèŽ·å–ç”¨æˆ·ä¿¡æ¯ |
| **Refresh Token** | åˆ·æ–°Access Token | å½“Access Tokenè¿‡æœŸæ—¶ä½¿ç”¨ |

### 6.3 Scopeä½œç”¨åŸŸ


**ðŸ”¸ OIDCç‰¹æ®Šçš„Scope**

OIDCå¼•å…¥äº†ä¸€ä¸ªç‰¹æ®Šçš„scopeï¼š`openid`

```
Scopeçš„ä½œç”¨ï¼š

æ™®é€šOAuth2ï¼š
scope=read write
â†’ åªèƒ½èŽ·å–Access Token

OIDCè®¤è¯ï¼š
scope=openid profile email
â†’ èŽ·å–Access Token + ID Token
â†’ ID TokenåŒ…å«profileå’Œemailä¿¡æ¯
```

**ðŸ“‹ æ ‡å‡†Scopeè¯´æ˜Ž**

| **Scope** | **åŒ…å«çš„Claims** | **é€šä¿—è§£é‡Š** |
|----------|-----------------|------------|
| `openid` | sub | **å¿…éœ€**ï¼Œè¡¨ç¤ºä½¿ç”¨OIDC |
| `profile` | name, family_name, given_name, pictureç­‰ | ç”¨æˆ·åŸºæœ¬èµ„æ–™ |
| `email` | email, email_verified | é‚®ç®±ä¿¡æ¯ |
| `address` | address | åœ°å€ä¿¡æ¯ |
| `phone` | phone_number, phone_number_verified | ç”µè¯ä¿¡æ¯ |

**ä½¿ç”¨ç¤ºä¾‹**

```
æŽˆæƒè¯·æ±‚URLï¼š
https://auth.example.com/authorize
  ?response_type=code
  &client_id=my_client
  &redirect_uri=https://client.com/callback
  &scope=openid profile email    â† è¯·æ±‚ç”¨æˆ·èµ„æ–™å’Œé‚®ç®±
  &state=xyz

è¿”å›žçš„ID Tokenä¼šåŒ…å«ï¼š
{
  "sub": "user123",              // openid scope
  "name": "å¼ ä¸‰",                // profile scope
  "picture": "https://...",      // profile scope
  "email": "zhangsan@xx.com",   // email scope
  "email_verified": true         // email scope
}
```

---

## 7. ðŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŽŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ðŸ”¸ OIDCæœ¬è´¨ï¼šåœ¨OAuth2.0ä¹‹ä¸Šå¢žåŠ èº«ä»½è®¤è¯å±‚
ðŸ”¸ æ ¸å¿ƒä»·å€¼ï¼šæ ‡å‡†åŒ–çš„ç”¨æˆ·èº«ä»½è®¤è¯å’Œä¿¡æ¯èŽ·å–
ðŸ”¸ ID Tokenï¼šæºå¸¦ç”¨æˆ·èº«ä»½ä¿¡æ¯çš„JWTä»¤ç‰Œ
ðŸ”¸ UserInfoï¼šèŽ·å–è¯¦ç»†ç”¨æˆ·ä¿¡æ¯çš„æ ‡å‡†ç«¯ç‚¹
ðŸ”¸ æ ‡å‡†Claimsï¼šç»Ÿä¸€çš„ç”¨æˆ·ä¿¡æ¯å­—æ®µå®šä¹‰
ðŸ”¸ è®¤è¯æµç¨‹ï¼šæŽˆæƒç æµç¨‹+è¿”å›žID Token
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ðŸ”¹ OIDCä¸ŽOAuth2çš„å…³ç³»**

```
å½¢è±¡è®°å¿†ï¼š

OAuth2.0 = æ±½è½¦åº•ç›˜
â†’ æä¾›åŸºç¡€çš„æŽˆæƒèƒ½åŠ›

OIDC = æ±½è½¦åº•ç›˜ + æ™ºèƒ½ç³»ç»Ÿ
â†’ ä¸ä»…èƒ½æŽˆæƒï¼Œè¿˜èƒ½è¯†åˆ«ç”¨æˆ·èº«ä»½
â†’ ä¸æ˜¯æ›¿ä»£ï¼Œè€Œæ˜¯å¢žå¼º
```

**ðŸ”¹ ID Tokençš„ä»·å€¼**

```
ä¸ºä»€ä¹ˆID Tokenå¾ˆé‡è¦ï¼š

ä¼ ç»Ÿæ–¹å¼ï¼š
èŽ·å–Access Token â†’ è°ƒç”¨ç”¨æˆ·ä¿¡æ¯API â†’ è§£æžå“åº” â†’ èŽ·å¾—ç”¨æˆ·ä¿¡æ¯
ï¼ˆéœ€è¦é¢å¤–çš„ç½‘ç»œè¯·æ±‚ï¼‰

OIDCæ–¹å¼ï¼š
èŽ·å–ID Token â†’ ç›´æŽ¥è§£æžJWT â†’ ç«‹å³èŽ·å¾—ç”¨æˆ·ä¿¡æ¯
ï¼ˆé›¶å»¶è¿Ÿï¼Œç¦»çº¿éªŒè¯ï¼‰
```

**ðŸ”¹ æ ‡å‡†Claimsçš„æ„ä¹‰**

```
ç»Ÿä¸€æ ‡å‡†çš„å¥½å¤„ï¼š

å¼€å‘ä¸€æ¬¡ï¼Œåˆ°å¤„è¿è¡Œ
- Googleç™»å½•ï¼šèŽ·å–name
- GitHubç™»å½•ï¼šèŽ·å–name
- å¾®ä¿¡ç™»å½•ï¼šèŽ·å–name

åŒæ ·çš„å­—æ®µåï¼ŒåŒæ ·çš„å¤„ç†é€»è¾‘ï¼
```

### 7.3 å®žé™…åº”ç”¨åœºæ™¯


**ðŸ’¼ å…¸åž‹ä½¿ç”¨åœºæ™¯**

| **åœºæ™¯** | **å¦‚ä½•ä½¿ç”¨OIDC** | **æ ¸å¿ƒä¼˜åŠ¿** |
|---------|---------------|------------|
| **å•ç‚¹ç™»å½•(SSO)** | å¤šä¸ªåº”ç”¨å…±äº«ID Token | ä¸€æ¬¡ç™»å½•ï¼Œåˆ°å¤„è®¿é—® |
| **ç¬¬ä¸‰æ–¹ç™»å½•** | ä½¿ç”¨Google/GitHubç­‰OIDCç™»å½• | æ ‡å‡†åŒ–æŽ¥å…¥ |
| **ç§»åŠ¨åº”ç”¨** | åŽŸç”Ÿåº”ç”¨ä½¿ç”¨OIDCè®¤è¯ | å®‰å…¨çš„èº«ä»½éªŒè¯ |
| **å¾®æœåŠ¡** | æœåŠ¡é—´ä¼ é€’ID Token | ç»Ÿä¸€çš„èº«ä»½è¯†åˆ« |

**ðŸŽ¯ é€‰æ‹©OIDCçš„æ—¶æœº**

```
ä½•æ—¶ä½¿ç”¨OIDCï¼š

âœ… éœ€è¦çŸ¥é“ç”¨æˆ·æ˜¯è°
âœ… éœ€è¦èŽ·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
âœ… éœ€è¦å®žçŽ°å•ç‚¹ç™»å½•
âœ… éœ€è¦æ ‡å‡†åŒ–çš„è®¤è¯æµç¨‹

ä½•æ—¶åªç”¨OAuth2ï¼š

âœ… åªéœ€è¦è®¿é—®èµ„æºï¼Œä¸å…³å¿ƒç”¨æˆ·èº«ä»½
âœ… æœºå™¨å¯¹æœºå™¨çš„æŽˆæƒï¼ˆClient Credentialsï¼‰
âœ… çº¯APIè®¿é—®æŽˆæƒ
```

**ðŸ”§ é›†æˆå»ºè®®**

```
OIDCé›†æˆæœ€ä½³å®žè·µï¼š

1. å§‹ç»ˆéªŒè¯ID Tokenç­¾å
   â†’ é˜²æ­¢ä¼ªé€ 

2. æ£€æŸ¥Tokençš„audå’Œiss
   â†’ ç¡®ä¿Tokenæ˜¯å‘ç»™ä½ çš„

3. ç¼“å­˜ID Tokenä¸­çš„ç”¨æˆ·ä¿¡æ¯
   â†’ å‡å°‘UserInfoè°ƒç”¨

4. å®šæœŸåˆ·æ–°ç”¨æˆ·ä¿¡æ¯
   â†’ ä¿æŒæ•°æ®æœ€æ–°

5. ä½¿ç”¨æ ‡å‡†åº“
   â†’ ä¸è¦è‡ªå·±å®žçŽ°JWTéªŒè¯
```

### 7.4 å¸¸è§é—®é¢˜è§£ç­”


**â“ ID Tokenå’ŒAccess Tokenå¿…é¡»ä¸€èµ·ç”¨å—ï¼Ÿ**

```
ç­”ï¼šä¸ä¸€å®š

åœºæ™¯1ï¼šåªéœ€è¦èº«ä»½è®¤è¯
â†’ åªç”¨ID Token
â†’ ä¾‹å¦‚ï¼šç”¨æˆ·ç™»å½•ä½ çš„ç½‘ç«™

åœºæ™¯2ï¼šéœ€è¦è®¿é—®èµ„æº
â†’ åªç”¨Access Token
â†’ ä¾‹å¦‚ï¼šè®¿é—®ç”¨æˆ·çš„ç…§ç‰‡

åœºæ™¯3ï¼šæ—¢è¦è®¤è¯åˆè¦è®¿é—®èµ„æº
â†’ ä¸¤ä¸ªéƒ½ç”¨
â†’ ä¾‹å¦‚ï¼šç™»å½•åŽå±•ç¤ºç”¨æˆ·ç›¸å†Œ
```

**â“ UserInfoç«¯ç‚¹å¿…é¡»è°ƒç”¨å—ï¼Ÿ**

```
ç­”ï¼šä¸ä¸€å®š

ID Tokenå¤Ÿç”¨å°±ä¸è°ƒç”¨ï¼š
- ID TokenåŒ…å«äº†æ‰€éœ€çš„ç”¨æˆ·ä¿¡æ¯
- ä¸ºäº†æ€§èƒ½ï¼Œå‡å°‘ç½‘ç»œè¯·æ±‚

éœ€è¦è°ƒç”¨çš„æƒ…å†µï¼š
- éœ€è¦æ›´è¯¦ç»†çš„ä¿¡æ¯
- éœ€è¦å®žæ—¶çš„æœ€æ–°æ•°æ®
- ID Tokenä¿¡æ¯ä¸å®Œæ•´
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š

```
OAuthæŽˆæƒæƒé™è¡Œï¼ŒOIDCè®¤è¯è¯†èº«ä»½
ID Tokenæºä¿¡æ¯ï¼ŒUserInfoè¯¦ç»†æ˜Ž
æ ‡å‡†Claimsç»Ÿæ ¼å¼ï¼Œè·¨å¹³å°æ¥é€šç”¨è¡Œ
æŽˆæƒç æµç¨‹åŠ IDï¼Œä¸‰ä»¤é½å‘ç™»å½•æˆ
```