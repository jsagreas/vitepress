---
title: 1ã€æˆæƒæœºåˆ¶åŸºç¡€
---
## ğŸ“š ç›®å½•

1. [æˆæƒæ˜¯ä»€ä¹ˆ](#1-æˆæƒæ˜¯ä»€ä¹ˆ)
2. [GrantedAuthorityæƒé™æ¥å£](#2-GrantedAuthorityæƒé™æ¥å£)
3. [è§’è‰²ä¸æƒé™çš„åŒºåˆ«](#3-è§’è‰²ä¸æƒé™çš„åŒºåˆ«)
4. [æƒé™æ§åˆ¶ç­–ç•¥](#4-æƒé™æ§åˆ¶ç­–ç•¥)
5. [è®¿é—®å†³ç­–ç®¡ç†å™¨](#5-è®¿é—®å†³ç­–ç®¡ç†å™¨)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” æˆæƒæ˜¯ä»€ä¹ˆ


### 1.1 ç”Ÿæ´»ä¸­çš„æˆæƒä¾‹å­


> ğŸ“Œ **é€šä¿—ç†è§£**  
> æˆæƒå°±åƒå…¬å¸çš„é—¨ç¦å¡ç³»ç»Ÿï¼šä½ å·²ç»åˆ·å¡è¿›é—¨äº†ï¼ˆè®¤è¯é€šè¿‡ï¼‰ï¼Œä½†ä¸æ˜¯æ‰€æœ‰æˆ¿é—´éƒ½èƒ½è¿›ã€‚è´¢åŠ¡å®¤åªæœ‰è´¢åŠ¡äººå‘˜èƒ½è¿›ï¼Œæ€»ç»ç†åŠå…¬å®¤åªæœ‰æ€»ç»ç†èƒ½è¿›ã€‚è¿™ä¸ª"è°èƒ½è¿›å“ªé‡Œ"çš„è§„åˆ™ï¼Œå°±æ˜¯æˆæƒã€‚

**ç°å®åœºæ™¯å¯¹æ¯”ï¼š**
```
ğŸ¢ å…¬å¸é—¨ç¦ç³»ç»Ÿ              ğŸ–¥ï¸ ç³»ç»Ÿæˆæƒæœºåˆ¶
==================           ==================
å‘˜å·¥è¯ï¼ˆè®¤è¯ï¼‰    â†’          ç”¨æˆ·ç™»å½•ï¼ˆè®¤è¯ï¼‰
é—¨ç¦æƒé™ï¼ˆæˆæƒï¼‰  â†’          è®¿é—®æƒé™ï¼ˆæˆæƒï¼‰
è´¢åŠ¡å®¤æƒé™        â†’          è´¢åŠ¡æ•°æ®æƒé™
æ™®é€šå‘˜å·¥          â†’          æ™®é€šç”¨æˆ·è§’è‰²
éƒ¨é—¨ç»ç†          â†’          ç®¡ç†å‘˜è§’è‰²
```

### 1.2 æˆæƒåœ¨ç³»ç»Ÿä¸­çš„ä½œç”¨


**æˆæƒçš„æ ¸å¿ƒé—®é¢˜ï¼š**
```
è®¤è¯è§£å†³ï¼šä½ æ˜¯è°ï¼Ÿï¼ˆWho are you?ï¼‰
æˆæƒè§£å†³ï¼šä½ èƒ½åšä»€ä¹ˆï¼Ÿï¼ˆWhat can you do?ï¼‰

ç¤ºä¾‹æµç¨‹ï¼š
ç”¨æˆ·ç™»å½• â†’ èº«ä»½éªŒè¯é€šè¿‡ï¼ˆè®¤è¯ï¼‰ â†’ æ£€æŸ¥æƒé™ï¼ˆæˆæƒï¼‰ â†’ å…è®¸/æ‹’ç»æ“ä½œ
```

**ğŸ¯ å®é™…åº”ç”¨åœºæ™¯ï¼š**
- **ç”µå•†ç³»ç»Ÿ**ï¼šæ™®é€šç”¨æˆ·åªèƒ½æŸ¥çœ‹å•†å“ï¼Œå•†å®¶å¯ä»¥ä¸Šæ¶å•†å“ï¼Œç®¡ç†å‘˜å¯ä»¥å®¡æ ¸å•†å“
- **åšå®¢ç³»ç»Ÿ**ï¼šæ¸¸å®¢åªèƒ½æµè§ˆï¼Œç™»å½•ç”¨æˆ·å¯ä»¥è¯„è®ºï¼Œä½œè€…å¯ä»¥å‘æ–‡ç« ï¼Œç®¡ç†å‘˜å¯ä»¥åˆ é™¤å†…å®¹
- **ä¼ä¸šOA**ï¼šå‘˜å·¥åªèƒ½çœ‹è‡ªå·±çš„è€ƒå‹¤ï¼ŒHRå¯ä»¥çœ‹æ‰€æœ‰äººè€ƒå‹¤ï¼Œè´¢åŠ¡å¯ä»¥å®¡æ‰¹æŠ¥é”€

---

## 2. âš™ï¸ GrantedAuthorityæƒé™æ¥å£


### 2.1 GrantedAuthorityæ˜¯ä»€ä¹ˆ


**ğŸ“– å®šä¹‰ï¼š**
`GrantedAuthority` æ˜¯Spring Securityä¸­è¡¨ç¤º"æƒé™"çš„æ ¸å¿ƒæ¥å£ï¼Œå®ƒå°±åƒä¸€ä¸ª"æƒé™æ ‡ç­¾"ï¼Œè´´åœ¨ç”¨æˆ·èº«ä¸Šï¼Œå‘Šè¯‰ç³»ç»Ÿ"è¿™ä¸ªç”¨æˆ·æœ‰ä»€ä¹ˆæƒé™"ã€‚

**æ¥å£ç»“æ„ï¼š**
```java
public interface GrantedAuthority extends Serializable {
    String getAuthority();  // è¿”å›æƒé™çš„å­—ç¬¦ä¸²è¡¨ç¤º
}
```

> ğŸ’¡ **ç†è§£è¦ç‚¹**  
> è¿™ä¸ªæ¥å£éå¸¸ç®€å•ï¼Œåªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼šè¿”å›æƒé™çš„åå­—ã€‚å°±åƒé—¨ç¦å¡ä¸Šå†™ç€"è´¢åŠ¡å®¤è®¿é—®æƒé™"ä¸€æ ·ã€‚

### 2.2 SimpleGrantedAuthorityç®€å•æƒé™å®ç°


**ğŸ”¸ æœ€å¸¸ç”¨çš„å®ç°ç±»ï¼š**
```java
// åˆ›å»ºä¸€ä¸ªæƒé™å¯¹è±¡
GrantedAuthority authority = new SimpleGrantedAuthority("USER_READ");

// å®é™…ä½¿ç”¨ç¤ºä¾‹
List<GrantedAuthority> authorities = new ArrayList<>();
authorities.add(new SimpleGrantedAuthority("USER_READ"));    // ç”¨æˆ·æŸ¥è¯¢æƒé™
authorities.add(new SimpleGrantedAuthority("USER_CREATE"));  // ç”¨æˆ·åˆ›å»ºæƒé™
authorities.add(new SimpleGrantedAuthority("ROLE_ADMIN"));   // ç®¡ç†å‘˜è§’è‰²
```

**ğŸ“Š æƒé™å¯¹è±¡ç‰¹ç‚¹ï¼š**

| ç‰¹æ€§ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **ä¸å¯å˜æ€§** | åˆ›å»ºåä¸èƒ½ä¿®æ”¹ | `new SimpleGrantedAuthority("READ")` |
| **å­—ç¬¦ä¸²è¡¨ç¤º** | ç”¨å­—ç¬¦ä¸²æè¿°æƒé™ | `"USER_READ"`, `"ROLE_ADMIN"` |
| **å¤§å°å†™æ•æ„Ÿ** | ä¸¥æ ¼åŒºåˆ†å¤§å°å†™ | `"admin"` â‰  `"ADMIN"` |
| **å”¯ä¸€æ ‡è¯†** | é€šè¿‡å­—ç¬¦ä¸²åˆ¤æ–­ç›¸ç­‰ | ä¸¤ä¸ªæƒé™å­—ç¬¦ä¸²ç›¸åŒåˆ™è§†ä¸ºåŒä¸€æƒé™ |

### 2.3 æƒé™å¯¹è±¡çš„å®é™…åº”ç”¨


**ğŸ” æƒé™æ£€æŸ¥æµç¨‹ï¼š**
```
ç”¨æˆ·è¯·æ±‚è®¿é—®èµ„æº
    â†“
æå–ç”¨æˆ·çš„æƒé™åˆ—è¡¨ï¼ˆList<GrantedAuthority>ï¼‰
    â†“
è·å–èµ„æºæ‰€éœ€æƒé™ï¼ˆå¦‚ï¼š"USER_DELETE"ï¼‰
    â†“
éå†ç”¨æˆ·æƒé™ï¼Œè°ƒç”¨getAuthority()å¯¹æ¯”
    â†“
åŒ¹é…æˆåŠŸ â†’ å…è®¸è®¿é—®
åŒ¹é…å¤±è´¥ â†’ æ‹’ç»è®¿é—®
```

**ä»£ç å®ç°ç¤ºä¾‹ï¼š**
```java
@Service
public class UserService {
    
    // è·å–å½“å‰ç™»å½•ç”¨æˆ·çš„æƒé™
    public Collection<? extends GrantedAuthority> getCurrentUserAuthorities() {
        Authentication auth = SecurityContextHolder.getContext().getAuthentication();
        return auth.getAuthorities();
    }
    
    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰ç‰¹å®šæƒé™
    public boolean hasAuthority(String authorityName) {
        Collection<? extends GrantedAuthority> authorities = getCurrentUserAuthorities();
        
        for (GrantedAuthority authority : authorities) {
            if (authority.getAuthority().equals(authorityName)) {
                return true;  // æ‰¾åˆ°åŒ¹é…çš„æƒé™
            }
        }
        return false;  // æ²¡æœ‰è¯¥æƒé™
    }
}
```

---

## 3. ğŸ­ è§’è‰²ä¸æƒé™çš„åŒºåˆ«


### 3.1 è§’è‰²(ROLE_)çš„æ¦‚å¿µ


> ğŸ“Œ **é€šä¿—ç†è§£**  
> è§’è‰²å°±åƒ"èŒä½"ï¼Œä¸€ä¸ªèŒä½é€šå¸¸åŒ…å«å¤šä¸ªæƒé™ã€‚æ¯”å¦‚"ç»ç†"è¿™ä¸ªèŒä½ï¼Œè‡ªå¸¦"å®¡æ‰¹"ã€"æŸ¥çœ‹æŠ¥è¡¨"ã€"ç®¡ç†ä¸‹å±"ç­‰å¤šä¸ªæƒé™ã€‚

**ğŸ”¸ è§’è‰²çš„ç‰¹ç‚¹ï¼š**
```
å‘½åè§„èŒƒï¼šå¿…é¡»ä»¥ "ROLE_" å¼€å¤´
ç¤ºä¾‹è§’è‰²ï¼š
  ROLE_USER      â†’ æ™®é€šç”¨æˆ·è§’è‰²
  ROLE_ADMIN     â†’ ç®¡ç†å‘˜è§’è‰²
  ROLE_MANAGER   â†’ ç»ç†è§’è‰²
  ROLE_GUEST     â†’ æ¸¸å®¢è§’è‰²
```

**è§’è‰²åœ¨Spring Securityä¸­çš„å®šä¹‰ï¼š**
```java
// å®šä¹‰è§’è‰²ï¼ˆæœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ç§GrantedAuthorityï¼‰
GrantedAuthority adminRole = new SimpleGrantedAuthority("ROLE_ADMIN");
GrantedAuthority userRole = new SimpleGrantedAuthority("ROLE_USER");

// ä¸€ä¸ªç”¨æˆ·å¯ä»¥æœ‰å¤šä¸ªè§’è‰²
List<GrantedAuthority> roles = Arrays.asList(
    new SimpleGrantedAuthority("ROLE_USER"),
    new SimpleGrantedAuthority("ROLE_MANAGER")
);
```

### 3.2 æƒé™(AUTHORITY)çš„æ¦‚å¿µ


> ğŸ“Œ **é€šä¿—ç†è§£**  
> æƒé™å°±åƒ"å…·ä½“èƒ½åšçš„äº‹"ï¼Œæ¯”å¦‚"æŸ¥çœ‹æŠ¥è¡¨"ã€"åˆ é™¤ç”¨æˆ·"ã€"ä¿®æ”¹ä»·æ ¼"è¿™äº›å…·ä½“çš„æ“ä½œã€‚

**ğŸ”¸ æƒé™çš„ç‰¹ç‚¹ï¼š**
```
å‘½åè§„èŒƒï¼šé€šå¸¸ç”¨åŠ¨ä½œ_èµ„æºæ ¼å¼
ç¤ºä¾‹æƒé™ï¼š
  USER_READ      â†’ æŸ¥è¯¢ç”¨æˆ·
  USER_CREATE    â†’ åˆ›å»ºç”¨æˆ·
  USER_UPDATE    â†’ æ›´æ–°ç”¨æˆ·
  USER_DELETE    â†’ åˆ é™¤ç”¨æˆ·
  ORDER_APPROVE  â†’ å®¡æ‰¹è®¢å•
```

**æƒé™å®šä¹‰ç¤ºä¾‹ï¼š**
```java
// å®šä¹‰ç»†ç²’åº¦æƒé™
GrantedAuthority readAuth = new SimpleGrantedAuthority("USER_READ");
GrantedAuthority createAuth = new SimpleGrantedAuthority("USER_CREATE");
GrantedAuthority deleteAuth = new SimpleGrantedAuthority("USER_DELETE");

// ä¸€ä¸ªç”¨æˆ·å¯ä»¥æœ‰å¤šä¸ªæƒé™
List<GrantedAuthority> authorities = Arrays.asList(
    new SimpleGrantedAuthority("USER_READ"),
    new SimpleGrantedAuthority("USER_CREATE")
);
```

### 3.3 è§’è‰²vsæƒé™å¯¹æ¯”


**ğŸ†š æ ¸å¿ƒåŒºåˆ«ï¼š**

| å¯¹æ¯”é¡¹ | **è§’è‰²(ROLE)** | **æƒé™(AUTHORITY)** |
|-------|---------------|-------------------|
| **æ¦‚å¿µ** | èŒä½ã€èº«ä»½æ ‡è¯† | å…·ä½“æ“ä½œæƒé™ |
| **ç²’åº¦** | ç²—ç²’åº¦ï¼ˆä¸€ç»„æƒé™ï¼‰ | ç»†ç²’åº¦ï¼ˆå•ä¸ªæ“ä½œï¼‰ |
| **å‘½å** | å¿…é¡»`ROLE_`å¼€å¤´ | è‡ªå®šä¹‰å‘½åè§„èŒƒ |
| **ç¤ºä¾‹** | `ROLE_ADMIN` | `USER_DELETE` |
| **ç”¨é€”** | å¿«é€Ÿæƒé™åˆ†ç»„ | ç²¾ç¡®æƒé™æ§åˆ¶ |

**å®é™…åº”ç”¨å¯¹æ¯”ï¼š**
```
ğŸ¯ åœºæ™¯1ï¼šåšå®¢ç³»ç»Ÿ

è§’è‰²æ–¹å¼ï¼š
  ROLE_AUTHOR   â†’ åŒ…å«ï¼šå†™æ–‡ç« ã€ç¼–è¾‘è‡ªå·±çš„æ–‡ç« ã€å›å¤è¯„è®º
  ROLE_ADMIN    â†’ åŒ…å«ï¼šæ‰€æœ‰æƒé™

æƒé™æ–¹å¼ï¼š
  ARTICLE_CREATE  â†’ åˆ›å»ºæ–‡ç« 
  ARTICLE_EDIT    â†’ ç¼–è¾‘æ–‡ç« 
  ARTICLE_DELETE  â†’ åˆ é™¤æ–‡ç« 
  COMMENT_REPLY   â†’ å›å¤è¯„è®º
  
ğŸ¯ åœºæ™¯2ï¼šç”µå•†ç³»ç»Ÿ

è§’è‰²æ–¹å¼ï¼š
  ROLE_CUSTOMER   â†’ æ™®é€šä¹°å®¶
  ROLE_SELLER     â†’ å•†å®¶
  ROLE_ADMIN      â†’ å¹³å°ç®¡ç†å‘˜

æƒé™æ–¹å¼ï¼š
  PRODUCT_VIEW     â†’ æŸ¥çœ‹å•†å“
  PRODUCT_CREATE   â†’ ä¸Šæ¶å•†å“
  ORDER_CANCEL     â†’ å–æ¶ˆè®¢å•
  USER_BAN         â†’ å°ç¦ç”¨æˆ·
```

### 3.4 è§’è‰²ä¸æƒé™çš„å…³ç³»


**ğŸ”— ä¸¤è€…ç»“åˆä½¿ç”¨ï¼š**
```
è§’è‰² = æƒé™é›†åˆ

ROLE_ADMIN åŒ…å«ï¼š
  â”œâ”€ USER_READ
  â”œâ”€ USER_CREATE
  â”œâ”€ USER_UPDATE
  â”œâ”€ USER_DELETE
  â”œâ”€ ORDER_READ
  â””â”€ ORDER_CANCEL

ROLE_USER åŒ…å«ï¼š
  â”œâ”€ USER_READï¼ˆåªèƒ½æŸ¥çœ‹ï¼‰
  â””â”€ ORDER_READï¼ˆåªèƒ½æŸ¥çœ‹è‡ªå·±çš„è®¢å•ï¼‰
```

**å®é™…é…ç½®ç¤ºä¾‹ï¼š**
```java
@Configuration
public class SecurityConfig {
    
    // æ–¹å¼1ï¼šåŸºäºè§’è‰²çš„é…ç½®ï¼ˆç²—ç²’åº¦ï¼‰
    @Bean
    public SecurityFilterChain roleBasedConfig(HttpSecurity http) throws Exception {
        http.authorizeHttpRequests(auth -> auth
            .requestMatchers("/admin/**").hasRole("ADMIN")      // éœ€è¦ADMINè§’è‰²
            .requestMatchers("/user/**").hasRole("USER")        // éœ€è¦USERè§’è‰²
            .anyRequest().authenticated()
        );
        return http.build();
    }
    
    // æ–¹å¼2ï¼šåŸºäºæƒé™çš„é…ç½®ï¼ˆç»†ç²’åº¦ï¼‰
    @Bean
    public SecurityFilterChain authorityBasedConfig(HttpSecurity http) throws Exception {
        http.authorizeHttpRequests(auth -> auth
            .requestMatchers("/api/users/delete").hasAuthority("USER_DELETE")
            .requestMatchers("/api/users/create").hasAuthority("USER_CREATE")
            .requestMatchers("/api/users/**").hasAuthority("USER_READ")
            .anyRequest().authenticated()
        );
        return http.build();
    }
}
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**  
> - è§’è‰²æ£€æŸ¥æ—¶ï¼ŒSpringä¼šè‡ªåŠ¨åŠ ä¸Š`ROLE_`å‰ç¼€ï¼Œæ‰€ä»¥`hasRole("ADMIN")`å®é™…æ£€æŸ¥çš„æ˜¯`ROLE_ADMIN`
> - æƒé™æ£€æŸ¥æ—¶ï¼Œä½¿ç”¨åŸå§‹å­—ç¬¦ä¸²ï¼Œ`hasAuthority("USER_DELETE")`å°±æ˜¯æ£€æŸ¥`USER_DELETE`
> - ä¸€ä¸ªç”¨æˆ·å¯ä»¥åŒæ—¶æ‹¥æœ‰å¤šä¸ªè§’è‰²å’Œå¤šä¸ªæƒé™

---

## 4. ğŸ›¡ï¸ æƒé™æ§åˆ¶ç­–ç•¥


### 4.1 æƒé™æ§åˆ¶çš„ä¸‰ç§æ–¹å¼


**ğŸ“‹ Spring Securityæä¾›çš„æƒé™æ§åˆ¶æ–¹å¼ï¼š**

```
ğŸ”¸ æ–¹å¼1ï¼šé…ç½®å¼æƒé™æ§åˆ¶ï¼ˆSecurityConfigä¸­é…ç½®ï¼‰
ğŸ”¸ æ–¹å¼2ï¼šæ³¨è§£å¼æƒé™æ§åˆ¶ï¼ˆæ–¹æ³•ä¸ŠåŠ æ³¨è§£ï¼‰
ğŸ”¸ æ–¹å¼3ï¼šç¼–ç¨‹å¼æƒé™æ§åˆ¶ï¼ˆä»£ç ä¸­æ‰‹åŠ¨åˆ¤æ–­ï¼‰
```

### 4.2 é…ç½®å¼æƒé™æ§åˆ¶


**ğŸ”§ åœ¨é…ç½®ç±»ä¸­å®šä¹‰æƒé™è§„åˆ™ï¼š**

```java
@Configuration
@EnableWebSecurity
public class SecurityConfig {
    
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http.authorizeHttpRequests(auth -> auth
            // å…¬å¼€è®¿é—®
            .requestMatchers("/public/**").permitAll()
            
            // è§’è‰²æ§åˆ¶
            .requestMatchers("/admin/**").hasRole("ADMIN")
            .requestMatchers("/user/**").hasAnyRole("USER", "ADMIN")
            
            // æƒé™æ§åˆ¶
            .requestMatchers("/api/users/delete").hasAuthority("USER_DELETE")
            .requestMatchers("/api/users/create").hasAuthority("USER_CREATE")
            
            // å…¶ä»–è¯·æ±‚éœ€è¦è®¤è¯
            .anyRequest().authenticated()
        );
        
        return http.build();
    }
}
```

**ğŸ“Š å¸¸ç”¨åŒ¹é…æ–¹æ³•ï¼š**

| æ–¹æ³• | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `permitAll()` | å…è®¸æ‰€æœ‰äººè®¿é—® | ç™»å½•é¡µã€é¦–é¡µ |
| `hasRole()` | éœ€è¦ç‰¹å®šè§’è‰² | `.hasRole("ADMIN")` |
| `hasAnyRole()` | éœ€è¦ä»»ä¸€è§’è‰² | `.hasAnyRole("USER","ADMIN")` |
| `hasAuthority()` | éœ€è¦ç‰¹å®šæƒé™ | `.hasAuthority("USER_DELETE")` |
| `hasAnyAuthority()` | éœ€è¦ä»»ä¸€æƒé™ | `.hasAnyAuthority("READ","WRITE")` |
| `authenticated()` | éœ€è¦ç™»å½• | æ‰€æœ‰è®¤è¯ç”¨æˆ·å¯è®¿é—® |
| `anonymous()` | ä»…æœªç™»å½•å¯è®¿é—® | æ³¨å†Œé¡µé¢ |

### 4.3 æ³¨è§£å¼æƒé™æ§åˆ¶


**ğŸ·ï¸ åœ¨æ–¹æ³•ä¸Šä½¿ç”¨æ³¨è§£ï¼š**

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    // éœ€è¦ADMINè§’è‰²æ‰èƒ½è®¿é—®
    @PreAuthorize("hasRole('ADMIN')")
    @DeleteMapping("/{id}")
    public ResponseEntity<Void> deleteUser(@PathVariable Long id) {
        userService.deleteUser(id);
        return ResponseEntity.ok().build();
    }
    
    // éœ€è¦USER_CREATEæƒé™
    @PreAuthorize("hasAuthority('USER_CREATE')")
    @PostMapping
    public ResponseEntity<User> createUser(@RequestBody User user) {
        User created = userService.createUser(user);
        return ResponseEntity.ok(created);
    }
    
    // éœ€è¦ADMINè§’è‰²æˆ–è€…æ˜¯ç”¨æˆ·æœ¬äºº
    @PreAuthorize("hasRole('ADMIN') or #id == authentication.principal.id")
    @GetMapping("/{id}")
    public ResponseEntity<User> getUser(@PathVariable Long id) {
        User user = userService.getUser(id);
        return ResponseEntity.ok(user);
    }
    
    // æ£€æŸ¥è¿”å›ç»“æœçš„æƒé™
    @PostAuthorize("returnObject.username == authentication.name")
    @GetMapping("/profile")
    public User getProfile() {
        return userService.getCurrentUserProfile();
    }
}
```

**ğŸ”‘ å¯ç”¨æ–¹æ³•çº§åˆ«å®‰å…¨ï¼š**
```java
@Configuration
@EnableMethodSecurity  // Spring Security 6.x
// æˆ– @EnableGlobalMethodSecurity(prePostEnabled = true)  // æ—§ç‰ˆæœ¬
public class MethodSecurityConfig {
    // é…ç½®å†…å®¹
}
```

**ğŸ“ å¸¸ç”¨æƒé™æ³¨è§£ï¼š**

| æ³¨è§£ | æ—¶æœº | ç”¨é€” | ç¤ºä¾‹ |
|------|------|------|------|
| `@PreAuthorize` | æ–¹æ³•æ‰§è¡Œå‰ | æ£€æŸ¥æ˜¯å¦æœ‰æƒé™è°ƒç”¨ | `@PreAuthorize("hasRole('ADMIN')")` |
| `@PostAuthorize` | æ–¹æ³•æ‰§è¡Œå | æ£€æŸ¥è¿”å›ç»“æœæƒé™ | `@PostAuthorize("returnObject.owner == authentication.name")` |
| `@Secured` | æ–¹æ³•æ‰§è¡Œå‰ | ç®€å•çš„è§’è‰²æ£€æŸ¥ | `@Secured("ROLE_ADMIN")` |
| `@RolesAllowed` | æ–¹æ³•æ‰§è¡Œå‰ | JSR-250æ ‡å‡† | `@RolesAllowed("ADMIN")` |

### 4.4 ç¼–ç¨‹å¼æƒé™æ§åˆ¶


**ğŸ’» åœ¨ä»£ç ä¸­æ‰‹åŠ¨åˆ¤æ–­æƒé™ï¼š**

```java
@Service
public class OrderService {
    
    public void cancelOrder(Long orderId) {
        // è·å–å½“å‰è®¤è¯ä¿¡æ¯
        Authentication auth = SecurityContextHolder.getContext().getAuthentication();
        
        // æ–¹å¼1ï¼šæ£€æŸ¥è§’è‰²
        boolean isAdmin = auth.getAuthorities().stream()
            .anyMatch(a -> a.getAuthority().equals("ROLE_ADMIN"));
        
        // æ–¹å¼2ï¼šæ£€æŸ¥æƒé™
        boolean canCancel = auth.getAuthorities().stream()
            .anyMatch(a -> a.getAuthority().equals("ORDER_CANCEL"));
        
        if (!isAdmin && !canCancel) {
            throw new AccessDeniedException("æ— æƒé™å–æ¶ˆè®¢å•");
        }
        
        // æ‰§è¡Œå–æ¶ˆè®¢å•é€»è¾‘
        orderRepository.cancelOrder(orderId);
    }
    
    // ä½¿ç”¨å·¥å…·æ–¹æ³•ç®€åŒ–åˆ¤æ–­
    public void processRefund(Long orderId) {
        if (!hasAuthority("ORDER_REFUND")) {
            throw new AccessDeniedException("æ— æƒé™å¤„ç†é€€æ¬¾");
        }
        // é€€æ¬¾é€»è¾‘
    }
    
    private boolean hasAuthority(String authority) {
        Authentication auth = SecurityContextHolder.getContext().getAuthentication();
        return auth.getAuthorities().stream()
            .anyMatch(a -> a.getAuthority().equals(authority));
    }
}
```

**ğŸ¯ ä¸‰ç§æ–¹å¼çš„é€‰æ‹©å»ºè®®ï¼š**

```
ğŸ”¸ é…ç½®å¼ï¼šé€‚åˆURLçº§åˆ«çš„ç²—ç²’åº¦æ§åˆ¶
  ä¼˜ç‚¹ï¼šé›†ä¸­ç®¡ç†ï¼Œæ¸…æ™°ç›´è§‚
  ç¼ºç‚¹ï¼šåªèƒ½æ§åˆ¶URLï¼Œæ— æ³•æ§åˆ¶ä¸šåŠ¡é€»è¾‘

ğŸ”¸ æ³¨è§£å¼ï¼šé€‚åˆæ–¹æ³•çº§åˆ«çš„æƒé™æ§åˆ¶
  ä¼˜ç‚¹ï¼šè´´è¿‘ä¸šåŠ¡ï¼Œçµæ´»æ–¹ä¾¿
  ç¼ºç‚¹ï¼šæƒé™è§„åˆ™åˆ†æ•£åœ¨å„ä¸ªç±»ä¸­

ğŸ”¸ ç¼–ç¨‹å¼ï¼šé€‚åˆå¤æ‚çš„ä¸šåŠ¡æƒé™åˆ¤æ–­
  ä¼˜ç‚¹ï¼šæœ€çµæ´»ï¼Œå¯ä»¥ç»“åˆä¸šåŠ¡é€»è¾‘
  ç¼ºç‚¹ï¼šä»£ç ä¾µå…¥æ€§å¼ºï¼Œä¸å¤Ÿä¼˜é›…
```

---

## 5. âš–ï¸ è®¿é—®å†³ç­–ç®¡ç†å™¨


### 5.1 è®¿é—®å†³ç­–ç®¡ç†å™¨æ˜¯ä»€ä¹ˆ


> ğŸ“Œ **é€šä¿—ç†è§£**  
> è®¿é—®å†³ç­–ç®¡ç†å™¨å°±åƒä¸€ä¸ª"é—¨å«ä¸»ç®¡"ï¼Œå®ƒè´Ÿè´£æœ€ç»ˆå†³å®šï¼šè¿™ä¸ªç”¨æˆ·èƒ½ä¸èƒ½è®¿é—®è¿™ä¸ªèµ„æºã€‚å®ƒä¼šæ ¹æ®è§„åˆ™ï¼ˆæŠ•ç¥¨å™¨ï¼‰æ¥åšå‡ºåˆ¤æ–­ã€‚

**ğŸ” å·¥ä½œæµç¨‹ï¼š**
```
ç”¨æˆ·è¯·æ±‚è®¿é—®èµ„æº
    â†“
æå–ç”¨æˆ·æƒé™ä¿¡æ¯
    â†“
è·å–èµ„æºæ‰€éœ€æƒé™
    â†“
ã€è®¿é—®å†³ç­–ç®¡ç†å™¨ã€‘
    â”œâ†’ æŠ•ç¥¨å™¨1ï¼šåŒæ„/æ‹’ç»/å¼ƒæƒ
    â”œâ†’ æŠ•ç¥¨å™¨2ï¼šåŒæ„/æ‹’ç»/å¼ƒæƒ
    â””â†’ æŠ•ç¥¨å™¨3ï¼šåŒæ„/æ‹’ç»/å¼ƒæƒ
    â†“
æ±‡æ€»æŠ•ç¥¨ç»“æœ
    â†“
åšå‡ºæœ€ç»ˆå†³ç­–ï¼šå…è®¸ or æ‹’ç»
```

### 5.2 æ ¸å¿ƒç»„ä»¶


**ğŸ“¦ ä¸‰å¤§æ ¸å¿ƒç»„ä»¶ï¼š**

```
ğŸ”¸ AccessDecisionManagerï¼ˆè®¿é—®å†³ç­–ç®¡ç†å™¨ï¼‰
   â””â”€ ä½œç”¨ï¼šæ±‡æ€»æŠ•ç¥¨ç»“æœï¼Œåšå‡ºæœ€ç»ˆå†³ç­–
   
ğŸ”¸ AccessDecisionVoterï¼ˆè®¿é—®å†³ç­–æŠ•ç¥¨å™¨ï¼‰
   â””â”€ ä½œç”¨ï¼šå¯¹æ¯ä¸ªè®¿é—®è¯·æ±‚æŠ•ç¥¨ï¼ˆåŒæ„/æ‹’ç»/å¼ƒæƒï¼‰
   
ğŸ”¸ ConfigAttributeï¼ˆé…ç½®å±æ€§ï¼‰
   â””â”€ ä½œç”¨ï¼šæè¿°è®¿é—®èµ„æºéœ€è¦ä»€ä¹ˆæƒé™
```

### 5.3 å†³ç­–ç­–ç•¥


**ğŸ¯ Spring Securityæä¾›çš„ä¸‰ç§å†³ç­–ç­–ç•¥ï¼š**

#### ç­–ç•¥1ï¼šä¸€ç¥¨é€šè¿‡ï¼ˆAffirmativeBasedï¼‰


```java
// ä¸€ç¥¨é€šè¿‡ï¼šåªè¦æœ‰ä¸€ä¸ªæŠ•ç¥¨å™¨åŒæ„ï¼Œå°±å…è®¸è®¿é—®
public class AffirmativeBased extends AbstractAccessDecisionManager {
    
    public void decide(Authentication authentication, Object object,
                      Collection<ConfigAttribute> configAttributes) {
        
        int deny = 0;  // æ‹’ç»ç¥¨æ•°
        
        for (AccessDecisionVoter voter : getDecisionVoters()) {
            int result = voter.vote(authentication, object, configAttributes);
            
            switch (result) {
                case ACCESS_GRANTED:  // åŒæ„ç¥¨
                    return;  // ç«‹å³é€šè¿‡ï¼Œä¸å†ç»§ç»­æŠ•ç¥¨
                case ACCESS_DENIED:   // æ‹’ç»ç¥¨
                    deny++;
                    break;
                default:             // å¼ƒæƒç¥¨
                    break;
            }
        }
        
        if (deny > 0) {
            throw new AccessDeniedException("è®¿é—®è¢«æ‹’ç»");
        }
    }
}
```

**åº”ç”¨åœºæ™¯ï¼š**
```
é€‚ç”¨æƒ…å†µï¼šå®½æ¾çš„æƒé™æ§åˆ¶
ç¤ºä¾‹ï¼š
  æŠ•ç¥¨å™¨1ï¼šæ£€æŸ¥æ˜¯å¦æ˜¯ADMIN â†’ åŒæ„ âœ“
  æŠ•ç¥¨å™¨2ï¼šæ£€æŸ¥æ˜¯å¦æœ‰USER_DELETEæƒé™ â†’ æ‹’ç» âœ—
  æŠ•ç¥¨å™¨3ï¼šæ£€æŸ¥IPç™½åå• â†’ å¼ƒæƒ â—‹
  
  ç»“æœï¼šæœ‰ä¸€ç¥¨åŒæ„ï¼Œè®¿é—®é€šè¿‡ï¼
```

#### ç­–ç•¥2ï¼šä¸€ç¥¨å¦å†³ï¼ˆUnanimousBasedï¼‰


```java
// ä¸€ç¥¨å¦å†³ï¼šåªè¦æœ‰ä¸€ä¸ªæŠ•ç¥¨å™¨æ‹’ç»ï¼Œå°±æ‹’ç»è®¿é—®
public class UnanimousBased extends AbstractAccessDecisionManager {
    
    public void decide(Authentication authentication, Object object,
                      Collection<ConfigAttribute> configAttributes) {
        
        int grant = 0;  // åŒæ„ç¥¨æ•°
        
        for (AccessDecisionVoter voter : getDecisionVoters()) {
            int result = voter.vote(authentication, object, configAttributes);
            
            switch (result) {
                case ACCESS_GRANTED:
                    grant++;
                    break;
                case ACCESS_DENIED:   // æ‹’ç»ç¥¨
                    throw new AccessDeniedException("è®¿é—®è¢«æ‹’ç»");  // ç«‹å³æ‹’ç»
                default:
                    break;
            }
        }
        
        if (grant > 0) {
            return;  // æ‰€æœ‰æŠ•ç¥¨å™¨éƒ½åŒæ„æ‰é€šè¿‡
        }
    }
}
```

**åº”ç”¨åœºæ™¯ï¼š**
```
é€‚ç”¨æƒ…å†µï¼šä¸¥æ ¼çš„æƒé™æ§åˆ¶
ç¤ºä¾‹ï¼š
  æŠ•ç¥¨å™¨1ï¼šæ£€æŸ¥æ˜¯å¦æ˜¯ADMIN â†’ åŒæ„ âœ“
  æŠ•ç¥¨å™¨2ï¼šæ£€æŸ¥æ˜¯å¦æœ‰USER_DELETEæƒé™ â†’ åŒæ„ âœ“
  æŠ•ç¥¨å™¨3ï¼šæ£€æŸ¥IPç™½åå• â†’ æ‹’ç» âœ—
  
  ç»“æœï¼šæœ‰ä¸€ç¥¨å¦å†³ï¼Œè®¿é—®æ‹’ç»ï¼
```

#### ç­–ç•¥3ï¼šå°‘æ•°æœä»å¤šæ•°ï¼ˆConsensusBasedï¼‰


```java
// å°‘æ•°æœä»å¤šæ•°ï¼šæ ¹æ®åŒæ„å’Œæ‹’ç»çš„ç¥¨æ•°å†³å®š
public class ConsensusBased extends AbstractAccessDecisionManager {
    
    public void decide(Authentication authentication, Object object,
                      Collection<ConfigAttribute> configAttributes) {
        
        int grant = 0;   // åŒæ„ç¥¨
        int deny = 0;    // æ‹’ç»ç¥¨
        
        for (AccessDecisionVoter voter : getDecisionVoters()) {
            int result = voter.vote(authentication, object, configAttributes);
            
            switch (result) {
                case ACCESS_GRANTED:
                    grant++;
                    break;
                case ACCESS_DENIED:
                    deny++;
                    break;
            }
        }
        
        if (grant > deny) {
            return;  // åŒæ„ç¥¨å¤šï¼Œé€šè¿‡
        } else {
            throw new AccessDeniedException("è®¿é—®è¢«æ‹’ç»");  // æ‹’ç»ç¥¨å¤šæˆ–ç›¸ç­‰ï¼Œæ‹’ç»
        }
    }
}
```

**åº”ç”¨åœºæ™¯ï¼š**
```
é€‚ç”¨æƒ…å†µï¼šæ°‘ä¸»å¼æƒé™æ§åˆ¶
ç¤ºä¾‹ï¼š
  æŠ•ç¥¨å™¨1ï¼šæ£€æŸ¥è§’è‰² â†’ åŒæ„ âœ“
  æŠ•ç¥¨å™¨2ï¼šæ£€æŸ¥æƒé™ â†’ åŒæ„ âœ“
  æŠ•ç¥¨å™¨3ï¼šæ£€æŸ¥IP â†’ æ‹’ç» âœ—
  æŠ•ç¥¨å™¨4ï¼šæ£€æŸ¥æ—¶é—´æ®µ â†’ æ‹’ç» âœ—
  
  ç»“æœï¼š2ç¥¨åŒæ„ vs 2ç¥¨æ‹’ç»ï¼Œå¹³ç¥¨åˆ™æ‹’ç»
```

### 5.4 å¸¸è§æŠ•ç¥¨å™¨


**ğŸ—³ï¸ Spring Securityå†…ç½®çš„æŠ•ç¥¨å™¨ï¼š**

| æŠ•ç¥¨å™¨ | åŠŸèƒ½ | ä½¿ç”¨åœºæ™¯ |
|--------|------|----------|
| **RoleVoter** | è§’è‰²æŠ•ç¥¨å™¨ | æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æŸä¸ªè§’è‰² |
| **AuthenticatedVoter** | è®¤è¯æŠ•ç¥¨å™¨ | æ£€æŸ¥ç”¨æˆ·è®¤è¯çŠ¶æ€ |
| **WebExpressionVoter** | è¡¨è¾¾å¼æŠ•ç¥¨å™¨ | æ”¯æŒSpELè¡¨è¾¾å¼æƒé™åˆ¤æ–­ |

**å®é™…é…ç½®ç¤ºä¾‹ï¼š**
```java
@Configuration
public class AccessDecisionConfig {
    
    @Bean
    public AccessDecisionManager accessDecisionManager() {
        // åˆ›å»ºæŠ•ç¥¨å™¨åˆ—è¡¨
        List<AccessDecisionVoter<?>> voters = Arrays.asList(
            new RoleVoter(),              // è§’è‰²æŠ•ç¥¨å™¨
            new AuthenticatedVoter(),     // è®¤è¯çŠ¶æ€æŠ•ç¥¨å™¨
            new WebExpressionVoter()      // è¡¨è¾¾å¼æŠ•ç¥¨å™¨
        );
        
        // ä½¿ç”¨ä¸€ç¥¨é€šè¿‡ç­–ç•¥
        return new AffirmativeBased(voters);
        
        // æˆ–ä½¿ç”¨ä¸€ç¥¨å¦å†³ç­–ç•¥
        // return new UnanimousBased(voters);
        
        // æˆ–ä½¿ç”¨å°‘æ•°æœä»å¤šæ•°ç­–ç•¥
        // return new ConsensusBased(voters);
    }
}
```

### 5.5 è‡ªå®šä¹‰æŠ•ç¥¨å™¨


**ğŸ”§ åˆ›å»ºè‡ªå®šä¹‰æŠ•ç¥¨å™¨ï¼š**

```java
// ç¤ºä¾‹ï¼šIPç™½åå•æŠ•ç¥¨å™¨
public class IpAddressVoter implements AccessDecisionVoter<Object> {
    
    private static final String IP_PREFIX = "IP_";
    private List<String> allowedIps = Arrays.asList("192.168.1.100", "192.168.1.101");
    
    @Override
    public int vote(Authentication authentication, Object object, 
                    Collection<ConfigAttribute> attributes) {
        
        // è·å–è¯·æ±‚çš„IPåœ°å€
        String currentIp = getCurrentRequestIp();
        
        // æ£€æŸ¥é…ç½®ä¸­æ˜¯å¦éœ€è¦IPéªŒè¯
        boolean needIpCheck = attributes.stream()
            .anyMatch(attr -> attr.getAttribute().startsWith(IP_PREFIX));
        
        if (!needIpCheck) {
            return ACCESS_ABSTAIN;  // å¼ƒæƒï¼Œä¸å‚ä¸æ­¤æ¬¡æŠ•ç¥¨
        }
        
        // æ£€æŸ¥IPæ˜¯å¦åœ¨ç™½åå•ä¸­
        if (allowedIps.contains(currentIp)) {
            return ACCESS_GRANTED;  // åŒæ„
        } else {
            return ACCESS_DENIED;   // æ‹’ç»
        }
    }
    
    private String getCurrentRequestIp() {
        // ä»è¯·æ±‚ä¸­è·å–IPåœ°å€çš„é€»è¾‘
        ServletRequestAttributes attrs = 
            (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
        return attrs.getRequest().getRemoteAddr();
    }
    
    @Override
    public boolean supports(ConfigAttribute attribute) {
        return attribute.getAttribute() != null && 
               attribute.getAttribute().startsWith(IP_PREFIX);
    }
    
    @Override
    public boolean supports(Class<?> clazz) {
        return true;
    }
}
```

**ä½¿ç”¨è‡ªå®šä¹‰æŠ•ç¥¨å™¨ï¼š**
```java
@Configuration
public class CustomAccessDecisionConfig {
    
    @Bean
    public AccessDecisionManager customAccessDecisionManager() {
        List<AccessDecisionVoter<?>> voters = Arrays.asList(
            new RoleVoter(),
            new IpAddressVoter(),  // æ·»åŠ è‡ªå®šä¹‰æŠ•ç¥¨å™¨
            new WebExpressionVoter()
        );
        
        return new UnanimousBased(voters);  // ä½¿ç”¨ä¸€ç¥¨å¦å†³ç­–ç•¥
    }
}
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æˆæƒæœ¬è´¨ï¼šè§£å†³"è°èƒ½åšä»€ä¹ˆ"çš„é—®é¢˜ï¼Œæ˜¯è®¤è¯ä¹‹åçš„æƒé™æ§åˆ¶
ğŸ”¸ GrantedAuthorityï¼šSpring Securityä¸­è¡¨ç¤ºæƒé™çš„æ ¸å¿ƒæ¥å£
ğŸ”¸ SimpleGrantedAuthorityï¼šæœ€å¸¸ç”¨çš„æƒé™å®ç°ç±»ï¼Œç”¨å­—ç¬¦ä¸²è¡¨ç¤ºæƒé™
ğŸ”¸ è§’è‰²vsæƒé™ï¼šè§’è‰²æ˜¯ç²—ç²’åº¦çš„æƒé™é›†åˆï¼Œæƒé™æ˜¯ç»†ç²’åº¦çš„æ“ä½œæ§åˆ¶
ğŸ”¸ æƒé™æ§åˆ¶ç­–ç•¥ï¼šé…ç½®å¼ã€æ³¨è§£å¼ã€ç¼–ç¨‹å¼ä¸‰ç§æ–¹å¼
ğŸ”¸ è®¿é—®å†³ç­–ç®¡ç†å™¨ï¼šé€šè¿‡æŠ•ç¥¨æœºåˆ¶åšå‡ºè®¿é—®å†³ç­–
```

### 6.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ è§’è‰²å’Œæƒé™çš„å…³ç³»**
```
è®°å¿†è¦ç‚¹ï¼š
- è§’è‰² = ä¸€ç»„æƒé™çš„é›†åˆï¼ˆèŒä½ï¼‰
- æƒé™ = å…·ä½“çš„æ“ä½œè®¸å¯ï¼ˆèƒ½åšä»€ä¹ˆï¼‰
- è§’è‰²å¿…é¡»ä»¥ROLE_å¼€å¤´ï¼Œæƒé™è‡ªå®šä¹‰å‘½å
- ä¸€ä¸ªç”¨æˆ·å¯ä»¥æœ‰å¤šä¸ªè§’è‰²å’Œå¤šä¸ªæƒé™
```

**ğŸ”¹ ä¸‰ç§æƒé™æ§åˆ¶æ–¹å¼çš„é€‰æ‹©**
```
é…ç½®å¼ï¼šURLçº§åˆ« â†’ é€‚åˆé¡µé¢è®¿é—®æ§åˆ¶
æ³¨è§£å¼ï¼šæ–¹æ³•çº§åˆ« â†’ é€‚åˆä¸šåŠ¡æ¥å£æ§åˆ¶
ç¼–ç¨‹å¼ï¼šä»£ç çº§åˆ« â†’ é€‚åˆå¤æ‚ä¸šåŠ¡é€»è¾‘

å®é™…åº”ç”¨ï¼šé€šå¸¸ä¸‰ç§æ–¹å¼ç»“åˆä½¿ç”¨
```

**ğŸ”¹ è®¿é—®å†³ç­–ç­–ç•¥**
```
ä¸€ç¥¨é€šè¿‡ï¼šå®½æ¾æ§åˆ¶ï¼Œæœ‰äººåŒæ„å°±è¡Œ
ä¸€ç¥¨å¦å†³ï¼šä¸¥æ ¼æ§åˆ¶ï¼Œæœ‰äººæ‹’ç»å°±ä¸è¡Œ
å°‘æ•°æœä»å¤šæ•°ï¼šæ°‘ä¸»æ§åˆ¶ï¼Œçœ‹å¤šæ•°æ„è§

é€‰æ‹©ä¾æ®ï¼šæ ¹æ®ä¸šåŠ¡å®‰å…¨è¦æ±‚å†³å®š
```

### 6.3 å®é™…åº”ç”¨å»ºè®®


**âœ… æƒé™è®¾è®¡æœ€ä½³å®è·µï¼š**

1. **è§’è‰²å’Œæƒé™ç»“åˆä½¿ç”¨**
   - ç²—ç²’åº¦ç”¨è§’è‰²ï¼šå¿«é€Ÿåˆ†é…åŸºç¡€æƒé™
   - ç»†ç²’åº¦ç”¨æƒé™ï¼šç²¾ç¡®æ§åˆ¶å…³é”®æ“ä½œ

2. **æƒé™å‘½åè§„èŒƒ**
   - è§’è‰²ï¼š`ROLE_` + èŒä½åç§°ï¼ˆå¦‚`ROLE_ADMIN`ï¼‰
   - æƒé™ï¼š`èµ„æº_æ“ä½œ`ï¼ˆå¦‚`USER_DELETE`ï¼‰

3. **åˆ†å±‚æ§åˆ¶**
   - URLå±‚ï¼šé…ç½®å¼æ§åˆ¶é¡µé¢è®¿é—®
   - æ–¹æ³•å±‚ï¼šæ³¨è§£å¼æ§åˆ¶æ¥å£è°ƒç”¨
   - ä¸šåŠ¡å±‚ï¼šç¼–ç¨‹å¼æ§åˆ¶å¤æ‚é€»è¾‘

4. **å®‰å…¨ç­–ç•¥é€‰æ‹©**
   - å…³é”®æ“ä½œï¼šä½¿ç”¨ä¸€ç¥¨å¦å†³ç­–ç•¥
   - ä¸€èˆ¬æ“ä½œï¼šä½¿ç”¨ä¸€ç¥¨é€šè¿‡ç­–ç•¥
   - å¤æ‚åœºæ™¯ï¼šè‡ªå®šä¹‰æŠ•ç¥¨å™¨

> ğŸ’¡ **å®ç”¨æŠ€å·§**  
> åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œé€šå¸¸ä¼šå…ˆç”¨é…ç½®å¼å®šä¹‰URLçº§åˆ«çš„å¤§è‡´æƒé™èŒƒå›´ï¼Œå†ç”¨æ³¨è§£å¼åœ¨å…³é”®æ–¹æ³•ä¸ŠåŠ å¼ºæ§åˆ¶ï¼Œæœ€ååœ¨å¤æ‚ä¸šåŠ¡é€»è¾‘ä¸­ä½¿ç”¨ç¼–ç¨‹å¼åšç²¾ç»†åŒ–åˆ¤æ–­ã€‚

### 6.4 å­¦ä¹ æ£€éªŒæ¸…å•


âœ… **è‡ªæ£€æ¸…å•ï¼š**
- [ ] ç†è§£æˆæƒä¸è®¤è¯çš„åŒºåˆ«
- [ ] æŒæ¡GrantedAuthorityçš„ä½œç”¨å’Œç”¨æ³•
- [ ] åŒºåˆ†è§’è‰²(ROLE_)å’Œæƒé™(AUTHORITY)çš„æ¦‚å¿µ
- [ ] ä¼šä½¿ç”¨ä¸‰ç§æƒé™æ§åˆ¶æ–¹å¼
- [ ] ç†è§£è®¿é—®å†³ç­–ç®¡ç†å™¨çš„å·¥ä½œåŸç†
- [ ] çŸ¥é“å¦‚ä½•é€‰æ‹©åˆé€‚çš„å†³ç­–ç­–ç•¥
- [ ] èƒ½å¤Ÿå®ç°è‡ªå®šä¹‰æŠ•ç¥¨å™¨

---

**æ ¸å¿ƒè®°å¿†å£è¯€ï¼š**
```
æˆæƒæ§åˆ¶åˆ†è§’è‰²ï¼Œæƒé™ç»†åŒ–æ›´çµæ´»
é…ç½®æ³¨è§£åŠ ç¼–ç¨‹ï¼Œä¸‰ç§æ–¹å¼ç›¸ç»“åˆ
å†³ç­–ç®¡ç†é æŠ•ç¥¨ï¼Œç­–ç•¥é€‰æ‹©çœ‹åœºæ™¯
ä¸€ç¥¨é€šè¿‡å®½æ¾ç”¨,ä¸€ç¥¨å¦å†³ä¸¥æ ¼æ§
```