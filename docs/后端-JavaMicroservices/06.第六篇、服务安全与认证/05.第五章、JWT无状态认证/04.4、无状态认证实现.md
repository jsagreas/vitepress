---
title: 4ã€æ— çŠ¶æ€è®¤è¯å®ç°
---
## ğŸ“š ç›®å½•


1. [æ— çŠ¶æ€è®¤è¯åŸºç¡€æ¦‚å¿µ](#1-æ— çŠ¶æ€è®¤è¯åŸºç¡€æ¦‚å¿µ)
2. [æ— çŠ¶æ€æœåŠ¡è®¾è®¡åŸç†](#2-æ— çŠ¶æ€æœåŠ¡è®¾è®¡åŸç†)
3. [Tokené¢å‘æœºåˆ¶](#3-Tokené¢å‘æœºåˆ¶)
4. [TokenéªŒè¯æµç¨‹](#4-TokenéªŒè¯æµç¨‹)
5. [Tokenåˆ·æ–°ç­–ç•¥](#5-Tokenåˆ·æ–°ç­–ç•¥)
6. [é»‘åå•æœºåˆ¶](#6-é»‘åå•æœºåˆ¶)
7. [Tokenå­˜å‚¨ç­–ç•¥](#7-Tokenå­˜å‚¨ç­–ç•¥)
8. [æ€§èƒ½ä¼˜åŒ–è€ƒè™‘](#8-æ€§èƒ½ä¼˜åŒ–è€ƒè™‘)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

# ğŸ¯ **å­¦ä¹ å¯¼èˆª**


**å‰ç½®çŸ¥è¯†**ï¼šéœ€è¦äº†è§£JWTåŸºç¡€ã€Spring SecurityåŸºæœ¬é…ç½® â†’ **å½“å‰å†…å®¹**ï¼šæ— çŠ¶æ€è®¤è¯å®ç° â†’ **åç»­å­¦ä¹ **ï¼šOAuth2.0æˆæƒã€å¾®æœåŠ¡å®‰å…¨é˜²æŠ¤

â±ï¸ **é¢„è®¡å­¦ä¹ æ—¶é—´**ï¼šæœ¬ç« çº¦45åˆ†é’Ÿ | å®æˆ˜ç»ƒä¹ 30åˆ†é’Ÿ

**ğŸ·ï¸ éš¾åº¦æ ‡è¯†**ï¼šğŸŸ¡ è¿›é˜¶çº§ | **é‡è¦æ€§**ï¼šâ˜…â˜…â˜…â˜…â˜…

---

## 1. ğŸ”‘ æ— çŠ¶æ€è®¤è¯åŸºç¡€æ¦‚å¿µ



### 1.1 ä»€ä¹ˆæ˜¯æ— çŠ¶æ€è®¤è¯



**æ ¸å¿ƒç†è§£**
```
æ— çŠ¶æ€è®¤è¯ = æœåŠ¡å™¨ä¸ä¿å­˜ç”¨æˆ·ç™»å½•çŠ¶æ€çš„è®¤è¯æ–¹å¼

ä¼ ç»Ÿæ–¹å¼ï¼ˆæœ‰çŠ¶æ€ï¼‰ï¼š
ç”¨æˆ·ç™»å½• â†’ æœåŠ¡å™¨åˆ›å»ºSession â†’ ä¿å­˜åœ¨å†…å­˜/æ•°æ®åº“
é—®é¢˜ï¼šæœåŠ¡å™¨éœ€è¦è®°ä½æ¯ä¸ªç”¨æˆ·ï¼Œé›†ç¾¤ç¯å¢ƒéš¾å¤„ç†

æ— çŠ¶æ€æ–¹å¼ï¼š
ç”¨æˆ·ç™»å½• â†’ æœåŠ¡å™¨ç”ŸæˆToken â†’ å®¢æˆ·ç«¯ä¿å­˜Token
ä¼˜åŠ¿ï¼šæœåŠ¡å™¨ä¸ä¿å­˜ä»»ä½•çŠ¶æ€ï¼Œå¤©ç„¶æ”¯æŒåˆ†å¸ƒå¼
```

**ğŸ’¡ ç”Ÿæ´»åŒ–ç±»æ¯”**

æƒ³è±¡ä½ å»æ¸¸ä¹å›­ï¼š

**æœ‰çŠ¶æ€è®¤è¯**ï¼šåƒåŠä¼šå‘˜å¡
- æ¸¸ä¹å›­è®°å½•ä½ çš„ä¿¡æ¯åœ¨ç³»ç»Ÿé‡Œ
- æ¯æ¬¡ç©é¡¹ç›®è¦åˆ·å¡éªŒè¯
- æ¢ä¸ªæ¸¸ä¹å›­åˆ†åº—ï¼Œå¡å¯èƒ½ä¸è®¤

**æ— çŠ¶æ€è®¤è¯**ï¼šåƒä¹°é€šç¥¨
- ç»™ä½ ä¸€å¼ å¸¦é˜²ä¼ªçš„ç¥¨æ®(Token)
- ç¥¨æ®ä¸Šå†™ç€ä½ çš„æƒé™å’Œæœ‰æ•ˆæœŸ
- ä»»ä½•åˆ†åº—çœ‹ç¥¨å°±çŸ¥é“ä½ èƒ½ç©ä»€ä¹ˆ
- æ¸¸ä¹å›­ä¸éœ€è¦è®°ä½ä½ æ˜¯è°

### 1.2 æ— çŠ¶æ€è®¤è¯çš„ä¼˜åŠ¿



| ç‰¹æ€§ | ä¼ ç»ŸSession | JWTæ— çŠ¶æ€ | è¯´æ˜ |
|------|-----------|----------|------|
| **æœåŠ¡å™¨å‹åŠ›** | â­â­ | â­â­â­â­â­ | æ— éœ€å­˜å‚¨çŠ¶æ€ï¼Œå†…å­˜å ç”¨å°‘ |
| **æ‰©å±•æ€§** | â­â­ | â­â­â­â­â­ | å¤©ç„¶æ”¯æŒé›†ç¾¤å’Œè´Ÿè½½å‡è¡¡ |
| **è·¨åŸŸæ”¯æŒ** | â­â­ | â­â­â­â­â­ | Tokenå¯è·¨åŸŸä¼ é€’ |
| **ç§»åŠ¨ç«¯å‹å¥½** | â­â­â­ | â­â­â­â­â­ | ä¸ä¾èµ–Cookie |
| **å®æ—¶æ³¨é”€** | â­â­â­â­â­ | â­â­â­ | éœ€è¦é¢å¤–æœºåˆ¶å®ç° |

### 1.3 é€‚ç”¨åœºæ™¯åˆ¤æ–­



**âœ… æ¨èä½¿ç”¨æ— çŠ¶æ€è®¤è¯**
- å¾®æœåŠ¡æ¶æ„ç³»ç»Ÿ
- éœ€è¦æ°´å¹³æ‰©å±•çš„åº”ç”¨
- ç§»åŠ¨App/å°ç¨‹åºåç«¯
- è·¨åŸŸAPIæœåŠ¡

**âŒ ä¸æ¨èæ— çŠ¶æ€è®¤è¯**
- éœ€è¦å®æ—¶å¼ºåˆ¶ä¸‹çº¿çš„åœºæ™¯
- å¯¹å®‰å…¨æ€§è¦æ±‚æé«˜çš„é‡‘èç³»ç»Ÿ
- ç”¨æˆ·ä¼šè¯æ•°æ®é‡å¾ˆå¤§çš„åº”ç”¨

---

## 2. ğŸ—ï¸ æ— çŠ¶æ€æœåŠ¡è®¾è®¡åŸç†



### 2.1 æ— çŠ¶æ€è®¾è®¡æ ¸å¿ƒæ€æƒ³



**å…³é”®åŸåˆ™**
```
1ï¸âƒ£ æ‰€æœ‰è®¤è¯ä¿¡æ¯åŒ…å«åœ¨Tokenä¸­
   - ç”¨æˆ·IDã€è§’è‰²ã€æƒé™
   - è¿‡æœŸæ—¶é—´ã€ç­¾å‘æ—¶é—´
   
2ï¸âƒ£ æœåŠ¡å™¨åªéªŒè¯Tokenï¼Œä¸å­˜å‚¨çŠ¶æ€
   - éªŒè¯ç­¾åæ˜¯å¦åˆæ³•
   - æ£€æŸ¥æ˜¯å¦è¿‡æœŸ
   
3ï¸âƒ£ æ¯æ¬¡è¯·æ±‚éƒ½æºå¸¦å®Œæ•´çš„è®¤è¯ä¿¡æ¯
   - è¯·æ±‚å¤´å¸¦Token
   - æœåŠ¡å™¨è§£æTokenè·å–ç”¨æˆ·ä¿¡æ¯
```

**æ¶æ„å¯¹æ¯”å›¾**
```
ä¼ ç»ŸSessionæ¶æ„ï¼š
å®¢æˆ·ç«¯ â†’ æœåŠ¡å™¨1(æŸ¥Session) â†’ Sessionå­˜å‚¨(Redis/DB)
å®¢æˆ·ç«¯ â†’ æœåŠ¡å™¨2(æŸ¥Session) â†’ Sessionå­˜å‚¨(Redis/DB)
é—®é¢˜ï¼šéœ€è¦å…±äº«Sessionå­˜å‚¨

JWTæ— çŠ¶æ€æ¶æ„ï¼š
å®¢æˆ·ç«¯(å¸¦Token) â†’ æœåŠ¡å™¨1(è§£æToken) âœ“
å®¢æˆ·ç«¯(å¸¦Token) â†’ æœåŠ¡å™¨2(è§£æToken) âœ“
ä¼˜åŠ¿ï¼šä»»ä½•æœåŠ¡å™¨éƒ½èƒ½ç‹¬ç«‹éªŒè¯
```

### 2.2 æ— çŠ¶æ€è®¤è¯æµç¨‹



**å®Œæ•´è®¤è¯æµç¨‹**
```
æ­¥éª¤1ï¼šç”¨æˆ·ç™»å½•
ç”¨æˆ· â†’ æäº¤è´¦å·å¯†ç  â†’ æœåŠ¡å™¨éªŒè¯

æ­¥éª¤2ï¼šé¢å‘Token
æœåŠ¡å™¨ â†’ ç”ŸæˆJWT Token â†’ è¿”å›ç»™å®¢æˆ·ç«¯
TokenåŒ…å«ï¼šç”¨æˆ·ä¿¡æ¯ + è¿‡æœŸæ—¶é—´ + ç­¾å

æ­¥éª¤3ï¼šæºå¸¦Tokenè®¿é—®
å®¢æˆ·ç«¯ â†’ è¯·æ±‚å¤´å¸¦Token â†’ æœåŠ¡å™¨

æ­¥éª¤4ï¼šéªŒè¯Token
æœåŠ¡å™¨ â†’ è§£æToken â†’ éªŒè¯ç­¾å â†’ æ£€æŸ¥è¿‡æœŸ
éªŒè¯é€šè¿‡ â†’ æå–ç”¨æˆ·ä¿¡æ¯ â†’ æ‰§è¡Œä¸šåŠ¡é€»è¾‘

æ­¥éª¤5ï¼šTokenåˆ·æ–°ï¼ˆå¯é€‰ï¼‰
Tokenå¿«è¿‡æœŸ â†’ å®¢æˆ·ç«¯è¯·æ±‚åˆ·æ–° â†’ é¢å‘æ–°Token
```

---

## 3. ğŸ« Tokené¢å‘æœºåˆ¶



### 3.1 ç™»å½•è®¤è¯ä¸Tokenç”Ÿæˆ



**åŸºç¡€ç™»å½•æµç¨‹å®ç°**
```java
@RestController
@RequestMapping("/auth")
public class AuthController {
    
    @Autowired
    private JwtTokenProvider tokenProvider;
    
    @Autowired
    private AuthenticationManager authManager;
    
    /**
     * ç”¨æˆ·ç™»å½•æ¥å£
     */
    @PostMapping("/login")
    public ResponseEntity<?> login(@RequestBody LoginRequest request) {
        
        // 1. éªŒè¯ç”¨æˆ·åå¯†ç 
        Authentication auth = authManager.authenticate(
            new UsernamePasswordAuthenticationToken(
                request.getUsername(),
                request.getPassword()
            )
        );
        
        // 2. ç”ŸæˆToken
        String token = tokenProvider.generateToken(auth);
        
        // 3. è¿”å›Tokenç»™å®¢æˆ·ç«¯
        return ResponseEntity.ok(new AuthResponse(token));
    }
}
```

### 3.2 Tokenç”Ÿæˆå™¨å®ç°



**æ ¸å¿ƒTokenç”Ÿæˆé€»è¾‘**
```java
@Component
public class JwtTokenProvider {
    
    // JWTå¯†é’¥ï¼ˆå®é™…åº”è¯¥ä»é…ç½®æ–‡ä»¶è¯»å–ï¼‰
    private String jwtSecret = "your-secret-key";
    
    // Tokenæœ‰æ•ˆæœŸï¼š24å°æ—¶
    private long jwtExpiration = 86400000;
    
    /**
     * ç”ŸæˆJWT Token
     */
    public String generateToken(Authentication auth) {
        
        UserPrincipal userPrincipal = (UserPrincipal) auth.getPrincipal();
        
        Date now = new Date();
        Date expiryDate = new Date(now.getTime() + jwtExpiration);
        
        // æ„å»ºJWT
        return Jwts.builder()
            .setSubject(String.valueOf(userPrincipal.getId()))
            .claim("username", userPrincipal.getUsername())
            .claim("roles", userPrincipal.getAuthorities())
            .setIssuedAt(now)           // ç­¾å‘æ—¶é—´
            .setExpiration(expiryDate)   // è¿‡æœŸæ—¶é—´
            .signWith(SignatureAlgorithm.HS512, jwtSecret)
            .compact();
    }
}
```

**ğŸ’¡ å…³é”®å‚æ•°è¯´æ˜**
- `Subject`ï¼šå­˜æ”¾ç”¨æˆ·IDï¼Œä½œä¸ºTokençš„ä¸»ä½“æ ‡è¯†
- `Claims`ï¼šè‡ªå®šä¹‰æ•°æ®ï¼Œå¦‚ç”¨æˆ·åã€è§’è‰²ç­‰
- `IssuedAt`ï¼šTokenç­¾å‘æ—¶é—´ï¼Œç”¨äºåˆ¤æ–­Tokenæ–°æ—§
- `Expiration`ï¼šè¿‡æœŸæ—¶é—´ï¼Œé˜²æ­¢Tokenæ°¸ä¹…æœ‰æ•ˆ

### 3.3 Tokenå“åº”æ ¼å¼è®¾è®¡



**æ ‡å‡†å“åº”ç»“æ„**
```java
public class AuthResponse {
    private String accessToken;
    private String tokenType = "Bearer";
    private Long expiresIn;  // å‰©ä½™æœ‰æ•ˆæ—¶é—´(ç§’)
    
    // å¯é€‰ï¼šåŒæ—¶è¿”å›åˆ·æ–°Token
    private String refreshToken;
    
    public AuthResponse(String token) {
        this.accessToken = token;
        this.expiresIn = calculateExpiration(token);
    }
}
```

**è¿”å›ç¤ºä¾‹**
```json
{
  "accessToken": "eyJhbGciOiJIUzUxMiJ9...",
  "tokenType": "Bearer",
  "expiresIn": 86400,
  "refreshToken": "refresh_token_value"
}
```

---

## 4. âœ… TokenéªŒè¯æµç¨‹



### 4.1 è¯·æ±‚æ‹¦æˆªä¸Tokenæå–



**JWTè®¤è¯è¿‡æ»¤å™¨**
```java
@Component
public class JwtAuthenticationFilter extends OncePerRequestFilter {
    
    @Autowired
    private JwtTokenProvider tokenProvider;
    
    @Override
    protected void doFilterInternal(
        HttpServletRequest request,
        HttpServletResponse response,
        FilterChain filterChain
    ) throws ServletException, IOException {
        
        try {
            // 1. ä»è¯·æ±‚å¤´æå–Token
            String jwt = getJwtFromRequest(request);
            
            if (StringUtils.hasText(jwt) && tokenProvider.validateToken(jwt)) {
                
                // 2. ä»Tokenä¸­è·å–ç”¨æˆ·ä¿¡æ¯
                Long userId = tokenProvider.getUserIdFromJWT(jwt);
                
                // 3. åŠ è½½ç”¨æˆ·è¯¦ç»†ä¿¡æ¯ï¼ˆå¯é€‰ï¼Œä»æ•°æ®åº“ï¼‰
                UserDetails userDetails = userService.loadUserById(userId);
                
                // 4. åˆ›å»ºè®¤è¯å¯¹è±¡
                UsernamePasswordAuthenticationToken authentication = 
                    new UsernamePasswordAuthenticationToken(
                        userDetails, 
                        null, 
                        userDetails.getAuthorities()
                    );
                
                // 5. è®¾ç½®åˆ°Spring Securityä¸Šä¸‹æ–‡
                SecurityContextHolder.getContext()
                    .setAuthentication(authentication);
            }
        } catch (Exception ex) {
            logger.error("æ— æ³•è®¾ç½®ç”¨æˆ·è®¤è¯", ex);
        }
        
        // ç»§ç»­è¿‡æ»¤é“¾
        filterChain.doFilter(request, response);
    }
    
    /**
     * ä»è¯·æ±‚å¤´è·å–Token
     */
    private String getJwtFromRequest(HttpServletRequest request) {
        String bearerToken = request.getHeader("Authorization");
        
        // æ ¼å¼ï¼šBearer <token>
        if (StringUtils.hasText(bearerToken) && 
            bearerToken.startsWith("Bearer ")) {
            return bearerToken.substring(7);
        }
        
        return null;
    }
}
```

### 4.2 TokenéªŒè¯é€»è¾‘



**Tokenæœ‰æ•ˆæ€§æ ¡éªŒ**
```java
@Component
public class JwtTokenProvider {
    
    /**
     * éªŒè¯Tokenæ˜¯å¦æœ‰æ•ˆ
     */
    public boolean validateToken(String token) {
        try {
            // è§£æToken
            Jwts.parser()
                .setSigningKey(jwtSecret)
                .parseClaimsJws(token);
            
            return true;
            
        } catch (SignatureException ex) {
            logger.error("JWTç­¾åæ— æ•ˆ");
        } catch (MalformedJwtException ex) {
            logger.error("JWTæ ¼å¼é”™è¯¯");
        } catch (ExpiredJwtException ex) {
            logger.error("JWTå·²è¿‡æœŸ");
        } catch (UnsupportedJwtException ex) {
            logger.error("ä¸æ”¯æŒçš„JWT");
        } catch (IllegalArgumentException ex) {
            logger.error("JWTå­—ç¬¦ä¸²ä¸ºç©º");
        }
        
        return false;
    }
    
    /**
     * ä»Tokenä¸­æå–ç”¨æˆ·ID
     */
    public Long getUserIdFromJWT(String token) {
        Claims claims = Jwts.parser()
            .setSigningKey(jwtSecret)
            .parseClaimsJws(token)
            .getBody();
        
        return Long.parseLong(claims.getSubject());
    }
}
```

**ğŸ” éªŒè¯æ£€æŸ¥é¡¹**
- âœ“ ç­¾åéªŒè¯ï¼šTokenæ˜¯å¦è¢«ç¯¡æ”¹
- âœ“ æ ¼å¼æ£€æŸ¥ï¼šTokenç»“æ„æ˜¯å¦æ­£ç¡®
- âœ“ è¿‡æœŸæ£€æŸ¥ï¼šTokenæ˜¯å¦åœ¨æœ‰æ•ˆæœŸå†…
- âœ“ å†…å®¹éªŒè¯ï¼šå¿…è¦å­—æ®µæ˜¯å¦å®Œæ•´

### 4.3 æƒé™éªŒè¯



**åŸºäºTokençš„æƒé™æ£€æŸ¥**
```java
@RestController
@RequestMapping("/api")
public class UserController {
    
    /**
     * éœ€è¦USERè§’è‰²æ‰èƒ½è®¿é—®
     */
    @GetMapping("/user/profile")
    @PreAuthorize("hasRole('USER')")
    public ResponseEntity<?> getUserProfile() {
        // ä»Securityä¸Šä¸‹æ–‡è·å–å½“å‰ç”¨æˆ·
        UserPrincipal currentUser = (UserPrincipal) 
            SecurityContextHolder.getContext()
                .getAuthentication().getPrincipal();
        
        return ResponseEntity.ok(currentUser);
    }
    
    /**
     * éœ€è¦ADMINè§’è‰²æ‰èƒ½è®¿é—®
     */
    @DeleteMapping("/admin/users/{id}")
    @PreAuthorize("hasRole('ADMIN')")
    public ResponseEntity<?> deleteUser(@PathVariable Long id) {
        // ç®¡ç†å‘˜æ“ä½œ
        return ResponseEntity.ok("ç”¨æˆ·å·²åˆ é™¤");
    }
}
```

---

## 5. ğŸ”„ Tokenåˆ·æ–°ç­–ç•¥



### 5.1 ä¸ºä»€ä¹ˆéœ€è¦Tokenåˆ·æ–°



**æ ¸å¿ƒé—®é¢˜**
```
çŸ›ç›¾ç‚¹ï¼š
- Tokenæœ‰æ•ˆæœŸå¤ªé•¿ â†’ å®‰å…¨é£é™©å¤§ï¼ˆTokenæ³„éœ²åé•¿æœŸæœ‰æ•ˆï¼‰
- Tokenæœ‰æ•ˆæœŸå¤ªçŸ­ â†’ ç”¨æˆ·ä½“éªŒå·®ï¼ˆé¢‘ç¹é‡æ–°ç™»å½•ï¼‰

è§£å†³æ–¹æ¡ˆï¼š
ä½¿ç”¨åŒTokenæœºåˆ¶ï¼š
â€¢ Access Tokenï¼šçŸ­æœŸæœ‰æ•ˆï¼ˆ30åˆ†é’Ÿ-2å°æ—¶ï¼‰ï¼Œç”¨äºAPIè®¿é—®
â€¢ Refresh Tokenï¼šé•¿æœŸæœ‰æ•ˆï¼ˆ7å¤©-30å¤©ï¼‰ï¼Œä»…ç”¨äºåˆ·æ–°
```

**ğŸ¯ åŒTokenæµç¨‹**
```
åˆæ¬¡ç™»å½•ï¼š
å®¢æˆ·ç«¯ â†’ ç™»å½• â†’ æœåŠ¡å™¨è¿”å› {
    accessToken: "çŸ­æœŸtoken",
    refreshToken: "é•¿æœŸtoken"
}

è®¿é—®APIï¼š
å®¢æˆ·ç«¯ â†’ æºå¸¦accessToken â†’ è®¿é—®ä¸šåŠ¡æ¥å£

Tokenå¿«è¿‡æœŸï¼š
å®¢æˆ·ç«¯ â†’ æ£€æµ‹åˆ°å¿«è¿‡æœŸ â†’ ç”¨refreshTokenæ¢æ–°çš„accessToken

Tokenè¢«ç›—é£é™©ï¼š
- accessTokenæ³„éœ² â†’ åªæœ‰30åˆ†é’Ÿçª—å£æœŸ
- refreshTokenæ³„éœ² â†’ å¯ä»¥é€šè¿‡é»‘åå•æœºåˆ¶åºŸé™¤
```

### 5.2 åˆ·æ–°Tokenå®ç°



**Tokenåˆ·æ–°æ¥å£**
```java
@RestController
@RequestMapping("/auth")
public class AuthController {
    
    /**
     * åˆ·æ–°Access Token
     */
    @PostMapping("/refresh")
    public ResponseEntity<?> refreshToken(
        @RequestBody TokenRefreshRequest request
    ) {
        String refreshToken = request.getRefreshToken();
        
        // 1. éªŒè¯Refresh Token
        if (!tokenProvider.validateToken(refreshToken)) {
            throw new TokenRefreshException("Refresh Tokenæ— æ•ˆ");
        }
        
        // 2. æ£€æŸ¥æ˜¯å¦åœ¨é»‘åå•ä¸­
        if (tokenBlacklistService.isBlacklisted(refreshToken)) {
            throw new TokenRefreshException("Tokenå·²è¢«ç¦ç”¨");
        }
        
        // 3. æå–ç”¨æˆ·ä¿¡æ¯
        Long userId = tokenProvider.getUserIdFromJWT(refreshToken);
        
        // 4. ç”Ÿæˆæ–°çš„Access Token
        UserDetails userDetails = userService.loadUserById(userId);
        String newAccessToken = tokenProvider.generateAccessToken(userDetails);
        
        // 5. å¯é€‰ï¼šè½®æ¢Refresh Tokenï¼ˆæ›´å®‰å…¨ï¼‰
        String newRefreshToken = tokenProvider.generateRefreshToken(userDetails);
        
        return ResponseEntity.ok(new TokenRefreshResponse(
            newAccessToken,
            newRefreshToken
        ));
    }
}
```

### 5.3 å®¢æˆ·ç«¯åˆ·æ–°ç­–ç•¥



**å‰ç«¯è‡ªåŠ¨åˆ·æ–°é€»è¾‘**
```javascript
// Tokenç®¡ç†å·¥å…·ç±»
class TokenManager {
    
    // æ£€æŸ¥Tokenæ˜¯å¦å¿«è¿‡æœŸï¼ˆæå‰5åˆ†é’Ÿåˆ·æ–°ï¼‰
    isTokenExpiringSoon(token) {
        const payload = JSON.parse(atob(token.split('.')[1]));
        const expiryTime = payload.exp * 1000;
        const currentTime = Date.now();
        const timeLeft = expiryTime - currentTime;
        
        return timeLeft < 5 * 60 * 1000; // 5åˆ†é’Ÿ
    }
    
    // è‡ªåŠ¨åˆ·æ–°Token
    async autoRefreshToken() {
        const accessToken = localStorage.getItem('accessToken');
        const refreshToken = localStorage.getItem('refreshToken');
        
        if (this.isTokenExpiringSoon(accessToken)) {
            try {
                const response = await fetch('/auth/refresh', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ refreshToken })
                });
                
                const data = await response.json();
                
                // æ›´æ–°æœ¬åœ°Token
                localStorage.setItem('accessToken', data.accessToken);
                localStorage.setItem('refreshToken', data.refreshToken);
                
                console.log('Tokenåˆ·æ–°æˆåŠŸ');
            } catch (error) {
                console.error('Tokenåˆ·æ–°å¤±è´¥ï¼Œéœ€è¦é‡æ–°ç™»å½•');
                this.logout();
            }
        }
    }
}
```

**ğŸ’¡ åˆ·æ–°æ—¶æœºé€‰æ‹©**
- âœ“ **é™é»˜åˆ·æ–°**ï¼šåå°å®šæ—¶æ£€æŸ¥ï¼Œå¿«è¿‡æœŸæ—¶è‡ªåŠ¨åˆ·æ–°
- âœ“ **è¯·æ±‚æ‹¦æˆªåˆ·æ–°**ï¼šAPIè¿”å›401æ—¶å°è¯•åˆ·æ–°åé‡è¯•
- âœ“ **ä¸»åŠ¨åˆ·æ–°**ï¼šç”¨æˆ·æ“ä½œå‰æ£€æŸ¥å¹¶åˆ·æ–°

---

## 6. ğŸš« é»‘åå•æœºåˆ¶



### 6.1 ä¸ºä»€ä¹ˆéœ€è¦é»‘åå•



**æ ¸å¿ƒé—®é¢˜**
```
JWTçš„å¤©ç”Ÿç¼ºé™·ï¼š
Tokenä¸€æ—¦é¢å‘ï¼Œåœ¨è¿‡æœŸå‰æ— æ³•æ’¤é”€

éœ€è¦å³æ—¶æ³¨é”€çš„åœºæ™¯ï¼š
â€¢ ç”¨æˆ·ä¸»åŠ¨ç™»å‡º
â€¢ æ£€æµ‹åˆ°è´¦å·å¼‚å¸¸
â€¢ ç®¡ç†å‘˜å¼ºåˆ¶ä¸‹çº¿
â€¢ ä¿®æ”¹å¯†ç åæ—§Tokenå¤±æ•ˆ
```

**âš ï¸ æ— é»‘åå•çš„é£é™©**
```
åœºæ™¯ï¼šç”¨æˆ·ä¿®æ”¹å¯†ç 
1. ç”¨æˆ·ä¿®æ”¹å¯†ç  â†’ æœåŠ¡å™¨æ›´æ–°æ•°æ®åº“
2. æ—§Tokenä»ç„¶æœ‰æ•ˆï¼ˆå› ä¸ºJWTæ˜¯è‡ªåŒ…å«çš„ï¼‰
3. æ”»å‡»è€…ç”¨æ—§Tokenç»§ç»­è®¿é—® â†’ å®‰å…¨æ¼æ´ï¼

è§£å†³ï¼šTokené»‘åå•æœºåˆ¶
ä¿®æ”¹å¯†ç  â†’ å°†æ—§TokenåŠ å…¥é»‘åå• â†’ æ—§Tokenè¢«æ‹¦æˆª
```

### 6.2 é»‘åå•å®ç°æ–¹æ¡ˆ



**åŸºäºRedisçš„é»‘åå•**
```java
@Service
public class TokenBlacklistService {
    
    @Autowired
    private RedisTemplate<String, String> redisTemplate;
    
    /**
     * å°†TokenåŠ å…¥é»‘åå•
     */
    public void addToBlacklist(String token) {
        try {
            // 1. è§£æTokenè·å–è¿‡æœŸæ—¶é—´
            Claims claims = Jwts.parser()
                .setSigningKey(jwtSecret)
                .parseClaimsJws(token)
                .getBody();
            
            Date expiration = claims.getExpiration();
            
            // 2. è®¡ç®—å‰©ä½™æœ‰æ•ˆæ—¶é—´
            long ttl = expiration.getTime() - System.currentTimeMillis();
            
            if (ttl > 0) {
                // 3. å­˜å…¥Redisï¼Œè¿‡æœŸè‡ªåŠ¨åˆ é™¤
                redisTemplate.opsForValue().set(
                    "blacklist:" + token,
                    "revoked",
                    ttl,
                    TimeUnit.MILLISECONDS
                );
            }
            
        } catch (Exception e) {
            logger.error("åŠ å…¥é»‘åå•å¤±è´¥", e);
        }
    }
    
    /**
     * æ£€æŸ¥Tokenæ˜¯å¦åœ¨é»‘åå•ä¸­
     */
    public boolean isBlacklisted(String token) {
        String key = "blacklist:" + token;
        return redisTemplate.hasKey(key);
    }
    
    /**
     * ç”¨æˆ·ç™»å‡ºæ—¶è°ƒç”¨
     */
    public void logout(String token) {
        addToBlacklist(token);
    }
}
```

### 6.3 é»‘åå•ä¼˜åŒ–ç­–ç•¥



**æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ**
```java
/**
 * æ–¹æ¡ˆ1ï¼šåªå­˜å‚¨Tokençš„å”¯ä¸€æ ‡è¯†(JTI)è€Œéå®Œæ•´Token
 */
public String generateTokenWithJTI(Authentication auth) {
    String jti = UUID.randomUUID().toString(); // Tokenå”¯ä¸€ID
    
    return Jwts.builder()
        .setId(jti)  // è®¾ç½®JTI
        .setSubject(userId)
        // ... å…¶ä»–è®¾ç½®
        .compact();
}

// é»‘åå•åªéœ€å­˜å‚¨JTI
public void addJtiToBlacklist(String jti, long ttl) {
    redisTemplate.opsForValue().set(
        "blacklist:jti:" + jti,
        "1",
        ttl,
        TimeUnit.MILLISECONDS
    );
}
```

**æ‰¹é‡å¤±æ•ˆæ–¹æ¡ˆ**
```java
/**
 * æ–¹æ¡ˆ2ï¼šåŸºäºç‰ˆæœ¬å·çš„å¤±æ•ˆæœºåˆ¶
 */
@Entity
public class User {
    private Long id;
    private String username;
    private Integer tokenVersion = 0; // Tokenç‰ˆæœ¬å·
}

// ä¿®æ”¹å¯†ç æ—¶é€’å¢ç‰ˆæœ¬å·
public void changePassword(Long userId, String newPassword) {
    User user = userRepository.findById(userId);
    user.setPassword(newPassword);
    user.setTokenVersion(user.getTokenVersion() + 1);
    userRepository.save(user);
}

// Tokenä¸­åŒ…å«ç‰ˆæœ¬å·
public String generateToken(User user) {
    return Jwts.builder()
        .claim("tokenVersion", user.getTokenVersion())
        // ...
        .compact();
}

// éªŒè¯æ—¶æ£€æŸ¥ç‰ˆæœ¬å·
public boolean validateTokenVersion(String token, Long userId) {
    Claims claims = parseToken(token);
    Integer tokenVersion = claims.get("tokenVersion", Integer.class);
    
    User user = userRepository.findById(userId);
    return tokenVersion.equals(user.getTokenVersion());
}
```

---

## 7. ğŸ’¾ Tokenå­˜å‚¨ç­–ç•¥



### 7.1 å®¢æˆ·ç«¯å­˜å‚¨æ–¹å¼å¯¹æ¯”



| å­˜å‚¨æ–¹å¼ | å®‰å…¨æ€§ | ä¾¿åˆ©æ€§ | XSSé£é™© | CSRFé£é™© | é€‚ç”¨åœºæ™¯ |
|---------|-------|-------|---------|----------|---------|
| **LocalStorage** | â­â­ | â­â­â­â­â­ | âŒ é«˜ | âœ… æ—  | SPAåº”ç”¨ |
| **SessionStorage** | â­â­ | â­â­â­â­ | âŒ é«˜ | âœ… æ—  | ä¸´æ—¶ä¼šè¯ |
| **Cookie(HttpOnly)** | â­â­â­â­ | â­â­â­ | âœ… æ—  | âŒ æœ‰ | ä¼ ç»ŸWeb |
| **å†…å­˜å˜é‡** | â­â­â­â­â­ | â­â­ | âœ… æ—  | âœ… æ—  | é«˜å®‰å…¨åº”ç”¨ |

**ğŸ’¡ å­˜å‚¨å»ºè®®**

**æ–¹æ¡ˆ1ï¼šLocalStorageï¼ˆå¸¸ç”¨ï¼‰**
```javascript
// ä¼˜ç‚¹ï¼šç®€å•æ–¹ä¾¿ï¼Œä¸ä¼šè¿‡æœŸ
// ç¼ºç‚¹ï¼šå®¹æ˜“è¢«XSSæ”»å‡»çªƒå–

// å­˜å‚¨
localStorage.setItem('accessToken', token);

// ä½¿ç”¨
const token = localStorage.getItem('accessToken');
fetch('/api/data', {
    headers: {
        'Authorization': `Bearer ${token}`
    }
});
```

**æ–¹æ¡ˆ2ï¼šHttpOnly Cookieï¼ˆæ›´å®‰å…¨ï¼‰**
```java
// åç«¯è®¾ç½®Cookie
@PostMapping("/login")
public ResponseEntity<?> login(...) {
    String token = generateToken(...);
    
    // è®¾ç½®HttpOnly Cookie
    Cookie cookie = new Cookie("jwt", token);
    cookie.setHttpOnly(true);  // é˜²æ­¢JSè®¿é—®
    cookie.setSecure(true);    // ä»…HTTPSä¼ è¾“
    cookie.setPath("/");
    cookie.setMaxAge(86400);   // 24å°æ—¶
    
    response.addCookie(cookie);
    return ResponseEntity.ok("ç™»å½•æˆåŠŸ");
}
```

**æ–¹æ¡ˆ3ï¼šåŒå­˜å‚¨ï¼ˆæœ€ä½³å®è·µï¼‰**
```
ç»„åˆç­–ç•¥ï¼š
â€¢ Access Token â†’ å†…å­˜å˜é‡ï¼ˆä»…å½“å‰ä¼šè¯ï¼‰
â€¢ Refresh Token â†’ HttpOnly Cookieï¼ˆé•¿æœŸå­˜å‚¨ï¼‰

ä¼˜åŠ¿ï¼š
- Access Tokenä¸æŒä¹…åŒ–ï¼Œåˆ·æ–°é¡µé¢éœ€é‡æ–°ç™»å½•æˆ–ç”¨Refresh Tokenè·å–
- Refresh Tokenåœ¨HttpOnly Cookieä¸­ï¼ŒJSæ— æ³•è®¿é—®
- å¹³è¡¡äº†å®‰å…¨æ€§å’Œç”¨æˆ·ä½“éªŒ
```

### 7.2 æœåŠ¡ç«¯ç¼“å­˜ç­–ç•¥



**Tokenä¿¡æ¯ç¼“å­˜**
```java
@Service
public class TokenCacheService {
    
    @Autowired
    private RedisTemplate<String, UserDetails> redisTemplate;
    
    /**
     * ç¼“å­˜ç”¨æˆ·ä¿¡æ¯ï¼Œé¿å…æ¯æ¬¡éƒ½æŸ¥æ•°æ®åº“
     */
    public void cacheUserDetails(String token, UserDetails user) {
        String key = "token:user:" + token;
        
        // ç¼“å­˜æ—¶é—´ç•¥çŸ­äºTokenæœ‰æ•ˆæœŸ
        redisTemplate.opsForValue().set(
            key,
            user,
            30,
            TimeUnit.MINUTES
        );
    }
    
    /**
     * è·å–ç¼“å­˜çš„ç”¨æˆ·ä¿¡æ¯
     */
    public UserDetails getCachedUserDetails(String token) {
        String key = "token:user:" + token;
        return redisTemplate.opsForValue().get(key);
    }
}
```

**ğŸ” ç¼“å­˜ç­–ç•¥è¯´æ˜**
- âœ“ **é¦–æ¬¡éªŒè¯**ï¼šè§£æToken â†’ æŸ¥è¯¢æ•°æ®åº“ â†’ ç¼“å­˜ç»“æœ
- âœ“ **åç»­è¯·æ±‚**ï¼šç›´æ¥ä»ç¼“å­˜è¯»å–ç”¨æˆ·ä¿¡æ¯
- âœ“ **ç¼“å­˜è¿‡æœŸ**ï¼šè‡ªåŠ¨é‡æ–°åŠ è½½
- âœ“ **ç”¨æˆ·ä¿¡æ¯å˜æ›´**ï¼šæ‰‹åŠ¨æ¸…é™¤ç¼“å­˜

---

## 8. âš¡ æ€§èƒ½ä¼˜åŒ–è€ƒè™‘



### 8.1 Tokenè§£ææ€§èƒ½ä¼˜åŒ–



**ä¼˜åŒ–ç‚¹åˆ†æ**
```
æ€§èƒ½ç“¶é¢ˆï¼š
æ¯æ¬¡è¯·æ±‚éƒ½è¦ï¼š
1. è§£æJWTå­—ç¬¦ä¸²
2. éªŒè¯ç­¾å
3. ååºåˆ—åŒ–Claims

ä¼˜åŒ–æ–¹æ¡ˆï¼š
1. ä½¿ç”¨é«˜æ€§èƒ½JWTåº“ï¼ˆå¦‚JJWTï¼‰
2. ç¼“å­˜è§£æç»“æœ
3. å¼‚æ­¥éªŒè¯éå…³é”®è·¯å¾„
```

**ç¼“å­˜è§£æç»“æœ**
```java
@Component
public class OptimizedJwtProvider {
    
    // ä½¿ç”¨Caffeineæœ¬åœ°ç¼“å­˜
    private Cache<String, Claims> claimsCache = Caffeine.newBuilder()
        .maximumSize(10000)
        .expireAfterWrite(5, TimeUnit.MINUTES)
        .build();
    
    /**
     * å¸¦ç¼“å­˜çš„Tokenè§£æ
     */
    public Claims parseTokenWithCache(String token) {
        return claimsCache.get(token, this::parseTokenInternal);
    }
    
    private Claims parseTokenInternal(String token) {
        return Jwts.parser()
            .setSigningKey(jwtSecret)
            .parseClaimsJws(token)
            .getBody();
    }
}
```

### 8.2 æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–



**å‡å°‘æ•°æ®åº“è®¿é—®**
```java
/**
 * ä¼˜åŒ–å‰ï¼šæ¯æ¬¡è¯·æ±‚éƒ½æŸ¥æ•°æ®åº“
 */
public UserDetails loadUserById(Long userId) {
    return userRepository.findById(userId)
        .orElseThrow(() -> new ResourceNotFoundException("ç”¨æˆ·ä¸å­˜åœ¨"));
}

/**
 * ä¼˜åŒ–åï¼šå¤šçº§ç¼“å­˜ç­–ç•¥
 */
@Service
public class CachedUserService {
    
    @Autowired
    private UserRepository userRepository;
    
    @Autowired
    private RedisTemplate redisTemplate;
    
    @Cacheable(value = "users", key = "#userId")
    public UserDetails loadUserById(Long userId) {
        // Spring Cacheè‡ªåŠ¨ç®¡ç†ç¼“å­˜
        return userRepository.findById(userId)
            .map(this::convertToUserDetails)
            .orElseThrow(() -> new ResourceNotFoundException("ç”¨æˆ·ä¸å­˜åœ¨"));
    }
    
    // ç”¨æˆ·ä¿¡æ¯å˜æ›´æ—¶æ¸…é™¤ç¼“å­˜
    @CacheEvict(value = "users", key = "#userId")
    public void updateUser(Long userId, UserUpdateDTO dto) {
        // æ›´æ–°ç”¨æˆ·ä¿¡æ¯
    }
}
```

### 8.3 é»‘åå•æ€§èƒ½ä¼˜åŒ–



**å¸ƒéš†è¿‡æ»¤å™¨ä¼˜åŒ–**
```java
/**
 * ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨å¿«é€Ÿåˆ¤æ–­Tokenæ˜¯å¦å¯èƒ½åœ¨é»‘åå•ä¸­
 */
@Component
public class BloomFilterBlacklist {
    
    private BloomFilter<String> bloomFilter;
    
    @Autowired
    private RedisTemplate<String, String> redisTemplate;
    
    @PostConstruct
    public void init() {
        // åˆå§‹åŒ–å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆé¢„è®¡10ä¸‡ä¸ªTokenï¼Œ1%è¯¯åˆ¤ç‡ï¼‰
        bloomFilter = BloomFilter.create(
            Funnels.stringFunnel(Charset.defaultCharset()),
            100000,
            0.01
        );
    }
    
    /**
     * ä¸¤å±‚æ£€æŸ¥æœºåˆ¶
     */
    public boolean isBlacklisted(String token) {
        // ç¬¬ä¸€å±‚ï¼šå¸ƒéš†è¿‡æ»¤å™¨å¿«é€Ÿåˆ¤æ–­
        if (!bloomFilter.mightContain(token)) {
            return false; // 100%ç¡®å®šä¸åœ¨é»‘åå•
        }
        
        // ç¬¬äºŒå±‚ï¼šRedisç²¾ç¡®æŸ¥è¯¢
        return redisTemplate.hasKey("blacklist:" + token);
    }
    
    public void addToBlacklist(String token) {
        bloomFilter.put(token);
        // ... Redisæ“ä½œ
    }
}
```

**ğŸ’¡ æ€§èƒ½æå‡æ•ˆæœ**
- å¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­ï¼šO(k)ï¼Œkä¸ºå“ˆå¸Œå‡½æ•°ä¸ªæ•°ï¼Œé€šå¸¸<10
- é¿å…90%+çš„RedisæŸ¥è¯¢
- å†…å­˜å ç”¨æå°ï¼ˆ10ä¸‡Tokençº¦120KBï¼‰

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“



### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ



```
ğŸ”¸ æ— çŠ¶æ€è®¤è¯æœ¬è´¨ï¼šæœåŠ¡å™¨ä¸ä¿å­˜çŠ¶æ€ï¼ŒTokenè‡ªåŒ…å«æ‰€æœ‰ä¿¡æ¯
ğŸ”¸ åŒTokenæœºåˆ¶ï¼šAccess TokençŸ­æœŸ + Refresh Tokené•¿æœŸ
ğŸ”¸ TokenéªŒè¯ï¼šç­¾åéªŒè¯ â†’ è¿‡æœŸæ£€æŸ¥ â†’ é»‘åå•æ£€æŸ¥
ğŸ”¸ é»‘åå•å¿…è¦æ€§ï¼šå®ç°Tokenå³æ—¶æ’¤é”€èƒ½åŠ›
ğŸ”¸ å­˜å‚¨ç­–ç•¥ï¼šå‰ç«¯å®‰å…¨å­˜å‚¨ + åç«¯ç¼“å­˜ä¼˜åŒ–
ğŸ”¸ æ€§èƒ½ä¼˜åŒ–ï¼šç¼“å­˜è§£æç»“æœ + å¸ƒéš†è¿‡æ»¤å™¨ + å‡å°‘DBæŸ¥è¯¢
```

### 9.2 æ¶æ„è®¾è®¡å…³é”®ç‚¹



**ğŸ¯ å®Œæ•´è®¤è¯æµç¨‹**
```
ç™»å½•é˜¶æ®µï¼š
1. éªŒè¯ç”¨æˆ·åå¯†ç 
2. ç”ŸæˆåŒTokenï¼ˆAccess + Refreshï¼‰
3. è¿”å›ç»™å®¢æˆ·ç«¯

è¯·æ±‚é˜¶æ®µï¼š
1. å®¢æˆ·ç«¯æºå¸¦Access Token
2. è¿‡æ»¤å™¨æå–å¹¶éªŒè¯Token
3. æ£€æŸ¥é»‘åå•
4. æå–ç”¨æˆ·ä¿¡æ¯åˆ°SecurityContext
5. æ‰§è¡Œä¸šåŠ¡é€»è¾‘

åˆ·æ–°é˜¶æ®µï¼š
1. Access Tokenå¿«è¿‡æœŸ
2. ç”¨Refresh Tokenæ¢æ–°Token
3. å¯é€‰æ‹©è½®æ¢Refresh Token

ç™»å‡ºé˜¶æ®µï¼š
1. å°†TokenåŠ å…¥é»‘åå•
2. æ¸…é™¤å®¢æˆ·ç«¯å­˜å‚¨
```

### 9.3 å®‰å…¨æœ€ä½³å®è·µ



**âœ… å¿…åšçš„å®‰å…¨æªæ–½**
- ä½¿ç”¨HTTPSä¼ è¾“Token
- è®¾ç½®åˆç†çš„Tokenæœ‰æ•ˆæœŸ
- å®ç°Tokené»‘åå•æœºåˆ¶
- æ•æ„Ÿæ“ä½œè¦æ±‚é‡æ–°è®¤è¯
- å®šæœŸè½®æ¢JWTå¯†é’¥

**âš ï¸ å¸¸è§å®‰å…¨é™·é˜±**
- âŒ Tokenæœ‰æ•ˆæœŸè¿‡é•¿ï¼ˆè¶…è¿‡24å°æ—¶ï¼‰
- âŒ åœ¨URLå‚æ•°ä¸­ä¼ é€’Token
- âŒ æœªå®ç°Tokenåˆ·æ–°æœºåˆ¶
- âŒ å¿½ç•¥Tokené»‘åå•
- âŒ å¯†é’¥ç¡¬ç¼–ç åœ¨ä»£ç ä¸­

### 9.4 å­¦ä¹ æ£€æŸ¥æ¸…å•



**ğŸ“ çŸ¥è¯†æŒæ¡æ£€æŸ¥**
- [ ] ç†è§£æ— çŠ¶æ€è®¤è¯çš„å·¥ä½œåŸç†
- [ ] èƒ½å®ç°JWTçš„ç”Ÿæˆå’ŒéªŒè¯
- [ ] æŒæ¡åŒTokenæœºåˆ¶çš„è®¾è®¡
- [ ] ä¼šå®ç°Tokenåˆ·æ–°åŠŸèƒ½
- [ ] ç†è§£é»‘åå•çš„å¿…è¦æ€§å’Œå®ç°
- [ ] äº†è§£Tokençš„å®‰å…¨å­˜å‚¨æ–¹å¼
- [ ] çŸ¥é“å¦‚ä½•ä¼˜åŒ–TokenéªŒè¯æ€§èƒ½

**ğŸ”§ å®è·µèƒ½åŠ›æ£€æŸ¥**
- [ ] èƒ½æ­å»ºå®Œæ•´çš„JWTè®¤è¯ç³»ç»Ÿ
- [ ] èƒ½å¤„ç†Tokenè¿‡æœŸçš„å„ç§åœºæ™¯
- [ ] èƒ½å®ç°ç”¨æˆ·ç™»å‡ºåŠŸèƒ½
- [ ] ä¼šé…ç½®Spring Security JWTè¿‡æ»¤å™¨
- [ ] èƒ½ä¼˜åŒ–TokenéªŒè¯çš„æ€§èƒ½

**ğŸ”‘ æ ¸å¿ƒè®°å¿†å£è¯€**
```
æ— çŠ¶æ€è®¤è¯ä¸å­˜çŠ¶æ€ï¼ŒTokenè‡ªåŒ…å«ä¿¡æ¯å…¨
åŒTokenè®¾è®¡ä¿å®‰å…¨ï¼ŒçŸ­æœŸè®¿é—®é•¿æœŸæ¢
é»‘åå•æœºåˆ¶å¾ˆé‡è¦,å³æ—¶æ’¤é”€ä¸èƒ½å°‘
å®‰å…¨å­˜å‚¨è¦è®°ç‰¢ï¼Œæ€§èƒ½ä¼˜åŒ–ä¸èƒ½å¿˜
```

**ğŸ’¡ å¸¸è§é—®é¢˜ç­”ç–‘**

**Q1ï¼šTokenè¿‡æœŸäº†ç”¨æˆ·æ­£åœ¨æ“ä½œæ€ä¹ˆåŠï¼Ÿ**
Aï¼šä½¿ç”¨é™é»˜åˆ·æ–°æœºåˆ¶ï¼Œåœ¨Tokenå¿«è¿‡æœŸæ—¶è‡ªåŠ¨ç”¨Refresh Tokenæ¢æ–°çš„ï¼Œç”¨æˆ·æ— æ„ŸçŸ¥ã€‚

**Q2ï¼šç”¨æˆ·ä¿®æ”¹å¯†ç åæ—§Tokenè¿˜èƒ½ç”¨å—ï¼Ÿ**
Aï¼šå¿…é¡»åŠ å…¥é»‘åå•ï¼Œæˆ–ä½¿ç”¨Tokenç‰ˆæœ¬å·æœºåˆ¶è‡ªåŠ¨å¤±æ•ˆæ—§Tokenã€‚

**Q3ï¼šTokenå­˜åœ¨å“ªé‡Œæœ€å®‰å…¨ï¼Ÿ**
Aï¼šHttpOnly Cookieæœ€å®‰å…¨ï¼ˆé˜²XSSï¼‰ï¼Œä½†è¦æ³¨æ„CSRFé˜²æŠ¤ï¼›å†…å­˜å˜é‡æœ€å®‰å…¨ä½†åˆ·æ–°é¡µé¢ä¼šä¸¢å¤±ã€‚

**Q4ï¼šTokenè¢«ç›—ç”¨äº†æ€ä¹ˆåŠï¼Ÿ**
Aï¼šåŠæ—¶æ£€æµ‹å¼‚å¸¸ï¼ˆå¦‚IPå˜åŒ–ï¼‰â†’ å°†TokenåŠ å…¥é»‘åå• â†’ é€šçŸ¥ç”¨æˆ·ä¿®æ”¹å¯†ç  â†’ ç”Ÿæˆæ–°Tokenã€‚

**ğŸš€ è¿›é˜¶å­¦ä¹ æ–¹å‘**
- OAuth2.0æˆæƒæ¡†æ¶
- å•ç‚¹ç™»å½•(SSO)å®ç°
- å¾®æœåŠ¡é—´Tokenä¼ é€’
- åˆ†å¸ƒå¼Sessionæ–¹æ¡ˆå¯¹æ¯”