---
title: 2ã€å¾®æœåŠ¡ç»Ÿä¸€è®¤è¯æ¡ˆä¾‹
---
## ğŸ“š ç›®å½•

1. [ç»Ÿä¸€è®¤è¯æ¶æ„æ¦‚è¿°](#1-ç»Ÿä¸€è®¤è¯æ¶æ„æ¦‚è¿°)
2. [Spring Cloud Gateway + OAuth2é›†æˆ](#2-Spring-Cloud-Gateway-OAuth2é›†æˆ)
3. [ç»Ÿä¸€è®¤è¯æˆæƒä¸­å¿ƒå®ç°](#3-ç»Ÿä¸€è®¤è¯æˆæƒä¸­å¿ƒå®ç°)
4. [å¾®æœåŠ¡Tokenç»Ÿä¸€ç®¡ç†](#4-å¾®æœåŠ¡Tokenç»Ÿä¸€ç®¡ç†)
5. [æœåŠ¡é—´å®‰å…¨é€šä¿¡](#5-æœåŠ¡é—´å®‰å…¨é€šä¿¡)
6. [åŸºç¡€è®¾æ–½å®‰å…¨åŠ å›º](#6-åŸºç¡€è®¾æ–½å®‰å…¨åŠ å›º)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ—ï¸ ç»Ÿä¸€è®¤è¯æ¶æ„æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ç»Ÿä¸€è®¤è¯


**é€šä¿—ç†è§£**ï¼š
æƒ³è±¡ä¸€ä¸ªå¤§å‹å•†åœºï¼Œé‡Œé¢æœ‰å¾ˆå¤šåº—é“ºï¼ˆå¾®æœåŠ¡ï¼‰ã€‚å¦‚æœæ¯ä¸ªåº—é“ºéƒ½è¦é¡¾å®¢å‡ºç¤ºèº«ä»½è¯ã€ä¼šå‘˜å¡ï¼Œä¼šå¾ˆéº»çƒ¦ã€‚æ›´å¥½çš„æ–¹å¼æ˜¯ï¼š**å•†åœºå…¥å£æœ‰ä¸€ä¸ªç»Ÿä¸€çš„ä¼šå‘˜ä¸­å¿ƒ**ï¼Œé¡¾å®¢åœ¨è¿™é‡ŒéªŒè¯ä¸€æ¬¡èº«ä»½ï¼Œæ‹¿åˆ°ä¸€ä¸ª"é€šè¡Œè¯"ï¼ˆTokenï¼‰ï¼Œç„¶ååœ¨å•†åœºå†…çš„æ‰€æœ‰åº—é“ºéƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªé€šè¡Œè¯ï¼Œä¸ç”¨é‡å¤éªŒè¯ã€‚

```
ä¼ ç»Ÿæ–¹å¼ï¼ˆæ¯ä¸ªæœåŠ¡ç‹¬ç«‹è®¤è¯ï¼‰ï¼š
ç”¨æˆ· â†’ è®¢å•æœåŠ¡ â†’ éªŒè¯ç”¨æˆ·åå¯†ç  âŒ
ç”¨æˆ· â†’ å•†å“æœåŠ¡ â†’ éªŒè¯ç”¨æˆ·åå¯†ç  âŒ
ç”¨æˆ· â†’ æ”¯ä»˜æœåŠ¡ â†’ éªŒè¯ç”¨æˆ·åå¯†ç  âŒ
é—®é¢˜ï¼šé‡å¤éªŒè¯ï¼Œä½“éªŒå·®ï¼Œä¸å®‰å…¨

ç»Ÿä¸€è®¤è¯æ–¹å¼ï¼š
ç”¨æˆ· â†’ è®¤è¯ä¸­å¿ƒ â†’ éªŒè¯ä¸€æ¬¡ â†’ é¢å‘Token âœ…
     â†’ è®¢å•æœåŠ¡ â†’ éªŒè¯Token âœ…
     â†’ å•†å“æœåŠ¡ â†’ éªŒè¯Token âœ…
     â†’ æ”¯ä»˜æœåŠ¡ â†’ éªŒè¯Token âœ…
ä¼˜åŠ¿ï¼šä¸€æ¬¡è®¤è¯ï¼Œå¤„å¤„é€šè¡Œ
```

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
- **è®¤è¯ä¸­å¿ƒ**ï¼šä¸“é—¨è´Ÿè´£éªŒè¯ç”¨æˆ·èº«ä»½çš„æœåŠ¡ï¼Œå°±åƒå•†åœºçš„ä¼šå‘˜ä¸­å¿ƒ
- **Tokenï¼ˆä»¤ç‰Œï¼‰**ï¼šè®¤è¯æˆåŠŸåé¢å‘çš„"é€šè¡Œè¯"ï¼ŒåŒ…å«ç”¨æˆ·èº«ä»½ä¿¡æ¯
- **ç½‘å…³**ï¼šå•†åœºçš„"å¤§é—¨"ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½è¦ç»è¿‡ï¼Œè´Ÿè´£ç»Ÿä¸€éªŒè¯Token
- **èµ„æºæœåŠ¡å™¨**ï¼šå…·ä½“çš„ä¸šåŠ¡æœåŠ¡ï¼Œä¿¡ä»»ç½‘å…³éªŒè¯è¿‡çš„è¯·æ±‚

### 1.2 ç»Ÿä¸€è®¤è¯æ¶æ„è®¾è®¡


**æ•´ä½“æ¶æ„å›¾**ï¼š
```
                        ã€å®¢æˆ·ç«¯ã€‘
                           |
                    [1] è¯·æ±‚ç™»å½•
                           â†“
                    ã€ç½‘å…³ Gatewayã€‘
                           |
                    [2] è½¬å‘åˆ°è®¤è¯ä¸­å¿ƒ
                           â†“
              ã€è®¤è¯æˆæƒä¸­å¿ƒ Auth Serverã€‘
                           |
                    [3] éªŒè¯ç”¨æˆ·åå¯†ç 
                           |
                    [4] é¢å‘JWT Token
                           â†“
                    ã€ç½‘å…³ Gatewayã€‘
                           |
                    [5] è¿”å›Tokenç»™å®¢æˆ·ç«¯
                           â†“
                        ã€å®¢æˆ·ç«¯ã€‘
                           |
              [6] æºå¸¦Tokenè®¿é—®ä¸šåŠ¡æœåŠ¡
                           â†“
                    ã€ç½‘å…³ Gatewayã€‘
                           |
                    [7] éªŒè¯Token
                           |
                    [8] æå–ç”¨æˆ·ä¿¡æ¯
                           â†“
              ã€å„ä¸ªå¾®æœåŠ¡ - èµ„æºæœåŠ¡å™¨ã€‘
               è®¢å•æœåŠ¡ | å•†å“æœåŠ¡ | ç”¨æˆ·æœåŠ¡
```

**æ¶æ„å±‚çº§è¯´æ˜**ï¼š

| å±‚çº§ | ç»„ä»¶ | èŒè´£ | ç±»æ¯”è¯´æ˜ |
|------|------|------|----------|
| **æ¥å…¥å±‚** | `Spring Cloud Gateway` | ç»Ÿä¸€å…¥å£ï¼ŒéªŒè¯Token | å•†åœºå¤§é—¨çš„ä¿å®‰ |
| **è®¤è¯å±‚** | `OAuth2è®¤è¯ä¸­å¿ƒ` | éªŒè¯ç”¨æˆ·èº«ä»½ï¼Œé¢å‘Token | ä¼šå‘˜ä¸­å¿ƒçš„å·¥ä½œäººå‘˜ |
| **ä¸šåŠ¡å±‚** | `å„ä¸ªå¾®æœåŠ¡` | å¤„ç†å…·ä½“ä¸šåŠ¡é€»è¾‘ | å•†åœºé‡Œçš„å„ä¸ªåº—é“º |
| **åŸºç¡€å±‚** | `é…ç½®ä¸­å¿ƒã€æ³¨å†Œä¸­å¿ƒ` | æä¾›é…ç½®å’ŒæœåŠ¡å‘ç° | å•†åœºçš„ç®¡ç†åå° |

### 1.3 ä¸ºä»€ä¹ˆéœ€è¦ç»Ÿä¸€è®¤è¯


**ä¼ ç»Ÿåˆ†æ•£è®¤è¯çš„é—®é¢˜**ï¼š

âŒ **å®‰å…¨é£é™©**
- æ¯ä¸ªæœåŠ¡éƒ½å­˜å‚¨ç”¨æˆ·å¯†ç  â†’ æ³„éœ²é£é™©æˆå€å¢åŠ 
- å¯†ç æ•£è½åœ¨å¤šä¸ªæ•°æ®åº“ â†’ ç®¡ç†å›°éš¾

âŒ **ç”¨æˆ·ä½“éªŒå·®**
- è®¿é—®ä¸åŒæœåŠ¡è¦é‡å¤ç™»å½• â†’ æ“ä½œç¹ç
- é€€å‡ºç™»å½•è¦é€šçŸ¥æ‰€æœ‰æœåŠ¡ â†’ å®ç°å¤æ‚

âŒ **ç»´æŠ¤æˆæœ¬é«˜**
- è®¤è¯é€»è¾‘é‡å¤å¼€å‘ â†’ ä»£ç å†—ä½™
- å®‰å…¨ç­–ç•¥ä¸ç»Ÿä¸€ â†’ å®¹æ˜“å‡ºæ¼æ´

**ç»Ÿä¸€è®¤è¯çš„ä¼˜åŠ¿**ï¼š

âœ… **å®‰å…¨æ€§æå‡**
- å¯†ç åªå­˜åœ¨è®¤è¯ä¸­å¿ƒ â†’ é£é™©é›†ä¸­ç®¡ç†
- ç»Ÿä¸€çš„å®‰å…¨ç­–ç•¥ â†’ ä¾¿äºå®¡è®¡å’ŒåŠ å›º

âœ… **ç”¨æˆ·ä½“éªŒå¥½**
- ä¸€æ¬¡ç™»å½•ï¼Œå…¨å±€æœ‰æ•ˆ â†’ Single Sign-On (SSO)
- ç»Ÿä¸€çš„ç™»å½•ç•Œé¢ â†’ ä½“éªŒä¸€è‡´

âœ… **å¼€å‘æ•ˆç‡é«˜**
- ä¸šåŠ¡æœåŠ¡åªå…³æ³¨ä¸šåŠ¡ â†’ èŒè´£æ¸…æ™°
- è®¤è¯é€»è¾‘é›†ä¸­ç»´æŠ¤ â†’ æ˜“äºå‡çº§

---

## 2. ğŸšª Spring Cloud Gateway + OAuth2é›†æˆ


### 2.1 ç½‘å…³çš„è§’è‰²å®šä½


**é€šä¿—ç†è§£**ï¼š
ç½‘å…³å°±åƒå°åŒºçš„é—¨å«ï¼Œæ‰€æœ‰äººè¿›å…¥å°åŒºéƒ½è¦ç»è¿‡é—¨å«è¿™ä¸€å…³ã€‚é—¨å«ä¼šæ£€æŸ¥ä½ çš„"é—¨ç¦å¡"ï¼ˆTokenï¼‰ï¼Œç¡®è®¤ä½ æ˜¯ä¸šä¸»åæ‰æ”¾è¡Œã€‚

**æ ¸å¿ƒèŒè´£**ï¼š
- ğŸ” **ç»Ÿä¸€è®¤è¯**ï¼šæ£€æŸ¥æ¯ä¸ªè¯·æ±‚çš„Tokenæ˜¯å¦æœ‰æ•ˆ
- ğŸ›£ï¸ **è·¯ç”±è½¬å‘**ï¼šæ ¹æ®è¯·æ±‚è·¯å¾„åˆ†å‘åˆ°ä¸åŒçš„å¾®æœåŠ¡
- ğŸ›¡ï¸ **å®‰å…¨è¿‡æ»¤**ï¼šæ‹¦æˆªéæ³•è¯·æ±‚ï¼Œä¿æŠ¤åç«¯æœåŠ¡
- ğŸ“Š **æµé‡æ§åˆ¶**ï¼šé™æµã€ç†”æ–­ç­‰ä¿æŠ¤æªæ–½

### 2.2 Gatewayé›†æˆOAuth2é…ç½®


**ç¬¬ä¸€æ­¥ï¼šæ·»åŠ ä¾èµ–**

```xml
<dependencies>
    <!-- Gatewayæ ¸å¿ƒ -->
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-gateway</artifactId>
    </dependency>
    
    <!-- OAuth2èµ„æºæœåŠ¡å™¨ -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-oauth2-resource-server</artifactId>
    </dependency>
    
    <!-- JWTæ”¯æŒ -->
    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>spring-security-oauth2-jose</artifactId>
    </dependency>
</dependencies>
```

**ç¬¬äºŒæ­¥ï¼šé…ç½®æ–‡ä»¶**

```yaml
spring:
  cloud:
    gateway:
      routes:
        # è®¢å•æœåŠ¡è·¯ç”±
        - id: order-service
          uri: lb://order-service
          predicates:
            - Path=/order/**
          filters:
            - StripPrefix=1
        
        # å•†å“æœåŠ¡è·¯ç”±
        - id: product-service
          uri: lb://product-service
          predicates:
            - Path=/product/**
          filters:
            - StripPrefix=1
      
      # é»˜è®¤è¿‡æ»¤å™¨ï¼ˆå…¨å±€ç”Ÿæ•ˆï¼‰
      default-filters:
        - TokenRelay  # è‡ªåŠ¨è½¬å‘Tokenåˆ°åç«¯æœåŠ¡

  security:
    oauth2:
      resourceserver:
        jwt:
          # JWTç­¾å‘è€…åœ°å€ï¼ˆè®¤è¯ä¸­å¿ƒåœ°å€ï¼‰
          issuer-uri: http://auth-server:9000
          # å…¬é’¥åœ°å€ï¼ˆç”¨äºéªŒè¯JWTç­¾åï¼‰
          jwk-set-uri: http://auth-server:9000/oauth2/jwks
```

**é…ç½®è§£è¯»**ï¼š
- `lb://order-service`ï¼š`lb`è¡¨ç¤ºè´Ÿè½½å‡è¡¡ï¼Œä»æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡å®ä¾‹
- `StripPrefix=1`ï¼šå»æ‰è·¯å¾„å‰ç¼€ï¼Œæ¯”å¦‚ `/order/list` â†’ `/list`
- `TokenRelay`ï¼šè‡ªåŠ¨æŠŠç½‘å…³éªŒè¯è¿‡çš„Tokenä¼ é€’ç»™åç«¯æœåŠ¡
- `issuer-uri`ï¼šè®¤è¯ä¸­å¿ƒçš„åœ°å€ï¼Œç½‘å…³ä¼šä»è¿™é‡Œè·å–å…¬é’¥éªŒè¯Token

### 2.3 ç½‘å…³å®‰å…¨é…ç½®ç±»


```java
@Configuration
@EnableWebFluxSecurity  // æ³¨æ„ï¼šGatewayæ˜¯å“åº”å¼çš„ï¼Œç”¨WebFlux
public class GatewaySecurityConfig {
    
    @Bean
    public SecurityWebFilterChain securityWebFilterChain(ServerHttpSecurity http) {
        http
            // é…ç½®è¯·æ±‚æˆæƒè§„åˆ™
            .authorizeExchange(exchanges -> exchanges
                // è®¤è¯ç›¸å…³æ¥å£ä¸éœ€è¦éªŒè¯Token
                .pathMatchers("/auth/**", "/login", "/logout").permitAll()
                // å…¶ä»–æ‰€æœ‰è¯·æ±‚éƒ½éœ€è¦è®¤è¯
                .anyExchange().authenticated()
            )
            // é…ç½®OAuth2èµ„æºæœåŠ¡å™¨ï¼ˆéªŒè¯JWTï¼‰
            .oauth2ResourceServer(oauth2 -> oauth2
                .jwt(Customizer.withDefaults())  // ä½¿ç”¨é»˜è®¤JWTé…ç½®
            )
            // å…³é—­CSRFï¼ˆå¾®æœåŠ¡æ¶æ„é€šå¸¸ä¸éœ€è¦ï¼‰
            .csrf(ServerHttpSecurity.CsrfSpec::disable);
        
        return http.build();
    }
    
    /**
     * è‡ªå®šä¹‰JWTè§£æå™¨
     * ä½œç”¨ï¼šæŠŠTokenä¸­çš„ä¿¡æ¯è½¬æ¢æˆSpring Securityèƒ½è¯†åˆ«çš„æ ¼å¼
     */
    @Bean
    public ReactiveJwtDecoder jwtDecoder() {
        // ä»è®¤è¯ä¸­å¿ƒè·å–å…¬é’¥
        String jwkSetUri = "http://auth-server:9000/oauth2/jwks";
        
        NimbusReactiveJwtDecoder decoder = 
            NimbusReactiveJwtDecoder.withJwkSetUri(jwkSetUri).build();
        
        // è‡ªå®šä¹‰JWTéªŒè¯é€»è¾‘
        decoder.setJwtValidator(new DelegatingOAuth2TokenValidator<>(
            // éªŒè¯Tokenæ˜¯å¦è¿‡æœŸ
            new JwtTimestampValidator(),
            // éªŒè¯Tokenç­¾å‘è€…
            new JwtIssuerValidator("http://auth-server:9000")
        ));
        
        return decoder;
    }
}
```

**ä»£ç è§£è¯»**ï¼š

ğŸ”¸ **ä¸ºä»€ä¹ˆç”¨WebFluxï¼Ÿ**
- GatewayåŸºäºå“åº”å¼ç¼–ç¨‹ï¼Œå¤„ç†é«˜å¹¶å‘æ€§èƒ½æ›´å¥½
- ä¼ ç»Ÿçš„`HttpSecurity`æ˜¯é˜»å¡å¼çš„ï¼Œä¸é€‚åˆGateway

ğŸ”¸ **permitAll() vs authenticated()**
- `permitAll()`ï¼šä¸éœ€è¦ç™»å½•å°±èƒ½è®¿é—®ï¼Œæ¯”å¦‚ç™»å½•é¡µé¢
- `authenticated()`ï¼šå¿…é¡»æºå¸¦æœ‰æ•ˆTokenæ‰èƒ½è®¿é—®

ğŸ”¸ **JWTéªŒè¯æµç¨‹**
1. è¯·æ±‚åˆ°è¾¾ç½‘å…³
2. ä»è¯·æ±‚å¤´æå–Tokenï¼ˆ`Authorization: Bearer xxx`ï¼‰
3. ç”¨è®¤è¯ä¸­å¿ƒçš„å…¬é’¥éªŒè¯Tokenç­¾å
4. æ£€æŸ¥Tokenæ˜¯å¦è¿‡æœŸ
5. æå–ç”¨æˆ·ä¿¡æ¯ï¼Œæ”¾å…¥SecurityContext
6. è½¬å‘è¯·æ±‚åˆ°åç«¯æœåŠ¡

### 2.4 è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨


æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨TokenéªŒè¯ååšä¸€äº›é¢å¤–å¤„ç†ï¼Œæ¯”å¦‚è®°å½•æ—¥å¿—ã€æ·»åŠ è‡ªå®šä¹‰è¯·æ±‚å¤´ç­‰ï¼š

```java
@Component
public class AuthenticationFilter implements GlobalFilter, Ordered {
    
    private static final Logger log = LoggerFactory.getLogger(AuthenticationFilter.class);
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {
        // è·å–å½“å‰è¯·æ±‚
        ServerHttpRequest request = exchange.getRequest();
        
        // ä»SecurityContextè·å–è®¤è¯ä¿¡æ¯
        return exchange.getPrincipal()
            .flatMap(principal -> {
                if (principal instanceof Jwt) {
                    Jwt jwt = (Jwt) principal;
                    
                    // æå–ç”¨æˆ·ä¿¡æ¯
                    String userId = jwt.getClaim("user_id");
                    String username = jwt.getClaim("username");
                    
                    // è®°å½•è®¿é—®æ—¥å¿—
                    log.info("ç”¨æˆ· {} è®¿é—® {}", username, request.getPath());
                    
                    // æ·»åŠ è‡ªå®šä¹‰è¯·æ±‚å¤´ï¼Œä¼ é€’ç»™åç«¯æœåŠ¡
                    ServerHttpRequest newRequest = request.mutate()
                        .header("X-User-Id", userId)
                        .header("X-Username", username)
                        .build();
                    
                    // ç»§ç»­è¿‡æ»¤é“¾
                    return chain.filter(exchange.mutate().request(newRequest).build());
                }
                
                return chain.filter(exchange);
            })
            // å¦‚æœæ²¡æœ‰è®¤è¯ä¿¡æ¯ï¼Œç›´æ¥æ”¾è¡Œï¼ˆå¯èƒ½æ˜¯å…¬å¼€æ¥å£ï¼‰
            .switchIfEmpty(chain.filter(exchange));
    }
    
    @Override
    public int getOrder() {
        return -100;  // æ•°å­—è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜
    }
}
```

**è¿‡æ»¤å™¨æ‰§è¡Œæµç¨‹**ï¼š
```
è¯·æ±‚è¿›å…¥ â†’ Gatewayå®‰å…¨è¿‡æ»¤å™¨ï¼ˆéªŒè¯Tokenï¼‰
         â†’ è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨ï¼ˆæå–ç”¨æˆ·ä¿¡æ¯ï¼‰
         â†’ è·¯ç”±è¿‡æ»¤å™¨ï¼ˆè½¬å‘è¯·æ±‚ï¼‰
         â†’ åç«¯å¾®æœåŠ¡
```

---

## 3. ğŸ”‘ ç»Ÿä¸€è®¤è¯æˆæƒä¸­å¿ƒå®ç°


### 3.1 è®¤è¯ä¸­å¿ƒçš„æ ¸å¿ƒèŒè´£


**ç®€å•ç†è§£**ï¼š
è®¤è¯ä¸­å¿ƒå°±åƒé“¶è¡Œçš„è¥ä¸šå¤§å…ï¼Œä¸“é—¨è´Ÿè´£ï¼š
- éªŒè¯ä½ çš„èº«ä»½ï¼ˆç”¨æˆ·åå¯†ç ï¼‰
- ç»™ä½ å‘é“¶è¡Œå¡ï¼ˆTokenï¼‰
- ç®¡ç†ä½ çš„æƒé™ï¼ˆèƒ½åšä»€ä¹ˆæ“ä½œï¼‰

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… **ç”¨æˆ·è®¤è¯**ï¼šéªŒè¯ç”¨æˆ·åå’Œå¯†ç 
- âœ… **Tokené¢å‘**ï¼šç”ŸæˆåŒ…å«ç”¨æˆ·ä¿¡æ¯çš„JWT Token
- âœ… **Tokenåˆ·æ–°**ï¼šTokenå¿«è¿‡æœŸæ—¶æ¢ä¸€ä¸ªæ–°çš„
- âœ… **æƒé™ç®¡ç†**ï¼šå®šä¹‰ç”¨æˆ·èƒ½è®¿é—®å“ªäº›èµ„æº

### 3.2 æ­å»ºOAuth2è®¤è¯æœåŠ¡å™¨


**ç¬¬ä¸€æ­¥ï¼šæ·»åŠ ä¾èµ–**

```xml
<dependencies>
    <!-- Spring Authorization Serverï¼ˆæ–°ç‰ˆOAuth2ï¼‰ -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-oauth2-authorization-server</artifactId>
    </dependency>
    
    <!-- Spring Security -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-security</artifactId>
    </dependency>
    
    <!-- æ•°æ®åº“ï¼ˆå­˜å‚¨ç”¨æˆ·å’ŒTokenï¼‰ -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-jpa</artifactId>
    </dependency>
</dependencies>
```

**ç¬¬äºŒæ­¥ï¼šæ ¸å¿ƒé…ç½®ç±»**

```java
@Configuration
public class AuthorizationServerConfig {
    
    /**
     * é…ç½®OAuth2å®¢æˆ·ç«¯ä¿¡æ¯
     * ç±»æ¯”ï¼šå®šä¹‰å“ªäº›APPå¯ä»¥æ¥å…¥æˆ‘ä»¬çš„è®¤è¯ç³»ç»Ÿ
     */
    @Bean
    public RegisteredClientRepository registeredClientRepository() {
        // åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯ï¼ˆæ¯”å¦‚å‰ç«¯Webåº”ç”¨ï¼‰
        RegisteredClient webClient = RegisteredClient.withId(UUID.randomUUID().toString())
            .clientId("web-client")  // å®¢æˆ·ç«¯IDï¼Œç±»ä¼¼APPçš„èº«ä»½è¯
            .clientSecret("{noop}secret")  // å®¢æˆ·ç«¯å¯†é’¥ï¼Œ{noop}è¡¨ç¤ºæ˜æ–‡
            
            // æˆæƒæ–¹å¼ï¼šå¯†ç æ¨¡å¼ï¼ˆç”¨æˆ·åå¯†ç ç™»å½•ï¼‰
            .authorizationGrantType(AuthorizationGrantType.PASSWORD)
            // æˆæƒæ–¹å¼ï¼šåˆ·æ–°Token
            .authorizationGrantType(AuthorizationGrantType.REFRESH_TOKEN)
            
            // é‡å®šå‘åœ°å€ï¼ˆOAuth2æ ‡å‡†æµç¨‹éœ€è¦ï¼‰
            .redirectUri("http://localhost:8080/authorized")
            
            // æƒé™èŒƒå›´
            .scope("read")   // è¯»æƒé™
            .scope("write")  // å†™æƒé™
            
            // Tokené…ç½®
            .tokenSettings(TokenSettings.builder()
                .accessTokenTimeToLive(Duration.ofHours(2))  // Tokenæœ‰æ•ˆæœŸ2å°æ—¶
                .refreshTokenTimeToLive(Duration.ofDays(7))  // åˆ·æ–°Tokenæœ‰æ•ˆæœŸ7å¤©
                .build())
            
            .build();
        
        // å­˜å‚¨åˆ°å†…å­˜ï¼ˆç”Ÿäº§ç¯å¢ƒåº”è¯¥ç”¨æ•°æ®åº“ï¼‰
        return new InMemoryRegisteredClientRepository(webClient);
    }
    
    /**
     * é…ç½®JWTç”Ÿæˆå™¨
     * ä½œç”¨ï¼šç”ŸæˆåŒ…å«ç”¨æˆ·ä¿¡æ¯çš„Token
     */
    @Bean
    public JwtEncoder jwtEncoder() {
        // ç”ŸæˆRSAå¯†é’¥å¯¹ï¼ˆå…¬é’¥+ç§é’¥ï¼‰
        KeyPair keyPair = generateRsaKey();
        RSAPublicKey publicKey = (RSAPublicKey) keyPair.getPublic();
        RSAPrivateKey privateKey = (RSAPrivateKey) keyPair.getPrivate();
        
        // ç”¨ç§é’¥ç­¾åToken
        JWKSource<SecurityContext> jwkSource = new ImmutableJWKSet<>(
            new JWKSet(new RSAKey.Builder(publicKey)
                .privateKey(privateKey)
                .keyID(UUID.randomUUID().toString())
                .build())
        );
        
        return new NimbusJwtEncoder(jwkSource);
    }
    
    /**
     * ç”ŸæˆRSAå¯†é’¥å¯¹
     */
    private static KeyPair generateRsaKey() {
        try {
            KeyPairGenerator generator = KeyPairGenerator.getInstance("RSA");
            generator.initialize(2048);  // å¯†é’¥é•¿åº¦2048ä½
            return generator.generateKeyPair();
        } catch (Exception ex) {
            throw new IllegalStateException(ex);
        }
    }
    
    /**
     * é…ç½®æˆæƒæœåŠ¡å™¨
     */
    @Bean
    public AuthorizationServerSettings authorizationServerSettings() {
        return AuthorizationServerSettings.builder()
            .issuer("http://auth-server:9000")  // ç­¾å‘è€…åœ°å€
            .build();
    }
}
```

**é…ç½®è§£è¯»**ï¼š

ğŸ”¸ **ä»€ä¹ˆæ˜¯å®¢æˆ·ç«¯ï¼Ÿ**
- å°±æ˜¯è¦æ¥å…¥è®¤è¯ç³»ç»Ÿçš„åº”ç”¨ï¼Œæ¯”å¦‚Webå‰ç«¯ã€ç§»åŠ¨APP
- æ¯ä¸ªå®¢æˆ·ç«¯æœ‰è‡ªå·±çš„IDå’Œå¯†é’¥ï¼Œç”¨æ¥æ ‡è¯†èº«ä»½

ğŸ”¸ **æˆæƒæ–¹å¼ï¼ˆGrant Typeï¼‰**
- **PASSWORDæ¨¡å¼**ï¼šç”¨æˆ·å+å¯†ç æ¢Tokenï¼Œé€‚åˆè‡ªå·±çš„å‰ç«¯
- **REFRESH_TOKEN**ï¼šç”¨åˆ·æ–°Tokenæ¢æ–°Tokenï¼Œé¿å…é¢‘ç¹ç™»å½•

ğŸ”¸ **Tokenæ—¶æ•ˆè®¾ç½®**
- `accessTokenTimeToLive`ï¼šè®¿é—®Tokençš„æœ‰æ•ˆæœŸï¼Œä¸å®œå¤ªé•¿
- `refreshTokenTimeToLive`ï¼šåˆ·æ–°Tokenæœ‰æ•ˆæœŸï¼Œå¯ä»¥é•¿ä¸€äº›

ğŸ”¸ **RSAåŠ å¯†åŸç†**
- **ç§é’¥ç­¾å**ï¼šè®¤è¯ä¸­å¿ƒç”¨ç§é’¥ç»™Tokenç­¾åï¼Œè¯æ˜Tokenæ˜¯æˆ‘å‘çš„
- **å…¬é’¥éªŒè¯**ï¼šç½‘å…³ç”¨å…¬é’¥éªŒè¯ç­¾åï¼Œç¡®è®¤Tokenæ²¡è¢«ç¯¡æ”¹

### 3.3 è‡ªå®šä¹‰ç”¨æˆ·è®¤è¯é€»è¾‘


```java
@Service
public class CustomUserDetailsService implements UserDetailsService {
    
    @Autowired
    private UserRepository userRepository;  // ç”¨æˆ·æ•°æ®è®¿é—®å±‚
    
    @Override
    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
        // ä»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·
        User user = userRepository.findByUsername(username)
            .orElseThrow(() -> new UsernameNotFoundException("ç”¨æˆ·ä¸å­˜åœ¨: " + username));
        
        // è½¬æ¢æˆSpring Securityçš„UserDetails
        return org.springframework.security.core.userdetails.User.builder()
            .username(user.getUsername())
            .password(user.getPassword())  // å¯†ç åº”è¯¥æ˜¯åŠ å¯†çš„
            .roles(user.getRoles().toArray(new String[0]))  // ç”¨æˆ·è§’è‰²
            .accountExpired(false)      // è´¦å·æœªè¿‡æœŸ
            .accountLocked(false)       // è´¦å·æœªé”å®š
            .credentialsExpired(false)  // å¯†ç æœªè¿‡æœŸ
            .disabled(false)            // è´¦å·æœªç¦ç”¨
            .build();
    }
}
```

**è®¤è¯æµç¨‹**ï¼š
```
1. ç”¨æˆ·è¾“å…¥ç”¨æˆ·åå¯†ç 
   â†“
2. Spring Securityè°ƒç”¨loadUserByUsername()
   â†“
3. ä»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯
   â†“
4. æ¯”å¯¹å¯†ç æ˜¯å¦åŒ¹é…
   â†“
5. éªŒè¯æˆåŠŸ â†’ ç”ŸæˆToken
   éªŒè¯å¤±è´¥ â†’ æŠ›å‡ºå¼‚å¸¸
```

### 3.4 è‡ªå®šä¹‰Tokenå†…å®¹


é»˜è®¤çš„TokenåªåŒ…å«åŸºæœ¬ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ è‡ªå®šä¹‰å†…å®¹ï¼š

```java
@Component
public class CustomJwtTokenCustomizer implements OAuth2TokenCustomizer<JwtEncodingContext> {
    
    @Override
    public void customize(JwtEncodingContext context) {
        // è·å–ç”¨æˆ·ä¿¡æ¯
        Authentication authentication = context.getPrincipal();
        UserDetails user = (UserDetails) authentication.getPrincipal();
        
        // è·å–JWTçš„Claimsï¼ˆå£°æ˜ï¼‰
        JwtClaimsSet.Builder claims = context.getClaims();
        
        // æ·»åŠ è‡ªå®šä¹‰ä¿¡æ¯åˆ°Token
        claims.claim("user_id", getUserId(user));       // ç”¨æˆ·ID
        claims.claim("username", user.getUsername());   // ç”¨æˆ·å
        claims.claim("roles", user.getAuthorities());   // è§’è‰²åˆ—è¡¨
        claims.claim("tenant_id", getTenantId(user));   // ç§Ÿæˆ·IDï¼ˆå¤šç§Ÿæˆ·åœºæ™¯ï¼‰
        
        // è¿™äº›ä¿¡æ¯ä¼šè¢«åŠ å¯†åˆ°Tokenä¸­ï¼Œç½‘å…³å’Œå„ä¸ªæœåŠ¡éƒ½èƒ½è§£æ
    }
    
    private String getUserId(UserDetails user) {
        // ä»æ•°æ®åº“æˆ–ç¼“å­˜è·å–ç”¨æˆ·ID
        return "123456";
    }
    
    private String getTenantId(UserDetails user) {
        // è·å–ç§Ÿæˆ·IDï¼ˆå¦‚æœæ˜¯å¤šç§Ÿæˆ·ç³»ç»Ÿï¼‰
        return "tenant-001";
    }
}
```

**Tokenç»“æ„**ï¼ˆJWTæ ¼å¼ï¼‰ï¼š
```
Headerï¼ˆå¤´éƒ¨ï¼‰ï¼š
{
  "alg": "RS256",  // åŠ å¯†ç®—æ³•
  "typ": "JWT"     // Tokenç±»å‹
}

Payloadï¼ˆè½½è·ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰çš„å†…å®¹ï¼‰ï¼š
{
  "user_id": "123456",
  "username": "zhangsan",
  "roles": ["ROLE_USER", "ROLE_ADMIN"],
  "tenant_id": "tenant-001",
  "exp": 1700000000,  // è¿‡æœŸæ—¶é—´
  "iss": "http://auth-server:9000"  // ç­¾å‘è€…
}

Signatureï¼ˆç­¾åï¼‰ï¼š
ç”¨ç§é’¥å¯¹ Header + Payload åŠ å¯†ç”Ÿæˆçš„ç­¾å
```

---

## 4. ğŸ« å¾®æœåŠ¡Tokenç»Ÿä¸€ç®¡ç†


### 4.1 Tokenä¼ é€’æœºåˆ¶


**é—®é¢˜åœºæ™¯**ï¼š
ç”¨æˆ·ç™»å½•åæ‹¿åˆ°Tokenï¼Œè®¿é—®è®¢å•æœåŠ¡æ—¶ï¼Œè®¢å•æœåŠ¡å†…éƒ¨åˆè¦è°ƒç”¨å•†å“æœåŠ¡ï¼ŒTokenæ€ä¹ˆä¼ é€’ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼š

```
ç”¨æˆ· â†’ [æºå¸¦Token] â†’ ç½‘å…³ â†’ è®¢å•æœåŠ¡ â†’ [éœ€è¦Token] â†’ å•†å“æœåŠ¡
                                â†“
                        æ€ä¹ˆæŠŠTokenä¼ è¿‡å»ï¼Ÿ
```

**æ–¹å¼ä¸€ï¼šé€šè¿‡Feignæ‹¦æˆªå™¨è‡ªåŠ¨ä¼ é€’**

```java
@Configuration
public class FeignConfig {
    
    /**
     * Feignè¯·æ±‚æ‹¦æˆªå™¨
     * ä½œç”¨ï¼šåœ¨æœåŠ¡é—´è°ƒç”¨æ—¶è‡ªåŠ¨æ·»åŠ Token
     */
    @Bean
    public RequestInterceptor requestInterceptor() {
        return requestTemplate -> {
            // ä»å½“å‰è¯·æ±‚è·å–Token
            ServletRequestAttributes attributes = 
                (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
            
            if (attributes != null) {
                HttpServletRequest request = attributes.getRequest();
                String token = request.getHeader("Authorization");
                
                if (token != null) {
                    // æ·»åŠ åˆ°Feignè¯·æ±‚å¤´
                    requestTemplate.header("Authorization", token);
                }
            }
        };
    }
}
```

**æ–¹å¼äºŒï¼šä½¿ç”¨Spring Cloud OpenFeignè‡ªå¸¦çš„OAuth2æ”¯æŒ**

```yaml
feign:
  oauth2:
    enabled: true  # å¼€å¯OAuth2æ”¯æŒ
    load-balanced: true  # æ”¯æŒè´Ÿè½½å‡è¡¡
```

```java
// Feignå®¢æˆ·ç«¯
@FeignClient(name = "product-service", configuration = FeignConfig.class)
public interface ProductClient {
    
    @GetMapping("/api/product/{id}")
    Product getProduct(@PathVariable Long id);
    // Tokenä¼šè‡ªåŠ¨æ·»åŠ åˆ°è¯·æ±‚å¤´
}
```

### 4.2 Tokenåˆ·æ–°ç­–ç•¥


**é—®é¢˜**ï¼šTokenæœ‰æ•ˆæœŸ2å°æ—¶,è¿‡æœŸåç”¨æˆ·è¦é‡æ–°ç™»å½•å—ï¼Ÿ

**ç­”æ¡ˆ**ï¼šä¸éœ€è¦ï¼ä½¿ç”¨åˆ·æ–°Tokenæœºåˆ¶

**åˆ·æ–°æµç¨‹**ï¼š
```
1. ç”¨æˆ·ç™»å½•æˆåŠŸ
   â†“
2. è®¤è¯ä¸­å¿ƒè¿”å›ï¼šè®¿é—®Tokenï¼ˆ2å°æ—¶ï¼‰+ åˆ·æ–°Tokenï¼ˆ7å¤©ï¼‰
   â†“
3. è®¿é—®Tokenå¿«è¿‡æœŸæ—¶ï¼ˆæ¯”å¦‚è¿˜å‰©10åˆ†é’Ÿï¼‰
   â†“
4. å‰ç«¯ç”¨åˆ·æ–°Tokenæ¢å–æ–°çš„è®¿é—®Token
   â†“
5. æ— æ„Ÿåˆ·æ–°ï¼Œç”¨æˆ·æ— éœ€é‡æ–°ç™»å½•
```

**å‰ç«¯åˆ·æ–°Tokenç¤ºä¾‹**ï¼š

```javascript
// Axiosæ‹¦æˆªå™¨
axios.interceptors.response.use(
  response => response,
  async error => {
    const originalRequest = error.config;
    
    // å¦‚æœè¿”å›401ï¼ˆæœªæˆæƒï¼‰ä¸”è¿˜æ²¡é‡è¯•è¿‡
    if (error.response.status === 401 && !originalRequest._retry) {
      originalRequest._retry = true;
      
      // ç”¨åˆ·æ–°Tokenæ¢æ–°Token
      const refreshToken = localStorage.getItem('refresh_token');
      const response = await axios.post('/auth/refresh', {
        refresh_token: refreshToken
      });
      
      // ä¿å­˜æ–°Token
      const newAccessToken = response.data.access_token;
      localStorage.setItem('access_token', newAccessToken);
      
      // é‡æ–°å‘èµ·åŸæ¥çš„è¯·æ±‚
      originalRequest.headers['Authorization'] = 'Bearer ' + newAccessToken;
      return axios(originalRequest);
    }
    
    return Promise.reject(error);
  }
);
```

**åç«¯åˆ·æ–°Tokenæ¥å£**ï¼š

```java
@RestController
@RequestMapping("/auth")
public class AuthController {
    
    @Autowired
    private OAuth2AuthorizationService authorizationService;
    
    @PostMapping("/refresh")
    public ResponseEntity<?> refreshToken(@RequestBody RefreshTokenRequest request) {
        // éªŒè¯åˆ·æ–°Token
        OAuth2Authorization authorization = 
            authorizationService.findByToken(request.getRefreshToken(), OAuth2TokenType.REFRESH_TOKEN);
        
        if (authorization == null) {
            return ResponseEntity.status(401).body("åˆ·æ–°Tokenæ— æ•ˆ");
        }
        
        // ç”Ÿæˆæ–°çš„è®¿é—®Token
        String newAccessToken = generateNewAccessToken(authorization);
        
        return ResponseEntity.ok(Map.of(
            "access_token", newAccessToken,
            "token_type", "Bearer",
            "expires_in", 7200  // 2å°æ—¶
        ));
    }
}
```

### 4.3 Tokenåœ¨å¾®æœåŠ¡ä¸­çš„éªŒè¯


**æ¯ä¸ªå¾®æœåŠ¡éƒ½è¦éªŒè¯Tokenå—ï¼Ÿ**
ç­”ï¼šæ˜¯çš„ï¼Œä½†å¾ˆç®€å•ï¼

**èµ„æºæœåŠ¡å™¨é…ç½®**ï¼ˆå„ä¸ªå¾®æœåŠ¡ï¼‰ï¼š

```yaml
# application.yml
spring:
  security:
    oauth2:
      resourceserver:
        jwt:
          # è®¤è¯ä¸­å¿ƒçš„å…¬é’¥åœ°å€
          jwk-set-uri: http://auth-server:9000/oauth2/jwks
```

```java
@Configuration
@EnableWebSecurity
public class ResourceServerConfig {
    
    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
            .authorizeHttpRequests(authorize -> authorize
                // å…¬å¼€æ¥å£
                .requestMatchers("/api/public/**").permitAll()
                // éœ€è¦ADMINè§’è‰²
                .requestMatchers("/api/admin/**").hasRole("ADMIN")
                // å…¶ä»–æ¥å£éœ€è¦è®¤è¯
                .anyRequest().authenticated()
            )
            // é…ç½®ä¸ºOAuth2èµ„æºæœåŠ¡å™¨
            .oauth2ResourceServer(oauth2 -> oauth2
                .jwt(Customizer.withDefaults())
            );
        
        return http.build();
    }
    
    /**
     * ä»Tokenæå–æƒé™
     */
    @Bean
    public JwtAuthenticationConverter jwtAuthenticationConverter() {
        JwtGrantedAuthoritiesConverter grantedAuthoritiesConverter = 
            new JwtGrantedAuthoritiesConverter();
        
        // Tokenä¸­çš„è§’è‰²å­—æ®µå
        grantedAuthoritiesConverter.setAuthoritiesClaimName("roles");
        // è§’è‰²å‰ç¼€ï¼ˆSpring Securityé»˜è®¤éœ€è¦ROLE_å‰ç¼€ï¼‰
        grantedAuthoritiesConverter.setAuthorityPrefix("ROLE_");
        
        JwtAuthenticationConverter jwtConverter = new JwtAuthenticationConverter();
        jwtConverter.setJwtGrantedAuthoritiesConverter(grantedAuthoritiesConverter);
        
        return jwtConverter;
    }
}
```

**éªŒè¯æµç¨‹**ï¼š
```
1. è¯·æ±‚åˆ°è¾¾å¾®æœåŠ¡
   â†“
2. Spring Securityä»è¯·æ±‚å¤´æå–Token
   â†“
3. ä»è®¤è¯ä¸­å¿ƒè·å–å…¬é’¥ï¼ˆç¬¬ä¸€æ¬¡ä¼šç¼“å­˜ï¼‰
   â†“
4. éªŒè¯Tokenç­¾åå’Œæœ‰æ•ˆæœŸ
   â†“
5. æå–ç”¨æˆ·ä¿¡æ¯å’Œæƒé™
   â†“
6. æ”¾å…¥SecurityContextï¼Œä¸šåŠ¡ä»£ç å¯ç›´æ¥ä½¿ç”¨
```

---

## 5. ğŸ” æœåŠ¡é—´å®‰å…¨é€šä¿¡


### 5.1 ä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡é—´è®¤è¯


**åœºæ™¯é—®é¢˜**ï¼š
ç½‘å…³éªŒè¯äº†ç”¨æˆ·Tokenï¼Œä½†è®¢å•æœåŠ¡è°ƒç”¨å•†å“æœåŠ¡æ—¶ï¼Œå•†å“æœåŠ¡æ€ä¹ˆçŸ¥é“è¿™ä¸ªè¯·æ±‚æ˜¯ä»è®¢å•æœåŠ¡å‘æ¥çš„ï¼Œè€Œä¸æ˜¯æ¶æ„æ”»å‡»ï¼Ÿ

**å®‰å…¨é£é™©**ï¼š
```
æ­£å¸¸æµç¨‹ï¼š
ç”¨æˆ· â†’ ç½‘å…³(éªŒè¯) â†’ è®¢å•æœåŠ¡ â†’ å•†å“æœåŠ¡ âœ…

ç»•è¿‡ç½‘å…³çš„æ”»å‡»ï¼š
é»‘å®¢ â†’ ç›´æ¥è®¿é—®å•†å“æœåŠ¡ â†’ ç»•è¿‡è®¤è¯ âŒ
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. **ç½‘ç»œéš”ç¦»**ï¼šå¾®æœåŠ¡åªèƒ½å†…ç½‘è®¿é—®
2. **æœåŠ¡é—´è®¤è¯**ï¼šæœåŠ¡è°ƒç”¨æ—¶ä¹Ÿè¦éªŒè¯èº«ä»½
3. **APIå¯†é’¥**ï¼šæœåŠ¡é—´é€šä¿¡ä½¿ç”¨ä¸“ç”¨å¯†é’¥

### 5.2 åŸºäºJWTçš„æœåŠ¡é—´è®¤è¯


**æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨å®¢æˆ·ç«¯å‡­è¯æ¨¡å¼ï¼ˆClient Credentialsï¼‰**

è¿™æ˜¯OAuth2ä¸“é—¨ä¸ºæœåŠ¡é—´é€šä¿¡è®¾è®¡çš„æ¨¡å¼ï¼š

```java
@Configuration
public class ServiceAuthConfig {
    
    /**
     * é…ç½®æœåŠ¡ä¸“ç”¨çš„OAuth2å®¢æˆ·ç«¯
     */
    @Bean
    public RegisteredClient serviceClient() {
        return RegisteredClient.withId(UUID.randomUUID().toString())
            .clientId("order-service")  // æœåŠ¡å
            .clientSecret("{noop}order-service-secret")  // æœåŠ¡å¯†é’¥
            
            // å®¢æˆ·ç«¯å‡­è¯æ¨¡å¼ï¼ˆæœåŠ¡é—´è°ƒç”¨ï¼‰
            .authorizationGrantType(AuthorizationGrantType.CLIENT_CREDENTIALS)
            
            // æœåŠ¡ä¸“ç”¨æƒé™
            .scope("service.read")
            .scope("service.write")
            
            .tokenSettings(TokenSettings.builder()
                .accessTokenTimeToLive(Duration.ofHours(24))  // æœåŠ¡Tokenæœ‰æ•ˆæœŸæ›´é•¿
                .build())
            
            .build();
    }
}
```

**æœåŠ¡é—´è°ƒç”¨ç¤ºä¾‹**ï¼š

```java
@Service
public class OrderService {
    
    @Autowired
    private ProductClient productClient;
    
    @Autowired
    private OAuth2AuthorizedClientManager authorizedClientManager;
    
    public Order createOrder(Long productId) {
        // 1. è·å–æœåŠ¡ä¸“ç”¨Token
        OAuth2AuthorizedClient authorizedClient = getServiceToken();
        String serviceToken = authorizedClient.getAccessToken().getTokenValue();
        
        // 2. è°ƒç”¨å•†å“æœåŠ¡
        Product product = productClient.getProduct(productId, "Bearer " + serviceToken);
        
        // 3. åˆ›å»ºè®¢å•
        return new Order(product);
    }
    
    private OAuth2AuthorizedClient getServiceToken() {
        OAuth2AuthorizeRequest authorizeRequest = OAuth2AuthorizeRequest
            .withClientRegistrationId("order-service-client")
            .principal("order-service")
            .build();
        
        return authorizedClientManager.authorize(authorizeRequest);
    }
}
```

**æ–¹æ¡ˆäºŒï¼šä½¿ç”¨APIå¯†é’¥ï¼ˆæ›´ç®€å•ï¼‰**

```java
@Component
public class ServiceAuthInterceptor implements ClientHttpRequestInterceptor {
    
    @Value("${service.api-key}")
    private String apiKey;
    
    @Override
    public ClientHttpResponse intercept(HttpRequest request, byte[] body, 
                                       ClientHttpRequestExecution execution) throws IOException {
        // æ·»åŠ æœåŠ¡ä¸“ç”¨å¯†é’¥
        request.getHeaders().add("X-API-Key", apiKey);
        
        return execution.execute(request, body);
    }
}
```

```java
// å•†å“æœåŠ¡éªŒè¯å¯†é’¥
@Component
public class ApiKeyFilter extends OncePerRequestFilter {
    
    @Value("${service.api-key}")
    private String validApiKey;
    
    @Override
    protected void doFilterInternal(HttpServletRequest request, 
                                   HttpServletResponse response, 
                                   FilterChain filterChain) throws ServletException, IOException {
        String apiKey = request.getHeader("X-API-Key");
        
        // å¦‚æœæ˜¯æœåŠ¡é—´è°ƒç”¨ï¼ŒéªŒè¯APIå¯†é’¥
        if (isServiceRequest(request)) {
            if (!validApiKey.equals(apiKey)) {
                response.setStatus(HttpServletResponse.SC_FORBIDDEN);
                response.getWriter().write("æ— æ•ˆçš„æœåŠ¡å¯†é’¥");
                return;
            }
        }
        
        filterChain.doFilter(request, response);
    }
    
    private boolean isServiceRequest(HttpServletRequest request) {
        // åˆ¤æ–­æ˜¯å¦æ˜¯æœåŠ¡é—´è°ƒç”¨ï¼ˆæ¯”å¦‚é€šè¿‡å†…ç½‘IPï¼‰
        return request.getHeader("X-API-Key") != null;
    }
}
```

### 5.3 mTLSåŒå‘è®¤è¯ï¼ˆé«˜å®‰å…¨åœºæ™¯ï¼‰


**ä»€ä¹ˆæ˜¯mTLSï¼Ÿ**
æ™®é€šHTTPSåªéªŒè¯æœåŠ¡å™¨èº«ä»½ï¼ŒmTLSæ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç›¸äº’éªŒè¯ã€‚

**åº”ç”¨åœºæ™¯**ï¼š
- é‡‘èç³»ç»Ÿ
- æ•æ„Ÿæ•°æ®ä¼ è¾“
- é«˜å®‰å…¨è¦æ±‚çš„å¾®æœåŠ¡

**é…ç½®ç¤ºä¾‹**ï¼š

```yaml
# æœåŠ¡ç«¯é…ç½®
server:
  ssl:
    enabled: true
    key-store: classpath:server-keystore.p12
    key-store-password: password
    key-store-type: PKCS12
    # è¦æ±‚å®¢æˆ·ç«¯è¯ä¹¦
    client-auth: need
    trust-store: classpath:truststore.p12
    trust-store-password: password
```

```yaml
# å®¢æˆ·ç«¯é…ç½®ï¼ˆFeignï¼‰
feign:
  client:
    config:
      default:
        key-store: classpath:client-keystore.p12
        key-store-password: password
        trust-store: classpath:truststore.p12
        trust-store-password: password
```

---

## 6. ğŸ›¡ï¸ åŸºç¡€è®¾æ–½å®‰å…¨åŠ å›º


### 6.1 é…ç½®ä¸­å¿ƒå®‰å…¨


**é—®é¢˜**ï¼šé…ç½®ä¸­å¿ƒå­˜å‚¨äº†æ•°æ®åº“å¯†ç ã€APIå¯†é’¥ç­‰æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚ä½•ä¿æŠ¤ï¼Ÿ

**è§£å†³æ–¹æ¡ˆä¸€ï¼šåŠ å¯†é…ç½®**

```yaml
# application.ymlï¼ˆåŠ å¯†å‰ï¼‰
spring:
  datasource:
    password: mypassword123  âŒ æ˜æ–‡å¯†ç ï¼Œä¸å®‰å…¨

# application.ymlï¼ˆåŠ å¯†åï¼‰
spring:
  datasource:
    password: '{cipher}AQBnVc9T...'  âœ… åŠ å¯†å¯†ç 
```

**Spring Cloud ConfigåŠ å¯†é…ç½®**ï¼š

```bash
# 1. é…ç½®åŠ å¯†å¯†é’¥
export ENCRYPT_KEY=my-secret-key

# 2. å¯åŠ¨Config Serveræ—¶è‡ªåŠ¨è§£å¯†
java -jar config-server.jar
```

```java
// Config Serveré…ç½®
@SpringBootApplication
@EnableConfigServer
public class ConfigServerApplication {
    
    @Bean
    public TextEncryptor textEncryptor() {
        // ä½¿ç”¨å¯¹ç§°åŠ å¯†
        return new StandardTextEncryptor(encryptKey);
    }
}
```

**è§£å†³æ–¹æ¡ˆäºŒï¼šä½¿ç”¨Vaultç®¡ç†å¯†é’¥**

```yaml
spring:
  cloud:
    vault:
      host: vault.example.com
      port: 8200
      scheme: https
      authentication: TOKEN
      token: s.xxxxxxxxxxx
      
      # ä»Vaultè¯»å–é…ç½®
      generic:
        enabled: true
        application-name: order-service
```

```java
// ä½¿ç”¨Vaultä¸­çš„å¯†ç 
@Value("${vault.database.password}")
private String databasePassword;
```

### 6.2 æœåŠ¡å‘ç°å®‰å…¨


**é—®é¢˜**ï¼šæ³¨å†Œä¸­å¿ƒï¼ˆå¦‚Nacosã€Eurekaï¼‰å¦‚æœè¢«æ”»å‡»ï¼Œæ¶æ„æœåŠ¡æ³¨å†Œè¿›æ¥æ€ä¹ˆåŠï¼Ÿ

**Nacoså®‰å…¨é…ç½®**ï¼š

```yaml
# Nacos Serveré…ç½®
nacos:
  core:
    auth:
      enabled: true  # å¼€å¯è®¤è¯
      system:
        type: nacos
        nacos:
          username: nacos
          password: nacos123
```

```yaml
# å¾®æœåŠ¡é…ç½®
spring:
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848
        username: nacos
        password: nacos123
        # å‘½åç©ºé—´éš”ç¦»
        namespace: production
        # åªå…è®¸ç‰¹å®šIPè®¿é—®
        access-key: your-access-key
        secret-key: your-secret-key
```

**Eurekaå®‰å…¨é…ç½®**ï¼š

```yaml
# Eureka Server
eureka:
  server:
    enable-self-preservation: false  # ç”Ÿäº§ç¯å¢ƒå»ºè®®å¼€å¯
  
# å¯ç”¨HTTP Basicè®¤è¯
spring:
  security:
    user:
      name: admin
      password: admin123
```

```yaml
# Eureka Client
eureka:
  client:
    service-url:
      defaultZone: http://admin:admin123@localhost:8761/eureka/
```

### 6.3 é“¾è·¯è¿½è¸ªå®‰å…¨


**é—®é¢˜**ï¼šé“¾è·¯è¿½è¸ªï¼ˆå¦‚Zipkinã€Skywalkingï¼‰ä¼šè®°å½•è¯·æ±‚è¯¦æƒ…ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯

**è§£å†³æ–¹æ¡ˆï¼šè¿‡æ»¤æ•æ„Ÿä¿¡æ¯**

```java
@Component
public class SensitiveDataFilter implements brave.SpanCustomizer {
    
    @Override
    public void tag(String key, String value) {
        // è¿‡æ»¤æ•æ„Ÿå­—æ®µ
        if (key.contains("password") || key.contains("token")) {
            value = "***";  // æ›¿æ¢ä¸ºæ˜Ÿå·
        }
        
        super.tag(key, value);
    }
}
```

**Spring Cloud Sleuthé…ç½®**ï¼š

```yaml
spring:
  sleuth:
    sampler:
      probability: 0.1  # åªé‡‡æ ·10%çš„è¯·æ±‚ï¼Œå‡å°‘æ€§èƒ½å½±å“
    
    # ä¸è¿½è¸ªæ•æ„Ÿæ¥å£
    web:
      skip-pattern: /actuator.*,/auth/.*
    
    # è‡ªå®šä¹‰Tagè¿‡æ»¤
    propagation-keys:
      - user-id
      - request-id
      # ä¸ä¼ é€’tokenç­‰æ•æ„Ÿä¿¡æ¯
```

### 6.4 ç›‘æ§ç³»ç»Ÿå®‰å…¨


**é—®é¢˜**ï¼šPrometheusã€Grafanaç­‰ç›‘æ§å·¥å…·æš´éœ²äº†ç³»ç»ŸæŒ‡æ ‡ï¼Œå¦‚ä½•ä¿æŠ¤ï¼Ÿ

**Prometheuså®‰å…¨é…ç½®**ï¼š

```yaml
# prometheus.yml
global:
  scrape_interval: 15s

# HTTP Basicè®¤è¯
scrape_configs:
  - job_name: 'spring-boot-apps'
    basic_auth:
      username: prometheus
      password: secure_password
    static_configs:
      - targets: ['localhost:8080']
```

**Spring Boot Actuatorå®‰å…¨é…ç½®**ï¼š

```yaml
management:
  endpoints:
    web:
      exposure:
        # åªæš´éœ²å¥åº·æ£€æŸ¥å’ŒæŒ‡æ ‡
        include: health,prometheus
  
  # ç«¯ç‚¹å®‰å…¨
  endpoint:
    health:
      show-details: when-authorized  # éœ€è¦è®¤è¯æ‰æ˜¾ç¤ºè¯¦æƒ…
```

```java
@Configuration
public class ActuatorSecurityConfig {
    
    @Bean
    public SecurityFilterChain actuatorSecurityFilterChain(HttpSecurity http) throws Exception {
        http
            .requestMatcher(EndpointRequest.toAnyEndpoint())
            .authorizeRequests(authorize -> authorize
                // å¥åº·æ£€æŸ¥å…¬å¼€
                .requestMatchers(EndpointRequest.to("health")).permitAll()
                // å…¶ä»–ç«¯ç‚¹éœ€è¦ADMINè§’è‰²
                .anyRequest().hasRole("ADMIN")
            )
            .httpBasic(Customizer.withDefaults());
        
        return http.build();
    }
}
```

**Grafanaè®¿é—®æ§åˆ¶**ï¼š

```ini
# grafana.ini
[auth]
disable_login_form = false
oauth_auto_login = true

[auth.generic_oauth]
enabled = true
name = OAuth
client_id = grafana
client_secret = grafana_secret
auth_url = http://auth-server:9000/oauth2/authorize
token_url = http://auth-server:9000/oauth2/token
api_url = http://auth-server:9000/userinfo

# è§’è‰²æ˜ å°„
[auth.generic_oauth.role_mapping]
role_attribute_path = contains(roles[*], 'ADMIN') && 'Admin' || 'Viewer'
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 ç»Ÿä¸€è®¤è¯æ¶æ„æ ¸å¿ƒè¦ç‚¹


**ğŸ”¸ æ¶æ„è®¾è®¡åŸåˆ™**
```
å•ç‚¹ç™»å½•ï¼šä¸€æ¬¡è®¤è¯ï¼Œå…¨å±€æœ‰æ•ˆ
èŒè´£åˆ†ç¦»ï¼šè®¤è¯ä¸­å¿ƒä¸“èŒè®¤è¯ï¼Œç½‘å…³ç»Ÿä¸€é‰´æƒ
Tokenä¼ é€’ï¼šç½‘å…³éªŒè¯åé€ä¼ ï¼ŒæœåŠ¡ç›´æ¥ä½¿ç”¨
å®‰å…¨åŠ å›ºï¼šå¤šå±‚é˜²æŠ¤ï¼Œçºµæ·±é˜²å¾¡
```

**ğŸ”¸ å…³é”®ç»„ä»¶èŒè´£**

| ç»„ä»¶ | æ ¸å¿ƒèŒè´£ | å…³é”®é…ç½® |
|------|----------|----------|
| **è®¤è¯ä¸­å¿ƒ** | éªŒè¯èº«ä»½ã€é¢å‘Token | OAuth2 Server + JWT |
| **ç½‘å…³** | TokenéªŒè¯ã€è·¯ç”±è½¬å‘ | OAuth2 Resource Server |
| **å¾®æœåŠ¡** | TokenéªŒè¯ã€ä¸šåŠ¡å¤„ç† | JWT Decoder |
| **é…ç½®ä¸­å¿ƒ** | æ•æ„Ÿé…ç½®åŠ å¯† | Encrypt/Vault |
| **æ³¨å†Œä¸­å¿ƒ** | æœåŠ¡æ³¨å†Œè®¤è¯ | ACL/å‘½åç©ºé—´ |

### 7.2 Tokenç®¡ç†æœ€ä½³å®è·µ


**âœ… Tokenè®¾è®¡å»ºè®®**
- è®¿é—®Tokenæœ‰æ•ˆæœŸï¼š**1-2å°æ—¶**ï¼ˆå¹³è¡¡å®‰å…¨å’Œä½“éªŒï¼‰
- åˆ·æ–°Tokenæœ‰æ•ˆæœŸï¼š**7-30å¤©**ï¼ˆæ ¹æ®ä¸šåŠ¡è¦æ±‚ï¼‰
- Tokenå†…å®¹ï¼šåªåŒ…å«**å¿…è¦ä¿¡æ¯**ï¼Œå‡å°ä½“ç§¯
- ç­¾åç®—æ³•ï¼šä½¿ç”¨**RSA256**æˆ–æ›´é«˜å®‰å…¨çº§åˆ«

**âœ… Tokenåˆ·æ–°ç­–ç•¥**
```
å‰ç«¯ç­–ç•¥ï¼š
- Tokenè¿‡æœŸå‰5åˆ†é’Ÿè‡ªåŠ¨åˆ·æ–°
- åˆ·æ–°å¤±è´¥æ—¶å¼•å¯¼ç”¨æˆ·é‡æ–°ç™»å½•
- ä½¿ç”¨æ‹¦æˆªå™¨ç»Ÿä¸€å¤„ç†

åç«¯ç­–ç•¥ï¼š
- åˆ·æ–°Tokenä¸€æ¬¡æ€§ä½¿ç”¨ï¼ˆç”¨å®Œä½œåºŸï¼‰
- è®°å½•åˆ·æ–°æ—¥å¿—ï¼Œä¾¿äºå®¡è®¡
- å¼‚å¸¸åˆ·æ–°æ—¶å‘Šè­¦
```

**âœ… Tokenä¼ é€’æ–¹å¼**
```
ç”¨æˆ·è¯·æ±‚ï¼š
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...

æœåŠ¡é—´è°ƒç”¨ï¼š
æ–¹å¼1ï¼šé€ä¼ ç”¨æˆ·Tokenï¼ˆä¿æŒç”¨æˆ·ä¸Šä¸‹æ–‡ï¼‰
æ–¹å¼2ï¼šä½¿ç”¨æœåŠ¡ä¸“ç”¨Tokenï¼ˆé«˜å®‰å…¨åœºæ™¯ï¼‰
æ–¹å¼3ï¼šAPIå¯†é’¥è®¤è¯ï¼ˆç®€å•åœºæ™¯ï¼‰
```

### 7.3 å®‰å…¨é˜²æŠ¤æ£€æŸ¥æ¸…å•


**ğŸ” è®¤è¯å±‚å®‰å…¨**
- âœ… å¯†ç åŠ å¯†å­˜å‚¨ï¼ˆBCrypt/Argon2ï¼‰
- âœ… é˜²æš´åŠ›ç ´è§£ï¼ˆç™»å½•é™æµã€éªŒè¯ç ï¼‰
- âœ… Tokené˜²é‡æ”¾ï¼ˆnonce/timestampï¼‰
- âœ… æ•æ„Ÿæ“ä½œäºŒæ¬¡éªŒè¯ï¼ˆæ”¯ä»˜ã€ä¿®æ”¹å¯†ç ï¼‰

**ğŸ” ä¼ è¾“å±‚å®‰å…¨**
- âœ… å…¨é“¾è·¯HTTPSï¼ˆç½‘å…³åˆ°æœåŠ¡ï¼‰
- âœ… æœåŠ¡é—´mTLSï¼ˆé«˜å®‰å…¨åœºæ™¯ï¼‰
- âœ… æ•æ„Ÿæ•°æ®åŠ å¯†ä¼ è¾“ï¼ˆAESï¼‰
- âœ… APIç­¾åéªŒè¯ï¼ˆé˜²ç¯¡æ”¹ï¼‰

**ğŸ” åŸºç¡€è®¾æ–½å®‰å…¨**
- âœ… é…ç½®ä¸­å¿ƒåŠ å¯†ï¼ˆæ•æ„Ÿé…ç½®ï¼‰
- âœ… æ³¨å†Œä¸­å¿ƒè®¤è¯ï¼ˆé˜²æ¶æ„æ³¨å†Œï¼‰
- âœ… ç›‘æ§ç³»ç»Ÿè®¿é—®æ§åˆ¶ï¼ˆè§’è‰²æƒé™ï¼‰
- âœ… é“¾è·¯è¿½è¸ªæ•°æ®è„±æ•ï¼ˆè¿‡æ»¤æ•æ„Ÿå­—æ®µï¼‰

### 7.4 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


**â“ é—®é¢˜1ï¼šTokenè¿‡æœŸåæœåŠ¡é—´è°ƒç”¨å¤±è´¥**
```
åŸå› ï¼šæœåŠ¡Aç”¨è¿‡æœŸTokenè°ƒç”¨æœåŠ¡B
è§£å†³ï¼š
1. æœåŠ¡é—´ä½¿ç”¨ä¸“ç”¨Tokenï¼ˆæœ‰æ•ˆæœŸæ›´é•¿ï¼‰
2. å®ç°Tokenè‡ªåŠ¨åˆ·æ–°æœºåˆ¶
3. ä½¿ç”¨APIå¯†é’¥ä»£æ›¿Token
```

**â“ é—®é¢˜2ï¼šç½‘å…³å‹åŠ›è¿‡å¤§**
```
åŸå› ï¼šæ‰€æœ‰è¯·æ±‚éƒ½è¦éªŒè¯Token
ä¼˜åŒ–ï¼š
1. TokenéªŒè¯ç»“æœç¼“å­˜ï¼ˆRedisï¼‰
2. ä½¿ç”¨æœ¬åœ°JWTéªŒè¯ï¼ˆæ— éœ€è¿œç¨‹è°ƒç”¨ï¼‰
3. ç½‘å…³é›†ç¾¤éƒ¨ç½²+è´Ÿè½½å‡è¡¡
```

**â“ é—®é¢˜3ï¼šåˆ†å¸ƒå¼Sessioné—®é¢˜**
```
åŸå› ï¼šç”¨æˆ·ç™»å½•çŠ¶æ€æ— æ³•å…±äº«
è§£å†³ï¼š
1. ä½¿ç”¨JWTï¼ˆæ— çŠ¶æ€Tokenï¼‰
2. Sessioné›†ä¸­å­˜å‚¨ï¼ˆRedisï¼‰
3. ä¸è¦ä¾èµ–HttpSession
```

**â“ é—®é¢˜4ï¼šå®‰å…¨ä¸æ€§èƒ½å¹³è¡¡**
```
ç­–ç•¥ï¼š
- å…¬å¼€æ¥å£ï¼šè·³è¿‡è®¤è¯
- å†…éƒ¨æ¥å£ï¼šè½»é‡çº§éªŒè¯ï¼ˆAPI Keyï¼‰
- æ•æ„Ÿæ¥å£ï¼šå®Œæ•´éªŒè¯+å®¡è®¡æ—¥å¿—
- æ ¹æ®ä¸šåŠ¡é‡è¦æ€§åˆ†çº§é˜²æŠ¤
```

### 7.5 å®æˆ˜ç»éªŒæ€»ç»“


**ğŸ¯ æ–°æ‰‹å…¥é—¨è·¯å¾„**
```
ç¬¬1æ­¥ï¼šç†è§£OAuth2åŸºæœ¬æ¦‚å¿µ
     â†“
ç¬¬2æ­¥ï¼šæ­å»ºè®¤è¯ä¸­å¿ƒï¼ˆSpring Authorization Serverï¼‰
     â†“
ç¬¬3æ­¥ï¼šé…ç½®ç½‘å…³ï¼ˆGateway + OAuth2 Resource Serverï¼‰
     â†“
ç¬¬4æ­¥ï¼šæ”¹é€ å¾®æœåŠ¡ï¼ˆResource Serveré…ç½®ï¼‰
     â†“
ç¬¬5æ­¥ï¼šå®ç°Tokenåˆ·æ–°ï¼ˆå‰åç«¯é…åˆï¼‰
     â†“
ç¬¬6æ­¥ï¼šåŠ å›ºåŸºç¡€è®¾æ–½ï¼ˆé…ç½®ã€æ³¨å†Œã€ç›‘æ§ï¼‰
```

**ğŸ¯ ç”Ÿäº§ç¯å¢ƒæ£€æŸ¥ç‚¹**
- ğŸ”¸ æ‰€æœ‰æ•æ„Ÿé…ç½®å·²åŠ å¯† âœ…
- ğŸ”¸ Tokenæœ‰æ•ˆæœŸåˆç†è®¾ç½® âœ…
- ğŸ”¸ åˆ·æ–°Tokenæœºåˆ¶æ­£å¸¸å·¥ä½œ âœ…
- ğŸ”¸ æœåŠ¡é—´è®¤è¯å·²å¯ç”¨ âœ…
- ğŸ”¸ HTTPSè¯ä¹¦æœ‰æ•ˆä¸”æœªè¿‡æœŸ âœ…
- ğŸ”¸ ç›‘æ§å‘Šè­¦å·²é…ç½® âœ…
- ğŸ”¸ å®¡è®¡æ—¥å¿—å·²å¼€å¯ âœ…

**ğŸ¯ æ ¸å¿ƒè®°å¿†å£è¯€**
```
ç»Ÿä¸€è®¤è¯åœ¨ç½‘å…³ï¼ŒTokenç®¡ç†è¦é›†ä¸­
æœåŠ¡é€šä¿¡åŠ å¯†é’¥,åŸºç¡€è®¾æ–½åˆ«å¿½è§†
æ€§èƒ½å®‰å…¨è¦å¹³è¡¡,åˆ†çº§é˜²æŠ¤æœ€é‡è¦
```

---

## ğŸ“š ç›¸å…³å­¦ä¹ èµ„æº


**å®˜æ–¹æ–‡æ¡£**
- ğŸ”— [Spring Authorization Server](https://spring.io/projects/spring-authorization-server)
- ğŸ”— [Spring Cloud Gateway Security](https://spring.io/projects/spring-cloud-gateway)
- ğŸ”— [OAuth 2.0 RFC](https://oauth.net/2/)

**è¿›é˜¶ä¸»é¢˜**
- ğŸ†• ç»†ç²’åº¦æƒé™æ§åˆ¶ï¼ˆRBAC/ABACï¼‰
- ğŸ†• é›¶ä¿¡ä»»ç½‘ç»œæ¶æ„ï¼ˆZero Trustï¼‰
- ğŸ†• æœåŠ¡ç½‘æ ¼å®‰å…¨ï¼ˆIstio/Linkerdï¼‰