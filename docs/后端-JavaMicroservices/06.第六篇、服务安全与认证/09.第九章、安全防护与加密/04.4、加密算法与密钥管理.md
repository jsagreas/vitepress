---
title: 4ã€åŠ å¯†ç®—æ³•ä¸å¯†é’¥ç®¡ç†
---
## ğŸ“š ç›®å½•

1. [åŠ å¯†åŸºç¡€æ¦‚å¿µ](#1-åŠ å¯†åŸºç¡€æ¦‚å¿µ)
2. [AESå¯¹ç§°åŠ å¯†](#2-AESå¯¹ç§°åŠ å¯†)
3. [RSAéå¯¹ç§°åŠ å¯†](#3-RSAéå¯¹ç§°åŠ å¯†)
4. [æ•°å­—ç­¾åéªŒè¯](#4-æ•°å­—ç­¾åéªŒè¯)
5. [å¯†é’¥ç®¡ç†å®è·µ](#5-å¯†é’¥ç®¡ç†å®è·µ)
6. [è¯ä¹¦ç®¡ç†ä½“ç³»](#6-è¯ä¹¦ç®¡ç†ä½“ç³»)
7. [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#7-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” åŠ å¯†åŸºç¡€æ¦‚å¿µ


### 1.1 ä¸ºä»€ä¹ˆéœ€è¦åŠ å¯†


æƒ³è±¡ä¸€ä¸‹å¯„ä¿¡çš„åœºæ™¯ï¼š

```
æ™®é€šæ˜ä¿¡ç‰‡ï¼ˆæ— åŠ å¯†ï¼‰ï¼š
ä½ å†™ï¼šå¯†ç æ˜¯123456
é‚®é€’å‘˜å¯ä»¥çœ‹åˆ° âŒ
è·¯äººå¯ä»¥çœ‹åˆ° âŒ
æ”¶ä»¶äººå¯ä»¥çœ‹åˆ° âœ…

å¯†å°ä¿¡å°ï¼ˆåŠ å¯†ï¼‰ï¼š
ä½ å†™ï¼šå¯†ç æ˜¯123456 â†’ è£…è¿›ä¿¡å°é”ä¸Š
é‚®é€’å‘˜çœ‹ä¸åˆ° âœ…
è·¯äººçœ‹ä¸åˆ° âœ…
åªæœ‰æ”¶ä»¶äººèƒ½æ‰“å¼€çœ‹åˆ° âœ…
```

**åœ¨å¾®æœåŠ¡ä¸­çš„å®é™…åº”ç”¨**ï¼š
- ğŸ”¸ ç”¨æˆ·å¯†ç å­˜å‚¨ï¼šä¸èƒ½æ˜æ–‡ä¿å­˜åœ¨æ•°æ®åº“
- ğŸ”¸ æ•æ„Ÿæ•°æ®ä¼ è¾“ï¼šèº«ä»½è¯å·ã€é“¶è¡Œå¡å·ç­‰ä¿¡æ¯
- ğŸ”¸ APIé€šä¿¡ï¼šæœåŠ¡ä¹‹é—´ä¼ é€’çš„æ•æ„Ÿæ•°æ®
- ğŸ”¸ é…ç½®æ–‡ä»¶ï¼šæ•°æ®åº“å¯†ç ã€ç¬¬ä¸‰æ–¹å¯†é’¥ç­‰

### 1.2 åŠ å¯†çš„æ ¸å¿ƒæ¦‚å¿µ


**æ˜æ–‡ vs å¯†æ–‡**
```
æ˜æ–‡ï¼ˆPlaintextï¼‰ï¼šåŸå§‹çš„ã€å¯è¯»çš„æ•°æ®
â†“ åŠ å¯†è¿‡ç¨‹
å¯†æ–‡ï¼ˆCiphertextï¼‰ï¼šåŠ å¯†åçš„ã€ä¸å¯è¯»çš„æ•°æ®
â†“ è§£å¯†è¿‡ç¨‹  
æ˜æ–‡ï¼ˆPlaintextï¼‰ï¼šæ¢å¤åŸå§‹æ•°æ®
```

**å¯†é’¥çš„ä½œç”¨**
- ğŸ”¸ å°±åƒé”å’Œé’¥åŒ™çš„å…³ç³»
- ğŸ”¸ åŠ å¯†ç”¨å¯†é’¥"é”ä¸Š"æ•°æ®
- ğŸ”¸ è§£å¯†ç”¨å¯†é’¥"æ‰“å¼€"æ•°æ®
- ğŸ”¸ æ²¡æœ‰æ­£ç¡®çš„å¯†é’¥ï¼Œæ•°æ®æ— æ³•è§£å¯†

### 1.3 ä¸¤å¤§åŠ å¯†ä½“ç³»å¯¹æ¯”


| ç‰¹æ€§ | **å¯¹ç§°åŠ å¯†** | **éå¯¹ç§°åŠ å¯†** |
|------|------------|--------------|
| ğŸ”‘ **å¯†é’¥æ•°é‡** | `1ä¸ªå¯†é’¥` | `2ä¸ªå¯†é’¥ï¼ˆå…¬é’¥+ç§é’¥ï¼‰` |
| ğŸ” **åŠ è§£å¯†** | `åŒä¸€æŠŠé’¥åŒ™` | `å…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†` |
| âš¡ **é€Ÿåº¦** | `å¿«ï¼ˆé€‚åˆå¤§æ•°æ®ï¼‰` | `æ…¢ï¼ˆé€‚åˆå°æ•°æ®ï¼‰` |
| ğŸ“¦ **åº”ç”¨åœºæ™¯** | `æ•°æ®åŠ å¯†ã€æ–‡ä»¶åŠ å¯†` | `èº«ä»½è®¤è¯ã€å¯†é’¥äº¤æ¢` |
| ğŸŒ° **ç”Ÿæ´»ç±»æ¯”** | `ä¿é™©æŸœï¼šä¸€æŠŠé’¥åŒ™å¼€å…³` | `é‚®ç®±ï¼šæŠ•é€’å£å…¬å¼€ï¼Œé’¥åŒ™ç§æœ‰` |

---

## 2. ğŸ”’ AESå¯¹ç§°åŠ å¯†


### 2.1 AESæ˜¯ä»€ä¹ˆ


**é€šä¿—ç†è§£**ï¼š
AESï¼ˆAdvanced Encryption Standardï¼‰å°±åƒä¸€ä¸ª**è¶…çº§ä¿é™©æŸœ**ï¼Œç”¨åŒä¸€æŠŠé’¥åŒ™æ¥é”å’Œå¼€ã€‚

```
ğŸ“¦ åŠ å¯†è¿‡ç¨‹ï¼š
åŸå§‹æ•°æ®ï¼ˆå¯†ç 123456ï¼‰ + å¯†é’¥ï¼ˆsecret-keyï¼‰
          â†“ AESåŠ å¯†ç®—æ³•
åŠ å¯†æ•°æ®ï¼ˆXyZ@#$%^&*ï¼‰

ğŸ”“ è§£å¯†è¿‡ç¨‹ï¼š
åŠ å¯†æ•°æ®ï¼ˆXyZ@#$%^&*ï¼‰ + å¯†é’¥ï¼ˆsecret-keyï¼‰
          â†“ AESè§£å¯†ç®—æ³•
åŸå§‹æ•°æ®ï¼ˆå¯†ç 123456ï¼‰
```

**æ ¸å¿ƒç‰¹ç‚¹**ï¼š
- âœ… é€Ÿåº¦å¿«ï¼šé€‚åˆåŠ å¯†å¤§é‡æ•°æ®
- âœ… å®‰å…¨æ€§é«˜ï¼šç›®å‰æ— æ³•æš´åŠ›ç ´è§£
- âœ… åº”ç”¨å¹¿æ³›ï¼šé“¶è¡Œç³»ç»Ÿã€æ–‡ä»¶åŠ å¯†éƒ½åœ¨ç”¨

### 2.2 AESå¯†é’¥é•¿åº¦


AESæ”¯æŒä¸‰ç§å¯†é’¥é•¿åº¦ï¼Œå°±åƒä¿é™©æŸœçš„å¤æ‚åº¦ï¼š

```
ğŸ”¸ AES-128ï¼šå¯†é’¥16å­—èŠ‚ = 128ä½
   å®‰å…¨çº§åˆ«ï¼šâ­â­â­ å¤Ÿç”¨
   
ğŸ”¸ AES-192ï¼šå¯†é’¥24å­—èŠ‚ = 192ä½  
   å®‰å…¨çº§åˆ«ï¼šâ­â­â­â­ æ›´å®‰å…¨
   
ğŸ”¸ AES-256ï¼šå¯†é’¥32å­—èŠ‚ = 256ä½
   å®‰å…¨çº§åˆ«ï¼šâ­â­â­â­â­ å†›äº‹çº§åˆ«
```

> ğŸ’¡ **é€‰æ‹©å»ºè®®**  
> ä¼ä¸šåº”ç”¨æ¨èä½¿ç”¨AES-256ï¼Œå®‰å…¨æ€§å’Œæ€§èƒ½çš„æœ€ä½³å¹³è¡¡

### 2.3 AESåŠ å¯†æ¨¡å¼


AESåŠ å¯†å°±åƒåˆ‡èœçš„æ–¹å¼ï¼Œæœ‰ä¸åŒçš„æ¨¡å¼ï¼š

**ğŸ”¸ ECBæ¨¡å¼ï¼ˆç”µå­å¯†ç æœ¬ï¼‰**
```
åŸç†ï¼šæŠŠæ•°æ®åˆ‡æˆå—ï¼Œæ¯å—ç‹¬ç«‹åŠ å¯†

ä¼˜ç‚¹ï¼šç®€å•å¿«é€Ÿ
ç¼ºç‚¹ï¼šç›¸åŒå†…å®¹åŠ å¯†ç»“æœç›¸åŒï¼ˆä¸å®‰å…¨ï¼ï¼‰

âŒ ä¸æ¨èä½¿ç”¨
```

**ğŸ”¸ CBCæ¨¡å¼ï¼ˆå¯†ç å—é“¾æ¥ï¼‰**
```
åŸç†ï¼šæ¯å—åŠ å¯†éƒ½ä¾èµ–å‰ä¸€å—çš„ç»“æœ

ç¬¬1å—ï¼šæ•°æ®1 + IVåˆå§‹å‘é‡ â†’ åŠ å¯† â†’ å¯†æ–‡1
ç¬¬2å—ï¼šæ•°æ®2 + å¯†æ–‡1 â†’ åŠ å¯† â†’ å¯†æ–‡2
ç¬¬3å—ï¼šæ•°æ®3 + å¯†æ–‡2 â†’ åŠ å¯† â†’ å¯†æ–‡3

ä¼˜ç‚¹ï¼šç›¸åŒå†…å®¹åŠ å¯†ç»“æœä¸åŒï¼ˆå®‰å…¨ï¼‰
ç¼ºç‚¹ï¼šä¸èƒ½å¹¶è¡Œå¤„ç†

âœ… å¸¸ç”¨æ¨¡å¼
```

**ğŸ”¸ GCMæ¨¡å¼ï¼ˆä¼½ç½—ç“¦è®¡æ•°å™¨ï¼‰**
```
åŸç†ï¼šåŠ å¯† + å®Œæ•´æ€§æ ¡éªŒ

ç‰¹ç‚¹ï¼š
- ä¸ä»…åŠ å¯†ï¼Œè¿˜èƒ½é˜²æ­¢æ•°æ®è¢«ç¯¡æ”¹
- æ”¯æŒå¹¶è¡Œå¤„ç†ï¼Œé€Ÿåº¦å¿«
- è‡ªå¸¦è®¤è¯åŠŸèƒ½

âœ… æœ€æ¨èä½¿ç”¨
```

### 2.4 Javaå®ç°AESåŠ å¯†


```java
@Service
public class AESEncryptionService {
    
    // AESå¯†é’¥ï¼ˆå®é™…åº”è¯¥ä»é…ç½®ä¸­å¿ƒè·å–ï¼‰
    private static final String SECRET_KEY = "MySecretKey12345"; // 16å­—èŠ‚
    
    /**
     * ğŸ” åŠ å¯†æ–¹æ³•
     * æŠŠæ˜æ–‡æ•°æ®å˜æˆå¯†æ–‡
     */
    public String encrypt(String plainText) throws Exception {
        // 1ï¸âƒ£ å‡†å¤‡å¯†é’¥
        SecretKeySpec keySpec = new SecretKeySpec(
            SECRET_KEY.getBytes(), "AES"
        );
        
        // 2ï¸âƒ£ åˆå§‹åŒ–åŠ å¯†å™¨ï¼ˆä½¿ç”¨GCMæ¨¡å¼ï¼‰
        Cipher cipher = Cipher.getInstance("AES/GCM/NoPadding");
        cipher.init(Cipher.ENCRYPT_MODE, keySpec);
        
        // 3ï¸âƒ£ æ‰§è¡ŒåŠ å¯†
        byte[] encrypted = cipher.doFinal(plainText.getBytes());
        
        // 4ï¸âƒ£ è½¬æˆBase64è¿”å›ï¼ˆæ–¹ä¾¿ä¼ è¾“ï¼‰
        return Base64.getEncoder().encodeToString(encrypted);
    }
    
    /**
     * ğŸ”“ è§£å¯†æ–¹æ³•
     * æŠŠå¯†æ–‡è¿˜åŸæˆæ˜æ–‡
     */
    public String decrypt(String encryptedText) throws Exception {
        // è§£å¯†è¿‡ç¨‹ä¸åŠ å¯†ç›¸å
        SecretKeySpec keySpec = new SecretKeySpec(
            SECRET_KEY.getBytes(), "AES"
        );
        
        Cipher cipher = Cipher.getInstance("AES/GCM/NoPadding");
        cipher.init(Cipher.DECRYPT_MODE, keySpec);
        
        byte[] decrypted = cipher.doFinal(
            Base64.getDecoder().decode(encryptedText)
        );
        
        return new String(decrypted);
    }
}
```

**ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹**
```java
// åŠ å¯†ç”¨æˆ·å¯†ç 
String password = "user123456";
String encrypted = aesService.encrypt(password);
// ç»“æœï¼šXyZ@#$%^&*abc...ï¼ˆå¯†æ–‡ï¼‰

// å­˜å‚¨åˆ°æ•°æ®åº“
userRepository.save(encrypted);

// éªŒè¯æ—¶è§£å¯†
String decrypted = aesService.decrypt(encrypted);
// ç»“æœï¼šuser123456ï¼ˆåŸå¯†ç ï¼‰
```

---

## 3. ğŸ”‘ RSAéå¯¹ç§°åŠ å¯†


### 3.1 RSAæ˜¯ä»€ä¹ˆ


**é€šä¿—ç†è§£**ï¼š
RSAå°±åƒä¸€ä¸ª**ç‰¹æ®Šçš„é‚®ç®±**ï¼Œæœ‰ä¸¤æŠŠé’¥åŒ™ï¼š
- ğŸ”¸ å…¬é’¥ï¼ˆPublic Keyï¼‰ï¼šå°±åƒé‚®ç®±çš„æŠ•é€’å£ï¼Œæ‰€æœ‰äººéƒ½èƒ½ç”¨å®ƒæŠ•ä¿¡ï¼ˆåŠ å¯†ï¼‰
- ğŸ”¸ ç§é’¥ï¼ˆPrivate Keyï¼‰ï¼šå°±åƒé‚®ç®±çš„é’¥åŒ™ï¼Œåªæœ‰ä¸»äººèƒ½æ‰“å¼€å–ä¿¡ï¼ˆè§£å¯†ï¼‰

```
åœºæ™¯ï¼šå°æ˜ç»™å°çº¢å‘é€å¯†ç 

     å°æ˜                              å°çº¢
      â”‚                                â”‚
      â”‚  â‘ è¯·æ±‚å…¬é’¥                      â”‚
      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
      â”‚                                â”‚
      â”‚  â‘¡è¿”å›å…¬é’¥ï¼ˆä»»ä½•äººéƒ½èƒ½æ‹¿ï¼‰      â”‚
      â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
      â”‚                                â”‚
      â”‚  â‘¢ç”¨å…¬é’¥åŠ å¯†å¯†ç                 â”‚
      â”‚  "123456" â†’ "XyZ@#..."        â”‚
      â”‚                                â”‚
      â”‚  â‘£å‘é€å¯†æ–‡                      â”‚
      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
      â”‚                                â”‚
      â”‚                    â‘¤ç”¨ç§é’¥è§£å¯†  â”‚
      â”‚                    "XyZ@#..." â†’ "123456" â”‚
```

### 3.2 RSAçš„æ ¸å¿ƒç‰¹æ€§


**ğŸ”¸ å¯†é’¥é…å¯¹å…³ç³»**
```
å…¬é’¥åŠ å¯†çš„æ•°æ® â†’ åªèƒ½ç§é’¥è§£å¯†
ç§é’¥åŠ å¯†çš„æ•°æ® â†’ åªèƒ½å…¬é’¥è§£å¯†

å…¬é’¥å¯ä»¥å…¬å¼€ âœ…
ç§é’¥å¿…é¡»ä¿å¯† âŒ
```

**ğŸ”¸ åº”ç”¨åœºæ™¯å¯¹æ¯”**

| åœºæ™¯ | **ä½¿ç”¨æ–¹å¼** | **ç›®çš„** |
|------|------------|---------|
| ğŸ” **æ•°æ®åŠ å¯†** | `å…¬é’¥åŠ å¯† â†’ ç§é’¥è§£å¯†` | `ä¿æŠ¤æ•°æ®éšç§` |
| âœï¸ **æ•°å­—ç­¾å** | `ç§é’¥ç­¾å â†’ å…¬é’¥éªŒè¯` | `è¯æ˜èº«ä»½çœŸå®` |
| ğŸ”„ **å¯†é’¥äº¤æ¢** | `RSAä¼ è¾“AESå¯†é’¥` | `å®‰å…¨ä¼ é€’å¯†é’¥` |

### 3.3 RSAå¯†é’¥é•¿åº¦


```
ğŸ”¸ 1024ä½ï¼š
   å®‰å…¨æ€§ï¼šâ­â­ å·²ä¸æ¨è
   é€Ÿåº¦ï¼šå¿«
   
ğŸ”¸ 2048ä½ï¼š
   å®‰å…¨æ€§ï¼šâ­â­â­â­ ç›®å‰æ ‡å‡†
   é€Ÿåº¦ï¼šä¸­ç­‰
   
ğŸ”¸ 4096ä½ï¼š
   å®‰å…¨æ€§ï¼šâ­â­â­â­â­ è¶…é«˜å®‰å…¨
   é€Ÿåº¦ï¼šè¾ƒæ…¢
```

> âš ï¸ **é‡è¦æç¤º**  
> RSAåªé€‚åˆåŠ å¯†å°‘é‡æ•°æ®ï¼ˆå¦‚å¯†é’¥ï¼‰ï¼Œä¸é€‚åˆåŠ å¯†å¤§æ–‡ä»¶

### 3.4 Javaå®ç°RSAåŠ å¯†


```java
@Service
public class RSAEncryptionService {
    
    private KeyPair keyPair;
    
    /**
     * ğŸ”‘ ç”Ÿæˆå¯†é’¥å¯¹
     * ä¸€æ¬¡ç”Ÿæˆå…¬é’¥å’Œç§é’¥
     */
    public void generateKeyPair() throws Exception {
        KeyPairGenerator generator = KeyPairGenerator.getInstance("RSA");
        generator.initialize(2048); // ä½¿ç”¨2048ä½å¯†é’¥
        this.keyPair = generator.generateKeyPair();
    }
    
    /**
     * ğŸ” å…¬é’¥åŠ å¯†
     * ç”¨äºå‘é€æ–¹åŠ å¯†æ•°æ®
     */
    public String encrypt(String plainText) throws Exception {
        PublicKey publicKey = keyPair.getPublic();
        
        Cipher cipher = Cipher.getInstance("RSA");
        cipher.init(Cipher.ENCRYPT_MODE, publicKey);
        
        byte[] encrypted = cipher.doFinal(plainText.getBytes());
        return Base64.getEncoder().encodeToString(encrypted);
    }
    
    /**
     * ğŸ”“ ç§é’¥è§£å¯†
     * ç”¨äºæ¥æ”¶æ–¹è§£å¯†æ•°æ®
     */
    public String decrypt(String encryptedText) throws Exception {
        PrivateKey privateKey = keyPair.getPrivate();
        
        Cipher cipher = Cipher.getInstance("RSA");
        cipher.init(Cipher.DECRYPT_MODE, privateKey);
        
        byte[] decrypted = cipher.doFinal(
            Base64.getDecoder().decode(encryptedText)
        );
        return new String(decrypted);
    }
}
```

**ğŸ’¡ å®é™…åº”ç”¨åœºæ™¯**
```java
// åœºæ™¯ï¼šç”¨æˆ·ç™»å½•æ—¶ä¼ è¾“å¯†ç 

// å‰ç«¯ï¼šç”¨å…¬é’¥åŠ å¯†å¯†ç 
String password = "userPassword123";
String encryptedPassword = rsaService.encrypt(password);
// å‘é€åŠ å¯†åçš„å¯†ç åˆ°åç«¯

// åç«¯ï¼šç”¨ç§é’¥è§£å¯†
String originalPassword = rsaService.decrypt(encryptedPassword);
// éªŒè¯å¯†ç 
```

---

## 4. âœï¸ æ•°å­—ç­¾åéªŒè¯


### 4.1 æ•°å­—ç­¾åæ˜¯ä»€ä¹ˆ


**é€šä¿—ç†è§£**ï¼š
æ•°å­—ç­¾åå°±åƒ**æ‰‹å†™ç­¾å+æŒ‡çº¹**çš„ç»„åˆï¼Œç”¨æ¥è¯æ˜ï¼š
- âœ… è¿™ä¸ªæ¶ˆæ¯ç¡®å®æ˜¯æˆ‘å‘çš„ï¼ˆèº«ä»½è®¤è¯ï¼‰
- âœ… æ¶ˆæ¯æ²¡æœ‰è¢«äººç¯¡æ”¹è¿‡ï¼ˆå®Œæ•´æ€§ï¼‰

```
ç”Ÿæ´»åœºæ™¯ç±»æ¯”ï¼š

ğŸ“„ ç­¾åˆåŒï¼š
ä½ ç­¾å â†’ è¯æ˜æ˜¯ä½ æœ¬äººåŒæ„
å¯¹æ–¹çœ‹ç­¾å â†’ ç¡®è®¤æ˜¯ä½ ç­¾çš„

ğŸ’» æ•°å­—ç­¾åï¼š
ç”¨ç§é’¥ç­¾å â†’ è¯æ˜æ˜¯ä½ å‘çš„
å¯¹æ–¹ç”¨å…¬é’¥éªŒè¯ â†’ ç¡®è®¤æ˜¯ä½ ç­¾çš„ä¸”æœªè¢«æ”¹
```

### 4.2 ç­¾ååŸç†æµç¨‹


```
å‘é€æ–¹ï¼ˆç­¾åï¼‰                        æ¥æ”¶æ–¹ï¼ˆéªŒè¯ï¼‰
     â”‚                                    â”‚
     â”‚ â‘ å‡†å¤‡åŸå§‹æ¶ˆæ¯                       â”‚
     â”‚  "è½¬è´¦1000å…ƒ"                       â”‚
     â”‚                                    â”‚
     â”‚ â‘¡è®¡ç®—æ¶ˆæ¯æ‘˜è¦ï¼ˆå“ˆå¸Œï¼‰                â”‚
     â”‚  "è½¬è´¦1000å…ƒ" â†’ abc123...          â”‚
     â”‚                                    â”‚
     â”‚ â‘¢ç”¨ç§é’¥åŠ å¯†æ‘˜è¦                     â”‚
     â”‚  abc123 + ç§é’¥ â†’ XyZ@#...         â”‚
     â”‚  ï¼ˆè¿™å°±æ˜¯æ•°å­—ç­¾åï¼‰                  â”‚
     â”‚                                    â”‚
     â”‚ â‘£å‘é€æ¶ˆæ¯+ç­¾å                      â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
     â”‚  æ¶ˆæ¯ï¼š"è½¬è´¦1000å…ƒ"                  â”‚
     â”‚  ç­¾åï¼š"XyZ@#..."                   â”‚
     â”‚                                    â”‚
     â”‚                          â‘¤ç”¨å…¬é’¥è§£å¯†ç­¾å â”‚
     â”‚                          XyZ@# â†’ abc123  â”‚
     â”‚                                    â”‚
     â”‚                          â‘¥è®¡ç®—æ”¶åˆ°æ¶ˆæ¯çš„æ‘˜è¦ â”‚
     â”‚                          "è½¬è´¦1000å…ƒ" â†’ abc123 â”‚
     â”‚                                    â”‚
     â”‚                          â‘¦å¯¹æ¯”ä¸¤ä¸ªæ‘˜è¦ â”‚
     â”‚                          ç›¸åŒâœ…=æœªè¢«ç¯¡æ”¹ â”‚
     â”‚                          ä¸åŒâŒ=è¢«ç¯¡æ”¹äº† â”‚
```

### 4.3 Javaå®ç°æ•°å­—ç­¾å


```java
@Service
public class DigitalSignatureService {
    
    private KeyPair keyPair;
    
    /**
     * âœï¸ ç”Ÿæˆç­¾å
     * å‘é€æ–¹ä½¿ç”¨ç§é’¥å¯¹æ•°æ®ç­¾å
     */
    public String sign(String message) throws Exception {
        // 1ï¸âƒ£ åˆå§‹åŒ–ç­¾åå™¨
        Signature signature = Signature.getInstance("SHA256withRSA");
        signature.initSign(keyPair.getPrivate());
        
        // 2ï¸âƒ£ è¾“å…¥è¦ç­¾åçš„æ•°æ®
        signature.update(message.getBytes());
        
        // 3ï¸âƒ£ ç”Ÿæˆç­¾å
        byte[] signBytes = signature.sign();
        return Base64.getEncoder().encodeToString(signBytes);
    }
    
    /**
     * âœ… éªŒè¯ç­¾å
     * æ¥æ”¶æ–¹ä½¿ç”¨å…¬é’¥éªŒè¯ç­¾å
     */
    public boolean verify(String message, String signStr) throws Exception {
        // 1ï¸âƒ£ åˆå§‹åŒ–éªŒè¯å™¨
        Signature signature = Signature.getInstance("SHA256withRSA");
        signature.initVerify(keyPair.getPublic());
        
        // 2ï¸âƒ£ è¾“å…¥åŸå§‹æ•°æ®
        signature.update(message.getBytes());
        
        // 3ï¸âƒ£ éªŒè¯ç­¾å
        byte[] signBytes = Base64.getDecoder().decode(signStr);
        return signature.verify(signBytes);
    }
}
```

**ğŸ’¡ å®é™…åº”ç”¨ç¤ºä¾‹**
```java
// åœºæ™¯ï¼šå¾®æœåŠ¡é—´APIè°ƒç”¨ï¼Œé˜²æ­¢è¯·æ±‚è¢«ç¯¡æ”¹

// æœåŠ¡Aå‘é€è¯·æ±‚
String requestData = "{\"orderId\":\"12345\",\"amount\":1000}";
String signature = signatureService.sign(requestData);

// å‘é€åˆ°æœåŠ¡B
Request request = new Request(requestData, signature);

// æœåŠ¡BéªŒè¯ç­¾å
boolean isValid = signatureService.verify(
    request.getData(), 
    request.getSignature()
);

if (isValid) {
    // âœ… ç­¾åæœ‰æ•ˆï¼Œæ•°æ®æœªè¢«ç¯¡æ”¹ï¼Œå¯ä»¥å¤„ç†
    processOrder(request.getData());
} else {
    // âŒ ç­¾åæ— æ•ˆï¼Œæ•°æ®å¯èƒ½è¢«ç¯¡æ”¹ï¼Œæ‹’ç»è¯·æ±‚
    throw new SecurityException("ç­¾åéªŒè¯å¤±è´¥");
}
```

### 4.4 ç­¾åvsåŠ å¯†çš„åŒºåˆ«


| å¯¹æ¯”é¡¹ | **æ•°å­—ç­¾å** | **æ•°æ®åŠ å¯†** |
|-------|------------|------------|
| ğŸ¯ **ç›®çš„** | `è¯æ˜èº«ä»½+é˜²ç¯¡æ”¹` | `ä¿æŠ¤æ•°æ®éšç§` |
| ğŸ”‘ **å¯†é’¥ä½¿ç”¨** | `ç§é’¥ç­¾åï¼Œå…¬é’¥éªŒè¯` | `å…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†` |
| ğŸ“¦ **æ•°æ®çŠ¶æ€** | `æ˜æ–‡+ç­¾åä¸€èµ·å‘` | `å¯†æ–‡å‘é€` |
| âœ… **è§£å†³é—®é¢˜** | `è°å‘çš„ï¼Ÿè¢«æ”¹äº†å—ï¼Ÿ` | `è¢«åˆ«äººçœ‹åˆ°äº†å—ï¼Ÿ` |

---

## 5. ğŸ” å¯†é’¥ç®¡ç†å®è·µ


### 5.1 å¯†é’¥ç”Ÿæˆç­–ç•¥


**ğŸ”¸ ç”Ÿæˆå¼ºå¯†é’¥çš„è¦æ±‚**
```
å¯†é’¥é•¿åº¦ï¼š
- AESï¼šè‡³å°‘256ä½ï¼ˆ32å­—èŠ‚ï¼‰
- RSAï¼šè‡³å°‘2048ä½

éšæœºæ€§ï¼š
- ä½¿ç”¨å®‰å…¨éšæœºæ•°ç”Ÿæˆå™¨
- ä¸èƒ½ç”¨ç®€å•å­—ç¬¦ä¸²åšå¯†é’¥

ç¤ºä¾‹å¯¹æ¯”ï¼š
âŒ å¼±å¯†é’¥ï¼š"password123"
âœ… å¼ºå¯†é’¥ï¼š"A@9$mK2#pL8^nQ5&vR7*xT4%"
```

**ğŸ”¸ Javaç”Ÿæˆå®‰å…¨å¯†é’¥**
```java
@Service
public class KeyGenerationService {
    
    /**
     * ğŸ”‘ ç”ŸæˆAESå¯†é’¥
     */
    public SecretKey generateAESKey() throws Exception {
        KeyGenerator keyGen = KeyGenerator.getInstance("AES");
        keyGen.init(256); // 256ä½å¯†é’¥
        return keyGen.generateKey();
    }
    
    /**
     * ğŸ”‘ ç”ŸæˆRSAå¯†é’¥å¯¹
     */
    public KeyPair generateRSAKeyPair() throws Exception {
        KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");
        keyGen.initialize(2048); // 2048ä½å¯†é’¥
        return keyGen.generateKeyPair();
    }
}
```

### 5.2 å¯†é’¥å­˜å‚¨æ–¹æ¡ˆ


**ä¸åŒå­˜å‚¨æ–¹å¼å¯¹æ¯”**

| å­˜å‚¨æ–¹å¼ | **å®‰å…¨çº§åˆ«** | **é€‚ç”¨åœºæ™¯** | **ä¼˜ç¼ºç‚¹** |
|---------|------------|-------------|-----------|
| ğŸ”¸ **ä»£ç ç¡¬ç¼–ç ** | `â­ æä¸å®‰å…¨` | `âŒ ç¦æ­¢ä½¿ç”¨` | `å®¹æ˜“æ³„éœ²ï¼Œæ— æ³•ä¿®æ”¹` |
| ğŸ”¸ **é…ç½®æ–‡ä»¶** | `â­â­ è¾ƒä¸å®‰å…¨` | `å¼€å‘ç¯å¢ƒ` | `æ˜æ–‡å­˜å‚¨ï¼Œæ˜“è¢«æŸ¥çœ‹` |
| ğŸ”¸ **ç¯å¢ƒå˜é‡** | `â­â­â­ ä¸­ç­‰` | `ç®€å•éƒ¨ç½²` | `æœåŠ¡å™¨ä¸Šå¯èƒ½æ³„éœ²` |
| ğŸ”¸ **é…ç½®ä¸­å¿ƒ** | `â­â­â­â­ è¾ƒå®‰å…¨` | `ç”Ÿäº§ç¯å¢ƒ` | `é›†ä¸­ç®¡ç†ï¼Œæƒé™æ§åˆ¶` |
| ğŸ”¸ **å¯†é’¥ç®¡ç†ç³»ç»Ÿ** | `â­â­â­â­â­ æœ€å®‰å…¨` | `ä¼ä¸šçº§åº”ç”¨` | `ä¸“ä¸šæ–¹æ¡ˆï¼Œæˆæœ¬è¾ƒé«˜` |

**ğŸ”¸ æ¨èå­˜å‚¨æ–¹æ¡ˆ**
```java
// âŒ é”™è¯¯åšæ³•ï¼šç¡¬ç¼–ç 
public class BadExample {
    private static final String KEY = "MySecretKey123"; // ç›´æ¥å†™æ­»
}

// âœ… æ­£ç¡®åšæ³•ï¼šä»é…ç½®ä¸­å¿ƒè·å–
@Configuration
public class SecurityConfig {
    
    @Value("${encryption.aes.key}")
    private String aesKey;
    
    @Value("${encryption.rsa.private-key}")
    private String rsaPrivateKey;
}
```

### 5.3 å¯†é’¥è½®æ¢ç­–ç•¥


**ä¸ºä»€ä¹ˆè¦è½®æ¢å¯†é’¥**ï¼š
```
ğŸ”¸ å®šæœŸæ›´æ¢å¯†é’¥ï¼Œé™ä½è¢«ç ´è§£é£é™©
ğŸ”¸ å°±åƒå®šæœŸæ¢é—¨é”ï¼Œå³ä½¿é’¥åŒ™è¢«å¤åˆ¶ï¼Œæ—§é’¥åŒ™ä¹Ÿæ— æ³•å¼€æ–°é”
```

**è½®æ¢ç­–ç•¥æµç¨‹**
```
ç¬¬1é˜¶æ®µï¼šåŒå¯†é’¥å¹¶è¡Œ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ—§å¯†é’¥ â† è§£å¯†æ—§æ•°æ®              â”‚
â”‚ æ–°å¯†é’¥ â† åŠ å¯†æ–°æ•°æ®              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬2é˜¶æ®µï¼šæ•°æ®è¿ç§»
æ—§æ•°æ®ç”¨æ—§å¯†é’¥è§£å¯† â†’ ç”¨æ–°å¯†é’¥é‡æ–°åŠ å¯†

ç¬¬3é˜¶æ®µï¼šåºŸå¼ƒæ—§å¯†é’¥
æ‰€æœ‰æ•°æ®è¿ç§»å®Œæˆåï¼Œåœç”¨æ—§å¯†é’¥
```

**ğŸ’¡ å®ç°ç¤ºä¾‹**
```java
@Service
public class KeyRotationService {
    
    @Autowired
    private KeyVersionService keyVersionService;
    
    /**
     * ğŸ”„ å¯†é’¥è½®æ¢
     */
    @Scheduled(cron = "0 0 0 1 * ?") // æ¯æœˆ1å·æ‰§è¡Œ
    public void rotateKeys() {
        // 1ï¸âƒ£ ç”Ÿæˆæ–°å¯†é’¥
        SecretKey newKey = generateNewKey();
        
        // 2ï¸âƒ£ ä¿å­˜æ–°å¯†é’¥ï¼ˆç‰ˆæœ¬å·+1ï¼‰
        keyVersionService.saveKey(newKey, getCurrentVersion() + 1);
        
        // 3ï¸âƒ£ æ ‡è®°æ—§å¯†é’¥ä¸º"å³å°†åºŸå¼ƒ"
        keyVersionService.markAsDeprecated(getCurrentVersion());
        
        // 4ï¸âƒ£ è§¦å‘æ•°æ®è¿ç§»ä»»åŠ¡
        dataMigrationService.migrateWithNewKey(newKey);
    }
    
    /**
     * ğŸ“ åŠ å¯†æ—¶ä½¿ç”¨æœ€æ–°å¯†é’¥
     */
    public String encrypt(String data) {
        SecretKey latestKey = keyVersionService.getLatestKey();
        return aesService.encrypt(data, latestKey);
    }
    
    /**
     * ğŸ”“ è§£å¯†æ—¶æ ¹æ®ç‰ˆæœ¬é€‰æ‹©å¯†é’¥
     */
    public String decrypt(String encryptedData, int keyVersion) {
        SecretKey key = keyVersionService.getKey(keyVersion);
        return aesService.decrypt(encryptedData, key);
    }
}
```

### 5.4 HSMç¡¬ä»¶å®‰å…¨æ¨¡å—


**ä»€ä¹ˆæ˜¯HSM**ï¼š
```
ç¡¬ä»¶å®‰å…¨æ¨¡å—ï¼ˆHardware Security Moduleï¼‰
= ä¸“é—¨ç”¨æ¥ä¿æŠ¤å¯†é’¥çš„ç¡¬ä»¶è®¾å¤‡

å°±åƒæŠŠå¯†é’¥é”åœ¨ä¿é™©æŸœé‡Œï¼š
- å¯†é’¥æ°¸ä¸ç¦»å¼€ç¡¬ä»¶
- åªèƒ½é€šè¿‡APIè°ƒç”¨åŠ è§£å¯†
- ç‰©ç†é˜²æŠ¤é˜²æ­¢ç›—å–
```

**ğŸ”¸ HSM vs è½¯ä»¶å­˜å‚¨**

```
è½¯ä»¶å­˜å‚¨ï¼ˆå†…å­˜/æ–‡ä»¶ï¼‰ï¼š
å¯†é’¥ â†’ å­˜åœ¨æœåŠ¡å™¨å†…å­˜/ç¡¬ç›˜
é£é™©ï¼šå¯èƒ½è¢«é»‘å®¢çªƒå–

HSMç¡¬ä»¶å­˜å‚¨ï¼š
å¯†é’¥ â†’ å­˜åœ¨ä¸“ç”¨ç¡¬ä»¶èŠ¯ç‰‡
é£é™©ï¼šéœ€è¦ç‰©ç†æ¥è§¦æ‰èƒ½ç›—å–
```

**ğŸ”¸ åº”ç”¨åœºæ™¯**
- ğŸ¦ é“¶è¡Œç³»ç»Ÿï¼šä¿æŠ¤ç”¨æˆ·èµ„é‡‘å¯†é’¥
- ğŸ” CAè¯ä¹¦ä¸­å¿ƒï¼šä¿æŠ¤æ ¹è¯ä¹¦ç§é’¥
- ğŸ’³ æ”¯ä»˜ç³»ç»Ÿï¼šä¿æŠ¤äº¤æ˜“å¯†é’¥
- ğŸ¢ å¤§å‹ä¼ä¸šï¼šä¿æŠ¤æ ¸å¿ƒä¸šåŠ¡å¯†é’¥

**ğŸ’¡ Javaé›†æˆHSMç¤ºä¾‹**
```java
@Configuration
public class HSMConfig {
    
    /**
     * ğŸ” é…ç½®HSMæä¾›è€…
     */
    @Bean
    public Provider hsmProvider() {
        // ä½¿ç”¨å‚å•†æä¾›çš„HSMé©±åŠ¨
        return new LunaProvider(); // ç¤ºä¾‹ï¼šSafeNet Luna HSM
    }
    
    /**
     * ğŸ”‘ ä»HSMè·å–å¯†é’¥
     */
    public Key getKeyFromHSM(String keyAlias) throws Exception {
        KeyStore keyStore = KeyStore.getInstance("Luna");
        keyStore.load(null, hsmPin.toCharArray());
        
        return keyStore.getKey(keyAlias, null);
    }
}
```

---

## 6. ğŸ“œ è¯ä¹¦ç®¡ç†ä½“ç³»


### 6.1 æ•°å­—è¯ä¹¦æ˜¯ä»€ä¹ˆ


**é€šä¿—ç†è§£**ï¼š
æ•°å­—è¯ä¹¦å°±åƒ**ç”µå­èº«ä»½è¯**ï¼Œç”¨æ¥è¯æ˜"è¿™ä¸ªå…¬é’¥ç¡®å®å±äºæŸä¸ªäºº/ç½‘ç«™"

```
ç°å®åœºæ™¯ç±»æ¯”ï¼š

èº«ä»½è¯ï¼š
å§“åï¼šå¼ ä¸‰
èº«ä»½è¯å·ï¼šxxxxx
å‘è¯æœºå…³ï¼šå…¬å®‰å±€ âœ…ï¼ˆå®˜æ–¹è®¤è¯ï¼‰

æ•°å­—è¯ä¹¦ï¼š
ä¸»ä½“ï¼šwww.example.com
å…¬é’¥ï¼šMIIBIjANBg...
å‘è¯æœºæ„ï¼šDigiCert âœ…ï¼ˆCAè®¤è¯ï¼‰
```

### 6.2 è¯ä¹¦çš„æ ¸å¿ƒå†…å®¹


```
æ•°å­—è¯ä¹¦åŒ…å«ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æŒæœ‰è€…ä¿¡æ¯               â”‚
â”‚    - åŸŸå/å…¬å¸åç§°          â”‚
â”‚    - ç»„ç»‡ä¿¡æ¯               â”‚
â”‚                            â”‚
â”‚ 2. å…¬é’¥                    â”‚
â”‚    - RSAå…¬é’¥               â”‚
â”‚                            â”‚
â”‚ 3. æœ‰æ•ˆæœŸ                  â”‚
â”‚    - å¼€å§‹æ—¶é—´               â”‚
â”‚    - ç»“æŸæ—¶é—´               â”‚
â”‚                            â”‚
â”‚ 4. ç­¾å‘è€…ï¼ˆCAæœºæ„ï¼‰         â”‚
â”‚    - DigiCertã€Let's Encryptç­‰ â”‚
â”‚                            â”‚
â”‚ 5. æ•°å­—ç­¾å                 â”‚
â”‚    - CAç”¨ç§é’¥ç­¾å           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 è¯ä¹¦éªŒè¯æµç¨‹


```
å®¢æˆ·ç«¯                    æœåŠ¡å™¨                   CAæœºæ„
  â”‚                        â”‚                        â”‚
  â”‚  â‘ è¯·æ±‚å»ºç«‹è¿æ¥           â”‚                        â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                        â”‚
  â”‚                        â”‚                        â”‚
  â”‚  â‘¡è¿”å›è¯ä¹¦               â”‚                        â”‚
  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        â”‚
  â”‚                        â”‚                        â”‚
  â”‚  â‘¢éªŒè¯è¯ä¹¦               â”‚                        â”‚
  â”‚  - æ£€æŸ¥æœ‰æ•ˆæœŸ            â”‚                        â”‚
  â”‚  - æ£€æŸ¥åŸŸå              â”‚                        â”‚
  â”‚  - éªŒè¯ç­¾å              â”‚                        â”‚
  â”‚  ï¼ˆç”¨CAå…¬é’¥éªŒè¯ï¼‰         â”‚                        â”‚
  â”‚                        â”‚                        â”‚
  â”‚  â‘£ä¿¡ä»»è¯ä¹¦ï¼Œå»ºç«‹åŠ å¯†é€šé“   â”‚                        â”‚
  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                        â”‚
  â”‚       HTTPSé€šä¿¡         â”‚                        â”‚
```

### 6.4 Javaè¯ä¹¦ç®¡ç†


**ğŸ”¸ åŠ è½½è¯ä¹¦**
```java
@Service
public class CertificateService {
    
    /**
     * ğŸ“œ åŠ è½½è¯ä¹¦
     */
    public X509Certificate loadCertificate(String certPath) 
            throws Exception {
        
        CertificateFactory factory = 
            CertificateFactory.getInstance("X.509");
        
        FileInputStream fis = new FileInputStream(certPath);
        X509Certificate cert = 
            (X509Certificate) factory.generateCertificate(fis);
        
        return cert;
    }
    
    /**
     * âœ… éªŒè¯è¯ä¹¦
     */
    public boolean verifyCertificate(X509Certificate cert) {
        try {
            // 1ï¸âƒ£ æ£€æŸ¥æœ‰æ•ˆæœŸ
            cert.checkValidity();
            
            // 2ï¸âƒ£ éªŒè¯ç­¾åï¼ˆéœ€è¦CAå…¬é’¥ï¼‰
            PublicKey caPublicKey = loadCAPublicKey();
            cert.verify(caPublicKey);
            
            return true;
        } catch (Exception e) {
            return false;
        }
    }
}
```

**ğŸ”¸ è¯ä¹¦è¿‡æœŸå¤„ç†**
```java
@Component
public class CertificateMonitor {
    
    /**
     * â° ç›‘æ§è¯ä¹¦è¿‡æœŸ
     */
    @Scheduled(cron = "0 0 2 * * ?") // æ¯å¤©å‡Œæ™¨2ç‚¹æ£€æŸ¥
    public void checkCertificateExpiration() {
        X509Certificate cert = loadCurrentCertificate();
        Date expiryDate = cert.getNotAfter();
        
        long daysUntilExpiry = ChronoUnit.DAYS.between(
            LocalDate.now(), 
            expiryDate.toInstant()
        );
        
        if (daysUntilExpiry <= 30) {
            // ğŸ”” è¯ä¹¦å³å°†è¿‡æœŸï¼Œå‘é€å‘Šè­¦
            alertService.sendAlert(
                "è¯ä¹¦å°†åœ¨" + daysUntilExpiry + "å¤©åè¿‡æœŸï¼Œè¯·åŠæ—¶æ›´æ–°"
            );
        }
    }
}
```

---

## 7. âš¡ åŠ å¯†æ€§èƒ½ä¼˜åŒ–


### 7.1 æ€§èƒ½ç“¶é¢ˆåˆ†æ


**ä¸åŒåŠ å¯†ç®—æ³•çš„æ€§èƒ½å¯¹æ¯”**

| ç®—æ³• | **åŠ å¯†1MBæ•°æ®è€—æ—¶** | **é€‚ç”¨åœºæ™¯** |
|------|-------------------|-------------|
| ğŸ”¸ **AES** | `~1-5ms` | `å¤§æ•°æ®åŠ å¯†` |
| ğŸ”¸ **RSA-2048** | `~500ms` | `å°æ•°æ®/å¯†é’¥äº¤æ¢` |
| ğŸ”¸ **RSA-4096** | `~2000ms` | `è¶…é«˜å®‰å…¨åœºæ™¯` |

> ğŸ’¡ **æ€§èƒ½è§„å¾‹**  
> AESé€Ÿåº¦æ˜¯RSAçš„å‡ ç™¾å€ï¼Œæ‰€ä»¥å®é™…åº”ç”¨ä¸­é€šå¸¸ç»„åˆä½¿ç”¨

### 7.2 æ··åˆåŠ å¯†æ–¹æ¡ˆ


**æ ¸å¿ƒæ€æƒ³**ï¼šç”¨RSAä¼ é€’AESå¯†é’¥ï¼Œç”¨AESåŠ å¯†å®é™…æ•°æ®

```
å‘é€æ–¹                                    æ¥æ”¶æ–¹
  â”‚                                        â”‚
  â”‚ â‘ ç”ŸæˆéšæœºAESå¯†é’¥                        â”‚
  â”‚  aesKey = "A@9$mK2#..."               â”‚
  â”‚                                        â”‚
  â”‚ â‘¡ç”¨RSAå…¬é’¥åŠ å¯†AESå¯†é’¥                   â”‚
  â”‚  encryptedKey = RSA(aesKey, å…¬é’¥)     â”‚
  â”‚                                        â”‚
  â”‚ â‘¢ç”¨AESåŠ å¯†å®é™…æ•°æ®                      â”‚
  â”‚  encryptedData = AES(data, aesKey)    â”‚
  â”‚                                        â”‚
  â”‚ â‘£å‘é€åŠ å¯†åçš„å¯†é’¥+æ•°æ®                   â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
  â”‚  {encryptedKey, encryptedData}        â”‚
  â”‚                                        â”‚
  â”‚                          â‘¤ç”¨RSAç§é’¥è§£å¯†AESå¯†é’¥ â”‚
  â”‚                          aesKey = RSA(encryptedKey, ç§é’¥) â”‚
  â”‚                                        â”‚
  â”‚                          â‘¥ç”¨AESå¯†é’¥è§£å¯†æ•°æ® â”‚
  â”‚                          data = AES(encryptedData, aesKey) â”‚

ä¼˜åŠ¿ï¼š
âœ… RSAåªåŠ å¯†å°æ•°æ®ï¼ˆå¯†é’¥ï¼‰ï¼Œé€Ÿåº¦å¿«
âœ… AESåŠ å¯†å¤§æ•°æ®ï¼Œæ•ˆç‡é«˜
âœ… ç»“åˆä¸¤è€…ä¼˜åŠ¿
```

**ğŸ’¡ Javaå®ç°**
```java
@Service
public class HybridEncryptionService {
    
    /**
     * ğŸ” æ··åˆåŠ å¯†
     */
    public EncryptedMessage hybridEncrypt(String data, PublicKey publicKey) 
            throws Exception {
        
        // 1ï¸âƒ£ ç”ŸæˆéšæœºAESå¯†é’¥
        KeyGenerator keyGen = KeyGenerator.getInstance("AES");
        keyGen.init(256);
        SecretKey aesKey = keyGen.generateKey();
        
        // 2ï¸âƒ£ ç”¨AESåŠ å¯†æ•°æ®ï¼ˆå¿«ï¼‰
        Cipher aesCipher = Cipher.getInstance("AES/GCM/NoPadding");
        aesCipher.init(Cipher.ENCRYPT_MODE, aesKey);
        byte[] encryptedData = aesCipher.doFinal(data.getBytes());
        
        // 3ï¸âƒ£ ç”¨RSAåŠ å¯†AESå¯†é’¥ï¼ˆæ…¢ï¼Œä½†åªåŠ å¯†32å­—èŠ‚ï¼‰
        Cipher rsaCipher = Cipher.getInstance("RSA");
        rsaCipher.init(Cipher.ENCRYPT_MODE, publicKey);
        byte[] encryptedKey = rsaCipher.doFinal(aesKey.getEncoded());
        
        // 4ï¸âƒ£ è¿”å›ä¸¤éƒ¨åˆ†
        return new EncryptedMessage(encryptedKey, encryptedData);
    }
}
```

### 7.3 ç¼“å­˜ä¸å¤ç”¨ç­–ç•¥


**ğŸ”¸ å¯†é’¥å¯¹è±¡ç¼“å­˜**
```java
@Service
public class KeyCacheService {
    
    // ç¼“å­˜å¯†é’¥å¯¹è±¡ï¼Œé¿å…é‡å¤ç”Ÿæˆ
    private final LoadingCache<String, SecretKey> keyCache = 
        CacheBuilder.newBuilder()
            .maximumSize(100)
            .expireAfterWrite(1, TimeUnit.HOURS)
            .build(new CacheLoader<String, SecretKey>() {
                public SecretKey load(String keyId) {
                    return loadKeyFromStore(keyId);
                }
            });
    
    public SecretKey getKey(String keyId) {
        return keyCache.getUnchecked(keyId);
    }
}
```

**ğŸ”¸ Cipherå¯¹è±¡æ± **
```java
@Component
public class CipherPool {
    
    // å¯¹è±¡æ± ï¼Œå¤ç”¨Cipherå®ä¾‹
    private final GenericObjectPool<Cipher> cipherPool;
    
    public CipherPool() {
        this.cipherPool = new GenericObjectPool<>(
            new CipherFactory(),
            new GenericObjectPoolConfig()
        );
    }
    
    /**
     * ğŸ”„ å€Ÿç”¨Cipherå¯¹è±¡
     */
    public Cipher borrowCipher() throws Exception {
        return cipherPool.borrowObject();
    }
    
    /**
     * â†©ï¸ å½’è¿˜Cipherå¯¹è±¡
     */
    public void returnCipher(Cipher cipher) {
        cipherPool.returnObject(cipher);
    }
}
```

### 7.4 å¼‚æ­¥åŠ å¯†å¤„ç†


**åœºæ™¯**ï¼šå¤§æ‰¹é‡æ•°æ®åŠ å¯†ï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹

```java
@Service
public class AsyncEncryptionService {
    
    @Async("encryptionExecutor")
    public CompletableFuture<String> encryptAsync(String data) {
        // å¼‚æ­¥æ‰§è¡ŒåŠ å¯†æ“ä½œ
        return CompletableFuture.supplyAsync(() -> {
            try {
                return aesService.encrypt(data);
            } catch (Exception e) {
                throw new CompletionException(e);
            }
        });
    }
    
    /**
     * ğŸ“¦ æ‰¹é‡åŠ å¯†
     */
    public List<String> batchEncrypt(List<String> dataList) 
            throws Exception {
        
        // å¹¶è¡ŒåŠ å¯†å¤šæ¡æ•°æ®
        List<CompletableFuture<String>> futures = dataList.stream()
            .map(this::encryptAsync)
            .collect(Collectors.toList());
        
        // ç­‰å¾…æ‰€æœ‰åŠ å¯†å®Œæˆ
        return futures.stream()
            .map(CompletableFuture::join)
            .collect(Collectors.toList());
    }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 åŠ å¯†ç®—æ³•é€‰æ‹©æŒ‡å—


**ğŸ¯ å¿«é€Ÿå†³ç­–æ ‘**
```
éœ€è¦åŠ å¯†çš„æ•°æ®ï¼Ÿ
    â”‚
    â”œâ”€ å¤§é‡æ•°æ®ï¼ˆ>1KBï¼‰ â†’ ä½¿ç”¨AESå¯¹ç§°åŠ å¯†
    â”‚   â””â”€ æ¨èï¼šAES-256-GCMæ¨¡å¼
    â”‚
    â”œâ”€ å°‘é‡æ•°æ®ï¼ˆå¯†é’¥ã€å¯†ç ï¼‰ â†’ ä½¿ç”¨RSAéå¯¹ç§°åŠ å¯†
    â”‚   â””â”€ æ¨èï¼šRSA-2048æˆ–æ›´é«˜
    â”‚
    â””â”€ å¤§æ•°æ® + å¯†é’¥ä¼ è¾“ â†’ ä½¿ç”¨æ··åˆåŠ å¯†
        â””â”€ RSAä¼ è¾“AESå¯†é’¥ + AESåŠ å¯†æ•°æ®
```

### 8.2 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ”¸ åŠ å¯†åŸºç¡€ä¸‰è¦ç´ **
```
1ï¸âƒ£ æ˜æ–‡/å¯†æ–‡è½¬æ¢
   - æ˜æ–‡ + å¯†é’¥ + ç®—æ³• = å¯†æ–‡
   - å¯†æ–‡ + å¯†é’¥ + ç®—æ³• = æ˜æ–‡

2ï¸âƒ£ å¯¹ç§° vs éå¯¹ç§°
   - å¯¹ç§°ï¼šä¸€æŠŠé’¥åŒ™ï¼Œé€Ÿåº¦å¿«
   - éå¯¹ç§°ï¼šä¸¤æŠŠé’¥åŒ™ï¼Œæ›´å®‰å…¨

3ï¸âƒ£ åŠ å¯† vs ç­¾å
   - åŠ å¯†ï¼šä¿æŠ¤éšç§
   - ç­¾åï¼šè¯æ˜èº«ä»½
```

**ğŸ”¸ å®é™…åº”ç”¨è¦ç‚¹**

| åœºæ™¯ | **æ¨èæ–¹æ¡ˆ** | **å…³é”®é…ç½®** |
|------|------------|-------------|
| ğŸ” **å¯†ç å­˜å‚¨** | `BCryptå“ˆå¸Œ` | `ä¸å¯é€†åŠ å¯†` |
| ğŸ”’ **æ•æ„Ÿæ•°æ®** | `AES-256-GCM` | `å¯†é’¥å­˜é…ç½®ä¸­å¿ƒ` |
| ğŸ”‘ **å¯†é’¥ä¼ è¾“** | `RSA-2048` | `å…¬é’¥å…¬å¼€ï¼Œç§é’¥ä¿å¯†` |
| âœï¸ **APIç­¾å** | `SHA256withRSA` | `ç§é’¥ç­¾åï¼Œå…¬é’¥éªŒè¯` |

### 8.3 å®‰å…¨æœ€ä½³å®è·µæ¸…å•


**âœ… å¯†é’¥ç®¡ç†æ£€æŸ¥æ¸…å•**
- [ ] å¯†é’¥ä¸ç¡¬ç¼–ç åœ¨ä»£ç ä¸­
- [ ] å¯†é’¥å­˜å‚¨åœ¨å®‰å…¨çš„é…ç½®ä¸­å¿ƒ
- [ ] å®šæœŸè½®æ¢å¯†é’¥ï¼ˆå»ºè®®æ¯å­£åº¦ï¼‰
- [ ] ä½¿ç”¨å¼ºéšæœºæ•°ç”Ÿæˆå¯†é’¥
- [ ] å¯†é’¥é•¿åº¦æ»¡è¶³å®‰å…¨æ ‡å‡†ï¼ˆAES-256, RSA-2048+ï¼‰
- [ ] ç§é’¥æƒé™ä¸¥æ ¼æ§åˆ¶
- [ ] è®°å½•å¯†é’¥çš„ä½¿ç”¨æ—¥å¿—

**âœ… åŠ å¯†å®ç°æ£€æŸ¥æ¸…å•**
- [ ] ä½¿ç”¨æ ‡å‡†åŠ å¯†åº“ï¼ˆJCA/JCEï¼‰
- [ ] é€‰æ‹©åˆé€‚çš„åŠ å¯†æ¨¡å¼ï¼ˆæ¨èGCMï¼‰
- [ ] å¯¹æ•æ„Ÿæ•°æ®ä¼ è¾“ä½¿ç”¨HTTPS
- [ ] APIè°ƒç”¨ä½¿ç”¨ç­¾åéªŒè¯
- [ ] è¯ä¹¦å®šæœŸæ£€æŸ¥æœ‰æ•ˆæœŸ
- [ ] å¼‚å¸¸å¤„ç†ä¸æš´éœ²åŠ å¯†ç»†èŠ‚
- [ ] æ€§èƒ½æµ‹è¯•åŠ å¯†å¯¹ç³»ç»Ÿçš„å½±å“

### 8.4 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


**ğŸ”¸ é—®é¢˜1ï¼šåŠ å¯†åæ•°æ®å˜å¤§ï¼Œå½±å“æ€§èƒ½ï¼Ÿ**
```
âœ… è§£å†³æ–¹æ¡ˆï¼š
- åªåŠ å¯†æ•æ„Ÿå­—æ®µï¼Œéæ•æ„Ÿæ•°æ®ä¸åŠ å¯†
- ä½¿ç”¨æ•°æ®å‹ç¼©å†åŠ å¯†
- æ•°æ®åº“å­˜å‚¨ä½¿ç”¨BLOBç±»å‹
```

**ğŸ”¸ é—®é¢˜2ï¼šå¯†é’¥æ³„éœ²æ€ä¹ˆåŠï¼Ÿ**
```
âœ… åº”æ€¥å“åº”ï¼š
1. ç«‹å³åœç”¨æ³„éœ²çš„å¯†é’¥
2. å¯ç”¨æ–°å¯†é’¥
3. é‡æ–°åŠ å¯†æ‰€æœ‰æ•°æ®
4. å®¡è®¡å¯†é’¥è®¿é—®æ—¥å¿—
5. åŠ å¼ºå¯†é’¥æƒé™æ§åˆ¶
```

**ğŸ”¸ é—®é¢˜3ï¼šå¦‚ä½•åœ¨å¾®æœåŠ¡é—´å®‰å…¨ä¼ è¾“æ•°æ®ï¼Ÿ**
```
âœ… æ¨èæ–¹æ¡ˆï¼š
1. æœåŠ¡é—´é€šä¿¡ä½¿ç”¨mTLSï¼ˆåŒå‘TLSï¼‰
2. APIè°ƒç”¨æ·»åŠ ç­¾åéªŒè¯
3. æ•æ„Ÿæ•°æ®ä½¿ç”¨æ··åˆåŠ å¯†
4. ä½¿ç”¨æœåŠ¡ç½‘æ ¼ï¼ˆIstioï¼‰ç»Ÿä¸€ç®¡ç†å®‰å…¨ç­–ç•¥
```

### 8.5 å­¦ä¹ è·¯å¾„å»ºè®®


**ğŸ—ºï¸ è¿›é˜¶å­¦ä¹ æ–¹å‘**
```
å½“å‰é˜¶æ®µï¼šåŠ å¯†ç®—æ³•ä¸å¯†é’¥ç®¡ç† âœ…
    â†“
ä¸‹ä¸€æ­¥ï¼šOAuth2ä¸JWTè®¤è¯
    â†“
è¿›é˜¶ï¼šé›¶ä¿¡ä»»å®‰å…¨æ¶æ„
    â†“
é«˜çº§ï¼šå®‰å…¨åˆè§„ä¸å®¡è®¡
```

**ğŸ”— æ‰©å±•çŸ¥è¯†é“¾æ¥**
- ç›¸å…³ç« èŠ‚ï¼š[JWTä»¤ç‰Œæœºåˆ¶](#jwtä»¤ç‰Œ) | [OAuth2è®¤è¯](#oauth2)
- å®æˆ˜é¡¹ç›®ï¼š[å®‰å…¨çš„ç”¨æˆ·è®¤è¯ç³»ç»Ÿ](#å®æˆ˜æ¡ˆä¾‹)
- æ·±å…¥ç†è§£ï¼š[å¯†ç å­¦åŸç†](#å¯†ç å­¦åŸºç¡€)

---

**ğŸ§  è®°å¿†è¦ç‚¹**
```
AESå¿«å¦‚é—ªç”µåŠ å¤§æ•°æ®ï¼ŒRSAç¨³å¦‚ç£çŸ³ä¼ å¯†é’¥
æ•°å­—ç­¾åè¯èº«ä»½ï¼Œæ··åˆåŠ å¯†ä¸¤ç›¸å®œ
å¯†é’¥ç®¡ç†é‡ä¸­é‡ï¼Œè½®æ¢ç›‘æ§ä¸èƒ½å¿˜
è¯ä¹¦è¿‡æœŸè¦æé†’ï¼Œæ€§èƒ½ä¼˜åŒ–ç¼“å­˜å…ˆ
```

**ğŸ’ª å®æˆ˜å»ºè®®**
- ä»ç®€å•çš„AESåŠ å¯†å¼€å§‹ç»ƒä¹ 
- é€æ­¥ç†è§£RSAå’Œæ•°å­—ç­¾å
- åœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨æ··åˆåŠ å¯†æ–¹æ¡ˆ
- å…³æ³¨å¯†é’¥å®‰å…¨å’Œæ€§èƒ½ä¼˜åŒ–