---
title: 1ã€åˆ†å¸ƒå¼é”åŸºç¡€æ¦‚å¿µ
---
## ğŸ“š ç›®å½•

1. [åˆ†å¸ƒå¼é”åŸºç¡€æ¦‚å¿µ](#1-åˆ†å¸ƒå¼é”åŸºç¡€æ¦‚å¿µ)
2. [å¹¶å‘å†²çªé—®é¢˜åˆ†æ](#2-å¹¶å‘å†²çªé—®é¢˜åˆ†æ)
3. [åˆ†å¸ƒå¼é”æ ¸å¿ƒç‰¹æ€§](#3-åˆ†å¸ƒå¼é”æ ¸å¿ƒç‰¹æ€§)
4. [åˆ†å¸ƒå¼é”å®ç°æ–¹æ¡ˆ](#4-åˆ†å¸ƒå¼é”å®ç°æ–¹æ¡ˆ)
5. [æ€§èƒ½ä¸ä¼˜åŒ–ç­–ç•¥](#5-æ€§èƒ½ä¸ä¼˜åŒ–ç­–ç•¥)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” åˆ†å¸ƒå¼é”åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”


**ğŸ  ç”Ÿæ´»ç±»æ¯”**
> æƒ³è±¡ä¸€ä¸‹å®¶é‡Œçš„å«ç”Ÿé—´ï¼ŒåŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªäººä½¿ç”¨ã€‚å½“æœ‰äººåœ¨é‡Œé¢æ—¶ï¼Œé—¨å°±é”ä¸Šäº†ï¼Œå…¶ä»–äººåªèƒ½åœ¨å¤–é¢ç­‰å¾…ã€‚åˆ†å¸ƒå¼é”å°±æ˜¯è¿™ä¸ªé“ç†ï¼Œä½†æ˜¯èŒƒå›´æ‰©å¤§åˆ°äº†æ•´ä¸ªç½‘ç»œä¸­çš„å¤šä¸ªæœåŠ¡å™¨ã€‚

**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
åˆ†å¸ƒå¼é”ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç”¨æ¥æ§åˆ¶å¤šä¸ªèŠ‚ç‚¹å¯¹å…±äº«èµ„æºè®¿é—®çš„ä¸€ç§æœºåˆ¶

ä½œç”¨ï¼šç¡®ä¿åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹èƒ½å¤Ÿæ“ä½œæŸä¸ªèµ„æº
ç›®çš„ï¼šé¿å…æ•°æ®å†²çªå’Œä¸ä¸€è‡´é—®é¢˜
èŒƒå›´ï¼šè·¨æœåŠ¡å™¨ã€è·¨è¿›ç¨‹çš„å…¨å±€é”æœºåˆ¶
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼é”


**ğŸ” é—®é¢˜åœºæ™¯**
```
å•æœºç¯å¢ƒ vs åˆ†å¸ƒå¼ç¯å¢ƒå¯¹æ¯”ï¼š

å•æœºç¯å¢ƒï¼š
åº”ç”¨ç¨‹åº â†’ æœ¬åœ°é” â†’ å…±äº«èµ„æº
(åªæœ‰ä¸€å°æœåŠ¡å™¨ï¼ŒJavaçš„synchronizedå°±å¤Ÿç”¨)

åˆ†å¸ƒå¼ç¯å¢ƒï¼š
æœåŠ¡å™¨A â†’ åº”ç”¨A â†’ å…±äº«èµ„æº
æœåŠ¡å™¨B â†’ åº”ç”¨B â†’ å…±äº«èµ„æº  
æœåŠ¡å™¨C â†’ åº”ç”¨C â†’ å…±äº«èµ„æº
(å¤šå°æœåŠ¡å™¨ï¼Œæœ¬åœ°é”æ— æ³•è·¨æœºå™¨åè°ƒ)
```

**ğŸ’¡ å…³é”®æ´å¯Ÿ**
> Javaçš„synchronizedå’ŒReentrantLockåªèƒ½åœ¨å•ä¸ªJVMå†…ç”Ÿæ•ˆï¼Œæ— æ³•è·¨æœåŠ¡å™¨åè°ƒã€‚åˆ†å¸ƒå¼é”å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªè·¨æœºå™¨çš„åè°ƒé—®é¢˜ã€‚

**ğŸ“Š å®é™…åº”ç”¨åœºæ™¯**

| åœºæ™¯ | é—®é¢˜æè¿° | åˆ†å¸ƒå¼é”ä½œç”¨ |
|------|----------|-------------|
| **åº“å­˜æ‰£å‡** | å¤šä¸ªç”¨æˆ·åŒæ—¶ä¸‹å•åŒä¸€å•†å“ | ç¡®ä¿åº“å­˜å‡†ç¡®æ‰£å‡ï¼Œé¿å…è¶…å– |
| **è®¢å•å·ç”Ÿæˆ** | å¤šä¸ªæœåŠ¡åŒæ—¶ç”Ÿæˆè®¢å•å· | ä¿è¯è®¢å•å·å”¯ä¸€æ€§ |
| **å®šæ—¶ä»»åŠ¡** | å¤šä¸ªèŠ‚ç‚¹æ‰§è¡Œç›¸åŒå®šæ—¶ä»»åŠ¡ | ç¡®ä¿ä»»åŠ¡åªè¢«æ‰§è¡Œä¸€æ¬¡ |
| **ç¼“å­˜æ›´æ–°** | å¤šä¸ªæœåŠ¡åŒæ—¶æ›´æ–°ç¼“å­˜ | é¿å…ç¼“å­˜æ•°æ®ä¸ä¸€è‡´ |

---

## 2. âš¡ å¹¶å‘å†²çªé—®é¢˜åˆ†æ


### 2.1 å¹¶å‘å†²çªçš„æœ¬è´¨


**ğŸ¤” è‡ªæˆ‘æ£€æµ‹**
Q: ä¸ºä»€ä¹ˆå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å…±äº«èµ„æºä¼šå‡ºé—®é¢˜ï¼Ÿ
A: å› ä¸ºæ“ä½œä¸æ˜¯åŸå­æ€§çš„ï¼Œå¯èƒ½è¢«å…¶ä»–çº¿ç¨‹æ‰“æ–­

**ğŸ“ˆ é—®é¢˜æ¼”ç¤º**
```java
// åº“å­˜æ‰£å‡çš„ç»å…¸é—®é¢˜
public class StockService {
    private int stock = 100; // å•†å“åº“å­˜
    
    // å±é™©çš„æ‰£åº“å­˜æ–¹æ³•
    public boolean decreaseStock() {
        // æ­¥éª¤1ï¼šè¯»å–åº“å­˜
        int currentStock = stock;
        
        // æ­¥éª¤2ï¼šåˆ¤æ–­åº“å­˜å¤Ÿä¸å¤Ÿ
        if (currentStock > 0) {
            // æ­¥éª¤3ï¼šæ‰£å‡åº“å­˜
            stock = currentStock - 1;
            return true;
        }
        return false;
    }
}
```

**âš ï¸ é—®é¢˜åˆ†æ**
```
å¹¶å‘æ‰§è¡Œæ—¶çš„é—®é¢˜ï¼š
æ—¶åˆ»1ï¼šçº¿ç¨‹Aè¯»å–stock=100
æ—¶åˆ»2ï¼šçº¿ç¨‹Bè¯»å–stock=100  (è¿˜æ²¡æ¥å¾—åŠæ›´æ–°)
æ—¶åˆ»3ï¼šçº¿ç¨‹Aè®¡ç®—100-1=99ï¼Œæ›´æ–°stock=99
æ—¶åˆ»4ï¼šçº¿ç¨‹Bè®¡ç®—100-1=99ï¼Œæ›´æ–°stock=99

ç»“æœï¼šä¸¤ä¸ªç”¨æˆ·ä¸‹å•ï¼Œä½†åº“å­˜åªå‡å°‘äº†1
```

### 2.2 ä¸´ç•Œèµ„æºä¿æŠ¤


**ğŸ”¸ ä¸´ç•Œèµ„æºçš„æ¦‚å¿µ**
```
ä¸´ç•Œèµ„æºï¼šåŒæ—¶åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹/è¿›ç¨‹è®¿é—®çš„èµ„æº
ç‰¹ç‚¹ï¼š
â€¢ å…±äº«æ€§ï¼šå¤šä¸ªæ‰§è¡Œå•å…ƒéƒ½éœ€è¦è®¿é—®
â€¢ äº’æ–¥æ€§ï¼šåŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªåœ¨è®¿é—®
â€¢ æœ‰é™æ€§ï¼šèµ„æºæ•°é‡æœ‰é™åˆ¶

å¸¸è§ä¸´ç•Œèµ„æºï¼š
â€¢ æ•°æ®åº“è®°å½•
â€¢ æ–‡ä»¶ç³»ç»Ÿ
â€¢ å…±äº«å†…å­˜
â€¢ ç½‘ç»œè¿æ¥
```

**ğŸ›¡ï¸ ä¿æŠ¤æœºåˆ¶**
```
æœ¬åœ°é”ä¿æŠ¤ï¼š
synchronized (this) {
    // ä¸´ç•ŒåŒºä»£ç 
    stock = stock - 1;
}

åˆ†å¸ƒå¼é”ä¿æŠ¤ï¼š
if (distributedLock.tryLock("stock_key")) {
    try {
        // ä¸´ç•ŒåŒºä»£ç 
        stock = stock - 1;
    } finally {
        distributedLock.unlock("stock_key");
    }
}
```

---

## 3. ğŸ¯ åˆ†å¸ƒå¼é”æ ¸å¿ƒç‰¹æ€§


### 3.1 äº’æ–¥æ€§è¦æ±‚


**ğŸ”¸ åŸºæœ¬äº’æ–¥æ€§**
```
å®šä¹‰ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒåŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹èƒ½è·å–åˆ°é”
å®ç°ï¼šé€šè¿‡æŸç§å…¨å±€åè°ƒæœºåˆ¶ç¡®ä¿å”¯ä¸€æ€§

æŠ€æœ¯å®ç°æ–¹å¼ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æœåŠ¡A     â”‚    â”‚   æœåŠ¡B     â”‚    â”‚   æœåŠ¡C     â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                  â”‚                  â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  Redis/ZK   â”‚ â† å…¨å±€åè°ƒè€…
                  â”‚ åˆ†å¸ƒå¼é”æœåŠ¡ â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ’ª å®è·µæŒ‘æˆ˜**
å°è¯•æ€è€ƒï¼šå¦‚æœæ²¡æœ‰å…¨å±€åè°ƒè€…ï¼Œå¤šä¸ªæœåŠ¡æ€ä¹ˆçŸ¥é“è°å…ˆè·å–åˆ°äº†é”ï¼Ÿ

### 3.2 å¯é‡å…¥æ€§è®¾è®¡


**ğŸ“ ä»€ä¹ˆæ˜¯å¯é‡å…¥**
```
å¯é‡å…¥é”ï¼šåŒä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¤šæ¬¡è·å–åŒä¸€æŠŠé”

ä¸ºä»€ä¹ˆéœ€è¦å¯é‡å…¥ï¼š
æ–¹æ³•Aè·å–é” â†’ è°ƒç”¨æ–¹æ³•B â†’ æ–¹æ³•Bä¹Ÿéœ€è¦åŒä¸€æŠŠé”
å¦‚æœä¸å¯é‡å…¥ï¼Œå°±ä¼šæ­»é”

Javaæœ¬åœ°é”ç¤ºä¾‹ï¼š
synchronizedæ–¹æ³•A() {
    // å·²ç»æŒæœ‰é”
    æ–¹æ³•B(); // è°ƒç”¨å¦ä¸€ä¸ªsynchronizedæ–¹æ³•
}
synchronizedæ–¹æ³•B() {
    // éœ€è¦å†æ¬¡è·å–åŒä¸€æŠŠé”
}
```

**ğŸ”§ åˆ†å¸ƒå¼é”çš„å¯é‡å…¥å®ç°**
```java
// Rediså®ç°å¯é‡å…¥é”çš„æ ¸å¿ƒæ€è·¯
public class RedisDistributedLock {
    private String lockKey;
    private String threadId;
    private int reentrantCount = 0; // é‡å…¥æ¬¡æ•°è®¡æ•°
    
    public boolean tryLock() {
        String currentThreadId = getCurrentThreadId();
        
        // å¦‚æœæ˜¯åŒä¸€çº¿ç¨‹é‡å…¥
        if (currentThreadId.equals(this.threadId)) {
            reentrantCount++;
            return true;
        }
        
        // å°è¯•è·å–æ–°é”
        boolean success = redisTemplate.setIfAbsent(lockKey, currentThreadId);
        if (success) {
            this.threadId = currentThreadId;
            reentrantCount = 1;
        }
        return success;
    }
}
```

### 3.3 é”è¶…æ—¶æœºåˆ¶


**â° ä¸ºä»€ä¹ˆéœ€è¦è¶…æ—¶**
```
é—®é¢˜åœºæ™¯ï¼š
1. æŒé”æœåŠ¡çªç„¶å®•æœº
2. ç½‘ç»œåˆ†åŒºå¯¼è‡´æ— æ³•é‡Šæ”¾é”
3. ä¸šåŠ¡é€»è¾‘æ‰§è¡Œæ—¶é—´è¿‡é•¿

åæœï¼šå…¶ä»–æœåŠ¡æ°¸è¿œè·å–ä¸åˆ°é”ï¼Œç³»ç»Ÿæ­»é”
```

**ğŸ¯ è¶…æ—¶æœºåˆ¶è®¾è®¡**
```
ä¸¤ç§è¶…æ—¶ç­–ç•¥ï¼š

1. è·å–é”è¶…æ—¶ï¼ˆç­‰å¾…è¶…æ—¶ï¼‰
try {
    if (lock.tryLock(5, TimeUnit.SECONDS)) {
        // è·å–åˆ°é”ï¼Œæ‰§è¡Œä¸šåŠ¡
    } else {
        // 5ç§’å†…æ²¡è·å–åˆ°é”ï¼Œæ”¾å¼ƒæˆ–é‡è¯•
    }
}

2. é”æŒæœ‰è¶…æ—¶ï¼ˆè‡ªåŠ¨é‡Šæ”¾ï¼‰
Redis SET key value EX 30  // 30ç§’åè‡ªåŠ¨è¿‡æœŸ
```

**ğŸ“Š è¶…æ—¶æ—¶é—´è®¾è®¡åŸåˆ™**

| ä¸šåŠ¡ç±»å‹ | å»ºè®®è¶…æ—¶æ—¶é—´ | åŸå›  |
|----------|--------------|------|
| **å¿«é€Ÿæ“ä½œ** | 1-5ç§’ | å¦‚è®¡æ•°å™¨å¢å‡ã€ç®€å•æŸ¥è¯¢ |
| **æ•°æ®åº“æ“ä½œ** | 10-30ç§’ | åŒ…å«äº‹åŠ¡æäº¤æ—¶é—´ |
| **æ–‡ä»¶å¤„ç†** | 60-300ç§’ | å¤§æ–‡ä»¶å¤„ç†è€—æ—¶è¾ƒé•¿ |
| **å¤–éƒ¨APIè°ƒç”¨** | 30-60ç§’ | ç½‘ç»œå»¶è¿Ÿå’Œç¬¬ä¸‰æ–¹å“åº”æ—¶é—´ |

### 3.4 æ­»é”é¢„é˜²ç­–ç•¥


**ğŸš¨ å¸¸è§æ­»é”åœºæ™¯**
```
åœºæ™¯1ï¼šå¾ªç¯ç­‰å¾…
æœåŠ¡AæŒæœ‰é”1ï¼Œç­‰å¾…é”2
æœåŠ¡BæŒæœ‰é”2ï¼Œç­‰å¾…é”1
â†’ å½¢æˆæ­»é”

åœºæ™¯2ï¼šé”æœªé‡Šæ”¾
æœåŠ¡Aè·å–é”åå¼‚å¸¸é€€å‡º
å…¶ä»–æœåŠ¡æ°¸è¿œç­‰å¾…
â†’ å½¢æˆæ­»é”
```

**ğŸ›¡ï¸ é¢„é˜²ç­–ç•¥**

**ç­–ç•¥1ï¼šç»Ÿä¸€é”é¡ºåº**
```java
// é”™è¯¯åšæ³•ï¼šä¸åŒé¡ºåºåŠ é”
void transfer(Account from, Account to) {
    lock(from.getId());  // å…ˆé”from
    lock(to.getId());    // å†é”to
}

// æ­£ç¡®åšæ³•ï¼šç»Ÿä¸€é¡ºåºåŠ é”
void transfer(Account from, Account to) {
    String firstLock = from.getId().compareTo(to.getId()) < 0 
        ? from.getId() : to.getId();
    String secondLock = from.getId().equals(firstLock) 
        ? to.getId() : from.getId();
    
    lock(firstLock);   // æ€»æ˜¯æŒ‰ç›¸åŒé¡ºåºåŠ é”
    lock(secondLock);
}
```

**ç­–ç•¥2ï¼šè¶…æ—¶æœºåˆ¶**
```java
// è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´
if (lock.tryLock(lockKey, 10, TimeUnit.SECONDS)) {
    try {
        // ä¸šåŠ¡é€»è¾‘
    } finally {
        lock.unlock(lockKey);
    }
} else {
    // è¶…æ—¶å¤„ç†ï¼šè®°å½•æ—¥å¿—ã€é‡è¯•æˆ–è¿”å›é”™è¯¯
}
```

---

## 4. ğŸ—ï¸ åˆ†å¸ƒå¼é”å®ç°æ–¹æ¡ˆ


### 4.1 åŸºäºRedisçš„å®ç°


**ğŸ”§ Redisåˆ†å¸ƒå¼é”åŸç†**
```
æ ¸å¿ƒå‘½ä»¤ï¼šSET key value [EX seconds] [NX]
â€¢ NX: åªæœ‰keyä¸å­˜åœ¨æ—¶æ‰è®¾ç½®
â€¢ EX: è®¾ç½®è¿‡æœŸæ—¶é—´
â€¢ åŸå­æ€§: SETå‘½ä»¤æ˜¯åŸå­æ“ä½œ

å·¥ä½œæµç¨‹ï¼š
1. SET lock_key thread_id EX 30 NX
2. å¦‚æœè¿”å›OKï¼Œè¡¨ç¤ºè·å–é”æˆåŠŸ
3. å¦‚æœè¿”å›nilï¼Œè¡¨ç¤ºé”å·²è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰
```

**ğŸ’» ç®€åŒ–å®ç°ç¤ºä¾‹**
```java
@Component
public class RedisDistributedLock {
    
    @Autowired
    private RedisTemplate<String, String> redisTemplate;
    
    /**
     * å°è¯•è·å–é”
     * @param lockKey é”çš„å”¯ä¸€æ ‡è¯†
     * @param timeout é”è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
     * @return è·å–æˆåŠŸè¿”å›true
     */
    public boolean tryLock(String lockKey, long timeout) {
        String threadId = getCurrentThreadId();
        
        // ä½¿ç”¨Redisçš„SET NX EXå®ç°åŸå­æ€§åŠ é”
        Boolean result = redisTemplate.opsForValue()
            .setIfAbsent(lockKey, threadId, Duration.ofSeconds(timeout));
            
        return Boolean.TRUE.equals(result);
    }
    
    /**
     * é‡Šæ”¾é”
     */
    public void unlock(String lockKey) {
        String threadId = getCurrentThreadId();
        
        // Luaè„šæœ¬ç¡®ä¿åªèƒ½é‡Šæ”¾è‡ªå·±çš„é”
        String luaScript = 
            "if redis.call('get', KEYS[1]) == ARGV[1] then " +
            "return redis.call('del', KEYS[1]) " +
            "else return 0 end";
            
        redisTemplate.execute((RedisCallback<Long>) connection -> {
            return connection.eval(
                luaScript.getBytes(),
                ReturnType.INTEGER,
                1,
                lockKey.getBytes(),
                threadId.getBytes()
            );
        });
    }
    
    private String getCurrentThreadId() {
        return Thread.currentThread().getId() + "-" + System.currentTimeMillis();
    }
}
```

**âš¡ Redisæ–¹æ¡ˆä¼˜åŠ¿**
- âœ… æ€§èƒ½é«˜ï¼šå†…å­˜æ“ä½œï¼Œå“åº”å¿«
- âœ… å®ç°ç®€å•ï¼šå‡ ä¸ªRediså‘½ä»¤å°±èƒ½æå®š
- âœ… æ”¯æŒè¿‡æœŸï¼šè‡ªåŠ¨é‡Šæ”¾ï¼Œé¿å…æ­»é”

### 4.2 åŸºäºZooKeeperçš„å®ç°


**ğŸŒ³ ZooKeeperåˆ†å¸ƒå¼é”åŸç†**
```
å·¥ä½œæœºåˆ¶ï¼šä¸´æ—¶é¡ºåºèŠ‚ç‚¹ + ç›‘å¬æœºåˆ¶

èŠ‚ç‚¹ç»“æ„ï¼š
/locks/
  â”œâ”€â”€ lock-000001  (ä¸´æ—¶é¡ºåºèŠ‚ç‚¹)
  â”œâ”€â”€ lock-000002  (ä¸´æ—¶é¡ºåºèŠ‚ç‚¹)
  â””â”€â”€ lock-000003  (ä¸´æ—¶é¡ºåºèŠ‚ç‚¹)

è·å–é”æµç¨‹ï¼š
1. åˆ›å»ºä¸´æ—¶é¡ºåºèŠ‚ç‚¹
2. æŸ¥çœ‹è‡ªå·±æ˜¯å¦æ˜¯æœ€å°èŠ‚ç‚¹
3. å¦‚æœæ˜¯ï¼Œè·å–é”æˆåŠŸ
4. å¦‚æœä¸æ˜¯ï¼Œç›‘å¬å‰ä¸€ä¸ªèŠ‚ç‚¹
```

**ğŸ’» ç®€åŒ–å®ç°æ€è·¯**
```java
public class ZKDistributedLock {
    
    public boolean tryLock(String lockName) {
        try {
            // 1. åˆ›å»ºä¸´æ—¶é¡ºåºèŠ‚ç‚¹
            String lockPath = zk.create(
                "/locks/" + lockName + "-",
                new byte[0],
                ZooDefs.Ids.OPEN_ACL_UNSAFE,
                CreateMode.EPHEMERAL_SEQUENTIAL
            );
            
            // 2. è·å–æ‰€æœ‰å­èŠ‚ç‚¹å¹¶æ’åº
            List<String> children = zk.getChildren("/locks", false);
            Collections.sort(children);
            
            // 3. åˆ¤æ–­è‡ªå·±æ˜¯å¦æ˜¯æœ€å°èŠ‚ç‚¹
            if (lockPath.endsWith(children.get(0))) {
                return true; // è·å–é”æˆåŠŸ
            }
            
            // 4. ç›‘å¬å‰ä¸€ä¸ªèŠ‚ç‚¹
            String prevNode = children.get(children.indexOf(lockPath) - 1);
            CountDownLatch latch = new CountDownLatch(1);
            
            zk.exists("/locks/" + prevNode, event -> {
                if (event.getType() == Watcher.Event.EventType.NodeDeleted) {
                    latch.countDown();
                }
            });
            
            latch.await(); // ç­‰å¾…å‰ä¸€ä¸ªèŠ‚ç‚¹é‡Šæ”¾é”
            return true;
            
        } catch (Exception e) {
            return false;
        }
    }
}
```

### 4.3 æ–¹æ¡ˆå¯¹æ¯”åˆ†æ


**ğŸ“Š æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”**

| ç‰¹æ€§ | **Redisæ–¹æ¡ˆ** | **ZooKeeperæ–¹æ¡ˆ** |
|------|---------------|-------------------|
| **æ€§èƒ½** | ğŸŸ¢ é«˜æ€§èƒ½ï¼Œæ¯«ç§’çº§å“åº” | ğŸŸ¡ ä¸­ç­‰æ€§èƒ½ï¼Œç½‘ç»œå¼€é”€å¤§ |
| **å¯é æ€§** | ğŸŸ¡ ä¾èµ–Redisé›†ç¾¤ | ğŸŸ¢ å¼ºä¸€è‡´æ€§ï¼Œé«˜å¯é  |
| **å®ç°å¤æ‚åº¦** | ğŸŸ¢ ç®€å•ï¼Œå‡ è¡Œä»£ç  | ğŸ”´ å¤æ‚ï¼Œéœ€å¤„ç†å„ç§å¼‚å¸¸ |
| **åŠŸèƒ½å®Œæ•´æ€§** | ğŸŸ¡ éœ€è‡ªå·±å®ç°å¯é‡å…¥ç­‰ | ğŸŸ¢ å¤©ç„¶æ”¯æŒå„ç§ç‰¹æ€§ |
| **è¿ç»´æˆæœ¬** | ğŸŸ¢ Redisè¿ç»´ç›¸å¯¹ç®€å• | ğŸ”´ ZKé›†ç¾¤è¿ç»´å¤æ‚ |

**ğŸ¯ é€‰æ‹©å»ºè®®**
```
é€‰æ‹©Redisçš„åœºæ™¯ï¼š
â€¢ å¯¹æ€§èƒ½è¦æ±‚é«˜
â€¢ ä¸šåŠ¡é€»è¾‘ç›¸å¯¹ç®€å•
â€¢ å·²æœ‰Redisé›†ç¾¤åŸºç¡€è®¾æ–½

é€‰æ‹©ZooKeeperçš„åœºæ™¯ï¼š
â€¢ å¯¹ä¸€è‡´æ€§è¦æ±‚æé«˜
â€¢ éœ€è¦å¤æ‚çš„é”åŠŸèƒ½
â€¢ ç³»ç»Ÿä¸­å·²ä½¿ç”¨ZKåšæœåŠ¡å‘ç°
```

---

## 5. ğŸ“ˆ æ€§èƒ½ä¸ä¼˜åŒ–ç­–ç•¥


### 5.1 é”ç²’åº¦æ§åˆ¶


**ğŸ” ä»€ä¹ˆæ˜¯é”ç²’åº¦**
```
é”ç²’åº¦ï¼šé”ä¿æŠ¤èŒƒå›´çš„å¤§å°

ç²—ç²’åº¦é”ï¼šä¿æŠ¤èŒƒå›´å¤§ï¼Œå†²çªæ¦‚ç‡é«˜
ç»†ç²’åº¦é”ï¼šä¿æŠ¤èŒƒå›´å°ï¼Œå†²çªæ¦‚ç‡ä½

ç±»æ¯”ï¼š
ç²—ç²’åº¦ = æ•´ä¸ªå•†åœºåªæœ‰ä¸€ä¸ªå…¥å£
ç»†ç²’åº¦ = æ¯ä¸ªåº—é“ºéƒ½æœ‰è‡ªå·±çš„é—¨
```

**ğŸ“Š ç²’åº¦è®¾è®¡æ¡ˆä¾‹**
```java
// ç²—ç²’åº¦ï¼šæ‰€æœ‰å•†å“å…±ç”¨ä¸€æŠŠé”
public void updateStock(String productId, int count) {
    if (lock.tryLock("global_stock_lock")) {
        // æ‰€æœ‰å•†å“çš„åº“å­˜æ“ä½œéƒ½è¢«ä¸²è¡ŒåŒ–
        // å¹¶å‘åº¦ä½ï¼Œä½†å®ç°ç®€å•
    }
}

// ç»†ç²’åº¦ï¼šæ¯ä¸ªå•†å“ä¸€æŠŠé”
public void updateStock(String productId, int count) {
    String lockKey = "stock_lock_" + productId;
    if (lock.tryLock(lockKey)) {
        // åªé”å®šç‰¹å®šå•†å“ï¼Œå…¶ä»–å•†å“ä¸å—å½±å“
        // å¹¶å‘åº¦é«˜ï¼Œæ€§èƒ½æ›´å¥½
    }
}

// è¶…ç»†ç²’åº¦ï¼šå•†å“+ä»“åº“ç»´åº¦
public void updateStock(String productId, String warehouseId, int count) {
    String lockKey = "stock_lock_" + productId + "_" + warehouseId;
    if (lock.tryLock(lockKey)) {
        // ç²’åº¦æœ€ç»†ï¼Œå¹¶å‘åº¦æœ€é«˜
        // ä½†é”çš„æ•°é‡ä¼šå¾ˆå¤šï¼Œç®¡ç†å¤æ‚
    }
}
```

### 5.2 æ€§èƒ½å¼€é”€è¯„ä¼°


**âš¡ åˆ†å¸ƒå¼é”çš„æ€§èƒ½æˆæœ¬**
```
æ—¶é—´å¼€é”€ç»„æˆï¼š
1. ç½‘ç»œé€šä¿¡ï¼šä¸é”æœåŠ¡å™¨çš„ç½‘ç»œå»¶è¿Ÿ
2. é”äº‰ç”¨ï¼šå¤šä¸ªçº¿ç¨‹ç«äº‰é”çš„ç­‰å¾…æ—¶é—´
3. é”æŒæœ‰ï¼šä¸šåŠ¡é€»è¾‘æ‰§è¡Œçš„æ—¶é—´
4. é”é‡Šæ”¾ï¼šæ¸…ç†é”çŠ¶æ€çš„æ—¶é—´

å…¸å‹æ€§èƒ½æ•°æ®ï¼š
Redisé”æ“ä½œï¼š1-5ms
ZooKeeperé”æ“ä½œï¼š10-50ms
æœ¬åœ°é”æ“ä½œï¼š0.001ms (å¾®ç§’çº§)
```

**ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®**

**ä¼˜åŒ–ç­–ç•¥1ï¼šé”é™çº§**
```java
// å…ˆå°è¯•æœ¬åœ°é”ï¼Œå¤±è´¥åå†ç”¨åˆ†å¸ƒå¼é”
public void processOrder(String orderId) {
    // ç¬¬ä¸€å±‚ï¼šæœ¬åœ°é”ï¼ˆå¿«é€Ÿè·¯å¾„ï¼‰
    if (localLock.tryLock(orderId)) {
        try {
            doProcess(orderId);
            return;
        } finally {
            localLock.unlock(orderId);
        }
    }
    
    // ç¬¬äºŒå±‚ï¼šåˆ†å¸ƒå¼é”ï¼ˆä¿åº•æ–¹æ¡ˆï¼‰
    if (distributedLock.tryLock(orderId)) {
        try {
            doProcess(orderId);
        } finally {
            distributedLock.unlock(orderId);
        }
    }
}
```

**ä¼˜åŒ–ç­–ç•¥2ï¼šæ‰¹é‡å¤„ç†**
```java
// é¿å…é¢‘ç¹åŠ é”è§£é”
public void updateMultipleStocks(List<StockUpdate> updates) {
    // æŒ‰å•†å“IDåˆ†ç»„
    Map<String, List<StockUpdate>> grouped = updates.stream()
        .collect(Collectors.groupingBy(StockUpdate::getProductId));
    
    // æ¯ä¸ªå•†å“åªåŠ é”ä¸€æ¬¡
    grouped.forEach((productId, productUpdates) -> {
        String lockKey = "stock_" + productId;
        if (distributedLock.tryLock(lockKey)) {
            try {
                // æ‰¹é‡å¤„ç†åŒä¸€å•†å“çš„å¤šä¸ªæ›´æ–°
                productUpdates.forEach(this::doStockUpdate);
            } finally {
                distributedLock.unlock(lockKey);
            }
        }
    });
}
```

### 5.3 æ•…éšœæ¢å¤èƒ½åŠ›


**ğŸš¨ å¸¸è§æ•…éšœåœºæ™¯**
```
åœºæ™¯1ï¼šæœåŠ¡å®•æœº
æŒé”æœåŠ¡çªç„¶å´©æºƒ â†’ é”æ— æ³•é‡Šæ”¾ â†’ å…¶ä»–æœåŠ¡ç­‰å¾…

åœºæ™¯2ï¼šç½‘ç»œåˆ†åŒº
ç½‘ç»œä¸ç¨³å®š â†’ é”æœåŠ¡ä¸å¯è¾¾ â†’ æ— æ³•è·å–/é‡Šæ”¾é”

åœºæ™¯3ï¼šé”æœåŠ¡æ•…éšœ
Redis/ZKé›†ç¾¤å¼‚å¸¸ â†’ æ•´ä¸ªé”æœºåˆ¶å¤±æ•ˆ
```

**ğŸ›¡ï¸ å®¹é”™æœºåˆ¶è®¾è®¡**

**æœºåˆ¶1ï¼šé”ç»­æœŸï¼ˆé˜²æ­¢è¯¯é‡Šæ”¾ï¼‰**
```java
public class LockRenewal {
    private ScheduledExecutorService scheduler = 
        Executors.newScheduledThreadPool(1);
    
    public void renewLock(String lockKey, String threadId) {
        scheduler.scheduleAtFixedRate(() -> {
            try {
                // æ¯10ç§’ç»­æœŸä¸€æ¬¡ï¼Œé”çš„è¿‡æœŸæ—¶é—´æ˜¯30ç§’
                if (isCurrentThreadHoldingLock(lockKey, threadId)) {
                    redis.expire(lockKey, 30);
                }
            } catch (Exception e) {
                // ç»­æœŸå¤±è´¥ï¼Œåœæ­¢ç»­æœŸ
                scheduler.shutdown();
            }
        }, 10, 10, TimeUnit.SECONDS);
    }
}
```

**æœºåˆ¶2ï¼šä¼˜é›…é™çº§**
```java
@Service
public class OrderService {
    
    public void createOrder(Order order) {
        try {
            // å°è¯•ä½¿ç”¨åˆ†å¸ƒå¼é”
            if (distributedLock.tryLock(order.getId(), 5, TimeUnit.SECONDS)) {
                try {
                    processWithLock(order);
                } finally {
                    distributedLock.unlock(order.getId());
                }
            } else {
                // é™çº§æ–¹æ¡ˆï¼šä½¿ç”¨å…¶ä»–ç­–ç•¥
                processWithoutLock(order);
            }
        } catch (Exception e) {
            // åˆ†å¸ƒå¼é”å®Œå…¨ä¸å¯ç”¨æ—¶çš„é™çº§å¤„ç†
            processWithLocalStrategy(order);
        }
    }
    
    private void processWithoutLock(Order order) {
        // é™çº§ç­–ç•¥ï¼š
        // 1. ä½¿ç”¨æ•°æ®åº“ä¹è§‚é”
        // 2. æˆ–è€…è®°å½•åˆ°æ¶ˆæ¯é˜Ÿåˆ—å»¶è¿Ÿå¤„ç†
        // 3. æˆ–è€…è¿”å›"ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åé‡è¯•"
    }
}
```

### 5.4 é”ç­‰å¾…å¤„ç†


**â° ç­‰å¾…ç­–ç•¥é€‰æ‹©**
```
ç­–ç•¥å¯¹æ¯”ï¼š

ç«‹å³è¿”å›ï¼š
- ä¼˜ç‚¹ï¼šå“åº”å¿«ï¼Œä¸é˜»å¡
- ç¼ºç‚¹ï¼šå¯èƒ½é”™è¿‡å¤„ç†æœºä¼š
- é€‚ç”¨ï¼šéå…³é”®ä¸šåŠ¡

å›ºå®šç­‰å¾…ï¼š
- ä¼˜ç‚¹ï¼šç®€å•å¯æ§
- ç¼ºç‚¹ï¼šå¯èƒ½ç­‰å¾…æ—¶é—´ä¸åˆç†
- é€‚ç”¨ï¼šä¸šåŠ¡æ—¶é—´ç›¸å¯¹å›ºå®š

æ™ºèƒ½ç­‰å¾…ï¼š
- ä¼˜ç‚¹ï¼šæ ¹æ®å†å²æ•°æ®è°ƒæ•´ç­‰å¾…æ—¶é—´
- ç¼ºç‚¹ï¼šå®ç°å¤æ‚
- é€‚ç”¨ï¼šå¯¹ç”¨æˆ·ä½“éªŒè¦æ±‚é«˜çš„åœºæ™¯
```

**ğŸ’» ç­‰å¾…ç­–ç•¥å®ç°**
```java
public class SmartLockWaiter {
    private Map<String, Long> avgWaitTime = new ConcurrentHashMap<>();
    
    public boolean smartTryLock(String lockKey) {
        // æ ¹æ®å†å²å¹³å‡ç­‰å¾…æ—¶é—´å†³å®šç­‰å¾…ç­–ç•¥
        Long avgTime = avgWaitTime.getOrDefault(lockKey, 1000L);
        long waitTime = Math.min(avgTime * 2, 10000); // æœ€å¤šç­‰10ç§’
        
        long startTime = System.currentTimeMillis();
        boolean success = distributedLock.tryLock(lockKey, waitTime, TimeUnit.MILLISECONDS);
        
        if (success) {
            // æ›´æ–°å¹³å‡ç­‰å¾…æ—¶é—´
            long actualWaitTime = System.currentTimeMillis() - startTime;
            updateAvgWaitTime(lockKey, actualWaitTime);
        }
        
        return success;
    }
    
    private void updateAvgWaitTime(String lockKey, long waitTime) {
        avgWaitTime.compute(lockKey, (key, oldAvg) -> {
            if (oldAvg == null) {
                return waitTime;
            }
            // ä½¿ç”¨ç§»åŠ¨å¹³å‡è®¡ç®—
            return (oldAvg * 0.7 + waitTime * 0.3);
        });
    }
}
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ åˆ†å¸ƒå¼é”æœ¬è´¨ï¼šè·¨æœåŠ¡å™¨çš„èµ„æºè®¿é—®æ§åˆ¶æœºåˆ¶
ğŸ”¸ æ ¸å¿ƒé—®é¢˜ï¼šè§£å†³åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„å¹¶å‘å†²çª
ğŸ”¸ å…³é”®ç‰¹æ€§ï¼šäº’æ–¥æ€§ã€å¯é‡å…¥æ€§ã€è¶…æ—¶æœºåˆ¶ã€æ•…éšœæ¢å¤
ğŸ”¸ å®ç°æ–¹æ¡ˆï¼šRedis(æ€§èƒ½ä¼˜å…ˆ) vs ZooKeeper(å¯é æ€§ä¼˜å…ˆ)
ğŸ”¸ æ€§èƒ½ä¼˜åŒ–ï¼šé”ç²’åº¦æ§åˆ¶ã€æ‰¹é‡å¤„ç†ã€æ™ºèƒ½ç­‰å¾…
```

### 6.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä»€ä¹ˆæ—¶å€™éœ€è¦åˆ†å¸ƒå¼é”**
```
éœ€è¦åˆ†å¸ƒå¼é”çš„æ ‡å¿—ï¼š
âœ… å¤šä¸ªæœåŠ¡å®ä¾‹åŒæ—¶è¿è¡Œ
âœ… æ“ä½œå…±äº«èµ„æºï¼ˆæ•°æ®åº“ã€ç¼“å­˜ç­‰ï¼‰
âœ… æ“ä½œéœ€è¦åŸå­æ€§ï¼ˆä¸èƒ½è¢«æ‰“æ–­ï¼‰
âœ… å¹¶å‘è®¿é—®ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´

ä¸éœ€è¦åˆ†å¸ƒå¼é”çš„æƒ…å†µï¼š
âŒ åªæœ‰ä¸€ä¸ªæœåŠ¡å®ä¾‹
âŒ æ“ä½œçš„æ•°æ®ç›¸äº’ç‹¬ç«‹
âŒ å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼ä¿è¯ä¸€è‡´æ€§ï¼ˆå¦‚æ•°æ®åº“äº‹åŠ¡ï¼‰
```

**ğŸ”¹ å¦‚ä½•é€‰æ‹©åˆé€‚çš„å®ç°æ–¹æ¡ˆ**
```
é€‰æ‹©å†³ç­–æ ‘ï¼š
æ€§èƒ½è¦æ±‚é«˜ï¼Ÿ
â”œâ”€ æ˜¯ â†’ Redisæ–¹æ¡ˆ
â””â”€ å¦ â†’ ä¸€è‡´æ€§è¦æ±‚é«˜ï¼Ÿ
         â”œâ”€ æ˜¯ â†’ ZooKeeperæ–¹æ¡ˆ  
         â””â”€ å¦ â†’ Redisæ–¹æ¡ˆï¼ˆç®€å•æ˜“ç”¨ï¼‰

å…·ä½“è€ƒè™‘å› ç´ ï¼š
â€¢ å›¢é˜ŸæŠ€æœ¯æ ˆç†Ÿæ‚‰ç¨‹åº¦
â€¢ ç°æœ‰åŸºç¡€è®¾æ–½æƒ…å†µ
â€¢ ä¸šåŠ¡å¯¹æ€§èƒ½vså¯é æ€§çš„æƒè¡¡
â€¢ è¿ç»´æˆæœ¬å’Œå¤æ‚åº¦æ¥å—åº¦
```

**ğŸ”¹ å¸¸è§é—®é¢˜å’Œæœ€ä½³å®è·µ**
```
é¿å…çš„å‘ï¼š
âŒ é”ç²’åº¦è¿‡ç²—ï¼Œå½±å“å¹¶å‘æ€§èƒ½
âŒ å¿˜è®°è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå¯¼è‡´æ­»é”
âŒ ä¸å¤„ç†å¼‚å¸¸æƒ…å†µï¼Œé”æ— æ³•é‡Šæ”¾
âŒ åœ¨äº‹åŠ¡ä¸­ä½¿ç”¨åˆ†å¸ƒå¼é”ï¼Œå¯èƒ½å¯¼è‡´æ­»é”

æœ€ä½³å®è·µï¼š
âœ… åˆç†è®¾è®¡é”çš„ç²’åº¦å’Œè¿‡æœŸæ—¶é—´
âœ… ä½¿ç”¨try-finallyç¡®ä¿é”ä¸€å®šä¼šé‡Šæ”¾  
âœ… å®ç°é”çš„ç»­æœŸæœºåˆ¶é˜²æ­¢è¯¯é‡Šæ”¾
âœ… è®¾è®¡é™çº§æ–¹æ¡ˆåº”å¯¹é”æœåŠ¡å¼‚å¸¸
```

### 6.3 å­¦ä¹ æ£€æŸ¥ç‚¹


**ğŸ“ çŸ¥è¯†æŒæ¡åº¦è‡ªæµ‹**
- [ ] èƒ½å¤Ÿè§£é‡Šä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼é”ï¼Ÿ
- [ ] ç†è§£åˆ†å¸ƒå¼é”çš„æ ¸å¿ƒç‰¹æ€§å’Œå®ç°åŸç†ï¼Ÿ
- [ ] æŒæ¡Rediså’ŒZooKeeperä¸¤ç§ä¸»æµå®ç°æ–¹æ¡ˆï¼Ÿ
- [ ] èƒ½å¤Ÿæ ¹æ®ä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚çš„é”ç²’åº¦ï¼Ÿ
- [ ] äº†è§£åˆ†å¸ƒå¼é”çš„æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ï¼Ÿ

**ğŸ’ª å®è·µèƒ½åŠ›æ£€éªŒ**
- [ ] èƒ½å¤Ÿä½¿ç”¨Rediså®ç°åŸºæœ¬çš„åˆ†å¸ƒå¼é”
- [ ] èƒ½å¤Ÿå¤„ç†é”çš„å¼‚å¸¸æƒ…å†µå’Œæ•…éšœæ¢å¤
- [ ] èƒ½å¤Ÿè®¾è®¡åˆç†çš„é”ç­‰å¾…å’Œé‡è¯•ç­–ç•¥
- [ ] èƒ½å¤Ÿè¯„ä¼°å’Œä¼˜åŒ–åˆ†å¸ƒå¼é”çš„æ€§èƒ½è¡¨ç°

### 6.4 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ åœ¨é¡¹ç›®ä¸­ä½¿ç”¨åˆ†å¸ƒå¼é”çš„å»ºè®®**
```
ç¬¬ä¸€æ­¥ï¼šè¯†åˆ«éœ€è¦ä¿æŠ¤çš„ä¸´ç•Œèµ„æº
â€¢ åº“å­˜æ•°æ®ã€è®¢å•åºå·ã€ç”¨æˆ·ç§¯åˆ†ç­‰

ç¬¬äºŒæ­¥ï¼šè®¾è®¡åˆé€‚çš„é”ç­–ç•¥
â€¢ ç¡®å®šé”çš„ç²’åº¦ï¼ˆå…¨å±€é” vs ç»†ç²’åº¦é”ï¼‰
â€¢ ä¼°ç®—ä¸šåŠ¡æ‰§è¡Œæ—¶é—´ï¼Œè®¾ç½®åˆç†çš„è¶…æ—¶

ç¬¬ä¸‰æ­¥ï¼šé€‰æ‹©æŠ€æœ¯æ–¹æ¡ˆ
â€¢ è€ƒè™‘ç°æœ‰åŸºç¡€è®¾æ–½å’Œå›¢é˜ŸæŠ€æœ¯æ ˆ
â€¢ å¹³è¡¡æ€§èƒ½éœ€æ±‚å’Œå¯é æ€§è¦æ±‚

ç¬¬å››æ­¥ï¼šå®ç°å’Œæµ‹è¯•
â€¢ ç¼–å†™å®Œæ•´çš„è·å–é”ã€é‡Šæ”¾é”é€»è¾‘
â€¢ å……åˆ†æµ‹è¯•å¼‚å¸¸åœºæ™¯å’Œè¾¹ç•Œæƒ…å†µ

ç¬¬äº”æ­¥ï¼šç›‘æ§å’Œä¼˜åŒ–
â€¢ ç›‘æ§é”çš„ç«äº‰æƒ…å†µå’Œæ€§èƒ½æŒ‡æ ‡
â€¢ æ ¹æ®å®é™…ä½¿ç”¨æƒ…å†µè°ƒæ•´ç­–ç•¥
```

**ğŸš€ è¿›é˜¶å­¦ä¹ æ–¹å‘**
- ç ”ç©¶Redlockç®—æ³•å’Œå…¶ä»–é«˜çº§åˆ†å¸ƒå¼é”å®ç°
- äº†è§£åˆ†å¸ƒå¼é”åœ¨å¾®æœåŠ¡æ¶æ„ä¸­çš„æœ€ä½³å®è·µ
- å­¦ä¹ å¦‚ä½•åœ¨Spring Bootä¸­ä¼˜é›…åœ°ä½¿ç”¨åˆ†å¸ƒå¼é”
- æ¢ç´¢åˆ†å¸ƒå¼é”ä¸æ•°æ®åº“äº‹åŠ¡çš„ç»“åˆä½¿ç”¨

**ğŸ’¡ å…³é”®æ´å¯Ÿ**
> åˆ†å¸ƒå¼é”ä¸æ˜¯é“¶å¼¹ï¼Œå®ƒè§£å†³äº†å¹¶å‘é—®é¢˜ï¼Œä½†ä¹Ÿå¼•å…¥äº†æ€§èƒ½å¼€é”€å’Œå¤æ‚æ€§ã€‚åœ¨ä½¿ç”¨å‰è¦æƒè¡¡åˆ©å¼Šï¼Œä¼˜å…ˆè€ƒè™‘ä¸šåŠ¡å±‚é¢çš„è§£å†³æ–¹æ¡ˆï¼Œåˆ†å¸ƒå¼é”æ˜¯æœ€åçš„ä¿éšœæœºåˆ¶ã€‚

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- å¤šæœåŠ¡å…±èµ„æºï¼Œåˆ†å¸ƒé”æ¥ç®¡
- äº’æ–¥å¯é‡å…¥ï¼Œè¶…æ—¶é˜²æ­»é”  
- Rediså¿«ZKç¨³ï¼ŒæŒ‰éœ€æ¥é€‰æ‹©
- ç²’åº¦è¦åˆç†ï¼Œæ€§èƒ½ç»†ä¼˜åŒ–