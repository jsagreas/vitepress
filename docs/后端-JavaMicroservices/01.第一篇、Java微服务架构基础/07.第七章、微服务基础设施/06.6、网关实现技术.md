---
title: 6ã€ç½‘å…³å®ç°æŠ€æœ¯
---
## ğŸ“š ç›®å½•


1. [APIç½‘å…³åŸºç¡€æ¦‚å¿µ](#1-APIç½‘å…³åŸºç¡€æ¦‚å¿µ)
2. [Spring Cloud Gatewayè¯¦è§£](#2-Spring-Cloud-Gatewayè¯¦è§£)
3. [Zuulç½‘å…³è§£æ](#3-Zuulç½‘å…³è§£æ)
4. [Kongç½‘å…³ä»‹ç»](#4-Kongç½‘å…³ä»‹ç»)
5. [Nginx Plusè§£å†³æ–¹æ¡ˆ](#5-Nginx-Plusè§£å†³æ–¹æ¡ˆ)
6. [è·¯ç”±è§„åˆ™è®¾è®¡](#6-è·¯ç”±è§„åˆ™è®¾è®¡)
7. [è¿‡æ»¤å™¨é“¾æœºåˆ¶](#7-è¿‡æ»¤å™¨é“¾æœºåˆ¶)
8. [æ’ä»¶æœºåˆ¶è¯¦è§£](#8-æ’ä»¶æœºåˆ¶è¯¦è§£)
9. [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#9-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

# ğŸ¯ **å­¦ä¹ è·¯å¾„å¯¼èˆª**


**å‰ç½®çŸ¥è¯†**ï¼šå¾®æœåŠ¡åŸºç¡€æ¦‚å¿µã€HTTPåè®® â†’ **å½“å‰å†…å®¹**ï¼šç½‘å…³å®ç°æŠ€æœ¯ â†’ **åç»­å­¦ä¹ **ï¼šæœåŠ¡å‘ç°ä¸æ³¨å†Œã€è´Ÿè½½å‡è¡¡

â±ï¸ **é¢„è®¡å­¦ä¹ æ—¶é—´**ï¼šæœ¬ç« é¢„è®¡90åˆ†é’Ÿ | å®è·µç»ƒä¹ 60åˆ†é’Ÿ

ğŸ® **å­¦ä¹ éš¾åº¦è¯„çº§**
- åŸºç¡€æ¦‚å¿µï¼šâ­â­â­
- æŠ€æœ¯å®ç°ï¼šâ­â­â­â­
- æ€§èƒ½ä¼˜åŒ–ï¼šâ­â­â­â­â­

---

## 1. ğŸšª APIç½‘å…³åŸºç¡€æ¦‚å¿µ



### 1.1 ä»€ä¹ˆæ˜¯APIç½‘å…³



**ğŸ’¡ é€šä¿—ç†è§£**
æƒ³è±¡ä¸€ä¸‹é…’åº—çš„å‰å°æ¥å¾…ï¼š
- **å®¢äºº**ï¼šå°±åƒå®¢æˆ·ç«¯åº”ç”¨
- **å‰å°**ï¼šå°±æ˜¯APIç½‘å…³
- **å„ä¸ªéƒ¨é—¨**ï¼šå°±æ˜¯åç«¯å¾®æœåŠ¡

å®¢äººè¦åŠä»»ä½•äº‹æƒ…éƒ½å…ˆæ‰¾å‰å°ï¼Œå‰å°çŸ¥é“è¯¥è”ç³»å“ªä¸ªéƒ¨é—¨ï¼Œè¿™æ ·å®¢äººå°±ä¸ç”¨è®°ä½æ‰€æœ‰éƒ¨é—¨çš„ä½ç½®äº†ã€‚

**ğŸ”¸ æ ¸å¿ƒå®šä¹‰**
```
APIç½‘å…³ï¼šå¾®æœåŠ¡æ¶æ„ä¸­çš„ç»Ÿä¸€å…¥å£
ä½œç”¨ï¼šæ¥æ”¶æ‰€æœ‰å®¢æˆ·ç«¯è¯·æ±‚ï¼Œç„¶åè·¯ç”±åˆ°ç›¸åº”çš„å¾®æœåŠ¡
æœ¬è´¨ï¼šå°±æ˜¯ä¸€ä¸ªæ™ºèƒ½çš„"äº¤é€šè­¦å¯Ÿ"ï¼ŒæŒ‡æŒ¥è¯·æ±‚è¯¥å»å“ªé‡Œ
```

### 1.2 APIç½‘å…³çš„æ ¸å¿ƒä½œç”¨



**ğŸ¯ ä¸»è¦èŒè´£**

| **åŠŸèƒ½** | **ä½œç”¨è¯´æ˜** | **ç”Ÿæ´»ç±»æ¯”** |
|---------|-------------|-------------|
| **è·¯ç”±è½¬å‘** | æŠŠè¯·æ±‚é€åˆ°æ­£ç¡®çš„æœåŠ¡ | é‚®é€’å‘˜é€ä¿¡åˆ°æ­£ç¡®åœ°å€ |
| **ç»Ÿä¸€é‰´æƒ** | æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æƒé™ | é—¨å«æ£€æŸ¥å‡ºå…¥è¯ |
| **è´Ÿè½½å‡è¡¡** | æŠŠè¯·æ±‚å‡åŒ€åˆ†é…ç»™å¤šä¸ªæœåŠ¡ | é“¶è¡Œå¤šä¸ªçª—å£åˆ†æµå®¢æˆ· |
| **é™æµç†”æ–­** | é˜²æ­¢ç³»ç»Ÿè¢«è¯·æ±‚å‹å® | åœ°é“é™æµé˜²æ­¢æ‹¥æŒ¤ |
| **ç›‘æ§æ—¥å¿—** | è®°å½•æ‰€æœ‰è¯·æ±‚ä¿¡æ¯ | ä¿å®‰è®°å½•å‡ºå…¥è®°å½• |

### 1.3 ä¸ºä»€ä¹ˆéœ€è¦APIç½‘å…³



**âŒ æ²¡æœ‰ç½‘å…³çš„é—®é¢˜**
```
å®¢æˆ·ç«¯ç›´æ¥è°ƒç”¨å¾®æœåŠ¡ï¼š
- å®¢æˆ·ç«¯éœ€è¦çŸ¥é“æ‰€æœ‰æœåŠ¡çš„åœ°å€
- æ¯ä¸ªæœåŠ¡éƒ½è¦å¤„ç†è®¤è¯ã€é™æµç­‰é€šç”¨åŠŸèƒ½
- æ— æ³•ç»Ÿä¸€ç®¡ç†å’Œç›‘æ§
- æœåŠ¡åœ°å€å˜æ›´å½±å“æ‰€æœ‰å®¢æˆ·ç«¯
```

**âœ… æœ‰ç½‘å…³çš„å¥½å¤„**
```
ç»Ÿä¸€å…¥å£ç®¡ç†ï¼š
- å®¢æˆ·ç«¯åªéœ€è¦çŸ¥é“ç½‘å…³åœ°å€
- é€šç”¨åŠŸèƒ½åœ¨ç½‘å…³ç»Ÿä¸€å¤„ç†
- ä¾¿äºç›‘æ§å’Œç®¡ç†
- æœåŠ¡å˜æ›´å¯¹å®¢æˆ·ç«¯é€æ˜
```

---

## 2. ğŸŒ¸ Spring Cloud Gatewayè¯¦è§£



### 2.1 Spring Cloud Gatewayç®€ä»‹



**ğŸ”¸ æ ¸å¿ƒç‰¹ç‚¹**
Spring Cloud Gatewayæ˜¯Springå®˜æ–¹æ¨å‡ºçš„æ–°ä¸€ä»£ç½‘å…³ï¼ŒåŸºäºSpring 5å’ŒSpring Boot 2æ„å»ºã€‚

**ä¸ºä»€ä¹ˆé€‰æ‹©Spring Cloud Gatewayï¼Ÿ**
- **æ€§èƒ½æ›´å¥½**ï¼šåŸºäºå¼‚æ­¥éé˜»å¡æ¨¡å‹ï¼Œæ¯”Zuul 1.xå¿«å¾ˆå¤š
- **åŠŸèƒ½ä¸°å¯Œ**ï¼šå†…ç½®å¾ˆå¤šå®ç”¨çš„è¿‡æ»¤å™¨
- **æ˜“äºé›†æˆ**ï¼šä¸Springç”Ÿæ€å®Œç¾èåˆ
- **é…ç½®ç®€å•**ï¼šæ”¯æŒä»£ç å’Œé…ç½®æ–‡ä»¶ä¸¤ç§æ–¹å¼

### 2.2 åŸºç¡€é…ç½®å…¥é—¨



**ğŸ“ å¿«é€Ÿå¼€å§‹ç¤ºä¾‹**
```yaml
# application.yml é…ç½®æ–‡ä»¶

spring:
  cloud:
    gateway:
      routes:
#        # ç”¨æˆ·æœåŠ¡è·¯ç”±
        - id: user-service
          uri: http://localhost:8081
          predicates:
            - Path=/api/user/**
          filters:
            - StripPrefix=2  # å»æ‰å‰ç¼€ /api/user
        
#        # è®¢å•æœåŠ¡è·¯ç”±  
        - id: order-service
          uri: http://localhost:8082
          predicates:
            - Path=/api/order/**
          filters:
            - StripPrefix=2
```

**ğŸ¤” é…ç½®è§£é‡Š**
- `id`ï¼šè·¯ç”±çš„å”¯ä¸€æ ‡è¯†ï¼Œå°±åƒç»™è·¯ç”±èµ·ä¸ªåå­—
- `uri`ï¼šç›®æ ‡æœåŠ¡åœ°å€ï¼Œè¯·æ±‚æœ€ç»ˆè¦å‘åˆ°å“ªé‡Œ
- `predicates`ï¼šæ–­è¨€æ¡ä»¶ï¼Œä»€ä¹ˆæ ·çš„è¯·æ±‚èµ°è¿™ä¸ªè·¯ç”±
- `filters`ï¼šè¿‡æ»¤å™¨ï¼Œå¯¹è¯·æ±‚åšä¸€äº›å¤„ç†

### 2.3 å¸¸ç”¨æ–­è¨€æ¡ä»¶



**ğŸ” Pathè·¯å¾„åŒ¹é…**
```yaml
predicates:
  - Path=/api/user/**     # åŒ¹é… /api/user/ å¼€å¤´çš„æ‰€æœ‰è·¯å¾„
  - Path=/order/{id}      # åŒ¹é… /order/123 è¿™æ ·çš„è·¯å¾„
```

**â° æ—¶é—´æ¡ä»¶åŒ¹é…**
```yaml
predicates:
  - After=2023-01-01T00:00:00+08:00[Asia/Shanghai]  # æŸæ—¶é—´ä¹‹å
  - Before=2023-12-31T23:59:59+08:00[Asia/Shanghai] # æŸæ—¶é—´ä¹‹å‰
```

**ğŸ”§ Headeræ¡ä»¶åŒ¹é…**
```yaml
predicates:
  - Header=X-Request-Version, v2  # è¯·æ±‚å¤´åŒ…å«ç‰¹å®šå€¼
  - Method=GET,POST               # æŒ‡å®šHTTPæ–¹æ³•
```

### 2.4 å¸¸ç”¨è¿‡æ»¤å™¨ä»‹ç»



**ğŸ·ï¸ è¯·æ±‚å¤„ç†è¿‡æ»¤å™¨**

| **è¿‡æ»¤å™¨åç§°** | **ä½œç”¨** | **é…ç½®ç¤ºä¾‹** |
|---------------|---------|-------------|
| `StripPrefix` | å»æ‰è·¯å¾„å‰ç¼€ | `StripPrefix=2` |
| `AddRequestHeader` | æ·»åŠ è¯·æ±‚å¤´ | `AddRequestHeader=X-Source, Gateway` |
| `AddRequestParameter` | æ·»åŠ è¯·æ±‚å‚æ•° | `AddRequestParameter=source, gateway` |
| `RewritePath` | é‡å†™è·¯å¾„ | `RewritePath=/api/(?<path>.*), /$\{path}` |

### 2.5 ä¸æœåŠ¡å‘ç°é›†æˆ



**ğŸ”— é›†æˆNacosç¤ºä¾‹**
```yaml
spring:
  cloud:
    gateway:
      discovery:
        locator:
          enabled: true  # å¯ç”¨æœåŠ¡å‘ç°
          lower-case-service-id: true  # æœåŠ¡åè½¬å°å†™
      routes:
        - id: user-service
          uri: lb://user-service  # lbè¡¨ç¤ºè´Ÿè½½å‡è¡¡
          predicates:
            - Path=/api/user/**
```

**ğŸ’¡ é…ç½®è¯´æ˜**
- `lb://user-service`ï¼šè¡¨ç¤ºé€šè¿‡è´Ÿè½½å‡è¡¡è®¿é—®åä¸ºuser-serviceçš„æœåŠ¡
- ç½‘å…³ä¼šè‡ªåŠ¨ä»æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡å®ä¾‹åˆ—è¡¨
- æ”¯æŒå¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•

---

## 3. ğŸ”„ Zuulç½‘å…³è§£æ



### 3.1 Zuulç½‘å…³æ¦‚è¿°



**ğŸ”¸ Zuulçš„å®šä½**
Zuulæ˜¯Netflixå¼€æºçš„ç½‘å…³æœåŠ¡ï¼Œåœ¨Spring Cloudç”Ÿæ€ä¸­å¹¿æ³›ä½¿ç”¨ã€‚

**ç‰ˆæœ¬å¯¹æ¯”è¯´æ˜**

| **ç‰ˆæœ¬** | **ç‰¹ç‚¹** | **é€‚ç”¨åœºæ™¯** | **çŠ¶æ€** |
|---------|----------|-------------|----------|
| **Zuul 1.x** | åŒæ­¥é˜»å¡æ¨¡å‹ | ä¼ ç»ŸSpringåº”ç”¨ | ç»´æŠ¤æ¨¡å¼ |
| **Zuul 2.x** | å¼‚æ­¥éé˜»å¡ | é«˜å¹¶å‘åœºæ™¯ | è¾ƒå°‘ä½¿ç”¨ |

### 3.2 Zuul 1.xåŸºç¡€é…ç½®



**ğŸ“ ç®€å•é…ç½®ç¤ºä¾‹**
```yaml
# application.yml

zuul:
  routes:
    user-service:
      path: /api/user/**
      url: http://localhost:8081
    order-service:
      path: /api/order/**
      service-id: order-service  # ä½¿ç”¨æœåŠ¡å‘ç°
  
#  # æ•æ„Ÿå¤´ä¿¡æ¯å¤„ç†
  sensitive-headers: Cookie,Set-Cookie,Authorization
  
#  # å¿½ç•¥æŸäº›æœåŠ¡
  ignored-services: "*"
  ignored-patterns: /admin/**
```

### 3.3 Zuulè¿‡æ»¤å™¨æœºåˆ¶



**ğŸ”„ è¿‡æ»¤å™¨ç±»å‹è¯´æ˜**

```
è¯·æ±‚å¤„ç†æµç¨‹ï¼š
å®¢æˆ·ç«¯è¯·æ±‚ â†’ PREè¿‡æ»¤å™¨ â†’ ROUTINGè¿‡æ»¤å™¨ â†’ POSTè¿‡æ»¤å™¨ â†’ è¿”å›å“åº”
                â†“
            ERRORè¿‡æ»¤å™¨ (å‡ºé”™æ—¶æ‰§è¡Œ)
```

**ğŸ› ï¸ è‡ªå®šä¹‰è¿‡æ»¤å™¨ç¤ºä¾‹**
```java
@Component
public class AuthFilter extends ZuulFilter {
    
    @Override
    public String filterType() {
        return "pre";  // å‰ç½®è¿‡æ»¤å™¨
    }
    
    @Override
    public int filterOrder() {
        return 1;  // æ‰§è¡Œé¡ºåº
    }
    
    @Override
    public boolean shouldFilter() {
        return true;  // æ˜¯å¦æ‰§è¡Œè¿‡æ»¤
    }
    
    @Override
    public Object run() {
        // è·å–è¯·æ±‚ä¿¡æ¯
        RequestContext ctx = RequestContext.getCurrentContext();
        HttpServletRequest request = ctx.getRequest();
        
        // ç®€å•çš„tokenæ£€æŸ¥
        String token = request.getHeader("Authorization");
        if (token == null || token.isEmpty()) {
            ctx.setSendZuulResponse(false);
            ctx.setResponseStatusCode(401);
            ctx.setResponseBody("æœªæˆæƒè®¿é—®");
        }
        
        return null;
    }
}
```

### 3.4 Zuul vs Spring Cloud Gatewayå¯¹æ¯”



**âš–ï¸ æŠ€æœ¯å¯¹æ¯”**

| **å¯¹æ¯”é¡¹** | **Zuul 1.x** | **Spring Cloud Gateway** |
|-----------|--------------|--------------------------|
| **æ€§èƒ½æ¨¡å‹** | åŒæ­¥é˜»å¡ | å¼‚æ­¥éé˜»å¡ |
| **æŠ€æœ¯æ ˆ** | Servlet API | Spring WebFlux |
| **æ€§èƒ½** | ä¸­ç­‰ | æ›´å¥½ |
| **å­¦ä¹ æˆæœ¬** | è¾ƒä½ | ä¸­ç­‰ |
| **ç¤¾åŒºæ”¯æŒ** | ç»´æŠ¤æ¨¡å¼ | æ´»è·ƒå¼€å‘ |

**ğŸ’¡ é€‰æ‹©å»ºè®®**
- **æ–°é¡¹ç›®**ï¼šæ¨èSpring Cloud Gateway
- **è€é¡¹ç›®**ï¼šå¯ä»¥ç»§ç»­ä½¿ç”¨Zuul 1.xï¼Œç¨³å®šå¯é 
- **é«˜å¹¶å‘**ï¼šå»ºè®®ä½¿ç”¨Spring Cloud Gateway

---

## 4. ğŸ¦ Kongç½‘å…³ä»‹ç»



### 4.1 Kongç½‘å…³æ¦‚è¿°



**ğŸ”¸ Kongçš„ç‰¹ç‚¹**
Kongæ˜¯ä¸€ä¸ªäº‘åŸç”Ÿçš„ã€å¿«é€Ÿçš„ã€å¯æ‰©å±•çš„åˆ†å¸ƒå¼å¾®æœåŠ¡æŠ½è±¡å±‚ç½‘å…³ã€‚

**ä¸ºä»€ä¹ˆé€‰æ‹©Kongï¼Ÿ**
- **é«˜æ€§èƒ½**ï¼šåŸºäºOpenRestyæ„å»ºï¼Œæ€§èƒ½éå¸¸å¼º
- **æ’ä»¶ä¸°å¯Œ**ï¼šæä¾›å¤§é‡ç°æˆçš„æ’ä»¶
- **è¯­è¨€æ— å…³**ï¼šä¸ç»‘å®šç‰¹å®šç¼–ç¨‹è¯­è¨€
- **ä¼ä¸šçº§**ï¼šæ”¯æŒé›†ç¾¤éƒ¨ç½²å’Œé«˜å¯ç”¨

### 4.2 KongåŸºç¡€æ¦‚å¿µ



**ğŸ—ï¸ æ ¸å¿ƒæ¦‚å¿µå›¾**
```
å®¢æˆ·ç«¯ â†’ Kongç½‘å…³ â†’ ä¸Šæ¸¸æœåŠ¡

æ ¸å¿ƒæ¦‚å¿µï¼š
â€¢ Serviceï¼šåç«¯æœåŠ¡çš„æŠ½è±¡
â€¢ Routeï¼šè·¯ç”±è§„åˆ™
â€¢ Consumerï¼šAPIæ¶ˆè´¹è€…  
â€¢ Pluginï¼šåŠŸèƒ½æ’ä»¶
```

**ğŸ“‹ æ¦‚å¿µè§£é‡Š**
- **Service**ï¼šå°±æ˜¯ä½ çš„åç«¯å¾®æœåŠ¡ï¼Œæ¯”å¦‚ç”¨æˆ·æœåŠ¡
- **Route**ï¼šå®šä¹‰ä»€ä¹ˆè¯·æ±‚è½¬å‘åˆ°å“ªä¸ªService
- **Consumer**ï¼šä½¿ç”¨APIçš„å®¢æˆ·ç«¯ï¼Œå¯ä»¥æ˜¯ç”¨æˆ·æˆ–åº”ç”¨
- **Plugin**ï¼šç»™Serviceæˆ–Routeæ·»åŠ åŠŸèƒ½ï¼Œæ¯”å¦‚è®¤è¯ã€é™æµ

### 4.3 KongåŸºç¡€é…ç½®



**ğŸ”§ é€šè¿‡Admin APIé…ç½®**
```bash
# 1. åˆ›å»ºService

curl -i -X POST http://localhost:8001/services/ \
  --data "name=user-service" \
  --data "url=http://localhost:8081"

# 2. åˆ›å»ºRoute

curl -i -X POST http://localhost:8001/services/user-service/routes \
  --data "paths[]=/api/user"

# 3. æ·»åŠ è®¤è¯æ’ä»¶

curl -i -X POST http://localhost:8001/services/user-service/plugins \
  --data "name=key-auth"
```

### 4.4 Kongå¸¸ç”¨æ’ä»¶



**ğŸ”Œ åŠŸèƒ½æ’ä»¶åˆ†ç±»**

| **æ’ä»¶ç±»å‹** | **å¸¸ç”¨æ’ä»¶** | **ä½œç”¨è¯´æ˜** |
|-------------|-------------|-------------|
| **è®¤è¯é‰´æƒ** | key-auth, jwt, oauth2 | ç”¨æˆ·èº«ä»½éªŒè¯ |
| **å®‰å…¨é˜²æŠ¤** | rate-limiting, ip-restriction | é™æµå’ŒIPæ§åˆ¶ |
| **æµé‡æ§åˆ¶** | request-size-limiting | è¯·æ±‚å¤§å°é™åˆ¶ |
| **ç›‘æ§æ—¥å¿—** | prometheus, file-log | ç›‘æ§å’Œæ—¥å¿—è®°å½• |
| **è¯·æ±‚è½¬æ¢** | request-transformer | è¯·æ±‚å†…å®¹ä¿®æ”¹ |

### 4.5 Kongçš„ä¼˜ç¼ºç‚¹åˆ†æ



**âœ… Kongçš„ä¼˜åŠ¿**
- æ€§èƒ½å“è¶Šï¼ŒåŸºäºNginx
- æ’ä»¶ç”Ÿæ€ä¸°å¯Œ
- æ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼
- ä¼ä¸šçº§åŠŸèƒ½å®Œå–„

**âŒ Kongçš„é™åˆ¶**
- å­¦ä¹ æˆæœ¬ç›¸å¯¹è¾ƒé«˜
- éœ€è¦é¢å¤–çš„æ•°æ®åº“å­˜å‚¨é…ç½®
- Javaç”Ÿæ€é›†æˆä¸å¦‚Springç³»åˆ—

---

## 5. ğŸ”§ Nginx Plusè§£å†³æ–¹æ¡ˆ



### 5.1 Nginx Plusç®€ä»‹



**ğŸ”¸ Nginx Pluså®šä½**
Nginx Plusæ˜¯Nginxçš„å•†ä¸šç‰ˆæœ¬ï¼Œåœ¨å¼€æºNginxåŸºç¡€ä¸Šå¢åŠ äº†ä¼ä¸šçº§åŠŸèƒ½ã€‚

**ä¸å¼€æºNginxçš„åŒºåˆ«**
- **åŠ¨æ€é…ç½®**ï¼šå¯ä»¥åœ¨è¿è¡Œæ—¶ä¿®æ”¹é…ç½®
- **é«˜çº§è´Ÿè½½å‡è¡¡**ï¼šæ”¯æŒæ›´å¤šç®—æ³•å’Œå¥åº·æ£€æŸ¥
- **APIç½‘å…³åŠŸèƒ½**ï¼šå†…ç½®ç½‘å…³ç‰¹æ€§
- **å•†ä¸šæ”¯æŒ**ï¼šæä¾›ä¸“ä¸šæŠ€æœ¯æ”¯æŒ

### 5.2 Nginxä½œä¸ºAPIç½‘å…³çš„é…ç½®



**ğŸ“ åŸºç¡€ç½‘å…³é…ç½®**
```nginx
# nginx.conf

upstream user_service {
    server 127.0.0.1:8081;
    server 127.0.0.1:8082;
}

upstream order_service {
    server 127.0.0.1:8083;
    server 127.0.0.1:8084;
}

server {
    listen 80;
    server_name api.example.com;
    
#    # ç”¨æˆ·æœåŠ¡è·¯ç”±
    location /api/user/ {
        proxy_pass http://user_service/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
    
#    # è®¢å•æœåŠ¡è·¯ç”±
    location /api/order/ {
        proxy_pass http://order_service/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

### 5.3 Nginx Plusé«˜çº§åŠŸèƒ½



**âš¡ åŠ¨æ€è´Ÿè½½å‡è¡¡**
```nginx
# æ”¯æŒè¿è¡Œæ—¶æ·»åŠ /åˆ é™¤åç«¯æœåŠ¡å™¨

upstream backend {
    zone backend 64k;  # å…±äº«å†…å­˜åŒºåŸŸ
    server 127.0.0.1:8081;
    server 127.0.0.1:8082;
}
```

**ğŸ” å¥åº·æ£€æŸ¥é…ç½®**
```nginx
upstream backend {
    server 127.0.0.1:8081;
    server 127.0.0.1:8082;
}

server {
    location /api/ {
        proxy_pass http://backend;
        health_check;  # å¯ç”¨å¥åº·æ£€æŸ¥
    }
}
```

### 5.4 Nginx Plusé€‚ç”¨åœºæ™¯



**ğŸ¯ æœ€ä½³åº”ç”¨åœºæ™¯**
- **é«˜æ€§èƒ½éœ€æ±‚**ï¼šå¤„ç†å¤§é‡å¹¶å‘è¯·æ±‚
- **è¾¹ç¼˜éƒ¨ç½²**ï¼šCDNå’Œè¾¹ç¼˜è®¡ç®—åœºæ™¯  
- **ä¼ ç»Ÿæ¶æ„**ï¼šå·²æœ‰NginxåŸºç¡€è®¾æ–½
- **æ··åˆäº‘**ï¼šè·¨äº‘å¹³å°çš„ç»Ÿä¸€å…¥å£

---

## 6. ğŸ—ºï¸ è·¯ç”±è§„åˆ™è®¾è®¡



### 6.1 è·¯ç”±è§„åˆ™åŸºç¡€



**ğŸ”¸ è·¯ç”±è§„åˆ™çš„æœ¬è´¨**
è·¯ç”±è§„åˆ™å°±æ˜¯å‘Šè¯‰ç½‘å…³ï¼š"ä»€ä¹ˆæ ·çš„è¯·æ±‚åº”è¯¥è½¬å‘åˆ°å“ªä¸ªæœåŠ¡"

**åŸºæœ¬è¦ç´ è¯´æ˜**
```
ä¸€ä¸ªå®Œæ•´çš„è·¯ç”±è§„åˆ™åŒ…å«ï¼š
â€¢ åŒ¹é…æ¡ä»¶ï¼šä»€ä¹ˆè¯·æ±‚èµ°è¿™ä¸ªè·¯ç”±
â€¢ ç›®æ ‡åœ°å€ï¼šè¯·æ±‚è¦è½¬å‘åˆ°å“ªé‡Œ  
â€¢ å¤„ç†è§„åˆ™ï¼šè½¬å‘æ—¶è¦åšä»€ä¹ˆå¤„ç†
```

### 6.2 å¸¸è§è·¯ç”±åŒ¹é…æ–¹å¼



**ğŸ›¤ï¸ è·¯å¾„åŒ¹é…æ¨¡å¼**

| **åŒ¹é…ç±»å‹** | **ç¤ºä¾‹** | **è¯´æ˜** |
|-------------|---------|----------|
| **ç²¾ç¡®åŒ¹é…** | `/api/user/info` | å®Œå…¨åŒ¹é…æŒ‡å®šè·¯å¾„ |
| **å‰ç¼€åŒ¹é…** | `/api/user/**` | åŒ¹é…æŒ‡å®šå‰ç¼€çš„è·¯å¾„ |
| **é€šé…ç¬¦åŒ¹é…** | `/api/*/info` | ä½¿ç”¨é€šé…ç¬¦åŒ¹é… |
| **æ­£åˆ™åŒ¹é…** | `/api/user/\d+` | ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ |

**ğŸ’¡ å®é™…åº”ç”¨ç¤ºä¾‹**
```yaml
# ä¸åŒç±»å‹çš„è·¯ç”±é…ç½®

spring:
  cloud:
    gateway:
      routes:
#        # ç²¾ç¡®åŒ¹é…ï¼šåªæœ‰ /api/user/login èµ°è¿™ä¸ªè·¯ç”±
        - id: user-login
          uri: lb://user-service
          predicates:
            - Path=/api/user/login
        
#        # å‰ç¼€åŒ¹é…ï¼šæ‰€æœ‰ /api/user/ å¼€å¤´çš„èµ°è¿™ä¸ªè·¯ç”±
        - id: user-api
          uri: lb://user-service
          predicates:
            - Path=/api/user/**
        
#        # å¸¦å‚æ•°åŒ¹é…ï¼šåŒ¹é… /api/user/123 è¿™æ ·çš„è·¯å¾„
        - id: user-detail
          uri: lb://user-service
          predicates:
            - Path=/api/user/{id}
```

### 6.3 é«˜çº§è·¯ç”±ç­–ç•¥



**âš–ï¸ åŸºäºæƒé‡çš„è·¯ç”±**
```yaml
# å®ç°ç°åº¦å‘å¸ƒï¼š90%æµé‡åˆ°v1ï¼Œ10%æµé‡åˆ°v2

routes:
  - id: user-service-v1
    uri: lb://user-service-v1
    predicates:
      - Path=/api/user/**
      - Weight=group1, 90
  
  - id: user-service-v2  
    uri: lb://user-service-v2
    predicates:
      - Path=/api/user/**
      - Weight=group1, 10
```

**ğŸ¯ åŸºäºç”¨æˆ·çš„è·¯ç”±**
```yaml
# VIPç”¨æˆ·èµ°ä¸“ç”¨æœåŠ¡

routes:
  - id: vip-user-service
    uri: lb://vip-user-service
    predicates:
      - Path=/api/user/**
      - Header=User-Type, VIP
  
  - id: normal-user-service
    uri: lb://user-service  
    predicates:
      - Path=/api/user/**
```

### 6.4 è·¯ç”±è§„åˆ™è®¾è®¡æœ€ä½³å®è·µ



**ğŸ“‹ è®¾è®¡åŸåˆ™**
- **æ˜ç¡®æ€§**ï¼šè·¯ç”±è§„åˆ™è¦æ¸…æ™°æ˜ç¡®ï¼Œé¿å…æ­§ä¹‰
- **ä¼˜å…ˆçº§**ï¼šç²¾ç¡®åŒ¹é…ä¼˜å…ˆäºæ¨¡ç³ŠåŒ¹é…
- **å¯ç»´æŠ¤æ€§**ï¼šè§„åˆ™è¦å®¹æ˜“ç†è§£å’Œä¿®æ”¹
- **æ€§èƒ½è€ƒè™‘**ï¼šé¿å…å¤æ‚çš„æ­£åˆ™è¡¨è¾¾å¼

**ğŸš¨ å¸¸è§é—®é¢˜é¿å…**
```
âŒ è·¯ç”±è§„åˆ™å†²çªï¼š
/api/user/** å’Œ /api/user/admin/** åŒæ—¶å­˜åœ¨

âœ… æ­£ç¡®çš„åšæ³•ï¼š
å…ˆé…ç½®ç²¾ç¡®çš„è§„åˆ™ï¼Œå†é…ç½®é€šç”¨è§„åˆ™
```

---

## 7. ğŸ”— è¿‡æ»¤å™¨é“¾æœºåˆ¶



### 7.1 è¿‡æ»¤å™¨é“¾åŸºç¡€æ¦‚å¿µ



**ğŸ”¸ ä»€ä¹ˆæ˜¯è¿‡æ»¤å™¨é“¾**
è¿‡æ»¤å™¨é“¾å°±åƒå·¥å‚çš„æµæ°´çº¿ï¼Œè¯·æ±‚ç»è¿‡æ¯ä¸ªå·¥ä½ï¼ˆè¿‡æ»¤å™¨ï¼‰è¿›è¡Œä¸åŒçš„å¤„ç†ã€‚

**ğŸ­ æµæ°´çº¿ç±»æ¯”**
```
åŸææ–™(è¯·æ±‚) â†’ å·¥ä½1(è®¤è¯) â†’ å·¥ä½2(é™æµ) â†’ å·¥ä½3(æ—¥å¿—) â†’ æˆå“(å¤„ç†åçš„è¯·æ±‚)
```

### 7.2 è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåº



**ğŸ“‹ Spring Cloud Gatewayè¿‡æ»¤å™¨åˆ†ç±»**

| **è¿‡æ»¤å™¨ç±»å‹** | **æ‰§è¡Œæ—¶æœº** | **å…¸å‹ç”¨é€”** |
|---------------|-------------|-------------|
| **å…¨å±€è¿‡æ»¤å™¨** | æ‰€æœ‰è¯·æ±‚éƒ½ä¼šæ‰§è¡Œ | è®¤è¯ã€æ—¥å¿—ã€ç›‘æ§ |
| **è·¯ç”±è¿‡æ»¤å™¨** | ç‰¹å®šè·¯ç”±çš„è¯·æ±‚æ‰§è¡Œ | ç‰¹æ®Šä¸šåŠ¡å¤„ç† |
| **å†…ç½®è¿‡æ»¤å™¨** | ç³»ç»Ÿé¢„å®šä¹‰ | é€šç”¨åŠŸèƒ½ |

**âš¡ æ‰§è¡Œæµç¨‹å›¾**
```
è¯·æ±‚è¿›å…¥ â†’ å…¨å±€å‰ç½®è¿‡æ»¤å™¨ â†’ è·¯ç”±è¿‡æ»¤å™¨ â†’ è½¬å‘è¯·æ±‚ â†’ è·¯ç”±åç½®è¿‡æ»¤å™¨ â†’ å…¨å±€åç½®è¿‡æ»¤å™¨ â†’ è¿”å›å“åº”
```

### 7.3 è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨



**ğŸ› ï¸ å®ç°è®¤è¯è¿‡æ»¤å™¨**
```java
@Component
public class AuthGlobalFilter implements GlobalFilter, Ordered {
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {
        ServerHttpRequest request = exchange.getRequest();
        
        // æ£€æŸ¥æ˜¯å¦éœ€è¦è®¤è¯
        String path = request.getPath().toString();
        if (needAuth(path)) {
            String token = request.getHeaders().getFirst("Authorization");
            
            if (!isValidToken(token)) {
                // è®¤è¯å¤±è´¥ï¼Œè¿”å›401
                ServerHttpResponse response = exchange.getResponse();
                response.setStatusCode(HttpStatus.UNAUTHORIZED);
                return response.setComplete();
            }
        }
        
        // è®¤è¯é€šè¿‡ï¼Œç»§ç»­æ‰§è¡Œ
        return chain.filter(exchange);
    }
    
    @Override
    public int getOrder() {
        return -100; // ä¼˜å…ˆçº§é«˜ï¼Œæ—©æ‰§è¡Œ
    }
    
    private boolean needAuth(String path) {
        // åˆ¤æ–­è·¯å¾„æ˜¯å¦éœ€è¦è®¤è¯
        return !path.startsWith("/public/");
    }
    
    private boolean isValidToken(String token) {
        // ç®€å•çš„tokenéªŒè¯é€»è¾‘
        return token != null && token.startsWith("Bearer ");
    }
}
```

### 7.4 è¿‡æ»¤å™¨æœ€ä½³å®è·µ



**ğŸ’¡ è®¾è®¡å»ºè®®**
- **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªè¿‡æ»¤å™¨åªåšä¸€ä»¶äº‹
- **æ€§èƒ½ä¼˜å…ˆ**ï¼šé¿å…åœ¨è¿‡æ»¤å™¨ä¸­åšé‡IOæ“ä½œ
- **å¼‚å¸¸å¤„ç†**ï¼šè¦å¤„ç†å¥½å¼‚å¸¸æƒ…å†µ
- **ä¼˜å…ˆçº§ç®¡ç†**ï¼šåˆç†è®¾ç½®è¿‡æ»¤å™¨çš„æ‰§è¡Œé¡ºåº

**ğŸ¯ å¸¸ç”¨è¿‡æ»¤å™¨æ¨¡å¼**
```
è®¤è¯è¿‡æ»¤å™¨ â†’ é™æµè¿‡æ»¤å™¨ â†’ æ—¥å¿—è¿‡æ»¤å™¨ â†’ ä¸šåŠ¡è¿‡æ»¤å™¨
```

---

## 8. ğŸ”Œ æ’ä»¶æœºåˆ¶è¯¦è§£



### 8.1 æ’ä»¶æœºåˆ¶æ¦‚è¿°



**ğŸ”¸ ä»€ä¹ˆæ˜¯æ’ä»¶æœºåˆ¶**
æ’ä»¶æœºåˆ¶å°±åƒæ‰‹æœºçš„åº”ç”¨å•†åº—ï¼Œå¯ä»¥æŒ‰éœ€å®‰è£…ä¸åŒçš„åŠŸèƒ½æ¨¡å—ã€‚

**æ’ä»¶çš„ä¼˜åŠ¿**
- **æ¨¡å—åŒ–**ï¼šåŠŸèƒ½ç‹¬ç«‹ï¼Œäº’ä¸å½±å“
- **å¯æ‰©å±•**ï¼šå¯ä»¥éšæ—¶æ·»åŠ æ–°åŠŸèƒ½
- **å¯å¤ç”¨**ï¼šä¸€æ¬¡å¼€å‘ï¼Œå¤šå¤„ä½¿ç”¨
- **çƒ­æ’æ‹”**ï¼šå¯ä»¥åŠ¨æ€å¯ç”¨/ç¦ç”¨

### 8.2 Spring Cloud Gatewayæ’ä»¶å¼€å‘



**ğŸ› ï¸ è‡ªå®šä¹‰è¿‡æ»¤å™¨å·¥å‚**
```java
@Component
public class CustomGatewayFilterFactory extends AbstractGatewayFilterFactory<CustomGatewayFilterFactory.Config> {
    
    public CustomGatewayFilterFactory() {
        super(Config.class);
    }
    
    @Override
    public GatewayFilter apply(Config config) {
        return (exchange, chain) -> {
            // å‰ç½®å¤„ç†
            System.out.println("æ’ä»¶å¤„ç†ï¼š" + config.getMessage());
            
            return chain.filter(exchange).then(Mono.fromRunnable(() -> {
                // åç½®å¤„ç†
                System.out.println("æ’ä»¶å®Œæˆå¤„ç†");
            }));
        };
    }
    
    @Data
    public static class Config {
        private String message;
    }
}
```

**ğŸ“ ä½¿ç”¨è‡ªå®šä¹‰æ’ä»¶**
```yaml
spring:
  cloud:
    gateway:
      routes:
        - id: test-route
          uri: http://localhost:8080
          predicates:
            - Path=/test/**
          filters:
            - Custom=message=Hello World
```

### 8.3 Kongæ’ä»¶å¼€å‘ç¤ºä¾‹



**ğŸ¦ Kong Luaæ’ä»¶åŸºç¡€**
Kongæ’ä»¶ä½¿ç”¨Luaè¯­è¨€å¼€å‘ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„é™æµæ’ä»¶ï¼š

```lua
-- æ’ä»¶çš„åŸºæœ¬ç»“æ„
local plugin = {
  PRIORITY = 1000,
  VERSION = "0.1.0",
}

-- åœ¨è¯·æ±‚é˜¶æ®µæ‰§è¡Œ
function plugin:access(plugin_conf)
  local current_time = ngx.time()
  local key = "rate_limit:" .. ngx.var.remote_addr
  
  -- ç®€å•çš„é™æµé€»è¾‘
  local count = kong.cache:get(key) or 0
  if count >= plugin_conf.limit then
    return kong.response.exit(429, {message = "è¯·æ±‚è¿‡äºé¢‘ç¹"})
  end
  
  kong.cache:set(key, count + 1, 60)  -- 1åˆ†é’Ÿè¿‡æœŸ
end

return plugin
```

### 8.4 æ’ä»¶ç®¡ç†æœ€ä½³å®è·µ



**ğŸ“‹ æ’ä»¶è®¾è®¡åŸåˆ™**
- **é…ç½®é©±åŠ¨**ï¼šé€šè¿‡é…ç½®æ§åˆ¶æ’ä»¶è¡Œä¸º
- **å‘åå…¼å®¹**ï¼šæ’ä»¶å‡çº§ä¸å½±å“ç°æœ‰åŠŸèƒ½
- **æ€§èƒ½ç›‘æ§**ï¼šç›‘æ§æ’ä»¶å¯¹æ€§èƒ½çš„å½±å“
- **æ–‡æ¡£å®Œå–„**ï¼šæä¾›æ¸…æ™°çš„ä½¿ç”¨æ–‡æ¡£

---

## 9. âš¡ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥



### 9.1 ç½‘å…³æ€§èƒ½ç“¶é¢ˆåˆ†æ



**ğŸ” å¸¸è§æ€§èƒ½é—®é¢˜**

| **é—®é¢˜ç±»å‹** | **ç°è±¡** | **å½±å“** |
|-------------|---------|----------|
| **è¿æ¥æ± è€—å°½** | å¤§é‡TIME_WAITè¿æ¥ | æ— æ³•å¤„ç†æ–°è¯·æ±‚ |
| **å†…å­˜æ³„æ¼** | å†…å­˜ä½¿ç”¨æŒç»­å¢é•¿ | ç³»ç»Ÿå˜æ…¢æˆ–å´©æºƒ |
| **çº¿ç¨‹é˜»å¡** | çº¿ç¨‹æ± æ»¡ | è¯·æ±‚æ’é˜Ÿç­‰å¾… |
| **GCé¢‘ç¹** | åƒåœ¾å›æ”¶æ—¶é—´é•¿ | å“åº”æ—¶é—´ä¸ç¨³å®š |

### 9.2 è¿æ¥æ± ä¼˜åŒ–é…ç½®



**ğŸ”§ Nettyè¿æ¥æ± è°ƒä¼˜**
```yaml
# Spring Cloud Gatewayè¿æ¥æ± é…ç½®

spring:
  cloud:
    gateway:
      httpclient:
        pool:
          type: ELASTIC  # å¼¹æ€§è¿æ¥æ± 
          max-connections: 1000  # æœ€å¤§è¿æ¥æ•°
          max-idle-time: 30s     # æœ€å¤§ç©ºé—²æ—¶é—´
        connect-timeout: 3000    # è¿æ¥è¶…æ—¶
        response-timeout: 10s    # å“åº”è¶…æ—¶
```

**ğŸ’¡ é…ç½®è¯´æ˜**
- **ELASTICæ± **ï¼šæ ¹æ®è´Ÿè½½åŠ¨æ€è°ƒæ•´è¿æ¥æ•°
- **max-connections**ï¼šé™åˆ¶æ€»è¿æ¥æ•°ï¼Œé˜²æ­¢èµ„æºè€—å°½
- **max-idle-time**ï¼šåŠæ—¶é‡Šæ”¾ç©ºé—²è¿æ¥
- **è¶…æ—¶è®¾ç½®**ï¼šé¿å…é•¿æ—¶é—´ç­‰å¾…

### 9.3 å†…å­˜ä¼˜åŒ–ç­–ç•¥



**ğŸ§  JVMå†…å­˜è°ƒä¼˜**
```bash
# æ¨èçš„JVMå‚æ•°

java -Xms2g -Xmx4g \
     -XX:+UseG1GC \
     -XX:MaxGCPauseMillis=200 \
     -XX:+UseStringDeduplication \
     -jar gateway-service.jar
```

**ğŸ“Š å†…å­˜ä½¿ç”¨ç›‘æ§**
```java
@Component
public class MemoryMonitor {
    
    @Scheduled(fixedRate = 30000)  // 30ç§’æ‰§è¡Œä¸€æ¬¡
    public void logMemoryUsage() {
        MemoryMXBean memoryBean = ManagementFactory.getMemoryMXBean();
        MemoryUsage heapUsage = memoryBean.getHeapMemoryUsage();
        
        long used = heapUsage.getUsed() / 1024 / 1024;  // MB
        long max = heapUsage.getMax() / 1024 / 1024;   // MB
        
        System.out.println("å†…å­˜ä½¿ç”¨: " + used + "MB / " + max + "MB");
        
        // å†…å­˜ä½¿ç”¨ç‡è¶…è¿‡80%æ—¶å‘Šè­¦
        if (used * 100 / max > 80) {
            System.out.println("âš ï¸ å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜ï¼");
        }
    }
}
```

### 9.4 ç¼“å­˜ä¼˜åŒ–ç­–ç•¥



**ğŸ’¾ å¤šçº§ç¼“å­˜è®¾è®¡**
```java
@Component  
public class RouteCache {
    
    // æœ¬åœ°ç¼“å­˜
    private final Cache<String, Route> localCache = Caffeine.newBuilder()
            .maximumSize(1000)
            .expireAfterWrite(5, TimeUnit.MINUTES)
            .build();
    
    // Redisåˆ†å¸ƒå¼ç¼“å­˜        
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    public Route getRoute(String path) {
        // 1. å…ˆæŸ¥æœ¬åœ°ç¼“å­˜
        Route route = localCache.getIfPresent(path);
        if (route != null) {
            return route;
        }
        
        // 2. æŸ¥Redisç¼“å­˜
        route = (Route) redisTemplate.opsForValue().get("route:" + path);
        if (route != null) {
            localCache.put(path, route);  // å›å†™æœ¬åœ°ç¼“å­˜
            return route;
        }
        
        // 3. æŸ¥æ•°æ®åº“å¹¶ç¼“å­˜
        route = routeService.findByPath(path);
        if (route != null) {
            redisTemplate.opsForValue().set("route:" + path, route, 10, TimeUnit.MINUTES);
            localCache.put(path, route);
        }
        
        return route;
    }
}
```

### 9.5 è´Ÿè½½æµ‹è¯•ä¸ç›‘æ§



**ğŸ“ˆ æ€§èƒ½åŸºå‡†æµ‹è¯•**
```bash
# ä½¿ç”¨Apache Benchè¿›è¡Œå‹åŠ›æµ‹è¯•

ab -n 10000 -c 100 http://localhost:8080/api/user/info

# ä½¿ç”¨wrkè¿›è¡Œæµ‹è¯•

wrk -t12 -c400 -d30s http://localhost:8080/api/user/info
```

**ğŸ“Š å…³é”®æŒ‡æ ‡ç›‘æ§**
- **ååé‡ï¼ˆTPSï¼‰**ï¼šæ¯ç§’å¤„ç†è¯·æ±‚æ•°
- **å“åº”æ—¶é—´**ï¼šå¹³å‡å“åº”æ—¶é—´å’ŒP99å“åº”æ—¶é—´
- **é”™è¯¯ç‡**ï¼š4xxå’Œ5xxé”™è¯¯çš„æ¯”ä¾‹
- **èµ„æºä½¿ç”¨ç‡**ï¼šCPUã€å†…å­˜ã€ç½‘ç»œä½¿ç”¨æƒ…å†µ

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“



### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ



```
ğŸ”¸ APIç½‘å…³æœ¬è´¨ï¼šå¾®æœåŠ¡æ¶æ„ä¸­çš„ç»Ÿä¸€æµé‡å…¥å£
ğŸ”¸ æ ¸å¿ƒåŠŸèƒ½ï¼šè·¯ç”±è½¬å‘ã€è®¤è¯é‰´æƒã€è´Ÿè½½å‡è¡¡ã€ç›‘æ§æ—¥å¿—
ğŸ”¸ ä¸»æµæŠ€æœ¯ï¼šSpring Cloud Gatewayã€Zuulã€Kongã€Nginx Plus
ğŸ”¸ å…³é”®æœºåˆ¶ï¼šè·¯ç”±è§„åˆ™ã€è¿‡æ»¤å™¨é“¾ã€æ’ä»¶ç³»ç»Ÿ
ğŸ”¸ æ€§èƒ½ä¼˜åŒ–ï¼šè¿æ¥æ± ç®¡ç†ã€ç¼“å­˜ç­–ç•¥ã€ç›‘æ§è°ƒä¼˜
```

### 10.2 æŠ€æœ¯é€‰å‹æŒ‡å¯¼



**ğŸ¯ é€‰æ‹©å»ºè®®çŸ©é˜µ**

| **åœºæ™¯** | **æ¨èæŠ€æœ¯** | **ç†ç”±** |
|---------|-------------|----------|
| **Javaå¾®æœåŠ¡æ–°é¡¹ç›®** | Spring Cloud Gateway | ç”Ÿæ€é›†æˆå¥½ï¼Œæ€§èƒ½ä¼˜ç§€ |
| **Javaå¾®æœåŠ¡è€é¡¹ç›®** | Zuul 1.x | ç¨³å®šå¯é ï¼Œè¿ç§»æˆæœ¬ä½ |
| **å¤šè¯­è¨€å¾®æœåŠ¡** | Kong | è¯­è¨€æ— å…³ï¼Œæ’ä»¶ä¸°å¯Œ |
| **æé«˜æ€§èƒ½éœ€æ±‚** | Nginx Plus | åŸºäºCï¼Œæ€§èƒ½æœ€å¼º |

### 10.3 å®è·µåº”ç”¨è¦ç‚¹



**ğŸ’¡ éƒ¨ç½²å»ºè®®**
- **é«˜å¯ç”¨**ï¼šè‡³å°‘éƒ¨ç½²2ä¸ªç½‘å…³å®ä¾‹
- **ç›‘æ§å®Œå–„**ï¼šç›‘æ§æ‰€æœ‰å…³é”®æŒ‡æ ‡
- **ç°åº¦å‘å¸ƒ**ï¼šä½¿ç”¨æƒé‡è·¯ç”±å®ç°ç°åº¦
- **å®‰å…¨é˜²æŠ¤**ï¼šå¯ç”¨HTTPSã€é™æµã€é˜²åˆ·

**ğŸ”§ è¿ç»´è¦ç‚¹**
- **æ—¥å¿—ç®¡ç†**ï¼šé›†ä¸­æ”¶é›†å’Œåˆ†æç½‘å…³æ—¥å¿—
- **é…ç½®ç®¡ç†**ï¼šä½¿ç”¨é…ç½®ä¸­å¿ƒç»Ÿä¸€ç®¡ç†
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šç½‘å…³é…ç½®è¦ç‰ˆæœ¬åŒ–ç®¡ç†
- **åº”æ€¥é¢„æ¡ˆ**ï¼šå‡†å¤‡ç½‘å…³æ•…éšœçš„åº”æ€¥æ–¹æ¡ˆ

### 10.4 å­¦ä¹ æ£€æŸ¥æ¸…å•



**ğŸ“‹ åŸºç¡€æŒæ¡**
- [ ] ç†è§£APIç½‘å…³çš„ä½œç”¨å’Œä»·å€¼
- [ ] æŒæ¡Spring Cloud GatewayåŸºç¡€é…ç½®
- [ ] äº†è§£Zuulå’ŒKongçš„ç‰¹ç‚¹
- [ ] ä¼šç¼–å†™ç®€å•çš„è·¯ç”±è§„åˆ™

**ğŸ“‹ è¿›é˜¶èƒ½åŠ›**
- [ ] èƒ½å¼€å‘è‡ªå®šä¹‰è¿‡æ»¤å™¨
- [ ] ç†è§£æ’ä»¶æœºåˆ¶çš„è®¾è®¡åŸç†
- [ ] æŒæ¡ç½‘å…³æ€§èƒ½ä¼˜åŒ–æ–¹æ³•
- [ ] èƒ½è®¾è®¡é«˜å¯ç”¨çš„ç½‘å…³æ¶æ„

**ğŸ”‘ æ ¸å¿ƒè®°å¿†**
> APIç½‘å…³æ˜¯å¾®æœåŠ¡çš„å¤§é—¨ï¼Œç»Ÿä¸€ç®¡ç†è¿›å‡ºæµé‡
> è·¯ç”±è§„åˆ™å†³å®šè¯·æ±‚å»å‘ï¼Œè¿‡æ»¤å™¨å¤„ç†é€šç”¨é€»è¾‘
> æ€§èƒ½ä¼˜åŒ–é‡è¿æ¥æ± ï¼Œç›‘æ§å‘Šè­¦ä¿ç¨³å®š
> æŠ€æœ¯é€‰å‹çœ‹åœºæ™¯ï¼ŒJavaé¦–é€‰Gatewayæ–¹æ¡ˆ

**ğŸ’¡ è¿›é˜¶å­¦ä¹ å»ºè®®**
- æ·±å…¥å­¦ä¹ Spring WebFluxå“åº”å¼ç¼–ç¨‹
- äº†è§£æœåŠ¡ç½‘æ ¼ï¼ˆService Meshï¼‰æŠ€æœ¯
- å­¦ä¹ APIç®¡ç†å’Œæ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ
- æŒæ¡åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªå’Œç›‘æ§