---
title: 4ã€å‘å¸ƒç­–ç•¥
---
## ğŸ“š ç›®å½•

1. [å‘å¸ƒç­–ç•¥æ¦‚è¿°](#1-å‘å¸ƒç­–ç•¥æ¦‚è¿°)
2. [è“ç»¿éƒ¨ç½²](#2-è“ç»¿éƒ¨ç½²)
3. [é‡‘ä¸é›€å‘å¸ƒ](#3-é‡‘ä¸é›€å‘å¸ƒ)
4. [æ»šåŠ¨æ›´æ–°](#4-æ»šåŠ¨æ›´æ–°)
5. [A/Bæµ‹è¯•](#5-ABæµ‹è¯•)
6. [ç°åº¦å‘å¸ƒ](#6-ç°åº¦å‘å¸ƒ)
7. [å›æ»šæœºåˆ¶](#7-å›æ»šæœºåˆ¶)
8. [æµé‡åˆ‡æ¢](#8-æµé‡åˆ‡æ¢)
9. [å‘å¸ƒç›‘æ§](#9-å‘å¸ƒç›‘æ§)
10. [ç­–ç•¥é€‰æ‹©æŒ‡å—](#10-ç­–ç•¥é€‰æ‹©æŒ‡å—)
11. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#11-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ å‘å¸ƒç­–ç•¥æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯å‘å¸ƒç­–ç•¥


**ç®€å•ç†è§£**ï¼šå‘å¸ƒç­–ç•¥å°±æ˜¯æŠŠæ–°ç‰ˆæœ¬çš„å¾®æœåŠ¡å®‰å…¨åœ°æ›¿æ¢æ—§ç‰ˆæœ¬çš„æ–¹æ³•

> ğŸ’¡ **é€šä¿—è§£é‡Š**ï¼šå°±åƒæ›´æ¢å•†åº—é‡Œçš„å•†å“ä¸€æ ·ï¼Œä½ ä¸ä¼šæŠŠæ‰€æœ‰æ—§å•†å“ä¸€ä¸‹å­å…¨éƒ¨æ’¤æ‰ï¼Œè€Œæ˜¯è¦æœ‰è®¡åˆ’ã€æœ‰æ­¥éª¤åœ°æ›´æ¢ï¼Œç¡®ä¿é¡¾å®¢éšæ—¶éƒ½èƒ½ä¹°åˆ°ä¸œè¥¿

**ä¸ºä»€ä¹ˆéœ€è¦å‘å¸ƒç­–ç•¥ï¼Ÿ**
```
ä¼ ç»Ÿå‘å¸ƒé—®é¢˜ï¼š
âŒ ç›´æ¥æ›¿æ¢ â†’ æœåŠ¡ä¸­æ–­
âŒ å‡ºç°é—®é¢˜ â†’ å½±å“æ‰€æœ‰ç”¨æˆ·  
âŒ å›æ»šå›°éš¾ â†’ æ¢å¤æ—¶é—´é•¿

å¾®æœåŠ¡å‘å¸ƒç›®æ ‡ï¼š
âœ… é›¶åœæœºéƒ¨ç½²
âœ… å¿«é€Ÿé—®é¢˜å‘ç°
âœ… é£é™©å¯æ§
âœ… å¿«é€Ÿå›æ»š
```

### 1.2 å‘å¸ƒç­–ç•¥åˆ†ç±»


**æŒ‰é£é™©æ§åˆ¶åˆ†ç±»ï¼š**
- ğŸ”´ **é«˜é£é™©**ï¼šç›´æ¥æ›¿æ¢ï¼ˆç”Ÿäº§ç¯å¢ƒä¸æ¨èï¼‰
- ğŸŸ¡ **ä¸­é£é™©**ï¼šæ»šåŠ¨æ›´æ–°ã€è“ç»¿éƒ¨ç½²
- ğŸŸ¢ **ä½é£é™©**ï¼šé‡‘ä¸é›€å‘å¸ƒã€ç°åº¦å‘å¸ƒ

**æŒ‰æµé‡åˆ‡æ¢åˆ†ç±»ï¼š**
- âš¡ **ç¬æ—¶åˆ‡æ¢**ï¼šè“ç»¿éƒ¨ç½²
- ğŸ“ˆ **æ¸è¿›åˆ‡æ¢**ï¼šé‡‘ä¸é›€å‘å¸ƒã€ç°åº¦å‘å¸ƒ
- ğŸ”„ **æ‰¹æ¬¡åˆ‡æ¢**ï¼šæ»šåŠ¨æ›´æ–°

---

## 2. ğŸ”µ è“ç»¿éƒ¨ç½²


### 2.1 åŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯è“ç»¿éƒ¨ç½²ï¼Ÿ**

> ğŸ’¡ **ç”Ÿæ´»æ¯”å–»**ï¼šå°±åƒèˆå°è¡¨æ¼”æ—¶çš„ä¸¤ä¸ªèˆå°ï¼Œä¸€ä¸ªèˆå°åœ¨æ¼”å‡ºï¼ˆè“ç¯å¢ƒï¼‰ï¼Œå¦ä¸€ä¸ªèˆå°åœ¨å‡†å¤‡ä¸‹ä¸€åœºï¼ˆç»¿ç¯å¢ƒï¼‰ã€‚å‡†å¤‡å¥½åï¼Œèšå…‰ç¯ç¬é—´åˆ‡æ¢åˆ°æ–°èˆå°

```
è“ç»¿éƒ¨ç½²æ¶æ„ï¼š

ç”¨æˆ·è¯·æ±‚ â†’ è´Ÿè½½å‡è¡¡å™¨ â†’ å½“å‰æ´»è·ƒç¯å¢ƒ
                    |
                    â”œâ”€â”€ è“ç¯å¢ƒï¼ˆå½“å‰ç”Ÿäº§ï¼‰v1.0
                    â””â”€â”€ ç»¿ç¯å¢ƒï¼ˆå‡†å¤‡å‘å¸ƒï¼‰v2.0

å‘å¸ƒæ—¶ï¼šè´Ÿè½½å‡è¡¡å™¨åˆ‡æ¢æŒ‡å‘ç»¿ç¯å¢ƒ
```

### 2.2 éƒ¨ç½²æµç¨‹


**éƒ¨ç½²æ­¥éª¤ï¼š**

â‘  **å‡†å¤‡é˜¶æ®µ**
```
â€¢ è“ç¯å¢ƒï¼šè¿è¡Œå½“å‰ç‰ˆæœ¬v1.0ï¼Œå¤„ç†ç”Ÿäº§æµé‡
â€¢ ç»¿ç¯å¢ƒï¼šéƒ¨ç½²æ–°ç‰ˆæœ¬v2.0ï¼Œè¿›è¡Œæµ‹è¯•éªŒè¯
```

â‘¡ **éªŒè¯é˜¶æ®µ**  
```
â€¢ åœ¨ç»¿ç¯å¢ƒè¿›è¡Œï¼š
  - åŠŸèƒ½æµ‹è¯•
  - æ€§èƒ½æµ‹è¯•  
  - æ•°æ®åº“è¿æ¥æµ‹è¯•
  - ä¾èµ–æœåŠ¡è¿é€šæ€§æµ‹è¯•
```

â‘¢ **åˆ‡æ¢é˜¶æ®µ**
```java
// è´Ÿè½½å‡è¡¡å™¨é…ç½®ç¤ºä¾‹
@Configuration
public class LoadBalancerConfig {
    
    @Value("${deployment.active.environment}")
    private String activeEnvironment; // blue æˆ– green
    
    @Bean
    public RouteLocator customRouteLocator(RouteLocatorBuilder builder) {
        return builder.routes()
            .route("service-route", r -> r.path("/api/**")
                .uri("http://service-" + activeEnvironment + ":8080"))
            .build();
    }
}
```

â‘£ **éªŒè¯é˜¶æ®µ**
```
åˆ‡æ¢åç«‹å³éªŒè¯ï¼š
â€¢ å…³é”®åŠŸèƒ½æ­£å¸¸
â€¢ å“åº”æ—¶é—´æ­£å¸¸
â€¢ é”™è¯¯ç‡åœ¨é¢„æœŸèŒƒå›´å†…
```

### 2.3 ä¼˜ç¼ºç‚¹åˆ†æ


| ç‰¹ç‚¹ | ä¼˜åŠ¿ âœ… | åŠ£åŠ¿ âŒ |
|------|---------|---------|
| **éƒ¨ç½²é€Ÿåº¦** | ç¬æ—¶åˆ‡æ¢ï¼Œç”¨æˆ·æ— æ„ŸçŸ¥ | éœ€è¦åŒå€èµ„æº |
| **å›æ»šé€Ÿåº¦** | ç§’çº§å›æ»šï¼Œåˆ‡æ¢è´Ÿè½½å‡è¡¡ | èµ„æºæˆæœ¬é«˜ |
| **é£é™©æ§åˆ¶** | å……åˆ†éªŒè¯åæ‰åˆ‡æ¢ | æ•°æ®åº“è¿ç§»å¤æ‚ |
| **é€‚ç”¨åœºæ™¯** | é‡è¦ä¸šåŠ¡ï¼Œè¦æ±‚é›¶åœæœº | æœ‰çŠ¶æ€æœåŠ¡å›°éš¾ |

### 2.4 å®é™…åº”ç”¨åœºæ™¯


**æœ€é€‚åˆçš„åœºæ™¯ï¼š**
- âœ… **æ— çŠ¶æ€æœåŠ¡**ï¼šAPIæœåŠ¡ã€Webåº”ç”¨
- âœ… **é‡è¦ä¸šåŠ¡**ï¼šæ”¯ä»˜ç³»ç»Ÿã€æ ¸å¿ƒä¸šåŠ¡
- âœ… **èµ„æºå……è¶³**ï¼šå¯ä»¥æ‰¿æ‹…åŒå€èµ„æºæˆæœ¬

**ä¸é€‚åˆçš„åœºæ™¯ï¼š**
- âŒ **æœ‰çŠ¶æ€æœåŠ¡**ï¼šæ•°æ®åº“ã€ç¼“å­˜æœåŠ¡
- âŒ **èµ„æºå—é™**ï¼šå°å›¢é˜Ÿã€æˆæœ¬æ•æ„Ÿé¡¹ç›®
- âŒ **é¢‘ç¹å‘å¸ƒ**ï¼šä¸€å¤©å¤šæ¬¡å‘å¸ƒçš„åœºæ™¯

---

## 3. ğŸ¦ é‡‘ä¸é›€å‘å¸ƒ


### 3.1 åŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯é‡‘ä¸é›€å‘å¸ƒï¼Ÿ**

> ğŸ’¡ **å†å²å…¸æ•…**ï¼šçŸ¿å·¥ä¸‹äº•å‰ä¼šå¸¦ä¸€åªé‡‘ä¸é›€ï¼Œå› ä¸ºé‡‘ä¸é›€å¯¹æœ‰æ¯’æ°”ä½“å¾ˆæ•æ„Ÿã€‚å¦‚æœé‡‘ä¸é›€å‡ºç°å¼‚å¸¸ï¼ŒçŸ¿å·¥å°±çŸ¥é“ç¯å¢ƒå±é™©

**å¾®æœåŠ¡ä¸­çš„åº”ç”¨ï¼š**
å…ˆè®©å°‘é‡ç”¨æˆ·ï¼ˆé‡‘ä¸é›€ï¼‰ä½¿ç”¨æ–°ç‰ˆæœ¬ï¼Œè§‚å¯Ÿæ˜¯å¦æœ‰é—®é¢˜ï¼Œæ²¡é—®é¢˜å†é€æ­¥æ‰©å¤§

```
é‡‘ä¸é›€å‘å¸ƒæµç¨‹å›¾ï¼š

ç¬¬ä¸€é˜¶æ®µï¼š5%æµé‡ â†’ æ–°ç‰ˆæœ¬ï¼Œ95%æµé‡ â†’ æ—§ç‰ˆæœ¬
    â†“ è§‚å¯Ÿç›‘æ§æŒ‡æ ‡
ç¬¬äºŒé˜¶æ®µï¼š20%æµé‡ â†’ æ–°ç‰ˆæœ¬ï¼Œ80%æµé‡ â†’ æ—§ç‰ˆæœ¬  
    â†“ ç»§ç»­è§‚å¯Ÿ
ç¬¬ä¸‰é˜¶æ®µï¼š50%æµé‡ â†’ æ–°ç‰ˆæœ¬ï¼Œ50%æµé‡ â†’ æ—§ç‰ˆæœ¬
    â†“ æœ€ç»ˆéªŒè¯
ç¬¬å››é˜¶æ®µï¼š100%æµé‡ â†’ æ–°ç‰ˆæœ¬ï¼ˆå®Œæˆå‘å¸ƒï¼‰
```

### 3.2 æŠ€æœ¯å®ç°


**Spring Cloud Gatewayå®ç°ï¼š**

```java
@Component
public class CanaryRoutingFilter implements GlobalFilter, Ordered {
    
    @Value("${canary.percentage:0}")
    private int canaryPercentage; // é‡‘ä¸é›€æµé‡ç™¾åˆ†æ¯”
    
    @Override
    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {
        // ç”Ÿæˆéšæœºæ•°å†³å®šè·¯ç”±
        int random = new Random().nextInt(100);
        
        if (random < canaryPercentage) {
            // è·¯ç”±åˆ°é‡‘ä¸é›€ç‰ˆæœ¬
            exchange.getAttributes().put("service-version", "canary");
        } else {
            // è·¯ç”±åˆ°ç¨³å®šç‰ˆæœ¬
            exchange.getAttributes().put("service-version", "stable");
        }
        
        return chain.filter(exchange);
    }
}
```

**é…ç½®ç¤ºä¾‹ï¼š**
```yaml
# application.yml
canary:
  percentage: 10  # 10%æµé‡èµ°é‡‘ä¸é›€ç‰ˆæœ¬

spring:
  cloud:
    gateway:
      routes:
        - id: stable-route
          uri: http://service-v1:8080
          predicates:
            - Header=X-Service-Version, stable
        - id: canary-route  
          uri: http://service-v2:8080
          predicates:
            - Header=X-Service-Version, canary
```

### 3.3 ç›‘æ§æŒ‡æ ‡


**å…³é”®ç›‘æ§æŒ‡æ ‡ï¼š**

| æŒ‡æ ‡ç±»å‹ | ç›‘æ§å†…å®¹ | æ­£å¸¸èŒƒå›´ | å¼‚å¸¸å¤„ç† |
|----------|----------|----------|----------|
| **é”™è¯¯ç‡** | HTTP 5xxé”™è¯¯æ¯”ä¾‹ | < 0.1% | ç«‹å³å›æ»š |
| **å“åº”æ—¶é—´** | å¹³å‡å“åº”æ—¶é—´ | < 200ms | è°ƒæŸ¥åŸå›  |
| **æˆåŠŸç‡** | ä¸šåŠ¡æˆåŠŸç‡ | > 99.9% | åˆ†æä¸šåŠ¡é€»è¾‘ |
| **èµ„æºä½¿ç”¨** | CPUã€å†…å­˜ä½¿ç”¨ç‡ | < 80% | æ‰©å®¹æˆ–ä¼˜åŒ– |

### 3.4 å‘å¸ƒç­–ç•¥


**é˜¶æ®µæ€§å‘å¸ƒè®¡åˆ’ï¼š**

```
é˜¶æ®µ1ï¼ˆè§‚å¯ŸæœŸ1å°æ—¶ï¼‰ï¼š
â€¢ æµé‡åˆ†é…ï¼š5% â†’ æ–°ç‰ˆæœ¬
â€¢ ç›‘æ§é‡ç‚¹ï¼šé”™è¯¯ç‡ã€å“åº”æ—¶é—´
â€¢ å†³ç­–ï¼šæ­£å¸¸åˆ™è¿›å…¥é˜¶æ®µ2ï¼Œå¼‚å¸¸åˆ™å›æ»š

é˜¶æ®µ2ï¼ˆè§‚å¯ŸæœŸ2å°æ—¶ï¼‰ï¼š  
â€¢ æµé‡åˆ†é…ï¼š20% â†’ æ–°ç‰ˆæœ¬
â€¢ ç›‘æ§é‡ç‚¹ï¼šä¸šåŠ¡æŒ‡æ ‡ã€ç”¨æˆ·ä½“éªŒ
â€¢ å†³ç­–ï¼šæ•°æ®è‰¯å¥½åˆ™è¿›å…¥é˜¶æ®µ3

é˜¶æ®µ3ï¼ˆè§‚å¯ŸæœŸ4å°æ—¶ï¼‰ï¼š
â€¢ æµé‡åˆ†é…ï¼š50% â†’ æ–°ç‰ˆæœ¬  
â€¢ ç›‘æ§é‡ç‚¹ï¼šç³»ç»Ÿç¨³å®šæ€§ã€ä¸šåŠ¡å½±å“
â€¢ å†³ç­–ï¼šç¡®è®¤æ— é—®é¢˜åˆ™å…¨é‡å‘å¸ƒ

é˜¶æ®µ4ï¼ˆå…¨é‡å‘å¸ƒï¼‰ï¼š
â€¢ æµé‡åˆ†é…ï¼š100% â†’ æ–°ç‰ˆæœ¬
â€¢ æŒç»­ç›‘æ§24å°æ—¶
```

---

## 4. ğŸ”„ æ»šåŠ¨æ›´æ–°


### 4.1 åŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯æ»šåŠ¨æ›´æ–°ï¼Ÿ**

> ğŸ’¡ **ç”Ÿæ´»æ¯”å–»**ï¼šå°±åƒæ›´æ¢ç”µæ¢¯ï¼Œä¸ä¼šæŠŠæ‰€æœ‰ç”µæ¢¯åŒæ—¶åœæ‰ç»´ä¿®ï¼Œè€Œæ˜¯ä¸€éƒ¨ä¸€éƒ¨åœ°æ›´æ¢ï¼Œç¡®ä¿ç”¨æˆ·å§‹ç»ˆæœ‰ç”µæ¢¯å¯ç”¨

```
æ»šåŠ¨æ›´æ–°è¿‡ç¨‹ç¤ºæ„ï¼š

åˆå§‹çŠ¶æ€ï¼š    [v1.0] [v1.0] [v1.0] [v1.0]
ç¬¬1æ‰¹æ›´æ–°ï¼š   [v2.0] [v1.0] [v1.0] [v1.0]  
ç¬¬2æ‰¹æ›´æ–°ï¼š   [v2.0] [v2.0] [v1.0] [v1.0]
ç¬¬3æ‰¹æ›´æ–°ï¼š   [v2.0] [v2.0] [v2.0] [v1.0] 
æœ€ç»ˆçŠ¶æ€ï¼š    [v2.0] [v2.0] [v2.0] [v2.0]
```

### 4.2 Kubernetesæ»šåŠ¨æ›´æ–°


**Deploymenté…ç½®ï¼š**

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: user-service
spec:
  replicas: 4
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxUnavailable: 1  # æœ€å¤š1ä¸ªå®ä¾‹ä¸å¯ç”¨
      maxSurge: 1        # æœ€å¤šé¢å¤–åˆ›å»º1ä¸ªå®ä¾‹
  template:
    spec:
      containers:
      - name: user-service
        image: user-service:v2.0
        readinessProbe:    # å°±ç»ªæ£€æŸ¥
          httpGet:
            path: /health
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 10
```

**æ›´æ–°å‘½ä»¤ï¼š**
```bash
# æ›´æ–°é•œåƒç‰ˆæœ¬
kubectl set image deployment/user-service user-service=user-service:v2.0

# æŸ¥çœ‹æ»šåŠ¨æ›´æ–°çŠ¶æ€  
kubectl rollout status deployment/user-service

# æŸ¥çœ‹æ›´æ–°å†å²
kubectl rollout history deployment/user-service
```

### 4.3 æ›´æ–°ç­–ç•¥é…ç½®


**å…³é”®å‚æ•°è¯´æ˜ï¼š**

- **`maxUnavailable`**ï¼šæ›´æ–°è¿‡ç¨‹ä¸­æœ€å¤šæœ‰å¤šå°‘ä¸ªå®ä¾‹ä¸å¯ç”¨
  - æ•°å€¼ï¼šå¦‚ `1`ï¼ˆæœ€å¤š1ä¸ªå®ä¾‹ï¼‰
  - ç™¾åˆ†æ¯”ï¼šå¦‚ `25%`ï¼ˆæœ€å¤š25%çš„å®ä¾‹ï¼‰

- **`maxSurge`**ï¼šæ›´æ–°è¿‡ç¨‹ä¸­æœ€å¤šé¢å¤–åˆ›å»ºå¤šå°‘ä¸ªå®ä¾‹
  - ç”¨é€”ï¼šå…ˆåˆ›å»ºæ–°å®ä¾‹ï¼Œå†åˆ é™¤æ—§å®ä¾‹
  - å¥½å¤„ï¼šç¡®ä¿æœåŠ¡å®¹é‡ä¸ä¸‹é™

```
å®é™…æ›´æ–°è¿‡ç¨‹ï¼ˆ4ä¸ªå®ä¾‹ï¼ŒmaxUnavailable=1ï¼ŒmaxSurge=1ï¼‰ï¼š

æ­¥éª¤1ï¼šåˆ›å»º1ä¸ªæ–°å®ä¾‹v2.0          [v1.0][v1.0][v1.0][v1.0][v2.0]
æ­¥éª¤2ï¼šæ–°å®ä¾‹å°±ç»ªåï¼Œåˆ é™¤1ä¸ªæ—§å®ä¾‹  [v2.0][v1.0][v1.0][v1.0]
æ­¥éª¤3ï¼šé‡å¤ä¸Šè¿°è¿‡ç¨‹               [v2.0][v2.0][v1.0][v1.0] 
æ­¥éª¤4ï¼šç›´åˆ°å…¨éƒ¨æ›´æ–°å®Œæˆ           [v2.0][v2.0][v2.0][v2.0]
```

### 4.4 å¥åº·æ£€æŸ¥é…ç½®


**å°±ç»ªæ£€æŸ¥ï¼ˆReadinessProbeï¼‰ï¼š**

```java
@RestController
public class HealthController {
    
    @Autowired
    private DatabaseHealthIndicator databaseHealth;
    
    @GetMapping("/health/ready")
    public ResponseEntity<Map<String, String>> readiness() {
        Map<String, String> status = new HashMap<>();
        
        // æ£€æŸ¥æ•°æ®åº“è¿æ¥
        if (databaseHealth.isHealthy()) {
            status.put("database", "UP");
        } else {
            status.put("database", "DOWN");
            return ResponseEntity.status(503).body(status);
        }
        
        // æ£€æŸ¥ä¾èµ–æœåŠ¡
        if (checkDependentServices()) {
            status.put("dependencies", "UP");
            status.put("status", "READY");
            return ResponseEntity.ok(status);
        } else {
            status.put("dependencies", "DOWN");
            return ResponseEntity.status(503).body(status);
        }
    }
}
```

---

## 5. ğŸ§ª A/Bæµ‹è¯•


### 5.1 åŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯A/Bæµ‹è¯•ï¼Ÿ**

> ğŸ’¡ **ç”Ÿæ´»ä¾‹å­**ï¼šç½‘åº—æƒ³çŸ¥é“çº¢è‰²æŒ‰é’®å’Œè“è‰²æŒ‰é’®å“ªä¸ªæ›´èƒ½å¸å¼•ç”¨æˆ·ç‚¹å‡»ï¼Œå°±è®©ä¸€åŠç”¨æˆ·çœ‹çº¢è‰²æŒ‰é’®ï¼ˆAç»„ï¼‰ï¼Œä¸€åŠç”¨æˆ·çœ‹è“è‰²æŒ‰é’®ï¼ˆBç»„ï¼‰ï¼Œç„¶åæ¯”è¾ƒç‚¹å‡»ç‡

**ä¸å…¶ä»–ç­–ç•¥çš„åŒºåˆ«ï¼š**
- **é‡‘ä¸é›€å‘å¸ƒ**ï¼šä¸»è¦ç›®çš„æ˜¯éªŒè¯ç¨³å®šæ€§
- **A/Bæµ‹è¯•**ï¼šä¸»è¦ç›®çš„æ˜¯å¯¹æ¯”ä¸šåŠ¡æ•ˆæœ

```
A/Bæµ‹è¯•æ¶æ„ï¼š

ç”¨æˆ·è¯·æ±‚ â†’ åˆ†æµè§„åˆ™ â†’ Aç‰ˆæœ¬ï¼ˆ50%ç”¨æˆ·ï¼‰â†’ æ”¶é›†æŒ‡æ ‡
                  â†’ Bç‰ˆæœ¬ï¼ˆ50%ç”¨æˆ·ï¼‰â†’ æ”¶é›†æŒ‡æ ‡
                                  â†“
                              æ•°æ®åˆ†æå¹³å°
```

### 5.2 å®ç°æ–¹å¼


**åŸºäºç”¨æˆ·IDçš„åˆ†æµï¼š**

```java
@Service
public class ABTestService {
    
    public String getVersionForUser(String userId) {
        // åŸºäºç”¨æˆ·IDå“ˆå¸Œå€¼å†³å®šç‰ˆæœ¬
        int hash = userId.hashCode();
        return Math.abs(hash) % 2 == 0 ? "A" : "B";
    }
    
    @GetMapping("/api/products")
    public ProductResponse getProducts(
            @RequestHeader("User-Id") String userId) {
        
        String version = abTestService.getVersionForUser(userId);
        
        if ("A".equals(version)) {
            return productServiceA.getProducts();
        } else {
            return productServiceB.getProducts();
        }
    }
}
```

**ç‰¹æ€§å¼€å…³é…ç½®ï¼š**

```java
@Component
public class FeatureToggle {
    
    @Value("${feature.new-recommendation.enabled:false}")
    private boolean newRecommendationEnabled;
    
    @Value("${feature.new-recommendation.percentage:0}")
    private int newRecommendationPercentage;
    
    public boolean shouldUseNewRecommendation(String userId) {
        if (!newRecommendationEnabled) {
            return false;
        }
        
        // åŸºäºç”¨æˆ·IDå’Œç™¾åˆ†æ¯”å†³å®š
        int hash = Math.abs(userId.hashCode()) % 100;
        return hash < newRecommendationPercentage;
    }
}
```

### 5.3 æŒ‡æ ‡æ”¶é›†ä¸åˆ†æ


**å…³é”®ä¸šåŠ¡æŒ‡æ ‡ï¼š**

| æŒ‡æ ‡ç±»å‹ | Aç‰ˆæœ¬ | Bç‰ˆæœ¬ | æ¯”è¾ƒç»“æœ |
|----------|-------|-------|----------|
| **è½¬åŒ–ç‡** | 3.2% | 3.8% | Bç‰ˆæœ¬æå‡18.7% |
| **å¹³å‡è®¢å•é‡‘é¢** | Â¥156 | Â¥162 | Bç‰ˆæœ¬æå‡3.8% |
| **ç”¨æˆ·åœç•™æ—¶é—´** | 2.3åˆ†é’Ÿ | 2.1åˆ†é’Ÿ | Aç‰ˆæœ¬æ›´ä¼˜ |
| **è·³å‡ºç‡** | 35% | 32% | Bç‰ˆæœ¬æ›´ä¼˜ |

**ç»Ÿè®¡æ˜¾è‘—æ€§éªŒè¯ï¼š**
```java
@Service  
public class StatisticalAnalysis {
    
    public ABTestResult analyzeResults(ABTestData dataA, ABTestData dataB) {
        // è®¡ç®—è½¬åŒ–ç‡
        double conversionRateA = dataA.getConversions() / (double) dataA.getVisitors();
        double conversionRateB = dataB.getConversions() / (double) dataB.getVisitors();
        
        // è®¡ç®—ç½®ä¿¡åº¦ï¼ˆç®€åŒ–ç‰ˆï¼‰
        double improvement = (conversionRateB - conversionRateA) / conversionRateA * 100;
        
        return ABTestResult.builder()
            .improvementPercentage(improvement)
            .isStatisticallySignificant(improvement > 5) // ç®€åŒ–åˆ¤æ–­
            .recommendation(improvement > 0 ? "é‡‡ç”¨Bç‰ˆæœ¬" : "ä¿æŒAç‰ˆæœ¬")
            .build();
    }
}
```

---

## 6. ğŸŒ«ï¸ ç°åº¦å‘å¸ƒ


### 6.1 åŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯ç°åº¦å‘å¸ƒï¼Ÿ**

> ğŸ’¡ **å½¢è±¡ç†è§£**ï¼šç°åº¦å°±æ˜¯ä»‹äºé»‘è‰²å’Œç™½è‰²ä¹‹é—´çš„è¿‡æ¸¡è‰²ã€‚ç°åº¦å‘å¸ƒå°±æ˜¯åœ¨æ–°æ—§ç‰ˆæœ¬ä¹‹é—´åˆ›é€ ä¸€ä¸ªå¹³æ»‘çš„è¿‡æ¸¡è¿‡ç¨‹

**ç°åº¦å‘å¸ƒç‰¹ç‚¹ï¼š**
- ğŸ¯ **ç²¾å‡†æ§åˆ¶**ï¼šå¯ä»¥æŒ‡å®šç‰¹å®šç”¨æˆ·ç¾¤ä½“
- ğŸ“Š **æ¸è¿›é‡Šæ”¾**ï¼šé€æ­¥æ‰©å¤§ç”¨æˆ·èŒƒå›´
- ğŸ›¡ï¸ **é£é™©å¯æ§**ï¼šå‡ºé—®é¢˜å½±å“èŒƒå›´å°
- ğŸ“ˆ **æ•°æ®é©±åŠ¨**ï¼šåŸºäºæ•°æ®å†³å®šæ˜¯å¦ç»§ç»­

### 6.2 ç°åº¦ç­–ç•¥


**å¸¸è§ç°åº¦ç»´åº¦ï¼š**

```
æŒ‰ç”¨æˆ·å±æ€§ï¼š
â€¢ åœ°ç†ä½ç½®ï¼šå…ˆåœ¨æŸä¸ªåŸå¸‚å‘å¸ƒ
â€¢ ç”¨æˆ·ç­‰çº§ï¼šVIPç”¨æˆ·ä¼˜å…ˆä½“éªŒ  
â€¢ è®¾å¤‡ç±»å‹ï¼šiOS/Androidåˆ†åˆ«å‘å¸ƒ
â€¢ ç”¨æˆ·æ ‡ç­¾ï¼šæ´»è·ƒç”¨æˆ·å…ˆä½“éªŒ

æŒ‰æµé‡æ¯”ä¾‹ï¼š
â€¢ 1% â†’ 5% â†’ 10% â†’ 25% â†’ 50% â†’ 100%
â€¢ æ¯ä¸ªé˜¶æ®µè§‚å¯Ÿ1-2å°æ—¶

æŒ‰åŠŸèƒ½æ¨¡å—ï¼š
â€¢ éæ ¸å¿ƒåŠŸèƒ½å…ˆå‘å¸ƒ
â€¢ æ ¸å¿ƒåŠŸèƒ½åå‘å¸ƒ
â€¢ åˆ†æ¨¡å—é€æ­¥å¼€æ”¾
```

**ç°åº¦è§„åˆ™é…ç½®ï¼š**

```java
@Configuration
public class GrayReleaseConfig {
    
    @Bean
    public GrayReleaseRule createGrayRules() {
        return GrayReleaseRule.builder()
            // åœ°ç†ä½ç½®è§„åˆ™
            .addRule("city", Arrays.asList("åŒ—äº¬", "ä¸Šæµ·"), 100)
            // VIPç”¨æˆ·è§„åˆ™  
            .addRule("userLevel", Arrays.asList("VIP", "SVIP"), 100)
            // æ™®é€šç”¨æˆ·æŒ‰æ¯”ä¾‹
            .addRule("normal", Collections.emptyList(), 10) // 10%æ™®é€šç”¨æˆ·
            .build();
    }
}

@Service
public class GrayReleaseService {
    
    public boolean shouldUseNewVersion(UserContext user) {
        // æ£€æŸ¥åŸå¸‚è§„åˆ™
        if (Arrays.asList("åŒ—äº¬", "ä¸Šæµ·").contains(user.getCity())) {
            return true;
        }
        
        // æ£€æŸ¥VIPè§„åˆ™
        if (Arrays.asList("VIP", "SVIP").contains(user.getLevel())) {
            return true;
        }
        
        // æ™®é€šç”¨æˆ·æŒ‰æ¯”ä¾‹
        return Math.abs(user.getUserId().hashCode()) % 100 < 10;
    }
}
```

### 6.3 åŠ¨æ€é…ç½®ç®¡ç†


**é…ç½®ä¸­å¿ƒå®ç°ï¼š**

```yaml
# Nacosé…ç½®ç¤ºä¾‹
gray:
  release:
    enabled: true
    rules:
      - name: "city-rule"
        type: "whitelist"  
        field: "city"
        values: ["åŒ—äº¬", "ä¸Šæµ·", "æ·±åœ³"]
        percentage: 100
      - name: "normal-user-rule"
        type: "percentage"
        field: "userType"
        values: ["normal"]
        percentage: 15  # å¯åŠ¨æ€è°ƒæ•´
```

```java
@RefreshScope  // æ”¯æŒé…ç½®çƒ­æ›´æ–°
@Component
public class DynamicGrayConfig {
    
    @Value("${gray.release.enabled:false}")
    private boolean grayEnabled;
    
    @Value("${gray.release.rules.normal-user-rule.percentage:0}")
    private int normalUserPercentage;
    
    // é…ç½®æ›´æ–°æ—¶è‡ªåŠ¨åˆ·æ–°
    @EventListener(RefreshEvent.class)
    public void onConfigRefresh() {
        logger.info("ç°åº¦é…ç½®å·²æ›´æ–°ï¼Œæ™®é€šç”¨æˆ·æ¯”ä¾‹: {}%", normalUserPercentage);
    }
}
```

---

## 7. â†©ï¸ å›æ»šæœºåˆ¶


### 7.1 å›æ»šè§¦å‘æ¡ä»¶


**è‡ªåŠ¨å›æ»šæ¡ä»¶ï¼š**

```
ç³»ç»ŸæŒ‡æ ‡å¼‚å¸¸ï¼š
âŒ é”™è¯¯ç‡ > 1%ï¼ˆ5åˆ†é’Ÿå†…ï¼‰
âŒ å“åº”æ—¶é—´ > 2ç§’ï¼ˆå¹³å‡å€¼ï¼‰
âŒ æˆåŠŸç‡ < 95%ï¼ˆä¸šåŠ¡æˆåŠŸç‡ï¼‰
âŒ å†…å­˜ä½¿ç”¨ç‡ > 90%

ä¸šåŠ¡æŒ‡æ ‡å¼‚å¸¸ï¼š
âŒ è®¢å•è½¬åŒ–ç‡ä¸‹é™ > 10%
âŒ æ”¯ä»˜æˆåŠŸç‡ä¸‹é™ > 5%
âŒ ç”¨æˆ·æŠ•è¯‰æ¿€å¢ï¼ˆåŒæ¯”å¢é•¿50%ï¼‰
```

**æ‰‹åŠ¨å›æ»šè§¦å‘ï¼š**
- ğŸš¨ **ç´§æ€¥æƒ…å†µ**ï¼šå‘ç°ä¸¥é‡bug
- ğŸ“Š **æ•°æ®å¼‚å¸¸**ï¼šå…³é”®ä¸šåŠ¡æ•°æ®é”™è¯¯  
- ğŸ‘¥ **ç”¨æˆ·åé¦ˆ**ï¼šå¤§é‡ç”¨æˆ·æŠ•è¯‰
- ğŸ” **å®‰å…¨é—®é¢˜**ï¼šå‘ç°å®‰å…¨æ¼æ´

### 7.2 å¿«é€Ÿå›æ»šå®ç°


**Kuberneteså›æ»šï¼š**

```bash
# æŸ¥çœ‹å‘å¸ƒå†å²
kubectl rollout history deployment/user-service

# å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬
kubectl rollout undo deployment/user-service

# å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬  
kubectl rollout undo deployment/user-service --to-revision=3

# æ£€æŸ¥å›æ»šçŠ¶æ€
kubectl rollout status deployment/user-service
```

**Spring Bootåº”ç”¨å›æ»šï¼š**

```java
@RestController
public class DeploymentController {
    
    @Autowired
    private DeploymentService deploymentService;
    
    @PostMapping("/rollback")
    public ResponseEntity<String> rollback(@RequestParam String version) {
        try {
            // æ£€æŸ¥ç›®æ ‡ç‰ˆæœ¬æ˜¯å¦å­˜åœ¨
            if (!deploymentService.versionExists(version)) {
                return ResponseEntity.badRequest().body("ç‰ˆæœ¬ä¸å­˜åœ¨: " + version);
            }
            
            // æ‰§è¡Œå›æ»š
            deploymentService.rollbackTo(version);
            
            // éªŒè¯å›æ»šç»“æœ
            if (deploymentService.getCurrentVersion().equals(version)) {
                return ResponseEntity.ok("å›æ»šæˆåŠŸï¼Œå½“å‰ç‰ˆæœ¬: " + version);
            } else {
                return ResponseEntity.status(500).body("å›æ»šå¤±è´¥");
            }
            
        } catch (Exception e) {
            return ResponseEntity.status(500).body("å›æ»šå¼‚å¸¸: " + e.getMessage());
        }
    }
}
```

### 7.3 æ•°æ®å›æ»šç­–ç•¥


**æ•°æ®åº“ç‰ˆæœ¬ç®¡ç†ï¼š**

> âš ï¸ **é‡è¦æé†’**ï¼šæ•°æ®å›æ»šæ¯”åº”ç”¨å›æ»šå¤æ‚å¾—å¤šï¼Œéœ€è¦ç‰¹åˆ«è°¨æ…

```
æ•°æ®å›æ»šç­–ç•¥ï¼š

å‘å‰å…¼å®¹è®¾è®¡ï¼š
âœ… æ–°å­—æ®µè®¾ç½®é»˜è®¤å€¼
âœ… ä¸åˆ é™¤æ—§å­—æ®µï¼Œæ ‡è®°ä¸ºåºŸå¼ƒ  
âœ… æ•°æ®è¿ç§»è„šæœ¬å¯é€†

æ•°æ®å¤‡ä»½ï¼š
âœ… å‘å¸ƒå‰è‡ªåŠ¨å¤‡ä»½
âœ… å…³é”®è¡¨å®æ—¶å¤‡ä»½
âœ… å¤‡ä»½éªŒè¯æœºåˆ¶

å›æ»šéªŒè¯ï¼š
âœ… æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥
âœ… ä¸šåŠ¡åŠŸèƒ½éªŒè¯
âœ… æ€§èƒ½æŒ‡æ ‡ç¡®è®¤
```

---

## 8. ğŸ”€ æµé‡åˆ‡æ¢


### 8.1 æµé‡åˆ‡æ¢æ–¹å¼


**è´Ÿè½½å‡è¡¡å™¨åˆ‡æ¢ï¼š**

```
Nginxé…ç½®ç¤ºä¾‹ï¼š

upstream backend_blue {
    server 192.168.1.10:8080;
    server 192.168.1.11:8080;
}

upstream backend_green {
    server 192.168.1.12:8080;
    server 192.168.1.13:8080;
}

server {
    listen 80;
    location / {
        proxy_pass http://backend_blue;  # å½“å‰æŒ‡å‘è“ç¯å¢ƒ
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}

# åˆ‡æ¢æ—¶åªéœ€è¦ä¿®æ”¹ï¼šproxy_pass http://backend_green;
```

**APIç½‘å…³åˆ‡æ¢ï¼š**

```java
@Component
public class DynamicRouting {
    
    @Value("${service.active.version:v1}")
    private String activeVersion;
    
    @Bean
    public RouteLocator customRouteLocator(RouteLocatorBuilder builder) {
        return builder.routes()
            .route("user-service", r -> r.path("/api/users/**")
                .uri("http://user-service-" + activeVersion + ":8080"))
            .build();
    }
    
    // æ”¯æŒåŠ¨æ€åˆ‡æ¢
    public void switchToVersion(String version) {
        this.activeVersion = version;
        // è§¦å‘è·¯ç”±è§„åˆ™åˆ·æ–°
        refreshRoutes();
    }
}
```

### 8.2 DNSåˆ‡æ¢


**DNSåˆ‡æ¢ä¼˜ç¼ºç‚¹ï¼š**

| ç‰¹ç‚¹ | ä¼˜åŠ¿ âœ… | åŠ£åŠ¿ âŒ |
|------|---------|---------|
| **åˆ‡æ¢æˆæœ¬** | ä¿®æ”¹ç®€å•ï¼Œåªæ”¹DNSè®°å½• | DNSç¼“å­˜å¯¼è‡´åˆ‡æ¢å»¶è¿Ÿ |
| **å½±å“èŒƒå›´** | å…¨å±€åˆ‡æ¢ï¼Œå½±å“æ‰€æœ‰ç”¨æˆ· | æ— æ³•ç²¾ç¡®æ§åˆ¶æµé‡æ¯”ä¾‹ |
| **å›æ»šé€Ÿåº¦** | é…ç½®ç®€å•ï¼Œä¸€é”®åˆ‡æ¢ | TTLæ—¶é—´å½±å“ç”Ÿæ•ˆé€Ÿåº¦ |

```bash
# DNSåˆ‡æ¢ç¤ºä¾‹
# åŸå§‹é…ç½®
api.company.com.  300  IN  A  192.168.1.10  # è“ç¯å¢ƒ

# åˆ‡æ¢åé…ç½®  
api.company.com.  300  IN  A  192.168.1.20  # ç»¿ç¯å¢ƒ

# TTL=300ç§’ï¼Œæœ€å¤š5åˆ†é’Ÿå…¨éƒ¨ç”Ÿæ•ˆ
```

### 8.3 æµé‡åˆ‡æ¢ç›‘æ§


**å…³é”®ç›‘æ§æŒ‡æ ‡ï¼š**

```java
@Service
public class TrafficSwitchMonitor {
    
    @Scheduled(fixedDelay = 30000) // æ¯30ç§’æ£€æŸ¥
    public void monitorTrafficSwitch() {
        
        // æ£€æŸ¥æ–°ç‰ˆæœ¬å¥åº·çŠ¶æ€
        HealthStatus newVersionHealth = healthChecker.check("new-version");
        
        if (newVersionHealth.isHealthy()) {
            // æ£€æŸ¥ä¸šåŠ¡æŒ‡æ ‡
            BusinessMetrics metrics = metricsCollector.collect();
            
            if (metrics.getErrorRate() < 0.01 && 
                metrics.getResponseTime() < 200) {
                
                logger.info("æ–°ç‰ˆæœ¬è¿è¡Œæ­£å¸¸ï¼Œç»§ç»­è§‚å¯Ÿ");
            } else {
                logger.warn("æ–°ç‰ˆæœ¬æŒ‡æ ‡å¼‚å¸¸ï¼Œå‡†å¤‡å›æ»š");
                alertService.sendAlert("ç‰ˆæœ¬å¼‚å¸¸", metrics);
            }
        } else {
            logger.error("æ–°ç‰ˆæœ¬å¥åº·æ£€æŸ¥å¤±è´¥ï¼Œç«‹å³å›æ»š");
            rollbackService.executeRollback();
        }
    }
}
```

---

## 9. ğŸ“Š å‘å¸ƒç›‘æ§


### 9.1 ç›‘æ§ä½“ç³»æ¶æ„


```
ç›‘æ§ä½“ç³»æ¶æ„ï¼š

åº”ç”¨å±‚ç›‘æ§ â†’ ä¸šåŠ¡æŒ‡æ ‡æ”¶é›† â†’ æ•°æ®å­˜å‚¨ â†’ å‘Šè­¦åˆ†æ
    â†“              â†“             â†“         â†“
ç³»ç»Ÿå±‚ç›‘æ§ â†’ ç³»ç»ŸæŒ‡æ ‡æ”¶é›† â†’ æ—¶åºæ•°æ®åº“ â†’ ä»ªè¡¨æ¿å±•ç¤º
    â†“              â†“             â†“         â†“  
åŸºç¡€è®¾æ–½ç›‘æ§ â†’ èµ„æºæŒ‡æ ‡æ”¶é›† â†’ ç›‘æ§å¹³å° â†’ è‡ªåŠ¨åŒ–å¤„ç†
```

### 9.2 æ ¸å¿ƒç›‘æ§æŒ‡æ ‡


**åº”ç”¨æ€§èƒ½æŒ‡æ ‡ï¼š**

```java
@Component
public class ApplicationMetrics {
    
    private final MeterRegistry meterRegistry;
    
    @EventListener
    public void handleRequest(HttpRequestEvent event) {
        // å“åº”æ—¶é—´ç›‘æ§
        Timer.Sample sample = Timer.start(meterRegistry);
        sample.stop(Timer.builder("http.request.duration")
            .tag("method", event.getMethod())
            .tag("status", String.valueOf(event.getStatus()))
            .register(meterRegistry));
        
        // é”™è¯¯ç‡ç›‘æ§
        if (event.getStatus() >= 400) {
            meterRegistry.counter("http.request.errors",
                "method", event.getMethod(),
                "status", String.valueOf(event.getStatus()))
                .increment();
        }
    }
}
```

**ä¸šåŠ¡æŒ‡æ ‡ç›‘æ§ï¼š**

| æŒ‡æ ‡åˆ†ç±» | ç›‘æ§æŒ‡æ ‡ | æ­£å¸¸é˜ˆå€¼ | å‘Šè­¦çº§åˆ« |
|----------|----------|----------|----------|
| **ç”¨æˆ·è¡Œä¸º** | æ´»è·ƒç”¨æˆ·æ•°ã€é¡µé¢æµè§ˆé‡ | åŒæ¯”Â±10% | ğŸŸ¡ä¸­çº§ |
| **ä¸šåŠ¡è½¬åŒ–** | æ³¨å†Œç‡ã€è®¢å•è½¬åŒ–ç‡ | åŒæ¯”Â±5% | ğŸ”´é«˜çº§ |
| **ç³»ç»Ÿæ€§èƒ½** | å“åº”æ—¶é—´ã€ååé‡ | <200ms, >1000TPS | ğŸ”´é«˜çº§ |
| **é”™è¯¯ç›‘æ§** | é”™è¯¯ç‡ã€å¼‚å¸¸æ•°é‡ | <0.1%, <10ä¸ª/åˆ†é’Ÿ | ğŸš¨ç´§æ€¥ |

### 9.3 å®æ—¶å‘Šè­¦é…ç½®


**Prometheuså‘Šè­¦è§„åˆ™ï¼š**

```yaml
# prometheus-alerts.yml
groups:
  - name: microservice-deployment
    rules:
      - alert: HighErrorRate
        expr: rate(http_requests_total{status=~"5.."}[5m]) > 0.01
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "æœåŠ¡é”™è¯¯ç‡è¿‡é«˜"
          description: "{{ $labels.service }} é”™è¯¯ç‡ä¸º {{ $value }}ï¼Œè¶…è¿‡1%"
          
      - alert: SlowResponse  
        expr: histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m])) > 0.2
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "å“åº”æ—¶é—´è¿‡æ…¢"
          description: "95%è¯·æ±‚å“åº”æ—¶é—´è¶…è¿‡200ms"
```

**å‘Šè­¦é€šçŸ¥é…ç½®ï¼š**

```java
@Service
public class AlertService {
    
    public void sendDeploymentAlert(AlertLevel level, String message) {
        AlertMessage alert = AlertMessage.builder()
            .level(level)
            .title("å¾®æœåŠ¡å‘å¸ƒå‘Šè­¦")
            .content(message)
            .timestamp(Instant.now())
            .build();
            
        switch (level) {
            case CRITICAL:
                // çŸ­ä¿¡ + ç”µè¯ + å¾®ä¿¡ç¾¤
                smsService.send(alert);
                phoneService.call(alert);
                wechatService.sendToGroup(alert);
                break;
            case WARNING:
                // å¾®ä¿¡ç¾¤ + é‚®ä»¶
                wechatService.sendToGroup(alert);
                emailService.send(alert);
                break;
            default:
                // ä»…è®°å½•æ—¥å¿—
                logger.info("å‘Šè­¦ä¿¡æ¯: {}", alert);
        }
    }
}
```

### 9.4 å‘å¸ƒå¤§ç›˜å±•ç¤º


**å…³é”®æŒ‡æ ‡å¤§ç›˜ï¼š**

```
å‘å¸ƒç›‘æ§å¤§ç›˜å¸ƒå±€ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‘å¸ƒè¿›åº¦      â”‚   å®æ—¶QPS       â”‚   é”™è¯¯ç‡è¶‹åŠ¿    â”‚
â”‚   â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 60%  â”‚   1,234 req/s   â”‚   0.05% â†“       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å“åº”æ—¶é—´åˆ†å¸ƒ  â”‚   èµ„æºä½¿ç”¨æƒ…å†µ  â”‚   ä¸šåŠ¡æŒ‡æ ‡å¯¹æ¯”  â”‚
â”‚   P95: 150ms    â”‚   CPU: 45%      â”‚   è½¬åŒ–ç‡: +2.3% â”‚
â”‚   P99: 280ms    â”‚   MEM: 60%      â”‚   æ”¶å…¥: +5.1%   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 10. ğŸ¯ ç­–ç•¥é€‰æ‹©æŒ‡å—


### 10.1 é€‰æ‹©å†³ç­–æ ‘


```
å‘å¸ƒç­–ç•¥é€‰æ‹©æµç¨‹ï¼š

ä¸šåŠ¡é‡è¦æ€§ï¼Ÿ
    â”œâ”€â”€ æ ¸å¿ƒä¸šåŠ¡ â†’ èµ„æºå……è¶³ï¼Ÿ
    â”‚              â”œâ”€â”€ æ˜¯ â†’ è“ç»¿éƒ¨ç½²
    â”‚              â””â”€â”€ å¦ â†’ é‡‘ä¸é›€å‘å¸ƒ
    â””â”€â”€ ä¸€èˆ¬ä¸šåŠ¡ â†’ å‘å¸ƒé¢‘ç‡ï¼Ÿ
                   â”œâ”€â”€ é«˜é¢‘ â†’ æ»šåŠ¨æ›´æ–°
                   â””â”€â”€ ä½é¢‘ â†’ ç°åº¦å‘å¸ƒ
```

### 10.2 ç­–ç•¥å¯¹æ¯”è¡¨


| ç­–ç•¥ | ğŸ¯é€‚ç”¨åœºæ™¯ | â­éš¾åº¦ | ğŸ’°æˆæœ¬ | âš¡é€Ÿåº¦ | ğŸ›¡ï¸å®‰å…¨æ€§ |
|------|------------|--------|--------|--------|----------|
| **è“ç»¿éƒ¨ç½²** | æ ¸å¿ƒä¸šåŠ¡ï¼Œé›¶åœæœºè¦æ±‚ | â­â­ | ğŸ’°ğŸ’°ğŸ’° | âš¡âš¡âš¡ | ğŸ›¡ï¸ğŸ›¡ï¸ğŸ›¡ï¸ |
| **é‡‘ä¸é›€å‘å¸ƒ** | ç¨³å®šæ€§è¦æ±‚é«˜ | â­â­â­ | ğŸ’°ğŸ’° | âš¡âš¡ | ğŸ›¡ï¸ğŸ›¡ï¸ğŸ›¡ï¸ |
| **æ»šåŠ¨æ›´æ–°** | æ ‡å‡†å‘å¸ƒæµç¨‹ | â­ | ğŸ’° | âš¡âš¡ | ğŸ›¡ï¸ğŸ›¡ï¸ |
| **A/Bæµ‹è¯•** | åŠŸèƒ½æ•ˆæœå¯¹æ¯” | â­â­â­ | ğŸ’°ğŸ’° | âš¡ | ğŸ›¡ï¸ğŸ›¡ï¸ |
| **ç°åº¦å‘å¸ƒ** | ç”¨æˆ·åˆ†ç¾¤æµ‹è¯• | â­â­ | ğŸ’°ğŸ’° | âš¡ | ğŸ›¡ï¸ğŸ›¡ï¸ |

### 10.3 ç»„åˆç­–ç•¥


**å®é™…é¡¹ç›®ä¸­çš„ç»„åˆä½¿ç”¨ï¼š**

```
å¤§å‹ç”µå•†å¹³å°å‘å¸ƒç­–ç•¥ç»„åˆï¼š

ç¬¬ä¸€é˜¶æ®µï¼šç°åº¦å‘å¸ƒï¼ˆå†…éƒ¨ç”¨æˆ·ï¼‰
â€¢ ç›®æ ‡ï¼šå†…éƒ¨å‘˜å·¥å…ˆä½“éªŒ
â€¢ èŒƒå›´ï¼š1%å†…éƒ¨ç”¨æˆ·  
â€¢ æ—¶é—´ï¼š2å°æ—¶è§‚å¯ŸæœŸ

ç¬¬äºŒé˜¶æ®µï¼šé‡‘ä¸é›€å‘å¸ƒï¼ˆå¤–éƒ¨ç”¨æˆ·ï¼‰
â€¢ ç›®æ ‡ï¼šå°èŒƒå›´å¤–éƒ¨ç”¨æˆ·éªŒè¯
â€¢ èŒƒå›´ï¼š5%å¤–éƒ¨ç”¨æˆ·
â€¢ æ—¶é—´ï¼š4å°æ—¶è§‚å¯ŸæœŸ  

ç¬¬ä¸‰é˜¶æ®µï¼šA/Bæµ‹è¯•ï¼ˆåŠŸèƒ½å¯¹æ¯”ï¼‰
â€¢ ç›®æ ‡ï¼šå¯¹æ¯”æ–°æ—§åŠŸèƒ½æ•ˆæœ
â€¢ èŒƒå›´ï¼š50% vs 50%ç”¨æˆ·
â€¢ æ—¶é—´ï¼š1å‘¨æ•°æ®æ”¶é›†

ç¬¬å››é˜¶æ®µï¼šè“ç»¿éƒ¨ç½²ï¼ˆå…¨é‡å‘å¸ƒï¼‰  
â€¢ ç›®æ ‡ï¼šå¿«é€Ÿå…¨é‡åˆ‡æ¢
â€¢ èŒƒå›´ï¼š100%ç”¨æˆ·
â€¢ æ—¶é—´ï¼šç¬æ—¶åˆ‡æ¢
```

---

## 11. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 11.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


> ğŸ¯ **å‘å¸ƒç­–ç•¥çš„æœ¬è´¨**ï¼šåœ¨ä¿è¯æœåŠ¡ç¨³å®šçš„å‰æä¸‹ï¼Œå®‰å…¨åœ°å°†æ–°ç‰ˆæœ¬æ¨é€ç»™ç”¨æˆ·

**å…³é”®ç†è§£ç‚¹ï¼š**
- âœ… **è“ç»¿éƒ¨ç½²**ï¼šä¸¤å¥—ç¯å¢ƒï¼Œç¬æ—¶åˆ‡æ¢ï¼Œé€‚åˆé‡è¦ä¸šåŠ¡
- âœ… **é‡‘ä¸é›€å‘å¸ƒ**ï¼šå°æµé‡å…ˆè¯•ï¼Œé€æ­¥æ‰©å¤§ï¼Œé£é™©å¯æ§  
- âœ… **æ»šåŠ¨æ›´æ–°**ï¼šæ‰¹æ¬¡æ›¿æ¢ï¼ŒæœåŠ¡è¿ç»­ï¼Œæœ€å¸¸ç”¨ç­–ç•¥
- âœ… **A/Bæµ‹è¯•**ï¼šæ•ˆæœå¯¹æ¯”ï¼Œæ•°æ®å†³ç­–ï¼Œä¸šåŠ¡ä¼˜åŒ–å¯¼å‘
- âœ… **ç°åº¦å‘å¸ƒ**ï¼šç²¾å‡†æ§åˆ¶ï¼Œç”¨æˆ·åˆ†ç¾¤ï¼Œæ¸è¿›å‘å¸ƒ

### 11.2 å®é™…åº”ç”¨å»ºè®®


**æ–°æ‰‹å…¥é—¨å»ºè®®ï¼š**

â‘  **ä»æ»šåŠ¨æ›´æ–°å¼€å§‹**
```
ä¸ºä»€ä¹ˆï¼Ÿ
â€¢ å®ç°ç®€å•ï¼ŒKubernetesåŸç”Ÿæ”¯æŒ
â€¢ é£é™©ä¸­ç­‰ï¼Œå‡ºé—®é¢˜å½±å“æ¸è¿›  
â€¢ æˆæœ¬è¾ƒä½ï¼Œä¸éœ€è¦é¢å¤–èµ„æº
â€¢ å›æ»šæ–¹ä¾¿ï¼Œä¸€æ¡å‘½ä»¤æå®š
```

â‘¡ **é€æ­¥å¼•å…¥é‡‘ä¸é›€å‘å¸ƒ**
```
é€‚åˆåœºæ™¯ï¼š
â€¢ å›¢é˜Ÿæœ‰ä¸€å®šDevOpsç»éªŒ
â€¢ ä¸šåŠ¡å¯¹ç¨³å®šæ€§è¦æ±‚è¾ƒé«˜
â€¢ æœ‰å®Œå–„çš„ç›‘æ§ä½“ç³»
â€¢ èƒ½å¤Ÿæ‰¿æ‹…é¢å¤–çš„å¤æ‚åº¦
```

â‘¢ **é‡è¦ä¸šåŠ¡è€ƒè™‘è“ç»¿éƒ¨ç½²**
```  
ä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ
â€¢ æ”¯ä»˜ã€è®¢å•ç­‰æ ¸å¿ƒä¸šåŠ¡
â€¢ ç”¨æˆ·ä½“éªŒè¦æ±‚æé«˜
â€¢ æœ‰è¶³å¤Ÿçš„èµ„æºé¢„ç®—
â€¢ å›¢é˜ŸæŠ€æœ¯å®åŠ›è¾ƒå¼º
```

### 11.3 é¿å…å¸¸è§è¯¯åŒº


**âŒ è¯¯åŒº1ï¼šè®¤ä¸ºè¶Šå¤æ‚çš„ç­–ç•¥è¶Šå¥½**
> ğŸ’¡ **æ­£ç¡®ç†è§£**ï¼šé€‚åˆçš„æ‰æ˜¯æœ€å¥½çš„ï¼Œè¦æ ¹æ®å›¢é˜Ÿå®é™…æƒ…å†µé€‰æ‹©

**âŒ è¯¯åŒº2ï¼šåªå…³æ³¨å‘å¸ƒè¿‡ç¨‹ï¼Œå¿½è§†ç›‘æ§**
> ğŸ’¡ **æ­£ç¡®ç†è§£**ï¼šç›‘æ§æ˜¯å‘å¸ƒç­–ç•¥çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œç¼ºä¸€ä¸å¯

**âŒ è¯¯åŒº3ï¼šæ•°æ®åº“å’Œåº”ç”¨ä½¿ç”¨ç›¸åŒç­–ç•¥**
> ğŸ’¡ **æ­£ç¡®ç†è§£**ï¼šæ•°æ®åº“å˜æ›´æ›´å¤æ‚ï¼Œéœ€è¦ç‰¹æ®Šè€ƒè™‘

**âŒ è¯¯åŒº4ï¼šå‘å¸ƒç­–ç•¥ä¸€æˆä¸å˜**
> ğŸ’¡ **æ­£ç¡®ç†è§£**ï¼šè¦æ ¹æ®ä¸šåŠ¡å‘å±•é˜¶æ®µè°ƒæ•´å‘å¸ƒç­–ç•¥

### 11.4 æˆåŠŸå®æ–½å…³é”®å› ç´ 


**ğŸ”‘ å…³é”®æˆåŠŸå› ç´ ï¼š**

1. **å®Œå–„çš„ç›‘æ§ä½“ç³»**
   - åº”ç”¨æ€§èƒ½ç›‘æ§
   - ä¸šåŠ¡æŒ‡æ ‡ç›‘æ§  
   - åŸºç¡€è®¾æ–½ç›‘æ§
   - å®æ—¶å‘Šè­¦æœºåˆ¶

2. **è‡ªåŠ¨åŒ–ç¨‹åº¦**
   - è‡ªåŠ¨åŒ–éƒ¨ç½²æµæ°´çº¿
   - è‡ªåŠ¨åŒ–æµ‹è¯•éªŒè¯
   - è‡ªåŠ¨åŒ–å›æ»šæœºåˆ¶
   - è‡ªåŠ¨åŒ–ç›‘æ§å‘Šè­¦

3. **å›¢é˜Ÿåä½œ**
   - å¼€å‘å›¢é˜Ÿç†è§£å‘å¸ƒç­–ç•¥
   - è¿ç»´å›¢é˜ŸæŒæ¡æ“ä½œæŠ€èƒ½
   - ä¸šåŠ¡å›¢é˜Ÿå‚ä¸æŒ‡æ ‡å®šä¹‰
   - ç®¡ç†å±‚æ”¯æŒèµ„æºæŠ•å…¥

4. **æ¸è¿›æ”¹è¿›**
   - ä»ç®€å•ç­–ç•¥å¼€å§‹
   - ç§¯ç´¯ç»éªŒåå‡çº§
   - æŒç»­ä¼˜åŒ–æ”¹è¿›
   - å®šæœŸå›é¡¾æ€»ç»“

> ğŸŒŸ **è®°ä½**ï¼šå‘å¸ƒç­–ç•¥ä¸æ˜¯ä¸€æ¬¡æ€§çš„æŠ€æœ¯é€‰æ‹©ï¼Œè€Œæ˜¯éœ€è¦æŒç»­æ¼”è¿›çš„å·¥ç¨‹å®è·µï¼

**æ ¸å¿ƒè®°å¿†å£è¯€ï¼š**
```
è“ç»¿ç¬æ—¶åˆ‡ï¼Œé‡‘ä¸é›€æ¸è¿›
æ»šåŠ¨æ‰¹æ¬¡æ¢ï¼ŒA/Bæ•ˆæœæ¯”  
ç°åº¦ç”¨æˆ·åˆ†ï¼Œå›æ»šä¿å¹³å®‰
ç›‘æ§æ˜¯å…³é”®ï¼Œç­–ç•¥é€‰é€‚åˆ
```