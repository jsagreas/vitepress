---
title: 6ã€å®‰å…¨æ€§è®¾è®¡
---
## ğŸ“š ç›®å½•

1. [å¾®æœåŠ¡å®‰å…¨æŒ‘æˆ˜æ¦‚è¿°](#1-å¾®æœåŠ¡å®‰å…¨æŒ‘æˆ˜æ¦‚è¿°)
2. [è®¤è¯æœºåˆ¶è®¾è®¡](#2-è®¤è¯æœºåˆ¶è®¾è®¡)
3. [æˆæƒæ§åˆ¶ç­–ç•¥](#3-æˆæƒæ§åˆ¶ç­–ç•¥)
4. [æ•°æ®åŠ å¯†ä¿æŠ¤](#4-æ•°æ®åŠ å¯†ä¿æŠ¤)
5. [APIå®‰å…¨é˜²æŠ¤](#5-APIå®‰å…¨é˜²æŠ¤)
6. [é›¶ä¿¡ä»»æ¶æ„](#6-é›¶ä¿¡ä»»æ¶æ„)
7. [å®‰å…¨å®¡è®¡ä¸ç›‘æ§](#7-å®‰å…¨å®¡è®¡ä¸ç›‘æ§)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”’ å¾®æœåŠ¡å®‰å…¨æŒ‘æˆ˜æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯å¾®æœåŠ¡å®‰å…¨é—®é¢˜


**ç®€å•ç†è§£**ï¼šæƒ³è±¡ä¸€ä¸ªå¤ä»£åŸæ± ï¼Œå•ä½“åº”ç”¨å°±åƒä¸€åº§åŸå ¡ï¼Œåªéœ€è¦å®ˆå¥½åŸé—¨å°±è¡Œã€‚è€Œå¾®æœåŠ¡å°±åƒä¸€ä¸ªåŸå¸‚ï¼Œæœ‰å¾ˆå¤šå°æˆ¿å­ï¼Œæ¯ä¸ªæˆ¿å­éƒ½éœ€è¦å•ç‹¬ä¿æŠ¤ã€‚

```
ä¼ ç»Ÿå•ä½“åº”ç”¨å®‰å…¨ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ä¸€ä¸ªå¤§åº”ç”¨            â”‚  â† åªéœ€è¦ä¿æŠ¤è¿™ä¸€ä¸ªå…¥å£
â”‚  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚æ¨¡å—Aâ”‚æ¨¡å—Bâ”‚æ¨¡å—Câ”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¾®æœåŠ¡æ¶æ„å®‰å…¨ï¼š
ç”¨æˆ·A â”€â”€â†’ è®¤è¯æœåŠ¡ â”€â”€â†’ è®¢å•æœåŠ¡ â”€â”€â†’ åº“å­˜æœåŠ¡
ç”¨æˆ·B â”€â”€â†’ ç½‘å…³     â”€â”€â†’ ç”¨æˆ·æœåŠ¡ â”€â”€â†’ æ”¯ä»˜æœåŠ¡
ç”¨æˆ·C â”€â”€â†’ è´Ÿè½½å‡è¡¡  â”€â”€â†’ é€šçŸ¥æœåŠ¡ â”€â”€â†’ æ—¥å¿—æœåŠ¡
        â†‘æ¯ä¸ªç¯èŠ‚éƒ½éœ€è¦å®‰å…¨ä¿æŠ¤
```

### 1.2 å¾®æœåŠ¡å®‰å…¨çš„æ ¸å¿ƒæŒ‘æˆ˜


**æŒ‘æˆ˜1ï¼šæ”»å‡»é¢å¢å¤§**
- **é—®é¢˜**ï¼šä»¥å‰åªæœ‰1ä¸ªå…¥å£ï¼Œç°åœ¨æœ‰Nä¸ªæœåŠ¡
- **é£é™©**ï¼šé»‘å®¢æœ‰æ›´å¤šæ”»å‡»ç‚¹å¯ä»¥é€‰æ‹©
- **æ¯”å–»**ï¼šä»¥å‰å®ˆä¸€ä¸ªé—¨ï¼Œç°åœ¨è¦å®ˆå¾ˆå¤šé—¨

**æŒ‘æˆ˜2ï¼šæœåŠ¡é—´é€šä¿¡å®‰å…¨**
- **é—®é¢˜**ï¼šæœåŠ¡Aè°ƒç”¨æœåŠ¡Bï¼Œå¦‚ä½•ç¡®ä¿å®‰å…¨ï¼Ÿ
- **é£é™©**ï¼šå†…éƒ¨ç½‘ç»œè¢«å…¥ä¾µåï¼ŒæœåŠ¡é—´é€šä¿¡æš´éœ²
- **æ¯”å–»**ï¼šåŸå¸‚é‡Œæˆ¿å­ä¹‹é—´çš„å¯¹è¯å¯èƒ½è¢«å·å¬

**æŒ‘æˆ˜3ï¼šèº«ä»½è¯†åˆ«å¤æ‚**
- **é—®é¢˜**ï¼šç”¨æˆ·èº«ä»½è¦åœ¨å¤šä¸ªæœåŠ¡é—´ä¼ é€’
- **é£é™©**ï¼šèº«ä»½ä¿¡æ¯å¯èƒ½è¢«ç¯¡æ”¹æˆ–ä¼ªé€ 
- **æ¯”å–»**ï¼šä¸€ä¸ªäººåœ¨åŸå¸‚é‡Œèµ°åŠ¨ï¼Œæ¯ä¸ªåœ°æ–¹éƒ½è¦éªŒè¯èº«ä»½

### 1.3 å®‰å…¨è®¾è®¡çš„åŸºæœ¬åŸåˆ™


**åŸåˆ™1ï¼šæ·±åº¦é˜²å¾¡** - å¤šå±‚ä¿æŠ¤
```
å¤–å±‚é˜²æŠ¤ï¼šç½‘å…³ + è´Ÿè½½å‡è¡¡
ä¸­å±‚é˜²æŠ¤ï¼šè®¤è¯ + æˆæƒ
å†…å±‚é˜²æŠ¤ï¼šåŠ å¯† + å®¡è®¡
æ ¸å¿ƒé˜²æŠ¤ï¼šæ•æ„Ÿæ•°æ®ä¿æŠ¤
```

**åŸåˆ™2ï¼šæœ€å°æƒé™** - ç»™æœ€å°‘çš„æƒé™
```
ç”¨æˆ·æƒé™ï¼šåªèƒ½è®¿é—®éœ€è¦çš„åŠŸèƒ½
æœåŠ¡æƒé™ï¼šåªèƒ½è°ƒç”¨å¿…è¦çš„å…¶ä»–æœåŠ¡  
æ•°æ®æƒé™ï¼šåªèƒ½è¯»å†™ç›¸å…³çš„æ•°æ®
```

**åŸåˆ™3ï¼šé›¶ä¿¡ä»»** - ä¸ä¿¡ä»»ä»»ä½•äºº
```
å¤–éƒ¨ç”¨æˆ·ï¼šä¸ä¿¡ä»»ï¼Œä¸¥æ ¼éªŒè¯
å†…éƒ¨æœåŠ¡ï¼šä¸ä¿¡ä»»ï¼Œä¹Ÿè¦éªŒè¯
ç½‘ç»œç¯å¢ƒï¼šä¸ä¿¡ä»»ï¼ŒåŠ å¯†é€šä¿¡
```

---

## 2. ğŸ” è®¤è¯æœºåˆ¶è®¾è®¡


### 2.1 ä»€ä¹ˆæ˜¯è®¤è¯


**é€šä¿—ç†è§£**ï¼šè®¤è¯å°±æ˜¯"ä½ æ˜¯è°"çš„é—®é¢˜ï¼Œå°±åƒè¿›å°åŒºè¦åˆ·é—¨ç¦å¡ä¸€æ ·ã€‚

```
ç”Ÿæ´»ä¸­çš„è®¤è¯ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ èº«ä»½è¯   â”‚    â”‚ é“¶è¡Œå¡   â”‚    â”‚ å·¥ä½œè¯   â”‚
â”‚éªŒè¯èº«ä»½  â”‚    â”‚éªŒè¯è´¦æˆ·  â”‚    â”‚éªŒè¯å‘˜å·¥  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¾®æœåŠ¡ä¸­çš„è®¤è¯ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ç”¨æˆ·åå¯†ç â”‚    â”‚  Token  â”‚    â”‚  è¯ä¹¦   â”‚
â”‚éªŒè¯ç”¨æˆ·  â”‚    â”‚éªŒè¯ä¼šè¯  â”‚    â”‚éªŒè¯æœåŠ¡  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 JWT Tokenè®¤è¯


**JWTæ˜¯ä»€ä¹ˆ**ï¼šJSON Web Tokenï¼Œä¸€ç§æ•°å­—èº«ä»½è¯

**JWTçš„ç»“æ„**ï¼š
```
JWT = Header.Payload.Signature
     å¤´éƒ¨   è½½è·    ç­¾å

å°±åƒèº«ä»½è¯ = è¯ä»¶å¤´éƒ¨.ä¸ªäººä¿¡æ¯.é˜²ä¼ªç­¾å
```

**JWTè®¤è¯æµç¨‹**ï¼š
```
ç”¨æˆ·                 è®¤è¯æœåŠ¡              ä¸šåŠ¡æœåŠ¡
 |                      |                    |
 |--[1]ç™»å½•è¯·æ±‚--------->|                    |
 |   (ç”¨æˆ·å+å¯†ç )        |                    |
 |                      |--éªŒè¯ç”¨æˆ·ä¿¡æ¯        |
 |<-[2]è¿”å›JWT Token-----|                    |
 |                      |                    |
 |--[3]æºå¸¦Tokenè¯·æ±‚-------------------->|
 |                      |                    |
 |                      |                    |--éªŒè¯Token
 |<-[4]è¿”å›ä¸šåŠ¡æ•°æ®<----------------------|
```

**JWTçš„ä¼˜åŠ¿**ï¼š
- âœ… **æ— çŠ¶æ€**ï¼šæœåŠ¡å™¨ä¸éœ€è¦å­˜å‚¨ä¼šè¯ä¿¡æ¯
- âœ… **è·¨æœåŠ¡**ï¼šä¸€ä¸ªTokenå¯ä»¥åœ¨å¤šä¸ªæœåŠ¡é—´ä½¿ç”¨
- âœ… **åŒ…å«ä¿¡æ¯**ï¼šTokené‡Œå¯ä»¥æºå¸¦ç”¨æˆ·ä¿¡æ¯

### 2.3 OAuth 2.0ç»Ÿä¸€è®¤è¯


**OAuth 2.0æ˜¯ä»€ä¹ˆ**ï¼šä¸€ç§æˆæƒæ¡†æ¶ï¼Œè®©ç”¨æˆ·å¯ä»¥æˆæƒç¬¬ä¸‰æ–¹åº”ç”¨è®¿é—®èµ„æº

**ç”Ÿæ´»ä¸­çš„ä¾‹å­**ï¼š
```
ä½ æƒ³ç”¨å¾®ä¿¡ç™»å½•æŸä¸ªè´­ç‰©ç½‘ç«™ï¼š
1. è´­ç‰©ç½‘ç«™è¯´ï¼š"æˆ‘éœ€è¦ä½ çš„å¾®ä¿¡ä¿¡æ¯"
2. å¾®ä¿¡é—®ä½ ï¼š"å…è®¸è´­ç‰©ç½‘ç«™è·å–ä½ çš„æ˜µç§°å’Œå¤´åƒå—ï¼Ÿ"
3. ä½ ç‚¹å‡»"å…è®¸"
4. å¾®ä¿¡ç»™è´­ç‰©ç½‘ç«™ä¸€ä¸ªä¸´æ—¶é€šè¡Œè¯
5. è´­ç‰©ç½‘ç«™ç”¨é€šè¡Œè¯è·å–ä½ çš„ä¿¡æ¯
```

**OAuth 2.0è®¤è¯æµç¨‹**ï¼š
```
å®¢æˆ·ç«¯                è®¤è¯æœåŠ¡å™¨            èµ„æºæœåŠ¡å™¨
 |                      |                    |
 |--[1]è¯·æ±‚æˆæƒ--------->|                    |
 |<-[2]æˆæƒç ------------|                    |
 |--[3]ç”¨æˆæƒç æ¢Token--->|                    |
 |<-[4]è®¿é—®Token---------|                    |
 |--[5]ç”¨Tokenè®¿é—®èµ„æº------------------>|
 |<-[6]è¿”å›èµ„æºæ•°æ®<----------------------|
```

### 2.4 å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰


**SSOæ˜¯ä»€ä¹ˆ**ï¼šSingle Sign-Onï¼Œä¸€æ¬¡ç™»å½•ï¼Œåˆ°å¤„é€šè¡Œ

**ç”Ÿæ´»æ¯”å–»**ï¼šå°±åƒæ¸¸ä¹å›­çš„é€šç¥¨ï¼Œä¹°ä¸€å¼ ç¥¨å¯ä»¥ç©æ‰€æœ‰é¡¹ç›®

```java
// SSOå®ç°ç¤ºä¾‹
@RestController
public class SSOController {
    
    @Autowired
    private JwtUtil jwtUtil;
    
    // ç»Ÿä¸€ç™»å½•æ¥å£
    @PostMapping("/login")
    public ResponseEntity<LoginResponse> login(@RequestBody LoginRequest request) {
        // 1. éªŒè¯ç”¨æˆ·åå¯†ç 
        User user = userService.authenticate(request.getUsername(), request.getPassword());
        
        // 2. ç”ŸæˆJWT Token
        String token = jwtUtil.generateToken(user);
        
        // 3. è¿”å›Tokenå’Œç”¨æˆ·ä¿¡æ¯
        return ResponseEntity.ok(new LoginResponse(token, user));
    }
    
    // TokenéªŒè¯æ¥å£
    @PostMapping("/verify")
    public ResponseEntity<User> verifyToken(@RequestHeader("Authorization") String token) {
        User user = jwtUtil.parseToken(token);
        return ResponseEntity.ok(user);
    }
}
```

---

## 3. ğŸ›¡ï¸ æˆæƒæ§åˆ¶ç­–ç•¥


### 3.1 ä»€ä¹ˆæ˜¯æˆæƒ


**é€šä¿—ç†è§£**ï¼šæˆæƒå°±æ˜¯"ä½ èƒ½åšä»€ä¹ˆ"çš„é—®é¢˜

```
è®¤è¯ vs æˆæƒï¼š
è®¤è¯ï¼šä½ æ˜¯å¼ ä¸‰å—ï¼Ÿï¼ˆèº«ä»½éªŒè¯ï¼‰
æˆæƒï¼šå¼ ä¸‰å¯ä»¥åšä»€ä¹ˆï¼Ÿï¼ˆæƒé™æ§åˆ¶ï¼‰

ç”Ÿæ´»ä¾‹å­ï¼š
è¿›å…¥å…¬å¸å¤§æ¥¼ = è®¤è¯ï¼ˆåˆ·å·¥å¡ï¼‰
è¿›å…¥è´¢åŠ¡å®¤   = æˆæƒï¼ˆåªæœ‰è´¢åŠ¡äººå‘˜å¯ä»¥è¿›ï¼‰
```

### 3.2 RBACåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶


**RBACæ˜¯ä»€ä¹ˆ**ï¼šRole-Based Access Controlï¼ŒåŸºäºè§’è‰²çš„æƒé™æ§åˆ¶

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
```
ç”¨æˆ·(User) â”€â”€å…³è”â”€â”€> è§’è‰²(Role) â”€â”€æ‹¥æœ‰â”€â”€> æƒé™(Permission)

ä¾‹å­ï¼š
å¼ ä¸‰(ç”¨æˆ·) â”€â”€æ˜¯â”€â”€> ç®¡ç†å‘˜(è§’è‰²) â”€â”€å¯ä»¥â”€â”€> åˆ é™¤ç”¨æˆ·(æƒé™)
æå››(ç”¨æˆ·) â”€â”€æ˜¯â”€â”€> æ™®é€šå‘˜å·¥(è§’è‰²) â”€â”€å¯ä»¥â”€â”€> æŸ¥çœ‹èµ„æ–™(æƒé™)
```

**RBACæƒé™æ¨¡å‹**ï¼š
```
ç”¨æˆ·è¡¨                è§’è‰²è¡¨                æƒé™è¡¨
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ç”¨æˆ·IDâ”‚ å§“å  â”‚       â”‚è§’è‰²IDâ”‚è§’è‰²å  â”‚       â”‚æƒé™IDâ”‚æƒé™å  â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
â”‚  1  â”‚ å¼ ä¸‰  â”‚       â”‚  1  â”‚ ç®¡ç†å‘˜ â”‚       â”‚  1  â”‚ ç”¨æˆ·ç®¡ç†â”‚
â”‚  2  â”‚ æå››  â”‚       â”‚  2  â”‚ æ™®é€šå‘˜å·¥â”‚       â”‚  2  â”‚ æ•°æ®æŸ¥çœ‹â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜

ç”¨æˆ·è§’è‰²å…³è”è¡¨          è§’è‰²æƒé™å…³è”è¡¨
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ç”¨æˆ·IDâ”‚è§’è‰²IDâ”‚         â”‚è§’è‰²IDâ”‚æƒé™IDâ”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚  1  â”‚  1  â”‚         â”‚  1  â”‚  1  â”‚
â”‚  2  â”‚  2  â”‚         â”‚  1  â”‚  2  â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜         â”‚  2  â”‚  2  â”‚
                      â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
```

### 3.3 APIæƒé™æ§åˆ¶


**æ¥å£çº§åˆ«çš„æƒé™æ§åˆ¶**ï¼š
```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    // åªæœ‰ç®¡ç†å‘˜å¯ä»¥è®¿é—®
    @PreAuthorize("hasRole('ADMIN')")
    @DeleteMapping("/{id}")
    public ResponseEntity<?> deleteUser(@PathVariable Long id) {
        userService.deleteUser(id);
        return ResponseEntity.ok("ç”¨æˆ·åˆ é™¤æˆåŠŸ");
    }
    
    // æ™®é€šç”¨æˆ·å’Œç®¡ç†å‘˜éƒ½å¯ä»¥è®¿é—®
    @PreAuthorize("hasRole('USER') or hasRole('ADMIN')")
    @GetMapping("/{id}")
    public ResponseEntity<User> getUser(@PathVariable Long id) {
        User user = userService.getUser(id);
        return ResponseEntity.ok(user);
    }
    
    // åªèƒ½è®¿é—®è‡ªå·±çš„ä¿¡æ¯
    @PreAuthorize("#id == authentication.principal.id")
    @PutMapping("/{id}")
    public ResponseEntity<?> updateUser(@PathVariable Long id, @RequestBody User user) {
        userService.updateUser(id, user);
        return ResponseEntity.ok("ç”¨æˆ·æ›´æ–°æˆåŠŸ");
    }
}
```

### 3.4 æ•°æ®çº§æƒé™æ§åˆ¶


**ä»€ä¹ˆæ˜¯æ•°æ®æƒé™**ï¼šä¸åŒç”¨æˆ·çœ‹åˆ°ä¸åŒçš„æ•°æ®

```
ä¾‹å­ï¼šå‘˜å·¥ç®¡ç†ç³»ç»Ÿ
- æ™®é€šå‘˜å·¥ï¼šåªèƒ½çœ‹è‡ªå·±çš„å·¥èµ„
- éƒ¨é—¨ç»ç†ï¼šèƒ½çœ‹æœ¬éƒ¨é—¨æ‰€æœ‰äººçš„å·¥èµ„
- HRç»ç†ï¼šèƒ½çœ‹å…¨å…¬å¸æ‰€æœ‰äººçš„å·¥èµ„
- æ€»ç»ç†ï¼šèƒ½çœ‹æ‰€æœ‰æ•°æ®
```

**å®ç°æ–¹å¼**ï¼š
```java
@Service
public class SalaryService {
    
    public List<Salary> getSalaryList(User currentUser) {
        String sql = "SELECT * FROM salary WHERE 1=1";
        
        // æ ¹æ®ç”¨æˆ·è§’è‰²æ·»åŠ æ•°æ®è¿‡æ»¤æ¡ä»¶
        if (currentUser.hasRole("EMPLOYEE")) {
            // æ™®é€šå‘˜å·¥åªèƒ½çœ‹è‡ªå·±çš„
            sql += " AND employee_id = " + currentUser.getId();
        } else if (currentUser.hasRole("DEPARTMENT_MANAGER")) {
            // éƒ¨é—¨ç»ç†çœ‹æœ¬éƒ¨é—¨çš„
            sql += " AND department_id = " + currentUser.getDepartmentId();
        } else if (currentUser.hasRole("HR_MANAGER") || currentUser.hasRole("CEO")) {
            // HRå’ŒCEOçœ‹å…¨éƒ¨
            // ä¸æ·»åŠ é¢å¤–æ¡ä»¶
        }
        
        return jdbcTemplate.query(sql, new SalaryRowMapper());
    }
}
```

---

## 4. ğŸ” æ•°æ®åŠ å¯†ä¿æŠ¤


### 4.1 ä¸ºä»€ä¹ˆéœ€è¦åŠ å¯†


**ç”Ÿæ´»æ¯”å–»**ï¼š
```
ä¸åŠ å¯† = æ˜ä¿¡ç‰‡ï¼šæ‰€æœ‰äººéƒ½èƒ½çœ‹åˆ°å†…å®¹
åŠ å¯†   = å¯†ç ç®±ï¼šåªæœ‰çŸ¥é“å¯†ç çš„äººæ‰èƒ½çœ‹åˆ°
```

**å¾®æœåŠ¡ä¸­çš„åŠ å¯†éœ€æ±‚**ï¼š
```
ä¼ è¾“è¿‡ç¨‹ï¼šæ•°æ®åœ¨ç½‘ç»œä¸­ä¼ è¾“æ—¶åŠ å¯†
å­˜å‚¨è¿‡ç¨‹ï¼šæ•°æ®å­˜åœ¨æ•°æ®åº“ä¸­æ—¶åŠ å¯†
ä½¿ç”¨è¿‡ç¨‹ï¼šæ•æ„Ÿæ“ä½œæ—¶çš„èº«ä»½éªŒè¯
```

### 4.2 ä¼ è¾“åŠ å¯†ï¼ˆHTTPS/TLSï¼‰


**HTTPSæ˜¯ä»€ä¹ˆ**ï¼šHTTP + SSL/TLSï¼Œç»™HTTPç©¿ä¸ŠåŠ å¯†çš„å¤–è¡£

```
HTTPä¼ è¾“ï¼ˆä¸å®‰å…¨ï¼‰ï¼š
å®¢æˆ·ç«¯ â”€â”€â”€â”€æ˜æ–‡æ•°æ®â”€â”€â”€â”€> æœåŠ¡ç«¯
       å¯èƒ½è¢«æ‹¦æˆªå’Œçªƒå–

HTTPSä¼ è¾“ï¼ˆå®‰å…¨ï¼‰ï¼š
å®¢æˆ·ç«¯ â”€â”€â”€â”€åŠ å¯†æ•°æ®â”€â”€â”€â”€> æœåŠ¡ç«¯
       å³ä½¿è¢«æ‹¦æˆªä¹Ÿçœ‹ä¸æ‡‚
```

**TLSæ¡æ‰‹è¿‡ç¨‹**ï¼š
```
å®¢æˆ·ç«¯                        æœåŠ¡ç«¯
 |                              |
 |--[1]æˆ‘è¦å»ºç«‹å®‰å…¨è¿æ¥--------->|
 |<-[2]è¿™æ˜¯æˆ‘çš„æ•°å­—è¯ä¹¦----------|
 |--[3]ç”¨ä½ çš„å…¬é’¥åŠ å¯†å¯†é’¥------->|
 |<-[4]æ¡æ‰‹å®Œæˆï¼Œå¼€å§‹åŠ å¯†é€šä¿¡----|
 |                              |
 |====åŠ å¯†çš„æ•°æ®ä¼ è¾“=============|
```

### 4.3 æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨


**ä»€ä¹ˆæ•°æ®éœ€è¦åŠ å¯†**ï¼š
- âœ… **å¯†ç **ï¼šç”¨æˆ·ç™»å½•å¯†ç 
- âœ… **èº«ä»½è¯å·**ï¼šä¸ªäººéšç§ä¿¡æ¯
- âœ… **æ‰‹æœºå·**ï¼šè”ç³»æ–¹å¼
- âœ… **é“¶è¡Œå¡å·**ï¼šé‡‘èä¿¡æ¯
- âœ… **APIå¯†é’¥**ï¼šç³»ç»Ÿå¯†é’¥

**åŠ å¯†å­˜å‚¨ç¤ºä¾‹**ï¼š
```java
@Entity
public class User {
    @Id
    private Long id;
    
    private String username;
    
    // å¯†ç åŠ å¯†å­˜å‚¨
    @Column(name = "password_hash")
    private String password;
    
    // æ‰‹æœºå·åŠ å¯†å­˜å‚¨
    @Convert(converter = PhoneNumberCryptoConverter.class)
    private String phoneNumber;
    
    // èº«ä»½è¯å·åŠ å¯†å­˜å‚¨
    @Convert(converter = IdCardCryptoConverter.class)
    private String idCard;
}

// æ‰‹æœºå·åŠ å¯†è½¬æ¢å™¨
@Component
public class PhoneNumberCryptoConverter implements AttributeConverter<String, String> {
    
    @Autowired
    private CryptoService cryptoService;
    
    @Override
    public String convertToDatabaseColumn(String plainText) {
        // å­˜å‚¨æ—¶åŠ å¯†
        return cryptoService.encrypt(plainText);
    }
    
    @Override
    public String convertToEntityAttribute(String encryptedText) {
        // è¯»å–æ—¶è§£å¯†
        return cryptoService.decrypt(encryptedText);
    }
}
```

### 4.4 å¯†é’¥ç®¡ç†


**å¯†é’¥ç®¡ç†çš„é‡è¦æ€§**ï¼š
```
å¥½çš„å¯†é’¥ç®¡ç† = ä¿é™©ç®±çš„é’¥åŒ™æ”¾åœ¨å®‰å…¨çš„åœ°æ–¹
åçš„å¯†é’¥ç®¡ç† = ä¿é™©ç®±çš„é’¥åŒ™è´´åœ¨ä¿é™©ç®±ä¸Š
```

**å¯†é’¥ç®¡ç†æœ€ä½³å®è·µ**ï¼š
- ğŸ”‘ **åˆ†ç¦»å­˜å‚¨**ï¼šå¯†é’¥ä¸å’Œæ•°æ®æ”¾åœ¨ä¸€èµ·
- ğŸ”„ **å®šæœŸè½®æ¢**ï¼šå®šæœŸæ›´æ¢å¯†é’¥
- ğŸ­ **ç¯å¢ƒéš”ç¦»**ï¼šå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒç”¨ä¸åŒå¯†é’¥
- ğŸ“‹ **æƒé™æ§åˆ¶**ï¼šåªæœ‰æˆæƒäººå‘˜å¯ä»¥è®¿é—®å¯†é’¥

---

## 5. ğŸŒ APIå®‰å…¨é˜²æŠ¤


### 5.1 APIå®‰å…¨å¨èƒ


**å¸¸è§çš„APIæ”»å‡»**ï¼š
```
SQLæ³¨å…¥ï¼šæ¶æ„SQLä»£ç æ³¨å…¥
XSSæ”»å‡»ï¼šè·¨ç«™è„šæœ¬æ”»å‡»
CSRFæ”»å‡»ï¼šè·¨ç«™è¯·æ±‚ä¼ªé€ 
æš´åŠ›ç ´è§£ï¼šå°è¯•å¤§é‡å¯†ç ç»„åˆ
DDoSæ”»å‡»ï¼šå¤§é‡è¯·æ±‚è®©æœåŠ¡å™¨ç˜«ç—ª
```

### 5.2 è¾“å…¥éªŒè¯ä¸è¿‡æ»¤


**ä¸ºä»€ä¹ˆéœ€è¦éªŒè¯**ï¼š
```
ä¸éªŒè¯è¾“å…¥ = æ•å¼€å¤§é—¨è®©åäººè¿›æ¥
éªŒè¯è¾“å…¥   = åœ¨é—¨å£æ£€æŸ¥æ¯ä¸ªè®¿å®¢
```

**è¾“å…¥éªŒè¯ç¤ºä¾‹**ï¼š
```java
@RestController
public class UserController {
    
    @PostMapping("/users")
    public ResponseEntity<?> createUser(@Valid @RequestBody CreateUserRequest request) {
        // @Validæ³¨è§£ä¼šè‡ªåŠ¨éªŒè¯è¾“å…¥
        User user = userService.createUser(request);
        return ResponseEntity.ok(user);
    }
}

// è¯·æ±‚å‚æ•°éªŒè¯
public class CreateUserRequest {
    
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @Pattern(regexp = "^[a-zA-Z0-9_]{3,20}$", message = "ç”¨æˆ·ååªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼Œé•¿åº¦3-20ä½")
    private String username;
    
    @NotBlank(message = "å¯†ç ä¸èƒ½ä¸ºç©º")
    @Length(min = 6, max = 20, message = "å¯†ç é•¿åº¦å¿…é¡»åœ¨6-20ä½ä¹‹é—´")
    private String password;
    
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String email;
    
    @Pattern(regexp = "^1[3-9]\\d{9}$", message = "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®")
    private String phoneNumber;
}
```

### 5.3 é¢‘ç‡é™åˆ¶ï¼ˆRate Limitingï¼‰


**ä»€ä¹ˆæ˜¯é¢‘ç‡é™åˆ¶**ï¼šé™åˆ¶ç”¨æˆ·åœ¨ä¸€å®šæ—¶é—´å†…çš„è¯·æ±‚æ¬¡æ•°

**ç”Ÿæ´»ä¾‹å­**ï¼š
```
é“¶è¡ŒATMï¼šæ¯å¤©åªèƒ½å–æ¬¾3æ¬¡
æ‰‹æœºéªŒè¯ç ï¼š1åˆ†é’Ÿåªèƒ½å‘é€1æ¬¡
ç™»å½•å°è¯•ï¼š5æ¬¡é”™è¯¯åé”å®šè´¦æˆ·
```

**å®ç°æ–¹å¼**ï¼š
```java
@Component
public class RateLimitInterceptor implements HandlerInterceptor {
    
    private final RedisTemplate<String, String> redisTemplate;
    
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {
        String clientIp = getClientIp(request);
        String key = "rate_limit:" + clientIp;
        
        // è·å–å½“å‰è¯·æ±‚æ¬¡æ•°
        String count = redisTemplate.opsForValue().get(key);
        
        if (count == null) {
            // ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼Œè®¾ç½®è®¡æ•°å™¨
            redisTemplate.opsForValue().set(key, "1", Duration.ofMinutes(1));
            return true;
        } else if (Integer.parseInt(count) < 100) {
            // æœªè¶…è¿‡é™åˆ¶ï¼Œè®¡æ•°å™¨+1
            redisTemplate.opsForValue().increment(key);
            return true;
        } else {
            // è¶…è¿‡é™åˆ¶ï¼Œæ‹’ç»è¯·æ±‚
            response.setStatus(429); // Too Many Requests
            return false;
        }
    }
}
```

### 5.4 APIç½‘å…³å®‰å…¨


**APIç½‘å…³çš„ä½œç”¨**ï¼š
```
APIç½‘å…³ = å°åŒºçš„é—¨å«
æ‰€æœ‰è®¿å®¢éƒ½è¦ç»è¿‡é—¨å«æ£€æŸ¥æ‰èƒ½è¿›å…¥å°åŒº
```

**ç½‘å…³å®‰å…¨åŠŸèƒ½**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              APIç½‘å…³                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è®¤è¯æ£€æŸ¥     â”‚ æ£€æŸ¥Tokenæ˜¯å¦æœ‰æ•ˆ       â”‚
â”‚ æˆæƒéªŒè¯     â”‚ æ£€æŸ¥æ˜¯å¦æœ‰è®¿é—®æƒé™      â”‚
â”‚ é¢‘ç‡é™åˆ¶     â”‚ é™åˆ¶è¯·æ±‚é¢‘ç‡           â”‚
â”‚ å‚æ•°éªŒè¯     â”‚ éªŒè¯è¯·æ±‚å‚æ•°           â”‚
â”‚ æ—¥å¿—è®°å½•     â”‚ è®°å½•æ‰€æœ‰è®¿é—®æ—¥å¿—       â”‚
â”‚ å®‰å…¨è¿‡æ»¤     â”‚ è¿‡æ»¤æ¶æ„è¯·æ±‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. ğŸš« é›¶ä¿¡ä»»æ¶æ„


### 6.1 ä»€ä¹ˆæ˜¯é›¶ä¿¡ä»»


**ä¼ ç»Ÿä¿¡ä»»æ¨¡å¼**ï¼š
```
å†…ç½‘ = å¯ä¿¡ä»»åŒºåŸŸï¼ˆåŸå ¡æ¨¡å¼ï¼‰
å¤–ç½‘ = ä¸å¯ä¿¡åŒºåŸŸ

å°±åƒå¤ä»£åŸå ¡ï¼š
- åŸå¢™å¤–é¢æ˜¯æ•Œäººï¼Œä¸èƒ½ä¿¡ä»»
- åŸå¢™é‡Œé¢æ˜¯è‡ªå·±äººï¼Œå®Œå…¨ä¿¡ä»»
```

**é›¶ä¿¡ä»»æ¨¡å¼**ï¼š
```
ä¸ä¿¡ä»»ä»»ä½•äººå’Œä»»ä½•è®¾å¤‡ï¼ˆéªŒè¯ä¸€åˆ‡ï¼‰

å°±åƒæœºåœºå®‰æ£€ï¼š
- æ¯ä¸ªäººéƒ½è¦å®‰æ£€ï¼ŒåŒ…æ‹¬æœºåœºå·¥ä½œäººå‘˜
- æ¯ä¸ªåŒ…éƒ½è¦æ£€æŸ¥ï¼ŒåŒ…æ‹¬å†…éƒ¨äººå‘˜çš„åŒ…
```

### 6.2 é›¶ä¿¡ä»»çš„æ ¸å¿ƒåŸåˆ™


**åŸåˆ™1ï¼šéªŒè¯ä¸€åˆ‡**
```
å¤–éƒ¨ç”¨æˆ· â”€â”€éœ€è¦éªŒè¯â”€â”€> å…è®¸è®¿é—®
å†…éƒ¨å‘˜å·¥ â”€â”€ä¹Ÿéœ€è¦éªŒè¯â”€â”€> å…è®¸è®¿é—®
ç³»ç»ŸæœåŠ¡ â”€â”€åŒæ ·éœ€è¦éªŒè¯â”€â”€> å…è®¸è®¿é—®
```

**åŸåˆ™2ï¼šæœ€å°æƒé™**
```
ç”¨æˆ·å¼ ä¸‰ï¼š
- å¯ä»¥è®¿é—®ï¼šè‡ªå·±è´Ÿè´£çš„è®¢å•æ•°æ®
- ä¸å¯ä»¥è®¿é—®ï¼šå…¶ä»–äººçš„è®¢å•æ•°æ®
- ä¸å¯ä»¥è®¿é—®ï¼šè´¢åŠ¡æ•°æ®
- ä¸å¯ä»¥è®¿é—®ï¼šç³»ç»Ÿé…ç½®
```

**åŸåˆ™3ï¼šæŒç»­ç›‘æ§**
```
æ­£å¸¸è¡Œä¸ºï¼šå¼ ä¸‰ä¸Šåˆ9ç‚¹ç™»å½•ï¼ŒæŸ¥çœ‹è®¢å• âœ“
å¼‚å¸¸è¡Œä¸ºï¼šå¼ ä¸‰å‡Œæ™¨3ç‚¹ç™»å½•ï¼Œä¸‹è½½å¤§é‡æ•°æ® âš ï¸
```

### 6.3 å¾®æœåŠ¡é›¶ä¿¡ä»»å®ç°


**æœåŠ¡é—´é€šä¿¡åŠ å¯†**ï¼š
```java
// æœåŠ¡Aè°ƒç”¨æœåŠ¡B
@FeignClient(name = "user-service", configuration = SecureFeignConfiguration.class)
public interface UserServiceClient {
    
    @GetMapping("/users/{id}")
    User getUser(@PathVariable Long id);
}

// å®‰å…¨é…ç½®
@Configuration
public class SecureFeignConfiguration {
    
    @Bean
    public RequestInterceptor requestInterceptor() {
        return template -> {
            // 1. æ·»åŠ æœåŠ¡è®¤è¯Token
            String serviceToken = jwtUtil.generateServiceToken();
            template.header("Authorization", "Bearer " + serviceToken);
            
            // 2. æ·»åŠ è¯·æ±‚ç­¾å
            String signature = signatureUtil.sign(template.body());
            template.header("X-Signature", signature);
            
            // 3. æ·»åŠ æ—¶é—´æˆ³é˜²é‡æ”¾
            template.header("X-Timestamp", String.valueOf(System.currentTimeMillis()));
        };
    }
}
```

**åŠ¨æ€æƒé™éªŒè¯**ï¼š
```java
@Service
public class DynamicPermissionService {
    
    public boolean hasPermission(User user, String resource, String action) {
        // 1. æ£€æŸ¥ç”¨æˆ·åŸºç¡€æƒé™
        if (!user.hasBasicPermission(resource, action)) {
            return false;
        }
        
        // 2. æ£€æŸ¥æ—¶é—´æƒé™ï¼ˆæ¯”å¦‚åªèƒ½å·¥ä½œæ—¶é—´è®¿é—®ï¼‰
        if (!isWorkingHours() && isSensitiveResource(resource)) {
            return false;
        }
        
        // 3. æ£€æŸ¥åœ°ç†ä½ç½®æƒé™ï¼ˆæ¯”å¦‚åªèƒ½åœ¨å…¬å¸è®¿é—®ï¼‰
        if (!isFromOfficeLocation(user.getCurrentLocation()) && isSensitiveResource(resource)) {
            return false;
        }
        
        // 4. æ£€æŸ¥è¡Œä¸ºå¼‚å¸¸ï¼ˆæ¯”å¦‚çŸ­æ—¶é—´å¤§é‡ä¸‹è½½ï¼‰
        if (isAbnormalBehavior(user, action)) {
            return false;
        }
        
        return true;
    }
}
```

---

## 7. ğŸ“Š å®‰å…¨å®¡è®¡ä¸ç›‘æ§


### 7.1 ä»€ä¹ˆæ˜¯å®‰å…¨å®¡è®¡


**å®¡è®¡çš„ç›®çš„**ï¼š
```
äº‹å‰ï¼šå‘ç°å®‰å…¨éšæ‚£
äº‹ä¸­ï¼šå®æ—¶ç›‘æ§å¼‚å¸¸
äº‹åï¼šè¿½è¸ªå®‰å…¨äº‹ä»¶
```

**å®¡è®¡å°±åƒ**ï¼š
```
é“¶è¡Œçš„ç›‘æ§æ‘„åƒå¤´ï¼š
- è®°å½•æ¯ä¸€ä¸ªè¿›å‡ºçš„äºº
- è®°å½•æ¯ä¸€ç¬”äº¤æ˜“
- å‘ç°å¼‚å¸¸ç«‹å³æŠ¥è­¦
- äº‹åå¯ä»¥å›çœ‹å½•åƒ
```

### 7.2 æ—¥å¿—è®°å½•ç­–ç•¥


**ä»€ä¹ˆæ“ä½œéœ€è¦è®°å½•**ï¼š
- âœ… **ç™»å½•ç™»å‡º**ï¼šè°ä»€ä¹ˆæ—¶å€™ç™»å½•äº†ç³»ç»Ÿ
- âœ… **æƒé™å˜æ›´**ï¼šè°çš„æƒé™è¢«ä¿®æ”¹äº†
- âœ… **æ•æ„Ÿæ“ä½œ**ï¼šè°æŸ¥çœ‹/ä¿®æ”¹äº†æ•æ„Ÿæ•°æ®
- âœ… **å¼‚å¸¸è®¿é—®**ï¼šå¤±è´¥çš„ç™»å½•å°è¯•
- âœ… **ç³»ç»Ÿé”™è¯¯**ï¼šå®‰å…¨ç›¸å…³çš„ç³»ç»Ÿé”™è¯¯

**æ—¥å¿—è®°å½•ç¤ºä¾‹**ï¼š
```java
@Aspect
@Component
public class SecurityAuditAspect {
    
    private final AuditLogService auditLogService;
    
    // è®°å½•æ•æ„Ÿæ“ä½œ
    @Around("@annotation(Auditable)")
    public Object auditMethod(ProceedingJoinPoint joinPoint) throws Throwable {
        String methodName = joinPoint.getSignature().getName();
        Object[] args = joinPoint.getArgs();
        String currentUser = SecurityContextHolder.getContext().getAuthentication().getName();
        
        // è®°å½•æ“ä½œå¼€å§‹
        AuditLog log = AuditLog.builder()
            .username(currentUser)
            .operation(methodName)
            .parameters(Arrays.toString(args))
            .timestamp(LocalDateTime.now())
            .ipAddress(RequestContextHolder.currentRequestAttributes()
                .getAttribute(RequestAttributes.REFERENCE_REQUEST, RequestAttributes.SCOPE_REQUEST)
                .getRemoteAddr())
            .build();
        
        try {
            Object result = joinPoint.proceed();
            log.setStatus("SUCCESS");
            log.setResult(result.toString());
            return result;
        } catch (Exception e) {
            log.setStatus("FAILURE");
            log.setErrorMessage(e.getMessage());
            throw e;
        } finally {
            auditLogService.save(log);
        }
    }
}

// ä½¿ç”¨ç¤ºä¾‹
@RestController
public class UserController {
    
    @Auditable
    @DeleteMapping("/users/{id}")
    public ResponseEntity<?> deleteUser(@PathVariable Long id) {
        userService.deleteUser(id);
        return ResponseEntity.ok("ç”¨æˆ·åˆ é™¤æˆåŠŸ");
    }
}
```

### 7.3 å¼‚å¸¸è¡Œä¸ºç›‘æ§


**ä»€ä¹ˆæ˜¯å¼‚å¸¸è¡Œä¸º**ï¼š
```
æ­£å¸¸è¡Œä¸ºï¼šå¼ ä¸‰æ¯å¤©ä¸Šç­æ—¶é—´ç™»å½•ï¼ŒæŸ¥çœ‹è®¢å•
å¼‚å¸¸è¡Œä¸ºï¼šå¼ ä¸‰åŠå¤œç™»å½•ï¼Œä¸‹è½½å¤§é‡å®¢æˆ·æ•°æ®

æ­£å¸¸è¡Œä¸ºï¼šAPIæ¯ç§’è°ƒç”¨10æ¬¡
å¼‚å¸¸è¡Œä¸ºï¼šAPIæ¯ç§’è°ƒç”¨1000æ¬¡
```

**ç›‘æ§æŒ‡æ ‡**ï¼š
```java
@Component
public class SecurityMonitor {
    
    // ç›‘æ§ç™»å½•å¼‚å¸¸
    public void checkLoginAnomaly(LoginEvent event) {
        User user = event.getUser();
        
        // æ£€æŸ¥å¼‚å¸¸ç™»å½•æ—¶é—´
        if (isUnusualTime(event.getTimestamp())) {
            alertService.sendAlert("ç”¨æˆ· " + user.getUsername() + " åœ¨å¼‚å¸¸æ—¶é—´ç™»å½•");
        }
        
        // æ£€æŸ¥å¼‚å¸¸ç™»å½•åœ°ç‚¹
        if (isUnusualLocation(event.getLocation(), user.getUsualLocations())) {
            alertService.sendAlert("ç”¨æˆ· " + user.getUsername() + " ä»å¼‚å¸¸åœ°ç‚¹ç™»å½•");
        }
        
        // æ£€æŸ¥çŸ­æ—¶é—´å¤šæ¬¡ç™»å½•
        if (hasMultipleLoginsInShortTime(user, event.getTimestamp())) {
            alertService.sendAlert("ç”¨æˆ· " + user.getUsername() + " çŸ­æ—¶é—´å†…å¤šæ¬¡ç™»å½•");
        }
    }
    
    // ç›‘æ§APIå¼‚å¸¸
    public void checkApiAnomaly(ApiCallEvent event) {
        String api = event.getApiPath();
        
        // æ£€æŸ¥è°ƒç”¨é¢‘ç‡å¼‚å¸¸
        if (isHighFrequency(api, event.getTimestamp())) {
            alertService.sendAlert("API " + api + " è°ƒç”¨é¢‘ç‡å¼‚å¸¸");
        }
        
        // æ£€æŸ¥å¤§é‡æ•°æ®ä¸‹è½½
        if (isLargeDataDownload(event)) {
            alertService.sendAlert("æ£€æµ‹åˆ°å¤§é‡æ•°æ®ä¸‹è½½è¡Œä¸º");
        }
    }
}
```

### 7.4 å®‰å…¨äº‹ä»¶å“åº”


**äº‹ä»¶å“åº”æµç¨‹**ï¼š
```
å‘ç°å®‰å…¨äº‹ä»¶
    â†“
è¯„ä¼°å¨èƒçº§åˆ«
    â†“
é‡‡å–åº”æ€¥æªæ–½
    â†“
æ·±å…¥è°ƒæŸ¥åˆ†æ
    â†“
ä¿®å¤å®‰å…¨æ¼æ´
    â†“
æ€»ç»“å’Œæ”¹è¿›
```

**åº”æ€¥å“åº”æªæ–½**ï¼š
```java
@Service
public class SecurityIncidentResponseService {
    
    public void handleSecurityIncident(SecurityIncident incident) {
        // 1. è¯„ä¼°å¨èƒçº§åˆ«
        ThreatLevel level = assessThreatLevel(incident);
        
        switch (level) {
            case CRITICAL:
                // ç«‹å³é”å®šç›¸å…³è´¦æˆ·
                userService.lockUser(incident.getUserId());
                // é˜»æ–­å¯ç–‘IP
                firewallService.blockIp(incident.getSourceIp());
                // ç«‹å³é€šçŸ¥å®‰å…¨å›¢é˜Ÿ
                notificationService.notifySecurityTeam(incident);
                break;
                
            case HIGH:
                // å¢å¼ºç›‘æ§
                monitorService.enhanceMonitoring(incident.getUserId());
                // é€šçŸ¥ç›¸å…³ç®¡ç†å‘˜
                notificationService.notifyAdministrators(incident);
                break;
                
            case MEDIUM:
                // è®°å½•æ—¥å¿—ï¼ŒæŒç»­è§‚å¯Ÿ
                auditLogService.logIncident(incident);
                break;
                
            case LOW:
                // ä»…è®°å½•ï¼Œæ­£å¸¸å¤„ç†
                auditLogService.logIncident(incident);
                break;
        }
    }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„å®‰å…¨æ¦‚å¿µ


```
ğŸ”¸ è®¤è¯ vs æˆæƒï¼šè®¤è¯æ˜¯"ä½ æ˜¯è°"ï¼Œæˆæƒæ˜¯"ä½ èƒ½åšä»€ä¹ˆ"
ğŸ”¸ JWT Tokenï¼šä¸€ç§æ•°å­—èº«ä»½è¯ï¼Œå¯ä»¥åœ¨æœåŠ¡é—´ä¼ é€’
ğŸ”¸ RBACæƒé™ï¼šåŸºäºè§’è‰²çš„æƒé™æ§åˆ¶ï¼Œç”¨æˆ·->è§’è‰²->æƒé™
ğŸ”¸ åŠ å¯†ä¿æŠ¤ï¼šä¼ è¾“åŠ å¯†(HTTPS) + å­˜å‚¨åŠ å¯†(æ•æ„Ÿæ•°æ®)
ğŸ”¸ é›¶ä¿¡ä»»ï¼šä¸ä¿¡ä»»ä»»ä½•äººï¼ŒéªŒè¯ä¸€åˆ‡è®¿é—®
ğŸ”¸ å®‰å…¨å®¡è®¡ï¼šè®°å½•ä¸€åˆ‡ï¼Œç›‘æ§å¼‚å¸¸ï¼Œå¿«é€Ÿå“åº”
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ å¾®æœåŠ¡å®‰å…¨çš„å¤æ‚æ€§**
```
å•ä½“åº”ç”¨ï¼šå®ˆå¥½ä¸€ä¸ªåŸé—¨å°±è¡Œ
å¾®æœåŠ¡ï¼šæ¯ä¸ªæœåŠ¡éƒ½æ˜¯ä¸€ä¸ªåŸé—¨ï¼Œéƒ½è¦å®ˆå¥½
è§£å†³æ–¹æ¡ˆï¼šç»Ÿä¸€è®¤è¯ + æœåŠ¡é—´åŠ å¯† + ç»†ç²’åº¦æˆæƒ
```

**ğŸ”¹ å®‰å…¨ä¸ä¾¿åˆ©çš„å¹³è¡¡**
```
å¤ªå®‰å…¨ï¼šç”¨æˆ·ä½“éªŒå·®ï¼Œå¼€å‘æ•ˆç‡ä½
å¤ªä¾¿åˆ©ï¼šå®‰å…¨é£é™©é«˜ï¼Œå®¹æ˜“è¢«æ”»å‡»
å¹³è¡¡ç‚¹ï¼šæ ¹æ®ä¸šåŠ¡é‡è¦æ€§é€‰æ‹©åˆé€‚çš„å®‰å…¨çº§åˆ«
```

**ğŸ”¹ çºµæ·±é˜²å¾¡çš„é‡è¦æ€§**
```
ä¸èƒ½åªä¾èµ–ä¸€é“é˜²çº¿ï¼š
ç¬¬ä¸€å±‚ï¼šç½‘å…³éªŒè¯
ç¬¬äºŒå±‚ï¼šæœåŠ¡è®¤è¯
ç¬¬ä¸‰å±‚ï¼šæ•°æ®åŠ å¯†
ç¬¬å››å±‚ï¼šè¡Œä¸ºç›‘æ§
```

### 8.3 å®é™…åº”ç”¨å»ºè®®


**ğŸ¯ æ–°æ‰‹å®æ–½å»ºè®®**
- **ç¬¬ä¸€æ­¥**ï¼šå®ç°åŸºç¡€çš„JWTè®¤è¯
- **ç¬¬äºŒæ­¥**ï¼šæ·»åŠ RBACæƒé™æ§åˆ¶
- **ç¬¬ä¸‰æ­¥**ï¼šå¯ç”¨HTTPSä¼ è¾“åŠ å¯†
- **ç¬¬å››æ­¥**ï¼šå®ç°åŸºç¡€çš„æ—¥å¿—å®¡è®¡
- **ç¬¬äº”æ­¥**ï¼šé€æ­¥å¢åŠ é«˜çº§å®‰å…¨ç‰¹æ€§

**âš ï¸ å¸¸è§è¯¯åŒºé¿å…**
```
è¯¯åŒº1ï¼šè®¤ä¸ºå†…ç½‘å°±æ˜¯å®‰å…¨çš„
æ­£ç¡®ï¼šå†…ç½‘ä¹Ÿéœ€è¦éªŒè¯å’ŒåŠ å¯†

è¯¯åŒº2ï¼šåªåœ¨ç½‘å…³å±‚åšå®‰å…¨æ§åˆ¶
æ­£ç¡®ï¼šæ¯ä¸ªæœåŠ¡éƒ½è¦æœ‰å®‰å…¨æ„è¯†

è¯¯åŒº3ï¼šå®‰å…¨é…ç½®ä¸€åŠ³æ°¸é€¸
æ­£ç¡®ï¼šå®‰å…¨æ˜¯æŒç»­çš„è¿‡ç¨‹ï¼Œéœ€è¦ä¸æ–­ä¼˜åŒ–
```

**ğŸ’¡ æœ€ä½³å®è·µæ€»ç»“**
- ğŸ” **æœ€å°æƒé™åŸåˆ™**ï¼šåªç»™å¿…è¦çš„æƒé™
- ğŸ›¡ï¸ **æ·±åº¦é˜²å¾¡ç­–ç•¥**ï¼šå¤šå±‚å®‰å…¨ä¿æŠ¤
- ğŸ“Š **æŒç»­ç›‘æ§å®¡è®¡**ï¼šå®æ—¶å‘ç°å¼‚å¸¸
- ğŸ”„ **å®šæœŸå®‰å…¨è¯„ä¼°**ï¼šæŒç»­æ”¹è¿›å®‰å…¨æªæ–½
- ğŸ“š **å®‰å…¨æ„è¯†åŸ¹è®­**ï¼šæå‡å›¢é˜Ÿå®‰å…¨æ„è¯†

**æ ¸å¿ƒè®°å¿†**ï¼š
- å¾®æœåŠ¡å®‰å…¨ä¸æ˜¯ä¸€æ¬¡æ€§å·¥ç¨‹ï¼Œè€Œæ˜¯æŒç»­çš„è¿‡ç¨‹
- è®¤è¯è§£å†³"æ˜¯è°"ï¼Œæˆæƒè§£å†³"èƒ½åšä»€ä¹ˆ"
- åŠ å¯†ä¿æŠ¤æ•°æ®ï¼Œå®¡è®¡å‘ç°é—®é¢˜
- é›¶ä¿¡ä»»åŸåˆ™ï¼šä¸ä¿¡ä»»ä»»ä½•äººï¼ŒéªŒè¯ä¸€åˆ‡è®¿é—®