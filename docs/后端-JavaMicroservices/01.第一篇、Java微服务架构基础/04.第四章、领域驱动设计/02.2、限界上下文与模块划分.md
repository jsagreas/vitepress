---
title: 2ã€é™ç•Œä¸Šä¸‹æ–‡ä¸æ¨¡å—åˆ’åˆ†
---
## ğŸ“š ç›®å½•

1. [é™ç•Œä¸Šä¸‹æ–‡åŸºç¡€æ¦‚å¿µ](#1-é™ç•Œä¸Šä¸‹æ–‡åŸºç¡€æ¦‚å¿µ)
2. [ä¸Šä¸‹æ–‡æ˜ å°„æ¨¡å¼è¯¦è§£](#2-ä¸Šä¸‹æ–‡æ˜ å°„æ¨¡å¼è¯¦è§£)
3. [é™ç•Œä¸Šä¸‹æ–‡çš„åˆ’åˆ†å®è·µ](#3-é™ç•Œä¸Šä¸‹æ–‡çš„åˆ’åˆ†å®è·µ)
4. [ä¸Šä¸‹æ–‡é›†æˆç­–ç•¥](#4-ä¸Šä¸‹æ–‡é›†æˆç­–ç•¥)
5. [å®é™…é¡¹ç›®åº”ç”¨æŒ‡å—](#5-å®é™…é¡¹ç›®åº”ç”¨æŒ‡å—)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ é™ç•Œä¸Šä¸‹æ–‡åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯é™ç•Œä¸Šä¸‹æ–‡


**ğŸ”¸ é€šä¿—ç†è§£**
é™ç•Œä¸Šä¸‹æ–‡å°±åƒæ˜¯**ä¸€ä¸ªä¸“é—¨çš„å·¥ä½œåŒºåŸŸ**ï¼Œåœ¨è¿™ä¸ªåŒºåŸŸå†…ï¼Œæ‰€æœ‰äººå¯¹åŒä¸€ä¸ªè¯æ±‡çš„ç†è§£éƒ½æ˜¯ä¸€è‡´çš„ã€‚

```
ç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼š
"è‹¹æœ"è¿™ä¸ªè¯ï¼š
- åœ¨æ°´æœåº—é‡Œ â†’ æŒ‡çš„æ˜¯å¯ä»¥åƒçš„æ°´æœ
- åœ¨æ‰‹æœºåº—é‡Œ â†’ æŒ‡çš„æ˜¯iPhoneå“ç‰Œ
- åœ¨å­¦æ ¡é‡Œ   â†’ å¯èƒ½æŒ‡çš„æ˜¯æ•™å­¦ç”¨çš„æ¨¡å‹

æ¯ä¸ª"åº—"å°±æ˜¯ä¸€ä¸ªé™ç•Œä¸Šä¸‹æ–‡ï¼Œåœ¨å„è‡ªçš„ä¸Šä¸‹æ–‡å†…ï¼Œ"è‹¹æœ"çš„å«ä¹‰å¾ˆæ¸…æ¥š
```

**ğŸ”¸ æŠ€æœ¯å®šä¹‰**
é™ç•Œä¸Šä¸‹æ–‡ï¼ˆBounded Contextï¼‰æ˜¯DDDä¸­çš„æ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ª**è¯­ä¹‰è¾¹ç•Œ**ï¼Œåœ¨è¿™ä¸ªè¾¹ç•Œå†…ï¼š
- æ‰€æœ‰æ¦‚å¿µå’Œæœ¯è¯­æœ‰**ç»Ÿä¸€æ˜ç¡®çš„å«ä¹‰**
- ä¸€ä¸ªé¢†åŸŸæ¨¡å‹åœ¨æ­¤è¾¹ç•Œå†…**ä¿æŒä¸€è‡´æ€§**
- ä¸åŒä¸Šä¸‹æ–‡é—´çš„æ¦‚å¿µ**å¯èƒ½å«ä¹‰ä¸åŒ**

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦é™ç•Œä¸Šä¸‹æ–‡


**ğŸ¤” æ²¡æœ‰é™ç•Œä¸Šä¸‹æ–‡çš„é—®é¢˜**

```
ç”µå•†ç³»ç»Ÿä¸­çš„"ç”¨æˆ·"æ¦‚å¿µæ··ä¹±ï¼š

è®¢å•ç³»ç»Ÿï¼šç”¨æˆ· = è´­ä¹°è€…ï¼ˆå…³æ³¨è´­ä¹°å†å²ã€åœ°å€ï¼‰
ç”¨æˆ·ç®¡ç†ï¼šç”¨æˆ· = è´¦å·æŒæœ‰è€…ï¼ˆå…³æ³¨ç™»å½•ã€æƒé™ï¼‰
è¥é”€ç³»ç»Ÿï¼šç”¨æˆ· = ç›®æ ‡å®¢æˆ·ï¼ˆå…³æ³¨åå¥½ã€æ ‡ç­¾ï¼‰
å®¢æœç³»ç»Ÿï¼šç”¨æˆ· = æœåŠ¡å¯¹è±¡ï¼ˆå…³æ³¨æŠ•è¯‰ã€å’¨è¯¢ï¼‰

ç»“æœï¼šä¸€ä¸ªå·¨å¤§çš„Userç±»åŒ…å«æ‰€æœ‰å±æ€§ï¼Œä»£ç æ··ä¹±ï¼Œç»´æŠ¤å›°éš¾
```

**âœ… æœ‰äº†é™ç•Œä¸Šä¸‹æ–‡çš„å¥½å¤„**

```
æ¸…æ™°çš„è¾¹ç•Œåˆ’åˆ†ï¼š

è®¢å•ä¸Šä¸‹æ–‡ï¼š
class Buyer {
    String buyerId;
    List<Address> addresses;
    PaymentMethod defaultPayment;
}

ç”¨æˆ·ç®¡ç†ä¸Šä¸‹æ–‡ï¼š
class Account {
    String accountId;
    String email;
    Set<Permission> permissions;
}

æ¯ä¸ªä¸Šä¸‹æ–‡å…³æ³¨è‡ªå·±çš„æ ¸å¿ƒèŒè´£ï¼Œæ¨¡å‹ç®€æ´æ¸…æ™°
```

### 1.3 é™ç•Œä¸Šä¸‹æ–‡çš„ç‰¹å¾


**ğŸ”¹ ç‹¬ç«‹æ€§**
```
ç‰¹å¾è¯´æ˜ï¼š
âœ“ æœ‰è‡ªå·±çš„é¢†åŸŸæ¨¡å‹
âœ“ æœ‰è‡ªå·±çš„æ•°æ®å­˜å‚¨
âœ“ æœ‰è‡ªå·±çš„ä¸šåŠ¡è§„åˆ™
âœ“ å¯ä»¥ç‹¬ç«‹å¼€å‘éƒ¨ç½²

å®é™…ä½“ç°ï¼š
è®¢å•ä¸Šä¸‹æ–‡ â†â†’ ç‹¬ç«‹çš„è®¢å•æ•°æ®åº“
ç”¨æˆ·ä¸Šä¸‹æ–‡ â†â†’ ç‹¬ç«‹çš„ç”¨æˆ·æ•°æ®åº“
åº“å­˜ä¸Šä¸‹æ–‡ â†â†’ ç‹¬ç«‹çš„åº“å­˜æ•°æ®åº“
```

**ğŸ”¹ ä¸€è‡´æ€§**
```
åœ¨ä¸Šä¸‹æ–‡å†…éƒ¨ï¼š
- æ‰€æœ‰æœ¯è¯­å«ä¹‰ç»Ÿä¸€
- ä¸šåŠ¡è§„åˆ™ä¿æŒä¸€è‡´
- æ•°æ®æ¨¡å‹ç»“æ„ç¨³å®š

è·¨ä¸Šä¸‹æ–‡ï¼š
- å…è®¸æ¦‚å¿µå«ä¹‰ä¸åŒ
- é€šè¿‡æ¥å£è¿›è¡Œäº¤äº’
- ä¿æŒå„è‡ªç‹¬ç«‹æ¼”è¿›
```

---

## 2. ğŸ”— ä¸Šä¸‹æ–‡æ˜ å°„æ¨¡å¼è¯¦è§£


### 2.1 ä¸Šä¸‹æ–‡æ˜ å°„æ¦‚è¿°


**ğŸ”¸ ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡æ˜ å°„**
ä¸Šä¸‹æ–‡æ˜ å°„å°±æ˜¯**å®šä¹‰ä¸åŒé™ç•Œä¸Šä¸‹æ–‡ä¹‹é—´å¦‚ä½•åä½œ**çš„è§„åˆ™å’Œæ¨¡å¼ã€‚

```
ç±»æ¯”ï¼šéƒ¨é—¨é—´çš„åä½œæ–¹å¼

è´¢åŠ¡éƒ¨ â†â†’ é”€å”®éƒ¨ï¼šå®¢æˆ·ä¾›åº”å•†å…³ç³»ï¼ˆè´¢åŠ¡ä¾èµ–é”€å”®çš„æ•°æ®ï¼‰
æŠ€æœ¯éƒ¨ â†â†’ äº§å“éƒ¨ï¼šåˆä½œä¼™ä¼´å…³ç³»ï¼ˆå…±åŒå®šä¹‰éœ€æ±‚ï¼‰
æ³•åŠ¡éƒ¨ â†â†’ å„éƒ¨é—¨ï¼šå¼€æ”¾ä¸»æœºå…³ç³»ï¼ˆæä¾›æ³•å¾‹å’¨è¯¢æœåŠ¡ï¼‰
```

### 2.2 å…±äº«å†…æ ¸ï¼ˆShared Kernelï¼‰


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µ**
ä¸¤ä¸ªæˆ–å¤šä¸ªä¸Šä¸‹æ–‡**å…±äº«ä¸€éƒ¨åˆ†é¢†åŸŸæ¨¡å‹**ï¼Œè¿™éƒ¨åˆ†æ¨¡å‹å¯¹æ‰€æœ‰å‚ä¸æ–¹éƒ½å¾ˆé‡è¦ã€‚

**ğŸ”¸ ä½¿ç”¨åœºæ™¯**
```
é€‚ç”¨æƒ…å†µï¼š
âœ“ ç´§å¯†åä½œçš„å›¢é˜Ÿ
âœ“ æ ¸å¿ƒå…±äº«æ¦‚å¿µ
âœ“ å˜æ›´éœ€è¦åè°ƒ

å®é™…ä¾‹å­ï¼š
ç”µå•†ç³»ç»Ÿä¸­çš„"å•†å“åŸºç¡€ä¿¡æ¯"
- å•†å“å±•ç¤ºä¸Šä¸‹æ–‡éœ€è¦ï¼šåç§°ã€å›¾ç‰‡ã€æè¿°
- åº“å­˜ç®¡ç†ä¸Šä¸‹æ–‡éœ€è¦ï¼šåç§°ã€SKUã€åˆ†ç±»
- è®¢å•å¤„ç†ä¸Šä¸‹æ–‡éœ€è¦ï¼šåç§°ã€ä»·æ ¼ã€SKU

å…±äº«å†…æ ¸ï¼šProduct(id, name, sku)
```

**ğŸ”¸ å®ç°æ–¹å¼**
```java
// å…±äº«å†…æ ¸ - åŸºç¡€å•†å“ä¿¡æ¯
public class SharedProduct {
    private String productId;
    private String productName;
    private String sku;
    private ProductCategory category;
    
    // åªåŒ…å«æ‰€æœ‰ä¸Šä¸‹æ–‡éƒ½è®¤åŒçš„åŸºç¡€å±æ€§
}

// å•†å“å±•ç¤ºä¸Šä¸‹æ–‡æ‰©å±•
public class DisplayProduct extends SharedProduct {
    private List<String> images;
    private String description;
    private double rating;
}

// åº“å­˜ç®¡ç†ä¸Šä¸‹æ–‡æ‰©å±•
public class InventoryProduct extends SharedProduct {
    private int stockQuantity;
    private String warehouseLocation;
    private int safetyStock;
}
```

**âš ï¸ æ³¨æ„äº‹é¡¹**
```
å…±äº«å†…æ ¸çš„é£é™©ï¼š
- å˜æ›´éœ€è¦æ‰€æœ‰å›¢é˜Ÿåè°ƒ
- å¯èƒ½é€ æˆå¼ºè€¦åˆ
- éœ€è¦ä¸¥æ ¼çš„ç‰ˆæœ¬ç®¡ç†

å»ºè®®ï¼š
- ä¿æŒå…±äº«å†…æ ¸å°½å¯èƒ½å°
- å»ºç«‹å˜æ›´å®¡æ‰¹æµç¨‹
- å®šæœŸè¯„ä¼°æ˜¯å¦è¿˜éœ€è¦å…±äº«
```

### 2.3 å®¢æˆ·ä¾›åº”å•†æ¨¡å¼ï¼ˆCustomer-Supplierï¼‰


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µ**
ä¸€ä¸ªä¸Šä¸‹æ–‡ï¼ˆä¾›åº”å•†ï¼‰ä¸ºå¦ä¸€ä¸ªä¸Šä¸‹æ–‡ï¼ˆå®¢æˆ·ï¼‰æä¾›æœåŠ¡ï¼Œ**å®¢æˆ·çš„éœ€æ±‚ä¼šå½±å“ä¾›åº”å•†çš„è§„åˆ’**ã€‚

**ğŸ”¸ å®é™…åº”ç”¨åœºæ™¯**
```
å…¸å‹å…³ç³»ï¼š
è®¢å•ç³»ç»Ÿï¼ˆå®¢æˆ·ï¼‰ â†â†’ åº“å­˜ç³»ç»Ÿï¼ˆä¾›åº”å•†ï¼‰
è¥é”€ç³»ç»Ÿï¼ˆå®¢æˆ·ï¼‰ â†â†’ ç”¨æˆ·ç³»ç»Ÿï¼ˆä¾›åº”å•†ï¼‰
æ¨èç³»ç»Ÿï¼ˆå®¢æˆ·ï¼‰ â†â†’ è¡Œä¸ºåˆ†æç³»ç»Ÿï¼ˆä¾›åº”å•†ï¼‰

åä½œæ–¹å¼ï¼š
- ä¾›åº”å•†æä¾›APIæ¥å£
- å®¢æˆ·æå‡ºåŠŸèƒ½éœ€æ±‚
- åŒæ–¹åå•†æ¥å£è®¾è®¡
- ä¾›åº”å•†æŒ‰éœ€æ±‚å¼€å‘
```

**ğŸ”¸ å®ç°ç¤ºä¾‹**
```java
// ä¾›åº”å•†ï¼šåº“å­˜ç³»ç»Ÿå¯¹å¤–æ¥å£
@RestController
public class InventoryController {
    
    // ä¸ºè®¢å•ç³»ç»Ÿæä¾›åº“å­˜æ£€æŸ¥
    @GetMapping("/api/inventory/check")
    public InventoryCheckResult checkInventory(
        @RequestParam String productId, 
        @RequestParam int quantity) {
        
        return inventoryService.checkAvailability(productId, quantity);
    }
    
    // ä¸ºè®¢å•ç³»ç»Ÿæä¾›åº“å­˜é¢„ç•™
    @PostMapping("/api/inventory/reserve")
    public ReservationResult reserveInventory(
        @RequestBody ReservationRequest request) {
        
        return inventoryService.reserveStock(request);
    }
}

// å®¢æˆ·ï¼šè®¢å•ç³»ç»Ÿè°ƒç”¨åº“å­˜æœåŠ¡
@Service
public class OrderService {
    
    @Autowired
    private InventoryClient inventoryClient;
    
    public OrderResult createOrder(CreateOrderRequest request) {
        // æ£€æŸ¥åº“å­˜
        InventoryCheckResult checkResult = 
            inventoryClient.checkInventory(
                request.getProductId(), 
                request.getQuantity());
                
        if (!checkResult.isAvailable()) {
            return OrderResult.failed("åº“å­˜ä¸è¶³");
        }
        
        // é¢„ç•™åº“å­˜
        ReservationResult reservation = 
            inventoryClient.reserveInventory(
                new ReservationRequest(request));
                
        // åˆ›å»ºè®¢å•...
    }
}
```

### 2.4 é˜²è…å±‚ï¼ˆAnti-Corruption Layerï¼‰


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µ**
é˜²è…å±‚å°±åƒæ˜¯**ç¿»è¯‘å™¨**ï¼Œä¿æŠ¤è‡ªå·±çš„ä¸Šä¸‹æ–‡ä¸è¢«å¤–éƒ¨ç³»ç»Ÿçš„å¤æ‚æ€§"æ±¡æŸ“"ã€‚

**ğŸ”¸ ä½¿ç”¨åœºæ™¯**
```
å…¸å‹æƒ…å†µï¼š
âœ“ é›†æˆé—ç•™ç³»ç»Ÿ
âœ“ å¯¹æ¥ç¬¬ä¸‰æ–¹æœåŠ¡
âœ“ ä¿æŠ¤æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
âœ“ å¤–éƒ¨ç³»ç»Ÿç»“æ„å¤æ‚

å®é™…ä¾‹å­ï¼š
æ–°ç”µå•†ç³»ç»Ÿ â†â†’ è€ERPç³»ç»Ÿ
- è€ERPæ•°æ®ç»“æ„å¤æ‚æ··ä¹±
- æ–°ç³»ç»Ÿéœ€è¦ä¿æŒæ¨¡å‹æ¸…æ´
- é€šè¿‡é˜²è…å±‚è¿›è¡Œè½¬æ¢
```

**ğŸ”¸ å®ç°æ¨¡å¼**
```java
// å¤–éƒ¨ç³»ç»Ÿå¤æ‚çš„æ•°æ®ç»“æ„
public class LegacyCustomerData {
    public String cust_id_num;
    public String cust_full_name_txt;
    public String cust_addr_line1_txt;
    public String cust_addr_line2_txt;
    public String cust_phone_primary_num;
    public String cust_status_code;
    // ... 50å¤šä¸ªå­—æ®µ
}

// æˆ‘ä»¬ç³»ç»Ÿçš„ç®€æ´æ¨¡å‹
public class Customer {
    private String customerId;
    private String fullName;
    private Address address;
    private String phoneNumber;
    private CustomerStatus status;
}

// é˜²è…å±‚è½¬æ¢å™¨
@Component
public class CustomerAntiCorruptionLayer {
    
    public Customer translateFromLegacy(LegacyCustomerData legacyData) {
        return Customer.builder()
            .customerId(legacyData.cust_id_num)
            .fullName(legacyData.cust_full_name_txt)
            .address(buildAddress(legacyData))
            .phoneNumber(legacyData.cust_phone_primary_num)
            .status(translateStatus(legacyData.cust_status_code))
            .build();
    }
    
    private Address buildAddress(LegacyCustomerData data) {
        return new Address(
            data.cust_addr_line1_txt + " " + data.cust_addr_line2_txt
        );
    }
    
    private CustomerStatus translateStatus(String statusCode) {
        // å¤æ‚çš„çŠ¶æ€ç è½¬æ¢é€»è¾‘
        switch (statusCode) {
            case "ACT": return CustomerStatus.ACTIVE;
            case "INA": return CustomerStatus.INACTIVE;
            default: return CustomerStatus.UNKNOWN;
        }
    }
}
```

### 2.5 å¼€æ”¾ä¸»æœºæœåŠ¡ï¼ˆOpen Host Serviceï¼‰


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µ**
ä¸€ä¸ªä¸Šä¸‹æ–‡å®šä¹‰**ç»Ÿä¸€çš„åè®®å’Œæ¥å£**ï¼Œä¸ºå¤šä¸ªå…¶ä»–ä¸Šä¸‹æ–‡æä¾›æœåŠ¡ã€‚

**ğŸ”¸ åº”ç”¨åœºæ™¯**
```
å…¸å‹ä½¿ç”¨ï¼š
- ç”¨æˆ·è®¤è¯æœåŠ¡
- æ”¯ä»˜å¤„ç†æœåŠ¡  
- é€šçŸ¥å‘é€æœåŠ¡
- é…ç½®ç®¡ç†æœåŠ¡

ç‰¹ç‚¹ï¼š
âœ“ ä¸€å¯¹å¤šçš„æœåŠ¡å…³ç³»
âœ“ æ ‡å‡†åŒ–çš„æ¥å£åè®®
âœ“ ç‹¬ç«‹æ¼”è¿›å’Œç»´æŠ¤
```

**ğŸ”¸ å®ç°ç¤ºä¾‹**
```java
// å¼€æ”¾ä¸»æœºæœåŠ¡ï¼šé€šçŸ¥æœåŠ¡
@RestController
@RequestMapping("/api/notification")
public class NotificationOpenHostService {
    
    // æ ‡å‡†åŒ–çš„é€šçŸ¥æ¥å£
    @PostMapping("/send")
    public NotificationResponse sendNotification(
        @RequestBody NotificationRequest request) {
        
        // éªŒè¯è¯·æ±‚
        if (!isValidRequest(request)) {
            return NotificationResponse.error("Invalid request");
        }
        
        // æ ¹æ®ç±»å‹åˆ†å‘
        switch (request.getType()) {
            case EMAIL:
                return emailService.send(request);
            case SMS:
                return smsService.send(request);
            case PUSH:
                return pushService.send(request);
            default:
                return NotificationResponse.error("Unsupported type");
        }
    }
    
    // è·å–å‘é€çŠ¶æ€
    @GetMapping("/status/{notificationId}")
    public NotificationStatus getStatus(@PathVariable String notificationId) {
        return notificationService.getStatus(notificationId);
    }
}

// æ ‡å‡†åŒ–çš„è¯·æ±‚å“åº”æ¨¡å‹
public class NotificationRequest {
    private String recipient;      // æ¥æ”¶è€…
    private NotificationType type; // é€šçŸ¥ç±»å‹
    private String title;          // æ ‡é¢˜
    private String content;        // å†…å®¹
    private Map<String, String> metadata; // æ‰©å±•ä¿¡æ¯
}
```

---

## 3. âœ‚ï¸ é™ç•Œä¸Šä¸‹æ–‡çš„åˆ’åˆ†å®è·µ


### 3.1 åˆ’åˆ†åŸåˆ™ä¸æ–¹æ³•


**ğŸ”¸ ä¸šåŠ¡èƒ½åŠ›é©±åŠ¨**
```
æ ¸å¿ƒåŸåˆ™ï¼šæŒ‰ç…§ä¸šåŠ¡èƒ½åŠ›æ¥åˆ’åˆ†ä¸Šä¸‹æ–‡

ç”µå•†ç³»ç»Ÿç¤ºä¾‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å•†å“ç®¡ç†   â”‚  â”‚   è®¢å•å¤„ç†   â”‚  â”‚   æ”¯ä»˜ç»“ç®—   â”‚
â”‚             â”‚  â”‚             â”‚  â”‚             â”‚
â”‚ å•†å“ä¿¡æ¯ç»´æŠ¤ â”‚  â”‚ è®¢å•åˆ›å»ºç®¡ç† â”‚  â”‚ æ”¯ä»˜æµç¨‹    â”‚
â”‚ åˆ†ç±»ç®¡ç†    â”‚  â”‚ åº“å­˜æ£€æŸ¥    â”‚  â”‚ è´¦å•ç”Ÿæˆ    â”‚
â”‚ ä»·æ ¼ç­–ç•¥    â”‚  â”‚ ä¼˜æƒ è®¡ç®—    â”‚  â”‚ å¯¹è´¦å¤„ç†    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ¯ä¸ªæ¡†å†…çš„åŠŸèƒ½é«˜åº¦ç›¸å…³ï¼Œæ¡†é—´è€¦åˆåº¦ä½
```

**ğŸ”¸ æ•°æ®ä¸€è‡´æ€§è¾¹ç•Œ**
```
åŒä¸€äº‹åŠ¡è¾¹ç•Œå†…çš„æ•°æ® â†’ åŒä¸€ä¸ªä¸Šä¸‹æ–‡
éœ€è¦æœ€ç»ˆä¸€è‡´æ€§çš„æ•°æ® â†’ ä¸åŒä¸Šä¸‹æ–‡

å¼ºä¸€è‡´æ€§è¦æ±‚ï¼š
è®¢å•ä¿¡æ¯ + è®¢å•æ˜ç»† â†’ è®¢å•ä¸Šä¸‹æ–‡

æœ€ç»ˆä¸€è‡´æ€§å¯æ¥å—ï¼š
è®¢å•åˆ›å»º + åº“å­˜æ‰£å‡ â†’ ä¸åŒä¸Šä¸‹æ–‡
é€šè¿‡äº‹ä»¶å¼‚æ­¥åŒæ­¥
```

**ğŸ”¸ å›¢é˜Ÿç»„ç»‡ç»“æ„**
```
åº·å¨å®šå¾‹ï¼šç»„ç»‡æ¶æ„å†³å®šç³»ç»Ÿæ¶æ„

å®é™…åº”ç”¨ï¼š
- ä¸€ä¸ªå›¢é˜Ÿè´Ÿè´£ä¸€ä¸ªä¸Šä¸‹æ–‡
- å›¢é˜Ÿæœ‰æ˜ç¡®çš„ä¸šåŠ¡è¾¹ç•Œ
- å‡å°‘è·¨å›¢é˜Ÿåä½œçš„å¤æ‚åº¦

å›¢é˜Ÿåˆ’åˆ†ç¤ºä¾‹ï¼š
Frontend Team  â†’ ç”¨æˆ·ç•Œé¢ä¸Šä¸‹æ–‡
Product Team   â†’ å•†å“ç®¡ç†ä¸Šä¸‹æ–‡  
Order Team     â†’ è®¢å•å¤„ç†ä¸Šä¸‹æ–‡
Payment Team   â†’ æ”¯ä»˜ç»“ç®—ä¸Šä¸‹æ–‡
```

### 3.2 è¯†åˆ«é™ç•Œä¸Šä¸‹æ–‡çš„æ­¥éª¤


**ğŸ”¸ ç¬¬ä¸€æ­¥ï¼šæ¢³ç†ä¸šåŠ¡æµç¨‹**
```
ä»¥ç”µå•†ä¸ºä¾‹çš„ä¸šåŠ¡æµç¨‹ï¼š

ç”¨æˆ·æ³¨å†Œç™»å½• â†’ æµè§ˆå•†å“ â†’ åŠ å…¥è´­ç‰©è½¦ â†’ ä¸‹å•æ”¯ä»˜ â†’ 
è®¢å•å¤„ç† â†’ åº“å­˜æ‰£å‡ â†’ ç‰©æµé…é€ â†’ æ”¶è´§ç¡®è®¤ â†’ 
å”®åæœåŠ¡ â†’ è¯„ä»·åé¦ˆ

å°†æµç¨‹æ‹†è§£ä¸ºç‹¬ç«‹çš„ä¸šåŠ¡æ´»åŠ¨
```

**ğŸ”¸ ç¬¬äºŒæ­¥ï¼šè¯†åˆ«æ ¸å¿ƒæ¦‚å¿µ**
```
æå–å…³é”®ä¸šåŠ¡æ¦‚å¿µï¼š

ç”¨æˆ·ç›¸å…³ï¼šç”¨æˆ·ã€è´¦æˆ·ã€æƒé™ã€åå¥½
å•†å“ç›¸å…³ï¼šå•†å“ã€åˆ†ç±»ã€ä»·æ ¼ã€åº“å­˜
äº¤æ˜“ç›¸å…³ï¼šè®¢å•ã€æ”¯ä»˜ã€ä¼˜æƒ åˆ¸ã€å‘ç¥¨
ç‰©æµç›¸å…³ï¼šé…é€ã€åœ°å€ã€ç‰©æµå•†ã€è¿è´¹
æœåŠ¡ç›¸å…³ï¼šå®¢æœã€æŠ•è¯‰ã€é€€æ¢è´§ã€è¯„ä»·

æ¦‚å¿µçš„èŒè´£è¾¹ç•Œè¦æ¸…æ™°
```

**ğŸ”¸ ç¬¬ä¸‰æ­¥ï¼šåˆ†ææ¦‚å¿µå…³ç³»**
```
æ¦‚å¿µå…³ç³»çŸ©é˜µï¼š

        ç”¨æˆ·  å•†å“  è®¢å•  æ”¯ä»˜  ç‰©æµ
ç”¨æˆ·     å¼º    å¼±    å¼º    å¼±    å¼±
å•†å“     å¼±    å¼º    å¼º    æ—     æ—   
è®¢å•     å¼º    å¼º    å¼º    å¼º    å¼º
æ”¯ä»˜     å¼±    æ—     å¼º    å¼º    æ— 
ç‰©æµ     å¼±    æ—     å¼º    æ—     å¼º

å¼ºå…³è”çš„æ¦‚å¿µå½’å…¥åŒä¸€ä¸Šä¸‹æ–‡
```

**ğŸ”¸ ç¬¬å››æ­¥ï¼šç¡®å®šä¸Šä¸‹æ–‡è¾¹ç•Œ**
```
æ ¹æ®åˆ†æç»“æœåˆ’åˆ†ï¼š

ç”¨æˆ·ç®¡ç†ä¸Šä¸‹æ–‡ï¼šç”¨æˆ·ã€è´¦æˆ·ã€æƒé™
å•†å“ç®¡ç†ä¸Šä¸‹æ–‡ï¼šå•†å“ã€åˆ†ç±»ã€ä»·æ ¼ã€åº“å­˜  
è®¢å•å¤„ç†ä¸Šä¸‹æ–‡ï¼šè®¢å•ã€è®¢å•é¡¹ã€è®¢å•çŠ¶æ€
æ”¯ä»˜ç»“ç®—ä¸Šä¸‹æ–‡ï¼šæ”¯ä»˜ã€è´¦å•ã€å¯¹è´¦
ç‰©æµé…é€ä¸Šä¸‹æ–‡ï¼šé…é€ã€åœ°å€ã€ç‰©æµè·Ÿè¸ª

æ¯ä¸ªä¸Šä¸‹æ–‡èŒè´£å•ä¸€ï¼Œè¾¹ç•Œæ¸…æ™°
```

### 3.3 å®é™…é¡¹ç›®ä¸­çš„åˆ’åˆ†æ¡ˆä¾‹


**ğŸ”¸ ç”µå•†å¹³å°çš„å®Œæ•´åˆ’åˆ†**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ç”µå•†å¹³å°                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ ç”¨æˆ·ç®¡ç†ä¸Šä¸‹æ–‡ â”‚  â”‚ å•†å“ç®¡ç†ä¸Šä¸‹æ–‡ â”‚  â”‚ è¥é”€ç®¡ç†ä¸Šä¸‹æ–‡ â”‚              â”‚
â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚              â”‚
â”‚  â”‚ â€¢ ç”¨æˆ·æ³¨å†Œ   â”‚  â”‚ â€¢ å•†å“ä¿¡æ¯   â”‚  â”‚ â€¢ ä¼˜æƒ åˆ¸     â”‚              â”‚
â”‚  â”‚ â€¢ ç™»å½•è®¤è¯   â”‚  â”‚ â€¢ åˆ†ç±»ç®¡ç†   â”‚  â”‚ â€¢ ä¿ƒé”€æ´»åŠ¨   â”‚              â”‚
â”‚  â”‚ â€¢ æƒé™ç®¡ç†   â”‚  â”‚ â€¢ ä»·æ ¼ç­–ç•¥   â”‚  â”‚ â€¢ æ¨èç®—æ³•   â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ è®¢å•å¤„ç†ä¸Šä¸‹æ–‡ â”‚  â”‚ æ”¯ä»˜ç»“ç®—ä¸Šä¸‹æ–‡ â”‚  â”‚ åº“å­˜ç®¡ç†ä¸Šä¸‹æ–‡ â”‚              â”‚
â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚              â”‚
â”‚  â”‚ â€¢ è®¢å•åˆ›å»º   â”‚  â”‚ â€¢ æ”¯ä»˜æµç¨‹   â”‚  â”‚ â€¢ åº“å­˜ç›‘æ§   â”‚              â”‚
â”‚  â”‚ â€¢ çŠ¶æ€ç®¡ç†   â”‚  â”‚ â€¢ è´¦å•ç”Ÿæˆ   â”‚  â”‚ â€¢ è¡¥è´§ç­–ç•¥   â”‚              â”‚
â”‚  â”‚ â€¢ è®¢å•æŸ¥è¯¢   â”‚  â”‚ â€¢ å¯¹è´¦å¤„ç†   â”‚  â”‚ â€¢ ä»“å‚¨ç®¡ç†   â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚ ç‰©æµé…é€ä¸Šä¸‹æ–‡ â”‚  â”‚ å®¢æœå”®åä¸Šä¸‹æ–‡ â”‚                               â”‚
â”‚  â”‚             â”‚  â”‚             â”‚                               â”‚
â”‚  â”‚ â€¢ é…é€ç®¡ç†   â”‚  â”‚ â€¢ æŠ•è¯‰å¤„ç†   â”‚                               â”‚
â”‚  â”‚ â€¢ ç‰©æµè·Ÿè¸ª   â”‚  â”‚ â€¢ é€€æ¢è´§     â”‚                               â”‚
â”‚  â”‚ â€¢ åœ°å€ç®¡ç†   â”‚  â”‚ â€¢ å®¢æˆ·æœåŠ¡   â”‚                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”¸ ä¸Šä¸‹æ–‡é—´çš„åä½œå…³ç³»**
```
åä½œå…³ç³»å›¾ï¼š

ç”¨æˆ·ç®¡ç† â†â”€â”€â”€â”€â”€â†’ è®¢å•å¤„ç† ï¼ˆå®¢æˆ·ä¾›åº”å•†ï¼‰
   â†“
å•†å“ç®¡ç† â†â”€â”€â”€â”€â”€â†’ è®¢å•å¤„ç† ï¼ˆå®¢æˆ·ä¾›åº”å•†ï¼‰
   â†“
åº“å­˜ç®¡ç† â†â”€â”€â”€â”€â”€â†’ è®¢å•å¤„ç† ï¼ˆå®¢æˆ·ä¾›åº”å•†ï¼‰
   â†“
è®¢å•å¤„ç† â†â”€â”€â”€â”€â”€â†’ æ”¯ä»˜ç»“ç®— ï¼ˆåˆä½œä¼™ä¼´ï¼‰
   â†“
è®¢å•å¤„ç† â†â”€â”€â”€â”€â”€â†’ ç‰©æµé…é€ ï¼ˆå®¢æˆ·ä¾›åº”å•†ï¼‰

è¥é”€ç®¡ç† â†â”€â”€â”€â”€â”€â†’ å¤šä¸ªä¸Šä¸‹æ–‡ ï¼ˆå¼€æ”¾ä¸»æœºæœåŠ¡ï¼‰
```

---

## 4. ğŸ”„ ä¸Šä¸‹æ–‡é›†æˆç­–ç•¥


### 4.1 åŒæ­¥é›†æˆæ¨¡å¼


**ğŸ”¸ REST APIè°ƒç”¨**
```java
// è®¢å•æœåŠ¡è°ƒç”¨åº“å­˜æœåŠ¡
@Service
public class OrderService {
    
    @Autowired
    private InventoryServiceClient inventoryClient;
    
    public OrderResult createOrder(CreateOrderRequest request) {
        try {
            // åŒæ­¥æ£€æŸ¥åº“å­˜
            InventoryCheckResponse response = inventoryClient
                .checkInventory(request.getProductId(), request.getQuantity());
                
            if (!response.isAvailable()) {
                return OrderResult.failed("åº“å­˜ä¸è¶³");
            }
            
            // åˆ›å»ºè®¢å•
            Order order = buildOrder(request);
            orderRepository.save(order);
            
            // åŒæ­¥æ‰£å‡åº“å­˜
            inventoryClient.reduceInventory(
                request.getProductId(), 
                request.getQuantity()
            );
            
            return OrderResult.success(order);
            
        } catch (Exception e) {
            // å¤„ç†å¼‚å¸¸ï¼Œå¯èƒ½éœ€è¦å›æ»š
            log.error("åˆ›å»ºè®¢å•å¤±è´¥", e);
            return OrderResult.failed("ç³»ç»Ÿå¼‚å¸¸");
        }
    }
}
```

**ğŸ”¸ é€‚ç”¨åœºæ™¯ä¸æ³¨æ„äº‹é¡¹**
```
é€‚ç”¨åœºæ™¯ï¼š
âœ“ éœ€è¦ç«‹å³è·å–ç»“æœ
âœ“ ä¸šåŠ¡æµç¨‹ç›¸å¯¹ç®€å•
âœ“ ç½‘ç»œå»¶è¿Ÿè¦æ±‚ä¸é«˜

æ³¨æ„äº‹é¡¹ï¼š
âš ï¸ æœåŠ¡å¯ç”¨æ€§ä¾èµ–
âš ï¸ æ€§èƒ½å½±å“ï¼ˆç½‘ç»œå»¶è¿Ÿï¼‰
âš ï¸ é”™è¯¯å¤„ç†å¤æ‚
âš ï¸ å¯èƒ½é€ æˆçº§è”æ•…éšœ
```

### 4.2 å¼‚æ­¥é›†æˆæ¨¡å¼


**ğŸ”¸ äº‹ä»¶é©±åŠ¨æ¶æ„**
```java
// è®¢å•åˆ›å»ºäº‹ä»¶
public class OrderCreatedEvent {
    private String orderId;
    private String customerId;
    private List<OrderItem> items;
    private LocalDateTime createdAt;
    // getter/setter...
}

// è®¢å•æœåŠ¡å‘å¸ƒäº‹ä»¶
@Service
public class OrderService {
    
    @Autowired
    private ApplicationEventPublisher eventPublisher;
    
    public OrderResult createOrder(CreateOrderRequest request) {
        // åˆ›å»ºè®¢å•
        Order order = buildOrder(request);
        orderRepository.save(order);
        
        // å‘å¸ƒäº‹ä»¶ï¼ˆå¼‚æ­¥å¤„ç†ï¼‰
        OrderCreatedEvent event = new OrderCreatedEvent(order);
        eventPublisher.publishEvent(event);
        
        return OrderResult.success(order);
    }
}

// åº“å­˜æœåŠ¡ç›‘å¬äº‹ä»¶
@Component
public class InventoryEventListener {
    
    @EventListener
    @Async
    public void handleOrderCreated(OrderCreatedEvent event) {
        try {
            // å¼‚æ­¥æ‰£å‡åº“å­˜
            for (OrderItem item : event.getItems()) {
                inventoryService.reduceInventory(
                    item.getProductId(), 
                    item.getQuantity()
                );
            }
        } catch (Exception e) {
            log.error("åº“å­˜æ‰£å‡å¤±è´¥ï¼Œè®¢å•ID: {}", event.getOrderId(), e);
            // å‘å¸ƒåº“å­˜æ‰£å‡å¤±è´¥äº‹ä»¶ï¼Œè§¦å‘è¡¥å¿æœºåˆ¶
        }
    }
}
```

**ğŸ”¸ æ¶ˆæ¯é˜Ÿåˆ—é›†æˆ**
```java
// ä½¿ç”¨RabbitMQè¿›è¡Œå¼‚æ­¥é€šä¿¡
@Component
public class OrderEventPublisher {
    
    @Autowired
    private RabbitTemplate rabbitTemplate;
    
    public void publishOrderCreated(Order order) {
        OrderCreatedEvent event = new OrderCreatedEvent(order);
        
        rabbitTemplate.convertAndSend(
            "order.exchange",
            "order.created", 
            event
        );
    }
}

// åº“å­˜æœåŠ¡æ¶ˆè´¹æ¶ˆæ¯
@RabbitListener(queues = "inventory.order.queue")
@Component
public class InventoryMessageConsumer {
    
    public void handleOrderCreated(OrderCreatedEvent event) {
        // å¤„ç†åº“å­˜æ‰£å‡
        inventoryService.processOrderCreated(event);
    }
}
```

### 4.3 æ•°æ®ä¸€è‡´æ€§ä¿è¯


**ğŸ”¸ Sagaæ¨¡å¼å¤„ç†åˆ†å¸ƒå¼äº‹åŠ¡**
```java
// è®¢å•å¤„ç†Saga
@Component
public class OrderProcessingSaga {
    
    public void processOrder(CreateOrderRequest request) {
        SagaTransaction saga = SagaTransaction.create("order-processing");
        
        try {
            // æ­¥éª¤1ï¼šåˆ›å»ºè®¢å•
            saga.addStep("create-order", () -> {
                Order order = orderService.createOrder(request);
                return order.getId();
            }, (orderId) -> {
                orderService.cancelOrder((String) orderId);
            });
            
            // æ­¥éª¤2ï¼šæ‰£å‡åº“å­˜  
            saga.addStep("reduce-inventory", () -> {
                return inventoryService.reduceInventory(
                    request.getProductId(), 
                    request.getQuantity()
                );
            }, (reservationId) -> {
                inventoryService.releaseReservation((String) reservationId);
            });
            
            // æ­¥éª¤3ï¼šå¤„ç†æ”¯ä»˜
            saga.addStep("process-payment", () -> {
                return paymentService.processPayment(request.getPaymentInfo());
            }, (paymentId) -> {
                paymentService.refundPayment((String) paymentId);
            });
            
            // æ‰§è¡Œæ‰€æœ‰æ­¥éª¤
            saga.execute();
            
        } catch (Exception e) {
            // è‡ªåŠ¨æ‰§è¡Œè¡¥å¿æ“ä½œ
            saga.compensate();
            throw new OrderProcessingException("è®¢å•å¤„ç†å¤±è´¥", e);
        }
    }
}
```

---

## 5. ğŸ› ï¸ å®é™…é¡¹ç›®åº”ç”¨æŒ‡å—


### 5.1 ä»å•ä½“åˆ°å¾®æœåŠ¡çš„è¿ç§»


**ğŸ”¸ æ¸è¿›å¼æ‹†åˆ†ç­–ç•¥**
```
è¿ç§»æ­¥éª¤ï¼š

ç¬¬ä¸€é˜¶æ®µï¼šè¯†åˆ«é™ç•Œä¸Šä¸‹æ–‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          å•ä½“åº”ç”¨                â”‚
â”‚                                â”‚
â”‚  [ç”¨æˆ·æ¨¡å—] [å•†å“æ¨¡å—] [è®¢å•æ¨¡å—]  â”‚
â”‚  [æ”¯ä»˜æ¨¡å—] [åº“å­˜æ¨¡å—] [ç‰©æµæ¨¡å—]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬äºŒé˜¶æ®µï¼šæ¨¡å—åŒ–é‡æ„
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          å•ä½“åº”ç”¨                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç”¨æˆ·æœåŠ¡ â”‚ å•†å“æœåŠ¡ â”‚ è®¢å•æœåŠ¡     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ”¯ä»˜æœåŠ¡ â”‚ åº“å­˜æœåŠ¡ â”‚ ç‰©æµæœåŠ¡     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬ä¸‰é˜¶æ®µï¼šå¾®æœåŠ¡æ‹†åˆ†
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·æœåŠ¡ â”‚ â”‚ å•†å“æœåŠ¡ â”‚ â”‚ è®¢å•æœåŠ¡ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ”¯ä»˜æœåŠ¡ â”‚ â”‚ åº“å­˜æœåŠ¡ â”‚ â”‚ ç‰©æµæœåŠ¡ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”¸ æ‹†åˆ†ä¼˜å…ˆçº§åˆ¤æ–­**
```
ä¼˜å…ˆæ‹†åˆ†çš„æ¨¡å—ï¼š
ğŸ”´ é«˜ä¼˜å…ˆçº§ï¼š
- ä¸šåŠ¡å˜åŒ–é¢‘ç¹çš„æ¨¡å—
- æ€§èƒ½ç“¶é¢ˆæ˜æ˜¾çš„æ¨¡å—  
- å›¢é˜Ÿè¾¹ç•Œæ¸…æ™°çš„æ¨¡å—
- æŠ€æœ¯æ ˆéœ€è¦ç‹¬ç«‹çš„æ¨¡å—

ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ï¼š
- æ•°æ®é‡å¤§çš„æ¨¡å—
- æœ‰æ˜ç¡®ä¸šåŠ¡è¾¹ç•Œçš„æ¨¡å—

ğŸŸ¢ ä½ä¼˜å…ˆçº§ï¼š  
- ä¸šåŠ¡ç¨³å®šçš„æ¨¡å—
- å˜æ›´é¢‘ç‡ä½çš„æ¨¡å—
- å¼ºä¾èµ–å…¶ä»–æ¨¡å—çš„åŠŸèƒ½
```

### 5.2 å›¢é˜Ÿåä½œæ¨¡å¼


**ğŸ”¸ è·¨ä¸Šä¸‹æ–‡åä½œæµç¨‹**
```
æ¥å£å˜æ›´åä½œæµç¨‹ï¼š

Step 1: éœ€æ±‚æå‡º
å®¢æˆ·ä¸Šä¸‹æ–‡å›¢é˜Ÿ â†’ æå‡ºæ¥å£éœ€æ±‚

Step 2: éœ€æ±‚è¯„ä¼°  
ä¾›åº”å•†ä¸Šä¸‹æ–‡å›¢é˜Ÿ â†’ è¯„ä¼°æŠ€æœ¯å¯è¡Œæ€§

Step 3: æ¥å£è®¾è®¡
åŒæ–¹å›¢é˜Ÿ â†’ å…±åŒè®¾è®¡æ¥å£è§„èŒƒ

Step 4: å¼€å‘è®¡åˆ’
ä¾›åº”å•†å›¢é˜Ÿ â†’ åˆ¶å®šå¼€å‘è®¡åˆ’
å®¢æˆ·å›¢é˜Ÿ â†’ åˆ¶å®šé€‚é…è®¡åˆ’

Step 5: å¹¶è¡Œå¼€å‘
ä¾›åº”å•†å›¢é˜Ÿ â†’ å¼€å‘æ¥å£åŠŸèƒ½
å®¢æˆ·å›¢é˜Ÿ â†’ å¼€å‘è°ƒç”¨é€»è¾‘ï¼ˆä½¿ç”¨Mockï¼‰

Step 6: è”è°ƒæµ‹è¯•
åŒæ–¹å›¢é˜Ÿ â†’ è”åˆæµ‹è¯•éªŒè¯

Step 7: ä¸Šçº¿éƒ¨ç½²
ä¾›åº”å•†å…ˆä¸Šçº¿ â†’ å®¢æˆ·å†ä¸Šçº¿
```

**ğŸ”¸ æ–‡æ¡£å’Œè§„èŒƒç®¡ç†**
```
æ¥å£æ–‡æ¡£è§„èŒƒï¼š

APIæ–‡æ¡£ç»“æ„ï¼š
â”œâ”€â”€ æ¥å£æ¦‚è¿°
â”œâ”€â”€ è®¤è¯æ–¹å¼  
â”œâ”€â”€ è¯·æ±‚æ ¼å¼
â”œâ”€â”€ å“åº”æ ¼å¼
â”œâ”€â”€ é”™è¯¯ç è¯´æ˜
â”œâ”€â”€ è°ƒç”¨ç¤ºä¾‹
â”œâ”€â”€ å˜æ›´å†å²
â””â”€â”€ è”ç³»æ–¹å¼

ç‰ˆæœ¬ç®¡ç†ç­–ç•¥ï¼š
- è¯­ä¹‰åŒ–ç‰ˆæœ¬å· (v1.2.3)
- å‘ä¸‹å…¼å®¹åŸåˆ™
- åºŸå¼ƒæ¥å£é€šçŸ¥æœºåˆ¶
- å¤šç‰ˆæœ¬å¹¶å­˜ç­–ç•¥
```

### 5.3 ç›‘æ§å’Œæ²»ç†


**ğŸ”¸ ä¸Šä¸‹æ–‡å¥åº·ç›‘æ§**
```java
// ä¸Šä¸‹æ–‡å¥åº·æ£€æŸ¥
@RestController
public class HealthController {
    
    @Autowired
    private List<ContextHealthIndicator> healthIndicators;
    
    @GetMapping("/health")
    public ContextHealthResponse getHealth() {
        ContextHealthResponse response = new ContextHealthResponse();
        
        for (ContextHealthIndicator indicator : healthIndicators) {
            HealthStatus status = indicator.getHealth();
            response.addIndicator(indicator.getName(), status);
        }
        
        return response;
    }
}

// ä¸šåŠ¡å¥åº·æŒ‡æ ‡
@Component
public class OrderContextHealthIndicator implements ContextHealthIndicator {
    
    @Override
    public HealthStatus getHealth() {
        try {
            // æ£€æŸ¥æ•°æ®åº“è¿æ¥
            boolean dbHealthy = checkDatabaseHealth();
            
            // æ£€æŸ¥ä¾èµ–æœåŠ¡
            boolean dependenciesHealthy = checkDependencies();
            
            // æ£€æŸ¥ä¸šåŠ¡æŒ‡æ ‡
            boolean businessHealthy = checkBusinessMetrics();
            
            if (dbHealthy && dependenciesHealthy && businessHealthy) {
                return HealthStatus.UP;
            } else {
                return HealthStatus.DOWN;
            }
            
        } catch (Exception e) {
            return HealthStatus.DOWN;
        }
    }
    
    private boolean checkBusinessMetrics() {
        // æ£€æŸ¥å…³é”®ä¸šåŠ¡æŒ‡æ ‡
        long pendingOrders = orderRepository.countPendingOrders();
        double errorRate = orderMetrics.getErrorRate();
        
        return pendingOrders < 1000 && errorRate < 0.05;
    }
}
```

**ğŸ”¸ è·¨ä¸Šä¸‹æ–‡é“¾è·¯è¿½è¸ª**
```java
// åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª
@RestController
public class OrderController {
    
    @GetMapping("/orders/{orderId}")
    public OrderResponse getOrder(@PathVariable String orderId) {
        
        // åˆ›å»ºè¿½è¸ªä¸Šä¸‹æ–‡
        try (Span span = tracer.nextSpan()
                .name("get-order")
                .tag("order.id", orderId)
                .start()) {
            
            // è°ƒç”¨å…¶ä»–ä¸Šä¸‹æ–‡æœåŠ¡
            CustomerInfo customer = customerService.getCustomer(customerId);
            PaymentInfo payment = paymentService.getPayment(orderId);
            
            return buildOrderResponse(order, customer, payment);
        }
    }
}
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ é™ç•Œä¸Šä¸‹æ–‡ï¼šå®šä¹‰è¯­ä¹‰è¾¹ç•Œï¼Œä¿æŒæ¨¡å‹ä¸€è‡´æ€§
ğŸ”¸ ä¸Šä¸‹æ–‡æ˜ å°„ï¼šå®šä¹‰ä¸Šä¸‹æ–‡é—´çš„åä½œå…³ç³»
ğŸ”¸ å…±äº«å†…æ ¸ï¼šå¤šä¸ªä¸Šä¸‹æ–‡å…±äº«æ ¸å¿ƒæ¨¡å‹
ğŸ”¸ å®¢æˆ·ä¾›åº”å•†ï¼šä¸€æ–¹ä¸ºå¦ä¸€æ–¹æä¾›æœåŠ¡
ğŸ”¸ é˜²è…å±‚ï¼šä¿æŠ¤è‡ªèº«ä¸è¢«å¤–éƒ¨ç³»ç»Ÿæ±¡æŸ“
ğŸ”¸ å¼€æ”¾ä¸»æœºï¼šæä¾›æ ‡å‡†åŒ–æœåŠ¡æ¥å£
```

### 6.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ é™ç•Œä¸Šä¸‹æ–‡çš„æœ¬è´¨**
```
æ ¸å¿ƒç†è§£ï¼š
- ä¸æ˜¯æŠ€æœ¯è¾¹ç•Œï¼Œè€Œæ˜¯ä¸šåŠ¡è¾¹ç•Œ
- ä¸æ˜¯æ¨¡å—æ‹†åˆ†ï¼Œè€Œæ˜¯è¯­ä¹‰ç»Ÿä¸€
- ä¸æ˜¯ç‰©ç†åˆ†ç¦»ï¼Œè€Œæ˜¯é€»è¾‘éš”ç¦»
- æ¯ä¸ªä¸Šä¸‹æ–‡éƒ½æœ‰è‡ªå·±çš„"è¯­è¨€"

å®é™…æ„ä¹‰ï¼š
- é™ä½ç³»ç»Ÿå¤æ‚åº¦
- æé«˜å›¢é˜Ÿå¼€å‘æ•ˆç‡  
- æ”¯æŒç‹¬ç«‹æ¼”è¿›
- ä¾¿äºç»´æŠ¤å’Œæ‰©å±•
```

**ğŸ”¹ ä¸Šä¸‹æ–‡æ˜ å°„çš„ä»·å€¼**
```
è§£å†³çš„é—®é¢˜ï¼š
- æ˜ç¡®åä½œå…³ç³»
- å‡å°‘æ²Ÿé€šæˆæœ¬
- é¿å…ç´§è€¦åˆ
- æ”¯æŒç‹¬ç«‹éƒ¨ç½²

é€‰æ‹©åŸåˆ™ï¼š
- ç´§å¯†åä½œ â†’ å…±äº«å†…æ ¸
- å•å‘ä¾èµ– â†’ å®¢æˆ·ä¾›åº”å•†
- ä¿æŠ¤æ ¸å¿ƒ â†’ é˜²è…å±‚  
- é€šç”¨æœåŠ¡ â†’ å¼€æ”¾ä¸»æœº
```

**ğŸ”¹ å®æ–½çš„å…³é”®æˆåŠŸå› ç´ **
```
æŠ€æœ¯å±‚é¢ï¼š
âœ“ æ¸…æ™°çš„æ¥å£å®šä¹‰
âœ“ å®Œå–„çš„ç›‘æ§ä½“ç³»
âœ“ è‡ªåŠ¨åŒ–æµ‹è¯•è¦†ç›–
âœ“ ç‰ˆæœ¬ç®¡ç†ç­–ç•¥

ç»„ç»‡å±‚é¢ï¼š
âœ“ å›¢é˜Ÿè¾¹ç•Œä¸ä¸Šä¸‹æ–‡å¯¹é½
âœ“ æ˜ç¡®çš„è´£ä»»åˆ’åˆ†
âœ“ æœ‰æ•ˆçš„æ²Ÿé€šæœºåˆ¶
âœ“ æŒç»­çš„æ¶æ„æ¼”è¿›
```

### 6.3 å®é™…åº”ç”¨ä»·å€¼


- **ç³»ç»Ÿæ¶æ„**ï¼šä¸ºå¾®æœåŠ¡æ‹†åˆ†æä¾›ç§‘å­¦ä¾æ®
- **å›¢é˜Ÿåä½œ**ï¼šå‡å°‘è·¨å›¢é˜Ÿæ²Ÿé€šå¤æ‚åº¦
- **ä»£ç è´¨é‡**ï¼šä¿æŒé¢†åŸŸæ¨¡å‹çš„ä¸€è‡´æ€§å’Œçº¯å‡€æ€§
- **ä¸šåŠ¡ç†è§£**ï¼šä¿ƒè¿›æŠ€æœ¯å›¢é˜Ÿå¯¹ä¸šåŠ¡çš„æ·±å…¥ç†è§£
- **ç³»ç»Ÿæ¼”è¿›**ï¼šæ”¯æŒå¤§å‹ç³»ç»Ÿçš„æŒç»­æ¼”åŒ–

**æ ¸å¿ƒè®°å¿†**ï¼š
- é™ç•Œä¸Šä¸‹æ–‡æ˜¯ä¸šåŠ¡è¾¹ç•Œï¼Œä¸æ˜¯æŠ€æœ¯è¾¹ç•Œ
- ä¸Šä¸‹æ–‡æ˜ å°„å®šä¹‰åä½œå…³ç³»ï¼Œé¿å…æ··ä¹±è€¦åˆ
- é˜²è…å±‚ä¿æŠ¤æ ¸å¿ƒä¸šåŠ¡ï¼Œå¼€æ”¾ä¸»æœºæä¾›æ ‡å‡†æœåŠ¡
- å›¢é˜Ÿç»„ç»‡è¦ä¸ä¸Šä¸‹æ–‡è¾¹ç•Œå¯¹é½
- æ¸è¿›å¼æ¼”è¿›æ¯”å¤§çˆ†ç‚¸å¼é‡æ„æ›´å®‰å…¨æœ‰æ•ˆ