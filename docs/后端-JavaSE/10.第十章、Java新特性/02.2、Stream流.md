---
title: 2ã€Streamæµ
---
## ğŸ“š ç›®å½•

1. [StreamæµåŸºç¡€æ¦‚å¿µ](#1-StreamæµåŸºç¡€æ¦‚å¿µ)
2. [Streamæ ¸å¿ƒæ“ä½œ](#2-Streamæ ¸å¿ƒæ“ä½œ)
3. [Streamé«˜çº§åº”ç”¨](#3-Streamé«˜çº§åº”ç”¨)

---

## 1. ğŸŒŠ StreamæµåŸºç¡€æ¦‚å¿µ


### 1.1 Streamæ˜¯ä»€ä¹ˆï¼Ÿç”¨ç”Ÿæ´»ä¾‹å­æ¥ç†è§£


**ğŸ­ æƒ³è±¡ä¸€ä¸ªè‹¹æœåŠ å·¥å‚çš„æµæ°´çº¿ï¼š**

```
åŸæ–™ä»“åº“ â†’ æ¸…æ´—å·¥åº â†’ å‰Šçš®å·¥åº â†’ åˆ‡ç‰‡å·¥åº â†’ åŒ…è£…å·¥åº â†’ æˆå“ä»“åº“
  â†“           â†“         â†“         â†“         â†“         â†“
è‹¹æœå †    åªè¦å¥½è‹¹æœ   å»æ‰çš®    åˆ‡æˆç‰‡    è£…åˆ°ç›’å­   è‹¹æœç‰‡æˆå“
```

**ğŸ’¡ Streamå°±æ˜¯ç¼–ç¨‹ä¸­çš„æµæ°´çº¿ï¼š**

```java
List<String> fruits = Arrays.asList("è‹¹æœ", "çƒ‚è‹¹æœ", "é¦™è•‰", "åé¦™è•‰");

// ä¼ ç»Ÿæ–¹å¼ï¼šæ‰‹å·¥ä½œåŠï¼ˆä¸€ä¸ªä¸€ä¸ªå¤„ç†ï¼‰
List<String> result = new ArrayList<>();
for (String fruit : fruits) {
    if (!fruit.contains("çƒ‚") && !fruit.contains("å")) {  // æŒ‘é€‰å¥½çš„
        String processed = fruit + "ç‰‡";                    // åŠ å·¥
        result.add(processed);                              // æ”¶é›†
    }
}
System.out.println(result);  // [è‹¹æœç‰‡, é¦™è•‰ç‰‡]

// Streamæ–¹å¼ï¼šæµæ°´çº¿ï¼ˆä¸€æ¡é¾™æœåŠ¡ï¼‰
List<String> result2 = fruits.stream()                     // æ”¾åˆ°æµæ°´çº¿ä¸Š
    .filter(fruit -> !fruit.contains("çƒ‚") && !fruit.contains("å"))  // å·¥åº1ï¼šæŒ‘é€‰
    .map(fruit -> fruit + "ç‰‡")                            // å·¥åº2ï¼šåŠ å·¥
    .collect(Collectors.toList());                         // å·¥åº3ï¼šæ”¶é›†
System.out.println(result2);  // [è‹¹æœç‰‡, é¦™è•‰ç‰‡]
```

**ğŸ¯ Streamçš„æœ¬è´¨ï¼š**
```
Stream = æ•°æ®å¤„ç†çš„æµæ°´çº¿
ä¸å­˜å‚¨æ•°æ®ï¼šåªæ˜¯å¤„ç†æ•°æ®çš„ç®¡é“ï¼Œä¸æ˜¯è£…æ•°æ®çš„å®¹å™¨
ä¸€æ¬¡æ€§ä½¿ç”¨ï¼šç”¨å®Œå°±æŠ¥åºŸï¼Œä¸èƒ½é‡å¤ä½¿ç”¨
é“¾å¼æ“ä½œï¼šå¯ä»¥è¿æ¥å¤šä¸ªå¤„ç†æ­¥éª¤
```

### 1.2 ä¸ºä»€ä¹ˆè¦ç”¨Streamï¼Ÿè§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ


**ğŸ˜« ä¼ ç»Ÿæ–¹å¼çš„ç—›ç‚¹ï¼š**

```java
List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);

// éœ€æ±‚ï¼šæ‰¾å‡ºå¶æ•°ï¼Œè®¡ç®—å¹³æ–¹ï¼Œæ±‚å’Œ

// ä¼ ç»Ÿæ–¹å¼ï¼šéœ€è¦å¾ˆå¤šä¸­é—´å˜é‡å’Œå¾ªç¯
List<Integer> evenNumbers = new ArrayList<>();      // ä¸­é—´å˜é‡1
for (Integer num : numbers) {                       // å¾ªç¯1
    if (num % 2 == 0) {
        evenNumbers.add(num);
    }
}

List<Integer> squares = new ArrayList<>();          // ä¸­é—´å˜é‡2  
for (Integer num : evenNumbers) {                   // å¾ªç¯2
    squares.add(num * num);
}

int sum = 0;                                        // ä¸­é—´å˜é‡3
for (Integer square : squares) {                    // å¾ªç¯3
    sum += square;
}
System.out.println("ç»“æœï¼š" + sum);  // ç»“æœï¼š220
```

**ğŸ˜Š Streamæ–¹å¼çš„ä¼˜åŠ¿ï¼š**

```java
// Streamæ–¹å¼ï¼šä¸€æ¡æµæ°´çº¿æå®š
int result = numbers.stream()           // æ•°æ®ä¸Šæµæ°´çº¿
    .filter(num -> num % 2 == 0)       // è¿‡æ»¤ï¼šåªè¦å¶æ•°
    .mapToInt(num -> num * num)        // è½¬æ¢ï¼šè®¡ç®—å¹³æ–¹
    .sum();                            // ç»ˆç»“ï¼šæ±‚å’Œ
System.out.println("ç»“æœï¼š" + result);  // ç»“æœï¼š220
```

**å¯¹æ¯”æ€»ç»“ï¼š**
- **ä¼ ç»Ÿæ–¹å¼**ï¼š3ä¸ªä¸­é—´å˜é‡ + 3ä¸ªå¾ªç¯ + 10è¡Œä»£ç 
- **Streamæ–¹å¼**ï¼š0ä¸ªä¸­é—´å˜é‡ + 0ä¸ªæ˜¾å¼å¾ªç¯ + 4è¡Œä»£ç 
- **æ ¸å¿ƒå¥½å¤„**ï¼šä»£ç ç®€æ´ã€é€»è¾‘æ¸…æ™°ã€æ— ä¸­é—´åƒåœ¾

### 1.3 ä¸²è¡Œæµ vs å¹¶è¡Œæµï¼šä¸€ä¸ªäººå¹²æ´» vs å¤šä¸ªäººå¹²æ´»


**ğŸ‘¤ ä¸²è¡Œæµï¼ˆstream()ï¼‰ï¼šä¸€ä¸ªå·¥äººä¾æ¬¡å¤„ç†**

```java
List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8);

// ä¸²è¡Œæµï¼šä¸€ä¸ªäººæŒ‰é¡ºåºå¤„ç†æ¯ä¸ªæ•°å­—
List<Integer> result1 = numbers.stream()           // ä¸²è¡Œæµ
    .map(num -> {
        System.out.println("å¤„ç†ï¼š" + num + "ï¼Œçº¿ç¨‹ï¼š" + Thread.currentThread().getName());
        return num * 2;
    })
    .collect(Collectors.toList());

// è¾“å‡ºç»“æœï¼š
// å¤„ç†ï¼š1ï¼Œçº¿ç¨‹ï¼šmain
// å¤„ç†ï¼š2ï¼Œçº¿ç¨‹ï¼šmain  
// å¤„ç†ï¼š3ï¼Œçº¿ç¨‹ï¼šmain
// ...ï¼ˆå…¨éƒ¨åœ¨ä¸»çº¿ç¨‹ä¸­ä¾æ¬¡å¤„ç†ï¼‰
```

**ğŸ‘¥ å¹¶è¡Œæµï¼ˆparallelStream()ï¼‰ï¼šå¤šä¸ªå·¥äººåŒæ—¶å¤„ç†**

```java
// å¹¶è¡Œæµï¼šå¤šä¸ªäººåŒæ—¶å¤„ç†ä¸åŒçš„æ•°å­—
List<Integer> result2 = numbers.parallelStream()   // å¹¶è¡Œæµ
    .map(num -> {
        System.out.println("å¤„ç†ï¼š" + num + "ï¼Œçº¿ç¨‹ï¼š" + Thread.currentThread().getName());
        return num * 2;
    })
    .collect(Collectors.toList());

// è¾“å‡ºç»“æœï¼ˆé¡ºåºå¯èƒ½ä¸åŒï¼‰ï¼š
// å¤„ç†ï¼š5ï¼Œçº¿ç¨‹ï¼šForkJoinPool.commonPool-worker-1
// å¤„ç†ï¼š1ï¼Œçº¿ç¨‹ï¼šmain
// å¤„ç†ï¼š3ï¼Œçº¿ç¨‹ï¼šForkJoinPool.commonPool-worker-2
// å¤„ç†ï¼š7ï¼Œçº¿ç¨‹ï¼šForkJoinPool.commonPool-worker-3
// ...ï¼ˆåœ¨å¤šä¸ªçº¿ç¨‹ä¸­å¹¶å‘å¤„ç†ï¼‰
```

**ğŸ¤” ä»€ä¹ˆæ—¶å€™ç”¨å“ªç§ï¼Ÿ**

```java
// å°æ•°æ®é‡ï¼šä¸²è¡Œæµæ›´å¿«ï¼ˆé¿å…çº¿ç¨‹å¼€é”€ï¼‰
List<Integer> smallList = Arrays.asList(1, 2, 3, 4, 5);
int sum1 = smallList.stream().mapToInt(x -> x * x).sum();        // æ¨è

// å¤§æ•°æ®é‡ä¸”CPUå¯†é›†ï¼šå¹¶è¡Œæµæ›´å¿«
List<Integer> bigList = new Random().ints(1000000, 1, 100)
    .boxed().collect(Collectors.toList());
int sum2 = bigList.parallelStream().mapToInt(x -> x * x).sum();  // æ¨è

// ç®€å•è®°å¿†ï¼š
// æ•°æ®å°‘ï¼ˆ<1000ï¼‰ â†’ ç”¨ä¸²è¡Œæµ
// æ•°æ®å¤šä¸”è®¡ç®—å¤æ‚ â†’ ç”¨å¹¶è¡Œæµ
// æœ‰é¡ºåºè¦æ±‚ â†’ ç”¨ä¸²è¡Œæµ
// æ— é¡ºåºè¦æ±‚ä¸”æ•°æ®å¤š â†’ ç”¨å¹¶è¡Œæµ
```

### 1.4 å»¶è¿Ÿæ‰§è¡Œï¼šè¯´äº†ä¸ç®—ï¼Œåšäº†æ‰ç®—


**ğŸ¬ å°±åƒæ‹ç”µå½±ï¼š**
- **å†™å‰§æœ¬é˜¶æ®µ**ï¼šåªæ˜¯è®¡åˆ’ï¼Œæ²¡æœ‰çœŸæ­£æ‹æ‘„
- **å¼€æœºæ‹æ‘„**ï¼šæ‰çœŸæ­£å¼€å§‹å·¥ä½œ

```java
List<String> words = Arrays.asList("apple", "banana", "cherry");

System.out.println("=== å¼€å§‹å†™å‰§æœ¬ï¼ˆä¸­é—´æ“ä½œï¼‰ ===");
Stream<String> stream = words.stream()
    .filter(word -> {
        System.out.println("è¿‡æ»¤ï¼š" + word);  // è¿™è¡Œä¸ä¼šæ‰§è¡Œï¼
        return word.length() > 5;
    })
    .map(word -> {
        System.out.println("è½¬æ¢ï¼š" + word);  // è¿™è¡Œä¹Ÿä¸ä¼šæ‰§è¡Œï¼
        return word.toUpperCase();
    });

System.out.println("å‰§æœ¬å†™å®Œäº†ï¼Œä½†è¿˜æ²¡å¼€æ‹");

System.out.println("=== å¼€æœºæ‹æ‘„ï¼ˆç»ˆæ­¢æ“ä½œï¼‰ ===");
List<String> result = stream.collect(Collectors.toList());  // ç°åœ¨æ‰å¼€å§‹æ‰§è¡Œï¼

System.out.println("æ‹æ‘„å®Œæˆï¼Œç»“æœï¼š" + result);
```

**è¿è¡Œç»“æœï¼š**
```
=== å¼€å§‹å†™å‰§æœ¬ï¼ˆä¸­é—´æ“ä½œï¼‰ ===
å‰§æœ¬å†™å®Œäº†ï¼Œä½†è¿˜æ²¡å¼€æ‹
=== å¼€æœºæ‹æ‘„ï¼ˆç»ˆæ­¢æ“ä½œï¼‰ ===
è¿‡æ»¤ï¼šapple
è¿‡æ»¤ï¼šbanana
è½¬æ¢ï¼šbanana
è¿‡æ»¤ï¼šcherry
è½¬æ¢ï¼šcherry
æ‹æ‘„å®Œæˆï¼Œç»“æœï¼š[BANANA, CHERRY]
```

**ğŸ’¡ ä¸ºä»€ä¹ˆè¦å»¶è¿Ÿæ‰§è¡Œï¼Ÿ**
```
å¥½å¤„1ï¼šä¼˜åŒ–æ€§èƒ½ - å¯ä»¥åˆå¹¶å¤šä¸ªæ“ä½œï¼Œå‡å°‘éå†æ¬¡æ•°
å¥½å¤„2ï¼šèŠ‚çœå†…å­˜ - ä¸åˆ›å»ºä¸­é—´é›†åˆ
å¥½å¤„3ï¼šæ”¯æŒæ— é™æµ - å¯ä»¥å¤„ç†æ— é™æ•°æ®æº

ç®€å•ç†è§£ï¼šå…ˆè®¡åˆ’å¥½æ‰€æœ‰æ­¥éª¤ï¼Œå†ä¸€æ¬¡æ€§é«˜æ•ˆæ‰§è¡Œ
```

### 1.5 ä¸­é—´æ“ä½œ vs ç»ˆæ­¢æ“ä½œï¼šæ­ç§¯æœ¨ vs æ¨å€’ç§¯æœ¨


**ğŸ§± ä¸­é—´æ“ä½œï¼šæ­ç§¯æœ¨ï¼ˆå¯ä»¥ä¸€ç›´æ­ï¼‰**

```java
Stream<Integer> stream = Arrays.asList(1, 2, 3, 4, 5).stream()
    .filter(n -> n > 2)        // ä¸­é—´æ“ä½œï¼šè¿‡æ»¤
    .map(n -> n * 2)           // ä¸­é—´æ“ä½œï¼šè½¬æ¢
    .sorted()                  // ä¸­é—´æ“ä½œï¼šæ’åº
    .distinct();               // ä¸­é—´æ“ä½œï¼šå»é‡
    // å¯ä»¥ç»§ç»­åŠ æ›´å¤šä¸­é—´æ“ä½œ...

// åˆ°è¿™é‡Œä¸ºæ­¢ï¼Œä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿï¼Œåªæ˜¯æ­å¥½äº†ç§¯æœ¨
```

**ğŸ’¥ ç»ˆæ­¢æ“ä½œï¼šæ¨å€’ç§¯æœ¨ï¼ˆåªèƒ½æ¨ä¸€æ¬¡ï¼‰**

```java
// ç»ˆæ­¢æ“ä½œ1ï¼šæ”¶é›†ç»“æœ
List<Integer> list = stream.collect(Collectors.toList());  // ç§¯æœ¨å€’äº†ï¼
// stream.count();  // ç¼–è¯‘é”™è¯¯ï¼ç§¯æœ¨å·²ç»å€’äº†ï¼Œä¸èƒ½å†ç”¨

// å¦‚æœè¿˜æƒ³æ“ä½œï¼Œéœ€è¦é‡æ–°åˆ›å»ºstream
long count = Arrays.asList(1, 2, 3, 4, 5).stream()
    .filter(n -> n > 2)
    .count();  // é‡æ–°æ­ç§¯æœ¨ï¼Œç„¶åæ¨å€’
```

**ğŸ“‹ å¸¸ç”¨æ“ä½œåˆ†ç±»ï¼š**

| **ä¸­é—´æ“ä½œï¼ˆå¯é“¾å¼ï¼‰** | **ä½œç”¨** | **ç¤ºä¾‹** |
|-------------------|---------|---------|
| `filter()` | è¿‡æ»¤å…ƒç´  | `filter(x -> x > 0)` |
| `map()` | è½¬æ¢å…ƒç´  | `map(String::toUpperCase)` |
| `sorted()` | æ’åº | `sorted()` |
| `distinct()` | å»é‡ | `distinct()` |
| `limit()` | é™åˆ¶æ•°é‡ | `limit(10)` |
| `skip()` | è·³è¿‡å…ƒç´  | `skip(5)` |

| **ç»ˆæ­¢æ“ä½œï¼ˆåªèƒ½ä¸€æ¬¡ï¼‰** | **ä½œç”¨** | **ç¤ºä¾‹** |
|-------------------|---------|---------|
| `collect()` | æ”¶é›†åˆ°é›†åˆ | `collect(Collectors.toList())` |
| `forEach()` | éå†å…ƒç´  | `forEach(System.out::println)` |
| `count()` | è®¡ç®—æ•°é‡ | `count()` |
| `max()/min()` | æœ€å¤§/æœ€å°å€¼ | `max(Integer::compareTo)` |
| `anyMatch()` | æ˜¯å¦æœ‰åŒ¹é… | `anyMatch(x -> x > 10)` |
| `reduce()` | èšåˆè®¡ç®— | `reduce(0, Integer::sum)` |

### 1.6 Streamçš„åˆ›å»ºæ–¹å¼ï¼šæ•°æ®ä»å“ªæ¥ï¼Ÿ


**ğŸ“¦ æ–¹å¼1ï¼šä»é›†åˆåˆ›å»ºï¼ˆæœ€å¸¸ç”¨ï¼‰**

```java
// ä»Liståˆ›å»º
List<String> list = Arrays.asList("è‹¹æœ", "é¦™è•‰", "æ©˜å­");
Stream<String> stream1 = list.stream();         // ä¸²è¡Œæµ
Stream<String> stream2 = list.parallelStream(); // å¹¶è¡Œæµ

// ä»Setåˆ›å»º
Set<Integer> set = new HashSet<>(Arrays.asList(1, 2, 3));
Stream<Integer> stream3 = set.stream();

// ä»Mapåˆ›å»ºï¼ˆéœ€è¦é€‰æ‹©é”®è¿˜æ˜¯å€¼ï¼‰
Map<String, Integer> map = new HashMap<>();
map.put("è‹¹æœ", 5);
map.put("é¦™è•‰", 3);

Stream<String> keyStream = map.keySet().stream();    // é”®çš„æµï¼š"è‹¹æœ", "é¦™è•‰"
Stream<Integer> valueStream = map.values().stream(); // å€¼çš„æµï¼š5, 3
```

**ğŸ”¢ æ–¹å¼2ï¼šä»æ•°ç»„åˆ›å»º**

```java
// å­—ç¬¦ä¸²æ•°ç»„
String[] array = {"hello", "world", "java"};
Stream<String> stream = Arrays.stream(array);

// åŸºæœ¬ç±»å‹æ•°ç»„ï¼ˆæœ‰ä¸“é—¨çš„æµç±»å‹ï¼‰
int[] numbers = {1, 2, 3, 4, 5};
IntStream intStream = Arrays.stream(numbers);  // æ³¨æ„ï¼šè¿™æ˜¯IntStreamï¼Œä¸æ˜¯Stream<Integer>
```

**âš¡ æ–¹å¼3ï¼šç›´æ¥åˆ›å»º**

```java
// ç›´æ¥æŒ‡å®šå…ƒç´ 
Stream<String> stream1 = Stream.of("a", "b", "c");
Stream<Integer> stream2 = Stream.of(1, 2, 3, 4, 5);

// åˆ›å»ºç©ºæµ
Stream<String> emptyStream = Stream.empty();

// åˆ›å»ºæ— é™æµï¼ˆå¿…é¡»ç”¨limité™åˆ¶ï¼‰
Stream<Integer> infiniteStream = Stream.iterate(0, n -> n + 1)  // 0, 1, 2, 3, 4...
    .limit(10);  // åªè¦å‰10ä¸ª

Stream<Double> randomStream = Stream.generate(Math::random)  // æ— é™éšæœºæ•°
    .limit(5);   // åªè¦å‰5ä¸ª
```

**ğŸ’¡ è§£é‡Šï¼š**
- `Stream.iterate(0, n -> n + 1)` æ„æ€æ˜¯ï¼š"ä»0å¼€å§‹ï¼Œæ¯æ¬¡åŠ 1"
- `Stream.generate(Math::random)` æ„æ€æ˜¯ï¼š"ä¸æ–­ç”Ÿæˆéšæœºæ•°"
- `limit(10)` æ„æ€æ˜¯ï¼š"åªè¦å‰10ä¸ªï¼Œåˆ«æ— é™ç”Ÿæˆäº†"

### 1.7 åŸºæœ¬ç±»å‹æµï¼šä¸ºä»€ä¹ˆè¦ç‰¹æ®Šå¯¹å¾…ï¼Ÿ


**ğŸ¤” ä¸ºä»€ä¹ˆæœ‰IntStreamã€LongStreamã€DoubleStreamï¼Ÿ**

```java
// æ™®é€šStream<Integer>ï¼šæ¯ä¸ªæ•°å­—éƒ½æ˜¯åŒ…è£…ç±»å¯¹è±¡
Stream<Integer> integerStream = Arrays.asList(1, 2, 3, 4, 5).stream();
int sum1 = integerStream.mapToInt(Integer::intValue).sum();  // éœ€è¦æ‹†ç®±

// IntStreamï¼šç›´æ¥æ˜¯åŸºæœ¬ç±»å‹ï¼Œæ€§èƒ½æ›´å¥½
int[] array = {1, 2, 3, 4, 5};
IntStream intStream = Arrays.stream(array);
int sum2 = intStream.sum();  // ç›´æ¥è®¡ç®—ï¼Œæ— éœ€æ‹†ç®±

// æ€§èƒ½å·®å¼‚ï¼ˆå¤§æ•°æ®é‡æ—¶æ˜æ˜¾ï¼‰ï¼š
// Stream<Integer>ï¼šéœ€è¦è£…ç®±æ‹†ç®±ï¼Œå ç”¨æ›´å¤šå†…å­˜
// IntStreamï¼šç›´æ¥æ“ä½œåŸºæœ¬ç±»å‹ï¼Œæ›´å¿«æ›´çœå†…å­˜
```

**ğŸ”§ åŸºæœ¬ç±»å‹æµçš„ç‰¹æ®Šæ–¹æ³•ï¼š**

```java
int[] numbers = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
IntStream stream = Arrays.stream(numbers);

// æ•°å­¦è®¡ç®—æ–¹æ³•ï¼ˆåªæœ‰åŸºæœ¬ç±»å‹æµæ‰æœ‰ï¼‰
int sum = stream.sum();                    // æ±‚å’Œ
OptionalInt max = stream.max();            // æœ€å¤§å€¼
OptionalDouble average = stream.average(); // å¹³å‡å€¼
long count = stream.count();               // è®¡æ•°

// è½¬æ¢ä¸ºå¯¹è±¡æµ
Stream<Integer> boxedStream = stream.boxed();  // IntStream â†’ Stream<Integer>
```

### 1.8 Streamçš„é™åˆ¶ï¼šéœ€è¦æ³¨æ„ä»€ä¹ˆï¼Ÿ


**ğŸš¨ é‡è¦é™åˆ¶1ï¼šåªèƒ½ä½¿ç”¨ä¸€æ¬¡**

```java
Stream<String> stream = Arrays.asList("a", "b", "c").stream();

long count = stream.count();  // ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼ŒOK
// stream.forEach(System.out::println);  // ç¼–è¯‘é”™è¯¯ï¼streamå·²ç»å…³é—­äº†

// è§£å†³åŠæ³•ï¼šé‡æ–°åˆ›å»º
List<String> list = Arrays.asList("a", "b", "c");
list.stream().count();           // ä½¿ç”¨1
list.stream().forEach(System.out::println);  // ä½¿ç”¨2
```

**ğŸš¨ é‡è¦é™åˆ¶2ï¼šä¸è¦åœ¨Lambdaä¸­ä¿®æ”¹å¤–éƒ¨å˜é‡**

```java
List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5);
int sum = 0;  // å¤–éƒ¨å˜é‡

// âŒ é”™è¯¯ï¼šä¸èƒ½åœ¨lambdaä¸­ä¿®æ”¹å¤–éƒ¨å˜é‡
// numbers.stream().forEach(num -> sum += num);  // ç¼–è¯‘é”™è¯¯ï¼

// âœ… æ­£ç¡®ï¼šä½¿ç”¨Streamçš„èšåˆæ–¹æ³•
int correctSum = numbers.stream().mapToInt(Integer::intValue).sum();

// âœ… æˆ–è€…ä½¿ç”¨reduce
int reduceSum = numbers.stream().reduce(0, Integer::sum);
```

**ğŸš¨ é‡è¦é™åˆ¶3ï¼šå¹¶è¡Œæµçš„å‰¯ä½œç”¨**

```java
List<Integer> list = new ArrayList<>();
List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5);

// âŒ å±é™©ï¼šå¹¶è¡Œæµä¿®æ”¹å…±äº«é›†åˆï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰
numbers.parallelStream().forEach(list::add);  // å¯èƒ½ä¸¢å¤±æ•°æ®ï¼

// âœ… å®‰å…¨ï¼šä½¿ç”¨collectæ”¶é›†
List<Integer> safeList = numbers.parallelStream()
    .collect(Collectors.toList());
```

### 1.9 ä»€ä¹ˆæ—¶å€™ç”¨Streamï¼Ÿä»€ä¹ˆæ—¶å€™ä¸ç”¨ï¼Ÿ


**âœ… é€‚åˆç”¨Streamçš„åœºæ™¯ï¼š**

```java
// 1. å¤æ‚çš„æ•°æ®å¤„ç†
List<String> result = words.stream()
    .filter(word -> word.length() > 3)
    .map(String::toUpperCase)
    .sorted()
    .collect(Collectors.toList());

// 2. æ•°æ®ç»Ÿè®¡
double average = scores.stream()
    .mapToInt(Integer::intValue)
    .average()
    .orElse(0.0);

// 3. æŸ¥æ‰¾å’ŒåŒ¹é…
boolean hasAdult = people.stream()
    .anyMatch(person -> person.getAge() >= 18);
```

**âŒ ä¸é€‚åˆç”¨Streamçš„åœºæ™¯ï¼š**

```java
// 1. ç®€å•éå†ï¼ˆä¼ ç»Ÿforæ›´ç›´æ¥ï¼‰
// âŒ è¿‡åº¦ä½¿ç”¨
list.stream().forEach(System.out::println);
// âœ… æ›´ç®€å•
for (String item : list) {
    System.out.println(item);
}

// 2. éœ€è¦ç´¢å¼•
// âŒ Streamæ²¡æœ‰ç´¢å¼•æ¦‚å¿µ
// âœ… ä¼ ç»Ÿforå¾ªç¯
for (int i = 0; i < list.size(); i++) {
    System.out.println(i + ": " + list.get(i));
}

// 3. å¤æ‚çš„å¼‚å¸¸å¤„ç†
// âŒ Streamä¸­å¼‚å¸¸å¤„ç†å¾ˆéº»çƒ¦
// âœ… ä¼ ç»Ÿå¾ªç¯æ›´å¥½å¤„ç†
for (String item : list) {
    try {
        processItem(item);
    } catch (Exception e) {
        handleError(e);
    }
}
```

### 1.10 StreamåŸºç¡€æ€»ç»“


**ğŸ¯ Streamçš„æ ¸å¿ƒæ¦‚å¿µï¼š**
```
Stream = æ•°æ®å¤„ç†çš„æµæ°´çº¿
â€¢ ä¸å­˜å‚¨æ•°æ®ï¼Œåªå¤„ç†æ•°æ®
â€¢ å»¶è¿Ÿæ‰§è¡Œï¼Œåªæœ‰ç»ˆæ­¢æ“ä½œæ‰çœŸæ­£å¼€å§‹
â€¢ ä¸€æ¬¡æ€§ä½¿ç”¨ï¼Œç”¨å®Œå°±æŠ¥åºŸ
â€¢ æ”¯æŒé“¾å¼æ“ä½œï¼Œä»£ç ç®€æ´
```

**ğŸ”§ æ ¸å¿ƒæ“ä½œæ¨¡å¼ï¼š**
```
æ•°æ®æº.stream()      // 1. åˆ›å»ºæµ
  .ä¸­é—´æ“ä½œ1()        // 2. æ­å»ºæµæ°´çº¿ï¼ˆå¯å¤šä¸ªï¼‰
  .ä¸­é—´æ“ä½œ2()
  .ç»ˆæ­¢æ“ä½œ()         // 3. æ‰§è¡Œå¹¶è·å–ç»“æœï¼ˆåªèƒ½ä¸€ä¸ªï¼‰
```

**âš¡ ä¸²è¡Œ vs å¹¶è¡Œï¼š**
```
ä¸²è¡Œæµï¼ˆstream()ï¼‰ï¼š
â€¢ ä¸€ä¸ªçº¿ç¨‹ä¾æ¬¡å¤„ç†
â€¢ é€‚åˆå°æ•°æ®é‡æˆ–æœ‰é¡ºåºè¦æ±‚çš„åœºæ™¯

å¹¶è¡Œæµï¼ˆparallelStream()ï¼‰ï¼š
â€¢ å¤šä¸ªçº¿ç¨‹åŒæ—¶å¤„ç†  
â€¢ é€‚åˆå¤§æ•°æ®é‡ä¸”CPUå¯†é›†çš„åœºæ™¯
```

**ğŸ’¡ ä½¿ç”¨åŸåˆ™ï¼š**
```
ä¼˜å…ˆè€ƒè™‘ï¼šä»£ç æ˜¯å¦æ›´ç®€æ´ã€é€»è¾‘æ˜¯å¦æ›´æ¸…æ™°
æ•°æ®é‡å°ï¼šç”¨ä¸²è¡Œæµ
æ•°æ®é‡å¤§ä¸”è®¡ç®—å¤æ‚ï¼šç”¨å¹¶è¡Œæµ
ç®€å•æ“ä½œï¼šè€ƒè™‘ä¼ ç»Ÿå¾ªç¯
å¤æ‚å¤„ç†ï¼šæ¨èStream
```

**ğŸ“ è®°å¿†è¦ç‚¹ï¼š**
```
Streamåƒæµæ°´çº¿ï¼Œæ•°æ®æµè¿‡å»å¤„ç†
ä¸­é—´æ“ä½œæ­ç§¯æœ¨ï¼Œç»ˆæ­¢æ“ä½œæ¨å€’å®ƒ
å»¶è¿Ÿæ‰§è¡Œå¾ˆèªæ˜ï¼Œéœ€è¦æ—¶æ‰çœŸå¹²æ´»
ä¸€æ¬¡ä½¿ç”¨å°±æŠ¥åºŸï¼Œè¦ç”¨è¯·é‡æ–°åˆ›å»º
```

---

## 2. ğŸ”§ Streamæ ¸å¿ƒæ“ä½œ


### 2.1 è¿‡æ»¤æ“ä½œï¼šfilter() - æŒ‘é€‰ä½ è¦çš„


**ğŸ å°±åƒæŒ‘è‹¹æœï¼šåªè¦å¥½çš„ï¼Œæ‰”æ‰åçš„**

```java
List<String> fruits = Arrays.asList("æ–°é²œè‹¹æœ", "çƒ‚è‹¹æœ", "æ–°é²œé¦™è•‰", "åæ©˜å­", "æ–°é²œè‘¡è„");

// åªè¦æ–°é²œçš„æ°´æœ
List<String> freshFruits = fruits.stream()
    .filter(fruit -> fruit.contains("æ–°é²œ"))  // è¿‡æ»¤æ¡ä»¶ï¼šåŒ…å«"æ–°é²œ"
    .collect(Collectors.toList());
System.out.println(freshFruits);  // [æ–°é²œè‹¹æœ, æ–°é²œé¦™è•‰, æ–°é²œè‘¡è„]

// å¤šä¸ªæ¡ä»¶ç»„åˆ
List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);
List<Integer> result = numbers.stream()
    .filter(num -> num > 3)           // æ¡ä»¶1ï¼šå¤§äº3
    .filter(num -> num % 2 == 0)      // æ¡ä»¶2ï¼šæ˜¯å¶æ•°
    .collect(Collectors.toList());
System.out.println(result);  // [4, 6, 8, 10]
```

**ğŸ’¡ filter()çš„å·¥ä½œåŸç†ï¼š**
```
åŸç†ï¼šç»™æ¯ä¸ªå…ƒç´ "æ‰“åˆ†"ï¼Œtrueçš„ç•™ä¸‹ï¼Œfalseçš„æ‰”æ‰
è¾“å…¥ï¼šPredicate<T>ï¼ˆåˆ¤æ–­å‡½æ•°ï¼Œè¿”å›true/falseï¼‰
è¾“å‡ºï¼šæ–°çš„Streamï¼ŒåªåŒ…å«æ»¡è¶³æ¡ä»¶çš„å…ƒç´ 
è®°å¿†ï¼šfilter = è¿‡æ»¤å™¨ï¼Œåªè®©ç¬¦åˆæ¡ä»¶çš„é€šè¿‡
```

**ğŸ¯ å®é™…åº”ç”¨ï¼šç”¨æˆ·æ•°æ®è¿‡æ»¤**

```java
// æ¨¡æ‹Ÿç”¨æˆ·æ•°æ®
class User {
    String name;
    int age;
    String city;
    
    User(String name, int age, String city) {
        this.name = name; this.age = age; this.city = city;
    }
    
    @Override
    public String toString() {
        return name + "(" + age + "å²," + city + ")";
    }
}

List<User> users = Arrays.asList(
    new User("å¼ ä¸‰", 25, "åŒ—äº¬"),
    new User("æå››", 17, "ä¸Šæµ·"),
    new User("ç‹äº”", 30, "åŒ—äº¬"),
    new User("èµµå…­", 16, "å¹¿å·")
);

// æ‰¾å‡ºåŒ—äº¬çš„æˆå¹´ç”¨æˆ·
List<User> beijingAdults = users.stream()
    .filter(user -> user.city.equals("åŒ—äº¬"))    // æ¡ä»¶1ï¼šåŒ—äº¬
    .filter(user -> user.age >= 18)             // æ¡ä»¶2ï¼šæˆå¹´
    .collect(Collectors.toList());
System.out.println(beijingAdults);  // [å¼ ä¸‰(25å²,åŒ—äº¬), ç‹äº”(30å²,åŒ—äº¬)]
```

### 2.2 è½¬æ¢æ“ä½œï¼šmap() - æŠŠAå˜æˆB


**ğŸ­ å°±åƒåŠ å·¥å‚ï¼šæŠŠåŸæ–™åŠ å·¥æˆäº§å“**

```java
List<String> names = Arrays.asList("å¼ ä¸‰", "æå››", "ç‹äº”");

// æŠŠåå­—å˜æˆé—®å€™è¯­
List<String> greetings = names.stream()
    .map(name -> "ä½ å¥½ï¼Œ" + name)  // è½¬æ¢ï¼šåå­— â†’ é—®å€™è¯­
    .collect(Collectors.toList());
System.out.println(greetings);  // [ä½ å¥½ï¼Œå¼ ä¸‰, ä½ å¥½ï¼Œæå››, ä½ å¥½ï¼Œç‹äº”]

// æŠŠå­—ç¬¦ä¸²å˜æˆé•¿åº¦
List<String> words = Arrays.asList("apple", "banana", "cherry");
List<Integer> lengths = words.stream()
    .map(word -> word.length())    // è½¬æ¢ï¼šå­—ç¬¦ä¸² â†’ é•¿åº¦
    .collect(Collectors.toList());
System.out.println(lengths);  // [5, 6, 6]

// æŠŠå­—ç¬¦ä¸²å˜æˆå¤§å†™
List<String> upperWords = words.stream()
    .map(String::toUpperCase)      // è½¬æ¢ï¼šå°å†™ â†’ å¤§å†™ï¼ˆæ–¹æ³•å¼•ç”¨ï¼‰
    .collect(Collectors.toList());
System.out.println(upperWords);  // [APPLE, BANANA, CHERRY]
```

**ğŸ’¡ map()çš„å·¥ä½œåŸç†ï¼š**
```
åŸç†ï¼šå¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œ"åŠ å·¥"ï¼Œ1ä¸ªè¾“å…¥å¯¹åº”1ä¸ªè¾“å‡º
è¾“å…¥ï¼šFunction<T, R>ï¼ˆè½¬æ¢å‡½æ•°ï¼ŒTç±»å‹å˜Rç±»å‹ï¼‰
è¾“å‡ºï¼šæ–°çš„Streamï¼Œå…ƒç´ ç±»å‹å¯èƒ½æ”¹å˜
è®°å¿†ï¼šmap = æ˜ å°„ï¼Œæ¯ä¸ªå…ƒç´ éƒ½è¦ç»è¿‡è½¬æ¢
```

**ğŸ”¢ ä¸“é—¨çš„æ•°å€¼è½¬æ¢ï¼šmapToIntã€mapToLongã€mapToDouble**

```java
List<String> numbers = Arrays.asList("10", "20", "30", "40", "50");

// mapToIntï¼šå­—ç¬¦ä¸² â†’ intï¼Œè¿”å›IntStream
int sum = numbers.stream()
    .mapToInt(Integer::parseInt)   // String â†’ int
    .sum();                        // IntStreamçš„ä¸“é—¨æ–¹æ³•
System.out.println("æ€»å’Œï¼š" + sum);  // æ€»å’Œï¼š150

// ä¸ºä»€ä¹ˆè¦ç”¨mapToIntè€Œä¸æ˜¯mapï¼Ÿ
// mapç‰ˆæœ¬ï¼šéœ€è¦æ‹†ç®±ï¼Œæ€§èƒ½è¾ƒå·®
int sum1 = numbers.stream()
    .map(Integer::parseInt)        // String â†’ Integerï¼ˆåŒ…è£…ç±»ï¼‰
    .mapToInt(Integer::intValue)   // Integer â†’ intï¼ˆéœ€è¦æ‹†ç®±ï¼‰
    .sum();

// mapToIntç‰ˆæœ¬ï¼šç›´æ¥å¾—åˆ°intï¼Œæ€§èƒ½æ›´å¥½
int sum2 = numbers.stream()
    .mapToInt(Integer::parseInt)   // ç›´æ¥String â†’ int
    .sum();
```

### 2.3 æ’åºæ“ä½œï¼šsorted() - æŒ‰ä½ æƒ³è¦çš„é¡ºåºæ’åˆ—


**ğŸ“š å°±åƒæ•´ç†ä¹¦æ¶ï¼šæŒ‰ä¸åŒæ–¹å¼æ’åº**

```java
List<Integer> numbers = Arrays.asList(5, 2, 8, 1, 9, 3);

// è‡ªç„¶æ’åºï¼ˆä»å°åˆ°å¤§ï¼‰
List<Integer> sorted1 = numbers.stream()
    .sorted()                      // é»˜è®¤æ’åº
    .collect(Collectors.toList());
System.out.println(sorted1);  // [1, 2, 3, 5, 8, 9]

// å€’åºæ’åºï¼ˆä»å¤§åˆ°å°ï¼‰
List<Integer> sorted2 = numbers.stream()
    .sorted((a, b) -> b - a)       // è‡ªå®šä¹‰æ¯”è¾ƒå™¨ï¼šb-aè¡¨ç¤ºå€’åº
    .collect(Collectors.toList());
System.out.println(sorted2);  // [9, 8, 5, 3, 2, 1]

// æ›´ç®€æ´çš„å€’åºå†™æ³•
List<Integer> sorted3 = numbers.stream()
    .sorted(Comparator.reverseOrder())  // å€’åºæ¯”è¾ƒå™¨
    .collect(Collectors.toList());
System.out.println(sorted3);  // [9, 8, 5, 3, 2, 1]
```

**ğŸ¯ å¤æ‚å¯¹è±¡æ’åºï¼šå¤šç§æ’åºæ–¹å¼**

```java
List<User> users = Arrays.asList(
    new User("å¼ ä¸‰", 25, "åŒ—äº¬"),
    new User("æå››", 30, "ä¸Šæµ·"),
    new User("ç‹äº”", 25, "å¹¿å·"),
    new User("èµµå…­", 35, "åŒ—äº¬")
);

// æŒ‰å¹´é¾„æ’åº
List<User> sortedByAge = users.stream()
    .sorted((u1, u2) -> u1.age - u2.age)    // æ¯”è¾ƒå¹´é¾„
    .collect(Collectors.toList());
System.out.println("æŒ‰å¹´é¾„ï¼š" + sortedByAge);

// æ›´ç®€æ´çš„å†™æ³•ï¼šä½¿ç”¨Comparator.comparing
List<User> sortedByAge2 = users.stream()
    .sorted(Comparator.comparing(user -> user.age))  // æå–å¹´é¾„è¿›è¡Œæ¯”è¾ƒ
    .collect(Collectors.toList());

// æŒ‰åŸå¸‚æ’åº
List<User> sortedByCity = users.stream()
    .sorted(Comparator.comparing(user -> user.city))
    .collect(Collectors.toList());
System.out.println("æŒ‰åŸå¸‚ï¼š" + sortedByCity);

// å¤šçº§æ’åºï¼šå…ˆæŒ‰å¹´é¾„ï¼Œå†æŒ‰å§“å
List<User> multiSorted = users.stream()
    .sorted(Comparator.comparing((User user) -> user.age)   // ä¸»æ’åºï¼šå¹´é¾„
            .thenComparing(user -> user.name))              // æ¬¡æ’åºï¼šå§“å
    .collect(Collectors.toList());
System.out.println("å¤šçº§æ’åºï¼š" + multiSorted);
```

### 2.4 å»é‡æ“ä½œï¼šdistinct() - å»æ‰é‡å¤çš„


**ğŸ§¹ å°±åƒæ‰“æ‰«æˆ¿é—´ï¼šæŠŠé‡å¤çš„ä¸œè¥¿å»æ‰ä¸€ä¸ª**

```java
List<Integer> numbers = Arrays.asList(1, 2, 2, 3, 3, 3, 4, 5, 5);

// å»é™¤é‡å¤æ•°å­—
List<Integer> unique = numbers.stream()
    .distinct()                    // å»é‡
    .collect(Collectors.toList());
System.out.println(unique);  // [1, 2, 3, 4, 5]

// å­—ç¬¦ä¸²å»é‡
List<String> words = Arrays.asList("apple", "banana", "apple", "cherry", "banana");
List<String> uniqueWords = words.stream()
    .distinct()
    .collect(Collectors.toList());
System.out.println(uniqueWords);  // [apple, banana, cherry]
```

**ğŸ’¡ distinct()çš„å·¥ä½œåŸç†ï¼š**
```
åŸç†ï¼šä½¿ç”¨equals()æ–¹æ³•åˆ¤æ–­æ˜¯å¦é‡å¤
æ³¨æ„ï¼šå¯¹è±¡éœ€è¦æ­£ç¡®å®ç°equals()å’ŒhashCode()æ–¹æ³•
è®°å¿†ï¼šdistinct = ä¸åŒçš„ï¼Œä¿ç•™ä¸åŒçš„å…ƒç´ 
```

**ğŸ¯ å¯¹è±¡å»é‡ï¼šéœ€è¦é‡å†™equalsæ–¹æ³•**

```java
// å¦‚æœUserç±»æ²¡æœ‰é‡å†™equalsæ–¹æ³•ï¼Œå³ä½¿å†…å®¹ç›¸åŒä¹Ÿè¢«è®¤ä¸ºæ˜¯ä¸åŒå¯¹è±¡
List<User> users = Arrays.asList(
    new User("å¼ ä¸‰", 25, "åŒ—äº¬"),
    new User("å¼ ä¸‰", 25, "åŒ—äº¬"),  // å†…å®¹ç›¸åŒä½†æ˜¯ä¸åŒå¯¹è±¡
    new User("æå››", 30, "ä¸Šæµ·")
);

// ç›´æ¥distinctå¯èƒ½ä¸å»é‡ï¼ˆå› ä¸ºæ˜¯ä¸åŒå¯¹è±¡ï¼‰
long count1 = users.stream().distinct().count();  // å¯èƒ½æ˜¯3

// è§£å†³æ–¹æ¡ˆï¼šå…ˆè½¬æ¢ä¸ºå¯æ¯”è¾ƒçš„å­—æ®µï¼Œå†å»é‡
List<String> uniqueNames = users.stream()
    .map(user -> user.name)        // è½¬æ¢ä¸ºå§“å
    .distinct()                    // å§“åå»é‡
    .collect(Collectors.toList());
System.out.println(uniqueNames);  // [å¼ ä¸‰, æå››]
```

### 2.5 æˆªå–æ“ä½œï¼šlimit() å’Œ skip()


**âœ‚ï¸ å°±åƒå‰ªçº¸æ¡ï¼šè¦å‰é¢å‡ ä¸ªæˆ–è·³è¿‡å‰é¢å‡ ä¸ª**

```java
List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);

// limit()ï¼šåªè¦å‰å‡ ä¸ª
List<Integer> first5 = numbers.stream()
    .limit(5)                      // åªè¦å‰5ä¸ª
    .collect(Collectors.toList());
System.out.println("å‰5ä¸ªï¼š" + first5);  // [1, 2, 3, 4, 5]

// skip()ï¼šè·³è¿‡å‰å‡ ä¸ª
List<Integer> after5 = numbers.stream()
    .skip(5)                       // è·³è¿‡å‰5ä¸ª
    .collect(Collectors.toList());
System.out.println("è·³è¿‡å‰5ä¸ªï¼š" + after5);  // [6, 7, 8, 9, 10]

// ç»„åˆä½¿ç”¨ï¼šåˆ†é¡µæ•ˆæœ
// ç¬¬2é¡µï¼Œæ¯é¡µ3ä¸ªï¼ˆè·³è¿‡å‰3ä¸ªï¼Œç„¶åå–3ä¸ªï¼‰
List<Integer> page2 = numbers.stream()
    .skip(3)                       // è·³è¿‡ç¬¬1é¡µçš„3ä¸ª
    .limit(3)                      // å–ç¬¬2é¡µçš„3ä¸ª
    .collect(Collectors.toList());
System.out.println("ç¬¬2é¡µï¼š" + page2);  // [4, 5, 6]
```

**ğŸ¯ å®é™…åº”ç”¨ï¼šåˆ†é¡µæŸ¥è¯¢**

```java
// æ¨¡æ‹Ÿåˆ†é¡µå‡½æ•°
public static <T> List<T> getPage(List<T> data, int pageNum, int pageSize) {
    return data.stream()
        .skip((pageNum - 1) * pageSize)    // è·³è¿‡å‰é¢çš„é¡µ
        .limit(pageSize)                   // å–å½“å‰é¡µçš„æ•°æ®
        .collect(Collectors.toList());
}

List<String> allUsers = Arrays.asList(
    "ç”¨æˆ·1", "ç”¨æˆ·2", "ç”¨æˆ·3", "ç”¨æˆ·4", "ç”¨æˆ·5", 
    "ç”¨æˆ·6", "ç”¨æˆ·7", "ç”¨æˆ·8", "ç”¨æˆ·9", "ç”¨æˆ·10"
);

// ç¬¬1é¡µï¼Œæ¯é¡µ3ä¸ª
List<String> page1 = getPage(allUsers, 1, 3);
System.out.println("ç¬¬1é¡µï¼š" + page1);  // [ç”¨æˆ·1, ç”¨æˆ·2, ç”¨æˆ·3]

// ç¬¬2é¡µï¼Œæ¯é¡µ3ä¸ª
List<String> page2 = getPage(allUsers, 2, 3);
System.out.println("ç¬¬2é¡µï¼š" + page2);  // [ç”¨æˆ·4, ç”¨æˆ·5, ç”¨æˆ·6]
```

### 2.6 æŸ¥æ‰¾æ“ä½œï¼šfindFirst() å’Œ findAny()


**ğŸ” å°±åƒæ‰¾ä¸œè¥¿ï¼šæ‰¾ç¬¬ä¸€ä¸ªæˆ–æ‰¾ä»»æ„ä¸€ä¸ª**

```java
List<String> words = Arrays.asList("apple", "banana", "cherry", "date");

// findFirst()ï¼šæ‰¾ç¬¬ä¸€ä¸ªåŒ¹é…çš„
Optional<String> first = words.stream()
    .filter(word -> word.length() > 5)  // é•¿åº¦å¤§äº5
    .findFirst();                       // æ‰¾ç¬¬ä¸€ä¸ª
if (first.isPresent()) {
    System.out.println("ç¬¬ä¸€ä¸ªé•¿è¯ï¼š" + first.get());  // banana
}

// findAny()ï¼šæ‰¾ä»»æ„ä¸€ä¸ªåŒ¹é…çš„ï¼ˆå¹¶è¡Œæµä¸­æ›´é«˜æ•ˆï¼‰
Optional<String> any = words.parallelStream()
    .filter(word -> word.length() > 5)
    .findAny();                         // æ‰¾ä»»æ„ä¸€ä¸ª
if (any.isPresent()) {
    System.out.println("ä»»æ„ä¸€ä¸ªé•¿è¯ï¼š" + any.get());  // å¯èƒ½æ˜¯bananaæˆ–cherry
}
```

**ğŸ’¡ Optionalæ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨å®ƒï¼Ÿ**

```java
// ä¼ ç»Ÿæ–¹å¼ï¼šå¯èƒ½è¿”å›nullï¼Œå®¹æ˜“å‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸
String findFirstLongWord(List<String> words) {
    for (String word : words) {
        if (word.length() > 5) {
            return word;  // æ‰¾åˆ°äº†è¿”å›
        }
    }
    return null;  // æ²¡æ‰¾åˆ°è¿”å›nullï¼Œå±é™©ï¼
}

// ä½¿ç”¨æ—¶éœ€è¦æ£€æŸ¥null
String result = findFirstLongWord(words);
if (result != null) {  // å®¹æ˜“å¿˜è®°æ£€æŸ¥
    System.out.println(result);
}

// Streamæ–¹å¼ï¼šè¿”å›Optionalï¼Œå¼ºåˆ¶å¤„ç†"æ²¡æ‰¾åˆ°"çš„æƒ…å†µ
Optional<String> result2 = words.stream()
    .filter(word -> word.length() > 5)
    .findFirst();

// å®‰å…¨çš„ä½¿ç”¨æ–¹å¼
result2.ifPresent(System.out::println);  // æœ‰å€¼æ‰æ‰“å°

// æˆ–è€…æä¾›é»˜è®¤å€¼
String word = result2.orElse("æ²¡æ‰¾åˆ°");  // æ²¡æ‰¾åˆ°æ—¶ä½¿ç”¨é»˜è®¤å€¼
```

### 2.7 åŒ¹é…æ“ä½œï¼šanyMatchã€allMatchã€noneMatch


**âœ… å°±åƒè€ƒè¯•åˆ¤åˆ†ï¼šæ˜¯å¦æœ‰äººåŠæ ¼ã€æ˜¯å¦å…¨éƒ¨åŠæ ¼ã€æ˜¯å¦å…¨éƒ¨ä¸åŠæ ¼**

```java
List<Integer> scores = Arrays.asList(85, 92, 78, 96, 88);

// anyMatch()ï¼šæ˜¯å¦æœ‰ä»»ä½•ä¸€ä¸ªåŒ¹é…
boolean hasHighScore = scores.stream()
    .anyMatch(score -> score >= 90);  // æ˜¯å¦æœ‰äºº90åˆ†ä»¥ä¸Š
System.out.println("æœ‰é«˜åˆ†å—ï¼š" + hasHighScore);  // true

// allMatch()ï¼šæ˜¯å¦å…¨éƒ¨åŒ¹é…
boolean allPassed = scores.stream()
    .allMatch(score -> score >= 60);  // æ˜¯å¦å…¨éƒ¨åŠæ ¼
System.out.println("å…¨éƒ¨åŠæ ¼å—ï¼š" + allPassed);  // true

// noneMatch()ï¼šæ˜¯å¦å…¨éƒ¨ä¸åŒ¹é…
boolean noneFailure = scores.stream()
    .noneMatch(score -> score < 60);  // æ˜¯å¦æ²¡æœ‰ä¸åŠæ ¼çš„
System.out.println("æ²¡æœ‰ä¸åŠæ ¼å—ï¼š" + noneFailure);  // true
```

**ğŸ¯ å®é™…åº”ç”¨ï¼šç”¨æˆ·æƒé™æ£€æŸ¥**

```java
class User {
    String name;
    String role;
    boolean isActive;
    
    User(String name, String role, boolean isActive) {
        this.name = name; this.role = role; this.isActive = isActive;
    }
}

List<User> users = Arrays.asList(
    new User("å¼ ä¸‰", "admin", true),
    new User("æå››", "user", true),
    new User("ç‹äº”", "user", false)
);

// æ£€æŸ¥æ˜¯å¦æœ‰ç®¡ç†å‘˜
boolean hasAdmin = users.stream()
    .anyMatch(user -> "admin".equals(user.role));
System.out.println("æœ‰ç®¡ç†å‘˜å—ï¼š" + hasAdmin);  // true

// æ£€æŸ¥æ˜¯å¦æ‰€æœ‰ç”¨æˆ·éƒ½æ˜¯æ´»è·ƒçš„
boolean allActive = users.stream()
    .allMatch(user -> user.isActive);
System.out.println("æ‰€æœ‰ç”¨æˆ·éƒ½æ´»è·ƒå—ï¼š" + allActive);  // false

// æ£€æŸ¥æ˜¯å¦æ²¡æœ‰è¢«ç¦ç”¨çš„ç®¡ç†å‘˜
boolean noInactiveAdmin = users.stream()
    .filter(user -> "admin".equals(user.role))  // å…ˆè¿‡æ»¤å‡ºç®¡ç†å‘˜
    .noneMatch(user -> !user.isActive);         // æ£€æŸ¥æ˜¯å¦æ²¡æœ‰éæ´»è·ƒçš„
System.out.println("æ²¡æœ‰è¢«ç¦ç”¨çš„ç®¡ç†å‘˜å—ï¼š" + noInactiveAdmin);  // true
```

### 2.8 èšåˆæ“ä½œï¼šreduce() - æŠŠå¤šä¸ªå˜æˆä¸€ä¸ª


**ğŸ¥˜ å°±åƒåšèœï¼šæŠŠå¾ˆå¤šé£Ÿæåˆå¹¶æˆä¸€é“èœ**

```java
List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5);

// æ±‚å’Œï¼šæŠŠæ‰€æœ‰æ•°å­—åŠ èµ·æ¥
Optional<Integer> sum = numbers.stream()
    .reduce((a, b) -> a + b);  // ä¸¤ä¸¤ç›¸åŠ 
System.out.println("æ€»å’Œï¼š" + sum.get());  // 15

// å¸¦åˆå§‹å€¼çš„æ±‚å’Œ
int sum2 = numbers.stream()
    .reduce(0, (a, b) -> a + b);  // ä»0å¼€å§‹ï¼Œä¸¤ä¸¤ç›¸åŠ 
System.out.println("æ€»å’Œï¼š" + sum2);  // 15

// æ±‚æœ€å¤§å€¼
Optional<Integer> max = numbers.stream()
    .reduce((a, b) -> a > b ? a : b);  // ä¸¤ä¸¤æ¯”è¾ƒï¼Œç•™å¤§çš„
System.out.println("æœ€å¤§å€¼ï¼š" + max.get());  // 5

// å­—ç¬¦ä¸²æ‹¼æ¥
List<String> words = Arrays.asList("Hello", "World", "Java");
String sentence = words.stream()
    .reduce("", (a, b) -> a + " " + b);  // ç”¨ç©ºæ ¼è¿æ¥
System.out.println("å¥å­ï¼š" + sentence.trim());  // Hello World Java
```

**ğŸ’¡ reduce()çš„å·¥ä½œåŸç†ï¼š**
```
åŸç†ï¼šä»å·¦åˆ°å³ï¼Œä¸¤ä¸¤åˆå¹¶ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªç»“æœ

reduce((a, b) -> a + b) çš„æ‰§è¡Œè¿‡ç¨‹ï¼š
[1, 2, 3, 4, 5]
ç¬¬1æ­¥ï¼š1 + 2 = 3
ç¬¬2æ­¥ï¼š3 + 3 = 6  
ç¬¬3æ­¥ï¼š6 + 4 = 10
ç¬¬4æ­¥ï¼š10 + 5 = 15
ç»“æœï¼š15

è®°å¿†ï¼šreduce = å‡å°‘ï¼ŒæŠŠå¤šä¸ªå…ƒç´ å‡å°‘ä¸ºä¸€ä¸ª
```

**ğŸ¯ å®é™…åº”ç”¨ï¼šè´­ç‰©è½¦è®¡ç®—**

```java
class Product {
    String name;
    double price;
    int quantity;
    
    Product(String name, double price, int quantity) {
        this.name = name; this.price = price; this.quantity = quantity;
    }
    
    double getTotalPrice() {
        return price * quantity;
    }
}

List<Product> cart = Arrays.asList(
    new Product("è‹¹æœ", 5.0, 3),    // 15å…ƒ
    new Product("é¦™è•‰", 3.0, 2),    // 6å…ƒ
    new Product("æ©˜å­", 4.0, 4)     // 16å…ƒ
);

// è®¡ç®—è´­ç‰©è½¦æ€»é‡‘é¢
double totalAmount = cart.stream()
    .map(Product::getTotalPrice)     // è½¬æ¢ï¼šå•†å“ â†’ æ€»ä»·
    .reduce(0.0, Double::sum);       // èšåˆï¼šæ‰€æœ‰æ€»ä»·ç›¸åŠ 
System.out.println("æ€»é‡‘é¢ï¼š" + totalAmount);  // 37.0

// æ‰¾æœ€è´µçš„å•†å“
Optional<Product> mostExpensive = cart.stream()
    .reduce((p1, p2) -> p1.getTotalPrice() > p2.getTotalPrice() ? p1 : p2);
if (mostExpensive.isPresent()) {
    System.out.println("æœ€è´µå•†å“ï¼š" + mostExpensive.get().name);  // æ©˜å­
}
```

### 2.9 æ”¶é›†æ“ä½œï¼šcollect() - æŠŠç»“æœè£…èµ·æ¥


**ğŸ“¦ å°±åƒè£…è´§ç‰©ï¼šæŠŠå¤„ç†å¥½çš„ä¸œè¥¿è£…åˆ°ä¸åŒçš„å®¹å™¨é‡Œ**

```java
List<String> words = Arrays.asList("apple", "banana", "cherry", "date", "elderberry");

// æ”¶é›†åˆ°List
List<String> longWords = words.stream()
    .filter(word -> word.length() > 5)
    .collect(Collectors.toList());
System.out.println("é•¿å•è¯Listï¼š" + longWords);  // [banana, cherry, elderberry]

// æ”¶é›†åˆ°Setï¼ˆè‡ªåŠ¨å»é‡ï¼‰
Set<Integer> lengths = words.stream()
    .map(String::length)
    .collect(Collectors.toSet());
System.out.println("é•¿åº¦Setï¼š" + lengths);  // [4, 5, 6, 10]ï¼ˆè‡ªåŠ¨å»é‡æ’åºï¼‰

// æ”¶é›†åˆ°å­—ç¬¦ä¸²
String joined = words.stream()
    .filter(word -> word.length() <= 5)
    .collect(Collectors.joining(", "));  // ç”¨é€—å·è¿æ¥
System.out.println("çŸ­å•è¯ï¼š" + joined);  // apple, date

// æ”¶é›†åˆ°Mapï¼šæŒ‰é•¿åº¦åˆ†ç»„
Map<Integer, List<String>> groupByLength = words.stream()
    .collect(Collectors.groupingBy(String::length));  // æŒ‰é•¿åº¦åˆ†ç»„
System.out.println("æŒ‰é•¿åº¦åˆ†ç»„ï¼š" + groupByLength);
// {4=[date], 5=[apple], 6=[banana, cherry], 10=[elderberry]}
```

**ğŸ¯ é«˜çº§æ”¶é›†ï¼šç»Ÿè®¡ä¿¡æ¯**

```java
List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);

// ç»Ÿè®¡ä¿¡æ¯ï¼šä¸€æ¬¡æ€§å¾—åˆ° æ€»æ•°ã€æ€»å’Œã€å¹³å‡å€¼ã€æœ€å¤§å€¼ã€æœ€å°å€¼
IntSummaryStatistics stats = numbers.stream()
    .mapToInt(Integer::intValue)
    .summaryStatistics();

System.out.println("æ€»æ•°ï¼š" + stats.getCount());    // 10
System.out.println("æ€»å’Œï¼š" + stats.getSum());      // 55  
System.out.println("å¹³å‡å€¼ï¼š" + stats.getAverage()); // 5.5
System.out.println("æœ€å¤§å€¼ï¼š" + stats.getMax());    // 10
System.out.println("æœ€å°å€¼ï¼š" + stats.getMin());    // 1

// åˆ†åŒºï¼šæŠŠå…ƒç´ åˆ†æˆä¸¤ç»„
Map<Boolean, List<Integer>> partitioned = numbers.stream()
    .collect(Collectors.partitioningBy(num -> num % 2 == 0));  // æŒ‰å¥‡å¶åˆ†ç»„
System.out.println("å¶æ•°ï¼š" + partitioned.get(true));   // [2, 4, 6, 8, 10]
System.out.println("å¥‡æ•°ï¼š" + partitioned.get(false));  // [1, 3, 5, 7, 9]
```

### 2.10 æ ¸å¿ƒæ“ä½œæ€»ç»“


**ğŸ¯ Streamæ ¸å¿ƒæ“ä½œè®°å¿†è¡¨ï¼š**

| **æ“ä½œç±»å‹** | **æ–¹æ³•** | **ä½œç”¨** | **è®°å¿†å£è¯€** |
|------------|---------|---------|-------------|
| **è¿‡æ»¤** | `filter()` | æŒ‘é€‰æ»¡è¶³æ¡ä»¶çš„å…ƒç´  | è¿‡æ»¤å™¨ï¼Œç•™å¥½æ‰”å |
| **è½¬æ¢** | `map()` | æŠŠæ¯ä¸ªå…ƒç´ å˜æˆå¦ä¸€ç§ | åŠ å·¥å‚ï¼ŒAå˜B |
| **æ’åº** | `sorted()` | æŒ‰æŒ‡å®šé¡ºåºæ’åˆ— | æ’é˜Ÿç«™å¥½ |
| **å»é‡** | `distinct()` | å»é™¤é‡å¤å…ƒç´  | å»é‡å¤ï¼Œç•™å”¯ä¸€ |
| **æˆªå–** | `limit()` | åªè¦å‰Nä¸ª | é™åˆ¶æ•°é‡ |
| **è·³è¿‡** | `skip()` | è·³è¿‡å‰Nä¸ª | è·³è¿‡å¼€å¤´ |
| **æŸ¥æ‰¾** | `findFirst()/findAny()` | æ‰¾ç¬¬ä¸€ä¸ª/ä»»æ„ä¸€ä¸ª | æ‰¾åˆ°å°±è¡Œ |
| **åŒ¹é…** | `anyMatch()/allMatch()` | æ£€æŸ¥æ˜¯å¦åŒ¹é… | è€ƒè¯•åˆ¤åˆ† |
| **èšåˆ** | `reduce()` | æŠŠå¤šä¸ªåˆå¹¶æˆä¸€ä¸ª | åšèœåˆå¹¶ |
| **æ”¶é›†** | `collect()` | æŠŠç»“æœè£…åˆ°å®¹å™¨ | è£…ç®±æ‰“åŒ… |

**ğŸ”§ æ“ä½œé“¾æ¨¡æ¿ï¼š**
```java
List<ç»“æœç±»å‹> result = æ•°æ®æº.stream()
    .filter(å…ƒç´  -> è¿‡æ»¤æ¡ä»¶)        // ç­›é€‰
    .map(å…ƒç´  -> è½¬æ¢é€»è¾‘)           // è½¬æ¢  
    .sorted(æ’åºè§„åˆ™)               // æ’åº
    .distinct()                    // å»é‡
    .limit(æ•°é‡)                   // é™åˆ¶
    .collect(Collectors.toList()); // æ”¶é›†
```

**ğŸ’¡ é€‰æ‹©æŒ‡å—ï¼š**
```
æƒ³ç­›é€‰ â†’ filter()
æƒ³è½¬æ¢ â†’ map()  
æƒ³æ’åº â†’ sorted()
æƒ³å»é‡ â†’ distinct()
æƒ³é™åˆ¶æ•°é‡ â†’ limit()/skip()
æƒ³æŸ¥æ‰¾ â†’ findFirst()/findAny()
æƒ³æ£€æŸ¥ â†’ anyMatch()/allMatch()
æƒ³åˆå¹¶ â†’ reduce()
æƒ³æ”¶é›† â†’ collect()
```

**ğŸ“ è®°å¿†å£è¯€ï¼š**
```
è¿‡æ»¤è½¬æ¢æ’åºå¥½ï¼Œå»é‡é™åˆ¶ä¸èƒ½å°‘
æŸ¥æ‰¾åŒ¹é…æ¥æ£€éªŒï¼Œèšåˆæ”¶é›†æœ€é‡è¦
é“¾å¼è°ƒç”¨ä¸€æ°”å‘µæˆï¼Œæµæ°´ä½œä¸šæ•ˆç‡é«˜
```

---

## 3. ğŸš€ Streamé«˜çº§åº”ç”¨


### 3.1 å¤æ‚æ•°æ®åˆ†ç»„ï¼šgroupingBy() - ç»™æ•°æ®åˆ†ç±»æ•´ç†


**ğŸ“š å°±åƒæ•´ç†å›¾ä¹¦é¦†ï¼šæŠŠä¹¦æŒ‰ç±»å‹åˆ†åˆ°ä¸åŒä¹¦æ¶**

```java
// å­¦ç”Ÿæˆç»©æ•°æ®
class Student {
    String name;
    String subject;
    int score;
    String grade;
    
    Student(String name, String subject, int score, String grade) {
        this.name = name; this.subject = subject; 
        this.score = score; this.grade = grade;
    }
    
    @Override
    public String toString() {
        return name + "(" + subject + ":" + score + "åˆ†)";
    }
}

List<Student> students = Arrays.asList(
    new Student("å¼ ä¸‰", "æ•°å­¦", 85, "A"),
    new Student("å¼ ä¸‰", "è‹±è¯­", 92, "A"),
    new Student("æå››", "æ•°å­¦", 78, "B"),
    new Student("æå››", "è‹±è¯­", 88, "A"),
    new Student("ç‹äº”", "æ•°å­¦", 95, "A"),
    new Student("ç‹äº”", "è‹±è¯­", 76, "B")
);

// æŒ‰å­¦ç”Ÿå§“ååˆ†ç»„
Map<String, List<Student>> byName = students.stream()
    .collect(Collectors.groupingBy(student -> student.name));
System.out.println("æŒ‰å§“ååˆ†ç»„ï¼š");
byName.forEach((name, list) -> {
    System.out.println(name + ": " + list);
});
// å¼ ä¸‰: [å¼ ä¸‰(æ•°å­¦:85åˆ†), å¼ ä¸‰(è‹±è¯­:92åˆ†)]
// æå››: [æå››(æ•°å­¦:78åˆ†), æå››(è‹±è¯­:88åˆ†)]
// ç‹äº”: [ç‹äº”(æ•°å­¦:95åˆ†), ç‹äº”(è‹±è¯­:76åˆ†)]

// æŒ‰ç§‘ç›®åˆ†ç»„
Map<String, List<Student>> bySubject = students.stream()
    .collect(Collectors.groupingBy(student -> student.subject));
System.out.println("\næŒ‰ç§‘ç›®åˆ†ç»„ï¼š");
bySubject.forEach((subject, list) -> {
    System.out.println(subject + ": " + list);
});
// æ•°å­¦: [å¼ ä¸‰(æ•°å­¦:85åˆ†), æå››(æ•°å­¦:78åˆ†), ç‹äº”(æ•°å­¦:95åˆ†)]
// è‹±è¯­: [å¼ ä¸‰(è‹±è¯­:92åˆ†), æå››(è‹±è¯­:88åˆ†), ç‹äº”(è‹±è¯­:76åˆ†)]
```

**ğŸ¯ é«˜çº§åˆ†ç»„ï¼šåˆ†ç»„åå†å¤„ç†**

```java
// åˆ†ç»„åç»Ÿè®¡æ¯ç»„æ•°é‡
Map<String, Long> countBySubject = students.stream()
    .collect(Collectors.groupingBy(
        student -> student.subject,          // åˆ†ç»„æ¡ä»¶ï¼šæŒ‰ç§‘ç›®
        Collectors.counting()               // åˆ†ç»„åæ“ä½œï¼šè®¡æ•°
    ));
System.out.println("å„ç§‘ç›®äººæ•°ï¼š" + countBySubject);
// {æ•°å­¦=3, è‹±è¯­=3}

// åˆ†ç»„åè®¡ç®—å¹³å‡åˆ†
Map<String, Double> avgBySubject = students.stream()
    .collect(Collectors.groupingBy(
        student -> student.subject,          // åˆ†ç»„æ¡ä»¶
        Collectors.averagingInt(student -> student.score)  // åˆ†ç»„åæ“ä½œï¼šè®¡ç®—å¹³å‡å€¼
    ));
System.out.println("å„ç§‘ç›®å¹³å‡åˆ†ï¼š" + avgBySubject);
// {æ•°å­¦=86.0, è‹±è¯­=85.33333333333333}

// åˆ†ç»„åæ”¶é›†ç‰¹å®šå­—æ®µ
Map<String, List<String>> namesBySubject = students.stream()
    .collect(Collectors.groupingBy(
        student -> student.subject,          // åˆ†ç»„æ¡ä»¶
        Collectors.mapping(                  // åˆ†ç»„åæ“ä½œï¼šè½¬æ¢å¹¶æ”¶é›†
            student -> student.name,         // è½¬æ¢ï¼šå­¦ç”Ÿ â†’ å§“å
            Collectors.toList()              // æ”¶é›†ä¸ºList
        )
    ));
System.out.println("å„ç§‘ç›®å­¦ç”Ÿå§“åï¼š" + namesBySubject);
// {æ•°å­¦=[å¼ ä¸‰, æå››, ç‹äº”], è‹±è¯­=[å¼ ä¸‰, æå››, ç‹äº”]}
```

### 3.2 å¤šçº§åˆ†ç»„ï¼šå±‚å±‚åˆ†ç±»


**ğŸ—‚ï¸ å°±åƒå…¬å¸ç»„ç»‡æ¶æ„ï¼šéƒ¨é—¨ â†’ å°ç»„ â†’ ä¸ªäºº**

```java
// å¤šçº§åˆ†ç»„ï¼šå…ˆæŒ‰ç§‘ç›®åˆ†ï¼Œå†æŒ‰ç­‰çº§åˆ†
Map<String, Map<String, List<Student>>> multiLevel = students.stream()
    .collect(Collectors.groupingBy(
        student -> student.subject,         // ç¬¬ä¸€çº§åˆ†ç»„ï¼šç§‘ç›®
        Collectors.groupingBy(student -> student.grade)  // ç¬¬äºŒçº§åˆ†ç»„ï¼šç­‰çº§
    ));

System.out.println("å¤šçº§åˆ†ç»„ï¼š");
multiLevel.forEach((subject, gradeMap) -> {
    System.out.println(subject + ":");
    gradeMap.forEach((grade, studentList) -> {
        System.out.println("  " + grade + "ç­‰: " + studentList);
    });
});
// æ•°å­¦:
//   Aç­‰: [å¼ ä¸‰(æ•°å­¦:85åˆ†), ç‹äº”(æ•°å­¦:95åˆ†)]
//   Bç­‰: [æå››(æ•°å­¦:78åˆ†)]
// è‹±è¯­:
//   Aç­‰: [å¼ ä¸‰(è‹±è¯­:92åˆ†), æå››(è‹±è¯­:88åˆ†)]
//   Bç­‰: [ç‹äº”(è‹±è¯­:76åˆ†)]

// å¤šçº§åˆ†ç»„åç»Ÿè®¡
Map<String, Map<String, Long>> multiLevelCount = students.stream()
    .collect(Collectors.groupingBy(
        student -> student.subject,         // ç¬¬ä¸€çº§ï¼šç§‘ç›®
        Collectors.groupingBy(             // ç¬¬äºŒçº§ï¼šç­‰çº§
            student -> student.grade,
            Collectors.counting()           // ç»Ÿè®¡æ¯ç»„äººæ•°
        )
    ));
System.out.println("å¤šçº§ç»Ÿè®¡ï¼š" + multiLevelCount);
// {æ•°å­¦={A=2, B=1}, è‹±è¯­={A=2, B=1}}
```

### 3.3 æ•°æ®åˆ†åŒºï¼špartitioningBy() - ä¸€åˆ†ä¸ºäºŒ


**âš–ï¸ å°±åƒç­›é€‰ï¼šæŠŠæ•°æ®åˆ†æˆä¸¤å †ï¼Œæ»¡è¶³æ¡ä»¶çš„ä¸€å †ï¼Œä¸æ»¡è¶³çš„ä¸€å †**

```java
// æŒ‰åˆ†æ•°åˆ†åŒºï¼š80åˆ†ä»¥ä¸Šå’Œ80åˆ†ä»¥ä¸‹
Map<Boolean, List<Student>> partitioned = students.stream()
    .collect(Collectors.partitioningBy(student -> student.score >= 80));

System.out.println("é«˜åˆ†å­¦ç”Ÿï¼ˆâ‰¥80ï¼‰ï¼š" + partitioned.get(true));
System.out.println("ä½åˆ†å­¦ç”Ÿï¼ˆ<80ï¼‰ï¼š" + partitioned.get(false));

// åˆ†åŒºåç»Ÿè®¡
Map<Boolean, Long> partitionCount = students.stream()
    .collect(Collectors.partitioningBy(
        student -> student.score >= 80,    // åˆ†åŒºæ¡ä»¶
        Collectors.counting()              // åˆ†åŒºåç»Ÿè®¡
    ));
System.out.println("é«˜åˆ†äººæ•°ï¼š" + partitionCount.get(true));
System.out.println("ä½åˆ†äººæ•°ï¼š" + partitionCount.get(false));

// åˆ†åŒºåè®¡ç®—å¹³å‡åˆ†
Map<Boolean, Double> partitionAvg = students.stream()
    .collect(Collectors.partitioningBy(
        student -> student.score >= 80,
        Collectors.averagingInt(student -> student.score)
    ));
System.out.println("é«˜åˆ†ç»„å¹³å‡åˆ†ï¼š" + partitionAvg.get(true));
System.out.println("ä½åˆ†ç»„å¹³å‡åˆ†ï¼š" + partitionAvg.get(false));
```

### 3.4 è‡ªå®šä¹‰æ”¶é›†å™¨ï¼šåšä½ æƒ³è¦çš„æ”¶é›†


**ğŸ”§ å°±åƒå®šåˆ¶å·¥å…·ï¼šæ ‡å‡†å·¥å…·ä¸å¤Ÿç”¨æ—¶ï¼Œè‡ªå·±åšä¸€ä¸ª**

```java
// éœ€æ±‚ï¼šæ”¶é›†æ‰€æœ‰å­¦ç”Ÿå§“åï¼Œç”¨" | "åˆ†éš”ï¼Œå¹¶åŠ ä¸Šå‰ç¼€åç¼€
String customResult = students.stream()
    .map(student -> student.name)
    .distinct()  // å»é‡
    .collect(Collectors.joining(
        " | ",           // åˆ†éš”ç¬¦
        "å­¦ç”Ÿåå•: [",    // å‰ç¼€
        "]"             // åç¼€
    ));
System.out.println(customResult);  // å­¦ç”Ÿåå•: [å¼ ä¸‰ | æå›› | ç‹äº”]

// è‡ªå®šä¹‰æ”¶é›†ï¼šæ”¶é›†åˆ°ç‰¹å®šæ•°æ®ç»“æ„
class ScoreStatistics {
    private int totalScore = 0;
    private int count = 0;
    private int maxScore = Integer.MIN_VALUE;
    private int minScore = Integer.MAX_VALUE;
    
    public void add(int score) {
        totalScore += score;
        count++;
        maxScore = Math.max(maxScore, score);
        minScore = Math.min(minScore, score);
    }
    
    public ScoreStatistics merge(ScoreStatistics other) {
        totalScore += other.totalScore;
        count += other.count;
        maxScore = Math.max(maxScore, other.maxScore);
        minScore = Math.min(minScore, other.minScore);
        return this;
    }
    
    public double getAverage() {
        return count > 0 ? (double) totalScore / count : 0;
    }
    
    @Override
    public String toString() {
        return String.format("ç»Ÿè®¡{æ€»åˆ†:%d, äººæ•°:%d, å¹³å‡:%.1f, æœ€é«˜:%d, æœ€ä½:%d}", 
                           totalScore, count, getAverage(), maxScore, minScore);
    }
}

// ä½¿ç”¨è‡ªå®šä¹‰æ”¶é›†å™¨
ScoreStatistics mathStats = students.stream()
    .filter(student -> "æ•°å­¦".equals(student.subject))  // åªè¦æ•°å­¦æˆç»©
    .collect(
        ScoreStatistics::new,           // åˆ›å»ºå®¹å™¨
        (stats, student) -> stats.add(student.score),  // æ·»åŠ å…ƒç´ 
        ScoreStatistics::merge          // åˆå¹¶å®¹å™¨ï¼ˆå¹¶è¡Œæ—¶ç”¨ï¼‰
    );
System.out.println("æ•°å­¦æˆç»©" + mathStats);
// æ•°å­¦æˆç»©ç»Ÿè®¡{æ€»åˆ†:258, äººæ•°:3, å¹³å‡:86.0, æœ€é«˜:95, æœ€ä½:78}
```

### 3.5 æµçš„æ‰å¹³åŒ–ï¼šflatMap() - æ‰“å¼€ç›’å­å–ä¸œè¥¿


**ğŸ“¦ å°±åƒæ‹†å¿«é€’ï¼šæŠŠæ¯ä¸ªåŒ…è£¹é‡Œçš„ä¸œè¥¿éƒ½å–å‡ºæ¥æ”¾åœ¨ä¸€èµ·**

```java
// æ¯ä¸ªå­¦ç”Ÿæœ‰å¤šä¸ªç§‘ç›®æˆç»©
class Student2 {
    String name;
    List<String> subjects;
    
    Student2(String name, List<String> subjects) {
        this.name = name;
        this.subjects = subjects;
    }
}

List<Student2> students2 = Arrays.asList(
    new Student2("å¼ ä¸‰", Arrays.asList("æ•°å­¦", "è‹±è¯­", "ç‰©ç†")),
    new Student2("æå››", Arrays.asList("æ•°å­¦", "åŒ–å­¦")),
    new Student2("ç‹äº”", Arrays.asList("è‹±è¯­", "ç”Ÿç‰©", "å†å²"))
);

// æ™®é€šmapï¼šå¾—åˆ°List<List<String>>ï¼ŒåµŒå¥—ç»“æ„
List<List<String>> nestedSubjects = students2.stream()
    .map(student -> student.subjects)  // æ¯ä¸ªå­¦ç”Ÿ â†’ ç§‘ç›®åˆ—è¡¨
    .collect(Collectors.toList());
System.out.println("åµŒå¥—ç»“æ„ï¼š" + nestedSubjects);
// [[æ•°å­¦, è‹±è¯­, ç‰©ç†], [æ•°å­¦, åŒ–å­¦], [è‹±è¯­, ç”Ÿç‰©, å†å²]]

// flatMapï¼šå¾—åˆ°List<String>ï¼Œæ‰å¹³ç»“æ„
List<String> flatSubjects = students2.stream()
    .flatMap(student -> student.subjects.stream())  // æŠŠæ¯ä¸ªåˆ—è¡¨"æ‘Šå¹³"
    .collect(Collectors.toList());
System.out.println("æ‰å¹³ç»“æ„ï¼š" + flatSubjects);
// [æ•°å­¦, è‹±è¯­, ç‰©ç†, æ•°å­¦, åŒ–å­¦, è‹±è¯­, ç”Ÿç‰©, å†å²]

// æ‰å¹³åŒ–åå»é‡ï¼Œå¾—åˆ°æ‰€æœ‰ä¸é‡å¤çš„ç§‘ç›®
List<String> uniqueSubjects = students2.stream()
    .flatMap(student -> student.subjects.stream())
    .distinct()  // å»é‡
    .collect(Collectors.toList());
System.out.println("æ‰€æœ‰ç§‘ç›®ï¼š" + uniqueSubjects);
// [æ•°å­¦, è‹±è¯­, ç‰©ç†, åŒ–å­¦, ç”Ÿç‰©, å†å²]
```

**ğŸ¯ å®é™…åº”ç”¨ï¼šå¤„ç†åµŒå¥—æ•°æ®**

```java
// è®¢å•æ•°æ®ï¼šæ¯ä¸ªè®¢å•åŒ…å«å¤šä¸ªå•†å“
class Order {
    String orderId;
    List<String> products;
    
    Order(String orderId, List<String> products) {
        this.orderId = orderId;
        this.products = products;
    }
}

List<Order> orders = Arrays.asList(
    new Order("è®¢å•1", Arrays.asList("è‹¹æœ", "é¦™è•‰", "æ©˜å­")),
    new Order("è®¢å•2", Arrays.asList("è‹¹æœ", "è‘¡è„")),
    new Order("è®¢å•3", Arrays.asList("é¦™è•‰", "è¥¿ç“œ", "è‹¹æœ"))
);

// ç»Ÿè®¡æ‰€æœ‰å•†å“çš„é”€å”®æ¬¡æ•°
Map<String, Long> productCount = orders.stream()
    .flatMap(order -> order.products.stream())  // æ‰å¹³åŒ–ï¼šè®¢å• â†’ å•†å“æµ
    .collect(Collectors.groupingBy(
        product -> product,                     // æŒ‰å•†å“åˆ†ç»„
        Collectors.counting()                   // è®¡æ•°
    ));
System.out.println("å•†å“é”€å”®ç»Ÿè®¡ï¼š" + productCount);
// {è‹¹æœ=3, é¦™è•‰=2, æ©˜å­=1, è‘¡è„=1, è¥¿ç“œ=1}

// æ‰¾å‡ºæœ€çƒ­é”€çš„å•†å“
Optional<Map.Entry<String, Long>> hottest = productCount.entrySet().stream()
    .max(Map.Entry.comparingByValue());  // æŒ‰é”€å”®é‡æ¯”è¾ƒ
hottest.ifPresent(entry -> 
    System.out.println("æœ€çƒ­é”€å•†å“ï¼š" + entry.getKey() + "ï¼Œé”€å”®" + entry.getValue() + "æ¬¡")
);
// æœ€çƒ­é”€å•†å“ï¼šè‹¹æœï¼Œé”€å”®3æ¬¡
```

### 3.6 å¹¶è¡Œæµçš„æ­£ç¡®ä½¿ç”¨ï¼šä»€ä¹ˆæ—¶å€™ç”¨ï¼Œæ€ä¹ˆç”¨


**âš¡ å¹¶è¡Œæµï¼šå¤šä¸ªå·¥äººåŒæ—¶å¹²æ´»ï¼Œä½†è¦æ³¨æ„åè°ƒ**

```java
// æ€§èƒ½æµ‹è¯•ï¼šä¸²è¡Œ vs å¹¶è¡Œ
List<Integer> bigList = IntStream.rangeClosed(1, 10_000_000)
    .boxed()
    .collect(Collectors.toList());

// ä¸²è¡Œæµï¼šè®¡ç®—å¹³æ–¹å’Œ
long start = System.currentTimeMillis();
long sum1 = bigList.stream()
    .mapToLong(x -> x * x)
    .sum();
long time1 = System.currentTimeMillis() - start;
System.out.println("ä¸²è¡Œæµç»“æœï¼š" + sum1 + "ï¼Œè€—æ—¶ï¼š" + time1 + "ms");

// å¹¶è¡Œæµï¼šè®¡ç®—å¹³æ–¹å’Œ
start = System.currentTimeMillis();
long sum2 = bigList.parallelStream()
    .mapToLong(x -> x * x)
    .sum();
long time2 = System.currentTimeMillis() - start;
System.out.println("å¹¶è¡Œæµç»“æœï¼š" + sum2 + "ï¼Œè€—æ—¶ï¼š" + time2 + "ms");

System.out.println("æ€§èƒ½æå‡ï¼š" + (double)time1/time2 + "å€");
```

**ğŸš¨ å¹¶è¡Œæµçš„é™·é˜±ï¼šçº¿ç¨‹å®‰å…¨é—®é¢˜**

```java
List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);

// âŒ å±é™©ï¼šå¹¶è¡Œæµæ“ä½œå…±äº«å˜é‡ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰
List<Integer> sharedList = new ArrayList<>();  // ArrayListä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„
numbers.parallelStream().forEach(sharedList::add);  // å¯èƒ½ä¸¢å¤±æ•°æ®ï¼
System.out.println("ä¸å®‰å…¨æ“ä½œç»“æœå¤§å°ï¼š" + sharedList.size());  // å¯èƒ½å°äº10

// âœ… å®‰å…¨ï¼šä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„é›†åˆ
List<Integer> safeList = Collections.synchronizedList(new ArrayList<>());
numbers.parallelStream().forEach(safeList::add);
System.out.println("å®‰å…¨æ“ä½œç»“æœå¤§å°ï¼š" + safeList.size());  // æ€»æ˜¯10

// âœ… æ›´å¥½ï¼šä½¿ç”¨collectæ”¶é›†ç»“æœ
List<Integer> collectedList = numbers.parallelStream()
    .collect(Collectors.toList());  // collectæ˜¯çº¿ç¨‹å®‰å…¨çš„
System.out.println("collectç»“æœå¤§å°ï¼š" + collectedList.size());  // æ€»æ˜¯10

// âŒ å±é™©ï¼šå¹¶è¡Œæµä¸­çš„å…±äº«è®¡æ•°å™¨
int[] counter = {0};  // å…±äº«å˜é‡
numbers.parallelStream().forEach(x -> counter[0]++);  // ç«æ€æ¡ä»¶ï¼
System.out.println("ä¸å®‰å…¨è®¡æ•°ï¼š" + counter[0]);  // å¯èƒ½å°äº10

// âœ… å®‰å…¨ï¼šä½¿ç”¨åŸå­ç±»
AtomicInteger atomicCounter = new AtomicInteger(0);
numbers.parallelStream().forEach(x -> atomicCounter.incrementAndGet());
System.out.println("å®‰å…¨è®¡æ•°ï¼š" + atomicCounter.get());  // æ€»æ˜¯10
```

**ğŸ’¡ å¹¶è¡Œæµä½¿ç”¨æŒ‡å—ï¼š**

```java
// âœ… é€‚åˆå¹¶è¡Œçš„åœºæ™¯
List<Integer> bigData = IntStream.rangeClosed(1, 1_000_000).boxed().collect(Collectors.toList());

// 1. CPUå¯†é›†å‹è®¡ç®—
long sum = bigData.parallelStream()
    .mapToLong(x -> expensiveComputation(x))  // å¤æ‚è®¡ç®—
    .sum();

// 2. å¤§æ•°æ®é‡çš„ç®€å•æ“ä½œ
List<Integer> filtered = bigData.parallelStream()
    .filter(x -> x % 2 == 0)
    .collect(Collectors.toList());

// âŒ ä¸é€‚åˆå¹¶è¡Œçš„åœºæ™¯
List<Integer> smallData = Arrays.asList(1, 2, 3, 4, 5);

// 1. æ•°æ®é‡å°ï¼ˆå¹¶è¡Œå¼€é”€ > æ€§èƒ½æ”¶ç›Šï¼‰
int smallSum = smallData.stream()  // ç”¨ä¸²è¡Œæµ
    .mapToInt(Integer::intValue)
    .sum();

// 2. æœ‰é¡ºåºè¦æ±‚çš„æ“ä½œ
List<Integer> ordered = bigData.stream()  // ç”¨ä¸²è¡Œæµä¿è¯é¡ºåº
    .sorted()
    .limit(100)
    .collect(Collectors.toList());

// 3. I/Oå¯†é›†å‹æ“ä½œï¼ˆå¹¶è¡Œä¸èƒ½æå‡I/Oæ€§èƒ½ï¼‰
List<String> results = urls.stream()  // ç”¨ä¸²è¡Œæµ
    .map(this::fetchDataFromUrl)  // ç½‘ç»œè¯·æ±‚
    .collect(Collectors.toList());
```

### 3.7 Streamä¸Optionalçš„ç»“åˆä½¿ç”¨


**ğŸ” Optionalï¼šä¼˜é›…å¤„ç†"å¯èƒ½æ²¡æœ‰"çš„æƒ…å†µ**

```java
List<Student> students = Arrays.asList(
    new Student("å¼ ä¸‰", "æ•°å­¦", 85, "A"),
    new Student("æå››", "æ•°å­¦", 78, "B"),
    new Student("ç‹äº”", "æ•°å­¦", 95, "A")
);

// æŸ¥æ‰¾ç¬¬ä¸€ä¸ªAç­‰å­¦ç”Ÿ
Optional<Student> firstA = students.stream()
    .filter(student -> "A".equals(student.grade))
    .findFirst();

// ä¼ ç»Ÿå¤„ç†æ–¹å¼ï¼ˆå®¹æ˜“å¿˜è®°æ£€æŸ¥ï¼‰
if (firstA.isPresent()) {
    System.out.println("æ‰¾åˆ°Aç­‰å­¦ç”Ÿï¼š" + firstA.get().name);
} else {
    System.out.println("æ²¡æœ‰æ‰¾åˆ°Aç­‰å­¦ç”Ÿ");
}

// ä¼˜é›…çš„å¤„ç†æ–¹å¼
firstA.ifPresent(student -> System.out.println("æ‰¾åˆ°Aç­‰å­¦ç”Ÿï¼š" + student.name));

// æä¾›é»˜è®¤å€¼
String result = firstA.map(student -> student.name)  // å¦‚æœæœ‰å€¼ï¼Œå–å§“å
                     .orElse("æ²¡æœ‰Aç­‰å­¦ç”Ÿ");          // å¦‚æœæ²¡æœ‰å€¼ï¼Œä½¿ç”¨é»˜è®¤å€¼
System.out.println(result);

// é“¾å¼å¤„ç†ï¼šæŸ¥æ‰¾ â†’ è½¬æ¢ â†’ è¿‡æ»¤ â†’ è·å–ç»“æœ
String bestStudentSubject = students.stream()
    .filter(student -> student.score >= 90)    // æ‰¾é«˜åˆ†å­¦ç”Ÿ
    .findFirst()                               // å–ç¬¬ä¸€ä¸ª
    .map(student -> student.subject)           // è½¬æ¢ä¸ºç§‘ç›®
    .orElse("æ²¡æœ‰é«˜åˆ†å­¦ç”Ÿ");                    // æä¾›é»˜è®¤å€¼
System.out.println("æœ€ä½³å­¦ç”Ÿçš„ç§‘ç›®ï¼š" + bestStudentSubject);
```

### 3.8 å¤æ‚ä¸šåŠ¡åœºæ™¯å®æˆ˜


**ğŸª ç”µå•†è®¢å•åˆ†æç³»ç»Ÿ**

```java
// è®¢å•æ•°æ®æ¨¡å‹
class OrderItem {
    String orderId;
    String customerId;
    String productName;
    double price;
    int quantity;
    LocalDate orderDate;
    String category;
    
    OrderItem(String orderId, String customerId, String productName, 
              double price, int quantity, LocalDate orderDate, String category) {
        this.orderId = orderId; this.customerId = customerId; 
        this.productName = productName; this.price = price; 
        this.quantity = quantity; this.orderDate = orderDate; 
        this.category = category;
    }
    
    double getTotalAmount() {
        return price * quantity;
    }
}

// æ¨¡æ‹Ÿè®¢å•æ•°æ®
List<OrderItem> orders = Arrays.asList(
    new OrderItem("001", "ç”¨æˆ·A", "iPhone", 8000, 1, LocalDate.of(2024, 1, 15), "ç”µå­äº§å“"),
    new OrderItem("002", "ç”¨æˆ·A", "iPad", 4000, 1, LocalDate.of(2024, 1, 20), "ç”µå­äº§å“"),
    new OrderItem("003", "ç”¨æˆ·B", "å’–å•¡", 50, 3, LocalDate.of(2024, 1, 25), "é£Ÿå“"),
    new OrderItem("004", "ç”¨æˆ·B", "iPhone", 8000, 1, LocalDate.of(2024, 2, 1), "ç”µå­äº§å“"),
    new OrderItem("005", "ç”¨æˆ·C", "å›¾ä¹¦", 100, 5, LocalDate.of(2024, 2, 10), "å›¾ä¹¦"),
    new OrderItem("006", "ç”¨æˆ·A", "å’–å•¡", 50, 2, LocalDate.of(2024, 2, 15), "é£Ÿå“")
);

// ä¸šåŠ¡åˆ†æ1ï¼šè®¡ç®—æ¯ä¸ªå®¢æˆ·çš„æ€»æ¶ˆè´¹
Map<String, Double> customerSpending = orders.stream()
    .collect(Collectors.groupingBy(
        order -> order.customerId,
        Collectors.summingDouble(OrderItem::getTotalAmount)
    ));
System.out.println("å®¢æˆ·æ¶ˆè´¹ç»Ÿè®¡ï¼š" + customerSpending);

// ä¸šåŠ¡åˆ†æ2ï¼šæ‰¾å‡ºæœ€å—æ¬¢è¿çš„å•†å“ç±»åˆ«
Map<String, Long> categoryCount = orders.stream()
    .collect(Collectors.groupingBy(
        order -> order.category,
        Collectors.counting()
    ));
String popularCategory = categoryCount.entrySet().stream()
    .max(Map.Entry.comparingByValue())
    .map(Map.Entry::getKey)
    .orElse("æ— æ•°æ®");
System.out.println("æœ€å—æ¬¢è¿ç±»åˆ«ï¼š" + popularCategory);

// ä¸šåŠ¡åˆ†æ3ï¼šåˆ†ææœˆåº¦é”€å”®è¶‹åŠ¿
Map<String, Double> monthlySales = orders.stream()
    .collect(Collectors.groupingBy(
        order -> order.orderDate.getYear() + "-" + 
                String.format("%02d", order.orderDate.getMonthValue()),
        Collectors.summingDouble(OrderItem::getTotalAmount)
    ));
System.out.println("æœˆåº¦é”€å”®ï¼š" + monthlySales);

// ä¸šåŠ¡åˆ†æ4ï¼šæ‰¾å‡ºé«˜ä»·å€¼å®¢æˆ·ï¼ˆæ¶ˆè´¹è¶…è¿‡10000çš„å®¢æˆ·ï¼‰
List<String> vipCustomers = customerSpending.entrySet().stream()
    .filter(entry -> entry.getValue() > 10000)
    .map(Map.Entry::getKey)
    .collect(Collectors.toList());
System.out.println("VIPå®¢æˆ·ï¼š" + vipCustomers);

// ä¸šåŠ¡åˆ†æ5ï¼šå¤åˆåˆ†æ - æ¯ä¸ªç±»åˆ«çš„å¹³å‡è®¢å•é‡‘é¢
Map<String, Double> avgAmountByCategory = orders.stream()
    .collect(Collectors.groupingBy(
        order -> order.category,
        Collectors.averagingDouble(OrderItem::getTotalAmount)
    ));
System.out.println("å„ç±»åˆ«å¹³å‡è®¢å•é‡‘é¢ï¼š" + avgAmountByCategory);
```

### 3.9 Streamæ€§èƒ½ä¼˜åŒ–æŠ€å·§


**âš¡ æå‡Streamæ€§èƒ½çš„å®ç”¨æŠ€å·§**

```java
List<Integer> bigList = IntStream.rangeClosed(1, 1_000_000).boxed().collect(Collectors.toList());

// æŠ€å·§1ï¼šå°½æ—©è¿‡æ»¤ï¼Œå‡å°‘åç»­å¤„ç†çš„æ•°æ®é‡
// âŒ ä½æ•ˆï¼šå…ˆè½¬æ¢å†è¿‡æ»¤
List<String> inefficient = bigList.stream()
    .map(x -> "æ•°å­—:" + x)          // å…ˆå¯¹æ‰€æœ‰å…ƒç´ è½¬æ¢ï¼ˆ100ä¸‡æ¬¡ï¼‰
    .filter(s -> s.contains("5"))   // å†è¿‡æ»¤ï¼ˆ100ä¸‡æ¬¡æ¯”è¾ƒï¼‰
    .collect(Collectors.toList());

// âœ… é«˜æ•ˆï¼šå…ˆè¿‡æ»¤å†è½¬æ¢
List<String> efficient = bigList.stream()
    .filter(x -> x.toString().contains("5"))  // å…ˆè¿‡æ»¤ï¼ˆçº¦11ä¸‡ä¸ªæ•°å­—åŒ…å«5ï¼‰
    .map(x -> "æ•°å­—:" + x)                    // å†è½¬æ¢ï¼ˆåªéœ€11ä¸‡æ¬¡ï¼‰
    .collect(Collectors.toList());

// æŠ€å·§2ï¼šä½¿ç”¨ä¸“é—¨çš„æ•°å€¼æµï¼Œé¿å…è£…ç®±æ‹†ç®±
// âŒ ä½æ•ˆï¼šä½¿ç”¨åŒ…è£…ç±»
double avg1 = bigList.stream()
    .mapToDouble(x -> x.doubleValue())  // Integer â†’ Doubleï¼Œè£…ç®±
    .average()
    .orElse(0.0);

// âœ… é«˜æ•ˆï¼šä½¿ç”¨åŸºæœ¬ç±»å‹æµ
double avg2 = bigList.stream()
    .mapToInt(Integer::intValue)        // Integer â†’ intï¼Œæ— è£…ç®±
    .average()
    .orElse(0.0);

// æŠ€å·§3ï¼šçŸ­è·¯æ“ä½œï¼Œæ‰¾åˆ°å³åœæ­¢
// âŒ ä½æ•ˆï¼šå¤„ç†æ‰€æœ‰å…ƒç´ 
boolean hasLargeNumber1 = bigList.stream()
    .map(x -> x > 500000)               // å¯¹æ‰€æœ‰å…ƒç´ éƒ½æ‰§è¡Œ
    .reduce(false, (a, b) -> a || b);   // å¤„ç†æ‰€æœ‰ç»“æœ

// âœ… é«˜æ•ˆï¼šæ‰¾åˆ°å°±åœæ­¢
boolean hasLargeNumber2 = bigList.stream()
    .anyMatch(x -> x > 500000);         // æ‰¾åˆ°ç¬¬ä¸€ä¸ªå°±åœæ­¢

// æŠ€å·§4ï¼šåˆç†ä½¿ç”¨å¹¶è¡Œæµ
// å¯¹äºç®€å•æ“ä½œä¸”æ•°æ®é‡å¤§çš„åœºæ™¯
long parallelSum = bigList.parallelStream()
    .mapToLong(x -> x * x)
    .sum();

// æŠ€å·§5ï¼šé¿å…é‡å¤çš„Streamæ“ä½œ
// âŒ ä½æ•ˆï¼šå¤šæ¬¡åˆ›å»ºStream
int count1 = (int) bigList.stream().count();
int max1 = bigList.stream().mapToInt(Integer::intValue).max().orElse(0);
double avg3 = bigList.stream().mapToInt(Integer::intValue).average().orElse(0.0);

// âœ… é«˜æ•ˆï¼šä¸€æ¬¡æ€§æ”¶é›†ç»Ÿè®¡ä¿¡æ¯
IntSummaryStatistics stats = bigList.stream()
    .mapToInt(Integer::intValue)
    .summaryStatistics();
System.out.println("æ•°é‡ï¼š" + stats.getCount());
System.out.println("æœ€å¤§å€¼ï¼š" + stats.getMax());
System.out.println("å¹³å‡å€¼ï¼š" + stats.getAverage());
```

### 3.10 Streamé«˜çº§åº”ç”¨æ€»ç»“


**ğŸ¯ é«˜çº§åº”ç”¨æ ¸å¿ƒæŠ€èƒ½ï¼š**

| **æŠ€èƒ½** | **ç”¨é€”** | **å…³é”®æ–¹æ³•** | **è®°å¿†è¦ç‚¹** |
|---------|---------|-------------|-------------|
| **åˆ†ç»„** | æ•°æ®åˆ†ç±» | `groupingBy()` | æŒ‰æ¡ä»¶åˆ†ç»„ï¼Œæ”¯æŒå¤šçº§ |
| **åˆ†åŒº** | äºŒåˆ†æ•°æ® | `partitioningBy()` | ä¸€åˆ†ä¸ºäºŒï¼Œtrue/false |
| **æ‰å¹³åŒ–** | å¤„ç†åµŒå¥— | `flatMap()` | æ‰“å¼€ç›’å­ï¼Œæ‘Šå¹³ç»“æ„ |
| **å¹¶è¡Œæµ** | æ€§èƒ½ä¼˜åŒ– | `parallelStream()` | å¤§æ•°æ®+CPUå¯†é›† |
| **è‡ªå®šä¹‰æ”¶é›†** | ç‰¹æ®Šéœ€æ±‚ | `collect()` | è‡ªå·±å®šä¹‰æ”¶é›†é€»è¾‘ |
| **Optional** | å®‰å…¨å¤„ç† | `findFirst()/orElse()` | ä¼˜é›…å¤„ç†ç©ºå€¼ |

**ğŸ’¡ ä½¿ç”¨åŸåˆ™ï¼š**
```
1. å¤æ‚åˆ†æç”¨groupingBy - æŠŠæ•°æ®æŒ‰éœ€æ±‚åˆ†ç±»
2. äºŒåˆ†é—®é¢˜ç”¨partitioningBy - ç®€å•çš„æ˜¯éåˆ¤æ–­  
3. åµŒå¥—æ•°æ®ç”¨flatMap - æŠŠå¤æ‚ç»“æ„æ‘Šå¹³
4. å¤§æ•°æ®ç”¨parallelStream - ä½†è¦æ³¨æ„çº¿ç¨‹å®‰å…¨
5. ç‰¹æ®Šæ”¶é›†ç”¨è‡ªå®šä¹‰collect - æ ‡å‡†æ–¹æ³•ä¸å¤Ÿç”¨æ—¶
6. å¯èƒ½ä¸ºç©ºç”¨Optional - é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸
```

**ğŸš€ æ€§èƒ½ä¼˜åŒ–è¦ç‚¹ï¼š**
```
1. å°½æ—©è¿‡æ»¤ - filteræ”¾åœ¨å‰é¢
2. ç”¨åŸºæœ¬ç±»å‹æµ - é¿å…è£…ç®±æ‹†ç®±  
3. çŸ­è·¯æ“ä½œ - anyMatchæ¯”reduceå¿«
4. åˆç†å¹¶è¡Œ - ä¸æ˜¯è¶Šå¤šè¶Šå¥½
5. ä¸€æ¬¡æ€§ç»Ÿè®¡ - summaryStatistics
6. é¿å…å‰¯ä½œç”¨ - ä¸ä¿®æ”¹å¤–éƒ¨å˜é‡
```
