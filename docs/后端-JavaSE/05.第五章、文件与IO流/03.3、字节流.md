---
title: 3ã€å­—èŠ‚æµ
---
## ğŸ“š ç›®å½•

1. [å­—èŠ‚æµå¸¸ç”¨ç±»æ¦‚è§ˆ](#1-å­—èŠ‚æµå¸¸ç”¨ç±»æ¦‚è§ˆ)
2. [æ–‡ä»¶å­—èŠ‚æµ](#2-æ–‡ä»¶å­—èŠ‚æµ)
3. [å†…å­˜å­—èŠ‚æµ](#3-å†…å­˜å­—èŠ‚æµ)
4. [ç¼“å†²å­—èŠ‚æµ](#4-ç¼“å†²å­—èŠ‚æµ)
5. [å¯¹è±¡å­—èŠ‚æµ](#5-å¯¹è±¡å­—èŠ‚æµ)
6. [æ•°æ®å­—èŠ‚æµ](#6-æ•°æ®å­—èŠ‚æµ)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ“Š å­—èŠ‚æµå¸¸ç”¨ç±»æ¦‚è§ˆ


### 1.1 å­—èŠ‚æµä½“ç³»ç»“æ„


```
å­—èŠ‚æµå¸¸ç”¨ç±»ï¼ˆå¤„ç†æ‰€æœ‰ç±»å‹æ–‡ä»¶ï¼šæ–‡æœ¬ã€å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ã€å‹ç¼©åŒ…ç­‰ï¼‰
â”œâ”€â”€ FileInputStreamï¼ˆè¯»å–ï¼‰ & FileOutputStreamï¼ˆå†™å…¥ï¼‰
â”‚   â”œâ”€â”€ ç±»å‹ï¼šèŠ‚ç‚¹æµ
â”‚   â”œâ”€â”€ åŠŸèƒ½ï¼šä»æ–‡ä»¶ä¸­è¯»å–/å†™å…¥å­—èŠ‚æ•°æ®
â”‚   â””â”€â”€ ä½¿ç”¨åœºæ™¯ï¼š
â”‚       â”œâ”€â”€ è¯»å–å›¾ç‰‡ã€è§†é¢‘ã€PDFã€éŸ³é¢‘ç­‰äºŒè¿›åˆ¶æ–‡ä»¶
â”‚       â””â”€â”€ å°†æ•°æ®ä»¥å­—èŠ‚æ–¹å¼å†™å…¥æ–‡ä»¶ï¼ˆé€‚åˆæ‹·è´ä»»æ„æ–‡ä»¶ï¼‰
â”‚
â”œâ”€â”€ BufferedInputStreamï¼ˆè¯»å–ï¼‰ & BufferedOutputStreamï¼ˆå†™å…¥ï¼‰
â”‚   â”œâ”€â”€ ç±»å‹ï¼šå¤„ç†æµï¼ˆåŒ…è£… FileInputStream / FileOutputStreamï¼‰
â”‚   â”œâ”€â”€ åŠŸèƒ½ï¼šåŠ ç¼“å†²åŒºï¼Œæå‡è¯»å†™æ•ˆç‡ï¼Œå‡å°‘ç£ç›˜æ“ä½œæ¬¡æ•°
â”‚   â””â”€â”€ ä½¿ç”¨åœºæ™¯ï¼š
â”‚       â”œâ”€â”€ é«˜æ€§èƒ½è¯»å†™å¤§æ–‡ä»¶
â”‚       â””â”€â”€ æ›¿ä»£è£¸ç”¨ FileInputStream / FileOutputStream æå‡é€Ÿåº¦
â”‚
â”œâ”€â”€ ByteArrayInputStream & ByteArrayOutputStream
â”‚   â”œâ”€â”€ ç±»å‹ï¼šå†…å­˜æµ
â”‚   â”œâ”€â”€ åŠŸèƒ½ï¼š
â”‚       â”œâ”€â”€ åœ¨å†…å­˜ä¸­è¯»å†™å­—èŠ‚æ•°ç»„ï¼ˆæ— éœ€æ–‡ä»¶ï¼‰
â”‚       â””â”€â”€ è¾“å‡ºæµå¯è½¬ä¸º byte[]ï¼Œé€‚åˆä¸­é—´ç¼“å†²æˆ–åŠ å¯†å¤„ç†
â”‚   â””â”€â”€ ä½¿ç”¨åœºæ™¯ï¼š
â”‚       â”œâ”€â”€ ç½‘ç»œæ•°æ®å¤„ç†ï¼ˆå¦‚ socket ç¼“å†²åŒºï¼‰
â”‚       â”œâ”€â”€ æ–‡ä»¶å¤„ç†å‰çš„é¢„å¤„ç†æˆ–å‹ç¼©
â”‚       â””â”€â”€ å•å…ƒæµ‹è¯•æ—¶æ¨¡æ‹Ÿè¾“å…¥è¾“å‡º
â”‚
â”œâ”€â”€ ObjectInputStream & ObjectOutputStream
â”‚   â”œâ”€â”€ ç±»å‹ï¼šå¤„ç†æµï¼ˆåŒ…è£… FileInputStream / FileOutputStreamï¼‰
â”‚   â”œâ”€â”€ åŠŸèƒ½ï¼šå®ç°å¯¹è±¡çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼ˆå°†å¯¹è±¡ â†” æ–‡ä»¶ï¼‰
â”‚   â””â”€â”€ ä½¿ç”¨åœºæ™¯ï¼š
â”‚       â”œâ”€â”€ æœ¬åœ°ä¿å­˜ Java å¯¹è±¡ï¼ˆå¦‚é…ç½®ã€æ¸¸æˆå­˜æ¡£ï¼‰
â”‚       â””â”€â”€ ç½‘ç»œä¼ è¾“å¯¹è±¡ï¼ˆå‰æï¼šå¯¹è±¡ç±»å®ç° Serializable æ¥å£ï¼‰
â”‚
â””â”€â”€ DataInputStream & DataOutputStream
    â”œâ”€â”€ ç±»å‹ï¼šå¤„ç†æµï¼ˆåŒ…è£… FileInputStream / FileOutputStreamï¼‰
    â”œâ”€â”€ åŠŸèƒ½ï¼š
    â”‚   â”œâ”€â”€ æ”¯æŒä»¥å¹³å°æ— å…³æ–¹å¼è¯»å†™åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆintã€longã€doubleã€boolean ç­‰ï¼‰
    â”‚   â””â”€â”€ æŒ‰å­—èŠ‚åºä¸€è‡´æ ¼å¼å­˜å‚¨ï¼Œé€‚åˆè·¨å¹³å°æ•°æ®ä¼ è¾“
    â””â”€â”€ ä½¿ç”¨åœºæ™¯ï¼š
        â”œâ”€â”€ äºŒè¿›åˆ¶åè®®çš„æ•°æ®æŒä¹…åŒ–æˆ–ç½‘ç»œé€šä¿¡
        â”œâ”€â”€ è¯»å†™ç»“æ„åŒ–æ•°æ®ï¼ˆå¦‚é…ç½®æ–‡ä»¶ã€äºŒè¿›åˆ¶ç»“æ„æ•°æ®ï¼‰
        â””â”€â”€ æ›¿ä»£ PrintStream è¿›è¡Œæ•°å€¼é«˜ç²¾åº¦å†™å…¥
```

### 1.2 å­—èŠ‚æµåˆ†ç±»ç‰¹ç‚¹


| æµç±»å‹ | **ç‰¹ç‚¹** | **é€‚ç”¨åœºæ™¯** | **æ€§èƒ½** |
|--------|----------|-------------|----------|
| ğŸ—‚ï¸ **æ–‡ä»¶æµ** | `ç›´æ¥æ“ä½œæ–‡ä»¶` | `æ–‡ä»¶è¯»å†™ã€å¤åˆ¶` | `ä¸­ç­‰ï¼ˆæœ‰ç£ç›˜IOï¼‰` |
| ğŸ’¾ **å†…å­˜æµ** | `æ•°æ®å­˜å‚¨åœ¨å†…å­˜` | `æµ‹è¯•ã€ä¸­é—´ç¼“å­˜` | `æœ€å¿«ï¼ˆæ— IOï¼‰` |
| âš¡ **ç¼“å†²æµ** | `å¸¦ç¼“å†²åŒºä¼˜åŒ–` | `å¤§æ–‡ä»¶ã€é¢‘ç¹è¯»å†™` | `é«˜ï¼ˆå‡å°‘ç³»ç»Ÿè°ƒç”¨ï¼‰` |
| ğŸ¯ **å¯¹è±¡æµ** | `åºåˆ—åŒ–Javaå¯¹è±¡` | `å¯¹è±¡æŒä¹…åŒ–ã€ç½‘ç»œä¼ è¾“` | `ä¸­ç­‰ï¼ˆæœ‰ç¼–ç å¼€é”€ï¼‰` |
| ğŸ“‹ **æ•°æ®æµ** | `ç²¾ç¡®ç±»å‹è¯»å†™` | `ç»“æ„åŒ–æ•°æ®ã€åè®®` | `é«˜ï¼ˆç±»å‹å®‰å…¨ï¼‰` |

---

## 2. ğŸ—‚ï¸ æ–‡ä»¶å­—èŠ‚æµ


### 2.1 åŸºæœ¬æ¦‚å¿µ


```java
1. FileXXXStreamï¼ˆæ–‡ä»¶å­—èŠ‚æµï¼‰
â”œâ”€â”€ 1.1 FileInputStreamï¼ˆæ–‡ä»¶å­—èŠ‚è¾“å…¥æµï¼‰
â”‚   â”œâ”€â”€ åŠŸèƒ½ï¼šä»æ–‡ä»¶ä¸­æŒ‰å­—èŠ‚é¡ºåºè¯»å–æ•°æ®
â”‚   â”œâ”€â”€ é€‚ç”¨åœºæ™¯ï¼š
â”‚   â”‚   â”œâ”€â”€ è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ã€PDFã€å‹ç¼©åŒ…ï¼‰
â”‚   â”‚   â””â”€â”€ ç®€å•è¯»å–æ–‡æœ¬æ–‡ä»¶ï¼ˆä¸æ¨èï¼šæ— ç¼–ç å¤„ç†ï¼Œæ˜“ä¹±ç ï¼‰
â”‚   â”œâ”€â”€ å¸¸ç”¨æ„é€ æ–¹æ³•ï¼š
â”‚   â”‚   â”œâ”€â”€ new FileInputStream("a.jpg")
â”‚   â”‚   â””â”€â”€ new FileInputStream(new File("a.jpg"))
â”‚   â””â”€â”€ ç¤ºä¾‹ä»£ç ï¼š
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       â”‚ FileInputStream fis = new FileInputStream("a.jpg");       â”‚
â”‚       â”‚ int data;                                                  â”‚
â”‚       â”‚ while ((data = fis.read()) != -1) {                        â”‚
â”‚       â”‚     System.out.print((char)data); // æ‰“å°å­—èŠ‚å†…å®¹           â”‚
â”‚       â”‚ }                                                          â”‚
â”‚       â”‚ fis.close();                                               â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â”œâ”€â”€ 1.2 FileOutputStreamï¼ˆæ–‡ä»¶å­—èŠ‚è¾“å‡ºæµï¼‰
â”‚   â”œâ”€â”€ åŠŸèƒ½ï¼šå°†å­—èŠ‚æ•°æ®å†™å…¥æ–‡ä»¶ï¼ˆä¼šè¦†ç›–åŸæ–‡ä»¶ï¼Œé™¤éå¼€å¯è¿½åŠ æ¨¡å¼ï¼‰
â”‚   â”œâ”€â”€ é€‚ç”¨åœºæ™¯ï¼š
â”‚   â”‚   â”œâ”€â”€ ä¿å­˜ä¸‹è½½æ–‡ä»¶ï¼ˆå¦‚å†™å…¥å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰ï¼‰
â”‚   â”‚   â””â”€â”€ è¾“å‡ºäºŒè¿›åˆ¶æ•°æ®ï¼ˆå¦‚ socket æ–‡ä»¶å†™å…¥ï¼‰
â”‚   â”œâ”€â”€ å¸¸ç”¨æ„é€ æ–¹æ³•ï¼š
â”‚   â”‚   â”œâ”€â”€ new FileOutputStream("output.txt")         // è¦†ç›–æ¨¡å¼
â”‚   â”‚   â””â”€â”€ new FileOutputStream("output.txt", true)   // è¿½åŠ æ¨¡å¼
â”‚   â””â”€â”€ ç¤ºä¾‹ä»£ç ï¼š
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       â”‚ FileOutputStream fos = new FileOutputStream("out.txt");   â”‚
â”‚       â”‚ String content = "Hello, world!";                          â”‚
â”‚       â”‚ byte[] data = content.getBytes();                          â”‚
â”‚       â”‚ fos.write(data);                                           â”‚
â”‚       â”‚ fos.close();                                               â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â””â”€â”€ å°ç»“ä¸æ³¨æ„äº‹é¡¹
    â”œâ”€â”€ æ–‡ä»¶å¤åˆ¶æ¨èä½¿ç”¨ç»„åˆï¼š
    â”‚   â”œâ”€â”€ FileInputStream + FileOutputStream
    â”‚   â””â”€â”€ åŠ  BufferedInputStream / BufferedOutputStream æé«˜æ€§èƒ½
    â”œâ”€â”€ å†™å…¥æ–‡ä»¶æ—¶ï¼š
    â”‚   â”œâ”€â”€ é»˜è®¤è¦†ç›–æ–‡ä»¶å†…å®¹
    â”‚   â””â”€â”€ è‹¥éœ€è¿½åŠ éœ€æ˜¾å¼ä¼ å…¥ trueï¼šnew FileOutputStream(path, true)
    â”œâ”€â”€ æµå…³é—­ï¼šå¿…é¡»æ‰‹åŠ¨å…³é—­ï¼ˆå»ºè®®ç”¨ try-with-resources è‡ªåŠ¨å…³é—­ï¼‰
    â””â”€â”€ éæ–‡æœ¬å¤„ç†æ¨èå­—èŠ‚æµï¼›æ–‡æœ¬æ–‡ä»¶æ¨èå­—ç¬¦æµï¼ˆFileReaderï¼‰
```

### 2.2 ç±»å®šä¹‰ä¸æ„é€ æ–¹æ³•


```java
// FileInputStream æ„é€ æ–¹æ³•
FileInputStream fis = new FileInputStream("file.txt");
FileInputStream fis = new FileInputStream(new File("file.txt"));

// FileOutputStream æ„é€ æ–¹æ³•
FileOutputStream fos = new FileOutputStream("file.txt");          // è¦†ç›–å†™
FileOutputStream fos = new FileOutputStream("file.txt", true);    // è¿½åŠ å†™
```

### 2.3 å¸¸ç”¨æ–¹æ³•æ€»è§ˆ


```java
å¸¸ç”¨æ–¹æ³•ä¸€è§ˆï¼ˆé€‚ç”¨äº FileInputStream / FileOutputStreamï¼‰
â”œâ”€â”€ read()                           // è¾“å…¥æµæ–¹æ³•
â”‚   â””â”€â”€ æ¯æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼ˆè¿”å› intï¼Œ-1 è¡¨ç¤ºè¯»å–ç»“æŸï¼‰
â”‚
â”œâ”€â”€ read(byte[])                     // è¾“å…¥æµæ–¹æ³•
â”‚   â””â”€â”€ å°†å¤šä¸ªå­—èŠ‚è¯»å…¥æ•°ç»„ï¼Œæé«˜è¯»å–æ•ˆç‡
â”‚
â”œâ”€â”€ write(int b)                     // è¾“å‡ºæµæ–¹æ³•
â”‚   â””â”€â”€ å†™å…¥ä¸€ä¸ªå­—èŠ‚ï¼ˆä½ 8 ä½å†™å…¥ï¼‰
â”‚
â”œâ”€â”€ write(byte[])                    // è¾“å‡ºæµæ–¹æ³•
â”‚   â””â”€â”€ å†™å…¥æ•´ä¸ªå­—èŠ‚æ•°ç»„å†…å®¹
â”‚
â”œâ”€â”€ available()                      // ä»…é€‚ç”¨äº InputStream
â”‚   â””â”€â”€ è¿”å›è¿˜å¯è¯»å–çš„å­—èŠ‚æ•°ï¼ˆä¸ä¸€å®šç²¾ç¡®ï¼Œç”¨äºä¼°ç®—ç¼“å†²å¤§å°ï¼‰
â”‚
â””â”€â”€ close()                          // é€šç”¨æ–¹æ³•
    â””â”€â”€ å…³é—­æµï¼Œé‡Šæ”¾åº•å±‚èµ„æºï¼ˆå¿…é¡»è°ƒç”¨ï¼Œå»ºè®®ä½¿ç”¨ try-with-resourcesï¼‰
```

### 2.4 FileInputStream å®Œæ•´ç¤ºä¾‹


```java
public class FileInputDemo {
    public static void main(String[] args) throws IOException {
        // 1. åˆ›å»ºè¾“å…¥æµå¯¹è±¡ï¼Œå…³è”ç›®æ ‡æ–‡ä»¶ï¼ˆå¿…é¡»å­˜åœ¨ï¼Œå¦åˆ™æŠ›å¼‚å¸¸ï¼‰
        FileInputStream fis = new FileInputStream("example.txt");

        // 2. è¯»å–å•ä¸ªå­—èŠ‚ï¼ˆè¿”å›0~255ä¹‹é—´çš„intå€¼ï¼Œè¯»å®Œè¿”å› -1ï¼‰
        int singleByte = fis.read();
        System.out.println("ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ˆintï¼‰: " + singleByte);
        System.out.println("å¯¹åº”å­—ç¬¦: " + (char) singleByte);

        // 3. æŸ¥çœ‹è¿˜å‰©å¤šå°‘å­—èŠ‚å¯è¯»ï¼ˆåªåšä¼°ç®—ï¼Œä¸ä¸€å®šå®Œå…¨å‡†ç¡®ï¼‰
        System.out.println("å¯ç”¨å­—èŠ‚æ•°: " + fis.available());

        // 4. ä½¿ç”¨å­—èŠ‚æ•°ç»„è¯»å–ï¼Œæé«˜æ•ˆç‡ï¼ˆæ¨èæ–¹å¼ï¼‰
        byte[] buffer = new byte[10]; // ç¼“å†²åŒºå¤§å°å¯ä»¥è‡ªå®šä¹‰
        int len = fis.read(buffer);   // è¿”å›å®é™…è¯»å–çš„å­—èŠ‚æ•°
        System.out.println("è¯»å–é•¿åº¦: " + len);
        System.out.println("è¯»å–å†…å®¹: " + new String(buffer, 0, len));

        // 5. å…³é—­æµï¼Œé‡Šæ”¾ç³»ç»Ÿèµ„æºï¼ˆå¿…é¡»æ‰§è¡Œï¼‰
        fis.close();
    }
}
```

### 2.5 FileOutputStream å®Œæ•´ç¤ºä¾‹


```java
public class FileOutputDemo {
    public static void main(String[] args) throws IOException {
        // 1. åˆ›å»ºè¾“å‡ºæµå¯¹è±¡ï¼Œæ–‡ä»¶ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œå­˜åœ¨é»˜è®¤è¦†ç›–
        FileOutputStream fos = new FileOutputStream("output.txt");

        // 2. å†™å…¥å•ä¸ªå­—èŠ‚ï¼ˆå†™å…¥çš„æ˜¯ASCIIç å€¼ï¼‰
        fos.write(65); // å†™å…¥å­—ç¬¦ 'A'

        // 3. å†™å…¥å­—èŠ‚æ•°ç»„ï¼ˆæ¨èä½¿ç”¨ï¼‰
        byte[] data = "Hello".getBytes(); // å­—ç¬¦ä¸²è½¬å­—èŠ‚æ•°ç»„
        fos.write(data); // å°†å®Œæ•´å­—èŠ‚æ•°ç»„å†™å…¥æ–‡ä»¶

        // 4. å…³é—­è¾“å‡ºæµï¼Œç¡®ä¿æ•°æ®å®Œå…¨å†™å…¥ï¼ˆå¿…é¡»å…³é—­ï¼Œå¦åˆ™å¯èƒ½æ•°æ®æœªè½ç›˜ï¼‰
        fos.close();
    }
}
```

### 2.6 æ–‡ä»¶å¤åˆ¶ç»¼åˆç¤ºä¾‹


```java
public class FileCopyDemo {
    public static void main(String[] args) throws IOException {
        // ä½¿ç”¨ try-with-resources è‡ªåŠ¨å…³é—­æµï¼ˆæ¨èï¼‰
        try (
            FileInputStream fis = new FileInputStream("source.jpg");
            FileOutputStream fos = new FileOutputStream("copy.jpg")
        ) {
            byte[] buffer = new byte[1024]; // æ¨è 1KB æˆ– 4KB ç¼“å†²åŒº
            int len;

            // å¾ªç¯è¯»å–å¹¶å†™å‡ºï¼ˆè¯»å–åˆ° -1 è¯´æ˜å·²è¯»å®Œï¼‰
            while ((len = fis.read(buffer)) != -1) {
                fos.write(buffer, 0, len); // å†™å…¥å®é™…è¯»å–çš„éƒ¨åˆ†
            }

            // è‡ªåŠ¨å…³é—­æµï¼Œæ— éœ€æ˜¾å¼ close()
        }
    }
}
```

### 2.7 ä½¿ç”¨æ³¨æ„äº‹é¡¹


| é¡¹ç›® | **è¯´æ˜** |
|------|----------|
| **å¿…é¡»å…³é—­æµ** | `å»ºè®®ä½¿ç”¨ try-with-resources è‡ªåŠ¨å…³é—­ï¼Œé¿å…èµ„æºæ³„æ¼` |
| **å­—ç¬¦ä¸²å†™å…¥éœ€è½¬ä¸ºå­—èŠ‚æ•°ç»„** | `ä½¿ç”¨ String.getBytes() æ–¹æ³•` |
| **å†™æ–‡ä»¶é»˜è®¤è¦†ç›–** | `å¦‚éœ€è¿½åŠ å†™å…¥ï¼Œä½¿ç”¨æ„é€ æ–¹æ³• new FileOutputStream(path, true)` |
| **read() æ•ˆç‡ä½** | `æ¨èä½¿ç”¨ read(byte[]) æ–¹å¼ä¸€æ¬¡è¯»å–å¤šä¸ªå­—èŠ‚` |
| **InputStream æ²¡æœ‰ç¼–ç å¤„ç†** | `è¯»å–æ–‡æœ¬å†…å®¹æ˜“å‡ºç°ä¹±ç ï¼Œéœ€æ­é… InputStreamReader ä½¿ç”¨` |

---

## 3. ğŸ’¾ å†…å­˜å­—èŠ‚æµ


### 3.1 åŸºæœ¬æ¦‚å¿µ


```java
1. ByteArrayXXXStreamï¼ˆå†…å­˜å­—èŠ‚æµï¼‰
â”œâ”€â”€ 1.1 ByteArrayInputStreamï¼ˆä»å†…å­˜æ•°ç»„ä¸­è¯»å–ï¼‰
â”‚   â”œâ”€â”€ åŠŸèƒ½ï¼šä»å†…å­˜ä¸­çš„å­—èŠ‚æ•°ç»„ä¸­è¯»å–æ•°æ®ï¼Œæ¨¡æ‹Ÿè¾“å…¥æµ
â”‚   â”œâ”€â”€ ç‰¹ç‚¹ï¼š
â”‚   â”‚   â”œâ”€â”€ æ•°æ®æ¥æºä¸ºå·²æœ‰çš„ byte[] æ•°ç»„ï¼ˆéæ–‡ä»¶ï¼‰
â”‚   â”‚   â””â”€â”€ æ”¯æŒ reset() é‡å¤è¯»å–
â”‚   â”œâ”€â”€ é€‚ç”¨åœºæ™¯ï¼š
â”‚   â”‚   â”œâ”€â”€ æµ‹è¯•ä¸­æ¨¡æ‹Ÿè¾“å…¥æµ
â”‚   â”‚   â”œâ”€â”€ è§£å‹ç¼©/åŠ å¯†å¤„ç†ä¸­çš„ç¼“å­˜æ•°æ®è¯»å–
â”‚   â”‚   â””â”€â”€ ä¸ä¾èµ–æ–‡ä»¶ç³»ç»Ÿçš„ä¸­é—´æ•°æ®è¯»å–
â”‚   â”œâ”€â”€ å¸¸ç”¨æ„é€ æ–¹æ³•ï¼š
â”‚   â”‚   â””â”€â”€ new ByteArrayInputStream(byte[] buf)
â”‚   â””â”€â”€ ç¤ºä¾‹ä»£ç ï¼š
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       â”‚ byte[] data = "hello".getBytes();                          â”‚
â”‚       â”‚ ByteArrayInputStream bais = new ByteArrayInputStream(data);â”‚
â”‚       â”‚ int ch;                                                    â”‚
â”‚       â”‚ while ((ch = bais.read()) != -1) {                         â”‚
â”‚       â”‚     System.out.print((char) ch); // è¾“å‡ºï¼šhello            â”‚
â”‚       â”‚ }                                                          â”‚
â”‚       â”‚ bais.close(); // å¯çœç•¥                                     â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â”œâ”€â”€ 1.2 ByteArrayOutputStreamï¼ˆå†™å…¥åˆ°å†…å­˜æ•°ç»„ï¼‰
â”‚   â”œâ”€â”€ åŠŸèƒ½ï¼šå°†å­—èŠ‚æ•°æ®å†™å…¥å†…å­˜ä¸­çš„ç¼“å†²åŒºï¼Œæ¨¡æ‹Ÿè¾“å‡ºæµ
â”‚   â”œâ”€â”€ ç‰¹ç‚¹ï¼š
â”‚   â”‚   â”œâ”€â”€ æ•°æ®å†™å…¥åå¯ç”¨ toByteArray() è·å–
â”‚   â”‚   â””â”€â”€ å†™å…¥è¿‡ç¨‹è‡ªåŠ¨æ‰©å®¹ï¼Œæ”¯æŒé«˜æ•ˆæ‹¼æ¥
â”‚   â”œâ”€â”€ é€‚ç”¨åœºæ™¯ï¼š
â”‚   â”‚   â”œâ”€â”€ ç¼“å­˜æ•°æ®åç»Ÿä¸€å†™å‡ºï¼ˆå¦‚ç½‘ç»œã€æ–‡ä»¶ï¼‰
â”‚   â”‚   â”œâ”€â”€ å¤šæ®µæ•°æ®æ‹¼æ¥è¾“å‡º
â”‚   â”‚   â””â”€â”€ æ•°æ®åŠ å¯†/å‹ç¼©å‰çš„å†…å­˜ç¼“å†²
â”‚   â”œâ”€â”€ å¸¸ç”¨æ„é€ æ–¹æ³•ï¼š
â”‚   â”‚   â”œâ”€â”€ new ByteArrayOutputStream()
â”‚   â”‚   â””â”€â”€ new ByteArrayOutputStream(int initialSize)
â”‚   â””â”€â”€ ç¤ºä¾‹ä»£ç ï¼š
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       â”‚ ByteArrayOutputStream baos = new ByteArrayOutputStream(); â”‚
â”‚       â”‚ baos.write("Java".getBytes());                             â”‚
â”‚       â”‚ baos.write("æµ".getBytes("UTF-8"));                         â”‚
â”‚       â”‚ byte[] result = baos.toByteArray();                        â”‚
â”‚       â”‚ System.out.println(new String(result, "UTF-8")); // Javaæµ â”‚
â”‚       â”‚ baos.close(); // å¯çœç•¥                                     â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â””â”€â”€ å°ç»“ä¸æ³¨æ„äº‹é¡¹
    â”œâ”€â”€ ä¸æ“ä½œç£ç›˜ï¼Œæ•°æ®å…¨éƒ¨åœ¨å†…å­˜ä¸­ï¼Œé€Ÿåº¦å¿«
    â”œâ”€â”€ æµå…³é—­ä¸æ˜¯å¿…é¡»ï¼šclose() ä¸ºç©ºæ–¹æ³•ï¼ˆä¸ä¼šé‡Šæ”¾ç³»ç»Ÿèµ„æºï¼‰
    â”œâ”€â”€ è¾“å‡ºæµæ”¯æŒ writeTo(OutputStream out) é«˜æ•ˆè¾“å‡º
    â”œâ”€â”€ toByteArray() å¯å–å‡ºå·²å†™æ•°æ®ï¼Œç”¨äºåŠ å¯†/ç½‘ç»œä¼ è¾“ç­‰
    â””â”€â”€ ä¸é€‚åˆå¤„ç†å¤§æ–‡ä»¶ï¼ˆå ç”¨å†…å­˜ï¼Œå¯èƒ½å¯¼è‡´å†…å­˜æº¢å‡ºï¼‰
```

### 3.2 æ„é€ æ–¹æ³•


```java
// ByteArrayInputStream
ByteArrayInputStream bais = new ByteArrayInputStream(byte[] buf);

// ByteArrayOutputStream
ByteArrayOutputStream baos = new ByteArrayOutputStream(); // é»˜è®¤å®¹é‡32
ByteArrayOutputStream baos = new ByteArrayOutputStream(int size); // æŒ‡å®šå®¹é‡
```

### 3.3 å¸¸ç”¨æ–¹æ³•æ€»è§ˆ


```java
ByteArrayXXXStream å¸¸ç”¨æ–¹æ³•ä¸€è§ˆ
â”œâ”€â”€ è¾“å…¥æµæ–¹æ³•ï¼ˆByteArrayInputStreamï¼‰
â”‚   â”œâ”€â”€ read()
â”‚   â”‚   â””â”€â”€ è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼ˆè¿”å› intï¼Œ-1 è¡¨ç¤ºç»“æŸï¼‰
â”‚   â”œâ”€â”€ read(byte[])
â”‚   â”‚   â””â”€â”€ æ‰¹é‡è¯»å–å­—èŠ‚æ•°ç»„ï¼Œæé«˜è¯»å–æ•ˆç‡
â”‚   â””â”€â”€ reset()
â”‚       â””â”€â”€ å°†è¯»å–æŒ‡é’ˆé‡ç½®åˆ°å¼€å¤´ï¼Œå¯é‡å¤è¯»å–
â”‚
â”œâ”€â”€ è¾“å‡ºæµæ–¹æ³•ï¼ˆByteArrayOutputStreamï¼‰
â”‚   â”œâ”€â”€ write(int b)
â”‚   â”‚   â””â”€â”€ å†™å…¥ä¸€ä¸ªå­—èŠ‚ï¼ˆä»…ä½ 8 ä½æœ‰æ•ˆï¼‰
â”‚   â”œâ”€â”€ write(byte[])
â”‚   â”‚   â””â”€â”€ å†™å…¥æ•´ä¸ªå­—èŠ‚æ•°ç»„å†…å®¹
â”‚   â”œâ”€â”€ toByteArray()
â”‚   â”‚   â””â”€â”€ è¿”å›å†™å…¥çš„æ•°æ®å‰¯æœ¬ï¼ˆbyte[]ï¼‰
â”‚   â”œâ”€â”€ toString()
â”‚   â”‚   â””â”€â”€ å°†å†™å…¥æ•°æ®è½¬ä¸ºå­—ç¬¦ä¸²ï¼ˆä½¿ç”¨å¹³å°é»˜è®¤ç¼–ç ï¼‰
â”‚   â””â”€â”€ writeTo(OutputStream out)
â”‚       â””â”€â”€ å°†å½“å‰å†…å®¹é«˜æ•ˆå¤åˆ¶åˆ°æŒ‡å®šè¾“å‡ºæµä¸­
â”‚
â””â”€â”€ é€šç”¨æ–¹æ³•
    â””â”€â”€ close()
        â””â”€â”€ ç©ºæ–¹æ³•ï¼Œå¯çœç•¥è°ƒç”¨ï¼ˆä¸ä¼šçœŸæ­£é‡Šæ”¾èµ„æºï¼‰
```

### 3.4 ByteArrayInputStream ç¤ºä¾‹


```java
public class ByteArrayInputDemo {
    public static void main(String[] args) throws IOException {
        // åŸå§‹å­—èŠ‚æ•°æ®ï¼ˆé€šå¸¸å¯æ¥è‡ªç½‘ç»œã€åŠ å¯†ã€å‹ç¼©ç­‰ä¸­é—´è¿‡ç¨‹ï¼‰
        byte[] data = "Hello, ByteArrayInputStream!".getBytes();

        // åˆ›å»ºå†…å­˜è¾“å…¥æµï¼Œæ•°æ®æ¥æºä¸º byte[] æ•°ç»„
        ByteArrayInputStream bais = new ByteArrayInputStream(data);

        // è¯»å–å­—èŠ‚å¹¶è½¬æ¢ä¸ºå­—ç¬¦è¾“å‡º
        int b;
        while ((b = bais.read()) != -1) {
            System.out.print((char) b); // è¾“å‡ºå­—ç¬¦ä¸²å†…å®¹
        }

        // reset()ï¼šå°†æµçš„ä½ç½®é‡ç½®å›å¼€å¤´ï¼ˆå¯é€‰ï¼‰
        bais.reset();
        System.out.println("\nå†æ¬¡è¯»å–å‰5ä¸ªå­—ç¬¦ï¼š");
        for (int i = 0; i < 5; i++) {
            System.out.print((char) bais.read());
        }

        // close() æ–¹æ³•ä¸ºç©ºå®ç°ï¼Œè°ƒç”¨ä¸å¦æ— å½±å“
        bais.close();
    }
}

/*
æ³¨æ„äº‹é¡¹ï¼š
â€¢ read() è¿”å› intï¼Œå€¼ä¸º 0~255ï¼›è¿”å› -1 è¡¨ç¤ºå·²è¯»å®Œ
â€¢ reset() å¯é‡å¤è¯»å–ï¼ˆä»å¤´å¼€å§‹ï¼‰
â€¢ æ— éœ€å¤„ç†æ–‡ä»¶æˆ–å…³é—­ç³»ç»Ÿèµ„æºï¼Œé€‚åˆè½»é‡å¿«é€Ÿå¤„ç†
*/
```

### 3.5 ByteArrayOutputStream ç¤ºä¾‹


```java
public class ByteArrayOutputDemo {
    public static void main(String[] args) throws IOException {
        // åˆ›å»ºå†…å­˜è¾“å‡ºæµï¼ˆå†…éƒ¨ä½¿ç”¨ byte[] è‡ªåŠ¨æ‰©å®¹ï¼‰
        ByteArrayOutputStream baos = new ByteArrayOutputStream();

        // å†™å…¥å­—ç¬¦ä¸²å†…å®¹ï¼ˆè½¬æˆå­—èŠ‚æ•°ç»„ï¼‰
        baos.write("Java ".getBytes());
        baos.write("å­—èŠ‚æµ".getBytes("UTF-8"));

        // è·å–ç»“æœå­—èŠ‚æ•°ç»„
        byte[] result = baos.toByteArray();
        System.out.println("å†…å­˜ä¸­æ‹¼æ¥ç»“æœï¼š" + new String(result, "UTF-8"));

        // writeToï¼šå°†å†…å®¹å†™å‡ºåˆ°æ–‡ä»¶æˆ–å…¶ä»–æµä¸­
        FileOutputStream fos = new FileOutputStream("output.txt");
        baos.writeTo(fos); // é«˜æ•ˆè¾“å‡ºï¼Œæ— éœ€å†æ‰‹åŠ¨è½¬å­—èŠ‚æ•°ç»„
        fos.close();

        // close() å¯çœç•¥ï¼Œä¸ä¼šå½±å“å†…å­˜èµ„æº
        baos.close();
    }
}

/*
æ³¨æ„äº‹é¡¹ï¼š
â€¢ toByteArray()ï¼šè·å–å®Œæ•´å†™å…¥æ•°æ®çš„å‰¯æœ¬
â€¢ writeTo(OutputStream)ï¼šä¸€æ¬¡æ€§å°†æ•°æ®å¯¼å‡ºåˆ°å…¶ä»–æµ
â€¢ å†™å…¥è¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨æ‰©å®¹ï¼Œä¸éœ€è¦ä½ æŒ‡å®šå¤§å°
â€¢ ä¸é€‚åˆè¶…å¤§æ•°æ®ï¼ˆå¤§é‡å†™å…¥ä¼šå ç”¨å¤§é‡å†…å­˜ï¼‰
*/
```

### 3.6 å†…å­˜æµ vs æ–‡ä»¶æµå¯¹æ¯”


| ç‰¹æ€§ | **FileInput/OutputStream** | **ByteArrayInput/OutputStream** |
|------|----------------------------|--------------------------------|
| **æ•°æ®æ¥æº/å»å‘** | `æ–‡ä»¶ç³»ç»Ÿ` | `å†…å­˜ä¸­çš„ byte[]` |
| **æ˜¯å¦å¯æŒä¹…åŒ–** | `æ˜¯ï¼ˆè½ç›˜ï¼‰` | `å¦ï¼ˆç¨‹åºç»“æŸå³ä¸¢å¤±ï¼‰` |
| **æ€§èƒ½** | `ç›¸å¯¹è¾ƒæ…¢ï¼ˆæœ‰ç£ç›˜IOï¼‰` | `å¿«é€Ÿï¼ˆå…¨éƒ¨åœ¨å†…å­˜ä¸­æ“ä½œï¼‰` |
| **æ˜¯å¦éœ€é‡Šæ”¾èµ„æº** | `æ˜¯ï¼ˆå¿…é¡» closeï¼‰` | `å¦ï¼ˆclose() æ˜¯ç©ºå®ç°ï¼‰` |
| **ä½¿ç”¨åœºæ™¯** | `å®é™…æ–‡ä»¶è¯»å†™` | `ç¼“å­˜æ‹¼æ¥ã€ä¸­é—´å¤„ç†ã€æµ‹è¯•åœºæ™¯` |

### 3.7 å…¸å‹ä½¿ç”¨åœºæ™¯


| åœºæ™¯æè¿° | **ä½¿ç”¨è¯´æ˜** |
|----------|-------------|
| **å•å…ƒæµ‹è¯•æ¨¡æ‹Ÿè¾“å…¥è¾“å‡ºæµ** | `ç”¨å†…å­˜ä»£æ›¿çœŸå®æ–‡ä»¶è¯»å†™ï¼Œé¿å… IO å¼€é”€` |
| **æ–‡ä»¶æ•°æ®å¤„ç†å‰çš„ä¸­é—´ç¼“å­˜** | `å°†æ–‡ä»¶æˆ–ç½‘ç»œæ•°æ®è¯»å…¥å†…å­˜ä¸­åŠ å·¥å¤„ç†` |
| **å†…å­˜æ‹¼æ¥å¤šæ®µæ•°æ®** | `æ¯”é¢‘ç¹å­—ç¬¦ä¸²æ‹¼æ¥æ•ˆç‡é«˜ï¼›é€‚åˆç½‘ç»œæ‰“åŒ…ã€ç¼–ç å¤„ç†` |
| **å¤šæ¬¡å†™æ“ä½œåç»Ÿä¸€å¯¼å‡º** | `ä½¿ç”¨ toByteArray() å¯¼å‡ºå…¨éƒ¨æ•°æ®` |

---

## 4. âš¡ ç¼“å†²å­—èŠ‚æµ


### 4.1 åŸºæœ¬æ¦‚å¿µ


```java
1. BufferedXXXStreamï¼ˆç¼“å†²å¢å¼ºå‹å­—èŠ‚æµï¼‰
â”œâ”€â”€ 1.1 BufferedInputStreamï¼ˆå¸¦ç¼“å†²çš„å­—èŠ‚è¾“å…¥æµï¼‰
â”‚   â”œâ”€â”€ åŠŸèƒ½ï¼šåŒ…è£… InputStreamï¼Œæ·»åŠ ç¼“å†²åŒºï¼Œå‡å°‘è¯»å–ç£ç›˜æ¬¡æ•°ï¼Œæé«˜æ€§èƒ½
â”‚   â”œâ”€â”€ ç‰¹ç‚¹ï¼š
â”‚   â”‚   â”œâ”€â”€ æ¯æ¬¡è¯»å–ä»å†…å­˜ç¼“å†²åŒºå–æ•°æ®ï¼Œä¸é¢‘ç¹è®¿é—®ç£ç›˜
â”‚   â”‚   â”œâ”€â”€ é»˜è®¤ç¼“å†²åŒºå¤§å°ä¸º 8192 å­—èŠ‚ï¼ˆå¯è‡ªå®šä¹‰ï¼‰
â”‚   â”‚   â””â”€â”€ æ”¯æŒ read(byte[]) æ‰¹é‡è¯»å–
â”‚   â”œâ”€â”€ é€‚ç”¨åœºæ™¯ï¼š
â”‚   â”‚   â”œâ”€â”€ è¯»å–å¤§æ–‡ä»¶ï¼ˆå¦‚è§†é¢‘ã€å›¾ç‰‡ã€éŸ³é¢‘ï¼‰
â”‚   â”‚   â”œâ”€â”€ é¢‘ç¹è¯»å–æ“ä½œåœºæ™¯
â”‚   â”‚   â””â”€â”€ æ›¿ä»£è£¸ç”¨ FileInputStream æå‡æ€§èƒ½
â”‚   â”œâ”€â”€ å¸¸ç”¨æ„é€ æ–¹æ³•ï¼š
â”‚   â”‚   â”œâ”€â”€ new BufferedInputStream(new FileInputStream("a.jpg"))
â”‚   â”‚   â””â”€â”€ new BufferedInputStream(InputStream in, int bufferSize)
â”‚   â””â”€â”€ ç¤ºä¾‹ä»£ç ï¼š
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       â”‚ BufferedInputStream bis =                             â”‚
â”‚       â”‚     new BufferedInputStream(new FileInputStream("in.jpg")); â”‚
â”‚       â”‚ byte[] buffer = new byte[1024];                       â”‚
â”‚       â”‚ int len;                                              â”‚
â”‚       â”‚ while ((len = bis.read(buffer)) != -1) {              â”‚
â”‚       â”‚     System.out.println("è¯»å–å­—èŠ‚æ•°: " + len);           â”‚
â”‚       â”‚ }                                                     â”‚
â”‚       â”‚ bis.close();                                          â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â”œâ”€â”€ 1.2 BufferedOutputStreamï¼ˆå¸¦ç¼“å†²çš„å­—èŠ‚è¾“å‡ºæµï¼‰
â”‚   â”œâ”€â”€ åŠŸèƒ½ï¼šåŒ…è£… OutputStreamï¼Œå°†æ•°æ®å†™å…¥ç¼“å†²åŒºåç»Ÿä¸€è¾“å‡ºï¼Œæé«˜å†™å…¥æ•ˆç‡
â”‚   â”œâ”€â”€ ç‰¹ç‚¹ï¼š
â”‚   â”‚   â”œâ”€â”€ ç¼“å†²å†™å…¥ï¼Œå‡å°‘ç£ç›˜ I/O æ¬¡æ•°
â”‚   â”‚   â”œâ”€â”€ é»˜è®¤ç¼“å†²åŒºå¤§å°ä¸º 8192 å­—èŠ‚ï¼ˆå¯è‡ªå®šä¹‰ï¼‰
â”‚   â”‚   â”œâ”€â”€ å¯æ‰‹åŠ¨ flush() å°†ç¼“å†²æ•°æ®å¼ºåˆ¶å†™å‡º
â”‚   â”‚   â””â”€â”€ å…³é—­æ—¶ä¼šè‡ªåŠ¨ flushï¼ˆå†™å…¥ç£ç›˜ï¼‰
â”‚   â”œâ”€â”€ é€‚ç”¨åœºæ™¯ï¼š
â”‚   â”‚   â”œâ”€â”€ å†™å…¥å¤§æ–‡ä»¶æˆ–é¢‘ç¹å°æ•°æ®å†™å…¥
â”‚   â”‚   â”œâ”€â”€ æ›¿ä»£è£¸ç”¨ FileOutputStream æå‡æ•ˆç‡
â”‚   â”‚   â””â”€â”€ ç½‘ç»œæˆ–å‹ç¼©æ•°æ®åˆ†æ‰¹å†™å…¥
â”‚   â”œâ”€â”€ å¸¸ç”¨æ„é€ æ–¹æ³•ï¼š
â”‚   â”‚   â”œâ”€â”€ new BufferedOutputStream(new FileOutputStream("out.jpg"))
â”‚   â”‚   â””â”€â”€ new BufferedOutputStream(OutputStream out, int bufferSize)
â”‚   â””â”€â”€ ç¤ºä¾‹ä»£ç ï¼š
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       â”‚ BufferedOutputStream bos =                            â”‚
â”‚       â”‚     new BufferedOutputStream(new FileOutputStream("out.jpg")); â”‚
â”‚       â”‚ bos.write("Hello Buffered".getBytes());              â”‚
â”‚       â”‚ bos.flush(); // å¯é€‰ï¼Œclose() å‰è‡ªåŠ¨æ‰§è¡Œ               â”‚
â”‚       â”‚ bos.close();                                         â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â””â”€â”€ å°ç»“ä¸æ³¨æ„äº‹é¡¹
    â”œâ”€â”€ ä¼˜åŠ¿ï¼š
    â”‚   â”œâ”€â”€ å‡å°‘ç£ç›˜è¯»å†™æ¬¡æ•°ï¼Œæå‡ I/O æ€§èƒ½
    â”‚   â””â”€â”€ å°¤å…¶é€‚åˆå¤§æ–‡ä»¶æˆ–é¢‘ç¹å°æ•°æ®è¯»å†™åœºæ™¯
    â”œâ”€â”€ æ³¨æ„äº‹é¡¹ï¼š
    â”‚   â”œâ”€â”€ å…³é—­è¾“å‡ºæµå‰å¯è°ƒç”¨ flush() æ‰‹åŠ¨å†™å‡ºç¼“å­˜
    â”‚   â”œâ”€â”€ close() ä¼šè‡ªåŠ¨æ‰§è¡Œ flushï¼Œé¿å…æ•°æ®æœªè½ç›˜
    â”‚   â””â”€â”€ ä¸å­—ç¬¦æµåŒºåˆ†å¼€ï¼Œä¸åšç¼–ç å¤„ç†ï¼ˆå¤„ç†å­—ç¬¦åº”ä½¿ç”¨ BufferedReader/Writerï¼‰
    â””â”€â”€ æ¨èç»„åˆä½¿ç”¨ï¼š
        â”œâ”€â”€ BufferedInputStream + FileInputStream
        â””â”€â”€ BufferedOutputStream + FileOutputStream
```

### 4.2 ç±»å®šä¹‰ä¸æ„é€ æ–¹æ³•


```java
// æ„é€ å‡½æ•°ï¼ˆé»˜è®¤ç¼“å†²åŒºå¤§å°ä¸º 8192 å­—èŠ‚ï¼‰
// è¯»å–ï¼šæ„é€  BufferedInputStream
BufferedInputStream bis = new BufferedInputStream(new FileInputStream("a.jpg"));
// å†™å…¥ï¼šæ„é€  BufferedOutputStream
BufferedOutputStream bos = new BufferedOutputStream(new FileOutputStream("b.jpg"));

// å¯è‡ªå®šä¹‰ç¼“å†²åŒºå¤§å°ï¼š
BufferedInputStream bis = new BufferedInputStream(new FileInputStream("file"), 16 * 1024);
```

### 4.3 å¸¸ç”¨æ–¹æ³•æ€»è§ˆ


```java
BufferedXXXStream å¸¸ç”¨æ–¹æ³•ä¸€è§ˆ
â”œâ”€â”€ è¯»å–ç›¸å…³æ–¹æ³•ï¼ˆBufferedInputStreamï¼‰
â”‚   â”œâ”€â”€ read()
â”‚   â”‚   â””â”€â”€ è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼ˆå†…éƒ¨å…ˆä»ç¼“å†²åŒºè¯»å–ï¼Œå‡å°‘ç£ç›˜è®¿é—®ï¼‰
â”‚   â””â”€â”€ read(byte[])
â”‚       â””â”€â”€ æ‰¹é‡è¯»å–å¤šä¸ªå­—èŠ‚ï¼Œæé«˜è¯»å–æ•ˆç‡
â”‚
â”œâ”€â”€ å†™å…¥ç›¸å…³æ–¹æ³•ï¼ˆBufferedOutputStreamï¼‰
â”‚   â”œâ”€â”€ write(int b)
â”‚   â”‚   â””â”€â”€ å†™å…¥å•ä¸ªå­—èŠ‚åˆ°ç¼“å†²åŒºï¼ˆä¸ç›´æ¥å†™å…¥ç£ç›˜ï¼‰
â”‚   â””â”€â”€ write(byte[])
â”‚       â””â”€â”€ å†™å…¥å­—èŠ‚æ•°ç»„ï¼Œå»ºè®®æ­é… flush æˆ– close ä½¿ç”¨
â”‚
â”œâ”€â”€ ç¼“å†²æ§åˆ¶æ–¹æ³•ï¼ˆä»…è¾“å‡ºæµéœ€è¦ï¼‰
â”‚   â”œâ”€â”€ flush()
â”‚   â”‚   â””â”€â”€ æ‰‹åŠ¨å¼ºåˆ¶å°†ç¼“å†²åŒºæ•°æ®ç«‹å³å†™å…¥åº•å±‚è¾“å‡ºæµ
â”‚   â””â”€â”€ close()
â”‚       â””â”€â”€ åˆ·æ–°å¹¶å…³é—­æµï¼ˆflush åå†é‡Šæ”¾èµ„æºï¼Œå¿…é¡»è°ƒç”¨ï¼‰
```

### 4.4 BufferedInputStream ç¤ºä¾‹


```java
public class BufferedInputDemo {
    public static void main(String[] args) throws IOException {
        // åˆ›å»ºå¸¦ç¼“å†²çš„è¾“å…¥æµï¼ˆåŒ…è£… FileInputStreamï¼‰
        BufferedInputStream bis = new BufferedInputStream(new FileInputStream("input.txt"));

        byte[] buffer = new byte[1024]; // å»ºè®®ä½¿ç”¨ç¼“å†²è¯»å–ï¼Œæé«˜æ•ˆç‡
        int len;
        while ((len = bis.read(buffer)) != -1) {
            System.out.print(new String(buffer, 0, len)); // è¾“å‡ºè¯»å–çš„å†…å®¹
        }

        bis.close(); // å¿…é¡»å…³é—­æµï¼Œé‡Šæ”¾èµ„æº
    }
}

/*
æ³¨æ„äº‹é¡¹ï¼š
â€¢ read() / read(byte[]) ä»ç¼“å†²åŒºè¯»å–ï¼Œæ€§èƒ½ä¼˜äºè£¸ç”¨ FileInputStream
â€¢ ç¼“å†²åŒºé»˜è®¤ 8192 å­—èŠ‚ï¼Œå¯è‡ªå®šä¹‰
â€¢ close() ä¼šå…³é—­åº•å±‚ FileInputStreamï¼Œä¸€å®šè¦è°ƒç”¨
*/
```

### 4.5 BufferedOutputStream ç¤ºä¾‹


```java
public class BufferedOutputDemo {
    public static void main(String[] args) throws IOException {
        // åˆ›å»ºå¸¦ç¼“å†²çš„è¾“å‡ºæµï¼ˆåŒ…è£… FileOutputStreamï¼‰
        BufferedOutputStream bos = new BufferedOutputStream(new FileOutputStream("output.txt"));

        // å†™å…¥æ•°æ®ï¼ˆå…ˆå†™å…¥ç¼“å†²åŒºï¼Œå¹¶ä¸ä¼šç«‹å³è½ç›˜ï¼‰
        bos.write("Hello BufferedOutputStream!\n".getBytes());

        bos.flush(); // å¼ºåˆ¶å°†ç¼“å†²åŒºå†…å®¹å†™å…¥æ–‡ä»¶ï¼ˆä¹Ÿå¯ä¸å†™ï¼Œclose ä¼šè‡ªåŠ¨ flushï¼‰
        bos.close(); // å…³é—­æµå¹¶é‡Šæ”¾èµ„æºï¼ˆå¿…é¡»ï¼‰
    }
}

/*
æ³¨æ„äº‹é¡¹ï¼š
â€¢ write() å®é™…æ˜¯å†™å…¥ç¼“å†²åŒºï¼Œæé«˜æ€§èƒ½
â€¢ flush() å¯é€‰ï¼Œç¡®ä¿åŠæ—¶å†™å‡ºï¼ˆå°¤å…¶åœ¨ç½‘ç»œã€å“åº”æµä¸­å…³é”®ï¼‰
â€¢ close() ä¼šéšå¼ flushï¼Œå†å…³é—­æ–‡ä»¶
*/
```

### 4.6 ç»¼åˆæ¡ˆä¾‹ï¼šæ–‡ä»¶å¤åˆ¶ï¼ˆæ¨èå†™æ³•ï¼‰


```java
public class BufferedCopyDemo {
    public static void main(String[] args) throws IOException {
        try (
            BufferedInputStream bis = new BufferedInputStream(new FileInputStream("source.jpg"));
            BufferedOutputStream bos = new BufferedOutputStream(new FileOutputStream("copy.jpg"))
        ) {
            byte[] buffer = new byte[4096]; // å¤§ç¼“å†²åŒºå¯æé«˜æ‹·è´æ€§èƒ½
            int len;
            while ((len = bis.read(buffer)) != -1) {
                bos.write(buffer, 0, len);
            }
            // è‡ªåŠ¨ flush & close
        }
    }
}

// æ¨èä½¿ç”¨ try-with-resources è‡ªåŠ¨ç®¡ç†èµ„æºï¼Œç®€æ´ä¸”ä¸æ˜“å‡ºé”™
```

### 4.7 flush() ä¸ close() ä½¿ç”¨å¯¹æ¯”


```java
public class FlushCloseDemo {
    public static void main(String[] args) throws IOException {
        System.out.println("[1] âŒ æœª flush() ä¸”æœª close()");
        writeWithoutFlushAndClose(); // æ–‡ä»¶ä¸­å¯èƒ½æ— å†…å®¹ï¼

        System.out.println("[2] âœ… æ‰‹åŠ¨ flush() å†™å…¥");
        writeWithFlush();            // æ•°æ®ç«‹å³å†™å…¥

        System.out.println("[3] âœ… ä½¿ç”¨ try-with-resources è‡ªåŠ¨ flush + close");
        writeWithTryResource();      // æœ€æ¨èæ–¹å¼
    }

    // ä¸è°ƒç”¨ flush() æˆ– close()ï¼Œæ•°æ®ç•™åœ¨ç¼“å†²åŒºï¼Œæ–‡ä»¶å¯èƒ½ä¸ºç©º
    public static void writeWithoutFlushAndClose() throws IOException {
        FileOutputStream fos = new FileOutputStream("test1.txt");
        BufferedOutputStream bos = new BufferedOutputStream(fos);
        bos.write("Hello (æœªflushæœªclose)".getBytes());

        // âŒ æœª flush æˆ– close
        // bos.flush(); // å¦‚æ³¨é‡Šæ‰ï¼Œæ•°æ®ä¸ä¼šå†™å…¥æ–‡ä»¶
        // bos.close(); // åŒä¸Š
    }

    // æ‰‹åŠ¨ flush() ç¡®ä¿æ•°æ®åŠæ—¶å†™å…¥æ–‡ä»¶
    public static void writeWithFlush() throws IOException {
        FileOutputStream fos = new FileOutputStream("test2.txt");
        BufferedOutputStream bos = new BufferedOutputStream(fos);
        bos.write("Hello (æ‰‹åŠ¨ flush)".getBytes());

        bos.flush();  // âœ… å¼ºåˆ¶åˆ·æ–°ç¼“å†²åŒºåˆ°æ–‡ä»¶
        bos.close();  // â—ä»éœ€å…³é—­ä»¥é‡Šæ”¾èµ„æº
    }

    // æœ€æ¨èæ–¹å¼ï¼štry-with-resources è‡ªåŠ¨ flush + close
    public static void writeWithTryResource() throws IOException {
        try (BufferedOutputStream bos = new BufferedOutputStream(
                new FileOutputStream("test3.txt"))) {
            bos.write("Hello (try-with-resources)".getBytes());
            // è‡ªåŠ¨ flush() + close()
        }
    }
}

/*
æ€»ç»“å»ºè®®ï¼š
â€¢ BufferedOutputStream æ•°æ®é»˜è®¤å†™å…¥ç¼“å†²åŒºï¼Œä¸ä¼šç«‹å³è½ç›˜
â€¢ è‹¥ä¸ flush() æˆ– close()ï¼Œæ•°æ®å¯èƒ½æ°¸è¿œä¸ä¼šå†™å…¥æ–‡ä»¶
â€¢ æ¨èä½¿ç”¨ try-with-resourcesï¼Œè‡ªåŠ¨ç®¡ç†èµ„æºå’Œåˆ·æ–°ï¼Œæœ€å®‰å…¨
*/
```

### 4.8 è¾“å‡ºå¯¹æ¯”è¯´æ˜


| æ–‡ä»¶å | **æ˜¯å¦èƒ½çœ‹åˆ°å†…å®¹ï¼Ÿ** | **åŸå› è¯´æ˜** |
|--------|---------------------|-------------|
| `test1.txt` | `âŒ å¯èƒ½ä¸ºç©ºï¼ˆç¼“å†²æœªå†™å‡ºï¼‰` | `æœªè°ƒç”¨ flush() æˆ– close()` |
| `test2.txt` | `âœ… å†…å®¹å†™å‡º` | `æ‰‹åŠ¨ flush() å°†æ•°æ®åˆ·å…¥æ–‡ä»¶` |
| `test3.txt` | `âœ… å†…å®¹å†™å‡º` | `try-with-resources è‡ªåŠ¨ flush() + close()` |

### 4.9 ä½¿ç”¨æ³¨æ„äº‹é¡¹


| æ³¨æ„ç‚¹ | **è¯´æ˜** |
|--------|----------|
| **å¿…é¡»å…³é—­æµï¼ˆtry-with-resourcesï¼‰** | `close() ä¼šè‡ªåŠ¨è°ƒç”¨ flush()ï¼Œå¦åˆ™æ•°æ®å¯èƒ½æœªå†™å…¥æ–‡ä»¶` |
| **ä¸è¦é¢‘ç¹ flush()** | `ä¼šå½±å“æ€§èƒ½ï¼Œé€šå¸¸ç”±ç³»ç»Ÿæ§åˆ¶æˆ–åœ¨çœŸæ­£ç»“æŸå‰è°ƒç”¨ä¸€æ¬¡` |
| **ä¸æ”¯æŒç¼–ç è½¬æ¢** | `ä»…å¤„ç†åŸå§‹å­—èŠ‚ï¼›å¦‚éœ€å¤„ç†å­—ç¬¦ï¼Œè¯·ä½¿ç”¨ BufferedReader/Writer` |
| **ç¼“å†²åŒºå¤§å°åˆç†è®¾ç½®** | `é»˜è®¤ 8KBï¼Œå¤„ç†å¤§æ–‡ä»¶å¯è®¾ä¸º 16KBã€32KB ä»¥ä¼˜åŒ–æ€§èƒ½` |

---

## 5. ğŸ¯ å¯¹è±¡å­—èŠ‚æµ


### 5.1 åŸºæœ¬æ¦‚å¿µ


```java
1. ObjectXXXStreamï¼ˆç”¨äºå¯¹è±¡åºåˆ—åŒ–/ååºåˆ—åŒ–ï¼‰
â”œâ”€â”€ 1.1 ObjectOutputStreamï¼ˆå¯¹è±¡è¾“å‡ºæµï¼‰
â”‚   â”œâ”€â”€ åŠŸèƒ½ï¼šå°† Java å¯¹è±¡åºåˆ—åŒ–ä¸ºå­—èŠ‚æµï¼Œå†™å…¥æ–‡ä»¶æˆ–ç½‘ç»œä¸­
â”‚   â”œâ”€â”€ ç‰¹ç‚¹ï¼š
â”‚   â”‚   â”œâ”€â”€ å¯æŒä¹…åŒ–ä¿å­˜å¯¹è±¡ç»“æ„å’Œå†…å®¹
â”‚   â”‚   â”œâ”€â”€ å†™å…¥çš„æ•°æ®å¯è·¨å¹³å°ã€è·¨è¿›ç¨‹ä¼ è¾“
â”‚   â”‚   â””â”€â”€ ä»…æ”¯æŒå®ç°äº† Serializable æ¥å£çš„ç±»
â”‚   â”œâ”€â”€ é€‚ç”¨åœºæ™¯ï¼š
â”‚   â”‚   â”œâ”€â”€ æœ¬åœ°ä¿å­˜å¯¹è±¡å¿«ç…§ï¼ˆå¦‚é…ç½®ã€æ¸¸æˆå­˜æ¡£ï¼‰
â”‚   â”‚   â””â”€â”€ ä¼ è¾“å¯¹è±¡æ•°æ®ï¼ˆå¦‚ RPCã€Socketï¼‰
â”‚   â”œâ”€â”€ å¸¸ç”¨æ„é€ æ–¹æ³•ï¼š
â”‚   â”‚   â”œâ”€â”€ new ObjectOutputStream(new FileOutputStream("user.dat"))
â”‚   â”‚   â””â”€â”€ new ObjectOutputStream(OutputStream out)
â”‚   â””â”€â”€ ç¤ºä¾‹ä»£ç ï¼š
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       â”‚ ObjectOutputStream oos =                                       â”‚
â”‚       â”‚     new ObjectOutputStream(new FileOutputStream("user.dat")); â”‚
â”‚       â”‚ User user = new User("Alice", "123456");                      â”‚
â”‚       â”‚ oos.writeObject(user); // åºåˆ—åŒ–å¯¹è±¡                          â”‚
â”‚       â”‚ oos.close();                                                  â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â”œâ”€â”€ 1.2 ObjectInputStreamï¼ˆå¯¹è±¡è¾“å…¥æµï¼‰
â”‚   â”œâ”€â”€ åŠŸèƒ½ï¼šå°†å­—èŠ‚æµä¸­çš„å¯¹è±¡æ•°æ®ååºåˆ—åŒ–ä¸º Java å¯¹è±¡
â”‚   â”œâ”€â”€ ç‰¹ç‚¹ï¼š
â”‚   â”‚   â”œâ”€â”€ å¿…é¡»çŸ¥é“ç±»çš„å®šä¹‰ï¼Œä¸”ç±»éœ€å®ç° Serializable æ¥å£
â”‚   â”‚   â”œâ”€â”€ è¯»å–é¡ºåºå¿…é¡»ä¸å†™å…¥é¡ºåºä¸€è‡´
â”‚   â”‚   â””â”€â”€ è¯»å–åéœ€å¼ºåˆ¶ç±»å‹è½¬æ¢
â”‚   â”œâ”€â”€ é€‚ç”¨åœºæ™¯ï¼š
â”‚   â”‚   â”œâ”€â”€ æ¢å¤å¯¹è±¡å¿«ç…§
â”‚   â”‚   â””â”€â”€ æ¥æ”¶è¿œç¨‹ä¼ è¾“å¯¹è±¡ï¼ˆåˆ†å¸ƒå¼é€šä¿¡ï¼‰
â”‚   â”œâ”€â”€ å¸¸ç”¨æ„é€ æ–¹æ³•ï¼š
â”‚   â”‚   â”œâ”€â”€ new ObjectInputStream(new FileInputStream("user.dat"))
â”‚   â”‚   â””â”€â”€ new ObjectInputStream(InputStream in)
â”‚   â””â”€â”€ ç¤ºä¾‹ä»£ç ï¼š
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       â”‚ ObjectInputStream ois =                                        â”‚
â”‚       â”‚     new ObjectInputStream(new FileInputStream("user.dat"));   â”‚
â”‚       â”‚ User user = (User) ois.readObject(); // ååºåˆ—åŒ–å¯¹è±¡           â”‚
â”‚       â”‚ System.out.println(user);                                     â”‚
â”‚       â”‚ ois.close();                                                  â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â””â”€â”€ å°ç»“ä¸æ³¨æ„äº‹é¡¹
    â”œâ”€â”€ ç±»å¿…é¡»å®ç° Serializable æ¥å£ï¼ˆå¦åˆ™æŠ›å‡º NotSerializableExceptionï¼‰
    â”œâ”€â”€ å»ºè®®æ‰‹åŠ¨æ·»åŠ  serialVersionUIDï¼ˆé¿å…ååºåˆ—åŒ–å‡ºé”™ï¼‰
    â”œâ”€â”€ transient ä¿®é¥°å­—æ®µä¸ä¼šè¢«åºåˆ—åŒ–ï¼ˆå¦‚å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ï¼‰
    â”œâ”€â”€ static å­—æ®µä¸ä¼šè¢«åºåˆ—åŒ–ï¼ˆå±äºç±»æœ¬èº«ï¼‰
    â”œâ”€â”€ ååºåˆ—åŒ–æ—¶éœ€å¼ºè½¬å¯¹è±¡ç±»å‹ï¼ˆå¦‚ User user = (User) ois.readObject();ï¼‰
    â””â”€â”€ åºåˆ—åŒ–ä¸é€‚ç”¨äºå¤§å¯¹è±¡ç¼“å­˜ï¼ˆå»ºè®®ç”¨ JSON æˆ–æ•°æ®åº“ï¼‰
```

### 5.2 åºåˆ—åŒ–æœºåˆ¶ï¼ˆSerializableï¼‰


```java
private static final long serialVersionUID = 1L;

// è¦æ±‚è¢«åºåˆ—åŒ–çš„ç±»ï¼š
// â€¢ å¿…é¡»å®ç° java.io.Serializable æ¥å£ï¼ˆæ˜¯æ ‡è®°æ¥å£ï¼Œæ— æ–¹æ³•ï¼‰
// â€¢ æ¨èæ˜¾ç¤ºå®šä¹‰ serialVersionUIDï¼Œé¿å…ç‰ˆæœ¬ä¸å…¼å®¹å¼‚å¸¸

// ä¸å‚ä¸åºåˆ—åŒ–çš„å­—æ®µï¼š
// â€¢ ä½¿ç”¨ transient å…³é”®å­—ä¿®é¥°çš„å­—æ®µï¼Œä¸ä¼šè¢«åºåˆ—åŒ–
// â€¢ å¦‚å¯†ç ã€ç¼“å­˜ã€ä¸´æ—¶å­—æ®µç­‰
```

### 5.3 æ„é€ æ–¹æ³•


```java
// å†™å…¥å¯¹è±¡
ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("obj.dat"));

// è¯»å–å¯¹è±¡
ObjectInputStream ois = new ObjectInputStream(new FileInputStream("obj.dat"));
```

### 5.4 å¸¸ç”¨æ–¹æ³•


| æ–¹æ³•å | **æ‰€å±ç±»** | **è¯´æ˜** |
|--------|-----------|----------|
| `writeObject(Object obj)` | `ObjectOutputStream` | `å°†å¯¹è±¡åºåˆ—åŒ–å¹¶å†™å…¥è¾“å‡ºæµ` |
| `readObject()` | `ObjectInputStream` | `ä»è¾“å…¥æµè¯»å–ä¸€ä¸ªå¯¹è±¡ï¼ˆéœ€å¼ºè½¬ç±»å‹ï¼‰` |
| `close()` | `ä¸¤è€…éƒ½æœ‰` | `å…³é—­æµï¼Œé‡Šæ”¾èµ„æº` |

### 5.5 ObjectXXXStream æ ¸å¿ƒæ–¹æ³•æ¼”ç¤º


```java
// ç±»å¿…é¡»å®ç° Serializable æ¥å£æ‰èƒ½åºåˆ—åŒ–
public class User implements Serializable {
    private static final long serialVersionUID = 1L; // ä¿è¯å…¼å®¹æ€§

    private String username;
    private transient String password; // ä¸ä¼šè¢«åºåˆ—åŒ–

    public User(String username, String password) {
        this.username = username;
        this.password = password;
    }

    public String toString() {
        return "User{name='" + username + "', password='" + password + "'}";
    }
}

// å†™å…¥å¯¹è±¡ï¼ˆåºåˆ—åŒ–ï¼‰
public class ObjectWriteDemo {
    public static void main(String[] args) throws Exception {
        User user = new User("Alice", "123456");

        // åˆ›å»ºå¯¹è±¡è¾“å‡ºæµï¼Œå†™å…¥å¯¹è±¡åˆ°æ–‡ä»¶
        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("user.obj"));
        oos.writeObject(user); // âœ… æ ¸å¿ƒæ–¹æ³•ï¼šåºåˆ—åŒ–
        oos.close();           // å¿…é¡»å…³é—­é‡Šæ”¾èµ„æº
    }
}

// è¯»å–å¯¹è±¡ï¼ˆååºåˆ—åŒ–ï¼‰
public class ObjectReadDemo {
    public static void main(String[] args) throws Exception {
        // åˆ›å»ºå¯¹è±¡è¾“å…¥æµï¼Œä»æ–‡ä»¶è¯»å–å¯¹è±¡
        ObjectInputStream ois = new ObjectInputStream(new FileInputStream("user.obj"));
        User user = (User) ois.readObject(); // âœ… æ ¸å¿ƒæ–¹æ³•ï¼šååºåˆ—åŒ–ï¼ˆéœ€å¼ºè½¬ï¼‰
        System.out.println(user); // è¾“å‡ºï¼šUser{name='Alice', password='null'}
        ois.close();
    }
}

/*
è¿è¡Œæ•ˆæœç¤ºæ„ï¼š
â€¢ åºåˆ—åŒ–åå†™å…¥ user.obj æ–‡ä»¶
â€¢ ååºåˆ—åŒ–è¾“å‡ºï¼šUser{name='Alice', password='null'}
â€¢ è¯´æ˜ password å­—æ®µæœªå†™å…¥æˆåŠŸï¼Œå› ä¸ºå®ƒè¢«æ ‡è®°ä¸º transient
*/
```

### 5.6 å¤šä¸ªå¯¹è±¡çš„åºåˆ—åŒ–ç¤ºä¾‹


```java
// å†™å…¥å¤šä¸ªå¯¹è±¡ + å¯¹è±¡é›†åˆ
public class MultiObjectWriteDemo {
    public static void main(String[] args) throws Exception {
        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("multi_users.dat"));

        // å†™å…¥å¤šä¸ªå•ä¸ªå¯¹è±¡
        oos.writeObject(new User("Alice", "123456"));
        oos.writeObject(new User("Bob", "654321"));

        // å†™å…¥å¯¹è±¡é›†åˆï¼ˆList<User>ï¼‰
        List<User> userList = new ArrayList<>();
        userList.add(new User("Charlie", "aaa"));
        userList.add(new User("Daisy", "bbb"));
        oos.writeObject(userList);

        oos.close();
    }
}

// è¯»å–å¤šä¸ªå¯¹è±¡ + å¯¹è±¡é›†åˆ
public class MultiObjectReadDemo {
    public static void main(String[] args) throws Exception {
        ObjectInputStream ois = new ObjectInputStream(new FileInputStream("multi_users.dat"));

        // é¡ºåºè¯»å–ä¸¤ä¸ªå¯¹è±¡
        User u1 = (User) ois.readObject();
        User u2 = (User) ois.readObject();

        // è¯»å–å¯¹è±¡é›†åˆï¼ˆæ³¨æ„ï¼šå†™å…¥ä»€ä¹ˆé¡ºåºï¼Œè¯»å–å°±å¿…é¡»ä»€ä¹ˆé¡ºåºï¼‰
        List<User> userList = (List<User>) ois.readObject();

        ois.close();

        System.out.println("[å•ä¸ªå¯¹è±¡]");
        System.out.println(u1);
        System.out.println(u2);

        System.out.println("\n[å¯¹è±¡é›†åˆ]");
        for (User u : userList) {
            System.out.println(u);
        }
    }
}

/*
è¿è¡Œç»“æœï¼š
[å•ä¸ªå¯¹è±¡]
User{name='Alice', password='null'}
User{name='Bob', password='null'}

[å¯¹è±¡é›†åˆ]
User{name='Charlie', password='null'}
User{name='Daisy', password='null'}
*/
```

### 5.7 æ³¨æ„äº‹é¡¹æ€»ç»“


| æ³¨æ„ç‚¹ | **è¯´æ˜** |
|--------|----------|
| **ç±»å¿…é¡»å®ç° Serializable** | `å¦åˆ™ä¼šæŠ›å‡º NotSerializableException` |
| **serialVersionUID æ¨èæ˜¾å¼å£°æ˜** | `é˜²æ­¢ç±»ç»“æ„å˜æ›´åæ—§å¯¹è±¡æ— æ³•ååºåˆ—åŒ–ï¼ˆä¿æŒç‰ˆæœ¬å…¼å®¹ï¼‰` |
| **transient å­—æ®µä¸ä¼šè¢«å†™å…¥** | `å¸¸ç”¨äºæ•æ„Ÿå­—æ®µï¼ˆå¦‚å¯†ç ã€ç¼“å­˜ï¼‰` |
| **writeObject() å’Œ readObject()** | `æ˜¯å”¯ä¸€æ”¯æŒå®Œæ•´å¯¹è±¡åºåˆ—åŒ–çš„æ–¹æ³•ï¼Œéœ€å¼ºåˆ¶ç±»å‹è½¬æ¢` |
| **I/O æµå¿…é¡» close()** | `å¦åˆ™å¯èƒ½èµ„æºæ³„æ¼æˆ–æ•°æ®ä¸å®Œæ•´` |

### 5.8 å…¸å‹ä½¿ç”¨åœºæ™¯


| åœºæ™¯ | **è¯´æ˜** |
|------|----------|
| **æŒä¹…åŒ–å­˜å‚¨ Java å¯¹è±¡** | `å°†å¯¹è±¡ä¿å­˜ä¸ºæ–‡ä»¶ï¼Œä¾›ä»¥åè¯»å–æ¢å¤` |
| **ç½‘ç»œä¼ è¾“** | `å®¢æˆ·ç«¯/æœåŠ¡å™¨ä¹‹é—´ä¼ è¾“å¯¹è±¡ï¼ˆå¦‚ RPC æ¡†æ¶ï¼‰` |
| **ç¼“å­˜å¯¹è±¡å¿«ç…§** | `å°†è¿è¡Œä¸­å¯¹è±¡çŠ¶æ€ä¿å­˜ä¸ºæœ¬åœ°ç¼“å­˜ï¼Œå¿«é€Ÿæ¢å¤` |

---

## 6. ğŸ“‹ æ•°æ®å­—èŠ‚æµ


### 6.1 åŸºæœ¬æ¦‚å¿µ


```java
1. DataXXXStreamï¼ˆå¤„ç†åŸºæœ¬æ•°æ®ç±»å‹çš„è¾“å…¥è¾“å‡ºæµï¼‰
â”œâ”€â”€ 1.1 DataOutputStreamï¼ˆæ•°æ®è¾“å‡ºæµï¼‰
â”‚   â”œâ”€â”€ åŠŸèƒ½ï¼šå°†åŸºæœ¬æ•°æ®ç±»å‹å†™å…¥è¾“å‡ºæµï¼ˆintã€doubleã€UTFå­—ç¬¦ä¸²ã€boolean ç­‰ï¼‰
â”‚   â”œâ”€â”€ ç‰¹ç‚¹ï¼š
â”‚   â”‚   â”œâ”€â”€ äºŒè¿›åˆ¶æ ¼å¼å†™å…¥ï¼Œç»“æ„å›ºå®šï¼Œä¸æ˜“å‡ºé”™
â”‚   â”‚   â”œâ”€â”€ åº•å±‚æ˜¯ OutputStreamï¼ˆå¦‚ FileOutputStreamï¼‰
â”‚   â”‚   â””â”€â”€ æ”¯æŒ writeIntã€writeUTFã€writeBoolean ç­‰æ–¹æ³•
â”‚   â”œâ”€â”€ é€‚ç”¨åœºæ™¯ï¼š
â”‚   â”‚   â”œâ”€â”€ ç²¾å‡†å†™å…¥ç»“æ„åŒ–æ•°æ®ï¼ˆå¦‚é…ç½®é¡¹ã€è®°å½•ã€ç½‘ç»œé€šä¿¡ï¼‰
â”‚   â”‚   â””â”€â”€ æ›¿ä»£ ObjectStreamï¼Œå®ç°è½»é‡å‹æ•°æ®å­˜å‚¨
â”‚   â”œâ”€â”€ å¸¸ç”¨æ„é€ æ–¹æ³•ï¼š
â”‚   â”‚   â”œâ”€â”€ new DataOutputStream(new FileOutputStream("data.dat"))
â”‚   â”‚   â””â”€â”€ new DataOutputStream(OutputStream out)
â”‚   â””â”€â”€ ç¤ºä¾‹ä»£ç ï¼š
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       â”‚ DataOutputStream dos =                                 â”‚
â”‚       â”‚     new DataOutputStream(new FileOutputStream("data.dat")); â”‚
â”‚       â”‚ dos.writeInt(123);                                      â”‚
â”‚       â”‚ dos.writeUTF("ä½ å¥½ Java");                              â”‚
â”‚       â”‚ dos.writeBoolean(true);                                 â”‚
â”‚       â”‚ dos.close();                                            â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â”œâ”€â”€ 1.2 DataInputStreamï¼ˆæ•°æ®è¾“å…¥æµï¼‰
â”‚   â”œâ”€â”€ åŠŸèƒ½ï¼šä»è¾“å…¥æµä¸­è¯»å–åŸºæœ¬ç±»å‹æ•°æ®ï¼Œå¿…é¡»ä¸å†™å…¥é¡ºåºä¸€è‡´
â”‚   â”œâ”€â”€ ç‰¹ç‚¹ï¼š
â”‚   â”‚   â”œâ”€â”€ æ•°æ®æ ¼å¼ä¸ write æ–¹æ³•ä¸¥æ ¼å¯¹åº”
â”‚   â”‚   â”œâ”€â”€ åº•å±‚æ˜¯ InputStreamï¼ˆå¦‚ FileInputStreamï¼‰
â”‚   â”‚   â””â”€â”€ æ”¯æŒ readIntã€readUTFã€readBoolean ç­‰æ–¹æ³•
â”‚   â”œâ”€â”€ é€‚ç”¨åœºæ™¯ï¼š
â”‚   â”‚   â”œâ”€â”€ æ¢å¤ç²¾ç¡®ç»“æ„æ•°æ®ï¼ˆå¦‚æ¸¸æˆçŠ¶æ€ã€é€šä¿¡åè®®ã€ç”¨æˆ·é…ç½®ï¼‰
â”‚   â”‚   â””â”€â”€ å¤šå­—æ®µæ··åˆè¯»å†™ï¼Œä»£æ›¿æ–‡æœ¬æ ¼å¼é¿å…è§£æé”™è¯¯
â”‚   â”œâ”€â”€ å¸¸ç”¨æ„é€ æ–¹æ³•ï¼š
â”‚   â”‚   â”œâ”€â”€ new DataInputStream(new FileInputStream("data.dat"))
â”‚   â”‚   â””â”€â”€ new DataInputStream(InputStream in)
â”‚   â””â”€â”€ ç¤ºä¾‹ä»£ç ï¼š
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       â”‚ DataInputStream dis =                                  â”‚
â”‚       â”‚     new DataInputStream(new FileInputStream("data.dat")); â”‚
â”‚       â”‚ int num = dis.readInt();                               â”‚
â”‚       â”‚ String text = dis.readUTF();                           â”‚
â”‚       â”‚ boolean flag = dis.readBoolean();                      â”‚
â”‚       â”‚ System.out.println("è¯»å–ï¼š" + num + ", " + text + ", " + flag); â”‚
â”‚       â”‚ dis.close();                                           â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â””â”€â”€ å°ç»“ä¸æ³¨æ„äº‹é¡¹
    â”œâ”€â”€ ä¼˜åŠ¿ï¼š
    â”‚   â”œâ”€â”€ ç±»å‹æ˜ç¡®ï¼Œæ— éœ€ç±»å‹è½¬æ¢ï¼Œé¡ºåºè¯»å†™å®‰å…¨
    â”‚   â”œâ”€â”€ æ”¯æŒ UTF ç¼–ç å­—ç¬¦ä¸²ï¼ˆå¯ä¿å­˜ä¸­æ–‡ï¼‰
    â”‚   â””â”€â”€ å¯ç”¨ä½œè½»é‡å‹äºŒè¿›åˆ¶åè®®
    â”œâ”€â”€ æ³¨æ„äº‹é¡¹ï¼š
    â”‚   â”œâ”€â”€ å†™å…¥é¡ºåºå¿…é¡»ä¸è¯»å–é¡ºåºä¸€è‡´ï¼ˆå¦åˆ™æŠ¥é”™æˆ–æ•°æ®é”™ä¹±ï¼‰
    â”‚   â”œâ”€â”€ .dat æ–‡ä»¶æ˜¯äºŒè¿›åˆ¶æ ¼å¼ï¼Œç”¨æ–‡æœ¬æ‰“å¼€ä¼šä¹±ç 
    â”‚   â”œâ”€â”€ writeUTF / readUTF æœ‰å†…éƒ¨ç¼–ç å¤´ï¼ˆä¸èƒ½æ··ç”¨ writeBytesï¼‰
    â”‚   â””â”€â”€ å¯æ­é… BufferedOutputStream æé«˜æ•ˆç‡
    â””â”€â”€ æ¨èç»„åˆä½¿ç”¨ï¼š
        â”œâ”€â”€ DataOutputStream + BufferedOutputStream + FileOutputStream
        â””â”€â”€ DataInputStream + BufferedInputStream + FileInputStream
```

### 6.2 æ„é€ æ–¹æ³•


```java
// è¾“å‡ºï¼šå†™å…¥æ•°æ®ç±»å‹
DataOutputStream dos = new DataOutputStream(new FileOutputStream("data.dat"));

// è¾“å…¥ï¼šè¯»å–æ•°æ®ç±»å‹
DataInputStream dis = new DataInputStream(new FileInputStream("data.dat"));
```

### 6.3 å¸¸ç”¨æ–¹æ³•åŸºç¡€ç¤ºä¾‹


```java
// å†™å…¥æ•°æ®
public class DataWriteDemo {
    public static void main(String[] args) throws IOException {
        DataOutputStream dos = new DataOutputStream(new FileOutputStream("data.dat"));
        dos.writeInt(100);                // å†™ intï¼ˆ4 å­—èŠ‚ï¼‰
        dos.writeUTF("ä½ å¥½, Java!");      // å†™å­—ç¬¦ä¸²ï¼ˆå¸¦é•¿åº¦ï¼‰
        dos.writeBoolean(true);           // å†™ booleanï¼ˆ1 å­—èŠ‚ï¼‰
        dos.close();                      // å…³é—­æµ
    }
}

// è¯»å–æ•°æ®
public class DataReadDemo {
    public static void main(String[] args) throws IOException {
        DataInputStream dis = new DataInputStream(new FileInputStream("data.dat"));

        int number = dis.readInt();            // é¡ºåºå¿…é¡»ä¸€è‡´
        String text = dis.readUTF();
        boolean flag = dis.readBoolean();

        System.out.println("int: " + number);
        System.out.println("String: " + text);
        System.out.println("Boolean: " + flag);

        dis.close();
    }
}
```

### 6.4 ç»“æ„åŒ–æ’è¡Œæ¦œè®°å½•ç¤ºä¾‹


```java
// âœ… 1. å®šä¹‰æ•°æ®ç±»ï¼ˆéå¿…é¡»åºåˆ—åŒ–ï¼‰
public class PlayerRecord {
    String username;
    int level;
    double score;
    boolean vip;

    public PlayerRecord(String username, int level, double score, boolean vip) {
        this.username = username;
        this.level = level;
        this.score = score;
        this.vip = vip;
    }

    public String toString() {
        return String.format("Player{name='%s', level=%d, score=%.2f, vip=%s}",
                username, level, score, vip ? "Y" : "N");
    }
}

// âœ… 2. å†™å…¥ç»“æ„åŒ–æ•°æ®ï¼ˆæ¨¡æ‹Ÿæ’è¡Œæ¦œä¿å­˜ï¼‰
public class WriteLeaderboard {
    public static void main(String[] args) throws IOException {
        List<PlayerRecord> players = List.of(
            new PlayerRecord("Alice", 12, 95.3, true),
            new PlayerRecord("Bob", 8, 88.5, false),
            new PlayerRecord("Charlie", 15, 99.2, true)
        );

        DataOutputStream dos = new DataOutputStream(new FileOutputStream("players.dat"));
        dos.writeInt(players.size()); // å†™å…¥æ€»æ¡æ•°

        for (PlayerRecord p : players) {
            dos.writeUTF(p.username);
            dos.writeInt(p.level);
            dos.writeDouble(p.score);
            dos.writeBoolean(p.vip);
        }

        dos.close();
        System.out.println("æ•°æ®å†™å…¥å®Œæ¯•ï¼");
    }
}

// âœ… 3. è¯»å–ç»“æ„åŒ–æ•°æ®ï¼ˆæ¢å¤ä¸ºå¯¹è±¡ï¼‰
public class ReadLeaderboard {
    public static void main(String[] args) throws IOException {
        DataInputStream dis = new DataInputStream(new FileInputStream("players.dat"));

        int count = dis.readInt(); // è¯»å–æ€»æ¡æ•°
        List<PlayerRecord> players = new ArrayList<>();

        for (int i = 0; i < count; i++) {
            String name = dis.readUTF();
            int level = dis.readInt();
            double score = dis.readDouble();
            boolean vip = dis.readBoolean();
            players.add(new PlayerRecord(name, level, score, vip));
        }

        dis.close();

        System.out.println("æ’è¡Œæ¦œè¯»å–ç»“æœï¼š");
        for (PlayerRecord p : players) {
            System.out.println(p);
        }
    }
}

/*
âœ… è¾“å‡ºç¤ºä¾‹ï¼š
æ•°æ®å†™å…¥å®Œæ¯•ï¼
æ’è¡Œæ¦œè¯»å–ç»“æœï¼š
Player{name='Alice', level=12, score=95.30, vip=Y}
Player{name='Bob', level=8, score=88.50, vip=N}
Player{name='Charlie', level=15, score=99.20, vip=Y}
*/
```

### 6.5 ä¸å…¶ä»–æµåŒºåˆ«æ€»ç»“


| å¯¹æ¯”é¡¹ | **DataXXXStream** | **ObjectXXXStream** | **BufferedXXXStream** |
|--------|-------------------|---------------------|----------------------|
| **æ“ä½œå¯¹è±¡** | `åŸºæœ¬ç±»å‹ï¼ˆintã€doubleã€Stringï¼‰` | `Java å¯¹è±¡ï¼ˆå®Œæ•´ç»“æ„ï¼‰` | `ä»»æ„å­—èŠ‚æ•°æ®ï¼ˆæ— ç»“æ„ï¼‰` |
| **å¯è¯»æ€§** | `å¦ï¼ˆæ˜¯äºŒè¿›åˆ¶ï¼‰` | `å¦ï¼ˆæ˜¯äºŒè¿›åˆ¶ï¼‰` | `å¦` |
| **æ˜¯å¦éœ€å®ç°æ¥å£** | `å¦` | `âœ… è¦å®ç° Serializable` | `å¦` |
| **ç±»å‹å®‰å…¨** | `âœ…ï¼ˆæŒ‰æ–¹æ³•å®šä¹‰å†™å…¥ï¼‰` | `âœ…ï¼ˆç±»ç»“æ„ä¿å­˜ï¼‰` | `âŒ å…¨æ˜¯å­—èŠ‚ï¼Œé è‡ªå·±è§£æ` |
| **æ˜¯å¦å¸¦ç¼“å†²** | `âŒï¼ˆæ‰‹åŠ¨åŒ… Buffered æ›´ä½³ï¼‰` | `âŒï¼ˆæ‰‹åŠ¨åŒ… Buffered æ›´ä½³ï¼‰` | `âœ… è‡ªå¸¦ç¼“å†²` |

### 6.6 ä½¿ç”¨åœºæ™¯


| åº”ç”¨åœºæ™¯ | **æè¿°** |
|----------|----------|
| **æ•°æ®ç²¾ç¡®è¯»å†™** | `ç²¾å‡†æ§åˆ¶å†™å…¥/è¯»å–çš„ç±»å‹å’Œé¡ºåºï¼ˆé¿å…ç±»å‹è½¬æ¢é—®é¢˜ï¼‰` |
| **ç½‘ç»œåè®®è®¾è®¡** | `è‡ªå®šä¹‰äºŒè¿›åˆ¶é€šä¿¡åè®®ï¼ˆå¦‚æ¸¸æˆã€ç‰©è”ç½‘ã€RPCï¼‰` |
| **å­˜å‚¨å¯¹è±¡çš„å­—æ®µå¿«ç…§** | `æ‰‹åŠ¨å°†å¯¹è±¡å±æ€§å†™å…¥ï¼ˆæ¯” ObjectOutputStream æ›´è½»é‡ï¼‰` |

### 6.7 æ³¨æ„äº‹é¡¹


| æ³¨æ„ç‚¹ | **è¯´æ˜** |
|--------|----------|
| **å†™å…¥ä¸è¯»å–é¡ºåºå¿…é¡»ä¸¥æ ¼ä¸€è‡´** | `å¦åˆ™å¯èƒ½æŠ›å‡º EOFException æˆ– UTFDataFormatException` |
| **writeUTF ä¸ writeBytes åŒºåˆ«** | `UTF æ˜¯å¸¦é•¿åº¦ã€æ”¯æŒä¸­æ–‡ï¼ŒwriteBytes åªæ˜¯çº¯å­—èŠ‚æ•°ç»„` |
| **ä¸èƒ½è·¨å¹³å°éšæ„æ‰“å¼€ .dat æ–‡ä»¶** | `å­˜çš„æ˜¯äºŒè¿›åˆ¶æ ¼å¼ï¼Œç”¨æ–‡æœ¬ç¼–è¾‘å™¨çœ‹ä¼šä¹±ç ` |
| **é€‚åˆå¤„ç†æ•°æ®è€Œéå®Œæ•´å¯¹è±¡ç»“æ„** | `æ— æ³•åƒ ObjectStream ä¸€æ ·ä¿å­˜å¯¹è±¡å¼•ç”¨å’Œç±»ä¿¡æ¯` |

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```java
ğŸ”¸ å­—èŠ‚æµç‰¹ç‚¹ï¼šå¤„ç†æ‰€æœ‰ç±»å‹æ–‡ä»¶ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½è¿›è¡Œæ“ä½œ
ğŸ”¸ æ–‡ä»¶æµï¼šç›´æ¥æ“ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œé€‚åˆæ–‡ä»¶è¯»å†™å’Œå¤åˆ¶
ğŸ”¸ å†…å­˜æµï¼šæ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œé€‚åˆæµ‹è¯•å’Œä¸­é—´å¤„ç†
ğŸ”¸ ç¼“å†²æµï¼šå¸¦ç¼“å†²åŒºä¼˜åŒ–ï¼Œæå‡å¤§æ–‡ä»¶å’Œé¢‘ç¹æ“ä½œæ€§èƒ½
ğŸ”¸ å¯¹è±¡æµï¼šåºåˆ—åŒ–Javaå¯¹è±¡ï¼Œå®ç°å¯¹è±¡æŒä¹…åŒ–å’Œç½‘ç»œä¼ è¾“
ğŸ”¸ æ•°æ®æµï¼šç²¾ç¡®è¯»å†™åŸºæœ¬æ•°æ®ç±»å‹ï¼Œé€‚åˆç»“æ„åŒ–æ•°æ®å­˜å‚¨
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ å­—èŠ‚æµä½“ç³»çš„è®¾è®¡å“²å­¦**
```
èŠ‚ç‚¹æµ + å¤„ç†æµçš„ç»„åˆæ¨¡å¼ï¼š
â€¢ FileXXXStreamï¼šèŠ‚ç‚¹æµï¼Œç›´æ¥è¿æ¥æ•°æ®æº
â€¢ BufferedXXXStreamï¼šå¤„ç†æµï¼ŒåŒ…è£…èŠ‚ç‚¹æµå¢å¼ºåŠŸèƒ½
â€¢ ObjectXXXStreamï¼šå¤„ç†æµï¼Œå¢åŠ åºåˆ—åŒ–åŠŸèƒ½
â€¢ DataXXXStreamï¼šå¤„ç†æµï¼Œå¢åŠ ç±»å‹å®‰å…¨åŠŸèƒ½

è£…é¥°è€…æ¨¡å¼çš„ä½“ç°ï¼š
new BufferedInputStream(new FileInputStream("file.txt"))
å¤–å±‚æµå¢å¼ºå†…å±‚æµçš„åŠŸèƒ½ï¼Œçµæ´»ç»„åˆ
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–çš„å±‚æ¬¡**
```
æ€§èƒ½ä»ä½åˆ°é«˜ï¼š
FileInputStream (é€å­—èŠ‚è¯»å–)
< FileInputStream + byte[] buffer (æ‰¹é‡è¯»å–)
< BufferedInputStream (å†…ç½®ç¼“å†²åŒº)
< BufferedInputStream + è‡ªå®šä¹‰å¤§ç¼“å†²åŒº (æœ€ä¼˜)

å…³é”®åŸåˆ™ï¼š
â€¢ å‡å°‘ç³»ç»Ÿè°ƒç”¨æ¬¡æ•°
â€¢ å¢å¤§æ¯æ¬¡è¯»å†™çš„æ•°æ®é‡
â€¢ ä½¿ç”¨åˆé€‚çš„ç¼“å†²åŒºå¤§å°
```

**ğŸ”¹ æ•°æ®æŒä¹…åŒ–çš„é€‰æ‹©**
```
è½»é‡çº§æ•°æ®ï¼šDataXXXStream
â€¢ åŸºæœ¬ç±»å‹ç»„åˆ
â€¢ ç»“æ„åŒ–è®°å½•
â€¢ ç½‘ç»œåè®®

å¤æ‚å¯¹è±¡ï¼šObjectXXXStream  
â€¢ å®Œæ•´å¯¹è±¡ç»“æ„
â€¢ å¯¹è±¡å…³ç³»ä¿æŒ
â€¢ ç‰ˆæœ¬å…¼å®¹æ€§è¦æ±‚

ä¸´æ—¶ç¼“å­˜ï¼šByteArrayXXXStream
â€¢ å†…å­˜æ“ä½œ
â€¢ ä¸­é—´å¤„ç†
â€¢ æµ‹è¯•åœºæ™¯
```

### 7.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ’¡ å…¸å‹åº”ç”¨åœºæ™¯**
- **æ–‡ä»¶ç®¡ç†ç³»ç»Ÿ**ï¼šä½¿ç”¨æ–‡ä»¶æµå’Œç¼“å†²æµå®ç°é«˜æ•ˆæ–‡ä»¶æ“ä½œ
- **ç½‘ç»œé€šä¿¡**ï¼šä½¿ç”¨å¯¹è±¡æµä¼ è¾“å¤æ‚æ•°æ®ï¼Œæ•°æ®æµä¼ è¾“åè®®
- **æ¸¸æˆå¼€å‘**ï¼šä½¿ç”¨å¯¹è±¡æµä¿å­˜æ¸¸æˆå­˜æ¡£ï¼Œæ•°æ®æµä¿å­˜é…ç½®
- **æ•°æ®å¤„ç†**ï¼šä½¿ç”¨å†…å­˜æµè¿›è¡Œä¸­é—´ç¼“å­˜å’Œæ ¼å¼è½¬æ¢

**ğŸ”§ å·¥ç¨‹å®è·µæŒ‡å¯¼**
- **æµçš„é€‰æ‹©**ï¼šæ ¹æ®æ•°æ®ç±»å‹å’Œæ€§èƒ½è¦æ±‚é€‰æ‹©åˆé€‚çš„æµ
- **èµ„æºç®¡ç†**ï¼šä½¿ç”¨try-with-resourcesç¡®ä¿æµæ­£ç¡®å…³é—­
- **æ€§èƒ½è°ƒä¼˜**ï¼šåˆç†è®¾ç½®ç¼“å†²åŒºå¤§å°ï¼Œå‡å°‘IOæ¬¡æ•°
- **é”™è¯¯å¤„ç†**ï¼šå¤„ç†å„ç§IOå¼‚å¸¸ï¼Œä¿è¯ç¨‹åºå¥å£®æ€§

### 7.4 æµçš„ç»„åˆä½¿ç”¨æ¨¡å¼


```java
// é«˜æ€§èƒ½æ–‡ä»¶å¤åˆ¶
try (BufferedInputStream bis = new BufferedInputStream(
         new FileInputStream("large_file.dat"), 16 * 1024);
     BufferedOutputStream bos = new BufferedOutputStream(
         new FileOutputStream("copy.dat"), 16 * 1024)) {
    // å¤åˆ¶é€»è¾‘
}

// å¯¹è±¡åºåˆ—åŒ– + ç¼“å†²ä¼˜åŒ–
try (ObjectOutputStream oos = new ObjectOutputStream(
         new BufferedOutputStream(
             new FileOutputStream("objects.dat")))) {
    // å†™å…¥å¯¹è±¡
}

// ç»“æ„åŒ–æ•°æ® + ç¼“å†²ä¼˜åŒ–
try (DataOutputStream dos = new DataOutputStream(
         new BufferedOutputStream(
             new FileOutputStream("data.dat")))) {
    // å†™å…¥åŸºæœ¬ç±»å‹æ•°æ®
}
```

### 7.5 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


| é—®é¢˜ç±»å‹ | **å¸¸è§åŸå› ** | **è§£å†³æ–¹æ¡ˆ** |
|----------|-------------|-------------|
| **æ€§èƒ½é—®é¢˜** | `é¢‘ç¹çš„å°é‡è¯»å†™` | `ä½¿ç”¨ç¼“å†²æµï¼Œå¢å¤§ç¼“å†²åŒº` |
| **å†…å­˜æº¢å‡º** | `å¤§æ–‡ä»¶ä¸€æ¬¡æ€§è¯»å…¥å†…å­˜` | `åˆ†å—è¯»å–ï¼Œä½¿ç”¨æµå¼å¤„ç†` |
| **æ•°æ®ä¸¢å¤±** | `æœªæ­£ç¡®å…³é—­è¾“å‡ºæµ` | `ä½¿ç”¨try-with-resources` |
| **åºåˆ—åŒ–å¼‚å¸¸** | `ç±»æœªå®ç°Serializable` | `å®ç°æ¥å£ï¼Œæ·»åŠ serialVersionUID` |
| **ç¼–ç é—®é¢˜** | `å­—èŠ‚æµå¤„ç†æ–‡æœ¬` | `ä½¿ç”¨å­—ç¬¦æµæˆ–æŒ‡å®šç¼–ç ` |

