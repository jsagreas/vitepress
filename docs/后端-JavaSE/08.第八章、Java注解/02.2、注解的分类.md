---
title: 2ã€æ³¨è§£çš„åˆ†ç±»
---
## ğŸ“š ç›®å½•

1. [å…ƒæ³¨è§£](#1-å…ƒæ³¨è§£)
2. [å†…ç½®æ³¨è§£](#2-å†…ç½®æ³¨è§£)
3. [æ ‡è®°æ³¨è§£](#3-æ ‡è®°æ³¨è§£)
4. [æºç æ³¨è§£](#4-æºç æ³¨è§£)
5. [ç¼–è¯‘æ—¶æ³¨è§£](#5-ç¼–è¯‘æ—¶æ³¨è§£)
6. [è¿è¡Œæ—¶æ³¨è§£](#6-è¿è¡Œæ—¶æ³¨è§£)
7. [å•å€¼/å¤šå±æ€§æ³¨è§£](#7-å•å€¼å¤šå±æ€§æ³¨è§£)

---

## 1. ğŸ”§ å…ƒæ³¨è§£


> **å…ƒæ³¨è§£**ï¼šç”¨äºä¿®é¥°è‡ªå®šä¹‰æ³¨è§£çš„æ³¨è§£ï¼Œæ˜¯æ³¨è§£çš„æ³¨è§£ï¼Œç”¨äºæ§åˆ¶æ³¨è§£çš„è¡Œä¸ºç‰¹æ€§

### 1.1 @Retention


#### 1.1.1 åŸºæœ¬æ¦‚å¿µ


**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
@Retentionï¼šæŒ‡å®šæ³¨è§£çš„ä¿ç•™ç­–ç•¥ï¼ˆç”Ÿå‘½å‘¨æœŸï¼‰
ä½œç”¨ï¼šæ§åˆ¶æ³¨è§£åœ¨ç¼–è¯‘ã€ç±»åŠ è½½ã€è¿è¡Œè¿‡ç¨‹ä¸­çš„å­˜åœ¨æ—¶é•¿
åŒ…è·¯å¾„ï¼šjava.lang.annotation.Retention
é…åˆä½¿ç”¨ï¼šRetentionPolicy æšä¸¾
```

#### 1.1.2 RetentionPolicyæšä¸¾è¯¦è§£


**ğŸ“Š ä¸‰ç§ç­–ç•¥å¯¹æ¯”è¡¨**

| ç­–ç•¥ | ä¿ç•™é˜¶æ®µ | å­˜åœ¨äº.class | å¯åå°„è®¿é—® | å…¸å‹åº”ç”¨ |
|------|----------|-------------|-----------|----------|
| **SOURCE** | ä»…æºä»£ç ä¸­ | âŒ | âŒ | ç¼–è¯‘å™¨æç¤ºã€è¯­æ³•æ ¡éªŒ |
| **CLASS** | ç¼–è¯‘åä¿ç•™ | âœ… | âŒ | APTå¤„ç†å™¨ã€å­—èŠ‚ç å·¥å…· |
| **RUNTIME** | è¿è¡Œæ—¶ä¿ç•™ | âœ… | âœ… | æ¡†æ¶åå°„ã€ä¾èµ–æ³¨å…¥ |

**ğŸ”¸ å„ç­–ç•¥è¯¦ç»†è¯´æ˜**

```java
// SOURCEï¼šç¼–è¯‘æ—¶ä¸¢å¼ƒ
@Retention(RetentionPolicy.SOURCE)
@interface CompileCheck {}

// CLASSï¼šé»˜è®¤ç­–ç•¥ï¼Œä¿ç•™åœ¨å­—èŠ‚ç ä¸­
@Retention(RetentionPolicy.CLASS)
@interface BytecodeInfo {}

// RUNTIMEï¼šè¿è¡Œæ—¶å¯åå°„è®¿é—®
@Retention(RetentionPolicy.RUNTIME)
@interface RuntimeConfig {}
```

#### 1.1.3 ç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾


```
ç¼–è¯‘é˜¶æ®µï¼š
æºä»£ç (.java) â†’ ç¼–è¯‘å™¨ â†’ å­—èŠ‚ç (.class)
SOURCEæ³¨è§£ â”˜                â””â”€ ä¸¢å¼ƒ
CLASSæ³¨è§£  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ ä¿ç•™
RUNTIMEæ³¨è§£ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ ä¿ç•™

ç±»åŠ è½½é˜¶æ®µï¼š
å­—èŠ‚ç (.class) â†’ ç±»åŠ è½½å™¨ â†’ JVMå†…å­˜
CLASSæ³¨è§£     â”˜              â””â”€ ä¸¢å¼ƒ
RUNTIMEæ³¨è§£   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ ä¿ç•™

è¿è¡Œæ—¶é˜¶æ®µï¼š
JVMå†…å­˜ â†’ åå°„API â†’ æ³¨è§£å¯¹è±¡
RUNTIMEæ³¨è§£ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ å¯è®¿é—®
```

#### 1.1.4 ä½¿ç”¨ç¤ºä¾‹


```java
// RUNTIMEæ³¨è§£ç¤ºä¾‹
@Retention(RetentionPolicy.RUNTIME)
@interface Log {
    String value() default "";
}

@Log("ç”¨æˆ·æœåŠ¡")
class UserService {}

// åå°„è®¿é—®
if (UserService.class.isAnnotationPresent(Log.class)) {
    Log log = UserService.class.getAnnotation(Log.class);
    System.out.println("æ—¥å¿—æ ‡è®°: " + log.value());
}
```

**ğŸ’¡ é€‰æ‹©å»ºè®®**

| ä½¿ç”¨åœºæ™¯ | æ¨èç­–ç•¥ | ç†ç”± |
|---------|---------|------|
| ç¼–è¯‘å™¨æ£€æŸ¥ã€IDEæç¤º | SOURCE | æ— éœ€ä¿ç•™åˆ°è¿è¡Œæ—¶ |
| ä»£ç ç”Ÿæˆã€å­—èŠ‚ç åˆ†æ | CLASS | éœ€è¦å­—èŠ‚ç å·¥å…·å¤„ç† |
| æ¡†æ¶é…ç½®ã€ä¾èµ–æ³¨å…¥ | RUNTIME | éœ€è¦è¿è¡Œæ—¶åå°„è®¿é—® |

---

### 1.2 @Target


#### 1.2.1 åŸºæœ¬æ¦‚å¿µ


**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
@Targetï¼šé™åˆ¶æ³¨è§£å¯è¢«ä½¿ç”¨çš„ç¨‹åºå…ƒç´ ä½ç½®
ä½œç”¨ï¼šæ˜ç¡®æ³¨è§£çš„ä½¿ç”¨èŒƒå›´ï¼Œé¿å…è¯¯ç”¨
å‚æ•°ç±»å‹ï¼šElementType[] æšä¸¾æ•°ç»„
ä½¿ç”¨æ–¹å¼ï¼š@Target({ElementType.TYPE, ElementType.METHOD})
```

#### 1.2.2 ElementTypeæšä¸¾å€¼


**ğŸ“ å¸¸ç”¨ä¿®é¥°ä½ç½®**

| æšä¸¾å¸¸é‡ | ä½œç”¨èŒƒå›´ | åº”ç”¨ç¤ºä¾‹ |
|---------|---------|---------|
| `TYPE` | ç±»ã€æ¥å£ã€æšä¸¾ | `@Component`, `@Entity` |
| `FIELD` | æˆå‘˜å˜é‡ | `@Autowired`, `@Value` |
| `METHOD` | æ–¹æ³• | `@RequestMapping`, `@Test` |
| `PARAMETER` | æ–¹æ³•å‚æ•° | `@RequestParam`, `@PathVariable` |
| `CONSTRUCTOR` | æ„é€ å™¨ | `@Inject`, `@Autowired` |
| `LOCAL_VARIABLE` | å±€éƒ¨å˜é‡ | å¾ˆå°‘ä½¿ç”¨ |
| `ANNOTATION_TYPE` | æ³¨è§£ç±»å‹ | åˆ›å»ºå…ƒæ³¨è§£æ—¶ä½¿ç”¨ |
| `PACKAGE` | åŒ…å£°æ˜ | `@XmlSchema` |

**ğŸ†• Java 8+ æ–°å¢**

| æšä¸¾å¸¸é‡ | ä½œç”¨èŒƒå›´ | åº”ç”¨ç¤ºä¾‹ |
|---------|---------|---------|
| `TYPE_PARAMETER` | æ³›å‹å‚æ•° | `class Box<@NotNull T>` |
| `TYPE_USE` | ç±»å‹ä½¿ç”¨ | `@NonNull String`, `List<@Email String>` |

#### 1.2.3 ä½¿ç”¨ç¤ºä¾‹


```java
// å•ä¸ªä½ç½®é™åˆ¶
@Target(ElementType.METHOD)
@interface MethodOnly {}

// å¤šä¸ªä½ç½®é™åˆ¶
@Target({ElementType.TYPE, ElementType.METHOD})
@interface FlexibleUse {}

// ä½¿ç”¨ç¤ºä¾‹
@FlexibleUse  // âœ… æ­£ç¡®ï¼Œå¯ç”¨äºç±»
public class Demo {
    
    @FlexibleUse  // âœ… æ­£ç¡®ï¼Œå¯ç”¨äºæ–¹æ³•
    public void test() {}
    
    @FlexibleUse  // âŒ ç¼–è¯‘é”™è¯¯ï¼Œä¸èƒ½ç”¨äºå­—æ®µ
    private String field;
}
```

**âš ï¸ ä½¿ç”¨æ³¨æ„äº‹é¡¹**

| è¯¯åŒº | æ­£è§£ |
|------|------|
| ä¸åŠ @Targetå°±ä¸èƒ½ç”¨ï¼Ÿ | âŒ é»˜è®¤å¯ç”¨äºæ‰€æœ‰å…ƒç´ ï¼ˆä¸æ¨èï¼‰ |
| TYPEå’ŒTYPE_USEæ˜¯ä¸€æ ·çš„ï¼Ÿ | âŒ TYPE_USEæ›´ç»†ç²’åº¦ï¼Œå¯ç”¨äºæ³›å‹ç­‰ |
| å¯ä»¥åŠ¨æ€ä¿®æ”¹Targetï¼Ÿ | âŒ ç¼–è¯‘æ—¶ç¡®å®šï¼Œæ— æ³•è¿è¡Œæ—¶ä¿®æ”¹ |

---

### 1.3 @Documented


#### 1.3.1 åŸºæœ¬æ¦‚å¿µ


**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
@Documentedï¼šæ§åˆ¶æ³¨è§£æ˜¯å¦åŒ…å«åœ¨Javadocæ–‡æ¡£ä¸­
ç±»å‹ï¼šæ ‡è®°æ³¨è§£ï¼ˆæ— å‚æ•°ï¼‰
ä½œç”¨ï¼šæé«˜æ³¨è§£æ–‡æ¡£åŒ–ç¨‹åº¦å’Œä»£ç å¯è¯»æ€§
é€‚ç”¨ï¼šä»…å¯ç”¨äºæ³¨è§£ç±»å‹å®šä¹‰
```

#### 1.3.2 å·¥ä½œæœºåˆ¶


```java
// æ–‡æ¡£åŒ–æ³¨è§£ç¤ºä¾‹
@Documented
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
@interface ApiInfo {
    String value();
}

@ApiInfo("ç”¨æˆ·ç®¡ç†API")
public class UserController {}
```

**ğŸ“– æ–‡æ¡£ç”Ÿæˆå¯¹æ¯”**

| æ³¨è§£ç±»å‹ | æ˜¯å¦åŠ @Documented | Javadocä¸­æ˜¾ç¤º | è¯´æ˜ |
|---------|------------------|-------------|------|
| å¸¦@Documented | âœ… | âœ… æ˜¾ç¤º | APIæ–‡æ¡£ä¸­åŒ…å«æ³¨è§£ä¿¡æ¯ |
| ä¸å¸¦@Documented | âŒ | âŒ ä¸æ˜¾ç¤º | APIæ–‡æ¡£ä¸­ä¸åŒ…å«æ³¨è§£ä¿¡æ¯ |

#### 1.3.3 åº”ç”¨åœºæ™¯


**âœ… æ¨èä½¿ç”¨@Documentedçš„åœºæ™¯**

- **å¯¹å¤–å…¬å¼€APIæ³¨è§£**ï¼šéœ€è¦è®©å¼€å‘è€…çœ‹åˆ°æ³¨è§£ç”¨é€”
- **æ¡†æ¶å±‚æ³¨è§£**ï¼šSpringã€JPAç­‰æ¡†æ¶æ³¨è§£å¤šæ•°å¸¦æœ‰@Documented
- **é‡è¦ä¸šåŠ¡æ³¨è§£**ï¼šéœ€è¦åœ¨æ–‡æ¡£ä¸­ä½“ç°çš„ä¸šåŠ¡è¯­ä¹‰

**âŒ ä¸æ¨èä½¿ç”¨çš„åœºæ™¯**

- **æ¡†æ¶å†…éƒ¨æ³¨è§£**ï¼šä¸éœ€è¦æš´éœ²å®ç°ç»†èŠ‚
- **ä¸´æ—¶æ ‡è®°æ³¨è§£**ï¼šé¿å…æ±¡æŸ“APIæ–‡æ¡£

```java
// å¯¹å¤–APIæ³¨è§£ï¼ˆæ¨èåŠ @Documentedï¼‰
@Documented
@Target(ElementType.METHOD)
@interface PublicApi {
    String version();
}

// å†…éƒ¨å®ç°æ³¨è§£ï¼ˆä¸åŠ @Documentedï¼‰
@Target(ElementType.METHOD)
@interface InternalUse {}
```

---

### 1.4 @Inherited


#### 1.4.1 åŸºæœ¬æ¦‚å¿µ


**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
@Inheritedï¼šæ ‡è®°æ³¨è§£æ˜¯å¦å¯ä»¥è¢«å­ç±»ç»§æ‰¿
ç±»å‹ï¼šæ ‡è®°æ³¨è§£ï¼ˆæ— å‚æ•°ï¼‰
é€‚ç”¨ï¼šä»…é™ç±»çº§åˆ«æ³¨è§£ï¼ˆElementType.TYPEï¼‰
æœºåˆ¶ï¼šå­ç±»å¯é€šè¿‡åå°„è·å–çˆ¶ç±»çš„æ³¨è§£
```

#### 1.4.2 ç»§æ‰¿æœºåˆ¶è¯¦è§£


**ğŸ”„ ç»§æ‰¿å·¥ä½œæµç¨‹**
```
çˆ¶ç±»æ³¨è§£ç»§æ‰¿æœºåˆ¶ï¼š

1. çˆ¶ç±»æ ‡è®°å…·æœ‰@Inheritedçš„æ³¨è§£
2. å­ç±»è‡ªåŠ¨"ç»§æ‰¿"è¯¥æ³¨è§£
3. å­ç±»æ— éœ€æ˜¾å¼å£°æ˜æ³¨è§£
4. é€šè¿‡Class.getAnnotation()å¯è·å–
```

**ğŸ“Š ç»§æ‰¿è§„åˆ™å¯¹æ¯”**

| ç»§æ‰¿æƒ…å†µ | æ˜¯å¦æ”¯æŒ | è¯´æ˜ |
|---------|---------|------|
| ç±»ç»§æ‰¿ç±» | âœ… | æ”¯æŒæ³¨è§£ç»§æ‰¿ |
| æ¥å£ç»§æ‰¿æ¥å£ | âŒ | ä¸æ”¯æŒ |
| ç±»å®ç°æ¥å£ | âŒ | ä¸æ”¯æŒ |
| æ–¹æ³•ã€å­—æ®µç»§æ‰¿ | âŒ | ä»…æ”¯æŒç±»çº§åˆ« |

#### 1.4.3 ä½¿ç”¨ç¤ºä¾‹


```java
// å®šä¹‰å¯ç»§æ‰¿æ³¨è§£
@Inherited
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
@interface Service {
    String value();
}

// çˆ¶ç±»ä½¿ç”¨æ³¨è§£
@Service("ç”¨æˆ·æœåŠ¡")
class BaseService {}

// å­ç±»è‡ªåŠ¨ç»§æ‰¿æ³¨è§£
class UserService extends BaseService {}

// åå°„éªŒè¯ç»§æ‰¿
Service service = UserService.class.getAnnotation(Service.class);
System.out.println(service.value()); // è¾“å‡ºï¼šç”¨æˆ·æœåŠ¡
```

#### 1.4.4 é€‚ç”¨åœºæ™¯


**âœ… é€‚åˆä½¿ç”¨@Inheritedçš„åœºæ™¯**

- **æ¡†æ¶çº§æ ‡è®°ç»§æ‰¿**ï¼šå¦‚@Transactionalã€@Secured
- **é€šç”¨é…ç½®ç»§æ‰¿**ï¼šçˆ¶ç±»é…ç½®åœ¨å­ç±»è‡ªåŠ¨ç”Ÿæ•ˆ
- **åˆ†ç±»æ ‡è®°ä¼ é€’**ï¼šå¦‚@Componentã€@Repository

**âŒ ä¸é€‚åˆä½¿ç”¨çš„åœºæ™¯**

- **ç²¾ç¡®å®šä½ä¿¡æ¯**ï¼šå¦‚@Versionã€@Author
- **å”¯ä¸€æ€§è¦æ±‚**ï¼šå¦‚@Idã€@Unique
- **å®ä¾‹çº§é…ç½®**ï¼šå¦‚@Qualifierã€æ„é€ å‚æ•°

```java
// é€‚åˆç»§æ‰¿çš„æ³¨è§£
@Inherited
@Target(ElementType.TYPE)
@interface Transactional {}

// ä¸é€‚åˆç»§æ‰¿çš„æ³¨è§£
@Target(ElementType.TYPE)
@interface Version {
    String value();
}
```

---

### 1.5 @Repeatable


#### 1.5.1 åŸºæœ¬æ¦‚å¿µ


**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
@Repeatableï¼šå…è®¸åœ¨åŒä¸€ç¨‹åºå…ƒç´ ä¸Šé‡å¤ä½¿ç”¨åŒä¸€æ³¨è§£
å¼•å…¥ç‰ˆæœ¬ï¼šJava 8
å‰ææ¡ä»¶ï¼šå¿…é¡»å®šä¹‰å®¹å™¨æ³¨è§£
ä½œç”¨ï¼šæä¾›æ›´ç›´è§‚çš„æ³¨è§£é‡å¤å£°æ˜è¯­æ³•
```

#### 1.5.2 å®¹å™¨æ³¨è§£æ¨¡å¼


**ğŸ”¸ å®ç°åŸç†**
```
é‡å¤æ³¨è§£å®ç°æœºåˆ¶ï¼š

@Tag("A")
@Tag("B")
@Tag("C")
â†“ ç¼–è¯‘å™¨è‡ªåŠ¨è½¬æ¢
@Tags({@Tag("A"), @Tag("B"), @Tag("C")})
```

**ğŸ“‹ å®šä¹‰è¦æ±‚**

| ç»„ä»¶ | è¦æ±‚ | è¯´æ˜ |
|------|------|------|
| å¯é‡å¤æ³¨è§£ | æ ‡æ³¨@Repeatable(å®¹å™¨.class) | æŒ‡å®šå®¹å™¨æ³¨è§£ |
| å®¹å™¨æ³¨è§£ | åŒ…å«value()æ–¹æ³•è¿”å›æ³¨è§£æ•°ç»„ | å­˜å‚¨å¤šä¸ªé‡å¤æ³¨è§£ |
| å…ƒæ³¨è§£ä¸€è‡´æ€§ | @Targetå’Œ@Retentionä¿æŒä¸€è‡´ | ç¡®ä¿å…¼å®¹æ€§ |

#### 1.5.3 å®Œæ•´ä½¿ç”¨ç¤ºä¾‹


```java
// 1. å®šä¹‰å¯é‡å¤æ³¨è§£
@Repeatable(Roles.class)
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
@interface Role {
    String value();
}

// 2. å®šä¹‰å®¹å™¨æ³¨è§£
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
@interface Roles {
    Role[] value();  // å¿…éœ€çš„æ–¹æ³•
}

// 3. ä½¿ç”¨é‡å¤æ³¨è§£
@Role("admin")
@Role("user")
@Role("guest")
public class UserService {}

// 4. åå°„è®¿é—®
Role[] roles = UserService.class.getAnnotationsByType(Role.class);
for (Role role : roles) {
    System.out.println("è§’è‰²: " + role.value());
}
```

#### 1.5.4 ä½¿ç”¨å¯¹æ¯”


**ğŸ”„ Java 8å‰åå¯¹æ¯”**

```java
// Java 8 ä¹‹å‰ï¼šå¿…é¡»ä½¿ç”¨å®¹å™¨æ³¨è§£
@Roles({
    @Role("admin"),
    @Role("user")
})
public class OldWay {}

// Java 8+ ä¹‹åï¼šå¯ä»¥ç›´æ¥é‡å¤
@Role("admin")
@Role("user")
public class NewWay {}
```

**ğŸ“Š ä¼˜åŠ¿å¯¹æ¯”**

| ç»´åº¦ | ä¼ ç»Ÿå®¹å™¨æ–¹å¼ | @Repeatableæ–¹å¼ |
|------|------------|----------------|
| è¯­æ³•ç®€æ´æ€§ | âŒ å†—é•¿ç¹ç | âœ… ç®€æ´ç›´è§‚ |
| å¯è¯»æ€§ | âŒ åµŒå¥—å¤æ‚ | âœ… æ¸…æ™°æ˜“æ‡‚ |
| ç»´æŠ¤æ€§ | âŒ å®¹æ˜“å‡ºé”™ | âœ… æ˜“äºç»´æŠ¤ |
| åå°„è®¿é—® | éœ€æ‰‹åŠ¨è§£æ | ç»Ÿä¸€APIè®¿é—® |

#### 1.5.5 å¸¸è§åº”ç”¨åœºæ™¯


```java
// æƒé™æ§åˆ¶
@Permission("READ")
@Permission("WRITE")
public class DataService {}

// APIæ ‡è®°
@ApiTag("user")
@ApiTag("admin")
public class UserController {}

// æ—¥å¿—æ ‡è®°
@LogTag("create")
@LogTag("audit")
public void createOrder() {}
```

**ğŸ’¡ æœ€ä½³å®è·µ**

- **é€‚åº¦ä½¿ç”¨**ï¼šé¿å…è¿‡åº¦é‡å¤ï¼Œå½±å“å¯è¯»æ€§
- **è¯­ä¹‰æ¸…æ™°**ï¼šæ¯ä¸ªé‡å¤æ³¨è§£åº”æœ‰æ˜ç¡®å«ä¹‰
- **æ€§èƒ½è€ƒè™‘**ï¼šæ³¨æ„åå°„è®¿é—®çš„æ€§èƒ½å¼€é”€
- **å‘åå…¼å®¹**ï¼šä¿æŒå¯¹æ—§ç‰ˆæœ¬å®¹å™¨æ³¨è§£çš„æ”¯æŒ

---

## 2. ğŸ“¦ å†…ç½®æ³¨è§£


> **å†…ç½®æ³¨è§£**ï¼šJavaè¯­è¨€æœ¬èº«æä¾›çš„æ ‡å‡†æ³¨è§£ï¼Œæ— éœ€è‡ªå®šä¹‰ï¼Œç”±ç¼–è¯‘å™¨æˆ–JVMç›´æ¥è¯†åˆ«å¤„ç†

### 2.1 @Override


#### 2.1.1 åŸºæœ¬æ¦‚å¿µ


**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
@Overrideï¼šæ ‡è¯†å½“å‰æ–¹æ³•é‡å†™çˆ¶ç±»æˆ–æ¥å£ä¸­çš„æ–¹æ³•
ç”Ÿå‘½å‘¨æœŸï¼šRetentionPolicy.SOURCEï¼ˆç¼–è¯‘æ—¶æœ‰æ•ˆï¼‰
é€‚ç”¨ä½ç½®ï¼šä»…èƒ½ç”¨äºæ–¹æ³•ä¸Š
ä½œç”¨ï¼šç¼–è¯‘å™¨æ ¡éªŒ + æå‡ä»£ç å¯è¯»æ€§
```

#### 2.1.2 æ ¸å¿ƒä½œç”¨


**ğŸ”¸ ç¼–è¯‘å™¨æ ¡éªŒæœºåˆ¶**

| æ ¡éªŒé¡¹ | è¯´æ˜ | æ— @Override | æœ‰@Override |
|--------|------|------------|------------|
| æ–¹æ³•åæ‹¼å†™ | æ£€æŸ¥æ˜¯å¦ä¸çˆ¶ç±»æ–¹æ³•ä¸€è‡´ | âš ï¸ å¯èƒ½éšè—é”™è¯¯ | âœ… ç¼–è¯‘æ—¶å‘ç° |
| å‚æ•°ç±»å‹ | æ£€æŸ¥æ–¹æ³•ç­¾åæ˜¯å¦åŒ¹é… | âš ï¸ å¯èƒ½é‡è½½è€Œéé‡å†™ | âœ… å¼ºåˆ¶åŒ¹é… |
| è¿”å›å€¼ç±»å‹ | æ£€æŸ¥è¿”å›ç±»å‹å…¼å®¹æ€§ | âš ï¸ å¯èƒ½ä¸å…¼å®¹ | âœ… ç±»å‹å®‰å…¨ |

#### 2.1.3 ä½¿ç”¨ç¤ºä¾‹


```java
// âœ… æ­£ç¡®ä½¿ç”¨
class Parent {
    void sayHello() {
        System.out.println("Hello from Parent");
    }
}

class Child extends Parent {
    @Override
    void sayHello() {  // æ­£ç¡®é‡å†™
        System.out.println("Hello from Child");
    }
}

// âŒ é”™è¯¯ç¤ºä¾‹ï¼ˆç¼–è¯‘å¤±è´¥ï¼‰
class BadChild extends Parent {
    @Override
    void sayhello() {  // æ–¹æ³•åæ‹¼å†™é”™è¯¯
        System.out.println("Wrong");
    }
}
```

**ğŸ”¸ é‡å†™vsé‡è½½å¯¹æ¯”**

| ç‰¹æ€§ | é‡å†™ï¼ˆOverrideï¼‰ | é‡è½½ï¼ˆOverloadï¼‰ |
|------|----------------|-----------------|
| æ˜¯å¦å¯ç”¨@Override | âœ… | âŒ |
| æ–¹æ³•ç­¾åè¦æ±‚ | å¿…é¡»ç›¸åŒ | å¿…é¡»ä¸åŒ |
| å‘ç”Ÿä½ç½® | çˆ¶å­ç±»é—´ | åŒä¸€ç±»ä¸­ |
| è¿è¡Œæ—¶è¡Œä¸º | å¤šæ€ | ç¼–è¯‘æœŸç¡®å®š |

---

### 2.2 @Deprecated


#### 2.2.1 åŸºæœ¬æ¦‚å¿µ


**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
@Deprecatedï¼šæ ‡è®°ç¨‹åºå…ƒç´ å·²è¿‡æ—¶ï¼Œä¸å»ºè®®ä½¿ç”¨
ç”Ÿå‘½å‘¨æœŸï¼šRetentionPolicy.CLASSï¼ˆé»˜è®¤ï¼‰
é€‚ç”¨ä½ç½®ï¼šç±»ã€æ–¹æ³•ã€å­—æ®µã€æ„é€ å™¨ç­‰
ä½œç”¨ï¼šAPIå‘åå…¼å®¹çš„é‡è¦æ‰‹æ®µ
```

#### 2.2.2 ç‰ˆæœ¬æ¼”è¿›


**ğŸ”¸ Javaç‰ˆæœ¬å¯¹æ¯”**

| ç‰ˆæœ¬ | æ”¯æŒç‰¹æ€§ | è¯­æ³•ç¤ºä¾‹ |
|------|---------|---------|
| **Java 5-8** | åŸºç¡€æ ‡è®° | `@Deprecated` |
| **Java 9+** | å¢å¼ºå±æ€§ | `@Deprecated(since="9", forRemoval=true)` |

```java
// Java 9+ å¢å¼ºè¯­æ³•
@Deprecated(since = "1.8", forRemoval = true)
public void oldMethod() {
    // å°†åœ¨æœªæ¥ç‰ˆæœ¬ä¸­ç§»é™¤
}

@Deprecated(since = "2.0")
public void legacyMethod() {
    // å·²åºŸå¼ƒä½†æš‚ä¸ç§»é™¤
}
```

#### 2.2.3 ä½¿ç”¨åœºæ™¯


**ğŸ“Š é€‚ç”¨èŒƒå›´**

| å¯ä¿®é¥°å…ƒç´  | æè¿° | å…¸å‹åœºæ™¯ |
|-----------|------|---------|
| `TYPE` | ç±»ã€æ¥å£ã€æšä¸¾ | æ•´ä¸ªAPIç±»åºŸå¼ƒ |
| `METHOD` | æ–¹æ³• | æ–¹æ³•å®ç°è¿‡æ—¶ |
| `FIELD` | æˆå‘˜å˜é‡ | é…ç½®é¡¹åºŸå¼ƒ |
| `CONSTRUCTOR` | æ„é€ å™¨ | æ„é€ æ–¹å¼å˜æ›´ |

```java
// ç±»çº§åºŸå¼ƒ
@Deprecated
public class OldApiClass {}

// æ–¹æ³•çº§åºŸå¼ƒ
public class ApiClass {
    @Deprecated
    public void oldMethod() {}
    
    public void newMethod() {}  // æ¨èä½¿ç”¨
}
```

#### 2.2.4 æœ€ä½³å®è·µ


**ğŸ’¡ ä½¿ç”¨å»ºè®®**

```java
/**
 * æ—§çš„ç”¨æˆ·éªŒè¯æ–¹æ³•
 * @deprecated ä»ç‰ˆæœ¬2.0å¼€å§‹åºŸå¼ƒï¼Œè¯·ä½¿ç”¨ {@link #authenticateUser(String, String)} æ›¿ä»£
 */
@Deprecated
public boolean validateUser(String username) {
    return authenticateUser(username, "");
}

public boolean authenticateUser(String username, String password) {
    // æ–°çš„å®ç°æ–¹å¼
    return true;
}
```

**ğŸ“‹ æ–‡æ¡£åŒ–è¦ç‚¹**

- **è¯´æ˜åºŸå¼ƒåŸå› **ï¼šä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨
- **æä¾›æ›¿ä»£æ–¹æ¡ˆ**ï¼šæ¨èä½¿ç”¨çš„æ–°API
- **æ ‡æ³¨åºŸå¼ƒç‰ˆæœ¬**ï¼šä½•æ—¶å¼€å§‹åºŸå¼ƒ
- **ç§»é™¤è®¡åˆ’**ï¼šæ˜¯å¦ä¼šåœ¨æœªæ¥ç§»é™¤

---

### 2.3 @SuppressWarnings


#### 2.3.1 åŸºæœ¬æ¦‚å¿µ


**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
@SuppressWarningsï¼šæŠ‘åˆ¶ç¼–è¯‘å™¨è­¦å‘Š
ç”Ÿå‘½å‘¨æœŸï¼šRetentionPolicy.CLASS
å‚æ•°ç±»å‹ï¼šString[]ï¼ˆè­¦å‘Šç±»å‹æ•°ç»„ï¼‰
ä½œç”¨ï¼šå‡å°‘å†—ä½™ä¿¡æ¯ï¼Œèšç„¦å…³é”®é—®é¢˜
```

#### 2.3.2 å¸¸ç”¨è­¦å‘Šç±»å‹


**ğŸ“Š è­¦å‘Šç±»å‹å¯¹ç…§è¡¨**

| è­¦å‘Šåç§° | æè¿° | å…¸å‹åœºæ™¯ |
|---------|------|---------|
| `"unchecked"` | æœªæ£€æŸ¥çš„ç±»å‹è½¬æ¢ | æ³›å‹åŸå§‹ç±»å‹ä½¿ç”¨ |
| `"deprecation"` | ä½¿ç”¨åºŸå¼ƒAPI | å…¼å®¹æ—§ä»£ç è°ƒç”¨ |
| `"rawtypes"` | åŸå§‹ç±»å‹æ³›å‹ | æœªæŒ‡å®šæ³›å‹å‚æ•° |
| `"unused"` | æœªä½¿ç”¨çš„å˜é‡/æ–¹æ³• | å ä½å‚æ•°ã€è°ƒè¯•ä»£ç  |
| `"serial"` | ç¼ºå°‘serialVersionUID | åºåˆ—åŒ–ç±» |
| `"all"` | æ‰€æœ‰è­¦å‘Šï¼ˆä¸æ¨èï¼‰ | ç´§æ€¥æƒ…å†µä¸´æ—¶ä½¿ç”¨ |

#### 2.3.3 ä½¿ç”¨ç¤ºä¾‹


```java
// å•ä¸ªè­¦å‘ŠæŠ‘åˆ¶
@SuppressWarnings("unchecked")
public void handleRawList() {
    List rawList = new ArrayList();
    List<String> stringList = rawList;  // æœªæ£€æŸ¥è½¬æ¢
}

// å¤šä¸ªè­¦å‘ŠæŠ‘åˆ¶
@SuppressWarnings({"deprecation", "unused"})
public void callLegacyCode() {
    Thread t = new Thread();
    t.stop();  // åºŸå¼ƒæ–¹æ³•
    int unused = 42;  // æœªä½¿ç”¨å˜é‡
}

// ä½œç”¨åŸŸæ§åˆ¶
public void scopeExample() {
    @SuppressWarnings("unused")
    int localVar = 123;  // ä»…å¯¹å±€éƒ¨å˜é‡ç”Ÿæ•ˆ
}
```

#### 2.3.4 ä½¿ç”¨åŸåˆ™


**ğŸ’¡ æœ€ä½³å®è·µ**

| åŸåˆ™ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **æœ€å°ä½œç”¨åŸŸ** | ä»…åœ¨å¿…è¦çš„æœ€å°èŒƒå›´ä½¿ç”¨ | ä¼˜å…ˆæ–¹æ³•çº§è€Œéç±»çº§ |
| **å…·ä½“ç±»å‹** | æ˜ç¡®æŒ‡å®šè­¦å‘Šç±»å‹ï¼Œé¿å…"all" | `@SuppressWarnings("unchecked")` |
| **æ–‡æ¡£è¯´æ˜** | æ·»åŠ æ³¨é‡Šè§£é‡ŠæŠ‘åˆ¶åŸå›  | `// ç¬¬ä¸‰æ–¹åº“å…¼å®¹æ€§è¦æ±‚` |
| **å®šæœŸå®¡æŸ¥** | éšä»£ç é‡æ„åŠæ—¶æ¸…ç† | åˆ é™¤ä¸å¿…è¦çš„æŠ‘åˆ¶ |

---

### 2.4 @FunctionalInterface


#### 2.4.1 åŸºæœ¬æ¦‚å¿µ


**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
@FunctionalInterfaceï¼šæ ‡è¯†æ¥å£ä¸ºå‡½æ•°å¼æ¥å£
å¼•å…¥ç‰ˆæœ¬ï¼šJava 8
é€‚ç”¨ä½ç½®ï¼šä»…èƒ½ç”¨äºæ¥å£
ä½œç”¨ï¼šLambdaè¡¨è¾¾å¼å’Œæ–¹æ³•å¼•ç”¨çš„åŸºç¡€
```

#### 2.4.2 å‡½æ•°å¼æ¥å£è§„åˆ™


**ğŸ”¸ SAMè§„åˆ™ï¼ˆSingle Abstract Methodï¼‰**

| è§„åˆ™ | è¯´æ˜ | æ˜¯å¦å…è®¸ |
|------|------|---------|
| æŠ½è±¡æ–¹æ³•æ•°é‡ | æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³• | âœ… å¿…é¡» |
| é»˜è®¤æ–¹æ³• | å¯ä»¥æœ‰å¤šä¸ªdefaultæ–¹æ³• | âœ… å…è®¸ |
| é™æ€æ–¹æ³• | å¯ä»¥æœ‰å¤šä¸ªstaticæ–¹æ³• | âœ… å…è®¸ |
| Objectæ–¹æ³• | ç»§æ‰¿Objectçš„publicæ–¹æ³•ä¸è®¡å…¥ | âœ… å…è®¸ |

#### 2.4.3 ä½¿ç”¨ç¤ºä¾‹


```java
// âœ… æ­£ç¡®çš„å‡½æ•°å¼æ¥å£
@FunctionalInterface
public interface Calculator {
    int calculate(int a, int b);  // å”¯ä¸€æŠ½è±¡æ–¹æ³•
    
    default void log(String msg) {  // é»˜è®¤æ–¹æ³•
        System.out.println(msg);
    }
    
    static void info() {  // é™æ€æ–¹æ³•
        System.out.println("è®¡ç®—å™¨æ¥å£");
    }
}

// âŒ é”™è¯¯ç¤ºä¾‹ï¼ˆå¤šä¸ªæŠ½è±¡æ–¹æ³•ï¼‰
@FunctionalInterface
public interface Invalid {
    void method1();
    void method2();  // ç¼–è¯‘é”™è¯¯
}

// Lambdaä½¿ç”¨ç¤ºä¾‹
Calculator add = (a, b) -> a + b;
Calculator multiply = (a, b) -> a * b;
System.out.println(add.calculate(5, 3));  // è¾“å‡º: 8
```

#### 2.4.4 å†…ç½®å‡½æ•°å¼æ¥å£


**ğŸ“¦ java.util.functionåŒ…å¸¸ç”¨æ¥å£**

| æ¥å£å | æŠ½è±¡æ–¹æ³• | åŠŸèƒ½æè¿° | ä½¿ç”¨ç¤ºä¾‹ |
|--------|---------|---------|---------|
| `Supplier<T>` | `T get()` | æä¾›æ•°æ® | `() -> "Hello"` |
| `Consumer<T>` | `void accept(T t)` | æ¶ˆè´¹æ•°æ® | `s -> System.out.println(s)` |
| `Function<T,R>` | `R apply(T t)` | æ•°æ®è½¬æ¢ | `s -> s.length()` |
| `Predicate<T>` | `boolean test(T t)` | æ¡ä»¶åˆ¤æ–­ | `s -> s.isEmpty()` |

```java
// å®é™…åº”ç”¨ç¤ºä¾‹
List<String> names = Arrays.asList("Alice", "Bob", "Charlie");

// ä½¿ç”¨Predicateè¿‡æ»¤
names.stream()
     .filter(name -> name.length() > 3)  // Predicate<String>
     .forEach(System.out::println);      // Consumer<String>
```

---

### 2.5 @SafeVarargs


#### 2.5.1 åŸºæœ¬æ¦‚å¿µ


**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
@SafeVarargsï¼šæŠ‘åˆ¶æ³›å‹å¯å˜å‚æ•°çš„"unchecked"è­¦å‘Š
å¼•å…¥ç‰ˆæœ¬ï¼šJava 7
é€‚ç”¨ä½ç½®ï¼šstaticæ–¹æ³•ã€finalæ–¹æ³•ã€æ„é€ å™¨ï¼ˆJava 9+ï¼‰
ä½œç”¨ï¼šå¼€å‘è€…å¯¹ç¼–è¯‘å™¨çš„å®‰å…¨æ‰¿è¯º
```

#### 2.5.2 æ³›å‹å¯å˜å‚æ•°é—®é¢˜


**âš ï¸ å †æ±¡æŸ“é£é™©**
```java
// é—®é¢˜ç¤ºä¾‹ï¼šæ³›å‹varargsçš„ç±»å‹å®‰å…¨éšæ‚£
public static void dangerousMethod(List<String>... lists) {
    Object[] array = lists;
    array[0] = Arrays.asList(42);  // å †æ±¡æŸ“
    String s = lists[0].get(0);    // ClassCastException!
}
```

**ğŸ”§ å®‰å…¨ä½¿ç”¨æ¨¡å¼**
```java
@SafeVarargs
public static <T> void safeMethod(T... items) {
    for (T item : items) {
        System.out.println(item);  // åªè¯»è®¿é—®ï¼Œå®‰å…¨
    }
}

@SafeVarargs
public static <T> List<T> asList(T... elements) {
    return Arrays.asList(elements);  // å®‰å…¨å°è£…
}
```

#### 2.5.3 ä½¿ç”¨é™åˆ¶


**ğŸ“Š ä½¿ç”¨æ¡ä»¶**

| ç‰ˆæœ¬ | å…è®¸ä½¿ç”¨çš„æ–¹æ³•ç±»å‹ | è¯´æ˜ |
|------|------------------|------|
| **Java 7** | staticæ–¹æ³•ã€finalæ–¹æ³• | é¿å…è¢«å­ç±»è¦†å†™ |
| **Java 8** | åŒä¸Š | æ— å˜åŒ– |
| **Java 9+** | å¢åŠ privateæ–¹æ³• | privateæ–¹æ³•æ— æ³•è¦†å†™ |

```java
// âœ… æ­£ç¡®ä½¿ç”¨
@SafeVarargs
public static <T> void staticMethod(T... args) {}

@SafeVarargs
public final <T> void finalMethod(T... args) {}

@SafeVarargs
private <T> void privateMethod(T... args) {}  // Java 9+

// âŒ é”™è¯¯ä½¿ç”¨
@SafeVarargs
public <T> void instanceMethod(T... args) {}  // ç¼–è¯‘é”™è¯¯
```

#### 2.5.4 æœ€ä½³å®è·µ


**ğŸ’¡ å®‰å…¨ä½¿ç”¨åŸåˆ™**

- **åªè¯»è®¿é—®**ï¼šä»…è¯»å–å¯å˜å‚æ•°ï¼Œä¸è¿›è¡Œå†™å…¥æ“ä½œ
- **å®‰å…¨å°è£…**ï¼šå°†å‚æ•°å®‰å…¨åœ°ä¼ é€’ç»™å…¶ä»–æ–¹æ³•
- **é¿å…ç±»å‹æ··æ·†**ï¼šä¸å°†å¯å˜å‚æ•°èµ‹å€¼ç»™Object[]
- **è°¨æ…ä½¿ç”¨**ï¼šç¡®å®å®‰å…¨æ—¶æ‰æ·»åŠ æ­¤æ³¨è§£

---

### 2.6 @Native


#### 2.6.1 åŸºæœ¬æ¦‚å¿µ


**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
@Nativeï¼šæ ‡è®°å¸¸é‡å­—æ®µå¯¼å‡ºç»™JNIä½¿ç”¨
å¼•å…¥ç‰ˆæœ¬ï¼šJava 8
é€‚ç”¨ä½ç½®ï¼šä»…èƒ½ç”¨äºå­—æ®µï¼ˆpublic static finalå¸¸é‡ï¼‰
ä½œç”¨ï¼šæ”¯æŒæœ¬åœ°å·¥å…·ç”ŸæˆC/C++å¤´æ–‡ä»¶
```

#### 2.6.2 ä½¿ç”¨è¦æ±‚


**ğŸ“Š å­—æ®µè¦æ±‚**

| æ¡ä»¶ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| ä¿®é¥°ç¬¦ | å¿…é¡»æ˜¯public static final | `public static final int CODE = 1;` |
| ç±»å‹ | åŸºæœ¬ç±»å‹æˆ–String | intã€longã€booleanã€Stringç­‰ |
| å·¥å…·é…åˆ | ä¸javac -hæˆ–javahé…åˆä½¿ç”¨ | ç”Ÿæˆ.hå¤´æ–‡ä»¶ |

#### 2.6.3 ä½¿ç”¨ç¤ºä¾‹


```java
public class ErrorCodes {
    @Native
    public static final int SUCCESS = 0;
    
    @Native
    public static final int FAILURE = 1;
    
    // ä¸ä¼šå¯¼å‡ºåˆ°nativeå±‚
    public static final int INTERNAL = 99;
}

// ç¼–è¯‘å‘½ä»¤
// javac -h . ErrorCodes.java
// ç”ŸæˆåŒ…å«SUCCESSå’ŒFAILUREçš„.hæ–‡ä»¶
```

#### 2.6.4 åº”ç”¨åœºæ™¯


**ğŸ”¸ å…¸å‹ä½¿ç”¨åœºæ™¯**

- **JNIæ¥å£å¼€å‘**ï¼šJavaå¸¸é‡éœ€è¦åœ¨C/C++ä¸­ä½¿ç”¨
- **ç³»ç»Ÿçº§ç¼–ç¨‹**ï¼šä¸åº•å±‚ç³»ç»ŸAPIäº¤äº’
- **æ€§èƒ½æ•æ„Ÿåœºæ™¯**ï¼šéƒ¨åˆ†é€»è¾‘ç”¨nativeå®ç°

**âš ï¸ æ³¨æ„äº‹é¡¹**

- å¯¹Javaè¿è¡Œæ— å½±å“ï¼Œä»…å½±å“nativeå±‚å·¥å…·è§£æ
- Java 9åjavahè¢«åºŸå¼ƒï¼Œä½¿ç”¨javac -hæ›¿ä»£
- ä¸»è¦ç”¨äºç³»ç»Ÿçº§å¼€å‘ï¼Œåº”ç”¨å¼€å‘ä¸­è¾ƒå°‘ä½¿ç”¨

---

### 2.7 @Generated


#### 2.7.1 åŸºæœ¬æ¦‚å¿µ


**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
@Generatedï¼šæ ‡è®°ç”±å·¥å…·ç”Ÿæˆçš„ä»£ç 
åŒ…è·¯å¾„ï¼šjavax.annotation.Generatedï¼ˆJava 6-8ï¼‰
        jakarta.annotation.Generatedï¼ˆJava 9+ï¼‰
ä½œç”¨ï¼šåŒºåˆ†æ‰‹å†™ä»£ç ä¸ç”Ÿæˆä»£ç 
ç”¨é€”ï¼šä»£ç å®¡æŸ¥ã€æ–‡æ¡£ç”Ÿæˆã€å·®å¼‚æ¯”å¯¹
```

#### 2.7.2 æ³¨è§£å±æ€§


**ğŸ“Š å±æ€§è¯´æ˜**

| å±æ€§å | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| `value` | String[] | ç”Ÿæˆå·¥å…·åç§° | `"MyCodeGenerator"` |
| `date` | String | ç”Ÿæˆæ—¶é—´ | `"2025-01-20T10:15:30"` |
| `comments` | String | å¤‡æ³¨ä¿¡æ¯ | `"è¯·å‹¿æ‰‹åŠ¨ä¿®æ”¹"` |

#### 2.7.3 ä½¿ç”¨ç¤ºä¾‹


```java
// åŸºæœ¬ä½¿ç”¨
@Generated("com.example.codegen.MyTool")
public class GeneratedClass {}

// å®Œæ•´ä¿¡æ¯
@Generated(
    value = "org.mapstruct.ap.MappingProcessor",
    date = "2025-01-20T10:15:30+0800",
    comments = "Generated from mapping interfaces"
)
public class UserMapperImpl implements UserMapper {
    // è‡ªåŠ¨ç”Ÿæˆçš„æ˜ å°„å®ç°
}
```

#### 2.7.4 å¸¸è§ç”Ÿæˆå·¥å…·


**ğŸ› ï¸ å…¸å‹åº”ç”¨åœºæ™¯**

| å·¥å…· | ç”Ÿæˆå†…å®¹ | æ ‡è®°æ–¹å¼ |
|------|---------|---------|
| **Lombok** | Getter/Setteræ–¹æ³• | é€šå¸¸ä¸ä½¿ç”¨@Generated |
| **MapStruct** | å¯¹è±¡æ˜ å°„ç±» | æ ‡è®°@Generated |
| **JPAå·¥å…·** | å®ä½“ç±» | æ ‡è®°@Generated |
| **MyBatis Generator** | DAOç±» | æ ‡è®°@Generated |

**ğŸ’¡ æœ€ä½³å®è·µ**

- **æ˜ç¡®æ ‡è®°æ¥æº**ï¼švalueå±æ€§å¡«å†™å®Œæ•´çš„å·¥å…·åç§°
- **è®°å½•ç”Ÿæˆæ—¶é—´**ï¼šä¾¿äºç‰ˆæœ¬æ§åˆ¶å’Œé—®é¢˜è¿½è¸ª
- **æ·»åŠ ä½¿ç”¨è¯´æ˜**ï¼šcommentsä¸­è¯´æ˜ä¸è¦æ‰‹åŠ¨ä¿®æ”¹
- **å·¥å…·é›†æˆ**ï¼šé…ç½®IDEè¯†åˆ«ç”Ÿæˆä»£ç è¿›è¡Œç‰¹æ®Šå¤„ç†

---

## 3. ğŸ·ï¸ æ ‡è®°æ³¨è§£


### 3.1 åŸºæœ¬æ¦‚å¿µ


**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
æ ‡è®°æ³¨è§£ï¼šä¸åŒ…å«ä»»ä½•å±æ€§/æˆå‘˜çš„æ³¨è§£
ç‰¹å¾ï¼šåªæœ‰æ³¨è§£åï¼Œä¸å¸¦å‚æ•°
ä½œç”¨ï¼šä¸ºç¨‹åºå…ƒç´ æ‰“ä¸Šæ ‡è®°æˆ–å…ƒä¿¡æ¯
è¯†åˆ«ï¼šç¼–è¯‘å™¨æˆ–å·¥å…·åœ¨ç¼–è¯‘æœŸæˆ–è¿è¡ŒæœŸè¯†åˆ«å¤„ç†
```

### 3.2 è¯­æ³•ç‰¹å¾


```java
// æ ‡è®°æ³¨è§£å®šä¹‰
public @interface MyMarker {}  // æ— å±æ€§æ–¹æ³•

// ä½¿ç”¨æ–¹å¼
@MyMarker  // âœ… æ­£ç¡®ï¼Œæ— å‚æ•°
@Override  // âœ… æ­£ç¡®ï¼Œæ ‡è®°æ³¨è§£
@Component // âœ… æ­£ç¡®ï¼Œæ ‡è®°æ³¨è§£
```

### 3.3 å¸¸è§æ ‡è®°æ³¨è§£


**ğŸ“Š Javaå†…ç½®æ ‡è®°æ³¨è§£**

| æ³¨è§£å | è¯´æ˜ | ä½¿ç”¨ä½ç½® |
|--------|------|---------|
| `@Override` | æ ‡è®°é‡å†™æ–¹æ³• | æ–¹æ³• |
| `@Deprecated` | æ ‡è®°åºŸå¼ƒå…ƒç´  | ç±»ã€æ–¹æ³•ã€å­—æ®µç­‰ |
| `@FunctionalInterface` | æ ‡è®°å‡½æ•°å¼æ¥å£ | æ¥å£ |
| `@SafeVarargs` | æ ‡è®°å®‰å…¨çš„å¯å˜å‚æ•° | æ–¹æ³•ã€æ„é€ å™¨ |
| `@Documented` | æ ‡è®°æ–‡æ¡£åŒ–æ³¨è§£ | æ³¨è§£ç±»å‹ |
| `@Inherited` | æ ‡è®°å¯ç»§æ‰¿æ³¨è§£ | æ³¨è§£ç±»å‹ |

### 3.4 è‡ªå®šä¹‰æ ‡è®°æ³¨è§£


```java
// å®šä¹‰ä¸šåŠ¡æ ‡è®°æ³¨è§£
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
public @interface RestController {}

@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface AdminOnly {}

// ä½¿ç”¨ç¤ºä¾‹
@RestController
public class UserController {
    
    @AdminOnly
    public void deleteUser() {}
}

// åå°„æ£€æŸ¥
if (UserController.class.isAnnotationPresent(RestController.class)) {
    System.out.println("è¿™æ˜¯ä¸€ä¸ªRESTæ§åˆ¶å™¨");
}
```

### 3.5 åº”ç”¨åœºæ™¯


**ğŸ¯ å…¸å‹ä½¿ç”¨åœºæ™¯**

| åœºæ™¯ | ç¤ºä¾‹ | ä½œç”¨ |
|------|------|------|
| **ç¼–è¯‘å™¨è¡Œä¸ºæ§åˆ¶** | `@Override`ã€`@FunctionalInterface` | ç¼–è¯‘æ—¶æ ¡éªŒ |
| **æ¡†æ¶ç»„ä»¶æ ‡è®°** | `@Component`ã€`@Service` | è¿è¡Œæ—¶æ‰«æ |
| **æƒé™åˆ†ç±»** | `@AdminOnly`ã€`@PublicApi` | è®¿é—®æ§åˆ¶ |
| **ä»£ç åˆ†ç±»** | `@InternalUse`ã€`@Experimental` | ä»£ç ç®¡ç† |

### 3.6 ä¸å…¶ä»–æ³¨è§£ç±»å‹å¯¹æ¯”


**ğŸ“Š æ³¨è§£ç±»å‹å¯¹æ¯”**

| ç±»å‹ | æ˜¯å¦æœ‰å±æ€§ | ç¤ºä¾‹ | ä¸»è¦ç”¨é€” |
|------|----------|------|---------|
| **æ ‡è®°æ³¨è§£** | âŒ æ—  | `@Override` | è¡¨è¾¾"æ˜¯å¦å­˜åœ¨" |
| **å•å€¼æ³¨è§£** | âœ… ä¸€ä¸ª | `@SuppressWarnings("unchecked")` | ä¼ å…¥å•ä¸ªé…ç½®å€¼ |
| **å¤šå€¼æ³¨è§£** | âœ… å¤šä¸ª | `@RequestMapping(value="/api", method=GET)` | ä¼ å…¥å¤šä¸ªé…ç½®ä¿¡æ¯ |

---

## 4. ğŸ“ æºç æ³¨è§£


### 4.1 åŸºæœ¬æ¦‚å¿µ


**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
æºç æ³¨è§£ï¼šä¿ç•™ç­–ç•¥ä¸ºRetentionPolicy.SOURCEçš„æ³¨è§£
ç”Ÿå‘½å‘¨æœŸï¼šä»…åœ¨ç¼–è¯‘é˜¶æ®µæœ‰æ•ˆï¼Œç¼–è¯‘åè¢«ä¸¢å¼ƒ
ç‰¹ç‚¹ï¼šä¸ä¼šå†™å…¥.classæ–‡ä»¶ï¼Œè¿è¡Œæ—¶ä¸å¯åå°„è·å–
ç”¨é€”ï¼šç¼–è¯‘æ—¶å¤„ç†å’Œä»£ç ç”Ÿæˆ
```

### 4.2 ç”Ÿå‘½å‘¨æœŸå¯¹æ¯”


**ğŸ“Š æ³¨è§£ç”Ÿå‘½å‘¨æœŸè¡¨**

| ç”Ÿå‘½å‘¨æœŸ | RetentionPolicy | ç¼–è¯‘åä¿ç•™ | å¯åå°„è®¿é—® | å…¸å‹ç”¨é€” |
|---------|----------------|-----------|-----------|---------|
| **æºç çº§** | `SOURCE` | âŒ | âŒ | ç¼–è¯‘å™¨æç¤ºã€APTå¤„ç† |
| **å­—èŠ‚ç çº§** | `CLASS` | âœ… | âŒ | å­—èŠ‚ç å·¥å…·ã€APTå¤„ç† |
| **è¿è¡Œæ—¶çº§** | `RUNTIME` | âœ… | âœ… | æ¡†æ¶åå°„ã€ä¾èµ–æ³¨å…¥ |

### 4.3 æ ¸å¿ƒä½œç”¨


**ğŸ”¸ ä¸»è¦åº”ç”¨é¢†åŸŸ**

```java
ç¼–è¯‘å™¨æ ¡éªŒï¼š
â€¢ @Overrideï¼šæ£€æŸ¥æ–¹æ³•é‡å†™æ­£ç¡®æ€§
â€¢ @FunctionalInterfaceï¼šéªŒè¯å‡½æ•°å¼æ¥å£ç»“æ„
â€¢ @SuppressWarningsï¼šæŠ‘åˆ¶ç‰¹å®šç¼–è¯‘è­¦å‘Š

ä»£ç ç”Ÿæˆï¼ˆAPTï¼‰ï¼š
â€¢ Lombokï¼š@Dataã€@Getterç­‰è‡ªåŠ¨ç”Ÿæˆæ–¹æ³•
â€¢ MapStructï¼š@Mapperç”Ÿæˆæ˜ å°„å®ç°
â€¢ AutoServiceï¼š@AutoServiceç”ŸæˆSPIé…ç½®

IDEæ”¯æŒï¼š
â€¢ æ™ºèƒ½æç¤ºå’Œé”™è¯¯æ£€æŸ¥
â€¢ ä»£ç é«˜äº®å’Œå¯¼èˆª
â€¢ é‡æ„æ”¯æŒ
```

### 4.4 å¸¸è§æºç æ³¨è§£


**ğŸ“‹ JDKå†…ç½®æºç æ³¨è§£**

| æ³¨è§£å | ä½œç”¨ | æ˜¯å¦æ ‡è®°æ³¨è§£ |
|--------|------|------------|
| `@Override` | é‡å†™æ–¹æ³•æ ¡éªŒ | âœ… |
| `@SuppressWarnings` | æŠ‘åˆ¶ç¼–è¯‘è­¦å‘Š | âŒï¼ˆæœ‰å‚æ•°ï¼‰ |
| `@FunctionalInterface` | å‡½æ•°å¼æ¥å£çº¦æŸ | âœ… |
| `@SafeVarargs` | æ³›å‹å¯å˜å‚æ•°å®‰å…¨æ ‡è®° | âœ… |

### 4.5 ä½¿ç”¨ç¤ºä¾‹


```java
// ç¼–è¯‘å™¨æ ¡éªŒç¤ºä¾‹
public class Parent {
    void method() {}
}

public class Child extends Parent {
    @Override
    void method() {}  // ç¼–è¯‘å™¨æ ¡éªŒé‡å†™æ­£ç¡®æ€§
    
    @SuppressWarnings("deprecation")
    void callDeprecated() {
        // æŠ‘åˆ¶åºŸå¼ƒAPIè­¦å‘Š
    }
}

// è‡ªå®šä¹‰æºç æ³¨è§£
@Retention(RetentionPolicy.SOURCE)
@Target(ElementType.TYPE)
public @interface GenerateBuilder {}

@GenerateBuilder  // APTå¤„ç†å™¨ä¼šç”ŸæˆBuilderç±»
public class User {
    private String name;
    private int age;
}
```

### 4.6 APTï¼ˆæ³¨è§£å¤„ç†å™¨ï¼‰æ”¯æŒ


**ğŸ”§ æ³¨è§£å¤„ç†å™¨å·¥ä½œæµç¨‹**

```
ç¼–è¯‘è¿‡ç¨‹ï¼š
æºä»£ç (.java) â†’ æ³¨è§£å¤„ç†å™¨ â†’ ç”Ÿæˆæ–°ä»£ç  â†’ ç¼–è¯‘æˆå­—èŠ‚ç 

APTå¤„ç†ç‰¹ç‚¹ï¼š
â€¢ å¯ä»¥è¯»å–SOURCEå’ŒCLASSçº§åˆ«çš„æ³¨è§£
â€¢ èƒ½å¤Ÿç”Ÿæˆæ–°çš„Javaæºæ–‡ä»¶
â€¢ åœ¨ç¼–è¯‘æœŸé—´æ‰§è¡Œï¼Œä¸å½±å“è¿è¡Œæ—¶æ€§èƒ½
â€¢ å¸¸ç”¨äºä»£ç ç”Ÿæˆã€éªŒè¯ã€æ–‡æ¡£ç”Ÿæˆ
```

### 4.7 æœ€ä½³å®è·µ


**ğŸ’¡ ä½¿ç”¨å»ºè®®**

| åœºæ™¯ | æ¨èåšæ³• | ç†ç”± |
|------|---------|------|
| **ç¼–è¯‘æ£€æŸ¥** | ç§¯æä½¿ç”¨`@Override` | é˜²æ­¢ä½çº§é”™è¯¯ |
| **è­¦å‘ŠæŠ‘åˆ¶** | æœ€å°èŒƒå›´ä½¿ç”¨`@SuppressWarnings` | é¿å…éšè—çœŸå®é—®é¢˜ |
| **ä»£ç ç”Ÿæˆ** | åˆç†ä½¿ç”¨APTå·¥å…· | å‡å°‘æ ·æ¿ä»£ç  |
| **æ¥å£çº¦æŸ** | ä½¿ç”¨`@FunctionalInterface` | æ˜ç¡®è®¾è®¡æ„å›¾ |

**âš ï¸ æ³¨æ„äº‹é¡¹**

- æºç æ³¨è§£ä¸å½±å“è¿è¡Œæ—¶è¡Œä¸º
- æ— æ³•é€šè¿‡åå°„è®¿é—®æºç æ³¨è§£
- APTå¤„ç†å™¨éœ€è¦æ­£ç¡®é…ç½®æ‰èƒ½ç”Ÿæ•ˆ
- è¿‡åº¦ä½¿ç”¨å¯èƒ½å½±å“ç¼–è¯‘æ€§èƒ½

---

## 5. âš™ï¸ ç¼–è¯‘æ—¶æ³¨è§£


### 5.1 åŸºæœ¬æ¦‚å¿µ


**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
ç¼–è¯‘æ—¶æ³¨è§£ï¼šåœ¨ç¼–è¯‘é˜¶æ®µè¢«å·¥å…·è¯»å–å¤„ç†çš„æ³¨è§£
ç”Ÿå‘½å‘¨æœŸï¼šRetentionPolicy.SOURCE æˆ– RetentionPolicy.CLASS
å¤„ç†æ–¹å¼ï¼šAPTï¼ˆæ³¨è§£å¤„ç†å™¨ï¼‰ã€ç¼–è¯‘å™¨æ’ä»¶ã€å­—èŠ‚ç å·¥å…·
ä½œç”¨ï¼šç”Ÿæˆä»£ç ã€æ ¡éªŒé€»è¾‘ã€åˆ†æç»“æ„
```

### 5.2 ç¼–è¯‘æ—¶å¤„ç†æµç¨‹


**ğŸ”„ å¤„ç†æµç¨‹å›¾**
```
ç¼–è¯‘è¿‡ç¨‹ï¼š
æºä»£ç (.java) â†’ æ³¨è§£å¤„ç†å™¨æ‰«æ â†’ ç”Ÿæˆ/æ ¡éªŒ/åˆ†æ â†’ ç¼–è¯‘æˆå­—èŠ‚ç (.class)

APTå¤„ç†æ—¶æœºï¼š
ç¼–è¯‘å™¨å¯åŠ¨ â†’ è§£ææºæ–‡ä»¶ â†’ å‘ç°æ³¨è§£ â†’ è°ƒç”¨å¤„ç†å™¨ â†’ ç”Ÿæˆæ–°æ–‡ä»¶ â†’ ç»§ç»­ç¼–è¯‘
```

**ğŸ“Š ç”Ÿå‘½å‘¨æœŸä¸ç¼–è¯‘æ—¶å¯ç”¨æ€§**

| ä¿ç•™ç­–ç•¥ | ç¼–è¯‘æ—¶å¯ç”¨ | è¿è¡Œæ—¶å¯è§ | å…¸å‹ç”¨é€” |
|---------|-----------|-----------|---------|
| **SOURCE** | âœ… | âŒ | ä»£ç ç”Ÿæˆã€ç¼–è¯‘æ£€æŸ¥ |
| **CLASS** | âœ… | âŒ | å­—èŠ‚ç åˆ†æã€å·¥å…·å¤„ç† |
| **RUNTIME** | âš ï¸ï¼ˆéå…¸å‹ï¼‰ | âœ… | æ¡†æ¶è¿è¡Œæ—¶å¤„ç† |

### 5.3 åº”ç”¨åœºæ™¯


**ğŸ› ï¸ ä¸»è¦åº”ç”¨é¢†åŸŸ**

```java
ğŸ”¸ è‡ªåŠ¨ç”Ÿæˆä»£ç 
â€¢ Lombokï¼š@Dataã€@Builder ç­‰ç”Ÿæˆæ–¹æ³•
â€¢ MapStructï¼š@Mapper ç”Ÿæˆå¯¹è±¡æ˜ å°„å™¨
â€¢ Daggerï¼š@Component ç”Ÿæˆä¾èµ–æ³¨å…¥ä»£ç 

ğŸ”¸ é™æ€åˆ†æä¸æ ¡éªŒ
â€¢ ç¼–è¯‘æœŸéªŒè¯ç±»ç»“æ„ã€å±æ€§ã€æ–¹æ³•åˆæ³•æ€§
â€¢ è‡ªå®šä¹‰ç¼–è¯‘è§„åˆ™æ£€æŸ¥
â€¢ ä»£ç è´¨é‡åˆ†æ

ğŸ”¸ é…ç½®æ–‡ä»¶ç”Ÿæˆ
â€¢ SPI æ–‡ä»¶ç”Ÿæˆï¼ˆMETA-INF/servicesï¼‰
â€¢ å…ƒæ•°æ®æ–‡ä»¶ç”Ÿæˆ
â€¢ æ¡†æ¶é…ç½®æ–‡ä»¶è‡ªåŠ¨åˆ›å»º

ğŸ”¸ IDE å’Œå·¥å…·æ”¯æŒ
â€¢ æ™ºèƒ½æç¤ºå’Œè‡ªåŠ¨è¡¥å…¨
â€¢ é”™è¯¯æ£€æŸ¥å’Œè¯­æ³•é«˜äº®
â€¢ é‡æ„å’Œå¯¼èˆªæ”¯æŒ
```

### 5.4 å¸¸è§ç¼–è¯‘æ—¶æ³¨è§£æ¡†æ¶


**ğŸ“¦ ä¸»æµæ¡†æ¶å¯¹æ¯”**

| æ¡†æ¶ | ä¸»è¦æ³¨è§£ | ç”Ÿæˆå†…å®¹ | å¤„ç†æ—¶æœº |
|------|---------|---------|---------|
| **Lombok** | `@Data`, `@Builder`, `@Getter` | Javaæ–¹æ³•å’Œæ„é€ å™¨ | ç¼–è¯‘æœŸæ’ä»¶ |
| **MapStruct** | `@Mapper`, `@Mapping` | å¯¹è±¡æ˜ å°„å®ç°ç±» | APTå¤„ç†å™¨ |
| **Dagger** | `@Component`, `@Module` | ä¾èµ–æ³¨å…¥å·¥å‚ | APTå¤„ç†å™¨ |
| **AutoService** | `@AutoService` | SPIé…ç½®æ–‡ä»¶ | APTå¤„ç†å™¨ |
| **JAXB** | `@XmlElement`, `@XmlRoot` | XMLç»‘å®šä»£ç  | ç¼–è¯‘æ—¶å·¥å…· |

### 5.5 Lombokç¤ºä¾‹


```java
// ç¼–è¯‘å‰æºç 
@Data
@Builder
@AllArgsConstructor
@NoArgsConstructor
public class User {
    private String name;
    private Integer age;
    private String email;
}

// ç¼–è¯‘åç­‰æ•ˆä»£ç ï¼ˆç®€åŒ–ï¼‰
public class User {
    private String name;
    private Integer age;
    private String email;
    
    // @Data ç”Ÿæˆçš„æ–¹æ³•
    public String getName() { return name; }
    public void setName(String name) { this.name = name; }
    public Integer getAge() { return age; }
    public void setAge(Integer age) { this.age = age; }
    // ... å…¶ä»–getter/setter
    
    // @Builder ç”Ÿæˆçš„æ„å»ºå™¨
    public static UserBuilder builder() {
        return new UserBuilder();
    }
    
    public static class UserBuilder {
        // æ„å»ºå™¨å®ç°
    }
    
    // @AllArgsConstructor å’Œ @NoArgsConstructor ç”Ÿæˆçš„æ„é€ å™¨
    public User() {}
    public User(String name, Integer age, String email) {
        this.name = name;
        this.age = age;
        this.email = email;
    }
}
```

### 5.6 MapStructç¤ºä¾‹


```java
// å®šä¹‰æ˜ å°„æ¥å£
@Mapper
public interface UserMapper {
    UserMapper INSTANCE = Mappers.getMapper(UserMapper.class);
    
    @Mapping(source = "fullName", target = "name")
    @Mapping(source = "userAge", target = "age")
    UserDTO userToDto(User user);
}

// APTç”Ÿæˆçš„å®ç°ç±»
@Generated(
    value = "org.mapstruct.ap.MappingProcessor",
    date = "2025-01-20T10:15:30+0800"
)
public class UserMapperImpl implements UserMapper {
    
    @Override
    public UserDTO userToDto(User user) {
        if (user == null) {
            return null;
        }
        
        UserDTO userDTO = new UserDTO();
        userDTO.setName(user.getFullName());
        userDTO.setAge(user.getUserAge());
        
        return userDTO;
    }
}
```

### 5.7 è‡ªå®šä¹‰APTå¤„ç†å™¨


```java
// è‡ªå®šä¹‰æ³¨è§£
@Retention(RetentionPolicy.SOURCE)
@Target(ElementType.TYPE)
public @interface GenerateRepository {
    String tableName();
}

// ç®€åŒ–çš„APTå¤„ç†å™¨
@SupportedAnnotationTypes("com.example.GenerateRepository")
@SupportedSourceVersion(SourceVersion.RELEASE_8)
public class RepositoryProcessor extends AbstractProcessor {
    
    @Override
    public boolean process(Set<? extends TypeElement> annotations, 
                          RoundEnvironment roundEnv) {
        
        for (Element element : roundEnv.getElementsAnnotatedWith(GenerateRepository.class)) {
            GenerateRepository annotation = element.getAnnotation(GenerateRepository.class);
            String tableName = annotation.tableName();
            
            // ç”ŸæˆRepositoryç±»ä»£ç 
            generateRepositoryClass(element, tableName);
        }
        
        return true;
    }
    
    private void generateRepositoryClass(Element element, String tableName) {
        // ä»£ç ç”Ÿæˆé€»è¾‘
        String className = element.getSimpleName() + "Repository";
        // ä½¿ç”¨ JavaPoet æˆ–å­—ç¬¦ä¸²æ‹¼æ¥ç”ŸæˆJavaæºç 
    }
}
```

### 5.8 ç¼–è¯‘æ—¶æ³¨è§£æœ€ä½³å®è·µ


**ğŸ’¡ å¼€å‘å»ºè®®**

| åœºæ™¯ | å»ºè®® | ç†ç”± |
|------|------|------|
| **å¤§é‡æ ·æ¿ä»£ç ** | ä½¿ç”¨Lombokç­‰å·¥å…· | å‡å°‘é‡å¤ä»£ç ï¼Œæé«˜å¼€å‘æ•ˆç‡ |
| **å¯¹è±¡æ˜ å°„** | ä½¿ç”¨MapStruct | ç¼–è¯‘æ—¶ç”Ÿæˆï¼Œæ€§èƒ½å¥½äºåå°„ |
| **ä¾èµ–æ³¨å…¥** | è€ƒè™‘Dagger | ç¼–è¯‘æ—¶æ£€æŸ¥ï¼Œè¿è¡Œæ—¶æ€§èƒ½é«˜ |
| **é…ç½®ç®¡ç†** | ä½¿ç”¨APTç”Ÿæˆé…ç½®ç±» | ç±»å‹å®‰å…¨ï¼Œç¼–è¯‘æ—¶éªŒè¯ |

**âš ï¸ æ³¨æ„äº‹é¡¹**

- **IDEé…ç½®**ï¼šç¡®ä¿å¼€å¯æ³¨è§£å¤„ç†å™¨æ”¯æŒ
- **æ„å»ºé…ç½®**ï¼šæ­£ç¡®é…ç½®APTä¾èµ–å’Œå¤„ç†å™¨
- **è°ƒè¯•å›°éš¾**ï¼šç”Ÿæˆçš„ä»£ç å¯èƒ½éš¾ä»¥è°ƒè¯•
- **æ„å»ºæ€§èƒ½**ï¼šå¤§é‡æ³¨è§£å¤„ç†å¯èƒ½å½±å“ç¼–è¯‘é€Ÿåº¦
- **ä¾èµ–ç®¡ç†**ï¼šæ³¨æ„å¤„ç†å™¨ä¸è¿è¡Œæ—¶ä¾èµ–çš„åˆ†ç¦»

---

## 6. ğŸš€ è¿è¡Œæ—¶æ³¨è§£


### 6.1 åŸºæœ¬æ¦‚å¿µ


**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
è¿è¡Œæ—¶æ³¨è§£ï¼šç”Ÿå‘½å‘¨æœŸä¸ºRetentionPolicy.RUNTIMEçš„æ³¨è§£
ç‰¹ç‚¹ï¼šä¿ç•™åœ¨å­—èŠ‚ç ä¸­ï¼Œè¿è¡Œæ—¶å¯é€šè¿‡åå°„è®¿é—®
ç”¨é€”ï¼šæ¡†æ¶å¼€å‘ã€ä¾èµ–æ³¨å…¥ã€AOPã€ORMã€éªŒè¯å¤„ç†
è®¿é—®æ–¹å¼ï¼šjava.lang.reflectåŒ…çš„åå°„API
```

### 6.2 ç”Ÿå‘½å‘¨æœŸç‰¹å¾


**ğŸ“Š è¿è¡Œæ—¶æ³¨è§£å®Œæ•´ç”Ÿå‘½å‘¨æœŸ**

| é˜¶æ®µ | çŠ¶æ€ | å¯è®¿é—®æ€§ | è¯´æ˜ |
|------|------|---------|------|
| **ç¼–è¯‘æœŸ** | æºç ä¸­å­˜åœ¨ | APTå¯å¤„ç† | å¯ç”¨äºä»£ç ç”Ÿæˆ |
| **å­—èŠ‚ç ** | .classä¸­ä¿ç•™ | å·¥å…·å¯è¯»å– | å­—èŠ‚ç å¢å¼ºå¯å¤„ç† |
| **ç±»åŠ è½½** | JVMåŠ è½½ | åå°„å¯è®¿é—® | è¿›å…¥è¿è¡Œæ—¶ç¯å¢ƒ |
| **è¿è¡Œæ—¶** | å†…å­˜ä¸­å­˜åœ¨ | âœ… å®Œå…¨å¯ç”¨ | æ¡†æ¶åŠ¨æ€å¤„ç† |

### 6.3 åå°„è®¿é—®API


**ğŸ” å¸¸ç”¨åå°„æ–¹æ³•**

```java
// ç±»çº§åˆ«æ³¨è§£è®¿é—®
Class<?> clazz = MyClass.class;

// æ£€æŸ¥æ³¨è§£æ˜¯å¦å­˜åœ¨
boolean hasAnnotation = clazz.isAnnotationPresent(MyAnnotation.class);

// è·å–å•ä¸ªæ³¨è§£
MyAnnotation annotation = clazz.getAnnotation(MyAnnotation.class);

// è·å–æ‰€æœ‰æ³¨è§£
Annotation[] annotations = clazz.getAnnotations();

// è·å–å£°æ˜çš„æ³¨è§£ï¼ˆä¸åŒ…æ‹¬ç»§æ‰¿çš„ï¼‰
Annotation[] declaredAnnotations = clazz.getDeclaredAnnotations();
```

**ğŸ“‹ ä¸åŒå…ƒç´ çš„æ³¨è§£è®¿é—®**

| å…ƒç´ ç±»å‹ | è·å–æ–¹å¼ | ç¤ºä¾‹ |
|---------|---------|------|
| **ç±»** | `Class.getAnnotation()` | `User.class.getAnnotation(Entity.class)` |
| **æ–¹æ³•** | `Method.getAnnotation()` | `method.getAnnotation(Transactional.class)` |
| **å­—æ®µ** | `Field.getAnnotation()` | `field.getAnnotation(Autowired.class)` |
| **å‚æ•°** | `Parameter.getAnnotation()` | `param.getAnnotation(Valid.class)` |

### 6.4 å¸¸è§è¿è¡Œæ—¶æ³¨è§£


**ğŸ“¦ ä¸»æµæ¡†æ¶è¿è¡Œæ—¶æ³¨è§£**

| æ¡†æ¶ | æ³¨è§£ç¤ºä¾‹ | ç”¨é€” |
|------|---------|------|
| **Spring** | `@Component`, `@Autowired`, `@Transactional` | IOCã€DIã€AOP |
| **JPA/Hibernate** | `@Entity`, `@Table`, `@Column` | ORMæ˜ å°„ |
| **Spring MVC** | `@Controller`, `@RequestMapping` | Webå±‚æ§åˆ¶ |
| **Jackson** | `@JsonProperty`, `@JsonIgnore` | JSONåºåˆ—åŒ– |
| **JUnit** | `@Test`, `@BeforeEach`, `@AfterEach` | å•å…ƒæµ‹è¯• |
| **Validation** | `@NotNull`, `@Valid`, `@Size` | æ•°æ®éªŒè¯ |

### 6.5 Springæ¡†æ¶ç¤ºä¾‹


```java
// Spring IoC å’Œ DI
@Component
@Service
public class UserService {
    
    @Autowired
    private UserRepository userRepository;
    
    @Transactional
    @Cacheable("users")
    public User getUserById(Long id) {
        return userRepository.findById(id);
    }
    
    @Transactional
    @PreAuthorize("hasRole('ADMIN')")
    public void deleteUser(Long id) {
        userRepository.deleteById(id);
    }
}

// Spring MVC
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    @Autowired
    private UserService userService;
    
    @GetMapping("/{id}")
    public ResponseEntity<User> getUser(@PathVariable Long id) {
        User user = userService.getUserById(id);
        return ResponseEntity.ok(user);
    }
    
    @PostMapping
    public ResponseEntity<User> createUser(@RequestBody @Valid UserDto userDto) {
        // åˆ›å»ºç”¨æˆ·é€»è¾‘
        return ResponseEntity.ok(new User());
    }
}
```

### 6.6 JPA/Hibernateç¤ºä¾‹


```java
@Entity
@Table(name = "users")
@NamedQuery(
    name = "User.findByEmail",
    query = "SELECT u FROM User u WHERE u.email = :email"
)
public class User {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @Column(name = "user_name", nullable = false, length = 50)
    private String name;
    
    @Column(unique = true)
    @Email
    private String email;
    
    @OneToMany(mappedBy = "user", cascade = CascadeType.ALL)
    private List<Order> orders;
    
    @CreationTimestamp
    private LocalDateTime createdAt;
    
    @UpdateTimestamp
    private LocalDateTime updatedAt;
}
```

### 6.7 æ•°æ®éªŒè¯ç¤ºä¾‹


```java
public class UserDto {
    
    @NotNull(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @Size(min = 2, max = 20, message = "ç”¨æˆ·åé•¿åº¦å¿…é¡»åœ¨2-20ä¹‹é—´")
    private String name;
    
    @NotNull(message = "é‚®ç®±ä¸èƒ½ä¸ºç©º")
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String email;
    
    @Min(value = 18, message = "å¹´é¾„ä¸èƒ½å°äº18å²")
    @Max(value = 100, message = "å¹´é¾„ä¸èƒ½å¤§äº100å²")
    private Integer age;
    
    @Pattern(regexp = "^1[3-9]\\d{9}$", message = "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®")
    private String phone;
}

// æ§åˆ¶å™¨ä¸­ä½¿ç”¨éªŒè¯
@PostMapping("/users")
public ResponseEntity<String> createUser(@RequestBody @Valid UserDto userDto) {
    // @Valid è§¦å‘æ³¨è§£éªŒè¯
    // éªŒè¯å¤±è´¥ä¼šæŠ›å‡º MethodArgumentNotValidException
    return ResponseEntity.ok("ç”¨æˆ·åˆ›å»ºæˆåŠŸ");
}
```

### 6.8 è‡ªå®šä¹‰è¿è¡Œæ—¶æ³¨è§£


```java
// è‡ªå®šä¹‰æƒé™æ³¨è§£
@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
@Documented
public @interface RequiresPermission {
    String[] value();
    LogicalOperator operator() default LogicalOperator.AND;
}

enum LogicalOperator {
    AND, OR
}

// ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£
@Service
public class DocumentService {
    
    @RequiresPermission({"DOCUMENT_READ", "DOCUMENT_WRITE"})
    public void updateDocument(Document doc) {
        // æ›´æ–°æ–‡æ¡£
    }
    
    @RequiresPermission(value = {"ADMIN", "SUPER_USER"}, operator = LogicalOperator.OR)
    public void deleteDocument(Long id) {
        // åˆ é™¤æ–‡æ¡£
    }
}

// AOPåˆ‡é¢å¤„ç†æƒé™
@Aspect
@Component
public class PermissionAspect {
    
    @Around("@annotation(requiresPermission)")
    public Object checkPermission(ProceedingJoinPoint joinPoint, 
                                 RequiresPermission requiresPermission) throws Throwable {
        
        String[] permissions = requiresPermission.value();
        LogicalOperator operator = requiresPermission.operator();
        
        // è·å–å½“å‰ç”¨æˆ·æƒé™
        Set<String> userPermissions = getCurrentUserPermissions();
        
        // æƒé™æ£€æŸ¥é€»è¾‘
        boolean hasPermission = checkUserPermissions(userPermissions, permissions, operator);
        
        if (!hasPermission) {
            throw new AccessDeniedException("æƒé™ä¸è¶³");
        }
        
        return joinPoint.proceed();
    }
    
    private boolean checkUserPermissions(Set<String> userPermissions, 
                                       String[] requiredPermissions, 
                                       LogicalOperator operator) {
        if (operator == LogicalOperator.AND) {
            return Arrays.stream(requiredPermissions)
                        .allMatch(userPermissions::contains);
        } else {
            return Arrays.stream(requiredPermissions)
                        .anyMatch(userPermissions::contains);
        }
    }
}
```

### 6.9 è¿è¡Œæ—¶æ³¨è§£å¤„ç†å·¥å…·ç±»


```java
public class AnnotationUtils {
    
    /**
     * è·å–ç±»åŠå…¶çˆ¶ç±»ä¸Šçš„æŒ‡å®šæ³¨è§£
     */
    public static <T extends Annotation> T findAnnotation(Class<?> clazz, Class<T> annotationType) {
        T annotation = clazz.getAnnotation(annotationType);
        if (annotation != null) {
            return annotation;
        }
        
        // é€’å½’æŸ¥æ‰¾çˆ¶ç±»
        Class<?> superclass = clazz.getSuperclass();
        if (superclass != null && superclass != Object.class) {
            return findAnnotation(superclass, annotationType);
        }
        
        return null;
    }
    
    /**
     * è·å–æ–¹æ³•ä¸Šçš„æ³¨è§£ï¼ŒåŒ…æ‹¬æ¥å£æ–¹æ³•
     */
    public static <T extends Annotation> T findMethodAnnotation(Method method, Class<T> annotationType) {
        T annotation = method.getAnnotation(annotationType);
        if (annotation != null) {
            return annotation;
        }
        
        // æŸ¥æ‰¾æ¥å£æ–¹æ³•ä¸Šçš„æ³¨è§£
        Class<?> declaringClass = method.getDeclaringClass();
        for (Class<?> iface : declaringClass.getInterfaces()) {
            try {
                Method ifaceMethod = iface.getMethod(method.getName(), method.getParameterTypes());
                annotation = ifaceMethod.getAnnotation(annotationType);
                if (annotation != null) {
                    return annotation;
                }
            } catch (NoSuchMethodException e) {
                // æ¥å£ä¸­æ²¡æœ‰å¯¹åº”æ–¹æ³•ï¼Œç»§ç»­æŸ¥æ‰¾
            }
        }
        
        return null;
    }
    
    /**
     * æ‰«æåŒ…ä¸‹æ‰€æœ‰å¸¦æŒ‡å®šæ³¨è§£çš„ç±»
     */
    public static Set<Class<?>> scanClassesWithAnnotation(String packageName, 
                                                         Class<? extends Annotation> annotationType) {
        Set<Class<?>> classes = new HashSet<>();
        
        // ä½¿ç”¨ Reflections åº“æˆ–è‡ªå®šä¹‰å®ç°
        // è¿™é‡Œæ˜¯ç®€åŒ–ç¤ºä¾‹
        try {
            ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
            String path = packageName.replace('.', '/');
            Enumeration<URL> resources = classLoader.getResources(path);
            
            while (resources.hasMoreElements()) {
                URL resource = resources.nextElement();
                File directory = new File(resource.getFile());
                
                if (directory.exists()) {
                    scanDirectory(directory, packageName, annotationType, classes);
                }
            }
        } catch (Exception e) {
            throw new RuntimeException("åŒ…æ‰«æå¤±è´¥", e);
        }
        
        return classes;
    }
    
    private static void scanDirectory(File directory, String packageName, 
                                    Class<? extends Annotation> annotationType, 
                                    Set<Class<?>> classes) {
        File[] files = directory.listFiles();
        if (files != null) {
            for (File file : files) {
                if (file.isDirectory()) {
                    scanDirectory(file, packageName + "." + file.getName(), annotationType, classes);
                } else if (file.getName().endsWith(".class")) {
                    try {
                        String className = packageName + "." + file.getName().substring(0, file.getName().length() - 6);
                        Class<?> clazz = Class.forName(className);
                        
                        if (clazz.isAnnotationPresent(annotationType)) {
                            classes.add(clazz);
                        }
                    } catch (ClassNotFoundException e) {
                        // å¿½ç•¥æ— æ³•åŠ è½½çš„ç±»
                    }
                }
            }
        }
    }
}
```

### 6.10 æ€§èƒ½è€ƒè™‘


**ğŸ“Š æ€§èƒ½å½±å“åˆ†æ**

| æ“ä½œ | æ€§èƒ½å¼€é”€ | ä¼˜åŒ–å»ºè®® |
|------|---------|---------|
| **åå°„è·å–æ³¨è§£** | ä¸­ç­‰ | ä½¿ç”¨ç¼“å­˜å‡å°‘é‡å¤è®¿é—® |
| **æ³¨è§£å€¼è¯»å–** | ä½ | ç›´æ¥è°ƒç”¨æ³¨è§£æ–¹æ³• |
| **åŒ…æ‰«æ** | é«˜ | å¯åŠ¨æ—¶ä¸€æ¬¡æ€§æ‰«æå¹¶ç¼“å­˜ |
| **AOPæ‹¦æˆª** | ä¸­ç­‰ | åˆç†è®¾è®¡åˆ‡ç‚¹è¡¨è¾¾å¼ |

**ğŸ’¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®**

```java
// æ³¨è§£ä¿¡æ¯ç¼“å­˜
public class AnnotationCache {
    private static final Map<Class<?>, Map<Class<? extends Annotation>, Annotation>> CACHE = 
        new ConcurrentHashMap<>();
    
    @SuppressWarnings("unchecked")
    public static <T extends Annotation> T getAnnotation(Class<?> clazz, Class<T> annotationType) {
        return (T) CACHE.computeIfAbsent(clazz, k -> new ConcurrentHashMap<>())
                       .computeIfAbsent(annotationType, k -> clazz.getAnnotation(annotationType));
    }
}

// å¯åŠ¨æ—¶é¢„çƒ­
@Component
public class AnnotationPreloader implements ApplicationListener<ContextRefreshedEvent> {
    
    @Override
    public void onApplicationEvent(ContextRefreshedEvent event) {
        // é¢„åŠ è½½å¸¸ç”¨æ³¨è§£ä¿¡æ¯
        ApplicationContext context = event.getApplicationContext();
        String[] beanNames = context.getBeanDefinitionNames();
        
        for (String beanName : beanNames) {
            Class<?> beanClass = context.getType(beanName);
            if (beanClass != null) {
                // é¢„åŠ è½½æ³¨è§£åˆ°ç¼“å­˜
                cacheClassAnnotations(beanClass);
            }
        }
    }
    
    private void cacheClassAnnotations(Class<?> clazz) {
        // ç¼“å­˜ç±»æ³¨è§£
        AnnotationCache.getAnnotation(clazz, Component.class);
        AnnotationCache.getAnnotation(clazz, Service.class);
        // ... å…¶ä»–å¸¸ç”¨æ³¨è§£
    }
}
```

---

## 7. ğŸ¯ å•å€¼/å¤šå±æ€§æ³¨è§£


### 7.1 åŸºæœ¬æ¦‚å¿µ


**ğŸ“‹ æ³¨è§£åˆ†ç±»å®šä¹‰**

| ç±»å‹ | å®šä¹‰ | ç‰¹ç‚¹ | ä½¿ç”¨æ–¹å¼ |
|------|------|------|---------|
| **å•å€¼æ³¨è§£** | åªæœ‰ä¸€ä¸ªå±æ€§ï¼ˆé€šå¸¸åä¸ºvalueï¼‰ | å¯çœç•¥å±æ€§å | `@Anno("xxx")` |
| **å¤šå±æ€§æ³¨è§£** | åŒ…å«å¤šä¸ªå±æ€§ | å¿…é¡»æŒ‡å®šå±æ€§å | `@Anno(name="x", age=1)` |

### 7.2 å•å€¼æ³¨è§£è¯¦è§£


#### 7.2.1 å®šä¹‰è§„åˆ™


```java
// å•å€¼æ³¨è§£å®šä¹‰
@interface SimpleAnnotation {
    String value();  // å±æ€§åå¿…é¡»æ˜¯ value
}

// å¯é€‰é»˜è®¤å€¼
@interface SimpleWithDefault {
    String value() default "é»˜è®¤å€¼";
}
```

#### 7.2.2 ä½¿ç”¨è¯­æ³•


```java
// ç®€å†™å½¢å¼ï¼ˆæ¨èï¼‰
@SimpleAnnotation("hello")
public class Demo1 {}

// å®Œæ•´å½¢å¼
@SimpleAnnotation(value = "hello")
public class Demo2 {}

// ä½¿ç”¨é»˜è®¤å€¼
@SimpleWithDefault
public class Demo3 {}  // ç­‰åŒäº @SimpleWithDefault("é»˜è®¤å€¼")
```

#### 7.2.3 å¸¸è§å•å€¼æ³¨è§£ç¤ºä¾‹


```java
// Spring æ³¨è§£
@Component("userService")
@RequestMapping("/api")
@Value("${app.name}")

// JPA æ³¨è§£
@Table("users")
@Column("user_name")

// éªŒè¯æ³¨è§£
@NotNull("ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
@Size(min = 2, max = 50, message = "é•¿åº¦åœ¨2-50ä¹‹é—´")
```

### 7.3 å¤šå±æ€§æ³¨è§£è¯¦è§£


#### 7.3.1 å®šä¹‰è§„åˆ™


```java
// å¤šå±æ€§æ³¨è§£å®šä¹‰
@interface ComplexAnnotation {
    String name();
    int age();
    String[] tags() default {};
    boolean enabled() default true;
}
```

#### 7.3.2 ä½¿ç”¨è¯­æ³•


```java
// å¿…é¡»æŒ‡å®šæ‰€æœ‰éé»˜è®¤å€¼å±æ€§
@ComplexAnnotation(name = "å¼ ä¸‰", age = 25)
public class Demo1 {}

// å¯ä»¥è¦†ç›–é»˜è®¤å€¼
@ComplexAnnotation(
    name = "æå››", 
    age = 30, 
    tags = {"admin", "user"}, 
    enabled = false
)
public class Demo2 {}
```

#### 7.3.3 å¸¸è§å¤šå±æ€§æ³¨è§£ç¤ºä¾‹


```java
// Spring MVC
@RequestMapping(
    value = "/users", 
    method = RequestMethod.GET,
    produces = "application/json"
)

// JPA
@JoinColumn(
    name = "user_id",
    referencedColumnName = "id",
    nullable = false
)

// éªŒè¯
@Pattern(
    regexp = "^1[3-9]\\d{9}$",
    message = "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®"
)

// ç¼“å­˜
@Cacheable(
    value = "users",
    key = "#id",
    condition = "#id > 0"
)
```

### 7.4 å±æ€§ç±»å‹æ”¯æŒ


**ğŸ“Š æ³¨è§£å±æ€§æ”¯æŒçš„æ•°æ®ç±»å‹**

| ç±»å‹ | æ˜¯å¦æ”¯æŒ | ç¤ºä¾‹ |
|------|---------|------|
| **åŸºæœ¬ç±»å‹** | âœ… | `int`, `boolean`, `char`, `double` |
| **åŸºæœ¬ç±»å‹æ•°ç»„** | âœ… | `int[]`, `boolean[]` |
| **String** | âœ… | `String value()` |
| **Stringæ•°ç»„** | âœ… | `String[] tags()` |
| **æšä¸¾ç±»å‹** | âœ… | `ElementType target()` |
| **æšä¸¾æ•°ç»„** | âœ… | `ElementType[] targets()` |
| **Classç±»å‹** | âœ… | `Class<?> type()` |
| **Classæ•°ç»„** | âœ… | `Class<?>[] types()` |
| **æ³¨è§£ç±»å‹** | âœ… | `MyAnnotation nested()` |
| **æ³¨è§£æ•°ç»„** | âœ… | `MyAnnotation[] nested()` |
| **å…¶ä»–å¯¹è±¡** | âŒ | `List`, `Map`, è‡ªå®šä¹‰å¯¹è±¡ç­‰ |

### 7.5 å¤æ‚å±æ€§ç¤ºä¾‹


```java
// æšä¸¾ç±»å‹å±æ€§
@interface ConfigAnnotation {
    EnvironmentType env() default EnvironmentType.DEV;
    EnvironmentType[] supportedEnvs() default {EnvironmentType.DEV, EnvironmentType.TEST};
}

enum EnvironmentType {
    DEV, TEST, PROD
}

// Classç±»å‹å±æ€§
@interface ServiceAnnotation {
    Class<?> serviceClass();
    Class<?>[] interfaces() default {};
}

// åµŒå¥—æ³¨è§£å±æ€§
@interface ValidatedField {
    NotNull notNull() default @NotNull;
    Size size() default @Size(min = 1, max = 100);
}

@interface NotNull {
    String message() default "ä¸èƒ½ä¸ºç©º";
}

@interface Size {
    int min() default 0;
    int max() default Integer.MAX_VALUE;
    String message() default "é•¿åº¦è¶…å‡ºèŒƒå›´";
}
```

### 7.6 æ•°ç»„å±æ€§çš„ç‰¹æ®Šè¯­æ³•


```java
@interface TagsAnnotation {
    String[] value();
}

// å•ä¸ªå€¼å¯ä»¥çœç•¥å¤§æ‹¬å·
@TagsAnnotation("single")  // ç­‰åŒäº @TagsAnnotation({"single"})

// å¤šä¸ªå€¼å¿…é¡»ä½¿ç”¨å¤§æ‹¬å·
@TagsAnnotation({"tag1", "tag2", "tag3"})

// ç©ºæ•°ç»„
@TagsAnnotation({})  // æˆ–è€…å®šä¹‰é»˜è®¤å€¼é¿å…è¿™ç§æƒ…å†µ
```

### 7.7 æ··åˆä½¿ç”¨ï¼šæ—¢æœ‰valueåˆæœ‰å…¶ä»–å±æ€§


```java
@interface MixedAnnotation {
    String value();  // ä¸»è¦å€¼
    int priority() default 0;
    boolean enabled() default true;
}

// ä½¿ç”¨æ—¶çš„ä¸åŒæ–¹å¼
@MixedAnnotation("ä¸»è¦é…ç½®")  // åªè®¾ç½®valueï¼Œå…¶ä»–ä½¿ç”¨é»˜è®¤å€¼

@MixedAnnotation(value = "ä¸»è¦é…ç½®", priority = 1)  // è®¾ç½®valueå’Œå…¶ä»–å±æ€§

@MixedAnnotation(priority = 1, value = "ä¸»è¦é…ç½®")  // å±æ€§é¡ºåºæ— å…³

// âŒ é”™è¯¯ï¼šä¸èƒ½åŒæ—¶ä½¿ç”¨ç®€å†™å’Œå…¶ä»–å±æ€§
// @MixedAnnotation("ä¸»è¦é…ç½®", priority = 1)  // ç¼–è¯‘é”™è¯¯
```

### 7.8 å®é™…åº”ç”¨åœºæ™¯å¯¹æ¯”


**ğŸ“Š å•å€¼ vs å¤šå±æ€§é€‰æ‹©æŒ‡å¯¼**

| åœºæ™¯ | æ¨èç±»å‹ | ç¤ºä¾‹ | ç†ç”± |
|------|---------|------|------|
| **ç®€å•æ ‡è®°** | å•å€¼æ³¨è§£ | `@Component("userService")` | è¯­æ³•ç®€æ´ï¼Œæ˜“äºä½¿ç”¨ |
| **å¤æ‚é…ç½®** | å¤šå±æ€§æ³¨è§£ | `@RequestMapping(value="/api", method=GET)` | é…ç½®é¡¹å¤šï¼Œéœ€è¦æ¸…æ™°è¡¨è¾¾ |
| **å¯æ‰©å±•æ€§å¼º** | å¤šå±æ€§æ³¨è§£ | `@Cacheable(value="cache", key="#id")` | æœªæ¥å¯èƒ½éœ€è¦æ›´å¤šé…ç½® |
| **é»˜è®¤å€¼å¤š** | å¤šå±æ€§æ³¨è§£ | `@Transactional(readOnly=false, timeout=30)` | æä¾›åˆç†é»˜è®¤å€¼ï¼ŒæŒ‰éœ€è¦†ç›– |

### 7.9 æœ€ä½³å®è·µ


**ğŸ’¡ è®¾è®¡å»ºè®®**

```java
// âœ… å¥½çš„è®¾è®¡ï¼šä¸»è¦ç”¨é€”ç”¨valueï¼Œæ¬¡è¦é…ç½®ç”¨å…·åå±æ€§
@interface ApiOperation {
    String value();                    // ä¸»è¦æè¿°
    String notes() default "";         // è¯¦ç»†è¯´æ˜
    int httpStatus() default 200;      // HTTPçŠ¶æ€ç 
    boolean hidden() default false;    // æ˜¯å¦éšè—
}

// âœ… å¥½çš„è®¾è®¡ï¼šæä¾›åˆç†çš„é»˜è®¤å€¼
@interface CacheConfig {
    String value();                           // ç¼“å­˜åç§°
    int expireSeconds() default 3600;         // é»˜è®¤1å°æ—¶è¿‡æœŸ
    boolean allowNullValues() default true;   // å…è®¸ç©ºå€¼
}

// âŒ ä¸å¥½çš„è®¾è®¡ï¼šå¼ºåˆ¶æŒ‡å®šå¤ªå¤šå±æ€§
@interface BadDesign {
    String name();           // æ²¡æœ‰é»˜è®¤å€¼
    String description();    // æ²¡æœ‰é»˜è®¤å€¼
    int version();          // æ²¡æœ‰é»˜è®¤å€¼
    boolean enabled();      // æ²¡æœ‰é»˜è®¤å€¼
    // ä½¿ç”¨æ—¶å¿…é¡»æŒ‡å®šæ‰€æœ‰å±æ€§ï¼Œå¾ˆç¹ç
}
```

**ğŸ“‹ å‘½åè§„èŒƒ**

| å±æ€§å | å«ä¹‰ | é€‚ç”¨åœºæ™¯ |
|-------|------|---------|
| `value` | ä¸»è¦å€¼ã€é»˜è®¤å€¼ | å•å€¼æ³¨è§£æˆ–æœ€é‡è¦çš„é…ç½® |
| `name` | åç§°æ ‡è¯† | éœ€è¦æŒ‡å®šåç§°çš„åœºæ™¯ |
| `message` | æ¶ˆæ¯ã€æè¿° | é”™è¯¯æç¤ºã€æ—¥å¿—ä¿¡æ¯ |
| `enabled` | æ˜¯å¦å¯ç”¨ | å¼€å…³æ§åˆ¶ |
| `timeout` | è¶…æ—¶æ—¶é—´ | æ—¶é—´ç›¸å…³é…ç½® |

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 æ³¨è§£åˆ†ç±»ä½“ç³»æ€»è§ˆ


**ğŸ¯ æŒ‰åŠŸèƒ½ç»´åº¦åˆ†ç±»**

```
æ³¨è§£åˆ†ç±»ä½“ç³»ï¼š
â”œâ”€â”€ å…ƒæ³¨è§£ï¼ˆ5ä¸ªï¼‰
â”‚   â”œâ”€â”€ @Retention    â†’ æ§åˆ¶ç”Ÿå‘½å‘¨æœŸ
â”‚   â”œâ”€â”€ @Target       â†’ é™åˆ¶ä½¿ç”¨ä½ç½®
â”‚   â”œâ”€â”€ @Documented   â†’ æ§åˆ¶æ–‡æ¡£ç”Ÿæˆ
â”‚   â”œâ”€â”€ @Inherited    â†’ æ§åˆ¶ç»§æ‰¿æ€§
â”‚   â””â”€â”€ @Repeatable   â†’ æ”¯æŒé‡å¤ä½¿ç”¨
â”‚
â”œâ”€â”€ å†…ç½®æ³¨è§£ï¼ˆ7ä¸ªï¼‰
â”‚   â”œâ”€â”€ @Override     â†’ é‡å†™æ ‡è®°
â”‚   â”œâ”€â”€ @Deprecated   â†’ åºŸå¼ƒæ ‡è®°
â”‚   â”œâ”€â”€ @SuppressWarnings â†’ è­¦å‘ŠæŠ‘åˆ¶
â”‚   â”œâ”€â”€ @FunctionalInterface â†’ å‡½æ•°å¼æ¥å£
â”‚   â”œâ”€â”€ @SafeVarargs  â†’ å®‰å…¨å¯å˜å‚æ•°
â”‚   â”œâ”€â”€ @Native       â†’ JNIå¸¸é‡å¯¼å‡º
â”‚   â””â”€â”€ @Generated    â†’ ç”Ÿæˆä»£ç æ ‡è®°
â”‚
â”œâ”€â”€ æŒ‰ç”Ÿå‘½å‘¨æœŸåˆ†ç±»
â”‚   â”œâ”€â”€ æºç æ³¨è§£      â†’ SOURCEçº§åˆ«
â”‚   â”œâ”€â”€ ç¼–è¯‘æ—¶æ³¨è§£    â†’ SOURCE/CLASSçº§åˆ«
â”‚   â””â”€â”€ è¿è¡Œæ—¶æ³¨è§£    â†’ RUNTIMEçº§åˆ«
â”‚
â””â”€â”€ æŒ‰å‚æ•°å½¢å¼åˆ†ç±»
    â”œâ”€â”€ æ ‡è®°æ³¨è§£      â†’ æ— å‚æ•°
    â”œâ”€â”€ å•å€¼æ³¨è§£      â†’ ä¸€ä¸ªvalueå‚æ•°
    â””â”€â”€ å¤šå±æ€§æ³¨è§£    â†’ å¤šä¸ªå…·åå‚æ•°
```

### 8.2 æ³¨è§£ç”Ÿå‘½å‘¨æœŸæŒæ¡è¦ç‚¹


**ğŸ“Š ä¸‰ç§ç”Ÿå‘½å‘¨æœŸå¯¹æ¯”æ€»ç»“**

| ç»´åº¦ | SOURCE | CLASS | RUNTIME |
|------|--------|-------|---------|
| **ä¿ç•™åˆ°ç¼–è¯‘å** | âŒ | âœ… | âœ… |
| **å¯åå°„è®¿é—®** | âŒ | âŒ | âœ… |
| **å…¸å‹ç”¨é€”** | ç¼–è¯‘æ£€æŸ¥ã€ä»£ç ç”Ÿæˆ | å­—èŠ‚ç åˆ†æã€APTå¤„ç† | æ¡†æ¶è¿è¡Œæ—¶å¤„ç† |
| **æ€§èƒ½å½±å“** | æ— ï¼ˆç¼–è¯‘æ—¶å¤„ç†ï¼‰ | ä½ï¼ˆç±»åŠ è½½æ—¶ä¸¢å¼ƒï¼‰ | ä¸­ï¼ˆåå°„è®¿é—®å¼€é”€ï¼‰ |
| **ä»£è¡¨æ³¨è§£** | `@Override`ã€`@SuppressWarnings` | å¤§éƒ¨åˆ†APTæ³¨è§£ | `@Component`ã€`@Entity` |

### 8.3 å…ƒæ³¨è§£åº”ç”¨æŒ‡å—


**ğŸ’¡ å…ƒæ³¨è§£ä½¿ç”¨å†³ç­–è¡¨**

| éœ€æ±‚ | æ¨èå…ƒæ³¨è§£ | é…ç½®å»ºè®® |
|------|----------|---------|
| **ç¼–è¯‘å™¨æç¤º/æ£€æŸ¥** | `@Retention(SOURCE)` | é…åˆIDEå’Œç¼–è¯‘å™¨ |
| **ä»£ç ç”Ÿæˆå·¥å…·** | `@Retention(CLASS)` | APTå¤„ç†å™¨ä½¿ç”¨ |
| **æ¡†æ¶è¿è¡Œæ—¶å¤„ç†** | `@Retention(RUNTIME)` | Springç­‰æ¡†æ¶å¿…éœ€ |
| **é™åˆ¶ä½¿ç”¨ä½ç½®** | `@Target({...})` | æ˜ç¡®é€‚ç”¨èŒƒå›´ï¼Œé¿å…è¯¯ç”¨ |
| **å¯¹å¤–APIæ³¨è§£** | `@Documented` | æé«˜APIæ–‡æ¡£è´¨é‡ |
| **é…ç½®ç»§æ‰¿éœ€æ±‚** | `@Inherited` | çˆ¶ç±»é…ç½®è‡ªåŠ¨ä¼ é€’ |
| **é‡å¤ä½¿ç”¨éœ€æ±‚** | `@Repeatable(Container.class)` | Java 8+è¯­æ³•ç³– |

### 8.4 å®é™…å¼€å‘åº”ç”¨ç­–ç•¥


**ğŸ”§ ä¸åŒåœºæ™¯çš„æ³¨è§£é€‰æ‹©**

```java
ç¼–è¯‘æ—¶æ£€æŸ¥å’Œæç¤ºï¼š
âœ… ä½¿ç”¨å†…ç½®æ³¨è§£ï¼š@Overrideã€@FunctionalInterface
âœ… è‡ªå®šä¹‰SOURCEçº§æ³¨è§£é…åˆAPT

ä»£ç ç”Ÿæˆå’Œç®€åŒ–ï¼š
âœ… Lombokï¼šå‡å°‘æ ·æ¿ä»£ç 
âœ… MapStructï¼šå¯¹è±¡æ˜ å°„
âœ… è‡ªå®šä¹‰APTå¤„ç†å™¨

æ¡†æ¶é›†æˆå¼€å‘ï¼š
âœ… Springï¼š@Componentã€@Autowiredã€@Transactional
âœ… JPAï¼š@Entityã€@Tableã€@Column
âœ… Validationï¼š@NotNullã€@Validã€@Size

æµ‹è¯•å’Œè´¨é‡ä¿è¯ï¼š
âœ… JUnitï¼š@Testã€@BeforeEachã€@AfterEach
âœ… Mockï¼š@Mockã€@Spyã€@InjectMocks
```

### 8.5 æ€§èƒ½å’Œæœ€ä½³å®è·µ


**âš¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®**

| æ€§èƒ½å½±å“ç‚¹ | ä¼˜åŒ–ç­–ç•¥ | å…·ä½“åšæ³• |
|-----------|---------|---------|
| **åå°„å¼€é”€** | ç¼“å­˜æ³¨è§£ä¿¡æ¯ | å¯åŠ¨æ—¶æ‰«æå¹¶ç¼“å­˜ |
| **åŒ…æ‰«æå¼€é”€** | é™åˆ¶æ‰«æèŒƒå›´ | ç²¾ç¡®æŒ‡å®šåŒ…è·¯å¾„ |
| **AOPæ‹¦æˆªå¼€é”€** | ä¼˜åŒ–åˆ‡ç‚¹è¡¨è¾¾å¼ | é¿å…è¿‡å®½çš„åŒ¹é…æ¨¡å¼ |
| **æ³¨è§£å¤„ç†å¼€é”€** | æ‰¹é‡å¤„ç† | å‡å°‘é‡å¤çš„åå°„è°ƒç”¨ |

**ğŸ“‹ ä»£ç è´¨é‡å»ºè®®**

```java
âœ… æ³¨è§£è®¾è®¡åŸåˆ™ï¼š
â€¢ å•ä¸€èŒè´£ï¼šä¸€ä¸ªæ³¨è§£åªè§£å†³ä¸€ä¸ªé—®é¢˜
â€¢ åˆç†é»˜è®¤å€¼ï¼šæä¾›å¸¸ç”¨çš„é»˜è®¤é…ç½®
â€¢ æ¸…æ™°å‘½åï¼šæ³¨è§£å’Œå±æ€§åè¯­ä¹‰æ˜ç¡®
â€¢ æ–‡æ¡£å®Œæ•´ï¼šæä¾›è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜

âœ… ä½¿ç”¨è§„èŒƒï¼š
â€¢ ä¼˜å…ˆä½¿ç”¨æ ‡å‡†æ³¨è§£è€Œéè‡ªå®šä¹‰
â€¢ åˆç†æ§åˆ¶æ³¨è§£çš„ä½œç”¨åŸŸå’Œç”Ÿå‘½å‘¨æœŸ
â€¢ é¿å…è¿‡åº¦ä½¿ç”¨æ³¨è§£å¯¼è‡´ä»£ç éš¾ä»¥ç†è§£
â€¢ ä¿æŒæ³¨è§£é…ç½®çš„ä¸€è‡´æ€§å’Œå¯ç»´æŠ¤æ€§
```

### 8.6 å¸¸è§è¯¯åŒºé¿å…


**âš ï¸ å…¸å‹è¯¯åŒºå’Œè§£å†³æ–¹æ¡ˆ**

| è¯¯åŒº | é—®é¢˜ | æ­£ç¡®åšæ³• |
|------|------|---------|
| **ç”Ÿå‘½å‘¨æœŸæ··æ·†** | ä»¥ä¸ºæ‰€æœ‰æ³¨è§£éƒ½å¯åå°„è®¿é—® | æ˜ç¡®@Retentionç­–ç•¥ |
| **@Targetæ»¥ç”¨** | ä¸é™åˆ¶ä½¿ç”¨ä½ç½®å¯¼è‡´è¯¯ç”¨ | ç²¾ç¡®æŒ‡å®šElementType |
| **é»˜è®¤å€¼ç¼ºå¤±** | å¼ºåˆ¶ç”¨æˆ·é…ç½®æ‰€æœ‰å±æ€§ | æä¾›åˆç†çš„é»˜è®¤å€¼ |
| **æ³¨è§£åµŒå¥—è¿‡æ·±** | æ³¨è§£é…ç½®è¿‡äºå¤æ‚ | ä¿æŒç®€æ´ï¼Œå¿…è¦æ—¶åˆ†è§£ |
| **æ€§èƒ½å¿½è§†** | å¤§é‡ä½¿ç”¨åå°„è€Œä¸ç¼“å­˜ | åˆç†ä½¿ç”¨ç¼“å­˜æœºåˆ¶ |
