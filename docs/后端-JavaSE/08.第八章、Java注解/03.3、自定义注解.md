---
title: 3ã€è‡ªå®šä¹‰æ³¨è§£
---
## ğŸ“š ç›®å½•

1. [è‡ªå®šä¹‰æ³¨è§£åŸºç¡€æ¦‚å¿µ](#1-è‡ªå®šä¹‰æ³¨è§£åŸºç¡€æ¦‚å¿µ)
2. [æ³¨è§£çš„å®šä¹‰æ–¹å¼](#2-æ³¨è§£çš„å®šä¹‰æ–¹å¼)
3. [æ³¨è§£å…ƒç´ è§„åˆ™ä¸é™åˆ¶](#3-æ³¨è§£å…ƒç´ è§„åˆ™ä¸é™åˆ¶)
4. [å…¸å‹ä½¿ç”¨ç¤ºä¾‹](#4-å…¸å‹ä½¿ç”¨ç¤ºä¾‹)
5. [ä½¿ç”¨æ³¨æ„äº‹é¡¹](#5-ä½¿ç”¨æ³¨æ„äº‹é¡¹)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ è‡ªå®šä¹‰æ³¨è§£åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯è‡ªå®šä¹‰æ³¨è§£

**ğŸ”¸ åŸºæœ¬å®šä¹‰**
```
è‡ªå®šä¹‰æ³¨è§£ï¼ˆAnnotationï¼‰æ˜¯ä¸€ç§"ç»“æ„åŒ–å…ƒæ•°æ®"çš„å£°æ˜æ–¹å¼
æœ¬è´¨ä¸Šæ˜¯æ¥å£çš„ç‰¹æ®Šå½¢å¼ï¼Œç”¨äºä¸ºä»£ç å…ƒç´ æ·»åŠ æè¿°ä¿¡æ¯
æ‰€æœ‰æ³¨è§£éšå¼ç»§æ‰¿è‡ª java.lang.annotation.Annotation æ¥å£
```

**ğŸ’¡ æ ¸å¿ƒç‰¹ç‚¹**
- ä½¿ç”¨å…³é”®å­— `@interface` å®šä¹‰
- åªèƒ½åŒ…å«**æ— å‚æ•°ã€æ— æ–¹æ³•ä½“**çš„æŠ½è±¡æ–¹æ³•ç­¾å
- æ¯ä¸ªæ–¹æ³•ä»£è¡¨ä¸€ä¸ª**æ³¨è§£å±æ€§**
- å¯é€šè¿‡ `default` è®¾ç½®é»˜è®¤å€¼

### 1.2 æ³¨è§£çš„æœ¬è´¨ç†è§£

```
å®šä¹‰å±‚é¢ï¼šæ³¨è§£ç±»å‹ = ç‰¹æ®Šçš„æ¥å£ç±»å‹
ç¼–è¯‘å±‚é¢ï¼šæ³¨è§£å®šä¹‰ä¼šç¼–è¯‘æˆ .class å­—èŠ‚ç æ–‡ä»¶  
è¿è¡Œå±‚é¢ï¼šå¯é€šè¿‡åå°„æœºåˆ¶è¯»å–æ³¨è§£ä¿¡æ¯
åº”ç”¨å±‚é¢ï¼šé…åˆå·¥å…·å®ç°ç¼–è¯‘æ£€æŸ¥ã€ä»£ç ç”Ÿæˆã€è¿è¡Œæ—¶æ§åˆ¶
```

### 1.3 ä¸»è¦åº”ç”¨åœºæ™¯

```
ğŸ”¸ ç¼–è¯‘æ£€æŸ¥ï¼š@Overrideã€@Deprecated
ğŸ”¸ ç¼–è¯‘æœŸä»£ç ç”Ÿæˆï¼šAPTã€MapStructã€Lombok
ğŸ”¸ è¿è¡Œæ—¶é€»è¾‘å¢å¼ºï¼šSpringã€MyBatisã€JUnit
ğŸ”¸ é…ç½®ç®¡ç†ï¼š@Configurationã€@Component
```

---

## 2. ğŸ“ æ³¨è§£çš„å®šä¹‰æ–¹å¼


### 2.1 åŸºæœ¬å®šä¹‰è¯­æ³•

```java
// æœ€ç®€å•çš„æ³¨è§£å®šä¹‰
public @interface MyAnnotation {
    String name();
    int age();
}
```

### 2.2 å®Œæ•´å®šä¹‰ç»“æ„

```java
@Target(ElementType.TYPE)           // ä½œç”¨èŒƒå›´
@Retention(RetentionPolicy.RUNTIME) // ç”Ÿå‘½å‘¨æœŸ
@Documented                         // åŒ…å«åœ¨JavaDocä¸­
@Inherited                          // å¯è¢«å­ç±»ç»§æ‰¿
public @interface MyAnnotation {
    String value();                 // valueç‰¹æ®Šå±æ€§
    int count() default 1;          // å¸¦é»˜è®¤å€¼çš„å±æ€§
    Level level() default Level.MEDIUM;  // æšä¸¾ç±»å‹å±æ€§
    String[] tags() default {};     // æ•°ç»„ç±»å‹å±æ€§
}
```

### 2.3 å…³é”®å…ƒæ³¨è§£è¯´æ˜


| å…ƒæ³¨è§£ | **ä½œç”¨** | **å¸¸ç”¨å€¼** |
|--------|---------|-----------|
| `@Target` | `æŒ‡å®šæ³¨è§£çš„ä½¿ç”¨ä½ç½®` | `TYPE(ç±»)ã€METHOD(æ–¹æ³•)ã€FIELD(å­—æ®µ)` |
| `@Retention` | `æŒ‡å®šæ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸ` | `RUNTIME(è¿è¡Œæ—¶)ã€CLASS(ç¼–è¯‘å)ã€SOURCE(æºç )` |
| `@Documented` | `æ˜¯å¦åŒ…å«åœ¨APIæ–‡æ¡£ä¸­` | `æ— å‚æ•°ï¼Œå­˜åœ¨å³ç”Ÿæ•ˆ` |
| `@Inherited` | `æ˜¯å¦å¯è¢«å­ç±»ç»§æ‰¿` | `ä»…å¯¹ç±»çº§åˆ«æ³¨è§£æœ‰æ•ˆ` |

### 2.4 ç‰¹æ®Šå±æ€§ï¼švalueçš„ç®€åŒ–å†™æ³•

```java
// å®šä¹‰åªæœ‰valueå±æ€§çš„æ³¨è§£
public @interface MyTag {
    String value();
}

// ä½¿ç”¨æ—¶å¯ç®€åŒ–å†™æ³•
@MyTag("ç®€åŒ–å†™æ³•")           // çœç•¥å±æ€§å
@MyTag(value = "å®Œæ•´å†™æ³•")   // å®Œæ•´å†™æ³•

// å¤šå±æ€§æƒ…å†µä¸‹ï¼Œåªèƒ½çœç•¥value
@Config(level = Level.HIGH, value = "é…ç½®å")  // å…¶ä»–å±æ€§å¿…é¡»æ˜¾å¼æŒ‡å®š
```

---

## 3. âš™ï¸ æ³¨è§£å…ƒç´ è§„åˆ™ä¸é™åˆ¶


### 3.1 æ”¯æŒçš„æ•°æ®ç±»å‹

```java
public @interface TypeDemo {
    // âœ… åŸºæœ¬æ•°æ®ç±»å‹
    int count();
    boolean enabled();
    char symbol();
    
    // âœ… å­—ç¬¦ä¸²ç±»å‹
    String name();
    
    // âœ… Classç±»å‹
    Class<?> targetClass();
    
    // âœ… æšä¸¾ç±»å‹
    Level priority();
    
    // âœ… æ³¨è§£ç±»å‹ï¼ˆåµŒå¥—æ³¨è§£ï¼‰
    MyTag tag();
    
    // âœ… æ•°ç»„ç±»å‹
    String[] values();
    int[] numbers();
    Class<?>[] classes();
}
```

### 3.2 ä¸æ”¯æŒçš„æ•°æ®ç±»å‹

```java
public @interface InvalidDemo {
    // âŒ å¯¹è±¡ç±»å‹
    // List<String> items();     // ç¼–è¯‘é”™è¯¯
    // Map<String, Object> config();  // ç¼–è¯‘é”™è¯¯
    // Date createTime();        // ç¼–è¯‘é”™è¯¯
    
    // âŒ æ³›å‹ç±»å‹
    // List<String> genericList();  // ç¼–è¯‘é”™è¯¯
    
    // âŒ æŠ›å‡ºå¼‚å¸¸
    // String getValue() throws Exception;  // ç¼–è¯‘é”™è¯¯
}
```

### 3.3 é‡è¦çº¦æŸæ¡ä»¶

```
ğŸ”¸ æ³¨è§£å±æ€§ä¸èƒ½ä¸º null
ğŸ”¸ æ³¨è§£å±æ€§å€¼å¿…é¡»æ˜¯ç¼–è¯‘æœŸå¸¸é‡
ğŸ”¸ ä¸èƒ½åŒ…å«ä»»ä½•é€»è¾‘ä»£ç æˆ–æ–¹æ³•ä½“
ğŸ”¸ é»˜è®¤å€¼å»ºè®®è®¾ç½®ï¼Œé¿å…ä½¿ç”¨æ—¶é—æ¼
```

---

## 4. ğŸ’» å…¸å‹ä½¿ç”¨ç¤ºä¾‹


### 4.1 å®šä¹‰æ—¥å¿—æ³¨è§£

```java
@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface LogExecution {
    String value() default "";
    boolean printTime() default true;
}
```

### 4.2 ä½¿ç”¨æ³¨è§£

```java
public class TaskService {
    
    @LogExecution("æ‰§è¡Œä¸šåŠ¡é€»è¾‘")
    public void process() {
        System.out.println("æ‰§è¡Œæ ¸å¿ƒä¸šåŠ¡...");
    }
    
    @LogExecution(value = "æ¸…ç†èµ„æº", printTime = false)
    public void cleanup() {
        System.out.println("æ¸…ç†ç³»ç»Ÿèµ„æº...");
    }
    
    public void normalMethod() {
        System.out.println("æ™®é€šæ–¹æ³•ï¼Œæ— æ³¨è§£");
    }
}
```

### 4.3 åå°„å¤„ç†æ³¨è§£

```java
public class AnnotationProcessor {
    public static void main(String[] args) throws Exception {
        Class<TaskService> clazz = TaskService.class;
        TaskService service = new TaskService();
        
        for (Method method : clazz.getDeclaredMethods()) {
            if (method.isAnnotationPresent(LogExecution.class)) {
                LogExecution log = method.getAnnotation(LogExecution.class);
                
                System.out.println("ğŸ”” æ‰§è¡Œæ–¹æ³•: " + method.getName());
                System.out.println("ğŸ“ æ—¥å¿—ä¿¡æ¯: " + log.value());
                
                if (log.printTime()) {
                    System.out.println("â° æ‰§è¡Œæ—¶é—´: " + System.currentTimeMillis());
                }
                
                method.invoke(service);
                System.out.println("âœ… æ‰§è¡Œå®Œæˆ\n");
            }
        }
    }
}
```

### 4.4 è¿è¡Œç»“æœ

```
ğŸ”” æ‰§è¡Œæ–¹æ³•: process
ğŸ“ æ—¥å¿—ä¿¡æ¯: æ‰§è¡Œä¸šåŠ¡é€»è¾‘
â° æ‰§è¡Œæ—¶é—´: 1672531200000
æ‰§è¡Œæ ¸å¿ƒä¸šåŠ¡...
âœ… æ‰§è¡Œå®Œæˆ

ğŸ”” æ‰§è¡Œæ–¹æ³•: cleanup
ğŸ“ æ—¥å¿—ä¿¡æ¯: æ¸…ç†èµ„æº
æ¸…ç†ç³»ç»Ÿèµ„æº...
âœ… æ‰§è¡Œå®Œæˆ
```

---

## 5. âš ï¸ ä½¿ç”¨æ³¨æ„äº‹é¡¹


### 5.1 è¯­æ³•ä¸ç¼–è¯‘é™åˆ¶

```java
// âŒ é”™è¯¯ç¤ºä¾‹
public @interface WrongAnnotation {
    // String name();          // ç¼ºå°‘é»˜è®¤å€¼ï¼Œä½¿ç”¨æ—¶å¿…é¡»æŒ‡å®š
    // List<String> getData(); // ä¸æ”¯æŒæ³›å‹é›†åˆç±»å‹
    // Object value = null;    // ä¸èƒ½å®šä¹‰å­—æ®µ
}

// âœ… æ­£ç¡®ç¤ºä¾‹
public @interface CorrectAnnotation {
    String name() default "é»˜è®¤åç§°";  // æä¾›é»˜è®¤å€¼
    String[] tags() default {};      // æ•°ç»„ç±»å‹æ­£ç¡®ä½¿ç”¨
    Level level() default Level.LOW; // æšä¸¾ç±»å‹æ­£ç¡®ä½¿ç”¨
}
```

### 5.2 å±æ€§èµ‹å€¼è§„èŒƒ

```java
@Config(
    name = "ç³»ç»Ÿé…ç½®",              // å­—ç¬¦ä¸²ç”¨å¼•å·
    levels = {Level.HIGH, Level.MEDIUM},  // æ•°ç»„ç”¨å¤§æ‹¬å·
    tags = {"tag1", "tag2"},       // å­—ç¬¦ä¸²æ•°ç»„
    nested = @NestedAnnotation(value = "åµŒå¥—")  // åµŒå¥—æ³¨è§£
)
public class SystemConfig {
    // ç±»å®ç°
}
```

### 5.3 ç”Ÿå‘½å‘¨æœŸé€‰æ‹©æŒ‡å—

```java
// SOURCEï¼šä»…åœ¨æºç é˜¶æ®µï¼Œç¼–è¯‘åä¸¢å¼ƒ
@Retention(RetentionPolicy.SOURCE)
public @interface CompileTimeOnly { }

// CLASSï¼šä¿ç•™åˆ°å­—èŠ‚ç ï¼ŒJVMè¿è¡Œæ—¶ä¸åŠ è½½ï¼ˆé»˜è®¤ï¼‰
@Retention(RetentionPolicy.CLASS)  
public @interface BytecodeLevel { }

// RUNTIMEï¼šè¿è¡Œæ—¶å¯é€šè¿‡åå°„è·å–ï¼ˆæ¨èï¼‰
@Retention(RetentionPolicy.RUNTIME)
public @interface RuntimeAccessible { }
```

> **ğŸ’¡ é‡è¦æç¤º**ï¼šå¦‚æœéœ€è¦åœ¨è¿è¡Œæ—¶é€šè¿‡åå°„è¯»å–æ³¨è§£ï¼ˆå¦‚Springã€JPAç­‰æ¡†æ¶ï¼‰ï¼Œå¿…é¡»ä½¿ç”¨ `@Retention(RetentionPolicy.RUNTIME)`

### 5.4 ä½œç”¨èŒƒå›´ç²¾ç¡®æ§åˆ¶

```java
// å¤šä¸ªç›®æ ‡ç±»å‹ç»„åˆ
@Target({ElementType.TYPE, ElementType.METHOD})
public @interface MultiTarget { }

// å¸¸ç”¨ç›®æ ‡ç±»å‹
ElementType.TYPE        // ç±»ã€æ¥å£ã€æšä¸¾
ElementType.METHOD      // æ–¹æ³•
ElementType.FIELD       // å­—æ®µ
ElementType.PARAMETER   // æ–¹æ³•å‚æ•°
ElementType.CONSTRUCTOR // æ„é€ å™¨
ElementType.LOCAL_VARIABLE  // å±€éƒ¨å˜é‡
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ

```
ğŸ”¸ æ³¨è§£æœ¬è´¨ï¼šç‰¹æ®Šæ¥å£ï¼Œç”¨@interfaceå®šä¹‰
ğŸ”¸ å…ƒæ•°æ®ä½œç”¨ï¼šä¸ºä»£ç å…ƒç´ æ·»åŠ ç»“æ„åŒ–æè¿°ä¿¡æ¯
ğŸ”¸ åå°„è®¿é—®ï¼šé€šè¿‡Class.getAnnotation()ç­‰APIè·å–
ğŸ”¸ ç”Ÿå‘½å‘¨æœŸï¼šSOURCE < CLASS < RUNTIMEä¸‰ä¸ªçº§åˆ«
ğŸ”¸ åº”ç”¨åœºæ™¯ï¼šç¼–è¯‘æ£€æŸ¥ã€ä»£ç ç”Ÿæˆã€è¿è¡Œæ—¶å¢å¼º
```

### 6.2 å…³é”®è¯­æ³•è¦ç‚¹

```java
// æ ‡å‡†å®šä¹‰æ¨¡æ¿
@Target(ElementType.XXX)           // æ˜ç¡®ä½œç”¨èŒƒå›´
@Retention(RetentionPolicy.RUNTIME) // è®¾ç½®ç”Ÿå‘½å‘¨æœŸ
public @interface MyAnnotation {
    String value() default "";      // valueå±æ€§å¯ç®€åŒ–
    å…¶ä»–å±æ€§() default é»˜è®¤å€¼;        // å»ºè®®æä¾›é»˜è®¤å€¼
}
```

### 6.3 æ•°æ®ç±»å‹é™åˆ¶è®°å¿†

| æ”¯æŒç±»å‹ | **ç¤ºä¾‹** | ä¸æ”¯æŒç±»å‹ | **åŸå› ** |
|---------|---------|-----------|---------|
| `åŸºæœ¬ç±»å‹` | `int, boolean` | `å¯¹è±¡ç±»å‹` | `éç¼–è¯‘æœŸå¸¸é‡` |
| `String` | `"å­—ç¬¦ä¸²"` | `æ³›å‹ç±»å‹` | `ç±»å‹æ“¦é™¤é—®é¢˜` |
| `Class` | `String.class` | `é›†åˆç±»å‹` | `éåŸºæœ¬ç±»å‹` |
| `æšä¸¾` | `Level.HIGH` | `nullå€¼` | `æ³¨è§£ä¸å…è®¸null` |
| `æ•°ç»„` | `{1, 2, 3}` | `æ–¹æ³•ä½“` | `æ³¨è§£æ— é€»è¾‘ä»£ç ` |
