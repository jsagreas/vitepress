---
title: 3ã€UDP Socketç¼–ç¨‹
---
## ğŸ“š ç›®å½•

1. [UDPåè®®ç‰¹ç‚¹ä¸åº”ç”¨åœºæ™¯](#1-UDPåè®®ç‰¹ç‚¹ä¸åº”ç”¨åœºæ™¯)
2. [UDPç¼–ç¨‹åŸºç¡€](#2-UDPç¼–ç¨‹åŸºç¡€)
3. [UDPç¼–ç¨‹å®æˆ˜](#3-UDPç¼–ç¨‹å®æˆ˜)
4. [UDPå¹¿æ’­ç¼–ç¨‹](#4-UDPå¹¿æ’­ç¼–ç¨‹)
5. [UDP vs TCPå¯¹æ¯”](#5-UDP-vs-TCPå¯¹æ¯”)
6. [UDPæ³¨æ„äº‹é¡¹](#6-UDPæ³¨æ„äº‹é¡¹)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ UDPåè®®ç‰¹ç‚¹ä¸åº”ç”¨åœºæ™¯


### 1.1 UDPæ˜¯ä»€ä¹ˆ


**ğŸ”¸ ç”Ÿæ´»åŒ–ç†è§£**
```
UDPå°±åƒå‘çŸ­ä¿¡ï¼š
ğŸ“± å‘çŸ­ä¿¡                    ğŸŒ UDPé€šä¿¡
â”œâ”€ å†™å¥½çŸ­ä¿¡ç›´æ¥å‘            â”œâ”€ æ•°æ®æ‰“åŒ…ç›´æ¥å‘
â”œâ”€ ä¸çŸ¥é“å¯¹æ–¹æ˜¯å¦æ”¶åˆ°        â”œâ”€ ä¸ä¿è¯å¯¹æ–¹æ”¶åˆ°
â”œâ”€ å‘é€é€Ÿåº¦å¾ˆå¿«              â”œâ”€ ä¼ è¾“é€Ÿåº¦å¾ˆå¿«
â”œâ”€ å¯èƒ½æ”¶ä¸åˆ°æˆ–ä¹±åº          â”œâ”€ å¯èƒ½ä¸¢åŒ…æˆ–ä¹±åº
â””â”€ é€‚åˆä¸é‡è¦çš„æ¶ˆæ¯          â””â”€ é€‚åˆå®æ—¶æ€§è¦æ±‚é«˜çš„åœºæ™¯

TCPåƒæ‰“ç”µè¯ï¼š                UDPåƒå‘çŸ­ä¿¡ï¼š
â€¢ å…ˆæ‹¨å·å»ºç«‹è¿æ¥              â€¢ ç›´æ¥å‘é€ï¼Œæ— éœ€è¿æ¥
â€¢ ç¡®ä¿å¯¹æ–¹å¬åˆ°æ¯å¥è¯          â€¢ ä¸ç¡®ä¿å¯¹æ–¹æ”¶åˆ°
â€¢ æœ‰æ¥æœ‰å›çš„å¯¹è¯              â€¢ å•å‘å‘é€ï¼Œå¯èƒ½æ²¡å›éŸ³
â€¢ é€šè¯è´¨é‡å¥½ä½†å»ºç«‹æ…¢          â€¢ å‘é€å¿«ä½†å¯èƒ½ä¸¢å¤±
```

### 1.2 UDPçš„ç‰¹ç‚¹


**âš¡ UDPæ ¸å¿ƒç‰¹å¾**

| ç‰¹ç‚¹ | **è¯´æ˜** | **å¥½å¤„** | **åå¤„** |
|------|---------|---------|---------|
| ğŸš€ **æ— è¿æ¥** | `ä¸éœ€è¦å»ºç«‹è¿æ¥ï¼Œç›´æ¥å‘é€` | `å¯åŠ¨å¿«ï¼Œå¼€é”€å°` | `ä¸çŸ¥é“å¯¹æ–¹æ˜¯å¦åœ¨çº¿` |
| âš¡ **é€Ÿåº¦å¿«** | `æ²¡æœ‰ç¡®è®¤ã€é‡ä¼ ç­‰æœºåˆ¶` | `å»¶è¿Ÿä½ï¼Œå®æ—¶æ€§å¥½` | `å¯èƒ½ä¸¢æ•°æ®` |
| ğŸ“¦ **ä¿æŒè¾¹ç•Œ** | `ä¸€ä¸ªåŒ…å°±æ˜¯ä¸€æ¡å®Œæ•´æ¶ˆæ¯` | `æ¶ˆæ¯ä¸ä¼šç²˜åœ¨ä¸€èµ·` | `åŒ…å¤§å°æœ‰é™åˆ¶` |
| ğŸ”“ **ä¸å¯é ** | `å‘å‡ºå»å°±ä¸ç®¡äº†` | `ç®€å•é«˜æ•ˆ` | `é‡è¦æ•°æ®å¯èƒ½ä¸¢å¤±` |

### 1.3 UDPé€‚åˆä»€ä¹ˆåœºæ™¯


**ğŸ¯ UDPçš„æœ€ä½³ä½¿ç”¨åœºæ™¯**
```
âœ… é€‚åˆUDPçš„åœºæ™¯ï¼š
ğŸ® åœ¨çº¿æ¸¸æˆï¼šç©å®¶ä½ç½®æ›´æ–°ã€æŠ€èƒ½é‡Šæ”¾
   - ä¸¢ä¸€ä¸¤ä¸ªåŒ…æ— æ‰€è°“ï¼Œæœ€æ–°ä½ç½®æ›´é‡è¦
   
ğŸ“º è§†é¢‘ç›´æ’­ï¼šå®æ—¶è§†é¢‘æµã€è¯­éŸ³é€šè¯
   - ç”»é¢å¡ä¸€ä¸‹å¯ä»¥æ¥å—ï¼Œå»¶è¿Ÿä½æ›´é‡è¦
   
ğŸŒ DNSæŸ¥è¯¢ï¼šç½‘å€è½¬IPåœ°å€
   - æŸ¥è¯¢ç®€å•ï¼Œå¤±è´¥äº†é‡æ–°æŸ¥å°±è¡Œ
   
ğŸ“¡ ç³»ç»Ÿç›‘æ§ï¼šæ¸©åº¦ã€CPUä½¿ç”¨ç‡ä¸ŠæŠ¥
   - å¶å°”ä¸¢ä¸ªæ•°æ®ç‚¹ä¸å½±å“æ•´ä½“ç›‘æ§

âŒ ä¸é€‚åˆUDPçš„åœºæ™¯ï¼š
ğŸ’° é“¶è¡Œè½¬è´¦ï¼šç»å¯¹ä¸èƒ½ä¸¢å¤±
ğŸ“ æ–‡ä»¶ä¸‹è½½ï¼šå¿…é¡»å®Œæ•´æ— è¯¯
ğŸ’Œ é‡è¦é‚®ä»¶ï¼šå¿…é¡»é€è¾¾
ğŸ” ç™»å½•éªŒè¯ï¼šä¸èƒ½å‡ºé”™
```

---

## 2. ğŸ’» UDPç¼–ç¨‹åŸºç¡€


### 2.1 æ ¸å¿ƒAPIä»‹ç»


**ğŸ”§ ä¸¤ä¸ªé‡è¦çš„ç±»**
```java
// DatagramSocketï¼šUDPçš„"é‚®å±€"
DatagramSocket socket = new DatagramSocket();      // å®¢æˆ·ç«¯ç”¨
DatagramSocket socket = new DatagramSocket(8080);  // æœåŠ¡ç«¯ç”¨ï¼ŒæŒ‡å®šç«¯å£

// DatagramPacketï¼šUDPçš„"ä¿¡å°+ä¿¡ä»¶"
// å‘é€æ—¶ï¼šè£…å…¥è¦å‘é€çš„æ•°æ®
// æ¥æ”¶æ—¶ï¼šè£…å…¥æ”¶åˆ°çš„æ•°æ®
```

### 2.2 UDPå‘é€æ•°æ®


**ğŸ“¤ å‘é€æ•°æ®çš„æ­¥éª¤**
```java
import java.net.*;

public class UDPSendDemo {
    public static void main(String[] args) throws Exception {
        // 1. åˆ›å»ºUDP Socketï¼ˆä¸éœ€è¦è¿æ¥ï¼‰
        DatagramSocket socket = new DatagramSocket();
        
        // 2. å‡†å¤‡è¦å‘é€çš„æ•°æ®
        String message = "Hello UDP!";
        byte[] data = message.getBytes();
        
        // 3. æ‰“åŒ…æ•°æ®ï¼ˆæŒ‡å®šç›®æ ‡åœ°å€å’Œç«¯å£ï¼‰
        DatagramPacket packet = new DatagramPacket(
            data,                               // æ•°æ®
            data.length,                        // æ•°æ®é•¿åº¦
            InetAddress.getByName("localhost"), // ç›®æ ‡IP
            8080                               // ç›®æ ‡ç«¯å£
        );
        
        // 4. å‘é€æ•°æ®åŒ…
        socket.send(packet);
        System.out.println("æ¶ˆæ¯å·²å‘é€: " + message);
        
        // 5. å…³é—­socket
        socket.close();
    }
}
```

### 2.3 UDPæ¥æ”¶æ•°æ®


**ğŸ“¥ æ¥æ”¶æ•°æ®çš„æ­¥éª¤**
```java
import java.net.*;

public class UDPReceiveDemo {
    public static void main(String[] args) throws Exception {
        // 1. åˆ›å»ºUDP Socketï¼Œç»‘å®šç«¯å£ï¼ˆæœåŠ¡ç«¯å¿…é¡»æŒ‡å®šç«¯å£ï¼‰
        DatagramSocket socket = new DatagramSocket(8080);
        System.out.println("UDPæœåŠ¡å™¨å¯åŠ¨ï¼Œç›‘å¬ç«¯å£8080...");
        
        // 2. å‡†å¤‡æ¥æ”¶ç¼“å†²åŒº
        byte[] buffer = new byte[1024];
        DatagramPacket packet = new DatagramPacket(buffer, buffer.length);
        
        // 3. æ¥æ”¶æ•°æ®ï¼ˆä¼šé˜»å¡ç­‰å¾…ï¼‰
        socket.receive(packet);
        
        // 4. è§£ææ”¶åˆ°çš„æ•°æ®
        String message = new String(packet.getData(), 0, packet.getLength());
        System.out.println("æ”¶åˆ°æ¶ˆæ¯: " + message);
        System.out.println("å‘é€æ–¹: " + packet.getAddress() + ":" + packet.getPort());
        
        // 5. å…³é—­socket
        socket.close();
    }
}
```

---

## 3. ğŸš€ UDPç¼–ç¨‹å®æˆ˜


### 3.1 ç®€å•çš„UDPå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯


**ğŸ“± UDPå®¢æˆ·ç«¯**
```java
import java.net.*;

public class UDPClient {
    public static void main(String[] args) {
        try {
            // åˆ›å»ºUDP Socket
            DatagramSocket socket = new DatagramSocket();
            
            // å‘é€æ¶ˆæ¯åˆ°æœåŠ¡å™¨
            String message = "Hello Server!";
            byte[] data = message.getBytes();
            
            DatagramPacket sendPacket = new DatagramPacket(
                data, data.length,
                InetAddress.getByName("localhost"), 8080
            );
            
            socket.send(sendPacket);
            System.out.println("å‘é€: " + message);
            
            // æ¥æ”¶æœåŠ¡å™¨å›å¤
            byte[] buffer = new byte[1024];
            DatagramPacket receivePacket = new DatagramPacket(buffer, buffer.length);
            
            socket.receive(receivePacket);
            String reply = new String(receivePacket.getData(), 0, receivePacket.getLength());
            System.out.println("æ”¶åˆ°å›å¤: " + reply);
            
            socket.close();
            
        } catch (Exception e) {
            System.out.println("å‡ºé”™äº†: " + e.getMessage());
        }
    }
}
```

**ğŸ–¥ï¸ UDPæœåŠ¡ç«¯**
```java
import java.net.*;

public class UDPServer {
    public static void main(String[] args) {
        try {
            // åˆ›å»ºUDP Socketï¼Œç»‘å®šç«¯å£8080
            DatagramSocket socket = new DatagramSocket(8080);
            System.out.println("UDPæœåŠ¡å™¨å¯åŠ¨ï¼Œç­‰å¾…æ¶ˆæ¯...");
            
            byte[] buffer = new byte[1024];
            
            while (true) {
                // æ¥æ”¶æ•°æ®åŒ…
                DatagramPacket receivePacket = new DatagramPacket(buffer, buffer.length);
                socket.receive(receivePacket);
                
                // è§£ææ¶ˆæ¯
                String message = new String(receivePacket.getData(), 0, receivePacket.getLength());
                System.out.println("æ”¶åˆ°: " + message + 
                    " æ¥è‡ª: " + receivePacket.getAddress());
                
                // å›å¤æ¶ˆæ¯
                String reply = "æ”¶åˆ°ä½ çš„æ¶ˆæ¯: " + message;
                byte[] replyData = reply.getBytes();
                
                DatagramPacket sendPacket = new DatagramPacket(
                    replyData, replyData.length,
                    receivePacket.getAddress(),  // å›å¤ç»™å‘é€æ–¹
                    receivePacket.getPort()
                );
                
                socket.send(sendPacket);
            }
            
        } catch (Exception e) {
            System.out.println("æœåŠ¡å™¨å‡ºé”™: " + e.getMessage());
        }
    }
}
```

### 3.2 UDPèŠå¤©ç¨‹åº


**ğŸ’¬ å¯ä»¥æŒç»­èŠå¤©çš„UDPå®¢æˆ·ç«¯**
```java
import java.net.*;
import java.util.Scanner;

public class UDPChatClient {
    public static void main(String[] args) {
        try {
            DatagramSocket socket = new DatagramSocket();
            Scanner scanner = new Scanner(System.in);
            
            System.out.println("UDPèŠå¤©å®¢æˆ·ç«¯å¯åŠ¨ï¼");
            System.out.println("è¾“å…¥æ¶ˆæ¯å‘é€ï¼Œè¾“å…¥'bye'é€€å‡º");
            
            while (true) {
                // ç”¨æˆ·è¾“å…¥
                System.out.print("æˆ‘: ");
                String input = scanner.nextLine();
                
                // å¦‚æœè¾“å…¥byeå°±é€€å‡º
                if ("bye".equals(input)) {
                    break;
                }
                
                // å‘é€æ¶ˆæ¯
                byte[] data = input.getBytes();
                DatagramPacket sendPacket = new DatagramPacket(
                    data, data.length,
                    InetAddress.getByName("localhost"), 8080
                );
                socket.send(sendPacket);
                
                // æ¥æ”¶å›å¤
                byte[] buffer = new byte[1024];
                DatagramPacket receivePacket = new DatagramPacket(buffer, buffer.length);
                socket.receive(receivePacket);
                
                String reply = new String(receivePacket.getData(), 0, receivePacket.getLength());
                System.out.println("æœåŠ¡å™¨: " + reply);
            }
            
            socket.close();
            System.out.println("èŠå¤©ç»“æŸ");
            
        } catch (Exception e) {
            System.out.println("èŠå¤©å‡ºé”™: " + e.getMessage());
        }
    }
}
```

### 3.3 å¤„ç†è¶…æ—¶é—®é¢˜


**â° é¿å…ä¸€ç›´ç­‰å¾…**
```java
import java.net.*;

public class UDPTimeout {
    public static void main(String[] args) {
        try {
            DatagramSocket socket = new DatagramSocket();
            
            // è®¾ç½®æ¥æ”¶è¶…æ—¶æ—¶é—´ï¼ˆ5ç§’ï¼‰
            socket.setSoTimeout(5000);
            
            // å‘é€æ¶ˆæ¯
            String message = "Hello Server!";
            byte[] data = message.getBytes();
            DatagramPacket sendPacket = new DatagramPacket(
                data, data.length,
                InetAddress.getByName("localhost"), 8080
            );
            socket.send(sendPacket);
            
            // æ¥æ”¶å›å¤ï¼ˆæœ€å¤šç­‰5ç§’ï¼‰
            byte[] buffer = new byte[1024];
            DatagramPacket receivePacket = new DatagramPacket(buffer, buffer.length);
            
            try {
                socket.receive(receivePacket);
                String reply = new String(receivePacket.getData(), 0, receivePacket.getLength());
                System.out.println("æ”¶åˆ°å›å¤: " + reply);
            } catch (SocketTimeoutException e) {
                System.out.println("5ç§’å†…æ²¡æ”¶åˆ°å›å¤ï¼Œå¯èƒ½æœåŠ¡å™¨æ²¡å¯åŠ¨");
            }
            
            socket.close();
            
        } catch (Exception e) {
            System.out.println("å‡ºé”™: " + e.getMessage());
        }
    }
}
```

---

## 4. ğŸ“¡ UDPå¹¿æ’­ç¼–ç¨‹


### 4.1 ä»€ä¹ˆæ˜¯UDPå¹¿æ’­


**ğŸ“¢ å¹¿æ’­å°±åƒå–‡å­å–Šè¯**
```
æ™®é€šUDPï¼š                    UDPå¹¿æ’­ï¼š
A â†’ B (ç‚¹å¯¹ç‚¹)               A â†’ æ‰€æœ‰äºº (ä¸€å¯¹å¤š)

å°±åƒï¼š                      å°±åƒï¼š
ç»™æŸä¸ªäººå‘æ¶ˆæ¯               ç”¨å¤§å–‡å­é€šçŸ¥æ‰€æœ‰äºº
QQç§èŠ                      å¾®ä¿¡ç¾¤æ¶ˆæ¯
ç”µè¯é€šè¯                    å¹¿æ’­ç”µå°

ä½¿ç”¨åœºæ™¯ï¼š
ğŸ” å±€åŸŸç½‘è®¾å¤‡å‘ç°ï¼šæ‰¾åˆ°ç½‘ç»œä¸­çš„è®¾å¤‡
ğŸ“¢ æ¶ˆæ¯é€šçŸ¥ï¼šå‘æ‰€æœ‰è®¾å¤‡å‘é€é€šçŸ¥
ğŸ® æ¸¸æˆæˆ¿é—´ï¼šé€šçŸ¥æ‰€æœ‰ç©å®¶æ¸¸æˆå¼€å§‹
```

### 4.2 UDPå¹¿æ’­ç¤ºä¾‹


**ğŸ“» å¹¿æ’­å‘é€ç«¯**
```java
import java.net.*;

public class UDPBroadcast {
    public static void main(String[] args) {
        try {
            DatagramSocket socket = new DatagramSocket();
            
            // é‡è¦ï¼šå¯ç”¨å¹¿æ’­åŠŸèƒ½
            socket.setBroadcast(true);
            
            String message = "å¤§å®¶å¥½ï¼æˆ‘æ˜¯å¹¿æ’­æ¶ˆæ¯ï¼";
            byte[] data = message.getBytes();
            
            // å‘é€åˆ°å¹¿æ’­åœ°å€ï¼ˆ255.255.255.255è¡¨ç¤ºå‘ç»™æ‰€æœ‰äººï¼‰
            DatagramPacket packet = new DatagramPacket(
                data, data.length,
                InetAddress.getByName("255.255.255.255"), 9999
            );
            
            socket.send(packet);
            System.out.println("å¹¿æ’­æ¶ˆæ¯å·²å‘é€: " + message);
            
            socket.close();
            
        } catch (Exception e) {
            System.out.println("å¹¿æ’­å‡ºé”™: " + e.getMessage());
        }
    }
}
```

**ğŸ“¡ å¹¿æ’­æ¥æ”¶ç«¯**
```java
import java.net.*;

public class UDPBroadcastReceiver {
    public static void main(String[] args) {
        try {
            // ç›‘å¬å¹¿æ’­ç«¯å£9999
            DatagramSocket socket = new DatagramSocket(9999);
            System.out.println("å¼€å§‹ç›‘å¬å¹¿æ’­æ¶ˆæ¯ï¼Œç«¯å£9999...");
            
            byte[] buffer = new byte[1024];
            
            while (true) {
                DatagramPacket packet = new DatagramPacket(buffer, buffer.length);
                socket.receive(packet);
                
                String message = new String(packet.getData(), 0, packet.getLength());
                System.out.println("æ”¶åˆ°å¹¿æ’­: " + message + 
                    " æ¥è‡ª: " + packet.getAddress());
            }
            
        } catch (Exception e) {
            System.out.println("æ¥æ”¶å¹¿æ’­å‡ºé”™: " + e.getMessage());
        }
    }
}
```

### 4.3 å±€åŸŸç½‘è®¾å¤‡å‘ç°


**ğŸ” ç®€å•çš„è®¾å¤‡å‘ç°ç¨‹åº**
```java
import java.net.*;

// è®¾å¤‡å‘ç°æœåŠ¡ç«¯ï¼ˆæ¨¡æ‹Ÿè®¾å¤‡ï¼‰
public class DeviceServer {
    public static void main(String[] args) {
        try {
            DatagramSocket socket = new DatagramSocket(8888);
            System.out.println("è®¾å¤‡å¯åŠ¨ï¼Œç­‰å¾…å‘ç°è¯·æ±‚...");
            
            byte[] buffer = new byte[1024];
            
            while (true) {
                DatagramPacket packet = new DatagramPacket(buffer, buffer.length);
                socket.receive(packet);
                
                String request = new String(packet.getData(), 0, packet.getLength());
                
                if ("DISCOVER".equals(request)) {
                    // å›å¤è®¾å¤‡ä¿¡æ¯
                    String deviceInfo = "æˆ‘æ˜¯è®¾å¤‡ï¼šæ‰“å°æœº-HP001";
                    byte[] response = deviceInfo.getBytes();
                    
                    DatagramPacket reply = new DatagramPacket(
                        response, response.length,
                        packet.getAddress(), packet.getPort()
                    );
                    
                    socket.send(reply);
                    System.out.println("å›å¤äº†è®¾å¤‡å‘ç°è¯·æ±‚");
                }
            }
            
        } catch (Exception e) {
            System.out.println("è®¾å¤‡æœåŠ¡å‡ºé”™: " + e.getMessage());
        }
    }
}

// è®¾å¤‡å‘ç°å®¢æˆ·ç«¯
public class DeviceDiscovery {
    public static void main(String[] args) {
        try {
            DatagramSocket socket = new DatagramSocket();
            socket.setBroadcast(true);
            socket.setSoTimeout(3000); // 3ç§’è¶…æ—¶
            
            // å¹¿æ’­å‘ç°è¯·æ±‚
            String request = "DISCOVER";
            byte[] data = request.getBytes();
            
            DatagramPacket packet = new DatagramPacket(
                data, data.length,
                InetAddress.getByName("255.255.255.255"), 8888
            );
            
            socket.send(packet);
            System.out.println("æ­£åœ¨æœç´¢è®¾å¤‡...");
            
            // æ¥æ”¶è®¾å¤‡å›å¤
            byte[] buffer = new byte[1024];
            try {
                while (true) {
                    DatagramPacket reply = new DatagramPacket(buffer, buffer.length);
                    socket.receive(reply);
                    
                    String deviceInfo = new String(reply.getData(), 0, reply.getLength());
                    System.out.println("å‘ç°è®¾å¤‡: " + deviceInfo + 
                        " IP: " + reply.getAddress());
                }
            } catch (SocketTimeoutException e) {
                System.out.println("æœç´¢å®Œæˆ");
            }
            
            socket.close();
            
        } catch (Exception e) {
            System.out.println("è®¾å¤‡å‘ç°å‡ºé”™: " + e.getMessage());
        }
    }
}
```

---

## 5. âš–ï¸ UDP vs TCPå¯¹æ¯”


### 5.1 ç‰¹ç‚¹å¯¹æ¯”


**ğŸ“Š ç›´è§‚å¯¹æ¯”è¡¨**

| ç‰¹æ€§ | **TCP** | **UDP** |
|------|---------|---------|
| ğŸ”— **è¿æ¥** | `å¿…é¡»å…ˆ"æ¡æ‰‹"å»ºç«‹è¿æ¥` | `ç›´æ¥å‘é€ï¼Œæ— éœ€è¿æ¥` |
| ğŸ”’ **å¯é æ€§** | `ä¿è¯æ•°æ®ä¸ä¸¢å¤±ã€ä¸é‡å¤` | `å¯èƒ½ä¸¢å¤±ã€é‡å¤ã€ä¹±åº` |
| âš¡ **é€Ÿåº¦** | `è¾ƒæ…¢ï¼ˆæœ‰å¾ˆå¤šæ£€æŸ¥ï¼‰` | `å¾ˆå¿«ï¼ˆç›´æ¥å‘é€ï¼‰` |
| ğŸ“¦ **æ•°æ®è¾¹ç•Œ** | `æ•°æ®ä¼š"ç²˜"åœ¨ä¸€èµ·` | `æ¯ä¸ªåŒ…éƒ½æ˜¯ç‹¬ç«‹çš„` |
| ğŸ¯ **ä½¿ç”¨åœºæ™¯** | `é‡è¦æ•°æ®ä¼ è¾“` | `å®æ—¶é€šä¿¡` |

### 5.2 ä»€ä¹ˆæ—¶å€™ç”¨å“ªä¸ª


**ğŸ¤” é€‰æ‹©UDPè¿˜æ˜¯TCPï¼Ÿ**
```
é€‰æ‹©UDPçš„æƒ…å†µï¼š
âœ… é€Ÿåº¦æ¯”å‡†ç¡®æ€§æ›´é‡è¦
   - åœ¨çº¿æ¸¸æˆï¼šç©å®¶ä½ç½®æ›´æ–°
   - è§†é¢‘ç›´æ’­ï¼šä¸¢å‡ å¸§ç”»é¢æ— æ‰€è°“
   
âœ… æ•°æ®ç®€å•ï¼Œä¸¢äº†é‡å‘æˆæœ¬ä½
   - DNSæŸ¥è¯¢ï¼šæŸ¥ä¸åˆ°å†æŸ¥ä¸€æ¬¡
   - å¿ƒè·³æ£€æµ‹ï¼šå®šæœŸå‘é€çŠ¶æ€
   
âœ… éœ€è¦å¹¿æ’­åŠŸèƒ½
   - å±€åŸŸç½‘é€šçŸ¥
   - è®¾å¤‡å‘ç°

é€‰æ‹©TCPçš„æƒ…å†µï¼š
âœ… æ•°æ®ç»å¯¹ä¸èƒ½ä¸¢
   - æ–‡ä»¶ä¼ è¾“
   - ç½‘é¡µæµè§ˆ
   - é‚®ä»¶å‘é€
   
âœ… æ•°æ®é‡å¤§
   - ä¸‹è½½ç”µå½±
   - ä¼ è¾“æ–‡æ¡£
   
âœ… ä¸æƒ³è‡ªå·±å¤„ç†é‡ä¼ é€»è¾‘
   - å¤æ‚çš„ä¸šåŠ¡æ•°æ®
```

### 5.3 æ€§èƒ½å¯¹æ¯”å®ä¾‹


**âš¡ ç®€å•æ€§èƒ½æµ‹è¯•**
```java
public class PerformanceTest {
    public static void main(String[] args) {
        // æ¨¡æ‹Ÿæµ‹è¯•ç»“æœï¼ˆä»…ä¾›å‚è€ƒï¼‰
        System.out.println("å‘é€1000ä¸ªå°æ¶ˆæ¯çš„æ—¶é—´å¯¹æ¯”ï¼š");
        System.out.println("TCP: çº¦500ms ï¼ˆéœ€è¦å»ºç«‹è¿æ¥ï¼Œæœ‰ç¡®è®¤æœºåˆ¶ï¼‰");
        System.out.println("UDP: çº¦100ms ï¼ˆç›´æ¥å‘é€ï¼Œæ— é¢å¤–å¼€é”€ï¼‰");
        
        System.out.println("\nå†…å­˜ä½¿ç”¨å¯¹æ¯”ï¼š");
        System.out.println("TCP: éœ€è¦ç»´æŠ¤è¿æ¥çŠ¶æ€ï¼Œç¼“å†²åŒºç­‰");
        System.out.println("UDP: å‡ ä¹ä¸éœ€è¦é¢å¤–å†…å­˜");
        
        System.out.println("\né€‚ç”¨åœºæ™¯ï¼š");
        System.out.println("TCP: é“¶è¡Œè½¬è´¦ã€æ–‡ä»¶ä¸‹è½½ã€ç½‘é¡µæµè§ˆ");
        System.out.println("UDP: åœ¨çº¿æ¸¸æˆã€è§†é¢‘é€šè¯ã€DNSæŸ¥è¯¢");
    }
}
```

---

## 6. âš ï¸ UDPæ³¨æ„äº‹é¡¹


### 6.1 æ•°æ®åŒ…å¤§å°é™åˆ¶


**ğŸ“ UDPåŒ…ä¸èƒ½å¤ªå¤§**
```java
public class UDPSizeLimit {
    public static void main(String[] args) {
        System.out.println("UDPæ•°æ®åŒ…å¤§å°é™åˆ¶ï¼š");
        System.out.println("ç†è®ºæœ€å¤§ï¼š65507å­—èŠ‚");
        System.out.println("å»ºè®®å¤§å°ï¼š1400å­—èŠ‚ä»¥å†…");
        System.out.println("åŸå› ï¼šè¶…è¿‡1500å­—èŠ‚ä¼šè¢«åˆ†ç‰‡ï¼Œå®¹æ˜“ä¸¢å¤±");
        
        // å‘é€å¤§æ•°æ®çš„å»ºè®®
        String bigData = "å¾ˆé•¿å¾ˆé•¿çš„æ•°æ®..."; // å‡è®¾å¾ˆå¤§
        
        if (bigData.getBytes().length > 1400) {
            System.out.println("æ•°æ®å¤ªå¤§ï¼Œå»ºè®®ï¼š");
            System.out.println("1. åˆ†å‰²æˆå¤šä¸ªå°åŒ…å‘é€");
            System.out.println("2. æˆ–è€…æ”¹ç”¨TCP");
            System.out.println("3. æˆ–è€…å‹ç¼©æ•°æ®");
        }
    }
}
```

### 6.2 å¤„ç†æ•°æ®ä¸¢å¤±


**ğŸ”„ ç®€å•çš„é‡å‘æœºåˆ¶**
```java
import java.net.*;

public class UDPRetry {
    public static void main(String[] args) {
        try {
            DatagramSocket socket = new DatagramSocket();
            socket.setSoTimeout(2000); // 2ç§’è¶…æ—¶
            
            String message = "é‡è¦æ¶ˆæ¯";
            int maxRetry = 3; // æœ€å¤šé‡è¯•3æ¬¡
            
            for (int i = 0; i < maxRetry; i++) {
                try {
                    // å‘é€æ¶ˆæ¯
                    byte[] data = message.getBytes();
                    DatagramPacket sendPacket = new DatagramPacket(
                        data, data.length,
                        InetAddress.getByName("localhost"), 8080
                    );
                    socket.send(sendPacket);
                    System.out.println("ç¬¬" + (i+1) + "æ¬¡å‘é€: " + message);
                    
                    // ç­‰å¾…å›å¤
                    byte[] buffer = new byte[1024];
                    DatagramPacket receivePacket = new DatagramPacket(buffer, buffer.length);
                    socket.receive(receivePacket);
                    
                    String reply = new String(receivePacket.getData(), 0, receivePacket.getLength());
                    System.out.println("æ”¶åˆ°å›å¤: " + reply);
                    break; // æˆåŠŸäº†å°±ä¸é‡è¯•äº†
                    
                } catch (SocketTimeoutException e) {
                    System.out.println("ç¬¬" + (i+1) + "æ¬¡å‘é€è¶…æ—¶");
                    if (i == maxRetry - 1) {
                        System.out.println("é‡è¯•æ¬¡æ•°ç”¨å®Œï¼Œæ”¾å¼ƒå‘é€");
                    }
                }
            }
            
            socket.close();
            
        } catch (Exception e) {
            System.out.println("å‡ºé”™: " + e.getMessage());
        }
    }
}
```

### 6.3 é˜²ç«å¢™é—®é¢˜


**ğŸ›¡ï¸ UDPå®¹æ˜“è¢«é˜²ç«å¢™æ‹¦æˆª**
```java
public class UDPFirewallTips {
    public static void main(String[] args) {
        System.out.println("UDPé˜²ç«å¢™æ³¨æ„äº‹é¡¹ï¼š");
        System.out.println("1. UDPæ¯”TCPæ›´å®¹æ˜“è¢«é˜²ç«å¢™é˜»æ‹¦");
        System.out.println("2. å¹¿æ’­æ¶ˆæ¯æ›´å®¹æ˜“è¢«å½“ä½œæ”»å‡»");
        System.out.println("3. æµ‹è¯•æ—¶è®°å¾—å…³é—­é˜²ç«å¢™");
        
        System.out.println("\nè°ƒè¯•å»ºè®®ï¼š");
        System.out.println("- å…ˆåœ¨æœ¬æœºæµ‹è¯•ï¼ˆlocalhostï¼‰");
        System.out.println("- ä½¿ç”¨å¸¸è§ç«¯å£ï¼ˆå¦‚8080ã€9999ï¼‰");
        System.out.println("- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®");
        System.out.println("- ç”¨telnetæµ‹è¯•ç«¯å£æ˜¯å¦å¼€æ”¾");
    }
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„åŸºç¡€æ¦‚å¿µ


```
ğŸ”¸ UDPç‰¹ç‚¹ = å¿«é€Ÿã€ç®€å•ã€ä¸å¯é ï¼ˆåƒå‘çŸ­ä¿¡ï¼‰
ğŸ”¸ æ ¸å¿ƒAPI = DatagramSocketï¼ˆé‚®å±€ï¼‰+ DatagramPacketï¼ˆä¿¡å°ï¼‰
ğŸ”¸ å‘é€æ­¥éª¤ = åˆ›å»ºSocket â†’ æ‰“åŒ…æ•°æ® â†’ å‘é€ â†’ å…³é—­
ğŸ”¸ æ¥æ”¶æ­¥éª¤ = åˆ›å»ºSocketç»‘å®šç«¯å£ â†’ å‡†å¤‡ç¼“å†²åŒº â†’ æ¥æ”¶ â†’ è§£æ
ğŸ”¸ å¹¿æ’­åŠŸèƒ½ = setBroadcast(true) + å¹¿æ’­åœ°å€255.255.255.255
```

### 7.2 ç¼–ç¨‹è¦ç‚¹


**ğŸ”¹ UDPç¼–ç¨‹å¥—è·¯**
```
å®¢æˆ·ç«¯ï¼ˆå‘é€æ–¹ï¼‰ï¼š
1. new DatagramSocket() - åˆ›å»ºSocket
2. å‡†å¤‡æ•°æ®å’Œç›®æ ‡åœ°å€
3. new DatagramPacket() - æ‰“åŒ…
4. socket.send() - å‘é€
5. socket.close() - å…³é—­

æœåŠ¡ç«¯ï¼ˆæ¥æ”¶æ–¹ï¼‰ï¼š
1. new DatagramSocket(ç«¯å£) - ç»‘å®šç«¯å£
2. å‡†å¤‡æ¥æ”¶ç¼“å†²åŒº
3. socket.receive() - æ¥æ”¶ï¼ˆä¼šé˜»å¡ï¼‰
4. è§£ææ•°æ®å’Œå‘é€æ–¹ä¿¡æ¯
5. å¯é€‰ï¼šå›å¤æ¶ˆæ¯
```

**ğŸ”¹ é‡è¦æ³¨æ„äº‹é¡¹**
```
âœ… æ•°æ®åŒ…ä¸è¦è¶…è¿‡1400å­—èŠ‚
âœ… é‡è¦æ•°æ®è¦å®ç°é‡å‘æœºåˆ¶
âœ… è®¾ç½®æ¥æ”¶è¶…æ—¶ï¼Œé¿å…æ°¸ä¹…é˜»å¡
âœ… å¹¿æ’­è¦å¯ç”¨setBroadcast(true)
âŒ ä¸è¦ç”¨UDPä¼ è¾“é‡è¦æ–‡ä»¶
âŒ ä¸è¦æŒ‡æœ›UDPä¸€å®šèƒ½é€è¾¾
```

### 7.3 é€‚ç”¨åœºæ™¯åˆ¤æ–­


**ğŸ¯ ä»€ä¹ˆæ—¶å€™ç”¨UDP**
```
âœ… å®æ—¶æ€§è¦æ±‚é«˜ï¼š
  - åœ¨çº¿æ¸¸æˆï¼ˆä½ç½®åŒæ­¥ï¼‰
  - è§†é¢‘ç›´æ’­ï¼ˆç”»é¢ä¼ è¾“ï¼‰
  - è¯­éŸ³é€šè¯ï¼ˆéŸ³é¢‘æ•°æ®ï¼‰

âœ… æ•°æ®ç®€å•ä¸”å¯é‡å‘ï¼š
  - DNSæŸ¥è¯¢ï¼ˆåŸŸåè§£æï¼‰
  - å¿ƒè·³æ£€æµ‹ï¼ˆè®¾å¤‡çŠ¶æ€ï¼‰
  - æ—¥å¿—ä¸ŠæŠ¥ï¼ˆç›‘æ§æ•°æ®ï¼‰

âœ… éœ€è¦å¹¿æ’­åŠŸèƒ½ï¼š
  - è®¾å¤‡å‘ç°
  - å±€åŸŸç½‘é€šçŸ¥
  - ç»„æ’­æ¶ˆæ¯

âŒ ä»€ä¹ˆæ—¶å€™ä¸ç”¨UDPï¼š
  - æ–‡ä»¶ä¼ è¾“ï¼ˆè¦å®Œæ•´æ€§ï¼‰
  - é‡è¦ä¸šåŠ¡æ•°æ®ï¼ˆä¸èƒ½ä¸¢ï¼‰
  - å¤§é‡æ•°æ®ä¼ è¾“ï¼ˆTCPæ›´åˆé€‚ï¼‰
```

### 7.4 å­¦ä¹ å»ºè®®


**ğŸ¯ å¾ªåºæ¸è¿›**
```
ç¬¬1æ­¥ï¼šç†è§£UDPç‰¹ç‚¹ï¼ˆå¿«ä½†ä¸å¯é ï¼‰
ç¬¬2æ­¥ï¼šå†™ç®€å•çš„å‘é€å’Œæ¥æ”¶ç¨‹åº
ç¬¬3æ­¥ï¼šåŠ ä¸Šè¶…æ—¶å’Œé‡è¯•æœºåˆ¶
ç¬¬4æ­¥ï¼šå°è¯•å¹¿æ’­åŠŸèƒ½
ç¬¬5æ­¥ï¼šå¯¹æ¯”TCPå’ŒUDPçš„ä½¿ç”¨åœºæ™¯
```

**ğŸ’¡ è°ƒè¯•æŠ€å·§**
```
â€¢ å…ˆåœ¨æœ¬æœºæµ‹è¯•ï¼Œå†è·¨æœºå™¨æµ‹è¯•
â€¢ ç”¨WiresharkæŠ“åŒ…çœ‹æ•°æ®ä¼ è¾“
â€¢ æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦é˜»æ‹¦UDP
â€¢ æ‰“å°å‘é€å’Œæ¥æ”¶çš„è¯¦ç»†ä¿¡æ¯
â€¢ æµ‹è¯•ç½‘ç»œä¸ç¨³å®šæƒ…å†µä¸‹çš„è¡¨ç°
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- UDPåƒå‘çŸ­ä¿¡ï¼šå¿«é€Ÿå‘é€ï¼Œä¸ä¿è¯é€è¾¾
- é€‚åˆå®æ—¶é€šä¿¡ï¼Œä¸é€‚åˆé‡è¦æ•°æ®ä¼ è¾“
- ç¼–ç¨‹ç®€å•ï¼šæ‰“åŒ…å‘é€ï¼Œæ— éœ€è¿æ¥å»ºç«‹
- è®°å¾—å¤„ç†è¶…æ—¶å’Œé‡å‘ï¼Œæ•°æ®åŒ…ä¸è¦å¤ªå¤§
- å¹¿æ’­åŠŸèƒ½å¾ˆæœ‰ç”¨ï¼Œä½†è¦å°å¿ƒé˜²ç«å¢™æ‹¦æˆª