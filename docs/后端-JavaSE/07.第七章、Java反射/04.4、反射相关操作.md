---
title: 4ã€åå°„ç›¸å…³æ“ä½œ
---
## ğŸ“š ç›®å½•

1. [è·å–ç±»ç»“æ„åå°„æ“ä½œ](#1-è·å–ç±»ç»“æ„åå°„æ“ä½œ)
2. [è·å–æ„é€ å™¨åå°„æ“ä½œ](#2-è·å–æ„é€ å™¨åå°„æ“ä½œ)
3. [è·å–å­—æ®µåå°„æ“ä½œ](#3-è·å–å­—æ®µåå°„æ“ä½œ)
4. [è·å–æ–¹æ³•åå°„æ“ä½œ](#4-è·å–æ–¹æ³•åå°„æ“ä½œ)
5. [è·å–æ•°ç»„åå°„æ“ä½œ](#5-è·å–æ•°ç»„åå°„æ“ä½œ)
6. [è·å–æ³¨è§£åå°„æ“ä½œ](#6-è·å–æ³¨è§£åå°„æ“ä½œ)
7. [è®¿é—®æ§åˆ¶ç»•è¿‡](#7-è®¿é—®æ§åˆ¶ç»•è¿‡)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” è·å–ç±»ç»“æ„åå°„æ“ä½œ


### 1.1 æ ¸å¿ƒæ“ä½œæ–¹æ³•


**ğŸ“‹ ç±»ç»“æ„è·å–æ–¹æ³•è¡¨**

| æ–¹æ³• | **åŠŸèƒ½** | **è¿”å›ç±»å‹** |
|-----|---------|-------------|
| `getName()` | è·å–å…¨é™å®šç±»å | `String` |
| `getSimpleName()` | è·å–ç®€å•ç±»å | `String` |
| `getPackage()` | è·å–åŒ…ä¿¡æ¯ | `Package` |
| `getModifiers()` | è·å–ä¿®é¥°ç¬¦ï¼ˆé…åˆModifierç±»åˆ¤æ–­ï¼‰ | `int` |
| `getSuperclass()` | è·å–çˆ¶ç±»ç±»å‹ | `Class<?>` |
| `getInterfaces()` | è·å–å®ç°çš„æ¥å£æ•°ç»„ | `Class<?>[]` |
| `isInterface()` / `isEnum()` / `isAnnotation()` / `isArray()` | åˆ¤æ–­ç±»ç±»å‹ | `boolean` |
| `getClassLoader()` | è·å–ç±»åŠ è½½å™¨ï¼ˆäº†è§£ç±»æ¥æºï¼‰ | `ClassLoader` |

### 1.2 è¯¦ç»†ä»£ç ç¤ºä¾‹


**ğŸ’» è·å–ç±»ç»“æ„ä¿¡æ¯çš„å®Œæ•´ç¤ºä¾‹**
```java
import java.lang.reflect.*;

class Person {
    private String name;
    public int age;

    public Person() {}
    public Person(String name) { this.name = name; }
    
    public void sayHello() { System.out.println("Hello!"); }
    private void secret() { System.out.println("Secret method"); }
}

public class ReflectCore {
    public static void main(String[] args) throws Exception {
        Class<?> clazz = Person.class;

        // âœ… 1. è·å–ç±»åŸºæœ¬ä¿¡æ¯
        System.out.println("=== ç±»åŸºæœ¬ä¿¡æ¯ ===");
        System.out.println("ç±»åï¼š" + clazz.getName());
        System.out.println("ç®€å•ç±»åï¼š" + clazz.getSimpleName());
        System.out.println("åŒ…åï¼š" + clazz.getPackageName());
        System.out.println("çˆ¶ç±»ï¼š" + clazz.getSuperclass().getSimpleName());
        System.out.println("æ˜¯å¦æ¥å£ï¼š" + clazz.isInterface());
        System.out.println("æ˜¯å¦æ•°ç»„ï¼š" + clazz.isArray());
        System.out.println("æ˜¯å¦æšä¸¾ï¼š" + clazz.isEnum());

        // âœ… 2. è·å–å®ç°çš„æ¥å£
        System.out.println("\n=== å®ç°çš„æ¥å£ ===");
        Class<?>[] interfaces = clazz.getInterfaces();
        if (interfaces.length > 0) {
            for (Class<?> i : interfaces) {
                System.out.println("å®ç°æ¥å£ï¼š" + i.getName());
            }
        } else {
            System.out.println("æœªå®ç°ä»»ä½•æ¥å£");
        }

        // âœ… 3. è·å–å­—æ®µä¿¡æ¯
        System.out.println("\n=== å­—æ®µä¿¡æ¯ ===");
        for (Field f : clazz.getDeclaredFields()) {
            System.out.printf("å­—æ®µï¼š%s %s %s%n", 
                Modifier.toString(f.getModifiers()), 
                f.getType().getSimpleName(), 
                f.getName());
        }

        // âœ… 4. è·å–æ–¹æ³•ä¿¡æ¯
        System.out.println("\n=== æ–¹æ³•ä¿¡æ¯ ===");
        for (Method m : clazz.getDeclaredMethods()) {
            System.out.printf("æ–¹æ³•ï¼š%s %s %s()%n", 
                Modifier.toString(m.getModifiers()), 
                m.getReturnType().getSimpleName(), 
                m.getName());
        }

        // âœ… 5. è·å–æ„é€ å™¨ä¿¡æ¯
        System.out.println("\n=== æ„é€ å™¨ä¿¡æ¯ ===");
        for (Constructor<?> c : clazz.getDeclaredConstructors()) {
            System.out.print("æ„é€ å™¨ï¼š" + Modifier.toString(c.getModifiers()) + " " + 
                clazz.getSimpleName() + "(");
            Class<?>[] paramTypes = c.getParameterTypes();
            for (int i = 0; i < paramTypes.length; i++) {
                System.out.print(paramTypes[i].getSimpleName());
                if (i < paramTypes.length - 1) System.out.print(", ");
            }
            System.out.println(")");
        }

        // âœ… 6. è·å–æ³¨è§£ä¿¡æ¯
        System.out.println("\n=== æ³¨è§£ä¿¡æ¯ ===");
        Annotation[] annotations = clazz.getAnnotations();
        if (annotations.length > 0) {
            for (Annotation a : annotations) {
                System.out.println("æ³¨è§£ï¼š" + a.annotationType().getSimpleName());
            }
        } else {
            System.out.println("æ— ç±»çº§åˆ«æ³¨è§£");
        }

        // âœ… 7. è·å–ç±»åŠ è½½å™¨ä¿¡æ¯
        System.out.println("\n=== ç±»åŠ è½½å™¨ä¿¡æ¯ ===");
        ClassLoader loader = clazz.getClassLoader();
        System.out.println("ç±»åŠ è½½å™¨ï¼š" + (loader != null ? loader.getClass().getSimpleName() : "Bootstrap ClassLoader"));
    }
}
```

### 1.3 ç±»å‹åˆ¤æ–­å®ç”¨æ–¹æ³•


**ğŸ”§ å¸¸ç”¨ç±»å‹åˆ¤æ–­å·¥å…·**
```java
public class ClassTypeUtils {
    
    public static void analyzeClass(Class<?> clazz) {
        System.out.println("=== ç±»å‹åˆ†æï¼š" + clazz.getSimpleName() + " ===");
        
        // åŸºæœ¬ç±»å‹åˆ¤æ–­
        if (clazz.isPrimitive()) {
            System.out.println("âœ“ åŸºæœ¬æ•°æ®ç±»å‹");
        } else if (clazz.isInterface()) {
            System.out.println("âœ“ æ¥å£ç±»å‹");
        } else if (clazz.isEnum()) {
            System.out.println("âœ“ æšä¸¾ç±»å‹");
        } else if (clazz.isAnnotation()) {
            System.out.println("âœ“ æ³¨è§£ç±»å‹");
        } else if (clazz.isArray()) {
            System.out.println("âœ“ æ•°ç»„ç±»å‹ï¼Œå…ƒç´ ç±»å‹ï¼š" + clazz.getComponentType().getSimpleName());
        } else {
            System.out.println("âœ“ æ™®é€šç±»");
        }
        
        // ä¿®é¥°ç¬¦åˆ¤æ–­
        int modifiers = clazz.getModifiers();
        if (Modifier.isAbstract(modifiers)) {
            System.out.println("âœ“ æŠ½è±¡ç±»");
        }
        if (Modifier.isFinal(modifiers)) {
            System.out.println("âœ“ æœ€ç»ˆç±»ï¼ˆä¸å¯ç»§æ‰¿ï¼‰");
        }
        if (Modifier.isPublic(modifiers)) {
            System.out.println("âœ“ å…¬å¼€ç±»");
        }
    }
}
```

---

## 2. ğŸ—ï¸ è·å–æ„é€ å™¨åå°„æ“ä½œ


### 2.1 æ„é€ å™¨è·å–æ–¹æ³•


**ğŸ“‹ Constructoræ ¸å¿ƒæ–¹æ³•è¡¨**

| æ–¹æ³• | **åŠŸèƒ½** | **è®¿é—®æƒé™** |
|-----|---------|-------------|
| `getConstructors()` | è·å–æ‰€æœ‰`public`æ„é€ å™¨ï¼ˆä¸åŒ…æ‹¬privateï¼‰ | ä»…public |
| `getDeclaredConstructors()` | è·å–æ‰€æœ‰æ„é€ å™¨ï¼ˆåŒ…æ‹¬`private`ï¼‰ | æ‰€æœ‰è®¿é—®æƒé™ |
| `getConstructor(Class<?>... parameterTypes)` | è·å–æŒ‡å®šå‚æ•°ç±»å‹çš„`public`æ„é€ å™¨ | ä»…public |
| `getDeclaredConstructor(Class<?>... parameterTypes)` | è·å–æŒ‡å®šå‚æ•°ç±»å‹çš„æ„é€ å™¨ï¼ˆåŒ…æ‹¬`private`ï¼‰ | æ‰€æœ‰è®¿é—®æƒé™ |

### 2.2 æ„é€ å™¨æ“ä½œæ–¹æ³•


**ğŸ”§ Constructoræ“ä½œæ–¹æ³•è¡¨**

| æ–¹æ³• | **åŠŸèƒ½** | **è¿”å›ç±»å‹** |
|-----|---------|-------------|
| `getParameterTypes()` | è·å–æ„é€ å™¨çš„å‚æ•°ç±»å‹æ•°ç»„ | `Class<?>[]` |
| `getModifiers()` | è·å–æ„é€ å™¨çš„ä¿®é¥°ç¬¦ï¼ˆé…åˆ`Modifier`ä½¿ç”¨ï¼‰ | `int` |
| `isVarArgs()` | åˆ¤æ–­æ„é€ å™¨æ˜¯å¦ä¸ºå¯å˜å‚æ•° | `boolean` |
| `setAccessible(true)` | æ‰“ç ´æƒé™é™åˆ¶ä»¥è®¿é—®`private`æ„é€ å™¨ | `void` |
| `newInstance(Object... initargs)` | è°ƒç”¨æ„é€ å™¨ï¼Œåˆ›å»ºå¯¹è±¡å®ä¾‹ | `T` |
| `getDeclaringClass()` | è·å–æ„é€ å™¨æ‰€å±ç±»çš„`Class`å¯¹è±¡ | `Class<?>` |

### 2.3 è¯¦ç»†ä»£ç ç¤ºä¾‹


**ğŸ’» æ„é€ å™¨åå°„æ“ä½œå®Œæ•´ç¤ºä¾‹**
```java
import java.lang.reflect.*;

class Person {
    private String name;
    public int age;

    // æ— å‚æ„é€ å™¨
    public Person() {
        System.out.println("è°ƒç”¨æ— å‚æ„é€ å™¨");
    }
    
    // å•å‚æ„é€ å™¨
    public Person(String name) {
        this.name = name;
        System.out.println("è°ƒç”¨å•å‚æ„é€ å™¨ï¼š" + name);
    }

    // ç§æœ‰æ„é€ å™¨
    private Person(String name, int age) {
        this.name = name;
        this.age = age;
        System.out.println("è°ƒç”¨ç§æœ‰æ„é€ å™¨ï¼š" + name + ", " + age);
    }
    
    // å¯å˜å‚æ•°æ„é€ å™¨
    public Person(String name, String... hobbies) {
        this.name = name;
        System.out.println("è°ƒç”¨å¯å˜å‚æ•°æ„é€ å™¨ï¼š" + name + 
            ", çˆ±å¥½æ•°é‡ï¼š" + hobbies.length);
    }

    @Override
    public String toString() {
        return "Person{name='" + name + "', age=" + age + '}';
    }
}

public class ConstructorReflectDemo {
    public static void main(String[] args) throws Exception {
        Class<?> clazz = Person.class;

        // âœ… 1. è·å–æ‰€æœ‰publicæ„é€ å™¨
        System.out.println("=== æ‰€æœ‰publicæ„é€ å™¨ ===");
        Constructor<?>[] publicConstructors = clazz.getConstructors();
        for (Constructor<?> c : publicConstructors) {
            System.out.println("publicæ„é€ å™¨: " + c);
        }

        // âœ… 2. è·å–æ‰€æœ‰æ„é€ å™¨ï¼ˆåŒ…å«privateï¼‰
        System.out.println("\n=== æ‰€æœ‰æ„é€ å™¨ï¼ˆåŒ…æ‹¬privateï¼‰ ===");
        Constructor<?>[] allConstructors = clazz.getDeclaredConstructors();
        for (Constructor<?> c : allConstructors) {
            System.out.println("æ„é€ å™¨: " + c);
        }

        // âœ… 3. è·å–å¹¶ä½¿ç”¨ç‰¹å®šæ„é€ å™¨
        System.out.println("\n=== ä½¿ç”¨ç‰¹å®šæ„é€ å™¨åˆ›å»ºå¯¹è±¡ ===");
        
        // ä½¿ç”¨æ— å‚æ„é€ å™¨
        Constructor<?> noArgCons = clazz.getConstructor();
        Object obj1 = noArgCons.newInstance();
        System.out.println("åˆ›å»ºçš„å¯¹è±¡1ï¼š" + obj1);

        // ä½¿ç”¨å•å‚æ„é€ å™¨
        Constructor<?> oneArgCons = clazz.getConstructor(String.class);
        Object obj2 = oneArgCons.newInstance("Alice");
        System.out.println("åˆ›å»ºçš„å¯¹è±¡2ï¼š" + obj2);

        // âœ… 4. ä½¿ç”¨ç§æœ‰æ„é€ å™¨
        System.out.println("\n=== ä½¿ç”¨ç§æœ‰æ„é€ å™¨ ===");
        Constructor<?> privateCons = clazz.getDeclaredConstructor(String.class, int.class);
        privateCons.setAccessible(true); // å…³é”®ï¼šå–æ¶ˆè®¿é—®æ£€æŸ¥
        Object obj3 = privateCons.newInstance("Bob", 25);
        System.out.println("é€šè¿‡ç§æœ‰æ„é€ å™¨åˆ›å»ºçš„å¯¹è±¡ï¼š" + obj3);

        // âœ… 5. åˆ†ææ„é€ å™¨å‚æ•°
        System.out.println("\n=== æ„é€ å™¨å‚æ•°åˆ†æ ===");
        for (Constructor<?> c : allConstructors) {
            System.out.print("æ„é€ å™¨å‚æ•°ï¼š");
            Class<?>[] paramTypes = c.getParameterTypes();
            if (paramTypes.length == 0) {
                System.out.print("æ— å‚æ•°");
            } else {
                for (int i = 0; i < paramTypes.length; i++) {
                    System.out.print(paramTypes[i].getSimpleName());
                    if (i < paramTypes.length - 1) System.out.print(", ");
                }
            }
            System.out.println(" | å¯å˜å‚æ•°ï¼š" + c.isVarArgs());
        }

        // âœ… 6. ä½¿ç”¨å¯å˜å‚æ•°æ„é€ å™¨
        System.out.println("\n=== ä½¿ç”¨å¯å˜å‚æ•°æ„é€ å™¨ ===");
        Constructor<?> varArgsCons = clazz.getConstructor(String.class, String[].class);
        Object obj4 = varArgsCons.newInstance("Charlie", new String[]{"è¯»ä¹¦", "æ¸¸æ³³", "ç¼–ç¨‹"});
        System.out.println("å¯å˜å‚æ•°æ„é€ å™¨åˆ›å»ºçš„å¯¹è±¡ï¼š" + obj4);
    }
}
```

### 2.4 æ„é€ å™¨ä½¿ç”¨æœ€ä½³å®è·µ


**ğŸ’¡ å®ç”¨å·¥å…·æ–¹æ³•**
```java
public class ConstructorUtils {
    
    /**
     * å®‰å…¨åˆ›å»ºå¯¹è±¡å®ä¾‹
     */
    public static <T> T createInstance(Class<T> clazz, Object... args) {
        try {
            if (args.length == 0) {
                // æ— å‚æ„é€ å™¨
                return clazz.getDeclaredConstructor().newInstance();
            } else {
                // æ ¹æ®å‚æ•°ç±»å‹æŸ¥æ‰¾æ„é€ å™¨
                Class<?>[] paramTypes = new Class[args.length];
                for (int i = 0; i < args.length; i++) {
                    paramTypes[i] = args[i].getClass();
                }
                Constructor<T> constructor = clazz.getDeclaredConstructor(paramTypes);
                constructor.setAccessible(true);
                return constructor.newInstance(args);
            }
        } catch (Exception e) {
            throw new RuntimeException("åˆ›å»ºå®ä¾‹å¤±è´¥ï¼š" + clazz.getName(), e);
        }
    }
    
    /**
     * æ£€æŸ¥ç±»æ˜¯å¦æœ‰æ— å‚æ„é€ å™¨
     */
    public static boolean hasNoArgConstructor(Class<?> clazz) {
        try {
            clazz.getDeclaredConstructor();
            return true;
        } catch (NoSuchMethodException e) {
            return false;
        }
    }
}
```

---

## 3. ğŸ“„ è·å–å­—æ®µåå°„æ“ä½œ


### 3.1 å­—æ®µè·å–æ–¹æ³•


**ğŸ“‹ Fieldè·å–æ–¹æ³•è¡¨**

| æ–¹æ³• | **åŠŸèƒ½** | **è®¿é—®èŒƒå›´** |
|-----|---------|-------------|
| `getFields()` | è·å–æ‰€æœ‰`public`å­—æ®µï¼ˆåŒ…æ‹¬çˆ¶ç±»ç»§æ‰¿ï¼‰ | ä»…public |
| `getDeclaredFields()` | è·å–æ‰€æœ‰æœ¬ç±»ä¸­å£°æ˜çš„å­—æ®µï¼ˆåŒ…å«`private`ã€`protected`ã€é»˜è®¤ã€`public`ï¼‰ | æ‰€æœ‰è®¿é—®æƒé™ |
| `getField(String name)` | è·å–æŒ‡å®šåç§°çš„`public`å­—æ®µ | ä»…public |
| `getDeclaredField(String name)` | è·å–æœ¬ç±»ä¸­å£°æ˜çš„æŒ‡å®šå­—æ®µï¼ˆå¯ä¸º`private`ï¼‰ | æ‰€æœ‰è®¿é—®æƒé™ |

### 3.2 å­—æ®µæ“ä½œæ–¹æ³•


**ğŸ”§ Fieldæ“ä½œæ–¹æ³•è¡¨**

| æ–¹æ³• | **åŠŸèƒ½** | **è¿”å›ç±»å‹** |
|-----|---------|-------------|
| `getName()` | è·å–å­—æ®µå | `String` |
| `getType()` | è·å–å­—æ®µçš„æ•°æ®ç±»å‹ï¼ˆClasså¯¹è±¡ï¼‰ | `Class<?>` |
| `getModifiers()` | è·å–å­—æ®µä¿®é¥°ç¬¦ï¼ˆé…åˆ`Modifier`ç±»åˆ¤æ–­ï¼‰ | `int` |
| `setAccessible(true)` | å…³é—­è®¿é—®æ£€æŸ¥ï¼ˆè®¿é—®`private`å­—æ®µï¼‰ | `void` |
| `get(Object obj)` | è¯»å–å®ä¾‹å­—æ®µçš„å€¼ | `Object` |
| `set(Object obj, Object value)` | ä¿®æ”¹å®ä¾‹å­—æ®µçš„å€¼ | `void` |
| `get(null)` / `set(null, value)` | è®¿é—®`static`å­—æ®µæ—¶ï¼Œå®ä¾‹å‚æ•°ä¼ `null` | `Object` / `void` |

### 3.3 è¯¦ç»†ä»£ç ç¤ºä¾‹


**ğŸ’» å­—æ®µåå°„æ“ä½œå®Œæ•´ç¤ºä¾‹**
```java
import java.lang.reflect.*;

class Person {
    // å„ç§ä¿®é¥°ç¬¦çš„å­—æ®µ
    private String name = "Tom";
    public int age = 25;
    protected String email = "tom@example.com";
    String address = "Beijing"; // é»˜è®¤è®¿é—®æƒé™
    
    public static String country = "China";
    private static final String SPECIES = "Homo sapiens";
    
    public final String id = "ID-" + System.currentTimeMillis();
}

public class FieldReflectDemo {
    public static void main(String[] args) throws Exception {
        Class<?> clazz = Person.class;
        Object obj = clazz.getDeclaredConstructor().newInstance();

        // âœ… 1. è·å–æ‰€æœ‰å­—æ®µä¿¡æ¯
        System.out.println("=== æ‰€æœ‰å­—æ®µä¿¡æ¯ ===");
        Field[] allFields = clazz.getDeclaredFields();
        for (Field f : allFields) {
            System.out.printf("å­—æ®µï¼š%s %s %s = %s%n", 
                Modifier.toString(f.getModifiers()),
                f.getType().getSimpleName(),
                f.getName(),
                getFieldValueSafely(f, obj));
        }

        // âœ… 2. æ“ä½œpublicå®ä¾‹å­—æ®µ
        System.out.println("\n=== æ“ä½œpublicå­—æ®µ ===");
        Field ageField = clazz.getField("age");
        System.out.println("åŸå§‹ageå€¼: " + ageField.get(obj));
        ageField.set(obj, 30);
        System.out.println("ä¿®æ”¹åageå€¼: " + ageField.get(obj));

        // âœ… 3. æ“ä½œprivateå­—æ®µ
        System.out.println("\n=== æ“ä½œprivateå­—æ®µ ===");
        Field nameField = clazz.getDeclaredField("name");
        nameField.setAccessible(true); // å…³é”®ï¼šç»•è¿‡è®¿é—®æ§åˆ¶
        System.out.println("åŸå§‹nameå€¼: " + nameField.get(obj));
        nameField.set(obj, "Jerry");
        System.out.println("ä¿®æ”¹ånameå€¼: " + nameField.get(obj));

        // âœ… 4. æ“ä½œstaticå­—æ®µ
        System.out.println("\n=== æ“ä½œstaticå­—æ®µ ===");
        Field countryField = clazz.getDeclaredField("country");
        System.out.println("åŸå§‹countryå€¼: " + countryField.get(null));
        countryField.set(null, "USA");
        System.out.println("ä¿®æ”¹åcountryå€¼: " + countryField.get(null));
        
        // éªŒè¯staticå­—æ®µçš„ä¿®æ”¹å½±å“æ‰€æœ‰å®ä¾‹
        Object obj2 = clazz.getDeclaredConstructor().newInstance();
        System.out.println("æ–°å¯¹è±¡çœ‹åˆ°çš„countryå€¼: " + countryField.get(obj2));

        // âœ… 5. å°è¯•ä¿®æ”¹finalå­—æ®µï¼ˆæ¼”ç¤ºé™åˆ¶ï¼‰
        System.out.println("\n=== å°è¯•ä¿®æ”¹finalå­—æ®µ ===");
        try {
            Field idField = clazz.getDeclaredField("id");
            idField.setAccessible(true);
            System.out.println("åŸå§‹idå€¼: " + idField.get(obj));
            idField.set(obj, "MODIFIED-ID");
            System.out.println("å°è¯•ä¿®æ”¹åidå€¼: " + idField.get(obj));
        } catch (Exception e) {
            System.out.println("ä¿®æ”¹finalå­—æ®µå¯èƒ½å¤±è´¥: " + e.getMessage());
        }

        // âœ… 6. å­—æ®µç±»å‹åˆ¤æ–­
        System.out.println("\n=== å­—æ®µç±»å‹åˆ†æ ===");
        for (Field f : allFields) {
            analyzeField(f);
        }
    }
    
    /**
     * å®‰å…¨è·å–å­—æ®µå€¼
     */
    private static Object getFieldValueSafely(Field field, Object obj) {
        try {
            field.setAccessible(true);
            if (Modifier.isStatic(field.getModifiers())) {
                return field.get(null);
            } else {
                return field.get(obj);
            }
        } catch (Exception e) {
            return "æ— æ³•è®¿é—®";
        }
    }
    
    /**
     * åˆ†æå­—æ®µç‰¹æ€§
     */
    private static void analyzeField(Field field) {
        int modifiers = field.getModifiers();
        System.out.printf("å­—æ®µ %s: ", field.getName());
        
        if (Modifier.isStatic(modifiers)) System.out.print("[é™æ€] ");
        if (Modifier.isFinal(modifiers)) System.out.print("[æœ€ç»ˆ] ");
        if (Modifier.isPrivate(modifiers)) System.out.print("[ç§æœ‰] ");
        if (Modifier.isPublic(modifiers)) System.out.print("[å…¬å¼€] ");
        if (Modifier.isProtected(modifiers)) System.out.print("[å—ä¿æŠ¤] ");
        
        System.out.println("ç±»å‹: " + field.getType().getSimpleName());
    }
}
```

### 3.4 å­—æ®µæ“ä½œå·¥å…·ç±»


**ğŸ› ï¸ å®ç”¨å­—æ®µå·¥å…·æ–¹æ³•**
```java
public class FieldUtils {
    
    /**
     * å®‰å…¨è®¾ç½®å­—æ®µå€¼
     */
    public static void setFieldValue(Object obj, String fieldName, Object value) {
        try {
            Class<?> clazz = obj.getClass();
            Field field = clazz.getDeclaredField(fieldName);
            field.setAccessible(true);
            field.set(obj, value);
        } catch (Exception e) {
            throw new RuntimeException("è®¾ç½®å­—æ®µå€¼å¤±è´¥: " + fieldName, e);
        }
    }
    
    /**
     * å®‰å…¨è·å–å­—æ®µå€¼
     */
    public static Object getFieldValue(Object obj, String fieldName) {
        try {
            Class<?> clazz = obj.getClass();
            Field field = clazz.getDeclaredField(fieldName);
            field.setAccessible(true);
            return field.get(obj);
        } catch (Exception e) {
            throw new RuntimeException("è·å–å­—æ®µå€¼å¤±è´¥: " + fieldName, e);
        }
    }
    
    /**
     * å¤åˆ¶å¯¹è±¡å­—æ®µå€¼
     */
    public static void copyFields(Object source, Object target) {
        Class<?> sourceClass = source.getClass();
        Class<?> targetClass = target.getClass();
        
        for (Field sourceField : sourceClass.getDeclaredFields()) {
            try {
                Field targetField = targetClass.getDeclaredField(sourceField.getName());
                if (targetField.getType().equals(sourceField.getType())) {
                    sourceField.setAccessible(true);
                    targetField.setAccessible(true);
                    
                    Object value = sourceField.get(source);
                    targetField.set(target, value);
                }
            } catch (NoSuchFieldException e) {
                // ç›®æ ‡ç±»æ²¡æœ‰å¯¹åº”å­—æ®µï¼Œè·³è¿‡
            } catch (Exception e) {
                System.err.println("å¤åˆ¶å­—æ®µå¤±è´¥: " + sourceField.getName());
            }
        }
    }
}
```

---

## 4. âš™ï¸ è·å–æ–¹æ³•åå°„æ“ä½œ


### 4.1 æ–¹æ³•è·å–æ–¹æ³•


**ğŸ“‹ Methodè·å–æ–¹æ³•è¡¨**

| æ–¹æ³• | **åŠŸèƒ½** | **è®¿é—®èŒƒå›´** |
|-----|---------|-------------|
| `getMethods()` | è·å–æ‰€æœ‰`public`æ–¹æ³•ï¼ˆåŒ…æ‹¬ç»§æ‰¿è‡ªçˆ¶ç±»çš„ï¼‰ | ä»…public |
| `getDeclaredMethods()` | è·å–æœ¬ç±»ä¸­å£°æ˜çš„æ‰€æœ‰æ–¹æ³•ï¼ˆåŒ…å«`private`ï¼‰ | æ‰€æœ‰è®¿é—®æƒé™ |
| `getMethod(String name, Class<?>... parameterTypes)` | è·å–æŒ‡å®šåç§°å’Œå‚æ•°ç±»å‹çš„`public`æ–¹æ³• | ä»…public |
| `getDeclaredMethod(String name, Class<?>... parameterTypes)` | è·å–æŒ‡å®šåç§°å’Œå‚æ•°ç±»å‹çš„æœ¬ç±»æ–¹æ³•ï¼ˆåŒ…æ‹¬`private`ï¼‰ | æ‰€æœ‰è®¿é—®æƒé™ |

### 4.2 æ–¹æ³•æ“ä½œæ–¹æ³•


**ğŸ”§ Methodæ“ä½œæ–¹æ³•è¡¨**

| æ–¹æ³• | **åŠŸèƒ½** | **è¿”å›ç±»å‹** |
|-----|---------|-------------|
| `getName()` | è·å–æ–¹æ³•åç§° | `String` |
| `getReturnType()` | è·å–æ–¹æ³•è¿”å›ç±»å‹ï¼ˆ`Class`å¯¹è±¡ï¼‰ | `Class<?>` |
| `getParameterTypes()` | è·å–æ–¹æ³•å‚æ•°ç±»å‹æ•°ç»„ | `Class<?>[]` |
| `getModifiers()` | è·å–æ–¹æ³•ä¿®é¥°ç¬¦ï¼ˆé…åˆ`Modifier`ç±»åˆ¤æ–­ï¼‰ | `int` |
| `isVarArgs()` | åˆ¤æ–­æ–¹æ³•æ˜¯å¦ä¸ºå¯å˜å‚æ•° | `boolean` |
| `setAccessible(true)` | å…³é—­è®¿é—®æƒé™æ£€æŸ¥ï¼ˆè®¿é—®`private`æ–¹æ³•ï¼‰ | `void` |
| `invoke(Object obj, Object... args)` | è°ƒç”¨æ–¹æ³•ï¼Œ`obj`ä¸ºç›®æ ‡å®ä¾‹ï¼ˆ`static`æ–¹æ³•ä¼ `null`ï¼‰ | `Object` |
| `getDeclaringClass()` | è·å–æ–¹æ³•æ‰€å±çš„ç±»ï¼ˆè¿”å›`Class<?>`å¯¹è±¡ï¼‰ | `Class<?>` |

### 4.3 è¯¦ç»†ä»£ç ç¤ºä¾‹


**ğŸ’» æ–¹æ³•åå°„æ“ä½œå®Œæ•´ç¤ºä¾‹**
```java
import java.lang.reflect.*;

class Calculator {
    
    // å…¬å¼€æ–¹æ³•
    public int add(int a, int b) {
        return a + b;
    }
    
    // ç§æœ‰æ–¹æ³•
    private String formatResult(String operation, int result) {
        return String.format("%s = %d", operation, result);
    }
    
    // é™æ€æ–¹æ³•
    public static double multiply(double a, double b) {
        return a * b;
    }
    
    // å¯å˜å‚æ•°æ–¹æ³•
    public int sum(int... numbers) {
        int total = 0;
        for (int num : numbers) {
            total += num;
        }
        return total;
    }
    
    // é‡è½½æ–¹æ³•
    public String greet(String name) {
        return "Hello, " + name;
    }
    
    public String greet(String name, String title) {
        return "Hello, " + title + " " + name;
    }
}

public class MethodReflectDemo {
    public static void main(String[] args) throws Exception {
        Class<?> clazz = Calculator.class;
        Object obj = clazz.getDeclaredConstructor().newInstance();

        // âœ… 1. è·å–æ‰€æœ‰æ–¹æ³•ä¿¡æ¯
        System.out.println("=== æ‰€æœ‰æ–¹æ³•ä¿¡æ¯ ===");
        Method[] allMethods = clazz.getDeclaredMethods();
        for (Method m : allMethods) {
            System.out.printf("æ–¹æ³•ï¼š%s %s %s(", 
                Modifier.toString(m.getModifiers()),
                m.getReturnType().getSimpleName(),
                m.getName());
            
            Class<?>[] paramTypes = m.getParameterTypes();
            for (int i = 0; i < paramTypes.length; i++) {
                System.out.print(paramTypes[i].getSimpleName());
                if (i < paramTypes.length - 1) System.out.print(", ");
            }
            System.out.println(")");
        }

        // âœ… 2. è°ƒç”¨publicæ–¹æ³•
        System.out.println("\n=== è°ƒç”¨publicæ–¹æ³• ===");
        Method addMethod = clazz.getMethod("add", int.class, int.class);
        Object result1 = addMethod.invoke(obj, 10, 20);
        System.out.println("add(10, 20) = " + result1);

        // âœ… 3. è°ƒç”¨privateæ–¹æ³•
        System.out.println("\n=== è°ƒç”¨privateæ–¹æ³• ===");
        Method formatMethod = clazz.getDeclaredMethod("formatResult", String.class, int.class);
        formatMethod.setAccessible(true); // å…³é”®ï¼šç»•è¿‡è®¿é—®æ§åˆ¶
        Object result2 = formatMethod.invoke(obj, "10 + 20", 30);
        System.out.println("formatResult() = " + result2);

        // âœ… 4. è°ƒç”¨staticæ–¹æ³•
        System.out.println("\n=== è°ƒç”¨staticæ–¹æ³• ===");
        Method multiplyMethod = clazz.getMethod("multiply", double.class, double.class);
        Object result3 = multiplyMethod.invoke(null, 3.5, 2.0); // staticæ–¹æ³•objä¼ null
        System.out.println("multiply(3.5, 2.0) = " + result3);

        // âœ… 5. è°ƒç”¨å¯å˜å‚æ•°æ–¹æ³•
        System.out.println("\n=== è°ƒç”¨å¯å˜å‚æ•°æ–¹æ³• ===");
        Method sumMethod = clazz.getMethod("sum", int[].class);
        Object result4 = sumMethod.invoke(obj, new int[]{1, 2, 3, 4, 5});
        System.out.println("sum(1,2,3,4,5) = " + result4);

        // âœ… 6. è°ƒç”¨é‡è½½æ–¹æ³•
        System.out.println("\n=== è°ƒç”¨é‡è½½æ–¹æ³• ===");
        Method greet1 = clazz.getMethod("greet", String.class);
        Method greet2 = clazz.getMethod("greet", String.class, String.class);
        
        Object result5 = greet1.invoke(obj, "Alice");
        Object result6 = greet2.invoke(obj, "Bob", "Mr.");
        System.out.println("greet(\"Alice\") = " + result5);
        System.out.println("greet(\"Bob\", \"Mr.\") = " + result6);

        // âœ… 7. æ–¹æ³•ç‰¹æ€§åˆ†æ
        System.out.println("\n=== æ–¹æ³•ç‰¹æ€§åˆ†æ ===");
        for (Method m : allMethods) {
            analyzeMethod(m);
        }
    }
    
    /**
     * åˆ†ææ–¹æ³•ç‰¹æ€§
     */
    private static void analyzeMethod(Method method) {
        int modifiers = method.getModifiers();
        System.out.printf("æ–¹æ³• %s: ", method.getName());
        
        if (Modifier.isStatic(modifiers)) System.out.print("[é™æ€] ");
        if (Modifier.isPrivate(modifiers)) System.out.print("[ç§æœ‰] ");
        if (Modifier.isPublic(modifiers)) System.out.print("[å…¬å¼€] ");
        if (Modifier.isFinal(modifiers)) System.out.print("[æœ€ç»ˆ] ");
        if (method.isVarArgs()) System.out.print("[å¯å˜å‚æ•°] ");
        
        System.out.println("è¿”å›ç±»å‹: " + method.getReturnType().getSimpleName());
    }
}
```

### 4.4 æ–¹æ³•è°ƒç”¨å·¥å…·ç±»


**ğŸ› ï¸ å®ç”¨æ–¹æ³•è°ƒç”¨å·¥å…·**
```java
public class MethodUtils {
    
    /**
     * å®‰å…¨è°ƒç”¨æ–¹æ³•
     */
    public static Object invokeMethod(Object obj, String methodName, Object... args) {
        try {
            Class<?> clazz = obj.getClass();
            
            // æ ¹æ®å‚æ•°ç±»å‹æŸ¥æ‰¾æ–¹æ³•
            Class<?>[] paramTypes = new Class[args.length];
            for (int i = 0; i < args.length; i++) {
                paramTypes[i] = args[i].getClass();
            }
            
            Method method = clazz.getDeclaredMethod(methodName, paramTypes);
            method.setAccessible(true);
            return method.invoke(obj, args);
        } catch (Exception e) {
            throw new RuntimeException("æ–¹æ³•è°ƒç”¨å¤±è´¥: " + methodName, e);
        }
    }
    
    /**
     * è°ƒç”¨é™æ€æ–¹æ³•
     */
    public static Object invokeStaticMethod(Class<?> clazz, String methodName, Object... args) {
        try {
            Class<?>[] paramTypes = new Class[args.length];
            for (int i = 0; i < args.length; i++) {
                paramTypes[i] = args[i].getClass();
            }
            
            Method method = clazz.getDeclaredMethod(methodName, paramTypes);
            method.setAccessible(true);
            return method.invoke(null, args);
        } catch (Exception e) {
            throw new RuntimeException("é™æ€æ–¹æ³•è°ƒç”¨å¤±è´¥: " + methodName, e);
        }
    }
    
    /**
     * æ£€æŸ¥æ–¹æ³•æ˜¯å¦å­˜åœ¨
     */
    public static boolean hasMethod(Class<?> clazz, String methodName, Class<?>... paramTypes) {
        try {
            clazz.getDeclaredMethod(methodName, paramTypes);
            return true;
        } catch (NoSuchMethodException e) {
            return false;
        }
    }
}
```

---

## 5. ğŸ“š è·å–æ•°ç»„åå°„æ“ä½œ


### 5.1 æ•°ç»„æ“ä½œæ–¹æ³•


**ğŸ“‹ Arrayæ ¸å¿ƒæ–¹æ³•è¡¨**

| æ–¹æ³• | **åŠŸèƒ½** | **è¿”å›ç±»å‹** |
|-----|---------|-------------|
| `Array.newInstance(Class<?> componentType, int length)` | åˆ›å»ºæŒ‡å®šç±»å‹å’Œé•¿åº¦çš„ä¸€ç»´æ•°ç»„ | `Object` |
| `Array.newInstance(Class<?> componentType, int... dimensions)` | åˆ›å»ºå¤šç»´æ•°ç»„ | `Object` |
| `Array.getLength(Object array)` | è·å–æ•°ç»„çš„é•¿åº¦ | `int` |
| `Array.get(Object array, int index)` | è·å–æŒ‡å®šç´¢å¼•ä½ç½®çš„æ•°ç»„å…ƒç´ ï¼ˆé€šç”¨ï¼‰ | `Object` |
| `Array.set(Object array, int index, Object value)` | è®¾ç½®æŒ‡å®šç´¢å¼•ä½ç½®çš„æ•°ç»„å…ƒç´ ï¼ˆé€šç”¨ï¼‰ | `void` |
| `Array.getInt/getBoolean/...` | è·å–åŸºæœ¬ç±»å‹æ•°ç»„å…ƒç´ çš„å€¼ | å¯¹åº”åŸºæœ¬ç±»å‹ |
| `Array.setInt/setBoolean/...` | è®¾ç½®åŸºæœ¬ç±»å‹æ•°ç»„å…ƒç´ çš„å€¼ | `void` |

### 5.2 æ•°ç»„åˆ¤æ–­æ–¹æ³•


**ğŸ” æ•°ç»„ç±»å‹åˆ¤æ–­**

| æ–¹æ³• | **åŠŸèƒ½** | **è¿”å›ç±»å‹** |
|-----|---------|-------------|
| `arrayObject.getClass().isArray()` | åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºæ•°ç»„ | `boolean` |
| `arrayObject.getClass().getComponentType()` | è·å–æ•°ç»„çš„å…ƒç´ ç±»å‹ | `Class<?>` |

### 5.3 è¯¦ç»†ä»£ç ç¤ºä¾‹


**ğŸ’» æ•°ç»„åå°„æ“ä½œå®Œæ•´ç¤ºä¾‹**
```java
import java.lang.reflect.Array;

public class ArrayReflectDemo {
    public static void main(String[] args) {
        
        // âœ… 1. åˆ›å»ºä¸€ç»´æ•°ç»„ï¼šString[5]
        System.out.println("=== åˆ›å»ºä¸€ç»´æ•°ç»„ ===");
        Object stringArray = Array.newInstance(String.class, 5);
        
        // è®¾ç½®æ•°ç»„å…ƒç´ 
        Array.set(stringArray, 0, "Java");
        Array.set(stringArray, 1, "Reflection");
        Array.set(stringArray, 2, "Array");
        Array.set(stringArray, 3, "Demo");
        Array.set(stringArray, 4, "Example");

        // è·å–æ•°ç»„ä¿¡æ¯
        int length = Array.getLength(stringArray);
        System.out.println("æ•°ç»„é•¿åº¦: " + length);
        System.out.println("æ•°ç»„ç±»å‹: " + stringArray.getClass().getName());
        System.out.println("å…ƒç´ ç±»å‹: " + stringArray.getClass().getComponentType().getSimpleName());

        // è¯»å–å¹¶æ‰“å°æ•°ç»„å…ƒç´ 
        System.out.println("æ•°ç»„å†…å®¹:");
        for (int i = 0; i < length; i++) {
            System.out.println("  [" + i + "] = " + Array.get(stringArray, i));
        }

        // âœ… 2. åˆ›å»ºåŸºæœ¬ç±»å‹æ•°ç»„ï¼šint[4]
        System.out.println("\n=== åˆ›å»ºåŸºæœ¬ç±»å‹æ•°ç»„ ===");
        Object intArray = Array.newInstance(int.class, 4);
        
        // ä½¿ç”¨ä¸“ç”¨æ–¹æ³•è®¾ç½®åŸºæœ¬ç±»å‹æ•°ç»„ï¼ˆæ€§èƒ½æ›´å¥½ï¼‰
        Array.setInt(intArray, 0, 10);
        Array.setInt(intArray, 1, 20);
        Array.setInt(intArray, 2, 30);
        Array.setInt(intArray, 3, 40);

        System.out.println("intæ•°ç»„å†…å®¹:");
        for (int i = 0; i < Array.getLength(intArray); i++) {
            System.out.println("  [" + i + "] = " + Array.getInt(intArray, i));
        }

        // âœ… 3. åˆ›å»ºäºŒç»´æ•°ç»„ï¼šString[3][4]
        System.out.println("\n=== åˆ›å»ºäºŒç»´æ•°ç»„ ===");
        Object twoDArray = Array.newInstance(String.class, 3, 4);
        
        // æ“ä½œäºŒç»´æ•°ç»„
        for (int i = 0; i < 3; i++) {
            Object row = Array.get(twoDArray, i); // è·å–è¡Œ
            for (int j = 0; j < 4; j++) {
                Array.set(row, j, "(" + i + "," + j + ")");
            }
        }

        // æ‰“å°äºŒç»´æ•°ç»„
        System.out.println("äºŒç»´æ•°ç»„å†…å®¹:");
        for (int i = 0; i < 3; i++) {
            Object row = Array.get(twoDArray, i);
            System.out.print("  è¡Œ" + i + ": ");
            for (int j = 0; j < 4; j++) {
                System.out.print(Array.get(row, j) + " ");
            }
            System.out.println();
        }

        // âœ… 4. åˆ›å»ºä¸è§„åˆ™æ•°ç»„ï¼šint[][]
        System.out.println("\n=== åˆ›å»ºä¸è§„åˆ™æ•°ç»„ ===");
        Object irregularArray = Array.newInstance(int[].class, 3);
        
        // ä¸ºæ¯ä¸€è¡Œåˆ›å»ºä¸åŒé•¿åº¦çš„æ•°ç»„
        Array.set(irregularArray, 0, Array.newInstance(int.class, 2));
        Array.set(irregularArray, 1, Array.newInstance(int.class, 3));
        Array.set(irregularArray, 2, Array.newInstance(int.class, 4));

        // å¡«å……æ•°æ®
        for (int i = 0; i < 3; i++) {
            Object row = Array.get(irregularArray, i);
            int rowLength = Array.getLength(row);
            for (int j = 0; j < rowLength; j++) {
                Array.setInt(row, j, (i + 1) * 10 + j);
            }
        }

        // æ‰“å°ä¸è§„åˆ™æ•°ç»„
        System.out.println("ä¸è§„åˆ™æ•°ç»„å†…å®¹:");
        for (int i = 0; i < 3; i++) {
            Object row = Array.get(irregularArray, i);
            int rowLength = Array.getLength(row);
            System.out.print("  è¡Œ" + i + ": ");
            for (int j = 0; j < rowLength; j++) {
                System.out.print(Array.getInt(row, j) + " ");
            }
            System.out.println();
        }

        // âœ… 5. æ•°ç»„ç±»å‹åˆ†æ
        System.out.println("\n=== æ•°ç»„ç±»å‹åˆ†æ ===");
        analyzeArray(stringArray);
        analyzeArray(intArray);
        analyzeArray(twoDArray);
        
        // âœ… 6. ä¸æ™®é€šæ•°ç»„å¯¹æ¯”
        System.out.println("\n=== ä¸æ™®é€šæ•°ç»„å¯¹æ¯” ===");
        String[] normalArray = {"A", "B", "C"};
        analyzeArray(normalArray);
        
        // éªŒè¯ä¸¤ç§æ–¹å¼åˆ›å»ºçš„æ•°ç»„æ˜¯ç›¸åŒçš„
        Object reflectArray = Array.newInstance(String.class, 3);
        Array.set(reflectArray, 0, "A");
        Array.set(reflectArray, 1, "B");
        Array.set(reflectArray, 2, "C");
        
        System.out.println("æ™®é€šæ•°ç»„ç±»å‹: " + normalArray.getClass().getName());
        System.out.println("åå°„æ•°ç»„ç±»å‹: " + reflectArray.getClass().getName());
        System.out.println("ç±»å‹ç›¸åŒ: " + normalArray.getClass().equals(reflectArray.getClass()));
    }
    
    /**
     * åˆ†ææ•°ç»„ç‰¹æ€§
     */
    private static void analyzeArray(Object array) {
        Class<?> arrayClass = array.getClass();
        if (arrayClass.isArray()) {
            System.out.printf("æ•°ç»„åˆ†æ: %s%n", arrayClass.getName());
            System.out.printf("  å…ƒç´ ç±»å‹: %s%n", arrayClass.getComponentType().getSimpleName());
            System.out.printf("  é•¿åº¦: %d%n", Array.getLength(array));
            System.out.printf("  ç»´åº¦: %d%n", getDimensions(arrayClass));
        } else {
            System.out.println("ä¸æ˜¯æ•°ç»„ç±»å‹: " + arrayClass.getName());
        }
    }
    
    /**
     * è®¡ç®—æ•°ç»„ç»´åº¦
     */
    private static int getDimensions(Class<?> arrayClass) {
        int dimensions = 0;
        while (arrayClass.isArray()) {
            dimensions++;
            arrayClass = arrayClass.getComponentType();
        }
        return dimensions;
    }
}
```

### 5.4 æ•°ç»„å·¥å…·ç±»


**ğŸ› ï¸ å®ç”¨æ•°ç»„å·¥å…·æ–¹æ³•**
```java
public class ArrayUtils {
    
    /**
     * åˆ›å»ºå¹¶åˆå§‹åŒ–æ•°ç»„
     */
    public static Object createArray(Class<?> componentType, Object... elements) {
        Object array = Array.newInstance(componentType, elements.length);
        for (int i = 0; i < elements.length; i++) {
            Array.set(array, i, elements[i]);
        }
        return array;
    }
    
    /**
     * æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²
     */
    public static String arrayToString(Object array) {
        if (!array.getClass().isArray()) {
            return "ä¸æ˜¯æ•°ç»„ç±»å‹";
        }
        
        StringBuilder sb = new StringBuilder("[");
        int length = Array.getLength(array);
        for (int i = 0; i < length; i++) {
            if (i > 0) sb.append(", ");
            Object element = Array.get(array, i);
            if (element != null && element.getClass().isArray()) {
                sb.append(arrayToString(element)); // é€’å½’å¤„ç†å¤šç»´æ•°ç»„
            } else {
                sb.append(element);
            }
        }
        sb.append("]");
        return sb.toString();
    }
    
    /**
     * å¤åˆ¶æ•°ç»„
     */
    public static Object copyArray(Object sourceArray) {
        if (!sourceArray.getClass().isArray()) {
            throw new IllegalArgumentException("ä¸æ˜¯æ•°ç»„ç±»å‹");
        }
        
        Class<?> componentType = sourceArray.getClass().getComponentType();
        int length = Array.getLength(sourceArray);
        Object newArray = Array.newInstance(componentType, length);
        
        for (int i = 0; i < length; i++) {
            Array.set(newArray, i, Array.get(sourceArray, i));
        }
        
        return newArray;
    }
}
```

---

## 6. ğŸ“ è·å–æ³¨è§£åå°„æ“ä½œ


### 6.1 æ³¨è§£è·å–æ–¹æ³•


**ğŸ“‹ Annotationè·å–æ–¹æ³•è¡¨**

| æ–¹æ³• | **åŠŸèƒ½** | **è¿”å›ç±»å‹** |
|-----|---------|-------------|
| `isAnnotationPresent(Class<? extends Annotation> annotationClass)` | åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŒ‡å®šæ³¨è§£ | `boolean` |
| `<T extends Annotation> getAnnotation(Class<T> annotationClass)` | è·å–æŒ‡å®šç±»å‹çš„æ³¨è§£å¯¹è±¡ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ | `T` |
| `getAnnotations()` | è·å–æ‰€æœ‰å¯ç»§æ‰¿çš„æ³¨è§£ï¼ˆåŒ…å«çˆ¶ç±»æ³¨è§£ï¼Œå—`@Inherited`å½±å“ï¼‰ | `Annotation[]` |
| `getDeclaredAnnotations()` | è·å–å½“å‰å…ƒç´ ä¸Šå£°æ˜çš„æ‰€æœ‰æ³¨è§£ï¼ˆä¸åŒ…å«ç»§æ‰¿ï¼‰ | `Annotation[]` |

### 6.2 æ³¨è§£å±æ€§è®¿é—®


**ğŸ” æ³¨è§£å±æ€§è·å–**

| æ–¹æ³• | **åŠŸèƒ½** | **è¿”å›ç±»å‹** |
|-----|---------|-------------|
| `Annotation.annotationType()` | è·å–æ³¨è§£çš„Classç±»å‹ | `Class<? extends Annotation>` |
| `annotation.value()` / `annotation.å±æ€§å()` | è·å–æ³¨è§£ä¸­çš„å±æ€§å€¼ï¼ˆé€šè¿‡ä»£ç†å¯¹è±¡ï¼‰ | å¯¹åº”å±æ€§ç±»å‹ |

### 6.3 è¯¦ç»†ä»£ç ç¤ºä¾‹


**ğŸ’» æ³¨è§£åå°„æ“ä½œå®Œæ•´ç¤ºä¾‹**
```java
import java.lang.annotation.*;
import java.lang.reflect.*;

// âœ… è‡ªå®šä¹‰æ³¨è§£ - ç±»çº§åˆ«
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
@interface ClassInfo {
    String author();
    String version() default "1.0";
    String[] tags() default {};
}

// âœ… è‡ªå®šä¹‰æ³¨è§£ - æ–¹æ³•çº§åˆ«
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
@interface MethodInfo {
    String description();
    int priority() default 1;
    boolean deprecated() default false;
}

// âœ… è‡ªå®šä¹‰æ³¨è§£ - å­—æ®µçº§åˆ«
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.FIELD)
@interface FieldInfo {
    String name();
    boolean required() default true;
}

// âœ… å¯ç»§æ‰¿æ³¨è§£
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
@Inherited
@interface InheritableInfo {
    String value();
}

// âœ… ä½¿ç”¨æ³¨è§£çš„çˆ¶ç±»
@InheritableInfo("å¯ç»§æ‰¿æ³¨è§£")
class BaseClass {
    @FieldInfo(name = "åŸºç±»å­—æ®µ")
    protected String baseField;
    
    @MethodInfo(description = "åŸºç±»æ–¹æ³•")
    public void baseMethod() {}
}

// âœ… ä½¿ç”¨æ³¨è§£çš„ç±»
@ClassInfo(
    author = "å¼ ä¸‰", 
    version = "2.0", 
    tags = {"å·¥å…·ç±»", "ç¤ºä¾‹"}
)
class Person extends BaseClass {
    
    @FieldInfo(name = "å§“å", required = true)
    private String name;
    
    @FieldInfo(name = "å¹´é¾„", required = false)
    private int age;
    
    @MethodInfo(description = "æ‰“æ‹›å‘¼æ–¹æ³•", priority = 2)
    public void sayHello() {
        System.out.println("Hello!");
    }
    
    @MethodInfo(description = "åºŸå¼ƒçš„æ–¹æ³•", deprecated = true)
    @Deprecated
    public void oldMethod() {
        System.out.println("This is deprecated");
    }
}

public class AnnotationReflectDemo {
    public static void main(String[] args) throws Exception {
        Class<Person> clazz = Person.class;

        // âœ… 1. è·å–ç±»ä¸Šçš„æ³¨è§£
        System.out.println("=== ç±»çº§åˆ«æ³¨è§£åˆ†æ ===");
        if (clazz.isAnnotationPresent(ClassInfo.class)) {
            ClassInfo classInfo = clazz.getAnnotation(ClassInfo.class);
            System.out.println("ä½œè€…: " + classInfo.author());
            System.out.println("ç‰ˆæœ¬: " + classInfo.version());
            System.out.print("æ ‡ç­¾: ");
            for (String tag : classInfo.tags()) {
                System.out.print(tag + " ");
            }
            System.out.println();
        }

        // âœ… 2. æ£€æŸ¥å¯ç»§æ‰¿æ³¨è§£
        System.out.println("\n=== å¯ç»§æ‰¿æ³¨è§£åˆ†æ ===");
        if (clazz.isAnnotationPresent(InheritableInfo.class)) {
            InheritableInfo inheritableInfo = clazz.getAnnotation(InheritableInfo.class);
            System.out.println("ç»§æ‰¿çš„æ³¨è§£å€¼: " + inheritableInfo.value());
        }

        // âœ… 3. è·å–æ‰€æœ‰ç±»çº§åˆ«æ³¨è§£
        System.out.println("\n=== æ‰€æœ‰ç±»çº§åˆ«æ³¨è§£ ===");
        Annotation[] classAnnotations = clazz.getAnnotations();
        for (Annotation annotation : classAnnotations) {
            System.out.println("æ³¨è§£ç±»å‹: " + annotation.annotationType().getSimpleName());
        }

        // âœ… 4. åˆ†æå­—æ®µæ³¨è§£
        System.out.println("\n=== å­—æ®µæ³¨è§£åˆ†æ ===");
        Field[] fields = clazz.getDeclaredFields();
        for (Field field : fields) {
            if (field.isAnnotationPresent(FieldInfo.class)) {
                FieldInfo fieldInfo = field.getAnnotation(FieldInfo.class);
                System.out.printf("å­—æ®µ %s: åç§°='%s', å¿…éœ€=%s%n", 
                    field.getName(), 
                    fieldInfo.name(), 
                    fieldInfo.required());
            }
        }

        // âœ… 5. åˆ†ææ–¹æ³•æ³¨è§£
        System.out.println("\n=== æ–¹æ³•æ³¨è§£åˆ†æ ===");
        Method[] methods = clazz.getDeclaredMethods();
        for (Method method : methods) {
            System.out.println("\næ–¹æ³•: " + method.getName());
            
            // æ£€æŸ¥è‡ªå®šä¹‰æ³¨è§£
            if (method.isAnnotationPresent(MethodInfo.class)) {
                MethodInfo methodInfo = method.getAnnotation(MethodInfo.class);
                System.out.println("  æè¿°: " + methodInfo.description());
                System.out.println("  ä¼˜å…ˆçº§: " + methodInfo.priority());
                System.out.println("  æ˜¯å¦åºŸå¼ƒ: " + methodInfo.deprecated());
            }
            
            // æ£€æŸ¥æ ‡å‡†æ³¨è§£
            if (method.isAnnotationPresent(Deprecated.class)) {
                System.out.println("  âš ï¸ æ ‡è®°ä¸º@Deprecated");
            }
            
            // è·å–æ‰€æœ‰æ–¹æ³•æ³¨è§£
            Annotation[] methodAnnotations = method.getAnnotations();
            if (methodAnnotations.length > 0) {
                System.out.print("  æ‰€æœ‰æ³¨è§£: ");
                for (Annotation ann : methodAnnotations) {
                    System.out.print(ann.annotationType().getSimpleName() + " ");
                }
                System.out.println();
            }
        }

        // âœ… 6. æ³¨è§£å±æ€§è¯¦ç»†åˆ†æ
        System.out.println("\n=== æ³¨è§£å±æ€§è¯¦ç»†åˆ†æ ===");
        analyzeAnnotationProperties();

        // âœ… 7. ç»§æ‰¿æ³¨è§£å¯¹æ¯”
        System.out.println("\n=== ç»§æ‰¿æ³¨è§£å¯¹æ¯” ===");
        compareInheritedAnnotations();
    }
    
    /**
     * åˆ†ææ³¨è§£å±æ€§
     */
    private static void analyzeAnnotationProperties() throws Exception {
        Class<Person> clazz = Person.class;
        ClassInfo classInfo = clazz.getAnnotation(ClassInfo.class);
        
        if (classInfo != null) {
            // é€šè¿‡åå°„è·å–æ³¨è§£çš„æ‰€æœ‰æ–¹æ³•ï¼ˆå±æ€§ï¼‰
            Method[] annotationMethods = ClassInfo.class.getDeclaredMethods();
            System.out.println("ClassInfoæ³¨è§£çš„æ‰€æœ‰å±æ€§:");
            
            for (Method method : annotationMethods) {
                String propertyName = method.getName();
                Object value = method.invoke(classInfo);
                
                System.out.printf("  %s = %s (ç±»å‹: %s)%n", 
                    propertyName, 
                    value instanceof String[] ? java.util.Arrays.toString((String[])value) : value,
                    method.getReturnType().getSimpleName());
            }
        }
    }
    
    /**
     * æ¯”è¾ƒç»§æ‰¿çš„æ³¨è§£
     */
    private static void compareInheritedAnnotations() {
        Class<Person> childClass = Person.class;
        Class<BaseClass> parentClass = BaseClass.class;
        
        System.out.println("çˆ¶ç±»æ³¨è§£:");
        for (Annotation ann : parentClass.getAnnotations()) {
            System.out.println("  " + ann.annotationType().getSimpleName());
        }
        
        System.out.println("å­ç±»ç»§æ‰¿çš„æ³¨è§£:");
        for (Annotation ann : childClass.getAnnotations()) {
            System.out.println("  " + ann.annotationType().getSimpleName());
        }
        
        System.out.println("å­ç±»å£°æ˜çš„æ³¨è§£:");
        for (Annotation ann : childClass.getDeclaredAnnotations()) {
            System.out.println("  " + ann.annotationType().getSimpleName());
        }
    }
}
```

### 6.4 æ³¨è§£å¤„ç†å·¥å…·ç±»


**ğŸ› ï¸ å®ç”¨æ³¨è§£å¤„ç†å·¥å…·**
```java
import java.lang.annotation.Annotation;
import java.lang.reflect.*;
import java.util.*;

public class AnnotationUtils {
    
    /**
     * è·å–ç±»åŠå…¶æ‰€æœ‰æˆå‘˜çš„æ³¨è§£ä¿¡æ¯
     */
    public static Map<String, List<Annotation>> getAllAnnotations(Class<?> clazz) {
        Map<String, List<Annotation>> annotationMap = new HashMap<>();
        
        // ç±»æ³¨è§£
        annotationMap.put("CLASS", Arrays.asList(clazz.getAnnotations()));
        
        // å­—æ®µæ³¨è§£
        for (Field field : clazz.getDeclaredFields()) {
            if (field.getAnnotations().length > 0) {
                annotationMap.put("FIELD:" + field.getName(), 
                    Arrays.asList(field.getAnnotations()));
            }
        }
        
        // æ–¹æ³•æ³¨è§£
        for (Method method : clazz.getDeclaredMethods()) {
            if (method.getAnnotations().length > 0) {
                annotationMap.put("METHOD:" + method.getName(), 
                    Arrays.asList(method.getAnnotations()));
            }
        }
        
        // æ„é€ å™¨æ³¨è§£
        for (Constructor<?> constructor : clazz.getDeclaredConstructors()) {
            if (constructor.getAnnotations().length > 0) {
                annotationMap.put("CONSTRUCTOR:" + constructor.toString(), 
                    Arrays.asList(constructor.getAnnotations()));
            }
        }
        
        return annotationMap;
    }
    
    /**
     * æ£€æŸ¥ç±»æ˜¯å¦åŒ…å«æŒ‡å®šæ³¨è§£
     */
    public static boolean hasAnnotation(Class<?> clazz, Class<? extends Annotation> annotationType) {
        // æ£€æŸ¥ç±»æœ¬èº«
        if (clazz.isAnnotationPresent(annotationType)) {
            return true;
        }
        
        // æ£€æŸ¥å­—æ®µ
        for (Field field : clazz.getDeclaredFields()) {
            if (field.isAnnotationPresent(annotationType)) {
                return true;
            }
        }
        
        // æ£€æŸ¥æ–¹æ³•
        for (Method method : clazz.getDeclaredMethods()) {
            if (method.isAnnotationPresent(annotationType)) {
                return true;
            }
        }
        
        return false;
    }
    
    /**
     * è·å–å¸¦æœ‰æŒ‡å®šæ³¨è§£çš„å­—æ®µ
     */
    public static List<Field> getFieldsWithAnnotation(Class<?> clazz, 
            Class<? extends Annotation> annotationType) {
        List<Field> result = new ArrayList<>();
        for (Field field : clazz.getDeclaredFields()) {
            if (field.isAnnotationPresent(annotationType)) {
                result.add(field);
            }
        }
        return result;
    }
    
    /**
     * è·å–å¸¦æœ‰æŒ‡å®šæ³¨è§£çš„æ–¹æ³•
     */
    public static List<Method> getMethodsWithAnnotation(Class<?> clazz, 
            Class<? extends Annotation> annotationType) {
        List<Method> result = new ArrayList<>();
        for (Method method : clazz.getDeclaredMethods()) {
            if (method.isAnnotationPresent(annotationType)) {
                result.add(method);
            }
        }
        return result;
    }
}
```

---

## 7. ğŸ”“ è®¿é—®æ§åˆ¶ç»•è¿‡


### 7.1 è®¿é—®æ§åˆ¶æœºåˆ¶


**ğŸ”’ Javaè®¿é—®æ§åˆ¶åŸç†**
Javaå‡ºäºå°è£…æ€§è€ƒè™‘ï¼Œä¸å…è®¸ç›´æ¥è®¿é—®ç±»çš„ç§æœ‰æˆå‘˜ã€‚ä½†é€šè¿‡åå°„é…åˆä»¥ä¸‹æ–¹æ³•ï¼Œå¯ä»¥ç»•è¿‡JVMçš„è®¿é—®æ£€æŸ¥æœºåˆ¶ï¼š

```java
// AccessibleObjectæ˜¯Fieldã€Methodã€Constructorçš„çˆ¶ç±» 
AccessibleObject.setAccessible(true);  // æ ¸å¿ƒè¯­å¥
```

### 7.2 å¯ç»•è¿‡çš„æˆå‘˜ç±»å‹


**ğŸ“‹ è®¿é—®æ§åˆ¶ç»•è¿‡èƒ½åŠ›è¡¨**

| æˆå‘˜ç±»å‹ | **ç¤ºä¾‹ç±»** | **ç¤ºä¾‹æ“ä½œ** |
|---------|-----------|-------------|
| **ç§æœ‰å­—æ®µ** | `Field` | `field.setAccessible(true)` åå¯è¯»å†™ç§æœ‰å­—æ®µ |
| **ç§æœ‰æ–¹æ³•** | `Method` | `method.setAccessible(true)` åå¯è°ƒç”¨ç§æœ‰æ–¹æ³• |
| **ç§æœ‰æ„é€ å™¨** | `Constructor` | `constructor.setAccessible(true)` åå¯å®ä¾‹åŒ–å¯¹è±¡ |


### 7.3 è¯¦ç»†ä»£ç ç¤ºä¾‹


**ğŸ’» è®¿é—®æ§åˆ¶ç»•è¿‡å®Œæ•´ç¤ºä¾‹**
```java
import java.lang.reflect.*;

class SecretClass {
    // ç§æœ‰é™æ€å­—æ®µ
    private static String SECRET_KEY = "TopSecret123";
    
    // ç§æœ‰å®ä¾‹å­—æ®µ
    private String secretValue = "InstanceSecret";
    private final String finalSecret = "FinalSecret";
    
    // ç§æœ‰æ„é€ å™¨
    private SecretClass(String value) {
        this.secretValue = value;
        System.out.println("ç§æœ‰æ„é€ å™¨è¢«è°ƒç”¨: " + value);
    }
    
    // ç§æœ‰é™æ€æ–¹æ³•
    private static String getSecretKey() {
        return "è·å–åˆ°å¯†é’¥: " + SECRET_KEY;
    }
    
    // ç§æœ‰å®ä¾‹æ–¹æ³•
    private void revealSecret(String message) {
        System.out.println("æ­ç¤ºç§˜å¯†: " + message + " -> " + secretValue);
    }
    
    // ç§æœ‰å†…éƒ¨ç±»
    private static class InnerSecret {
        private String innerValue = "å†…éƒ¨ç§˜å¯†";
        
        private void showInnerSecret() {
            System.out.println("å†…éƒ¨ç§˜å¯†: " + innerValue);
        }
    }
    
    @Override
    public String toString() {
        return "SecretClass{secretValue='" + secretValue + "'}";
    }
}

public class AccessBypassDemo {
    public static void main(String[] args) throws Exception {
        Class<?> clazz = SecretClass.class;

        // âœ… 1. ç»•è¿‡ç§æœ‰æ„é€ å™¨è®¿é—®é™åˆ¶
        System.out.println("=== è®¿é—®ç§æœ‰æ„é€ å™¨ ===");
        Constructor<?> privateCons = clazz.getDeclaredConstructor(String.class);
        privateCons.setAccessible(true); // å…³é”®ï¼šç»•è¿‡è®¿é—®æ§åˆ¶
        Object obj = privateCons.newInstance("é€šè¿‡åå°„åˆ›å»º");
        System.out.println("åˆ›å»ºçš„å¯¹è±¡: " + obj);

        // âœ… 2. ç»•è¿‡ç§æœ‰å­—æ®µè®¿é—®é™åˆ¶
        System.out.println("\n=== è®¿é—®ç§æœ‰å­—æ®µ ===");
        
        // è®¿é—®ç§æœ‰å®ä¾‹å­—æ®µ
        Field secretField = clazz.getDeclaredField("secretValue");
        secretField.setAccessible(true);
        System.out.println("åŸå§‹secretValue: " + secretField.get(obj));
        secretField.set(obj, "ä¿®æ”¹åçš„ç§˜å¯†");
        System.out.println("ä¿®æ”¹åsecretValue: " + secretField.get(obj));
        
        // è®¿é—®ç§æœ‰é™æ€å­—æ®µ
        Field staticSecretField = clazz.getDeclaredField("SECRET_KEY");
        staticSecretField.setAccessible(true);
        System.out.println("åŸå§‹SECRET_KEY: " + staticSecretField.get(null));
        staticSecretField.set(null, "æ–°çš„å¯†é’¥456");
        System.out.println("ä¿®æ”¹åSECRET_KEY: " + staticSecretField.get(null));
        
        // å°è¯•ä¿®æ”¹finalå­—æ®µ
        Field finalField = clazz.getDeclaredField("finalSecret");
        finalField.setAccessible(true);
        System.out.println("finalå­—æ®µå€¼: " + finalField.get(obj));
        try {
            finalField.set(obj, "å°è¯•ä¿®æ”¹final");
            System.out.println("finalå­—æ®µä¿®æ”¹å: " + finalField.get(obj));
        } catch (Exception e) {
            System.out.println("ä¿®æ”¹finalå­—æ®µå¯èƒ½å—é™: " + e.getMessage());
        }

        // âœ… 3. ç»•è¿‡ç§æœ‰æ–¹æ³•è®¿é—®é™åˆ¶
        System.out.println("\n=== è®¿é—®ç§æœ‰æ–¹æ³• ===");
        
        // è°ƒç”¨ç§æœ‰å®ä¾‹æ–¹æ³•
        Method instanceMethod = clazz.getDeclaredMethod("revealSecret", String.class);
        instanceMethod.setAccessible(true);
        instanceMethod.invoke(obj, "åå°„è°ƒç”¨");
        
        // è°ƒç”¨ç§æœ‰é™æ€æ–¹æ³•
        Method staticMethod = clazz.getDeclaredMethod("getSecretKey");
        staticMethod.setAccessible(true);
        Object result = staticMethod.invoke(null);
        System.out.println("é™æ€æ–¹æ³•è¿”å›: " + result);

        // âœ… 4. è®¿é—®ç§æœ‰å†…éƒ¨ç±»
        System.out.println("\n=== è®¿é—®ç§æœ‰å†…éƒ¨ç±» ===");
        Class<?> innerClass = Class.forName("SecretClass$InnerSecret");
        Constructor<?> innerCons = innerClass.getDeclaredConstructor();
        innerCons.setAccessible(true);
        Object innerObj = innerCons.newInstance();
        
        // è®¿é—®å†…éƒ¨ç±»çš„ç§æœ‰å­—æ®µ
        Field innerField = innerClass.getDeclaredField("innerValue");
        innerField.setAccessible(true);
        System.out.println("å†…éƒ¨ç±»å­—æ®µå€¼: " + innerField.get(innerObj));
        
        // è°ƒç”¨å†…éƒ¨ç±»çš„ç§æœ‰æ–¹æ³•
        Method innerMethod = innerClass.getDeclaredMethod("showInnerSecret");
        innerMethod.setAccessible(true);
        innerMethod.invoke(innerObj);

        // âœ… 5. éªŒè¯è®¿é—®æ§åˆ¶ç»•è¿‡çš„æ•ˆæœ
        System.out.println("\n=== éªŒè¯ç»•è¿‡æ•ˆæœ ===");
        System.out.println("æœ€ç»ˆå¯¹è±¡çŠ¶æ€: " + obj);
        
        // å±•ç¤ºæ‰€æœ‰ç§æœ‰æˆå‘˜
        showAllPrivateMembers(clazz);
    }
    
    /**
     * å±•ç¤ºç±»çš„æ‰€æœ‰ç§æœ‰æˆå‘˜
     */
    private static void showAllPrivateMembers(Class<?> clazz) {
        System.out.println("\n=== ç±»çš„æ‰€æœ‰ç§æœ‰æˆå‘˜ ===");
        
        // ç§æœ‰å­—æ®µ
        System.out.println("ç§æœ‰å­—æ®µ:");
        for (Field field : clazz.getDeclaredFields()) {
            if (Modifier.isPrivate(field.getModifiers())) {
                System.out.println("  " + field.getName() + " : " + field.getType().getSimpleName());
            }
        }
        
        // ç§æœ‰æ–¹æ³•
        System.out.println("ç§æœ‰æ–¹æ³•:");
        for (Method method : clazz.getDeclaredMethods()) {
            if (Modifier.isPrivate(method.getModifiers())) {
                System.out.println("  " + method.getName() + "() : " + method.getReturnType().getSimpleName());
            }
        }
        
        // ç§æœ‰æ„é€ å™¨
        System.out.println("ç§æœ‰æ„é€ å™¨:");
        for (Constructor<?> constructor : clazz.getDeclaredConstructors()) {
            if (Modifier.isPrivate(constructor.getModifiers())) {
                System.out.println("  " + constructor.toString());
            }
        }
    }
}
```

### 7.4 è®¿é—®æ§åˆ¶ç»•è¿‡çš„é«˜çº§åº”ç”¨


**ğŸ”§ é«˜çº§ç»•è¿‡æŠ€æœ¯**
```java
public class AdvancedAccessBypass {
    
    /**
     * é€šç”¨çš„ç§æœ‰å­—æ®µè®¿é—®å·¥å…·
     */
    public static Object getPrivateField(Object obj, String fieldName) {
        try {
            Class<?> clazz = obj.getClass();
            Field field = clazz.getDeclaredField(fieldName);
            field.setAccessible(true);
            return field.get(obj);
        } catch (Exception e) {
            throw new RuntimeException("æ— æ³•è®¿é—®ç§æœ‰å­—æ®µ: " + fieldName, e);
        }
    }
    
    /**
     * é€šç”¨çš„ç§æœ‰å­—æ®µè®¾ç½®å·¥å…·
     */
    public static void setPrivateField(Object obj, String fieldName, Object value) {
        try {
            Class<?> clazz = obj.getClass();
            Field field = clazz.getDeclaredField(fieldName);
            field.setAccessible(true);
            field.set(obj, value);
        } catch (Exception e) {
            throw new RuntimeException("æ— æ³•è®¾ç½®ç§æœ‰å­—æ®µ: " + fieldName, e);
        }
    }
    
    /**
     * é€šç”¨çš„ç§æœ‰æ–¹æ³•è°ƒç”¨å·¥å…·
     */
    public static Object invokePrivateMethod(Object obj, String methodName, 
            Class<?>[] paramTypes, Object[] args) {
        try {
            Class<?> clazz = obj.getClass();
            Method method = clazz.getDeclaredMethod(methodName, paramTypes);
            method.setAccessible(true);
            return method.invoke(obj, args);
        } catch (Exception e) {
            throw new RuntimeException("æ— æ³•è°ƒç”¨ç§æœ‰æ–¹æ³•: " + methodName, e);
        }
    }
    
    /**
     * åˆ›å»ºç§æœ‰æ„é€ å™¨å®ä¾‹
     */
    public static <T> T createPrivateInstance(Class<T> clazz, 
            Class<?>[] paramTypes, Object[] args) {
        try {
            Constructor<T> constructor = clazz.getDeclaredConstructor(paramTypes);
            constructor.setAccessible(true);
            return constructor.newInstance(args);
        } catch (Exception e) {
            throw new RuntimeException("æ— æ³•åˆ›å»ºç§æœ‰å®ä¾‹: " + clazz.getName(), e);
        }
    }
    
    /**
     * æ‰¹é‡è®¾ç½®å¯¹è±¡å­—æ®µå€¼
     */
    public static void setFieldValues(Object obj, Map<String, Object> fieldValues) {
        Class<?> clazz = obj.getClass();
        for (Map.Entry<String, Object> entry : fieldValues.entrySet()) {
            try {
                Field field = clazz.getDeclaredField(entry.getKey());
                field.setAccessible(true);
                field.set(obj, entry.getValue());
            } catch (Exception e) {
                System.err.println("è®¾ç½®å­—æ®µå¤±è´¥: " + entry.getKey() + " = " + entry.getValue());
            }
        }
    }
}
```

### 7.5 å®‰å…¨é£é™©ä¸æ³¨æ„äº‹é¡¹


**âš ï¸ å®‰å…¨é£é™©åˆ†æè¡¨**

| é£é™© | **æè¿°** | **å½±å“ç¨‹åº¦** |
|-----|---------|-------------|
| **ç ´åå°è£…æ€§** | å¯ä¿®æ”¹æœ¬ä¸åº”æš´éœ²çš„å†…éƒ¨çŠ¶æ€ | âš ï¸ é«˜ |
| **å¼•å‘å…¼å®¹æ€§é—®é¢˜** | æŸäº›ç±»æˆå‘˜ä¿®æ”¹åä¼šç ´åè¡Œä¸ºçº¦å®š | âš ï¸ ä¸­ |
| **JDKé™åˆ¶å¢å¼º** | Javaæ¨¡å—ç³»ç»Ÿæ­£é€æ­¥é™åˆ¶ç»•è¿‡åå°„çš„èƒ½åŠ› | âš ï¸ ä¸­ |
| **æ¡†æ¶éœ€è°¨æ…ä½¿ç”¨** | Springã€MyBatisç­‰å¿…é¡»å…¼å®¹æ¨¡å—é™åˆ¶ | âš ï¸ ä½ |
| **æ€§èƒ½å¼€é”€** | åå°„æ“ä½œæ¯”ç›´æ¥è®¿é—®æ€§èƒ½å·® | âš ï¸ ä½ |

### 7.6 æ¨¡å—åŒ–ç³»ç»Ÿçš„é™åˆ¶


**ğŸ›¡ï¸ Java 9+æ¨¡å—åŒ–é™åˆ¶**
```java
// Java 9+ä¸­çš„æ¨¡å—åŒ–é™åˆ¶ç¤ºä¾‹
public class ModuleAccessDemo {
    
    public static void demonstrateModuleRestrictions() {
        try {
            // å°è¯•è®¿é—®java.baseæ¨¡å—çš„å†…éƒ¨ç±»
            Class<?> stringClass = String.class;
            Field valueField = stringClass.getDeclaredField("value");
            valueField.setAccessible(true); // åœ¨æ¨¡å—åŒ–ç³»ç»Ÿä¸­å¯èƒ½è¢«æ‹’ç»
            
            String str = "Hello";
            char[] value = (char[]) valueField.get(str);
            System.out.println("Stringå†…éƒ¨å€¼: " + java.util.Arrays.toString(value));
            
        } catch (IllegalAccessException e) {
            System.err.println("æ¨¡å—åŒ–é™åˆ¶: " + e.getMessage());
            System.err.println("éœ€è¦ä½¿ç”¨ --add-opens java.base/java.lang=ALL-UNNAMED");
        } catch (Exception e) {
            System.err.println("å…¶ä»–é”™è¯¯: " + e.getMessage());
        }
    }
    
    public static void main(String[] args) {
        demonstrateModuleRestrictions();
    }
}
```

**ğŸ”§ è§£å†³æ¨¡å—åŒ–é™åˆ¶çš„æ–¹æ³•**
```bash
# 1. ä½¿ç”¨JVMå‚æ•°å¼€æ”¾æ¨¡å—è®¿é—®
java --add-opens java.base/java.lang=ALL-UNNAMED MyClass

# 2. åœ¨module-info.javaä¸­å£°æ˜
module mymodule {
    requires java.base;
    // å¼€æ”¾åŒ…ç»™åå°„è®¿é—®
    opens com.example.mypackage to ALL-UNNAMED;
}

# 3. ä½¿ç”¨exportsæŒ‡ä»¤ï¼ˆä¸æ¨èç”¨äºå†…éƒ¨åŒ…ï¼‰
module mymodule {
    exports com.example.internal to ALL-UNNAMED;
}
```

### 7.7 æœ€ä½³å®è·µå»ºè®®


**ğŸ’¡ ä½¿ç”¨å»ºè®®**

```
è®¿é—®æ§åˆ¶ç»•è¿‡çš„æœ€ä½³å®è·µ
â”œâ”€â”€ 1. è°¨æ…ä½¿ç”¨åŸåˆ™
â”‚   â”œâ”€â”€ ä»…åœ¨ç¡®å®éœ€è¦æ—¶ä½¿ç”¨ï¼ˆå¦‚æ¡†æ¶ã€æµ‹è¯•ã€å·¥å…·ç±»ï¼‰
â”‚   â”œâ”€â”€ é¿å…åœ¨ä¸šåŠ¡é€»è¾‘ä¸­ç›´æ¥ä½¿ç”¨
â”‚   â””â”€â”€ ä¼˜å…ˆè€ƒè™‘å…¬å¼€APIæˆ–è®¾è®¡æ¨¡å¼æ›¿ä»£æ–¹æ¡ˆ
â”‚
â”œâ”€â”€ 2. å®‰å…¨è€ƒè™‘
â”‚   â”œâ”€â”€ éªŒè¯è¾“å…¥å‚æ•°çš„åˆæ³•æ€§
â”‚   â”œâ”€â”€ æ³¨æ„å¼‚å¸¸å¤„ç†å’Œé”™è¯¯æ¢å¤
â”‚   â”œâ”€â”€ é¿å…ä¿®æ”¹ç³»ç»Ÿå…³é”®ç±»çš„å†…éƒ¨çŠ¶æ€
â”‚   â””â”€â”€ åœ¨å®‰å…¨æ•æ„Ÿç¯å¢ƒä¸­é™åˆ¶åå°„æƒé™
â”‚
â”œâ”€â”€ 3. æ€§èƒ½è€ƒè™‘
â”‚   â”œâ”€â”€ ç¼“å­˜åå°„å¯¹è±¡ï¼ˆFieldã€Methodã€Constructorï¼‰
â”‚   â”œâ”€â”€ é¿å…åœ¨é«˜é¢‘å¾ªç¯ä¸­ä½¿ç”¨
â”‚   â”œâ”€â”€ è€ƒè™‘ä½¿ç”¨MethodHandleç­‰é«˜æ€§èƒ½æ›¿ä»£æ–¹æ¡ˆ
â”‚   â””â”€â”€ å¿…è¦æ—¶è¿›è¡Œæ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–
â”‚
â”œâ”€â”€ 4. å…¼å®¹æ€§è€ƒè™‘
â”‚   â”œâ”€â”€ æµ‹è¯•ä¸åŒJDKç‰ˆæœ¬çš„å…¼å®¹æ€§
â”‚   â”œâ”€â”€ å‡†å¤‡æ¨¡å—åŒ–ç³»ç»Ÿçš„è¿ç§»æ–¹æ¡ˆ
â”‚   â”œâ”€â”€ æä¾›é™çº§æˆ–æ›¿ä»£å®ç°
â”‚   â””â”€â”€ æ–‡æ¡£åŒ–åå°„ä½¿ç”¨çš„ä¾èµ–å’Œé™åˆ¶
â”‚
â””â”€â”€ 5. ä»£ç è´¨é‡
    â”œâ”€â”€ å°è£…åå°„æ“ä½œåˆ°å·¥å…·ç±»ä¸­
    â”œâ”€â”€ æä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯å’Œæ—¥å¿—
    â”œâ”€â”€ ä½¿ç”¨å•å…ƒæµ‹è¯•éªŒè¯åå°„é€»è¾‘
    â””â”€â”€ å®šæœŸå®¡æŸ¥å’Œé‡æ„åå°„ä»£ç 
```

**âœ… æ¨èä½¿ç”¨åœºæ™¯**
- **æ¡†æ¶å¼€å‘**ï¼šSpringã€Hibernateç­‰æ¡†æ¶çš„å†…éƒ¨å®ç°
- **å•å…ƒæµ‹è¯•**ï¼šæµ‹è¯•ç§æœ‰æ–¹æ³•å’Œå­—æ®µçš„çŠ¶æ€
- **å·¥å…·ç±»å¼€å‘**ï¼šé€šç”¨çš„å¯¹è±¡æ“ä½œå’Œæ•°æ®è½¬æ¢å·¥å…·
- **è°ƒè¯•å’Œè¯Šæ–­**ï¼šå¼€å‘é˜¶æ®µçš„é—®é¢˜æ’æŸ¥å’ŒçŠ¶æ€æ£€æŸ¥

**âŒ ä¸æ¨èä½¿ç”¨åœºæ™¯**
- **ä¸šåŠ¡é€»è¾‘**ï¼šæ­£å¸¸çš„ä¸šåŠ¡ä»£ç åº”é¿å…ç›´æ¥ä½¿ç”¨
- **ç”Ÿäº§ç¯å¢ƒ**ï¼šé™¤éç»è¿‡å……åˆ†æµ‹è¯•å’Œå®‰å…¨è¯„ä¼°
- **ç³»ç»Ÿç±»ä¿®æ”¹**ï¼šé¿å…ä¿®æ”¹JDKæ ¸å¿ƒç±»çš„å†…éƒ¨çŠ¶æ€
- **é«˜é¢‘æ“ä½œ**ï¼šæ€§èƒ½æ•æ„Ÿçš„çƒ­ç‚¹ä»£ç è·¯å¾„

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ ä¸ƒå¤§åå°„æ“ä½œï¼šç±»ç»“æ„ã€æ„é€ å™¨ã€å­—æ®µã€æ–¹æ³•ã€æ•°ç»„ã€æ³¨è§£ã€è®¿é—®æ§åˆ¶ç»•è¿‡
ğŸ”¸ è·å–vså£°æ˜ï¼šgetXXX()è·å–publicæˆå‘˜ï¼ŒgetDeclaredXXX()è·å–æ‰€æœ‰æˆå‘˜
ğŸ”¸ è®¿é—®æ§åˆ¶ï¼šsetAccessible(true)æ˜¯ç»•è¿‡ç§æœ‰è®¿é—®é™åˆ¶çš„å…³é”®
ğŸ”¸ é™æ€vså®ä¾‹ï¼šé™æ€æˆå‘˜æ“ä½œæ—¶å¯¹è±¡å‚æ•°ä¼ null
ğŸ”¸ å¼‚å¸¸å¤„ç†ï¼šåå°„æ“ä½œéœ€è¦å¤„ç†å¤šç§æ£€æŸ¥å¼‚å¸¸
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ åå°„æ“ä½œçš„å±‚æ¬¡ç»“æ„**
```
åå°„æ“ä½œå±‚æ¬¡ï¼š
â€¢ Classå¯¹è±¡ï¼šåå°„çš„å…¥å£ï¼Œè·å–ç±»çš„åŸºæœ¬ä¿¡æ¯
â€¢ ç»“æ„è·å–ï¼šé€šè¿‡Classå¯¹è±¡è·å–æ„é€ å™¨ã€å­—æ®µã€æ–¹æ³•
â€¢ åŠ¨æ€æ“ä½œï¼šé€šè¿‡åå°„å¯¹è±¡è¿›è¡Œå®ä¾‹åˆ›å»ºã€è°ƒç”¨ã€èµ‹å€¼
â€¢ ç‰¹æ®Šå¤„ç†ï¼šæ•°ç»„ã€æ³¨è§£ã€è®¿é—®æ§åˆ¶ç­‰ç‰¹æ®Šæƒ…å†µ
```

**ğŸ”¹ æ€§èƒ½ä¸å®‰å…¨çš„å¹³è¡¡**
```
æ€§èƒ½è€ƒè™‘ï¼š
â€¢ åå°„æ“ä½œæ¯”ç›´æ¥è°ƒç”¨æ…¢10-100å€
â€¢ ç¼“å­˜åå°„å¯¹è±¡å¯ä»¥æ˜¾è‘—æå‡æ€§èƒ½
â€¢ é¿å…åœ¨é«˜é¢‘ä»£ç ä¸­ä½¿ç”¨åå°„

å®‰å…¨è€ƒè™‘ï¼š
â€¢ setAccessible()å¯ä»¥ç»•è¿‡Javaçš„è®¿é—®æ§åˆ¶
â€¢ éœ€è¦è°¨æ…å¤„ç†ç§æœ‰æˆå‘˜çš„è®¿é—®
â€¢ æ¨¡å—åŒ–ç³»ç»Ÿå¢å¼ºäº†åå°„çš„å®‰å…¨é™åˆ¶
```
