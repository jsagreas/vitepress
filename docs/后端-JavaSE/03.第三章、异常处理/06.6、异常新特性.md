---
title: 6ã€å¼‚å¸¸æ–°ç‰¹æ€§
---
## ğŸ“š ç›®å½•

1. [JDK7æ–°ç‰¹æ€§](#1-JDK7æ–°ç‰¹æ€§)
2. [JDK9æ–°ç‰¹æ€§](#2-JDK9æ–°ç‰¹æ€§)
3. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#3-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”¥ JDK7æ–°ç‰¹æ€§


### 1.1 å¤šå¼‚å¸¸æ•è·ï¼ˆmulti-catchï¼‰


**ğŸ”¸ æ ¸å¿ƒæ¦‚å¿µ**
```
ç›®çš„ï¼šåˆå¹¶å¤šä¸ª catchï¼Œé¿å…é‡å¤ä»£ç 
è¯­æ³•ï¼šå¤šä¸ªå¼‚å¸¸ç”¨ | åˆ†éš”ï¼Œå˜é‡åå¿…é¡»ç›¸åŒï¼Œç±»å‹ä¸èƒ½æœ‰ç»§æ‰¿å…³ç³»
ä¼˜åŠ¿ï¼šå‡å°‘ä»£ç å†—ä½™ï¼Œæé«˜å¯è¯»æ€§
```

**ğŸ’¡ åŸºæœ¬è¯­æ³•ç¤ºä¾‹**
```java
// JDK 7 ä¹‹å‰çš„å†™æ³•
try {
    FileInputStream fis = new FileInputStream("file.txt");
    Properties prop = new Properties();
    prop.load(fis);
} catch (IOException e) {
    System.out.println("IOå¼‚å¸¸ï¼š" + e.getMessage());
    e.printStackTrace();
} catch (SecurityException e) {
    System.out.println("å®‰å…¨å¼‚å¸¸ï¼š" + e.getMessage());
    e.printStackTrace();
} catch (IllegalArgumentException e) {
    System.out.println("å‚æ•°å¼‚å¸¸ï¼š" + e.getMessage());
    e.printStackTrace();
}

// JDK 7+ å¤šå¼‚å¸¸æ•è·å†™æ³•
try {
    FileInputStream fis = new FileInputStream("file.txt");
    Properties prop = new Properties();
    prop.load(fis);
} catch (IOException | SecurityException | IllegalArgumentException e) {
    System.out.println("å¤„ç† IOã€å®‰å…¨æˆ–å‚æ•°å¼‚å¸¸ï¼š" + e.getMessage());
    e.printStackTrace();
}
```

**âš ï¸ é‡è¦é™åˆ¶ä¸æ³¨æ„äº‹é¡¹**

| é™åˆ¶ç±»å‹ | **è¯´æ˜** | **ç¤ºä¾‹** |
|---------|---------|---------|
| **ç»§æ‰¿å…³ç³»é™åˆ¶** | `å¼‚å¸¸ç±»å‹ä¸èƒ½æœ‰çˆ¶å­å…³ç³»` | `IOException \| FileNotFoundException` âŒ |
| **å˜é‡finalç‰¹æ€§** | `å¼‚å¸¸å˜é‡æ˜¯éšå¼finalçš„` | `e = new Exception()` âŒ |
| **ç±»å‹æ¨æ–­** | `ç¼–è¯‘å™¨è‡ªåŠ¨æ¨æ–­æœ€ä½³å…¬å…±ç±»å‹` | `Exception e` (æœ€å°å…¬å…±çˆ¶ç±») |

```java
// âŒ é”™è¯¯ç¤ºä¾‹ï¼šå¼‚å¸¸ç±»å‹æœ‰ç»§æ‰¿å…³ç³»
try {
    // ä»£ç é€»è¾‘
} catch (IOException | FileNotFoundException e) {
    // ç¼–è¯‘é”™è¯¯ï¼šFileNotFoundException æ˜¯ IOException çš„å­ç±»
}

// âŒ é”™è¯¯ç¤ºä¾‹ï¼šå°è¯•é‡æ–°èµ‹å€¼å¼‚å¸¸å˜é‡
try {
    // ä»£ç é€»è¾‘
} catch (IOException | SQLException e) {
    e = new IOException();  // âŒ ç¼–è¯‘é”™è¯¯ï¼šCannot assign a value to final variable 'e'
}

// âœ… æ­£ç¡®ç¤ºä¾‹ï¼šæ— ç»§æ‰¿å…³ç³»çš„å¼‚å¸¸
try {
    // ä»£ç é€»è¾‘
} catch (IOException | SQLException | ClassNotFoundException e) {
    System.out.println("æ•è·åˆ°å¼‚å¸¸ï¼š" + e.getClass().getSimpleName());
    // e çš„ç±»å‹æ˜¯ Exceptionï¼ˆè¿™äº›å¼‚å¸¸çš„æœ€å°å…¬å…±çˆ¶ç±»ï¼‰
}
```

### 1.2 è‡ªåŠ¨èµ„æºé‡Šæ”¾ï¼ˆtry-with-resourcesï¼‰


**ğŸ”¸ ä¼ ç»Ÿèµ„æºç®¡ç†çš„é—®é¢˜**
```
é—®é¢˜åˆ†æï¼š
â€¢ æ‰‹åŠ¨ç®¡ç†èµ„æºå®¹æ˜“å¿˜è®°å…³é—­
â€¢ finally å—ä¸­çš„å¼‚å¸¸å¤„ç†å¤æ‚
â€¢ ä»£ç å†—é•¿ï¼Œå¯è¯»æ€§å·®
â€¢ å¯èƒ½å‡ºç°èµ„æºæ³„æ¼
```

**ğŸ“Š ä¼ ç»Ÿæ–¹å¼ vs æ–°ç‰¹æ€§å¯¹æ¯”**

**ä¼ ç»Ÿ try-catch-finally æ–¹å¼ï¼š**
```java
BufferedReader reader = null;
FileInputStream fis = null;
try {
    fis = new FileInputStream("data.txt");
    reader = new BufferedReader(new InputStreamReader(fis));
    String line = reader.readLine();
    System.out.println("è¯»å–å†…å®¹ï¼š" + line);
} catch (FileNotFoundException e) {
    System.err.println("æ–‡ä»¶æœªæ‰¾åˆ°ï¼š" + e.getMessage());
} catch (IOException e) {
    System.err.println("è¯»å–å¼‚å¸¸ï¼š" + e.getMessage());
} finally {
    // æ‰‹åŠ¨å…³é—­èµ„æºï¼Œéœ€è¦å¤„ç†å¤šå±‚å¼‚å¸¸
    if (reader != null) {
        try {
            reader.close();
        } catch (IOException e) {
            System.err.println("å…³é—­readerå¤±è´¥ï¼š" + e.getMessage());
        }
    }
    if (fis != null) {
        try {
            fis.close();
        } catch (IOException e) {
            System.err.println("å…³é—­æ–‡ä»¶æµå¤±è´¥ï¼š" + e.getMessage());
        }
    }
}
```

**JDK 7+ try-with-resources æ–¹å¼ï¼š**
```java
// è‡ªåŠ¨èµ„æºç®¡ç†ï¼Œç®€æ´æ˜äº†
try (FileInputStream fis = new FileInputStream("data.txt");
     BufferedReader reader = new BufferedReader(new InputStreamReader(fis))) {
    
    String line = reader.readLine();
    System.out.println("è¯»å–å†…å®¹ï¼š" + line);
    
} catch (FileNotFoundException e) {
    System.err.println("æ–‡ä»¶æœªæ‰¾åˆ°ï¼š" + e.getMessage());
} catch (IOException e) {
    System.err.println("è¯»å–å¼‚å¸¸ï¼š" + e.getMessage());
}
// èµ„æºè‡ªåŠ¨å…³é—­ï¼Œæ— éœ€æ‰‹åŠ¨å¤„ç†
```

**ğŸ”§ AutoCloseable æ¥å£è¦æ±‚**
```java
// èµ„æºç±»å¿…é¡»å®ç° AutoCloseable æ¥å£
public interface AutoCloseable {
    void close() throws Exception;
}

// å¸¸è§å®ç°äº† AutoCloseable çš„ç±»ï¼š
// â€¢ FileInputStream/FileOutputStream
// â€¢ BufferedReader/BufferedWriter
// â€¢ Connection (æ•°æ®åº“è¿æ¥)
// â€¢ PreparedStatement/ResultSet
// â€¢ Socket/ServerSocket
// â€¢ Scanner
```

**âš¡ èµ„æºå…³é—­é¡ºåºä¸å¼‚å¸¸æŠ‘åˆ¶**
```java
try (FileInputStream fis = new FileInputStream("file.txt");
     BufferedReader reader = new BufferedReader(new InputStreamReader(fis))) {
    
    // å¦‚æœè¿™é‡ŒæŠ›å‡ºå¼‚å¸¸ï¼Œèµ„æºä»ä¼šè¢«æ­£ç¡®å…³é—­
    throw new RuntimeException("ä¸šåŠ¡å¼‚å¸¸");
    
} catch (Exception e) {
    System.out.println("ä¸»å¼‚å¸¸ï¼š" + e.getMessage());
    
    // è·å–è¢«æŠ‘åˆ¶çš„å¼‚å¸¸ï¼ˆèµ„æºå…³é—­æ—¶çš„å¼‚å¸¸ï¼‰
    Throwable[] suppressed = e.getSuppressed();
    for (Throwable t : suppressed) {
        System.out.println("æŠ‘åˆ¶å¼‚å¸¸ï¼š" + t.getMessage());
    }
}

/*
èµ„æºå…³é—­é¡ºåºï¼š
1. reader.close() - åå£°æ˜çš„å…ˆå…³é—­
2. fis.close()    - å…ˆå£°æ˜çš„åå…³é—­

å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼š
â€¢ ä¸»å¼‚å¸¸ï¼štryå—ä¸­çš„å¼‚å¸¸
â€¢ æŠ‘åˆ¶å¼‚å¸¸ï¼šèµ„æºå…³é—­æ—¶çš„å¼‚å¸¸ä¼šè¢«æ·»åŠ åˆ°ä¸»å¼‚å¸¸çš„suppressedåˆ—è¡¨ä¸­
*/
```

---

## 2. ğŸš€ JDK9æ–°ç‰¹æ€§


### 2.1 try-with-resources æ”¹è¿›


**ğŸ”¸ JDK 9 ä¹‹å‰çš„é™åˆ¶**
```
é™åˆ¶ï¼šèµ„æºå˜é‡å¿…é¡»åœ¨ try() æ‹¬å·å†…å£°æ˜å’Œåˆå§‹åŒ–
é—®é¢˜ï¼šæ— æ³•ä½¿ç”¨å¤–éƒ¨å·²ç»åˆ›å»ºçš„èµ„æºå˜é‡
å½±å“ï¼šä»£ç é‡å¤ï¼Œèµ„æºç®¡ç†ä¸å¤Ÿçµæ´»
```

**ğŸ’¡ æ”¹è¿›å¯¹æ¯”ç¤ºä¾‹**

**JDK 7-8 å†™æ³•ï¼ˆä»…æ”¯æŒæ‹¬å·å†…å£°æ˜ï¼‰ï¼š**
```java
// å¿…é¡»åœ¨ try() é‡Œé¢å£°æ˜å¹¶åˆå§‹åŒ–èµ„æº
public void readFileOldWay() throws IOException {
    try (BufferedReader br = new BufferedReader(new FileReader("data.txt"))) {
        System.out.println(br.readLine());
    }
    // br åœ¨æ­¤å¤„å·²ç»ä¸å¯è®¿é—®
}

// å¦‚æœéœ€è¦åœ¨å¤šä¸ªåœ°æ–¹ä½¿ç”¨åŒä¸€ä¸ªèµ„æºï¼Œä»£ç ä¼šé‡å¤
public void processFileOldWay() throws IOException {
    try (BufferedReader br1 = new BufferedReader(new FileReader("data.txt"))) {
        String line1 = br1.readLine();
        // å¤„ç†ç¬¬ä¸€è¡Œ
    }
    
    try (BufferedReader br2 = new BufferedReader(new FileReader("data.txt"))) {
        String line2 = br2.readLine();
        // å¤„ç†ç¬¬äºŒè¡Œï¼ˆéœ€è¦é‡æ–°åˆ›å»ºèµ„æºï¼‰
    }
}
```

**JDK 9+ å†™æ³•ï¼ˆæ”¯æŒå¤–éƒ¨å˜é‡ï¼‰ï¼š**
```java
// å¯ä»¥ä½¿ç”¨å¤–éƒ¨å£°æ˜çš„èµ„æºå˜é‡
public void readFileNewWay() throws IOException {
    BufferedReader br = new BufferedReader(new FileReader("data.txt"));
    
    // br æ˜¯ effectively final çš„ï¼Œå¯ä»¥ç›´æ¥åœ¨ try() ä¸­ä½¿ç”¨
    try (br) {
        System.out.println(br.readLine());
    }
    // br å·²ç»è¢«è‡ªåŠ¨å…³é—­
}

// æ›´çµæ´»çš„èµ„æºç®¡ç†
public void processFileNewWay() throws IOException {
    BufferedReader br = new BufferedReader(new FileReader("data.txt"));
    PrintWriter pw = new PrintWriter(new FileWriter("output.txt"));
    
    // å¯ä»¥é€‰æ‹©æ€§åœ°ç®¡ç†èµ„æº
    try (br; pw) {  // å¤šä¸ªå¤–éƒ¨èµ„æºç”¨åˆ†å·åˆ†éš”
        String line;
        while ((line = br.readLine()) != null) {
            pw.println("å¤„ç†ï¼š" + line);
        }
    }
}
```

**ğŸ”’ effectively final è¦æ±‚è¯¦è§£**
```java
// âœ… æ­£ç¡®ç¤ºä¾‹ï¼šå˜é‡æ²¡æœ‰è¢«é‡æ–°èµ‹å€¼
BufferedReader br = new BufferedReader(new FileReader("file.txt"));
// br ä»åˆ›å»ºåæ²¡æœ‰æ”¹å˜ï¼Œæ˜¯ effectively final
try (br) {
    System.out.println(br.readLine());
}

// âŒ é”™è¯¯ç¤ºä¾‹ï¼šå˜é‡è¢«é‡æ–°èµ‹å€¼
BufferedReader br = new BufferedReader(new FileReader("file1.txt"));
br = new BufferedReader(new FileReader("file2.txt"));  // âŒ æ”¹å˜äº†å¼•ç”¨
try (br) {  // âŒ ç¼–è¯‘å¤±è´¥ï¼šVariable used in try-with-resources must be final or effectively final
    System.out.println(br.readLine());
}

// âœ… æ¡ä»¶èµ‹å€¼çš„æ­£ç¡®å†™æ³•
BufferedReader br;
if (condition) {
    br = new BufferedReader(new FileReader("file1.txt"));
} else {
    br = new BufferedReader(new FileReader("file2.txt"));
}
// br åœ¨æ­¤ä¹‹åæ²¡æœ‰æ”¹å˜ï¼Œæ˜¯ effectively final
try (br) {
    System.out.println(br.readLine());
}
```

**ğŸ”„ æ··åˆä½¿ç”¨æ–°æ—§è¯­æ³•**
```java
public void mixedResourceManagement() throws IOException {
    // å¤–éƒ¨å£°æ˜çš„èµ„æº
    FileInputStream fis = new FileInputStream("input.txt");
    
    // æ··åˆä½¿ç”¨ï¼šå¤–éƒ¨å˜é‡ + å†…éƒ¨å£°æ˜
    try (fis;  // å¤–éƒ¨å˜é‡
         BufferedReader br = new BufferedReader(new InputStreamReader(fis));  // å†…éƒ¨å£°æ˜
         PrintWriter pw = new PrintWriter("output.txt")) {  // å†…éƒ¨å£°æ˜
        
        String line;
        while ((line = br.readLine()) != null) {
            pw.println("Copy: " + line);
        }
    }
    // æ‰€æœ‰èµ„æºéƒ½ä¼šè¢«è‡ªåŠ¨å…³é—­
}
```

---

## 3. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 3.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å¤šå¼‚å¸¸æ•è·ï¼šå‡å°‘ä»£ç é‡å¤ï¼Œå¼‚å¸¸ç±»å‹ä¸èƒ½æœ‰ç»§æ‰¿å…³ç³»
ğŸ”¸ try-with-resourcesï¼šè‡ªåŠ¨èµ„æºç®¡ç†ï¼Œå®ç°AutoCloseableæ¥å£
ğŸ”¸ effectively finalï¼šJDK9+æ”¯æŒå¤–éƒ¨å˜é‡ï¼Œä½†å¿…é¡»æ˜¯finalæˆ–ç­‰æ•ˆfinal
ğŸ”¸ å¼‚å¸¸æŠ‘åˆ¶ï¼šèµ„æºå…³é—­å¼‚å¸¸ä¼šè¢«æŠ‘åˆ¶ï¼Œå¯é€šè¿‡getSuppressed()è·å–
ğŸ”¸ èµ„æºå…³é—­é¡ºåºï¼šåå£°æ˜çš„å…ˆå…³é—­ï¼Œç¬¦åˆæ ˆå¼ç®¡ç†åŸåˆ™
```

### 3.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ å¤šå¼‚å¸¸æ•è·çš„ä½¿ç”¨åœºæ™¯**
```
é€‚ç”¨æƒ…å†µï¼š
â€¢ å¤šä¸ªå¼‚å¸¸çš„å¤„ç†é€»è¾‘ç›¸åŒ
â€¢ éœ€è¦å‡å°‘é‡å¤çš„catchå—
â€¢ å¼‚å¸¸ç±»å‹ä¹‹é—´æ²¡æœ‰ç»§æ‰¿å…³ç³»

æ³¨æ„äº‹é¡¹ï¼š
â€¢ å¼‚å¸¸å˜é‡æ˜¯éšå¼finalçš„
â€¢ ç¼–è¯‘å™¨æ¨æ–­æœ€å°å…¬å…±çˆ¶ç±»å‹
â€¢ ä¸èƒ½æ•è·æœ‰ç»§æ‰¿å…³ç³»çš„å¼‚å¸¸ç»„åˆ
```

**ğŸ”¹ try-with-resources çš„ä¼˜åŠ¿**
```
ä¼ ç»Ÿæ–¹å¼é—®é¢˜ï¼š
â€¢ å¿˜è®°å…³é—­èµ„æºå¯¼è‡´å†…å­˜æ³„æ¼
â€¢ finallyå—ä»£ç å¤æ‚ä¸”å®¹æ˜“å‡ºé”™
â€¢ å¼‚å¸¸å¤„ç†é€»è¾‘å†—é•¿

æ–°ç‰¹æ€§ä¼˜åŠ¿ï¼š
â€¢ è‡ªåŠ¨èµ„æºç®¡ç†ï¼Œæ— éœ€æ‰‹åŠ¨å…³é—­
â€¢ å¼‚å¸¸æŠ‘åˆ¶æœºåˆ¶ï¼Œä¿è¯ä¸»å¼‚å¸¸ä¸è¢«è¦†ç›–
â€¢ ä»£ç ç®€æ´ï¼Œå¯è¯»æ€§å¼º
â€¢ æ”¯æŒå¤šèµ„æºåŒæ—¶ç®¡ç†
```

**ğŸ”¹ JDKç‰ˆæœ¬æ¼”è¿›**
```
JDK 7ï¼š
â€¢ å¼•å…¥ try-with-resources
â€¢ å¿…é¡»åœ¨try()æ‹¬å·å†…å£°æ˜èµ„æº

JDK 9ï¼š
â€¢ æ”¯æŒä½¿ç”¨å¤–éƒ¨effectively finalå˜é‡
â€¢ æé«˜äº†èµ„æºç®¡ç†çš„çµæ´»æ€§
â€¢ ä¿æŒå‘åå…¼å®¹æ€§
```

### 3.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ ä¸šåŠ¡åœºæ™¯åº”ç”¨**
- **æ–‡ä»¶æ“ä½œ**ï¼šè¯»å†™æ–‡ä»¶æ—¶è‡ªåŠ¨å…³é—­æµèµ„æº
- **æ•°æ®åº“æ“ä½œ**ï¼šConnectionã€PreparedStatementè‡ªåŠ¨å…³é—­
- **ç½‘ç»œç¼–ç¨‹**ï¼šSocketè¿æ¥çš„è‡ªåŠ¨ç®¡ç†
- **å¼‚å¸¸å¤„ç†**ï¼šç»Ÿä¸€å¤„ç†ç›¸ä¼¼çš„å¼‚å¸¸ç±»å‹

**ğŸ”§ ç¼–ç¨‹å®è·µ**
- **èµ„æºç®¡ç†**ï¼šä¼˜å…ˆä½¿ç”¨try-with-resourcesæ›¿ä»£æ‰‹åŠ¨å…³é—­
- **å¼‚å¸¸åˆ†ç±»**ï¼šæ ¹æ®å¤„ç†é€»è¾‘å¯¹å¼‚å¸¸è¿›è¡Œåˆç†åˆ†ç»„
- **ä»£ç ç®€åŒ–**ï¼šå‡å°‘é‡å¤çš„catchå—å’Œfinallyä»£ç 
- **ç‰ˆæœ¬é€‰æ‹©**ï¼šæ ¹æ®JDKç‰ˆæœ¬é€‰æ‹©åˆé€‚çš„è¯­æ³•ç‰¹æ€§

**æ ¸å¿ƒè®°å¿†**ï¼š
- å¤šå¼‚å¸¸æ•è·ç”¨ç«–çº¿åˆ†éš”ï¼Œç»§æ‰¿å…³ç³»è¦é¿å…
- è‡ªåŠ¨èµ„æºç®¡ç†é æ¥å£ï¼Œtryæ‹¬å·å†…å£°æ˜è¦å®ç°
- JDK9æ”¹è¿›æ›´çµæ´»ï¼Œå¤–éƒ¨å˜é‡ä¹Ÿèƒ½ç”¨
- effectively finalæ˜¯å…³é”®ï¼Œèµ‹å€¼æ”¹å˜å°±å‡ºé”™