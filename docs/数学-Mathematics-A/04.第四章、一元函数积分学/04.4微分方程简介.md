---
title: 4微分方程简介
---
## 一、微分方程的基本概念


- 微分方程：就是含有未知函数及其导数的方程。

- 常微分方程：未知函数是一元函数的，是指只涉及一个自变量（通常是时间或空间）及其导数的微分方程。

<br/>

  $$ F(x, y(x), \frac{d y}{d x}, \frac{d^{2} y}{d x^{2}}, \cdots)=0$$

<br/>

  $$ 公式含义 \begin{cases} 
  & 1．一个方程涉及自变量  x  \\ \newline
  & 2．末知函数  y(x)  \\ \newline
  & 3．函数的各阶导数  \dfrac{d y}{d x}, \dfrac{d^{2} y}{d x^{2}}  等   \\ \newline
  & 4．这些元素之间存在某种关系  F  ，使得整个表达式等于零  \\
  \end{cases}  $$

- 偏微分方程：未知函数是多元函数的，是涉及多个自变量及其偏导数的微分方程。

<br/>

  $$F(x_{1}, x_{2}, \ldots, x_{n}, u(x_{1}, x_{2}, \ldots, x_{n}), \frac{\partial u}{\partial x_{1}}, \frac{\partial u}{\partial x_{2}}, \cdots)=0 $$

<br/>

  $$ 公式含义 \begin{cases} 
  &  1．有多个自变量  x_{1}, x_{2}, \ldots, x_{n} （可以是空间坐标，时间等） \\ \newline
  &  2．有一个未知的多变量函数  u(x_{1}, x_{2}, \ldots, x_{n})  \\ \newline
  &  3．函数对各个变量的偏导数  \dfrac{\partial u}{\partial x_{1}}, \dfrac{\partial u}{\partial x_{2}}, \ldots    \\ \newline
  &  4．这些元素之间存在某种关系  F  ，使得整个表达式等于零  \\
  \end{cases}  $$

- 微分方程举例：

  $$ 常微分 \begin{cases} 
  & 物体自由下落: \frac{d v}{d t}=g\\ \newline
  & 人口增长模型: \frac{d P}{d t}=k \cdot P \\ 
  \end{cases}  $$

<br/>

  $$ 偏微分 \begin{cases} 
  & 热传导方程： \frac{\partial u}{\partial t}=\alpha \nabla^{2} u \\ \newline
  & 波动方程：\frac{\partial^{2} u}{\partial t^{2}}=c^{2} \nabla^{2} u \\ \newline
  & 拉普拉斯方程：\nabla^{2} u=0 \\ 
  \end{cases}  $$

<br/>

- 阶：微分方程中的出现的未知函数的最高阶导数的阶数，就是方程中涉及到的导数的最高次方数。

- 解：如果将某个函数及其导数带入微分方程中，能使该方程称为恒等式，则称该函数为微分方程的解。

- 通解：包含所有可能解，通常带有任意常数，且任意常数的个数等于方程的阶数。

- 特解：是一个具体解，不含有任意常数的解，它是在通解的基础上，通过满足特定初始条件的解，确定唯一的函数。

- 定解条件：确定微分方程通解中任意常数的值的条件称为定解条件，常见形式有初始条件和边界条件。

- 初始条件：是指在微分方程中未知函数在初始时刻所需满足的条件。

- 解微分方程：找到符合方程的函数，使得这个函数满足微分方程的关系，并且可能符合给定的初始条件或边界条件。

- 初始（初值）问题:求微分方程满足初始条件的特解，这一问题称为微分方程的初值问题。


## 二、可分离变量的微分方程


含义：就是一种可以通过“拆开”变量（即让 $x$ 和 $y$ 各自待在自己的一边）的方式来求解的方程。它的形式通常是：

<br/>

$$\begin{cases}
  & \dfrac{d y}{d x}=f(x) g(y)  \\ \newline
  &   y^{\prime}=f(x) g(y) \\ 
\end{cases} \Longrightarrow  \dfrac{d y}{g(y)}=f(x) d x$$


解法：

$$\begin{cases}
  &分离变量： \dfrac{d y}{g(y)}=f(x) d x  \\ \newline
  &两边积分： \int \frac{1}{g(y)} d y=\int f(x) d x  \\ \newline
  &解出y：  G(y)=F(x)+C  \\  
\end{cases}$$


案例：

$$ \frac{d y}{d x}=x y^{2}  \begin{cases}
  & 将方程改写为：\frac{d y}{y^{2}}=x d x \\ \newline
  & 两边积分：\int \frac{d y}{y^{2}}=\int x d x \\ \newline
  & 左边积分：\int \frac{d y}{y^{2}}=-\frac{1}{y}+C_{1} \\ \newline
  & 右边积分：\int x d x=\frac{x^{2}}{2}+C_{2} \\ \newline
  & 合并常数项：-\frac{1}{y}+C_{1}=\frac{x^{2}}{2}+C_{2} \\ \newline
  & 令  C=C_{2}-C_{1}  ，得到：-\frac{1}{y}=\frac{x^{2}}{2}+C \\ \newline
  &\frac{1}{y}=-\frac{x^{2}}{2}-C \Rightarrow   y=\frac{1}{-\frac{x^{2}}{2}-C}=\frac{-2}{x^{2}+2 C}  \\ \newline
  & 令 C^{\prime}=2 C  \Longrightarrow y=\frac{-2}{x^{2}+C^{\prime}} \\ 
\end{cases}$$


## 三、一阶线性微分方程


  - $P(x)$ 和  $Q(x)$  是已知函数。

  - $Q(x) \neq 0$  时为非齐次方程。

  - $Q(x)=0$  时为齐次方程。

    $$\frac{d y}{d x}+P(x) \cdot y=Q(x)$$

  **一阶线性：**
  
   ✧一阶：方程中最高阶导数为$\frac{d y}{d x}$ （一阶导数）。

   ✧线性：未知函数$y$及其导数$\frac{d y}{d x}$均以一次幂（线性）形式出现，且没有乘积项（如$y \cdot \frac{d y}{d x}$  或$y^{2}$）。


  **1．线性性的体现**

  ✧线性方程：方程中$y$和$\frac{d y}{d x}$的系数仅与自变量$x$有关，例如：$\frac{d y}{d x}+2 x \cdot y=e^{x}$ (线性)。

  ✧非线性方程：若方程中出现$y^{2},y \cdot \frac{d y}{d x}$ 或更高次项，则为非线性，例如：$\frac{d y}{d x}+y^{2}=x$(非线性)。

  **2．齐次与非齐次的区分**

  ✧齐次方程：当非齐次项$Q(x)=0$时，方程为齐次：$\frac{d y}{d x}+P(x) \cdot y=0$。

  ✧非齐次方程：当  $Q(x) \neq 0$  时，方程为非齐次：$\frac{d y}{d x}+P(x) \cdot y=Q(x)$。

  ✧齐次方程通过分离变量法求解，通解为：$y_{c}=C \cdot e^{-\int P(x) d x}$。

  ✧非齐次方程的通解由两部分组成：$y=y_{c}+y_{p}=$ 齐次解 + 特解。


**非齐次方程通解结构的证明：**

  ✧对于一阶线性非齐次微分方程：
  $$\frac{d y}{d x}+P(x) y=Q(x)$$
  ✧若$y_{p}$是此方程的任意一个特解，$y_{c}=C e^{-\int P(x) d x}$是对应齐次方程的通解，设此非齐次方程的通解形式为：
  $$y=y_{c}+y_{p}=C e^{-\int P(x) d x}+y_{p}$$
  ✧证明：第一步：验证$y=y_{c}+y_{p}$确实是原非齐次方程的解，将  $y=y_{c}+y_{p}$  代入原方程：
  $$\frac{d(y_{c}+y_{p})}{d x}+P(x)(y_{c}+y_{p})=Q(x)  $$
  ✧展开得：
  $$\frac{d y_{c}}{d x}+\frac{d y_{p}}{d x}+P(x) y_{c}+P(x) y_{p}=Q(x)  $$
  ✧由于$y_{c}$是齐次方程的解，所以：
  $$\frac{d y_{p}}{d x}+P(x) y_{p}=Q(x)$$
  ✧代入原展开式，得到：
  $$\underbrace{\frac{d y_{c}}{d x}+P(x) y_{c}}_{=0}+\underbrace{\frac{d y_{p}}{d x}+P(x) y_{p}}_{=Q(x)}=Q(x) \Longrightarrow   0+Q(x)=Q(x)$$
  ✧这个等式成立，证明$y=y_{c}+y_{p}$确实是原非齐次方程的解。

  ✧第二步：证明这表示通解（包含所有可能的解），假设$y_{1}$和$y_{2}$是原非齐次方程的两个不同解。

  ✧我们假设有两个不同的函数$y_{1}$和$y_{2}$，它们都是非齐次方程$\frac{d y}{d x}+P(x) y=Q(x)$的解，这意味着：
   $$\begin{cases}
   &  \frac{d y_1}{d x}+P(x) y_{1}=Q(x)  \\  \newline
   &  \frac{d y_{2}}{d x}+P(x) y_{2}=Q(x)  \\ 
   \end{cases}$$
  ✧将这两个等式相减： 
   $$(\frac{d y_1}{d x}+P(x) y_{1})-(\frac{d y_2}{d x}+P(x) y_{2})=Q(x)-Q(x)    $$
  ✧利用导数的线性性质和代数运算规则： 
  $$\frac{d(y_{1}-y_{2})}{d x}+P(x)(y_{1}-y_{2})=0$$ 
  ✧如果我们定义$z=y_{1}-y_{2}$，那么上式变为： 
  $$\frac{d z}{d x}+P(x) z=0 $$
  ✧这表明$z$是齐次方程的解，所以$z=C e^{-\int P(x) d x}$ ，因此： 
   $$\begin{cases}
   &  y_{1}-y_{2}=C e^{-\int P(x) d x}    \\  \newline
   &  y_{1}=y_{2}+C e^{-\int P(x) d x}  \\ 
   \end{cases}$$
  ✧这证明了任何两个解之间的差异恰好是齐次解的形式，因此$y=y_{p}+C e^{-\int P(x) d x}$表示了所有可能的解。

## 四、一阶微分积分因子法

- 核心思想：将一个不能直接积分的微分方程，通过乘以一个特定的因子，转化为可以直接积分的形式。

$$\begin{cases}
  & 1．标准形式:  \frac{d y}{d x}+P(x) y=Q(x)   \\  \newline
  & 2．计算积分因子:  \mu(x)=e^{\int P(x) d x}   \\  \newline
  & 3．两边乘以积分因子:  \mu(x) \frac{d y}{d x}+\mu(x) P(x) y=\mu(x) Q(x)   \\  \newline
  & 4．由积分因子的性质 :  \frac{d}{d x}[\mu(x) y]=\mu(x) Q(x)   \\  \newline
  & 5．两边积分: \mu(x) y=\int \mu(x) Q(x) d x+C    \\  \newline
  & 6．解出:  y=\frac{1}{\mu(x)}\left[\int \mu(x) Q(x) d x+C\right]  \\   
\end{cases}$$


- 积分因子法推导：

  ✧对于一阶线性微分方程的标准形式：
   $$\frac{d y}{d x}+P(x) y=Q(x)   $$
  ✧关键思想：我们希望找到一个函数$\mu(x)$（称为积分因子），使得方程左侧变为某个函数的导数

  ✧推导步骤：将方程两边同乘以积分因子$\mu(x)$：
   $$\mu(x) \frac{d y}{d x}+\mu(x) P(x) y=\mu(x) Q(x)$$
  ✧我们希望左侧成为  $\mu(x) y$  的导数：
   $$\mu(x) \frac{d y}{d x} + \frac{d \mu(x)}{d x} y  =  \frac{d}{d x}[\mu(x) y]  $$
  ✧比较前两个式子，需要满足：
   $$ \mu(x) P(x) y= \frac{d \mu(x)}{d x} y  \Longrightarrow   \mu(x) P(x)=\frac{d \mu(x)}{d x}   $$
  ✧上式可以整理为：
  $$\mu(x) P(x)=\frac{d \mu(x)}{d x} \Longrightarrow  P(x)=\frac{d }{d x}\mu(x) \cdot \frac {1}{\mu(x)}   $$
  ✧两边微分得到：
  $$P(x)=\frac{d }{d x}\mu(x) \cdot \frac {1}{\mu(x)}\Longrightarrow  P(x)dx= [\mu(x) ]^{\prime}dx\cdot \frac {1}{\mu(x)}=\frac{d\mu(x)}{\mu(x)}  $$      
  ✧最后化简为：
   $$\frac{d \mu(x)}{\mu(x)}=P(x) d x$$
  ✧两边积分：
   $$\ln |\mu(x)|=\int P(x) d x+C   $$
  ✧因此：（常数  $C$  可以忽略，因为任何常数倍的积分因子都有效）
   $$\mu(x)=e^{\int P(x) d x}$$
  ✧应用积分因子：用找到的$\mu(x)$乘以原方程：
  $$\mu(x) \frac{d y}{d x}+\mu(x) P(x) y=\mu(x) Q(x)  $$
  ✧左侧现在等于$\frac{d}{d x}[\mu(x) y]$，所以：
  $$\frac{d}{d x}[\mu(x) y]=\mu(x) Q(x)  $$
  ✧求解方程：两边积分：
  $$\mu(x) y=\int \mu(x) Q(x) d x+C  $$
  ✧解得：
  $$y=\frac{1}{\mu(x)}\left[\int \mu(x) Q(x) d x+C\right]  $$


- 积分因子法举例:
$$  \frac{d y}{d x}+2 x y=x  \begin{cases}
  & 1．已知 : P(x)=2 x, Q(x)=x   \\  \newline
  & 2．计算积分因子 :  \mu(x)=e^{\int 2 x d x}=e^{x^{2}}  \\  \newline
  & 3．两边同乘以积分因子 :  e^{x^{2}} \frac{d y}{d x}+2 x e^{x^{2}} y=x e^{x^{2}} \\  \newline
  & 4．左边化简为 :  \frac{d}{d x}\left[e^{x^{2}} y\right]=x e^{x^{2}}  \\  \newline
  & 5．两边积分 :  e^{x^{2}} y=\int x e^{x^{2}} d x+C=\frac{1}{2} e^{x^{2}}+C \\  \newline
  & 6．求解 : y=\frac{1}{2}+C e^{-x^{2}}  \\  
\end{cases}$$



## 五、一阶微分常数变易法


- 常数变易法公式：
 $$y=e^{-\int P(x) d x}(\int Q(x) e^{\int P(x) d x} d x+C)$$


- **特解形式的推导证明：**

  ✧已知$y=y_{p}+C e^{-\int P(x) d x}$，假设特解形式为$y_{p}=u(x) e^{-\int P(x) d x}$，代入原方程 $\frac{d y}{d x}+P(x) y= Q(x)$  来确定$u(x)$。

  ✧步骤1：计算$y_{p}$的导数：
  $$\frac{d y_{p}}{d x}=\frac{d}{d x}\left[u(x) e^{-\int P(x) d x}\right] $$
  ✧使用乘积法则：
  $$\frac{d y_{p}}{d x}=u^{\prime}(x) e^{-\int P(x) d x}+u(x) \frac{d}{d x}\left[e^{-\int P(x) d x}\right]  $$
  ✧步骤2：计算$\frac{d}{d x} (e^{-\int P(x) d x} )$ 
  $$\frac{d}{d x}\left[e^{-\int P(x) d x}\right]=e^{-\int P(x) d x} \cdot \frac{d}{d x}\left[-\int P(x) d x\right]=-P(x) e^{-\int P(x) d x}  $$
  ✧步骤3：代入步骤1中的导数表达式
   $$\begin{cases}
   & \frac{d y_{p}}{d x}=u^{\prime}(x) e^{-\int P(x) d x}+u(x)\left[-P(x) e^{-\int P(x) d x}\right]   \\  \newline
   & \frac{d y_{p}}{d x}=u^{\prime}(x) e^{-\int P(x) d x}-u(x) P(x) e^{-\int P(x) d x} \\   
   \end{cases}$$
  ✧步骤4：将 $y_{p}$和$\frac{d y_{p}}{d x}$代入原方程
   $$\begin{cases}
   & \frac{d y_{p}}{d x}+P(x) y_{p}=Q(x)  \\  \newline
   & {\left[u^{\prime}(x) e^{-\int P(x) d x}-u(x) P(x) e^{-\int P(x) d x}\right]+P(x)\left[u(x) e^{-\int P(x) d x}\right]=Q(x)} \\  
   \end{cases}$$
  ✧步骤5：整理左侧表达式
   $$u^{\prime}(x) e^{-\int P(x) d x}-u(x) P(x) e^{-\int P(x) d x}+u(x) P(x) e^{-\int P(x) d x}=Q(x) $$
  ✧注意第二项和第三项相互抵消：
   $$u^{\prime}(x) e^{-\int P(x) d x}=Q(x) $$
  ✧步骤6：解出$u^{\prime}(x)$
   $$u^{\prime}(x)=Q(x) e^{\int P(x) d x}   $$
  ✧步骤7：对$u^{\prime}(x)$进行积分得到$u(x)$
   $$u(x)=\int Q(x) e^{\int P(x) d x} d x+C   $$
  ✧其中  $C$  是积分常数。由于我们只需要一个特解，可以取  $C=0$  ，得到：
   $$u(x)=\int Q(x) e^{\int P(x) d x} d x   $$
  ✧最终特解：
   $$y_{p}=u(x) e^{-\int P(x) d x}=\left(\int Q(x) e^{\int P(x) d x} d x\right) e^{-\int P(x) d x}   $$


<br/><br/>

- **常数变易法推导：**

  ✧已知一阶微分方程形式：
  $$\frac{d y}{d x}+P(x) \cdot y=Q(x)$$
  ✧首先，解对应的齐次方程：
  $$\frac{d y}{d x}+P(x) y=0$$
  ✧将方程变形：  
   $$\frac{d y}{d x}=-P(x) y  \quad \Longrightarrow   \quad \frac{d y}{y}=-P(x) d x $$
  ✧两边同时积分：
  $$\int \frac{1}{y} d y=-\int P(x) d x$$
  ✧得到积分结果：积分常数写为$\ln C$而不是通常的$C$，为了方便下一步。
  $$\ln |y|=-\int P(x) d x+\ln C$$
  ✧对等式两边取指数：
  $$e^{\ln |y|}=e^{-\int P(x) d x} \cdot e^{\ln C}$$
  ✧根据指数和对数的性质，$e^{\ln |y|}=|y|$  和$e^{\ln C}=C$：
  $$|y|=C e^{-\int P(x) d x} $$
  ✧由于积分常数$C$可以取任意值，所以可以涵盖$y$的正负情况，因此可以去掉绝对值符号：
  $$y=C e^{-\int P(x) d x} $$
  ✧这就是齐次方程$\frac{d y}{d x}+P(x) y=0$的通解，其中$C$是任意常数，通常记为$y_{c}$：
  $$y_{c}=C e^{-\int P(x) d x}  $$
  ✧应用常数变易法 ，现在我们假设$C$不是常数，而是$x$的函数$C(x)$：
   $$y=C(x) e^{-\int P(x) d x} $$
  ✧代入原方程求解$C(x)$对上式求导：
   $$\begin{cases}
   & \dfrac{d y}{d x}=\dfrac{d C(x)}{d x} e^{-\int P(x) d x}+C(x) e^{-\int P(x) d x} \cdot(-P(x))  \\  \newline
   & \dfrac{d y}{d x}=\dfrac{d C(x)}{d x} e^{-\int P(x) d x}-C(x) P(x) e^{-\int P(x) d x} \\   
   \end{cases}$$
  ✧将$y$和$\frac{dy}{dx}$的表达式代入原方程：
  $$\frac{d C(x)}{d x} e^{-\int P(x) d x}-C(x) P(x) e^{-\int P(x) d x}+P(x) \cdot C(x) e^{-\int P(x) d x}=Q(x)$$

  ✧化简:
   $$\begin{cases}
     & \frac{d C(x)}{d x} e^{-\int P(x) d x}=Q(x) \\  \newline
     &  \frac{d C(x)}{d x}=Q(x) e^{\int P(x) d x} \\  
   \end{cases}$$
  ✧积分求$C(x)$ 
  $$C(x)=\int Q(x) e^{\int P(x) d x} d x+C$$
  ✧得到原方程的通解 将$C(x)$代回$y$的表达式：
   $$\begin{cases}
     & y=C(x) e^{-\int P(x) d x}   \\  \newline
     & =e^{-\int P(x) d x} \left[  \int Q(x) e^{\int P(x) d x} d x+C \right] \\  \newline
     & y=y_{c} (齐次通解)+y_{p} (非齐次特解)\\  
   \end{cases}$$

<br/><br/>


- **常数变易法举例:**


$$\frac{d y}{d x}+2 x y=x\begin{cases}
  & 1．求齐次解：\frac{d y}{d x}+2 x y=0 \Longrightarrow y_{h}=C e^{-x^{2}} \\  \newline
  & 2．变易常数：设  y_{p}=C(x) e^{-x^{2}}   \\  \newline
  & 3．代入原方程：\frac{d C(x)}{d x} e^{-x^{2}}=x \Longrightarrow \frac{d C(x)}{d x}=x e^{x^{2}} \\  \newline
  & 4．积分求  C(x)  ：C(x)=\frac{1}{2} e^{x^{2}}+C \\  \newline
  & 5．写出通解：y=e^{-x^{2}}(\frac{1}{2} e^{x^{2}}+C)=\frac{1}{2}+C e^{-x^{2}} \\  
\end{cases}$$

