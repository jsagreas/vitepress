---
title: 2ã€XMLHttpRequestå¯¹è±¡æ ¸å¿ƒ
---
## ğŸ“š ç›®å½•

1. [XMLHttpRequestå¯¹è±¡æœ¬è´¨](#1-XMLHttpRequestå¯¹è±¡æœ¬è´¨)
2. [åˆ›å»ºXHRå¯¹è±¡çš„æ–¹æ³•](#2-åˆ›å»ºXHRå¯¹è±¡çš„æ–¹æ³•)
3. [æ ¸å¿ƒå±æ€§è¯¦è§£](#3-æ ¸å¿ƒå±æ€§è¯¦è§£)
4. [æ ¸å¿ƒæ–¹æ³•è¯¦è§£](#4-æ ¸å¿ƒæ–¹æ³•è¯¦è§£)
5. [å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç®¡ç†](#5-å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç®¡ç†)
6. [XMLHttpRequest Level 2å¢å¼º](#6-XMLHttpRequest-Level-2å¢å¼º)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” XMLHttpRequestå¯¹è±¡æœ¬è´¨


### 1.1 ä»€ä¹ˆæ˜¯XMLHttpRequest

**é€šä¿—ç†è§£**ï¼šXMLHttpRequestå°±åƒæ˜¯æµè§ˆå™¨å†…ç½®çš„"å¿«é€’å‘˜"ï¼Œä¸“é—¨è´Ÿè´£åœ¨åå°æ‚„æ‚„åœ°ä»æœåŠ¡å™¨å–æ•°æ®æˆ–é€æ•°æ®ï¼Œè€Œä¸å½±å“ç”¨æˆ·å½“å‰æµè§ˆçš„é¡µé¢ã€‚

```
ä¼ ç»Ÿç½‘é¡µå·¥ä½œæ–¹å¼ï¼š
ç”¨æˆ·ç‚¹å‡» â†’ æ•´ä¸ªé¡µé¢åˆ·æ–° â†’ é‡æ–°åŠ è½½æ‰€æœ‰å†…å®¹

Ajaxæ–¹å¼ï¼š
ç”¨æˆ·ç‚¹å‡» â†’ åå°è·å–æ•°æ® â†’ åªæ›´æ–°éœ€è¦çš„éƒ¨åˆ†
```

**æ ¸å¿ƒä½œç”¨**ï¼š
- ğŸ”„ **å¼‚æ­¥é€šä¿¡**ï¼šåœ¨åå°ä¸æœåŠ¡å™¨äº¤æ¢æ•°æ®ï¼Œä¸é˜»å¡é¡µé¢
- ğŸ¯ **å±€éƒ¨æ›´æ–°**ï¼šåªåˆ·æ–°é¡µé¢çš„æŸä¸ªéƒ¨åˆ†ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
- ğŸ“¡ **æ•°æ®ä¼ è¾“**ï¼šå‘é€å’Œæ¥æ”¶å„ç§æ ¼å¼çš„æ•°æ®

### 1.2 ä¸ºä»€ä¹ˆå«XMLHttpRequest

```
åå­—è§£æï¼š
XMLï¼šæœ€åˆè®¾è®¡ç”¨æ¥ä¼ è¾“XMLæ ¼å¼æ•°æ®
HTTPï¼šä½¿ç”¨HTTPåè®®è¿›è¡Œé€šä¿¡
Requestï¼šå‘èµ·ç½‘ç»œè¯·æ±‚

å®é™…åº”ç”¨ï¼š
ç°åœ¨ä¸»è¦ç”¨æ¥ä¼ è¾“JSONæ•°æ®ï¼ŒXMLå·²ç»ä¸æ˜¯ä¸»æµäº†
ä½†åå­—æ²¿ç”¨è‡³ä»Šï¼Œè¿™å°±æ˜¯å†å²åŸå› 
```

### 1.3 XMLHttpRequestçš„åœ°ä½


> **`[æ ¸å¿ƒåœ°ä½]`** XMLHttpRequestæ˜¯AjaxæŠ€æœ¯çš„æ ¸å¿ƒï¼Œæ˜¯ç°ä»£å‰ç«¯å¼‚æ­¥ç¼–ç¨‹çš„åŸºç¡€

**æŠ€æœ¯å‘å±•è„‰ç»œ**ï¼š
- **ä¼ ç»Ÿæ—¶ä»£**ï¼šè¡¨å•æäº¤ â†’ æ•´é¡µåˆ·æ–°
- **Ajaxæ—¶ä»£**ï¼šXMLHttpRequest â†’ å¼‚æ­¥è¯·æ±‚
- **ç°ä»£æ—¶ä»£**ï¼šFetch API â†’ æ›´ç®€æ´çš„è¯­æ³•ï¼ˆåŸºäºPromiseï¼‰

---

## 2. ğŸ› ï¸ åˆ›å»ºXHRå¯¹è±¡çš„æ–¹æ³•


### 2.1 ç°ä»£æµè§ˆå™¨çš„æ ‡å‡†åˆ›å»ºæ–¹å¼


```javascript
// æœ€ç®€å•ç›´æ¥çš„åˆ›å»ºæ–¹å¼
const xhr = new XMLHttpRequest();
console.log(xhr); // è¾“å‡ºï¼šXMLHttpRequestå¯¹è±¡
```

**è§£é‡Šè¯´æ˜**ï¼š
- `XMLHttpRequest`æ˜¯æµè§ˆå™¨æä¾›çš„å†…ç½®æ„é€ å‡½æ•°
- ä½¿ç”¨`new`å…³é”®å­—åˆ›å»ºå®ä¾‹å¯¹è±¡
- åˆ›å»ºåçš„å¯¹è±¡åŒ…å«äº†æ‰€æœ‰Ajaxç›¸å…³çš„å±æ€§å’Œæ–¹æ³•

### 2.2 å…¼å®¹æ€§å¤„ç†ï¼ˆå¤„ç†è€IEæµè§ˆå™¨ï¼‰


```javascript
function createXHR() {
    // ä¼˜å…ˆä½¿ç”¨æ ‡å‡†æ–¹å¼
    if (window.XMLHttpRequest) {
        return new XMLHttpRequest();
    }
    // å…¼å®¹IE6åŠä»¥ä¸‹ç‰ˆæœ¬
    else if (window.ActiveXObject) {
        return new ActiveXObject('Microsoft.XMLHTTP');
    }
    // éƒ½ä¸æ”¯æŒåˆ™æŠ›å‡ºé”™è¯¯
    else {
        throw new Error('ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒAjax');
    }
}

// ä½¿ç”¨ç¤ºä¾‹
const xhr = createXHR();
```

**ä¸ºä»€ä¹ˆéœ€è¦å…¼å®¹æ€§å¤„ç†**ï¼š
```
æµè§ˆå™¨å·®å¼‚è¯´æ˜ï¼š
ç°ä»£æµè§ˆå™¨ï¼šæ”¯æŒ XMLHttpRequest æ„é€ å‡½æ•°
IE6åŠä»¥ä¸‹ï¼šåªæ”¯æŒ ActiveXObject æ–¹å¼
```

> **âš ï¸ ç°å®å¼€å‘å»ºè®®**ï¼šç°åœ¨IE6åŸºæœ¬å·²ç»æ·˜æ±°ï¼Œå¤§å¤šæ•°é¡¹ç›®åªéœ€è¦ä½¿ç”¨`new XMLHttpRequest()`å³å¯

### 2.3 å®ç”¨çš„åˆ›å»ºå‡½æ•°å°è£…


```javascript
// æ¨èçš„å°è£…æ–¹å¼
function createAjax() {
    try {
        return new XMLHttpRequest();
    } catch (e) {
        console.error('æµè§ˆå™¨ä¸æ”¯æŒAjaxåŠŸèƒ½');
        return null;
    }
}

// ä½¿ç”¨æ—¶æ£€æŸ¥
const xhr = createAjax();
if (xhr) {
    // å¯ä»¥æ­£å¸¸ä½¿ç”¨Ajax
    console.log('Ajaxå¯¹è±¡åˆ›å»ºæˆåŠŸ');
} else {
    // å¤„ç†ä¸æ”¯æŒçš„æƒ…å†µ
    alert('æ‚¨çš„æµè§ˆå™¨ç‰ˆæœ¬å¤ªè€ï¼Œè¯·å‡çº§æµè§ˆå™¨');
}
```

---

## 3. ğŸ“Š æ ¸å¿ƒå±æ€§è¯¦è§£


### 3.1 readyStateå±æ€§ - è¯·æ±‚çŠ¶æ€è¿½è¸ª


**ä½œç”¨**ï¼šå‘Šè¯‰ä½ å½“å‰Ajaxè¯·æ±‚è¿›è¡Œåˆ°å“ªä¸€æ­¥äº†

```javascript
const xhr = new XMLHttpRequest();

// ç›‘å¬çŠ¶æ€å˜åŒ–
xhr.onreadystatechange = function() {
    console.log('å½“å‰çŠ¶æ€ï¼š', xhr.readyState);
};
```

**readyStateçš„5ä¸ªçŠ¶æ€å€¼**ï¼š

| çŠ¶æ€å€¼ | çŠ¶æ€åç§° | **å«ä¹‰è§£é‡Š** | **é€šä¿—ç†è§£** |
|--------|----------|-------------|-------------|
| `0` | UNSENT | `åˆå§‹çŠ¶æ€ï¼Œè¿˜æ²¡è°ƒç”¨open()` | `å¿«é€’å‘˜åˆšä¸Šç­ï¼Œè¿˜æ²¡æ¥åˆ°ä»»åŠ¡` |
| `1` | OPENED | `å·²è°ƒç”¨open()ï¼Œè¿æ¥å·²å»ºç«‹` | `å¿«é€’å‘˜æ¥åˆ°ä»»åŠ¡ï¼Œå‡†å¤‡å‡ºå‘` |
| `2` | HEADERS_RECEIVED | `å·²è°ƒç”¨send()ï¼Œæ¥æ”¶åˆ°å“åº”å¤´` | `å¿«é€’å‘˜åˆ°äº†ç›®çš„åœ°ï¼Œçœ‹åˆ°äº†é—¨ç‰Œå·` |
| `3` | LOADING | `æ­£åœ¨æ¥æ”¶å“åº”ä½“æ•°æ®` | `å¿«é€’å‘˜æ­£åœ¨å–è´§ï¼Œæ•°æ®è¿˜æ²¡å…¨éƒ¨æ‹¿åˆ°` |
| `4` | DONE | `è¯·æ±‚æ“ä½œå®Œæˆ` | `å¿«é€’å‘˜å–è´§å®Œæ¯•ï¼Œä»»åŠ¡ç»“æŸ` |

**å®é™…ä½¿ç”¨ç¤ºä¾‹**ï¼š
```javascript
xhr.onreadystatechange = function() {
    if (xhr.readyState === 4) {
        // è¯·æ±‚å®Œæˆï¼Œå¯ä»¥å¤„ç†ç»“æœäº†
        console.log('è¯·æ±‚å®Œæˆï¼Œå¼€å§‹å¤„ç†æ•°æ®');
    }
};
```

### 3.2 statuså±æ€§ - HTTPçŠ¶æ€ç 


**ä½œç”¨**ï¼šå‘Šè¯‰ä½ æœåŠ¡å™¨å¯¹è¿™æ¬¡è¯·æ±‚çš„å¤„ç†ç»“æœ

```javascript
xhr.onreadystatechange = function() {
    if (xhr.readyState === 4) {
        console.log('çŠ¶æ€ç ï¼š', xhr.status);
    }
};
```

**å¸¸è§çŠ¶æ€ç å«ä¹‰**ï¼š

| çŠ¶æ€ç  | **å«ä¹‰** | **é€šä¿—è§£é‡Š** |
|--------|----------|-------------|
| `200` | `æˆåŠŸ` | `ä¸€åˆ‡æ­£å¸¸ï¼Œæ•°æ®è·å–æˆåŠŸ` |
| `404` | `æœªæ‰¾åˆ°` | `è¦çš„ä¸œè¥¿ä¸å­˜åœ¨` |
| `500` | `æœåŠ¡å™¨é”™è¯¯` | `æœåŠ¡å™¨å‡ºé—®é¢˜äº†` |
| `403` | `ç¦æ­¢è®¿é—®` | `æ²¡æƒé™è®¿é—®` |

### 3.3 responseTextå±æ€§ - æ–‡æœ¬å“åº”æ•°æ®


**ä½œç”¨**ï¼šæœåŠ¡å™¨è¿”å›çš„æ–‡æœ¬æ ¼å¼æ•°æ®

```javascript
xhr.onreadystatechange = function() {
    if (xhr.readyState === 4 && xhr.status === 200) {
        // è·å–æœåŠ¡å™¨è¿”å›çš„æ–‡æœ¬æ•°æ®
        const data = xhr.responseText;
        console.log('æœåŠ¡å™¨è¿”å›ï¼š', data);
    }
};
```

**æ•°æ®æ ¼å¼è¯´æ˜**ï¼š
- è¿”å›çš„æ°¸è¿œæ˜¯**å­—ç¬¦ä¸²ç±»å‹**
- å¦‚æœæœåŠ¡å™¨è¿”å›JSONï¼Œéœ€è¦ç”¨`JSON.parse()`è½¬æ¢
- å¦‚æœæœåŠ¡å™¨è¿”å›HTMLï¼Œç›´æ¥ä½¿ç”¨å³å¯

### 3.4 responseXMLå±æ€§ - XMLå“åº”æ•°æ®


**ä½œç”¨**ï¼šæœåŠ¡å™¨è¿”å›çš„XMLæ ¼å¼æ•°æ®ï¼ˆç°åœ¨å¾ˆå°‘ç”¨ï¼‰

```javascript
// ä»…å½“æœåŠ¡å™¨è¿”å›XMLæ ¼å¼æ•°æ®æ—¶ä½¿ç”¨
if (xhr.responseXML) {
    const xmlDoc = xhr.responseXML;
    // å¯ä»¥ä½¿ç”¨DOMæ–¹æ³•æ“ä½œXML
}
```

> **ğŸ“ å®é™…å¼€å‘**ï¼šç°åœ¨ä¸»è¦ä½¿ç”¨JSONæ ¼å¼ä¼ è¾“æ•°æ®ï¼ŒresponseXMLå¾ˆå°‘ä½¿ç”¨

---

## 4. âš™ï¸ æ ¸å¿ƒæ–¹æ³•è¯¦è§£


### 4.1 open()æ–¹æ³• - é…ç½®è¯·æ±‚


**ä½œç”¨**ï¼šå‘Šè¯‰XMLHttpRequestè¦å‘ä»€ä¹ˆæ ·çš„è¯·æ±‚

```javascript
xhr.open(method, url, async, user, password);
```

**å‚æ•°è¯¦è§£**ï¼š

| å‚æ•° | **ç±»å‹** | **å¿…éœ€** | **è¯´æ˜** |
|------|----------|----------|----------|
| `method` | `å­—ç¬¦ä¸²` | `âœ… å¿…éœ€` | `è¯·æ±‚æ–¹æ³•ï¼š'GET'ã€'POST'ç­‰` |
| `url` | `å­—ç¬¦ä¸²` | `âœ… å¿…éœ€` | `è¯·æ±‚çš„ç½‘å€` |
| `async` | `å¸ƒå°”å€¼` | `âŒ å¯é€‰` | `æ˜¯å¦å¼‚æ­¥ï¼Œé»˜è®¤true` |
| `user` | `å­—ç¬¦ä¸²` | `âŒ å¯é€‰` | `ç”¨æˆ·åï¼ˆå¾ˆå°‘ç”¨ï¼‰` |
| `password` | `å­—ç¬¦ä¸²` | `âŒ å¯é€‰` | `å¯†ç ï¼ˆå¾ˆå°‘ç”¨ï¼‰` |

**å¸¸ç”¨ç¤ºä¾‹**ï¼š
```javascript
// GETè¯·æ±‚
xhr.open('GET', '/api/users');

// POSTè¯·æ±‚
xhr.open('POST', '/api/users', true);

// åŒæ­¥è¯·æ±‚ï¼ˆä¸æ¨èï¼‰
xhr.open('GET', '/api/data', false);
```

### 4.2 send()æ–¹æ³• - å‘é€è¯·æ±‚


**ä½œç”¨**ï¼šçœŸæ­£å‘å‡ºç½‘ç»œè¯·æ±‚

```javascript
// GETè¯·æ±‚ä¸éœ€è¦å‘é€æ•°æ®
xhr.send();

// POSTè¯·æ±‚å‘é€æ•°æ®
xhr.send('name=å¼ ä¸‰&age=25');

// å‘é€JSONæ•°æ®
xhr.send(JSON.stringify({name: 'å¼ ä¸‰', age: 25}));
```

**é‡è¦ç†è§£**ï¼š
- `open()`åªæ˜¯é…ç½®ï¼Œ`send()`æ‰çœŸæ­£å‘é€
- GETè¯·æ±‚å‚æ•°æ”¾åœ¨URLä¸­ï¼Œsend()ä¼ nullæˆ–ä¸ä¼ å‚æ•°
- POSTè¯·æ±‚æ•°æ®é€šè¿‡send()æ–¹æ³•ä¼ é€’

### 4.3 setRequestHeader()æ–¹æ³• - è®¾ç½®è¯·æ±‚å¤´


**ä½œç”¨**ï¼šå‘Šè¯‰æœåŠ¡å™¨ä¸€äº›é¢å¤–ä¿¡æ¯

```javascript
// å¿…é¡»åœ¨open()ä¹‹åï¼Œsend()ä¹‹å‰è°ƒç”¨
xhr.open('POST', '/api/users');

// è®¾ç½®å†…å®¹ç±»å‹
xhr.setRequestHeader('Content-Type', 'application/json');

// è®¾ç½®è‡ªå®šä¹‰å¤´éƒ¨
xhr.setRequestHeader('Authorization', 'Bearer token123');

xhr.send(JSON.stringify({name: 'å¼ ä¸‰'}));
```

**å¸¸ç”¨è¯·æ±‚å¤´**ï¼š
- `Content-Type`ï¼šå‘Šè¯‰æœåŠ¡å™¨å‘é€çš„æ•°æ®æ ¼å¼
- `Authorization`ï¼šèº«ä»½éªŒè¯ä¿¡æ¯
- `Accept`ï¼šå‘Šè¯‰æœåŠ¡å™¨æœŸæœ›æ¥æ”¶çš„æ•°æ®æ ¼å¼

### 4.4 abort()æ–¹æ³• - å–æ¶ˆè¯·æ±‚


**ä½œç”¨**ï¼šä¸­é€”å–æ¶ˆè¿˜æ²¡å®Œæˆçš„è¯·æ±‚

```javascript
const xhr = new XMLHttpRequest();
xhr.open('GET', '/api/large-data');
xhr.send();

// 5ç§’åå¦‚æœè¿˜æ²¡å®Œæˆå°±å–æ¶ˆ
setTimeout(() => {
    xhr.abort();
    console.log('è¯·æ±‚è¢«å–æ¶ˆäº†');
}, 5000);
```

---

## 5. ğŸ”„ å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç®¡ç†


### 5.1 å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸæµç¨‹


```
XMLHttpRequestå¯¹è±¡ç”Ÿå‘½å‘¨æœŸï¼š

åˆ›å»ºå¯¹è±¡ â†’ é…ç½®è¯·æ±‚ â†’ å‘é€è¯·æ±‚ â†’ æ¥æ”¶å“åº” â†’ å¤„ç†æ•°æ® â†’ æ¸…ç†èµ„æº

   new         open        send      onreadystatechange    = null
```

### 5.2 å®Œæ•´ä½¿ç”¨ç¤ºä¾‹


```javascript
function ajaxRequest(url, method, data, callback) {
    // 1. åˆ›å»ºå¯¹è±¡
    const xhr = new XMLHttpRequest();
    
    // 2. é…ç½®çŠ¶æ€ç›‘å¬
    xhr.onreadystatechange = function() {
        if (xhr.readyState === 4) {
            if (xhr.status === 200) {
                // æˆåŠŸå¤„ç†
                callback(null, xhr.responseText);
            } else {
                // é”™è¯¯å¤„ç†
                callback(new Error('è¯·æ±‚å¤±è´¥ï¼š' + xhr.status));
            }
            // 5. æ¸…ç†èµ„æº
            xhr.onreadystatechange = null;
        }
    };
    
    // 3. é…ç½®è¯·æ±‚
    xhr.open(method, url, true);
    
    // 4. å‘é€è¯·æ±‚
    if (method === 'POST') {
        xhr.setRequestHeader('Content-Type', 'application/json');
        xhr.send(JSON.stringify(data));
    } else {
        xhr.send();
    }
}

// ä½¿ç”¨ç¤ºä¾‹
ajaxRequest('/api/users', 'GET', null, function(error, data) {
    if (error) {
        console.error('å‡ºé”™äº†ï¼š', error.message);
    } else {
        console.log('è·å–åˆ°æ•°æ®ï¼š', data);
    }
});
```

### 5.3 èµ„æºæ¸…ç†çš„é‡è¦æ€§


**ä¸ºä»€ä¹ˆè¦æ¸…ç†**ï¼š
- é˜²æ­¢å†…å­˜æ³„éœ²
- é¿å…é‡å¤è§¦å‘å›è°ƒå‡½æ•°
- é‡Šæ”¾æµè§ˆå™¨èµ„æº

```javascript
// å¥½çš„åšæ³•ï¼šæ¸…ç†èµ„æº
xhr.onreadystatechange = function() {
    if (xhr.readyState === 4) {
        // å¤„ç†å®Œæˆåç«‹å³æ¸…ç†
        xhr.onreadystatechange = null;
    }
};
```

---

## 6. ğŸš€ XMLHttpRequest Level 2å¢å¼º


### 6.1 Level 2æ˜¯ä»€ä¹ˆ


**Level 2**ï¼šXMLHttpRequestçš„å‡çº§ç‰ˆæœ¬ï¼Œå¢åŠ äº†å¾ˆå¤šå®ç”¨åŠŸèƒ½

```
Level 1ï¼ˆåŸç‰ˆï¼‰ï¼šåŸºç¡€çš„AjaxåŠŸèƒ½
Level 2ï¼ˆå‡çº§ç‰ˆï¼‰ï¼šå¢åŠ äº†æ–‡ä»¶ä¸Šä¼ ã€è¿›åº¦ç›‘æ§ã€è·¨åŸŸæ”¯æŒç­‰
```

### 6.2 responseTypeå±æ€§è¯¦è§£


**ä½œç”¨**ï¼šå‘Šè¯‰æµè§ˆå™¨æœŸæœ›æ¥æ”¶ä»€ä¹ˆæ ¼å¼çš„æ•°æ®

```javascript
const xhr = new XMLHttpRequest();
xhr.open('GET', '/api/data');

// è®¾ç½®å“åº”æ•°æ®ç±»å‹
xhr.responseType = 'json';  // è‡ªåŠ¨è§£æJSON

xhr.onload = function() {
    // ä¸éœ€è¦JSON.parse()ï¼Œç›´æ¥æ˜¯å¯¹è±¡
    console.log(xhr.response);  // å·²ç»æ˜¯JavaScriptå¯¹è±¡
};

xhr.send();
```

**responseTypeæ”¯æŒçš„ç±»å‹**ï¼š

| ç±»å‹å€¼ | **è¯´æ˜** | **xhr.responseè¿”å›** | **ä½¿ç”¨åœºæ™¯** |
|--------|----------|---------------------|-------------|
| `""` æˆ– `"text"` | `æ–‡æœ¬å­—ç¬¦ä¸²` | `å­—ç¬¦ä¸²` | `æ™®é€šæ–‡æœ¬æ•°æ®` |
| `"json"` | `JSONæ•°æ®` | `JavaScriptå¯¹è±¡` | `APIæ¥å£æ•°æ®` |
| `"document"` | `HTML/XMLæ–‡æ¡£` | `Documentå¯¹è±¡` | `HTMLç‰‡æ®µ` |
| `"arraybuffer"` | `äºŒè¿›åˆ¶æ•°æ®` | `ArrayBufferå¯¹è±¡` | `æ–‡ä»¶ä¸‹è½½` |
| `"blob"` | `äºŒè¿›åˆ¶å¤§å¯¹è±¡` | `Blobå¯¹è±¡` | `å›¾ç‰‡ã€è§†é¢‘ç­‰` |

### 6.3 å®é™…åº”ç”¨ç¤ºä¾‹


**å¤„ç†JSONæ•°æ®**ï¼š
```javascript
// ä¼ ç»Ÿæ–¹å¼
xhr.onreadystatechange = function() {
    if (xhr.readyState === 4 && xhr.status === 200) {
        const data = JSON.parse(xhr.responseText);  // æ‰‹åŠ¨è§£æ
    }
};

// Level 2æ–¹å¼
xhr.responseType = 'json';
xhr.onload = function() {
    const data = xhr.response;  // è‡ªåŠ¨è§£æï¼Œç›´æ¥ä½¿ç”¨
};
```

**ä¸‹è½½æ–‡ä»¶**ï¼š
```javascript
// ä¸‹è½½å›¾ç‰‡
xhr.responseType = 'blob';
xhr.onload = function() {
    const blob = xhr.response;
    const url = URL.createObjectURL(blob);
    const img = document.createElement('img');
    img.src = url;
    document.body.appendChild(img);
};
```

### 6.4 å…¶ä»–Level 2å¢å¼ºåŠŸèƒ½


**è¿›åº¦ç›‘æ§**ï¼š
```javascript
// ç›‘æ§ä¸Šä¼ è¿›åº¦
xhr.upload.onprogress = function(event) {
    if (event.lengthComputable) {
        const percent = (event.loaded / event.total) * 100;
        console.log('ä¸Šä¼ è¿›åº¦ï¼š' + percent + '%');
    }
};

// ç›‘æ§ä¸‹è½½è¿›åº¦
xhr.onprogress = function(event) {
    if (event.lengthComputable) {
        const percent = (event.loaded / event.total) * 100;
        console.log('ä¸‹è½½è¿›åº¦ï¼š' + percent + '%');
    }
};
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ XMLHttpRequestæœ¬è´¨ï¼šæµè§ˆå™¨å†…ç½®çš„ç½‘ç»œè¯·æ±‚å·¥å…·
ğŸ”¸ æ ¸å¿ƒå±æ€§ï¼šreadyState(çŠ¶æ€)ã€status(çŠ¶æ€ç )ã€responseText(å“åº”)
ğŸ”¸ æ ¸å¿ƒæ–¹æ³•ï¼šopen(é…ç½®)ã€send(å‘é€)ã€setRequestHeader(è®¾ç½®å¤´éƒ¨)
ğŸ”¸ ç”Ÿå‘½å‘¨æœŸï¼šåˆ›å»ºâ†’é…ç½®â†’å‘é€â†’æ¥æ”¶â†’å¤„ç†â†’æ¸…ç†
ğŸ”¸ Level 2å¢å¼ºï¼šresponseTypeè‡ªåŠ¨è§£æã€è¿›åº¦ç›‘æ§ã€æ–‡ä»¶å¤„ç†
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ çŠ¶æ€ç›‘æ§çš„é‡è¦æ€§**ï¼š
```
ä¸ºä»€ä¹ˆè¦ç›‘æ§readyStateï¼š
- ç¡®ä¿è¯·æ±‚çœŸæ­£å®Œæˆå†å¤„ç†æ•°æ®
- é¿å…å¤„ç†ä¸å®Œæ•´çš„å“åº”
- æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ
```

**ğŸ”¹ èµ„æºç®¡ç†çš„å¿…è¦æ€§**ï¼š
```
ä¸ºä»€ä¹ˆè¦æ¸…ç†èµ„æºï¼š
- é˜²æ­¢å†…å­˜æ³„éœ²é—®é¢˜
- é¿å…é‡å¤æ‰§è¡Œå›è°ƒ
- ä¿æŒåº”ç”¨æ€§èƒ½ç¨³å®š
```

**ğŸ”¹ Level 2çš„å®ç”¨ä»·å€¼**ï¼š
```
ä¸»è¦æ”¹è¿›ï¼š
- responseTypeï¼šè‡ªåŠ¨æ•°æ®è§£æï¼Œå‡å°‘æ‰‹å·¥è½¬æ¢
- è¿›åº¦ç›‘æ§ï¼šæä¾›ä¸Šä¼ ä¸‹è½½è¿›åº¦åé¦ˆ
- æ›´å¥½çš„é”™è¯¯å¤„ç†å’Œè¶…æ—¶æ§åˆ¶
```

### 7.3 å®é™…å¼€å‘å»ºè®®


**æœ€ä½³å®è·µ**ï¼š
- âœ… **ç°ä»£é¡¹ç›®**ï¼šç›´æ¥ä½¿ç”¨`new XMLHttpRequest()`
- âœ… **æ•°æ®è§£æ**ï¼šä¼˜å…ˆä½¿ç”¨`responseType`è‡ªåŠ¨è§£æ
- âœ… **é”™è¯¯å¤„ç†**ï¼šåŒæ—¶æ£€æŸ¥`readyState`å’Œ`status`
- âœ… **èµ„æºæ¸…ç†**ï¼šè¯·æ±‚å®Œæˆåæ¸…ç†äº‹ä»¶ç›‘å¬å™¨

**å¸¸è§é™·é˜±**ï¼š
- âŒ å¿˜è®°æ£€æŸ¥`readyState === 4`
- âŒ å¿˜è®°æ£€æŸ¥`status === 200`
- âŒ åœ¨`open()`ä¹‹å‰è°ƒç”¨`setRequestHeader()`
- âŒ å¿˜è®°æ¸…ç†`onreadystatechange`

### 7.4 ä¸ç°ä»£æŠ€æœ¯çš„å…³ç³»


```
æŠ€æœ¯æ¼”è¿›è·¯å¾„ï¼š
XMLHttpRequest â†’ Fetch API â†’ Axiosç­‰åº“

é€‰æ‹©å»ºè®®ï¼š
- å­¦ä¹ é˜¶æ®µï¼šæŒæ¡XMLHttpRequeståŸç†
- å®é™…é¡¹ç›®ï¼šå¯ä»¥ä½¿ç”¨Fetchæˆ–Axios
- å…¼å®¹æ€§è¦æ±‚é«˜ï¼šä»ç„¶ä½¿ç”¨XMLHttpRequest
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- XMLHttpRequestæ˜¯Ajaxçš„æ ¸å¿ƒï¼Œè´Ÿè´£å¼‚æ­¥ç½‘ç»œé€šä¿¡
- é€šè¿‡çŠ¶æ€ç›‘æ§ç¡®ä¿æ•°æ®å®Œæ•´æ€§å’Œå¤„ç†æ—¶æœº
- Level 2å¢å¼ºäº†æ•°æ®å¤„ç†èƒ½åŠ›å’Œç”¨æˆ·ä½“éªŒ
- åˆç†çš„èµ„æºç®¡ç†æ˜¯ç¨³å®šåº”ç”¨çš„åŸºç¡€