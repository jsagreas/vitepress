---
title: 5、RESTful API交互实战
---
## 📚 目录

1. [什么是RESTful API](#1-什么是RESTful-API)
2. [Fetch API基础入门](#2-Fetch-API基础入门)
3. [四大HTTP方法实战](#3-四大HTTP方法实战)
4. [实际项目中的API管理](#4-实际项目中的API管理)
5. [请求和响应的标准化](#5-请求和响应的标准化)
6. [错误处理和最佳实践](#6-错误处理和最佳实践)
7. [核心要点总结](#7-核心要点总结)

---

## 1. 🌐 什么是RESTful API


### 1.1 通俗理解RESTful


**简单来说**：RESTful就是一套**网络接口的设计规范**，就像餐厅的菜单一样标准化。

```
想象一个图书管理系统：

传统方式（混乱）：
- 获取书籍：/getBooks
- 添加书籍：/addBook  
- 删除书籍：/deleteBookById
- 更新书籍：/updateBookInfo

RESTful方式（规范）：
- 获取书籍：GET /books
- 添加书籍：POST /books
- 删除书籍：DELETE /books/123
- 更新书籍：PUT /books/123

同样的资源（books），用不同的HTTP方法表示不同操作
```

### 1.2 RESTful核心理念


**🔸 资源(Resource)**：把所有东西都看作资源
```
用户 → /users
书籍 → /books  
订单 → /orders
```

**🔸 HTTP方法表示操作**：
```
GET    → 获取资源（查看菜单）
POST   → 创建资源（点餐）
PUT    → 更新资源（改菜）
DELETE → 删除资源（退菜）
```

**🔸 URL表示资源路径**：
```
/users/123        → 编号123的用户
/users/123/orders → 用户123的所有订单
/orders/456       → 编号456的订单
```

### 1.3 为什么要用RESTful


> 💡 **好处**：就像交通规则一样，大家都按这个标准来，沟通就很顺畅

**统一标准**：前端和后端开发者都知道该怎么设计接口
**易于理解**：URL一看就知道是什么资源
**便于维护**：接口命名规范，不会乱七八糟

---

## 2. 🚀 Fetch API基础入门


### 2.1 什么是Fetch API


**简单理解**：Fetch就是浏览器提供的**发送网络请求的工具**，类似于打电话给服务器要数据。

```
传统方式（XMLHttpRequest）：
像用老式电话，步骤复杂，代码冗长

现代方式（Fetch）：
像用智能手机，简单直观，代码简洁
```

### 2.2 Fetch基本语法


**🔸 最简单的用法**：
```javascript
// 向服务器要数据
fetch('/api/users')
  .then(response => response.json())  // 把响应转成JSON
  .then(data => console.log(data))    // 使用数据
```

**🔸 完整语法结构**：
```javascript
fetch(url, options)
  .then(response => {
    // 处理响应
  })
  .catch(error => {
    // 处理错误
  })
```

### 2.3 Fetch的特点


| 特点 | **说明** | **实际意思** |
|------|---------|-------------|
| **基于Promise** | `使用.then()和.catch()` | `代码更好写，避免回调地狱` |
| **现代浏览器原生支持** | `不需要引入额外库` | `直接用，不用下载jQuery或axios` |
| **更简洁的API** | `比XMLHttpRequest简单` | `代码量少，更好理解` |

---

## 3. 🎯 四大HTTP方法实战


### 3.1 GET请求 - 获取数据


**用途**：从服务器获取数据，就像**问服务员今天有什么菜**

**🔸 获取所有用户**：
```javascript
// 获取用户列表
async function getUsers() {
  try {
    const response = await fetch('/api/users')
    const users = await response.json()
    console.log('用户列表:', users)
  } catch (error) {
    console.error('获取失败:', error)
  }
}
```

**🔸 获取指定用户**：
```javascript
// 获取ID为123的用户
async function getUser(userId) {
  const response = await fetch(`/api/users/${userId}`)
  const user = await response.json()
  return user
}

// 使用示例
getUser(123).then(user => {
  console.log('用户信息:', user.name, user.email)
})
```

**🔸 带查询参数的GET请求**：
```javascript
// 搜索用户：/api/users?search=张三&page=1
function searchUsers(keyword, page = 1) {
  const params = new URLSearchParams({
    search: keyword,
    page: page
  })
  
  return fetch(`/api/users?${params}`)
    .then(response => response.json())
}
```

### 3.2 POST请求 - 创建数据


**用途**：向服务器发送新数据，就像**向餐厅下单点菜**

**🔸 创建新用户**：
```javascript
async function createUser(userData) {
  const response = await fetch('/api/users', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(userData)
  })
  
  const newUser = await response.json()
  return newUser
}

// 使用示例
const newUser = {
  name: '张三',
  email: 'zhangsan@email.com',
  age: 25
}

createUser(newUser).then(user => {
  console.log('创建成功:', user)
})
```

**🔸 上传文件**：
```javascript
// 上传头像文件
function uploadAvatar(file) {
  const formData = new FormData()
  formData.append('avatar', file)
  
  return fetch('/api/users/avatar', {
    method: 'POST',
    body: formData  // 注意：FormData不需要设置Content-Type
  })
}
```

### 3.3 PUT请求 - 更新数据


**用途**：更新服务器上的数据，就像**修改已下的菜品**

**🔸 更新用户信息**：
```javascript
async function updateUser(userId, updateData) {
  const response = await fetch(`/api/users/${userId}`, {
    method: 'PUT',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(updateData)
  })
  
  return response.json()
}

// 使用示例
const updateData = {
  name: '李四',
  email: 'lisi@email.com'
}

updateUser(123, updateData).then(user => {
  console.log('更新成功:', user)
})
```

### 3.4 DELETE请求 - 删除数据


**用途**：删除服务器上的数据，就像**取消已点的菜**

**🔸 删除用户**：
```javascript
async function deleteUser(userId) {
  const response = await fetch(`/api/users/${userId}`, {
    method: 'DELETE'
  })
  
  if (response.ok) {
    console.log('删除成功')
  } else {
    console.error('删除失败')
  }
}

// 使用示例
deleteUser(123)
```

**🔸 批量删除**：
```javascript
// 删除多个用户
async function deleteUsers(userIds) {
  const response = await fetch('/api/users/batch', {
    method: 'DELETE',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({ ids: userIds })
  })
  
  return response.json()
}
```

---

## 4. 🛠️ 实际项目中的API管理


### 4.1 API统一管理


**问题**：项目大了，API接口到处都是，维护起来很混乱

**解决方案**：把所有API放在一个地方统一管理

**🔸 创建API管理文件**：
```javascript
// api/userApi.js
const BASE_URL = '/api'

export const userApi = {
  // 获取所有用户
  getAll: () => fetch(`${BASE_URL}/users`).then(res => res.json()),
  
  // 获取单个用户
  getById: (id) => fetch(`${BASE_URL}/users/${id}`).then(res => res.json()),
  
  // 创建用户
  create: (userData) => fetch(`${BASE_URL}/users`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(userData)
  }).then(res => res.json()),
  
  // 更新用户
  update: (id, userData) => fetch(`${BASE_URL}/users/${id}`, {
    method: 'PUT',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(userData)
  }).then(res => res.json()),
  
  // 删除用户
  delete: (id) => fetch(`${BASE_URL}/users/${id}`, {
    method: 'DELETE'
  })
}
```

**🔸 在组件中使用**：
```javascript
// 在Vue组件或React组件中使用
import { userApi } from './api/userApi.js'

async function loadUsers() {
  try {
    const users = await userApi.getAll()
    console.log('用户列表:', users)
  } catch (error) {
    console.error('加载失败:', error)
  }
}
```

### 4.2 请求封装优化


**🔸 封装通用请求函数**：
```javascript
// utils/request.js
async function request(url, options = {}) {
  // 默认配置
  const defaultOptions = {
    headers: {
      'Content-Type': 'application/json'
    }
  }
  
  // 合并配置
  const finalOptions = { ...defaultOptions, ...options }
  
  try {
    const response = await fetch(url, finalOptions)
    
    // 检查响应状态
    if (!response.ok) {
      throw new Error(`请求失败: ${response.status}`)
    }
    
    return await response.json()
  } catch (error) {
    console.error('请求出错:', error)
    throw error
  }
}

// 导出常用方法
export const api = {
  get: (url) => request(url),
  post: (url, data) => request(url, {
    method: 'POST',
    body: JSON.stringify(data)
  }),
  put: (url, data) => request(url, {
    method: 'PUT',
    body: JSON.stringify(data)
  }),
  delete: (url) => request(url, { method: 'DELETE' })
}
```

### 4.3 API版本控制


**为什么需要版本控制**：接口升级时，老版本还要继续工作

```javascript
// 不同版本的API
const API_V1 = '/api/v1'
const API_V2 = '/api/v2'

export const userApi = {
  // v1版本：简单的用户信息
  v1: {
    getUsers: () => fetch(`${API_V1}/users`).then(res => res.json())
  },
  
  // v2版本：更丰富的用户信息
  v2: {
    getUsers: () => fetch(`${API_V2}/users`).then(res => res.json())
  }
}
```

---

## 5. 📊 请求和响应的标准化


### 5.1 请求参数标准化


**🔸 统一的参数格式**：
```javascript
// 标准化的分页参数
function getUsers(params = {}) {
  const standardParams = {
    page: params.page || 1,
    limit: params.limit || 10,
    search: params.search || '',
    sort: params.sort || 'id',
    order: params.order || 'asc'
  }
  
  const queryString = new URLSearchParams(standardParams)
  return fetch(`/api/users?${queryString}`)
    .then(response => response.json())
}
```

**🔸 请求头标准化**：
```javascript
// 统一的请求头
const standardHeaders = {
  'Content-Type': 'application/json',
  'Accept': 'application/json',
  'X-Requested-With': 'XMLHttpRequest'
}

// 如果有登录token，自动添加
if (localStorage.getItem('token')) {
  standardHeaders['Authorization'] = `Bearer ${localStorage.getItem('token')}`
}
```

### 5.2 响应数据标准化


**🔸 标准响应格式**：
```javascript
// 服务器返回的标准格式
{
  "success": true,           // 是否成功
  "message": "操作成功",     // 提示信息
  "data": {                  // 实际数据
    "users": [...],
    "total": 100,
    "page": 1
  },
  "code": 200                // 状态码
}
```

**🔸 响应数据处理**：
```javascript
async function handleResponse(response) {
  const result = await response.json()
  
  if (result.success) {
    return result.data  // 返回实际数据
  } else {
    throw new Error(result.message)  // 抛出错误信息
  }
}

// 使用示例
fetch('/api/users')
  .then(handleResponse)
  .then(data => {
    console.log('用户数据:', data.users)
    console.log('总数:', data.total)
  })
  .catch(error => {
    console.error('出错了:', error.message)
  })
```

---

## 6. ⚠️ 错误处理和最佳实践


### 6.1 完善的错误处理


**🔸 状态码检查**：
```javascript
async function fetchWithErrorHandling(url, options) {
  try {
    const response = await fetch(url, options)
    
    // 检查HTTP状态码
    if (!response.ok) {
      switch (response.status) {
        case 401:
          throw new Error('登录已过期，请重新登录')
        case 403:
          throw new Error('没有权限访问')
        case 404:
          throw new Error('请求的资源不存在')
        case 500:
          throw new Error('服务器内部错误')
        default:
          throw new Error(`请求失败: ${response.status}`)
      }
    }
    
    return await response.json()
  } catch (error) {
    // 网络错误或其他错误
    if (error.name === 'TypeError') {
      throw new Error('网络连接失败，请检查网络')
    }
    throw error
  }
}
```

### 6.2 实际项目示例


**🔸 完整的用户管理示例**：
```javascript
// 用户管理类
class UserManager {
  constructor() {
    this.baseUrl = '/api/users'
  }
  
  // 获取用户列表
  async getUsers(page = 1) {
    try {
      const response = await fetch(`${this.baseUrl}?page=${page}`)
      const result = await response.json()
      
      if (result.success) {
        return result.data
      } else {
        throw new Error(result.message)
      }
    } catch (error) {
      console.error('获取用户失败:', error)
      return { users: [], total: 0 }
    }
  }
  
  // 创建用户
  async createUser(userData) {
    try {
      const response = await fetch(this.baseUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(userData)
      })
      
      const result = await response.json()
      
      if (result.success) {
        console.log('用户创建成功')
        return result.data
      } else {
        throw new Error(result.message)
      }
    } catch (error) {
      console.error('创建用户失败:', error)
      throw error
    }
  }
}

// 使用示例
const userManager = new UserManager()

// 加载用户列表
userManager.getUsers(1).then(data => {
  console.log('用户列表:', data.users)
})

// 创建新用户
const newUser = {
  name: '王五',
  email: 'wangwu@email.com'
}

userManager.createUser(newUser)
  .then(user => console.log('新用户:', user))
  .catch(error => alert('创建失败: ' + error.message))
```

### 6.3 最佳实践总结


> 💡 **重要提示**：这些实践可以让你的代码更稳定、更好维护

**✅ 推荐做法**：
- **统一管理API**：所有接口放在一个地方
- **标准化格式**：请求和响应格式保持一致
- **完善错误处理**：考虑各种可能的错误情况
- **使用async/await**：代码更清晰易读

**❌ 避免的做法**：
- **到处写fetch**：代码重复，难以维护
- **忽略错误**：出错时用户不知道发生了什么
- **硬编码URL**：接口地址变了要到处改
- **不检查状态码**：以为有响应就是成功

---

## 7. 📋 核心要点总结


### 7.1 必须掌握的核心概念


```
🔸 RESTful API：网络接口的设计规范，用HTTP方法表示操作
🔸 Fetch API：浏览器原生的网络请求工具，比XMLHttpRequest更简单
🔸 四大HTTP方法：GET获取、POST创建、PUT更新、DELETE删除
🔸 统一管理：把所有API接口放在一个地方，便于维护
🔸 错误处理：考虑各种可能的错误情况，给用户友好提示
```

### 7.2 实际应用价值


**🔹 为什么要学这些**：
```
前端开发的核心：
- 几乎所有网站都需要和服务器交互
- 获取数据、提交表单、上传文件都要用到
- 掌握了这些，就能做出真正有用的网站

职场必备技能：
- 公司项目都在用RESTful API
- Fetch是现代前端的标准写法
- 会这些技能，找工作更容易
```

**🔹 学会后能做什么**：
- **用户注册登录**：提交表单到服务器
- **数据展示**：从服务器获取数据显示在页面
- **文件上传**：上传图片、文档等文件
- **实时更新**：增删改查各种数据

### 7.3 继续学习建议


**📚 下一步学什么**：
1. **状态管理**：学习如何管理从API获取的数据
2. **认证授权**：学习登录token、权限控制
3. **性能优化**：学习缓存、防抖、节流等技术
4. **错误监控**：学习如何监控和修复线上错误

**🔧 实践项目推荐**：
- **待办事项应用**：练习增删改查
- **用户管理系统**：练习完整的CRUD操作
- **文件上传工具**：练习文件处理
- **数据可视化**：练习数据获取和展示

**核心记忆**：
- RESTful让接口设计更规范，Fetch让请求更简单
- GET问、POST给、PUT改、DELETE删
- 统一管理API，完善错误处理，代码更稳定
- 掌握网络请求，就掌握了前端开发的核心技能