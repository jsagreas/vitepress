---
title: 3ã€async awaitç°ä»£è¯­æ³•
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯async/awaitè¯­æ³•ç³–](#1-ä»€ä¹ˆæ˜¯async-awaitè¯­æ³•ç³–)
2. [ä¸ºä»€ä¹ˆæ¨èä½¿ç”¨async/await](#2-ä¸ºä»€ä¹ˆæ¨èä½¿ç”¨async-await)
3. [asyncå‡½æ•°çš„å£°æ˜å’Œä½¿ç”¨](#3-asyncå‡½æ•°çš„å£°æ˜å’Œä½¿ç”¨)
4. [awaitç­‰å¾…å¼‚æ­¥æ“ä½œ](#4-awaitç­‰å¾…å¼‚æ­¥æ“ä½œ)
5. [async/await vs Promiseé“¾çš„å¯¹æ¯”](#5-async-await-vs-promiseé“¾çš„å¯¹æ¯”)
6. [try-catché”™è¯¯å¤„ç†ç»“åˆ](#6-try-catché”™è¯¯å¤„ç†ç»“åˆ)
7. [ç°ä»£JavaScriptæ¨èå†™æ³•](#7-ç°ä»£javascriptæ¨èå†™æ³•)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¬ ä»€ä¹ˆæ˜¯async/awaitè¯­æ³•ç³–


### 1.1 è¯­æ³•ç³–çš„æ¦‚å¿µç†è§£


**ğŸ”¸ ä»€ä¹ˆæ˜¯è¯­æ³•ç³–ï¼Ÿ**
```
è¯­æ³•ç³– = è®©ä»£ç æ›´ç”œç¾ã€æ›´å®¹æ˜“å†™çš„è¯­æ³•
å°±åƒç»™è‹¦è¯åŒ…ä¸Šç³–è¡£ï¼Œè®©éš¾å†™çš„ä»£ç å˜å¾—å¥½å†™
```

**ğŸ’¡ é€šä¿—æ¯”å–»**
```
ä¼ ç»ŸPromiseå†™æ³• = æ‰‹å·¥åŒ…é¥ºå­ï¼ˆæ­¥éª¤å¤šã€å®¹æ˜“å‡ºé”™ï¼‰
async/awaitå†™æ³• = ç”¨åŒ…é¥ºå­æœºï¼ˆç®€å•ã€ä¸å®¹æ˜“å‡ºé”™ï¼‰

ç»“æœéƒ½æ˜¯é¥ºå­ï¼Œä½†è¿‡ç¨‹æ›´è½»æ¾ï¼
```

### 1.2 async/awaitçš„æœ¬è´¨


**ğŸ”¸ æ ¸å¿ƒç†è§£**
```
async/await ä¸æ˜¯å…¨æ–°æŠ€æœ¯
= æ˜¯Promiseçš„"åŒ–å¦†å¸ˆ"
= è®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç 
= å†™èµ·æ¥æ›´è‡ªç„¶ï¼Œè¯»èµ·æ¥æ›´èˆ’æœ
```

**ğŸ“Š ç›´è§‚å¯¹æ¯”**
```
ä¼ ç»Ÿæ–¹å¼ï¼šåƒç»•å±±è·¯ ğŸ”ï¸
fetch(url)
  .then(response => response.json())
  .then(data => console.log(data))
  .catch(error => console.error(error))

ç°ä»£æ–¹å¼ï¼šåƒèµ°ç›´è·¯ ğŸ›£ï¸
const response = await fetch(url)
const data = await response.json()
console.log(data)
```

---

## 2. ğŸŒŸ ä¸ºä»€ä¹ˆæ¨èä½¿ç”¨async/await


### 2.1 è§£å†³å›è°ƒåœ°ç‹±é—®é¢˜


**ğŸ”¥ ä¼ ç»ŸPromiseé“¾çš„ç—›ç‚¹**
```javascript
// ğŸ˜µ ä¼ ç»Ÿå†™æ³•ï¼šå±‚å±‚åµŒå¥—ï¼Œéš¾ä»¥ç†è§£
fetch('/api/user')
  .then(response => response.json())
  .then(user => {
    return fetch(`/api/posts/${user.id}`)
  })
  .then(response => response.json())
  .then(posts => {
    return fetch(`/api/comments/${posts[0].id}`)
  })
  .then(response => response.json())
  .then(comments => {
    console.log('ç”¨æˆ·çš„ç¬¬ä¸€ç¯‡æ–‡ç« çš„è¯„è®º:', comments)
  })
  .catch(error => console.error('å‡ºé”™äº†:', error))
```

**âœ¨ async/awaitçš„ä¼˜åŠ¿**
```javascript
// ğŸ˜Š ç°ä»£å†™æ³•ï¼šç›´è§‚æ˜“æ‡‚ï¼Œåƒæ­£å¸¸é€»è¾‘
async function getUserComments() {
  try {
    const userResponse = await fetch('/api/user')
    const user = await userResponse.json()
    
    const postsResponse = await fetch(`/api/posts/${user.id}`)
    const posts = await postsResponse.json()
    
    const commentsResponse = await fetch(`/api/comments/${posts[0].id}`)
    const comments = await commentsResponse.json()
    
    console.log('ç”¨æˆ·çš„ç¬¬ä¸€ç¯‡æ–‡ç« çš„è¯„è®º:', comments)
  } catch (error) {
    console.error('å‡ºé”™äº†:', error)
  }
}
```

### 2.2 æå‡ä»£ç å¯è¯»æ€§


**ğŸ“– å¯è¯»æ€§å¯¹æ¯”**

| ç»´åº¦ | Promiseé“¾ | async/await |
|------|-----------|-------------|
| ğŸ§  **å¿ƒç†è´Ÿæ‹…** | `éœ€è¦ç†è§£é“¾å¼è°ƒç”¨` | `åƒæ™®é€šå‡½æ•°ä¸€æ ·è¯»` |
| ğŸ‘€ **è§†è§‰æ•ˆæœ** | `æ¨ªå‘å»¶ä¼¸ï¼ŒåµŒå¥—å¤š` | `çºµå‘æ’åˆ—ï¼Œæ¸…æ™°ç›´è§‚` |
| ğŸ› **è°ƒè¯•ä½“éªŒ** | `è°ƒè¯•å›°éš¾ï¼Œæ ˆè¿½è¸ªå¤æ‚` | `è°ƒè¯•ç®€å•ï¼ŒåƒåŒæ­¥ä»£ç ` |
| ğŸ”§ **ä¿®æ”¹ç»´æŠ¤** | `æ’å…¥æ–°æ­¥éª¤å¤æ‚` | `ç›´æ¥æ’å…¥ä¸€è¡Œå³å¯` |

### 2.3 æ›´å¥½çš„é”™è¯¯å¤„ç†


**ğŸ¯ é”™è¯¯å¤„ç†å¯¹æ¯”**
```javascript
// âŒ Promiseé“¾ï¼šé”™è¯¯å¤„ç†åˆ†æ•£
fetch('/api/data')
  .then(response => {
    if (!response.ok) {
      throw new Error('ç½‘ç»œè¯·æ±‚å¤±è´¥')
    }
    return response.json()
  })
  .then(data => {
    // å¤„ç†æ•°æ®...
  })
  .catch(error => {
    // å¤„ç†æ‰€æœ‰é”™è¯¯
  })

// âœ… async/awaitï¼šé”™è¯¯å¤„ç†é›†ä¸­
async function fetchData() {
  try {
    const response = await fetch('/api/data')
    if (!response.ok) {
      throw new Error('ç½‘ç»œè¯·æ±‚å¤±è´¥')
    }
    const data = await response.json()
    // å¤„ç†æ•°æ®...
  } catch (error) {
    // ç»Ÿä¸€å¤„ç†é”™è¯¯ï¼Œæ›´æ¸…æ™°
  }
}
```

---

## 3. ğŸ“ asyncå‡½æ•°çš„å£°æ˜å’Œä½¿ç”¨


### 3.1 asyncå‡½æ•°å£°æ˜è§„èŒƒ


**ğŸ”¸ åŸºæœ¬å£°æ˜è¯­æ³•**
```javascript
// 1ï¸âƒ£ å‡½æ•°å£°æ˜
async function myFunction() {
  return 'æˆ‘æ˜¯å¼‚æ­¥å‡½æ•°'
}

// 2ï¸âƒ£ å‡½æ•°è¡¨è¾¾å¼
const myFunction = async function() {
  return 'æˆ‘æ˜¯å¼‚æ­¥å‡½æ•°'
}

// 3ï¸âƒ£ ç®­å¤´å‡½æ•°
const myFunction = async () => {
  return 'æˆ‘æ˜¯å¼‚æ­¥å‡½æ•°'
}

// 4ï¸âƒ£ å¯¹è±¡æ–¹æ³•
const obj = {
  async getData() {
    return 'æˆ‘æ˜¯å¯¹è±¡çš„å¼‚æ­¥æ–¹æ³•'
  }
}
```

### 3.2 asyncå‡½æ•°çš„ç‰¹æ®Šæ€§è´¨


**ğŸ’¡ æ ¸å¿ƒç†è§£**
```
asyncå‡½æ•°çš„"é­”æ³•"ï¼š
1. è‡ªåŠ¨è¿”å›Promiseå¯¹è±¡
2. å†…éƒ¨å¯ä»¥ä½¿ç”¨awaitå…³é”®å­—
3. å³ä½¿returnæ™®é€šå€¼ï¼Œä¹Ÿä¼šè¢«åŒ…è£…æˆPromise
```

**ğŸ” ç¤ºä¾‹è¯´æ˜**
```javascript
// asyncå‡½æ•°è‡ªåŠ¨è¿”å›Promise
async function getName() {
  return 'Alice'  // æ™®é€šè¿”å›å€¼
}

// ç­‰ä»·äºï¼š
function getName() {
  return Promise.resolve('Alice')  // è¢«è‡ªåŠ¨åŒ…è£…
}

// ä½¿ç”¨æ—¶ï¼š
getName().then(name => console.log(name))  // è¾“å‡º: Alice
```

### 3.3 asyncå‡½æ•°çš„è¿”å›å€¼å¤„ç†


**ğŸ“Š è¿”å›å€¼ç±»å‹è¯´æ˜**

| è¿”å›å†…å®¹ | å®é™…ç»“æœ | è¯´æ˜ |
|---------|----------|------|
| `æ™®é€šå€¼` | `Promise.resolve(å€¼)` | `è‡ªåŠ¨åŒ…è£…æˆresolvedçŠ¶æ€` |
| `Promiseå¯¹è±¡` | `åŸPromiseå¯¹è±¡` | `ä¸é‡å¤åŒ…è£…` |
| `æŠ›å‡ºé”™è¯¯` | `Promise.reject(é”™è¯¯)` | `è‡ªåŠ¨å˜æˆrejectedçŠ¶æ€` |

```javascript
async function examples() {
  // è¿”å›æ™®é€šå€¼
  return 42  // â†’ Promise.resolve(42)
}

async function examplePromise() {
  // è¿”å›Promise
  return Promise.resolve('hello')  // â†’ ä¸ä¼šåŒé‡åŒ…è£…
}

async function exampleError() {
  // æŠ›å‡ºé”™è¯¯
  throw new Error('å‡ºé”™äº†')  // â†’ Promise.reject(Error)
}
```

---

## 4. â³ awaitç­‰å¾…å¼‚æ­¥æ“ä½œ


### 4.1 awaitå…³é”®å­—çš„ä½œç”¨


**ğŸ”¸ awaitçš„å«ä¹‰ç†è§£**
```
await = "ç­‰ä¸€ä¸‹" çš„æ„æ€
= æš‚åœå‡½æ•°æ‰§è¡Œï¼Œç­‰å¾…Promiseå®Œæˆ
= å¾—åˆ°Promiseçš„æœ€ç»ˆç»“æœ
= è®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç 
```

**ğŸ’¡ ç”Ÿæ´»ä¸­çš„ç±»æ¯”**
```
æ²¡æœ‰awaitï¼š
ä½ : "å¸®æˆ‘ä¹°ä¸ªå’–å•¡"
æœ‹å‹: "å¥½çš„"
ä½ : ç«‹å³é—®"å’–å•¡å‘¢ï¼Ÿ" âŒ (æœ‹å‹è¿˜æ²¡å»ä¹°)

æœ‰äº†awaitï¼š
ä½ : "å¸®æˆ‘ä¹°ä¸ªå’–å•¡"
await ç­‰å¾…...
ä½ : å¾—åˆ°å’–å•¡åæ‰ç»§ç»­ âœ…
```

### 4.2 awaitçš„ä½¿ç”¨è§„åˆ™


**ğŸ“‹ ä½¿ç”¨è§„èŒƒ**
```javascript
// âœ… æ­£ç¡®ç”¨æ³•ï¼šåªèƒ½åœ¨asyncå‡½æ•°å†…ä½¿ç”¨
async function correctUsage() {
  const result = await fetch('/api/data')
  return result
}

// âŒ é”™è¯¯ç”¨æ³•ï¼šä¸èƒ½åœ¨æ™®é€šå‡½æ•°ä¸­ä½¿ç”¨
function wrongUsage() {
  const result = await fetch('/api/data')  // è¯­æ³•é”™è¯¯ï¼
  return result
}

// âœ… é¡¶å±‚awaitï¼ˆES2022æ–°ç‰¹æ€§ï¼Œç°ä»£ç¯å¢ƒæ”¯æŒï¼‰
const data = await fetch('/api/data')  // åœ¨æ¨¡å—é¡¶å±‚å¯ç”¨
```

### 4.3 awaitçš„æ‰§è¡Œæœºåˆ¶


**ğŸ”„ æ‰§è¡Œæµç¨‹å›¾**
```
async function fetchData() {
  console.log('1. å¼€å§‹æ‰§è¡Œ')
  
  const response = await fetch('/api/data')  // â¸ï¸ æš‚åœç­‰å¾…
  console.log('3. è¯·æ±‚å®Œæˆï¼Œç»§ç»­æ‰§è¡Œ')
  
  const data = await response.json()        // â¸ï¸ å†æ¬¡æš‚åœç­‰å¾…
  console.log('5. è§£æå®Œæˆï¼Œç»§ç»­æ‰§è¡Œ')
  
  return data
}

console.log('2. asyncå‡½æ•°å¤–çš„ä»£ç ç»§ç»­æ‰§è¡Œ')  // ä¸è¢«é˜»å¡
console.log('4. è¿™é‡Œä¹Ÿä¼šæ­£å¸¸æ‰§è¡Œ')              // ä¸è¢«é˜»å¡
```

### 4.4 awaitå¤„ç†ä¸åŒç±»å‹çš„å€¼


**ğŸ“Š awaitè¡Œä¸ºè¯´æ˜**

| awaitçš„å€¼ | ç»“æœ | è¯´æ˜ |
|-----------|------|------|
| `Promiseå¯¹è±¡` | `ç­‰å¾…Promiseå®Œæˆï¼Œè¿”å›ç»“æœ` | `æ­£å¸¸çš„å¼‚æ­¥ç­‰å¾…` |
| `æ™®é€šå€¼` | `ç«‹å³è¿”å›è¯¥å€¼` | `ç›¸å½“äºawait Promise.resolve(å€¼)` |
| `thenableå¯¹è±¡` | `ç­‰å¾…thenæ–¹æ³•æ‰§è¡Œ` | `å…¼å®¹ç±»Promiseå¯¹è±¡` |

```javascript
async function examples() {
  // ç­‰å¾…Promise
  const result1 = await Promise.resolve('hello')
  console.log(result1)  // è¾“å‡º: hello
  
  // ç­‰å¾…æ™®é€šå€¼
  const result2 = await 42
  console.log(result2)  // è¾“å‡º: 42
  
  // ç­‰å¾…fetchè¯·æ±‚
  const response = await fetch('/api/data')
  const data = await response.json()
}
```

---

## 5. âš–ï¸ async/await vs Promiseé“¾çš„å¯¹æ¯”


### 5.1 ä»£ç é£æ ¼å¯¹æ¯”


**ğŸ”¸ Promiseé“¾å¼å†™æ³•**
```javascript
function fetchUserData() {
  return fetch('/api/user')
    .then(response => {
      if (!response.ok) {
        throw new Error('ç”¨æˆ·ä¿¡æ¯è·å–å¤±è´¥')
      }
      return response.json()
    })
    .then(user => {
      console.log('ç”¨æˆ·ä¿¡æ¯:', user)
      return fetch(`/api/profile/${user.id}`)
    })
    .then(response => response.json())
    .then(profile => {
      console.log('ç”¨æˆ·èµ„æ–™:', profile)
      return { user, profile }  // âŒ userå˜é‡åœ¨è¿™é‡Œä¸å¯ç”¨
    })
}
```

**âœ¨ async/awaitå†™æ³•**
```javascript
async function fetchUserData() {
  try {
    const response = await fetch('/api/user')
    if (!response.ok) {
      throw new Error('ç”¨æˆ·ä¿¡æ¯è·å–å¤±è´¥')
    }
    
    const user = await response.json()
    console.log('ç”¨æˆ·ä¿¡æ¯:', user)
    
    const profileResponse = await fetch(`/api/profile/${user.id}`)
    const profile = await profileResponse.json()
    console.log('ç”¨æˆ·èµ„æ–™:', profile)
    
    return { user, profile }  // âœ… æ‰€æœ‰å˜é‡éƒ½å¯ç”¨
  } catch (error) {
    console.error('è·å–æ•°æ®å¤±è´¥:', error)
  }
}
```

### 5.2 ä¼˜ç¼ºç‚¹æ·±åº¦å¯¹æ¯”


**ğŸ“Š è¯¦ç»†å¯¹æ¯”è¡¨**

| ç»´åº¦ | Promiseé“¾ | async/await | èƒœå‡º |
|------|-----------|-------------|------|
| ğŸ§  **å­¦ä¹ éš¾åº¦** | `éœ€è¦ç†è§£é“¾å¼è°ƒç”¨æ¦‚å¿µ` | `åƒæ™®é€šå‡½æ•°ä¸€æ ·ç†è§£` | `async/await` |
| ğŸ“– **ä»£ç å¯è¯»æ€§** | `åµŒå¥—å¤šï¼Œæ¨ªå‘å‘å±•` | `çº¿æ€§ç»“æ„ï¼Œçºµå‘å‘å±•` | `async/await` |
| ğŸ”§ **è°ƒè¯•ä½“éªŒ** | `è°ƒè¯•æ ˆä¿¡æ¯å¤æ‚` | `è°ƒè¯•ä¿¡æ¯æ¸…æ™°` | `async/await` |
| ğŸ“ **é”™è¯¯å¤„ç†** | `éœ€è¦åœ¨.catchä¸­ç»Ÿä¸€å¤„ç†` | `å¯ç”¨try/catchç²¾ç¡®å¤„ç†` | `async/await` |
| ğŸ¯ **å˜é‡ä½œç”¨åŸŸ** | `å˜é‡åœ¨é“¾æ¡ä¸­ä¼ é€’å›°éš¾` | `æ‰€æœ‰å˜é‡éƒ½åœ¨åŒä¸€ä½œç”¨åŸŸ` | `async/await` |
| âš¡ **æ€§èƒ½** | `ç•¥å¾®æ›´é«˜æ•ˆ` | `å‡ ä¹æ— å·®åˆ«` | `å¹³æ‰‹` |
| ğŸŒ **æµè§ˆå™¨å…¼å®¹** | `ES6æ”¯æŒæ›´å¹¿æ³›` | `éœ€è¦ES2017+æ”¯æŒ` | `Promiseé“¾` |

### 5.3 ä½¿ç”¨åœºæ™¯é€‰æ‹©æŒ‡å—


**ğŸ¯ ä»€ä¹ˆæ—¶å€™ç”¨Promiseé“¾ï¼Ÿ**
- âœ… éœ€è¦å…¼å®¹è€ç‰ˆæœ¬æµè§ˆå™¨
- âœ… ç®€å•çš„å•ä¸€å¼‚æ­¥æ“ä½œ
- âœ… å‡½æ•°å¼ç¼–ç¨‹é£æ ¼é¡¹ç›®

**ğŸ¯ ä»€ä¹ˆæ—¶å€™ç”¨async/awaitï¼Ÿ**
- âœ… å¤æ‚çš„å¼‚æ­¥æµç¨‹æ§åˆ¶
- âœ… éœ€è¦å¤šä¸ªå¼‚æ­¥æ“ä½œåä½œ
- âœ… å›¢é˜Ÿæ›´åå¥½å¯è¯»æ€§
- âœ… ç°ä»£é¡¹ç›®ï¼ˆæ¨èï¼‰

---

## 6. ğŸ›¡ï¸ try-catché”™è¯¯å¤„ç†ç»“åˆ


### 6.1 ä¸ºä»€ä¹ˆéœ€è¦try-catch


**ğŸ”¸ å¼‚æ­¥é”™è¯¯çš„ç‰¹æ®Šæ€§**
```
ä¼ ç»ŸåŒæ­¥ä»£ç é”™è¯¯ï¼š
- å¯ä»¥ç”¨try-catchç›´æ¥æ•è·
- é”™è¯¯å‘ç”Ÿåœ¨å½“å‰æ‰§è¡Œä¸Šä¸‹æ–‡

å¼‚æ­¥ä»£ç é”™è¯¯ï¼š
- Promiseé“¾ä¸­ç”¨.catch()æ•è·
- async/awaitä¸­ç”¨try-catchæ•è·
- éœ€è¦æ˜ç¡®çš„é”™è¯¯å¤„ç†ç­–ç•¥
```

**ğŸ’¡ é”™è¯¯å¤„ç†çš„é‡è¦æ€§**
```
æ²¡æœ‰é”™è¯¯å¤„ç†çš„åæœï¼š
âŒ ç¨‹åºå¯èƒ½é™é»˜å¤±è´¥
âŒ ç”¨æˆ·çœ‹åˆ°ç©ºç™½é¡µé¢
âŒ éš¾ä»¥å®šä½é—®é¢˜æ‰€åœ¨
âŒ ç”¨æˆ·ä½“éªŒæå·®

æœ‰äº†é”™è¯¯å¤„ç†çš„å¥½å¤„ï¼š
âœ… ç¨‹åºæ›´ç¨³å®š
âœ… ç»™ç”¨æˆ·å‹å¥½æç¤º
âœ… ä¾¿äºé—®é¢˜æ’æŸ¥
âœ… æå‡ç”¨æˆ·ä½“éªŒ
```

### 6.2 try-catchçš„åŸºæœ¬ç»“æ„


**ğŸ“‹ æ ‡å‡†å†™æ³•æ¨¡æ¿**
```javascript
async function standardPattern() {
  try {
    // 1ï¸âƒ£ å°è¯•æ‰§è¡Œå¯èƒ½å‡ºé”™çš„å¼‚æ­¥æ“ä½œ
    const response = await fetch('/api/data')
    const data = await response.json()
    
    // 2ï¸âƒ£ å¤„ç†æˆåŠŸçš„ç»“æœ
    console.log('æ•°æ®è·å–æˆåŠŸ:', data)
    return data
    
  } catch (error) {
    // 3ï¸âƒ£ å¤„ç†æ‰€æœ‰å¯èƒ½çš„é”™è¯¯
    console.error('æ“ä½œå¤±è´¥:', error.message)
    
    // 4ï¸âƒ£ å¯é€‰ï¼šé‡æ–°æŠ›å‡ºé”™è¯¯æˆ–è¿”å›é»˜è®¤å€¼
    return null
  }
}
```

### 6.3 ç²¾ç¡®çš„é”™è¯¯å¤„ç†ç­–ç•¥


**ğŸ¯ ä¸åŒç±»å‹é”™è¯¯çš„å¤„ç†**
```javascript
async function preciseErrorHandling() {
  try {
    const response = await fetch('/api/data')
    
    // æ£€æŸ¥HTTPçŠ¶æ€ç 
    if (!response.ok) {
      if (response.status === 404) {
        throw new Error('æ•°æ®ä¸å­˜åœ¨')
      } else if (response.status === 500) {
        throw new Error('æœåŠ¡å™¨å†…éƒ¨é”™è¯¯')
      } else {
        throw new Error(`è¯·æ±‚å¤±è´¥: ${response.status}`)
      }
    }
    
    const data = await response.json()
    return data
    
  } catch (error) {
    // åŒºåˆ†ä¸åŒç±»å‹çš„é”™è¯¯
    if (error.name === 'TypeError') {
      console.error('ç½‘ç»œè¿æ¥é—®é¢˜:', error.message)
      return { error: 'ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ' }
    } else if (error.message.includes('æ•°æ®ä¸å­˜åœ¨')) {
      console.error('æ•°æ®æœªæ‰¾åˆ°:', error.message)
      return { error: 'è¯·æ±‚çš„æ•°æ®ä¸å­˜åœ¨' }
    } else {
      console.error('æœªçŸ¥é”™è¯¯:', error.message)
      return { error: 'æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•' }
    }
  }
}
```

### 6.4 try-catchçš„æœ€ä½³å®è·µ


**ğŸ† æ¨èçš„é”™è¯¯å¤„ç†æ¨¡å¼**
```javascript
// âœ… æ¨èï¼šç»†åˆ†é”™è¯¯ç±»å‹ï¼Œç»™ç”¨æˆ·æ˜ç¡®åé¦ˆ
async function bestPractice() {
  try {
    const response = await fetch('/api/user')
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`)
    }
    
    const user = await response.json()
    return { success: true, data: user }
    
  } catch (error) {
    // è®°å½•è¯¦ç»†é”™è¯¯ä¿¡æ¯ä¾›å¼€å‘è€…æŸ¥çœ‹
    console.error('fetchUser é”™è¯¯è¯¦æƒ…:', {
      message: error.message,
      stack: error.stack,
      timestamp: new Date().toISOString()
    })
    
    // è¿”å›ç”¨æˆ·å‹å¥½çš„é”™è¯¯ä¿¡æ¯
    return { 
      success: false, 
      error: 'è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•' 
    }
  }
}

// ä½¿ç”¨æ—¶ï¼š
const result = await bestPractice()
if (result.success) {
  console.log('ç”¨æˆ·ä¿¡æ¯:', result.data)
} else {
  alert(result.error)  // ç”¨æˆ·çœ‹åˆ°å‹å¥½æç¤º
}
```

---

## 7. ğŸš€ ç°ä»£JavaScriptæ¨èå†™æ³•


### 7.1 ä»£ç ç»“æ„æœ€ä½³å®è·µ


**ğŸ¯ æ¸…æ™°çš„å‡½æ•°ç»„ç»‡**
```javascript
// âœ… æ¨èï¼šå•ä¸€èŒè´£ï¼ŒåŠŸèƒ½æ˜ç¡®
async function fetchUserInfo(userId) {
  try {
    const response = await fetch(`/api/users/${userId}`)
    if (!response.ok) {
      throw new Error('ç”¨æˆ·ä¿¡æ¯è·å–å¤±è´¥')
    }
    return await response.json()
  } catch (error) {
    console.error('fetchUserInfo é”™è¯¯:', error)
    throw error  // é‡æ–°æŠ›å‡ºï¼Œè®©è°ƒç”¨è€…å¤„ç†
  }
}

async function fetchUserPosts(userId) {
  try {
    const response = await fetch(`/api/users/${userId}/posts`)
    if (!response.ok) {
      throw new Error('ç”¨æˆ·æ–‡ç« è·å–å¤±è´¥')
    }
    return await response.json()
  } catch (error) {
    console.error('fetchUserPosts é”™è¯¯:', error)
    throw error
  }
}

// ç»„åˆä½¿ç”¨
async function getUserProfile(userId) {
  try {
    const [userInfo, userPosts] = await Promise.all([
      fetchUserInfo(userId),
      fetchUserPosts(userId)
    ])
    
    return {
      info: userInfo,
      posts: userPosts
    }
  } catch (error) {
    return { error: 'è·å–ç”¨æˆ·èµ„æ–™å¤±è´¥' }
  }
}
```

### 7.2 ç°ä»£åŒ–çš„å·¥å…·å‡½æ•°å°è£…


**ğŸ”§ å®ç”¨çš„å·¥å…·å‡½æ•°**
```javascript
// é€šç”¨çš„APIè¯·æ±‚å·¥å…·
async function apiRequest(url, options = {}) {
  try {
    const response = await fetch(url, {
      headers: {
        'Content-Type': 'application/json',
        ...options.headers
      },
      ...options
    })
    
    if (!response.ok) {
      throw new Error(`APIè¯·æ±‚å¤±è´¥: ${response.status}`)
    }
    
    return await response.json()
  } catch (error) {
    console.error('APIè¯·æ±‚é”™è¯¯:', error)
    throw error
  }
}

// å¸¦è¶…æ—¶çš„è¯·æ±‚
async function requestWithTimeout(url, timeout = 5000) {
  const controller = new AbortController()
  const timeoutId = setTimeout(() => controller.abort(), timeout)
  
  try {
    const response = await fetch(url, {
      signal: controller.signal
    })
    clearTimeout(timeoutId)
    return response
  } catch (error) {
    clearTimeout(timeoutId)
    if (error.name === 'AbortError') {
      throw new Error('è¯·æ±‚è¶…æ—¶')
    }
    throw error
  }
}
```

### 7.3 å›¢é˜Ÿåä½œçš„ä»£ç è§„èŒƒ


**ğŸ“š æ¨èçš„å‘½åå’Œæ³¨é‡Šè§„èŒƒ**
```javascript
/**
 * è·å–ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯
 * @param {string} userId - ç”¨æˆ·ID
 * @returns {Promise<Object>} ç”¨æˆ·ä¿¡æ¯å¯¹è±¡
 * @throws {Error} å½“ç”¨æˆ·ä¸å­˜åœ¨æˆ–ç½‘ç»œé”™è¯¯æ—¶æŠ›å‡ºå¼‚å¸¸
 */
async function getUserDetails(userId) {
  if (!userId) {
    throw new Error('ç”¨æˆ·IDä¸èƒ½ä¸ºç©º')
  }
  
  try {
    const response = await fetch(`/api/users/${userId}`)
    
    if (response.status === 404) {
      throw new Error('ç”¨æˆ·ä¸å­˜åœ¨')
    }
    
    if (!response.ok) {
      throw new Error(`è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥: ${response.statusText}`)
    }
    
    const userDetails = await response.json()
    return userDetails
    
  } catch (error) {
    // è®°å½•é”™è¯¯ä¾›è°ƒè¯•ä½¿ç”¨
    console.error(`è·å–ç”¨æˆ·${userId}çš„è¯¦æƒ…å¤±è´¥:`, error.message)
    throw error
  }
}
```

### 7.4 æ€§èƒ½ä¼˜åŒ–çš„å†™æ³•


**âš¡ å¹¶è¡Œå¤„ç†å¤šä¸ªå¼‚æ­¥æ“ä½œ**
```javascript
// âŒ ä¸²è¡Œæ‰§è¡Œï¼šé€Ÿåº¦æ…¢
async function slowWay() {
  const user = await fetchUser()        // ç­‰å¾…1ç§’
  const posts = await fetchPosts()      // å†ç­‰å¾…1ç§’
  const comments = await fetchComments() // å†ç­‰å¾…1ç§’
  // æ€»å…±3ç§’
}

// âœ… å¹¶è¡Œæ‰§è¡Œï¼šé€Ÿåº¦å¿«
async function fastWay() {
  const [user, posts, comments] = await Promise.all([
    fetchUser(),        // 3ä¸ªè¯·æ±‚åŒæ—¶å‘å‡º
    fetchPosts(),       // å¹¶è¡Œæ‰§è¡Œ
    fetchComments()     // ç­‰å¾…æœ€æ…¢çš„é‚£ä¸ª
  ])
  // æ€»å…±çº¦1ç§’
}

// âœ… éƒ¨åˆ†ä¾èµ–çš„ä¼˜åŒ–å†™æ³•
async function smartWay() {
  // å…ˆè·å–ç”¨æˆ·ä¿¡æ¯
  const user = await fetchUser()
  
  // åŸºäºç”¨æˆ·IDå¹¶è¡Œè·å–å…¶ä»–ä¿¡æ¯
  const [posts, profile] = await Promise.all([
    fetchUserPosts(user.id),
    fetchUserProfile(user.id)
  ])
  
  return { user, posts, profile }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ async/awaitæœ¬è´¨ï¼šPromiseçš„è¯­æ³•ç³–ï¼Œè®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥
ğŸ”¸ asyncå‡½æ•°ï¼šè‡ªåŠ¨è¿”å›Promiseï¼Œå†…éƒ¨å¯ä½¿ç”¨await
ğŸ”¸ awaitå…³é”®å­—ï¼šæš‚åœæ‰§è¡Œï¼Œç­‰å¾…Promiseå®Œæˆï¼Œè·å–ç»“æœ
ğŸ”¸ é”™è¯¯å¤„ç†ï¼šç”¨try-catchæ•è·å¼‚æ­¥æ“ä½œä¸­çš„é”™è¯¯
ğŸ”¸ ä»£ç å¯è¯»æ€§ï¼šçº¿æ€§ç»“æ„ï¼Œå˜é‡ä½œç”¨åŸŸæ¸…æ™°
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä»€ä¹ˆæ—¶å€™ç”¨async/await**
```
æ¨èåœºæ™¯ï¼š
âœ… å¤šä¸ªä¾èµ–çš„å¼‚æ­¥æ“ä½œ
âœ… å¤æ‚çš„é”™è¯¯å¤„ç†é€»è¾‘
âœ… éœ€è¦æ¸…æ™°çš„ä»£ç ç»“æ„
âœ… ç°ä»£JavaScripté¡¹ç›®

ä¸æ¨èåœºæ™¯ï¼š
âŒ ç®€å•çš„å•ä¸€å¼‚æ­¥æ“ä½œ
âŒ éœ€è¦å…¼å®¹å¾ˆè€çš„æµè§ˆå™¨
âŒ çº¯å‡½æ•°å¼ç¼–ç¨‹é£æ ¼
```

**ğŸ”¹ å¸¸è§è¯¯åŒºé¿å…**
```
âŒ è¯¯åŒº1ï¼šåœ¨æ™®é€šå‡½æ•°ä¸­ä½¿ç”¨await
âŒ è¯¯åŒº2ï¼šå¿˜è®°ä½¿ç”¨try-catchå¤„ç†é”™è¯¯
âŒ è¯¯åŒº3ï¼šä¸å¿…è¦çš„ä¸²è¡Œç­‰å¾…ï¼ˆåº”è¯¥ç”¨Promise.allï¼‰
âŒ è¯¯åŒº4ï¼šè¿‡åº¦ä½¿ç”¨asyncï¼ˆç®€å•Promiseç”¨.thenå³å¯ï¼‰
```

### 8.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ’¡ ä¸ºä»€ä¹ˆå­¦ä¹ async/awaitå¾ˆé‡è¦**
- **ğŸ¯ ç°ä»£æ ‡å‡†**ï¼šES2017+çš„æ ‡å‡†è¯­æ³•ï¼Œç°ä»£é¡¹ç›®å¿…å¤‡
- **ğŸ‘¥ å›¢é˜Ÿåä½œ**ï¼šä»£ç æ›´å®¹æ˜“ç†è§£å’Œç»´æŠ¤
- **ğŸ› è°ƒè¯•ä½“éªŒ**ï¼šé”™è¯¯æ ˆæ›´æ¸…æ™°ï¼Œè°ƒè¯•æ›´æ–¹ä¾¿
- **ğŸ“š å­¦ä¹ åŸºç¡€**ï¼šç†è§£ç°ä»£JavaScriptå¼‚æ­¥ç¼–ç¨‹çš„åŸºç¡€

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- *asyncå‡½æ•°è‡ªåŠ¨åŒ…Promiseï¼Œawaitæš‚åœç­‰ç»“æœ*
- *try-catchæ•è·å¼‚æ­¥é”™ï¼Œä»£ç æ¸…æ™°æ˜“ç»´æŠ¤*
- *å‘Šåˆ«å›è°ƒä¸é“¾å¼è°ƒï¼Œç°ä»£è¯­æ³•æ›´ä¼˜é›…*