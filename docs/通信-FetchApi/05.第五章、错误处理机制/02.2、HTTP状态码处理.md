---
title: 2、HTTP状态码处理
---
## 📚 目录

1. [HTTP状态码是什么](#1-HTTP状态码是什么)
2. [状态码的分类规律](#2-状态码的分类规律)
3. [成功状态码处理](#3-成功状态码处理)
4. [客户端错误处理](#4-客户端错误处理)
5. [服务器错误处理](#5-服务器错误处理)
6. [重定向状态码](#6-重定向状态码)
7. [实际应用策略](#7-实际应用策略)
8. [核心要点总结](#8-核心要点总结)

---

## 1. 🤔 HTTP状态码是什么


### 1.1 简单理解状态码


**状态码就像快递的签收单**
```
想象你网购后等快递：
✅ 200 - 商品完好送达（请求成功）
❌ 404 - 地址找不到（页面不存在） 
❌ 500 - 仓库出故障（服务器错误）
🔄 301 - 搬家了，新地址在这（永久重定向）
```

**本质含义**：
- HTTP状态码是服务器告诉浏览器"处理结果"的**三位数字**
- 就像医生看病后告诉你"没事、小感冒、需要住院"一样
- 帮助我们判断请求是否成功，出了什么问题

### 1.2 状态码的作用


```
🎯 为什么需要状态码？

没有状态码的世界：
客户端: "给我首页内容"
服务器: "这里是错误信息..." 
客户端: 😕 不知道是成功还是失败

有状态码的世界：
客户端: "给我首页内容"
服务器: "404 + 页面不存在的提示"
客户端: 😊 知道是找不到页面，可以显示友好提示
```

---

## 2. 📊 状态码的分类规律


### 2.1 五大类别


HTTP状态码按**第一位数字**分成5类，就像学校的年级划分：

```
📚 状态码分类表

分类    范围      含义                 生活比喻
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1xx   100-199   信息提示           "请稍等，正在处理中..."
2xx   200-299   成功完成           "任务完成！"
3xx   300-399   需要进一步操作       "请到新地址领取"
4xx   400-499   客户端错误          "你的请求有问题"
5xx   500-599   服务器错误          "我们这边出故障了"
```

### 2.2 记忆技巧


> **💡 记忆口诀**
> - **2开头最开心** - 成功了！
> - **3开头要跳转** - 去别的地方
> - **4开头是你错** - 客户端问题
> - **5开头是我错** - 服务器问题

---

## 3. ✅ 成功状态码处理


### 3.1 常见成功状态码


**200 OK - 最常见的成功**
```javascript
// 200：一切正常，这是最理想的情况
fetch('/api/users')
  .then(response => {
    if (response.status === 200) {
      console.log('✅ 数据获取成功');
      return response.json();
    }
  });

// 实际含义：就像问路时，对方详细告诉你怎么走
```

**201 Created - 创建成功**
```javascript
// 201：新数据创建成功（比如注册新用户）
fetch('/api/users', {
  method: 'POST',
  body: JSON.stringify({name: '张三'})
})
.then(response => {
  if (response.status === 201) {
    console.log('✅ 用户创建成功');
  }
});

// 实际含义：就像在银行开户，告诉你"账户已开设成功"
```

**204 No Content - 成功但没内容**
```javascript
// 204：操作成功，但没有返回内容（比如删除操作）
fetch('/api/users/123', {method: 'DELETE'})
  .then(response => {
    if (response.status === 204) {
      console.log('✅ 删除成功');
      // 注意：204不要调用response.json()，因为没有内容
    }
  });

// 实际含义：就像扔垃圾，垃圾桶不会回复你，但垃圾确实扔掉了
```

### 3.2 成功状态码处理策略


```javascript
// 🎯 统一的成功处理函数
function handleSuccess(response) {
  switch(response.status) {
    case 200:
      return response.json(); // 有数据返回
    case 201:
      console.log('创建成功');
      return response.json();
    case 204:
      console.log('操作成功');
      return null; // 没有数据返回
    default:
      return response.json();
  }
}
```

---

## 4. ❌ 客户端错误处理


### 4.1 核心4xx错误详解


**400 Bad Request - 请求格式错误**
```javascript
// 400：就像说话语法不对，对方听不懂
fetch('/api/users', {
  method: 'POST',
  body: 'invalid json格式' // 💥 错误的数据格式
})
.then(response => {
  if (response.status === 400) {
    console.log('❌ 请求数据格式错误，请检查');
    // 用户提示：请检查输入的信息格式
  }
});
```

**401 Unauthorized - 没有登录**
```javascript
// 401：就像进VIP区域，门卫说"请先出示会员卡"
fetch('/api/profile') // 访问个人信息，但没登录
  .then(response => {
    if (response.status === 401) {
      console.log('❌ 请先登录');
      // 用户操作：跳转到登录页面
      window.location.href = '/login';
    }
  });
```

**403 Forbidden - 权限不够**
```javascript
// 403：已经登录了，但权限不够（比如普通用户想删除别人的文章）
fetch('/api/admin/users', {method: 'DELETE'})
  .then(response => {
    if (response.status === 403) {
      console.log('❌ 权限不足，无法执行此操作');
      // 用户提示：您没有权限执行此操作
    }
  });
```

**404 Not Found - 找不到资源**
```javascript
// 404：就像按错门牌号，这个地址没有你要找的东西
fetch('/api/users/999999') // 用户ID不存在
  .then(response => {
    if (response.status === 404) {
      console.log('❌ 用户不存在');
      // 用户提示：未找到相关信息
    }
  });
```

### 4.2 用户友好的错误提示


```javascript
// 🎨 根据不同错误给出友好提示
function showUserMessage(status) {
  const messages = {
    400: '输入信息有误，请检查后重试',
    401: '请先登录后再进行操作',
    403: '抱歉，您没有权限执行此操作',
    404: '抱歉，未找到相关信息',
    429: '操作太频繁，请稍后再试'
  };
  
  alert(messages[status] || '请求失败，请稍后重试');
}
```

---

## 5. 💥 服务器错误处理


### 5.1 常见5xx错误


**500 Internal Server Error - 服务器内部错误**
```javascript
// 500：就像餐厅厨房突然停电，无法做菜
fetch('/api/users')
  .then(response => {
    if (response.status === 500) {
      console.log('❌ 服务器出现故障');
      // 用户提示：服务暂时不可用，请稍后重试
    }
  });

// 💡 处理策略：自动重试或显示友好错误页面
```

**502 Bad Gateway - 网关错误**
```javascript
// 502：就像快递员找不到收件人，中间环节出问题
// 通常是代理服务器或负载均衡器的问题
if (response.status === 502) {
  console.log('❌ 网络连接异常');
  // 用户提示：网络连接异常，请检查网络后重试
}
```

**503 Service Unavailable - 服务不可用**
```javascript
// 503：就像银行系统维护，暂停营业
// 通常是服务器过载或维护
if (response.status === 503) {
  console.log('❌ 服务暂时不可用');
  // 用户提示：系统维护中，请稍后访问
}
```

### 5.2 服务器错误处理策略


```javascript
// 🔄 自动重试机制
async function fetchWithRetry(url, options = {}, maxRetries = 3) {
  for (let i = 0; i < maxRetries; i++) {
    try {
      const response = await fetch(url, options);
      
      // 5xx错误才重试
      if (response.status >= 500) {
        console.log(`第 ${i + 1} 次重试...`);
        await new Promise(resolve => setTimeout(resolve, 1000 * i)); // 递增延迟
        continue;
      }
      
      return response;
    } catch (error) {
      if (i === maxRetries - 1) throw error;
    }
  }
}
```

---

## 6. 🔄 重定向状态码


### 6.1 重定向的含义


**重定向就像"搬家通知"**
```
原来的地址：www.old-site.com
新的地址：www.new-site.com

301：永久搬家 - "我们永远搬到新地址了"
302：临时搬家 - "我们临时在新地址，以后可能搬回来"
```

### 6.2 重定向处理


**301 Moved Permanently - 永久重定向**
```javascript
// 301：网站永久搬家了
fetch('/old-page')
  .then(response => {
    if (response.status === 301) {
      console.log('页面已永久移动');
      // 浏览器会自动跳转，通常不需要手动处理
    }
  });
```

**302 Found - 临时重定向**
```javascript
// 302：临时跳转（比如登录后跳转到首页）
// 浏览器通常会自动处理重定向
// 如果需要手动控制：
fetch('/api/login', {
  method: 'POST',
  redirect: 'manual' // 手动处理重定向
})
.then(response => {
  if (response.status === 302) {
    const newLocation = response.headers.get('Location');
    console.log('重定向到：', newLocation);
  }
});
```

---

## 7. 🎯 实际应用策略


### 7.1 完整的状态码处理


```javascript
// 🎯 真实项目中的状态码处理函数
async function handleResponse(response) {
  const status = response.status;
  
  // 成功状态码 (2xx)
  if (status >= 200 && status < 300) {
    if (status === 204) {
      return { success: true, data: null };
    }
    const data = await response.json();
    return { success: true, data };
  }
  
  // 客户端错误 (4xx)
  if (status >= 400 && status < 500) {
    const errorMessages = {
      400: '请求参数错误',
      401: '请先登录',
      403: '权限不足',
      404: '资源不存在',
      422: '数据验证失败',
      429: '请求过于频繁'
    };
    
    const message = errorMessages[status] || '请求失败';
    return { success: false, error: message, status };
  }
  
  // 服务器错误 (5xx)
  if (status >= 500) {
    return { 
      success: false, 
      error: '服务器繁忙，请稍后重试', 
      status 
    };
  }
  
  return { success: false, error: '未知错误', status };
}
```

### 7.2 用户体验优化


```javascript
// 🎨 根据状态码显示不同的用户界面
function showStatusMessage(result) {
  if (result.success) {
    // ✅ 成功提示
    showSuccessToast('操作成功');
    return;
  }
  
  switch (result.status) {
    case 401:
      // 🔒 显示登录模态框
      showLoginModal();
      break;
      
    case 403:
      // ⛔ 显示权限不足页面
      showNoPermissionPage();
      break;
      
    case 404:
      // 🔍 显示404页面
      show404Page();
      break;
      
    case 500:
    case 502:
    case 503:
      // 💥 显示服务器错误页面
      showServerErrorPage();
      break;
      
    default:
      // ❌ 显示通用错误提示
      showErrorToast(result.error);
  }
}
```

### 7.3 业务逻辑集成


```javascript
// 🔧 在实际业务中的应用
async function loadUserProfile() {
  try {
    const response = await fetch('/api/profile');
    const result = await handleResponse(response);
    
    if (result.success) {
      // 成功：显示用户信息
      displayUserInfo(result.data);
    } else {
      // 失败：显示对应的错误处理
      showStatusMessage(result);
    }
  } catch (error) {
    // 网络错误
    showErrorToast('网络连接失败，请检查网络设置');
  }
}
```

---

## 8. 📋 核心要点总结


### 8.1 必须记住的状态码


```
🔥 最重要的状态码（必知必会）

✅ 200 - 成功          最常见，一切正常
❌ 404 - 找不到        最常见错误，资源不存在  
❌ 500 - 服务器错误     最常见服务器问题
🔒 401 - 未登录        需要登录才能访问
⛔ 403 - 权限不足      登录了但权限不够
🔄 301 - 永久重定向     页面永久搬家了
```

### 8.2 状态码处理三原则


> **💡 黄金法则**
> 1. **2xx就开心** - 成功了，正常处理数据
> 2. **4xx找自己** - 客户端问题，检查请求
> 3. **5xx找客服** - 服务器问题，稍后重试

### 8.3 实际开发建议


**🎯 最佳实践**
```
DO ✅
- 总是检查 response.status
- 给用户友好的错误提示
- 对5xx错误实现重试机制
- 401错误自动跳转登录页

DON'T ❌  
- 不要忽略状态码直接解析数据
- 不要给用户显示技术性错误信息
- 不要对所有错误都重试
- 不要把404当作严重错误
```

**🧠 记忆要点**
- HTTP状态码就像**快递签收单**，告诉你处理结果
- **第一位数字**决定大类：2成功、4你错、5我错  
- **200、404、500**是最核心的三个，必须熟记
- 根据不同状态码给用户**不同的操作建议**

**核心理解**：状态码不是用来吓唬人的，而是帮助我们更好地处理各种情况，给用户更好的体验！