---
title: 4ã€æ•…éšœéš”ç¦»æŠ€æœ¯
---
## ğŸ“š ç›®å½•

1. [æ•…éšœéš”ç¦»åŸºæœ¬æ¦‚å¿µ](#1-æ•…éšœéš”ç¦»åŸºæœ¬æ¦‚å¿µ)
2. [æœåŠ¡éš”ç¦»è®¾è®¡](#2-æœåŠ¡éš”ç¦»è®¾è®¡)
3. [çº¿ç¨‹æ± éš”ç¦»](#3-çº¿ç¨‹æ± éš”ç¦»)
4. [æ•°æ®åº“éš”ç¦»](#4-æ•°æ®åº“éš”ç¦»)
5. [èµ„æºéš”ç¦»ç­–ç•¥](#5-èµ„æºéš”ç¦»ç­–ç•¥)
6. [æ•…éšœå¤„ç†æ€ç»´ä½“ç³»](#6-æ•…éšœå¤„ç†æ€ç»´ä½“ç³»)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”’ æ•…éšœéš”ç¦»åŸºæœ¬æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯æ•…éšœéš”ç¦»


**ğŸ¯ é€šä¿—ç†è§£**
æ•…éšœéš”ç¦»å°±åƒæ˜¯ç»™æˆ¿å­è£…é˜²ç«å¢™ï¼Œå½“ä¸€ä¸ªæˆ¿é—´ç€ç«æ—¶ï¼Œä¸ä¼šçƒ§åˆ°å…¶ä»–æˆ¿é—´ã€‚åœ¨ç¨‹åºä¸–ç•Œé‡Œï¼Œå°±æ˜¯å½“ä¸€ä¸ªåŠŸèƒ½å‡ºé—®é¢˜æ—¶ï¼Œä¸å½±å“å…¶ä»–åŠŸèƒ½æ­£å¸¸å·¥ä½œã€‚

> ğŸ’¡ **æ ¸å¿ƒæ€æƒ³**ï¼šæŠŠç³»ç»Ÿåˆ†æˆç‹¬ç«‹çš„"éš”é—´"ï¼Œä¸€ä¸ªéš”é—´å‡ºæ•…éšœï¼Œå…¶ä»–éš”é—´è¿˜èƒ½æ­£å¸¸è¿è¡Œ

**ğŸ”¸ ç°å®ç±»æ¯”**
```
èˆ¹èˆ±è®¾è®¡ï¼š          ç¨‹åºè®¾è®¡ï¼š
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚èˆ±å®¤1â”‚èˆ±å®¤2â”‚èˆ±å®¤3â”‚   â”‚æœåŠ¡Aâ”‚æœåŠ¡Bâ”‚æœåŠ¡Câ”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜

ä¸€ä¸ªèˆ±å®¤è¿›æ°´ â‰  æ•´èˆ¹æ²‰æ²¡    ä¸€ä¸ªæœåŠ¡æŒ‚æ‰ â‰  æ•´ä¸ªç³»ç»Ÿå´©æºƒ
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦æ•…éšœéš”ç¦»


**âŒ æ²¡æœ‰éš”ç¦»çš„åæœ**
- ä¸€ä¸ªå°åŠŸèƒ½å‡ºé”™ï¼Œæ•´ä¸ªç³»ç»Ÿç˜«ç—ª
- ç”¨æˆ·è®¿é—®é‡çªå¢ï¼Œæ‰€æœ‰åŠŸèƒ½éƒ½å˜æ…¢
- æ•°æ®åº“è¿æ¥æ± è€—å°½ï¼Œæ•´ä¸ªåº”ç”¨å¡æ­»

**âœ… éš”ç¦»å¸¦æ¥çš„å¥½å¤„**
- æ•…éšœå½±å“èŒƒå›´å¯æ§
- æ ¸å¿ƒåŠŸèƒ½å§‹ç»ˆå¯ç”¨
- é—®é¢˜å®šä½æ›´å®¹æ˜“
- ç³»ç»Ÿæ•´ä½“æ›´ç¨³å®š

### 1.3 éš”ç¦»çš„æ ¸å¿ƒåŸåˆ™


```
ğŸ”¸ èµ„æºç‹¬ç«‹ï¼šæ¯ä¸ªæ¨¡å—æœ‰è‡ªå·±çš„èµ„æº
ğŸ”¸ æ•…éšœç‹¬ç«‹ï¼šä¸€ä¸ªæ¨¡å—å‡ºé”™ä¸å½±å“å…¶ä»–æ¨¡å—
ğŸ”¸ æ¢å¤ç‹¬ç«‹ï¼šåæ‰çš„æ¨¡å—å¯ä»¥å•ç‹¬ä¿®å¤
ğŸ”¸ ç›‘æ§ç‹¬ç«‹ï¼šå¯ä»¥å•ç‹¬ç›‘æ§æ¯ä¸ªæ¨¡å—çš„çŠ¶æ€
```

---

## 2. ğŸ¢ æœåŠ¡éš”ç¦»è®¾è®¡


### 2.1 ä»€ä¹ˆæ˜¯æœåŠ¡éš”ç¦»


**ğŸ¯ ç®€å•ç†è§£**
æœåŠ¡éš”ç¦»å°±æ˜¯æŠŠä¸åŒçš„ä¸šåŠ¡åŠŸèƒ½åˆ†å¼€è¿è¡Œï¼Œåƒæ˜¯æŠŠä¸åŒçš„å•†åº—åˆ†å¼€ç»è¥ï¼Œä¸€å®¶åº—å‡ºé—®é¢˜ä¸å½±å“å…¶ä»–åº—ã€‚

**ğŸ”¸ éš”ç¦»æ–¹å¼å¯¹æ¯”**
```
å•ä½“åº”ç”¨ï¼ˆæ²¡æœ‰éš”ç¦»ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·æœåŠ¡ | è®¢å•æœåŠ¡ | æ”¯ä»˜æœåŠ¡  â”‚
â”‚       æ‰€æœ‰åŠŸèƒ½åœ¨ä¸€èµ·        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
é—®é¢˜ï¼šä¸€ä¸ªåŠŸèƒ½å´©æºƒï¼Œå…¨éƒ¨å´©æºƒ

å¾®æœåŠ¡ï¼ˆæœåŠ¡éš”ç¦»ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·æœåŠ¡ â”‚  â”‚ è®¢å•æœåŠ¡ â”‚  â”‚ æ”¯ä»˜æœåŠ¡ â”‚
â”‚ç‹¬ç«‹è¿è¡Œ â”‚  â”‚ç‹¬ç«‹è¿è¡Œ â”‚  â”‚ç‹¬ç«‹è¿è¡Œ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
å¥½å¤„ï¼šä¸€ä¸ªæœåŠ¡å‡ºé—®é¢˜ï¼Œå…¶ä»–æœåŠ¡æ­£å¸¸
```

### 2.2 è¿›ç¨‹çº§éš”ç¦»


**ğŸ”¸ åŸºæœ¬åšæ³•**
æ¯ä¸ªæœåŠ¡è¿è¡Œåœ¨ç‹¬ç«‹çš„è¿›ç¨‹ä¸­ï¼Œæœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´ã€‚

```java
// ç”¨æˆ·æœåŠ¡ - ç‹¬ç«‹è¿›ç¨‹
public class UserService {
    public static void main(String[] args) {
        // ç”¨æˆ·æœåŠ¡çš„ä¸šåŠ¡é€»è¾‘
        SpringApplication.run(UserService.class, args);
    }
}

// è®¢å•æœåŠ¡ - ç‹¬ç«‹è¿›ç¨‹  
public class OrderService {
    public static void main(String[] args) {
        // è®¢å•æœåŠ¡çš„ä¸šåŠ¡é€»è¾‘
        SpringApplication.run(OrderService.class, args);
    }
}
```

**ğŸ“Š è¿›ç¨‹éš”ç¦»ä¼˜ç¼ºç‚¹**

| ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|
| âœ… å®Œå…¨ç‹¬ç«‹ï¼Œæ•…éšœä¸ä¼ æ’­ | âŒ èµ„æºå¼€é”€å¤§ |
| âœ… å¯ä»¥ç”¨ä¸åŒæŠ€æœ¯æ ˆ | âŒ è¿›ç¨‹é—´é€šä¿¡å¤æ‚ |
| âœ… å¯ä»¥ç‹¬ç«‹æ‰©ç¼©å®¹ | âŒ éƒ¨ç½²ç®¡ç†å¤æ‚ |

### 2.3 å®¹å™¨çº§éš”ç¦»


**ğŸ”¸ Dockerå®¹å™¨éš”ç¦»**
```yaml
# docker-compose.yml
version: '3'
services:
  user-service:
    image: user-service:latest
    ports:
      - "8081:8080"
    environment:
      - DB_URL=user-db
  
  order-service:
    image: order-service:latest
    ports:
      - "8082:8080"
    environment:
      - DB_URL=order-db
```

**ğŸ¯ å®¹å™¨éš”ç¦»çš„å¥½å¤„**
- ç¯å¢ƒå®Œå…¨ä¸€è‡´
- èµ„æºä½¿ç”¨å¯æ§
- éƒ¨ç½²æ›´ç®€å•
- æ•…éšœå½±å“èŒƒå›´å°

### 2.4 æ¨¡å—çº§éš”ç¦»


**ğŸ”¸ åŒä¸€è¿›ç¨‹å†…çš„æ¨¡å—éš”ç¦»**
```java
// ä½¿ç”¨ä¸åŒçš„ClassLoaderéš”ç¦»æ¨¡å—
public class ModuleManager {
    private Map<String, ModuleContext> modules = new HashMap<>();
    
    public void loadModule(String moduleName, String jarPath) {
        try {
            // æ¯ä¸ªæ¨¡å—ä½¿ç”¨ç‹¬ç«‹çš„ClassLoader
            URLClassLoader moduleLoader = new URLClassLoader(
                new URL[]{new File(jarPath).toURI().toURL()}
            );
            
            ModuleContext context = new ModuleContext(moduleLoader);
            modules.put(moduleName, context);
            
        } catch (Exception e) {
            System.err.println("æ¨¡å— " + moduleName + " åŠ è½½å¤±è´¥ï¼š" + e.getMessage());
            // ä¸€ä¸ªæ¨¡å—åŠ è½½å¤±è´¥ï¼Œä¸å½±å“å…¶ä»–æ¨¡å—
        }
    }
}
```

---

## 3. ğŸ§µ çº¿ç¨‹æ± éš”ç¦»


### 3.1 ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± éš”ç¦»


**ğŸ¯ ç”Ÿæ´»æ¯”å–»**
çº¿ç¨‹æ± éš”ç¦»å°±åƒé¤å…é‡Œçš„æœåŠ¡å‘˜åˆ†å·¥ï¼š
- ç‚¹é¤æœåŠ¡å‘˜ä¸“é—¨è´Ÿè´£ç‚¹é¤
- ä¸ŠèœæœåŠ¡å‘˜ä¸“é—¨è´Ÿè´£ä¸Šèœ
- æ”¶é“¶æœåŠ¡å‘˜ä¸“é—¨è´Ÿè´£æ”¶é“¶

å¦‚æœä¸ŠèœæœåŠ¡å‘˜å¿™ä¸è¿‡æ¥ï¼Œä¸ä¼šå½±å“ç‚¹é¤å’Œæ”¶é“¶ã€‚

### 3.2 ä¸ºä»€ä¹ˆéœ€è¦çº¿ç¨‹æ± éš”ç¦»


**âŒ å…±äº«çº¿ç¨‹æ± çš„é—®é¢˜**
```java
// æ‰€æœ‰ä»»åŠ¡å…±ç”¨ä¸€ä¸ªçº¿ç¨‹æ± 
ExecutorService sharedPool = Executors.newFixedThreadPool(10);

// é—®é¢˜ï¼šå¦‚æœæŸä¸ªä»»åŠ¡å¾ˆæ…¢æˆ–è€…å¡ä½
sharedPool.submit(() -> {
    // è¿™ä¸ªä»»åŠ¡å¦‚æœå¡ä½30ç§’
    Thread.sleep(30000);
    return "æ…¢ä»»åŠ¡å®Œæˆ";
});

// å…¶ä»–é‡è¦ä»»åŠ¡ä¹Ÿä¼šå—å½±å“
sharedPool.submit(() -> {
    return "é‡è¦çš„å¿«é€Ÿä»»åŠ¡"; // å¯èƒ½éœ€è¦ç­‰å¾ˆä¹…
});
```

### 3.3 çº¿ç¨‹æ± éš”ç¦»å®ç°


**ğŸ”¸ æŒ‰ä¸šåŠ¡åŠŸèƒ½éš”ç¦»**
```java
public class ThreadPoolManager {
    // ç”¨æˆ·æ“ä½œä¸“ç”¨çº¿ç¨‹æ± 
    private final ExecutorService userPool = 
        Executors.newFixedThreadPool(5, 
            new ThreadFactory("ç”¨æˆ·æ“ä½œçº¿ç¨‹"));
    
    // è®¢å•å¤„ç†ä¸“ç”¨çº¿ç¨‹æ± 
    private final ExecutorService orderPool = 
        Executors.newFixedThreadPool(10, 
            new ThreadFactory("è®¢å•å¤„ç†çº¿ç¨‹"));
    
    // é€šçŸ¥å‘é€ä¸“ç”¨çº¿ç¨‹æ± 
    private final ExecutorService notifyPool = 
        Executors.newFixedThreadPool(3, 
            new ThreadFactory("é€šçŸ¥å‘é€çº¿ç¨‹"));
    
    // ç”¨æˆ·ç›¸å…³æ“ä½œ
    public Future<String> handleUserTask(Callable<String> task) {
        return userPool.submit(task);
    }
    
    // è®¢å•ç›¸å…³æ“ä½œ
    public Future<String> handleOrderTask(Callable<String> task) {
        return orderPool.submit(task);
    }
}
```

**ğŸ”¸ æŒ‰ä¼˜å…ˆçº§éš”ç¦»**
```java
public class PriorityThreadPools {
    // é«˜ä¼˜å…ˆçº§ä»»åŠ¡ï¼šæ ¸å¿ƒä¸šåŠ¡
    private final ExecutorService highPriorityPool = 
        Executors.newFixedThreadPool(8);
    
    // ä¸­ä¼˜å…ˆçº§ä»»åŠ¡ï¼šä¸€èˆ¬ä¸šåŠ¡  
    private final ExecutorService mediumPriorityPool = 
        Executors.newFixedThreadPool(5);
    
    // ä½ä¼˜å…ˆçº§ä»»åŠ¡ï¼šåå°å¤„ç†
    private final ExecutorService lowPriorityPool = 
        Executors.newFixedThreadPool(2);
    
    public void executeTask(Task task) {
        switch (task.getPriority()) {
            case HIGH:
                highPriorityPool.submit(task);
                break;
            case MEDIUM:
                mediumPriorityPool.submit(task);
                break;
            case LOW:
                lowPriorityPool.submit(task);
                break;
        }
    }
}
```

### 3.4 çº¿ç¨‹æ± éš”ç¦»çš„ç›‘æ§


**ğŸ”¸ ç›‘æ§æ¯ä¸ªçº¿ç¨‹æ± çš„çŠ¶æ€**
```java
public class ThreadPoolMonitor {
    
    public void monitorPool(ThreadPoolExecutor pool, String poolName) {
        int activeCount = pool.getActiveCount();      // æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æ•°
        int poolSize = pool.getPoolSize();            // å½“å‰çº¿ç¨‹æ± å¤§å°
        long taskCount = pool.getTaskCount();         // æ€»ä»»åŠ¡æ•°
        long completedCount = pool.getCompletedTaskCount(); // å·²å®Œæˆä»»åŠ¡æ•°
        int queueSize = pool.getQueue().size();       // ç­‰å¾…é˜Ÿåˆ—å¤§å°
        
        System.out.printf(
            "çº¿ç¨‹æ± [%s]: æ´»è·ƒçº¿ç¨‹=%d, æ± å¤§å°=%d, é˜Ÿåˆ—å¤§å°=%d\n",
            poolName, activeCount, poolSize, queueSize
        );
        
        // å¦‚æœé˜Ÿåˆ—ç§¯å‹å¤ªå¤šï¼Œå‘å‡ºè­¦å‘Š
        if (queueSize > 100) {
            System.err.println("è­¦å‘Šï¼šçº¿ç¨‹æ±  " + poolName + " é˜Ÿåˆ—ç§¯å‹ä¸¥é‡ï¼");
        }
    }
}
```

---

## 4. ğŸ—„ï¸ æ•°æ®åº“éš”ç¦»


### 4.1 ä»€ä¹ˆæ˜¯æ•°æ®åº“éš”ç¦»


**ğŸ¯ ç®€å•ç†è§£**
æ•°æ®åº“éš”ç¦»å°±åƒæ˜¯æŠŠä¸åŒçš„æ–‡ä»¶æ”¾åœ¨ä¸åŒçš„æŸœå­é‡Œï¼Œä¸€ä¸ªæŸœå­å‡ºé—®é¢˜ä¸å½±å“å…¶ä»–æŸœå­é‡Œçš„æ–‡ä»¶ã€‚

### 4.2 æ•°æ®åº“å±‚é¢çš„éš”ç¦»æ–¹å¼


**ğŸ”¸ æŒ‰ä¸šåŠ¡æ‹†åˆ†æ•°æ®åº“**
```
ç”µå•†ç³»ç»Ÿæ•°æ®åº“æ‹†åˆ†ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·æ•°æ®åº“  â”‚  â”‚  å•†å“æ•°æ®åº“  â”‚  â”‚  è®¢å•æ•°æ®åº“  â”‚
â”‚             â”‚  â”‚             â”‚  â”‚             â”‚
â”‚ user_db     â”‚  â”‚ product_db  â”‚  â”‚ order_db    â”‚
â”‚ ç”¨æˆ·è¡¨      â”‚  â”‚ å•†å“è¡¨      â”‚  â”‚ è®¢å•è¡¨      â”‚
â”‚ æƒé™è¡¨      â”‚  â”‚ åˆ†ç±»è¡¨      â”‚  â”‚ æ”¯ä»˜è¡¨      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”¸ é…ç½®å¤šæ•°æ®æº**
```java
@Configuration
public class DatabaseConfig {
    
    // ç”¨æˆ·æ•°æ®åº“é…ç½®
    @Bean
    @Primary
    public DataSource userDataSource() {
        return DataSourceBuilder.create()
            .url("jdbc:mysql://localhost:3306/user_db")
            .username("user_admin")
            .password("password")
            .build();
    }
    
    // è®¢å•æ•°æ®åº“é…ç½®
    @Bean
    public DataSource orderDataSource() {
        return DataSourceBuilder.create()
            .url("jdbc:mysql://localhost:3306/order_db")
            .username("order_admin")
            .password("password")
            .build();
    }
}
```

### 4.3 è¿æ¥æ± éš”ç¦»


**ğŸ”¸ ä¸ºä¸åŒä¸šåŠ¡é…ç½®ç‹¬ç«‹è¿æ¥æ± **
```java
public class ConnectionPoolManager {
    
    // ç”¨æˆ·ä¸šåŠ¡è¿æ¥æ± ï¼šå¤„ç†ç”¨æˆ·ç™»å½•ã€æ³¨å†Œç­‰
    private final HikariDataSource userPool = createPool(
        "jdbc:mysql://localhost:3306/user_db", 
        10, // æœ€å¤§è¿æ¥æ•°
        "ç”¨æˆ·æ•°æ®åº“æ± "
    );
    
    // è®¢å•ä¸šåŠ¡è¿æ¥æ± ï¼šå¤„ç†è®¢å•åˆ›å»ºã€æ”¯ä»˜ç­‰
    private final HikariDataSource orderPool = createPool(
        "jdbc:mysql://localhost:3306/order_db",
        20, // è®¢å•ä¸šåŠ¡è¿æ¥æ•°æ›´å¤š
        "è®¢å•æ•°æ®åº“æ± "
    );
    
    // æŠ¥è¡¨ä¸šåŠ¡è¿æ¥æ± ï¼šå¤„ç†æ•°æ®åˆ†æã€æŠ¥è¡¨ç”Ÿæˆ
    private final HikariDataSource reportPool = createPool(
        "jdbc:mysql://localhost:3306/report_db",
        5,  // æŠ¥è¡¨æŸ¥è¯¢è¿æ¥æ•°è¾ƒå°‘
        "æŠ¥è¡¨æ•°æ®åº“æ± "
    );
    
    private HikariDataSource createPool(String url, int maxPoolSize, String poolName) {
        HikariConfig config = new HikariConfig();
        config.setJdbcUrl(url);
        config.setMaximumPoolSize(maxPoolSize);
        config.setPoolName(poolName);
        return new HikariDataSource(config);
    }
}
```

### 4.4 è¯»å†™åˆ†ç¦»éš”ç¦»


**ğŸ”¸ è¯»å†™æ“ä½œä½¿ç”¨ä¸åŒæ•°æ®åº“**
```java
public class ReadWriteDataSource {
    
    private final DataSource writeDataSource;  // å†™æ“ä½œï¼šä¸»æ•°æ®åº“
    private final DataSource readDataSource;   // è¯»æ“ä½œï¼šä»æ•°æ®åº“
    
    public Connection getConnection(boolean isWrite) {
        if (isWrite) {
            return writeDataSource.getConnection(); // å†™æ“ä½œç”¨ä¸»åº“
        } else {
            return readDataSource.getConnection();  // è¯»æ“ä½œç”¨ä»åº“
        }
    }
}

// ä½¿ç”¨ç¤ºä¾‹
public class UserService {
    
    // æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼šä½¿ç”¨è¯»åº“
    public User findUser(Long id) {
        Connection conn = dataSource.getConnection(false); // è¯»æ“ä½œ
        // æ‰§è¡ŒæŸ¥è¯¢...
    }
    
    // æ›´æ–°ç”¨æˆ·ä¿¡æ¯ï¼šä½¿ç”¨å†™åº“
    public void updateUser(User user) {
        Connection conn = dataSource.getConnection(true);  // å†™æ“ä½œ
        // æ‰§è¡Œæ›´æ–°...
    }
}
```

---

## 5. ğŸ’¾ èµ„æºéš”ç¦»ç­–ç•¥


### 5.1 ä»€ä¹ˆæ˜¯èµ„æºéš”ç¦»


**ğŸ¯ é€šä¿—è§£é‡Š**
èµ„æºéš”ç¦»å°±åƒæ˜¯ç»™æ¯ä¸ªäººåˆ†é…ä¸“é—¨çš„å·¥å…·å’Œææ–™ï¼Œä¸€ä¸ªäººç”¨å…‰äº†è‡ªå·±çš„ææ–™ï¼Œä¸ä¼šå½±å“å…¶ä»–äººçš„å·¥ä½œã€‚

### 5.2 å†…å­˜èµ„æºéš”ç¦»


**ğŸ”¸ JVMå †å†…å­˜éš”ç¦»**
```java
// å¯åŠ¨ä¸åŒæœåŠ¡æ—¶åˆ†é…ä¸åŒçš„å†…å­˜
// ç”¨æˆ·æœåŠ¡ï¼šåˆ†é…2Gå†…å­˜
java -Xms2g -Xmx2g -jar user-service.jar

// è®¢å•æœåŠ¡ï¼šåˆ†é…4Gå†…å­˜ï¼ˆä¸šåŠ¡æ›´é‡è¦ï¼‰
java -Xms4g -Xmx4g -jar order-service.jar

// æŠ¥è¡¨æœåŠ¡ï¼šåˆ†é…1Gå†…å­˜ï¼ˆä½¿ç”¨é¢‘ç‡è¾ƒä½ï¼‰
java -Xms1g -Xmx1g -jar report-service.jar
```

**ğŸ”¸ åº”ç”¨å†…å­˜éš”ç¦»**
```java
public class MemoryManager {
    
    // ä¸ºä¸åŒåŠŸèƒ½åˆ†é…ä¸“é—¨çš„ç¼“å­˜ç©ºé—´
    private final Map<String, String> userCache = 
        new ConcurrentHashMap<>(1000);      // ç”¨æˆ·ç¼“å­˜ï¼šæœ€å¤š1000æ¡
    
    private final Map<String, String> productCache = 
        new ConcurrentHashMap<>(5000);      // å•†å“ç¼“å­˜ï¼šæœ€å¤š5000æ¡
    
    private final Map<String, String> orderCache = 
        new ConcurrentHashMap<>(2000);      // è®¢å•ç¼“å­˜ï¼šæœ€å¤š2000æ¡
    
    // æ£€æŸ¥ç¼“å­˜å¤§å°ï¼Œé˜²æ­¢å†…å­˜æº¢å‡º
    public void checkCacheSize() {
        if (userCache.size() > 1000) {
            userCache.clear(); // æ¸…ç†ç”¨æˆ·ç¼“å­˜
            System.out.println("ç”¨æˆ·ç¼“å­˜å·²æ¸…ç†");
        }
        // å…¶ä»–ç¼“å­˜ç±»ä¼¼å¤„ç†...
    }
}
```

### 5.3 CPUèµ„æºéš”ç¦»


**ğŸ”¸ çº¿ç¨‹ä¼˜å…ˆçº§éš”ç¦»**
```java
public class CpuResourceManager {
    
    public void executeTask(Runnable task, TaskPriority priority) {
        Thread thread = new Thread(task);
        
        // æ ¹æ®ä»»åŠ¡é‡è¦æ€§è®¾ç½®çº¿ç¨‹ä¼˜å…ˆçº§
        switch (priority) {
            case HIGH:
                thread.setPriority(Thread.MAX_PRIORITY);   // æœ€é«˜ä¼˜å…ˆçº§
                break;
            case MEDIUM:
                thread.setPriority(Thread.NORM_PRIORITY);  // æ­£å¸¸ä¼˜å…ˆçº§
                break;
            case LOW:
                thread.setPriority(Thread.MIN_PRIORITY);   // æœ€ä½ä¼˜å…ˆçº§
                break;
        }
        
        thread.start();
    }
}
```

### 5.4 ç½‘ç»œèµ„æºéš”ç¦»


**ğŸ”¸ é™æµå™¨éš”ç¦»**
```java
public class NetworkResourceManager {
    
    // ä¸åŒä¸šåŠ¡ä½¿ç”¨ä¸åŒçš„é™æµå™¨
    private final RateLimiter userApiLimiter = 
        RateLimiter.create(100.0);  // ç”¨æˆ·APIï¼šæ¯ç§’100ä¸ªè¯·æ±‚
    
    private final RateLimiter orderApiLimiter = 
        RateLimiter.create(50.0);   // è®¢å•APIï¼šæ¯ç§’50ä¸ªè¯·æ±‚
    
    private final RateLimiter reportApiLimiter = 
        RateLimiter.create(10.0);   // æŠ¥è¡¨APIï¼šæ¯ç§’10ä¸ªè¯·æ±‚
    
    public boolean canProcessUserRequest() {
        return userApiLimiter.tryAcquire(); // å°è¯•è·å–ç”¨æˆ·APIè®¸å¯
    }
    
    public boolean canProcessOrderRequest() {
        return orderApiLimiter.tryAcquire(); // å°è¯•è·å–è®¢å•APIè®¸å¯
    }
}
```

---

## 6. ğŸ›¡ï¸ æ•…éšœå¤„ç†æ€ç»´ä½“ç³»


### 6.1 æ•…éšœé¢„é˜²æ€ç»´


**ğŸ¯ æ ¸å¿ƒç†å¿µ**
é¢„é˜²èƒœäºæ²»ç–—ï¼Œåœ¨é—®é¢˜å‘ç”Ÿä¹‹å‰å°±åšå¥½é˜²æŠ¤æªæ–½ã€‚

**ğŸ”¸ è¾“å…¥æ ¡éªŒ**
```java
public class InputValidator {
    
    public boolean validateUser(User user) {
        // é˜²æ­¢ç©ºå€¼æ”»å‡»
        if (user == null || user.getName() == null) {
            System.err.println("ç”¨æˆ·ä¿¡æ¯ä¸èƒ½ä¸ºç©º");
            return false;
        }
        
        // é˜²æ­¢SQLæ³¨å…¥
        if (user.getName().contains("'") || user.getName().contains("--")) {
            System.err.println("ç”¨æˆ·ååŒ…å«éæ³•å­—ç¬¦");
            return false;
        }
        
        // é˜²æ­¢è¿‡é•¿è¾“å…¥
        if (user.getName().length() > 50) {
            System.err.println("ç”¨æˆ·åè¿‡é•¿");
            return false;
        }
        
        return true;
    }
}
```

**ğŸ”¸ è¾¹ç•Œæ£€æŸ¥**
```java
public class BoundaryChecker {
    
    public int[] processArray(int[] data, int index) {
        // æ£€æŸ¥æ•°ç»„æ˜¯å¦ä¸ºç©º
        if (data == null) {
            throw new IllegalArgumentException("æ•°ç»„ä¸èƒ½ä¸ºç©º");
        }
        
        // æ£€æŸ¥ç´¢å¼•æ˜¯å¦è¶Šç•Œ
        if (index < 0 || index >= data.length) {
            throw new IndexOutOfBoundsException(
                "ç´¢å¼•è¶…å‡ºèŒƒå›´ï¼š" + index + "ï¼Œæ•°ç»„é•¿åº¦ï¼š" + data.length
            );
        }
        
        return data;
    }
}
```

**ğŸ”¸ èµ„æºé™åˆ¶**
```java
public class ResourceLimiter {
    
    private static final int MAX_FILE_SIZE = 10 * 1024 * 1024; // 10MB
    private static final int MAX_CONNECTIONS = 100;
    
    public boolean uploadFile(byte[] fileData) {
        // é™åˆ¶æ–‡ä»¶å¤§å°
        if (fileData.length > MAX_FILE_SIZE) {
            System.err.println("æ–‡ä»¶è¿‡å¤§ï¼Œé™åˆ¶ä¸º10MB");
            return false;
        }
        
        return true;
    }
    
    public boolean createConnection() {
        int currentConnections = getCurrentConnectionCount();
        
        // é™åˆ¶è¿æ¥æ•°é‡
        if (currentConnections >= MAX_CONNECTIONS) {
            System.err.println("è¿æ¥æ•°å·²è¾¾ä¸Šé™ï¼š" + MAX_CONNECTIONS);
            return false;
        }
        
        return true;
    }
}
```

### 6.2 æ•…éšœéš”ç¦»æ€ç»´


**ğŸ¯ æ ¸å¿ƒç†å¿µ**
å½“æ•…éšœæ— æ³•é¿å…æ—¶ï¼Œç¡®ä¿æ•…éšœçš„å½±å“èŒƒå›´æœ€å°åŒ–ã€‚

**ğŸ”¸ æœåŠ¡éš”ç¦»å®è·µ**
```java
public class ServiceIsolation {
    
    public String callExternalService(String request) {
        try {
            // è°ƒç”¨å¤–éƒ¨æœåŠ¡
            return externalService.process(request);
            
        } catch (Exception e) {
            // å¤–éƒ¨æœåŠ¡å¤±è´¥ä¸å½±å“ä¸»æµç¨‹
            System.err.println("å¤–éƒ¨æœåŠ¡è°ƒç”¨å¤±è´¥ï¼š" + e.getMessage());
            
            // è¿”å›é»˜è®¤å€¼æˆ–ä»ç¼“å­˜è·å–
            return getDefaultResponse(request);
        }
    }
    
    private String getDefaultResponse(String request) {
        // æä¾›é™çº§æœåŠ¡
        return "é»˜è®¤å“åº”ï¼šæœåŠ¡æš‚æ—¶ä¸å¯ç”¨";
    }
}
```

**ğŸ”¸ çº¿ç¨‹éš”ç¦»å®è·µ**
```java
public class ThreadIsolation {
    
    // æ ¸å¿ƒä¸šåŠ¡çº¿ç¨‹æ± 
    private final ExecutorService corePool = 
        Executors.newFixedThreadPool(10);
    
    // éæ ¸å¿ƒä¸šåŠ¡çº¿ç¨‹æ± 
    private final ExecutorService nonCorePool = 
        Executors.newFixedThreadPool(5);
    
    public void processOrder(Order order) {
        // æ ¸å¿ƒä¸šåŠ¡ï¼šè®¢å•å¤„ç†
        corePool.submit(() -> {
            processOrderCore(order);
        });
        
        // éæ ¸å¿ƒä¸šåŠ¡ï¼šå‘é€é€šçŸ¥ï¼ˆå¤±è´¥ä¸å½±å“è®¢å•ï¼‰
        nonCorePool.submit(() -> {
            try {
                sendOrderNotification(order);
            } catch (Exception e) {
                System.err.println("é€šçŸ¥å‘é€å¤±è´¥ï¼š" + e.getMessage());
                // é€šçŸ¥å¤±è´¥ä¸å½±å“è®¢å•å¤„ç†
            }
        });
    }
}
```

### 6.3 æ•…éšœæ¢å¤æ€ç»´


**ğŸ¯ æ ¸å¿ƒç†å¿µ**
å½“æ•…éšœå‘ç”Ÿåï¼Œèƒ½å¤Ÿå¿«é€Ÿå®šä½é—®é¢˜ã€æ¢å¤æœåŠ¡ã€ä¿®å¤æ•°æ®ã€‚

**ğŸ”¸ å¿«é€Ÿå®šä½**
```java
public class FaultLocation {
    
    private static final Logger logger = LoggerFactory.getLogger(FaultLocation.class);
    
    public void processRequest(String requestId, Object data) {
        long startTime = System.currentTimeMillis();
        
        try {
            logger.info("å¤„ç†è¯·æ±‚å¼€å§‹ï¼šrequestId={}", requestId);
            
            // ä¸šåŠ¡å¤„ç†
            handleBusinessLogic(data);
            
            long duration = System.currentTimeMillis() - startTime;
            logger.info("å¤„ç†è¯·æ±‚æˆåŠŸï¼šrequestId={}, è€—æ—¶={}ms", requestId, duration);
            
        } catch (Exception e) {
            long duration = System.currentTimeMillis() - startTime;
            logger.error("å¤„ç†è¯·æ±‚å¤±è´¥ï¼šrequestId={}, è€—æ—¶={}ms, é”™è¯¯={}", 
                        requestId, duration, e.getMessage(), e);
            
            // è®°å½•è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ï¼Œä¾¿äºå®šä½é—®é¢˜
            recordErrorDetails(requestId, data, e);
        }
    }
    
    private void recordErrorDetails(String requestId, Object data, Exception e) {
        ErrorRecord record = new ErrorRecord();
        record.setRequestId(requestId);
        record.setRequestData(data.toString());
        record.setErrorMessage(e.getMessage());
        record.setStackTrace(getStackTrace(e));
        record.setTimestamp(new Date());
        
        // ä¿å­˜åˆ°é”™è¯¯æ—¥å¿—æ•°æ®åº“
        errorLogService.saveErrorRecord(record);
    }
}
```

**ğŸ”¸ å›æ»šæœºåˆ¶**
```java
public class RollbackManager {
    
    @Transactional(rollbackFor = Exception.class)
    public void updateUserAndOrder(User user, Order order) {
        try {
            // ç¬¬ä¸€æ­¥ï¼šæ›´æ–°ç”¨æˆ·ä¿¡æ¯
            userService.updateUser(user);
            
            // ç¬¬äºŒæ­¥ï¼šæ›´æ–°è®¢å•ä¿¡æ¯
            orderService.updateOrder(order);
            
            // ç¬¬ä¸‰æ­¥ï¼šå‘é€é€šçŸ¥
            notificationService.sendNotification(user, order);
            
        } catch (Exception e) {
            // å‘ç”Ÿä»»ä½•å¼‚å¸¸ï¼Œè‡ªåŠ¨å›æ»šæ‰€æœ‰æ•°æ®åº“æ“ä½œ
            System.err.println("æ“ä½œå¤±è´¥ï¼Œæ­£åœ¨å›æ»šï¼š" + e.getMessage());
            throw e; // é‡æ–°æŠ›å‡ºå¼‚å¸¸ï¼Œè§¦å‘äº‹åŠ¡å›æ»š
        }
    }
}
```

**ğŸ”¸ æ•°æ®æ¢å¤**
```java
public class DataRecovery {
    
    // æ•°æ®å¤‡ä»½
    public void backupData(String tableName) {
        String timestamp = new SimpleDateFormat("yyyyMMdd_HHmmss").format(new Date());
        String backupTableName = tableName + "_backup_" + timestamp;
        
        String sql = String.format(
            "CREATE TABLE %s AS SELECT * FROM %s", 
            backupTableName, tableName
        );
        
        jdbcTemplate.execute(sql);
        System.out.println("æ•°æ®å¤‡ä»½å®Œæˆï¼š" + backupTableName);
    }
    
    // æ•°æ®æ¢å¤
    public void restoreData(String tableName, String backupTableName) {
        try {
            // æ¸…ç©ºå½“å‰è¡¨
            jdbcTemplate.execute("DELETE FROM " + tableName);
            
            // ä»å¤‡ä»½è¡¨æ¢å¤æ•°æ®
            String sql = String.format(
                "INSERT INTO %s SELECT * FROM %s", 
                tableName, backupTableName
            );
            
            jdbcTemplate.execute(sql);
            System.out.println("æ•°æ®æ¢å¤å®Œæˆï¼šä» " + backupTableName + " æ¢å¤åˆ° " + tableName);
            
        } catch (Exception e) {
            System.err.println("æ•°æ®æ¢å¤å¤±è´¥ï¼š" + e.getMessage());
            throw new RuntimeException("æ•°æ®æ¢å¤å¤±è´¥", e);
        }
    }
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 æ•…éšœéš”ç¦»çš„ä¸‰ä¸ªå±‚æ¬¡


> ğŸ’¡ **è®°å¿†å£è¯€**ï¼šé˜²æ‚£äºæœªç„¶ï¼Œéš”ç¦»å‡æŸå¤±ï¼Œæ¢å¤ä¿ä¸šåŠ¡

**ğŸ”¸ ç¬¬ä¸€å±‚ï¼šé¢„é˜²**
- è¾“å…¥æ ¡éªŒï¼šæ‹’ç»åæ•°æ®
- è¾¹ç•Œæ£€æŸ¥ï¼šé˜²æ­¢è¶Šç•Œè®¿é—®
- èµ„æºé™åˆ¶ï¼šé¿å…èµ„æºè€—å°½

**ğŸ”¸ ç¬¬äºŒå±‚ï¼šéš”ç¦»**
- æœåŠ¡éš”ç¦»ï¼šè¿›ç¨‹åˆ†ç¦»ã€å®¹å™¨éš”ç¦»
- çº¿ç¨‹éš”ç¦»ï¼šä¸åŒä¸šåŠ¡ä¸åŒçº¿ç¨‹æ± 
- æ•°æ®éš”ç¦»ï¼šæ•°æ®åº“åˆ†ç¦»ã€è¿æ¥æ± åˆ†ç¦»

**ğŸ”¸ ç¬¬ä¸‰å±‚ï¼šæ¢å¤**
- å¿«é€Ÿå®šä½ï¼šè¯¦ç»†æ—¥å¿—ã€é”™è¯¯è¿½è¸ª
- å›æ»šæœºåˆ¶ï¼šäº‹åŠ¡å›æ»šã€ç‰ˆæœ¬å›é€€
- æ•°æ®æ¢å¤ï¼šå¤‡ä»½æ¢å¤ã€æ•°æ®ä¿®å¤

### 7.2 éš”ç¦»æŠ€æœ¯é€‰æ‹©æŒ‡å—


| åœºæ™¯ | æ¨èéš”ç¦»æ–¹å¼ | ç†ç”± |
|------|-------------|------|
| **å¾®æœåŠ¡æ¶æ„** | è¿›ç¨‹+å®¹å™¨éš”ç¦» | å®Œå…¨ç‹¬ç«‹ï¼Œæ•…éšœä¸ä¼ æ’­ |
| **å•ä½“åº”ç”¨** | çº¿ç¨‹æ± +æ¨¡å—éš”ç¦» | æˆæœ¬ä½ï¼Œå®æ–½ç®€å• |
| **é«˜å¹¶å‘ç³»ç»Ÿ** | çº¿ç¨‹æ± +è¿æ¥æ± éš”ç¦» | èµ„æºæ§åˆ¶ç²¾ç¡® |
| **æ•°æ®å¯†é›†å‹** | æ•°æ®åº“+è¯»å†™éš”ç¦» | ä¿æŠ¤æ ¸å¿ƒæ•°æ® |

### 7.3 å®æ–½æ•…éšœéš”ç¦»çš„æ­¥éª¤


**ğŸ“‹ å®æ–½æ£€æŸ¥æ¸…å•**
- [ ] è¯†åˆ«ç³»ç»Ÿä¸­çš„å…³é”®ä¸šåŠ¡å’Œéå…³é”®ä¸šåŠ¡
- [ ] è®¾è®¡éš”ç¦»è¾¹ç•Œï¼Œç¡®å®šéš”ç¦»ç²’åº¦
- [ ] å®æ–½èµ„æºéš”ç¦»ï¼šçº¿ç¨‹æ± ã€è¿æ¥æ± ã€å†…å­˜
- [ ] å»ºç«‹ç›‘æ§ä½“ç³»ï¼šç›‘æ§å„éš”ç¦»å•å…ƒçŠ¶æ€
- [ ] å‡†å¤‡é™çº§æ–¹æ¡ˆï¼šå½“æŸä¸ªå•å…ƒæ•…éšœæ—¶çš„å¤„ç†
- [ ] æµ‹è¯•æ•…éšœåœºæ™¯ï¼šæ¨¡æ‹Ÿæ•…éšœéªŒè¯éš”ç¦»æ•ˆæœ

### 7.4 å¸¸è§è¯¯åŒºä¸æœ€ä½³å®è·µ


**âŒ å¸¸è§è¯¯åŒº**
- éš”ç¦»ç²’åº¦è¿‡ç»†ï¼Œå¢åŠ ç³»ç»Ÿå¤æ‚åº¦
- åªåšæŠ€æœ¯éš”ç¦»ï¼Œå¿½ç•¥ä¸šåŠ¡éš”ç¦»
- éš”ç¦»åç¼ºä¹ç›‘æ§ï¼Œé—®é¢˜å‘ç°ä¸åŠæ—¶

**âœ… æœ€ä½³å®è·µ**
- æŒ‰ä¸šåŠ¡é‡è¦æ€§ç¡®å®šéš”ç¦»ç­–ç•¥
- å»ºç«‹å®Œå–„çš„ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶
- å®šæœŸæ¼”ç»ƒæ•…éšœåœºæ™¯
- ä¿æŒéš”ç¦»è¾¹ç•Œçš„æ¸…æ™°å’Œç®€å•

**ğŸ¯ æ ¸å¿ƒè®°å¿†**
- **éš”ç¦»æ˜¯ä¸ºäº†æ§åˆ¶æ•…éšœå½±å“èŒƒå›´**
- **é¢„é˜²æ¯”æ²»ç–—æ›´é‡è¦**
- **ç›‘æ§æ˜¯éš”ç¦»æ•ˆæœçš„ä¿éšœ**
- **ç®€å•çš„éš”ç¦»æ¯”å¤æ‚çš„éš”ç¦»æ›´å¯é **