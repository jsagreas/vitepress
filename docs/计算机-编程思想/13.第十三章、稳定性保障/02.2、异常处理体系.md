---
title: 2ã€å¼‚å¸¸å¤„ç†ä½“ç³»
---
## ğŸ“š ç›®å½•

1. [å¼‚å¸¸å¤„ç†åŸºç¡€æ¦‚å¿µ](#1-å¼‚å¸¸å¤„ç†åŸºç¡€æ¦‚å¿µ)
2. [å¼‚å¸¸åˆ†ç±»ä½“ç³»](#2-å¼‚å¸¸åˆ†ç±»ä½“ç³»)
3. [å¼‚å¸¸ä¼ æ’­æœºåˆ¶](#3-å¼‚å¸¸ä¼ æ’­æœºåˆ¶)
4. [è‡ªå®šä¹‰å¼‚å¸¸è®¾è®¡](#4-è‡ªå®šä¹‰å¼‚å¸¸è®¾è®¡)
5. [å¼‚å¸¸æ¢å¤ç­–ç•¥](#5-å¼‚å¸¸æ¢å¤ç­–ç•¥)
6. [æœ€ä½³å®è·µæ€»ç»“](#6-æœ€ä½³å®è·µæ€»ç»“)

---

## 1. ğŸ¯ å¼‚å¸¸å¤„ç†åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯å¼‚å¸¸å¤„ç†


**ğŸ”¸ é€šä¿—ç†è§£**
å¼‚å¸¸å¤„ç†å°±åƒæ˜¯ç»™ç¨‹åºå®‰è£…**å®‰å…¨æ°”å›Š**ã€‚å½“ç¨‹åºè¿è¡Œæ—¶é‡åˆ°æ„å¤–æƒ…å†µï¼ˆæ¯”å¦‚æ–‡ä»¶ä¸å­˜åœ¨ã€ç½‘ç»œæ–­å¼€ã€æ•°æ®æ ¼å¼é”™è¯¯ï¼‰ï¼Œä¸è®©ç¨‹åºç›´æ¥å´©æºƒï¼Œè€Œæ˜¯ä¼˜é›…åœ°å¤„ç†è¿™äº›é—®é¢˜ã€‚

ğŸŒ° **ç”Ÿæ´»ç±»æ¯”**: å¼€è½¦æ—¶çªç„¶çˆ†èƒ
- **æ²¡æœ‰å¼‚å¸¸å¤„ç†**: è½¦å­ç›´æ¥å¤±æ§æ’è½¦ï¼ˆç¨‹åºå´©æºƒï¼‰
- **æœ‰å¼‚å¸¸å¤„ç†**: å®‰å…¨åœè½¦ï¼Œæ¢å¤‡èƒç»§ç»­è¡Œé©¶ï¼ˆç¨‹åºç»§ç»­è¿è¡Œï¼‰

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦å¼‚å¸¸å¤„ç†


**ğŸ“Š æ ¸å¿ƒä»·å€¼**

| ä»·å€¼ç‚¹ | **è¯´æ˜** | **å®é™…æ•ˆæœ** |
|-------|---------|-------------|
| ğŸ›¡ï¸ **ç¨‹åºç¨³å®š** | `é˜²æ­¢ç¨‹åºæ„å¤–å´©æºƒ` | `ç”¨æˆ·ä½“éªŒä¸ä¸­æ–­` |
| ğŸ” **é—®é¢˜å®šä½** | `è®°å½•é”™è¯¯å‘ç”Ÿçš„è¯¦ç»†ä¿¡æ¯` | `å¿«é€Ÿæ‰¾åˆ°bugæ ¹æº` |
| ğŸ”„ **é”™è¯¯æ¢å¤** | `å°è¯•ä¿®å¤æˆ–ç»•è¿‡é—®é¢˜` | `ç¨‹åºèƒ½ç»§ç»­æ­£å¸¸è¿è¡Œ` |
| ğŸ“ **ç”¨æˆ·å‹å¥½** | `ç»™ç”¨æˆ·æ¸…æ™°çš„é”™è¯¯æç¤º` | `ç”¨æˆ·çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆ` |

### 1.3 å¼‚å¸¸å¤„ç†çš„åŸºæœ¬ç»“æ„


```java
// åŸºæœ¬çš„å¼‚å¸¸å¤„ç†ç»“æ„
try {
    // å¯èƒ½å‡ºç°é—®é¢˜çš„ä»£ç 
    String content = readFile("config.txt");
    processData(content);
} catch (FileNotFoundException e) {
    // å¤„ç†æ–‡ä»¶ä¸å­˜åœ¨çš„æƒ…å†µ
    System.out.println("é…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤é…ç½®");
    useDefaultConfig();
} catch (IOException e) {
    // å¤„ç†å…¶ä»–IOé—®é¢˜
    System.out.println("è¯»å–æ–‡ä»¶æ—¶å‡ºé”™ï¼š" + e.getMessage());
} finally {
    // æ— è®ºæ˜¯å¦æœ‰å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œçš„ä»£ç 
    cleanup();
}
```

---

## 2. ğŸ“‹ å¼‚å¸¸åˆ†ç±»ä½“ç³»


### 2.1 Javaå¼‚å¸¸å±‚æ¬¡ç»“æ„


```
                    Throwable
                   /         \
              Error              Exception
               |                /        \
        (ç³»ç»Ÿçº§é”™è¯¯)      RuntimeException   (æ£€æŸ¥å¼‚å¸¸)
           |                    |              |
      OutOfMemoryError    NullPointerException  IOException
      StackOverflowError  ArrayIndexOutOfBounds FileNotFoundException
```

### 2.2 ä¸‰å¤§å¼‚å¸¸ç±»å‹è¯¦è§£


##### ğŸ”´ **Errorï¼ˆé”™è¯¯ï¼‰**


**ğŸ”¸ å«ä¹‰è§£é‡Š**
Erroræ˜¯ç³»ç»Ÿçº§åˆ«çš„ä¸¥é‡é—®é¢˜ï¼Œç¨‹åºé€šå¸¸æ— æ³•å¤„ç†ã€‚å°±åƒæˆ¿å­ç€ç«äº†ï¼Œä½ åªèƒ½é€ƒè·‘ï¼Œæ— æ³•ä¿®å¤ã€‚

**ğŸ’¡ å…¸å‹ä¾‹å­**
```java
// å†…å­˜è€—å°½é”™è¯¯ - ç¨‹åºæ— æ³•å¤„ç†
public class OutOfMemoryExample {
    public static void main(String[] args) {
        List<int[]> list = new ArrayList<>();
        while (true) {
            list.add(new int[1000000]); // ä¸æ–­ç”³è¯·å†…å­˜ï¼Œæœ€ç»ˆè€—å°½
        }
        // ç¨‹åºä¼šæŠ›å‡º OutOfMemoryError
    }
}
```

**âš ï¸ å¤„ç†åŸåˆ™**: é€šå¸¸ä¸å¤„ç†ï¼Œè®©ç¨‹åºç»“æŸå¹¶è®°å½•æ—¥å¿—

##### ğŸŸ¡ **RuntimeExceptionï¼ˆè¿è¡Œæ—¶å¼‚å¸¸ï¼‰**


**ğŸ”¸ å«ä¹‰è§£é‡Š**
è¿è¡Œæ—¶å¼‚å¸¸æ˜¯ç¨‹åºé€»è¾‘é”™è¯¯å¯¼è‡´çš„ï¼Œç†è®ºä¸Šå¯ä»¥é€šè¿‡æ”¹è¿›ä»£ç é¿å…ã€‚å°±åƒèµ°è·¯æ—¶ä¸å°å¿ƒè¸©åˆ°é¦™è•‰çš®æ»‘å€’ï¼Œæ˜¯å¯ä»¥é¢„é˜²çš„ã€‚

**ğŸ’¡ å¸¸è§ä¾‹å­**
```java
// ç©ºæŒ‡é’ˆå¼‚å¸¸ - æœ€å¸¸è§çš„è¿è¡Œæ—¶å¼‚å¸¸
String name = null;
int length = name.length(); // NullPointerException

// æ•°ç»„è¶Šç•Œå¼‚å¸¸
int[] numbers = {1, 2, 3};
int value = numbers[5]; // ArrayIndexOutOfBoundsException

// ç±»å‹è½¬æ¢å¼‚å¸¸
Object obj = "Hello";
Integer num = (Integer) obj; // ClassCastException
```

**ğŸ”§ å¤„ç†ç‰¹ç‚¹**: ä¸å¼ºåˆ¶å¤„ç†ï¼Œä½†åº”è¯¥é€šè¿‡ä»£ç é€»è¾‘é¿å…

##### ğŸŸ¢ **Checked Exceptionï¼ˆæ£€æŸ¥å¼‚å¸¸ï¼‰**


**ğŸ”¸ å«ä¹‰è§£é‡Š**
æ£€æŸ¥å¼‚å¸¸æ˜¯å¤–éƒ¨ç¯å¢ƒå› ç´ å¯¼è‡´çš„ï¼Œå¿…é¡»æ˜¾å¼å¤„ç†ã€‚å°±åƒå‡ºé—¨å‰å¿…é¡»æ£€æŸ¥å¤©æ°”ï¼Œä¸‹é›¨è¦å¸¦ä¼ã€‚

**ğŸ’¡ å…¸å‹ä¾‹å­**
```java
// æ–‡ä»¶æ“ä½œå¼‚å¸¸ - å¿…é¡»å¤„ç†
public void readFile(String filename) throws IOException {
    FileReader file = new FileReader(filename); // å¯èƒ½æŠ›å‡ºFileNotFoundException
    BufferedReader reader = new BufferedReader(file);
    String line = reader.readLine(); // å¯èƒ½æŠ›å‡ºIOException
    reader.close();
}

// ç½‘ç»œè¿æ¥å¼‚å¸¸
public void connectToServer() throws UnknownHostException {
    Socket socket = new Socket("192.168.1.100", 8080); // å¿…é¡»å¤„ç†ç½‘ç»œå¼‚å¸¸
}
```

### 2.3 å¼‚å¸¸åˆ†ç±»çš„å®ç”¨åˆ¤æ–­


**ğŸ¤” å¦‚ä½•åˆ¤æ–­å¼‚å¸¸ç±»å‹ï¼Ÿ**

```
é—®è‡ªå·±ä¸‰ä¸ªé—®é¢˜ï¼š

1ï¸âƒ£ è¿™ä¸ªé—®é¢˜ç¨‹åºèƒ½è§£å†³å—ï¼Ÿ
   - èƒ½è§£å†³ â†’ ç»§ç»­ä¸‹ä¸€æ­¥
   - ä¸èƒ½ â†’ Errorç±»å‹

2ï¸âƒ£ è¿™ä¸ªé—®é¢˜æ˜¯ä»£ç é€»è¾‘é”™è¯¯å—ï¼Ÿ
   - æ˜¯ â†’ RuntimeException
   - ä¸æ˜¯ â†’ ç»§ç»­ä¸‹ä¸€æ­¥

3ï¸âƒ£ è¿™ä¸ªé—®é¢˜æ˜¯å¤–éƒ¨ç¯å¢ƒé€ æˆçš„å—ï¼Ÿ
   - æ˜¯ â†’ Checked Exception
```

---

## 3. ğŸ”„ å¼‚å¸¸ä¼ æ’­æœºåˆ¶


### 3.1 å¼‚å¸¸ä¼ æ’­çš„åŸºæœ¬æ¦‚å¿µ


**ğŸ”¸ é€šä¿—ç†è§£**
å¼‚å¸¸ä¼ æ’­å°±åƒ**å‡»é¼“ä¼ èŠ±**ã€‚å½“ä¸€ä¸ªæ–¹æ³•å‡ºç°å¼‚å¸¸æ—¶ï¼Œå¦‚æœå®ƒä¸å¤„ç†ï¼Œå°±ä¼šæŠŠå¼‚å¸¸ä¼ é€’ç»™è°ƒç”¨å®ƒçš„æ–¹æ³•ï¼Œä¸€å±‚å±‚å‘ä¸Šä¼ é€’ï¼Œç›´åˆ°æœ‰äººå¤„ç†æˆ–è€…ç¨‹åºç»ˆæ­¢ã€‚

### 3.2 å¼‚å¸¸ä¼ æ’­è·¯å¾„å›¾è§£


```
mainæ–¹æ³•
   |
   â”œâ”€ è°ƒç”¨ serviceMethod()
          |
          â”œâ”€ è°ƒç”¨ daoMethod()
                 |
                 â”œâ”€ è°ƒç”¨ fileOperation() â† ğŸ’¥ å¼‚å¸¸å‘ç”Ÿ
                 |
                 â””â”€ å¼‚å¸¸å‘ä¸Šä¼ æ’­ â†‘
          |
          â””â”€ å¼‚å¸¸ç»§ç»­å‘ä¸Šä¼ æ’­ â†‘
   |
   â””â”€ æœ€ç»ˆåœ¨mainæ–¹æ³•å¤„ç†å¼‚å¸¸
```

### 3.3 å¼‚å¸¸ä¼ æ’­ç¤ºä¾‹


```java
public class ExceptionPropagation {
    
    public static void main(String[] args) {
        try {
            serviceLayer();
        } catch (Exception e) {
            System.out.println("åœ¨mainæ–¹æ³•ä¸­æ•è·å¼‚å¸¸ï¼š" + e.getMessage());
        }
    }
    
    // ä¸šåŠ¡å±‚ï¼šä¸å¤„ç†å¼‚å¸¸ï¼Œç»§ç»­å‘ä¸ŠæŠ›å‡º
    public static void serviceLayer() throws Exception {
        System.out.println("ä¸šåŠ¡å±‚å¼€å§‹å¤„ç†");
        dataLayer(); // è°ƒç”¨æ•°æ®å±‚
        System.out.println("ä¸šåŠ¡å±‚å¤„ç†å®Œæˆ"); // è¿™è¡Œä¸ä¼šæ‰§è¡Œ
    }
    
    // æ•°æ®å±‚ï¼šä¸å¤„ç†å¼‚å¸¸ï¼Œç»§ç»­å‘ä¸ŠæŠ›å‡º
    public static void dataLayer() throws Exception {
        System.out.println("æ•°æ®å±‚å¼€å§‹å¤„ç†");
        fileOperation(); // è°ƒç”¨æ–‡ä»¶æ“ä½œ
        System.out.println("æ•°æ®å±‚å¤„ç†å®Œæˆ"); // è¿™è¡Œä¸ä¼šæ‰§è¡Œ
    }
    
    // æ–‡ä»¶æ“ä½œï¼šæŠ›å‡ºå¼‚å¸¸
    public static void fileOperation() throws Exception {
        System.out.println("å¼€å§‹æ–‡ä»¶æ“ä½œ");
        throw new Exception("æ–‡ä»¶ä¸å­˜åœ¨"); // ğŸ’¥ å¼‚å¸¸åœ¨è¿™é‡Œäº§ç”Ÿ
    }
}
```

**ğŸ” è¿è¡Œç»“æœ**
```
ä¸šåŠ¡å±‚å¼€å§‹å¤„ç†
æ•°æ®å±‚å¼€å§‹å¤„ç†
å¼€å§‹æ–‡ä»¶æ“ä½œ
åœ¨mainæ–¹æ³•ä¸­æ•è·å¼‚å¸¸ï¼šæ–‡ä»¶ä¸å­˜åœ¨
```

### 3.4 å¼‚å¸¸ä¼ æ’­çš„æ§åˆ¶ç­–ç•¥


##### ğŸ›‘ **ç­–ç•¥1ï¼šç«‹å³å¤„ç†**

```java
public void processFile(String filename) {
    try {
        FileReader file = new FileReader(filename);
        // å¤„ç†æ–‡ä»¶...
    } catch (FileNotFoundException e) {
        // ç«‹å³å¤„ç†ï¼šä½¿ç”¨é»˜è®¤æ–‡ä»¶
        System.out.println("æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤é…ç½®");
        useDefaultConfig();
    }
}
```

##### ğŸ“¤ **ç­–ç•¥2ï¼šè½¬æ¢åæŠ›å‡º**

```java
public void businessMethod() throws BusinessException {
    try {
        databaseOperation();
    } catch (SQLException e) {
        // è½¬æ¢ä¸ºä¸šåŠ¡å¼‚å¸¸åæŠ›å‡º
        throw new BusinessException("æ•°æ®æ“ä½œå¤±è´¥", e);
    }
}
```

##### ğŸ“ **ç­–ç•¥3ï¼šè®°å½•åé‡æŠ›**

```java
public void serviceMethod() throws Exception {
    try {
        riskyOperation();
    } catch (Exception e) {
        // è®°å½•æ—¥å¿—åç»§ç»­æŠ›å‡º
        logger.error("æ“ä½œå¤±è´¥ï¼š" + e.getMessage(), e);
        throw e; // é‡æ–°æŠ›å‡ºï¼Œè®©ä¸Šå±‚å¤„ç†
    }
}
```

---

## 4. ğŸ¨ è‡ªå®šä¹‰å¼‚å¸¸è®¾è®¡


### 4.1 ä¸ºä»€ä¹ˆéœ€è¦è‡ªå®šä¹‰å¼‚å¸¸


**ğŸ”¸ æ ¸å¿ƒåŸå› **

| åŸå›  | **è¯´æ˜** | **å¥½å¤„** |
|------|---------|---------|
| ğŸ¯ **ä¸šåŠ¡è¯­ä¹‰** | `ç”¨ä¸šåŠ¡æœ¯è¯­æè¿°é”™è¯¯` | `ä¸€çœ‹å°±çŸ¥é“ä»€ä¹ˆé—®é¢˜` |
| ğŸ” **ç²¾ç¡®å®šä½** | `åŒºåˆ†ä¸åŒç±»å‹çš„ä¸šåŠ¡é”™è¯¯` | `å¿«é€Ÿå®šä½é—®é¢˜æ ¹æº` |
| ğŸ“Š **ç»Ÿä¸€å¤„ç†** | `ç›¸åŒç±»å‹å¼‚å¸¸ç»Ÿä¸€å¤„ç†` | `ä»£ç æ›´æ•´æ´` |
| ğŸ“ˆ **æ‰©å±•æ€§** | `æºå¸¦æ›´å¤šä¸šåŠ¡ä¿¡æ¯` | `æ”¯æŒå¤æ‚çš„é”™è¯¯å¤„ç†` |

ğŸŒ° **å¯¹æ¯”ç¤ºä¾‹**
```java
// âŒ ä½¿ç”¨é€šç”¨å¼‚å¸¸ - ä¿¡æ¯æ¨¡ç³Š
throw new Exception("æ“ä½œå¤±è´¥");

// âœ… ä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸ - ä¿¡æ¯æ˜ç¡®
throw new UserNotFoundExeption("ç”¨æˆ·ID: 12345 ä¸å­˜åœ¨");
throw new BalanceInsufficientException("è´¦æˆ·ä½™é¢ä¸è¶³ï¼Œå½“å‰ä½™é¢: 100ï¼Œéœ€è¦: 500");
```

### 4.2 è‡ªå®šä¹‰å¼‚å¸¸çš„è®¾è®¡åŸåˆ™


##### ğŸ“‹ **è®¾è®¡æ¸…å•**

- [x] **å‘½åæ¸…æ™°**: å¼‚å¸¸åå­—èƒ½è¡¨è¾¾å…·ä½“é—®é¢˜
- [x] **ç»§æ‰¿åˆé€‚**: é€‰æ‹©åˆé€‚çš„çˆ¶ç±»å¼‚å¸¸
- [x] **ä¿¡æ¯ä¸°å¯Œ**: åŒ…å«è¶³å¤Ÿçš„è°ƒè¯•ä¿¡æ¯
- [x] **æ„é€ æ–¹æ³•**: æä¾›å¤šç§æ„é€ æ–¹å¼
- [x] **é”™è¯¯ç **: å¯é€‰çš„é”™è¯¯ä»£ç æ”¯æŒ

### 4.3 è‡ªå®šä¹‰å¼‚å¸¸å®ç°ç¤ºä¾‹


##### ğŸ”¸ **åŸºç¡€è‡ªå®šä¹‰å¼‚å¸¸**

```java
// ç”¨æˆ·ç›¸å…³å¼‚å¸¸çš„åŸºç±»
public class UserException extends Exception {
    private String errorCode;
    private Object[] params;
    
    public UserException(String message) {
        super(message);
    }
    
    public UserException(String errorCode, String message) {
        super(message);
        this.errorCode = errorCode;
    }
    
    public UserException(String message, Throwable cause) {
        super(message, cause);
    }
    
    // è·å–é”™è¯¯ç 
    public String getErrorCode() {
        return errorCode;
    }
}
```

##### ğŸ”¸ **å…·ä½“ä¸šåŠ¡å¼‚å¸¸**

```java
// ç”¨æˆ·ä¸å­˜åœ¨å¼‚å¸¸
public class UserNotFoundException extends UserException {
    private Long userId;
    
    public UserNotFoundException(Long userId) {
        super("USER_NOT_FOUND", "ç”¨æˆ·ä¸å­˜åœ¨ï¼ŒID: " + userId);
        this.userId = userId;
    }
    
    public Long getUserId() {
        return userId;
    }
}

// ä½™é¢ä¸è¶³å¼‚å¸¸
public class BalanceInsufficientException extends UserException {
    private BigDecimal currentBalance;
    private BigDecimal requiredAmount;
    
    public BalanceInsufficientException(BigDecimal current, BigDecimal required) {
        super("BALANCE_INSUFFICIENT", 
              String.format("ä½™é¢ä¸è¶³ï¼šå½“å‰ %.2fï¼Œéœ€è¦ %.2f", current, required));
        this.currentBalance = current;
        this.requiredAmount = required;
    }
    
    // æä¾›getteræ–¹æ³•è·å–è¯¦ç»†ä¿¡æ¯
    public BigDecimal getCurrentBalance() { return currentBalance; }
    public BigDecimal getRequiredAmount() { return requiredAmount; }
}
```

### 4.4 å¼‚å¸¸å·¥å‚æ¨¡å¼


```java
// å¼‚å¸¸å·¥å‚ - ç»Ÿä¸€åˆ›å»ºå¼‚å¸¸
public class ExceptionFactory {
    
    public static UserNotFoundException userNotFound(Long userId) {
        return new UserNotFoundException(userId);
    }
    
    public static BalanceInsufficientException balanceInsufficient(
            BigDecimal current, BigDecimal required) {
        return new BalanceInsufficientException(current, required);
    }
    
    public static ValidationException validationFailed(String field, Object value) {
        return new ValidationException(
            String.format("å­—æ®µ %s çš„å€¼ %s ä¸åˆæ³•", field, value));
    }
}

// ä½¿ç”¨å·¥å‚åˆ›å»ºå¼‚å¸¸
public void transfer(Long fromUserId, Long toUserId, BigDecimal amount) {
    User fromUser = userService.findById(fromUserId);
    if (fromUser == null) {
        throw ExceptionFactory.userNotFound(fromUserId); // ğŸ¯ è¯­ä¹‰æ¸…æ™°
    }
    
    if (fromUser.getBalance().compareTo(amount) < 0) {
        throw ExceptionFactory.balanceInsufficient(fromUser.getBalance(), amount);
    }
}
```

---

## 5. ğŸ”§ å¼‚å¸¸æ¢å¤ç­–ç•¥


### 5.1 å¼‚å¸¸æ¢å¤çš„åŸºæœ¬æ€è·¯


**ğŸ”¸ æ ¸å¿ƒç†å¿µ**
å¼‚å¸¸æ¢å¤å°±æ˜¯**"æœ‰å¤‡èƒå°±æ¢å¤‡èƒï¼Œæ²¡å¤‡èƒå°±é™çº§æœåŠ¡"**ã€‚å½“é‡åˆ°é—®é¢˜æ—¶ï¼Œä¸æ˜¯ç®€å•åœ°æŠ¥é”™ï¼Œè€Œæ˜¯å°è¯•ç”¨å…¶ä»–æ–¹å¼å®Œæˆä»»åŠ¡æˆ–æä¾›é™çº§æœåŠ¡ã€‚

### 5.2 äº”ç§ä¸»è¦æ¢å¤ç­–ç•¥


##### ğŸ”„ **ç­–ç•¥1ï¼šé‡è¯•æœºåˆ¶**


**é€‚ç”¨åœºæ™¯**: ç½‘ç»œæŠ–åŠ¨ã€ä¸´æ—¶èµ„æºä¸è¶³ç­‰ç¬æ—¶é—®é¢˜

```java
public class RetryHandler {
    private static final int MAX_RETRY = 3;
    private static final long RETRY_DELAY = 1000; // 1ç§’
    
    public String callRemoteService(String request) throws ServiceException {
        Exception lastException = null;
        
        for (int i = 0; i < MAX_RETRY; i++) {
            try {
                return httpClient.call(request); // å°è¯•è°ƒç”¨æœåŠ¡
            } catch (NetworkException e) {
                lastException = e;
                System.out.println("ç¬¬" + (i + 1) + "æ¬¡è°ƒç”¨å¤±è´¥ï¼Œå‡†å¤‡é‡è¯•...");
                
                if (i < MAX_RETRY - 1) { // ä¸æ˜¯æœ€åä¸€æ¬¡ï¼Œç­‰å¾…åé‡è¯•
                    try {
                        Thread.sleep(RETRY_DELAY);
                    } catch (InterruptedException ie) {
                        Thread.currentThread().interrupt();
                        break;
                    }
                }
            }
        }
        
        // é‡è¯•å…¨éƒ¨å¤±è´¥ï¼ŒæŠ›å‡ºå¼‚å¸¸
        throw new ServiceException("æœåŠ¡è°ƒç”¨å¤±è´¥ï¼Œå·²é‡è¯•" + MAX_RETRY + "æ¬¡", lastException);
    }
}
```

##### ğŸ›¡ï¸ **ç­–ç•¥2ï¼šå¤‡ç”¨æ–¹æ¡ˆ**


**é€‚ç”¨åœºæ™¯**: ä¸»è¦åŠŸèƒ½ä¸å¯ç”¨æ—¶ï¼Œä½¿ç”¨å¤‡ç”¨åŠŸèƒ½

```java
public class ConfigService {
    
    public Configuration loadConfig() {
        try {
            // ä¼˜å…ˆä»è¿œç¨‹é…ç½®ä¸­å¿ƒåŠ è½½
            return loadFromRemoteCenter();
        } catch (RemoteServiceException e) {
            System.out.println("è¿œç¨‹é…ç½®æœåŠ¡ä¸å¯ç”¨ï¼Œä½¿ç”¨æœ¬åœ°é…ç½®");
            
            try {
                // å¤‡ç”¨æ–¹æ¡ˆ1ï¼šä»æœ¬åœ°æ–‡ä»¶åŠ è½½
                return loadFromLocalFile();
            } catch (FileNotFoundException fe) {
                System.out.println("æœ¬åœ°é…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤é…ç½®");
                
                // å¤‡ç”¨æ–¹æ¡ˆ2ï¼šä½¿ç”¨é»˜è®¤é…ç½®
                return getDefaultConfiguration();
            }
        }
    }
    
    private Configuration getDefaultConfiguration() {
        Configuration config = new Configuration();
        config.setDatabaseUrl("localhost:3306");
        config.setMaxConnections(10);
        return config;
    }
}
```

##### ğŸ“‰ **ç­–ç•¥3ï¼šåŠŸèƒ½é™çº§**


**é€‚ç”¨åœºæ™¯**: ç³»ç»Ÿè´Ÿè½½è¿‡é«˜æ—¶ï¼Œå…³é—­éæ ¸å¿ƒåŠŸèƒ½

```java
public class RecommendationService {
    private boolean isHighLoad = false;
    
    public List<Product> getRecommendations(Long userId) {
        try {
            if (isHighLoad) {
                // é«˜è´Ÿè½½æ—¶ä½¿ç”¨ç®€å•æ¨è
                return getSimpleRecommendations(userId);
            } else {
                // æ­£å¸¸æƒ…å†µä½¿ç”¨AIæ¨è
                return getAIRecommendations(userId);
            }
        } catch (AIServiceException e) {
            System.out.println("AIæ¨èæœåŠ¡å¼‚å¸¸ï¼Œé™çº§ä¸ºç®€å•æ¨è");
            return getSimpleRecommendations(userId);
        } catch (Exception e) {
            System.out.println("æ¨èæœåŠ¡å®Œå…¨ä¸å¯ç”¨ï¼Œè¿”å›çƒ­é—¨å•†å“");
            return getHotProducts(); // æœ€åŸºç¡€çš„é™çº§æ–¹æ¡ˆ
        }
    }
    
    private List<Product> getSimpleRecommendations(Long userId) {
        // åŸºäºç”¨æˆ·å†å²è´­ä¹°çš„ç®€å•æ¨è
        return productService.findByUserHistory(userId);
    }
    
    private List<Product> getHotProducts() {
        // è¿”å›çƒ­é—¨å•†å“ä½œä¸ºå…œåº•æ–¹æ¡ˆ
        return productService.findHotProducts();
    }
}
```

##### ğŸ’¾ **ç­–ç•¥4ï¼šç¼“å­˜å…œåº•**


**é€‚ç”¨åœºæ™¯**: å®æ—¶æ•°æ®ä¸å¯ç”¨æ—¶ï¼Œä½¿ç”¨ç¼“å­˜æ•°æ®

```java
public class UserService {
    private Cache<Long, User> userCache = new LRUCache<>();
    
    public User getUserById(Long userId) {
        try {
            // ä¼˜å…ˆä»æ•°æ®åº“è·å–æœ€æ–°æ•°æ®
            User user = userRepository.findById(userId);
            userCache.put(userId, user); // æ›´æ–°ç¼“å­˜
            return user;
            
        } catch (DatabaseException e) {
            System.out.println("æ•°æ®åº“è¿æ¥å¼‚å¸¸ï¼Œä½¿ç”¨ç¼“å­˜æ•°æ®");
            
            User cachedUser = userCache.get(userId);
            if (cachedUser != null) {
                System.out.println("âš ï¸ æ³¨æ„ï¼šè¿”å›çš„æ˜¯ç¼“å­˜æ•°æ®ï¼Œå¯èƒ½ä¸æ˜¯æœ€æ–°çš„");
                return cachedUser;
            } else {
                throw new UserNotFoundException("ç”¨æˆ·ä¸å­˜åœ¨ä¸”ç¼“å­˜ä¸­æ— æ•°æ®", e);
            }
        }
    }
}
```

##### ğŸ”„ **ç­–ç•¥5ï¼šæ–­è·¯å™¨æ¨¡å¼**


**é€‚ç”¨åœºæ™¯**: å¤–éƒ¨æœåŠ¡é¢‘ç¹å¤±è´¥æ—¶ï¼Œæš‚æ—¶åœæ­¢è°ƒç”¨

```java
public class CircuitBreakerService {
    private enum State { CLOSED, OPEN, HALF_OPEN }
    
    private State state = State.CLOSED;
    private int failureCount = 0;
    private long lastFailureTime = 0;
    private static final int FAILURE_THRESHOLD = 5;
    private static final long RECOVERY_TIMEOUT = 30000; // 30ç§’
    
    public String callExternalService(String request) throws ServiceException {
        
        // æ£€æŸ¥æ–­è·¯å™¨çŠ¶æ€
        if (state == State.OPEN) {
            if (System.currentTimeMillis() - lastFailureTime > RECOVERY_TIMEOUT) {
                state = State.HALF_OPEN; // å°è¯•æ¢å¤
                System.out.println("æ–­è·¯å™¨è¿›å…¥åŠå¼€çŠ¶æ€ï¼Œå°è¯•è°ƒç”¨æœåŠ¡");
            } else {
                throw new ServiceException("æ–­è·¯å™¨å¼€å¯ä¸­ï¼ŒæœåŠ¡æš‚æ—¶ä¸å¯ç”¨");
            }
        }
        
        try {
            String result = externalApiClient.call(request);
            
            // è°ƒç”¨æˆåŠŸï¼Œé‡ç½®çŠ¶æ€
            if (state == State.HALF_OPEN) {
                state = State.CLOSED;
                failureCount = 0;
                System.out.println("æœåŠ¡æ¢å¤æ­£å¸¸ï¼Œæ–­è·¯å™¨å…³é—­");
            }
            
            return result;
            
        } catch (Exception e) {
            failureCount++;
            lastFailureTime = System.currentTimeMillis();
            
            // è¾¾åˆ°å¤±è´¥é˜ˆå€¼ï¼Œå¼€å¯æ–­è·¯å™¨
            if (failureCount >= FAILURE_THRESHOLD) {
                state = State.OPEN;
                System.out.println("æœåŠ¡è¿ç»­å¤±è´¥" + FAILURE_THRESHOLD + "æ¬¡ï¼Œæ–­è·¯å™¨å¼€å¯");
            }
            
            throw new ServiceException("å¤–éƒ¨æœåŠ¡è°ƒç”¨å¤±è´¥", e);
        }
    }
}
```

### 5.3 æ¢å¤ç­–ç•¥é€‰æ‹©æŒ‡å—


| å¼‚å¸¸ç±»å‹ | **æ¨èç­–ç•¥** | **ç†ç”±** |
|---------|-------------|---------|
| ğŸŒ **ç½‘ç»œè¶…æ—¶** | `é‡è¯• + æ–­è·¯å™¨` | `å¯èƒ½æ˜¯ç¬æ—¶é—®é¢˜` |
| ğŸ’¾ **æ•°æ®åº“è¿æ¥å¤±è´¥** | `é‡è¯• + ç¼“å­˜å…œåº•` | `ç¼“å­˜å¯ä»¥ä¸´æ—¶æ›¿ä»£` |
| ğŸ”§ **å¤–éƒ¨æœåŠ¡ä¸å¯ç”¨** | `å¤‡ç”¨æ–¹æ¡ˆ + é™çº§` | `æœ‰å…¶ä»–å®ç°æ–¹å¼` |
| âš¡ **ç³»ç»Ÿè´Ÿè½½è¿‡é«˜** | `åŠŸèƒ½é™çº§` | `ä¿è¯æ ¸å¿ƒåŠŸèƒ½` |
| ğŸ“ **é…ç½®æ–‡ä»¶æŸå** | `å¤‡ç”¨æ–¹æ¡ˆ` | `æœ‰é»˜è®¤é…ç½®` |

---

## 6. ğŸ“‹ æœ€ä½³å®è·µæ€»ç»“


### 6.1 å¼‚å¸¸å¤„ç†çš„æ ¸å¿ƒåŸåˆ™


**ğŸ¯ äº”å¤§åŸåˆ™**

```
1ï¸âƒ£ åŠæ—©æ£€æµ‹ï¼šé—®é¢˜å‡ºç°æ—¶ç«‹å³å‘ç°
2ï¸âƒ£ æ˜ç¡®è¡¨è¾¾ï¼šå¼‚å¸¸ä¿¡æ¯è¦æ¸…æ™°æ˜ç¡®
3ï¸âƒ£ åˆç†ä¼ æ’­ï¼šåœ¨åˆé€‚çš„å±‚çº§å¤„ç†å¼‚å¸¸
4ï¸âƒ£ ä¼˜é›…æ¢å¤ï¼šå°½é‡è®©ç¨‹åºç»§ç»­è¿è¡Œ
5ï¸âƒ£ å®Œæ•´æ—¥å¿—ï¼šè®°å½•è¶³å¤Ÿçš„è°ƒè¯•ä¿¡æ¯
```

### 6.2 å¼‚å¸¸å¤„ç†å®ç”¨æ£€æŸ¥æ¸…å•


**ğŸ“‹ å¼€å‘æ—¶æ£€æŸ¥**
- [ ] æ˜¯å¦å¯¹æ‰€æœ‰å¯èƒ½çš„å¼‚å¸¸æƒ…å†µè¿›è¡Œäº†å¤„ç†ï¼Ÿ
- [ ] å¼‚å¸¸ä¿¡æ¯æ˜¯å¦è¶³å¤Ÿæ˜ç¡®ï¼Œä¾¿äºè°ƒè¯•ï¼Ÿ
- [ ] æ˜¯å¦åœ¨åˆé€‚çš„å±‚çº§æ•è·å’Œå¤„ç†å¼‚å¸¸ï¼Ÿ
- [ ] æ˜¯å¦æä¾›äº†åˆç†çš„æ¢å¤æˆ–é™çº§æ–¹æ¡ˆï¼Ÿ
- [ ] æ˜¯å¦è®°å½•äº†è¶³å¤Ÿçš„æ—¥å¿—ä¿¡æ¯ï¼Ÿ

**ğŸ“‹ ä»£ç å®¡æŸ¥æ£€æŸ¥**
- [ ] æ˜¯å¦å­˜åœ¨åæ²¡å¼‚å¸¸çš„æƒ…å†µï¼ˆcatchåä¸å¤„ç†ï¼‰ï¼Ÿ
- [ ] æ˜¯å¦æ­£ç¡®å…³é—­äº†èµ„æºï¼ˆä½¿ç”¨try-with-resourcesï¼‰ï¼Ÿ
- [ ] å¼‚å¸¸ç±»å‹æ˜¯å¦é€‰æ‹©åˆé€‚ï¼Ÿ
- [ ] æ˜¯å¦æœ‰ä¸å¿…è¦çš„å¼‚å¸¸è½¬æ¢ï¼Ÿ

### 6.3 å¸¸è§åæ¨¡å¼é¿å…


##### âŒ **åæ¨¡å¼1ï¼šåæ²¡å¼‚å¸¸**

```java
// âŒ é”™è¯¯åšæ³•ï¼šåæ²¡å¼‚å¸¸
try {
    riskyOperation();
} catch (Exception e) {
    // ä»€ä¹ˆéƒ½ä¸åšï¼Œå¼‚å¸¸è¢«åæ²¡äº†
}

// âœ… æ­£ç¡®åšæ³•ï¼šè‡³å°‘è®°å½•æ—¥å¿—
try {
    riskyOperation();
} catch (Exception e) {
    logger.error("æ“ä½œå¤±è´¥", e);
    // æ ¹æ®æƒ…å†µå†³å®šæ˜¯å¦é‡æŠ›å¼‚å¸¸
}
```

##### âŒ **åæ¨¡å¼2ï¼šè¿‡åº¦æ•è·**

```java
// âŒ é”™è¯¯åšæ³•ï¼šæ•è·è¿‡äºå®½æ³›
try {
    specificOperation();
} catch (Exception e) { // æ•è·æ‰€æœ‰å¼‚å¸¸
    handleError(e);
}

// âœ… æ­£ç¡®åšæ³•ï¼šæ•è·å…·ä½“å¼‚å¸¸
try {
    specificOperation();
} catch (IOException e) {
    handleIOError(e);
} catch (ValidationException e) {
    handleValidationError(e);
}
```

### 6.4 å¼‚å¸¸å¤„ç†æˆç†Ÿåº¦æ¨¡å‹


**ğŸ“ˆ å››ä¸ªæˆç†Ÿåº¦ç­‰çº§**

```
ğŸ”° Level 1 - åŸºç¡€é˜²æŠ¤
â€¢ åŸºæœ¬çš„try-catchä½¿ç”¨
â€¢ é¿å…ç¨‹åºå´©æºƒ
â€¢ ç®€å•çš„é”™è¯¯ä¿¡æ¯

ğŸ”¸ Level 2 - åˆ†ç±»å¤„ç†  
â€¢ åŒºåˆ†ä¸åŒå¼‚å¸¸ç±»å‹
â€¢ è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸
â€¢ åŸºæœ¬çš„æ¢å¤ç­–ç•¥

â­ Level 3 - æ™ºèƒ½æ¢å¤
â€¢ å¤šç§æ¢å¤ç­–ç•¥
â€¢ æ–­è·¯å™¨æ¨¡å¼
â€¢ å®Œå–„çš„ç›‘æ§å’Œæ—¥å¿—

ğŸ† Level 4 - ç³»ç»Ÿæ€§ä¿éšœ
â€¢ å…¨é“¾è·¯å¼‚å¸¸ç®¡ç†
â€¢ è‡ªåŠ¨åŒ–æ•…éšœæ¢å¤
â€¢ å¼‚å¸¸è¶‹åŠ¿åˆ†æ
```

### 6.5 è®°å¿†è¦ç‚¹


ğŸ§  **æ ¸å¿ƒè®°å¿†**
- **å¼‚å¸¸åˆ†ç±»**: Errorä¸å¤„ç†ï¼ŒRuntimeå¯é¿å…ï¼ŒCheckedå¿…å¤„ç†
- **ä¼ æ’­æœºåˆ¶**: å±‚å±‚å‘ä¸Šä¼ ï¼Œç›´åˆ°æœ‰äººç®¡
- **è‡ªå®šä¹‰å¼‚å¸¸**: ä¸šåŠ¡è¯­ä¹‰åŒ–ï¼Œä¿¡æ¯è¦ä¸°å¯Œ
- **æ¢å¤ç­–ç•¥**: é‡è¯•ã€å¤‡ç”¨ã€é™çº§ã€ç¼“å­˜ã€æ–­è·¯å™¨
- **æœ€ä½³å®è·µ**: åŠæ—©å‘ç°ï¼Œæ˜ç¡®è¡¨è¾¾ï¼Œä¼˜é›…æ¢å¤

> ğŸ’¡ **å®ç”¨å£è¯€**  
> å¼‚å¸¸å¤„ç†æœ‰ç­–ç•¥ï¼Œåˆ†ç±»ä¼ æ’­è¦æ˜ç™½ï¼›  
> è‡ªå®šä¹‰è¦è¯­ä¹‰åŒ–ï¼Œæ¢å¤æ–¹æ¡ˆå¤šå‡†å¤‡ï¼›  
> æ—¥å¿—è®°å½•è¦è¯¦ç»†ï¼Œç”¨æˆ·ä½“éªŒä¸èƒ½åã€‚