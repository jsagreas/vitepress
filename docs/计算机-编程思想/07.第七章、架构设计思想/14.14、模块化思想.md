---
title: 14ã€æ¨¡å—åŒ–æ€æƒ³
---
## ğŸ“š ç›®å½•

1. [æ¨¡å—è®¾è®¡æ€ç»´](#1-æ¨¡å—è®¾è®¡æ€ç»´)
2. [ç»„ä»¶åŒ–æ€ç»´](#2-ç»„ä»¶åŒ–æ€ç»´)
3. [æœåŠ¡åŒ–æ€ç»´](#3-æœåŠ¡åŒ–æ€ç»´)
4. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#4-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ§© æ¨¡å—è®¾è®¡æ€ç»´


> ğŸ’¡ **æ¨¡å—è®¾è®¡æ€ç»´**ï¼šæŠŠå¤æ‚çš„ç³»ç»Ÿåƒæ­ç§¯æœ¨ä¸€æ ·ï¼Œæ‹†åˆ†æˆä¸€ä¸ªä¸ªç‹¬ç«‹çš„å°æ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—ä¸“é—¨è´Ÿè´£ä¸€ä»¶äº‹æƒ…

### 1.1 å•ä¸€èŒè´£åŸåˆ™


**ğŸ”¸ ä»€ä¹ˆæ˜¯å•ä¸€èŒè´£**
```
ç®€å•ç†è§£ï¼šä¸€ä¸ªæ¨¡å—åªåšä¸€ä»¶äº‹ï¼Œå°±åƒä¸“ä¸šåˆ†å·¥ä¸€æ ·
- å¨å¸ˆä¸“é—¨åšèœ
- æœåŠ¡å‘˜ä¸“é—¨ä¸Šèœ  
- æ”¶é“¶å‘˜ä¸“é—¨æ”¶é’±

ä»£ç ä¸–ç•Œä¹Ÿæ˜¯å¦‚æ­¤ï¼š
- ç”¨æˆ·æ¨¡å—ï¼šåªç®¡ç”¨æˆ·ç›¸å…³æ“ä½œ
- è®¢å•æ¨¡å—ï¼šåªç®¡è®¢å•å¤„ç†
- æ”¯ä»˜æ¨¡å—ï¼šåªç®¡æ”¯ä»˜åŠŸèƒ½
```

**ğŸ’» ä»£ç ç¤ºä¾‹å¯¹æ¯”**
```javascript
// âŒ è¿åå•ä¸€èŒè´£ - ä¸€ä¸ªç±»åšå¤ªå¤šäº‹
class UserManager {
  createUser(data) { /* åˆ›å»ºç”¨æˆ· */ }
  sendEmail(email) { /* å‘é€é‚®ä»¶ */ }
  logActivity(action) { /* è®°å½•æ—¥å¿— */ }
  calculateDiscount(user) { /* è®¡ç®—æŠ˜æ‰£ */ }
}

// âœ… éµå¾ªå•ä¸€èŒè´£ - å„å¸å…¶èŒ
class UserService {
  createUser(data) { /* åªç®¡ç”¨æˆ·æ“ä½œ */ }
}

class EmailService {
  sendEmail(email) { /* åªç®¡é‚®ä»¶å‘é€ */ }
}

class LogService {
  logActivity(action) { /* åªç®¡æ—¥å¿—è®°å½• */ }
}
```

**ğŸ¯ ä¸ºä»€ä¹ˆè¦å•ä¸€èŒè´£**
- **å®¹æ˜“ç†è§£**ï¼šä¸€ä¸ªæ¨¡å—åŠŸèƒ½å•çº¯ï¼Œä¸€çœ‹å°±æ‡‚
- **å®¹æ˜“ä¿®æ”¹**ï¼šæ”¹ç”¨æˆ·åŠŸèƒ½ä¸ä¼šå½±å“é‚®ä»¶åŠŸèƒ½
- **å®¹æ˜“æµ‹è¯•**ï¼šæµ‹è¯•èŒƒå›´æ˜ç¡®ï¼Œä¸ä¼šç‰µä¸€å‘åŠ¨å…¨èº«
- **å®¹æ˜“å¤ç”¨**ï¼šå…¶ä»–åœ°æ–¹éœ€è¦å‘é‚®ä»¶ï¼Œç›´æ¥ç”¨EmailService

### 1.2 é«˜å†…èšåŸåˆ™


**ğŸ”¸ ä»€ä¹ˆæ˜¯é«˜å†…èš**
```
å†…èšï¼šæ¨¡å—å†…éƒ¨å„éƒ¨åˆ†çš„å…³ç³»ç´§å¯†ç¨‹åº¦
é«˜å†…èšï¼šæ¨¡å—å†…çš„åŠŸèƒ½ç´§å¯†ç›¸å…³ï¼Œåƒä¸€ä¸ªå›¢é˜Ÿ

ç”Ÿæ´»ä¾‹å­ï¼š
ä¸€ä¸ªå¥½çš„å›¢é˜Ÿï¼š
- å¤§å®¶ç›®æ ‡ä¸€è‡´
- äº’ç›¸é…åˆé»˜å¥‘
- å…±åŒå®Œæˆä»»åŠ¡

æ¨¡å—ä¹Ÿæ˜¯å¦‚æ­¤ï¼š
- åŠŸèƒ½ç›¸å…³æ€§å¼º
- æ•°æ®å…±äº«åˆç†
- å…±åŒå®ç°ç›®æ ‡
```

**ğŸ’» ä»£ç ç¤ºä¾‹**
```javascript
// âœ… é«˜å†…èšçš„ç”¨æˆ·æ¨¡å—
class User {
  constructor(name, email) {
    this.name = name;           // ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
    this.email = email;         // ç”¨æˆ·è”ç³»æ–¹å¼
    this.loginCount = 0;        // ç”¨æˆ·è¡Œä¸ºæ•°æ®
  }
  
  // è¿™äº›æ–¹æ³•éƒ½å›´ç»•"ç”¨æˆ·"è¿™ä¸ªæ ¸å¿ƒæ¦‚å¿µ
  login() {
    this.loginCount++;
    this.updateLastLoginTime();
  }
  
  updateProfile(newName) {
    this.name = newName;
  }
  
  updateLastLoginTime() {
    this.lastLogin = new Date();
  }
}

// âŒ ä½å†…èšçš„æ··ä¹±æ¨¡å—
class MixedModule {
  createUser() { /* ç”¨æˆ·ç›¸å…³ */ }
  sendEmail() { /* é‚®ä»¶ç›¸å…³ */ }
  calculateTax() { /* ç¨åŠ¡ç›¸å…³ */ }
  playMusic() { /* éŸ³ä¹ç›¸å…³ */ }
  // è¿™äº›åŠŸèƒ½æ¯«æ— å…³ç³»ï¼Œæ”¾åœ¨ä¸€èµ·å¾ˆæ··ä¹±
}
```

### 1.3 ä½è€¦åˆåŸåˆ™


**ğŸ”¸ ä»€ä¹ˆæ˜¯ä½è€¦åˆ**
```
è€¦åˆï¼šæ¨¡å—ä¹‹é—´çš„ä¾èµ–ç¨‹åº¦
ä½è€¦åˆï¼šæ¨¡å—é—´ä¾èµ–å°½å¯èƒ½å°‘ï¼Œåƒç‹¬ç«‹çš„æˆ¿é—´

ç”Ÿæ´»ä¾‹å­ï¼š
å¥½çš„æˆ¿é—´è®¾è®¡ï¼š
- å§å®¤å¯ä»¥ç‹¬ç«‹ä½¿ç”¨
- å¨æˆ¿å¯ä»¥ç‹¬ç«‹ä½¿ç”¨  
- å®¢å…å¯ä»¥ç‹¬ç«‹ä½¿ç”¨
- äº’ä¸å¹²æ‰°

æ¨¡å—è®¾è®¡ä¹Ÿè¦å¦‚æ­¤ï¼š
- ç”¨æˆ·æ¨¡å—ç‹¬ç«‹å·¥ä½œ
- è®¢å•æ¨¡å—ç‹¬ç«‹å·¥ä½œ
- æ”¯ä»˜æ¨¡å—ç‹¬ç«‹å·¥ä½œ
```

**ğŸ’» ä»£ç ç¤ºä¾‹**
```javascript
// âŒ é«˜è€¦åˆ - æ¨¡å—é—´ç´§å¯†ä¾èµ–
class OrderService {
  createOrder(userId, productId) {
    // ç›´æ¥ä¾èµ–å…·ä½“çš„ç”¨æˆ·å’Œå•†å“ç±»
    const user = new UserService().getUser(userId);
    const product = new ProductService().getProduct(productId);
    // å¦‚æœUserServiceæ”¹å˜ï¼ŒOrderServiceä¹Ÿè¦æ”¹
  }
}

// âœ… ä½è€¦åˆ - é€šè¿‡æ¥å£ä¾èµ–
class OrderService {
  constructor(userService, productService) {
    this.userService = userService;     // ä¾èµ–æ³¨å…¥
    this.productService = productService;
  }
  
  createOrder(userId, productId) {
    // ä¸å…³å¿ƒå…·ä½“å®ç°ï¼Œåªå…³å¿ƒèƒ½æä¾›æœåŠ¡
    const user = this.userService.getUser(userId);
    const product = this.productService.getProduct(productId);
  }
}
```

### 1.4 æ¥å£è®¾è®¡


**ğŸ”¸ ä»€ä¹ˆæ˜¯æ¥å£è®¾è®¡**
```
æ¥å£ï¼šæ¨¡å—å¯¹å¤–æä¾›æœåŠ¡çš„"çª—å£"
å°±åƒé¤å…çš„èœå•ï¼š
- é¡¾å®¢åªéœ€è¦çŸ¥é“æœ‰ä»€ä¹ˆèœ
- ä¸éœ€è¦çŸ¥é“å¨æˆ¿æ€ä¹ˆåšèœ
- å¨æˆ¿å¯ä»¥æ¢å¨å¸ˆï¼Œä½†èœå•ä¸å˜

ä»£ç ä¸­çš„æ¥å£ï¼š
- å®šä¹‰æ¨¡å—èƒ½åšä»€ä¹ˆ
- éšè—å…·ä½“æ€ä¹ˆåš
- ä¿è¯è°ƒç”¨æ–¹å¼ç¨³å®š
```

**ğŸ’» ä»£ç ç¤ºä¾‹**
```javascript
// å®šä¹‰æ¥å£ - åƒèœå•ä¸€æ ·æ˜ç¡®
class PaymentInterface {
  pay(amount) {
    throw new Error('å¿…é¡»å®ç°payæ–¹æ³•');
  }
  
  refund(orderId) {
    throw new Error('å¿…é¡»å®ç°refundæ–¹æ³•');
  }
}

// å…·ä½“å®ç° - åƒå¨æˆ¿åšèœçš„è¿‡ç¨‹
class AlipayService extends PaymentInterface {
  pay(amount) {
    console.log(`æ”¯ä»˜å®æ”¯ä»˜: ${amount}å…ƒ`);
    // å…·ä½“çš„æ”¯ä»˜å®æ”¯ä»˜é€»è¾‘
  }
  
  refund(orderId) {
    console.log(`æ”¯ä»˜å®é€€æ¬¾: è®¢å•${orderId}`);
    // å…·ä½“çš„é€€æ¬¾é€»è¾‘
  }
}

class WechatPayService extends PaymentInterface {
  pay(amount) {
    console.log(`å¾®ä¿¡æ”¯ä»˜: ${amount}å…ƒ`);
    // å¾®ä¿¡æ”¯ä»˜çš„å…·ä½“å®ç°
  }
  
  refund(orderId) {
    console.log(`å¾®ä¿¡é€€æ¬¾: è®¢å•${orderId}`);
    // å¾®ä¿¡é€€æ¬¾çš„å…·ä½“å®ç°
  }
}

// ä½¿ç”¨è€…ä¸éœ€è¦å…³å¿ƒå…·ä½“ç”¨å“ªç§æ”¯ä»˜æ–¹å¼
function processPayment(paymentService, amount) {
  paymentService.pay(amount);  // æ¥å£è°ƒç”¨ï¼Œç®€å•ç»Ÿä¸€
}
```

### 1.5 ä¾èµ–æ³¨å…¥


**ğŸ”¸ ä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥**
```
ä¾èµ–æ³¨å…¥ï¼šä¸è®©æ¨¡å—è‡ªå·±åˆ›å»ºä¾èµ–ï¼Œè€Œæ˜¯ä»å¤–éƒ¨ä¼ å…¥
å°±åƒï¼š
- ä¸è®©å¨å¸ˆè‡ªå·±ä¹°èœï¼ˆå¨å¸ˆä¸“å¿ƒåšèœï¼‰
- ç”±é‡‡è´­å‘˜ä¹°å¥½èœé€ç»™å¨å¸ˆ
- å¨å¸ˆåªç®¡ç”¨èœåšèœ

ä»£ç ä¸­ï¼š
- ä¸è®©æ¨¡å—è‡ªå·±newå¯¹è±¡
- ä»å¤–éƒ¨ä¼ å…¥éœ€è¦çš„å¯¹è±¡
- æ¨¡å—ä¸“å¿ƒå¤„ç†ä¸šåŠ¡é€»è¾‘
```

**ğŸ’» ä»£ç ç¤ºä¾‹**
```javascript
// âŒ æ²¡æœ‰ä¾èµ–æ³¨å…¥ - è‡ªå·±åˆ›å»ºä¾èµ–
class OrderService {
  constructor() {
    this.userService = new UserService();     // è‡ªå·±åˆ›å»º
    this.emailService = new EmailService();   // è€¦åˆåº¦é«˜
  }
  
  createOrder(userId) {
    const user = this.userService.getUser(userId);
    // å¦‚æœè¦æ¢æˆMockUserServiceæµ‹è¯•å°±å¾ˆéº»çƒ¦
  }
}

// âœ… ä½¿ç”¨ä¾èµ–æ³¨å…¥ - å¤–éƒ¨ä¼ å…¥ä¾èµ–
class OrderService {
  constructor(userService, emailService) {
    this.userService = userService;      // å¤–éƒ¨æ³¨å…¥
    this.emailService = emailService;    // çµæ´»å¯æ›¿æ¢
  }
  
  createOrder(userId) {
    const user = this.userService.getUser(userId);
    // æµ‹è¯•æ—¶å¯ä»¥ä¼ å…¥MockUserService
  }
}

// ä½¿ç”¨æ—¶ä»å¤–éƒ¨ç»„è£…
const userService = new UserService();
const emailService = new EmailService();
const orderService = new OrderService(userService, emailService);
```

**ğŸ¯ ä¾èµ–æ³¨å…¥çš„å¥½å¤„**
```
ğŸ“Œ å®¹æ˜“æµ‹è¯•ï¼šå¯ä»¥æ³¨å…¥æµ‹è¯•ç”¨çš„å‡å¯¹è±¡
ğŸ“Œ å®¹æ˜“æ‰©å±•ï¼šå¯ä»¥æ³¨å…¥ä¸åŒçš„å®ç°
ğŸ“Œ é™ä½è€¦åˆï¼šæ¨¡å—ä¸ä¾èµ–å…·ä½“å®ç°
ğŸ“Œ é…ç½®çµæ´»ï¼šå¯ä»¥é€šè¿‡é…ç½®æ”¹å˜è¡Œä¸º
```

---

## 2. ğŸ¨ ç»„ä»¶åŒ–æ€ç»´


> ğŸ’¡ **ç»„ä»¶åŒ–æ€ç»´**ï¼šæŠŠå¯é‡å¤ä½¿ç”¨çš„åŠŸèƒ½åšæˆæ ‡å‡†åŒ–çš„ç»„ä»¶ï¼Œå°±åƒä¹é«˜ç§¯æœ¨ä¸€æ ·å¯ä»¥è‡ªç”±ç»„åˆ

### 2.1 å¯å¤ç”¨ç»„ä»¶


**ğŸ”¸ ä»€ä¹ˆæ˜¯å¯å¤ç”¨ç»„ä»¶**
```
å¯å¤ç”¨ç»„ä»¶ï¼šä¸€æ¬¡å¼€å‘ï¼Œå¤šå¤„ä½¿ç”¨çš„åŠŸèƒ½æ¨¡å—
å°±åƒï¼š
- èºä¸é’‰ï¼šå¯ä»¥ç”¨åœ¨ä¸åŒçš„æœºå™¨ä¸Š
- è½®å­ï¼šå¯ä»¥ç”¨åœ¨ä¸åŒçš„è½¦ä¸Š
- æŒ‰é’®ï¼šå¯ä»¥ç”¨åœ¨ä¸åŒçš„é¡µé¢ä¸Š

ç»„ä»¶ç‰¹ç‚¹ï¼š
- åŠŸèƒ½å®Œæ•´ï¼šè‡ªå·±å°±èƒ½å®Œæˆç‰¹å®šä»»åŠ¡
- æ¥å£æ ‡å‡†ï¼šä½¿ç”¨æ–¹å¼å›ºå®š
- å‚æ•°å¯é…ï¼šé€šè¿‡å‚æ•°è°ƒæ•´è¡Œä¸º
```

**ğŸ’» ä»£ç ç¤ºä¾‹**
```javascript
// âœ… å¯å¤ç”¨çš„æŒ‰é’®ç»„ä»¶
class Button {
  constructor(text, color = 'blue', size = 'medium') {
    this.text = text;
    this.color = color;
    this.size = size;
  }
  
  render() {
    return `<button class="${this.color} ${this.size}">${this.text}</button>`;
  }
  
  onClick(callback) {
    this.clickHandler = callback;
  }
}

// åœ¨ä¸åŒåœ°æ–¹å¤ç”¨
const saveButton = new Button('ä¿å­˜', 'green', 'large');
const cancelButton = new Button('å–æ¶ˆ', 'red', 'small');
const submitButton = new Button('æäº¤', 'blue', 'medium');

// âœ… å¯å¤ç”¨çš„è¡¨å•éªŒè¯ç»„ä»¶
class Validator {
  static isEmail(email) {
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
  }
  
  static isPhoneNumber(phone) {
    return /^1[3-9]\d{9}$/.test(phone);
  }
  
  static isRequired(value) {
    return value !== null && value !== undefined && value !== '';
  }
}

// å¤šä¸ªè¡¨å•éƒ½å¯ä»¥ä½¿ç”¨
const userForm = {
  validate(data) {
    if (!Validator.isRequired(data.name)) return 'å§“åå¿…å¡«';
    if (!Validator.isEmail(data.email)) return 'é‚®ç®±æ ¼å¼é”™è¯¯';
    return null;
  }
};
```

### 2.2 ç»„ä»¶ç»„åˆ


**ğŸ”¸ ä»€ä¹ˆæ˜¯ç»„ä»¶ç»„åˆ**
```
ç»„ä»¶ç»„åˆï¼šç”¨å°ç»„ä»¶æ‹¼è£…æˆå¤§åŠŸèƒ½ï¼Œåƒæ­ç§¯æœ¨
å°±åƒï¼š
- ç”¨èºä¸ã€é½¿è½®ã€å¤–å£³ç»„è£…æˆæ‰‹è¡¨
- ç”¨æŒ‰é’®ã€è¾“å…¥æ¡†ã€æ ‡ç­¾ç»„è£…æˆè¡¨å•
- ç”¨è½®å­ã€å‘åŠ¨æœºã€è½¦èº«ç»„è£…æˆæ±½è½¦

è®¾è®¡åŸåˆ™ï¼š
- å°ç»„ä»¶ä¸“ä¸€ï¼šæ¯ä¸ªç»„ä»¶åŠŸèƒ½å•ä¸€
- å¤§åŠŸèƒ½ç»„åˆï¼šå¤šä¸ªç»„ä»¶ååŒå·¥ä½œ
- å±‚æ¬¡æ¸…æ™°ï¼šç»„ä»¶æœ‰æ˜ç¡®çš„å±‚çº§å…³ç³»
```

**ğŸ’» ä»£ç ç¤ºä¾‹**
```javascript
// åŸºç¡€ç»„ä»¶
class Input {
  constructor(placeholder, type = 'text') {
    this.placeholder = placeholder;
    this.type = type;
  }
  
  render() {
    return `<input type="${this.type}" placeholder="${this.placeholder}">`;
  }
}

class Label {
  constructor(text) {
    this.text = text;
  }
  
  render() {
    return `<label>${this.text}</label>`;
  }
}

class Button {
  constructor(text, type = 'button') {
    this.text = text;
    this.type = type;
  }
  
  render() {
    return `<button type="${this.type}">${this.text}</button>`;
  }
}

// ç»„åˆæˆå¤æ‚çš„ç™»å½•è¡¨å•
class LoginForm {
  constructor() {
    // ç»„åˆåŸºç¡€ç»„ä»¶
    this.usernameLabel = new Label('ç”¨æˆ·å:');
    this.usernameInput = new Input('è¯·è¾“å…¥ç”¨æˆ·å');
    this.passwordLabel = new Label('å¯†ç :');
    this.passwordInput = new Input('è¯·è¾“å…¥å¯†ç ', 'password');
    this.submitButton = new Button('ç™»å½•', 'submit');
    this.cancelButton = new Button('å–æ¶ˆ');
  }
  
  render() {
    return `
      <form>
        ${this.usernameLabel.render()}
        ${this.usernameInput.render()}
        ${this.passwordLabel.render()}
        ${this.passwordInput.render()}
        ${this.submitButton.render()}
        ${this.cancelButton.render()}
      </form>
    `;
  }
}
```

### 2.3 ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ


**ğŸ”¸ ä»€ä¹ˆæ˜¯ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ**
```
ç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼šç»„ä»¶ä»åˆ›å»ºåˆ°é”€æ¯çš„æ•´ä¸ªè¿‡ç¨‹
å°±åƒäººçš„ä¸€ç”Ÿï¼š
- å‡ºç”Ÿï¼ˆåˆ›å»ºï¼‰
- æˆé•¿ï¼ˆåˆå§‹åŒ–ï¼‰
- å·¥ä½œï¼ˆè¿è¡Œï¼‰
- è¡°è€ï¼ˆæ›´æ–°ï¼‰
- æ­»äº¡ï¼ˆé”€æ¯ï¼‰

ç»„ä»¶ä¹Ÿæœ‰ç±»ä¼¼é˜¶æ®µï¼š
- åˆ›å»ºé˜¶æ®µï¼šåˆ†é…å†…å­˜ï¼Œè®¾ç½®åˆå§‹çŠ¶æ€
- æŒ‚è½½é˜¶æ®µï¼šæ·»åŠ åˆ°é¡µé¢ï¼Œç»‘å®šäº‹ä»¶
- æ›´æ–°é˜¶æ®µï¼šæ•°æ®å˜åŒ–ï¼Œé‡æ–°æ¸²æŸ“
- å¸è½½é˜¶æ®µï¼šç§»é™¤äº‹ä»¶ï¼Œæ¸…ç†èµ„æº
```

**ğŸ’» ä»£ç ç¤ºä¾‹**
```javascript
class Component {
  constructor() {
    this.state = {};
    console.log('1. ç»„ä»¶åˆ›å»º');
    this.onCreate();
  }
  
  // ç”Ÿå‘½å‘¨æœŸé’©å­æ–¹æ³•
  onCreate() {
    // ç»„ä»¶åˆ›å»ºæ—¶çš„é€»è¾‘
    console.log('ç»„ä»¶åˆå§‹åŒ–...');
  }
  
  onMount() {
    // ç»„ä»¶æŒ‚è½½åˆ°é¡µé¢æ—¶
    console.log('2. ç»„ä»¶æŒ‚è½½åˆ°é¡µé¢');
    this.bindEvents();
  }
  
  onUpdate(newData) {
    // ç»„ä»¶æ•°æ®æ›´æ–°æ—¶
    console.log('3. ç»„ä»¶æ•°æ®æ›´æ–°');
    this.state = { ...this.state, ...newData };
    this.render();
  }
  
  onDestroy() {
    // ç»„ä»¶é”€æ¯æ—¶
    console.log('4. ç»„ä»¶é”€æ¯');
    this.unbindEvents();
    this.cleanup();
  }
  
  bindEvents() {
    // ç»‘å®šäº‹ä»¶ç›‘å¬
  }
  
  unbindEvents() {
    // è§£ç»‘äº‹ä»¶ç›‘å¬
  }
  
  cleanup() {
    // æ¸…ç†èµ„æºï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
  }
  
  render() {
    // é‡æ–°æ¸²æŸ“ç»„ä»¶
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const myComponent = new Component();  // åˆ›å»º
myComponent.onMount();                // æŒ‚è½½
myComponent.onUpdate({name: 'æ–°æ•°æ®'}); // æ›´æ–°
myComponent.onDestroy();              // é”€æ¯
```

### 2.4 ç»„ä»¶é€šä¿¡


**ğŸ”¸ ä»€ä¹ˆæ˜¯ç»„ä»¶é€šä¿¡**
```
ç»„ä»¶é€šä¿¡ï¼šä¸åŒç»„ä»¶ä¹‹é—´ä¼ é€’ä¿¡æ¯çš„æ–¹å¼
å°±åƒï¼š
- å®¶åº­æˆå‘˜ä¹‹é—´è¯´è¯
- åŒäº‹ä¹‹é—´åä½œ
- æœ‹å‹ä¹‹é—´èŠå¤©

å¸¸è§é€šä¿¡æ–¹å¼ï¼š
- çˆ¶ä¼ å­ï¼šçˆ¶ç»„ä»¶ç»™å­ç»„ä»¶ä¼ æ•°æ®
- å­ä¼ çˆ¶ï¼šå­ç»„ä»¶å‘çˆ¶ç»„ä»¶æŠ¥å‘Š
- å…„å¼Ÿé€šä¿¡ï¼šåŒçº§ç»„ä»¶äº’ç›¸ä¼ é€’ä¿¡æ¯
- å…¨å±€é€šä¿¡ï¼šä»»æ„ç»„ä»¶éƒ½èƒ½æ”¶åˆ°çš„æ¶ˆæ¯
```

**ğŸ’» ä»£ç ç¤ºä¾‹**
```javascript
// 1. çˆ¶ä¼ å­ - é€šè¿‡å‚æ•°ä¼ é€’
class ParentComponent {
  constructor() {
    this.userData = { name: 'å¼ ä¸‰', age: 25 };
  }
  
  render() {
    // æŠŠæ•°æ®ä¼ ç»™å­ç»„ä»¶
    const child = new UserCard(this.userData);
    return child.render();
  }
}

class UserCard {
  constructor(userData) {
    this.userData = userData;  // æ¥æ”¶çˆ¶ç»„ä»¶æ•°æ®
  }
  
  render() {
    return `<div>å§“åï¼š${this.userData.name}ï¼Œå¹´é¾„ï¼š${this.userData.age}</div>`;
  }
}

// 2. å­ä¼ çˆ¶ - é€šè¿‡å›è°ƒå‡½æ•°
class ChildComponent {
  constructor(onDataChange) {
    this.onDataChange = onDataChange;  // æ¥æ”¶çˆ¶ç»„ä»¶å›è°ƒ
  }
  
  handleClick() {
    const newData = 'å­ç»„ä»¶çš„æ•°æ®';
    this.onDataChange(newData);  // è°ƒç”¨çˆ¶ç»„ä»¶æ–¹æ³•
  }
}

class ParentComponent2 {
  constructor() {
    this.child = new ChildComponent((data) => {
      console.log('æ”¶åˆ°å­ç»„ä»¶æ•°æ®ï¼š', data);  // å¤„ç†å­ç»„ä»¶æ•°æ®
    });
  }
}

// 3. å…„å¼Ÿé€šä¿¡ - é€šè¿‡äº‹ä»¶æ€»çº¿
class EventBus {
  constructor() {
    this.events = {};
  }
  
  on(eventName, callback) {
    if (!this.events[eventName]) {
      this.events[eventName] = [];
    }
    this.events[eventName].push(callback);
  }
  
  emit(eventName, data) {
    if (this.events[eventName]) {
      this.events[eventName].forEach(callback => callback(data));
    }
  }
}

const eventBus = new EventBus();

class BrotherA {
  sendMessage() {
    eventBus.emit('message', 'æ¥è‡ªç»„ä»¶Açš„æ¶ˆæ¯');
  }
}

class BrotherB {
  constructor() {
    eventBus.on('message', (data) => {
      console.log('ç»„ä»¶Bæ”¶åˆ°ï¼š', data);
    });
  }
}
```

### 2.5 ç»„ä»¶ç‰ˆæœ¬ç®¡ç†


**ğŸ”¸ ä»€ä¹ˆæ˜¯ç»„ä»¶ç‰ˆæœ¬ç®¡ç†**
```
ç»„ä»¶ç‰ˆæœ¬ç®¡ç†ï¼šç®¡ç†ç»„ä»¶çš„ä¸åŒç‰ˆæœ¬ï¼Œç¡®ä¿å…¼å®¹æ€§
å°±åƒï¼š
- æ‰‹æœºAPPçš„ç‰ˆæœ¬æ›´æ–°
- æ±½è½¦çš„å¹´æ¬¾æ”¹è¿›
- è½¯ä»¶çš„ç‰ˆæœ¬è¿­ä»£

ç‰ˆæœ¬ç®¡ç†è¦ç‚¹ï¼š
- å‘åå…¼å®¹ï¼šæ–°ç‰ˆæœ¬ä¸ç ´åæ—§åŠŸèƒ½
- æ¸è¿›å‡çº§ï¼šå…è®¸åˆ†æ­¥å‡çº§
- æ–‡æ¡£æ¸…æ™°ï¼šè¯´æ˜ç‰ˆæœ¬é—´çš„å·®å¼‚
```

**ğŸ’» ä»£ç ç¤ºä¾‹**
```javascript
// ç‰ˆæœ¬1.0 - åŸºç¡€åŠŸèƒ½
class ButtonV1 {
  constructor(text) {
    this.text = text;
    this.version = '1.0';
  }
  
  render() {
    return `<button>${this.text}</button>`;
  }
}

// ç‰ˆæœ¬2.0 - å¢åŠ æ ·å¼æ”¯æŒï¼Œä¿æŒå‘åå…¼å®¹
class ButtonV2 {
  constructor(text, style = {}) {
    this.text = text;
    this.style = style;
    this.version = '2.0';
  }
  
  render() {
    const styleStr = Object.entries(this.style)
      .map(([key, value]) => `${key}: ${value}`)
      .join('; ');
    
    return `<button style="${styleStr}">${this.text}</button>`;
  }
}

// ç‰ˆæœ¬ç®¡ç†å™¨
class ComponentManager {
  static createButton(text, options = {}) {
    const version = options.version || '2.0';
    
    switch(version) {
      case '1.0':
        return new ButtonV1(text);
      case '2.0':
        return new ButtonV2(text, options.style);
      default:
        return new ButtonV2(text, options.style);  // é»˜è®¤æœ€æ–°ç‰ˆæœ¬
    }
  }
}

// ä½¿ç”¨
const oldButton = ComponentManager.createButton('æŒ‰é’®', { version: '1.0' });
const newButton = ComponentManager.createButton('æŒ‰é’®', { 
  version: '2.0', 
  style: { color: 'red', fontSize: '16px' } 
});
```

---

## 3. ğŸŒ æœåŠ¡åŒ–æ€ç»´


> ğŸ’¡ **æœåŠ¡åŒ–æ€ç»´**ï¼šæŠŠå¤§ç³»ç»Ÿæ‹†åˆ†æˆç‹¬ç«‹çš„æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡å°±åƒä¸€ä¸ªä¸“ä¸šçš„å…¬å¸ï¼Œä¸“é—¨æä¾›æŸç§æœåŠ¡

### 3.1 æœåŠ¡æ‹†åˆ†


**ğŸ”¸ ä»€ä¹ˆæ˜¯æœåŠ¡æ‹†åˆ†**
```
æœåŠ¡æ‹†åˆ†ï¼šæŠŠä¸€ä¸ªå¤§åº”ç”¨åˆ†è§£æˆå¤šä¸ªå°æœåŠ¡
å°±åƒï¼š
- æŠŠå¤§è¶…å¸‚æ‹†åˆ†æˆï¼šç”Ÿé²œåŒºã€æœè£…åŒºã€ç”µå™¨åŒº
- æŠŠå¤§å…¬å¸æ‹†åˆ†æˆï¼šè´¢åŠ¡éƒ¨ã€äººäº‹éƒ¨ã€æŠ€æœ¯éƒ¨
- æ¯ä¸ªéƒ¨é—¨ä¸“ä¸šåŒ–ï¼Œç‹¬ç«‹è¿ä½œ

æ‹†åˆ†åŸåˆ™ï¼š
- æŒ‰ä¸šåŠ¡åˆ’åˆ†ï¼šä¸åŒä¸šåŠ¡ç‹¬ç«‹æˆæœåŠ¡
- æŒ‰æ•°æ®åˆ’åˆ†ï¼šä¸åŒæ•°æ®æ¨¡å‹ç‹¬ç«‹
- æŒ‰å›¢é˜Ÿåˆ’åˆ†ï¼šä¸åŒå›¢é˜Ÿè´Ÿè´£ä¸åŒæœåŠ¡
```

**ğŸ’» ä»£ç ç¤ºä¾‹**
```javascript
// âŒ å•ä½“åº”ç”¨ - æ‰€æœ‰åŠŸèƒ½åœ¨ä¸€èµ·
class MonolithicApp {
  // ç”¨æˆ·ç›¸å…³
  createUser(userData) { /* ... */ }
  loginUser(credentials) { /* ... */ }
  
  // è®¢å•ç›¸å…³  
  createOrder(orderData) { /* ... */ }
  updateOrder(orderId, data) { /* ... */ }
  
  // æ”¯ä»˜ç›¸å…³
  processPayment(paymentData) { /* ... */ }
  refundPayment(orderId) { /* ... */ }
  
  // åº“å­˜ç›¸å…³
  checkStock(productId) { /* ... */ }
  updateStock(productId, quantity) { /* ... */ }
}

// âœ… æœåŠ¡åŒ–æ‹†åˆ† - æŒ‰ä¸šåŠ¡é¢†åŸŸæ‹†åˆ†
class UserService {
  createUser(userData) {
    console.log('åˆ›å»ºç”¨æˆ·æœåŠ¡');
    // åªå¤„ç†ç”¨æˆ·ç›¸å…³é€»è¾‘
  }
  
  authenticateUser(credentials) {
    console.log('ç”¨æˆ·è®¤è¯æœåŠ¡');
    // åªå¤„ç†è®¤è¯ç›¸å…³é€»è¾‘
  }
}

class OrderService {
  createOrder(orderData) {
    console.log('åˆ›å»ºè®¢å•æœåŠ¡');
    // åªå¤„ç†è®¢å•ç›¸å…³é€»è¾‘
  }
  
  updateOrderStatus(orderId, status) {
    console.log('æ›´æ–°è®¢å•çŠ¶æ€');
    // ä¸“æ³¨è®¢å•çŠ¶æ€ç®¡ç†
  }
}

class PaymentService {
  processPayment(paymentData) {
    console.log('å¤„ç†æ”¯ä»˜æœåŠ¡');
    // ä¸“é—¨å¤„ç†æ”¯ä»˜é€»è¾‘
  }
  
  handleRefund(refundData) {
    console.log('å¤„ç†é€€æ¬¾æœåŠ¡');
    // ä¸“é—¨å¤„ç†é€€æ¬¾é€»è¾‘
  }
}

class InventoryService {
  checkStock(productId) {
    console.log('æ£€æŸ¥åº“å­˜æœåŠ¡');
    // ä¸“é—¨ç®¡ç†åº“å­˜
  }
  
  reserveStock(productId, quantity) {
    console.log('é¢„ç•™åº“å­˜');
    // åº“å­˜é¢„ç•™é€»è¾‘
  }
}
```

### 3.2 æœåŠ¡è¾¹ç•Œ


**ğŸ”¸ ä»€ä¹ˆæ˜¯æœåŠ¡è¾¹ç•Œ**
```
æœåŠ¡è¾¹ç•Œï¼šæ˜ç¡®æ¯ä¸ªæœåŠ¡çš„èŒè´£èŒƒå›´
å°±åƒï¼š
- æ´¾å‡ºæ‰€ç®¡æ²»å®‰ï¼Œä¸ç®¡æ¶ˆé˜²
- åŒ»é™¢ç®¡æ²»ç—…ï¼Œä¸ç®¡æ•™è‚²
- é“¶è¡Œç®¡é‡‘èï¼Œä¸ç®¡é¤é¥®

è¾¹ç•Œåˆ’åˆ†åŸåˆ™ï¼š
- èŒè´£å•ä¸€ï¼šæ¯ä¸ªæœåŠ¡æœ‰æ˜ç¡®èŒè´£
- æ•°æ®ç‹¬ç«‹ï¼šæœåŠ¡æœ‰è‡ªå·±çš„æ•°æ®
- ä¸šåŠ¡å®Œæ•´ï¼šæœåŠ¡èƒ½ç‹¬ç«‹å®Œæˆä¸šåŠ¡
```

**ğŸ¯ æœåŠ¡è¾¹ç•Œç¤ºä¾‹å›¾**
```
ç”¨æˆ·æœåŠ¡è¾¹ç•Œï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    UserService      â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ â€¢ ç”¨æˆ·æ³¨å†Œ          â”‚
â”‚ â€¢ ç”¨æˆ·ç™»å½•          â”‚ 
â”‚ â€¢ ç”¨æˆ·ä¿¡æ¯ç®¡ç†      â”‚
â”‚ â€¢ ç”¨æˆ·æƒé™éªŒè¯      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è®¢å•æœåŠ¡è¾¹ç•Œï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   OrderService      â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ â€¢ åˆ›å»ºè®¢å•          â”‚
â”‚ â€¢ è®¢å•çŠ¶æ€ç®¡ç†      â”‚
â”‚ â€¢ è®¢å•æŸ¥è¯¢          â”‚
â”‚ â€¢ è®¢å•å–æ¶ˆ          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ”¯ä»˜æœåŠ¡è¾¹ç•Œï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PaymentService     â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ â€¢ æ”¯ä»˜å¤„ç†          â”‚
â”‚ â€¢ é€€æ¬¾å¤„ç†          â”‚
â”‚ â€¢ æ”¯ä»˜çŠ¶æ€æŸ¥è¯¢      â”‚
â”‚ â€¢ æ”¯ä»˜æ–¹å¼ç®¡ç†      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ’» ä»£ç ç¤ºä¾‹**
```javascript
// æ˜ç¡®çš„æœåŠ¡è¾¹ç•Œå®šä¹‰
class UserServiceBoundary {
  // ç”¨æˆ·æœåŠ¡åªç®¡ç”¨æˆ·ç›¸å…³çš„äº‹æƒ…
  async registerUser(userData) {
    // éªŒè¯ç”¨æˆ·æ•°æ®
    // åˆ›å»ºç”¨æˆ·è´¦å·
    // å‘é€æ¬¢è¿é‚®ä»¶
    return { userId: '123', status: 'created' };
  }
  
  async authenticateUser(credentials) {
    // éªŒè¯ç”¨æˆ·å‡­è¯
    // ç”Ÿæˆè®¿é—®ä»¤ç‰Œ
    return { token: 'abc123', expiresIn: 3600 };
  }
  
  // âŒ ä¸åº”è¯¥åœ¨ç”¨æˆ·æœåŠ¡ä¸­å¤„ç†è®¢å•
  // async createOrder() { ... }  // è¿™å±äºè®¢å•æœåŠ¡
}

class OrderServiceBoundary {
  constructor(userService, inventoryService, paymentService) {
    this.userService = userService;
    this.inventoryService = inventoryService;
    this.paymentService = paymentService;
  }
  
  async createOrder(orderData) {
    // 1. éªŒè¯ç”¨æˆ·ï¼ˆè°ƒç”¨ç”¨æˆ·æœåŠ¡ï¼‰
    const user = await this.userService.getUser(orderData.userId);
    
    // 2. æ£€æŸ¥åº“å­˜ï¼ˆè°ƒç”¨åº“å­˜æœåŠ¡ï¼‰
    const stockOk = await this.inventoryService.checkStock(orderData.items);
    
    if (stockOk) {
      // 3. åˆ›å»ºè®¢å•ï¼ˆè‡ªå·±çš„èŒè´£ï¼‰
      const order = await this.createOrderRecord(orderData);
      
      // 4. å¤„ç†æ”¯ä»˜ï¼ˆè°ƒç”¨æ”¯ä»˜æœåŠ¡ï¼‰
      const paymentResult = await this.paymentService.processPayment({
        orderId: order.id,
        amount: order.total
      });
      
      return { order, paymentResult };
    }
  }
  
  // è¿™æ˜¯è®¢å•æœåŠ¡è‡ªå·±çš„æ ¸å¿ƒèŒè´£
  async createOrderRecord(orderData) {
    return {
      id: 'order123',
      userId: orderData.userId,
      items: orderData.items,
      total: this.calculateTotal(orderData.items),
      status: 'created',
      createdAt: new Date()
    };
  }
}
```

### 3.3 æœåŠ¡æ²»ç†


**ğŸ”¸ ä»€ä¹ˆæ˜¯æœåŠ¡æ²»ç†**
```
æœåŠ¡æ²»ç†ï¼šç®¡ç†ä¼—å¤šæœåŠ¡çš„è¿è¡Œå’Œåè°ƒ
å°±åƒï¼š
- åŸå¸‚ç®¡ç†ï¼šç®¡ç†å„ä¸ªéƒ¨é—¨çš„åè°ƒè¿ä½œ
- äº¤é€šç®¡ç†ï¼šç®¡ç†è½¦è¾†çš„æœ‰åºé€šè¡Œ
- ä¼ä¸šç®¡ç†ï¼šç®¡ç†å„éƒ¨é—¨çš„ååŒå·¥ä½œ

æ²»ç†å†…å®¹ï¼š
- æœåŠ¡æ³¨å†Œï¼šæ–°æœåŠ¡åŠ å…¥æ—¶çš„ç™»è®°
- æœåŠ¡å‘ç°ï¼šæ‰¾åˆ°éœ€è¦çš„æœåŠ¡åœ¨å“ªé‡Œ
- è´Ÿè½½å‡è¡¡ï¼šæŠŠè¯·æ±‚åˆ†å‘ç»™å¤šä¸ªæœåŠ¡å®ä¾‹
- å¥åº·æ£€æŸ¥ï¼šç›‘æ§æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
```

**ğŸ’» ä»£ç ç¤ºä¾‹**
```javascript
// æœåŠ¡æ³¨å†Œä¸­å¿ƒ
class ServiceRegistry {
  constructor() {
    this.services = new Map();  // å­˜å‚¨æœåŠ¡ä¿¡æ¯
  }
  
  // æœåŠ¡æ³¨å†Œ
  register(serviceName, serviceInfo) {
    if (!this.services.has(serviceName)) {
      this.services.set(serviceName, []);
    }
    
    this.services.get(serviceName).push({
      ...serviceInfo,
      registeredAt: new Date(),
      status: 'healthy'
    });
    
    console.log(`æœåŠ¡æ³¨å†ŒæˆåŠŸ: ${serviceName} at ${serviceInfo.address}`);
  }
  
  // æœåŠ¡å‘ç°
  discover(serviceName) {
    const serviceInstances = this.services.get(serviceName) || [];
    const healthyInstances = serviceInstances.filter(s => s.status === 'healthy');
    
    if (healthyInstances.length === 0) {
      throw new Error(`æ²¡æœ‰å¯ç”¨çš„${serviceName}æœåŠ¡å®ä¾‹`);
    }
    
    // ç®€å•çš„è´Ÿè½½å‡è¡¡ - éšæœºé€‰æ‹©
    const randomIndex = Math.floor(Math.random() * healthyInstances.length);
    return healthyInstances[randomIndex];
  }
  
  // å¥åº·æ£€æŸ¥
  async healthCheck() {
    for (const [serviceName, instances] of this.services.entries()) {
      for (const instance of instances) {
        try {
          // æ¨¡æ‹Ÿå¥åº·æ£€æŸ¥è¯·æ±‚
          const isHealthy = await this.pingService(instance.address);
          instance.status = isHealthy ? 'healthy' : 'unhealthy';
        } catch (error) {
          instance.status = 'unhealthy';
          console.log(`æœåŠ¡${serviceName}å®ä¾‹${instance.address}ä¸å¥åº·`);
        }
      }
    }
  }
  
  async pingService(address) {
    // æ¨¡æ‹Ÿå¥åº·æ£€æŸ¥
    return Math.random() > 0.1;  // 90%æ¦‚ç‡å¥åº·
  }
}

// ä½¿ç”¨æœåŠ¡æ²»ç†
const registry = new ServiceRegistry();

// æ³¨å†ŒæœåŠ¡
registry.register('user-service', {
  address: 'http://localhost:3001',
  port: 3001,
  version: '1.0'
});

registry.register('order-service', {
  address: 'http://localhost:3002', 
  port: 3002,
  version: '1.0'
});

// æœåŠ¡å‘ç°å’Œè°ƒç”¨
class ServiceClient {
  constructor(registry) {
    this.registry = registry;
  }
  
  async callUserService(method, params) {
    const serviceInstance = this.registry.discover('user-service');
    console.log(`è°ƒç”¨ç”¨æˆ·æœåŠ¡: ${serviceInstance.address}/${method}`);
    // å®é™…çš„æœåŠ¡è°ƒç”¨é€»è¾‘
  }
  
  async callOrderService(method, params) {
    const serviceInstance = this.registry.discover('order-service');
    console.log(`è°ƒç”¨è®¢å•æœåŠ¡: ${serviceInstance.address}/${method}`);
    // å®é™…çš„æœåŠ¡è°ƒç”¨é€»è¾‘
  }
}
```

### 3.4 æœåŠ¡ç¼–æ’


**ğŸ”¸ ä»€ä¹ˆæ˜¯æœåŠ¡ç¼–æ’**
```
æœåŠ¡ç¼–æ’ï¼šåè°ƒå¤šä¸ªæœåŠ¡å®Œæˆå¤æ‚çš„ä¸šåŠ¡æµç¨‹
å°±åƒï¼š
- æŒ‡æŒ¥äº¤å“ä¹å›¢ï¼šåè°ƒå„ä¸ªä¹å™¨æ¼”å¥
- ç»„ç»‡æ´»åŠ¨ï¼šåè°ƒå„ä¸ªç¯èŠ‚çš„æ‰§è¡Œ
- å·¥å‚ç”Ÿäº§ï¼šåè°ƒå„é“å·¥åºçš„é…åˆ

ç¼–æ’ç±»å‹ï¼š
- é¡ºåºç¼–æ’ï¼šæŒ‰é¡ºåºæ‰§è¡ŒæœåŠ¡
- å¹¶è¡Œç¼–æ’ï¼šåŒæ—¶æ‰§è¡Œå¤šä¸ªæœåŠ¡
- æ¡ä»¶ç¼–æ’ï¼šæ ¹æ®æ¡ä»¶é€‰æ‹©æœåŠ¡
- å¾ªç¯ç¼–æ’ï¼šé‡å¤æ‰§è¡ŒæŸäº›æœåŠ¡
```

**ğŸ’» ä»£ç ç¤ºä¾‹**
```javascript
// æœåŠ¡ç¼–æ’å™¨
class ServiceOrchestrator {
  constructor(serviceClient) {
    this.serviceClient = serviceClient;
  }
  
  // ä¸‹å•æµç¨‹ç¼–æ’
  async executeOrderWorkflow(orderData) {
    try {
      console.log('å¼€å§‹ä¸‹å•æµç¨‹ç¼–æ’...');
      
      // æ­¥éª¤1ï¼šéªŒè¯ç”¨æˆ·
      console.log('æ­¥éª¤1ï¼šéªŒè¯ç”¨æˆ·');
      const user = await this.serviceClient.callUserService('validate', {
        userId: orderData.userId
      });
      
      if (!user.isValid) {
        throw new Error('ç”¨æˆ·éªŒè¯å¤±è´¥');
      }
      
      // æ­¥éª¤2ï¼šæ£€æŸ¥åº“å­˜
      console.log('æ­¥éª¤2ï¼šæ£€æŸ¥åº“å­˜');
      const stockCheck = await this.serviceClient.callInventoryService('check', {
        items: orderData.items
      });
      
      if (!stockCheck.available) {
        throw new Error('åº“å­˜ä¸è¶³');
      }
      
      // æ­¥éª¤3ï¼šåˆ›å»ºè®¢å•
      console.log('æ­¥éª¤3ï¼šåˆ›å»ºè®¢å•');
      const order = await this.serviceClient.callOrderService('create', orderData);
      
      // æ­¥éª¤4ï¼šå¤„ç†æ”¯ä»˜
      console.log('æ­¥éª¤4ï¼šå¤„ç†æ”¯ä»˜');
      const payment = await this.serviceClient.callPaymentService('process', {
        orderId: order.id,
        amount: order.total,
        userId: orderData.userId
      });
      
      if (payment.success) {
        // æ­¥éª¤5ï¼šæ›´æ–°åº“å­˜
        console.log('æ­¥éª¤5ï¼šæ›´æ–°åº“å­˜');
        await this.serviceClient.callInventoryService('reserve', {
          items: orderData.items,
          orderId: order.id
        });
        
        // æ­¥éª¤6ï¼šå‘é€é€šçŸ¥
        console.log('æ­¥éª¤6ï¼šå‘é€é€šçŸ¥');
        await this.serviceClient.callNotificationService('send', {
          userId: orderData.userId,
          type: 'order_success',
          orderId: order.id
        });
        
        return {
          success: true,
          orderId: order.id,
          message: 'ä¸‹å•æˆåŠŸ'
        };
      } else {
        // æ”¯ä»˜å¤±è´¥ï¼Œå–æ¶ˆè®¢å•
        await this.serviceClient.callOrderService('cancel', { orderId: order.id });
        throw new Error('æ”¯ä»˜å¤±è´¥');
      }
      
    } catch (error) {
      console.log('ä¸‹å•æµç¨‹å¤±è´¥ï¼Œæ‰§è¡Œå›æ»š...');
      await this.rollbackOrder(orderData);
      throw error;
    }
  }
  
  // å›æ»šé€»è¾‘
  async rollbackOrder(orderData) {
    try {
      // é‡Šæ”¾åº“å­˜
      await this.serviceClient.callInventoryService('release', {
        items: orderData.items
      });
      
      // å‘é€å¤±è´¥é€šçŸ¥
      await this.serviceClient.callNotificationService('send', {
        userId: orderData.userId,
        type: 'order_failed'
      });
      
    } catch (rollbackError) {
      console.error('å›æ»šå¤±è´¥:', rollbackError);
    }
  }
}

// ä½¿ç”¨ç¼–æ’å™¨
const orchestrator = new ServiceOrchestrator(serviceClient);

async function processOrder(orderData) {
  try {
    const result = await orchestrator.executeOrderWorkflow(orderData);
    console.log('è®¢å•å¤„ç†æˆåŠŸ:', result);
  } catch (error) {
    console.error('è®¢å•å¤„ç†å¤±è´¥:', error.message);
  }
}
```

### 3.5 æœåŠ¡ç½‘æ ¼


**ğŸ”¸ ä»€ä¹ˆæ˜¯æœåŠ¡ç½‘æ ¼**
```
æœåŠ¡ç½‘æ ¼ï¼šä¸ºæœåŠ¡é—´é€šä¿¡æä¾›åŸºç¡€è®¾æ–½æ”¯æŒ
å°±åƒï¼š
- åŸå¸‚é“è·¯ç½‘ï¼šä¸ºè½¦è¾†é€šè¡Œæä¾›åŸºç¡€è®¾æ–½
- ç”µè¯ç½‘ç»œï¼šä¸ºé€šè¯æä¾›ä¼ è¾“åŸºç¡€
- å¿«é€’ç½‘ç»œï¼šä¸ºåŒ…è£¹æŠ•é€’æä¾›æ”¯æ’‘

ç½‘æ ¼åŠŸèƒ½ï¼š
- é€šä¿¡ç®¡ç†ï¼šç®¡ç†æœåŠ¡é—´çš„ç½‘ç»œé€šä¿¡
- å®‰å…¨æ§åˆ¶ï¼šæä¾›è®¤è¯å’ŒåŠ å¯†
- æµé‡æ§åˆ¶ï¼šé™æµã€é‡è¯•ã€ç†”æ–­
- ç›‘æ§è§‚æµ‹ï¼šæ”¶é›†é€šä¿¡æ•°æ®å’ŒæŒ‡æ ‡
```

**ğŸ’» ä»£ç ç¤ºä¾‹**
```javascript
// æœåŠ¡ç½‘æ ¼ä»£ç†
class ServiceMeshProxy {
  constructor(serviceName) {
    this.serviceName = serviceName;
    this.retryConfig = { maxRetries: 3, delay: 1000 };
    this.circuitBreaker = { threshold: 5, timeout: 60000 };
    this.metrics = { requests: 0, errors: 0, responseTime: [] };
  }
  
  // å¸¦é‡è¯•çš„æœåŠ¡è°ƒç”¨
  async callWithRetry(targetService, method, data) {
    let lastError;
    
    for (let attempt = 0; attempt <= this.retryConfig.maxRetries; attempt++) {
      try {
        const startTime = Date.now();
        
        // æ£€æŸ¥ç†”æ–­å™¨çŠ¶æ€
        if (this.isCircuitOpen(targetService)) {
          throw new Error(`ç†”æ–­å™¨æ‰“å¼€ï¼Œæ‹’ç»è°ƒç”¨${targetService}`);
        }
        
        // æ‰§è¡Œå®é™…è°ƒç”¨
        const result = await this.makeRequest(targetService, method, data);
        
        // è®°å½•æˆåŠŸæŒ‡æ ‡
        this.recordSuccess(Date.now() - startTime);
        
        return result;
        
      } catch (error) {
        lastError = error;
        this.recordError(targetService);
        
        if (attempt < this.retryConfig.maxRetries) {
          console.log(`è°ƒç”¨å¤±è´¥ï¼Œ${this.retryConfig.delay}msåé‡è¯• (${attempt + 1}/${this.retryConfig.maxRetries})`);
          await this.delay(this.retryConfig.delay);
        }
      }
    }
    
    throw new Error(`è°ƒç”¨${targetService}æœåŠ¡å¤±è´¥ï¼Œå·²é‡è¯•${this.retryConfig.maxRetries}æ¬¡: ${lastError.message}`);
  }
  
  // æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚
  async makeRequest(targetService, method, data) {
    // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
    await this.delay(Math.random() * 100);
    
    // æ¨¡æ‹Ÿå¤±è´¥ç‡
    if (Math.random() < 0.1) {  // 10%å¤±è´¥ç‡
      throw new Error('ç½‘ç»œé”™è¯¯');
    }
    
    return {
      service: targetService,
      method: method,
      data: data,
      timestamp: new Date(),
      requestId: Math.random().toString(36).substr(2, 9)
    };
  }
  
  // ç†”æ–­å™¨é€»è¾‘
  isCircuitOpen(serviceName) {
    const errorRate = this.calculateErrorRate(serviceName);
    return errorRate > this.circuitBreaker.threshold;
  }
  
  calculateErrorRate(serviceName) {
    const totalRequests = this.metrics.requests;
    const errorCount = this.metrics.errors;
    
    if (totalRequests === 0) return 0;
    return (errorCount / totalRequests) * 100;
  }
  
  // è®°å½•æŒ‡æ ‡
  recordSuccess(responseTime) {
    this.metrics.requests++;
    this.metrics.responseTime.push(responseTime);
  }
  
  recordError(serviceName) {
    this.metrics.requests++;
    this.metrics.errors++;
  }
  
  // è·å–æœåŠ¡å¥åº·çŠ¶æ€
  getHealthStatus() {
    const avgResponseTime = this.metrics.responseTime.length > 0 
      ? this.metrics.responseTime.reduce((a, b) => a + b) / this.metrics.responseTime.length 
      : 0;
      
    const errorRate = this.calculateErrorRate();
    
    return {
      serviceName: this.serviceName,
      totalRequests: this.metrics.requests,
      errorCount: this.metrics.errors,
      errorRate: errorRate,
      avgResponseTime: avgResponseTime,
      status: errorRate < 5 ? 'healthy' : 'unhealthy'
    };
  }
  
  async delay(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }
}

// ä½¿ç”¨æœåŠ¡ç½‘æ ¼
class OrderServiceWithMesh {
  constructor() {
    this.proxy = new ServiceMeshProxy('order-service');
  }
  
  async createOrder(orderData) {
    try {
      // é€šè¿‡æœåŠ¡ç½‘æ ¼è°ƒç”¨å…¶ä»–æœåŠ¡
      const user = await this.proxy.callWithRetry('user-service', 'getUser', {
        userId: orderData.userId
      });
      
      const inventory = await this.proxy.callWithRetry('inventory-service', 'checkStock', {
        items: orderData.items
      });
      
      const payment = await this.proxy.callWithRetry('payment-service', 'processPayment', {
        amount: orderData.total,
        userId: orderData.userId
      });
      
      return {
        orderId: 'order123',
        status: 'created',
        user: user,
        inventory: inventory,
        payment: payment
      };
      
    } catch (error) {
      console.error('åˆ›å»ºè®¢å•å¤±è´¥:', error.message);
      throw error;
    }
  }
  
  getServiceMetrics() {
    return this.proxy.getHealthStatus();
  }
}

// ç›‘æ§æœåŠ¡å¥åº·çŠ¶æ€
class ServiceMonitor {
  constructor() {
    this.services = [];
  }
  
  addService(service) {
    this.services.push(service);
  }
  
  generateHealthReport() {
    console.log('=== æœåŠ¡å¥åº·æŠ¥å‘Š ===');
    this.services.forEach(service => {
      const health = service.getServiceMetrics();
      console.log(`${health.serviceName}: ${health.status} (é”™è¯¯ç‡: ${health.errorRate.toFixed(2)}%)`);
    });
  }
}
```

---

## 4. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 4.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ”¸ æ¨¡å—è®¾è®¡æ€ç»´**
```
â€¢ å•ä¸€èŒè´£ï¼šä¸€ä¸ªæ¨¡å—åªåšä¸€ä»¶äº‹ï¼Œä¸“ä¸šåˆ†å·¥
â€¢ é«˜å†…èšï¼šæ¨¡å—å†…éƒ¨åŠŸèƒ½ç´§å¯†ç›¸å…³ï¼Œå›¢é˜Ÿåä½œ
â€¢ ä½è€¦åˆï¼šæ¨¡å—é—´ä¾èµ–å°½é‡å°‘ï¼Œç‹¬ç«‹è‡ªä¸»
â€¢ æ¥å£è®¾è®¡ï¼šæ¨¡å—å¯¹å¤–çš„æ ‡å‡†åŒ–æœåŠ¡çª—å£
â€¢ ä¾èµ–æ³¨å…¥ï¼šä»å¤–éƒ¨æä¾›ä¾èµ–ï¼Œæé«˜çµæ´»æ€§
```

**ğŸ”¸ ç»„ä»¶åŒ–æ€ç»´**
```
â€¢ å¯å¤ç”¨ç»„ä»¶ï¼šä¸€æ¬¡å¼€å‘å¤šå¤„ä½¿ç”¨çš„æ ‡å‡†ç»„ä»¶
â€¢ ç»„ä»¶ç»„åˆï¼šå°ç»„ä»¶æ‹¼è£…å¤§åŠŸèƒ½ï¼Œç§¯æœ¨æ€ç»´
â€¢ ç”Ÿå‘½å‘¨æœŸï¼šç»„ä»¶ä»åˆ›å»ºåˆ°é”€æ¯çš„å®Œæ•´è¿‡ç¨‹
â€¢ ç»„ä»¶é€šä¿¡ï¼šä¸åŒç»„ä»¶é—´ä¼ é€’ä¿¡æ¯çš„æ ‡å‡†æ–¹å¼
â€¢ ç‰ˆæœ¬ç®¡ç†ï¼šç»„ä»¶ç‰ˆæœ¬è¿­ä»£çš„å‘åå…¼å®¹ç­–ç•¥
```

**ğŸ”¸ æœåŠ¡åŒ–æ€ç»´**
```
â€¢ æœåŠ¡æ‹†åˆ†ï¼šæŒ‰ä¸šåŠ¡é¢†åŸŸæ‹†åˆ†å¤§åº”ç”¨ä¸ºå°æœåŠ¡
â€¢ æœåŠ¡è¾¹ç•Œï¼šæ˜ç¡®æ¯ä¸ªæœåŠ¡çš„èŒè´£å’Œæ•°æ®èŒƒå›´
â€¢ æœåŠ¡æ²»ç†ï¼šç®¡ç†ä¼—å¤šæœåŠ¡çš„æ³¨å†Œå‘ç°å’Œå¥åº·ç›‘æ§
â€¢ æœåŠ¡ç¼–æ’ï¼šåè°ƒå¤šä¸ªæœåŠ¡å®Œæˆå¤æ‚ä¸šåŠ¡æµç¨‹
â€¢ æœåŠ¡ç½‘æ ¼ï¼šä¸ºæœåŠ¡é—´é€šä¿¡æä¾›åŸºç¡€è®¾æ–½æ”¯æŒ
```

### 4.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æ¶æ„è®¾è®¡çš„æœ¬è´¨**
```
å¤æ‚æ€§ç®¡ç†ï¼š
- æŠŠå¤æ‚é—®é¢˜åˆ†è§£æˆç®€å•é—®é¢˜
- æŠŠå¤§ç³»ç»Ÿæ‹†åˆ†æˆå°æ¨¡å—
- æŠŠç´§è€¦åˆå˜æˆæ¾è€¦åˆ

å¯ç»´æŠ¤æ€§æå‡ï¼š
- æ¨¡å—èŒè´£æ¸…æ™°ï¼Œå®¹æ˜“ç†è§£å’Œä¿®æ”¹
- ç»„ä»¶å¯å¤ç”¨ï¼Œå‡å°‘é‡å¤å¼€å‘
- æœåŠ¡ç‹¬ç«‹ï¼Œæ•…éšœéš”ç¦»å’Œå¿«é€Ÿæ¢å¤
```

**ğŸ”¹ è®¾è®¡æ€ç»´çš„è¿›åŒ–**
```
å•ä½“æ€ç»´ â†’ æ¨¡å—åŒ–æ€ç»´ï¼š
æŠŠæ‰€æœ‰åŠŸèƒ½æ”¾ä¸€èµ· â†’ æŒ‰åŠŸèƒ½æ‹†åˆ†æ¨¡å—

æ¨¡å—åŒ–æ€ç»´ â†’ ç»„ä»¶åŒ–æ€ç»´ï¼š
é™æ€çš„æ¨¡å—åˆ’åˆ† â†’ åŠ¨æ€çš„ç»„ä»¶ç»„åˆ

ç»„ä»¶åŒ–æ€ç»´ â†’ æœåŠ¡åŒ–æ€ç»´ï¼š
è¿›ç¨‹å†…çš„ç»„ä»¶ â†’ è·¨è¿›ç¨‹çš„æœåŠ¡
```

**ğŸ”¹ æ¶æ„é€‰æ‹©çš„æƒè¡¡**
```
ç®€å• vs çµæ´»ï¼š
- ç®€å•æ¶æ„æ˜“äºç†è§£ï¼Œä½†æ‰©å±•æ€§å·®
- å¤æ‚æ¶æ„çµæ´»æ€§å¼ºï¼Œä½†å­¦ä¹ æˆæœ¬é«˜

æ€§èƒ½ vs å¯ç»´æŠ¤æ€§ï¼š
- é«˜æ€§èƒ½å¯èƒ½è¦ç‰ºç‰²ä¸€äº›æ¨¡å—åŒ–
- é«˜å¯ç»´æŠ¤æ€§å¯èƒ½è¦æ¥å—ä¸€äº›æ€§èƒ½æŸå¤±

ä¸€è‡´æ€§ vs å¯ç”¨æ€§ï¼š
- å¼ºä¸€è‡´æ€§å¯èƒ½å½±å“ç³»ç»Ÿå¯ç”¨æ€§
- é«˜å¯ç”¨æ€§å¯èƒ½è¦æ¥å—æœ€ç»ˆä¸€è‡´æ€§
```

### 4.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ’¼ å·¥ç¨‹å®è·µ**
- **é¡¹ç›®æ¶æ„**ï¼šæ ¹æ®é¡¹ç›®è§„æ¨¡é€‰æ‹©åˆé€‚çš„æ¶æ„æ¨¡å¼
- **ä»£ç ç»„ç»‡**ï¼šæŒ‰ç…§æ¨¡å—åŒ–åŸåˆ™ç»„ç»‡ä»£ç ç»“æ„
- **ç³»ç»Ÿè®¾è®¡**ï¼šè¿ç”¨ç»„ä»¶åŒ–å’ŒæœåŠ¡åŒ–æ€ç»´è®¾è®¡ç³»ç»Ÿ
- **æŠ€æœ¯é€‰å‹**ï¼šåŸºäºæ¶æ„éœ€æ±‚é€‰æ‹©åˆé€‚çš„æŠ€æœ¯æ ˆ

**ğŸ¯ è§£å†³é—®é¢˜**
- **å¤æ‚åº¦ç®¡ç†**ï¼šé€šè¿‡åˆ†å±‚åˆ†æ¨¡å—é™ä½ç³»ç»Ÿå¤æ‚åº¦
- **å›¢é˜Ÿåä½œ**ï¼šæ¸…æ™°çš„æ¨¡å—è¾¹ç•Œä¾¿äºå›¢é˜Ÿåˆ†å·¥åä½œ
- **ç³»ç»Ÿæ‰©å±•**ï¼šè‰¯å¥½çš„æ¶æ„è®¾è®¡æ”¯æŒç³»ç»Ÿå¹³æ»‘æ‰©å±•
- **æ•…éšœéš”ç¦»**ï¼šæ¨¡å—åŒ–è®¾è®¡æœ‰åŠ©äºå¿«é€Ÿå®šä½å’Œè§£å†³é—®é¢˜

**ğŸš€ æå‡æ•ˆç‡**
- **å¼€å‘æ•ˆç‡**ï¼šç»„ä»¶å¤ç”¨å‡å°‘é‡å¤å¼€å‘å·¥ä½œ
- **ç»´æŠ¤æ•ˆç‡**ï¼šæ¸…æ™°çš„æ¨¡å—èŒè´£ä¾¿äºé—®é¢˜å®šä½å’Œä¿®å¤
- **æµ‹è¯•æ•ˆç‡**ï¼šç‹¬ç«‹çš„æ¨¡å—ä¾¿äºå•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- **éƒ¨ç½²æ•ˆç‡**ï¼šæœåŠ¡åŒ–æ¶æ„æ”¯æŒç‹¬ç«‹éƒ¨ç½²å’Œç°åº¦å‘å¸ƒ

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
ğŸ¯ æ¨¡å—åŒ–ï¼šå•ä¸€èŒè´£é«˜å†…èšï¼Œä½è€¦åˆæ¥å£æ¸…æ™°åŒ–
ğŸ¨ ç»„ä»¶åŒ–ï¼šç§¯æœ¨æ€ç»´å¯å¤ç”¨ï¼Œç”Ÿå‘½å‘¨æœŸé€šä¿¡ç®¡ç†
ğŸŒ æœåŠ¡åŒ–ï¼šæ‹†åˆ†è¾¹ç•Œè¦æ²»ç†ï¼Œç¼–æ’ç½‘æ ¼åŸºç¡€è®¾æ–½
ğŸ—ï¸ æ¶æ„åŒ–ï¼šå¤æ‚ç®€å•å¯ç»´æŠ¤ï¼Œæƒè¡¡é€‰æ‹©é‡å®è·µ
```