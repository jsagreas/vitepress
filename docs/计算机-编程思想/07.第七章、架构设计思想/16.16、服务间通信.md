---
title: 16ã€æœåŠ¡é—´é€šä¿¡
---
## ğŸ“š ç›®å½•

1. [æœåŠ¡é—´é€šä¿¡æ¦‚è¿°](#1-æœåŠ¡é—´é€šä¿¡æ¦‚è¿°)
2. [åŒæ­¥vså¼‚æ­¥é€šä¿¡](#2-åŒæ­¥vså¼‚æ­¥é€šä¿¡)
3. [æœåŠ¡å‘ç°æœºåˆ¶](#3-æœåŠ¡å‘ç°æœºåˆ¶)
4. [è´Ÿè½½å‡è¡¡ç­–ç•¥](#4-è´Ÿè½½å‡è¡¡ç­–ç•¥)
5. [é€šä¿¡åè®®é€‰æ‹©](#5-é€šä¿¡åè®®é€‰æ‹©)
6. [å¼‚æ­¥åŒ–ä¸æ¶ˆæ¯é©±åŠ¨](#6-å¼‚æ­¥åŒ–ä¸æ¶ˆæ¯é©±åŠ¨)
7. [ä»»åŠ¡æ‹†åˆ†ä¸è°ƒåº¦](#7-ä»»åŠ¡æ‹†åˆ†ä¸è°ƒåº¦)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ æœåŠ¡é—´é€šä¿¡æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯æœåŠ¡é—´é€šä¿¡


**ğŸ“‹ åŸºæœ¬å®šä¹‰**
```
æœåŠ¡é—´é€šä¿¡ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¸åŒæœåŠ¡ä¹‹é—´è¿›è¡Œæ•°æ®äº¤æ¢å’Œåä½œçš„è¿‡ç¨‹

ç®€å•ç†è§£ï¼š
å°±åƒä¸åŒéƒ¨é—¨ä¹‹é—´éœ€è¦å¼€ä¼šæ²Ÿé€šä¸€æ ·
æ¯ä¸ªæœåŠ¡éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„"éƒ¨é—¨"
ä»–ä»¬éœ€è¦é€šè¿‡æŸç§æ–¹å¼æ¥äº¤æµå’Œåä½œ
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡é—´é€šä¿¡


**ğŸ”¸ å¾®æœåŠ¡æ¶æ„çš„å¿…ç„¶éœ€æ±‚**
```
å•ä½“åº”ç”¨ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·æ¨¡å— â† ç›´æ¥è°ƒç”¨ â”‚
â”‚  è®¢å•æ¨¡å— â† ç›´æ¥è°ƒç”¨ â”‚  
â”‚  æ”¯ä»˜æ¨¡å— â† ç›´æ¥è°ƒç”¨ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¾®æœåŠ¡æ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    ç½‘ç»œé€šä¿¡    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ç”¨æˆ·æœåŠ¡ â”‚ â†----------â†’ â”‚è®¢å•æœåŠ¡ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†•                      â†•
   ç½‘ç»œé€šä¿¡                ç½‘ç»œé€šä¿¡
     â†•                      â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚æ”¯ä»˜æœåŠ¡ â”‚ â†----------â†’ â”‚åº“å­˜æœåŠ¡ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ’¡ æ ¸å¿ƒæŒ‘æˆ˜**
- **ç½‘ç»œå»¶è¿Ÿ**ï¼šä¸å†æ˜¯å†…å­˜è°ƒç”¨ï¼Œéœ€è¦é€šè¿‡ç½‘ç»œ
- **æ•…éšœå¤„ç†**ï¼šç½‘ç»œå¯èƒ½æ–­å¼€ï¼ŒæœåŠ¡å¯èƒ½å®•æœº
- **æ•°æ®ä¸€è‡´æ€§**ï¼šå¤šä¸ªæœåŠ¡çš„æ•°æ®éœ€è¦ä¿æŒåŒæ­¥
- **æœåŠ¡å‘ç°**ï¼šæ€ä¹ˆæ‰¾åˆ°å…¶ä»–æœåŠ¡åœ¨å“ªé‡Œ

---

## 2. âš¡ åŒæ­¥vså¼‚æ­¥é€šä¿¡


### 2.1 åŒæ­¥é€šä¿¡


**ğŸ”¸ ä»€ä¹ˆæ˜¯åŒæ­¥é€šä¿¡**
```
åŒæ­¥é€šä¿¡ï¼šå‘é€è¯·æ±‚åï¼Œå¿…é¡»ç­‰å¾…å“åº”æ‰èƒ½ç»§ç»­æ‰§è¡Œ

å°±åƒæ‰“ç”µè¯ï¼š
ä½ ï¼šå–‚ï¼Œè¯·é—®ä»Šå¤©æœ‰ç©ºå—ï¼Ÿ
å¯¹æ–¹ï¼šç­‰æˆ‘æŸ¥ä¸€ä¸‹...ï¼ˆä½ åœ¨è¿™é‡Œç­‰å¾…ï¼‰
å¯¹æ–¹ï¼šæœ‰ç©ºï¼Œä¸‹åˆ3ç‚¹å¯ä»¥
ä½ ï¼šå¥½çš„ï¼ˆæ”¶åˆ°å›å¤åæ‰èƒ½æŒ‚ç”µè¯ï¼‰
```

**ğŸ“Š åŒæ­¥é€šä¿¡çš„ç‰¹ç‚¹**
```java
// åŒæ­¥è°ƒç”¨ç¤ºä¾‹ - è®¢å•æœåŠ¡è°ƒç”¨åº“å­˜æœåŠ¡
public class OrderService {
    
    public String createOrder(OrderRequest request) {
        // 1. åŒæ­¥è°ƒç”¨åº“å­˜æœåŠ¡æ£€æŸ¥åº“å­˜
        boolean hasStock = inventoryService.checkStock(request.getProductId());
        
        if (!hasStock) {
            return "åº“å­˜ä¸è¶³";
        }
        
        // 2. åŒæ­¥è°ƒç”¨æ”¯ä»˜æœåŠ¡
        boolean paymentSuccess = paymentService.processPayment(request.getAmount());
        
        if (!paymentSuccess) {
            return "æ”¯ä»˜å¤±è´¥";
        }
        
        // 3. åˆ›å»ºè®¢å•
        return "è®¢å•åˆ›å»ºæˆåŠŸ";
    }
}
```

**âœ… åŒæ­¥é€šä¿¡çš„ä¼˜åŠ¿**
- **ç®€å•ç›´è§‚**ï¼šå°±åƒæ™®é€šçš„å‡½æ•°è°ƒç”¨
- **ç«‹å³è·å¾—ç»“æœ**ï¼šé©¬ä¸ŠçŸ¥é“æˆåŠŸè¿˜æ˜¯å¤±è´¥
- **æ•°æ®ä¸€è‡´æ€§å¼º**ï¼šæ“ä½œè¦ä¹ˆå…¨æˆåŠŸï¼Œè¦ä¹ˆå…¨å¤±è´¥

**âŒ åŒæ­¥é€šä¿¡çš„é—®é¢˜**
- **æ€§èƒ½ç“¶é¢ˆ**ï¼šä¸€ä¸ªæœåŠ¡æ…¢ï¼Œæ•´ä¸ªé“¾è·¯éƒ½æ…¢
- **çº§è”æ•…éšœ**ï¼šä¸€ä¸ªæœåŠ¡æŒ‚äº†ï¼Œè°ƒç”¨å®ƒçš„æœåŠ¡ä¹Ÿä¼šå—å½±å“
- **èµ„æºæµªè´¹**ï¼šè°ƒç”¨æ–¹éœ€è¦ä¸€ç›´ç­‰å¾…

### 2.2 å¼‚æ­¥é€šä¿¡


**ğŸ”¸ ä»€ä¹ˆæ˜¯å¼‚æ­¥é€šä¿¡**
```
å¼‚æ­¥é€šä¿¡ï¼šå‘é€è¯·æ±‚åï¼Œä¸ç­‰å¾…å“åº”ï¼Œç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡

å°±åƒå‘çŸ­ä¿¡ï¼š
ä½ ï¼šå‘çŸ­ä¿¡"ä»Šå¤©æœ‰ç©ºå—ï¼Ÿ"
ä½ ï¼šç»§ç»­åšå…¶ä»–äº‹æƒ…ï¼ˆä¸ç”¨ç­‰å›å¤ï¼‰
å¯¹æ–¹ï¼šè¿‡ä¸€ä¼šå„¿å›å¤"æœ‰ç©º"
ä½ ï¼šçœ‹åˆ°å›å¤åå†å†³å®šä¸‹ä¸€æ­¥
```

**ğŸ“Š å¼‚æ­¥é€šä¿¡çš„å®ç°æ–¹å¼**

| æ–¹å¼ | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| **æ¶ˆæ¯é˜Ÿåˆ—** | é€šè¿‡ä¸­é—´ä»¶ä¼ é€’æ¶ˆæ¯ | è®¢å•å¤„ç†ã€æ•°æ®åŒæ­¥ |
| **äº‹ä»¶å‘å¸ƒè®¢é˜…** | äº‹ä»¶é©±åŠ¨çš„é€šä¿¡æ–¹å¼ | çŠ¶æ€å˜æ›´é€šçŸ¥ |
| **å›è°ƒæœºåˆ¶** | ç»“æœé€šè¿‡å›è°ƒå‡½æ•°è¿”å› | APIå¼‚æ­¥å¤„ç† |

**ğŸ’» å¼‚æ­¥é€šä¿¡ç¤ºä¾‹**
```java
// å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—æ–¹å¼
public class OrderService {
    
    public String createOrder(OrderRequest request) {
        // 1. å…ˆåˆ›å»ºè®¢å•ï¼ˆçŠ¶æ€ï¼šå¾…å¤„ç†ï¼‰
        Order order = new Order(request);
        order.setStatus("PENDING");
        orderRepository.save(order);
        
        // 2. å‘é€æ¶ˆæ¯åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¼‚æ­¥å¤„ç†
        OrderMessage message = new OrderMessage(order.getId(), request);
        messageQueue.send("order-processing", message);
        
        // 3. ç«‹å³è¿”å›ï¼Œä¸ç­‰å¾…å¤„ç†ç»“æœ
        return "è®¢å•å·²æäº¤ï¼Œæ­£åœ¨å¤„ç†ä¸­";
    }
}

// å¼‚æ­¥å¤„ç†å™¨
@Component
public class OrderProcessor {
    
    @EventListener("order-processing")
    public void processOrder(OrderMessage message) {
        // å¼‚æ­¥æ£€æŸ¥åº“å­˜
        checkInventoryAsync(message);
        // å¼‚æ­¥å¤„ç†æ”¯ä»˜
        processPaymentAsync(message);
    }
}
```

**âœ… å¼‚æ­¥é€šä¿¡çš„ä¼˜åŠ¿**
- **é«˜æ€§èƒ½**ï¼šä¸ç”¨ç­‰å¾…ï¼Œå“åº”å¿«
- **é«˜å¯ç”¨**ï¼šä¸€ä¸ªæœåŠ¡æ•…éšœä¸å½±å“å…¶ä»–æœåŠ¡
- **å¯æ‰©å±•**ï¼šé€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥æ°´å¹³æ‰©å±•

**âŒ å¼‚æ­¥é€šä¿¡çš„æŒ‘æˆ˜**
- **å¤æ‚æ€§å¢åŠ **ï¼šéœ€è¦å¤„ç†æ¶ˆæ¯ä¸¢å¤±ã€é‡å¤ç­‰é—®é¢˜
- **è°ƒè¯•å›°éš¾**ï¼šé—®é¢˜æ’æŸ¥æ¯”è¾ƒå¤æ‚
- **æœ€ç»ˆä¸€è‡´æ€§**ï¼šæ•°æ®å¯èƒ½æš‚æ—¶ä¸ä¸€è‡´

### 2.3 å¦‚ä½•é€‰æ‹©é€šä¿¡æ–¹å¼


**ğŸ¯ é€‰æ‹©åŸåˆ™**

```
åŒæ­¥é€šä¿¡é€‚åˆï¼š
âœ… éœ€è¦ç«‹å³è·å¾—ç»“æœçš„åœºæ™¯
âœ… æ“ä½œç®€å•ï¼Œè°ƒç”¨é“¾è·¯çŸ­
âœ… å¯¹ä¸€è‡´æ€§è¦æ±‚å¾ˆé«˜çš„åœºæ™¯
ä¾‹å­ï¼šç”¨æˆ·ç™»å½•éªŒè¯ã€å®æ—¶æŸ¥è¯¢

å¼‚æ­¥é€šä¿¡é€‚åˆï¼š
âœ… å¤„ç†æ—¶é—´è¾ƒé•¿çš„ä»»åŠ¡
âœ… å¯¹å®æ—¶æ€§è¦æ±‚ä¸é«˜çš„åœºæ™¯  
âœ… éœ€è¦é«˜å¹¶å‘å¤„ç†çš„åœºæ™¯
ä¾‹å­ï¼šè®¢å•å¤„ç†ã€æ•°æ®åˆ†æã€æ¶ˆæ¯æ¨é€
```

---

## 3. ğŸ” æœåŠ¡å‘ç°æœºåˆ¶


### 3.1 ä»€ä¹ˆæ˜¯æœåŠ¡å‘ç°


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**
```
æœåŠ¡å‘ç°ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒæœåŠ¡å¦‚ä½•æ‰¾åˆ°å…¶ä»–æœåŠ¡çš„ä½ç½®ä¿¡æ¯

ç”Ÿæ´»ç±»æ¯”ï¼š
å°±åƒä½ è¦æ‰¾æœ‹å‹ï¼Œéœ€è¦çŸ¥é“ä»–çš„åœ°å€å’Œç”µè¯
åœ¨å¾®æœåŠ¡ä¸­ï¼ŒæœåŠ¡éœ€è¦çŸ¥é“å…¶ä»–æœåŠ¡çš„IPåœ°å€å’Œç«¯å£å·
```

**ğŸ”¸ ä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡å‘ç°**
```
ä¼ ç»Ÿåº”ç”¨ï¼š
é…ç½®æ–‡ä»¶å†™æ­»IPåœ°å€ â†’ 192.168.1.100:8080

å¾®æœåŠ¡ç¯å¢ƒçš„é—®é¢˜ï¼š
âŒ æœåŠ¡å®ä¾‹ä¼šåŠ¨æ€å˜åŒ–ï¼ˆæ‰©å®¹ã€ç¼©å®¹ï¼‰
âŒ æœåŠ¡å™¨å¯èƒ½é‡å¯ï¼ŒIPä¼šå˜åŒ–
âŒ æ‰‹åŠ¨ç»´æŠ¤é…ç½®æ–‡ä»¶éå¸¸å›°éš¾

è§£å†³æ–¹æ¡ˆï¼š
âœ… è‡ªåŠ¨æ³¨å†ŒæœåŠ¡ä¿¡æ¯
âœ… è‡ªåŠ¨å‘ç°å¯ç”¨æœåŠ¡
âœ… åŠ¨æ€æ›´æ–°æœåŠ¡åˆ—è¡¨
```

### 3.2 æœåŠ¡å‘ç°çš„å®ç°æ–¹å¼


**ğŸ—ï¸ å®¢æˆ·ç«¯å‘ç°æ¨¡å¼**
```
å·¥ä½œæµç¨‹ï¼š
1. æœåŠ¡å¯åŠ¨æ—¶å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±
2. å®¢æˆ·ç«¯ä»æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡åˆ—è¡¨
3. å®¢æˆ·ç«¯ç›´æ¥è°ƒç”¨ç›®æ ‡æœåŠ¡

             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚   æ³¨å†Œä¸­å¿ƒ    â”‚
             â”‚  (Eureka)   â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â†‘  â†“
              æ³¨å†Œ/è·å–æœåŠ¡åˆ—è¡¨
                   â†‘  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â†‘  â†“      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·æœåŠ¡  â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ è®¢å•æœåŠ¡  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    ç›´æ¥è°ƒç”¨     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”§ æœåŠ¡ç«¯å‘ç°æ¨¡å¼**
```
å·¥ä½œæµç¨‹ï¼š
1. å®¢æˆ·ç«¯å°†è¯·æ±‚å‘é€ç»™è´Ÿè½½å‡è¡¡å™¨
2. è´Ÿè½½å‡è¡¡å™¨æŸ¥è¯¢æ³¨å†Œä¸­å¿ƒ
3. è´Ÿè½½å‡è¡¡å™¨å°†è¯·æ±‚è½¬å‘ç»™å…·ä½“æœåŠ¡

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·æœåŠ¡  â”‚ â†’  â”‚ è´Ÿè½½å‡è¡¡å™¨   â”‚ â†’  â”‚ è®¢å•æœåŠ¡  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†‘
                 æŸ¥è¯¢æœåŠ¡ä½ç½®
                       â†“
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚   æ³¨å†Œä¸­å¿ƒ    â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 å¸¸è§çš„æœåŠ¡å‘ç°å·¥å…·


**ğŸ“Š ä¸»æµå·¥å…·å¯¹æ¯”**

| å·¥å…· | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| **Eureka** | Netflixå¼€æºï¼Œæ˜“ç”¨ | Spring Cloudç”Ÿæ€ |
| **Consul** | åŠŸèƒ½ä¸°å¯Œï¼Œæ”¯æŒå¥åº·æ£€æŸ¥ | ä¸­å°å‹ç³»ç»Ÿ |
| **Zookeeper** | å¼ºä¸€è‡´æ€§ï¼Œç¨³å®š | å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿ |
| **Nacos** | é˜¿é‡Œå¼€æºï¼Œé…ç½®+æ³¨å†Œ | å›½å†…å¾®æœåŠ¡é¡¹ç›® |

**ğŸ’» Eurekaæ³¨å†Œç¤ºä¾‹**
```java
// æœåŠ¡æä¾›è€… - è®¢å•æœåŠ¡
@SpringBootApplication
@EnableEurekaClient  // å¯ç”¨Eurekaå®¢æˆ·ç«¯
public class OrderServiceApplication {
    public static void main(String[] args) {
        SpringApplication.run(OrderServiceApplication.class, args);
    }
}

// é…ç½®æ–‡ä»¶
spring:
  application:
    name: order-service  # æœåŠ¡åç§°
eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/  # æ³¨å†Œä¸­å¿ƒåœ°å€
  instance:
    prefer-ip-address: true  # ä½¿ç”¨IPæ³¨å†Œ
```

**ğŸ” æœåŠ¡å‘ç°ä½¿ç”¨ç¤ºä¾‹**
```java
// æœåŠ¡æ¶ˆè´¹è€… - ç”¨æˆ·æœåŠ¡
@RestController
public class UserController {
    
    @Autowired
    private DiscoveryClient discoveryClient;  // æœåŠ¡å‘ç°å®¢æˆ·ç«¯
    
    @GetMapping("/user/{id}/orders")
    public List<Order> getUserOrders(@PathVariable String id) {
        // 1. å‘ç°è®¢å•æœåŠ¡
        List<ServiceInstance> instances = 
            discoveryClient.getInstances("order-service");
        
        if (instances.isEmpty()) {
            throw new RuntimeException("è®¢å•æœåŠ¡ä¸å¯ç”¨");
        }
        
        // 2. é€‰æ‹©ä¸€ä¸ªå®ä¾‹ï¼ˆç®€å•çš„è´Ÿè½½å‡è¡¡ï¼‰
        ServiceInstance instance = instances.get(0);
        String url = instance.getUri() + "/orders/user/" + id;
        
        // 3. è°ƒç”¨æœåŠ¡
        return restTemplate.getForObject(url, List.class);
    }
}
```

---

## 4. âš–ï¸ è´Ÿè½½å‡è¡¡ç­–ç•¥


### 4.1 ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**
```
è´Ÿè½½å‡è¡¡ï¼šå°†è¯·æ±‚åˆ†æ•£åˆ°å¤šä¸ªæœåŠ¡å®ä¾‹ä¸Šï¼Œé¿å…æŸä¸ªå®ä¾‹å‹åŠ›è¿‡å¤§

ç”Ÿæ´»ç±»æ¯”ï¼š
å°±åƒé“¶è¡Œæœ‰å¤šä¸ªçª—å£åŠä¸šåŠ¡
éœ€è¦ä¸€ä¸ªè§„åˆ™æ¥å†³å®šå®¢æˆ·å»å“ªä¸ªçª—å£
è®©æ¯ä¸ªçª—å£çš„å·¥ä½œé‡æ¯”è¾ƒå¹³å‡
```

**ğŸ”¸ ä¸ºä»€ä¹ˆéœ€è¦è´Ÿè½½å‡è¡¡**
```
é—®é¢˜åœºæ™¯ï¼š
è®¢å•æœåŠ¡æœ‰3ä¸ªå®ä¾‹ï¼š
- å®ä¾‹Aï¼šå¤„ç†1000ä¸ªè¯·æ±‚ ğŸ˜°
- å®ä¾‹Bï¼šå¤„ç†10ä¸ªè¯·æ±‚   ğŸ˜  
- å®ä¾‹Cï¼šå¤„ç†20ä¸ªè¯·æ±‚   ğŸ˜

è§£å†³æ–¹æ¡ˆï¼š
é€šè¿‡è´Ÿè½½å‡è¡¡ç®—æ³•åˆç†åˆ†é…ï¼š
- å®ä¾‹Aï¼šå¤„ç†340ä¸ªè¯·æ±‚ ğŸ˜Š
- å®ä¾‹Bï¼šå¤„ç†340ä¸ªè¯·æ±‚ ğŸ˜Š
- å®ä¾‹Cï¼šå¤„ç†340ä¸ªè¯·æ±‚ ğŸ˜Š
```

### 4.2 å¸¸è§è´Ÿè½½å‡è¡¡ç®—æ³•


**ğŸ”„ è½®è¯¢ç®—æ³•ï¼ˆRound Robinï¼‰**
```
åŸç†ï¼šæŒ‰é¡ºåºä¾æ¬¡åˆ†é…è¯·æ±‚

ä¾‹å­ï¼š
è¯·æ±‚1 â†’ æœåŠ¡å®ä¾‹A
è¯·æ±‚2 â†’ æœåŠ¡å®ä¾‹B  
è¯·æ±‚3 â†’ æœåŠ¡å®ä¾‹C
è¯·æ±‚4 â†’ æœåŠ¡å®ä¾‹Aï¼ˆé‡æ–°å¼€å§‹ï¼‰

ä¼˜ç‚¹ï¼šç®€å•å…¬å¹³
ç¼ºç‚¹ï¼šä¸è€ƒè™‘æœåŠ¡å™¨æ€§èƒ½å·®å¼‚
```

**âš–ï¸ åŠ æƒè½®è¯¢ï¼ˆWeighted Round Robinï¼‰**
```
åŸç†ï¼šæ ¹æ®æœåŠ¡å™¨æ€§èƒ½åˆ†é…ä¸åŒæƒé‡

é…ç½®ç¤ºä¾‹ï¼š
æœåŠ¡å®ä¾‹Aï¼šæƒé‡3ï¼ˆé«˜æ€§èƒ½æœåŠ¡å™¨ï¼‰
æœåŠ¡å®ä¾‹Bï¼šæƒé‡2ï¼ˆä¸­ç­‰æ€§èƒ½ï¼‰
æœåŠ¡å®ä¾‹Cï¼šæƒé‡1ï¼ˆä½æ€§èƒ½æœåŠ¡å™¨ï¼‰

åˆ†é…ç»“æœï¼š
Aè·å¾—3/6 = 50%çš„è¯·æ±‚
Bè·å¾—2/6 = 33%çš„è¯·æ±‚  
Cè·å¾—1/6 = 17%çš„è¯·æ±‚
```

**ğŸ“Š æœ€å°‘è¿æ¥æ•°ï¼ˆLeast Connectionsï¼‰**
```java
// è´Ÿè½½å‡è¡¡å™¨ç»´æŠ¤è¿æ¥æ•°
public class LoadBalancer {
    
    private Map<String, Integer> connectionCount = new HashMap<>();
    
    public ServiceInstance selectInstance(List<ServiceInstance> instances) {
        ServiceInstance selected = null;
        int minConnections = Integer.MAX_VALUE;
        
        // é€‰æ‹©è¿æ¥æ•°æœ€å°‘çš„å®ä¾‹
        for (ServiceInstance instance : instances) {
            int connections = connectionCount.getOrDefault(instance.getId(), 0);
            if (connections < minConnections) {
                minConnections = connections;
                selected = instance;
            }
        }
        
        return selected;
    }
}
```

**ğŸ² éšæœºç®—æ³•ï¼ˆRandomï¼‰**
```
åŸç†ï¼šéšæœºé€‰æ‹©ä¸€ä¸ªå¯ç”¨å®ä¾‹

é€‚ç”¨åœºæ™¯ï¼š
âœ… æœåŠ¡å™¨æ€§èƒ½ç›¸è¿‘
âœ… å®ç°ç®€å•
âœ… å¤§é‡è¯·æ±‚æ—¶åˆ†å¸ƒæ¯”è¾ƒå‡åŒ€

å®ç°ï¼š
Random random = new Random();
int index = random.nextInt(instances.size());
return instances.get(index);
```

### 4.3 è´Ÿè½½å‡è¡¡ç­–ç•¥å¯¹æ¯”


**ğŸ“‹ ç­–ç•¥é€‰æ‹©æŒ‡å—**

| ç®—æ³• | é€‚ç”¨åœºæ™¯ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|----------|------|------|
| **è½®è¯¢** | æœåŠ¡å™¨æ€§èƒ½ç›¸åŒ | ç®€å•å…¬å¹³ | ä¸è€ƒè™‘å®é™…è´Ÿè½½ |
| **åŠ æƒè½®è¯¢** | æœåŠ¡å™¨æ€§èƒ½ä¸åŒ | æŒ‰æ€§èƒ½åˆ†é… | éœ€è¦é¢„å…ˆé…ç½®æƒé‡ |
| **æœ€å°‘è¿æ¥** | é•¿è¿æ¥æœåŠ¡ | è€ƒè™‘å®é™…è´Ÿè½½ | éœ€è¦ç»´æŠ¤è¿æ¥çŠ¶æ€ |
| **éšæœº** | å¤§é‡çŸ­è¿æ¥ | å®ç°ç®€å• | çŸ­æœŸå†…å¯èƒ½ä¸å‡åŒ€ |

---

## 5. ğŸ“¡ é€šä¿¡åè®®é€‰æ‹©


### 5.1 HTTP/RESTåè®®


**ğŸ”¸ ä»€ä¹ˆæ˜¯HTTP/REST**
```
HTTPï¼šè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼ŒWebçš„åŸºç¡€åè®®
RESTï¼šä¸€ç§æ¶æ„é£æ ¼ï¼ŒåŸºäºHTTPçš„APIè®¾è®¡è§„èŒƒ

ç‰¹ç‚¹ï¼š
âœ… ç®€å•æ˜“æ‡‚ï¼Œç±»ä¼¼ç½‘é¡µè®¿é—®
âœ… è·¨å¹³å°ï¼Œä»»ä½•è¯­è¨€éƒ½æ”¯æŒ
âœ… è°ƒè¯•æ–¹ä¾¿ï¼Œå¯ä»¥ç”¨æµè§ˆå™¨æµ‹è¯•
```

**ğŸ’» REST APIç¤ºä¾‹**
```java
// è®¢å•æœåŠ¡çš„RESTæ¥å£
@RestController
@RequestMapping("/api/orders")
public class OrderController {
    
    // è·å–è®¢å• - GETè¯·æ±‚
    @GetMapping("/{id}")
    public Order getOrder(@PathVariable String id) {
        return orderService.findById(id);
    }
    
    // åˆ›å»ºè®¢å• - POSTè¯·æ±‚
    @PostMapping
    public Order createOrder(@RequestBody OrderRequest request) {
        return orderService.createOrder(request);
    }
    
    // æ›´æ–°è®¢å• - PUTè¯·æ±‚
    @PutMapping("/{id}")
    public Order updateOrder(@PathVariable String id, @RequestBody Order order) {
        return orderService.updateOrder(id, order);
    }
}
```

**âœ… HTTP/RESTçš„ä¼˜åŠ¿**
- **æ ‡å‡†åŒ–**ï¼šéµå¾ªWebæ ‡å‡†ï¼Œæ˜“äºç†è§£
- **æ— çŠ¶æ€**ï¼šæ¯ä¸ªè¯·æ±‚ç‹¬ç«‹ï¼Œä¾¿äºæ‰©å±•
- **ç¼“å­˜å‹å¥½**ï¼šå¯ä»¥åˆ©ç”¨HTTPç¼“å­˜æœºåˆ¶

**âŒ HTTP/RESTçš„å±€é™**
- **æ€§èƒ½è¾ƒä½**ï¼šæ–‡æœ¬åè®®ï¼Œä¼ è¾“æ•ˆç‡ä¸é«˜
- **åŠŸèƒ½æœ‰é™**ï¼šåªæ”¯æŒè¯·æ±‚-å“åº”æ¨¡å¼

### 5.2 RPCåè®®


**ğŸ”¸ ä»€ä¹ˆæ˜¯RPC**
```
RPCï¼šè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œè®©è¿œç¨‹è°ƒç”¨åƒæœ¬åœ°è°ƒç”¨ä¸€æ ·ç®€å•

æœ¬åœ°è°ƒç”¨ï¼š
int result = calculator.add(1, 2);

RPCè°ƒç”¨ï¼š
int result = remoteCalculator.add(1, 2);  // å®é™…æ˜¯ç½‘ç»œè°ƒç”¨
```

**ğŸ“Š ä¸»æµRPCæ¡†æ¶**

| æ¡†æ¶ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| **gRPC** | Googleå¼€æºï¼ŒåŸºäºHTTP/2 | é«˜æ€§èƒ½å¾®æœåŠ¡ |
| **Dubbo** | é˜¿é‡Œå¼€æºï¼ŒåŠŸèƒ½ä¸°å¯Œ | Javaå¾®æœåŠ¡ |
| **Thrift** | Facebookå¼€æºï¼Œè·¨è¯­è¨€ | å¤šè¯­è¨€ç¯å¢ƒ |

**ğŸ’» gRPCç¤ºä¾‹**
```protobuf
// å®šä¹‰æœåŠ¡æ¥å£ - order.proto
syntax = "proto3";

service OrderService {
    rpc CreateOrder(OrderRequest) returns (OrderResponse);
    rpc GetOrder(GetOrderRequest) returns (Order);
}

message OrderRequest {
    string product_id = 1;
    int32 quantity = 2;
    double price = 3;
}

message OrderResponse {
    string order_id = 1;
    string status = 2;
}
```

```java
// Javaå®ç°
@Service
public class OrderServiceImpl extends OrderServiceGrpc.OrderServiceImplBase {
    
    @Override
    public void createOrder(OrderRequest request, 
                           StreamObserver<OrderResponse> responseObserver) {
        // å¤„ç†è®¢å•åˆ›å»ºé€»è¾‘
        OrderResponse response = OrderResponse.newBuilder()
            .setOrderId("ORD123")
            .setStatus("SUCCESS")
            .build();
            
        responseObserver.onNext(response);
        responseObserver.onCompleted();
    }
}
```

**âœ… RPCçš„ä¼˜åŠ¿**
- **é«˜æ€§èƒ½**ï¼šäºŒè¿›åˆ¶åè®®ï¼Œä¼ è¾“æ•ˆç‡é«˜
- **ç±»å‹å®‰å…¨**ï¼šå¼ºç±»å‹æ¥å£å®šä¹‰
- **å¤šè¯­è¨€æ”¯æŒ**ï¼šä¸€å¥—æ¥å£å®šä¹‰ï¼Œå¤šè¯­è¨€å®ç°

### 5.3 æ¶ˆæ¯é˜Ÿåˆ—åè®®


**ğŸ”¸ ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—**
```
æ¶ˆæ¯é˜Ÿåˆ—ï¼šå¼‚æ­¥é€šä¿¡çš„ä¸­é—´ä»¶ï¼Œåƒé‚®ç®±ä¸€æ ·ä¼ é€’æ¶ˆæ¯

å·¥ä½œæµç¨‹ï¼š
1. å‘é€æ–¹å°†æ¶ˆæ¯æ”¾å…¥é˜Ÿåˆ—
2. é˜Ÿåˆ—ä¿å­˜æ¶ˆæ¯
3. æ¥æ”¶æ–¹ä»é˜Ÿåˆ—å–å‡ºæ¶ˆæ¯å¤„ç†

        å‘é€æ–¹
          â†“ å‘é€æ¶ˆæ¯
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   æ¶ˆæ¯é˜Ÿåˆ—    â”‚
    â”‚ [æ¶ˆæ¯1][æ¶ˆæ¯2] â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“ æ¶ˆè´¹æ¶ˆæ¯
        æ¥æ”¶æ–¹
```

**ğŸ“‹ å¸¸è§æ¶ˆæ¯é˜Ÿåˆ—**

| æ¶ˆæ¯é˜Ÿåˆ— | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|----------|------|----------|
| **RabbitMQ** | åŠŸèƒ½ä¸°å¯Œï¼Œæ˜“ç”¨ | ä¸­å°å‹é¡¹ç›® |
| **Apache Kafka** | é«˜ååé‡ï¼ŒæŒä¹…åŒ– | å¤§æ•°æ®å¤„ç† |
| **RocketMQ** | é˜¿é‡Œå¼€æºï¼Œé«˜å¯é  | é‡‘èçº§åº”ç”¨ |

### 5.4 åè®®é€‰æ‹©æŒ‡å¯¼


**ğŸ¯ é€‰æ‹©åŸåˆ™**

```
HTTP/RESTé€‚åˆï¼š
âœ… å¯¹å¤–æä¾›API
âœ… ç³»ç»Ÿé—´æ¾è€¦åˆ
âœ… å¼€å‘æµ‹è¯•ä¾¿åˆ©æ€§è¦æ±‚é«˜

RPCé€‚åˆï¼š
âœ… å†…éƒ¨æœåŠ¡è°ƒç”¨
âœ… æ€§èƒ½è¦æ±‚é«˜
âœ… æ¥å£å˜åŒ–è¾ƒå°‘

æ¶ˆæ¯é˜Ÿåˆ—é€‚åˆï¼š
âœ… å¼‚æ­¥å¤„ç†
âœ… ç³»ç»Ÿè§£è€¦
âœ… é«˜å¹¶å‘åœºæ™¯
```

---

## 6. ğŸš€ å¼‚æ­¥åŒ–ä¸æ¶ˆæ¯é©±åŠ¨


### 6.1 å¼‚æ­¥è°ƒç”¨


**ğŸ”¸ ä»€ä¹ˆæ˜¯å¼‚æ­¥è°ƒç”¨**
```
å¼‚æ­¥è°ƒç”¨ï¼šä¸ç­‰å¾…ç»“æœç«‹å³è¿”å›ï¼Œé€šè¿‡å›è°ƒæˆ–è½®è¯¢è·å–ç»“æœ

åŒæ­¥è°ƒç”¨æµç¨‹ï¼š
å®¢æˆ·ç«¯ â†’ å‘é€è¯·æ±‚ â†’ ç­‰å¾…å“åº” â†’ æ”¶åˆ°ç»“æœ â†’ ç»§ç»­æ‰§è¡Œ

å¼‚æ­¥è°ƒç”¨æµç¨‹ï¼š
å®¢æˆ·ç«¯ â†’ å‘é€è¯·æ±‚ â†’ ç«‹å³è¿”å› â†’ ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡
                    â†“
                 åå°å¤„ç†
                    â†“
                é€šè¿‡å›è°ƒé€šçŸ¥ç»“æœ
```

**ğŸ’» å¼‚æ­¥è°ƒç”¨å®ç°æ–¹å¼**

**ğŸ”¹ CompletableFutureæ–¹å¼**
```java
@Service
public class OrderService {
    
    public CompletableFuture<String> createOrderAsync(OrderRequest request) {
        return CompletableFuture.supplyAsync(() -> {
            // å¼‚æ­¥å¤„ç†è®¢å•åˆ›å»º
            try {
                Thread.sleep(2000); // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
                return processOrder(request);
            } catch (Exception e) {
                throw new RuntimeException("è®¢å•å¤„ç†å¤±è´¥", e);
            }
        });
    }
    
    // ä½¿ç”¨å¼‚æ­¥è°ƒç”¨
    public void handleOrder(OrderRequest request) {
        // å¼‚æ­¥åˆ›å»ºè®¢å•ï¼Œä¸é˜»å¡å½“å‰çº¿ç¨‹
        createOrderAsync(request)
            .thenAccept(result -> {
                System.out.println("è®¢å•å¤„ç†å®Œæˆï¼š" + result);
            })
            .exceptionally(throwable -> {
                System.err.println("è®¢å•å¤„ç†å¤±è´¥ï¼š" + throwable.getMessage());
                return null;
            });
        
        // å¯ä»¥ç»§ç»­å¤„ç†å…¶ä»–ä»»åŠ¡
        System.out.println("å¯ä»¥ç»§ç»­å¤„ç†å…¶ä»–è¯·æ±‚...");
    }
}
```

**ğŸ”¹ å›è°ƒæœºåˆ¶**
```java
// å®šä¹‰å›è°ƒæ¥å£
public interface OrderCallback {
    void onSuccess(String orderId);
    void onFailure(String error);
}

// å¼‚æ­¥å¤„ç†æœåŠ¡
@Service
public class AsyncOrderService {
    
    public void createOrderAsync(OrderRequest request, OrderCallback callback) {
        // ä½¿ç”¨çº¿ç¨‹æ± å¼‚æ­¥å¤„ç†
        threadPool.execute(() -> {
            try {
                String orderId = processOrder(request);
                callback.onSuccess(orderId);  // æˆåŠŸå›è°ƒ
            } catch (Exception e) {
                callback.onFailure(e.getMessage());  // å¤±è´¥å›è°ƒ
            }
        });
    }
}

// ä½¿ç”¨å›è°ƒ
asyncOrderService.createOrderAsync(request, new OrderCallback() {
    @Override
    public void onSuccess(String orderId) {
        System.out.println("è®¢å•åˆ›å»ºæˆåŠŸï¼š" + orderId);
    }
    
    @Override
    public void onFailure(String error) {
        System.err.println("è®¢å•åˆ›å»ºå¤±è´¥ï¼š" + error);
    }
});
```

### 6.2 æ¶ˆæ¯é˜Ÿåˆ—


**ğŸ”¸ æ¶ˆæ¯é˜Ÿåˆ—çš„æ ¸å¿ƒæ¦‚å¿µ**
```
æ¶ˆæ¯é˜Ÿåˆ—ç»„æˆï¼š
ğŸ“¨ Producerï¼ˆç”Ÿäº§è€…ï¼‰ï¼šå‘é€æ¶ˆæ¯çš„æœåŠ¡
ğŸ“® Queueï¼ˆé˜Ÿåˆ—ï¼‰ï¼šå­˜å‚¨æ¶ˆæ¯çš„å®¹å™¨  
ğŸ“§ Consumerï¼ˆæ¶ˆè´¹è€…ï¼‰ï¼šæ¥æ”¶å¤„ç†æ¶ˆæ¯çš„æœåŠ¡

æ¶ˆæ¯æµè½¬ï¼š
Producer â†’ Queue â†’ Consumer

ä¼˜åŠ¿ï¼š
âœ… è§£è€¦ï¼šç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¸ç›´æ¥ä¾èµ–
âœ… å¼‚æ­¥ï¼šç”Ÿäº§è€…å‘é€åç«‹å³è¿”å›
âœ… å‰Šå³°ï¼šå¤„ç†çªå‘æµé‡
âœ… å¯é ï¼šæ¶ˆæ¯æŒä¹…åŒ–ï¼Œé˜²æ­¢ä¸¢å¤±
```

**ğŸ’» RabbitMQä½¿ç”¨ç¤ºä¾‹**
```java
// æ¶ˆæ¯ç”Ÿäº§è€… - è®¢å•æœåŠ¡
@Component
public class OrderMessageProducer {
    
    @Autowired
    private RabbitTemplate rabbitTemplate;
    
    public void sendOrderMessage(Order order) {
        // åˆ›å»ºè®¢å•æ¶ˆæ¯
        OrderMessage message = new OrderMessage(
            order.getId(), 
            order.getUserId(), 
            order.getAmount()
        );
        
        // å‘é€åˆ°è®¢å•å¤„ç†é˜Ÿåˆ—
        rabbitTemplate.convertAndSend("order.exchange", "order.created", message);
        System.out.println("è®¢å•æ¶ˆæ¯å·²å‘é€ï¼š" + order.getId());
    }
}

// æ¶ˆæ¯æ¶ˆè´¹è€… - åº“å­˜æœåŠ¡
@Component
public class InventoryMessageConsumer {
    
    @RabbitListener(queues = "inventory.update.queue")
    public void handleOrderCreated(OrderMessage message) {
        System.out.println("æ”¶åˆ°è®¢å•æ¶ˆæ¯ï¼š" + message.getOrderId());
        
        // å¤„ç†åº“å­˜æ‰£å‡
        try {
            inventoryService.reduceStock(message.getProductId(), message.getQuantity());
            System.out.println("åº“å­˜æ‰£å‡å®Œæˆ");
        } catch (Exception e) {
            System.err.println("åº“å­˜æ‰£å‡å¤±è´¥ï¼š" + e.getMessage());
            // å¯ä»¥å‘é€åˆ°é”™è¯¯é˜Ÿåˆ—è¿›è¡Œé‡è¯•
        }
    }
}
```

### 6.3 äº‹ä»¶æ€»çº¿


**ğŸ”¸ ä»€ä¹ˆæ˜¯äº‹ä»¶æ€»çº¿**
```
äº‹ä»¶æ€»çº¿ï¼šç³»ç»Ÿå†…éƒ¨çš„æ¶ˆæ¯ä¼ é€’æœºåˆ¶ï¼ŒåŸºäºå‘å¸ƒ-è®¢é˜…æ¨¡å¼

å·¥ä½œåŸç†ï¼š
1. äº‹ä»¶å‘å¸ƒè€…å‘å¸ƒäº‹ä»¶
2. äº‹ä»¶æ€»çº¿åˆ†å‘äº‹ä»¶  
3. æ‰€æœ‰è®¢é˜…è€…æ¥æ”¶äº‹ä»¶

          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  è®¢é˜…è€…A    â”‚
          â”‚ (åº“å­˜æœåŠ¡)   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†‘
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   äº‹ä»¶æ€»çº¿    â”‚ â†’   â”‚  è®¢é˜…è€…B    â”‚
    â”‚              â”‚     â”‚ (é€šçŸ¥æœåŠ¡)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†‘                    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  å‘å¸ƒè€…      â”‚ â†’    â”‚  è®¢é˜…è€…C    â”‚
    â”‚ (è®¢å•æœåŠ¡)   â”‚      â”‚ (ç§¯åˆ†æœåŠ¡)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ’» Springäº‹ä»¶æœºåˆ¶ç¤ºä¾‹**
```java
// å®šä¹‰äº‹ä»¶
public class OrderCreatedEvent extends ApplicationEvent {
    private final Order order;
    
    public OrderCreatedEvent(Object source, Order order) {
        super(source);
        this.order = order;
    }
    
    public Order getOrder() { return order; }
}

// äº‹ä»¶å‘å¸ƒè€…
@Service
public class OrderService {
    
    @Autowired
    private ApplicationEventPublisher eventPublisher;
    
    public Order createOrder(OrderRequest request) {
        // åˆ›å»ºè®¢å•
        Order order = new Order(request);
        orderRepository.save(order);
        
        // å‘å¸ƒè®¢å•åˆ›å»ºäº‹ä»¶
        OrderCreatedEvent event = new OrderCreatedEvent(this, order);
        eventPublisher.publishEvent(event);
        
        return order;
    }
}

// äº‹ä»¶è®¢é˜…è€… - åº“å­˜æœåŠ¡
@Component
public class InventoryEventHandler {
    
    @EventListener
    @Async  // å¼‚æ­¥å¤„ç†
    public void handleOrderCreated(OrderCreatedEvent event) {
        Order order = event.getOrder();
        System.out.println("å¤„ç†åº“å­˜æ‰£å‡ï¼š" + order.getId());
        
        // æ‰£å‡åº“å­˜é€»è¾‘
        inventoryService.reduceStock(order);
    }
}

// äº‹ä»¶è®¢é˜…è€… - é€šçŸ¥æœåŠ¡  
@Component
public class NotificationEventHandler {
    
    @EventListener
    @Async
    public void handleOrderCreated(OrderCreatedEvent event) {
        Order order = event.getOrder();
        System.out.println("å‘é€è®¢å•é€šçŸ¥ï¼š" + order.getId());
        
        // å‘é€é€šçŸ¥é€»è¾‘
        notificationService.sendOrderNotification(order);
    }
}
```

---

## 7. ğŸ“‹ ä»»åŠ¡æ‹†åˆ†ä¸è°ƒåº¦


### 7.1 åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦


**ğŸ”¸ ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦**
```
åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ï¼šåœ¨å¤šå°æœåŠ¡å™¨ä¸Šåè°ƒæ‰§è¡Œå®šæ—¶ä»»åŠ¡æˆ–æ‰¹å¤„ç†ä»»åŠ¡

è§£å†³çš„é—®é¢˜ï¼š
âŒ å•æœºä»»åŠ¡è°ƒåº¦çš„å±€é™æ€§
âŒ ä»»åŠ¡æ‰§è¡Œçš„é«˜å¯ç”¨æ€§
âŒ å¤§ä»»åŠ¡çš„å¹¶è¡Œå¤„ç†

åˆ†å¸ƒå¼è°ƒåº¦çš„ä¼˜åŠ¿ï¼š
âœ… é«˜å¯ç”¨ï¼šä¸€å°æœºå™¨å®•æœºï¼Œå…¶ä»–æœºå™¨ç»§ç»­æ‰§è¡Œ
âœ… è´Ÿè½½å‡è¡¡ï¼šä»»åŠ¡åˆ†æ•£åˆ°å¤šå°æœºå™¨
âœ… æ°´å¹³æ‰©å±•ï¼šå¢åŠ æœºå™¨æå‡å¤„ç†èƒ½åŠ›
```

**ğŸ—ï¸ åˆ†å¸ƒå¼è°ƒåº¦æ¶æ„**
```
                è°ƒåº¦ä¸­å¿ƒ
                   â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚      ä»»åŠ¡åˆ†å‘         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ æ‰§è¡Œå™¨1   â”‚ æ‰§è¡Œå™¨2   â”‚ æ‰§è¡Œå™¨3   â”‚
    â”‚ å¤„ç†ä»»åŠ¡A â”‚ å¤„ç†ä»»åŠ¡B â”‚ å¤„ç†ä»»åŠ¡C â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ’» XXL-JOBä½¿ç”¨ç¤ºä¾‹**
```java
// ä»»åŠ¡æ‰§è¡Œå™¨
@Component
public class OrderTaskHandler {
    
    @XxlJob("orderProcessingTask")
    public ReturnT<String> processOrders(String param) {
        System.out.println("å¼€å§‹å¤„ç†è®¢å•ä»»åŠ¡ï¼Œå‚æ•°ï¼š" + param);
        
        try {
            // è·å–å¾…å¤„ç†çš„è®¢å•
            List<Order> pendingOrders = orderService.getPendingOrders();
            
            // æ‰¹é‡å¤„ç†è®¢å•
            for (Order order : pendingOrders) {
                processOrder(order);
            }
            
            return ReturnT.SUCCESS;
        } catch (Exception e) {
            System.err.println("è®¢å•å¤„ç†ä»»åŠ¡å¤±è´¥ï¼š" + e.getMessage());
            return ReturnT.FAIL;
        }
    }
    
    @XxlJob("dailyReportTask")  
    public ReturnT<String> generateDailyReport(String param) {
        System.out.println("ç”Ÿæˆæ—¥æŠ¥ä»»åŠ¡");
        
        // ç”Ÿæˆé”€å”®æ—¥æŠ¥
        reportService.generateDailyReport(LocalDate.now());
        
        return ReturnT.SUCCESS;
    }
}
```

### 7.2 ä»»åŠ¡æ‹†åˆ†ç­–ç•¥


**ğŸ”¸ æŒ‰æ•°æ®æ‹†åˆ†**
```java
// å°†å¤§ä»»åŠ¡æŒ‰æ•°æ®èŒƒå›´æ‹†åˆ†
@Service
public class DataProcessingService {
    
    public void processLargeDataset() {
        // è·å–æ€»æ•°æ®é‡
        long totalCount = dataRepository.count();
        int batchSize = 1000;  // æ¯æ‰¹å¤„ç†1000æ¡
        
        // è®¡ç®—éœ€è¦çš„æ‰¹æ¬¡
        int batches = (int) Math.ceil((double) totalCount / batchSize);
        
        // æäº¤å¤šä¸ªå­ä»»åŠ¡
        for (int i = 0; i < batches; i++) {
            int start = i * batchSize;
            int end = Math.min(start + batchSize, (int) totalCount);
            
            // å¼‚æ­¥æ‰§è¡Œå­ä»»åŠ¡
            CompletableFuture.runAsync(() -> {
                processBatch(start, end);
            });
        }
    }
    
    private void processBatch(int start, int end) {
        System.out.println("å¤„ç†æ•°æ®èŒƒå›´ï¼š" + start + " - " + end);
        
        // åˆ†é¡µæŸ¥è¯¢æ•°æ®
        List<DataEntity> dataList = dataRepository.findByRange(start, end);
        
        // å¤„ç†æ•°æ®
        for (DataEntity data : dataList) {
            processData(data);
        }
    }
}
```

**ğŸ”¸ æŒ‰æ—¶é—´æ‹†åˆ†**
```java
// æŒ‰æ—¶é—´æ®µæ‹†åˆ†ä»»åŠ¡
@Service
public class TimeBasedTaskService {
    
    public void processMonthlyData(int year, int month) {
        LocalDate startDate = LocalDate.of(year, month, 1);
        LocalDate endDate = startDate.withDayOfMonth(startDate.lengthOfMonth());
        
        // æŒ‰å¤©æ‹†åˆ†å¤„ç†
        for (LocalDate date = startDate; !date.isAfter(endDate); date = date.plusDays(1)) {
            final LocalDate processDate = date;
            
            // å¼‚æ­¥å¤„ç†æ¯ä¸€å¤©çš„æ•°æ®
            CompletableFuture.runAsync(() -> {
                processDailyData(processDate);
            });
        }
    }
    
    private void processDailyData(LocalDate date) {
        System.out.println("å¤„ç†æ—¥æœŸï¼š" + date);
        
        // æŸ¥è¯¢å½“å¤©çš„æ•°æ®
        List<Order> orders = orderRepository.findByDate(date);
        
        // ç”Ÿæˆç»Ÿè®¡æŠ¥å‘Š
        generateReport(date, orders);
    }
}
```

### 7.3 æ‰¹å¤„ç†æ¶æ„è®¾è®¡


**ğŸ”¸ Spring Batchæ¡†æ¶**
```java
// æ‰¹å¤„ç†ä½œä¸šé…ç½®
@Configuration
@EnableBatchProcessing
public class BatchJobConfig {
    
    @Bean
    public Job orderProcessingJob(JobBuilderFactory jobs, Step orderProcessingStep) {
        return jobs.get("orderProcessingJob")
            .start(orderProcessingStep)
            .build();
    }
    
    @Bean
    public Step orderProcessingStep(StepBuilderFactory steps) {
        return steps.get("orderProcessingStep")
            .<Order, ProcessedOrder>chunk(100)  // æ¯æ¬¡å¤„ç†100æ¡
            .reader(orderReader())      // æ•°æ®è¯»å–
            .processor(orderProcessor()) // æ•°æ®å¤„ç†
            .writer(orderWriter())      // æ•°æ®å†™å…¥
            .build();
    }
    
    @Bean
    public ItemReader<Order> orderReader() {
        return new JdbcCursorItemReader<Order>() {{
            setDataSource(dataSource);
            setSql("SELECT * FROM orders WHERE status = 'PENDING'");
            setRowMapper(new OrderRowMapper());
        }};
    }
    
    @Bean
    public ItemProcessor<Order, ProcessedOrder> orderProcessor() {
        return order -> {
            // è®¢å•å¤„ç†é€»è¾‘
            ProcessedOrder processed = new ProcessedOrder();
            processed.setOrderId(order.getId());
            processed.setProcessedTime(LocalDateTime.now());
            
            // è°ƒç”¨ä¸šåŠ¡æœåŠ¡å¤„ç†
            businessService.processOrder(order);
            
            return processed;
        };
    }
    
    @Bean
    public ItemWriter<ProcessedOrder> orderWriter() {
        return items -> {
            // æ‰¹é‡å†™å…¥å¤„ç†ç»“æœ
            for (ProcessedOrder item : items) {
                processedOrderRepository.save(item);
            }
        };
    }
}
```

**ğŸ”¸ æ‰¹å¤„ç†ç›‘æ§**
```java
// ä½œä¸šæ‰§è¡Œç›‘å¬å™¨
@Component
public class JobExecutionListener implements org.springframework.batch.core.JobExecutionListener {
    
    @Override
    public void beforeJob(JobExecution jobExecution) {
        System.out.println("æ‰¹å¤„ç†ä½œä¸šå¼€å§‹ï¼š" + jobExecution.getJobInstance().getJobName());
        System.out.println("å¼€å§‹æ—¶é—´ï¼š" + jobExecution.getStartTime());
    }
    
    @Override
    public void afterJob(JobExecution jobExecution) {
        System.out.println("æ‰¹å¤„ç†ä½œä¸šå®Œæˆï¼š" + jobExecution.getJobInstance().getJobName());
        System.out.println("ç»“æŸæ—¶é—´ï¼š" + jobExecution.getEndTime());
        System.out.println("æ‰§è¡ŒçŠ¶æ€ï¼š" + jobExecution.getStatus());
        
        // ç»Ÿè®¡å¤„ç†ç»“æœ
        jobExecution.getStepExecutions().forEach(stepExecution -> {
            System.out.println("æ­¥éª¤ï¼š" + stepExecution.getStepName());
            System.out.println("è¯»å–æ•°é‡ï¼š" + stepExecution.getReadCount());
            System.out.println("å¤„ç†æ•°é‡ï¼š" + stepExecution.getWriteCount());
            System.out.println("è·³è¿‡æ•°é‡ï¼š" + stepExecution.getSkipCount());
        });
    }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 æœåŠ¡é—´é€šä¿¡çš„æ ¸å¿ƒè¦ç‚¹


**ğŸ”¸ é€šä¿¡æ–¹å¼é€‰æ‹©**
```
åŒæ­¥é€šä¿¡ï¼š
âœ… é€‚åˆï¼šå®æ—¶æ€§è¦æ±‚é«˜ï¼Œè°ƒç”¨é“¾è·¯çŸ­
âŒ æ³¨æ„ï¼šæ€§èƒ½ç“¶é¢ˆï¼Œçº§è”æ•…éšœé£é™©

å¼‚æ­¥é€šä¿¡ï¼š
âœ… é€‚åˆï¼šé«˜å¹¶å‘ï¼Œé•¿æ—¶é—´å¤„ç†ï¼Œç³»ç»Ÿè§£è€¦
âŒ æ³¨æ„ï¼šå¤æ‚æ€§å¢åŠ ï¼Œæœ€ç»ˆä¸€è‡´æ€§
```

**ğŸ”¸ å…³é”®è®¾è®¡åŸåˆ™**
- **æœåŠ¡å‘ç°**ï¼šåŠ¨æ€æ³¨å†Œå’Œå‘ç°ï¼Œé¿å…ç¡¬ç¼–ç é…ç½®
- **è´Ÿè½½å‡è¡¡**ï¼šåˆç†åˆ†é…è¯·æ±‚ï¼Œæé«˜ç³»ç»Ÿæ•´ä½“æ€§èƒ½
- **åè®®é€‰æ‹©**ï¼šæ ¹æ®åœºæ™¯é€‰æ‹©HTTPã€RPCæˆ–æ¶ˆæ¯é˜Ÿåˆ—
- **å¼‚æ­¥ä¼˜å…ˆ**ï¼šä¼˜å…ˆè€ƒè™‘å¼‚æ­¥æ–¹æ¡ˆï¼Œæé«˜ç³»ç»Ÿååé‡

### 8.2 å®è·µåº”ç”¨æŒ‡å¯¼


**ğŸ¯ æ¶æ„è®¾è®¡å»ºè®®**
1. **å°ç³»ç»Ÿ**ï¼šHTTP/REST + åŒæ­¥è°ƒç”¨ï¼Œç®€å•ç›´æ¥
2. **ä¸­ç­‰ç³»ç»Ÿ**ï¼šHTTP + æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¼‚æ­¥è§£è€¦
3. **å¤§å‹ç³»ç»Ÿ**ï¼šRPC + æ¶ˆæ¯é˜Ÿåˆ— + äº‹ä»¶é©±åŠ¨

**ğŸ”§ æŠ€æœ¯é€‰å‹å‚è€ƒ**
- **æœåŠ¡å‘ç°**ï¼šSpring Cloudç”¨Eurekaï¼Œå…¶ä»–ç”¨Consul
- **è´Ÿè½½å‡è¡¡**ï¼šè€ƒè™‘å®é™…è´Ÿè½½æƒ…å†µï¼Œæ¨èæœ€å°‘è¿æ¥ç®—æ³•
- **æ¶ˆæ¯é˜Ÿåˆ—**ï¼šå°é¡¹ç›®ç”¨RabbitMQï¼Œå¤§æ•°æ®ç”¨Kafka
- **ä»»åŠ¡è°ƒåº¦**ï¼šXXL-JOBæˆ–SchedulerX

### 8.3 å¸¸è§é—®é¢˜è§£å†³


**âš ï¸ æœåŠ¡è°ƒç”¨å¤±è´¥**
```
è§£å†³æ–¹æ¡ˆï¼š
1. ç†”æ–­å™¨ï¼šé˜²æ­¢çº§è”æ•…éšœ
2. é‡è¯•æœºåˆ¶ï¼šå¤„ç†ä¸´æ—¶æ€§æ•…éšœ
3. é™çº§ç­–ç•¥ï¼šæä¾›å¤‡ç”¨æ–¹æ¡ˆ
4. è¶…æ—¶è®¾ç½®ï¼šé¿å…é•¿æ—¶é—´ç­‰å¾…
```

**âš ï¸ æ¶ˆæ¯ä¸¢å¤±**
```
è§£å†³æ–¹æ¡ˆï¼š
1. æ¶ˆæ¯æŒä¹…åŒ–ï¼šå­˜å‚¨åˆ°ç£ç›˜
2. ç¡®è®¤æœºåˆ¶ï¼šå‘é€æ–¹ç¡®è®¤æ¥æ”¶
3. é‡è¯•é˜Ÿåˆ—ï¼šå¤±è´¥æ¶ˆæ¯é‡æ–°å¤„ç†
4. æ­»ä¿¡é˜Ÿåˆ—ï¼šæœ€ç»ˆå¤„ç†å¤±è´¥çš„æ¶ˆæ¯
```

**ğŸ’¡ æ ¸å¿ƒè®°å¿†è¦ç‚¹**
- æœåŠ¡é—´é€šä¿¡æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„è¡€ç®¡
- åŒæ­¥æ±‚å¿«ï¼Œå¼‚æ­¥æ±‚ç¨³ï¼Œæ ¹æ®åœºæ™¯é€‰æ‹©
- æœåŠ¡å‘ç°è®©ç³»ç»Ÿæ›´çµæ´»ï¼Œè´Ÿè½½å‡è¡¡è®©ç³»ç»Ÿæ›´ç¨³å®š
- æ¶ˆæ¯é©±åŠ¨æ˜¯ç°ä»£æ¶æ„çš„æ ¸å¿ƒæ¨¡å¼
- ä»»åŠ¡æ‹†åˆ†è®©å¤§ä»»åŠ¡å˜å¾—å¯ç®¡ç†