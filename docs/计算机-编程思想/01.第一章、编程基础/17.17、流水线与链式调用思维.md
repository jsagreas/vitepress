---
title: 17ã€æµæ°´çº¿ä¸é“¾å¼è°ƒç”¨æ€ç»´
---
## ğŸ“š ç›®å½•

1. [æµæ°´çº¿æ€ç»´åŸºç¡€](#1-æµæ°´çº¿æ€ç»´åŸºç¡€)
2. [é“¾å¼è°ƒç”¨è®¾è®¡](#2-é“¾å¼è°ƒç”¨è®¾è®¡)
3. [Stream APIåº”ç”¨](#3-stream-apiåº”ç”¨)
4. [Pipelineæ¨¡å¼å®ç°](#4-pipelineæ¨¡å¼å®ç°)
5. [å®æˆ˜æ¡ˆä¾‹åˆ†æ](#5-å®æˆ˜æ¡ˆä¾‹åˆ†æ)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ­ æµæ°´çº¿æ€ç»´åŸºç¡€


### 1.1 ä»€ä¹ˆæ˜¯æµæ°´çº¿æ€ç»´


**æ ¸å¿ƒæ¦‚å¿µ**ï¼šæŠŠå¤æ‚çš„æ•°æ®å¤„ç†æ‹†åˆ†æˆä¸€ç³»åˆ—ç®€å•çš„æ­¥éª¤ï¼Œåƒå·¥å‚æµæ°´çº¿ä¸€æ ·ï¼Œæ•°æ®ä»ä¸€ä¸ªæ­¥éª¤æµå‘ä¸‹ä¸€ä¸ªæ­¥éª¤ã€‚

```
ä¼ ç»Ÿæ€ç»´ï¼ˆä¸€æ¬¡æ€§å¤„ç†ï¼‰ï¼š
åŸææ–™ â†’ [å¤æ‚åŠ å·¥è¿‡ç¨‹] â†’ æˆå“

æµæ°´çº¿æ€ç»´ï¼ˆåˆ†æ­¥å¤„ç†ï¼‰ï¼š
åŸææ–™ â†’ æ­¥éª¤1 â†’ æ­¥éª¤2 â†’ æ­¥éª¤3 â†’ æˆå“
         æ¸…æ´—   â†’ åˆ‡å‰²  â†’ åŒ…è£…  â†’ æˆå“
```

**ä¸ºä»€ä¹ˆéœ€è¦æµæ°´çº¿æ€ç»´ï¼Ÿ**
- **é™ä½å¤æ‚åº¦**ï¼šæŠŠå¤æ‚é—®é¢˜æ‹†è§£æˆç®€å•æ­¥éª¤
- **ä¾¿äºç»´æŠ¤**ï¼šæ¯ä¸ªæ­¥éª¤èŒè´£å•ä¸€ï¼Œæ˜“äºä¿®æ”¹
- **å¯å¤ç”¨æ€§**ï¼šæ­¥éª¤å¯ä»¥åœ¨ä¸åŒåœºæ™¯ä¸‹é‡å¤ä½¿ç”¨
- **æ˜“äºæµ‹è¯•**ï¼šæ¯ä¸ªæ­¥éª¤éƒ½å¯ä»¥ç‹¬ç«‹æµ‹è¯•

### 1.2 æµæ°´çº¿æ€ç»´çš„ç‰¹ç‚¹


```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¾“å…¥   â”‚â”€â”€â”€â–¶â”‚  æ­¥éª¤1  â”‚â”€â”€â”€â–¶â”‚  æ­¥éª¤2  â”‚â”€â”€â”€â–¶â”‚  è¾“å‡º   â”‚
â”‚  æ•°æ®   â”‚    â”‚ å¤„ç†A   â”‚    â”‚ å¤„ç†B   â”‚    â”‚  ç»“æœ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‰¹ç‚¹ï¼š
âœ… å•å‘æµåŠ¨ï¼šæ•°æ®ä»å·¦åˆ°å³ä¾æ¬¡å¤„ç†
âœ… æ­¥éª¤ç‹¬ç«‹ï¼šæ¯ä¸ªæ­¥éª¤åªå…³å¿ƒè‡ªå·±çš„å¤„ç†é€»è¾‘
âœ… å¯ç»„åˆæ€§ï¼šå¯ä»¥ä»»æ„ç»„åˆä¸åŒçš„æ­¥éª¤
âœ… é€æ˜æ€§ï¼šæ•°æ®æµå‘æ¸…æ™°å¯è§
```

### 1.3 ç°å®ç”Ÿæ´»ä¸­çš„æµæ°´çº¿


**é¤å…ç‚¹é¤æµæ°´çº¿**ï¼š
```
é¡¾å®¢ â†’ ç‚¹é¤ â†’ ä»˜æ¬¾ â†’ åˆ¶ä½œ â†’ æ‰“åŒ… â†’ å–é¤

æ¯ä¸ªç¯èŠ‚ï¼š
- ç‚¹é¤å‘˜ï¼šåªè´Ÿè´£è®°å½•è®¢å•
- æ”¶é“¶å‘˜ï¼šåªè´Ÿè´£æ”¶æ¬¾æ‰¾é›¶
- å¨å¸ˆï¼šåªè´Ÿè´£åˆ¶ä½œé£Ÿç‰©
- æ‰“åŒ…å‘˜ï¼šåªè´Ÿè´£åŒ…è£…
```

**å¿«é€’é…é€æµæ°´çº¿**ï¼š
```
å‘è´§ â†’ æ”¶ä»¶ â†’ åˆ†æ‹£ â†’ è¿è¾“ â†’ æ´¾é€ â†’ ç­¾æ”¶

ä¼˜åŠ¿ï¼š
- æ¯ä¸ªç¯èŠ‚ä¸“ä¸šåŒ–
- å¯ä»¥å¹¶è¡Œå¤„ç†å¤šä¸ªåŒ…è£¹
- å‡ºé—®é¢˜å®¹æ˜“å®šä½åˆ°å…·ä½“ç¯èŠ‚
```

---

## 2. ğŸ”— é“¾å¼è°ƒç”¨è®¾è®¡


### 2.1 ä»€ä¹ˆæ˜¯é“¾å¼è°ƒç”¨


**æ ¸å¿ƒæ¦‚å¿µ**ï¼šè®©å¯¹è±¡çš„æ–¹æ³•è¿”å›å¯¹è±¡è‡ªèº«ï¼Œä»è€Œå¯ä»¥è¿ç»­è°ƒç”¨å¤šä¸ªæ–¹æ³•ï¼Œå½¢æˆé“¾æ¡ã€‚

**æ™®é€šè°ƒç”¨ vs é“¾å¼è°ƒç”¨**ï¼š
```java
// æ™®é€šè°ƒç”¨ï¼ˆç¹çï¼‰
StringBuilder sb = new StringBuilder();
sb.append("Hello");
sb.append(" ");
sb.append("World");
String result = sb.toString();

// é“¾å¼è°ƒç”¨ï¼ˆä¼˜é›…ï¼‰
String result = new StringBuilder()
    .append("Hello")
    .append(" ")
    .append("World")
    .toString();
```

### 2.2 é“¾å¼è°ƒç”¨çš„å®ç°åŸç†


**å…³é”®æŠ€å·§**ï¼šæ–¹æ³•è¿”å› `this`

```java
public class Calculator {
    private int value = 0;
    
    // æ¯ä¸ªæ–¹æ³•éƒ½è¿”å›thisï¼Œæ”¯æŒé“¾å¼è°ƒç”¨
    public Calculator add(int num) {
        this.value += num;
        return this;  // å…³é”®ï¼šè¿”å›è‡ªå·±
    }
    
    public Calculator multiply(int num) {
        this.value *= num;
        return this;  // å…³é”®ï¼šè¿”å›è‡ªå·±
    }
    
    public Calculator subtract(int num) {
        this.value -= num;
        return this;  // å…³é”®ï¼šè¿”å›è‡ªå·±
    }
    
    public int getResult() {
        return this.value;
    }
}

// ä½¿ç”¨é“¾å¼è°ƒç”¨
int result = new Calculator()
    .add(10)        // 0 + 10 = 10
    .multiply(2)    // 10 * 2 = 20
    .subtract(5)    // 20 - 5 = 15
    .getResult();   // è¿”å› 15
```

### 2.3 é“¾å¼è°ƒç”¨çš„ä¼˜åŠ¿


**ä»£ç æ›´æ¸…æ™°**ï¼š
```java
// ä¸ä½¿ç”¨é“¾å¼è°ƒç”¨
Student student = new Student();
student.setName("å¼ ä¸‰");
student.setAge(20);
student.setGrade("å¤§äºŒ");
student.setMajor("è®¡ç®—æœº");

// ä½¿ç”¨é“¾å¼è°ƒç”¨
Student student = new Student()
    .setName("å¼ ä¸‰")
    .setAge(20)
    .setGrade("å¤§äºŒ")
    .setMajor("è®¡ç®—æœº");
```

**æ“ä½œæ­¥éª¤æ›´ç›´è§‚**ï¼š
```java
// æ–‡ä»¶å¤„ç†é“¾å¼è°ƒç”¨
String content = FileProcessor.create()
    .readFile("input.txt")     // è¯»å–æ–‡ä»¶
    .removeEmptyLines()        // å»é™¤ç©ºè¡Œ
    .convertToUpperCase()      // è½¬å¤§å†™
    .replaceSpaces()           // æ›¿æ¢ç©ºæ ¼
    .saveToFile("output.txt")  // ä¿å­˜æ–‡ä»¶
    .getContent();             // è·å–å†…å®¹
```

### 2.4 è®¾è®¡é“¾å¼è°ƒç”¨çš„æ³¨æ„äº‹é¡¹


**è¿”å›ç±»å‹è¦ç»Ÿä¸€**ï¼š
```java
public class StringProcessor {
    private String text;
    
    public StringProcessor(String text) {
        this.text = text;
    }
    
    // æ‰€æœ‰å¤„ç†æ–¹æ³•éƒ½è¿”å›StringProcessorç±»å‹
    public StringProcessor trim() {
        this.text = this.text.trim();
        return this;
    }
    
    public StringProcessor toUpperCase() {
        this.text = this.text.toUpperCase();
        return this;
    }
    
    // æœ€ç»ˆè·å–ç»“æœçš„æ–¹æ³•
    public String build() {
        return this.text;
    }
}
```

**æ–¹æ³•å‘½åè¦æ¸…æ™°**ï¼š
```java
// âœ… å¥½çš„å‘½å
user.setName("å¼ ä¸‰").setAge(20).build();

// âŒ ä¸å¥½çš„å‘½å
user.n("å¼ ä¸‰").a(20).get();
```

---

## 3. ğŸŒŠ Stream APIåº”ç”¨


### 3.1 ä»€ä¹ˆæ˜¯Stream API


**æ ¸å¿ƒæ¦‚å¿µ**ï¼šStreamæ˜¯Java 8å¼•å…¥çš„æ•°æ®å¤„ç†æµæ°´çº¿ï¼Œè®©æˆ‘ä»¬å¯ä»¥ç”¨æµæ°´çº¿çš„æ–¹å¼å¤„ç†é›†åˆæ•°æ®ã€‚

**ä¼ ç»Ÿæ–¹å¼ vs Streamæ–¹å¼**ï¼š
```java
List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);

// ä¼ ç»Ÿæ–¹å¼ï¼šæ‰¾å‡ºå¶æ•°å¹¶æ±‚å’Œ
int sum = 0;
for (Integer num : numbers) {
    if (num % 2 == 0) {  // ç­›é€‰å¶æ•°
        sum += num;      // ç´¯åŠ 
    }
}

// Streamæ–¹å¼ï¼šæµæ°´çº¿å¤„ç†
int sum = numbers.stream()
    .filter(num -> num % 2 == 0)  // ç­›é€‰å¶æ•°
    .mapToInt(Integer::intValue)  // è½¬æ¢ç±»å‹
    .sum();                       // æ±‚å’Œ
```

### 3.2 Streamçš„æµæ°´çº¿ç»“æ„


```
æ•°æ®æº â†’ ä¸­é—´æ“ä½œ1 â†’ ä¸­é—´æ“ä½œ2 â†’ ç»ˆç«¯æ“ä½œ â†’ ç»“æœ

ä¾‹å¦‚ï¼š
List<String> â†’ filter() â†’ map() â†’ collect() â†’ List<String>
 åŸå§‹æ•°æ®      ç­›é€‰       è½¬æ¢      æ”¶é›†        æœ€ç»ˆç»“æœ
```

**ä¸‰ç§æ“ä½œç±»å‹**ï¼š

| æ“ä½œç±»å‹ | **ä½œç”¨** | **ç‰¹ç‚¹** | **å¸¸ç”¨æ–¹æ³•** |
|---------|---------|---------|-------------|
| **æ•°æ®æº** | `æä¾›æ•°æ®` | `å¼€å§‹æµæ°´çº¿` | `stream(), parallelStream()` |
| **ä¸­é—´æ“ä½œ** | `å¤„ç†è½¬æ¢æ•°æ®` | `è¿”å›æ–°çš„Streamï¼Œå¯é“¾å¼è°ƒç”¨` | `filter(), map(), sorted()` |
| **ç»ˆç«¯æ“ä½œ** | `äº§ç”Ÿæœ€ç»ˆç»“æœ` | `ç»“æŸæµæ°´çº¿ï¼Œè§¦å‘æ‰§è¡Œ` | `collect(), forEach(), reduce()` |

### 3.3 å¸¸ç”¨Streamæ“ä½œè¯¦è§£


**ç­›é€‰æ“ä½œ**ï¼š
```java
List<String> names = Arrays.asList("å¼ ä¸‰", "æå››", "ç‹äº”", "èµµå…­");

// filterï¼šç­›é€‰æ»¡è¶³æ¡ä»¶çš„å…ƒç´ 
List<String> longNames = names.stream()
    .filter(name -> name.length() > 2)  // ç­›é€‰é•¿åº¦å¤§äº2çš„åå­—
    .collect(Collectors.toList());
// ç»“æœï¼š["å¼ ä¸‰", "æå››", "ç‹äº”", "èµµå…­"] â†’ ["ç‹äº”", "èµµå…­"]
```

**è½¬æ¢æ“ä½œ**ï¼š
```java
List<String> words = Arrays.asList("hello", "world", "java");

// mapï¼šè½¬æ¢æ¯ä¸ªå…ƒç´ 
List<String> upperWords = words.stream()
    .map(String::toUpperCase)  // è½¬æ¢ä¸ºå¤§å†™
    .collect(Collectors.toList());
// ç»“æœï¼š["hello", "world", "java"] â†’ ["HELLO", "WORLD", "JAVA"]

// mapï¼šè½¬æ¢ä¸ºå…¶ä»–ç±»å‹
List<Integer> lengths = words.stream()
    .map(String::length)  // è½¬æ¢ä¸ºé•¿åº¦
    .collect(Collectors.toList());
// ç»“æœï¼š["hello", "world", "java"] â†’ [5, 5, 4]
```

**æ’åºæ“ä½œ**ï¼š
```java
List<Integer> numbers = Arrays.asList(3, 1, 4, 1, 5, 9);

// sortedï¼šæ’åº
List<Integer> sorted = numbers.stream()
    .sorted()  // é»˜è®¤å‡åº
    .collect(Collectors.toList());
// ç»“æœï¼š[3, 1, 4, 1, 5, 9] â†’ [1, 1, 3, 4, 5, 9]

// è‡ªå®šä¹‰æ’åº
List<Integer> descSorted = numbers.stream()
    .sorted((a, b) -> b - a)  // é™åº
    .collect(Collectors.toList());
```

### 3.4 å¤æ‚çš„Streamæµæ°´çº¿ç¤ºä¾‹


**å­¦ç”Ÿæˆç»©å¤„ç†**ï¼š
```java
class Student {
    private String name;
    private int score;
    // æ„é€ å™¨å’Œgetterçœç•¥
}

List<Student> students = Arrays.asList(
    new Student("å¼ ä¸‰", 85),
    new Student("æå››", 92),
    new Student("ç‹äº”", 78),
    new Student("èµµå…­", 95)
);

// å¤æ‚æµæ°´çº¿ï¼šæ‰¾å‡ºæˆç»©å¤§äº80çš„å­¦ç”Ÿå§“åï¼ŒæŒ‰æˆç»©é™åºæ’åˆ—
List<String> topStudents = students.stream()
    .filter(s -> s.getScore() > 80)           // ç­›é€‰ï¼šæˆç»©>80
    .sorted((s1, s2) -> s2.getScore() - s1.getScore())  // æ’åºï¼šæŒ‰æˆç»©é™åº
    .map(Student::getName)                    // è½¬æ¢ï¼šæå–å§“å
    .collect(Collectors.toList());            // æ”¶é›†ï¼šè½¬ä¸ºList

// æµæ°´çº¿æ‰§è¡Œè¿‡ç¨‹ï¼š
// åŸå§‹æ•°æ® â†’ ç­›é€‰å â†’ æ’åºå â†’ æå–å§“åå
// [å¼ ä¸‰:85, æå››:92, ç‹äº”:78, èµµå…­:95] 
// â†’ [å¼ ä¸‰:85, æå››:92, èµµå…­:95] 
// â†’ [èµµå…­:95, æå››:92, å¼ ä¸‰:85] 
// â†’ ["èµµå…­", "æå››", "å¼ ä¸‰"]
```

---

## 4. ğŸ”§ Pipelineæ¨¡å¼å®ç°


### 4.1 ä»€ä¹ˆæ˜¯Pipelineæ¨¡å¼


**æ ¸å¿ƒæ¦‚å¿µ**ï¼šPipelineï¼ˆç®¡é“ï¼‰æ¨¡å¼æ˜¯æµæ°´çº¿æ€ç»´çš„å…·ä½“å®ç°ï¼Œé€šè¿‡ç»„åˆå¤šä¸ªå¤„ç†æ­¥éª¤æ¥å®Œæˆå¤æ‚çš„æ•°æ®å¤„ç†ä»»åŠ¡ã€‚

```
Pipelineæ¨¡å¼ç»“æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¾“å…¥   â”‚â”€â”€â”€â–¶â”‚ Stage1  â”‚â”€â”€â”€â–¶â”‚ Stage2  â”‚â”€â”€â”€â–¶â”‚  è¾“å‡º   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â–²              â–²              â–²
                   â”‚              â”‚              â”‚
               å¤„ç†æ­¥éª¤1        å¤„ç†æ­¥éª¤2        å¤„ç†æ­¥éª¤3
```

### 4.2 Pipelineæ¨¡å¼çš„åŸºç¡€å®ç°


**å®šä¹‰å¤„ç†æ­¥éª¤æ¥å£**ï¼š
```java
// å¤„ç†æ­¥éª¤çš„é€šç”¨æ¥å£
public interface PipelineStage<T> {
    T process(T input);  // å¤„ç†è¾“å…¥ï¼Œè¿”å›è¾“å‡º
}
```

**å®ç°å…·ä½“çš„å¤„ç†æ­¥éª¤**ï¼š
```java
// æ–‡æœ¬å¤„ç†æ­¥éª¤1ï¼šå»é™¤ç©ºæ ¼
public class TrimStage implements PipelineStage<String> {
    @Override
    public String process(String input) {
        return input.trim();
    }
}

// æ–‡æœ¬å¤„ç†æ­¥éª¤2ï¼šè½¬æ¢å¤§å†™
public class UpperCaseStage implements PipelineStage<String> {
    @Override
    public String process(String input) {
        return input.toUpperCase();
    }
}

// æ–‡æœ¬å¤„ç†æ­¥éª¤3ï¼šæ·»åŠ å‰ç¼€
public class AddPrefixStage implements PipelineStage<String> {
    private String prefix;
    
    public AddPrefixStage(String prefix) {
        this.prefix = prefix;
    }
    
    @Override
    public String process(String input) {
        return prefix + input;
    }
}
```

**Pipelineç®¡é“ç±»**ï¼š
```java
public class Pipeline<T> {
    private List<PipelineStage<T>> stages = new ArrayList<>();
    
    // æ·»åŠ å¤„ç†æ­¥éª¤
    public Pipeline<T> addStage(PipelineStage<T> stage) {
        stages.add(stage);
        return this;  // æ”¯æŒé“¾å¼è°ƒç”¨
    }
    
    // æ‰§è¡Œæ•´ä¸ªç®¡é“
    public T execute(T input) {
        T result = input;
        for (PipelineStage<T> stage : stages) {
            result = stage.process(result);  // ä¾æ¬¡æ‰§è¡Œæ¯ä¸ªæ­¥éª¤
        }
        return result;
    }
}
```

**ä½¿ç”¨Pipeline**ï¼š
```java
// æ„å»ºæ–‡æœ¬å¤„ç†ç®¡é“
Pipeline<String> textPipeline = new Pipeline<String>()
    .addStage(new TrimStage())           // æ­¥éª¤1ï¼šå»ç©ºæ ¼
    .addStage(new UpperCaseStage())      // æ­¥éª¤2ï¼šè½¬å¤§å†™
    .addStage(new AddPrefixStage(">>>"));// æ­¥éª¤3ï¼šåŠ å‰ç¼€

// å¤„ç†æ–‡æœ¬
String input = "  hello world  ";
String result = textPipeline.execute(input);
// æ‰§è¡Œè¿‡ç¨‹ï¼š
// "  hello world  " â†’ "hello world" â†’ "HELLO WORLD" â†’ ">>>HELLO WORLD"
```

### 4.3 æ›´çµæ´»çš„Pipelineå®ç°


**æ”¯æŒä¸åŒç±»å‹è½¬æ¢çš„Pipeline**ï¼š
```java
public class FlexiblePipeline {
    private Object currentData;
    
    public FlexiblePipeline(Object initialData) {
        this.currentData = initialData;
    }
    
    // é€šç”¨å¤„ç†æ–¹æ³•
    public <T, R> FlexiblePipeline process(Function<T, R> processor) {
        this.currentData = processor.apply((T) this.currentData);
        return this;
    }
    
    // è·å–æœ€ç»ˆç»“æœ
    public <T> T getResult() {
        return (T) this.currentData;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
String result = new FlexiblePipeline("123")
    .process((String s) -> Integer.parseInt(s))    // String â†’ Integer
    .process((Integer i) -> i * 2)                 // Integer â†’ Integer
    .process((Integer i) -> "Result: " + i)        // Integer â†’ String
    .getResult();
// ç»“æœï¼š"Result: 246"
```

### 4.4 Pipelineæ¨¡å¼çš„ä¼˜åŠ¿


**èŒè´£åˆ†ç¦»**ï¼š
```java
// æ¯ä¸ªæ­¥éª¤åªè´Ÿè´£ä¸€ä»¶äº‹
class ValidateStage implements PipelineStage<User> {
    public User process(User user) {
        if (user.getName() == null) {
            throw new IllegalArgumentException("å§“åä¸èƒ½ä¸ºç©º");
        }
        return user;
    }
}

class FormatStage implements PipelineStage<User> {
    public User process(User user) {
        user.setName(user.getName().trim().toLowerCase());
        return user;
    }
}
```

**æ˜“äºæµ‹è¯•**ï¼š
```java
// å¯ä»¥å•ç‹¬æµ‹è¯•æ¯ä¸ªæ­¥éª¤
@Test
public void testTrimStage() {
    TrimStage stage = new TrimStage();
    String result = stage.process("  hello  ");
    assertEquals("hello", result);
}
```

**å¯é‡ç”¨ç»„åˆ**ï¼š
```java
// ä¸åŒçš„ä¸šåŠ¡åœºæ™¯å¯ä»¥ç»„åˆä¸åŒçš„æ­¥éª¤
Pipeline<String> emailPipeline = new Pipeline<String>()
    .addStage(new TrimStage())
    .addStage(new LowerCaseStage())
    .addStage(new ValidateEmailStage());

Pipeline<String> usernamePipeline = new Pipeline<String>()
    .addStage(new TrimStage())
    .addStage(new RemoveSpecialCharsStage())
    .addStage(new ValidateUsernameStage());
```

---

## 5. ğŸ¯ å®æˆ˜æ¡ˆä¾‹åˆ†æ


### 5.1 æ¡ˆä¾‹1ï¼šæ—¥å¿—å¤„ç†æµæ°´çº¿


**éœ€æ±‚**ï¼šå¤„ç†ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶ï¼Œæå–é”™è¯¯ä¿¡æ¯å¹¶ç”ŸæˆæŠ¥å‘Šã€‚

**ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜**ï¼š
```java
// ä¼ ç»Ÿæ–¹å¼ï¼šæ‰€æœ‰é€»è¾‘æ··åœ¨ä¸€èµ·
public List<ErrorReport> processLogs(List<String> logLines) {
    List<ErrorReport> reports = new ArrayList<>();
    
    for (String line : logLines) {
        // è§£ææ—¥å¿—
        if (line.contains("ERROR")) {
            String[] parts = line.split(" ");
            String timestamp = parts[0];
            String level = parts[1];
            String message = parts[2];
            
            // æ ¼å¼åŒ–æ—¶é—´
            LocalDateTime time = LocalDateTime.parse(timestamp);
            
            // åˆ†ç±»é”™è¯¯
            String category = categorizeError(message);
            
            // ç»Ÿè®¡ä¿¡æ¯
            ErrorReport report = new ErrorReport(time, category, message);
            reports.add(report);
        }
    }
    
    return reports;
}
```

**æµæ°´çº¿æ–¹å¼çš„è§£å†³æ–¹æ¡ˆ**ï¼š
```java
// æ­¥éª¤1ï¼šè¿‡æ»¤é”™è¯¯æ—¥å¿—
class FilterErrorLogsStage implements PipelineStage<List<String>> {
    public List<String> process(List<String> logLines) {
        return logLines.stream()
            .filter(line -> line.contains("ERROR"))
            .collect(Collectors.toList());
    }
}

// æ­¥éª¤2ï¼šè§£ææ—¥å¿—æ ¼å¼
class ParseLogStage implements PipelineStage<List<String>> {
    public List<LogEntry> process(List<String> errorLines) {
        return errorLines.stream()
            .map(this::parseLogLine)
            .collect(Collectors.toList());
    }
    
    private LogEntry parseLogLine(String line) {
        String[] parts = line.split(" ", 3);
        return new LogEntry(parts[0], parts[1], parts[2]);
    }
}

// æ­¥éª¤3ï¼šè½¬æ¢ä¸ºæŠ¥å‘Š
class GenerateReportStage implements PipelineStage<List<LogEntry>> {
    public List<ErrorReport> process(List<LogEntry> entries) {
        return entries.stream()
            .map(this::createReport)
            .collect(Collectors.toList());
    }
    
    private ErrorReport createReport(LogEntry entry) {
        LocalDateTime time = LocalDateTime.parse(entry.getTimestamp());
        String category = categorizeError(entry.getMessage());
        return new ErrorReport(time, category, entry.getMessage());
    }
}

// ä½¿ç”¨æµæ°´çº¿å¤„ç†
Pipeline<List<String>> logPipeline = new Pipeline<List<String>>()
    .addStage(new FilterErrorLogsStage())   // è¿‡æ»¤é”™è¯¯æ—¥å¿—
    .addStage(new ParseLogStage())          // è§£ææ—¥å¿—æ ¼å¼
    .addStage(new GenerateReportStage());   // ç”ŸæˆæŠ¥å‘Š

List<ErrorReport> reports = logPipeline.execute(logLines);
```

**æµæ°´çº¿æ–¹å¼çš„ä¼˜åŠ¿**ï¼š
- **èŒè´£æ¸…æ™°**ï¼šæ¯ä¸ªæ­¥éª¤åªåšä¸€ä»¶äº‹
- **æ˜“äºæµ‹è¯•**ï¼šå¯ä»¥å•ç‹¬æµ‹è¯•æ¯ä¸ªæ­¥éª¤
- **æ˜“äºä¿®æ”¹**ï¼šä¿®æ”¹æŸä¸ªæ­¥éª¤ä¸å½±å“å…¶ä»–æ­¥éª¤
- **å¯é‡ç”¨**ï¼šæ­¥éª¤å¯ä»¥åœ¨å…¶ä»–åœºæ™¯å¤ç”¨

### 5.2 æ¡ˆä¾‹2ï¼šæ•°æ®è½¬æ¢æµæ°´çº¿


**éœ€æ±‚**ï¼šå°†CSVæ•°æ®è½¬æ¢ä¸ºJSONæ ¼å¼ï¼Œå¹¶è¿›è¡Œæ•°æ®æ¸…æ´—ã€‚

**Stream APIå®ç°**ï¼š
```java
public class DataTransformPipeline {
    
    public List<Map<String, Object>> processCSVData(List<String> csvLines) {
        return csvLines.stream()
            .skip(1)                           // è·³è¿‡æ ‡é¢˜è¡Œ
            .filter(line -> !line.trim().isEmpty())  // è¿‡æ»¤ç©ºè¡Œ
            .map(this::parseCSVLine)           // è§£æCSVè¡Œ
            .filter(Objects::nonNull)          // è¿‡æ»¤è§£æå¤±è´¥çš„è¡Œ
            .map(this::cleanData)              // æ¸…æ´—æ•°æ®
            .map(this::convertToMap)           // è½¬æ¢ä¸ºMap
            .collect(Collectors.toList());     // æ”¶é›†ç»“æœ
    }
    
    private String[] parseCSVLine(String line) {
        try {
            return line.split(",");
        } catch (Exception e) {
            return null;  // è§£æå¤±è´¥è¿”å›null
        }
    }
    
    private String[] cleanData(String[] fields) {
        return Arrays.stream(fields)
            .map(String::trim)                 // å»é™¤ç©ºæ ¼
            .map(field -> field.isEmpty() ? "N/A" : field)  // ç©ºå€¼æ›¿æ¢
            .toArray(String[]::new);
    }
    
    private Map<String, Object> convertToMap(String[] fields) {
        Map<String, Object> map = new HashMap<>();
        map.put("name", fields[0]);
        map.put("age", Integer.parseInt(fields[1]));
        map.put("email", fields[2]);
        return map;
    }
}
```

**å¤„ç†æµç¨‹ç¤ºä¾‹**ï¼š
```java
List<String> csvData = Arrays.asList(
    "name,age,email",
    "å¼ ä¸‰,25,zhangsan@email.com",
    "æå››,,lisi@email.com",          // å¹´é¾„ä¸ºç©º
    "",                               // ç©ºè¡Œ
    "ç‹äº”,30,wangwu@email.com"
);

List<Map<String, Object>> result = new DataTransformPipeline()
    .processCSVData(csvData);

// å¤„ç†è¿‡ç¨‹ï¼š
// 1. skip(1): è·³è¿‡æ ‡é¢˜è¡Œ
// 2. filter: è¿‡æ»¤ç©ºè¡Œ
// 3. map: è§£æCSVè¡Œ
// 4. filter: è¿‡æ»¤è§£æå¤±è´¥çš„è¡Œ
// 5. map: æ¸…æ´—æ•°æ®ï¼ˆç©ºå€¼å˜ä¸º"N/A"ï¼‰
// 6. map: è½¬æ¢ä¸ºMapæ ¼å¼
// 7. collect: æ”¶é›†æœ€ç»ˆç»“æœ
```

### 5.3 æ¡ˆä¾‹3ï¼šé“¾å¼è°ƒç”¨æ„å»ºå™¨æ¨¡å¼


**éœ€æ±‚**ï¼šæ„å»ºå¤æ‚çš„HTTPè¯·æ±‚é…ç½®ã€‚

```java
public class HttpRequestBuilder {
    private String url;
    private String method = "GET";
    private Map<String, String> headers = new HashMap<>();
    private Map<String, String> params = new HashMap<>();
    private String body;
    
    // è®¾ç½®URL
    public HttpRequestBuilder url(String url) {
        this.url = url;
        return this;
    }
    
    // è®¾ç½®è¯·æ±‚æ–¹æ³•
    public HttpRequestBuilder method(String method) {
        this.method = method;
        return this;
    }
    
    // æ·»åŠ è¯·æ±‚å¤´
    public HttpRequestBuilder header(String key, String value) {
        this.headers.put(key, value);
        return this;
    }
    
    // æ·»åŠ å‚æ•°
    public HttpRequestBuilder param(String key, String value) {
        this.params.put(key, value);
        return this;
    }
    
    // è®¾ç½®è¯·æ±‚ä½“
    public HttpRequestBuilder body(String body) {
        this.body = body;
        return this;
    }
    
    // æ„å»ºæœ€ç»ˆè¯·æ±‚
    public HttpRequest build() {
        return new HttpRequest(url, method, headers, params, body);
    }
}

// ä½¿ç”¨é“¾å¼è°ƒç”¨æ„å»ºHTTPè¯·æ±‚
HttpRequest request = new HttpRequestBuilder()
    .url("https://api.example.com/users")
    .method("POST")
    .header("Content-Type", "application/json")
    .header("Authorization", "Bearer token123")
    .param("page", "1")
    .param("size", "10")
    .body("{\"name\":\"å¼ ä¸‰\",\"age\":25}")
    .build();
```

**é“¾å¼è°ƒç”¨çš„å¥½å¤„**ï¼š
- **é…ç½®æ¸…æ™°**ï¼šæ¯ä¸ªæ–¹æ³•å¯¹åº”ä¸€ä¸ªé…ç½®é¡¹
- **é¡ºåºçµæ´»**ï¼šå¯ä»¥ä»»æ„è°ƒæ•´é…ç½®é¡ºåº
- **ä»£ç ç®€æ´**ï¼šé¿å…äº†å¤šè¡Œèµ‹å€¼è¯­å¥
- **æ˜“äºç†è§£**ï¼šè¯»èµ·æ¥åƒè‡ªç„¶è¯­è¨€

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æµæ°´çº¿æ€ç»´ï¼šå°†å¤æ‚å¤„ç†æ‹†åˆ†ä¸ºç®€å•æ­¥éª¤çš„è®¾è®¡æ€è·¯
ğŸ”¸ é“¾å¼è°ƒç”¨ï¼šé€šè¿‡è¿”å›thiså®ç°æ–¹æ³•è¿ç»­è°ƒç”¨çš„æŠ€å·§
ğŸ”¸ Stream APIï¼šJavaå‡½æ•°å¼ç¼–ç¨‹çš„æ•°æ®å¤„ç†æµæ°´çº¿
ğŸ”¸ Pipelineæ¨¡å¼ï¼šæµæ°´çº¿æ€ç»´çš„å…·ä½“å®ç°æ¨¡å¼
ğŸ”¸ æ•°æ®æµå‘ï¼šä»è¾“å…¥åˆ°è¾“å‡ºçš„å•å‘å¤„ç†æµç¨‹
```

### 6.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æµæ°´çº¿æ€ç»´çš„æœ¬è´¨**
```
æ ¸å¿ƒåŸåˆ™ï¼š
- åˆ†è§£å¤æ‚æ€§ï¼šæŠŠå¤æ‚é—®é¢˜æ‹†è§£æˆç®€å•æ­¥éª¤
- å•ä¸€èŒè´£ï¼šæ¯ä¸ªæ­¥éª¤åªåšä¸€ä»¶äº‹æƒ…
- å¯ç»„åˆæ€§ï¼šæ­¥éª¤å¯ä»¥çµæ´»ç»„åˆ
- æ•°æ®æµåŠ¨ï¼šæ•°æ®ä»ä¸€ä¸ªæ­¥éª¤æµå‘ä¸‹ä¸€ä¸ªæ­¥éª¤
```

**ğŸ”¹ é“¾å¼è°ƒç”¨vsæ™®é€šè°ƒç”¨**
```
æ™®é€šè°ƒç”¨çš„é—®é¢˜ï¼š
- ä»£ç å†—ä½™ï¼šéœ€è¦é‡å¤å†™å˜é‡å
- æ­¥éª¤åˆ†æ•£ï¼šæ“ä½œæ­¥éª¤ä¸è¿è´¯
- éš¾ä»¥ç†è§£ï¼šç¼ºä¹æµç¨‹æ„Ÿ

é“¾å¼è°ƒç”¨çš„ä¼˜åŠ¿ï¼š
- ä»£ç ç®€æ´ï¼šä¸€è¡Œå®Œæˆå¤šä¸ªæ“ä½œ
- æµç¨‹æ¸…æ™°ï¼šæ“ä½œæ­¥éª¤ä¸€ç›®äº†ç„¶
- æ˜“äºç†è§£ï¼šè¯»èµ·æ¥åƒè‡ªç„¶è¯­è¨€
```

**ğŸ”¹ Stream APIçš„å¨åŠ›**
```
ä¼ ç»Ÿå¾ªç¯çš„å±€é™ï¼š
- é€»è¾‘æ··åˆï¼šç­›é€‰ã€è½¬æ¢ã€æ”¶é›†æ··åœ¨ä¸€èµ·
- éš¾ä»¥å¹¶è¡Œï¼šæ— æ³•å……åˆ†åˆ©ç”¨å¤šæ ¸CPU
- ä»£ç å†—é•¿ï¼šéœ€è¦å†™å¾ˆå¤šæ ·æ¿ä»£ç 

Streamçš„ä¼˜åŠ¿ï¼š
- å£°æ˜å¼ç¼–ç¨‹ï¼šä¸“æ³¨äºåšä»€ä¹ˆï¼Œè€Œä¸æ˜¯æ€ä¹ˆåš
- å‡½æ•°å¼é£æ ¼ï¼šä»£ç æ›´ç®€æ´æ˜“è¯»
- å»¶è¿Ÿæ‰§è¡Œï¼šåªæœ‰ç»ˆç«¯æ“ä½œæ—¶æ‰çœŸæ­£æ‰§è¡Œ
- å¹¶è¡Œæ”¯æŒï¼šè½»æ¾å®ç°å¹¶è¡Œå¤„ç†
```

### 6.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ é€‚ç”¨åœºæ™¯**
- **æ•°æ®å¤„ç†**ï¼šETLè¿‡ç¨‹ã€æ–‡ä»¶å¤„ç†ã€æ ¼å¼è½¬æ¢
- **APIè®¾è®¡**ï¼šæ„å»ºå™¨æ¨¡å¼ã€é…ç½®é“¾å¼è°ƒç”¨
- **ä¸šåŠ¡æµç¨‹**ï¼šè®¢å•å¤„ç†ã€ç”¨æˆ·æ³¨å†Œã€å®¡æ‰¹æµç¨‹
- **ä¸­é—´ä»¶**ï¼šè¯·æ±‚å¤„ç†ç®¡é“ã€æ¶ˆæ¯å¤„ç†é“¾

**ğŸ”§ å®è·µå»ºè®®**
- **ä»ç®€å•å¼€å§‹**ï¼šå…ˆç”¨ç®€å•çš„é“¾å¼è°ƒç”¨ï¼Œå†é€æ­¥ä½¿ç”¨å¤æ‚çš„Pipeline
- **ä¿æŒçº¯å‡€**ï¼šæ¯ä¸ªæ­¥éª¤é¿å…å‰¯ä½œç”¨ï¼Œä¾¿äºæµ‹è¯•å’Œè°ƒè¯•
- **é”™è¯¯å¤„ç†**ï¼šè€ƒè™‘æ¯ä¸ªæ­¥éª¤å¯èƒ½çš„å¼‚å¸¸æƒ…å†µ
- **æ€§èƒ½è€ƒè™‘**ï¼šé¿å…è¿‡åº¦åŒ…è£…ï¼Œä¿æŒåˆç†çš„æ€§èƒ½

### 6.4 è®¾è®¡åŸåˆ™


**ğŸ—ï¸ æµæ°´çº¿è®¾è®¡åŸåˆ™**
```
å•ä¸€èŒè´£åŸåˆ™ï¼š
- æ¯ä¸ªæ­¥éª¤åªåšä¸€ä»¶äº‹
- ä¾¿äºç†è§£å’Œç»´æŠ¤

å¼€æ”¾å°é—­åŸåˆ™ï¼š
- å¯¹æ‰©å±•å¼€æ”¾ï¼šå¯ä»¥æ·»åŠ æ–°æ­¥éª¤
- å¯¹ä¿®æ”¹å°é—­ï¼šä¸å½±å“ç°æœ‰æ­¥éª¤

ä¾èµ–å€’ç½®åŸåˆ™ï¼š
- ä¾èµ–æŠ½è±¡æ¥å£ï¼Œä¸ä¾èµ–å…·ä½“å®ç°
- ä¾¿äºæ›¿æ¢å’Œæµ‹è¯•
```

**âš¡ æ€§èƒ½ä¼˜åŒ–è¦ç‚¹**
```
åˆç†ä½¿ç”¨ï¼š
- å°æ•°æ®é‡ï¼šç®€å•å¾ªç¯å¯èƒ½æ›´é«˜æ•ˆ
- å¤§æ•°æ®é‡ï¼šStreamå¹¶è¡Œæµå¨åŠ›å·¨å¤§
- å¤æ‚å¤„ç†ï¼šPipelineæ¨¡å¼ç»“æ„æ¸…æ™°

é¿å…è¿‡åº¦ï¼š
- ä¸è¦ä¸ºäº†é“¾å¼è€Œé“¾å¼
- è€ƒè™‘ä»£ç å¯è¯»æ€§
- å¹³è¡¡æ€§èƒ½å’Œä¼˜é›…æ€§
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- æµæ°´çº¿æ€ç»´åŒ–ç¹ä¸ºç®€ï¼Œæ­¥éª¤æ¸…æ™°èŒè´£å•ä¸€
- é“¾å¼è°ƒç”¨ä¼˜é›…ç®€æ´ï¼Œè¿”å›thisæ˜¯å…³é”®
- Stream APIå£°æ˜å¼ç¼–ç¨‹ï¼Œå‡½æ•°å¼é£æ ¼å¨åŠ›å¤§
- Pipelineæ¨¡å¼çµæ´»ç»„åˆï¼Œå¯æµ‹è¯•å¯ç»´æŠ¤