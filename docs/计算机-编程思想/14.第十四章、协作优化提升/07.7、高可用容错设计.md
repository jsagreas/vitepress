---
title: 7ã€é«˜å¯ç”¨å®¹é”™è®¾è®¡
---
## ğŸ“š ç›®å½•

1. [é«˜å¯ç”¨åŸåˆ™](#1-é«˜å¯ç”¨åŸåˆ™)
2. [å®¹é”™ç­–ç•¥](#2-å®¹é”™ç­–ç•¥)
3. [æ•…éšœéš”ç¦»](#3-æ•…éšœéš”ç¦»)
4. [è‡ªæ„ˆèƒ½åŠ›](#4-è‡ªæ„ˆèƒ½åŠ›)
5. [å®¹é”™éªŒè¯](#5-å®¹é”™éªŒè¯)
6. [é«˜å¯ç”¨å®è·µ](#6-é«˜å¯ç”¨å®è·µ)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ é«˜å¯ç”¨åŸåˆ™


### 1.1 ä»€ä¹ˆæ˜¯é«˜å¯ç”¨æ€§


**ğŸ’¡ é€šä¿—ç†è§£**ï¼šé«˜å¯ç”¨å°±åƒåŸå¸‚çš„ä¾›ç”µç³»ç»Ÿï¼Œå³ä½¿æŸä¸ªå‘ç”µå‚å‡ºäº†é—®é¢˜ï¼Œæ•´ä¸ªåŸå¸‚çš„ç”µåŠ›ä¾›åº”ä¹Ÿä¸ä¼šä¸­æ–­ã€‚

```
ç”Ÿæ´»ä¸­çš„é«˜å¯ç”¨ä¾‹å­ï¼š
åŒ»é™¢ï¼šå¤šä¸ªç§‘å®¤ã€å¤šä¸ªåŒ»ç”Ÿï¼ŒæŸä¸ªåŒ»ç”Ÿè¯·å‡ä¸å½±å“çœ‹ç—…
é“¶è¡Œï¼šå¤šä¸ªç½‘ç‚¹ã€å¤šå°ATMï¼ŒæŸå°æœºå™¨åäº†è¿˜èƒ½æ­£å¸¸å–é’±
ç”µå•†ï¼šå¤šä¸ªä»“åº“ã€å¤šæ¡ç‰©æµï¼ŒæŸä¸ªä»“åº“å‡ºé—®é¢˜è¿˜èƒ½æ­£å¸¸å‘è´§

ç³»ç»Ÿé«˜å¯ç”¨å°±æ˜¯è¿™ä¸ªé“ç†ï¼šç¡®ä¿æœåŠ¡æŒç»­å¯ç”¨ï¼
```

### 1.2 é«˜å¯ç”¨çš„æ ¸å¿ƒåŸåˆ™


**ğŸ”¸ æ¶ˆé™¤å•ç‚¹æ•…éšœ**
```
é”™è¯¯åšæ³•ï¼šåªæœ‰ä¸€å°æœåŠ¡å™¨
ç”¨æˆ· â†’ æœåŠ¡å™¨A (å¦‚æœAæŒ‚äº†ï¼ŒæœåŠ¡å°±ä¸å¯ç”¨äº†)

æ­£ç¡®åšæ³•ï¼šå¤šå°æœåŠ¡å™¨å¤‡ä»½
ç”¨æˆ· â†’ è´Ÿè½½å‡è¡¡å™¨ â†’ [æœåŠ¡å™¨A, æœåŠ¡å™¨B, æœåŠ¡å™¨C]
```

**ğŸ”¸ å†—ä½™å¤‡ä»½**
- **å®šä¹‰**ï¼šå‡†å¤‡å¤šå¥—ç›¸åŒçš„è®¾å¤‡æˆ–æœåŠ¡ï¼Œä¸€å¥—å‡ºé—®é¢˜æ—¶å¦ä¸€å¥—é¡¶ä¸Š
- **ç±»æ¯”**ï¼šå°±åƒæ±½è½¦çš„å¤‡èƒï¼Œå¹³æ—¶ä¸ç”¨ä½†å…³é”®æ—¶åˆ»æ•‘å‘½

**ğŸ”¸ å¿«é€Ÿæ•…éšœæ£€æµ‹**
```java
// ç®€å•çš„å¥åº·æ£€æŸ¥æœºåˆ¶
public class HealthChecker {
    public boolean isServiceHealthy(String serviceUrl) {
        try {
            // å‘é€pingè¯·æ±‚ï¼Œæ£€æŸ¥æœåŠ¡æ˜¯å¦å“åº”
            HttpResponse response = httpClient.get(serviceUrl + "/health");
            return response.getStatusCode() == 200;
        } catch (Exception e) {
            return false; // æœåŠ¡ä¸å¯ç”¨
        }
    }
}
```

**ğŸ”¸ å¿«é€Ÿæ•…éšœæ¢å¤**
- **è‡ªåŠ¨åˆ‡æ¢**ï¼šä¸»æœåŠ¡å™¨æŒ‚äº†ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡æœåŠ¡å™¨
- **æ— æ„ŸçŸ¥åˆ‡æ¢**ï¼šç”¨æˆ·æ„Ÿè§‰ä¸åˆ°æœåŠ¡ä¸­æ–­

### 1.3 é«˜å¯ç”¨ç­‰çº§æ ‡å‡†


| å¯ç”¨æ€§ç­‰çº§ | å¹´æ•…éšœæ—¶é—´ | **é€šä¿—ç†è§£** | **åº”ç”¨åœºæ™¯** |
|-----------|-----------|-------------|-------------|
| 99% | 3.65å¤© | `å¶å°”ç»´æŠ¤ï¼Œèƒ½æ¥å—` | `ä¸ªäººç½‘ç«™` |
| 99.9% | 8.76å°æ—¶ | `ä¸€å¹´åœæœºä¸åˆ°ä¸€å¤©` | `ä¼ä¸šå®˜ç½‘` |
| 99.99% | 52.6åˆ†é’Ÿ | `ä¸€å¹´åœæœºä¸åˆ°1å°æ—¶` | `ç”µå•†ç½‘ç«™` |
| 99.999% | 5.26åˆ†é’Ÿ | `ä¸€å¹´åœæœºä¸åˆ°6åˆ†é’Ÿ` | `é“¶è¡Œç³»ç»Ÿ` |

> ğŸ’¡ **è®°å¿†æŠ€å·§**ï¼š9è¶Šå¤šè¶Šå¯é ï¼Œä½†æˆæœ¬ä¹Ÿè¶Šé«˜ã€‚å¤§éƒ¨åˆ†äº’è”ç½‘æœåŠ¡è¿½æ±‚99.9%å°±å¤Ÿäº†ã€‚

---

## 2. âš–ï¸ å®¹é”™ç­–ç•¥


### 2.1 ä»€ä¹ˆæ˜¯å®¹é”™


**ğŸ’¡ ç®€å•ç†è§£**ï¼šå®¹é”™å°±æ˜¯"å®¹å¿é”™è¯¯"ï¼Œç³»ç»ŸæŸä¸ªéƒ¨åˆ†å‡ºé—®é¢˜äº†ï¼Œæ•´ä¸ªç³»ç»Ÿè¿˜èƒ½æ­£å¸¸å·¥ä½œã€‚

```
ç”Ÿæ´»ä¸­çš„å®¹é”™ä¾‹å­ï¼š
é£æœºæœ‰å¤šä¸ªå¼•æ“ï¼Œä¸€ä¸ªåäº†è¿˜èƒ½é£
äººæœ‰ä¸¤ä¸ªè‚¾ï¼Œä¸€ä¸ªå‡ºé—®é¢˜å¦ä¸€ä¸ªè¿˜èƒ½å·¥ä½œ
æ‰‹æœºæœ‰å¤šä¸ªä¿¡å·åŸºç«™ï¼Œä¸€ä¸ªåŸºç«™æ•…éšœè¿˜èƒ½é€šè¯

ç¨‹åºçš„å®¹é”™ä¹Ÿæ˜¯è¿™ä¸ªé“ç†ï¼
```

### 2.2 ä¸»å¤‡ç­–ç•¥


**ğŸ”¸ ä¸»å¤‡æ¨¡å¼ï¼ˆActive-Passiveï¼‰**

```
æ¶æ„å›¾ç¤ºï¼š
ä¸»æœåŠ¡å™¨(å·¥ä½œä¸­) â†â†’ å¤‡æœåŠ¡å™¨(å¾…å‘½ä¸­)
      â†“                    â†‘
   å¤„ç†ç”¨æˆ·è¯·æ±‚        ä¸»æœåŠ¡å™¨æ•…éšœæ—¶æ¥ç®¡

ç‰¹ç‚¹ï¼š
âœ… å®ç°ç®€å•ï¼Œæˆæœ¬è¾ƒä½
âœ… æ•°æ®ä¸€è‡´æ€§å¥½
âŒ å¤‡æœåŠ¡å™¨èµ„æºæµªè´¹
âŒ åˆ‡æ¢æ—¶é—´ç¨é•¿
```

**ç®€å•çš„ä¸»å¤‡å®ç°**ï¼š
```java
public class MasterSlaveService {
    private boolean isMaster = true;
    private MasterSlaveService backup;
    
    public void processRequest(String request) {
        if (isMaster) {
            try {
                // ä¸»æœåŠ¡å™¨å¤„ç†è¯·æ±‚
                handleRequest(request);
            } catch (Exception e) {
                // ä¸»æœåŠ¡å™¨å‡ºé”™ï¼Œåˆ‡æ¢åˆ°å¤‡æœåŠ¡å™¨
                switchToBackup();
                backup.processRequest(request);
            }
        }
    }
    
    private void switchToBackup() {
        this.isMaster = false;
        backup.isMaster = true;
        log.info("åˆ‡æ¢åˆ°å¤‡æœåŠ¡å™¨");
    }
}
```

### 2.3 é›†ç¾¤ç­–ç•¥


**ğŸ”¸ é›†ç¾¤æ¨¡å¼ï¼ˆActive-Activeï¼‰**

```
æ¶æ„å›¾ç¤ºï¼š
         è´Ÿè½½å‡è¡¡å™¨
        /      |      \
   æœåŠ¡å™¨A   æœåŠ¡å™¨B   æœåŠ¡å™¨C
   (éƒ½åœ¨å·¥ä½œ)  (éƒ½åœ¨å·¥ä½œ)  (éƒ½åœ¨å·¥ä½œ)

ç‰¹ç‚¹ï¼š
âœ… èµ„æºåˆ©ç”¨ç‡é«˜
âœ… æ€§èƒ½å¥½ï¼Œèƒ½å¤„ç†æ›´å¤šè¯·æ±‚
âœ… æŸå°æœåŠ¡å™¨æŒ‚äº†å½±å“å°
âŒ å®ç°å¤æ‚
âŒ æ•°æ®åŒæ­¥æŒ‘æˆ˜å¤§
```

**è´Ÿè½½å‡è¡¡å®ç°ç¤ºä¾‹**ï¼š
```java
public class LoadBalancer {
    private List<Server> servers = Arrays.asList(
        new Server("192.168.1.10"),
        new Server("192.168.1.11"), 
        new Server("192.168.1.12")
    );
    private int currentIndex = 0;
    
    public Server getHealthyServer() {
        // è½®è¯¢æ‰¾åˆ°å¥åº·çš„æœåŠ¡å™¨
        for (int i = 0; i < servers.size(); i++) {
            Server server = servers.get(currentIndex);
            currentIndex = (currentIndex + 1) % servers.size();
            
            if (server.isHealthy()) {
                return server; // è¿”å›å¥åº·çš„æœåŠ¡å™¨
            }
        }
        throw new RuntimeException("æ²¡æœ‰å¯ç”¨çš„æœåŠ¡å™¨");
    }
}
```

### 2.4 è‡ªåŠ¨æ¢å¤ç­–ç•¥


**ğŸ”¸ é‡è¯•æœºåˆ¶**
```java
public class RetryService {
    private static final int MAX_RETRIES = 3;
    
    public String callRemoteService(String data) {
        for (int i = 0; i < MAX_RETRIES; i++) {
            try {
                return remoteService.call(data);
            } catch (Exception e) {
                if (i == MAX_RETRIES - 1) {
                    throw e; // é‡è¯•æ¬¡æ•°ç”¨å®Œï¼ŒæŠ›å‡ºå¼‚å¸¸
                }
                
                // ç­‰å¾…ä¸€æ®µæ—¶é—´å†é‡è¯•
                Thread.sleep(1000 * (i + 1)); // é€’å¢ç­‰å¾…æ—¶é—´
            }
        }
        return null;
    }
}
```

**ğŸ”¸ ç†”æ–­æœºåˆ¶**
```java
public class CircuitBreaker {
    private int failureCount = 0;
    private long lastFailureTime = 0;
    private final int failureThreshold = 5; // å¤±è´¥é˜ˆå€¼
    private final long timeout = 60000; // ç†”æ–­æ—¶é—´60ç§’
    
    public String callService() {
        // æ£€æŸ¥æ˜¯å¦åœ¨ç†”æ–­çŠ¶æ€
        if (isCircuitOpen()) {
            throw new RuntimeException("æœåŠ¡ç†”æ–­ä¸­ï¼Œè¯·ç¨åé‡è¯•");
        }
        
        try {
            String result = externalService.call();
            reset(); // è°ƒç”¨æˆåŠŸï¼Œé‡ç½®è®¡æ•°å™¨
            return result;
        } catch (Exception e) {
            recordFailure(); // è®°å½•å¤±è´¥
            throw e;
        }
    }
    
    private boolean isCircuitOpen() {
        return failureCount >= failureThreshold && 
               (System.currentTimeMillis() - lastFailureTime) < timeout;
    }
}
```

---

## 3. ğŸ›¡ï¸ æ•…éšœéš”ç¦»


### 3.1 ä»€ä¹ˆæ˜¯æ•…éšœéš”ç¦»


**ğŸ’¡ é€šä¿—ç†è§£**ï¼šæ•…éšœéš”ç¦»å°±åƒèˆ¹èˆ±çš„éš”æ°´èˆ±ï¼Œä¸€ä¸ªèˆ±è¿›æ°´äº†ä¸ä¼šå½±å“å…¶ä»–èˆ±ï¼Œèˆ¹è¿˜èƒ½ç»§ç»­èˆªè¡Œã€‚

```
ç”Ÿæ´»ä¸­çš„éš”ç¦»ä¾‹å­ï¼š
ç”µè·¯ï¼šæœ‰ä¿é™©ä¸ï¼ŒæŸä¸ªæˆ¿é—´çŸ­è·¯ä¸ä¼šå½±å“æ•´æ ‹æ¥¼
åŒ»é™¢ï¼šéš”ç¦»ç—…æˆ¿ï¼Œé˜²æ­¢ç–¾ç—…ä¼ æ’­
å·¥å‚ï¼šå„è½¦é—´ç‹¬ç«‹ï¼Œä¸€ä¸ªè½¦é—´åœå·¥ä¸å½±å“å…¶ä»–è½¦é—´

ç³»ç»Ÿçš„æ•…éšœéš”ç¦»ä¹Ÿæ˜¯è¿™ä¸ªé“ç†ï¼
```

### 3.2 æœåŠ¡éš”ç¦»


**ğŸ”¸ å¾®æœåŠ¡éš”ç¦»**

```
å•ä½“åº”ç”¨(é£é™©å¤§)ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·æœåŠ¡ + è®¢å•æœåŠ¡ +    â”‚
â”‚  æ”¯ä»˜æœåŠ¡ + å•†å“æœåŠ¡     â”‚  â† ä¸€ä¸ªæ¨¡å—å‡ºé”™ï¼Œæ•´ä¸ªåº”ç”¨æŒ‚æ‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¾®æœåŠ¡éš”ç¦»(é£é™©å°)ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·æœåŠ¡ â”‚ â”‚ è®¢å•æœåŠ¡ â”‚ â”‚ æ”¯ä»˜æœåŠ¡ â”‚ â”‚ å•†å“æœåŠ¡ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†‘           â†‘           â†‘           â†‘
å„æœåŠ¡ç‹¬ç«‹éƒ¨ç½²ï¼Œä¸€ä¸ªæŒ‚æ‰ä¸å½±å“å…¶ä»–æœåŠ¡
```

**æœåŠ¡é—´è°ƒç”¨çš„éš”ç¦»ä¿æŠ¤**ï¼š
```java
public class ServiceCaller {
    private CircuitBreaker circuitBreaker = new CircuitBreaker();
    
    public OrderInfo getOrderInfo(String orderId) {
        try {
            // è°ƒç”¨è®¢å•æœåŠ¡
            return circuitBreaker.call(() -> 
                orderService.getOrder(orderId)
            );
        } catch (Exception e) {
            // æœåŠ¡ä¸å¯ç”¨æ—¶çš„é™çº§å¤„ç†
            return getOrderFromCache(orderId); // ä»ç¼“å­˜è·å–
        }
    }
    
    private OrderInfo getOrderFromCache(String orderId) {
        // é™çº§æ–¹æ¡ˆï¼šè¿”å›ç¼“å­˜æ•°æ®æˆ–é»˜è®¤æ•°æ®
        return new OrderInfo(orderId, "è®¢å•ä¿¡æ¯æš‚ä¸å¯ç”¨");
    }
}
```

### 3.3 èµ„æºéš”ç¦»


**ğŸ”¸ çº¿ç¨‹æ± éš”ç¦»**
```java
public class ThreadPoolIsolation {
    // ä¸åŒä¸šåŠ¡ä½¿ç”¨ä¸åŒçš„çº¿ç¨‹æ± ï¼Œäº’ä¸å½±å“
    private ExecutorService userThreadPool = 
        Executors.newFixedThreadPool(10);
    private ExecutorService orderThreadPool = 
        Executors.newFixedThreadPool(10);
    
    public void handleUserRequest(UserRequest request) {
        userThreadPool.submit(() -> {
            // å¤„ç†ç”¨æˆ·ç›¸å…³è¯·æ±‚
            userService.process(request);
        });
    }
    
    public void handleOrderRequest(OrderRequest request) {
        orderThreadPool.submit(() -> {
            // å¤„ç†è®¢å•ç›¸å…³è¯·æ±‚
            orderService.process(request);
        });
    }
}
```

**ğŸ”¸ æ•°æ®åº“è¿æ¥æ± éš”ç¦»**
```java
public class DatabasePoolIsolation {
    // æ ¸å¿ƒä¸šåŠ¡ä½¿ç”¨ä¸“ç”¨è¿æ¥æ± 
    private DataSource coreBusinessPool = createDataSource(20, 50);
    // æŠ¥è¡¨æŸ¥è¯¢ä½¿ç”¨ç‹¬ç«‹è¿æ¥æ± 
    private DataSource reportPool = createDataSource(5, 10);
    
    public void saveCoreData(Object data) {
        try (Connection conn = coreBusinessPool.getConnection()) {
            // æ ¸å¿ƒä¸šåŠ¡æ•°æ®æ“ä½œ
        }
    }
    
    public List<ReportData> generateReport() {
        try (Connection conn = reportPool.getConnection()) {
            // æŠ¥è¡¨æŸ¥è¯¢ï¼Œä¸å½±å“æ ¸å¿ƒä¸šåŠ¡
            return queryReport(conn);
        }
    }
}
```

### 3.4 æ•…éšœä¼ æ’­é˜²æŠ¤


**ğŸ”¸ è¶…æ—¶è®¾ç½®**
```java
public class TimeoutProtection {
    private static final int TIMEOUT_SECONDS = 5;
    
    public String callExternalAPI(String request) {
        try {
            // è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œé˜²æ­¢æ— é™ç­‰å¾…
            return restTemplate.postForObject(
                "/api/external", 
                request, 
                String.class,
                Duration.ofSeconds(TIMEOUT_SECONDS)
            );
        } catch (TimeoutException e) {
            return "æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åé‡è¯•";
        }
    }
}
```

---

## 4. ğŸ”„ è‡ªæ„ˆèƒ½åŠ›


### 4.1 ä»€ä¹ˆæ˜¯ç³»ç»Ÿè‡ªæ„ˆ


**ğŸ’¡ é€šä¿—ç†è§£**ï¼šè‡ªæ„ˆå°±åƒäººä½“çš„å…ç–«ç³»ç»Ÿï¼Œå—ä¼¤äº†ä¼šè‡ªåŠ¨æ„ˆåˆï¼Œç”Ÿç—…äº†ä¼šè‡ªåŠ¨åº·å¤ã€‚

```
ç”Ÿæ´»ä¸­çš„è‡ªæ„ˆä¾‹å­ï¼š
äººä½“ï¼šå°ä¼¤å£ä¼šè‡ªåŠ¨æ„ˆåˆï¼Œæ„Ÿå†’ä¼šè‡ªåŠ¨å¥½è½¬
æ¤ç‰©ï¼šå¶å­æ¯èä¼šè‡ªåŠ¨è„±è½ï¼Œæ˜¥å¤©ä¼šé‡æ–°å‘èŠ½
ç”Ÿæ€ï¼šæ£®æ—ç«ç¾åä¼šè‡ªç„¶æ¢å¤

ç³»ç»Ÿè‡ªæ„ˆå°±æ˜¯è®©ç¨‹åºæœ‰è¿™ç§"è‡ªæˆ‘ä¿®å¤"çš„èƒ½åŠ›ï¼
```

### 4.2 å¥åº·æ£€æŸ¥æœºåˆ¶


**ğŸ”¸ åº”ç”¨å¥åº·æ£€æŸ¥**
```java
@RestController
public class HealthController {
    
    @GetMapping("/health")
    public Map<String, Object> healthCheck() {
        Map<String, Object> health = new HashMap<>();
        
        // æ£€æŸ¥æ•°æ®åº“è¿æ¥
        boolean dbHealthy = checkDatabase();
        // æ£€æŸ¥å¤–éƒ¨æœåŠ¡
        boolean externalServiceHealthy = checkExternalService();
        // æ£€æŸ¥å†…å­˜ä½¿ç”¨
        boolean memoryHealthy = checkMemory();
        
        health.put("database", dbHealthy ? "UP" : "DOWN");
        health.put("external_service", externalServiceHealthy ? "UP" : "DOWN");
        health.put("memory", memoryHealthy ? "UP" : "DOWN");
        
        // æ€»ä½“çŠ¶æ€
        boolean overall = dbHealthy && externalServiceHealthy && memoryHealthy;
        health.put("status", overall ? "UP" : "DOWN");
        
        return health;
    }
    
    private boolean checkDatabase() {
        try {
            // æ‰§è¡Œä¸€ä¸ªç®€å•çš„æ•°æ®åº“æŸ¥è¯¢
            jdbcTemplate.queryForObject("SELECT 1", Integer.class);
            return true;
        } catch (Exception e) {
            return false;
        }
    }
}
```

### 4.3 è‡ªåŠ¨é‡å¯æœºåˆ¶


**ğŸ”¸ è¿›ç¨‹ç›‘æ§å’Œé‡å¯**
```bash
# ç®€å•çš„è¿›ç¨‹ç›‘æ§è„šæœ¬
#!/bin/bash
while true; do
    # æ£€æŸ¥åº”ç”¨æ˜¯å¦è¿˜åœ¨è¿è¡Œ
    if ! pgrep -f "myapp.jar" > /dev/null; then
        echo "åº”ç”¨å·²åœæ­¢ï¼Œæ­£åœ¨é‡å¯..."
        nohup java -jar myapp.jar &
        echo "åº”ç”¨é‡å¯å®Œæˆ"
    fi
    sleep 30  # æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡
done
```

**ğŸ”¸ åº”ç”¨å†…è‡ªæ¢å¤**
```java
public class SelfHealingService {
    private ScheduledExecutorService scheduler = 
        Executors.newScheduledThreadPool(1);
    
    public void startSelfHealing() {
        // æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡ç³»ç»ŸçŠ¶æ€
        scheduler.scheduleAtFixedRate(() -> {
            checkAndHeal();
        }, 0, 1, TimeUnit.MINUTES);
    }
    
    private void checkAndHeal() {
        // æ£€æŸ¥å†…å­˜ä½¿ç”¨ç‡
        if (getMemoryUsage() > 80) {
            System.gc(); // å¼ºåˆ¶åƒåœ¾å›æ”¶
            clearCache(); // æ¸…ç†ç¼“å­˜
        }
        
        // æ£€æŸ¥è¿æ¥æ± çŠ¶æ€
        if (connectionPool.getActiveConnections() == 0) {
            connectionPool.reset(); // é‡ç½®è¿æ¥æ± 
        }
        
        // æ£€æŸ¥å¤–éƒ¨æœåŠ¡è¿æ¥
        if (!externalService.isConnected()) {
            externalService.reconnect(); // é‡è¿å¤–éƒ¨æœåŠ¡
        }
    }
}
```

### 4.4 æ•…éšœè‡ªåŠ¨è½¬ç§»


**ğŸ”¸ ä¸»å¤‡è‡ªåŠ¨åˆ‡æ¢**
```java
public class AutoFailover {
    private boolean isMaster = true;
    private String masterNodeId;
    private String backupNodeId;
    
    public void monitorMasterNode() {
        ScheduledExecutorService monitor = 
            Executors.newSingleThreadScheduledExecutor();
            
        monitor.scheduleAtFixedRate(() -> {
            if (isMaster) {
                // ä¸»èŠ‚ç‚¹å®šæœŸå‘é€å¿ƒè·³
                sendHeartbeat();
            } else {
                // å¤‡èŠ‚ç‚¹æ£€æŸ¥ä¸»èŠ‚ç‚¹æ˜¯å¦è¿˜æ´»ç€
                if (!isMasterAlive()) {
                    promoteToMaster(); // æå‡ä¸ºä¸»èŠ‚ç‚¹
                }
            }
        }, 0, 5, TimeUnit.SECONDS);
    }
    
    private void promoteToMaster() {
        this.isMaster = true;
        log.info("å¤‡èŠ‚ç‚¹æå‡ä¸ºä¸»èŠ‚ç‚¹ï¼Œå¼€å§‹å¤„ç†è¯·æ±‚");
        // å¼€å§‹æ¥ç®¡ä¸šåŠ¡å¤„ç†
        startBusinessProcessing();
    }
}
```

---

## 5. âœ… å®¹é”™éªŒè¯


### 5.1 ä»€ä¹ˆæ˜¯å®¹é”™éªŒè¯


**ğŸ’¡ é€šä¿—ç†è§£**ï¼šå®¹é”™éªŒè¯å°±åƒæ¶ˆé˜²æ¼”ä¹ ï¼Œå¹³æ—¶æ¨¡æ‹Ÿç«ç¾æƒ…å†µï¼Œæ£€éªŒé€ƒç”Ÿæ–¹æ¡ˆæ˜¯å¦æœ‰æ•ˆã€‚

```
ç”Ÿæ´»ä¸­çš„éªŒè¯ä¾‹å­ï¼š
æ¶ˆé˜²æ¼”ä¹ ï¼šæ¨¡æ‹Ÿç«ç¾ï¼Œæµ‹è¯•é€ƒç”Ÿè·¯çº¿
åœ°éœ‡æ¼”ç»ƒï¼šæ¨¡æ‹Ÿåœ°éœ‡ï¼Œæµ‹è¯•åº”æ€¥æªæ–½
å¤‡ç”¨ç”µæºæµ‹è¯•ï¼šæ–­æ‰ä¸»ç”µæºï¼Œæ£€æŸ¥å¤‡ç”¨ç”µæºæ˜¯å¦å·¥ä½œ

ç³»ç»Ÿå®¹é”™éªŒè¯å°±æ˜¯æ•…æ„åˆ¶é€ æ•…éšœï¼Œçœ‹ç³»ç»Ÿèƒ½å¦æ­£ç¡®åº”å¯¹ï¼
```

### 5.2 æ•…éšœæ³¨å…¥æµ‹è¯•


**ğŸ”¸ æ¨¡æ‹ŸæœåŠ¡ä¸å¯ç”¨**
```java
public class FaultInjectionTest {
    
    @Test
    public void testServiceUnavailable() {
        // æ¨¡æ‹Ÿå¤–éƒ¨æœåŠ¡ä¸å¯ç”¨
        mockExternalService.setUnavailable(true);
        
        // å‘é€è¯·æ±‚ï¼Œçœ‹ç³»ç»Ÿæ˜¯å¦èƒ½æ­£ç¡®é™çº§
        String result = orderService.createOrder(orderRequest);
        
        // éªŒè¯é™çº§é€»è¾‘æ˜¯å¦ç”Ÿæ•ˆ
        assertEquals("è®¢å•å·²æäº¤ï¼Œç¨åå¤„ç†", result);
    }
    
    @Test
    public void testDatabaseTimeout() {
        // æ¨¡æ‹Ÿæ•°æ®åº“è¶…æ—¶
        mockDatabase.setResponseTime(10000); // 10ç§’è¶…æ—¶
        
        // çœ‹ç³»ç»Ÿæ˜¯å¦èƒ½æ­£ç¡®å¤„ç†è¶…æ—¶
        assertThrows(TimeoutException.class, () -> {
            userService.getUserInfo("123");
        });
    }
}
```

**ğŸ”¸ æ··æ²Œå·¥ç¨‹ï¼ˆChaos Engineeringï¼‰**
```java
public class ChaosMonkey {
    private Random random = new Random();
    
    // éšæœºæ€æ‰æŸä¸ªæœåŠ¡å®ä¾‹
    public void randomKillService() {
        if (random.nextDouble() < 0.1) { // 10%æ¦‚ç‡
            String serviceToKill = pickRandomService();
            killService(serviceToKill);
            log.info("Chaos Monkeyæ€æ‰äº†æœåŠ¡: " + serviceToKill);
        }
    }
    
    // éšæœºå¢åŠ ç½‘ç»œå»¶è¿Ÿ
    public void addRandomLatency() {
        if (random.nextDouble() < 0.2) { // 20%æ¦‚ç‡
            int latency = random.nextInt(1000); // 0-1ç§’å»¶è¿Ÿ
            networkProxy.addLatency(latency);
        }
    }
}
```

### 5.3 å‹åŠ›æµ‹è¯•


**ğŸ”¸ å¹¶å‘å‹åŠ›æµ‹è¯•**
```java
public class LoadTest {
    
    @Test
    public void testHighConcurrency() throws InterruptedException {
        int threadCount = 100;
        int requestPerThread = 100;
        CountDownLatch latch = new CountDownLatch(threadCount);
        
        for (int i = 0; i < threadCount; i++) {
            new Thread(() -> {
                try {
                    for (int j = 0; j < requestPerThread; j++) {
                        // å‘é€è¯·æ±‚
                        String result = userService.login("user" + j);
                        assertNotNull(result);
                    }
                } finally {
                    latch.countDown();
                }
            }).start();
        }
        
        // ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ
        latch.await(30, TimeUnit.SECONDS);
        
        // æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦è¿˜èƒ½æ­£å¸¸å“åº”
        assertTrue(healthChecker.isSystemHealthy());
    }
}
```

### 5.4 ç›‘æ§å’Œå‘Šè­¦éªŒè¯


**ğŸ”¸ å‘Šè­¦æµ‹è¯•**
```java
public class AlertTest {
    
    @Test
    public void testErrorRateAlert() {
        // åˆ¶é€ å¤§é‡é”™è¯¯è¯·æ±‚
        for (int i = 0; i < 100; i++) {
            try {
                orderService.createOrder(invalidRequest);
            } catch (Exception e) {
                // å¿½ç•¥é”™è¯¯ï¼Œæˆ‘ä»¬å°±æ˜¯è¦åˆ¶é€ é”™è¯¯
            }
        }
        
        // ç­‰å¾…å‘Šè­¦ç³»ç»Ÿååº”
        Thread.sleep(5000);
        
        // éªŒè¯æ˜¯å¦æ”¶åˆ°å‘Šè­¦
        assertTrue(alertManager.hasAlert("HIGH_ERROR_RATE"));
    }
}
```

---

## 6. ğŸš€ é«˜å¯ç”¨å®è·µ


### 6.1 ä¸»å¤‡å®ç°æ–¹æ¡ˆ


**ğŸ”¸ æ•°æ®åº“ä¸»å¤‡**

```
æ¶æ„è®¾è®¡ï¼š
ä¸»æ•°æ®åº“ â†â†’ å¤‡æ•°æ®åº“
    â†“         â†‘
  å†™å…¥æ“ä½œ   è¯»å–æ“ä½œ (å¤‡åº“ä¹Ÿå¯ä»¥æ‰¿æ‹…è¯»è¯·æ±‚)
    
æ•°æ®åŒæ­¥ï¼šä¸»åº“çš„æ•°æ®å®æ—¶åŒæ­¥åˆ°å¤‡åº“
æ•…éšœåˆ‡æ¢ï¼šä¸»åº“æŒ‚äº†ï¼Œå¤‡åº“ç«‹å³æ¥ç®¡
```

```java
public class DatabaseFailover {
    private DataSource masterDB;
    private DataSource slaveDB;
    private boolean masterAvailable = true;
    
    public void executeQuery(String sql) {
        DataSource db = selectDatabase();
        try (Connection conn = db.getConnection()) {
            // æ‰§è¡ŒæŸ¥è¯¢
            PreparedStatement stmt = conn.prepareStatement(sql);
            stmt.executeQuery();
        } catch (Exception e) {
            if (db == masterDB) {
                // ä¸»åº“å‡ºé”™ï¼Œåˆ‡æ¢åˆ°å¤‡åº“
                masterAvailable = false;
                log.warn("ä¸»æ•°æ®åº“ä¸å¯ç”¨ï¼Œåˆ‡æ¢åˆ°å¤‡æ•°æ®åº“");
                executeQuery(sql); // é‡è¯•
            }
        }
    }
    
    private DataSource selectDatabase() {
        return masterAvailable ? masterDB : slaveDB;
    }
}
```

### 6.2 é›†ç¾¤å®ç°æ–¹æ¡ˆ


**ğŸ”¸ WebæœåŠ¡å™¨é›†ç¾¤**

```
æ¶æ„è®¾è®¡ï¼š
           è´Ÿè½½å‡è¡¡å™¨ (Nginx/LVS)
              /     |     \
         Server1  Server2  Server3
            |        |        |
        å…±äº«å­˜å‚¨ (Redis/DB) 
```

**Nginxè´Ÿè½½å‡è¡¡é…ç½®ç¤ºä¾‹**ï¼š
```nginx
upstream web_servers {
    server 192.168.1.10:8080 weight=3;
    server 192.168.1.11:8080 weight=2;
    server 192.168.1.12:8080 weight=1 backup;
}

server {
    listen 80;
    location / {
        proxy_pass http://web_servers;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        
        # å¥åº·æ£€æŸ¥
        proxy_connect_timeout 3s;
        proxy_send_timeout 10s;
        proxy_read_timeout 10s;
    }
}
```

### 6.3 è‡ªåŠ¨æ¢å¤å®ç°


**ğŸ”¸ åº”ç”¨çº§è‡ªåŠ¨æ¢å¤**
```java
@Component
public class AutoRecoveryManager {
    
    @Scheduled(fixedDelay = 30000) // æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡
    public void healthCheck() {
        if (!isSystemHealthy()) {
            log.warn("æ£€æµ‹åˆ°ç³»ç»Ÿå¼‚å¸¸ï¼Œå¼€å§‹è‡ªåŠ¨æ¢å¤");
            performAutoRecovery();
        }
    }
    
    private void performAutoRecovery() {
        // 1. é‡å¯å…³é”®æœåŠ¡
        restartCriticalServices();
        
        // 2. æ¸…ç†å¼‚å¸¸çŠ¶æ€
        clearErrorStates();
        
        // 3. é‡æ–°åˆå§‹åŒ–è¿æ¥
        reinitializeConnections();
        
        // 4. éªŒè¯æ¢å¤æ•ˆæœ
        if (isSystemHealthy()) {
            log.info("ç³»ç»Ÿè‡ªåŠ¨æ¢å¤æˆåŠŸ");
        } else {
            log.error("è‡ªåŠ¨æ¢å¤å¤±è´¥ï¼Œéœ€è¦äººå·¥å¹²é¢„");
            sendAlert("ç³»ç»Ÿè‡ªåŠ¨æ¢å¤å¤±è´¥");
        }
    }
}
```

**ğŸ”¸ åŸºç¡€è®¾æ–½çº§è‡ªåŠ¨æ¢å¤**
```yaml
# Docker Compose è‡ªåŠ¨é‡å¯é…ç½®
version: '3'
services:
  web-app:
    image: myapp:latest
    restart: always          # æ€»æ˜¯é‡å¯
    healthcheck:             # å¥åº·æ£€æŸ¥
      test: ["CMD", "curl", "-f", "http://localhost:8080/health"]
      interval: 30s
      timeout: 10s
      retries: 3
    deploy:
      restart_policy:        # é‡å¯ç­–ç•¥
        condition: on-failure
        delay: 5s
        max_attempts: 3
```

### 6.4 å®Œæ•´çš„é«˜å¯ç”¨æ¶æ„


**ğŸ”¸ ç”µå•†ç³»ç»Ÿé«˜å¯ç”¨å®ä¾‹**

```
å®Œæ•´æ¶æ„å›¾ï¼š
ç”¨æˆ· â†’ CDN â†’ è´Ÿè½½å‡è¡¡å™¨ â†’ WebæœåŠ¡é›†ç¾¤
                            â†“
                      ä¸šåŠ¡æœåŠ¡é›†ç¾¤
                            â†“
                      æ•°æ®åº“ä¸»å¤‡é›†ç¾¤
                            â†“
                      åˆ†å¸ƒå¼ç¼“å­˜é›†ç¾¤

æ¯ä¸€å±‚éƒ½æœ‰å†—ä½™å’Œæ•…éšœè½¬ç§»èƒ½åŠ›
```

**å…³é”®é…ç½®**ï¼š

<details>
<summary>ğŸ”§ ç‚¹å‡»æŸ¥çœ‹è¯¦ç»†é…ç½®ä»£ç </summary>

```java
@Configuration
public class HighAvailabilityConfig {
    
    // å¤šæ•°æ®æºé…ç½®
    @Bean
    @Primary
    public DataSource primaryDataSource() {
        HikariConfig config = new HikariConfig();
        config.setJdbcUrl("jdbc:mysql://db-master:3306/ecommerce");
        config.setMaximumPoolSize(20);
        config.setConnectionTimeout(3000);
        return new HikariDataSource(config);
    }
    
    @Bean
    public DataSource secondaryDataSource() {
        HikariConfig config = new HikariConfig();
        config.setJdbcUrl("jdbc:mysql://db-slave:3306/ecommerce");
        config.setMaximumPoolSize(10);
        config.setReadOnly(true);
        return new HikariDataSource(config);
    }
    
    // Redisé›†ç¾¤é…ç½®
    @Bean
    public LettuceConnectionFactory redisConnectionFactory() {
        RedisClusterConfiguration config = new RedisClusterConfiguration();
        config.clusterNode("redis-1", 6379);
        config.clusterNode("redis-2", 6379);
        config.clusterNode("redis-3", 6379);
        return new LettuceConnectionFactory(config);
    }
    
    // ç†”æ–­å™¨é…ç½®
    @Bean
    public CircuitBreaker circuitBreaker() {
        return CircuitBreaker.ofDefaults("payment-service");
    }
}
```

</details>

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ é«˜å¯ç”¨æ€§ï¼šç³»ç»ŸæŒç»­æä¾›æœåŠ¡çš„èƒ½åŠ›ï¼Œé¿å…å•ç‚¹æ•…éšœ
ğŸ”¸ å®¹é”™ç­–ç•¥ï¼šä¸»å¤‡ã€é›†ç¾¤ã€è‡ªåŠ¨æ¢å¤ä¸‰å¤§æ ¸å¿ƒæ–¹æ³•
ğŸ”¸ æ•…éšœéš”ç¦»ï¼šé˜²æ­¢æ•…éšœæ‰©æ•£ï¼Œç¡®ä¿å±€éƒ¨æ•…éšœä¸å½±å“æ•´ä½“
ğŸ”¸ è‡ªæ„ˆèƒ½åŠ›ï¼šç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹å’Œä¿®å¤é—®é¢˜çš„èƒ½åŠ›
ğŸ”¸ å®¹é”™éªŒè¯ï¼šé€šè¿‡æµ‹è¯•éªŒè¯å®¹é”™æ–¹æ¡ˆçš„æœ‰æ•ˆæ€§
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ é«˜å¯ç”¨çš„æœ¬è´¨æ€è€ƒ**
```
æ ¸å¿ƒæ€æƒ³ï¼š
- æ¶ˆé™¤å•ç‚¹ï¼šä»»ä½•ç»„ä»¶éƒ½ä¸èƒ½æˆä¸ºå”¯ä¸€çš„ä¾èµ–
- å¿«é€Ÿæ¢å¤ï¼šæ•…éšœå‘ç”Ÿæ—¶èƒ½å¿«é€Ÿåˆ‡æ¢å’Œæ¢å¤
- æŒç»­æœåŠ¡ï¼šç”¨æˆ·æ„ŸçŸ¥ä¸åˆ°ç³»ç»Ÿå†…éƒ¨çš„æ•…éšœ

å®ç°åŸåˆ™ï¼š
- å†—ä½™å¤‡ä»½ï¼šå…³é”®ç»„ä»¶éƒ½è¦æœ‰å¤‡ä»½
- æ•…éšœéš”ç¦»ï¼šé”™è¯¯ä¸èƒ½ä¼ æ’­å’Œæ‰©æ•£
- è‡ªåŠ¨åŒ–ï¼šå‡å°‘äººå·¥å¹²é¢„ï¼Œæé«˜å“åº”é€Ÿåº¦
```

**ğŸ”¹ æˆæœ¬æ•ˆç›Šå¹³è¡¡**
```
è€ƒè™‘å› ç´ ï¼š
- ä¸šåŠ¡é‡è¦æ€§ï¼šæ ¸å¿ƒä¸šåŠ¡99.99%ï¼Œè¾¹ç¼˜åŠŸèƒ½99%
- æˆæœ¬æŠ•å…¥ï¼šé«˜å¯ç”¨éœ€è¦é¢å¤–çš„ç¡¬ä»¶å’ŒäººåŠ›æˆæœ¬
- æŠ€æœ¯å¤æ‚æ€§ï¼šç®€å•çš„ä¸»å¤‡ vs å¤æ‚çš„é›†ç¾¤
- æ¢å¤æ—¶é—´ï¼šRTO(æ¢å¤æ—¶é—´ç›®æ ‡) vs RPO(æ¢å¤ç‚¹ç›®æ ‡)
```

**ğŸ”¹ å¸¸è§è¯¯åŒºé¿å…**
```
é”™è¯¯è®¤çŸ¥ï¼š
âŒ é«˜å¯ç”¨å°±æ˜¯ä¹°æ›´å¥½çš„è®¾å¤‡ â†’ åº”è¯¥æ˜¯æ¶æ„è®¾è®¡
âŒ å¤‡ä»½å°±æ˜¯é«˜å¯ç”¨ â†’ å¤‡ä»½åªæ˜¯æ¢å¤æ‰‹æ®µ
âŒ è¶Šå¤æ‚è¶Šå¯é  â†’ ç®€å•çš„å¾€å¾€æ›´å¯é 
âŒ ä¸€æ¬¡è®¾è®¡æ°¸è¿œæœ‰æ•ˆ â†’ éœ€è¦æŒç»­æ”¹è¿›

æ­£ç¡®åšæ³•ï¼š
âœ… ä»æ¶æ„è®¾è®¡å¼€å§‹è€ƒè™‘é«˜å¯ç”¨
âœ… æ ¹æ®ä¸šåŠ¡éœ€è¦é€‰æ‹©åˆé€‚çš„ç­‰çº§
âœ… ç®€å•å¯é èƒœè¿‡å¤æ‚å®Œç¾
âœ… æŒç»­æµ‹è¯•å’Œæ”¹è¿›æ–¹æ¡ˆ
```

### 7.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ ä¸åŒåœºæ™¯çš„é€‰æ‹©ç­–ç•¥**
- **ä¸ªäººé¡¹ç›®**ï¼šç®€å•çš„ä¸»å¤‡æ–¹æ¡ˆï¼Œå®šæœŸå¤‡ä»½
- **å°ä¼ä¸šåº”ç”¨**ï¼šè´Ÿè½½å‡è¡¡+æ•°æ®åº“ä¸»å¤‡
- **ä¸­å‹äº’è”ç½‘**ï¼šå¾®æœåŠ¡+é›†ç¾¤+ç¼“å­˜+ç›‘æ§
- **å¤§å‹ç”µå•†**ï¼šå¤šæœºæˆ¿+CDN+åˆ†å¸ƒå¼+è‡ªåŠ¨åŒ–

**ğŸ”§ å®æ–½æ­¥éª¤å»ºè®®**
1. **è¯„ä¼°ç°çŠ¶**ï¼šè¯†åˆ«å•ç‚¹æ•…éšœå’Œè–„å¼±ç¯èŠ‚
2. **è®¾è®¡æ–¹æ¡ˆ**ï¼šæ ¹æ®ä¸šåŠ¡éœ€è¦é€‰æ‹©åˆé€‚ç­–ç•¥
3. **é€æ­¥å®æ–½**ï¼šå…ˆè§£å†³æœ€å…³é”®çš„é—®é¢˜
4. **æµ‹è¯•éªŒè¯**ï¼šæ•…éšœæ¼”ç»ƒå’Œå‹åŠ›æµ‹è¯•
5. **æŒç»­æ”¹è¿›**ï¼šæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ä¼˜åŒ–

**ğŸ“Š ç›‘æ§æŒ‡æ ‡**
- **å¯ç”¨æ€§æŒ‡æ ‡**ï¼šç³»ç»Ÿæ­£å¸¸è¿è¡Œæ—¶é—´æ¯”ä¾‹
- **æ•…éšœæ¢å¤æ—¶é—´**ï¼šä»æ•…éšœå‘ç”Ÿåˆ°æ¢å¤çš„æ—¶é—´
- **æ•…éšœæ£€æµ‹æ—¶é—´**ï¼šä»æ•…éšœå‘ç”Ÿåˆ°è¢«å‘ç°çš„æ—¶é—´
- **ç”¨æˆ·ä½“éªŒæŒ‡æ ‡**ï¼šå“åº”æ—¶é—´ã€æˆåŠŸç‡ç­‰

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- é«˜å¯ç”¨è®¾è®¡è¦è¶æ—©ï¼Œå•ç‚¹æ•…éšœæ˜¯å¤§æ•Œ
- ä¸»å¤‡é›†ç¾¤å„æœ‰ç”¨ï¼Œè‡ªåŠ¨æ¢å¤æ˜¯å…³é”®  
- æ•…éšœéš”ç¦»é˜²æ‰©æ•£ï¼Œå¥åº·æ£€æŸ¥ä¸èƒ½åœ
- æµ‹è¯•éªŒè¯è¦è·Ÿä¸Šï¼ŒæŒç»­æ”¹è¿›æ‰å¯é 