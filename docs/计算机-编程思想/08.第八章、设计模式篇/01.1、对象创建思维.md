---
title: 1ã€å¯¹è±¡åˆ›å»ºæ€ç»´
---
## ğŸ“š ç›®å½•

1. [å¯¹è±¡åˆ›å»ºæ€ç»´æ¦‚è¿°](#1-å¯¹è±¡åˆ›å»ºæ€ç»´æ¦‚è¿°)
2. [å·¥å‚æ¨¡å¼æ—](#2-å·¥å‚æ¨¡å¼æ—)
3. [å•ä¾‹æ¨¡å¼å®ç°](#3-å•ä¾‹æ¨¡å¼å®ç°)
4. [å»ºé€ è€…æ¨¡å¼](#4-å»ºé€ è€…æ¨¡å¼)
5. [åŸå‹æ¨¡å¼](#5-åŸå‹æ¨¡å¼)
6. [å¯¹è±¡æ± æ¨¡å¼](#6-å¯¹è±¡æ± æ¨¡å¼)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ§  å¯¹è±¡åˆ›å»ºæ€ç»´æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯å¯¹è±¡åˆ›å»ºæ€ç»´


**æ ¸å¿ƒç†å¿µ**ï¼šå¯¹è±¡åˆ›å»ºæ€ç»´å°±æ˜¯å¦‚ä½•**æ›´ä¼˜é›…ã€æ›´çµæ´»åœ°åˆ›å»ºå¯¹è±¡**çš„æ€è€ƒæ–¹å¼ã€‚

```
ä¼ ç»Ÿåˆ›å»ºæ–¹å¼çš„é—®é¢˜ï¼š
User user = new User();  // ç›´æ¥newï¼Œè€¦åˆåº¦é«˜
Car car = new Car();     // åˆ›å»ºé€»è¾‘æ•£è½å„å¤„
```

**å¯¹è±¡åˆ›å»ºæ€ç»´è§£å†³çš„æ ¸å¿ƒé—®é¢˜**ï¼š
- ğŸ¯ **åˆ›å»ºå¤æ‚åº¦**ï¼šå¤æ‚å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹å¦‚ä½•ç®€åŒ–ï¼Ÿ
- ğŸ”§ **åˆ›å»ºçµæ´»æ€§**ï¼šå¦‚ä½•æ ¹æ®ä¸åŒæ¡ä»¶åˆ›å»ºä¸åŒå¯¹è±¡ï¼Ÿ
- â™»ï¸ **å¯¹è±¡å¤ç”¨**ï¼šå¦‚ä½•é¿å…é‡å¤åˆ›å»ºç›¸åŒå¯¹è±¡ï¼Ÿ
- ğŸ­ **åˆ›å»ºèŒè´£**ï¼šè°æ¥è´Ÿè´£åˆ›å»ºå¯¹è±¡æ›´åˆé€‚ï¼Ÿ

### 1.2 å¯¹è±¡åˆ›å»ºæ¨¡å¼çš„ä»·å€¼


**è§£å†³ä»€ä¹ˆé—®é¢˜**ï¼š
```
âŒ é—®é¢˜åœºæ™¯ï¼š
- åˆ›å»ºé€»è¾‘å¤æ‚ï¼Œä»£ç é‡å¤
- å¯¹è±¡åˆ›å»ºä¸ä½¿ç”¨è€¦åˆä¸¥é‡
- æ— æ³•æ§åˆ¶å¯¹è±¡çš„åˆ›å»ºæ•°é‡
- å¤æ‚å¯¹è±¡æ„å»ºè¿‡ç¨‹ç¹ç

âœ… æ¨¡å¼ä¼˜åŠ¿ï¼š
- åˆ›å»ºé€»è¾‘é›†ä¸­ç®¡ç†
- é™ä½å®¢æˆ·ç«¯ä¸å…·ä½“ç±»çš„è€¦åˆ
- æ§åˆ¶å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ
- æä¾›çµæ´»çš„å¯¹è±¡æ„å»ºæ–¹å¼
```

### 1.3 åˆ›å»ºæ¨¡å¼çš„åˆ†ç±»æ€ç»´


```
æŒ‰åˆ›å»ºæ–¹å¼åˆ†ç±»ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç›´æ¥åˆ›å»ºå‹     â”‚ â†’ å·¥å‚æ¨¡å¼æ—
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å•å®ä¾‹å‹      â”‚ â†’ å•ä¾‹æ¨¡å¼
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   åˆ†æ­¥æ„å»ºå‹     â”‚ â†’ å»ºé€ è€…æ¨¡å¼
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å¤åˆ¶åˆ›å»ºå‹     â”‚ â†’ åŸå‹æ¨¡å¼
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   æ± åŒ–å¤ç”¨å‹     â”‚ â†’ å¯¹è±¡æ± æ¨¡å¼
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ğŸ­ å·¥å‚æ¨¡å¼æ—


### 2.1 å·¥å‚æ¨¡å¼æ—æ¦‚è¿°


**å·¥å‚æ¨¡å¼æ—çš„æ ¸å¿ƒæ€æƒ³**ï¼š**æŠŠå¯¹è±¡çš„åˆ›å»ºå·¥ä½œäº¤ç»™ä¸“é—¨çš„"å·¥å‚"æ¥è´Ÿè´£**ï¼Œå°±åƒç°å®ä¸­çš„å·¥å‚ä¸“é—¨ç”Ÿäº§äº§å“ä¸€æ ·ã€‚

```
ç°å®ä¸–ç•Œç±»æ¯”ï¼š
ğŸ­ æ±½è½¦å·¥å‚ â†’ ä¸“é—¨ç”Ÿäº§æ±½è½¦
ğŸ­ æ‰‹æœºå·¥å‚ â†’ ä¸“é—¨ç”Ÿäº§æ‰‹æœº
ğŸ­ é£Ÿå“å·¥å‚ â†’ ä¸“é—¨ç”Ÿäº§é£Ÿå“

ç¼–ç¨‹ä¸–ç•Œï¼š
ğŸ­ UserFactory â†’ ä¸“é—¨åˆ›å»ºUserå¯¹è±¡
ğŸ­ CarFactory â†’ ä¸“é—¨åˆ›å»ºCarå¯¹è±¡
```

### 2.2 ç®€å•å·¥å‚æ¨¡å¼


**å®šä¹‰**ï¼šç”¨ä¸€ä¸ªå·¥å‚ç±»æ¥åˆ›å»ºå„ç§ç›¸å…³çš„å¯¹è±¡ï¼Œ**å®¢æˆ·ç«¯åªéœ€è¦å‘Šè¯‰å·¥å‚"æˆ‘è¦ä»€ä¹ˆ"ï¼Œä¸éœ€è¦çŸ¥é“"æ€ä¹ˆåš"**ã€‚

```java
// ç®€å•å·¥å‚ç¤ºä¾‹ï¼šå’–å•¡å·¥å‚
public class CoffeeFactory {
    public static Coffee createCoffee(String type) {
        switch (type) {
            case "americano": return new Americano();
            case "latte": return new Latte();
            case "cappuccino": return new Cappuccino();
            default: throw new IllegalArgumentException("æœªçŸ¥å’–å•¡ç±»å‹");
        }
    }
}

// ä½¿ç”¨æ–¹å¼
Coffee coffee = CoffeeFactory.createCoffee("latte");
```

**ä¼˜åŠ¿ä¸å±€é™**ï¼š
- âœ… **ç®€å•æ˜“ç”¨**ï¼šä¸€ä¸ªå·¥å‚è§£å†³æ‰€æœ‰åˆ›å»ºéœ€æ±‚
- âœ… **é›†ä¸­ç®¡ç†**ï¼šåˆ›å»ºé€»è¾‘é›†ä¸­åœ¨ä¸€å¤„
- âŒ **è¿åå¼€é—­åŸåˆ™**ï¼šæ·»åŠ æ–°äº§å“éœ€è¦ä¿®æ”¹å·¥å‚ä»£ç 

### 2.3 å·¥å‚æ–¹æ³•æ¨¡å¼


**å®šä¹‰**ï¼š**æ¯ä¸ªå…·ä½“äº§å“éƒ½æœ‰è‡ªå·±çš„ä¸“é—¨å·¥å‚**ï¼Œå½“éœ€è¦æ–°äº§å“æ—¶ï¼Œåªéœ€è¦æ·»åŠ æ–°çš„äº§å“ç±»å’Œå¯¹åº”çš„å·¥å‚ç±»ã€‚

```java
// æŠ½è±¡å·¥å‚æ¥å£
interface CoffeeFactory {
    Coffee createCoffee();
}

// å…·ä½“å·¥å‚å®ç°
class LatteFactory implements CoffeeFactory {
    public Coffee createCoffee() {
        return new Latte();
    }
}

class AmericanoFactory implements CoffeeFactory {
    public Coffee createCoffee() {
        return new Americano();
    }
}

// ä½¿ç”¨æ–¹å¼
CoffeeFactory factory = new LatteFactory();
Coffee coffee = factory.createCoffee();
```

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- âœ… **ç¬¦åˆå¼€é—­åŸåˆ™**ï¼šæ‰©å±•æ–°äº§å“ä¸éœ€è¦ä¿®æ”¹ç°æœ‰ä»£ç 
- âœ… **èŒè´£å•ä¸€**ï¼šæ¯ä¸ªå·¥å‚åªè´Ÿè´£ä¸€ç§äº§å“
- âš ï¸ **ç±»æ•°é‡å¢åŠ **ï¼šæ¯ä¸ªäº§å“éœ€è¦å¯¹åº”ä¸€ä¸ªå·¥å‚

### 2.4 æŠ½è±¡å·¥å‚æ¨¡å¼


**å®šä¹‰**ï¼šç”¨æ¥åˆ›å»º**ä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–çš„å¯¹è±¡æ—**ï¼Œæ¯”å¦‚åˆ›å»ºä¸€å¥—å®Œæ•´çš„UIç»„ä»¶ã€‚

```java
// æŠ½è±¡å·¥å‚ï¼šåˆ›å»ºä¸€å¥—UIç»„ä»¶
interface UIFactory {
    Button createButton();
    Input createInput();
    Dialog createDialog();
}

// Windowsé£æ ¼å·¥å‚
class WindowsUIFactory implements UIFactory {
    public Button createButton() { return new WindowsButton(); }
    public Input createInput() { return new WindowsInput(); }
    public Dialog createDialog() { return new WindowsDialog(); }
}

// Macé£æ ¼å·¥å‚
class MacUIFactory implements UIFactory {
    public Button createButton() { return new MacButton(); }
    public Input createInput() { return new MacInput(); }
    public Dialog createDialog() { return new MacDialog(); }
}
```

**åº”ç”¨åœºæ™¯**ï¼š
- ğŸ¨ **ä¸»é¢˜åˆ‡æ¢**ï¼šåˆ›å»ºä¸€å¥—é£æ ¼ç»Ÿä¸€çš„UIç»„ä»¶
- ğŸ”§ **æ•°æ®åº“é€‚é…**ï¼šä¸ºä¸åŒæ•°æ®åº“åˆ›å»ºå¯¹åº”çš„è¿æ¥ã€æŸ¥è¯¢ã€äº‹åŠ¡å¯¹è±¡
- ğŸŒ **è·¨å¹³å°å¼€å‘**ï¼šä¸ºä¸åŒæ“ä½œç³»ç»Ÿåˆ›å»ºå¯¹åº”çš„ç»„ä»¶

### 2.5 å·¥å‚æ¨¡å¼æ—çš„é€‰æ‹©æŒ‡å—


| æ¨¡å¼ç±»å‹ | **é€‚ç”¨åœºæ™¯** | **ä¼˜åŠ¿** | **å±€é™** |
|---------|------------|---------|---------|
| ğŸ”§ **ç®€å•å·¥å‚** | `äº§å“ç§ç±»å°‘ä¸”ç¨³å®š` | `å®ç°ç®€å•ï¼Œæ˜“äºç†è§£` | `æ‰©å±•æ€§å·®ï¼Œè¿åå¼€é—­åŸåˆ™` |
| ğŸ­ **å·¥å‚æ–¹æ³•** | `äº§å“ç§ç±»ä¼šé¢‘ç¹æ‰©å±•` | `æ‰©å±•æ€§å¥½ï¼Œç¬¦åˆå¼€é—­åŸåˆ™` | `ç±»æ•°é‡å¤šï¼Œå¤æ‚åº¦å¢åŠ ` |
| ğŸ¨ **æŠ½è±¡å·¥å‚** | `éœ€è¦åˆ›å»ºäº§å“æ—` | `ä¿è¯äº§å“æ—ä¸€è‡´æ€§` | `æ‰©å±•äº§å“æ—å›°éš¾` |

---

## 3. ğŸ‘‘ å•ä¾‹æ¨¡å¼å®ç°


### 3.1 å•ä¾‹æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³


**å®šä¹‰**ï¼š**ä¿è¯ä¸€ä¸ªç±»åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹**ï¼Œå¹¶æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ã€‚

```
ç°å®ç”Ÿæ´»ç±»æ¯”ï¼š
ğŸ›ï¸ ä¸€ä¸ªå›½å®¶åªæœ‰ä¸€ä¸ªæ€»ç»Ÿ
ğŸ¢ ä¸€ä¸ªå…¬å¸åªæœ‰ä¸€ä¸ªCEO  
ğŸŒ åœ°çƒåªæœ‰ä¸€ä¸ªæœˆäº®

ç¼–ç¨‹ä¸–ç•Œï¼š
ğŸ“ æ–‡ä»¶ç®¡ç†å™¨åªéœ€è¦ä¸€ä¸ªå®ä¾‹
ğŸ”§ é…ç½®ç®¡ç†å™¨åªéœ€è¦ä¸€ä¸ªå®ä¾‹
ğŸ“Š æ—¥å¿—è®°å½•å™¨åªéœ€è¦ä¸€ä¸ªå®ä¾‹
```

**ä¸ºä»€ä¹ˆéœ€è¦å•ä¾‹**ï¼š
- ğŸ’° **èŠ‚çº¦èµ„æº**ï¼šé¿å…åˆ›å»ºå¤šä¸ªç›¸åŒåŠŸèƒ½çš„é‡é‡çº§å¯¹è±¡
- ğŸ¯ **å…¨å±€è®¿é—®**ï¼šæä¾›ä¸€ä¸ªå…¨å±€çš„è®¿é—®ç‚¹
- ğŸ”’ **æ•°æ®ä¸€è‡´æ€§**ï¼šé¿å…å¤šä¸ªå®ä¾‹å¯¼è‡´çš„æ•°æ®ä¸ä¸€è‡´

### 3.2 æ‡’æ±‰å¼å•ä¾‹ï¼ˆå»¶è¿Ÿåˆ›å»ºï¼‰


**æ€æƒ³**ï¼š**éœ€è¦çš„æ—¶å€™å†åˆ›å»º**ï¼Œå°±åƒæ‡’äººä¸€æ ·ï¼Œä¸åˆ°ä¸‡ä¸å¾—å·²ä¸èµ·åºŠã€‚

```java
// åŸºç¡€æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰
public class LazySingleton {
    private static LazySingleton instance;
    
    private LazySingleton() {} // ç§æœ‰æ„é€ å™¨
    
    public static LazySingleton getInstance() {
        if (instance == null) {  // éœ€è¦æ—¶æ‰åˆ›å»º
            instance = new LazySingleton();
        }
        return instance;
    }
}

// çº¿ç¨‹å®‰å…¨çš„æ‡’æ±‰å¼
public class ThreadSafeLazySingleton {
    private static ThreadSafeLazySingleton instance;
    
    private ThreadSafeLazySingleton() {}
    
    public static synchronized ThreadSafeLazySingleton getInstance() {
        if (instance == null) {
            instance = new ThreadSafeLazySingleton();
        }
        return instance;
    }
}
```

### 3.3 é¥¿æ±‰å¼å•ä¾‹ï¼ˆç«‹å³åˆ›å»ºï¼‰


**æ€æƒ³**ï¼š**ç¨‹åºå¯åŠ¨æ—¶å°±åˆ›å»º**ï¼Œå°±åƒé¥¿æ±‰ä¸€æ ·ï¼Œä¸€å¼€å§‹å°±æŠŠé¥­å‡†å¤‡å¥½ã€‚

```java
public class EagerSingleton {
    // ç±»åŠ è½½æ—¶å°±åˆ›å»ºå®ä¾‹
    private static final EagerSingleton instance = new EagerSingleton();
    
    private EagerSingleton() {}
    
    public static EagerSingleton getInstance() {
        return instance;  // ç›´æ¥è¿”å›å·²åˆ›å»ºçš„å®ä¾‹
    }
}
```

**ä¼˜åŠ£å¯¹æ¯”**ï¼š
- âœ… **çº¿ç¨‹å®‰å…¨**ï¼šç±»åŠ è½½æœºåˆ¶ä¿è¯çº¿ç¨‹å®‰å…¨
- âœ… **æ€§èƒ½å¥½**ï¼šè·å–å®ä¾‹æ—¶æ— éœ€åˆ¤æ–­
- âŒ **å†…å­˜å ç”¨**ï¼šä¸ç®¡ç”¨ä¸ç”¨éƒ½ä¼šåˆ›å»º

### 3.4 åŒé‡æ£€æŸ¥é”å•ä¾‹ï¼ˆæ¨èï¼‰


**æ€æƒ³**ï¼š**ç»“åˆæ‡’æ±‰å¼å’Œé¥¿æ±‰å¼çš„ä¼˜ç‚¹**ï¼Œæ—¢ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œåˆé¿å…æ€§èƒ½æŸå¤±ã€‚

```java
public class DoubleCheckSingleton {
    private static volatile DoubleCheckSingleton instance;
    
    private DoubleCheckSingleton() {}
    
    public static DoubleCheckSingleton getInstance() {
        if (instance == null) {  // ç¬¬ä¸€æ¬¡æ£€æŸ¥
            synchronized (DoubleCheckSingleton.class) {
                if (instance == null) {  // ç¬¬äºŒæ¬¡æ£€æŸ¥
                    instance = new DoubleCheckSingleton();
                }
            }
        }
        return instance;
    }
}
```

**ä¸ºä»€ä¹ˆè¦åŒé‡æ£€æŸ¥**ï¼š
```
çº¿ç¨‹å®‰å…¨è€ƒè™‘ï¼š
çº¿ç¨‹Aè¿›å…¥ç¬¬ä¸€ä¸ªifï¼Œå‡†å¤‡åˆ›å»ºå®ä¾‹
çº¿ç¨‹Bä¹Ÿè¿›å…¥ç¬¬ä¸€ä¸ªif
çº¿ç¨‹Aè·å¾—é”ï¼Œåˆ›å»ºå®ä¾‹ï¼Œé‡Šæ”¾é”
çº¿ç¨‹Bè·å¾—é”ï¼Œå¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ªifï¼Œä¼šå†æ¬¡åˆ›å»ºå®ä¾‹ï¼
```

### 3.5 æšä¸¾å•ä¾‹ï¼ˆæœ€ç®€å•ï¼‰


**æ€æƒ³**ï¼š**åˆ©ç”¨æšä¸¾çš„ç‰¹æ€§**ï¼Œå¤©ç„¶ä¿è¯å•ä¾‹ä¸”çº¿ç¨‹å®‰å…¨ã€‚

```java
public enum EnumSingleton {
    INSTANCE;
    
    public void doSomething() {
        System.out.println("æ‰§è¡Œä¸šåŠ¡é€»è¾‘");
    }
}

// ä½¿ç”¨æ–¹å¼
EnumSingleton.INSTANCE.doSomething();
```

**ä¸ºä»€ä¹ˆæšä¸¾æ˜¯æœ€å¥½çš„å•ä¾‹**ï¼š
- ğŸ”’ **çº¿ç¨‹å®‰å…¨**ï¼šJVMä¿è¯æšä¸¾çº¿ç¨‹å®‰å…¨
- ğŸ›¡ï¸ **é˜²åå°„æ”»å‡»**ï¼šæšä¸¾ä¸èƒ½é€šè¿‡åå°„åˆ›å»ºæ–°å®ä¾‹
- ğŸ“¦ **é˜²åºåˆ—åŒ–æ”»å‡»**ï¼šåºåˆ—åŒ–åååºåˆ—åŒ–ä»æ˜¯åŒä¸€å®ä¾‹

### 3.6 å•ä¾‹æ¨¡å¼çš„åº”ç”¨åœºæ™¯


**é€‚åˆä½¿ç”¨å•ä¾‹çš„åœºæ™¯**ï¼š
```
ğŸ”§ å·¥å…·ç±»ï¼š
- é…ç½®ç®¡ç†å™¨ (ConfigManager)
- æ—¥å¿—è®°å½•å™¨ (Logger)  
- ç¼“å­˜ç®¡ç†å™¨ (CacheManager)

ğŸ“Š èµ„æºç®¡ç†ï¼š
- æ•°æ®åº“è¿æ¥æ± 
- çº¿ç¨‹æ± ç®¡ç†å™¨
- æ–‡ä»¶ç³»ç»Ÿç®¡ç†å™¨

ğŸ® æ¸¸æˆå¼€å‘ï¼š
- æ¸¸æˆçŠ¶æ€ç®¡ç†å™¨
- éŸ³æ•ˆç®¡ç†å™¨
- èµ„æºåŠ è½½å™¨
```

---

## 4. ğŸ—ï¸ å»ºé€ è€…æ¨¡å¼


### 4.1 å»ºé€ è€…æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³


**å®šä¹‰**ï¼š**å°†å¤æ‚å¯¹è±¡çš„æ„å»ºè¿‡ç¨‹åˆ†è§£æˆå¤šä¸ªç®€å•æ­¥éª¤**ï¼Œå°±åƒç›–æˆ¿å­ä¸€æ ·ï¼Œä¸€æ­¥ä¸€æ­¥æ¥å»ºé€ ã€‚

```
ç°å®ä¸–ç•Œç±»æ¯”ï¼š
ğŸ  ç›–æˆ¿å­ï¼šæ‰“åœ°åŸº â†’ å»ºå¢™ä½“ â†’ è£…å±‹é¡¶ â†’ è£…ä¿®
ğŸ” åšæ±‰å ¡ï¼šé€‰é¢åŒ… â†’ åŠ è‚‰é¥¼ â†’ åŠ è”¬èœ â†’ åŠ é…±æ–™
ğŸš— é€ æ±½è½¦ï¼šåˆ¶é€ å¼•æ“ â†’ å®‰è£…è½¦èº« â†’ è£…é…è½®èƒ â†’ è°ƒè¯•æµ‹è¯•

ç¼–ç¨‹ä¸–ç•Œï¼š
ğŸ“§ æ„å»ºé‚®ä»¶ï¼šè®¾ç½®æ”¶ä»¶äºº â†’ è®¾ç½®ä¸»é¢˜ â†’ è®¾ç½®å†…å®¹ â†’ æ·»åŠ é™„ä»¶
ğŸ”§ åˆ›å»ºHTTPè¯·æ±‚ï¼šè®¾ç½®URL â†’ è®¾ç½®æ–¹æ³• â†’ è®¾ç½®å¤´éƒ¨ â†’ è®¾ç½®å‚æ•°
```

### 4.2 å»ºé€ è€…æ¨¡å¼çš„ç»“æ„


```
å»ºé€ è€…æ¨¡å¼ç»„æˆï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   äº§å“(Product)  â”‚ â† è¦æ„å»ºçš„å¤æ‚å¯¹è±¡
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æŠ½è±¡å»ºé€ è€…æ¥å£    â”‚ â† å®šä¹‰æ„å»ºæ­¥éª¤
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  
â”‚ å…·ä½“å»ºé€ è€…å®ç°    â”‚ â† å®ç°å…·ä½“æ„å»ºé€»è¾‘
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æŒ‡æŒ¥è€…(Director) â”‚ â† æ§åˆ¶æ„å»ºè¿‡ç¨‹
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 ç»å…¸å»ºé€ è€…æ¨¡å¼å®ç°


```java
// äº§å“ï¼šå¤æ‚çš„ç”µè„‘å¯¹è±¡
public class Computer {
    private String cpu;
    private String memory;
    private String storage;
    private String graphics;
    
    // getterå’Œsetteræ–¹æ³•
    public void setCpu(String cpu) { this.cpu = cpu; }
    public void setMemory(String memory) { this.memory = memory; }
    public void setStorage(String storage) { this.storage = storage; }
    public void setGraphics(String graphics) { this.graphics = graphics; }
    
    @Override
    public String toString() {
        return String.format("ç”µè„‘é…ç½®: CPU=%s, å†…å­˜=%s, å­˜å‚¨=%s, æ˜¾å¡=%s", 
                           cpu, memory, storage, graphics);
    }
}

// æŠ½è±¡å»ºé€ è€…
interface ComputerBuilder {
    void buildCpu();
    void buildMemory();
    void buildStorage();
    void buildGraphics();
    Computer getResult();
}

// å…·ä½“å»ºé€ è€…ï¼šæ¸¸æˆç”µè„‘
class GamingComputerBuilder implements ComputerBuilder {
    private Computer computer = new Computer();
    
    public void buildCpu() { computer.setCpu("é«˜æ€§èƒ½æ¸¸æˆCPU"); }
    public void buildMemory() { computer.setMemory("32GBæ¸¸æˆå†…å­˜"); }
    public void buildStorage() { computer.setStorage("1TB SSD"); }
    public void buildGraphics() { computer.setGraphics("RTX4090æ˜¾å¡"); }
    public Computer getResult() { return computer; }
}

// æŒ‡æŒ¥è€…ï¼šæ§åˆ¶æ„å»ºè¿‡ç¨‹
class ComputerDirector {
    public Computer buildComputer(ComputerBuilder builder) {
        builder.buildCpu();
        builder.buildMemory();
        builder.buildStorage();
        builder.buildGraphics();
        return builder.getResult();
    }
}
```

### 4.4 ç°ä»£é“¾å¼å»ºé€ è€…æ¨¡å¼ï¼ˆæ¨èï¼‰


**æ€æƒ³**ï¼š**å»æ‰å¤æ‚çš„æŒ‡æŒ¥è€…ï¼Œä½¿ç”¨é“¾å¼è°ƒç”¨**ï¼Œè®©ä»£ç æ›´ç®€æ´æ˜“è¯»ã€‚

```java
public class User {
    private final String name;      // å¿…å¡«
    private final String email;     // å¿…å¡«
    private final int age;          // å¯é€‰
    private final String phone;     // å¯é€‰
    private final String address;   // å¯é€‰
    
    // ç§æœ‰æ„é€ å™¨
    private User(Builder builder) {
        this.name = builder.name;
        this.email = builder.email;
        this.age = builder.age;
        this.phone = builder.phone;
        this.address = builder.address;
    }
    
    // é™æ€å†…éƒ¨å»ºé€ è€…ç±»
    public static class Builder {
        private final String name;    // å¿…å¡«å‚æ•°
        private final String email;   // å¿…å¡«å‚æ•°
        private int age = 0;          // å¯é€‰å‚æ•°ï¼Œæœ‰é»˜è®¤å€¼
        private String phone = "";
        private String address = "";
        
        // å¿…å¡«å‚æ•°çš„æ„é€ å™¨
        public Builder(String name, String email) {
            this.name = name;
            this.email = email;
        }
        
        // é“¾å¼è°ƒç”¨çš„setteræ–¹æ³•
        public Builder age(int age) {
            this.age = age;
            return this;  // è¿”å›thiså®ç°é“¾å¼è°ƒç”¨
        }
        
        public Builder phone(String phone) {
            this.phone = phone;
            return this;
        }
        
        public Builder address(String address) {
            this.address = address;
            return this;
        }
        
        // æ„å»ºæœ€ç»ˆå¯¹è±¡
        public User build() {
            return new User(this);
        }
    }
}

// ä½¿ç”¨æ–¹å¼ï¼šæ¸…æ™°çš„é“¾å¼è°ƒç”¨
User user = new User.Builder("å¼ ä¸‰", "zhangsan@example.com")
                .age(25)
                .phone("13800138000")
                .address("åŒ—äº¬å¸‚æœé˜³åŒº")
                .build();
```

### 4.5 å»ºé€ è€…æ¨¡å¼çš„åº”ç”¨åœºæ™¯


**é€‚åˆä½¿ç”¨å»ºé€ è€…æ¨¡å¼çš„æƒ…å†µ**ï¼š
- ğŸ—ï¸ **å¤æ‚å¯¹è±¡**ï¼šå¯¹è±¡æœ‰å¾ˆå¤šå±æ€§ï¼Œæ„é€ è¿‡ç¨‹å¤æ‚
- ğŸ”§ **å‚æ•°å¾ˆå¤š**ï¼šæ„é€ å™¨å‚æ•°è¶…è¿‡4ä¸ª
- ğŸ“ **å¯é€‰å‚æ•°**ï¼šæœ‰å¾ˆå¤šå¯é€‰å‚æ•°ï¼Œé¿å…æ„é€ å™¨é‡è½½è¿‡å¤š
- ğŸ”’ **ä¸å¯å˜å¯¹è±¡**ï¼šåˆ›å»ºåä¸èƒ½ä¿®æ”¹çš„å¯¹è±¡

**å®é™…åº”ç”¨ç¤ºä¾‹**ï¼š
```java
// HTTPè¯·æ±‚æ„å»º
HttpRequest request = new HttpRequest.Builder("https://api.example.com")
    .method("POST")
    .header("Content-Type", "application/json")
    .header("Authorization", "Bearer token123")
    .body("{\"name\":\"å¼ ä¸‰\"}")
    .timeout(5000)
    .build();

// SQLæŸ¥è¯¢æ„å»º
String sql = new SqlBuilder()
    .select("name", "age", "email")
    .from("users")
    .where("age > 18")
    .orderBy("name ASC")
    .limit(10)
    .build();
```

---

## 5. ğŸ“‹ åŸå‹æ¨¡å¼


### 5.1 åŸå‹æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³


**å®šä¹‰**ï¼š**é€šè¿‡å¤åˆ¶ï¼ˆå…‹éš†ï¼‰ç°æœ‰å¯¹è±¡æ¥åˆ›å»ºæ–°å¯¹è±¡**ï¼Œè€Œä¸æ˜¯é€šè¿‡æ„é€ å‡½æ•°ã€‚å°±åƒå¤å°æœºä¸€æ ·ï¼Œä»åŸä»¶å¤åˆ¶å‡ºå‰¯æœ¬ã€‚

```
ç°å®ä¸–ç•Œç±»æ¯”ï¼š
ğŸ“„ å¤å°æ–‡æ¡£ï¼šç”¨å¤å°æœºå¤åˆ¶ç°æœ‰æ–‡æ¡£
ğŸ§¬ ç»†èƒåˆ†è£‚ï¼šä¸€ä¸ªç»†èƒåˆ†è£‚æˆä¸¤ä¸ªç›¸åŒç»†èƒ
ğŸª ç”¨æ¨¡å…·åšé¥¼å¹²ï¼šç”¨åŒä¸€ä¸ªæ¨¡å…·åˆ¶ä½œå¤šä¸ªç›¸åŒå½¢çŠ¶çš„é¥¼å¹²

ç¼–ç¨‹ä¸–ç•Œï¼š
ğŸ“Š å¤åˆ¶Excelæ¨¡æ¿ï¼šåŸºäºç°æœ‰æ¨¡æ¿åˆ›å»ºæ–°æ–‡æ¡£
ğŸ® å¤åˆ¶æ¸¸æˆè§’è‰²ï¼šåŸºäºç°æœ‰è§’è‰²åˆ›å»ºç›¸ä¼¼è§’è‰²
ğŸ”§ å¤åˆ¶é…ç½®å¯¹è±¡ï¼šåŸºäºç°æœ‰é…ç½®åˆ›å»ºæ–°çš„é…ç½®å®ä¾‹
```

### 5.2 ä¸ºä»€ä¹ˆéœ€è¦åŸå‹æ¨¡å¼


**è§£å†³çš„æ ¸å¿ƒé—®é¢˜**ï¼š
```
âŒ ä¼ ç»Ÿåˆ›å»ºæ–¹å¼çš„é—®é¢˜ï¼š
- å¯¹è±¡åˆ›å»ºæˆæœ¬é«˜ï¼ˆæ¯”å¦‚éœ€è¦ä»æ•°æ®åº“åŠ è½½æ•°æ®ï¼‰
- æ„é€ è¿‡ç¨‹å¤æ‚ï¼ˆéœ€è¦å¾ˆå¤šåˆå§‹åŒ–æ­¥éª¤ï¼‰
- éœ€è¦åˆ›å»ºå¤§é‡ç›¸ä¼¼å¯¹è±¡ï¼ˆåªæœ‰å°‘é‡å±æ€§ä¸åŒï¼‰

âœ… åŸå‹æ¨¡å¼çš„ä¼˜åŠ¿ï¼š
- é¿å…é‡å¤çš„åˆå§‹åŒ–è¿‡ç¨‹
- æ€§èƒ½ä¼˜äºç›´æ¥åˆ›å»ºæ–°å¯¹è±¡
- ç®€åŒ–å¯¹è±¡åˆ›å»ºè¿‡ç¨‹
```

### 5.3 æµ…å…‹éš†å®ç°


```java
// å®ç°Cloneableæ¥å£çš„åŸå‹ç±»
public class Document implements Cloneable {
    private String title;
    private String content;
    private List<String> tags;
    
    public Document(String title, String content) {
        this.title = title;
        this.content = content;
        this.tags = new ArrayList<>();
    }
    
    // æµ…å…‹éš†ï¼šåªå¤åˆ¶åŸºæœ¬ç±»å‹å’Œå¼•ç”¨åœ°å€
    @Override
    public Document clone() {
        try {
            return (Document) super.clone();
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
    
    // getterå’Œsetteræ–¹æ³•
    public void addTag(String tag) { tags.add(tag); }
    public List<String> getTags() { return tags; }
    public void setTitle(String title) { this.title = title; }
    public String getTitle() { return title; }
}

// ä½¿ç”¨æµ…å…‹éš†
Document original = new Document("åŸå§‹æ–‡æ¡£", "è¿™æ˜¯åŸå§‹å†…å®¹");
original.addTag("é‡è¦");

Document copy = original.clone();
copy.setTitle("å¤åˆ¶æ–‡æ¡£");

// æ³¨æ„ï¼šæµ…å…‹éš†çš„é—®é¢˜
copy.addTag("å¤åˆ¶");  // è¿™ä¼šå½±å“åŸå§‹æ–‡æ¡£çš„tagsï¼
```

**æµ…å…‹éš†çš„é—®é¢˜**ï¼š
```
æµ…å…‹éš†åªå¤åˆ¶å¯¹è±¡çš„å¼•ç”¨ï¼Œä¸å¤åˆ¶å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡
åŸå§‹å¯¹è±¡: [title="åŸå§‹æ–‡æ¡£", tags=List@123]
å…‹éš†å¯¹è±¡: [title="å¤åˆ¶æ–‡æ¡£", tags=List@123]  â† æŒ‡å‘åŒä¸€ä¸ªListï¼
```

### 5.4 æ·±å…‹éš†å®ç°


```java
public class Document implements Cloneable {
    private String title;
    private String content;
    private List<String> tags;
    
    public Document(String title, String content) {
        this.title = title;
        this.content = content;
        this.tags = new ArrayList<>();
    }
    
    // æ·±å…‹éš†ï¼šåˆ›å»ºå®Œå…¨ç‹¬ç«‹çš„å‰¯æœ¬
    @Override
    public Document clone() {
        try {
            Document cloned = (Document) super.clone();
            // æ‰‹åŠ¨æ·±å…‹éš†List
            cloned.tags = new ArrayList<>(this.tags);
            return cloned;
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
    
    // æˆ–è€…ä½¿ç”¨åºåˆ—åŒ–å®ç°æ·±å…‹éš†
    public Document deepClone() {
        try {
            ByteArrayOutputStream bos = new ByteArrayOutputStream();
            ObjectOutputStream oos = new ObjectOutputStream(bos);
            oos.writeObject(this);
            
            ByteArrayInputStream bis = new ByteArrayInputStream(bos.toByteArray());
            ObjectInputStream ois = new ObjectInputStream(bis);
            return (Document) ois.readObject();
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }
}
```

### 5.5 åŸå‹ç®¡ç†å™¨æ¨¡å¼


**æ€æƒ³**ï¼š**é›†ä¸­ç®¡ç†å¤šä¸ªåŸå‹å¯¹è±¡**ï¼Œå®¢æˆ·ç«¯é€šè¿‡åç§°è·å–ç›¸åº”çš„åŸå‹ã€‚

```java
// åŸå‹ç®¡ç†å™¨
public class PrototypeManager {
    private Map<String, Document> prototypes = new HashMap<>();
    
    // æ³¨å†ŒåŸå‹
    public void registerPrototype(String key, Document prototype) {
        prototypes.put(key, prototype);
    }
    
    // è·å–åŸå‹çš„å…‹éš†
    public Document getPrototype(String key) {
        Document prototype = prototypes.get(key);
        if (prototype != null) {
            return prototype.clone();
        }
        return null;
    }
}

// ä½¿ç”¨åŸå‹ç®¡ç†å™¨
PrototypeManager manager = new PrototypeManager();

// æ³¨å†Œå„ç§æ–‡æ¡£æ¨¡æ¿
Document reportTemplate = new Document("æŠ¥å‘Šæ¨¡æ¿", "è¿™æ˜¯æŠ¥å‘Šçš„åŸºç¡€å†…å®¹");
Document letterTemplate = new Document("ä¿¡ä»¶æ¨¡æ¿", "è¿™æ˜¯ä¿¡ä»¶çš„åŸºç¡€å†…å®¹");

manager.registerPrototype("report", reportTemplate);
manager.registerPrototype("letter", letterTemplate);

// åŸºäºæ¨¡æ¿åˆ›å»ºæ–°æ–‡æ¡£
Document newReport = manager.getPrototype("report");
newReport.setTitle("2024å¹´åº¦æŠ¥å‘Š");
```

### 5.6 åŸå‹æ¨¡å¼çš„åº”ç”¨åœºæ™¯


**é€‚åˆä½¿ç”¨åŸå‹æ¨¡å¼çš„æƒ…å†µ**ï¼š
- ğŸ”§ **å¯¹è±¡åˆ›å»ºæˆæœ¬é«˜**ï¼šéœ€è¦ä»æ•°æ®åº“åŠ è½½æˆ–ç½‘ç»œè·å–æ•°æ®
- ğŸ“ **å¯¹è±¡ç»“æ„å¤æ‚**ï¼šæœ‰å¾ˆå¤šå±‚çº§çš„åµŒå¥—å¯¹è±¡
- ğŸ¯ **éœ€è¦å¤§é‡ç›¸ä¼¼å¯¹è±¡**ï¼šåªæœ‰å°‘é‡å±æ€§ä¸åŒ
- ğŸ›¡ï¸ **é¿å…æ„é€ å™¨æ±¡æŸ“**ï¼šä¸æƒ³æš´éœ²å¤æ‚çš„æ„é€ è¿‡ç¨‹

**å®é™…åº”ç”¨ç¤ºä¾‹**ï¼š
```java
// æ¸¸æˆä¸­çš„è§’è‰²å…‹éš†
Character warrior = new Character("æˆ˜å£«", 100, 50, 20);
Character newWarrior = warrior.clone();
newWarrior.setName("é«˜çº§æˆ˜å£«");

// é…ç½®å¯¹è±¡çš„å…‹éš†
DatabaseConfig devConfig = new DatabaseConfig("localhost", 3306, "dev_db");
DatabaseConfig testConfig = devConfig.clone();
testConfig.setDatabase("test_db");
```

---

## 6. ğŸŠ å¯¹è±¡æ± æ¨¡å¼


### 6.1 å¯¹è±¡æ± æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³


**å®šä¹‰**ï¼š**é¢„å…ˆåˆ›å»ºä¸€å®šæ•°é‡çš„å¯¹è±¡æ”¾åœ¨"æ± "ä¸­ï¼Œéœ€è¦æ—¶ä»æ± ä¸­å–ï¼Œç”¨å®Œåæ”¾å›æ± ä¸­é‡å¤ä½¿ç”¨**ã€‚å°±åƒæ¸¸æ³³æ± ä¸€æ ·ï¼Œå¤§å®¶å…±ç”¨åŒä¸€ä¸ªæ± å­ã€‚

```
ç°å®ä¸–ç•Œç±»æ¯”ï¼š
ğŸš— å…±äº«å•è½¦ï¼šå¤šäººå…±ç”¨ï¼Œç”¨å®Œæ”¾å›æŒ‡å®šåœ°ç‚¹
ğŸŠ æ¸¸æ³³æ± ï¼šå¤šäººå…±äº«åŒä¸€ä¸ªæ± å­
ğŸ“š å›¾ä¹¦é¦†ï¼šä¹¦ç±å¯ä»¥è¢«å¤šäººå€Ÿé˜…å’Œå½’è¿˜
ğŸšŒ å…¬äº¤è½¦ï¼šå¤šäººå…±äº«äº¤é€šå·¥å…·

ç¼–ç¨‹ä¸–ç•Œï¼š
ğŸ”— æ•°æ®åº“è¿æ¥æ± ï¼šå…±äº«æ•°æ®åº“è¿æ¥
ğŸ§µ çº¿ç¨‹æ± ï¼šå…±äº«çº¿ç¨‹èµ„æº
ğŸ“¦ å¯¹è±¡æ± ï¼šå…±äº«é‡é‡çº§å¯¹è±¡
```

### 6.2 ä¸ºä»€ä¹ˆéœ€è¦å¯¹è±¡æ± 


**è§£å†³çš„æ ¸å¿ƒé—®é¢˜**ï¼š
```
âŒ é¢‘ç¹åˆ›å»ºé”€æ¯å¯¹è±¡çš„é—®é¢˜ï¼š
- åˆ›å»ºæˆæœ¬é«˜ï¼ˆå¦‚æ•°æ®åº“è¿æ¥ï¼‰
- GCå‹åŠ›å¤§ï¼ˆå¤§é‡ä¸´æ—¶å¯¹è±¡ï¼‰
- ç³»ç»Ÿèµ„æºæœ‰é™ï¼ˆå¦‚çº¿ç¨‹æ•°é‡ï¼‰
- å“åº”é€Ÿåº¦æ…¢ï¼ˆæ¯æ¬¡éƒ½è¦åˆå§‹åŒ–ï¼‰

âœ… å¯¹è±¡æ± çš„ä¼˜åŠ¿ï¼š
- å‡å°‘å¯¹è±¡åˆ›å»ºå¼€é”€
- é™ä½GCå‹åŠ›
- æ§åˆ¶èµ„æºä½¿ç”¨é‡
- æé«˜ç³»ç»Ÿå“åº”é€Ÿåº¦
```

### 6.3 ç®€å•å¯¹è±¡æ± å®ç°


```java
// å¯é‡ç”¨çš„é‡é‡çº§å¯¹è±¡
public class DatabaseConnection {
    private String connectionId;
    private boolean inUse;
    
    public DatabaseConnection(String id) {
        this.connectionId = id;
        this.inUse = false;
        // æ¨¡æ‹Ÿæ˜‚è´µçš„è¿æ¥åˆ›å»ºè¿‡ç¨‹
        simulateConnectionCreation();
    }
    
    private void simulateConnectionCreation() {
        try {
            Thread.sleep(100); // æ¨¡æ‹Ÿåˆ›å»ºè€—æ—¶
            System.out.println("åˆ›å»ºæ•°æ®åº“è¿æ¥: " + connectionId);
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
    }
    
    public void doQuery(String sql) {
        System.out.println("è¿æ¥" + connectionId + "æ‰§è¡ŒæŸ¥è¯¢: " + sql);
    }
    
    public boolean isInUse() { return inUse; }
    public void setInUse(boolean inUse) { this.inUse = inUse; }
    public String getConnectionId() { return connectionId; }
}
```

```java
// ç®€å•å¯¹è±¡æ± å®ç°
public class ConnectionPool {
    private List<DatabaseConnection> pool;
    private int maxPoolSize;
    
    public ConnectionPool(int maxSize) {
        this.maxPoolSize = maxSize;
        this.pool = new ArrayList<>();
        
        // é¢„åˆ›å»ºä¸€äº›è¿æ¥
        for (int i = 0; i < maxSize / 2; i++) {
            pool.add(new DatabaseConnection("Conn-" + i));
        }
    }
    
    // ä»æ± ä¸­è·å–å¯¹è±¡
    public synchronized DatabaseConnection getConnection() {
        // æŸ¥æ‰¾å¯ç”¨çš„è¿æ¥
        for (DatabaseConnection conn : pool) {
            if (!conn.isInUse()) {
                conn.setInUse(true);
                System.out.println("ä»æ± ä¸­è·å–è¿æ¥: " + conn.getConnectionId());
                return conn;
            }
        }
        
        // å¦‚æœæ²¡æœ‰å¯ç”¨è¿æ¥ä¸”æœªè¾¾åˆ°æœ€å¤§å€¼ï¼Œåˆ›å»ºæ–°è¿æ¥
        if (pool.size() < maxPoolSize) {
            DatabaseConnection newConn = new DatabaseConnection("Conn-" + pool.size());
            newConn.setInUse(true);
            pool.add(newConn);
            return newConn;
        }
        
        // æ± å·²æ»¡ï¼Œç­‰å¾…æˆ–æŠ›å‡ºå¼‚å¸¸
        throw new RuntimeException("è¿æ¥æ± å·²æ»¡ï¼Œæ— å¯ç”¨è¿æ¥");
    }
    
    // å°†å¯¹è±¡å½’è¿˜åˆ°æ± ä¸­
    public synchronized void returnConnection(DatabaseConnection conn) {
        if (conn != null && pool.contains(conn)) {
            conn.setInUse(false);
            System.out.println("å½’è¿˜è¿æ¥åˆ°æ± : " + conn.getConnectionId());
        }
    }
    
    // è·å–æ± çŠ¶æ€ä¿¡æ¯
    public synchronized String getPoolStatus() {
        long inUseCount = pool.stream().filter(DatabaseConnection::isInUse).count();
        return String.format("æ± å¤§å°: %d, ä½¿ç”¨ä¸­: %d, å¯ç”¨: %d", 
                           pool.size(), inUseCount, pool.size() - inUseCount);
    }
}
```

### 6.4 å®Œå–„çš„å¯¹è±¡æ± å®ç°


```java
// é€šç”¨å¯¹è±¡æ± æ¥å£
public interface PooledObject {
    void reset();  // é‡ç½®å¯¹è±¡çŠ¶æ€
    boolean validate();  // éªŒè¯å¯¹è±¡æ˜¯å¦å¯ç”¨
}

// å¯¹è±¡æ± å·¥å‚æ¥å£
public interface PooledObjectFactory<T extends PooledObject> {
    T createObject();  // åˆ›å»ºæ–°å¯¹è±¡
    void destroyObject(T obj);  // é”€æ¯å¯¹è±¡
}

// å®Œå–„çš„å¯¹è±¡æ± 
public class ObjectPool<T extends PooledObject> {
    private final Queue<T> availableObjects;
    private final Set<T> inUseObjects;
    private final PooledObjectFactory<T> factory;
    private final int maxPoolSize;
    private final int minPoolSize;
    
    public ObjectPool(PooledObjectFactory<T> factory, int minSize, int maxSize) {
        this.factory = factory;
        this.minPoolSize = minSize;
        this.maxPoolSize = maxSize;
        this.availableObjects = new ConcurrentLinkedQueue<>();
        this.inUseObjects = ConcurrentHashMap.newKeySet();
        
        // é¢„åˆ›å»ºæœ€å°æ•°é‡çš„å¯¹è±¡
        for (int i = 0; i < minSize; i++) {
            availableObjects.offer(factory.createObject());
        }
    }
    
    public T borrowObject() throws Exception {
        T object = availableObjects.poll();
        
        if (object == null) {
            if (getTotalObjectCount() < maxPoolSize) {
                object = factory.createObject();
            } else {
                throw new RuntimeException("å¯¹è±¡æ± å·²æ»¡");
            }
        }
        
        // éªŒè¯å¯¹è±¡æ˜¯å¦å¯ç”¨
        if (!object.validate()) {
            factory.destroyObject(object);
            return borrowObject(); // é€’å½’è·å–å¯ç”¨å¯¹è±¡
        }
        
        inUseObjects.add(object);
        return object;
    }
    
    public void returnObject(T object) {
        if (inUseObjects.remove(object)) {
            object.reset(); // é‡ç½®å¯¹è±¡çŠ¶æ€
            if (object.validate()) {
                availableObjects.offer(object);
            } else {
                factory.destroyObject(object);
            }
        }
    }
    
    private int getTotalObjectCount() {
        return availableObjects.size() + inUseObjects.size();
    }
    
    public void close() {
        // æ¸…ç†æ± ä¸­çš„æ‰€æœ‰å¯¹è±¡
        availableObjects.forEach(factory::destroyObject);
        inUseObjects.forEach(factory::destroyObject);
        availableObjects.clear();
        inUseObjects.clear();
    }
}
```

### 6.5 å¯¹è±¡æ± çš„ä½¿ç”¨ç¤ºä¾‹


```java
// ä½¿ç”¨å¯¹è±¡æ± 
public class DatabaseService {
    private ConnectionPool connectionPool;
    
    public DatabaseService() {
        connectionPool = new ConnectionPool(10); // æœ€å¤§10ä¸ªè¿æ¥
    }
    
    public List<String> queryUsers() {
        DatabaseConnection conn = null;
        try {
            // ä»æ± ä¸­è·å–è¿æ¥
            conn = connectionPool.getConnection();
            
            // æ‰§è¡Œä¸šåŠ¡é€»è¾‘
            conn.doQuery("SELECT * FROM users");
            
            // æ¨¡æ‹Ÿè¿”å›ç»“æœ
            return Arrays.asList("ç”¨æˆ·1", "ç”¨æˆ·2", "ç”¨æˆ·3");
            
        } catch (Exception e) {
            System.err.println("æŸ¥è¯¢å¤±è´¥: " + e.getMessage());
            return Collections.emptyList();
        } finally {
            // ç¡®ä¿è¿æ¥è¢«å½’è¿˜
            if (conn != null) {
                connectionPool.returnConnection(conn);
            }
        }
    }
    
    public void checkPoolStatus() {
        System.out.println("è¿æ¥æ± çŠ¶æ€: " + connectionPool.getPoolStatus());
    }
}

// æµ‹è¯•å¯¹è±¡æ± 
public class PoolTest {
    public static void main(String[] args) {
        DatabaseService service = new DatabaseService();
        
        // æ¨¡æ‹Ÿå¹¶å‘è®¿é—®
        for (int i = 0; i < 5; i++) {
            new Thread(() -> {
                service.queryUsers();
                service.checkPoolStatus();
            }).start();
        }
    }
}
```

### 6.6 å¯¹è±¡æ± æ¨¡å¼çš„åº”ç”¨åœºæ™¯


**é€‚åˆä½¿ç”¨å¯¹è±¡æ± çš„æƒ…å†µ**ï¼š
- ğŸ’° **å¯¹è±¡åˆ›å»ºæˆæœ¬é«˜**ï¼šæ•°æ®åº“è¿æ¥ã€æ–‡ä»¶å¥æŸ„ã€ç½‘ç»œè¿æ¥
- ğŸ”„ **å¯¹è±¡å¯é‡å¤ä½¿ç”¨**ï¼šå¯¹è±¡å¯ä»¥è¢«é‡ç½®åˆ°åˆå§‹çŠ¶æ€
- ğŸ“Š **å¯¹è±¡ä½¿ç”¨é¢‘ç¹**ï¼šé¢‘ç¹åˆ›å»ºå’Œé”€æ¯åŒç±»å‹å¯¹è±¡
- ğŸ¯ **èµ„æºæœ‰é™**ï¼šç³»ç»Ÿèµ„æºæœ‰é™åˆ¶ï¼Œéœ€è¦æ§åˆ¶å¯¹è±¡æ•°é‡

**å®é™…åº”ç”¨ç¤ºä¾‹**ï¼š
```java
// çº¿ç¨‹æ± ï¼ˆJDKå†…ç½®ï¼‰
ExecutorService threadPool = Executors.newFixedThreadPool(10);

// æ•°æ®åº“è¿æ¥æ± ï¼ˆå¸¸è§æ¡†æ¶ï¼‰
HikariDataSource dataSource = new HikariDataSource();
dataSource.setMaximumPoolSize(20);

// å¯¹è±¡æ± åœ¨WebæœåŠ¡å™¨ä¸­çš„åº”ç”¨
// Tomcatçš„çº¿ç¨‹æ± ã€è¿æ¥æ± 
// Redisè¿æ¥æ± ã€HTTPè¿æ¥æ± ç­‰
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å·¥å‚æ¨¡å¼æ—ï¼šå°†å¯¹è±¡åˆ›å»ºå§”æ‰˜ç»™ä¸“é—¨çš„å·¥å‚
  - ç®€å•å·¥å‚ï¼šä¸€ä¸ªå·¥å‚åˆ›å»ºå¤šç§äº§å“ï¼ˆé€‚åˆäº§å“å°‘ï¼‰
  - å·¥å‚æ–¹æ³•ï¼šæ¯ä¸ªäº§å“æœ‰ä¸“é—¨å·¥å‚ï¼ˆé€‚åˆæ‰©å±•ï¼‰
  - æŠ½è±¡å·¥å‚ï¼šåˆ›å»ºäº§å“æ—ï¼ˆé€‚åˆå…³è”äº§å“ï¼‰

ğŸ”¸ å•ä¾‹æ¨¡å¼ï¼šä¿è¯å…¨å±€å”¯ä¸€å®ä¾‹
  - æ‡’æ±‰å¼ï¼šéœ€è¦æ—¶åˆ›å»ºï¼ˆå»¶è¿ŸåŠ è½½ï¼‰
  - é¥¿æ±‰å¼ï¼šç¨‹åºå¯åŠ¨æ—¶åˆ›å»ºï¼ˆç«‹å³åŠ è½½ï¼‰
  - åŒé‡æ£€æŸ¥é”ï¼šå…¼é¡¾æ€§èƒ½å’Œå®‰å…¨
  - æšä¸¾å•ä¾‹ï¼šæœ€ç®€å•æœ€å®‰å…¨

ğŸ”¸ å»ºé€ è€…æ¨¡å¼ï¼šåˆ†æ­¥æ„å»ºå¤æ‚å¯¹è±¡
  - ç»å…¸å»ºé€ è€…ï¼šæœ‰æŒ‡æŒ¥è€…æ§åˆ¶æµç¨‹
  - é“¾å¼å»ºé€ è€…ï¼šæµç•…æ¥å£ï¼Œæ›´æ˜“ç”¨

ğŸ”¸ åŸå‹æ¨¡å¼ï¼šé€šè¿‡å…‹éš†åˆ›å»ºå¯¹è±¡
  - æµ…å…‹éš†ï¼šåªå¤åˆ¶åŸºæœ¬ç±»å‹å’Œå¼•ç”¨åœ°å€
  - æ·±å…‹éš†ï¼šé€’å½’å¤åˆ¶æ‰€æœ‰å±‚çº§çš„å¯¹è±¡

ğŸ”¸ å¯¹è±¡æ± æ¨¡å¼ï¼šé‡å¤åˆ©ç”¨æ˜‚è´µå¯¹è±¡
  - é¢„åˆ›å»ºï¼šæå‰å‡†å¤‡ä¸€å®šæ•°é‡å¯¹è±¡
  - å€Ÿè¿˜æœºåˆ¶ï¼šè·å–ä½¿ç”¨åå½’è¿˜
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä½•æ—¶é€‰æ‹©å“ªç§åˆ›å»ºæ¨¡å¼**ï¼š
```
å¯¹è±¡åˆ›å»ºå¤æ‚åº¦ï¼š
ğŸ”§ ç®€å•å¯¹è±¡ â†’ ç›´æ¥new
ğŸ­ å¤æ‚å¯¹è±¡ â†’ å·¥å‚æ¨¡å¼
ğŸ—ï¸ è¶…å¤æ‚å¯¹è±¡ â†’ å»ºé€ è€…æ¨¡å¼

å¯¹è±¡æ•°é‡éœ€æ±‚ï¼š
ğŸ‘‘ å…¨å±€å”¯ä¸€ â†’ å•ä¾‹æ¨¡å¼
ğŸ“‹ å¤§é‡ç›¸ä¼¼ â†’ åŸå‹æ¨¡å¼
ğŸŠ é‡å¤ä½¿ç”¨ â†’ å¯¹è±¡æ± æ¨¡å¼

æ€§èƒ½å’Œèµ„æºè€ƒè™‘ï¼š
âš¡ åˆ›å»ºæˆæœ¬é«˜ â†’ åŸå‹æ¨¡å¼/å¯¹è±¡æ± 
ğŸ’° å†…å­˜å—é™ â†’ å•ä¾‹æ¨¡å¼/å¯¹è±¡æ± 
ğŸ”„ é¢‘ç¹åˆ›å»ºé”€æ¯ â†’ å¯¹è±¡æ± æ¨¡å¼
```

**ğŸ”¹ æ¨¡å¼ç»„åˆä½¿ç”¨**ï¼š
```
å¸¸è§ç»„åˆï¼š
ğŸ­ + ğŸ‘‘ = å•ä¾‹å·¥å‚
ğŸ—ï¸ + ğŸ“‹ = å»ºé€ è€…+åŸå‹ï¼ˆæ„å»ºæ¨¡æ¿åå…‹éš†ï¼‰
ğŸŠ + ğŸ­ = æ± åŒ–å·¥å‚ï¼ˆå·¥å‚ç®¡ç†å¯¹è±¡æ± ï¼‰
```

### 7.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ’¡ é€‰æ‹©æŒ‡å—**ï¼š
```
é¡¹ç›®åˆæœŸï¼š
- ç®€å•åœºæ™¯ä½¿ç”¨ç®€å•å·¥å‚
- é¿å…è¿‡åº¦è®¾è®¡ï¼Œå…ˆå®ç°åŠŸèƒ½

é¡¹ç›®æˆé•¿æœŸï¼š
- å‘ç°é‡å¤åˆ›å»ºé€»è¾‘æ—¶å¼•å…¥å·¥å‚æ–¹æ³•
- å¤æ‚é…ç½®å¯¹è±¡ä½¿ç”¨å»ºé€ è€…æ¨¡å¼

é¡¹ç›®æˆç†ŸæœŸï¼š
- æ€§èƒ½ä¼˜åŒ–æ—¶è€ƒè™‘åŸå‹æ¨¡å¼å’Œå¯¹è±¡æ± 
- å…¨å±€èµ„æºç®¡ç†ä½¿ç”¨å•ä¾‹æ¨¡å¼
```

**âš ï¸ å¸¸è§è¯¯åŒº**ï¼š
```
âŒ æ»¥ç”¨å•ä¾‹ï¼šæŠŠå•ä¾‹å½“å…¨å±€å˜é‡ç”¨
âŒ è¿‡åº¦æŠ½è±¡ï¼šç®€å•åœºæ™¯ä½¿ç”¨å¤æ‚çš„æŠ½è±¡å·¥å‚
âŒ å¿½ç•¥çº¿ç¨‹å®‰å…¨ï¼šå¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„åˆ›å»ºæ¨¡å¼å®‰å…¨æ€§
âŒ å¿˜è®°èµ„æºæ¸…ç†ï¼šå¯¹è±¡æ± ã€åŸå‹æ¨¡å¼çš„å†…å­˜ç®¡ç†
```

**ğŸ¯ æœ€ä½³å®è·µ**ï¼š
```
è®¾è®¡åŸåˆ™ï¼š
- ä¼˜å…ˆç»„åˆï¼Œå…¶æ¬¡ç»§æ‰¿
- é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œä¸é’ˆå¯¹å®ç°ç¼–ç¨‹
- å¼€é—­åŸåˆ™ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­

ä»£ç å®è·µï¼š
- ä½¿ç”¨é™æ€å†…éƒ¨ç±»å®ç°å»ºé€ è€…
- æšä¸¾æ˜¯å®ç°å•ä¾‹çš„æœ€ä½³æ–¹å¼
- å¯¹è±¡æ± è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨å’Œèµ„æºæ¸…ç†
- åŸå‹æ¨¡å¼è¦æ˜ç¡®æ·±æµ…å…‹éš†çš„åœºæ™¯
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- å·¥å‚ç®¡åˆ›å»ºï¼Œå•ä¾‹ç®¡å”¯ä¸€
- å»ºé€ è€…ç®¡å¤æ‚ï¼ŒåŸå‹ç®¡å¤åˆ¶
- å¯¹è±¡æ± ç®¡å¤ç”¨ï¼Œå„å¸å…¶èŒæ˜¾ç¥å¨