---
title: 8ã€æƒé™ç®¡ç†å‘½ä»¤
---
## ğŸ“š ç›®å½•

1. [æƒé™ç®¡ç†åŸºç¡€æ¦‚å¿µ](#1-æƒé™ç®¡ç†åŸºç¡€æ¦‚å¿µ)
2. [ç”¨æˆ·æƒé™æ§åˆ¶å‘½ä»¤](#2-ç”¨æˆ·æƒé™æ§åˆ¶å‘½ä»¤)
3. [å…¨å±€å‚æ•°ç®¡ç†å‘½ä»¤](#3-å…¨å±€å‚æ•°ç®¡ç†å‘½ä»¤)
4. [ç»„ä»¶å‚æ•°ç®¡ç†å‘½ä»¤](#4-ç»„ä»¶å‚æ•°ç®¡ç†å‘½ä»¤)
5. [æƒé™ç®¡ç†å®æˆ˜æ¡ˆä¾‹](#5-æƒé™ç®¡ç†å®æˆ˜æ¡ˆä¾‹)
6. [å¸¸è§é—®é¢˜ä¸æœ€ä½³å®è·µ](#6-å¸¸è§é—®é¢˜ä¸æœ€ä½³å®è·µ)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” æƒé™ç®¡ç†åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯RabbitMQæƒé™ç®¡ç†


**ç®€å•ç†è§£**ï¼šå°±åƒç»™ä¸åŒçš„äººåˆ†é…ä¸åŒçš„æˆ¿é—´é’¥åŒ™ä¸€æ ·ï¼ŒRabbitMQçš„æƒé™ç®¡ç†å†³å®šäº†å“ªä¸ªç”¨æˆ·å¯ä»¥å¯¹å“ªäº›èµ„æºè¿›è¡Œä»€ä¹ˆæ“ä½œã€‚

```
ç°å®ç”Ÿæ´»ç±»æ¯”ï¼š
é…’åº—ç®¡ç†å‘˜ â†’ å¯ä»¥è¿›å…¥æ‰€æœ‰æˆ¿é—´ï¼Œç®¡ç†æ‰€æœ‰è®¾æ–½
æ™®é€šä½å®¢   â†’ åªèƒ½è¿›å…¥è‡ªå·±çš„æˆ¿é—´
æ¸…æ´äººå‘˜   â†’ å¯ä»¥è¿›å…¥æˆ¿é—´æ¸…æ´ï¼Œä½†ä¸èƒ½ä½¿ç”¨æˆ¿é—´è®¾æ–½

RabbitMQä¸­ï¼š
ç®¡ç†å‘˜ç”¨æˆ· â†’ å¯ä»¥åˆ›å»ºã€åˆ é™¤é˜Ÿåˆ—å’Œäº¤æ¢æœº
åº”ç”¨ç”¨æˆ·   â†’ åªèƒ½å‘é€å’Œæ¥æ”¶æ¶ˆæ¯
ç›‘æ§ç”¨æˆ·   â†’ åªèƒ½æŸ¥çœ‹çŠ¶æ€ï¼Œä¸èƒ½ä¿®æ”¹
```

### 1.2 æƒé™çš„ä¸‰ä¸ªç»´åº¦


**ğŸ”¸ æƒé™ç±»å‹è¯´æ˜**
```
Configureæƒé™ï¼ˆé…ç½®æƒé™ï¼‰ï¼š
- å«ä¹‰ï¼šèƒ½å¦åˆ›å»ºã€åˆ é™¤ã€ä¿®æ”¹èµ„æº
- æ¯”å¦‚ï¼šåˆ›å»ºé˜Ÿåˆ—ã€åˆ é™¤äº¤æ¢æœºã€ç»‘å®šå…³ç³»
- ç›¸å½“äºï¼šè£…ä¿®æˆ¿é—´çš„æƒé™

Writeæƒé™ï¼ˆå†™æƒé™ï¼‰ï¼š
- å«ä¹‰ï¼šèƒ½å¦å‘é€æ¶ˆæ¯åˆ°èµ„æº
- æ¯”å¦‚ï¼šå‘é˜Ÿåˆ—å‘é€æ¶ˆæ¯ã€å‘äº¤æ¢æœºå‘å¸ƒæ¶ˆæ¯
- ç›¸å½“äºï¼šå¾€æˆ¿é—´é‡Œæ”¾ä¸œè¥¿çš„æƒé™

Readæƒé™ï¼ˆè¯»æƒé™ï¼‰ï¼š
- å«ä¹‰ï¼šèƒ½å¦ä»èµ„æºè¯»å–æ¶ˆæ¯
- æ¯”å¦‚ï¼šä»é˜Ÿåˆ—æ¶ˆè´¹æ¶ˆæ¯ã€ç»‘å®šé˜Ÿåˆ—
- ç›¸å½“äºï¼šä»æˆ¿é—´é‡Œæ‹¿ä¸œè¥¿çš„æƒé™
```

### 1.3 Virtual Hostï¼ˆè™šæ‹Ÿä¸»æœºï¼‰æ¦‚å¿µ


**é€šä¿—è§£é‡Š**ï¼šVirtual Hostå°±åƒå…¬å¯“æ¥¼é‡Œçš„ä¸åŒæ¥¼å±‚ï¼Œæ¯å±‚æ¥¼éƒ½æ˜¯ç‹¬ç«‹çš„ç©ºé—´ï¼Œæœ‰è‡ªå·±çš„æˆ¿é—´ï¼ˆé˜Ÿåˆ—ï¼‰å’Œè®¾æ–½ï¼ˆäº¤æ¢æœºï¼‰ã€‚

```
Virtual Hostç¤ºä¾‹ï¼š
/                    â† é»˜è®¤è™šæ‹Ÿä¸»æœºï¼ˆä¸€æ¥¼ï¼‰
/production         â† ç”Ÿäº§ç¯å¢ƒï¼ˆäºŒæ¥¼ï¼‰
/development        â† å¼€å‘ç¯å¢ƒï¼ˆä¸‰æ¥¼ï¼‰
/testing            â† æµ‹è¯•ç¯å¢ƒï¼ˆå››æ¥¼ï¼‰

æ¯ä¸ªç”¨æˆ·åœ¨ä¸åŒæ¥¼å±‚å¯èƒ½æœ‰ä¸åŒçš„æƒé™ï¼š
- å¼€å‘äººå‘˜ï¼šåœ¨å¼€å‘æ¥¼å±‚æœ‰å…¨éƒ¨æƒé™ï¼Œåœ¨ç”Ÿäº§æ¥¼å±‚æ²¡æœ‰æƒé™
- è¿ç»´äººå‘˜ï¼šåœ¨æ‰€æœ‰æ¥¼å±‚éƒ½æœ‰ç®¡ç†æƒé™
- åº”ç”¨ç¨‹åºï¼šåªåœ¨ç‰¹å®šæ¥¼å±‚æœ‰è¯»å†™æƒé™
```

---

## 2. ğŸ‘¥ ç”¨æˆ·æƒé™æ§åˆ¶å‘½ä»¤


### 2.1 è®¾ç½®ç”¨æˆ·æƒé™


**ğŸ”¸ åŸºç¡€å‘½ä»¤æ ¼å¼**
```bash
rabbitmqctl set_permissions {user} {conf} {write} {read}
```

**å‚æ•°è¯¦è§£**ï¼š
- `{user}`ï¼šç”¨æˆ·å
- `{conf}`ï¼šé…ç½®æƒé™çš„æ­£åˆ™è¡¨è¾¾å¼
- `{write}`ï¼šå†™æƒé™çš„æ­£åˆ™è¡¨è¾¾å¼  
- `{read}`ï¼šè¯»æƒé™çš„æ­£åˆ™è¡¨è¾¾å¼

> ğŸ’¡ **æ­£åˆ™è¡¨è¾¾å¼è¯´æ˜**ï¼š
> - `.*` è¡¨ç¤ºå…è®¸è®¿é—®æ‰€æœ‰èµ„æº
> - `^$` è¡¨ç¤ºä¸å…è®¸è®¿é—®ä»»ä½•èµ„æº
> - `^queue_.*` è¡¨ç¤ºåªèƒ½è®¿é—®ä»¥"queue_"å¼€å¤´çš„èµ„æº

**å®é™…åº”ç”¨ç¤ºä¾‹**ï¼š

```bash
# ç¤ºä¾‹1ï¼šç»™ç”¨æˆ·å®Œå…¨æƒé™ï¼ˆç›¸å½“äºç»™ä¸‡èƒ½é’¥åŒ™ï¼‰
rabbitmqctl set_permissions app_user ".*" ".*" ".*"

# ç¤ºä¾‹2ï¼šåªå…è®¸è¯»å–æƒé™ï¼ˆç›¸å½“äºåªèƒ½çœ‹ä¸èƒ½åŠ¨ï¼‰
rabbitmqctl set_permissions monitor_user "^$" "^$" ".*"

# ç¤ºä¾‹3ï¼šåªå…è®¸ç‰¹å®šé˜Ÿåˆ—çš„æƒé™
rabbitmqctl set_permissions order_user "^order_.*" "^order_.*" "^order_.*"
```

**ğŸ¯ æƒé™ç»„åˆå®ä¾‹**

| ç”¨æˆ·ç±»å‹ | **é…ç½®æƒé™** | **å†™æƒé™** | **è¯»æƒé™** | **å®é™…å«ä¹‰** |
|---------|------------|-----------|-----------|-------------|
| ğŸ”§ **ç®¡ç†å‘˜** | `.*` | `.*` | `.*` | å¯ä»¥åšä»»ä½•äº‹æƒ… |
| ğŸ“Š **ç›‘æ§ç”¨æˆ·** | `^$` | `^$` | `.*` | åªèƒ½æŸ¥çœ‹ï¼Œä¸èƒ½ä¿®æ”¹ |
| ğŸ“¤ **å‘é€è€…** | `^$` | `.*` | `^$` | åªèƒ½å‘é€æ¶ˆæ¯ |
| ğŸ“¥ **æ¶ˆè´¹è€…** | `^$` | `^$` | `.*` | åªèƒ½æ¥æ”¶æ¶ˆæ¯ |
| ğŸ·ï¸ **ç‰¹å®šä¸šåŠ¡** | `^order_.*` | `^order_.*` | `^order_.*` | åªèƒ½æ“ä½œè®¢å•ç›¸å…³èµ„æº |

### 2.2 æ¸…é™¤ç”¨æˆ·æƒé™


```bash
# æ¸…é™¤ç”¨æˆ·çš„æ‰€æœ‰æƒé™ï¼ˆç›¸å½“äºæ”¶å›æ‰€æœ‰é’¥åŒ™ï¼‰
rabbitmqctl clear_permissions app_user

# å®é™…æ•ˆæœï¼šç”¨æˆ·è¿˜å­˜åœ¨ï¼Œä½†æ— æ³•è®¿é—®ä»»ä½•èµ„æº
```

### 2.3 æŸ¥çœ‹æƒé™ä¿¡æ¯


**ğŸ”¸ æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·æƒé™**
```bash
rabbitmqctl list_permissions

# è¾“å‡ºç¤ºä¾‹ï¼š
# Listing permissions for vhost "/" ...
# user           configure    write    read
# admin          .*           .*       .*
# app_user       ^order_.*    ^order_.*    ^order_.*
# guest          ^$           ^$       ^$
```

**ğŸ”¸ æŸ¥çœ‹ç‰¹å®šç”¨æˆ·æƒé™**
```bash
rabbitmqctl list_user_permissions app_user

# è¾“å‡ºç¤ºä¾‹ï¼š
# Listing permissions for user "app_user" ...
# vhost    configure    write       read
# /        ^order_.*    ^order_.*   ^order_.*
# /prod    ^$           ^order_.*   ^order_.*
```

---

## 3. ğŸŒ å…¨å±€å‚æ•°ç®¡ç†å‘½ä»¤


### 3.1 ä»€ä¹ˆæ˜¯å…¨å±€å‚æ•°


**é€šä¿—ç†è§£**ï¼šå…¨å±€å‚æ•°å°±åƒæ•´æ ‹æ¥¼çš„å…¬å…±è®¾ç½®ï¼Œæ¯”å¦‚æ¥¼é“ç¯çš„å¼€å…³æ—¶é—´ã€ç”µæ¢¯çš„è¿è¡Œå‚æ•°ï¼Œå½±å“æ•´ä¸ªRabbitMQæœåŠ¡å™¨çš„è¡Œä¸ºã€‚

**ğŸ”¸ å¸¸è§å…¨å±€å‚æ•°**
```
cluster_nameï¼šé›†ç¾¤åç§°
vm_memory_high_watermarkï¼šå†…å­˜è­¦æˆ’çº¿
disk_free_limitï¼šç£ç›˜ç©ºé—´é™åˆ¶
log_levelsï¼šæ—¥å¿—çº§åˆ«è®¾ç½®
```

### 3.2 è®¾ç½®å…¨å±€å‚æ•°


```bash
# è®¾ç½®é›†ç¾¤åç§°
rabbitmqctl set_global_parameter cluster_name '"my-rabbit-cluster"'

# è®¾ç½®å†…å­˜è­¦æˆ’çº¿ä¸º50%
rabbitmqctl set_global_parameter vm_memory_high_watermark 0.5

# è®¾ç½®ç£ç›˜æœ€å°ç©ºé—´ä¸º1GB
rabbitmqctl set_global_parameter disk_free_limit 1000000000
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**ï¼š
> - å­—ç¬¦ä¸²å€¼éœ€è¦ç”¨å¼•å·åŒ…å›´
> - æ•°å€¼å¯ä»¥ç›´æ¥è®¾ç½®
> - ä¿®æ”¹å…¨å±€å‚æ•°å¯èƒ½éœ€è¦é‡å¯æœåŠ¡æ‰èƒ½ç”Ÿæ•ˆ

### 3.3 æŸ¥çœ‹å’Œåˆ é™¤å…¨å±€å‚æ•°


```bash
# æŸ¥çœ‹æ‰€æœ‰å…¨å±€å‚æ•°
rabbitmqctl list_global_parameters

# åˆ é™¤æŒ‡å®šå…¨å±€å‚æ•°
rabbitmqctl clear_global_parameter cluster_name
```

---

## 4. ğŸ”§ ç»„ä»¶å‚æ•°ç®¡ç†å‘½ä»¤


### 4.1 ç»„ä»¶å‚æ•°æ¦‚å¿µ


**ç®€å•ç†è§£**ï¼šå¦‚æœå…¨å±€å‚æ•°æ˜¯æ•´æ ‹æ¥¼çš„è®¾ç½®ï¼Œé‚£ä¹ˆç»„ä»¶å‚æ•°å°±æ˜¯æ¯ä¸ªæˆ¿é—´å†…éƒ¨çš„è®¾ç½®ï¼Œæ¯”å¦‚ç©ºè°ƒæ¸©åº¦ã€ç¯å…‰äº®åº¦ç­‰ã€‚

**ğŸ”¸ å¸¸è§ç»„ä»¶ç±»å‹**
```
federationï¼šè”é‚¦æ’ä»¶å‚æ•°
shovelï¼šé“²å­æ’ä»¶å‚æ•°
exchangeï¼šäº¤æ¢æœºç›¸å…³å‚æ•°
queueï¼šé˜Ÿåˆ—ç›¸å…³å‚æ•°
```

### 4.2 è®¾ç½®ç»„ä»¶å‚æ•°


```bash
# è®¾ç½®è”é‚¦å‚æ•°
rabbitmqctl set_parameter federation-upstream my-upstream \
'{"uri":"amqp://server1","expires":3600000}'

# è®¾ç½®é˜Ÿåˆ—å‚æ•°
rabbitmqctl set_parameter queue my-queue \
'{"max-length":1000,"overflow":"reject-publish"}'

# è®¾ç½®äº¤æ¢æœºå‚æ•°
rabbitmqctl set_parameter exchange my-exchange \
'{"alternate-exchange":"backup-exchange"}'
```

### 4.3 æŸ¥çœ‹å’Œåˆ é™¤ç»„ä»¶å‚æ•°


```bash
# æŸ¥çœ‹æ‰€æœ‰ç»„ä»¶å‚æ•°
rabbitmqctl list_parameters

# æŸ¥çœ‹ç‰¹å®šç»„ä»¶çš„å‚æ•°
rabbitmqctl list_parameters federation

# åˆ é™¤ç»„ä»¶å‚æ•°
rabbitmqctl clear_parameter federation-upstream my-upstream
```

---

## 5. ğŸ› ï¸ æƒé™ç®¡ç†å®æˆ˜æ¡ˆä¾‹


### 5.1 æ¡ˆä¾‹ä¸€ï¼šç”µå•†ç³»ç»Ÿæƒé™åˆ†é…


**åœºæ™¯æè¿°**ï¼šä¸€ä¸ªç”µå•†ç½‘ç«™æœ‰è®¢å•ç³»ç»Ÿã€åº“å­˜ç³»ç»Ÿã€æ”¯ä»˜ç³»ç»Ÿï¼Œéœ€è¦ç»™ä¸åŒç³»ç»Ÿåˆ†é…åˆé€‚çš„æƒé™ã€‚

```
ç³»ç»Ÿæ¶æ„ï¼š
è®¢å•ç³»ç»Ÿ â†’ éœ€è¦æ“ä½œ order_* ç›¸å…³èµ„æº
åº“å­˜ç³»ç»Ÿ â†’ éœ€è¦æ“ä½œ inventory_* ç›¸å…³èµ„æº  
æ”¯ä»˜ç³»ç»Ÿ â†’ éœ€è¦æ“ä½œ payment_* ç›¸å…³èµ„æº
ç›‘æ§ç³»ç»Ÿ â†’ éœ€è¦æŸ¥çœ‹æ‰€æœ‰èµ„æºçŠ¶æ€
```

**æƒé™é…ç½®æ­¥éª¤**ï¼š

```bash
# 1. åˆ›å»ºä¸åŒç³»ç»Ÿçš„ç”¨æˆ·
rabbitmqctl add_user order_service "order123"
rabbitmqctl add_user inventory_service "inventory123"
rabbitmqctl add_user payment_service "payment123"
rabbitmqctl add_user monitor_service "monitor123"

# 2. åˆ†é…å¯¹åº”çš„æƒé™
# è®¢å•ç³»ç»Ÿï¼šåªèƒ½æ“ä½œè®¢å•ç›¸å…³èµ„æº
rabbitmqctl set_permissions order_service "^order_.*" "^order_.*" "^order_.*"

# åº“å­˜ç³»ç»Ÿï¼šåªèƒ½æ“ä½œåº“å­˜ç›¸å…³èµ„æº
rabbitmqctl set_permissions inventory_service "^inventory_.*" "^inventory_.*" "^inventory_.*"

# æ”¯ä»˜ç³»ç»Ÿï¼šåªèƒ½æ“ä½œæ”¯ä»˜ç›¸å…³èµ„æº
rabbitmqctl set_permissions payment_service "^payment_.*" "^payment_.*" "^payment_.*"

# ç›‘æ§ç³»ç»Ÿï¼šåªèƒ½æŸ¥çœ‹ï¼Œä¸èƒ½ä¿®æ”¹
rabbitmqctl set_permissions monitor_service "^$" "^$" ".*"
```

### 5.2 æ¡ˆä¾‹äºŒï¼šå¼€å‘ç¯å¢ƒæƒé™éš”ç¦»


**åœºæ™¯æè¿°**ï¼šå…¬å¸æœ‰å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ä¸‰ä¸ªç¯å¢ƒï¼Œéœ€è¦ç¡®ä¿ä¸åŒç¯å¢ƒçš„æ•°æ®éš”ç¦»ã€‚

```bash
# 1. åˆ›å»ºä¸åŒç¯å¢ƒçš„è™šæ‹Ÿä¸»æœº
rabbitmqctl add_vhost /development
rabbitmqctl add_vhost /testing
rabbitmqctl add_vhost /production

# 2. åˆ›å»ºç”¨æˆ·å¹¶åˆ†é…ç¯å¢ƒæƒé™
# å¼€å‘äººå‘˜ï¼šåªèƒ½è®¿é—®å¼€å‘ç¯å¢ƒ
rabbitmqctl add_user developer "dev123"
rabbitmqctl set_permissions -p /development developer ".*" ".*" ".*"

# æµ‹è¯•äººå‘˜ï¼šå¯ä»¥è®¿é—®å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒ
rabbitmqctl add_user tester "test123"
rabbitmqctl set_permissions -p /development tester ".*" ".*" ".*"
rabbitmqctl set_permissions -p /testing tester ".*" ".*" ".*"

# è¿ç»´äººå‘˜ï¼šå¯ä»¥è®¿é—®æ‰€æœ‰ç¯å¢ƒ
rabbitmqctl add_user ops "ops123"
rabbitmqctl set_permissions -p /development ops ".*" ".*" ".*"
rabbitmqctl set_permissions -p /testing ops ".*" ".*" ".*"
rabbitmqctl set_permissions -p /production ops ".*" ".*" ".*"
```

### 5.3 æ¡ˆä¾‹ä¸‰ï¼šå¾®æœåŠ¡æƒé™æœ€å°åŒ–


**åœºæ™¯æè¿°**ï¼šå¾®æœåŠ¡æ¶æ„ä¸­ï¼Œæ¯ä¸ªæœåŠ¡åªåº”è¯¥æœ‰æœ€å°å¿…è¦æƒé™ã€‚

```bash
# ç”¨æˆ·æœåŠ¡ï¼šåªèƒ½å‘é€ç”¨æˆ·äº‹ä»¶ï¼Œæ¥æ”¶ç”¨æˆ·å‘½ä»¤
rabbitmqctl set_permissions user_service "^$" "^user\.events$" "^user\.commands$"

# è®¢å•æœåŠ¡ï¼šå¯ä»¥åˆ›å»ºè‡ªå·±çš„é˜Ÿåˆ—ï¼Œå‘é€è®¢å•äº‹ä»¶
rabbitmqctl set_permissions order_service "^order\..*" "^order\.events$" "^order\..*"

# é€šçŸ¥æœåŠ¡ï¼šåªæ¥æ”¶å„ç§äº‹ä»¶ï¼Œå‘é€é€šçŸ¥
rabbitmqctl set_permissions notification_service "^notification\..*" "^notification\..*" "^.*\.events$"
```

---

## 6. â“ å¸¸è§é—®é¢˜ä¸æœ€ä½³å®è·µ


### 6.1 æƒé™è®¾ç½®å¸¸è§é”™è¯¯


**ğŸš¨ é”™è¯¯1ï¼šæƒé™è¿‡å¤§**
```bash
# âŒ é”™è¯¯ï¼šç»™åº”ç”¨ç”¨æˆ·è¿‡å¤§æƒé™
rabbitmqctl set_permissions app_user ".*" ".*" ".*"

# âœ… æ­£ç¡®ï¼šåªç»™å¿…è¦æƒé™
rabbitmqctl set_permissions app_user "^app_.*" "^app_.*" "^app_.*"
```

**ğŸš¨ é”™è¯¯2ï¼šæ­£åˆ™è¡¨è¾¾å¼å†™é”™**
```bash
# âŒ é”™è¯¯ï¼šå¿˜è®°è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦
rabbitmqctl set_permissions user "order.queue" "order.queue" "order.queue"

# âœ… æ­£ç¡®ï¼šä½¿ç”¨æ­£ç¡®çš„æ­£åˆ™è¡¨è¾¾å¼
rabbitmqctl set_permissions user "^order\.queue$" "^order\.queue$" "^order\.queue$"
```

### 6.2 æƒé™ç®¡ç†æœ€ä½³å®è·µ


**ğŸ¯ æœ€å°æƒé™åŸåˆ™**
```
âœ… æ¯ä¸ªç”¨æˆ·åªç»™å¿…è¦çš„æœ€å°æƒé™
âœ… å®šæœŸå®¡æŸ¥å’Œæ¸…ç†ä¸éœ€è¦çš„æƒé™
âœ… ä½¿ç”¨å…·ä½“çš„èµ„æºåç§°è€Œä¸æ˜¯é€šé…ç¬¦
âœ… ä¸ºä¸åŒç¯å¢ƒåˆ›å»ºä¸åŒçš„ç”¨æˆ·
```

**ğŸ”’ å®‰å…¨å»ºè®®**
```
âš ï¸ åˆ é™¤é»˜è®¤çš„guestç”¨æˆ·ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
âš ï¸ ä½¿ç”¨å¼ºå¯†ç ç­–ç•¥
âš ï¸ å®šæœŸè½®æ¢ç”¨æˆ·å¯†ç 
âš ï¸ ç›‘æ§æƒé™ä½¿ç”¨æƒ…å†µ
```

### 6.3 æƒé™æ•…éšœæ’æŸ¥


**ğŸ’¡ å¸¸è§æ•…éšœåŠè§£å†³æ–¹æ³•**

| é—®é¢˜ç—‡çŠ¶ | **å¯èƒ½åŸå› ** | **æ’æŸ¥å‘½ä»¤** | **è§£å†³æ–¹æ³•** |
|---------|-------------|-------------|-------------|
| ğŸš« **æ— æ³•åˆ›å»ºé˜Ÿåˆ—** | ç¼ºå°‘configureæƒé™ | `list_user_permissions user` | æ·»åŠ configureæƒé™ |
| ğŸš« **æ— æ³•å‘é€æ¶ˆæ¯** | ç¼ºå°‘writeæƒé™ | `list_permissions` | æ·»åŠ writeæƒé™ |
| ğŸš« **æ— æ³•æ¶ˆè´¹æ¶ˆæ¯** | ç¼ºå°‘readæƒé™ | `list_user_permissions user` | æ·»åŠ readæƒé™ |
| ğŸ”„ **æƒé™ä¸ç”Ÿæ•ˆ** | ç”¨æˆ·è¿æ¥æœªé‡æ–°å»ºç«‹ | é‡å¯åº”ç”¨è¿æ¥ | æ–­å¼€é‡è¿ |

```bash
# æƒé™è¯Šæ–­æ­¥éª¤
# 1. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨
rabbitmqctl list_users

# 2. æ£€æŸ¥ç”¨æˆ·æƒé™
rabbitmqctl list_user_permissions username

# 3. æ£€æŸ¥è™šæ‹Ÿä¸»æœºæƒé™
rabbitmqctl list_permissions -p /vhost

# 4. æµ‹è¯•è¿æ¥
rabbitmqctl eval 'rabbit_access_control:check_user_pass_login(<<"username">>, <<"password">>).'
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æƒé™ä¸‰ç»´åº¦ï¼šConfigureï¼ˆé…ç½®ï¼‰ã€Writeï¼ˆå†™å…¥ï¼‰ã€Readï¼ˆè¯»å–ï¼‰
ğŸ”¸ æƒé™æ§åˆ¶ï¼šé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…èµ„æºåç§°
ğŸ”¸ æƒé™èŒƒå›´ï¼šåŸºäºVirtual Hostè¿›è¡Œéš”ç¦»
ğŸ”¸ æƒé™å±‚çº§ï¼šå…¨å±€å‚æ•° > ç»„ä»¶å‚æ•° > ç”¨æˆ·æƒé™
ğŸ”¸ å®‰å…¨åŸåˆ™ï¼šæœ€å°æƒé™ + å®šæœŸå®¡æŸ¥ + ç¯å¢ƒéš”ç¦»
```

### 7.2 å…³é”®å‘½ä»¤é€ŸæŸ¥


**ğŸ”¹ ç”¨æˆ·æƒé™ç®¡ç†**
```bash
# è®¾ç½®æƒé™ï¼šrabbitmqctl set_permissions user conf write read
# æ¸…é™¤æƒé™ï¼šrabbitmqctl clear_permissions user
# æŸ¥çœ‹æƒé™ï¼šrabbitmqctl list_permissions
# æŸ¥çœ‹ç”¨æˆ·æƒé™ï¼šrabbitmqctl list_user_permissions user
```

**ğŸ”¹ å‚æ•°ç®¡ç†**
```bash
# å…¨å±€å‚æ•°ï¼šset_global_parameter / clear_global_parameter / list_global_parameters
# ç»„ä»¶å‚æ•°ï¼šset_parameter / clear_parameter / list_parameters
```

**ğŸ”¹ æƒé™æ¨¡å¼è®°å¿†**
```
ç®¡ç†å‘˜æ¨¡å¼ï¼š".*" ".*" ".*"      â† å®Œå…¨æ§åˆ¶
ç›‘æ§æ¨¡å¼ï¼š"^$" "^$" ".*"       â† åªè¯»è®¿é—®
å‘é€æ¨¡å¼ï¼š"^$" ".*" "^$"       â† åªèƒ½å‘é€
æ¥æ”¶æ¨¡å¼ï¼š"^$" "^$" ".*"       â† åªèƒ½æ¥æ”¶
ä¸šåŠ¡æ¨¡å¼ï¼š"^app_.*" "^app_.*" "^app_.*" â† é™å®šèµ„æº
```

### 7.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ æƒé™è®¾è®¡æ­¥éª¤**
1. **åˆ†æéœ€æ±‚**ï¼šç¡®å®šæ¯ä¸ªç”¨æˆ·/ç³»ç»Ÿéœ€è¦ä»€ä¹ˆæƒé™
2. **è®¾è®¡éš”ç¦»**ï¼šä½¿ç”¨Virtual Hostéš”ç¦»ä¸åŒç¯å¢ƒ
3. **æœ€å°æˆæƒ**ï¼šåªç»™å¿…è¦çš„æœ€å°æƒé™
4. **æ­£åˆ™ç²¾ç¡®**ï¼šä½¿ç”¨ç²¾ç¡®çš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…
5. **æµ‹è¯•éªŒè¯**ï¼šè®¾ç½®åè¦æµ‹è¯•æƒé™æ˜¯å¦ç”Ÿæ•ˆ
6. **å®šæœŸå®¡æŸ¥**ï¼šå®šæœŸæ£€æŸ¥å’Œæ¸…ç†æƒé™

**ğŸ’¡ è®°å¿†å£è¯€**
```
æƒé™ç®¡ç†ä¸‰æ­¥èµ°ï¼š
è®¾ç½®æƒé™è¦ç²¾å‡†ï¼Œæ­£åˆ™è¡¨è¾¾å¼åˆ«å†™é”™
æŸ¥çœ‹æƒé™è¦åŠæ—¶ï¼Œlistå‘½ä»¤å¸®ä½ æ£€
æ¸…é™¤æƒé™è¦è°¨æ…ï¼Œè¯¯åˆ æƒé™æ–­è¿æ¥
```

**æ ¸å¿ƒä»·å€¼**ï¼š
- æƒé™ç®¡ç†æ˜¯RabbitMQå®‰å…¨çš„åŸºç¡€ï¼Œåˆç†çš„æƒé™è®¾ç½®èƒ½ä¿æŠ¤ç³»ç»Ÿå®‰å…¨
- æœ€å°æƒé™åŸåˆ™èƒ½é™ä½å®‰å…¨é£é™©ï¼Œæé«˜ç³»ç»Ÿç¨³å®šæ€§
- æ¸…æ™°çš„æƒé™åˆ†é…æœ‰åŠ©äºå›¢é˜Ÿåä½œå’Œç³»ç»Ÿç»´æŠ¤