---
title: 1、安装部署实践
---
## 📚 目录


1. [RabbitMQ安装概述](#1-rabbitmq安装概述)
2. [Docker快速部署方案](#2-docker快速部署方案)
3. [Linux环境安装部署](#3-linux环境安装部署)
4. [Windows环境搭建](#4-windows环境搭建)
5. [服务管理与配置](#5-服务管理与配置)
6. [端口配置详解](#6-端口配置详解)
7. [核心要点总结](#7-核心要点总结)

---

## 1. 🚀 RabbitMQ安装概述



### 1.1 什么是RabbitMQ安装部署



**简单理解**：就像在你的电脑或服务器上安装一个"邮局系统"

```
现实邮局系统：           RabbitMQ消息系统：
寄信人 → 邮局 → 收信人    发送者 → RabbitMQ → 接收者
邮局需要地址和营业时间    RabbitMQ需要IP地址和端口号
```

**核心作用**：
- 🏪 **消息中转站**：接收、存储、转发消息
- 🔌 **服务接口**：提供网络接口让程序连接
- 🛡️ **管理界面**：提供Web界面管理消息队列

### 1.2 安装前必知概念



**RabbitMQ的本质**：
- **消息代理**（Message Broker）：专门处理消息传递的服务器软件
- **AMQP协议**：消息传递的"语言规范"，就像HTTP是网页传输的规范
- **Erlang运行环境**：RabbitMQ用Erlang语言编写，需要Erlang虚拟机

**为什么需要安装**：
```
没有RabbitMQ：
程序A → 直接调用 → 程序B
问题：程序B崩溃，消息丢失

有了RabbitMQ：
程序A → RabbitMQ → 程序B
优势：RabbitMQ保存消息，程序B恢复后继续处理
```

### 1.3 安装方式选择指南



| 安装方式 | **适用场景** | **优势** | **难度** |
|---------|-------------|---------|---------|
| 🐳 **Docker部署** | `开发测试、快速上手` | `安装简单、环境隔离` | `⭐低` |
| 🐧 **Linux安装** | `生产环境、性能要求高` | `性能最佳、配置灵活` | `⭐⭐中` |
| 💻 **Windows安装** | `个人学习、Windows开发` | `图形化界面友好` | `⭐⭐中` |

> 💡 **新手建议**：优先选择Docker方式，几分钟就能运行起来，适合学习和测试

---

## 2. 🐳 Docker快速部署方案



### 2.1 为什么选择Docker



**Docker的好处**（用通俗比喻）：
```
传统安装像装修房子：
- 要准备各种工具材料（Erlang、依赖包）
- 要处理各种兼容性问题
- 出问题很难清理干净

Docker像住酒店：
- 房间已经装修好（环境已配置）
- 拎包入住即可（一条命令启动）
- 不喜欢随时退房（删除容器）
```

### 2.2 Docker安装步骤



#### 🔸 步骤1：拉取RabbitMQ镜像



```bash
# 拉取官方镜像（包含管理界面）

docker pull rabbitmq:3.12-management

# 验证镜像下载成功

docker images | grep rabbitmq
```

> 📝 **解释**：`3.12-management`表示3.12版本并包含Web管理界面，这是新手最推荐的版本

#### 🔸 步骤2：启动RabbitMQ容器



```bash
# 快速启动命令

docker run -d \
  --name my-rabbitmq \
  -p 5672:5672 \
  -p 15672:15672 \
  -e RABBITMQ_DEFAULT_USER=admin \
  -e RABBITMQ_DEFAULT_PASS=admin123 \
  rabbitmq:3.12-management
```

**参数详解**：
- `-d`：后台运行，不占用终端
- `--name my-rabbitmq`：给容器起个名字，方便管理
- `-p 5672:5672`：程序连接端口（后面详细讲）
- `-p 15672:15672`：Web管理界面端口
- `-e`：设置环境变量，创建管理员账号

#### 🔸 步骤3：验证安装成功



```bash
# 查看容器运行状态

docker ps | grep rabbitmq

# 查看容器日志

docker logs my-rabbitmq
```

**验证成功标志**：
- 🟢 容器状态显示`Up`
- 🟢 日志显示`Server startup complete`
- 🟢 浏览器访问`http://localhost:15672`能打开管理界面

### 2.3 Docker部署的优化配置



#### 🔸 数据持久化配置



```bash
# 创建数据目录

mkdir -p ~/rabbitmq/data ~/rabbitmq/logs

# 带数据持久化的启动命令

docker run -d \
  --name rabbitmq-persistent \
  -p 5672:5672 \
  -p 15672:15672 \
  -v ~/rabbitmq/data:/var/lib/rabbitmq \
  -v ~/rabbitmq/logs:/var/log/rabbitmq \
  -e RABBITMQ_DEFAULT_USER=admin \
  -e RABBITMQ_DEFAULT_PASS=admin123 \
  rabbitmq:3.12-management
```

> ⚠️ **重要**：数据持久化确保容器重启后队列和消息不丢失

### 2.4 Docker常用管理命令



```bash
# 启动容器

docker start my-rabbitmq

# 停止容器

docker stop my-rabbitmq

# 重启容器

docker restart my-rabbitmq

# 删除容器（数据会丢失）

docker rm -f my-rabbitmq

# 进入容器内部

docker exec -it my-rabbitmq bash
```

---

## 3. 🐧 Linux环境安装部署



### 3.1 Linux安装的优势与场景



**为什么选择Linux安装**：
- 🚀 **性能最优**：直接运行在系统上，没有容器开销
- 🔧 **配置灵活**：可以精细调整各种参数
- 🏭 **生产环境**：企业级部署的标准选择
- 📊 **资源监控**：方便与系统监控工具集成

### 3.2 系统环境准备



#### 🔸 系统要求检查



```bash
# 查看系统版本

cat /etc/os-release

# 检查系统位数

uname -m

# 查看可用内存（建议至少1GB）

free -h
```

**支持的Linux发行版**：
- ✅ Ubuntu 18.04+
- ✅ CentOS 7+
- ✅ RHEL 7+
- ✅ Debian 9+

### 3.3 使用包管理器安装（推荐方式）



#### 🔸 Ubuntu/Debian系统安装



```bash
# 步骤1：更新包索引

sudo apt update

# 步骤2：安装依赖包

sudo apt install curl gnupg apt-transport-https

# 步骤3：添加RabbitMQ官方仓库

curl -1sLf "https://keys.openpgp.org/vks/v1/by-fingerprint/0A9AF2115F4687BD29803A206B73A36E6026DFCA" | sudo gpg --dearmor | sudo tee /usr/share/keyrings/com.rabbitmq.team.gpg > /dev/null

# 步骤4：添加仓库源

echo "deb [signed-by=/usr/share/keyrings/com.rabbitmq.team.gpg] https://ppa1.novemberain.com/rabbitmq/rabbitmq-server/deb/ubuntu jammy main" | sudo tee /etc/apt/sources.list.d/rabbitmq.list

# 步骤5：安装RabbitMQ

sudo apt update
sudo apt install rabbitmq-server
```

#### 🔸 CentOS/RHEL系统安装



```bash
# 步骤1：添加EPEL仓库

sudo yum install epel-release

# 步骤2：添加RabbitMQ仓库

curl -s https://packagecloud.io/install/repositories/rabbitmq/rabbitmq-server/script.rpm.sh | sudo bash

# 步骤3：安装RabbitMQ

sudo yum install rabbitmq-server
```

### 3.4 源码编译安装



> 📝 **说明**：源码安装适合需要自定义编译选项的高级用户，新手建议使用包管理器安装

#### 🔸 安装Erlang环境



```bash
# Ubuntu安装Erlang

sudo apt install erlang-nox

# CentOS安装Erlang

sudo yum install erlang
```

#### 🔸 下载并编译RabbitMQ



```bash
# 下载源码

wget https://github.com/rabbitmq/rabbitmq-server/releases/download/v3.12.0/rabbitmq-server-3.12.0.tar.xz

# 解压

tar -xf rabbitmq-server-3.12.0.tar.xz
cd rabbitmq-server-3.12.0

# 编译安装

make
sudo make install
```

### 3.5 Linux服务配置



#### 🔸 启用并启动服务



```bash
# 启用开机自启

sudo systemctl enable rabbitmq-server

# 启动服务

sudo systemctl start rabbitmq-server

# 查看服务状态

sudo systemctl status rabbitmq-server
```

#### 🔸 启用Web管理插件



```bash
# 启用管理插件

sudo rabbitmq-plugins enable rabbitmq_management

# 重启服务使插件生效

sudo systemctl restart rabbitmq-server
```

---

## 4. 💻 Windows环境搭建



### 4.1 Windows安装的特点



**Windows安装适合**：
- 🏠 **个人学习**：Windows是大多数人熟悉的系统
- 💻 **开发环境**：在Windows上开发.NET、Java应用
- 🎯 **图形化管理**：Windows服务管理界面直观

### 4.2 下载安装包



#### 🔸 官方下载地址



访问RabbitMQ官网：`https://www.rabbitmq.com/download.html`

**下载文件**：
- `rabbitmq-server-3.12.0.exe`（约30MB）
- 包含Erlang运行环境，无需单独安装

#### 🔸 系统要求



- 🖥️ **操作系统**：Windows 10/11 或 Windows Server 2016+
- 💾 **内存**：最少512MB，推荐1GB+
- 💿 **磁盘空间**：200MB以上

### 4.3 安装步骤详解



#### 🔸 步骤1：运行安装程序



1. 右键`rabbitmq-server-3.12.0.exe`，选择"以管理员身份运行"
2. 点击"Next"继续安装向导
3. 选择安装路径（默认：`C:\Program Files\RabbitMQ Server`）
4. 选择开始菜单文件夹
5. 勾选"Install as a service"（安装为Windows服务）

#### 🔸 步骤2：完成安装配置



```cmd
# 打开命令提示符（管理员模式）

# 进入RabbitMQ安装目录

cd "C:\Program Files\RabbitMQ Server\rabbitmq_server-3.12.0\sbin"

# 启用管理插件

rabbitmq-plugins.bat enable rabbitmq_management

# 启动RabbitMQ服务

net start RabbitMQ
```

### 4.4 Windows服务管理



#### 🔸 使用Windows服务管理器



```
1. 按 Win+R，输入 services.msc
2. 找到 "RabbitMQ" 服务
3. 右键可以启动、停止、重启服务
4. 属性中可以设置自动启动
```

#### 🔸 命令行管理



```cmd
# 启动服务

net start RabbitMQ

# 停止服务

net stop RabbitMQ

# 查看服务状态

sc query RabbitMQ
```

---

## 5. ⚙️ 服务管理与配置



### 5.1 服务启动与停止操作



#### 🔸 系统服务方式（推荐）



**Linux系统**：
```bash
# 启动服务

sudo systemctl start rabbitmq-server

# 停止服务

sudo systemctl stop rabbitmq-server

# 重启服务

sudo systemctl restart rabbitmq-server

# 查看状态

sudo systemctl status rabbitmq-server

# 开机自启

sudo systemctl enable rabbitmq-server
```

**Windows系统**：
```cmd
# 启动服务

net start RabbitMQ

# 停止服务

net stop RabbitMQ

# 重启服务（先停止再启动）

net stop RabbitMQ && net start RabbitMQ
```

#### 🔸 直接命令方式



```bash
# 前台运行（调试用）

sudo rabbitmq-server

# 后台运行

sudo rabbitmq-server -detached

# 停止服务

sudo rabbitmqctl stop
```

> ⚠️ **注意**：生产环境建议使用系统服务方式，方便管理和监控

### 5.2 服务状态检查



#### 🔸 基本状态检查



```bash
# 检查服务是否运行

sudo rabbitmqctl status

# 检查节点信息

sudo rabbitmqctl node_health_check

# 查看集群状态

sudo rabbitmqctl cluster_status
```

**正常运行的标志**：
- ✅ Status显示为`running`
- ✅ 内存和磁盘使用正常
- ✅ 监听端口处于活动状态

#### 🔸 详细诊断信息



```bash
# 查看环境信息

sudo rabbitmqctl environment

# 查看报告

sudo rabbitmqctl report

# 检查权限

sudo rabbitmqctl list_permissions
```

### 5.3 配置文件详解



#### 🔸 主配置文件位置



**Linux系统**：
- 📁 `/etc/rabbitmq/rabbitmq.conf`（主配置）
- 📁 `/etc/rabbitmq/rabbitmq-env.conf`（环境变量）

**Windows系统**：
- 📁 `%APPDATA%\RabbitMQ\rabbitmq.conf`

#### 🔸 基础配置示例



```conf
# /etc/rabbitmq/rabbitmq.conf


# 网络配置


listeners.tcp.default = 5672
management.tcp.port = 15672

# 内存配置


vm_memory_high_watermark.relative = 0.6

# 磁盘配置


disk_free_limit.relative = 2.0

# 日志配置


log.console = true
log.console.level = info

# 集群配置（可选）


cluster_formation.peer_discovery_backend = classic_config
```

**配置说明**：
- `listeners.tcp.default`：程序连接端口
- `management.tcp.port`：Web管理界面端口
- `vm_memory_high_watermark`：内存使用限制
- `disk_free_limit`：磁盘空间限制

---

## 6. 🔌 端口配置详解



### 6.1 RabbitMQ端口全景图



```
RabbitMQ端口用途图：
┌─────────────────────────────────────────┐
│              RabbitMQ服务器              │
├─────────────────────────────────────────┤
│  5672  │ AMQP协议端口（程序连接）      │
│  15672 │ Web管理界面（浏览器访问）      │
│  25672 │ 集群节点通信端口              │
│  4369  │ Erlang端口映射守护进程        │
│  35197 │ CLI工具连接端口（随机）        │
└─────────────────────────────────────────┘
```

### 6.2 核心端口详解



#### 🔸 5672端口 - AMQP协议端口



**作用**：应用程序连接RabbitMQ的主要端口
```
应用程序 ←→ 5672端口 ←→ RabbitMQ
   |
发送/接收消息的通道
```

**使用场景**：
- Java程序连接RabbitMQ
- Python程序连接RabbitMQ  
- 其他语言的客户端程序

**连接示例**：
```python
# Python连接示例

import pika
connection = pika.BlockingConnection(
    pika.ConnectionParameters('localhost', 5672)
)
```

#### 🔸 15672端口 - Web管理界面



**作用**：通过浏览器管理RabbitMQ的Web界面
```
浏览器 ←→ 15672端口 ←→ RabbitMQ管理插件
   |
图形化管理界面
```

**功能特点**：
- 🖥️ **可视化管理**：创建队列、交换机、绑定
- 📊 **监控面板**：查看消息数量、连接状态
- 👤 **用户管理**：创建用户、分配权限
- 🔧 **配置管理**：修改参数、导入导出配置

**访问方式**：
```
浏览器地址：http://localhost:15672
默认账号：guest
默认密码：guest
```

> 💡 **提示**：guest账号只能在localhost访问，远程访问需要创建其他账号

#### 🔸 25672端口 - 集群通信端口



**作用**：RabbitMQ集群节点之间通信的端口
```
节点A ←→ 25672端口 ←→ 节点B
   |
集群数据同步
```

**使用场景**：
- 多台服务器组成RabbitMQ集群
- 节点之间同步队列、消息、状态信息
- 高可用部署必需端口

### 6.3 端口配置与防火墙设置



#### 🔸 Linux防火墙配置



**Ubuntu/Debian（ufw）**：
```bash
# 开放RabbitMQ端口

sudo ufw allow 5672
sudo ufw allow 15672
sudo ufw allow 25672

# 仅允许特定IP访问管理界面

sudo ufw allow from 192.168.1.0/24 to any port 15672
```

**CentOS/RHEL（firewalld）**：
```bash
# 开放端口

sudo firewall-cmd --permanent --add-port=5672/tcp
sudo firewall-cmd --permanent --add-port=15672/tcp
sudo firewall-cmd --permanent --add-port=25672/tcp

# 重载防火墙配置

sudo firewall-cmd --reload
```

#### 🔸 Windows防火墙配置



```cmd
# 打开Windows防火墙高级设置

# 新建入站规则 → 端口 → TCP → 特定本地端口

# 分别添加：5672, 15672, 25672

```

### 6.4 端口测试与验证



#### 🔸 端口连通性测试



```bash
# 测试5672端口

telnet localhost 5672

# 测试15672端口（应该有HTTP响应）

curl http://localhost:15672

# 查看端口监听状态

netstat -tlnp | grep rabbitmq
```

**正常输出示例**：
```
tcp  0  0  0.0.0.0:5672   0.0.0.0:*  LISTEN  1234/beam.smp
tcp  0  0  0.0.0.0:15672  0.0.0.0:*  LISTEN  1234/beam.smp
tcp  0  0  0.0.0.0:25672  0.0.0.0:*  LISTEN  1234/beam.smp
```

---

## 7. 📋 核心要点总结



### 7.1 必须掌握的安装要点



```
🔸 RabbitMQ本质：消息代理服务器，需要安装和配置
🔸 安装方式选择：Docker适合学习，Linux适合生产，Windows适合开发
🔸 核心端口：5672（程序连接）、15672（Web管理）、25672（集群通信）
🔸 服务管理：使用系统服务方式启停，方便管理和监控
🔸 配置文件：主要配置网络、内存、磁盘、日志等参数
```

### 7.2 新手常见问题与解决



**🔹 问题1：无法访问Web管理界面**
```
原因分析：
- 管理插件未启用
- 防火墙阻挡15672端口
- guest账号远程访问限制

解决方案：
1. 启用插件：rabbitmq-plugins enable rabbitmq_management
2. 开放端口：sudo ufw allow 15672
3. 创建新用户：rabbitmqctl add_user admin password
```

**🔹 问题2：程序无法连接RabbitMQ**
```
原因分析：
- RabbitMQ服务未启动
- 5672端口被防火墙阻挡
- 连接参数错误

解决方案：
1. 检查服务：systemctl status rabbitmq-server
2. 测试端口：telnet localhost 5672
3. 检查代码中的主机地址和端口
```

**🔹 问题3：Docker容器无法启动**
```
原因分析：
- 端口被占用
- 权限不足
- 镜像下载失败

解决方案：
1. 更换端口：-p 5673:5672 -p 15673:15672
2. 检查Docker权限：sudo docker ps
3. 重新拉取镜像：docker pull rabbitmq:3.12-management
```

### 7.3 最佳实践建议



**🔧 安装阶段最佳实践**：
- ✅ 新手优先选择Docker部署，简单快速
- ✅ 生产环境使用包管理器安装，便于维护
- ✅ 启用Web管理插件，方便调试和监控
- ✅ 配置防火墙规则，确保安全性
- ✅ 设置数据持久化，避免数据丢失

**🔒 安全配置要点**：
- 🚨 修改默认账号密码
- 🚨 限制管理界面访问IP范围
- 🚨 定期备份配置和数据
- 🚨 监控服务运行状态
- 🚨 及时更新到稳定版本

**📊 性能优化提示**：
- 💾 根据业务需求调整内存限制
- 📁 配置适当的磁盘空间预警
- 🔄 设置合理的日志轮转策略
- ⚡ 在SSD上存储数据目录

### 7.4 下一步学习方向



安装完成后，建议按以下顺序学习：
1. **Web管理界面熟悉**：了解各个功能菜单
2. **基础概念学习**：队列、交换机、绑定等
3. **简单程序编写**：发送和接收第一个消息
4. **用户权限管理**：创建用户和虚拟主机
5. **监控和运维**：掌握日常管理技能

**核心记忆**：
- RabbitMQ是消息代理服务，需要先安装才能使用
- Docker方式最简单，Linux方式最稳定，Windows方式最直观
- 三个核心端口：5672连程序，15672管理界面，25672做集群
- 服务管理用系统命令，配置修改重启生效