---
title: 6ã€æ•°æ®æ¢å¤å®è·µ
---
## ğŸ“š ç›®å½•


1. [æ•°æ®æ¢å¤åŸºç¡€æ¦‚å¿µ](#1-æ•°æ®æ¢å¤åŸºç¡€æ¦‚å¿µ)
2. [æ¶ˆæ¯æ•°æ®æ¢å¤](#2-æ¶ˆæ¯æ•°æ®æ¢å¤)
3. [é…ç½®æ¢å¤æ–¹æ³•](#3-é…ç½®æ¢å¤æ–¹æ³•)
4. [é˜Ÿåˆ—é‡å»ºç­–ç•¥](#4-é˜Ÿåˆ—é‡å»ºç­–ç•¥)
5. [æƒé™æ¢å¤æµç¨‹](#5-æƒé™æ¢å¤æµç¨‹)
6. [éªŒè¯æµ‹è¯•æ–¹æ³•](#6-éªŒè¯æµ‹è¯•æ–¹æ³•)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

# ğŸ“ **éš¾åº¦ç­‰çº§**ï¼šğŸŸ¡ ä¸­çº§ - éœ€è¦æŒæ¡åŸºæœ¬RabbitMQæ“ä½œ



å½“ä½ çš„RabbitMQå‡ºç°æ•…éšœåï¼Œæœ€é‡è¦çš„å°±æ˜¯æŠŠæ•°æ®æ‰¾å›æ¥ã€‚å°±åƒç”µè„‘åäº†è¦æ¢å¤æ–‡ä»¶ä¸€æ ·ï¼ŒRabbitMQçš„æ¢å¤ä¹Ÿæœ‰ä¸€å¥—å®Œæ•´çš„æµç¨‹ã€‚

---

## 1. ğŸ”„ æ•°æ®æ¢å¤åŸºç¡€æ¦‚å¿µ



### 1.1 ä»€ä¹ˆæ˜¯æ•°æ®æ¢å¤



**ğŸ”¸ ç®€å•ç†è§£**
```
æ•°æ®æ¢å¤ = æŠŠä¸¢å¤±çš„ä¸œè¥¿æ‰¾å›æ¥

æ¯”å¦‚è¯´ï¼š
- ä½ çš„æ¶ˆæ¯é˜Ÿåˆ—çªç„¶æ²¡äº†
- ç”¨æˆ·è´¦å·å’Œæƒé™éƒ½æ¶ˆå¤±äº†
- äº¤æ¢æœºå’Œç»‘å®šå…³ç³»å…¨éƒ¨é‡ç½®

è¿™æ—¶å€™å°±éœ€è¦æ•°æ®æ¢å¤æ¥æ‹¯æ•‘ä½ 
```

**ğŸ’¡ RabbitMQæ•°æ®æ¢å¤åŒ…å«ä»€ä¹ˆ**
```
ğŸ“Š éœ€è¦æ¢å¤çš„å†…å®¹ï¼š
â€¢ ğŸ“¨ æ¶ˆæ¯æ•°æ®ï¼šé˜Ÿåˆ—ä¸­çš„å…·ä½“æ¶ˆæ¯
â€¢ âš™ï¸ é…ç½®ä¿¡æ¯ï¼šäº¤æ¢æœºã€é˜Ÿåˆ—ã€ç»‘å®šå…³ç³»
â€¢ ğŸ‘¥ ç”¨æˆ·æƒé™ï¼šè´¦å·ã€å¯†ç ã€è®¿é—®æƒé™
â€¢ ğŸ”§ ç³»ç»Ÿè®¾ç½®ï¼šé›†ç¾¤é…ç½®ã€ç­–ç•¥è®¾ç½®
```

### 1.2 æ¢å¤çš„å‰ææ¡ä»¶



**ğŸ”‘ æ¢å¤éœ€è¦ä»€ä¹ˆ**
```
å¿…éœ€æ¡ä»¶ï¼š
âœ… æœ‰å¤‡ä»½æ–‡ä»¶ï¼ˆè¿™æ˜¯æœ€é‡è¦çš„ï¼ï¼‰
âœ… RabbitMQæœåŠ¡èƒ½æ­£å¸¸å¯åŠ¨
âœ… è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´
âœ… æ­£ç¡®çš„æ“ä½œæƒé™

å¯é€‰ä½†å»ºè®®ï¼š
ğŸ”¸ æµ‹è¯•ç¯å¢ƒå…ˆéªŒè¯
ğŸ”¸ åœæœºç»´æŠ¤æ—¶é—´çª—å£
ğŸ”¸ å›æ»šè®¡åˆ’å‡†å¤‡
```

**âš ï¸ å¸¸è§æ¢å¤åœºæ™¯**
```
ä»€ä¹ˆæ—¶å€™éœ€è¦æ¢å¤ï¼š
1. ğŸ’¥ æœåŠ¡å™¨ç¡¬ä»¶æ•…éšœ
2. ğŸ—‘ï¸ è¯¯åˆ é™¤æ“ä½œ
3. ğŸ’¾ ç£ç›˜ç©ºé—´è€—å°½å¯¼è‡´æ•°æ®æŸå
4. ğŸ”„ ç‰ˆæœ¬å‡çº§å¤±è´¥
5. ğŸ¢ è¿ç§»åˆ°æ–°æœåŠ¡å™¨
```

---

## 2. ğŸ“¨ æ¶ˆæ¯æ•°æ®æ¢å¤



### 2.1 ç†è§£æ¶ˆæ¯æŒä¹…åŒ–æœºåˆ¶



**ğŸ§  å…ˆç†è§£æ¶ˆæ¯æ˜¯æ€ä¹ˆå­˜å‚¨çš„**
```
RabbitMQæ¶ˆæ¯å­˜å‚¨æ–¹å¼ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    å†…å­˜æ¶ˆæ¯     â”‚ â† ä¸´æ—¶å­˜å‚¨ï¼Œé‡å¯ä¸¢å¤±
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    æŒä¹…åŒ–æ¶ˆæ¯   â”‚ â† å†™å…¥ç£ç›˜ï¼Œå¯ä»¥æ¢å¤
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åªæœ‰æŒä¹…åŒ–çš„æ¶ˆæ¯æ‰èƒ½æ¢å¤ï¼
```

**ğŸ“‚ æ¶ˆæ¯æ–‡ä»¶ä½ç½®**
```bash
# é»˜è®¤æ•°æ®ç›®å½•

/var/lib/rabbitmq/mnesia/

# æ¶ˆæ¯å­˜å‚¨æ–‡ä»¶

rabbit@hostname/msg_stores/vhosts/
â”œâ”€â”€ msg_store_persistent/  # æŒä¹…åŒ–æ¶ˆæ¯
â”œâ”€â”€ msg_store_transient/   # ä¸´æ—¶æ¶ˆæ¯
â””â”€â”€ recovery.dets         # æ¢å¤ç´¢å¼•æ–‡ä»¶
```

### 2.2 æ¶ˆæ¯æ¢å¤æ“ä½œæ­¥éª¤



**ğŸ”„ **Step 1** ğŸš€ åœæ­¢RabbitMQæœåŠ¡**
```bash
# å®‰å…¨åœæ­¢æœåŠ¡

sudo systemctl stop rabbitmq-server

# ç¡®è®¤è¿›ç¨‹å®Œå…¨åœæ­¢

sudo rabbitmqctl stop
```

**ğŸ”„ **Step 2** ğŸ’¾ å¤‡ä»½å½“å‰æ•°æ®**
```bash
# å¤‡ä»½ç°æœ‰æ•°æ®ï¼ˆä»¥é˜²ä¸‡ä¸€ï¼‰

sudo cp -r /var/lib/rabbitmq/mnesia /backup/current-mnesia-$(date +%Y%m%d)

# æ£€æŸ¥å¤‡ä»½å®Œæ•´æ€§

sudo ls -la /backup/current-mnesia-*
```

**ğŸ”„ **Step 3** ğŸ”„ æ¢å¤æ•°æ®æ–‡ä»¶**
```bash
# ä»å¤‡ä»½æ¢å¤æ•°æ®

sudo rm -rf /var/lib/rabbitmq/mnesia/*
sudo cp -r /backup/rabbitmq-backup/mnesia/* /var/lib/rabbitmq/mnesia/

# ä¿®æ­£æ–‡ä»¶æƒé™

sudo chown -R rabbitmq:rabbitmq /var/lib/rabbitmq/mnesia
sudo chmod -R 755 /var/lib/rabbitmq/mnesia
```

**ğŸ”„ **Step 4** âœ… å¯åŠ¨å¹¶éªŒè¯**
```bash
# å¯åŠ¨æœåŠ¡

sudo systemctl start rabbitmq-server

# æ£€æŸ¥æœåŠ¡çŠ¶æ€

sudo rabbitmqctl status

# éªŒè¯æ¶ˆæ¯æ˜¯å¦æ¢å¤

sudo rabbitmqctl list_queues name messages
```

### 2.3 æ¶ˆæ¯æ¢å¤éªŒè¯



**ğŸ“Š **æ£€æŸ¥æ¢å¤ç»“æœ**
```bash
# æŸ¥çœ‹é˜Ÿåˆ—æ¶ˆæ¯æ•°é‡

sudo rabbitmqctl list_queues name messages messages_ready

# æŸ¥çœ‹å…·ä½“é˜Ÿåˆ—å†…å®¹ï¼ˆå¼€å‘ç¯å¢ƒå¯ç”¨ï¼‰

sudo rabbitmqctl list_queue_bindings

# æ£€æŸ¥æ¶ˆæ¯æ˜¯å¦å®Œæ•´

curl -u admin:password http://localhost:15672/api/queues
```

---

## 3. âš™ï¸ é…ç½®æ¢å¤æ–¹æ³•



### 3.1 ç†è§£RabbitMQé…ç½®ç»“æ„



**ğŸ—ï¸ RabbitMQé…ç½®åŒ…å«ä»€ä¹ˆ**
```
é…ç½®å±‚æ¬¡ç»“æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Virtual Host  â”‚ â† è™šæ‹Ÿä¸»æœº
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Exchange      â”‚ â† äº¤æ¢æœº
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Queue         â”‚ â† é˜Ÿåˆ—
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Binding       â”‚ â† ç»‘å®šå…³ç³»
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Policy        â”‚ â† ç­–ç•¥é…ç½®
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 å¯¼å‡ºé…ç½®å¤‡ä»½



**ğŸ’¾ **å¦‚ä½•å¯¼å‡ºå®Œæ•´é…ç½®**
```bash
# å¯¼å‡ºæ‰€æœ‰é…ç½®åˆ°JSONæ–‡ä»¶

sudo rabbitmqctl export_definitions /backup/rabbitmq-config.json

# æŸ¥çœ‹å¯¼å‡ºçš„é…ç½®å†…å®¹

cat /backup/rabbitmq-config.json | jq '.' | head -20
```

**ğŸ“‹ **é…ç½®æ–‡ä»¶å†…å®¹ç¤ºä¾‹**
```json
{
  "rabbit_version": "3.12.0",
  "rabbitmq_version": "3.12.0",
  "product_name": "RabbitMQ",
  "vhosts": [
    {"name": "/"},
    {"name": "production"}
  ],
  "exchanges": [
    {
      "name": "user.exchange",
      "vhost": "/",
      "type": "direct",
      "durable": true
    }
  ],
  "queues": [
    {
      "name": "user.queue",
      "vhost": "/",
      "durable": true,
      "arguments": {}
    }
  ]
}
```

### 3.3 å¯¼å…¥é…ç½®æ¢å¤



**ğŸ”„ **é…ç½®æ¢å¤æ“ä½œ**
```bash
# æ–¹æ³•1ï¼šä½¿ç”¨rabbitmqctlå¯¼å…¥

sudo rabbitmqctl import_definitions /backup/rabbitmq-config.json

# æ–¹æ³•2ï¼šä½¿ç”¨HTTP APIå¯¼å…¥

curl -u admin:password -H "Content-Type: application/json" \
  -X POST http://localhost:15672/api/definitions \
  -d @/backup/rabbitmq-config.json
```

**âš ï¸ **æ¢å¤æ³¨æ„äº‹é¡¹**
```
é‡è¦æé†’ï¼š
ğŸ”¸ å¯¼å…¥å‰å…ˆæ¸…ç©ºç°æœ‰é…ç½®ï¼ˆå¦‚æœéœ€è¦ï¼‰
ğŸ”¸ è™šæ‹Ÿä¸»æœºå¿…é¡»å…ˆå­˜åœ¨
ğŸ”¸ ç”¨æˆ·æƒé™éœ€è¦å•ç‹¬æ¢å¤
ğŸ”¸ æŸäº›ç³»ç»Ÿé˜Ÿåˆ—ä¼šè‡ªåŠ¨é‡å»º
```

---

## 4. ğŸ—ï¸ é˜Ÿåˆ—é‡å»ºç­–ç•¥



### 4.1 é˜Ÿåˆ—é‡å»ºçš„æ—¶æœº



**ğŸ¤” **ä»€ä¹ˆæ—¶å€™éœ€è¦é‡å»ºé˜Ÿåˆ—**
```
éœ€è¦é‡å»ºçš„æƒ…å†µï¼š
âŒ é˜Ÿåˆ—å®šä¹‰æŸå
âŒ é˜Ÿåˆ—å‚æ•°éœ€è¦ä¿®æ”¹
âŒ æ¶ˆæ¯å †ç§¯è¿‡å¤šéœ€è¦æ¸…ç†
âŒ é˜Ÿåˆ—çŠ¶æ€å¼‚å¸¸

é‡å»º vs æ¢å¤çš„åŒºåˆ«ï¼š
â€¢ æ¢å¤ï¼šæŠŠåŸæ¥çš„é˜Ÿåˆ—æ‰¾å›æ¥
â€¢ é‡å»ºï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„åŒåé˜Ÿåˆ—
```

### 4.2 å®‰å…¨é‡å»ºæµç¨‹



**ğŸ”„ **é˜Ÿåˆ—é‡å»ºæ­¥éª¤**

**Step 1** ğŸ” **åˆ†æç°æœ‰é˜Ÿåˆ—**
```bash
# æŸ¥çœ‹é˜Ÿåˆ—è¯¦ç»†ä¿¡æ¯

sudo rabbitmqctl list_queues name messages consumers durable auto_delete

# å¯¼å‡ºé˜Ÿåˆ—ç»‘å®šå…³ç³»

sudo rabbitmqctl list_bindings source_name source_kind destination_name destination_kind routing_key
```

**Step 2** ğŸ’¾ **å¤‡ä»½ç›¸å…³æ•°æ®**
```bash
# å¦‚æœéœ€è¦ä¿ç•™æ¶ˆæ¯ï¼Œå…ˆå¯¼å‡º

# æ³¨æ„ï¼šRabbitMQæœ¬èº«ä¸æä¾›æ¶ˆæ¯å¯¼å‡ºåŠŸèƒ½

# éœ€è¦åº”ç”¨ç¨‹åºé…åˆæ¶ˆè´¹å¹¶å¤‡ä»½æ¶ˆæ¯


# å¤‡ä»½é˜Ÿåˆ—å®šä¹‰

sudo rabbitmqctl export_definitions /backup/before-rebuild-$(date +%Y%m%d).json
```

**Step 3** ğŸ—‘ï¸ **åˆ é™¤æ—§é˜Ÿåˆ—**
```bash
# åˆ é™¤æŒ‡å®šé˜Ÿåˆ—

sudo rabbitmqctl delete_queue user.queue

# æˆ–è€…é€šè¿‡HTTP APIåˆ é™¤

curl -u admin:password -X DELETE \
  http://localhost:15672/api/queues/%2F/user.queue
```

**Step 4** ğŸ—ï¸ **é‡å»ºæ–°é˜Ÿåˆ—**
```bash
# å£°æ˜æ–°é˜Ÿåˆ—

sudo rabbitmqctl declare_queue user.queue durable=true

# é‡å»ºç»‘å®šå…³ç³»

sudo rabbitmqctl bind_queue user.exchange user.queue user.routing.key
```

### 4.3 æ‰¹é‡é˜Ÿåˆ—é‡å»º



**ğŸ“Š **æ‰¹é‡æ“ä½œè„šæœ¬**
```bash
#!/bin/bash

# æ‰¹é‡é‡å»ºé˜Ÿåˆ—è„šæœ¬


VHOST="/"
BACKUP_FILE="/backup/queue-definitions.json"

# 1. å¯¼å‡ºå½“å‰é˜Ÿåˆ—å®šä¹‰

rabbitmqctl export_definitions $BACKUP_FILE

# 2. æå–é˜Ÿåˆ—ä¿¡æ¯å¹¶é‡å»º

cat $BACKUP_FILE | jq -r '.queues[] | 
  "rabbitmqctl declare_queue " + .name + 
  " durable=" + (.durable|tostring) + 
  " auto_delete=" + (.auto_delete|tostring)' | 
while read cmd; do
  echo "æ‰§è¡Œ: $cmd"
  $cmd
done

# 3. é‡å»ºç»‘å®šå…³ç³»

cat $BACKUP_FILE | jq -r '.bindings[] | 
  select(.destination_type=="queue") |
  "rabbitmqctl bind_queue " + .source + " " + .destination + " " + .routing_key' |
while read cmd; do
  echo "æ‰§è¡Œ: $cmd"
  $cmd
done
```

---

## 5. ğŸ‘¥ æƒé™æ¢å¤æµç¨‹



### 5.1 ç†è§£RabbitMQæƒé™ä½“ç³»



**ğŸ” **æƒé™ä½“ç³»ç»“æ„**
```
RabbitMQæƒé™å±‚æ¬¡ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ç”¨æˆ·       â”‚ â† ç™»å½•è´¦å·
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      è§’è‰²       â”‚ â† ç®¡ç†æƒé™çº§åˆ«
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   è™šæ‹Ÿä¸»æœºæƒé™   â”‚ â† èµ„æºè®¿é—®æƒé™
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è§’è‰²ç±»å‹ï¼š
â€¢ administratorï¼šç®¡ç†å‘˜ï¼Œå…¨éƒ¨æƒé™
â€¢ managementï¼šç®¡ç†æ§åˆ¶å°è®¿é—®
â€¢ policymakerï¼šç­–ç•¥ç®¡ç†æƒé™
â€¢ monitoringï¼šç›‘æ§æŸ¥çœ‹æƒé™
â€¢ noneï¼šæ— ç‰¹æ®Šæƒé™
```

### 5.2 ç”¨æˆ·å’Œæƒé™æ¢å¤



**ğŸ‘¤ **æ¢å¤ç”¨æˆ·è´¦å·**
```bash
# æŸ¥çœ‹ç°æœ‰ç”¨æˆ·

sudo rabbitmqctl list_users

# æ·»åŠ ç”¨æˆ·ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰

sudo rabbitmqctl add_user admin password123

# è®¾ç½®ç”¨æˆ·è§’è‰²

sudo rabbitmqctl set_user_tags admin administrator

# æ‰¹é‡æ·»åŠ ç”¨æˆ·

for user in user1 user2 user3; do
  sudo rabbitmqctl add_user $user default_password
  sudo rabbitmqctl set_user_tags $user management
done
```

**ğŸ”‘ **æ¢å¤è™šæ‹Ÿä¸»æœºæƒé™**
```bash
# è®¾ç½®ç”¨æˆ·åœ¨è™šæ‹Ÿä¸»æœºçš„æƒé™

# æ ¼å¼ï¼šset_permissions [-p vhost] user conf write read


# ç»™ç”¨æˆ·å®Œå…¨æƒé™

sudo rabbitmqctl set_permissions -p / admin ".*" ".*" ".*"

# ç»™ç”¨æˆ·å—é™æƒé™

sudo rabbitmqctl set_permissions -p production app_user "user\..*" "user\..*" "user\..*"

# æŸ¥çœ‹æƒé™è®¾ç½®

sudo rabbitmqctl list_permissions -p /
```

### 5.3 æƒé™æ‰¹é‡æ¢å¤è„šæœ¬



**ğŸ”§ **è‡ªåŠ¨åŒ–æƒé™æ¢å¤**
```bash
#!/bin/bash

# æƒé™æ¢å¤è„šæœ¬


# ç”¨æˆ·æƒé™é…ç½®æ–‡ä»¶

USERS_FILE="/backup/users-config.txt"

# æ ¼å¼ï¼šusername:password:tags:vhost:configure:write:read

# admin:password123:administrator:/:.*:.*:.*

# app_user:app_pass:management:production:app\..*:app\..*:app\..*


while IFS=':' read -r username password tags vhost conf write read; do
  echo "æ¢å¤ç”¨æˆ·: $username"
  
#  # æ·»åŠ ç”¨æˆ·
  sudo rabbitmqctl add_user "$username" "$password" 2>/dev/null || echo "ç”¨æˆ·å·²å­˜åœ¨"
  
#  # è®¾ç½®è§’è‰²
  sudo rabbitmqctl set_user_tags "$username" "$tags"
  
#  # è®¾ç½®æƒé™
  sudo rabbitmqctl set_permissions -p "$vhost" "$username" "$conf" "$write" "$read"
  
  echo "ç”¨æˆ· $username æ¢å¤å®Œæˆ"
done < "$USERS_FILE"
```

---

## 6. âœ… éªŒè¯æµ‹è¯•æ–¹æ³•



### 6.1 ç³»ç»Ÿçº§éªŒè¯



**ğŸ” **åŸºç¡€æœåŠ¡éªŒè¯**
```bash
# 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€

sudo systemctl status rabbitmq-server

# 2. æ£€æŸ¥RabbitMQèŠ‚ç‚¹çŠ¶æ€

sudo rabbitmqctl status

# 3. æ£€æŸ¥é›†ç¾¤çŠ¶æ€ï¼ˆå¦‚æœæ˜¯é›†ç¾¤ï¼‰

sudo rabbitmqctl cluster_status

# 4. æ£€æŸ¥å†…å­˜å’Œç£ç›˜ä½¿ç”¨

sudo rabbitmqctl environment | grep -E "(memory|disk)"
```

### 6.2 é…ç½®å®Œæ•´æ€§éªŒè¯



**ğŸ“Š **é…ç½®éªŒè¯æ£€æŸ¥æ¸…å•**
```bash
# âœ… æ£€æŸ¥è™šæ‹Ÿä¸»æœº

sudo rabbitmqctl list_vhosts
# æœŸæœ›ç»“æœï¼šæ‰€æœ‰ä¸šåŠ¡è™šæ‹Ÿä¸»æœºéƒ½å­˜åœ¨


# âœ… æ£€æŸ¥äº¤æ¢æœº

sudo rabbitmqctl list_exchanges name type durable
# æœŸæœ›ç»“æœï¼šä¸šåŠ¡äº¤æ¢æœºé…ç½®æ­£ç¡®


# âœ… æ£€æŸ¥é˜Ÿåˆ—

sudo rabbitmqctl list_queues name durable auto_delete messages
# æœŸæœ›ç»“æœï¼šæ‰€æœ‰ä¸šåŠ¡é˜Ÿåˆ—å­˜åœ¨ä¸”çŠ¶æ€æ­£å¸¸


# âœ… æ£€æŸ¥ç»‘å®šå…³ç³»

sudo rabbitmqctl list_bindings source_name destination_name routing_key
# æœŸæœ›ç»“æœï¼šé˜Ÿåˆ—å’Œäº¤æ¢æœºç»‘å®šå…³ç³»å®Œæ•´


# âœ… æ£€æŸ¥ç”¨æˆ·æƒé™

sudo rabbitmqctl list_users
sudo rabbitmqctl list_permissions -p /
# æœŸæœ›ç»“æœï¼šç”¨æˆ·è´¦å·å’Œæƒé™æ¢å¤æ­£ç¡®

```

### 6.3 åŠŸèƒ½æ€§æµ‹è¯•



**ğŸ§ª **å®Œæ•´åŠŸèƒ½æµ‹è¯•**

**æµ‹è¯•1ï¼šæ¶ˆæ¯å‘é€æ¥æ”¶**
```bash
# å‘é€æµ‹è¯•æ¶ˆæ¯

sudo rabbitmqctl publish exchange=user.exchange routing_key=test.key payload="æµ‹è¯•æ¶ˆæ¯æ¢å¤"

# æ£€æŸ¥æ¶ˆæ¯æ˜¯å¦åˆ°è¾¾é˜Ÿåˆ—

sudo rabbitmqctl list_queues name messages

# æ¶ˆè´¹æµ‹è¯•æ¶ˆæ¯

sudo rabbitmqctl get_messages user.queue count=1
```

**æµ‹è¯•2ï¼šWebç®¡ç†ç•Œé¢**
```bash
# æµ‹è¯•ç®¡ç†ç•Œé¢è®¿é—®

curl -u admin:password http://localhost:15672/api/whoami

# æ£€æŸ¥APIå“åº”

curl -u admin:password http://localhost:15672/api/overview | jq '.'
```

**æµ‹è¯•3ï¼šåº”ç”¨ç¨‹åºè¿æ¥**
```python
# Pythonæµ‹è¯•è„šæœ¬ç¤ºä¾‹

import pika

try:
#    # å»ºç«‹è¿æ¥
    connection = pika.BlockingConnection(
        pika.ConnectionParameters('localhost')
    )
    channel = connection.channel()
    
#    # æµ‹è¯•é˜Ÿåˆ—å£°æ˜
    channel.queue_declare(queue='test.recovery.queue', durable=True)
    
#    # å‘é€æµ‹è¯•æ¶ˆæ¯
    channel.basic_publish(
        exchange='',
        routing_key='test.recovery.queue',
        body='æ¢å¤æµ‹è¯•æ¶ˆæ¯'
    )
    
    print("âœ… è¿æ¥å’Œå‘é€æµ‹è¯•æˆåŠŸ")
    connection.close()
    
except Exception as e:
    print(f"âŒ æµ‹è¯•å¤±è´¥: {e}")
```

### 6.4 æ€§èƒ½éªŒè¯



**ğŸ“ˆ **æ€§èƒ½æŒ‡æ ‡æ£€æŸ¥**
```bash
# æ£€æŸ¥æ¶ˆæ¯å¤„ç†é€Ÿç‡

sudo rabbitmqctl list_queues name messages_ready messages_unacknowledged message_stats

# æ£€æŸ¥å†…å­˜ä½¿ç”¨æƒ…å†µ

sudo rabbitmqctl list_queues name memory

# æ£€æŸ¥è¿æ¥æ•°å’Œé€šé“æ•°

sudo rabbitmqctl list_connections
sudo rabbitmqctl list_channels
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“



### 7.1 å¿…é¡»æŒæ¡çš„æ¢å¤è¦ç‚¹



```
ğŸ”¸ æ¢å¤ä¸‰è¦ç´ ï¼šå¤‡ä»½ã€æƒé™ã€éªŒè¯
ğŸ”¸ æ¢å¤é¡ºåºï¼šç³»ç»Ÿ â†’ é…ç½® â†’ æ•°æ® â†’ æƒé™
ğŸ”¸ éªŒè¯åŸåˆ™ï¼šé€å±‚éªŒè¯ï¼Œç¡®ä¿å®Œæ•´æ€§
ğŸ”¸ å®‰å…¨åŸåˆ™ï¼šå…ˆå¤‡ä»½å†æ“ä½œï¼Œå¯å›æ»š
```

### 7.2 æ¢å¤æ“ä½œå…³é”®æ­¥éª¤



**ğŸ”¹ æ¢å¤å‰å‡†å¤‡**
```
å‡†å¤‡å·¥ä½œï¼š
â€¢ ç¡®è®¤å¤‡ä»½æ–‡ä»¶å®Œæ•´æ€§
â€¢ å‡†å¤‡è¶³å¤Ÿçš„ç»´æŠ¤æ—¶é—´
â€¢ é€šçŸ¥ç›¸å…³ä¸šåŠ¡æ–¹åœæ­¢æ“ä½œ
â€¢ å‡†å¤‡å›æ»šæ–¹æ¡ˆ
```

**ğŸ”¹ æ¢å¤æ‰§è¡Œè¦ç‚¹**
```
æ‰§è¡Œè¦ç‚¹ï¼š
â€¢ ä¸¥æ ¼æŒ‰ç…§é¡ºåºæ“ä½œ
â€¢ æ¯æ­¥æ“ä½œåéƒ½è¦éªŒè¯
â€¢ é‡åˆ°é—®é¢˜ç«‹å³åœæ­¢åˆ†æ
â€¢ è®°å½•æ“ä½œæ—¥å¿—ä¾¿äºè¿½è¸ª
```

**ğŸ”¹ æ¢å¤åéªŒè¯**
```
éªŒè¯é‡ç‚¹ï¼š
â€¢ ç³»ç»ŸæœåŠ¡æ­£å¸¸å¯åŠ¨
â€¢ é…ç½®ä¿¡æ¯å®Œæ•´æ­£ç¡®
â€¢ æ¶ˆæ¯æ•°æ®å¯ä»¥è®¿é—®
â€¢ åº”ç”¨ç¨‹åºæ­£å¸¸è¿æ¥
â€¢ æ€§èƒ½æŒ‡æ ‡åœ¨æ­£å¸¸èŒƒå›´
```

### 7.3 å®é™…åº”ç”¨ä»·å€¼



**ğŸ¯ ä¸šåŠ¡åœºæ™¯åº”ç”¨**
- **ç”Ÿäº§ç¯å¢ƒæ•…éšœ**ï¼šå¿«é€Ÿæ¢å¤ä¸šåŠ¡ç³»ç»Ÿ
- **ç¯å¢ƒè¿ç§»**ï¼šæ•°æ®å’Œé…ç½®å®Œæ•´è¿ç§»
- **ç‰ˆæœ¬å‡çº§**ï¼šå‡çº§å¤±è´¥åçš„å›æ»šæ¢å¤
- **å®šæœŸç»´æŠ¤**ï¼šéªŒè¯å¤‡ä»½æœ‰æ•ˆæ€§

**ğŸ”§ è¿ç»´å®è·µ**
- **åˆ¶å®šæ¢å¤é¢„æ¡ˆ**ï¼šä¸åŒæ•…éšœåœºæ™¯çš„åº”å¯¹æ–¹æ¡ˆ
- **å®šæœŸæ¢å¤æ¼”ç»ƒ**ï¼šéªŒè¯æ¢å¤æµç¨‹çš„æœ‰æ•ˆæ€§
- **ç›‘æ§å‘Šè­¦**ï¼šåŠæ—¶å‘ç°éœ€è¦æ¢å¤çš„æƒ…å†µ
- **æ–‡æ¡£ç»´æŠ¤**ï¼šä¿æŒæ¢å¤æ–‡æ¡£çš„åŠæ—¶æ›´æ–°

**ğŸ§  æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- æ¢å¤ä¹‹å‰å…ˆå¤‡ä»½ï¼Œå®‰å…¨ç¬¬ä¸€ä¸èƒ½å¿˜
- é…ç½®æ¶ˆæ¯åˆ†æ­¥éª¤ï¼Œæƒé™éªŒè¯è¦è·Ÿä¸Š
- æµ‹è¯•éªŒè¯å¾ˆé‡è¦ï¼ŒåŠŸèƒ½æ€§èƒ½éƒ½è¦æŸ¥
- è®°å½•æ—¥å¿—ç•™ç—•è¿¹ï¼Œé—®é¢˜æ’æŸ¥æœ‰ä¾æ®

**ğŸ’¡ å…³é”®ç†è§£**ï¼š
- æ•°æ®æ¢å¤ä¸æ˜¯ç®€å•çš„æ–‡ä»¶å¤åˆ¶ï¼Œéœ€è¦è€ƒè™‘æ•°æ®ä¸€è‡´æ€§
- æƒé™æ¢å¤å¾€å¾€æ¯”æ•°æ®æ¢å¤æ›´å¤æ‚ï¼Œéœ€è¦ç»†å¿ƒå¤„ç†
- éªŒè¯æµ‹è¯•æ˜¯æ¢å¤æµç¨‹ä¸­æœ€é‡è¦çš„ç¯èŠ‚ï¼Œä¸èƒ½çœç•¥
- æ¢å¤æ–¹æ¡ˆè¦æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ï¼Œæ²¡æœ‰æ ‡å‡†ç­”æ¡ˆ