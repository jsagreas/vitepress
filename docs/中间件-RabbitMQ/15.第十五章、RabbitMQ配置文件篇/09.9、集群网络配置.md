---
title: 9ã€é›†ç¾¤ç½‘ç»œé…ç½®
---
## ğŸ“š ç›®å½•

1. [é›†ç¾¤ç½‘ç»œé…ç½®æ¦‚è¿°](#1-é›†ç¾¤ç½‘ç»œé…ç½®æ¦‚è¿°)
2. [èŠ‚ç‚¹å‘ç°ä¸è¿æ¥é…ç½®](#2-èŠ‚ç‚¹å‘ç°ä¸è¿æ¥é…ç½®)
3. [é›†ç¾¤ç¨³å®šæ€§é…ç½®](#3-é›†ç¾¤ç¨³å®šæ€§é…ç½®)
4. [ç½‘ç»œé€šä¿¡ä¼˜åŒ–é…ç½®](#4-ç½‘ç»œé€šä¿¡ä¼˜åŒ–é…ç½®)
5. [æ•…éšœå¤„ç†ä¸ç›‘æ§é…ç½®](#5-æ•…éšœå¤„ç†ä¸ç›‘æ§é…ç½®)
6. [å®æˆ˜é…ç½®ç¤ºä¾‹](#6-å®æˆ˜é…ç½®ç¤ºä¾‹)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ é›†ç¾¤ç½‘ç»œé…ç½®æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯RabbitMQé›†ç¾¤ç½‘ç»œé…ç½®


> ğŸ’¡ **é€šä¿—ç†è§£**  
> æƒ³è±¡ä¸€ä¸‹å¤šä¸ªRabbitMQæœåŠ¡å™¨è¦ç»„æˆä¸€ä¸ª"å›¢é˜Ÿ"ååŒå·¥ä½œï¼Œå°±åƒå…¬å¸é‡Œä¸åŒéƒ¨é—¨éœ€è¦äº’ç›¸æ²Ÿé€šåä½œä¸€æ ·ã€‚é›†ç¾¤ç½‘ç»œé…ç½®å°±æ˜¯åˆ¶å®šè¿™äº›æœåŠ¡å™¨ä¹‹é—´å¦‚ä½•æ‰¾åˆ°å½¼æ­¤ã€å¦‚ä½•ä¿æŒè”ç³»ã€å‡ºç°é—®é¢˜æ—¶å¦‚ä½•å¤„ç†çš„"è§„åˆ™æ‰‹å†Œ"ã€‚

**ğŸ”¸ æ ¸å¿ƒä½œç”¨**
```
èŠ‚ç‚¹å‘ç°ï¼šå‘Šè¯‰æ¯ä¸ªèŠ‚ç‚¹"é˜Ÿå‹"éƒ½æœ‰è°
é€šä¿¡åè°ƒï¼šç¡®ä¿èŠ‚ç‚¹é—´èƒ½æ­£å¸¸"å¯¹è¯"
æ•…éšœå¤„ç†ï¼šå½“æŸä¸ªèŠ‚ç‚¹"æ‰çº¿"æ—¶å¦‚ä½•åº”å¯¹
æ€§èƒ½ä¼˜åŒ–ï¼šè®©æ•´ä¸ªå›¢é˜Ÿè¿è¡Œæ›´é«˜æ•ˆ
```

### 1.2 é›†ç¾¤ç½‘ç»œçš„åŸºæœ¬æ¶æ„


```
RabbitMQé›†ç¾¤ç½‘ç»œæ¶æ„ï¼š

èŠ‚ç‚¹A â†â”€â”€â”€â”€ å¿ƒè·³æ£€æµ‹ â”€â”€â”€â”€â†’ èŠ‚ç‚¹B
  â”‚                           â”‚
  â”‚         æ•°æ®åŒæ­¥           â”‚
  â”‚                           â”‚
  â””â”€â”€â”€â”€â”€â”€ æ•…éšœè½¬ç§»é€šä¿¡ â”€â”€â”€â”€â”€â”€â”€â”€â†’ èŠ‚ç‚¹C

æ ¸å¿ƒé€šä¿¡ç±»å‹ï¼š
ğŸ”¸ èŠ‚ç‚¹å‘ç°ï¼šæ‰¾åˆ°æ‰€æœ‰é›†ç¾¤æˆå‘˜
ğŸ”¸ æ•°æ®åŒæ­¥ï¼šé˜Ÿåˆ—ã€äº¤æ¢å™¨ä¿¡æ¯å…±äº«
ğŸ”¸ å¿ƒè·³æ£€æµ‹ï¼šç¡®è®¤èŠ‚ç‚¹æ˜¯å¦å¥åº·
ğŸ”¸ æ•…éšœæ¢å¤ï¼šå¤„ç†èŠ‚ç‚¹ç¦»çº¿å’Œé‡è¿
```

### 1.3 ä¸ºä»€ä¹ˆéœ€è¦è¿™äº›é…ç½®


**ğŸ’¡ ç”Ÿæ´»ç±»æ¯”**ï¼š
- å°±åƒä¸€ä¸ªä¹é˜Ÿï¼Œæ¯ä¸ªä¹æ‰‹éƒ½éœ€è¦çŸ¥é“å…¶ä»–äººåœ¨å“ªé‡Œ
- éœ€è¦ç»Ÿä¸€çš„èŠ‚æ‹ï¼ˆå¿ƒè·³æ£€æµ‹ï¼‰ä¿æŒåŒæ­¥
- å½“æœ‰äººä¸´æ—¶ç¦»å¼€æ—¶ï¼Œå…¶ä»–äººè¦çŸ¥é“å¦‚ä½•ç»§ç»­æ¼”å¥

**ğŸ¯ å®é™…ä»·å€¼**ï¼š
- **é«˜å¯ç”¨æ€§**ï¼šå•ä¸ªèŠ‚ç‚¹æ•…éšœä¸å½±å“æ•´ä½“æœåŠ¡
- **è´Ÿè½½åˆ†æ‹…**ï¼šå¤šä¸ªèŠ‚ç‚¹å…±åŒå¤„ç†æ¶ˆæ¯
- **æ•°æ®å®‰å…¨**ï¼šæ¶ˆæ¯åœ¨å¤šä¸ªèŠ‚ç‚¹é—´å¤‡ä»½
- **æ‰©å±•æ€§**ï¼šå¯ä»¥éšæ—¶æ·»åŠ æ–°èŠ‚ç‚¹

---

## 2. ğŸ” èŠ‚ç‚¹å‘ç°ä¸è¿æ¥é…ç½®


### 2.1 cluster_formation.classic_config.nodes - é›†ç¾¤èŠ‚ç‚¹åˆ—è¡¨


> ğŸ“– **æ¦‚å¿µè§£é‡Š**  
> è¿™ä¸ªé…ç½®å‘Šè¯‰RabbitMQï¼š"æˆ‘ä»¬è¿™ä¸ªé›†ç¾¤é‡Œéƒ½æœ‰å“ªäº›æˆå‘˜"ï¼Œå°±åƒç­çº§åå•ä¸€æ ·ï¼Œæ¯ä¸ªåŒå­¦éƒ½çŸ¥é“ç­é‡Œè¿˜æœ‰è°ã€‚

**ğŸ”¸ é…ç½®è¯´æ˜**
```bash
# åœ¨rabbitmq.confä¸­é…ç½®
cluster_formation.classic_config.nodes = rabbit@node1,rabbit@node2,rabbit@node3

# å«ä¹‰è§£é‡Šï¼š
# rabbit@ æ˜¯èŠ‚ç‚¹åå‰ç¼€ï¼ˆå›ºå®šæ ¼å¼ï¼‰
# node1,node2,node3 æ˜¯æœåŠ¡å™¨çš„ä¸»æœºåæˆ–IP
```

**ğŸ’¡ å®ç”¨é…ç½®ç¤ºä¾‹**
```bash
# ç”Ÿäº§ç¯å¢ƒé…ç½®ï¼ˆä½¿ç”¨IPåœ°å€ï¼‰
cluster_formation.classic_config.nodes = rabbit@192.168.1.10,rabbit@192.168.1.11,rabbit@192.168.1.12

# å¼€å‘ç¯å¢ƒé…ç½®ï¼ˆä½¿ç”¨ä¸»æœºåï¼‰
cluster_formation.classic_config.nodes = rabbit@rabbitmq-dev1,rabbit@rabbitmq-dev2
```

**ğŸ§  è®°å¿†æŠ€å·§**ï¼šæƒ³è±¡æˆ"é€šè®¯å½•"ï¼Œåˆ—å‡ºæ‰€æœ‰è¦è”ç³»çš„"æœ‹å‹"

### 2.2 èŠ‚ç‚¹è¿æ¥çš„å·¥ä½œæµç¨‹


```
èŠ‚ç‚¹å¯åŠ¨è¿æ¥æµç¨‹ï¼š

ç¬¬1æ­¥ï¼šè¯»å–é…ç½®æ–‡ä»¶
    â†“
ç¬¬2æ­¥ï¼šè§£æèŠ‚ç‚¹åˆ—è¡¨
    â†“  
ç¬¬3æ­¥ï¼šå°è¯•è¿æ¥å…¶ä»–èŠ‚ç‚¹
    â†“
ç¬¬4æ­¥ï¼šåŠ å…¥é›†ç¾¤æˆ–åˆ›å»ºæ–°é›†ç¾¤

å®é™…è¿‡ç¨‹ï¼š
èŠ‚ç‚¹Aå¯åŠ¨ â†’ æŸ¥çœ‹é…ç½® â†’ å‘ç°èŠ‚ç‚¹Bã€Cåœ¨åˆ—è¡¨ä¸­ â†’ å°è¯•è¿æ¥ â†’ æˆåŠŸåŠ å…¥é›†ç¾¤
```

---

## 3. âš–ï¸ é›†ç¾¤ç¨³å®šæ€§é…ç½®


### 3.1 cluster_partition_handling - é›†ç¾¤åˆ†åŒºå¤„ç†ç­–ç•¥


> ğŸ“– **æ¦‚å¿µè§£é‡Š**  
> ç½‘ç»œåˆ†åŒºå°±åƒå…¬å¸é‡Œä¸åŒæ¥¼å±‚æ–­ç½‘äº†ï¼Œå„å±‚ä¹‹é—´æ— æ³•é€šä¿¡ã€‚è¿™ä¸ªé…ç½®å†³å®šé‡åˆ°è¿™ç§æƒ…å†µæ—¶RabbitMQå¦‚ä½•å¤„ç†ã€‚

**ğŸ”¸ å¯é€‰ç­–ç•¥å¯¹æ¯”**

| ç­–ç•¥åç§° | **å·¥ä½œæ–¹å¼** | **é€‚ç”¨åœºæ™¯** | **é£é™©ç¨‹åº¦** |
|---------|-------------|-------------|-------------|
| `ignore` | å¿½ç•¥åˆ†åŒºï¼Œç»§ç»­å·¥ä½œ | å¼€å‘ç¯å¢ƒ | ğŸ”´ é«˜é£é™© |
| `pause_minority` | æš‚åœå°‘æ•°æ´¾èŠ‚ç‚¹ | ç”Ÿäº§ç¯å¢ƒæ¨è | ğŸŸ¡ ä¸­ç­‰ |
| `pause_if_all_down` | å…¨éƒ¨æ–­å¼€æ—¶æš‚åœ | ä¿å®ˆç­–ç•¥ | ğŸŸ¢ ä½é£é™© |
| `autoheal` | è‡ªåŠ¨æ„ˆåˆåˆ†åŒº | è‡ªåŠ¨åŒ–ç¯å¢ƒ | ğŸŸ¡ ä¸­ç­‰ |

**ğŸ’¡ æ¨èé…ç½®**
```bash
# ç”Ÿäº§ç¯å¢ƒæ¨èé…ç½®
cluster_partition_handling = pause_minority

# è§£é‡Šï¼šå½“ç½‘ç»œåˆ†åŒºå‘ç”Ÿæ—¶ï¼ŒèŠ‚ç‚¹æ•°é‡å°‘çš„é‚£ä¸€æ–¹ä¼šæš‚åœæœåŠ¡
# è¿™æ ·å¯ä»¥é¿å…"è„‘è£‚"é—®é¢˜ï¼ˆä¸¤ä¸ªåˆ†åŒºéƒ½è®¤ä¸ºè‡ªå·±æ˜¯ä¸»ï¼‰
```

**ğŸ” å®é™…åœºæ™¯ç†è§£**ï¼š
```
å‡è®¾3èŠ‚ç‚¹é›†ç¾¤å‘ç”Ÿç½‘ç»œåˆ†åŒºï¼š

æƒ…å†µ1ï¼šèŠ‚ç‚¹Aç‹¬ç«‹ï¼ŒèŠ‚ç‚¹B+Cç»„æˆåˆ†åŒº
pause_minorityç­–ç•¥ â†’ èŠ‚ç‚¹Aæš‚åœæœåŠ¡ï¼ŒB+Cç»§ç»­å·¥ä½œ

æƒ…å†µ2ï¼šèŠ‚ç‚¹A+Bç»„æˆåˆ†åŒºï¼ŒèŠ‚ç‚¹Cç‹¬ç«‹  
pause_minorityç­–ç•¥ â†’ èŠ‚ç‚¹Cæš‚åœæœåŠ¡ï¼ŒA+Bç»§ç»­å·¥ä½œ
```

### 3.2 cluster_keepalive_interval - é›†ç¾¤ä¿æ´»é—´éš”


> ğŸ“– **æ¦‚å¿µè§£é‡Š**  
> å°±åƒæœ‹å‹ä¹‹é—´å®šæœŸå‘"è¿˜å¥½å—ï¼Ÿ"çš„æ¶ˆæ¯ç¡®è®¤å¯¹æ–¹è¿˜åœ¨çº¿ï¼Œè¿™ä¸ªé…ç½®è®¾å®šå¤šä¹…å‘é€ä¸€æ¬¡"å¿ƒè·³"æ£€æŸ¥å…¶ä»–èŠ‚ç‚¹æ˜¯å¦å¥åº·ã€‚

**ğŸ”¸ é…ç½®è¯¦è§£**
```bash
# è®¾ç½®å¿ƒè·³é—´éš”ï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰
cluster_keepalive_interval = 10000

# å«ä¹‰ï¼šæ¯10ç§’æ£€æŸ¥ä¸€æ¬¡å…¶ä»–èŠ‚ç‚¹çŠ¶æ€
# é»˜è®¤å€¼ï¼š10000æ¯«ç§’ï¼ˆ10ç§’ï¼‰
```

**âš–ï¸ å‚æ•°è°ƒä¼˜æŒ‡å¯¼**

| ç½‘ç»œç¯å¢ƒ | **æ¨èé—´éš”** | **è¯´æ˜** |
|---------|-------------|---------|
| å±€åŸŸç½‘ | 5000-10000ms | ç½‘ç»œç¨³å®šï¼Œå¯ä»¥é¢‘ç¹æ£€æŸ¥ |
| è·¨åœ°åŸŸ | 15000-30000ms | ç½‘ç»œå»¶è¿Ÿå¤§ï¼Œé¿å…è¯¯åˆ¤ |
| äº‘ç¯å¢ƒ | 10000-20000ms | è€ƒè™‘äº‘ç½‘ç»œçš„ä¸ç¨³å®šæ€§ |

**ğŸ§  è®°å¿†è¦ç‚¹**ï¼š
- **é—´éš”å¤ªçŸ­**ï¼šæµªè´¹ç½‘ç»œèµ„æºï¼Œå¯èƒ½è¯¯åˆ¤
- **é—´éš”å¤ªé•¿**ï¼šæ•…éšœå‘ç°æ…¢ï¼Œæ¢å¤æ—¶é—´é•¿

---

## 4. ğŸš€ ç½‘ç»œé€šä¿¡ä¼˜åŒ–é…ç½®


### 4.1 net_ticktime - ç½‘ç»œtickæ—¶é—´


> ğŸ“– **æ¦‚å¿µè§£é‡Š**  
> è¿™æ˜¯Erlangè™šæ‹Ÿæœºï¼ˆRabbitMQè¿è¡Œçš„åº•å±‚å¹³å°ï¼‰ç”¨æ¥æ£€æµ‹ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸çš„"æ—¶é’Ÿæ»´ç­”"é—´éš”ï¼Œå°±åƒå®šæ—¶å™¨ä¸€æ ·ã€‚

**ğŸ”¸ æ ¸å¿ƒé…ç½®**
```bash
# è®¾ç½®ç½‘ç»œtickæ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰
net_ticktime = 60

# å«ä¹‰ï¼šæ¯60ç§’æ£€æŸ¥ä¸€æ¬¡åº•å±‚ç½‘ç»œè¿æ¥
# å½±å“ï¼šå†³å®šå¤šä¹…å‘ç°ç½‘ç»œæ•…éšœ
```

**ğŸ“Š ä¸åŒç¯å¢ƒçš„æ¨èé…ç½®**
```bash
# é«˜æ€§èƒ½å±€åŸŸç½‘ç¯å¢ƒ
net_ticktime = 30

# æ™®é€šç½‘ç»œç¯å¢ƒï¼ˆé»˜è®¤ï¼‰
net_ticktime = 60  

# ä¸ç¨³å®šç½‘ç»œç¯å¢ƒ
net_ticktime = 120
```

**ğŸ”„ å·¥ä½œåŸç†å›¾ç¤º**
```
ç½‘ç»œTickæ£€æµ‹æµç¨‹ï¼š

æ—¶é—´: 0ç§’    60ç§’    120ç§’    180ç§’
      |       |       |        |
èŠ‚ç‚¹A â”€â”€tickâ”€â”€â†’ èŠ‚ç‚¹B â”€â”€tickâ”€â”€â†’ æ£€æŸ¥è¿æ¥çŠ¶æ€
      â†â”€â”€ackâ”€â”€        â†â”€â”€ackâ”€â”€

å¦‚æœåœ¨tickæ—¶é—´å†…æ²¡æ”¶åˆ°å›åº” â†’ è®¤ä¸ºè¿æ¥å¼‚å¸¸
```

### 4.2 éšæœºå¯åŠ¨å»¶è¿Ÿé…ç½®


**ğŸ”¸ cluster_formation.randomized_startup_delay_range**

> ğŸ“– **æ¦‚å¿µè§£é‡Š**  
> å½“å¤šä¸ªèŠ‚ç‚¹åŒæ—¶å¯åŠ¨æ—¶ï¼Œä¸ºäº†é¿å…"æŒ¤åœ¨ä¸€èµ·"é€ æˆæ··ä¹±ï¼Œç»™æ¯ä¸ªèŠ‚ç‚¹è®¾ç½®éšæœºçš„å¯åŠ¨å»¶è¿Ÿï¼Œå°±åƒé”™å³°ä¸Šç­ä¸€æ ·ã€‚

```bash
# è®¾ç½®éšæœºå¯åŠ¨å»¶è¿ŸèŒƒå›´ï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰
cluster_formation.randomized_startup_delay_range = 5000

# å«ä¹‰ï¼šèŠ‚ç‚¹å¯åŠ¨æ—¶ä¼šéšæœºå»¶è¿Ÿ0-5ç§’
# ä½œç”¨ï¼šé¿å…å¤šèŠ‚ç‚¹åŒæ—¶å¯åŠ¨æ—¶çš„èµ„æºç«äº‰
```

**ğŸ’¡ åº”ç”¨åœºæ™¯**ï¼š
- **å®¹å™¨åŒ–éƒ¨ç½²**ï¼šDocker/K8sç¯å¢ƒä¸‹å¤šä¸ªå®¹å™¨åŒæ—¶å¯åŠ¨
- **è‡ªåŠ¨åŒ–è¿ç»´**ï¼šæ‰¹é‡é‡å¯æœåŠ¡å™¨æ—¶
- **æ•…éšœæ¢å¤**ï¼šæ•´ä¸ªé›†ç¾¤åŒæ—¶é‡å¯æ—¶

---

## 5. ğŸ”§ æ•…éšœå¤„ç†ä¸ç›‘æ§é…ç½®


### 5.1 Mnesiaæ•°æ®åº“ç›¸å…³é…ç½®


> ğŸ“– **æ¦‚å¿µè§£é‡Š**  
> Mnesiaæ˜¯RabbitMQç”¨æ¥å­˜å‚¨é›†ç¾¤é…ç½®ä¿¡æ¯çš„æ•°æ®åº“ï¼Œå°±åƒé›†ç¾¤çš„"æ¡£æ¡ˆå®¤"ã€‚å½“èŠ‚ç‚¹é‡å¯æ—¶ï¼Œéœ€è¦ä»è¿™ä¸ªæ•°æ®åº“åŠ è½½ä¹‹å‰çš„é…ç½®ã€‚

**ğŸ”¸ mnesia_table_loading_retry_timeout**
```bash
# Mnesiaè¡¨åŠ è½½é‡è¯•è¶…æ—¶ï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰
mnesia_table_loading_retry_timeout = 30000

# å«ä¹‰ï¼šå°è¯•åŠ è½½æ•°æ®30ç§’ï¼Œè¶…æ—¶å°±æ”¾å¼ƒ
# åœºæ™¯ï¼šèŠ‚ç‚¹é‡å¯æ—¶åŠ è½½é›†ç¾¤é…ç½®ä¿¡æ¯
```

**ğŸ”¸ mnesia_table_loading_retry_limit**
```bash
# Mnesiaè¡¨åŠ è½½é‡è¯•æ¬¡æ•°é™åˆ¶
mnesia_table_loading_retry_limit = 10

# å«ä¹‰ï¼šæœ€å¤šé‡è¯•10æ¬¡åŠ è½½æ•°æ®
# è¶…è¿‡æ¬¡æ•°ï¼šåœæ­¢é‡è¯•ï¼ŒæŠ¥å‘Šé”™è¯¯
```

**ğŸ”„ æ•°æ®åŠ è½½æµç¨‹å›¾ç¤º**
```
èŠ‚ç‚¹é‡å¯åçš„æ•°æ®åŠ è½½è¿‡ç¨‹ï¼š

èŠ‚ç‚¹å¯åŠ¨
    â†“
å°è¯•è¿æ¥Mnesiaæ•°æ®åº“
    â†“
åŠ è½½é›†ç¾¤é…ç½®è¡¨ â”€â”€å¤±è´¥â”€â”€â†’ ç­‰å¾…é‡è¯•é—´éš” â”€â”€â†’ é‡è¯•è®¡æ•°+1
    â†“ æˆåŠŸ                      â†‘               â†“
åŠ è½½å®Œæˆ                   â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ£€æŸ¥æ˜¯å¦è¾¾åˆ°ä¸Šé™
    â†“                                        â†“ è¾¾åˆ°ä¸Šé™
æ­£å¸¸æä¾›æœåŠ¡                                 æŠ¥é”™é€€å‡º
```

### 5.2 èŠ‚ç‚¹æ¸…ç†é…ç½®


**ğŸ”¸ cluster_formation.node_cleanup.interval**
```bash
# èŠ‚ç‚¹æ¸…ç†æ£€æŸ¥é—´éš”ï¼ˆå•ä½ï¼šç§’ï¼‰
cluster_formation.node_cleanup.interval = 30

# å«ä¹‰ï¼šæ¯30ç§’æ£€æŸ¥ä¸€æ¬¡æ˜¯å¦æœ‰"åƒµå°¸"èŠ‚ç‚¹éœ€è¦æ¸…ç†
```

**ğŸ”¸ cluster_formation.node_cleanup.only_log_warning**
```bash
# æ˜¯å¦ä»…è®°å½•è­¦å‘Šè€Œä¸å®é™…æ¸…ç†
cluster_formation.node_cleanup.only_log_warning = false

# falseï¼šå‘ç°åƒµå°¸èŠ‚ç‚¹æ—¶è‡ªåŠ¨æ¸…ç†
# trueï¼šåªè®°å½•æ—¥å¿—ï¼Œä¸è‡ªåŠ¨æ¸…ç†ï¼ˆéœ€è¦æ‰‹åŠ¨å¤„ç†ï¼‰
```

**ğŸ’¡ æ¸…ç†æœºåˆ¶è¯´æ˜**ï¼š
```
èŠ‚ç‚¹æ¸…ç†çš„å·¥ä½œåŸç†ï¼š

å®šæœŸæ‰«æ â†’ å‘ç°å¤±è”èŠ‚ç‚¹ â†’ åˆ¤æ–­æ˜¯å¦ä¸ºåƒµå°¸èŠ‚ç‚¹ â†’ æ‰§è¡Œæ¸…ç†åŠ¨ä½œ

åƒµå°¸èŠ‚ç‚¹ç‰¹å¾ï¼š
âœ“ é•¿æ—¶é—´æ— å“åº”
âœ“ ç½‘ç»œè¿æ¥æ–­å¼€
âœ“ ä¸åœ¨æ´»è·ƒèŠ‚ç‚¹åˆ—è¡¨ä¸­
```

---

## 6. ğŸ’¼ å®æˆ˜é…ç½®ç¤ºä¾‹


### 6.1 ç”Ÿäº§ç¯å¢ƒå®Œæ•´é…ç½®æ¨¡æ¿


```bash
# ==========================================
# RabbitMQé›†ç¾¤ç½‘ç»œé…ç½® - ç”Ÿäº§ç¯å¢ƒæ¨¡æ¿
# ==========================================

# é›†ç¾¤èŠ‚ç‚¹å‘ç°é…ç½®
cluster_formation.classic_config.nodes = rabbit@prod-rmq-01,rabbit@prod-rmq-02,rabbit@prod-rmq-03

# é›†ç¾¤åˆ†åŒºå¤„ç†ç­–ç•¥ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰
cluster_partition_handling = pause_minority

# å¿ƒè·³æ£€æµ‹é—´éš”ï¼ˆ10ç§’ï¼‰
cluster_keepalive_interval = 10000

# ç½‘ç»œtickæ—¶é—´ï¼ˆ60ç§’ï¼Œé€‚åˆç¨³å®šç½‘ç»œï¼‰
net_ticktime = 60

# éšæœºå¯åŠ¨å»¶è¿Ÿï¼ˆæœ€å¤§5ç§’ï¼‰
cluster_formation.randomized_startup_delay_range = 5000

# Mnesiaæ•°æ®åº“é…ç½®
mnesia_table_loading_retry_timeout = 30000
mnesia_table_loading_retry_limit = 10

# èŠ‚ç‚¹æ¸…ç†é…ç½®
cluster_formation.node_cleanup.interval = 30
cluster_formation.node_cleanup.only_log_warning = false
```

### 6.2 å¼€å‘ç¯å¢ƒé…ç½®æ¨¡æ¿


```bash
# ==========================================
# RabbitMQé›†ç¾¤ç½‘ç»œé…ç½® - å¼€å‘ç¯å¢ƒæ¨¡æ¿  
# ==========================================

# å¼€å‘ç¯å¢ƒèŠ‚ç‚¹é…ç½®
cluster_formation.classic_config.nodes = rabbit@dev-rmq-01,rabbit@dev-rmq-02

# å¼€å‘ç¯å¢ƒå¯ä»¥ä½¿ç”¨ignoreç­–ç•¥ï¼ˆç®€åŒ–è°ƒè¯•ï¼‰
cluster_partition_handling = ignore

# æ›´é¢‘ç¹çš„å¿ƒè·³æ£€æµ‹ï¼ˆä¾¿äºå¿«é€Ÿå‘ç°é—®é¢˜ï¼‰
cluster_keepalive_interval = 5000

# è¾ƒçŸ­çš„ç½‘ç»œtickæ—¶é—´
net_ticktime = 30

# è¾ƒå°çš„å¯åŠ¨å»¶è¿Ÿ
cluster_formation.randomized_startup_delay_range = 2000

# æ›´å®½æ¾çš„é‡è¯•é…ç½®
mnesia_table_loading_retry_timeout = 60000
mnesia_table_loading_retry_limit = 5

# å¼€å‘ç¯å¢ƒä»…è®°å½•è­¦å‘Š
cluster_formation.node_cleanup.only_log_warning = true
```

### 6.3 è·¨åœ°åŸŸé›†ç¾¤é…ç½®


```bash
# ==========================================
# RabbitMQè·¨åœ°åŸŸé›†ç¾¤é…ç½®æ¨¡æ¿
# ==========================================

# è·¨åœ°åŸŸèŠ‚ç‚¹é…ç½®
cluster_formation.classic_config.nodes = rabbit@beijing-rmq,rabbit@shanghai-rmq,rabbit@guangzhou-rmq

# ä¿å®ˆçš„åˆ†åŒºå¤„ç†ç­–ç•¥
cluster_partition_handling = pause_if_all_down

# è¾ƒé•¿çš„å¿ƒè·³é—´éš”ï¼ˆè€ƒè™‘ç½‘ç»œå»¶è¿Ÿï¼‰
cluster_keepalive_interval = 20000

# å»¶é•¿ç½‘ç»œtickæ—¶é—´ï¼ˆé€‚åº”ç½‘ç»œå»¶è¿Ÿï¼‰
net_ticktime = 120

# æ›´å¤§çš„å¯åŠ¨å»¶è¿ŸèŒƒå›´
cluster_formation.randomized_startup_delay_range = 10000

# æ›´é•¿çš„è¶…æ—¶æ—¶é—´
mnesia_table_loading_retry_timeout = 60000
mnesia_table_loading_retry_limit = 15
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ èŠ‚ç‚¹å‘ç°ï¼šé›†ç¾¤æˆå‘˜å¦‚ä½•æ‰¾åˆ°å½¼æ­¤
ğŸ”¸ å¿ƒè·³æ£€æµ‹ï¼šå¦‚ä½•ç¡®è®¤èŠ‚ç‚¹å¥åº·çŠ¶æ€  
ğŸ”¸ åˆ†åŒºå¤„ç†ï¼šç½‘ç»œæ•…éšœæ—¶çš„åº”å¯¹ç­–ç•¥
ğŸ”¸ æ•°æ®åŒæ­¥ï¼šMnesiaæ•°æ®åº“çš„åŠ è½½æœºåˆ¶
ğŸ”¸ æ•…éšœæ¢å¤ï¼šèŠ‚ç‚¹æ¸…ç†å’Œè‡ªåŠ¨æ¢å¤
```

### 7.2 å…³é”®é…ç½®è®°å¿†å£è¯€


**ğŸ§  é…ç½®è®°å¿†æ³•**ï¼š
```
"èŠ‚ç‚¹åˆ—è¡¨è¦é…å…¨ï¼Œå¿ƒè·³æ£€æµ‹ä¿å¹³å®‰
åˆ†åŒºç­–ç•¥é€‰å¾—å¥½ï¼Œç½‘ç»œæ•…éšœä¸ç”¨æ…Œ  
æ•°æ®åŠ è½½è®¾è¶…æ—¶ï¼Œæ¸…ç†æœºåˆ¶è¦å¼€å¯"
```

### 7.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ“Š ç¯å¢ƒé€‰æ‹©çŸ©é˜µ**

| é…ç½®é¡¹ | **å¼€å‘ç¯å¢ƒ** | **æµ‹è¯•ç¯å¢ƒ** | **ç”Ÿäº§ç¯å¢ƒ** |
|-------|-------------|-------------|-------------|
| å¿ƒè·³é—´éš” | 5ç§’ | 10ç§’ | 10-15ç§’ |
| åˆ†åŒºç­–ç•¥ | ignore | pause_minority | pause_minority |
| ç½‘ç»œtick | 30ç§’ | 60ç§’ | 60-120ç§’ |
| é‡è¯•é™åˆ¶ | 5æ¬¡ | 10æ¬¡ | 10-15æ¬¡ |

### 7.4 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


**â“ é—®é¢˜1ï¼šèŠ‚ç‚¹æ— æ³•åŠ å…¥é›†ç¾¤**
```
æ’æŸ¥æ­¥éª¤ï¼š
1. æ£€æŸ¥èŠ‚ç‚¹åˆ—è¡¨é…ç½®æ˜¯å¦æ­£ç¡®
2. éªŒè¯ç½‘ç»œè¿é€šæ€§
3. ç¡®è®¤Erlang Cookieæ˜¯å¦ä¸€è‡´
4. æŸ¥çœ‹å¯åŠ¨æ—¥å¿—é”™è¯¯ä¿¡æ¯
```

**â“ é—®é¢˜2ï¼šç½‘ç»œåˆ†åŒºé¢‘ç¹å‘ç”Ÿ**
```
è§£å†³æ–¹æ¡ˆï¼š
1. å»¶é•¿å¿ƒè·³æ£€æµ‹é—´éš”
2. å¢åŠ ç½‘ç»œtickæ—¶é—´
3. æ£€æŸ¥ç½‘ç»œç¨³å®šæ€§
4. è€ƒè™‘è°ƒæ•´åˆ†åŒºå¤„ç†ç­–ç•¥
```

**â“ é—®é¢˜3ï¼šèŠ‚ç‚¹é‡å¯åæ•°æ®åŠ è½½å¤±è´¥**
```
å¤„ç†æ–¹æ³•ï¼š
1. å¢åŠ MnesiaåŠ è½½è¶…æ—¶æ—¶é—´
2. æé«˜é‡è¯•æ¬¡æ•°é™åˆ¶  
3. æ£€æŸ¥ç£ç›˜ç©ºé—´å’Œæƒé™
4. éªŒè¯é›†ç¾¤å…¶ä»–èŠ‚ç‚¹çŠ¶æ€
```

### 7.5 æ€§èƒ½ä¼˜åŒ–å»ºè®®


**ğŸš€ ä¼˜åŒ–è¦ç‚¹**ï¼š
```
ç½‘ç»œä¼˜åŒ–ï¼š
â€¢ ä½¿ç”¨é«˜è´¨é‡ç½‘ç»œè¿æ¥
â€¢ åˆç†è®¾ç½®å¿ƒè·³é—´éš”
â€¢ é¿å…ç½‘ç»œæ‹¥å¡æ—¶æ®µ

é…ç½®ä¼˜åŒ–ï¼š
â€¢ æ ¹æ®ç¯å¢ƒè°ƒæ•´è¶…æ—¶å‚æ•°
â€¢ å¯ç”¨é€‚å½“çš„æ¸…ç†æœºåˆ¶
â€¢ å®šæœŸç›‘æ§é›†ç¾¤çŠ¶æ€

ç›‘æ§å»ºè®®ï¼š
â€¢ ç›‘æ§èŠ‚ç‚¹è¿æ¥çŠ¶æ€
â€¢ è·Ÿè¸ªç½‘ç»œåˆ†åŒºäº‹ä»¶
â€¢ è§‚å¯Ÿæ•°æ®åŒæ­¥å»¶è¿Ÿ
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- é›†ç¾¤ç½‘ç»œé…ç½®æ˜¯RabbitMQé«˜å¯ç”¨çš„åŸºç¡€
- ä¸åŒç¯å¢ƒéœ€è¦ä¸åŒçš„é…ç½®ç­–ç•¥
- åˆç†çš„å¿ƒè·³å’Œè¶…æ—¶è®¾ç½®æ˜¯ç¨³å®šè¿è¡Œçš„å…³é”®
- ç›‘æ§å’Œæ•…éšœå¤„ç†æœºåˆ¶åŒæ ·é‡è¦