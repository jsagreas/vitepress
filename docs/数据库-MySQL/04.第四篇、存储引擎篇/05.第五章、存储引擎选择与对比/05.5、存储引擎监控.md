---
title: 5ã€å­˜å‚¨å¼•æ“ç›‘æ§
---
## ğŸ“š ç›®å½•

1. [å­˜å‚¨å¼•æ“ç›‘æ§æ¦‚è¿°](#1-å­˜å‚¨å¼•æ“ç›‘æ§æ¦‚è¿°)
2. [å¼•æ“çŠ¶æ€ç›‘æ§åŸºç¡€](#2-å¼•æ“çŠ¶æ€ç›‘æ§åŸºç¡€)
3. [æ€§èƒ½æŒ‡æ ‡æ”¶é›†ä¸åˆ†æ](#3-æ€§èƒ½æŒ‡æ ‡æ”¶é›†ä¸åˆ†æ)
4. [èµ„æºä½¿ç”¨ç›‘æ§ç®¡ç†](#4-èµ„æºä½¿ç”¨ç›‘æ§ç®¡ç†)
5. [é”ç­‰å¾…åˆ†ææŠ€æœ¯](#5-é”ç­‰å¾…åˆ†ææŠ€æœ¯)
6. [ç¼“å­˜å‘½ä¸­ç‡ä¼˜åŒ–](#6-ç¼“å­˜å‘½ä¸­ç‡ä¼˜åŒ–)
7. [I/Oæ“ä½œç»Ÿè®¡åˆ†æ](#7-I/Oæ“ä½œç»Ÿè®¡åˆ†æ)
8. [ç›‘æ§è‡ªåŠ¨åŒ–å·¥å…·](#8-ç›‘æ§è‡ªåŠ¨åŒ–å·¥å…·)
9. [ç›‘æ§ä½“ç³»å»ºè®¾](#9-ç›‘æ§ä½“ç³»å»ºè®¾)
10. [å…³é”®ç›‘æ§æŒ‡æ ‡è¯¦è§£](#10-å…³é”®ç›‘æ§æŒ‡æ ‡è¯¦è§£)
11. [å‘Šè­¦ç­–ç•¥è®¾è®¡](#11-å‘Šè­¦ç­–ç•¥è®¾è®¡)
12. [å¤šå¼•æ“ç»Ÿä¸€ç›‘æ§å¹³å°](#12-å¤šå¼•æ“ç»Ÿä¸€ç›‘æ§å¹³å°)
13. [ç›‘æ§æ•°æ®åˆ†æä¸è¶‹åŠ¿é¢„æµ‹](#13-ç›‘æ§æ•°æ®åˆ†æä¸è¶‹åŠ¿é¢„æµ‹)
14. [æ•…éšœé¢„æµ‹å’Œé¢„è­¦æœºåˆ¶](#14-æ•…éšœé¢„æµ‹å’Œé¢„è­¦æœºåˆ¶)
15. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#15-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” å­˜å‚¨å¼•æ“ç›‘æ§æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯å­˜å‚¨å¼•æ“ç›‘æ§


**ğŸ”¸ é€šä¿—ç†è§£**
```
æƒ³è±¡æ•°æ®åº“æ˜¯ä¸€è¾†æ±½è½¦ï¼š
â€¢ å­˜å‚¨å¼•æ“ = å‘åŠ¨æœºï¼ˆæ ¸å¿ƒåŠ¨åŠ›ï¼‰
â€¢ ç›‘æ§ç³»ç»Ÿ = ä»ªè¡¨ç›˜ï¼ˆæ˜¾ç¤ºå„ç§çŠ¶æ€ï¼‰
â€¢ æ€§èƒ½æŒ‡æ ‡ = è½¬é€Ÿã€æ²¹æ¸©ã€æ°´æ¸©ç­‰
â€¢ å‘Šè­¦æœºåˆ¶ = æ•…éšœç¯ï¼ˆæœ‰é—®é¢˜æ—¶æé†’ï¼‰

ç›‘æ§çš„ä½œç”¨ï¼š
å®æ—¶æŒæ¡"å‘åŠ¨æœº"è¿è¡ŒçŠ¶æ€ï¼Œé¢„é˜²æ•…éšœï¼Œä¼˜åŒ–æ€§èƒ½
```

**ğŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
å­˜å‚¨å¼•æ“ç›‘æ§ï¼šå¯¹æ•°æ®åº“å­˜å‚¨å¼•æ“çš„è¿è¡ŒçŠ¶æ€ã€æ€§èƒ½æŒ‡æ ‡ã€
èµ„æºä½¿ç”¨æƒ…å†µè¿›è¡Œå®æ—¶ç›‘æµ‹å’Œåˆ†æçš„æŠ€æœ¯ä½“ç³»

ç›®æ ‡ï¼š
â€¢ ä¿éšœç³»ç»Ÿç¨³å®šè¿è¡Œ
â€¢ åŠæ—¶å‘ç°æ€§èƒ½ç“¶é¢ˆ
â€¢ é¢„é˜²æ•…éšœå‘ç”Ÿ
â€¢ ä¼˜åŒ–èµ„æºä½¿ç”¨
```

### 1.2 ç›‘æ§çš„é‡è¦æ€§


**ğŸš¨ ä¸ç›‘æ§çš„é£é™©**
```
æ€§èƒ½é£é™©ï¼š
â€¢ é”ç­‰å¾…æ—¶é—´é•¿ï¼Œç”¨æˆ·è¯·æ±‚å¡é¡¿
â€¢ ç¼“å­˜å‘½ä¸­ç‡ä½ï¼ŒæŸ¥è¯¢é€Ÿåº¦æ…¢
â€¢ I/Oç“¶é¢ˆå¯¼è‡´ç³»ç»Ÿå“åº”ç¼“æ…¢

ç¨³å®šæ€§é£é™©ï¼š
â€¢ å†…å­˜æº¢å‡ºå¯¼è‡´ç³»ç»Ÿå´©æºƒ
â€¢ ç£ç›˜ç©ºé—´è€—å°½å½±å“å†™å…¥
â€¢ è¿æ¥æ± æ»¡å¯¼è‡´æ— æ³•æœåŠ¡

ä¸šåŠ¡é£é™©ï¼š
â€¢ ç”¨æˆ·ä½“éªŒå·®ï¼Œæµå¤±å®¢æˆ·
â€¢ ç³»ç»Ÿä¸å¯ç”¨ï¼Œå½±å“æ”¶å…¥
â€¢ æ•°æ®ä¸¢å¤±ï¼Œæ³•å¾‹é£é™©
```

**âœ… æœ‰æ•ˆç›‘æ§çš„ä»·å€¼**
```
é¢„é˜²èƒœäºæ²»ç–—ï¼š
â€¢ æå‰å‘ç°é—®é¢˜ï¼Œé¿å…æ•…éšœ
â€¢ ä¸»åŠ¨ä¼˜åŒ–ï¼Œæå‡æ€§èƒ½
â€¢ æ•°æ®é©±åŠ¨å†³ç­–

é™ä½è¿ç»´æˆæœ¬ï¼š
â€¢ è‡ªåŠ¨åŒ–å‘Šè­¦ï¼Œå‡å°‘äººå·¥å·¡æ£€
â€¢ å¿«é€Ÿå®šä½é—®é¢˜ï¼Œç¼©çŸ­æ•…éšœæ¢å¤æ—¶é—´
â€¢ å†å²æ•°æ®åˆ†æï¼ŒæŒ‡å¯¼å®¹é‡è§„åˆ’
```

### 1.3 ç›‘æ§æ¶æ„æ¦‚è§ˆ


**ğŸ—ï¸ ç›‘æ§ç³»ç»Ÿæ•´ä½“æ¶æ„**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 ç›‘æ§æ¶æ„å›¾                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  æ•°æ®åº“å®ä¾‹                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   InnoDB    â”‚    â”‚   MyISAM    â”‚           â”‚
â”‚  â”‚   å¼•æ“      â”‚    â”‚   å¼•æ“      â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚        â”‚                  â”‚                   â”‚
â”‚        â–¼                  â–¼                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚          ç›‘æ§æ•°æ®é‡‡é›†å±‚              â”‚   â”‚
â”‚  â”‚  â€¢ çŠ¶æ€å˜é‡  â€¢ æ€§èƒ½è®¡æ•°å™¨  â€¢ æ—¥å¿—    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                â”‚                           â”‚
â”‚                â–¼                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚          æ•°æ®å¤„ç†åˆ†æå±‚              â”‚   â”‚
â”‚  â”‚  â€¢ æŒ‡æ ‡è®¡ç®—  â€¢ è¶‹åŠ¿åˆ†æ  â€¢ å¼‚å¸¸æ£€æµ‹  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                â”‚                           â”‚
â”‚                â–¼                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚          å¯è§†åŒ–å‘Šè­¦å±‚                â”‚   â”‚
â”‚  â”‚  â€¢ å›¾è¡¨å±•ç¤º  â€¢ å®æ—¶å‘Šè­¦  â€¢ æŠ¥è¡¨ç”Ÿæˆ  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ğŸ“Š å¼•æ“çŠ¶æ€ç›‘æ§åŸºç¡€


### 2.1 å­˜å‚¨å¼•æ“çŠ¶æ€æŸ¥çœ‹


**ğŸ”¸ åŸºæœ¬çŠ¶æ€æŸ¥è¯¢**
```sql
-- æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„å­˜å‚¨å¼•æ“
SHOW ENGINES;

-- æŸ¥çœ‹è¡¨ä½¿ç”¨çš„å­˜å‚¨å¼•æ“
SELECT TABLE_NAME, ENGINE 
FROM information_schema.TABLES 
WHERE TABLE_SCHEMA = 'your_database';

-- æŸ¥çœ‹InnoDBå¼•æ“çŠ¶æ€
SHOW ENGINE INNODB STATUS;

-- æŸ¥çœ‹å…³é”®çŠ¶æ€å˜é‡
SHOW GLOBAL STATUS LIKE 'Innodb%';
```

> **ğŸ’¡ æ–°æ‰‹æç¤ºï¼š** `SHOW ENGINE INNODB STATUS` å‘½ä»¤ä¼šè¾“å‡ºå¤§é‡ä¿¡æ¯ï¼Œå°±åƒæ±½è½¦çš„è¯¦ç»†æ£€æµ‹æŠ¥å‘Šï¼ŒåŒ…å«å¼•æ“çš„æ–¹æ–¹é¢é¢çŠ¶æ€ã€‚

### 2.2 InnoDBçŠ¶æ€è§£è¯»


**ğŸ“‹ InnoDBçŠ¶æ€ä¿¡æ¯ç»“æ„**
```
SHOW ENGINE INNODB STATUS è¾“å‡ºå†…å®¹ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              InnoDBçŠ¶æ€æŠ¥å‘Š             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. å½“å‰æ—¶é—´å’ŒçŠ¶æ€æ¦‚è§ˆ                   â”‚
â”‚ 2. äº‹åŠ¡ç›¸å…³ä¿¡æ¯                         â”‚
â”‚ 3. æ­»é”ä¿¡æ¯                             â”‚
â”‚ 4. å¤–é”®é”™è¯¯ä¿¡æ¯                         â”‚
â”‚ 5. æ–‡ä»¶I/Oä¿¡æ¯                          â”‚
â”‚ 6. æ’å…¥ç¼“å†²åŒºä¿¡æ¯                       â”‚
â”‚ 7. è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•                       â”‚
â”‚ 8. æ—¥å¿—ä¿¡æ¯                             â”‚
â”‚ 9. ç¼“å†²æ± å’Œå†…å­˜ä¿¡æ¯                     â”‚
â”‚ 10. è¡Œæ“ä½œç»Ÿè®¡                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”§ å…³é”®çŠ¶æ€æŒ‡æ ‡è§£è¯»**
```sql
-- æŸ¥è¯¢æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡
SELECT 
    VARIABLE_NAME,
    VARIABLE_VALUE
FROM performance_schema.global_status 
WHERE VARIABLE_NAME IN (
    'Innodb_buffer_pool_read_requests',   -- ç¼“å†²æ± è¯»å–è¯·æ±‚
    'Innodb_buffer_pool_reads',           -- ç‰©ç†è¯»å–æ¬¡æ•°
    'Innodb_rows_read',                   -- è¯»å–è¡Œæ•°
    'Innodb_rows_inserted',               -- æ’å…¥è¡Œæ•°
    'Innodb_lock_waits',                  -- é”ç­‰å¾…æ¬¡æ•°
    'Innodb_deadlocks'                    -- æ­»é”æ¬¡æ•°
);
```

### 2.3 çŠ¶æ€ç›‘æ§è„šæœ¬


**ğŸ› ï¸ ç®€åŒ–ç›‘æ§è„šæœ¬**
```python
import mysql.connector
from datetime import datetime

class StorageEngineMonitor:
    def __init__(self, host, user, password, database):
        self.conn = mysql.connector.connect(
            host=host, user=user, password=password, database=database
        )
    
    def get_key_metrics(self):
        """è·å–å…³é”®æ€§èƒ½æŒ‡æ ‡"""
        cursor = self.conn.cursor(dictionary=True)
        
        sql = """
        SELECT VARIABLE_NAME, VARIABLE_VALUE
        FROM performance_schema.global_status 
        WHERE VARIABLE_NAME IN (
            'Innodb_buffer_pool_read_requests',
            'Innodb_buffer_pool_reads',
            'Innodb_rows_read',
            'Innodb_rows_inserted', 
            'Innodb_lock_waits'
        )
        """
        
        cursor.execute(sql)
        metrics = {row['VARIABLE_NAME']: int(row['VARIABLE_VALUE']) 
                  for row in cursor.fetchall()}
        
        # è®¡ç®—ç¼“å†²æ± å‘½ä¸­ç‡
        requests = metrics.get('Innodb_buffer_pool_read_requests', 0)
        reads = metrics.get('Innodb_buffer_pool_reads', 0)
        
        if requests > 0:
            hit_rate = (1 - reads / requests) * 100
            metrics['buffer_pool_hit_rate'] = round(hit_rate, 2)
        
        cursor.close()
        return metrics
    
    def check_alerts(self, metrics):
        """æ£€æŸ¥å‘Šè­¦æ¡ä»¶"""
        alerts = []
        
        # æ£€æŸ¥ç¼“å†²æ± å‘½ä¸­ç‡
        hit_rate = metrics.get('buffer_pool_hit_rate', 100)
        if hit_rate < 95:
            alerts.append(f"ç¼“å†²æ± å‘½ä¸­ç‡åä½: {hit_rate}%")
        
        # æ£€æŸ¥é”ç­‰å¾…
        lock_waits = metrics.get('Innodb_lock_waits', 0)
        if lock_waits > 100:
            alerts.append(f"é”ç­‰å¾…æ¬¡æ•°è¾ƒå¤š: {lock_waits}")
        
        return alerts

# ä½¿ç”¨ç¤ºä¾‹
monitor = StorageEngineMonitor('localhost', 'root', 'password', 'test')
metrics = monitor.get_key_metrics()
alerts = monitor.check_alerts(metrics)

if alerts:
    print("å‘ç°é—®é¢˜:", alerts)
else:
    print("ç³»ç»ŸçŠ¶æ€æ­£å¸¸")
```

---

## 3. ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡æ”¶é›†ä¸åˆ†æ


### 3.1 æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡ä½“ç³»


**ğŸ”¸ æ€§èƒ½æŒ‡æ ‡åˆ†ç±»**
```
ğŸ“Š ååé‡æŒ‡æ ‡ï¼š
â€¢ QPS (Queries Per Second)ï¼šæ¯ç§’æŸ¥è¯¢æ•°
â€¢ TPS (Transactions Per Second)ï¼šæ¯ç§’äº‹åŠ¡æ•°
â€¢ è¿æ¥æ•°ï¼šå½“å‰æ´»è·ƒè¿æ¥æ•°

â±ï¸ å»¶è¿ŸæŒ‡æ ‡ï¼š
â€¢ å¹³å‡å“åº”æ—¶é—´
â€¢ P95/P99å“åº”æ—¶é—´
â€¢ æ…¢æŸ¥è¯¢æ¯”ä¾‹

ğŸ”„ æ“ä½œæŒ‡æ ‡ï¼š
â€¢ SELECT/INSERT/UPDATE/DELETE æ“ä½œç»Ÿè®¡
â€¢ ç´¢å¼•ä½¿ç”¨ç»Ÿè®¡
â€¢ è¡¨æ‰«ææ¬¡æ•°
```

**ğŸ“Š å…³é”®æŒ‡æ ‡å¯¹æ¯”è¡¨**

| æŒ‡æ ‡ç±»åˆ« | **InnoDBæŒ‡æ ‡** | **MyISAMæŒ‡æ ‡** | **ç›‘æ§æ„ä¹‰** | **æ­£å¸¸èŒƒå›´** |
|----------|---------------|---------------|-------------|-------------|
| **è¯»æ“ä½œ** | `Innodb_rows_read` | `Handler_read_*` | æ•°æ®è¯»å–é‡ | æ ¹æ®ä¸šåŠ¡è€Œå®š |
| **å†™æ“ä½œ** | `Innodb_rows_inserted` | `Handler_write` | æ•°æ®å†™å…¥é‡ | æ ¹æ®ä¸šåŠ¡è€Œå®š |
| **ç¼“å†²æ± ** | `Innodb_buffer_pool_*` | `Key_buffer_*` | ç¼“å­˜æ•ˆç‡ | å‘½ä¸­ç‡>95% |
| **é”ç­‰å¾…** | `Innodb_lock_waits` | `Table_locks_waited` | å¹¶å‘æ€§èƒ½ | ç­‰å¾…<1ç§’ |

### 3.2 æŒ‡æ ‡æ”¶é›†å®ç°


**ğŸ”§ JavaæŒ‡æ ‡æ”¶é›†å™¨**
```java
@Component
public class EngineMetricsCollector {
    
    public Map<String, Long> collectInnoDbMetrics() {
        String sql = """
            SELECT VARIABLE_NAME, CAST(VARIABLE_VALUE AS UNSIGNED) as VARIABLE_VALUE
            FROM performance_schema.global_status 
            WHERE VARIABLE_NAME LIKE 'Innodb_%'
            """;
        
        return jdbcTemplate.queryForList(sql).stream()
            .collect(Collectors.toMap(
                row -> (String) row.get("VARIABLE_NAME"),
                row -> (Long) row.get("VARIABLE_VALUE")
            ));
    }
    
    public double calculateBufferPoolHitRate(Map<String, Long> metrics) {
        long requests = metrics.get("Innodb_buffer_pool_read_requests");
        long reads = metrics.get("Innodb_buffer_pool_reads");
        
        if (requests > 0) {
            return (1.0 - (double) reads / requests) * 100;
        }
        return 0.0;
    }
}
```

### 3.3 æŒ‡æ ‡è¶‹åŠ¿åˆ†æ


**ğŸ“Š æ€§èƒ½è¶‹åŠ¿è®¡ç®—**
```java
public class MetricsTrendAnalyzer {
    
    public TrendDirection analyzeTrend(List<Double> values) {
        if (values.size() < 3) return TrendDirection.UNKNOWN;
        
        // ç®€å•è¶‹åŠ¿åˆ¤æ–­ï¼šæ¯”è¾ƒæœ€è¿‘3ä¸ªå€¼çš„å¹³å‡ä¸ä¹‹å‰çš„å¹³å‡
        double recent = values.subList(values.size()-3, values.size())
                             .stream().mapToDouble(Double::doubleValue).average().orElse(0);
        double previous = values.subList(0, values.size()-3)
                               .stream().mapToDouble(Double::doubleValue).average().orElse(0);
        
        double change = (recent - previous) / previous * 100;
        
        if (Math.abs(change) < 5) return TrendDirection.STABLE;
        return change > 0 ? TrendDirection.INCREASING : TrendDirection.DECREASING;
    }
}
```

---

## 4. ğŸ’¾ èµ„æºä½¿ç”¨ç›‘æ§ç®¡ç†


### 4.1 å†…å­˜èµ„æºç›‘æ§


**ğŸ”¸ å†…å­˜ç›‘æ§çš„é‡è¦æ€§**
```
ä¸ºä»€ä¹ˆè¦ç›‘æ§å†…å­˜ï¼š
â€¢ å†…å­˜ä¸è¶³ä¼šå¯¼è‡´é¢‘ç¹çš„ç£ç›˜I/Oï¼ˆæ€§èƒ½ä¸‹é™ï¼‰
â€¢ å†…å­˜æ³„æ¼å¯èƒ½å¯¼è‡´ç³»ç»Ÿå´©æºƒ
â€¢ ä¸åŒå­˜å‚¨å¼•æ“çš„å†…å­˜ä½¿ç”¨æ¨¡å¼ä¸åŒ

ç›‘æ§ç»´åº¦ï¼š
â€¢ æ€»å†…å­˜ä½¿ç”¨é‡
â€¢ ç¼“å†²æ± ä½¿ç”¨æƒ…å†µ
â€¢ æ’åºç¼“å†²åŒºå¤§å°
â€¢ ä¸´æ—¶è¡¨å†…å­˜ä½¿ç”¨
```

**ğŸ“Š å†…å­˜ç›‘æ§å®ç°**
```java
public class MemoryMonitor {
    
    public MemoryUsageStats getMemoryUsage() {
        // è·å–ç¼“å†²æ± ä¿¡æ¯
        String sql = """
            SELECT 
                ROUND(
                    (SELECT VARIABLE_VALUE FROM performance_schema.global_status 
                     WHERE VARIABLE_NAME = 'Innodb_buffer_pool_pages_data') * 16 / 1024, 2
                ) as buffer_data_mb,
                ROUND(
                    (SELECT VARIABLE_VALUE FROM performance_schema.global_status 
                     WHERE VARIABLE_NAME = 'Innodb_buffer_pool_pages_total') * 16 / 1024, 2
                ) as buffer_total_mb
            """;
        
        Map<String, Object> result = jdbcTemplate.queryForMap(sql);
        double totalMb = (Double) result.get("buffer_total_mb");
        double dataMb = (Double) result.get("buffer_data_mb");
        
        MemoryUsageStats stats = new MemoryUsageStats();
        stats.setBufferPoolSizeMB(totalMb);
        stats.setBufferPoolUsageRate(dataMb / totalMb * 100);
        
        return stats;
    }
    
    public void checkMemoryAlerts(MemoryUsageStats stats) {
        if (stats.getBufferPoolUsageRate() > 95) {
            alertService.sendWarning("ç¼“å†²æ± ä½¿ç”¨ç‡è¿‡é«˜: " + stats.getBufferPoolUsageRate() + "%");
        }
    }
}
```

### 4.2 ç£ç›˜ç©ºé—´ç›‘æ§


**ğŸ’½ ç£ç›˜ç›‘æ§å®ç°**
```java
public class DiskSpaceMonitor {
    
    public DiskUsageInfo getDiskUsage(String path) {
        try {
            FileStore store = Files.getFileStore(Paths.get(path));
            
            long totalBytes = store.getTotalSpace();
            long usableBytes = store.getUsableSpace();
            double usageRate = (double)(totalBytes - usableBytes) / totalBytes * 100;
            
            DiskUsageInfo info = new DiskUsageInfo();
            info.setPath(path);
            info.setTotalSizeGB(totalBytes / (1024 * 1024 * 1024));
            info.setUsageRate(usageRate);
            
            return info;
        } catch (IOException e) {
            log.error("è·å–ç£ç›˜ä¿¡æ¯å¤±è´¥", e);
            return null;
        }
    }
    
    public void checkDiskAlerts(DiskUsageInfo diskInfo) {
        double usageRate = diskInfo.getUsageRate();
        
        if (usageRate > 90) {
            alertService.sendCritical("ç£ç›˜ç©ºé—´ä¸¥é‡ä¸è¶³: " + usageRate + "%");
        } else if (usageRate > 80) {
            alertService.sendWarning("ç£ç›˜ç©ºé—´ç´§å¼ : " + usageRate + "%");
        }
    }
}
```

---

## 5. ğŸ”’ é”ç­‰å¾…åˆ†ææŠ€æœ¯


### 5.1 ä»€ä¹ˆæ˜¯é”ç­‰å¾…


**ğŸ”¸ é€šä¿—ç†è§£é”ç­‰å¾…**
```
é”ç­‰å¾…å°±åƒæ’é˜Ÿä¹°å¥¶èŒ¶ï¼š
â€¢ å¥¶èŒ¶åº— = æ•°æ®åº“è¡¨
â€¢ é¡¾å®¢ = äº‹åŠ¡
â€¢ æ’é˜Ÿ = é”ç­‰å¾…
â€¢ åˆ¶ä½œå¥¶èŒ¶çš„æ—¶é—´ = äº‹åŠ¡æ‰§è¡Œæ—¶é—´

æ­£å¸¸æƒ…å†µï¼šé˜Ÿä¼ç§»åŠ¨å¿«ï¼Œç­‰å¾…æ—¶é—´çŸ­
å¼‚å¸¸æƒ…å†µï¼šæŸä¸ªé¡¾å®¢ç‚¹é¤å¾ˆå¤æ‚ï¼Œåé¢çš„äººéƒ½è¦ç­‰ï¼ˆé”ç­‰å¾…æ—¶é—´é•¿ï¼‰

æ•°æ®åº“ä¸­ï¼š
â€¢ äº‹åŠ¡Aåœ¨ä¿®æ”¹æ•°æ®ï¼Œè·å¾—äº†é”
â€¢ äº‹åŠ¡Bæƒ³ä¿®æ”¹åŒæ ·çš„æ•°æ®ï¼Œå¿…é¡»ç­‰å¾…
â€¢ å¦‚æœäº‹åŠ¡Aæ‰§è¡Œå¾ˆæ…¢ï¼Œäº‹åŠ¡Bå°±ä¼šé•¿æ—¶é—´ç­‰å¾…
```

### 5.2 é”ç­‰å¾…ç›‘æ§å®ç°


**ğŸ” é”ç­‰å¾…çŠ¶æ€æŸ¥è¯¢**
```sql
-- MySQL 8.0æŸ¥çœ‹é”ç­‰å¾…
SELECT 
    waiting_thread_id,
    waiting_pid, 
    waiting_lock_type,
    waiting_lock_duration,
    sql_text as waiting_query,
    blocking_thread_id,
    blocking_pid
FROM sys.innodb_lock_waits;

-- æŸ¥çœ‹å½“å‰è¿è¡Œçš„äº‹åŠ¡
SELECT 
    trx_id,
    trx_mysql_thread_id,
    trx_query,
    trx_operation_state,
    trx_tables_in_use,
    trx_lock_structs
FROM information_schema.innodb_trx;
```

**ğŸ”§ é”ç­‰å¾…ç›‘æ§ä»£ç **
```java
public class LockWaitMonitor {
    
    public List<LockWaitInfo> getCurrentLockWaits() {
        String sql = """
            SELECT 
                waiting_thread_id, waiting_pid, waiting_lock_duration,
                sql_text, blocking_thread_id, blocking_pid
            FROM sys.innodb_lock_waits
            """;
        
        return jdbcTemplate.query(sql, (rs, rowNum) -> {
            LockWaitInfo info = new LockWaitInfo();
            info.setWaitingThreadId(rs.getLong("waiting_thread_id"));
            info.setWaitDuration(rs.getString("waiting_lock_duration"));
            info.setWaitingQuery(rs.getString("sql_text"));
            info.setBlockingThreadId(rs.getLong("blocking_thread_id"));
            return info;
        });
    }
    
    public void analyzeLockWaits() {
        List<LockWaitInfo> lockWaits = getCurrentLockWaits();
        
        if (lockWaits.isEmpty()) {
            log.info("å½“å‰æ²¡æœ‰é”ç­‰å¾…");
            return;
        }
        
        for (LockWaitInfo lockWait : lockWaits) {
            long waitSeconds = parseDurationToSeconds(lockWait.getWaitDuration());
            
            if (waitSeconds > 30) {
                log.warn("å‘ç°é•¿æ—¶é—´é”ç­‰å¾…: çº¿ç¨‹{} ç­‰å¾…{}ç§’", 
                    lockWait.getWaitingThreadId(), waitSeconds);
                
                if (waitSeconds > 300) {  // 5åˆ†é’Ÿå‘Šè­¦
                    alertService.sendCritical("ä¸¥é‡é”ç­‰å¾…: " + waitSeconds + "ç§’");
                }
            }
        }
    }
}
```

### 5.3 æ­»é”æ£€æµ‹ä¸åˆ†æ


**âš ï¸ æ­»é”é—®é¢˜åˆ†æ**
```
æ­»é”ç°è±¡ï¼šä¸¤ä¸ªæˆ–å¤šä¸ªäº‹åŠ¡ç›¸äº’ç­‰å¾…å¯¹æ–¹é‡Šæ”¾é”

ç»å…¸æ­»é”åœºæ™¯ï¼š
æ—¶é—´çº¿ï¼š
T1: äº‹åŠ¡Aé”å®šè®°å½•1 â†’ äº‹åŠ¡Bé”å®šè®°å½•2
T2: äº‹åŠ¡Aç­‰å¾…è®°å½•2 â†’ äº‹åŠ¡Bç­‰å¾…è®°å½•1  
ç»“æœï¼šæ­»é”ï¼MySQLè‡ªåŠ¨å›æ»šå…¶ä¸­ä¸€ä¸ªäº‹åŠ¡

é¢„é˜²ç­–ç•¥ï¼š
â€¢ ç»Ÿä¸€é”é¡ºåºï¼šæ€»æ˜¯æŒ‰ç…§ç›¸åŒé¡ºåºè·å–é”
â€¢ ç¼©çŸ­äº‹åŠ¡æ—¶é—´ï¼šå‡å°‘æŒé”æ—¶é—´
â€¢ é™ä½éš”ç¦»çº§åˆ«ï¼šåœ¨å¯èƒ½çš„æƒ…å†µä¸‹
```

**ğŸ” æ­»é”ç›‘æ§**
```java
public class DeadlockMonitor {
    
    public DeadlockInfo getLatestDeadlock() {
        String sql = "SHOW ENGINE INNODB STATUS";
        String status = jdbcTemplate.queryForObject(sql, 
            (rs, rowNum) -> rs.getString("Status"));
        
        return parseDeadlockFromStatus(status);
    }
    
    public void monitorDeadlockFrequency() {
        // è·å–æ­»é”è®¡æ•°å™¨
        Long deadlocks = jdbcTemplate.queryForObject(
            "SELECT VARIABLE_VALUE FROM performance_schema.global_status " +
            "WHERE VARIABLE_NAME = 'Innodb_deadlocks'", Long.class);
        
        // æ£€æŸ¥æ­»é”é¢‘ç‡ï¼ˆéœ€è¦ä¸å†å²æ•°æ®æ¯”è¾ƒï¼‰
        if (isDeadlockFrequencyHigh(deadlocks)) {
            alertService.sendWarning("æ­»é”é¢‘ç‡è¿‡é«˜ï¼Œå»ºè®®æ£€æŸ¥åº”ç”¨é€»è¾‘");
        }
    }
}
```

---

## 6. ğŸ¯ ç¼“å­˜å‘½ä¸­ç‡ä¼˜åŒ–


### 6.1 ç¼“å­˜å‘½ä¸­ç‡åŸç†


**ğŸ”¸ ä»€ä¹ˆæ˜¯ç¼“å­˜å‘½ä¸­ç‡**
```
ç¼“å­˜å‘½ä¸­ç‡ = ä»å†…å­˜è¯»å–çš„æ¬¡æ•° Ã· æ€»è¯»å–æ¬¡æ•° Ã— 100%

é€šä¿—ç†è§£ï¼š
â€¢ ä½ çš„ä¹¦æ¡Œ = æ•°æ®åº“ç¼“å­˜ï¼ˆå†…å­˜ï¼‰
â€¢ ä¹¦æ¶ = æ•°æ®åº“å­˜å‚¨ï¼ˆç£ç›˜ï¼‰
â€¢ å‘½ä¸­ = éœ€è¦çš„ä¹¦æ­£å¥½åœ¨ä¹¦æ¡Œä¸Š
â€¢ æœªå‘½ä¸­ = éœ€è¦åˆ°ä¹¦æ¶ä¸Šæ‰¾ä¹¦

é«˜å‘½ä¸­ç‡çš„å¥½å¤„ï¼š
â€¢ è¯»å–é€Ÿåº¦å¿«ï¼ˆå†…å­˜æ¯”ç£ç›˜å¿«1000å€ï¼‰
â€¢ å‡å°‘ç£ç›˜I/Oå‹åŠ›
â€¢ æå‡æ•´ä½“ç³»ç»Ÿæ€§èƒ½
```

**ğŸ“Š ä¸åŒå­˜å‚¨å¼•æ“çš„ç¼“å­˜æœºåˆ¶**
```
InnoDBç¼“å­˜ï¼šæ•°æ®é¡µ + ç´¢å¼•é¡µ + æ’å…¥ç¼“å†²
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            InnoDBç¼“å†²æ±              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ•°æ®é¡µç¼“å­˜ â”‚ ç´¢å¼•é¡µç¼“å­˜ â”‚ æ’å…¥ç¼“å†²  â”‚
â”‚   çƒ­ç‚¹æ•°æ®  â”‚   å¸¸ç”¨ç´¢å¼•  â”‚  å»¶è¿Ÿæ’å…¥ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MyISAMç¼“å­˜ï¼šä»…ç´¢å¼•é¡µ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           MyISAMé”®ç¼“å­˜              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        åªç¼“å­˜ç´¢å¼•é¡µ                 â”‚
â”‚        æ•°æ®é¡µä¾èµ–æ“ä½œç³»ç»Ÿç¼“å­˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 ç¼“å­˜å‘½ä¸­ç‡ç›‘æ§


**ğŸ“ˆ ç¼“å­˜ç›‘æ§å®ç°**
```java
public class CacheMonitor {
    
    public CacheStats getBufferPoolStats() {
        String sql = """
            SELECT 
                (SELECT VARIABLE_VALUE FROM performance_schema.global_status 
                 WHERE VARIABLE_NAME = 'Innodb_buffer_pool_read_requests') as requests,
                (SELECT VARIABLE_VALUE FROM performance_schema.global_status 
                 WHERE VARIABLE_NAME = 'Innodb_buffer_pool_reads') as physical_reads,
                (SELECT VARIABLE_VALUE FROM performance_schema.global_status 
                 WHERE VARIABLE_NAME = 'Innodb_buffer_pool_pages_total') as total_pages,
                (SELECT VARIABLE_VALUE FROM performance_schema.global_status 
                 WHERE VARIABLE_NAME = 'Innodb_buffer_pool_pages_data') as data_pages
            """;
        
        Map<String, Object> result = jdbcTemplate.queryForMap(sql);
        
        CacheStats stats = new CacheStats();
        long requests = (Long) result.get("requests");
        long physicalReads = (Long) result.get("physical_reads");
        
        // è®¡ç®—å‘½ä¸­ç‡
        if (requests > 0) {
            stats.setHitRate((1.0 - (double) physicalReads / requests) * 100);
        }
        
        // è®¡ç®—ä½¿ç”¨ç‡
        long totalPages = (Long) result.get("total_pages");
        long dataPages = (Long) result.get("data_pages");
        stats.setUsageRate((double) dataPages / totalPages * 100);
        
        return stats;
    }
    
    public void optimizeBufferPool(CacheStats stats) {
        if (stats.getHitRate() < 95.0) {
            log.warn("ç¼“å†²æ± å‘½ä¸­ç‡åä½: {}%, å»ºè®®å¢åŠ innodb_buffer_pool_size", 
                stats.getHitRate());
        }
        
        if (stats.getUsageRate() > 95.0) {
            log.warn("ç¼“å†²æ± ä½¿ç”¨ç‡è¿‡é«˜: {}%, è€ƒè™‘å¢åŠ ç¼“å†²æ± å¤§å°", 
                stats.getUsageRate());
        }
    }
}
```

### 6.3 ç¼“å­˜ä¼˜åŒ–é…ç½®


**âš¡ ç¼“å­˜æ€§èƒ½ä¼˜åŒ–**

| ä¼˜åŒ–ç»´åº¦ | **é…ç½®å‚æ•°** | **æ¨èå€¼** | **è¯´æ˜** |
|----------|-------------|-----------|---------|
| **ç¼“å†²æ± å¤§å°** | `innodb_buffer_pool_size` | ç‰©ç†å†…å­˜çš„70-80% | æ ¸å¿ƒä¼˜åŒ–å‚æ•° |
| **ç¼“å†²æ± å®ä¾‹** | `innodb_buffer_pool_instances` | CPUæ ¸æ•°/2 | å‡å°‘é”ç«äº‰ |
| **è„é¡µåˆ·æ–°** | `innodb_max_dirty_pages_pct` | 75% | æ§åˆ¶è„é¡µæ¯”ä¾‹ |
| **I/Oå®¹é‡** | `innodb_io_capacity` | æ ¹æ®ç£ç›˜ç±»å‹ | SSD:2000, HDD:200 |

```sql
-- ç¼“å­˜ä¼˜åŒ–é…ç½®ç¤ºä¾‹
SET GLOBAL innodb_buffer_pool_size = 26843545600;  -- 25GB
SET GLOBAL innodb_buffer_pool_instances = 8;       -- 8ä¸ªå®ä¾‹
SET GLOBAL innodb_max_dirty_pages_pct = 75;        -- è„é¡µé˜ˆå€¼75%
SET GLOBAL innodb_io_capacity = 2000;              -- SSD I/Oå®¹é‡
```

---

## 7. ğŸ’¿ I/Oæ“ä½œç»Ÿè®¡åˆ†æ


### 7.1 I/Oç›‘æ§çš„é‡è¦æ€§


**ğŸ”¸ ä¸ºä»€ä¹ˆè¦ç›‘æ§I/O**
```
I/Oæ˜¯æ•°æ®åº“æ€§èƒ½çš„å…³é”®ç“¶é¢ˆï¼š
â€¢ ç£ç›˜è¯»å†™æ¯”å†…å­˜æ…¢1000å€ä»¥ä¸Š
â€¢ I/Oç­‰å¾…ä¼šå¯¼è‡´æŸ¥è¯¢å“åº”ç¼“æ…¢
â€¢ è¿‡åº¦I/Oä¼šå½±å“ç³»ç»Ÿæ•´ä½“æ€§èƒ½

ç›‘æ§ç›®æ ‡ï¼š
â€¢ è¯†åˆ«I/Oçƒ­ç‚¹
â€¢ ä¼˜åŒ–ç£ç›˜ä½¿ç”¨
â€¢ é¢„é˜²I/Oç“¶é¢ˆ
â€¢ æŒ‡å¯¼ç¡¬ä»¶å‡çº§
```

**ğŸ“Š I/OæŒ‡æ ‡åˆ†ç±»**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              I/Oç›‘æ§ä½“ç³»               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è¯»å–æŒ‡æ ‡      å†™å…¥æŒ‡æ ‡      ç»¼åˆæŒ‡æ ‡    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ è¯»å–æ¬¡æ•°â”‚ â”‚ å†™å…¥æ¬¡æ•°â”‚ â”‚ IOPS    â”‚   â”‚
â”‚  â”‚ è¯»å–å­—èŠ‚â”‚ â”‚ å†™å…¥å­—èŠ‚â”‚ â”‚ å»¶è¿Ÿ    â”‚   â”‚
â”‚  â”‚ è¯»å–æ—¶é—´â”‚ â”‚ å†™å…¥æ—¶é—´â”‚ â”‚ é˜Ÿåˆ—é•¿åº¦â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 I/Oç»Ÿè®¡æ•°æ®æ”¶é›†


**ğŸ“Š I/Oç›‘æ§å®ç°**
```java
public class IoMonitor {
    
    public IoStatistics collectIoStats() {
        String sql = """
            SELECT VARIABLE_NAME, CAST(VARIABLE_VALUE AS UNSIGNED) as VALUE
            FROM performance_schema.global_status 
            WHERE VARIABLE_NAME IN (
                'Innodb_data_reads', 'Innodb_data_writes',
                'Innodb_data_read', 'Innodb_data_written'
            )
            """;
        
        Map<String, Long> metrics = jdbcTemplate.queryForList(sql).stream()
            .collect(Collectors.toMap(
                row -> (String) row.get("VARIABLE_NAME"),
                row -> (Long) row.get("VALUE")
            ));
        
        IoStatistics stats = new IoStatistics();
        stats.setDataReads(metrics.get("Innodb_data_reads"));
        stats.setDataWrites(metrics.get("Innodb_data_writes"));
        stats.setDataReadBytes(metrics.get("Innodb_data_read"));
        stats.setDataWrittenBytes(metrics.get("Innodb_data_written"));
        
        return stats;
    }
    
    public IoPerformance calculateIoPerformance(IoStatistics current, IoStatistics previous) {
        if (previous == null) return null;
        
        // è®¡ç®—æ—¶é—´é—´éš”
        long timeDiffMs = Duration.between(previous.getTimestamp(), 
                                         current.getTimestamp()).toMillis();
        double timeDiffSec = timeDiffMs / 1000.0;
        
        // è®¡ç®—IOPSå’Œååé‡
        long readsDiff = current.getDataReads() - previous.getDataReads();
        long writesDiff = current.getDataWrites() - previous.getDataWrites();
        
        IoPerformance perf = new IoPerformance();
        perf.setReadIops(readsDiff / timeDiffSec);
        perf.setWriteIops(writesDiff / timeDiffSec);
        perf.setTotalIops(perf.getReadIops() + perf.getWriteIops());
        
        return perf;
    }
}
```

### 7.3 I/Oæ€§èƒ½åˆ†æ


**ğŸ” I/Oç“¶é¢ˆè¯†åˆ«**
```java
public class IoBottleneckAnalyzer {
    
    public void analyzeIoBottleneck(IoPerformance metrics) {
        double totalIops = metrics.getTotalIops();
        
        // ä¸åŒå­˜å‚¨ä»‹è´¨çš„IOPSåŸºå‡†
        if (totalIops > 1600) {  // NVMe SSDæé™
            alertService.sendCritical("I/Oæ¥è¿‘NVMe SSDæé™: " + totalIops + " IOPS");
        } else if (totalIops > 400) {  // SATA SSDæé™
            alertService.sendWarning("I/Oæ¥è¿‘SATA SSDæé™: " + totalIops + " IOPS");
        } else if (totalIops > 160) {  // HDDæé™
            alertService.sendWarning("I/Oæ¥è¿‘HDDæé™: " + totalIops + " IOPS");
        }
        
        // åˆ†æè¯»å†™æ¯”ä¾‹
        double readRatio = metrics.getReadIops() / totalIops * 100;
        log.info("I/Oæ¨¡å¼ - è¯»å–: {}%, å†™å…¥: {}%", readRatio, 100 - readRatio);
    }
}
```

---

## 8. ğŸ¤– ç›‘æ§è‡ªåŠ¨åŒ–å·¥å…·


### 8.1 ç›‘æ§å·¥å…·é€‰æ‹©


**ğŸ”¸ ä¸»æµç›‘æ§å·¥å…·å¯¹æ¯”**

| å·¥å…·åç§° | **ç±»å‹** | **ä¼˜åŠ¿** | **åŠ£åŠ¿** | **é€‚ç”¨åœºæ™¯** |
|----------|---------|---------|---------|-------------|
| **Prometheus + Grafana** | `å¼€æº` | åŠŸèƒ½å¼ºå¤§ã€å¯å®šåˆ¶æ€§é«˜ | é…ç½®å¤æ‚ | æŠ€æœ¯å›¢é˜Ÿè¾ƒå¼º |
| **Zabbix** | `å¼€æº` | ç›‘æ§å…¨é¢ã€å‘Šè­¦ä¸°å¯Œ | ç•Œé¢è¾ƒè€ | ä¼ ç»Ÿä¼ä¸š |
| **MySQL Enterprise Monitor** | `å•†ä¸š` | ä¸“ä¸šã€é›†æˆåº¦é«˜ | è´¹ç”¨é«˜ | å¤§å‹ä¼ä¸š |
| **Percona Monitoring** | `å¼€æº` | MySQLä¸“ä¸šåŒ– | åŠŸèƒ½ç›¸å¯¹ç®€å• | MySQLä¸“é¡¹ç›‘æ§ |
| **è‡ªç ”ç›‘æ§ç³»ç»Ÿ** | `å®šåˆ¶` | å®Œå…¨è´´åˆä¸šåŠ¡éœ€æ±‚ | å¼€å‘æˆæœ¬é«˜ | ç‰¹æ®Šéœ€æ±‚åœºæ™¯ |

### 8.2 Prometheusç›‘æ§é…ç½®


**ğŸ”§ MySQL Exporteré…ç½®**
```yaml
# prometheus.ymlé…ç½®
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'mysql'
    static_configs:
      - targets: ['localhost:9104']
    scrape_interval: 5s
    
rule_files:
  - "mysql_rules.yml"

alerting:
  alertmanagers:
    - static_configs:
        - targets: ['alertmanager:9093']
```

**ğŸ“Š MySQL Exporterå¯åŠ¨**
```bash
# å¯åŠ¨MySQL Exporter
./mysqld_exporter \
  --config.my-cnf="/etc/mysql_exporter.cnf" \
  --collect.info_schema.innodb_metrics \
  --web.listen-address=0.0.0.0:9104

# è¿æ¥é…ç½® /etc/mysql_exporter.cnf
[client]
user=monitor_user
password=monitor_pass
host=localhost
port=3306
```

### 8.3 è‡ªå®šä¹‰ç›‘æ§è„šæœ¬


**ğŸ è‡ªåŠ¨åŒ–ç›‘æ§è„šæœ¬**
```python
import time
import pymysql
from datetime import datetime

class AutoMysqlMonitor:
    def __init__(self, host, user, password, database):
        self.conn = pymysql.connect(
            host=host, user=user, password=password, database=database
        )
        self.previous_metrics = None
    
    def collect_metrics(self):
        """æ”¶é›†æ ¸å¿ƒæŒ‡æ ‡"""
        cursor = self.conn.cursor()
        
        # è·å–å…³é”®æ€§èƒ½æŒ‡æ ‡
        sql = """
        SELECT VARIABLE_NAME, VARIABLE_VALUE
        FROM performance_schema.global_status 
        WHERE VARIABLE_NAME IN (
            'Innodb_buffer_pool_read_requests',
            'Innodb_buffer_pool_reads',
            'Innodb_data_reads',
            'Innodb_data_writes',
            'Connections',
            'Threads_connected'
        )
        """
        
        cursor.execute(sql)
        metrics = {row[0]: int(row[1]) for row in cursor.fetchall()}
        metrics['timestamp'] = datetime.now()
        
        cursor.close()
        return metrics
    
    def analyze_and_alert(self, metrics):
        """åˆ†ææŒ‡æ ‡å¹¶å‘Šè­¦"""
        # è®¡ç®—ç¼“å†²æ± å‘½ä¸­ç‡
        requests = metrics.get('Innodb_buffer_pool_read_requests', 0)
        reads = metrics.get('Innodb_buffer_pool_reads', 0)
        
        if requests > 0:
            hit_rate = (1 - reads / requests) * 100
            if hit_rate < 95:
                self.send_alert(f"ç¼“å†²æ± å‘½ä¸­ç‡åä½: {hit_rate:.2f}%")
        
        # æ£€æŸ¥è¿æ¥æ•°
        connections = metrics.get('Threads_connected', 0)
        if connections > 200:  # æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´
            self.send_alert(f"è¿æ¥æ•°è¿‡é«˜: {connections}")
    
    def send_alert(self, message):
        """å‘é€å‘Šè­¦"""
        print(f"[ALERT] {datetime.now()}: {message}")
        # è¿™é‡Œå¯ä»¥é›†æˆé‚®ä»¶ã€çŸ­ä¿¡ç­‰å‘Šè­¦æ–¹å¼
    
    def run_monitoring(self):
        """è¿è¡Œç›‘æ§å¾ªç¯"""
        while True:
            try:
                metrics = self.collect_metrics()
                self.analyze_and_alert(metrics)
                time.sleep(60)  # æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
            except Exception as e:
                print(f"ç›‘æ§å¼‚å¸¸: {e}")
                time.sleep(10)
```

---

## 9. ğŸ—ï¸ ç›‘æ§ä½“ç³»å»ºè®¾


### 9.1 ç›‘æ§ä½“ç³»æ¶æ„è®¾è®¡


**ğŸ”¸ å®Œæ•´ç›‘æ§ä½“ç³»çš„ç»„æˆ**
```
ç›‘æ§ä½“ç³» = æ•°æ®é‡‡é›† + æ•°æ®å­˜å‚¨ + æ•°æ®åˆ†æ + å¯è§†åŒ–å±•ç¤º + å‘Šè­¦å¤„ç†

å®Œæ•´ç›‘æ§ä½“ç³»æ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç›‘æ§ä½“ç³»æ¶æ„                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ æ•°æ®æºå±‚              é‡‡é›†å±‚              å¤„ç†å±‚        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚ â”‚ MySQL   â”‚â”€â”€â”€â”€â”€â”€â”€â†’â”‚ Agent   â”‚â”€â”€â”€â”€â”€â”€â”€â†’â”‚ æ•°æ®å¤„ç† â”‚      â”‚
â”‚ â”‚ æ•°æ®åº“  â”‚        â”‚ é‡‡é›†å™¨  â”‚        â”‚ å¼•æ“    â”‚      â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                           â”‚             â”‚
â”‚                                           â–¼             â”‚
â”‚ å±•ç¤ºå±‚              å­˜å‚¨å±‚              åˆ†æå±‚           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚ â”‚ å›¾è¡¨    â”‚â†â”€â”€â”€â”€â”€â”€â”€â”‚ æ—¶åº    â”‚â†â”€â”€â”€â”€â”€â”€â”€â”‚ è§„åˆ™    â”‚      â”‚
â”‚ â”‚ å¤§å±    â”‚        â”‚ æ•°æ®åº“  â”‚        â”‚ å¼•æ“    â”‚      â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚      â†‘                                     â”‚             â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€å‘Šè­¦é€šçŸ¥â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 ç›‘æ§æŒ‡æ ‡ä½“ç³»è§„åˆ’


**ğŸ“Š åˆ†å±‚ç›‘æ§æŒ‡æ ‡è®¾è®¡**
```
ğŸ”´ L1 - ä¸šåŠ¡å±‚æŒ‡æ ‡ï¼š
â€¢ ç”¨æˆ·è¯·æ±‚å“åº”æ—¶é—´
â€¢ ä¸šåŠ¡æ“ä½œæˆåŠŸç‡
â€¢ æ ¸å¿ƒä¸šåŠ¡æµç¨‹å¯ç”¨æ€§

ğŸŸ¡ L2 - åº”ç”¨å±‚æŒ‡æ ‡ï¼š
â€¢ æ•°æ®åº“è¿æ¥æ± çŠ¶æ€
â€¢ SQLæ‰§è¡Œæ—¶é—´åˆ†å¸ƒ
â€¢ æ…¢æŸ¥è¯¢ç»Ÿè®¡

ğŸŸ¢ L3 - æ•°æ®åº“å±‚æŒ‡æ ‡ï¼š
â€¢ å­˜å‚¨å¼•æ“æ€§èƒ½æŒ‡æ ‡
â€¢ é”ç­‰å¾…å’Œæ­»é”ç»Ÿè®¡
â€¢ ç¼“å­˜å‘½ä¸­ç‡

ğŸ”µ L4 - ç³»ç»Ÿå±‚æŒ‡æ ‡ï¼š
â€¢ CPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨ç‡
â€¢ ç½‘ç»œI/Oç»Ÿè®¡
â€¢ æ“ä½œç³»ç»Ÿè´Ÿè½½
```

**ğŸ¯ ç›‘æ§æŒ‡æ ‡ä¼˜å…ˆçº§**

| ä¼˜å…ˆçº§ | **æŒ‡æ ‡ç±»å‹** | **ç›‘æ§é¢‘ç‡** | **å‘Šè­¦çº§åˆ«** | **å¤„ç†æ—¶æ•ˆ** |
|-------|-------------|-------------|-------------|-------------|
| **P0å…³é”®** | `æœåŠ¡å¯ç”¨æ€§` | 30ç§’ | ç«‹å³å‘Šè­¦ | 5åˆ†é’Ÿå†…å“åº” |
| **P1é‡è¦** | `æ€§èƒ½æŒ‡æ ‡` | 1åˆ†é’Ÿ | 5åˆ†é’Ÿå†…å‘Šè­¦ | 30åˆ†é’Ÿå†…å¤„ç† |
| **P2ä¸€èˆ¬** | `èµ„æºä½¿ç”¨` | 5åˆ†é’Ÿ | 15åˆ†é’Ÿå†…å‘Šè­¦ | 2å°æ—¶å†…å¤„ç† |
| **P3å‚è€ƒ** | `è¶‹åŠ¿æ•°æ®` | 15åˆ†é’Ÿ | æ¯æ—¥æ±‡æ€» | è®¡åˆ’å¤„ç† |

### 9.3 ç›‘æ§æ•°æ®å­˜å‚¨è®¾è®¡


**ğŸ’¾ æ—¶åºæ•°æ®å­˜å‚¨æ–¹æ¡ˆ**
```java
public class MetricsStorageService {
    
    // å®šä¹‰ä¸åŒä¿ç•™æœŸçš„å­˜å‚¨ç­–ç•¥
    public enum RetentionPolicy {
        REALTIME(Duration.ofHours(2), Duration.ofSeconds(15)),      // 2å°æ—¶ï¼Œ15ç§’é‡‡æ ·
        RECENT(Duration.ofDays(7), Duration.ofMinutes(1)),         // 7å¤©ï¼Œ1åˆ†é’Ÿé‡‡æ ·  
        DAILY(Duration.ofDays(30), Duration.ofMinutes(15)),        // 30å¤©ï¼Œ15åˆ†é’Ÿé‡‡æ ·
        MONTHLY(Duration.ofDays(365), Duration.ofHours(1));        // 1å¹´ï¼Œ1å°æ—¶é‡‡æ ·
        
        private final Duration retention;
        private final Duration interval;
        
        RetentionPolicy(Duration retention, Duration interval) {
            this.retention = retention;
            this.interval = interval;
        }
    }
    
    public void storeMetrics(String metricName, double value, LocalDateTime timestamp) {
        // æ ¹æ®ä¸åŒä¿ç•™ç­–ç•¥å­˜å‚¨æ•°æ®
        for (RetentionPolicy policy : RetentionPolicy.values()) {
            if (shouldStore(timestamp, policy)) {
                storeWithPolicy(metricName, value, timestamp, policy);
            }
        }
    }
    
    private void storeWithPolicy(String metricName, double value, 
                                LocalDateTime timestamp, RetentionPolicy policy) {
        String tableName = "metrics_" + policy.name().toLowerCase();
        
        String sql = """
            INSERT INTO %s (metric_name, metric_value, recorded_at)
            VALUES (?, ?, ?)
            ON DUPLICATE KEY UPDATE
            metric_value = VALUES(metric_value)
            """.formatted(tableName);
        
        jdbcTemplate.update(sql, metricName, value, timestamp);
    }
}
```

---

## 10. ğŸ“‹ å…³é”®ç›‘æ§æŒ‡æ ‡è¯¦è§£


### 10.1 InnoDBæ ¸å¿ƒç›‘æ§æŒ‡æ ‡


**ğŸ”¸ å¿…é¡»ç›‘æ§çš„InnoDBæŒ‡æ ‡**

| æŒ‡æ ‡åˆ†ç±» | **æŒ‡æ ‡åç§°** | **å«ä¹‰è§£é‡Š** | **æ­£å¸¸èŒƒå›´** | **å¼‚å¸¸é˜ˆå€¼** |
|----------|-------------|-------------|-------------|-------------|
| **ç¼“å†²æ± ** | `Innodb_buffer_pool_read_requests` | ç¼“å†²æ± è¯»å–è¯·æ±‚æ€»æ•° | æŒç»­å¢é•¿ | å¢é•¿åœæ» |
| **ç¼“å†²æ± ** | `Innodb_buffer_pool_reads` | ç‰©ç†ç£ç›˜è¯»å–æ¬¡æ•° | å°½å¯èƒ½å°‘ | å æ¯”>5% |
| **è¡Œæ“ä½œ** | `Innodb_rows_read` | è¯»å–çš„è¡Œæ•° | æ ¹æ®ä¸šåŠ¡ | å¼‚å¸¸å¢é•¿ |
| **è¡Œæ“ä½œ** | `Innodb_rows_inserted` | æ’å…¥çš„è¡Œæ•° | æ ¹æ®ä¸šåŠ¡ | å¼‚å¸¸å¢é•¿ |
| **é”ç­‰å¾…** | `Innodb_lock_waits` | é”ç­‰å¾…æ¬¡æ•° | æ¥è¿‘0 | >10/ç§’ |
| **æ­»é”** | `Innodb_deadlocks` | æ­»é”æ¬¡æ•° | æ¥è¿‘0 | >1/å°æ—¶ |

**ğŸ“Š æŒ‡æ ‡è®¡ç®—å…¬å¼**
```
æ ¸å¿ƒæ´¾ç”ŸæŒ‡æ ‡è®¡ç®—ï¼š

ç¼“å†²æ± å‘½ä¸­ç‡ = (1 - Innodb_buffer_pool_reads / Innodb_buffer_pool_read_requests) Ã— 100%

ç¼“å†²æ± ä½¿ç”¨ç‡ = Innodb_buffer_pool_pages_data / Innodb_buffer_pool_pages_total Ã— 100%

å¹³å‡è¡Œè¯»å–å¤§å° = Innodb_data_read / Innodb_data_reads

è¯»å†™æ¯”ä¾‹ = Innodb_data_reads : Innodb_data_writes

äº‹åŠ¡æäº¤ç‡ = Com_commit / (Com_commit + Com_rollback) Ã— 100%
```

### 10.2 MyISAMæ ¸å¿ƒç›‘æ§æŒ‡æ ‡


**ğŸ”¸ MyISAMå…³é”®æŒ‡æ ‡**

| æŒ‡æ ‡åç§° | **å«ä¹‰** | **ç›‘æ§é‡ç‚¹** | **ä¼˜åŒ–æ–¹å‘** |
|----------|---------|-------------|-------------|
| `Key_reads` | é”®ç¼“å­˜ç‰©ç†è¯»å– | ç¼“å­˜æ•ˆç‡ | å¢åŠ key_buffer_size |
| `Key_read_requests` | é”®ç¼“å­˜è¯»å–è¯·æ±‚ | æ€»ä½“è®¿é—®é‡ | ç´¢å¼•ä¼˜åŒ– |
| `Table_locks_waited` | è¡¨é”ç­‰å¾…æ¬¡æ•° | å¹¶å‘å†²çª | ä¼˜åŒ–æŸ¥è¯¢ã€è€ƒè™‘InnoDB |
| `Select_scan` | å…¨è¡¨æ‰«ææ¬¡æ•° | ç´¢å¼•æ•ˆç‡ | æ·»åŠ åˆé€‚ç´¢å¼• |

**ğŸ”§ MyISAMç›‘æ§å®ç°**
```java
public class MyISAMMonitor {
    
    public MyISAMStats getMyISAMStats() {
        String sql = """
            SELECT VARIABLE_NAME, VARIABLE_VALUE
            FROM performance_schema.global_status 
            WHERE VARIABLE_NAME IN (
                'Key_reads', 'Key_read_requests',
                'Table_locks_waited', 'Select_scan'
            )
            """;
        
        Map<String, Long> metrics = jdbcTemplate.queryForList(sql).stream()
            .collect(Collectors.toMap(
                row -> (String) row.get("VARIABLE_NAME"),
                row -> Long.parseLong((String) row.get("VARIABLE_VALUE"))
            ));
        
        MyISAMStats stats = new MyISAMStats();
        
        // è®¡ç®—é”®ç¼“å­˜å‘½ä¸­ç‡
        long requests = metrics.get("Key_read_requests");
        long reads = metrics.get("Key_reads");
        if (requests > 0) {
            stats.setKeyBufferHitRate((1.0 - (double) reads / requests) * 100);
        }
        
        stats.setTableLocksWaited(metrics.get("Table_locks_waited"));
        stats.setFullScans(metrics.get("Select_scan"));
        
        return stats;
    }
    
    public void checkMyISAMHealth(MyISAMStats stats) {
        // æ£€æŸ¥é”®ç¼“å­˜å‘½ä¸­ç‡
        if (stats.getKeyBufferHitRate() < 95) {
            alertService.sendWarning(
                "MyISAMé”®ç¼“å­˜å‘½ä¸­ç‡åä½: " + stats.getKeyBufferHitRate() + "%");
        }
        
        // æ£€æŸ¥è¡¨é”ç­‰å¾…
        if (stats.getTableLocksWaited() > 100) {
            alertService.sendWarning("MyISAMè¡¨é”ç­‰å¾…è¿‡å¤šï¼Œè€ƒè™‘ä¼˜åŒ–æŸ¥è¯¢æˆ–ä½¿ç”¨InnoDB");
        }
    }
}
```

### 10.3 Memoryå¼•æ“ç›‘æ§


**âš¡ Memoryå¼•æ“ç‰¹æ®Šç›‘æ§ç‚¹**
```
Memoryå¼•æ“ç‰¹ç‚¹ï¼š
â€¢ æ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­
â€¢ é‡å¯åæ•°æ®ä¸¢å¤±
â€¢ ä¸æ”¯æŒäº‹åŠ¡
â€¢ é€‚åˆä¸´æ—¶æ•°æ®ã€ç¼“å­˜è¡¨

ç›‘æ§é‡ç‚¹ï¼š
â€¢ å†…å­˜ä½¿ç”¨é‡ï¼šé˜²æ­¢å†…å­˜æº¢å‡º
â€¢ è¡¨å¤§å°ï¼šæ§åˆ¶å•è¡¨æ•°æ®é‡
â€¢ æŸ¥è¯¢æ€§èƒ½ï¼šå……åˆ†åˆ©ç”¨å†…å­˜ä¼˜åŠ¿
```

**ğŸ”§ Memoryå¼•æ“ç›‘æ§**
```sql
-- æŸ¥çœ‹Memoryå¼•æ“è¡¨çš„å†…å­˜ä½¿ç”¨
SELECT 
    TABLE_NAME,
    ROUND(DATA_LENGTH/1024/1024, 2) as DATA_SIZE_MB,
    ROUND(INDEX_LENGTH/1024/1024, 2) as INDEX_SIZE_MB,
    TABLE_ROWS
FROM information_schema.TABLES 
WHERE ENGINE = 'MEMORY' 
  AND TABLE_SCHEMA = 'your_database'
ORDER BY DATA_LENGTH DESC;

-- ç›‘æ§Memoryå¼•æ“çš„å…³é”®æŒ‡æ ‡
SELECT 
    VARIABLE_NAME, 
    VARIABLE_VALUE
FROM performance_schema.global_status 
WHERE VARIABLE_NAME LIKE '%memory%' 
   OR VARIABLE_NAME LIKE '%heap%';
```

---

## 11. ğŸš¨ å‘Šè­¦ç­–ç•¥è®¾è®¡


### 11.1 å‘Šè­¦çº§åˆ«å®šä¹‰


**ğŸ”¸ å‘Šè­¦çº§åˆ«ä½“ç³»**
```
å‘Šè­¦çº§åˆ«è®¾è®¡åŸåˆ™ï¼š
æ ¹æ®é—®é¢˜çš„ç´§æ€¥ç¨‹åº¦å’Œå½±å“èŒƒå›´æ¥åˆ’åˆ†çº§åˆ«

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å‘Šè­¦çº§åˆ«ä½“ç³»               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚ ğŸ”´ P0 - ä¸¥é‡ (Critical)                 â”‚
â”‚ â€¢ æœåŠ¡ä¸å¯ç”¨                            â”‚
â”‚ â€¢ æ•°æ®ä¸¢å¤±é£é™©                          â”‚
â”‚ â€¢ ç«‹å³å¤„ç†ï¼š5åˆ†é’Ÿå†…å“åº”                  â”‚
â”‚                                         â”‚
â”‚ ğŸŸ¡ P1 - é‡è¦ (Major)                    â”‚
â”‚ â€¢ æ€§èƒ½ä¸¥é‡ä¸‹é™                          â”‚
â”‚ â€¢ éƒ¨åˆ†åŠŸèƒ½å¼‚å¸¸                          â”‚
â”‚ â€¢ ç´§æ€¥å¤„ç†ï¼š30åˆ†é’Ÿå†…å“åº”                 â”‚
â”‚                                         â”‚
â”‚ ğŸŸ  P2 - ä¸€èˆ¬ (Minor)                    â”‚
â”‚ â€¢ æ€§èƒ½è½»å¾®ä¸‹é™                          â”‚
â”‚ â€¢ èµ„æºä½¿ç”¨åé«˜                          â”‚
â”‚ â€¢ å¸¸è§„å¤„ç†ï¼š2å°æ—¶å†…å“åº”                  â”‚
â”‚                                         â”‚
â”‚ ğŸŸ¢ P3 - ä¿¡æ¯ (Info)                     â”‚
â”‚ â€¢ è¶‹åŠ¿æé†’                              â”‚
â”‚ â€¢ å®¹é‡é¢„è­¦                              â”‚
â”‚ â€¢ è®¡åˆ’å¤„ç†ï¼šå·¥ä½œæ—¥å¤„ç†                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 11.2 é˜ˆå€¼è®¾å®šç­–ç•¥


**ğŸ“Š åŠ¨æ€é˜ˆå€¼vsé™æ€é˜ˆå€¼**

| é˜ˆå€¼ç±»å‹ | **è®¾å®šæ–¹å¼** | **ä¼˜åŠ¿** | **åŠ£åŠ¿** | **é€‚ç”¨åœºæ™¯** |
|----------|-------------|---------|---------|-------------|
| **é™æ€é˜ˆå€¼** | `å›ºå®šæ•°å€¼` | ç®€å•æ˜ç¡® | å¯èƒ½è¯¯æŠ¥ | ç¨³å®šä¸šåŠ¡åœºæ™¯ |
| **åŠ¨æ€é˜ˆå€¼** | `åŸºäºå†å²æ•°æ®` | å‡†ç¡®æ€§é«˜ | å¤æ‚åº¦é«˜ | æ³¢åŠ¨ä¸šåŠ¡åœºæ™¯ |
| **ç™¾åˆ†æ¯”é˜ˆå€¼** | `ç›¸å¯¹å˜åŒ–ç‡` | é€‚åº”æ€§å¼º | åŸºå‡†ä¾èµ– | å¢é•¿å‹ä¸šåŠ¡ |
| **å¤åˆé˜ˆå€¼** | `å¤šæ¡ä»¶ç»„åˆ` | ç²¾ç¡®åˆ¤æ–­ | ç»´æŠ¤å¤æ‚ | å…³é”®ä¸šåŠ¡ |

**ğŸ”§ å‘Šè­¦è§„åˆ™é…ç½®**
```yaml
# Prometheuså‘Šè­¦è§„åˆ™ç¤ºä¾‹
groups:
- name: mysql_alerts
  rules:
  # P0çº§åˆ«å‘Šè­¦
  - alert: MySQLæœåŠ¡ä¸å¯ç”¨
    expr: mysql_up == 0
    for: 1m
    labels:
      severity: critical
      priority: P0
    annotations:
      summary: "MySQLæœåŠ¡å®•æœº"
      description: "MySQLå®ä¾‹{{ $labels.instance }}æ— æ³•è¿æ¥"
  
  # P1çº§åˆ«å‘Šè­¦  
  - alert: ç¼“å†²æ± å‘½ä¸­ç‡è¿‡ä½
    expr: mysql_buffer_pool_hit_rate < 95
    for: 5m
    labels:
      severity: major
      priority: P1
    annotations:
      summary: "ç¼“å†²æ± å‘½ä¸­ç‡è¿‡ä½"
      description: "å®ä¾‹{{ $labels.instance }}ç¼“å†²æ± å‘½ä¸­ç‡{{ $value }}%"
  
  # P2çº§åˆ«å‘Šè­¦
  - alert: ç£ç›˜ä½¿ç”¨ç‡åé«˜
    expr: disk_usage_percent > 80
    for: 10m
    labels:
      severity: minor
      priority: P2
    annotations:
      summary: "ç£ç›˜ç©ºé—´ç´§å¼ "
      description: "ç£ç›˜ä½¿ç”¨ç‡{{ $value }}%ï¼Œå»ºè®®æ¸…ç†"
```

### 11.3 å‘Šè­¦å¤„ç†æµç¨‹


**ğŸ”„ å‘Šè­¦å¤„ç†æµç¨‹è®¾è®¡**
```java
public class AlertProcessor {
    
    public void processAlert(Alert alert) {
        // 1. å‘Šè­¦å»é‡
        if (isDuplicateAlert(alert)) {
            log.debug("é‡å¤å‘Šè­¦ï¼Œå·²å¿½ç•¥: {}", alert.getMessage());
            return;
        }
        
        // 2. å‘Šè­¦å‡çº§åˆ¤æ–­
        AlertLevel escalatedLevel = checkEscalation(alert);
        if (escalatedLevel != alert.getLevel()) {
            alert.setLevel(escalatedLevel);
            log.warn("å‘Šè­¦å‡çº§: {} -> {}", alert.getLevel(), escalatedLevel);
        }
        
        // 3. æ ¹æ®çº§åˆ«åˆ†å‘å‘Šè­¦
        dispatchAlert(alert);
        
        // 4. è®°å½•å‘Šè­¦å†å²
        recordAlertHistory(alert);
    }
    
    private void dispatchAlert(Alert alert) {
        switch (alert.getLevel()) {
            case P0:
                phoneService.call(alert);      // ç”µè¯å‘Šè­¦
                smsService.send(alert);        // çŸ­ä¿¡å‘Šè­¦  
                emailService.send(alert);      // é‚®ä»¶å‘Šè­¦
                dingTalkService.send(alert);   // é’‰é’‰å‘Šè­¦
                break;
                
            case P1:
                smsService.send(alert);
                emailService.send(alert);
                dingTalkService.send(alert);
                break;
                
            case P2:
                emailService.send(alert);
                dingTalkService.send(alert);
                break;
                
            case P3:
                emailService.send(alert);
                break;
        }
    }
}
```

### 11.4 å‘Šè­¦æ”¶æ•›ç­–ç•¥


**ğŸ¯ å‡å°‘å‘Šè­¦å™ªéŸ³**
```
å‘Šè­¦æ”¶æ•›çš„å¿…è¦æ€§ï¼š
â€¢ é¿å…å‘Šè­¦é£æš´ï¼šçŸ­æ—¶é—´å†…å¤§é‡é‡å¤å‘Šè­¦
â€¢ å‡å°‘è¯¯æŠ¥ï¼šé˜²æ­¢æ­£å¸¸æ³¢åŠ¨è§¦å‘å‘Šè­¦
â€¢ æé«˜æ•ˆç‡ï¼šè®©è¿ç»´äººå‘˜å…³æ³¨çœŸæ­£çš„é—®é¢˜

æ”¶æ•›ç­–ç•¥ï¼š
â€¢ æ—¶é—´æ”¶æ•›ï¼šç›¸åŒå‘Šè­¦åœ¨æ—¶é—´çª—å£å†…åªå‘é€ä¸€æ¬¡
â€¢ æ¡ä»¶æ”¶æ•›ï¼šå¤šä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³æ‰å‘Šè­¦
â€¢ å‡çº§æ”¶æ•›ï¼šé—®é¢˜æŒç»­æ—¶é—´è¶Šé•¿ï¼Œå‘Šè­¦çº§åˆ«è¶Šé«˜
â€¢ ä¾èµ–æ”¶æ•›ï¼šä¸‹æ¸¸é—®é¢˜å¯èƒ½ç”±ä¸Šæ¸¸å¼•èµ·
```

**ğŸ”§ å‘Šè­¦æ”¶æ•›å®ç°**
```java
public class AlertSuppression {
    
    // å‘Šè­¦æŠ‘åˆ¶è§„åˆ™
    public boolean shouldSuppressAlert(Alert alert) {
        String alertKey = buildAlertKey(alert);
        
        // æ£€æŸ¥æ—¶é—´çª—å£å†…æ˜¯å¦å·²å‘é€è¿‡ç›¸åŒå‘Šè­¦
        LocalDateTime lastSentTime = getLastAlertTime(alertKey);
        if (lastSentTime != null) {
            Duration suppressWindow = getSuppressWindow(alert.getLevel());
            if (Duration.between(lastSentTime, LocalDateTime.now()).compareTo(suppressWindow) < 0) {
                return true; // æŠ‘åˆ¶é‡å¤å‘Šè­¦
            }
        }
        
        // æ£€æŸ¥ä¾èµ–å…³ç³»
        if (hasUpstreamAlert(alert)) {
            log.info("æ£€æµ‹åˆ°ä¸Šæ¸¸å‘Šè­¦ï¼ŒæŠ‘åˆ¶ä¸‹æ¸¸å‘Šè­¦: {}", alert.getMessage());
            return true;
        }
        
        return false;
    }
    
    private Duration getSuppressWindow(AlertLevel level) {
        return switch (level) {
            case P0 -> Duration.ofMinutes(5);   // P0å‘Šè­¦5åˆ†é’Ÿæ”¶æ•›
            case P1 -> Duration.ofMinutes(15);  // P1å‘Šè­¦15åˆ†é’Ÿæ”¶æ•›
            case P2 -> Duration.ofHours(1);     // P2å‘Šè­¦1å°æ—¶æ”¶æ•›
            case P3 -> Duration.ofHours(4);     // P3å‘Šè­¦4å°æ—¶æ”¶æ•›
        };
    }
}
```

---

## 12. ğŸŒ å¤šå¼•æ“ç»Ÿä¸€ç›‘æ§å¹³å°


### 12.1 ç»Ÿä¸€ç›‘æ§å¹³å°æ¶æ„


**ğŸ”¸ å¤šå¼•æ“ç›‘æ§çš„æŒ‘æˆ˜**
```
æŒ‘æˆ˜ï¼š
â€¢ ä¸åŒå­˜å‚¨å¼•æ“æŒ‡æ ‡ä¸ç»Ÿä¸€
â€¢ ç›‘æ§æ–¹å¼å„ä¸ç›¸åŒ
â€¢ å‘Šè­¦è§„åˆ™éœ€è¦å·®å¼‚åŒ–
â€¢ è¿ç»´å¤æ‚åº¦é«˜

è§£å†³æ€è·¯ï¼š
â€¢ æŠ½è±¡ç»Ÿä¸€çš„ç›‘æ§æ¥å£
â€¢ æ ‡å‡†åŒ–æŒ‡æ ‡æ ¼å¼
â€¢ ç»Ÿä¸€çš„å‘Šè­¦å¤„ç†
â€¢ ä¸€ä½“åŒ–ç®¡ç†å¹³å°
```

**ğŸ—ï¸ ç»Ÿä¸€ç›‘æ§å¹³å°æ¶æ„**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç»Ÿä¸€ç›‘æ§å¹³å°                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚           ç»Ÿä¸€ç›‘æ§APIå±‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ æ ‡å‡†ç›‘æ§æ¥å£ â”‚ æŒ‡æ ‡æ ‡å‡†åŒ– â”‚ å‘Šè­¦è§„åˆ™å¼•æ“     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                               â”‚
â”‚           é€‚é…å™¨å±‚       â”‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ InnoDB     â”‚ MyISAM â”‚        â”‚ Memory      â”‚       â”‚
â”‚  â”‚ é€‚é…å™¨     â”‚ é€‚é…å™¨  â”‚        â”‚ é€‚é…å™¨      â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                         â”‚                               â”‚
â”‚           å­˜å‚¨å¼•æ“å±‚     â”‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚   InnoDB   â”‚ MyISAM â”‚        â”‚   Memory    â”‚       â”‚
â”‚  â”‚   å¼•æ“     â”‚  å¼•æ“   â”‚        â”‚   å¼•æ“      â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 12.2 ç»Ÿä¸€ç›‘æ§æ¥å£è®¾è®¡


**ğŸ”§ ç›‘æ§æ¥å£æŠ½è±¡**
```java
// å­˜å‚¨å¼•æ“ç›‘æ§ç»Ÿä¸€æ¥å£
public interface StorageEngineMonitor {
    
    /**
     * è·å–å¼•æ“åŸºæœ¬ä¿¡æ¯
     */
    EngineInfo getEngineInfo();
    
    /**
     * è·å–æ€§èƒ½æŒ‡æ ‡
     */
    PerformanceMetrics getPerformanceMetrics();
    
    /**
     * è·å–èµ„æºä½¿ç”¨æƒ…å†µ
     */
    ResourceUsage getResourceUsage();
    
    /**
     * æ£€æŸ¥å¥åº·çŠ¶æ€
     */
    List<HealthCheck> checkHealth();
    
    /**
     * è·å–å‘Šè­¦è§„åˆ™
     */
    List<AlertRule> getAlertRules();
}

// InnoDBç›‘æ§å®ç°
@Component
public class InnoDBMonitor implements StorageEngineMonitor {
    
    @Override
    public PerformanceMetrics getPerformanceMetrics() {
        Map<String, Long> rawMetrics = collectInnoDbMetrics();
        
        PerformanceMetrics metrics = new PerformanceMetrics();
        metrics.setEngineType("InnoDB");
        metrics.setBufferHitRate(calculateBufferPoolHitRate(rawMetrics));
        metrics.setRowsRead(rawMetrics.get("Innodb_rows_read"));
        metrics.setRowsInserted(rawMetrics.get("Innodb_rows_inserted"));
        metrics.setLockWaits(rawMetrics.get("Innodb_lock_waits"));
        
        return metrics;
    }
    
    @Override
    public List<HealthCheck> checkHealth() {
        List<HealthCheck> checks = new ArrayList<>();
        PerformanceMetrics metrics = getPerformanceMetrics();
        
        // ç¼“å†²æ± å¥åº·æ£€æŸ¥
        if (metrics.getBufferHitRate() < 95) {
            checks.add(HealthCheck.warning("ç¼“å†²æ± å‘½ä¸­ç‡åä½", 
                "å½“å‰: " + metrics.getBufferHitRate() + "%"));
        }
        
        // é”ç­‰å¾…æ£€æŸ¥
        if (metrics.getLockWaits() > 100) {
            checks.add(HealthCheck.error("é”ç­‰å¾…è¿‡å¤š", 
                "å½“å‰: " + metrics.getLockWaits()));
        }
        
        return checks;
    }
}

// MyISAMç›‘æ§å®ç°
@Component
public class MyISAMMonitor implements StorageEngineMonitor {
    
    @Override
    public PerformanceMetrics getPerformanceMetrics() {
        PerformanceMetrics metrics = new PerformanceMetrics();
        metrics.setEngineType("MyISAM");
        
        // è·å–MyISAMç‰¹æœ‰æŒ‡æ ‡
        Long keyReads = jdbcTemplate.queryForObject(
            "SELECT VARIABLE_VALUE FROM performance_schema.global_status " +
            "WHERE VARIABLE_NAME = 'Key_reads'", Long.class);
            
        Long keyRequests = jdbcTemplate.queryForObject(
            "SELECT VARIABLE_VALUE FROM performance_schema.global_status " +
            "WHERE VARIABLE_NAME = 'Key_read_requests'", Long.class);
        
        if (keyRequests > 0) {
            metrics.setBufferHitRate((1.0 - (double) keyReads / keyRequests) * 100);
        }
        
        return metrics;
    }
}
```

### 12.3 ç›‘æ§æ•°æ®æ ‡å‡†åŒ–


**ğŸ“Š æ ‡å‡†åŒ–æŒ‡æ ‡æ ¼å¼**
```java
// ç»Ÿä¸€çš„æ€§èƒ½æŒ‡æ ‡æ ¼å¼
@Data
public class StandardMetrics {
    private String engineType;           // å¼•æ“ç±»å‹
    private String instanceId;           // å®ä¾‹æ ‡è¯†
    private LocalDateTime timestamp;     // é‡‡é›†æ—¶é—´
    
    // æ ‡å‡†åŒ–æ€§èƒ½æŒ‡æ ‡
    private Double hitRate;              // ç¼“å­˜å‘½ä¸­ç‡ (%)
    private Long readOperations;         // è¯»æ“ä½œæ¬¡æ•°
    private Long writeOperations;        // å†™æ“ä½œæ¬¡æ•°
    private Double avgResponseTime;      // å¹³å‡å“åº”æ—¶é—´ (ms)
    private Long activeConnections;      // æ´»è·ƒè¿æ¥æ•°
    private Double cpuUsage;             // CPUä½¿ç”¨ç‡ (%)
    private Double memoryUsage;          // å†…å­˜ä½¿ç”¨ç‡ (%)
    private Double diskUsage;            // ç£ç›˜ä½¿ç”¨ç‡ (%)
    
    // å¼•æ“ç‰¹æœ‰æŒ‡æ ‡ï¼ˆä½¿ç”¨Mapå­˜å‚¨ï¼‰
    private Map<String, Object> engineSpecificMetrics;
}

// æŒ‡æ ‡è½¬æ¢å™¨
public class MetricsConverter {
    
    public StandardMetrics convertToStandard(PerformanceMetrics engineMetrics) {
        StandardMetrics standard = new StandardMetrics();
        standard.setEngineType(engineMetrics.getEngineType());
        standard.setTimestamp(LocalDateTime.now());
        
        // é€šç”¨æŒ‡æ ‡æ˜ å°„
        standard.setHitRate(engineMetrics.getBufferHitRate());
        standard.setReadOperations(engineMetrics.getRowsRead());
        standard.setWriteOperations(engineMetrics.getRowsInserted());
        
        // å¼•æ“ç‰¹æœ‰æŒ‡æ ‡
        Map<String, Object> specific = new HashMap<>();
        if ("InnoDB".equals(engineMetrics.getEngineType())) {
            specific.put("lock_waits", engineMetrics.getLockWaits());
            specific.put("deadlocks", engineMetrics.getDeadlocks());
        } else if ("MyISAM".equals(engineMetrics.getEngineType())) {
            specific.put("table_locks_waited", engineMetrics.getTableLocksWaited());
            specific.put("key_buffer_usage", engineMetrics.getKeyBufferUsage());
        }
        
        standard.setEngineSpecificMetrics(specific);
        return standard;
    }
}
```

---

## 13. ğŸ“Š ç›‘æ§æ•°æ®åˆ†æä¸è¶‹åŠ¿é¢„æµ‹


### 13.1 ç›‘æ§æ•°æ®åˆ†æåŸºç¡€


**ğŸ”¸ æ•°æ®åˆ†æçš„ä»·å€¼**
```
å†å²æ•°æ®åˆ†æçš„ä½œç”¨ï¼š
â€¢ å‘ç°æ€§èƒ½è¶‹åŠ¿ï¼šæ˜¯åœ¨æå‡è¿˜æ˜¯ä¸‹é™ï¼Ÿ
â€¢ è¯†åˆ«å‘¨æœŸæ€§è§„å¾‹ï¼šä¸šåŠ¡é«˜å³°æœŸã€ä½è°·æœŸ
â€¢ é¢„æµ‹å®¹é‡éœ€æ±‚ï¼šä½•æ—¶éœ€è¦æ‰©å®¹ï¼Ÿ
â€¢ ä¼˜åŒ–é…ç½®å‚æ•°ï¼šå“ªäº›å‚æ•°éœ€è¦è°ƒæ•´ï¼Ÿ

åˆ†æç»´åº¦ï¼š
â€¢ æ—¶é—´ç»´åº¦ï¼šå°æ—¶ã€å¤©ã€å‘¨ã€æœˆçš„å˜åŒ–è¶‹åŠ¿
â€¢ ä¸šåŠ¡ç»´åº¦ï¼šä¸åŒä¸šåŠ¡æ¨¡å—çš„æ€§èƒ½å¯¹æ¯”
â€¢ ç³»ç»Ÿç»´åº¦ï¼šCPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œçš„å…³è”åˆ†æ
```

### 13.2 è¶‹åŠ¿åˆ†æå®ç°


**ğŸ“ˆ è¶‹åŠ¿é¢„æµ‹ç®—æ³•**
```java
public class TrendPredictor {
    
    public TrendForecast predictTrend(List<MetricPoint> historicalData, int forecastDays) {
        if (historicalData.size() < 7) {
            return TrendForecast.insufficient();
        }
        
        // ç®€å•çº¿æ€§å›å½’é¢„æµ‹
        LinearRegression regression = fitLinearRegression(historicalData);
        
        TrendForecast forecast = new TrendForecast();
        forecast.setSlope(regression.getSlope());
        forecast.setTrendDirection(determineTrendDirection(regression.getSlope()));
        
        // é¢„æµ‹æœªæ¥å€¼
        List<Double> predictions = new ArrayList<>();
        for (int i = 1; i <= forecastDays; i++) {
            double predictedValue = regression.predict(historicalData.size() + i);
            predictions.add(predictedValue);
        }
        forecast.setPredictedValues(predictions);
        
        return forecast;
    }
    
    private LinearRegression fitLinearRegression(List<MetricPoint> data) {
        int n = data.size();
        double sumX = 0, sumY = 0, sumXY = 0, sumX2 = 0;
        
        for (int i = 0; i < n; i++) {
            double x = i;  // æ—¶é—´åºåˆ—
            double y = data.get(i).getValue();
            
            sumX += x;
            sumY += y;
            sumXY += x * y;
            sumX2 += x * x;
        }
        
        // è®¡ç®—å›å½’ç³»æ•°
        double slope = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);
        double intercept = (sumY - slope * sumX) / n;
        
        return new LinearRegression(slope, intercept);
    }
    
    private TrendDirection determineTrendDirection(double slope) {
        if (Math.abs(slope) < 0.01) return TrendDirection.STABLE;
        return slope > 0 ? TrendDirection.INCREASING : TrendDirection.DECREASING;
    }
}
```

### 13.3 å®¹é‡è§„åˆ’åˆ†æ


**ğŸ“Š å®¹é‡é¢„æµ‹æ¨¡å‹**
```java
public class CapacityPlanner {
    
    public CapacityForecast planCapacity(String metricName, Duration forecastPeriod) {
        // è·å–å†å²æ•°æ®ï¼ˆæœ€è¿‘30å¤©ï¼‰
        List<MetricPoint> historical = getHistoricalData(metricName, Duration.ofDays(30));
        
        // è¶‹åŠ¿åˆ†æ
        TrendForecast trend = trendPredictor.predictTrend(historical, 
            (int) forecastPeriod.toDays());
        
        CapacityForecast forecast = new CapacityForecast();
        forecast.setMetricName(metricName);
        forecast.setForecastPeriod(forecastPeriod);
        
        // è®¡ç®—å®¹é‡éœ€æ±‚
        if (TrendDirection.INCREASING.equals(trend.getTrendDirection())) {
            double currentMax = getCurrentMaxValue(historical);
            double predictedMax = Collections.max(trend.getPredictedValues());
            double growthRate = (predictedMax - currentMax) / currentMax * 100;
            
            forecast.setExpectedGrowth(growthRate);
            forecast.setRecommendedAction(getCapacityRecommendation(metricName, growthRate));
        } else {
            forecast.setExpectedGrowth(0.0);
            forecast.setRecommendedAction("å½“å‰å®¹é‡å……è¶³");
        }
        
        return forecast;
    }
    
    private String getCapacityRecommendation(String metricName, double growthRate) {
        if (growthRate > 50) {
            return "å»ºè®®ç«‹å³æ‰©å®¹ï¼Œé¢„æœŸå¢é•¿: " + growthRate + "%";
        } else if (growthRate > 20) {
            return "å»ºè®®åˆ¶å®šæ‰©å®¹è®¡åˆ’ï¼Œé¢„æœŸå¢é•¿: " + growthRate + "%";
        } else {
            return "å®¹é‡å¢é•¿å¹³ç¨³ï¼Œç»§ç»­è§‚å¯Ÿ";
        }
    }
}
```

### 13.4 å¼‚å¸¸æ¨¡å¼è¯†åˆ«


**ğŸ” å¼‚å¸¸æ£€æµ‹ç®—æ³•**
```java
public class AnomalyDetector {
    
    public List<Anomaly> detectAnomalies(List<MetricPoint> data) {
        List<Anomaly> anomalies = new ArrayList<>();
        
        if (data.size() < 20) return anomalies; // æ•°æ®ä¸è¶³
        
        // è®¡ç®—ç»Ÿè®¡åŸºçº¿
        double mean = calculateMean(data);
        double stdDev = calculateStdDev(data, mean);
        
        // æ£€æµ‹å¼‚å¸¸ç‚¹ï¼ˆè¶…å‡º3ä¸ªæ ‡å‡†å·®ï¼‰
        for (int i = 0; i < data.size(); i++) {
            MetricPoint point = data.get(i);
            double zScore = Math.abs((point.getValue() - mean) / stdDev);
            
            if (zScore > 3.0) {  // 3-sigmaå¼‚å¸¸æ£€æµ‹
                Anomaly anomaly = new Anomaly();
                anomaly.setTimestamp(point.getTimestamp());
                anomaly.setValue(point.getValue());
                anomaly.setZScore(zScore);
                anomaly.setSeverity(zScore > 4.0 ? "HIGH" : "MEDIUM");
                
                anomalies.add(anomaly);
            }
        }
        
        return anomalies;
    }
    
    public void analyzeAnomalyPatterns(List<Anomaly> anomalies) {
        // åˆ†æå¼‚å¸¸å‘ç”Ÿçš„æ—¶é—´æ¨¡å¼
        Map<Integer, Long> hourlyAnomalies = anomalies.stream()
            .collect(Collectors.groupingBy(
                a -> a.getTimestamp().getHour(),
                Collectors.counting()
            ));
        
        // æ‰¾å‡ºå¼‚å¸¸é«˜å‘æ—¶æ®µ
        for (Map.Entry<Integer, Long> entry : hourlyAnomalies.entrySet()) {
            if (entry.getValue() > 3) {
                log.warn("{}ç‚¹æ˜¯å¼‚å¸¸é«˜å‘æ—¶æ®µï¼Œå‘ç”Ÿ{}æ¬¡å¼‚å¸¸", entry.getKey(), entry.getValue());
            }
        }
    }
}
```

---

## 14. ğŸš€ æ•…éšœé¢„æµ‹å’Œé¢„è­¦æœºåˆ¶


### 14.1 æ•…éšœé¢„æµ‹åŸç†


**ğŸ”¸ æ•…éšœé¢„æµ‹çš„æ€è·¯**
```
ä¼ ç»Ÿè¿ç»´ï¼šæ•…éšœå‘ç”Ÿåå“åº”ï¼ˆè¢«åŠ¨ï¼‰
é¢„æµ‹æ€§è¿ç»´ï¼šæ•…éšœå‘ç”Ÿå‰é¢„é˜²ï¼ˆä¸»åŠ¨ï¼‰

é¢„æµ‹ä¾æ®ï¼š
â€¢ å†å²æ•…éšœæ¨¡å¼ï¼šç±»ä¼¼é—®é¢˜çš„å¾å…†
â€¢ æ€§èƒ½é€€åŒ–è¶‹åŠ¿ï¼šæŒ‡æ ‡æŒç»­æ¶åŒ–
â€¢ èµ„æºä½¿ç”¨æ¨¡å¼ï¼šæ¥è¿‘ç³»ç»Ÿæé™
â€¢ ä¸šåŠ¡å¢é•¿é¢„æµ‹ï¼šè´Ÿè½½è¶…å‡ºèƒ½åŠ›

é¢„æµ‹ç›®æ ‡ï¼š
â€¢ åœ¨æ•…éšœå‘ç”Ÿå‰30åˆ†é’Ÿåˆ°24å°æ—¶é¢„è­¦
â€¢ æä¾›å…·ä½“çš„é£é™©è¯„ä¼°å’Œå»ºè®®
â€¢ è‡ªåŠ¨è§¦å‘é¢„é˜²æ€§ç»´æŠ¤
```

### 14.2 æ•…éšœå¾å…†è¯†åˆ«


**ğŸ” å¸¸è§æ•…éšœå¾å…†æ¨¡å¼**
```java
public class FailurePredictionEngine {
    
    public enum FailurePattern {
        MEMORY_EXHAUSTION("å†…å­˜è€—å°½"),
        DISK_FULL("ç£ç›˜ç©ºé—´ä¸è¶³"), 
        CONNECTION_POOL_EXHAUSTION("è¿æ¥æ± è€—å°½"),
        LOCK_CONTENTION("é”ç«äº‰ä¸¥é‡"),
        IO_BOTTLENECK("I/Oç“¶é¢ˆ");
        
        private final String description;
        FailurePattern(String description) { this.description = description; }
    }
    
    public List<FailureRisk> predictFailures(StandardMetrics currentMetrics, 
                                           List<StandardMetrics> historicalData) {
        List<FailureRisk> risks = new ArrayList<>();
        
        // æ£€æµ‹å†…å­˜è€—å°½é£é™©
        if (isMemoryExhaustionRisk(currentMetrics, historicalData)) {
            risks.add(new FailureRisk(
                FailurePattern.MEMORY_EXHAUSTION,
                calculateRiskScore(currentMetrics.getMemoryUsage()),
                "é¢„è®¡2å°æ—¶å†…å¯èƒ½å†…å­˜ä¸è¶³",
                "å»ºè®®å¢åŠ å†…å­˜æˆ–ä¼˜åŒ–æŸ¥è¯¢"
            ));
        }
        
        // æ£€æµ‹ç£ç›˜ç©ºé—´é£é™©
        if (isDiskFullRisk(currentMetrics, historicalData)) {
            int hoursLeft = calculateDiskFullTime(historicalData);
            risks.add(new FailureRisk(
                FailurePattern.DISK_FULL,
                calculateDiskRiskScore(currentMetrics.getDiskUsage()),
                "é¢„è®¡" + hoursLeft + "å°æ—¶å†…ç£ç›˜ç©ºé—´ä¸è¶³",
                "å»ºè®®æ¸…ç†æ—¥å¿—æˆ–æ‰©å®¹ç£ç›˜"
            ));
        }
        
        // æ£€æµ‹è¿æ¥æ± é£é™©
        if (isConnectionPoolRisk(currentMetrics)) {
            risks.add(new FailureRisk(
                FailurePattern.CONNECTION_POOL_EXHAUSTION,
                RiskLevel.HIGH,
                "è¿æ¥æ•°æ¥è¿‘ä¸Šé™",
                "å»ºè®®æ£€æŸ¥è¿æ¥æ³„æ¼æˆ–å¢åŠ è¿æ¥æ± å¤§å°"
            ));
        }
        
        return risks;
    }
    
    private boolean isMemoryExhaustionRisk(StandardMetrics current, 
                                          List<StandardMetrics> historical) {
        // å½“å‰å†…å­˜ä½¿ç”¨ç‡ > 85%
        if (current.getMemoryUsage() > 85) {
            // æ£€æŸ¥å¢é•¿è¶‹åŠ¿
            TrendForecast trend = trendPredictor.predictTrend(
                extractMemoryUsage(historical), 1
            );
            
            // å¦‚æœè¶‹åŠ¿å‘ä¸Šä¸”é¢„æµ‹å€¼å°†è¶…è¿‡95%
            return TrendDirection.INCREASING.equals(trend.getTrendDirection()) &&
                   trend.getPredictedValues().get(0) > 95;
        }
        return false;
    }
    
    private int calculateDiskFullTime(List<StandardMetrics> historical) {
        // è®¡ç®—ç£ç›˜ç©ºé—´å¢é•¿é€Ÿåº¦
        List<Double> diskUsage = historical.stream()
            .map(StandardMetrics::getDiskUsage)
            .collect(Collectors.toList());
        
        if (diskUsage.size() < 3) return -1;
        
        // ç®€å•çº¿æ€§é¢„æµ‹
        double avgGrowthPerHour = calculateHourlyGrowthRate(diskUsage);
        double currentUsage = diskUsage.get(diskUsage.size() - 1);
        double spaceLeft = 100 - currentUsage;
        
        return (int) (spaceLeft / avgGrowthPerHour);
    }
}
```

### 14.3 é¢„è­¦æœºåˆ¶å®ç°


**âš¡ é¢„è­¦ç³»ç»Ÿæ¶æ„**
```
é¢„è­¦å¤„ç†æµç¨‹ï¼š
æ•°æ®é‡‡é›† â†’ é£é™©è¯„ä¼° â†’ é¢„è­¦ç”Ÿæˆ â†’ é¢„è­¦åˆ†å‘ â†’ é¢„é˜²æªæ–½ â†’ æ•ˆæœéªŒè¯

é¢„è­¦çº§åˆ«ï¼š
ğŸ”´ ç´§æ€¥é¢„è­¦ï¼šé¢„è®¡1å°æ—¶å†…æ•…éšœï¼ˆç«‹å³å¤„ç†ï¼‰
ğŸŸ¡ é‡è¦é¢„è­¦ï¼šé¢„è®¡4å°æ—¶å†…æ•…éšœï¼ˆä¼˜å…ˆå¤„ç†ï¼‰  
ğŸŸ¢ ä¸€èˆ¬é¢„è­¦ï¼šé¢„è®¡24å°æ—¶å†…æ•…éšœï¼ˆè®¡åˆ’å¤„ç†ï¼‰
```

**ğŸ”§ é¢„è­¦å®ç°ä»£ç **
```java
public class EarlyWarningSystem {
    
    @Scheduled(fixedRate = 300000) // æ¯5åˆ†é’Ÿæ‰§è¡Œ
    public void checkEarlyWarnings() {
        // è·å–å½“å‰æŒ‡æ ‡
        StandardMetrics current = metricsCollector.getCurrentMetrics();
        
        // è·å–å†å²æ•°æ®
        List<StandardMetrics> historical = metricsService.getHistoricalData(Duration.ofDays(7));
        
        // é¢„æµ‹æ½œåœ¨æ•…éšœ
        List<FailureRisk> risks = predictionEngine.predictFailures(current, historical);
        
        // å¤„ç†é¢„è­¦
        for (FailureRisk risk : risks) {
            processEarlyWarning(risk);
        }
    }
    
    private void processEarlyWarning(FailureRisk risk) {
        // ç”Ÿæˆé¢„è­¦æ¶ˆæ¯
        EarlyWarning warning = new EarlyWarning();
        warning.setRiskType(risk.getPattern());
        warning.setRiskLevel(risk.getRiskLevel());
        warning.setPredictedImpact(risk.getDescription());
        warning.setRecommendedAction(risk.getRecommendation());
        warning.setCreatedAt(LocalDateTime.now());
        
        // å‘é€é¢„è­¦
        sendEarlyWarning(warning);
        
        // è§¦å‘è‡ªåŠ¨é¢„é˜²æªæ–½ï¼ˆå¦‚æœé…ç½®äº†è‡ªåŠ¨åŒ–å“åº”ï¼‰
        if (isAutoActionEnabled(risk.getPattern())) {
            executePreventiveAction(risk);
        }
    }
    
    private void executePreventiveAction(FailureRisk risk) {
        switch (risk.getPattern()) {
            case MEMORY_EXHAUSTION:
                // è‡ªåŠ¨æ¸…ç†ç¼“å­˜ã€é‡å¯è¿æ¥æ± ç­‰
                cleanupMemory();
                break;
                
            case DISK_FULL:
                // è‡ªåŠ¨æ¸…ç†æ—¥å¿—æ–‡ä»¶
                cleanupLogs();
                break;
                
            case LOCK_CONTENTION:
                // è‡ªåŠ¨æ€æ­»é•¿æ—¶é—´è¿è¡Œçš„æŸ¥è¯¢
                killLongRunningQueries();
                break;
        }
    }
}
```

### 14.4 æœºå™¨å­¦ä¹ å¢å¼ºé¢„æµ‹


**ğŸ¤– åŸºäºæœºå™¨å­¦ä¹ çš„æ•…éšœé¢„æµ‹**
```java
public class MLBasedPredictor {
    
    // ä½¿ç”¨ç®€å•çš„å¼‚å¸¸æ£€æµ‹æ¨¡å‹
    public boolean isPotentialFailure(List<Double> recentMetrics) {
        if (recentMetrics.size() < 10) return false;
        
        // è®¡ç®—Z-scoreå¼‚å¸¸æ£€æµ‹
        double mean = recentMetrics.stream().mapToDouble(Double::doubleValue).average().orElse(0);
        double variance = recentMetrics.stream()
            .mapToDouble(value -> Math.pow(value - mean, 2))
            .average().orElse(0);
        double stdDev = Math.sqrt(variance);
        
        // æ£€æŸ¥æœ€è¿‘çš„å€¼æ˜¯å¦å¼‚å¸¸
        double latestValue = recentMetrics.get(recentMetrics.size() - 1);
        double zScore = Math.abs((latestValue - mean) / stdDev);
        
        return zScore > 2.5; // 2.5ä¸ªæ ‡å‡†å·®è®¤ä¸ºæ˜¯å¼‚å¸¸
    }
    
    public String generatePredictionReport(List<StandardMetrics> data) {
        StringBuilder report = new StringBuilder();
        report.append("=== æ•…éšœé¢„æµ‹æŠ¥å‘Š ===\n");
        
        // åˆ†æå„é¡¹æŒ‡æ ‡
        analyzeMetricTrend(data, "memoryUsage", "å†…å­˜ä½¿ç”¨ç‡", report);
        analyzeMetricTrend(data, "diskUsage", "ç£ç›˜ä½¿ç”¨ç‡", report);
        analyzeMetricTrend(data, "hitRate", "ç¼“å­˜å‘½ä¸­ç‡", report);
        
        return report.toString();
    }
    
    private void analyzeMetricTrend(List<StandardMetrics> data, String metricField, 
                                   String metricName, StringBuilder report) {
        List<Double> values = extractMetricValues(data, metricField);
        
        if (isPotentialFailure(values)) {
            report.append(String.format("âš ï¸ %sæ˜¾ç¤ºå¼‚å¸¸æ¨¡å¼ï¼Œå»ºè®®å…³æ³¨\n", metricName));
            
            // è®¡ç®—å˜åŒ–è¶‹åŠ¿
            double recentAvg = values.subList(values.size()-5, values.size())
                                   .stream().mapToDouble(Double::doubleValue).average().orElse(0);
            double historicalAvg = values.subList(0, values.size()-5)
                                       .stream().mapToDouble(Double::doubleValue).average().orElse(0);
            
            double changePercent = (recentAvg - historicalAvg) / historicalAvg * 100;
            report.append(String.format("   è¿‘æœŸå˜åŒ–: %.2f%%\n", changePercent));
        }
    }
}
```

---

## 15. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 15.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å¼•æ“çŠ¶æ€ç›‘æ§ï¼šå®æ—¶æŒæ¡å­˜å‚¨å¼•æ“è¿è¡ŒçŠ¶æ€å’Œå¥åº·ç¨‹åº¦
ğŸ”¸ æ€§èƒ½æŒ‡æ ‡æ”¶é›†ï¼šç³»ç»ŸåŒ–æ”¶é›†å’Œåˆ†ææ•°æ®åº“æ€§èƒ½æ•°æ®
ğŸ”¸ èµ„æºä½¿ç”¨ç›‘æ§ï¼šç›‘æ§CPUã€å†…å­˜ã€ç£ç›˜ç­‰ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
ğŸ”¸ é”ç­‰å¾…åˆ†æï¼šè¯†åˆ«å’Œè§£å†³æ•°æ®åº“é”ç«äº‰é—®é¢˜
ğŸ”¸ ç¼“å­˜å‘½ä¸­ç‡ï¼šç›‘æ§å’Œä¼˜åŒ–æ•°æ®åº“ç¼“å­˜æ€§èƒ½
ğŸ”¸ I/Oæ“ä½œç»Ÿè®¡ï¼šåˆ†æç£ç›˜I/Oæ€§èƒ½å’Œç“¶é¢ˆ
ğŸ”¸ ç›‘æ§è‡ªåŠ¨åŒ–ï¼šä½¿ç”¨å·¥å…·å®ç°ç›‘æ§çš„è‡ªåŠ¨åŒ–å’Œæ™ºèƒ½åŒ–
ğŸ”¸ ç›‘æ§ä½“ç³»å»ºè®¾ï¼šæ„å»ºå®Œæ•´çš„ç›‘æ§ä½“ç³»æ¶æ„
ğŸ”¸ å…³é”®ç›‘æ§æŒ‡æ ‡ï¼šè¯†åˆ«å’Œç›‘æ§æœ€é‡è¦çš„æ€§èƒ½æŒ‡æ ‡
ğŸ”¸ å‘Šè­¦ç­–ç•¥ï¼šè®¾è®¡åˆç†çš„å‘Šè­¦è§„åˆ™å’Œå¤„ç†æµç¨‹
ğŸ”¸ å¤šå¼•æ“ç»Ÿä¸€ç›‘æ§ï¼šåœ¨ç»Ÿä¸€å¹³å°ç›‘æ§ä¸åŒå­˜å‚¨å¼•æ“
ğŸ”¸ è¶‹åŠ¿åˆ†æé¢„æµ‹ï¼šåŸºäºå†å²æ•°æ®é¢„æµ‹æœªæ¥è¶‹åŠ¿
ğŸ”¸ æ•…éšœé¢„æµ‹é¢„è­¦ï¼šæå‰è¯†åˆ«å’Œé¢„é˜²æ½œåœ¨æ•…éšœ
```

### 15.2 ç›‘æ§æŠ€æœ¯é€‰æ‹©æŒ‡å—


**ğŸ“Š ä¸åŒåœºæ™¯çš„ç›‘æ§æ–¹æ¡ˆé€‰æ‹©**

| ä¸šåŠ¡åœºæ™¯ | **æ¨èæ–¹æ¡ˆ** | **æ ¸å¿ƒç›‘æ§ç‚¹** | **å‘Šè­¦ç­–ç•¥** |
|----------|-------------|---------------|-------------|
| **å°å‹åº”ç”¨** | åŸºç¡€ç›‘æ§è„šæœ¬ | å¯ç”¨æ€§ã€å“åº”æ—¶é—´ | é‚®ä»¶å‘Šè­¦ |
| **ä¸­å‹ä¼ä¸š** | Zabbix/Prometheus | æ€§èƒ½ã€èµ„æºã€ä¸šåŠ¡æŒ‡æ ‡ | å¤šæ¸ é“å‘Šè­¦ |
| **å¤§å‹å¹³å°** | è‡ªç ”+å¼€æºå·¥å…· | å…¨é¢æŒ‡æ ‡ã€é¢„æµ‹åˆ†æ | æ™ºèƒ½å‘Šè­¦ |
| **äº‘åŸç”Ÿåº”ç”¨** | äº‘å‚å•†ç›‘æ§æœåŠ¡ | å®¹å™¨ã€å¾®æœåŠ¡æŒ‡æ ‡ | è‡ªåŠ¨æ‰©ç¼©å®¹ |

### 15.3 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ç›‘æ§ä¸æ˜¯ç›®çš„ï¼Œä¼˜åŒ–æ‰æ˜¯ç›®æ ‡**
```
ç›‘æ§çš„ä»·å€¼é“¾ï¼š
æ•°æ®é‡‡é›† â†’ é—®é¢˜å‘ç° â†’ åŸå› åˆ†æ â†’ ä¼˜åŒ–æ”¹è¿› â†’ æ€§èƒ½æå‡

é¿å…ä¸ºç›‘æ§è€Œç›‘æ§ï¼š
â€¢ æ¯ä¸ªç›‘æ§æŒ‡æ ‡éƒ½è¦æœ‰æ˜ç¡®çš„è¡ŒåŠ¨æŒ‡å—
â€¢ å‘Šè­¦å¿…é¡»å¯æ‰§è¡Œï¼Œä¸èƒ½åªæ˜¯ä¿¡æ¯é€šçŸ¥
â€¢ ç›‘æ§æ•°æ®è¦èƒ½æŒ‡å¯¼å®é™…çš„ä¼˜åŒ–å·¥ä½œ
```

**ğŸ”¹ ä¸åŒå­˜å‚¨å¼•æ“çš„ç›‘æ§é‡ç‚¹**
```
InnoDBç›‘æ§é‡ç‚¹ï¼š
â€¢ ç¼“å†²æ± å‘½ä¸­ç‡ï¼ˆæ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡ï¼‰
â€¢ é”ç­‰å¾…å’Œæ­»é”ï¼ˆå¹¶å‘æ€§èƒ½ï¼‰
â€¢ äº‹åŠ¡æ—¥å¿—ï¼ˆæŒä¹…åŒ–æ€§èƒ½ï¼‰

MyISAMç›‘æ§é‡ç‚¹ï¼š
â€¢ é”®ç¼“å­˜å‘½ä¸­ç‡ï¼ˆç´¢å¼•æ€§èƒ½ï¼‰
â€¢ è¡¨é”ç­‰å¾…ï¼ˆå¹¶å‘ç“¶é¢ˆï¼‰
â€¢ å…¨è¡¨æ‰«æï¼ˆæŸ¥è¯¢æ•ˆç‡ï¼‰

Memoryå¼•æ“ç›‘æ§é‡ç‚¹ï¼š
â€¢ å†…å­˜ä½¿ç”¨é‡ï¼ˆå®¹é‡ç®¡ç†ï¼‰
â€¢ è¡¨å¤§å°æ§åˆ¶ï¼ˆé˜²æ­¢æº¢å‡ºï¼‰
â€¢ æŸ¥è¯¢å“åº”æ—¶é—´ï¼ˆå†…å­˜ä¼˜åŠ¿ä½“ç°ï¼‰
```

**ğŸ”¹ å‘Šè­¦è®¾è®¡çš„å¹³è¡¡è‰ºæœ¯**
```
å‘Šè­¦è®¾è®¡è¦å¹³è¡¡ï¼š
â€¢ æ•æ„Ÿæ€§ vs å‡†ç¡®æ€§ï¼šè¿‡äºæ•æ„Ÿä¼šäº§ç”Ÿå™ªéŸ³
â€¢ å®æ—¶æ€§ vs ç¨³å®šæ€§ï¼šå¤ªå¿«å“åº”å¯èƒ½è¯¯æŠ¥
â€¢ å…¨é¢æ€§ vs é‡ç‚¹æ€§ï¼šç›‘æ§å…¨é¢ä½†è¦çªå‡ºé‡ç‚¹

å‘Šè­¦ä¼˜åŒ–åŸåˆ™ï¼š
â€¢ å…ˆä¿è¯æ ¸å¿ƒä¸šåŠ¡ç›‘æ§
â€¢ é€æ­¥å®Œå–„ç›‘æ§è¦†ç›–åº¦
â€¢ æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´é˜ˆå€¼
â€¢ å®šæœŸå›é¡¾å’Œä¼˜åŒ–å‘Šè­¦è§„åˆ™
```

### 15.4 ç›‘æ§ä½“ç³»æˆç†Ÿåº¦æ¨¡å‹


**ğŸ“ˆ ç›‘æ§ä½“ç³»å‘å±•é˜¶æ®µ**
```
L1 - åŸºç¡€ç›‘æ§ï¼š
â€¢ æœåŠ¡å¯ç”¨æ€§ç›‘æ§
â€¢ åŸºç¡€èµ„æºç›‘æ§
â€¢ ç®€å•é˜ˆå€¼å‘Šè­¦
ç‰¹ç‚¹ï¼šè¢«åŠ¨å“åº”ï¼Œäººå·¥å¤„ç†

L2 - å®Œå–„ç›‘æ§ï¼š
â€¢ å…¨é¢æ€§èƒ½æŒ‡æ ‡
â€¢ å¤šç»´åº¦ç›‘æ§è§†å›¾  
â€¢ åˆ†çº§å‘Šè­¦ä½“ç³»
ç‰¹ç‚¹ï¼šä¸»åŠ¨å‘ç°ï¼Œæ ‡å‡†åŒ–å¤„ç†

L3 - æ™ºèƒ½ç›‘æ§ï¼š
â€¢ è¶‹åŠ¿åˆ†æé¢„æµ‹
â€¢ å¼‚å¸¸æ¨¡å¼è¯†åˆ«
â€¢ è‡ªåŠ¨æ•…éšœæ¢å¤
ç‰¹ç‚¹ï¼šé¢„æµ‹æ€§è¿ç»´ï¼Œè‡ªåŠ¨åŒ–å¤„ç†

L4 - è‡ªæ²»ç›‘æ§ï¼š
â€¢ æœºå™¨å­¦ä¹ é©±åŠ¨
â€¢ è‡ªé€‚åº”é˜ˆå€¼
â€¢ å…¨è‡ªåŠ¨ä¼˜åŒ–
ç‰¹ç‚¹ï¼šè‡ªæˆ‘å­¦ä¹ ï¼Œè‡ªæˆ‘ä¼˜åŒ–
```

### 15.5 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ ä¸šåŠ¡åœºæ™¯åº”ç”¨**
```
ç”µå•†å¹³å°ï¼š
â€¢ å¤§ä¿ƒæœŸé—´ç›‘æ§ï¼šç¡®ä¿ç³»ç»Ÿç¨³å®š
â€¢ æ€§èƒ½ç“¶é¢ˆè¯†åˆ«ï¼šä¼˜åŒ–è´­ç‰©ä½“éªŒ
â€¢ å®¹é‡è§„åˆ’ï¼šæ”¯æ’‘ä¸šåŠ¡å¢é•¿

é‡‘èç³»ç»Ÿï¼š
â€¢ äº¤æ˜“é«˜å³°ç›‘æ§ï¼šä¿éšœèµ„é‡‘å®‰å…¨
â€¢ åˆè§„è¦æ±‚ï¼šæ»¡è¶³ç›‘ç®¡è¦æ±‚
â€¢ é£é™©æ§åˆ¶ï¼šé¢„é˜²ç³»ç»Ÿæ€§é£é™©

å†…å®¹å¹³å°ï¼š
â€¢ çƒ­ç‚¹æ•°æ®ç›‘æ§ï¼šä¼˜åŒ–ç¼“å­˜ç­–ç•¥
â€¢ ç”¨æˆ·ä½“éªŒï¼šç¡®ä¿å†…å®¹å¿«é€ŸåŠ è½½
â€¢ æˆæœ¬ä¼˜åŒ–ï¼šåˆç†é…ç½®èµ„æº
```

**ğŸ’¼ è¿ç»´ä»·å€¼ä½“ç°**
```
æ•ˆç‡æå‡ï¼š
â€¢ æ•…éšœå‘ç°æ—¶é—´ä»å°æ—¶çº§é™åˆ°åˆ†é’Ÿçº§
â€¢ è‡ªåŠ¨åŒ–å‘Šè­¦å‡å°‘90%äººå·¥å·¡æ£€å·¥ä½œ
â€¢ é¢„æµ‹æ€§ç»´æŠ¤é¿å…80%çªå‘æ•…éšœ

æˆæœ¬èŠ‚çº¦ï¼š
â€¢ ç²¾ç¡®å®¹é‡è§„åˆ’ï¼Œé¿å…èµ„æºæµªè´¹
â€¢ æå‰ä¼˜åŒ–ï¼Œé¿å…ç´§æ€¥æ‰©å®¹æˆæœ¬
â€¢ å‡å°‘æ•…éšœæŸå¤±ï¼Œæå‡ä¸šåŠ¡è¿ç»­æ€§

æŠ€æœ¯è¿›æ­¥ï¼š
â€¢ æ•°æ®é©±åŠ¨çš„ä¼˜åŒ–å†³ç­–
â€¢ ç§¯ç´¯è¿ç»´çŸ¥è¯†åº“
â€¢ å›¢é˜ŸæŠ€æœ¯èƒ½åŠ›æå‡
```

### 15.6 å­¦ä¹ è·¯å¾„å»ºè®®


**ğŸ“š ç›‘æ§æŠ€æœ¯å­¦ä¹ è·¯çº¿**
```
ç¬¬1é˜¶æ®µ - åŸºç¡€ç†è§£ï¼ˆ1-2å‘¨ï¼‰ï¼š
â€¢ ç†è§£ç›‘æ§çš„ä»·å€¼å’Œæ„ä¹‰
â€¢ æŒæ¡åŸºæœ¬çš„ç›‘æ§å‘½ä»¤
â€¢ å­¦ä¼šè¯»æ‡‚å…³é”®æ€§èƒ½æŒ‡æ ‡

ç¬¬2é˜¶æ®µ - å·¥å…·å®è·µï¼ˆ2-4å‘¨ï¼‰ï¼š
â€¢ å­¦ä¹ ä½¿ç”¨Prometheus+Grafana
â€¢ é…ç½®åŸºç¡€çš„ç›‘æ§å’Œå‘Šè­¦
â€¢ å®ç°ç®€å•çš„ç›‘æ§è„šæœ¬

ç¬¬3é˜¶æ®µ - ä½“ç³»å»ºè®¾ï¼ˆ1-2æœˆï¼‰ï¼š
â€¢ è®¾è®¡å®Œæ•´çš„ç›‘æ§ä½“ç³»
â€¢ å®ç°é«˜çº§å‘Šè­¦ç­–ç•¥
â€¢ å¼€å‘è‡ªå®šä¹‰ç›‘æ§å·¥å…·

ç¬¬4é˜¶æ®µ - æ™ºèƒ½åŒ–ï¼ˆ2-3æœˆï¼‰ï¼š
â€¢ å­¦ä¹ è¶‹åŠ¿åˆ†æå’Œé¢„æµ‹
â€¢ å®ç°å¼‚å¸¸æ£€æµ‹ç®—æ³•
â€¢ æ„å»ºæ•…éšœé¢„æµ‹æ¨¡å‹

å®æˆ˜é¡¹ç›®å»ºè®®ï¼š
â€¢ ä¸ºç°æœ‰MySQLå®ä¾‹æ­å»ºç›‘æ§ç³»ç»Ÿ
â€¢ å®ç°ä¸šåŠ¡æŒ‡æ ‡ç›‘æ§å¤§å±
â€¢ å¼€å‘æ•…éšœé¢„æµ‹å’Œè‡ªåŠ¨æ¢å¤ç³»ç»Ÿ
```

**ğŸ”§ å®ç”¨å·¥å…·æ¨è**
```
å¼€æºç›‘æ§å·¥å…·ï¼š
â€¢ Prometheus + Grafanaï¼šåŠŸèƒ½å…¨é¢
â€¢ Zabbixï¼šä¼ä¸šçº§ç›‘æ§
â€¢ Nagiosï¼šä¼ ç»Ÿä½†ç¨³å®š
â€¢ Elasticsearch + Kibanaï¼šæ—¥å¿—åˆ†æ

MySQLä¸“ç”¨å·¥å…·ï¼š
â€¢ MySQL Enterprise Monitorï¼šå®˜æ–¹å•†ä¸šæ–¹æ¡ˆ
â€¢ Percona Monitoring and Managementï¼šå¼€æºä¸“ä¸šæ–¹æ¡ˆ
â€¢ MySQL Workbenchï¼šå¼€å‘è°ƒè¯•å·¥å…·
â€¢ pt-toolsï¼šPerconaå·¥å…·åŒ…

äº‘æœåŠ¡ç›‘æ§ï¼š
â€¢ é˜¿é‡Œäº‘RDSç›‘æ§
â€¢ è…¾è®¯äº‘CDBç›‘æ§  
â€¢ AWS RDS Performance Insights
â€¢ Azure Databaseç›‘æ§
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
ğŸ’¡ "å­˜å‚¨å¼•æ“ç›‘æ§å…«è¦ç´ "
çŠ¶æ€æŒ‡æ ‡è¦æ”¶å…¨ï¼Œæ€§èƒ½èµ„æºç»†åˆ†æ
é”ç­‰ç¼“å­˜æ˜¯é‡ç‚¹ï¼ŒI/Oæ“ä½œè¦ç»Ÿè®¡
è‡ªåŠ¨å·¥å…·æ¥å¸®å¿™ï¼Œä½“ç³»å»ºè®¾è¦è§„åˆ’
å‘Šè­¦é¢„æµ‹é˜²æ•…éšœï¼ŒæŒç»­ä¼˜åŒ–æ˜¯ç‹é“
```

**ğŸ¯ æ ¸å¿ƒç†è§£**ï¼š
- ç›‘æ§æ˜¯æ•°æ®åº“è¿ç»´çš„çœ¼ç›ï¼Œæ²¡æœ‰ç›‘æ§å°±æ˜¯ç›²äººæ‘¸è±¡
- ä¸åŒå­˜å‚¨å¼•æ“éœ€è¦å…³æ³¨ä¸åŒçš„ç›‘æ§é‡ç‚¹
- å¥½çš„ç›‘æ§ä½“ç³»èƒ½å°†è¢«åŠ¨è¿ç»´è½¬ä¸ºä¸»åŠ¨è¿ç»´
- ç›‘æ§æ•°æ®çš„ä»·å€¼åœ¨äºæŒ‡å¯¼ä¼˜åŒ–å’Œé¢„é˜²æ•…éšœ
- è‡ªåŠ¨åŒ–å’Œæ™ºèƒ½åŒ–æ˜¯ç›‘æ§æŠ€æœ¯çš„å‘å±•æ–¹å‘