---
title: 33ã€éšå¼ç±»å‹è½¬æ¢æ•…éšœ
---
## ğŸ“š ç›®å½•

1. [éšå¼ç±»å‹è½¬æ¢åŸºæœ¬æ¦‚å¿µ](#1-éšå¼ç±»å‹è½¬æ¢åŸºæœ¬æ¦‚å¿µ)
2. [å­—ç¬¦ä¸²ä¸æ•°å­—è½¬æ¢é™·é˜±](#2-å­—ç¬¦ä¸²ä¸æ•°å­—è½¬æ¢é™·é˜±)
3. [æ—¥æœŸç±»å‹è½¬æ¢é—®é¢˜](#3-æ—¥æœŸç±»å‹è½¬æ¢é—®é¢˜)
4. [ç²¾åº¦ä¸¢å¤±ä¸æ•°æ®å¼‚å¸¸](#4-ç²¾åº¦ä¸¢å¤±ä¸æ•°æ®å¼‚å¸¸)
5. [ç´¢å¼•å¤±æ•ˆåœºæ™¯åˆ†æ](#5-ç´¢å¼•å¤±æ•ˆåœºæ™¯åˆ†æ)
6. [æ€§èƒ½å½±å“ä¸ç›‘æ§](#6-æ€§èƒ½å½±å“ä¸ç›‘æ§)
7. [è½¬æ¢è§„åˆ™è¯¦è§£](#7-è½¬æ¢è§„åˆ™è¯¦è§£)
8. [æœ€ä½³å®è·µä¸é¢„é˜²](#8-æœ€ä½³å®è·µä¸é¢„é˜²)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ éšå¼ç±»å‹è½¬æ¢åŸºæœ¬æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯éšå¼ç±»å‹è½¬æ¢


**ğŸ”¸ æ ¸å¿ƒå®šä¹‰**
```
éšå¼ç±»å‹è½¬æ¢ï¼šMySQLåœ¨æ‰§è¡ŒSQLæ—¶ï¼Œè‡ªåŠ¨å°†ä¸€ç§æ•°æ®ç±»å‹è½¬æ¢ä¸ºå¦ä¸€ç§ç±»å‹
è§¦å‘æ¡ä»¶ï¼šä¸åŒç±»å‹æ•°æ®è¿›è¡Œæ¯”è¾ƒã€è¿ç®—ã€å‡½æ•°è°ƒç”¨æ—¶
å±é™©æ€§ï¼šå¯èƒ½å¯¼è‡´ç´¢å¼•å¤±æ•ˆã€æ€§èƒ½ä¸‹é™ã€æ•°æ®å¼‚å¸¸
```

**ğŸ’¡ ç”Ÿæ´»åŒ–ç†è§£**
```
å°±åƒæ—¥å¸¸å¯¹è¯ä¸­çš„"è‡ªåŠ¨ç¿»è¯‘"ï¼š
- ä½ è¯´"3"ï¼Œæˆ‘ç†è§£æˆæ•°å­—3
- ä½ è¯´"ä¸‰"ï¼Œæˆ‘ä¹Ÿç†è§£æˆæ•°å­—3
- ä½†å¦‚æœç†è§£é”™äº†ï¼Œå°±ä¼šå‡ºé—®é¢˜

MySQLä¹Ÿä¼š"è‡ªåŠ¨ç¿»è¯‘"ä¸åŒç±»å‹çš„æ•°æ®
ä½†è¿™ç§"ç¿»è¯‘"å¯èƒ½å¸¦æ¥æ„æƒ³ä¸åˆ°çš„é—®é¢˜
```

### 1.2 è½¬æ¢è§¦å‘åœºæ™¯


**ğŸ”§ å¸¸è§è§¦å‘æƒ…å†µ**
```sql
-- åœºæ™¯1ï¼šWHEREæ¡ä»¶æ¯”è¾ƒ
SELECT * FROM users WHERE id = '123';  -- å­—ç¬¦ä¸²å’Œæ•´æ•°æ¯”è¾ƒ

-- åœºæ™¯2ï¼šJOINè¿æ¥æ¡ä»¶
SELECT * FROM orders o 
JOIN users u ON o.user_id = u.id_str;  -- æ•´æ•°å’Œå­—ç¬¦ä¸²è¿æ¥

-- åœºæ™¯3ï¼šå‡½æ•°å‚æ•°
SELECT * FROM products WHERE price = CONCAT('99', '.99');  -- å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒ

-- åœºæ™¯4ï¼šè¿ç®—è¡¨è¾¾å¼
SELECT * FROM items WHERE quantity + '10' > 50;  -- æ•°å­—å’Œå­—ç¬¦ä¸²è¿ç®—
```

**âš ï¸ éšè”½æ€§é—®é¢˜**
```
é—®é¢˜ç‰¹ç‚¹ï¼š
âœ“ SQLè¯­æ³•æ­£ç¡®ï¼Œä¸ä¼šæŠ¥é”™
âœ“ èƒ½æ­£å¸¸æ‰§è¡Œå¹¶è¿”å›ç»“æœ
âœ— ç»“æœå¯èƒ½ä¸æ˜¯é¢„æœŸçš„
âœ— æ€§èƒ½å¯èƒ½ä¸¥é‡ä¸‹é™
âœ— é—®é¢˜ä¸å®¹æ˜“è¢«å‘ç°
```

---

## 2. ğŸ”¢ å­—ç¬¦ä¸²ä¸æ•°å­—è½¬æ¢é™·é˜±


### 2.1 å­—ç¬¦ä¸²è½¬æ•°å­—è§„åˆ™


**ğŸ“‹ MySQLè½¬æ¢è§„åˆ™**
```sql
-- è§„åˆ™1ï¼šçº¯æ•°å­—å­—ç¬¦ä¸²ç›´æ¥è½¬æ¢
SELECT '123' + 0;        -- ç»“æœï¼š123
SELECT '45.67' + 0;      -- ç»“æœï¼š45.67

-- è§„åˆ™2ï¼šå¼€å¤´æ˜¯æ•°å­—çš„å­—ç¬¦ä¸²ï¼Œåªè½¬æ¢æ•°å­—éƒ¨åˆ†
SELECT '123abc' + 0;     -- ç»“æœï¼š123ï¼ˆå¿½ç•¥abcï¼‰
SELECT '45.67xyz' + 0;   -- ç»“æœï¼š45.67ï¼ˆå¿½ç•¥xyzï¼‰

-- è§„åˆ™3ï¼šéæ•°å­—å¼€å¤´çš„å­—ç¬¦ä¸²è½¬æ¢ä¸º0
SELECT 'abc123' + 0;     -- ç»“æœï¼š0ï¼ˆæ•´ä¸ªå­—ç¬¦ä¸²å˜æˆ0ï¼‰
SELECT 'hello' + 0;      -- ç»“æœï¼š0
```

**ğŸ’¥ å¸¸è§é™·é˜±ç¤ºä¾‹**
```sql
-- é™·é˜±1ï¼šéƒ¨åˆ†è½¬æ¢å¯¼è‡´é”™è¯¯åŒ¹é…
CREATE TABLE test (id INT, code VARCHAR(20));
INSERT INTO test VALUES (1, '100abc'), (2, '200def');

-- å±é™©æŸ¥è¯¢
SELECT * FROM test WHERE code = 100;
-- ç»“æœï¼šè¿”å› (1, '100abc')
-- åŸå› ï¼š'100abc' è¢«è½¬æ¢ä¸º 100

-- é™·é˜±2ï¼šå­—æ¯å¼€å¤´å…¨éƒ¨å˜æˆ0
SELECT * FROM test WHERE code = 0;  
-- å¯èƒ½åŒ¹é…æ‰€æœ‰å­—æ¯å¼€å¤´çš„è®°å½•
```

### 2.2 æ•°å­—è½¬å­—ç¬¦ä¸²é—®é¢˜


**ğŸ”„ åå‘è½¬æ¢åœºæ™¯**
```sql
-- æ•°å­—è‡ªåŠ¨è½¬ä¸ºå­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒ
SELECT * FROM users WHERE phone = 13812345678;  
-- phoneæ˜¯VARCHARç±»å‹ï¼Œ13812345678ä¼šè½¬ä¸ºå­—ç¬¦ä¸²

-- ç²¾åº¦é—®é¢˜
SELECT * FROM accounts WHERE balance = 99.999999999999;
-- å¯èƒ½å› ä¸ºç²¾åº¦é—®é¢˜å¯¼è‡´åŒ¹é…å¤±è´¥
```

### 2.3 å®é™…æ•…éšœæ¡ˆä¾‹


**ğŸ“Š æ¡ˆä¾‹ï¼šè®¢å•æŸ¥è¯¢å¼‚å¸¸**
```sql
-- è¡¨ç»“æ„
CREATE TABLE orders (
    id INT PRIMARY KEY,
    order_no VARCHAR(32),
    amount DECIMAL(10,2),
    INDEX idx_order_no (order_no)
);

-- é—®é¢˜æŸ¥è¯¢ï¼ˆè®¢å•å·åº”è¯¥æ˜¯å­—ç¬¦ä¸²ï¼‰
SELECT * FROM orders WHERE order_no = 202309001;
-- é—®é¢˜ï¼šæ•°å­—202309001è¢«è½¬æ¢ä¸ºå­—ç¬¦ä¸²'202309001'è¿›è¡Œæ¯”è¾ƒ
-- å¦‚æœæ•°æ®ä¸­æ˜¯'ORD202309001'æ ¼å¼ï¼Œå°±æŸ¥ä¸åˆ°æ•°æ®
```

**ğŸ” æ•…éšœæ’æŸ¥**
```sql
-- 1. æŸ¥çœ‹å®é™…è½¬æ¢è¿‡ç¨‹
EXPLAIN FORMAT=JSON 
SELECT * FROM orders WHERE order_no = 202309001;

-- 2. æ­£ç¡®çš„æŸ¥è¯¢æ–¹å¼
SELECT * FROM orders WHERE order_no = '202309001';
```

---

## 3. ğŸ“… æ—¥æœŸç±»å‹è½¬æ¢é—®é¢˜


### 3.1 æ—¥æœŸå­—ç¬¦ä¸²è½¬æ¢è§„åˆ™


**ğŸ“ MySQLæ—¥æœŸè½¬æ¢**
```sql
-- æ ‡å‡†æ ¼å¼è‡ªåŠ¨è¯†åˆ«
SELECT * FROM events WHERE event_date = '2023-09-15';     -- âœ“ æ­£ç¡®
SELECT * FROM events WHERE event_date = '2023/09/15';     -- âœ“ è‡ªåŠ¨è½¬æ¢
SELECT * FROM events WHERE event_date = '09/15/2023';     -- âš ï¸ å¯èƒ½æœ‰é—®é¢˜

-- æ—¶é—´æˆ³è½¬æ¢
SELECT * FROM logs WHERE create_time = '2023-09-15 10:30:00';  -- âœ“ æ­£ç¡®
SELECT * FROM logs WHERE create_time = 20230915103000;         -- âœ— æ•°å­—æ ¼å¼
```

**âš ï¸ æ—¥æœŸæ ¼å¼é™·é˜±**
```sql
-- æ¡ˆä¾‹ï¼šç¾å¼æ—¥æœŸæ ¼å¼æ··æ·†
INSERT INTO events VALUES (1, '2023-03-05');  -- 3æœˆ5æ—¥
INSERT INTO events VALUES (2, '2023-05-03');  -- 5æœˆ3æ—¥

-- å¦‚æœåº”ç”¨ä¼ å…¥ '03/05/2023'ï¼ŒMySQLå¯èƒ½ç†è§£ä¸ºï¼š
-- æ–¹å¼1ï¼š2023å¹´3æœˆ5æ—¥
-- æ–¹å¼2ï¼š2003å¹´5æœˆ23æ—¥ï¼ˆå¹´ä»½ç†è§£é”™è¯¯ï¼‰
-- æ–¹å¼3ï¼šè½¬æ¢å¤±è´¥è¿”å›NULL
```

### 3.2 æ—¶åŒºè½¬æ¢é—®é¢˜


**ğŸŒ æ—¶åŒºç›¸å…³è½¬æ¢**
```sql
-- ä¸åŒæ—¶åŒºçš„æ—¶é—´æ¯”è¾ƒ
SELECT * FROM orders 
WHERE create_time = '2023-09-15 10:00:00';  -- å“ªä¸ªæ—¶åŒºçš„10ç‚¹ï¼Ÿ

-- æ¨èåšæ³•ï¼šæ˜ç¡®æŒ‡å®šæ—¶åŒº
SELECT * FROM orders 
WHERE create_time = CONVERT_TZ('2023-09-15 10:00:00', '+08:00', '+00:00');
```

### 3.3 æ—¥æœŸç±»å‹æ€§èƒ½å½±å“


**ğŸ“ˆ æ€§èƒ½å¯¹æ¯”æµ‹è¯•**
```sql
-- æµ‹è¯•è¡¨
CREATE TABLE log_entries (
    id INT AUTO_INCREMENT PRIMARY KEY,
    log_date DATE,
    log_datetime DATETIME,
    INDEX idx_date (log_date),
    INDEX idx_datetime (log_datetime)
);

-- æ€§èƒ½æµ‹è¯•ï¼šæ­£ç¡®ä½¿ç”¨ç´¢å¼•
SELECT COUNT(*) FROM log_entries 
WHERE log_date = '2023-09-15';                    -- ä½¿ç”¨ç´¢å¼•

-- æ€§èƒ½æµ‹è¯•ï¼šç´¢å¼•å¤±æ•ˆ
SELECT COUNT(*) FROM log_entries 
WHERE YEAR(log_date) = 2023 AND MONTH(log_date) = 9;  -- ç´¢å¼•å¤±æ•ˆ
```

---

## 4. ğŸ’° ç²¾åº¦ä¸¢å¤±ä¸æ•°æ®å¼‚å¸¸


### 4.1 æµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜


**ğŸ”¸ ç²¾åº¦ä¸¢å¤±åœºæ™¯**
```sql
-- DECIMAL vs FLOAT/DOUBLE
CREATE TABLE prices (
    product_id INT,
    decimal_price DECIMAL(10,2),
    float_price FLOAT,
    double_price DOUBLE
);

-- æ’å…¥ç›¸åŒæ•°æ®
INSERT INTO prices VALUES 
(1, 99.99, 99.99, 99.99),
(2, 199.99, 199.99, 199.99);

-- æ¯”è¾ƒæŸ¥è¯¢
SELECT * FROM prices WHERE decimal_price = 99.99;  -- âœ“ ç²¾ç¡®åŒ¹é…
SELECT * FROM prices WHERE float_price = 99.99;    -- âš ï¸ å¯èƒ½å¤±è´¥
```

**ğŸ’¡ ç²¾åº¦ä¸¢å¤±æ¼”ç¤º**
```sql
-- æ¼”ç¤ºæµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜
SELECT 
    99.99 AS input_value,
    CAST(99.99 AS FLOAT) AS float_value,
    CAST(99.99 AS DECIMAL(10,2)) AS decimal_value;

-- å¯èƒ½ç»“æœï¼š
-- input_value: 99.99
-- float_value: 99.98999786376953  â† ç²¾åº¦ä¸¢å¤±
-- decimal_value: 99.99            â† ç²¾ç¡®å­˜å‚¨
```

### 4.2 å¤§æ•´æ•°è½¬æ¢é—®é¢˜


**ğŸ”¢ æ•´æ•°èŒƒå›´é—®é¢˜**
```sql
-- JavaScriptä¸­çš„å¤§æ•´æ•°é—®é¢˜
SELECT * FROM users WHERE id = 9007199254740992;  -- JavaScript MAX_SAFE_INTEGER + 1

-- å¯èƒ½çš„é—®é¢˜ï¼š
-- 1. å‰ç«¯JavaScriptç²¾åº¦ä¸¢å¤±
-- 2. JSONåºåˆ—åŒ–ç²¾åº¦é—®é¢˜  
-- 3. æ•°æ®åº“æŸ¥è¯¢ç»“æœä¸å‡†ç¡®
```

### 4.3 è´§å¸è®¡ç®—ç²¾åº¦


**ğŸ’° è´¢åŠ¡è®¡ç®—é™·é˜±**
```sql
-- é”™è¯¯çš„è´§å¸è®¡ç®—
SELECT 
    price * 1.1 AS price_with_tax    -- âœ— FLOATè¿ç®—å¯èƒ½ç²¾åº¦ä¸¢å¤±
FROM products;

-- æ­£ç¡®çš„è´§å¸è®¡ç®—  
SELECT 
    ROUND(price * 1.1, 2) AS price_with_tax  -- âœ“ æŒ‡å®šç²¾åº¦
FROM products;

-- æ›´å®‰å…¨çš„æ–¹å¼
ALTER TABLE products 
MODIFY COLUMN price DECIMAL(10,2);  -- ä½¿ç”¨DECIMALç±»å‹
```

---

## 5. ğŸ” ç´¢å¼•å¤±æ•ˆåœºæ™¯åˆ†æ


### 5.1 ç±»å‹è½¬æ¢å¯¼è‡´ç´¢å¼•å¤±æ•ˆ


**ğŸ“Š ç´¢å¼•å¤±æ•ˆåŸç†**
```
åŸç†è¯´æ˜ï¼š
å½“WHEREæ¡ä»¶ä¸­çš„åˆ—å‘ç”Ÿç±»å‹è½¬æ¢æ—¶ï¼ŒMySQLæ— æ³•ç›´æ¥ä½¿ç”¨ç´¢å¼•
å¿…é¡»å¯¹æ¯è¡Œæ•°æ®è¿›è¡Œè½¬æ¢åå†æ¯”è¾ƒï¼Œå¯¼è‡´å…¨è¡¨æ‰«æ

ç´¢å¼•å¤±æ•ˆåˆ¤æ–­ï¼š
EXPLAINä¸­type=ALL æˆ– key=NULL è¡¨ç¤ºæ²¡æœ‰ä½¿ç”¨ç´¢å¼•
```

**ğŸ”§ å…¸å‹å¤±æ•ˆåœºæ™¯**
```sql
-- åœºæ™¯1ï¼šå­—ç¬¦ä¸²åˆ—ä¸æ•°å­—æ¯”è¾ƒ
CREATE TABLE users (
    id INT PRIMARY KEY,
    phone VARCHAR(11),
    INDEX idx_phone (phone)
);

-- ç´¢å¼•å¤±æ•ˆæŸ¥è¯¢
SELECT * FROM users WHERE phone = 13812345678;  -- æ•°å­—å’ŒVARCHARæ¯”è¾ƒ
-- EXPLAINæ˜¾ç¤ºï¼štype=ALL, key=NULL

-- ç´¢å¼•ç”Ÿæ•ˆæŸ¥è¯¢  
SELECT * FROM users WHERE phone = '13812345678';  -- å­—ç¬¦ä¸²å’ŒVARCHARæ¯”è¾ƒ
-- EXPLAINæ˜¾ç¤ºï¼štype=ref, key=idx_phone
```

### 5.2 å‡½æ•°å¯¼è‡´çš„ç´¢å¼•å¤±æ•ˆ


**âš¡ å‡½æ•°ä½¿ç”¨é—®é¢˜**
```sql
-- ç´¢å¼•å¤±æ•ˆï¼šå¯¹åˆ—ä½¿ç”¨å‡½æ•°
SELECT * FROM orders WHERE YEAR(create_date) = 2023;
-- ç­‰ä»·äºå¯¹æ¯è¡Œéƒ½æ‰§è¡ŒYEAR()å‡½æ•°

-- ç´¢å¼•ç”Ÿæ•ˆï¼šæ”¹å†™æŸ¥è¯¢æ¡ä»¶
SELECT * FROM orders 
WHERE create_date >= '2023-01-01' 
  AND create_date < '2024-01-01';
```

### 5.3 å­—ç¬¦é›†è½¬æ¢ç´¢å¼•å¤±æ•ˆ


**ğŸŒ å­—ç¬¦é›†é—®é¢˜**
```sql
-- ä¸åŒå­—ç¬¦é›†çš„è¡¨JOIN
CREATE TABLE t1 (name VARCHAR(50) CHARACTER SET utf8);
CREATE TABLE t2 (name VARCHAR(50) CHARACTER SET utf8mb4);

-- å¯èƒ½å¯¼è‡´ç´¢å¼•å¤±æ•ˆ
SELECT * FROM t1 
JOIN t2 ON t1.name = t2.name;  -- å­—ç¬¦é›†è½¬æ¢
```

---

## 6. ğŸ“ˆ æ€§èƒ½å½±å“ä¸ç›‘æ§


### 6.1 æ€§èƒ½å½±å“é‡åŒ–


**ğŸ“Š æ€§èƒ½å¯¹æ¯”æµ‹è¯•**
```sql
-- åˆ›å»ºæµ‹è¯•ç¯å¢ƒ
CREATE TABLE perf_test (
    id INT PRIMARY KEY,
    str_col VARCHAR(20),
    int_col INT,
    INDEX idx_str (str_col),
    INDEX idx_int (int_col)
);

-- æ’å…¥100ä¸‡æµ‹è¯•æ•°æ®
-- ... çœç•¥æ•°æ®æ’å…¥ä»£ç  ...

-- æ€§èƒ½æµ‹è¯•1ï¼šæ­£ç¡®ä½¿ç”¨ç´¢å¼•
SELECT SQL_NO_CACHE COUNT(*) FROM perf_test WHERE str_col = '12345';
-- æ‰§è¡Œæ—¶é—´ï¼š0.001ç§’ï¼Œæ‰«æè¡Œæ•°ï¼š1è¡Œ

-- æ€§èƒ½æµ‹è¯•2ï¼šéšå¼è½¬æ¢ç´¢å¼•å¤±æ•ˆ
SELECT SQL_NO_CACHE COUNT(*) FROM perf_test WHERE str_col = 12345;  
-- æ‰§è¡Œæ—¶é—´ï¼š0.5ç§’ï¼Œæ‰«æè¡Œæ•°ï¼š1,000,000è¡Œ
```

**ğŸ“‹ æ€§èƒ½å·®å¼‚æ€»ç»“**
```
åœºæ™¯å¯¹æ¯”ï¼š
âœ“ ç±»å‹åŒ¹é… + ç´¢å¼•ï¼šæ¯«ç§’çº§å“åº”
âœ— ç±»å‹è½¬æ¢ + å…¨è¡¨æ‰«æï¼šç§’çº§å“åº”
æ€§èƒ½å·®å¼‚ï¼š500-1000å€

å®é™…å½±å“ï¼š
- æŸ¥è¯¢å“åº”æ—¶é—´æ€¥å‰§å¢åŠ 
- CPUä½¿ç”¨ç‡æ˜¾è‘—ä¸Šå‡  
- å¹¶å‘èƒ½åŠ›å¤§å¹…ä¸‹é™
- å¯èƒ½å¯¼è‡´æ•°æ®åº“è¿æ¥æ± è€—å°½
```

### 6.2 ç›‘æ§ä¸æ£€æµ‹


**ğŸ” æ£€æµ‹éšå¼è½¬æ¢çš„æ–¹æ³•**
```sql
-- 1. ä½¿ç”¨EXPLAINåˆ†æ
EXPLAIN FORMAT=JSON 
SELECT * FROM users WHERE phone = 13812345678;

-- 2. å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—
SET GLOBAL slow_query_log = ON;
SET GLOBAL long_query_time = 0.1;  -- è®°å½•0.1ç§’ä»¥ä¸Šçš„æŸ¥è¯¢

-- 3. ä½¿ç”¨Performance Schema
SELECT 
    DIGEST_TEXT,
    COUNT_STAR,
    AVG_TIMER_WAIT/1000000000 AS avg_time_sec
FROM performance_schema.events_statements_summary_by_digest
WHERE DIGEST_TEXT LIKE '%WHERE%=%'
ORDER BY AVG_TIMER_WAIT DESC;
```

### 6.3 å‘Šè­¦æœºåˆ¶è®¾ç½®


**âš ï¸ ç›‘æ§å‘Šè­¦é…ç½®**
```sql
-- åˆ›å»ºç›‘æ§è§†å›¾
CREATE VIEW slow_conversion_queries AS
SELECT 
    query,
    exec_count,
    avg_exec_time,
    total_exec_time
FROM mysql.slow_log 
WHERE query LIKE '%WHERE%=%' 
  AND query NOT LIKE '%''%'  -- ä¸åŒ…å«å¼•å·çš„æŸ¥è¯¢æ›´å¯èƒ½æœ‰ç±»å‹è½¬æ¢
  AND avg_exec_time > 1;     -- å¹³å‡æ‰§è¡Œæ—¶é—´è¶…è¿‡1ç§’
```

---

## 7. ğŸ”„ è½¬æ¢è§„åˆ™è¯¦è§£


### 7.1 MySQLç±»å‹è½¬æ¢ä¼˜å…ˆçº§


**ğŸ“‹ è½¬æ¢ä¼˜å…ˆçº§è¡¨**
```
ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼š
1. DECIMAL, NUMERIC
2. DOUBLE, FLOAT, REAL  
3. BIGINT, INT, MEDIUMINT, SMALLINT, TINYINT
4. VARCHAR, CHAR, TEXT
5. BINARY, VARBINARY, BLOB

è½¬æ¢è§„åˆ™ï¼š
ä½ä¼˜å…ˆçº§ç±»å‹ä¼šè½¬æ¢ä¸ºé«˜ä¼˜å…ˆçº§ç±»å‹è¿›è¡Œæ¯”è¾ƒ
```

**ğŸ’¡ å®é™…è½¬æ¢ç¤ºä¾‹**
```sql
-- å­—ç¬¦ä¸² vs æ•°å­—ï¼šå­—ç¬¦ä¸²è½¬æ•°å­—
SELECT '123' = 123;         -- TRUEï¼Œ'123'è½¬æ¢ä¸º123
SELECT 'abc' = 0;           -- TRUEï¼Œ'abc'è½¬æ¢ä¸º0

-- æ—¥æœŸ vs å­—ç¬¦ä¸²ï¼šå­—ç¬¦ä¸²è½¬æ—¥æœŸ
SELECT '2023-09-15' = DATE('2023-09-15');  -- TRUE

-- æ•´æ•° vs æµ®ç‚¹æ•°ï¼šæ•´æ•°è½¬æµ®ç‚¹æ•°
SELECT 1 = 1.0;            -- TRUEï¼Œ1è½¬æ¢ä¸º1.0
```

### 7.2 ç‰¹æ®Šè½¬æ¢è§„åˆ™


**ğŸ¯ è¾¹ç•Œæƒ…å†µå¤„ç†**
```sql
-- NULLå€¼è½¬æ¢
SELECT NULL = 0;            -- NULLï¼ˆä¸æ˜¯FALSEï¼‰
SELECT NULL = '';           -- NULLï¼ˆä¸æ˜¯TRUEï¼‰

-- å¸ƒå°”å€¼è½¬æ¢
SELECT TRUE = 1;            -- TRUE
SELECT FALSE = 0;           -- TRUE
SELECT TRUE = 'true';       -- FALSEï¼Œ'true'è½¬æ¢ä¸º0

-- ç©ºå­—ç¬¦ä¸²è½¬æ¢
SELECT '' = 0;              -- TRUEï¼Œç©ºå­—ç¬¦ä¸²è½¬æ¢ä¸º0
SELECT ' ' = 0;             -- FALSEï¼Œç©ºæ ¼å­—ç¬¦ä¸²è½¬æ¢å¤±è´¥
```

### 7.3 è‡ªå®šä¹‰è½¬æ¢å‡½æ•°


**ğŸ”§ æ˜¾å¼è½¬æ¢å‡½æ•°**
```sql
-- å­—ç¬¦ä¸²è½¬æ¢å‡½æ•°
CAST('123' AS UNSIGNED)     -- è½¬æ¢ä¸ºæ— ç¬¦å·æ•´æ•°
CONVERT('123', SIGNED)      -- è½¬æ¢ä¸ºæœ‰ç¬¦å·æ•´æ•°

-- æ•°å€¼è½¬æ¢å‡½æ•°
FORMAT(1234.567, 2)         -- æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²ï¼š'1,234.57'
ROUND(1234.567, 1)          -- å››èˆäº”å…¥ï¼š1234.6

-- æ—¥æœŸè½¬æ¢å‡½æ•°
STR_TO_DATE('09/15/2023', '%m/%d/%Y')  -- å­—ç¬¦ä¸²è½¬æ—¥æœŸ
DATE_FORMAT(NOW(), '%Y-%m-%d')         -- æ—¥æœŸè½¬å­—ç¬¦ä¸²
```

---

## 8. âœ… æœ€ä½³å®è·µä¸é¢„é˜²


### 8.1 å¼€å‘é˜¶æ®µé¢„é˜²


**ğŸ“ ç¼–ç è§„èŒƒ**
```sql
-- 1. æ•°æ®ç±»å‹ä¸€è‡´æ€§
-- âœ“ æ­£ç¡®ï¼šç±»å‹åŒ¹é…
SELECT * FROM users WHERE id = 123;           -- INT = INT
SELECT * FROM users WHERE name = 'John';      -- VARCHAR = VARCHAR

-- âœ— é¿å…ï¼šç±»å‹ä¸åŒ¹é…  
SELECT * FROM users WHERE id = '123';         -- INT = VARCHAR
SELECT * FROM users WHERE age = '25';         -- INT = VARCHAR

-- 2. å‚æ•°åŒ–æŸ¥è¯¢
-- Javaç¤ºä¾‹
PreparedStatement ps = conn.prepareStatement(
    "SELECT * FROM users WHERE id = ? AND name = ?"
);
ps.setInt(1, userId);      -- æ˜ç¡®è®¾ç½®ä¸ºæ•´æ•°ç±»å‹
ps.setString(2, userName); -- æ˜ç¡®è®¾ç½®ä¸ºå­—ç¬¦ä¸²ç±»å‹
```

**ğŸ¯ è®¾è®¡é˜¶æ®µé¢„é˜²**
```sql
-- 1. åˆç†çš„æ•°æ®ç±»å‹é€‰æ‹©
CREATE TABLE users (
    id BIGINT,              -- ç”¨æˆ·IDç”¨æ•´æ•°ï¼Œä¸ç”¨å­—ç¬¦ä¸²
    phone VARCHAR(11),      -- ç”µè¯å·ç ç”¨å­—ç¬¦ä¸²ï¼ˆå¯èƒ½æœ‰+86å‰ç¼€ï¼‰
    email VARCHAR(100),     -- é‚®ç®±ç”¨å­—ç¬¦ä¸²
    age TINYINT UNSIGNED,   -- å¹´é¾„ç”¨å°æ•´æ•°
    balance DECIMAL(12,2),  -- é‡‘é¢ç”¨DECIMALï¼Œä¸ç”¨FLOAT
    create_time DATETIME    -- æ—¶é—´ç”¨DATETIMEï¼Œä¸ç”¨å­—ç¬¦ä¸²
);

-- 2. æ·»åŠ æ£€æŸ¥çº¦æŸï¼ˆMySQL 8.0+ï¼‰
ALTER TABLE users 
ADD CONSTRAINT chk_phone 
CHECK (phone REGEXP '^[0-9]{11}$');  -- ç¡®ä¿phoneæ ¼å¼æ­£ç¡®
```

### 8.2 ä»£ç å®¡æŸ¥æ£€æŸ¥ç‚¹


**ğŸ” å®¡æŸ¥æ¸…å•**
```
â–¡ WHEREæ¡ä»¶ä¸­çš„æ•°æ®ç±»å‹æ˜¯å¦åŒ¹é…ï¼Ÿ
â–¡ JOINè¿æ¥æ¡ä»¶çš„å­—æ®µç±»å‹æ˜¯å¦ä¸€è‡´ï¼Ÿ
â–¡ æ˜¯å¦ä½¿ç”¨äº†å‚æ•°åŒ–æŸ¥è¯¢ï¼Ÿ
â–¡ æ—¥æœŸæ¯”è¾ƒæ˜¯å¦ä½¿ç”¨æ­£ç¡®æ ¼å¼ï¼Ÿ
â–¡ é‡‘é¢è®¡ç®—æ˜¯å¦ä½¿ç”¨DECIMALç±»å‹ï¼Ÿ
â–¡ æ˜¯å¦å¯¹æŸ¥è¯¢æ¡ä»¶åˆ—ä½¿ç”¨äº†å‡½æ•°ï¼Ÿ
â–¡ å­—ç¬¦ä¸²æ¯”è¾ƒæ˜¯å¦è€ƒè™‘äº†å­—ç¬¦é›†ï¼Ÿ
```

### 8.3 è½¬æ¢æ£€æµ‹å·¥å…·


**ğŸ› ï¸ è‡ªåŠ¨æ£€æµ‹è„šæœ¬**
```sql
-- æ£€æµ‹å¯èƒ½çš„ç±»å‹è½¬æ¢é—®é¢˜
SELECT 
    TABLE_SCHEMA,
    TABLE_NAME,
    COLUMN_NAME,
    DATA_TYPE,
    IS_NULLABLE
FROM information_schema.COLUMNS 
WHERE TABLE_SCHEMA = 'your_database'
  AND DATA_TYPE IN ('varchar', 'char', 'text')
  AND COLUMN_NAME LIKE '%id%';  -- å¯èƒ½è¢«è¯¯ç”¨ä¸ºå­—ç¬¦ä¸²çš„IDå­—æ®µ
```

**ğŸ“Š æ€§èƒ½ç›‘æ§æŸ¥è¯¢**
```sql
-- æ‰¾å‡ºå¯èƒ½å­˜åœ¨ç±»å‹è½¬æ¢çš„æ…¢æŸ¥è¯¢
SELECT 
    sql_text,
    exec_count,
    avg_exec_time,
    total_exec_time
FROM performance_schema.events_statements_summary_by_digest
WHERE sql_text REGEXP 'WHERE.*=.*[0-9]+[^0-9\'"]'  -- æ•°å­—åé¢æ²¡æœ‰å¼•å·
   OR sql_text REGEXP 'WHERE.*=.*\'[0-9]+\''       -- æ•°å­—è¢«å¼•å·åŒ…å›´
ORDER BY avg_exec_time DESC
LIMIT 10;
```

### 8.4 åº”æ€¥å¤„ç†æ–¹æ¡ˆ


**ğŸš¨ å‘ç°é—®é¢˜åçš„å¤„ç†æ­¥éª¤**
```
1. ç«‹å³æªæ–½ï¼š
   - è¯†åˆ«å—å½±å“çš„æŸ¥è¯¢
   - è¯„ä¼°æ€§èƒ½å½±å“èŒƒå›´
   - ä¸´æ—¶æ·»åŠ ç´¢å¼•ï¼ˆå¦‚æœå¯è¡Œï¼‰

2. ä»£ç ä¿®å¤ï¼š
   - ä¿®æ”¹åº”ç”¨ä»£ç ä¸­çš„SQLè¯­å¥
   - ç¡®ä¿å‚æ•°ç±»å‹æ­£ç¡®
   - æ·»åŠ æ˜¾å¼ç±»å‹è½¬æ¢

3. æ•°æ®åº“ä¼˜åŒ–ï¼š  
   - è€ƒè™‘ä¿®æ”¹å­—æ®µç±»å‹ï¼ˆéœ€è¦è°¨æ…ï¼‰
   - æ·»åŠ é€‚å½“çš„ç´¢å¼•
   - ä¼˜åŒ–æŸ¥è¯¢è¯­å¥

4. ç›‘æ§éªŒè¯ï¼š
   - éªŒè¯ä¿®å¤æ•ˆæœ
   - æŒç»­ç›‘æ§æ€§èƒ½æŒ‡æ ‡
   - å»ºç«‹é•¿æœŸç›‘æ§æœºåˆ¶
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ¯ å…³é”®ç†è§£è¦ç‚¹**
```
ğŸ”¸ éšå¼è½¬æ¢æœ¬è´¨ï¼šMySQLè‡ªåŠ¨è¿›è¡Œçš„æ•°æ®ç±»å‹è½¬æ¢ï¼Œå¯èƒ½å¯¼è‡´æ„å¤–ç»“æœ
ğŸ”¸ ä¸»è¦å±å®³ï¼šç´¢å¼•å¤±æ•ˆã€æ€§èƒ½ä¸‹é™ã€æŸ¥è¯¢ç»“æœå¼‚å¸¸ã€ç²¾åº¦ä¸¢å¤±
ğŸ”¸ å¸¸è§åœºæ™¯ï¼šå­—ç¬¦ä¸²â†”æ•°å­—ã€æ—¥æœŸæ ¼å¼è½¬æ¢ã€æµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜
ğŸ”¸ æ£€æµ‹æ–¹æ³•ï¼šEXPLAINåˆ†æã€æ…¢æŸ¥è¯¢æ—¥å¿—ã€Performance Schema
ğŸ”¸ é¢„é˜²ç­–ç•¥ï¼šç±»å‹ä¸€è‡´æ€§ã€å‚æ•°åŒ–æŸ¥è¯¢ã€åˆç†æ•°æ®ç±»å‹è®¾è®¡
```

### 9.2 å®è·µæ“ä½œè¦ç‚¹


**âœ… å¿…åšæ£€æŸ¥**
```
å¼€å‘é˜¶æ®µï¼š
â–¡ ç¡®ä¿WHEREæ¡ä»¶ä¸­çš„æ•°æ®ç±»å‹åŒ¹é…
â–¡ ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢å¹¶æ˜ç¡®å‚æ•°ç±»å‹  
â–¡ é‡‘é¢è®¡ç®—ä½¿ç”¨DECIMALè€ŒéFLOAT
â–¡ æ—¥æœŸæ¯”è¾ƒä½¿ç”¨æ ‡å‡†æ ¼å¼

è¿ç»´é˜¶æ®µï¼š
â–¡ å®šæœŸæ£€æŸ¥æ…¢æŸ¥è¯¢æ—¥å¿—
â–¡ ç›‘æ§ç´¢å¼•ä½¿ç”¨æƒ…å†µ
â–¡ è®¾ç½®æ€§èƒ½å‘Šè­¦é˜ˆå€¼
â–¡ å»ºç«‹é—®é¢˜å¤„ç†æµç¨‹
```

**âŒ ç»å¯¹é¿å…**
```
â€¢ å­—ç¬¦ä¸²å½¢å¼çš„æ•°å­—IDä¸æ•´æ•°æ¯”è¾ƒ
â€¢ å¯¹ç´¢å¼•åˆ—ä½¿ç”¨å‡½æ•°è¿›è¡Œæ¯”è¾ƒ
â€¢ ä¸åŒå­—ç¬¦é›†å­—æ®µä¹‹é—´çš„JOIN
â€¢ FLOATç±»å‹å­˜å‚¨ç²¾ç¡®é‡‘é¢
â€¢ éšæ„çš„æ—¥æœŸæ ¼å¼æ··ç”¨
```

### 9.3 æ•…éšœæ’æŸ¥æ€è·¯


**ğŸ” é—®é¢˜æ’æŸ¥æ­¥éª¤**
```
1. ç—‡çŠ¶è¯†åˆ«ï¼š
   - æŸ¥è¯¢çªç„¶å˜æ…¢
   - CPUä½¿ç”¨ç‡å¼‚å¸¸å‡é«˜
   - æ•°æ®åº“è¿æ¥æ•°æ¿€å¢

2. é—®é¢˜å®šä½ï¼š
   - æŸ¥çœ‹EXPLAINæ‰§è¡Œè®¡åˆ’
   - æ£€æŸ¥æ…¢æŸ¥è¯¢æ—¥å¿—
   - åˆ†æSQLè¯­å¥ç±»å‹è½¬æ¢

3. æ ¹æœ¬åŸå› ï¼š
   - ç¡®è®¤æ•°æ®ç±»å‹ä¸åŒ¹é…
   - æ‰¾å‡ºå¯¼è‡´ç´¢å¼•å¤±æ•ˆçš„æ¡ä»¶
   - è¯„ä¼°æ•°æ®ç²¾åº¦é—®é¢˜

4. è§£å†³æ–¹æ¡ˆï¼š
   - ä¿®æ­£SQLè¯­å¥ç±»å‹åŒ¹é…
   - æ·»åŠ æ˜¾å¼ç±»å‹è½¬æ¢
   - ä¼˜åŒ–æ•°æ®åº“è¡¨ç»“æ„
```

### 9.4 é•¿æœŸä¼˜åŒ–å»ºè®®


**ğŸš€ æŒç»­æ”¹è¿›æ–¹å‘**
- **å›¢é˜ŸåŸ¹è®­**ï¼šæé«˜å¼€å‘äººå‘˜å¯¹ç±»å‹è½¬æ¢é—®é¢˜çš„è®¤è¯†
- **ä»£ç è§„èŒƒ**ï¼šå»ºç«‹SQLç¼–å†™å’Œå®¡æŸ¥æ ‡å‡†
- **è‡ªåŠ¨åŒ–å·¥å…·**ï¼šå¼€å‘è‡ªåŠ¨æ£€æµ‹ç±»å‹è½¬æ¢çš„å·¥å…·
- **ç›‘æ§ä½“ç³»**ï¼šå®Œå–„æ•°æ®åº“æ€§èƒ½ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶
- **æœ€ä½³å®è·µ**ï¼šå½¢æˆé€‚åˆå›¢é˜Ÿçš„å¼€å‘å’Œè¿ç»´æµç¨‹

**æ ¸å¿ƒè®°å¿†**ï¼š
> ç±»å‹åŒ¹é…ç´¢å¼•å¿«ï¼Œè½¬æ¢éšæ‚£æ€§èƒ½å·®  
> å­—ç¬¦æ•°å­—è¦åˆ†æ¸…ï¼Œç²¾åº¦ä¸¢å¤±éœ€è°¨æ…  
> ç›‘æ§æ£€æµ‹æ—©å‘ç°ï¼Œè§„èŒƒé¢„é˜²æœ€é‡è¦