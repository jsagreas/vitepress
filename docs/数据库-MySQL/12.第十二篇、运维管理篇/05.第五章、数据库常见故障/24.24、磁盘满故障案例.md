---
title: 24ã€ç£ç›˜æ»¡æ•…éšœæ¡ˆä¾‹
---
## ðŸ“š ç›®å½•

1. [æ•…éšœæ¦‚è¿°ä¸ŽèƒŒæ™¯](#1-æ•…éšœæ¦‚è¿°ä¸ŽèƒŒæ™¯)
2. [ç£ç›˜æ»¡æ•…éšœçš„å¸¸è§è¡¨çŽ°](#2-ç£ç›˜æ»¡æ•…éšœçš„å¸¸è§è¡¨çŽ°)
3. [ç´§æ€¥å¤„ç†æ–¹æ¡ˆ](#3-ç´§æ€¥å¤„ç†æ–¹æ¡ˆ)
4. [æ·±åº¦æŽ’æŸ¥ä¸Žè§£å†³](#4-æ·±åº¦æŽ’æŸ¥ä¸Žè§£å†³)
5. [é¢„é˜²æœºåˆ¶ä¸Žç›‘æŽ§](#5-é¢„é˜²æœºåˆ¶ä¸Žç›‘æŽ§)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ðŸ“Š æ•…éšœæ¦‚è¿°ä¸ŽèƒŒæ™¯


### 1.1 ä»€ä¹ˆæ˜¯ç£ç›˜æ»¡æ•…éšœ


**ç®€å•ç†è§£**ï¼šå°±åƒå®¶é‡Œçš„è¡£æŸœå¡žæ»¡äº†ï¼Œæ–°è¡£æœæ”¾ä¸è¿›åŽ»ä¸€æ ·ï¼ŒMySQLæœåŠ¡å™¨çš„ç¡¬ç›˜ç©ºé—´ç”¨å®Œäº†ï¼Œæ•°æ®åº“æ— æ³•æ­£å¸¸å†™å…¥æ–°æ•°æ®ã€‚

**æ•…éšœè¡¨çŽ°**ï¼š
- æ•°æ®åº“æ— æ³•å¯åŠ¨æˆ–çªç„¶åœæ­¢
- åº”ç”¨ç¨‹åºæ— æ³•å†™å…¥æ•°æ®
- æ—¥å¿—æ–‡ä»¶åœæ­¢æ›´æ–°
- ç”¨æˆ·æ“ä½œå¤±è´¥æˆ–è¶…æ—¶

### 1.2 ç£ç›˜æ»¡çš„å±å®³ç¨‹åº¦


```
å±å®³ç­‰çº§åˆ†æžï¼š
ðŸ”´ ä¸¥é‡çº§åˆ«ï¼šæ•°æ®åº“å®Œå…¨æ— æ³•å†™å…¥
ðŸŸ¡ è­¦å‘Šçº§åˆ«ï¼šæ€§èƒ½ä¸‹é™ï¼Œå¶å‘å¤±è´¥  
ðŸŸ¢ æ­£å¸¸çº§åˆ«ï¼šç©ºé—´å……è¶³ï¼Œè¿è¡Œæ­£å¸¸

å½±å“èŒƒå›´ï¼š
æ•°æ®å†™å…¥ âŒ â†’ ç”¨æˆ·æ“ä½œå¤±è´¥ âŒ â†’ ä¸šåŠ¡ä¸­æ–­ âŒ
```

### 1.3 æ•…éšœå‘ç”Ÿçš„æ ¹æœ¬åŽŸå› 


**å¸¸è§åŽŸå› æŽ’è¡Œ**ï¼š
1. **binlogæ—¥å¿—æ–‡ä»¶**ä¸æ–­å¢žé•¿ï¼ˆæœ€å¸¸è§ï¼‰
2. **ä¸´æ—¶æ–‡ä»¶**å †ç§¯æœªæ¸…ç†
3. **è¡¨ç©ºé—´æ–‡ä»¶**æ— é™æ‰©å±•
4. **é”™è¯¯æ—¥å¿—**é•¿æœŸç§¯ç´¯
5. **å¤‡ä»½æ–‡ä»¶**å ç”¨å¤§é‡ç©ºé—´

---

## 2. âš ï¸ ç£ç›˜æ»¡æ•…éšœçš„å¸¸è§è¡¨çŽ°


### 2.1 æ•°æ®åº“å±‚é¢çš„ç—‡çŠ¶


**MySQLé”™è¯¯ä¿¡æ¯**ï¼š
```sql
-- å…¸åž‹çš„ç£ç›˜æ»¡é”™è¯¯
ERROR 28 (HY000): No space left on device
ERROR 1114 (HY000): The table is full
ERROR 1030 (HY000): Got error 28 from storage engine
```

**æœåŠ¡çŠ¶æ€å¼‚å¸¸**ï¼š
```bash
# æœåŠ¡æ— æ³•å¯åŠ¨
systemctl status mysql
# çŠ¶æ€æ˜¾ç¤ºï¼šfailed (Result: exit-code)

# æ—¥å¿—ä¸­çš„å…¸åž‹é”™è¯¯
tail /var/log/mysql/error.log
# [ERROR] Can't create/write to file '/tmp/#sql_xxx' (Errcode: 28)
```

### 2.2 ç³»ç»Ÿå±‚é¢çš„è¡¨çŽ°


**ç£ç›˜ç©ºé—´æ£€æŸ¥**ï¼š
```bash
# æŸ¥çœ‹ç£ç›˜ä½¿ç”¨æƒ…å†µ
df -h
# è¾“å‡ºç¤ºä¾‹ï¼š
# /dev/sda1    20G   20G    0  100% /var/lib/mysql

# æŸ¥çœ‹å…·ä½“ç›®å½•å ç”¨
du -sh /var/lib/mysql/*
# mysql-bin.000001    2.0G
# mysql-bin.000002    2.0G
# mysql-bin.000003    2.0G
```

### 2.3 åº”ç”¨å±‚é¢çš„å½±å“


**ç”¨æˆ·ä½“éªŒ**ï¼š
```
æ­£å¸¸æµç¨‹ï¼šç”¨æˆ·æ“ä½œ â†’ æ•°æ®ä¿å­˜ â†’ æ“ä½œæˆåŠŸ
æ•…éšœæµç¨‹ï¼šç”¨æˆ·æ“ä½œ â†’ å†™å…¥å¤±è´¥ â†’ æ“ä½œå¤±è´¥

å…·ä½“è¡¨çŽ°ï¼š
â€¢ æ³¨å†Œç”¨æˆ·å¤±è´¥
â€¢ è®¢å•æ— æ³•æäº¤  
â€¢ è¯„è®ºå‘å¸ƒå¤±è´¥
â€¢ æ•°æ®ä¿®æ”¹ä¸ç”Ÿæ•ˆ
```

---

## 3. ðŸš¨ ç´§æ€¥å¤„ç†æ–¹æ¡ˆ


### 3.1 ç«‹å³é‡Šæ”¾ç©ºé—´çš„æ–¹æ³•


**ðŸ”¥ ç¬¬ä¸€æ­¥ï¼šæ¸…ç†binlogæ—¥å¿—**
```bash
# ç™»å½•MySQL
mysql -u root -p

# æŸ¥çœ‹binlogæ–‡ä»¶
SHOW MASTER LOGS;
# +------------------+-----------+
# | Log_name         | File_size |
# +------------------+-----------+
# | mysql-bin.000001 | 2147483648|
# | mysql-bin.000002 | 2147483648|
# | mysql-bin.000003 |   1048576|
# +------------------+-----------+

# åˆ é™¤æ—§çš„binlogï¼ˆä¿ç•™æœ€è¿‘3å¤©ï¼‰
PURGE MASTER LOGS TO 'mysql-bin.000003';

# æˆ–è€…æŒ‰æ—¶é—´åˆ é™¤
PURGE MASTER LOGS BEFORE DATE_SUB(NOW(), INTERVAL 3 DAY);
```

**ðŸ”§ ç¬¬äºŒæ­¥ï¼šæ¸…ç†ä¸´æ—¶æ–‡ä»¶**
```bash
# æ¸…ç†MySQLä¸´æ—¶ç›®å½•
rm -f /tmp/#sql*
rm -f /var/lib/mysql/#sql*

# æ¸…ç†ç³»ç»Ÿä¸´æ—¶æ–‡ä»¶
find /tmp -name "mysql*" -type f -delete
```

**ðŸ“ ç¬¬ä¸‰æ­¥ï¼šæ¸…ç†å…¶ä»–æ—¥å¿—**
```bash
# æ¸…ç†é”™è¯¯æ—¥å¿—ï¼ˆå¤‡ä»½åŽåˆ é™¤ï¼‰
cp /var/log/mysql/error.log /var/log/mysql/error.log.bak
> /var/log/mysql/error.log

# æ¸…ç†æ…¢æŸ¥è¯¢æ—¥å¿—
cp /var/log/mysql/slow.log /var/log/mysql/slow.log.bak
> /var/log/mysql/slow.log
```

### 3.2 ç´§æ€¥ç©ºé—´é‡Šæ”¾è„šæœ¬


```bash
#!/bin/bash
# ç´§æ€¥ç©ºé—´é‡Šæ”¾è„šæœ¬

echo "å¼€å§‹ç´§æ€¥ç©ºé—´é‡Šæ”¾..."

# æ£€æŸ¥å½“å‰ç£ç›˜ä½¿ç”¨çŽ‡
USAGE=$(df /var/lib/mysql | tail -1 | awk '{print $5}' | sed 's/%//')
echo "å½“å‰ç£ç›˜ä½¿ç”¨çŽ‡: ${USAGE}%"

if [ $USAGE -gt 90 ]; then
    echo "ç£ç›˜ä½¿ç”¨çŽ‡è¶…è¿‡90%ï¼Œå¼€å§‹æ¸…ç†..."
    
    # æ¸…ç†binlogï¼ˆä¿ç•™æœ€è¿‘1å¤©ï¼‰
    mysql -u root -p${MYSQL_PASSWORD} -e "PURGE MASTER LOGS BEFORE DATE_SUB(NOW(), INTERVAL 1 DAY);"
    
    # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
    find /tmp -name "#sql*" -delete 2>/dev/null
    find /var/lib/mysql -name "#sql*" -delete 2>/dev/null
    
    # æ£€æŸ¥æ¸…ç†æ•ˆæžœ
    NEW_USAGE=$(df /var/lib/mysql | tail -1 | awk '{print $5}' | sed 's/%//')
    echo "æ¸…ç†åŽç£ç›˜ä½¿ç”¨çŽ‡: ${NEW_USAGE}%"
    
    if [ $NEW_USAGE -lt 85 ]; then
        echo "ç©ºé—´é‡Šæ”¾æˆåŠŸï¼"
    else
        echo "ç©ºé—´ä»ç„¶ä¸è¶³ï¼Œéœ€è¦è¿›ä¸€æ­¥å¤„ç†"
    fi
fi
```

---

## 4. ðŸ” æ·±åº¦æŽ’æŸ¥ä¸Žè§£å†³


### 4.1 binlogæ—¥å¿—ç®¡ç†


**ç†è§£binlogçš„ä½œç”¨**ï¼š
binlogå°±åƒæ•°æ®åº“çš„"è®°è´¦æœ¬"ï¼Œè®°å½•äº†æ‰€æœ‰çš„æ•°æ®å˜æ›´æ“ä½œï¼Œä¸»è¦ç”¨äºŽæ•°æ®æ¢å¤å’Œä¸»ä»Žå¤åˆ¶ã€‚

**ä¼˜åŒ–binlogè®¾ç½®**ï¼š
```sql
-- æŸ¥çœ‹å½“å‰binlogé…ç½®
SHOW VARIABLES LIKE 'log_bin%';
SHOW VARIABLES LIKE 'expire_logs_days';

-- è®¾ç½®è‡ªåŠ¨æ¸…ç†å¤©æ•°ï¼ˆé‡å¯ç”Ÿæ•ˆï¼‰
-- åœ¨my.cnfä¸­æ·»åŠ ï¼š
[mysqld]
expire_logs_days = 7        # ä¿ç•™7å¤©
max_binlog_size = 100M      # å•æ–‡ä»¶æœ€å¤§100M
```

**æ‰‹åŠ¨ç®¡ç†binlog**ï¼š
```sql
-- æŸ¥çœ‹binlogå ç”¨ç©ºé—´
SELECT 
    ROUND(SUM(File_size)/(1024*1024*1024), 2) AS 'Total Size (GB)'
FROM information_schema.binary_log_files;

-- åˆ é™¤æŒ‡å®šæ—¶é—´å‰çš„æ—¥å¿—
PURGE MASTER LOGS BEFORE '2024-01-01 00:00:00';

-- åˆ é™¤åˆ°æŒ‡å®šæ–‡ä»¶
PURGE MASTER LOGS TO 'mysql-bin.000010';
```

### 4.2 è¡¨ç©ºé—´æ‰©å±•é—®é¢˜


**æ£€æŸ¥è¡¨ç©ºé—´ä½¿ç”¨**ï¼š
```sql
-- æŸ¥çœ‹å„è¡¨çš„ç©ºé—´å ç”¨
SELECT 
    table_schema AS 'æ•°æ®åº“',
    table_name AS 'è¡¨å',
    ROUND((data_length + index_length) / 1024 / 1024, 2) AS 'å¤§å°(MB)'
FROM information_schema.tables 
WHERE table_schema NOT IN ('information_schema', 'performance_schema', 'mysql')
ORDER BY (data_length + index_length) DESC
LIMIT 10;
```

**ä¼˜åŒ–è¡¨ç©ºé—´**ï¼š
```sql
-- ä¼˜åŒ–è¡¨ï¼ˆå›žæ”¶ç¢Žç‰‡ç©ºé—´ï¼‰
OPTIMIZE TABLE your_table_name;

-- ä¿®å¤è¡¨ï¼ˆå¦‚æžœæœ‰é—®é¢˜ï¼‰
REPAIR TABLE your_table_name;

-- åˆ†æžè¡¨ç»Ÿè®¡ä¿¡æ¯
ANALYZE TABLE your_table_name;
```

### 4.3 ä¸´æ—¶æ–‡ä»¶é—®é¢˜æŽ’æŸ¥


**ä¸´æ—¶æ–‡ä»¶äº§ç”ŸåŽŸå› **ï¼š
1. **å¤æ‚æŸ¥è¯¢**ï¼šå¤§é‡JOINã€GROUP BYæ“ä½œ
2. **æŽ’åºæ“ä½œ**ï¼šORDER BYå¤§é‡æ•°æ®
3. **ä¸´æ—¶è¡¨**ï¼šå­æŸ¥è¯¢ã€UNIONæ“ä½œ
4. **è¿›ç¨‹å¼‚å¸¸**ï¼šæŸ¥è¯¢è¢«å¼ºåˆ¶ç»ˆæ­¢

**ä¸´æ—¶æ–‡ä»¶æ¸…ç†**ï¼š
```bash
# æŸ¥æ‰¾MySQLä¸´æ—¶æ–‡ä»¶
find /var/lib/mysql -name "#sql*" -ls
find /tmp -name "#sql*" -ls

# å®‰å…¨æ¸…ç†ï¼ˆç¡®ä¿MySQLä¸åœ¨ä½¿ç”¨ï¼‰
lsof | grep "#sql"  # æ£€æŸ¥æ˜¯å¦æœ‰è¿›ç¨‹åœ¨ä½¿ç”¨

# å¦‚æžœæ²¡æœ‰è¿›ç¨‹ä½¿ç”¨ï¼Œå¯ä»¥åˆ é™¤
find /var/lib/mysql -name "#sql*" -delete
find /tmp -name "#sql*" -delete
```

### 4.4 æ•°æ®ç›®å½•è¿ç§»


**å½“ç©ºé—´å®žåœ¨ä¸å¤Ÿæ—¶çš„è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# 1. åœæ­¢MySQLæœåŠ¡
systemctl stop mysql

# 2. åˆ›å»ºæ–°çš„æ•°æ®ç›®å½•
mkdir -p /new/mysql/data
chown mysql:mysql /new/mysql/data

# 3. å¤åˆ¶æ•°æ®æ–‡ä»¶
cp -R /var/lib/mysql/* /new/mysql/data/

# 4. ä¿®æ”¹é…ç½®æ–‡ä»¶
# ç¼–è¾‘ /etc/mysql/mysql.conf.d/mysqld.cnf
[mysqld]
datadir = /new/mysql/data

# 5. å¯åŠ¨MySQL
systemctl start mysql
```

---

## 5. ðŸ“Š é¢„é˜²æœºåˆ¶ä¸Žç›‘æŽ§


### 5.1 ç£ç›˜ç©ºé—´é¢„è­¦æœºåˆ¶


**ç›‘æŽ§è„šæœ¬è®¾è®¡**ï¼š
```bash
#!/bin/bash
# ç£ç›˜ç©ºé—´ç›‘æŽ§è„šæœ¬

MYSQL_DATA_DIR="/var/lib/mysql"
THRESHOLD=80  # é¢„è­¦é˜ˆå€¼80%
EMAIL="admin@company.com"

# èŽ·å–ç£ç›˜ä½¿ç”¨çŽ‡
USAGE=$(df $MYSQL_DATA_DIR | tail -1 | awk '{print $5}' | sed 's/%//')

if [ $USAGE -gt $THRESHOLD ]; then
    MESSAGE="è­¦å‘Šï¼šMySQLæ•°æ®ç›®å½•ç£ç›˜ä½¿ç”¨çŽ‡å·²è¾¾åˆ° ${USAGE}%"
    
    # å‘é€é‚®ä»¶å‘Šè­¦
    echo "$MESSAGE" | mail -s "MySQLç£ç›˜ç©ºé—´å‘Šè­¦" $EMAIL
    
    # è®°å½•æ—¥å¿—
    echo "$(date): $MESSAGE" >> /var/log/mysql-disk-monitor.log
    
    # å¦‚æžœè¶…è¿‡90%ï¼Œè‡ªåŠ¨æ¸…ç†
    if [ $USAGE -gt 90 ]; then
        echo "$(date): å¼€å§‹è‡ªåŠ¨æ¸…ç†binlog" >> /var/log/mysql-disk-monitor.log
        mysql -u monitor -p${MONITOR_PASSWORD} -e "PURGE MASTER LOGS BEFORE DATE_SUB(NOW(), INTERVAL 3 DAY);"
    fi
fi
```

**å®šæ—¶ä»»åŠ¡è®¾ç½®**ï¼š
```bash
# ç¼–è¾‘crontab
crontab -e

# æ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡ç£ç›˜ç©ºé—´
0 * * * * /usr/local/bin/mysql-disk-monitor.sh

# æ¯å¤©å‡Œæ™¨2ç‚¹è‡ªåŠ¨æ¸…ç†7å¤©å‰çš„binlog
0 2 * * * mysql -u root -p${ROOT_PASSWORD} -e "PURGE MASTER LOGS BEFORE DATE_SUB(NOW(), INTERVAL 7 DAY);"
```

### 5.2 è‡ªåŠ¨æ¸…ç†è„šæœ¬è®¾è®¡


**æ™ºèƒ½æ¸…ç†è„šæœ¬**ï¼š
```bash
#!/bin/bash
# MySQLæ™ºèƒ½æ¸…ç†è„šæœ¬

CONFIG_FILE="/etc/mysql-cleanup.conf"
LOG_FILE="/var/log/mysql-cleanup.log"

# è¯»å–é…ç½®
source $CONFIG_FILE

log_message() {
    echo "$(date '+%Y-%m-%d %H:%M:%S'): $1" >> $LOG_FILE
}

cleanup_binlog() {
    log_message "å¼€å§‹æ¸…ç†binlogæ–‡ä»¶"
    
    # èŽ·å–å½“å‰binlogæ•°é‡
    BINLOG_COUNT=$(mysql -u $DB_USER -p$DB_PASS -e "SHOW MASTER LOGS;" | wc -l)
    
    if [ $BINLOG_COUNT -gt $MAX_BINLOG_FILES ]; then
        mysql -u $DB_USER -p$DB_PASS -e "PURGE MASTER LOGS BEFORE DATE_SUB(NOW(), INTERVAL $BINLOG_KEEP_DAYS DAY);"
        log_message "binlogæ¸…ç†å®Œæˆ"
    fi
}

cleanup_temp_files() {
    log_message "å¼€å§‹æ¸…ç†ä¸´æ—¶æ–‡ä»¶"
    
    TEMP_FILES=$(find /tmp /var/lib/mysql -name "#sql*" 2>/dev/null | wc -l)
    if [ $TEMP_FILES -gt 0 ]; then
        find /tmp /var/lib/mysql -name "#sql*" -mtime +1 -delete 2>/dev/null
        log_message "æ¸…ç†ä¸´æ—¶æ–‡ä»¶ $TEMP_FILES ä¸ª"
    fi
}

# é…ç½®æ–‡ä»¶ç¤ºä¾‹ï¼š/etc/mysql-cleanup.conf
cat > /etc/mysql-cleanup.conf << 'EOF'
DB_USER="cleanup_user"
DB_PASS="cleanup_password"
MAX_BINLOG_FILES=10
BINLOG_KEEP_DAYS=7
DISK_WARNING_THRESHOLD=80
DISK_CRITICAL_THRESHOLD=90
EOF
```

### 5.3 å­˜å‚¨æ‰©å®¹ç­–ç•¥


**æ‰©å®¹æ–¹æ¡ˆå¯¹æ¯”**ï¼š

| æ–¹æ¡ˆ | **ä¼˜ç‚¹** | **ç¼ºç‚¹** | **é€‚ç”¨åœºæ™¯** |
|------|----------|----------|-------------|
| **åœ¨çº¿æ‰©å®¹** | æ— éœ€åœæœº | éœ€è¦æ”¯æŒçš„å­˜å‚¨ | äº‘çŽ¯å¢ƒ |
| **æ•°æ®è¿ç§»** | çµæ´»æ€§é«˜ | éœ€è¦åœæœºæ—¶é—´ | ç‰©ç†æœº |
| **åˆ†åº“åˆ†è¡¨** | æ ¹æœ¬è§£å†³ | åº”ç”¨æ”¹é€ å¤§ | é•¿æœŸæ–¹æ¡ˆ |

**åœ¨çº¿æ‰©å®¹ç¤ºä¾‹ï¼ˆLVMï¼‰**ï¼š
```bash
# 1. æ‰©å±•ç‰©ç†å·
pvcreate /dev/sdb2
vgextend mysql_vg /dev/sdb2

# 2. æ‰©å±•é€»è¾‘å·
lvextend -l +100%FREE /dev/mysql_vg/mysql_lv

# 3. æ‰©å±•æ–‡ä»¶ç³»ç»Ÿ
resize2fs /dev/mysql_vg/mysql_lv  # ext4
xfs_growfs /var/lib/mysql         # xfs
```

---

## 6. ðŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŽŒæ¡çš„å¤„ç†æµç¨‹


```
æ•…éšœå¤„ç†æ ‡å‡†æµç¨‹ï¼š
ðŸš¨ å‘çŽ°é—®é¢˜ â†’ ðŸ” å¿«é€Ÿè¯Šæ–­ â†’ ðŸš‘ ç´§æ€¥å¤„ç† â†’ ðŸ”§ æ·±å…¥è§£å†³ â†’ ðŸ“Š é¢„é˜²ç›‘æŽ§

å…·ä½“æ­¥éª¤ï¼š
1ï¸âƒ£ ç¡®è®¤ç£ç›˜æ»¡ï¼šdf -h æ£€æŸ¥ç©ºé—´
2ï¸âƒ£ è¯†åˆ«å ç”¨å¤§æˆ·ï¼šdu -sh æ‰¾å‡ºé—®é¢˜
3ï¸âƒ£ ç´§æ€¥é‡Šæ”¾ç©ºé—´ï¼šæ¸…ç†binlog/ä¸´æ—¶æ–‡ä»¶  
4ï¸âƒ£ æ¢å¤æœåŠ¡è¿è¡Œï¼šé‡å¯MySQLæœåŠ¡
5ï¸âƒ£ å»ºç«‹ç›‘æŽ§æœºåˆ¶ï¼šé˜²æ­¢å†æ¬¡å‘ç”Ÿ
```

### 6.2 å…³é”®æŠ€æœ¯è¦ç‚¹


**ðŸ”¸ binlogç®¡ç†**ï¼š
- è®¾ç½®åˆç†çš„ä¿ç•™å¤©æ•°ï¼ˆ7-30å¤©ï¼‰
- é™åˆ¶å•ä¸ªæ–‡ä»¶å¤§å°ï¼ˆ100M-1Gï¼‰
- å®šæœŸè‡ªåŠ¨æ¸…ç†è¿‡æœŸæ–‡ä»¶

**ðŸ”¸ ç©ºé—´ç›‘æŽ§**ï¼š
- è®¾ç½®80%é¢„è­¦ã€90%å‘Šè­¦é˜ˆå€¼
- å»ºç«‹è‡ªåŠ¨æ¸…ç†æœºåˆ¶
- é…ç½®é‚®ä»¶/çŸ­ä¿¡é€šçŸ¥

**ðŸ”¸ ä¸´æ—¶æ–‡ä»¶**ï¼š
- å®šæœŸæ¸…ç†#sql*æ–‡ä»¶
- ä¼˜åŒ–å¤æ‚æŸ¥è¯¢å‡å°‘ä¸´æ—¶è¡¨
- ç›‘æŽ§tmpç›®å½•ä½¿ç”¨æƒ…å†µ

### 6.3 é¢„é˜²æŽªæ–½


**ðŸ“Š æ—¥å¸¸ç›‘æŽ§æŒ‡æ ‡**ï¼š
```bash
# æ¯æ—¥æ£€æŸ¥æ¸…å•
âœ… ç£ç›˜ä½¿ç”¨çŽ‡ < 80%
âœ… binlogæ–‡ä»¶æ•°é‡ < 50ä¸ª  
âœ… ä¸´æ—¶æ–‡ä»¶å¤§å° < 1GB
âœ… é”™è¯¯æ—¥å¿—å¤§å° < 100MB
âœ… æ…¢æŸ¥è¯¢æ—¥å¿—å¤§å° < 100MB
```

**ðŸ”§ é…ç½®ä¼˜åŒ–å»ºè®®**ï¼š
```sql
-- æŽ¨èçš„MySQLé…ç½®
[mysqld]
expire_logs_days = 7           # è‡ªåŠ¨æ¸…ç†binlog
max_binlog_size = 100M         # é™åˆ¶binlogå¤§å°
innodb_file_per_table = ON     # ç‹¬ç«‹è¡¨ç©ºé—´
log_error_verbosity = 2        # æŽ§åˆ¶é”™è¯¯æ—¥å¿—è¯¦ç»†ç¨‹åº¦
```

### 6.4 åº”æ€¥å¤„ç†è®°å¿†å£è¯€


```
ðŸ’¡ æ•…éšœå¤„ç†å£è¯€ï¼š
"ç©ºé—´æ»¡äº†åˆ«æ…Œå¼ ï¼Œbinlogæ¸…ç†æ˜¯è‰¯æ–¹"
"ä¸´æ—¶æ–‡ä»¶è¦åˆ é™¤ï¼Œé‡å¯æœåŠ¡ä¿å¥åº·" 
"ç›‘æŽ§é¢„è­¦è¦åšå¥½ï¼Œé˜²æ‚£æœªç„¶æœ€é‡è¦"

ðŸŽ¯ å…³é”®å‘½ä»¤é€Ÿè®°ï¼š
df -h           # æŸ¥çœ‹ç©ºé—´
PURGE MASTER LOGS  # æ¸…ç†binlog  
rm -f /tmp/#sql*   # åˆ ä¸´æ—¶æ–‡ä»¶
systemctl restart mysql # é‡å¯æœåŠ¡
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- ç£ç›˜æ»¡æ•…éšœ80%æ˜¯binlogæ—¥å¿—å¯¼è‡´çš„
- ç´§æ€¥æƒ…å†µä¸‹å…ˆæ¸…ç†binlogä¿è¯æœåŠ¡æ­£å¸¸
- é¢„é˜²èƒœäºŽæ²»ç–—ï¼Œç›‘æŽ§æœºåˆ¶æ˜¯å…³é”®
- å®šæœŸç»´æŠ¤å’Œç©ºé—´è§„åˆ’é¿å…æ•…éšœå‘ç”Ÿ