---
title: 3ã€ç³»ç»Ÿå‚æ•°ä¼˜åŒ–
---
## ğŸ“š ç›®å½•

1. [ç³»ç»Ÿå‚æ•°ä¼˜åŒ–æ¦‚è¿°](#1-ç³»ç»Ÿå‚æ•°ä¼˜åŒ–æ¦‚è¿°)
2. [å†…æ ¸å‚æ•°è°ƒä¼˜](#2-å†…æ ¸å‚æ•°è°ƒä¼˜)
3. [æ–‡ä»¶ç³»ç»Ÿä¸IOä¼˜åŒ–](#3-æ–‡ä»¶ç³»ç»Ÿä¸IOä¼˜åŒ–)
4. [ç½‘ç»œå‚æ•°ä¼˜åŒ–](#4-ç½‘ç»œå‚æ•°ä¼˜åŒ–)
5. [å†…å­˜ç®¡ç†ä¼˜åŒ–](#5-å†…å­˜ç®¡ç†ä¼˜åŒ–)
6. [èµ„æºé™åˆ¶é…ç½®](#6-èµ„æºé™åˆ¶é…ç½®)
7. [ç³»ç»ŸæœåŠ¡ä¼˜åŒ–](#7-ç³»ç»ŸæœåŠ¡ä¼˜åŒ–)
8. [ç¯å¢ƒç‰¹åŒ–ä¼˜åŒ–](#8-ç¯å¢ƒç‰¹åŒ–ä¼˜åŒ–)
9. [å‚æ•°ç®¡ç†ä¸ç›‘æ§](#9-å‚æ•°ç®¡ç†ä¸ç›‘æ§)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ç³»ç»Ÿå‚æ•°ä¼˜åŒ–æ¦‚è¿°


### 1.1 ä¸ºä»€ä¹ˆéœ€è¦ç³»ç»Ÿå‚æ•°ä¼˜åŒ–


**ğŸ’¡ æ ¸å¿ƒç†è§£**
```
ç³»ç»Ÿå‚æ•°ä¼˜åŒ–å°±åƒç»™MySQLçš„"æˆ¿å­"è¿›è¡Œè£…ä¿®
- é»˜è®¤å‚æ•°ï¼šæ¯›å¯æˆ¿ï¼Œèƒ½ä½ä½†ä¸èˆ’é€‚
- ä¼˜åŒ–å‚æ•°ï¼šç²¾è£…æˆ¿ï¼Œæ€§èƒ½æ›´å¥½ä½“éªŒæ›´ä½³
```

**ğŸ” ä¼˜åŒ–çš„æœ¬è´¨æ„ä¹‰**
- **æ€§èƒ½æå‡**ï¼šè®©MySQLè·‘å¾—æ›´å¿«æ›´ç¨³å®š
- **èµ„æºåˆ©ç”¨**ï¼šå……åˆ†å‘æŒ¥ç¡¬ä»¶æ€§èƒ½
- **ç¨³å®šæ€§ä¿éšœ**ï¼šå‡å°‘ç³»ç»Ÿå´©æºƒå’Œå¼‚å¸¸
- **å®¹é‡æ‰©å±•**ï¼šæ”¯æŒæ›´å¤§çš„å¹¶å‘å’Œæ•°æ®é‡

### 1.2 ä¼˜åŒ–å‚æ•°çš„åˆ†ç±»ä½“ç³»


```
ç³»ç»Ÿå‚æ•°ä¼˜åŒ–æ¶æ„å›¾ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            MySQL æ•°æ®åº“              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          åº”ç”¨ç¨‹åºå±‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      æ“ä½œç³»ç»Ÿå†…æ ¸å‚æ•°å±‚               â”‚ â† æˆ‘ä»¬ä¼˜åŒ–çš„é‡ç‚¹
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ å†…å­˜ç®¡ç† â”‚ IOè°ƒåº¦  â”‚ ç½‘ç»œæ ˆ  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           ç¡¬ä»¶èµ„æºå±‚                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   CPU   â”‚  å†…å­˜   â”‚  ç£ç›˜   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ“‹ ä¼˜åŒ–å‚æ•°çš„å››å¤§ç±»åˆ«**

| ç±»åˆ« | ä¸»è¦ä½œç”¨ | å…¸å‹å‚æ•° | å½±å“èŒƒå›´ |
|------|----------|----------|----------|
| ğŸ§  **å†…å­˜ç®¡ç†** | æ§åˆ¶å†…å­˜åˆ†é…å’Œå›æ”¶ | `vm.swappiness`ã€`kernel.shmmax` | æ•´ä½“æ€§èƒ½ |
| ğŸ’¾ **IOè°ƒåº¦** | ä¼˜åŒ–ç£ç›˜è¯»å†™æ•ˆç‡ | `deadline`ã€`noop` | æ•°æ®è¯»å†™ |
| ğŸŒ **ç½‘ç»œä¼˜åŒ–** | æå‡ç½‘ç»œè¿æ¥æ€§èƒ½ | `net.core.somaxconn` | è¿æ¥å¤„ç† |
| ğŸ“ **æ–‡ä»¶ç³»ç»Ÿ** | ç®¡ç†æ–‡ä»¶å¥æŸ„èµ„æº | `fs.file-max`ã€`ulimit` | æ–‡ä»¶æ“ä½œ |

---

## 2. âš™ï¸ å†…æ ¸å‚æ•°è°ƒä¼˜


### 2.1 å†…å­˜å›æ”¶ç­–ç•¥ä¼˜åŒ–


**ğŸ”¸ vm.swappiness å‚æ•°è¯¦è§£**

**ä»€ä¹ˆæ˜¯ swappinessï¼Ÿ**
```
ç®€å•ç†è§£ï¼šå†…å­˜ä¸å¤Ÿç”¨æ—¶ï¼Œç³»ç»Ÿçš„"å–èˆç­–ç•¥"
- å€¼è¶Šé«˜ï¼šè¶Šå€¾å‘äºæŠŠå†…å­˜æ•°æ®å†™åˆ°ç¡¬ç›˜(swap)
- å€¼è¶Šä½ï¼šè¶Šå€¾å‘äºé‡Šæ”¾ç¼“å­˜æ¥è…¾å‡ºå†…å­˜
```

**ğŸ’¾ swappiness å·¥ä½œåŸç†å›¾**
```
å†…å­˜ä½¿ç”¨æƒ…å†µå¯¹æ¯”ï¼š

é«˜ swappiness (é»˜è®¤60):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åº”ç”¨ç¨‹åºå†…å­˜ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 60%  â”‚
â”‚ ç³»ç»Ÿç¼“å­˜     â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 30%  â”‚  
â”‚ Swapä½¿ç”¨     â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 15%  â”‚ â† é¢‘ç¹äº¤æ¢ï¼Œæ€§èƒ½å·®
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä½ swappiness (æ¨è1-10):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åº”ç”¨ç¨‹åºå†…å­˜ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 80%  â”‚
â”‚ ç³»ç»Ÿç¼“å­˜     â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 15%  â”‚
â”‚ Swapä½¿ç”¨     â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  1%  â”‚ â† å‡ ä¹ä¸ç”¨swapï¼Œæ€§èƒ½å¥½
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”§ ä¼˜åŒ–é…ç½®ç¤ºä¾‹**
```bash
# æŸ¥çœ‹å½“å‰è®¾ç½®
cat /proc/sys/vm/swappiness

# ä¸´æ—¶è®¾ç½®ï¼ˆé‡å¯å¤±æ•ˆï¼‰
echo 1 > /proc/sys/vm/swappiness

# æ°¸ä¹…è®¾ç½®ï¼ˆæ¨èï¼‰
echo "vm.swappiness = 1" >> /etc/sysctl.conf
```

> ğŸ’¡ **ä¸ºä»€ä¹ˆè®¾ç½®ä¸º1è€Œä¸æ˜¯0ï¼Ÿ**
> 
> è®¾ç½®ä¸º0åœ¨æŸäº›å†…æ ¸ç‰ˆæœ¬ä¸­å¯èƒ½å¯¼è‡´OOMï¼ˆå†…å­˜ä¸è¶³æ€è¿›ç¨‹ï¼‰ï¼Œè®¾ç½®ä¸º1æ˜¯æœ€å®‰å…¨çš„é€‰æ‹©

### 2.2 å…±äº«å†…å­˜é…ç½®


**ğŸ”¸ kernel.shmmax å‚æ•°è¯¦è§£**

**ä»€ä¹ˆæ˜¯å…±äº«å†…å­˜ï¼Ÿ**
```
æƒ³è±¡æˆä¸€ä¸ª"å…¬å…±ä»“åº“"ï¼š
- å¤šä¸ªMySQLè¿›ç¨‹å¯ä»¥å…±äº«ä½¿ç”¨
- é¿å…é‡å¤å­˜å‚¨ç›¸åŒæ•°æ®
- æé«˜å†…å­˜åˆ©ç”¨æ•ˆç‡
```

**ğŸ“Š å…±äº«å†…å­˜å¤§å°è®¡ç®—**
```
æ¨èé…ç½®å…¬å¼ï¼š
kernel.shmmax = ç‰©ç†å†…å­˜ Ã— 0.8

ç¤ºä¾‹è®¡ç®—ï¼š
æœåŠ¡å™¨å†…å­˜: 32GB
æ¨èè®¾ç½®: 32GB Ã— 0.8 = 25.6GB = 27487790694 å­—èŠ‚
```

**ğŸ”§ é…ç½®ç¤ºä¾‹**
```bash
# æŸ¥çœ‹å½“å‰é™åˆ¶
cat /proc/sys/kernel/shmmax

# è®¾ç½®å…±äº«å†…å­˜å¤§å°ï¼ˆ32GBæœåŠ¡å™¨ç¤ºä¾‹ï¼‰
echo "kernel.shmmax = 27487790694" >> /etc/sysctl.conf
echo "kernel.shmall = 6710886" >> /etc/sysctl.conf
```

### 2.3 é€æ˜å¤§é¡µè®¾ç½®


**ğŸ”¸ ä»€ä¹ˆæ˜¯é€æ˜å¤§é¡µï¼ˆTHPï¼‰ï¼Ÿ**

**é€šä¿—è§£é‡Š**
```
æ™®é€šå†…å­˜é¡µï¼š4KB ä¸€é¡µï¼ˆåƒä¾¿åˆ©è´´ï¼‰
å¤§é¡µå†…å­˜ï¼š2MB ä¸€é¡µï¼ˆåƒA4çº¸ï¼‰

é€æ˜å¤§é¡µçš„é—®é¢˜ï¼š
- è‡ªåŠ¨åˆå¹¶å°é¡µä¸ºå¤§é¡µ
- ä½†MySQLæ›´å–œæ¬¢å°é¡µçš„çµæ´»æ€§
- å¯èƒ½å¯¼è‡´å†…å­˜ç¢ç‰‡å’Œå»¶è¿Ÿ
```

**âš ï¸ ä¸ºä»€ä¹ˆMySQLè¦å…³é—­THPï¼Ÿ**
```
MySQLçš„å·¥ä½œç‰¹ç‚¹ï¼š
â””â”€â”€ é¢‘ç¹çš„å°å—å†…å­˜åˆ†é…å’Œé‡Šæ”¾
    â”œâ”€â”€ THPä¼šå°è¯•åˆå¹¶å†…å­˜é¡µ
    â”œâ”€â”€ åˆå¹¶è¿‡ç¨‹æ¶ˆè€—CPUæ—¶é—´
    â””â”€â”€ å¯¼è‡´æŸ¥è¯¢å»¶è¿Ÿå¢åŠ 
```

**ğŸ”§ å…³é—­é€æ˜å¤§é¡µ**
```bash
# æŸ¥çœ‹å½“å‰çŠ¶æ€
cat /sys/kernel/mm/transparent_hugepage/enabled

# ä¸´æ—¶å…³é—­
echo never > /sys/kernel/mm/transparent_hugepage/enabled
echo never > /sys/kernel/mm/transparent_hugepage/defrag

# æ°¸ä¹…å…³é—­ï¼ˆå¼€æœºè‡ªåŠ¨æ‰§è¡Œï¼‰
echo 'echo never > /sys/kernel/mm/transparent_hugepage/enabled' >> /etc/rc.local
echo 'echo never > /sys/kernel/mm/transparent_hugepage/defrag' >> /etc/rc.local
```

---

## 3. ğŸ’¾ æ–‡ä»¶ç³»ç»Ÿä¸IOä¼˜åŒ–


### 3.1 æ–‡ä»¶æè¿°ç¬¦é™åˆ¶ä¼˜åŒ–


**ğŸ”¸ ä»€ä¹ˆæ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼Ÿ**

**ç”Ÿæ´»åŒ–ç†è§£**
```
æ–‡ä»¶æè¿°ç¬¦ = ç³»ç»Ÿçš„"æ‰‹"
- æ¯æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶éœ€è¦ä¸€åª"æ‰‹"
- é»˜è®¤æƒ…å†µä¸‹ç³»ç»Ÿåªæœ‰1024åª"æ‰‹"
- MySQLéœ€è¦å¤§é‡"æ‰‹"æ¥å¤„ç†å¹¶å‘è¿æ¥
```

**ğŸ“Š æ–‡ä»¶æè¿°ç¬¦ä½¿ç”¨åœºæ™¯**
```
MySQLä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦çš„åœ°æ–¹ï¼š
â”œâ”€â”€ æ•°æ®åº“è¡¨æ–‡ä»¶ (.frm, .ibd)
â”œâ”€â”€ æ—¥å¿—æ–‡ä»¶ (binlog, error log)  
â”œâ”€â”€ ä¸´æ—¶æ–‡ä»¶ (æ’åºã€è¿æ¥æ“ä½œ)
â”œâ”€â”€ ç½‘ç»œè¿æ¥ (æ¯ä¸ªå®¢æˆ·ç«¯è¿æ¥)
â””â”€â”€ ç³»ç»Ÿæ–‡ä»¶ (é…ç½®æ–‡ä»¶ç­‰)

è®¡ç®—å…¬å¼ï¼š
æ‰€éœ€æ–‡ä»¶æè¿°ç¬¦ â‰ˆ æœ€å¤§è¿æ¥æ•° Ã— 2 + æ‰“å¼€è¡¨æ•° + 1000(ç¼“å†²)
```

**ğŸ”§ fs.file-max ä¼˜åŒ–é…ç½®**
```bash
# æŸ¥çœ‹å½“å‰ç³»ç»Ÿé™åˆ¶
cat /proc/sys/fs/file-max

# æŸ¥çœ‹å½“å‰ä½¿ç”¨æƒ…å†µ
cat /proc/sys/fs/file-nr

# ä¼˜åŒ–é…ç½®ï¼ˆæ ¹æ®æœåŠ¡å™¨è§„æ¨¡è°ƒæ•´ï¼‰
echo "fs.file-max = 6553600" >> /etc/sysctl.conf
```

### 3.2 ç”¨æˆ·çº§æ–‡ä»¶æè¿°ç¬¦é™åˆ¶


**ğŸ”¸ /etc/security/limits.conf é…ç½®**

**ç†è§£ ulimit çš„ä½œç”¨**
```
ç³»ç»Ÿçº§é™åˆ¶ï¼šfs.file-maxï¼ˆæ•´ä¸ªç³»ç»Ÿçš„æ€»é™åˆ¶ï¼‰
    â†“
ç”¨æˆ·çº§é™åˆ¶ï¼šulimitï¼ˆå•ä¸ªç”¨æˆ·çš„é™åˆ¶ï¼‰
    â†“  
è¿›ç¨‹çº§é™åˆ¶ï¼šæ¯ä¸ªMySQLè¿›ç¨‹çš„å®é™…ä½¿ç”¨
```

**ğŸ“‹ å®Œæ•´çš„ limits.conf é…ç½®**
```bash
# ç¼–è¾‘æ–‡ä»¶
vim /etc/security/limits.conf

# æ·»åŠ ä»¥ä¸‹é…ç½®
mysql soft nofile 65535
mysql hard nofile 65535
mysql soft nproc 65535  
mysql hard nproc 65535
mysql soft memlock unlimited
mysql hard memlock unlimited

# æ‰€æœ‰ç”¨æˆ·çš„é…ç½®ï¼ˆå¯é€‰ï¼‰
* soft nofile 65535
* hard nofile 65535
```

**ğŸ” é…ç½®é¡¹å«ä¹‰è§£é‡Š**
| é…ç½®é¡¹ | å«ä¹‰ | æ¨èå€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `nofile` | æ‰“å¼€æ–‡ä»¶æ•°é™åˆ¶ | 65535 | å•è¿›ç¨‹æœ€å¤§æ–‡ä»¶æè¿°ç¬¦ |
| `nproc` | è¿›ç¨‹æ•°é™åˆ¶ | 65535 | ç”¨æˆ·æœ€å¤§è¿›ç¨‹æ•° |
| `memlock` | å†…å­˜é”å®šé™åˆ¶ | unlimited | å…è®¸é”å®šæ›´å¤šå†…å­˜ |

### 3.3 IOè°ƒåº¦ç­–ç•¥ä¼˜åŒ–


**ğŸ”¸ IOè°ƒåº¦å™¨çš„ä½œç”¨**

**é€šä¿—ç†è§£**
```
IOè°ƒåº¦å™¨ = ç”µæ¢¯è°ƒåº¦ç³»ç»Ÿ
- CFQ: å®Œå…¨å…¬å¹³è°ƒåº¦ï¼ˆé»˜è®¤ï¼‰ï¼Œåƒæ™®é€šç”µæ¢¯ï¼Œç…§é¡¾æ‰€æœ‰äºº
- Deadline: æˆªæ­¢æ—¶é—´è°ƒåº¦ï¼ŒåƒVIPç”µæ¢¯ï¼Œä¿è¯å“åº”æ—¶é—´
- Noop: æ— æ“ä½œè°ƒåº¦ï¼Œåƒç›´è¾¾ç”µæ¢¯ï¼Œé€‚åˆSSD
```

**ğŸ’¿ ä¸åŒå­˜å‚¨è®¾å¤‡çš„è°ƒåº¦å™¨é€‰æ‹©**
```
å­˜å‚¨è®¾å¤‡ç±»å‹ä¸è°ƒåº¦å™¨åŒ¹é…ï¼š

æœºæ¢°ç¡¬ç›˜(HDD):
â”œâ”€â”€ ç‰¹ç‚¹ï¼šå¯»é“æ—¶é—´é•¿ï¼Œé¡ºåºè¯»å†™å¿«
â”œâ”€â”€ æ¨èï¼šdeadline è°ƒåº¦å™¨
â””â”€â”€ åŸå› ï¼šå¯ä»¥åˆå¹¶é‚»è¿‘çš„IOè¯·æ±‚

å›ºæ€ç¡¬ç›˜(SSD):
â”œâ”€â”€ ç‰¹ç‚¹ï¼šéšæœºè®¿é—®å¿«ï¼Œæ— å¯»é“æ—¶é—´
â”œâ”€â”€ æ¨èï¼šnoop è°ƒåº¦å™¨
â””â”€â”€ åŸå› ï¼šä¸éœ€è¦å¤æ‚çš„IOé‡æ’åº

RAIDé˜µåˆ—:
â”œâ”€â”€ ç‰¹ç‚¹ï¼šå¤šç£ç›˜å¹¶è¡Œï¼Œå¤æ‚çš„IOæ¨¡å¼
â”œâ”€â”€ æ¨èï¼šdeadline è°ƒåº¦å™¨
â””â”€â”€ åŸå› ï¼šä¿è¯å•ä¸ªè¯·æ±‚çš„å“åº”æ—¶é—´
```

**ğŸ”§ IOè°ƒåº¦å™¨é…ç½®**
```bash
# æŸ¥çœ‹å½“å‰è°ƒåº¦å™¨
cat /sys/block/sda/queue/scheduler

# ä¸´æ—¶æ›´æ”¹ï¼ˆé‡å¯å¤±æ•ˆï¼‰
echo deadline > /sys/block/sda/queue/scheduler

# æ°¸ä¹…æ›´æ”¹ï¼ˆGRUBé…ç½®ï¼‰
vim /etc/default/grub
# åœ¨GRUB_CMDLINE_LINUXä¸­æ·»åŠ ï¼š
GRUB_CMDLINE_LINUX="elevator=deadline"

# æ›´æ–°GRUBé…ç½®
grub2-mkconfig -o /boot/grub2/grub.cfg
```

**ğŸ“Š è°ƒåº¦å™¨æ€§èƒ½å¯¹æ¯”**
```
æ€§èƒ½æµ‹è¯•ç»“æœï¼ˆMySQL OLTPåœºæ™¯ï¼‰ï¼š

Deadlineè°ƒåº¦å™¨:
éšæœºè¯»å–: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100%
éšæœºå†™å…¥: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 90%
å“åº”æ—¶é—´: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 85%

CFQè°ƒåº¦å™¨:
éšæœºè¯»å–: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 75%
éšæœºå†™å…¥: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 80%
å“åº”æ—¶é—´: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 65%

Noopè°ƒåº¦å™¨(SSD):
éšæœºè¯»å–: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100%
éšæœºå†™å…¥: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100%
å“åº”æ—¶é—´: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100%
```

---

## 4. ğŸŒ ç½‘ç»œå‚æ•°ä¼˜åŒ–


### 4.1 è¿æ¥é˜Ÿåˆ—ä¼˜åŒ–


**ğŸ”¸ net.core.somaxconn å‚æ•°è¯¦è§£**

**ä»€ä¹ˆæ˜¯è¿æ¥é˜Ÿåˆ—ï¼Ÿ**
```
è¿æ¥é˜Ÿåˆ—å°±åƒé¤å…çš„ç­‰ä½åŒºï¼š
- å®¢æˆ·ç«¯å‘èµ·è¿æ¥ = å®¢äººåˆ°è¾¾é¤å…
- somaxconn = ç­‰ä½åŒºçš„åº§ä½æ•°
- é˜Ÿåˆ—æ»¡äº† = æ–°å®¢äººè¢«æ‹’ç»å…¥å†…
```

**ğŸ”„ TCPè¿æ¥å»ºç«‹è¿‡ç¨‹**
```
å®¢æˆ·ç«¯è¿æ¥MySQLçš„å®Œæ•´æµç¨‹ï¼š

å®¢æˆ·ç«¯                    MySQLæœåŠ¡å™¨
   |                          |
   |--[1] SYN è¯·æ±‚----------->|
   |                          |-- æ”¾å…¥SYNé˜Ÿåˆ—
   |<-[2] SYN+ACK åº”ç­”--------|
   |                          |
   |--[3] ACK ç¡®è®¤----------->|
   |                          |-- ç§»å…¥ACCEPTé˜Ÿåˆ— â† somaxconnæ§åˆ¶è¿™é‡Œ
   |                          |-- MySQLè¿›ç¨‹accept()è·å–è¿æ¥
   |<=[4] å»ºç«‹è¿æ¥å®Œæˆ=======>|
```

**âš ï¸ è¿æ¥é˜Ÿåˆ—è¿‡å°çš„é—®é¢˜**
```
é—®é¢˜ç°è±¡ï¼š
â”œâ”€â”€ é«˜å¹¶å‘æ—¶è¿æ¥è¢«æ‹’ç»
â”œâ”€â”€ é”™è¯¯æ—¥å¿—ï¼šConnection refused  
â”œâ”€â”€ å®¢æˆ·ç«¯è¶…æ—¶
â””â”€â”€ MySQLè¿æ¥æ•°æ­£å¸¸ä½†ä»æ— æ³•è¿æ¥

æ ¹æœ¬åŸå› ï¼š
â””â”€â”€ å†…æ ¸accepté˜Ÿåˆ—æ»¡äº†ï¼Œæ–°è¿æ¥è¢«ä¸¢å¼ƒ
```

**ğŸ”§ ä¼˜åŒ–é…ç½®**
```bash
# æŸ¥çœ‹å½“å‰è®¾ç½®
cat /proc/sys/net/core/somaxconn

# ä¼˜åŒ–é…ç½®ï¼ˆæ ¹æ®æœ€å¤§è¿æ¥æ•°è®¾ç½®ï¼‰
echo "net.core.somaxconn = 32768" >> /etc/sysctl.conf
echo "net.core.netdev_max_backlog = 32768" >> /etc/sysctl.conf
```

### 4.2 TCPå‚æ•°ä¼˜åŒ–


**ğŸ”¸ å…³é”®TCPå‚æ•°é…ç½®**

**ğŸ“‹ TCPä¼˜åŒ–å‚æ•°æ¸…å•**
```bash
# TCPè¿æ¥ä¼˜åŒ–
net.ipv4.tcp_max_syn_backlog = 32768    # SYNé˜Ÿåˆ—å¤§å°
net.ipv4.tcp_syncookies = 1              # å¯ç”¨SYN cookiesé˜²æŠ¤
net.ipv4.tcp_tw_recycle = 0              # å…³é—­TIME_WAITå¿«é€Ÿå›æ”¶
net.ipv4.tcp_tw_reuse = 1                # å…è®¸TIME_WAITé‡ç”¨
net.ipv4.tcp_fin_timeout = 10            # FIN_WAIT_2çŠ¶æ€è¶…æ—¶æ—¶é—´
net.ipv4.tcp_keepalive_time = 600        # TCP keepaliveæ—¶é—´
net.ipv4.tcp_keepalive_intvl = 30        # keepaliveæ¢æµ‹é—´éš”
net.ipv4.tcp_keepalive_probes = 3        # keepaliveæ¢æµ‹æ¬¡æ•°
```

**ğŸ’¡ å‚æ•°å«ä¹‰è¯¦è§£**

| å‚æ•° | ä½œç”¨ | æ¨èå€¼ | è¯´æ˜ |
|------|------|--------|------|
| `tcp_max_syn_backlog` | SYNè¯·æ±‚é˜Ÿåˆ—å¤§å° | 32768 | é˜²æ­¢SYN floodæ”»å‡» |
| `tcp_tw_reuse` | TIME_WAITçŠ¶æ€é‡ç”¨ | 1 | æé«˜è¿æ¥å¤ç”¨æ•ˆç‡ |
| `tcp_fin_timeout` | è¿æ¥å…³é—­è¶…æ—¶ | 10ç§’ | å‡å°‘è¿æ¥å ç”¨æ—¶é—´ |
| `tcp_keepalive_time` | è¿æ¥ä¿æ´»æ£€æµ‹ | 600ç§’ | æ£€æµ‹æ­»è¿æ¥ |

---

## 5. ğŸ§  å†…å­˜ç®¡ç†ä¼˜åŒ–


### 5.1 NUMAæ¶æ„ä¼˜åŒ–


**ğŸ”¸ ä»€ä¹ˆæ˜¯NUMAæ¶æ„ï¼Ÿ**

**NUMAæ¶æ„å›¾è§£**
```
ä¼ ç»ŸSMPæ¶æ„ï¼ˆå¯¹ç§°å¤šå¤„ç†ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”
â”‚CPU1 â”‚ â”‚CPU2 â”‚ â”‚CPU3 â”‚ â”‚CPU4 â”‚
â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜
    â”‚       â”‚       â”‚       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚       â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚      å…±äº«å†…å­˜       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

NUMAæ¶æ„ï¼ˆéä¸€è‡´æ€§å†…å­˜è®¿é—®ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   NUMA Node 0   â”‚    â”‚   NUMA Node 1   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚CPU1 â”‚ â”‚CPU2 â”‚ â”‚    â”‚ â”‚CPU3 â”‚ â”‚CPU4 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  æœ¬åœ°å†…å­˜    â”‚ â”‚â†â”€â”€â†’â”‚ â”‚  æœ¬åœ°å†…å­˜    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‰¹ç‚¹ï¼š
- è®¿é—®æœ¬åœ°å†…å­˜å¿«
- è®¿é—®è¿œç¨‹å†…å­˜æ…¢
- MySQLéœ€è¦ç»‘å®šåˆ°å•ä¸ªNUMAèŠ‚ç‚¹
```

**âš ï¸ NUMAå¯¹MySQLçš„å½±å“**
```
é—®é¢˜åœºæ™¯ï¼š
â”œâ”€â”€ MySQLè¿›ç¨‹è·¨NUMAèŠ‚ç‚¹è¿è¡Œ
â”œâ”€â”€ é¢‘ç¹è®¿é—®è¿œç¨‹å†…å­˜
â”œâ”€â”€ æ€§èƒ½ä¸‹é™30-50%
â””â”€â”€ å†…å­˜åˆ†é…ä¸å‡è¡¡
```

**ğŸ”§ NUMAä¼˜åŒ–ç­–ç•¥**
```bash
# æŸ¥çœ‹NUMAæ‹“æ‰‘
numactl --hardware

# æŸ¥çœ‹å½“å‰NUMAç­–ç•¥
numactl --show

# æ–¹æ³•1ï¼šå…³é—­NUMAï¼ˆç®€å•æœ‰æ•ˆï¼‰
echo "vm.zone_reclaim_mode = 0" >> /etc/sysctl.conf

# æ–¹æ³•2ï¼šç»‘å®šMySQLåˆ°ç‰¹å®šNUMAèŠ‚ç‚¹
# åœ¨MySQLå¯åŠ¨è„šæœ¬ä¸­æ·»åŠ ï¼š
numactl --cpunodebind=0 --membind=0 /usr/sbin/mysqld

# æ–¹æ³•3ï¼šGRUBå¯åŠ¨å‚æ•°å…³é—­NUMA
vim /etc/default/grub
GRUB_CMDLINE_LINUX="numa=off"
```

### 5.2 å†…å­˜åˆ†é…ç­–ç•¥


**ğŸ”¸ vm.dirty_ratio å‚æ•°ä¼˜åŒ–**

**ä»€ä¹ˆæ˜¯è„é¡µï¼Ÿ**
```
è„é¡µ = åœ¨å†…å­˜ä¸­è¢«ä¿®æ”¹ä½†è¿˜æœªå†™å…¥ç£ç›˜çš„æ•°æ®é¡µ

è„é¡µäº§ç”Ÿè¿‡ç¨‹ï¼š
1. åº”ç”¨ç¨‹åºä¿®æ”¹æ•°æ® â†’ å†…å­˜ä¸­çš„é¡µè¢«æ ‡è®°ä¸º"è„"
2. ç³»ç»Ÿå®šæœŸå°†è„é¡µå†™å…¥ç£ç›˜
3. å†™å…¥å®Œæˆåï¼Œé¡µé¢å˜ä¸º"å¹²å‡€"
```

**ğŸ’¾ è„é¡µå›å†™æœºåˆ¶**
```bash
# è„é¡µç›¸å…³å‚æ•°
vm.dirty_background_ratio = 5    # åå°å›å†™é˜ˆå€¼
vm.dirty_ratio = 10              # å¼ºåˆ¶å›å†™é˜ˆå€¼  
vm.dirty_writeback_centisecs = 100  # å›å†™æ£€æŸ¥é—´éš”
vm.dirty_expire_centisecs = 200     # è„é¡µè¿‡æœŸæ—¶é—´
```

**ğŸ“Š å‚æ•°å½±å“åˆ†æ**
```
è„é¡µæ¯”ä¾‹ä¸æ€§èƒ½å…³ç³»ï¼š

é«˜è„é¡µæ¯”ä¾‹ (dirty_ratio=20):
ä¼˜ç‚¹: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ å†™å…¥æ€§èƒ½å¥½
ç¼ºç‚¹: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ æ•°æ®å®‰å…¨æ€§å·®

ä½è„é¡µæ¯”ä¾‹ (dirty_ratio=10):  
ä¼˜ç‚¹: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ æ•°æ®å®‰å…¨æ€§å¥½
ç¼ºç‚¹: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ å†™å…¥æ€§èƒ½ä¸€èˆ¬

æ¨èé…ç½®: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ å¹³è¡¡æ€§èƒ½å’Œå®‰å…¨
```

---

## 6. ğŸ“ èµ„æºé™åˆ¶é…ç½®


### 6.1 systemdç³»ç»ŸæœåŠ¡ä¼˜åŒ–


**ğŸ”¸ systemdæœåŠ¡é…ç½®**

**ä¸ºä»€ä¹ˆéœ€è¦systemdä¼˜åŒ–ï¼Ÿ**
```
ä¼ ç»Ÿinit.dè„šæœ¬é—®é¢˜ï¼š
â”œâ”€â”€ èµ„æºé™åˆ¶ç»§æ‰¿shellç¯å¢ƒ
â”œâ”€â”€ é…ç½®åˆ†æ•£éš¾ä»¥ç®¡ç†
â”œâ”€â”€ æ— æ³•ç²¾ç¡®æ§åˆ¶èµ„æº
â””â”€â”€ é‡å¯æœºåˆ¶ä¸å¤Ÿå®Œå–„

systemdä¼˜åŠ¿ï¼š
â”œâ”€â”€ ç»Ÿä¸€çš„æœåŠ¡ç®¡ç†
â”œâ”€â”€ ç²¾ç¡®çš„èµ„æºæ§åˆ¶
â”œâ”€â”€ è‡ªåŠ¨é‡å¯å’Œä¾èµ–ç®¡ç†
â””â”€â”€ æ›´å¥½çš„æ—¥å¿—é›†æˆ
```

**ğŸ”§ MySQL systemdæœåŠ¡ä¼˜åŒ–**
```ini
# åˆ›å»ºæœåŠ¡é…ç½®ç›®å½•
mkdir -p /etc/systemd/system/mysqld.service.d/

# åˆ›å»ºä¼˜åŒ–é…ç½®æ–‡ä»¶
cat > /etc/systemd/system/mysqld.service.d/override.conf << 'EOF'
[Service]
# èµ„æºé™åˆ¶
LimitNOFILE=infinity
LimitNPROC=infinity
LimitMEMLOCK=infinity

# å†…å­˜ç®¡ç†
MemoryAccounting=true
MemoryHigh=26G
MemoryMax=30G

# è¿›ç¨‹ä¼˜å…ˆçº§
Nice=-5
IOSchedulingClass=1
IOSchedulingPriority=4

# å®‰å…¨è®¾ç½®
PrivateTmp=true
ProtectSystem=full

# é‡å¯ç­–ç•¥
Restart=always
RestartSec=10
TimeoutStopSec=30
EOF

# é‡æ–°åŠ è½½systemdé…ç½®
systemctl daemon-reload
```

### 6.2 ulimitèµ„æºé™åˆ¶è¯¦è§£


**ğŸ”¸ å®Œæ•´çš„ulimité…ç½®**

**èµ„æºé™åˆ¶ç±»å‹è¯´æ˜**
```bash
# æŸ¥çœ‹æ‰€æœ‰é™åˆ¶
ulimit -a

# è¾“å‡ºè§£é‡Šï¼š
core file size          (blocks, -c) 0         # æ ¸å¿ƒè½¬å‚¨æ–‡ä»¶å¤§å°
data seg size           (kbytes, -d) unlimited # æ•°æ®æ®µå¤§å°
scheduling priority             (-e) 0         # è°ƒåº¦ä¼˜å…ˆçº§
file size               (blocks, -f) unlimited # æ–‡ä»¶å¤§å°é™åˆ¶
pending signals                 (-i) 128138    # å¾…å¤„ç†ä¿¡å·æ•°
max locked memory       (kbytes, -l) 64        # é”å®šå†…å­˜å¤§å°
max memory size         (kbytes, -m) unlimited # å†…å­˜å¤§å°é™åˆ¶
open files                      (-n) 1024      # æ–‡ä»¶æè¿°ç¬¦æ•°é‡ â† é‡ç‚¹
pipe size            (512 bytes, -p) 8         # ç®¡é“å¤§å°
POSIX message queues     (bytes, -q) 819200    # POSIXæ¶ˆæ¯é˜Ÿåˆ—
real-time priority              (-r) 0         # å®æ—¶ä¼˜å…ˆçº§
stack size              (kbytes, -s) 8192      # æ ˆå¤§å°
cpu time               (seconds, -t) unlimited # CPUæ—¶é—´
max user processes              (-u) 128138    # ç”¨æˆ·è¿›ç¨‹æ•°
virtual memory          (kbytes, -v) unlimited # è™šæ‹Ÿå†…å­˜
file locks                      (-x) unlimited # æ–‡ä»¶é”æ•°é‡
```

**ğŸ“‹ MySQLä¸“ç”¨èµ„æºé™åˆ¶é…ç½®**
```bash
# /etc/security/limits.d/mysql.conf
mysql soft core unlimited
mysql hard core unlimited
mysql soft nofile 1048576
mysql hard nofile 1048576  
mysql soft nproc 1048576
mysql hard nproc 1048576
mysql soft memlock unlimited
mysql hard memlock unlimited
mysql soft stack 32768
mysql hard stack 32768
```

---

## 7. ğŸ›¡ï¸ ç³»ç»ŸæœåŠ¡ä¼˜åŒ–


### 7.1 é˜²ç«å¢™åŸºç¡€é…ç½®


**ğŸ”¸ é˜²ç«å¢™ç­–ç•¥è®¾è®¡**

**å®‰å…¨ä¸æ€§èƒ½çš„å¹³è¡¡**
```
é˜²ç«å¢™é…ç½®åŸåˆ™ï¼š
â”œâ”€â”€ æœ€å°æƒé™åŸåˆ™ï¼šåªå¼€æ”¾å¿…è¦ç«¯å£
â”œâ”€â”€ ç™½åå•æœºåˆ¶ï¼šæ˜ç¡®å…è®¸çš„æ¥æº
â”œâ”€â”€ æ€§èƒ½è€ƒè™‘ï¼šé¿å…è¿‡å¤šå¤æ‚è§„åˆ™
â””â”€â”€ ç›‘æ§è®°å½•ï¼šè®°å½•å¼‚å¸¸è®¿é—®
```

**ğŸ”§ MySQLé˜²ç«å¢™é…ç½®ç¤ºä¾‹**
```bash
# CentOS 7+ firewalldé…ç½®
# å¼€æ”¾MySQLç«¯å£ï¼ˆä»…å¯¹å†…ç½‘ï¼‰
firewall-cmd --permanent --add-rich-rule='rule family="ipv4" source address="192.168.0.0/16" port protocol="tcp" port="3306" accept'

# å¼€æ”¾MySQL X Protocolç«¯å£ï¼ˆå¯é€‰ï¼‰
firewall-cmd --permanent --add-rich-rule='rule family="ipv4" source address="192.168.0.0/16" port protocol="tcp" port="33060" accept'

# é‡è½½é…ç½®
firewall-cmd --reload

# Ubuntu iptablesé…ç½®
iptables -A INPUT -p tcp -s 192.168.0.0/16 --dport 3306 -j ACCEPT
iptables -A INPUT -p tcp --dport 3306 -j DROP
```

### 7.2 ç³»ç»Ÿæ—¥å¿—ä¼˜åŒ–


**ğŸ”¸ æ—¥å¿—é…ç½®ä¼˜åŒ–**

**æ—¥å¿—è®°å½•ç­–ç•¥**
```bash
# rsyslogé…ç½®ä¼˜åŒ–
vim /etc/rsyslog.conf

# å‡å°‘ä¸å¿…è¦çš„æ—¥å¿—è®°å½•
# æ³¨é‡Šæ‰ä»¥ä¸‹è¡Œï¼ˆå‡å°‘IOï¼‰
#mail.*                          -/var/log/maillog
#uucp,news.crit                  -/var/log/spooler

# æ·»åŠ MySQLä¸“ç”¨æ—¥å¿—é…ç½®
local0.*                        /var/log/mysql-custom.log

# æ—¥å¿—è½®è½¬é…ç½®
vim /etc/logrotate.d/mysql-system
/var/log/mysql-custom.log {
    daily
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 644 mysql mysql
}
```

---

## 8. â˜ï¸ ç¯å¢ƒç‰¹åŒ–ä¼˜åŒ–


### 8.1 å®¹å™¨ç¯å¢ƒå‚æ•°ä¼˜åŒ–


**ğŸ”¸ Dockerç¯å¢ƒçš„ç‰¹æ®Šè€ƒè™‘**

**å®¹å™¨ä¸å®¿ä¸»æœºçš„èµ„æºå…³ç³»**
```
å®¹å™¨èµ„æºå±‚æ¬¡å›¾ï¼š

å®¿ä¸»æœºæ“ä½œç³»ç»Ÿ
â”œâ”€â”€ å†…æ ¸å‚æ•°ï¼ˆå½±å“æ‰€æœ‰å®¹å™¨ï¼‰
â”‚   â”œâ”€â”€ vm.swappiness
â”‚   â”œâ”€â”€ fs.file-max  
â”‚   â””â”€â”€ net.core.somaxconn
â”œâ”€â”€ Dockerå¼•æ“
â”‚   â””â”€â”€ MySQLå®¹å™¨
â”‚       â”œâ”€â”€ å®¹å™¨çº§åˆ«é™åˆ¶
â”‚       â”‚   â”œâ”€â”€ --memory
â”‚       â”‚   â”œâ”€â”€ --cpus
â”‚       â”‚   â””â”€â”€ --ulimit
â”‚       â””â”€â”€ MySQLè¿›ç¨‹
```

**ğŸ”§ Dockerè¿è¡Œæ—¶ä¼˜åŒ–**
```bash
# Dockerå®¹å™¨å¯åŠ¨ä¼˜åŒ–å‚æ•°
docker run -d \
  --name mysql-prod \
  # å†…å­˜é™åˆ¶
  --memory=30g \
  --memory-swappiness=1 \
  # CPUé™åˆ¶
  --cpus="12" \
  --cpu-shares=1024 \
  # æ–‡ä»¶æè¿°ç¬¦é™åˆ¶
  --ulimit nofile=1048576:1048576 \
  --ulimit memlock=-1:-1 \
  # ç½‘ç»œä¼˜åŒ–
  --net=host \
  # å­˜å‚¨ä¼˜åŒ–
  --storage-opt size=500G \
  # å®‰å…¨è®¾ç½®
  --cap-add=sys_nice \
  mysql:8.0
```

**ğŸ“‹ å®¹å™¨ç¯å¢ƒæ£€æŸ¥æ¸…å•**
```bash
# å®¹å™¨å†…æ£€æŸ¥è„šæœ¬
#!/bin/bash

echo "=== å®¹å™¨ç¯å¢ƒæ£€æŸ¥ ==="

# æ£€æŸ¥å†…å­˜é™åˆ¶
echo "å†…å­˜é™åˆ¶: $(cat /sys/fs/cgroup/memory/memory.limit_in_bytes | awk '{print $1/1024/1024/1024 "GB"}')"

# æ£€æŸ¥CPUé™åˆ¶  
echo "CPUé™åˆ¶: $(cat /sys/fs/cgroup/cpu/cpu.cfs_quota_us)us / $(cat /sys/fs/cgroup/cpu/cpu.cfs_period_us)us"

# æ£€æŸ¥æ–‡ä»¶æè¿°ç¬¦
echo "æ–‡ä»¶æè¿°ç¬¦: $(ulimit -n)"

# æ£€æŸ¥swapè®¾ç½®
echo "Swappiness: $(cat /proc/sys/vm/swappiness)"
```

### 8.2 äº‘ç¯å¢ƒç‰¹æœ‰å‚æ•°è°ƒä¼˜


**ğŸ”¸ å…¬æœ‰äº‘ç¯å¢ƒä¼˜åŒ–**

**äº‘ç¯å¢ƒçš„ç‰¹æ®Šæ€§**
```
äº‘ç¯å¢ƒç‰¹ç‚¹ï¼š
â”œâ”€â”€ è™šæ‹ŸåŒ–å±‚å¼€é”€
â”œâ”€â”€ ç½‘ç»œå»¶è¿Ÿä¸ç¡®å®š
â”œâ”€â”€ ç£ç›˜IOæ€§èƒ½æ³¢åŠ¨
â”œâ”€â”€ å®ä¾‹è§„æ ¼é™åˆ¶
â””â”€â”€ å…±äº«èµ„æºç«äº‰
```

**â˜ï¸ AWS/é˜¿é‡Œäº‘/è…¾è®¯äº‘é€šç”¨ä¼˜åŒ–**
```bash
# äº‘ç¯å¢ƒä¸“ç”¨å‚æ•°
# é€‚åº”è™šæ‹ŸåŒ–ç¯å¢ƒ
echo "kernel.timer_migration = 0" >> /etc/sysctl.conf

# ç½‘ç»œä¼˜åŒ–ï¼ˆäº‘ç¯å¢ƒç½‘ç»œå»¶è¿Ÿè¾ƒå¤§ï¼‰
echo "net.ipv4.tcp_window_scaling = 1" >> /etc/sysctl.conf
echo "net.core.rmem_max = 67108864" >> /etc/sysctl.conf  
echo "net.core.wmem_max = 67108864" >> /etc/sysctl.conf

# IOä¼˜åŒ–ï¼ˆäº‘ç›˜ç‰¹æ€§ï¼‰
echo "vm.dirty_background_ratio = 2" >> /etc/sysctl.conf
echo "vm.dirty_ratio = 5" >> /etc/sysctl.conf
```

**ğŸ“Š ä¸åŒäº‘å‚å•†å¯¹æ¯”**
| äº‘å‚å•† | æ¨èå®ä¾‹ç±»å‹ | ç½‘ç»œä¼˜åŒ–é‡ç‚¹ | å­˜å‚¨ä¼˜åŒ–é‡ç‚¹ |
|--------|-------------|-------------|-------------|
| **AWS** | r5.xlarge+ | ENIä¼˜åŒ– | EBS IOPSé…ç½® |
| **é˜¿é‡Œäº‘** | ecs.r6.large+ | VPCä¼˜åŒ– | ESSDæ€§èƒ½å‹ |
| **è…¾è®¯äº‘** | SA2.LARGE+ | å¸¦å®½ä¼˜åŒ– | SSDäº‘ç¡¬ç›˜ |

---

## 9. ğŸ“Š å‚æ•°ç®¡ç†ä¸ç›‘æ§


### 9.1 å¤§è§„æ¨¡éƒ¨ç½²å‚æ•°æ ‡å‡†åŒ–


**ğŸ”¸ å‚æ•°ç®¡ç†ç­–ç•¥**

**æ ‡å‡†åŒ–é…ç½®æ¨¡æ¿**
```bash
#!/bin/bash
# MySQLç³»ç»Ÿå‚æ•°æ ‡å‡†åŒ–è„šæœ¬

# ç¯å¢ƒæ£€æµ‹
SERVER_MEMORY=$(free -g | awk '/^Mem:/{print $2}')
CPU_CORES=$(nproc)
DISK_TYPE=$(lsblk -d -o name,rota | grep -v NAME | awk '{print $2}')

# æ ¹æ®ç¡¬ä»¶è§„æ ¼é€‰æ‹©é…ç½®æ¨¡æ¿
if [ $SERVER_MEMORY -ge 64 ]; then
    TEMPLATE="large"
elif [ $SERVER_MEMORY -ge 16 ]; then  
    TEMPLATE="medium"
else
    TEMPLATE="small"
fi

echo "æ£€æµ‹åˆ°æœåŠ¡å™¨è§„æ ¼: ${TEMPLATE} (${SERVER_MEMORY}GBå†…å­˜, ${CPU_CORES}æ ¸CPU)"

# åº”ç”¨å¯¹åº”æ¨¡æ¿
case $TEMPLATE in
    "large")
        cat > /etc/sysctl.d/mysql-large.conf << 'EOF'
# å¤§å‹æœåŠ¡å™¨é…ç½® (64GB+)
vm.swappiness = 1
vm.dirty_background_ratio = 2
vm.dirty_ratio = 5
fs.file-max = 6553600
net.core.somaxconn = 65535
kernel.shmmax = 68719476736
EOF
        ;;
    "medium")
        cat > /etc/sysctl.d/mysql-medium.conf << 'EOF'
# ä¸­å‹æœåŠ¡å™¨é…ç½® (16-64GB)  
vm.swappiness = 1
vm.dirty_background_ratio = 5
vm.dirty_ratio = 10
fs.file-max = 3276800
net.core.somaxconn = 32768
kernel.shmmax = 17179869184
EOF
        ;;
    "small")
        cat > /etc/sysctl.d/mysql-small.conf << 'EOF'
# å°å‹æœåŠ¡å™¨é…ç½® (<16GB)
vm.swappiness = 1  
vm.dirty_background_ratio = 10
vm.dirty_ratio = 15
fs.file-max = 1638400
net.core.somaxconn = 16384
kernel.shmmax = 4294967296
EOF
        ;;
esac

# åº”ç”¨é…ç½®
sysctl -p
```

### 9.2 å‚æ•°å˜æ›´å½±å“è¯„ä¼°


**ğŸ”¸ å˜æ›´å‰è¯„ä¼°æµç¨‹**

**å‚æ•°å˜æ›´é£é™©è¯„ä¼°è¡¨**
| é£é™©ç­‰çº§ | å‚æ•°ç±»å‹ | å½±å“èŒƒå›´ | å›æ»šéš¾åº¦ | å»ºè®®æ“ä½œ |
|----------|----------|----------|----------|----------|
| ğŸŸ¢ **ä½é£é™©** | ç½‘ç»œç¼“å†²åŒº | å•æœºæ€§èƒ½ | å®¹æ˜“ | ç›´æ¥å˜æ›´ |
| ğŸŸ¡ **ä¸­é£é™©** | å†…å­˜ç®¡ç† | åº”ç”¨ç¨³å®šæ€§ | ä¸­ç­‰ | æµ‹è¯•åå˜æ›´ |
| ğŸ”´ **é«˜é£é™©** | IOè°ƒåº¦å™¨ | æ•´ä½“æ€§èƒ½ | å›°éš¾ | ç»´æŠ¤çª—å£å˜æ›´ |

**ğŸ”§ å‚æ•°å˜æ›´æ ‡å‡†æµç¨‹**
```bash
#!/bin/bash
# å‚æ•°å˜æ›´è¯„ä¼°è„šæœ¬

echo "=== MySQLç³»ç»Ÿå‚æ•°å˜æ›´è¯„ä¼° ==="

# 1. å¤‡ä»½å½“å‰é…ç½®
echo "1. å¤‡ä»½å½“å‰é…ç½®..."
cp /etc/sysctl.conf /etc/sysctl.conf.backup.$(date +%Y%m%d)
sysctl -a > /tmp/sysctl_current.txt

# 2. å˜æ›´å‰ç³»ç»ŸçŠ¶æ€è®°å½•
echo "2. è®°å½•å˜æ›´å‰çŠ¶æ€..."
cat > /tmp/before_change.txt << 'EOF'
=== å˜æ›´å‰ç³»ç»ŸçŠ¶æ€ ===
æ—¶é—´: $(date)
å†…å­˜ä½¿ç”¨: $(free -h)
ç½‘ç»œè¿æ¥: $(ss -tuln | wc -l) 
æ–‡ä»¶æè¿°ç¬¦: $(lsof | wc -l)
è´Ÿè½½: $(uptime)
EOF

# 3. åº”ç”¨æ–°é…ç½®
echo "3. åº”ç”¨æ–°é…ç½®..."
sysctl -p

# 4. éªŒè¯é…ç½®ç”Ÿæ•ˆ
echo "4. éªŒè¯é…ç½®..."
sleep 5
sysctl -a > /tmp/sysctl_new.txt
diff /tmp/sysctl_current.txt /tmp/sysctl_new.txt

# 5. æ€§èƒ½åŸºå‡†æµ‹è¯•
echo "5. æ‰§è¡ŒåŸºå‡†æµ‹è¯•..."
# è¿™é‡Œé›†æˆmysqlslapæˆ–sysbenchæµ‹è¯•

echo "å˜æ›´å®Œæˆï¼Œè¯·è§‚å¯Ÿç³»ç»Ÿè¿è¡ŒçŠ¶æ€"
```

### 9.3 ç›‘æ§ä¸å‘Šè­¦


**ğŸ”¸ å…³é”®æŒ‡æ ‡ç›‘æ§**

**ğŸ“ˆ ç³»ç»Ÿå‚æ•°ç›‘æ§æŒ‡æ ‡**
```bash
#!/bin/bash
# ç³»ç»Ÿå‚æ•°ç›‘æ§è„šæœ¬

# åˆ›å»ºç›‘æ§æŒ‡æ ‡é‡‡é›†
cat > /usr/local/bin/mysql_system_monitor.sh << 'EOF'
#!/bin/bash

# é‡‡é›†æ—¶é—´æˆ³
TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')

# å†…å­˜ç›¸å…³æŒ‡æ ‡
SWAP_USAGE=$(free | awk '/Swap/ {printf "%.2f", ($3/$2)*100}')
DIRTY_PAGES=$(awk '/Dirty:/ {print $2}' /proc/meminfo)
ACTIVE_ANON=$(awk '/Active\(anon\):/ {print $2}' /proc/meminfo)

# ç½‘ç»œç›¸å…³æŒ‡æ ‡  
ESTABLISHED_CONN=$(ss -ant | grep ESTABLISHED | wc -l)
TIME_WAIT_CONN=$(ss -ant | grep TIME-WAIT | wc -l)

# æ–‡ä»¶ç³»ç»ŸæŒ‡æ ‡
OPEN_FILES=$(lsof | wc -l)
MAX_OPEN_FILES=$(cat /proc/sys/fs/file-max)
FILE_USAGE=$(echo "scale=2; $OPEN_FILES*100/$MAX_OPEN_FILES" | bc)

# è¾“å‡ºç›‘æ§æ•°æ®
echo "$TIMESTAMP,swap_usage:$SWAP_USAGE,dirty_pages:$DIRTY_PAGES,established_conn:$ESTABLISHED_CONN,file_usage:$FILE_USAGE"

EOF

chmod +x /usr/local/bin/mysql_system_monitor.sh

# æ·»åŠ åˆ°crontab
echo "*/5 * * * * /usr/local/bin/mysql_system_monitor.sh >> /var/log/mysql_system_metrics.log" | crontab -
```

**âš ï¸ å‘Šè­¦é˜ˆå€¼è®¾ç½®**
```bash
# å‘Šè­¦è§„åˆ™é…ç½®
cat > /etc/mysql_system_alerts.conf << 'EOF'
# å†…å­˜å‘Šè­¦
swap_usage_threshold=5          # Swapä½¿ç”¨ç‡è¶…è¿‡5%
dirty_pages_threshold=1048576   # è„é¡µè¶…è¿‡1GB

# ç½‘ç»œå‘Šè­¦  
max_connections_threshold=80    # è¿æ¥æ•°è¶…è¿‡æœ€å¤§å€¼80%
time_wait_threshold=10000       # TIME_WAITè¿æ¥è¶…è¿‡1ä¸‡

# æ–‡ä»¶ç³»ç»Ÿå‘Šè­¦
file_usage_threshold=80         # æ–‡ä»¶æè¿°ç¬¦ä½¿ç”¨ç‡è¶…è¿‡80%
inode_usage_threshold=90        # inodeä½¿ç”¨ç‡è¶…è¿‡90%
EOF
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ç³»ç»Ÿå‚æ•°ä¼˜åŒ–æœ¬è´¨ï¼šä¸ºMySQLåˆ›é€ æœ€ä½³è¿è¡Œç¯å¢ƒ
ğŸ”¸ å†…å­˜ç®¡ç†æ ¸å¿ƒï¼šæ§åˆ¶swapä½¿ç”¨ï¼Œä¼˜åŒ–å†…å­˜åˆ†é…ç­–ç•¥  
ğŸ”¸ IOè°ƒåº¦ä¼˜åŒ–ï¼šæ ¹æ®å­˜å‚¨ç±»å‹é€‰æ‹©åˆé€‚çš„è°ƒåº¦å™¨
ğŸ”¸ ç½‘ç»œå‚æ•°è°ƒä¼˜ï¼šæ‰©å¤§è¿æ¥é˜Ÿåˆ—ï¼Œä¼˜åŒ–TCPå‚æ•°
ğŸ”¸ èµ„æºé™åˆ¶é…ç½®ï¼šåˆç†è®¾ç½®æ–‡ä»¶æè¿°ç¬¦å’Œè¿›ç¨‹é™åˆ¶
ğŸ”¸ ç¯å¢ƒç‰¹åŒ–ä¼˜åŒ–ï¼šé’ˆå¯¹å®¹å™¨ã€äº‘ç¯å¢ƒçš„ç‰¹æ®Šè°ƒä¼˜
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ å‚æ•°ä¼˜åŒ–çš„å±‚æ¬¡å…³ç³»**
```
ç¡¬ä»¶åŸºç¡€å±‚ â†’ å†…æ ¸å‚æ•°å±‚ â†’ ç”¨æˆ·é™åˆ¶å±‚ â†’ åº”ç”¨é…ç½®å±‚
    â†“            â†“            â†“            â†“
   CPU/å†…å­˜/ç£ç›˜  â†’ sysctlå‚æ•° â†’ ulimité™åˆ¶ â†’ MySQLé…ç½®

ä¼˜åŒ–åŸåˆ™ï¼š
- ä»åº•å±‚åˆ°ä¸Šå±‚é€æ­¥ä¼˜åŒ–
- æ¯å±‚é…ç½®è¦ç›¸äº’åŒ¹é…
- é¿å…æŸä¸€å±‚æˆä¸ºç“¶é¢ˆ
```

**ğŸ”¹ ä¸åŒç¯å¢ƒçš„ä¼˜åŒ–é‡ç‚¹**
```
ç‰©ç†æœºç¯å¢ƒï¼š
é‡ç‚¹ï¼šå……åˆ†åˆ©ç”¨ç¡¬ä»¶æ€§èƒ½ï¼ŒNUMAä¼˜åŒ–

è™šæ‹Ÿæœºç¯å¢ƒï¼š  
é‡ç‚¹ï¼šé€‚åº”è™šæ‹ŸåŒ–å¼€é”€ï¼Œç½‘ç»œå»¶è¿Ÿä¼˜åŒ–

å®¹å™¨ç¯å¢ƒï¼š
é‡ç‚¹ï¼šèµ„æºé™åˆ¶é…ç½®ï¼Œå®¿ä¸»æœºå‚æ•°ç»§æ‰¿

äº‘ç¯å¢ƒï¼š
é‡ç‚¹ï¼šé€‚åº”å…±äº«èµ„æºï¼Œå¼¹æ€§æ‰©ç¼©å®¹æ”¯æŒ
```

**ğŸ”¹ å‚æ•°è°ƒä¼˜çš„å®æ–½ç­–ç•¥**
```
é˜¶æ®µåŒ–å®æ–½ï¼š
1. åŸºç¡€å®‰å…¨é…ç½®ï¼ˆé˜²æ­¢ç³»ç»Ÿæ•…éšœï¼‰
2. æ€§èƒ½å…³é”®å‚æ•°ï¼ˆæå‡æ ¸å¿ƒæŒ‡æ ‡ï¼‰  
3. é«˜çº§ä¼˜åŒ–å‚æ•°ï¼ˆç²¾ç»†åŒ–è°ƒä¼˜ï¼‰
4. ç›‘æ§å’ŒæŒç»­ä¼˜åŒ–

é£é™©æ§åˆ¶ï¼š
- å˜æ›´å‰å¤‡ä»½é…ç½®
- åˆ†æ‰¹æ¬¡æ¸è¿›å¼è°ƒæ•´
- å»ºç«‹å›æ»šæœºåˆ¶
- ç›‘æ§å˜æ›´æ•ˆæœ
```

### 10.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ’¡ ä¸åŒè§„æ¨¡åº”ç”¨çš„ä¼˜åŒ–é‡ç‚¹**

| åº”ç”¨è§„æ¨¡ | æ ¸å¿ƒä¼˜åŒ–ç‚¹ | å…³é”®å‚æ•° | é¢„æœŸæ”¶ç›Š |
|----------|-----------|----------|----------|
| **å°å‹åº”ç”¨** | åŸºç¡€ç¨³å®šæ€§ | `vm.swappiness`, `ulimit` | é¿å…åŸºç¡€æ•…éšœ |
| **ä¸­å‹åº”ç”¨** | æ€§èƒ½æå‡ | `IOè°ƒåº¦å™¨`, `ç½‘ç»œé˜Ÿåˆ—` | 30-50%æ€§èƒ½æå‡ |
| **å¤§å‹åº”ç”¨** | å…¨é¢ä¼˜åŒ– | `NUMA`, `å®¹å™¨ä¼˜åŒ–` | 50-100%æ€§èƒ½æå‡ |

**ğŸ¯ ä¼˜åŒ–æ•ˆæœè¯„ä¼°æŒ‡æ ‡**
```
æ€§èƒ½æŒ‡æ ‡ï¼š
â”œâ”€â”€ QPS/TPSæå‡å¹…åº¦
â”œâ”€â”€ å¹³å‡å“åº”æ—¶é—´ä¸‹é™  
â”œâ”€â”€ è¿æ¥å»ºç«‹æˆåŠŸç‡
â””â”€â”€ ç³»ç»Ÿèµ„æºåˆ©ç”¨ç‡

ç¨³å®šæ€§æŒ‡æ ‡ï¼š
â”œâ”€â”€ ç³»ç»Ÿå´©æºƒæ¬¡æ•°å‡å°‘
â”œâ”€â”€ OOMï¼ˆå†…å­˜ä¸è¶³ï¼‰äº‹ä»¶æ¶ˆé™¤
â”œâ”€â”€ è¿æ¥è¶…æ—¶é”™è¯¯å‡å°‘
â””â”€â”€ æœåŠ¡å¯ç”¨æ€§æå‡

è¿ç»´æŒ‡æ ‡ï¼š
â”œâ”€â”€ éƒ¨ç½²æ ‡å‡†åŒ–ç¨‹åº¦
â”œâ”€â”€ æ•…éšœæ’æŸ¥æ•ˆç‡
â”œâ”€â”€ å‚æ•°å˜æ›´æˆåŠŸç‡  
â””â”€â”€ ç›‘æ§è¦†ç›–ç‡
```

### 10.4 æœ€ä½³å®è·µå»ºè®®


**ğŸš€ å®æ–½è·¯çº¿å›¾**
```
Week 1: åŸºç¡€å®‰å…¨é…ç½®
â”œâ”€â”€ è®¾ç½®åˆç†çš„swapç­–ç•¥
â”œâ”€â”€ é…ç½®æ–‡ä»¶æè¿°ç¬¦é™åˆ¶
â”œâ”€â”€ å…³é—­é€æ˜å¤§é¡µ
â””â”€â”€ åŸºç¡€ç½‘ç»œå‚æ•°ä¼˜åŒ–

Week 2: æ€§èƒ½å…³é”®å‚æ•°
â”œâ”€â”€ IOè°ƒåº¦å™¨ä¼˜åŒ–
â”œâ”€â”€ å†…å­˜ç®¡ç†å‚æ•°è°ƒæ•´
â”œâ”€â”€ TCPå‚æ•°ä¼˜åŒ–
â””â”€â”€ NUMAæ¶æ„ä¼˜åŒ–

Week 3: ç¯å¢ƒç‰¹åŒ–é…ç½®
â”œâ”€â”€ å®¹å™¨ç¯å¢ƒä¼˜åŒ–ï¼ˆå¦‚é€‚ç”¨ï¼‰
â”œâ”€â”€ äº‘ç¯å¢ƒå‚æ•°è°ƒæ•´ï¼ˆå¦‚é€‚ç”¨ï¼‰
â”œâ”€â”€ å¤§è§„æ¨¡éƒ¨ç½²æ ‡å‡†åŒ–
â””â”€â”€ ç›‘æ§å‘Šè­¦ä½“ç³»å»ºç«‹

Week 4: éªŒè¯å’ŒæŒç»­ä¼˜åŒ–
â”œâ”€â”€ æ€§èƒ½åŸºå‡†æµ‹è¯•
â”œâ”€â”€ å‹åŠ›æµ‹è¯•éªŒè¯
â”œâ”€â”€ ç›‘æ§æ•°æ®åˆ†æ
â””â”€â”€ å‚æ•°ç²¾ç»†åŒ–è°ƒæ•´
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
å†…å­˜å°‘ç”¨swapï¼Œæ–‡ä»¶å¤šå¼€æ”¾
IOè°ƒåº¦è¦é€‰å¯¹ï¼Œç½‘ç»œé˜Ÿåˆ—è¦åŠ å¤§  
NUMAè¦ä¼˜åŒ–ï¼Œå®¹å™¨é™åˆ¶è¦è®¾å¥½
ç›‘æ§å‘Šè­¦ä¸èƒ½å°‘ï¼Œæ ‡å‡†åŒ–éƒ¨ç½²æ˜¯ç‹é“
```

> ğŸ’¡ **æ¸©é¦¨æç¤º**
> 
> ç³»ç»Ÿå‚æ•°ä¼˜åŒ–æ˜¯ä¸€ä¸ªæ¸è¿›çš„è¿‡ç¨‹ï¼Œå»ºè®®åœ¨æµ‹è¯•ç¯å¢ƒå……åˆ†éªŒè¯åå†åº”ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒã€‚æ¯æ¬¡å˜æ›´éƒ½è¦åšå¥½è®°å½•å’Œç›‘æ§ï¼Œç¡®ä¿ä¼˜åŒ–æ•ˆæœç¬¦åˆé¢„æœŸã€‚