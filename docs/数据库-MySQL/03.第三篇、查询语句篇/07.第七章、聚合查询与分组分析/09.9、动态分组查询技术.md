---
title: 9ã€åŠ¨æ€åˆ†ç»„æŸ¥è¯¢æŠ€æœ¯
---
## ğŸ“š ç›®å½•

1. [åŠ¨æ€åˆ†ç»„æŸ¥è¯¢æ¦‚è¿°](#1-åŠ¨æ€åˆ†ç»„æŸ¥è¯¢æ¦‚è¿°)
2. [æ¡ä»¶åŠ¨æ€åˆ†ç»„å®ç°](#2-æ¡ä»¶åŠ¨æ€åˆ†ç»„å®ç°)
3. [åˆ†ç»„å­—æ®µåŠ¨æ€é€‰æ‹©](#3-åˆ†ç»„å­—æ®µåŠ¨æ€é€‰æ‹©)
4. [ä¸šåŠ¡è§„åˆ™åˆ†ç»„ç­–ç•¥](#4-ä¸šåŠ¡è§„åˆ™åˆ†ç»„ç­–ç•¥)
5. [å‚æ•°åŒ–åˆ†ç»„æŸ¥è¯¢](#5-å‚æ•°åŒ–åˆ†ç»„æŸ¥è¯¢)
6. [åŠ¨æ€åˆ†ç»„æ€§èƒ½ä¼˜åŒ–](#6-åŠ¨æ€åˆ†ç»„æ€§èƒ½ä¼˜åŒ–)
7. [å®é™…åº”ç”¨åœºæ™¯](#7-å®é™…åº”ç”¨åœºæ™¯)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ åŠ¨æ€åˆ†ç»„æŸ¥è¯¢æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯åŠ¨æ€åˆ†ç»„æŸ¥è¯¢


> ğŸ’¡ **é€šä¿—ç†è§£**ï¼šåŠ¨æ€åˆ†ç»„å°±åƒæ˜¯å¯ä»¥éšæ—¶æ”¹å˜ç»Ÿè®¡ç»´åº¦çš„æ•°æ®åˆ†æå·¥å…·ï¼Œæ ¹æ®ä¸åŒéœ€æ±‚çµæ´»è°ƒæ•´åˆ†ç»„æ–¹å¼

**åŠ¨æ€åˆ†ç»„çš„æ ¸å¿ƒç‰¹ç‚¹**ï¼š
```
é™æ€åˆ†ç»„ï¼ˆå›ºå®šå†™æ³•ï¼‰ï¼š
SELECT department, COUNT(*) 
FROM employees 
GROUP BY department;

åŠ¨æ€åˆ†ç»„ï¼ˆçµæ´»å¯å˜ï¼‰ï¼š
- å¯ä»¥æŒ‰éƒ¨é—¨åˆ†ç»„ç»Ÿè®¡äººæ•°
- å¯ä»¥æŒ‰èŒçº§åˆ†ç»„ç»Ÿè®¡è–ªèµ„
- å¯ä»¥æŒ‰åœ°åŒºåˆ†ç»„ç»Ÿè®¡é”€å”®é¢
- åˆ†ç»„æ¡ä»¶æ ¹æ®å‚æ•°åŠ¨æ€å†³å®š
```

**ä¸ºä»€ä¹ˆéœ€è¦åŠ¨æ€åˆ†ç»„**ï¼š
- ğŸ“Š **æŠ¥è¡¨çµæ´»æ€§**ï¼šåŒä¸€ä¸ªæŠ¥è¡¨æ”¯æŒå¤šç§ç»Ÿè®¡ç»´åº¦
- ğŸ”„ **ä¸šåŠ¡å˜åŒ–é€‚åº”**ï¼šå¿«é€Ÿå“åº”ä¸åŒçš„ä¸šåŠ¡åˆ†æéœ€æ±‚
- âš¡ **å¼€å‘æ•ˆç‡**ï¼šä¸€å¥—ä»£ç å¤„ç†å¤šç§åˆ†ç»„åœºæ™¯
- ğŸ›ï¸ **ç”¨æˆ·è‡ªå®šä¹‰**ï¼šè®©ç”¨æˆ·è‡ªä¸»é€‰æ‹©åˆ†æç»´åº¦

### 1.2 åŠ¨æ€åˆ†ç»„åº”ç”¨åœºæ™¯


**å…¸å‹ä¸šåŠ¡åœºæ™¯**ï¼š
```
ç”µå•†æ•°æ®åˆ†æå¹³å°ï¼š
â”Œâ”€ ç”¨æˆ·é€‰æ‹©ç»Ÿè®¡ç»´åº¦ â”€â”
â”‚                    â”‚
â”œâ”€ æŒ‰å•†å“ç±»åˆ«ç»Ÿè®¡ â”€â”€â”€â”¤ â†’ GROUP BY category
â”œâ”€ æŒ‰åœ°åŒºç»Ÿè®¡ â”€â”€â”€â”€â”€â”€â”€â”¤ â†’ GROUP BY region  
â”œâ”€ æŒ‰æ—¶é—´ç»´åº¦ç»Ÿè®¡ â”€â”€â”€â”¤ â†’ GROUP BY DATE(order_time)
â””â”€ æŒ‰ä»·æ ¼åŒºé—´ç»Ÿè®¡ â”€â”€â”€â”˜ â†’ GROUP BY CASE WHEN...
```

**åŠ¨æ€åˆ†ç»„ä»·å€¼ä½“ç°**ï¼š
- **é™ä½å¼€å‘æˆæœ¬**ï¼šä¸ç”¨ä¸ºæ¯ç§åˆ†ç»„å†™å•ç‹¬çš„æŸ¥è¯¢
- **æå‡ç”¨æˆ·ä½“éªŒ**ï¼šç”¨æˆ·å¯è‡ªç”±é€‰æ‹©åˆ†æè§’åº¦
- **ä¾¿äºç»´æŠ¤**ï¼šç»Ÿä¸€çš„æŸ¥è¯¢é€»è¾‘ï¼Œå‡å°‘ä»£ç é‡å¤

---

## 2. ğŸ”€ æ¡ä»¶åŠ¨æ€åˆ†ç»„å®ç°


### 2.1 åŸºäºæ¡ä»¶çš„åˆ†ç»„åˆ‡æ¢


> ğŸ”§ **å®ç°æ€è·¯**ï¼šæ ¹æ®ä¼ å…¥çš„æ¡ä»¶å‚æ•°ï¼ŒåŠ¨æ€å†³å®šä½¿ç”¨å“ªä¸ªå­—æ®µè¿›è¡Œåˆ†ç»„

**æ¡ä»¶åˆ†ç»„çš„åŸºæœ¬å®ç°**ï¼š

<details>
<summary>ğŸ’» æ¡ä»¶åŠ¨æ€åˆ†ç»„SQLç¤ºä¾‹</summary>

```sql
-- åŸºç¡€è¡¨ç»“æ„
CREATE TABLE sales_data (
    id INT PRIMARY KEY,
    product_name VARCHAR(100),
    category VARCHAR(50),
    region VARCHAR(50),
    sale_date DATE,
    amount DECIMAL(10,2),
    salesman VARCHAR(50)
);

-- åŠ¨æ€åˆ†ç»„å®ç°ï¼ˆé€šè¿‡CASE WHENï¼‰
SELECT 
    CASE 
        WHEN @group_type = 'category' THEN category
        WHEN @group_type = 'region' THEN region
        WHEN @group_type = 'month' THEN DATE_FORMAT(sale_date, '%Y-%m')
        WHEN @group_type = 'salesman' THEN salesman
        ELSE 'unknown'
    END AS group_field,
    COUNT(*) as record_count,
    SUM(amount) as total_amount,
    AVG(amount) as avg_amount
FROM sales_data 
GROUP BY 
    CASE 
        WHEN @group_type = 'category' THEN category
        WHEN @group_type = 'region' THEN region
        WHEN @group_type = 'month' THEN DATE_FORMAT(sale_date, '%Y-%m')
        WHEN @group_type = 'salesman' THEN salesman
        ELSE 'unknown'
    END
ORDER BY total_amount DESC;

-- ä½¿ç”¨ç¤ºä¾‹
SET @group_type = 'category';  -- æŒ‰å•†å“ç±»åˆ«åˆ†ç»„
SET @group_type = 'region';    -- æŒ‰åœ°åŒºåˆ†ç»„
SET @group_type = 'month';     -- æŒ‰æœˆä»½åˆ†ç»„
```

</details>

**æ¡ä»¶åˆ†ç»„ä¼˜åŒ–å†™æ³•**ï¼š
```sql
-- ä½¿ç”¨å˜é‡ç®€åŒ–é‡å¤ä»£ç 
SET @group_field = CASE 
    WHEN @group_type = 'category' THEN 'category'
    WHEN @group_type = 'region' THEN 'region'  
    WHEN @group_type = 'month' THEN 'DATE_FORMAT(sale_date, "%Y-%m")'
    ELSE 'category'
END;

-- å‡†å¤‡åŠ¨æ€SQLï¼ˆå®é™…åº”ç”¨ä¸­ç”±ç¨‹åºç”Ÿæˆï¼‰
SELECT category as group_field, COUNT(*), SUM(amount) 
FROM sales_data GROUP BY category;
```

### 2.2 å¤šæ¡ä»¶ç»„åˆåˆ†ç»„


> ğŸ“Š **å¤æ‚åœºæ™¯**ï¼šæ ¹æ®å¤šä¸ªæ¡ä»¶çš„ç»„åˆæ¥å†³å®šåˆ†ç»„ç­–ç•¥

**å¤šç»´åº¦åˆ†ç»„çŸ©é˜µ**ï¼š
```
åˆ†ç»„æ¡ä»¶ç»„åˆï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ—¶é—´ç»´åº¦   â”‚   åœ°åŒº   â”‚  å•†å“ç±»åˆ« â”‚  åˆ†ç»„ç»“æœ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     å¹´      â”‚   å…¨éƒ¨   â”‚   å…¨éƒ¨   â”‚ æŒ‰å¹´åˆ†ç»„  â”‚
â”‚     æœˆ      â”‚   æŒ‡å®š   â”‚   å…¨éƒ¨   â”‚ æŒ‰æœˆ+åœ°åŒº â”‚
â”‚     æ—¥      â”‚   å…¨éƒ¨   â”‚   æŒ‡å®š   â”‚ æŒ‰æ—¥+ç±»åˆ« â”‚
â”‚     å‘¨      â”‚   æŒ‡å®š   â”‚   æŒ‡å®š   â”‚ æŒ‰å‘¨+åœ°åŒº+ç±»åˆ« â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¤šæ¡ä»¶åˆ†ç»„å®ç°**ï¼š
```sql
-- å¤šç»´åº¦ç»„åˆåˆ†ç»„
SELECT 
    -- åŠ¨æ€æ„å»ºåˆ†ç»„å­—æ®µ
    CONCAT(
        CASE 
            WHEN @time_level = 'year' THEN YEAR(sale_date)
            WHEN @time_level = 'month' THEN DATE_FORMAT(sale_date, '%Y-%m')
            WHEN @time_level = 'day' THEN DATE(sale_date)
        END,
        CASE WHEN @include_region = 1 THEN CONCAT('_', region) ELSE '' END,
        CASE WHEN @include_category = 1 THEN CONCAT('_', category) ELSE '' END
    ) AS group_key,
    
    -- ç»Ÿè®¡æŒ‡æ ‡
    COUNT(*) as orders_count,
    SUM(amount) as total_sales,
    AVG(amount) as avg_order_value
    
FROM sales_data
GROUP BY group_key
HAVING total_sales > @min_sales_threshold
ORDER BY total_sales DESC;
```

### 2.3 æ¡ä»¶åˆ†ç»„çš„ä¸šåŠ¡åº”ç”¨


**ç”µå•†é”€å”®åˆ†æç¤ºä¾‹**ï¼š
```sql
-- çµæ´»çš„é”€å”®åˆ†ææŸ¥è¯¢
DELIMITER //
CREATE PROCEDURE GetSalesAnalysis(
    IN group_dimension VARCHAR(20),
    IN date_range_start DATE,
    IN date_range_end DATE,
    IN min_amount DECIMAL(10,2)
)
BEGIN
    SET @sql = CONCAT('
        SELECT ',
        CASE group_dimension
            WHEN 'product' THEN 'product_name'
            WHEN 'category' THEN 'category'
            WHEN 'region' THEN 'region'
            WHEN 'salesman' THEN 'salesman'
            WHEN 'month' THEN 'DATE_FORMAT(sale_date, "%Y-%m")'
            ELSE 'category'
        END, ' as dimension,
        COUNT(*) as sales_count,
        SUM(amount) as total_revenue,
        AVG(amount) as avg_sale_value,
        MIN(amount) as min_sale,
        MAX(amount) as max_sale
        FROM sales_data 
        WHERE sale_date BETWEEN "', date_range_start, '" AND "', date_range_end, '"
        AND amount >= ', min_amount, '
        GROUP BY dimension
        ORDER BY total_revenue DESC
        LIMIT 20'
    );
    
    PREPARE stmt FROM @sql;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
END //
DELIMITER ;

-- è°ƒç”¨ç¤ºä¾‹
CALL GetSalesAnalysis('category', '2024-01-01', '2024-03-31', 100.00);
CALL GetSalesAnalysis('region', '2024-01-01', '2024-03-31', 100.00);
```

---

## 3. ğŸ›ï¸ åˆ†ç»„å­—æ®µåŠ¨æ€é€‰æ‹©


### 3.1 å¯é…ç½®åˆ†ç»„å­—æ®µ


> ğŸ”§ **æ ¸å¿ƒæ€æƒ³**ï¼šå°†åˆ†ç»„å­—æ®µä½œä¸ºå‚æ•°ï¼Œè®©ç”¨æˆ·æˆ–ç¨‹åºåŠ¨æ€é€‰æ‹©

**åˆ†ç»„å­—æ®µé€‰æ‹©å™¨è®¾è®¡**ï¼š
```
åˆ†ç»„å­—æ®µé…ç½®è¡¨ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ field_configs                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ field_id â”‚  field_name   â”‚ display_name â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    1     â”‚   category    â”‚   å•†å“ç±»åˆ«    â”‚
â”‚    2     â”‚   region      â”‚     åœ°åŒº     â”‚
â”‚    3     â”‚   salesman    â”‚    é”€å”®å‘˜    â”‚
â”‚    4     â”‚ YEAR(sale_date)â”‚     å¹´ä»½     â”‚
â”‚    5     â”‚MONTH(sale_date)â”‚     æœˆä»½     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŠ¨æ€å­—æ®µé€‰æ‹©å®ç°**ï¼š
```sql
-- åˆ›å»ºåˆ†ç»„å­—æ®µé…ç½®è¡¨
CREATE TABLE group_field_config (
    field_id INT PRIMARY KEY,
    field_expression VARCHAR(200),
    display_name VARCHAR(50),
    data_type VARCHAR(20),
    is_active BOOLEAN DEFAULT TRUE
);

-- æ’å…¥å¯ç”¨çš„åˆ†ç»„å­—æ®µ
INSERT INTO group_field_config VALUES
(1, 'category', 'å•†å“ç±»åˆ«', 'varchar', TRUE),
(2, 'region', 'åœ°åŒº', 'varchar', TRUE),
(3, 'salesman', 'é”€å”®å‘˜', 'varchar', TRUE),
(4, 'YEAR(sale_date)', 'å¹´ä»½', 'int', TRUE),
(5, 'MONTH(sale_date)', 'æœˆä»½', 'int', TRUE),
(6, 'QUARTER(sale_date)', 'å­£åº¦', 'int', TRUE),
(7, 'WEEKDAY(sale_date)', 'æ˜ŸæœŸ', 'int', TRUE);
```

### 3.2 å¤šå­—æ®µç»„åˆåˆ†ç»„


**æ”¯æŒç”¨æˆ·é€‰æ‹©å¤šä¸ªåˆ†ç»„å­—æ®µ**ï¼š

<details>
<summary>ğŸ’» å¤šå­—æ®µåŠ¨æ€åˆ†ç»„å®ç°</summary>

```sql
-- å¤šå­—æ®µåˆ†ç»„å­˜å‚¨è¿‡ç¨‹
DELIMITER //
CREATE PROCEDURE DynamicMultiFieldGroup(
    IN field_ids VARCHAR(100),  -- ä¼ å…¥å­—æ®µIDåˆ—è¡¨ï¼Œå¦‚"1,2,4"
    IN date_start DATE,
    IN date_end DATE
)
BEGIN
    DECLARE field_expressions TEXT DEFAULT '';
    DECLARE field_names TEXT DEFAULT '';
    DECLARE done INT DEFAULT FALSE;
    DECLARE field_expr VARCHAR(200);
    DECLARE field_name VARCHAR(50);
    
    -- æ¸¸æ ‡å®šä¹‰
    DECLARE field_cursor CURSOR FOR 
        SELECT field_expression, display_name 
        FROM group_field_config 
        WHERE FIND_IN_SET(field_id, field_ids) > 0
        AND is_active = TRUE;
    
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;
    
    -- æ„å»ºå­—æ®µè¡¨è¾¾å¼å’Œåç§°
    OPEN field_cursor;
    field_loop: LOOP
        FETCH field_cursor INTO field_expr, field_name;
        IF done THEN
            LEAVE field_loop;
        END IF;
        
        IF field_expressions = '' THEN
            SET field_expressions = field_expr;
            SET field_names = field_name;
        ELSE
            SET field_expressions = CONCAT(field_expressions, ', ', field_expr);
            SET field_names = CONCAT(field_names, ', ', field_name);
        END IF;
    END LOOP;
    CLOSE field_cursor;
    
    -- åŠ¨æ€æ„å»ºå¹¶æ‰§è¡ŒSQL
    SET @sql = CONCAT('
        SELECT ', field_expressions, ',
               COUNT(*) as record_count,
               SUM(amount) as total_amount,
               AVG(amount) as avg_amount,
               MIN(amount) as min_amount,
               MAX(amount) as max_amount
        FROM sales_data 
        WHERE sale_date BETWEEN "', date_start, '" AND "', date_end, '"
        GROUP BY ', field_expressions, '
        ORDER BY total_amount DESC
        LIMIT 50
    ');
    
    PREPARE stmt FROM @sql;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
END //
DELIMITER ;

-- ä½¿ç”¨ç¤ºä¾‹
CALL DynamicMultiFieldGroup('1,2', '2024-01-01', '2024-12-31');    -- æŒ‰ç±»åˆ«å’Œåœ°åŒº
CALL DynamicMultiFieldGroup('4,1', '2024-01-01', '2024-12-31');    -- æŒ‰å¹´ä»½å’Œç±»åˆ«
CALL DynamicMultiFieldGroup('2,5,1', '2024-01-01', '2024-12-31');  -- æŒ‰åœ°åŒºã€æœˆä»½ã€ç±»åˆ«
```

</details>

### 3.3 å­—æ®µæƒé™æ§åˆ¶


> ğŸ”’ **å®‰å…¨è€ƒè™‘**ï¼šä¸æ˜¯æ‰€æœ‰å­—æ®µéƒ½åº”è¯¥å¯¹æ‰€æœ‰ç”¨æˆ·å¼€æ”¾ï¼Œéœ€è¦æƒé™æ§åˆ¶

**å­—æ®µè®¿é—®æƒé™è®¾è®¡**ï¼š
```sql
-- ç”¨æˆ·åˆ†ç»„å­—æ®µæƒé™è¡¨
CREATE TABLE user_field_permissions (
    user_id INT,
    field_id INT,
    can_group BOOLEAN DEFAULT FALSE,
    can_filter BOOLEAN DEFAULT FALSE,
    PRIMARY KEY (user_id, field_id)
);

-- æƒé™æ§åˆ¶çš„åˆ†ç»„æŸ¥è¯¢
DELIMITER //
CREATE PROCEDURE SecureDynamicGroup(
    IN user_id INT,
    IN field_ids VARCHAR(100),
    IN date_start DATE,
    IN date_end DATE
)
BEGIN
    DECLARE authorized_fields VARCHAR(100) DEFAULT '';
    
    -- æ£€æŸ¥ç”¨æˆ·å¯¹å­—æ®µçš„æƒé™
    SELECT GROUP_CONCAT(field_id) INTO authorized_fields
    FROM user_field_permissions 
    WHERE user_id = user_id 
    AND can_group = TRUE 
    AND FIND_IN_SET(field_id, field_ids) > 0;
    
    -- å¦‚æœæ²¡æœ‰æƒé™ï¼ŒæŠ›å‡ºé”™è¯¯
    IF authorized_fields = '' OR authorized_fields IS NULL THEN
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'ç”¨æˆ·æ²¡æœ‰åˆ†ç»„æƒé™';
    END IF;
    
    -- ä½¿ç”¨æœ‰æƒé™çš„å­—æ®µè¿›è¡Œåˆ†ç»„
    CALL DynamicMultiFieldGroup(authorized_fields, date_start, date_end);
END //
DELIMITER ;
```

---

## 4. ğŸ“‹ ä¸šåŠ¡è§„åˆ™åˆ†ç»„ç­–ç•¥


### 4.1 åŸºäºä¸šåŠ¡é€»è¾‘çš„åˆ†ç»„


> ğŸ’¼ **ä¸šåŠ¡å¯¼å‘**ï¼šæ ¹æ®å®é™…ä¸šåŠ¡è§„åˆ™æ¥å®šä¹‰åˆ†ç»„é€»è¾‘ï¼Œè€Œä¸æ˜¯ç®€å•çš„å­—æ®µåˆ†ç»„

**ä¸šåŠ¡è§„åˆ™åˆ†ç»„ç¤ºä¾‹**ï¼š
```sql
-- å®¢æˆ·ä»·å€¼åˆ†å±‚åˆ†ç»„
SELECT 
    CASE 
        WHEN total_purchase >= 50000 THEN 'VIPå®¢æˆ·'
        WHEN total_purchase >= 20000 THEN 'é‡è¦å®¢æˆ·'
        WHEN total_purchase >= 5000 THEN 'æ™®é€šå®¢æˆ·'
        ELSE 'æ–°å®¢æˆ·'
    END AS customer_level,
    COUNT(*) as customer_count,
    AVG(total_purchase) as avg_purchase,
    SUM(total_purchase) as level_total
FROM (
    SELECT customer_id, SUM(amount) as total_purchase
    FROM sales_data 
    WHERE sale_date >= DATE_SUB(NOW(), INTERVAL 1 YEAR)
    GROUP BY customer_id
) customer_summary
GROUP BY customer_level
ORDER BY 
    CASE customer_level
        WHEN 'VIPå®¢æˆ·' THEN 1
        WHEN 'é‡è¦å®¢æˆ·' THEN 2
        WHEN 'æ™®é€šå®¢æˆ·' THEN 3
        ELSE 4
    END;
```

**åŠ¨æ€ä¸šåŠ¡è§„åˆ™åˆ†ç»„**ï¼š
```sql
-- å¯é…ç½®çš„ä¸šåŠ¡è§„åˆ™åˆ†ç»„
CREATE TABLE business_grouping_rules (
    rule_id INT PRIMARY KEY AUTO_INCREMENT,
    rule_name VARCHAR(100),
    rule_type VARCHAR(50),           -- 'range', 'category', 'formula'
    rule_expression TEXT,            -- å…·ä½“çš„åˆ†ç»„é€»è¾‘
    group_order INT,                 -- åˆ†ç»„æ˜¾ç¤ºé¡ºåº
    is_active BOOLEAN DEFAULT TRUE
);

-- æ’å…¥ä¸šåŠ¡è§„åˆ™ç¤ºä¾‹
INSERT INTO business_grouping_rules VALUES
(1, 'å®¢æˆ·ä»·å€¼åˆ†å±‚', 'range', 
 'CASE WHEN total >= 50000 THEN "VIPå®¢æˆ·" 
       WHEN total >= 20000 THEN "é‡è¦å®¢æˆ·"
       WHEN total >= 5000 THEN "æ™®é€šå®¢æˆ·"
       ELSE "æ–°å®¢æˆ·" END', 1, TRUE),
       
(2, 'äº§å“ç”Ÿå‘½å‘¨æœŸ', 'category',
 'CASE WHEN DATEDIFF(NOW(), first_sale_date) > 365 THEN "æˆç†ŸæœŸ"
       WHEN DATEDIFF(NOW(), first_sale_date) > 90 THEN "æˆé•¿æœŸ"
       ELSE "å¯¼å…¥æœŸ" END', 2, TRUE);
```

### 4.2 å¤æ‚ä¸šåŠ¡åœºæ™¯åˆ†ç»„


**ç”µå•†å¹³å°åŠ¨æ€åˆ†ç»„æ¡ˆä¾‹**ï¼š
```sql
-- ç”µå•†å¹³å°å¤åˆä¸šåŠ¡è§„åˆ™åˆ†ç»„
DELIMITER //
CREATE PROCEDURE EcommerceBusinessGrouping(
    IN grouping_rule VARCHAR(50),
    IN analysis_period INT,  -- åˆ†æå‘¨æœŸï¼ˆå¤©ï¼‰
    IN min_orders INT        -- æœ€å°è®¢å•æ•°ç­›é€‰
)
BEGIN
    DECLARE sql_template TEXT;
    
    CASE grouping_rule
        WHEN 'customer_value' THEN
            SET sql_template = '
                SELECT 
                    CASE WHEN avg_order_value >= 1000 AND order_frequency >= 0.5 THEN "é«˜ä»·å€¼é«˜é¢‘"
                         WHEN avg_order_value >= 1000 AND order_frequency < 0.5 THEN "é«˜ä»·å€¼ä½é¢‘"  
                         WHEN avg_order_value < 1000 AND order_frequency >= 0.5 THEN "ä½ä»·å€¼é«˜é¢‘"
                         ELSE "ä½ä»·å€¼ä½é¢‘" END as customer_segment,
                    COUNT(*) as customer_count,
                    AVG(total_amount) as avg_total_spend,
                    AVG(order_count) as avg_order_count
                FROM (
                    SELECT customer_id,
                           COUNT(*) as order_count,
                           SUM(amount) as total_amount,
                           AVG(amount) as avg_order_value,
                           COUNT(*) / %d as order_frequency
                    FROM sales_data 
                    WHERE sale_date >= DATE_SUB(NOW(), INTERVAL %d DAY)
                    GROUP BY customer_id
                    HAVING order_count >= %d
                ) customer_metrics
                GROUP BY customer_segment';
                
        WHEN 'product_performance' THEN
            SET sql_template = '
                SELECT 
                    CASE WHEN sales_growth > 0.2 AND market_share > 0.05 THEN "æ˜æ˜Ÿäº§å“"
                         WHEN sales_growth > 0.2 AND market_share <= 0.05 THEN "é—®å·äº§å“"
                         WHEN sales_growth <= 0.2 AND market_share > 0.05 THEN "é‡‘ç‰›äº§å“"
                         ELSE "ç˜¦ç‹—äº§å“" END as product_category,
                    COUNT(*) as product_count,
                    AVG(total_sales) as avg_sales,
                    SUM(total_sales) as category_total
                FROM (
                    SELECT product_name,
                           SUM(amount) as total_sales,
                           SUM(amount) / (SELECT SUM(amount) FROM sales_data 
                                         WHERE sale_date >= DATE_SUB(NOW(), INTERVAL %d DAY)) as market_share,
                           (SUM(CASE WHEN sale_date >= DATE_SUB(NOW(), INTERVAL %d DAY) THEN amount END) - 
                            SUM(CASE WHEN sale_date >= DATE_SUB(NOW(), INTERVAL %d DAY) THEN amount END)) / 
                            SUM(CASE WHEN sale_date >= DATE_SUB(NOW(), INTERVAL %d DAY) THEN amount END) as sales_growth
                    FROM sales_data 
                    WHERE sale_date >= DATE_SUB(NOW(), INTERVAL %d DAY)
                    GROUP BY product_name
                ) product_metrics
                GROUP BY product_category';
    END CASE;
    
    -- æ ¼å¼åŒ–SQLå¹¶æ‰§è¡Œ
    SET @final_sql = FORMAT(sql_template, analysis_period, analysis_period, min_orders, 
                           analysis_period, analysis_period/2, analysis_period, 
                           analysis_period/2, analysis_period);
    
    PREPARE stmt FROM @final_sql;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
END //
DELIMITER ;

-- ä½¿ç”¨ç¤ºä¾‹
CALL EcommerceBusinessGrouping('customer_value', 90, 3);
CALL EcommerceBusinessGrouping('product_performance', 180, 5);
```

### 4.3 æ—¶é—´ç»´åº¦ä¸šåŠ¡åˆ†ç»„


**æ—¶é—´ç›¸å…³çš„ä¸šåŠ¡åˆ†ç»„è§„åˆ™**ï¼š
```sql
-- åŠ¨æ€æ—¶é—´ç»´åº¦åˆ†ç»„
SELECT 
    CASE @time_grouping
        WHEN 'workday' THEN 
            CASE WHEN WEEKDAY(sale_date) IN (0,6) THEN 'å‘¨æœ«' ELSE 'å·¥ä½œæ—¥' END
        WHEN 'season' THEN 
            CASE WHEN MONTH(sale_date) IN (12,1,2) THEN 'å†¬å­£'
                 WHEN MONTH(sale_date) IN (3,4,5) THEN 'æ˜¥å­£'
                 WHEN MONTH(sale_date) IN (6,7,8) THEN 'å¤å­£'
                 ELSE 'ç§‹å­£' END
        WHEN 'holiday' THEN
            CASE WHEN DATE_FORMAT(sale_date, '%m-%d') IN ('01-01','02-14','05-01','10-01') 
                 THEN 'èŠ‚å‡æ—¥' ELSE 'å¹³å¸¸æ—¥' END
        ELSE DATE_FORMAT(sale_date, '%Y-%m')
    END AS time_group,
    COUNT(*) as sales_count,
    SUM(amount) as total_revenue,
    AVG(amount) as avg_order_value
FROM sales_data
WHERE sale_date >= @start_date 
GROUP BY time_group
ORDER BY total_revenue DESC;
```

---

## 5. âš™ï¸ å‚æ•°åŒ–åˆ†ç»„æŸ¥è¯¢


### 5.1 å‚æ•°åŒ–æŸ¥è¯¢è®¾è®¡åŸç†


> ğŸ¯ **è®¾è®¡ç›®æ ‡**ï¼šé€šè¿‡å‚æ•°æ§åˆ¶åˆ†ç»„é€»è¾‘ï¼Œå®ç°ä¸€ä¸ªæŸ¥è¯¢æ»¡è¶³å¤šç§éœ€æ±‚

**å‚æ•°åŒ–åˆ†ç»„æ¶æ„**ï¼š
```
å‚æ•°åŒ–åˆ†ç»„ç³»ç»Ÿï¼š
â”Œâ”€ å‰ç«¯ç”¨æˆ·ç•Œé¢ â”€â”
â”‚ â”œâ”€ åˆ†ç»„å­—æ®µé€‰æ‹© â”‚
â”‚ â”œâ”€ ç­›é€‰æ¡ä»¶è®¾ç½® â”‚
â”‚ â”œâ”€ èšåˆå‡½æ•°é€‰æ‹© â”‚
â”‚ â””â”€ æ’åºè§„åˆ™å®šä¹‰ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‚æ•°è§£æå™¨     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”œâ”€ å­—æ®µéªŒè¯      â”‚
â”‚ â”œâ”€ SQLæ„å»º      â”‚
â”‚ â”œâ”€ æƒé™æ£€æŸ¥      â”‚
â”‚ â””â”€ æ€§èƒ½ä¼˜åŒ–      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŠ¨æ€SQLæ‰§è¡Œ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 é€šç”¨å‚æ•°åŒ–åˆ†ç»„æ¡†æ¶


**æ ¸å¿ƒå‚æ•°ç»“æ„è®¾è®¡**ï¼š
```sql
-- å‚æ•°åŒ–æŸ¥è¯¢é…ç½®è¡¨
CREATE TABLE query_templates (
    template_id INT PRIMARY KEY AUTO_INCREMENT,
    template_name VARCHAR(100),
    base_table VARCHAR(100),
    available_fields JSON,      -- å¯ç”¨çš„åˆ†ç»„å­—æ®µ
    available_filters JSON,     -- å¯ç”¨çš„ç­›é€‰æ¡ä»¶  
    available_aggregates JSON,  -- å¯ç”¨çš„èšåˆå‡½æ•°
    default_config JSON,        -- é»˜è®¤é…ç½®
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- æ’å…¥æ¨¡æ¿é…ç½®
INSERT INTO query_templates (template_name, base_table, available_fields, available_filters, available_aggregates, default_config) VALUES 
('é”€å”®æ•°æ®åˆ†æ', 'sales_data', 
 '["category","region","salesman","YEAR(sale_date)","MONTH(sale_date)","QUARTER(sale_date)"]',
 '["sale_date","amount","category","region"]',
 '["COUNT(*)","SUM(amount)","AVG(amount)","MIN(amount)","MAX(amount)"]',
 '{"group_fields":["category"],"aggregates":["COUNT(*)","SUM(amount)"],"order_by":"SUM(amount) DESC","limit":20}');
```

**å‚æ•°åŒ–æŸ¥è¯¢å®ç°**ï¼š

<details>
<summary>ğŸ’» é€šç”¨å‚æ•°åŒ–åˆ†ç»„æŸ¥è¯¢å®ç°</summary>

```sql
DELIMITER //
CREATE PROCEDURE ParameterizedGroupQuery(
    IN template_id INT,
    IN group_fields JSON,        -- åˆ†ç»„å­—æ®µæ•°ç»„
    IN filter_conditions JSON,   -- ç­›é€‰æ¡ä»¶æ•°ç»„  
    IN aggregate_functions JSON, -- èšåˆå‡½æ•°æ•°ç»„
    IN order_clause VARCHAR(200),
    IN limit_count INT
)
BEGIN
    DECLARE base_table VARCHAR(100);
    DECLARE available_fields JSON;
    DECLARE sql_query TEXT DEFAULT '';
    DECLARE group_clause TEXT DEFAULT '';
    DECLARE select_clause TEXT DEFAULT '';
    DECLARE where_clause TEXT DEFAULT '';
    DECLARE i INT DEFAULT 0;
    
    -- è·å–æ¨¡æ¿é…ç½®
    SELECT bt.base_table, bt.available_fields 
    INTO base_table, available_fields
    FROM query_templates bt 
    WHERE bt.template_id = template_id;
    
    -- æ„å»ºSELECTå­å¥
    SET i = 0;
    WHILE i < JSON_LENGTH(group_fields) DO
        SET @field = JSON_UNQUOTE(JSON_EXTRACT(group_fields, CONCAT('$[', i, ']')));
        
        IF select_clause = '' THEN
            SET select_clause = @field;
            SET group_clause = @field;
        ELSE
            SET select_clause = CONCAT(select_clause, ', ', @field);
            SET group_clause = CONCAT(group_clause, ', ', @field);
        END IF;
        
        SET i = i + 1;
    END WHILE;
    
    -- æ·»åŠ èšåˆå‡½æ•°
    SET i = 0;
    WHILE i < JSON_LENGTH(aggregate_functions) DO
        SET @agg_func = JSON_UNQUOTE(JSON_EXTRACT(aggregate_functions, CONCAT('$[', i, ']')));
        SET select_clause = CONCAT(select_clause, ', ', @agg_func);
        SET i = i + 1;
    END WHILE;
    
    -- æ„å»ºWHEREå­å¥
    IF filter_conditions IS NOT NULL AND JSON_LENGTH(filter_conditions) > 0 THEN
        SET i = 0;
        WHILE i < JSON_LENGTH(filter_conditions) DO
            SET @filter = JSON_UNQUOTE(JSON_EXTRACT(filter_conditions, CONCAT('$[', i, ']')));
            
            IF where_clause = '' THEN
                SET where_clause = CONCAT('WHERE ', @filter);
            ELSE
                SET where_clause = CONCAT(where_clause, ' AND ', @filter);
            END IF;
            
            SET i = i + 1;
        END WHILE;
    END IF;
    
    -- ç»„åˆæœ€ç»ˆSQL
    SET sql_query = CONCAT(
        'SELECT ', select_clause, 
        ' FROM ', base_table, 
        ' ', IFNULL(where_clause, ''),
        ' GROUP BY ', group_clause
    );
    
    -- æ·»åŠ æ’åºå’Œé™åˆ¶
    IF order_clause IS NOT NULL AND order_clause != '' THEN
        SET sql_query = CONCAT(sql_query, ' ORDER BY ', order_clause);
    END IF;
    
    IF limit_count > 0 THEN
        SET sql_query = CONCAT(sql_query, ' LIMIT ', limit_count);
    END IF;
    
    -- æ‰§è¡ŒæŸ¥è¯¢
    SET @final_sql = sql_query;
    PREPARE stmt FROM @final_sql;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
END //
DELIMITER ;

-- ä½¿ç”¨ç¤ºä¾‹
CALL ParameterizedGroupQuery(
    1,  -- template_id
    '["category", "region"]',  -- æŒ‰ç±»åˆ«å’Œåœ°åŒºåˆ†ç»„
    '["sale_date >= \"2024-01-01\"", "amount > 100"]',  -- ç­›é€‰æ¡ä»¶
    '["COUNT(*)", "SUM(amount)", "AVG(amount)"]',  -- èšåˆå‡½æ•°
    'SUM(amount) DESC',  -- æ’åº
    10  -- é™åˆ¶10æ¡è®°å½•
);
```

</details>

### 5.3 å‚æ•°éªŒè¯ä¸å®‰å…¨æ§åˆ¶


**SQLæ³¨å…¥é˜²æŠ¤**ï¼š
```sql
-- å‚æ•°éªŒè¯å‡½æ•°
DELIMITER //
CREATE FUNCTION ValidateGroupField(field_name VARCHAR(200), template_id INT) 
RETURNS BOOLEAN
READS SQL DATA
BEGIN
    DECLARE field_count INT DEFAULT 0;
    DECLARE available_fields JSON;
    
    SELECT af.available_fields INTO available_fields
    FROM query_templates af WHERE af.template_id = template_id;
    
    -- æ£€æŸ¥å­—æ®µæ˜¯å¦åœ¨å…è®¸åˆ—è¡¨ä¸­
    SELECT COUNT(*) INTO field_count
    FROM JSON_TABLE(available_fields, '$[*]' COLUMNS (field VARCHAR(200) PATH '$')) as jt
    WHERE jt.field = field_name;
    
    RETURN field_count > 0;
END //

CREATE FUNCTION SanitizeFilterCondition(condition_text VARCHAR(500))
RETURNS VARCHAR(500)
BEGIN
    -- åŸºæœ¬çš„SQLæ³¨å…¥é˜²æŠ¤
    SET condition_text = REPLACE(condition_text, ';', '');
    SET condition_text = REPLACE(condition_text, '--', '');
    SET condition_text = REPLACE(condition_text, '/*', '');
    SET condition_text = REPLACE(condition_text, '*/', '');
    SET condition_text = REPLACE(condition_text, 'DROP', '');
    SET condition_text = REPLACE(condition_text, 'DELETE', '');
    SET condition_text = REPLACE(condition_text, 'UPDATE', '');
    SET condition_text = REPLACE(condition_text, 'INSERT', '');
    
    RETURN condition_text;
END //
DELIMITER ;
```

---

## 6. âš¡ åŠ¨æ€åˆ†ç»„æ€§èƒ½ä¼˜åŒ–


### 6.1 æ€§èƒ½é—®é¢˜åˆ†æ


> ğŸ” **æ€§èƒ½æŒ‘æˆ˜**ï¼šåŠ¨æ€åˆ†ç»„æŸ¥è¯¢å¾€å¾€æ¯”é™æ€æŸ¥è¯¢æ€§èƒ½å·®ï¼Œéœ€è¦é’ˆå¯¹æ€§ä¼˜åŒ–

**åŠ¨æ€åˆ†ç»„æ€§èƒ½é—®é¢˜**ï¼š
```
æ€§èƒ½ç“¶é¢ˆåˆ†æï¼š
â”Œâ”€ ç´¢å¼•æ— æ³•é¢„æµ‹ â”€â” â†’ åŠ¨æ€å­—æ®µéš¾ä»¥æå‰å»ºç«‹ç´¢å¼•
â”œâ”€ æ‰§è¡Œè®¡åˆ’ç¼“å­˜å¤±æ•ˆ â”¤ â†’ æ¯æ¬¡åŠ¨æ€SQLéƒ½éœ€é‡æ–°è§£æ  
â”œâ”€ ç»Ÿè®¡ä¿¡æ¯ä¸å‡†ç¡® â”€â”¤ â†’ ä¼˜åŒ–å™¨éš¾ä»¥é€‰æ‹©æœ€ä¼˜æ‰§è¡Œè®¡åˆ’
â””â”€ ä¸´æ—¶è¡¨å¼€é”€å¤§ â”€â”€â”€â”˜ â†’ å¤æ‚åˆ†ç»„å¯èƒ½äº§ç”Ÿå¤§é‡ä¸´æ—¶æ•°æ®
```

### 6.2 ç´¢å¼•ç­–ç•¥ä¼˜åŒ–


**åŠ¨æ€åˆ†ç»„ç´¢å¼•è®¾è®¡**ï¼š
```sql
-- åˆ›å»ºå¤åˆç´¢å¼•æ”¯æŒå¸¸è§åˆ†ç»„åœºæ™¯
ALTER TABLE sales_data ADD INDEX idx_category_date (category, sale_date);
ALTER TABLE sales_data ADD INDEX idx_region_date (region, sale_date);
ALTER TABLE sales_data ADD INDEX idx_salesman_date (salesman, sale_date);
ALTER TABLE sales_data ADD INDEX idx_date_category (sale_date, category);
ALTER TABLE sales_data ADD INDEX idx_date_region (sale_date, region);

-- åˆ›å»ºè¦†ç›–ç´¢å¼•å‡å°‘å›è¡¨
ALTER TABLE sales_data ADD INDEX idx_group_analysis (
    category, region, sale_date, amount, salesman
);
```

**ç´¢å¼•é€‰æ‹©ç­–ç•¥**ï¼š
```sql
-- æ ¹æ®åˆ†ç»„å­—æ®µåŠ¨æ€é€‰æ‹©æœ€ä¼˜ç´¢å¼•
DELIMITER //
CREATE PROCEDURE OptimizedDynamicGroup(
    IN group_fields VARCHAR(200),
    IN date_start DATE,
    IN date_end DATE
)
BEGIN
    DECLARE index_hint VARCHAR(100) DEFAULT '';
    
    -- æ ¹æ®åˆ†ç»„å­—æ®µé€‰æ‹©ç´¢å¼•æç¤º
    CASE 
        WHEN group_fields = 'category' THEN 
            SET index_hint = 'USE INDEX (idx_category_date)';
        WHEN group_fields = 'region' THEN 
            SET index_hint = 'USE INDEX (idx_region_date)';
        WHEN group_fields = 'category,region' THEN 
            SET index_hint = 'USE INDEX (idx_group_analysis)';
        ELSE 
            SET index_hint = '';
    END CASE;
    
    SET @sql = CONCAT('
        SELECT ', group_fields, ',
               COUNT(*) as cnt,
               SUM(amount) as total
        FROM sales_data ', index_hint, '
        WHERE sale_date BETWEEN "', date_start, '" AND "', date_end, '"
        GROUP BY ', group_fields, '
        ORDER BY total DESC
    ');
    
    PREPARE stmt FROM @sql;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
END //
DELIMITER ;
```

### 6.3 æŸ¥è¯¢ç¼“å­˜ä¼˜åŒ–


**ç»“æœç¼“å­˜ç­–ç•¥**ï¼š
```sql
-- åˆ›å»ºæŸ¥è¯¢ç»“æœç¼“å­˜è¡¨
CREATE TABLE dynamic_query_cache (
    cache_key VARCHAR(255) PRIMARY KEY,
    query_sql TEXT,
    result_data JSON,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    expires_at TIMESTAMP,
    hit_count INT DEFAULT 0
);

-- å¸¦ç¼“å­˜çš„åŠ¨æ€åˆ†ç»„æŸ¥è¯¢
DELIMITER //
CREATE PROCEDURE CachedDynamicGroup(
    IN group_fields VARCHAR(200),
    IN filters VARCHAR(500),
    IN cache_duration INT  -- ç¼“å­˜æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
)
BEGIN
    DECLARE cache_key VARCHAR(255);
    DECLARE cached_result JSON;
    DECLARE cache_expired BOOLEAN DEFAULT FALSE;
    
    -- ç”Ÿæˆç¼“å­˜é”®
    SET cache_key = MD5(CONCAT(group_fields, '|', IFNULL(filters, ''), '|', DATE(NOW())));
    
    -- æ£€æŸ¥ç¼“å­˜
    SELECT result_data INTO cached_result
    FROM dynamic_query_cache 
    WHERE cache_key = cache_key 
    AND expires_at > NOW();
    
    IF cached_result IS NOT NULL THEN
        -- è¿”å›ç¼“å­˜ç»“æœ
        SELECT JSON_UNQUOTE(cached_result) as cached_data;
        
        -- æ›´æ–°å‘½ä¸­æ¬¡æ•°
        UPDATE dynamic_query_cache 
        SET hit_count = hit_count + 1 
        WHERE cache_key = cache_key;
    ELSE
        -- æ‰§è¡ŒæŸ¥è¯¢å¹¶ç¼“å­˜ç»“æœ
        SET @sql = CONCAT('
            SELECT JSON_ARRAYAGG(
                JSON_OBJECT(
                    "group_values", CONCAT(', group_fields, '),
                    "count", COUNT(*),
                    "sum_amount", SUM(amount),
                    "avg_amount", AVG(amount)
                )
            ) as result
            FROM sales_data 
            WHERE 1=1 ', IFNULL(CONCAT(' AND ', filters), ''), '
            GROUP BY ', group_fields
        );
        
        PREPARE stmt FROM @sql;
        EXECUTE stmt;
        
        -- å°†ç»“æœæ’å…¥ç¼“å­˜ï¼ˆè¿™é‡Œç®€åŒ–å¤„ç†ï¼‰
        INSERT INTO dynamic_query_cache (cache_key, query_sql, expires_at) 
        VALUES (cache_key, @sql, DATE_ADD(NOW(), INTERVAL cache_duration MINUTE))
        ON DUPLICATE KEY UPDATE 
            expires_at = DATE_ADD(NOW(), INTERVAL cache_duration MINUTE);
        
        DEALLOCATE PREPARE stmt;
    END IF;
END //
DELIMITER ;
```

### 6.4 åˆ†åŒºè¡¨ä¼˜åŒ–


**æ—¶é—´åˆ†åŒºè¡¨è®¾è®¡**ï¼š
```sql
-- åˆ›å»ºåˆ†åŒºé”€å”®æ•°æ®è¡¨
CREATE TABLE sales_data_partitioned (
    id INT PRIMARY KEY,
    product_name VARCHAR(100),
    category VARCHAR(50),
    region VARCHAR(50),
    sale_date DATE,
    amount DECIMAL(10,2),
    salesman VARCHAR(50)
) 
PARTITION BY RANGE (YEAR(sale_date)) (
    PARTITION p2022 VALUES LESS THAN (2023),
    PARTITION p2023 VALUES LESS THAN (2024),
    PARTITION p2024 VALUES LESS THAN (2025),
    PARTITION p2025 VALUES LESS THAN (2026)
);

-- åˆ†åŒºè£å‰ªä¼˜åŒ–åŠ¨æ€åˆ†ç»„
SELECT 
    region,
    COUNT(*) as sales_count,
    SUM(amount) as total_amount
FROM sales_data_partitioned
WHERE sale_date >= '2024-01-01' 
AND sale_date < '2025-01-01'  -- æ˜ç¡®åˆ†åŒºè£å‰ªæ¡ä»¶
GROUP BY region
ORDER BY total_amount DESC;
```

---

## 7. ğŸ¯ å®é™…åº”ç”¨åœºæ™¯


### 7.1 ç”µå•†æ•°æ®åˆ†æå¹³å°


**å¤šç»´åº¦é”€å”®åˆ†æç³»ç»Ÿ**ï¼š
```sql
-- ç”µå•†å¹³å°åŠ¨æ€åˆ†æå­˜å‚¨è¿‡ç¨‹
DELIMITER //
CREATE PROCEDURE EcommerceDynamicAnalysis(
    IN analysis_type VARCHAR(50),     -- 'sales', 'customer', 'product'
    IN time_dimension VARCHAR(20),    -- 'day', 'week', 'month', 'quarter'
    IN group_dimension VARCHAR(50),   -- 'category', 'region', 'channel'
    IN date_range_days INT,
    IN top_n_limit INT
)
BEGIN
    DECLARE time_format VARCHAR(50);
    DECLARE sql_template TEXT;
    
    -- ç¡®å®šæ—¶é—´æ ¼å¼
    CASE time_dimension
        WHEN 'day' THEN SET time_format = '%Y-%m-%d';
        WHEN 'week' THEN SET time_format = '%Y-%u';
        WHEN 'month' THEN SET time_format = '%Y-%m';
        WHEN 'quarter' THEN SET time_format = '%Y-Q%q';
        ELSE SET time_format = '%Y-%m';
    END CASE;
    
    CASE analysis_type
        WHEN 'sales' THEN
            SET sql_template = CONCAT('
                SELECT 
                    DATE_FORMAT(sale_date, "', time_format, '") as time_period,
                    ', group_dimension, ' as group_field,
                    COUNT(DISTINCT order_id) as order_count,
                    COUNT(*) as item_count,
                    SUM(amount) as total_revenue,
                    AVG(amount) as avg_order_value,
                    SUM(quantity) as total_quantity
                FROM sales_data 
                WHERE sale_date >= DATE_SUB(NOW(), INTERVAL ', date_range_days, ' DAY)
                GROUP BY time_period, group_field
                ORDER BY total_revenue DESC
                LIMIT ', top_n_limit
            );
            
        WHEN 'customer' THEN
            SET sql_template = CONCAT('
                SELECT 
                    DATE_FORMAT(first_purchase_date, "', time_format, '") as cohort_period,
                    ', group_dimension, ' as segment,
                    COUNT(DISTINCT customer_id) as new_customers,
                    AVG(lifetime_value) as avg_ltv,
                    AVG(order_frequency) as avg_frequency
                FROM customer_summary 
                WHERE first_purchase_date >= DATE_SUB(NOW(), INTERVAL ', date_range_days, ' DAY)
                GROUP BY cohort_period, segment
                ORDER BY new_customers DESC
                LIMIT ', top_n_limit
            );
            
        WHEN 'product' THEN
            SET sql_template = CONCAT('
                SELECT 
                    DATE_FORMAT(sale_date, "', time_format, '") as time_period,
                    ', group_dimension, ' as product_group,
                    COUNT(DISTINCT product_id) as unique_products,
                    SUM(quantity) as total_sold,
                    SUM(amount) as revenue,
                    AVG(profit_margin) as avg_margin
                FROM sales_data s
                JOIN product_info p ON s.product_id = p.product_id
                WHERE sale_date >= DATE_SUB(NOW(), INTERVAL ', date_range_days, ' DAY)
                GROUP BY time_period, product_group
                ORDER BY revenue DESC
                LIMIT ', top_n_limit
            );
    END CASE;
    
    SET @final_sql = sql_template;
    PREPARE stmt FROM @final_sql;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
END //
DELIMITER ;

-- ä½¿ç”¨ç¤ºä¾‹
CALL EcommerceDynamicAnalysis('sales', 'month', 'category', 365, 20);
CALL EcommerceDynamicAnalysis('customer', 'quarter', 'region', 180, 15);
```

### 7.2 è´¢åŠ¡æŠ¥è¡¨åŠ¨æ€åˆ†ç»„


**è´¢åŠ¡å¤šç»´åº¦åˆ†æ**ï¼š
```sql
-- è´¢åŠ¡æ•°æ®åŠ¨æ€åˆ†ç»„åˆ†æ
CREATE TABLE financial_transactions (
    transaction_id INT PRIMARY KEY,
    account_code VARCHAR(20),
    account_name VARCHAR(100),
    department VARCHAR(50),
    cost_center VARCHAR(20),
    transaction_date DATE,
    amount DECIMAL(15,2),
    transaction_type ENUM('income', 'expense', 'transfer'),
    description TEXT
);

-- åŠ¨æ€è´¢åŠ¡åˆ†æå­˜å‚¨è¿‡ç¨‹
DELIMITER //
CREATE PROCEDURE FinancialDynamicAnalysis(
    IN grouping_level VARCHAR(50),    -- 'department', 'account', 'cost_center'
    IN time_aggregation VARCHAR(20),  -- 'monthly', 'quarterly', 'yearly'
    IN transaction_types VARCHAR(100), -- 'income,expense' or 'all'
    IN fiscal_year INT
)
BEGIN
    DECLARE group_field VARCHAR(100);
    DECLARE time_field VARCHAR(50);
    DECLARE type_filter VARCHAR(200);
    
    -- è®¾ç½®åˆ†ç»„å­—æ®µ
    CASE grouping_level
        WHEN 'department' THEN SET group_field = 'department';
        WHEN 'account' THEN SET group_field = 'account_code, account_name';
        WHEN 'cost_center' THEN SET group_field = 'cost_center';
        ELSE SET group_field = 'department';
    END CASE;
    
    -- è®¾ç½®æ—¶é—´èšåˆ
    CASE time_aggregation
        WHEN 'monthly' THEN SET time_field = 'DATE_FORMAT(transaction_date, "%Y-%m")';
        WHEN 'quarterly' THEN SET time_field = 'CONCAT(YEAR(transaction_date), "-Q", QUARTER(transaction_date))';
        WHEN 'yearly' THEN SET time_field = 'YEAR(transaction_date)';
        ELSE SET time_field = 'DATE_FORMAT(transaction_date, "%Y-%m")';
    END CASE;
    
    -- è®¾ç½®ç±»å‹è¿‡æ»¤
    IF transaction_types = 'all' THEN
        SET type_filter = '';
    ELSE
        SET type_filter = CONCAT('AND transaction_type IN ("', REPLACE(transaction_types, ',', '","'), '")');
    END IF;
    
    SET @sql = CONCAT('
        SELECT 
            ', time_field, ' as period,
            ', group_field, ',
            transaction_type,
            COUNT(*) as transaction_count,
            SUM(amount) as total_amount,
            AVG(amount) as avg_amount,
            MIN(amount) as min_amount,
            MAX(amount) as max_amount
        FROM financial_transactions 
        WHERE YEAR(transaction_date) = ', fiscal_year, ' 
        ', type_filter, '
        GROUP BY period, ', group_field, ', transaction_type
        ORDER BY period, total_amount DESC
    ');
    
    PREPARE stmt FROM @sql;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
END //
DELIMITER ;

-- ä½¿ç”¨ç¤ºä¾‹
CALL FinancialDynamicAnalysis('department', 'quarterly', 'income,expense', 2024);
CALL FinancialDynamicAnalysis('account', 'monthly', 'expense', 2024);
```

### 7.3 ç”¨æˆ·è¡Œä¸ºåˆ†æç³»ç»Ÿ


**ç”¨æˆ·è¡Œä¸ºåŠ¨æ€åˆ†ç¾¤**ï¼š

<details>
<summary>ğŸ’» ç”¨æˆ·è¡Œä¸ºåˆ†æå®ç°</summary>

```sql
-- ç”¨æˆ·è¡Œä¸ºäº‹ä»¶è¡¨
CREATE TABLE user_behavior_events (
    event_id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id INT,
    event_type VARCHAR(50),      -- 'page_view', 'click', 'purchase', 'login'
    event_category VARCHAR(50),  -- 'product', 'content', 'navigation'
    event_properties JSON,       -- äº‹ä»¶é™„åŠ å±æ€§
    event_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    session_id VARCHAR(100),
    device_type VARCHAR(20),
    channel VARCHAR(50)
);

-- åŠ¨æ€ç”¨æˆ·è¡Œä¸ºåˆ†æ
DELIMITER //
CREATE PROCEDURE UserBehaviorDynamicAnalysis(
    IN analysis_dimension VARCHAR(50),  -- 'cohort', 'funnel', 'retention', 'segment'
    IN grouping_fields VARCHAR(200),    -- åˆ†ç»„å­—æ®µç»„åˆ
    IN time_window_days INT,           -- åˆ†ææ—¶é—´çª—å£
    IN min_event_count INT             -- æœ€å°äº‹ä»¶æ•°ç­›é€‰
)
BEGIN
    CASE analysis_dimension
        WHEN 'cohort' THEN
            -- ç”¨æˆ·ç¾¤ä½“åˆ†æ
            SET @sql = CONCAT('
                SELECT 
                    ', grouping_fields, ',
                    DATE_FORMAT(MIN(event_time), "%Y-%m") as cohort_month,
                    COUNT(DISTINCT user_id) as user_count,
                    COUNT(*) as total_events,
                    COUNT(DISTINCT session_id) as session_count,
                    AVG(events_per_user) as avg_events_per_user
                FROM (
                    SELECT user_id, ', grouping_fields, ', event_time,
                           session_id,
                           COUNT(*) OVER (PARTITION BY user_id) as events_per_user
                    FROM user_behavior_events
                    WHERE event_time >= DATE_SUB(NOW(), INTERVAL ', time_window_days, ' DAY)
                ) user_events
                GROUP BY ', grouping_fields, ', cohort_month
                HAVING total_events >= ', min_event_count, '
                ORDER BY cohort_month DESC, user_count DESC
            ');
            
        WHEN 'funnel' THEN
            -- è½¬åŒ–æ¼æ–—åˆ†æ
            SET @sql = CONCAT('
                WITH funnel_steps AS (
                    SELECT user_id, ', grouping_fields, ',
                           SUM(CASE WHEN event_type = "page_view" THEN 1 ELSE 0 END) as step1_view,
                           SUM(CASE WHEN event_type = "click" THEN 1 ELSE 0 END) as step2_click,
                           SUM(CASE WHEN event_type = "add_cart" THEN 1 ELSE 0 END) as step3_cart,
                           SUM(CASE WHEN event_type = "purchase" THEN 1 ELSE 0 END) as step4_purchase
                    FROM user_behavior_events
                    WHERE event_time >= DATE_SUB(NOW(), INTERVAL ', time_window_days, ' DAY)
                    GROUP BY user_id, ', grouping_fields, '
                )
                SELECT ', grouping_fields, ',
                       COUNT(*) as total_users,
                       SUM(CASE WHEN step1_view > 0 THEN 1 ELSE 0 END) as step1_users,
                       SUM(CASE WHEN step2_click > 0 THEN 1 ELSE 0 END) as step2_users,
                       SUM(CASE WHEN step3_cart > 0 THEN 1 ELSE 0 END) as step3_users,
                       SUM(CASE WHEN step4_purchase > 0 THEN 1 ELSE 0 END) as step4_users,
                       ROUND(SUM(CASE WHEN step2_click > 0 THEN 1 ELSE 0 END) * 100.0 / 
                             NULLIF(SUM(CASE WHEN step1_view > 0 THEN 1 ELSE 0 END), 0), 2) as step1_to_2_rate,
                       ROUND(SUM(CASE WHEN step4_purchase > 0 THEN 1 ELSE 0 END) * 100.0 / 
                             NULLIF(SUM(CASE WHEN step1_view > 0 THEN 1 ELSE 0 END), 0), 2) as overall_conversion_rate
                FROM funnel_steps
                GROUP BY ', grouping_fields, '
                ORDER BY total_users DESC
            ');
            
        WHEN 'retention' THEN
            -- ç”¨æˆ·ç•™å­˜åˆ†æ
            SET @sql = CONCAT('
                WITH user_first_activity AS (
                    SELECT user_id, ', grouping_fields, ',
                           DATE(MIN(event_time)) as first_activity_date
                    FROM user_behavior_events
                    WHERE event_time >= DATE_SUB(NOW(), INTERVAL ', time_window_days, ' DAY)
                    GROUP BY user_id, ', grouping_fields, '
                ),
                retention_analysis AS (
                    SELECT ufa.*, ', grouping_fields, ',
                           COUNT(DISTINCT DATE(ube.event_time)) as active_days,
                           MAX(DATE(ube.event_time)) as last_activity_date,
                           DATEDIFF(MAX(DATE(ube.event_time)), ufa.first_activity_date) as retention_days
                    FROM user_first_activity ufa
                    LEFT JOIN user_behavior_events ube ON ufa.user_id = ube.user_id
                    WHERE ube.event_time >= ufa.first_activity_date
                    GROUP BY ufa.user_id, ', grouping_fields, ', ufa.first_activity_date
                )
                SELECT ', grouping_fields, ',
                       DATE_FORMAT(first_activity_date, "%Y-%m") as cohort_month,
                       COUNT(*) as cohort_size,
                       AVG(active_days) as avg_active_days,
                       AVG(retention_days) as avg_retention_days,
                       SUM(CASE WHEN retention_days >= 1 THEN 1 ELSE 0 END) as day1_retained,
                       SUM(CASE WHEN retention_days >= 7 THEN 1 ELSE 0 END) as day7_retained,
                       SUM(CASE WHEN retention_days >= 30 THEN 1 ELSE 0 END) as day30_retained
                FROM retention_analysis
                GROUP BY ', grouping_fields, ', cohort_month
                ORDER BY cohort_month DESC
            ');
    END CASE;
    
    PREPARE stmt FROM @sql;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
END //
DELIMITER ;

-- ä½¿ç”¨ç¤ºä¾‹
CALL UserBehaviorDynamicAnalysis('cohort', 'device_type, channel', 90, 10);
CALL UserBehaviorDynamicAnalysis('funnel', 'channel', 30, 1);
CALL UserBehaviorDynamicAnalysis('retention', 'device_type', 60, 5);
```

</details>

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ åŠ¨æ€åˆ†ç»„æœ¬è´¨ï¼šæ ¹æ®å‚æ•°çµæ´»è°ƒæ•´åˆ†ç»„é€»è¾‘ï¼Œä¸€å¥—ä»£ç æ»¡è¶³å¤šç§éœ€æ±‚
ğŸ”¸ æ¡ä»¶åŠ¨æ€åˆ†ç»„ï¼šä½¿ç”¨CASE WHENæ ¹æ®æ¡ä»¶é€‰æ‹©ä¸åŒçš„åˆ†ç»„å­—æ®µ
ğŸ”¸ å‚æ•°åŒ–æŸ¥è¯¢ï¼šé€šè¿‡å‚æ•°æ§åˆ¶åˆ†ç»„å­—æ®µã€ç­›é€‰æ¡ä»¶ã€èšåˆå‡½æ•°ç­‰
ğŸ”¸ ä¸šåŠ¡è§„åˆ™åˆ†ç»„ï¼šåŸºäºä¸šåŠ¡é€»è¾‘å®šä¹‰å¤æ‚çš„åˆ†ç»„è§„åˆ™
ğŸ”¸ æ€§èƒ½ä¼˜åŒ–ï¼šç´¢å¼•ç­–ç•¥ã€æŸ¥è¯¢ç¼“å­˜ã€åˆ†åŒºè¡¨ç­‰æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µ
ğŸ”¸ å®‰å…¨æ§åˆ¶ï¼šå‚æ•°éªŒè¯ã€æƒé™æ£€æŸ¥ã€SQLæ³¨å…¥é˜²æŠ¤
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ åŠ¨æ€åˆ†ç»„çš„æ ¸å¿ƒä»·å€¼**
```
çµæ´»æ€§ä»·å€¼ï¼š
- ä¸€ä¸ªæŸ¥è¯¢æ¨¡æ¿é€‚åº”å¤šç§åˆ†æéœ€æ±‚
- ç”¨æˆ·å¯è‡ªä¸»é€‰æ‹©åˆ†æç»´åº¦å’ŒæŒ‡æ ‡  
- å¿«é€Ÿå“åº”ä¸šåŠ¡åˆ†æéœ€æ±‚å˜åŒ–
- å‡å°‘é‡å¤å¼€å‘å·¥ä½œé‡
```

**ğŸ”¹ å®ç°æŠ€æœ¯è¦ç‚¹**
```
æ ¸å¿ƒæŠ€æœ¯ï¼š
- åŠ¨æ€SQLæ„å»ºï¼šæ ¹æ®å‚æ•°æ‹¼æ¥SQLè¯­å¥
- å‚æ•°åŒ–æ¨¡æ¿ï¼šé¢„å®šä¹‰æŸ¥è¯¢æ¨¡æ¿ï¼Œè¿è¡Œæ—¶å¡«å……å‚æ•°
- æ¡ä»¶åˆ†æ”¯ï¼šCASE WHENå®ç°å­—æ®µåŠ¨æ€é€‰æ‹©
- å­˜å‚¨è¿‡ç¨‹ï¼šå°è£…å¤æ‚çš„åŠ¨æ€åˆ†ç»„é€»è¾‘
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥**
```
ä¼˜åŒ–é‡ç‚¹ï¼š
- ç´¢å¼•è®¾è®¡ï¼šä¸ºå¸¸è§åˆ†ç»„åœºæ™¯åˆ›å»ºåˆé€‚ç´¢å¼•
- æŸ¥è¯¢ç¼“å­˜ï¼šç¼“å­˜æŸ¥è¯¢ç»“æœå‡å°‘é‡å¤è®¡ç®—
- åˆ†åŒºè¡¨ï¼šåˆ©ç”¨åˆ†åŒºè£å‰ªæå‡æŸ¥è¯¢æ•ˆç‡  
- æ‰§è¡Œè®¡åˆ’ï¼šåˆ†æå’Œä¼˜åŒ–åŠ¨æ€SQLçš„æ‰§è¡Œè®¡åˆ’
```

### 8.3 å®é™…åº”ç”¨æŒ‡å¯¼


**é€‚ç”¨åœºæ™¯åˆ¤æ–­**ï¼š
- âœ… **æŠ¥è¡¨ç³»ç»Ÿ**ï¼šæ”¯æŒç”¨æˆ·è‡ªå®šä¹‰åˆ†æç»´åº¦
- âœ… **æ•°æ®åˆ†æå¹³å°**ï¼šæä¾›çµæ´»çš„æ•°æ®æ¢ç´¢åŠŸèƒ½
- âœ… **ä¸šåŠ¡åˆ†æ**ï¼šå¿«é€Ÿå“åº”ä¸åŒçš„åˆ†æéœ€æ±‚
- âœ… **å¤šç§Ÿæˆ·ç³»ç»Ÿ**ï¼šä¸åŒç§Ÿæˆ·æœ‰ä¸åŒçš„åˆ†ç»„éœ€æ±‚

**è®¾è®¡åŸåˆ™**ï¼š
- **å®‰å…¨ç¬¬ä¸€**ï¼šä¸¥æ ¼çš„å‚æ•°éªŒè¯å’Œæƒé™æ§åˆ¶
- **æ€§èƒ½ä¼˜å…ˆ**ï¼šåˆç†çš„ç´¢å¼•è®¾è®¡å’ŒæŸ¥è¯¢ä¼˜åŒ–
- **çµæ´»å¯æ‰©å±•**ï¼šæ”¯æŒæ–°å¢åˆ†ç»„å­—æ®µå’Œèšåˆå‡½æ•°
- **ç”¨æˆ·å‹å¥½**ï¼šæä¾›ç›´è§‚çš„å‚æ•°é…ç½®ç•Œé¢

**å®æ–½å»ºè®®**ï¼š
1. **èµ·æ­¥é˜¶æ®µ**ï¼šä»ç®€å•çš„æ¡ä»¶åˆ†ç»„å¼€å§‹
2. **é€æ­¥å®Œå–„**ï¼šå¢åŠ å‚æ•°åŒ–æ¨¡æ¿å’Œä¸šåŠ¡è§„åˆ™
3. **æ€§èƒ½è°ƒä¼˜**ï¼šæ ¹æ®å®é™…ä½¿ç”¨æƒ…å†µä¼˜åŒ–æ€§èƒ½
4. **å®‰å…¨åŠ å›º**ï¼šå®Œå–„å‚æ•°éªŒè¯å’Œæƒé™æ§åˆ¶

**é¿å…çš„é™·é˜±**ï¼š
- âŒ **è¿‡åº¦å¤æ‚åŒ–**ï¼šä¸è¦ä¸€å¼€å§‹å°±è®¾è®¡è¿‡äºå¤æ‚çš„ç³»ç»Ÿ
- âŒ **å¿½è§†å®‰å…¨æ€§**ï¼šåŠ¨æ€SQLå®¹æ˜“äº§ç”Ÿå®‰å…¨æ¼æ´
- âŒ **æ€§èƒ½ä¸è€ƒè™‘**ï¼šåŠ¨æ€æŸ¥è¯¢æ€§èƒ½é€šå¸¸æ¯”é™æ€æŸ¥è¯¢å·®
- âŒ **ç»´æŠ¤å›°éš¾**ï¼šè¿‡äºçµæ´»çš„ç³»ç»Ÿå¯èƒ½éš¾ä»¥ç»´æŠ¤

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- åŠ¨æ€åˆ†ç»„è®©æŸ¥è¯¢æ›´çµæ´»ï¼Œä¸€å¥—ä»£ç æ»¡è¶³å¤šéœ€æ±‚
- å‚æ•°åŒ–è®¾è®¡æ˜¯æ ¸å¿ƒï¼Œå®‰å…¨éªŒè¯ä¸å¯å°‘
- æ€§èƒ½ä¼˜åŒ–è¦è·Ÿä¸Šï¼Œç´¢å¼•ç¼“å­˜åˆ†åŒºè¡¨
- ä¸šåŠ¡è§„åˆ™è¦æ¸…æ™°ï¼Œç”¨æˆ·ä½“éªŒæ”¾ç¬¬ä¸€