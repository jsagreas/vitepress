---
title: 15ã€æŸ¥è¯¢æ¨¡æ¿ä¸å‚æ•°åŒ–æŠ€æœ¯
---
## ğŸ“š ç›®å½•

1. [æŸ¥è¯¢æ¨¡æ¿è®¾è®¡åŸºç¡€](#1-æŸ¥è¯¢æ¨¡æ¿è®¾è®¡åŸºç¡€)
2. [å‚æ•°åŒ–æŸ¥è¯¢ä¼˜åŒ–æŠ€æœ¯](#2-å‚æ•°åŒ–æŸ¥è¯¢ä¼˜åŒ–æŠ€æœ¯)
3. [æ¨¡æ¿ç¼“å­˜æœºåˆ¶è¯¦è§£](#3-æ¨¡æ¿ç¼“å­˜æœºåˆ¶è¯¦è§£)
4. [åŠ¨æ€å‚æ•°ç»‘å®šå®ç°](#4-åŠ¨æ€å‚æ•°ç»‘å®šå®ç°)
5. [æ¨¡æ¿å®‰å…¨æ£€æŸ¥ä½“ç³»](#5-æ¨¡æ¿å®‰å…¨æ£€æŸ¥ä½“ç³»)
6. [å‚æ•°éªŒè¯ç­–ç•¥](#6-å‚æ•°éªŒè¯ç­–ç•¥)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ“ æŸ¥è¯¢æ¨¡æ¿è®¾è®¡åŸºç¡€


### 1.1 ä»€ä¹ˆæ˜¯æŸ¥è¯¢æ¨¡æ¿ï¼Ÿ


**ğŸ”¸ æŸ¥è¯¢æ¨¡æ¿çš„é€šä¿—ç†è§£**
æŸ¥è¯¢æ¨¡æ¿å°±åƒæ˜¯ä¸€ä¸ª**å¸¦ç©ºç™½çš„è¡¨æ ¼**ï¼Œä½ å¯ä»¥å¾€ç©ºç™½å¤„å¡«å…¥ä¸åŒçš„å†…å®¹ï¼š

```
ç”Ÿæ´»ä¸­çš„æ¨¡æ¿ä¾‹å­ï¼š
è¯·å‡æ¡æ¨¡æ¿ï¼š
æˆ‘å› ä¸º_____åŸå› ï¼Œç”³è¯·è¯·å‡___å¤©ï¼Œè¯·æ‰¹å‡†ã€‚

æ•°æ®åº“æŸ¥è¯¢æ¨¡æ¿ï¼š
SELECT * FROM users WHERE age > ? AND city = ?

å…±åŒç‰¹ç‚¹ï¼š
â€¢ ç»“æ„å›ºå®šï¼Œå†…å®¹å¯å˜
â€¢ å¯ä»¥é‡å¤ä½¿ç”¨
â€¢ æé«˜æ•ˆç‡å’Œå®‰å…¨æ€§
```

**ğŸ”¸ æŸ¥è¯¢æ¨¡æ¿çš„ä½œç”¨**
```
ä¸ºä»€ä¹ˆè¦ç”¨æŸ¥è¯¢æ¨¡æ¿ï¼Ÿ

âŒ ä¼ ç»Ÿå­—ç¬¦ä¸²æ‹¼æ¥æ–¹å¼ï¼š
String sql = "SELECT * FROM users WHERE name = '" + userName + "'";

é—®é¢˜ï¼š
â€¢ SQLæ³¨å…¥é£é™©
â€¢ æ¯æ¬¡éƒ½è¦è§£æSQL
â€¢ ä»£ç éš¾ä»¥ç»´æŠ¤

âœ… å‚æ•°åŒ–æ¨¡æ¿æ–¹å¼ï¼š
String sql = "SELECT * FROM users WHERE name = ?";
PreparedStatement ps = conn.prepareStatement(sql);
ps.setString(1, userName);

ä¼˜åŠ¿ï¼š
â€¢ å®‰å…¨ï¼šé˜²æ­¢SQLæ³¨å…¥
â€¢ é«˜æ•ˆï¼šSQLè§£æä¸€æ¬¡ï¼Œæ‰§è¡Œå¤šæ¬¡
â€¢ æ¸…æ™°ï¼šé€»è¾‘ä¸æ•°æ®åˆ†ç¦»
```

### 1.2 æŸ¥è¯¢æ¨¡æ¿çš„åˆ†ç±»


**ğŸ”¸ æŒ‰å¤æ‚åº¦åˆ†ç±»**
```
ç®€å•æ¨¡æ¿ï¼š
SELECT * FROM users WHERE id = ?

ä¸­ç­‰æ¨¡æ¿ï¼š
SELECT u.name, p.title 
FROM users u 
JOIN posts p ON u.id = p.user_id 
WHERE u.status = ? AND p.created_at > ?

å¤æ‚æ¨¡æ¿ï¼š
SELECT 
    department,
    COUNT(*) as emp_count,
    AVG(salary) as avg_salary
FROM employees 
WHERE join_date BETWEEN ? AND ?
    AND department IN (?, ?, ?)
GROUP BY department
HAVING COUNT(*) > ?
ORDER BY avg_salary DESC
```

**ğŸ”¸ æŒ‰ç”¨é€”åˆ†ç±»**
```
ğŸ” æŸ¥è¯¢æ¨¡æ¿ï¼šSELECTè¯­å¥
ğŸ“ æ’å…¥æ¨¡æ¿ï¼šINSERT INTO table VALUES (?, ?, ?)
ğŸ”§ æ›´æ–°æ¨¡æ¿ï¼šUPDATE table SET column = ? WHERE id = ?
ğŸ—‘ï¸ åˆ é™¤æ¨¡æ¿ï¼šDELETE FROM table WHERE condition = ?
ğŸ“Š ç»Ÿè®¡æ¨¡æ¿ï¼šèšåˆæŸ¥è¯¢ã€åˆ†ç»„ç»Ÿè®¡ç­‰
```

### 1.3 æŸ¥è¯¢æ¨¡æ¿è®¾è®¡åŸåˆ™


**ğŸ¯ è®¾è®¡åŸåˆ™**
```
ğŸ”¸ å•ä¸€èŒè´£åŸåˆ™
ä¸€ä¸ªæ¨¡æ¿åªè§£å†³ä¸€ä¸ªä¸šåŠ¡é—®é¢˜
âŒ é”™è¯¯ï¼šä¸€ä¸ªæ¨¡æ¿åŒ…å«å¤šç§ä¸åŒçš„æŸ¥è¯¢é€»è¾‘
âœ… æ­£ç¡®ï¼šä¸ºæ¯ç§æŸ¥è¯¢åœºæ™¯è®¾è®¡ä¸“é—¨çš„æ¨¡æ¿

ğŸ”¸ å‚æ•°æœ€å°åŒ–åŸåˆ™  
åªæš´éœ²å¿…è¦çš„å‚æ•°ï¼Œéšè—å¤æ‚é€»è¾‘
âŒ é”™è¯¯ï¼šè®©ç”¨æˆ·ä¼ å…¥å®Œæ•´çš„WHEREæ¡ä»¶
âœ… æ­£ç¡®ï¼šæä¾›å…·ä½“çš„ä¸šåŠ¡å‚æ•°ï¼ˆuserId, startDateç­‰ï¼‰

ğŸ”¸ ç±»å‹å®‰å…¨åŸåˆ™
å‚æ•°ç±»å‹æ˜ç¡®ï¼Œé¿å…ç±»å‹è½¬æ¢é”™è¯¯
âŒ é”™è¯¯ï¼šæ‰€æœ‰å‚æ•°éƒ½ç”¨Objectç±»å‹
âœ… æ­£ç¡®ï¼šä½¿ç”¨å…·ä½“ç±»å‹ï¼ˆInteger, Date, Stringç­‰ï¼‰
```

---

## 2. âš¡ å‚æ•°åŒ–æŸ¥è¯¢ä¼˜åŒ–æŠ€æœ¯


### 2.1 å‚æ•°åŒ–æŸ¥è¯¢çš„å·¥ä½œåŸç†


**ğŸ”¸ å‚æ•°åŒ–æŸ¥è¯¢æ‰§è¡Œæµç¨‹**
```
æ‰§è¡Œæµç¨‹å›¾ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1.SQLæ¨¡æ¿è§£æâ”‚ â†’ â”‚ 2.æ‰§è¡Œè®¡åˆ’ç”Ÿæˆâ”‚ â†’ â”‚ 3.å‚æ•°ç»‘å®š   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6.è¿”å›ç»“æœ   â”‚ â† â”‚ 5.è·å–æ•°æ®   â”‚ â† â”‚ 4.æ‰§è¡ŒæŸ¥è¯¢   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å…³é”®ç†è§£ï¼š
â€¢ æ­¥éª¤1-2åªåœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶è¿›è¡Œ
â€¢ åç»­æ‰§è¡Œåªéœ€è¦æ­¥éª¤3-6
â€¢ å¤§å¤§æé«˜äº†é‡å¤æŸ¥è¯¢çš„æ•ˆç‡
```

**ğŸ”¸ é¢„ç¼–è¯‘çš„æ€§èƒ½ä¼˜åŠ¿**
```
ä¼ ç»Ÿæ–¹å¼ï¼ˆæ¯æ¬¡éƒ½è¦è§£æï¼‰ï¼š
ç¬¬1æ¬¡æŸ¥è¯¢ï¼š"SELECT * FROM users WHERE id = 1001"
ç¬¬2æ¬¡æŸ¥è¯¢ï¼š"SELECT * FROM users WHERE id = 1002"  
ç¬¬3æ¬¡æŸ¥è¯¢ï¼š"SELECT * FROM users WHERE id = 1003"
æ¯æ¬¡éƒ½è¦ï¼šè¯æ³•åˆ†æ â†’ è¯­æ³•åˆ†æ â†’ ç”Ÿæˆæ‰§è¡Œè®¡åˆ’

å‚æ•°åŒ–æ–¹å¼ï¼ˆåªè§£æä¸€æ¬¡ï¼‰ï¼š
æ¨¡æ¿ï¼š"SELECT * FROM users WHERE id = ?"
ç¬¬1æ¬¡ï¼šè§£æ + ç”Ÿæˆè®¡åˆ’ + ç»‘å®šå‚æ•°(1001) + æ‰§è¡Œ
ç¬¬2æ¬¡ï¼šç›´æ¥ç»‘å®šå‚æ•°(1002) + æ‰§è¡Œ
ç¬¬3æ¬¡ï¼šç›´æ¥ç»‘å®šå‚æ•°(1003) + æ‰§è¡Œ

æ€§èƒ½æå‡ï¼š
â€¢ å‡å°‘äº†80%çš„SQLè§£ææ—¶é—´
â€¢ é‡å¤æŸ¥è¯¢é€Ÿåº¦æå‡2-5å€
```

### 2.2 å‚æ•°åŒ–æŸ¥è¯¢å®ç°æŠ€æœ¯


**ğŸ”¸ JDBCå‚æ•°åŒ–å®ç°**
```java
// åŸºç¡€å‚æ•°åŒ–æŸ¥è¯¢
public List<User> getUsersByAge(int minAge, String city) {
    String sql = "SELECT id, name, age, city FROM users WHERE age >= ? AND city = ?";
    
    try (PreparedStatement ps = connection.prepareStatement(sql)) {
        ps.setInt(1, minAge);        // ç¬¬1ä¸ªå‚æ•°
        ps.setString(2, city);       // ç¬¬2ä¸ªå‚æ•°
        
        ResultSet rs = ps.executeQuery();
        return mapToUserList(rs);
    }
}

// æ‰¹é‡å‚æ•°åŒ–æ“ä½œ
public void batchInsertUsers(List<User> users) {
    String sql = "INSERT INTO users (name, age, city) VALUES (?, ?, ?)";
    
    try (PreparedStatement ps = connection.prepareStatement(sql)) {
        for (User user : users) {
            ps.setString(1, user.getName());
            ps.setInt(2, user.getAge());
            ps.setString(3, user.getCity());
            ps.addBatch();  // æ·»åŠ åˆ°æ‰¹å¤„ç†
        }
        ps.executeBatch();  // æ‰¹é‡æ‰§è¡Œ
    }
}
```

**ğŸ”¸ MyBatiså‚æ•°åŒ–æŠ€æœ¯**
```xml
<!-- åŸºç¡€å‚æ•°ç»‘å®š -->
<select id="getUserById" resultType="User">
    SELECT * FROM users WHERE id = #{userId}
</select>

<!-- å¤æ‚å‚æ•°å¯¹è±¡ -->
<select id="searchUsers" resultType="User">
    SELECT * FROM users 
    WHERE 1=1
    <if test="age != null">
        AND age >= #{age}
    </if>
    <if test="city != null and city != ''">
        AND city = #{city}
    </if>
    <if test="keywords != null">
        AND name LIKE CONCAT('%', #{keywords}, '%')
    </if>
</select>

<!-- é›†åˆå‚æ•°å¤„ç† -->
<select id="getUsersByIds" resultType="User">
    SELECT * FROM users WHERE id IN
    <foreach item="id" collection="userIds" open="(" separator="," close=")">
        #{id}
    </foreach>
</select>
```

### 2.3 å‚æ•°åŒ–æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–


**ğŸ”¸ æ‰§è¡Œè®¡åˆ’é‡ç”¨æœºåˆ¶**
```
æ•°æ®åº“çš„æŸ¥è¯¢ç¼“å­˜æœºåˆ¶ï¼š

æŸ¥è¯¢ç¼“å­˜ç»“æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SQLæ¨¡æ¿ï¼ˆæŸ¥è¯¢é”®ï¼‰            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ "SELECT * FROM users WHERE â”‚
â”‚  age > ? AND city = ?"      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‰§è¡Œè®¡åˆ’ï¼ˆç¼“å­˜å€¼ï¼‰           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ è¡¨æ‰«ææ–¹å¼               â”‚
â”‚ â€¢ ç´¢å¼•ä½¿ç”¨ç­–ç•¥             â”‚
â”‚ â€¢ è¿æ¥é¡ºåº                 â”‚
â”‚ â€¢ å†…å­˜åˆ†é…                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é‡ç”¨æ•ˆæœï¼š
â€¢ ç¬¬1æ¬¡ï¼šè§£ææ—¶é—´100ms + æ‰§è¡Œæ—¶é—´5ms = 105ms
â€¢ ç¬¬2æ¬¡ï¼šæ‰§è¡Œæ—¶é—´5ms = 5msï¼ˆæå‡20å€ï¼ï¼‰
```

**ğŸ”¸ å‚æ•°åŒ–æŸ¥è¯¢æœ€ä½³å®è·µ**
```java
// âœ… å¥½çš„å®è·µï¼šå‚æ•°ç±»å‹æ˜ç¡®
public class UserQueryTemplate {
    private static final String FIND_BY_AGE_RANGE = 
        "SELECT * FROM users WHERE age BETWEEN ? AND ? ORDER BY age";
    
    private static final String FIND_BY_CITY_AND_STATUS = 
        "SELECT * FROM users WHERE city = ? AND status = ? LIMIT ?";
    
    public List<User> findByAgeRange(int minAge, int maxAge) {
        try (PreparedStatement ps = conn.prepareStatement(FIND_BY_AGE_RANGE)) {
            ps.setInt(1, minAge);
            ps.setInt(2, maxAge);
            return executeQuery(ps);
        }
    }
}

// âŒ é¿å…çš„åšæ³•ï¼šå‚æ•°è¿‡äºå¤æ‚
public List<User> complexQuery(Map<String, Object> params) {
    // éš¾ä»¥ç»´æŠ¤ï¼Œç±»å‹ä¸å®‰å…¨
}
```

---

## 3. ğŸ—„ï¸ æ¨¡æ¿ç¼“å­˜æœºåˆ¶è¯¦è§£


### 3.1 æ¨¡æ¿ç¼“å­˜çš„å·¥ä½œåŸç†


**ğŸ”¸ ä»€ä¹ˆæ˜¯æ¨¡æ¿ç¼“å­˜ï¼Ÿ**
æ¨¡æ¿ç¼“å­˜å°±åƒæ˜¯æŠŠ**åšèœçš„æ–¹æ³•è®°ä¸‹æ¥**ï¼Œä¸‹æ¬¡åšåŒæ ·çš„èœå°±ä¸ç”¨é‡æ–°æƒ³æ­¥éª¤ï¼š

```
çƒ¹é¥ªæ¯”å–»ï¼š
ç¬¬ä¸€æ¬¡åšçº¢çƒ§è‚‰ï¼š
1. æŸ¥èœè°±ï¼ˆSQLè§£æï¼‰
2. å‡†å¤‡è°ƒæ–™ï¼ˆæ‰§è¡Œè®¡åˆ’ï¼‰
3. æŒ‰æ­¥éª¤çƒ¹é¥ªï¼ˆæ‰§è¡ŒæŸ¥è¯¢ï¼‰

ç¬¬äºŒæ¬¡åšçº¢çƒ§è‚‰ï¼š
1. ç›´æ¥æŒ‰è®°ä½çš„æ­¥éª¤ï¼ˆä½¿ç”¨ç¼“å­˜çš„æ‰§è¡Œè®¡åˆ’ï¼‰
2. è°ƒæ•´è°ƒæ–™åˆ†é‡ï¼ˆç»‘å®šæ–°å‚æ•°ï¼‰
3. çƒ¹é¥ªï¼ˆæ‰§è¡ŒæŸ¥è¯¢ï¼‰

èŠ‚çœæ—¶é—´ï¼šä¸ç”¨é‡å¤æŸ¥èœè°±å’Œæƒ³æ­¥éª¤
```

**ğŸ”¸ ç¼“å­˜çš„å±‚æ¬¡ç»“æ„**
```
æ•°æ®åº“ç¼“å­˜å±‚æ¬¡ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åº”ç”¨å±‚ç¼“å­˜                      â”‚ â† Java/Pythonåº”ç”¨ç¨‹åº
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¿æ¥æ± ç¼“å­˜                      â”‚ â† JDBC/ODBCè¿æ¥æ± 
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  
â”‚ æ•°æ®åº“æœåŠ¡å™¨ç¼“å­˜                â”‚ â† MySQL/PostgreSQLç­‰
â”‚ â€¢ SQLè§£æç¼“å­˜                   â”‚
â”‚ â€¢ æ‰§è¡Œè®¡åˆ’ç¼“å­˜                  â”‚
â”‚ â€¢ æŸ¥è¯¢ç»“æœç¼“å­˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 æ¨¡æ¿ç¼“å­˜çš„å®ç°æœºåˆ¶


**ğŸ”¸ ç¼“å­˜é”®ï¼ˆCache Keyï¼‰è®¾è®¡**
```
ç¼“å­˜é”®çš„ç»„æˆï¼š
SQLæ¨¡æ¿æ–‡æœ¬ + å‚æ•°ç±»å‹ä¿¡æ¯ + æ•°æ®åº“schemaç‰ˆæœ¬

ä¾‹å­ï¼š
åŸå§‹SQLï¼š"SELECT * FROM users WHERE age > 25 AND city = 'Beijing'"
ç¼“å­˜é”®ï¼š"SELECT * FROM users WHERE age > ? AND city = ?|INT,STRING|v1.2"

ç¼“å­˜é”®ç‰¹ç‚¹ï¼š
âœ… å¿½ç•¥å‚æ•°å…·ä½“å€¼ï¼š25å’Œ30éƒ½ç”¨åŒä¸€ä¸ªç¼“å­˜
âœ… åŒ…å«å‚æ•°ç±»å‹ï¼šåŒºåˆ†INTå’ŒSTRINGå‚æ•°
âœ… åŒ…å«schemaç‰ˆæœ¬ï¼šè¡¨ç»“æ„å˜åŒ–æ—¶å¤±æ•ˆç¼“å­˜
```

**ğŸ”¸ ç¼“å­˜ç”Ÿå‘½å‘¨æœŸç®¡ç†**
```java
public class QueryTemplateCache {
    private final Map<String, PreparedStatement> cache = new ConcurrentHashMap<>();
    private final int maxSize = 1000;
    private final long expireTime = 30 * 60 * 1000; // 30åˆ†é’Ÿ
    
    public PreparedStatement getOrCreate(Connection conn, String sql) {
        String cacheKey = generateCacheKey(sql);
        
        // 1. å°è¯•ä»ç¼“å­˜è·å–
        PreparedStatement ps = cache.get(cacheKey);
        if (ps != null && !ps.isClosed()) {
            return ps;
        }
        
        // 2. ç¼“å­˜æœªå‘½ä¸­ï¼Œåˆ›å»ºæ–°çš„
        try {
            ps = conn.prepareStatement(sql);
            
            // 3. æ£€æŸ¥ç¼“å­˜å¤§å°ï¼Œå¿…è¦æ—¶æ¸…ç†
            if (cache.size() >= maxSize) {
                clearOldestEntries();
            }
            
            // 4. å­˜å…¥ç¼“å­˜
            cache.put(cacheKey, ps);
            return ps;
            
        } catch (SQLException e) {
            throw new RuntimeException("Failed to prepare statement", e);
        }
    }
}
```

### 3.3 ç¼“å­˜ç­–ç•¥ä¼˜åŒ–


**ğŸ”¸ LRUæ·˜æ±°ç­–ç•¥**
```
LRUï¼ˆLeast Recently Usedï¼‰ç¼“å­˜æ·˜æ±°ï¼š

ç¼“å­˜ä½¿ç”¨æƒ…å†µï¼š
æ—¶é—´è½´ï¼š  1    2    3    4    5
æ¨¡æ¿Aï¼š   ç”¨   ç”¨         ç”¨
æ¨¡æ¿Bï¼š        ç”¨   ç”¨   ç”¨   
æ¨¡æ¿Cï¼š   ç”¨              ç”¨

å½“ç¼“å­˜æ»¡æ—¶ï¼š
â€¢ æ¨¡æ¿Aï¼šæœ€åä½¿ç”¨æ—¶é—´ = 5
â€¢ æ¨¡æ¿Bï¼šæœ€åä½¿ç”¨æ—¶é—´ = 4  
â€¢ æ¨¡æ¿Cï¼šæœ€åä½¿ç”¨æ—¶é—´ = 5

æ·˜æ±°é¡ºåºï¼šB â†’ A â†’ Cï¼ˆæŒ‰æœ€åä½¿ç”¨æ—¶é—´æ’åºï¼‰
```

**ğŸ”¸ ç¼“å­˜å‘½ä¸­ç‡ä¼˜åŒ–**
```
æé«˜å‘½ä¸­ç‡çš„æ–¹æ³•ï¼š

ğŸ¯ æ¨¡æ¿æ ‡å‡†åŒ–ï¼š
âŒ ä¸è§„èŒƒï¼šSELECT*FROM users WHERE age>18
âŒ ä¸è§„èŒƒï¼šselect * from users where age > 18  
âœ… æ ‡å‡†åŒ–ï¼šSELECT * FROM users WHERE age > ?

ğŸ¯ å‚æ•°æŠ½è±¡åŒ–ï¼š
âŒ è¿‡åº¦å…·ä½“ï¼šage > 18, age > 19, age > 20ï¼ˆä¸‰ä¸ªæ¨¡æ¿ï¼‰
âœ… åˆç†æŠ½è±¡ï¼šage > ?ï¼ˆä¸€ä¸ªæ¨¡æ¿ï¼Œå‚æ•°ä¸åŒï¼‰

ğŸ¯ ç¼“å­˜é¢„çƒ­ï¼š
ç³»ç»Ÿå¯åŠ¨æ—¶é¢„å…ˆåŠ è½½å¸¸ç”¨æŸ¥è¯¢æ¨¡æ¿
```

---

## 4. ğŸ”„ åŠ¨æ€å‚æ•°ç»‘å®šå®ç°


### 4.1 å‚æ•°ç»‘å®šçš„åŸºæœ¬æ¦‚å¿µ


**ğŸ”¸ ä»€ä¹ˆæ˜¯å‚æ•°ç»‘å®šï¼Ÿ**
å‚æ•°ç»‘å®šå°±æ˜¯æŠŠ**å…·ä½“çš„å€¼**å¡«å…¥æŸ¥è¯¢æ¨¡æ¿çš„**å ä½ç¬¦**ä¸­ï¼š

```
æ¨¡æ¿ä¸å‚æ•°çš„å…³ç³»ï¼š

æŸ¥è¯¢æ¨¡æ¿ï¼š
"SELECT * FROM products WHERE price BETWEEN ? AND ? AND category = ?"
        å ä½ç¬¦ä½ç½®ï¼š                    1      2              3

å‚æ•°ç»‘å®šï¼š
ä½ç½®1 â†’ 100.0  ï¼ˆæœ€ä½ä»·æ ¼ï¼‰
ä½ç½®2 â†’ 500.0  ï¼ˆæœ€é«˜ä»·æ ¼ï¼‰  
ä½ç½®3 â†’ "ç”µå­äº§å“" ï¼ˆå•†å“ç±»åˆ«ï¼‰

æœ€ç»ˆSQLï¼š
"SELECT * FROM products WHERE price BETWEEN 100.0 AND 500.0 AND category = 'ç”µå­äº§å“'"
```

### 4.2 åŠ¨æ€å‚æ•°ç»‘å®šæŠ€æœ¯


**ğŸ”¸ åŸºäºåå°„çš„å‚æ•°ç»‘å®š**
```java
public class DynamicParameterBinder {
    
    // é€šç”¨å‚æ•°ç»‘å®šæ–¹æ³•
    public void bindParameters(PreparedStatement ps, Object... params) throws SQLException {
        for (int i = 0; i < params.length; i++) {
            Object param = params[i];
            int position = i + 1;  // JDBCå‚æ•°ä½ç½®ä»1å¼€å§‹
            
            if (param == null) {
                ps.setNull(position, Types.VARCHAR);
            } else if (param instanceof String) {
                ps.setString(position, (String) param);
            } else if (param instanceof Integer) {
                ps.setInt(position, (Integer) param);
            } else if (param instanceof Date) {
                ps.setTimestamp(position, new Timestamp(((Date) param).getTime()));
            } else if (param instanceof Boolean) {
                ps.setBoolean(position, (Boolean) param);
            } else {
                // å…¶ä»–ç±»å‹è½¬ä¸ºå­—ç¬¦ä¸²
                ps.setString(position, param.toString());
            }
        }
    }
    
    // ä½¿ç”¨ç¤ºä¾‹
    public List<User> findUsers(Integer minAge, String city, Date since) {
        String sql = "SELECT * FROM users WHERE age >= ? AND city = ? AND created_at > ?";
        
        try (PreparedStatement ps = conn.prepareStatement(sql)) {
            bindParameters(ps, minAge, city, since);
            return executeAndMap(ps);
        }
    }
}
```

**ğŸ”¸ åŸºäºæ³¨è§£çš„å‚æ•°ç»‘å®š**
```java
// ä½¿ç”¨æ³¨è§£å®šä¹‰å‚æ•°æ˜ å°„
public class UserQuery {
    
    @Query("SELECT * FROM users WHERE age BETWEEN :minAge AND :maxAge")
    public List<User> findByAgeRange(@Param("minAge") int min, @Param("maxAge") int max);
    
    @Query("SELECT * FROM users WHERE city = :city AND status = :status")
    public List<User> findByCityAndStatus(@Param("city") String city, @Param("status") UserStatus status);
    
    // å¤æ‚å¯¹è±¡å‚æ•°
    @Query("SELECT * FROM users WHERE name LIKE :#{criteria.namePattern} AND age >= :#{criteria.minAge}")
    public List<User> findByCriteria(@Param("criteria") UserSearchCriteria criteria);
}

// å‚æ•°å¯¹è±¡
public class UserSearchCriteria {
    private String namePattern;
    private Integer minAge;
    private String city;
    // getters and setters
}
```

### 4.3 åŠ¨æ€SQLæ„å»º


**ğŸ”¸ æ¡ä»¶åŠ¨æ€ç»„è£…**
```java
public class DynamicQueryBuilder {
    
    public List<User> findUsers(UserQueryCondition condition) {
        StringBuilder sql = new StringBuilder("SELECT * FROM users WHERE 1=1");
        List<Object> params = new ArrayList<>();
        
        // åŠ¨æ€æ·»åŠ æ¡ä»¶
        if (condition.getName() != null) {
            sql.append(" AND name LIKE ?");
            params.add("%" + condition.getName() + "%");
        }
        
        if (condition.getMinAge() != null) {
            sql.append(" AND age >= ?");
            params.add(condition.getMinAge());
        }
        
        if (condition.getCity() != null) {
            sql.append(" AND city = ?");
            params.add(condition.getCity());
        }
        
        if (condition.getStatus() != null) {
            sql.append(" AND status = ?");
            params.add(condition.getStatus());
        }
        
        // æ‰§è¡ŒæŸ¥è¯¢
        try (PreparedStatement ps = conn.prepareStatement(sql.toString())) {
            bindParameters(ps, params.toArray());
            return executeQuery(ps);
        }
    }
}
```

**ğŸ”¸ INå­å¥åŠ¨æ€å¤„ç†**
```java
// å¤„ç†åŠ¨æ€INå­å¥
public List<User> findUsersByIds(List<Integer> userIds) {
    if (userIds == null || userIds.isEmpty()) {
        return Collections.emptyList();
    }
    
    // åŠ¨æ€ç”Ÿæˆå ä½ç¬¦
    StringBuilder sql = new StringBuilder("SELECT * FROM users WHERE id IN (");
    for (int i = 0; i < userIds.size(); i++) {
        if (i > 0) sql.append(",");
        sql.append("?");
    }
    sql.append(")");
    
    try (PreparedStatement ps = conn.prepareStatement(sql.toString())) {
        for (int i = 0; i < userIds.size(); i++) {
            ps.setInt(i + 1, userIds.get(i));
        }
        return executeQuery(ps);
    }
}
```

---

## 5. ğŸ›¡ï¸ æ¨¡æ¿å®‰å…¨æ£€æŸ¥ä½“ç³»


### 5.1 SQLæ³¨å…¥æ”»å‡»ä¸é˜²æŠ¤


**ğŸ”¸ SQLæ³¨å…¥æ”»å‡»åŸç†**
```
æ”»å‡»åœºæ™¯æ¼”ç¤ºï¼š

âŒ å±é™©çš„å­—ç¬¦ä¸²æ‹¼æ¥ï¼š
String userName = request.getParameter("user");  // ç”¨æˆ·è¾“å…¥ï¼š'; DROP TABLE users; --
String sql = "SELECT * FROM users WHERE name = '" + userName + "'";
// æœ€ç»ˆSQLï¼šSELECT * FROM users WHERE name = ''; DROP TABLE users; --'

ç»“æœï¼šç”¨æˆ·è¡¨è¢«åˆ é™¤ï¼

âœ… å‚æ•°åŒ–æŸ¥è¯¢é˜²æŠ¤ï¼š
String sql = "SELECT * FROM users WHERE name = ?";
ps.setString(1, "'; DROP TABLE users; --");
// æ¶æ„ä»£ç è¢«å½“ä½œæ™®é€šå­—ç¬¦ä¸²å¤„ç†ï¼Œæ— æ³•æ‰§è¡Œ
```

**ğŸ”¸ SQLæ³¨å…¥çš„å¸¸è§ç±»å‹**
```
1. è”åˆæŸ¥è¯¢æ³¨å…¥ï¼š
è¾“å…¥ï¼š' UNION SELECT password FROM admin_users --
ç›®çš„ï¼šè·å–ç®¡ç†å‘˜å¯†ç 

2. å¸ƒå°”ç›²æ³¨ï¼š
è¾“å…¥ï¼š' AND (SELECT COUNT(*) FROM admin_users) > 0 --
ç›®çš„ï¼šæ¨æ–­æ•°æ®åº“ç»“æ„

3. æ—¶é—´ç›²æ³¨ï¼š
è¾“å…¥ï¼š'; IF(1=1, SLEEP(5), 0) --
ç›®çš„ï¼šé€šè¿‡å“åº”æ—¶é—´è·å–ä¿¡æ¯

å‚æ•°åŒ–æŸ¥è¯¢å¦‚ä½•é˜²æŠ¤ï¼š
â€¢ æ¶æ„SQLä»£ç è¢«å½“ä½œå­—ç¬¦ä¸²æ•°æ®
â€¢ æ•°æ®åº“ä¸ä¼šè§£é‡Šæ‰§è¡Œæ¶æ„ä»£ç 
â€¢ ä»æ ¹æœ¬ä¸Šæœç»SQLæ³¨å…¥
```

### 5.2 æ¨¡æ¿å®‰å…¨æ£€æŸ¥æœºåˆ¶


**ğŸ”¸ é™æ€å®‰å…¨æ£€æŸ¥**
```java
public class SqlTemplateValidator {
    
    // å±é™©å…³é”®å­—åˆ—è¡¨
    private static final Set<String> DANGEROUS_KEYWORDS = Set.of(
        "DROP", "DELETE", "TRUNCATE", "ALTER", "CREATE", 
        "EXEC", "EXECUTE", "SCRIPT", "UNION"
    );
    
    // æ£€æŸ¥SQLæ¨¡æ¿æ˜¯å¦å®‰å…¨
    public boolean isTemplateSafe(String sqlTemplate) {
        // 1. æ£€æŸ¥æ˜¯å¦åŒ…å«å±é™©å…³é”®å­—
        String upperSql = sqlTemplate.toUpperCase();
        for (String keyword : DANGEROUS_KEYWORDS) {
            if (upperSql.contains(keyword)) {
                return false;
            }
        }
        
        // 2. æ£€æŸ¥å‚æ•°å ä½ç¬¦æ ¼å¼
        if (!hasValidPlaceholders(sqlTemplate)) {
            return false;
        }
        
        // 3. æ£€æŸ¥SQLè¯­æ³•åŸºæœ¬æ­£ç¡®æ€§
        return isValidSqlSyntax(sqlTemplate);
    }
    
    // æ£€æŸ¥å ä½ç¬¦æ˜¯å¦è§„èŒƒ
    private boolean hasValidPlaceholders(String sql) {
        // æ£€æŸ¥æ˜¯å¦æœ‰?å ä½ç¬¦ä½†æ²¡æœ‰å‚æ•°ç»‘å®š
        int placeholderCount = countOccurrences(sql, "?");
        
        // æ£€æŸ¥æ˜¯å¦æœ‰å•å¼•å·æ‹¼æ¥ï¼ˆå¯èƒ½çš„æ³¨å…¥ç‚¹ï¼‰
        return !sql.contains("' +") && !sql.contains("+ '");
    }
}
```

**ğŸ”¸ è¿è¡Œæ—¶å®‰å…¨æ£€æŸ¥**
```java
public class RuntimeSecurityChecker {
    
    // å‚æ•°å€¼å®‰å…¨æ£€æŸ¥
    public boolean isParameterSafe(Object parameter) {
        if (parameter == null) {
            return true;
        }
        
        String value = parameter.toString();
        
        // æ£€æŸ¥æ˜¯å¦åŒ…å«SQLæ³¨å…¥ç‰¹å¾
        String[] injectionPatterns = {
            "'", "\"", ";", "--", "/*", "*/", 
            "union", "select", "drop", "delete", "insert", "update"
        };
        
        String lowerValue = value.toLowerCase();
        for (String pattern : injectionPatterns) {
            if (lowerValue.contains(pattern)) {
                // è®°å½•å®‰å…¨äº‹ä»¶
                logSecurityEvent("Potential SQL injection detected", value);
                return false;
            }
        }
        
        return true;
    }
    
    // æ‰§è¡Œå‰æœ€ç»ˆæ£€æŸ¥
    public void checkBeforeExecution(String sql, Object[] parameters) {
        // 1. æ£€æŸ¥SQLæ¨¡æ¿
        if (!isTemplateSafe(sql)) {
            throw new SecurityException("Unsafe SQL template: " + sql);
        }
        
        // 2. æ£€æŸ¥å‚æ•°å€¼
        for (Object param : parameters) {
            if (!isParameterSafe(param)) {
                throw new SecurityException("Unsafe parameter detected: " + param);
            }
        }
    }
}
```

### 5.3 ç™½åå•ä¸é»‘åå•æœºåˆ¶


**ğŸ”¸ æŸ¥è¯¢æ¨¡æ¿ç™½åå•**
```java
public class QueryTemplateWhitelist {
    
    // é¢„å®šä¹‰çš„å®‰å…¨æŸ¥è¯¢æ¨¡æ¿
    private static final Map<String, String> APPROVED_TEMPLATES = Map.of(
        "findUserById", "SELECT * FROM users WHERE id = ?",
        "findUsersByCity", "SELECT * FROM users WHERE city = ? AND status = 'active'",
        "updateUserEmail", "UPDATE users SET email = ? WHERE id = ?",
        "getUserStatsByDate", "SELECT COUNT(*) FROM users WHERE created_at >= ?"
    );
    
    public String getApprovedTemplate(String templateName) {
        String template = APPROVED_TEMPLATES.get(templateName);
        if (template == null) {
            throw new SecurityException("Template not in whitelist: " + templateName);
        }
        return template;
    }
    
    // å®‰å…¨æ‰§è¡ŒæŸ¥è¯¢
    public List<User> executeApprovedQuery(String templateName, Object... params) {
        String sql = getApprovedTemplate(templateName);
        
        try (PreparedStatement ps = conn.prepareStatement(sql)) {
            bindParameters(ps, params);
            return executeQuery(ps);
        }
    }
}
```

---

## 6. âœ… å‚æ•°éªŒè¯ç­–ç•¥


### 6.1 å‚æ•°éªŒè¯çš„é‡è¦æ€§


**ğŸ”¸ ä¸ºä»€ä¹ˆè¦éªŒè¯å‚æ•°ï¼Ÿ**
å‚æ•°éªŒè¯å°±åƒæ˜¯**é—¨å«æ£€æŸ¥èº«ä»½è¯**ï¼Œç¡®ä¿è¿›å…¥ç³»ç»Ÿçš„æ•°æ®æ˜¯åˆæ³•çš„ï¼š

```
æ²¡æœ‰å‚æ•°éªŒè¯çš„é—®é¢˜ï¼š

ç”¨æˆ·è¾“å…¥ï¼šage = -5
æ•°æ®åº“æŸ¥è¯¢ï¼šWHERE age > -5
ç»“æœï¼šè¿”å›æ‰€æœ‰ç”¨æˆ·ï¼ˆé€»è¾‘é”™è¯¯ï¼‰

ç”¨æˆ·è¾“å…¥ï¼šlimit = 999999999
æ•°æ®åº“æŸ¥è¯¢ï¼šLIMIT 999999999  
ç»“æœï¼šæ¶ˆè€—å¤§é‡å†…å­˜å’ŒCPUï¼ˆæ€§èƒ½é—®é¢˜ï¼‰

ç”¨æˆ·è¾“å…¥ï¼šuserId = "abc123"
æ•°æ®åº“æŸ¥è¯¢ï¼šWHERE id = 'abc123'
ç»“æœï¼šç±»å‹ä¸åŒ¹é…ï¼ŒæŸ¥è¯¢å¤±è´¥ï¼ˆç³»ç»Ÿé”™è¯¯ï¼‰
```

### 6.2 å‚æ•°éªŒè¯å±‚æ¬¡


**ğŸ”¸ å¤šå±‚éªŒè¯ä½“ç³»**
```
éªŒè¯å±‚æ¬¡ç»“æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. å‰ç«¯éªŒè¯ï¼ˆç”¨æˆ·ä½“éªŒï¼‰      â”‚ â† JavaScriptè¡¨å•éªŒè¯
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. æ¥å£éªŒè¯ï¼ˆæ•°æ®æ ¼å¼ï¼‰      â”‚ â† Controllerå±‚å‚æ•°æ ¡éªŒ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. ä¸šåŠ¡éªŒè¯ï¼ˆé€»è¾‘è§„åˆ™ï¼‰      â”‚ â† Serviceå±‚ä¸šåŠ¡è§„åˆ™
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. æ•°æ®éªŒè¯ï¼ˆå­˜å‚¨çº¦æŸï¼‰      â”‚ â† DAOå±‚æ•°æ®åº“çº¦æŸ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ¯å±‚éªŒè¯çš„ç›®çš„ï¼š
â€¢ å‰ç«¯ï¼šå‡å°‘æ— æ•ˆè¯·æ±‚ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
â€¢ æ¥å£ï¼šç¡®ä¿æ•°æ®æ ¼å¼æ­£ç¡®  
â€¢ ä¸šåŠ¡ï¼šç¬¦åˆä¸šåŠ¡é€»è¾‘è§„åˆ™
â€¢ æ•°æ®ï¼šæ»¡è¶³æ•°æ®åº“çº¦æŸæ¡ä»¶
```

### 6.3 å‚æ•°éªŒè¯å®ç°


**ğŸ”¸ åŸºæœ¬ç±»å‹éªŒè¯**
```java
public class ParameterValidator {
    
    // æ•´æ•°å‚æ•°éªŒè¯
    public static void validateInteger(Object param, String paramName, 
                                     Integer min, Integer max) {
        if (param == null) {
            throw new IllegalArgumentException(paramName + " cannot be null");
        }
        
        if (!(param instanceof Integer)) {
            throw new IllegalArgumentException(paramName + " must be integer");
        }
        
        Integer value = (Integer) param;
        if (min != null && value < min) {
            throw new IllegalArgumentException(paramName + " must be >= " + min);
        }
        
        if (max != null && value > max) {
            throw new IllegalArgumentException(paramName + " must be <= " + max);
        }
    }
    
    // å­—ç¬¦ä¸²å‚æ•°éªŒè¯
    public static void validateString(Object param, String paramName, 
                                    int maxLength, Pattern pattern) {
        if (param == null) return;  // å…è®¸null
        
        if (!(param instanceof String)) {
            throw new IllegalArgumentException(paramName + " must be string");
        }
        
        String value = (String) param;
        
        // é•¿åº¦æ£€æŸ¥
        if (value.length() > maxLength) {
            throw new IllegalArgumentException(paramName + " too long, max: " + maxLength);
        }
        
        // æ ¼å¼æ£€æŸ¥
        if (pattern != null && !pattern.matcher(value).matches()) {
            throw new IllegalArgumentException(paramName + " format invalid");
        }
    }
}
```

**ğŸ”¸ å¤åˆå‚æ•°éªŒè¯**
```java
// ç”¨æˆ·æŸ¥è¯¢æ¡ä»¶éªŒè¯
public class UserQueryValidator {
    
    public void validateUserQuery(UserQueryCondition condition) {
        // å¹´é¾„èŒƒå›´éªŒè¯
        if (condition.getMinAge() != null) {
            ParameterValidator.validateInteger(condition.getMinAge(), "minAge", 0, 150);
        }
        
        if (condition.getMaxAge() != null) {
            ParameterValidator.validateInteger(condition.getMaxAge(), "maxAge", 0, 150);
        }
        
        // å¹´é¾„èŒƒå›´é€»è¾‘éªŒè¯
        if (condition.getMinAge() != null && condition.getMaxAge() != null) {
            if (condition.getMinAge() > condition.getMaxAge()) {
                throw new IllegalArgumentException("minAge cannot be greater than maxAge");
            }
        }
        
        // åŸå¸‚åç§°éªŒè¯
        if (condition.getCity() != null) {
            Pattern cityPattern = Pattern.compile("^[\\u4e00-\\u9fa5a-zA-Z\\s]{1,50}$");
            ParameterValidator.validateString(condition.getCity(), "city", 50, cityPattern);
        }
        
        // åˆ†é¡µå‚æ•°éªŒè¯
        if (condition.getLimit() != null) {
            ParameterValidator.validateInteger(condition.getLimit(), "limit", 1, 1000);
        }
    }
}
```

### 6.4 å‚æ•°éªŒè¯æœ€ä½³å®è·µ


**ğŸ”¸ éªŒè¯ç­–ç•¥è®¾è®¡**
```
ğŸ¯ éªŒè¯æ—¶æœºï¼š
â€¢ å°½æ—©éªŒè¯ï¼šåœ¨ä¸šåŠ¡é€»è¾‘æ‰§è¡Œå‰éªŒè¯
â€¢ åˆ†å±‚éªŒè¯ï¼šä¸åŒå±‚æ¬¡åšä¸åŒç±»å‹çš„éªŒè¯
â€¢ ç¼“å­˜éªŒè¯ç»“æœï¼šé¿å…é‡å¤éªŒè¯ç›¸åŒå‚æ•°

ğŸ¯ é”™è¯¯å¤„ç†ï¼š
â€¢ æ˜ç¡®é”™è¯¯ä¿¡æ¯ï¼šå‘Šè¯‰ç”¨æˆ·å…·ä½“å“ªé‡Œé”™äº†
â€¢ é”™è¯¯åˆ†ç±»ï¼šåŒºåˆ†æ ¼å¼é”™è¯¯ã€ä¸šåŠ¡é”™è¯¯ã€ç³»ç»Ÿé”™è¯¯
â€¢ æ—¥å¿—è®°å½•ï¼šè®°å½•éªŒè¯å¤±è´¥çš„è¯¦ç»†ä¿¡æ¯

ğŸ¯ æ€§èƒ½è€ƒè™‘ï¼š
â€¢ å¿«é€Ÿå¤±è´¥ï¼šä¸€æ—¦å‘ç°é”™è¯¯ç«‹å³è¿”å›
â€¢ æ‰¹é‡éªŒè¯ï¼šä¸€æ¬¡éªŒè¯å¤šä¸ªå‚æ•°
â€¢ éªŒè¯ç¼“å­˜ï¼šç¼“å­˜å¤æ‚éªŒè¯çš„ç»“æœ
```

**ğŸ”¸ éªŒè¯é…ç½®åŒ–**
```java
// åŸºäºé…ç½®çš„éªŒè¯è§„åˆ™
@Configuration
public class ValidationConfig {
    
    @Bean
    public Map<String, ParameterRule> validationRules() {
        Map<String, ParameterRule> rules = new HashMap<>();
        
        // ç”¨æˆ·IDéªŒè¯è§„åˆ™
        rules.put("userId", ParameterRule.builder()
            .type(Integer.class)
            .required(true)
            .min(1)
            .max(999999999)
            .build());
        
        // ç”¨æˆ·åéªŒè¯è§„åˆ™  
        rules.put("userName", ParameterRule.builder()
            .type(String.class)
            .required(false)
            .maxLength(50)
            .pattern("^[a-zA-Z0-9_]{3,50}$")
            .build());
        
        return rules;
    }
}

// é€šç”¨éªŒè¯å™¨
public class ConfigurableValidator {
    
    private final Map<String, ParameterRule> rules;
    
    public void validate(String paramName, Object value) {
        ParameterRule rule = rules.get(paramName);
        if (rule != null) {
            rule.validate(paramName, value);
        }
    }
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 æŸ¥è¯¢æ¨¡æ¿æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æŸ¥è¯¢æ¨¡æ¿æœ¬è´¨ï¼š
â€¢ ç»“æ„å›ºå®šçš„SQLè¯­å¥ï¼Œå‚æ•°ç”¨å ä½ç¬¦è¡¨ç¤º
â€¢ ç±»ä¼¼äºå‡½æ•°å®šä¹‰ï¼Œå¯ä»¥é‡å¤è°ƒç”¨
â€¢ å®ç°äº†SQLé€»è¾‘ä¸æ•°æ®çš„åˆ†ç¦»

ğŸ”¸ å‚æ•°åŒ–æŸ¥è¯¢ä»·å€¼ï¼š
â€¢ å®‰å…¨æ€§ï¼šé˜²æ­¢SQLæ³¨å…¥æ”»å‡»
â€¢ æ€§èƒ½ï¼šSQLè§£æä¸€æ¬¡ï¼Œæ‰§è¡Œå¤šæ¬¡
â€¢ ç»´æŠ¤æ€§ï¼šä»£ç æ›´æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤
```

### 7.2 æŠ€æœ¯å®ç°è¦ç‚¹


```
ğŸ”§ å‚æ•°åŒ–å®ç°æŠ€æœ¯ï¼š
â€¢ PreparedStatementï¼šJDBCæ ‡å‡†å®ç°
â€¢ åŠ¨æ€å‚æ•°ç»‘å®šï¼šåŸºäºåå°„çš„é€šç”¨ç»‘å®š
â€¢ æ‰¹é‡æ“ä½œï¼šæé«˜å¤§é‡æ•°æ®å¤„ç†æ•ˆç‡

ğŸ—„ï¸ æ¨¡æ¿ç¼“å­˜æœºåˆ¶ï¼š
â€¢ ç¼“å­˜é”®è®¾è®¡ï¼šSQLæ¨¡æ¿+å‚æ•°ç±»å‹+ç‰ˆæœ¬
â€¢ LRUæ·˜æ±°ç­–ç•¥ï¼šä¿æŒç¼“å­˜å¤§å°åˆç†
â€¢ ç¼“å­˜é¢„çƒ­ï¼šç³»ç»Ÿå¯åŠ¨æ—¶åŠ è½½å¸¸ç”¨æ¨¡æ¿
```

### 7.3 å®‰å…¨é˜²æŠ¤ä½“ç³»


```
ğŸ›¡ï¸ å®‰å…¨æ£€æŸ¥å±‚æ¬¡ï¼š
â€¢ æ¨¡æ¿é™æ€æ£€æŸ¥ï¼šéªŒè¯SQLæ¨¡æ¿æœ¬èº«çš„å®‰å…¨æ€§
â€¢ å‚æ•°åŠ¨æ€æ£€æŸ¥ï¼šéªŒè¯å‚æ•°å€¼çš„åˆæ³•æ€§  
â€¢ ç™½åå•æœºåˆ¶ï¼šåªå…è®¸é¢„å®šä¹‰çš„å®‰å…¨æ¨¡æ¿
â€¢ è¿è¡Œæ—¶ç›‘æ§ï¼šæ£€æµ‹å¼‚å¸¸çš„æŸ¥è¯¢è¡Œä¸º

âœ… å‚æ•°éªŒè¯ç­–ç•¥ï¼š
â€¢ ç±»å‹éªŒè¯ï¼šç¡®ä¿å‚æ•°ç±»å‹æ­£ç¡®
â€¢ èŒƒå›´éªŒè¯ï¼šæ£€æŸ¥æ•°å€¼å’Œé•¿åº¦èŒƒå›´
â€¢ æ ¼å¼éªŒè¯ï¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼éªŒè¯æ ¼å¼
â€¢ ä¸šåŠ¡éªŒè¯ï¼šç¬¦åˆä¸šåŠ¡é€»è¾‘è§„åˆ™
```

### 7.4 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


```
âš¡ æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–ï¼š
â€¢ æ‰§è¡Œè®¡åˆ’é‡ç”¨ï¼šç›¸åŒæ¨¡æ¿å…±äº«æ‰§è¡Œè®¡åˆ’
â€¢ å‚æ•°ç»Ÿè®¡ï¼šæ•°æ®åº“æ ¹æ®å‚æ•°åˆ†å¸ƒä¼˜åŒ–
â€¢ æ‰¹é‡å¤„ç†ï¼šå‡å°‘ç½‘ç»œå¾€è¿”æ¬¡æ•°
â€¢ è¿æ¥æ± ç®¡ç†ï¼šå‡å°‘è¿æ¥å»ºç«‹å¼€é”€

ğŸ¯ æ¨¡æ¿è®¾è®¡ä¼˜åŒ–ï¼š
â€¢ å•ä¸€èŒè´£ï¼šä¸€ä¸ªæ¨¡æ¿è§£å†³ä¸€ä¸ªé—®é¢˜
â€¢ å‚æ•°æœ€å°åŒ–ï¼šåªæš´éœ²å¿…è¦çš„å‚æ•°
â€¢ æ ‡å‡†åŒ–ï¼šç»Ÿä¸€çš„æ¨¡æ¿ç¼–å†™è§„èŒƒ
â€¢ å¯æµ‹è¯•æ€§ï¼šä¾¿äºå•å…ƒæµ‹è¯•å’Œæ€§èƒ½æµ‹è¯•
```

### 7.5 å®é™…åº”ç”¨æŒ‡å¯¼


```
ğŸ”¸ ä½•æ—¶ä½¿ç”¨æŸ¥è¯¢æ¨¡æ¿ï¼š
âœ… é‡å¤æ‰§è¡Œçš„æŸ¥è¯¢ï¼šç›¸åŒç»“æ„ï¼Œä¸åŒå‚æ•°
âœ… å®‰å…¨è¦æ±‚é«˜çš„æŸ¥è¯¢ï¼šç”¨æˆ·è¾“å…¥ä½œä¸ºæŸ¥è¯¢æ¡ä»¶
âœ… æ€§èƒ½è¦æ±‚é«˜çš„æŸ¥è¯¢ï¼šéœ€è¦é‡ç”¨æ‰§è¡Œè®¡åˆ’
âœ… ä»£ç ç»´æŠ¤æ€§è¦æ±‚ï¼šæŸ¥è¯¢é€»è¾‘éœ€è¦æ¸…æ™°

ğŸ”¸ å®æ–½å»ºè®®ï¼š
â€¢ ä»é«˜é¢‘æŸ¥è¯¢å¼€å§‹ï¼šå…ˆä¼˜åŒ–æœ€å¸¸ç”¨çš„æŸ¥è¯¢
â€¢ æ¸è¿›å¼æ”¹é€ ï¼šé€æ­¥æ›¿æ¢å­—ç¬¦ä¸²æ‹¼æ¥æ–¹å¼
â€¢ å»ºç«‹è§„èŒƒï¼šåˆ¶å®šå›¢é˜Ÿçš„æ¨¡æ¿ç¼–å†™æ ‡å‡†
â€¢ ç›‘æ§æ•ˆæœï¼šè·Ÿè¸ªæ€§èƒ½æå‡å’Œå®‰å…¨æ”¹å–„
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- æŸ¥è¯¢æ¨¡æ¿å ä½ç¬¦ï¼Œå®‰å…¨é«˜æ•ˆåˆæ¸…æ™°
- å‚æ•°ç»‘å®šé˜²æ³¨å…¥ï¼Œç¼“å­˜é‡ç”¨ææ€§èƒ½
- éªŒè¯æ£€æŸ¥å¤šå±‚æ¬¡ï¼Œç™½åå•æœºåˆ¶ä¿å®‰å…¨
- åŠ¨æ€ç»‘å®šçµæ´»ç”¨ï¼Œæ¨¡æ¿è®¾è®¡éœ€è§„èŒƒ