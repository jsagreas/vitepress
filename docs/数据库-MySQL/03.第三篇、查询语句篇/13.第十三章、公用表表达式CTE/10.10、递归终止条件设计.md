---
title: 10ã€é€’å½’ç»ˆæ­¢æ¡ä»¶è®¾è®¡
---
## ğŸ“š ç›®å½•

1. [é€’å½’CTEåŸºç¡€æ¦‚å¿µ](#1-é€’å½’CTEåŸºç¡€æ¦‚å¿µ)
2. [ç»ˆæ­¢æ¡ä»¶é€»è¾‘è®¾è®¡](#2-ç»ˆæ­¢æ¡ä»¶é€»è¾‘è®¾è®¡)
3. [é€’å½’è¾¹ç•Œå¤„ç†æœºåˆ¶](#3-é€’å½’è¾¹ç•Œå¤„ç†æœºåˆ¶)
4. [å¼‚å¸¸é€’å½’é˜²æŠ¤ç­–ç•¥](#4-å¼‚å¸¸é€’å½’é˜²æŠ¤ç­–ç•¥)
5. [ä¸šåŠ¡è§„åˆ™ç»ˆæ­¢æ¡ä»¶](#5-ä¸šåŠ¡è§„åˆ™ç»ˆæ­¢æ¡ä»¶)
6. [æ•°æ®å®Œæ•´æ€§ä¿è¯æ–¹æ¡ˆ](#6-æ•°æ®å®Œæ•´æ€§ä¿è¯æ–¹æ¡ˆ)
7. [ç»ˆæ­¢æ¡ä»¶æµ‹è¯•éªŒè¯](#7-ç»ˆæ­¢æ¡ä»¶æµ‹è¯•éªŒè¯)
8. [é€’å½’å®‰å…¨æ€§ä¿éšœæœºåˆ¶](#8-é€’å½’å®‰å…¨æ€§ä¿éšœæœºåˆ¶)
9. [å¸¸è§ç»ˆæ­¢æ¡ä»¶è®¾è®¡æ¨¡å¼](#9-å¸¸è§ç»ˆæ­¢æ¡ä»¶è®¾è®¡æ¨¡å¼)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”„ é€’å½’CTEåŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯é€’å½’CTE


**ğŸ”¸ é€šä¿—ç†è§£**
```
é€’å½’CTEå°±åƒä¿„ç½—æ–¯å¥—å¨ƒï¼š
â€¢ å¤–å±‚å¨ƒå¨ƒåŒ…å«å†…å±‚å¨ƒå¨ƒ
â€¢ æ¯å±‚å¨ƒå¨ƒéƒ½æœ‰ç›¸åŒçš„ç»“æ„
â€¢ æœ€é‡Œé¢æ˜¯æœ€å°çš„å¨ƒå¨ƒï¼ˆé€’å½’çš„ç»ˆç‚¹ï¼‰

åœ¨æ•°æ®åº“ä¸­ï¼š
â€¢ é€’å½’æŸ¥è¯¢è‡ªå·±è°ƒç”¨è‡ªå·±
â€¢ æ¯æ¬¡æŸ¥è¯¢éƒ½åŸºäºä¸Šæ¬¡çš„ç»“æœ
â€¢ å¿…é¡»æœ‰åœæ­¢æ¡ä»¶ï¼Œå¦åˆ™ä¼šæ— é™å¾ªç¯
```

**ğŸ“‹ é€’å½’CTEè¯­æ³•ç»“æ„**
```sql
WITH RECURSIVE cte_name (column_list) AS (
    -- é”šå®šéƒ¨åˆ†ï¼ˆåˆå§‹æŸ¥è¯¢ï¼‰
    SELECT initial_columns FROM initial_table WHERE initial_condition
    
    UNION ALL
    
    -- é€’å½’éƒ¨åˆ†ï¼ˆå¼•ç”¨è‡ªå·±ï¼‰
    SELECT recursive_columns 
    FROM initial_table t
    JOIN cte_name c ON join_condition
    WHERE termination_condition  -- ğŸ”‘ è¿™é‡Œæ˜¯ç»ˆæ­¢æ¡ä»¶ï¼
)
SELECT * FROM cte_name;
```

### 1.2 é€’å½’æ‰§è¡Œè¿‡ç¨‹


**ğŸ”„ é€’å½’CTEæ‰§è¡Œæµç¨‹**
```
ç¬¬1æ­¥ï¼šæ‰§è¡Œé”šå®šæŸ¥è¯¢ â†’ å¾—åˆ°åˆå§‹ç»“æœé›†
ç¬¬2æ­¥ï¼šç”¨åˆå§‹ç»“æœ + åŸè¡¨ â†’ æ‰§è¡Œé€’å½’æŸ¥è¯¢ â†’ å¾—åˆ°æ–°ç»“æœ
ç¬¬3æ­¥ï¼šç”¨æ–°ç»“æœ + åŸè¡¨ â†’ æ‰§è¡Œé€’å½’æŸ¥è¯¢ â†’ å¾—åˆ°æ›´æ–°ç»“æœ
...
ç¬¬Næ­¥ï¼šé€’å½’æŸ¥è¯¢è¿”å›ç©ºç»“æœ â†’ é€’å½’ç»ˆæ­¢
```

**ğŸ’¡ ç®€å•ç¤ºä¾‹æ¼”ç¤º**
```sql
-- æ•°å­—åºåˆ—é€’å½’ç¤ºä¾‹
WITH RECURSIVE number_sequence (n) AS (
    SELECT 1 AS n          -- é”šå®šï¼šä»1å¼€å§‹
    UNION ALL
    SELECT n + 1           -- é€’å½’ï¼šæ¯æ¬¡åŠ 1
    FROM number_sequence
    WHERE n < 5            -- ğŸ”‘ ç»ˆæ­¢æ¡ä»¶ï¼šå°äº5
)
SELECT * FROM number_sequence;
-- ç»“æœï¼š1, 2, 3, 4, 5
```

> **ğŸ’¡ æ ¸å¿ƒç†è§£ï¼š** é€’å½’ç»ˆæ­¢æ¡ä»¶æ˜¯é€’å½’CTEçš„"åˆ¹è½¦"ï¼Œæ²¡æœ‰å®ƒå°±åƒå¼€è½¦æ²¡æœ‰åˆ¹è½¦ä¸€æ ·å±é™©ï¼

---

## 2. ğŸ›¡ï¸ ç»ˆæ­¢æ¡ä»¶é€»è¾‘è®¾è®¡


### 2.1 ç»ˆæ­¢æ¡ä»¶çš„é‡è¦æ€§


**ğŸ”¸ ä¸ºä»€ä¹ˆç»ˆæ­¢æ¡ä»¶å¦‚æ­¤é‡è¦**
```
æ²¡æœ‰ç»ˆæ­¢æ¡ä»¶çš„é€’å½’å°±åƒï¼š
â€¢ ä¸¤é¢é•œå­ç›¸å¯¹äº§ç”Ÿçš„æ— é™åå°„
â€¢ ç¨‹åºè¿›å…¥æ­»å¾ªç¯
â€¢ æ•°æ®åº“èµ„æºè¢«è€—å°½
â€¢ æŸ¥è¯¢æ°¸è¿œä¸è¿”å›ç»“æœ

ç»ˆæ­¢æ¡ä»¶çš„ä½œç”¨ï¼š
â€¢ ä¿è¯é€’å½’æœ‰æ˜ç¡®çš„ç»“æŸç‚¹
â€¢ é˜²æ­¢æ— é™å¾ªç¯æ¶ˆè€—ç³»ç»Ÿèµ„æº
â€¢ ç¡®ä¿æŸ¥è¯¢èƒ½å¤Ÿæ­£å¸¸è¿”å›ç»“æœ
â€¢ ä¿æŠ¤æ•°æ®åº“ç³»ç»Ÿç¨³å®šæ€§
```

### 2.2 ç»ˆæ­¢æ¡ä»¶è®¾è®¡åŸåˆ™


**ğŸ“‹ è®¾è®¡åŸåˆ™æ€»è§ˆ**

| åŸåˆ™ | **è¯´æ˜** | **ç¤ºä¾‹åœºæ™¯** |
|------|----------|-------------|
| **æ˜ç¡®æ€§** | æ¡ä»¶è¡¨è¾¾æ¸…æ™°ï¼Œä¸æ¨¡ç³Š | `depth < 10` è€Œé `some_flag = 1` |
| **å¯è¾¾æ€§** | æ¡ä»¶å¿…é¡»èƒ½å¤Ÿè¾¾åˆ° | é€’å½’è¿‡ç¨‹ä¸­æ¡ä»¶å€¼ä¼šå‘ç”Ÿå˜åŒ– |
| **å®‰å…¨æ€§** | æœ‰å¤šé‡ä¿æŠ¤æœºåˆ¶ | æ—¢æ£€æŸ¥ä¸šåŠ¡æ¡ä»¶åˆæ£€æŸ¥é€’å½’æ·±åº¦ |
| **ä¸šåŠ¡ç›¸å…³** | ç¬¦åˆå®é™…ä¸šåŠ¡é€»è¾‘ | ç»„ç»‡å±‚çº§ã€åˆ†ç±»æ ‘çš„å®é™…è¾¹ç•Œ |

**ğŸ¯ ç»ˆæ­¢æ¡ä»¶ç±»å‹åˆ†ç±»**
```
æ·±åº¦é™åˆ¶å‹ï¼šdepth <= 10
æ•°æ®é©±åŠ¨å‹ï¼šparent_id IS NULL
è®¡æ•°é™åˆ¶å‹ï¼šrecord_count >= 1000
ä¸šåŠ¡é€»è¾‘å‹ï¼šstatus = 'final'
```

### 2.3 åŸºç¡€ç»ˆæ­¢æ¡ä»¶æ¨¡å¼


**ğŸ”¢ æ·±åº¦é™åˆ¶ç»ˆæ­¢**
```sql
-- ç»„ç»‡æ¶æ„æŸ¥è¯¢ç¤ºä¾‹
CREATE TABLE employees (
    emp_id INT PRIMARY KEY,
    emp_name VARCHAR(50),
    manager_id INT
);

WITH RECURSIVE employee_hierarchy (emp_id, emp_name, level_depth) AS (
    -- é”šå®šï¼šä»é¡¶çº§ç»ç†å¼€å§‹
    SELECT emp_id, emp_name, 1 FROM employees WHERE manager_id IS NULL
    UNION ALL
    -- é€’å½’ï¼šæŸ¥æ‰¾ä¸‹çº§å‘˜å·¥
    SELECT e.emp_id, e.emp_name, eh.level_depth + 1
    FROM employees e
    JOIN employee_hierarchy eh ON e.manager_id = eh.emp_id
    WHERE eh.level_depth < 5  -- ğŸ”‘ ç»ˆæ­¢æ¡ä»¶ï¼šæœ€å¤§5å±‚æ·±åº¦
)
SELECT emp_name, level_depth FROM employee_hierarchy;
```

**ğŸš« æ•°æ®è¾¹ç•Œç»ˆæ­¢**
```sql
-- åˆ†ç±»æ ‘æŸ¥è¯¢ç¤ºä¾‹
CREATE TABLE categories (
    cat_id INT PRIMARY KEY,
    cat_name VARCHAR(50),
    parent_cat_id INT,
    is_leaf BOOLEAN DEFAULT FALSE
);

WITH RECURSIVE category_tree (cat_id, cat_name, path, level_num) AS (
    -- é”šå®šï¼šä»æ ¹åˆ†ç±»å¼€å§‹
    SELECT cat_id, cat_name, cat_name, 1
    FROM categories WHERE parent_cat_id IS NULL
    UNION ALL
    -- é€’å½’ï¼šæŸ¥æ‰¾å­åˆ†ç±»
    SELECT c.cat_id, c.cat_name, CONCAT(ct.path, ' > ', c.cat_name), ct.level_num + 1
    FROM categories c
    JOIN category_tree ct ON c.parent_cat_id = ct.cat_id
    WHERE NOT c.is_leaf  -- ğŸ”‘ ç»ˆæ­¢æ¡ä»¶ï¼šä¸æ˜¯å¶å­èŠ‚ç‚¹æ‰ç»§ç»­
)
SELECT cat_name, path FROM category_tree;
```

---

## 3. âš–ï¸ é€’å½’è¾¹ç•Œå¤„ç†æœºåˆ¶


### 3.1 è¾¹ç•Œæ¡ä»¶è¯†åˆ«


**ğŸ”¸ ä»€ä¹ˆæ˜¯é€’å½’è¾¹ç•Œ**
```
é€’å½’è¾¹ç•Œå°±åƒçˆ¬æ¥¼æ¢¯çš„é¡¶å±‚ï¼š
â€¢ æ˜ç¡®çš„ç»ˆç‚¹ï¼šåˆ°è¾¾é¡¶å±‚å°±åœæ­¢
â€¢ å¯è¯†åˆ«æ€§ï¼šèƒ½æ¸…æ¥šåˆ¤æ–­æ˜¯å¦åˆ°è¾¾è¾¹ç•Œ
â€¢ é€»è¾‘æ€§ï¼šç¬¦åˆä¸šåŠ¡é€»è¾‘çš„è‡ªç„¶ç»ˆç‚¹

å¸¸è§è¾¹ç•Œç±»å‹ï¼š
â€¢ ç©ºå€¼è¾¹ç•Œï¼šparent_id IS NULL
â€¢ æ•°å€¼è¾¹ç•Œï¼šlevel >= max_level
â€¢ çŠ¶æ€è¾¹ç•Œï¼šstatus = 'final'
â€¢ é›†åˆè¾¹ç•Œï¼šæ²¡æœ‰æ›´å¤šå­èŠ‚ç‚¹
```

### 3.2 å¤šé‡è¾¹ç•Œä¿æŠ¤


**ğŸ›¡ï¸ åŒé‡è¾¹ç•Œä¿æŠ¤è®¾è®¡**
```sql
-- è·¯å¾„æŸ¥æ‰¾çš„å¤šé‡ç»ˆæ­¢æ¡ä»¶
CREATE TABLE network_connections (
    from_node INT,
    to_node INT,
    distance DECIMAL(8,2),
    is_active BOOLEAN DEFAULT TRUE
);

WITH RECURSIVE path_finder (current_node, target_node, path_nodes, hop_count) AS (
    -- é”šå®šï¼šä»èµ·ç‚¹å¼€å§‹
    SELECT 1, 4, '1', 0
    UNION ALL
    -- é€’å½’ï¼šæ‰©å±•è·¯å¾„
    SELECT nc.to_node, pf.target_node, CONCAT(pf.path_nodes, '->', nc.to_node), pf.hop_count + 1
    FROM path_finder pf
    JOIN network_connections nc ON pf.current_node = nc.from_node
    WHERE pf.current_node != pf.target_node          -- ğŸ”‘ ç»ˆæ­¢æ¡ä»¶1ï¼šæœªåˆ°è¾¾ç›®æ ‡
      AND pf.hop_count < 10                          -- ğŸ”‘ ç»ˆæ­¢æ¡ä»¶2ï¼šæœ€å¤§è·³æ•°é™åˆ¶
      AND nc.is_active = TRUE                        -- ğŸ”‘ ç»ˆæ­¢æ¡ä»¶3ï¼šè¿æ¥æœ‰æ•ˆ
      AND FIND_IN_SET(nc.to_node, pf.path_nodes) = 0 -- ğŸ”‘ ç»ˆæ­¢æ¡ä»¶4ï¼šé¿å…å¾ªç¯
)
SELECT path_nodes, hop_count FROM path_finder WHERE current_node = target_node;
```

### 3.3 å¾ªç¯æ£€æµ‹æœºåˆ¶


**ğŸ” é¿å…æ— é™å¾ªç¯çš„è®¾è®¡**
```sql
-- å¸¦å¾ªç¯æ£€æµ‹çš„ç»„ç»‡æ¶æ„æŸ¥è¯¢
WITH RECURSIVE org_hierarchy (emp_id, emp_name, level_depth, path_trace) AS (
    -- é”šå®š
    SELECT emp_id, emp_name, 1, CAST(emp_id AS CHAR(200))
    FROM employees WHERE manager_id IS NULL
    UNION ALL
    -- é€’å½’ï¼ˆå¸¦å¾ªç¯æ£€æµ‹ï¼‰
    SELECT o.emp_id, o.emp_name, oh.level_depth + 1, CONCAT(oh.path_trace, '->', o.emp_id)
    FROM employees o
    JOIN org_hierarchy oh ON o.manager_id = oh.emp_id
    WHERE oh.level_depth < 20                                    -- ğŸ”‘ æ·±åº¦é™åˆ¶
      AND FIND_IN_SET(o.emp_id, REPLACE(oh.path_trace, '->', ',')) = 0  -- ğŸ”‘ å¾ªç¯æ£€æµ‹
)
SELECT emp_name, level_depth, path_trace FROM org_hierarchy;
```

---

## 4. ğŸš¨ å¼‚å¸¸é€’å½’é˜²æŠ¤ç­–ç•¥


### 4.1 é€’å½’æ·±åº¦ä¿æŠ¤


**ğŸ”¸ ä¸ºä»€ä¹ˆéœ€è¦æ·±åº¦ä¿æŠ¤**
```
å¼‚å¸¸æƒ…å†µï¼š
â€¢ æ•°æ®ä¸­å­˜åœ¨å¾ªç¯å¼•ç”¨
â€¢ ä¸šåŠ¡é€»è¾‘é”™è¯¯å¯¼è‡´æ— é™é€’å½’
â€¢ æ•°æ®æŸåé€ æˆçš„å¼‚å¸¸å…³è”

é˜²æŠ¤ç›®æ ‡ï¼š
â€¢ é™åˆ¶æœ€å¤§é€’å½’æ·±åº¦
â€¢ åŠæ—¶å‘ç°å¼‚å¸¸æƒ…å†µ
â€¢ ä¿æŠ¤æ•°æ®åº“èµ„æº
```

**ğŸ›¡ï¸ å¤šå±‚é˜²æŠ¤æœºåˆ¶**
```sql
-- è®¾ç½®MySQLé€’å½’æ·±åº¦é™åˆ¶
SET SESSION cte_max_recursion_depth = 1000;

-- åº”ç”¨çº§æ·±åº¦ä¿æŠ¤
WITH RECURSIVE safe_hierarchy (emp_id, level_depth, safety_check) AS (
    SELECT emp_id, 1, 'OK' FROM employees WHERE manager_id IS NULL
    UNION ALL
    SELECT e.emp_id, sh.level_depth + 1,
           CASE 
               WHEN sh.level_depth >= 10 THEN 'DEPTH_EXCEEDED'
               WHEN e.emp_id = e.manager_id THEN 'SELF_REFERENCE'
               ELSE 'OK'
           END
    FROM employees e
    JOIN safe_hierarchy sh ON e.manager_id = sh.emp_id
    WHERE sh.level_depth < 10          -- ğŸ”‘ ç¡¬æ€§æ·±åº¦é™åˆ¶
      AND sh.safety_check = 'OK'       -- ğŸ”‘ å®‰å…¨çŠ¶æ€æ£€æŸ¥
      AND e.emp_id != e.manager_id     -- ğŸ”‘ é¿å…è‡ªå¼•ç”¨
)
SELECT emp_id, level_depth, safety_check FROM safe_hierarchy;
```

### 4.2 å¼‚å¸¸æ£€æµ‹å’Œæ¢å¤


**ğŸ” é€’å½’å¼‚å¸¸æ£€æµ‹**
```sql
-- æ£€æµ‹æ•°æ®ä¸­çš„æ½œåœ¨é€’å½’é—®é¢˜
SELECT 
    'self_reference' AS issue_type,
    COUNT(*) AS issue_count
FROM employees WHERE emp_id = manager_id

UNION ALL

SELECT 'circular_reference', COUNT(*)
FROM (
    SELECT e1.emp_id FROM employees e1
    JOIN employees e2 ON e1.manager_id = e2.emp_id
    JOIN employees e3 ON e2.manager_id = e3.emp_id
    WHERE e3.manager_id = e1.emp_id  -- 3å±‚å¾ªç¯æ£€æµ‹
) circular_check;
```

---

## 5. ğŸ“Š ä¸šåŠ¡è§„åˆ™ç»ˆæ­¢æ¡ä»¶


### 5.1 çŠ¶æ€æµè½¬ç»ˆæ­¢


**ğŸ”„ è®¢å•çŠ¶æ€æµè½¬æ§åˆ¶**
```sql
-- è®¢å•çŠ¶æ€å˜åŒ–è¡¨
CREATE TABLE order_status_log (
    order_id INT,
    from_status VARCHAR(20),
    to_status VARCHAR(20),
    change_time TIMESTAMP
);

-- è¿½æº¯è®¢å•çŠ¶æ€å˜åŒ–é“¾
WITH RECURSIVE order_trace (order_id, current_status, step_number, trace_path) AS (
    -- é”šå®šï¼šä»æœ€ç»ˆçŠ¶æ€å¼€å§‹
    SELECT order_id, to_status, 1, to_status
    FROM order_status_log 
    WHERE to_status IN ('delivered', 'cancelled')  -- æœ€ç»ˆçŠ¶æ€
    UNION ALL
    -- é€’å½’ï¼šå‘å‰è¿½æº¯
    SELECT osl.order_id, osl.from_status, ot.step_number + 1, 
           CONCAT(osl.from_status, ' <- ', ot.trace_path)
    FROM order_status_log osl
    JOIN order_trace ot ON osl.order_id = ot.order_id AND osl.to_status = ot.current_status
    WHERE osl.from_status IS NOT NULL     -- ğŸ”‘ ç»ˆæ­¢æ¡ä»¶ï¼šåˆ°è¾¾èµ·å§‹çŠ¶æ€
      AND ot.step_number < 20             -- ğŸ”‘ é˜²æ­¢å¼‚å¸¸å¾ªç¯
)
SELECT order_id, trace_path FROM order_trace;
```

### 5.2 æƒé™æ ‘ç»ˆæ­¢æ¡ä»¶


**ğŸ” æƒé™ç»§æ‰¿æŸ¥è¯¢**
```sql
CREATE TABLE roles (
    role_id INT PRIMARY KEY,
    role_name VARCHAR(50),
    parent_role_id INT,
    permission_level INT,
    is_system_role BOOLEAN DEFAULT FALSE
);

-- æƒé™ç»§æ‰¿æŸ¥è¯¢ï¼ˆåŸºäºæƒé™çº§åˆ«ç»ˆæ­¢ï¼‰
WITH RECURSIVE permission_inheritance (role_id, role_name, permission_level, inheritance_depth) AS (
    -- é”šå®šï¼šä»æŒ‡å®šè§’è‰²å¼€å§‹
    SELECT role_id, role_name, permission_level, 0
    FROM roles WHERE role_id = 4
    UNION ALL
    -- é€’å½’ï¼šå‘ä¸Šç»§æ‰¿æƒé™
    SELECT r.role_id, r.role_name, r.permission_level, pi.inheritance_depth + 1
    FROM roles r
    JOIN permission_inheritance pi ON r.role_id = pi.role_id
    WHERE r.permission_level > pi.permission_level  -- ğŸ”‘ æƒé™çº§åˆ«é€’å¢
      AND pi.inheritance_depth < 5                  -- ğŸ”‘ ç»§æ‰¿æ·±åº¦é™åˆ¶
      AND NOT r.is_system_role                      -- ğŸ”‘ éç³»ç»Ÿè§’è‰²
)
SELECT role_name, permission_level, inheritance_depth FROM permission_inheritance;
```

### 5.3 æ—¶é—´çª—å£ç»ˆæ­¢


**â° åŸºäºæ—¶é—´çš„é€’å½’ç»ˆæ­¢**
```sql
-- æ¶ˆæ¯è½¬å‘é“¾è¡¨
CREATE TABLE message_forwards (
    message_id INT,
    from_user_id INT,
    to_user_id INT,
    forward_time TIMESTAMP
);

-- è¿½è¸ª1å°æ—¶å†…çš„æ¶ˆæ¯ä¼ æ’­é“¾
WITH RECURSIVE message_chain (message_id, from_user, to_user, forward_time, chain_level) AS (
    -- é”šå®šï¼šæ¶ˆæ¯æºå¤´
    SELECT message_id, from_user_id, to_user_id, forward_time, 1
    FROM message_forwards WHERE from_user_id = 1001
    UNION ALL
    -- é€’å½’ï¼šè¿½è¸ªè½¬å‘é“¾
    SELECT mf.message_id, mf.from_user_id, mf.to_user_id, mf.forward_time, mc.chain_level + 1
    FROM message_forwards mf
    JOIN message_chain mc ON mf.from_user_id = mc.to_user AND mf.message_id = mc.message_id
    WHERE mc.chain_level < 10                           -- ğŸ”‘ è½¬å‘å±‚æ•°é™åˆ¶
      AND TIMESTAMPDIFF(MINUTE, mc.forward_time, mf.forward_time) <= 60  -- ğŸ”‘ æ—¶é—´çª—å£1å°æ—¶
)
SELECT message_id, from_user, to_user, chain_level FROM message_chain;
```

---

## 6. âœ… æ•°æ®å®Œæ•´æ€§ä¿è¯æ–¹æ¡ˆ


### 6.1 å®Œæ•´æ€§æ£€æŸ¥æœºåˆ¶


**ğŸ”¸ ä»€ä¹ˆæ˜¯é€’å½’ä¸­çš„æ•°æ®å®Œæ•´æ€§**
```
é€’å½’æŸ¥è¯¢çš„å®Œæ•´æ€§é—®é¢˜ï¼š
â€¢ é—æ¼ï¼šæŸäº›åº”è¯¥åŒ…å«çš„æ•°æ®æ²¡æœ‰è¢«æŸ¥è¯¢åˆ°
â€¢ é‡å¤ï¼šåŒä¸€æ•°æ®è¢«å¤šæ¬¡å¤„ç†
â€¢ é”™åºï¼šæ•°æ®çš„å±‚æ¬¡å…³ç³»æ··ä¹±
â€¢ æ–­é“¾ï¼šä¸­é—´èŠ‚ç‚¹ç¼ºå¤±å¯¼è‡´å­æ ‘ä¸¢å¤±

ä¿è¯æ–¹æ³•ï¼š
â€¢ å®Œæ•´æ€§éªŒè¯æŸ¥è¯¢
â€¢ ç»“æœé›†æ ¡éªŒ
â€¢ ä¸šåŠ¡é€»è¾‘éªŒè¯
```

### 6.2 å®Œæ•´æ€§éªŒè¯è®¾è®¡


**ğŸ” é€’å½’ç»“æœå®Œæ•´æ€§æ£€æŸ¥**
```sql
-- éªŒè¯ç»„ç»‡æ¶æ„æŸ¥è¯¢çš„å®Œæ•´æ€§
WITH RECURSIVE full_hierarchy AS (
    SELECT emp_id, 1 AS level_depth FROM employees WHERE manager_id IS NULL
    UNION ALL
    SELECT e.emp_id, fh.level_depth + 1
    FROM employees e
    JOIN full_hierarchy fh ON e.manager_id = fh.emp_id
    WHERE fh.level_depth < 20
),
level_counts AS (
    SELECT level_depth, COUNT(*) AS employee_count
    FROM full_hierarchy 
    GROUP BY level_depth
)
SELECT 
    level_depth,
    employee_count,
    CASE 
        WHEN employee_count > 0 THEN 'å®Œæ•´'
        ELSE 'å¯èƒ½ç¼ºå¤±'
    END AS completeness_status
FROM level_counts;
```

**ğŸ”§ é€’å½’ç»“æœéªŒè¯å‡½æ•°**
```sql
-- åˆ›å»ºå®Œæ•´æ€§éªŒè¯å‡½æ•°
DELIMITER $$
CREATE FUNCTION ValidateRecursiveResult(start_id INT)
RETURNS JSON
READS SQL DATA
DETERMINISTIC
BEGIN
    DECLARE total_nodes INT;
    DECLARE recursive_nodes INT;
    
    -- è®¡ç®—é¢„æœŸèŠ‚ç‚¹æ•°
    SELECT COUNT(*) INTO total_nodes FROM employees;
    
    -- è®¡ç®—é€’å½’æŸ¥è¯¢åˆ°çš„èŠ‚ç‚¹æ•°
    WITH RECURSIVE count_hierarchy AS (
        SELECT emp_id FROM employees WHERE emp_id = start_id
        UNION ALL
        SELECT e.emp_id FROM employees e
        JOIN count_hierarchy ch ON e.manager_id = ch.emp_id
    )
    SELECT COUNT(*) INTO recursive_nodes FROM count_hierarchy;
    
    RETURN JSON_OBJECT(
        'total_nodes', total_nodes,
        'recursive_nodes', recursive_nodes,
        'completeness_rate', ROUND((recursive_nodes * 100.0 / total_nodes), 2)
    );
END$$
DELIMITER ;

SELECT ValidateRecursiveResult(1) AS validation_report;
```

---

## 7. ğŸ§ª ç»ˆæ­¢æ¡ä»¶æµ‹è¯•éªŒè¯


### 7.1 ç»ˆæ­¢æ¡ä»¶æµ‹è¯•ç­–ç•¥


**ğŸ”¸ æµ‹è¯•çš„é‡è¦æ€§**
```
é€’å½’ç»ˆæ­¢æ¡ä»¶æµ‹è¯•å°±åƒæµ‹è¯•æ±½è½¦åˆ¹è½¦ï¼š
â€¢ æ­£å¸¸æƒ…å†µï¼šç¡®ä¿èƒ½å¤Ÿæ­£å¸¸åœæ­¢
â€¢ è¾¹ç•Œæƒ…å†µï¼šæµ‹è¯•æé™æ¡ä»¶ä¸‹çš„è¡¨ç°
â€¢ å¼‚å¸¸æƒ…å†µï¼šéªŒè¯å¼‚å¸¸æ•°æ®çš„å¤„ç†
â€¢ æ€§èƒ½æµ‹è¯•ï¼šç¡®ä¿ä¸ä¼šå½±å“ç³»ç»Ÿæ€§èƒ½

æµ‹è¯•è¦†ç›–ï¼š
â€¢ æ­£å¸¸ç»ˆæ­¢ã€è¾¹ç•Œç»ˆæ­¢ã€å¼‚å¸¸ç»ˆæ­¢ã€ç©ºæ•°æ®å¤„ç†
```

### 7.2 æµ‹è¯•ç”¨ä¾‹è®¾è®¡


**ğŸ“‹ é€’å½’ç»ˆæ­¢æµ‹è¯•å¥—ä»¶**
```sql
-- åˆ›å»ºæµ‹è¯•ç”¨ä¾‹è¡¨
CREATE TABLE recursive_test_cases (
    test_id INT AUTO_INCREMENT PRIMARY KEY,
    test_name VARCHAR(100),
    expected_result_count INT,
    expected_max_depth INT,
    test_status ENUM('pending', 'passed', 'failed')
);

INSERT INTO recursive_test_cases (test_name, expected_result_count, expected_max_depth) VALUES
('æ­£å¸¸å±‚çº§æµ‹è¯•', 5, 4),
('å•èŠ‚ç‚¹æµ‹è¯•', 1, 1),
('æ·±åº¦é™åˆ¶æµ‹è¯•', 10, 10);

-- æµ‹è¯•æ‰§è¡Œå‡½æ•°
DELIMITER $$
CREATE PROCEDURE ExecuteRecursiveTest(IN test_case_id INT)
BEGIN
    DECLARE actual_count INT DEFAULT 0;
    DECLARE actual_depth INT DEFAULT 0;
    
    -- æ‰§è¡Œé€’å½’æŸ¥è¯¢
    WITH RECURSIVE test_hierarchy AS (
        SELECT emp_id, 1 AS depth FROM employees WHERE manager_id IS NULL
        UNION ALL
        SELECT e.emp_id, th.depth + 1
        FROM employees e
        JOIN test_hierarchy th ON e.manager_id = th.emp_id
        WHERE th.depth < 20  -- æµ‹è¯•æ·±åº¦é™åˆ¶
    )
    SELECT COUNT(*), COALESCE(MAX(depth), 0) INTO actual_count, actual_depth 
    FROM test_hierarchy;
    
    -- æ›´æ–°æµ‹è¯•ç»“æœ
    UPDATE recursive_test_cases 
    SET test_status = CASE 
        WHEN actual_count > 0 AND actual_depth > 0 THEN 'passed'
        ELSE 'failed'
    END
    WHERE test_id = test_case_id;
    
    SELECT test_case_id, actual_count, actual_depth;
END$$
DELIMITER ;
```

---

## 8. ğŸ”’ é€’å½’å®‰å…¨æ€§ä¿éšœæœºåˆ¶


### 8.1 å®‰å…¨æ€§ä¿éšœç­–ç•¥


**ğŸ”¸ é€’å½’å®‰å…¨çš„æ ¸å¿ƒè¦ç´ **
```
æ•°æ®å®‰å…¨ï¼šé˜²æ­¢æ— é™é€’å½’æ¶ˆè€—ç³»ç»Ÿèµ„æº
é€»è¾‘å®‰å…¨ï¼šç¡®ä¿é€’å½’é€»è¾‘æ­£ç¡®
æ€§èƒ½å®‰å…¨ï¼šæ§åˆ¶é€’å½’æ·±åº¦å’Œæ‰§è¡Œæ—¶é—´
```

### 8.2 å¤šå±‚å®‰å…¨é˜²æŠ¤


**ğŸ›¡ï¸ é€’å½’å®‰å…¨é˜²æŠ¤ä½“ç³»**
```sql
-- å®‰å…¨é€’å½’æŸ¥è¯¢æ¨¡æ¿
DELIMITER $$
CREATE PROCEDURE SafeRecursiveQuery(
    IN start_id INT,
    IN max_depth INT,
    OUT safety_status VARCHAR(20)
)
BEGIN
    DECLARE result_count INT DEFAULT 0;
    
    SET safety_status = 'safe';
    SET SESSION cte_max_recursion_depth = max_depth;
    
    BEGIN
        DECLARE EXIT HANDLER FOR 3636  -- é€’å½’é™åˆ¶è¶…å‡ºé”™è¯¯
        BEGIN
            SET safety_status = 'depth_exceeded';
        END;
        
        -- å®‰å…¨çš„é€’å½’æŸ¥è¯¢
        WITH RECURSIVE safe_hierarchy AS (
            SELECT emp_id, emp_name, 1 AS level_depth
            FROM employees WHERE emp_id = start_id
            UNION ALL
            SELECT e.emp_id, e.emp_name, sh.level_depth + 1
            FROM employees e
            JOIN safe_hierarchy sh ON e.manager_id = sh.emp_id
            WHERE sh.level_depth < max_depth  -- ğŸ”‘ æ·±åº¦ä¿æŠ¤
        )
        SELECT COUNT(*) INTO result_count FROM safe_hierarchy;
    END;
    
    SELECT result_count AS query_result_count;
END$$
DELIMITER ;

CALL SafeRecursiveQuery(1, 10, @status);
SELECT @status AS safety_status;
```

### 8.3 é€’å½’ç›‘æ§æœºåˆ¶


**ğŸ“Š é€’å½’æ€§èƒ½ç›‘æ§**
```sql
-- é€’å½’æŸ¥è¯¢ç›‘æ§è¡¨
CREATE TABLE recursive_query_monitor (
    monitor_id BIGINT AUTO_INCREMENT PRIMARY KEY,
    query_type VARCHAR(50),
    max_depth INT,
    actual_depth INT,
    result_count INT,
    execution_time_ms INT,
    query_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ç›‘æ§é€’å½’æŸ¥è¯¢æ‰§è¡Œ
DELIMITER $$
CREATE PROCEDURE MonitoredRecursiveQuery(IN start_employee_id INT)
BEGIN
    DECLARE start_time BIGINT;
    DECLARE end_time BIGINT;
    DECLARE result_count INT;
    DECLARE max_depth_found INT;
    
    SET start_time = UNIX_TIMESTAMP(NOW(6)) * 1000000 + MICROSECOND(NOW(6));
    
    WITH RECURSIVE monitored_hierarchy AS (
        SELECT emp_id, 1 AS depth FROM employees WHERE emp_id = start_employee_id
        UNION ALL
        SELECT e.emp_id, mh.depth + 1
        FROM employees e
        JOIN monitored_hierarchy mh ON e.manager_id = mh.emp_id
        WHERE mh.depth < 15  -- ğŸ”‘ å®‰å…¨æ·±åº¦é™åˆ¶
    )
    SELECT COUNT(*), MAX(depth) INTO result_count, max_depth_found FROM monitored_hierarchy;
    
    SET end_time = UNIX_TIMESTAMP(NOW(6)) * 1000000 + MICROSECOND(NOW(6));
    
    INSERT INTO recursive_query_monitor 
    (query_type, max_depth, actual_depth, result_count, execution_time_ms)
    VALUES ('employee_hierarchy', 15, max_depth_found, result_count, (end_time - start_time) / 1000);
END$$
DELIMITER ;
```

---

## 9. ğŸ¨ å¸¸è§ç»ˆæ­¢æ¡ä»¶è®¾è®¡æ¨¡å¼


### 9.1 å±‚çº§æ·±åº¦æ¨¡å¼


**ğŸ“Š æ·±åº¦æ§åˆ¶æ¨¡å¼å¯¹æ¯”**

| æ¨¡å¼ç±»å‹ | **é€‚ç”¨åœºæ™¯** | **ç»ˆæ­¢æ¡ä»¶** | **ä¼˜ç¼ºç‚¹** |
|----------|-------------|-------------|-----------|
| **å›ºå®šæ·±åº¦** | å·²çŸ¥å±‚çº§ç»“æ„ | `level <= N` | ç®€å•å¯é ï¼Œä½†ä¸å¤Ÿçµæ´» |
| **åŠ¨æ€æ·±åº¦** | æ•°æ®é©±åŠ¨çš„æ·±åº¦ | `based on data` | çµæ´»å‡†ç¡®ï¼Œä½†å¤æ‚ |
| **ä¸šåŠ¡æ·±åº¦** | ç¬¦åˆä¸šåŠ¡é€»è¾‘ | `business rules` | è´´åˆå®é™…ï¼Œä½†éœ€è¦ä¸šåŠ¡çŸ¥è¯† |

**ğŸ”§ åŠ¨æ€æ·±åº¦æ§åˆ¶å®ç°**
```sql
-- åŸºäºè§’è‰²çš„åŠ¨æ€æ·±åº¦æ§åˆ¶
WITH RECURSIVE adaptive_hierarchy (emp_id, emp_name, level_depth, max_allowed_depth) AS (
    SELECT emp_id, emp_name, 1,
           CASE 
               WHEN level_code = 'CEO' THEN 10
               WHEN level_code = 'MANAGER' THEN 5
               ELSE 3
           END
    FROM employees WHERE manager_id IS NULL
    UNION ALL
    SELECT e.emp_id, e.emp_name, ah.level_depth + 1, ah.max_allowed_depth
    FROM employees e
    JOIN adaptive_hierarchy ah ON e.manager_id = ah.emp_id
    WHERE ah.level_depth < ah.max_allowed_depth  -- ğŸ”‘ åŠ¨æ€æ·±åº¦ç»ˆæ­¢
)
SELECT emp_name, level_depth, max_allowed_depth FROM adaptive_hierarchy;
```

### 9.2 ä¸šåŠ¡é€»è¾‘æ¨¡å¼


**ğŸ“ˆ é”€å”®å±‚çº§ä½£é‡‘è®¡ç®—**
```sql
CREATE TABLE sales_agents (
    agent_id INT PRIMARY KEY,
    agent_name VARCHAR(50),
    parent_agent_id INT,
    commission_rate DECIMAL(5,4),
    max_inheritance_levels INT
);

-- ä½£é‡‘ç»§æ‰¿é“¾æŸ¥è¯¢
WITH RECURSIVE commission_chain (agent_id, agent_name, commission_rate, inheritance_depth) AS (
    SELECT agent_id, agent_name, commission_rate, 0
    FROM sales_agents WHERE agent_id = 5
    UNION ALL
    SELECT sa.agent_id, sa.agent_name, sa.commission_rate, cc.inheritance_depth + 1
    FROM sales_agents sa
    JOIN commission_chain cc ON sa.agent_id = cc.parent_agent_id
    WHERE cc.inheritance_depth < sa.max_inheritance_levels  -- ğŸ”‘ ç»§æ‰¿å±‚çº§é™åˆ¶
      AND sa.commission_rate > 0                           -- ğŸ”‘ æœ‰ä½£é‡‘æ‰ç»§æ‰¿
)
SELECT agent_name, commission_rate, inheritance_depth FROM commission_chain;
```

### 9.3 æ•°æ®å®Œæ•´æ€§æ¨¡å¼


**âœ… æ•°æ®åŒæ­¥ä¾èµ–é“¾æ£€æŸ¥**
```sql
CREATE TABLE sync_dependencies (
    source_table VARCHAR(50),
    target_table VARCHAR(50),
    dependency_type ENUM('required', 'optional'),
    is_completed BOOLEAN
);

-- æ£€æŸ¥æ•°æ®åŒæ­¥ä¾èµ–é“¾
WITH RECURSIVE sync_chain (table_name, dependency_level, sync_status, can_proceed) AS (
    SELECT source_table, 1, 
           CASE WHEN is_completed THEN 'completed' ELSE 'pending' END,
           is_completed
    FROM sync_dependencies WHERE dependency_id = 1
    UNION ALL
    SELECT sd.target_table, sc.dependency_level + 1,
           CASE WHEN sd.is_completed THEN 'completed' ELSE 'pending' END,
           sd.is_completed AND sc.can_proceed
    FROM sync_dependencies sd
    JOIN sync_chain sc ON sd.source_table = sc.table_name
    WHERE sc.dependency_level < 10                      -- ğŸ”‘ æ·±åº¦é™åˆ¶
      AND (sc.can_proceed OR sd.dependency_type = 'optional')  -- ğŸ”‘ ä¾èµ–æ»¡è¶³
)
SELECT table_name, sync_status, can_proceed FROM sync_chain;
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ é€’å½’CTEï¼šè‡ªå·±è°ƒç”¨è‡ªå·±çš„æŸ¥è¯¢ï¼Œç”¨äºå¤„ç†å±‚çº§æ•°æ®
ğŸ”¸ ç»ˆæ­¢æ¡ä»¶ï¼šé€’å½’çš„"åˆ¹è½¦"ï¼Œå†³å®šä½•æ—¶åœæ­¢é€’å½’
ğŸ”¸ è¾¹ç•Œå¤„ç†ï¼šå¤„ç†é€’å½’çš„è¾¹ç•Œæƒ…å†µå’Œå¼‚å¸¸æ•°æ®
ğŸ”¸ å®‰å…¨é˜²æŠ¤ï¼šé˜²æ­¢æ— é™é€’å½’æ¶ˆè€—ç³»ç»Ÿèµ„æº
ğŸ”¸ å®Œæ•´æ€§ä¿è¯ï¼šç¡®ä¿é€’å½’ç»“æœçš„æ­£ç¡®æ€§å’Œå®Œæ•´æ€§
ğŸ”¸ æ€§èƒ½ç›‘æ§ï¼šç›‘æ§é€’å½’æŸ¥è¯¢çš„æ€§èƒ½å’Œèµ„æºæ¶ˆè€—
```

### 10.2 ç»ˆæ­¢æ¡ä»¶è®¾è®¡æ ¸å¿ƒåŸåˆ™


**ğŸ¯ è®¾è®¡è¦ç‚¹æ€»ç»“**
```
å¿…è¦æ€§åŸåˆ™ï¼š
â€¢ æ¯ä¸ªé€’å½’CTEéƒ½å¿…é¡»æœ‰æ˜ç¡®çš„ç»ˆæ­¢æ¡ä»¶
â€¢ ç»ˆæ­¢æ¡ä»¶è¦èƒ½å¤Ÿè¢«è¾¾åˆ°
â€¢ ä¸èƒ½ä¾èµ–å¤–éƒ¨ä¸ç¡®å®šå› ç´ 

å®‰å…¨æ€§åŸåˆ™ï¼š
â€¢ è®¾ç½®å¤šé‡ä¿æŠ¤æœºåˆ¶
â€¢ æ·±åº¦é™åˆ¶ + ä¸šåŠ¡é€»è¾‘ + æ€§èƒ½ä¿æŠ¤
â€¢ å¼‚å¸¸æƒ…å†µçš„é™çº§å¤„ç†

å¯æµ‹è¯•æ€§åŸåˆ™ï¼š
â€¢ ç»ˆæ­¢æ¡ä»¶è¦èƒ½å¤Ÿè¢«æµ‹è¯•éªŒè¯
â€¢ æä¾›æµ‹è¯•ç”¨ä¾‹è¦†ç›–å„ç§æƒ…å†µ
â€¢ æ”¯æŒè‡ªåŠ¨åŒ–æµ‹è¯•å’Œç›‘æ§
```

### 10.3 å¸¸ç”¨ç»ˆæ­¢æ¡ä»¶æ¨¡å¼


**ğŸ“Š ç»ˆæ­¢æ¡ä»¶æ¨¡å¼é€ŸæŸ¥è¡¨**

| ä¸šåŠ¡åœºæ™¯ | **æ¨èç»ˆæ­¢æ¡ä»¶** | **ä»£ç ç¤ºä¾‹** |
|----------|----------------|-------------|
| **ç»„ç»‡æ¶æ„** | `level_depth < 10 AND manager_id IS NOT NULL` | å±‚çº§é™åˆ¶+æ•°æ®è¾¹ç•Œ |
| **åˆ†ç±»æ ‘** | `has_children = FALSE OR depth >= max_category_depth` | å¶å­èŠ‚ç‚¹+æ·±åº¦ä¿æŠ¤ |
| **è·¯å¾„æŸ¥æ‰¾** | `current_node = target_node OR path_cost > max_cost` | ç›®æ ‡è¾¾æˆ+æˆæœ¬é™åˆ¶ |
| **æƒé™ç»§æ‰¿** | `permission_level >= required_level OR inheritance_count < max_inheritance` | æƒé™æ»¡è¶³+ç»§æ‰¿å±‚æ•° |
| **æ•°æ®åŒæ­¥** | `sync_status = 'completed' OR dependency_depth < max_dependency` | çŠ¶æ€å®Œæˆ+ä¾èµ–æ·±åº¦ |

### 10.4 æœ€ä½³å®è·µæ€»ç»“


**âš¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®**
```
æŸ¥è¯¢ä¼˜åŒ–ï¼š
â€¢ åœ¨é€’å½’éƒ¨åˆ†ä½¿ç”¨åˆé€‚çš„ç´¢å¼•
â€¢ é¿å…åœ¨WHEREå­å¥ä¸­ä½¿ç”¨å¤æ‚å‡½æ•°
â€¢ åˆç†è®¾ç½®é€’å½’æ·±åº¦é™åˆ¶

èµ„æºæ§åˆ¶ï¼š
â€¢ è®¾ç½®ä¼šè¯çº§é€’å½’æ·±åº¦é™åˆ¶
â€¢ ç›‘æ§æŸ¥è¯¢æ‰§è¡Œæ—¶é—´
â€¢ é™åˆ¶ç»“æœé›†å¤§å°

é”™è¯¯å¤„ç†ï¼š
â€¢ å®ç°å¼‚å¸¸æ•è·å’Œæ¢å¤æœºåˆ¶
â€¢ æä¾›é™çº§æŸ¥è¯¢ç­–ç•¥
â€¢ è®°å½•é”™è¯¯ä¿¡æ¯ä¾¿äºè°ƒè¯•
```

**ğŸ”§ å¼€å‘å®è·µæŒ‡å—**
```
ä»£ç è§„èŒƒï¼š
â€¢ é€’å½’CTEè¦æœ‰æ¸…æ™°çš„æ³¨é‡Šè¯´æ˜ç»ˆæ­¢æ¡ä»¶
â€¢ ä½¿ç”¨æœ‰æ„ä¹‰çš„åˆ—åå’Œå˜é‡å
â€¢ åœ¨å¤æ‚é€’å½’ä¸­æ·»åŠ è°ƒè¯•ä¿¡æ¯

æµ‹è¯•ç­–ç•¥ï¼š
â€¢ å‡†å¤‡å¤šç§æµ‹è¯•æ•°æ®ï¼ˆæ­£å¸¸ã€è¾¹ç•Œã€å¼‚å¸¸ï¼‰
â€¢ æµ‹è¯•ä¸åŒæ·±åº¦çš„é€’å½’åœºæ™¯
â€¢ éªŒè¯æ€§èƒ½åœ¨å¯æ¥å—èŒƒå›´å†…

è¿ç»´ç›‘æ§ï¼š
â€¢ ç›‘æ§é€’å½’æŸ¥è¯¢çš„æ‰§è¡Œé¢‘ç‡å’Œæ€§èƒ½
â€¢ è®¾ç½®å‘Šè­¦é˜ˆå€¼
â€¢ å®šæœŸæ£€æŸ¥æ•°æ®å®Œæ•´æ€§
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
ğŸ’¡ "é€’å½’ç»ˆæ­¢å…«å­—è¯€"
æ·±åº¦é™åˆ¶é˜²æ— é™ï¼Œè¾¹ç•Œæ£€æµ‹ä¿å®‰å…¨
ä¸šåŠ¡é€»è¾‘ä¸ºå‡†ç»³ï¼Œå¼‚å¸¸å¤„ç†è¦å‘¨å…¨
```

**ğŸ¯ æ ¸å¿ƒç†è§£**ï¼š
- ç»ˆæ­¢æ¡ä»¶æ˜¯é€’å½’CTEçš„ç”Ÿå‘½çº¿ï¼Œå†³å®šæŸ¥è¯¢çš„æˆè´¥
- å¤šé‡ä¿æŠ¤æ¯”å•ä¸€æ¡ä»¶æ›´å®‰å…¨å¯é 
- ä¸šåŠ¡é€»è¾‘å’ŒæŠ€æœ¯ä¿æŠ¤è¦ç›¸ç»“åˆ
- æµ‹è¯•éªŒè¯æ˜¯ç¡®ä¿ç»ˆæ­¢æ¡ä»¶æ­£ç¡®çš„å”¯ä¸€é€”å¾„
- ç›‘æ§å’Œå¼‚å¸¸å¤„ç†æ˜¯ç”Ÿäº§ç¯å¢ƒçš„å¿…å¤‡æœºåˆ¶