---
title: 6ã€æ¢å¤ç±»å‹ä¸æ“ä½œæµç¨‹
---
## ğŸ“š ç›®å½•

1. [æ¢å¤ç±»å‹æ¦‚è¿°](#1-æ¢å¤ç±»å‹æ¦‚è¿°)
2. [å®Œå…¨æ¢å¤æµç¨‹](#2-å®Œå…¨æ¢å¤æµç¨‹)
3. [å¢é‡æ¢å¤æµç¨‹](#3-å¢é‡æ¢å¤æµç¨‹)
4. [å·®å¼‚æ¢å¤æµç¨‹](#4-å·®å¼‚æ¢å¤æµç¨‹)
5. [æ¢å¤å‰é¢„æ£€](#5-æ¢å¤å‰é¢„æ£€)
6. [æ¢å¤æ“ä½œæ­¥éª¤](#6-æ¢å¤æ“ä½œæ­¥éª¤)
7. [æ¢å¤åéªŒè¯](#7-æ¢å¤åéªŒè¯)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ“Š æ¢å¤ç±»å‹æ¦‚è¿°


æ•°æ®æ¢å¤æ˜¯æŒ‡å½“æ•°æ®åº“å‘ç”Ÿæ•…éšœã€æ•°æ®ä¸¢å¤±æˆ–æŸåæ—¶ï¼Œä½¿ç”¨å¤‡ä»½æ–‡ä»¶å°†æ•°æ®åº“æ¢å¤åˆ°æ­£å¸¸çŠ¶æ€çš„è¿‡ç¨‹ã€‚

### 1.1 æ¢å¤ç±»å‹åˆ†ç±»


**ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µ**ï¼šMySQLæ•°æ®æ¢å¤æ ¹æ®å¤‡ä»½ç±»å‹å’Œæ¢å¤ç›®æ ‡ï¼Œä¸»è¦åˆ†ä¸ºä¸‰ç§ç±»å‹

```
æ¢å¤ç±»å‹æ¶æ„å›¾ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æ•°æ®æ¢å¤ç±»å‹               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å®Œå…¨æ¢å¤   â”‚  å¢é‡æ¢å¤   â”‚  å·®å¼‚æ¢å¤   â”‚
â”‚             â”‚             â”‚             â”‚
â”‚ æ¢å¤æ•´ä¸ª    â”‚ åŸºäºbinlog  â”‚ åŸºäºå·®å¼‚    â”‚
â”‚ å®Œæ•´å¤‡ä»½    â”‚ é€æ­¥æ¢å¤    â”‚ å¤‡ä»½æ¢å¤    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”¸ å®Œå…¨æ¢å¤ï¼ˆFull Recoveryï¼‰**
- **å«ä¹‰**ï¼šä½¿ç”¨å®Œæ•´çš„æ•°æ®åº“å¤‡ä»½æ–‡ä»¶ï¼Œå°†æ•°æ®åº“æ¢å¤åˆ°å¤‡ä»½æ—¶çš„çŠ¶æ€
- **ç‰¹ç‚¹**ï¼šç®€å•ç›´æ¥ï¼Œä½†åªèƒ½æ¢å¤åˆ°å¤‡ä»½æ—¶é—´ç‚¹
- **é€‚ç”¨åœºæ™¯**ï¼šå¯ä»¥æ¥å—æ•°æ®ä¸¢å¤±åˆ°ä¸Šæ¬¡å¤‡ä»½æ—¶é—´çš„æƒ…å†µ

**ğŸ”¸ å¢é‡æ¢å¤ï¼ˆIncremental Recoveryï¼‰**
- **å«ä¹‰**ï¼šå…ˆæ¢å¤å®Œæ•´å¤‡ä»½ï¼Œå†åº”ç”¨binlogæ—¥å¿—ï¼Œæ¢å¤åˆ°æŒ‡å®šæ—¶é—´ç‚¹
- **ç‰¹ç‚¹**ï¼šå¯ä»¥æœ€å¤§ç¨‹åº¦å‡å°‘æ•°æ®ä¸¢å¤±
- **é€‚ç”¨åœºæ™¯**ï¼šéœ€è¦ç²¾ç¡®æ¢å¤åˆ°æ•…éšœå‰æŸä¸ªæ—¶é—´ç‚¹

**ğŸ”¸ å·®å¼‚æ¢å¤ï¼ˆDifferential Recoveryï¼‰**
- **å«ä¹‰**ï¼šåŸºäºå®Œæ•´å¤‡ä»½+å·®å¼‚å¤‡ä»½çš„ç»„åˆæ¢å¤æ–¹å¼
- **ç‰¹ç‚¹**ï¼šæ¢å¤é€Ÿåº¦ä»‹äºå®Œå…¨æ¢å¤å’Œå¢é‡æ¢å¤ä¹‹é—´
- **é€‚ç”¨åœºæ™¯**ï¼šæœ‰è§„å¾‹çš„å·®å¼‚å¤‡ä»½ç­–ç•¥ç¯å¢ƒ

### 1.2 æ¢å¤æ–¹å¼å¯¹æ¯”


| æ¢å¤ç±»å‹ | **æ¢å¤é€Ÿåº¦** | **æ•°æ®ä¸¢å¤±ç¨‹åº¦** | **å¤æ‚ç¨‹åº¦** | **é€‚ç”¨åœºæ™¯** |
|---------|-------------|-----------------|-------------|-------------|
| ğŸ”„ **å®Œå…¨æ¢å¤** | `æœ€å¿«` | `å¯èƒ½è¾ƒå¤š` | `æœ€ç®€å•` | `å¼€å‘ç¯å¢ƒã€å¯æ¥å—æ•°æ®ä¸¢å¤±` |
| âš¡ **å¢é‡æ¢å¤** | `è¾ƒæ…¢` | `æœ€å°‘` | `å¤æ‚` | `ç”Ÿäº§ç¯å¢ƒã€æ ¸å¿ƒä¸šåŠ¡` |
| ğŸ“Š **å·®å¼‚æ¢å¤** | `ä¸­ç­‰` | `ä¸­ç­‰` | `ä¸­ç­‰` | `å¹³è¡¡æ€§èƒ½å’Œå¯é æ€§éœ€æ±‚` |

---

## 2. ğŸ”„ å®Œå…¨æ¢å¤æµç¨‹


å®Œå…¨æ¢å¤æ˜¯æœ€ç®€å•çš„æ¢å¤æ–¹å¼ï¼Œç›´æ¥ä½¿ç”¨å®Œæ•´å¤‡ä»½æ–‡ä»¶æ¢å¤æ•´ä¸ªæ•°æ®åº“ã€‚

### 2.1 å®Œå…¨æ¢å¤åŸºæœ¬æµç¨‹


```
å®Œå…¨æ¢å¤æ­¥éª¤ï¼š
å®¢æˆ·ç«¯                MySQLæœåŠ¡å™¨              å¤‡ä»½æ–‡ä»¶
   |                       |                      |
   |--[1]åœæ­¢MySQLæœåŠ¡---->|                      |
   |                       |                      |
   |--[2]åˆ é™¤æ—§æ•°æ®ç›®å½•---->|                      |
   |                       |                      |
   |--[3]è§£å‹å¤‡ä»½æ–‡ä»¶-------|--------------------->|
   |                       |<--[4]æ¢å¤æ•°æ®æ–‡ä»¶-----|
   |                       |                      |
   |--[5]å¯åŠ¨MySQLæœåŠ¡---->|                      |
   |<--[6]æœåŠ¡å¯åŠ¨æˆåŠŸ-------|                      |
```

### 2.2 ç‰©ç†å¤‡ä»½æ¢å¤ç¤ºä¾‹


**ğŸ”§ ä½¿ç”¨Percona XtraBackupæ¢å¤**
```bash
# 1. åœæ­¢MySQLæœåŠ¡
systemctl stop mysqld

# 2. å‡†å¤‡å¤‡ä»½ï¼ˆå¦‚æœæ˜¯å‹ç¼©å¤‡ä»½éœ€è¦å…ˆè§£å‹ï¼‰
xtrabackup --prepare --target-dir=/backup/full_backup

# 3. æ¢å¤æ•°æ®
xtrabackup --copy-back --target-dir=/backup/full_backup \
           --datadir=/var/lib/mysql

# 4. ä¿®æ”¹æƒé™
chown -R mysql:mysql /var/lib/mysql

# 5. å¯åŠ¨MySQL
systemctl start mysqld
```

### 2.3 é€»è¾‘å¤‡ä»½æ¢å¤ç¤ºä¾‹


**ğŸ”§ ä½¿ç”¨mysqldumpå¤‡ä»½æ¢å¤**
```bash
# åˆ›å»ºæ–°æ•°æ®åº“
mysql -u root -p -e "CREATE DATABASE mydb_restore;"

# æ¢å¤æ•°æ®
mysql -u root -p mydb_restore < /backup/mydb_full.sql

# æˆ–è€…æ¢å¤æ‰€æœ‰æ•°æ®åº“
mysql -u root -p < /backup/all_databases.sql
```

**âš ï¸ æ³¨æ„äº‹é¡¹**
- æ¢å¤å‰ç¡®ä¿ç›®æ ‡ç¯å¢ƒMySQLç‰ˆæœ¬å…¼å®¹
- ç‰©ç†æ¢å¤éœ€è¦åœæ­¢MySQLæœåŠ¡
- é€»è¾‘æ¢å¤å¯ä»¥åœ¨çº¿è¿›è¡Œï¼Œä½†è¦æ³¨æ„é”è¡¨å½±å“

---

## 3. âš¡ å¢é‡æ¢å¤æµç¨‹


å¢é‡æ¢å¤æ˜¯æœ€ç²¾ç¡®çš„æ¢å¤æ–¹å¼ï¼Œå¯ä»¥æ¢å¤åˆ°æ•…éšœå‰çš„ä»»æ„æ—¶é—´ç‚¹ã€‚

### 3.1 å¢é‡æ¢å¤åŸç†


**ğŸ’¡ æ ¸å¿ƒåŸç†**ï¼šå¢é‡æ¢å¤ = å®Œæ•´å¤‡ä»½ + binlogé‡æ”¾

```
å¢é‡æ¢å¤æ—¶é—´çº¿ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å®Œæ•´å¤‡ä»½ â”‚ binlog1 â”‚ binlog2 â”‚ binlog3 â”‚  æ•…éšœ   â”‚
â”‚ 00:00   â”‚ 06:00   â”‚ 12:00   â”‚ 18:00   â”‚ 20:30   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†‘                             â†‘
     æ¢å¤èµ·ç‚¹                      æ¢å¤ç›®æ ‡ç‚¹
     
æ¢å¤è¿‡ç¨‹ï¼š
1. æ¢å¤å®Œæ•´å¤‡ä»½ï¼ˆæ¢å¤åˆ°00:00çŠ¶æ€ï¼‰
2. åº”ç”¨binlog1ï¼ˆæ¢å¤åˆ°06:00çŠ¶æ€ï¼‰  
3. åº”ç”¨binlog2ï¼ˆæ¢å¤åˆ°12:00çŠ¶æ€ï¼‰
4. åº”ç”¨binlog3éƒ¨åˆ†ï¼ˆæ¢å¤åˆ°20:25çŠ¶æ€ï¼Œæ•…éšœå‰5åˆ†é’Ÿï¼‰
```

### 3.2 å¢é‡æ¢å¤è¯¦ç»†æ­¥éª¤


<details>
<summary>ç‚¹å‡»å±•å¼€è¯¦ç»†æ¢å¤æ­¥éª¤</summary>

**ç¬¬ä¸€æ­¥ï¼šç¡®å®šæ¢å¤æ—¶é—´ç‚¹**
```bash
# æŸ¥çœ‹binlogäº‹ä»¶ï¼Œæ‰¾åˆ°æ•…éšœå‘ç”Ÿçš„å‡†ç¡®æ—¶é—´
mysqlbinlog /var/lib/mysql/mysql-bin.000003 | grep "2025-09-07 20:25"
```

**ç¬¬äºŒæ­¥ï¼šæ¢å¤å®Œæ•´å¤‡ä»½**
```bash
# å…ˆæŒ‰å®Œå…¨æ¢å¤æµç¨‹æ¢å¤åŸºç¡€æ•°æ®
xtrabackup --copy-back --target-dir=/backup/full_backup
```

**ç¬¬ä¸‰æ­¥ï¼šåº”ç”¨binlog**
```bash
# ä»å¤‡ä»½æ—¶é—´ç‚¹å¼€å§‹åº”ç”¨binlogåˆ°ç›®æ ‡æ—¶é—´ç‚¹
mysqlbinlog --start-datetime="2025-09-07 00:00:00" \
            --stop-datetime="2025-09-07 20:25:00" \
            /var/lib/mysql/mysql-bin.* | mysql -u root -p
```

</details>

### 3.3 ç²¾ç¡®æ—¶é—´ç‚¹æ¢å¤


**ğŸ¯ æŒ‰æ—¶é—´æ¢å¤ç¤ºä¾‹**
```bash
# æ¢å¤åˆ°å…·ä½“æ—¶é—´ç‚¹ï¼ˆæ•…éšœå‰5åˆ†é’Ÿï¼‰
mysqlbinlog --start-datetime="2025-09-07 06:00:00" \
            --stop-datetime="2025-09-07 20:25:00" \
            /var/lib/mysql/mysql-bin.000001 \
            /var/lib/mysql/mysql-bin.000002 \
            /var/lib/mysql/mysql-bin.000003 | mysql -u root -p
```

**ğŸ¯ æŒ‰ä½ç½®æ¢å¤ç¤ºä¾‹**
```bash
# æ ¹æ®binlogä½ç½®ç²¾ç¡®æ¢å¤
mysqlbinlog --start-position=154 \
            --stop-position=12458 \
            /var/lib/mysql/mysql-bin.000003 | mysql -u root -p
```

**ğŸ’¡ å…³é”®ç†è§£**ï¼š
- `start-datetime`ï¼šä»å“ªä¸ªæ—¶é—´å¼€å§‹åº”ç”¨binlog
- `stop-datetime`ï¼šåˆ°å“ªä¸ªæ—¶é—´åœæ­¢åº”ç”¨ï¼ˆé€šå¸¸æ˜¯æ•…éšœå‘ç”Ÿå‰ï¼‰
- `position`ï¼šåŸºäºbinlogä½ç½®çš„ç²¾ç¡®æ§åˆ¶ï¼Œæ¯”æ—¶é—´æ›´å‡†ç¡®

---

## 4. ğŸ“Š å·®å¼‚æ¢å¤æµç¨‹


å·®å¼‚æ¢å¤æ˜¯åœ¨å®Œæ•´å¤‡ä»½åŸºç¡€ä¸Šåº”ç”¨å·®å¼‚å¤‡ä»½çš„æ¢å¤æ–¹å¼ã€‚

### 4.1 å·®å¼‚æ¢å¤åœºæ™¯


```
å·®å¼‚å¤‡ä»½ç­–ç•¥ç¤ºä¾‹ï¼š
å‘¨æ—¥ â”€â”€â”€â–º å®Œæ•´å¤‡ä»½ï¼ˆ100GBæ•°æ®ï¼‰
 â”‚
 â”œâ”€ å‘¨ä¸€ â”€â”€â”€â–º å·®å¼‚å¤‡ä»½ï¼ˆ5GBå˜åŒ–æ•°æ®ï¼‰
 â”œâ”€ å‘¨äºŒ â”€â”€â”€â–º å·®å¼‚å¤‡ä»½ï¼ˆ8GBå˜åŒ–æ•°æ®ï¼‰  
 â”œâ”€ å‘¨ä¸‰ â”€â”€â”€â–º å·®å¼‚å¤‡ä»½ï¼ˆ12GBå˜åŒ–æ•°æ®ï¼‰
 â””â”€ å‘¨å››æ•…éšœ â—„â”€â”€â”€ éœ€è¦æ¢å¤

æ¢å¤æµç¨‹ï¼š
1. æ¢å¤å‘¨æ—¥å®Œæ•´å¤‡ä»½
2. åº”ç”¨å‘¨ä¸‰å·®å¼‚å¤‡ä»½ï¼ˆåŒ…å«å‘¨ä¸€åˆ°å‘¨ä¸‰çš„æ‰€æœ‰å˜åŒ–ï¼‰
3. åº”ç”¨å‘¨å››éƒ¨åˆ†binlogï¼ˆæ•…éšœå‰çš„å˜åŒ–ï¼‰
```

### 4.2 å·®å¼‚æ¢å¤æ“ä½œ


**ğŸ”§ å·®å¼‚å¤‡ä»½æ¢å¤ç¤ºä¾‹**
```bash
# 1. æ¢å¤å®Œæ•´å¤‡ä»½
xtrabackup --copy-back --target-dir=/backup/full_20250901

# 2. åº”ç”¨æœ€æ–°å·®å¼‚å¤‡ä»½
xtrabackup --prepare --target-dir=/backup/diff_20250904 \
           --incremental-basedir=/backup/full_20250901

# 3. åº”ç”¨å½“å¤©binlogåˆ°æ•…éšœæ—¶é—´ç‚¹
mysqlbinlog --start-datetime="2025-09-04 00:00:00" \
            --stop-datetime="2025-09-04 14:30:00" \
            /var/lib/mysql/mysql-bin.* | mysql -u root -p
```

**ğŸ“ˆ å·®å¼‚æ¢å¤ä¼˜åŠ¿**ï¼š
- æ¢å¤é€Ÿåº¦æ¯”å¢é‡æ¢å¤å¿«ï¼ˆæ— éœ€é€ä¸ªåº”ç”¨æ¯å¤©çš„binlogï¼‰
- æ•°æ®ä¸¢å¤±æ¯”å®Œå…¨æ¢å¤å°‘ï¼ˆç»“åˆäº†å·®å¼‚å¤‡ä»½å’Œbinlogï¼‰
- ç®¡ç†å¤æ‚åº¦é€‚ä¸­

---

## 5. ğŸ” æ¢å¤å‰é¢„æ£€


æ¢å¤å‰çš„æ£€æŸ¥å·¥ä½œæ˜¯ç¡®ä¿æ¢å¤æˆåŠŸçš„å…³é”®æ­¥éª¤ã€‚

### 5.1 ç¯å¢ƒæ£€æŸ¥æ¸…å•


**âœ… ç³»ç»Ÿç¯å¢ƒæ£€æŸ¥**
```bash
# æ£€æŸ¥MySQLç‰ˆæœ¬å…¼å®¹æ€§
mysql --version

# æ£€æŸ¥ç£ç›˜ç©ºé—´ï¼ˆè‡³å°‘æ˜¯å¤‡ä»½æ–‡ä»¶çš„2å€ï¼‰
df -h /var/lib/mysql

# æ£€æŸ¥æƒé™
ls -la /var/lib/mysql

# æ£€æŸ¥MySQLæœåŠ¡çŠ¶æ€
systemctl status mysqld
```

### 5.2 å¤‡ä»½æ–‡ä»¶éªŒè¯


**ğŸ”§ å¤‡ä»½å®Œæ•´æ€§æ£€æŸ¥**
```bash
# ç‰©ç†å¤‡ä»½æ£€æŸ¥
xtrabackup --prepare --target-dir=/backup/full_backup 2>&1 | \
           grep -E "(completed OK|Error)"

# é€»è¾‘å¤‡ä»½æ£€æŸ¥
head -20 /backup/mydb.sql | grep "MySQL dump"
tail -10 /backup/mydb.sql | grep "Dump completed"

# å‹ç¼©å¤‡ä»½æ£€æŸ¥
gzip -t /backup/mydb.sql.gz && echo "å‹ç¼©æ–‡ä»¶å®Œæ•´"
```

### 5.3 æ¢å¤ç­–ç•¥ç¡®è®¤


**ğŸ“‹ æ¢å¤å‰ç¡®è®¤äº‹é¡¹**
- â˜ ç¡®å®šæ¢å¤ç›®æ ‡æ—¶é—´ç‚¹
- â˜ ç¡®è®¤å¤‡ä»½æ–‡ä»¶å®Œæ•´æ€§
- â˜ è¯„ä¼°æ¢å¤æ—¶é—´çª—å£
- â˜ å‡†å¤‡å›æ»šæ–¹æ¡ˆ
- â˜ é€šçŸ¥ç›¸å…³äººå‘˜

**âš ï¸ é£é™©è¯„ä¼°**
```
é«˜é£é™©åœºæ™¯ï¼š
â†’ ç”Ÿäº§ç¯å¢ƒåœ¨çº¿æ¢å¤
â†’ è·¨ç‰ˆæœ¬æ¢å¤
â†’ éƒ¨åˆ†è¡¨æ¢å¤

ä½é£é™©åœºæ™¯ï¼š  
â†’ æµ‹è¯•ç¯å¢ƒæ¢å¤
â†’ åŒç‰ˆæœ¬å®Œæ•´æ¢å¤
â†’ ç¦»çº¿æ¢å¤
```

---

## 6. ğŸ› ï¸ æ¢å¤æ“ä½œæ­¥éª¤


æ ‡å‡†åŒ–çš„æ¢å¤æ“ä½œæµç¨‹å¯ä»¥å‡å°‘å‡ºé”™æ¦‚ç‡ï¼Œæé«˜æ¢å¤æˆåŠŸç‡ã€‚

### 6.1 æ¢å¤æ“ä½œæ¨¡æ¿


**ğŸ”¸ æ­¥éª¤1ï¼šç¯å¢ƒå‡†å¤‡**
```bash
# åˆ›å»ºæ¢å¤å·¥ä½œç›®å½•
mkdir -p /tmp/mysql_recovery
cd /tmp/mysql_recovery

# è®°å½•å½“å‰çŠ¶æ€
mysqladmin -u root -p status > recovery_start.log
date >> recovery_start.log
```

**ğŸ”¸ æ­¥éª¤2ï¼šæ‰§è¡Œæ¢å¤**
```bash
# æ ¹æ®æ¢å¤ç±»å‹é€‰æ‹©å¯¹åº”å‘½ä»¤
case $RECOVERY_TYPE in
  "full")
    # å®Œå…¨æ¢å¤æµç¨‹
    ;;
  "incremental") 
    # å¢é‡æ¢å¤æµç¨‹
    ;;
  "differential")
    # å·®å¼‚æ¢å¤æµç¨‹
    ;;
esac
```

### 6.2 æ¢å¤è„šæœ¬ç¤ºä¾‹


**ğŸ“ è‡ªåŠ¨åŒ–æ¢å¤è„šæœ¬**
```bash
#!/bin/bash
# MySQLæ¢å¤è„šæœ¬

BACKUP_DIR="/backup"
MYSQL_DATA="/var/lib/mysql"
LOG_FILE="/tmp/recovery.log"

# è®°å½•æ—¥å¿—å‡½æ•°
log_message() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1" | tee -a $LOG_FILE
}

# å®Œå…¨æ¢å¤å‡½æ•°
full_recovery() {
    log_message "å¼€å§‹å®Œå…¨æ¢å¤..."
    
    # åœæ­¢MySQL
    systemctl stop mysqld
    
    # å¤‡ä»½å½“å‰æ•°æ®ï¼ˆä»¥é˜²ä¸‡ä¸€ï¼‰
    mv $MYSQL_DATA ${MYSQL_DATA}_backup_$(date +%Y%m%d_%H%M%S)
    
    # æ¢å¤æ•°æ®
    xtrabackup --copy-back --target-dir=$BACKUP_DIR/full_backup
    chown -R mysql:mysql $MYSQL_DATA
    
    # å¯åŠ¨MySQL
    systemctl start mysqld
    
    log_message "å®Œå…¨æ¢å¤å®Œæˆ"
}

# ä¸»ç¨‹åº
case "$1" in
    full)
        full_recovery
        ;;
    *)
        echo "Usage: $0 {full|incremental|differential}"
        exit 1
        ;;
esac
```

### 6.3 æ¢å¤è¿‡ç¨‹ç›‘æ§


**ğŸ“Š ç›‘æ§å…³é”®æŒ‡æ ‡**
```bash
# ç›‘æ§æ¢å¤è¿›åº¦
while true; do
    echo "å½“å‰æ—¶é—´: $(date)"
    echo "ç£ç›˜ä½¿ç”¨: $(df -h /var/lib/mysql | tail -1)"
    echo "MySQLçŠ¶æ€: $(systemctl is-active mysqld)"
    echo "---"
    sleep 30
done
```

---

## 7. âœ… æ¢å¤åéªŒè¯


æ¢å¤å®Œæˆåçš„éªŒè¯æ˜¯ç¡®ä¿æ•°æ®å®Œæ•´æ€§å’Œç³»ç»Ÿæ­£å¸¸è¿è¡Œçš„æœ€åä¸€æ­¥ã€‚

### 7.1 æ•°æ®å®Œæ•´æ€§éªŒè¯


**ğŸ”¸ åŸºç¡€è¿æ¥æµ‹è¯•**
```bash
# æµ‹è¯•MySQLè¿æ¥
mysql -u root -p -e "SELECT 'MySQLè¿æ¥æ­£å¸¸' AS status;"

# æ£€æŸ¥æ•°æ®åº“åˆ—è¡¨
mysql -u root -p -e "SHOW DATABASES;"
```

**ğŸ”¸ æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥**
```sql
-- æ£€æŸ¥å…³é”®è¡¨çš„è®°å½•æ•°
SELECT 
    table_name,
    table_rows,
    data_length,
    index_length
FROM information_schema.tables 
WHERE table_schema = 'your_database'
ORDER BY table_rows DESC;

-- æ£€æŸ¥æœ€æ–°æ•°æ®çš„æ—¶é—´æˆ³
SELECT MAX(create_time) AS latest_record 
FROM your_table 
WHERE create_time IS NOT NULL;
```

### 7.2 ä¸šåŠ¡åŠŸèƒ½éªŒè¯


**ğŸ“‹ éªŒè¯æ¸…å•**
```
â–¡ å…³é”®ä¸šåŠ¡è¡¨æ•°æ®å®Œæ•´
â–¡ ç”¨æˆ·ç™»å½•åŠŸèƒ½æ­£å¸¸  
â–¡ æ ¸å¿ƒä¸šåŠ¡æµç¨‹å¯æ‰§è¡Œ
â–¡ æ•°æ®æ—¶é—´æˆ³ç¬¦åˆé¢„æœŸ
â–¡ ç´¢å¼•å’Œçº¦æŸæ­£å¸¸
â–¡ å­˜å‚¨è¿‡ç¨‹å’Œè§¦å‘å™¨æ­£å¸¸
```

**ğŸ”§ åº”ç”¨è¿æ¥æµ‹è¯•**
```bash
# æµ‹è¯•åº”ç”¨æ•°æ®åº“è¿æ¥
# æ ¹æ®å…·ä½“åº”ç”¨è°ƒæ•´æµ‹è¯•æ–¹æ³•
curl -X GET "http://localhost:8080/api/health/database"

# æˆ–è€…é€šè¿‡åº”ç”¨æ—¥å¿—æ£€æŸ¥
tail -f /var/log/application.log | grep -i database
```

### 7.3 æ€§èƒ½éªŒè¯


**âš¡ åŸºç¡€æ€§èƒ½æ£€æŸ¥**
```sql
-- æ£€æŸ¥æ…¢æŸ¥è¯¢
SHOW VARIABLES LIKE 'slow_query_log';
SHOW STATUS LIKE 'Slow_queries';

-- æ£€æŸ¥è¿æ¥æ•°
SHOW STATUS LIKE 'Threads_connected';
SHOW STATUS LIKE 'Max_used_connections';

-- æ£€æŸ¥InnoDBçŠ¶æ€
SHOW ENGINE INNODB STATUS\G
```

**ğŸ“Š å…³é”®æŒ‡æ ‡å¯¹æ¯”**
| éªŒè¯é¡¹ç›® | **æ¢å¤å‰** | **æ¢å¤å** | **çŠ¶æ€** |
|---------|-----------|-----------|---------|
| æ•°æ®åº“å¤§å° | `XX GB` | `YY GB` | âœ… æ­£å¸¸ |
| è¡¨æ•°é‡ | `XX ä¸ª` | `YY ä¸ª` | âœ… æ­£å¸¸ |
| æœ€æ–°è®°å½•æ—¶é—´ | `æ•…éšœå‰æ—¶é—´` | `ç›®æ ‡æ—¶é—´` | âœ… æ­£å¸¸ |
| è¿æ¥å“åº”æ—¶é—´ | `< 100ms` | `< 100ms` | âœ… æ­£å¸¸ |

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æ¢å¤ç±»å‹ï¼šå®Œå…¨æ¢å¤ã€å¢é‡æ¢å¤ã€å·®å¼‚æ¢å¤ä¸‰ç§åŸºæœ¬ç±»å‹
ğŸ”¸ æ¢å¤åŸç†ï¼šå¤‡ä»½æ–‡ä»¶ + binlogé‡æ”¾ = ç²¾ç¡®æ—¶é—´ç‚¹æ¢å¤
ğŸ”¸ æ“ä½œæµç¨‹ï¼šé¢„æ£€ â†’ æ¢å¤ â†’ éªŒè¯çš„æ ‡å‡†åŒ–æµç¨‹
ğŸ”¸ å…³é”®å·¥å…·ï¼šxtrabackupã€mysqldumpã€mysqlbinlog
ğŸ”¸ éªŒè¯æ–¹æ³•ï¼šè¿æ¥æµ‹è¯•ã€æ•°æ®æ£€æŸ¥ã€ä¸šåŠ¡éªŒè¯
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æ¢å¤ç±»å‹é€‰æ‹©åŸåˆ™**
```
æ•°æ®é‡è¦æ€§é«˜ + ä¸èƒ½ä¸¢å¤± â†’ å¢é‡æ¢å¤
æ¢å¤æ—¶é—´è¦æ±‚ä¸¥æ ¼ â†’ å®Œå…¨æ¢å¤  
å¹³è¡¡æ€§èƒ½å’Œå¯é æ€§ â†’ å·®å¼‚æ¢å¤
```

**ğŸ”¹ æ—¶é—´ç‚¹æ¢å¤çš„ç²¾é«“**
```
ç†è§£è¦ç‚¹ï¼š
- binlogæ˜¯å¢é‡æ¢å¤çš„æ ¸å¿ƒ
- æ—¶é—´ç‚¹é€‰æ‹©è¦åœ¨æ•…éšœå‘ç”Ÿå‰
- positionæ¯”datetimeæ›´ç²¾ç¡®
- æ¢å¤=é‡æ¼”å†å²æ“ä½œè¿‡ç¨‹
```

**ğŸ”¹ æ¢å¤æˆåŠŸçš„å…³é”®å› ç´ **
```
å¤‡ä»½è´¨é‡ï¼šå¤‡ä»½æ–‡ä»¶å®Œæ•´å¯ç”¨
æ“ä½œè§„èŒƒï¼šæŒ‰æ ‡å‡†æµç¨‹æ‰§è¡Œ
éªŒè¯å……åˆ†ï¼šå¤šç»´åº¦éªŒè¯æ•°æ®æ­£ç¡®æ€§
```

### 8.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ ç”Ÿäº§ç¯å¢ƒåº”ç”¨**
- **æ•…éšœæ¢å¤**ï¼šå¿«é€Ÿæ¢å¤ç”Ÿäº§æ•°æ®ï¼Œå‡å°‘ä¸šåŠ¡ä¸­æ–­
- **æ•°æ®è¿ç§»**ï¼šé€šè¿‡å¤‡ä»½æ¢å¤å®ç°æ•°æ®è¿ç§»
- **å¼€å‘æµ‹è¯•**ï¼šä¸ºå¼€å‘ç¯å¢ƒæä¾›ç”Ÿäº§æ•°æ®å‰¯æœ¬
- **åˆè§„å®¡è®¡**ï¼šæ»¡è¶³æ•°æ®ä¿æŠ¤å’Œå®¡è®¡è¦æ±‚

**ğŸ”§ æœ€ä½³å®è·µå»ºè®®**
- å®šæœŸæ¼”ç»ƒæ¢å¤æµç¨‹ï¼Œç¡®ä¿å…³é”®æ—¶åˆ»èƒ½å¿«é€Ÿæ‰§è¡Œ
- å»ºç«‹æ ‡å‡†åŒ–çš„æ¢å¤æ“ä½œæ–‡æ¡£å’Œè„šæœ¬
- åœ¨æµ‹è¯•ç¯å¢ƒå…ˆéªŒè¯æ¢å¤æµç¨‹çš„æœ‰æ•ˆæ€§
- æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ¢å¤ç­–ç•¥

**ğŸ’¡ è®°å¿†è¦ç‚¹**
- æ¢å¤å‰å¿…é¡»éªŒè¯å¤‡ä»½æ–‡ä»¶å®Œæ•´æ€§
- å¢é‡æ¢å¤éœ€è¦å®Œæ•´çš„binlogé“¾
- æ¢å¤åéªŒè¯æ¯”æ¢å¤æ“ä½œæœ¬èº«åŒæ ·é‡è¦
- é¢„æ£€ã€æ¢å¤ã€éªŒè¯ä¸‰æ­¥ç¼ºä¸€ä¸å¯