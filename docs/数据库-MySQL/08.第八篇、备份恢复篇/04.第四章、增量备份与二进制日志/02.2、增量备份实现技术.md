---
title: 2ã€å¢é‡å¤‡ä»½å®ç°æŠ€æœ¯
---
## ğŸ“š ç›®å½•

1. [å¢é‡å¤‡ä»½æ ¸å¿ƒæ¦‚å¿µ](#1-å¢é‡å¤‡ä»½æ ¸å¿ƒæ¦‚å¿µ)
2. [äºŒè¿›åˆ¶æ—¥å¿—åŸºç¡€](#2-äºŒè¿›åˆ¶æ—¥å¿—åŸºç¡€)
3. [mysqlbinlogå¢é‡æå–](#3-mysqlbinlogå¢é‡æå–)
4. [åŸºäºGTIDå¢é‡å¤‡ä»½](#4-åŸºäºGTIDå¢é‡å¤‡ä»½)
5. [å¢é‡å¤‡ä»½è„šæœ¬å®ç°](#5-å¢é‡å¤‡ä»½è„šæœ¬å®ç°)
6. [å¢é‡å¤‡ä»½éªŒè¯ä¸æ£€æŸ¥](#6-å¢é‡å¤‡ä»½éªŒè¯ä¸æ£€æŸ¥)
7. [å¹¶è¡Œå¢é‡å¤„ç†](#7-å¹¶è¡Œå¢é‡å¤„ç†)
8. [å¢é‡å¤‡ä»½ç›‘æ§](#8-å¢é‡å¤‡ä»½ç›‘æ§)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ å¢é‡å¤‡ä»½æ ¸å¿ƒæ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯å¢é‡å¤‡ä»½

å¢é‡å¤‡ä»½æ˜¯æŒ‡åªå¤‡ä»½è‡ªä¸Šæ¬¡å¤‡ä»½ä»¥æ¥å‘ç”Ÿå˜åŒ–çš„æ•°æ®ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ•°æ®åº“ã€‚

**ğŸ’¡ é€šä¿—ç†è§£**ï¼š
```
å°±åƒæ‹ç…§è®°å½•å˜åŒ–ï¼š
ğŸ“¸ å…¨é‡å¤‡ä»½ï¼šç»™æ•´ä¸ªæˆ¿é—´æ‹ä¸€å¼ å®Œæ•´ç…§ç‰‡
ğŸ“· å¢é‡å¤‡ä»½ï¼šåªæ‹æ‘„è‡ªä¸Šæ¬¡æ‹ç…§åç§»åŠ¨æˆ–æ–°å¢çš„ç‰©å“

ä¼˜åŠ¿ï¼š
âœ… å¤‡ä»½é€Ÿåº¦å¿« - åªå¤„ç†å˜åŒ–éƒ¨åˆ†
âœ… å ç”¨ç©ºé—´å° - å­˜å‚¨å¢é‡æ•°æ®
âœ… å¯¹ç³»ç»Ÿå½±å“å° - å‡å°‘IOè´Ÿè½½
```

### 1.2 å¢é‡å¤‡ä»½çš„å®ç°åŸç†

MySQLé€šè¿‡**äºŒè¿›åˆ¶æ—¥å¿—(Binary Log)**æ¥å®ç°å¢é‡å¤‡ä»½ã€‚

```
å¢é‡å¤‡ä»½å·¥ä½œæµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å…¨é‡å¤‡ä»½   â”‚â”€â”€â”€â–¶â”‚  äºŒè¿›åˆ¶æ—¥å¿—  â”‚â”€â”€â”€â–¶â”‚   å¢é‡å¤‡ä»½   â”‚
â”‚  (åŸºç¡€æ•°æ®)  â”‚    â”‚  (å˜åŒ–è®°å½•)  â”‚    â”‚  (å˜åŒ–æ•°æ®)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ” å…³é”®ç†è§£**ï¼š
- **å…¨é‡å¤‡ä»½**ï¼šå®Œæ•´çš„æ•°æ®åº“å¿«ç…§
- **äºŒè¿›åˆ¶æ—¥å¿—**ï¼šè®°å½•æ‰€æœ‰æ•°æ®å˜æ›´æ“ä½œ
- **å¢é‡å¤‡ä»½**ï¼šæå–äºŒè¿›åˆ¶æ—¥å¿—ä¸­çš„ç‰¹å®šæ—¶é—´æ®µ

---

## 2. ğŸ“‹ äºŒè¿›åˆ¶æ—¥å¿—åŸºç¡€


### 2.1 äºŒè¿›åˆ¶æ—¥å¿—çš„ä½œç”¨

äºŒè¿›åˆ¶æ—¥å¿—æ˜¯MySQLçš„æ ¸å¿ƒç»„ä»¶ï¼Œè®°å½•æ‰€æœ‰ä¿®æ”¹æ•°æ®çš„SQLè¯­å¥ã€‚

**ğŸ”¸ ä¸»è¦åŠŸèƒ½**ï¼š
```
ğŸ¯ æ•°æ®æ¢å¤ï¼šé€šè¿‡é‡æ”¾æ—¥å¿—æ¢å¤æ•°æ®
ğŸ”„ ä¸»ä»å¤åˆ¶ï¼šä»åº“é€šè¿‡è¯»å–ä¸»åº“binlogåŒæ­¥æ•°æ®
ğŸ“Š æ•°æ®å®¡è®¡ï¼šè·Ÿè¸ªæ•°æ®å˜æ›´å†å²
âš¡ å¢é‡å¤‡ä»½ï¼šæå–ç‰¹å®šæ—¶é—´æ®µçš„å˜æ›´
```

### 2.2 äºŒè¿›åˆ¶æ—¥å¿—é…ç½®

å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—éœ€è¦åœ¨MySQLé…ç½®æ–‡ä»¶ä¸­è®¾ç½®ã€‚

```ini
# my.cnfé…ç½®ç¤ºä¾‹
[mysqld]
# å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—
log-bin = /var/log/mysql/mysql-bin
# è®¾ç½®æ—¥å¿—æ ¼å¼(æ¨èROW)
binlog_format = ROW
# è®¾ç½®æ—¥å¿—æ–‡ä»¶å¤§å°(1GB)
max_binlog_size = 1073741824
# æ—¥å¿—ä¿ç•™æ—¶é—´(å¤©)
binlog_expire_logs_seconds = 604800
# å¼€å¯GTID(æ¨è)
gtid_mode = ON
enforce_gtid_consistency = ON
```

**ğŸ“ å‚æ•°è¯´æ˜**ï¼š
| å‚æ•° | å«ä¹‰ | æ¨èå€¼ |
|------|------|--------|
| `log-bin` | æ—¥å¿—æ–‡ä»¶è·¯å¾„å‰ç¼€ | `/var/log/mysql/mysql-bin` |
| `binlog_format` | æ—¥å¿—æ ¼å¼ | `ROW`(è®°å½•è¡Œçº§å˜æ›´) |
| `max_binlog_size` | å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§å¤§å° | `1G` |
| `binlog_expire_logs_seconds` | æ—¥å¿—ä¿ç•™æ—¶é—´ | `604800`(7å¤©) |

### 2.3 æŸ¥çœ‹äºŒè¿›åˆ¶æ—¥å¿—çŠ¶æ€


```sql
-- æŸ¥çœ‹binlogæ˜¯å¦å¼€å¯
SHOW VARIABLES LIKE 'log_bin';

-- æŸ¥çœ‹å½“å‰binlogæ–‡ä»¶
SHOW MASTER STATUS;

-- æŸ¥çœ‹æ‰€æœ‰binlogæ–‡ä»¶
SHOW BINARY LOGS;
```

**ğŸ” è¾“å‡ºç¤ºä¾‹**ï¼š
```
mysql> SHOW MASTER STATUS;
+------------------+----------+
| File             | Position |
+------------------+----------+
| mysql-bin.000003 | 1547     |
+------------------+----------+

mysql> SHOW BINARY LOGS;
+------------------+-----------+
| Log_name         | File_size |
+------------------+-----------+
| mysql-bin.000001 |      1024 |
| mysql-bin.000002 |     87458 |
| mysql-bin.000003 |      1547 |
+------------------+-----------+
```

---

## 3. ğŸ”§ mysqlbinlogå¢é‡æå–


### 3.1 mysqlbinlogå·¥å…·ä»‹ç»

`mysqlbinlog`æ˜¯MySQLæä¾›çš„äºŒè¿›åˆ¶æ—¥å¿—è§£æå·¥å…·ï¼Œç”¨äºæå–å’Œåˆ†æbinlogå†…å®¹ã€‚

**ğŸ’¡ åŸºæœ¬ç”¨æ³•**ï¼š
```bash
# åŸºæœ¬è¯­æ³•
mysqlbinlog [é€‰é¡¹] binlogæ–‡ä»¶

# å¸¸ç”¨é€‰é¡¹
--start-datetime    # å¼€å§‹æ—¶é—´
--stop-datetime     # ç»“æŸæ—¶é—´
--start-position    # å¼€å§‹ä½ç½®
--stop-position     # ç»“æŸä½ç½®
--database          # æŒ‡å®šæ•°æ®åº“
```

### 3.2 åŸºäºæ—¶é—´çš„å¢é‡æå–


```bash
# æå–æŒ‡å®šæ—¶é—´æ®µçš„binlog
mysqlbinlog \
  --start-datetime="2025-09-07 08:00:00" \
  --stop-datetime="2025-09-07 12:00:00" \
  /var/log/mysql/mysql-bin.000003 > incremental_backup.sql

# æå–å¤šä¸ªbinlogæ–‡ä»¶
mysqlbinlog \
  --start-datetime="2025-09-07 08:00:00" \
  --stop-datetime="2025-09-07 12:00:00" \
  /var/log/mysql/mysql-bin.000002 \
  /var/log/mysql/mysql-bin.000003 > incremental_backup.sql
```

### 3.3 åŸºäºä½ç½®çš„å¢é‡æå–


```bash
# æŸ¥çœ‹æŸä¸ªæ—¶é—´ç‚¹çš„binlogä½ç½®
mysqlbinlog --start-datetime="2025-09-07 08:00:00" \
  --stop-datetime="2025-09-07 08:01:00" \
  /var/log/mysql/mysql-bin.000003 | head -20

# åŸºäºä½ç½®æå–
mysqlbinlog \
  --start-position=1000 \
  --stop-position=5000 \
  /var/log/mysql/mysql-bin.000003 > incremental_backup.sql
```

### 3.4 æŒ‡å®šæ•°æ®åº“çš„å¢é‡æå–


```bash
# åªæå–æŒ‡å®šæ•°æ®åº“çš„å˜æ›´
mysqlbinlog \
  --database=myapp \
  --start-datetime="2025-09-07 08:00:00" \
  --stop-datetime="2025-09-07 12:00:00" \
  /var/log/mysql/mysql-bin.000003 > myapp_incremental.sql
```

**âš ï¸ æ³¨æ„äº‹é¡¹**ï¼š
> `--database`é€‰é¡¹åªå¯¹`USE database`è¯­å¥ç”Ÿæ•ˆï¼Œå¯¹äºè·¨æ•°æ®åº“æ“ä½œå¯èƒ½ä¸å‡†ç¡®

---

## 4. ğŸ² åŸºäºGTIDå¢é‡å¤‡ä»½


### 4.1 GTIDæ¦‚å¿µç†è§£

GTID(Global Transaction Identifier)æ˜¯MySQL 5.6å¼•å…¥çš„å…¨å±€äº‹åŠ¡æ ‡è¯†ç¬¦ã€‚

**ğŸ” GTIDæ ¼å¼**ï¼š
```
GTID = server_uuid:transaction_id
ç¤ºä¾‹ï¼š3E11FA47-71CA-11E1-9E33-C80AA9429562:23
```

**ğŸ¯ GTIDä¼˜åŠ¿**ï¼š
```
âœ… å…¨å±€å”¯ä¸€ï¼šæ¯ä¸ªäº‹åŠ¡éƒ½æœ‰å”¯ä¸€æ ‡è¯†
âœ… å¤åˆ¶ç®€åŒ–ï¼šä¸»ä»åˆ‡æ¢æ›´å®¹æ˜“
âœ… å¢é‡ç²¾ç¡®ï¼šå¯ä»¥ç²¾ç¡®æŒ‡å®šäº‹åŠ¡èŒƒå›´
âœ… å¹¶è¡Œå®‰å…¨ï¼šæ”¯æŒå¹¶è¡Œå¤åˆ¶
```

### 4.2 æŸ¥çœ‹GTIDä¿¡æ¯


```sql
-- æŸ¥çœ‹GTIDç›¸å…³çŠ¶æ€
SHOW VARIABLES LIKE '%gtid%';

-- æŸ¥çœ‹å·²æ‰§è¡Œçš„GTIDé›†åˆ
SHOW MASTER STATUS;

-- æŸ¥çœ‹GTIDè¯¦ç»†ä¿¡æ¯
SELECT $$GLOBAL.gtid_executed;
```

### 4.3 åŸºäºGTIDçš„å¢é‡å¤‡ä»½


```bash
# ä½¿ç”¨GTIDèŒƒå›´æå–å¢é‡
mysqlbinlog \
  --include-gtids='3E11FA47-71CA-11E1-9E33-C80AA9429562:1-100' \
  /var/log/mysql/mysql-bin.000003 > gtid_incremental.sql

# æ’é™¤æŸäº›GTID
mysqlbinlog \
  --exclude-gtids='3E11FA47-71CA-11E1-9E33-C80AA9429562:50-60' \
  /var/log/mysql/mysql-bin.000003 > filtered_incremental.sql
```

### 4.4 GTIDå¢é‡å¤‡ä»½è„šæœ¬


```bash
#!/bin/bash
# gtid_incremental_backup.sh

# é…ç½®å˜é‡
MYSQL_USER="backup_user"
MYSQL_PASSWORD="backup_pass"
BACKUP_DIR="/backup/incremental"
LAST_GTID_FILE="$BACKUP_DIR/last_gtid.txt"

# è·å–å½“å‰GTID
CURRENT_GTID=$(mysql -u$MYSQL_USER -p$MYSQL_PASSWORD -e "SELECT $$GLOBAL.gtid_executed" -s -N)

# è¯»å–ä¸Šæ¬¡å¤‡ä»½çš„GTID
if [ -f "$LAST_GTID_FILE" ]; then
    LAST_GTID=$(cat "$LAST_GTID_FILE")
else
    LAST_GTID=""
fi

# è®¡ç®—å¢é‡GTIDèŒƒå›´
if [ -n "$LAST_GTID" ]; then
    # è¿™é‡Œéœ€è¦GTIDè®¡ç®—é€»è¾‘(ç®€åŒ–ç¤ºä¾‹)
    GTID_RANGE="$CURRENT_GTID"
else
    GTID_RANGE="$CURRENT_GTID"
fi

# åˆ›å»ºå¢é‡å¤‡ä»½
BACKUP_FILE="$BACKUP_DIR/incremental_$(date +%Y%m%d_%H%M%S).sql"
mysqlbinlog --include-gtids="$GTID_RANGE" \
    /var/log/mysql/mysql-bin.* > "$BACKUP_FILE"

# ä¿å­˜å½“å‰GTID
echo "$CURRENT_GTID" > "$LAST_GTID_FILE"

echo "å¢é‡å¤‡ä»½å®Œæˆ: $BACKUP_FILE"
```

---

## 5. âš™ï¸ å¢é‡å¤‡ä»½è„šæœ¬å®ç°


### 5.1 å®Œæ•´å¢é‡å¤‡ä»½è„šæœ¬


```bash
#!/bin/bash
# incremental_backup.sh - å®Œæ•´çš„å¢é‡å¤‡ä»½è§£å†³æ–¹æ¡ˆ

# =============================================================================
# é…ç½®éƒ¨åˆ†
# =============================================================================
SCRIPT_DIR=$(dirname "$(readlink -f "$0")")
CONFIG_FILE="$SCRIPT_DIR/backup.conf"

# é»˜è®¤é…ç½®
MYSQL_USER="backup_user"
MYSQL_PASSWORD=""
MYSQL_HOST="localhost"
MYSQL_PORT="3306"
BACKUP_BASE_DIR="/backup"
LOG_FILE="$BACKUP_BASE_DIR/logs/incremental_backup.log"
RETENTION_DAYS=7

# åŠ è½½é…ç½®æ–‡ä»¶
if [ -f "$CONFIG_FILE" ]; then
    source "$CONFIG_FILE"
fi

# =============================================================================
# å‡½æ•°å®šä¹‰
# =============================================================================

# æ—¥å¿—å‡½æ•°
log_message() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1" | tee -a "$LOG_FILE"
}

# é”™è¯¯å¤„ç†
error_exit() {
    log_message "ERROR: $1"
    exit 1
}

# è·å–æœ€åå¤‡ä»½ä½ç½®
get_last_position() {
    local position_file="$BACKUP_BASE_DIR/last_position.txt"
    if [ -f "$position_file" ]; then
        cat "$position_file"
    else
        echo "mysql-bin.000001:0"
    fi
}

# ä¿å­˜å½“å‰ä½ç½®
save_current_position() {
    local binlog_file="$1"
    local position="$2"
    echo "$binlog_file:$position" > "$BACKUP_BASE_DIR/last_position.txt"
}

# è·å–å½“å‰binlogä½ç½®
get_current_position() {
    mysql -h"$MYSQL_HOST" -P"$MYSQL_PORT" -u"$MYSQL_USER" -p"$MYSQL_PASSWORD" \
        -e "SHOW MASTER STATUS" -s -N | awk '{print $1":"$2}'
}

# =============================================================================
# ä¸»è¦åŠŸèƒ½å‡½æ•°
# =============================================================================

# åˆ›å»ºå¢é‡å¤‡ä»½
create_incremental_backup() {
    local backup_date=$(date +%Y%m%d_%H%M%S)
    local backup_dir="$BACKUP_BASE_DIR/incremental/$backup_date"
    local last_position=$(get_last_position)
    local current_position=$(get_current_position)
    
    # è§£æä½ç½®ä¿¡æ¯
    local last_file=$(echo "$last_position" | cut -d: -f1)
    local last_pos=$(echo "$last_position" | cut -d: -f2)
    local current_file=$(echo "$current_position" | cut -d: -f1)
    local current_pos=$(echo "$current_position" | cut -d: -f2)
    
    log_message "å¼€å§‹å¢é‡å¤‡ä»½: $last_position -> $current_position"
    
    # åˆ›å»ºå¤‡ä»½ç›®å½•
    mkdir -p "$backup_dir"
    
    # ç¡®å®šéœ€è¦å¤‡ä»½çš„binlogæ–‡ä»¶
    local binlog_files=$(mysql -h"$MYSQL_HOST" -P"$MYSQL_PORT" -u"$MYSQL_USER" -p"$MYSQL_PASSWORD" \
        -e "SHOW BINARY LOGS" -s -N | awk '{print $1}' | \
        awk -v start="$last_file" -v end="$current_file" '
        BEGIN { found_start = 0 }
        $1 == start { found_start = 1 }
        found_start { print "/var/log/mysql/" $1 }
        $1 == end { exit }
        ')
    
    # æ‰§è¡Œå¢é‡å¤‡ä»½
    local backup_file="$backup_dir/incremental_backup.sql"
    
    if [ "$last_file" = "$current_file" ]; then
        # åŒä¸€ä¸ªbinlogæ–‡ä»¶
        mysqlbinlog \
            --start-position="$last_pos" \
            --stop-position="$current_pos" \
            "/var/log/mysql/$current_file" > "$backup_file"
    else
        # è·¨å¤šä¸ªbinlogæ–‡ä»¶
        # ç¬¬ä¸€ä¸ªæ–‡ä»¶: ä»last_posåˆ°æ–‡ä»¶æœ«å°¾
        mysqlbinlog \
            --start-position="$last_pos" \
            "/var/log/mysql/$last_file" > "$backup_file"
            
        # ä¸­é—´æ–‡ä»¶: å®Œæ•´å†…å®¹
        for file in $binlog_files; do
            if [[ "$file" != *"$last_file" && "$file" != *"$current_file" ]]; then
                mysqlbinlog "$file" >> "$backup_file"
            fi
        done
        
        # æœ€åæ–‡ä»¶: ä»å¼€å§‹åˆ°current_pos
        if [ "$last_file" != "$current_file" ]; then
            mysqlbinlog \
                --stop-position="$current_pos" \
                "/var/log/mysql/$current_file" >> "$backup_file"
        fi
    fi
    
    # éªŒè¯å¤‡ä»½æ–‡ä»¶
    if [ -s "$backup_file" ]; then
        # åˆ›å»ºå¤‡ä»½ä¿¡æ¯æ–‡ä»¶
        cat > "$backup_dir/backup_info.txt" << EOF
å¤‡ä»½ç±»å‹: å¢é‡å¤‡ä»½
å¤‡ä»½æ—¶é—´: $(date)
èµ·å§‹ä½ç½®: $last_position
ç»“æŸä½ç½®: $current_position
å¤‡ä»½æ–‡ä»¶: $backup_file
æ–‡ä»¶å¤§å°: $(du -h "$backup_file" | cut -f1)
EOF
        
        log_message "å¢é‡å¤‡ä»½æˆåŠŸå®Œæˆ: $backup_file"
        save_current_position "$current_file" "$current_pos"
        
        # æ¸…ç†è¿‡æœŸå¤‡ä»½
        cleanup_old_backups
    else
        error_exit "å¢é‡å¤‡ä»½å¤±è´¥: å¤‡ä»½æ–‡ä»¶ä¸ºç©º"
    fi
}

# æ¸…ç†è¿‡æœŸå¤‡ä»½
cleanup_old_backups() {
    log_message "å¼€å§‹æ¸…ç† $RETENTION_DAYS å¤©å‰çš„å¤‡ä»½"
    find "$BACKUP_BASE_DIR/incremental" -type d -mtime +$RETENTION_DAYS -exec rm -rf {} + 2>/dev/null
    log_message "è¿‡æœŸå¤‡ä»½æ¸…ç†å®Œæˆ"
}

# =============================================================================
# ä¸»ç¨‹åº
# =============================================================================

# åˆ›å»ºå¿…è¦ç›®å½•
mkdir -p "$BACKUP_BASE_DIR/incremental"
mkdir -p "$(dirname "$LOG_FILE")"

# æ£€æŸ¥MySQLè¿æ¥
mysql -h"$MYSQL_HOST" -P"$MYSQL_PORT" -u"$MYSQL_USER" -p"$MYSQL_PASSWORD" \
    -e "SELECT 1" >/dev/null 2>&1 || error_exit "æ— æ³•è¿æ¥åˆ°MySQLæœåŠ¡å™¨"

# æ£€æŸ¥binlogæ˜¯å¦å¼€å¯
BINLOG_ENABLED=$(mysql -h"$MYSQL_HOST" -P"$MYSQL_PORT" -u"$MYSQL_USER" -p"$MYSQL_PASSWORD" \
    -e "SHOW VARIABLES LIKE 'log_bin'" -s -N | awk '{print $2}')

[ "$BINLOG_ENABLED" = "ON" ] || error_exit "äºŒè¿›åˆ¶æ—¥å¿—æœªå¼€å¯"

# æ‰§è¡Œå¢é‡å¤‡ä»½
create_incremental_backup

log_message "å¢é‡å¤‡ä»½ä»»åŠ¡å®Œæˆ"
```

### 5.2 é…ç½®æ–‡ä»¶ç¤ºä¾‹


```bash
# backup.conf - å¤‡ä»½é…ç½®æ–‡ä»¶
MYSQL_USER="backup_user"
MYSQL_PASSWORD="your_secure_password"
MYSQL_HOST="localhost"
MYSQL_PORT="3306"
BACKUP_BASE_DIR="/data/mysql_backup"
RETENTION_DAYS=14
LOG_FILE="/var/log/mysql_backup/incremental.log"
```

---

## 6. âœ… å¢é‡å¤‡ä»½éªŒè¯ä¸æ£€æŸ¥


### 6.1 å¢é‡é“¾å®Œæ•´æ€§æ£€æŸ¥

ç¡®ä¿å¢é‡å¤‡ä»½é“¾çš„è¿ç»­æ€§å’Œå®Œæ•´æ€§ã€‚

```bash
#!/bin/bash
# validate_incremental_chain.sh

BACKUP_DIR="/backup/incremental"

validate_backup_chain() {
    local chain_valid=true
    local last_end_position=""
    
    # æŒ‰æ—¶é—´é¡ºåºæ£€æŸ¥å¤‡ä»½
    for backup_dir in $(ls -1d "$BACKUP_DIR"/*/ | sort); do
        local info_file="$backup_dir/backup_info.txt"
        
        if [ -f "$info_file" ]; then
            local start_pos=$(grep "èµ·å§‹ä½ç½®:" "$info_file" | cut -d: -f2- | xargs)
            local end_pos=$(grep "ç»“æŸä½ç½®:" "$info_file" | cut -d: -f2- | xargs)
            
            echo "æ£€æŸ¥å¤‡ä»½: $(basename "$backup_dir")"
            echo "  èµ·å§‹ä½ç½®: $start_pos"
            echo "  ç»“æŸä½ç½®: $end_pos"
            
            # æ£€æŸ¥é“¾æ¡è¿ç»­æ€§
            if [ -n "$last_end_position" ] && [ "$start_pos" != "$last_end_position" ]; then
                echo "  âŒ è­¦å‘Š: å¤‡ä»½é“¾ä¸è¿ç»­!"
                chain_valid=false
            else
                echo "  âœ… å¤‡ä»½é“¾è¿ç»­"
            fi
            
            last_end_position="$end_pos"
        fi
    done
    
    if [ "$chain_valid" = true ]; then
        echo "ğŸ¯ å¢é‡å¤‡ä»½é“¾å®Œæ•´æ€§éªŒè¯é€šè¿‡"
    else
        echo "âš ï¸ å¢é‡å¤‡ä»½é“¾å­˜åœ¨æ–­è£‚"
    fi
}

validate_backup_chain
```

### 6.2 å¢é‡å¤‡ä»½å†…å®¹éªŒè¯


```bash
# éªŒè¯å¢é‡å¤‡ä»½SQLè¯­æ³•
validate_backup_sql() {
    local backup_file="$1"
    
    echo "éªŒè¯å¤‡ä»½æ–‡ä»¶: $backup_file"
    
    # æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”éç©º
    if [ ! -s "$backup_file" ]; then
        echo "âŒ å¤‡ä»½æ–‡ä»¶ä¸å­˜åœ¨æˆ–ä¸ºç©º"
        return 1
    fi
    
    # æ£€æŸ¥SQLè¯­æ³•(å¹²è¿è¡Œ)
    mysql --force --comments --dry-run < "$backup_file" 2>/dev/null
    
    if [ $? -eq 0 ]; then
        echo "âœ… SQLè¯­æ³•éªŒè¯é€šè¿‡"
    else
        echo "âŒ SQLè¯­æ³•éªŒè¯å¤±è´¥"
        return 1
    fi
    
    # ç»Ÿè®¡SQLè¯­å¥ç±»å‹
    echo "ğŸ“Š SQLè¯­å¥ç»Ÿè®¡:"
    grep -E "^(INSERT|UPDATE|DELETE|CREATE|DROP|ALTER)" "$backup_file" | \
        awk '{print $1}' | sort | uniq -c | \
        awk '{printf "  %s: %dæ¡\n", $2, $1}'
}
```

### 6.3 å¢é‡æ¢å¤æµ‹è¯•


```bash
# åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯å¢é‡æ¢å¤
test_incremental_restore() {
    local test_db="test_restore_$(date +%s)"
    local backup_dir="$1"
    
    echo "ğŸ§ª å¼€å§‹å¢é‡æ¢å¤æµ‹è¯•"
    
    # åˆ›å»ºæµ‹è¯•æ•°æ®åº“
    mysql -e "CREATE DATABASE $test_db"
    
    # æ¢å¤å…¨é‡å¤‡ä»½(å‡è®¾å­˜åœ¨)
    local full_backup="/backup/full/latest_full_backup.sql"
    if [ -f "$full_backup" ]; then
        echo "æ¢å¤å…¨é‡å¤‡ä»½..."
        mysql "$test_db" < "$full_backup"
    fi
    
    # æŒ‰é¡ºåºæ¢å¤å¢é‡å¤‡ä»½
    for incremental_backup in $(find "$backup_dir" -name "incremental_backup.sql" | sort); do
        echo "æ¢å¤å¢é‡å¤‡ä»½: $incremental_backup"
        mysql "$test_db" < "$incremental_backup"
        
        if [ $? -ne 0 ]; then
            echo "âŒ å¢é‡æ¢å¤å¤±è´¥: $incremental_backup"
            mysql -e "DROP DATABASE $test_db"
            return 1
        fi
    done
    
    echo "âœ… å¢é‡æ¢å¤æµ‹è¯•æˆåŠŸ"
    
    # æ¸…ç†æµ‹è¯•æ•°æ®åº“
    mysql -e "DROP DATABASE $test_db"
}
```

---

## 7. âš¡ å¹¶è¡Œå¢é‡å¤„ç†


### 7.1 å¹¶è¡Œå¤‡ä»½ç­–ç•¥

å¯¹äºå¤§å‹æ•°æ®åº“ï¼Œå¯ä»¥å¹¶è¡Œå¤„ç†å¤šä¸ªbinlogæ–‡ä»¶ä»¥æé«˜å¤‡ä»½é€Ÿåº¦ã€‚

```bash
#!/bin/bash
# parallel_incremental_backup.sh

# å¹¶è¡Œå¤„ç†binlogæ–‡ä»¶
parallel_binlog_backup() {
    local start_file="$1"
    local end_file="$2"
    local output_dir="$3"
    local max_parallel=4
    
    # è·å–éœ€è¦å¤„ç†çš„binlogæ–‡ä»¶åˆ—è¡¨
    local binlog_files=($(mysql -e "SHOW BINARY LOGS" -s -N | \
        awk -v start="$start_file" -v end="$end_file" '
        BEGIN { found_start = 0 }
        $1 == start { found_start = 1 }
        found_start { print $1 }
        $1 == end { exit }
        '))
    
    echo "ğŸ“‹ å¾…å¤„ç†çš„binlogæ–‡ä»¶: ${#binlog_files[@]} ä¸ª"
    
    # å¹¶è¡Œå¤„ç†å‡½æ•°
    process_binlog() {
        local binlog_file="$1"
        local output_file="$2"
        
        echo "ğŸ”„ å¤„ç†: $binlog_file"
        mysqlbinlog "/var/log/mysql/$binlog_file" > "$output_file"
        
        if [ $? -eq 0 ]; then
            echo "âœ… å®Œæˆ: $binlog_file"
        else
            echo "âŒ å¤±è´¥: $binlog_file"
        fi
    }
    
    # å¯¼å‡ºå‡½æ•°ä¾›å¹¶è¡Œä½¿ç”¨
    export -f process_binlog
    
    # ä½¿ç”¨GNU parallelæˆ–xargså¹¶è¡Œå¤„ç†
    if command -v parallel >/dev/null 2>&1; then
        # ä½¿ç”¨GNU parallel
        printf "%s\n" "${binlog_files[@]}" | \
        parallel -j "$max_parallel" process_binlog {} "$output_dir/binlog_{}.sql"
    else
        # ä½¿ç”¨xargs
        printf "%s\n" "${binlog_files[@]}" | \
        xargs -n 1 -P "$max_parallel" -I {} bash -c 'process_binlog "$@"' _ {} "$output_dir/binlog_{}.sql"
    fi
    
    # åˆå¹¶æ‰€æœ‰è¾“å‡ºæ–‡ä»¶
    echo "ğŸ”— åˆå¹¶binlogæ–‡ä»¶..."
    cat "$output_dir"/binlog_*.sql > "$output_dir/merged_incremental.sql"
    
    # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
    rm -f "$output_dir"/binlog_*.sql
}
```

### 7.2 åˆ†åº“å¹¶è¡Œå¤‡ä»½


```bash
# æŒ‰æ•°æ®åº“å¹¶è¡Œå¤‡ä»½
parallel_database_backup() {
    local databases=($(mysql -e "SHOW DATABASES" -s -N | grep -v -E "^(information_schema|performance_schema|mysql|sys)$"))
    local max_parallel=3
    
    # æ•°æ®åº“å¤‡ä»½å‡½æ•°
    backup_database() {
        local db_name="$1"
        local backup_dir="$2"
        local timestamp="$3"
        
        echo "ğŸ“ å¤‡ä»½æ•°æ®åº“: $db_name"
        
        # ä¸ºæ¯ä¸ªæ•°æ®åº“åˆ›å»ºç‹¬ç«‹çš„å¢é‡å¤‡ä»½
        mysqlbinlog \
            --database="$db_name" \
            --start-datetime="$(date -d '1 hour ago' '+%Y-%m-%d %H:%M:%S')" \
            /var/log/mysql/mysql-bin.* > "$backup_dir/${db_name}_incremental_${timestamp}.sql"
        
        echo "âœ… å®Œæˆæ•°æ®åº“å¤‡ä»½: $db_name"
    }
    
    export -f backup_database
    
    local timestamp=$(date +%Y%m%d_%H%M%S)
    local backup_dir="/backup/incremental/$timestamp"
    mkdir -p "$backup_dir"
    
    # å¹¶è¡Œå¤‡ä»½æ‰€æœ‰æ•°æ®åº“
    printf "%s\n" "${databases[@]}" | \
    xargs -n 1 -P "$max_parallel" -I {} bash -c 'backup_database "$@"' _ {} "$backup_dir" "$timestamp"
}
```

---

## 8. ğŸ“Š å¢é‡å¤‡ä»½ç›‘æ§


### 8.1 å¤‡ä»½çŠ¶æ€ç›‘æ§è„šæœ¬


```bash
#!/bin/bash
# monitor_incremental_backup.sh

BACKUP_DIR="/backup/incremental"
LOG_FILE="/var/log/mysql_backup/monitor.log"
ALERT_EMAIL="admin@company.com"

# ç›‘æ§å‡½æ•°
monitor_backup_status() {
    local current_time=$(date '+%Y-%m-%d %H:%M:%S')
    local status_ok=true
    local issues=()
    
    echo "[$current_time] å¼€å§‹å¢é‡å¤‡ä»½ç›‘æ§æ£€æŸ¥" | tee -a "$LOG_FILE"
    
    # æ£€æŸ¥1: æœ€è¿‘çš„å¤‡ä»½æ—¶é—´
    local latest_backup=$(find "$BACKUP_DIR" -name "backup_info.txt" -type f -printf "%T@ %p\n" | sort -nr | head -1 | cut -d' ' -f2-)
    
    if [ -n "$latest_backup" ]; then
        local backup_time=$(stat -c %Y "$latest_backup")
        local current_timestamp=$(date +%s)
        local time_diff=$((current_timestamp - backup_time))
        
        # è¶…è¿‡2å°æ—¶æ²¡æœ‰å¤‡ä»½åˆ™å‘Šè­¦
        if [ $time_diff -gt 7200 ]; then
            issues+=("æœ€è¿‘å¤‡ä»½æ—¶é—´è¿‡é•¿: $(date -d @$backup_time '+%Y-%m-%d %H:%M:%S')")
            status_ok=false
        fi
    else
        issues+=("æœªæ‰¾åˆ°ä»»ä½•å¤‡ä»½æ–‡ä»¶")
        status_ok=false
    fi
    
    # æ£€æŸ¥2: ç£ç›˜ç©ºé—´
    local backup_disk_usage=$(df "$BACKUP_DIR" | awk 'NR==2 {print $5}' | tr -d '%')
    if [ "$backup_disk_usage" -gt 90 ]; then
        issues+=("å¤‡ä»½ç£ç›˜ç©ºé—´ä¸è¶³: ${backup_disk_usage}%")
        status_ok=false
    fi
    
    # æ£€æŸ¥3: binlogæ˜¯å¦æ­£å¸¸
    local binlog_status=$(mysql -e "SHOW VARIABLES LIKE 'log_bin'" -s -N | awk '{print $2}')
    if [ "$binlog_status" != "ON" ]; then
        issues+=("äºŒè¿›åˆ¶æ—¥å¿—æœªå¯ç”¨")
        status_ok=false
    fi
    
    # æ£€æŸ¥4: å¢é‡å¤‡ä»½é“¾å®Œæ•´æ€§
    if ! validate_backup_chain_simple; then
        issues+=("å¢é‡å¤‡ä»½é“¾ä¸å®Œæ•´")
        status_ok=false
    fi
    
    # ç”Ÿæˆç›‘æ§æŠ¥å‘Š
    if [ "$status_ok" = true ]; then
        echo "âœ… å¢é‡å¤‡ä»½çŠ¶æ€æ­£å¸¸" | tee -a "$LOG_FILE"
    else
        echo "âŒ å‘ç° ${#issues[@]} ä¸ªé—®é¢˜:" | tee -a "$LOG_FILE"
        for issue in "${issues[@]}"; do
            echo "  - $issue" | tee -a "$LOG_FILE"
        done
        
        # å‘é€å‘Šè­¦
        send_alert "${issues[@]}"
    fi
}

# ç®€åŒ–çš„å¤‡ä»½é“¾æ£€æŸ¥
validate_backup_chain_simple() {
    local backup_count=$(find "$BACKUP_DIR" -name "backup_info.txt" | wc -l)
    
    # è‡³å°‘åº”è¯¥æœ‰1ä¸ªå¤‡ä»½
    [ "$backup_count" -gt 0 ]
}

# å‘é€å‘Šè­¦
send_alert() {
    local issues=("$@")
    local subject="MySQLå¢é‡å¤‡ä»½å‘Šè­¦ - $(hostname)"
    local message="å‘ç°ä»¥ä¸‹é—®é¢˜:\n"
    
    for issue in "${issues[@]}"; do
        message="${message}- $issue\n"
    done
    
    message="${message}\næ£€æŸ¥æ—¶é—´: $(date)"
    
    # å‘é€é‚®ä»¶å‘Šè­¦
    echo -e "$message" | mail -s "$subject" "$ALERT_EMAIL"
    
    echo "ğŸ“§ å‘Šè­¦é‚®ä»¶å·²å‘é€è‡³: $ALERT_EMAIL" | tee -a "$LOG_FILE"
}

# æ‰§è¡Œç›‘æ§
monitor_backup_status
```

### 8.2 æ€§èƒ½æŒ‡æ ‡æ”¶é›†


```bash
# æ”¶é›†å¢é‡å¤‡ä»½æ€§èƒ½æŒ‡æ ‡
collect_backup_metrics() {
    local metrics_file="/var/log/mysql_backup/metrics.log"
    local timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    
    # å¤‡ä»½å¤§å°ç»Ÿè®¡
    local daily_backup_size=$(find "$BACKUP_DIR" -type f -name "*.sql" -mtime -1 -exec du -b {} + | awk '{sum+=$1} END {print sum/1024/1024}')
    
    # å¤‡ä»½æ–‡ä»¶æ•°é‡
    local backup_count=$(find "$BACKUP_DIR" -name "backup_info.txt" -mtime -1 | wc -l)
    
    # binlogç”Ÿæˆé€Ÿç‡
    local binlog_size=$(du -sb /var/log/mysql/mysql-bin.* | awk '{sum+=$1} END {print sum/1024/1024}')
    
    # è®°å½•æŒ‡æ ‡
    cat >> "$metrics_file" << EOF
$timestamp,daily_backup_size_mb,$daily_backup_size
$timestamp,backup_count,$backup_count
$timestamp,binlog_total_size_mb,$binlog_size
EOF
    
    echo "ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡å·²è®°å½•åˆ°: $metrics_file"
}
```

### 8.3 è‡ªåŠ¨åŒ–ç›‘æ§éƒ¨ç½²


```bash
# éƒ¨ç½²ç›‘æ§cronä»»åŠ¡
deploy_monitoring() {
    local cron_file="/etc/cron.d/mysql_incremental_backup_monitor"
    
    cat > "$cron_file" << 'EOF'
# MySQLå¢é‡å¤‡ä»½ç›‘æ§ä»»åŠ¡
MAILTO=admin@company.com

# æ¯30åˆ†é’Ÿæ£€æŸ¥å¤‡ä»½çŠ¶æ€
*/30 * * * * root /opt/mysql_backup/monitor_incremental_backup.sh

# æ¯å°æ—¶æ”¶é›†æ€§èƒ½æŒ‡æ ‡
0 * * * * root /opt/mysql_backup/collect_backup_metrics.sh

# æ¯å¤©å‡Œæ™¨æ¸…ç†è¿‡æœŸæ—¥å¿—
0 2 * * * root find /var/log/mysql_backup -name "*.log" -mtime +30 -delete
EOF

    echo "ğŸ“… ç›‘æ§ä»»åŠ¡å·²éƒ¨ç½²åˆ°: $cron_file"
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ¯ å¢é‡å¤‡ä»½æœ¬è´¨ï¼šåŸºäºäºŒè¿›åˆ¶æ—¥å¿—çš„å˜åŒ–æ•°æ®å¤‡ä»½
ğŸ”„ å·¥ä½œåŸç†ï¼šå…¨é‡å¤‡ä»½ + binlogå¢é‡ = å®Œæ•´æ¢å¤æ–¹æ¡ˆ  
ğŸ“Š GTIDä¼˜åŠ¿ï¼šå…¨å±€äº‹åŠ¡æ ‡è¯†ï¼Œç²¾ç¡®æ§åˆ¶å¢é‡èŒƒå›´
âš™ï¸ mysqlbinlogï¼šæ ¸å¿ƒå·¥å…·ï¼Œæ”¯æŒæ—¶é—´å’Œä½ç½®è¿‡æ»¤
ğŸ”— å¤‡ä»½é“¾ï¼šç¡®ä¿å¢é‡å¤‡ä»½çš„è¿ç»­æ€§å’Œå®Œæ•´æ€§
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ å¢é‡å¤‡ä»½çš„ä»·å€¼**ï¼š
```
æ—¶é—´æ•ˆç‡ï¼š
â€¢ åªå¤„ç†å˜åŒ–æ•°æ®ï¼Œå¤‡ä»½é€Ÿåº¦å¤§å¹…æå‡
â€¢ é€‚åˆå¤§å‹æ•°æ®åº“çš„æ—¥å¸¸å¤‡ä»½ç­–ç•¥

ç©ºé—´æ•ˆç‡ï¼š  
â€¢ å­˜å‚¨å¼€é”€å°ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´
â€¢ æ”¯æŒæ›´é•¿çš„å¤‡ä»½ä¿ç•™å‘¨æœŸ

ç³»ç»Ÿå½±å“ï¼š
â€¢ å‡å°‘IOè´Ÿè½½ï¼Œä¸å½±å“ä¸šåŠ¡è¿è¡Œ
â€¢ å¯åœ¨çº¿è¿›è¡Œï¼Œæ— éœ€åœæœº
```

**ğŸ”¹ binlogçš„æ ¸å¿ƒä½œç”¨**ï¼š
```
æ•°æ®ä¸€è‡´æ€§ï¼š
â€¢ è®°å½•æ‰€æœ‰æ•°æ®å˜æ›´æ“ä½œ
â€¢ ä¿è¯äº‹åŠ¡çš„ACIDç‰¹æ€§

æ¢å¤ç²¾åº¦ï¼š
â€¢ æ”¯æŒæ—¶é—´ç‚¹æ¢å¤(PITR)
â€¢ å¯ç²¾ç¡®åˆ°ç‰¹å®šäº‹åŠ¡

å¤åˆ¶åŸºç¡€ï¼š
â€¢ ä¸»ä»å¤åˆ¶çš„æ•°æ®ä¼ è¾“è½½ä½“
â€¢ æ”¯æŒå¼‚æ­¥å’ŒåŠåŒæ­¥å¤åˆ¶
```

**ğŸ”¹ GTIDçš„ä¼˜åŠ¿**ï¼š
```
ç®€åŒ–ç®¡ç†ï¼š
â€¢ å…¨å±€å”¯ä¸€æ ‡è¯†ï¼Œé¿å…ä½ç½®æ··ä¹±
â€¢ ä¸»ä»åˆ‡æ¢æ›´åŠ ç®€ä¾¿

å¹¶è¡Œèƒ½åŠ›ï¼š
â€¢ æ”¯æŒå¹¶è¡Œå¤åˆ¶æå‡æ€§èƒ½
â€¢ äº‹åŠ¡çº§åˆ«çš„å¹¶å‘æ§åˆ¶

æ•…éšœæ¢å¤ï¼š
â€¢ è‡ªåŠ¨è·³è¿‡å·²æ‰§è¡Œäº‹åŠ¡
â€¢ æé«˜å¤åˆ¶å®¹é”™èƒ½åŠ›
```

### 9.3 æœ€ä½³å®è·µæ€»ç»“


**ğŸ“‹ å¤‡ä»½ç­–ç•¥å»ºè®®**ï¼š
```
ğŸ”¸ å¤‡ä»½é¢‘ç‡ï¼š1-4å°æ—¶æ‰§è¡Œä¸€æ¬¡å¢é‡å¤‡ä»½
ğŸ”¸ ä¿ç•™ç­–ç•¥ï¼šè‡³å°‘ä¿ç•™7å¤©çš„å¢é‡å¤‡ä»½
ğŸ”¸ éªŒè¯æœºåˆ¶ï¼šå®šæœŸéªŒè¯å¤‡ä»½é“¾å®Œæ•´æ€§
ğŸ”¸ ç›‘æ§å‘Šè­¦ï¼šå»ºç«‹å®Œå–„çš„ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶
ğŸ”¸ æµ‹è¯•æ¢å¤ï¼šå®šæœŸåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯æ¢å¤æµç¨‹
```

**âš ï¸ æ³¨æ„äº‹é¡¹**ï¼š
```
é…ç½®è¦æ±‚ï¼š
â€¢ å¿…é¡»å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—
â€¢ æ¨èä½¿ç”¨ROWæ ¼å¼
â€¢ å»ºè®®å¼€å¯GTIDæ¨¡å¼

å®‰å…¨è€ƒè™‘ï¼š
â€¢ å¤‡ä»½æ–‡ä»¶è®¿é—®æƒé™æ§åˆ¶
â€¢ ç½‘ç»œä¼ è¾“åŠ å¯†
â€¢ å¤‡ä»½æ•°æ®å¼‚åœ°å­˜å‚¨

æ€§èƒ½ä¼˜åŒ–ï¼š
â€¢ åˆç†è®¾ç½®binlogå¤§å°
â€¢ æ§åˆ¶å¹¶è¡Œåº¦é¿å…è¿‡è½½
â€¢ ç›‘æ§ç£ç›˜IOå’Œç½‘ç»œå¸¦å®½
```

**ğŸš€ è¿›é˜¶æŠ€å·§**ï¼š
```
è‡ªåŠ¨åŒ–ç¨‹åº¦ï¼š
â€¢ è„šæœ¬åŒ–å¤‡ä»½æµç¨‹
â€¢ é›†æˆç›‘æ§å‘Šè­¦
â€¢ è‡ªåŠ¨æ•…éšœåˆ‡æ¢

é«˜å¯ç”¨æ–¹æ¡ˆï¼š
â€¢ ç»“åˆä¸»ä»å¤åˆ¶
â€¢ å¤šç‚¹å¤‡ä»½ç­–ç•¥
â€¢ ç¾éš¾æ¢å¤é¢„æ¡ˆ

äº‘åŸç”Ÿæ”¯æŒï¼š
â€¢ å®¹å™¨åŒ–å¤‡ä»½æ–¹æ¡ˆ
â€¢ å¯¹è±¡å­˜å‚¨é›†æˆ
â€¢ å¾®æœåŠ¡æ¶æ„é€‚é…
```

### 9.4 æ•…éšœæ’æŸ¥æŒ‡å—


**ğŸ” å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ**ï¼š

| é—®é¢˜ç°è±¡ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ³• |
|---------|---------|---------|
| `å¤‡ä»½æ–‡ä»¶ä¸ºç©º` | binlogä½ç½®é”™è¯¯ | æ£€æŸ¥èµ·æ­¢ä½ç½®æ˜¯å¦æ­£ç¡® |
| `å¤‡ä»½é“¾æ–­è£‚` | ä½ç½®è®°å½•ä¸¢å¤± | é‡å»ºä½ç½®ç´¢å¼• |
| `æ¢å¤å¤±è´¥` | SQLè¯­æ³•é”™è¯¯ | éªŒè¯binlogæ ¼å¼è®¾ç½® |
| `æ€§èƒ½ä¸‹é™` | å¹¶å‘åº¦è¿‡é«˜ | è°ƒæ•´å¹¶è¡Œå‚æ•° |

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- å¢é‡å¤‡ä»½ä¾èµ–binlogï¼Œç¡®ä¿é…ç½®æ­£ç¡®
- GTIDæ¨¡å¼æä¾›æ›´ç²¾ç¡®çš„äº‹åŠ¡æ§åˆ¶  
- å¤‡ä»½é“¾å®Œæ•´æ€§æ˜¯æ¢å¤æˆåŠŸçš„å…³é”®
- ç›‘æ§å‘Šè­¦æœºåˆ¶ä¿éšœå¤‡ä»½å¯é æ€§
- å®šæœŸæµ‹è¯•éªŒè¯æ˜¯æœ€ä½³å®è·µ