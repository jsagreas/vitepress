---
title: 8ã€SQLå…³é”®å­—ä¸ä¿ç•™å­—
---
## ğŸ“š ç›®å½•

1. [å…³é”®å­—ä¸ä¿ç•™å­—æ¦‚è¿°](#1-å…³é”®å­—ä¸ä¿ç•™å­—æ¦‚è¿°)
2. [å…³é”®å­—åˆ†ç±»ä½“ç³»](#2-å…³é”®å­—åˆ†ç±»ä½“ç³»)
3. [ä¿ç•™å…³é”®å­—è¯¦è§£](#3-ä¿ç•™å…³é”®å­—è¯¦è§£)
4. [éä¿ç•™å…³é”®å­—è¯´æ˜](#4-éä¿ç•™å…³é”®å­—è¯´æ˜)
5. [ç‰ˆæœ¬å·®å¼‚å¯¹æ¯”åˆ†æ](#5-ç‰ˆæœ¬å·®å¼‚å¯¹æ¯”åˆ†æ)
6. [å…³é”®å­—ä½¿ç”¨é™åˆ¶ä¸è§„åˆ™](#6-å…³é”®å­—ä½¿ç”¨é™åˆ¶ä¸è§„åˆ™)
7. [å‘½åå†²çªè§£å†³æ–¹æ¡ˆ](#7-å‘½åå†²çªè§£å†³æ–¹æ¡ˆ)
8. [å…¼å®¹æ€§æ£€æŸ¥ä¸å·¥å…·](#8-å…¼å®¹æ€§æ£€æŸ¥ä¸å·¥å…·)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ“– å…³é”®å­—ä¸ä¿ç•™å­—æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯SQLå…³é”®å­—å’Œä¿ç•™å­—


**ç®€å•ç†è§£**ï¼šå…³é”®å­—å°±åƒä¸­æ–‡é‡Œçš„æ ‡ç‚¹ç¬¦å·å’Œè¯­æ³•è¯æ±‡ï¼Œå®ƒä»¬æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œä¸èƒ½éšä¾¿ç”¨ä½œå…¶ä»–ç”¨é€”ã€‚

```
ç”Ÿæ´»ä¾‹å­ï¼š
åœ¨ä¸­æ–‡é‡Œï¼Œ"çš„ã€åœ°ã€å¾—"æœ‰ç‰¹å®šè¯­æ³•åŠŸèƒ½ï¼Œä¸èƒ½éšæ„æ›¿æ¢
åœ¨SQLé‡Œï¼Œ"SELECTã€FROMã€WHERE"ä¹Ÿæœ‰ç‰¹å®šå«ä¹‰ï¼Œæœ‰ä½¿ç”¨è§„åˆ™

SQLå…³é”®å­—ï¼šæœ‰ç‰¹æ®Šè¯­æ³•æ„ä¹‰çš„å•è¯
ä¿ç•™å­—ï¼šè¢«SQLæ ‡å‡†æˆ–MySQLä¿ç•™ï¼Œä¸èƒ½ä½œä¸ºæ ‡è¯†ç¬¦çš„å•è¯
```

### 1.2 å…³é”®å­—ä¸ä¿ç•™å­—çš„åŒºåˆ«


**æ¦‚å¿µåŒºåˆ†**ï¼š
```
å…³é”®å­— (Keywords)ï¼š
â€¢ å®šä¹‰ï¼šåœ¨SQLè¯­æ³•ä¸­æœ‰ç‰¹æ®Šå«ä¹‰çš„å•è¯
â€¢ ç‰¹ç‚¹ï¼šåœ¨ç‰¹å®šä¸Šä¸‹æ–‡ä¸­æœ‰è¯­æ³•ä½œç”¨
â€¢ ä¾‹å­ï¼šSELECTã€FROMã€WHEREã€JOINç­‰

ä¿ç•™å­— (Reserved Words)ï¼š
â€¢ å®šä¹‰ï¼šè¢«SQLæ ‡å‡†ä¿ç•™ï¼Œä¸èƒ½ç”¨ä½œæ ‡è¯†ç¬¦çš„å•è¯
â€¢ ç‰¹ç‚¹ï¼šä»»ä½•æƒ…å†µä¸‹éƒ½ä¸èƒ½ç”¨ä½œè¡¨åã€åˆ—åç­‰
â€¢ ä¾‹å­ï¼šæ‰€æœ‰å…³é”®å­—ï¼ŒåŠ ä¸Šä¸€äº›ä¸ºæœªæ¥æ‰©å±•ä¿ç•™çš„è¯

å…³ç³»ï¼šæ‰€æœ‰ä¿ç•™å­—éƒ½æ˜¯å…³é”®å­—ï¼Œä½†ä¸æ˜¯æ‰€æœ‰å…³é”®å­—éƒ½æ˜¯ä¿ç•™å­—
```

### 1.3 ä¸ºä»€ä¹ˆéœ€è¦å…³é”®å­—å’Œä¿ç•™å­—


**è®¾è®¡ç›®çš„**ï¼š
```
ğŸ”¸ è¯­æ³•æ˜ç¡®æ€§
â€¢ é¿å…æ­§ä¹‰ï¼šç¡®ä¿SQLè¯­å¥å«ä¹‰æ¸…æ™°
â€¢ è§£æç®€åŒ–ï¼šä¾¿äºSQLè§£æå™¨æ­£ç¡®ç†è§£è¯­å¥
â€¢ æ ‡å‡†åŒ–ï¼šä¿è¯ä¸åŒæ•°æ®åº“ç³»ç»Ÿçš„ä¸€è‡´æ€§

ğŸ”¸ æœªæ¥æ‰©å±•æ€§
â€¢ é¢„ç•™ç©ºé—´ï¼šä¸ºå°†æ¥çš„è¯­æ³•æ‰©å±•é¢„ç•™å…³é”®å­—
â€¢ å…¼å®¹æ€§ï¼šç¡®ä¿æ–°ç‰ˆæœ¬ä¸ä¼šç ´åç°æœ‰ä»£ç 
â€¢ æ ‡å‡†æ¼”è¿›ï¼šæ”¯æŒSQLæ ‡å‡†çš„æŒç»­å‘å±•

å®é™…å½±å“ï¼š
å¦‚æœæ²¡æœ‰ä¿ç•™å­—æœºåˆ¶ï¼Œç”¨æˆ·å¯èƒ½åˆ›å»ºåä¸º"SELECT"çš„è¡¨ï¼Œ
è¿™ä¼šå¯¼è‡´SQLè¯­å¥"SELECT * FROM SELECT"äº§ç”Ÿä¸¥é‡æ­§ä¹‰
```

---

## 2. ğŸ·ï¸ å…³é”®å­—åˆ†ç±»ä½“ç³»


### 2.1 å…³é”®å­—åˆ†ç±»å±‚æ¬¡ç»“æ„


```
SQLå…³é”®å­—åˆ†ç±»ä½“ç³»ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            SQLå…³é”®å­—                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                   â”‚
å®Œå…¨ä¿ç•™å­—            éƒ¨åˆ†ä¿ç•™å­—
    â”‚                   â”‚
    â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ä¸¥æ ¼ç¦ç”¨  â”‚      â”‚ä¸Šä¸‹æ–‡ç›¸å…³    â”‚
â”‚ä»»ä½•åœºæ™¯  â”‚      â”‚ç‰¹å®šåœºæ™¯ç¦ç”¨  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                   â”‚
    â–¼                   â–¼
  æ ¸å¿ƒè¯­æ³•è¯         æ‰©å±•åŠŸèƒ½è¯
 (SELECTç­‰)        (PARTITIONç­‰)
```

### 2.2 ä¿ç•™å­—ä¼˜å…ˆçº§


**ğŸ”¸ ä¼˜å…ˆçº§å±‚æ¬¡**ï¼š
```
ç¬¬1çº§ï¼šæ ¸å¿ƒSQLæ“ä½œå…³é”®å­—ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SELECT, INSERT, UPDATE, DELETE, CREATE,     â”‚
â”‚ DROP, ALTER, FROM, WHERE, ORDER, GROUP      â”‚
â”‚                                            â”‚
â”‚ ç‰¹ç‚¹ï¼šä»»ä½•æƒ…å†µä¸‹éƒ½ä¸èƒ½ç”¨ä½œæ ‡è¯†ç¬¦            â”‚
â”‚ å½±å“ï¼šç›´æ¥å¯¼è‡´è¯­æ³•é”™è¯¯                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬2çº§ï¼šæ•°æ®ç±»å‹å’Œçº¦æŸå…³é”®å­—
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ INT, VARCHAR, CHAR, TEXT, PRIMARY,          â”‚
â”‚ FOREIGN, UNIQUE, NOT, NULL, DEFAULT         â”‚
â”‚                                            â”‚
â”‚ ç‰¹ç‚¹ï¼šåœ¨å®šä¹‰ä¸Šä¸‹æ–‡ä¸­ä¸èƒ½ç”¨ä½œæ ‡è¯†ç¬¦          â”‚
â”‚ å½±å“ï¼šåœ¨ç‰¹å®šè¯­æ³•ä½ç½®å†²çª                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬3çº§ï¼šå‡½æ•°å’Œæ“ä½œç¬¦å…³é”®å­—
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ COUNT, SUM, AVG, MAX, MIN, DISTINCT,        â”‚
â”‚ AND, OR, NOT, IN, EXISTS, LIKE             â”‚
â”‚                                            â”‚
â”‚ ç‰¹ç‚¹ï¼šåœ¨è¡¨è¾¾å¼ä¸Šä¸‹æ–‡ä¸­æœ‰ç‰¹æ®Šå«ä¹‰            â”‚
â”‚ å½±å“ï¼šå¯èƒ½å¯¼è‡´æŸ¥è¯¢é€»è¾‘é”™è¯¯                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬4çº§ï¼šé«˜çº§ç‰¹æ€§å…³é”®å­—
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PARTITION, WINDOW, RECURSIVE, WITH,         â”‚
â”‚ LATERAL, GENERATED, VIRTUAL, STORED         â”‚
â”‚                                            â”‚
â”‚ ç‰¹ç‚¹ï¼šæ–°ç‰ˆæœ¬ç‰¹æ€§ç›¸å…³ï¼Œéƒ¨åˆ†åœºæ™¯ä¿ç•™          â”‚
â”‚ å½±å“ï¼šç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 ä¸Šä¸‹æ–‡ç›¸å…³å…³é”®å­—


**ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡ç›¸å…³**ï¼šåŒä¸€ä¸ªè¯åœ¨ä¸åŒçš„SQLè¯­å¥ä½ç½®å¯èƒ½æœ‰ä¸åŒçš„å«ä¹‰æˆ–é™åˆ¶ã€‚

**ğŸ”¸ ä¸Šä¸‹æ–‡ç›¸å…³ç¤ºä¾‹**ï¼š
```sql
-- COMMENTåœ¨ä¸åŒä¸Šä¸‹æ–‡ä¸­çš„å«ä¹‰

-- 1. ä½œä¸ºå…³é”®å­—ï¼šæ·»åŠ æ³¨é‡Š
CREATE TABLE users (
    id INT COMMENT 'User ID'  â† è¿™é‡ŒCOMMENTæ˜¯å…³é”®å­—
);

-- 2. ä½œä¸ºæ ‡è¯†ç¬¦ï¼šåˆ—åï¼ˆéœ€è¦è½¬ä¹‰ï¼‰
CREATE TABLE logs (
    id INT,
    `comment` TEXT  â† è¿™é‡Œcommentæ˜¯åˆ—åï¼Œéœ€è¦åå¼•å·
);

-- 3. åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨
SELECT `comment` FROM logs  â† ä½œä¸ºåˆ—åå¼•ç”¨
WHERE `comment` LIKE '%error%';
```

**ğŸ”¸ å¸¸è§ä¸Šä¸‹æ–‡ç›¸å…³å…³é”®å­—**ï¼š
```
ä¸Šä¸‹æ–‡ç›¸å…³å…³é”®å­—åˆ—è¡¨ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å…³é”®å­—       â”‚ DDLä¸Šä¸‹æ–‡       â”‚ DMLä¸Šä¸‹æ–‡       â”‚ æ ‡è¯†ç¬¦ä¸Šä¸‹æ–‡     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ COMMENT     â”‚ ä¿ç•™ï¼ˆæ³¨é‡Šè¯­æ³•ï¼‰ â”‚ éä¿ç•™          â”‚ éœ€è½¬ä¹‰          â”‚
â”‚ KEY         â”‚ ä¿ç•™ï¼ˆç´¢å¼•å®šä¹‰ï¼‰ â”‚ éä¿ç•™          â”‚ éœ€è½¬ä¹‰          â”‚
â”‚ INDEX       â”‚ ä¿ç•™ï¼ˆç´¢å¼•æ“ä½œï¼‰ â”‚ éä¿ç•™          â”‚ éœ€è½¬ä¹‰          â”‚
â”‚ PARTITION   â”‚ ä¿ç•™ï¼ˆåˆ†åŒºè¯­æ³•ï¼‰ â”‚ éä¿ç•™          â”‚ éœ€è½¬ä¹‰          â”‚
â”‚ TRIGGER     â”‚ ä¿ç•™ï¼ˆè§¦å‘å™¨ï¼‰   â”‚ éä¿ç•™          â”‚ éœ€è½¬ä¹‰          â”‚
â”‚ VIEW        â”‚ ä¿ç•™ï¼ˆè§†å›¾æ“ä½œï¼‰ â”‚ éä¿ç•™          â”‚ éœ€è½¬ä¹‰          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä½¿ç”¨åŸåˆ™ï¼š
â€¢ åœ¨ä¿ç•™ä¸Šä¸‹æ–‡ä¸­ï¼šä¸èƒ½ç”¨ä½œæ ‡è¯†ç¬¦
â€¢ åœ¨éä¿ç•™ä¸Šä¸‹æ–‡ä¸­ï¼šå¯ä»¥æ­£å¸¸ä½¿ç”¨
â€¢ ä½œä¸ºæ ‡è¯†ç¬¦æ—¶ï¼šå»ºè®®ä½¿ç”¨åå¼•å·è½¬ä¹‰
```

### 2.4 å…³é”®å­—å¤§å°å†™è§„åˆ™


**ğŸ”¸ MySQLå…³é”®å­—å¤§å°å†™å¤„ç†**ï¼š
```sql
-- MySQLå¯¹å…³é”®å­—å¤§å°å†™ä¸æ•æ„Ÿ
SELECT * FROM users;  â† æ ‡å‡†å†™æ³•
select * from users;  â† å°å†™ï¼ŒåŒæ ·æœ‰æ•ˆ
Select * From users;  â† æ··åˆå¤§å°å†™ï¼ŒåŒæ ·æœ‰æ•ˆ

-- ä½†å»ºè®®éµå¾ªè§„èŒƒ
-- SQLå…³é”®å­—ï¼šå¤§å†™
-- æ ‡è¯†ç¬¦ï¼šå°å†™æˆ–ä¿æŒåŸå§‹å¤§å°å†™

å¥½çš„ç¼–ç é£æ ¼ç¤ºä¾‹ï¼š
SELECT user_id, user_name 
FROM user_table 
WHERE create_time > '2023-01-01'
ORDER BY user_id DESC;
```

**ğŸ”¸ æ ‡è¯†ç¬¦å¤§å°å†™è§„åˆ™**ï¼š
```
æ ‡è¯†ç¬¦å¤§å°å†™è¡Œä¸ºï¼š

ç³»ç»Ÿå˜é‡lower_case_table_namesæ§åˆ¶ï¼š
â€¢ 0ï¼šè¡¨ååŒºåˆ†å¤§å°å†™ï¼ˆLinuxé»˜è®¤ï¼‰
â€¢ 1ï¼šè¡¨åä¸åŒºåˆ†å¤§å°å†™ï¼Œå­˜å‚¨ä¸ºå°å†™ï¼ˆWindowsé»˜è®¤ï¼‰
â€¢ 2ï¼šè¡¨åä¸åŒºåˆ†å¤§å°å†™ï¼Œå­˜å‚¨ä¸ºåŸå§‹å¤§å°å†™ï¼ˆmacOSé»˜è®¤ï¼‰

åˆ—åå¤§å°å†™ï¼š
â€¢ æ€»æ˜¯ä¸åŒºåˆ†å¤§å°å†™
â€¢ å­˜å‚¨æ—¶ä¿æŒåŸå§‹å¤§å°å†™
â€¢ æŸ¥è¯¢æ—¶å¿½ç•¥å¤§å°å†™

ç¤ºä¾‹ï¼š
CREATE TABLE Users (UserName VARCHAR(50));  -- åˆ›å»ºæ—¶
SELECT username FROM users;                 -- æŸ¥è¯¢æ—¶ï¼Œéƒ½æœ‰æ•ˆ
```

---

## 3. ğŸ”’ ä¿ç•™å…³é”®å­—è¯¦è§£


### 3.1 ä¿ç•™å­—å®Œæ•´åˆ—è¡¨


**ğŸ”¸ æ ¸å¿ƒSQLæ“ä½œä¿ç•™å­—**ï¼š
```
æ•°æ®æŸ¥è¯¢æ“ä½œï¼š
SELECT, FROM, WHERE, ORDER, GROUP, HAVING, DISTINCT,
UNION, JOIN, INNER, LEFT, RIGHT, FULL, OUTER, ON, USING

æ•°æ®ä¿®æ”¹æ“ä½œï¼š  
INSERT, UPDATE, DELETE, REPLACE, VALUES, SET

æ•°æ®å®šä¹‰æ“ä½œï¼š
CREATE, DROP, ALTER, TABLE, INDEX, VIEW, DATABASE,
SCHEMA, COLUMN, CONSTRAINT, PRIMARY, FOREIGN, REFERENCES

æ•°æ®ç±»å‹ç›¸å…³ï¼š
INT, INTEGER, BIGINT, SMALLINT, TINYINT, DECIMAL, NUMERIC,
FLOAT, DOUBLE, REAL, CHAR, VARCHAR, TEXT, BLOB, DATE,
TIME, DATETIME, TIMESTAMP, YEAR, BOOLEAN, BINARY

æ¡ä»¶å’Œé€»è¾‘ï¼š
AND, OR, NOT, NULL, IS, IN, EXISTS, BETWEEN, LIKE,
REGEXP, CASE, WHEN, THEN, ELSE, END, IF
```

**ğŸ”¸ MySQLç‰¹æœ‰ä¿ç•™å­—**ï¼š
```
å­˜å‚¨å¼•æ“ç›¸å…³ï¼š
ENGINE, INNODB, MYISAM, MEMORY, ARCHIVE

åˆ†åŒºç›¸å…³ï¼š
PARTITION, PARTITIONS, SUBPARTITION, SUBPARTITIONS,
RANGE, LIST, HASH, LINEAR, COLUMNS

å¤åˆ¶ç›¸å…³ï¼š
MASTER, SLAVE, REPLICATION, BINLOG, RELAY

æƒé™ç›¸å…³ï¼š
GRANT, REVOKE, PRIVILEGES, USAGE, ALL, IDENTIFIED,
PASSWORD, REQUIRE, SSL, X509

æ‰©å±•åŠŸèƒ½ï¼š
TRIGGER, EVENT, PROCEDURE, FUNCTION, DELIMITER,
CALL, DECLARE, LOOP, WHILE, REPEAT, LEAVE, ITERATE
```

### 3.2 ä¿ç•™å­—ä½¿ç”¨é™åˆ¶è¯¦è§£


**ğŸ”¸ ç»å¯¹ç¦æ­¢ä½¿ç”¨çš„ä¿ç•™å­—**ï¼š
```sql
-- è¿™äº›å…³é”®å­—åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸èƒ½ä½œä¸ºæ ‡è¯†ç¬¦

-- âŒ é”™è¯¯ç¤ºä¾‹
CREATE TABLE SELECT (id INT);           -- è¯­æ³•é”™è¯¯
CREATE TABLE user (FROM VARCHAR(50));   -- è¯­æ³•é”™è¯¯  
CREATE TABLE logs (WHERE INT);          -- è¯­æ³•é”™è¯¯

-- âœ… æ­£ç¡®åšæ³•ï¼šä½¿ç”¨ä¸åŒçš„åç§°
CREATE TABLE user_select (id INT);
CREATE TABLE user (source VARCHAR(50));
CREATE TABLE logs (condition_field INT);
```

**ğŸ”¸ æ¡ä»¶é™åˆ¶çš„ä¿ç•™å­—**ï¼š
```sql
-- æŸäº›å…³é”®å­—åœ¨ç‰¹å®šä¸Šä¸‹æ–‡ä¸­å¯ä»¥ä½¿ç”¨

-- âœ… å¯ä»¥ä½œä¸ºåˆ—åï¼ˆè™½ç„¶ä¸æ¨èï¼‰
CREATE TABLE test_table (
    id INT,
    `key` VARCHAR(50),      -- KEYéœ€è¦åå¼•å·
    `index` INT,            -- INDEXéœ€è¦åå¼•å·
    `comment` TEXT          -- COMMENTéœ€è¦åå¼•å·
);

-- âœ… åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨
SELECT `key`, `index`, `comment` 
FROM test_table 
WHERE `key` = 'value';

-- âŒ ä½†ä¸èƒ½åœ¨æŸäº›è¯­æ³•ä½ç½®ä½¿ç”¨
CREATE INDEX key ON test_table(id);     -- é”™è¯¯ï¼Œindexåä¸èƒ½æ˜¯key
CREATE INDEX test_key ON test_table(id); -- æ­£ç¡®
```

### 3.3 MySQL 8.0æ–°å¢å…³é”®å­—


**ğŸ”¸ æ–°å¢ä¿ç•™å­—åˆ—è¡¨**ï¼š
```
JSONç›¸å…³æ–°å…³é”®å­—ï¼š
ARRAY, JSON_ARRAYAGG, JSON_OBJECTAGG, JSON_TABLE

çª—å£å‡½æ•°ç›¸å…³ï¼š
WINDOW, OVER, PARTITION, ROWS, RANGE, PRECEDING, 
FOLLOWING, UNBOUNDED, CURRENT, ROW

é€šç”¨è¡¨è¡¨è¾¾å¼(CTE)ï¼š
WITH, RECURSIVE

å…¶ä»–æ–°å¢ï¼š
LATERAL, GENERATED, VIRTUAL, STORED, INVISIBLE,
CLONE, COMPONENT, EXCLUDE, FOLLOWING, GROUPS,
NOWAIT, NULLS, OTHERS, PERCENT_RANK, PERSIST,
PERSIST_ONLY, PRECEDING, RANK, RECURSIVE, ROW_NUMBER,
SKIP, SYSTEM, TIES, UNBOUNDED, WINDOW
```

**ğŸ”¸ æ–°å…³é”®å­—å½±å“åˆ†æ**ï¼š
```sql
-- å¯èƒ½çš„å…¼å®¹æ€§é—®é¢˜

-- åœ¨MySQL 5.7ä¸­æ­£å¸¸å·¥ä½œ
CREATE TABLE app_data (
    id INT,
    window VARCHAR(50),     -- 5.7ä¸­windowä¸æ˜¯ä¿ç•™å­—
    rank INT                -- 5.7ä¸­rankä¸æ˜¯ä¿ç•™å­—
);

-- åœ¨MySQL 8.0ä¸­éœ€è¦è½¬ä¹‰
CREATE TABLE app_data (
    id INT,
    `window` VARCHAR(50),   -- 8.0ä¸­windowæ˜¯ä¿ç•™å­—ï¼Œéœ€è¦è½¬ä¹‰
    `rank` INT              -- 8.0ä¸­rankæ˜¯ä¿ç•™å­—ï¼Œéœ€è¦è½¬ä¹‰
);

-- æŸ¥è¯¢ä¹Ÿéœ€è¦ç›¸åº”è°ƒæ•´
SELECT `window`, `rank` FROM app_data;
```

---

## 4. ğŸ”„ éä¿ç•™å…³é”®å­—è¯´æ˜


### 4.1 éä¿ç•™å…³é”®å­—ç‰¹ç‚¹


**ä»€ä¹ˆæ˜¯éä¿ç•™å…³é”®å­—**ï¼šè¿™äº›è¯åœ¨SQLä¸­æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œä½†å¯ä»¥ä½œä¸ºæ ‡è¯†ç¬¦ä½¿ç”¨ï¼Œä¸è¿‡ä¸ºäº†ä»£ç æ¸…æ™°ï¼Œå»ºè®®é¿å…ä½¿ç”¨ã€‚

**ğŸ”¸ å¸¸è§éä¿ç•™å…³é”®å­—**ï¼š
```
æ•°æ®åº“ç®¡ç†ç›¸å…³ï¼š
ACCOUNT, ACTION, ADMIN, AFTER, AGAINST, ALGORITHM,
AUTOCOMMIT, AUTO_INCREMENT, BACKUP, BINLOG, BLOCK

æ€§èƒ½å’Œä¼˜åŒ–ï¼š
CACHE, CHECKSUM, CIPHER, CLIENT, CLOSE, CLUSTER,
COALESCE, CODE, COLLATE, COMPACT, COMPRESS, CONCURRENT

å­˜å‚¨å’Œæ–‡ä»¶ï¼š
COPY, CSV, DATA, DATAFILE, DAY, DELAY, DIRECTORY,
DISABLE, DISK, DUPLICATE, ENABLE, ENCRYPTION, ESCAPE

çŠ¶æ€å’Œç»Ÿè®¡ï¼š
ERRORS, EVENT, EXECUTE, EXPANSION, EXPORT, EXTENDED,
FAST, FIELDS, FILE, FIRST, FIXED, FLUSH, FORMAT

æƒé™å’Œå®‰å…¨ï¼š
HOST, HOSTS, HOUR, IMPORT, INDEXES, INSTALL, LANGUAGE,
LAST, LEAVES, LESS, LEVEL, LIST, LOCAL, LOGS, MASTER
```

### 4.2 éä¿ç•™å…³é”®å­—ä½¿ç”¨è§„åˆ™


**ğŸ”¸ å®‰å…¨ä½¿ç”¨æ–¹å¼**ï¼š
```sql
-- âœ… éä¿ç•™å…³é”®å­—å¯ä»¥ç›´æ¥ç”¨ä½œæ ‡è¯†ç¬¦
CREATE TABLE admin (               -- adminæ˜¯éä¿ç•™å…³é”®å­—
    id INT,
    name VARCHAR(50),
    level INT                      -- levelæ˜¯éä¿ç•™å…³é”®å­—
);

-- âœ… æŸ¥è¯¢ä¸­æ­£å¸¸ä½¿ç”¨
SELECT name, level FROM admin 
WHERE level > 5;

-- âœ… ä½œä¸ºå‡½æ•°åæˆ–è¿‡ç¨‹å  
DELIMITER //
CREATE PROCEDURE backup(IN table_name VARCHAR(50))  -- backupæ˜¯éä¿ç•™å…³é”®å­—
BEGIN
    -- å¤‡ä»½é€»è¾‘
END //
DELIMITER ;
```

**ğŸ”¸ å»ºè®®ä½¿ç”¨æ–¹å¼**ï¼š
```sql
-- è™½ç„¶å¯ä»¥ä½¿ç”¨ï¼Œä½†å»ºè®®åŠ ä¸Šè½¬ä¹‰ä»¥æé«˜å¯è¯»æ€§

-- ğŸ“ æ¨èå†™æ³•
CREATE TABLE `admin` (
    id INT,
    name VARCHAR(50),
    `level` INT
);

-- ğŸ’¡ æ›´å¥½çš„åšæ³•ï¼šä½¿ç”¨æœ‰æ„ä¹‰çš„éå…³é”®å­—åç§°
CREATE TABLE admin_users (
    id INT,
    admin_name VARCHAR(50),
    admin_level INT
);
```

### 4.3 éä¿ç•™å…³é”®å­—é£é™©è¯„ä¼°


**ğŸ”¸ æ½œåœ¨é£é™©**ï¼š
```
ç‰ˆæœ¬å‡çº§é£é™©ï¼š
â€¢ éä¿ç•™å…³é”®å­—å¯èƒ½åœ¨æ–°ç‰ˆæœ¬ä¸­å˜ä¸ºä¿ç•™å­—
â€¢ ä»£ç åœ¨å‡çº§åå¯èƒ½å‡ºç°è¯­æ³•é”™è¯¯
â€¢ éœ€è¦å¤§é‡ä¿®æ”¹ç°æœ‰ä»£ç 

å¯è¯»æ€§é£é™©ï¼š
â€¢ ä½¿ç”¨å…³é”®å­—ä½œä¸ºæ ‡è¯†ç¬¦é™ä½ä»£ç å¯è¯»æ€§
â€¢ å…¶ä»–å¼€å‘è€…å¯èƒ½è¯¯è§£ä»£ç å«ä¹‰
â€¢ ç»´æŠ¤æˆæœ¬å¢åŠ 

ç§»æ¤æ€§é£é™©ï¼š
â€¢ ä¸åŒæ•°æ®åº“ç³»ç»Ÿçš„å…³é”®å­—åˆ—è¡¨ä¸åŒ
â€¢ ä»£ç ç§»æ¤åˆ°å…¶ä»–æ•°æ®åº“æ—¶å¯èƒ½å‡ºé”™
â€¢ å½±å“åº”ç”¨çš„è·¨æ•°æ®åº“å…¼å®¹æ€§
```

---

## 5. ğŸ“Š ç‰ˆæœ¬å·®å¼‚å¯¹æ¯”åˆ†æ


### 5.1 ç‰ˆæœ¬å·®å¼‚å¯¹ç…§è¡¨


**ğŸ”¸ ä¸»è¦ç‰ˆæœ¬å…³é”®å­—å·®å¼‚**ï¼š
```
MySQLç‰ˆæœ¬å…³é”®å­—æ¼”è¿›ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å…³é”®å­—       â”‚ 5.5     â”‚ 5.6     â”‚ 5.7     â”‚ 8.0     â”‚ çŠ¶æ€å˜åŒ– â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ WINDOW      â”‚ éä¿ç•™   â”‚ éä¿ç•™   â”‚ éä¿ç•™   â”‚ ä¿ç•™     â”‚ ğŸ”´æ–°å¢   â”‚
â”‚ RANK        â”‚ éä¿ç•™   â”‚ éä¿ç•™   â”‚ éä¿ç•™   â”‚ ä¿ç•™     â”‚ ğŸ”´æ–°å¢   â”‚
â”‚ ROW_NUMBER  â”‚ éä¿ç•™   â”‚ éä¿ç•™   â”‚ éä¿ç•™   â”‚ ä¿ç•™     â”‚ ğŸ”´æ–°å¢   â”‚
â”‚ RECURSIVE   â”‚ æ—        â”‚ æ—        â”‚ æ—        â”‚ ä¿ç•™     â”‚ ğŸ”´æ–°å¢   â”‚
â”‚ WITH        â”‚ éä¿ç•™   â”‚ éä¿ç•™   â”‚ éä¿ç•™   â”‚ ä¿ç•™     â”‚ ğŸ”´å‡çº§   â”‚
â”‚ LATERAL     â”‚ æ—        â”‚ æ—        â”‚ æ—        â”‚ ä¿ç•™     â”‚ ğŸ”´æ–°å¢   â”‚
â”‚ GENERATED   â”‚ æ—        â”‚ æ—        â”‚ éä¿ç•™   â”‚ ä¿ç•™     â”‚ ğŸ”´å‡çº§   â”‚
â”‚ VIRTUAL     â”‚ éä¿ç•™   â”‚ éä¿ç•™   â”‚ éä¿ç•™   â”‚ ä¿ç•™     â”‚ ğŸ”´å‡çº§   â”‚
â”‚ STORED      â”‚ éä¿ç•™   â”‚ éä¿ç•™   â”‚ éä¿ç•™   â”‚ ä¿ç•™     â”‚ ğŸ”´å‡çº§   â”‚
â”‚ INVISIBLE   â”‚ æ—        â”‚ æ—        â”‚ æ—        â”‚ ä¿ç•™     â”‚ ğŸ”´æ–°å¢   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å›¾ä¾‹ï¼š
ğŸ”´ æ–°å¢ï¼šè¯¥ç‰ˆæœ¬æ–°å¢çš„ä¿ç•™å­—
ğŸ”´ å‡çº§ï¼šä»éä¿ç•™å‡çº§ä¸ºä¿ç•™
```

### 5.2 ç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥


**ğŸ”¸ å…¼å®¹æ€§æ£€æŸ¥å·¥å…·**ï¼š
```sql
-- æ£€æŸ¥å½“å‰æ•°æ®åº“ä¸­å¯èƒ½å­˜åœ¨çš„å…³é”®å­—å†²çª

-- 1. æ£€æŸ¥è¡¨åå†²çª
SELECT TABLE_SCHEMA, TABLE_NAME
FROM information_schema.TABLES 
WHERE TABLE_NAME IN (
    'window', 'rank', 'recursive', 'lateral', 
    'generated', 'virtual', 'stored', 'invisible'
)
AND TABLE_SCHEMA NOT IN ('information_schema', 'mysql', 'performance_schema');

-- 2. æ£€æŸ¥åˆ—åå†²çª  
SELECT TABLE_SCHEMA, TABLE_NAME, COLUMN_NAME
FROM information_schema.COLUMNS
WHERE COLUMN_NAME IN (
    'window', 'rank', 'recursive', 'lateral',
    'generated', 'virtual', 'stored', 'invisible'  
)
AND TABLE_SCHEMA NOT IN ('information_schema', 'mysql', 'performance_schema');

-- 3. æ£€æŸ¥ç´¢å¼•åå†²çª
SELECT TABLE_SCHEMA, TABLE_NAME, INDEX_NAME  
FROM information_schema.STATISTICS
WHERE INDEX_NAME IN (
    'window', 'rank', 'recursive', 'lateral'
)
AND TABLE_SCHEMA NOT IN ('information_schema', 'mysql', 'performance_schema');
```

### 5.3 ç‰ˆæœ¬å‡çº§è¿ç§»ç­–ç•¥


**ğŸ”¸ å‡çº§å‰æ£€æŸ¥æ¸…å•**ï¼š
```bash
#!/bin/bash
# MySQLç‰ˆæœ¬å‡çº§å‰çš„å…³é”®å­—æ£€æŸ¥è„šæœ¬

echo "=== MySQLå…³é”®å­—å…¼å®¹æ€§æ£€æŸ¥ ==="

# 1. æ£€æŸ¥MySQLç‰ˆæœ¬
current_version=$(mysql -V)
echo "å½“å‰ç‰ˆæœ¬ï¼š$current_version"

# 2. æ£€æŸ¥å¯èƒ½å†²çªçš„å¯¹è±¡åç§°
mysql -e "
-- æ£€æŸ¥å¯èƒ½çš„è¡¨åå†²çª
SELECT CONCAT('è¡¨åå†²çª: ', TABLE_SCHEMA, '.', TABLE_NAME) as issue
FROM information_schema.TABLES 
WHERE TABLE_NAME REGEXP '^(window|rank|recursive|lateral|generated|virtual|stored|invisible)$'
AND TABLE_SCHEMA NOT IN ('information_schema', 'mysql', 'performance_schema', 'sys')

UNION ALL

-- æ£€æŸ¥å¯èƒ½çš„åˆ—åå†²çª
SELECT CONCAT('åˆ—åå†²çª: ', TABLE_SCHEMA, '.', TABLE_NAME, '.', COLUMN_NAME) as issue
FROM information_schema.COLUMNS
WHERE COLUMN_NAME REGEXP '^(window|rank|recursive|lateral|generated|virtual|stored|invisible)$'
AND TABLE_SCHEMA NOT IN ('information_schema', 'mysql', 'performance_schema', 'sys')

UNION ALL

-- æ£€æŸ¥å¯èƒ½çš„ç´¢å¼•åå†²çª
SELECT CONCAT('ç´¢å¼•å†²çª: ', TABLE_SCHEMA, '.', TABLE_NAME, '.', INDEX_NAME) as issue
FROM information_schema.STATISTICS
WHERE INDEX_NAME REGEXP '^(window|rank|recursive|lateral)$'  
AND TABLE_SCHEMA NOT IN ('information_schema', 'mysql', 'performance_schema', 'sys');
"

echo "=== æ£€æŸ¥å®Œæˆ ==="
```

**ğŸ”¸ å†²çªè§£å†³æ–¹æ¡ˆ**ï¼š
```sql
-- å‡çº§å‰çš„é¢„å¤„ç†SQL

-- æ–¹æ¡ˆ1ï¼šé‡å‘½åå†²çªçš„å¯¹è±¡
ALTER TABLE `window` RENAME TO window_data;
ALTER TABLE user_info CHANGE `rank` user_rank INT;
ALTER INDEX `rank` ON user_scores RENAME TO user_rank_idx;

-- æ–¹æ¡ˆ2ï¼šä¸ºç°æœ‰å¯¹è±¡æ·»åŠ åå¼•å·è½¬ä¹‰
-- ï¼ˆåœ¨åº”ç”¨ä»£ç ä¸­ä¿®æ”¹æ‰€æœ‰ç›¸å…³SQLè¯­å¥ï¼‰
SELECT `window`, `rank` FROM `window` WHERE `rank` > 10;

-- æ–¹æ¡ˆ3ï¼šä½¿ç”¨åˆ«åé¿å…å†²çª
SELECT 
    w.window_size as win_size,
    w.rank_value as rank_val
FROM window_table w
WHERE w.rank_value > 10;
```

---

## 6. âš–ï¸ å…³é”®å­—ä½¿ç”¨é™åˆ¶ä¸è§„åˆ™


### 6.1 æ ‡è¯†ç¬¦å‘½åè§„åˆ™


**ğŸ”¸ åˆæ³•æ ‡è¯†ç¬¦è§„åˆ™**ï¼š
```
åŸºæœ¬è§„åˆ™ï¼š
â€¢ é•¿åº¦ï¼š1-64ä¸ªå­—ç¬¦
â€¢ é¦–å­—ç¬¦ï¼šå­—æ¯ã€ä¸‹åˆ’çº¿ã€ç¾å…ƒç¬¦å·($)ã€Unicodeå­—ç¬¦
â€¢ åç»­å­—ç¬¦ï¼šå­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€ç¾å…ƒç¬¦å·
â€¢ å¤§å°å†™ï¼šæ ¹æ®ç³»ç»Ÿè®¾ç½®å†³å®šæ˜¯å¦æ•æ„Ÿ

ç‰¹æ®Šå­—ç¬¦å¤„ç†ï¼š
â€¢ åå¼•å·(``)ï¼šå¯ä»¥åŒ…å«ä»»æ„å­—ç¬¦ï¼ŒåŒ…æ‹¬å…³é”®å­—
â€¢ åŒå¼•å·("")ï¼šåœ¨ANSIæ¨¡å¼ä¸‹ç­‰åŒäºåå¼•å·
â€¢ æ–¹æ‹¬å·([])ï¼šMicrosoft SQL Serveré£æ ¼ï¼ŒMySQLä¸æ”¯æŒ

ç¤ºä¾‹ï¼š
åˆæ³•æ ‡è¯†ç¬¦ï¼šuser_id, UserName, $temp, _private, ç”¨æˆ·è¡¨
éæ³•æ ‡è¯†ç¬¦ï¼š123abc(æ•°å­—å¼€å¤´), user-id(åŒ…å«è¿å­—ç¬¦)
éœ€è½¬ä¹‰æ ‡è¯†ç¬¦ï¼š`select`, `123abc`, `user-id`
```

**ğŸ”¸ ä¸åŒå¯¹è±¡çš„å‘½åé™åˆ¶**ï¼š
```sql
-- æ•°æ®åº“åé™åˆ¶
CREATE DATABASE `database`;          -- éœ€è¦è½¬ä¹‰
CREATE DATABASE my_app_db;           -- æ¨èå†™æ³•

-- è¡¨åé™åˆ¶  
CREATE TABLE `table` (id INT);       -- éœ€è¦è½¬ä¹‰
CREATE TABLE user_profiles (id INT); -- æ¨èå†™æ³•

-- åˆ—åé™åˆ¶
CREATE TABLE users (
    id INT,
    `order` INT,                     -- orderæ˜¯å…³é”®å­—ï¼Œéœ€è½¬ä¹‰
    user_name VARCHAR(50)            -- æ¨èä½¿ç”¨éå…³é”®å­—
);

-- ç´¢å¼•åé™åˆ¶
CREATE INDEX `index` ON users(id);   -- éœ€è¦è½¬ä¹‰
CREATE INDEX idx_user_id ON users(id); -- æ¨èå†™æ³•

-- çº¦æŸåé™åˆ¶
ALTER TABLE users 
ADD CONSTRAINT `primary` PRIMARY KEY (id);  -- éœ€è¦è½¬ä¹‰
-- æ¨èï¼š
ALTER TABLE users 
ADD CONSTRAINT pk_users_id PRIMARY KEY (id);
```

### 6.2 å…³é”®å­—æ£€æŸ¥å·¥å…·


**ğŸ”¸ å†…ç½®æ£€æŸ¥åŠŸèƒ½**ï¼š
```sql
-- MySQLæä¾›çš„å…³é”®å­—æ£€æŸ¥

-- 1. æŸ¥çœ‹æ‰€æœ‰å…³é”®å­—
SHOW KEYWORDS;

-- 2. æ£€æŸ¥ç‰¹å®šè¯æ˜¯å¦ä¸ºå…³é”®å­—
-- ï¼ˆé€šè¿‡å°è¯•åˆ›å»ºä¸´æ—¶å¯¹è±¡æ¥æµ‹è¯•ï¼‰
CREATE TEMPORARY TABLE keyword_test (test_word VARCHAR(50));
-- å¦‚æœæ‰§è¡Œå¤±è´¥ï¼Œè¯´æ˜test_wordæ˜¯å…³é”®å­—

-- 3. ä½¿ç”¨EXPLAINæ£€æŸ¥SQLè¯­æ³•
EXPLAIN SELECT window FROM user_table;  -- æ£€æŸ¥è¯­æ³•æ˜¯å¦æœ‰é—®é¢˜
```

**ğŸ”¸ è‡ªå®šä¹‰æ£€æŸ¥è„šæœ¬**ï¼š
```python
#!/usr/bin/env python3
# å…³é”®å­—å†²çªæ£€æŸ¥å·¥å…·

import mysql.connector
import re

# MySQL 8.0 ä¿ç•™å­—åˆ—è¡¨
MYSQL_80_RESERVED_WORDS = {
    'window', 'rank', 'row_number', 'recursive', 'with',
    'lateral', 'generated', 'virtual', 'stored', 'invisible',
    'array', 'clone', 'component', 'exclude', 'following',
    'groups', 'nowait', 'nulls', 'others', 'percent_rank',
    'persist', 'persist_only', 'preceding', 'skip', 'system',
    'ties', 'unbounded'
}

class KeywordChecker:
    def __init__(self, connection):
        self.conn = connection
        self.cursor = connection.cursor()
    
    def check_table_names(self):
        """æ£€æŸ¥è¡¨åæ˜¯å¦ä¸ä¿ç•™å­—å†²çª"""
        query = """
        SELECT TABLE_SCHEMA, TABLE_NAME 
        FROM information_schema.TABLES 
        WHERE TABLE_SCHEMA NOT IN ('information_schema', 'mysql', 'performance_schema', 'sys')
        """
        
        self.cursor.execute(query)
        conflicts = []
        
        for schema, table in self.cursor.fetchall():
            if table.lower() in MYSQL_80_RESERVED_WORDS:
                conflicts.append(f"è¡¨åå†²çª: {schema}.{table}")
        
        return conflicts
    
    def check_column_names(self):
        """æ£€æŸ¥åˆ—åæ˜¯å¦ä¸ä¿ç•™å­—å†²çª"""
        query = """
        SELECT TABLE_SCHEMA, TABLE_NAME, COLUMN_NAME
        FROM information_schema.COLUMNS 
        WHERE TABLE_SCHEMA NOT IN ('information_schema', 'mysql', 'performance_schema', 'sys')
        """
        
        self.cursor.execute(query)
        conflicts = []
        
        for schema, table, column in self.cursor.fetchall():
            if column.lower() in MYSQL_80_RESERVED_WORDS:
                conflicts.append(f"åˆ—åå†²çª: {schema}.{table}.{column}")
        
        return conflicts
    
    def generate_fix_sql(self, conflicts):
        """ç”Ÿæˆä¿®å¤SQLè¯­å¥"""
        fix_statements = []
        
        for conflict in conflicts:
            if "è¡¨åå†²çª" in conflict:
                # ç”Ÿæˆè¡¨é‡å‘½åSQL
                parts = conflict.split(": ")[1].split(".")
                schema, table = parts[0], parts[1]
                fix_sql = f"ALTER TABLE `{schema}`.`{table}` RENAME TO `{schema}`.`{table}_table`;"
                fix_statements.append(fix_sql)
            
            elif "åˆ—åå†²çª" in conflict:
                # ç”Ÿæˆåˆ—é‡å‘½åSQL
                parts = conflict.split(": ")[1].split(".")
                schema, table, column = parts[0], parts[1], parts[2]
                fix_sql = f"ALTER TABLE `{schema}`.`{table}` CHANGE `{column}` `{column}_col` {self.get_column_type(schema, table, column)};"
                fix_statements.append(fix_sql)
        
        return fix_statements

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    conn = mysql.connector.connect(
        host='localhost',
        user='root', 
        password='password',
        database='test_db'
    )
    
    checker = KeywordChecker(conn)
    
    print("æ£€æŸ¥è¡¨åå†²çª...")
    table_conflicts = checker.check_table_names()
    
    print("æ£€æŸ¥åˆ—åå†²çª...")
    column_conflicts = checker.check_column_names()
    
    if table_conflicts or column_conflicts:
        print("\nå‘ç°å†²çª:")
        for conflict in table_conflicts + column_conflicts:
            print(f"  - {conflict}")
        
        print("\nä¿®å¤å»ºè®®:")
        fix_sql = checker.generate_fix_sql(table_conflicts + column_conflicts)
        for sql in fix_sql:
            print(f"  {sql}")
    else:
        print("âœ… æœªå‘ç°å…³é”®å­—å†²çª")
    
    conn.close()
```

### 5.4 ç‰ˆæœ¬å…¼å®¹æ€§æœ€ä½³å®è·µ


**ğŸ”¸ ç¼–ç è§„èŒƒå»ºè®®**ï¼š
```sql
-- âœ… æ¨èçš„å‘½åè§„èŒƒ

-- 1. è¡¨åä½¿ç”¨ä¸šåŠ¡å«ä¹‰ï¼Œé¿å…å…³é”®å­—
CREATE TABLE user_accounts (        -- è€Œä¸æ˜¯users
    account_id INT,                 -- è€Œä¸æ˜¯id
    account_name VARCHAR(50),       -- è€Œä¸æ˜¯name
    create_time DATETIME,           -- è€Œä¸æ˜¯created
    update_time DATETIME            -- è€Œä¸æ˜¯modified
);

-- 2. åˆ—åä½¿ç”¨å…·ä½“æè¿°ï¼Œæ·»åŠ å‰ç¼€
CREATE TABLE product_orders (
    order_id INT,                   -- è€Œä¸æ˜¯id
    product_count INT,              -- è€Œä¸æ˜¯count  
    order_status VARCHAR(20),       -- è€Œä¸æ˜¯status
    order_date DATE                 -- è€Œä¸æ˜¯date
);

-- 3. ç´¢å¼•åä½¿ç”¨æè¿°æ€§å‘½å
CREATE INDEX idx_user_create_time ON users(create_time);  -- è€Œä¸æ˜¯time_idx
CREATE INDEX idx_order_status ON orders(status);          -- è€Œä¸æ˜¯status
```

---

## 7. ğŸ› ï¸ å‘½åå†²çªè§£å†³æ–¹æ¡ˆ


### 7.1 è½¬ä¹‰å¤„ç†æ–¹æ³•


**ğŸ”¸ MySQLè½¬ä¹‰è¯­æ³•**ï¼š
```sql
-- åå¼•å·è½¬ä¹‰ï¼ˆMySQLæ ‡å‡†æ–¹å¼ï¼‰
SELECT `select`, `from`, `where` 
FROM `table` 
WHERE `order` > 100;

-- åŒå¼•å·è½¬ä¹‰ï¼ˆANSI SQLæ¨¡å¼ï¼‰
-- éœ€è¦è®¾ç½® sql_mode='ANSI'
SET sql_mode='ANSI';
SELECT "select", "from", "where" 
FROM "table" 
WHERE "order" > 100;

-- æ³¨æ„ï¼šåå¼•å·æ˜¯MySQLçš„æ ‡å‡†ï¼Œæ¨èä½¿ç”¨
```

**ğŸ”¸ è½¬ä¹‰çš„é€‚ç”¨åœºæ™¯**ï¼š
```sql
-- âœ… å¿…é¡»è½¬ä¹‰çš„æƒ…å†µ

-- 1. ä½¿ç”¨å®Œå…¨ä¿ç•™å­—ä½œä¸ºæ ‡è¯†ç¬¦
CREATE TABLE `select` (            -- SELECTæ˜¯å®Œå…¨ä¿ç•™å­—
    `from` VARCHAR(50),            -- FROMæ˜¯å®Œå…¨ä¿ç•™å­—
    `where` TEXT                   -- WHEREæ˜¯å®Œå…¨ä¿ç•™å­—
);

-- 2. åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„æ ‡è¯†ç¬¦
CREATE TABLE `user-profiles` (     -- åŒ…å«è¿å­—ç¬¦
    `user id` INT,                 -- åŒ…å«ç©ºæ ¼
    `user@email` VARCHAR(100)      -- åŒ…å«@ç¬¦å·
);

-- 3. æ•°å­—å¼€å¤´çš„æ ‡è¯†ç¬¦
CREATE TABLE `123_logs` (          -- æ•°å­—å¼€å¤´
    `2023_data` TEXT
);

-- âŒ ä¸å»ºè®®ä½†æŠ€æœ¯ä¸Šå¯è¡Œçš„ç”¨æ³•
CREATE TABLE `create table` (      -- å¤šä¸ªå…³é”®å­—ç»„åˆ
    `drop database` INT            -- æåº¦ä¸æ¨è
);
```

### 7.2 å‘½åå†²çªé¢„é˜²ç­–ç•¥


**ğŸ”¸ å‘½åè§„èŒƒåˆ¶å®š**ï¼š
```
æ¨èçš„å‘½åè§„èŒƒï¼š

è¡¨åè§„èŒƒï¼š
â€¢ ä½¿ç”¨ä¸šåŠ¡å«ä¹‰ï¼šuser_accounts, product_orders
â€¢ æ·»åŠ åç¼€åŒºåˆ†ï¼šuser_table, log_table  
â€¢ ä½¿ç”¨å¤æ•°å½¢å¼ï¼šusers, orders, products
â€¢ é¿å…ç¼©å†™ï¼šä½¿ç”¨full_nameè€Œä¸æ˜¯fn

åˆ—åè§„èŒƒï¼š
â€¢ æ·»åŠ è¡¨åå‰ç¼€ï¼šuser_id, user_name, user_email
â€¢ ä½¿ç”¨å®Œæ•´å•è¯ï¼šdescriptionè€Œä¸æ˜¯desc
â€¢ ç»Ÿä¸€æ—¶é—´å­—æ®µï¼šcreated_at, updated_at
â€¢ å¸ƒå°”å­—æ®µå‰ç¼€ï¼šis_active, has_permission

ç´¢å¼•åè§„èŒƒï¼š  
â€¢ ä¸»é”®ï¼špk_è¡¨å
â€¢ å”¯ä¸€ç´¢å¼•ï¼šuk_è¡¨å_åˆ—å
â€¢ æ™®é€šç´¢å¼•ï¼šidx_è¡¨å_åˆ—å  
â€¢ å¤–é”®ï¼šfk_è¡¨å_å¼•ç”¨è¡¨å

çº¦æŸåè§„èŒƒï¼š
â€¢ ä¸»é”®çº¦æŸï¼špk_è¡¨å
â€¢ å¤–é”®çº¦æŸï¼šfk_è¡¨å_å¼•ç”¨è¡¨å_åˆ—å
â€¢ æ£€æŸ¥çº¦æŸï¼šck_è¡¨å_æ£€æŸ¥å†…å®¹
â€¢ å”¯ä¸€çº¦æŸï¼šuk_è¡¨å_åˆ—å
```

**ğŸ”¸ å‘½åå†²çªæ£€æŸ¥æ¸…å•**ï¼š
```sql
-- åˆ›å»ºå¯¹è±¡å‰çš„æ£€æŸ¥æ¸…å•

-- 1. å…³é”®å­—æ£€æŸ¥
-- ç¡®ä¿åç§°ä¸åœ¨ä¿ç•™å­—åˆ—è¡¨ä¸­

-- 2. é•¿åº¦æ£€æŸ¥  
-- ç¡®ä¿åç§°é•¿åº¦ä¸è¶…è¿‡64å­—ç¬¦
SELECT CHAR_LENGTH('your_very_long_table_name_that_might_exceed_limit');

-- 3. å­—ç¬¦æ£€æŸ¥
-- ç¡®ä¿åç§°åªåŒ…å«åˆæ³•å­—ç¬¦
SELECT 'table_name' REGEXP '^[a-zA-Z_$][a-zA-Z0-9_$]*$' AS is_valid;

-- 4. é‡å¤æ£€æŸ¥
-- ç¡®ä¿åç§°åœ¨å½“å‰æ¨¡å¼ä¸­ä¸é‡å¤
SELECT COUNT(*) FROM information_schema.TABLES 
WHERE TABLE_SCHEMA = 'your_database' 
AND TABLE_NAME = 'your_table_name';

-- 5. å…¼å®¹æ€§æ£€æŸ¥
-- ç¡®ä¿åç§°åœ¨ç›®æ ‡MySQLç‰ˆæœ¬ä¸­å¯ç”¨
-- ï¼ˆä½¿ç”¨å‰é¢æåˆ°çš„ç‰ˆæœ¬å·®å¼‚å¯¹ç…§è¡¨ï¼‰
```

### 7.3 è‡ªåŠ¨åŒ–å†²çªè§£å†³


**ğŸ”¸ å†²çªè§£å†³å·¥å…·å®ç°**ï¼š
```python
class MySQLKeywordResolver:
    def __init__(self):
        # åŠ è½½ä¸åŒç‰ˆæœ¬çš„å…³é”®å­—åˆ—è¡¨
        self.reserved_words_80 = self.load_reserved_words('8.0')
        self.reserved_words_57 = self.load_reserved_words('5.7')
        
    def check_identifier(self, name, context='table'):
        """æ£€æŸ¥æ ‡è¯†ç¬¦æ˜¯å¦å†²çª"""
        issues = []
        
        # æ£€æŸ¥é•¿åº¦
        if len(name) > 64:
            issues.append(f"æ ‡è¯†ç¬¦è¿‡é•¿: {len(name)} > 64")
        
        # æ£€æŸ¥å­—ç¬¦åˆæ³•æ€§
        if not re.match(r'^[a-zA-Z_$\u0080-\uFFFF][a-zA-Z0-9_$\u0080-\uFFFF]*$', name):
            issues.append("åŒ…å«éæ³•å­—ç¬¦")
        
        # æ£€æŸ¥å…³é”®å­—å†²çª
        if name.lower() in self.reserved_words_80:
            issues.append("ä¸MySQL 8.0ä¿ç•™å­—å†²çª")
        
        return issues
    
    def suggest_alternatives(self, name, context='table'):
        """å»ºè®®æ›¿ä»£åç§°"""
        if not self.check_identifier(name, context):
            return [name]  # æ— å†²çªï¼Œç›´æ¥ä½¿ç”¨
        
        suggestions = []
        
        # ç­–ç•¥1ï¼šæ·»åŠ åç¼€
        if context == 'table':
            suggestions.extend([
                f"{name}_table", f"{name}_data", f"{name}_info"
            ])
        elif context == 'column':
            suggestions.extend([
                f"{name}_col", f"{name}_field", f"{name}_value"
            ])
        
        # ç­–ç•¥2ï¼šæ·»åŠ å‰ç¼€
        suggestions.extend([
            f"app_{name}", f"my_{name}", f"custom_{name}"
        ])
        
        # ç­–ç•¥3ï¼šåŒä¹‰è¯æ›¿æ¢
        synonyms = {
            'order': ['sequence', 'arrangement', 'position'],
            'rank': ['level', 'grade', 'rating'],
            'index': ['position', 'location', 'reference']
        }
        
        if name.lower() in synonyms:
            suggestions.extend(synonyms[name.lower()])
        
        # è¿‡æ»¤æ‰ä»ç„¶å†²çªçš„å»ºè®®
        valid_suggestions = []
        for suggestion in suggestions:
            if not self.check_identifier(suggestion, context):
                valid_suggestions.append(suggestion)
        
        return valid_suggestions[:5]  # è¿”å›å‰5ä¸ªå»ºè®®
    
    def generate_escape_sql(self, original_name):
        """ç”Ÿæˆè½¬ä¹‰SQL"""
        return f"`{original_name}`"

# ä½¿ç”¨ç¤ºä¾‹
resolver = MySQLKeywordResolver()

# æ£€æŸ¥æ ‡è¯†ç¬¦
issues = resolver.check_identifier('window', 'table')
if issues:
    print(f"æ ‡è¯†ç¬¦'window'å­˜åœ¨é—®é¢˜: {issues}")
    
    # è·å–å»ºè®®
    suggestions = resolver.suggest_alternatives('window', 'table')
    print(f"å»ºè®®çš„æ›¿ä»£åç§°: {suggestions}")
    
    # ç”Ÿæˆè½¬ä¹‰æ–¹æ¡ˆ
    escaped = resolver.generate_escape_sql('window')
    print(f"è½¬ä¹‰æ–¹æ¡ˆ: {escaped}")
```

---

## 8. ğŸ” å…¼å®¹æ€§æ£€æŸ¥ä¸å·¥å…·


### 8.1 è·¨ç‰ˆæœ¬å…¼å®¹æ€§åˆ†æ


**ğŸ”¸ å…¼å®¹æ€§é£é™©è¯„ä¼°**ï¼š
```
é£é™©ç­‰çº§åˆ†ç±»ï¼š

ğŸ”´ é«˜é£é™©ï¼ˆå¿…é¡»å¤„ç†ï¼‰ï¼š
â€¢ æ–°å¢çš„å®Œå…¨ä¿ç•™å­—ï¼šWINDOW, RANK, RECURSIVEç­‰
â€¢ è¯­æ³•è¡Œä¸ºå˜åŒ–ï¼šæŸäº›å…³é”®å­—è¯­ä¹‰æ”¹å˜
â€¢ å¼ƒç”¨çš„å…³é”®å­—ï¼šæœªæ¥ç‰ˆæœ¬å¯èƒ½ç§»é™¤çš„åŠŸèƒ½

ğŸŸ¡ ä¸­é£é™©ï¼ˆå»ºè®®å¤„ç†ï¼‰ï¼š
â€¢ éä¿ç•™å˜ä¿ç•™ï¼šGENERATED, VIRTUAL, STOREDç­‰
â€¢ ä¸Šä¸‹æ–‡å˜åŒ–ï¼šæŸäº›åœºæ™¯ä¸‹çš„ä½¿ç”¨é™åˆ¶
â€¢ å‡½æ•°åå†²çªï¼šæ–°å¢å‡½æ•°ä¸ç”¨æˆ·å¯¹è±¡é‡å

ğŸŸ¢ ä½é£é™©ï¼ˆå¯é€‰å¤„ç†ï¼‰ï¼š
â€¢ æ–°å¢éä¿ç•™å…³é”®å­—ï¼šå¯¹ç°æœ‰ä»£ç å½±å“å°
â€¢ æ‰©å±•åŠŸèƒ½è¯æ±‡ï¼šé€šå¸¸ä¸å½±å“åŸºç¡€åŠŸèƒ½
â€¢ æœªæ¥é¢„ç•™å­—ï¼šå½“å‰ç‰ˆæœ¬æ— å½±å“
```

**ğŸ”¸ å…¼å®¹æ€§æ£€æŸ¥æµç¨‹**ï¼š
```
å®Œæ•´çš„å…¼å®¹æ€§æ£€æŸ¥æµç¨‹ï¼š

æ­¥éª¤1ï¼šç¯å¢ƒä¿¡æ¯æ”¶é›†
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ å½“å‰MySQLç‰ˆæœ¬                     â”‚
â”‚ â€¢ ç›®æ ‡å‡çº§ç‰ˆæœ¬                      â”‚
â”‚ â€¢ åº”ç”¨ä½¿ç”¨çš„SQLç‰¹æ€§æ¸…å•             â”‚
â”‚ â€¢ æ•°æ®åº“å¯¹è±¡æ¸…å•                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
æ­¥éª¤2ï¼šå…³é”®å­—å†²çªæ£€æµ‹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ æ‰«ææ‰€æœ‰æ•°æ®åº“å¯¹è±¡åç§°            â”‚
â”‚ â€¢ å¯¹ç…§ç›®æ ‡ç‰ˆæœ¬å…³é”®å­—åˆ—è¡¨            â”‚
â”‚ â€¢ ç”Ÿæˆå†²çªæŠ¥å‘Š                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
æ­¥éª¤3ï¼šSQLè¯­å¥åˆ†æ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ åˆ†æåº”ç”¨ä¸­çš„SQLè¯­å¥               â”‚
â”‚ â€¢ æ£€æŸ¥è¯­æ³•å…¼å®¹æ€§                    â”‚
â”‚ â€¢ è¯†åˆ«å¯èƒ½çš„è¡Œä¸ºå˜åŒ–                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
æ­¥éª¤4ï¼šä¿®å¤æ–¹æ¡ˆç”Ÿæˆ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ ç”Ÿæˆå¯¹è±¡é‡å‘½åSQL                 â”‚
â”‚ â€¢ ç”Ÿæˆè½¬ä¹‰å¤„ç†SQL                   â”‚
â”‚ â€¢ æä¾›ä»£ç ä¿®æ”¹å»ºè®®                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 è‡ªåŠ¨åŒ–æ£€æŸ¥å·¥å…·


**ğŸ”¸ æ£€æŸ¥å·¥å…·æ¶æ„**ï¼š
```python
class MySQLCompatibilityChecker:
    def __init__(self, source_version, target_version):
        self.source_version = source_version
        self.target_version = target_version
        self.keyword_changes = self.load_version_changes()
    
    def full_compatibility_check(self, connection):
        """å®Œæ•´å…¼å®¹æ€§æ£€æŸ¥"""
        report = CompatibilityReport()
        
        # 1. å…³é”®å­—å†²çªæ£€æŸ¥
        keyword_issues = self.check_keyword_conflicts(connection)
        report.add_section("å…³é”®å­—å†²çª", keyword_issues)
        
        # 2. SQLè¯­æ³•æ£€æŸ¥
        syntax_issues = self.check_sql_syntax(connection)
        report.add_section("è¯­æ³•å…¼å®¹æ€§", syntax_issues)
        
        # 3. æ•°æ®ç±»å‹æ£€æŸ¥
        datatype_issues = self.check_datatype_changes(connection)
        report.add_section("æ•°æ®ç±»å‹", datatype_issues)
        
        # 4. å‡½æ•°å…¼å®¹æ€§æ£€æŸ¥
        function_issues = self.check_function_changes(connection)
        report.add_section("å‡½æ•°å…¼å®¹æ€§", function_issues)
        
        return report
    
    def check_keyword_conflicts(self, connection):
        """ä¸“é—¨çš„å…³é”®å­—å†²çªæ£€æŸ¥"""
        conflicts = []
        cursor = connection.cursor()
        
        # æ£€æŸ¥æ–°å¢ä¿ç•™å­—
        new_reserved_words = self.keyword_changes['newly_reserved']
        
        for word in new_reserved_words:
            # æ£€æŸ¥è¡¨å
            cursor.execute("""
                SELECT TABLE_SCHEMA, TABLE_NAME 
                FROM information_schema.TABLES 
                WHERE LOWER(TABLE_NAME) = %s
                AND TABLE_SCHEMA NOT IN ('information_schema', 'mysql', 'performance_schema', 'sys')
            """, (word.lower(),))
            
            for schema, table in cursor.fetchall():
                conflicts.append({
                    'type': 'table_name',
                    'object': f"{schema}.{table}",
                    'keyword': word,
                    'severity': 'high',
                    'action': 'rename_or_escape'
                })
            
            # æ£€æŸ¥åˆ—å
            cursor.execute("""
                SELECT TABLE_SCHEMA, TABLE_NAME, COLUMN_NAME
                FROM information_schema.COLUMNS 
                WHERE LOWER(COLUMN_NAME) = %s
                AND TABLE_SCHEMA NOT IN ('information_schema', 'mysql', 'performance_schema', 'sys')
            """, (word.lower(),))
            
            for schema, table, column in cursor.fetchall():
                conflicts.append({
                    'type': 'column_name',
                    'object': f"{schema}.{table}.{column}",
                    'keyword': word,
                    'severity': 'medium',
                    'action': 'rename_or_escape'
                })
        
        return conflicts
    
    def generate_migration_plan(self, conflicts):
        """ç”Ÿæˆè¿ç§»è®¡åˆ’"""
        plan = MigrationPlan()
        
        for conflict in conflicts:
            if conflict['severity'] == 'high':
                # é«˜é£é™©ï¼šå¿…é¡»åœ¨å‡çº§å‰å¤„ç†
                plan.add_pre_upgrade_task(
                    self.generate_fix_sql(conflict)
                )
            elif conflict['severity'] == 'medium':
                # ä¸­é£é™©ï¼šå¯ä»¥å‡çº§åå¤„ç†
                plan.add_post_upgrade_task(
                    self.generate_fix_sql(conflict)
                )
        
        return plan

class CompatibilityReport:
    def __init__(self):
        self.sections = {}
        self.summary = {}
    
    def add_section(self, section_name, issues):
        self.sections[section_name] = issues
        self.summary[section_name] = {
            'total_issues': len(issues),
            'high_severity': len([i for i in issues if i.get('severity') == 'high']),
            'medium_severity': len([i for i in issues if i.get('severity') == 'medium']),
            'low_severity': len([i for i in issues if i.get('severity') == 'low'])
        }
    
    def generate_html_report(self):
        """ç”ŸæˆHTMLæ ¼å¼çš„æ£€æŸ¥æŠ¥å‘Š"""
        # å®ç°HTMLæŠ¥å‘Šç”Ÿæˆé€»è¾‘
        pass
    
    def print_summary(self):
        """æ‰“å°æ£€æŸ¥æ‘˜è¦"""
        print("å…¼å®¹æ€§æ£€æŸ¥æ‘˜è¦:")
        print("=" * 50)
        
        total_issues = sum(s['total_issues'] for s in self.summary.values())
        high_issues = sum(s['high_severity'] for s in self.summary.values())
        
        print(f"æ€»é—®é¢˜æ•°: {total_issues}")
        print(f"é«˜é£é™©é—®é¢˜: {high_issues}")
        
        if high_issues > 0:
            print("ğŸ”´ å»ºè®®å‡çº§å‰å¤„ç†é«˜é£é™©é—®é¢˜")
        else:
            print("âœ… å¯ä»¥å®‰å…¨å‡çº§")
```

### 8.3 æŒç»­é›†æˆä¸­çš„æ£€æŸ¥


**ğŸ”¸ CI/CDæµæ°´çº¿é›†æˆ**ï¼š
```yaml
# .github/workflows/mysql-compatibility.yml
name: MySQLå…¼å®¹æ€§æ£€æŸ¥

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  mysql-compatibility:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v2
    
    - name: è®¾ç½®Pythonç¯å¢ƒ
      uses: actions/setup-python@v2
      with:
        python-version: '3.9'
    
    - name: å®‰è£…ä¾èµ–
      run: |
        pip install mysql-connector-python
        pip install -r requirements.txt
    
    - name: å¯åŠ¨MySQLæµ‹è¯•ç¯å¢ƒ
      run: |
        docker run -d \
          --name mysql-test \
          -e MYSQL_ROOT_PASSWORD=test123 \
          -e MYSQL_DATABASE=test_db \
          -p 3306:3306 \
          mysql:8.0
        
        # ç­‰å¾…MySQLå¯åŠ¨
        sleep 30
    
    - name: å¯¼å…¥æµ‹è¯•æ•°æ®
      run: |
        mysql -h127.0.0.1 -uroot -ptest123 test_db < test_schema.sql
    
    - name: æ‰§è¡Œå…¼å®¹æ€§æ£€æŸ¥
      run: |
        python tools/mysql_compatibility_checker.py \
          --host 127.0.0.1 \
          --user root \
          --password test123 \
          --database test_db \
          --target-version 8.0 \
          --report-format html \
          --output compatibility_report.html
    
    - name: ä¸Šä¼ æ£€æŸ¥æŠ¥å‘Š
      uses: actions/upload-artifact@v2
      with:
        name: compatibility-report
        path: compatibility_report.html
    
    - name: æ£€æŸ¥ç»“æœè¯„ä¼°
      run: |
        # å¦‚æœæœ‰é«˜é£é™©é—®é¢˜ï¼Œæ„å»ºå¤±è´¥
        if grep -q "high_severity.*[1-9]" compatibility_report.html; then
          echo "å‘ç°é«˜é£é™©å…¼å®¹æ€§é—®é¢˜ï¼Œè¯·ä¿®å¤åå†æäº¤"
          exit 1
        fi
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å…³é”®å­—æœ¬è´¨ï¼šSQLè¯­è¨€çš„è¯­æ³•è¯æ±‡ï¼Œæœ‰ç‰¹å®šè¯­æ³•å«ä¹‰å’Œä½¿ç”¨è§„åˆ™
ğŸ”¸ ä¿ç•™å­—æœºåˆ¶ï¼šä¸ºé˜²æ­¢æ­§ä¹‰å’Œæ”¯æŒæ‰©å±•è€Œè®¾è®¡çš„ä¿æŠ¤æœºåˆ¶
ğŸ”¸ åˆ†ç±»ä½“ç³»ï¼šå®Œå…¨ä¿ç•™ã€éƒ¨åˆ†ä¿ç•™ã€ä¸Šä¸‹æ–‡ç›¸å…³çš„å±‚æ¬¡ç»“æ„
ğŸ”¸ ç‰ˆæœ¬æ¼”è¿›ï¼šæ–°ç‰ˆæœ¬å¯èƒ½æ–°å¢ä¿ç•™å­—ï¼Œå½±å“å‘åå…¼å®¹æ€§
ğŸ”¸ è½¬ä¹‰æœºåˆ¶ï¼šä½¿ç”¨åå¼•å·ç­‰æ–¹å¼è§£å†³å‘½åå†²çªé—®é¢˜
ğŸ”¸ å…¼å®¹æ€§ç®¡ç†ï¼šç‰ˆæœ¬å‡çº§æ—¶çš„å…³é”®å­—å†²çªæ£€æŸ¥å’Œå¤„ç†
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆéœ€è¦ä¿ç•™å­—æœºåˆ¶**
```
æ ¸å¿ƒåŸå› ï¼š
â€¢ è¯­æ³•æ˜ç¡®æ€§ï¼šé¿å…SQLè¯­å¥äº§ç”Ÿæ­§ä¹‰
â€¢ è§£ææ•ˆç‡ï¼šç®€åŒ–SQLè§£æå™¨çš„å®ç°
â€¢ æ ‡å‡†ç»Ÿä¸€ï¼šä¿è¯ä¸åŒæ•°æ®åº“ç³»ç»Ÿçš„ä¸€è‡´æ€§
â€¢ æ‰©å±•èƒ½åŠ›ï¼šä¸ºæœªæ¥åŠŸèƒ½æ‰©å±•é¢„ç•™è¯æ±‡ç©ºé—´

ç±»æ¯”ç†è§£ï¼š
å°±åƒç¼–ç¨‹è¯­è¨€ä¸­çš„å…³é”®å­—ï¼ˆifã€whileã€classç­‰ï¼‰ï¼Œ
å®ƒä»¬æœ‰ç‰¹å®šè¯­æ³•ä½œç”¨ï¼Œä¸èƒ½ç”¨ä½œå˜é‡åï¼Œ
è¿™æ ·ç¼–è¯‘å™¨æ‰èƒ½æ­£ç¡®ç†è§£ä»£ç ç»“æ„ã€‚
```

**ğŸ”¹ å…³é”®å­—å†²çªçš„å®é™…å½±å“**
```
ç›´æ¥å½±å“ï¼š
â€¢ è¯­æ³•é”™è¯¯ï¼šä½¿ç”¨ä¿ç•™å­—ä½œä¸ºæ ‡è¯†ç¬¦å¯¼è‡´SQLæ‰§è¡Œå¤±è´¥
â€¢ å‡çº§é˜»å¡ï¼šç‰ˆæœ¬å‡çº§æ—¶ç°æœ‰ä»£ç å¯èƒ½æ— æ³•è¿è¡Œ
â€¢ å¼€å‘å›°æ‰°ï¼šéœ€è¦é¢å¤–çš„è½¬ä¹‰å¤„ç†ï¼Œå¢åŠ ä»£ç å¤æ‚æ€§

é—´æ¥å½±å“ï¼š
â€¢ ä»£ç å¯è¯»æ€§ï¼šå¤§é‡åå¼•å·é™ä½ä»£ç å¯è¯»æ€§
â€¢ ç»´æŠ¤æˆæœ¬ï¼šéœ€è¦æŒç»­å…³æ³¨å…³é”®å­—å˜åŒ–
â€¢ ç§»æ¤æ€§ï¼šä¸åŒæ•°æ®åº“çš„å…³é”®å­—å·®å¼‚å½±å“è·¨å¹³å°
```

**ğŸ”¹ è½¬ä¹‰vsé‡å‘½åçš„é€‰æ‹©**
```
è½¬ä¹‰æ–¹æ¡ˆï¼ˆä½¿ç”¨åå¼•å·ï¼‰ï¼š
âœ… ä¼˜ç‚¹ï¼šå¿«é€Ÿè§£å†³ï¼Œæ— éœ€ä¿®æ”¹ä¸šåŠ¡é€»è¾‘
âŒ ç¼ºç‚¹ï¼šä»£ç å¯è¯»æ€§å·®ï¼Œç»´æŠ¤å¤æ‚

é‡å‘½åæ–¹æ¡ˆï¼š
âœ… ä¼˜ç‚¹ï¼šä»£ç æ¸…æ™°ï¼Œé•¿æœŸç»´æŠ¤å‹å¥½
âŒ ç¼ºç‚¹ï¼šæ”¹åŠ¨èŒƒå›´å¤§ï¼Œéœ€è¦æµ‹è¯•éªŒè¯

é€‰æ‹©åŸåˆ™ï¼š
â€¢ ä¸´æ—¶è§£å†³ï¼šä½¿ç”¨è½¬ä¹‰æ–¹æ¡ˆ
â€¢ é•¿æœŸè§„åˆ’ï¼šä½¿ç”¨é‡å‘½åæ–¹æ¡ˆ
â€¢ æ–°é¡¹ç›®ï¼šä»ä¸€å¼€å§‹å°±é¿å…å…³é”®å­—å‘½å
```

### 9.3 å®é™…åº”ç”¨æŒ‡å¯¼


**å¼€å‘é˜¶æ®µçš„é¢„é˜²æªæ–½**ï¼š
```
è®¾è®¡é˜¶æ®µï¼š
â€¢ åˆ¶å®šå‘½åè§„èŒƒï¼šé¿å…ä½¿ç”¨ä»»ä½•å¯èƒ½çš„å…³é”®å­—
â€¢ å»ºç«‹è¯æ±‡è¡¨ï¼šç»´æŠ¤é¡¹ç›®ä¸“ç”¨çš„å‘½åè¯æ±‡åº“
â€¢ å·¥å…·è¾…åŠ©ï¼šä½¿ç”¨IDEæ’ä»¶æˆ–linteræ£€æŸ¥å…³é”®å­—å†²çª

ç¼–ç é˜¶æ®µï¼š
â€¢ ä»£ç å®¡æŸ¥ï¼šå°†å…³é”®å­—æ£€æŸ¥çº³å…¥code review
â€¢ è‡ªåŠ¨åŒ–æµ‹è¯•ï¼šåœ¨æµ‹è¯•ç¯å¢ƒä¸­éªŒè¯SQLè¯­å¥
â€¢ æ–‡æ¡£è®°å½•ï¼šè®°å½•ä½¿ç”¨è½¬ä¹‰çš„åŸå› å’Œä½ç½®

è¿ç»´é˜¶æ®µï¼š
â€¢ ç‰ˆæœ¬è§„åˆ’ï¼šå‡çº§å‰è¿›è¡Œå……åˆ†çš„å…¼å®¹æ€§æµ‹è¯•
â€¢ ç›‘æ§é¢„è­¦ï¼šç›‘æ§SQLæ‰§è¡Œé”™è¯¯ï¼ŒåŠæ—¶å‘ç°å…³é”®å­—é—®é¢˜
â€¢ åº”æ€¥æ–¹æ¡ˆï¼šå‡†å¤‡å¿«é€Ÿå›æ»šå’Œä¿®å¤ç­–ç•¥
```

**æ•…éšœæ’æŸ¥æŠ€å·§**ï¼š
```sql
-- å½“é‡åˆ°å…³é”®å­—ç›¸å…³é”™è¯¯æ—¶çš„æ’æŸ¥æ–¹æ³•

-- 1. ç¡®è®¤é”™è¯¯ç±»å‹
-- é”™è¯¯ä¿¡æ¯é€šå¸¸åŒ…å«å…·ä½“çš„å…³é”®å­—
-- ä¾‹ï¼šERROR 1064: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'rank'

-- 2. æ£€æŸ¥å¯¹è±¡åç§°
SHOW TABLES LIKE '%rank%';
SHOW COLUMNS FROM your_table LIKE '%rank%';

-- 3. éªŒè¯å…³é”®å­—çŠ¶æ€
-- å°è¯•åˆ›å»ºä¸´æ—¶å¯¹è±¡æ¥æµ‹è¯•
CREATE TEMPORARY TABLE test_rank (id INT);  -- å¦‚æœå¤±è´¥ï¼Œè¯´æ˜rankæ˜¯ä¿ç•™å­—

-- 4. åº”ç”¨ä¿®å¤æ–¹æ¡ˆ
-- ä½¿ç”¨è½¬ä¹‰
SELECT `rank` FROM your_table;
-- æˆ–é‡å‘½å
ALTER TABLE your_table CHANGE `rank` user_rank INT;
```

### 9.4 æœ€ä½³å®è·µå»ºè®®


**ğŸ”¸ å‘½åè§„èŒƒæœ€ä½³å®è·µ**ï¼š
```
æ¨èçš„å‘½åç­–ç•¥ï¼š

è¡¨åè§„èŒƒï¼š
â€¢ ä½¿ç”¨ä¸šåŠ¡æœ¯è¯­ï¼šcustomer_orders è€Œä¸æ˜¯ orders
â€¢ å¤æ•°å½¢å¼ï¼šusers, products, categories
â€¢ æ·»åŠ å‰ç¼€ï¼šapp_users, sys_logs, tmp_data

åˆ—åè§„èŒƒï¼š  
â€¢ åŒ…å«è¡¨åï¼šuser_id, user_name, user_email
â€¢ æ˜ç¡®ç±»å‹ï¼šcreated_at, is_active, total_amount
â€¢ é¿å…ç¼©å†™ï¼šdescription è€Œä¸æ˜¯ desc

ç´¢å¼•å’Œçº¦æŸï¼š
â€¢ æè¿°æ€§å‘½åï¼šidx_user_email, fk_order_user_id
â€¢ ç»Ÿä¸€å‰ç¼€ï¼špk_, fk_, idx_, uk_
â€¢ åŒ…å«å¯¹è±¡ä¿¡æ¯ï¼šé¿å…ç®€å•çš„ index1, constraint1

å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°ï¼š
â€¢ åŠ¨è¯å¼€å¤´ï¼šget_user_info, update_user_status
â€¢ æ˜ç¡®åŠŸèƒ½ï¼šcalculate_order_total
â€¢ é¿å…ç³»ç»Ÿå‡½æ•°åï¼šä¸ä½¿ç”¨count, sumç­‰ä½œä¸ºè¿‡ç¨‹å
```

**ğŸ”¸ å›¢é˜Ÿåä½œè§„èŒƒ**ï¼š
```
å›¢é˜Ÿçº§åˆ«çš„å…³é”®å­—ç®¡ç†ï¼š

1. å»ºç«‹å‘½åè§„èŒƒæ–‡æ¡£
   â€¢ å®šä¹‰é¡¹ç›®çº§åˆ«çš„å‘½åæ ‡å‡†
   â€¢ åˆ—å‡ºç¦ç”¨çš„å…³é”®å­—æ¸…å•
   â€¢ æä¾›å‘½åç¤ºä¾‹å’Œåä¾‹

2. å·¥å…·æ ‡å‡†åŒ–
   â€¢ ç»Ÿä¸€ä½¿ç”¨çš„æ•°æ®åº“ç‰ˆæœ¬
   â€¢ å…±äº«å…³é”®å­—æ£€æŸ¥å·¥å…·
   â€¢ é›†æˆåˆ°å¼€å‘å·¥ä½œæµ

3. åŸ¹è®­å’ŒçŸ¥è¯†å…±äº«
   â€¢ æ–°äººå…¥èŒåŸ¹è®­åŒ…å«å…³é”®å­—è§„èŒƒ
   â€¢ å®šæœŸæ›´æ–°å›¢é˜Ÿå…³äºæ–°ç‰ˆæœ¬å˜åŒ–çš„çŸ¥è¯†
   â€¢ å»ºç«‹é—®é¢˜å¤„ç†çš„çŸ¥è¯†åº“

4. æŒç»­æ”¹è¿›
   â€¢ æ”¶é›†å’Œåˆ†æå…³é”®å­—å†²çªæ¡ˆä¾‹
   â€¢ å®šæœŸæ›´æ–°å‘½åè§„èŒƒ
   â€¢ ä¼˜åŒ–æ£€æŸ¥å·¥å…·å’Œæµç¨‹
```

### 9.5 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ


**Q1ï¼šå¦‚ä½•çŸ¥é“æŸä¸ªè¯æ˜¯å¦ä¸ºMySQLçš„å…³é”®å­—ï¼Ÿ**
```sql
-- æ–¹æ³•1ï¼šæŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ä¸­çš„å…³é”®å­—åˆ—è¡¨

-- æ–¹æ³•2ï¼šä½¿ç”¨æµ‹è¯•æ–¹æ³•
CREATE TEMPORARY TABLE test_keyword_check (
    test_word VARCHAR(50)
);
-- å¦‚æœæŸä¸ªè¯æ˜¯å…³é”®å­—ï¼Œåœ¨æŸäº›ä¸Šä¸‹æ–‡ä¸­ä¼šæŠ¥é”™

-- æ–¹æ³•3ï¼šä½¿ç”¨åœ¨çº¿å·¥å…·æˆ–IDEæç¤º
-- å¤§å¤šæ•°MySQLå®¢æˆ·ç«¯å·¥å…·éƒ½æœ‰å…³é”®å­—é«˜äº®åŠŸèƒ½
```

**Q2ï¼šå‡çº§MySQLç‰ˆæœ¬åå‡ºç°å…³é”®å­—é”™è¯¯æ€ä¹ˆåŠï¼Ÿ**
```sql
-- åº”æ€¥å¤„ç†æ­¥éª¤ï¼š

-- 1. ç«‹å³ä¿®å¤ï¼šæ·»åŠ åå¼•å·è½¬ä¹‰
SELECT `window`, `rank` FROM user_scores;

-- 2. é•¿æœŸä¿®å¤ï¼šé‡å‘½åå¯¹è±¡
ALTER TABLE user_scores 
CHANGE `rank` user_rank INT,
CHANGE `window` time_window VARCHAR(50);

-- 3. æ‰¹é‡ä¿®å¤ï¼šä½¿ç”¨è„šæœ¬å¤„ç†
-- è§å‰é¢çš„è‡ªåŠ¨åŒ–å·¥å…·ç¤ºä¾‹
```

**Q3ï¼šå¦‚ä½•åœ¨ç°æœ‰é¡¹ç›®ä¸­å®‰å…¨åœ°é‡å‘½åå…³é”®å­—å†²çªçš„å¯¹è±¡ï¼Ÿ**
```sql
-- å®‰å…¨é‡å‘½åæµç¨‹ï¼š

-- æ­¥éª¤1ï¼šå¤‡ä»½æ•°æ®
CREATE TABLE users_backup AS SELECT * FROM users;

-- æ­¥éª¤2ï¼šåˆ›å»ºæ–°è¡¨ç»“æ„
CREATE TABLE users_new (
    user_id INT PRIMARY KEY,
    user_rank INT,                 -- åŸæ¥çš„rankåˆ—
    window_size INT                -- åŸæ¥çš„windowåˆ—
);

-- æ­¥éª¤3ï¼šè¿ç§»æ•°æ®
INSERT INTO users_new (user_id, user_rank, window_size)
SELECT user_id, `rank`, `window` FROM users;

-- æ­¥éª¤4ï¼šåˆ‡æ¢è¡¨åï¼ˆåœ¨ç»´æŠ¤çª—å£å†…æ‰§è¡Œï¼‰
RENAME TABLE 
    users TO users_old,
    users_new TO users;

-- æ­¥éª¤5ï¼šæ›´æ–°åº”ç”¨ä»£ç ä¸­çš„SQLè¯­å¥

-- æ­¥éª¤6ï¼šéªŒè¯åŠŸèƒ½æ­£å¸¸ååˆ é™¤æ—§è¡¨
DROP TABLE users_old, users_backup;
```

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- SQLå…³é”®å­—æ˜¯è¯­è¨€çš„è¯­æ³•åŸºç¡€ï¼Œä¿ç•™å­—æœºåˆ¶ä¿è¯è¯­æ³•æ¸…æ™°
- ç‰ˆæœ¬å‡çº§æ—¶æ–°å¢å…³é”®å­—å¯èƒ½å¯¼è‡´å‘½åå†²çªï¼Œéœ€è¦æå‰æ£€æŸ¥
- è½¬ä¹‰æ˜¯å¿«é€Ÿè§£å†³æ–¹æ¡ˆï¼Œé‡å‘½åæ˜¯é•¿æœŸæœ€ä½³å®è·µ
- å»ºç«‹è§„èŒƒå’Œå·¥å…·æ˜¯é¢„é˜²å…³é”®å­—é—®é¢˜çš„æ ¹æœ¬æ–¹æ³•