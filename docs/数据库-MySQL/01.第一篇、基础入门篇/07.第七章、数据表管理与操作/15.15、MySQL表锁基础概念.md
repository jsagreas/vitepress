---
title: 15ã€MySQLè¡¨é”åŸºç¡€æ¦‚å¿µ
---
## ðŸ“š ç›®å½•

1. [è¡¨é”åŸºç¡€æ¦‚å¿µ](#1-è¡¨é”åŸºç¡€æ¦‚å¿µ)
2. [è¡¨çº§é”vsè¡Œçº§é”åŒºåˆ«](#2-è¡¨çº§é”vsè¡Œçº§é”åŒºåˆ«)
3. [è¡¨é”ç±»åž‹ä¸Žæœºåˆ¶](#3-è¡¨é”ç±»åž‹ä¸Žæœºåˆ¶)
4. [è¡¨é”æ“ä½œè¯­æ³•è¯¦è§£](#4-è¡¨é”æ“ä½œè¯­æ³•è¯¦è§£)
5. [è¡¨é”å®žé™…åº”ç”¨åœºæ™¯](#5-è¡¨é”å®žé™…åº”ç”¨åœºæ™¯)
6. [è¡¨é”æ€§èƒ½å½±å“åˆ†æž](#6-è¡¨é”æ€§èƒ½å½±å“åˆ†æž)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ðŸ” è¡¨é”åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯è¡¨é”


**ðŸ”¸ è¡¨é”çš„æ ¸å¿ƒå®šä¹‰**
è¡¨é”å°±åƒç»™æ•´å¼ æ¡Œå­ä¸Šé”ï¼Œè¦ä¹ˆæ‰€æœ‰äººéƒ½èƒ½çœ‹ï¼ˆè¯»ï¼‰ï¼Œè¦ä¹ˆåªæœ‰ä¸€ä¸ªäººèƒ½æ”¹ï¼ˆå†™ï¼‰ï¼š
```
è¡¨é”ï¼šMySQLä¸­æœ€åŸºæœ¬çš„é”ç±»åž‹
ä½œç”¨ï¼šæŽ§åˆ¶å¯¹æ•´å¼ è¡¨çš„è®¿é—®æƒé™
ç‰¹ç‚¹ï¼šé”å®šç²’åº¦å¤§ï¼Œå½±å“èŒƒå›´å¹¿
å®žçŽ°ï¼šç”±MySQLæœåŠ¡å™¨å±‚å®žçŽ°ï¼Œæ‰€æœ‰å­˜å‚¨å¼•æ“Žéƒ½æ”¯æŒ
```

**ðŸ’¡ ç”Ÿæ´»ä¸­çš„ç±»æ¯”**
```
å›¾ä¹¦é¦†çš„ä¹¦æ¡Œä½¿ç”¨è§„åˆ™ï¼š

æƒ…å†µ1ï¼šå¤šäººé˜…è¯»ï¼ˆè¯»é”ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸ‘¤ è¯»è€…A    ðŸ‘¤ è¯»è€…B    â”‚  â† å¤šä¸ªäººå¯ä»¥åŒæ—¶çœ‹ä¹¦
â”‚   ðŸ“–        ðŸ“–         â”‚
â”‚  å¯ä»¥è¯»     å¯ä»¥è¯»       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æƒ…å†µ2ï¼šä¸€äººå†™ä½œï¼ˆå†™é”ï¼‰  
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       ðŸ‘¤ ä½œè€…          â”‚  â† åªæœ‰ä¸€ä¸ªäººèƒ½å†™
â”‚        âœï¸             â”‚
â”‚    ç‹¬å ä½¿ç”¨            â”‚
â”‚   å…¶ä»–äººç­‰å¾…            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 è¡¨é”åœ¨MySQLä¸­çš„åœ°ä½


**ðŸ—ï¸ MySQLé”å±‚æ¬¡ç»“æž„**
```
MySQLé”æœºåˆ¶å±‚æ¬¡å›¾ï¼š

        å…¨å±€é”
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚  è¡¨çº§é”  â”‚ â† æœ¬ç« é‡ç‚¹
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚  è¡Œçº§é”  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è¯´æ˜Žï¼š
â€¢ å…¨å±€é”ï¼šæ•´ä¸ªæ•°æ®åº“å®žä¾‹
â€¢ è¡¨çº§é”ï¼šæ•´å¼ è¡¨
â€¢ è¡Œçº§é”ï¼šè¡¨ä¸­çš„ç‰¹å®šè¡Œ
```

### 1.3 è¡¨é”çš„åŸºæœ¬åŽŸåˆ™


**ðŸ”¸ é”çš„åŸºæœ¬è§„åˆ™**
```
è¯»é”ï¼ˆå…±äº«é”ï¼‰ç‰¹ç‚¹ï¼š
âœ… å¤šä¸ªè¯»æ“ä½œå¯ä»¥åŒæ—¶è¿›è¡Œ
âŒ è¯»é”æœŸé—´ä¸èƒ½å†™å…¥æ•°æ®
ðŸ”¸ è¯»ä¸é˜»å¡žè¯»ï¼Œè¯»é˜»å¡žå†™

å†™é”ï¼ˆæŽ’ä»–é”ï¼‰ç‰¹ç‚¹ï¼š
âŒ å†™é”æœŸé—´ä¸èƒ½æœ‰å…¶ä»–ä»»ä½•æ“ä½œ
ðŸ”¸ å†™é˜»å¡žè¯»ï¼Œå†™é˜»å¡žå†™
âœ… ä¿è¯æ•°æ®ä¿®æ”¹çš„åŽŸå­æ€§
```

---

## 2. âš–ï¸ è¡¨çº§é”vsè¡Œçº§é”åŒºåˆ«


### 2.1 é”ç²’åº¦å¯¹æ¯”åˆ†æž


**ðŸ”¸ é”ç²’åº¦æ¦‚å¿µå›¾**
```
è¡¨çº§é”ï¼šé”å®šæ•´å¼ è¡¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ”’ æ•´å¼ è¡¨è¢«é”å®š             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ è¡Œ1 â”‚ è¡Œ2 â”‚ è¡Œ3 â”‚ è¡Œ4 â”‚   â”‚ â† æ‰€æœ‰è¡Œéƒ½å—å½±å“
â”‚ â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜   â”‚
â”‚ å½±å“èŒƒå›´ï¼šæ•´å¼ è¡¨              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è¡Œçº§é”ï¼šåªé”å®šç‰¹å®šè¡Œ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ è¡Œ1 â”‚ðŸ”’è¡Œ2â”‚ è¡Œ3 â”‚ è¡Œ4 â”‚   â”‚ â† åªæœ‰è¡Œ2è¢«é”å®š
â”‚ â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜   â”‚
â”‚ å½±å“èŒƒå›´ï¼šä»…è¢«æ“ä½œçš„è¡Œ        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 è¡¨çº§é”vsè¡Œçº§é”è¯¦ç»†å¯¹æ¯”


| å¯¹æ¯”ç»´åº¦ | **è¡¨çº§é”** | **è¡Œçº§é”** | **å®žé™…å½±å“** |
|---------|-----------|-----------|-------------|
| **é”å®šèŒƒå›´** | `æ•´å¼ è¡¨` | `ç‰¹å®šè¡Œ` | `è¡¨é”å½±å“æ‰€æœ‰æ“ä½œï¼Œè¡Œé”åªå½±å“ç›¸å…³è¡Œ` |
| **å¹¶å‘æ€§èƒ½** | `ä½Ž` | `é«˜` | `è¡¨é”ä¸²è¡ŒåŒ–ä¸¥é‡ï¼Œè¡Œé”æ”¯æŒçœŸæ­£å¹¶å‘` |
| **å®žçŽ°å¤æ‚åº¦** | `ç®€å•` | `å¤æ‚` | `è¡¨é”é€»è¾‘ç®€å•ï¼Œè¡Œé”éœ€è¦å¤æ‚çš„ç´¢å¼•ç»“æž„` |
| **å†…å­˜å¼€é”€** | `å°` | `å¤§` | `è¡¨é”åªéœ€å°‘é‡å…ƒæ•°æ®ï¼Œè¡Œé”éœ€è¦å¤§é‡é”ä¿¡æ¯` |
| **æ­»é”é£Žé™©** | `ä½Ž` | `é«˜` | `è¡¨é”é¡ºåºå›ºå®šä¸æ˜“æ­»é”ï¼Œè¡Œé”å¤šé”æ˜“æ­»é”` |
| **é€‚ç”¨åœºæ™¯** | `æ‰¹é‡æ“ä½œï¼Œä½Žå¹¶å‘` | `OLTPé«˜å¹¶å‘ï¼Œç‚¹æŸ¥è¯¢` | `é€‰æ‹©ä¾èµ–å…·ä½“ä¸šåŠ¡ç‰¹ç‚¹` |

### 2.3 ä¸åŒå­˜å‚¨å¼•æ“Žçš„é”æ”¯æŒ


**ðŸ”§ å­˜å‚¨å¼•æ“Žé”ç‰¹æ€§å¯¹æ¯”**
```
MyISAMå­˜å‚¨å¼•æ“Žï¼š
â€¢ åªæ”¯æŒè¡¨çº§é”
â€¢ è¯»æ“ä½œèŽ·å–è¯»é”ï¼Œå†™æ“ä½œèŽ·å–å†™é”
â€¢ ç®€å•é«˜æ•ˆï¼Œä½†å¹¶å‘æ€§å·®

InnoDBå­˜å‚¨å¼•æ“Žï¼š
â€¢ åŒæ—¶æ”¯æŒè¡¨çº§é”å’Œè¡Œçº§é”  
â€¢ é»˜è®¤ä½¿ç”¨è¡Œçº§é”
â€¢ åœ¨æŸäº›æƒ…å†µä¸‹ä¼šå‡çº§ä¸ºè¡¨é”

Memoryå­˜å‚¨å¼•æ“Žï¼š
â€¢ ä¸»è¦ä½¿ç”¨è¡¨çº§é”
â€¢ å†…å­˜æ“ä½œï¼Œé”ç«žäº‰å½±å“ç›¸å¯¹è¾ƒå°
```

**ðŸ’¡ é€‰æ‹©å»ºè®®**
- **é«˜å¹¶å‘OLTP**ï¼šä¼˜å…ˆé€‰æ‹©InnoDBè¡Œçº§é”
- **æ‰¹é‡å¤„ç†**ï¼šMyISAMè¡¨çº§é”ç®€å•æœ‰æ•ˆ
- **è¯»å¤šå†™å°‘**ï¼šMyISAMè¯»é”æ€§èƒ½ä¼˜ç§€

---

## 3. ðŸ”’ è¡¨é”ç±»åž‹ä¸Žæœºåˆ¶


### 3.1 è¯»é”ï¼ˆREAD LOCKï¼‰æœºåˆ¶


**ðŸ”¸ è¯»é”çš„å·¥ä½œåŽŸç†**
è¯»é”å°±åƒå›¾ä¹¦é¦†çš„"åªè¯»"è§„åˆ™ï¼Œå¤§å®¶éƒ½èƒ½çœ‹ä¹¦ï¼Œä½†ä¸èƒ½åœ¨ä¹¦ä¸Šå†™å­—ï¼š
```
è¯»é”ç‰¹æ€§ï¼š
âœ… å¤šä¸ªä¼šè¯å¯ä»¥åŒæ—¶èŽ·å–åŒä¸€è¡¨çš„è¯»é”
âœ… æŒæœ‰è¯»é”çš„ä¼šè¯å¯ä»¥è¯»å–è¡¨æ•°æ®
âŒ æŒæœ‰è¯»é”çš„ä¼šè¯ä¸èƒ½ä¿®æ”¹è¡¨æ•°æ®
âŒ å…¶ä»–ä¼šè¯ä¸èƒ½èŽ·å–è¯¥è¡¨çš„å†™é”
```

**ðŸ“Š è¯»é”çŠ¶æ€ç¤ºæ„å›¾**
```
è¡¨çŠ¶æ€ï¼šLOCKED FOR READ

ä¼šè¯A        ä¼šè¯B        ä¼šè¯C
 ðŸ‘¤          ðŸ‘¤          ðŸ‘¤
READé”      READé”       ç­‰å¾…WRITEé”
 â†“           â†“           â†“
å…è®¸è¯»å– â†â†’ å…è®¸è¯»å–     âŒ è¢«é˜»å¡ž
```

### 3.2 å†™é”ï¼ˆWRITE LOCKï¼‰æœºåˆ¶


**ðŸ”¸ å†™é”çš„å·¥ä½œåŽŸç†**
å†™é”å°±åƒåŒ…åœºçš„VIPæˆ¿é—´ï¼Œåªæœ‰ä¸€ä¸ªäººèƒ½è¿›å…¥ï¼Œåšä»»ä½•æƒ³åšçš„äº‹ï¼š
```
å†™é”ç‰¹æ€§ï¼š
âœ… åªæœ‰ä¸€ä¸ªä¼šè¯èƒ½èŽ·å–è¡¨çš„å†™é”
âœ… æŒæœ‰å†™é”çš„ä¼šè¯å¯ä»¥è¯»å–å’Œä¿®æ”¹è¡¨
âŒ å…¶ä»–æ‰€æœ‰ä¼šè¯è¢«å®Œå…¨é˜»å¡ž
âŒ åŒ…æ‹¬è¯»æ“ä½œä¹Ÿè¦ç­‰å¾…å†™é”é‡Šæ”¾
```

**ðŸ“Š å†™é”çŠ¶æ€ç¤ºæ„å›¾**
```
è¡¨çŠ¶æ€ï¼šLOCKED FOR WRITE

ä¼šè¯A        ä¼šè¯B        ä¼šè¯C
 ðŸ‘¤          ðŸ‘¤          ðŸ‘¤
WRITEé”     ç­‰å¾…READé”   ç­‰å¾…WRITEé”
 â†“           â†“           â†“
ç‹¬å è®¿é—®     âŒ è¢«é˜»å¡ž    âŒ è¢«é˜»å¡ž
```

### 3.3 é”å…¼å®¹æ€§çŸ©é˜µ


**ðŸ”¸ é”å†²çªå…³ç³»è¡¨**
```
å½“å‰é”çŠ¶æ€ vs è¯·æ±‚é”ç±»åž‹

           æ— é”    è¯»é”    å†™é”
    â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
æ— é” â”‚  âœ…  â”‚  âœ…  â”‚  âœ…  â”‚
    â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
è¯»é” â”‚  âœ…  â”‚  âœ…  â”‚  âŒ  â”‚
    â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤  
å†™é” â”‚  âœ…  â”‚  âŒ  â”‚  âŒ  â”‚
    â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜

âœ… = å…¼å®¹ï¼Œå¯ä»¥èŽ·å–é”
âŒ = å†²çªï¼Œéœ€è¦ç­‰å¾…
```

---

## 4. ðŸ“ è¡¨é”æ“ä½œè¯­æ³•è¯¦è§£


### 4.1 LOCK TABLES READè¯­æ³•


**ðŸ”§ è¯»é”åŸºæœ¬è¯­æ³•**
```sql
-- åŸºæœ¬è¯­æ³•
LOCK TABLES table_name READ;

-- å¤šè¡¨è¯»é”
LOCK TABLES 
    table1 READ,
    table2 READ,
    table3 READ;

-- æœ¬åœ°è¯»é”ï¼ˆå…è®¸å¹¶å‘æ’å…¥ï¼‰
LOCK TABLES table_name READ LOCAL;
```

**ðŸ’¡ è¯»é”ä½¿ç”¨ç¤ºä¾‹**
```sql
-- ç¤ºä¾‹ï¼šæŸ¥è¯¢å•†å“åº“å­˜æ—¶é¿å…æ•°æ®å˜åŠ¨
LOCK TABLES products READ;

-- å¯ä»¥è¿›è¡Œè¯»æ“ä½œ
SELECT product_id, stock_quantity 
FROM products 
WHERE category = 'electronics';

-- è®¡ç®—æ€»åº“å­˜
SELECT SUM(stock_quantity) as total_stock 
FROM products;

-- å®ŒæˆåŽé‡Šæ”¾é”
UNLOCK TABLES;
```

**âš ï¸ è¯»é”æœŸé—´çš„é™åˆ¶**
```sql
LOCK TABLES products READ;

-- âœ… å…è®¸çš„æ“ä½œ
SELECT * FROM products;

-- âŒ ä¸å…è®¸çš„æ“ä½œ 
INSERT INTO products VALUES(...);  -- æŠ¥é”™
UPDATE products SET price = 100;   -- æŠ¥é”™
DELETE FROM products WHERE id = 1; -- æŠ¥é”™

UNLOCK TABLES;
```

### 4.2 LOCK TABLES WRITEè¯­æ³•


**ðŸ”§ å†™é”åŸºæœ¬è¯­æ³•**
```sql
-- åŸºæœ¬è¯­æ³•
LOCK TABLES table_name WRITE;

-- å¤šè¡¨å†™é”
LOCK TABLES 
    table1 WRITE,
    table2 WRITE;

-- æ··åˆé”å®š
LOCK TABLES 
    main_table WRITE,
    reference_table READ;
```

**ðŸ’¡ å†™é”ä½¿ç”¨ç¤ºä¾‹**
```sql
-- ç¤ºä¾‹ï¼šæ›´æ–°è®¢å•çŠ¶æ€ï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§
LOCK TABLES orders WRITE;

-- èŽ·å–è®¢å•ä¿¡æ¯
SELECT order_status, total_amount 
FROM orders 
WHERE order_id = 12345;

-- æ›´æ–°è®¢å•çŠ¶æ€
UPDATE orders 
SET order_status = 'completed', 
    updated_time = NOW() 
WHERE order_id = 12345;

-- è®°å½•æ“ä½œæ—¥å¿—
INSERT INTO order_logs (order_id, action, timestamp) 
VALUES (12345, 'status_updated', NOW());

-- é‡Šæ”¾é”
UNLOCK TABLES;
```

### 4.3 UNLOCK TABLESè§£é”æ“ä½œ


**ðŸ”“ è§£é”æœºåˆ¶è¯¦è§£**
```sql
-- é‡Šæ”¾å½“å‰ä¼šè¯çš„æ‰€æœ‰è¡¨é”
UNLOCK TABLES;

-- æ³¨æ„ï¼šä»¥ä¸‹æƒ…å†µä¼šè‡ªåŠ¨é‡Šæ”¾è¡¨é”
-- 1. æ‰§è¡Œæ–°çš„LOCK TABLESè¯­å¥
-- 2. ä¼šè¯æ–­å¼€è¿žæŽ¥
-- 3. æ‰§è¡ŒSTART TRANSACTION
-- 4. æœåŠ¡å™¨é‡å¯
```

**ðŸ”¸ è‡ªåŠ¨è§£é”åœºæ™¯**
```sql
-- åœºæ™¯1ï¼šæ–°çš„é”æ“ä½œä¼šé‡Šæ”¾æ—§é”
LOCK TABLES table1 READ;
-- ... ä¸€äº›æ“ä½œ
LOCK TABLES table2 WRITE;  -- è‡ªåŠ¨é‡Šæ”¾table1çš„è¯»é”

-- åœºæ™¯2ï¼šäº‹åŠ¡å¼€å§‹ä¼šé‡Šæ”¾è¡¨é”
LOCK TABLES orders WRITE;
START TRANSACTION;  -- è‡ªåŠ¨é‡Šæ”¾ordersçš„å†™é”
-- æ­¤æ—¶è¿›å…¥äº‹åŠ¡æ¨¡å¼ï¼Œä½¿ç”¨è¡Œçº§é”
```

### 4.4 FLUSH TABLESåˆ·æ–°è¡¨ç¼“å­˜


**ðŸ”¸ FLUSH TABLESçš„ä½œç”¨**
FLUSH TABLESå°±åƒæ¸…ç†ç¼“å­˜ï¼Œå¼ºåˆ¶MySQLé‡æ–°åŠ è½½è¡¨ç»“æž„ï¼š
```
ä¸»è¦åŠŸèƒ½ï¼š
â€¢ å…³é—­æ‰€æœ‰æ‰“å¼€çš„è¡¨
â€¢ åˆ·æ–°è¡¨ç¼“å­˜åˆ°ç£ç›˜
â€¢ é‡æ–°åŠ è½½è¡¨ç»“æž„
â€¢ é€šå¸¸ç”¨äºŽç»´æŠ¤æ“ä½œå‰
```

**ðŸ”§ FLUSH TABLESè¯­æ³•å˜ç§**
```sql
-- åˆ·æ–°æ‰€æœ‰è¡¨
FLUSH TABLES;

-- åˆ·æ–°ç‰¹å®šè¡¨
FLUSH TABLES table1, table2;

-- åˆ·æ–°è¡¨å¹¶åŠ è¯»é”
FLUSH TABLES table_name FOR EXPORT;

-- åˆ·æ–°è¡¨å¹¶åŠ å†™é”
FLUSH TABLES table_name WITH READ LOCK;
```

**ðŸ’¡ å®žé™…åº”ç”¨åœºæ™¯**
```sql
-- åœºæ™¯1ï¼šå¤‡ä»½å‰é”å®šè¡¨
FLUSH TABLES WITH READ LOCK;
-- æ‰§è¡Œå¤‡ä»½æ“ä½œ
-- mysqldump --all-databases > backup.sql
UNLOCK TABLES;

-- åœºæ™¯2ï¼šè¡¨ç»“æž„ä¿®æ”¹å‰
FLUSH TABLES mytable;
-- ç„¶åŽè¿›è¡Œè¡¨ç»“æž„è°ƒæ•´
ALTER TABLE mytable ADD COLUMN new_col INT;
```

---

## 5. ðŸŽ¯ è¡¨é”å®žé™…åº”ç”¨åœºæ™¯


### 5.1 æ•°æ®å¤‡ä»½åœºæ™¯


**ðŸ”¸ å¤‡ä»½æ—¶çš„ä¸€è‡´æ€§ä¿è¯**
```sql
-- å®Œæ•´çš„å¤‡ä»½æµç¨‹
-- æ­¥éª¤1ï¼šé”å®šæ‰€æœ‰è¡¨ï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§
FLUSH TABLES WITH READ LOCK;

-- æ­¥éª¤2ï¼šèŽ·å–å½“å‰binlogä½ç½®ï¼ˆç”¨äºŽå¢žé‡å¤‡ä»½ï¼‰
SHOW MASTER STATUS;

-- æ­¥éª¤3ï¼šæ‰§è¡Œå¤‡ä»½ï¼ˆåœ¨å¦ä¸€ä¸ªç»ˆç«¯ï¼‰
-- mysqldump --all-databases --single-transaction > backup.sql

-- æ­¥éª¤4ï¼šé‡Šæ”¾é”
UNLOCK TABLES;
```

### 5.2 æ‰¹é‡æ•°æ®å¤„ç†åœºæ™¯


**ðŸ”¸ æ‰¹é‡å¯¼å…¥æ•°æ®**
```sql
-- å¤§æ‰¹é‡æ•°æ®å¯¼å…¥æ—¶ä½¿ç”¨å†™é”
LOCK TABLES user_import WRITE;

-- ç¦ç”¨ç´¢å¼•æ›´æ–°æé«˜æ€§èƒ½
ALTER TABLE user_import DISABLE KEYS;

-- æ‰¹é‡æ’å…¥æ•°æ®
LOAD DATA INFILE 'users.csv' 
INTO TABLE user_import
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n';

-- é‡æ–°å¯ç”¨ç´¢å¼•
ALTER TABLE user_import ENABLE KEYS;

-- é‡Šæ”¾é”
UNLOCK TABLES;
```

### 5.3 æŠ¥è¡¨ç»Ÿè®¡åœºæ™¯


**ðŸ”¸ ä¿è¯æŠ¥è¡¨æ•°æ®ä¸€è‡´æ€§**
```sql
-- ç”Ÿæˆæœˆåº¦é”€å”®æŠ¥è¡¨
LOCK TABLES 
    orders READ,
    order_items READ,
    products READ;

-- å¤æ‚ç»Ÿè®¡æŸ¥è¯¢
SELECT 
    p.category,
    COUNT(oi.order_id) as order_count,
    SUM(oi.quantity * oi.price) as total_sales
FROM orders o
JOIN order_items oi ON o.order_id = oi.order_id  
JOIN products p ON oi.product_id = p.product_id
WHERE o.order_date >= '2025-01-01'
  AND o.order_date < '2025-02-01'
GROUP BY p.category;

-- é‡Šæ”¾é”
UNLOCK TABLES;
```

---

## 6. ðŸ“Š è¡¨é”æ€§èƒ½å½±å“åˆ†æž


### 6.1 è¡¨é”å¯¹å¹¶å‘æ€§çš„å½±å“


**ðŸ”¸ å¹¶å‘æ€§èƒ½å¯¹æ¯”**
```
æ— é”çŠ¶æ€ä¸‹çš„å¹¶å‘ï¼š
æ—¶é—´è½´ï¼š1    2    3    4    5
ä¼šè¯Aï¼šè¯»    è¯»   è¯»   è¯»   è¯»
ä¼šè¯Bï¼šå†™    å†™   å†™   å†™   å†™  
ä¼šè¯Cï¼šè¯»    è¯»   è¯»   è¯»   è¯»
ç»“æžœï¼šå¹¶å‘æ‰§è¡Œï¼Œæ€§èƒ½æœ€ä½³

è¡¨é”çŠ¶æ€ä¸‹çš„å¹¶å‘ï¼š
æ—¶é—´è½´ï¼š1    2    3    4    5
ä¼šè¯Aï¼šè¯»    è¯»   è¯»   [ç­‰] [ç­‰]
ä¼šè¯Bï¼š[ç­‰] [ç­‰] [ç­‰]  å†™   å†™  
ä¼šè¯Cï¼š[ç­‰] [ç­‰] [ç­‰] [ç­‰] [ç­‰]
ç»“æžœï¼šä¸²è¡Œæ‰§è¡Œï¼Œæ€§èƒ½ä¸‹é™
```

### 6.2 è¡¨é”çš„æ€§èƒ½ç›‘æŽ§


**ðŸ“Š é”ç­‰å¾…ç›‘æŽ§**
```sql
-- æŸ¥çœ‹è¡¨é”ç­‰å¾…æƒ…å†µ
SHOW PROCESSLIST;

-- æŸ¥çœ‹é”ç­‰å¾…è¯¦ç»†ä¿¡æ¯
SELECT * FROM INFORMATION_SCHEMA.PROCESSLIST 
WHERE STATE LIKE '%lock%';

-- æŸ¥çœ‹è¡¨é”ç»Ÿè®¡ä¿¡æ¯
SHOW STATUS LIKE 'Table_locks_%';

-- ç»“æžœè§£é‡Šï¼š
-- Table_locks_immediateï¼šç«‹å³èŽ·å¾—é”çš„æ¬¡æ•°
-- Table_locks_waitedï¼šéœ€è¦ç­‰å¾…é”çš„æ¬¡æ•°
```

### 6.3 è¡¨é”æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


**âš¡ ä¼˜åŒ–å»ºè®®**
```
ç¼©çŸ­é”å®šæ—¶é—´ï¼š
â€¢ åœ¨é”å®šå‰å‡†å¤‡å¥½æ‰€æœ‰SQLè¯­å¥
â€¢ é¿å…åœ¨é”å®šæœŸé—´è¿›è¡Œå¤æ‚è®¡ç®—
â€¢ ä½¿ç”¨äº‹åŠ¡ä»£æ›¿é•¿æ—¶é—´è¡¨é”

å‡å°‘é”ç«žäº‰ï¼š
â€¢ åˆç†å®‰æŽ’æ‰¹é‡æ“ä½œæ—¶é—´
â€¢ è¯»å†™åˆ†ç¦»ï¼Œå‡å°‘é”å†²çª
â€¢ é€‰æ‹©åˆé€‚çš„å­˜å‚¨å¼•æ“Ž

ç›‘æŽ§é”çŠ¶æ€ï¼š
â€¢ å®šæœŸæ£€æŸ¥é”ç­‰å¾…ç»Ÿè®¡
â€¢ è¯†åˆ«é”ç«žäº‰çƒ­ç‚¹è¡¨
â€¢ ä¼˜åŒ–é«˜ç«žäº‰è¡¨çš„è®¿é—®æ¨¡å¼
```

**ðŸ”§ æ€§èƒ½ä¼˜åŒ–å®žä¾‹**
```sql
-- ä¼˜åŒ–å‰ï¼šé•¿æ—¶é—´æŒæœ‰å†™é”
LOCK TABLES big_table WRITE;
-- å¤æ‚çš„æ•°æ®å¤„ç†é€»è¾‘ï¼ˆè€—æ—¶10åˆ†é’Ÿï¼‰
UPDATE big_table SET status = 'processed' WHERE condition = 'pending';
UNLOCK TABLES;

-- ä¼˜åŒ–åŽï¼šåˆ†æ‰¹å¤„ç†ï¼Œå‡å°‘é”æ—¶é—´
REPEAT
    LOCK TABLES big_table WRITE;
    UPDATE big_table SET status = 'processed' 
    WHERE condition = 'pending' LIMIT 1000;
    UNLOCK TABLES;
    -- é‡Šæ”¾é”è®©å…¶ä»–æ“ä½œæœ‰æœºä¼šæ‰§è¡Œ
UNTIL (SELECT COUNT(*) FROM big_table WHERE condition = 'pending') = 0;
```

---

## 7. ðŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŽŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ðŸ”¸ è¡¨é”æœ¬è´¨ï¼šMySQLæœåŠ¡å™¨å±‚å®žçŽ°çš„è¡¨çº§åˆ«é”å®šæœºåˆ¶
ðŸ”¸ é”ç±»åž‹åˆ†ç±»ï¼šè¯»é”ï¼ˆå…±äº«ï¼‰å’Œå†™é”ï¼ˆæŽ’ä»–ï¼‰ä¸¤ç§åŸºæœ¬ç±»åž‹
ðŸ”¸ æ“ä½œè¯­æ³•ï¼šLOCK TABLESåŠ é”ï¼ŒUNLOCK TABLESè§£é”
ðŸ”¸ ç²’åº¦å¯¹æ¯”ï¼šè¡¨çº§é”å½±å“èŒƒå›´å¤§ï¼Œè¡Œçº§é”å½±å“èŒƒå›´å°
ðŸ”¸ æ€§èƒ½å½±å“ï¼šè¡¨é”é™ä½Žå¹¶å‘æ€§ï¼Œä½†å®žçŽ°ç®€å•å¼€é”€å°
ðŸ”¸ åº”ç”¨åœºæ™¯ï¼šå¤‡ä»½ã€æ‰¹é‡å¤„ç†ã€æŠ¥è¡¨ç»Ÿè®¡ç­‰ç‰¹å®šåœºæ™¯
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ðŸ”¹ è¡¨é”çš„é€‚ç”¨åŽŸåˆ™**
```
ä½¿ç”¨è¡¨é”çš„æƒ…å†µï¼š
âœ… éœ€è¦ä¿è¯å¤šè¡¨æ•°æ®ä¸€è‡´æ€§
âœ… æ‰¹é‡æ•°æ®å¯¼å…¥å¯¼å‡º
âœ… æ•°æ®åº“ç»´æŠ¤æ“ä½œ
âœ… ç”Ÿæˆé‡è¦æŠ¥è¡¨

é¿å…è¡¨é”çš„æƒ…å†µï¼š  
âŒ é«˜å¹¶å‘OLTPåœºæ™¯
âŒ é¢‘ç¹çš„å•è¡Œæ“ä½œ
âŒ ç”¨æˆ·äº¤äº’å¼æ“ä½œ
âŒ é•¿æ—¶é—´è¿è¡Œçš„æŸ¥è¯¢
```

**ðŸ”¹ è¡¨é”ä¸Žäº‹åŠ¡çš„å…³ç³»**
```
é‡è¦åŒºåˆ«ï¼š
â€¢ è¡¨é”ï¼šæœåŠ¡å™¨å±‚å®žçŽ°ï¼Œå½±å“æ‰€æœ‰å­˜å‚¨å¼•æ“Ž
â€¢ äº‹åŠ¡é”ï¼šå­˜å‚¨å¼•æ“Žå±‚å®žçŽ°ï¼Œä»…å½±å“æ”¯æŒäº‹åŠ¡çš„å¼•æ“Ž

ä½¿ç”¨é€‰æ‹©ï¼š
â€¢ çŸ­æœŸæ“ä½œï¼šä½¿ç”¨è¡¨é”ç®€å•ç›´æŽ¥
â€¢ å¤æ‚äº‹åŠ¡ï¼šä½¿ç”¨InnoDBè¡Œçº§é”å’Œäº‹åŠ¡
â€¢ æ··åˆåœºæ™¯ï¼šæ ¹æ®å…·ä½“éœ€æ±‚çµæ´»é€‰æ‹©
```

### 7.3 å®žé™…åº”ç”¨æŒ‡å¯¼


**ðŸ’¡ è¡¨é”ä½¿ç”¨æœ€ä½³å®žè·µ**
- âœ… **è®¡åˆ’å…ˆè¡Œ**ï¼šé”å®šå‰è§„åˆ’å¥½æ‰€æœ‰æ“ä½œæ­¥éª¤
- âœ… **å¿«è¿›å¿«å‡º**ï¼šå°½é‡ç¼©çŸ­é”å®šæ—¶é—´
- âœ… **é”™è¯¯å¤„ç†**ï¼šå‡†å¤‡å¼‚å¸¸æƒ…å†µçš„é”é‡Šæ”¾æœºåˆ¶
- âœ… **ç›‘æŽ§é¢„è­¦**ï¼šå»ºç«‹é”ç­‰å¾…ç›‘æŽ§æœºåˆ¶

**ðŸš¨ å¸¸è§é”™è¯¯ä¸Žé¿å…**
```
é”™è¯¯1ï¼šå¿˜è®°é‡Šæ”¾é”
LOCK TABLES orders WRITE;
-- è¿›è¡Œä¸€äº›æ“ä½œ
-- å¿˜è®°æ‰§è¡Œ UNLOCK TABLES;
-- ç»“æžœï¼šå…¶ä»–ä¼šè¯æ°¸è¿œç­‰å¾…

é¢„é˜²ï¼šä½¿ç”¨è¿žæŽ¥ç®¡ç†å·¥å…·çš„è‡ªåŠ¨è§£é”åŠŸèƒ½

é”™è¯¯2ï¼šæ­»é”æƒ…å†µ
ä¼šè¯Aï¼šLOCK TABLES table1 WRITE, table2 READ;
ä¼šè¯Bï¼šLOCK TABLES table2 WRITE, table1 READ;
-- ç»“æžœï¼šäº’ç›¸ç­‰å¾…ï¼Œå½¢æˆæ­»é”

é¢„é˜²ï¼šç»Ÿä¸€é”å®šé¡ºåºï¼Œé¿å…äº¤å‰é”å®š
```

### 7.4 å­¦ä¹ è¿›é˜¶è·¯å¾„


```
ðŸ”¸ åŸºç¡€æŽŒæ¡ï¼š
â€¢ ç†è§£è¡¨é”åŸºæœ¬æ¦‚å¿µå’Œç±»åž‹
â€¢ æŽŒæ¡åŸºæœ¬çš„åŠ é”è§£é”è¯­æ³•
â€¢ äº†è§£è¡¨é”ä¸Žè¡Œé”çš„åŒºåˆ«

ðŸ”¸ å®žè·µåº”ç”¨ï¼š
â€¢ åœ¨æµ‹è¯•çŽ¯å¢ƒç»ƒä¹ é”æ“ä½œ
â€¢ è§‚å¯Ÿé”å¯¹å¹¶å‘æ€§èƒ½çš„å½±å“
â€¢ å­¦ä¹ å¸¸è§åº”ç”¨åœºæ™¯çš„è§£å†³æ–¹æ¡ˆ

ðŸ”¸ è¿›é˜¶å­¦ä¹ ï¼š
â€¢ æ·±å…¥ç ”ç©¶InnoDBè¡Œçº§é”æœºåˆ¶
â€¢ å­¦ä¹ æ­»é”æ£€æµ‹å’Œå¤„ç†
â€¢ æŽŒæ¡é”ä¼˜åŒ–å’Œç›‘æŽ§æŠ€æœ¯
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- è¡¨é”æ˜¯MySQLæœ€åŸºç¡€çš„é”æœºåˆ¶ï¼Œç²’åº¦å¤§å½±å“èŒƒå›´å¹¿
- è¯»é”å…è®¸å¹¶å‘è¯»å–ä½†é˜»å¡žå†™å…¥ï¼Œå†™é”ç‹¬å è®¿é—®
- åˆç†ä½¿ç”¨è¡¨é”èƒ½ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Œä½†è¦æ³¨æ„å¯¹å¹¶å‘æ€§çš„å½±å“
- å®žé™…åº”ç”¨ä¸­è¦åœ¨æ•°æ®ä¸€è‡´æ€§å’Œç³»ç»Ÿæ€§èƒ½ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ç‚¹