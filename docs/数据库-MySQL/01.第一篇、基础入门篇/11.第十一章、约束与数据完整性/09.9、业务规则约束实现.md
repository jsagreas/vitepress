---
title: 9ã€ä¸šåŠ¡è§„åˆ™çº¦æŸå®ç°
---
## ğŸ“š ç›®å½•

1. [ä¸šåŠ¡è§„åˆ™çº¦æŸåŸºç¡€æ¦‚å¿µ](#1-ä¸šåŠ¡è§„åˆ™çº¦æŸåŸºç¡€æ¦‚å¿µ)
2. [CHECKçº¦æŸè¡¨è¾¾å¼è¯¦è§£](#2-CHECKçº¦æŸè¡¨è¾¾å¼è¯¦è§£)
3. [å¤åˆæ¡ä»¶çº¦æŸè®¾è®¡](#3-å¤åˆæ¡ä»¶çº¦æŸè®¾è®¡)
4. [è·¨è¡¨çº¦æŸå®ç°ç­–ç•¥](#4-è·¨è¡¨çº¦æŸå®ç°ç­–ç•¥)
5. [è§¦å‘å™¨ä¸å­˜å‚¨è¿‡ç¨‹çº¦æŸ](#5-è§¦å‘å™¨ä¸å­˜å‚¨è¿‡ç¨‹çº¦æŸ)
6. [åŠ¨æ€çº¦æŸç®¡ç†æœºåˆ¶](#6-åŠ¨æ€çº¦æŸç®¡ç†æœºåˆ¶)
7. [çº¦æŸä¸åº”ç”¨å±‚é›†æˆ](#7-çº¦æŸä¸åº”ç”¨å±‚é›†æˆ)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ ä¸šåŠ¡è§„åˆ™çº¦æŸåŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯ä¸šåŠ¡è§„åˆ™çº¦æŸ


**ğŸ”¸ æ ¸å¿ƒå®šä¹‰**
```
ä¸šåŠ¡è§„åˆ™çº¦æŸï¼šå°†ç°å®ä¸šåŠ¡é€»è¾‘è½¬åŒ–ä¸ºæ•°æ®åº“çº¦æŸæ¡ä»¶
ç›®çš„ï¼šç¡®ä¿æ•°æ®ç¬¦åˆä¸šåŠ¡è§„åˆ™ï¼Œé˜²æ­¢æ— æ•ˆæ•°æ®è¿›å…¥ç³»ç»Ÿ
å±‚æ¬¡ï¼šæ¯”åŸºç¡€çº¦æŸ(NOT NULLã€UNIQUE)æ›´å¤æ‚çš„ä¸šåŠ¡é€»è¾‘

ç¤ºä¾‹å¯¹æ¯”ï¼š
åŸºç¡€çº¦æŸï¼šå¹´é¾„ > 0  (æ•°æ®åˆç†æ€§)
ä¸šåŠ¡çº¦æŸï¼šå‘˜å·¥å·¥èµ„ <= éƒ¨é—¨é¢„ç®— * 0.3  (ä¸šåŠ¡é€»è¾‘)
```

### 1.2 ä¸šåŠ¡çº¦æŸçš„åˆ†ç±»


**ğŸ“‹ æŒ‰å¤æ‚åº¦åˆ†ç±»**
```
ğŸ”¸ ç®€å•ä¸šåŠ¡çº¦æŸ
â€¢ å•å­—æ®µæ¡ä»¶æ£€æŸ¥
â€¢ å€¼åŸŸèŒƒå›´é™åˆ¶
â€¢ æšä¸¾å€¼éªŒè¯

ğŸ”¸ å¤åˆä¸šåŠ¡çº¦æŸ  
â€¢ å¤šå­—æ®µå…³è”éªŒè¯
â€¢ æ¡ä»¶é€»è¾‘ç»„åˆ
â€¢ è®¡ç®—ç»“æœéªŒè¯

ğŸ”¸ è·¨è¡¨ä¸šåŠ¡çº¦æŸ
â€¢ è¡¨é—´æ•°æ®ä¸€è‡´æ€§
â€¢ æ±‡æ€»æ•°æ®éªŒè¯
â€¢ çŠ¶æ€è½¬æ¢è§„åˆ™
```

**ğŸ­ æŒ‰ä¸šåŠ¡ç±»å‹åˆ†ç±»**
```
æ—¶é—´çº¦æŸï¼šå¼€å§‹æ—¶é—´ < ç»“æŸæ—¶é—´
çŠ¶æ€çº¦æŸï¼šè®¢å•çŠ¶æ€è½¬æ¢è§„åˆ™
æƒé™çº¦æŸï¼šç”¨æˆ·æ“ä½œæƒé™éªŒè¯
åº“å­˜çº¦æŸï¼šåº“å­˜æ•°é‡ >= é”€å”®æ•°é‡
è´¢åŠ¡çº¦æŸï¼šæ”¶å…¥ = é”€å”®é‡‘é¢ - æˆæœ¬
```

### 1.3 ä¸šåŠ¡è§„åˆ™çº¦æŸåŒ–æ–¹æ³•


**ğŸ”§ è½¬åŒ–æ€è·¯**
```
ä¸šåŠ¡è§„åˆ™åˆ†ææµç¨‹ï¼š
1. è¯†åˆ«ä¸šåŠ¡è§„åˆ™
2. åˆ†è§£ä¸ºå¯éªŒè¯æ¡ä»¶
3. ç¡®å®šçº¦æŸçº§åˆ«
4. é€‰æ‹©å®ç°æ–¹å¼
5. æµ‹è¯•éªŒè¯

å®é™…æ¡ˆä¾‹ï¼š
ä¸šåŠ¡è§„åˆ™ï¼š"VIPå®¢æˆ·æŠ˜æ‰£ä¸èƒ½è¶…è¿‡30%"

åˆ†è§£æ­¥éª¤ï¼š
â€¢ è¯†åˆ«å­—æ®µï¼šcustomer_type, discount_rate
â€¢ æ¡ä»¶è¡¨è¾¾å¼ï¼šcustomer_type = 'VIP' AND discount_rate <= 0.3
â€¢ çº¦æŸçº§åˆ«ï¼šè®°å½•çº§åˆ«
â€¢ å®ç°æ–¹å¼ï¼šCHECKçº¦æŸæˆ–è§¦å‘å™¨
```

---

## 2. âœ… CHECKçº¦æŸè¡¨è¾¾å¼è¯¦è§£


### 2.1 CHECKçº¦æŸåŸºæœ¬è¯­æ³•


**ğŸ”¸ åŸºç¡€è¯­æ³•ç»“æ„**
```sql
-- è¡¨çº§CHECKçº¦æŸ
ALTER TABLE table_name 
ADD CONSTRAINT constraint_name 
CHECK (condition_expression);

-- åˆ—çº§CHECKçº¦æŸ
ALTER TABLE table_name 
MODIFY column_name datatype 
CHECK (condition_expression);
```

### 2.2 çº¦æŸè¡¨è¾¾å¼å‡½æ•°é™åˆ¶


**âš ï¸ CHECKçº¦æŸä¸­çš„å‡½æ•°é™åˆ¶**
```sql
-- âœ… å…è®¸ä½¿ç”¨çš„å‡½æ•°
CHECK (LENGTH(username) >= 3)           -- å­—ç¬¦ä¸²é•¿åº¦
CHECK (YEAR(birth_date) >= 1900)        -- æ—¥æœŸå‡½æ•°
CHECK (price * quantity > 0)            -- æ•°å­¦è¿ç®—
CHECK (status IN ('active', 'inactive')) -- æšä¸¾æ£€æŸ¥
CHECK (email LIKE '%@%.%')              -- æ¨¡å¼åŒ¹é…

-- âŒ ä¸èƒ½ä½¿ç”¨çš„å‡½æ•°
CHECK (created_at = NOW())              -- éç¡®å®šæ€§å‡½æ•°
CHECK (user_id = CONNECTION_ID())       -- ä¼šè¯ç›¸å…³å‡½æ•°
CHECK (RAND() > 0.5)                   -- éšæœºå‡½æ•°
CHECK (id IN (SELECT id FROM other_table)) -- å­æŸ¥è¯¢(å¤§éƒ¨åˆ†æ•°æ®åº“)
```

**ğŸ’¡ å‡½æ•°é™åˆ¶çš„åŸå› **
```
ç¡®å®šæ€§è¦æ±‚ï¼š
çº¦æŸè¡¨è¾¾å¼å¿…é¡»å¯¹ç›¸åŒè¾“å…¥äº§ç”Ÿç›¸åŒç»“æœ

æ€§èƒ½è€ƒè™‘ï¼š
å¤æ‚å‡½æ•°ä¼šå½±å“æ’å…¥å’Œæ›´æ–°æ€§èƒ½

å®‰å…¨è€ƒè™‘ï¼š
æŸäº›å‡½æ•°å¯èƒ½æš´éœ²ç³»ç»Ÿä¿¡æ¯æˆ–é€ æˆå®‰å…¨é£é™©
```

### 2.3 å®ç”¨CHECKçº¦æŸç¤ºä¾‹


**ğŸ“Š ç”µå•†ç³»ç»Ÿçº¦æŸç¤ºä¾‹**
```sql
-- ç”¨æˆ·è¡¨çº¦æŸ
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) NOT NULL,
    email VARCHAR(100) NOT NULL,
    age INT,
    gender ENUM('M', 'F', 'O'),
    phone VARCHAR(20),
    
    -- ç”¨æˆ·åé•¿åº¦çº¦æŸ
    CONSTRAINT chk_username_length 
        CHECK (LENGTH(username) BETWEEN 3 AND 20),
    
    -- å¹´é¾„åˆç†æ€§çº¦æŸ
    CONSTRAINT chk_age_range 
        CHECK (age BETWEEN 16 AND 120),
    
    -- é‚®ç®±æ ¼å¼çº¦æŸ
    CONSTRAINT chk_email_format 
        CHECK (email REGEXP '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$'),
    
    -- æ‰‹æœºå·æ ¼å¼çº¦æŸ
    CONSTRAINT chk_phone_format 
        CHECK (phone REGEXP '^1[3-9][0-9]{9}$' OR phone IS NULL)
);

-- å•†å“è¡¨çº¦æŸ
CREATE TABLE products (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    price DECIMAL(10,2) NOT NULL,
    discount_rate DECIMAL(3,2) DEFAULT 0,
    stock_quantity INT NOT NULL DEFAULT 0,
    category_id INT,
    status ENUM('active', 'inactive', 'discontinued'),
    
    -- ä»·æ ¼åˆç†æ€§çº¦æŸ
    CONSTRAINT chk_price_positive 
        CHECK (price > 0),
    
    -- æŠ˜æ‰£ç‡çº¦æŸ
    CONSTRAINT chk_discount_rate 
        CHECK (discount_rate BETWEEN 0 AND 0.9),
    
    -- åº“å­˜çº¦æŸ
    CONSTRAINT chk_stock_non_negative 
        CHECK (stock_quantity >= 0),
    
    -- æœ€ç»ˆä»·æ ¼çº¦æŸï¼ˆæŠ˜æ‰£åä»·æ ¼ä¸èƒ½ä¸ºè´Ÿï¼‰
    CONSTRAINT chk_final_price 
        CHECK (price * (1 - discount_rate) > 0)
);

-- è®¢å•è¡¨çº¦æŸ
CREATE TABLE orders (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    order_date DATETIME NOT NULL,
    delivery_date DATETIME,
    total_amount DECIMAL(12,2) NOT NULL,
    status ENUM('pending', 'confirmed', 'shipped', 'delivered', 'cancelled'),
    payment_method ENUM('card', 'cash', 'alipay', 'wechat'),
    
    -- è®¢å•é‡‘é¢çº¦æŸ
    CONSTRAINT chk_order_amount 
        CHECK (total_amount > 0),
    
    -- æ—¥æœŸé€»è¾‘çº¦æŸ
    CONSTRAINT chk_delivery_date 
        CHECK (delivery_date IS NULL OR delivery_date >= order_date),
    
    -- çŠ¶æ€è½¬æ¢çº¦æŸ
    CONSTRAINT chk_cancelled_order 
        CHECK (status != 'cancelled' OR total_amount = 0)
);
```

### 2.4 å¤åˆæ¡ä»¶çº¦æŸå®ä¾‹


**ğŸ§© å¤æ‚ä¸šåŠ¡é€»è¾‘çº¦æŸ**
```sql
-- å‘˜å·¥è–ªèµ„ç®¡ç†è¡¨
CREATE TABLE employees (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL,
    department VARCHAR(30) NOT NULL,
    position VARCHAR(30) NOT NULL,
    base_salary DECIMAL(10,2) NOT NULL,
    bonus DECIMAL(10,2) DEFAULT 0,
    commission_rate DECIMAL(4,3) DEFAULT 0,
    hire_date DATE NOT NULL,
    birth_date DATE NOT NULL,
    
    -- å¹´é¾„ä¸å…¥èŒæ—¥æœŸçº¦æŸ
    CONSTRAINT chk_hire_age 
        CHECK (DATEDIFF(hire_date, birth_date) >= 18*365),
    
    -- è–ªèµ„ç»“æ„çº¦æŸ
    CONSTRAINT chk_salary_structure 
        CHECK (
            (position = 'intern' AND base_salary <= 3000) OR
            (position = 'junior' AND base_salary BETWEEN 3000 AND 8000) OR
            (position = 'senior' AND base_salary BETWEEN 8000 AND 15000) OR
            (position = 'manager' AND base_salary BETWEEN 12000 AND 25000) OR
            (position = 'director' AND base_salary >= 20000)
        ),
    
    -- é”€å”®äººå‘˜ä½£é‡‘çº¦æŸ
    CONSTRAINT chk_commission_logic 
        CHECK (
            (department != 'sales' AND commission_rate = 0) OR
            (department = 'sales' AND commission_rate BETWEEN 0.01 AND 0.15)
        ),
    
    -- æ€»è–ªé…¬åˆç†æ€§çº¦æŸ
    CONSTRAINT chk_total_compensation 
        CHECK (base_salary + bonus <= base_salary * 3)
);

-- é¡¹ç›®é¢„ç®—ç®¡ç†è¡¨
CREATE TABLE project_budget (
    id INT PRIMARY KEY AUTO_INCREMENT,
    project_name VARCHAR(100) NOT NULL,
    start_date DATE NOT NULL,
    end_date DATE NOT NULL,
    total_budget DECIMAL(15,2) NOT NULL,
    used_budget DECIMAL(15,2) DEFAULT 0,
    remaining_budget DECIMAL(15,2) GENERATED ALWAYS AS (total_budget - used_budget) STORED,
    status ENUM('planning', 'active', 'completed', 'cancelled'),
    priority ENUM('low', 'medium', 'high', 'urgent'),
    
    -- é¡¹ç›®æ—¶é—´çº¦æŸ
    CONSTRAINT chk_project_duration 
        CHECK (end_date > start_date AND DATEDIFF(end_date, start_date) <= 1095), -- æœ€é•¿3å¹´
    
    -- é¢„ç®—ä½¿ç”¨çº¦æŸ
    CONSTRAINT chk_budget_usage 
        CHECK (used_budget >= 0 AND used_budget <= total_budget),
    
    -- çŠ¶æ€ä¸é¢„ç®—çº¦æŸ
    CONSTRAINT chk_status_budget 
        CHECK (
            (status = 'planning' AND used_budget = 0) OR
            (status IN ('active', 'completed') AND used_budget >= 0) OR
            (status = 'cancelled' AND used_budget <= total_budget * 0.1)
        ),
    
    -- ä¼˜å…ˆçº§ä¸é¢„ç®—çº¦æŸ
    CONSTRAINT chk_priority_budget 
        CHECK (
            (priority = 'low' AND total_budget <= 100000) OR
            (priority = 'medium' AND total_budget <= 500000) OR
            (priority = 'high' AND total_budget <= 2000000) OR
            (priority = 'urgent')  -- ç´§æ€¥é¡¹ç›®æ— é¢„ç®—é™åˆ¶
        )
);
```

---

## 3. ğŸ§® å¤åˆæ¡ä»¶çº¦æŸè®¾è®¡


### 3.1 å¤šå­—æ®µå…³è”çº¦æŸ


**ğŸ”— å­—æ®µé—´é€»è¾‘å…³ç³»**
```sql
-- ä¼šå‘˜ç­‰çº§ä¸æƒç›Šçº¦æŸ
CREATE TABLE membership (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    level ENUM('bronze', 'silver', 'gold', 'diamond') NOT NULL,
    points INT NOT NULL DEFAULT 0,
    annual_spending DECIMAL(12,2) NOT NULL DEFAULT 0,
    discount_rate DECIMAL(4,3) NOT NULL DEFAULT 0,
    free_shipping BOOLEAN NOT NULL DEFAULT FALSE,
    
    -- ç­‰çº§ä¸ç§¯åˆ†åŒ¹é…çº¦æŸ
    CONSTRAINT chk_level_points 
        CHECK (
            (level = 'bronze' AND points BETWEEN 0 AND 999) OR
            (level = 'silver' AND points BETWEEN 1000 AND 4999) OR
            (level = 'gold' AND points BETWEEN 5000 AND 19999) OR
            (level = 'diamond' AND points >= 20000)
        ),
    
    -- ç­‰çº§ä¸å¹´æ¶ˆè´¹åŒ¹é…çº¦æŸ
    CONSTRAINT chk_level_spending 
        CHECK (
            (level = 'bronze' AND annual_spending < 1000) OR
            (level = 'silver' AND annual_spending BETWEEN 1000 AND 4999) OR
            (level = 'gold' AND annual_spending BETWEEN 5000 AND 19999) OR
            (level = 'diamond' AND annual_spending >= 20000)
        ),
    
    -- ç­‰çº§ä¸æŠ˜æ‰£æƒç›Šçº¦æŸ
    CONSTRAINT chk_level_benefits 
        CHECK (
            (level = 'bronze' AND discount_rate = 0 AND free_shipping = FALSE) OR
            (level = 'silver' AND discount_rate = 0.05 AND free_shipping = FALSE) OR
            (level = 'gold' AND discount_rate = 0.1 AND free_shipping = TRUE) OR
            (level = 'diamond' AND discount_rate = 0.15 AND free_shipping = TRUE)
        )
);
```

### 3.2 æ¡ä»¶é€»è¾‘ç»„åˆçº¦æŸ


**ğŸ§© å¤æ‚æ¡ä»¶ç»„åˆ**
```sql
-- ä¿ƒé”€æ´»åŠ¨çº¦æŸ
CREATE TABLE promotions (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    type ENUM('percentage', 'fixed_amount', 'buy_x_get_y') NOT NULL,
    start_date DATETIME NOT NULL,
    end_date DATETIME NOT NULL,
    discount_percentage DECIMAL(5,2),
    discount_amount DECIMAL(10,2),
    min_purchase_amount DECIMAL(10,2),
    max_discount_amount DECIMAL(10,2),
    buy_quantity INT,
    get_quantity INT,
    is_active BOOLEAN DEFAULT TRUE,
    
    -- æ´»åŠ¨æ—¶é—´çº¦æŸ
    CONSTRAINT chk_promotion_period 
        CHECK (end_date > start_date),
    
    -- ä¿ƒé”€ç±»å‹ä¸å‚æ•°åŒ¹é…çº¦æŸ
    CONSTRAINT chk_promotion_params 
        CHECK (
            (type = 'percentage' AND 
             discount_percentage BETWEEN 0.01 AND 0.99 AND
             discount_amount IS NULL AND
             buy_quantity IS NULL AND get_quantity IS NULL) OR
             
            (type = 'fixed_amount' AND 
             discount_amount > 0 AND
             discount_percentage IS NULL AND
             buy_quantity IS NULL AND get_quantity IS NULL) OR
             
            (type = 'buy_x_get_y' AND 
             buy_quantity > 0 AND get_quantity > 0 AND
             discount_percentage IS NULL AND discount_amount IS NULL)
        ),
    
    -- æœ€ä½è´­ä¹°é‡‘é¢çº¦æŸ
    CONSTRAINT chk_min_purchase 
        CHECK (
            min_purchase_amount IS NULL OR 
            min_purchase_amount > 0
        ),
    
    -- æœ€å¤§æŠ˜æ‰£çº¦æŸ
    CONSTRAINT chk_max_discount 
        CHECK (
            (type != 'percentage') OR 
            (max_discount_amount IS NULL) OR 
            (max_discount_amount > 0 AND max_discount_amount <= min_purchase_amount)
        )
);

-- åº“å­˜ç®¡ç†çº¦æŸ
CREATE TABLE inventory (
    id INT PRIMARY KEY AUTO_INCREMENT,
    product_id INT NOT NULL,
    warehouse_id INT NOT NULL,
    current_stock INT NOT NULL DEFAULT 0,
    reserved_stock INT NOT NULL DEFAULT 0,
    available_stock INT GENERATED ALWAYS AS (current_stock - reserved_stock) STORED,
    min_stock_level INT NOT NULL DEFAULT 0,
    max_stock_level INT NOT NULL,
    reorder_point INT NOT NULL,
    safety_stock INT NOT NULL DEFAULT 0,
    
    -- åº“å­˜æ•°é‡é€»è¾‘çº¦æŸ
    CONSTRAINT chk_stock_logic 
        CHECK (
            current_stock >= 0 AND
            reserved_stock >= 0 AND
            reserved_stock <= current_stock AND
            available_stock >= 0
        ),
    
    -- åº“å­˜æ°´ä½çº¦æŸ
    CONSTRAINT chk_stock_levels 
        CHECK (
            min_stock_level >= 0 AND
            max_stock_level > min_stock_level AND
            reorder_point BETWEEN min_stock_level AND max_stock_level AND
            safety_stock >= 0 AND
            safety_stock <= min_stock_level
        ),
    
    -- å®‰å…¨åº“å­˜çº¦æŸ
    CONSTRAINT chk_safety_stock_logic 
        CHECK (
            (current_stock < reorder_point) OR 
            (current_stock >= reorder_point + safety_stock)
        )
);
```

### 2.3 æ—¶é—´ç›¸å…³çº¦æŸè®¾è®¡


**â° æ—¶é—´ä¸šåŠ¡é€»è¾‘çº¦æŸ**
```sql
-- æ´»åŠ¨æ’æœŸè¡¨
CREATE TABLE event_schedule (
    id INT PRIMARY KEY AUTO_INCREMENT,
    event_name VARCHAR(100) NOT NULL,
    event_type ENUM('conference', 'training', 'meeting', 'presentation'),
    start_time DATETIME NOT NULL,
    end_time DATETIME NOT NULL,
    preparation_days INT NOT NULL DEFAULT 7,
    room_id INT,
    organizer_id INT NOT NULL,
    max_participants INT DEFAULT 50,
    registration_deadline DATETIME,
    
    -- åŸºç¡€æ—¶é—´çº¦æŸ
    CONSTRAINT chk_event_duration 
        CHECK (end_time > start_time),
    
    -- æ´»åŠ¨æœ€çŸ­æ—¶é•¿çº¦æŸ
    CONSTRAINT chk_minimum_duration 
        CHECK (TIMESTAMPDIFF(MINUTE, start_time, end_time) >= 30),
    
    -- æ´»åŠ¨æœ€é•¿æ—¶é•¿çº¦æŸï¼ˆæ ¹æ®ç±»å‹ï¼‰
    CONSTRAINT chk_maximum_duration 
        CHECK (
            (event_type = 'meeting' AND TIMESTAMPDIFF(HOUR, start_time, end_time) <= 4) OR
            (event_type = 'training' AND TIMESTAMPDIFF(HOUR, start_time, end_time) <= 8) OR
            (event_type = 'conference' AND TIMESTAMPDIFF(DAY, start_time, end_time) <= 3) OR
            (event_type = 'presentation' AND TIMESTAMPDIFF(HOUR, start_time, end_time) <= 2)
        ),
    
    -- å‡†å¤‡æ—¶é—´çº¦æŸ
    CONSTRAINT chk_preparation_time 
        CHECK (
            start_time >= DATE_ADD(NOW(), INTERVAL preparation_days DAY)
        ),
    
    -- æŠ¥åæˆªæ­¢æ—¶é—´çº¦æŸ
    CONSTRAINT chk_registration_deadline 
        CHECK (
            registration_deadline IS NULL OR 
            (registration_deadline < start_time AND 
             registration_deadline >= DATE_ADD(NOW(), INTERVAL 1 DAY))
        ),
    
    -- å·¥ä½œæ—¶é—´çº¦æŸ
    CONSTRAINT chk_business_hours 
        CHECK (
            HOUR(start_time) BETWEEN 8 AND 18 AND
            HOUR(end_time) BETWEEN 9 AND 20
        )
);

-- è¯·å‡ç”³è¯·è¡¨
CREATE TABLE leave_requests (
    id INT PRIMARY KEY AUTO_INCREMENT,
    employee_id INT NOT NULL,
    leave_type ENUM('annual', 'sick', 'personal', 'maternity', 'emergency'),
    start_date DATE NOT NULL,
    end_date DATE NOT NULL,
    days_requested INT NOT NULL,
    reason TEXT,
    status ENUM('pending', 'approved', 'rejected') DEFAULT 'pending',
    applied_date DATETIME DEFAULT CURRENT_TIMESTAMP,
    
    -- è¯·å‡å¤©æ•°è®¡ç®—çº¦æŸ
    CONSTRAINT chk_leave_days_calculation 
        CHECK (days_requested = DATEDIFF(end_date, start_date) + 1),
    
    -- è¯·å‡æ—¶é—´åˆç†æ€§çº¦æŸ
    CONSTRAINT chk_leave_period 
        CHECK (
            end_date >= start_date AND
            days_requested > 0 AND
            days_requested <= 365
        ),
    
    -- æå‰ç”³è¯·çº¦æŸ
    CONSTRAINT chk_advance_application 
        CHECK (
            (leave_type = 'emergency') OR 
            (start_date >= DATE_ADD(applied_date, INTERVAL 1 DAY))
        ),
    
    -- è¯·å‡ç±»å‹ä¸å¤©æ•°çº¦æŸ
    CONSTRAINT chk_leave_type_duration 
        CHECK (
            (leave_type = 'sick' AND days_requested <= 30) OR
            (leave_type = 'annual' AND days_requested <= 21) OR
            (leave_type = 'personal' AND days_requested <= 5) OR
            (leave_type = 'emergency' AND days_requested <= 3) OR
            (leave_type = 'maternity' AND days_requested <= 120)
        )
);
```

---

## 4. ğŸ”— è·¨è¡¨çº¦æŸå®ç°ç­–ç•¥


### 4.1 ä¸ºä»€ä¹ˆéœ€è¦è·¨è¡¨çº¦æŸ


**ğŸ¯ è·¨è¡¨çº¦æŸçš„åº”ç”¨åœºæ™¯**
```
æ•°æ®ä¸€è‡´æ€§éœ€æ±‚ï¼š
â€¢ è®¢å•æ€»é¢ = è®¢å•æ˜ç»†é‡‘é¢æ±‡æ€»
â€¢ åº“å­˜æ•°é‡ >= å·²å”®æ•°é‡
â€¢ å‘˜å·¥å·¥èµ„æ€»é¢ <= éƒ¨é—¨é¢„ç®—

ä¸šåŠ¡è§„åˆ™é™åˆ¶ï¼š
â€¢ å®¢æˆ·ä¿¡ç”¨é¢åº¦ >= æœªç»“ç®—è®¢å•æ€»é¢
â€¢ è¯¾ç¨‹å®¹é‡ >= å·²æŠ¥åå­¦ç”Ÿæ•°
â€¢ é¡¹ç›®æˆå‘˜æ•° <= é¡¹ç›®é¢„ç®—æ”¯æŒçš„äººæ•°

çŠ¶æ€åŒæ­¥è¦æ±‚ï¼š
â€¢ è®¢å•çŠ¶æ€ä¸æ”¯ä»˜çŠ¶æ€ä¸€è‡´
â€¢ ç”¨æˆ·çŠ¶æ€ä¸æƒé™çŠ¶æ€åŒ¹é…
```

### 4.2 è§¦å‘å™¨å®ç°è·¨è¡¨çº¦æŸ


**ğŸ”§ è®¢å•ä¸åº“å­˜ä¸€è‡´æ€§çº¦æŸ**
```sql
-- è®¢å•æ˜ç»†è¡¨
CREATE TABLE order_items (
    id INT PRIMARY KEY AUTO_INCREMENT,
    order_id INT NOT NULL,
    product_id INT NOT NULL,
    quantity INT NOT NULL,
    unit_price DECIMAL(10,2) NOT NULL,
    total_price DECIMAL(12,2) GENERATED ALWAYS AS (quantity * unit_price) STORED,
    
    CONSTRAINT chk_order_item_quantity CHECK (quantity > 0),
    CONSTRAINT chk_order_item_price CHECK (unit_price > 0)
);

-- è·¨è¡¨åº“å­˜çº¦æŸè§¦å‘å™¨
DELIMITER //

CREATE TRIGGER trg_check_stock_before_order
    BEFORE INSERT ON order_items
    FOR EACH ROW
BEGIN
    DECLARE available_stock INT DEFAULT 0;
    DECLARE error_message VARCHAR(255);
    
    -- æŸ¥è¯¢å¯ç”¨åº“å­˜
    SELECT COALESCE(SUM(current_stock - reserved_stock), 0) 
    INTO available_stock
    FROM inventory 
    WHERE product_id = NEW.product_id;
    
    -- æ£€æŸ¥åº“å­˜æ˜¯å¦å……è¶³
    IF available_stock < NEW.quantity THEN
        SET error_message = CONCAT(
            'åº“å­˜ä¸è¶³ï¼šå•†å“ID ', NEW.product_id, 
            ' å¯ç”¨åº“å­˜ ', available_stock, 
            ' å°äºè®¢è´­æ•°é‡ ', NEW.quantity
        );
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = error_message;
    END IF;
    
    -- é¢„ç•™åº“å­˜
    UPDATE inventory 
    SET reserved_stock = reserved_stock + NEW.quantity
    WHERE product_id = NEW.product_id
    LIMIT 1;
END//

-- è®¢å•å–æ¶ˆé‡Šæ”¾åº“å­˜è§¦å‘å™¨
CREATE TRIGGER trg_release_stock_on_cancel
    AFTER UPDATE ON orders
    FOR EACH ROW
BEGIN
    -- å¦‚æœè®¢å•çŠ¶æ€å˜ä¸ºå–æ¶ˆ
    IF OLD.status != 'cancelled' AND NEW.status = 'cancelled' THEN
        -- é‡Šæ”¾æ‰€æœ‰ç›¸å…³å•†å“çš„é¢„ç•™åº“å­˜
        UPDATE inventory i
        INNER JOIN order_items oi ON i.product_id = oi.product_id
        SET i.reserved_stock = i.reserved_stock - oi.quantity
        WHERE oi.order_id = NEW.id;
    END IF;
END//

DELIMITER ;
```

### 4.3 çŠ¶æ€æœºçº¦æŸå®ç°


**ğŸ”„ è®¢å•çŠ¶æ€æµè½¬çº¦æŸ**
```sql
-- è®¢å•çŠ¶æ€å†å²è¡¨
CREATE TABLE order_status_history (
    id INT PRIMARY KEY AUTO_INCREMENT,
    order_id INT NOT NULL,
    old_status ENUM('pending', 'confirmed', 'paid', 'shipped', 'delivered', 'cancelled'),
    new_status ENUM('pending', 'confirmed', 'paid', 'shipped', 'delivered', 'cancelled') NOT NULL,
    changed_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    changed_by INT NOT NULL,
    reason VARCHAR(500),
    
    -- çŠ¶æ€å˜æ›´è§„åˆ™çº¦æŸ
    CONSTRAINT chk_valid_status_transition 
        CHECK (
            -- å…è®¸çš„çŠ¶æ€è½¬æ¢è·¯å¾„
            (old_status IS NULL AND new_status = 'pending') OR                    -- åˆå§‹åˆ›å»º
            (old_status = 'pending' AND new_status IN ('confirmed', 'cancelled')) OR
            (old_status = 'confirmed' AND new_status IN ('paid', 'cancelled')) OR
            (old_status = 'paid' AND new_status IN ('shipped', 'cancelled')) OR
            (old_status = 'shipped' AND new_status IN ('delivered', 'cancelled')) OR
            (old_status = 'delivered' AND new_status = 'delivered') OR            -- å…è®¸é‡å¤ç¡®è®¤
            (new_status = 'cancelled')                                            -- ä»»ä½•çŠ¶æ€éƒ½å¯å–æ¶ˆ
        )
);

-- çŠ¶æ€è½¬æ¢è§¦å‘å™¨
DELIMITER //

CREATE TRIGGER trg_order_status_change
    AFTER UPDATE ON orders
    FOR EACH ROW
BEGIN
    -- å¦‚æœçŠ¶æ€å‘ç”Ÿå˜åŒ–
    IF OLD.status != NEW.status THEN
        -- è®°å½•çŠ¶æ€å˜æ›´å†å²
        INSERT INTO order_status_history (order_id, old_status, new_status, changed_by, reason)
        VALUES (NEW.id, OLD.status, NEW.status, @user_id, @change_reason);
        
        -- çŠ¶æ€å˜æ›´ä¸šåŠ¡é€»è¾‘æ£€æŸ¥
        CASE NEW.status
            WHEN 'confirmed' THEN
                -- ç¡®è®¤è®¢å•æ—¶æ£€æŸ¥åº“å­˜
                CALL check_order_stock_availability(NEW.id);
                
            WHEN 'paid' THEN
                -- æ”¯ä»˜å®Œæˆæ—¶æ‰£å‡åº“å­˜
                CALL deduct_inventory_stock(NEW.id);
                
            WHEN 'shipped' THEN
                -- å‘è´§æ—¶æ›´æ–°ç‰©æµä¿¡æ¯
                CALL update_shipping_info(NEW.id);
                
            WHEN 'cancelled' THEN
                -- å–æ¶ˆæ—¶é‡Šæ”¾åº“å­˜
                CALL release_reserved_stock(NEW.id);
                
            ELSE BEGIN END;
        END CASE;
    END IF;
END//

DELIMITER ;
```

### 4.4 è´¢åŠ¡æ•°æ®ä¸€è‡´æ€§çº¦æŸ


**ğŸ’° è´¢åŠ¡çº¦æŸå®ç°**
```sql
-- è´¢åŠ¡è´¦å•è¡¨
CREATE TABLE financial_records (
    id INT PRIMARY KEY AUTO_INCREMENT,
    record_type ENUM('income', 'expense', 'transfer') NOT NULL,
    from_account_id INT,
    to_account_id INT,
    amount DECIMAL(15,2) NOT NULL,
    transaction_date DATETIME DEFAULT CURRENT_TIMESTAMP,
    description VARCHAR(500),
    reference_id INT,
    reference_type ENUM('order', 'refund', 'salary', 'other'),
    
    -- é‡‘é¢åˆç†æ€§çº¦æŸ
    CONSTRAINT chk_amount_positive 
        CHECK (amount > 0),
    
    -- è½¬è´¦çº¦æŸ
    CONSTRAINT chk_transfer_accounts 
        CHECK (
            (record_type != 'transfer') OR 
            (from_account_id IS NOT NULL AND 
             to_account_id IS NOT NULL AND 
             from_account_id != to_account_id)
        ),
    
    -- æ”¶å…¥æ”¯å‡ºè´¦æˆ·çº¦æŸ
    CONSTRAINT chk_account_logic 
        CHECK (
            (record_type = 'income' AND to_account_id IS NOT NULL AND from_account_id IS NULL) OR
            (record_type = 'expense' AND from_account_id IS NOT NULL AND to_account_id IS NULL) OR
            (record_type = 'transfer' AND from_account_id IS NOT NULL AND to_account_id IS NOT NULL)
        )
);

-- è´¦æˆ·ä½™é¢çº¦æŸè§¦å‘å™¨
DELIMITER //

CREATE TRIGGER trg_check_account_balance
    BEFORE INSERT ON financial_records
    FOR EACH ROW
BEGIN
    DECLARE current_balance DECIMAL(15,2) DEFAULT 0;
    DECLARE error_message VARCHAR(255);
    
    -- å¦‚æœæ˜¯æ”¯å‡ºæˆ–è½¬å‡ºï¼Œæ£€æŸ¥è´¦æˆ·ä½™é¢
    IF NEW.record_type IN ('expense', 'transfer') AND NEW.from_account_id IS NOT NULL THEN
        -- è®¡ç®—å½“å‰è´¦æˆ·ä½™é¢
        SELECT COALESCE(
            (SELECT SUM(amount) FROM financial_records WHERE to_account_id = NEW.from_account_id) -
            (SELECT SUM(amount) FROM financial_records WHERE from_account_id = NEW.from_account_id),
            0
        ) INTO current_balance;
        
        -- æ£€æŸ¥ä½™é¢æ˜¯å¦å……è¶³
        IF current_balance < NEW.amount THEN
            SET error_message = CONCAT(
                'è´¦æˆ·ä½™é¢ä¸è¶³ï¼šè´¦æˆ·ID ', NEW.from_account_id,
                ' å½“å‰ä½™é¢ ', current_balance,
                ' å°äºæ”¯å‡ºé‡‘é¢ ', NEW.amount
            );
            SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = error_message;
        END IF;
    END IF;
END//

DELIMITER ;
```

---

## 5. ğŸ”„ è§¦å‘å™¨ä¸å­˜å‚¨è¿‡ç¨‹çº¦æŸ


### 5.1 è§¦å‘å™¨çº¦æŸé…åˆç­–ç•¥


**ğŸ¯ è§¦å‘å™¨çº¦æŸçš„é€‚ç”¨åœºæ™¯**
```
å¤æ‚ä¸šåŠ¡é€»è¾‘ï¼š
â€¢ CHECKçº¦æŸæ— æ³•è¡¨è¾¾çš„å¤æ‚æ¡ä»¶
â€¢ éœ€è¦æŸ¥è¯¢å…¶ä»–è¡¨çš„çº¦æŸ
â€¢ åŠ¨æ€è®¡ç®—çš„çº¦æŸæ¡ä»¶

æ•°æ®åŒæ­¥éœ€æ±‚ï¼š
â€¢ å†—ä½™å­—æ®µçš„è‡ªåŠ¨ç»´æŠ¤
â€¢ æ±‡æ€»æ•°æ®çš„å®æ—¶æ›´æ–°
â€¢ å®¡è®¡æ—¥å¿—çš„è‡ªåŠ¨è®°å½•

ä¸šåŠ¡è§„åˆ™æ‰§è¡Œï¼š
â€¢ çŠ¶æ€æœºè½¬æ¢é€»è¾‘
â€¢ æƒé™éªŒè¯é€»è¾‘
â€¢ ä¸šåŠ¡æµç¨‹æ§åˆ¶
```

### 5.2 å¤æ‚çº¦æŸå®ç°æ¡ˆä¾‹


**ğŸ¦ é“¶è¡Œè´¦æˆ·çº¦æŸç³»ç»Ÿ**
```sql
-- é“¶è¡Œè´¦æˆ·è¡¨
CREATE TABLE bank_accounts (
    id INT PRIMARY KEY AUTO_INCREMENT,
    account_number VARCHAR(20) UNIQUE NOT NULL,
    account_type ENUM('savings', 'checking', 'credit', 'loan') NOT NULL,
    customer_id INT NOT NULL,
    balance DECIMAL(15,2) NOT NULL DEFAULT 0,
    credit_limit DECIMAL(15,2) DEFAULT 0,
    daily_limit DECIMAL(12,2) DEFAULT 5000,
    monthly_limit DECIMAL(15,2) DEFAULT 50000,
    status ENUM('active', 'frozen', 'closed') DEFAULT 'active',
    opened_date DATE NOT NULL,
    
    -- åŸºç¡€çº¦æŸ
    CONSTRAINT chk_account_number_format 
        CHECK (account_number REGEXP '^[0-9]{16,20}$'),
    
    -- è´¦æˆ·ç±»å‹ç›¸å…³çº¦æŸ
    CONSTRAINT chk_account_type_rules 
        CHECK (
            (account_type = 'credit' AND credit_limit > 0 AND balance <= credit_limit) OR
            (account_type = 'loan' AND balance <= 0) OR
            (account_type IN ('savings', 'checking') AND credit_limit = 0)
        )
);

-- äº¤æ˜“è®°å½•è¡¨
CREATE TABLE transactions (
    id INT PRIMARY KEY AUTO_INCREMENT,
    from_account_id INT,
    to_account_id INT,
    transaction_type ENUM('deposit', 'withdrawal', 'transfer', 'payment') NOT NULL,
    amount DECIMAL(15,2) NOT NULL,
    transaction_date DATETIME DEFAULT CURRENT_TIMESTAMP,
    description VARCHAR(500),
    status ENUM('pending', 'completed', 'failed') DEFAULT 'pending',
    
    CONSTRAINT chk_transaction_amount CHECK (amount > 0),
    CONSTRAINT chk_transaction_accounts 
        CHECK (
            (transaction_type = 'deposit' AND from_account_id IS NULL AND to_account_id IS NOT NULL) OR
            (transaction_type = 'withdrawal' AND from_account_id IS NOT NULL AND to_account_id IS NULL) OR
            (transaction_type IN ('transfer', 'payment') AND from_account_id IS NOT NULL AND to_account_id IS NOT NULL)
        )
);

-- å¤æ‚ä¸šåŠ¡çº¦æŸå­˜å‚¨è¿‡ç¨‹
DELIMITER //

-- æ£€æŸ¥æ—¥äº¤æ˜“é™é¢
CREATE PROCEDURE check_daily_limit(
    IN p_account_id INT,
    IN p_amount DECIMAL(15,2),
    IN p_transaction_type VARCHAR(20)
)
BEGIN
    DECLARE daily_used DECIMAL(15,2) DEFAULT 0;
    DECLARE daily_limit DECIMAL(12,2) DEFAULT 0;
    DECLARE error_message VARCHAR(255);
    
    -- è·å–è´¦æˆ·æ—¥é™é¢
    SELECT daily_limit INTO daily_limit
    FROM bank_accounts
    WHERE id = p_account_id;
    
    -- è®¡ç®—ä»Šæ—¥å·²ä½¿ç”¨é¢åº¦
    SELECT COALESCE(SUM(amount), 0) INTO daily_used
    FROM transactions
    WHERE from_account_id = p_account_id
      AND DATE(transaction_date) = CURDATE()
      AND status = 'completed'
      AND transaction_type IN ('withdrawal', 'transfer', 'payment');
    
    -- æ£€æŸ¥æ˜¯å¦è¶…é™
    IF daily_used + p_amount > daily_limit THEN
        SET error_message = CONCAT(
            'è¶…å‡ºæ—¥äº¤æ˜“é™é¢ï¼šä»Šæ—¥å·²ç”¨ ', daily_used,
            ' æœ¬æ¬¡äº¤æ˜“ ', p_amount,
            ' æ—¥é™é¢ ', daily_limit
        );
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = error_message;
    END IF;
END//

-- æ£€æŸ¥æœˆäº¤æ˜“é™é¢
CREATE PROCEDURE check_monthly_limit(
    IN p_account_id INT,
    IN p_amount DECIMAL(15,2)
)
BEGIN
    DECLARE monthly_used DECIMAL(15,2) DEFAULT 0;
    DECLARE monthly_limit DECIMAL(15,2) DEFAULT 0;
    DECLARE error_message VARCHAR(255);
    
    -- è·å–è´¦æˆ·æœˆé™é¢
    SELECT monthly_limit INTO monthly_limit
    FROM bank_accounts
    WHERE id = p_account_id;
    
    -- è®¡ç®—æœ¬æœˆå·²ä½¿ç”¨é¢åº¦
    SELECT COALESCE(SUM(amount), 0) INTO monthly_used
    FROM transactions
    WHERE from_account_id = p_account_id
      AND YEAR(transaction_date) = YEAR(CURDATE())
      AND MONTH(transaction_date) = MONTH(CURDATE())
      AND status = 'completed'
      AND transaction_type IN ('withdrawal', 'transfer', 'payment');
    
    -- æ£€æŸ¥æ˜¯å¦è¶…é™
    IF monthly_used + p_amount > monthly_limit THEN
        SET error_message = CONCAT(
            'è¶…å‡ºæœˆäº¤æ˜“é™é¢ï¼šæœ¬æœˆå·²ç”¨ ', monthly_used,
            ' æœ¬æ¬¡äº¤æ˜“ ', p_amount,
            ' æœˆé™é¢ ', monthly_limit
        );
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = error_message;
    END IF;
END//

-- ç»¼åˆäº¤æ˜“çº¦æŸè§¦å‘å™¨
CREATE TRIGGER trg_transaction_constraints
    BEFORE INSERT ON transactions
    FOR EACH ROW
BEGIN
    DECLARE from_balance DECIMAL(15,2);
    DECLARE from_status VARCHAR(20);
    DECLARE to_status VARCHAR(20);
    
    -- æ£€æŸ¥è½¬å‡ºè´¦æˆ·
    IF NEW.from_account_id IS NOT NULL THEN
        SELECT balance, status INTO from_balance, from_status
        FROM bank_accounts
        WHERE id = NEW.from_account_id;
        
        -- è´¦æˆ·çŠ¶æ€æ£€æŸ¥
        IF from_status != 'active' THEN
            SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'è½¬å‡ºè´¦æˆ·æœªæ¿€æ´»';
        END IF;
        
        -- ä½™é¢æ£€æŸ¥
        IF from_balance < NEW.amount THEN
            SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'è´¦æˆ·ä½™é¢ä¸è¶³';
        END IF;
        
        -- è°ƒç”¨é™é¢æ£€æŸ¥
        CALL check_daily_limit(NEW.from_account_id, NEW.amount, NEW.transaction_type);
        CALL check_monthly_limit(NEW.from_account_id, NEW.amount);
    END IF;
    
    -- æ£€æŸ¥è½¬å…¥è´¦æˆ·çŠ¶æ€
    IF NEW.to_account_id IS NOT NULL THEN
        SELECT status INTO to_status
        FROM bank_accounts
        WHERE id = NEW.to_account_id;
        
        IF to_status = 'closed' THEN
            SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'è½¬å…¥è´¦æˆ·å·²å…³é—­';
        END IF;
    END IF;
END//

DELIMITER ;
```

### 5.3 å­˜å‚¨è¿‡ç¨‹çº¦æŸå®ç°


**ğŸ”§ ä¸šåŠ¡é€»è¾‘éªŒè¯å­˜å‚¨è¿‡ç¨‹**
```sql
-- å‘˜å·¥è–ªèµ„è°ƒæ•´çº¦æŸæ£€æŸ¥
DELIMITER //

CREATE PROCEDURE validate_salary_adjustment(
    IN p_employee_id INT,
    IN p_new_salary DECIMAL(10,2),
    IN p_adjustment_reason VARCHAR(100)
)
BEGIN
    DECLARE current_salary DECIMAL(10,2);
    DECLARE department VARCHAR(50);
    DECLARE position VARCHAR(50);
    DECLARE dept_budget DECIMAL(15,2);
    DECLARE dept_used_budget DECIMAL(15,2);
    DECLARE adjustment_percentage DECIMAL(5,2);
    DECLARE error_message VARCHAR(500);
    
    -- è·å–å‘˜å·¥å½“å‰ä¿¡æ¯
    SELECT base_salary, department, position 
    INTO current_salary, department, position
    FROM employees 
    WHERE id = p_employee_id;
    
    -- è®¡ç®—è°ƒè–ªå¹…åº¦
    SET adjustment_percentage = (p_new_salary - current_salary) / current_salary * 100;
    
    -- è°ƒè–ªå¹…åº¦çº¦æŸæ£€æŸ¥
    CASE 
        WHEN adjustment_percentage > 50 THEN
            SET error_message = CONCAT('è°ƒè–ªå¹…åº¦è¿‡å¤§ï¼š', adjustment_percentage, '%ï¼Œè¶…å‡º50%é™åˆ¶');
            SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = error_message;
            
        WHEN adjustment_percentage < -20 THEN
            SET error_message = CONCAT('é™è–ªå¹…åº¦è¿‡å¤§ï¼š', adjustment_percentage, '%ï¼Œè¶…å‡º20%é™åˆ¶');
            SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = error_message;
            
        ELSE BEGIN END;
    END CASE;
    
    -- éƒ¨é—¨é¢„ç®—çº¦æŸæ£€æŸ¥
    SELECT budget, used_budget INTO dept_budget, dept_used_budget
    FROM department_budgets 
    WHERE department_name = department 
      AND budget_year = YEAR(CURDATE());
    
    IF dept_used_budget + (p_new_salary - current_salary) * 12 > dept_budget THEN
        SET error_message = CONCAT(
            'è¶…å‡ºéƒ¨é—¨é¢„ç®—ï¼šè°ƒè–ªåå¹´è–ªèµ„æ€»é¢å°†è¶…å‡º ',
            department, ' éƒ¨é—¨é¢„ç®— ', dept_budget
        );
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = error_message;
    END IF;
    
    -- èŒä½è–ªèµ„èŒƒå›´çº¦æŸ
    IF NOT salary_within_position_range(position, p_new_salary) THEN
        SET error_message = CONCAT(
            'è–ªèµ„è¶…å‡ºèŒä½èŒƒå›´ï¼š', position, ' è–ªèµ„èŒƒå›´ä¸ç¬¦'
        );
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = error_message;
    END IF;
    
END//

-- è¾…åŠ©å‡½æ•°ï¼šæ£€æŸ¥è–ªèµ„æ˜¯å¦åœ¨èŒä½èŒƒå›´å†…
CREATE FUNCTION salary_within_position_range(
    p_position VARCHAR(50),
    p_salary DECIMAL(10,2)
) RETURNS BOOLEAN
READS SQL DATA
DETERMINISTIC
BEGIN
    DECLARE min_salary DECIMAL(10,2);
    DECLARE max_salary DECIMAL(10,2);
    
    -- è·å–èŒä½è–ªèµ„èŒƒå›´
    SELECT salary_min, salary_max INTO min_salary, max_salary
    FROM position_salary_ranges
    WHERE position_name = p_position;
    
    RETURN p_salary BETWEEN COALESCE(min_salary, 0) AND COALESCE(max_salary, 999999);
END//

DELIMITER ;
```

---

## 6. ğŸ›ï¸ åŠ¨æ€çº¦æŸç®¡ç†æœºåˆ¶


### 6.1 ä¸ºä»€ä¹ˆéœ€è¦åŠ¨æ€çº¦æŸ


**ğŸ”„ ä¸šåŠ¡å˜åŒ–å¸¦æ¥çš„æŒ‘æˆ˜**
```
é™æ€çº¦æŸçš„é—®é¢˜ï¼š
â€¢ ä¸šåŠ¡è§„åˆ™å¯èƒ½éšæ—¶å˜åŒ–
â€¢ ç¡¬ç¼–ç çº¦æŸéš¾ä»¥ç»´æŠ¤
â€¢ ä¸åŒå®¢æˆ·å¯èƒ½æœ‰ä¸åŒè§„åˆ™
â€¢ å­£èŠ‚æ€§æˆ–æ—¶æ®µæ€§è§„åˆ™å˜åŒ–

åŠ¨æ€çº¦æŸçš„ä¼˜åŠ¿ï¼š
â€¢ è§„åˆ™å¯é…ç½®åŒ–ç®¡ç†
â€¢ æ”¯æŒå¤šç§Ÿæˆ·ä¸åŒè§„åˆ™
â€¢ è¿è¡Œæ—¶è§„åˆ™æ›´æ–°
â€¢ è§„åˆ™ç‰ˆæœ¬ç®¡ç†
```

### 6.2 è§„åˆ™é…ç½®è¡¨è®¾è®¡


**ğŸ“‹ åŠ¨æ€è§„åˆ™ç®¡ç†è¡¨**
```sql
-- ä¸šåŠ¡è§„åˆ™é…ç½®è¡¨
CREATE TABLE business_rules (
    id INT PRIMARY KEY AUTO_INCREMENT,
    rule_name VARCHAR(100) NOT NULL,
    rule_type ENUM('validation', 'calculation', 'workflow') NOT NULL,
    target_table VARCHAR(50) NOT NULL,
    target_columns JSON,
    condition_expression TEXT NOT NULL,
    error_message VARCHAR(500),
    severity ENUM('error', 'warning', 'info') DEFAULT 'error',
    is_active BOOLEAN DEFAULT TRUE,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    created_by INT NOT NULL,
    
    -- è§„åˆ™åç§°å”¯ä¸€çº¦æŸ
    CONSTRAINT uk_rule_name UNIQUE (rule_name),
    
    -- JSONæ ¼å¼çº¦æŸï¼ˆMySQL 5.7+ï¼‰
    CONSTRAINT chk_target_columns_json 
        CHECK (JSON_VALID(target_columns))
);

-- è§„åˆ™å‚æ•°é…ç½®è¡¨
CREATE TABLE rule_parameters (
    id INT PRIMARY KEY AUTO_INCREMENT,
    rule_id INT NOT NULL,
    parameter_name VARCHAR(50) NOT NULL,
    parameter_value VARCHAR(200) NOT NULL,
    parameter_type ENUM('string', 'number', 'boolean', 'date') NOT NULL,
    description VARCHAR(200),
    
    FOREIGN KEY (rule_id) REFERENCES business_rules(id) ON DELETE CASCADE,
    CONSTRAINT uk_rule_parameter UNIQUE (rule_id, parameter_name)
);

-- æ’å…¥ç¤ºä¾‹è§„åˆ™
INSERT INTO business_rules (rule_name, rule_type, target_table, target_columns, condition_expression, error_message, created_by) VALUES
('vip_discount_limit', 'validation', 'orders', '["customer_type", "discount_rate"]', 
 'IF(@customer_type = "VIP", @discount_rate <= 0.3, true)', 
 'VIPå®¢æˆ·æŠ˜æ‰£ä¸èƒ½è¶…è¿‡30%', 1),

('order_amount_limit', 'validation', 'orders', '["total_amount", "customer_level"]',
 'IF(@customer_level = "bronze", @total_amount <= 1000, IF(@customer_level = "silver", @total_amount <= 5000, true))',
 'è®¢å•é‡‘é¢è¶…å‡ºå®¢æˆ·ç­‰çº§é™åˆ¶', 1);

-- è§„åˆ™å‚æ•°ç¤ºä¾‹
INSERT INTO rule_parameters (rule_id, parameter_name, parameter_value, parameter_type, description) VALUES
(1, 'max_vip_discount', '0.30', 'number', 'VIPå®¢æˆ·æœ€å¤§æŠ˜æ‰£ç‡'),
(2, 'bronze_limit', '1000', 'number', 'é“œç‰Œå®¢æˆ·å•æ¬¡è®¢å•é™é¢'),
(2, 'silver_limit', '5000', 'number', 'é“¶ç‰Œå®¢æˆ·å•æ¬¡è®¢å•é™é¢');
```

### 6.3 åŠ¨æ€çº¦æŸæ‰§è¡Œå¼•æ“


**âš™ï¸ è§„åˆ™æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹**
```sql
DELIMITER //

-- åŠ¨æ€è§„åˆ™éªŒè¯å¼•æ“
CREATE PROCEDURE validate_business_rules(
    IN p_table_name VARCHAR(50),
    IN p_operation VARCHAR(10),  -- INSERT, UPDATE, DELETE
    IN p_data JSON
)
BEGIN
    DECLARE done INT DEFAULT FALSE;
    DECLARE rule_condition TEXT;
    DECLARE error_msg VARCHAR(500);
    DECLARE rule_severity VARCHAR(10);
    
    -- æ¸¸æ ‡ï¼šè·å–é€‚ç”¨çš„ä¸šåŠ¡è§„åˆ™
    DECLARE rule_cursor CURSOR FOR
        SELECT condition_expression, error_message, severity
        FROM business_rules
        WHERE target_table = p_table_name
          AND is_active = TRUE
        ORDER BY severity DESC;
    
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;
    
    OPEN rule_cursor;
    
    rule_loop: LOOP
        FETCH rule_cursor INTO rule_condition, error_msg, rule_severity;
        
        IF done THEN
            LEAVE rule_loop;
        END IF;
        
        -- æ‰§è¡Œè§„åˆ™éªŒè¯
        IF NOT evaluate_rule_condition(rule_condition, p_data) THEN
            IF rule_severity = 'error' THEN
                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = error_msg;
            ELSEIF rule_severity = 'warning' THEN
                -- è®°å½•è­¦å‘Šæ—¥å¿—
                CALL log_rule_warning(p_table_name, rule_condition, error_msg, p_data);
            END IF;
        END IF;
        
    END LOOP;
    
    CLOSE rule_cursor;
END//

-- è§„åˆ™æ¡ä»¶æ±‚å€¼å‡½æ•°
CREATE FUNCTION evaluate_rule_condition(
    p_condition TEXT,
    p_data JSON
) RETURNS BOOLEAN
READS SQL DATA
DETERMINISTIC
BEGIN
    DECLARE result BOOLEAN DEFAULT TRUE;
    DECLARE sql_statement TEXT;
    
    -- æ„å»ºåŠ¨æ€SQLæ¥æ‰§è¡Œè§„åˆ™
    SET sql_statement = CONCAT(
        'SELECT CASE WHEN (', 
        replace_json_variables(p_condition, p_data),
        ') THEN 1 ELSE 0 END INTO @rule_result'
    );
    
    -- æ‰§è¡ŒåŠ¨æ€SQLï¼ˆå®é™…å®ç°ä¸­éœ€è¦æ›´å®‰å…¨çš„æ–¹å¼ï¼‰
    SET @sql = sql_statement;
    PREPARE stmt FROM @sql;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
    
    RETURN @rule_result;
END//

-- JSONå˜é‡æ›¿æ¢å‡½æ•°ï¼ˆç®€åŒ–ç‰ˆï¼‰
CREATE FUNCTION replace_json_variables(
    p_expression TEXT,
    p_data JSON
) RETURNS TEXT
DETERMINISTIC
BEGIN
    DECLARE result TEXT DEFAULT p_expression;
    
    -- ç®€åŒ–çš„å˜é‡æ›¿æ¢é€»è¾‘
    -- å®é™…å®ç°éœ€è¦æ›´å¤æ‚çš„è§£æå™¨
    SET result = REPLACE(result, '@customer_type', QUOTE(JSON_UNQUOTE(JSON_EXTRACT(p_data, '$.customer_type'))));
    SET result = REPLACE(result, '@discount_rate', JSON_UNQUOTE(JSON_EXTRACT(p_data, '$.discount_rate')));
    SET result = REPLACE(result, '@total_amount', JSON_UNQUOTE(JSON_EXTRACT(p_data, '$.total_amount')));
    
    RETURN result;
END//

DELIMITER ;
```

### 6.4 è§„åˆ™å¼•æ“é›†æˆ


**ğŸ”§ è§„åˆ™å¼•æ“æ¶æ„è®¾è®¡**
```
è§„åˆ™å¼•æ“æ¶æ„ï¼š

ä¸šåŠ¡åº”ç”¨
    â†“
è§„åˆ™å¼•æ“API
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è§„åˆ™å¼•æ“æ ¸å¿ƒ                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ è§„åˆ™è§£æå™¨   â”‚ â”‚ è§„åˆ™æ‰§è¡Œå™¨   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ è§„åˆ™ç¼“å­˜    â”‚ â”‚ è§„åˆ™å®¡è®¡    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
MySQLæ•°æ®åº“
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è§„åˆ™é…ç½®å­˜å‚¨                    â”‚
â”‚ â€¢ business_rules               â”‚
â”‚ â€¢ rule_parameters              â”‚ 
â”‚ â€¢ rule_execution_log           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ’» Javaè§„åˆ™å¼•æ“å®ç°ç¤ºä¾‹**
```java
@Component
public class BusinessRuleEngine {
    
    @Autowired
    private BusinessRuleRepository ruleRepository;
    
    // éªŒè¯ä¸šåŠ¡è§„åˆ™
    public void validateBusinessRules(String tableName, String operation, Map<String, Object> data) {
        List<BusinessRule> rules = ruleRepository.getActiveRules(tableName);
        
        for (BusinessRule rule : rules) {
            try {
                boolean isValid = evaluateRule(rule, data);
                
                if (!isValid) {
                    switch (rule.getSeverity()) {
                        case ERROR:
                            throw new BusinessRuleViolationException(rule.getErrorMessage());
                        case WARNING:
                            logWarning(rule, data);
                            break;
                        case INFO:
                            logInfo(rule, data);
                            break;
                    }
                }
                
                // è®°å½•è§„åˆ™æ‰§è¡Œæ—¥å¿—
                logRuleExecution(rule, data, isValid);
                
            } catch (Exception e) {
                logRuleError(rule, data, e);
                throw new RuleExecutionException("è§„åˆ™æ‰§è¡Œå¤±è´¥: " + rule.getRuleName(), e);
            }
        }
    }
    
    // è§„åˆ™æ±‚å€¼
    private boolean evaluateRule(BusinessRule rule, Map<String, Object> data) {
        // ä½¿ç”¨è¡¨è¾¾å¼è§£æå™¨ï¼ˆå¦‚SpELã€OGNLç­‰ï¼‰
        String expression = rule.getConditionExpression();
        
        // æ›¿æ¢è¡¨è¾¾å¼ä¸­çš„å˜é‡
        for (Map.Entry<String, Object> entry : data.entrySet()) {
            String placeholder = "@" + entry.getKey();
            String value = formatValue(entry.getValue());
            expression = expression.replace(placeholder, value);
        }
        
        // æ‰§è¡Œè¡¨è¾¾å¼æ±‚å€¼ï¼ˆç®€åŒ–ç‰ˆï¼‰
        return evaluateExpression(expression);
    }
    
    // æ ¼å¼åŒ–å€¼
    private String formatValue(Object value) {
        if (value instanceof String) {
            return "'" + value.toString().replace("'", "''") + "'";
        } else if (value instanceof Number) {
            return value.toString();
        } else if (value instanceof Boolean) {
            return value.toString().toUpperCase();
        } else {
            return "NULL";
        }
    }
}

// ä¸šåŠ¡è§„åˆ™å®ä½“ç±»
@Entity
@Table(name = "business_rules")
public class BusinessRule {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @Column(name = "rule_name", unique = true)
    private String ruleName;
    
    @Enumerated(EnumType.STRING)
    @Column(name = "rule_type")
    private RuleType ruleType;
    
    @Column(name = "target_table")
    private String targetTable;
    
    @Column(name = "condition_expression", columnDefinition = "TEXT")
    private String conditionExpression;
    
    @Column(name = "error_message")
    private String errorMessage;
    
    @Enumerated(EnumType.STRING)
    private Severity severity;
    
    @Column(name = "is_active")
    private Boolean isActive = true;
    
    // getterå’Œsetteræ–¹æ³•
}
```

---

## 7. ğŸ”Œ çº¦æŸä¸åº”ç”¨å±‚é›†æˆ


### 7.1 çº¦æŸä¸ä¸šåŠ¡é€»è¾‘ç»“åˆç­–ç•¥


**ğŸ“Š å¤šå±‚éªŒè¯æ¶æ„**
```
éªŒè¯å±‚æ¬¡æ¶æ„ï¼š

å‰ç«¯éªŒè¯ (JavaScript)
    â†“ ç”¨æˆ·ä½“éªŒä¼˜åŒ–
åº”ç”¨å±‚éªŒè¯ (Java/Python/PHP)
    â†“ ä¸šåŠ¡é€»è¾‘æ§åˆ¶
æ•°æ®åº“çº¦æŸ (MySQL)
    â†“ æ•°æ®å®Œæ•´æ€§ä¿éšœ
å­˜å‚¨å¼•æ“çº¦æŸ (InnoDB)
    â†“ ç‰©ç†æ•°æ®ä¸€è‡´æ€§

å„å±‚èŒè´£ï¼š
â€¢ å‰ç«¯ï¼šæå‡ç”¨æˆ·ä½“éªŒï¼Œå¿«é€Ÿåé¦ˆ
â€¢ åº”ç”¨ï¼šå¤æ‚ä¸šåŠ¡é€»è¾‘ï¼Œæƒé™æ§åˆ¶
â€¢ æ•°æ®åº“ï¼šæ•°æ®å®Œæ•´æ€§ï¼Œæœ€åé˜²çº¿
â€¢ å­˜å‚¨ï¼šç‰©ç†ä¸€è‡´æ€§ï¼Œäº‹åŠ¡ä¿éšœ
```

### 7.2 åº”ç”¨å±‚ä¸šåŠ¡è§„åˆ™éªŒè¯


**ğŸ”§ Spring Booté›†æˆç¤ºä¾‹**
```java
// ä¸šåŠ¡è§„åˆ™éªŒè¯æœåŠ¡
@Service
@Transactional
public class OrderValidationService {
    
    @Autowired
    private BusinessRuleEngine ruleEngine;
    
    @Autowired
    private OrderRepository orderRepository;
    
    // è®¢å•åˆ›å»ºéªŒè¯
    public void validateOrderCreation(OrderCreateRequest request) {
        // 1. åŸºç¡€æ•°æ®éªŒè¯
        validateBasicOrderData(request);
        
        // 2. ä¸šåŠ¡è§„åˆ™éªŒè¯
        Map<String, Object> orderData = convertToMap(request);
        ruleEngine.validateBusinessRules("orders", "INSERT", orderData);
        
        // 3. åº“å­˜éªŒè¯
        validateStockAvailability(request.getItems());
        
        // 4. å®¢æˆ·ä¿¡ç”¨éªŒè¯
        validateCustomerCredit(request.getCustomerId(), request.getTotalAmount());
    }
    
    // åŸºç¡€æ•°æ®éªŒè¯
    private void validateBasicOrderData(OrderCreateRequest request) {
        if (request.getItems() == null || request.getItems().isEmpty()) {
            throw new ValidationException("è®¢å•æ˜ç»†ä¸èƒ½ä¸ºç©º");
        }
        
        if (request.getTotalAmount().compareTo(BigDecimal.ZERO) <= 0) {
            throw new ValidationException("è®¢å•é‡‘é¢å¿…é¡»å¤§äº0");
        }
        
        // éªŒè¯è®¢å•æ˜ç»†é‡‘é¢æ±‡æ€»
        BigDecimal calculatedTotal = request.getItems().stream()
            .map(item -> item.getUnitPrice().multiply(new BigDecimal(item.getQuantity())))
            .reduce(BigDecimal.ZERO, BigDecimal::add);
            
        if (calculatedTotal.compareTo(request.getTotalAmount()) != 0) {
            throw new ValidationException("è®¢å•æ€»é¢ä¸æ˜ç»†é‡‘é¢ä¸åŒ¹é…");
        }
    }
    
    // åº“å­˜å¯ç”¨æ€§éªŒè¯
    private void validateStockAvailability(List<OrderItem> items) {
        for (OrderItem item : items) {
            Integer availableStock = inventoryService.getAvailableStock(item.getProductId());
            
            if (availableStock < item.getQuantity()) {
                throw new StockInsufficientException(
                    String.format("å•†å“%dåº“å­˜ä¸è¶³ï¼Œå¯ç”¨åº“å­˜%dï¼Œéœ€è¦%d", 
                        item.getProductId(), availableStock, item.getQuantity())
                );
            }
        }
    }
    
    // å®¢æˆ·ä¿¡ç”¨éªŒè¯
    private void validateCustomerCredit(Long customerId, BigDecimal orderAmount) {
        CustomerCredit credit = customerService.getCustomerCredit(customerId);
        
        BigDecimal unpaidAmount = orderRepository.getUnpaidAmountByCustomer(customerId);
        BigDecimal totalExposure = unpaidAmount.add(orderAmount);
        
        if (totalExposure.compareTo(credit.getCreditLimit()) > 0) {
            throw new CreditLimitExceededException(
                String.format("è¶…å‡ºä¿¡ç”¨é¢åº¦ï¼šå½“å‰æœªç»“ç®—%sï¼Œæœ¬æ¬¡è®¢å•%sï¼Œä¿¡ç”¨é¢åº¦%s",
                    unpaidAmount, orderAmount, credit.getCreditLimit())
            );
        }
    }
}

// è‡ªå®šä¹‰éªŒè¯æ³¨è§£
@Target({ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Constraint(validatedBy = BusinessRuleValidator.class)
public @interface BusinessRuleValid {
    String message() default "ä¸šåŠ¡è§„åˆ™éªŒè¯å¤±è´¥";
    Class<?>[] groups() default {};
    Class<? extends Payload>[] payload() default {};
    
    String tableName();
    String operation() default "INSERT";
}

// éªŒè¯å™¨å®ç°
public class BusinessRuleValidator implements ConstraintValidator<BusinessRuleValid, Object> {
    
    private String tableName;
    private String operation;
    
    @Override
    public void initialize(BusinessRuleValid annotation) {
        this.tableName = annotation.tableName();
        this.operation = annotation.operation();
    }
    
    @Override
    public boolean isValid(Object value, ConstraintValidatorContext context) {
        try {
            BusinessRuleEngine ruleEngine = SpringContextHolder.getBean(BusinessRuleEngine.class);
            Map<String, Object> data = BeanUtils.toMap(value);
            
            ruleEngine.validateBusinessRules(tableName, operation, data);
            return true;
            
        } catch (BusinessRuleViolationException e) {
            context.disableDefaultConstraintViolation();
            context.buildConstraintViolationWithTemplate(e.getMessage()).addConstraintViolation();
            return false;
        }
    }
}
```

### 7.3 å‰åç«¯çº¦æŸåŒæ­¥


**ğŸ”„ çº¦æŸè§„åˆ™åŒæ­¥æœºåˆ¶**
```javascript
// å‰ç«¯è§„åˆ™ç¼“å­˜ç®¡ç†
class BusinessRuleManager {
    constructor() {
        this.rules = new Map();
        this.lastUpdateTime = null;
    }
    
    // åŠ è½½ä¸šåŠ¡è§„åˆ™
    async loadRules(tableName) {
        try {
            const response = await fetch(`/api/business-rules/${tableName}`);
            const rules = await response.json();
            
            this.rules.set(tableName, rules);
            this.lastUpdateTime = new Date();
            
            return rules;
        } catch (error) {
            console.error('åŠ è½½ä¸šåŠ¡è§„åˆ™å¤±è´¥:', error);
            return [];
        }
    }
    
    // éªŒè¯æ•°æ®
    async validateData(tableName, operation, data) {
        let rules = this.rules.get(tableName);
        
        // å¦‚æœæ²¡æœ‰ç¼“å­˜æˆ–éœ€è¦æ›´æ–°ï¼Œé‡æ–°åŠ è½½
        if (!rules || this.needsUpdate()) {
            rules = await this.loadRules(tableName);
        }
        
        const violations = [];
        
        for (const rule of rules) {
            try {
                const isValid = this.evaluateRule(rule, data);
                
                if (!isValid) {
                    violations.push({
                        ruleName: rule.ruleName,
                        message: rule.errorMessage,
                        severity: rule.severity,
                        field: rule.targetColumns
                    });
                }
            } catch (error) {
                console.error(`è§„åˆ™æ‰§è¡Œå¤±è´¥: ${rule.ruleName}`, error);
            }
        }
        
        return violations;
    }
    
    // ç®€åŒ–çš„è§„åˆ™æ±‚å€¼
    evaluateRule(rule, data) {
        const expression = rule.conditionExpression;
        
        // æ›¿æ¢å˜é‡ï¼ˆå®‰å…¨çš„å®ç°éœ€è¦æ›´å¤æ‚çš„è§£æå™¨ï¼‰
        let evaluableExpression = expression;
        
        for (const [key, value] of Object.entries(data)) {
            const placeholder = `@${key}`;
            const formattedValue = typeof value === 'string' ? `"${value}"` : value;
            evaluableExpression = evaluableExpression.replace(
                new RegExp(placeholder, 'g'), 
                formattedValue
            );
        }
        
        try {
            // æ³¨æ„ï¼šå®é™…åº”ç”¨ä¸­ä¸åº”ä½¿ç”¨evalï¼Œéœ€è¦å®‰å…¨çš„è¡¨è¾¾å¼è§£æå™¨
            return Function('"use strict"; return (' + evaluableExpression + ')')();
        } catch (error) {
            console.error('è¡¨è¾¾å¼æ±‚å€¼å¤±è´¥:', evaluableExpression, error);
            return true; // é»˜è®¤é€šè¿‡ï¼Œé¿å…é˜»å¡ç”¨æˆ·æ“ä½œ
        }
    }
    
    // æ£€æŸ¥æ˜¯å¦éœ€è¦æ›´æ–°è§„åˆ™
    needsUpdate() {
        if (!this.lastUpdateTime) return true;
        
        const updateInterval = 5 * 60 * 1000; // 5åˆ†é’Ÿ
        return Date.now() - this.lastUpdateTime.getTime() > updateInterval;
    }
}

        // Vue.jsç»„ä»¶ä¸­çš„ä½¿ç”¨ç¤ºä¾‹
export default {
    data() {
        return {
            orderForm: {
                customerId: '',
                customerType: '',
                totalAmount: 0,
                discountRate: 0,
                items: []
            },
            validationErrors: []
        }
    },
    
    methods: {
        // å®æ—¶éªŒè¯
        async validateOrder() {
            this.validationErrors = [];
            
            try {
                // è°ƒç”¨ä¸šåŠ¡è§„åˆ™éªŒè¯
                const violations = await ruleManager.validateData('orders', 'INSERT', this.orderForm);
                
                if (violations.length > 0) {
                    this.validationErrors = violations;
                    return false;
                }
                
                return true;
            } catch (error) {
                console.error('è§„åˆ™éªŒè¯å¤±è´¥:', error);
                this.$message.error('è§„åˆ™éªŒè¯æœåŠ¡å¼‚å¸¸');
                return false;
            }
        },
        
        // æäº¤è®¢å•
        async submitOrder() {
            const isValid = await this.validateOrder();
            
            if (!isValid) {
                this.$message.error('è®¢å•æ•°æ®éªŒè¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥');
                return;
            }
            
            try {
                await this.$http.post('/api/orders', this.orderForm);
                this.$message.success('è®¢å•åˆ›å»ºæˆåŠŸ');
            } catch (error) {
                if (error.response && error.response.data.constraintViolation) {
                    this.$message.error('æ•°æ®åº“çº¦æŸéªŒè¯å¤±è´¥: ' + error.response.data.message);
                } else {
                    this.$message.error('è®¢å•åˆ›å»ºå¤±è´¥');
                }
            }
        }
    }
}
```

### 7.4 çº¦æŸé”™è¯¯å¤„ç†æœºåˆ¶


**ğŸš¨ é”™è¯¯å¤„ç†å’Œç”¨æˆ·åé¦ˆ**
```java
// çº¦æŸå¼‚å¸¸å¤„ç†å™¨
@ControllerAdvice
public class ConstraintViolationHandler {
    
    private static final Logger logger = LoggerFactory.getLogger(ConstraintViolationHandler.class);
    
    // å¤„ç†æ•°æ®åº“çº¦æŸè¿åå¼‚å¸¸
    @ExceptionHandler(SQLIntegrityConstraintViolationException.class)
    public ResponseEntity<ErrorResponse> handleConstraintViolation(
            SQLIntegrityConstraintViolationException ex) {
        
        String message = parseConstraintError(ex.getMessage());
        
        ErrorResponse error = ErrorResponse.builder()
            .code("CONSTRAINT_VIOLATION")
            .message(message)
            .timestamp(LocalDateTime.now())
            .constraintViolation(true)
            .build();
            
        logger.warn("æ•°æ®åº“çº¦æŸè¿å: {}", ex.getMessage());
        
        return ResponseEntity.badRequest().body(error);
    }
    
    // å¤„ç†ä¸šåŠ¡è§„åˆ™è¿åå¼‚å¸¸
    @ExceptionHandler(BusinessRuleViolationException.class)
    public ResponseEntity<ErrorResponse> handleBusinessRuleViolation(
            BusinessRuleViolationException ex) {
        
        ErrorResponse error = ErrorResponse.builder()
            .code("BUSINESS_RULE_VIOLATION")
            .message(ex.getMessage())
            .ruleName(ex.getRuleName())
            .severity(ex.getSeverity())
            .timestamp(LocalDateTime.now())
            .build();
            
        return ResponseEntity.badRequest().body(error);
    }
    
    // è§£æçº¦æŸé”™è¯¯æ¶ˆæ¯
    private String parseConstraintError(String sqlMessage) {
        // å¸¸è§çº¦æŸé”™è¯¯æ¨¡å¼åŒ¹é…
        if (sqlMessage.contains("chk_price_positive")) {
            return "å•†å“ä»·æ ¼å¿…é¡»å¤§äº0";
        } else if (sqlMessage.contains("chk_discount_rate")) {
            return "æŠ˜æ‰£ç‡å¿…é¡»åœ¨0-90%ä¹‹é—´";
        } else if (sqlMessage.contains("chk_stock_non_negative")) {
            return "åº“å­˜æ•°é‡ä¸èƒ½ä¸ºè´Ÿæ•°";
        } else if (sqlMessage.contains("chk_order_amount")) {
            return "è®¢å•é‡‘é¢å¿…é¡»å¤§äº0";
        } else if (sqlMessage.contains("Duplicate entry")) {
            return "æ•°æ®é‡å¤ï¼Œè¯·æ£€æŸ¥å”¯ä¸€æ€§çº¦æŸ";
        } else {
            return "æ•°æ®éªŒè¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥è¾“å…¥å†…å®¹";
        }
    }
}

// çº¦æŸéªŒè¯ç»“æœæ¨¡å‹
@Data
@Builder
public class ErrorResponse {
    private String code;
    private String message;
    private String ruleName;
    private String severity;
    private LocalDateTime timestamp;
    private boolean constraintViolation;
    private Map<String, String> fieldErrors;
}
```

### 7.5 å®æ—¶çº¦æŸéªŒè¯API


**ğŸ”§ çº¦æŸéªŒè¯å¾®æœåŠ¡**
```java
// ä¸šåŠ¡è§„åˆ™éªŒè¯æ§åˆ¶å™¨
@RestController
@RequestMapping("/api/validation")
public class ValidationController {
    
    @Autowired
    private BusinessRuleEngine ruleEngine;
    
    // å®æ—¶å­—æ®µéªŒè¯
    @PostMapping("/field/{tableName}/{fieldName}")
    public ResponseEntity<ValidationResult> validateField(
            @PathVariable String tableName,
            @PathVariable String fieldName,
            @RequestBody Object fieldValue) {
        
        try {
            Map<String, Object> data = Map.of(fieldName, fieldValue);
            ruleEngine.validateBusinessRules(tableName, "INSERT", data);
            
            return ResponseEntity.ok(ValidationResult.success());
            
        } catch (BusinessRuleViolationException e) {
            ValidationResult result = ValidationResult.failure(e.getMessage());
            return ResponseEntity.badRequest().body(result);
        }
    }
    
    // æ•´è®°å½•éªŒè¯
    @PostMapping("/record/{tableName}")
    public ResponseEntity<ValidationResult> validateRecord(
            @PathVariable String tableName,
            @RequestBody Map<String, Object> recordData) {
        
        try {
            ruleEngine.validateBusinessRules(tableName, "INSERT", recordData);
            
            return ResponseEntity.ok(ValidationResult.success());
            
        } catch (BusinessRuleViolationException e) {
            ValidationResult result = ValidationResult.failure(e.getMessage());
            result.setViolatedFields(extractFieldsFromMessage(e.getMessage()));
            return ResponseEntity.badRequest().body(result);
        }
    }
    
    // æ‰¹é‡éªŒè¯
    @PostMapping("/batch/{tableName}")
    public ResponseEntity<List<ValidationResult>> validateBatch(
            @PathVariable String tableName,
            @RequestBody List<Map<String, Object>> records) {
        
        List<ValidationResult> results = new ArrayList<>();
        
        for (int i = 0; i < records.size(); i++) {
            try {
                ruleEngine.validateBusinessRules(tableName, "INSERT", records.get(i));
                results.add(ValidationResult.success().setRecordIndex(i));
                
            } catch (BusinessRuleViolationException e) {
                ValidationResult result = ValidationResult.failure(e.getMessage());
                result.setRecordIndex(i);
                results.add(result);
            }
        }
        
        return ResponseEntity.ok(results);
    }
    
    // è·å–è¡¨çš„æ‰€æœ‰çº¦æŸè§„åˆ™
    @GetMapping("/rules/{tableName}")
    public ResponseEntity<List<BusinessRuleDTO>> getTableRules(@PathVariable String tableName) {
        List<BusinessRuleDTO> rules = ruleEngine.getTableRules(tableName);
        return ResponseEntity.ok(rules);
    }
}

// éªŒè¯ç»“æœæ¨¡å‹
@Data
@Builder
public class ValidationResult {
    private boolean valid;
    private String message;
    private List<String> violatedFields;
    private Integer recordIndex;
    private String severity;
    
    public static ValidationResult success() {
        return ValidationResult.builder().valid(true).build();
    }
    
    public static ValidationResult failure(String message) {
        return ValidationResult.builder().valid(false).message(message).build();
    }
}
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ”¸ ä¸šåŠ¡è§„åˆ™çº¦æŸçš„æœ¬è´¨ç†è§£**
```
çº¦æŸ = ä¸šåŠ¡è§„åˆ™çš„æ•°æ®åº“è¡¨è¾¾
â€¢ å°†ç°å®ä¸šåŠ¡é€»è¾‘è½¬åŒ–ä¸ºå¯æ‰§è¡Œçš„çº¦æŸæ¡ä»¶
â€¢ ç¡®ä¿æ•°æ®åº“ä¸­çš„æ•°æ®ç¬¦åˆä¸šåŠ¡è¦æ±‚
â€¢ æ˜¯æ•°æ®å®Œæ•´æ€§çš„æœ€åä¸€é“é˜²çº¿

ä¸‰ä¸ªå±‚æ¬¡çš„ç†è§£ï¼š
â€¢ ä»€ä¹ˆæ˜¯ä¸šåŠ¡è§„åˆ™ï¼šç°å®ä¸–ç•Œçš„ä¸šåŠ¡é€»è¾‘
â€¢ å¦‚ä½•çº¦æŸåŒ–ï¼šè½¬åŒ–ä¸ºæ•°æ®åº“å¯ç†è§£çš„è¡¨è¾¾å¼
â€¢ æ€æ ·å®ç°ï¼šé€‰æ‹©åˆé€‚çš„æŠ€æœ¯æ‰‹æ®µ
```

**ğŸ”¸ CHECKçº¦æŸè¡¨è¾¾å¼çš„ä½¿ç”¨åŸåˆ™**
```
èƒ½ç”¨CHECKçš„åœºæ™¯ï¼š
â€¢ å•è¡¨å­—æ®µå€¼çš„èŒƒå›´æ£€æŸ¥
â€¢ å­—æ®µé—´çš„é€»è¾‘å…³ç³»éªŒè¯
â€¢ ç¡®å®šæ€§çš„è®¡ç®—ç»“æœéªŒè¯

ä¸èƒ½ç”¨CHECKçš„é™åˆ¶ï¼š
â€¢ éç¡®å®šæ€§å‡½æ•°ï¼ˆNOW()ã€RAND()ç­‰ï¼‰
â€¢ å­æŸ¥è¯¢å’Œè·¨è¡¨æ•°æ®è®¿é—®
â€¢ å¤æ‚çš„ä¸šåŠ¡æµç¨‹æ§åˆ¶

æ›¿ä»£æ–¹æ¡ˆï¼š
â€¢ è§¦å‘å™¨ï¼šå¤„ç†å¤æ‚é€»è¾‘å’Œè·¨è¡¨çº¦æŸ
â€¢ å­˜å‚¨è¿‡ç¨‹ï¼šå®ç°å¤æ‚çš„ä¸šåŠ¡è§„åˆ™éªŒè¯
â€¢ åº”ç”¨å±‚ï¼šå¤„ç†å®æ—¶æ€§å’Œç”¨æˆ·ä½“éªŒéœ€æ±‚
```

### 8.2 å…³é”®å®ç°ç­–ç•¥


**ğŸ”¹ è·¨è¡¨çº¦æŸçš„å®ç°æ€è·¯**
```
æŠ€æœ¯é€‰æ‹©ï¼š
1. è§¦å‘å™¨ï¼šå®æ—¶æ€§å¼ºï¼Œæ€§èƒ½å¼€é”€å¤§
2. å­˜å‚¨è¿‡ç¨‹ï¼šé€»è¾‘é›†ä¸­ï¼Œè°ƒç”¨æ–¹å¼çµæ´»
3. åº”ç”¨å±‚ï¼šä¸šåŠ¡é€»è¾‘æ¸…æ™°ï¼Œä¾¿äºç»´æŠ¤
4. è§„åˆ™å¼•æ“ï¼šé…ç½®åŒ–ç®¡ç†ï¼ŒåŠ¨æ€è°ƒæ•´

é€‚ç”¨åœºæ™¯ï¼š
â€¢ å¼ºä¸€è‡´æ€§è¦æ±‚ â†’ æ•°æ®åº“çº¦æŸ
â€¢ å¤æ‚ä¸šåŠ¡é€»è¾‘ â†’ åº”ç”¨å±‚éªŒè¯
â€¢ æ€§èƒ½è¦æ±‚é«˜ â†’ ç¼“å­˜ + å¼‚æ­¥éªŒè¯
â€¢ è§„åˆ™å˜åŒ–é¢‘ç¹ â†’ è§„åˆ™å¼•æ“
```

**ğŸ”¹ åŠ¨æ€çº¦æŸç®¡ç†çš„ä»·å€¼**
```
ä¸šåŠ¡çµæ´»æ€§ï¼š
â€¢ è§„åˆ™å¯é…ç½®ï¼Œä¸éœ€è¦ä¿®æ”¹ä»£ç 
â€¢ æ”¯æŒA/Bæµ‹è¯•å’Œç°åº¦å‘å¸ƒ
â€¢ å¤šç§Ÿæˆ·ç¯å¢ƒä¸‹çš„ä¸ªæ€§åŒ–è§„åˆ™

æŠ€æœ¯ä¼˜åŠ¿ï¼š
â€¢ è§„åˆ™é›†ä¸­ç®¡ç†ï¼Œä¾¿äºç»´æŠ¤
â€¢ è§„åˆ™ç‰ˆæœ¬æ§åˆ¶ï¼Œæ”¯æŒå›æ»š
â€¢ è§„åˆ™æ‰§è¡Œç›‘æ§ï¼Œæ€§èƒ½å¯è§‚æµ‹
```

### 8.3 ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ


**â­ çº¦æŸè®¾è®¡åŸåˆ™**
```
æ€§èƒ½ä¼˜å…ˆï¼š
â€¢ ç®€å•çº¦æŸç”¨CHECKï¼Œå¤æ‚é€»è¾‘ç”¨è§¦å‘å™¨
â€¢ é¿å…åœ¨çº¦æŸä¸­è¿›è¡Œå¤æ‚è®¡ç®—
â€¢ è€ƒè™‘çº¦æŸå¯¹INSERT/UPDATEæ€§èƒ½çš„å½±å“

å¯ç»´æŠ¤æ€§ï¼š
â€¢ çº¦æŸå‘½åè§„èŒƒï¼Œè§åçŸ¥æ„
â€¢ é”™è¯¯æ¶ˆæ¯æ¸…æ™°ï¼Œä¾¿äºå®šä½é—®é¢˜
â€¢ æ–‡æ¡£è®°å½•çº¦æŸçš„ä¸šåŠ¡å«ä¹‰

æ¸è¿›å¼å®ç°ï¼š
â€¢ ä»ç®€å•çº¦æŸå¼€å§‹ï¼Œé€æ­¥å¢åŠ å¤æ‚åº¦
â€¢ æ–°çº¦æŸå…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯
â€¢ è€ƒè™‘å‘åå…¼å®¹æ€§ï¼Œé¿å…ç ´åç°æœ‰æ•°æ®
```

**ğŸ”¹ é”™è¯¯å¤„ç†ç­–ç•¥**
```
ç”¨æˆ·å‹å¥½ï¼š
â€¢ å°†æŠ€æœ¯é”™è¯¯è½¬åŒ–ä¸ºä¸šåŠ¡è¯­è¨€
â€¢ æä¾›å…·ä½“çš„ä¿®æ”¹å»ºè®®
â€¢ åŒºåˆ†é”™è¯¯çº§åˆ«ï¼ˆé”™è¯¯/è­¦å‘Š/æç¤ºï¼‰

å¼€å‘å‹å¥½ï¼š
â€¢ è¯¦ç»†çš„é”™è¯¯æ—¥å¿—è®°å½•
â€¢ çº¦æŸè¿åçš„è°ƒè¯•ä¿¡æ¯
â€¢ æ€§èƒ½ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶
```

**ğŸ”¹ é›†æˆæ¶æ„è®¾è®¡**
```
åˆ†å±‚éªŒè¯ç­–ç•¥ï¼š
å‰ç«¯éªŒè¯ï¼šç”¨æˆ·ä½“éªŒ + åŸºç¡€æ ¼å¼æ£€æŸ¥
åº”ç”¨éªŒè¯ï¼šä¸šåŠ¡é€»è¾‘ + æƒé™æ§åˆ¶  
æ•°æ®åº“çº¦æŸï¼šæ•°æ®å®Œæ•´æ€§ + æœ€åé˜²çº¿

å„å±‚é…åˆï¼š
â€¢ å‰ç«¯ï¼šå®æ—¶åé¦ˆï¼Œå‡å°‘æ— æ•ˆè¯·æ±‚
â€¢ åº”ç”¨ï¼šå¤æ‚é€»è¾‘ï¼Œä¸šåŠ¡æµç¨‹æ§åˆ¶
â€¢ æ•°æ®åº“ï¼šæ•°æ®å®‰å…¨ï¼Œé˜²æ­¢è„æ•°æ®

åŒæ­¥æœºåˆ¶ï¼š
â€¢ è§„åˆ™é…ç½®ç»Ÿä¸€ç®¡ç†
â€¢ å¤šå±‚éªŒè¯é€»è¾‘åŒæ­¥
â€¢ é”™è¯¯æ¶ˆæ¯ä¸€è‡´æ€§ä¿è¯
```

### 8.4 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ“‹ çº¦æŸè®¾è®¡æ£€æŸ¥æ¸…å•**
```
è®¾è®¡é˜¶æ®µï¼š
â–¡ è¯†åˆ«æ‰€æœ‰ä¸šåŠ¡è§„åˆ™
â–¡ åˆ†æè§„åˆ™å¤æ‚åº¦å’Œä¾èµ–å…³ç³»
â–¡ é€‰æ‹©åˆé€‚çš„å®ç°æ–¹å¼
â–¡ è®¾è®¡é”™è¯¯å¤„ç†ç­–ç•¥
â–¡ è€ƒè™‘æ€§èƒ½å½±å“

å®ç°é˜¶æ®µï¼š
â–¡ ç¼–å†™æ¸…æ™°çš„çº¦æŸè¡¨è¾¾å¼
â–¡ è®¾è®¡å‹å¥½çš„é”™è¯¯æ¶ˆæ¯
â–¡ å®ç°å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹
â–¡ æ–‡æ¡£è®°å½•ä¸šåŠ¡å«ä¹‰
â–¡ æ€§èƒ½åŸºå‡†æµ‹è¯•

è¿ç»´é˜¶æ®µï¼š
â–¡ ç›‘æ§çº¦æŸè¿åé¢‘ç‡
â–¡ åˆ†æçº¦æŸå¯¹æ€§èƒ½çš„å½±å“
â–¡ å®šæœŸå®¡æŸ¥è§„åˆ™æœ‰æ•ˆæ€§
â–¡ ä¼˜åŒ–æ…¢æŸ¥è¯¢çº¦æŸ
â–¡ è§„åˆ™å˜æ›´æµç¨‹ç®¡ç†
```

**ğŸ¯ æŠ€æœ¯é€‰å‹æŒ‡å¯¼**
```
ç®€å•å­—æ®µçº¦æŸ â†’ CHECKçº¦æŸ
å¤æ‚é€»è¾‘çº¦æŸ â†’ è§¦å‘å™¨
è·¨è¡¨æ•°æ®çº¦æŸ â†’ å­˜å‚¨è¿‡ç¨‹
åŠ¨æ€è§„åˆ™ç®¡ç† â†’ è§„åˆ™å¼•æ“
å®æ—¶ç”¨æˆ·ä½“éªŒ â†’ åº”ç”¨å±‚éªŒè¯

æ€§èƒ½è€ƒè™‘ï¼š
â€¢ é«˜é¢‘æ“ä½œè¡¨å°‘ç”¨å¤æ‚çº¦æŸ
â€¢ æ‰¹é‡æ“ä½œæ—¶è€ƒè™‘çº¦æŸå¼€é”€
â€¢ å¿…è¦æ—¶å¯ä»¥å¼‚æ­¥éªŒè¯
â€¢ çº¦æŸå¤±è´¥è¦æœ‰é™çº§ç­–ç•¥
```

**ğŸ’¡ å­¦ä¹ å»ºè®®**
```
å­¦ä¹ è·¯å¾„ï¼š
1. æŒæ¡åŸºç¡€CHECKçº¦æŸè¯­æ³•
2. ç†è§£è§¦å‘å™¨çš„å·¥ä½œåŸç†
3. å­¦ä¹ å­˜å‚¨è¿‡ç¨‹ç¼–ç¨‹
4. äº†è§£è§„åˆ™å¼•æ“æ¦‚å¿µ
5. å®è·µå¤šå±‚éªŒè¯æ¶æ„

å®è·µé¡¹ç›®ï¼š
â€¢ ç”µå•†è®¢å•ç®¡ç†ç³»ç»Ÿ
â€¢ è´¢åŠ¡è´¦åŠ¡ç®¡ç†ç³»ç»Ÿ
â€¢ äººäº‹è–ªèµ„ç®¡ç†ç³»ç»Ÿ
â€¢ åº“å­˜è¿›é”€å­˜ç³»ç»Ÿ

æ³¨æ„äº‹é¡¹ï¼š
â€¢ çº¦æŸä¸æ˜¯ä¸‡èƒ½çš„ï¼Œè¦ç»“åˆä¸šåŠ¡åœºæ™¯
â€¢ è¿‡åº¦çº¦æŸä¼šå½±å“ç³»ç»Ÿæ€§èƒ½å’Œçµæ´»æ€§
â€¢ çº¦æŸè®¾è®¡è¦è€ƒè™‘æ•°æ®è¿ç§»å’Œå…¼å®¹æ€§
â€¢ å›¢é˜Ÿåä½œä¸­è¦ç»Ÿä¸€çº¦æŸè®¾è®¡è§„èŒƒ
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- ä¸šåŠ¡è§„åˆ™è¦è½¬åŒ–ä¸ºæ•°æ®åº“èƒ½ç†è§£çš„çº¦æŸè¡¨è¾¾å¼
- CHECKçº¦æŸé€‚åˆç®€å•é€»è¾‘ï¼Œè§¦å‘å™¨å¤„ç†å¤æ‚åœºæ™¯
- è·¨è¡¨çº¦æŸéœ€è¦è§¦å‘å™¨æˆ–å­˜å‚¨è¿‡ç¨‹é…åˆå®ç°
- åŠ¨æ€çº¦æŸç®¡ç†è®©è§„åˆ™å˜æ›´æ›´åŠ çµæ´»
- å¤šå±‚éªŒè¯ç¡®ä¿ç”¨æˆ·ä½“éªŒå’Œæ•°æ®å®‰å…¨å¹¶é‡
- çº¦æŸè®¾è®¡è¦å¹³è¡¡ä¸šåŠ¡éœ€æ±‚ã€æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§