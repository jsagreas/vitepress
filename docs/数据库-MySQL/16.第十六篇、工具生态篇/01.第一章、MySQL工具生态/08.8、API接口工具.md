---
title: 8ã€APIæ¥å£å·¥å…·
---
## ğŸ“š ç›®å½•

1. [MySQL APIæ¥å£æ¦‚è¿°](#1-MySQL-APIæ¥å£æ¦‚è¿°)
2. [REST APIæ¥å£](#2-REST-APIæ¥å£)
3. [MySQL X DevAPI](#3-MySQL-X-DevAPI)
4. [Connectoré©±åŠ¨ç¨‹åº](#4-Connectoré©±åŠ¨ç¨‹åº)
5. [ç°ä»£APIæŠ€æœ¯æ ˆ](#5-ç°ä»£APIæŠ€æœ¯æ ˆ)
6. [APIæ€§èƒ½ä¸å®‰å…¨](#6-APIæ€§èƒ½ä¸å®‰å…¨)
7. [APIç®¡ç†ä¸ç›‘æ§](#7-APIç®¡ç†ä¸ç›‘æ§)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ MySQL APIæ¥å£æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯APIæ¥å£å·¥å…·


**ğŸ’¡ é€šä¿—ç†è§£**
APIæ¥å£å·¥å…·å°±åƒé¤å…çš„æœåŠ¡å‘˜ï¼Œä½ ï¼ˆåº”ç”¨ç¨‹åºï¼‰æƒ³è¦ä»€ä¹ˆæ•°æ®ï¼Œå‘Šè¯‰æœåŠ¡å‘˜ï¼ˆAPIï¼‰ï¼ŒæœåŠ¡å‘˜å»å¨æˆ¿ï¼ˆæ•°æ®åº“ï¼‰å¸®ä½ å–ï¼Œç„¶åç«¯ç»™ä½ ã€‚

```
ä¼ ç»Ÿæ–¹å¼ï¼šåº”ç”¨ç›´æ¥è¿æ¥æ•°æ®åº“
åº”ç”¨ â†â†’ MySQLæ•°æ®åº“

APIæ–¹å¼ï¼šé€šè¿‡æ¥å£å±‚è®¿é—®æ•°æ®åº“
åº”ç”¨ â†â†’ APIæ¥å£ â†â†’ MySQLæ•°æ®åº“
```

**ğŸ”¸ æ ¸å¿ƒä»·å€¼**
- **è§£è€¦åˆ**ï¼šåº”ç”¨ä¸ç›´æ¥æ“ä½œæ•°æ®åº“ï¼Œé€šè¿‡APIç»Ÿä¸€è®¿é—®
- **å®‰å…¨æ€§**ï¼šéšè—æ•°æ®åº“ç»†èŠ‚ï¼Œç»Ÿä¸€æƒé™æ§åˆ¶
- **æ ‡å‡†åŒ–**ï¼šæä¾›ç»Ÿä¸€çš„æ•°æ®è®¿é—®æ¥å£
- **å¯æ‰©å±•**ï¼šæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€å’Œå¹³å°

### 1.2 APIæ¥å£å·¥å…·åˆ†ç±»


```
æŒ‰æŠ€æœ¯ç±»å‹åˆ†ç±»ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  REST API       â”‚ â† HTTPåè®®ï¼Œç®€å•æ˜“ç”¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  GraphQL API    â”‚ â† çµæ´»æŸ¥è¯¢ï¼ŒæŒ‰éœ€è·å–
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  gRPC API       â”‚ â† é«˜æ€§èƒ½ï¼ŒäºŒè¿›åˆ¶åè®®
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  WebSocket API  â”‚ â† å®æ—¶é€šä¿¡ï¼ŒåŒå‘è¿æ¥
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æŒ‰åº”ç”¨åœºæ™¯åˆ†ç±»ï¼š
â€¢ Webåº”ç”¨APIï¼šæµè§ˆå™¨è®¿é—®
â€¢ ç§»åŠ¨åº”ç”¨APIï¼šAPPåç«¯æœåŠ¡
â€¢ å¾®æœåŠ¡APIï¼šæœåŠ¡é—´é€šä¿¡
â€¢ ç¬¬ä¸‰æ–¹é›†æˆAPIï¼šå¤–éƒ¨ç³»ç»Ÿå¯¹æ¥
```

---

## 2. ğŸŒ REST APIæ¥å£


### 2.1 REST APIåŸºæœ¬æ¦‚å¿µ


**ğŸ’¡ ä»€ä¹ˆæ˜¯REST**
RESTå°±åƒé‚®æ”¿ç³»ç»Ÿçš„è§„åˆ™ï¼š
- **èµ„æºï¼ˆResourceï¼‰**ï¼šæ¯ä¸ªæ•°æ®éƒ½æœ‰å”¯ä¸€åœ°å€ï¼ˆURLï¼‰
- **åŠ¨ä½œï¼ˆMethodï¼‰**ï¼šç”¨GETå–ä¿¡æ¯ï¼ŒPOSTå¯„ä¿¡æ¯
- **çŠ¶æ€ï¼ˆStatusï¼‰**ï¼šæ¯æ¬¡æ“ä½œéƒ½æœ‰æ˜ç¡®ç»“æœ

**ğŸ”¸ RESTè®¾è®¡åŸåˆ™**
```
ç»Ÿä¸€æ¥å£ï¼š
GET /api/users          # è·å–ç”¨æˆ·åˆ—è¡¨
GET /api/users/123      # è·å–ç‰¹å®šç”¨æˆ·
POST /api/users         # åˆ›å»ºæ–°ç”¨æˆ·
PUT /api/users/123      # æ›´æ–°ç”¨æˆ·ä¿¡æ¯
DELETE /api/users/123   # åˆ é™¤ç”¨æˆ·
```

### 2.2 MySQL REST APIå®ç°


**ğŸ› ï¸ ä½¿ç”¨Node.js + Expresså®ç°**
```javascript
// åŸºç¡€REST APIæœåŠ¡å™¨
const express = require('express');
const mysql = require('mysql2/promise');

const app = express();
app.use(express.json());

// æ•°æ®åº“è¿æ¥é…ç½®
const dbConfig = {
  host: 'localhost',
  user: 'api_user',
  password: 'secure_password',
  database: 'my_database'
};

// è·å–æ‰€æœ‰ç”¨æˆ·
app.get('/api/users', async (req, res) => {
  try {
    const connection = await mysql.createConnection(dbConfig);
    const [rows] = await connection.execute('SELECT * FROM users');
    await connection.end();
    
    res.json({ success: true, data: rows });
  } catch (error) {
    res.status(500).json({ success: false, error: error.message });
  }
});

// åˆ›å»ºæ–°ç”¨æˆ·
app.post('/api/users', async (req, res) => {
  const { name, email } = req.body;
  
  try {
    const connection = await mysql.createConnection(dbConfig);
    const [result] = await connection.execute(
      'INSERT INTO users (name, email) VALUES (?, ?)',
      [name, email]
    );
    await connection.end();
    
    res.json({ success: true, userId: result.insertId });
  } catch (error) {
    res.status(400).json({ success: false, error: error.message });
  }
});

app.listen(3000, () => {
  console.log('APIæœåŠ¡å™¨è¿è¡Œåœ¨ç«¯å£3000');
});
```

### 2.3 REST APIè®¾è®¡æœ€ä½³å®è·µ


**ğŸ“‹ URLè®¾è®¡è§„èŒƒ**
```
âœ… å¥½çš„è®¾è®¡ï¼š
/api/v1/users              # è·å–ç”¨æˆ·åˆ—è¡¨
/api/v1/users/123          # ç‰¹å®šç”¨æˆ·
/api/v1/users/123/orders   # ç”¨æˆ·çš„è®¢å•

âŒ é¿å…çš„è®¾è®¡ï¼š
/api/getUserList           # åŠ¨è¯ä¸åº”è¯¥åœ¨URLä¸­
/api/user_123              # ä¸æ ‡å‡†çš„èµ„æºæ ‡è¯†
/api/users?action=delete   # ç”¨æŸ¥è¯¢å‚æ•°è¡¨ç¤ºåŠ¨ä½œ
```

**ğŸ”’ å“åº”æ ¼å¼æ ‡å‡†åŒ–**
```javascript
// æˆåŠŸå“åº”æ ¼å¼
{
  "success": true,
  "data": {
    "id": 123,
    "name": "å¼ ä¸‰",
    "email": "zhangsan@example.com"
  },
  "message": "æ“ä½œæˆåŠŸ"
}

// é”™è¯¯å“åº”æ ¼å¼
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®",
    "details": ["emailå­—æ®µå¿…é¡»æ˜¯æœ‰æ•ˆçš„é‚®ç®±åœ°å€"]
  }
}
```

---

## 3. âš¡ MySQL X DevAPI


### 3.1 X DevAPIç®€ä»‹


**ğŸ’¡ ä»€ä¹ˆæ˜¯X DevAPI**
X DevAPIæ˜¯MySQLå®˜æ–¹æ¨å‡ºçš„æ–°ä¸€ä»£APIï¼Œå°±åƒä»è€å¼ç”µè¯å‡çº§åˆ°æ™ºèƒ½æ‰‹æœºï¼š
- **æ–‡æ¡£å­˜å‚¨**ï¼šå¯ä»¥ç›´æ¥å­˜å‚¨JSONæ–‡æ¡£
- **å…³ç³»æ•°æ®**ï¼šåŒæ—¶æ”¯æŒä¼ ç»ŸSQLè¡¨æ ¼
- **ç°ä»£è¯­æ³•**ï¼šæ›´è´´è¿‘ç¼–ç¨‹è¯­è¨€çš„å†™æ³•

**ğŸ”¸ æ ¸å¿ƒç‰¹ç‚¹**
```
ä¼ ç»ŸMySQLè¿æ¥ï¼š
è¿æ¥ â†’ æ‰§è¡ŒSQL â†’ å¤„ç†ç»“æœ â†’ å…³é—­è¿æ¥

X DevAPIæ–¹å¼ï¼š
ä¼šè¯ â†’ æ“ä½œé›†åˆ/è¡¨ â†’ é“¾å¼è°ƒç”¨ â†’ è‡ªåŠ¨ç®¡ç†
```

### 3.2 X DevAPIåŸºæœ¬ä½¿ç”¨


**ğŸ› ï¸ Pythonç¤ºä¾‹**
```python
import mysqlx

# å»ºç«‹ä¼šè¯è¿æ¥
session = mysqlx.get_session({
    'host': 'localhost',
    'port': 33060,
    'user': 'root',
    'password': 'password'
})

# è·å–æ•°æ®åº“å’Œé›†åˆ
schema = session.get_schema('test_db')
collection = schema.get_collection('users')

# æ·»åŠ æ–‡æ¡£ï¼ˆJSONæ•°æ®ï¼‰
collection.add({
    'name': 'å¼ ä¸‰',
    'age': 25,
    'email': 'zhangsan@example.com',
    'skills': ['Python', 'MySQL', 'JavaScript']
}).execute()

# æŸ¥è¯¢æ–‡æ¡£
users = collection.find('age > :age').bind('age', 20).execute()
for user in users:
    print(f"å§“å: {user['name']}, å¹´é¾„: {user['age']}")

# å…³é—­ä¼šè¯
session.close()
```

**ğŸ”¸ é“¾å¼æ“ä½œä¼˜åŠ¿**
```python
# ä¼ ç»ŸSQLæ–¹å¼
cursor.execute("SELECT * FROM users WHERE age > %s AND city = %s", (25, 'åŒ—äº¬'))

# X DevAPIæ–¹å¼
collection.find('age > :age and city = :city') \
          .bind('age', 25) \
          .bind('city', 'åŒ—äº¬') \
          .limit(10) \
          .sort('age DESC') \
          .execute()
```

### 3.3 X DevAPI vs ä¼ ç»Ÿè¿æ¥


| ç‰¹æ€§å¯¹æ¯” | **ä¼ ç»ŸMySQL** | **X DevAPI** | **é€‚ç”¨åœºæ™¯** |
|---------|-------------|-------------|-------------|
| ğŸ”— **è¿æ¥æ–¹å¼** | `3306ç«¯å£ï¼ŒSQLåè®®` | `33060ç«¯å£ï¼ŒXåè®®` | `ç°ä»£åº”ç”¨é€‰Xåè®®` |
| ğŸ“ **è¯­æ³•é£æ ¼** | `SQLå­—ç¬¦ä¸²` | `é“¾å¼æ–¹æ³•è°ƒç”¨` | `å¼€å‘æ•ˆç‡æ›´é«˜` |
| ğŸ’¾ **æ•°æ®æ¨¡å‹** | `ä»…æ”¯æŒå…³ç³»è¡¨` | `è¡¨+æ–‡æ¡£æ··åˆ` | `çµæ´»æ•°æ®å­˜å‚¨` |
| ğŸ”’ **äº‹åŠ¡å¤„ç†** | `æ‰‹åŠ¨BEGIN/COMMIT` | `è‡ªåŠ¨äº‹åŠ¡ç®¡ç†` | `å‡å°‘ç¼–ç¨‹é”™è¯¯` |

---

## 4. ğŸ”Œ Connectoré©±åŠ¨ç¨‹åº


### 4.1 ä»€ä¹ˆæ˜¯Connectoré©±åŠ¨


**ğŸ’¡ é€šä¿—ç†è§£**
Connectoré©±åŠ¨å°±åƒä¸åŒå›½å®¶çš„ç¿»è¯‘å®˜ï¼Œå¸®åŠ©ä¸åŒç¼–ç¨‹è¯­è¨€ï¼ˆä¸­æ–‡ã€è‹±æ–‡ã€æ³•æ–‡ï¼‰ä¸MySQLæ•°æ®åº“ï¼ˆå¾·è¯­ï¼‰è¿›è¡Œäº¤æµã€‚

```
ç¼–ç¨‹è¯­è¨€ç”Ÿæ€ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Javaåº”ç”¨      â”‚â”€â”€â”€â†’â”‚ MySQL        â”‚â”€â”€â”€â†’â”‚   MySQL     â”‚
â”‚                 â”‚    â”‚ Connector/J  â”‚    â”‚   æ•°æ®åº“    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Pythonåº”ç”¨    â”‚â”€â”€â”€â†’â”‚ MySQL        â”‚â”€â”€â”€â†’â”‚   MySQL     â”‚
â”‚                 â”‚    â”‚ Connector/P  â”‚    â”‚   æ•°æ®åº“    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ä¸»æµConnectoré©±åŠ¨


**ğŸ”¸ å®˜æ–¹é©±åŠ¨ç¨‹åº**
```python
# Python - mysql-connector-python
import mysql.connector

conn = mysql.connector.connect(
    host='localhost',
    user='username',
    password='password',
    database='testdb'
)

cursor = conn.cursor()
cursor.execute("SELECT * FROM users WHERE age > %s", (18,))
results = cursor.fetchall()

for row in results:
    print(f"ID: {row[0]}, å§“å: {row[1]}")

conn.close()
```

```java
// Java - MySQL Connector/J
import java.sql.*;

public class MySQLExample {
    public static void main(String[] args) {
        String url = "jdbc:mysql://localhost:3306/testdb";
        String user = "username";
        String password = "password";
        
        try (Connection conn = DriverManager.getConnection(url, user, password)) {
            String sql = "SELECT * FROM users WHERE age > ?";
            PreparedStatement stmt = conn.prepareStatement(sql);
            stmt.setInt(1, 18);
            
            ResultSet rs = stmt.executeQuery();
            while (rs.next()) {
                System.out.println("ID: " + rs.getInt("id") + 
                                 ", å§“å: " + rs.getString("name"));
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}
```

### 4.3 ç¼–ç¨‹è¯­è¨€é›†æˆæœ€ä½³å®è·µ


**ğŸ”’ è¿æ¥æ± ç®¡ç†**
```javascript
// Node.jsè¿æ¥æ± ç¤ºä¾‹
const mysql = require('mysql2/promise');

// åˆ›å»ºè¿æ¥æ± 
const pool = mysql.createPool({
    host: 'localhost',
    user: 'username',
    password: 'password',
    database: 'testdb',
    waitForConnections: true,
    connectionLimit: 10,      // æœ€å¤§è¿æ¥æ•°
    queueLimit: 0,           // ç­‰å¾…é˜Ÿåˆ—é•¿åº¦
    acquireTimeout: 60000,   // è·å–è¿æ¥è¶…æ—¶
    timeout: 60000,          // æŸ¥è¯¢è¶…æ—¶
});

// ä½¿ç”¨è¿æ¥æ± æ‰§è¡ŒæŸ¥è¯¢
async function getUsers() {
    try {
        const [rows] = await pool.execute(
            'SELECT * FROM users WHERE status = ?', 
            ['active']
        );
        return rows;
    } catch (error) {
        console.error('æŸ¥è¯¢ç”¨æˆ·å¤±è´¥:', error);
        throw error;
    }
}
```

**âš ï¸ å¸¸è§é”™è¯¯å¤„ç†**
```python
import mysql.connector
from mysql.connector import Error

def safe_database_operation():
    connection = None
    try:
        connection = mysql.connector.connect(
            host='localhost',
            database='testdb',
            user='username',
            password='password'
        )
        
        cursor = connection.cursor()
        cursor.execute("SELECT * FROM users")
        records = cursor.fetchall()
        
        return records
        
    except Error as e:
        # å…·ä½“é”™è¯¯å¤„ç†
        if e.errno == 1045:  # è®¤è¯å¤±è´¥
            print("âŒ æ•°æ®åº“ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯")
        elif e.errno == 2003:  # è¿æ¥å¤±è´¥
            print("âŒ æ— æ³•è¿æ¥åˆ°æ•°æ®åº“æœåŠ¡å™¨")
        else:
            print(f"âŒ æ•°æ®åº“é”™è¯¯: {e}")
        return None
        
    finally:
        # ç¡®ä¿èµ„æºé‡Šæ”¾
        if connection and connection.is_connected():
            cursor.close()
            connection.close()
```

---

## 5. ğŸš€ ç°ä»£APIæŠ€æœ¯æ ˆ


### 5.1 GraphQLæ•°æ®æŸ¥è¯¢æ¥å£


**ğŸ’¡ GraphQLç®€ä»‹**
GraphQLå°±åƒè‡ªåŠ©é¤å…ï¼Œä½ åªå–éœ€è¦çš„èœï¼ˆæ•°æ®å­—æ®µï¼‰ï¼Œä¸ç”¨åƒä¼ ç»ŸAPIé‚£æ ·æ‹¿åˆ°æ•´ä¸ªå¥—é¤ï¼ˆå®Œæ•´è®°å½•ï¼‰ã€‚

**ğŸ”¸ GraphQL vs RESTå¯¹æ¯”**
```
RESTæ–¹å¼ï¼š
GET /api/users/123        # è¿”å›ç”¨æˆ·å®Œæ•´ä¿¡æ¯
GET /api/users/123/posts  # å†è¯·æ±‚ç”¨æˆ·æ–‡ç« 
GET /api/posts/456/comments # å†è¯·æ±‚æ–‡ç« è¯„è®º

GraphQLæ–¹å¼ï¼š
query {
  user(id: 123) {
    name
    email
    posts {
      title
      comments {
        content
        author
      }
    }
  }
}
# ä¸€æ¬¡è¯·æ±‚è·å–æ‰€æœ‰éœ€è¦çš„æ•°æ®
```

**ğŸ› ï¸ GraphQL + MySQLå®ç°**
```javascript
const { GraphQLObjectType, GraphQLSchema, GraphQLInt, GraphQLString } = require('graphql');
const mysql = require('mysql2/promise');

// ç”¨æˆ·ç±»å‹å®šä¹‰
const UserType = new GraphQLObjectType({
  name: 'User',
  fields: {
    id: { type: GraphQLInt },
    name: { type: GraphQLString },
    email: { type: GraphQLString }
  }
});

// æŸ¥è¯¢æ ¹
const RootQuery = new GraphQLObjectType({
  name: 'RootQueryType',
  fields: {
    user: {
      type: UserType,
      args: { id: { type: GraphQLInt } },
      resolve: async (parent, args) => {
        const connection = await mysql.createConnection(dbConfig);
        const [rows] = await connection.execute(
          'SELECT * FROM users WHERE id = ?', 
          [args.id]
        );
        await connection.end();
        return rows[0];
      }
    }
  }
});

const schema = new GraphQLSchema({
  query: RootQuery
});
```

### 5.2 WebSocketå®æ—¶è¿æ¥


**ğŸ’¡ WebSocketåº”ç”¨åœºæ™¯**
WebSocketåƒç”µè¯é€šè¯ï¼ŒåŒæ–¹å¯ä»¥éšæ—¶è¯´è¯ï¼Œä¸åƒHTTPè¯·æ±‚éœ€è¦ä¸€é—®ä¸€ç­”ã€‚

**ğŸ”¸ å®æ—¶æ•°æ®æ¨é€åœºæ™¯**
- **å®æ—¶é€šçŸ¥**ï¼šæ–°è®¢å•ã€æ¶ˆæ¯æé†’
- **å®æ—¶ç›‘æ§**ï¼šç³»ç»ŸçŠ¶æ€ã€æ€§èƒ½æŒ‡æ ‡
- **åä½œåº”ç”¨**ï¼šå¤šäººç¼–è¾‘ã€åœ¨çº¿èŠå¤©

**ğŸ› ï¸ WebSocket + MySQLå®ç°**
```javascript
const WebSocket = require('ws');
const mysql = require('mysql2/promise');

const wss = new WebSocket.Server({ port: 8080 });

// ç›‘å¬æ•°æ®åº“å˜åŒ–ï¼ˆç®€åŒ–ç¤ºä¾‹ï¼‰
async function watchDatabase() {
    const connection = await mysql.createConnection(dbConfig);
    
    // æ¨¡æ‹Ÿç›‘å¬æ•°æ®å˜åŒ–
    setInterval(async () => {
        const [rows] = await connection.execute(
            'SELECT * FROM notifications WHERE sent = 0'
        );
        
        if (rows.length > 0) {
            // å‘æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯æ¨é€é€šçŸ¥
            wss.clients.forEach(client => {
                if (client.readyState === WebSocket.OPEN) {
                    client.send(JSON.stringify({
                        type: 'notification',
                        data: rows
                    }));
                }
            });
            
            // æ ‡è®°é€šçŸ¥å·²å‘é€
            await connection.execute(
                'UPDATE notifications SET sent = 1 WHERE sent = 0'
            );
        }
    }, 5000); // æ¯5ç§’æ£€æŸ¥ä¸€æ¬¡
}

wss.on('connection', (ws) => {
    console.log('å®¢æˆ·ç«¯å·²è¿æ¥');
    
    ws.on('message', (message) => {
        console.log('æ”¶åˆ°æ¶ˆæ¯:', message);
    });
});

watchDatabase();
```

### 5.3 gRPCé«˜æ€§èƒ½RPC


**ğŸ’¡ gRPCç‰¹ç‚¹**
gRPCåƒä¸“ä¸šçš„å¿«é€’æœåŠ¡ï¼Œç”¨äºŒè¿›åˆ¶æ‰“åŒ…æ•°æ®ï¼Œä¼ è¾“é€Ÿåº¦å¿«ï¼Œç‰¹åˆ«é€‚åˆæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ã€‚

**ğŸ”¸ gRPCä¼˜åŠ¿**
```
æ€§èƒ½å¯¹æ¯”ï¼š
HTTP/JSON APIï¼š     100ä¸ªè¯·æ±‚/ç§’
gRPCäºŒè¿›åˆ¶ï¼š       300ä¸ªè¯·æ±‚/ç§’
æ•°æ®å¤§å°ï¼š         gRPCæ¯”JSONå°40%
```

**ğŸ› ï¸ gRPCæœåŠ¡å®šä¹‰**
```protobuf
// user.proto
syntax = "proto3";

service UserService {
  rpc GetUser(GetUserRequest) returns (User);
  rpc CreateUser(CreateUserRequest) returns (User);
}

message User {
  int32 id = 1;
  string name = 2;
  string email = 3;
}

message GetUserRequest {
  int32 id = 1;
}
```

---

## 6. ğŸ”’ APIæ€§èƒ½ä¸å®‰å…¨


### 6.1 APIè®¤è¯æœºåˆ¶


**ğŸ” å¸¸è§è®¤è¯æ–¹å¼å¯¹æ¯”**

| è®¤è¯æ–¹å¼ | **å®‰å…¨çº§åˆ«** | **å®ç°å¤æ‚åº¦** | **é€‚ç”¨åœºæ™¯** |
|---------|------------|--------------|-------------|
| ğŸ”‘ **API Key** | `â­â­` | `ç®€å•` | `å†…éƒ¨æœåŠ¡è°ƒç”¨` |
| ğŸ« **JWT Token** | `â­â­â­` | `ä¸­ç­‰` | `Web/ç§»åŠ¨åº”ç”¨` |
| ğŸ›¡ï¸ **OAuth 2.0** | `â­â­â­â­` | `å¤æ‚` | `ç¬¬ä¸‰æ–¹é›†æˆ` |
| ğŸ”’ **mTLS** | `â­â­â­â­â­` | `å¾ˆå¤æ‚` | `å¾®æœåŠ¡é€šä¿¡` |

**ğŸ› ï¸ JWTè®¤è¯å®ç°**
```javascript
const jwt = require('jsonwebtoken');
const bcrypt = require('bcrypt');

// ç”¨æˆ·ç™»å½•
app.post('/api/login', async (req, res) => {
    const { email, password } = req.body;
    
    try {
        const connection = await mysql.createConnection(dbConfig);
        const [users] = await connection.execute(
            'SELECT * FROM users WHERE email = ?',
            [email]
        );
        
        if (users.length === 0) {
            return res.status(401).json({ error: 'ç”¨æˆ·ä¸å­˜åœ¨' });
        }
        
        const user = users[0];
        const validPassword = await bcrypt.compare(password, user.password);
        
        if (!validPassword) {
            return res.status(401).json({ error: 'å¯†ç é”™è¯¯' });
        }
        
        // ç”ŸæˆJWT token
        const token = jwt.sign(
            { userId: user.id, email: user.email },
            process.env.JWT_SECRET,
            { expiresIn: '24h' }
        );
        
        res.json({ token, user: { id: user.id, name: user.name, email: user.email } });
        
    } catch (error) {
        res.status(500).json({ error: 'ç™»å½•å¤±è´¥' });
    }
});

// JWTéªŒè¯ä¸­é—´ä»¶
const authenticateToken = (req, res, next) => {
    const authHeader = req.headers['authorization'];
    const token = authHeader && authHeader.split(' ')[1];
    
    if (!token) {
        return res.status(401).json({ error: 'ç¼ºå°‘è®¿é—®ä»¤ç‰Œ' });
    }
    
    jwt.verify(token, process.env.JWT_SECRET, (err, user) => {
        if (err) {
            return res.status(403).json({ error: 'ä»¤ç‰Œæ— æ•ˆ' });
        }
        req.user = user;
        next();
    });
};

// å—ä¿æŠ¤çš„APIæ¥å£
app.get('/api/profile', authenticateToken, (req, res) => {
    res.json({ message: `æ¬¢è¿ï¼Œç”¨æˆ·ID: ${req.user.userId}` });
});
```

### 6.2 æ¥å£æ€§èƒ½ä¼˜åŒ–


**âš¡ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥**
```
æ•°æ®åº“å±‚ä¼˜åŒ–ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŸ¥è¯¢ä¼˜åŒ–        â”‚ â† ä½¿ç”¨ç´¢å¼•ï¼Œé¿å…å…¨è¡¨æ‰«æ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¿æ¥æ± ç®¡ç†      â”‚ â† å¤ç”¨æ•°æ®åº“è¿æ¥
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¯»å†™åˆ†ç¦»        â”‚ â† ä¸»åº“å†™ï¼Œä»åº“è¯»
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åº”ç”¨å±‚ä¼˜åŒ–ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¼“å­˜æœºåˆ¶        â”‚ â† Redisç¼“å­˜çƒ­ç‚¹æ•°æ®
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ•°æ®åˆ†é¡µ        â”‚ â† å¤§ç»“æœé›†åˆ†é¡µè¿”å›
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¹¶å‘æ§åˆ¶        â”‚ â† é™åˆ¶åŒæ—¶å¤„ç†è¯·æ±‚æ•°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ› ï¸ ç¼“å­˜å®ç°ç¤ºä¾‹**
```javascript
const redis = require('redis');
const client = redis.createClient();

// å¸¦ç¼“å­˜çš„ç”¨æˆ·æŸ¥è¯¢
app.get('/api/users/:id', async (req, res) => {
    const userId = req.params.id;
    const cacheKey = `user:${userId}`;
    
    try {
        // å…ˆæŸ¥ç¼“å­˜
        const cachedUser = await client.get(cacheKey);
        if (cachedUser) {
            return res.json({ 
                success: true, 
                data: JSON.parse(cachedUser),
                source: 'cache' 
            });
        }
        
        // ç¼“å­˜æœªå‘½ä¸­ï¼ŒæŸ¥è¯¢æ•°æ®åº“
        const connection = await mysql.createConnection(dbConfig);
        const [users] = await connection.execute(
            'SELECT * FROM users WHERE id = ?',
            [userId]
        );
        await connection.end();
        
        if (users.length === 0) {
            return res.status(404).json({ error: 'ç”¨æˆ·ä¸å­˜åœ¨' });
        }
        
        const user = users[0];
        
        // å­˜å…¥ç¼“å­˜ï¼Œ5åˆ†é’Ÿè¿‡æœŸ
        await client.setex(cacheKey, 300, JSON.stringify(user));
        
        res.json({ 
            success: true, 
            data: user,
            source: 'database' 
        });
        
    } catch (error) {
        res.status(500).json({ error: 'æŸ¥è¯¢å¤±è´¥' });
    }
});
```

### 6.3 APIé™æµç†”æ–­æœºåˆ¶


**ğŸš¦ é™æµç­–ç•¥**
```
ä»¤ç‰Œæ¡¶ç®—æ³•ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ä»¤ç‰Œæ¡¶       â”‚ â† å›ºå®šé€Ÿç‡äº§ç”Ÿä»¤ç‰Œ
â”‚   [ğŸª™ğŸª™ğŸª™ğŸª™]    â”‚   æ¯ä¸ªè¯·æ±‚æ¶ˆè€—ä¸€ä¸ªä»¤ç‰Œ
â”‚                 â”‚   ä»¤ç‰Œç”¨å®Œåˆ™æ‹’ç»è¯·æ±‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ»‘åŠ¨çª—å£ç®—æ³•ï¼š
æ—¶é—´: |--1åˆ†é’Ÿ--||--1åˆ†é’Ÿ--||--1åˆ†é’Ÿ--|
è¯·æ±‚: [100ä¸ª]    [80ä¸ª]     [120ä¸ª] â† è¶…å‡ºé™åˆ¶
```

**ğŸ› ï¸ é™æµå®ç°**
```javascript
const rateLimit = require('express-rate-limit');
const slowDown = require('express-slow-down');

// APIé™æµä¸­é—´ä»¶
const apiLimiter = rateLimit({
    windowMs: 15 * 60 * 1000, // 15åˆ†é’Ÿ
    max: 100,                 // æœ€å¤š100ä¸ªè¯·æ±‚
    message: 'è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•',
    standardHeaders: true,
    legacyHeaders: false
});

// æ¸è¿›å¼å‡é€Ÿ
const speedLimiter = slowDown({
    windowMs: 15 * 60 * 1000, // 15åˆ†é’Ÿ
    delayAfter: 50,           // 50ä¸ªè¯·æ±‚åå¼€å§‹å»¶è¿Ÿ
    delayMs: 500              // æ¯ä¸ªè¯·æ±‚å»¶è¿Ÿ500ms
});

// åº”ç”¨é™æµ
app.use('/api/', apiLimiter);
app.use('/api/', speedLimiter);

// ç†”æ–­å™¨å®ç°
class CircuitBreaker {
    constructor(threshold = 5, timeout = 60000) {
        this.threshold = threshold;  // å¤±è´¥é˜ˆå€¼
        this.timeout = timeout;      // ç†”æ–­è¶…æ—¶
        this.failureCount = 0;       // å¤±è´¥è®¡æ•°
        this.state = 'CLOSED';       // çŠ¶æ€ï¼šCLOSED/OPEN/HALF_OPEN
        this.nextAttempt = Date.now();
    }
    
    async call(fn) {
        if (this.state === 'OPEN') {
            if (Date.now() < this.nextAttempt) {
                throw new Error('ç†”æ–­å™¨å¼€å¯ï¼ŒæœåŠ¡ä¸å¯ç”¨');
            }
            this.state = 'HALF_OPEN';
        }
        
        try {
            const result = await fn();
            this.onSuccess();
            return result;
        } catch (error) {
            this.onFailure();
            throw error;
        }
    }
    
    onSuccess() {
        this.failureCount = 0;
        this.state = 'CLOSED';
    }
    
    onFailure() {
        this.failureCount++;
        if (this.failureCount >= this.threshold) {
            this.state = 'OPEN';
            this.nextAttempt = Date.now() + this.timeout;
        }
    }
}

// ä½¿ç”¨ç†”æ–­å™¨ä¿æŠ¤æ•°æ®åº“æŸ¥è¯¢
const dbBreaker = new CircuitBreaker(3, 30000);

app.get('/api/protected-endpoint', async (req, res) => {
    try {
        const result = await dbBreaker.call(async () => {
            const connection = await mysql.createConnection(dbConfig);
            const [rows] = await connection.execute('SELECT * FROM sensitive_data');
            await connection.end();
            return rows;
        });
        
        res.json({ success: true, data: result });
    } catch (error) {
        res.status(503).json({ error: 'æœåŠ¡æš‚æ—¶ä¸å¯ç”¨' });
    }
});
```

---

## 7. ğŸ“Š APIç®¡ç†ä¸ç›‘æ§


### 7.1 å¾®æœåŠ¡APIç½‘å…³é›†æˆ


**ğŸ’¡ APIç½‘å…³ä½œç”¨**
APIç½‘å…³å°±åƒå¤§æ¥¼çš„å‰å°æ¥å¾…ï¼Œæ‰€æœ‰è®¿å®¢ï¼ˆè¯·æ±‚ï¼‰éƒ½è¦å…ˆåˆ°å‰å°ç™»è®°ï¼Œç„¶åå¼•å¯¼åˆ°æ­£ç¡®çš„éƒ¨é—¨ï¼ˆæœåŠ¡ï¼‰ã€‚

```
æ²¡æœ‰ç½‘å…³çš„æ¶æ„ï¼š
å®¢æˆ·ç«¯ â”€â”€â”¬â”€â”€ ç”¨æˆ·æœåŠ¡ (ç«¯å£8001)
         â”œâ”€â”€ è®¢å•æœåŠ¡ (ç«¯å£8002)
         â”œâ”€â”€ æ”¯ä»˜æœåŠ¡ (ç«¯å£8003)
         â””â”€â”€ å•†å“æœåŠ¡ (ç«¯å£8004)

æœ‰ç½‘å…³çš„æ¶æ„ï¼š
å®¢æˆ·ç«¯ â”€â”€ APIç½‘å…³ â”€â”€â”¬â”€â”€ ç”¨æˆ·æœåŠ¡
                   â”œâ”€â”€ è®¢å•æœåŠ¡
                   â”œâ”€â”€ æ”¯ä»˜æœåŠ¡
                   â””â”€â”€ å•†å“æœåŠ¡
```

**ğŸ› ï¸ Kongç½‘å…³é…ç½®ç¤ºä¾‹**
```yaml
# kong.yml é…ç½®æ–‡ä»¶
services:
  - name: user-service
    url: http://localhost:8001
    routes:
      - name: user-routes
        paths:
          - /api/users
        
  - name: order-service
    url: http://localhost:8002
    routes:
      - name: order-routes
        paths:
          - /api/orders

plugins:
  - name: rate-limiting
    config:
      minute: 100
      hour: 1000
      
  - name: jwt
    config:
      secret_is_base64: false
      
  - name: cors
    config:
      origins: ['*']
      methods: ['GET', 'POST', 'PUT', 'DELETE']
```

### 7.2 OpenAPI/Swaggeræ–‡æ¡£è§„èŒƒ


**ğŸ“š APIæ–‡æ¡£çš„é‡è¦æ€§**
APIæ–‡æ¡£å°±åƒäº§å“è¯´æ˜ä¹¦ï¼Œå‘Šè¯‰å¼€å‘è€…å¦‚ä½•ä½¿ç”¨ä½ çš„APIæ¥å£ã€‚

**ğŸ› ï¸ Swaggeræ–‡æ¡£ç”Ÿæˆ**
```javascript
const swaggerJsdoc = require('swagger-jsdoc');
const swaggerUi = require('swagger-ui-express');

const options = {
  definition: {
    openapi: '3.0.0',
    info: {
      title: 'MySQL APIæ¥å£æ–‡æ¡£',
      version: '1.0.0',
      description: 'ç”¨æˆ·ç®¡ç†APIæ¥å£'
    },
    servers: [
      {
        url: 'http://localhost:3000',
        description: 'å¼€å‘æœåŠ¡å™¨'
      }
    ]
  },
  apis: ['./routes/*.js']
};

const specs = swaggerJsdoc(options);
app.use('/api-docs', swaggerUi.serve, swaggerUi.setup(specs));

/**
 * @swagger
 * /api/users:
 *   get:
 *     summary: è·å–ç”¨æˆ·åˆ—è¡¨
 *     tags: [ç”¨æˆ·ç®¡ç†]
 *     parameters:
 *       - in: query
 *         name: page
 *         schema:
 *           type: integer
 *         description: é¡µç 
 *     responses:
 *       200:
 *         description: æˆåŠŸè¿”å›ç”¨æˆ·åˆ—è¡¨
 *         content:
 *           application/json:
 *             schema:
 *               type: object
 *               properties:
 *                 success:
 *                   type: boolean
 *                 data:
 *                   type: array
 *                   items:
 *                     type: object
 *                     properties:
 *                       id:
 *                         type: integer
 *                       name:
 *                         type: string
 *                       email:
 *                         type: string
 */
app.get('/api/users', async (req, res) => {
  // APIå®ç°ä»£ç 
});
```

### 7.3 APIç‰ˆæœ¬ç®¡ç†ç­–ç•¥


**ğŸ”„ ç‰ˆæœ¬æ§åˆ¶æ–¹å¼å¯¹æ¯”**

| æ–¹å¼ | **ç¤ºä¾‹** | **ä¼˜ç‚¹** | **ç¼ºç‚¹** |
|-----|---------|---------|---------|
| ğŸŒ **URLè·¯å¾„** | `/api/v1/users` | `æ¸…æ™°ç›´è§‚` | `URLå†—é•¿` |
| ğŸ“‹ **è¯·æ±‚å¤´** | `Accept: application/vnd.api+json;version=1` | `URLç®€æ´` | `ä¸å¤Ÿç›´è§‚` |
| ğŸ”— **æŸ¥è¯¢å‚æ•°** | `/api/users?version=1` | `ç®€å•æ˜“ç”¨` | `å®¹æ˜“å¿½ç•¥` |

**ğŸ› ï¸ ç‰ˆæœ¬ç®¡ç†å®ç°**
```javascript
// ç‰ˆæœ¬è·¯ç”±ç®¡ç†
const express = require('express');
const app = express();

// V1ç‰ˆæœ¬è·¯ç”±
const v1Router = express.Router();
v1Router.get('/users', (req, res) => {
    res.json({
        version: '1.0',
        message: 'è¿™æ˜¯V1ç‰ˆæœ¬çš„ç”¨æˆ·æ¥å£',
        data: []
    });
});

// V2ç‰ˆæœ¬è·¯ç”±ï¼ˆå¢åŠ äº†æ–°å­—æ®µï¼‰
const v2Router = express.Router();
v2Router.get('/users', (req, res) => {
    res.json({
        version: '2.0',
        message: 'è¿™æ˜¯V2ç‰ˆæœ¬çš„ç”¨æˆ·æ¥å£',
        data: [],
        metadata: {
            total: 0,
            page: 1,
            pageSize: 10
        }
    });
});

// æ³¨å†Œç‰ˆæœ¬è·¯ç”±
app.use('/api/v1', v1Router);
app.use('/api/v2', v2Router);

// é»˜è®¤ç‰ˆæœ¬ï¼ˆæœ€æ–°ç‰ˆæœ¬ï¼‰
app.use('/api', v2Router);

// ç‰ˆæœ¬å¼ƒç”¨æé†’ä¸­é—´ä»¶
const deprecationWarning = (version, deprecatedDate, removalDate) => {
    return (req, res, next) => {
        res.set({
            'X-API-Version': version,
            'X-API-Deprecated': 'true',
            'X-API-Deprecated-Date': deprecatedDate,
            'X-API-Removal-Date': removalDate,
            'Warning': `299 - "APIç‰ˆæœ¬ ${version} å·²å¼ƒç”¨ï¼Œå°†åœ¨ ${removalDate} ç§»é™¤"`
        });
        next();
    };
};

// å¯¹V1ç‰ˆæœ¬æ·»åŠ å¼ƒç”¨è­¦å‘Š
app.use('/api/v1', deprecationWarning('1.0', '2025-01-01', '2025-12-31'));
```

### 7.4 APIç›‘æ§å‘Šè­¦ä½“ç³»


**ğŸ“Š ç›‘æ§æŒ‡æ ‡ä½“ç³»**
```
æ ¸å¿ƒæŒ‡æ ‡ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å“åº”æ—¶é—´(RT)    â”‚ â† å¹³å‡å“åº”æ—¶é—´ã€P95ã€P99
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ååé‡(TPS)     â”‚ â† æ¯ç§’å¤„ç†è¯·æ±‚æ•°
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é”™è¯¯ç‡          â”‚ â† 4xxã€5xxé”™è¯¯å æ¯”
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¯ç”¨æ€§          â”‚ â† ç³»ç»Ÿæ­£å¸¸è¿è¡Œæ—¶é—´
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¸šåŠ¡æŒ‡æ ‡ï¼š
â€¢ ç”¨æˆ·æ´»è·ƒåº¦
â€¢ æ¥å£è°ƒç”¨åˆ†å¸ƒ
â€¢ æ•°æ®åº“è¿æ¥æ± ä½¿ç”¨ç‡
â€¢ ç¼“å­˜å‘½ä¸­ç‡
```

**ğŸ› ï¸ ç›‘æ§å®ç°**
```javascript
const prometheus = require('prom-client');

// åˆ›å»ºç›‘æ§æŒ‡æ ‡
const httpRequestDuration = new prometheus.Histogram({
    name: 'http_request_duration_seconds',
    help: 'HTTPè¯·æ±‚å¤„ç†æ—¶é—´',
    labelNames: ['method', 'route', 'status_code']
});

const httpRequestTotal = new prometheus.Counter({
    name: 'http_requests_total',
    help: 'HTTPè¯·æ±‚æ€»æ•°',
    labelNames: ['method', 'route', 'status_code']
});

const mysqlConnectionPool = new prometheus.Gauge({
    name: 'mysql_connection_pool_size',
    help: 'MySQLè¿æ¥æ± å¤§å°'
});

// ç›‘æ§ä¸­é—´ä»¶
const monitoringMiddleware = (req, res, next) => {
    const start = Date.now();
    
    res.on('finish', () => {
        const duration = (Date.now() - start) / 1000;
        const labels = {
            method: req.method,
            route: req.route ? req.route.path : req.path,
            status_code: res.statusCode
        };
        
        httpRequestDuration.labels(labels).observe(duration);
        httpRequestTotal.labels(labels).inc();
    });
    
    next();
};

app.use(monitoringMiddleware);

// Prometheusç›‘æ§ç«¯ç‚¹
app.get('/metrics', async (req, res) => {
    res.set('Content-Type', prometheus.register.contentType);
    res.end(await prometheus.register.metrics());
});

// å¥åº·æ£€æŸ¥æ¥å£
app.get('/health', async (req, res) => {
    const health = {
        status: 'ok',
        timestamp: new Date().toISOString(),
        uptime: process.uptime(),
        memory: process.memoryUsage()
    };
    
    try {
        // æ£€æŸ¥æ•°æ®åº“è¿æ¥
        const connection = await mysql.createConnection(dbConfig);
        await connection.ping();
        await connection.end();
        health.database = 'connected';
    } catch (error) {
        health.database = 'disconnected';
        health.status = 'error';
    }
    
    const statusCode = health.status === 'ok' ? 200 : 503;
    res.status(statusCode).json(health);
});
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ APIæ¥å£æœ¬è´¨ï¼šåº”ç”¨ä¸æ•°æ®åº“ä¹‹é—´çš„æ¡¥æ¢ï¼Œæä¾›æ ‡å‡†åŒ–æ•°æ®è®¿é—®
ğŸ”¸ RESTåŸåˆ™ï¼šèµ„æºå¯¼å‘ï¼Œç»Ÿä¸€æ¥å£ï¼Œæ— çŠ¶æ€é€šä¿¡
ğŸ”¸ X DevAPIï¼šMySQLæ–°ä¸€ä»£APIï¼Œæ”¯æŒæ–‡æ¡£å’Œå…³ç³»æ•°æ®æ··åˆå­˜å‚¨
ğŸ”¸ Connectoré©±åŠ¨ï¼šä¸åŒç¼–ç¨‹è¯­è¨€è®¿é—®MySQLçš„ç¿»è¯‘å®˜
ğŸ”¸ ç°ä»£æŠ€æœ¯æ ˆï¼šGraphQLã€WebSocketã€gRPCå„æœ‰é€‚ç”¨åœºæ™¯
```

### 8.2 å…³é”®æŠ€æœ¯é€‰æ‹©æŒ‡å—


**ğŸ”¹ APIç±»å‹é€‰æ‹©**
```
é€‰æ‹©REST APIï¼š
âœ… ç®€å•çš„CRUDæ“ä½œ
âœ… Webåº”ç”¨æ ‡å‡†æ¥å£
âœ… å›¢é˜ŸæŠ€æœ¯æ ˆæˆç†Ÿ

é€‰æ‹©GraphQLï¼š
âœ… éœ€è¦çµæ´»æŸ¥è¯¢
âœ… ç§»åŠ¨åº”ç”¨çœæµé‡
âœ… å‰ç«¯ä¸»å¯¼å¼€å‘

é€‰æ‹©gRPCï¼š
âœ… å¾®æœåŠ¡é—´é€šä¿¡
âœ… é«˜æ€§èƒ½è¦æ±‚
âœ… ç±»å‹å®‰å…¨é‡è¦
```

**ğŸ”¹ è®¤è¯æ–¹å¼é€‰æ‹©**
```
å†…éƒ¨æœåŠ¡ï¼šAPI Keyï¼ˆç®€å•ï¼‰
Webåº”ç”¨ï¼šJWT Tokenï¼ˆæ ‡å‡†ï¼‰
ç¬¬ä¸‰æ–¹é›†æˆï¼šOAuth 2.0ï¼ˆå®‰å…¨ï¼‰
å¾®æœåŠ¡ï¼šmTLSï¼ˆæœ€å®‰å…¨ï¼‰
```

### 8.3 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


**âš¡ ä¼˜åŒ–å±‚æ¬¡**
```
æ•°æ®åº“å±‚ï¼š
â€¢ åˆç†ä½¿ç”¨ç´¢å¼•
â€¢ è¿æ¥æ± ç®¡ç†
â€¢ è¯»å†™åˆ†ç¦»

åº”ç”¨å±‚ï¼š
â€¢ ç¼“å­˜çƒ­ç‚¹æ•°æ®
â€¢ æ•°æ®åˆ†é¡µè¿”å›
â€¢ å¼‚æ­¥å¤„ç†

ç½‘å…³å±‚ï¼š
â€¢ é™æµç†”æ–­
â€¢ è´Ÿè½½å‡è¡¡
â€¢ ç»Ÿä¸€è®¤è¯
```

### 8.4 å®é™…åº”ç”¨å»ºè®®


**ğŸ¯ å¼€å‘é˜¶æ®µå»ºè®®**
- **åŸå‹é˜¶æ®µ**ï¼šä½¿ç”¨REST APIå¿«é€Ÿæ„å»º
- **æ€§èƒ½ä¼˜åŒ–**ï¼šå¼•å…¥ç¼“å­˜å’Œè¿æ¥æ± 
- **è§„æ¨¡æ‰©å±•**ï¼šè€ƒè™‘å¾®æœåŠ¡æ¶æ„å’ŒAPIç½‘å…³
- **è¿ç»´ç›‘æ§**ï¼šå®Œå–„ç›‘æ§å‘Šè­¦ä½“ç³»

**âš ï¸ å¸¸è§é™·é˜±é¿å…**
```
âŒ N+1æŸ¥è¯¢é—®é¢˜ï¼šä¸€æ¬¡æŸ¥è¯¢å¼•å‘å¤šæ¬¡æ•°æ®åº“è®¿é—®
âŒ ç¼ºå°‘é™æµä¿æŠ¤ï¼šæ¥å£è¢«æ¶æ„åˆ·é‡
âŒ æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼šé”™è¯¯å“åº”æš´éœ²ç³»ç»Ÿç»†èŠ‚
âŒ ç‰ˆæœ¬ç®¡ç†æ··ä¹±ï¼šä¸å…¼å®¹å˜æ›´å¯¼è‡´ç³»ç»Ÿæ•…éšœ
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- APIæ¥å£æ˜¯ç°ä»£åº”ç”¨çš„æ•°æ®è®¿é—®æ ‡å‡†
- é€‰æ‹©åˆé€‚çš„æŠ€æœ¯æ ˆæ¯”è¿½æ±‚æœ€æ–°æŠ€æœ¯æ›´é‡è¦
- å®‰å…¨æ€§å’Œæ€§èƒ½éœ€è¦ä»è®¾è®¡é˜¶æ®µå°±è€ƒè™‘
- å®Œå–„çš„ç›‘æ§ä½“ç³»æ˜¯ç”Ÿäº§ç¯å¢ƒå¿…éœ€å“