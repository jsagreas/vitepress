---
title: 4ã€ç›‘æ§è¯Šæ–­å·¥å…·
---
## ğŸ“š ç›®å½•

1. [ç›‘æ§è¯Šæ–­å·¥å…·æ¦‚è¿°](#1-ç›‘æ§è¯Šæ–­å·¥å…·æ¦‚è¿°)
2. [ä¸“ä¸šç›‘æ§å¹³å°](#2-ä¸“ä¸šç›‘æ§å¹³å°)
3. [å¼€æºç›‘æ§è§£å†³æ–¹æ¡ˆ](#3-å¼€æºç›‘æ§è§£å†³æ–¹æ¡ˆ)
4. [MySQLå†…ç½®ç›‘æ§å·¥å…·](#4-MySQLå†…ç½®ç›‘æ§å·¥å…·)
5. [äº‘ç«¯ç›‘æ§æœåŠ¡](#5-äº‘ç«¯ç›‘æ§æœåŠ¡)
6. [ä¼ä¸šçº§ç›‘æ§è§£å†³æ–¹æ¡ˆ](#6-ä¼ä¸šçº§ç›‘æ§è§£å†³æ–¹æ¡ˆ)
7. [ç›‘æ§å·¥å…·é€‰æ‹©æŒ‡å—](#7-ç›‘æ§å·¥å…·é€‰æ‹©æŒ‡å—)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” ç›‘æ§è¯Šæ–­å·¥å…·æ¦‚è¿°


### 1.1 ä¸ºä»€ä¹ˆéœ€è¦MySQLç›‘æ§


**ç›‘æ§çš„æ ¸å¿ƒä»·å€¼**ï¼š
```
æ•°æ®åº“ç›‘æ§å°±åƒæ±½è½¦çš„ä»ªè¡¨ç›˜
æ²¡æœ‰ä»ªè¡¨ç›˜ï¼Œä½ ä¸çŸ¥é“ï¼š
- æ²¹è¿˜å‰©å¤šå°‘ï¼ˆç£ç›˜ç©ºé—´ï¼‰
- å‘åŠ¨æœºè½¬é€Ÿå¦‚ä½•ï¼ˆCPUä½¿ç”¨ç‡ï¼‰
- æ°´æ¸©æ˜¯å¦æ­£å¸¸ï¼ˆå†…å­˜ä½¿ç”¨æƒ…å†µï¼‰
- æ˜¯å¦æœ‰æ•…éšœé¢„è­¦ï¼ˆé”™è¯¯æ—¥å¿—ï¼‰
```

**ç›‘æ§è§£å†³çš„é—®é¢˜**ï¼š
- **æ€§èƒ½é—®é¢˜**ï¼šSQLæ‰§è¡Œæ…¢ã€è¿æ¥æ•°è¿‡å¤š
- **å®¹é‡é—®é¢˜**ï¼šç£ç›˜ç©ºé—´ä¸è¶³ã€å†…å­˜ä¸å¤Ÿ
- **å¯ç”¨æ€§é—®é¢˜**ï¼šæœåŠ¡å®•æœºã€ä¸»ä»å»¶è¿Ÿ
- **å®‰å…¨é—®é¢˜**ï¼šå¼‚å¸¸ç™»å½•ã€æƒé™æ»¥ç”¨

### 1.2 ç›‘æ§çš„æ ¸å¿ƒæŒ‡æ ‡


```
ğŸ“Š å…³é”®ç›‘æ§æŒ‡æ ‡åˆ†ç±»

ğŸ”¸ æ€§èƒ½æŒ‡æ ‡
â€¢ QPS/TPSï¼šæ¯ç§’æŸ¥è¯¢æ•°/äº‹åŠ¡æ•°
â€¢ å“åº”æ—¶é—´ï¼šæŸ¥è¯¢æ‰§è¡Œæ—¶é•¿
â€¢ è¿æ¥æ•°ï¼šå½“å‰æ´»è·ƒè¿æ¥
â€¢ ç¼“å­˜å‘½ä¸­ç‡ï¼šInnoDBç¼“å†²æ± æ•ˆç‡

ğŸ”¸ èµ„æºæŒ‡æ ‡  
â€¢ CPUä½¿ç”¨ç‡ï¼šå¤„ç†å™¨è´Ÿè½½
â€¢ å†…å­˜ä½¿ç”¨ï¼šç¼“å†²æ± ã€ä¸´æ—¶è¡¨å ç”¨
â€¢ ç£ç›˜I/Oï¼šè¯»å†™é€Ÿåº¦ã€IOPS
â€¢ ç½‘ç»œæµé‡ï¼šæ•°æ®ä¼ è¾“é‡

ğŸ”¸ å¯ç”¨æ€§æŒ‡æ ‡
â€¢ æœåŠ¡çŠ¶æ€ï¼šè¿è¡Œ/åœæ­¢
â€¢ ä¸»ä»çŠ¶æ€ï¼šå¤åˆ¶å»¶è¿Ÿã€åŒæ­¥çŠ¶æ€
â€¢ é”™è¯¯ç‡ï¼šè¿æ¥å¤±è´¥ã€æŸ¥è¯¢é”™è¯¯
â€¢ æ…¢æŸ¥è¯¢ï¼šæ‰§è¡Œæ—¶é—´è¶…è¿‡é˜ˆå€¼çš„SQL
```

### 1.3 ç›‘æ§å·¥å…·çš„åˆ†ç±»


```
æŒ‰åŠŸèƒ½åˆ†ç±»ï¼š
â”Œâ”€ æ€§èƒ½ç›‘æ§ â”€â”€â”€â”€ PMMã€Grafana
â”œâ”€ æ—¥å¿—åˆ†æ â”€â”€â”€â”€ ELK Stack  
â”œâ”€ å‘Šè­¦é€šçŸ¥ â”€â”€â”€â”€ Zabbixã€Nagios
â””â”€ ç»¼åˆå¹³å° â”€â”€â”€â”€ Enterprise Monitor

æŒ‰éƒ¨ç½²æ–¹å¼ï¼š
â”Œâ”€ è‡ªå»ºç›‘æ§ â”€â”€â”€â”€ Prometheus + Grafana
â”œâ”€ æ‰˜ç®¡æœåŠ¡ â”€â”€â”€â”€ New Relicã€Datadog
â””â”€ äº‘ç«¯ç›‘æ§ â”€â”€â”€â”€ AWS RDSç›‘æ§ã€é˜¿é‡Œäº‘ç›‘æ§

æŒ‰æˆæœ¬è€ƒè™‘ï¼š
â”Œâ”€ å…è´¹å¼€æº â”€â”€â”€â”€ Zabbixã€Prometheus
â”œâ”€ å•†ä¸šä»˜è´¹ â”€â”€â”€â”€ Enterprise Monitor
â””â”€ äº‘æœåŠ¡æŒ‰é‡ â”€ SaaSç›‘æ§å¹³å°
```

---

## 2. ğŸš€ ä¸“ä¸šç›‘æ§å¹³å°


### 2.1 PMMç›‘æ§å¹³å°ï¼ˆPercona Monitoring and Managementï¼‰


**PMMç®€ä»‹**ï¼š
PMMæ˜¯Perconaå…¬å¸å¼€å‘çš„**å…è´¹å¼€æº**æ•°æ®åº“ç›‘æ§å¹³å°ï¼Œä¸“é—¨ä¸ºMySQLã€PostgreSQLã€MongoDBè®¾è®¡ã€‚

```
PMMæ¶æ„å›¾ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PMM Client    â”‚â”€â”€â”€â–¶â”‚   PMM Server    â”‚
â”‚                 â”‚    â”‚                 â”‚
â”‚ â€¢ Node Exporter â”‚    â”‚ â€¢ Grafanaé¢æ¿   â”‚
â”‚ â€¢ MySQL Export  â”‚    â”‚ â€¢ Prometheus    â”‚  
â”‚ â€¢ Query Analyt  â”‚    â”‚ â€¢ ClickHouse    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       æ•°æ®åº“ç«¯              ç›‘æ§æœåŠ¡ç«¯
```

**PMMæ ¸å¿ƒåŠŸèƒ½**ï¼š
- **æ€§èƒ½ç›‘æ§**ï¼šå®æ—¶æŸ¥çœ‹QPSã€å“åº”æ—¶é—´ã€è¿æ¥æ•°
- **æ…¢æŸ¥è¯¢åˆ†æ**ï¼šè‡ªåŠ¨æ•è·å¹¶åˆ†ææ…¢SQL
- **æŸ¥è¯¢æ€§èƒ½æ´å¯Ÿ**ï¼šè¯†åˆ«æ€§èƒ½ç“¶é¢ˆSQL
- **æœåŠ¡å™¨ç›‘æ§**ï¼šCPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œç›‘æ§

**å¿«é€Ÿéƒ¨ç½²PMM**ï¼š
```bash
# 1. éƒ¨ç½²PMM Serverï¼ˆDockeræ–¹å¼ï¼‰
docker run -d \
  -p 80:80 \
  -p 443:443 \
  --name pmm-server \
  percona/pmm-server:2

# 2. åœ¨æ•°æ®åº“æœåŠ¡å™¨å®‰è£…PMM Client
wget https://www.percona.com/downloads/pmm2/PMM_CLIENT_VERSION/pmm2-client-VERSION.tar.gz
tar xzf pmm2-client-VERSION.tar.gz
sudo ./install

# 3. æ³¨å†ŒMySQLæœåŠ¡åˆ°PMM
pmm-admin add mysql \
  --username=pmm_user \
  --password=pmm_pass \
  mysql-server-01
```

**PMMä¼˜åŠ¿**ï¼š
- âœ… **å®Œå…¨å…è´¹**ï¼šæ— ä»»ä½•ä½¿ç”¨é™åˆ¶
- âœ… **ä¸“ä¸šæ€§å¼º**ï¼šä¸“é—¨ä¸ºæ•°æ®åº“è®¾è®¡
- âœ… **éƒ¨ç½²ç®€å•**ï¼šDockerä¸€é”®éƒ¨ç½²
- âœ… **åŠŸèƒ½å®Œæ•´**ï¼šç›‘æ§+åˆ†æ+å‘Šè­¦

### 2.2 Perconaç›‘æ§å’Œç®¡ç†PMM2


**PMM2æ–°ç‰¹æ€§**ï¼š
PMM2æ˜¯PMMçš„å‡çº§ç‰ˆï¼Œé‡‡ç”¨ç°ä»£åŒ–æ¶æ„ï¼Œæä¾›æ›´å¼ºå¤§çš„åŠŸèƒ½ã€‚

```
PMM2 vs PMM1å¯¹æ¯”ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ç‰¹æ€§      â”‚     PMM1      â”‚     PMM2      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åç«¯å­˜å‚¨    â”‚   MySQL       â”‚  ClickHouse   â”‚
â”‚  ç•Œé¢æ¡†æ¶    â”‚   Grafana 4   â”‚   Grafana 7+  â”‚
â”‚  æŸ¥è¯¢åˆ†æ    â”‚   åŸºç¡€ç‰ˆæœ¬    â”‚   å¢å¼ºç‰ˆæœ¬    â”‚
â”‚  å‘Šè­¦åŠŸèƒ½    â”‚   æœ‰é™        â”‚   å®Œæ•´æ”¯æŒ    â”‚
â”‚  APIæ¥å£     â”‚   æœ‰é™        â”‚   RESTful API â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**PMM2æ ¸å¿ƒé¢æ¿**ï¼š
- **MySQLæ¦‚è§ˆ**ï¼šæ•´ä½“æ€§èƒ½æŒ‡æ ‡
- **MySQLå®ä¾‹æ‘˜è¦**ï¼šå•å®ä¾‹è¯¦ç»†ä¿¡æ¯  
- **MySQLå¤åˆ¶**ï¼šä¸»ä»å¤åˆ¶çŠ¶æ€
- **MySQLç»„å¤åˆ¶**ï¼šMGRé›†ç¾¤ç›‘æ§
- **æŸ¥è¯¢åˆ†æ**ï¼šæ…¢æŸ¥è¯¢TOPæ’è¡Œ

**å®é™…ä½¿ç”¨ç¤ºä¾‹**ï¼š
```sql
-- åˆ›å»ºPMMç›‘æ§ç”¨æˆ·
CREATE USER 'pmm'@'localhost' IDENTIFIED BY 'pmm_password';
GRANT SELECT, PROCESS, REPLICATION CLIENT ON *.* TO 'pmm'@'localhost';
FLUSH PRIVILEGES;
```

---

## 3. ğŸ”§ å¼€æºç›‘æ§è§£å†³æ–¹æ¡ˆ


### 3.1 Zabbix MySQLç›‘æ§


**Zabbixç›‘æ§æ¶æ„**ï¼š
Zabbixæ˜¯ä¼ä¸šçº§å¼€æºç›‘æ§è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡Agenté‡‡é›†MySQLæŒ‡æ ‡ã€‚

```
Zabbixç›‘æ§æµç¨‹ï¼š
MySQLæœåŠ¡å™¨ â”€â”€â”€â–¶ Zabbix Agent â”€â”€â”€â–¶ Zabbix Server â”€â”€â”€â–¶ Webç•Œé¢
     â”‚              â”‚                    â”‚                â”‚
     â”‚          æ”¶é›†æŒ‡æ ‡            å¤„ç†æ•°æ®          å±•ç¤ºå›¾è¡¨
     â””â”€ Performance Schema â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç›‘æ§é…ç½®æ­¥éª¤**ï¼š
```bash
# 1. å®‰è£…Zabbix Agent
yum install zabbix-agent

# 2. é…ç½®MySQLç›‘æ§é¡¹
cat >> /etc/zabbix/zabbix_agentd.conf << EOF
UserParameter=mysql.status[*],mysqladmin -uroot -p'password' extended-status | grep -w "\$1" | cut -d"|" -f3
UserParameter=mysql.ping,mysqladmin -uroot -p'password' ping | grep -c alive
EOF

# 3. é‡å¯Agent
systemctl restart zabbix-agent
```

**æ ¸å¿ƒç›‘æ§é¡¹**ï¼š
- **è¿æ¥ç›‘æ§**ï¼š`Threads_connected`ã€`Threads_running`
- **æŸ¥è¯¢ç›‘æ§**ï¼š`Questions`ã€`Queries per second`  
- **ç¼“å­˜ç›‘æ§**ï¼š`Innodb_buffer_pool_read_requests`
- **æ…¢æŸ¥è¯¢**ï¼š`Slow_queries`

### 3.2 Prometheus + Grafanaç›‘æ§


**ç›‘æ§æ¶æ„å›¾**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MySQL     â”‚â”€â”€â”€â–¶â”‚ MySQL       â”‚â”€â”€â”€â–¶â”‚ Prometheus  â”‚
â”‚   Server    â”‚    â”‚ Exporter    â”‚    â”‚   Server    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚   Grafana   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  Dashboard  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**MySQL Exporteréƒ¨ç½²**ï¼š
```bash
# 1. ä¸‹è½½MySQL Exporter
wget https://github.com/prometheus/mysqld_exporter/releases/download/v0.14.0/mysqld_exporter-0.14.0.linux-amd64.tar.gz

# 2. åˆ›å»ºç›‘æ§ç”¨æˆ·
mysql -u root -p << EOF
CREATE USER 'mysql_exporter'@'localhost' IDENTIFIED BY 'password';
GRANT PROCESS, REPLICATION CLIENT, SELECT ON *.* TO 'mysql_exporter'@'localhost';
FLUSH PRIVILEGES;
EOF

# 3. é…ç½®è¿æ¥ä¿¡æ¯
cat > ~/.my.cnf << EOF
[client]
user=mysql_exporter
password=password
host=localhost
port=3306
EOF

# 4. å¯åŠ¨Exporter
./mysqld_exporter --config.my-cnf=~/.my.cnf
```

**Grafanaä»ªè¡¨æ¿**ï¼š
```json
{
  "dashboard": {
    "title": "MySQLæ€§èƒ½ç›‘æ§",
    "panels": [
      {
        "title": "QPSç›‘æ§",
        "targets": [
          {
            "expr": "rate(mysql_global_status_questions[5m])"
          }
        ]
      },
      {
        "title": "è¿æ¥æ•°ç›‘æ§", 
        "targets": [
          {
            "expr": "mysql_global_status_threads_connected"
          }
        ]
      }
    ]
  }
}
```

### 3.3 Prometheusç›‘æ§æŒ‡æ ‡è¯¦è§£


**æ ¸å¿ƒç›‘æ§æŒ‡æ ‡**ï¼š
```
ğŸ”¸ è¿æ¥æŒ‡æ ‡
mysql_global_status_threads_connected     # å½“å‰è¿æ¥æ•°
mysql_global_status_threads_running       # æ´»è·ƒè¿æ¥æ•°
mysql_global_status_aborted_connects      # è¿æ¥å¤±è´¥æ•°

ğŸ”¸ æŸ¥è¯¢æŒ‡æ ‡
mysql_global_status_questions             # æ€»æŸ¥è¯¢æ•°
mysql_global_status_queries               # SQLè¯­å¥æ•°
mysql_global_status_slow_queries          # æ…¢æŸ¥è¯¢æ•°

ğŸ”¸ InnoDBæŒ‡æ ‡
mysql_global_status_innodb_buffer_pool_reads      # ç‰©ç†è¯»æ¬¡æ•°
mysql_global_status_innodb_buffer_pool_read_requests # é€»è¾‘è¯»æ¬¡æ•°
mysql_global_status_innodb_rows_read               # è¯»å–è¡Œæ•°
mysql_global_status_innodb_rows_inserted           # æ’å…¥è¡Œæ•°
```

---

## 4. ğŸ› ï¸ MySQLå†…ç½®ç›‘æ§å·¥å…·


### 4.1 Performance Schemaå·¥å…·


**Performance Schemaç®€ä»‹**ï¼š
Performance Schemaæ˜¯MySQL **å†…ç½®çš„æ€§èƒ½ç›‘æ§å¼•æ“**ï¼Œæ— éœ€å®‰è£…é¢å¤–å·¥å…·å°±èƒ½ç›‘æ§æ•°æ®åº“æ€§èƒ½ã€‚

```
Performance Schemaæ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MySQLæœåŠ¡     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Performance     â”‚ â”€â”€â”€â”€ æ”¶é›†æ€§èƒ½æ•°æ®
â”‚ Schema Engine   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      
â”‚ performance_    â”‚ â”€â”€â”€â”€ å­˜å‚¨ç›‘æ§æ•°æ®  
â”‚ schemaæ•°æ®åº“    â”‚      
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¯ç”¨Performance Schema**ï¼š
```sql
-- æ£€æŸ¥æ˜¯å¦å¯ç”¨
SHOW VARIABLES LIKE 'performance_schema';

-- åœ¨my.cnfä¸­å¯ç”¨
[mysqld]
performance_schema = ON
performance_schema_max_table_instances = 12500
performance_schema_max_table_handles = 4000
```

**å¸¸ç”¨ç›‘æ§æŸ¥è¯¢**ï¼š
```sql
-- 1. æŸ¥çœ‹æœ€è€—æ—¶çš„SQLè¯­å¥
SELECT 
    DIGEST_TEXT,
    COUNT_STAR as exec_count,
    AVG_TIMER_WAIT/1000000000 as avg_time_ms,
    SUM_TIMER_WAIT/1000000000 as total_time_ms
FROM performance_schema.events_statements_summary_by_digest
ORDER BY SUM_TIMER_WAIT DESC 
LIMIT 10;

-- 2. æŸ¥çœ‹è¡¨çš„è¯»å†™ç»Ÿè®¡
SELECT 
    object_name as table_name,
    count_read,
    count_write,
    count_read + count_write as total_io
FROM performance_schema.table_io_waits_summary_by_table
WHERE object_schema = 'your_database'
ORDER BY total_io DESC;

-- 3. æŸ¥çœ‹å½“å‰ç­‰å¾…äº‹ä»¶
SELECT 
    thread_id,
    event_name,
    source,
    timer_wait/1000000000 as wait_time_ms
FROM performance_schema.events_waits_current
WHERE timer_wait > 0;
```

### 4.2 sys schemaè§†å›¾


**sys schemaç®€ä»‹**ï¼š
sys schemaæ˜¯MySQLæä¾›çš„ä¸€å¥—**ç®€åŒ–ç‰ˆæ€§èƒ½ç›‘æ§è§†å›¾**ï¼Œå°†Performance Schemaçš„å¤æ‚æ•°æ®åŒ…è£…æˆæ˜“äºç†è§£çš„è§†å›¾ã€‚

```
sys schemaçš„ä½œç”¨ï¼š
Performance Schema â”€â”€å¤æ‚éš¾æ‡‚â”€â”€â–¶ sys schema â”€â”€ç®€å•æ˜“ç”¨â”€â”€â–¶ ç”¨æˆ·æŸ¥è¯¢
     åŸå§‹æ•°æ®                      å‹å¥½è§†å›¾                 ç›‘æ§åˆ†æ
```

**å®ç”¨ç›‘æ§è§†å›¾**ï¼š
```sql
-- 1. æŸ¥çœ‹æœ€æ¶ˆè€—IOçš„SQL
SELECT * FROM sys.io_global_by_file_by_bytes LIMIT 10;

-- 2. æŸ¥çœ‹æœ€è€—æ—¶çš„SQLè¯­å¥
SELECT 
    query,
    exec_count,
    avg_latency,
    total_latency
FROM sys.x$statements_with_runtimes_in_95th_percentile
ORDER BY total_latency DESC 
LIMIT 10;

-- 3. æŸ¥çœ‹è¡¨å ç”¨ç©ºé—´
SELECT 
    table_schema,
    table_name,
    engine,
    data_length,
    index_length,
    total_length
FROM sys.x$schema_table_statistics
WHERE table_schema NOT IN ('mysql', 'performance_schema', 'information_schema', 'sys')
ORDER BY total_length DESC;

-- 4. æŸ¥çœ‹æœªä½¿ç”¨çš„ç´¢å¼•
SELECT * FROM sys.schema_unused_indexes
WHERE object_schema NOT IN ('mysql', 'performance_schema', 'information_schema', 'sys');
```

**ç›‘æ§è¿æ¥ä¿¡æ¯**ï¼š
```sql
-- æŸ¥çœ‹å½“å‰è¿æ¥è¯¦æƒ…
SELECT 
    thd_id,
    conn_id,
    user,
    db,
    command,
    state,
    time,
    current_statement
FROM sys.processlist
WHERE command != 'Sleep';

-- æŸ¥çœ‹ç”¨æˆ·è¿æ¥ç»Ÿè®¡
SELECT 
    user,
    current_connections,
    total_connections
FROM sys.user_summary;
```

### 4.3 æ…¢æŸ¥è¯¢åˆ†æå·¥å…·


**æ…¢æŸ¥è¯¢æ—¥å¿—é…ç½®**ï¼š
```sql
-- å¯ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—
SET GLOBAL slow_query_log = 'ON';
SET GLOBAL long_query_time = 2;  -- è¶…è¿‡2ç§’è®°å½•
SET GLOBAL log_queries_not_using_indexes = 'ON';  -- è®°å½•æœªä½¿ç”¨ç´¢å¼•çš„æŸ¥è¯¢

-- æŸ¥çœ‹æ…¢æŸ¥è¯¢é…ç½®
SHOW VARIABLES LIKE 'slow_query%';
SHOW VARIABLES LIKE 'long_query_time';
```

**ä½¿ç”¨mysqldumpslowåˆ†æ**ï¼š
```bash
# åˆ†ææ…¢æŸ¥è¯¢æ—¥å¿—
mysqldumpslow -s c -t 10 /var/log/mysql/slow.log    # æŒ‰æŸ¥è¯¢æ¬¡æ•°æ’åº
mysqldumpslow -s t -t 10 /var/log/mysql/slow.log    # æŒ‰æŸ¥è¯¢æ—¶é—´æ’åº  
mysqldumpslow -s l -t 10 /var/log/mysql/slow.log    # æŒ‰é”å®šæ—¶é—´æ’åº

# è¾“å‡ºç¤ºä¾‹
Count: 152  Time=11.31s (1719s)  Lock=0.00s (0s)  Rows=0.0 (0), root[root]@localhost
SELECT * FROM large_table WHERE status = 'N'
```

**æ…¢æŸ¥è¯¢åˆ†æè„šæœ¬**ï¼š
```python
#!/usr/bin/env python3
# ç®€å•çš„æ…¢æŸ¥è¯¢åˆ†æå·¥å…·
import re
from collections import defaultdict

def parse_slow_log(log_file):
    queries = defaultdict(list)
    
    with open(log_file, 'r') as f:
        content = f.read()
        
    # è§£ææ…¢æŸ¥è¯¢è®°å½•
    pattern = r'# Time: (\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}).*?# Query_time: ([\d.]+).*?;'
    matches = re.findall(pattern, content, re.DOTALL)
    
    for time_str, query_time in matches:
        queries[time_str].append(float(query_time))
    
    return queries

# ä½¿ç”¨ç¤ºä¾‹
slow_queries = parse_slow_log('/var/log/mysql/slow.log')
print(f"å‘ç° {len(slow_queries)} æ¡æ…¢æŸ¥è¯¢")
```

---

## 5. â˜ï¸ äº‘ç«¯ç›‘æ§æœåŠ¡


### 5.1 New Relicæ•°æ®åº“ç›‘æ§


**New Relicç®€ä»‹**ï¼š
New Relicæ˜¯çŸ¥åçš„**SaaSåº”ç”¨æ€§èƒ½ç›‘æ§å¹³å°**ï¼Œæä¾›MySQLæ•°æ®åº“ä¸“ä¸šç›‘æ§æœåŠ¡ã€‚

```
New Relicç›‘æ§èŒƒå›´ï¼š
â”Œâ”€ åº”ç”¨æ€§èƒ½ç›‘æ§ â”€â”€â”€â”€ Webåº”ç”¨å“åº”æ—¶é—´ã€é”™è¯¯ç‡
â”œâ”€ æ•°æ®åº“ç›‘æ§ â”€â”€â”€â”€â”€â”€ MySQLæ€§èƒ½ã€æ…¢æŸ¥è¯¢åˆ†æ  
â”œâ”€ æœåŠ¡å™¨ç›‘æ§ â”€â”€â”€â”€â”€â”€ CPUã€å†…å­˜ã€ç£ç›˜ç›‘æ§
â””â”€ ç”¨æˆ·ä½“éªŒç›‘æ§ â”€â”€â”€â”€ å‰ç«¯æ€§èƒ½ã€ç”¨æˆ·è¡Œä¸º
```

**éƒ¨ç½²New Relic Agent**ï¼š
```bash
# 1. å®‰è£…åŸºç¡€è®¾æ–½Agent
curl -Ls https://download.newrelic.com/install/newrelic-cli/scripts/install.sh | bash
sudo NEW_RELIC_API_KEY=YOUR_API_KEY NEW_RELIC_ACCOUNT_ID=YOUR_ACCOUNT_ID /usr/local/bin/newrelic install

# 2. é…ç½®MySQLç›‘æ§
sudo nano /etc/newrelic-infra/integrations.d/mysql-config.yml
```

**MySQLé›†æˆé…ç½®**ï¼š
```yaml
integrations:
  - name: nri-mysql
    env:
      HOSTNAME: localhost
      PORT: 3306
      USERNAME: newrelic
      PASSWORD: password
      DATABASE: mysql
      
    interval: 30s
    labels:
      environment: production
      role: primary
```

**æ ¸å¿ƒç›‘æ§æŒ‡æ ‡**ï¼š
- **æ€§èƒ½æŒ‡æ ‡**ï¼šQPSã€å“åº”æ—¶é—´ã€è¿æ¥æ± ä½¿ç”¨ç‡
- **èµ„æºä½¿ç”¨**ï¼šCPUåˆ©ç”¨ç‡ã€å†…å­˜ä½¿ç”¨ã€ç£ç›˜I/O
- **æ…¢æŸ¥è¯¢**ï¼šè‡ªåŠ¨è¯†åˆ«å¹¶åˆ†ææ…¢æ‰§è¡ŒSQL
- **é”™è¯¯ç›‘æ§**ï¼šè¿æ¥å¤±è´¥ã€æŸ¥è¯¢é”™è¯¯ã€æ­»é”æ£€æµ‹

### 5.2 DatadogåŸºç¡€è®¾æ–½ç›‘æ§


**Datadog MySQLé›†æˆ**ï¼š
```bash
# 1. å®‰è£…Datadog Agent
DD_API_KEY=your_api_key bash -c "$(curl -L https://s3.amazonaws.com/dd-agent/scripts/install_script.sh)"

# 2. é…ç½®MySQLæ£€æŸ¥
sudo nano /etc/datadog-agent/conf.d/mysql.d/conf.yaml
```

**é…ç½®æ–‡ä»¶ç¤ºä¾‹**ï¼š
```yaml
init_config:

instances:
  - server: localhost
    user: datadog
    pass: password
    port: 3306
    
    options:
      replication: true
      galera_cluster: true
      extra_status_metrics: true
      extra_innodb_metrics: true
      
    tags:
      - role:primary
      - env:production
```

**Datadogä»ªè¡¨æ¿ç‰¹æ€§**ï¼š
- **å®æ—¶ç›‘æ§**ï¼šç§’çº§æ•°æ®æ›´æ–°
- **æ™ºèƒ½å‘Šè­¦**ï¼šå¼‚å¸¸æ£€æµ‹ã€é˜ˆå€¼å‘Šè­¦
- **å…³è”åˆ†æ**ï¼šæ•°æ®åº“ä¸åº”ç”¨æ€§èƒ½å…³è”
- **å†å²è¶‹åŠ¿**ï¼šé•¿æœŸæ€§èƒ½è¶‹åŠ¿åˆ†æ

### 5.3 äº‘ç›‘æ§æœåŠ¡é›†æˆ


**AWS RDSç›‘æ§**ï¼š
```json
{
  "CloudWatchMetrics": [
    "CPUUtilization",
    "DatabaseConnections", 
    "FreeableMemory",
    "ReadLatency",
    "WriteLatency",
    "ReadThroughput",
    "WriteThroughput"
  ],
  
  "PerformanceInsights": {
    "enabled": true,
    "retentionPeriod": 7
  },
  
  "EnhancedMonitoring": {
    "monitoringInterval": 60,
    "monitoringRoleArn": "arn:aws:iam::account:role/rds-monitoring-role"
  }
}
```

**é˜¿é‡Œäº‘RDSç›‘æ§**ï¼š
```bash
# ä½¿ç”¨é˜¿é‡Œäº‘CLIæŸ¥çœ‹ç›‘æ§æ•°æ®
aliyun rds DescribeResourceUsage \
  --DBInstanceId rm-bp1xxxxx \
  --StartTime "2023-01-01T00:00:00Z" \
  --EndTime "2023-01-02T00:00:00Z"

# æŸ¥çœ‹æ€§èƒ½æ•°æ®
aliyun rds DescribeDBInstancePerformance \
  --DBInstanceId rm-bp1xxxxx \
  --Key "MySQL_Sessions,MySQL_QPS"
```

---

## 6. ğŸ¢ ä¼ä¸šçº§ç›‘æ§è§£å†³æ–¹æ¡ˆ


### 6.1 MySQL Enterprise Monitor


**Enterprise Monitorç®€ä»‹**ï¼š
MySQL Enterprise Monitoræ˜¯Oracleå®˜æ–¹çš„**å•†ä¸šçº§MySQLç›‘æ§è§£å†³æ–¹æ¡ˆ**ï¼Œæä¾›ä¼ä¸šçº§çš„ç›‘æ§ã€å‘Šè­¦å’Œæ€§èƒ½ä¼˜åŒ–å»ºè®®ã€‚

```
Enterprise Monitoræ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MySQLæœåŠ¡å™¨   â”‚â”€â”€â”€â–¶â”‚ Monitor Agent   â”‚
â”‚                 â”‚    â”‚                 â”‚
â”‚ â€¢ MySQLå®ä¾‹     â”‚    â”‚ â€¢ æ•°æ®æ”¶é›†      â”‚
â”‚ â€¢ æŸ¥è¯¢è´Ÿè½½      â”‚    â”‚ â€¢ æœ¬åœ°ç¼“å­˜      â”‚
â”‚ â€¢ ç³»ç»Ÿèµ„æº      â”‚    â”‚ â€¢ å®‰å…¨ä¼ è¾“      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ Monitor Server  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                 â”‚
â”‚ â€¢ Webç•Œé¢       â”‚
â”‚ â€¢ å‘Šè­¦å¼•æ“      â”‚
â”‚ â€¢ æŠ¥è¡¨ç”Ÿæˆ      â”‚
â”‚ â€¢ æ€§èƒ½å»ºè®®      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§**ï¼š
- **Query Analyzer**ï¼šæ·±åº¦SQLæ€§èƒ½åˆ†æ
- **Replication Monitor**ï¼šä¸»ä»å¤åˆ¶ç›‘æ§
- **Configuration Advisor**ï¼šé…ç½®ä¼˜åŒ–å»ºè®®
- **Security Monitor**ï¼šå®‰å…¨å®¡è®¡ç›‘æ§

**å®‰è£…éƒ¨ç½²**ï¼š
```bash
# 1. å®‰è£…Monitor Service Manager
./mysql-monitor-8.0.XX-linux-x86-64bit-installer.bin

# 2. é…ç½®Monitor Agent
mysql-monitor-agent --start --server=monitor-server:18080

# 3. æ³¨å†ŒMySQLå®ä¾‹
mysql-monitor-agent --register \
  --server=monitor-server:18080 \
  --host=mysql-host \
  --port=3306 \
  --user=monitor_user
```

### 6.2 AppDynamicsåº”ç”¨æ€§èƒ½ç›‘æ§


**AppDynamicsæ•°æ®åº“ç›‘æ§**ï¼š
AppDynamicsæä¾›**ç«¯åˆ°ç«¯çš„åº”ç”¨æ€§èƒ½ç›‘æ§**ï¼ŒåŒ…æ‹¬æ•°æ®åº“å±‚é¢çš„æ·±åº¦åˆ†æã€‚

```
ç›‘æ§å±‚æ¬¡ç»“æ„ï¼š
ç”¨æˆ·ä½“éªŒå±‚ â”€â”€â”€â”€â”€â”€â”€â”€â–¶ å‰ç«¯æ€§èƒ½ç›‘æ§
    â”‚
åº”ç”¨æœåŠ¡å±‚ â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Java/.NETåº”ç”¨ç›‘æ§  
    â”‚
æ•°æ®åº“å±‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ MySQLæ€§èƒ½ç›‘æ§
    â”‚
åŸºç¡€è®¾æ–½å±‚ â”€â”€â”€â”€â”€â”€â”€â”€â–¶ æœåŠ¡å™¨èµ„æºç›‘æ§
```

**æ•°æ®åº“ç›‘æ§é…ç½®**ï¼š
```xml
<!-- appd-database-config.xml -->
<database-config>
  <mysql>
    <connection-string>jdbc:mysql://localhost:3306/test</connection-string>
    <username>appd_user</username>
    <password>appd_pass</password>
    
    <monitoring>
      <slow-query-threshold>1000</slow-query-threshold>
      <connection-pool-monitoring>true</connection-pool-monitoring>
      <statement-caching>true</statement-caching>
    </monitoring>
  </mysql>
</database-config>
```

**ç›‘æ§ç»´åº¦**ï¼š
- **å“åº”æ—¶é—´**ï¼šSQLæ‰§è¡Œè€—æ—¶åˆ†å¸ƒ
- **ååé‡**ï¼šæ•°æ®åº“æ“ä½œé¢‘ç‡  
- **é”™è¯¯ç‡**ï¼šè¿æ¥å¤±è´¥ã€æŸ¥è¯¢å¼‚å¸¸
- **èµ„æºåˆ©ç”¨**ï¼šè¿æ¥æ± ã€ç¼“å­˜å‘½ä¸­ç‡

### 6.3 VividCortexæ€§èƒ½ç›‘æ§


**VividCortexç‰¹è‰²**ï¼š
VividCortexä¸“æ³¨äº**æ•°æ®åº“æŸ¥è¯¢çº§åˆ«çš„æ€§èƒ½ç›‘æ§**ï¼Œæä¾›æŸ¥è¯¢æŒ‡çº¹åˆ†æå’Œæ€§èƒ½ä¼˜åŒ–å»ºè®®ã€‚

```bash
# å®‰è£…VividCortex Agent
curl -s https://download.vividcortex.com/install | sudo bash

# é…ç½®MySQLç›‘æ§
vc-agent-007 --register \
  --api-token=your_token \
  --hostname=db-server-01 \
  --mysql-user=vc_user \
  --mysql-password=vc_pass
```

**æ ¸å¿ƒåˆ†æåŠŸèƒ½**ï¼š
- **æŸ¥è¯¢æŒ‡çº¹**ï¼šè¯†åˆ«ç›¸ä¼¼SQLæ¨¡å¼
- **æ‰§è¡Œè®¡åˆ’åˆ†æ**ï¼šè‡ªåŠ¨EXPLAINåˆ†æ
- **ç´¢å¼•å»ºè®®**ï¼šåŸºäºæŸ¥è¯¢æ¨¡å¼æ¨èç´¢å¼•
- **å®¹é‡è§„åˆ’**ï¼šåŸºäºå†å²æ•°æ®é¢„æµ‹èµ„æºéœ€æ±‚

---

## 7. ğŸ¯ ç›‘æ§å·¥å…·é€‰æ‹©æŒ‡å—


### 7.1 å·¥å…·å¯¹æ¯”åˆ†æ


```
ğŸ“Š ä¸»æµç›‘æ§å·¥å…·å¯¹æ¯”è¡¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    å·¥å…·      â”‚   æˆæœ¬   â”‚  æ˜“ç”¨æ€§  â”‚  åŠŸèƒ½æ€§  â”‚ ä¼ä¸šçº§   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PMM2         â”‚   å…è´¹   â”‚   â˜…â˜…â˜…â˜…   â”‚   â˜…â˜…â˜…â˜…   â”‚   â˜…â˜…â˜…    â”‚
â”‚ Zabbix       â”‚   å…è´¹   â”‚   â˜…â˜…â˜…    â”‚   â˜…â˜…â˜…    â”‚   â˜…â˜…â˜…â˜…   â”‚
â”‚ Prometheus   â”‚   å…è´¹   â”‚   â˜…â˜…â˜…    â”‚   â˜…â˜…â˜…â˜…   â”‚   â˜…â˜…â˜…    â”‚
â”‚ New Relic    â”‚   ä»˜è´¹   â”‚   â˜…â˜…â˜…â˜…â˜…  â”‚   â˜…â˜…â˜…â˜…   â”‚   â˜…â˜…â˜…â˜…â˜…  â”‚
â”‚ Enterprise   â”‚   æ˜‚è´µ   â”‚   â˜…â˜…â˜…â˜…   â”‚   â˜…â˜…â˜…â˜…â˜…  â”‚   â˜…â˜…â˜…â˜…â˜…  â”‚
â”‚ Datadog      â”‚   ä»˜è´¹   â”‚   â˜…â˜…â˜…â˜…â˜…  â”‚   â˜…â˜…â˜…â˜…   â”‚   â˜…â˜…â˜…â˜…   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 é€‰æ‹©å†³ç­–æ ‘


```
ç›‘æ§å·¥å…·é€‰æ‹©æµç¨‹ï¼š

é¢„ç®—å……è¶³ï¼Ÿ
â”œâ”€ æ˜¯ â”€â”€â–¶ ä¼ä¸šè§„æ¨¡å¤§ï¼Ÿ
â”‚         â”œâ”€ æ˜¯ â”€â”€â–¶ Enterprise Monitor / New Relic
â”‚         â””â”€ å¦ â”€â”€â–¶ Datadog / AppDynamics
â”‚
â””â”€ å¦ â”€â”€â–¶ æŠ€æœ¯å›¢é˜Ÿå¼ºï¼Ÿ
          â”œâ”€ æ˜¯ â”€â”€â–¶ è‡ªå»ºç›‘æ§(Prometheus+Grafana)
          â””â”€ å¦ â”€â”€â–¶ PMM2 / Zabbix
```

### 7.3 åœºæ™¯åŒ–æ¨è


**ğŸ”¸ åˆåˆ›å…¬å¸/å°å›¢é˜Ÿ**
- **æ¨è**ï¼šPMM2 + åŸºç¡€å‘Šè­¦
- **ç†ç”±**ï¼šå…è´¹ã€éƒ¨ç½²ç®€å•ã€åŠŸèƒ½å®Œæ•´
- **é…ç½®**ï¼šDockeréƒ¨ç½²ï¼ŒåŸºæœ¬ç›‘æ§å³å¯

**ğŸ”¸ ä¸­å‹ä¼ä¸š**
- **æ¨è**ï¼šZabbix + Grafana æˆ– Datadog
- **ç†ç”±**ï¼šæˆæœ¬å¯æ§ï¼ŒåŠŸèƒ½ä¸°å¯Œï¼Œæ‰©å±•æ€§å¥½
- **é…ç½®**ï¼šå®Œæ•´ç›‘æ§ä½“ç³»ï¼Œè‡ªå®šä¹‰å‘Šè­¦è§„åˆ™

**ğŸ”¸ å¤§å‹ä¼ä¸š**
- **æ¨è**ï¼šEnterprise Monitor + APMè§£å†³æ–¹æ¡ˆ  
- **ç†ç”±**ï¼šä¸“ä¸šæ”¯æŒï¼Œä¼ä¸šçº§ç‰¹æ€§ï¼Œåˆè§„è¦æ±‚
- **é…ç½®**ï¼šå¤šç¯å¢ƒç›‘æ§ï¼Œè¯¦ç»†çš„SLAç›‘æ§

**ğŸ”¸ äº‘åŸç”Ÿç¯å¢ƒ**
- **æ¨è**ï¼šPrometheus + Grafana + AlertManager
- **ç†ç”±**ï¼šäº‘åŸç”ŸæŠ€æœ¯æ ˆï¼ŒKuberneteså‹å¥½
- **é…ç½®**ï¼šå¾®æœåŠ¡ç›‘æ§ï¼ŒåŠ¨æ€æœåŠ¡å‘ç°

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„ç›‘æ§æ¦‚å¿µ


```
ğŸ”¸ ç›‘æ§çš„æœ¬è´¨ï¼šåŠæ—¶å‘ç°é—®é¢˜ï¼Œé¢„é˜²æ•…éšœå‘ç”Ÿ
ğŸ”¸ å…³é”®æŒ‡æ ‡ï¼šQPS/TPSã€å“åº”æ—¶é—´ã€è¿æ¥æ•°ã€èµ„æºä½¿ç”¨ç‡  
ğŸ”¸ å·¥å…·åˆ†ç±»ï¼šå¼€æºå…è´¹ã€å•†ä¸šä»˜è´¹ã€äº‘ç«¯æœåŠ¡ã€å†…ç½®å·¥å…·
ğŸ”¸ é€‰æ‹©åŸåˆ™ï¼šæ ¹æ®è§„æ¨¡ã€é¢„ç®—ã€æŠ€æœ¯èƒ½åŠ›ç»¼åˆè€ƒè™‘
ğŸ”¸ ç›‘æ§ä½“ç³»ï¼šæ•°æ®æ”¶é›† â†’ å­˜å‚¨å¤„ç† â†’ å¯è§†åŒ– â†’ å‘Šè­¦é€šçŸ¥
```

### 8.2 å®ç”¨ç›‘æ§å»ºè®®


**ğŸ”¹ ç›‘æ§ç­–ç•¥**ï¼š
```
åŸºç¡€ç›‘æ§ï¼ˆå¿…å¤‡ï¼‰ï¼š
â€¢ æœåŠ¡å¯ç”¨æ€§ï¼šMySQLæœåŠ¡æ˜¯å¦è¿è¡Œ
â€¢ è¿æ¥ç›‘æ§ï¼šå½“å‰è¿æ¥æ•°ã€è¿æ¥å¤±è´¥ç‡
â€¢ æ€§èƒ½æŒ‡æ ‡ï¼šQPSã€å¹³å‡å“åº”æ—¶é—´
â€¢ èµ„æºç›‘æ§ï¼šCPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨ç‡

è¿›é˜¶ç›‘æ§ï¼ˆæ¨èï¼‰ï¼š
â€¢ æ…¢æŸ¥è¯¢åˆ†æï¼šè¯†åˆ«æ€§èƒ½ç“¶é¢ˆSQL
â€¢ å¤åˆ¶ç›‘æ§ï¼šä¸»ä»å»¶è¿Ÿã€åŒæ­¥çŠ¶æ€  
â€¢ ç¼“å­˜ç›‘æ§ï¼šInnoDBç¼“å†²æ± å‘½ä¸­ç‡
â€¢ é”ç›‘æ§ï¼šæ­»é”ã€é”ç­‰å¾…æƒ…å†µ

é«˜çº§ç›‘æ§ï¼ˆå¯é€‰ï¼‰ï¼š
â€¢ æŸ¥è¯¢æŒ‡çº¹åˆ†æï¼šSQLæ¨¡å¼è¯†åˆ«
â€¢ å®¹é‡è§„åˆ’ï¼šèµ„æºå¢é•¿è¶‹åŠ¿é¢„æµ‹
â€¢ å®‰å…¨ç›‘æ§ï¼šå¼‚å¸¸ç™»å½•ã€æƒé™å˜åŒ–
â€¢ ä¸šåŠ¡ç›‘æ§ï¼šå…³é”®ä¸šåŠ¡æŒ‡æ ‡
```

**ğŸ”¹ å‘Šè­¦è®¾ç½®åŸåˆ™**ï¼š
```
å‘Šè­¦é˜ˆå€¼è®¾å®šï¼š
â€¢ è¿æ¥æ•°ï¼š> 80% æœ€å¤§è¿æ¥æ•°
â€¢ æ…¢æŸ¥è¯¢ï¼š> æ¯åˆ†é’Ÿ10æ¡æ…¢æŸ¥è¯¢
â€¢ ä¸»ä»å»¶è¿Ÿï¼š> 5ç§’å»¶è¿Ÿ
â€¢ ç£ç›˜ä½¿ç”¨ï¼š> 85% ç£ç›˜ç©ºé—´

å‘Šè­¦ç­–ç•¥ï¼š
â€¢ åˆ†çº§å‘Šè­¦ï¼šä¸¥é‡/è­¦å‘Š/ä¿¡æ¯
â€¢ å‘Šè­¦æ”¶æ•›ï¼šé¿å…å‘Šè­¦é£æš´
â€¢ å€¼ç­è½®æ¢ï¼š7Ã—24å°æ—¶å“åº”
â€¢ è‡ªåŠ¨æ¢å¤ï¼šéƒ¨åˆ†é—®é¢˜è‡ªåŠ¨å¤„ç†
```

### 8.3 ç›‘æ§æœ€ä½³å®è·µ


**ğŸ¯ éƒ¨ç½²å»ºè®®**ï¼š
- **ç›‘æ§å³ä»£ç **ï¼šç›‘æ§é…ç½®ç‰ˆæœ¬åŒ–ç®¡ç†
- **æ¸è¿›éƒ¨ç½²**ï¼šä»åŸºç¡€ç›‘æ§å¼€å§‹ï¼Œé€æ­¥å®Œå–„
- **å®šæœŸå›é¡¾**ï¼šæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ç›‘æ§ç­–ç•¥
- **æ–‡æ¡£å®Œå–„**ï¼šç›‘æ§æ‰‹å†Œã€æ•…éšœå¤„ç†æµç¨‹

**âš¡ æ€§èƒ½ä¼˜åŒ–**ï¼š
- **é‡‡é›†é¢‘ç‡**ï¼šå¹³è¡¡ç›‘æ§ç²¾åº¦å’Œç³»ç»Ÿè´Ÿè½½
- **æ•°æ®ä¿ç•™**ï¼šåˆç†è®¾ç½®å†å²æ•°æ®ä¿ç•™æœŸ
- **å‘Šè­¦ä¼˜åŒ–**ï¼šå‡å°‘è¯¯æŠ¥ï¼Œæé«˜å‘Šè­¦è´¨é‡
- **è‡ªåŠ¨åŒ–**ï¼šæ•…éšœè‡ªæ„ˆã€è‡ªåŠ¨æ‰©å®¹

### 8.4 å¸¸è§é—®é¢˜è§£ç­”


**â“ ä¸ºä»€ä¹ˆéœ€è¦å¤šç§ç›‘æ§å·¥å…·**ï¼Ÿ
ä¸åŒå·¥å…·æœ‰ä¸åŒä¼˜åŠ¿ï¼Œç»„åˆä½¿ç”¨æ•ˆæœæ›´å¥½ï¼š
- PMMä¸“æ³¨æ•°æ®åº“æ€§èƒ½åˆ†æ
- Zabbixæ“…é•¿åŸºç¡€è®¾æ–½ç›‘æ§  
- Grafanaæä¾›ä¼˜ç§€çš„å¯è§†åŒ–
- äº‘æœåŠ¡é›†æˆåº”ç”¨ç›‘æ§

**â“ ç›‘æ§æ•°æ®åº”è¯¥ä¿ç•™å¤šé•¿æ—¶é—´**ï¼Ÿ
```
æ•°æ®ä¿ç•™ç­–ç•¥ï¼š
â€¢ å®æ—¶æ•°æ®ï¼š1-7å¤©é«˜é¢‘é‡‡é›†
â€¢ å†å²æ•°æ®ï¼š1-3ä¸ªæœˆä¸­é¢‘é‡‡é›†  
â€¢ è¶‹åŠ¿æ•°æ®ï¼š1å¹´ä»¥ä¸Šä½é¢‘é‡‡é›†
â€¢ å…³é”®äº‹ä»¶ï¼šæ°¸ä¹…ä¿ç•™
```

**â“ å¦‚ä½•é¿å…ç›‘æ§å¸¦æ¥çš„æ€§èƒ½å½±å“**ï¼Ÿ
- åˆç†è®¾ç½®é‡‡é›†é¢‘ç‡ï¼ˆ30ç§’-5åˆ†é’Ÿï¼‰
- ä½¿ç”¨åªè¯»ç”¨æˆ·è¿›è¡Œç›‘æ§
- ç›‘æ§Agentéƒ¨ç½²åœ¨ç‹¬ç«‹æœåŠ¡å™¨
- å®šæœŸæ¸…ç†ç›‘æ§æ•°æ®

**æ ¸å¿ƒè®°å¿†**ï¼š
- ç›‘æ§æ˜¯æ•°æ®åº“è¿ç»´çš„åŸºç¡€ï¼Œå·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨
- é€‰æ‹©é€‚åˆçš„ç›‘æ§å·¥å…·ï¼Œæ„å»ºå®Œæ•´çš„ç›‘æ§ä½“ç³»
- é‡ç‚¹å…³æ³¨æ€§èƒ½ã€å¯ç”¨æ€§ã€å®¹é‡ä¸‰ä¸ªç»´åº¦
- ç›‘æ§ä¸ä»…è¦å‘ç°é—®é¢˜ï¼Œæ›´è¦å¸®åŠ©é¢„é˜²é—®é¢˜