---
title: 6ã€æ•°æ®è·¯ç”±ä¸åˆ†ç‰‡è§„åˆ™ç®¡ç†
---
## ğŸ“š ç›®å½•

1. [æ•°æ®è·¯ç”±åŸºæœ¬æ¦‚å¿µä¸åŸç†](#1-æ•°æ®è·¯ç”±åŸºæœ¬æ¦‚å¿µä¸åŸç†)
2. [SQLè·¯ç”±è§£æåŸºç¡€æµç¨‹](#2-SQLè·¯ç”±è§£æåŸºç¡€æµç¨‹)
3. [è·¯ç”±è§„åˆ™è®¾è®¡æ ¸å¿ƒåŸåˆ™](#3-è·¯ç”±è§„åˆ™è®¾è®¡æ ¸å¿ƒåŸåˆ™)
4. [æ•°æ®è·¯ç”±ç®—æ³•è¯¦è§£](#4-æ•°æ®è·¯ç”±ç®—æ³•è¯¦è§£)
5. [åˆ†ç‰‡è·¯ç”±è§„åˆ™å®ç°](#5-åˆ†ç‰‡è·¯ç”±è§„åˆ™å®ç°)
6. [åŠ¨æ€è·¯ç”±é…ç½®ç®¡ç†](#6-åŠ¨æ€è·¯ç”±é…ç½®ç®¡ç†)
7. [å¤šç»´åº¦è·¯ç”±ç­–ç•¥](#7-å¤šç»´åº¦è·¯ç”±ç­–ç•¥)
8. [è·¯ç”±æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯](#8-è·¯ç”±æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯)
9. [è·¯ç”±ç¼“å­˜æœºåˆ¶è®¾è®¡](#9-è·¯ç”±ç¼“å­˜æœºåˆ¶è®¾è®¡)
10. [è·¯ç”±æ•…éšœåˆ‡æ¢æœºåˆ¶](#10-è·¯ç”±æ•…éšœåˆ‡æ¢æœºåˆ¶)
11. [è´Ÿè½½å‡è¡¡ä¸è·¯ç”±åè°ƒ](#11-è´Ÿè½½å‡è¡¡ä¸è·¯ç”±åè°ƒ)
12. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#12-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ æ•°æ®è·¯ç”±åŸºæœ¬æ¦‚å¿µä¸åŸç†


### 1.1 ä»€ä¹ˆæ˜¯æ•°æ®è·¯ç”±


æ•°æ®è·¯ç”±å°±åƒ**å¿«é€’åˆ†æ‹£ä¸­å¿ƒ**ä¸€æ ·ï¼Œè´Ÿè´£æŠŠSQLè¯·æ±‚å‡†ç¡®åœ°é€åˆ°æ­£ç¡®çš„æ•°æ®åº“åˆ†ç‰‡ä¸Šã€‚

**ğŸ”¸ æ ¸å¿ƒä½œç”¨**
```
SQLè¯·æ±‚ â†’ è·¯ç”±å™¨åˆ†æ â†’ ç¡®å®šç›®æ ‡åˆ†ç‰‡ â†’ æ‰§è¡ŒæŸ¥è¯¢

æ¯”å¦‚ï¼š
ç”¨æˆ·æŸ¥è¯¢è®¢å•ï¼šSELECT * FROM orders WHERE user_id = 12345
è·¯ç”±å™¨åˆ†æï¼šuser_id=12345 â†’ è®¡ç®—å¾—å‡ºåº”è¯¥å»ç¬¬2ä¸ªåˆ†ç‰‡
æœ€ç»ˆæ‰§è¡Œï¼šåœ¨orders_2æ•°æ®åº“ä¸­æ‰§è¡ŒæŸ¥è¯¢
```

> ğŸ’¡ **ç®€å•ç†è§£**  
> æ•°æ®è·¯ç”±å°±æ˜¯ä¸€ä¸ª"æ™ºèƒ½å¯¼èˆªç³»ç»Ÿ"ï¼Œå‘Šè¯‰SQLè¯­å¥åº”è¯¥å»å“ªä¸ªæ•°æ®åº“æ‰§è¡Œ

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®è·¯ç”±


**ğŸ”¸ åˆ†åº“åˆ†è¡¨åçš„æ ¸å¿ƒé—®é¢˜**

```
å•åº“æ—¶ä»£ï¼š
åº”ç”¨ â†’ æ•°æ®åº“ (ç®€å•ç›´æ¥)

åˆ†åº“åˆ†è¡¨åï¼š
åº”ç”¨ â†’ ï¼Ÿï¼Ÿï¼Ÿ â†’ æ•°æ®åº“1/æ•°æ®åº“2/æ•°æ®åº“3... (éœ€è¦è·¯ç”±)
```

**ğŸ”¸ è·¯ç”±è§£å†³çš„å…³é”®é—®é¢˜**
- **æ•°æ®å®šä½**ï¼šå¿«é€Ÿæ‰¾åˆ°æ•°æ®åœ¨å“ªä¸ªåˆ†ç‰‡
- **SQLæ”¹å†™**ï¼šæŠŠé€»è¾‘è¡¨åæ”¹æˆç‰©ç†è¡¨å
- **ç»“æœåˆå¹¶**ï¼šæŠŠå¤šä¸ªåˆ†ç‰‡çš„ç»“æœåˆå¹¶è¿”å›
- **æ€§èƒ½ä¼˜åŒ–**ï¼šé¿å…æ‰«ææ‰€æœ‰åˆ†ç‰‡

### 1.3 æ•°æ®è·¯ç”±å·¥ä½œåŸç†


**ğŸ”¸ è·¯ç”±å¤„ç†æµç¨‹**

```
SQLè¾“å…¥ â†’ è§£æåˆ†æ â†’ è·¯ç”±è®¡ç®— â†’ åˆ†ç‰‡å®šä½ â†’ æ‰§è¡Œè¿”å›
    â”‚         â”‚         â”‚         â”‚         â”‚
    â–¼         â–¼         â–¼         â–¼         â–¼
  åŸå§‹SQL   æå–æ¡ä»¶   è®¡ç®—åˆ†ç‰‡   ç¡®å®šç›®æ ‡   åˆå¹¶ç»“æœ
```

**ğŸ”¸ æ ¸å¿ƒç»„ä»¶å…³ç³»**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   SQLè§£æå™¨     â”‚â”€â”€â”€â–¶â”‚   è·¯ç”±è®¡ç®—å™¨     â”‚â”€â”€â”€â–¶â”‚   åˆ†ç‰‡æ‰§è¡Œå™¨     â”‚
â”‚   æå–è·¯ç”±å­—æ®µ   â”‚    â”‚   ç¡®å®šç›®æ ‡åˆ†ç‰‡   â”‚    â”‚   æ‰§è¡Œå¹¶åˆå¹¶     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ğŸ” SQLè·¯ç”±è§£æåŸºç¡€æµç¨‹


### 2.1 SQLè§£æè¿‡ç¨‹è¯¦è§£


SQLè§£æå°±åƒ**é˜…è¯»ç†è§£**ï¼Œéœ€è¦ç†è§£SQLè¯­å¥æƒ³è¦åšä»€ä¹ˆã€‚

**ğŸ”¸ è§£ææ­¥éª¤**

```
1ï¸âƒ£ è¯æ³•åˆ†æï¼šæŠŠSQLæ‹†æˆä¸€ä¸ªä¸ªè¯
   SELECT * FROM users WHERE id = 123
   â†“
   [SELECT] [*] [FROM] [users] [WHERE] [id] [=] [123]

2ï¸âƒ£ è¯­æ³•åˆ†æï¼šç†è§£SQLç»“æ„
   â†“
   æŸ¥è¯¢ç±»å‹ï¼šSELECT
   ç›®æ ‡è¡¨ï¼šusers
   æ¡ä»¶ï¼šid = 123

3ï¸âƒ£ è·¯ç”±å­—æ®µæå–ï¼šæ‰¾å‡ºåˆ†ç‰‡ä¾æ®
   â†“
   åˆ†ç‰‡å­—æ®µï¼šid
   åˆ†ç‰‡å€¼ï¼š123
```

### 2.2 è·¯ç”±å­—æ®µè¯†åˆ«


**ğŸ”¸ å¸¸è§åˆ†ç‰‡å­—æ®µ**

| **åˆ†ç‰‡å­—æ®µ** | **ä½¿ç”¨åœºæ™¯** | **ç¤ºä¾‹** |
|-------------|-------------|----------|
| `ç”¨æˆ·ID` | `ç”¨æˆ·ç»´åº¦åˆ†ç‰‡` | `user_id = 12345` |
| `è®¢å•æ—¶é—´` | `æ—¶é—´ç»´åº¦åˆ†ç‰‡` | `create_time >= '2024-01-01'` |
| `åœ°ç†åŒºåŸŸ` | `åœ°åŸŸç»´åº¦åˆ†ç‰‡` | `region = 'north'` |
| `å•†å“ç±»å‹` | `ä¸šåŠ¡ç»´åº¦åˆ†ç‰‡` | `category_id = 100` |

**ğŸ”¸ è·¯ç”±å­—æ®µæå–ç¤ºä¾‹**

```sql
-- ç¤ºä¾‹1ï¼šå•ä¸€æ¡ä»¶
SELECT * FROM orders WHERE user_id = 12345;
-- æå–ï¼šuser_id = 12345

-- ç¤ºä¾‹2ï¼šå¤šä¸ªæ¡ä»¶  
SELECT * FROM orders WHERE user_id = 12345 AND status = 'paid';
-- æå–ï¼šuser_id = 12345 (ä¸»è¦è·¯ç”±å­—æ®µ)

-- ç¤ºä¾‹3ï¼šèŒƒå›´æ¡ä»¶
SELECT * FROM orders WHERE user_id IN (1001, 1002, 1003);
-- æå–ï¼šuser_id IN (1001, 1002, 1003)
```

### 2.3 SQLæ”¹å†™æœºåˆ¶


**ğŸ”¸ é€»è¾‘è¡¨åˆ°ç‰©ç†è¡¨è½¬æ¢**

```sql
-- åŸå§‹SQL (é€»è¾‘è¡¨)
SELECT * FROM orders WHERE user_id = 12345;

-- è·¯ç”±è®¡ç®—ï¼šuser_id=12345 â†’ åˆ†ç‰‡2
-- æ”¹å†™åSQL (ç‰©ç†è¡¨)
SELECT * FROM orders_2 WHERE user_id = 12345;
```

**ğŸ”¸ å¤æ‚æŸ¥è¯¢æ”¹å†™**

```sql
-- è·¨åˆ†ç‰‡æŸ¥è¯¢
SELECT * FROM orders WHERE create_time >= '2024-01-01';

-- æ”¹å†™ä¸ºå¤šä¸ªæŸ¥è¯¢
SELECT * FROM orders_0 WHERE create_time >= '2024-01-01';
SELECT * FROM orders_1 WHERE create_time >= '2024-01-01';  
SELECT * FROM orders_2 WHERE create_time >= '2024-01-01';
-- æœ€ååˆå¹¶ç»“æœ
```

---

## 3. ğŸ“‹ è·¯ç”±è§„åˆ™è®¾è®¡æ ¸å¿ƒåŸåˆ™


### 3.1 è·¯ç”±è§„åˆ™è®¾è®¡è¦ç‚¹


**ğŸ”¸ æ ¸å¿ƒè®¾è®¡åŸåˆ™**

> ğŸ¯ **å‡è¡¡æ€§åŸåˆ™**  
> æ•°æ®è¦å°½é‡å¹³å‡åˆ†å¸ƒï¼Œé¿å…æŸä¸ªåˆ†ç‰‡è¿‡è½½

> ğŸ¯ **ç¨³å®šæ€§åŸåˆ™**  
> ç›¸åŒçš„è·¯ç”±æ¡ä»¶æ€»æ˜¯æŒ‡å‘ç›¸åŒçš„åˆ†ç‰‡

> ğŸ¯ **æ‰©å±•æ€§åŸåˆ™**  
> æ–°å¢åˆ†ç‰‡æ—¶å½±å“èŒƒå›´è¦æœ€å°

> ğŸ¯ **æ€§èƒ½åŸåˆ™**  
> è·¯ç”±è®¡ç®—è¦å¿«ï¼Œä¸èƒ½æˆä¸ºæ€§èƒ½ç“¶é¢ˆ

### 3.2 è·¯ç”±è§„åˆ™åˆ†ç±»


**ğŸ”¸ æŒ‰åˆ†ç‰‡æ–¹å¼åˆ†ç±»**

```
æ°´å¹³åˆ†ç‰‡è·¯ç”±ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ orders_0â”‚ orders_1â”‚ orders_2â”‚
â”‚ id:1-100â”‚id:101-200â”‚id:201-300â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å‚ç›´åˆ†ç‰‡è·¯ç”±ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·åº“   â”‚ è®¢å•åº“   â”‚ å•†å“åº“   â”‚
â”‚ users   â”‚ orders  â”‚products â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”¸ æŒ‰è·¯ç”±ç®—æ³•åˆ†ç±»**

| **ç®—æ³•ç±»å‹** | **ç‰¹ç‚¹** | **é€‚ç”¨åœºæ™¯** |
|-------------|----------|-------------|
| **å–æ¨¡ç®—æ³•** | `ç®€å•å¿«é€Ÿ` | `å‡åŒ€åˆ†å¸ƒçš„IDå­—æ®µ` |
| **èŒƒå›´ç®—æ³•** | `èŒƒå›´æŸ¥è¯¢å‹å¥½` | `æ—¶é—´ã€åºå·ç­‰æœ‰åºå­—æ®µ` |
| **å“ˆå¸Œç®—æ³•** | `åˆ†å¸ƒå‡åŒ€` | `å­—ç¬¦ä¸²ç±»å‹çš„åˆ†ç‰‡å­—æ®µ` |
| **ä¸€è‡´æ€§å“ˆå¸Œ** | `æ‰©å±•å‹å¥½` | `éœ€è¦åŠ¨æ€æ‰©å®¹çš„åœºæ™¯` |

### 3.3 è·¯ç”±è§„åˆ™é…ç½®æ ¼å¼


**ğŸ”¸ é…ç½®ç¤ºä¾‹**

```yaml
# è·¯ç”±è§„åˆ™é…ç½®
sharding_rules:
  # è¡¨çº§åˆ«è·¯ç”±
  orders:
    sharding_column: user_id    # åˆ†ç‰‡å­—æ®µ
    algorithm: mod             # è·¯ç”±ç®—æ³•
    shards: 4                  # åˆ†ç‰‡æ•°é‡
    
  users:
    sharding_column: id
    algorithm: range
    ranges:                    # èŒƒå›´åˆ†ç‰‡
      - min: 1, max: 10000, shard: "users_0"
      - min: 10001, max: 20000, shard: "users_1"
```

---

## 4. âš™ï¸ æ•°æ®è·¯ç”±ç®—æ³•è¯¦è§£


### 4.1 å–æ¨¡è·¯ç”±ç®—æ³•


å–æ¨¡ç®—æ³•å°±åƒ**æ’é˜Ÿåˆ†ç»„**ï¼ŒæŒ‰ç¼–å·é™¤ä»¥ç»„æ•°çš„ä½™æ•°æ¥åˆ†ç»„ã€‚

**ğŸ”¸ ç®—æ³•åŸç†**

```java
// å–æ¨¡è·¯ç”±è®¡ç®—
public int calculateShard(long userId, int shardCount) {
    return (int)(userId % shardCount);
}

// ç¤ºä¾‹è®¡ç®—
ç”¨æˆ·ID: 12345, åˆ†ç‰‡æ•°: 4
åˆ†ç‰‡ç¼–å· = 12345 % 4 = 1
â†’ æ•°æ®å­˜å‚¨åœ¨ç¬¬1å·åˆ†ç‰‡
```

**ğŸ”¸ ä¼˜ç¼ºç‚¹åˆ†æ**

```
âœ… ä¼˜ç‚¹ï¼š
- è®¡ç®—ç®€å•å¿«é€Ÿ
- åˆ†å¸ƒç›¸å¯¹å‡åŒ€
- å®ç°å®¹æ˜“

âŒ ç¼ºç‚¹ï¼š
- æ‰©å®¹æ—¶éœ€è¦å¤§é‡æ•°æ®è¿ç§»
- ä¸é€‚åˆèŒƒå›´æŸ¥è¯¢
```

### 4.2 èŒƒå›´è·¯ç”±ç®—æ³•


èŒƒå›´ç®—æ³•å°±åƒ**æŒ‰å¹´é¾„åˆ†ç­**ï¼ŒæŠŠç›¸è¿‘çš„æ•°æ®æ”¾åœ¨ä¸€èµ·ã€‚

**ğŸ”¸ ç®—æ³•åŸç†**

```java
// èŒƒå›´è·¯ç”±è®¡ç®—
public String calculateShardByRange(long value) {
    if (value >= 1 && value <= 10000) return "shard_0";
    if (value >= 10001 && value <= 20000) return "shard_1";
    if (value >= 20001 && value <= 30000) return "shard_2";
    return "shard_default";
}
```

**ğŸ”¸ åº”ç”¨åœºæ™¯**

```
æ—¶é—´åˆ†ç‰‡ï¼š
2024å¹´1æœˆ â†’ orders_202401
2024å¹´2æœˆ â†’ orders_202402

IDèŒƒå›´åˆ†ç‰‡ï¼š
1-10000    â†’ users_0
10001-20000 â†’ users_1
```

### 4.3 å“ˆå¸Œè·¯ç”±ç®—æ³•


å“ˆå¸Œç®—æ³•å°±åƒ**æ‰“ä¹±é‡æ’**ï¼Œè®©æ•°æ®åˆ†å¸ƒæ›´åŠ å‡åŒ€ã€‚

**ğŸ”¸ ç®—æ³•å®ç°**

```java
// å“ˆå¸Œè·¯ç”±è®¡ç®—
public int calculateHashShard(String key, int shardCount) {
    int hash = key.hashCode();
    // ç¡®ä¿ç»“æœä¸ºæ­£æ•°
    return Math.abs(hash) % shardCount;
}

// ç¤ºä¾‹
ç”¨æˆ·å: "zhangsan"
å“ˆå¸Œå€¼: 1234567
åˆ†ç‰‡æ•°: 4
åˆ†ç‰‡ç¼–å· = |1234567| % 4 = 3
```

### 4.4 ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•


ä¸€è‡´æ€§å“ˆå¸Œå°±åƒ**åœ†æ¡Œåˆ†é…**ï¼Œæ–°å¢ä½ç½®æ—¶å½±å“æœ€å°ã€‚

**ğŸ”¸ åŸºæœ¬åŸç†**

```
         èŠ‚ç‚¹A
          â–²
         /|\
        / | \
   æ•°æ®1  |  æ•°æ®2
        \ | /
         \|/
          â–¼
         èŠ‚ç‚¹B

æ–°å¢èŠ‚ç‚¹Cæ—¶ï¼Œåªæœ‰éƒ¨åˆ†æ•°æ®éœ€è¦è¿ç§»
```

**ğŸ”¸ å®ç°è¦ç‚¹**

```java
// ä¸€è‡´æ€§å“ˆå¸Œå…³é”®ä»£ç 
TreeMap<Long, String> hashRing = new TreeMap<>();

// æ·»åŠ è™šæ‹ŸèŠ‚ç‚¹å¢åŠ å‡åŒ€æ€§
for (String node : nodes) {
    for (int i = 0; i < 150; i++) {
        long hash = hash(node + "_" + i);
        hashRing.put(hash, node);
    }
}

// æŸ¥æ‰¾è´Ÿè´£çš„èŠ‚ç‚¹
public String getNode(String key) {
    long hash = hash(key);
    Map.Entry<Long, String> entry = hashRing.ceilingEntry(hash);
    return entry != null ? entry.getValue() : hashRing.firstEntry().getValue();
}
```

---

## 5. ğŸ”€ åˆ†ç‰‡è·¯ç”±è§„åˆ™å®ç°


### 5.1 å•è¡¨è·¯ç”±è§„åˆ™


**ğŸ”¸ ç®€å•åˆ†ç‰‡è·¯ç”±**

```java
@Component
public class SingleTableRouter {
    
    // ç”¨æˆ·è¡¨è·¯ç”± - æŒ‰ç”¨æˆ·IDå–æ¨¡
    public String routeUserTable(Long userId) {
        int shardIndex = (int)(userId % 4);
        return "users_" + shardIndex;
    }
    
    // è®¢å•è¡¨è·¯ç”± - æŒ‰ç”¨æˆ·IDè·¯ç”±(ä¿æŒå…³è”)
    public String routeOrderTable(Long userId) {
        int shardIndex = (int)(userId % 4);
        return "orders_" + shardIndex;
    }
}
```

**ğŸ”¸ è·¯ç”±è§„åˆ™é…ç½®**

```yaml
# å•è¡¨è·¯ç”±é…ç½®
table_routes:
  users:
    type: "mod"           # å–æ¨¡è·¯ç”±
    column: "id"          # è·¯ç”±å­—æ®µ
    mod_value: 4          # æ¨¡æ•°
    
  orders:
    type: "mod"
    column: "user_id"     # æŒ‰ç”¨æˆ·IDè·¯ç”±
    mod_value: 4
```

### 5.2 å¤šè¡¨å…³è”è·¯ç”±


å½“å¤šä¸ªè¡¨éœ€è¦å…³è”æŸ¥è¯¢æ—¶ï¼Œè¦ä¿è¯ç›¸å…³æ•°æ®åœ¨åŒä¸€ä¸ªåˆ†ç‰‡ã€‚

**ğŸ”¸ å…³è”è·¯ç”±è®¾è®¡**

```
ç”¨æˆ·è¡¨å’Œè®¢å•è¡¨æŒ‰ç›¸åŒè§„åˆ™åˆ†ç‰‡ï¼š

åˆ†ç‰‡0: users_0 + orders_0 (user_id % 4 = 0çš„æ•°æ®)
åˆ†ç‰‡1: users_1 + orders_1 (user_id % 4 = 1çš„æ•°æ®)
åˆ†ç‰‡2: users_2 + orders_2 (user_id % 4 = 2çš„æ•°æ®)
åˆ†ç‰‡3: users_3 + orders_3 (user_id % 4 = 3çš„æ•°æ®)

ä¼˜åŠ¿ï¼šå…³è”æŸ¥è¯¢ä¸éœ€è¦è·¨åˆ†ç‰‡
```

**ğŸ”¸ å…³è”æŸ¥è¯¢ç¤ºä¾‹**

```sql
-- æŸ¥è¯¢ç”¨æˆ·åŠå…¶è®¢å•(å•åˆ†ç‰‡æ‰§è¡Œ)
SELECT u.name, o.total 
FROM users u 
JOIN orders o ON u.id = o.user_id 
WHERE u.id = 12345;

-- è·¯ç”±è®¡ç®—ï¼š12345 % 4 = 1
-- åœ¨åˆ†ç‰‡1æ‰§è¡Œï¼š
SELECT u.name, o.total 
FROM users_1 u 
JOIN orders_1 o ON u.id = o.user_id 
WHERE u.id = 12345;
```

### 5.3 å¤åˆè·¯ç”±è§„åˆ™


**ğŸ”¸ å¤šç»´åº¦è·¯ç”±**

```java
@Component
public class CompoundRouter {
    
    // æŒ‰åœ°åŒº+æ—¶é—´å¤åˆè·¯ç”±
    public String routeByRegionAndTime(String region, Date createTime) {
        String timePartition = formatMonth(createTime); // 202401
        return "orders_" + region + "_" + timePartition;
    }
    
    // æŒ‰ç”¨æˆ·ç±»å‹+IDè·¯ç”±
    public String routeByUserTypeAndId(String userType, Long userId) {
        String typeSuffix = userType.equals("vip") ? "vip" : "normal";
        int shardIndex = (int)(userId % 2);
        return "users_" + typeSuffix + "_" + shardIndex;
    }
}
```

---

## 6. ğŸ”§ åŠ¨æ€è·¯ç”±é…ç½®ç®¡ç†


### 6.1 é…ç½®çƒ­æ›´æ–°æœºåˆ¶


åŠ¨æ€é…ç½®å°±åƒ**å®æ—¶è°ƒæ•´å¯¼èˆªè·¯çº¿**ï¼Œä¸éœ€è¦é‡å¯ç³»ç»Ÿå°±èƒ½æ”¹å˜è·¯ç”±è§„åˆ™ã€‚

**ğŸ”¸ é…ç½®æ›´æ–°æµç¨‹**

```
é…ç½®ä¿®æ”¹ â†’ é…ç½®ä¸­å¿ƒ â†’ é€šçŸ¥æ‰€æœ‰èŠ‚ç‚¹ â†’ å†…å­˜æ›´æ–° â†’ ç”Ÿæ•ˆ
    â”‚          â”‚           â”‚            â”‚         â”‚
    â–¼          â–¼           â–¼            â–¼         â–¼
  ç®¡ç†ç•Œé¢   é…ç½®å­˜å‚¨    æ¶ˆæ¯æ¨é€      æœ¬åœ°åˆ·æ–°   è·¯ç”±ç”Ÿæ•ˆ
```

**ğŸ”¸ é…ç½®ç®¡ç†å™¨å®ç°**

```java
@Component
public class DynamicRouteConfig {
    
    private volatile Map<String, RouteRule> routeRules = new ConcurrentHashMap<>();
    
    // ç›‘å¬é…ç½®å˜åŒ–
    @EventListener
    public void onConfigChange(ConfigChangeEvent event) {
        if ("route_rules".equals(event.getKey())) {
            reloadRouteRules(event.getValue());
            log.info("è·¯ç”±è§„åˆ™å·²æ›´æ–°");
        }
    }
    
    // é‡æ–°åŠ è½½è§„åˆ™
    private void reloadRouteRules(String newConfig) {
        Map<String, RouteRule> newRules = parseConfig(newConfig);
        this.routeRules = newRules; // åŸå­æ›¿æ¢
    }
}
```

### 6.2 è·¯ç”±è§„åˆ™ç‰ˆæœ¬ç®¡ç†


**ğŸ”¸ ç‰ˆæœ¬æ§åˆ¶æœºåˆ¶**

```yaml
# è·¯ç”±è§„åˆ™ç‰ˆæœ¬é…ç½®
route_config:
  version: "v2.1.0"
  update_time: "2024-01-15 10:30:00"
  
  rules:
    orders:
      version: "2.1.0"
      algorithm: "mod"
      shards: 8          # ä»4ä¸ªæ‰©å±•åˆ°8ä¸ª
      
  migration:            # è¿ç§»è®¡åˆ’
    from_version: "v2.0.0"
    target_shards: [4, 5, 6, 7]  # æ–°å¢çš„åˆ†ç‰‡
```

**ğŸ”¸ ç‰ˆæœ¬å…¼å®¹å¤„ç†**

```java
// ç‰ˆæœ¬å…¼å®¹è·¯ç”±å™¨
public class VersionCompatibleRouter {
    
    public String route(Long userId, String version) {
        if ("v1.0.0".equals(version)) {
            // è€ç‰ˆæœ¬ï¼š4ä¸ªåˆ†ç‰‡
            return "orders_" + (userId % 4);
        } else if ("v2.0.0".equals(version)) {
            // æ–°ç‰ˆæœ¬ï¼š8ä¸ªåˆ†ç‰‡
            return "orders_" + (userId % 8);
        }
        throw new UnsupportedVersionException(version);
    }
}
```

### 6.3 ç°åº¦è·¯ç”±åˆ‡æ¢


**ğŸ”¸ ç°åº¦åˆ‡æ¢ç­–ç•¥**

```java
@Component
public class GrayRouteManager {
    
    // ç°åº¦æ¯”ä¾‹é…ç½®
    private volatile int grayPercent = 10; // 10%æµé‡ä½¿ç”¨æ–°è§„åˆ™
    
    public String routeWithGray(Long userId) {
        // æ ¹æ®ç”¨æˆ·IDåˆ¤æ–­æ˜¯å¦ä½¿ç”¨ç°åº¦è§„åˆ™
        if (userId % 100 < grayPercent) {
            return newRouteRule.calculate(userId); // æ–°è§„åˆ™
        } else {
            return oldRouteRule.calculate(userId); // è€è§„åˆ™
        }
    }
}
```

---

## 7. ğŸŒ å¤šç»´åº¦è·¯ç”±ç­–ç•¥


### 7.1 æ—¶é—´ç»´åº¦è·¯ç”±


**ğŸ”¸ æŒ‰æ—¶é—´åˆ†ç‰‡**

æ—¶é—´åˆ†ç‰‡å°±åƒ**æŒ‰æœˆä»½æ•´ç†è´¦å•**ï¼ŒæŠŠä¸åŒæ—¶é—´çš„æ•°æ®æ”¾åœ¨ä¸åŒåœ°æ–¹ã€‚

```java
@Component
public class TimeBasedRouter {
    
    // æŒ‰æœˆåˆ†ç‰‡
    public String routeByMonth(Date createTime) {
        SimpleDateFormat formatter = new SimpleDateFormat("yyyyMM");
        String monthStr = formatter.format(createTime);
        return "orders_" + monthStr; // orders_202401
    }
    
    // æŒ‰å­£åº¦åˆ†ç‰‡
    public String routeByQuarter(Date createTime) {
        Calendar cal = Calendar.getInstance();
        cal.setTime(createTime);
        int year = cal.get(Calendar.YEAR);
        int quarter = (cal.get(Calendar.MONTH) / 3) + 1;
        return "sales_" + year + "Q" + quarter; // sales_2024Q1
    }
}
```

**ğŸ”¸ æ—¶é—´åˆ†ç‰‡ä¼˜åŠ¿**

```
âœ… å†å²æ•°æ®æŸ¥è¯¢æ•ˆç‡é«˜
âœ… æ•°æ®å½’æ¡£æ–¹ä¾¿
âœ… ç¬¦åˆä¸šåŠ¡æ—¶é—´ç‰¹æ€§
âœ… ä¾¿äºæ•°æ®æ¸…ç†

åº”ç”¨åœºæ™¯ï¼š
- è®¢å•å†å²è®°å½•
- æ—¥å¿—æ•°æ®å­˜å‚¨  
- è´¢åŠ¡æŠ¥è¡¨æ•°æ®
- ç”¨æˆ·è¡Œä¸ºè½¨è¿¹
```

### 7.2 åœ°ç†ç»´åº¦è·¯ç”±


**ğŸ”¸ æŒ‰åœ°åŒºåˆ†ç‰‡**

```java
@Component
public class GeographyRouter {
    
    // æŒ‰çœä»½è·¯ç”±
    public String routeByProvince(String province) {
        Map<String, String> regionMapping = Map.of(
            "åŒ—äº¬", "north",
            "ä¸Šæµ·", "east", 
            "å¹¿ä¸œ", "south",
            "å››å·", "west"
        );
        
        String region = regionMapping.getOrDefault(province, "default");
        return "users_" + region;
    }
}
```

### 7.3 ä¸šåŠ¡ç»´åº¦è·¯ç”±


**ğŸ”¸ æŒ‰ä¸šåŠ¡ç±»å‹åˆ†ç‰‡**

```java
@Component  
public class BusinessRouter {
    
    // æŒ‰å•†å“ç±»åˆ«è·¯ç”±
    public String routeByCategory(String category) {
        if (category.startsWith("electronics")) {
            return "products_tech";
        } else if (category.startsWith("clothing")) {
            return "products_fashion";
        } else {
            return "products_general";
        }
    }
    
    // æŒ‰ç”¨æˆ·ç­‰çº§è·¯ç”±
    public String routeByUserLevel(String userLevel) {
        return "users_" + userLevel.toLowerCase(); // users_vip, users_normal
    }
}
```

---

## 8. âš¡ è·¯ç”±æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯


### 8.1 è·¯ç”±è®¡ç®—ä¼˜åŒ–


**ğŸ”¸ é¢„è®¡ç®—ä¼˜åŒ–**

```java
@Component
public class OptimizedRouter {
    
    // é¢„è®¡ç®—è·¯ç”±æ˜ å°„è¡¨
    private final Map<Integer, String> routeCache = new ConcurrentHashMap<>();
    
    @PostConstruct
    public void initRouteCache() {
        // é¢„è®¡ç®—å¸¸ç”¨è·¯ç”±ç»“æœ
        for (int i = 0; i < 10000; i++) {
            routeCache.put(i, "shard_" + (i % 4));
        }
    }
    
    public String fastRoute(Integer key) {
        // ç›´æ¥æŸ¥è¡¨ï¼Œé¿å…é‡å¤è®¡ç®—
        return routeCache.getOrDefault(key, calculateRoute(key));
    }
}
```

**ğŸ”¸ æ‰¹é‡è·¯ç”±ä¼˜åŒ–**

```java
// æ‰¹é‡è·¯ç”±è®¡ç®—
public Map<String, List<Long>> batchRoute(List<Long> userIds) {
    Map<String, List<Long>> shardGroups = new HashMap<>();
    
    for (Long userId : userIds) {
        String shard = calculateShard(userId);
        shardGroups.computeIfAbsent(shard, k -> new ArrayList<>()).add(userId);
    }
    
    return shardGroups;
}
```

### 8.2 SQLè§£æä¼˜åŒ–


**ğŸ”¸ è§£æç»“æœç¼“å­˜**

```java
@Component
public class SQLParseCache {
    
    private final Cache<String, ParseResult> parseCache = 
        CacheBuilder.newBuilder()
            .maximumSize(10000)
            .expireAfterWrite(1, TimeUnit.HOURS)
            .build();
    
    public ParseResult parseSQL(String sql) {
        return parseCache.get(sql, () -> doParseSQL(sql));
    }
}
```

### 8.3 è¿æ¥æ± ä¼˜åŒ–


**ğŸ”¸ åˆ†ç‰‡è¿æ¥æ± ç®¡ç†**

```java
@Configuration
public class ShardConnectionConfig {
    
    // æ¯ä¸ªåˆ†ç‰‡ç‹¬ç«‹çš„è¿æ¥æ± 
    @Bean
    public Map<String, DataSource> shardDataSources() {
        Map<String, DataSource> dataSources = new HashMap<>();
        
        for (int i = 0; i < 4; i++) {
            HikariConfig config = new HikariConfig();
            config.setJdbcUrl("jdbc:mysql://localhost:3306/shard_" + i);
            config.setMaximumPoolSize(20); // æ¯ä¸ªåˆ†ç‰‡20ä¸ªè¿æ¥
            config.setConnectionTimeout(3000);
            
            dataSources.put("shard_" + i, new HikariDataSource(config));
        }
        
        return dataSources;
    }
}
```

---

## 9. ğŸ’¾ è·¯ç”±ç¼“å­˜æœºåˆ¶è®¾è®¡


### 9.1 è·¯ç”±ç»“æœç¼“å­˜


**ğŸ”¸ å¤šå±‚ç¼“å­˜æ¶æ„**

```
åº”ç”¨å±‚ç¼“å­˜ â†’ è·¯ç”±è®¡ç®—ç¼“å­˜ â†’ æ•°æ®åº“è¿æ¥ç¼“å­˜
     â”‚              â”‚              â”‚
     â–¼              â–¼              â–¼
  æœ¬åœ°ç¼“å­˜      è·¯ç”±ç»“æœç¼“å­˜     è¿æ¥æ± ç¼“å­˜
```

**ğŸ”¸ ç¼“å­˜å®ç°**

```java
@Component
public class RouteResultCache {
    
    // L1ç¼“å­˜ï¼šæœ¬åœ°å†…å­˜ç¼“å­˜
    private final Cache<String, String> localCache = 
        CacheBuilder.newBuilder()
            .maximumSize(5000)
            .expireAfterWrite(10, TimeUnit.MINUTES)
            .build();
    
    // L2ç¼“å­˜ï¼šRedisåˆ†å¸ƒå¼ç¼“å­˜
    @Autowired
    private RedisTemplate<String, String> redisTemplate;
    
    public String getRoute(String routeKey) {
        // å…ˆæŸ¥æœ¬åœ°ç¼“å­˜
        String result = localCache.getIfPresent(routeKey);
        if (result != null) return result;
        
        // å†æŸ¥Redisç¼“å­˜
        result = redisTemplate.opsForValue().get("route:" + routeKey);
        if (result != null) {
            localCache.put(routeKey, result);
            return result;
        }
        
        // æœ€åè®¡ç®—å¹¶ç¼“å­˜
        result = calculateRoute(routeKey);
        localCache.put(routeKey, result);
        redisTemplate.opsForValue().set("route:" + routeKey, result, 
            Duration.ofHours(1));
        
        return result;
    }
}
```

### 9.2 æ™ºèƒ½ç¼“å­˜æ›´æ–°


**ğŸ”¸ ç¼“å­˜å¤±æ•ˆç­–ç•¥**

```java
@Component
public class SmartCacheManager {
    
    // ç›‘å¬è·¯ç”±è§„åˆ™å˜åŒ–
    @EventListener
    public void onRouteRuleChange(RouteRuleChangeEvent event) {
        String affectedTable = event.getTableName();
        
        // æ¸…ç†ç›¸å…³ç¼“å­˜
        clearCacheByPattern("route:" + affectedTable + ":*");
        
        // é¢„çƒ­æ–°è§„åˆ™çš„ç¼“å­˜
        preWarmCache(affectedTable, event.getNewRule());
    }
    
    // ç¼“å­˜é¢„çƒ­
    private void preWarmCache(String table, RouteRule newRule) {
        CompletableFuture.runAsync(() -> {
            // å¼‚æ­¥é¢„çƒ­çƒ­ç‚¹æ•°æ®çš„è·¯ç”±ç»“æœ
            for (Long hotKey : getHotKeys(table)) {
                String route = newRule.calculate(hotKey);
                cacheRoute(table, hotKey, route);
            }
        });
    }
}
```

---

## 10. ğŸ”„ è·¯ç”±æ•…éšœåˆ‡æ¢æœºåˆ¶


### 10.1 æ•…éšœæ£€æµ‹æœºåˆ¶


**ğŸ”¸ å¥åº·æ£€æŸ¥**

```java
@Component
public class ShardHealthChecker {
    
    @Scheduled(fixedRate = 30000) // 30ç§’æ£€æŸ¥ä¸€æ¬¡
    public void checkShardHealth() {
        for (String shardName : getAllShards()) {
            try {
                // æ‰§è¡Œç®€å•æŸ¥è¯¢æµ‹è¯•è¿é€šæ€§
                testQuery(shardName);
                markShardHealthy(shardName);
            } catch (Exception e) {
                markShardUnhealthy(shardName);
                log.warn("åˆ†ç‰‡{}å¥åº·æ£€æŸ¥å¤±è´¥: {}", shardName, e.getMessage());
            }
        }
    }
    
    private void testQuery(String shardName) {
        DataSource ds = getDataSource(shardName);
        try (Connection conn = ds.getConnection()) {
            PreparedStatement ps = conn.prepareStatement("SELECT 1");
            ps.executeQuery();
        }
    }
}
```

### 10.2 è‡ªåŠ¨æ•…éšœåˆ‡æ¢


**ğŸ”¸ ä¸»å¤‡åˆ‡æ¢æœºåˆ¶**

```java
@Component
public class FailoverRouter {
    
    private volatile Map<String, String> shardBackupMapping = Map.of(
        "shard_0", "shard_0_backup",
        "shard_1", "shard_1_backup"
    );
    
    public String routeWithFailover(String originalShard) {
        if (isShardHealthy(originalShard)) {
            return originalShard;
        }
        
        // åˆ‡æ¢åˆ°å¤‡ä»½åˆ†ç‰‡
        String backupShard = shardBackupMapping.get(originalShard);
        if (backupShard != null && isShardHealthy(backupShard)) {
            log.info("åˆ†ç‰‡{}æ•…éšœï¼Œåˆ‡æ¢åˆ°å¤‡ä»½åˆ†ç‰‡{}", originalShard, backupShard);
            return backupShard;
        }
        
        throw new ShardUnavailableException("åˆ†ç‰‡" + originalShard + "åŠå…¶å¤‡ä»½éƒ½ä¸å¯ç”¨");
    }
}
```

### 10.3 è¯»å†™åˆ†ç¦»è·¯ç”±


**ğŸ”¸ è¯»å†™åˆ†ç¦»ç­–ç•¥**

```java
@Component
public class ReadWriteRouter {
    
    public String routeQuery(String operation, String logicalShard) {
        if (isReadOperation(operation)) {
            // è¯»æ“ä½œè·¯ç”±åˆ°ä»åº“
            List<String> readShards = getReadShards(logicalShard);
            return selectReadShard(readShards); // è´Ÿè½½å‡è¡¡é€‰æ‹©
        } else {
            // å†™æ“ä½œè·¯ç”±åˆ°ä¸»åº“
            return getMasterShard(logicalShard);
        }
    }
    
    private String selectReadShard(List<String> readShards) {
        // ç®€å•è½®è¯¢è´Ÿè½½å‡è¡¡
        int index = (int)(System.currentTimeMillis() % readShards.size());
        return readShards.get(index);
    }
}
```

---

## 11. ğŸ”— è´Ÿè½½å‡è¡¡ä¸è·¯ç”±åè°ƒ


### 11.1 è´Ÿè½½å‡è¡¡ç®—æ³•é›†æˆ


**ğŸ”¸ åŠ æƒè½®è¯¢ç®—æ³•**

```java
@Component
public class WeightedRoundRobinRouter {
    
    private static class ShardWeight {
        String shardName;
        int weight;        // æƒé‡
        int currentWeight; // å½“å‰æƒé‡
    }
    
    private volatile List<ShardWeight> shardWeights = Arrays.asList(
        new ShardWeight("shard_0", 3, 0), // é«˜æ€§èƒ½æœåŠ¡å™¨ï¼Œæƒé‡3
        new ShardWeight("shard_1", 2, 0), // ä¸­ç­‰æ€§èƒ½ï¼Œæƒé‡2  
        new ShardWeight("shard_2", 1, 0)  // ä½æ€§èƒ½ï¼Œæƒé‡1
    );
    
    public synchronized String selectShard() {
        int totalWeight = shardWeights.stream().mapToInt(sw -> sw.weight).sum();
        
        // å¢åŠ å½“å‰æƒé‡
        for (ShardWeight sw : shardWeights) {
            sw.currentWeight += sw.weight;
        }
        
        // é€‰æ‹©å½“å‰æƒé‡æœ€é«˜çš„
        ShardWeight selected = shardWeights.stream()
            .max(Comparator.comparingInt(sw -> sw.currentWeight))
            .orElse(shardWeights.get(0));
        
        // å‡å°‘é€‰ä¸­çš„å½“å‰æƒé‡
        selected.currentWeight -= totalWeight;
        
        return selected.shardName;
    }
}
```

### 11.2 è¿æ¥æ± ç®¡ç†åè°ƒ


**ğŸ”¸ åŠ¨æ€è¿æ¥æ± è°ƒæ•´**

```java
@Component
public class DynamicConnectionManager {
    
    // ç›‘æ§åˆ†ç‰‡è´Ÿè½½
    @Scheduled(fixedRate = 60000) // 1åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
    public void adjustConnectionPools() {
        for (String shardName : getAllShards()) {
            ShardMetrics metrics = getShardMetrics(shardName);
            
            // æ ¹æ®è´Ÿè½½è°ƒæ•´è¿æ¥æ± å¤§å°
            if (metrics.getCpuUsage() > 80) {
                // é«˜è´Ÿè½½ï¼šå¢åŠ è¿æ¥æ± 
                increasePoolSize(shardName, 5);
            } else if (metrics.getCpuUsage() < 20) {
                // ä½è´Ÿè½½ï¼šå‡å°‘è¿æ¥æ± 
                decreasePoolSize(shardName, 2);
            }
        }
    }
    
    private void adjustPoolSize(String shardName, int delta) {
        HikariDataSource ds = (HikariDataSource) getDataSource(shardName);
        int currentSize = ds.getMaximumPoolSize();
        int newSize = Math.max(5, Math.min(50, currentSize + delta));
        
        if (newSize != currentSize) {
            ds.setMaximumPoolSize(newSize);
            log.info("è°ƒæ•´åˆ†ç‰‡{}è¿æ¥æ± å¤§å°: {} -> {}", shardName, currentSize, newSize);
        }
    }
}
```

---

## 12. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 12.1 æ•°æ®è·¯ç”±å…³é”®æ¦‚å¿µ


> ğŸ¯ **æ ¸å¿ƒç†è§£è¦ç‚¹**
> - **æ•°æ®è·¯ç”±**: åˆ†åº“åˆ†è¡¨åSQLè¯·æ±‚çš„"å¯¼èˆªç³»ç»Ÿ"
> - **è·¯ç”±è§„åˆ™**: å†³å®šæ•°æ®å­˜å‚¨å’ŒæŸ¥è¯¢ä½ç½®çš„"åœ°å›¾"  
> - **åˆ†ç‰‡ç®—æ³•**: è®¡ç®—æ•°æ®åº”è¯¥å»å“ªä¸ªåˆ†ç‰‡çš„"è®¡ç®—å™¨"
> - **æ•…éšœåˆ‡æ¢**: åˆ†ç‰‡ä¸å¯ç”¨æ—¶çš„"å¤‡ç”¨æ–¹æ¡ˆ"

### 12.2 å¿…é¡»æŒæ¡çš„æŠ€æœ¯è¦ç‚¹


**ğŸ”¸ è·¯ç”±ç®—æ³•é€‰æ‹©**

| **åœºæ™¯** | **æ¨èç®—æ³•** | **ç†ç”±** |
|---------|-------------|----------|
| **ç”¨æˆ·æ•°æ®** | `å–æ¨¡ç®—æ³•` | `ç”¨æˆ·IDåˆ†å¸ƒå‡åŒ€ï¼Œè®¡ç®—ç®€å•` |
| **æ—¶é—´æ•°æ®** | `èŒƒå›´ç®—æ³•` | `æ—¶é—´æŸ¥è¯¢å‹å¥½ï¼Œä¾¿äºå½’æ¡£` |
| **å­—ç¬¦ä¸²æ•°æ®** | `å“ˆå¸Œç®—æ³•` | `åˆ†å¸ƒå‡åŒ€ï¼Œé¿å…çƒ­ç‚¹` |
| **åŠ¨æ€æ‰©å®¹** | `ä¸€è‡´æ€§å“ˆå¸Œ` | `æ‰©å®¹æ—¶æ•°æ®è¿ç§»æœ€å°‘` |

**ğŸ”¸ æ€§èƒ½ä¼˜åŒ–è¦ç‚¹**

```
âœ… è·¯ç”±è®¡ç®—ç¼“å­˜ï¼šé¿å…é‡å¤è®¡ç®—
âœ… SQLè§£æç¼“å­˜ï¼šæé«˜è§£ææ•ˆç‡  
âœ… è¿æ¥æ± ä¼˜åŒ–ï¼šåˆç†é…ç½®è¿æ¥æ•°
âœ… æ‰¹é‡è·¯ç”±ï¼šå‡å°‘å•æ¬¡è·¯ç”±å¼€é”€
âœ… é¢„è®¡ç®—ä¼˜åŒ–ï¼šæå‰è®¡ç®—çƒ­ç‚¹è·¯ç”±
```

### 12.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ”¸ è·¯ç”±è§„åˆ™è®¾è®¡åŸåˆ™**

> ğŸ’¡ **è®¾è®¡å»ºè®®**  
> 1. **ä¸šåŠ¡ç›¸å…³æ€§**: ç›¸å…³æ•°æ®å°½é‡åœ¨åŒä¸€åˆ†ç‰‡
> 2. **æŸ¥è¯¢å‹å¥½æ€§**: å¸¸ç”¨æŸ¥è¯¢æ¡ä»¶ä½œä¸ºåˆ†ç‰‡é”®
> 3. **æ‰©å±•æ€§è€ƒè™‘**: é¢„ç•™è¶³å¤Ÿçš„æ‰©å±•ç©ºé—´
> 4. **è¿ç»´ä¾¿åˆ©æ€§**: è§„åˆ™è¦å®¹æ˜“ç†è§£å’Œç»´æŠ¤

**ğŸ”¸ å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ**

```
çƒ­ç‚¹æ•°æ®é—®é¢˜ï¼š
â†’ ä½¿ç”¨å“ˆå¸Œç®—æ³•å‡åŒ€åˆ†å¸ƒ
â†’ å¢åŠ ç¼“å­˜å±‚ç¼“è§£å‹åŠ›

è·¨åˆ†ç‰‡æŸ¥è¯¢ï¼š
â†’ åº”ç”¨å±‚åˆå¹¶ç»“æœ
â†’ ä½¿ç”¨ä¸­é—´ä»¶è‡ªåŠ¨å¤„ç†

æ•°æ®è¿ç§»ï¼š
â†’ é‡‡ç”¨ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•
â†’ è®¾è®¡å¹³æ»‘è¿ç§»æ–¹æ¡ˆ

æ€§èƒ½ç“¶é¢ˆï¼š
â†’ è·¯ç”±ç»“æœç¼“å­˜
â†’ è¿æ¥æ± ä¼˜åŒ–
â†’ è¯»å†™åˆ†ç¦»
```

### 12.4 å­¦ä¹ è¿›é˜¶è·¯å¾„


**ğŸ”¸ å­¦ä¹ å»ºè®®**

ğŸ”° **å…¥é—¨é˜¶æ®µ**: ç†è§£è·¯ç”±åŸºæœ¬æ¦‚å¿µï¼ŒæŒæ¡ç®€å•ç®—æ³•  
ğŸ”¸ **è¿›é˜¶é˜¶æ®µ**: å­¦ä¹ å¤æ‚è·¯ç”±è§„åˆ™ï¼Œæ€§èƒ½ä¼˜åŒ–æŠ€å·§  
â­ **é«˜çº§é˜¶æ®µ**: æŒæ¡æ•…éšœåˆ‡æ¢ï¼ŒåŠ¨æ€æ‰©å®¹æ–¹æ¡ˆ  
ğŸ† **ä¸“å®¶é˜¶æ®µ**: è®¾è®¡é«˜å¯ç”¨è·¯ç”±æ¶æ„ï¼Œè§£å†³å¤æ‚ä¸šåŠ¡åœºæ™¯

> ğŸš€ **å®è·µå»ºè®®**  
> å…ˆä»ç®€å•çš„å–æ¨¡è·¯ç”±å¼€å§‹ï¼Œé€æ­¥æŒæ¡å¤æ‚çš„è·¯ç”±ç­–ç•¥ã€‚é‡ç‚¹ç†è§£è·¯ç”±è§„åˆ™å¯¹ä¸šåŠ¡çš„å½±å“ï¼Œå­¦ä¼šåœ¨æ€§èƒ½å’Œå¤æ‚åº¦ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ç‚¹ã€‚

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- æ•°æ®è·¯ç”±æ˜¯åˆ†åº“åˆ†è¡¨çš„æ ¸å¿ƒæŠ€æœ¯
- è·¯ç”±ç®—æ³•è¦æ ¹æ®å…·ä½“ä¸šåŠ¡åœºæ™¯é€‰æ‹©
- æ€§èƒ½ä¼˜åŒ–é‡ç‚¹åœ¨ç¼“å­˜å’Œè¿æ¥æ± ç®¡ç†  
- æ•…éšœåˆ‡æ¢æœºåˆ¶ä¿è¯ç³»ç»Ÿé«˜å¯ç”¨æ€§
- è·¯ç”±è§„åˆ™è®¾è®¡è¦å…¼é¡¾æ€§èƒ½å’Œæ‰©å±•æ€§