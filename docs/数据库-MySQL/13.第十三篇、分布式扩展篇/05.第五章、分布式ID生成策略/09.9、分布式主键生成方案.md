---
title: 9ã€åˆ†å¸ƒå¼ä¸»é”®ç”Ÿæˆæ–¹æ¡ˆ
---
## ğŸ“š ç›®å½•

1. [åˆ†å¸ƒå¼ä¸»é”®çš„æ¦‚å¿µä¸æŒ‘æˆ˜](#1-åˆ†å¸ƒå¼ä¸»é”®çš„æ¦‚å¿µä¸æŒ‘æˆ˜)
2. [é›ªèŠ±ç®—æ³•Snowflakeè¯¦è§£](#2-é›ªèŠ±ç®—æ³•Snowflakeè¯¦è§£)
3. [UUIDç”Ÿæˆç­–ç•¥è¯¦è§£](#3-UUIDç”Ÿæˆç­–ç•¥è¯¦è§£)
4. [å·æ®µæ¨¡å¼å®ç°æ–¹æ¡ˆ](#4-å·æ®µæ¨¡å¼å®ç°æ–¹æ¡ˆ)
5. [å…¶ä»–å¸¸ç”¨ç”Ÿæˆæ–¹æ¡ˆ](#5-å…¶ä»–å¸¸ç”¨ç”Ÿæˆæ–¹æ¡ˆ)
6. [æ–¹æ¡ˆé€‰æ‹©ä¸æœ€ä½³å®è·µ](#6-æ–¹æ¡ˆé€‰æ‹©ä¸æœ€ä½³å®è·µ)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ åˆ†å¸ƒå¼ä¸»é”®çš„æ¦‚å¿µä¸æŒ‘æˆ˜


### 1.1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ä¸»é”®


**åˆ†å¸ƒå¼ä¸»é”®**å°±æ˜¯åœ¨å¤šå°æœºå™¨ä¸Šï¼Œèƒ½å¤Ÿä¿è¯ç”Ÿæˆçš„ä¸»é”®IDåœ¨å…¨çƒèŒƒå›´å†…éƒ½æ˜¯å”¯ä¸€çš„ã€‚ç®€å•è¯´å°±æ˜¯ï¼š**æ— è®ºåœ¨å“ªå°æœåŠ¡å™¨ä¸Šç”ŸæˆIDï¼Œéƒ½ä¸ä¼šé‡å¤**ã€‚

> **ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ä¸»é”®ï¼Ÿ**
> åœ¨å•æœºæ•°æ®åº“æ—¶ä»£ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ•°æ®åº“çš„è‡ªå¢ä¸»é”®ï¼Œæ¯”å¦‚MySQLçš„`AUTO_INCREMENT`ï¼Œå®ƒä¼šè‡ªåŠ¨ä»1ã€2ã€3è¿™æ ·é€’å¢ã€‚ä½†æ˜¯å½“æˆ‘ä»¬çš„ç³»ç»Ÿæ‰©å±•åˆ°å¤šå°æœåŠ¡å™¨ã€å¤šä¸ªæ•°æ®åº“æ—¶ï¼Œæ¯å°æœºå™¨éƒ½ä»1å¼€å§‹è‡ªå¢ï¼Œå°±ä¼šäº§ç”Ÿé‡å¤çš„IDã€‚

```
å•æœºæƒ…å†µï¼ˆæ²¡é—®é¢˜ï¼‰ï¼š
æ•°æ®åº“Aï¼šID = 1, 2, 3, 4, 5...

åˆ†å¸ƒå¼æƒ…å†µï¼ˆæœ‰é—®é¢˜ï¼‰ï¼š
æ•°æ®åº“Aï¼šID = 1, 2, 3, 4, 5...  â† é‡å¤äº†ï¼
æ•°æ®åº“Bï¼šID = 1, 2, 3, 4, 5...  â† é‡å¤äº†ï¼
æ•°æ®åº“Cï¼šID = 1, 2, 3, 4, 5...  â† é‡å¤äº†ï¼
```

### 1.2 åˆ†å¸ƒå¼ä¸»é”®çš„åŸºæœ¬è¦æ±‚


ä¸€ä¸ªå¥½çš„åˆ†å¸ƒå¼ä¸»é”®æ–¹æ¡ˆéœ€è¦æ»¡è¶³ä»¥ä¸‹**æ ¸å¿ƒè¦æ±‚**ï¼š

| **è¦æ±‚** | **å«ä¹‰è§£é‡Š** | **ä¸ºä»€ä¹ˆé‡è¦** |
|---------|-------------|-------------|
| **å…¨å±€å”¯ä¸€æ€§** | `åœ¨æ•´ä¸ªç³»ç»Ÿä¸­ç»å¯¹ä¸èƒ½é‡å¤` | `é¿å…æ•°æ®å†²çªï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§` |
| **é«˜æ€§èƒ½** | `ç”Ÿæˆé€Ÿåº¦è¦å¿«ï¼Œä¸èƒ½æˆä¸ºç“¶é¢ˆ` | `é«˜å¹¶å‘åœºæ™¯ä¸‹ä¿è¯ç³»ç»Ÿå“åº”é€Ÿåº¦` |
| **é«˜å¯ç”¨æ€§** | `æœåŠ¡ä¸èƒ½åœï¼Œè¦7Ã—24å°æ—¶å·¥ä½œ` | `é¿å…å› ä¸ºIDç”ŸæˆæœåŠ¡æ•…éšœå½±å“ä¸šåŠ¡` |
| **è¶‹åŠ¿é€’å¢** | `å¤§è‡´æŒ‰æ—¶é—´é¡ºåºé€’å¢` | `æ•°æ®åº“ç´¢å¼•æ€§èƒ½æ›´å¥½ï¼Œä¾¿äºæ’åºæŸ¥è¯¢` |

**å…¶ä»–æœŸæœ›ç‰¹æ€§**ï¼š

- **å¯è¯»æ€§**ï¼šæœ€å¥½èƒ½ä»IDçœ‹å‡ºä¸€äº›æœ‰ç”¨ä¿¡æ¯ï¼ˆæ¯”å¦‚ç”Ÿæˆæ—¶é—´ï¼‰
- **å®‰å…¨æ€§**ï¼šä¸èƒ½è½»æ˜“è¢«åˆ«äººçŒœæµ‹åˆ°ä¸‹ä¸€ä¸ªID
- **é•¿åº¦åˆé€‚**ï¼šä¸èƒ½å¤ªé•¿å½±å“å­˜å‚¨ï¼Œä¹Ÿä¸èƒ½å¤ªçŸ­ä¸å¤Ÿç”¨

### 1.3 åˆ†å¸ƒå¼IDé¢ä¸´çš„æ ¸å¿ƒæŒ‘æˆ˜


**ğŸ”¸ æ—¶é’Ÿé—®é¢˜**
```
æŒ‘æˆ˜ï¼šä¸åŒæœºå™¨çš„æ—¶é’Ÿå¯èƒ½ä¸åŒæ­¥
å½±å“ï¼šåŸºäºæ—¶é—´æˆ³çš„IDå¯èƒ½å‡ºç°å€’é€€
è§£å†³ï¼šéœ€è¦æ—¶é’ŸåŒæ­¥æœºåˆ¶æˆ–å®¹é”™å¤„ç†
```

**ğŸ”¸ å¹¶å‘é—®é¢˜**
```
æŒ‘æˆ˜ï¼šåŒä¸€æ¯«ç§’å†…å¯èƒ½æœ‰å¤šä¸ªè¯·æ±‚
å½±å“ï¼šå¯èƒ½ç”Ÿæˆç›¸åŒçš„ID
è§£å†³ï¼šéœ€è¦åºåˆ—å·æˆ–å…¶ä»–åŒºåˆ†æœºåˆ¶
```

**ğŸ”¸ æœºå™¨æ ‡è¯†é—®é¢˜**
```
æŒ‘æˆ˜ï¼šå¦‚ä½•ç»™æ¯å°æœºå™¨åˆ†é…å”¯ä¸€æ ‡è¯†
å½±å“ï¼šæœºå™¨IDå†²çªä¼šå¯¼è‡´ç”Ÿæˆé‡å¤ID
è§£å†³ï¼šéœ€è¦æœºå™¨IDåˆ†é…å’Œç®¡ç†ç­–ç•¥
```

---

## 2. â„ï¸ é›ªèŠ±ç®—æ³•Snowflakeè¯¦è§£


### 2.1 é›ªèŠ±ç®—æ³•çš„åŸºæœ¬åŸç†


**é›ªèŠ±ç®—æ³•ï¼ˆSnowflakeï¼‰**æ˜¯Twitterå¼€æºçš„åˆ†å¸ƒå¼IDç”Ÿæˆç®—æ³•ï¼Œå®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š**æŠŠä¸€ä¸ª64ä½çš„longå‹æ•°å­—æŒ‰ä½åˆ†æ®µï¼Œæ¯æ®µä»£è¡¨ä¸åŒå«ä¹‰**ã€‚

```
é›ªèŠ±ç®—æ³•64ä½ç»“æ„å›¾ï¼š

0 - 0000000000 0000000000 0000000000 0000000000 0 - 00000 - 00000 - 000000000000
â†‘   â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 41ä½æ—¶é—´æˆ³ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’   â†5ä½æœºå™¨IDâ†’ â†5ä½æ•°æ®ä¸­å¿ƒIDâ†’ â†12ä½åºåˆ—å·â†’
ç¬¦å·ä½                æ—¶é—´æˆ³                    æ•°æ®ä¸­å¿ƒID  æœºå™¨ID    åºåˆ—å·
```

**å„éƒ¨åˆ†è¯¦ç»†è§£é‡Š**ï¼š

| **å­—æ®µ** | **ä½æ•°** | **å«ä¹‰** | **å–å€¼èŒƒå›´** |
|---------|---------|---------|-------------|
| **ç¬¦å·ä½** | `1ä½` | `å›ºå®šä¸º0ï¼ˆæ­£æ•°ï¼‰` | `0` |
| **æ—¶é—´æˆ³** | `41ä½` | `å½“å‰æ—¶é—´-èµ·å§‹æ—¶é—´çš„æ¯«ç§’æ•°` | `0 ~ 2^41-1ï¼ˆçº¦69å¹´ï¼‰` |
| **æ•°æ®ä¸­å¿ƒID** | `5ä½` | `æ•°æ®ä¸­å¿ƒæ ‡è¯†` | `0 ~ 31ï¼ˆ32ä¸ªæ•°æ®ä¸­å¿ƒï¼‰` |
| **æœºå™¨ID** | `5ä½` | `æœºå™¨æ ‡è¯†` | `0 ~ 31ï¼ˆæ¯ä¸ªæ•°æ®ä¸­å¿ƒ32å°æœºå™¨ï¼‰` |
| **åºåˆ—å·** | `12ä½` | `åŒä¸€æ¯«ç§’å†…çš„åºåˆ—å·` | `0 ~ 4095ï¼ˆæ¯æ¯«ç§’4096ä¸ªIDï¼‰` |

### 2.2 é›ªèŠ±ç®—æ³•çš„å·¥ä½œæµç¨‹


```
é›ªèŠ±ç®—æ³•ç”ŸæˆIDæµç¨‹ï¼š

1. è·å–å½“å‰æ—¶é—´æˆ³
   â†“
2. æ£€æŸ¥æ—¶é’Ÿæ˜¯å¦å›æ‹¨
   â†“
3. å¦‚æœæ—¶é—´æˆ³ç›¸åŒï¼Œåºåˆ—å·+1
   â†“
4. å¦‚æœåºåˆ—å·ç”¨å®Œï¼Œç­‰å¾…ä¸‹ä¸€æ¯«ç§’
   â†“
5. ç»„è£…æœ€ç»ˆçš„64ä½ID
   â†“
6. è¿”å›ç”Ÿæˆçš„ID
```

### 2.3 Twitter Snowflakeç®—æ³•å®ç°


```java
/**
 * Twitteré›ªèŠ±ç®—æ³•å®ç°
 * ç”Ÿæˆ64ä½å”¯ä¸€ID
 */
public class SnowflakeIdGenerator {
    
    // èµ·å§‹æ—¶é—´æˆ³ (2020-01-01 00:00:00)
    private final long startTimestamp = 1577808000000L;
    
    // å„éƒ¨åˆ†å ç”¨ä½æ•°
    private final long datacenterIdBits = 5L;  // æ•°æ®ä¸­å¿ƒIDä½æ•°
    private final long machineIdBits = 5L;     // æœºå™¨IDä½æ•°
    private final long sequenceBits = 12L;     // åºåˆ—å·ä½æ•°
    
    // æœ€å¤§å€¼è®¡ç®—
    private final long maxDatacenterId = ~(-1L << datacenterIdBits); // 31
    private final long maxMachineId = ~(-1L << machineIdBits);       // 31
    private final long maxSequence = ~(-1L << sequenceBits);         // 4095
    
    // ä½ç§»é‡
    private final long machineIdShift = sequenceBits;                          // 12
    private final long datacenterIdShift = sequenceBits + machineIdBits;       // 17
    private final long timestampShift = sequenceBits + machineIdBits + datacenterIdBits; // 22
    
    private final long datacenterId;
    private final long machineId;
    private long sequence = 0L;
    private long lastTimestamp = -1L;
    
    /**
     * æ„é€ å‡½æ•°
     * @param datacenterId æ•°æ®ä¸­å¿ƒID (0-31)
     * @param machineId æœºå™¨ID (0-31)
     */
    public SnowflakeIdGenerator(long datacenterId, long machineId) {
        if (datacenterId > maxDatacenterId || datacenterId < 0) {
            throw new IllegalArgumentException("æ•°æ®ä¸­å¿ƒIDè¶…å‡ºèŒƒå›´: " + datacenterId);
        }
        if (machineId > maxMachineId || machineId < 0) {
            throw new IllegalArgumentException("æœºå™¨IDè¶…å‡ºèŒƒå›´: " + machineId);
        }
        this.datacenterId = datacenterId;
        this.machineId = machineId;
    }
    
    /**
     * ç”Ÿæˆä¸‹ä¸€ä¸ªID
     */
    public synchronized long nextId() {
        long timestamp = getCurrentTimestamp();
        
        // æ£€æŸ¥æ—¶é’Ÿå›æ‹¨
        if (timestamp < lastTimestamp) {
            throw new RuntimeException("æ—¶é’Ÿå›æ‹¨ï¼Œæ‹’ç»ç”ŸæˆID");
        }
        
        // åŒä¸€æ¯«ç§’å†…
        if (timestamp == lastTimestamp) {
            sequence = (sequence + 1) & maxSequence;
            // åºåˆ—å·ç”¨å®Œï¼Œç­‰å¾…ä¸‹ä¸€æ¯«ç§’
            if (sequence == 0) {
                timestamp = waitForNextMillis(lastTimestamp);
            }
        } else {
            // æ–°çš„æ¯«ç§’ï¼Œåºåˆ—å·é‡ç½®
            sequence = 0L;
        }
        
        lastTimestamp = timestamp;
        
        // ç»„è£…64ä½ID
        return ((timestamp - startTimestamp) << timestampShift)
                | (datacenterId << datacenterIdShift)
                | (machineId << machineIdShift)
                | sequence;
    }
    
    /**
     * ç­‰å¾…ä¸‹ä¸€æ¯«ç§’
     */
    private long waitForNextMillis(long lastTimestamp) {
        long timestamp = getCurrentTimestamp();
        while (timestamp <= lastTimestamp) {
            timestamp = getCurrentTimestamp();
        }
        return timestamp;
    }
    
    /**
     * è·å–å½“å‰æ—¶é—´æˆ³
     */
    private long getCurrentTimestamp() {
        return System.currentTimeMillis();
    }
}
```

### 2.4 æ—¶é’Ÿå›æ‹¨å¤„ç†æœºåˆ¶


**æ—¶é’Ÿå›æ‹¨**æ˜¯æŒ‡æœåŠ¡å™¨æ—¶é—´çªç„¶å€’é€€ï¼Œè¿™ä¼šå¯¼è‡´ç”Ÿæˆé‡å¤çš„IDã€‚å¤„ç†ç­–ç•¥æœ‰ï¼š

```java
/**
 * æ—¶é’Ÿå›æ‹¨å¤„ç†ç­–ç•¥
 */
public class ClockBackwardHandler {
    
    // ç­–ç•¥1ï¼šç›´æ¥æŠ›å¼‚å¸¸ï¼ˆæœ€å®‰å…¨ï¼‰
    public long handleDirectThrow(long currentTime, long lastTime) {
        if (currentTime < lastTime) {
            throw new RuntimeException("æ£€æµ‹åˆ°æ—¶é’Ÿå›æ‹¨: " + (lastTime - currentTime) + "ms");
        }
        return currentTime;
    }
    
    // ç­–ç•¥2ï¼šç­‰å¾…æ—¶é—´è¿½ä¸Šï¼ˆé€‚ç”¨äºå°å¹…å›æ‹¨ï¼‰
    public long handleWaitForCatchUp(long currentTime, long lastTime) {
        if (currentTime < lastTime) {
            long backwardTime = lastTime - currentTime;
            if (backwardTime > 5000) { // è¶…è¿‡5ç§’ç›´æ¥æŠ›å¼‚å¸¸
                throw new RuntimeException("æ—¶é’Ÿå›æ‹¨æ—¶é—´è¿‡é•¿: " + backwardTime + "ms");
            }
            // ç­‰å¾…æ—¶é—´è¿½ä¸Š
            try {
                Thread.sleep(backwardTime);
            } catch (InterruptedException e) {
                Thread.currentThread().interrupt();
            }
            return System.currentTimeMillis();
        }
        return currentTime;
    }
    
    // ç­–ç•¥3ï¼šä½¿ç”¨ä¸Šæ¬¡æ—¶é—´æˆ³ï¼ˆæœ€åçš„é€‰æ‹©ï¼‰
    public long handleUseLastTimestamp(long currentTime, long lastTime) {
        if (currentTime < lastTime) {
            return lastTime; // ç»§ç»­ä½¿ç”¨ä¸Šæ¬¡çš„æ—¶é—´æˆ³
        }
        return currentTime;
    }
}
```

### 2.5 æœºå™¨IDåˆ†é…ç­–ç•¥


**æœºå™¨ID**éœ€è¦ä¿è¯æ¯å°æœºå™¨éƒ½ä¸åŒï¼Œå¸¸ç”¨åˆ†é…ç­–ç•¥ï¼š

```java
/**
 * æœºå™¨IDåˆ†é…å™¨
 */
public class MachineIdAllocator {
    
    // æ–¹å¼1ï¼šåŸºäºIPåœ°å€
    public static long generateMachineIdByIp() {
        try {
            String hostAddress = InetAddress.getLocalHost().getHostAddress();
            int[] ip = new int[4];
            String[] parts = hostAddress.split("\\.");
            for (int i = 0; i < 4; i++) {
                ip[i] = Integer.parseInt(parts[i]);
            }
            // å–IPæœ€åä¸¤æ®µ
            int machineId = (ip[2] % 32) * 32 + (ip[3] % 32);
            return machineId % 1024; // ä¿è¯åœ¨0-1023èŒƒå›´å†…
        } catch (Exception e) {
            return 1L; // é»˜è®¤å€¼
        }
    }
    
    // æ–¹å¼2ï¼šåŸºäºMACåœ°å€
    public static long generateMachineIdByMac() {
        try {
            NetworkInterface network = NetworkInterface.getByInetAddress(
                InetAddress.getLocalHost());
            byte[] mac = network.getHardwareAddress();
            long id = 0;
            for (int i = 0; i < mac.length; i++) {
                id = id << 8 | (mac[i] & 0xFF);
            }
            return id % 1024;
        } catch (Exception e) {
            return 1L;
        }
    }
    
    // æ–¹å¼3ï¼šä»é…ç½®ä¸­å¿ƒè·å–
    public static long getMachineIdFromConfig() {
        // ä»é…ç½®æ–‡ä»¶æˆ–é…ç½®ä¸­å¿ƒè·å–
        return ConfigManager.getMachineId();
    }
}
```

---

## 3. ğŸ”‘ UUIDç”Ÿæˆç­–ç•¥è¯¦è§£


### 3.1 UUIDçš„åŸºæœ¬æ¦‚å¿µ


**UUIDï¼ˆUniversally Unique Identifierï¼‰**ï¼Œä¸­æ–‡å«"é€šç”¨å”¯ä¸€è¯†åˆ«ç "ï¼Œæ˜¯ä¸€ä¸ª128ä½ï¼ˆ16å­—èŠ‚ï¼‰çš„æ•°å­—ï¼Œé€šå¸¸è¡¨ç¤ºä¸º32ä¸ªåå…­è¿›åˆ¶æ•°å­—ã€‚

> **UUIDçš„æ ¸å¿ƒæ€æƒ³**ï¼šé€šè¿‡ç‰¹å®šç®—æ³•ï¼Œä¿è¯åœ¨æ—¶ç©ºä¸Šçš„å”¯ä¸€æ€§ï¼Œå³ä½¿åœ¨ä¸åŒçš„æœºå™¨ä¸Šã€ä¸åŒçš„æ—¶é—´ç”Ÿæˆï¼Œä¹Ÿå‡ ä¹ä¸å¯èƒ½é‡å¤ã€‚

```
UUIDæ ‡å‡†æ ¼å¼ï¼š
xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx

ç¤ºä¾‹ï¼š
550e8400-e29b-41d4-a716-446655440000
```

### 3.2 UUIDç‰ˆæœ¬é€‰æ‹©ç­–ç•¥


UUIDæœ‰5ä¸ªç‰ˆæœ¬ï¼Œæ¯ä¸ªç‰ˆæœ¬çš„ç”Ÿæˆç®—æ³•ä¸åŒï¼š

```java
/**
 * UUIDå„ç‰ˆæœ¬è¯¦è§£
 */
public class UUIDVersionDemo {
    
    // UUID Version 1: åŸºäºæ—¶é—´æˆ³ + MACåœ°å€
    public static void demonstrateV1() {
        // åŒ…å«ï¼šæ—¶é—´æˆ³ã€æ—¶é’Ÿåºåˆ—ã€MACåœ°å€
        // ä¼˜ç‚¹ï¼šæœ‰æ—¶é—´é¡ºåºæ€§
        // ç¼ºç‚¹ï¼šå¯èƒ½æ³„éœ²MACåœ°å€ä¿¡æ¯
        UUID uuid1 = Generators.timeBasedGenerator().generate();
        System.out.println("UUID v1: " + uuid1);
    }
    
    // UUID Version 4: å®Œå…¨éšæœºï¼ˆæœ€å¸¸ç”¨ï¼‰
    public static void demonstrateV4() {
        // 122ä½éšæœºæ•° + 6ä½ç‰ˆæœ¬ä¿¡æ¯
        // ä¼˜ç‚¹ï¼šå®Œå…¨éšæœºï¼Œæ— éšç§æ³„éœ²
        // ç¼ºç‚¹ï¼šæ— åºï¼Œæ•°æ®åº“ç´¢å¼•æ€§èƒ½å·®
        UUID uuid4 = UUID.randomUUID();
        System.out.println("UUID v4: " + uuid4);
    }
    
    // UUID Version 3: åŸºäºMD5å“ˆå¸Œ
    public static void demonstrateV3() {
        // å¯¹å‘½åç©ºé—´+åç§°è¿›è¡ŒMD5å“ˆå¸Œ
        // åŒæ ·çš„è¾“å…¥æ€»æ˜¯äº§ç”ŸåŒæ ·çš„UUID
        UUID uuid3 = UUID.nameUUIDFromBytes("hello world".getBytes());
        System.out.println("UUID v3: " + uuid3);
    }
    
    // UUID Version 5: åŸºäºSHA-1å“ˆå¸Œ
    public static void demonstrateV5() {
        // ç±»ä¼¼V3ï¼Œä½†ä½¿ç”¨SHA-1ç®—æ³•
        // æ¯”V3æ›´å®‰å…¨ï¼Œæ¨èæ›¿ä»£V3
        UUID namespace = UUID.fromString("6ba7b810-9dad-11d1-80b4-00c04fd430c8");
        UUID uuid5 = Generators.nameBasedGenerator(namespace).generate("hello world");
        System.out.println("UUID v5: " + uuid5);
    }
}
```

**ç‰ˆæœ¬é€‰æ‹©æŒ‡å—**ï¼š

| **ç‰ˆæœ¬** | **ç”Ÿæˆæ–¹å¼** | **ä¼˜ç‚¹** | **ç¼ºç‚¹** | **é€‚ç”¨åœºæ™¯** |
|---------|-------------|---------|---------|-------------|
| **UUID v1** | `æ—¶é—´æˆ³+MACåœ°å€` | `æœ‰æ—¶é—´é¡ºåº` | `å¯èƒ½æ³„éœ²éšç§` | `éœ€è¦æ—¶é—´æ’åºçš„åœºæ™¯` |
| **UUID v4** | `å®Œå…¨éšæœº` | `æ— éšç§é—®é¢˜` | `å®Œå…¨æ— åº` | `ä¸€èˆ¬ä¸šåŠ¡åœºæ™¯` |
| **UUID v3/v5** | `åç§°å“ˆå¸Œ` | `ç¡®å®šæ€§ç”Ÿæˆ` | `éœ€è¦è¾“å…¥å‚æ•°` | `éœ€è¦å¹‚ç­‰çš„åœºæ™¯` |

### 3.3 UUIDæ€§èƒ½ä¼˜åŒ–


```java
/**
 * UUIDæ€§èƒ½ä¼˜åŒ–å®è·µ
 */
public class UUIDOptimization {
    
    // ä¼˜åŒ–1ï¼šä½¿ç”¨ThreadLocalé¿å…é”ç«äº‰
    private static final ThreadLocal<SecureRandom> RANDOM = 
        ThreadLocal.withInitial(SecureRandom::new);
    
    public static String fastUUID() {
        SecureRandom random = RANDOM.get();
        byte[] bytes = new byte[16];
        random.nextBytes(bytes);
        
        // è®¾ç½®ç‰ˆæœ¬å·å’Œå˜ä½“
        bytes[6] &= 0x0f;  // æ¸…é™¤ç‰ˆæœ¬ä½
        bytes[6] |= 0x40;  // è®¾ç½®ç‰ˆæœ¬ä¸º4
        bytes[8] &= 0x3f;  // æ¸…é™¤å˜ä½“ä½
        bytes[8] |= 0x80;  // è®¾ç½®å˜ä½“
        
        return bytesToUUID(bytes);
    }
    
    // ä¼˜åŒ–2ï¼šé¿å…å­—ç¬¦ä¸²æ‹¼æ¥
    private static String bytesToUUID(byte[] bytes) {
        char[] chars = new char[36];
        int pos = 0;
        
        for (int i = 0; i < 16; i++) {
            if (i == 4 || i == 6 || i == 8 || i == 10) {
                chars[pos++] = '-';
            }
            int b = bytes[i] & 0xFF;
            chars[pos++] = HEX_CHARS[b >>> 4];
            chars[pos++] = HEX_CHARS[b & 0x0F];
        }
        
        return new String(chars);
    }
    
    private static final char[] HEX_CHARS = 
        "0123456789abcdef".toCharArray();
}
```

### 3.4 æ•°æ®åº“ä¸­UUIDçš„ä½¿ç”¨


```sql
-- MySQLä¸­ä½¿ç”¨UUID
CREATE TABLE users (
    id CHAR(36) PRIMARY KEY DEFAULT (UUID()),  -- æ ‡å‡†UUIDæ ¼å¼
    name VARCHAR(100) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- æˆ–è€…ä½¿ç”¨BINARY(16)å­˜å‚¨ï¼ˆèŠ‚çœç©ºé—´ï¼‰
CREATE TABLE users_optimized (
    id BINARY(16) PRIMARY KEY,  -- 16å­—èŠ‚äºŒè¿›åˆ¶å­˜å‚¨
    name VARCHAR(100) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- æ’å…¥æ—¶çš„å¤„ç†
INSERT INTO users_optimized (id, name) 
VALUES (UNHEX(REPLACE('550e8400-e29b-41d4-a716-446655440000', '-', '')), 'John');

-- æŸ¥è¯¢æ—¶çš„å¤„ç†
SELECT LOWER(CONCAT(
    HEX(SUBSTRING(id, 1, 4)), '-',
    HEX(SUBSTRING(id, 5, 2)), '-',
    HEX(SUBSTRING(id, 7, 2)), '-',
    HEX(SUBSTRING(id, 9, 2)), '-',
    HEX(SUBSTRING(id, 11, 6))
)) as uuid_str, name FROM users_optimized;
```

---

## 4. ğŸ“Š å·æ®µæ¨¡å¼å®ç°æ–¹æ¡ˆ


### 4.1 å·æ®µæ¨¡å¼çš„åŸºæœ¬åŸç†


**å·æ®µæ¨¡å¼**å°±æ˜¯é¢„å…ˆä»æ•°æ®åº“ä¸­æ‰¹é‡è·å–ä¸€æ®µè¿ç»­çš„IDå·ç ï¼Œç„¶ååœ¨å†…å­˜ä¸­é€ä¸ªåˆ†é…ã€‚ç®€å•ç†è§£å°±æ˜¯ï¼š**ä¸€æ¬¡æ€§ä»æ•°æ®åº“æ‹¿1000ä¸ªå·ï¼Œç„¶åæ…¢æ…¢ç”¨**ã€‚

> **ä¸ºä»€ä¹ˆè¦ç”¨å·æ®µæ¨¡å¼ï¼Ÿ**
> ç›´æ¥ä»æ•°æ®åº“è·å–è‡ªå¢IDï¼Œæ¯æ¬¡éƒ½è¦è®¿é—®æ•°æ®åº“ï¼Œæ€§èƒ½å¾ˆå·®ã€‚å·æ®µæ¨¡å¼æ˜¯æ‰¹é‡è·å–ï¼Œå‡å°‘æ•°æ®åº“è®¿é—®æ¬¡æ•°ï¼Œå¤§å¤§æé«˜æ€§èƒ½ã€‚

```
å·æ®µæ¨¡å¼å·¥ä½œæµç¨‹ï¼š

1. åº”ç”¨å¯åŠ¨æ—¶ï¼Œä»æ•°æ®åº“è·å–ä¸€ä¸ªå·æ®µï¼šæ¯”å¦‚1001-2000
2. åœ¨å†…å­˜ä¸­ç»´æŠ¤å½“å‰å€¼ï¼šcurrent = 1001
3. æ¯æ¬¡è¯·æ±‚IDæ—¶ï¼šè¿”å›current++ï¼Œå³1001, 1002, 1003...
4. å½“currentæ¥è¿‘2000æ—¶ï¼Œå†æ¬¡ä»æ•°æ®åº“è·å–ä¸‹ä¸€ä¸ªå·æ®µï¼š2001-3000
5. ç»§ç»­åˆ†é…ï¼š2001, 2002, 2003...
```

### 4.2 å·æ®µæ¨¡å¼æ•°æ®åº“è®¾è®¡


```sql
-- å·æ®µåˆ†é…è¡¨
CREATE TABLE id_segment (
    biz_type VARCHAR(50) PRIMARY KEY,  -- ä¸šåŠ¡ç±»å‹ï¼ˆç”¨æˆ·IDã€è®¢å•IDç­‰ï¼‰
    max_id BIGINT NOT NULL DEFAULT 0,  -- å½“å‰æœ€å¤§IDå€¼
    step INT NOT NULL DEFAULT 1000,   -- æ¯æ¬¡åˆ†é…çš„æ­¥é•¿
    description VARCHAR(200),          -- æè¿°
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- åˆå§‹åŒ–æ•°æ®
INSERT INTO id_segment (biz_type, max_id, step, description) VALUES
('user_id', 0, 1000, 'ç”¨æˆ·IDç”Ÿæˆ'),
('order_id', 0, 5000, 'è®¢å•IDç”Ÿæˆ'),
('product_id', 0, 500, 'å•†å“IDç”Ÿæˆ');
```

### 4.3 å·æ®µæ¨¡å¼æ‰¹é‡è·å–å®ç°


```java
/**
 * å·æ®µæ¨¡å¼IDç”Ÿæˆå™¨
 */
public class SegmentIdGenerator {
    
    // å½“å‰å·æ®µä¿¡æ¯
    private static class Segment {
        private long currentId;    // å½“å‰ID
        private long maxId;        // å·æ®µæœ€å¤§ID
        private int step;          // æ­¥é•¿
        private volatile boolean ready = false; // æ˜¯å¦å‡†å¤‡å¥½
    }
    
    private final String bizType;
    private final DataSource dataSource;
    private Segment currentSegment = new Segment();
    private Segment nextSegment = new Segment();
    private volatile boolean isLoadingNext = false;
    private final Object lock = new Object();
    
    public SegmentIdGenerator(String bizType, DataSource dataSource) {
        this.bizType = bizType;
        this.dataSource = dataSource;
        loadNextSegment(currentSegment); // åˆå§‹åŒ–å½“å‰å·æ®µ
    }
    
    /**
     * è·å–ä¸‹ä¸€ä¸ªID
     */
    public long nextId() {
        while (true) {
            synchronized (lock) {
                // æ£€æŸ¥æ˜¯å¦éœ€è¦åˆ‡æ¢å·æ®µ
                if (currentSegment.currentId >= currentSegment.maxId) {
                    if (nextSegment.ready) {
                        // åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªå·æ®µ
                        Segment temp = currentSegment;
                        currentSegment = nextSegment;
                        nextSegment = temp;
                        nextSegment.ready = false;
                        isLoadingNext = false;
                    } else {
                        // ä¸‹ä¸€ä¸ªå·æ®µè¿˜æ²¡å‡†å¤‡å¥½ï¼Œç­‰å¾…
                        try {
                            lock.wait(100);
                            continue;
                        } catch (InterruptedException e) {
                            Thread.currentThread().interrupt();
                            throw new RuntimeException("è·å–IDè¢«ä¸­æ–­", e);
                        }
                    }
                }
                
                // æ£€æŸ¥æ˜¯å¦éœ€è¦å¼‚æ­¥åŠ è½½ä¸‹ä¸€ä¸ªå·æ®µ
                if (!isLoadingNext && needLoadNext()) {
                    isLoadingNext = true;
                    CompletableFuture.runAsync(() -> loadNextSegment(nextSegment));
                }
                
                // è¿”å›å½“å‰IDå¹¶è‡ªå¢
                return ++currentSegment.currentId;
            }
        }
    }
    
    /**
     * åˆ¤æ–­æ˜¯å¦éœ€è¦åŠ è½½ä¸‹ä¸€ä¸ªå·æ®µ
     * å½“ä½¿ç”¨äº†80%çš„å·æ®µæ—¶å¼€å§‹å¼‚æ­¥åŠ è½½
     */
    private boolean needLoadNext() {
        long used = currentSegment.currentId - (currentSegment.maxId - currentSegment.step);
        return used >= currentSegment.step * 0.8;
    }
    
    /**
     * ä»æ•°æ®åº“åŠ è½½ä¸‹ä¸€ä¸ªå·æ®µ
     */
    private void loadNextSegment(Segment segment) {
        Connection conn = null;
        PreparedStatement stmt = null;
        ResultSet rs = null;
        
        try {
            conn = dataSource.getConnection();
            conn.setAutoCommit(false);
            
            // æŸ¥è¯¢å½“å‰å€¼
            String selectSql = "SELECT max_id, step FROM id_segment WHERE biz_type = ?";
            stmt = conn.prepareStatement(selectSql);
            stmt.setString(1, bizType);
            rs = stmt.executeQuery();
            
            if (!rs.next()) {
                throw new RuntimeException("ä¸šåŠ¡ç±»å‹ä¸å­˜åœ¨: " + bizType);
            }
            
            long maxId = rs.getLong("max_id");
            int step = rs.getInt("step");
            rs.close();
            stmt.close();
            
            // æ›´æ–°æœ€å¤§å€¼
            String updateSql = "UPDATE id_segment SET max_id = max_id + step WHERE biz_type = ?";
            stmt = conn.prepareStatement(updateSql);
            stmt.setString(1, bizType);
            int updated = stmt.executeUpdate();
            
            if (updated == 0) {
                throw new RuntimeException("æ›´æ–°å·æ®µå¤±è´¥");
            }
            
            conn.commit();
            
            // è®¾ç½®å·æ®µä¿¡æ¯
            segment.currentId = maxId;
            segment.maxId = maxId + step;
            segment.step = step;
            segment.ready = true;
            
            synchronized (lock) {
                lock.notifyAll(); // é€šçŸ¥ç­‰å¾…çš„çº¿ç¨‹
            }
            
        } catch (Exception e) {
            try {
                if (conn != null) conn.rollback();
            } catch (SQLException se) {
                // å¿½ç•¥å›æ»šå¼‚å¸¸
            }
            throw new RuntimeException("åŠ è½½å·æ®µå¤±è´¥", e);
        } finally {
            // å…³é—­èµ„æº
            try {
                if (rs != null) rs.close();
                if (stmt != null) stmt.close();
                if (conn != null) conn.close();
            } catch (SQLException e) {
                // å¿½ç•¥å…³é—­å¼‚å¸¸
            }
        }
    }
}
```

### 4.4 åŒå·æ®µç¼“å­˜ä¼˜åŒ–


ä¸ºäº†é¿å…è·å–æ–°å·æ®µæ—¶çš„ç­‰å¾…ï¼Œå¯ä»¥ä½¿ç”¨**åŒå·æ®µç¼“å­˜**ï¼š

```java
/**
 * åŒå·æ®µç¼“å­˜IDç”Ÿæˆå™¨
 */
public class DoubleSegmentIdGenerator {
    
    private final SegmentBuffer segmentBuffer1 = new SegmentBuffer();
    private final SegmentBuffer segmentBuffer2 = new SegmentBuffer();
    private volatile SegmentBuffer currentBuffer;
    private final AtomicBoolean isSwitching = new AtomicBoolean(false);
    
    static class SegmentBuffer {
        private volatile long currentId;
        private volatile long maxId;
        private volatile boolean ready = false;
        private final AtomicLong counter = new AtomicLong(0);
        
        public long nextId() {
            return counter.incrementAndGet() + currentId;
        }
        
        public boolean isExhausted() {
            return counter.get() >= (maxId - currentId);
        }
        
        public double getUsagePercent() {
            return (double) counter.get() / (maxId - currentId);
        }
    }
    
    public long nextId() {
        SegmentBuffer buffer = currentBuffer;
        
        // å½“ä½¿ç”¨ç‡è¶…è¿‡75%æ—¶ï¼Œå‡†å¤‡åˆ‡æ¢ç¼“å†²åŒº
        if (buffer.getUsagePercent() > 0.75) {
            prepareNextBuffer();
        }
        
        // å¦‚æœå½“å‰ç¼“å†²åŒºç”¨å®Œï¼Œåˆ‡æ¢åˆ°å¦ä¸€ä¸ª
        if (buffer.isExhausted()) {
            switchBuffer();
            buffer = currentBuffer;
        }
        
        return buffer.nextId();
    }
    
    private void prepareNextBuffer() {
        if (isSwitching.compareAndSet(false, true)) {
            SegmentBuffer nextBuffer = (currentBuffer == segmentBuffer1) 
                ? segmentBuffer2 : segmentBuffer1;
            
            if (!nextBuffer.ready) {
                CompletableFuture.runAsync(() -> {
                    loadSegment(nextBuffer);
                    isSwitching.set(false);
                });
            }
        }
    }
    
    private void switchBuffer() {
        SegmentBuffer nextBuffer = (currentBuffer == segmentBuffer1) 
            ? segmentBuffer2 : segmentBuffer1;
        
        if (nextBuffer.ready) {
            currentBuffer = nextBuffer;
            nextBuffer.ready = false;
        } else {
            // ç´§æ€¥æƒ…å†µï¼šä¸‹ä¸€ä¸ªç¼“å†²åŒºæ²¡å‡†å¤‡å¥½ï¼ŒåŒæ­¥åŠ è½½
            loadSegment(nextBuffer);
            currentBuffer = nextBuffer;
        }
    }
    
    private void loadSegment(SegmentBuffer buffer) {
        // ä»æ•°æ®åº“åŠ è½½å·æ®µçš„é€»è¾‘
        // ...
    }
}
```

---

## 5. ğŸ”§ å…¶ä»–å¸¸ç”¨ç”Ÿæˆæ–¹æ¡ˆ


### 5.1 æ—¶é—´æˆ³+æœºå™¨IDæ–¹æ¡ˆ


è¿™æ˜¯ä¸€ç§ç®€åŒ–ç‰ˆçš„IDç”Ÿæˆæ–¹æ¡ˆï¼Œé€‚ç”¨äºå¯¹IDé•¿åº¦è¦æ±‚ä¸é«˜çš„åœºæ™¯ï¼š

```java
/**
 * æ—¶é—´æˆ³+æœºå™¨IDæ–¹æ¡ˆ
 */
public class TimestampMachineIdGenerator {
    
    private final long machineId;
    private final AtomicLong sequence = new AtomicLong(0);
    private volatile long lastTimestamp = 0;
    
    public TimestampMachineIdGenerator(long machineId) {
        if (machineId < 0 || machineId > 1023) { // 10ä½æœºå™¨ID
            throw new IllegalArgumentException("æœºå™¨IDè¶…å‡ºèŒƒå›´: " + machineId);
        }
        this.machineId = machineId;
    }
    
    /**
     * ç”ŸæˆIDæ ¼å¼ï¼šæ—¶é—´æˆ³(13ä½) + æœºå™¨ID(3ä½) + åºåˆ—å·(4ä½)
     * ç¤ºä¾‹ï¼š1632729600123001 0001
     */
    public synchronized long nextId() {
        long timestamp = System.currentTimeMillis();
        
        if (timestamp == lastTimestamp) {
            // åŒä¸€æ¯«ç§’å†…ï¼Œåºåˆ—å·é€’å¢
            long seq = sequence.incrementAndGet();
            if (seq > 9999) { // æ¯æ¯«ç§’æœ€å¤š10000ä¸ª
                // ç­‰å¾…ä¸‹ä¸€æ¯«ç§’
                while (timestamp <= lastTimestamp) {
                    timestamp = System.currentTimeMillis();
                }
                sequence.set(0);
                seq = 0;
            }
            return buildId(timestamp, seq);
        } else {
            // æ–°çš„æ¯«ç§’ï¼Œé‡ç½®åºåˆ—å·
            sequence.set(0);
            lastTimestamp = timestamp;
            return buildId(timestamp, 0);
        }
    }
    
    private long buildId(long timestamp, long seq) {
        return timestamp * 10000000L  // æ—¶é—´æˆ³å·¦ç§»7ä½
                + machineId * 10000L   // æœºå™¨IDå·¦ç§»4ä½
                + seq;                 // åºåˆ—å·
    }
    
    /**
     * è§£æIDè·å–ä¿¡æ¯
     */
    public IdInfo parseId(long id) {
        long seq = id % 10000;
        long machineId = (id / 10000) % 1000;
        long timestamp = id / 10000000;
        
        return new IdInfo(timestamp, machineId, seq);
    }
    
    static class IdInfo {
        private final long timestamp;
        private final long machineId;
        private final long sequence;
        
        public IdInfo(long timestamp, long machineId, long sequence) {
            this.timestamp = timestamp;
            this.machineId = machineId;
            this.sequence = sequence;
        }
        
        public Date getGenerateTime() {
            return new Date(timestamp);
        }
        
        // getters...
    }
}
```

### 5.2 æ•°æ®åº“åºåˆ—æ–¹æ¡ˆ


é€‚ç”¨äºå•æœºæˆ–å°è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿï¼š

```sql
-- PostgreSQLåºåˆ—
CREATE SEQUENCE user_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 100;  -- ç¼“å­˜100ä¸ªå€¼æé«˜æ€§èƒ½

-- ä½¿ç”¨åºåˆ—
INSERT INTO users (id, name) VALUES (nextval('user_id_seq'), 'John');

-- MySQLæ¨¡æ‹Ÿåºåˆ—è¡¨
CREATE TABLE sequences (
    name VARCHAR(50) PRIMARY KEY,
    current_value BIGINT NOT NULL DEFAULT 0,
    increment_by INT NOT NULL DEFAULT 1
);

-- è·å–ä¸‹ä¸€ä¸ªå€¼çš„å­˜å‚¨è¿‡ç¨‹
DELIMITER $$
CREATE PROCEDURE get_next_sequence_value(
    IN seq_name VARCHAR(50),
    OUT next_value BIGINT
)
BEGIN
    UPDATE sequences 
    SET current_value = current_value + increment_by 
    WHERE name = seq_name;
    
    SELECT current_value INTO next_value 
    FROM sequences 
    WHERE name = seq_name;
END$$
DELIMITER ;
```

### 5.3 Redisè®¡æ•°å™¨æ–¹æ¡ˆ


ä½¿ç”¨Redisçš„åŸå­æ“ä½œç‰¹æ€§ç”ŸæˆIDï¼š

```java
/**
 * Redisè®¡æ•°å™¨IDç”Ÿæˆå™¨
 */
public class RedisCounterIdGenerator {
    
    private final RedisTemplate<String, String> redisTemplate;
    private final String keyPrefix;
    
    public RedisCounterIdGenerator(RedisTemplate<String, String> redisTemplate, 
                                  String keyPrefix) {
        this.redisTemplate = redisTemplate;
        this.keyPrefix = keyPrefix;
    }
    
    /**
     * ç”Ÿæˆç®€å•é€’å¢ID
     */
    public long nextId(String bizType) {
        String key = keyPrefix + ":" + bizType;
        return redisTemplate.opsForValue().increment(key);
    }
    
    /**
     * ç”Ÿæˆå¸¦æ—¶é—´å‰ç¼€çš„ID
     * æ ¼å¼ï¼šyyyyMMdd + 6ä½é€’å¢æ•°å­—
     * ç¤ºä¾‹ï¼š2023120100001, 2023120100002
     */
    public String nextIdWithDate(String bizType) {
        String date = LocalDate.now().format(DateTimeFormatter.ofPattern("yyyyMMdd"));
        String key = keyPrefix + ":" + bizType + ":" + date;
        
        Long counter = redisTemplate.opsForValue().increment(key);
        
        // è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆç¬¬äºŒå¤©è¿‡æœŸï¼‰
        if (counter == 1) {
            redisTemplate.expire(key, Duration.ofDays(1));
        }
        
        return date + String.format("%06d", counter);
    }
    
    /**
     * æ‰¹é‡è·å–IDï¼ˆç±»ä¼¼å·æ®µæ¨¡å¼ï¼‰
     */
    public List<Long> batchNextId(String bizType, int count) {
        String key = keyPrefix + ":" + bizType;
        
        // ä½¿ç”¨Luaè„šæœ¬ä¿è¯åŸå­æ€§
        String luaScript = 
            "local key = KEYS[1] " +
            "local count = tonumber(ARGV[1]) " +
            "local current = redis.call('GET', key) or 0 " +
            "redis.call('INCRBY', key, count) " +
            "return current";
        
        Long startId = redisTemplate.execute(
            new DefaultRedisScript<>(luaScript, Long.class),
            Collections.singletonList(key),
            String.valueOf(count)
        );
        
        List<Long> ids = new ArrayList<>(count);
        for (int i = 1; i <= count; i++) {
            ids.add(startId + i);
        }
        
        return ids;
    }
    
    /**
     * ç”Ÿæˆåˆ†å¸ƒå¼å”¯ä¸€ID
     * æ ¼å¼ï¼šæ—¶é—´æˆ³ + Rediså®ä¾‹æ ‡è¯† + è®¡æ•°å™¨
     */
    public long generateDistributedId(String bizType) {
        long timestamp = System.currentTimeMillis();
        String key = keyPrefix + ":" + bizType + ":" + timestamp;
        
        Long counter = redisTemplate.opsForValue().increment(key);
        
        // è®¾ç½®çŸ­æœŸè¿‡æœŸæ—¶é—´
        if (counter == 1) {
            redisTemplate.expire(key, Duration.ofMinutes(1));
        }
        
        // ç»„è£…IDï¼šæ—¶é—´æˆ³(41ä½) + Rediså®ä¾‹ID(10ä½) + è®¡æ•°å™¨(12ä½)
        int redisInstanceId = getRedisInstanceId(); // 0-1023
        
        return (timestamp << 22) | (redisInstanceId << 12) | (counter & 0xFFF);
    }
    
    private int getRedisInstanceId() {
        // æ ¹æ®Rediså®ä¾‹è·å–å”¯ä¸€æ ‡è¯†
        return Math.abs(redisTemplate.getConnectionFactory().hashCode()) % 1024;
    }
}
```

---

## 6. ğŸ¯ æ–¹æ¡ˆé€‰æ‹©ä¸æœ€ä½³å®è·µ


### 6.1 åˆ†å¸ƒå¼IDæ–¹æ¡ˆå¯¹æ¯”


| **æ–¹æ¡ˆ** | **æ€§èƒ½** | **å¯ç”¨æ€§** | **å­˜å‚¨ç©ºé—´** | **å®ç°å¤æ‚åº¦** | **é€‚ç”¨åœºæ™¯** |
|---------|---------|-----------|-------------|-------------|-------------|
| **é›ªèŠ±ç®—æ³•** | `æé«˜` | `é«˜` | `8å­—èŠ‚` | `ä¸­ç­‰` | `é«˜å¹¶å‘ç³»ç»Ÿï¼Œéœ€è¦è¶‹åŠ¿é€’å¢` |
| **UUID** | `é«˜` | `æé«˜` | `16å­—èŠ‚` | `ç®€å•` | `åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œæ— åºè¦æ±‚` |
| **å·æ®µæ¨¡å¼** | `é«˜` | `ä¸­` | `8å­—èŠ‚` | `ä¸­ç­‰` | `æ•°æ®åº“ä¸»é”®ï¼Œéœ€è¦è¿ç»­ID` |
| **Redisè®¡æ•°å™¨** | `ä¸­` | `ä¸­` | `8å­—èŠ‚` | `ç®€å•` | `ç¼“å­˜åœºæ™¯ï¼Œå…è®¸ä¸¢å¤±` |
| **æ•°æ®åº“åºåˆ—** | `ä½` | `ä½` | `8å­—èŠ‚` | `ç®€å•` | `å•æœºæˆ–å°è§„æ¨¡ç³»ç»Ÿ` |

### 6.2 IDç”Ÿæˆæ–¹æ¡ˆé€‰æ‹©æŒ‡å—


```java
/**
 * IDç”Ÿæˆæ–¹æ¡ˆé€‰æ‹©å™¨
 */
public class IdGeneratorSelector {
    
    /**
     * æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©åˆé€‚çš„IDç”Ÿæˆæ–¹æ¡ˆ
     */
    public static IdGenerator selectGenerator(BusinessRequirement requirement) {
        
        // é«˜å¹¶å‘ + éœ€è¦æ’åº â†’ é›ªèŠ±ç®—æ³•
        if (requirement.isHighConcurrency() && requirement.needsSorting()) {
            return new SnowflakeIdGenerator(
                requirement.getDatacenterId(), 
                requirement.getMachineId()
            );
        }
        
        // å®Œå…¨åˆ†å¸ƒå¼ + æ— åºè¦æ±‚ â†’ UUID
        if (requirement.isFullyDistributed() && !requirement.needsSorting()) {
            return new UUIDGenerator(requirement.getUuidVersion());
        }
        
        // éœ€è¦è¿ç»­ID + æ•°æ®åº“å‹å¥½ â†’ å·æ®µæ¨¡å¼
        if (requirement.needsContinuousId() && requirement.isDatabaseFriendly()) {
            return new SegmentIdGenerator(
                requirement.getBizType(), 
                requirement.getDataSource()
            );
        }
        
        // ç®€å•åœºæ™¯ + å…è®¸ä¸¢å¤± â†’ Redisè®¡æ•°å™¨
        if (requirement.isSimpleScenario() && requirement.allowsLoss()) {
            return new RedisCounterIdGenerator(
                requirement.getRedisTemplate(), 
                requirement.getKeyPrefix()
            );
        }
        
        // é»˜è®¤é€‰æ‹©é›ªèŠ±ç®—æ³•
        return new SnowflakeIdGenerator(0, 0);
    }
    
    static class BusinessRequirement {
        private boolean highConcurrency = false;     // é«˜å¹¶å‘
        private boolean needsSorting = false;        // éœ€è¦æ’åº
        private boolean fullyDistributed = false;    // å®Œå…¨åˆ†å¸ƒå¼
        private boolean needsContinuousId = false;   // éœ€è¦è¿ç»­ID
        private boolean databaseFriendly = false;    // æ•°æ®åº“å‹å¥½
        private boolean simpleScenario = false;      // ç®€å•åœºæ™¯
        private boolean allowsLoss = false;          // å…è®¸ä¸¢å¤±
        
        // æ„å»ºå™¨æ¨¡å¼
        public static BusinessRequirement builder() {
            return new BusinessRequirement();
        }
        
        public BusinessRequirement highConcurrency() {
            this.highConcurrency = true;
            return this;
        }
        
        public BusinessRequirement needsSorting() {
            this.needsSorting = true;
            return this;
        }
        
        // å…¶ä»–builderæ–¹æ³•...
    }
}
```

### 6.3 åˆ†å¸ƒå¼IDæ€§èƒ½åŸºå‡†æµ‹è¯•


```java
/**
 * IDç”Ÿæˆå™¨æ€§èƒ½æµ‹è¯•
 */
public class IdGeneratorBenchmark {
    
    private static final int THREAD_COUNT = 10;
    private static final int IDS_PER_THREAD = 100000;
    
    public static void main(String[] args) throws Exception {
        
        // æµ‹è¯•é›ªèŠ±ç®—æ³•
        benchmarkSnowflake();
        
        // æµ‹è¯•UUID
        benchmarkUUID();
        
        // æµ‹è¯•å·æ®µæ¨¡å¼
        benchmarkSegment();
    }
    
    private static void benchmarkSnowflake() throws Exception {
        SnowflakeIdGenerator generator = new SnowflakeIdGenerator(1, 1);
        
        long startTime = System.currentTimeMillis();
        CountDownLatch latch = new CountDownLatch(THREAD_COUNT);
        Set<Long> allIds = ConcurrentHashMap.newKeySet();
        
        for (int i = 0; i < THREAD_COUNT; i++) {
            new Thread(() -> {
                Set<Long> threadIds = new HashSet<>();
                for (int j = 0; j < IDS_PER_THREAD; j++) {
                    long id = generator.nextId();
                    threadIds.add(id);
                }
                allIds.addAll(threadIds);
                latch.countDown();
            }).start();
        }
        
        latch.await();
        long endTime = System.currentTimeMillis();
        
        System.out.println("é›ªèŠ±ç®—æ³•æ€§èƒ½æµ‹è¯•ç»“æœï¼š");
        System.out.println("æ€»è€—æ—¶: " + (endTime - startTime) + "ms");
        System.out.println("ç”ŸæˆIDæ•°é‡: " + allIds.size());
        System.out.println("QPS: " + (allIds.size() * 1000.0 / (endTime - startTime)));
        System.out.println("é‡å¤IDæ•°é‡: " + (THREAD_COUNT * IDS_PER_THREAD - allIds.size()));
        System.out.println();
    }
    
    private static void benchmarkUUID() throws Exception {
        long startTime = System.currentTimeMillis();
        CountDownLatch latch = new CountDownLatch(THREAD_COUNT);
        Set<String> allIds = ConcurrentHashMap.newKeySet();
        
        for (int i = 0; i < THREAD_COUNT; i++) {
            new Thread(() -> {
                Set<String> threadIds = new HashSet<>();
                for (int j = 0; j < IDS_PER_THREAD; j++) {
                    String id = UUID.randomUUID().toString();
                    threadIds.add(id);
                }
                allIds.addAll(threadIds);
                latch.countDown();
            }).start();
        }
        
        latch.await();
        long endTime = System.currentTimeMillis();
        
        System.out.println("UUIDæ€§èƒ½æµ‹è¯•ç»“æœï¼š");
        System.out.println("æ€»è€—æ—¶: " + (endTime - startTime) + "ms");
        System.out.println("ç”ŸæˆIDæ•°é‡: " + allIds.size());
        System.out.println("QPS: " + (allIds.size() * 1000.0 / (endTime - startTime)));
        System.out.println("é‡å¤IDæ•°é‡: " + (THREAD_COUNT * IDS_PER_THREAD - allIds.size()));
        System.out.println();
    }
}
```

### 6.4 å¤šæœºæˆ¿IDç”Ÿæˆæ–¹æ¡ˆ


åœ¨å¤šæœºæˆ¿éƒ¨ç½²æ—¶ï¼Œéœ€è¦ç‰¹åˆ«è€ƒè™‘è·¨æœºæˆ¿çš„IDç”Ÿæˆï¼š

```java
/**
 * å¤šæœºæˆ¿IDç”Ÿæˆå™¨
 */
public class MultiDataCenterIdGenerator {
    
    private final Map<String, SnowflakeIdGenerator> generators = new ConcurrentHashMap<>();
    private final LoadBalancer loadBalancer;
    
    public MultiDataCenterIdGenerator() {
        this.loadBalancer = new RoundRobinLoadBalancer();
        initGenerators();
    }
    
    private void initGenerators() {
        // ä¸ºæ¯ä¸ªæœºæˆ¿é…ç½®ä¸åŒçš„æ•°æ®ä¸­å¿ƒID
        generators.put("dc-beijing", new SnowflakeIdGenerator(0, getMachineId()));
        generators.put("dc-shanghai", new SnowflakeIdGenerator(1, getMachineId()));
        generators.put("dc-guangzhou", new SnowflakeIdGenerator(2, getMachineId()));
    }
    
    /**
     * ç”ŸæˆID - è‡ªåŠ¨é€‰æ‹©æœ€è¿‘çš„æ•°æ®ä¸­å¿ƒ
     */
    public long nextId() {
        String dataCenter = selectDataCenter();
        return generators.get(dataCenter).nextId();
    }
    
    /**
     * ç”ŸæˆID - æŒ‡å®šæ•°æ®ä¸­å¿ƒ
     */
    public long nextId(String dataCenter) {
        SnowflakeIdGenerator generator = generators.get(dataCenter);
        if (generator == null) {
            throw new IllegalArgumentException("æœªçŸ¥æ•°æ®ä¸­å¿ƒ: " + dataCenter);
        }
        return generator.nextId();
    }
    
    private String selectDataCenter() {
        // æ ¹æ®å½“å‰æœºæˆ¿ä½ç½®æˆ–è´Ÿè½½å‡è¡¡ç­–ç•¥é€‰æ‹©
        return loadBalancer.select(generators.keySet());
    }
    
    private long getMachineId() {
        // æ ¹æ®æœºå™¨IPæˆ–é…ç½®è·å–æœºå™¨ID
        return MachineIdAllocator.generateMachineIdByIp();
    }
    
    /**
     * ç®€å•çš„è½®è¯¢è´Ÿè½½å‡è¡¡å™¨
     */
    static class RoundRobinLoadBalancer implements LoadBalancer {
        private final AtomicInteger counter = new AtomicInteger(0);
        
        @Override
        public String select(Set<String> options) {
            List<String> optionList = new ArrayList<>(options);
            int index = counter.getAndIncrement() % optionList.size();
            return optionList.get(index);
        }
    }
    
    interface LoadBalancer {
        String select(Set<String> options);
    }
}
```

### 6.5 åˆ†å¸ƒå¼IDå¯è¯»æ€§ä¼˜åŒ–


```java
/**
 * å¯è¯»æ€§ä¼˜åŒ–çš„IDç”Ÿæˆå™¨
 */
public class ReadableIdGenerator {
    
    /**
     * ç”Ÿæˆå¸¦ä¸šåŠ¡å‰ç¼€çš„å¯è¯»ID
     * æ ¼å¼ï¼šä¸šåŠ¡å‰ç¼€ + æ—¶é—´ + åºåˆ—å·
     * ç¤ºä¾‹ï¼šUSER20231201001, ORDER20231201001
     */
    public String generateReadableId(String bizPrefix) {
        String date = LocalDateTime.now().format(DateTimeFormatter.ofPattern("yyyyMMdd"));
        String key = "readable_id:" + bizPrefix + ":" + date;
        
        Long sequence = redisTemplate.opsForValue().increment(key);
        if (sequence == 1) {
            redisTemplate.expire(key, Duration.ofDays(1));
        }
        
        return bizPrefix + date + String.format("%03d", sequence);
    }
    
    /**
     * ç”Ÿæˆå¯è§£æçš„ç»„åˆID
     * æ ¼å¼ï¼šæ—¶é—´æˆ³ + ä¸šåŠ¡ç±»å‹ + æœºå™¨æ ‡è¯† + åºåˆ—å·
     */
    public String generateCompositeId(String bizType, int machineId) {
        long timestamp = System.currentTimeMillis();
        long sequence = getSequence(timestamp);
        
        return String.format("%d%s%02d%04d", 
            timestamp,      // æ—¶é—´æˆ³
            bizType,        // ä¸šåŠ¡ç±»å‹ï¼ˆ2ä½ï¼‰
            machineId,      // æœºå™¨IDï¼ˆ2ä½ï¼‰
            sequence        // åºåˆ—å·ï¼ˆ4ä½ï¼‰
        );
    }
    
    /**
     * è§£æç»„åˆID
     */
    public CompositeIdInfo parseCompositeId(String compositeId) {
        if (compositeId.length() < 15) {
            throw new IllegalArgumentException("IDæ ¼å¼é”™è¯¯");
        }
        
        long timestamp = Long.parseLong(compositeId.substring(0, 13));
        String bizType = compositeId.substring(13, 15);
        int machineId = Integer.parseInt(compositeId.substring(15, 17));
        int sequence = Integer.parseInt(compositeId.substring(17));
        
        return new CompositeIdInfo(timestamp, bizType, machineId, sequence);
    }
    
    static class CompositeIdInfo {
        private final long timestamp;
        private final String bizType;
        private final int machineId;
        private final int sequence;
        
        public CompositeIdInfo(long timestamp, String bizType, int machineId, int sequence) {
            this.timestamp = timestamp;
            this.bizType = bizType;
            this.machineId = machineId;
            this.sequence = sequence;
        }
        
        public Date getGenerateTime() {
            return new Date(timestamp);
        }
        
        // getters...
    }
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ åˆ†å¸ƒå¼ä¸»é”®æœ¬è´¨ï¼šåœ¨å¤šæœºç¯å¢ƒä¸‹ä¿è¯IDå…¨å±€å”¯ä¸€çš„æŠ€æœ¯æ–¹æ¡ˆ
ğŸ”¸ é›ªèŠ±ç®—æ³•æ ¸å¿ƒï¼š64ä½æ•°å­—åˆ†æ®µè¡¨ç¤ºï¼Œæ—¶é—´æˆ³+æœºå™¨ID+åºåˆ—å·
ğŸ”¸ UUIDç‰¹ç‚¹ï¼š128ä½å…¨çƒå”¯ä¸€æ ‡è¯†ï¼Œæ— éœ€ä¸­å¤®åè°ƒä½†å®Œå…¨æ— åº
ğŸ”¸ å·æ®µæ¨¡å¼åŸç†ï¼šæ‰¹é‡ä»æ•°æ®åº“è·å–IDæ®µï¼Œå‡å°‘æ•°æ®åº“è®¿é—®å‹åŠ›
ğŸ”¸ æ–¹æ¡ˆé€‰æ‹©ä¾æ®ï¼šå¹¶å‘é‡ã€æ’åºéœ€æ±‚ã€å­˜å‚¨è¦æ±‚ã€å®ç°å¤æ‚åº¦
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ é›ªèŠ±ç®—æ³•çš„ç²¾å¦™è®¾è®¡**
```
æ—¶é—´æˆ³41ä½ï¼šå¯ç”¨69å¹´ï¼Œä¿è¯é•¿æœŸä¸é‡å¤
æœºå™¨ID10ä½ï¼šæ”¯æŒ1024å°æœºå™¨åŒæ—¶å·¥ä½œ  
åºåˆ—å·12ä½ï¼šæ¯æ¯«ç§’4096ä¸ªIDï¼Œæ»¡è¶³é«˜å¹¶å‘
æ•´ä½“64ä½ï¼šæ­£å¥½ä¸€ä¸ªlongå‹ï¼Œæ€§èƒ½æœ€ä¼˜
```

**ğŸ”¹ æ—¶é’Ÿå›æ‹¨çš„ä¸¥é‡æ€§**
```
é—®é¢˜æœ¬è´¨ï¼šæœåŠ¡å™¨æ—¶é—´å€’é€€å¯¼è‡´IDå¯èƒ½é‡å¤
å¤„ç†ç­–ç•¥ï¼šæŠ›å¼‚å¸¸ã€ç­‰å¾…è¿½èµ¶ã€ä½¿ç”¨ä¸Šæ¬¡æ—¶é—´æˆ³
æœ€ä½³å®è·µï¼šéƒ¨ç½²NTPæ—¶é’ŸåŒæ­¥ï¼Œç›‘æ§æ—¶é’Ÿåç§»
```

**ğŸ”¹ æœºå™¨IDåˆ†é…çš„é‡è¦æ€§**
```
åˆ†é…åŸåˆ™ï¼šç¡®ä¿æ¯å°æœºå™¨IDå”¯ä¸€ä¸”å›ºå®š
å¸¸ç”¨æ–¹æ³•ï¼šIPåœ°å€è®¡ç®—ã€MACåœ°å€ã€é…ç½®æ–‡ä»¶
æ³¨æ„äº‹é¡¹ï¼šé‡å¯åIDè¦ä¿æŒä¸å˜ï¼Œé¿å…å†²çª
```

### 7.3 æ–¹æ¡ˆé€‚ç”¨åœºæ™¯æ€»ç»“


**ğŸ¯ åœºæ™¯é©±åŠ¨çš„é€‰æ‹©ç­–ç•¥**

- **é«˜å¹¶å‘ç³»ç»Ÿï¼ˆQPS > 10ä¸‡ï¼‰**ï¼šé€‰æ‹©é›ªèŠ±ç®—æ³•
  - ç†ç”±ï¼šæ€§èƒ½æœ€é«˜ï¼Œæ”¯æŒè¶‹åŠ¿é€’å¢ï¼Œæ»¡è¶³æ•°æ®åº“ç´¢å¼•è¦æ±‚

- **åˆ†å¸ƒå¼ç³»ç»Ÿæ— åºè¦æ±‚**ï¼šé€‰æ‹©UUID v4
  - ç†ç”±ï¼šå®ç°ç®€å•ï¼Œæ— éœ€ä¸­å¤®åè°ƒï¼Œç»å¯¹ä¸é‡å¤

- **æ•°æ®åº“ä¸»é”®åœºæ™¯**ï¼šé€‰æ‹©å·æ®µæ¨¡å¼
  - ç†ç”±ï¼šè¿ç»­é€’å¢ï¼Œå¯¹æ•°æ®åº“å‹å¥½ï¼Œå®ç°ç›¸å¯¹ç®€å•

- **ç¼“å­˜åœºæ™¯å…è®¸ä¸¢å¤±**ï¼šé€‰æ‹©Redisè®¡æ•°å™¨
  - ç†ç”±ï¼šå®ç°ç®€å•ï¼Œæ€§èƒ½è¾ƒå¥½ï¼Œé‡å¯åå¯ä»¥é‡æ–°å¼€å§‹

- **å°è§„æ¨¡å•æœºç³»ç»Ÿ**ï¼šé€‰æ‹©æ•°æ®åº“è‡ªå¢åºåˆ—
  - ç†ç”±ï¼šç®€å•å¯é ï¼Œæ— éœ€é¢å¤–ä¸­é—´ä»¶

### 7.4 æ€§èƒ½ä¼˜åŒ–æœ€ä½³å®è·µ


**âš¡ é›ªèŠ±ç®—æ³•ä¼˜åŒ–**
```
å‡å°‘é”ç«äº‰ï¼šä½¿ç”¨ThreadLocalæˆ–CASæ“ä½œ
æ‰¹é‡ç”Ÿæˆï¼šä¸€æ¬¡ç”Ÿæˆå¤šä¸ªIDç¼“å­˜ä½¿ç”¨
æ—¶é’Ÿä¼˜åŒ–ï¼šå®šæœŸåŒæ­¥æ—¶é’Ÿï¼Œç›‘æ§æ—¶é’Ÿåç§»
åºåˆ—å·ä¼˜åŒ–ï¼šéšæœºèµ·å§‹å€¼é¿å…å†²çª
```

**ğŸš€ å·æ®µæ¨¡å¼ä¼˜åŒ–**
```
åŒç¼“å†²æŠ€æœ¯ï¼šæå‰åŠ è½½ä¸‹ä¸€ä¸ªå·æ®µé¿å…ç­‰å¾…
å¼‚æ­¥åŠ è½½ï¼šä½¿ç”¨å¼‚æ­¥ä»»åŠ¡åŠ è½½å·æ®µ
æ‰¹é‡è·å–ï¼šå¢å¤§æ­¥é•¿å‡å°‘æ•°æ®åº“è®¿é—®
è¿æ¥æ± ï¼šä½¿ç”¨æ•°æ®åº“è¿æ¥æ± é¿å…é¢‘ç¹å»ºè¿
```

**ğŸ’¾ UUIDä¼˜åŒ–**
```
é¿å…å­—ç¬¦ä¸²ï¼šä½¿ç”¨äºŒè¿›åˆ¶å­˜å‚¨èŠ‚çœç©ºé—´
ThreadLocalï¼šé¿å…SecureRandomçš„é”ç«äº‰
æ ¼å¼åŒ–ä¼˜åŒ–ï¼šç›´æ¥å­—èŠ‚æ“ä½œé¿å…å­—ç¬¦ä¸²æ‹¼æ¥
ç‰ˆæœ¬é€‰æ‹©ï¼šæ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚çš„UUIDç‰ˆæœ¬
```

### 7.5 å®é™…åº”ç”¨æ³¨æ„äº‹é¡¹


**âš ï¸ éƒ¨ç½²æ³¨æ„äº‹é¡¹**
```
æœºå™¨IDç®¡ç†ï¼šå»ºç«‹æœºå™¨IDåˆ†é…å’Œç®¡ç†æœºåˆ¶
æ—¶é’ŸåŒæ­¥ï¼šéƒ¨ç½²NTPæœåŠ¡ç¡®ä¿æ—¶é’ŸåŒæ­¥
ç›‘æ§å‘Šè­¦ï¼šç›‘æ§IDç”Ÿæˆæ€§èƒ½å’Œå¼‚å¸¸æƒ…å†µ
å®¹ç¾å¤‡ä»½ï¼šè®¾è®¡æ•…éšœè½¬ç§»å’Œæ¢å¤æœºåˆ¶
```

**ğŸ”§ å¼€å‘æœ€ä½³å®è·µ**
```
æ¥å£æŠ½è±¡ï¼šå®šä¹‰ç»Ÿä¸€çš„IDç”Ÿæˆå™¨æ¥å£
é…ç½®åŒ–ï¼šé€šè¿‡é…ç½®æ–‡ä»¶é€‰æ‹©IDç”Ÿæˆç­–ç•¥
æµ‹è¯•å……åˆ†ï¼šè¿›è¡Œå¹¶å‘æµ‹è¯•å’Œå”¯ä¸€æ€§éªŒè¯
æ–‡æ¡£å®Œå–„ï¼šè®°å½•IDæ ¼å¼å’Œè§£æè§„åˆ™
```

**ğŸ“Š è¿ç»´ç›‘æ§è¦ç‚¹**
```
æ€§èƒ½æŒ‡æ ‡ï¼šQPSã€å“åº”æ—¶é—´ã€é”™è¯¯ç‡
ä¸šåŠ¡æŒ‡æ ‡ï¼šIDé‡å¤ç‡ã€æ—¶é’Ÿåç§»ã€æœºå™¨çŠ¶æ€
å‘Šè­¦è®¾ç½®ï¼šIDç”Ÿæˆå¤±è´¥ã€æ—¶é’Ÿå›æ‹¨ã€æ€§èƒ½ä¸‹é™
å®šæœŸæ£€æŸ¥ï¼šéªŒè¯IDå”¯ä¸€æ€§ã€æ£€æŸ¥ç³»ç»Ÿèµ„æº
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
åˆ†å¸ƒå¼IDå…¨å±€å”¯ä¸€æ˜¯å…³é”®ï¼Œé«˜æ€§èƒ½å¯ç”¨æ˜¯åŸºç¡€
é›ªèŠ±ç®—æ³•åˆ†æ®µå·§å¦™æ—¶é—´æˆ³ï¼Œæœºå™¨åºåˆ—ä¿è¯ä¸é‡å¤
UUIDéšæœºç”Ÿæˆæ— éœ€åè°ƒï¼Œå®Œå…¨åˆ†å¸ƒä½†ç‰ºç‰²æœ‰åº
å·æ®µæ¨¡å¼æ‰¹é‡è·å–å‡å‹åŠ›ï¼ŒåŒç¼“å†²æŠ€æœ¯é¿å…ç­‰å¾…
æ–¹æ¡ˆé€‰æ‹©çœ‹åœºæ™¯å®šéœ€æ±‚ï¼Œæ€§èƒ½å¯ç”¨æˆæœ¬è¦å¹³è¡¡
```