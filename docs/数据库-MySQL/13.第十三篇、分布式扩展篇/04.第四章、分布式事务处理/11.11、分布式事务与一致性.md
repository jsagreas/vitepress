---
title: 11ã€åˆ†å¸ƒå¼äº‹åŠ¡ä¸ä¸€è‡´æ€§
---
## ğŸ“š ç›®å½•

1. [åˆ†å¸ƒå¼äº‹åŠ¡åŸºç¡€æ¦‚å¿µ](#1-åˆ†å¸ƒå¼äº‹åŠ¡åŸºç¡€æ¦‚å¿µ)
2. [ä¸¤é˜¶æ®µæäº¤åè®®ï¼ˆ2PCï¼‰](#2-ä¸¤é˜¶æ®µæäº¤åè®®2pc)
3. [XAäº‹åŠ¡ç®¡ç†](#3-xaäº‹åŠ¡ç®¡ç†)
4. [BASEç†è®ºä¸æŸ”æ€§äº‹åŠ¡](#4-baseç†è®ºä¸æŸ”æ€§äº‹åŠ¡)
5. [Sagaæ¨¡å¼ä¸äº‹åŠ¡è¡¥å¿](#5-sagaæ¨¡å¼ä¸äº‹åŠ¡è¡¥å¿)
6. [Seataæ¡†æ¶é›†æˆ](#6-seataæ¡†æ¶é›†æˆ)
7. [æœ¬åœ°äº‹åŠ¡è¡¨æ–¹æ¡ˆ](#7-æœ¬åœ°äº‹åŠ¡è¡¨æ–¹æ¡ˆ)
8. [äº‹åŠ¡æ€§èƒ½ä¼˜åŒ–ä¸æ•…éšœæ¢å¤](#8-äº‹åŠ¡æ€§èƒ½ä¼˜åŒ–ä¸æ•…éšœæ¢å¤)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ åˆ†å¸ƒå¼äº‹åŠ¡åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼äº‹åŠ¡


**ç®€å•ç†è§£**ï¼šåˆ†å¸ƒå¼äº‹åŠ¡å°±æ˜¯åœ¨å¤šä¸ªæ•°æ®åº“ä¹‹é—´ä¿è¯æ•°æ®ä¸€è‡´æ€§çš„æœºåˆ¶ã€‚

```
ä¼ ç»Ÿå•æœºäº‹åŠ¡ï¼š
ç”¨æˆ·è½¬è´¦ 100å…ƒ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸€ä¸ªæ•°æ®åº“  â”‚ â† åœ¨åŒä¸€ä¸ªæ•°æ®åº“å†…å®Œæˆ
â”‚ Aè´¦æˆ· -100  â”‚
â”‚ Bè´¦æˆ· +100  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åˆ†å¸ƒå¼äº‹åŠ¡ï¼š
ç”¨æˆ·è½¬è´¦ 100å…ƒ  
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ•°æ®åº“1   â”‚    â”‚ æ•°æ®åº“2   â”‚
â”‚ Aè´¦æˆ·-100 â”‚ â†’  â”‚ Bè´¦æˆ·+100 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   è¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥
```

### 1.2 åˆ†å¸ƒå¼äº‹åŠ¡çš„æŒ‘æˆ˜


**ğŸ”¸ ç½‘ç»œé—®é¢˜**
```
é—®é¢˜ï¼šç½‘ç»œå»¶è¿Ÿã€ç½‘ç»œåˆ†åŒºã€æ¶ˆæ¯ä¸¢å¤±
å½±å“ï¼šæ— æ³•åŠæ—¶ç¡®è®¤å…¶ä»–èŠ‚ç‚¹çš„äº‹åŠ¡çŠ¶æ€
è§£å†³ï¼šéœ€è¦è¶…æ—¶æœºåˆ¶å’Œé‡è¯•ç­–ç•¥
```

**ğŸ”¸ èŠ‚ç‚¹æ•…éšœ**  
```
é—®é¢˜ï¼šæŸä¸ªæ•°æ®åº“èŠ‚ç‚¹å®•æœº
å½±å“ï¼šäº‹åŠ¡æ— æ³•åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šå®Œæˆ
è§£å†³ï¼šéœ€è¦æ•…éšœæ£€æµ‹å’Œæ¢å¤æœºåˆ¶
```

**ğŸ”¸ æ€§èƒ½é—®é¢˜**
```
é—®é¢˜ï¼šåè°ƒå¤šä¸ªèŠ‚ç‚¹å¢åŠ äº†å“åº”æ—¶é—´
å½±å“ï¼šäº‹åŠ¡å¤„ç†å˜æ…¢ï¼Œå¹¶å‘èƒ½åŠ›ä¸‹é™
è§£å†³ï¼šéœ€è¦ä¼˜åŒ–åè®®å’Œå‡å°‘ç½‘ç»œé€šä¿¡
```

### 1.3 ACIDç‰¹æ€§åœ¨åˆ†å¸ƒå¼ç¯å¢ƒçš„æŒ‘æˆ˜


| **ACIDç‰¹æ€§** | **å•æœºç¯å¢ƒ** | **åˆ†å¸ƒå¼ç¯å¢ƒæŒ‘æˆ˜** |
|-------------|-------------|------------------|
| **åŸå­æ€§(A)** | `æ•°æ®åº“ä¿è¯` | `éœ€è¦è·¨èŠ‚ç‚¹åè°ƒ` |
| **ä¸€è‡´æ€§(C)** | `çº¦æŸæ£€æŸ¥` | `éœ€è¦å…¨å±€ä¸€è‡´æ€§` |
| **éš”ç¦»æ€§(I)** | `é”æœºåˆ¶` | `åˆ†å¸ƒå¼é”å¤æ‚` |
| **æŒä¹…æ€§(D)** | `æ—¥å¿—æœºåˆ¶` | `éœ€è¦å¤šèŠ‚ç‚¹æŒä¹…åŒ–` |

---

## 2. âš¡ ä¸¤é˜¶æ®µæäº¤åè®®ï¼ˆ2PCï¼‰


### 2.1 2PCåè®®åŸºæœ¬åŸç†


**æ ¸å¿ƒæ€æƒ³**ï¼šå°†äº‹åŠ¡åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œå…ˆè¯¢é—®æ‰€æœ‰èŠ‚ç‚¹æ˜¯å¦å¯ä»¥æäº¤ï¼Œå†ç»Ÿä¸€æäº¤æˆ–å›æ»šã€‚

```
2PCåè®®æµç¨‹ï¼š

åè°ƒè€…(Coordinator)          å‚ä¸è€…(Participant)
        â”‚                         â”‚
ç¬¬ä¸€é˜¶æ®µï¼šå‡†å¤‡é˜¶æ®µ
        â”‚â”€â”€[1]å‡†å¤‡æ¶ˆæ¯â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
        â”‚                         â”‚ å‡†å¤‡äº‹åŠ¡
        â”‚â†â”€[2]åŒæ„/æ‹’ç»â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
        â”‚                         â”‚
ç¬¬äºŒé˜¶æ®µï¼šæäº¤é˜¶æ®µ  
        â”‚â”€â”€[3]æäº¤/å›æ»šâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
        â”‚                         â”‚ æ‰§è¡Œæ“ä½œ
        â”‚â†â”€[4]å®Œæˆç¡®è®¤â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
```

### 2.2 2PCè¯¦ç»†æ­¥éª¤


**ğŸ”¸ ç¬¬ä¸€é˜¶æ®µï¼šå‡†å¤‡é˜¶æ®µï¼ˆPrepare Phaseï¼‰**

```java
// åè°ƒè€…ä»£ç ç¤ºä¾‹
public class TwoPhaseCommitCoordinator {
    
    public boolean executeTransaction(List<DataSource> participants) {
        // ç¬¬ä¸€é˜¶æ®µï¼šå‘æ‰€æœ‰å‚ä¸è€…å‘é€å‡†å¤‡æ¶ˆæ¯
        List<Boolean> prepareResults = new ArrayList<>();
        
        for (DataSource ds : participants) {
            try {
                Connection conn = ds.getConnection();
                // æ‰§è¡Œä¸šåŠ¡SQLä½†ä¸æäº¤
                conn.setAutoCommit(false);
                executeSql(conn);  // æ‰§è¡Œå…·ä½“ä¸šåŠ¡
                
                // è¯¢é—®æ˜¯å¦å¯ä»¥æäº¤
                boolean canCommit = conn.isValid(1000);
                prepareResults.add(canCommit);
                
            } catch (Exception e) {
                prepareResults.add(false);
            }
        }
        
        // æ£€æŸ¥æ‰€æœ‰å‚ä¸è€…æ˜¯å¦éƒ½åŒæ„
        return prepareResults.stream().allMatch(result -> result);
    }
}
```

**ğŸ”¸ ç¬¬äºŒé˜¶æ®µï¼šæäº¤é˜¶æ®µï¼ˆCommit Phaseï¼‰**

```java
// ç¬¬äºŒé˜¶æ®µï¼šæ ¹æ®ç¬¬ä¸€é˜¶æ®µç»“æœå†³å®šæäº¤æˆ–å›æ»š
public void commitOrRollback(List<DataSource> participants, boolean allPrepared) {
    for (DataSource ds : participants) {
        try {
            Connection conn = ds.getConnection();
            if (allPrepared) {
                conn.commit();     // æ‰€æœ‰äººéƒ½åŒæ„ï¼Œæäº¤äº‹åŠ¡
            } else {
                conn.rollback();   // æœ‰äººæ‹’ç»ï¼Œå›æ»šäº‹åŠ¡
            }
        } catch (Exception e) {
            // è®°å½•é”™è¯¯ï¼Œå¯èƒ½éœ€è¦äººå·¥å¹²é¢„
            log.error("æäº¤/å›æ»šå¤±è´¥ï¼š" + e.getMessage());
        }
    }
}
```

### 2.3 2PCçš„ä¼˜ç¼ºç‚¹


**âœ… ä¼˜ç‚¹**
```
å¼ºä¸€è‡´æ€§ï¼šä¿è¯æ‰€æœ‰èŠ‚ç‚¹æ•°æ®å®Œå…¨ä¸€è‡´
ç®€å•æ˜“æ‡‚ï¼šåè®®é€»è¾‘ç›¸å¯¹ç®€å•
å¹¿æ³›æ”¯æŒï¼šå¤§å¤šæ•°æ•°æ®åº“éƒ½æ”¯æŒXAåè®®
```

**âŒ ç¼ºç‚¹**
```
é˜»å¡é—®é¢˜ï¼šå‚ä¸è€…åœ¨å‡†å¤‡é˜¶æ®µä¼šé”å®šèµ„æº
å•ç‚¹æ•…éšœï¼šåè°ƒè€…æ•…éšœä¼šå¯¼è‡´æ•´ä¸ªäº‹åŠ¡é˜»å¡
æ€§èƒ½è¾ƒå·®ï¼šéœ€è¦å¤šæ¬¡ç½‘ç»œé€šä¿¡
```

---

## 3. ğŸ”§ XAäº‹åŠ¡ç®¡ç†


### 3.1 XAåè®®æ¦‚è¿°


**ä»€ä¹ˆæ˜¯XA**ï¼šXAæ˜¯X/Openç»„ç»‡å®šä¹‰çš„åˆ†å¸ƒå¼äº‹åŠ¡æ ‡å‡†ï¼Œæ˜¯2PCåè®®çš„å…·ä½“å®ç°ã€‚

```
XAäº‹åŠ¡ç»„ä»¶æ¶æ„ï¼š

åº”ç”¨ç¨‹åº(Application)
        â”‚
äº‹åŠ¡ç®¡ç†å™¨(TM)  â†â”€ åè°ƒå…¨å±€äº‹åŠ¡
        â”‚
èµ„æºç®¡ç†å™¨(RM)  â†â”€ ç®¡ç†å…·ä½“èµ„æºï¼ˆæ•°æ®åº“ï¼‰
```

### 3.2 ShardingSphereä¸­çš„XAæ”¯æŒ


**ğŸ”¸ XAäº‹åŠ¡é…ç½®**

```yaml
# application.yml
spring:
  shardingsphere:
    datasource:
      names: ds1,ds2
      ds1:
        type: com.zaxxer.hikari.HikariDataSource
        driver-class-name: com.mysql.cj.jdbc.Driver
        jdbc-url: jdbc:mysql://localhost:3306/db1
      ds2:
        type: com.zaxxer.hikari.HikariDataSource  
        driver-class-name: com.mysql.cj.jdbc.Driver
        jdbc-url: jdbc:mysql://localhost:3306/db2
    props:
      # å¼€å¯XAäº‹åŠ¡
      xa-transaction-manager-type: Atomikos
```

**ğŸ”¸ XAäº‹åŠ¡ä½¿ç”¨ç¤ºä¾‹**

```java
@Service
@Transactional  // ä½¿ç”¨Springäº‹åŠ¡æ³¨è§£
public class OrderService {
    
    @Autowired
    private OrderMapper orderMapper;
    
    @Autowired  
    private AccountMapper accountMapper;
    
    // è·¨åº“è½¬è´¦æ“ä½œ
    public void transfer(Long fromUserId, Long toUserId, BigDecimal amount) {
        // æ“ä½œ1ï¼šæ‰£å‡è½¬å‡ºç”¨æˆ·ä½™é¢ï¼ˆå¯èƒ½åœ¨db1ï¼‰
        accountMapper.deductBalance(fromUserId, amount);
        
        // æ“ä½œ2ï¼šå¢åŠ è½¬å…¥ç”¨æˆ·ä½™é¢ï¼ˆå¯èƒ½åœ¨db2ï¼‰  
        accountMapper.addBalance(toUserId, amount);
        
        // æ“ä½œ3ï¼šè®°å½•è½¬è´¦è®¢å•ï¼ˆå¯èƒ½åœ¨db1æˆ–db2ï¼‰
        Order order = new Order(fromUserId, toUserId, amount);
        orderMapper.insertOrder(order);
        
        // å¦‚æœä»»ä½•æ“ä½œå¤±è´¥ï¼ŒXAä¼šè‡ªåŠ¨å›æ»šæ‰€æœ‰æ“ä½œ
    }
}
```

### 3.3 XAäº‹åŠ¡ç®¡ç†å™¨é…ç½®


**ğŸ”¸ Atomikosé…ç½®ç¤ºä¾‹**

```java
@Configuration
public class XATransactionConfig {
    
    @Bean
    public UserTransactionService userTransactionService() {
        UserTransactionServiceImp service = new UserTransactionServiceImp();
        service.init();
        return service;
    }
    
    @Bean  
    public UserTransaction userTransaction() throws SystemException {
        UserTransactionImp transaction = new UserTransactionImp();
        transaction.setTransactionTimeout(300); // 5åˆ†é’Ÿè¶…æ—¶
        return transaction;
    }
    
    @Bean
    public TransactionManager transactionManager() {
        UserTransactionManager manager = new UserTransactionManager();
        manager.setForceShutdown(false);
        return manager;
    }
}
```

---

## 4. ğŸª BASEç†è®ºä¸æŸ”æ€§äº‹åŠ¡


### 4.1 BASEç†è®ºè§£é‡Š


**ACID vs BASEå¯¹æ¯”**

```
ACIDï¼ˆå¼ºä¸€è‡´æ€§ï¼‰ï¼š
- å¼ºä¸€è‡´æ€§è¦æ±‚é«˜
- å¯ç”¨æ€§å¯èƒ½å—å½±å“  
- é€‚åˆé‡‘èç­‰å¼ºä¸€è‡´æ€§åœºæ™¯

BASEï¼ˆæœ€ç»ˆä¸€è‡´æ€§ï¼‰ï¼š
- åŸºæœ¬å¯ç”¨(Basically Available)
- è½¯çŠ¶æ€(Soft State)  
- æœ€ç»ˆä¸€è‡´æ€§(Eventually Consistent)
- ç‰ºç‰²å¼ºä¸€è‡´æ€§æ¢å–é«˜å¯ç”¨æ€§
```

### 4.2 æœ€ç»ˆä¸€è‡´æ€§å®ç°


**ğŸ”¸ åŸºæœ¬æ€è·¯**ï¼šå…è®¸ç³»ç»Ÿåœ¨ä¸€æ®µæ—¶é—´å†…ä¸ä¸€è‡´ï¼Œä½†æœ€ç»ˆä¼šè¾¾åˆ°ä¸€è‡´çŠ¶æ€ã€‚

```java
// æœ€ç»ˆä¸€è‡´æ€§ç¤ºä¾‹ï¼šç”µå•†è®¢å•å¤„ç†
@Service
public class OrderProcessService {
    
    // æ­¥éª¤1ï¼šåˆ›å»ºè®¢å•ï¼ˆç«‹å³å®Œæˆï¼‰
    public void createOrder(Order order) {
        orderMapper.insert(order);
        // è®¢å•çŠ¶æ€ï¼šå¾…æ”¯ä»˜
        
        // å‘é€å¼‚æ­¥æ¶ˆæ¯å¤„ç†åç»­æ­¥éª¤
        messageQueue.send("order.created", order);
    }
    
    // æ­¥éª¤2ï¼šå¼‚æ­¥å¤„ç†åº“å­˜æ‰£å‡
    @EventListener("order.created")  
    public void handleInventoryDeduction(Order order) {
        try {
            inventoryService.deduct(order.getProductId(), order.getQuantity());
            // æ›´æ–°è®¢å•çŠ¶æ€ï¼šåº“å­˜å·²æ‰£å‡
            orderMapper.updateStatus(order.getId(), "INVENTORY_DEDUCTED");
            
        } catch (Exception e) {
            // åº“å­˜ä¸è¶³ï¼Œå–æ¶ˆè®¢å•
            orderMapper.updateStatus(order.getId(), "CANCELLED");
        }
    }
    
    // æ­¥éª¤3ï¼šå¼‚æ­¥å¤„ç†æ”¯ä»˜
    @EventListener("inventory.deducted")
    public void handlePayment(Order order) {
        // è°ƒç”¨æ”¯ä»˜ç³»ç»Ÿ
        paymentService.processPayment(order);
    }
}
```

### 4.3 æŸ”æ€§äº‹åŠ¡çš„ä¼˜åŠ¿


```
é«˜å¯ç”¨æ€§ï¼šå•ä¸ªæœåŠ¡æ•…éšœä¸å½±å“æ•´ä½“
é«˜æ€§èƒ½ï¼šé¿å…é•¿æ—¶é—´é”å®šèµ„æº
å¯æ‰©å±•ï¼šå®¹æ˜“æ°´å¹³æ‰©å±•
å®¹é”™æ€§ï¼šå…·å¤‡è‡ªåŠ¨é‡è¯•å’Œè¡¥å¿æœºåˆ¶
```

---

## 5. ğŸ”„ Sagaæ¨¡å¼ä¸äº‹åŠ¡è¡¥å¿


### 5.1 Sagaæ¨¡å¼åŸç†


**æ ¸å¿ƒæ€æƒ³**ï¼šå°†å¤§äº‹åŠ¡æ‹†åˆ†æˆå¤šä¸ªå°äº‹åŠ¡ï¼Œæ¯ä¸ªå°äº‹åŠ¡éƒ½æœ‰å¯¹åº”çš„è¡¥å¿æ“ä½œã€‚

```
Sagaäº‹åŠ¡æ‰§è¡Œæµç¨‹ï¼š

æ­£å¸¸æµç¨‹ï¼šT1 â†’ T2 â†’ T3 â†’ T4 (å…¨éƒ¨æˆåŠŸ)

å¼‚å¸¸æµç¨‹ï¼šT1 â†’ T2 â†’ T3 â†’ âŒ
è¡¥å¿æµç¨‹ï¼š     C3 â† C2 â† C1 (æ’¤é”€å·²å®Œæˆçš„æ“ä½œ)

å…¶ä¸­ï¼šT = Transaction(äº‹åŠ¡), C = Compensation(è¡¥å¿)
```

### 5.2 Sagaå®ç°ç¤ºä¾‹


**ğŸ”¸ è®¢å•å¤„ç†çš„Sagaå®ç°**

```java
@Component
public class OrderSaga {
    
    // æ­¥éª¤1ï¼šåˆ›å»ºè®¢å•
    @SagaOrchestrationStart
    public void processOrder(OrderRequest request) {
        // æ‰§è¡Œï¼šåˆ›å»ºè®¢å•
        Order order = createOrder(request);
        
        // ä¸‹ä¸€æ­¥ï¼šæ‰£å‡åº“å­˜
        sagaManager.nextStep("deductInventory", order);
    }
    
    @SagaOrchestrationTask
    public void deductInventory(Order order) {
        try {
            // æ‰§è¡Œï¼šæ‰£å‡åº“å­˜
            inventoryService.deduct(order.getProductId(), order.getQuantity());
            
            // ä¸‹ä¸€æ­¥ï¼šå¤„ç†æ”¯ä»˜
            sagaManager.nextStep("processPayment", order);
            
        } catch (Exception e) {
            // å¤±è´¥ï¼šè§¦å‘è¡¥å¿
            sagaManager.compensate("cancelOrder", order);
        }
    }
    
    @SagaOrchestrationTask  
    public void processPayment(Order order) {
        try {
            // æ‰§è¡Œï¼šå¤„ç†æ”¯ä»˜
            paymentService.charge(order.getUserId(), order.getAmount());
            
            // æˆåŠŸï¼šå®Œæˆæ•´ä¸ªSaga
            sagaManager.complete(order);
            
        } catch (Exception e) {
            // å¤±è´¥ï¼šè§¦å‘è¡¥å¿é“¾
            sagaManager.compensate("refundInventory", order);
        }
    }
    
    // è¡¥å¿æ“ä½œï¼šå–æ¶ˆè®¢å•
    @SagaOrchestrationCompensation
    public void cancelOrder(Order order) {
        orderService.cancel(order.getId());
    }
    
    // è¡¥å¿æ“ä½œï¼šæ¢å¤åº“å­˜
    @SagaOrchestrationCompensation
    public void refundInventory(Order order) {
        inventoryService.restore(order.getProductId(), order.getQuantity());
        orderService.cancel(order.getId());
    }
}
```

### 5.3 è¡¥å¿æœºåˆ¶è®¾è®¡è¦ç‚¹


**ğŸ”¸ å¹‚ç­‰æ€§ä¿è¯**
```java
// è¡¥å¿æ“ä½œå¿…é¡»æ˜¯å¹‚ç­‰çš„
public void cancelOrder(String orderId) {
    Order order = orderMapper.selectById(orderId);
    if (order != null && !"CANCELLED".equals(order.getStatus())) {
        orderMapper.updateStatus(orderId, "CANCELLED");
        // åªæœ‰éå–æ¶ˆçŠ¶æ€æ‰æ‰§è¡Œå–æ¶ˆæ“ä½œ
    }
}
```

**ğŸ”¸ å¯é‡è¯•è®¾è®¡**
```java
@Retryable(value = Exception.class, maxAttempts = 3)
public void compensateInventory(String productId, Integer quantity) {
    // è¡¥å¿æ“ä½œè¦æ”¯æŒé‡è¯•
    inventoryService.restore(productId, quantity);
}
```

---

## 6. ğŸš€ Seataæ¡†æ¶é›†æˆ


### 6.1 Seataæ¦‚è¿°


**ä»€ä¹ˆæ˜¯Seata**ï¼šSeataæ˜¯é˜¿é‡Œå¼€æºçš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œæä¾›ATã€TCCã€SAGAã€XAå››ç§äº‹åŠ¡æ¨¡å¼ã€‚

```
Seataæ¶æ„ç»„ä»¶ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    åº”ç”¨1     â”‚    â”‚    åº”ç”¨2     â”‚    â”‚    åº”ç”¨3     â”‚
â”‚   (RM)      â”‚    â”‚   (RM)      â”‚    â”‚   (RM)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                  â”‚                  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ Seata Server â”‚  â† äº‹åŠ¡åè°ƒå™¨
                  â”‚    (TC)     â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

TC: Transaction Coordinator äº‹åŠ¡åè°ƒå™¨
TM: Transaction Manager äº‹åŠ¡ç®¡ç†å™¨  
RM: Resource Manager èµ„æºç®¡ç†å™¨
```

### 6.2 ShardingSphereé›†æˆSeata


**ğŸ”¸ ä¾èµ–é…ç½®**

```xml
<!-- pom.xml -->
<dependencies>
    <dependency>
        <groupId>org.apache.shardingsphere</groupId>
        <artifactId>shardingsphere-jdbc-core-spring-boot-starter</artifactId>
        <version>5.3.0</version>
    </dependency>
    
    <dependency>
        <groupId>io.seata</groupId>
        <artifactId>seata-spring-boot-starter</artifactId>
        <version>1.6.1</version>
    </dependency>
</dependencies>
```

**ğŸ”¸ Seataé…ç½®**

```yaml
# application.yml
seata:
  application-id: order-service
  tx-service-group: order-service-group
  
  registry:
    type: nacos
    nacos:
      server-addr: localhost:8848
      
  config:
    type: nacos  
    nacos:
      server-addr: localhost:8848
      
spring:
  shardingsphere:
    props:
      # æŒ‡å®šä½¿ç”¨Seataä½œä¸ºåˆ†å¸ƒå¼äº‹åŠ¡ç®¡ç†å™¨
      transaction-type: SEATA
```

### 6.3 ATæ¨¡å¼ä½¿ç”¨ç¤ºä¾‹


**ğŸ”¸ ATæ¨¡å¼åŸç†**ï¼šè‡ªåŠ¨è®°å½•SQLçš„å‰åé•œåƒï¼Œå¤±è´¥æ—¶è‡ªåŠ¨ç”Ÿæˆåå‘SQLè¿›è¡Œè¡¥å¿ã€‚

```java
@Service
public class OrderService {
    
    @GlobalTransactional  // Seataå…¨å±€äº‹åŠ¡æ³¨è§£
    public void createOrder(OrderRequest request) {
        // 1. åˆ›å»ºè®¢å•ï¼ˆä¼šè‡ªåŠ¨è®°å½•before imageï¼‰
        Order order = new Order();
        order.setUserId(request.getUserId());
        order.setAmount(request.getAmount());
        orderMapper.insert(order);
        
        // 2. æ‰£å‡è´¦æˆ·ä½™é¢ï¼ˆä¼šè‡ªåŠ¨è®°å½•before imageï¼‰
        accountService.deduct(request.getUserId(), request.getAmount());
        
        // 3. æ‰£å‡åº“å­˜ï¼ˆä¼šè‡ªåŠ¨è®°å½•before imageï¼‰
        inventoryService.deduct(request.getProductId(), request.getQuantity());
        
        // å¦‚æœä»»ä½•æ­¥éª¤å¤±è´¥ï¼ŒSeataä¼šè‡ªåŠ¨å›æ»šæ‰€æœ‰æ“ä½œ
        // é€šè¿‡æ‰§è¡Œåå‘SQLæ¢å¤æ•°æ®åˆ°before imageçŠ¶æ€
    }
}
```

---

## 7. ğŸ“‹ æœ¬åœ°äº‹åŠ¡è¡¨æ–¹æ¡ˆ


### 7.1 æœ¬åœ°äº‹åŠ¡è¡¨åŸç†


**æ ¸å¿ƒæ€æƒ³**ï¼šåœ¨æ¯ä¸ªæœåŠ¡çš„æœ¬åœ°æ•°æ®åº“ä¸­åˆ›å»ºäº‹åŠ¡è¡¨ï¼Œè®°å½•éœ€è¦æ‰§è¡Œçš„æ“ä½œï¼Œé€šè¿‡å®šæ—¶ä»»åŠ¡ä¿è¯æœ€ç»ˆä¸€è‡´æ€§ã€‚

```
æœ¬åœ°äº‹åŠ¡è¡¨æ–¹æ¡ˆæ¶æ„ï¼š

æœåŠ¡A                          æœåŠ¡B
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸šåŠ¡è¡¨A    â”‚               â”‚  ä¸šåŠ¡è¡¨B    â”‚  
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æœ¬åœ°äº‹åŠ¡è¡¨A  â”‚  â†--æ¶ˆæ¯--â†’   â”‚ æœ¬åœ°äº‹åŠ¡è¡¨B  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                             â”‚
   å®šæ—¶ä»»åŠ¡æ‰«æ                   å®šæ—¶ä»»åŠ¡æ‰«æ
   é‡è¯•å¤±è´¥æ“ä½œ                   é‡è¯•å¤±è´¥æ“ä½œ
```

### 7.2 æœ¬åœ°äº‹åŠ¡è¡¨å®ç°


**ğŸ”¸ äº‹åŠ¡è¡¨ç»“æ„è®¾è®¡**

```sql
-- æœ¬åœ°äº‹åŠ¡è¡¨
CREATE TABLE local_transaction_log (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    transaction_id VARCHAR(64) NOT NULL,     -- å…¨å±€äº‹åŠ¡ID
    service_name VARCHAR(32) NOT NULL,       -- ç›®æ ‡æœåŠ¡å
    method_name VARCHAR(64) NOT NULL,        -- è°ƒç”¨æ–¹æ³•å
    request_data TEXT,                       -- è¯·æ±‚å‚æ•°
    status VARCHAR(16) DEFAULT 'PENDING',    -- PENDING/SUCCESS/FAILED
    retry_count INT DEFAULT 0,               -- é‡è¯•æ¬¡æ•°
    max_retry INT DEFAULT 3,                 -- æœ€å¤§é‡è¯•æ¬¡æ•°
    next_retry_time DATETIME,                -- ä¸‹æ¬¡é‡è¯•æ—¶é—´
    created_time DATETIME DEFAULT NOW(),
    updated_time DATETIME DEFAULT NOW(),
    
    INDEX idx_status_next_retry (status, next_retry_time)
);
```

**ğŸ”¸ æœ¬åœ°äº‹åŠ¡è¡¨ä½¿ç”¨**

```java
@Service
@Transactional
public class OrderService {
    
    public void createOrder(OrderRequest request) {
        // 1. åœ¨æœ¬åœ°äº‹åŠ¡ä¸­åŒæ—¶æ“ä½œä¸šåŠ¡è¡¨å’Œäº‹åŠ¡è¡¨
        try {
            // åˆ›å»ºè®¢å•
            Order order = new Order(request);
            orderMapper.insert(order);
            
            // è®°å½•éœ€è¦è°ƒç”¨å…¶ä»–æœåŠ¡çš„æ“ä½œåˆ°äº‹åŠ¡è¡¨
            LocalTransactionLog log = new LocalTransactionLog();
            log.setTransactionId(UUID.randomUUID().toString());
            log.setServiceName("inventory-service");
            log.setMethodName("deductInventory");
            log.setRequestData(JSON.toJSONString(request));
            log.setStatus("PENDING");
            
            transactionLogMapper.insert(log);
            
            // æœ¬åœ°äº‹åŠ¡æäº¤ï¼Œä¿è¯è®¢å•åˆ›å»ºå’Œäº‹åŠ¡è®°å½•çš„åŸå­æ€§
            
        } catch (Exception e) {
            // æœ¬åœ°äº‹åŠ¡å›æ»šï¼Œè®¢å•å’Œäº‹åŠ¡è®°å½•éƒ½ä¸ä¼šä¿å­˜
            throw e;
        }
    }
}
```

**ğŸ”¸ å¼‚æ­¥æ‰§è¡Œå’Œé‡è¯•æœºåˆ¶**

```java
@Component
public class TransactionLogProcessor {
    
    @Scheduled(fixedDelay = 5000)  // æ¯5ç§’æ‰§è¡Œä¸€æ¬¡
    public void processRetryableTransactions() {
        // æŸ¥è¯¢éœ€è¦é‡è¯•çš„äº‹åŠ¡
        List<LocalTransactionLog> retryLogs = transactionLogMapper
            .selectRetryableTransactions();
            
        for (LocalTransactionLog log : retryLogs) {
            try {
                // è°ƒç”¨è¿œç¨‹æœåŠ¡
                boolean success = callRemoteService(log);
                
                if (success) {
                    // æˆåŠŸï¼šæ›´æ–°çŠ¶æ€
                    log.setStatus("SUCCESS");
                    transactionLogMapper.updateById(log);
                } else {
                    // å¤±è´¥ï¼šå¢åŠ é‡è¯•æ¬¡æ•°
                    handleRetryFailure(log);
                }
                
            } catch (Exception e) {
                handleRetryFailure(log);
            }
        }
    }
    
    private void handleRetryFailure(LocalTransactionLog log) {
        log.setRetryCount(log.getRetryCount() + 1);
        
        if (log.getRetryCount() >= log.getMaxRetry()) {
            // è¶…è¿‡æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œæ ‡è®°ä¸ºå¤±è´¥ï¼Œéœ€è¦äººå·¥å¤„ç†
            log.setStatus("FAILED");
        } else {
            // è®¡ç®—ä¸‹æ¬¡é‡è¯•æ—¶é—´ï¼ˆæŒ‡æ•°é€€é¿ï¼‰
            long delayMinutes = Math.pow(2, log.getRetryCount());
            log.setNextRetryTime(new Date(System.currentTimeMillis() + delayMinutes * 60 * 1000));
        }
        
        transactionLogMapper.updateById(log);
    }
}
```

---

## 8. âš¡ äº‹åŠ¡æ€§èƒ½ä¼˜åŒ–ä¸æ•…éšœæ¢å¤


### 8.1 åˆ†å¸ƒå¼äº‹åŠ¡æ€§èƒ½ä¼˜åŒ–


**ğŸ”¸ å‡å°‘å‚ä¸è€…æ•°é‡**

```java
// ä¼˜åŒ–å‰ï¼šæ¯ä¸ªæ“ä½œéƒ½å¯åŠ¨åˆ†å¸ƒå¼äº‹åŠ¡
@GlobalTransactional
public void updateUserInfo(User user) {
    userMapper.updateBasicInfo(user);     // æ•°æ®åº“1
    userMapper.updateProfile(user);       // æ•°æ®åº“2  
    userMapper.updatePreferences(user);   // æ•°æ®åº“3
}

// ä¼˜åŒ–åï¼šåˆå¹¶åŒåº“æ“ä½œï¼Œå‡å°‘åˆ†å¸ƒå¼äº‹åŠ¡èŒƒå›´
@GlobalTransactional  
public void updateUserInfo(User user) {
    // å…ˆåœ¨å„è‡ªæ•°æ®åº“å†…å®Œæˆæœ¬åœ°äº‹åŠ¡
    updateBasicInfoLocally(user);         // æœ¬åœ°äº‹åŠ¡1
    updateProfileLocally(user);           // æœ¬åœ°äº‹åŠ¡2
    
    // åªå¯¹å…³é”®çš„è·¨åº“æ“ä½œä½¿ç”¨åˆ†å¸ƒå¼äº‹åŠ¡
    updateCriticalCrossDbInfo(user);      // åˆ†å¸ƒå¼äº‹åŠ¡
}
```

**ğŸ”¸ å¼‚æ­¥åŒ–éå…³é”®æ“ä½œ**

```java
@Service
public class OrderService {
    
    @GlobalTransactional
    public void createOrder(OrderRequest request) {
        // å…³é”®æ“ä½œï¼šå¿…é¡»åœ¨åˆ†å¸ƒå¼äº‹åŠ¡ä¸­
        createOrderRecord(request);        // åˆ›å»ºè®¢å•
        deductInventory(request);          // æ‰£å‡åº“å­˜
        deductUserBalance(request);        // æ‰£å‡ä½™é¢
        
        // éå…³é”®æ“ä½œï¼šå¼‚æ­¥æ‰§è¡Œï¼Œä¸å½±å“ä¸»æµç¨‹
        asyncExecutor.execute(() -> {
            sendNotification(request);     // å‘é€é€šçŸ¥
            updateUserStatistics(request); // æ›´æ–°ç»Ÿè®¡
            recordUserBehavior(request);   // è®°å½•è¡Œä¸º
        });
    }
}
```

### 8.2 äº‹åŠ¡éš”ç¦»çº§åˆ«ä¼˜åŒ–


**ğŸ”¸ åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„éš”ç¦»çº§åˆ«é€‰æ‹©**

| **åœºæ™¯** | **æ¨èéš”ç¦»çº§åˆ«** | **è¯´æ˜** |
|---------|-----------------|---------|
| **è¯»å¤šå†™å°‘** | `READ_COMMITTED` | `é¿å…é•¿æ—¶é—´é”å®šï¼Œæé«˜å¹¶å‘` |
| **å†™å…¥é¢‘ç¹** | `READ_COMMITTED` | `å‡å°‘é”å†²çªï¼Œé˜²æ­¢æ­»é”` |
| **å¼ºä¸€è‡´æ€§è¦æ±‚** | `REPEATABLE_READ` | `ä¿è¯æ•°æ®ä¸€è‡´æ€§` |
| **æŠ¥è¡¨æŸ¥è¯¢** | `READ_UNCOMMITTED` | `å…è®¸è„è¯»ï¼Œæé«˜æŸ¥è¯¢æ€§èƒ½` |

```java
// é’ˆå¯¹ä¸åŒåœºæ™¯è®¾ç½®åˆé€‚çš„éš”ç¦»çº§åˆ«
@Transactional(isolation = Isolation.READ_COMMITTED)
public void highConcurrencyOperation() {
    // é«˜å¹¶å‘åœºæ™¯ä½¿ç”¨è¾ƒä½éš”ç¦»çº§åˆ«
}

@Transactional(isolation = Isolation.REPEATABLE_READ)  
public void criticalBusinessOperation() {
    // å…³é”®ä¸šåŠ¡ä½¿ç”¨è¾ƒé«˜éš”ç¦»çº§åˆ«
}
```

### 8.3 æ•…éšœæ¢å¤æœºåˆ¶


**ğŸ”¸ äº‹åŠ¡æ—¥å¿—å’Œæ¢å¤**

```java
@Component
public class TransactionRecoveryService {
    
    @Scheduled(fixedDelay = 30000) // æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡
    public void recoverHangingTransactions() {
        // æŸ¥æ‰¾è¶…æ—¶çš„äº‹åŠ¡
        List<TransactionLog> timeoutTransactions = findTimeoutTransactions();
        
        for (TransactionLog txLog : timeoutTransactions) {
            try {
                // å°è¯•æ¢å¤äº‹åŠ¡
                recoverTransaction(txLog);
                
            } catch (Exception e) {
                // è®°å½•æ¢å¤å¤±è´¥ï¼Œå¯èƒ½éœ€è¦äººå·¥å¹²é¢„
                log.error("äº‹åŠ¡æ¢å¤å¤±è´¥: " + txLog.getTransactionId(), e);
                markTransactionForManualIntervention(txLog);
            }
        }
    }
    
    private void recoverTransaction(TransactionLog txLog) {
        switch (txLog.getStatus()) {
            case "PREPARING":
                // å‡†å¤‡é˜¶æ®µè¶…æ—¶ï¼Œæ‰§è¡Œå›æ»š
                rollbackTransaction(txLog);
                break;
                
            case "COMMITTING":  
                // æäº¤é˜¶æ®µè¶…æ—¶ï¼Œé‡è¯•æäº¤
                retryCommitTransaction(txLog);
                break;
                
            case "ROLLING_BACK":
                // å›æ»šé˜¶æ®µè¶…æ—¶ï¼Œé‡è¯•å›æ»š  
                retryRollbackTransaction(txLog);
                break;
        }
    }
}
```

**ğŸ”¸ å¥åº·æ£€æŸ¥å’Œç›‘æ§**

```java
@Component
public class TransactionHealthMonitor {
    
    // ç›‘æ§äº‹åŠ¡æˆåŠŸç‡
    @EventListener
    public void onTransactionComplete(TransactionEvent event) {
        if (event.isSuccess()) {
            successCounter.increment();
        } else {
            failureCounter.increment();
            
            // å¤±è´¥ç‡è¿‡é«˜æ—¶å‘Šè­¦
            if (getFailureRate() > 0.1) {  // å¤±è´¥ç‡è¶…è¿‡10%
                alertService.sendAlert("åˆ†å¸ƒå¼äº‹åŠ¡å¤±è´¥ç‡è¿‡é«˜");
            }
        }
    }
    
    // ç›‘æ§äº‹åŠ¡å“åº”æ—¶é—´
    @Around("@annotation(GlobalTransactional)")
    public Object monitorTransactionTime(ProceedingJoinPoint joinPoint) throws Throwable {
        long start = System.currentTimeMillis();
        try {
            Object result = joinPoint.proceed();
            long duration = System.currentTimeMillis() - start;
            
            // è®°å½•å“åº”æ—¶é—´
            responseTimeHistogram.observe(duration);
            
            // å“åº”æ—¶é—´è¿‡é•¿å‘Šè­¦
            if (duration > 10000) {  // è¶…è¿‡10ç§’
                log.warn("åˆ†å¸ƒå¼äº‹åŠ¡æ‰§è¡Œæ—¶é—´è¿‡é•¿: " + duration + "ms");
            }
            
            return result;
        } catch (Exception e) {
            long duration = System.currentTimeMillis() - start;
            log.error("åˆ†å¸ƒå¼äº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œè€—æ—¶: " + duration + "ms", e);
            throw e;
        }
    }
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ¯ åˆ†å¸ƒå¼äº‹åŠ¡æœ¬è´¨ï¼šä¿è¯å¤šä¸ªæ•°æ®åº“æ“ä½œçš„åŸå­æ€§
ğŸ”§ 2PCåè®®ï¼šä¸¤é˜¶æ®µæäº¤ï¼Œå¼ºä¸€è‡´æ€§ä½†æ€§èƒ½è¾ƒå·®
âš¡ XAäº‹åŠ¡ï¼šæ ‡å‡†çš„åˆ†å¸ƒå¼äº‹åŠ¡å®ç°ï¼Œé€‚åˆå¼ºä¸€è‡´æ€§åœºæ™¯
ğŸª BASEç†è®ºï¼šæœ€ç»ˆä¸€è‡´æ€§ï¼Œç‰ºç‰²å¼ºä¸€è‡´æ€§æ¢å–é«˜å¯ç”¨æ€§
ğŸ”„ Sagaæ¨¡å¼ï¼šé•¿äº‹åŠ¡è¡¥å¿ï¼Œé€‚åˆå¤æ‚ä¸šåŠ¡æµç¨‹
ğŸš€ Seataæ¡†æ¶ï¼šé˜¿é‡Œå¼€æºçš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ
ğŸ“‹ æœ¬åœ°äº‹åŠ¡è¡¨ï¼šé€šè¿‡æœ¬åœ°äº‹åŠ¡ä¿è¯æœ€ç»ˆä¸€è‡´æ€§
```

### 9.2 æŠ€æœ¯é€‰å‹æŒ‡å¯¼


**ğŸ”¸ å¼ºä¸€è‡´æ€§åœºæ™¯**
```
é‡‘èè½¬è´¦ã€è®¢å•æ”¯ä»˜ç­‰å…³é”®ä¸šåŠ¡
æ¨èï¼šXAäº‹åŠ¡ + 2PCåè®®
ç‰¹ç‚¹ï¼šæ•°æ®å¼ºä¸€è‡´ï¼Œä½†æ€§èƒ½è¾ƒå·®
```

**ğŸ”¸ é«˜æ€§èƒ½åœºæ™¯**  
```
ç”µå•†è®¢å•ã€å†…å®¹å‘å¸ƒç­‰ä¸šåŠ¡
æ¨èï¼šSagaæ¨¡å¼ + è¡¥å¿æœºåˆ¶
ç‰¹ç‚¹ï¼šé«˜æ€§èƒ½ï¼Œæœ€ç»ˆä¸€è‡´æ€§
```

**ğŸ”¸ ç®€å•åœºæ™¯**
```
æ—¥å¿—è®°å½•ã€ç»Ÿè®¡æ›´æ–°ç­‰éå…³é”®ä¸šåŠ¡
æ¨èï¼šæœ¬åœ°äº‹åŠ¡è¡¨ + å¼‚æ­¥é‡è¯•
ç‰¹ç‚¹ï¼šå®ç°ç®€å•ï¼Œå¯é æ€§é«˜
```

### 9.3 å®é™…åº”ç”¨å»ºè®®


**ğŸ”¹ äº‹åŠ¡è®¾è®¡åŸåˆ™**
```
å°½é‡é¿å…ï¼šå‡å°‘åˆ†å¸ƒå¼äº‹åŠ¡çš„ä½¿ç”¨
èƒ½åˆå¹¶çš„åˆå¹¶ï¼šåŒåº“æ“ä½œå°½é‡æ”¾åœ¨ä¸€ä¸ªæœ¬åœ°äº‹åŠ¡ä¸­
å¼‚æ­¥åŒ–éå…³é”®æ“ä½œï¼šæé«˜ç³»ç»Ÿå“åº”é€Ÿåº¦
è®¾è®¡è¡¥å¿æœºåˆ¶ï¼šä¸ºæ¯ä¸ªæ“ä½œè®¾è®¡å¯¹åº”çš„æ’¤é”€æ“ä½œ
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–è¦ç‚¹**
```
å‡å°‘å‚ä¸è€…ï¼šé™ä½åè°ƒå¤æ‚åº¦
ç¼©çŸ­äº‹åŠ¡æ—¶é—´ï¼šé¿å…é•¿æ—¶é—´é”å®šèµ„æº
åˆç†è®¾ç½®è¶…æ—¶ï¼šé˜²æ­¢æ— é™ç­‰å¾…
ç›‘æ§å’Œå‘Šè­¦ï¼šåŠæ—¶å‘ç°é—®é¢˜
```

**ğŸ”¹ æ•…éšœå¤„ç†ç­–ç•¥**
```
å¹‚ç­‰æ€§è®¾è®¡ï¼šæ‰€æœ‰æ“ä½œéƒ½è¦æ”¯æŒé‡è¯•
æ—¥å¿—è®°å½•ï¼šè¯¦ç»†è®°å½•äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹
æ¢å¤æœºåˆ¶ï¼šè‡ªåŠ¨æ¢å¤è¶…æ—¶æˆ–å¤±è´¥çš„äº‹åŠ¡
äººå·¥å¹²é¢„ï¼šä¸ºæ— æ³•è‡ªåŠ¨æ¢å¤çš„æƒ…å†µæä¾›äººå·¥å¤„ç†æµç¨‹
```

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- åˆ†å¸ƒå¼äº‹åŠ¡æ˜¯å¤šæ•°æ®åº“ä¸€è‡´æ€§ä¿è¯æœºåˆ¶
- 2PC/XAé€‚åˆå¼ºä¸€è‡´æ€§ï¼ŒSagaé€‚åˆé«˜æ€§èƒ½åœºæ™¯  
- BASEç†è®ºæŒ‡å¯¼æŸ”æ€§äº‹åŠ¡è®¾è®¡
- Seataæä¾›äº†å®Œæ•´çš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ
- æ€§èƒ½ä¼˜åŒ–å’Œæ•…éšœæ¢å¤åŒæ ·é‡è¦