---
title: 10ã€åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶åº”ç”¨
---
## ğŸ“š ç›®å½•

1. [åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶æ¦‚è¿°](#1-åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶æ¦‚è¿°)
2. [Seataæ¡†æ¶æ¶æ„è¯¦è§£](#2-Seataæ¡†æ¶æ¶æ„è¯¦è§£)
3. [äº‹åŠ¡æ¨¡å¼å¯¹æ¯”åˆ†æ](#3-äº‹åŠ¡æ¨¡å¼å¯¹æ¯”åˆ†æ)
4. [æ¡†æ¶é€‰å‹å†³ç­–](#4-æ¡†æ¶é€‰å‹å†³ç­–)
5. [Seataéƒ¨ç½²é…ç½®å®è·µ](#5-Seataéƒ¨ç½²é…ç½®å®è·µ)
6. [ä¸šåŠ¡é›†æˆæ–¹æ¡ˆ](#6-ä¸šåŠ¡é›†æˆæ–¹æ¡ˆ)
7. [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#7-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
8. [æ•…éšœå¤„ç†ä¸è¿ç»´](#8-æ•…éšœå¤„ç†ä¸è¿ç»´)
9. [ä¼ä¸šçº§éƒ¨ç½²æ¶æ„](#9-ä¼ä¸šçº§éƒ¨ç½²æ¶æ„)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶


**ğŸ”¸ æ ¸å¿ƒå®šä¹‰**
```
åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶ï¼šä¸“é—¨è§£å†³è·¨æœåŠ¡ã€è·¨æ•°æ®åº“äº‹åŠ¡ä¸€è‡´æ€§çš„ä¸­é—´ä»¶
æœ¬è´¨ï¼šæä¾›ç»Ÿä¸€çš„äº‹åŠ¡ç®¡ç†èƒ½åŠ›ï¼Œç¡®ä¿åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„æ•°æ®ä¸€è‡´æ€§
ç›®æ ‡ï¼šè®©å¼€å‘è€…åƒä½¿ç”¨æœ¬åœ°äº‹åŠ¡ä¸€æ ·ç®€å•åœ°å¤„ç†åˆ†å¸ƒå¼äº‹åŠ¡
```

**ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦æ¡†æ¶**
```
ä¼ ç»Ÿæ–¹æ¡ˆç—›ç‚¹ï¼š
âŒ æ‰‹å·¥ç¼–ç å¤æ‚ï¼šè‡ªå·±å®ç°2PCã€è¡¥å¿ç­‰é€»è¾‘
âŒ å¯é æ€§éš¾ä¿è¯ï¼šå®¹æ˜“å‡ºç°æ•°æ®ä¸ä¸€è‡´
âŒ ç»´æŠ¤æˆæœ¬é«˜ï¼šåˆ†æ•£åœ¨å„ä¸ªä¸šåŠ¡æ¨¡å—ä¸­

æ¡†æ¶è§£å†³æ–¹æ¡ˆï¼š
âœ… ç»Ÿä¸€äº‹åŠ¡ç®¡ç†ï¼šé›†ä¸­å¤„ç†äº‹åŠ¡åè°ƒ
âœ… å¤šç§æ¨¡å¼æ”¯æŒï¼šATã€TCCã€Sagaç­‰
âœ… å¼€ç®±å³ç”¨ï¼šç®€å•é…ç½®å³å¯ä½¿ç”¨
âœ… ç”Ÿäº§çº§å¯é æ€§ï¼šä¹…ç»è€ƒéªŒçš„ç¨³å®šæ€§
```

### 1.2 ä¸»æµæ¡†æ¶å¯¹æ¯”


| æ¡†æ¶åç§° | **å¼€å‘æ–¹** | **æ ¸å¿ƒç‰¹ç‚¹** | **é€‚ç”¨åœºæ™¯** | **ç”Ÿæ€æˆç†Ÿåº¦** |
|---------|-----------|------------|-------------|--------------|
| ğŸ”¥ **Seata** | `é˜¿é‡Œå·´å·´` | `ATæ¨¡å¼é›¶ä¾µå…¥ï¼Œå¤šæ¨¡å¼æ”¯æŒ` | `å¾®æœåŠ¡ã€ç”µå•†` | `â˜…â˜…â˜…â˜…â˜…` |
| ğŸŒŸ **LCN** | `æ°‘é—´å¼€æº` | `è½»é‡çº§ï¼Œæ˜“é›†æˆ` | `ä¸­å°å‹é¡¹ç›®` | `â˜…â˜…â˜…â˜†â˜†` |
| ğŸ¢ **TCC-Transaction** | `ä¸ªäººå¼€æº` | `ä¸“æ³¨TCCæ¨¡å¼` | `é‡‘èã€æ”¯ä»˜` | `â˜…â˜…â˜…â˜†â˜†` |
| â˜ï¸ **DTM** | `Goè¯­è¨€` | `è·¨è¯­è¨€æ”¯æŒ` | `å¤šè¯­è¨€ç¯å¢ƒ` | `â˜…â˜…â˜…â˜†â˜†` |

> ğŸ’¡ **é€‰æ‹©å»ºè®®**ï¼šSeataæ˜¯ç›®å‰æœ€æˆç†Ÿã€åŠŸèƒ½æœ€å®Œå–„çš„åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶ï¼Œé˜¿é‡Œç³»æŠ€æœ¯æ ˆçš„é¦–é€‰

---

## 2. ğŸ—ï¸ Seataæ¡†æ¶æ¶æ„è¯¦è§£


### 2.1 Seataæ•´ä½“æ¶æ„


**ğŸ”§ ä¸‰å¤§æ ¸å¿ƒç»„ä»¶**
```
Seataæ¶æ„å›¾ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ä¸šåŠ¡åº”ç”¨A      â”‚    â”‚   ä¸šåŠ¡åº”ç”¨B      â”‚    â”‚   ä¸šåŠ¡åº”ç”¨C      â”‚
â”‚  (TM + RM)     â”‚    â”‚  (TM + RM)     â”‚    â”‚  (TM + RM)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚                       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Transaction     â”‚
                    â”‚  Coordinator     â”‚
                    â”‚     (TC)        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   æ³¨å†Œä¸­å¿ƒ       â”‚
                    â”‚ (Nacos/Eureka)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ“‹ ç»„ä»¶è¯¦è§£**

**TM (Transaction Manager) - äº‹åŠ¡ç®¡ç†å™¨**
```
ä½œç”¨ï¼šäº‹åŠ¡çš„å‘èµ·è€…å’Œåè°ƒè€…
èŒè´£ï¼š
â€¢ å¼€å¯å…¨å±€äº‹åŠ¡ï¼šç”Ÿæˆå…¨å±€äº‹åŠ¡ID (XID)
â€¢ æäº¤å…¨å±€äº‹åŠ¡ï¼šåè°ƒæ‰€æœ‰åˆ†æ”¯äº‹åŠ¡æäº¤
â€¢ å›æ»šå…¨å±€äº‹åŠ¡ï¼šåè°ƒæ‰€æœ‰åˆ†æ”¯äº‹åŠ¡å›æ»š
â€¢ äº‹åŠ¡çŠ¶æ€æŸ¥è¯¢ï¼šç›‘æ§äº‹åŠ¡æ‰§è¡ŒçŠ¶æ€

ä»£ç ä½ç½®ï¼šé€šå¸¸åœ¨ä¸šåŠ¡å…¥å£æœåŠ¡ä¸­
```

**RM (Resource Manager) - èµ„æºç®¡ç†å™¨**
```
ä½œç”¨ï¼šæœ¬åœ°èµ„æºçš„ä»£ç†
èŒè´£ï¼š
â€¢ æ³¨å†Œåˆ†æ”¯äº‹åŠ¡ï¼šå‘TCæ³¨å†Œæœ¬åœ°äº‹åŠ¡åˆ†æ”¯
â€¢ æ±‡æŠ¥åˆ†æ”¯çŠ¶æ€ï¼šæŠ¥å‘Šæœ¬åœ°äº‹åŠ¡æ‰§è¡Œç»“æœ
â€¢ æ¥æ”¶åˆ†æ”¯æŒ‡ä»¤ï¼šæ‰§è¡ŒTCä¸‹å‘çš„æäº¤/å›æ»šæŒ‡ä»¤
â€¢ æœ¬åœ°äº‹åŠ¡ç®¡ç†ï¼šç®¡ç†æ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰èµ„æº

ä»£ç ä½ç½®ï¼šæ¯ä¸ªå‚ä¸åˆ†å¸ƒå¼äº‹åŠ¡çš„æœåŠ¡ä¸­
```

**TC (Transaction Coordinator) - äº‹åŠ¡åè°ƒå™¨**
```
ä½œç”¨ï¼šå…¨å±€äº‹åŠ¡çš„åè°ƒä¸­å¿ƒ
èŒè´£ï¼š
â€¢ ç»´æŠ¤å…¨å±€äº‹åŠ¡ï¼šç®¡ç†XIDå’Œåˆ†æ”¯äº‹åŠ¡æ˜ å°„
â€¢ åè°ƒåˆ†æ”¯äº‹åŠ¡ï¼šä¸‹å‘æäº¤/å›æ»šæŒ‡ä»¤
â€¢ äº‹åŠ¡çŠ¶æ€æŒä¹…åŒ–ï¼šä¿è¯äº‹åŠ¡çŠ¶æ€å¯æ¢å¤
â€¢ è¶…æ—¶å¤„ç†ï¼šå¤„ç†é•¿æ—¶é—´æœªå“åº”çš„äº‹åŠ¡

éƒ¨ç½²æ–¹å¼ï¼šç‹¬ç«‹æœåŠ¡ï¼Œé›†ç¾¤éƒ¨ç½²
```

### 2.2 Seataå·¥ä½œæµç¨‹


**âš¡ äº‹åŠ¡æ‰§è¡Œæµç¨‹**
```
1. å¼€å¯å…¨å±€äº‹åŠ¡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    [1] å¼€å§‹äº‹åŠ¡     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è®¢å•æœåŠ¡ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’   â”‚   TC    â”‚
â”‚  (TM)   â”‚                   â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ [2] è°ƒç”¨åº“å­˜æœåŠ¡
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    [3] æ³¨å†Œåˆ†æ”¯     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åº“å­˜æœåŠ¡ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’   â”‚   TC    â”‚
â”‚  (RM)   â”‚                   â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ [4] è°ƒç”¨æ”¯ä»˜æœåŠ¡
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    [5] æ³¨å†Œåˆ†æ”¯     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ”¯ä»˜æœåŠ¡ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’   â”‚   TC    â”‚
â”‚  (RM)   â”‚                   â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. æäº¤/å›æ»šé˜¶æ®µ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    [6] å†³å®šæäº¤     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è®¢å•æœåŠ¡ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’   â”‚   TC    â”‚
â”‚  (TM)   â”‚                   â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
              [7] é€šçŸ¥æ‰€æœ‰RMæäº¤    â”‚
                                   â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ åº“å­˜æœåŠ¡ â”‚    â”‚ æ”¯ä»˜æœåŠ¡ â”‚
              â”‚  (RM)   â”‚    â”‚  (RM)   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. ğŸ”„ äº‹åŠ¡æ¨¡å¼å¯¹æ¯”åˆ†æ


### 3.1 ATæ¨¡å¼è¯¦è§£


**ğŸ¯ ATæ¨¡å¼ç‰¹ç‚¹**
```
AT (Automatic Transaction) - è‡ªåŠ¨äº‹åŠ¡æ¨¡å¼
æ ¸å¿ƒç†å¿µï¼šåŸºäºæœ¬åœ°äº‹åŠ¡çš„è‡ªåŠ¨æäº¤å›æ»š
ä¼˜åŠ¿ï¼šä¸šåŠ¡ä»£ç é›¶ä¾µå…¥ï¼Œä½¿ç”¨ç®€å•
åŸç†ï¼šé€šè¿‡æ•°æ®å¿«ç…§å®ç°è‡ªåŠ¨è¡¥å¿
```

**âš™ï¸ ATæ¨¡å¼å·¥ä½œæœºåˆ¶**
```
1. ä¸€é˜¶æ®µï¼šä¸šåŠ¡SQLæ‰§è¡Œ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¸šåŠ¡æ‰§è¡Œå‰ï¼š                          â”‚
â”‚ SELECT * FROM account WHERE id = 1   â”‚
â”‚ ç»“æœï¼š{id:1, balance:1000}           â”‚
â”‚                                      â”‚
â”‚ ä¸šåŠ¡SQLï¼š                            â”‚
â”‚ UPDATE account SET balance = 800      â”‚
â”‚ WHERE id = 1                         â”‚
â”‚                                      â”‚
â”‚ ä¸šåŠ¡æ‰§è¡Œåï¼š                          â”‚
â”‚ SELECT * FROM account WHERE id = 1   â”‚
â”‚ ç»“æœï¼š{id:1, balance:800}            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Seataè‡ªåŠ¨ç”Ÿæˆï¼š
â€¢ Before Image: {id:1, balance:1000}
â€¢ After Image:  {id:1, balance:800}
â€¢ æœ¬åœ°äº‹åŠ¡æäº¤

2. äºŒé˜¶æ®µï¼š
æäº¤ï¼šåˆ é™¤å¿«ç…§æ•°æ®
å›æ»šï¼šæ ¹æ®Before Imageæ¢å¤æ•°æ®
```

**ğŸ“ ATæ¨¡å¼ä»£ç ç¤ºä¾‹**
```java
// è®¢å•æœåŠ¡ - åªéœ€è¦æ·»åŠ æ³¨è§£ï¼Œæ— å…¶ä»–ä»£ç æ”¹åŠ¨
@GlobalTransactional
public void createOrder(OrderRequest request) {
    // 1. åˆ›å»ºè®¢å•
    orderMapper.insert(order);
    
    // 2. è°ƒç”¨åº“å­˜æœåŠ¡
    inventoryService.decreaseStock(request.getProductId(), request.getQuantity());
    
    // 3. è°ƒç”¨æ”¯ä»˜æœåŠ¡
    paymentService.deductBalance(request.getUserId(), request.getAmount());
    
    // å¦‚æœä»»ä½•æ­¥éª¤å¤±è´¥ï¼ŒSeataè‡ªåŠ¨å›æ»šæ‰€æœ‰æ“ä½œ
}
```

### 3.2 TCCæ¨¡å¼è¯¦è§£


**ğŸ¯ TCCæ¨¡å¼ç‰¹ç‚¹**
```
TCC (Try-Confirm-Cancel) - è¡¥å¿äº‹åŠ¡æ¨¡å¼
æ ¸å¿ƒç†å¿µï¼šä¸šåŠ¡å±‚é¢çš„ä¸¤é˜¶æ®µæäº¤
ä¼˜åŠ¿ï¼šæ•°æ®ä¸€è‡´æ€§å¼ºï¼Œæ€§èƒ½å¥½
ç¼ºç‚¹ï¼šä¸šåŠ¡ä»£ç ä¾µå…¥æ€§å¼ºï¼Œéœ€è¦å®ç°ä¸‰ä¸ªæ–¹æ³•
```

**âš™ï¸ TCCæ¨¡å¼å·¥ä½œæœºåˆ¶**
```
TCCä¸‰ä¸ªé˜¶æ®µï¼š

Tryé˜¶æ®µï¼š
â€¢ æ£€æŸ¥ä¸šåŠ¡çº¦æŸ
â€¢ é¢„ç•™ä¸šåŠ¡èµ„æº
â€¢ è®°å½•äº‹åŠ¡æ—¥å¿—

Confirmé˜¶æ®µï¼š
â€¢ ç¡®è®¤æ‰§è¡Œä¸šåŠ¡
â€¢ æäº¤é¢„ç•™èµ„æº
â€¢ æ¸…ç†äº‹åŠ¡æ—¥å¿—

Cancelé˜¶æ®µï¼š
â€¢ é‡Šæ”¾é¢„ç•™èµ„æº
â€¢ å›æ»šä¸šåŠ¡æ“ä½œ
â€¢ æ¸…ç†äº‹åŠ¡æ—¥å¿—
```

**ğŸ“ TCCæ¨¡å¼ä»£ç ç¤ºä¾‹**
```java
// è´¦æˆ·æœåŠ¡çš„TCCå®ç°
@Component
public class AccountTccService {
    
    // Tryï¼šå†»ç»“é‡‘é¢
    @TccResource
    public boolean freezeAmount(String userId, BigDecimal amount) {
        // æ£€æŸ¥ä½™é¢æ˜¯å¦å……è¶³
        Account account = accountMapper.selectById(userId);
        if (account.getBalance().compareTo(amount) < 0) {
            return false;
        }
        
        // å†»ç»“é‡‘é¢ï¼šä½™é¢å‡å°‘ï¼Œå†»ç»“é‡‘é¢å¢åŠ 
        accountMapper.updateBalance(userId, account.getBalance().subtract(amount));
        accountMapper.updateFrozenAmount(userId, 
            account.getFrozenAmount().add(amount));
        return true;
    }
    
    // Confirmï¼šç¡®è®¤æ‰£æ¬¾
    public boolean confirmDeduct(String userId, BigDecimal amount) {
        // å‡å°‘å†»ç»“é‡‘é¢ï¼ˆå®é™…æ‰£æ¬¾ï¼‰
        accountMapper.updateFrozenAmount(userId, 
            accountMapper.getFrozenAmount(userId).subtract(amount));
        return true;
    }
    
    // Cancelï¼šè§£å†»é‡‘é¢
    public boolean cancelDeduct(String userId, BigDecimal amount) {
        // æ¢å¤ä½™é¢ï¼Œå‡å°‘å†»ç»“é‡‘é¢
        Account account = accountMapper.selectById(userId);
        accountMapper.updateBalance(userId, account.getBalance().add(amount));
        accountMapper.updateFrozenAmount(userId, 
            account.getFrozenAmount().subtract(amount));
        return true;
    }
}
```

### 3.3 Sagaæ¨¡å¼è¯¦è§£


**ğŸ¯ Sagaæ¨¡å¼ç‰¹ç‚¹**
```
Sagaæ¨¡å¼ï¼šé•¿äº‹åŠ¡è§£å†³æ–¹æ¡ˆ
æ ¸å¿ƒç†å¿µï¼šå°†é•¿äº‹åŠ¡åˆ†è§£ä¸ºå¤šä¸ªçŸ­äº‹åŠ¡
ä¼˜åŠ¿ï¼šé€‚åˆé•¿æµç¨‹ä¸šåŠ¡ï¼Œæ€§èƒ½å¥½
é€‚ç”¨ï¼šä¸šåŠ¡æµç¨‹é•¿ã€æ­¥éª¤å¤šçš„åœºæ™¯
```

**âš™ï¸ Sagaæ¨¡å¼å·¥ä½œæœºåˆ¶**
```
æ­£å‘æ‰§è¡Œï¼šT1 â†’ T2 â†’ T3 â†’ T4
è¡¥å¿æ‰§è¡Œï¼šC4 â† C3 â† C2 â† C1

ç¤ºä¾‹ï¼šè®¢å•å¤„ç†æµç¨‹
1. åˆ›å»ºè®¢å•      â†’ è¡¥å¿ï¼šå–æ¶ˆè®¢å•
2. æ‰£å‡åº“å­˜      â†’ è¡¥å¿ï¼šæ¢å¤åº“å­˜
3. æ‰£æ¬¾æ”¯ä»˜      â†’ è¡¥å¿ï¼šé€€æ¬¾
4. å‘é€é€šçŸ¥      â†’ è¡¥å¿ï¼šå‘é€å–æ¶ˆé€šçŸ¥
```

### 3.4 ä¸‰ç§æ¨¡å¼å¯¹æ¯”


| å¯¹æ¯”ç»´åº¦ | **ATæ¨¡å¼** | **TCCæ¨¡å¼** | **Sagaæ¨¡å¼** |
|---------|-----------|------------|-------------|
| ğŸ”§ **ä¸šåŠ¡ä¾µå…¥æ€§** | `æä½(æ³¨è§£)` | `é«˜(ä¸‰ä¸ªæ–¹æ³•)` | `ä¸­(è¡¥å¿é€»è¾‘)` |
| âš¡ **æ€§èƒ½è¡¨ç°** | `ä¸­ç­‰` | `é«˜` | `é«˜` |
| ğŸ›¡ï¸ **ä¸€è‡´æ€§ä¿è¯** | `æœ€ç»ˆä¸€è‡´` | `å¼ºä¸€è‡´` | `æœ€ç»ˆä¸€è‡´` |
| ğŸ¯ **é€‚ç”¨åœºæ™¯** | `é€šç”¨åœºæ™¯` | `é‡‘èæ”¯ä»˜` | `é•¿æµç¨‹ä¸šåŠ¡` |
| ğŸ“Š **å¼€å‘å¤æ‚åº¦** | `ç®€å•` | `å¤æ‚` | `ä¸­ç­‰` |
| ğŸ” **æ•°æ®éš”ç¦»** | `è¯»æœªæäº¤` | `è¯»å·²æäº¤` | `è¯»å·²æäº¤` |

> ğŸ¯ **é€‰æ‹©å»ºè®®**ï¼š
> - **æ–°æ‰‹å…¥é—¨**ï¼šé€‰æ‹©ATæ¨¡å¼ï¼Œç®€å•æ˜“ç”¨
> - **é‡‘èåœºæ™¯**ï¼šé€‰æ‹©TCCæ¨¡å¼ï¼Œå¼ºä¸€è‡´æ€§
> - **é•¿æµç¨‹ä¸šåŠ¡**ï¼šé€‰æ‹©Sagaæ¨¡å¼ï¼Œæ€§èƒ½å¥½

---

## 4. ğŸ“Š æ¡†æ¶é€‰å‹å†³ç­–


### 4.1 é€‰å‹å†³ç­–æ¨¡å‹


**ğŸ¯ é€‰å‹ç»´åº¦åˆ†æ**
```
æŠ€æœ¯ç»´åº¦ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    æˆç†Ÿåº¦       â”‚ â† ç¤¾åŒºæ´»è·ƒåº¦ã€ç‰ˆæœ¬ç¨³å®šæ€§
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    æ€§èƒ½è¡¨ç°     â”‚ â† TPSã€å»¶è¿Ÿã€èµ„æºæ¶ˆè€—
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    åŠŸèƒ½å®Œå–„åº¦   â”‚ â† äº‹åŠ¡æ¨¡å¼ã€åè®®æ”¯æŒ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    ç”Ÿæ€å…¼å®¹æ€§   â”‚ â† Springã€Dubboé›†æˆ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¸šåŠ¡ç»´åº¦ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    å›¢é˜ŸæŠ€èƒ½     â”‚ â† å­¦ä¹ æˆæœ¬ã€ç»´æŠ¤èƒ½åŠ›
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    ä¸šåŠ¡å¤æ‚åº¦   â”‚ â† äº‹åŠ¡é“¾è·¯ã€å¹¶å‘é‡
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    å¯é æ€§è¦æ±‚   â”‚ â† SLAã€å®¹é”™èƒ½åŠ›
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    æ‰©å±•æ€§éœ€æ±‚   â”‚ â† æœªæ¥å‘å±•ã€æŠ€æœ¯æ¼”è¿›
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 é€‰å‹è¯„åˆ†æ ‡å‡†


**ğŸ“‹ è¯„åˆ†ä½“ç³» (æ»¡åˆ†10åˆ†)**

| è¯„ä¼°é¡¹ç›® | **æƒé‡** | **Seata** | **LCN** | **DTM** |
|---------|---------|-----------|---------|---------|
| ğŸ”§ **æŠ€æœ¯æˆç†Ÿåº¦** | `25%` | `9åˆ†` | `6åˆ†` | `7åˆ†` |
| âš¡ **æ€§èƒ½è¡¨ç°** | `20%` | `8åˆ†` | `7åˆ†` | `8åˆ†` |
| ğŸ› ï¸ **åŠŸèƒ½å®Œå–„åº¦** | `20%` | `9åˆ†` | `5åˆ†` | `7åˆ†` |
| ğŸŒŸ **ç”Ÿæ€é›†æˆ** | `15%` | `9åˆ†` | `6åˆ†` | `6åˆ†` |
| ğŸ“š **æ–‡æ¡£è´¨é‡** | `10%` | `8åˆ†` | `5åˆ†` | `7åˆ†` |
| ğŸ‘¥ **ç¤¾åŒºæ”¯æŒ** | `10%` | `9åˆ†` | `4åˆ†` | `6åˆ†` |
| **ç»¼åˆå¾—åˆ†** | `100%` | `8.5åˆ†` | `5.7åˆ†` | `7.0åˆ†` |

> ğŸ† **ç»“è®º**ï¼šSeataåœ¨å„ä¸ªç»´åº¦éƒ½è¡¨ç°ä¼˜ç§€ï¼Œæ˜¯ä¼ä¸šçº§åº”ç”¨çš„æœ€ä½³é€‰æ‹©

### 4.3 åœºæ™¯åŒ–é€‰å‹å»ºè®®


**ğŸ¯ ä¸åŒåœºæ™¯çš„é€‰å‹ç­–ç•¥**
```
ğŸ¢ å¤§å‹ä¼ä¸šçº§åº”ç”¨ï¼š
æ¨èï¼šSeata
ç†ç”±ï¼šåŠŸèƒ½å®Œå–„ã€ç”Ÿäº§çº§ç¨³å®šã€é˜¿é‡Œç³»ç”Ÿæ€

ğŸš€ ä¸­å°å‹å¿«é€Ÿè¿­ä»£é¡¹ç›®ï¼š
æ¨èï¼šSeata ATæ¨¡å¼
ç†ç”±ï¼šé›¶ä¾µå…¥ã€å¿«é€Ÿä¸Šæ‰‹ã€ç»´æŠ¤ç®€å•

ğŸ’° é‡‘èçº§é«˜å¯é æ€§è¦æ±‚ï¼š
æ¨èï¼šSeata TCCæ¨¡å¼
ç†ç”±ï¼šå¼ºä¸€è‡´æ€§ã€ç²¾ç¡®æ§åˆ¶ã€å¯é æ€§é«˜

ğŸŒ å¤šè¯­è¨€æŠ€æœ¯æ ˆï¼š
æ¨èï¼šDTM
ç†ç”±ï¼šè·¨è¯­è¨€æ”¯æŒã€åè®®æ ‡å‡†åŒ–

ğŸ“š å­¦ä¹ å’ŒéªŒè¯ï¼š
æ¨èï¼šLCN
ç†ç”±ï¼šä»£ç ç®€å•ã€æ˜“äºç†è§£ã€å­¦ä¹ æˆæœ¬ä½
```

---

## 5. ğŸš€ Seataéƒ¨ç½²é…ç½®å®è·µ


### 5.1 åŸºç¡€ç¯å¢ƒå‡†å¤‡


**ğŸ“‹ ç¯å¢ƒä¾èµ–æ¸…å•**
```
åŸºç¡€è½¯ä»¶è¦æ±‚ï¼š
â€¢ JDK 8+ (æ¨èJDK 11)
â€¢ MySQL 5.7+ (å­˜å‚¨TCæ•°æ®)
â€¢ Nacos 1.4+ (æ³¨å†Œä¸­å¿ƒ)
â€¢ Redis 6.0+ (å¯é€‰ï¼Œä¼šè¯å­˜å‚¨)

æœåŠ¡å™¨é…ç½®å»ºè®®ï¼š
â€¢ CPU: 4æ ¸å¿ƒä»¥ä¸Š
â€¢ å†…å­˜: 8GBä»¥ä¸Š
â€¢ ç£ç›˜: SSD 100GBä»¥ä¸Š
â€¢ ç½‘ç»œ: åƒå…†ç½‘å¡
```

### 5.2 TCæœåŠ¡ç«¯éƒ¨ç½²


**ğŸ”§ ä¸‹è½½å’Œé…ç½®**
```bash
# 1. ä¸‹è½½Seata Server
wget https://github.com/seata/seata/releases/download/v1.6.1/seata-server-1.6.1.tar.gz
tar -xzf seata-server-1.6.1.tar.gz
cd seata-server-1.6.1

# 2. åˆ›å»ºæ•°æ®åº“
mysql -u root -p
```

**ğŸ“ æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬**
```sql
-- åˆ›å»ºseataæ•°æ®åº“
CREATE DATABASE seata DEFAULT CHARSET utf8mb4;
USE seata;

-- åˆ›å»ºå…¨å±€äº‹åŠ¡è¡¨
CREATE TABLE global_table (
    xid VARCHAR(128) NOT NULL,
    transaction_id BIGINT,
    status TINYINT NOT NULL,
    application_id VARCHAR(32),
    transaction_service_group VARCHAR(32),
    transaction_name VARCHAR(128),
    timeout INT,
    begin_time BIGINT,
    application_data VARCHAR(2000),
    gmt_create DATETIME,
    gmt_modified DATETIME,
    PRIMARY KEY (xid),
    KEY idx_gmt_modified_status (gmt_modified, status),
    KEY idx_transaction_id (transaction_id)
);

-- åˆ›å»ºåˆ†æ”¯äº‹åŠ¡è¡¨
CREATE TABLE branch_table (
    branch_id BIGINT NOT NULL,
    xid VARCHAR(128) NOT NULL,
    transaction_id BIGINT,
    resource_group_id VARCHAR(32),
    resource_id VARCHAR(256),
    branch_type VARCHAR(8),
    status TINYINT,
    client_id VARCHAR(64),
    application_data VARCHAR(2000),
    gmt_create DATETIME(6),
    gmt_modified DATETIME(6),
    PRIMARY KEY (branch_id),
    KEY idx_xid (xid)
);
```

**âš™ï¸ æœåŠ¡ç«¯é…ç½®æ–‡ä»¶**
```yaml
# application.yml
server:
  port: 7091

spring:
  application:
    name: seata-server

logging:
  config: classpath:logback-spring.xml
  file:
    path: ${user.home}/logs/seata
  level:
    root: info

console:
  user:
    username: seata
    password: seata

seata:
  config:
    type: nacos
    nacos:
      server-addr: localhost:8848
      namespace: ""
      group: SEATA_GROUP
      username: nacos
      password: nacos
  registry:
    type: nacos
    nacos:
      application: seata-server
      server-addr: localhost:8848
      group: SEATA_GROUP
      namespace: ""
      username: nacos
      password: nacos
  store:
    mode: db
    db:
      datasource: druid
      db-type: mysql
      driver-class-name: com.mysql.cj.jdbc.Driver
      url: jdbc:mysql://localhost:3306/seata?useUnicode=true&rewriteBatchedStatements=true
      user: root
      password: 123456
      min-conn: 5
      max-conn: 100
```

### 5.3 å®¢æˆ·ç«¯é›†æˆé…ç½®


**ğŸ“ Mavenä¾èµ–**
```xml
<dependencies>
    <!-- Seataå®¢æˆ·ç«¯ -->
    <dependency>
        <groupId>io.seata</groupId>
        <artifactId>seata-spring-boot-starter</artifactId>
        <version>1.6.1</version>
    </dependency>
    
    <!-- Nacosé…ç½®ä¸­å¿ƒ -->
    <dependency>
        <groupId>com.alibaba.cloud</groupId>
        <artifactId>spring-cloud-starter-alibaba-nacos-config</artifactId>
        <version>2021.0.4.0</version>
    </dependency>
    
    <!-- NacosæœåŠ¡å‘ç° -->
    <dependency>
        <groupId>com.alibaba.cloud</groupId>
        <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>
        <version>2021.0.4.0</version>
    </dependency>
</dependencies>
```

**âš™ï¸ å®¢æˆ·ç«¯é…ç½®**
```yaml
# application.yml
spring:
  application:
    name: order-service
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848
      config:
        server-addr: localhost:8848
        file-extension: yml

seata:
  enabled: true
  application-id: ${spring.application.name}
  tx-service-group: my_tx_group
  service:
    vgroup-mapping:
      my_tx_group: default
    grouplist:
      default: localhost:8091
  config:
    type: nacos
    nacos:
      server-addr: localhost:8848
      namespace: ""
      group: SEATA_GROUP
  registry:
    type: nacos
    nacos:
      server-addr: localhost:8848
      namespace: ""
      group: SEATA_GROUP
```

### 5.4 æ•°æ®æºé…ç½®


**ğŸ“ æ•°æ®æºä»£ç†é…ç½®**
```java
@Configuration
public class DataSourceConfig {
    
    @Bean
    @ConfigurationProperties(prefix = "spring.datasource")
    public DataSource druidDataSource() {
        return new DruidDataSource();
    }
    
    @Bean
    public DataSourceProxy dataSourceProxy(DataSource dataSource) {
        return new DataSourceProxy(dataSource);
    }
    
    @Bean
    public SqlSessionFactory sqlSessionFactory(DataSourceProxy dataSourceProxy) 
            throws Exception {
        SqlSessionFactoryBean factoryBean = new SqlSessionFactoryBean();
        factoryBean.setDataSource(dataSourceProxy);
        return factoryBean.getObject();
    }
}
```

---

## 6. ğŸ’¼ ä¸šåŠ¡é›†æˆæ–¹æ¡ˆ


### 6.1 ç”µå•†è®¢å•åœºæ™¯é›†æˆ


**ğŸ›’ ä¸šåŠ¡åœºæ™¯æè¿°**
```
ç”µå•†ä¸‹å•æµç¨‹ï¼š
ç”¨æˆ·ä¸‹å• â†’ åˆ›å»ºè®¢å• â†’ æ‰£å‡åº“å­˜ â†’ æ‰£æ¬¾æ”¯ä»˜ â†’ å‘é€é€šçŸ¥

æ¶‰åŠæœåŠ¡ï¼š
â€¢ è®¢å•æœåŠ¡ï¼šåˆ›å»ºè®¢å•è®°å½•
â€¢ åº“å­˜æœåŠ¡ï¼šæ‰£å‡å•†å“åº“å­˜
â€¢ æ”¯ä»˜æœåŠ¡ï¼šæ‰£å‡è´¦æˆ·ä½™é¢
â€¢ é€šçŸ¥æœåŠ¡ï¼šå‘é€è®¢å•ç¡®è®¤æ¶ˆæ¯
```

**ğŸ“ è®¢å•æœåŠ¡å®ç°**
```java
@Service
public class OrderService {
    
    @Autowired
    private OrderMapper orderMapper;
    
    @Autowired
    private InventoryService inventoryService;
    
    @Autowired
    private PaymentService paymentService;
    
    @Autowired
    private NotificationService notificationService;
    
    @GlobalTransactional(name = "create-order", rollbackFor = Exception.class)
    public OrderResult createOrder(CreateOrderRequest request) {
        try {
            // 1. å‚æ•°éªŒè¯
            validateOrderRequest(request);
            
            // 2. åˆ›å»ºè®¢å•
            Order order = new Order();
            order.setUserId(request.getUserId());
            order.setProductId(request.getProductId());
            order.setQuantity(request.getQuantity());
            order.setAmount(request.getAmount());
            order.setStatus(OrderStatus.CREATED);
            orderMapper.insert(order);
            
            // 3. æ‰£å‡åº“å­˜
            InventoryResult inventoryResult = inventoryService.decreaseStock(
                request.getProductId(), request.getQuantity());
            if (!inventoryResult.isSuccess()) {
                throw new BusinessException("åº“å­˜ä¸è¶³");
            }
            
            // 4. æ‰£æ¬¾æ”¯ä»˜
            PaymentResult paymentResult = paymentService.deductBalance(
                request.getUserId(), request.getAmount());
            if (!paymentResult.isSuccess()) {
                throw new BusinessException("ä½™é¢ä¸è¶³");
            }
            
            // 5. æ›´æ–°è®¢å•çŠ¶æ€
            order.setStatus(OrderStatus.PAID);
            orderMapper.updateById(order);
            
            // 6. å‘é€é€šçŸ¥
            notificationService.sendOrderConfirmation(order);
            
            return OrderResult.success(order);
            
        } catch (Exception e) {
            log.error("åˆ›å»ºè®¢å•å¤±è´¥", e);
            throw e; // Seataä¼šè‡ªåŠ¨å›æ»šæ‰€æœ‰æ“ä½œ
        }
    }
}
```

**ğŸ“ åº“å­˜æœåŠ¡å®ç°**
```java
@Service
public class InventoryService {
    
    @Autowired
    private InventoryMapper inventoryMapper;
    
    public InventoryResult decreaseStock(Long productId, Integer quantity) {
        // æŸ¥è¯¢å½“å‰åº“å­˜
        Inventory inventory = inventoryMapper.selectByProductId(productId);
        if (inventory == null) {
            return InventoryResult.failure("å•†å“ä¸å­˜åœ¨");
        }
        
        // æ£€æŸ¥åº“å­˜æ˜¯å¦å……è¶³
        if (inventory.getStock() < quantity) {
            return InventoryResult.failure("åº“å­˜ä¸è¶³");
        }
        
        // æ‰£å‡åº“å­˜ - ä½¿ç”¨ä¹è§‚é”é˜²æ­¢è¶…å–
        int updated = inventoryMapper.decreaseStock(productId, quantity, 
            inventory.getVersion());
        if (updated == 0) {
            return InventoryResult.failure("åº“å­˜æ›´æ–°å¤±è´¥ï¼Œè¯·é‡è¯•");
        }
        
        return InventoryResult.success();
    }
}
```

### 6.2 å¼‚å¸¸å¤„ç†ç­–ç•¥


**ğŸ›¡ï¸ å¼‚å¸¸åˆ†ç±»å¤„ç†**
```java
@Component
public class TransactionExceptionHandler {
    
    @GlobalTransactional
    public void handleBusinessTransaction() {
        try {
            // ä¸šåŠ¡é€»è¾‘
            businessService.execute();
            
        } catch (BusinessException e) {
            // ä¸šåŠ¡å¼‚å¸¸ï¼šæ˜ç¡®å›æ»š
            log.warn("ä¸šåŠ¡å¼‚å¸¸ï¼Œäº‹åŠ¡å›æ»š: {}", e.getMessage());
            throw e;
            
        } catch (SystemException e) {
            // ç³»ç»Ÿå¼‚å¸¸ï¼šéœ€è¦å›æ»š
            log.error("ç³»ç»Ÿå¼‚å¸¸ï¼Œäº‹åŠ¡å›æ»š", e);
            throw new TransactionException("ç³»ç»Ÿå¼‚å¸¸", e);
            
        } catch (Exception e) {
            // æœªçŸ¥å¼‚å¸¸ï¼šå®‰å…¨èµ·è§å›æ»š
            log.error("æœªçŸ¥å¼‚å¸¸ï¼Œäº‹åŠ¡å›æ»š", e);
            throw new TransactionException("æœªçŸ¥å¼‚å¸¸", e);
        }
    }
}
```

**âš™ï¸ é‡è¯•æœºåˆ¶é…ç½®**
```java
@Configuration
public class SeataRetryConfig {
    
    @Bean
    public RetryTemplate retryTemplate() {
        RetryTemplate retryTemplate = new RetryTemplate();
        
        // é‡è¯•ç­–ç•¥ï¼šæœ€å¤šé‡è¯•3æ¬¡
        SimpleRetryPolicy retryPolicy = new SimpleRetryPolicy();
        retryPolicy.setMaxAttempts(3);
        retryTemplate.setRetryPolicy(retryPolicy);
        
        // é€€é¿ç­–ç•¥ï¼šæŒ‡æ•°é€€é¿
        ExponentialBackOffPolicy backOffPolicy = new ExponentialBackOffPolicy();
        backOffPolicy.setInitialInterval(1000); // åˆå§‹é—´éš”1ç§’
        backOffPolicy.setMultiplier(2.0); // å€å¢å› å­
        backOffPolicy.setMaxInterval(10000); // æœ€å¤§é—´éš”10ç§’
        retryTemplate.setBackOffPolicy(backOffPolicy);
        
        return retryTemplate;
    }
}
```

---

## 7. âš¡ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


### 7.1 äº‹åŠ¡æ€§èƒ½åŸºå‡†


**ğŸ“Š æ€§èƒ½æŒ‡æ ‡åŸºå‡†**
```
å•æœºæ€§èƒ½åŸºå‡† (4æ ¸8G):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   äº‹åŠ¡æ¨¡å¼      â”‚   TPS    â”‚  å¹³å‡å»¶è¿Ÿ â”‚  P99å»¶è¿Ÿ  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ATæ¨¡å¼        â”‚  1200    â”‚   80ms   â”‚  200ms   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   TCCæ¨¡å¼       â”‚  2000    â”‚   50ms   â”‚  120ms   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Sagaæ¨¡å¼      â”‚  2500    â”‚   40ms   â”‚  100ms   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é›†ç¾¤æ€§èƒ½åŸºå‡† (3èŠ‚ç‚¹):
â€¢ TPSæå‡ï¼š2-3å€
â€¢ å»¶è¿Ÿé™ä½ï¼š20-30%
â€¢ å¯ç”¨æ€§ï¼š99.9%+
```

### 7.2 å®¢æˆ·ç«¯ä¼˜åŒ–ç­–ç•¥


**âš™ï¸ è¿æ¥æ± ä¼˜åŒ–**
```yaml
seata:
  client:
    rm:
      async-commit-buffer-limit: 10000
      lock:
        retry-interval: 10
        retry-times: 30
        retry-policy-branch-rollback-on-conflict: true
    tm:
      commit-retry-count: 5
      rollback-retry-count: 5
    undo:
      data-validation: true
      log-serialization: jackson
      log-table: undo_log
    log:
      exceptionRate: 100
```

**ğŸ“ æ‰¹é‡æ“ä½œä¼˜åŒ–**
```java
@Service
public class BatchTransactionService {
    
    @GlobalTransactional
    public void batchCreateOrders(List<CreateOrderRequest> requests) {
        // æ‰¹é‡å¤„ç†ï¼Œå‡å°‘ç½‘ç»œå¾€è¿”
        for (List<CreateOrderRequest> batch : Lists.partition(requests, 100)) {
            processBatch(batch);
        }
    }
    
    private void processBatch(List<CreateOrderRequest> batch) {
        // æ‰¹é‡æ•°æ®åº“æ“ä½œ
        List<Order> orders = batch.stream()
            .map(this::buildOrder)
            .collect(Collectors.toList());
        orderMapper.batchInsert(orders);
        
        // æ‰¹é‡è°ƒç”¨å…¶ä»–æœåŠ¡
        inventoryService.batchDecreaseStock(
            batch.stream().map(r -> new StockRequest(r.getProductId(), r.getQuantity()))
                .collect(Collectors.toList())
        );
    }
}
```

### 7.3 æœåŠ¡ç«¯ä¼˜åŒ–ç­–ç•¥


**âš™ï¸ JVMå‚æ•°ä¼˜åŒ–**
```bash
# Seata Serverå¯åŠ¨å‚æ•°
java -Xms2g -Xmx2g \
     -XX:+UseG1GC \
     -XX:G1HeapRegionSize=16m \
     -XX:+PrintGCDetails \
     -XX:+PrintGCTimeStamps \
     -XX:+PrintGCApplicationStoppedTime \
     -XX:+HeapDumpOnOutOfMemoryError \
     -XX:HeapDumpPath=/var/logs/seata/dump.hprof \
     -jar seata-server.jar
```

**ğŸ“Š æ•°æ®åº“è¿æ¥æ± ä¼˜åŒ–**
```yaml
seata:
  store:
    db:
      min-conn: 10        # æœ€å°è¿æ¥æ•°
      max-conn: 200       # æœ€å¤§è¿æ¥æ•°
      max-wait: 5000      # æœ€å¤§ç­‰å¾…æ—¶é—´
      query-limit: 1000   # æŸ¥è¯¢é™åˆ¶
```

### 7.4 ç›‘æ§å’Œè°ƒä¼˜


**ğŸ“Š å…³é”®æŒ‡æ ‡ç›‘æ§**
```java
@Component
public class SeataMetrics {
    
    private final MeterRegistry meterRegistry;
    
    public SeataMetrics(MeterRegistry meterRegistry) {
        this.meterRegistry = meterRegistry;
    }
    
    @EventListener
    public void handleGlobalTransactionEvent(GlobalTransactionEvent event) {
        // è®°å½•å…¨å±€äº‹åŠ¡æŒ‡æ ‡
        Timer.Sample sample = Timer.start(meterRegistry);
        sample.stop(Timer.builder("seata.global.transaction")
            .tag("status", event.getStatus())
            .tag("name", event.getTransactionName())
            .register(meterRegistry));
    }
    
    @EventListener  
    public void handleBranchTransactionEvent(BranchTransactionEvent event) {
        // è®°å½•åˆ†æ”¯äº‹åŠ¡æŒ‡æ ‡
        Counter.builder("seata.branch.transaction")
            .tag("type", event.getBranchType())
            .tag("status", event.getStatus())
            .register(meterRegistry)
            .increment();
    }
}
```

---

## 8. ğŸ”§ æ•…éšœå¤„ç†ä¸è¿ç»´


### 8.1 å¸¸è§æ•…éšœåœºæ™¯


**âš ï¸ æ•…éšœåˆ†ç±»å’Œå¤„ç†**
```
TCæœåŠ¡æ•…éšœï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    æ•…éšœç°è±¡ï¼š
â”‚ TCæœåŠ¡ä¸å¯ç”¨     â”‚ â† â€¢ æ³¨å†Œä¸­å¿ƒè¿æ¥å¤±è´¥
â”‚                â”‚ â† â€¢ æ•°æ®åº“è¿æ¥å¼‚å¸¸  
â”‚                â”‚ â† â€¢ å†…å­˜æº¢å‡º
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¤„ç†æ­¥éª¤ï¼š
1. æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼šsystemctl status seata
2. æŸ¥çœ‹é”™è¯¯æ—¥å¿—ï¼štail -f /var/logs/seata/seata.log
3. æ£€æŸ¥ä¾èµ–æœåŠ¡ï¼šNacosã€MySQLè¿æ¥çŠ¶æ€
4. é‡å¯æœåŠ¡ï¼šsystemctl restart seata

å®¢æˆ·ç«¯è¿æ¥æ•…éšœï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    æ•…éšœç°è±¡ï¼š
â”‚ RMæ³¨å†Œå¤±è´¥      â”‚ â† â€¢ ç½‘ç»œè¿æ¥é—®é¢˜
â”‚                â”‚ â† â€¢ é…ç½®é”™è¯¯
â”‚                â”‚ â† â€¢ ç‰ˆæœ¬ä¸å…¼å®¹
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¤„ç†æ­¥éª¤ï¼š
1. æ£€æŸ¥ç½‘ç»œè¿é€šæ€§ï¼štelnet tc-server 8091
2. éªŒè¯é…ç½®ï¼šæ£€æŸ¥tx-service-groupé…ç½®
3. æŸ¥çœ‹å®¢æˆ·ç«¯æ—¥å¿—ï¼šæœç´¢"register RM"å…³é”®è¯
```

### 8.2 äº‹åŠ¡çŠ¶æ€å¤„ç†


**ğŸ”„ æ‚¬æŒ‚äº‹åŠ¡å¤„ç†**
```java
@Component
public class TransactionCleaner {
    
    @Autowired
    private TransactionManager transactionManager;
    
    @Scheduled(fixedDelay = 300000) // 5åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡
    public void cleanTimeoutTransactions() {
        // æŸ¥è¯¢è¶…æ—¶çš„å…¨å±€äº‹åŠ¡
        List<GlobalSession> timeoutSessions = findTimeoutSessions();
        
        for (GlobalSession session : timeoutSessions) {
            try {
                log.warn("æ¸…ç†è¶…æ—¶äº‹åŠ¡: {}", session.getXid());
                transactionManager.rollback(session.getXid());
                
            } catch (Exception e) {
                log.error("æ¸…ç†äº‹åŠ¡å¤±è´¥: {}", session.getXid(), e);
            }
        }
    }
    
    private List<GlobalSession> findTimeoutSessions() {
        // æŸ¥è¯¢åˆ›å»ºæ—¶é—´è¶…è¿‡30åˆ†é’Ÿçš„äº‹åŠ¡
        long timeoutThreshold = System.currentTimeMillis() - 30 * 60 * 1000;
        return globalSessionRepository.findTimeoutSessions(timeoutThreshold);
    }
}
```

### 8.3 æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥


**ğŸ” ä¸€è‡´æ€§æ ¡éªŒå·¥å…·**
```java
@Component
public class ConsistencyChecker {
    
    public void checkDataConsistency(String xid) {
        GlobalSession globalSession = getGlobalSession(xid);
        
        for (BranchSession branchSession : globalSession.getBranchSessions()) {
            boolean isConsistent = checkBranchConsistency(branchSession);
            
            if (!isConsistent) {
                log.error("å‘ç°æ•°æ®ä¸ä¸€è‡´: XID={}, BranchId={}", 
                    xid, branchSession.getBranchId());
                
                // è§¦å‘æ•°æ®ä¿®å¤
                repairDataInconsistency(branchSession);
            }
        }
    }
    
    private boolean checkBranchConsistency(BranchSession branchSession) {
        // æ£€æŸ¥ä¸šåŠ¡æ•°æ®ä¸undo_logçš„ä¸€è‡´æ€§
        String sql = "SELECT COUNT(*) FROM undo_log WHERE xid = ? AND branch_id = ?";
        int undoLogCount = jdbcTemplate.queryForObject(sql, Integer.class,
            branchSession.getXid(), branchSession.getBranchId());
            
        return undoLogCount > 0; // ç®€åŒ–æ£€æŸ¥é€»è¾‘
    }
}
```

### 8.4 è¿ç»´ç›‘æ§è„šæœ¬


**ğŸ“ å¥åº·æ£€æŸ¥è„šæœ¬**
```bash
#!/bin/bash
# seata_health_check.sh

SEATA_SERVER="localhost:7091"
NACOS_SERVER="localhost:8848"

echo "=== Seataå¥åº·æ£€æŸ¥ ==="

# 1. æ£€æŸ¥TCæœåŠ¡çŠ¶æ€
echo "æ£€æŸ¥TCæœåŠ¡..."
if curl -s http://${SEATA_SERVER}/health > /dev/null; then
    echo "âœ… TCæœåŠ¡æ­£å¸¸"
else
    echo "âŒ TCæœåŠ¡å¼‚å¸¸"
    exit 1
fi

# 2. æ£€æŸ¥æ³¨å†Œä¸­å¿ƒè¿æ¥
echo "æ£€æŸ¥æ³¨å†Œä¸­å¿ƒ..."
if curl -s http://${NACOS_SERVER}/nacos/v1/ns/operator/servers > /dev/null; then
    echo "âœ… æ³¨å†Œä¸­å¿ƒæ­£å¸¸"
else
    echo "âŒ æ³¨å†Œä¸­å¿ƒå¼‚å¸¸"
    exit 1
fi

# 3. æ£€æŸ¥æ•°æ®åº“è¿æ¥
echo "æ£€æŸ¥æ•°æ®åº“..."
mysql -h localhost -u seata -p123456 -e "SELECT 1" seata > /dev/null 2>&1
if [ $? -eq 0 ]; then
    echo "âœ… æ•°æ®åº“è¿æ¥æ­£å¸¸"
else
    echo "âŒ æ•°æ®åº“è¿æ¥å¼‚å¸¸"
    exit 1
fi

# 4. æ£€æŸ¥æ—¥å¿—é”™è¯¯
echo "æ£€æŸ¥é”™è¯¯æ—¥å¿—..."
ERROR_COUNT=$(tail -n 1000 /var/logs/seata/seata.log | grep -c "ERROR")
if [ $ERROR_COUNT -gt 10 ]; then
    echo "âš ï¸  é”™è¯¯æ—¥å¿—è¾ƒå¤š: $ERROR_COUNT æ¡"
else
    echo "âœ… é”™è¯¯æ—¥å¿—æ­£å¸¸: $ERROR_COUNT æ¡"
fi

echo "=== å¥åº·æ£€æŸ¥å®Œæˆ ==="
```

---

## 9. ğŸ¢ ä¼ä¸šçº§éƒ¨ç½²æ¶æ„


### 9.1 é«˜å¯ç”¨æ¶æ„è®¾è®¡


**ğŸ—ï¸ é›†ç¾¤éƒ¨ç½²æ¶æ„**
```
é«˜å¯ç”¨éƒ¨ç½²æ¶æ„ï¼š

                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚   è´Ÿè½½å‡è¡¡å™¨     â”‚
                 â”‚   (Nginx/LVS)   â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚                 â”‚
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚  Seata TC1  â”‚  â”‚  Seata TC2  â”‚  â”‚  Seata TC3  â”‚
 â”‚   (ä¸»èŠ‚ç‚¹)   â”‚  â”‚   (ä»èŠ‚ç‚¹)   â”‚  â”‚   (ä»èŠ‚ç‚¹)   â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                 â”‚                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   æ•°æ®åº“é›†ç¾¤     â”‚
              â”‚ (MySQLä¸»ä»é›†ç¾¤)  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‰¹ç‚¹ï¼š
â€¢ 3èŠ‚ç‚¹é›†ç¾¤ä¿è¯é«˜å¯ç”¨
â€¢ æ•°æ®åº“ä¸»ä»å¤åˆ¶ä¿è¯æ•°æ®å®‰å…¨
â€¢ è´Ÿè½½å‡è¡¡ä¿è¯æ€§èƒ½
â€¢ æ•…éšœè‡ªåŠ¨åˆ‡æ¢
```

### 9.2 å¤šç¯å¢ƒéƒ¨ç½²ç­–ç•¥


**ğŸŒ ç¯å¢ƒéš”ç¦»æ–¹æ¡ˆ**
```yaml
# å¼€å‘ç¯å¢ƒé…ç½®
seata:
  config:
    nacos:
      namespace: "dev"
      group: "SEATA_GROUP"
  registry:
    nacos:
      namespace: "dev"
      group: "SEATA_GROUP"

# æµ‹è¯•ç¯å¢ƒé…ç½®  
seata:
  config:
    nacos:
      namespace: "test"
      group: "SEATA_GROUP"
  registry:
    nacos:
      namespace: "test"
      group: "SEATA_GROUP"

# ç”Ÿäº§ç¯å¢ƒé…ç½®
seata:
  config:
    nacos:
      namespace: "prod"
      group: "SEATA_GROUP"
  registry:
    nacos:
      namespace: "prod"
      group: "SEATA_GROUP"
```

### 9.3 å®¹å™¨åŒ–éƒ¨ç½²


**ğŸ³ Dockeréƒ¨ç½²é…ç½®**
```dockerfile
# Dockerfile
FROM openjdk:11-jre-slim

# å®‰è£…å¿…è¦çš„å·¥å…·
RUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*

# åˆ›å»ºåº”ç”¨ç›®å½•
WORKDIR /app

# å¤åˆ¶SeataæœåŠ¡å™¨
COPY seata-server-1.6.1.jar /app/seata-server.jar
COPY application.yml /app/

# æš´éœ²ç«¯å£
EXPOSE 7091 8091

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=3s --start-period=40s --retries=3 \
  CMD curl -f http://localhost:7091/health || exit 1

# å¯åŠ¨å‘½ä»¤
CMD ["java", "-jar", "-Xms2g", "-Xmx2g", "seata-server.jar"]
```

**ğŸ“ Docker Composeé…ç½®**
```yaml
version: '3.8'
services:
  seata-server:
    image: seata/seata-server:1.6.1
    ports:
      - "7091:7091"
      - "8091:8091"
    environment:
      - SEATA_CONFIG_NAME=file:/root/seata-config/registry
    volumes:
      - ./config:/root/seata-config
    depends_on:
      - mysql
      - nacos
    restart: always

  mysql:
    image: mysql:8.0
    environment:
      MYSQL_ROOT_PASSWORD: 123456
      MYSQL_DATABASE: seata
    volumes:
      - mysql_data:/var/lib/mysql
      - ./sql:/docker-entrypoint-initdb.d
    ports:
      - "3306:3306"

  nacos:
    image: nacos/nacos-server:v2.2.0
    environment:
      MODE: standalone
    ports:
      - "8848:8848"

volumes:
  mysql_data:
```

### 9.4 å‡çº§ä¸è¿ç§»ç­–ç•¥


**ğŸ”„ ç‰ˆæœ¬å‡çº§æ–¹æ¡ˆ**
```
æ»šåŠ¨å‡çº§æ­¥éª¤ï¼š

1. å‡†å¤‡é˜¶æ®µ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ å¤‡ä»½æ•°æ®åº“     â”‚
â”‚ â€¢ å‡†å¤‡æ–°ç‰ˆæœ¬    â”‚
â”‚ â€¢ åˆ¶å®šå›æ»šè®¡åˆ’   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. å‡çº§é˜¶æ®µ  
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ åœæ­¢èŠ‚ç‚¹3     â”‚ â†’ å‡çº§ â†’ å¯åŠ¨éªŒè¯
â”‚ â€¢ åœæ­¢èŠ‚ç‚¹2     â”‚ â†’ å‡çº§ â†’ å¯åŠ¨éªŒè¯  
â”‚ â€¢ åœæ­¢èŠ‚ç‚¹1     â”‚ â†’ å‡çº§ â†’ å¯åŠ¨éªŒè¯
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. éªŒè¯é˜¶æ®µ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ åŠŸèƒ½æµ‹è¯•      â”‚
â”‚ â€¢ æ€§èƒ½æµ‹è¯•      â”‚
â”‚ â€¢ äº‹åŠ¡å®Œæ•´æ€§æµ‹è¯• â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ³¨æ„äº‹é¡¹ï¼š
â€¢ å‡çº§å‰å……åˆ†æµ‹è¯•
â€¢ ä¿æŒå‘åå…¼å®¹æ€§
â€¢ å‡†å¤‡å¿«é€Ÿå›æ»šæ–¹æ¡ˆ
â€¢ ç›‘æ§ä¸šåŠ¡æŒ‡æ ‡
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ”¸ åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶ï¼šè§£å†³è·¨æœåŠ¡äº‹åŠ¡ä¸€è‡´æ€§çš„ä¸­é—´ä»¶
ğŸ”¸ Seataä¸‰å¤§ç»„ä»¶ï¼šTMäº‹åŠ¡ç®¡ç†å™¨ã€RMèµ„æºç®¡ç†å™¨ã€TCäº‹åŠ¡åè°ƒå™¨
ğŸ”¸ ä¸‰ç§äº‹åŠ¡æ¨¡å¼ï¼šATè‡ªåŠ¨äº‹åŠ¡ã€TCCè¡¥å¿äº‹åŠ¡ã€Sagaé•¿äº‹åŠ¡
ğŸ”¸ æ¡†æ¶é€‰å‹åŸåˆ™ï¼šæŠ€æœ¯æˆç†Ÿåº¦ã€æ€§èƒ½è¡¨ç°ã€ç”Ÿæ€é›†æˆã€å›¢é˜Ÿèƒ½åŠ›
ğŸ”¸ éƒ¨ç½²é…ç½®è¦ç‚¹ï¼šç¯å¢ƒå‡†å¤‡ã€æœåŠ¡ç«¯é…ç½®ã€å®¢æˆ·ç«¯é›†æˆã€æ•°æ®æºä»£ç†
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆé€‰æ‹©Seata**
```
æŠ€æœ¯ä¼˜åŠ¿ï¼š
â€¢ é˜¿é‡Œå·´å·´å¼€æºï¼Œä¹…ç»ç”Ÿäº§éªŒè¯
â€¢ å¤šç§äº‹åŠ¡æ¨¡å¼ï¼Œé€‚åº”ä¸åŒåœºæ™¯
â€¢ å®Œå–„çš„Springç”Ÿæ€é›†æˆ
â€¢ æ´»è·ƒçš„ç¤¾åŒºæ”¯æŒ

ä¸šåŠ¡ä»·å€¼ï¼š
â€¢ é™ä½åˆ†å¸ƒå¼äº‹åŠ¡å¼€å‘å¤æ‚åº¦
â€¢ æä¾›ç”Ÿäº§çº§çš„å¯é æ€§ä¿è¯
â€¢ æ”¯æŒå¾®æœåŠ¡æ¶æ„æ¼”è¿›
â€¢ å‡å°‘æ•°æ®ä¸€è‡´æ€§é—®é¢˜
```

**ğŸ”¹ äº‹åŠ¡æ¨¡å¼é€‰æ‹©ç­–ç•¥**
```
ATæ¨¡å¼ï¼š
â€¢ é€‚ç”¨ï¼šé€šç”¨ä¸šåŠ¡åœºæ™¯
â€¢ ä¼˜åŠ¿ï¼šé›¶ä¾µå…¥ï¼Œç®€å•æ˜“ç”¨
â€¢ åŠ£åŠ¿ï¼šæ€§èƒ½ä¸€èˆ¬ï¼Œéš”ç¦»çº§åˆ«ä½

TCCæ¨¡å¼ï¼š
â€¢ é€‚ç”¨ï¼šé‡‘èã€æ”¯ä»˜ç­‰å¼ºä¸€è‡´æ€§åœºæ™¯
â€¢ ä¼˜åŠ¿ï¼šæ€§èƒ½å¥½ï¼Œä¸€è‡´æ€§å¼º
â€¢ åŠ£åŠ¿ï¼šå¼€å‘å¤æ‚ï¼Œä¾µå…¥æ€§å¼º

Sagaæ¨¡å¼ï¼š
â€¢ é€‚ç”¨ï¼šé•¿æµç¨‹ã€å¤šæ­¥éª¤ä¸šåŠ¡
â€¢ ä¼˜åŠ¿ï¼šæ€§èƒ½å¥½ï¼Œæ‰©å±•æ€§å¼º
â€¢ åŠ£åŠ¿ï¼šæœ€ç»ˆä¸€è‡´æ€§ï¼Œè¡¥å¿å¤æ‚
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–å…³é”®ç‚¹**
```
å®¢æˆ·ç«¯ä¼˜åŒ–ï¼š
â€¢ è¿æ¥æ± å‚æ•°è°ƒä¼˜
â€¢ æ‰¹é‡æ“ä½œå‡å°‘ç½‘ç»œå¼€é”€
â€¢ å¼‚æ­¥æäº¤æå‡æ€§èƒ½

æœåŠ¡ç«¯ä¼˜åŒ–ï¼š
â€¢ JVMå‚æ•°è°ƒä¼˜
â€¢ æ•°æ®åº“è¿æ¥æ± ä¼˜åŒ–
â€¢ é›†ç¾¤éƒ¨ç½²æå‡ååé‡

ç›‘æ§è°ƒä¼˜ï¼š
â€¢ å…³é”®æŒ‡æ ‡ç›‘æ§
â€¢ æ€§èƒ½ç“¶é¢ˆè¯†åˆ«
â€¢ æŒç»­ä¼˜åŒ–æ”¹è¿›
```

### 10.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ ä¸šåŠ¡åœºæ™¯åº”ç”¨**
- **ç”µå•†ç³»ç»Ÿ**ï¼šè®¢å•ã€åº“å­˜ã€æ”¯ä»˜çš„ä¸€è‡´æ€§ä¿è¯
- **é‡‘èç³»ç»Ÿ**ï¼šè½¬è´¦ã€æ”¯ä»˜ã€æ¸…ç®—çš„å¼ºä¸€è‡´æ€§
- **ç‰©æµç³»ç»Ÿ**ï¼šè®¢å•ã€è¿è¾“ã€é…é€çš„æµç¨‹ç®¡ç†
- **è¥é”€ç³»ç»Ÿ**ï¼šä¼˜æƒ åˆ¸ã€ç§¯åˆ†ã€ä¼šå‘˜çš„è”åŠ¨æ“ä½œ

**ğŸ”§ æŠ€æœ¯å®è·µè¦ç‚¹**
- **æ¶æ„è®¾è®¡**ï¼šåˆç†é€‰æ‹©äº‹åŠ¡æ¨¡å¼å’Œæ¡†æ¶
- **éƒ¨ç½²è¿ç»´**ï¼šé«˜å¯ç”¨é›†ç¾¤å’Œç›‘æ§ä½“ç³»
- **æ€§èƒ½è°ƒä¼˜**ï¼šåŸºäºä¸šåŠ¡ç‰¹ç‚¹ä¼˜åŒ–é…ç½®
- **æ•…éšœå¤„ç†**ï¼šå»ºç«‹å®Œå–„çš„åº”æ€¥å“åº”æœºåˆ¶

**ğŸš€ å‘å±•è¶‹åŠ¿**
- **äº‘åŸç”Ÿæ”¯æŒ**ï¼šKubernetesã€Service Meshé›†æˆ
- **å¤šè¯­è¨€æ‰©å±•**ï¼šæ”¯æŒæ›´å¤šç¼–ç¨‹è¯­è¨€
- **æ€§èƒ½æå‡**ï¼šæ›´é«˜çš„TPSå’Œæ›´ä½çš„å»¶è¿Ÿ
- **æ™ºèƒ½åŒ–è¿ç»´**ï¼šè‡ªåŠ¨æ•…éšœæ£€æµ‹å’Œæ¢å¤

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- åˆ†å¸ƒå¼äº‹åŠ¡é€‰Seataï¼Œä¸‰å¤§ç»„ä»¶è¦è®°æ¸…
- ATç®€å•TCCå¼ºï¼ŒSagaé€‚åˆé•¿æµç¨‹
- éƒ¨ç½²é…ç½®è¦ä»”ç»†ï¼Œç›‘æ§ä¼˜åŒ–ä¸èƒ½åœ
- é«˜å¯ç”¨æ¶æ„ä¿ç¨³å®šï¼Œæ•…éšœå¤„ç†æœ‰é¢„æ¡ˆ