---
title: 1ã€ç©å®¶æ•°æ®è®¾è®¡
---
## ğŸ“š ç›®å½•

1. [ç©å®¶æ•°æ®è®¾è®¡æ¦‚è¿°](#1-ç©å®¶æ•°æ®è®¾è®¡æ¦‚è¿°)
2. [ç©å®¶åŸºç¡€ä¿¡æ¯è¡¨è®¾è®¡](#2-ç©å®¶åŸºç¡€ä¿¡æ¯è¡¨è®¾è®¡)
3. [è§’è‰²å±æ€§æ•°æ®ç»“æ„](#3-è§’è‰²å±æ€§æ•°æ®ç»“æ„)
4. [æ¸¸æˆè¿›åº¦ä¸çŠ¶æ€ç®¡ç†](#4-æ¸¸æˆè¿›åº¦ä¸çŠ¶æ€ç®¡ç†)
5. [è£…å¤‡é“å…·æ•°æ®æ¨¡å‹](#5-è£…å¤‡é“å…·æ•°æ®æ¨¡å‹)
6. [æŠ€èƒ½å¤©èµ‹æ ‘è®¾è®¡](#6-æŠ€èƒ½å¤©èµ‹æ ‘è®¾è®¡)
7. [ç©å®¶ç»Ÿè®¡æ•°æ®](#7-ç©å®¶ç»Ÿè®¡æ•°æ®)
8. [é«˜çº§æ•°æ®æ¶æ„è®¾è®¡](#8-é«˜çº§æ•°æ®æ¶æ„è®¾è®¡)
9. [æ•°æ®å®‰å…¨ä¸æ€§èƒ½ä¼˜åŒ–](#9-æ•°æ®å®‰å…¨ä¸æ€§èƒ½ä¼˜åŒ–)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ® ç©å®¶æ•°æ®è®¾è®¡æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯ç©å®¶æ•°æ®è®¾è®¡


**ğŸ”¸ æ ¸å¿ƒå®šä¹‰**
```
ç©å®¶æ•°æ®è®¾è®¡ï¼šä¸ºæ¸¸æˆä¸­çš„ç©å®¶ä¿¡æ¯è®¾è®¡åˆç†çš„æ•°æ®åº“ç»“æ„
ç›®æ ‡ï¼šé«˜æ•ˆå­˜å‚¨ç©å®¶çš„æ‰€æœ‰æ¸¸æˆç›¸å…³ä¿¡æ¯
åŒ…å«ï¼šåŸºç¡€ä¿¡æ¯ã€è§’è‰²æ•°æ®ã€æ¸¸æˆè¿›åº¦ã€ç‰©å“è£…å¤‡ç­‰
```

**ğŸ’¡ è®¾è®¡æ€æƒ³**
ç©å®¶æ•°æ®å°±åƒæ˜¯ç°å®ä¸­çš„ä¸ªäººæ¡£æ¡ˆï¼Œä½†æ¯”ç°å®æ›´å¤æ‚ï¼š
- **åŸºç¡€æ¡£æ¡ˆ**ï¼šå§“åã€å¹´é¾„ç­‰åŸºæœ¬ä¿¡æ¯
- **èƒ½åŠ›æ¡£æ¡ˆ**ï¼šç­‰çº§ã€æŠ€èƒ½ã€å±æ€§ç­‰æ¸¸æˆèƒ½åŠ›
- **è´¢äº§æ¡£æ¡ˆ**ï¼šé‡‘å¸ã€è£…å¤‡ã€é“å…·ç­‰è™šæ‹Ÿè´¢äº§
- **è¡Œä¸ºæ¡£æ¡ˆ**ï¼šæ¸¸æˆå†å²ã€ç¤¾äº¤å…³ç³»ç­‰è¡Œä¸ºæ•°æ®

### 1.2 ç©å®¶æ•°æ®çš„ç‰¹ç‚¹


**ğŸ¯ æ¸¸æˆæ•°æ®çš„ç‹¬ç‰¹æ€§**
```
é«˜é¢‘è¯»å†™ï¼šç©å®¶æ¯æ¬¡æ“ä½œéƒ½å¯èƒ½ä¿®æ”¹æ•°æ®
æ•°æ®å¤æ‚ï¼šåŒ…å«å¤šç§ä¸åŒç±»å‹çš„ä¿¡æ¯
å®æ—¶æ€§å¼ºï¼šæˆ˜æ–—ã€äº¤æ˜“ç­‰éœ€è¦å®æ—¶æ›´æ–°
å…³ç³»å¯†åˆ‡ï¼šè§’è‰²ã€è£…å¤‡ã€æŠ€èƒ½ç­‰æ•°æ®ç›¸äº’å…³è”
```

**ğŸ“Š æ•°æ®è§„æ¨¡ç‰¹å¾**
```
å•ç©å®¶æ•°æ®ï¼šé€šå¸¸å‡ KBåˆ°å‡ MB
å¤§å‹æ¸¸æˆï¼šç™¾ä¸‡çº§åˆ°åƒä¸‡çº§ç©å®¶
å¹¶å‘æ“ä½œï¼šåŒæ—¶åœ¨çº¿ç”¨æˆ·çš„æ•°æ®è®¿é—®
å†å²æ•°æ®ï¼šç©å®¶çš„å†å²è¡Œä¸ºè®°å½•
```

---

## 2. ğŸ‘¤ ç©å®¶åŸºç¡€ä¿¡æ¯è¡¨è®¾è®¡


### 2.1 ç©å®¶åŸºç¡€ä¿¡æ¯è¡¨


**ğŸ”¸ è¡¨ç»“æ„è®¾è®¡**
```sql
CREATE TABLE players (
    player_id BIGINT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    email VARCHAR(100) NOT NULL UNIQUE,
    phone VARCHAR(20),
    password_hash VARCHAR(255) NOT NULL,
    salt VARCHAR(32) NOT NULL,
    
    -- åŸºç¡€ä¿¡æ¯
    nickname VARCHAR(50),
    avatar_url VARCHAR(255),
    gender TINYINT DEFAULT 0, -- 0æœªçŸ¥ 1ç”· 2å¥³
    birth_date DATE,
    
    -- è´¦å·çŠ¶æ€
    status TINYINT DEFAULT 1, -- 1æ­£å¸¸ 2å†»ç»“ 3å°ç¦
    vip_level TINYINT DEFAULT 0,
    vip_expire_time DATETIME,
    
    -- æ—¶é—´è®°å½•
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    last_login_time DATETIME,
    last_login_ip VARCHAR(45),
    
    -- ç´¢å¼•
    INDEX idx_username (username),
    INDEX idx_email (email),
    INDEX idx_status (status),
    INDEX idx_last_login (last_login_time)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

**ğŸ’¡ è®¾è®¡è¯´æ˜**
- **`player_id`**ï¼šä½¿ç”¨BIGINTæ”¯æŒæµ·é‡ç”¨æˆ·
- **`username`**ï¼šæ¸¸æˆå†…æ˜¾ç¤ºåç§°ï¼Œéœ€è¦å”¯ä¸€æ€§
- **`password_hash`**ï¼šå­˜å‚¨åŠ å¯†åçš„å¯†ç ï¼Œä¿è¯å®‰å…¨æ€§
- **`salt`**ï¼šå¯†ç åŠ ç›ï¼Œé˜²æ­¢å½©è™¹è¡¨æ”»å‡»
- **`status`**ï¼šè´¦å·çŠ¶æ€ç®¡ç†ï¼Œæ–¹ä¾¿è¿è¥ç®¡æ§

### 2.2 ç©å®¶æ‰©å±•ä¿¡æ¯è¡¨


**ğŸ”¸ æ‰©å±•ä¿¡æ¯è®¾è®¡**
```sql
CREATE TABLE player_profiles (
    player_id BIGINT PRIMARY KEY,
    
    -- æ¸¸æˆåå¥½
    preferred_server VARCHAR(50),
    preferred_language VARCHAR(10) DEFAULT 'zh-CN',
    game_settings JSON, -- æ¸¸æˆè®¾ç½®ï¼ˆéŸ³æ•ˆã€ç”»è´¨ç­‰ï¼‰
    
    -- ç¤¾äº¤ä¿¡æ¯
    signature VARCHAR(200), -- ä¸ªæ€§ç­¾å
    region VARCHAR(50), -- åœ°åŒº
    timezone VARCHAR(50) DEFAULT 'Asia/Shanghai',
    
    -- ç»Ÿè®¡ä¿¡æ¯
    total_play_time INT DEFAULT 0, -- æ€»æ¸¸æˆæ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
    total_login_days INT DEFAULT 0, -- æ€»ç™»å½•å¤©æ•°
    consecutive_login_days INT DEFAULT 0, -- è¿ç»­ç™»å½•å¤©æ•°
    
    -- å…³è”å¤–é”®
    FOREIGN KEY (player_id) REFERENCES players(player_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

**ğŸ“ ä¸ºä»€ä¹ˆè¦åˆ†è¡¨ï¼Ÿ**
```
ä¸»è¡¨ï¼šå­˜å‚¨æ ¸å¿ƒä¿¡æ¯ï¼ŒæŸ¥è¯¢é¢‘ç‡é«˜
æ‰©å±•è¡¨ï¼šå­˜å‚¨è¡¥å……ä¿¡æ¯ï¼Œå¯é€‰æŸ¥è¯¢
å¥½å¤„ï¼š
1. ä¸»è¡¨æ›´å°ï¼ŒæŸ¥è¯¢æ›´å¿«
2. æ‰©å±•ä¿¡æ¯å¯ä»¥çµæ´»å¢å‡
3. ä¸åŒä¿¡æ¯å¯ä»¥ä¸åŒçš„ç¼“å­˜ç­–ç•¥
```

---

## 3. âš”ï¸ è§’è‰²å±æ€§æ•°æ®ç»“æ„


### 3.1 è§’è‰²åŸºç¡€è¡¨


**ğŸ”¸ è§’è‰²åŸºæœ¬ä¿¡æ¯**
```sql
CREATE TABLE characters (
    character_id BIGINT AUTO_INCREMENT PRIMARY KEY,
    player_id BIGINT NOT NULL,
    
    -- è§’è‰²åŸºç¡€ä¿¡æ¯
    character_name VARCHAR(50) NOT NULL,
    class_id INT NOT NULL, -- èŒä¸šID
    level INT DEFAULT 1,
    experience BIGINT DEFAULT 0,
    
    -- åŸºç¡€å±æ€§
    strength INT DEFAULT 10, -- åŠ›é‡
    agility INT DEFAULT 10, -- æ•æ·
    intelligence INT DEFAULT 10, -- æ™ºåŠ›
    vitality INT DEFAULT 10, -- ä½“åŠ›
    
    -- èµ„æºæ•°æ®
    hp INT DEFAULT 100, -- å½“å‰è¡€é‡
    max_hp INT DEFAULT 100, -- æœ€å¤§è¡€é‡
    mp INT DEFAULT 50, -- å½“å‰é­”æ³•
    max_mp INT DEFAULT 50, -- æœ€å¤§é­”æ³•
    
    -- ä½ç½®ä¿¡æ¯
    map_id INT DEFAULT 1001, -- åœ°å›¾ID
    position_x FLOAT DEFAULT 0, -- Xåæ ‡
    position_y FLOAT DEFAULT 0, -- Yåæ ‡
    position_z FLOAT DEFAULT 0, -- Zåæ ‡
    
    -- çŠ¶æ€
    is_online TINYINT DEFAULT 0,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    -- ç´¢å¼•
    INDEX idx_player_id (player_id),
    INDEX idx_level (level),
    INDEX idx_map_id (map_id),
    FOREIGN KEY (player_id) REFERENCES players(player_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

**ğŸ’¡ å±æ€§è®¾è®¡æ€è·¯**
```
åŸºç¡€å±æ€§ï¼šåŠ›é‡ã€æ•æ·ã€æ™ºåŠ›ã€ä½“åŠ›
æ´¾ç”Ÿå±æ€§ï¼šè¡€é‡ã€é­”æ³•å€¼ç­‰ä»åŸºç¡€å±æ€§è®¡ç®—å¾—å‡º
å®æ—¶å±æ€§ï¼šå½“å‰è¡€é‡ã€é­”æ³•å€¼ç­‰ä¼šé¢‘ç¹å˜åŒ–
é™æ€å±æ€§ï¼šç­‰çº§ã€ç»éªŒç­‰å˜åŒ–è¾ƒå°‘
```

### 3.2 è§’è‰²æ•°æ®ç‰ˆæœ¬ç®¡ç†


**ğŸ”¸ ç‰ˆæœ¬ç®¡ç†è¡¨**
```sql
CREATE TABLE character_versions (
    version_id BIGINT AUTO_INCREMENT PRIMARY KEY,
    character_id BIGINT NOT NULL,
    
    -- ç‰ˆæœ¬ä¿¡æ¯
    version_number INT NOT NULL,
    version_data JSON NOT NULL, -- å®Œæ•´çš„è§’è‰²æ•°æ®å¿«ç…§
    change_reason VARCHAR(100), -- å˜æ›´åŸå› 
    
    -- æ—¶é—´æˆ³
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    
    -- ç´¢å¼•
    INDEX idx_character_id (character_id),
    INDEX idx_version_number (character_id, version_number),
    FOREIGN KEY (character_id) REFERENCES characters(character_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

**ğŸ“ ç‰ˆæœ¬ç®¡ç†çš„ä½œç”¨**
```
æ•°æ®å›æ»šï¼šå‡ºç°é—®é¢˜æ—¶å¯ä»¥æ¢å¤åˆ°ä¹‹å‰çŠ¶æ€
å˜æ›´è¿½è¸ªï¼šè®°å½•è§’è‰²æ•°æ®çš„æ‰€æœ‰é‡è¦å˜åŒ–
å®¡è®¡éœ€æ±‚ï¼šæ¸¸æˆè¿è¥éœ€è¦äº†è§£è§’è‰²æˆé•¿è¿‡ç¨‹
é˜²ä½œå¼Šï¼šæ£€æµ‹å¼‚å¸¸çš„å±æ€§å˜åŒ–
```

---

## 4. ğŸ¯ æ¸¸æˆè¿›åº¦ä¸çŠ¶æ€ç®¡ç†


### 4.1 ä»»åŠ¡è¿›åº¦è¡¨


**ğŸ”¸ ä»»åŠ¡ç³»ç»Ÿè®¾è®¡**
```sql
CREATE TABLE player_quests (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    player_id BIGINT NOT NULL,
    character_id BIGINT NOT NULL,
    quest_id INT NOT NULL, -- ä»»åŠ¡é…ç½®ID
    
    -- è¿›åº¦ä¿¡æ¯
    status TINYINT DEFAULT 0, -- 0æœªæ¥ 1è¿›è¡Œä¸­ 2å·²å®Œæˆ 3å·²æäº¤
    progress JSON, -- ä»»åŠ¡è¿›åº¦è¯¦æƒ…
    start_time DATETIME,
    complete_time DATETIME,
    
    -- å¥–åŠ±ä¿¡æ¯
    rewards_claimed TINYINT DEFAULT 0, -- æ˜¯å¦å·²é¢†å–å¥–åŠ±
    
    INDEX idx_player_quest (player_id, quest_id),
    INDEX idx_character_id (character_id),
    FOREIGN KEY (player_id) REFERENCES players(player_id) ON DELETE CASCADE,
    FOREIGN KEY (character_id) REFERENCES characters(character_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

**ğŸ’¡ è¿›åº¦æ•°æ®ç¤ºä¾‹**
```json
{
    "kill_monsters": {
        "target": 10,
        "current": 3,
        "monster_types": ["goblin", "orc"]
    },
    "collect_items": {
        "target": 5,
        "current": 2,
        "item_id": 1001
    }
}
```

### 4.2 æˆå°±ç³»ç»Ÿ


**ğŸ”¸ æˆå°±æ•°æ®ç»“æ„**
```sql
CREATE TABLE player_achievements (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    player_id BIGINT NOT NULL,
    achievement_id INT NOT NULL,
    
    -- è¿›åº¦ä¿¡æ¯
    progress_value INT DEFAULT 0, -- å½“å‰è¿›åº¦å€¼
    target_value INT NOT NULL, -- ç›®æ ‡è¿›åº¦å€¼
    is_completed TINYINT DEFAULT 0,
    completed_at DATETIME,
    
    -- å¥–åŠ±ä¿¡æ¯
    rewards_claimed TINYINT DEFAULT 0,
    
    UNIQUE KEY uk_player_achievement (player_id, achievement_id),
    INDEX idx_completed (is_completed, completed_at),
    FOREIGN KEY (player_id) REFERENCES players(player_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

---

## 5. ğŸ’ è£…å¤‡é“å…·æ•°æ®æ¨¡å‹


### 5.1 ç‰©å“èƒŒåŒ…ç³»ç»Ÿ


**ğŸ”¸ èƒŒåŒ…ç‰©å“è¡¨**
```sql
CREATE TABLE player_items (
    item_uuid VARCHAR(36) PRIMARY KEY, -- ç‰©å“å”¯ä¸€æ ‡è¯†
    player_id BIGINT NOT NULL,
    character_id BIGINT,
    
    -- ç‰©å“ä¿¡æ¯
    item_template_id INT NOT NULL, -- ç‰©å“æ¨¡æ¿ID
    quantity INT DEFAULT 1, -- æ•°é‡
    
    -- è£…å¤‡å±æ€§ï¼ˆå¦‚æœæ˜¯è£…å¤‡ï¼‰
    attributes JSON, -- è£…å¤‡å±æ€§åŠ æˆ
    enchant_level INT DEFAULT 0, -- å¼ºåŒ–ç­‰çº§
    gem_slots JSON, -- å®çŸ³æ’æ§½
    
    -- å­˜å‚¨ä½ç½®
    storage_type TINYINT DEFAULT 1, -- 1èƒŒåŒ… 2ä»“åº“ 3è£…å¤‡æ 
    slot_index INT, -- æ§½ä½ç´¢å¼•
    
    -- çŠ¶æ€
    is_bound TINYINT DEFAULT 0, -- æ˜¯å¦ç»‘å®š
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_player_id (player_id),
    INDEX idx_character_id (character_id),
    INDEX idx_template_id (item_template_id),
    FOREIGN KEY (player_id) REFERENCES players(player_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

**ğŸ’¡ ç‰©å“å±æ€§ç¤ºä¾‹**
```json
{
    "strength": 15,
    "agility": 8,
    "durability": {
        "current": 95,
        "max": 100
    },
    "special_effects": [
        {
            "type": "critical_rate",
            "value": 5
        }
    ]
}
```

### 5.2 è£…å¤‡æ ç®¡ç†


**ğŸ”¸ è£…å¤‡é…ç½®è¡¨**
```sql
CREATE TABLE character_equipment (
    character_id BIGINT PRIMARY KEY,
    
    -- è£…å¤‡æ§½ä½ï¼ˆå­˜å‚¨ç‰©å“UUIDï¼‰
    helmet VARCHAR(36), -- å¤´ç›”
    armor VARCHAR(36), -- æŠ¤ç”²
    weapon VARCHAR(36), -- æ­¦å™¨
    shield VARCHAR(36), -- ç›¾ç‰Œ
    boots VARCHAR(36), -- é‹å­
    gloves VARCHAR(36), -- æ‰‹å¥—
    ring1 VARCHAR(36), -- æˆ’æŒ‡1
    ring2 VARCHAR(36), -- æˆ’æŒ‡2
    necklace VARCHAR(36), -- é¡¹é“¾
    
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (character_id) REFERENCES characters(character_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

---

## 6. ğŸŒŸ æŠ€èƒ½å¤©èµ‹æ ‘è®¾è®¡


### 6.1 æŠ€èƒ½å­¦ä¹ è¡¨


**ğŸ”¸ å·²å­¦æŠ€èƒ½è®°å½•**
```sql
CREATE TABLE character_skills (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    character_id BIGINT NOT NULL,
    skill_id INT NOT NULL, -- æŠ€èƒ½é…ç½®ID
    
    -- æŠ€èƒ½ä¿¡æ¯
    skill_level INT DEFAULT 1, -- æŠ€èƒ½ç­‰çº§
    experience INT DEFAULT 0, -- æŠ€èƒ½ç»éªŒ
    
    -- å­¦ä¹ ä¿¡æ¯
    learned_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    last_used DATETIME,
    
    UNIQUE KEY uk_character_skill (character_id, skill_id),
    INDEX idx_skill_level (skill_level),
    FOREIGN KEY (character_id) REFERENCES characters(character_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

### 6.2 å¤©èµ‹ç‚¹åˆ†é…


**ğŸ”¸ å¤©èµ‹ç³»ç»Ÿè¡¨**
```sql
CREATE TABLE character_talents (
    character_id BIGINT NOT NULL,
    talent_tree_id INT NOT NULL, -- å¤©èµ‹æ ‘ID
    
    -- å¤©èµ‹ç‚¹ä¿¡æ¯
    talent_points JSON, -- å„å¤©èµ‹èŠ‚ç‚¹çš„ç‚¹æ•°åˆ†é…
    total_points INT DEFAULT 0, -- æ€»åˆ†é…ç‚¹æ•°
    available_points INT DEFAULT 0, -- å¯ç”¨ç‚¹æ•°
    
    -- æ—¶é—´è®°å½•
    last_reset_time DATETIME, -- ä¸Šæ¬¡é‡ç½®æ—¶é—´
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    PRIMARY KEY (character_id, talent_tree_id),
    FOREIGN KEY (character_id) REFERENCES characters(character_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

**ğŸ’¡ å¤©èµ‹ç‚¹æ•°æ®æ ¼å¼**
```json
{
    "node_1001": 5, // å¤©èµ‹èŠ‚ç‚¹ID: æŠ•å…¥ç‚¹æ•°
    "node_1002": 3,
    "node_1003": 1
}
```

---

## 7. ğŸ“Š ç©å®¶ç»Ÿè®¡æ•°æ®


### 7.1 ç©å®¶è¡Œä¸ºç»Ÿè®¡


**ğŸ”¸ è¡Œä¸ºæ•°æ®è¡¨**
```sql
CREATE TABLE player_statistics (
    player_id BIGINT PRIMARY KEY,
    
    -- åŸºç¡€ç»Ÿè®¡
    total_login_count INT DEFAULT 0, -- æ€»ç™»å½•æ¬¡æ•°
    total_online_time INT DEFAULT 0, -- æ€»åœ¨çº¿æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
    total_battles INT DEFAULT 0, -- æ€»æˆ˜æ–—æ¬¡æ•°
    total_deaths INT DEFAULT 0, -- æ€»æ­»äº¡æ¬¡æ•°
    
    -- ç»æµç»Ÿè®¡
    total_gold_earned BIGINT DEFAULT 0, -- æ€»è·å¾—é‡‘å¸
    total_gold_spent BIGINT DEFAULT 0, -- æ€»èŠ±è´¹é‡‘å¸
    total_items_obtained INT DEFAULT 0, -- æ€»è·å¾—ç‰©å“æ•°
    
    -- ç¤¾äº¤ç»Ÿè®¡
    friends_count INT DEFAULT 0, -- å¥½å‹æ•°é‡
    guild_id BIGINT, -- æ‰€åœ¨å…¬ä¼šID
    
    -- æœ€åæ›´æ–°æ—¶é—´
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (player_id) REFERENCES players(player_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

### 7.2 ç©å®¶è¡Œä¸ºåºåˆ—å­˜å‚¨


**ğŸ”¸ è¡Œä¸ºæ—¥å¿—è¡¨**
```sql
CREATE TABLE player_behavior_logs (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    player_id BIGINT NOT NULL,
    character_id BIGINT,
    
    -- è¡Œä¸ºä¿¡æ¯
    action_type VARCHAR(50) NOT NULL, -- è¡Œä¸ºç±»å‹
    action_data JSON, -- è¡Œä¸ºè¯¦ç»†æ•°æ®
    
    -- ä¸Šä¸‹æ–‡ä¿¡æ¯
    session_id VARCHAR(64), -- ä¼šè¯ID
    ip_address VARCHAR(45),
    user_agent VARCHAR(255),
    
    -- æ—¶é—´æˆ³
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    
    INDEX idx_player_action (player_id, action_type),
    INDEX idx_created_at (created_at),
    INDEX idx_session_id (session_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 
PARTITION BY RANGE (TO_DAYS(created_at)) (
    PARTITION p_before_2025 VALUES LESS THAN (TO_DAYS('2025-01-01')),
    PARTITION p_2025_q1 VALUES LESS THAN (TO_DAYS('2025-04-01')),
    PARTITION p_2025_q2 VALUES LESS THAN (TO_DAYS('2025-07-01')),
    PARTITION p_2025_q3 VALUES LESS THAN (TO_DAYS('2025-10-01')),
    PARTITION p_2025_q4 VALUES LESS THAN (TO_DAYS('2026-01-01'))
);
```

---

## 8. ğŸš€ é«˜çº§æ•°æ®æ¶æ„è®¾è®¡


### 8.1 ç©å®¶æ•°æ®åˆ†ç‰‡ï¼ˆPlayer Data Shardingï¼‰


**ğŸ”¸ åˆ†ç‰‡ç­–ç•¥**
```
æŒ‰ç©å®¶IDå“ˆå¸Œåˆ†ç‰‡ï¼š
shard_key = player_id % shard_count

ç¤ºä¾‹ï¼š10ä¸ªåˆ†ç‰‡
player_id = 12345
shard_index = 12345 % 10 = 5
æ•°æ®å­˜å‚¨åœ¨ shard_5 ä¸­
```

**ğŸ“Š åˆ†ç‰‡æ¶æ„å›¾**
```
åº”ç”¨å±‚
    â†“
è·¯ç”±å±‚ï¼ˆSharding Proxyï¼‰
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Shard0  â”‚ Shard1  â”‚ Shard2  â”‚ Shard3  â”‚
â”‚ 0,4,8.. â”‚ 1,5,9.. â”‚ 2,6,10..â”‚ 3,7,11..â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ’» åˆ†ç‰‡è·¯ç”±ä»£ç **
```java
public class PlayerDataRouter {
    private final int shardCount = 10;
    
    public String getShardKey(Long playerId) {
        int shardIndex = (int) (playerId % shardCount);
        return "player_shard_" + shardIndex;
    }
    
    public DataSource getDataSource(Long playerId) {
        String shardKey = getShardKey(playerId);
        return dataSourceMap.get(shardKey);
    }
}
```

### 8.2 ç©å®¶æ•°æ®ç¼“å­˜ç­–ç•¥


**ğŸ”¸ å¤šçº§ç¼“å­˜æ¶æ„**
```
æ¸¸æˆå®¢æˆ·ç«¯
    â†“
æœ¬åœ°ç¼“å­˜ï¼ˆLocal Cacheï¼‰- 1ç§’
    â†“
Redisç¼“å­˜ï¼ˆRemote Cacheï¼‰- 10åˆ†é’Ÿ  
    â†“
MySQLæ•°æ®åº“ï¼ˆDatabaseï¼‰- æŒä¹…åŒ–
```

**âš¡ ç¼“å­˜æ›´æ–°ç­–ç•¥**
```java
public class PlayerDataCache {
    
    // è¯»å–ç©å®¶æ•°æ®ï¼ˆç¼“å­˜ä¼˜å…ˆï¼‰
    public PlayerData getPlayerData(Long playerId) {
        // 1. å…ˆæŸ¥æœ¬åœ°ç¼“å­˜
        PlayerData data = localCache.get(playerId);
        if (data != null) return data;
        
        // 2. æŸ¥Redisç¼“å­˜
        data = redisCache.get("player:" + playerId);
        if (data != null) {
            localCache.put(playerId, data, 60); // æœ¬åœ°ç¼“å­˜1åˆ†é’Ÿ
            return data;
        }
        
        // 3. æŸ¥æ•°æ®åº“
        data = playerService.loadFromDatabase(playerId);
        if (data != null) {
            redisCache.set("player:" + playerId, data, 600); // Redisç¼“å­˜10åˆ†é’Ÿ
            localCache.put(playerId, data, 60);
        }
        
        return data;
    }
}
```

### 8.3 è·¨æœç©å®¶æ•°æ®åŒæ­¥


**ğŸ”¸ è·¨æœåŒæ­¥è¡¨**
```sql
CREATE TABLE cross_server_sync (
    sync_id BIGINT AUTO_INCREMENT PRIMARY KEY,
    player_id BIGINT NOT NULL,
    
    -- åŒæ­¥ä¿¡æ¯
    source_server VARCHAR(50) NOT NULL, -- æºæœåŠ¡å™¨
    target_server VARCHAR(50) NOT NULL, -- ç›®æ ‡æœåŠ¡å™¨
    sync_type TINYINT NOT NULL, -- 1åŸºç¡€ä¿¡æ¯ 2è§’è‰²æ•°æ® 3ç‰©å“æ•°æ®
    
    -- æ•°æ®å†…å®¹
    sync_data JSON NOT NULL, -- åŒæ­¥çš„æ•°æ®å†…å®¹
    
    -- çŠ¶æ€ç®¡ç†
    status TINYINT DEFAULT 0, -- 0å¾…åŒæ­¥ 1åŒæ­¥ä¸­ 2å·²å®Œæˆ 3å¤±è´¥
    retry_count INT DEFAULT 0, -- é‡è¯•æ¬¡æ•°
    
    -- æ—¶é—´æˆ³
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_player_server (player_id, target_server),
    INDEX idx_status (status),
    INDEX idx_created_at (created_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

### 8.4 ç©å®¶ç¤¾äº¤å…³ç³»å›¾


**ğŸ”¸ å¥½å‹å…³ç³»è¡¨**
```sql
CREATE TABLE player_friends (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    player_id BIGINT NOT NULL, -- å‘èµ·è€…
    friend_id BIGINT NOT NULL, -- è¢«æ·»åŠ è€…
    
    -- å…³ç³»çŠ¶æ€
    status TINYINT DEFAULT 0, -- 0å¾…ç¡®è®¤ 1å·²ç¡®è®¤ 2å·²æ‹’ç» 3å·²åˆ é™¤
    intimacy_level INT DEFAULT 0, -- äº²å¯†åº¦ç­‰çº§
    
    -- æ—¶é—´è®°å½•
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    confirmed_at DATETIME,
    
    UNIQUE KEY uk_player_friend (player_id, friend_id),
    INDEX idx_friend_id (friend_id),
    INDEX idx_status (status),
    FOREIGN KEY (player_id) REFERENCES players(player_id) ON DELETE CASCADE,
    FOREIGN KEY (friend_id) REFERENCES players(player_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

---

## 9. ğŸ›¡ï¸ æ•°æ®å®‰å…¨ä¸æ€§èƒ½ä¼˜åŒ–


### 9.1 ç©å®¶æ•°æ®å®‰å…¨é˜²æŠ¤


**ğŸ”¸ æ•æ„Ÿæ•°æ®åŠ å¯†**
```java
public class PlayerDataSecurity {
    
    // æ•æ„Ÿä¿¡æ¯åŠ å¯†å­˜å‚¨
    public void savePlayerSecureData(Long playerId, PlayerSecureData data) {
        // åŠ å¯†æ•æ„Ÿå­—æ®µ
        String encryptedPhone = encrypt(data.getPhone());
        String encryptedEmail = encrypt(data.getEmail());
        
        // å­˜å‚¨åˆ°æ•°æ®åº“
        PlayerSecureInfo info = new PlayerSecureInfo();
        info.setPlayerId(playerId);
        info.setEncryptedPhone(encryptedPhone);
        info.setEncryptedEmail(encryptedEmail);
        
        secureInfoRepository.save(info);
    }
    
    // æ•°æ®è®¿é—®æ—¥å¿—è®°å½•
    public void logDataAccess(Long playerId, String operation, String userAgent) {
        DataAccessLog log = new DataAccessLog();
        log.setPlayerId(playerId);
        log.setOperation(operation);
        log.setUserAgent(userAgent);
        log.setAccessTime(new Date());
        log.setIpAddress(getCurrentUserIP());
        
        accessLogRepository.save(log);
    }
}
```

### 9.2 è§’è‰²æ•°æ®å‹ç¼©ä¼˜åŒ–


**ğŸ”¸ æ•°æ®å‹ç¼©ç­–ç•¥**
```java
public class PlayerDataCompression {
    
    // å‹ç¼©ç©å®¶ç‰©å“æ•°æ®
    public byte[] compressItemData(List<PlayerItem> items) {
        try {
            // å°†å¯¹è±¡åºåˆ—åŒ–ä¸ºJSON
            String jsonData = JsonUtils.toJson(items);
            
            // ä½¿ç”¨GZIPå‹ç¼©
            ByteArrayOutputStream baos = new ByteArrayOutputStream();
            GZIPOutputStream gzipOut = new GZIPOutputStream(baos);
            gzipOut.write(jsonData.getBytes("UTF-8"));
            gzipOut.close();
            
            return baos.toByteArray();
        } catch (Exception e) {
            throw new RuntimeException("æ•°æ®å‹ç¼©å¤±è´¥", e);
        }
    }
    
    // è§£å‹æ•°æ®
    public List<PlayerItem> decompressItemData(byte[] compressedData) {
        // è§£å‹ç¼©é€»è¾‘...
        return items;
    }
}
```

### 9.3 å¤šç«¯æ•°æ®ä¸€è‡´æ€§


**ğŸ”¸ æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥**
```sql
-- åˆ›å»ºæ•°æ®ä¸€è‡´æ€§æ£€æŸ¥è¡¨
CREATE TABLE data_consistency_check (
    check_id BIGINT AUTO_INCREMENT PRIMARY KEY,
    player_id BIGINT NOT NULL,
    
    -- æ£€æŸ¥ç±»å‹
    check_type VARCHAR(50) NOT NULL, -- gold, items, levelç­‰
    
    -- å„ç«¯æ•°æ®
    client_value VARCHAR(255), -- å®¢æˆ·ç«¯æ•°æ®
    server_value VARCHAR(255), -- æœåŠ¡ç«¯æ•°æ®
    
    -- æ£€æŸ¥ç»“æœ
    is_consistent TINYINT DEFAULT 1, -- æ˜¯å¦ä¸€è‡´
    difference_detail JSON, -- å·®å¼‚è¯¦æƒ…
    
    -- å¤„ç†çŠ¶æ€
    status TINYINT DEFAULT 0, -- 0å¾…å¤„ç† 1å·²å¤„ç† 2å¿½ç•¥
    
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    
    INDEX idx_player_type (player_id, check_type),
    INDEX idx_consistent (is_consistent),
    INDEX idx_status (status)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ç©å®¶æ•°æ®åˆ†å±‚ï¼šåŸºç¡€ä¿¡æ¯ã€è§’è‰²æ•°æ®ã€æ¸¸æˆè¿›åº¦ã€ç»Ÿè®¡æ•°æ®
ğŸ”¸ æ•°æ®åº“è®¾è®¡åŸåˆ™ï¼šèŒƒå¼åŒ–å­˜å‚¨ã€åˆç†ç´¢å¼•ã€å¤–é”®çº¦æŸ
ğŸ”¸ JSONå­—æ®µåº”ç”¨ï¼šçµæ´»å­˜å‚¨å¤æ‚çš„æ¸¸æˆæ•°æ®
ğŸ”¸ åˆ†è¡¨ç­–ç•¥ï¼šæŒ‰åŠŸèƒ½åˆ†è¡¨ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡
ğŸ”¸ ç¼“å­˜æœºåˆ¶ï¼šå¤šçº§ç¼“å­˜ï¼Œå‡å°‘æ•°æ®åº“å‹åŠ›
ğŸ”¸ æ•°æ®å®‰å…¨ï¼šæ•æ„Ÿä¿¡æ¯åŠ å¯†ã€è®¿é—®æ—¥å¿—è®°å½•
```

### 10.2 å…³é”®è®¾è®¡æ€è·¯


**ğŸ”¹ æ•°æ®è¡¨è®¾è®¡åŸåˆ™**
```
ä¸»è¡¨å­˜æ ¸å¿ƒï¼šplayerè¡¨å­˜å‚¨æœ€é‡è¦çš„åŸºç¡€ä¿¡æ¯
æ‰©å±•è¡¨å­˜è¯¦æƒ…ï¼šprofileè¡¨å­˜å‚¨è¡¥å……ä¿¡æ¯
å…³ç³»è¡¨å­˜å…³è”ï¼šå¥½å‹ã€è£…å¤‡ç­‰å…³ç³»æ•°æ®
æ—¥å¿—è¡¨å­˜å†å²ï¼šè¡Œä¸ºè®°å½•ã€æ•°æ®å˜æ›´å†å²
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥**
```
åˆ†ç‰‡å­˜å‚¨ï¼šæŒ‰ç©å®¶IDåˆ†ç‰‡ï¼Œé¿å…å•è¡¨è¿‡å¤§
ç´¢å¼•ä¼˜åŒ–ï¼šä¸ºå¸¸ç”¨æŸ¥è¯¢æ¡ä»¶å»ºç«‹åˆé€‚ç´¢å¼•
ç¼“å­˜ç­–ç•¥ï¼šçƒ­ç‚¹æ•°æ®æ”¾å…¥Redisç¼“å­˜
æ•°æ®å‹ç¼©ï¼šå¤§æ•°æ®é‡å­—æ®µä½¿ç”¨å‹ç¼©å­˜å‚¨
```

**ğŸ”¹ æ•°æ®å®‰å…¨è€ƒè™‘**
```
æ•æ„ŸåŠ å¯†ï¼šæ‰‹æœºã€é‚®ç®±ç­‰æ•æ„Ÿä¿¡æ¯åŠ å¯†å­˜å‚¨
è®¿é—®æ§åˆ¶ï¼šè®°å½•æ•°æ®è®¿é—®æ—¥å¿—ï¼Œé˜²æ­¢æ»¥ç”¨
ç‰ˆæœ¬ç®¡ç†ï¼šé‡è¦æ•°æ®å˜æ›´ä¿ç•™å†å²ç‰ˆæœ¬
ä¸€è‡´æ€§æ£€æŸ¥ï¼šå®šæœŸæ£€æŸ¥å„ç«¯æ•°æ®ä¸€è‡´æ€§
```

### 10.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ ä¸šåŠ¡åœºæ™¯åº”ç”¨**
- **MMORPGæ¸¸æˆ**ï¼šå®Œæ•´çš„è§’è‰²æˆé•¿ã€è£…å¤‡ã€ç¤¾äº¤ç³»ç»Ÿ
- **å¡ç‰Œæ¸¸æˆ**ï¼šå¡ç‰Œæ”¶é›†ã€å¼ºåŒ–ã€æˆ˜æ–—è®°å½•
- **ç­–ç•¥æ¸¸æˆ**ï¼šå»ºç­‘ã€èµ„æºã€è”ç›Ÿæ•°æ®ç®¡ç†
- **ä¼‘é—²æ¸¸æˆ**ï¼šæˆå°±ã€æ’è¡Œæ¦œã€å¥½å‹äº’åŠ¨

**ğŸ”§ è¿è¥æ”¯æŒ**
- **æ•°æ®åˆ†æ**ï¼šç©å®¶è¡Œä¸ºåˆ†æã€æ¸¸æˆå¹³è¡¡è°ƒä¼˜
- **å®¢æœæ”¯æŒ**ï¼šç©å®¶æ•°æ®æŸ¥è¯¢ã€é—®é¢˜å®šä½
- **é˜²ä½œå¼Š**ï¼šå¼‚å¸¸æ•°æ®æ£€æµ‹ã€å›æ»šæœºåˆ¶
- **ç‰ˆæœ¬å‡çº§**ï¼šæ•°æ®è¿ç§»ã€å…¼å®¹æ€§å¤„ç†

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- ç©å®¶æ•°æ®è¦åˆ†å±‚ï¼ŒåŸºç¡€æ‰©å±•åˆ†å¼€å­˜
- è§’è‰²è£…å¤‡ç”¨å…³è”ï¼ŒæŠ€èƒ½å¤©èµ‹æ ‘çŠ¶è¿  
- ç¼“å­˜åˆ†ç‰‡ææ€§èƒ½ï¼Œå®‰å…¨åŠ å¯†é˜²æ³„æ¼
- ç‰ˆæœ¬ç®¡ç†èƒ½å›æ»šï¼Œè·¨æœåŒæ­¥è¦ä¸€è‡´