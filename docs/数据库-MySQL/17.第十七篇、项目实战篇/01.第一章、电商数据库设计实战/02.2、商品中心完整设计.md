---
title: 2、商品中心完整设计
---
## 📚 目录

1. [商品中心核心概念](#1-商品中心核心概念)
2. [商品基础数据模型](#2-商品基础数据模型)
3. [商品分类与属性设计](#3-商品分类与属性设计)
4. [商品价格与库存体系](#4-商品价格与库存体系)
5. [商品状态与生命周期](#5-商品状态与生命周期)
6. [商品关系与推荐设计](#6-商品关系与推荐设计)
7. [商品内容与多媒体](#7-商品内容与多媒体)
8. [商品搜索与索引优化](#8-商品搜索与索引优化)
9. [商品数据治理](#9-商品数据治理)
10. [高级特性与优化](#10-高级特性与优化)
11. [核心要点总结](#11-核心要点总结)

---

## 1. 🏪 商品中心核心概念


### 1.1 什么是商品中心


商品中心是电商系统的**数据核心**，它就像一个大型的商品信息仓库，统一管理着所有商品的信息。

**🔸 通俗理解**
```
想象一个超市的商品管理系统：
- 每个商品都有基本信息（名称、价格、描述）
- 每个商品都有不同规格（尺寸、颜色、型号）
- 每个商品都有分类（食品、服装、电器）
- 每个商品都有状态（上架、下架、缺货）

商品中心就是把这些信息用数据库系统管理起来
```

### 1.2 SPU和SKU的概念


**SPU（Standard Product Unit）**：标准产品单位，代表一个产品的抽象概念

**SKU（Stock Keeping Unit）**：库存保持单位，代表一个具体的商品

```
生活化理解：
SPU：iPhone 15（这是一个产品概念）
SKU：iPhone 15 128GB 蓝色（这是具体的商品）
     iPhone 15 256GB 黑色（这也是具体的商品）
     
一个SPU可以有多个SKU
```

**📊 SPU与SKU关系图**
```
         SPU: iPhone 15
              ↓
    ┌─────────┼─────────┐
    ↓         ↓         ↓
SKU1:     SKU2:     SKU3:
128GB     256GB     512GB
蓝色      黑色      白色
```

### 1.3 商品中心的核心价值


**🎯 统一数据源**
- 所有系统都从商品中心获取商品信息
- 避免不同系统间的数据不一致
- 便于统一管理和维护

**📈 业务支撑**
- 支持商品展示、搜索、下单等核心业务
- 提供商品数据分析基础
- 支持营销活动和价格策略

---

## 2. 🏗️ 商品基础数据模型


### 2.1 商品基础信息表设计


商品的基础信息就像是商品的"身份证"，包含了最核心的信息。

**📋 SPU基础信息表**
```sql
-- SPU表：商品标准单位
CREATE TABLE product_spu (
    spu_id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'SPU主键',
    spu_code VARCHAR(50) NOT NULL UNIQUE COMMENT 'SPU编码',
    spu_name VARCHAR(200) NOT NULL COMMENT '商品名称',
    brand_id INT NOT NULL COMMENT '品牌ID',
    category_id INT NOT NULL COMMENT '分类ID',
    description TEXT COMMENT '商品描述',
    keywords VARCHAR(500) COMMENT '搜索关键词',
    status TINYINT DEFAULT 1 COMMENT '状态：0-禁用 1-启用',
    creator_id BIGINT COMMENT '创建人',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_brand_category (brand_id, category_id),
    INDEX idx_status_create_time (status, create_time)
) COMMENT 'SPU商品表';
```

**🔸 字段说明**
- `spu_code`：商品编码，用于系统间交互，通常有规律（如：SPU202501001）
- `spu_name`：商品名称，面向用户展示
- `brand_id`：品牌关联，便于品牌筛选
- `category_id`：分类关联，便于分类管理
- `keywords`：搜索关键词，提升搜索体验

### 2.2 SKU详细信息表设计


SKU表存储具体的商品规格信息，每个SKU都对应一个可以售卖的商品。

**📋 SKU详细信息表**
```sql
-- SKU表：具体商品单位
CREATE TABLE product_sku (
    sku_id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'SKU主键',
    sku_code VARCHAR(50) NOT NULL UNIQUE COMMENT 'SKU编码',
    spu_id BIGINT NOT NULL COMMENT '关联SPU',
    sku_name VARCHAR(200) NOT NULL COMMENT 'SKU名称',
    
    -- 价格信息
    market_price DECIMAL(10,2) NOT NULL COMMENT '市场价',
    sale_price DECIMAL(10,2) NOT NULL COMMENT '销售价',
    cost_price DECIMAL(10,2) COMMENT '成本价',
    
    -- 规格信息
    spec_json JSON COMMENT '规格属性JSON',
    
    -- SKU特有属性
    weight DECIMAL(8,3) COMMENT '重量(kg)',
    volume DECIMAL(8,3) COMMENT '体积(立方米)',
    
    -- 状态控制
    status TINYINT DEFAULT 1 COMMENT '状态：0-禁用 1-启用',
    is_default TINYINT DEFAULT 0 COMMENT '是否默认SKU',
    
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (spu_id) REFERENCES product_spu(spu_id),
    INDEX idx_spu_id (spu_id),
    INDEX idx_status (status),
    INDEX idx_price_range (sale_price)
) COMMENT 'SKU商品表';
```

**🔸 规格属性JSON示例**
```json
{
  "color": "蓝色",
  "storage": "128GB",
  "version": "标准版",
  "warranty": "1年"
}
```

### 2.3 商品变体管理


商品变体是指同一个商品的不同规格组合，需要灵活的数据结构来支持。

**📊 商品变体关系图**
```
SPU: 连衣裙
    ├── 规格维度1: 颜色 [红色, 蓝色, 黑色]
    ├── 规格维度2: 尺码 [S, M, L, XL]
    └── 生成SKU: 3×4 = 12个SKU组合

实际SKU:
- 连衣裙-红色-S
- 连衣裙-红色-M  
- 连衣裙-蓝色-S
- ...
```

**📋 规格维度管理表**
```sql
-- 规格名称表（颜色、尺寸、版本等）
CREATE TABLE spec_group (
    group_id INT PRIMARY KEY AUTO_INCREMENT,
    group_name VARCHAR(50) NOT NULL COMMENT '规格组名称',
    sort_order INT DEFAULT 0 COMMENT '排序',
    status TINYINT DEFAULT 1
) COMMENT '商品规格组表';

-- 规格值表（红色、L码、128GB等）
CREATE TABLE spec_value (
    value_id INT PRIMARY KEY AUTO_INCREMENT,
    group_id INT NOT NULL COMMENT '所属规格组',
    value_name VARCHAR(50) NOT NULL COMMENT '规格值名称',
    sort_order INT DEFAULT 0,
    FOREIGN KEY (group_id) REFERENCES spec_group(group_id)
) COMMENT '商品规格值表';

-- SPU关联的规格组
CREATE TABLE spu_spec_group (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    spu_id BIGINT NOT NULL,
    group_id INT NOT NULL,
    FOREIGN KEY (spu_id) REFERENCES product_spu(spu_id),
    FOREIGN KEY (group_id) REFERENCES spec_group(group_id),
    UNIQUE KEY uk_spu_group (spu_id, group_id)
) COMMENT 'SPU规格组关联表';
```

---

## 3. 🗂️ 商品分类与属性设计


### 3.1 商品分类树形结构


商品分类采用树形结构，支持无限级分类，就像文件夹的层级结构。

**🌳 分类结构示例**
```
电子产品
├── 手机数码
│   ├── 手机
│   │   ├── 苹果手机
│   │   ├── 华为手机
│   │   └── 小米手机
│   └── 配件
│       ├── 手机壳
│       └── 充电器
└── 电脑办公
    ├── 笔记本电脑
    └── 台式机
```

**📋 商品分类表设计**
```sql
CREATE TABLE product_category (
    category_id INT PRIMARY KEY AUTO_INCREMENT COMMENT '分类ID',
    category_name VARCHAR(100) NOT NULL COMMENT '分类名称',
    parent_id INT DEFAULT 0 COMMENT '父分类ID，0为顶级分类',
    level TINYINT DEFAULT 1 COMMENT '分类层级',
    sort_order INT DEFAULT 0 COMMENT '排序权重',
    category_path VARCHAR(500) COMMENT '分类路径，如：1,2,5',
    is_leaf TINYINT DEFAULT 1 COMMENT '是否叶子节点',
    status TINYINT DEFAULT 1 COMMENT '状态：0-禁用 1-启用',
    
    -- SEO优化字段
    seo_title VARCHAR(200) COMMENT 'SEO标题',
    seo_keywords VARCHAR(500) COMMENT 'SEO关键词',
    seo_description TEXT COMMENT 'SEO描述',
    
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_parent_id (parent_id),
    INDEX idx_path (category_path),
    INDEX idx_level_sort (level, sort_order)
) COMMENT '商品分类表';
```

**🔧 分类路径说明**
```
category_path字段存储从根到当前节点的完整路径：
- 顶级分类：path = "1"
- 二级分类：path = "1,2" 
- 三级分类：path = "1,2,5"

这样设计的好处：
✅ 快速查询某分类下的所有子分类
✅ 快速获取分类的完整层级路径
✅ 避免递归查询的性能问题
```

### 3.2 商品属性动态扩展


不同分类的商品需要不同的属性，比如手机需要存储容量、屏幕尺寸，而服装需要材质、季节等。

**📊 属性扩展架构**
```
分类属性模板
    ↓
┌─────────────────────────────────────┐
│ 手机分类                             │
│ ├── 基础属性: 品牌、型号、颜色        │
│ ├── 技术属性: CPU、内存、存储容量     │
│ ├── 外观属性: 尺寸、重量、材质        │
│ └── 功能属性: 摄像头、电池容量        │
└─────────────────────────────────────┘
    ↓
应用到具体商品
    ↓
iPhone 15具体属性值
```

**📋 分类属性模板表**
```sql
-- 属性定义表
CREATE TABLE product_attribute (
    attr_id INT PRIMARY KEY AUTO_INCREMENT,
    attr_name VARCHAR(100) NOT NULL COMMENT '属性名称',
    attr_type ENUM('text', 'number', 'select', 'multi_select', 'boolean') COMMENT '属性类型',
    is_required TINYINT DEFAULT 0 COMMENT '是否必填',
    is_searchable TINYINT DEFAULT 0 COMMENT '是否可搜索',
    is_comparable TINYINT DEFAULT 0 COMMENT '是否可对比',
    sort_order INT DEFAULT 0,
    status TINYINT DEFAULT 1
) COMMENT '商品属性定义表';

-- 分类属性关联表
CREATE TABLE category_attribute (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    category_id INT NOT NULL COMMENT '分类ID',
    attr_id INT NOT NULL COMMENT '属性ID',
    is_required TINYINT DEFAULT 0 COMMENT '该分类下是否必填',
    default_value VARCHAR(200) COMMENT '默认值',
    sort_order INT DEFAULT 0,
    FOREIGN KEY (category_id) REFERENCES product_category(category_id),
    FOREIGN KEY (attr_id) REFERENCES product_attribute(attr_id),
    UNIQUE KEY uk_category_attr (category_id, attr_id)
) COMMENT '分类属性关联表';

-- 商品属性值表
CREATE TABLE product_attribute_value (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    spu_id BIGINT NOT NULL COMMENT 'SPU ID',
    attr_id INT NOT NULL COMMENT '属性ID',
    attr_value TEXT COMMENT '属性值',
    FOREIGN KEY (spu_id) REFERENCES product_spu(spu_id),
    FOREIGN KEY (attr_id) REFERENCES product_attribute(attr_id),
    UNIQUE KEY uk_spu_attr (spu_id, attr_id),
    INDEX idx_attr_value (attr_id, attr_value(100))
) COMMENT '商品属性值表';
```

---

## 4. 💰 商品价格与库存体系


### 4.1 商品价格体系设计


电商价格体系比较复杂，需要支持多种价格类型和价格策略。

**🔸 价格类型说明**
```
市场价：官方指导价，用于显示"原价"
销售价：实际售价，用户实际支付价格
成本价：采购成本，用于利润计算
会员价：会员专享价格
促销价：活动期间的特价
```

**📋 价格历史追踪表**
```sql
CREATE TABLE product_price_history (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    sku_id BIGINT NOT NULL COMMENT 'SKU ID',
    price_type ENUM('market', 'sale', 'cost', 'vip', 'promotion') COMMENT '价格类型',
    old_price DECIMAL(10,2) COMMENT '变更前价格',
    new_price DECIMAL(10,2) NOT NULL COMMENT '变更后价格',
    change_reason VARCHAR(200) COMMENT '变更原因',
    effective_time DATETIME COMMENT '生效时间',
    expire_time DATETIME COMMENT '失效时间',
    operator_id BIGINT COMMENT '操作人',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (sku_id) REFERENCES product_sku(sku_id),
    INDEX idx_sku_type_time (sku_id, price_type, effective_time)
) COMMENT '商品价格历史表';
```

**📊 动态定价策略**
```
基础定价 → 会员折扣 → 促销活动 → 优惠券 → 最终价格

价格计算流程：
1. 获取基础销售价
2. 应用会员等级折扣  
3. 应用限时促销折扣
4. 应用优惠券减免
5. 计算最终应付金额
```

### 4.2 库存关联设计


库存管理需要考虑多仓库、预占、安全库存等复杂场景。

**📋 库存主表设计**
```sql
CREATE TABLE product_stock (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    sku_id BIGINT NOT NULL COMMENT 'SKU ID',
    warehouse_id INT NOT NULL COMMENT '仓库ID',
    
    -- 库存数量
    total_stock INT DEFAULT 0 COMMENT '总库存',
    available_stock INT DEFAULT 0 COMMENT '可用库存',
    reserved_stock INT DEFAULT 0 COMMENT '预占库存',
    damaged_stock INT DEFAULT 0 COMMENT '损坏库存',
    
    -- 库存阈值
    safe_stock INT DEFAULT 0 COMMENT '安全库存',
    warning_stock INT DEFAULT 0 COMMENT '预警库存',
    
    -- 其他信息
    last_update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (sku_id) REFERENCES product_sku(sku_id),
    UNIQUE KEY uk_sku_warehouse (sku_id, warehouse_id),
    INDEX idx_available_stock (available_stock),
    INDEX idx_warning (warehouse_id, warning_stock)
) COMMENT '商品库存表';
```

**🔧 库存预警机制**
```sql
-- 库存预警阈值动态调整
CREATE TABLE stock_warning_config (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    sku_id BIGINT NOT NULL,
    warehouse_id INT NOT NULL,
    
    -- 动态阈值配置
    base_warning_stock INT DEFAULT 10 COMMENT '基础预警库存',
    sales_factor DECIMAL(5,2) DEFAULT 1.0 COMMENT '销量系数',
    season_factor DECIMAL(5,2) DEFAULT 1.0 COMMENT '季节系数',
    
    -- 计算后的实际预警值
    calculated_warning_stock INT COMMENT '计算后预警库存',
    
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    UNIQUE KEY uk_sku_warehouse (sku_id, warehouse_id)
) COMMENT '库存预警配置表';
```

**⚡ 热点商品数据处理**

热点商品需要特殊的缓存和数据库优化策略：

```sql
-- 热点商品识别表
CREATE TABLE hot_product (
    sku_id BIGINT PRIMARY KEY,
    hot_score INT DEFAULT 0 COMMENT '热度分数',
    view_count BIGINT DEFAULT 0 COMMENT '浏览次数',
    order_count INT DEFAULT 0 COMMENT '下单次数',
    last_active_time DATETIME COMMENT '最后活跃时间',
    
    -- 缓存策略配置
    cache_ttl INT DEFAULT 300 COMMENT '缓存TTL秒数',
    read_strategy ENUM('cache_first', 'db_first') DEFAULT 'cache_first',
    
    INDEX idx_hot_score (hot_score DESC),
    INDEX idx_last_active (last_active_time)
) COMMENT '热点商品表';
```

---

## 5. 🔄 商品状态与生命周期


### 5.1 商品状态管理


商品在电商平台上有完整的生命周期，每个阶段都有对应的状态。

**📊 商品生命周期状态图**
```
创建 → 待审核 → 审核中 → 上架 → 下架 → 停售 → 删除
 ↓       ↓        ↓      ↓     ↓     ↓      ↓
草稿   提交审核   人工审核  正常售卖  暂停  永久停售 逻辑删除

状态说明：
- 草稿(DRAFT): 商品信息不完整，仍在编辑中
- 待审核(PENDING): 提交审核，等待系统或人工审核
- 审核中(REVIEWING): 正在人工审核过程中  
- 上架(ONLINE): 正常销售状态，用户可见可购买
- 下架(OFFLINE): 暂时下架，用户不可见
- 停售(DISCONTINUED): 永久停售，不再销售
- 删除(DELETED): 逻辑删除，系统保留数据
```

**📋 商品状态表设计**
```sql
-- 商品状态配置表
CREATE TABLE product_status_config (
    status_code VARCHAR(20) PRIMARY KEY COMMENT '状态编码',
    status_name VARCHAR(50) NOT NULL COMMENT '状态名称',
    description TEXT COMMENT '状态描述',
    is_sellable TINYINT DEFAULT 0 COMMENT '是否可售卖',
    is_visible TINYINT DEFAULT 0 COMMENT '是否前台可见',
    sort_order INT DEFAULT 0
) COMMENT '商品状态配置表';

-- 商品状态变更日志
CREATE TABLE product_status_log (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    spu_id BIGINT NOT NULL COMMENT 'SPU ID',
    sku_id BIGINT COMMENT 'SKU ID，为空表示SPU级别变更',
    
    old_status VARCHAR(20) COMMENT '原状态',
    new_status VARCHAR(20) NOT NULL COMMENT '新状态',
    change_reason VARCHAR(500) COMMENT '变更原因',
    
    operator_id BIGINT COMMENT '操作人ID',
    operator_name VARCHAR(50) COMMENT '操作人姓名',
    
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    
    INDEX idx_spu_time (spu_id, create_time),
    INDEX idx_status (new_status, create_time)
) COMMENT '商品状态变更日志表';
```

### 5.2 商品审核工作流


商品上架需要经过审核流程，确保商品信息的准确性和合规性。

**🔄 审核流程设计**
```
商品提交
    ↓
系统自动审核（基础信息检查）
    ↓
人工审核（内容审核）
    ↓
审核结果
    ├── 通过 → 自动上架
    ├── 拒绝 → 返回修改
    └── 待补充 → 补充信息后重新审核
```

**📋 审核工作流表**
```sql
CREATE TABLE product_audit_flow (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    spu_id BIGINT NOT NULL COMMENT 'SPU ID',
    flow_no VARCHAR(50) NOT NULL COMMENT '流程编号',
    
    -- 审核信息
    audit_type ENUM('create', 'update', 'status_change') COMMENT '审核类型',
    current_step VARCHAR(50) COMMENT '当前步骤',
    audit_status ENUM('pending', 'processing', 'approved', 'rejected') DEFAULT 'pending',
    
    -- 提交信息
    submitter_id BIGINT COMMENT '提交人',
    submit_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    submit_data JSON COMMENT '提交的商品数据',
    
    -- 审核信息  
    auditor_id BIGINT COMMENT '审核人',
    audit_time DATETIME COMMENT '审核时间',
    audit_comment TEXT COMMENT '审核意见',
    
    INDEX idx_spu_status (spu_id, audit_status),
    INDEX idx_auditor_time (auditor_id, audit_time)
) COMMENT '商品审核流程表';
```

---

## 6. 🔗 商品关系与推荐设计


### 6.1 商品关系链设计


电商平台中，商品之间存在各种关系，如关联商品、替代商品、配件商品等。

**📊 商品关系类型**
```
商品A (主商品)
    ├── 配件商品 (手机 → 手机壳、充电器)
    ├── 关联商品 (洗发水 → 护发素)  
    ├── 替代商品 (同类产品的不同品牌)
    ├── 升级商品 (iPhone 14 → iPhone 15)
    └── 套装商品 (组合销售)
```

**📋 商品关系表设计**
```sql
CREATE TABLE product_relation (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    
    -- 关系双方
    source_spu_id BIGINT NOT NULL COMMENT '源商品SPU',
    target_spu_id BIGINT NOT NULL COMMENT '目标商品SPU',
    
    -- 关系类型
    relation_type ENUM(
        'accessory',     -- 配件
        'related',       -- 关联
        'alternative',   -- 替代  
        'upgrade',       -- 升级
        'bundle',        -- 套装
        'cross_sell',    -- 交叉销售
        'up_sell'        -- 向上销售
    ) NOT NULL COMMENT '关系类型',
    
    -- 关系属性
    relation_strength DECIMAL(3,2) DEFAULT 1.0 COMMENT '关系强度0-1',
    is_bidirectional TINYINT DEFAULT 0 COMMENT '是否双向关系',
    
    -- 展示控制
    display_order INT DEFAULT 0 COMMENT '显示顺序',
    is_active TINYINT DEFAULT 1 COMMENT '是否生效',
    
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (source_spu_id) REFERENCES product_spu(spu_id),
    FOREIGN KEY (target_spu_id) REFERENCES product_spu(spu_id),
    
    INDEX idx_source_type (source_spu_id, relation_type),
    INDEX idx_target_type (target_spu_id, relation_type),
    UNIQUE KEY uk_source_target_type (source_spu_id, target_spu_id, relation_type)
) COMMENT '商品关系表';
```

### 6.2 推荐商品算法支持


为了支持个性化推荐，需要收集和存储用户行为数据。

**📋 商品推荐权重表**
```sql
CREATE TABLE product_recommend_weight (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    spu_id BIGINT NOT NULL COMMENT 'SPU ID',
    
    -- 推荐权重因子
    view_score DECIMAL(8,2) DEFAULT 0 COMMENT '浏览分数',
    order_score DECIMAL(8,2) DEFAULT 0 COMMENT '购买分数', 
    rating_score DECIMAL(8,2) DEFAULT 0 COMMENT '评价分数',
    return_score DECIMAL(8,2) DEFAULT 0 COMMENT '退货分数(负分)',
    
    -- 综合权重
    total_weight DECIMAL(10,2) DEFAULT 0 COMMENT '总权重',
    category_rank INT COMMENT '分类内排名',
    global_rank INT COMMENT '全局排名',
    
    -- 更新时间
    last_calculate_time DATETIME COMMENT '最后计算时间',
    
    FOREIGN KEY (spu_id) REFERENCES product_spu(spu_id),
    INDEX idx_total_weight (total_weight DESC),
    INDEX idx_category_rank (category_rank)
) COMMENT '商品推荐权重表';
```

---

## 7. 📱 商品内容与多媒体


### 7.1 商品内容管理


商品需要丰富的内容展示，包括图片、视频、详情描述等。

**📊 商品内容结构**
```
商品内容
├── 基础信息 (标题、简介、卖点)
├── 多媒体资源
│   ├── 主图 (列表页展示)
│   ├── 轮播图 (详情页轮播)  
│   ├── 详情图 (详细介绍)
│   └── 视频 (演示视频)
├── 富文本详情 (HTML内容)
└── 规格参数 (结构化参数)
```

**📋 商品媒体资源表**
```sql
CREATE TABLE product_media (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    spu_id BIGINT NOT NULL COMMENT 'SPU ID',
    sku_id BIGINT COMMENT 'SKU ID，为空表示SPU级别',
    
    -- 媒体信息
    media_type ENUM('image', 'video', 'audio', 'document') NOT NULL,
    media_url VARCHAR(500) NOT NULL COMMENT '媒体URL',
    media_title VARCHAR(200) COMMENT '媒体标题',
    
    -- 分类用途
    usage_type ENUM('main', 'gallery', 'detail', 'spec', 'manual') NOT NULL COMMENT '用途类型',
    
    -- 显示控制
    sort_order INT DEFAULT 0 COMMENT '排序',
    is_active TINYINT DEFAULT 1 COMMENT '是否启用',
    
    -- 媒体属性
    file_size BIGINT COMMENT '文件大小(字节)',
    file_format VARCHAR(20) COMMENT '文件格式',
    width INT COMMENT '图片宽度',
    height INT COMMENT '图片高度',
    duration INT COMMENT '视频时长(秒)',
    
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (spu_id) REFERENCES product_spu(spu_id),
    INDEX idx_spu_usage_sort (spu_id, usage_type, sort_order),
    INDEX idx_sku_usage (sku_id, usage_type)
) COMMENT '商品媒体资源表';
```

### 7.2 富文本内容管理


商品详情通常使用富文本编辑器创建，需要支持HTML内容存储。

**📋 商品富文本内容表**
```sql
CREATE TABLE product_content (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    spu_id BIGINT NOT NULL COMMENT 'SPU ID',
    
    -- 内容类型
    content_type ENUM('description', 'specification', 'service', 'warranty') NOT NULL,
    
    -- 内容数据
    content_title VARCHAR(200) COMMENT '内容标题',
    content_html LONGTEXT COMMENT 'HTML内容',
    content_text TEXT COMMENT '纯文本内容(用于搜索)',
    
    -- 版本控制
    version VARCHAR(20) DEFAULT '1.0' COMMENT '内容版本',
    is_current TINYINT DEFAULT 1 COMMENT '是否当前版本',
    
    -- 审核状态
    audit_status ENUM('draft', 'pending', 'approved', 'rejected') DEFAULT 'draft',
    
    creator_id BIGINT COMMENT '创建者',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (spu_id) REFERENCES product_spu(spu_id),
    INDEX idx_spu_type (spu_id, content_type),
    INDEX idx_audit_status (audit_status)
) COMMENT '商品富文本内容表';
```

---

## 8. 🔍 商品搜索与索引优化


### 8.1 商品搜索优化


电商搜索是用户找到商品的主要方式，需要优化搜索体验和搜索结果的准确性。

**🔸 搜索权重计算公式**
```
商品搜索分数 = 基础分数 + 销量分数 + 评价分数 + 新品分数 + 促销分数

其中：
- 基础分数：根据标题、关键词匹配度
- 销量分数：根据销量数据计算
- 评价分数：根据用户评价计算  
- 新品分数：新上架商品的权重加成
- 促销分数：促销商品的权重加成
```

**📋 商品搜索权重表**
```sql
CREATE TABLE product_search_weight (
    spu_id BIGINT PRIMARY KEY,
    
    -- 基础权重
    title_weight DECIMAL(8,2) DEFAULT 0 COMMENT '标题权重',
    keyword_weight DECIMAL(8,2) DEFAULT 0 COMMENT '关键词权重',
    category_weight DECIMAL(8,2) DEFAULT 0 COMMENT '分类权重',
    
    -- 业务权重
    sales_weight DECIMAL(8,2) DEFAULT 0 COMMENT '销量权重',
    rating_weight DECIMAL(8,2) DEFAULT 0 COMMENT '评分权重',  
    price_weight DECIMAL(8,2) DEFAULT 0 COMMENT '价格权重',
    
    -- 运营权重
    promotion_weight DECIMAL(8,2) DEFAULT 0 COMMENT '促销权重',
    new_product_weight DECIMAL(8,2) DEFAULT 0 COMMENT '新品权重',
    manual_weight DECIMAL(8,2) DEFAULT 0 COMMENT '人工权重',
    
    -- 综合分数
    total_score DECIMAL(10,2) DEFAULT 0 COMMENT '总分数',
    
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (spu_id) REFERENCES product_spu(spu_id),
    INDEX idx_total_score (total_score DESC)
) COMMENT '商品搜索权重表';
```

### 8.2 标签体系设计


商品标签用于分类、搜索和推荐，是重要的数据维度。

**📊 标签分类体系**
```
商品标签
├── 系统标签 (自动生成)
│   ├── 分类标签 (手机、服装)
│   ├── 品牌标签 (苹果、华为)  
│   ├── 价格标签 (百元机、旗舰机)
│   └── 属性标签 (5G、防水)
├── 业务标签 (运营设置)
│   ├── 促销标签 (限时特价、新品)
│   ├── 品质标签 (精选、爆款)
│   └── 场景标签 (办公、游戏)
└── 用户标签 (用户生成)
    ├── 评价标签 (好用、性价比高)
    └── 自定义标签 (收藏夹分类)
```

**📋 商品标签系统表**
```sql
-- 标签定义表
CREATE TABLE product_tag (
    tag_id INT PRIMARY KEY AUTO_INCREMENT,
    tag_name VARCHAR(50) NOT NULL COMMENT '标签名称',
    tag_type ENUM('system', 'business', 'user') DEFAULT 'system' COMMENT '标签类型',
    tag_color VARCHAR(7) COMMENT '标签颜色',
    
    -- 标签属性
    is_searchable TINYINT DEFAULT 1 COMMENT '是否可搜索',
    is_filterable TINYINT DEFAULT 1 COMMENT '是否可筛选',
    weight INT DEFAULT 0 COMMENT '权重',
    
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    
    UNIQUE KEY uk_tag_name_type (tag_name, tag_type),
    INDEX idx_type_weight (tag_type, weight DESC)
) COMMENT '商品标签定义表';

-- 商品标签关联表  
CREATE TABLE product_tag_relation (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    spu_id BIGINT NOT NULL COMMENT 'SPU ID',
    tag_id INT NOT NULL COMMENT '标签ID',
    
    -- 关联属性
    confidence DECIMAL(3,2) DEFAULT 1.0 COMMENT '置信度',
    source ENUM('auto', 'manual', 'user') DEFAULT 'manual' COMMENT '来源',
    creator_id BIGINT COMMENT '创建者',
    
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (spu_id) REFERENCES product_spu(spu_id),
    FOREIGN KEY (tag_id) REFERENCES product_tag(tag_id),
    UNIQUE KEY uk_spu_tag (spu_id, tag_id),
    INDEX idx_tag_confidence (tag_id, confidence DESC)
) COMMENT '商品标签关联表';
```

---

## 9. 🏛️ 商品数据治理


### 9.1 商品主数据管理(MDM)


主数据管理确保商品信息的一致性、准确性和完整性。

**🔸 MDM核心原则**
```
统一性：同一商品在不同系统中的信息保持一致
权威性：建立唯一的主数据源
完整性：商品信息完整，无遗漏关键字段
准确性：商品信息真实可靠
及时性：商品信息更新及时同步
```

**📋 主数据版本控制表**
```sql
CREATE TABLE product_master_data (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    spu_id BIGINT NOT NULL COMMENT 'SPU ID',
    
    -- 版本信息
    version VARCHAR(20) NOT NULL COMMENT '版本号',
    is_current TINYINT DEFAULT 0 COMMENT '是否当前版本',
    
    -- 主数据内容
    master_data JSON NOT NULL COMMENT '主数据JSON',
    
    -- 数据质量
    completeness_score DECIMAL(5,2) COMMENT '完整性分数',
    accuracy_score DECIMAL(5,2) COMMENT '准确性分数', 
    consistency_score DECIMAL(5,2) COMMENT '一致性分数',
    total_quality_score DECIMAL(5,2) COMMENT '总质量分数',
    
    -- 变更信息
    change_type ENUM('create', 'update', 'merge', 'split') COMMENT '变更类型',
    change_reason VARCHAR(500) COMMENT '变更原因',
    
    creator_id BIGINT COMMENT '创建者',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (spu_id) REFERENCES product_spu(spu_id),
    INDEX idx_spu_version (spu_id, version),
    INDEX idx_current_version (spu_id, is_current)
) COMMENT '商品主数据管理表';
```

### 9.2 商品质量评分模型


通过数据质量评分，识别和改进商品信息质量。

**📊 质量评分维度**
```
商品质量评分 = 信息完整性 + 内容准确性 + 图片质量 + 用户反馈

信息完整性 (25分)：
├── 必填字段完整性 (10分)
├── 属性信息丰富度 (8分)
└── 规格信息完整性 (7分)

内容准确性 (25分)：  
├── 标题描述准确性 (10分)
├── 价格信息准确性 (8分)
└── 规格参数准确性 (7分)

图片质量 (25分)：
├── 主图质量 (10分)
├── 图片数量充足 (8分)  
└── 图片清晰度 (7分)

用户反馈 (25分)：
├── 用户评价分数 (15分)
└── 投诉举报情况 (10分)
```

**📋 商品质量评分表**
```sql
CREATE TABLE product_quality_score (
    spu_id BIGINT PRIMARY KEY,
    
    -- 各维度分数  
    info_completeness DECIMAL(5,2) DEFAULT 0 COMMENT '信息完整性分数',
    content_accuracy DECIMAL(5,2) DEFAULT 0 COMMENT '内容准确性分数',
    image_quality DECIMAL(5,2) DEFAULT 0 COMMENT '图片质量分数',
    user_feedback DECIMAL(5,2) DEFAULT 0 COMMENT '用户反馈分数',
    
    -- 综合分数
    total_score DECIMAL(5,2) DEFAULT 0 COMMENT '总分数',
    quality_level ENUM('A', 'B', 'C', 'D') COMMENT '质量等级',
    
    -- 评分详情
    score_detail JSON COMMENT '详细评分信息',
    
    -- 更新信息
    last_score_time DATETIME COMMENT '最后评分时间',
    score_version VARCHAR(20) COMMENT '评分版本',
    
    FOREIGN KEY (spu_id) REFERENCES product_spu(spu_id),
    INDEX idx_total_score (total_score DESC),
    INDEX idx_quality_level (quality_level, total_score DESC)
) COMMENT '商品质量评分表';
```

### 9.3 商品数据服务治理


通过服务化架构管理商品数据的读写访问。

**📊 数据服务架构**
```
应用层
├── 商品展示服务
├── 商品搜索服务
├── 商品管理服务
└── 商品推荐服务
    ↓
数据服务层  
├── 商品读服务 (查询优化)
├── 商品写服务 (事务管理)
├── 商品缓存服务 (性能优化)
└── 商品同步服务 (数据一致性)
    ↓
数据存储层
├── 主数据库 (事务数据)
├── 只读数据库 (查询优化)
├── 搜索引擎 (全文搜索)
└── 缓存系统 (高频访问)
```

---

## 10. 🚀 高级特性与优化


### 10.1 虚拟商品特殊处理


虚拟商品(如游戏点卡、会员卡)与实物商品有不同的处理逻辑。

**🔸 虚拟商品特点**
```
无需物流：不涉及库存、配送
即时交付：购买后立即可用
批量生成：可批量生成兑换码
有效期限：通常有使用期限
```

**📋 虚拟商品扩展表**
```sql
CREATE TABLE virtual_product_extend (
    spu_id BIGINT PRIMARY KEY,
    
    -- 虚拟商品类型
    virtual_type ENUM('digital_goods', 'service', 'membership', 'points') NOT NULL,
    
    -- 交付方式
    delivery_type ENUM('code', 'account', 'api', 'manual') DEFAULT 'code',
    delivery_template TEXT COMMENT '交付模板',
    
    -- 有效期设置
    validity_type ENUM('unlimited', 'fixed_days', 'fixed_date') DEFAULT 'unlimited',
    validity_days INT COMMENT '有效天数',
    validity_start_date DATE COMMENT '有效开始日期',
    validity_end_date DATE COMMENT '有效结束日期',
    
    -- 使用限制
    usage_limit INT DEFAULT 1 COMMENT '使用次数限制',
    concurrent_limit INT DEFAULT 1 COMMENT '并发使用限制',
    
    FOREIGN KEY (spu_id) REFERENCES product_spu(spu_id)
) COMMENT '虚拟商品扩展表';
```

### 10.2 多维属性索引优化策略


对于有大量属性的商品，需要优化索引策略提高查询性能。

**📊 索引优化策略**
```
属性查询场景分析：
├── 热门属性 (品牌、价格区间、颜色)
│   └── 建立联合索引
├── 范围查询属性 (价格、尺寸、重量)  
│   └── 建立B-tree索引
├── 多值属性 (标签、功能特性)
│   └── 使用全文索引
└── 组合查询 (品牌+价格+分类)
    └── 建立覆盖索引
```

**📋 属性索引优化配置**
```sql
CREATE TABLE product_index_config (
    id INT PRIMARY KEY AUTO_INCREMENT,
    attr_id INT NOT NULL COMMENT '属性ID',
    
    -- 索引配置
    index_type ENUM('btree', 'hash', 'fulltext', 'composite') NOT NULL,
    index_priority INT DEFAULT 0 COMMENT '索引优先级',
    
    -- 性能统计
    query_frequency BIGINT DEFAULT 0 COMMENT '查询频次',
    avg_query_time DECIMAL(8,3) COMMENT '平均查询时间',
    index_size BIGINT COMMENT '索引大小',
    
    -- 优化建议
    optimization_suggestion TEXT COMMENT '优化建议',
    
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (attr_id) REFERENCES product_attribute(attr_id),
    INDEX idx_priority_frequency (index_priority, query_frequency DESC)
) COMMENT '商品属性索引配置表';
```

### 10.3 商品微服务设计


将商品中心拆分为微服务架构，提高系统的可扩展性和维护性。

**📊 微服务拆分架构**
```
商品中心微服务架构
├── 商品基础服务
│   ├── SPU/SKU管理
│   ├── 商品分类管理  
│   └── 商品属性管理
├── 商品内容服务
│   ├── 商品详情管理
│   ├── 多媒体资源管理
│   └── 富文本内容管理
├── 商品价格服务
│   ├── 价格策略管理
│   ├── 促销价格管理
│   └── 价格历史管理
├── 商品库存服务
│   ├── 库存数量管理
│   ├── 库存预警管理
│   └── 库存预占管理
└── 商品搜索服务
    ├── 搜索索引管理
    ├── 搜索权重管理
    └── 搜索结果优化
```

---

## 11. 📋 核心要点总结


### 11.1 必须掌握的核心概念


```
🔸 SPU/SKU模型：商品数据结构的基础，理解抽象产品与具体商品的关系
🔸 分类树形结构：支持无限级分类，便于商品管理和导航
🔸 属性动态扩展：灵活的属性系统，支持不同分类的差异化属性
🔸 价格体系设计：多价格类型支持，价格历史追踪
🔸 库存关联管理：多仓库库存，安全库存，库存预警
🔸 商品生命周期：从创建到删除的完整状态管理
🔸 搜索优化策略：权重计算，标签体系，索引优化
```

### 11.2 关键设计原则


**🔹 数据一致性原则**
```
主数据管理：
- 建立权威数据源，避免数据冲突
- 版本控制机制，支持数据回滚
- 数据质量监控，持续优化数据质量

分层架构：
- 基础数据层：核心商品信息
- 扩展数据层：业务相关信息  
- 缓存数据层：性能优化数据
```

**🔹 性能优化原则**
```
读写分离：
- 主库负责写操作，从库负责读操作
- 缓存热点数据，减少数据库压力
- 异步处理非关键操作

索引优化：
- 根据查询场景设计索引
- 避免过多索引影响写性能
- 定期分析索引使用情况
```

**🔹 扩展性设计原则**
```
微服务架构：
- 按业务域拆分服务
- 服务间松耦合设计
- 独立部署和扩展

数据模型扩展：
- JSON字段支持灵活扩展
- 预留扩展字段
- 版本兼容性考虑
```

### 11.3 实际应用建议


**🎯 项目规模选择**
```
小型电商（< 1万商品）：
- 简化的SPU/SKU模型
- 基础的分类和属性
- 单机数据库足够

中型电商（1万-10万商品）：
- 完整的商品数据模型
- 搜索引擎集成
- 读写分离架构

大型电商（> 10万商品）：
- 微服务架构
- 分布式缓存
- 数据治理平台
```

**🔧 实施优先级**
```
第一阶段：基础功能
✅ SPU/SKU基础表结构
✅ 商品分类和属性
✅ 基础价格和库存
✅ 商品状态管理

第二阶段：业务增强  
✅ 商品关系和推荐
✅ 多媒体内容管理
✅ 搜索优化
✅ 审核工作流

第三阶段：高级特性
✅ 数据治理平台
✅ 质量评分模型
✅ 微服务架构
✅ 性能优化
```

**⚠️ 常见问题与解决方案**
```
问题1：SKU数量爆炸
解决：合理设计规格维度，避免无意义的SKU组合

问题2：属性扩展复杂
解决：使用JSON字段 + 索引优化，平衡灵活性和性能

问题3：数据一致性
解决：建立主数据管理机制，统一数据入口

问题4：搜索性能问题  
解决：使用专门的搜索引擎，优化索引策略

问题5：热点商品压力
解决：缓存策略 + 限流 + 降级方案
```

**核心记忆要点**：
- 商品中心是电商数据核心，SPU/SKU是基础模型
- 分层设计支持扩展，微服务架构支持大规模
- 数据质量和性能同等重要，需要持续优化
- 业务驱动技术选型，避免过度设计