---
title: 17ã€å¤šç²’åº¦å¹¶å‘æ§åˆ¶
---
## ğŸ“š ç›®å½•

1. [å¤šç²’åº¦å¹¶å‘æ§åˆ¶æ¦‚è¿°](#1-å¤šç²’åº¦å¹¶å‘æ§åˆ¶æ¦‚è¿°)
2. [ç²’åº¦å±‚æ¬¡ç»“æ„è¯¦è§£](#2-ç²’åº¦å±‚æ¬¡ç»“æ„è¯¦è§£)
3. [æ„å›¾é”åè®®è¯¦è§£](#3-æ„å›¾é”åè®®è¯¦è§£)
4. [å¤šçº§é”ç®¡ç†æœºåˆ¶](#4-å¤šçº§é”ç®¡ç†æœºåˆ¶)
5. [ç²’åº¦è½¬æ¢ç­–ç•¥](#5-ç²’åº¦è½¬æ¢ç­–ç•¥)
6. [å±‚æ¬¡åŒ–é”ä¼˜åŒ–](#6-å±‚æ¬¡åŒ–é”ä¼˜åŒ–)
7. [å¤šç²’åº¦æ§åˆ¶å®Œæ•´æœºåˆ¶](#7-å¤šç²’åº¦æ§åˆ¶å®Œæ•´æœºåˆ¶)
8. [ç²’åº¦ä¼˜åŒ–ç­–ç•¥](#8-ç²’åº¦ä¼˜åŒ–ç­–ç•¥)
9. [å¤šç²’åº¦æ€§èƒ½åˆ†æ](#9-å¤šç²’åº¦æ€§èƒ½åˆ†æ)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” å¤šç²’åº¦å¹¶å‘æ§åˆ¶æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯å¤šç²’åº¦å¹¶å‘æ§åˆ¶


**åŸºæœ¬å®šä¹‰**ï¼šå¤šç²’åº¦å¹¶å‘æ§åˆ¶æ˜¯ä¸€ç§å…è®¸åœ¨ä¸åŒç²’åº¦çº§åˆ«ï¼ˆæ•°æ®åº“ã€è¡¨ã€é¡µã€è¡Œï¼‰ä¸ŠåŠ é”çš„å¹¶å‘æ§åˆ¶æœºåˆ¶ï¼Œé€šè¿‡å±‚æ¬¡åŒ–çš„é”ç»“æ„æé«˜å¹¶å‘æ€§èƒ½ã€‚

```
å¤šç²’åº¦é”ç¤ºä¾‹ï¼š
æ•°æ®åº“çº§ï¼š      [DB Lock]
              /         \
è¡¨çº§ï¼š      [Table1]   [Table2]
           /      \         \
é¡µçº§ï¼š   [Page1]  [Page2]   [Page3]
        /    \      \         \
è¡Œçº§ï¼š [Row1] [Row2] [Row3]   [Row4]

é”ç²’åº¦ç‰¹ç‚¹ï¼š
â€¢ ç²’åº¦è¶Šå¤§ï¼šé”å®šèŒƒå›´è¶Šå¤§ï¼Œå¹¶å‘åº¦è¶Šä½ï¼Œå¼€é”€è¶Šå°
â€¢ ç²’åº¦è¶Šå°ï¼šé”å®šèŒƒå›´è¶Šå°ï¼Œå¹¶å‘åº¦è¶Šé«˜ï¼Œå¼€é”€è¶Šå¤§
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦å¤šç²’åº¦æ§åˆ¶


**å•ä¸€ç²’åº¦çš„é—®é¢˜**ï¼š
- **è¡Œé”**ï¼šå¹¶å‘åº¦é«˜ä½†é”ç®¡ç†å¼€é”€å¤§ï¼Œå¤§æ‰¹é‡æ“ä½œæ•ˆç‡ä½
- **è¡¨é”**ï¼šå¼€é”€å°ä½†å¹¶å‘åº¦ä½ï¼Œå½±å“ç³»ç»Ÿæ•´ä½“æ€§èƒ½

**å¤šç²’åº¦çš„ä¼˜åŠ¿**ï¼š
```
åº”ç”¨åœºæ™¯å¯¹æ¯”ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ“ä½œç±»å‹      æœ€é€‚é”ç²’åº¦    å¹¶å‘ç‰¹ç‚¹  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å•è¡Œæ›´æ–°      è¡Œé”          é«˜å¹¶å‘    â”‚
â”‚ æ‰¹é‡æ›´æ–°      é¡µé”/è¡¨é”     ä½å¼€é”€    â”‚
â”‚ è¡¨ç»“æ„ä¿®æ”¹    è¡¨é”          å®‰å…¨æ€§    â”‚
â”‚ æ•°æ®å¤‡ä»½      æ•°æ®åº“é”      ä¸€è‡´æ€§    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ğŸ—ï¸ ç²’åº¦å±‚æ¬¡ç»“æ„è¯¦è§£


### 2.1 é”ç²’åº¦å±‚æ¬¡æ¶æ„


**æ ‡å‡†å±‚æ¬¡ç»“æ„**ï¼šå¤šç²’åº¦é”é€šå¸¸é‡‡ç”¨æ ‘å½¢å±‚æ¬¡ç»“æ„ï¼Œä»ç²—ç²’åº¦åˆ°ç»†ç²’åº¦é€’è¿›ã€‚

```
MySQLé”ç²’åº¦å±‚æ¬¡ï¼š
           æ•°æ®åº“å®ä¾‹
               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”
        â”‚      â”‚      â”‚
       è¡¨A    è¡¨B    è¡¨C
        â”‚      â”‚      â”‚
    â”Œâ”€â”€â”€â”¼â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”¼â”€â”€â”€â”
    â”‚   â”‚   â”‚  â”‚  â”‚   â”‚   â”‚
   é¡µ1  é¡µ2  é¡µ3 é¡µ4 é¡µ5  é¡µ6  é¡µ7
    â”‚   â”‚   â”‚  â”‚  â”‚   â”‚   â”‚
   è¡Œ1  è¡Œ2  è¡Œ3 è¡Œ4 è¡Œ5  è¡Œ6  è¡Œ7

é”ç»§æ‰¿å…³ç³»ï¼š
â€¢ ä¸Šçº§é”å®šä¼šå½±å“æ‰€æœ‰ä¸‹çº§èµ„æº
â€¢ ä¸‹çº§é”å®šéœ€è¦æ£€æŸ¥ä¸Šçº§é”å…¼å®¹æ€§
â€¢ é”é‡Šæ”¾æŒ‰ä»ä¸‹åˆ°ä¸Šçš„é¡ºåºè¿›è¡Œ
```

### 2.2 å„å±‚æ¬¡çš„é”ç‰¹å¾


**æ•°æ®åº“çº§é”**ï¼š
```sql
-- æ•°æ®åº“çº§é”ç¤ºä¾‹
FLUSH TABLES WITH READ LOCK;  -- å…¨å±€è¯»é”
-- å½±å“æ•´ä¸ªæ•°æ®åº“å®ä¾‹çš„æ‰€æœ‰è¡¨
```

**è¡¨çº§é”**ï¼š
```sql
-- è¡¨çº§é”ç¤ºä¾‹
LOCK TABLES user_table READ;   -- è¡¨çº§è¯»é”
LOCK TABLES user_table WRITE;  -- è¡¨çº§å†™é”
```

**è¡Œçº§é”**ï¼šè¡Œçº§é”åœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­è‡ªåŠ¨è·å–ï¼Œç²’åº¦æœ€ç»†ï¼Œå¹¶å‘åº¦æœ€é«˜ã€‚

### 2.3 ç²’åº¦å±‚æ¬¡çš„ç®¡ç†è§„åˆ™


**å‘ä¸Šå…¼å®¹åŸåˆ™**ï¼šå­èŠ‚ç‚¹çš„é”å¿…é¡»ä¸çˆ¶èŠ‚ç‚¹çš„é”å…¼å®¹ã€‚

```java
// é”å±‚æ¬¡å…¼å®¹æ€§æ£€æŸ¥
public class LockHierarchyManager {
    public boolean canAcquireLock(Resource resource, LockType lockType) {
        // æ£€æŸ¥æ‰€æœ‰çˆ¶èŠ‚ç‚¹çš„é”çŠ¶æ€
        Resource parent = resource.getParent();
        while (parent != null) {
            if (!isCompatible(parent.getCurrentLock(), lockType)) {
                return false;
            }
            parent = parent.getParent();
        }
        return true;
    }
    
    private boolean isCompatible(LockType parentLock, LockType childLock) {
        // å®ç°å…·ä½“çš„å…¼å®¹æ€§è§„åˆ™
        return LockCompatibilityMatrix.isCompatible(parentLock, childLock);
    }
}
```

---

## 3. ğŸ¯ æ„å›¾é”åè®®è¯¦è§£


### 3.1 æ„å›¾é”çš„åŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯æ„å›¾é”**ï¼šæ„å›¾é”æ˜¯åœ¨å±‚æ¬¡ç»“æ„ä¸­ï¼Œä¸ºäº†åœ¨æŸä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹ä¸ŠåŠ é”è€Œåœ¨è¯¥èŠ‚ç‚¹ä¸ŠåŠ çš„é”ï¼Œç”¨äºè¡¨æ˜åŠ é”æ„å›¾ã€‚

```
æ„å›¾é”ç±»å‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é”ç±»å‹    ç¬¦å·    å«ä¹‰               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ„å›¾å…±äº«é”  IS    å‡†å¤‡åœ¨å­èŠ‚ç‚¹åŠ Sé”   â”‚
â”‚ æ„å›¾æ’ä»–é”  IX    å‡†å¤‡åœ¨å­èŠ‚ç‚¹åŠ Xé”   â”‚
â”‚ å…±äº«æ„å›¾æ’ä»– SIX  å½“å‰åŠ Sé”+å‡†å¤‡åŠ Xé” â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ„å›¾é”å·¥ä½œåŸç†ï¼š
è¦åœ¨è¡Œä¸ŠåŠ Xé” â†’ å¿…é¡»å…ˆåœ¨è¡¨ä¸ŠåŠ IXé” â†’ å¿…é¡»å…ˆåœ¨æ•°æ®åº“ä¸ŠåŠ IXé”
```

### 3.2 æ„å›¾é”å…¼å®¹æ€§çŸ©é˜µ


**é”å…¼å®¹æ€§è§„åˆ™**ï¼š
```
æ„å›¾é”å…¼å®¹æ€§çŸ©é˜µï¼š
      IS   IX   S    X    SIX
IS    âœ“    âœ“    âœ“    âœ—    âœ“
IX    âœ“    âœ“    âœ—    âœ—    âœ—  
S     âœ“    âœ—    âœ“    âœ—    âœ—
X     âœ—    âœ—    âœ—    âœ—    âœ—
SIX   âœ“    âœ—    âœ—    âœ—    âœ—

å…¼å®¹æ€§è§„åˆ™è§£é‡Šï¼š
â€¢ ISä¸æ‰€æœ‰é”ï¼ˆé™¤Xï¼‰å…¼å®¹ï¼šè¯»æ„å›¾ä¸å†²çª
â€¢ IXä¸ISã€IXå…¼å®¹ï¼šä¸åŒå­æ ‘çš„å†™æ“ä½œå¯å¹¶å‘
â€¢ Sä¸ISã€Så…¼å®¹ï¼šè¯»æ“ä½œä¹‹é—´ä¸å†²çª
â€¢ Xä¸ä»»ä½•é”éƒ½ä¸å…¼å®¹ï¼šå†™æ“ä½œéœ€è¦ç‹¬å 
```

### 3.3 æ„å›¾é”çš„åŠ é”åè®®


**è‡ªé¡¶å‘ä¸‹åŠ é”**ï¼šåœ¨èŠ‚ç‚¹ä¸ŠåŠ é”å‰ï¼Œå¿…é¡»å…ˆåœ¨å…¶çˆ¶èŠ‚ç‚¹ä¸ŠåŠ ç›¸åº”çš„æ„å›¾é”ã€‚

```java
// æ„å›¾é”åŠ é”å®ç°
public class IntentionLockManager {
    public boolean acquireRowLock(Table table, Row row, LockType lockType) {
        try {
            // 1. å…ˆåœ¨è¡¨ä¸ŠåŠ æ„å›¾é”
            IntentionLockType intentionLock = getIntentionLockType(lockType);
            if (!acquireTableIntentionLock(table, intentionLock)) {
                return false;
            }
            
            // 2. å†åœ¨è¡Œä¸ŠåŠ å®é™…é”
            return acquireActualRowLock(row, lockType);
            
        } catch (Exception e) {
            // åŠ é”å¤±è´¥ï¼Œé‡Šæ”¾å·²è·å¾—çš„é”
            releaseAcquiredLocks();
            return false;
        }
    }
    
    private IntentionLockType getIntentionLockType(LockType lockType) {
        return lockType == LockType.SHARED ? 
               IntentionLockType.IS : IntentionLockType.IX;
    }
}
```

**è‡ªåº•å‘ä¸Šé‡Šæ”¾**ï¼šé‡Šæ”¾é”æ—¶å¿…é¡»å…ˆé‡Šæ”¾å­èŠ‚ç‚¹çš„é”ï¼Œå†é‡Šæ”¾çˆ¶èŠ‚ç‚¹çš„æ„å›¾é”ã€‚

---

## 4. ğŸ”§ å¤šçº§é”ç®¡ç†æœºåˆ¶


### 4.1 é”ç®¡ç†å™¨æ¶æ„


**åˆ†å±‚é”ç®¡ç†å™¨**ï¼šä¸ºä¸åŒç²’åº¦å±‚æ¬¡è®¾è®¡ä¸“é—¨çš„é”ç®¡ç†ç»„ä»¶ã€‚

```
é”ç®¡ç†å™¨æ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          é”åè°ƒå™¨                    â”‚ â† ç»Ÿä¸€åè°ƒå„å±‚æ¬¡é”
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ•°æ®åº“é”ç®¡ç†å™¨ â”‚ è¡¨é”ç®¡ç†å™¨           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é¡µé”ç®¡ç†å™¨     â”‚ è¡Œé”ç®¡ç†å™¨           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          æ­»é”æ£€æµ‹å™¨                  â”‚ â† è·¨å±‚æ¬¡æ­»é”æ£€æµ‹
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å„ç»„ä»¶èŒè´£ï¼š
â€¢ é”åè°ƒå™¨ï¼šå¤„ç†è·¨å±‚æ¬¡çš„é”è¯·æ±‚å’Œå†²çª
â€¢ ä¸“é—¨ç®¡ç†å™¨ï¼šå¤„ç†ç‰¹å®šç²’åº¦çš„é”æ“ä½œ
â€¢ æ­»é”æ£€æµ‹å™¨ï¼šæ£€æµ‹å’Œè§£å†³å¤šå±‚æ¬¡æ­»é”
```

### 4.2 é”å‡çº§å’Œé™çº§æœºåˆ¶


**é”å‡çº§ï¼ˆLock Escalationï¼‰**ï¼šå½“ç»†ç²’åº¦é”æ•°é‡è¿‡å¤šæ—¶ï¼Œè‡ªåŠ¨è½¬æ¢ä¸ºç²—ç²’åº¦é”ã€‚

```java
// é”å‡çº§å®ç°
public class LockEscalationManager {
    private static final int ESCALATION_THRESHOLD = 1000;
    
    public void checkForEscalation(Table table) {
        int rowLockCount = getRowLockCount(table);
        
        // å½“è¡Œé”æ•°é‡è¶…è¿‡é˜ˆå€¼æ—¶è¿›è¡Œå‡çº§
        if (rowLockCount > ESCALATION_THRESHOLD) {
            escalateToTableLock(table);
        }
    }
    
    private void escalateToTableLock(Table table) {
        // 1. è·å–è¡¨çº§é”
        acquireTableLock(table, LockType.EXCLUSIVE);
        
        // 2. é‡Šæ”¾æ‰€æœ‰è¡Œçº§é”
        releaseAllRowLocks(table);
        
        // 3. æ ‡è®°ä¸ºå·²å‡çº§çŠ¶æ€
        markAsEscalated(table);
    }
}
```

**é”é™çº§ï¼ˆLock De-escalationï¼‰**ï¼šåœ¨åˆé€‚æ—¶æœºå°†ç²—ç²’åº¦é”è½¬æ¢ä¸ºç»†ç²’åº¦é”ã€‚

### 4.3 é”å†²çªå¤„ç†æœºåˆ¶


**å†²çªæ£€æµ‹ç®—æ³•**ï¼š
```java
// å¤šçº§é”å†²çªæ£€æµ‹
public class ConflictDetector {
    public boolean hasConflict(LockRequest request) {
        Resource resource = request.getResource();
        
        // æ£€æŸ¥åŒçº§èµ„æºå†²çª
        if (hasSameLevelConflict(resource, request.getLockType())) {
            return true;
        }
        
        // æ£€æŸ¥çˆ¶çº§èµ„æºå†²çª
        if (hasAncestorConflict(resource, request.getLockType())) {
            return true;
        }
        
        // æ£€æŸ¥å­çº§èµ„æºå†²çª
        if (hasDescendantConflict(resource, request.getLockType())) {
            return true;
        }
        
        return false;
    }
}
```

---

## 5. ğŸ”„ ç²’åº¦è½¬æ¢ç­–ç•¥


### 5.1 åŠ¨æ€ç²’åº¦é€‰æ‹©


**è‡ªé€‚åº”ç²’åº¦ç­–ç•¥**ï¼šæ ¹æ®è®¿é—®æ¨¡å¼åŠ¨æ€é€‰æ‹©æœ€é€‚åˆçš„é”ç²’åº¦ã€‚

```java
// åŠ¨æ€ç²’åº¦é€‰æ‹©å™¨
public class DynamicGranularitySelector {
    public LockGranularity selectOptimalGranularity(AccessPattern pattern) {
        // åˆ†æè®¿é—®æ¨¡å¼
        if (pattern.getAffectedRowCount() > 1000) {
            return LockGranularity.TABLE;  // å¤§æ‰¹é‡æ“ä½œç”¨è¡¨é”
        } else if (pattern.getAffectedRowCount() > 100) {
            return LockGranularity.PAGE;   // ä¸­ç­‰æ‰¹é‡ç”¨é¡µé”
        } else {
            return LockGranularity.ROW;    // å°æ‰¹é‡ç”¨è¡Œé”
        }
    }
    
    public void adaptGranularity(Transaction transaction) {
        AccessPattern pattern = analyzeAccessPattern(transaction);
        LockGranularity optimal = selectOptimalGranularity(pattern);
        
        if (shouldAdjustGranularity(transaction.getCurrentGranularity(), optimal)) {
            performGranularityTransition(transaction, optimal);
        }
    }
}
```

### 5.2 ç²’åº¦è½¬æ¢æ—¶æœº


**è½¬æ¢è§¦å‘æ¡ä»¶**ï¼š
```
ç²’åº¦è½¬æ¢è§¦å‘æ¡ä»¶ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¡ä»¶ç±»å‹        é˜ˆå€¼        è½¬æ¢æ–¹å‘ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é”æ•°é‡è¿‡å¤š      >1000       å‘ä¸Šå‡çº§ â”‚
â”‚ è®¿é—®èŒƒå›´æ‰©å¤§    >50%è¡¨      å‘ä¸Šå‡çº§ â”‚
â”‚ å¹¶å‘å†²çªé¢‘ç¹    >20%å¤±è´¥    å‘ä¸‹é™çº§ â”‚
â”‚ è®¿é—®æ¨¡å¼å˜åŒ–    åˆ†æ•£è®¿é—®    å‘ä¸‹é™çº§ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è½¬æ¢ç­–ç•¥ï¼š
â€¢ æ¸è¿›å¼è½¬æ¢ï¼šé€æ­¥è°ƒæ•´é”ç²’åº¦
â€¢ æ¿€è¿›å¼è½¬æ¢ï¼šå¿«é€Ÿè°ƒæ•´åˆ°ç›®æ ‡ç²’åº¦
â€¢ ä¿å®ˆå¼è½¬æ¢ï¼šè°¨æ…è¯„ä¼°åè½¬æ¢
```

### 5.3 è½¬æ¢è¿‡ç¨‹çš„ä¸€è‡´æ€§ä¿è¯


**åŸå­è½¬æ¢æ“ä½œ**ï¼šç¡®ä¿ç²’åº¦è½¬æ¢è¿‡ç¨‹ä¸­çš„æ•°æ®ä¸€è‡´æ€§ã€‚

```java
// åŸå­ç²’åº¦è½¬æ¢
public class AtomicGranularityConverter {
    public boolean convertGranularity(Resource resource, 
                                    LockGranularity from, 
                                    LockGranularity to) {
        Transaction conversionTx = beginConversionTransaction();
        
        try {
            // 1. è·å–ç›®æ ‡ç²’åº¦çš„é”
            if (!acquireLock(resource, to, conversionTx)) {
                return false;
            }
            
            // 2. éªŒè¯æ•°æ®ä¸€è‡´æ€§
            if (!validateConsistency(resource)) {
                throw new ConsistencyException("æ•°æ®ä¸€è‡´æ€§éªŒè¯å¤±è´¥");
            }
            
            // 3. é‡Šæ”¾åŸç²’åº¦çš„é”
            releaseLock(resource, from, conversionTx);
            
            // 4. æäº¤è½¬æ¢äº‹åŠ¡
            conversionTx.commit();
            return true;
            
        } catch (Exception e) {
            conversionTx.rollback();
            return false;
        }
    }
}
```

---

## 6. âš¡ å±‚æ¬¡åŒ–é”ä¼˜åŒ–


### 6.1 é”å†…å­˜ä¼˜åŒ–


**é”å¯¹è±¡æ± åŒ–**ï¼šå¤ç”¨é”å¯¹è±¡å‡å°‘å†…å­˜åˆ†é…å¼€é”€ã€‚

```java
// é”å¯¹è±¡æ± å®ç°
public class LockObjectPool {
    private final Queue<Lock> availableLocks = new ConcurrentLinkedQueue<>();
    private final AtomicInteger poolSize = new AtomicInteger(0);
    
    public Lock acquireLock() {
        Lock lock = availableLocks.poll();
        if (lock == null) {
            lock = createNewLock();
        } else {
            poolSize.decrementAndGet();
        }
        return lock;
    }
    
    public void releaseLock(Lock lock) {
        if (poolSize.get() < MAX_POOL_SIZE) {
            lock.reset();  // é‡ç½®é”çŠ¶æ€
            availableLocks.offer(lock);
            poolSize.incrementAndGet();
        }
    }
}
```

### 6.2 é”æŸ¥æ‰¾ä¼˜åŒ–


**å±‚æ¬¡ç´¢å¼•ç»“æ„**ï¼šå»ºç«‹é«˜æ•ˆçš„é”æŸ¥æ‰¾ç´¢å¼•ã€‚

```java
// å±‚æ¬¡é”ç´¢å¼•
public class HierarchicalLockIndex {
    private final Map<ResourceId, LockNode> lockIndex = new ConcurrentHashMap<>();
    
    public LockNode findLockNode(ResourceId resourceId) {
        return lockIndex.computeIfAbsent(resourceId, id -> {
            return createLockNode(id);
        });
    }
    
    public List<LockNode> getAncestorLocks(ResourceId resourceId) {
        List<LockNode> ancestors = new ArrayList<>();
        ResourceId current = resourceId.getParent();
        
        while (current != null) {
            LockNode node = lockIndex.get(current);
            if (node != null) {
                ancestors.add(node);
            }
            current = current.getParent();
        }
        
        return ancestors;
    }
}
```

### 6.3 æ‰¹é‡é”æ“ä½œä¼˜åŒ–


**æ‰¹é‡é”è·å–**ï¼šä¸€æ¬¡æ€§è·å–å¤šä¸ªç›¸å…³çš„é”ï¼Œå‡å°‘ç³»ç»Ÿè°ƒç”¨å¼€é”€ã€‚

```java
// æ‰¹é‡é”æ“ä½œ
public class BatchLockManager {
    public boolean acquireBatchLocks(List<LockRequest> requests) {
        // 1. æŒ‰å±‚æ¬¡æ’åºè¯·æ±‚
        List<LockRequest> sortedRequests = sortByHierarchy(requests);
        
        // 2. æ‰¹é‡æ£€æŸ¥å…¼å®¹æ€§
        if (!batchCompatibilityCheck(sortedRequests)) {
            return false;
        }
        
        // 3. æ‰¹é‡è·å–é”
        try {
            for (LockRequest request : sortedRequests) {
                acquireSingleLock(request);
            }
            return true;
        } catch (LockAcquisitionException e) {
            // æ‰¹é‡å›æ»šå·²è·å–çš„é”
            rollbackAcquiredLocks();
            return false;
        }
    }
}
```

---

## 7. ğŸ›ï¸ å¤šç²’åº¦æ§åˆ¶å®Œæ•´æœºåˆ¶


### 7.1 å®Œæ•´é”åè®®æµç¨‹


**æ ‡å‡†åŠ é”æµç¨‹**ï¼šå¤šç²’åº¦ç¯å¢ƒä¸‹çš„å®Œæ•´é”è·å–è¿‡ç¨‹ã€‚

```
å¤šç²’åº¦åŠ é”å®Œæ•´æµç¨‹ï¼š
1. åˆ†æè®¿é—®æ¨¡å¼
   â†“
2. é€‰æ‹©æœ€ä¼˜ç²’åº¦
   â†“
3. ä»æ ¹èŠ‚ç‚¹å¼€å§‹åŠ æ„å›¾é”
   â†“
4. é€å±‚å‘ä¸‹åŠ é”è‡³ç›®æ ‡ç²’åº¦
   â†“
5. æ£€æŸ¥é”å…¼å®¹æ€§
   â†“
6. æ‰§è¡Œä¸šåŠ¡æ“ä½œ
   â†“
7. ä»å¶èŠ‚ç‚¹å¼€å§‹é‡Šæ”¾é”
   â†“
8. é€å±‚å‘ä¸Šé‡Šæ”¾æ„å›¾é”

å…³é”®æ£€æŸ¥ç‚¹ï¼š
â€¢ æ¯å±‚åŠ é”å‰æ£€æŸ¥çˆ¶èŠ‚ç‚¹å…¼å®¹æ€§
â€¢ åŠ é”å¤±è´¥æ—¶åŠæ—¶å›æ»šå·²è·å¾—çš„é”
â€¢ é‡Šæ”¾é”æ—¶ä¿æŒæ­£ç¡®çš„é¡ºåº
```

### 7.2 äº‹åŠ¡é”ç®¡ç†


**äº‹åŠ¡çº§é”è·Ÿè¸ª**ï¼šä¸ºæ¯ä¸ªäº‹åŠ¡ç»´æŠ¤å®Œæ•´çš„é”ä¿¡æ¯ã€‚

```java
// äº‹åŠ¡é”ç®¡ç†å™¨
public class TransactionLockManager {
    private final Map<TransactionId, Set<Lock>> transactionLocks = new ConcurrentHashMap<>();
    
    public void addLockToTransaction(TransactionId txId, Lock lock) {
        transactionLocks.computeIfAbsent(txId, k -> new ConcurrentHashMap<>().keySet())
                       .add(lock);
    }
    
    public void releaseTransactionLocks(TransactionId txId) {
        Set<Lock> locks = transactionLocks.remove(txId);
        if (locks != null) {
            // æŒ‰å±‚æ¬¡ä»ä¸‹åˆ°ä¸Šé‡Šæ”¾é”
            List<Lock> sortedLocks = sortLocksByHierarchy(locks);
            for (Lock lock : sortedLocks) {
                releaseLock(lock);
            }
        }
    }
}
```

### 7.3 æ­»é”æ£€æµ‹ä¸å¤„ç†


**å¤šå±‚æ¬¡æ­»é”æ£€æµ‹**ï¼šåœ¨å¤šç²’åº¦ç¯å¢ƒä¸­æ£€æµ‹å¤æ‚çš„æ­»é”æƒ…å†µã€‚

```java
// å¤šç²’åº¦æ­»é”æ£€æµ‹å™¨
public class MultiGranularityDeadlockDetector {
    public boolean detectDeadlock() {
        // æ„å»ºç­‰å¾…å›¾ï¼ŒåŒ…å«æ‰€æœ‰ç²’åº¦å±‚æ¬¡
        WaitForGraph graph = buildWaitForGraph();
        
        // æ£€æµ‹ç¯è·¯
        return hasCycle(graph);
    }
    
    private WaitForGraph buildWaitForGraph() {
        WaitForGraph graph = new WaitForGraph();
        
        // æ·»åŠ æ‰€æœ‰å±‚æ¬¡çš„é”ç­‰å¾…å…³ç³»
        addDatabaseLevelWaits(graph);
        addTableLevelWaits(graph);
        addRowLevelWaits(graph);
        
        return graph;
    }
}
```

---

## 8. ğŸ¨ ç²’åº¦ä¼˜åŒ–ç­–ç•¥


### 8.1 è®¿é—®æ¨¡å¼åˆ†æ


**æ¨¡å¼è¯†åˆ«ç®—æ³•**ï¼šè‡ªåŠ¨è¯†åˆ«åº”ç”¨çš„æ•°æ®è®¿é—®æ¨¡å¼ã€‚

```java
// è®¿é—®æ¨¡å¼åˆ†æå™¨
public class AccessPatternAnalyzer {
    public AccessPattern analyzePattern(List<Operation> operations) {
        AccessPattern pattern = new AccessPattern();
        
        // åˆ†æè®¿é—®èŒƒå›´
        pattern.setAccessScope(calculateAccessScope(operations));
        
        // åˆ†æè®¿é—®é¢‘ç‡
        pattern.setAccessFrequency(calculateAccessFrequency(operations));
        
        // åˆ†æè®¿é—®é¡ºåº
        pattern.setAccessOrder(analyzeAccessOrder(operations));
        
        return pattern;
    }
    
    private AccessScope calculateAccessScope(List<Operation> operations) {
        int uniqueRows = operations.stream()
            .mapToInt(op -> op.getAffectedRows().size())
            .sum();
            
        if (uniqueRows > TABLE_SCAN_THRESHOLD) {
            return AccessScope.TABLE_LEVEL;
        } else if (uniqueRows > PAGE_SCAN_THRESHOLD) {
            return AccessScope.PAGE_LEVEL;
        } else {
            return AccessScope.ROW_LEVEL;
        }
    }
}
```

### 8.2 è‡ªé€‚åº”ç²’åº¦è°ƒæ•´


**åŠ¨æ€è°ƒæ•´æœºåˆ¶**ï¼šæ ¹æ®ç³»ç»Ÿè´Ÿè½½å’Œæ€§èƒ½åé¦ˆè°ƒæ•´é”ç²’åº¦ç­–ç•¥ã€‚

```java
// è‡ªé€‚åº”ç²’åº¦è°ƒæ•´å™¨
public class AdaptiveGranularityAdjuster {
    public void adjustGranularity() {
        SystemMetrics metrics = collectSystemMetrics();
        
        if (metrics.getLockContentionRate() > HIGH_CONTENTION_THRESHOLD) {
            // é«˜ç«äº‰æ—¶ç»†åŒ–ç²’åº¦
            adjustToFinerGranularity();
        } else if (metrics.getLockOverhead() > HIGH_OVERHEAD_THRESHOLD) {
            // é«˜å¼€é”€æ—¶ç²—åŒ–ç²’åº¦
            adjustToCoarserGranularity();
        }
    }
    
    private void adjustToFinerGranularity() {
        // å°†è¡¨é”è½¬æ¢ä¸ºè¡Œé”
        getCurrentTableLocks().forEach(this::convertToRowLocks);
    }
}
```

### 8.3 æ€§èƒ½åé¦ˆæœºåˆ¶


**æ€§èƒ½ç›‘æ§æŒ‡æ ‡**ï¼š
```
å…³é”®æ€§èƒ½æŒ‡æ ‡ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŒ‡æ ‡ç±»å‹        æ­£å¸¸å€¼      å‘Šè­¦å€¼   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é”è·å–å»¶è¿Ÿ      <10ms      >100ms   â”‚
â”‚ é”å†²çªç‡        <5%        >20%     â”‚
â”‚ é”å‡çº§ç‡        <1%        >10%     â”‚
â”‚ æ­»é”å‘ç”Ÿç‡      <0.1%      >1%      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¼˜åŒ–åé¦ˆå¾ªç¯ï¼š
ç›‘æ§æŒ‡æ ‡ â†’ æ€§èƒ½åˆ†æ â†’ ç­–ç•¥è°ƒæ•´ â†’ æ•ˆæœè¯„ä¼° â†’ ç›‘æ§æŒ‡æ ‡
```

---

## 9. ğŸ“Š å¤šç²’åº¦æ€§èƒ½åˆ†æ


### 9.1 æ€§èƒ½å¼€é”€åˆ†æ


**å„ç²’åº¦é”çš„å¼€é”€å¯¹æ¯”**ï¼š
```
é”ç²’åº¦æ€§èƒ½å¯¹æ¯”ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é”ç²’åº¦    è·å–å¼€é”€   ç»´æŠ¤å¼€é”€   å¹¶å‘åº¦â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ•°æ®åº“é”  æä½       æä½       æä½  â”‚
â”‚ è¡¨é”      ä½         ä½         ä½    â”‚
â”‚ é¡µé”      ä¸­ç­‰       ä¸­ç­‰       ä¸­ç­‰  â”‚
â”‚ è¡Œé”      é«˜         é«˜         é«˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¼€é”€æ„æˆï¼š
â€¢ CPUå¼€é”€ï¼šé”ç«äº‰æ£€æµ‹ã€æ­»é”æ£€æµ‹
â€¢ å†…å­˜å¼€é”€ï¼šé”å¯¹è±¡å­˜å‚¨ã€ç­‰å¾…é˜Ÿåˆ—
â€¢ I/Oå¼€é”€ï¼šé”ä¿¡æ¯æŒä¹…åŒ–
```

### 9.2 å¹¶å‘æ€§èƒ½æµ‹è¯•


**æ€§èƒ½æµ‹è¯•åœºæ™¯**ï¼š
```java
// å¤šç²’åº¦æ€§èƒ½æµ‹è¯•
public class MultiGranularityPerformanceTest {
    public TestResult runPerformanceTest() {
        TestResult result = new TestResult();
        
        // æµ‹è¯•ä¸åŒç²’åº¦ä¸‹çš„æ€§èƒ½
        result.addResult("row_lock", testRowLockPerformance());
        result.addResult("page_lock", testPageLockPerformance());
        result.addResult("table_lock", testTableLockPerformance());
        
        return result;
    }
    
    private PerformanceMetrics testRowLockPerformance() {
        long startTime = System.currentTimeMillis();
        int successCount = 0;
        
        for (int i = 0; i < TEST_ITERATIONS; i++) {
            if (performRowLockOperation()) {
                successCount++;
            }
        }
        
        long duration = System.currentTimeMillis() - startTime;
        return new PerformanceMetrics(duration, successCount);
    }
}
```

### 9.3 ä¼˜åŒ–æ•ˆæœè¯„ä¼°


**æ•ˆæœè¯„ä¼°æŒ‡æ ‡**ï¼š
```
ä¼˜åŒ–æ•ˆæœå¯¹æ¯”ï¼š
ä¼˜åŒ–å‰ï¼š
â€¢ å¹³å‡å“åº”æ—¶é—´ï¼š200ms
â€¢ é”å†²çªç‡ï¼š25%
â€¢ ç³»ç»Ÿååé‡ï¼š500 TPS

ä¼˜åŒ–åï¼š
â€¢ å¹³å‡å“åº”æ—¶é—´ï¼š80ms   (â†“60%)
â€¢ é”å†²çªç‡ï¼š8%         (â†“68%)
â€¢ ç³»ç»Ÿååé‡ï¼š1200 TPS (â†‘140%)

ä¸»è¦ä¼˜åŒ–æªæ–½ï¼š
1. åŠ¨æ€ç²’åº¦é€‰æ‹©å‡å°‘ä¸å¿…è¦çš„é”ç«äº‰
2. é”å‡çº§æœºåˆ¶é™ä½é”ç®¡ç†å¼€é”€
3. æ‰¹é‡é”æ“ä½œæé«˜è·å–æ•ˆç‡
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ å¤šç²’åº¦æ§åˆ¶æœ¬è´¨ï¼šåœ¨ä¸åŒå±‚æ¬¡ä¸ŠåŠ é”ï¼Œå¹³è¡¡å¹¶å‘æ€§èƒ½å’Œç®¡ç†å¼€é”€
ğŸ”¸ æ„å›¾é”åè®®ï¼šé€šè¿‡ISã€IXã€SIXé”å®ç°å±‚æ¬¡åŒ–é”ç®¡ç†
ğŸ”¸ ç²’åº¦å±‚æ¬¡ç»“æ„ï¼šæ•°æ®åº“â†’è¡¨â†’é¡µâ†’è¡Œçš„æ ‘å½¢é”ç»“æ„
ğŸ”¸ é”å‡çº§é™çº§ï¼šæ ¹æ®è®¿é—®æ¨¡å¼åŠ¨æ€è°ƒæ•´é”ç²’åº¦
ğŸ”¸ æ€§èƒ½å¹³è¡¡åŸåˆ™ï¼šåœ¨å¹¶å‘åº¦ã€ç®¡ç†å¼€é”€ã€å“åº”æ—¶é—´é—´æ‰¾å¹³è¡¡
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆéœ€è¦å¤šç²’åº¦æ§åˆ¶**
```
å•ä¸€ç²’åº¦çš„å±€é™æ€§ï¼š
â€¢ è¡Œé”ï¼šé«˜å¹¶å‘ä½†å¼€é”€å¤§ï¼Œä¸é€‚åˆæ‰¹é‡æ“ä½œ
â€¢ è¡¨é”ï¼šä½å¼€é”€ä½†å¹¶å‘å·®ï¼Œå½±å“ç³»ç»Ÿæ€§èƒ½

å¤šç²’åº¦çš„ä¼˜åŠ¿ï¼š
â€¢ æ ¹æ®æ“ä½œç‰¹ç‚¹é€‰æ‹©æœ€é€‚åˆçš„é”ç²’åº¦
â€¢ é€šè¿‡æ„å›¾é”å®ç°é«˜æ•ˆçš„å±‚æ¬¡ç®¡ç†
â€¢ åŠ¨æ€è°ƒæ•´ç²’åº¦é€‚åº”ä¸åŒè´Ÿè½½æ¨¡å¼
```

**ğŸ”¹ æ„å›¾é”çš„æ ¸å¿ƒä½œç”¨**
```
è§£å†³çš„é—®é¢˜ï¼š
â€¢ é¿å…åœ¨å¤§ç²’åº¦é”æ£€æŸ¥æ—¶æ‰«ææ‰€æœ‰å­èŠ‚ç‚¹
â€¢ æä¾›é«˜æ•ˆçš„é”å…¼å®¹æ€§æ£€æŸ¥æœºåˆ¶
â€¢ æ”¯æŒé”çš„å±‚æ¬¡åŒ–ç®¡ç†

å·¥ä½œæœºåˆ¶ï¼š
â€¢ åŠ é”å‰åœ¨çˆ¶èŠ‚ç‚¹åŠ æ„å›¾é”
â€¢ é€šè¿‡å…¼å®¹æ€§çŸ©é˜µå¿«é€Ÿåˆ¤æ–­å†²çª
â€¢ é‡Šæ”¾æ—¶ä»å­èŠ‚ç‚¹å‘çˆ¶èŠ‚ç‚¹é‡Šæ”¾
```

**ğŸ”¹ ç²’åº¦è½¬æ¢çš„ç­–ç•¥é€‰æ‹©**
```
è½¬æ¢æ—¶æœºï¼š
â€¢ é”æ•°é‡è¿‡å¤šæ—¶å‘ä¸Šå‡çº§
â€¢ è®¿é—®æ¨¡å¼å˜åŒ–æ—¶è°ƒæ•´ç²’åº¦
â€¢ ç³»ç»Ÿè´Ÿè½½å˜åŒ–æ—¶åŠ¨æ€è°ƒæ•´

è½¬æ¢åŸåˆ™ï¼š
â€¢ ä¿è¯è½¬æ¢è¿‡ç¨‹çš„åŸå­æ€§
â€¢ ç»´æŠ¤æ•°æ®çš„ä¸€è‡´æ€§
â€¢ æœ€å°åŒ–è½¬æ¢å¼€é”€
```

### 10.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ç²’åº¦é€‰æ‹©ç­–ç•¥**ï¼š
- **OLTPç³»ç»Ÿ**ï¼šä»¥è¡Œé”ä¸ºä¸»ï¼Œå°‘é‡è¡¨é”ç”¨äºDDLæ“ä½œ
- **OLAPç³»ç»Ÿ**ï¼šä»¥è¡¨é”ã€é¡µé”ä¸ºä¸»ï¼Œå‡å°‘é”ç®¡ç†å¼€é”€
- **æ··åˆç³»ç»Ÿ**ï¼šæ ¹æ®æ“ä½œç±»å‹åŠ¨æ€é€‰æ‹©åˆé€‚ç²’åº¦

**æ€§èƒ½ä¼˜åŒ–é‡ç‚¹**ï¼š
- **é«˜å¹¶å‘åœºæ™¯**ï¼šé‡ç‚¹ä¼˜åŒ–é”å†²çªæ£€æµ‹å’Œæ„å›¾é”ç®¡ç†
- **æ‰¹é‡æ“ä½œ**ï¼šé‡ç‚¹ä¼˜åŒ–é”å‡çº§å’Œæ‰¹é‡é”è·å–
- **å¤æ‚æŸ¥è¯¢**ï¼šé‡ç‚¹ä¼˜åŒ–ç²’åº¦é€‰æ‹©å’Œè½¬æ¢ç­–ç•¥

**ç›‘æ§å…³æ³¨ç‚¹**ï¼š
- **é”å†²çªç‡**ï¼šåæ˜ ç²’åº¦é€‰æ‹©æ˜¯å¦åˆç†
- **é”å‡çº§é¢‘ç‡**ï¼šåæ˜ ç³»ç»Ÿè´Ÿè½½å’Œç­–ç•¥æ•ˆæœ
- **å¹³å‡é”æŒæœ‰æ—¶é—´**ï¼šåæ˜ äº‹åŠ¡å¤„ç†æ•ˆç‡

### 10.4 å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ


```
â“ é”å‡çº§è¿‡äºé¢‘ç¹æ€ä¹ˆåŠï¼Ÿ
ğŸ’¡ è°ƒæ•´å‡çº§é˜ˆå€¼ï¼Œä¼˜åŒ–è®¿é—®æ¨¡å¼ï¼Œè€ƒè™‘é¢„åˆ†é…ç²—ç²’åº¦é”

â“ æ„å›¾é”æœ¬èº«æˆä¸ºç“¶é¢ˆæ€ä¹ˆåŠï¼Ÿ
ğŸ’¡ ä¼˜åŒ–æ„å›¾é”çš„å®ç°ï¼Œä½¿ç”¨æ— é”æ•°æ®ç»“æ„ï¼Œåˆ†æ•£çƒ­ç‚¹

â“ ä¸åŒç²’åº¦é—´çš„æ­»é”å¦‚ä½•å¤„ç†ï¼Ÿ
ğŸ’¡ ç»Ÿä¸€æ­»é”æ£€æµ‹ç®—æ³•ï¼Œè®¾ç½®åˆç†çš„æ£€æµ‹å‘¨æœŸï¼Œä¼˜åŒ–é”é¡ºåº

â“ å¦‚ä½•å¹³è¡¡å¹¶å‘åº¦å’Œç®¡ç†å¼€é”€ï¼Ÿ
ğŸ’¡ åŸºäºè´Ÿè½½ç›‘æ§åŠ¨æ€è°ƒæ•´ï¼Œä½¿ç”¨è‡ªé€‚åº”ç­–ç•¥ï¼Œå®šæœŸæ€§èƒ½è¯„ä¼°
```

**æ ¸å¿ƒè®°å¿†è¦è¯€**ï¼š
- å¤šç²’åº¦æ§åˆ¶ææ•ˆç‡ï¼Œå±‚æ¬¡åŠ é”æœ‰ç­–ç•¥
- æ„å›¾é”åè®®æ˜¯å…³é”®ï¼Œå…¼å®¹çŸ©é˜µè¦è®°ç‰¢
- ç²’åº¦è½¬æ¢éœ€è°¨æ…ï¼ŒåŠ¨æ€è°ƒæ•´çœ‹è´Ÿè½½
- æ€§èƒ½ç›‘æ§ä¸å¯å°‘ï¼ŒæŒç»­ä¼˜åŒ–æ˜¯ç›®æ ‡