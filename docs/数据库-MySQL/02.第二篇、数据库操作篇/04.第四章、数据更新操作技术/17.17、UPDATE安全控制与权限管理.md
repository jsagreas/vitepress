---
title: 17ã€UPDATEå®‰å…¨æ§åˆ¶ä¸æƒé™ç®¡ç†
---
## ğŸ“š ç›®å½•

1. [UPDATEæ“ä½œå®‰å…¨é£é™©æ¦‚è¿°](#1-UPDATEæ“ä½œå®‰å…¨é£é™©æ¦‚è¿°)
2. [WHEREæ¡ä»¶å¿…è¦æ€§æ£€æŸ¥](#2-WHEREæ¡ä»¶å¿…è¦æ€§æ£€æŸ¥)
3. [sql_safe_updateså®‰å…¨æ¨¡å¼](#3-sql_safe_updateså®‰å…¨æ¨¡å¼)
4. [æ›´æ–°å‰æ•°æ®å¤‡ä»½ç­–ç•¥](#4-æ›´æ–°å‰æ•°æ®å¤‡ä»½ç­–ç•¥)
5. [æ›´æ–°æƒé™æ§åˆ¶ç®¡ç†](#5-æ›´æ–°æƒé™æ§åˆ¶ç®¡ç†)
6. [æ‰¹é‡æ›´æ–°é£é™©æ§åˆ¶](#6-æ‰¹é‡æ›´æ–°é£é™©æ§åˆ¶)
7. [æ›´æ–°å½±å“è¡Œæ•°æ£€æŸ¥](#7-æ›´æ–°å½±å“è¡Œæ•°æ£€æŸ¥)
8. [æ•æ„Ÿå­—æ®µæ›´æ–°æƒé™](#8-æ•æ„Ÿå­—æ®µæ›´æ–°æƒé™)
9. [å®‰å…¨æ›´æ–°æµç¨‹è§„èŒƒ](#9-å®‰å…¨æ›´æ–°æµç¨‹è§„èŒƒ)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. âš ï¸ UPDATEæ“ä½œå®‰å…¨é£é™©æ¦‚è¿°


### 1.1 ä¸ºä»€ä¹ˆUPDATEæ“ä½œéœ€è¦ç‰¹åˆ«æ³¨æ„å®‰å…¨

**UPDATEæ“ä½œçš„ç ´åæ€§**ï¼šä¸€ä¸ªé”™è¯¯çš„UPDATEè¯­å¥å¯èƒ½ç¬é—´æ¯æ‰æ•´å¼ è¡¨çš„æ•°æ®ã€‚

```
å±é™©ç¨‹åº¦å¯¹æ¯”ï¼š
SELECT é”™è¯¯ â†’ æœ€å¤šæŸ¥è¯¢æ…¢ä¸€ç‚¹
INSERT é”™è¯¯ â†’ æ’å…¥é”™è¯¯æ•°æ®ï¼Œä½†åŸæ•°æ®ä¸å—å½±å“  
UPDATE é”™è¯¯ â†’ å¯èƒ½è¦†ç›–æ‰€æœ‰æ­£ç¡®æ•°æ®
DELETE é”™è¯¯ â†’ å¯èƒ½åˆ é™¤æ‰€æœ‰æ•°æ®

UPDATEçš„ç‰¹æ®Šå±é™©æ€§ï¼š
- ä¿®æ”¹ç°æœ‰æ•°æ®ï¼Œæ— æ³•ç®€å•å›æ»š
- å½±å“èŒƒå›´å¯èƒ½è¶…å‡ºé¢„æœŸ
- é”™è¯¯ä¸æ˜“è¢«ç«‹å³å‘ç°
```

### 1.2 å¸¸è§çš„UPDATEå®‰å…¨é£é™©

**ğŸ”¸ å¿˜è®°WHEREæ¡ä»¶**
```sql
-- å±é™©æ“ä½œï¼šå¿˜è®°WHEREæ¡ä»¶
UPDATE users SET password = '123456';
-- ç»“æœï¼šæ‰€æœ‰ç”¨æˆ·å¯†ç éƒ½è¢«æ”¹æˆ123456

-- æ­£ç¡®æ“ä½œï¼šå¿…é¡»æœ‰WHEREæ¡ä»¶
UPDATE users SET password = '123456' WHERE user_id = 1001;
```

**ğŸ”¸ WHEREæ¡ä»¶é”™è¯¯**
```sql
-- å±é™©æ“ä½œï¼šæ¡ä»¶å†™é”™
UPDATE orders SET status = 'cancelled' WHERE order_id = '1001';
-- å¦‚æœorder_idå­—æ®µæ˜¯æ•°å­—ç±»å‹ï¼Œå¯èƒ½åŒ¹é…åˆ°å¤šè¡Œ

-- æ­£ç¡®æ“ä½œï¼šç¡®ä¿æ¡ä»¶ç²¾ç¡®
UPDATE orders SET status = 'cancelled' WHERE order_id = 1001;
```

**ğŸ”¸ æ‰¹é‡æ›´æ–°é£é™©**
```sql
-- å±é™©æ“ä½œï¼šå½±å“èŒƒå›´å¤ªå¤§
UPDATE products SET price = price * 0.5 WHERE category_id IN (1,2,3,4,5);
-- å¦‚æœæ•°æ®é‡å¾ˆå¤§ï¼Œå¯èƒ½é”è¡¨å¾ˆä¹…

-- æ­£ç¡®æ“ä½œï¼šåˆ†æ‰¹å¤„ç†
UPDATE products SET price = price * 0.5 
WHERE category_id = 1 AND product_id BETWEEN 1 AND 1000;
```

### 1.3 UPDATEæ“ä½œé£é™©è¯„ä¼°æ¡†æ¶

```
é£é™©ç­‰çº§è¯„ä¼°ï¼š

ğŸ”´ æé«˜é£é™©ï¼š
â”œâ”€â”€ æ²¡æœ‰WHEREæ¡ä»¶çš„UPDATE
â”œâ”€â”€ WHEREæ¡ä»¶å¯èƒ½åŒ¹é…å¤§é‡æ•°æ®
â””â”€â”€ æ›´æ–°æ ¸å¿ƒä¸šåŠ¡å­—æ®µ

ğŸŸ¡ ä¸­ç­‰é£é™©ï¼š
â”œâ”€â”€ æ‰¹é‡æ›´æ–°æ“ä½œ
â”œâ”€â”€ æ›´æ–°è®¡ç®—å­—æ®µ
â””â”€â”€ è·¨è¡¨å…³è”æ›´æ–°

ğŸŸ¢ ä½é£é™©ï¼š
â”œâ”€â”€ æœ‰ç²¾ç¡®WHEREæ¡ä»¶çš„å•è¡Œæ›´æ–°
â”œâ”€â”€ æ›´æ–°éå…³é”®å­—æ®µ
â””â”€â”€ åœ¨äº‹åŠ¡ä¸­çš„æ›´æ–°æ“ä½œ
```

---

## 2. ğŸ›¡ï¸ WHEREæ¡ä»¶å¿…è¦æ€§æ£€æŸ¥


### 2.1 ä¸ºä»€ä¹ˆWHEREæ¡ä»¶å¦‚æ­¤é‡è¦

**WHEREæ¡ä»¶æ˜¯UPDATEçš„"å®‰å…¨é”"**ï¼šå®ƒå†³å®šäº†å“ªäº›æ•°æ®ä¼šè¢«ä¿®æ”¹ã€‚

```
UPDATEæ“ä½œçš„å·¥ä½œæµç¨‹ï¼š
1. æ‰¾åˆ°ç¬¦åˆWHEREæ¡ä»¶çš„è¡Œ â†’ WHEREæ¡ä»¶å†³å®šå½±å“èŒƒå›´
2. å¯¹è¿™äº›è¡Œæ‰§è¡ŒSETæ“ä½œ   â†’ SETå†³å®šå¦‚ä½•ä¿®æ”¹
3. æäº¤ä¿®æ”¹ç»“æœ         â†’ ä¿®æ”¹ä¸å¯é€†

æ²¡æœ‰WHEREæ¡ä»¶ = æ²¡æœ‰é™åˆ¶ = ä¿®æ”¹æ‰€æœ‰æ•°æ®
```

### 2.2 WHEREæ¡ä»¶è®¾è®¡åŸåˆ™

**ğŸ”¸ ä½¿ç”¨ä¸»é”®æˆ–å”¯ä¸€é”®**
```sql
-- âœ… æ¨èï¼šä½¿ç”¨ä¸»é”®
UPDATE users SET last_login = NOW() WHERE user_id = 1001;

-- âœ… æ¨èï¼šä½¿ç”¨å”¯ä¸€é”®
UPDATE users SET last_login = NOW() WHERE email = 'user@example.com';

-- âŒ å±é™©ï¼šä½¿ç”¨å¯èƒ½é‡å¤çš„å­—æ®µ
UPDATE users SET last_login = NOW() WHERE name = 'John';
-- å¯èƒ½æœ‰å¤šä¸ªåä¸ºJohnçš„ç”¨æˆ·
```

**ğŸ”¸ æ·»åŠ é¢å¤–å®‰å…¨æ¡ä»¶**
```sql
-- åŸºç¡€æ¡ä»¶
UPDATE users SET status = 'active' WHERE user_id = 1001;

-- å¢å¼ºå®‰å…¨ï¼šæ·»åŠ é¢å¤–æ£€æŸ¥æ¡ä»¶
UPDATE users 
SET status = 'active' 
WHERE user_id = 1001 
  AND status = 'inactive'  -- ç¡®ä¿åªæ›´æ–°ç¬¦åˆé¢„æœŸçŠ¶æ€çš„è®°å½•
  AND created_at > '2023-01-01';  -- é¢å¤–çš„æ—¶é—´é™åˆ¶
```

### 2.3 WHEREæ¡ä»¶éªŒè¯æŠ€å·§

**ğŸ”¸ å…ˆç”¨SELECTéªŒè¯**
```sql
-- æ­¥éª¤1ï¼šå…ˆç”¨SELECTæŸ¥çœ‹ä¼šå½±å“å“ªäº›æ•°æ®
SELECT user_id, name, email, status 
FROM users 
WHERE department = 'IT' AND hire_date < '2023-01-01';

-- æ­¥éª¤2ï¼šç¡®è®¤ç»“æœåï¼Œæ”¹æˆUPDATE
UPDATE users 
SET status = 'senior' 
WHERE department = 'IT' AND hire_date < '2023-01-01';
```

**ğŸ”¸ ä½¿ç”¨LIMITé™åˆ¶å½±å“èŒƒå›´**
```sql
-- å³ä½¿WHEREæ¡ä»¶æœ‰é—®é¢˜ï¼ŒLIMITä¹Ÿèƒ½é™åˆ¶æŸå®³
UPDATE users 
SET last_login = NOW() 
WHERE status = 'active' 
LIMIT 1;  -- æœ€å¤šåªå½±å“1è¡Œ
```

### 2.4 WHEREæ¡ä»¶å¸¸è§é”™è¯¯

```sql
-- âŒ é”™è¯¯1ï¼šæ•°æ®ç±»å‹ä¸åŒ¹é…
UPDATE products SET price = 99.99 WHERE product_id = '1001';
-- å¦‚æœproduct_idæ˜¯æ•´æ•°ï¼Œå­—ç¬¦ä¸²'1001'å¯èƒ½å¯¼è‡´æ„å¤–åŒ¹é…

-- âœ… æ­£ç¡®å†™æ³•
UPDATE products SET price = 99.99 WHERE product_id = 1001;

-- âŒ é”™è¯¯2ï¼šNULLå€¼å¤„ç†ä¸å½“
UPDATE users SET status = 'active' WHERE department != 'HR';
-- departmentä¸ºNULLçš„è®°å½•ä¸ä¼šè¢«åŒ¹é…åˆ°

-- âœ… æ­£ç¡®å†™æ³•
UPDATE users SET status = 'active' 
WHERE department != 'HR' OR department IS NULL;

-- âŒ é”™è¯¯3ï¼šæ—¶é—´æ ¼å¼é”™è¯¯
UPDATE orders SET status = 'shipped' WHERE order_date = '2023-12-01';
-- å¯èƒ½ä¸åŒ¹é…åŒ…å«æ—¶é—´çš„datetimeå­—æ®µ

-- âœ… æ­£ç¡®å†™æ³•  
UPDATE orders SET status = 'shipped' 
WHERE DATE(order_date) = '2023-12-01';
```

---

## 3. ğŸ” sql_safe_updateså®‰å…¨æ¨¡å¼


### 3.1 ä»€ä¹ˆæ˜¯sql_safe_updates

**sql_safe_updates**æ˜¯MySQLæä¾›çš„å®‰å…¨æ¨¡å¼ï¼Œé˜²æ­¢æ‰§è¡Œå¯èƒ½å½±å“å¤§é‡æ•°æ®çš„UPDATEå’ŒDELETEè¯­å¥ã€‚

```
å®‰å…¨æ¨¡å¼çš„ä½œç”¨ï¼š
- é˜»æ­¢æ²¡æœ‰WHEREæ¡ä»¶çš„UPDATE/DELETE
- é˜»æ­¢WHEREæ¡ä»¶ä¸ä½¿ç”¨ç´¢å¼•çš„å¤§èŒƒå›´æ“ä½œ
- å¼ºåˆ¶è¦æ±‚ç²¾ç¡®çš„æ•°æ®å®šä½æ¡ä»¶
```

### 3.2 å¯ç”¨sql_safe_updatesæ¨¡å¼

**ğŸ”¸ ä¸´æ—¶å¯ç”¨ï¼ˆå½“å‰ä¼šè¯ï¼‰**
```sql
-- å¯ç”¨å®‰å…¨æ¨¡å¼
SET sql_safe_updates = 1;

-- æµ‹è¯•ï¼šæ²¡æœ‰WHEREæ¡ä»¶çš„UPDATEä¼šè¢«é˜»æ­¢
UPDATE users SET status = 'active';
-- é”™è¯¯ï¼šYou are using safe update mode and you tried to update 
-- a table without a WHERE that uses a KEY column

-- å…³é—­å®‰å…¨æ¨¡å¼
SET sql_safe_updates = 0;
```

**ğŸ”¸ å…¨å±€å¯ç”¨**
```sql
-- åœ¨é…ç½®æ–‡ä»¶my.cnfä¸­æ·»åŠ 
[mysqld]
sql-safe-updates = 1

-- æˆ–è€…åŠ¨æ€è®¾ç½®å…¨å±€å‚æ•°
SET GLOBAL sql_safe_updates = 1;
```

**ğŸ”¸ å®¢æˆ·ç«¯å¯åŠ¨æ—¶å¯ç”¨**
```bash
# è¿æ¥MySQLæ—¶å¯ç”¨å®‰å…¨æ¨¡å¼
mysql -u username -p --safe-updates

# ç­‰åŒäºåœ¨è¿æ¥åæ‰§è¡Œ SET sql_safe_updates=1
```

### 3.3 å®‰å…¨æ¨¡å¼çš„é™åˆ¶è§„åˆ™

**ğŸ”¸ UPDATEé™åˆ¶è§„åˆ™**
```sql
-- âŒ è¢«é˜»æ­¢ï¼šæ²¡æœ‰WHEREæ¡ä»¶
UPDATE users SET status = 'active';

-- âŒ è¢«é˜»æ­¢ï¼šWHEREæ¡ä»¶ä¸ä½¿ç”¨ç´¢å¼•é”®
UPDATE users SET status = 'active' WHERE name LIKE '%John%';

-- âœ… å…è®¸ï¼šWHEREæ¡ä»¶ä½¿ç”¨ä¸»é”®
UPDATE users SET status = 'active' WHERE user_id = 1001;

-- âœ… å…è®¸ï¼šWHEREæ¡ä»¶ä½¿ç”¨å”¯ä¸€ç´¢å¼•
UPDATE users SET status = 'active' WHERE email = 'user@example.com';

-- âœ… å…è®¸ï¼šæœ‰LIMITé™åˆ¶
UPDATE users SET status = 'active' WHERE name LIKE '%John%' LIMIT 10;
```

### 3.4 ç»•è¿‡å®‰å…¨æ¨¡å¼çš„æ–¹æ³•

**ğŸ”¸ ä¸´æ—¶å…³é—­å®‰å…¨æ¨¡å¼**
```sql
-- æ–¹æ³•1ï¼šä¸´æ—¶å…³é—­
SET sql_safe_updates = 0;
UPDATE users SET status = 'active' WHERE department = 'IT';
SET sql_safe_updates = 1;  -- é‡æ–°å¯ç”¨

-- æ–¹æ³•2ï¼šåœ¨äº‹åŠ¡ä¸­æ“ä½œ
BEGIN;
SET sql_safe_updates = 0;
UPDATE users SET status = 'active' WHERE department = 'IT';
SET sql_safe_updates = 1;
COMMIT;
```

**ğŸ”¸ ä½¿ç”¨LIMITç»•è¿‡**
```sql
-- å®‰å…¨æ¨¡å¼ä¸‹ï¼Œæ·»åŠ LIMITå¯ä»¥ç»•è¿‡é™åˆ¶
UPDATE users 
SET status = 'active' 
WHERE department = 'IT' 
LIMIT 999999;  -- è®¾ç½®ä¸€ä¸ªè¶³å¤Ÿå¤§çš„LIMIT
```

### 3.5 å®‰å…¨æ¨¡å¼é…ç½®å»ºè®®

```
å¼€å‘ç¯å¢ƒï¼š
âœ… å¼ºçƒˆå»ºè®®å¯ç”¨sql_safe_updates
- å¸®åŠ©å‘ç°æ½œåœ¨çš„å±é™©SQL
- åŸ¹å…»è‰¯å¥½çš„SQLç¼–å†™ä¹ æƒ¯

æµ‹è¯•ç¯å¢ƒï¼š  
ğŸŸ¡ å¯é€‰æ‹©æ€§å¯ç”¨
- æµ‹è¯•æ•°æ®å…è®¸ä¸€å®šçš„å®¹é”™
- ä½†ä¹Ÿè¦æ¨¡æ‹Ÿç”Ÿäº§ç¯å¢ƒ

ç”Ÿäº§ç¯å¢ƒï¼š
ğŸ”´ è°¨æ…è€ƒè™‘
- å¯èƒ½å½±å“æ­£å¸¸ä¸šåŠ¡æ“ä½œ
- å»ºè®®é€šè¿‡åº”ç”¨å±‚æ§åˆ¶å®‰å…¨æ€§
- æˆ–è€…åªå¯¹ç‰¹å®šç”¨æˆ·å¯ç”¨
```

---

## 4. ğŸ’¾ æ›´æ–°å‰æ•°æ®å¤‡ä»½ç­–ç•¥


### 4.1 ä¸ºä»€ä¹ˆéœ€è¦æ›´æ–°å‰å¤‡ä»½

**æ•°æ®å¤‡ä»½æ˜¯UPDATEæ“ä½œçš„"åæ‚”è¯"**ï¼šä¸€æ—¦æ›´æ–°å‡ºé”™ï¼Œå¤‡ä»½æ˜¯æ¢å¤æ•°æ®çš„å”¯ä¸€æ–¹æ³•ã€‚

```
å¤‡ä»½çš„é‡è¦æ€§ï¼š
UPDATEå‰çŠ¶æ€ï¼šuser_id=1, name='John', salary=5000
UPDATEæ“ä½œï¼š  UPDATE users SET salary=50000 WHERE user_id=1
UPDATEåçŠ¶æ€ï¼šuser_id=1, name='John', salary=50000

å¦‚æœå‘ç°æ›´æ–°é”™è¯¯ï¼š
- æ²¡æœ‰å¤‡ä»½ï¼šæ•°æ®æ°¸è¿œä¸¢å¤±ï¼ŒåŸå€¼5000æ— æ³•æ‰¾å›
- æœ‰å¤‡ä»½ï¼šå¯ä»¥å¿«é€Ÿæ¢å¤åˆ°æ›´æ–°å‰çŠ¶æ€
```

### 4.2 æ›´æ–°å‰æ•°æ®å¿«ç…§æŠ€æœ¯

**ğŸ”¸ æ–¹æ³•1ï¼šåˆ›å»ºå¤‡ä»½è¡¨**
```sql
-- æ­¥éª¤1ï¼šåˆ›å»ºå¤‡ä»½è¡¨ç»“æ„
CREATE TABLE users_backup_20241201 LIKE users;

-- æ­¥éª¤2ï¼šå¤‡ä»½è¦æ›´æ–°çš„æ•°æ®
INSERT INTO users_backup_20241201
SELECT * FROM users WHERE department = 'IT';

-- æ­¥éª¤3ï¼šæ‰§è¡Œæ›´æ–°æ“ä½œ
UPDATE users SET salary = salary * 1.1 WHERE department = 'IT';

-- å¦‚æœéœ€è¦å›æ»šï¼š
-- DELETE FROM users WHERE department = 'IT';
-- INSERT INTO users SELECT * FROM users_backup_20241201;
```

**ğŸ”¸ æ–¹æ³•2ï¼šä½¿ç”¨ä¸´æ—¶è¡¨å¿«ç…§**
```sql
-- åˆ›å»ºä¸´æ—¶å¤‡ä»½è¡¨
CREATE TEMPORARY TABLE temp_users_backup
SELECT * FROM users WHERE status = 'active';

-- æ‰§è¡Œæ›´æ–°
UPDATE users SET last_login = NOW() WHERE status = 'active';

-- å¦‚æœéœ€è¦æŸ¥çœ‹å˜æ›´ï¼š
SELECT 
    b.user_id,
    b.last_login AS old_last_login,
    u.last_login AS new_last_login
FROM temp_users_backup b
JOIN users u ON b.user_id = u.user_id
WHERE b.last_login != u.last_login;
```

**ğŸ”¸ æ–¹æ³•3ï¼šå¯¼å‡ºå¤‡ä»½æ–‡ä»¶**
```bash
# å¤‡ä»½ç‰¹å®šæ•°æ®åˆ°æ–‡ä»¶
mysqldump -u root -p database_name \
--where="department='IT'" users > users_IT_backup.sql

# æ‰§è¡Œæ›´æ–°åï¼Œå¦‚éœ€æ¢å¤ï¼š
mysql -u root -p database_name < users_IT_backup.sql
```

### 4.3 è‡ªåŠ¨å¤‡ä»½è„šæœ¬

**ğŸ”¸ UPDATEå‰è‡ªåŠ¨å¤‡ä»½å‡½æ•°**
```sql
DELIMITER //
CREATE PROCEDURE SafeUpdate(
    IN backup_suffix VARCHAR(50),
    IN target_table VARCHAR(100),
    IN update_sql TEXT,
    IN where_condition TEXT
)
BEGIN
    DECLARE backup_table VARCHAR(150);
    DECLARE full_backup_sql TEXT;
    DECLARE full_update_sql TEXT;
    
    -- ç”Ÿæˆå¤‡ä»½è¡¨å
    SET backup_table = CONCAT(target_table, '_backup_', backup_suffix);
    
    -- åˆ›å»ºå¤‡ä»½è¡¨
    SET @sql = CONCAT('CREATE TABLE ', backup_table, ' SELECT * FROM ', target_table, ' WHERE ', where_condition);
    PREPARE stmt FROM @sql;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
    
    -- æ‰§è¡Œæ›´æ–°
    SET full_update_sql = CONCAT(update_sql, ' WHERE ', where_condition);
    SET @sql = full_update_sql;
    PREPARE stmt FROM @sql;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
    
    -- è¿”å›å½±å“è¡Œæ•°å’Œå¤‡ä»½è¡¨å
    SELECT ROW_COUNT() as affected_rows, backup_table as backup_table_name;
END //
DELIMITER ;

-- ä½¿ç”¨ç¤ºä¾‹
CALL SafeUpdate(
    '20241201_001',
    'users',
    'UPDATE users SET salary = salary * 1.1',
    'department = "IT"'
);
```

### 4.4 å¤‡ä»½ç­–ç•¥é€‰æ‹©

```
å¤‡ä»½ç­–ç•¥å¯¹æ¯”ï¼š

å®Œæ•´è¡¨å¤‡ä»½ï¼š
âœ… ä¼˜ç‚¹ï¼šæ•°æ®å®Œæ•´ï¼Œæ¢å¤ç®€å•
âŒ ç¼ºç‚¹ï¼šå ç”¨ç©ºé—´å¤§ï¼Œå¤‡ä»½æ—¶é—´é•¿
ğŸ¯ é€‚ç”¨ï¼šå°è¡¨æˆ–å…³é”®ä¸šåŠ¡è¡¨

å¢é‡å¤‡ä»½ï¼š
âœ… ä¼˜ç‚¹ï¼šåªå¤‡ä»½è¦ä¿®æ”¹çš„æ•°æ®ï¼Œé€Ÿåº¦å¿«
âŒ ç¼ºç‚¹ï¼šæ¢å¤ç¨å¤æ‚
ğŸ¯ é€‚ç”¨ï¼šå¤§è¡¨æˆ–é¢‘ç¹æ›´æ–°çš„è¡¨

æ–‡ä»¶å¤‡ä»½ï¼š
âœ… ä¼˜ç‚¹ï¼šå¯ä»¥é•¿æœŸä¿å­˜ï¼Œä¾¿äºä¼ è¾“
âŒ ç¼ºç‚¹ï¼šæ¢å¤éœ€è¦é¢å¤–æ­¥éª¤
ğŸ¯ é€‚ç”¨ï¼šé‡è¦çš„ä¸€æ¬¡æ€§æ›´æ–°æ“ä½œ

ä¸´æ—¶è¡¨å¤‡ä»½ï¼š
âœ… ä¼˜ç‚¹ï¼šåŒä¼šè¯å†…å¿«é€Ÿæ“ä½œï¼Œè‡ªåŠ¨æ¸…ç†
âŒ ç¼ºç‚¹ï¼šä¼šè¯ç»“æŸåä¸¢å¤±
ğŸ¯ é€‚ç”¨ï¼šæµ‹è¯•ç¯å¢ƒæˆ–ä¸´æ—¶æ“ä½œ
```

---

## 5. ğŸ‘¤ æ›´æ–°æƒé™æ§åˆ¶ç®¡ç†


### 5.1 MySQLæ›´æ–°æƒé™ä½“ç³»

**UPDATEæƒé™æ§åˆ¶çš„å±‚æ¬¡ç»“æ„**ï¼šä»ç²—ç²’åº¦åˆ°ç»†ç²’åº¦æ§åˆ¶ç”¨æˆ·çš„æ›´æ–°æ“ä½œã€‚

```
æƒé™æ§åˆ¶å±‚æ¬¡ï¼š

æœåŠ¡å™¨çº§åˆ« (mysql.user)
â”œâ”€â”€ å…¨å±€UPDATEæƒé™
â””â”€â”€ å½±å“æ‰€æœ‰æ•°æ®åº“çš„æ‰€æœ‰è¡¨

æ•°æ®åº“çº§åˆ« (mysql.db)
â”œâ”€â”€ ç‰¹å®šæ•°æ®åº“çš„UPDATEæƒé™  
â””â”€â”€ å½±å“æŒ‡å®šæ•°æ®åº“çš„æ‰€æœ‰è¡¨

è¡¨çº§åˆ« (mysql.tables_priv)
â”œâ”€â”€ ç‰¹å®šè¡¨çš„UPDATEæƒé™
â””â”€â”€ å½±å“æŒ‡å®šè¡¨çš„æ‰€æœ‰åˆ—

åˆ—çº§åˆ« (mysql.columns_priv)
â”œâ”€â”€ ç‰¹å®šåˆ—çš„UPDATEæƒé™
â””â”€â”€ æœ€ç²¾ç¡®çš„æƒé™æ§åˆ¶
```

### 5.2 åŸºç¡€UPDATEæƒé™ç®¡ç†

**ğŸ”¸ æŸ¥çœ‹ç”¨æˆ·UPDATEæƒé™**
```sql
-- æŸ¥çœ‹ç”¨æˆ·çš„å…¨å±€æƒé™
SHOW GRANTS FOR 'username'@'host';

-- æŸ¥çœ‹ç‰¹å®šç”¨æˆ·å¯¹ç‰¹å®šæ•°æ®åº“çš„æƒé™
SELECT 
    User, Host, Db, 
    Update_priv,
    Select_priv
FROM mysql.db 
WHERE User = 'username' AND Db = 'database_name';

-- æŸ¥çœ‹è¡¨çº§æƒé™
SELECT 
    User, Host, Db, Table_name,
    Table_priv
FROM mysql.tables_priv
WHERE User = 'username';
```

**ğŸ”¸ æˆäºˆUPDATEæƒé™**
```sql
-- æˆäºˆå…¨åº“UPDATEæƒé™
GRANT UPDATE ON database_name.* TO 'username'@'host';

-- æˆäºˆç‰¹å®šè¡¨UPDATEæƒé™  
GRANT UPDATE ON database_name.table_name TO 'username'@'host';

-- æˆäºˆç‰¹å®šåˆ—UPDATEæƒé™
GRANT UPDATE(column1, column2) ON database_name.table_name TO 'username'@'host';

-- åˆ·æ–°æƒé™
FLUSH PRIVILEGES;
```

**ğŸ”¸ æ’¤é”€UPDATEæƒé™**
```sql
-- æ’¤é”€å…¨åº“UPDATEæƒé™
REVOKE UPDATE ON database_name.* FROM 'username'@'host';

-- æ’¤é”€ç‰¹å®šè¡¨UPDATEæƒé™
REVOKE UPDATE ON database_name.table_name FROM 'username'@'host';

-- æ’¤é”€ç‰¹å®šåˆ—UPDATEæƒé™  
REVOKE UPDATE(column1) ON database_name.table_name FROM 'username'@'host';

FLUSH PRIVILEGES;
```

### 5.3 åˆ›å»ºä¸“ç”¨æ›´æ–°è´¦æˆ·

**ğŸ”¸ åªè¯»è´¦æˆ·ï¼ˆç¦æ­¢UPDATEï¼‰**
```sql
-- åˆ›å»ºåªè¯»ç”¨æˆ·
CREATE USER 'readonly_user'@'%' IDENTIFIED BY 'password123';

-- åªæˆäºˆSELECTæƒé™
GRANT SELECT ON company_db.* TO 'readonly_user'@'%';

-- æµ‹è¯•ï¼šè¯¥ç”¨æˆ·æ— æ³•æ‰§è¡ŒUPDATE
-- UPDATE users SET status='active' WHERE user_id=1;
-- ERROR 1142: UPDATE command denied to user 'readonly_user'
```

**ğŸ”¸ å—é™æ›´æ–°è´¦æˆ·**
```sql
-- åˆ›å»ºå—é™æ›´æ–°ç”¨æˆ·
CREATE USER 'limited_updater'@'%' IDENTIFIED BY 'password123';

-- åªèƒ½æ›´æ–°ç‰¹å®šè¡¨çš„ç‰¹å®šå­—æ®µ
GRANT SELECT ON company_db.* TO 'limited_updater'@'%';
GRANT UPDATE(last_login, login_count) ON company_db.users TO 'limited_updater'@'%';

-- è¯¥ç”¨æˆ·åªèƒ½æ›´æ–°last_loginå’Œlogin_countå­—æ®µ
-- æ— æ³•æ›´æ–°salaryã€emailç­‰æ•æ„Ÿå­—æ®µ
```

**ğŸ”¸ ä¸´æ—¶æ›´æ–°æƒé™**
```sql
-- åˆ›å»ºæ•°æ®ç»´æŠ¤è´¦æˆ·
CREATE USER 'data_maintainer'@'%' IDENTIFIED BY 'password123';

-- æˆäºˆå®Œæ•´çš„æ•°æ®æ“ä½œæƒé™ï¼Œä½†é™åˆ¶è¿æ¥æ—¶é—´
GRANT SELECT, INSERT, UPDATE, DELETE ON company_db.* TO 'data_maintainer'@'%';

-- åœ¨åº”ç”¨å±‚æˆ–é€šè¿‡è´¦æˆ·ç®¡ç†ç­–ç•¥æ§åˆ¶ä½¿ç”¨æ—¶é—´
-- ä¾‹å¦‚ï¼šåªå…è®¸ç»´æŠ¤çª—å£æœŸé—´ä½¿ç”¨
```

### 5.4 æƒé™éªŒè¯æœºåˆ¶

**ğŸ”¸ æƒé™æ£€æŸ¥é¡ºåº**
```
MySQLæƒé™æ£€æŸ¥æµç¨‹ï¼š

1. è¿æ¥éªŒè¯
   â”œâ”€â”€ æ£€æŸ¥mysql.userè¡¨ä¸­çš„ç”¨æˆ·è®¤è¯ä¿¡æ¯
   â””â”€â”€ éªŒè¯ç”¨æˆ·åã€å¯†ç ã€æ¥æºIP

2. å…¨å±€æƒé™æ£€æŸ¥  
   â”œâ”€â”€ æ£€æŸ¥mysql.userè¡¨ä¸­çš„Update_privå­—æ®µ
   â””â”€â”€ å¦‚æœæœ‰å…¨å±€UPDATEæƒé™ï¼Œç›´æ¥å…è®¸

3. æ•°æ®åº“çº§æƒé™æ£€æŸ¥
   â”œâ”€â”€ æ£€æŸ¥mysql.dbè¡¨ä¸­å¯¹åº”æ•°æ®åº“çš„Update_priv
   â””â”€â”€ é’ˆå¯¹ç‰¹å®šæ•°æ®åº“çš„UPDATEæƒé™

4. è¡¨çº§æƒé™æ£€æŸ¥
   â”œâ”€â”€ æ£€æŸ¥mysql.tables_privè¡¨ä¸­çš„Table_privå­—æ®µ
   â””â”€â”€ é’ˆå¯¹ç‰¹å®šè¡¨çš„UPDATEæƒé™

5. åˆ—çº§æƒé™æ£€æŸ¥
   â”œâ”€â”€ æ£€æŸ¥mysql.columns_privè¡¨ä¸­çš„Column_privå­—æ®µ  
   â””â”€â”€ é’ˆå¯¹ç‰¹å®šåˆ—çš„UPDATEæƒé™

åŸåˆ™ï¼šä»»ä½•ä¸€ä¸ªå±‚çº§æœ‰æƒé™å°±å…è®¸æ“ä½œ
```

---

## 6. âš¡ æ‰¹é‡æ›´æ–°é£é™©æ§åˆ¶


### 6.1 æ‰¹é‡æ›´æ–°çš„é£é™©åˆ†æ

**æ‰¹é‡æ›´æ–°**æŒ‡ä¸€æ¬¡UPDATEæ“ä½œå½±å“å¤§é‡æ•°æ®è¡Œï¼Œè™½ç„¶æé«˜äº†æ•ˆç‡ï¼Œä½†ä¹Ÿå¸¦æ¥äº†é£é™©ã€‚

```
æ‰¹é‡æ›´æ–°é£é™©ç±»å‹ï¼š

æ€§èƒ½é£é™©ï¼š
â”œâ”€â”€ é•¿æ—¶é—´é”è¡¨ï¼Œå½±å“å…¶ä»–æ“ä½œ
â”œâ”€â”€ å¤§é‡æ—¥å¿—å†™å…¥ï¼Œå½±å“ç£ç›˜IO  
â””â”€â”€ å†…å­˜å ç”¨è¿‡é«˜

æ•°æ®é£é™©ï¼š
â”œâ”€â”€ ä¸€æ—¦å‡ºé”™ï¼Œå½±å“èŒƒå›´å·¨å¤§
â”œâ”€â”€ éš¾ä»¥å¿«é€Ÿå›æ»š
â””â”€â”€ å¯èƒ½è§¦å‘çº§è”æ›´æ–°

ä¸šåŠ¡é£é™©ï¼š
â”œâ”€â”€ å½±å“åœ¨çº¿ä¸šåŠ¡æ­£å¸¸è¿è¡Œ
â”œâ”€â”€ å¯èƒ½å¯¼è‡´åº”ç”¨è¶…æ—¶
â””â”€â”€ ç”¨æˆ·ä½“éªŒå—åˆ°å½±å“
```

### 6.2 æ‰¹é‡æ›´æ–°å®‰å…¨ç­–ç•¥

**ğŸ”¸ åˆ†æ‰¹å¤„ç†ç­–ç•¥**
```sql
-- âŒ å±é™©ï¼šä¸€æ¬¡æ›´æ–°æ‰€æœ‰æ•°æ®
UPDATE products SET price = price * 0.9 WHERE category_id = 1;
-- å¯èƒ½å½±å“æ•°åä¸‡æ¡è®°å½•

-- âœ… å®‰å…¨ï¼šåˆ†æ‰¹å¤„ç†
-- ç¬¬1æ‰¹
UPDATE products SET price = price * 0.9 
WHERE category_id = 1 AND product_id BETWEEN 1 AND 1000;

-- ç¬¬2æ‰¹  
UPDATE products SET price = price * 0.9
WHERE category_id = 1 AND product_id BETWEEN 1001 AND 2000;

-- ç»§ç»­åˆ†æ‰¹...
```

**ğŸ”¸ äº‹åŠ¡æ§åˆ¶åˆ†æ‰¹**
```sql
-- åœ¨äº‹åŠ¡ä¸­åˆ†æ‰¹å¤„ç†ï¼Œå¯ä»¥ä¸­é€”å›æ»š
START TRANSACTION;

-- æ‰¹æ¬¡1
UPDATE users SET status = 'migrated' 
WHERE created_at < '2023-01-01' LIMIT 1000;

-- æ£€æŸ¥ç»“æœ
SELECT COUNT(*) FROM users WHERE status = 'migrated';

-- å¦‚æœç»“æœæ­£ç¡®ï¼Œç»§ç»­ä¸‹ä¸€æ‰¹
UPDATE users SET status = 'migrated'
WHERE created_at < '2023-01-01' AND status != 'migrated' LIMIT 1000;

-- å…¨éƒ¨æ­£ç¡®åæäº¤
COMMIT;
-- å¦‚æœæœ‰é—®é¢˜å°± ROLLBACK;
```

### 6.3 æ‰¹é‡æ›´æ–°ç›‘æ§

**ğŸ”¸ æ‰§è¡Œå‰é¢„ä¼°å½±å“**
```sql
-- æ­¥éª¤1ï¼šå…ˆç”¨SELECTç»Ÿè®¡å½±å“è¡Œæ•°
SELECT COUNT(*) as affected_rows
FROM users 
WHERE department = 'IT' AND hire_date < '2020-01-01';

-- æ­¥éª¤2ï¼šå¦‚æœè¡Œæ•°åœ¨å¯æ¥å—èŒƒå›´å†…ï¼Œå†æ‰§è¡ŒUPDATE
UPDATE users 
SET employee_level = 'senior'
WHERE department = 'IT' AND hire_date < '2020-01-01';

-- æ­¥éª¤3ï¼šéªŒè¯æ›´æ–°ç»“æœ
SELECT COUNT(*) FROM users WHERE employee_level = 'senior';
```

**ğŸ”¸ è®¾ç½®æ›´æ–°è¡Œæ•°é™åˆ¶**
```sql
-- ä½¿ç”¨LIMITé™åˆ¶å•æ¬¡æ›´æ–°è¡Œæ•°
UPDATE products 
SET status = 'discontinued' 
WHERE last_sold_date < '2022-01-01'
LIMIT 500;  -- æœ€å¤šåªæ›´æ–°500è¡Œ

-- å¯ä»¥å¤šæ¬¡æ‰§è¡Œï¼Œç›´åˆ°æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„è®°å½•
-- æ¯æ¬¡æœ€å¤šå½±å“500è¡Œï¼Œé™ä½é£é™©
```

### 6.4 æ‰¹é‡æ›´æ–°æœ€ä½³å®è·µ

**ğŸ”¸ æ¸è¿›å¼æ›´æ–°è„šæœ¬**
```sql
DELIMITER //
CREATE PROCEDURE BatchUpdateWithProgress(
    IN table_name VARCHAR(100),
    IN update_condition TEXT,
    IN where_condition TEXT,
    IN batch_size INT,
    IN max_batches INT
)
BEGIN
    DECLARE batch_count INT DEFAULT 0;
    DECLARE affected_rows INT DEFAULT 0;
    DECLARE total_affected INT DEFAULT 0;
    
    -- å¾ªç¯æ‰¹é‡æ›´æ–°
    batch_loop: LOOP
        -- æ‰§è¡Œä¸€æ‰¹æ›´æ–°
        SET @sql = CONCAT(
            'UPDATE ', table_name, 
            ' SET ', update_condition,
            ' WHERE ', where_condition,
            ' LIMIT ', batch_size
        );
        
        PREPARE stmt FROM @sql;
        EXECUTE stmt;
        DEALLOCATE PREPARE stmt;
        
        -- è·å–å½±å“è¡Œæ•°
        SET affected_rows = ROW_COUNT();
        SET total_affected = total_affected + affected_rows;
        SET batch_count = batch_count + 1;
        
        -- è¾“å‡ºè¿›åº¦
        SELECT CONCAT('Batch ', batch_count, ': Updated ', affected_rows, ' rows, Total: ', total_affected) as Progress;
        
        -- é€€å‡ºæ¡ä»¶
        IF affected_rows = 0 OR batch_count >= max_batches THEN
            LEAVE batch_loop;
        END IF;
        
        -- æ‰¹æ¬¡é—´æš‚åœ
        DO SLEEP(0.1);
    END LOOP;
    
    SELECT CONCAT('Batch update completed. Total updated: ', total_affected, ' rows in ', batch_count, ' batches') as Result;
END //
DELIMITER ;

-- ä½¿ç”¨ç¤ºä¾‹
CALL BatchUpdateWithProgress(
    'users',
    'status = "active"',
    'last_login < "2023-01-01"',
    1000,  -- æ¯æ‰¹1000æ¡
    100    -- æœ€å¤š100æ‰¹
);
```

---

## 7. ğŸ“Š æ›´æ–°å½±å“è¡Œæ•°æ£€æŸ¥


### 7.1 ä¸ºä»€ä¹ˆè¦æ£€æŸ¥å½±å“è¡Œæ•°

**å½±å“è¡Œæ•°æ˜¯UPDATEæ“ä½œç»“æœçš„é‡è¦æŒ‡æ ‡**ï¼šå®ƒå‘Šè¯‰æˆ‘ä»¬å®é™…ä¿®æ”¹äº†å¤šå°‘æ¡æ•°æ®ã€‚

```
å½±å“è¡Œæ•°çš„æ„ä¹‰ï¼š

é¢„æœŸéªŒè¯ï¼š
- é¢„æœŸæ›´æ–°1æ¡ â†’ å½±å“è¡Œæ•°åº”è¯¥æ˜¯1
- é¢„æœŸæ›´æ–°100æ¡ â†’ å½±å“è¡Œæ•°åº”è¯¥æ˜¯100
- å¦‚æœä¸ç¬¦åˆï¼Œè¯´æ˜WHEREæ¡ä»¶æœ‰é—®é¢˜

å®‰å…¨æ£€æŸ¥ï¼š
- å½±å“è¡Œæ•°ä¸º0 â†’ å¯èƒ½WHEREæ¡ä»¶å†™é”™ï¼Œæ²¡æœ‰åŒ¹é…åˆ°æ•°æ®
- å½±å“è¡Œæ•°è¿‡å¤š â†’ å¯èƒ½WHEREæ¡ä»¶å¤ªå®½æ³›ï¼Œå½±å“äº†ä¸è¯¥ä¿®æ”¹çš„æ•°æ®
- å½±å“è¡Œæ•°å¼‚å¸¸ â†’ éœ€è¦ç«‹å³æ£€æŸ¥å’Œå›æ»š
```

### 7.2 è·å–UPDATEå½±å“è¡Œæ•°

**ğŸ”¸ ä½¿ç”¨ROW_COUNT()å‡½æ•°**
```sql
-- æ‰§è¡ŒUPDATEæ“ä½œ
UPDATE users SET last_login = NOW() WHERE user_id = 1001;

-- ç«‹å³æŸ¥çœ‹å½±å“è¡Œæ•°
SELECT ROW_COUNT() as affected_rows;
-- è¿”å›ï¼š1ï¼ˆå¦‚æœç”¨æˆ·å­˜åœ¨ï¼‰æˆ– 0ï¼ˆå¦‚æœç”¨æˆ·ä¸å­˜åœ¨ï¼‰

-- æ³¨æ„ï¼šROW_COUNT()å¿…é¡»åœ¨UPDATEåç«‹å³è°ƒç”¨
-- å…¶ä»–è¯­å¥ä¼šé‡ç½®è¿™ä¸ªå€¼
```

**ğŸ”¸ åœ¨å­˜å‚¨è¿‡ç¨‹ä¸­æ£€æŸ¥**
```sql
DELIMITER //
CREATE PROCEDURE SafeUserUpdate(
    IN p_user_id INT,
    IN p_new_status VARCHAR(20)
)
BEGIN
    DECLARE affected_count INT;
    
    -- æ‰§è¡Œæ›´æ–°
    UPDATE users 
    SET status = p_new_status, updated_at = NOW()
    WHERE user_id = p_user_id AND status != p_new_status;
    
    -- æ£€æŸ¥å½±å“è¡Œæ•°
    SET affected_count = ROW_COUNT();
    
    -- æ ¹æ®å½±å“è¡Œæ•°åˆ¤æ–­ç»“æœ
    IF affected_count = 0 THEN
        SELECT 'No rows updated - user not found or already has this status' as result;
    ELSEIF affected_count = 1 THEN
        SELECT 'User updated successfully' as result;
    ELSE
        SELECT CONCAT('Warning: ', affected_count, ' rows affected - unexpected result') as result;
    END IF;
END //
DELIMITER ;

-- ä½¿ç”¨ç¤ºä¾‹
CALL SafeUserUpdate(1001, 'active');
```

### 7.3 å½±å“è¡Œæ•°å¼‚å¸¸å¤„ç†

**ğŸ”¸ å½±å“è¡Œæ•°ä¸º0çš„å¤„ç†**
```sql
-- æ–¹æ¡ˆ1ï¼šå…ˆæ£€æŸ¥æ•°æ®æ˜¯å¦å­˜åœ¨
SELECT COUNT(*) as user_count FROM users WHERE user_id = 1001;
-- å¦‚æœä¸º0ï¼Œè¯´æ˜ç”¨æˆ·ä¸å­˜åœ¨

-- æ–¹æ¡ˆ2ï¼šä½¿ç”¨UPDATE+æ£€æŸ¥ç»„åˆ
UPDATE users SET last_login = NOW() WHERE user_id = 1001;

IF ROW_COUNT() = 0 THEN
    -- ç”¨æˆ·ä¸å­˜åœ¨çš„å¤„ç†é€»è¾‘
    SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'User not found';
END IF;
```

**ğŸ”¸ å½±å“è¡Œæ•°è¿‡å¤šçš„å¤„ç†**
```sql
-- è®¾ç½®å½±å“è¡Œæ•°ä¸Šé™æ£€æŸ¥
UPDATE products SET price = price * 0.9 WHERE category_id = 1;

SET @affected = ROW_COUNT();
IF @affected > 10000 THEN
    -- å½±å“è¡Œæ•°å¤ªå¤šï¼Œå¯èƒ½æœ‰é—®é¢˜
    ROLLBACK;
    SELECT CONCAT('ERROR: Too many rows affected (', @affected, '). Operation rolled back.') as error_message;
ELSE
    COMMIT;
    SELECT CONCAT('Success: ', @affected, ' rows updated.') as success_message;
END IF;
```

### 7.4 UPDATEç»“æœéªŒè¯

**ğŸ”¸ æ›´æ–°å‰åæ•°æ®å¯¹æ¯”**
```sql
-- æ­¥éª¤1ï¼šè®°å½•æ›´æ–°å‰çŠ¶æ€
CREATE TEMPORARY TABLE update_verification AS
SELECT user_id, status, updated_at 
FROM users 
WHERE department = 'IT';

-- æ­¥éª¤2ï¼šæ‰§è¡Œæ›´æ–°
UPDATE users 
SET status = 'senior', updated_at = NOW()
WHERE department = 'IT' AND hire_date < '2020-01-01';

-- æ­¥éª¤3ï¼šéªŒè¯æ›´æ–°ç»“æœ
SELECT 
    u.user_id,
    v.status as old_status,
    u.status as new_status,
    v.updated_at as old_updated_at,
    u.updated_at as new_updated_at
FROM users u
JOIN update_verification v ON u.user_id = v.user_id
WHERE u.status != v.status;

-- æ­¥éª¤4ï¼šç»Ÿè®¡éªŒè¯
SELECT 
    COUNT(*) as total_in_dept,
    SUM(CASE WHEN status = 'senior' THEN 1 ELSE 0 END) as senior_count,
    ROW_COUNT() as last_operation_affected
FROM users 
WHERE department = 'IT';
```

---

## 8. ğŸ”’ æ•æ„Ÿå­—æ®µæ›´æ–°æƒé™


### 8.1 æ•æ„Ÿå­—æ®µè¯†åˆ«

**æ•æ„Ÿå­—æ®µ**ï¼šåŒ…å«é‡è¦ä¸šåŠ¡ä¿¡æ¯æˆ–ä¸ªäººéšç§ä¿¡æ¯ï¼Œéœ€è¦ç‰¹æ®Šä¿æŠ¤çš„æ•°æ®åº“å­—æ®µã€‚

```
æ•æ„Ÿå­—æ®µåˆ†ç±»ï¼š

è´¢åŠ¡ç›¸å…³ï¼š
â”œâ”€â”€ salaryï¼ˆè–ªèµ„ï¼‰
â”œâ”€â”€ bonusï¼ˆå¥–é‡‘ï¼‰ 
â”œâ”€â”€ account_balanceï¼ˆè´¦æˆ·ä½™é¢ï¼‰
â””â”€â”€ payment_infoï¼ˆæ”¯ä»˜ä¿¡æ¯ï¼‰

ä¸ªäººéšç§ï¼š
â”œâ”€â”€ ssnï¼ˆèº«ä»½è¯å·ï¼‰
â”œâ”€â”€ phoneï¼ˆæ‰‹æœºå·ï¼‰
â”œâ”€â”€ emailï¼ˆé‚®ç®±ï¼‰
â””â”€â”€ addressï¼ˆåœ°å€ï¼‰

ä¸šåŠ¡å…³é”®ï¼š
â”œâ”€â”€ user_levelï¼ˆç”¨æˆ·ç­‰çº§ï¼‰
â”œâ”€â”€ credit_scoreï¼ˆä¿¡ç”¨åˆ†æ•°ï¼‰
â”œâ”€â”€ permissionsï¼ˆæƒé™ä¿¡æ¯ï¼‰
â””â”€â”€ statusï¼ˆçŠ¶æ€å­—æ®µï¼‰

å®¡è®¡ç›¸å…³ï¼š
â”œâ”€â”€ created_atï¼ˆåˆ›å»ºæ—¶é—´ï¼‰
â”œâ”€â”€ created_byï¼ˆåˆ›å»ºäººï¼‰
â”œâ”€â”€ deleted_atï¼ˆåˆ é™¤æ—¶é—´ï¼‰
â””â”€â”€ versionï¼ˆç‰ˆæœ¬å·ï¼‰
```

### 8.2 åˆ—çº§æƒé™æ§åˆ¶

**ğŸ”¸ åˆ›å»ºæ•æ„Ÿå­—æ®µä¸“ç”¨æƒé™**
```sql
-- åˆ›å»ºHRä¸“å‘˜è´¦æˆ·ï¼Œåªèƒ½æ›´æ–°è–ªèµ„ç›¸å…³å­—æ®µ
CREATE USER 'hr_specialist'@'%' IDENTIFIED BY 'secure_password123';

-- åŸºç¡€æŸ¥çœ‹æƒé™
GRANT SELECT ON company_db.employees TO 'hr_specialist'@'%';

-- åªå…è®¸æ›´æ–°è–ªèµ„ç›¸å…³å­—æ®µ
GRANT UPDATE(salary, bonus, salary_grade) ON company_db.employees TO 'hr_specialist'@'%';

-- è¯¥ç”¨æˆ·æ— æ³•æ›´æ–°å…¶ä»–æ•æ„Ÿå­—æ®µå¦‚emailã€phoneç­‰
```

**ğŸ”¸ åˆ›å»ºå®¢æœæƒé™è´¦æˆ·**
```sql
-- å®¢æœäººå‘˜ï¼Œåªèƒ½æ›´æ–°è”ç³»ä¿¡æ¯
CREATE USER 'customer_service'@'%' IDENTIFIED BY 'cs_password123';

GRANT SELECT ON company_db.customers TO 'customer_service'@'%';
GRANT UPDATE(phone, email, address, contact_preference) ON company_db.customers TO 'customer_service'@'%';

-- æ— æ³•æ›´æ–°account_balanceã€credit_scoreç­‰è´¢åŠ¡å­—æ®µ
```

### 8.3 æ•æ„Ÿå­—æ®µæ›´æ–°å®¡è®¡

**ğŸ”¸ æ•æ„Ÿå­—æ®µå˜æ›´è®°å½•**
```sql
-- åˆ›å»ºæ•æ„Ÿå­—æ®µå˜æ›´æ—¥å¿—è¡¨
CREATE TABLE sensitive_field_audit (
    audit_id INT PRIMARY KEY AUTO_INCREMENT,
    table_name VARCHAR(100),
    record_id INT,
    field_name VARCHAR(100),
    old_value TEXT,
    new_value TEXT,
    changed_by VARCHAR(100),
    changed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    change_reason TEXT,
    approved_by VARCHAR(100)
);

-- åˆ›å»ºè§¦å‘å™¨è®°å½•æ•æ„Ÿå­—æ®µå˜æ›´
DELIMITER //
CREATE TRIGGER tr_employees_salary_audit
AFTER UPDATE ON employees
FOR EACH ROW
BEGIN
    -- è®°å½•salaryå­—æ®µå˜æ›´
    IF OLD.salary != NEW.salary THEN
        INSERT INTO sensitive_field_audit (
            table_name, record_id, field_name, 
            old_value, new_value, changed_by
        ) VALUES (
            'employees', NEW.employee_id, 'salary',
            OLD.salary, NEW.salary, USER()
        );
    END IF;
    
    -- è®°å½•bonuså­—æ®µå˜æ›´
    IF OLD.bonus != NEW.bonus THEN
        INSERT INTO sensitive_field_audit (
            table_name, record_id, field_name,
            old_value, new_value, changed_by
        ) VALUES (
            'employees', NEW.employee_id, 'bonus',
            OLD.bonus, NEW.bonus, USER()
        );
    END IF;
END //
DELIMITER ;
```

### 8.4 æ•æ„Ÿå­—æ®µæ›´æ–°æµç¨‹

**ğŸ”¸ å¤šçº§å®¡æ‰¹æ›´æ–°æµç¨‹**
```sql
-- æ•æ„Ÿå­—æ®µæ›´æ–°ç”³è¯·è¡¨
CREATE TABLE sensitive_update_requests (
    request_id INT PRIMARY KEY AUTO_INCREMENT,
    table_name VARCHAR(100),
    record_id INT,
    field_name VARCHAR(100),
    current_value TEXT,
    requested_value TEXT,
    requester VARCHAR(100),
    reason TEXT,
    status ENUM('pending', 'approved', 'rejected') DEFAULT 'pending',
    requested_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    approver VARCHAR(100),
    approved_at TIMESTAMP NULL,
    executed_at TIMESTAMP NULL
);

-- æ•æ„Ÿå­—æ®µæ›´æ–°æ‰§è¡Œæµç¨‹
DELIMITER //
CREATE PROCEDURE ExecuteSensitiveUpdate(
    IN p_request_id INT
)
BEGIN
    DECLARE v_table_name VARCHAR(100);
    DECLARE v_record_id INT;
    DECLARE v_field_name VARCHAR(100);
    DECLARE v_new_value TEXT;
    DECLARE v_status VARCHAR(20);
    
    -- è·å–ç”³è¯·ä¿¡æ¯
    SELECT table_name, record_id, field_name, requested_value, status
    INTO v_table_name, v_record_id, v_field_name, v_new_value, v_status
    FROM sensitive_update_requests
    WHERE request_id = p_request_id;
    
    -- æ£€æŸ¥ç”³è¯·çŠ¶æ€
    IF v_status != 'approved' THEN
        SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'Request not approved';
    END IF;
    
    -- æ‰§è¡Œæ›´æ–°ï¼ˆè¿™é‡Œéœ€è¦æ ¹æ®å…·ä½“è¡¨å’Œå­—æ®µåŠ¨æ€æ„å»ºSQLï¼‰
    -- ä¸ºäº†å®‰å…¨ï¼Œå»ºè®®é’ˆå¯¹æ¯ç§æ•æ„Ÿå­—æ®µå†™ä¸“é—¨çš„æ›´æ–°é€»è¾‘
    
    -- æ›´æ–°ç”³è¯·çŠ¶æ€
    UPDATE sensitive_update_requests 
    SET executed_at = NOW()
    WHERE request_id = p_request_id;
    
END //
DELIMITER ;
```

---

## 9. ğŸ“‹ å®‰å…¨æ›´æ–°æµç¨‹è§„èŒƒ


### 9.1 æ ‡å‡†å®‰å…¨æ›´æ–°æµç¨‹

**ä¼ä¸šçº§UPDATEæ“ä½œå¿…é¡»éµå¾ªæ ‡å‡†æµç¨‹**ï¼Œç¡®ä¿æ•°æ®å®‰å…¨å’Œæ“ä½œå¯è¿½æº¯ã€‚

```
å®‰å…¨æ›´æ–°æµç¨‹ï¼ˆ6ä¸ªæ­¥éª¤ï¼‰ï¼š

1. éœ€æ±‚è¯„ä¼° â†’ ç¡®è®¤æ›´æ–°çš„å¿…è¦æ€§å’Œå½±å“èŒƒå›´
2. æƒé™ç”³è¯· â†’ ç”³è¯·ç›¸åº”çš„æ•°æ®åº“æ“ä½œæƒé™  
3. å¤‡ä»½å‡†å¤‡ â†’ åˆ›å»ºæ•°æ®å¤‡ä»½å’Œå›æ»šæ–¹æ¡ˆ
4. æµ‹è¯•éªŒè¯ â†’ åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯æ›´æ–°é€»è¾‘
5. ç”Ÿäº§æ‰§è¡Œ â†’ åœ¨ç”Ÿäº§ç¯å¢ƒå°å¿ƒæ‰§è¡Œæ›´æ–°
6. ç»“æœéªŒè¯ â†’ éªŒè¯æ›´æ–°ç»“æœå’Œæ•°æ®å®Œæ•´æ€§
```

### 9.2 æ›´æ–°å‰æ£€æŸ¥æ¸…å•

**ğŸ”¸ æŠ€æœ¯æ£€æŸ¥æ¸…å•**
```
â–¡ WHEREæ¡ä»¶æ˜¯å¦ç²¾ç¡®ï¼Ÿ
  - æ˜¯å¦ä½¿ç”¨ä¸»é”®æˆ–å”¯ä¸€é”®
  - æ¡ä»¶æ˜¯å¦ä¼šåŒ¹é…åˆ°é¢„æœŸçš„è¡Œæ•°
  - æ˜¯å¦æœ‰é¢å¤–çš„å®‰å…¨é™åˆ¶æ¡ä»¶

â–¡ æ•°æ®å¤‡ä»½æ˜¯å¦å®Œæˆï¼Ÿ
  - æ˜¯å¦å¤‡ä»½äº†è¦ä¿®æ”¹çš„æ•°æ®
  - å¤‡ä»½æ•°æ®æ˜¯å¦å¯ä»¥æ­£å¸¸æ¢å¤
  - å›æ»šæ–¹æ¡ˆæ˜¯å¦å‡†å¤‡å°±ç»ª

â–¡ UPDATEè¯­å¥æ˜¯å¦å®‰å…¨ï¼Ÿ
  - SETå­å¥æ˜¯å¦æ­£ç¡®
  - æ˜¯å¦ä¼šé€ æˆæ•°æ®ç±»å‹è½¬æ¢é—®é¢˜
  - æ˜¯å¦ä¼šè§¦å‘æ„å¤–çš„çº¦æŸæ£€æŸ¥

â–¡ æƒé™æ˜¯å¦å……è¶³ï¼Ÿ
  - å½“å‰ç”¨æˆ·æ˜¯å¦æœ‰UPDATEæƒé™
  - æ˜¯å¦æœ‰ç›¸å…³è¡¨çš„SELECTæƒé™ï¼ˆç”¨äºWHEREæ¡ä»¶ï¼‰
  - æ“ä½œæ˜¯å¦åœ¨æˆæƒæ—¶é—´çª—å£å†…

â–¡ å½±å“è¯„ä¼°æ˜¯å¦å®Œæˆï¼Ÿ
  - é¢„è®¡å½±å“å¤šå°‘è¡Œæ•°æ®
  - æ˜¯å¦ä¼šå½±å“åœ¨çº¿ä¸šåŠ¡
  - æ˜¯å¦éœ€è¦åœ¨ç»´æŠ¤çª—å£æœŸæ‰§è¡Œ
```

**ğŸ”¸ ä¸šåŠ¡æ£€æŸ¥æ¸…å•**
```
â–¡ ä¸šåŠ¡éœ€æ±‚æ˜¯å¦æ˜ç¡®ï¼Ÿ
  - æ›´æ–°çš„ä¸šåŠ¡é€»è¾‘æ˜¯å¦æ­£ç¡®
  - æ•°æ®å˜æ›´æ˜¯å¦ç¬¦åˆä¸šåŠ¡è§„åˆ™
  - ç›¸å…³ä¸šåŠ¡éƒ¨é—¨æ˜¯å¦å·²ç¡®è®¤

â–¡ å½±å“åˆ†ææ˜¯å¦å……åˆ†ï¼Ÿ
  - ä¸‹æ¸¸ç³»ç»Ÿæ˜¯å¦ä¼šå—åˆ°å½±å“
  - æŠ¥è¡¨å’Œç»Ÿè®¡æ˜¯å¦éœ€è¦åŒæ­¥æ›´æ–°
  - ç”¨æˆ·ä½“éªŒæ˜¯å¦ä¼šå—åˆ°å½±å“

â–¡ åº”æ€¥é¢„æ¡ˆæ˜¯å¦å‡†å¤‡ï¼Ÿ
  - å¦‚æœæ›´æ–°å¤±è´¥å¦‚ä½•å¤„ç†
  - å¦‚ä½•å¿«é€Ÿå›æ»šæ•°æ®
  - ç´§æ€¥è”ç³»äººæ˜¯å¦å°±ç»ª
```

### 9.3 åˆ†ç¯å¢ƒæ›´æ–°ç­–ç•¥

**ğŸ”¸ å¼€å‘ç¯å¢ƒï¼ˆDevelopmentï¼‰**
```sql
-- å¼€å‘ç¯å¢ƒç›¸å¯¹å®½æ¾ï¼Œä½†ä»è¦å…»æˆå¥½ä¹ æƒ¯
-- å¯ç”¨å®‰å…¨æ¨¡å¼
SET sql_safe_updates = 1;

-- å…ˆç”¨SELECTéªŒè¯
SELECT COUNT(*) FROM users WHERE status = 'inactive';

-- æ‰§è¡Œæ›´æ–°
UPDATE users SET status = 'active' WHERE status = 'inactive';

-- éªŒè¯ç»“æœ
SELECT COUNT(*) FROM users WHERE status = 'active';
```

**ğŸ”¸ æµ‹è¯•ç¯å¢ƒï¼ˆTestingï¼‰**
```sql
-- æµ‹è¯•ç¯å¢ƒè¦æ¨¡æ‹Ÿç”Ÿäº§ç¯å¢ƒæµç¨‹
-- 1. åˆ›å»ºå¤‡ä»½
CREATE TABLE users_backup_test AS SELECT * FROM users WHERE status = 'inactive';

-- 2. æ‰§è¡Œæ›´æ–°
UPDATE users SET status = 'active' WHERE status = 'inactive';

-- 3. éªŒè¯ç»“æœ
SELECT COUNT(*) as updated_count FROM users WHERE status = 'active';

-- 4. å¦‚æœæµ‹è¯•å¤±è´¥ï¼Œå›æ»šæ•°æ®
-- INSERT INTO users SELECT * FROM users_backup_test;
```

**ğŸ”¸ ç”Ÿäº§ç¯å¢ƒï¼ˆProductionï¼‰**
```sql
-- ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä¸¥æ ¼æŒ‰æµç¨‹æ‰§è¡Œ
-- 1. åœ¨ç»´æŠ¤çª—å£æœŸæ‰§è¡Œ
-- 2. å¿…é¡»æœ‰å®Œæ•´å¤‡ä»½
-- 3. å¿…é¡»æœ‰ç›‘æ§å’ŒéªŒè¯
-- 4. å¿…é¡»æœ‰å¿«é€Ÿå›æ»šèƒ½åŠ›

-- ç¤ºä¾‹ï¼šç”Ÿäº§ç¯å¢ƒå®‰å…¨æ›´æ–°
START TRANSACTION;

-- åˆ›å»ºå›æ»šç‚¹
SAVEPOINT before_update;

-- æ‰§è¡Œæ›´æ–°
UPDATE critical_table SET status = 'processed' 
WHERE order_date = '2024-01-01' AND status = 'pending';

-- æ£€æŸ¥å½±å“è¡Œæ•°
SET @affected = ROW_COUNT();
IF @affected != 1000 THEN  -- é¢„æœŸåº”è¯¥æ˜¯1000è¡Œ
    ROLLBACK TO SAVEPOINT before_update;
    SELECT 'Update failed - unexpected row count' as error;
ELSE
    COMMIT;
    SELECT 'Update successful' as success;
END IF;
```

### 9.4 æ›´æ–°æ“ä½œæ–‡æ¡£åŒ–

**ğŸ”¸ æ›´æ–°æ“ä½œè®°å½•æ¨¡æ¿**
```
æ›´æ–°æ“ä½œè®°å½•
================
æ“ä½œæ—¶é—´ï¼š2024-01-01 10:30:00
æ“ä½œäººå‘˜ï¼šå¼ ä¸‰
æ“ä½œç›®çš„ï¼šä¿®å¤è®¢å•çŠ¶æ€å¼‚å¸¸
å½±å“èŒƒå›´ï¼šordersè¡¨ï¼Œçº¦1000æ¡è®°å½•

æ›´æ–°è¯­å¥ï¼š
UPDATE orders 
SET status = 'shipped', updated_at = NOW()
WHERE order_date = '2023-12-01' AND status = 'processing';

æ‰§è¡Œç»“æœï¼š
- å½±å“è¡Œæ•°ï¼š1000
- æ‰§è¡Œæ—¶é—´ï¼š2.3ç§’
- æ— é”™è¯¯å‘ç”Ÿ

éªŒè¯ç»“æœï¼š
- çŠ¶æ€ä¸ºshippedçš„è®¢å•æ•°é‡ï¼š15000 â†’ 16000
- æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥ï¼šé€šè¿‡
- ä¸šåŠ¡æµç¨‹æµ‹è¯•ï¼šæ­£å¸¸

å¤‡ä»½ä¿¡æ¯ï¼š
- å¤‡ä»½è¡¨ï¼šorders_backup_20240101
- å¤‡ä»½è®°å½•æ•°ï¼š1000
- å›æ»šè„šæœ¬ï¼šå·²å‡†å¤‡

å®¡æ‰¹è®°å½•ï¼š
- ç”³è¯·äººï¼šå¼ ä¸‰
- å®¡æ‰¹äººï¼šæå››ï¼ˆDBAï¼‰
- ä¸šåŠ¡ç¡®è®¤ï¼šç‹äº”ï¼ˆä¸šåŠ¡è´Ÿè´£äººï¼‰
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ

```
ğŸ”¸ UPDATEå®‰å…¨é£é™©ï¼šå¿˜è®°WHEREæ¡ä»¶æ˜¯æœ€å¤§é£é™©ï¼Œå¯èƒ½ç ´åæ‰€æœ‰æ•°æ®
ğŸ”¸ sql_safe_updatesï¼šMySQLæä¾›çš„å®‰å…¨æ¨¡å¼ï¼Œé˜²æ­¢å±é™©çš„UPDATEæ“ä½œ
ğŸ”¸ æ•°æ®å¤‡ä»½é‡è¦æ€§ï¼šUPDATEæ“ä½œçš„"åæ‚”è¯"ï¼Œå¿…é¡»åœ¨æ›´æ–°å‰åˆ›å»º
ğŸ”¸ æƒé™æœ€å°åŒ–åŸåˆ™ï¼šåªç»™å¿…è¦çš„UPDATEæƒé™ï¼Œç‰¹åˆ«æ˜¯æ•æ„Ÿå­—æ®µ
ğŸ”¸ å½±å“è¡Œæ•°æ£€æŸ¥ï¼šROW_COUNT()æ˜¯éªŒè¯UPDATEç»“æœçš„é‡è¦æŒ‡æ ‡
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ WHEREæ¡ä»¶æ˜¯UPDATEçš„æ ¸å¿ƒå®‰å…¨æœºåˆ¶**
```
å®‰å…¨åŸåˆ™ï¼š
- æ°¸è¿œä¸è¦å†™æ²¡æœ‰WHEREæ¡ä»¶çš„UPDATE
- WHEREæ¡ä»¶è¦ä½¿ç”¨ä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•
- å…ˆç”¨SELECTéªŒè¯WHEREæ¡ä»¶çš„æ­£ç¡®æ€§
- æ·»åŠ LIMITé™åˆ¶æœ€å¤§å½±å“è¡Œæ•°

è®°å¿†å£è¯€ï¼š
UPDATEå‰å…ˆSELECTï¼Œæ¡ä»¶ç²¾ç¡®è¦ä»”ç»†
ä¸»é”®å”¯ä¸€æœ€å®‰å…¨ï¼Œå½±å“è¡Œæ•°è¦é¢„æœŸ
```

**ğŸ”¹ æƒé™æ§åˆ¶çš„å±‚æ¬¡æ€§**
```
æƒé™è®¾è®¡åŸåˆ™ï¼š
- æŒ‰éœ€åˆ†é…ï¼šåªç»™å¿…è¦çš„æƒé™
- æœ€å°æƒé™ï¼šèƒ½å®Œæˆå·¥ä½œçš„æœ€å°æƒé™é›†
- å®šæœŸå®¡æŸ¥ï¼šå®šæœŸæ£€æŸ¥æƒé™ä½¿ç”¨æƒ…å†µ
- æ•æ„Ÿéš”ç¦»ï¼šæ•æ„Ÿå­—æ®µéœ€è¦ç‰¹æ®Šæƒé™

å®é™…åº”ç”¨ï¼š
- æ™®é€šå¼€å‘ï¼šåªç»™å¼€å‘åº“UPDATEæƒé™
- æ•°æ®åˆ†æå¸ˆï¼šåªç»™SELECTæƒé™
- DBAï¼šå®Œæ•´æƒé™ä½†è¦å®¡è®¡
- ä¸šåŠ¡äººå‘˜ï¼šç‰¹å®šè¡¨çš„ç‰¹å®šå­—æ®µæƒé™
```

**ğŸ”¹ æ‰¹é‡æ›´æ–°çš„é£é™©ç®¡ç†**
```
æ‰¹é‡æ›´æ–°åŸåˆ™ï¼š
- åˆ†æ‰¹å¤„ç†ï¼šå¤§é‡æ•°æ®è¦åˆ†æ‰¹æ›´æ–°
- äº‹åŠ¡æ§åˆ¶ï¼šä½¿ç”¨äº‹åŠ¡ç¡®ä¿ä¸€è‡´æ€§
- è¿›åº¦ç›‘æ§ï¼šæ˜¾ç¤ºæ›´æ–°è¿›åº¦
- å½±å“è¯„ä¼°ï¼šé¢„ä¼°å¯¹ç³»ç»Ÿçš„å½±å“

åˆ†æ‰¹ç­–ç•¥ï¼š
- å°æ‰¹é‡ï¼šæ¯æ‰¹1000-5000æ¡è®°å½•
- é—´éš”æ‰§è¡Œï¼šæ‰¹æ¬¡é—´é€‚å½“åœé¡¿
- ç›‘æ§æ£€æŸ¥ï¼šæ¯æ‰¹åæ£€æŸ¥ç»“æœ
- éšæ—¶å›æ»šï¼šå‘ç°é—®é¢˜ç«‹å³åœæ­¢
```

### 10.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ”¸ æ–°æ‰‹å®‰å…¨æ“ä½œå»ºè®®**
```
ç¬¬ä¸€æ¬¡æ‰§è¡ŒUPDATEï¼š
âœ… å¯ç”¨ SET sql_safe_updates = 1
âœ… å…ˆç”¨SELECTæµ‹è¯•WHEREæ¡ä»¶
âœ… ä½¿ç”¨LIMITé™åˆ¶å½±å“èŒƒå›´
âœ… åœ¨äº‹åŠ¡ä¸­æ‰§è¡Œï¼Œä¾¿äºå›æ»š
âœ… æ£€æŸ¥ROW_COUNT()ç¡®è®¤ç»“æœ

é¿å…çš„å±é™©æ“ä½œï¼š
âŒ ç›´æ¥åœ¨ç”Ÿäº§ç¯å¢ƒæµ‹è¯•UPDATE
âŒ ä¸å¤‡ä»½å°±æ‰§è¡Œå¤§é‡æ•°æ®æ›´æ–°
âŒ å¿½ç•¥WHEREæ¡ä»¶çš„ç²¾ç¡®æ€§
âŒ ä¸æ£€æŸ¥UPDATEçš„å½±å“è¡Œæ•°
âŒ åœ¨é«˜å³°æœŸæ‰§è¡Œæ‰¹é‡æ›´æ–°
```

**ğŸ”¸ ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ**
```
ç”Ÿäº§UPDATEæ“ä½œæµç¨‹ï¼š
1. éœ€æ±‚åˆ†æ â†’ æ˜ç¡®æ›´æ–°ç›®çš„å’ŒèŒƒå›´
2. æµ‹è¯•éªŒè¯ â†’ åœ¨æµ‹è¯•ç¯å¢ƒå®Œæ•´æµ‹è¯•
3. æƒé™ç”³è¯· â†’ ç”³è¯·æœ€å°å¿…è¦æƒé™
4. æ•°æ®å¤‡ä»½ â†’ åˆ›å»ºå¯é çš„æ•°æ®å¤‡ä»½
5. çª—å£æ‰§è¡Œ â†’ åœ¨ç»´æŠ¤çª—å£æœŸæ‰§è¡Œ
6. ç»“æœéªŒè¯ â†’ å…¨é¢éªŒè¯æ›´æ–°ç»“æœ
7. æ–‡æ¡£è®°å½• â†’ è®°å½•æ“ä½œè¿‡ç¨‹å’Œç»“æœ

åº”æ€¥å¤„ç†ï¼š
- å‘ç°é—®é¢˜ç«‹å³åœæ­¢æ“ä½œ
- å¿«é€Ÿå›æ»šåˆ°å¤‡ä»½çŠ¶æ€
- åˆ†æé—®é¢˜æ ¹æœ¬åŸå› 
- ä¿®æ­£åé‡æ–°æ‰§è¡Œæµç¨‹
```

**ğŸ”¸ å¸¸è§é—®é¢˜æ’æŸ¥**
```
UPDATEä¸ç”Ÿæ•ˆæ’æŸ¥ï¼š
1. æ£€æŸ¥WHEREæ¡ä»¶æ˜¯å¦æ­£ç¡®
2. æ£€æŸ¥æ•°æ®ç±»å‹æ˜¯å¦åŒ¹é…
3. æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿæƒé™
4. æ£€æŸ¥è¡¨æ˜¯å¦è¢«é”å®š
5. æ£€æŸ¥çº¦æŸæ¡ä»¶æ˜¯å¦æ»¡è¶³

UPDATEå½±å“è¡Œæ•°å¼‚å¸¸ï¼š
1. é‡æ–°å®¡æŸ¥WHEREæ¡ä»¶é€»è¾‘
2. æ£€æŸ¥æ•°æ®æ˜¯å¦å­˜åœ¨
3. ç¡®è®¤æ•°æ®ç±»å‹è½¬æ¢
4. éªŒè¯ç´¢å¼•ä½¿ç”¨æƒ…å†µ
5. åˆ†ææ‰§è¡Œè®¡åˆ’
```

**æ ¸å¿ƒè®°å¿†åŸåˆ™**ï¼š
```
UPDATEæ“ä½œä¸‰è¦ç´ ï¼šWHEREç²¾ç¡®ã€å¤‡ä»½å…ˆè¡Œã€æƒé™æœ€å°
å®‰å…¨æ›´æ–°å››æ­¥éª¤ï¼šæµ‹è¯•éªŒè¯ã€æƒé™ç”³è¯·ã€å¤‡ä»½æ‰§è¡Œã€ç»“æœæ£€æŸ¥
æ•æ„Ÿå­—æ®µäº”åŸåˆ™ï¼šæƒé™éš”ç¦»ã€æ“ä½œå®¡è®¡ã€å¤šçº§å®¡æ‰¹ã€å˜æ›´è®°å½•ã€å®šæœŸå®¡æŸ¥
```