---
title: 6ã€ä¸´æ—¶è¡¨æ€§èƒ½å½±å“
---
## ğŸ“š ç›®å½•

1. [ä¸´æ—¶è¡¨æ€§èƒ½æ¦‚è¿°](#1-ä¸´æ—¶è¡¨æ€§èƒ½æ¦‚è¿°)
2. [ä¸´æ—¶è¡¨åˆ›å»ºå¼€é”€åˆ†æ](#2-ä¸´æ—¶è¡¨åˆ›å»ºå¼€é”€åˆ†æ)
3. [ç£ç›˜IOå½±å“è¯¦è§£](#3-ç£ç›˜IOå½±å“è¯¦è§£)
4. [å†…å­˜ä½¿ç”¨åˆ†æ](#4-å†…å­˜ä½¿ç”¨åˆ†æ)
5. [é”ç«äº‰å½±å“](#5-é”ç«äº‰å½±å“)
6. [å¹¶å‘æ€§èƒ½å½±å“](#6-å¹¶å‘æ€§èƒ½å½±å“)
7. [ä¸´æ—¶è¡¨ç©ºé—´ç®¡ç†](#7-ä¸´æ—¶è¡¨ç©ºé—´ç®¡ç†)
8. [æ€§èƒ½ç›‘æ§æŒ‡æ ‡](#8-æ€§èƒ½ç›‘æ§æŒ‡æ ‡)
9. [tmpdiré…ç½®ä¼˜åŒ–](#9-tmpdiré…ç½®ä¼˜åŒ–)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” ä¸´æ—¶è¡¨æ€§èƒ½æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯ä¸´æ—¶è¡¨æ€§èƒ½å½±å“


**åŸºæœ¬æ¦‚å¿µ**ï¼šä¸´æ—¶è¡¨æ˜¯MySQLåœ¨æ‰§è¡Œå¤æ‚æŸ¥è¯¢æ—¶è‡ªåŠ¨åˆ›å»ºçš„è¾…åŠ©è¡¨ç»“æ„ï¼Œç”¨æ¥å­˜å‚¨ä¸­é—´ç»“æœã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šå¯¹æ•°æ®åº“æ€§èƒ½äº§ç”Ÿæ˜¾è‘—å½±å“ã€‚

```
ç®€å•ç†è§£ï¼š
æ™®é€šæŸ¥è¯¢ï¼šç›´æ¥ä»è¡¨ä¸­å–æ•°æ® â†’ è¿”å›ç»“æœ
å¤æ‚æŸ¥è¯¢ï¼šåŸè¡¨æ•°æ® â†’ åˆ›å»ºä¸´æ—¶è¡¨ â†’ å¤„ç†æ•°æ® â†’ è¿”å›ç»“æœ
            â†‘
        è¿™ä¸€æ­¥å°±æ˜¯æ€§èƒ½å¼€é”€
```

**ä¸ºä»€ä¹ˆä¼šå½±å“æ€§èƒ½**ï¼š
- **é¢å¤–èµ„æºæ¶ˆè€—**ï¼šéœ€è¦åˆ†é…å†…å­˜æˆ–ç£ç›˜ç©ºé—´
- **æ•°æ®æ¬è¿æˆæœ¬**ï¼šåŸè¡¨æ•°æ®å¤åˆ¶åˆ°ä¸´æ—¶è¡¨
- **é‡å¤å¤„ç†å¼€é”€**ï¼šå¯èƒ½éœ€è¦æ’åºã€åˆ†ç»„ç­‰æ“ä½œ

### 1.2 ä¸´æ—¶è¡¨ä½¿ç”¨åœºæ™¯


**å¸¸è§è§¦å‘æƒ…å†µ**ï¼š
```sql
-- DISTINCTæ“ä½œ
SELECT DISTINCT department FROM employees;

-- GROUP BYæ“ä½œ
SELECT department, COUNT(*) FROM employees GROUP BY department;

-- ORDER BYæ“ä½œï¼ˆæŸäº›æƒ…å†µä¸‹ï¼‰
SELECT * FROM employees ORDER BY salary DESC;

-- å­æŸ¥è¯¢
SELECT * FROM employees WHERE id IN (SELECT emp_id FROM orders);
```

**å½±å“ç¨‹åº¦å¯¹æ¯”**ï¼š
```
è½»å¾®å½±å“ï¼šå†…å­˜ä¸´æ—¶è¡¨ï¼Œæ•°æ®é‡å°
ä¸­ç­‰å½±å“ï¼šå†…å­˜ä¸´æ—¶è¡¨ï¼Œæ•°æ®é‡å¤§ï¼Œéœ€è¦è½¬æ¢ä¸ºç£ç›˜ä¸´æ—¶è¡¨
ä¸¥é‡å½±å“ï¼šç›´æ¥åˆ›å»ºç£ç›˜ä¸´æ—¶è¡¨ï¼Œå¤§é‡æ•°æ®å¤„ç†
```

---

## 2. âš¡ ä¸´æ—¶è¡¨åˆ›å»ºå¼€é”€åˆ†æ


### 2.1 åˆ›å»ºè¿‡ç¨‹çš„å¼€é”€æ„æˆ


**å¼€é”€æ¥æºåˆ†æ**ï¼š

```
ä¸´æ—¶è¡¨åˆ›å»ºå¼€é”€ = ç»“æ„åˆ›å»º + æ•°æ®å¡«å…… + ç´¢å¼•å»ºç«‹ + ç©ºé—´åˆ†é…

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           åˆ›å»ºå¼€é”€æ„æˆ               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. è¡¨ç»“æ„å®šä¹‰    â”‚ è½»å¾®å¼€é”€         â”‚
â”‚ 2. å­˜å‚¨ç©ºé—´åˆ†é…  â”‚ ä¸­ç­‰å¼€é”€         â”‚
â”‚ 3. æ•°æ®å¤åˆ¶å¡«å……  â”‚ ä¸»è¦å¼€é”€         â”‚
â”‚ 4. ç´¢å¼•åˆ›å»º      â”‚ è¾ƒå¤§å¼€é”€         â”‚
â”‚ 5. ç»Ÿè®¡ä¿¡æ¯æ”¶é›†  â”‚ è½»å¾®å¼€é”€         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 å¼€é”€æµ‹é‡ç¤ºä¾‹


**æ—¶é—´å¼€é”€å¯¹æ¯”**ï¼š
```sql
-- æŸ¥çœ‹ä¸´æ—¶è¡¨ä½¿ç”¨æƒ…å†µ
SHOW STATUS LIKE 'Created_tmp%';

-- æ‰§è¡Œå‰æŸ¥çœ‹çŠ¶æ€
SELECT variable_name, variable_value 
FROM performance_schema.session_status 
WHERE variable_name LIKE 'Created_tmp%';

-- æ‰§è¡ŒæŸ¥è¯¢
SELECT department, AVG(salary) 
FROM employees 
GROUP BY department 
ORDER BY AVG(salary) DESC;

-- æ‰§è¡Œåå†æ¬¡æŸ¥çœ‹
```

**å¼€é”€é‡åŒ–**ï¼š
| æ•°æ®é‡ | å†…å­˜ä¸´æ—¶è¡¨è€—æ—¶ | ç£ç›˜ä¸´æ—¶è¡¨è€—æ—¶ | æ€§èƒ½å·®å¼‚ |
|--------|---------------|---------------|----------|
| 1ä¸‡è¡Œ  | 10ms          | 50ms          | 5å€      |
| 10ä¸‡è¡Œ | 100ms         | 800ms         | 8å€      |
| 100ä¸‡è¡Œ| 1000ms        | 15000ms       | 15å€     |

### 2.3 åˆ›å»ºå¼€é”€ä¼˜åŒ–ç­–ç•¥


**å‡å°‘åˆ›å»ºå¼€é”€çš„æ–¹æ³•**ï¼š

```sql
-- 1. åˆç†ä½¿ç”¨ç´¢å¼•é¿å…ä¸´æ—¶è¡¨
CREATE INDEX idx_dept_salary ON employees(department, salary);

-- 2. é™åˆ¶ç»“æœé›†å¤§å°
SELECT department, AVG(salary) 
FROM employees 
WHERE hire_date > '2020-01-01'  -- å…ˆè¿‡æ»¤å†åˆ†ç»„
GROUP BY department;

-- 3. è°ƒæ•´æŸ¥è¯¢é¡ºåº
-- ä¸å¥½çš„å†™æ³•
SELECT * FROM (
    SELECT department, salary FROM employees ORDER BY salary
) t GROUP BY department;

-- å¥½çš„å†™æ³•
SELECT department, AVG(salary) 
FROM employees 
GROUP BY department;
```

---

## 3. ğŸ’¾ ç£ç›˜IOå½±å“è¯¦è§£


### 3.1 å†…å­˜åˆ°ç£ç›˜çš„è½¬æ¢è¿‡ç¨‹


**è½¬æ¢æ—¶æœº**ï¼šå½“ä¸´æ—¶è¡¨è¶…è¿‡å†…å­˜é™åˆ¶æ—¶ï¼ŒMySQLä¼šå°†å…¶è½¬æ¢ä¸ºç£ç›˜ä¸´æ—¶è¡¨ã€‚

```
å†…å­˜ä¸´æ—¶è¡¨è½¬æ¢è¿‡ç¨‹ï¼š

å†…å­˜ä½¿ç”¨é‡ç›‘æ§
       â†“
æ˜¯å¦è¶…è¿‡tmp_table_sizeï¼Ÿ
       â†“           â†“
      æ˜¯           å¦
       â†“           â†“
   è½¬æ¢ä¸ºç£ç›˜   ç»§ç»­ä½¿ç”¨å†…å­˜
   ä¸´æ—¶è¡¨       ä¸´æ—¶è¡¨
       â†“
   æ€§èƒ½ä¸‹é™
```

**å…³é”®å‚æ•°**ï¼š
```sql
-- æŸ¥çœ‹ä¸´æ—¶è¡¨ç›¸å…³å‚æ•°
SHOW VARIABLES LIKE 'tmp_table_size';      -- å†…å­˜ä¸´æ—¶è¡¨æœ€å¤§å€¼
SHOW VARIABLES LIKE 'max_heap_table_size'; -- å†…å­˜å¼•æ“è¡¨æœ€å¤§å€¼
SHOW VARIABLES LIKE 'tmpdir';              -- ä¸´æ—¶æ–‡ä»¶ç›®å½•
```

### 3.2 ç£ç›˜IOå¼€é”€åˆ†æ


**IOæ“ä½œç±»å‹**ï¼š
```
ç£ç›˜ä¸´æ—¶è¡¨IOå¼€é”€ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å†™å…¥é˜¶æ®µ   â”‚   æŸ¥è¯¢é˜¶æ®µ   â”‚   æ¸…ç†é˜¶æ®µ   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ åˆ›å»ºæ–‡ä»¶   â”‚ â€¢ é¡ºåºè¯»å–   â”‚ â€¢ åˆ é™¤æ–‡ä»¶   â”‚
â”‚ â€¢ å†™å…¥æ•°æ®   â”‚ â€¢ éšæœºè¯»å–   â”‚ â€¢ é‡Šæ”¾ç©ºé—´   â”‚
â”‚ â€¢ å»ºç«‹ç´¢å¼•   â”‚ â€¢ é¡µé¢ç¼“å­˜   â”‚              â”‚
â”‚ â€¢ åˆ·æ–°ç¼“å†²   â”‚ â€¢ ç£ç›˜å¯»é“   â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**IOæ€§èƒ½å½±å“**ï¼š
```sql
-- ç›‘æ§ç£ç›˜ä¸´æ—¶è¡¨åˆ›å»º
SHOW STATUS LIKE 'Created_tmp_disk_tables';
SHOW STATUS LIKE 'Created_tmp_tables';

-- è®¡ç®—ç£ç›˜ä¸´æ—¶è¡¨æ¯”ä¾‹
SELECT 
    (SELECT variable_value FROM performance_schema.global_status 
     WHERE variable_name = 'Created_tmp_disk_tables') /
    (SELECT variable_value FROM performance_schema.global_status 
     WHERE variable_name = 'Created_tmp_tables') * 100 
AS disk_tmp_table_ratio;
```

### 3.3 å‡å°‘ç£ç›˜IOçš„ç­–ç•¥


**ä¼˜åŒ–å»ºè®®**ï¼š

```sql
-- 1. å¢åŠ å†…å­˜ä¸´æ—¶è¡¨å¤§å°
SET SESSION tmp_table_size = 64*1024*1024;        -- 64MB
SET SESSION max_heap_table_size = 64*1024*1024;   -- 64MB

-- 2. ä½¿ç”¨LIMITå‡å°‘æ•°æ®é‡
SELECT department, AVG(salary) 
FROM employees 
GROUP BY department 
ORDER BY AVG(salary) DESC 
LIMIT 10;  -- åªå–å‰10æ¡

-- 3. åˆ†æ‰¹å¤„ç†å¤§æ•°æ®
SELECT department, AVG(salary) 
FROM employees 
WHERE id BETWEEN 1 AND 10000  -- åˆ†æ‰¹å¤„ç†
GROUP BY department;
```

**SSD vs æœºæ¢°ç¡¬ç›˜å½±å“**ï¼š
| å­˜å‚¨ç±»å‹ | éšæœºè¯»IOPS | éšæœºå†™IOPS | ä¸´æ—¶è¡¨æ€§èƒ½å½±å“ |
|----------|------------|------------|----------------|
| SSD      | 100,000+   | 80,000+    | è½»å¾®           |
| æœºæ¢°ç¡¬ç›˜ | 200        | 150        | ä¸¥é‡           |

---

## 4. ğŸ§  å†…å­˜ä½¿ç”¨åˆ†æ


### 4.1 å†…å­˜åˆ†é…æœºåˆ¶


**å†…å­˜ä½¿ç”¨å±‚æ¬¡**ï¼š
```
MySQLå†…å­˜ä½¿ç”¨ç»“æ„ï¼š

å…¨å±€ç¼“å†²æ± 
    â”œâ”€â”€ InnoDBç¼“å†²æ±  (innodb_buffer_pool_size)
    â”œâ”€â”€ æŸ¥è¯¢ç¼“å­˜ (query_cache_size) 
    â”œâ”€â”€ ä¸´æ—¶è¡¨ç©ºé—´
    â”‚   â”œâ”€â”€ å†…å­˜ä¸´æ—¶è¡¨ (tmp_table_size)
    â”‚   â””â”€â”€ æ’åºç¼“å†²åŒº (sort_buffer_size)
    â””â”€â”€ è¿æ¥ç¼“å†²åŒº
        â”œâ”€â”€ æ¯è¿æ¥æ’åºç¼“å†² (sort_buffer_size)
        â””â”€â”€ æ¯è¿æ¥ä¸´æ—¶ç©ºé—´
```

### 4.2 å†…å­˜ä½¿ç”¨ç›‘æ§


**å…³é”®ç›‘æ§æŒ‡æ ‡**ï¼š
```sql
-- æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ
SELECT 
    event_name,
    current_alloc,
    high_alloc
FROM performance_schema.memory_summary_global_by_event_name
WHERE event_name LIKE '%tmp%'
ORDER BY current_alloc DESC;

-- æŸ¥çœ‹ä¸´æ—¶è¡¨å†…å­˜ä½¿ç”¨
SHOW STATUS LIKE 'Created_tmp_tables';
SHOW STATUS LIKE 'Created_tmp_disk_tables';
```

**å†…å­˜ä½¿ç”¨è®¡ç®—**ï¼š
```
å•ä¸ªä¸´æ—¶è¡¨å†…å­˜ä½¿ç”¨ â‰ˆ è¡Œæ•° Ã— å¹³å‡è¡Œé•¿åº¦ + ç´¢å¼•å¼€é”€

ç¤ºä¾‹è®¡ç®—ï¼š
100,000è¡Œ Ã— 200å­—èŠ‚/è¡Œ + ç´¢å¼•(20%) = 24MB
```

### 4.3 å†…å­˜ä¼˜åŒ–ç­–ç•¥


**å‚æ•°è°ƒä¼˜**ï¼š
```sql
-- æ ¹æ®ä¸šåŠ¡è°ƒæ•´ä¸´æ—¶è¡¨å¤§å°
SET GLOBAL tmp_table_size = 128*1024*1024;      -- 128MB
SET GLOBAL max_heap_table_size = 128*1024*1024; -- 128MB

-- è°ƒæ•´æ’åºç¼“å†²åŒº
SET SESSION sort_buffer_size = 8*1024*1024;     -- 8MB

-- æŸ¥çœ‹å†…å­˜ä½¿ç”¨æ•ˆæœ
SELECT 
    $$tmp_table_size/1024/1024 AS tmp_table_size_MB,
    $$max_heap_table_size/1024/1024 AS max_heap_table_size_MB;
```

**å†…å­˜ä½¿ç”¨å»ºè®®**ï¼š
```
ğŸ’¡ æœ€ä½³å®è·µï¼š
â€¢ tmp_table_size è®¾ç½®ä¸ºå¯ç”¨å†…å­˜çš„5-10%
â€¢ ç›‘æ§ç£ç›˜ä¸´æ—¶è¡¨æ¯”ä¾‹ï¼Œæ§åˆ¶åœ¨10%ä»¥ä¸‹
â€¢ é«˜å¹¶å‘ç¯å¢ƒä¸‹é€‚å½“å‡å°ï¼Œé¿å…å†…å­˜è€—å°½
â€¢ å¤§æ•°æ®å¤„ç†æ—¶ä¸´æ—¶å¢å¤§ï¼Œå¤„ç†å®Œåæ¢å¤
```

---

## 5. ğŸ”’ é”ç«äº‰å½±å“


### 5.1 ä¸´æ—¶è¡¨é”æœºåˆ¶


**é”ç±»å‹è¯´æ˜**ï¼šä¸´æ—¶è¡¨ä½¿ç”¨çš„é”æœºåˆ¶ç›¸å¯¹ç®€å•ï¼Œå› ä¸ºæ¯ä¸ªè¿æ¥çš„ä¸´æ—¶è¡¨éƒ½æ˜¯ç‹¬ç«‹çš„ã€‚

```
ä¸´æ—¶è¡¨é”ç‰¹ç‚¹ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     é”ç±»å‹      â”‚     é”èŒƒå›´      â”‚     å½±å“ç¨‹åº¦    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   è¡¨çº§é”        â”‚   æ•´ä¸ªä¸´æ—¶è¡¨    â”‚     è½»å¾®        â”‚
â”‚   å†…å­˜é”        â”‚   å†…å­˜åˆ†é…      â”‚     ä¸­ç­‰        â”‚
â”‚   ç£ç›˜æ–‡ä»¶é”    â”‚   ä¸´æ—¶æ–‡ä»¶      â”‚     è¾ƒé‡        â”‚
â”‚   ç³»ç»Ÿèµ„æºé”    â”‚   IOèµ„æº        â”‚     ä¸¥é‡        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 é”ç«äº‰åœºæ™¯


**ç«äº‰ç‚¹åˆ†æ**ï¼š
```sql
-- æŸ¥çœ‹é”ç­‰å¾…æƒ…å†µ
SELECT 
    object_type,
    object_name,
    lock_type,
    lock_duration,
    lock_status
FROM performance_schema.metadata_locks
WHERE object_type LIKE '%TMP%';

-- æŸ¥çœ‹ä¸´æ—¶è¡¨ç›¸å…³ç­‰å¾…äº‹ä»¶
SELECT event_name, count_star, sum_timer_wait
FROM performance_schema.events_waits_summary_global_by_event_name
WHERE event_name LIKE '%tmp%'
ORDER BY sum_timer_wait DESC;
```

**é«˜å¹¶å‘ä¸‹çš„é”ç«äº‰**ï¼š
```
å¹¶å‘ä¸´æ—¶è¡¨åˆ›å»ºæµç¨‹ï¼š

è¿æ¥1: ç”³è¯·å†…å­˜ â†’ åˆ›å»ºä¸´æ—¶è¡¨ â†’ å¤„ç†æ•°æ®
è¿æ¥2: ç”³è¯·å†…å­˜ â†’ ç­‰å¾…èµ„æº   â†’ åˆ›å»ºä¸´æ—¶è¡¨
è¿æ¥3: ç”³è¯·å†…å­˜ â†’ ç­‰å¾…èµ„æº   â†’ ç­‰å¾…èµ„æº
          â†“
      èµ„æºç«äº‰æ¿€çƒˆ
```

### 5.3 å‡å°‘é”ç«äº‰ç­–ç•¥


**ä¼˜åŒ–æ–¹æ³•**ï¼š
```sql
-- 1. å‡å°‘ä¸´æ—¶è¡¨ä½¿ç”¨
-- ä½¿ç”¨è¦†ç›–ç´¢å¼•é¿å…ä¸´æ—¶è¡¨
CREATE INDEX idx_cover ON employees(department, salary, name);

SELECT department, salary, name 
FROM employees 
WHERE department = 'IT'
ORDER BY salary;  -- ä½¿ç”¨ç´¢å¼•ï¼Œæ— éœ€ä¸´æ—¶è¡¨

-- 2. åˆ†æ‰¹å¤„ç†
-- é¿å…å¤§é‡æ•°æ®åŒæ—¶åˆ›å»ºä¸´æ—¶è¡¨
SELECT department, COUNT(*) 
FROM employees 
WHERE id BETWEEN ? AND ?  -- åˆ†æ‰¹å¤„ç†
GROUP BY department;

-- 3. ä½¿ç”¨è¿æ¥æ± æ§åˆ¶å¹¶å‘
-- é™åˆ¶åŒæ—¶æ‰§è¡Œçš„å¤æ‚æŸ¥è¯¢æ•°é‡
```

---

## 6. ğŸš€ å¹¶å‘æ€§èƒ½å½±å“


### 6.1 å¹¶å‘å¤„ç†æœºåˆ¶


**å¹¶å‘å½±å“åˆ†æ**ï¼šæ¯ä¸ªMySQLè¿æ¥éƒ½æœ‰ç‹¬ç«‹çš„ä¸´æ—¶è¡¨ç©ºé—´ï¼Œä½†å…±äº«ç³»ç»Ÿèµ„æºã€‚

```
å¹¶å‘ä¸´æ—¶è¡¨å¤„ç†ï¼š

ç³»ç»Ÿèµ„æºæ± 
    â”œâ”€â”€ CPUèµ„æº
    â”‚   â”œâ”€â”€ è¿æ¥1ä¸´æ—¶è¡¨å¤„ç†
    â”‚   â”œâ”€â”€ è¿æ¥2ä¸´æ—¶è¡¨å¤„ç†  
    â”‚   â””â”€â”€ è¿æ¥3ä¸´æ—¶è¡¨å¤„ç†
    â”œâ”€â”€ å†…å­˜èµ„æº
    â”‚   â”œâ”€â”€ ä¸´æ—¶è¡¨1 (10MB)
    â”‚   â”œâ”€â”€ ä¸´æ—¶è¡¨2 (15MB)
    â”‚   â””â”€â”€ ä¸´æ—¶è¡¨3 (8MB)
    â””â”€â”€ ç£ç›˜IOèµ„æº
        â”œâ”€â”€ ä¸´æ—¶æ–‡ä»¶è¯»å†™
        â””â”€â”€ ç£ç›˜é˜Ÿåˆ—ç­‰å¾…
```

### 6.2 å¹¶å‘æ€§èƒ½ç›‘æ§


**ç›‘æ§å¹¶å‘ä¸´æ—¶è¡¨ä½¿ç”¨**ï¼š
```sql
-- æŸ¥çœ‹å½“å‰æ´»è·ƒçš„ä¸´æ—¶è¡¨æ“ä½œ
SELECT 
    processlist_id,
    processlist_user,
    processlist_host,
    processlist_command,
    processlist_state,
    processlist_info
FROM performance_schema.threads
WHERE processlist_state LIKE '%tmp%' 
   OR processlist_state LIKE '%Creating%'
   OR processlist_state LIKE '%Sorting%';

-- ç»Ÿè®¡å¹¶å‘ä¸´æ—¶è¡¨åˆ›å»º
SELECT COUNT(*) as concurrent_tmp_operations
FROM performance_schema.threads
WHERE processlist_state IN (
    'Creating tmp table',
    'Copying to tmp table',
    'Sorting for group'
);
```

**æ€§èƒ½æŒ‡æ ‡åˆ†æ**ï¼š
| å¹¶å‘è¿æ¥æ•° | å¹³å‡å“åº”æ—¶é—´ | ä¸´æ—¶è¡¨ç­‰å¾…æ—¶é—´ | ç³»ç»Ÿè´Ÿè½½ |
|------------|--------------|----------------|----------|
| 10ä¸ª       | 100ms        | 5ms            | æ­£å¸¸     |
| 50ä¸ª       | 300ms        | 50ms           | è¾ƒé«˜     |
| 100ä¸ª      | 800ms        | 200ms          | ä¸¥é‡     |

### 6.3 å¹¶å‘ä¼˜åŒ–ç­–ç•¥


**ä¼˜åŒ–å»ºè®®**ï¼š
```sql
-- 1. è¿æ¥æ•°é™åˆ¶
SET GLOBAL max_connections = 200;  -- é™åˆ¶æœ€å¤§è¿æ¥æ•°

-- 2. æŸ¥è¯¢è¶…æ—¶è®¾ç½®  
SET SESSION long_query_time = 10;  -- è®°å½•æ…¢æŸ¥è¯¢

-- 3. èµ„æºæ§åˆ¶
-- é™åˆ¶å•ä¸ªæŸ¥è¯¢çš„èµ„æºä½¿ç”¨
SET SESSION max_execution_time = 30000;  -- 30ç§’è¶…æ—¶

-- 4. ä¼˜å…ˆçº§è°ƒæ•´
-- å¯¹ä¸´æ—¶è¡¨ä½¿ç”¨è¾ƒå¤šçš„æŸ¥è¯¢é™ä½ä¼˜å…ˆçº§
/*+ MAX_EXECUTION_TIME(30000) */ 
SELECT department, AVG(salary) 
FROM employees 
GROUP BY department;
```

**æœ€ä½³å®è·µ**ï¼š
```
ğŸ¯ å¹¶å‘ä¼˜åŒ–ç­–ç•¥ï¼š
â€¢ é¿å…é«˜å³°æœŸæ‰§è¡Œå¤§é‡ä¸´æ—¶è¡¨æ“ä½œ
â€¢ ä½¿ç”¨è¯»å†™åˆ†ç¦»ï¼ŒæŠ¥è¡¨æŸ¥è¯¢åˆ†ç¦»åˆ°ä»åº“
â€¢ å®æ–½è¿æ¥æ± ï¼Œæ§åˆ¶å¹¶å‘æ•°é‡
â€¢ ç›‘æ§ç³»ç»Ÿèµ„æºï¼ŒåŠæ—¶å‘ç°ç“¶é¢ˆ
```

---

## 7. ğŸ—„ï¸ ä¸´æ—¶è¡¨ç©ºé—´ç®¡ç†


### 7.1 ä¸´æ—¶è¡¨ç©ºé—´ç»“æ„


**å­˜å‚¨ä½ç½®è¯´æ˜**ï¼šMySQLä¸´æ—¶è¡¨æ•°æ®å­˜å‚¨åœ¨ä¸“é—¨çš„ä¸´æ—¶è¡¨ç©ºé—´ä¸­ã€‚

```
ä¸´æ—¶è¡¨ç©ºé—´å±‚æ¬¡ç»“æ„ï¼š

ä¸´æ—¶è¡¨ç©ºé—´ (Temporary Tablespace)
    â”œâ”€â”€ å†…å­˜ä¸´æ—¶è¡¨
    â”‚   â”œâ”€â”€ MEMORYå¼•æ“è¡¨
    â”‚   â””â”€â”€ å†…å­˜ä¸­çš„æ•°æ®é¡µ
    â”œâ”€â”€ ç£ç›˜ä¸´æ—¶è¡¨  
    â”‚   â”œâ”€â”€ InnoDBä¸´æ—¶è¡¨
    â”‚   â”œâ”€â”€ MyISAMä¸´æ—¶è¡¨
    â”‚   â””â”€â”€ ä¸´æ—¶æ–‡ä»¶(.tmp)
    â””â”€â”€ ç³»ç»Ÿä¸´æ—¶ç›®å½•
        â”œâ”€â”€ tmpdiré…ç½®ç›®å½•
        â””â”€â”€ æ“ä½œç³»ç»Ÿä¸´æ—¶ç›®å½•
```

### 7.2 ç©ºé—´ä½¿ç”¨ç›‘æ§


**æŸ¥çœ‹ä¸´æ—¶è¡¨ç©ºé—´ä½¿ç”¨**ï¼š
```sql
-- æŸ¥çœ‹ä¸´æ—¶è¡¨ç©ºé—´ä¿¡æ¯
SELECT 
    tablespace_name,
    file_name,
    total_extents,
    free_extents,
    (total_extents - free_extents) * extent_size / 1024 / 1024 AS used_mb
FROM information_schema.files
WHERE tablespace_name LIKE '%temp%';

-- æŸ¥çœ‹ä¸´æ—¶ç›®å½•ä½¿ç”¨æƒ…å†µ
SHOW VARIABLES LIKE 'tmpdir';

-- ç›‘æ§ä¸´æ—¶è¡¨æ–‡ä»¶åˆ›å»º
SHOW STATUS LIKE 'Created_tmp%';
```

**ç©ºé—´ä½¿ç”¨è®¡ç®—**ï¼š
```
ä¸´æ—¶è¡¨ç©ºé—´ä½¿ç”¨ = Î£(æ´»è·ƒä¸´æ—¶è¡¨å¤§å°) + å†å²æ®‹ç•™æ–‡ä»¶

ç¤ºä¾‹ï¼š
æ´»è·ƒä¸´æ—¶è¡¨: 100MB
å†å²æ–‡ä»¶: 50MB  
æ€»ä½¿ç”¨: 150MB
```

### 7.3 ç©ºé—´ç®¡ç†ç­–ç•¥


**æ¸…ç†ç­–ç•¥**ï¼š
```sql
-- 1. å®šæœŸæ¸…ç†å†å²ä¸´æ—¶æ–‡ä»¶
-- é€šè¿‡æ“ä½œç³»ç»Ÿå‘½ä»¤æ¸…ç†ï¼ˆéœ€è¦è°¨æ…ï¼‰
-- find /tmp -name "*.tmp" -mtime +1 -delete

-- 2. ç›‘æ§ç©ºé—´ä½¿ç”¨
SELECT 
    table_schema,
    table_name,
    data_length,
    index_length,
    (data_length + index_length) / 1024 / 1024 AS total_mb
FROM information_schema.tables
WHERE table_name LIKE '#sql%'  -- ä¸´æ—¶è¡¨å‘½åæ¨¡å¼
ORDER BY total_mb DESC;

-- 3. è®¾ç½®åˆé€‚çš„æ¸…ç†æ—¶é—´
SET GLOBAL delayed_insert_timeout = 300;  -- 5åˆ†é’Ÿ
```

**ç©ºé—´ä¼˜åŒ–é…ç½®**ï¼š
```sql
-- ä¸´æ—¶è¡¨ç©ºé—´å¤§å°é…ç½®
SET GLOBAL innodb_temp_data_file_path = 'ibtmp1:12M:autoextend:max:5G';

-- è®¾ç½®ä¸´æ—¶ç›®å½•åˆ°SSD
-- my.cnfé…ç½®
-- tmpdir = /ssd/mysql_tmp

-- å¤šä¸ªä¸´æ—¶ç›®å½•è´Ÿè½½å‡è¡¡  
-- tmpdir = /tmp1:/tmp2:/tmp3
```

---

## 8. ğŸ“Š æ€§èƒ½ç›‘æ§æŒ‡æ ‡


### 8.1 å…³é”®æ€§èƒ½æŒ‡æ ‡


**æ ¸å¿ƒç›‘æ§æŒ‡æ ‡**ï¼š
```sql
-- 1. ä¸´æ—¶è¡¨åˆ›å»ºç»Ÿè®¡
SELECT 
    variable_name,
    variable_value
FROM performance_schema.global_status
WHERE variable_name IN (
    'Created_tmp_tables',           -- æ€»ä¸´æ—¶è¡¨æ•°
    'Created_tmp_disk_tables',      -- ç£ç›˜ä¸´æ—¶è¡¨æ•°
    'Created_tmp_files'             -- ä¸´æ—¶æ–‡ä»¶æ•°
);

-- 2. ä¸´æ—¶è¡¨æ•ˆç‡è®¡ç®—
SELECT 
    ROUND(
        (SELECT variable_value FROM performance_schema.global_status 
         WHERE variable_name = 'Created_tmp_disk_tables') * 100.0 /
        (SELECT variable_value FROM performance_schema.global_status 
         WHERE variable_name = 'Created_tmp_tables'), 2
    ) AS disk_tmp_table_percentage;
```

### 8.2 æ€§èƒ½åˆ†ææŸ¥è¯¢


**è¯¦ç»†æ€§èƒ½åˆ†æ**ï¼š
```sql
-- 3. å†…å­˜ä½¿ç”¨åˆ†æ
SELECT 
    event_name,
    ROUND(current_alloc/1024/1024, 2) AS current_alloc_mb,
    ROUND(high_alloc/1024/1024, 2) AS high_alloc_mb
FROM performance_schema.memory_summary_global_by_event_name
WHERE event_name LIKE '%tmp%'
   OR event_name LIKE '%temp%'
ORDER BY current_alloc DESC;

-- 4. ç­‰å¾…äº‹ä»¶åˆ†æ
SELECT 
    event_name,
    count_star,
    ROUND(sum_timer_wait/1000000000, 2) AS sum_timer_wait_sec,
    ROUND(avg_timer_wait/1000000, 2) AS avg_timer_wait_ms
FROM performance_schema.events_waits_summary_global_by_event_name
WHERE event_name LIKE '%tmp%'
ORDER BY sum_timer_wait DESC;
```

### 8.3 ç›‘æ§å‘Šè­¦è®¾ç½®


**å»ºè®®çš„å‘Šè­¦é˜ˆå€¼**ï¼š
```sql
-- ç£ç›˜ä¸´æ—¶è¡¨æ¯”ä¾‹å‘Šè­¦ï¼ˆå»ºè®®<20%ï¼‰
SELECT 
    CASE 
        WHEN disk_tmp_percentage > 20 THEN 'WARNING'
        WHEN disk_tmp_percentage > 50 THEN 'CRITICAL'
        ELSE 'OK'
    END AS alert_level,
    disk_tmp_percentage
FROM (
    SELECT ROUND(
        (SELECT variable_value FROM performance_schema.global_status 
         WHERE variable_name = 'Created_tmp_disk_tables') * 100.0 /
        GREATEST(
            (SELECT variable_value FROM performance_schema.global_status 
             WHERE variable_name = 'Created_tmp_tables'), 1
        ), 2
    ) AS disk_tmp_percentage
) t;
```

**æ€§èƒ½ç›‘æ§è„šæœ¬ç¤ºä¾‹**ï¼š
```bash
#!/bin/bash
# ä¸´æ—¶è¡¨æ€§èƒ½ç›‘æ§è„šæœ¬

mysql -e "
SELECT 
    'Temp Tables Performance Report' AS report_title,
    NOW() AS report_time;

SELECT 
    'Total Tmp Tables' AS metric,
    variable_value AS value
FROM performance_schema.global_status 
WHERE variable_name = 'Created_tmp_tables'

UNION ALL

SELECT 
    'Disk Tmp Tables' AS metric,
    variable_value AS value  
FROM performance_schema.global_status
WHERE variable_name = 'Created_tmp_disk_tables';
"
```

---

## 9. âš™ï¸ tmpdiré…ç½®ä¼˜åŒ–


### 9.1 tmpdirå‚æ•°è¯¦è§£


**åŸºæœ¬æ¦‚å¿µ**ï¼štmpdiræ˜¯MySQLå­˜å‚¨ä¸´æ—¶æ–‡ä»¶çš„ç›®å½•é…ç½®ï¼Œç›´æ¥å½±å“ä¸´æ—¶è¡¨çš„ç£ç›˜IOæ€§èƒ½ã€‚

```sql
-- æŸ¥çœ‹å½“å‰tmpdiré…ç½®
SHOW VARIABLES LIKE 'tmpdir';

-- å…¸å‹é…ç½®ç¤ºä¾‹
-- tmpdir = /tmp                    -- å•ç›®å½•
-- tmpdir = /tmp:/var/tmp          -- å¤šç›®å½•
-- tmpdir = /ssd/mysql_tmp         -- SSDä¸“ç”¨ç›®å½•
```

**é…ç½®ä½ç½®**ï¼š
```
MySQLé…ç½®æ–‡ä»¶ä½ç½®ï¼š
â”œâ”€â”€ /etc/mysql/my.cnf           (Ubuntu/Debian)
â”œâ”€â”€ /etc/my.cnf                 (CentOS/RHEL)  
â”œâ”€â”€ /usr/local/mysql/my.cnf     (æºç å®‰è£…)
â””â”€â”€ ~/.my.cnf                   (ç”¨æˆ·é…ç½®)

[mysqld]
tmpdir = /path/to/temp/directory
```

### 9.2 tmpdiræ€§èƒ½ä¼˜åŒ–ç­–ç•¥


**å­˜å‚¨ä»‹è´¨é€‰æ‹©**ï¼š
```
æ€§èƒ½å¯¹æ¯”ï¼ˆé¡ºåºè¯»å†™ï¼ŒMB/sï¼‰ï¼š

å­˜å‚¨ç±»å‹        â”‚ è¯»å–é€Ÿåº¦ â”‚ å†™å…¥é€Ÿåº¦ â”‚ éšæœºIO â”‚ æ¨èåº¦
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€
æœºæ¢°ç¡¬ç›˜(HDD)   â”‚   120   â”‚   100   â”‚  å¾ˆå·®  â”‚   âŒ
SATA SSD       â”‚   500   â”‚   450   â”‚  è‰¯å¥½  â”‚   âœ…  
NVMe SSD       â”‚  2000   â”‚  1500   â”‚  ä¼˜ç§€  â”‚   â­
å†…å­˜ç›˜(tmpfs)   â”‚ 10000+  â”‚ 10000+  â”‚  æå¥½  â”‚   â­â­
```

**å¤šç›®å½•é…ç½®ä¼˜åŒ–**ï¼š
```ini
# my.cnfé…ç½®ç¤ºä¾‹
[mysqld]
# å¤šç£ç›˜è´Ÿè½½å‡è¡¡
tmpdir = /disk1/mysql_tmp:/disk2/mysql_tmp:/disk3/mysql_tmp

# SSDä¸“ç”¨ä¸´æ—¶ç›®å½•
tmpdir = /ssd/mysql_tmp

# å†…å­˜ç›˜é…ç½®ï¼ˆéœ€è¦è¶³å¤Ÿå†…å­˜ï¼‰
tmpdir = /dev/shm/mysql_tmp
```

### 9.3 ç›®å½•æƒé™ä¸ç»´æŠ¤


**æƒé™è®¾ç½®**ï¼š
```bash
# åˆ›å»ºä¸´æ—¶ç›®å½•
sudo mkdir -p /ssd/mysql_tmp

# è®¾ç½®æ­£ç¡®çš„æƒé™
sudo chown mysql:mysql /ssd/mysql_tmp
sudo chmod 750 /ssd/mysql_tmp

# éªŒè¯æƒé™
ls -la /ssd/mysql_tmp
```

**å®šæœŸç»´æŠ¤**ï¼š
```bash
# ç›‘æ§ç›®å½•ä½¿ç”¨æƒ…å†µ
df -h /ssd/mysql_tmp

# æ¸…ç†å†å²ä¸´æ—¶æ–‡ä»¶ï¼ˆè°¨æ…æ‰§è¡Œï¼‰
find /ssd/mysql_tmp -name "*.tmp" -mtime +1 -delete

# è®¾ç½®è‡ªåŠ¨æ¸…ç†ï¼ˆcrontabï¼‰
# 0 2 * * * find /ssd/mysql_tmp -name "*.tmp" -mtime +1 -delete
```

### 9.4 é…ç½®éªŒè¯ä¸æµ‹è¯•


**é…ç½®éªŒè¯**ï¼š
```sql
-- é‡å¯MySQLåéªŒè¯é…ç½®
SHOW VARIABLES LIKE 'tmpdir';

-- æµ‹è¯•ä¸´æ—¶è¡¨åˆ›å»º
CREATE TEMPORARY TABLE test_tmp AS 
SELECT * FROM information_schema.tables LIMIT 1000;

-- æ£€æŸ¥ä¸´æ—¶æ–‡ä»¶æ˜¯å¦åœ¨æ­£ç¡®ç›®å½•
```

**æ€§èƒ½æµ‹è¯•**ï¼š
```sql
-- æµ‹è¯•å¤§æ•°æ®é‡ä¸´æ—¶è¡¨æ€§èƒ½
SET SESSION tmp_table_size = 1024*1024;  -- å¼ºåˆ¶ä½¿ç”¨ç£ç›˜ä¸´æ—¶è¡¨

-- æ‰§è¡Œæµ‹è¯•æŸ¥è¯¢
SELECT 
    table_schema,
    COUNT(*) as table_count,
    SUM(data_length) as total_size
FROM information_schema.tables 
GROUP BY table_schema
ORDER BY total_size DESC;

-- å¯¹æ¯”ä¸åŒtmpdiré…ç½®ä¸‹çš„æ‰§è¡Œæ—¶é—´
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ä¸´æ—¶è¡¨æ€§èƒ½å½±å“ï¼šåˆ›å»ºå¼€é”€ã€IOå¼€é”€ã€å†…å­˜æ¶ˆè€—ã€é”ç«äº‰
ğŸ”¸ å…³é”®æ€§èƒ½æŒ‡æ ‡ï¼šç£ç›˜ä¸´æ—¶è¡¨æ¯”ä¾‹ã€å†…å­˜ä½¿ç”¨é‡ã€ç­‰å¾…æ—¶é—´
ğŸ”¸ ä¼˜åŒ–ç­–ç•¥ï¼šåˆç†é…ç½®å‚æ•°ã€é€‰æ‹©åˆé€‚å­˜å‚¨ã€ç›‘æ§å‘Šè­¦
ğŸ”¸ tmpdiré…ç½®ï¼šå­˜å‚¨ä»‹è´¨é€‰æ‹©ã€å¤šç›®å½•é…ç½®ã€æƒé™ç»´æŠ¤
```

### 10.2 æ€§èƒ½ä¼˜åŒ–æœ€ä½³å®è·µ


**ğŸ¯ æ ¸å¿ƒä¼˜åŒ–åŸåˆ™**ï¼š
```
1. é¢„é˜²ä¸ºä¸»ï¼šé€šè¿‡ç´¢å¼•å’ŒæŸ¥è¯¢ä¼˜åŒ–å‡å°‘ä¸´æ—¶è¡¨ä½¿ç”¨
2. å‚æ•°è°ƒä¼˜ï¼šåˆç†è®¾ç½®tmp_table_sizeå’Œmax_heap_table_size  
3. å­˜å‚¨ä¼˜åŒ–ï¼šä½¿ç”¨SSDå­˜å‚¨ï¼Œé…ç½®åˆé€‚çš„tmpdir
4. ç›‘æ§å‘Šè­¦ï¼šå»ºç«‹å®Œå–„çš„ç›‘æ§ä½“ç³»ï¼ŒåŠæ—¶å‘ç°é—®é¢˜
```

**âš ï¸ å¸¸è§æ€§èƒ½é™·é˜±**ï¼š
```
â€¢ ç£ç›˜ä¸´æ—¶è¡¨æ¯”ä¾‹è¿‡é«˜ï¼ˆ>20%ï¼‰
â€¢ ä¸´æ—¶è¡¨å¤§å°é…ç½®è¿‡å°ï¼Œé¢‘ç¹è½¬æ¢ä¸ºç£ç›˜ä¸´æ—¶è¡¨
â€¢ tmpdiré…ç½®åœ¨æ…¢é€Ÿå­˜å‚¨ä¸Š
â€¢ é«˜å¹¶å‘æ—¶ä¸´æ—¶è¡¨äº‰ç”¨æ¿€çƒˆ
â€¢ ç¼ºä¹æœ‰æ•ˆçš„æ€§èƒ½ç›‘æ§
```

### 10.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ”§ é…ç½®å»ºè®®**ï¼š
```sql
-- ç”Ÿäº§ç¯å¢ƒæ¨èé…ç½®
tmp_table_size = 128M          -- æ ¹æ®å¯ç”¨å†…å­˜è°ƒæ•´
max_heap_table_size = 128M     -- ä¸tmp_table_sizeä¿æŒä¸€è‡´
tmpdir = /ssd/mysql_tmp        -- ä½¿ç”¨SSDå­˜å‚¨

-- ç›‘æ§é…ç½®
long_query_time = 2            -- è®°å½•æ…¢æŸ¥è¯¢
slow_query_log = ON            -- å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—
```

**ğŸ“Š ç›‘æ§æ£€æŸ¥æ¸…å•**ï¼š
```
â˜ ç£ç›˜ä¸´æ—¶è¡¨æ¯”ä¾‹ < 20%
â˜ ä¸´æ—¶è¡¨å†…å­˜ä½¿ç”¨åˆç†
â˜ tmpdirç£ç›˜ç©ºé—´å……è¶³  
â˜ æ²¡æœ‰é•¿æ—¶é—´çš„ä¸´æ—¶è¡¨æ“ä½œç­‰å¾…
â˜ ç³»ç»Ÿè´Ÿè½½åœ¨åˆç†èŒƒå›´å†…
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- ä¸´æ—¶è¡¨æ€§èƒ½å½±å“ä¸»è¦åœ¨äºé¢å¤–çš„èµ„æºæ¶ˆè€—
- ç£ç›˜ä¸´æ—¶è¡¨æ¯”å†…å­˜ä¸´æ—¶è¡¨æ€§èƒ½å·®10-20å€
- åˆç†é…ç½®å’Œç›‘æ§æ˜¯ä¼˜åŒ–çš„å…³é”®
- tmpdiré…ç½®å¯¹ç£ç›˜ä¸´æ—¶è¡¨æ€§èƒ½å½±å“å·¨å¤§