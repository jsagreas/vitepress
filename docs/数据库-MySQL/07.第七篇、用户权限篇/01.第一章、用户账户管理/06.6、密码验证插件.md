---
title: 6ã€å¯†ç éªŒè¯æ’ä»¶
---
## ğŸ“š ç›®å½•

1. [å¯†ç éªŒè¯æ’ä»¶æ¦‚è¿°](#1-å¯†ç éªŒè¯æ’ä»¶æ¦‚è¿°)
2. [æ’ä»¶æ³¨å†Œä¸åŠ è½½æœºåˆ¶](#2-æ’ä»¶æ³¨å†Œä¸åŠ è½½æœºåˆ¶)
3. [è‡ªå®šä¹‰éªŒè¯é€»è¾‘å¼€å‘](#3-è‡ªå®šä¹‰éªŒè¯é€»è¾‘å¼€å‘)
4. [æ’ä»¶é…ç½®ä¸å‚æ•°ç®¡ç†](#4-æ’ä»¶é…ç½®ä¸å‚æ•°ç®¡ç†)
5. [éªŒè¯å‡½æ•°æ¥å£è¯¦è§£](#5-éªŒè¯å‡½æ•°æ¥å£è¯¦è§£)
6. [æ’ä»¶å®‰å…¨æ€§è®¾è®¡](#6-æ’ä»¶å®‰å…¨æ€§è®¾è®¡)
7. [ç¬¬ä¸‰æ–¹éªŒè¯é›†æˆ](#7-ç¬¬ä¸‰æ–¹éªŒè¯é›†æˆ)
8. [å¤šæ’ä»¶æ”¯æŒæœºåˆ¶](#8-å¤šæ’ä»¶æ”¯æŒæœºåˆ¶)
9. [æ’ä»¶å®‰å…¨å¼€å‘è§„èŒƒ](#9-æ’ä»¶å®‰å…¨å¼€å‘è§„èŒƒ)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” å¯†ç éªŒè¯æ’ä»¶æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯å¯†ç éªŒè¯æ’ä»¶


å¯†ç éªŒè¯æ’ä»¶æ˜¯MySQLæä¾›çš„ä¸€ç§**å¯æ‰©å±•æœºåˆ¶**ï¼Œè®©ä½ å¯ä»¥è‡ªå®šä¹‰å¯†ç å¼ºåº¦æ£€æŸ¥è§„åˆ™ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯åœ¨ç”¨æˆ·è®¾ç½®å¯†ç æ—¶ï¼ŒMySQLä¼šè°ƒç”¨è¿™äº›æ’ä»¶æ¥**æ£€æŸ¥å¯†ç æ˜¯å¦ç¬¦åˆè¦æ±‚**ã€‚

```
ç”¨æˆ·è®¾ç½®å¯†ç  â†’ éªŒè¯æ’ä»¶æ£€æŸ¥ â†’ é€šè¿‡/æ‹’ç»
     â†“              â†“           â†“
"123456"    â†’   å¼ºåº¦æ£€æŸ¥   â†’   æ‹’ç»âŒ
"MyStr0ng#Pwd" â†’ å¼ºåº¦æ£€æŸ¥ â†’  é€šè¿‡âœ…
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦å¯†ç éªŒè¯æ’ä»¶


**ğŸ”¸ è§£å†³çš„æ ¸å¿ƒé—®é¢˜**
- **å¼±å¯†ç é£é™©**: é˜²æ­¢ç”¨æˆ·ä½¿ç”¨ç®€å•æ˜“çŒœçš„å¯†ç 
- **åˆè§„è¦æ±‚**: æ»¡è¶³ä¼ä¸šå®‰å…¨ç­–ç•¥å’Œæ³•è§„è¦æ±‚  
- **çµæ´»å®šåˆ¶**: æ ¹æ®ä¸åŒä¸šåŠ¡åœºæ™¯å®šåˆ¶éªŒè¯è§„åˆ™
- **ç»Ÿä¸€ç®¡ç†**: åœ¨æ•°æ®åº“å±‚é¢ç»Ÿä¸€æ§åˆ¶å¯†ç ç­–ç•¥

> ğŸ’¡ **å®é™…åœºæ™¯ä¸¾ä¾‹**  
> é‡‘èç³»ç»Ÿè¦æ±‚å¯†ç è‡³å°‘12ä½ï¼ŒåŒ…å«å¤§å°å†™ã€æ•°å­—ã€ç‰¹æ®Šç¬¦å·ï¼›è€Œå†…éƒ¨æµ‹è¯•ç¯å¢ƒå¯èƒ½åªéœ€è¦8ä½å¯†ç ã€‚é€šè¿‡æ’ä»¶å¯ä»¥çµæ´»é…ç½®ä¸åŒçš„éªŒè¯ç­–ç•¥ã€‚

### 1.3 MySQLå†…ç½®éªŒè¯æ’ä»¶


**ğŸ”¸ validate_passwordæ’ä»¶**
```sql
-- å®‰è£…å¯†ç éªŒè¯æ’ä»¶
INSTALL PLUGIN validate_password SONAME 'validate_password.so';

-- æŸ¥çœ‹æ’ä»¶çŠ¶æ€
SHOW PLUGINS;
```

**ğŸ”¸ ä¸»è¦éªŒè¯è§„åˆ™**
- **é•¿åº¦æ£€æŸ¥**: å¯†ç æœ€å°é•¿åº¦é™åˆ¶
- **å¤æ‚åº¦æ£€æŸ¥**: å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šç¬¦å·
- **å­—å…¸æ£€æŸ¥**: é¿å…ä½¿ç”¨å¸¸è§å¼±å¯†ç 
- **ç”¨æˆ·ä¿¡æ¯æ£€æŸ¥**: å¯†ç ä¸èƒ½åŒ…å«ç”¨æˆ·å

---

## 2. âš™ï¸ æ’ä»¶æ³¨å†Œä¸åŠ è½½æœºåˆ¶


### 2.1 æ’ä»¶åŠ è½½æµç¨‹


MySQLæ’ä»¶ç³»ç»Ÿé‡‡ç”¨**åŠ¨æ€åŠ è½½**æœºåˆ¶ï¼Œæ’ä»¶å¯ä»¥åœ¨æœåŠ¡å™¨è¿è¡Œæ—¶åŠ è½½å’Œå¸è½½ã€‚

```
MySQLå¯åŠ¨ â†’ æ‰«ææ’ä»¶ç›®å½• â†’ åŠ è½½é…ç½®çš„æ’ä»¶ â†’ æ³¨å†ŒéªŒè¯å‡½æ•°
    â†“            â†“              â†“            â†“
 è¯»å–é…ç½®    æŸ¥æ‰¾.soæ–‡ä»¶    è°ƒç”¨åˆå§‹åŒ–å‡½æ•°   ç»‘å®šå›è°ƒæ¥å£
```

### 2.2 æ’ä»¶æ³¨å†Œè¿‡ç¨‹


```c
// æ’ä»¶æè¿°ç»“æ„ä½“
mysql_declare_plugin(validate_password)
{
  MYSQL_VALIDATE_PASSWORD_PLUGIN,     // æ’ä»¶ç±»å‹
  &validate_password_descriptor,      // æ’ä»¶æè¿°ç¬¦
  "validate_password",                // æ’ä»¶åç§°
  "Oracle Corporation",               // ä½œè€…ä¿¡æ¯
  "Check password strength",          // æè¿°ä¿¡æ¯
  PLUGIN_LICENSE_GPL,                 // è®¸å¯è¯
  validate_password_init,             // åˆå§‹åŒ–å‡½æ•°
  validate_password_deinit,           // æ¸…ç†å‡½æ•°
  0x0101,                            // ç‰ˆæœ¬å·
  NULL,                              // çŠ¶æ€å˜é‡
  validate_password_system_variables, // ç³»ç»Ÿå˜é‡
  NULL,                              // é…ç½®é€‰é¡¹
  0,                                 // æ ‡å¿—ä½
}
mysql_declare_plugin_end;
```

### 2.3 åŠ¨æ€æ’ä»¶ç®¡ç†


```sql
-- ğŸ”¸ å®‰è£…æ’ä»¶
INSTALL PLUGIN plugin_name SONAME 'library_name.so';

-- ğŸ”¸ æŸ¥çœ‹å·²å®‰è£…æ’ä»¶  
SELECT PLUGIN_NAME, PLUGIN_STATUS, PLUGIN_TYPE 
FROM INFORMATION_SCHEMA.PLUGINS 
WHERE PLUGIN_TYPE = 'VALIDATE PASSWORD';

-- ğŸ”¸ å¸è½½æ’ä»¶
UNINSTALL PLUGIN plugin_name;
```

> âš ï¸ **æ³¨æ„äº‹é¡¹**  
> æ’ä»¶å¸è½½åï¼Œä¹‹å‰ä¾èµ–è¯¥æ’ä»¶çš„å¯†ç ç­–ç•¥å°†å¤±æ•ˆï¼Œéœ€è¦é‡æ–°é…ç½®éªŒè¯è§„åˆ™ã€‚

---

## 3. ğŸ› ï¸ è‡ªå®šä¹‰éªŒè¯é€»è¾‘å¼€å‘


### 3.1 éªŒè¯é€»è¾‘åŸºæœ¬æ¡†æ¶


è‡ªå®šä¹‰éªŒè¯æ’ä»¶éœ€è¦å®ç°**å¯†ç æ£€æŸ¥æ¥å£**ï¼ŒMySQLä¼šåœ¨å¯†ç è®¾ç½®æ—¶è°ƒç”¨è¿™äº›å‡½æ•°ã€‚

```c
// åŸºæœ¬éªŒè¯å‡½æ•°ç­¾å
int validate_password_strength(
    const char *password,      // å¾…éªŒè¯å¯†ç 
    unsigned int length,       // å¯†ç é•¿åº¦
    void *context             // ä¸Šä¸‹æ–‡ä¿¡æ¯
);
```

### 3.2 å¸¸è§éªŒè¯è§„åˆ™å®ç°


**ğŸ”¸ é•¿åº¦å’Œå¤æ‚åº¦æ£€æŸ¥**
```c
int check_password_complexity(const char *password, unsigned int length) {
    int has_upper = 0, has_lower = 0, has_digit = 0, has_special = 0;
    
    // æ£€æŸ¥æœ€å°é•¿åº¦
    if (length < MIN_PASSWORD_LENGTH) {
        return VALIDATION_FAILED;
    }
    
    // éå†å­—ç¬¦æ£€æŸ¥å¤æ‚åº¦
    for (int i = 0; i < length; i++) {
        if (isupper(password[i])) has_upper = 1;
        else if (islower(password[i])) has_lower = 1;
        else if (isdigit(password[i])) has_digit = 1;
        else has_special = 1;
    }
    
    // è¦æ±‚è‡³å°‘åŒ…å«3ç§å­—ç¬¦ç±»å‹
    int complexity_score = has_upper + has_lower + has_digit + has_special;
    return (complexity_score >= 3) ? VALIDATION_PASSED : VALIDATION_FAILED;
}
```

**ğŸ”¸ å­—å…¸æ£€æŸ¥å®ç°**
```c
int check_common_passwords(const char *password) {
    // å¸¸è§å¼±å¯†ç åˆ—è¡¨
    const char *weak_passwords[] = {
        "password", "123456", "admin", "qwerty", "welcome"
    };
    
    for (int i = 0; i < WEAK_PASSWORD_COUNT; i++) {
        if (strcasecmp(password, weak_passwords[i]) == 0) {
            return VALIDATION_FAILED;  // å‘ç°å¼±å¯†ç 
        }
    }
    return VALIDATION_PASSED;
}
```

### 3.3 éªŒè¯ç»“æœå¤„ç†


```c
typedef enum {
    PASSWORD_VALIDATION_OK = 0,        // éªŒè¯é€šè¿‡
    PASSWORD_VALIDATION_WEAK = 1,      // å¯†ç å¼ºåº¦ä¸è¶³
    PASSWORD_VALIDATION_DICTIONARY = 2, // å­—å…¸å¯†ç 
    PASSWORD_VALIDATION_USER_BASED = 3  // åŸºäºç”¨æˆ·ä¿¡æ¯
} password_validation_result_t;
```

---

## 4. ğŸ”§ æ’ä»¶é…ç½®ä¸å‚æ•°ç®¡ç†


### 4.1 ç³»ç»Ÿå˜é‡å®šä¹‰


æ’ä»¶é€šè¿‡**ç³»ç»Ÿå˜é‡**æš´éœ²é…ç½®å‚æ•°ï¼Œç®¡ç†å‘˜å¯ä»¥åŠ¨æ€è°ƒæ•´éªŒè¯ç­–ç•¥ã€‚

```c
// å®šä¹‰é…ç½®å˜é‡
static MYSQL_SYSVAR_INT(
    length,                           // å˜é‡å
    validate_password_length,         // å†…éƒ¨å˜é‡
    PLUGIN_VAR_RQCMDARG,             // å˜é‡å±æ€§
    "Password minimum length",        // æè¿°ä¿¡æ¯
    NULL, NULL,                      // æ£€æŸ¥å’Œæ›´æ–°å‡½æ•°
    8,                               // é»˜è®¤å€¼
    0, 65535,                        // å–å€¼èŒƒå›´
    0                                // å—å¤§å°
);

static struct st_mysql_sys_var* validate_password_system_variables[] = {
    MYSQL_SYSVAR(length),
    MYSQL_SYSVAR(policy),
    MYSQL_SYSVAR(mixed_case_count),
    NULL
};
```

### 4.2 é…ç½®å‚æ•°ç±»å‹


| å‚æ•°ç±»å‹ | **ç”¨é€”è¯´æ˜** | **é…ç½®ç¤ºä¾‹** | **å–å€¼èŒƒå›´** |
|---------|------------|-------------|-------------|
| ğŸ”¸ **LENGTH** | `æœ€å°å¯†ç é•¿åº¦` | `8-128å­—ç¬¦` | `æ­£æ•´æ•°` |
| ğŸ”¸ **POLICY** | `éªŒè¯ç­–ç•¥çº§åˆ«` | `LOW/MEDIUM/STRONG` | `æšä¸¾å€¼` |
| ğŸ”¸ **MIXED_CASE** | `å¤§å°å†™å­—ç¬¦è¦æ±‚` | `è‡³å°‘1ä¸ªå¤§å†™+å°å†™` | `0-å¯†ç é•¿åº¦` |
| ğŸ”¸ **NUMBER_COUNT** | `æ•°å­—å­—ç¬¦è¦æ±‚` | `è‡³å°‘2ä¸ªæ•°å­—` | `0-å¯†ç é•¿åº¦` |
| ğŸ”¸ **SPECIAL_CHAR** | `ç‰¹æ®Šå­—ç¬¦è¦æ±‚` | `è‡³å°‘1ä¸ªç‰¹æ®Šç¬¦å·` | `0-å¯†ç é•¿åº¦` |

### 4.3 åŠ¨æ€é…ç½®ç®¡ç†


```sql
-- ğŸ”¸ æŸ¥çœ‹å½“å‰é…ç½®
SHOW VARIABLES LIKE 'validate_password%';

-- ğŸ”¸ åŠ¨æ€ä¿®æ”¹é…ç½®
SET GLOBAL validate_password.length = 12;
SET GLOBAL validate_password.policy = 'STRONG';
SET GLOBAL validate_password.mixed_case_count = 2;

-- ğŸ”¸ æŒä¹…åŒ–é…ç½®
SET PERSIST validate_password.length = 12;
```

> ğŸ’¡ **é…ç½®ç”Ÿæ•ˆæœºåˆ¶**  
> å¤§éƒ¨åˆ†å‚æ•°ä¿®æ”¹åç«‹å³ç”Ÿæ•ˆï¼Œå½±å“åç»­çš„å¯†ç è®¾ç½®æ“ä½œã€‚ä½†æŸäº›å‚æ•°å¯èƒ½éœ€è¦é‡æ–°åŠ è½½æ’ä»¶æ‰èƒ½ç”Ÿæ•ˆã€‚

---

## 5. ğŸ”— éªŒè¯å‡½æ•°æ¥å£è¯¦è§£


### 5.1 æ ¸å¿ƒæ¥å£å‡½æ•°


å¯†ç éªŒè¯æ’ä»¶å¿…é¡»å®ç°**æ ‡å‡†æ¥å£å‡½æ•°**ï¼ŒMySQLé€šè¿‡è¿™äº›æ¥å£è°ƒç”¨éªŒè¯é€»è¾‘ã€‚

```c
// ä¸»éªŒè¯æ¥å£
typedef struct st_mysql_validate_password {
    int interface_version;
    
    // éªŒè¯å¯†ç å¼ºåº¦ 
    int (*validate_password)(MYSQL_THD thd, 
                            const char *password, 
                            unsigned int length);
    
    // è·å–å¯†ç å¼ºåº¦è¯„åˆ†
    int (*get_password_strength)(MYSQL_THD thd,
                               const char *password,
                               unsigned int length);
} st_mysql_validate_password;
```

### 5.2 éªŒè¯å‡½æ•°å®ç°


**ğŸ”¸ ä¸»éªŒè¯å‡½æ•°**
```c
static int my_validate_password(MYSQL_THD thd, 
                               const char *password, 
                               unsigned int length) {
    // è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
    const char *username = get_current_username(thd);
    
    // æ‰§è¡ŒåŸºç¡€æ£€æŸ¥
    if (check_basic_requirements(password, length) != 0) {
        return 1;  // éªŒè¯å¤±è´¥
    }
    
    // æ‰§è¡Œç”¨æˆ·ç›¸å…³æ£€æŸ¥
    if (password_contains_username(password, username)) {
        return 1;  // å¯†ç åŒ…å«ç”¨æˆ·å
    }
    
    // æ‰§è¡Œå­—å…¸æ£€æŸ¥
    if (check_dictionary_password(password) != 0) {
        return 1;  // å‘ç°å­—å…¸å¯†ç 
    }
    
    return 0;  // éªŒè¯é€šè¿‡
}
```

**ğŸ”¸ å¼ºåº¦è¯„åˆ†å‡½æ•°**
```c
static int get_password_strength(MYSQL_THD thd,
                               const char *password,
                               unsigned int length) {
    int strength = 0;
    
    // é•¿åº¦åŠ åˆ†
    strength += (length >= 8) ? 25 : 0;
    strength += (length >= 12) ? 25 : 0;
    
    // å¤æ‚åº¦åŠ åˆ†
    if (has_uppercase(password)) strength += 15;
    if (has_lowercase(password)) strength += 15;
    if (has_numbers(password)) strength += 10;
    if (has_special_chars(password)) strength += 10;
    
    return min(strength, 100);  // æœ€é«˜100åˆ†
}
```

### 5.3 é”™è¯¯å¤„ç†æœºåˆ¶


```c
// éªŒè¯å¤±è´¥æ—¶çš„é”™è¯¯ä¿¡æ¯
typedef enum {
    PWD_ERR_OK = 0,
    PWD_ERR_TOO_SHORT,
    PWD_ERR_NO_UPPERCASE,
    PWD_ERR_NO_LOWERCASE, 
    PWD_ERR_NO_NUMBERS,
    PWD_ERR_DICTIONARY_WORD,
    PWD_ERR_CONTAINS_USERNAME
} password_error_t;

// ç”Ÿæˆé”™è¯¯æ¶ˆæ¯
const char* get_error_message(password_error_t error) {
    switch(error) {
        case PWD_ERR_TOO_SHORT:
            return "Password is too short";
        case PWD_ERR_NO_UPPERCASE:
            return "Password must contain uppercase letters";
        default:
            return "Password validation failed";
    }
}
```

---

## 6. ğŸ›¡ï¸ æ’ä»¶å®‰å…¨æ€§è®¾è®¡


### 6.1 å®‰å…¨å¨èƒåˆ†æ


å¯†ç éªŒè¯æ’ä»¶å¤„ç†æ•æ„Ÿä¿¡æ¯ï¼Œéœ€è¦è€ƒè™‘å¤šç§å®‰å…¨å¨èƒï¼š

**ğŸ”¸ ä¸»è¦å®‰å…¨é£é™©**
- **å†…å­˜æ³„éœ²**: å¯†ç åœ¨å†…å­˜ä¸­çš„æ˜æ–‡å­˜å‚¨
- **æ—¥å¿—æ³„éœ²**: éªŒè¯è¿‡ç¨‹ä¸­çš„æ•æ„Ÿä¿¡æ¯è®°å½•
- **ç¼“å†²åŒºæº¢å‡º**: å¤„ç†å¼‚å¸¸é•¿åº¦å¯†ç æ—¶çš„å®‰å…¨é—®é¢˜
- **æ’ä»¶åŠ«æŒ**: æ¶æ„æ’ä»¶æ›¿æ¢åˆæ³•æ’ä»¶

### 6.2 å®‰å…¨é˜²æŠ¤æªæ–½


**ğŸ”¸ å†…å­˜å®‰å…¨å¤„ç†**
```c
// å®‰å…¨çš„å¯†ç å¤„ç†å‡½æ•°
int secure_password_validate(const char *password, unsigned int length) {
    char *secure_buffer = NULL;
    int result = 0;
    
    // åˆ†é…å®‰å…¨ç¼“å†²åŒº
    secure_buffer = mysql_malloc(length + 1, MYF(MY_WME));
    if (!secure_buffer) return -1;
    
    // å¤åˆ¶å¯†ç åˆ°å®‰å…¨åŒºåŸŸ
    memcpy(secure_buffer, password, length);
    secure_buffer[length] = '\0';
    
    // æ‰§è¡ŒéªŒè¯é€»è¾‘
    result = perform_validation(secure_buffer, length);
    
    // å®‰å…¨æ¸…ç†å†…å­˜
    memset(secure_buffer, 0, length + 1);
    mysql_free(secure_buffer);
    
    return result;
}
```

**ğŸ”¸ è¾“å…¥éªŒè¯å’Œè¾¹ç•Œæ£€æŸ¥**
```c
int validate_input_safety(const char *password, unsigned int length) {
    // æ£€æŸ¥ç©ºæŒ‡é’ˆ
    if (password == NULL) {
        return VALIDATION_ERROR;
    }
    
    // æ£€æŸ¥é•¿åº¦è¾¹ç•Œ
    if (length > MAX_PASSWORD_LENGTH || length == 0) {
        return VALIDATION_ERROR;
    }
    
    // æ£€æŸ¥å­—ç¬¦ç¼–ç 
    if (!is_valid_utf8(password, length)) {
        return VALIDATION_ERROR;
    }
    
    return VALIDATION_OK;
}
```

### 6.3 æƒé™æ§åˆ¶æœºåˆ¶


```sql
-- ğŸ”¸ é™åˆ¶æ’ä»¶ç®¡ç†æƒé™
GRANT SYSTEM_VARIABLES_ADMIN ON *.* TO 'admin_user'@'localhost';

-- ğŸ”¸ å®¡è®¡æ’ä»¶æ“ä½œ
CREATE TABLE plugin_audit_log (
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    user VARCHAR(100),
    operation VARCHAR(50),
    plugin_name VARCHAR(100),
    result VARCHAR(20)
);
```

---

## 7. ğŸ”— ç¬¬ä¸‰æ–¹éªŒè¯é›†æˆ


### 7.1 å¤–éƒ¨éªŒè¯ç³»ç»Ÿå¯¹æ¥


ä¼ä¸šç¯å¢ƒä¸­ç»å¸¸éœ€è¦é›†æˆ**å¤–éƒ¨èº«ä»½éªŒè¯ç³»ç»Ÿ**ï¼Œå¦‚LDAPã€Active Directoryæˆ–è‡ªå®šä¹‰éªŒè¯æœåŠ¡ã€‚

```c
// LDAPéªŒè¯é›†æˆç¤ºä¾‹
int validate_with_ldap(const char *username, const char *password) {
    LDAP *ld = NULL;
    int result = 0;
    
    // åˆå§‹åŒ–LDAPè¿æ¥
    ld = ldap_init(LDAP_SERVER, LDAP_PORT);
    if (ld == NULL) {
        return VALIDATION_ERROR;
    }
    
    // æ„å»ºç”¨æˆ·DN
    char user_dn[256];
    snprintf(user_dn, sizeof(user_dn), 
             "uid=%s,ou=users,dc=company,dc=com", username);
    
    // æ‰§è¡Œå¯†ç éªŒè¯
    result = ldap_simple_bind_s(ld, user_dn, password);
    ldap_unbind(ld);
    
    return (result == LDAP_SUCCESS) ? VALIDATION_PASSED : VALIDATION_FAILED;
}
```

### 7.2 WebæœåŠ¡éªŒè¯é›†æˆ


```c
// HTTP APIéªŒè¯é›†æˆ
int validate_with_web_service(const char *username, const char *password) {
    CURL *curl;
    CURLcode res;
    struct curl_response response = {0};
    
    curl = curl_easy_init();
    if (curl) {
        // è®¾ç½®è¯·æ±‚URL
        curl_easy_setopt(curl, CURLOPT_URL, "https://auth.company.com/validate");
        
        // è®¾ç½®POSTæ•°æ®
        char post_data[512];
        snprintf(post_data, sizeof(post_data), 
                 "username=%s&password=%s", username, password);
        curl_easy_setopt(curl, CURLOPT_POSTFIELDS, post_data);
        
        // è®¾ç½®å“åº”å¤„ç†
        curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, response_callback);
        curl_easy_setopt(curl, CURLOPT_WRITEDATA, &response);
        
        // æ‰§è¡Œè¯·æ±‚
        res = curl_easy_perform(curl);
        curl_easy_cleanup(curl);
        
        // è§£æå“åº”
        return parse_validation_response(response.data);
    }
    
    return VALIDATION_ERROR;
}
```

### 7.3 ç¼“å­˜ä¼˜åŒ–ç­–ç•¥


```c
// éªŒè¯ç»“æœç¼“å­˜
typedef struct {
    char username[64];
    char password_hash[32];
    time_t expire_time;
    int validation_result;
} validation_cache_entry_t;

static validation_cache_entry_t validation_cache[MAX_CACHE_SIZE];

int get_cached_validation(const char *username, const char *password) {
    char password_hash[32];
    
    // è®¡ç®—å¯†ç å“ˆå¸Œ
    calculate_md5(password, password_hash);
    
    // æŸ¥æ‰¾ç¼“å­˜
    for (int i = 0; i < MAX_CACHE_SIZE; i++) {
        if (validation_cache[i].expire_time > time(NULL) &&
            strcmp(validation_cache[i].username, username) == 0 &&
            strcmp(validation_cache[i].password_hash, password_hash) == 0) {
            return validation_cache[i].validation_result;
        }
    }
    
    return CACHE_MISS;
}
```

---

## 8. ğŸ”„ å¤šæ’ä»¶æ”¯æŒæœºåˆ¶


### 8.1 æ’ä»¶é“¾å¼è°ƒç”¨


MySQLæ”¯æŒ**åŒæ—¶åŠ è½½å¤šä¸ª**éªŒè¯æ’ä»¶ï¼Œé€šè¿‡é“¾å¼è°ƒç”¨æœºåˆ¶ä¾æ¬¡æ‰§è¡ŒéªŒè¯ã€‚

```
å¯†ç éªŒè¯è¯·æ±‚ â†’ æ’ä»¶A â†’ æ’ä»¶B â†’ æ’ä»¶C â†’ æœ€ç»ˆç»“æœ
      â†“         â†“        â†“        â†“         â†“
   ç”¨æˆ·è¾“å…¥   é•¿åº¦æ£€æŸ¥  å¤æ‚åº¦æ£€æŸ¥  å­—å…¸æ£€æŸ¥   é€šè¿‡/æ‹’ç»
```

### 8.2 æ’ä»¶ä¼˜å…ˆçº§ç®¡ç†


```c
typedef struct {
    char name[64];
    int priority;                    // ä¼˜å…ˆçº§(æ•°å­—è¶Šå°è¶Šä¼˜å…ˆ)
    validate_function_t validator;   // éªŒè¯å‡½æ•°
    int continue_on_success;         // æˆåŠŸåæ˜¯å¦ç»§ç»­
} plugin_entry_t;

// æ’ä»¶æ³¨å†Œè¡¨
static plugin_entry_t plugin_registry[MAX_PLUGINS];
static int plugin_count = 0;

// æŒ‰ä¼˜å…ˆçº§æ’åºæ‰§è¡Œ
int execute_validation_chain(const char *password, unsigned int length) {
    // æŒ‰ä¼˜å…ˆçº§æ’åº
    qsort(plugin_registry, plugin_count, sizeof(plugin_entry_t), 
          compare_priority);
    
    // ä¾æ¬¡æ‰§è¡ŒéªŒè¯
    for (int i = 0; i < plugin_count; i++) {
        int result = plugin_registry[i].validator(password, length);
        
        if (result != VALIDATION_PASSED) {
            return result;  // ä»»ä½•æ’ä»¶å¤±è´¥éƒ½åœæ­¢
        }
        
        if (!plugin_registry[i].continue_on_success) {
            break;  // æŸäº›æ’ä»¶æˆåŠŸåå°±åœæ­¢
        }
    }
    
    return VALIDATION_PASSED;
}
```

### 8.3 æ’ä»¶é…ç½®éš”ç¦»


```sql
-- ğŸ”¸ ä¸åŒæ’ä»¶ç‹¬ç«‹é…ç½®
SET GLOBAL plugin_a.min_length = 8;
SET GLOBAL plugin_b.complexity_level = 'HIGH';
SET GLOBAL plugin_c.dictionary_check = 'ENABLED';

-- ğŸ”¸ æŸ¥çœ‹æ‰€æœ‰æ’ä»¶é…ç½®
SELECT VARIABLE_NAME, VARIABLE_VALUE 
FROM PERFORMANCE_SCHEMA.GLOBAL_VARIABLES 
WHERE VARIABLE_NAME LIKE '%password%';
```

### 8.4 æ’ä»¶åä½œæœºåˆ¶


```c
// æ’ä»¶é—´æ•°æ®å…±äº«ç»“æ„
typedef struct {
    int length_score;
    int complexity_score;
    int dictionary_score;
    char error_message[256];
} validation_context_t;

// æ’ä»¶A: åŸºç¡€æ£€æŸ¥
int plugin_a_validate(const char *password, validation_context_t *ctx) {
    ctx->length_score = calculate_length_score(password);
    if (ctx->length_score < MIN_LENGTH_SCORE) {
        strcpy(ctx->error_message, "Password too short");
        return VALIDATION_FAILED;
    }
    return VALIDATION_PASSED;
}

// æ’ä»¶B: å¤æ‚åº¦æ£€æŸ¥  
int plugin_b_validate(const char *password, validation_context_t *ctx) {
    ctx->complexity_score = calculate_complexity_score(password);
    if (ctx->complexity_score < MIN_COMPLEXITY_SCORE) {
        strcpy(ctx->error_message, "Password not complex enough");
        return VALIDATION_FAILED;
    }
    return VALIDATION_PASSED;
}
```

---

## 9. ğŸ”’ æ’ä»¶å®‰å…¨å¼€å‘è§„èŒƒ


### 9.1 ä»£ç å®‰å…¨è§„èŒƒ


å¼€å‘å¯†ç éªŒè¯æ’ä»¶æ—¶å¿…é¡»éµå¾ª**ä¸¥æ ¼çš„å®‰å…¨ç¼–ç è§„èŒƒ**ï¼Œé¿å…å¼•å…¥å®‰å…¨æ¼æ´ã€‚

**ğŸ”¸ å†…å­˜ç®¡ç†è§„èŒƒ**
```c
// âœ… æ­£ç¡®çš„å†…å­˜ç®¡ç†
char* safe_password_copy(const char *password, size_t length) {
    // æ£€æŸ¥è¾“å…¥å‚æ•°
    if (!password || length == 0 || length > MAX_PASSWORD_LENGTH) {
        return NULL;
    }
    
    // åˆ†é…å†…å­˜
    char *buffer = mysql_malloc(length + 1, MYF(MY_WME | MY_ZEROFILL));
    if (!buffer) {
        return NULL;
    }
    
    // å®‰å…¨å¤åˆ¶
    memcpy(buffer, password, length);
    buffer[length] = '\0';
    
    return buffer;
}

// âŒ å±é™©çš„å†…å­˜æ“ä½œ
char* unsafe_password_copy(const char *password) {
    char buffer[100];  // å›ºå®šå¤§å°ç¼“å†²åŒº
    strcpy(buffer, password);  // å¯èƒ½ç¼“å†²åŒºæº¢å‡º
    return buffer;  // è¿”å›æ ˆå†…å­˜åœ°å€
}
```

**ğŸ”¸ å­—ç¬¦ä¸²å¤„ç†å®‰å…¨**
```c
// å®‰å…¨çš„å­—ç¬¦ä¸²æ¯”è¾ƒ
int safe_string_compare(const char *str1, const char *str2, size_t max_len) {
    if (!str1 || !str2) return -1;
    
    size_t len1 = strnlen(str1, max_len);
    size_t len2 = strnlen(str2, max_len);
    
    if (len1 != len2) return 1;
    
    // ä½¿ç”¨æ—¶é—´æ’å®šæ¯”è¾ƒé¿å…æ—¶åºæ”»å‡»
    return memcmp(str1, str2, len1);
}
```

### 9.2 æ’ä»¶å®‰å…¨æµ‹è¯•æ–¹æ³•


**ğŸ”¸ å•å…ƒæµ‹è¯•æ¡†æ¶**
```c
// æµ‹è¯•ç”¨ä¾‹ç»“æ„
typedef struct {
    const char *test_name;
    const char *password;
    int expected_result;
    const char *description;
} test_case_t;

// å®‰å…¨æµ‹è¯•ç”¨ä¾‹
test_case_t security_tests[] = {
    {"buffer_overflow", 
     "A" * 10000,  // è¶…é•¿å¯†ç 
     VALIDATION_ERROR, 
     "Test buffer overflow protection"},
     
    {"null_pointer", 
     NULL, 
     VALIDATION_ERROR, 
     "Test null pointer handling"},
     
    {"empty_string", 
     "", 
     VALIDATION_ERROR, 
     "Test empty password handling"},
};

// æ‰§è¡Œå®‰å…¨æµ‹è¯•
void run_security_tests() {
    for (int i = 0; i < ARRAY_SIZE(security_tests); i++) {
        test_case_t *test = &security_tests[i];
        int result = validate_password_strength(test->password, 
                                               strlen(test->password));
        
        if (result != test->expected_result) {
            printf("FAIL: %s - %s\n", test->test_name, test->description);
        } else {
            printf("PASS: %s\n", test->test_name);
        }
    }
}
```

**ğŸ”¸ æ¨¡ç³Šæµ‹è¯•é›†æˆ**
```c
// æ¨¡ç³Šæµ‹è¯•æ¥å£
void fuzz_test_validation(void) {
    for (int i = 0; i < FUZZ_ITERATIONS; i++) {
        // ç”Ÿæˆéšæœºæµ‹è¯•æ•°æ®
        char *random_password = generate_random_string(rand() % 1000);
        
        // æ‰§è¡ŒéªŒè¯(åº”è¯¥ä¸ä¼šå´©æºƒ)
        __try {
            validate_password_strength(random_password, strlen(random_password));
        } __except(EXCEPTION_EXECUTE_HANDLER) {
            printf("CRASH detected with input: %s\n", random_password);
        }
        
        free(random_password);
    }
}
```

### 9.3 å®‰å…¨å®¡è®¡è¦æ±‚


**ğŸ”¸ ä»£ç å®¡è®¡æ£€æŸ¥æ¸…å•**
- [ ] **è¾“å…¥éªŒè¯**: æ‰€æœ‰è¾“å…¥å‚æ•°éƒ½ç»è¿‡éªŒè¯
- [ ] **ç¼“å†²åŒºä¿æŠ¤**: æ²¡æœ‰ç¼“å†²åŒºæº¢å‡ºé£é™©
- [ ] **å†…å­˜ç®¡ç†**: æ­£ç¡®åˆ†é…å’Œé‡Šæ”¾å†…å­˜
- [ ] **é”™è¯¯å¤„ç†**: å®Œæ•´çš„é”™è¯¯å¤„ç†æœºåˆ¶
- [ ] **æƒé™æ£€æŸ¥**: é€‚å½“çš„æƒé™éªŒè¯
- [ ] **æ—¥å¿—å®‰å…¨**: ä¸è®°å½•æ•æ„Ÿä¿¡æ¯

**ğŸ”¸ éƒ¨ç½²å‰å®‰å…¨æ£€æŸ¥**
```bash
# é™æ€ä»£ç åˆ†æ
cppcheck --enable=all --inconclusive plugin_source.c

# å†…å­˜æ³„æ¼æ£€æŸ¥
valgrind --leak-check=full --show-leak-kinds=all ./test_plugin

# å®‰å…¨æ¼æ´æ‰«æ
flawfinder plugin_source.c
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æ’ä»¶æœ¬è´¨ï¼šMySQLçš„å¯æ‰©å±•å¯†ç éªŒè¯æœºåˆ¶ï¼Œå…è®¸è‡ªå®šä¹‰éªŒè¯è§„åˆ™
ğŸ”¸ å·¥ä½œåŸç†ï¼šç”¨æˆ·è®¾ç½®å¯†ç æ—¶ï¼ŒMySQLè°ƒç”¨æ’ä»¶è¿›è¡Œå¼ºåº¦æ£€æŸ¥
ğŸ”¸ æ³¨å†Œæœºåˆ¶ï¼šé€šè¿‡åŠ¨æ€åŠ è½½.soæ–‡ä»¶ï¼Œæ³¨å†ŒéªŒè¯å‡½æ•°åˆ°MySQL
ğŸ”¸ æ¥å£è§„èŒƒï¼šå®ç°æ ‡å‡†çš„éªŒè¯æ¥å£ï¼Œè¿”å›é€šè¿‡/æ‹’ç»ç»“æœ
ğŸ”¸ å®‰å…¨è¦æ±‚ï¼šå¤„ç†æ•æ„Ÿä¿¡æ¯ï¼Œå¿…é¡»éµå¾ªä¸¥æ ¼çš„å®‰å…¨å¼€å‘è§„èŒƒ
```

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æ’ä»¶çš„ä½œç”¨ä»·å€¼**
```
ç»Ÿä¸€ç®¡æ§ï¼šåœ¨æ•°æ®åº“å±‚é¢ç»Ÿä¸€æ§åˆ¶å¯†ç ç­–ç•¥
çµæ´»å®šåˆ¶ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚å®šåˆ¶ä¸åŒçš„éªŒè¯è§„åˆ™  
åˆè§„æ”¯æŒï¼šæ»¡è¶³ä¼ä¸šå®‰å…¨ç­–ç•¥å’Œæ³•è§„è¦æ±‚
æ‰©å±•èƒ½åŠ›ï¼šæ”¯æŒé›†æˆå¤–éƒ¨éªŒè¯ç³»ç»Ÿ
```

**ğŸ”¹ å¼€å‘å®ç°è¦ç‚¹**
```
æ¥å£å®ç°ï¼šæ­£ç¡®å®ç°MySQLå®šä¹‰çš„éªŒè¯æ¥å£å‡½æ•°
å‚æ•°é…ç½®ï¼šé€šè¿‡ç³»ç»Ÿå˜é‡æš´éœ²å¯é…ç½®çš„éªŒè¯å‚æ•°
é”™è¯¯å¤„ç†ï¼šæä¾›æ¸…æ™°çš„éªŒè¯å¤±è´¥åŸå› å’Œé”™è¯¯ä¿¡æ¯
å®‰å…¨ç¼–ç ï¼šé¿å…å†…å­˜æ³„æ¼ã€ç¼“å†²åŒºæº¢å‡ºç­‰å®‰å…¨é—®é¢˜
```

**ğŸ”¹ éƒ¨ç½²è¿ç»´è€ƒè™‘**
```
æ€§èƒ½å½±å“ï¼šéªŒè¯è¿‡ç¨‹ä¼šå¢åŠ å¯†ç è®¾ç½®çš„è€—æ—¶
é«˜å¯ç”¨æ€§ï¼šæ’ä»¶æ•…éšœä¸åº”å½±å“æ•°æ®åº“æ­£å¸¸è¿è¡Œ
ç›‘æ§å®¡è®¡ï¼šè®°å½•éªŒè¯ç»“æœå’Œå¼‚å¸¸æƒ…å†µ
ç‰ˆæœ¬å…¼å®¹ï¼šç¡®ä¿æ’ä»¶ä¸MySQLç‰ˆæœ¬çš„å…¼å®¹æ€§
```

### 10.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ åº”ç”¨åœºæ™¯é€‰æ‹©**
- **é‡‘èè¡Œä¸š**: å¼ºå¯†ç ç­–ç•¥ï¼Œå¤šå› ç´ éªŒè¯é›†æˆ
- **ä¼ä¸šå†…ç½‘**: ä¸AD/LDAPé›†æˆï¼Œç»Ÿä¸€èº«ä»½ç®¡ç†
- **SaaSæœåŠ¡**: å¤šç§Ÿæˆ·å¯†ç ç­–ç•¥ï¼Œçµæ´»é…ç½®
- **å¼€å‘æµ‹è¯•**: ç®€åŒ–éªŒè¯è§„åˆ™ï¼Œæé«˜å¼€å‘æ•ˆç‡

**ğŸ”§ æœ€ä½³å®è·µå»ºè®®**
1. **æ¸è¿›å¼éƒ¨ç½²**: å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ï¼Œå†é€æ­¥æ¨å¹¿
2. **æ€§èƒ½æµ‹è¯•**: è¯„ä¼°éªŒè¯é€»è¾‘å¯¹æ•°æ®åº“æ€§èƒ½çš„å½±å“
3. **å¤‡ä»½ç­–ç•¥**: ä¿ç•™åŸæœ‰éªŒè¯æœºåˆ¶ä½œä¸ºå¤‡é€‰æ–¹æ¡ˆ
4. **ç”¨æˆ·åŸ¹è®­**: è®©ç”¨æˆ·äº†è§£æ–°çš„å¯†ç è¦æ±‚å’Œè§„åˆ™

**æ ¸å¿ƒè®°å¿†**ï¼š
- å¯†ç éªŒè¯æ’ä»¶æ˜¯MySQLå®‰å…¨é˜²æŠ¤çš„é‡è¦ç»„ä»¶
- å¼€å‘æ—¶å¿…é¡»ä¸¥æ ¼éµå¾ªå®‰å…¨ç¼–ç è§„èŒƒ
- æ’ä»¶è®¾è®¡è¦å¹³è¡¡å®‰å…¨æ€§ã€æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ
- éƒ¨ç½²å‰éœ€è¦å……åˆ†æµ‹è¯•å’Œå®‰å…¨å®¡è®¡