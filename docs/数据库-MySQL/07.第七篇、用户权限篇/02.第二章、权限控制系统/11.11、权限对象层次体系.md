---
title: 11、权限对象层次体系
---
## 📚 目录

1. [权限对象分类与概述](#1-权限对象分类与概述)
2. [层次结构设计原理](#2-层次结构设计原理)
3. [对象权限映射机制](#3-对象权限映射机制)
4. [权限作用域详解](#4-权限作用域详解)
5. [对象权限继承规则](#5-对象权限继承规则)
6. [层次权限管理实践](#6-层次权限管理实践)
7. [权限对象查询与验证](#7-权限对象查询与验证)
8. [权限对象安全控制](#8-权限对象安全控制)
9. [核心要点总结](#9-核心要点总结)

---

## 1. 🎯 权限对象分类与概述


### 1.1 什么是权限对象


权限对象就是MySQL中可以被授权控制的资源，简单理解就是"你可以对什么东西进行操作"。

**💡 生活类比**：
```
就像你家的钥匙系统：
- 大门钥匙：可以进入整个家（全局权限）
- 房间钥匙：只能进入特定房间（数据库权限）
- 抽屉钥匙：只能打开特定抽屉（表权限）
- 保险箱钥匙：只能访问特定内容（字段权限）
```

### 1.2 MySQL权限对象的四大层次


```
┌─────────────────────────────────────┐
│           全局层次 (Global)          │  ← 整个MySQL服务器
├─────────────────────────────────────┤
│           数据库层次 (Database)       │  ← 特定数据库
├─────────────────────────────────────┤
│             表层次 (Table)          │  ← 特定数据表
├─────────────────────────────────────┤
│            字段层次 (Column)         │  ← 特定字段列
└─────────────────────────────────────┘
```

**🔸 层次特点说明**：
- **范围递减**：从上到下权限范围越来越小
- **精度递增**：从上到下控制越来越精细
- **优先级**：下层权限可以覆盖上层权限

### 1.3 权限对象的具体分类


#### 🌐 全局对象 (Global Level)

```sql
-- 影响整个MySQL服务器的权限
GRANT ALL PRIVILEGES ON *.* TO 'admin'@'localhost';
```

**包含对象**：
- `*.*` - 所有数据库的所有表
- 服务器管理功能（创建用户、重载权限等）
- 全局系统变量
- 服务器状态和日志

#### 🏢 数据库对象 (Database Level)

```sql
-- 只影响特定数据库的权限
GRANT SELECT, INSERT ON company.* TO 'employee'@'localhost';
```

**包含对象**：
- `database.*` - 指定数据库的所有表
- 数据库创建和删除
- 数据库内的存储过程和函数

#### 📋 表对象 (Table Level)

```sql
-- 只影响特定表的权限
GRANT SELECT, UPDATE ON company.employees TO 'hr'@'localhost';
```

**包含对象**：
- 特定表的数据操作
- 表结构修改
- 索引管理

#### 📝 字段对象 (Column Level)

```sql
-- 只影响特定字段的权限
GRANT SELECT (name, department) ON company.employees TO 'viewer'@'localhost';
```

**包含对象**：
- 特定字段的查询
- 特定字段的更新

---

## 2. 🏗️ 层次结构设计原理


### 2.1 金字塔式权限架构


MySQL的权限系统采用金字塔式设计，权限从上到下逐级细化。

```
                    🔑 全局权限
                   /           \
                 🏢 数据库权限    🏢 数据库权限
                /      \         /      \
             📋 表权限  📋 表权限  📋 表权限  📋 表权限
            /    \     /    \    /    \     /    \
         📝字段  📝字段  📝字段  📝字段  📝字段  📝字段  📝字段  📝字段
```

### 2.2 权限继承机制


**⬇️ 向下继承**：上层权限自动包含下层权限
```sql
-- 示例：全局SELECT权限自动包含所有数据库、表、字段的SELECT权限
GRANT SELECT ON *.* TO 'user'@'localhost';
-- 等价于对所有数据库、表、字段都有SELECT权限
```

**🔍 继承规则**：
- 全局权限 ➡️ 包含所有数据库权限
- 数据库权限 ➡️ 包含该数据库内所有表权限  
- 表权限 ➡️ 包含该表内所有字段权限

### 2.3 权限覆盖原则


**📊 覆盖优先级**：具体权限 > 通用权限

```sql
-- 场景：用户有全局INSERT权限，但特定表被拒绝INSERT
GRANT INSERT ON *.* TO 'user'@'localhost';           -- 全局INSERT权限
REVOKE INSERT ON sensitive.salary FROM 'user'@'localhost'; -- 撤销特定表权限

-- 结果：用户可以向所有表INSERT，除了sensitive.salary表
```

**💡 实际应用**：
```
🟢 默认策略：给予基础权限
🔴 例外处理：对敏感数据特殊限制
```

---

## 3. 🔗 对象权限映射机制


### 3.1 权限映射表结构


MySQL使用多个系统表来存储不同层次的权限映射关系。

```
权限存储表：
┌─────────────┬──────────────┬────────────────┐
│   权限层次   │   存储表名    │    主要字段     │
├─────────────┼──────────────┼────────────────┤
│   全局权限   │   mysql.user │ Host, User, 权限列 │
│   数据库权限 │   mysql.db   │ Host, User, Db    │
│   表权限     │mysql.tables_priv│ Host, User, Db, Table │
│   字段权限   │mysql.columns_priv│ Host, User, Db, Table, Column │
└─────────────┴──────────────┴────────────────┘
```

### 3.2 权限映射查询


**🔍 查看用户全局权限**：
```sql
-- 查看user表中的全局权限
SELECT Host, User, Select_priv, Insert_priv, Update_priv 
FROM mysql.user 
WHERE User = 'testuser';
```

**🔍 查看数据库级权限**：
```sql
-- 查看db表中的数据库权限
SELECT Host, User, Db, Select_priv, Insert_priv 
FROM mysql.db 
WHERE User = 'testuser' AND Db = 'company';
```

**🔍 查看表级权限**：
```sql
-- 查看tables_priv表中的表权限
SELECT Host, User, Db, Table_name, Table_priv 
FROM mysql.tables_priv 
WHERE User = 'testuser';
```

### 3.3 权限映射更新机制


**⚡ 权限更新流程**：
```
1. 执行GRANT/REVOKE命令
   ⬇️
2. MySQL更新相应的权限表
   ⬇️  
3. 权限缓存失效
   ⬇️
4. 下次访问时重新加载权限
```

**📝 权限刷新**：
```sql
-- 手动刷新权限（立即生效）
FLUSH PRIVILEGES;
```

---

## 4. 📍 权限作用域详解


### 4.1 全局作用域 (Global Scope)


全局作用域权限影响整个MySQL实例，是权限层次的最高级别。

**🌐 全局权限特点**：
- **作用范围**：整个MySQL服务器
- **权限存储**：`mysql.user`表
- **典型用途**：系统管理员权限

```sql
-- 创建超级管理员（全局所有权限）
GRANT ALL PRIVILEGES ON *.* TO 'admin'@'localhost' WITH GRANT OPTION;

-- 创建备份用户（全局读取权限）
GRANT SELECT, LOCK TABLES, SHOW VIEW ON *.* TO 'backup'@'localhost';
```

**⚠️ 注意事项**：
```
全局权限风险较高，应谨慎授予：
🔴 避免给普通用户全局权限
🟡 管理员权限要严格控制
🟢 最小权限原则优先
```

### 4.2 数据库作用域 (Database Scope)


数据库作用域权限只影响指定的数据库及其包含的所有表。

**🏢 数据库权限特点**：
- **作用范围**：指定数据库内的所有对象
- **权限存储**：`mysql.db`表
- **典型用途**：项目组权限分配

```sql
-- 给开发组分配开发数据库权限
GRANT SELECT, INSERT, UPDATE, DELETE ON dev_project.* TO 'developer'@'%';

-- 给测试组分配测试数据库权限
GRANT SELECT, INSERT, UPDATE ON test_project.* TO 'tester'@'%';
```

**📊 权限组合示例**：
```sql
-- 常见的数据库权限组合
GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER 
ON company.* TO 'app_user'@'localhost';
```

### 4.3 表作用域 (Table Scope)


表作用域权限只影响指定的数据表。

**📋 表权限特点**：
- **作用范围**：单个表的所有操作
- **权限存储**：`mysql.tables_priv`表
- **典型用途**：精细化权限控制

```sql
-- 给HR只能访问员工表
GRANT SELECT, INSERT, UPDATE ON company.employees TO 'hr'@'localhost';

-- 给财务只能访问薪资表
GRANT SELECT, UPDATE ON company.salary TO 'finance'@'localhost';
```

### 4.4 字段作用域 (Column Scope)


字段作用域是最精细的权限控制，只影响表中的特定字段。

**📝 字段权限特点**：
- **作用范围**：表中的指定字段
- **权限存储**：`mysql.columns_priv`表
- **典型用途**：敏感数据保护

```sql
-- 给查看员工基本信息，但不能看薪资
GRANT SELECT (id, name, department, email) 
ON company.employees TO 'viewer'@'localhost';

-- 给HR可以更新部分员工信息
GRANT UPDATE (department, position) 
ON company.employees TO 'hr'@'localhost';
```

**💡 字段权限实际应用**：
```
场景：员工信息表包含敏感字段
┌──────────┬──────────┬──────────┬──────────┐
│   姓名    │   部门    │   邮箱    │   薪资    │
├──────────┼──────────┼──────────┼──────────┤
│  普通员工  │    ✅     │    ✅     │    ❌     │
│    HR     │    ✅     │    ✅     │    ❌     │  
│   财务     │    ✅     │    ✅     │    ✅     │
│   管理员   │    ✅     │    ✅     │    ✅     │
└──────────┴──────────┴──────────┴──────────┘
```

---

## 5. 🧬 对象权限继承规则


### 5.1 权限继承的基本原理


权限继承让上级权限自动应用到下级对象，避免重复授权。

**⬇️ 继承方向**：
```
全局权限 (*.*)
    ↓ 自动继承
数据库权限 (db.*)  
    ↓ 自动继承
表权限 (db.table)
    ↓ 自动继承  
字段权限 (db.table.column)
```

### 5.2 继承优先级规则


**🔢 优先级顺序**：字段权限 > 表权限 > 数据库权限 > 全局权限

```sql
-- 示例：不同层次权限的覆盖关系
-- 1. 全局权限：用户有全局SELECT权限
GRANT SELECT ON *.* TO 'user'@'localhost';

-- 2. 表权限：撤销特定表的SELECT权限
REVOKE SELECT ON sensitive.data FROM 'user'@'localhost';

-- 3. 字段权限：只允许查看特定字段
GRANT SELECT (id, name) ON sensitive.data TO 'user'@'localhost';

-- 最终结果：用户可以查看所有表，除了sensitive.data表只能看id和name字段
```

### 5.3 权限继承检查机制


**🔍 MySQL权限检查顺序**：
```
1. 检查全局权限 (mysql.user)
   ↓ 如果没有权限，继续检查
2. 检查数据库权限 (mysql.db)  
   ↓ 如果没有权限，继续检查
3. 检查表权限 (mysql.tables_priv)
   ↓ 如果没有权限，继续检查
4. 检查字段权限 (mysql.columns_priv)
   ↓ 如果都没有权限
5. 拒绝访问
```

**💻 权限检查示例**：
```sql
-- 查看用户的有效权限（继承后的结果）
SHOW GRANTS FOR 'user'@'localhost';

-- 输出示例：
-- GRANT SELECT ON *.* TO 'user'@'localhost'
-- GRANT INSERT, UPDATE ON `company`.* TO 'user'@'localhost'  
-- GRANT DELETE ON `company`.`employees` TO 'user'@'localhost'
```

### 5.4 权限继承的实际应用


**🎯 分层授权策略**：
```sql
-- 第一层：给基础权限
GRANT SELECT ON company.* TO 'employee'@'localhost';

-- 第二层：给部门权限
GRANT INSERT, UPDATE ON company.employee_info TO 'hr'@'localhost';

-- 第三层：给管理权限  
GRANT DELETE ON company.* TO 'manager'@'localhost';

-- 第四层：给字段权限
GRANT UPDATE (salary) ON company.employee_info TO 'payroll'@'localhost';
```

---

## 6. 🛠️ 层次权限管理实践


### 6.1 权限管理最佳实践


**📋 权限设计原则**：
- ✅ **最小权限原则**：只给必需的权限
- ✅ **分层管理**：按职能分配不同层次权限
- ✅ **定期审核**：定期检查和清理权限
- ✅ **文档记录**：记录权限分配原因

### 6.2 常见权限管理场景


#### 🏢 企业级权限分配

```sql
-- 1. 数据库管理员（全局权限）
CREATE USER 'dba'@'localhost' IDENTIFIED BY 'strong_password';
GRANT ALL PRIVILEGES ON *.* TO 'dba'@'localhost' WITH GRANT OPTION;

-- 2. 应用程序用户（数据库权限）
CREATE USER 'app_user'@'%' IDENTIFIED BY 'app_password';
GRANT SELECT, INSERT, UPDATE, DELETE ON company.* TO 'app_user'@'%';

-- 3. 只读用户（表权限）
CREATE USER 'readonly'@'%' IDENTIFIED BY 'read_password';
GRANT SELECT ON company.employees TO 'readonly'@'%';
GRANT SELECT ON company.departments TO 'readonly'@'%';

-- 4. 报表用户（字段权限）
CREATE USER 'reporter'@'localhost' IDENTIFIED BY 'report_password';
GRANT SELECT (name, department, hire_date) ON company.employees TO 'reporter'@'localhost';
```

#### 📊 开发测试环境权限

```sql
-- 开发环境：较宽松权限
GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER 
ON dev_*.* TO 'developer'@'%';

-- 测试环境：中等权限
GRANT SELECT, INSERT, UPDATE, DELETE 
ON test_*.* TO 'tester'@'%';

-- 生产环境：严格权限
GRANT SELECT, INSERT, UPDATE 
ON prod_app.* TO 'app_prod'@'app_server_ip';
```

### 6.3 权限回收和清理


**🧹 权限清理步骤**：
```sql
-- 1. 查看用户当前权限
SHOW GRANTS FOR 'old_user'@'localhost';

-- 2. 逐层回收权限
REVOKE ALL PRIVILEGES ON *.* FROM 'old_user'@'localhost';
REVOKE ALL PRIVILEGES ON company.* FROM 'old_user'@'localhost';

-- 3. 删除用户
DROP USER 'old_user'@'localhost';

-- 4. 刷新权限
FLUSH PRIVILEGES;
```

### 6.4 权限变更管理


**📝 权限变更流程**：
```sql
-- 临时权限提升
GRANT CREATE, DROP ON temp_project.* TO 'developer'@'localhost';
-- 操作完成后及时回收
REVOKE CREATE, DROP ON temp_project.* FROM 'developer'@'localhost';

-- 权限降级
REVOKE DELETE ON company.* FROM 'junior_dev'@'localhost';
GRANT SELECT, INSERT, UPDATE ON company.* TO 'junior_dev'@'localhost';
```

---

## 7. 🔍 权限对象查询与验证


### 7.1 权限查询命令


**🔍 查看用户权限**：
```sql
-- 查看特定用户的所有权限
SHOW GRANTS FOR 'username'@'hostname';

-- 查看当前用户权限
SHOW GRANTS;

-- 查看所有用户
SELECT User, Host FROM mysql.user;
```

**📊 详细权限查询**：
```sql
-- 查询用户的全局权限
SELECT Host, User, Select_priv, Insert_priv, Update_priv, Delete_priv
FROM mysql.user 
WHERE User = 'app_user';

-- 查询用户的数据库权限
SELECT Host, User, Db, Select_priv, Insert_priv, Update_priv, Delete_priv
FROM mysql.db 
WHERE User = 'app_user';

-- 查询用户的表权限
SELECT Host, User, Db, Table_name, Table_priv
FROM mysql.tables_priv 
WHERE User = 'app_user';

-- 查询用户的字段权限
SELECT Host, User, Db, Table_name, Column_name, Column_priv
FROM mysql.columns_priv 
WHERE User = 'app_user';
```

### 7.2 权限验证方法


**✅ 权限测试**：
```sql
-- 测试用户是否有特定权限
-- 1. 切换到测试用户
mysql -u testuser -p

-- 2. 尝试执行操作
SELECT * FROM company.employees LIMIT 1;
INSERT INTO company.test_table VALUES (1, 'test');
UPDATE company.employees SET department = 'IT' WHERE id = 1;
DELETE FROM company.temp_data WHERE id = 1;

-- 3. 观察是否有权限错误
-- ERROR 1142 (42000): SELECT command denied to user 'testuser'@'localhost' for table 'employees'
```

### 7.3 权限审计查询


**📋 权限审计脚本**：
```sql
-- 查找有全局权限的用户
SELECT User, Host, 
       IF(Select_priv='Y', 'SELECT', '') as Global_Privs
FROM mysql.user 
WHERE Select_priv='Y' OR Insert_priv='Y' OR Update_priv='Y' OR Delete_priv='Y';

-- 查找空密码用户（安全风险）
SELECT User, Host 
FROM mysql.user 
WHERE authentication_string = '';

-- 查找过度权限用户
SELECT User, Host
FROM mysql.user  
WHERE Super_priv = 'Y' OR Grant_priv = 'Y';
```

### 7.4 权限问题诊断


**🔧 常见权限问题排查**：
```sql
-- 1. 检查用户是否存在
SELECT User, Host FROM mysql.user WHERE User = 'problem_user';

-- 2. 检查用户连接权限
SELECT User, Host, authentication_string 
FROM mysql.user 
WHERE User = 'problem_user';

-- 3. 检查权限继承路径
SHOW GRANTS FOR 'problem_user'@'localhost';

-- 4. 检查权限表完整性
CHECK TABLE mysql.user, mysql.db, mysql.tables_priv, mysql.columns_priv;
```

---

## 8. 🔒 权限对象安全控制


### 8.1 权限滥用防护


**⚠️ 常见权限滥用风险**：
- 🔴 **过度授权**：给予超出需要的权限
- 🔴 **权限泄露**：账号密码被盗用
- 🔴 **权限提升**：利用漏洞获取更高权限
- 🔴 **权限继承**：意外继承不必要的权限

**🛡️ 防护措施**：
```sql
-- 1. 最小权限原则
-- 错误做法：给开发者全局权限
GRANT ALL PRIVILEGES ON *.* TO 'dev'@'%';  -- ❌

-- 正确做法：只给必要权限
GRANT SELECT, INSERT, UPDATE ON dev_db.* TO 'dev'@'%';  -- ✅

-- 2. 定期权限审计
-- 创建权限审计视图
CREATE VIEW user_permissions AS
SELECT u.User, u.Host, 'GLOBAL' as Scope, '*.*' as Object,
       CONCAT_WS(',', 
         IF(u.Select_priv='Y','SELECT',''),
         IF(u.Insert_priv='Y','INSERT',''),
         IF(u.Update_priv='Y','UPDATE','')
       ) as Privileges
FROM mysql.user u
WHERE u.User != ''
UNION ALL
SELECT db.User, db.Host, 'DATABASE' as Scope, db.Db as Object,
       CONCAT_WS(',',
         IF(db.Select_priv='Y','SELECT',''),
         IF(db.Insert_priv='Y','INSERT',''),
         IF(db.Update_priv='Y','UPDATE','')
       ) as Privileges  
FROM mysql.db db;
```

### 8.2 层次权限安全验证


**🔐 安全验证机制**：
```sql
-- 1. 权限检查函数
DELIMITER //
CREATE PROCEDURE CheckUserPrivileges(IN target_user VARCHAR(50), IN target_host VARCHAR(50))
BEGIN
    DECLARE done INT DEFAULT FALSE;
    DECLARE priv_info TEXT;
    
    -- 检查全局权限
    SELECT CONCAT('Global: ', 
           IF(Select_priv='Y','SELECT ',''),
           IF(Insert_priv='Y','INSERT ',''),
           IF(Update_priv='Y','UPDATE ',''),
           IF(Delete_priv='Y','DELETE ','')
    ) INTO priv_info
    FROM mysql.user 
    WHERE User = target_user AND Host = target_host;
    
    SELECT priv_info as Privileges;
    
    -- 检查数据库权限
    SELECT CONCAT(Db, ': ',
           IF(Select_priv='Y','SELECT ',''),
           IF(Insert_priv='Y','INSERT ',''),
           IF(Update_priv='Y','UPDATE ','')
    ) as Database_Privileges
    FROM mysql.db 
    WHERE User = target_user AND Host = target_host;
    
END //
DELIMITER ;

-- 使用示例
CALL CheckUserPrivileges('app_user', 'localhost');
```

### 8.3 权限监控和告警


**📊 权限变更监控**：
```sql
-- 创建权限变更日志表
CREATE TABLE privilege_audit (
    id INT AUTO_INCREMENT PRIMARY KEY,
    change_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    operation VARCHAR(20),  -- GRANT, REVOKE, CREATE USER, DROP USER
    target_user VARCHAR(100),
    target_host VARCHAR(100), 
    privilege_level VARCHAR(20), -- GLOBAL, DATABASE, TABLE, COLUMN
    object_name VARCHAR(200),
    privileges_changed TEXT,
    executed_by VARCHAR(100),
    sql_statement TEXT
);

-- 权限变更触发器（需要在业务层实现）
-- 记录所有GRANT/REVOKE操作
```

**🚨 异常权限告警**：
```sql
-- 检查异常权限分配
SELECT '高风险全局权限' as Alert_Type, User, Host
FROM mysql.user 
WHERE (Super_priv = 'Y' OR Grant_priv = 'Y') 
  AND User NOT IN ('root', 'mysql.sys')

UNION ALL

SELECT '空密码账户' as Alert_Type, User, Host  
FROM mysql.user
WHERE authentication_string = '' AND User != ''

UNION ALL

SELECT '过期未使用账户' as Alert_Type, User, Host
FROM mysql.user u
LEFT JOIN information_schema.PROCESSLIST p ON u.User = p.USER
WHERE p.USER IS NULL AND u.User NOT IN ('root', 'mysql.sys');
```

### 8.4 权限恢复和应急处理


**🆘 权限应急恢复**：
```sql
-- 1. 权限备份
CREATE TABLE privilege_backup AS
SELECT * FROM mysql.user;

CREATE TABLE db_privilege_backup AS  
SELECT * FROM mysql.db;

-- 2. 紧急权限恢复
-- 如果误删重要权限，从备份恢复
INSERT INTO mysql.user SELECT * FROM privilege_backup WHERE User = 'critical_user';
FLUSH PRIVILEGES;

-- 3. 临时权限提升（紧急情况）
GRANT ALL PRIVILEGES ON *.* TO 'emergency_admin'@'localhost' WITH GRANT OPTION;
-- 记住：紧急处理后立即回收
```

---

## 9. 📋 核心要点总结


### 9.1 必须掌握的核心概念


```
🔸 权限对象四层次：全局 → 数据库 → 表 → 字段
🔸 权限继承原则：上层权限自动应用到下层对象
🔸 权限覆盖规则：具体权限优先于通用权限
🔸 权限存储机制：分别存储在user、db、tables_priv、columns_priv表
🔸 最小权限原则：只给必要的权限，定期审计清理
```

### 9.2 关键理解要点


**🔹 权限层次的实际意义**：
```
层次设计的目的：
- 简化管理：上层权限自动覆盖下层
- 精细控制：下层权限可以具体限制  
- 安全保障：分层防护，最小权限原则
- 灵活应用：根据业务需要选择合适层次
```

**🔹 权限继承的优势**：
```
继承机制的作用：
- 减少配置：不用为每个对象单独授权
- 统一管理：上层权限统一控制下层权限
- 灵活调整：可以在任意层次精细调整
- 安全可控：可以通过撤销上层权限快速收回所有权限
```

**🔹 权限安全的核心**：
```
安全控制要点：
- 最小权限：只给必需的权限
- 定期审计：检查权限分配是否合理
- 及时回收：不需要的权限立即撤销
- 监控告警：异常权限变更及时发现
```

### 9.3 实际应用指导


**🎯 权限设计策略**：
- **新用户**：从最小权限开始，逐步增加
- **老用户**：定期审计，清理不必要权限
- **临时权限**：明确时限，及时回收
- **敏感数据**：使用字段级权限精确控制

**🔧 权限管理工具**：
- **SHOW GRANTS**：查看用户权限
- **权限表查询**：深入了解权限存储
- **权限审计脚本**：定期检查权限分配
- **权限监控**：实时监控权限变更

**🚨 常见问题避免**：
- ❌ 避免过度授权（给予不必要的权限）
- ❌ 避免权限泄露（账号密码管理不当）
- ❌ 避免权限继承混乱（不理解继承机制）
- ❌ 避免忘记权限回收（离职人员权限清理）

**💡 核心记忆**：
- 权限分四层，继承有优先
- 上层管下层，具体胜通用
- 最小权限好，定期要审计
- 安全第一位，监控不能少