---
title: 5ã€å®‰å…¨ç¼–ç å¼€å‘è§„èŒƒ
---
## ğŸ“š ç›®å½•

1. [å®‰å…¨ç¼–ç åŸºæœ¬åŸåˆ™](#1-å®‰å…¨ç¼–ç åŸºæœ¬åŸåˆ™)
2. [SQLè¯­å¥æ„é€ è§„èŒƒ](#2-SQLè¯­å¥æ„é€ è§„èŒƒ)
3. [å±é™©å‡½æ•°ä¸è¾“å…¥å¤„ç†](#3-å±é™©å‡½æ•°ä¸è¾“å…¥å¤„ç†)
4. [é”™è¯¯å¤„ç†ä¸æ—¥å¿—è®°å½•](#4-é”™è¯¯å¤„ç†ä¸æ—¥å¿—è®°å½•)
5. [XSSé˜²æŠ¤ä¸è¾“å‡ºç¼–ç ](#5-XSSé˜²æŠ¤ä¸è¾“å‡ºç¼–ç )
6. [å®‰å…¨å¼€å‘æµç¨‹ç®¡ç†](#6-å®‰å…¨å¼€å‘æµç¨‹ç®¡ç†)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ›¡ï¸ å®‰å…¨ç¼–ç åŸºæœ¬åŸåˆ™


### 1.1 æ ¸å¿ƒå®‰å…¨ç†å¿µ


**ğŸ”¸ ä»€ä¹ˆæ˜¯å®‰å…¨ç¼–ç **
```
ç®€å•ç†è§£ï¼šå°±æ˜¯å†™ä»£ç æ—¶æ—¶åˆ»æƒ³ç€"åäººä¼šæ€ä¹ˆæ”»å‡»æˆ‘çš„ç¨‹åº"
æ ¸å¿ƒæ€æƒ³ï¼šæ°¸è¿œä¸è¦ç›¸ä¿¡ç”¨æˆ·è¾“å…¥çš„ä»»ä½•æ•°æ®
é˜²æŠ¤ç›®æ ‡ï¼šè®©é»‘å®¢æ— æ³•é€šè¿‡è¾“å…¥æ¶æ„æ•°æ®æ¥æ§åˆ¶æˆ‘ä»¬çš„ç³»ç»Ÿ
```

**ğŸ’¡ å®‰å…¨ç¼–ç çš„ä¸‰å¤§åŸåˆ™**
```
1. æœ€å°æƒé™åŸåˆ™
   å«ä¹‰ï¼šç¨‹åºåªç»™æœ€å¿…è¦çš„æƒé™ï¼Œç»ä¸å¤šç»™
   ä¾‹å­ï¼šæ•°æ®åº“è¿æ¥åªç»™æŸ¥è¯¢æƒé™ï¼Œä¸ç»™åˆ é™¤æƒé™

2. çºµæ·±é˜²å¾¡åŸåˆ™  
   å«ä¹‰ï¼šå¤šå±‚é˜²æŠ¤ï¼Œä¸€å±‚è¢«çªç ´è¿˜æœ‰å…¶ä»–å±‚
   ä¾‹å­ï¼šè¾“å…¥éªŒè¯ + å‚æ•°åŒ–æŸ¥è¯¢ + æƒé™æ§åˆ¶

3. å®‰å…¨é»˜è®¤åŸåˆ™
   å«ä¹‰ï¼šé»˜è®¤æƒ…å†µä¸‹æ˜¯å®‰å…¨çš„ï¼Œéœ€è¦æ˜ç¡®å¼€å¯æ‰èƒ½è®¿é—®
   ä¾‹å­ï¼šæ–°ç”¨æˆ·é»˜è®¤æ²¡æœ‰ä»»ä½•æƒé™
```

### 1.2 å¸¸è§å®‰å…¨å¨èƒ


**âš ï¸ å¼€å‘ä¸­æœ€å®¹æ˜“çŠ¯çš„å®‰å…¨é”™è¯¯**

| å¨èƒç±»å‹ | **ç®€å•ç†è§£** | **å±å®³ç¨‹åº¦** | **é˜²æŠ¤éš¾åº¦** |
|---------|------------|-------------|-------------|
| **SQLæ³¨å…¥** | `ç”¨æˆ·è¾“å…¥è¢«å½“æˆSQLå‘½ä»¤æ‰§è¡Œ` | `ğŸ”´ æé«˜` | `ğŸŸ¢ ç®€å•` |
| **XSSæ”»å‡»** | `ç”¨æˆ·è¾“å…¥çš„è„šæœ¬åœ¨æµè§ˆå™¨ä¸­æ‰§è¡Œ` | `ğŸŸ¡ ä¸­ç­‰` | `ğŸŸ¡ ä¸­ç­‰` |
| **CSRFæ”»å‡»** | `å†’å……ç”¨æˆ·æ‰§è¡Œæ¶æ„æ“ä½œ` | `ğŸŸ¡ ä¸­ç­‰` | `ğŸŸ¡ ä¸­ç­‰` |
| **æ–‡ä»¶ä¸Šä¼ æ¼æ´** | `ä¸Šä¼ æ¶æ„æ–‡ä»¶æ§åˆ¶æœåŠ¡å™¨` | `ğŸ”´ æé«˜` | `ğŸŸ  è¾ƒéš¾` |

---

## 2. âš™ï¸ SQLè¯­å¥æ„é€ è§„èŒƒ


### 2.1 å‚æ•°åŒ–æŸ¥è¯¢ï¼ˆæœ€é‡è¦ï¼‰


**ğŸ”¸ ä»€ä¹ˆæ˜¯å‚æ•°åŒ–æŸ¥è¯¢**
å‚æ•°åŒ–æŸ¥è¯¢å°±æ˜¯æŠŠSQLè¯­å¥å’Œæ•°æ®åˆ†å¼€ï¼Œè®©æ•°æ®åº“çŸ¥é“å“ªéƒ¨åˆ†æ˜¯å‘½ä»¤ï¼Œå“ªéƒ¨åˆ†æ˜¯æ•°æ®ï¼Œè¿™æ ·ç”¨æˆ·è¾“å…¥çš„æ¶æ„ä»£ç å°±ä¸ä¼šè¢«å½“æˆå‘½ä»¤æ‰§è¡Œã€‚

**âœ… æ­£ç¡®çš„å†™æ³•**
```java
// Java JDBCç¤ºä¾‹
String sql = "SELECT * FROM users WHERE username = ? AND password = ?";
PreparedStatement stmt = connection.prepareStatement(sql);
stmt.setString(1, username);  // ç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·å
stmt.setString(2, password);  // ç”¨æˆ·è¾“å…¥çš„å¯†ç 
ResultSet rs = stmt.executeQuery();
```

**âŒ å±é™©çš„å†™æ³•**
```java
// æ°¸è¿œä¸è¦è¿™æ ·å†™ï¼
String sql = "SELECT * FROM users WHERE username = '" + username + 
             "' AND password = '" + password + "'";
Statement stmt = connection.createStatement();
ResultSet rs = stmt.executeQuery(sql);  // å®¹æ˜“è¢«SQLæ³¨å…¥æ”»å‡»
```

### 2.2 å„ç§è¯­è¨€çš„å‚æ•°åŒ–æŸ¥è¯¢


**ğŸ”¸ PHP PDOç¤ºä¾‹**
```php
// æ­£ç¡®å†™æ³•
$sql = "SELECT * FROM products WHERE category = ? AND price < ?";
$stmt = $pdo->prepare($sql);
$stmt->execute([$category, $maxPrice]);
$results = $stmt->fetchAll();
```

**ğŸ”¸ Pythonç¤ºä¾‹**
```python
# æ­£ç¡®å†™æ³•
cursor.execute(
    "SELECT * FROM orders WHERE user_id = %s AND status = %s",
    (user_id, status)
)
results = cursor.fetchall()
```

**ğŸ”¸ C# Entity Frameworkç¤ºä¾‹**
```csharp
// æ­£ç¡®å†™æ³•
var users = context.Users
    .Where(u => u.Username == username && u.IsActive == true)
    .ToList();
```

### 2.3 åŠ¨æ€SQLæ„é€ è§„èŒƒ


**ğŸ”¸ å¿…é¡»åŠ¨æ€æ„é€ SQLæ—¶çš„å®‰å…¨åšæ³•**

å½“éœ€è¦åŠ¨æ€æ·»åŠ WHEREæ¡ä»¶æˆ–ORDER BYæ—¶ï¼Œè¦ç‰¹åˆ«å°å¿ƒï¼š

```java
// å®‰å…¨çš„åŠ¨æ€SQLæ„é€ ç¤ºä¾‹
public List<User> searchUsers(String name, String department, String sortField) {
    StringBuilder sql = new StringBuilder("SELECT * FROM users WHERE 1=1");
    List<Object> params = new ArrayList<>();
    
    // å®‰å…¨åœ°æ·»åŠ æ¡ä»¶
    if (name != null && !name.trim().isEmpty()) {
        sql.append(" AND name LIKE ?");
        params.add("%" + name + "%");
    }
    
    if (department != null && !department.trim().isEmpty()) {
        sql.append(" AND department = ?");
        params.add(department);
    }
    
    // æ’åºå­—æ®µå¿…é¡»ç™½åå•éªŒè¯
    if (isValidSortField(sortField)) {
        sql.append(" ORDER BY ").append(sortField);
    }
    
    return executeQuery(sql.toString(), params);
}

// ç™½åå•éªŒè¯æ’åºå­—æ®µ
private boolean isValidSortField(String field) {
    Set<String> allowedFields = Set.of("name", "create_time", "department");
    return allowedFields.contains(field);
}
```

---

## 3. ğŸš« å±é™©å‡½æ•°ä¸è¾“å…¥å¤„ç†


### 3.1 å¿…é¡»ç¦ç”¨çš„å±é™©å‡½æ•°


**âŒ ç»å¯¹ä¸èƒ½ä½¿ç”¨çš„å‡½æ•°**

```java
// Java - ç¦ç”¨è¿™äº›å‡½æ•°
Statement.executeQuery(sql);           // ç”¨PreparedStatementä»£æ›¿
Statement.executeUpdate(sql);          // ç”¨PreparedStatementä»£æ›¿
Runtime.getRuntime().exec(userInput);  // ç»ä¸ç›´æ¥æ‰§è¡Œç”¨æˆ·è¾“å…¥

// PHP - ç¦ç”¨è¿™äº›å‡½æ•°  
mysql_query($sql);                     // å·²åºŸå¼ƒï¼Œç”¨PDOä»£æ›¿
eval($userInput);                      // ç»ä¸æ‰§è¡Œç”¨æˆ·è¾“å…¥çš„ä»£ç 
exec($userInput);                      // ç»ä¸ç›´æ¥æ‰§è¡Œç”¨æˆ·è¾“å…¥

// JavaScript - å‰ç«¯ç¦ç”¨
eval(userInput);                       // ç»ä¸æ‰§è¡Œç”¨æˆ·è¾“å…¥
document.write(userInput);             // å®¹æ˜“XSSæ”»å‡»
innerHTML = userInput;                 // ç”¨textContentä»£æ›¿
```

### 3.2 è¾“å…¥éªŒè¯æ ‡å‡†


**ğŸ”¸ è¾“å…¥éªŒè¯çš„åŸºæœ¬åŸåˆ™**

è¾“å…¥éªŒè¯å°±æ˜¯æ£€æŸ¥ç”¨æˆ·è¾“å…¥çš„æ•°æ®æ˜¯å¦ç¬¦åˆæˆ‘ä»¬çš„æœŸæœ›ï¼Œä¸ç¬¦åˆå°±æ‹’ç»ã€‚

```java
// è¾“å…¥éªŒè¯ç¤ºä¾‹
public class InputValidator {
    
    // éªŒè¯ç”¨æˆ·åï¼šåªå…è®¸å­—æ¯æ•°å­—ä¸‹åˆ’çº¿ï¼Œé•¿åº¦3-20
    public static boolean isValidUsername(String username) {
        if (username == null || username.trim().isEmpty()) {
            return false;
        }
        return username.matches("^[a-zA-Z0-9_]{3,20}$");
    }
    
    // éªŒè¯é‚®ç®±æ ¼å¼
    public static boolean isValidEmail(String email) {
        if (email == null || email.trim().isEmpty()) {
            return false;
        }
        return email.matches("^[\\w.-]+@[\\w.-]+\\.[a-zA-Z]{2,}$");
    }
    
    // éªŒè¯æ•°å­—èŒƒå›´
    public static boolean isValidAge(Integer age) {
        return age != null && age >= 1 && age <= 150;
    }
}
```

**ğŸ“‹ å¸¸ç”¨è¾“å…¥éªŒè¯è§„åˆ™**

| è¾“å…¥ç±»å‹ | **éªŒè¯è§„åˆ™** | **æ­£åˆ™è¡¨è¾¾å¼ç¤ºä¾‹** | **è¯´æ˜** |
|---------|------------|------------------|---------|
| **ç”¨æˆ·å** | `å­—æ¯æ•°å­—ä¸‹åˆ’çº¿ï¼Œ3-20ä½` | `^[a-zA-Z0-9_]{3,20}$` | `é˜²æ­¢ç‰¹æ®Šå­—ç¬¦æ³¨å…¥` |
| **é‚®ç®±** | `æ ‡å‡†é‚®ç®±æ ¼å¼` | `^[\\w.-]+@[\\w.-]+\\.[a-zA-Z]{2,}$` | `é˜²æ­¢æ ¼å¼é”™è¯¯` |
| **æ‰‹æœºå·** | `11ä½æ•°å­—` | `^1[3-9]\\d{9}$` | `ä¸­å›½æ‰‹æœºå·æ ¼å¼` |
| **èº«ä»½è¯** | `18ä½æ•°å­—æˆ–X` | `^[1-9]\\d{16}[0-9Xx]$` | `åŸºæœ¬æ ¼å¼éªŒè¯` |

### 3.3 è¾“å…¥æ¸…ç†ä¸è½¬ä¹‰


**ğŸ”¸ ä»€ä¹ˆæ˜¯è¾“å…¥æ¸…ç†**
è¾“å…¥æ¸…ç†å°±æ˜¯æŠŠç”¨æˆ·è¾“å…¥ä¸­çš„å±é™©å­—ç¬¦å»æ‰æˆ–è€…è½¬æ¢æˆå®‰å…¨çš„å½¢å¼ã€‚

```java
// è¾“å…¥æ¸…ç†ç¤ºä¾‹
public class InputSanitizer {
    
    // æ¸…ç†HTMLæ ‡ç­¾ï¼Œé˜²æ­¢XSS
    public static String sanitizeHtml(String input) {
        if (input == null) return null;
        
        return input
            .replaceAll("<", "&lt;")      // < è½¬ä¸º &lt;
            .replaceAll(">", "&gt;")      // > è½¬ä¸º &gt;
            .replaceAll("\"", "&quot;")   // " è½¬ä¸º &quot;
            .replaceAll("'", "&#x27;")    // ' è½¬ä¸º &#x27;
            .replaceAll("&", "&amp;");    // & è½¬ä¸º &amp;
    }
    
    // æ¸…ç†SQLç›¸å…³å­—ç¬¦
    public static String sanitizeSql(String input) {
        if (input == null) return null;
        
        // ç§»é™¤æˆ–è½¬ä¹‰å±é™©å­—ç¬¦
        return input
            .replaceAll("'", "''")        // å•å¼•å·è½¬ä¹‰
            .replaceAll(";", "")          // ç§»é™¤åˆ†å·
            .replaceAll("--", "")         // ç§»é™¤æ³¨é‡Šç¬¦
            .replaceAll("/\\*", "")       // ç§»é™¤å—æ³¨é‡Šå¼€å§‹
            .replaceAll("\\*/", "");      // ç§»é™¤å—æ³¨é‡Šç»“æŸ
    }
}
```

---

## 4. ğŸ“ é”™è¯¯å¤„ç†ä¸æ—¥å¿—è®°å½•


### 4.1 å®‰å…¨çš„é”™è¯¯å¤„ç†


**ğŸ”¸ é”™è¯¯å¤„ç†çš„å®‰å…¨åŸåˆ™**
é”™è¯¯ä¿¡æ¯è¦å¯¹ç”¨æˆ·å‹å¥½ï¼Œä½†ä¸èƒ½æ³„éœ²ç³»ç»Ÿå†…éƒ¨ä¿¡æ¯ç»™æ”»å‡»è€…ã€‚

**âœ… æ­£ç¡®çš„é”™è¯¯å¤„ç†**
```java
public class SafeErrorHandler {
    
    private static final Logger logger = LoggerFactory.getLogger(SafeErrorHandler.class);
    
    public ResponseEntity<Map<String, String>> handleDatabaseError(Exception e) {
        // è®°å½•è¯¦ç»†é”™è¯¯åˆ°æ—¥å¿—ï¼ˆå†…éƒ¨ä½¿ç”¨ï¼‰
        logger.error("æ•°æ®åº“æ“ä½œå¤±è´¥: " + e.getMessage(), e);
        
        // è¿”å›é€šç”¨é”™è¯¯ä¿¡æ¯ç»™ç”¨æˆ·ï¼ˆä¸æ³„éœ²ç»†èŠ‚ï¼‰
        Map<String, String> response = new HashMap<>();
        response.put("status", "error");
        response.put("message", "ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åé‡è¯•");
        
        return ResponseEntity.status(500).body(response);
    }
    
    public ResponseEntity<Map<String, String>> handleValidationError(String field) {
        // è¿”å›å…·ä½“ä½†å®‰å…¨çš„éªŒè¯é”™è¯¯
        Map<String, String> response = new HashMap<>();
        response.put("status", "error");
        response.put("message", field + "æ ¼å¼ä¸æ­£ç¡®");
        
        return ResponseEntity.status(400).body(response);
    }
}
```

**âŒ å±é™©çš„é”™è¯¯å¤„ç†**
```java
// æ°¸è¿œä¸è¦è¿™æ ·åšï¼
try {
    // æ•°æ®åº“æ“ä½œ
} catch (SQLException e) {
    // ç›´æ¥è¿”å›æ•°æ®åº“é”™è¯¯ä¿¡æ¯ï¼Œæ³„éœ²äº†è¡¨ç»“æ„
    return "Error: " + e.getMessage();  
    // å¯èƒ½è¿”å›ï¼šTable 'users' doesn't exist
}
```

### 4.2 å®‰å…¨æ—¥å¿—è®°å½•è§„èŒƒ


**ğŸ”¸ ä»€ä¹ˆä¿¡æ¯éœ€è¦è®°å½•**

```java
public class SecurityLogger {
    
    private static final Logger securityLog = LoggerFactory.getLogger("SECURITY");
    
    // ç™»å½•ç›¸å…³æ—¥å¿—
    public static void logLoginAttempt(String username, String ip, boolean success) {
        if (success) {
            securityLog.info("ç™»å½•æˆåŠŸ - ç”¨æˆ·: {}, IP: {}", username, ip);
        } else {
            securityLog.warn("ç™»å½•å¤±è´¥ - ç”¨æˆ·: {}, IP: {}", username, ip);
        }
    }
    
    // æ•æ„Ÿæ“ä½œæ—¥å¿—
    public static void logSensitiveOperation(String username, String operation, String target) {
        securityLog.info("æ•æ„Ÿæ“ä½œ - ç”¨æˆ·: {}, æ“ä½œ: {}, ç›®æ ‡: {}", username, operation, target);
    }
    
    // å®‰å…¨å¼‚å¸¸æ—¥å¿—
    public static void logSecurityException(String event, String details, String ip) {
        securityLog.error("å®‰å…¨äº‹ä»¶ - äº‹ä»¶: {}, è¯¦æƒ…: {}, IP: {}", event, details, ip);
    }
}
```

**ğŸ“‹ é‡è¦æ—¥å¿—è®°å½•å†…å®¹**

```
ğŸ”¸ å¿…é¡»è®°å½•çš„å®‰å…¨äº‹ä»¶ï¼š
â€¢ ç”¨æˆ·ç™»å½•/æ³¨é”€ï¼ˆæˆåŠŸå’Œå¤±è´¥éƒ½è¦è®°å½•ï¼‰
â€¢ æƒé™å˜æ›´æ“ä½œ
â€¢ æ•æ„Ÿæ•°æ®è®¿é—®
â€¢ ç³»ç»Ÿé…ç½®ä¿®æ”¹
â€¢ å¼‚å¸¸çš„è®¿é—®æ¨¡å¼ï¼ˆå¦‚é¢‘ç¹å¤±è´¥ç™»å½•ï¼‰

ğŸ”¸ æ—¥å¿—æ ¼å¼è§„èŒƒï¼š
æ—¶é—´æˆ³ | äº‹ä»¶ç±»å‹ | ç”¨æˆ·ID | IPåœ°å€ | æ“ä½œè¯¦æƒ… | ç»“æœçŠ¶æ€

ğŸ”¸ æ—¥å¿—å­˜å‚¨è¦æ±‚ï¼š
â€¢ æ—¥å¿—æ–‡ä»¶è¦å®šæœŸå¤‡ä»½å’Œå½’æ¡£
â€¢ æ•æ„Ÿä¿¡æ¯è¦è„±æ•å¤„ç†
â€¢ æ—¥å¿—è®¿é—®è¦æœ‰æƒé™æ§åˆ¶
```

---

## 5. ğŸ›¡ï¸ XSSé˜²æŠ¤ä¸è¾“å‡ºç¼–ç 


### 5.1 ä»€ä¹ˆæ˜¯XSSæ”»å‡»


**ğŸ”¸ XSSæ”»å‡»ç®€å•ç†è§£**
XSSå°±æ˜¯Cross-Site Scriptingï¼ˆè·¨ç«™è„šæœ¬æ”»å‡»ï¼‰çš„ç¼©å†™ã€‚æ”»å‡»è€…åœ¨ç½‘é¡µä¸­æ’å…¥æ¶æ„JavaScriptä»£ç ï¼Œå½“å…¶ä»–ç”¨æˆ·è®¿é—®è¿™ä¸ªç½‘é¡µæ—¶ï¼Œæ¶æ„ä»£ç å°±ä¼šåœ¨ä»–ä»¬çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚

```
æ”»å‡»æµç¨‹ç¤ºä¾‹ï¼š
1. æ”»å‡»è€…åœ¨è¯„è®ºæ¡†è¾“å…¥ï¼š<script>alert('ä½ è¢«æ”»å‡»äº†ï¼')</script>
2. ç½‘ç«™æ²¡æœ‰è¿‡æ»¤ï¼Œç›´æ¥å­˜å‚¨åˆ°æ•°æ®åº“
3. å…¶ä»–ç”¨æˆ·è®¿é—®é¡µé¢æ—¶ï¼Œè¿™æ®µä»£ç è¢«æ‰§è¡Œ
4. å¼¹å‡ºè­¦å‘Šæ¡†ï¼Œæˆ–è€…æ›´ä¸¥é‡çš„ï¼šçªƒå–ç”¨æˆ·Cookie
```

### 5.2 è¾“å‡ºç¼–ç æŠ€æœ¯


**ğŸ”¸ HTMLç¼–ç **
æŠŠç‰¹æ®Šå­—ç¬¦è½¬æ¢æˆHTMLå®ä½“ï¼Œè®©æµè§ˆå™¨å½“æˆæ™®é€šæ–‡æœ¬æ˜¾ç¤ºï¼Œè€Œä¸æ˜¯å½“æˆä»£ç æ‰§è¡Œã€‚

```java
// HTMLç¼–ç ç¤ºä¾‹
public class HtmlEncoder {
    
    public static String encodeHtml(String input) {
        if (input == null) return null;
        
        return input
            .replace("&", "&amp;")    // å¿…é¡»æœ€å…ˆå¤„ç†
            .replace("<", "&lt;")
            .replace(">", "&gt;")
            .replace("\"", "&quot;")
            .replace("'", "&#x27;")
            .replace("/", "&#x2F;");
    }
}

// ä½¿ç”¨ç¤ºä¾‹
String userComment = "<script>alert('xss')</script>";
String safeComment = HtmlEncoder.encodeHtml(userComment);
// ç»“æœï¼š&lt;script&gt;alert(&#x27;xss&#x27;)&lt;&#x2F;script&gt;
```

**ğŸ”¸ JavaScriptç¼–ç **
å½“éœ€è¦åœ¨JavaScriptä¸­è¾“å‡ºç”¨æˆ·æ•°æ®æ—¶ï¼Œè¦è¿›è¡ŒJavaScriptç¼–ç ã€‚

```javascript
// JavaScriptç¼–ç å‡½æ•°
function escapeJavaScript(str) {
    if (!str) return '';
    
    return str
        .replace(/\\/g, '\\\\')   // åæ–œæ 
        .replace(/'/g, "\\'")     // å•å¼•å·
        .replace(/"/g, '\\"')     // åŒå¼•å·
        .replace(/\n/g, '\\n')    // æ¢è¡Œç¬¦
        .replace(/\r/g, '\\r')    // å›è½¦ç¬¦
        .replace(/\t/g, '\\t');   // åˆ¶è¡¨ç¬¦
}

// ä½¿ç”¨ç¤ºä¾‹
var userName = '<%=escapeJavaScript(user.getName())%>';
```

### 5.3 CSPå†…å®¹å®‰å…¨ç­–ç•¥


**ğŸ”¸ ä»€ä¹ˆæ˜¯CSP**
CSPï¼ˆContent Security Policyï¼‰æ˜¯ä¸€ç§å®‰å…¨æœºåˆ¶ï¼Œå‘Šè¯‰æµè§ˆå™¨å“ªäº›èµ„æºæ˜¯å¯ä¿¡çš„ï¼Œå“ªäº›æ˜¯ä¸å¯ä¿¡çš„ã€‚

```html
<!-- åœ¨HTMLå¤´éƒ¨æ·»åŠ CSPç­–ç•¥ -->
<meta http-equiv="Content-Security-Policy" 
      content="default-src 'self'; 
               script-src 'self' 'unsafe-inline' https://trusted-scripts.com;
               style-src 'self' 'unsafe-inline';
               img-src 'self' data: https:;">
```

**ğŸ“‹ CSPé…ç½®è¯´æ˜**

| æŒ‡ä»¤ | **å«ä¹‰** | **ç¤ºä¾‹å€¼** | **è¯´æ˜** |
|------|---------|-----------|---------|
| `default-src` | `é»˜è®¤èµ„æºæ¥æº` | `'self'` | `åªå…è®¸åŒåŸŸèµ„æº` |
| `script-src` | `JavaScriptæ¥æº` | `'self' 'unsafe-inline'` | `å…è®¸åŒåŸŸå’Œå†…è”è„šæœ¬` |
| `style-src` | `CSSæ ·å¼æ¥æº` | `'self' 'unsafe-inline'` | `å…è®¸åŒåŸŸå’Œå†…è”æ ·å¼` |
| `img-src` | `å›¾ç‰‡èµ„æºæ¥æº` | `'self' data: https:` | `å…è®¸åŒåŸŸã€data URLå’ŒHTTPSå›¾ç‰‡` |

---

## 6. ğŸ”„ å®‰å…¨å¼€å‘æµç¨‹ç®¡ç†


### 6.1 ä»£ç å®¡æŸ¥æœºåˆ¶


**ğŸ”¸ å®‰å…¨ä»£ç å®¡æŸ¥è¦ç‚¹**

```
ä»£ç å®¡æŸ¥æ£€æŸ¥æ¸…å•ï¼š

SQLæ“ä½œæ£€æŸ¥ï¼š
â–¡ æ˜¯å¦ä½¿ç”¨äº†å‚æ•°åŒ–æŸ¥è¯¢ï¼Ÿ
â–¡ æ˜¯å¦æœ‰å­—ç¬¦ä¸²æ‹¼æ¥SQLçš„æƒ…å†µï¼Ÿ
â–¡ åŠ¨æ€SQLæ˜¯å¦æœ‰ç™½åå•éªŒè¯ï¼Ÿ

è¾“å…¥éªŒè¯æ£€æŸ¥ï¼š
â–¡ æ‰€æœ‰ç”¨æˆ·è¾“å…¥æ˜¯å¦éƒ½è¿›è¡Œäº†éªŒè¯ï¼Ÿ
â–¡ éªŒè¯è§„åˆ™æ˜¯å¦è¶³å¤Ÿä¸¥æ ¼ï¼Ÿ
â–¡ æ˜¯å¦æœ‰é—æ¼çš„è¾“å…¥ç‚¹ï¼Ÿ

è¾“å‡ºç¼–ç æ£€æŸ¥ï¼š
â–¡ è¾“å‡ºåˆ°HTMLçš„æ•°æ®æ˜¯å¦ç¼–ç ï¼Ÿ
â–¡ è¾“å‡ºåˆ°JavaScriptçš„æ•°æ®æ˜¯å¦ç¼–ç ï¼Ÿ
â–¡ é”™è¯¯ä¿¡æ¯æ˜¯å¦å®‰å…¨ï¼Ÿ

æƒé™æ§åˆ¶æ£€æŸ¥ï¼š
â–¡ æ˜¯å¦éªŒè¯äº†ç”¨æˆ·æƒé™ï¼Ÿ
â–¡ æ˜¯å¦æœ‰è¶Šæƒè®¿é—®çš„å¯èƒ½ï¼Ÿ
â–¡ æ•æ„Ÿæ“ä½œæ˜¯å¦æœ‰é¢å¤–éªŒè¯ï¼Ÿ
```

### 6.2 å®‰å…¨ç¼–ç åŸ¹è®­ä½“ç³»


**ğŸ”¸ å¼€å‘äººå‘˜å®‰å…¨åŸ¹è®­è®¡åˆ’**

```
æ–°å‘˜å·¥åŸ¹è®­ï¼ˆå¿…ä¿®ï¼‰ï¼š
ç¬¬1å‘¨ï¼šå®‰å…¨ç¼–ç åŸºç¡€ç†å¿µ
ç¬¬2å‘¨ï¼šSQLæ³¨å…¥é˜²æŠ¤å®æˆ˜
ç¬¬3å‘¨ï¼šXSSæ”»å‡»é˜²æŠ¤å®æˆ˜
ç¬¬4å‘¨ï¼šç»¼åˆå®‰å…¨æ¡ˆä¾‹åˆ†æ

å®šæœŸåŸ¹è®­ï¼ˆå­£åº¦ï¼‰ï¼š
â€¢ æ–°å®‰å…¨å¨èƒä»‹ç»
â€¢ å®‰å…¨ç¼–ç æœ€ä½³å®è·µæ›´æ–°
â€¢ å®‰å…¨å·¥å…·ä½¿ç”¨åŸ¹è®­
â€¢ çœŸå®å®‰å…¨äº‹ä»¶æ¡ˆä¾‹åˆ†æ

è€ƒæ ¸è¦æ±‚ï¼š
â€¢ ç†è®ºè€ƒè¯•ï¼š80åˆ†ä»¥ä¸Šé€šè¿‡
â€¢ å®è·µæµ‹è¯•ï¼šèƒ½è¯†åˆ«å’Œä¿®å¤å¸¸è§å®‰å…¨æ¼æ´
â€¢ ä»£ç å®¡æŸ¥ï¼šå‚ä¸å®‰å…¨ä»£ç å®¡æŸ¥
```

### 6.3 å®‰å…¨ç¼–ç å·¥å…·é“¾


**ğŸ”¸ è‡ªåŠ¨åŒ–å®‰å…¨æ£€æµ‹å·¥å…·**

```java
// Mavenå®‰å…¨æ£€æµ‹æ’ä»¶é…ç½®
<plugin>
    <groupId>org.owasp</groupId>
    <artifactId>dependency-check-maven</artifactId>
    <version>8.4.0</version>
    <configuration>
        <failBuildOnCVSS>7</failBuildOnCVSS>  <!-- é«˜å±æ¼æ´é˜»æ­¢æ„å»º -->
    </configuration>
</plugin>

// SonarQubeå®‰å…¨è§„åˆ™é…ç½®  
<plugin>
    <groupId>org.sonarsource.scanner.maven</groupId>
    <artifactId>sonar-maven-plugin</artifactId>
    <configuration>
        <sonar.exclusions>**/*Test.java</sonar.exclusions>
        <sonar.coverage.exclusions>**/*Config.java</sonar.coverage.exclusions>
    </configuration>
</plugin>
```

**ğŸ“Š å®‰å…¨å·¥å…·å¯¹æ¯”**

| å·¥å…·ç±»å‹ | **å·¥å…·åç§°** | **æ£€æµ‹å†…å®¹** | **ä½¿ç”¨åœºæ™¯** |
|---------|-------------|-------------|-------------|
| **é™æ€åˆ†æ** | `SonarQube, Checkmarx` | `ä»£ç å®‰å…¨æ¼æ´` | `å¼€å‘é˜¶æ®µ` |
| **ä¾èµ–æ£€æŸ¥** | `OWASP Dependency Check` | `ç¬¬ä¸‰æ–¹åº“æ¼æ´` | `æ„å»ºé˜¶æ®µ` |
| **åŠ¨æ€æµ‹è¯•** | `OWASP ZAP, Burp Suite` | `è¿è¡Œæ—¶å®‰å…¨é—®é¢˜` | `æµ‹è¯•é˜¶æ®µ` |
| **å®¹å™¨å®‰å…¨** | `Trivy, Clair` | `å®¹å™¨é•œåƒæ¼æ´` | `éƒ¨ç½²é˜¶æ®µ` |

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„å®‰å…¨åŸåˆ™


```
ğŸ”¸ æ ¸å¿ƒå®‰å…¨ç†å¿µï¼šæ°¸è¿œä¸è¦ç›¸ä¿¡ç”¨æˆ·è¾“å…¥
ğŸ”¸ å‚æ•°åŒ–æŸ¥è¯¢ï¼šSQLå’Œæ•°æ®åˆ†ç¦»ï¼Œé˜²æ­¢æ³¨å…¥æ”»å‡»
ğŸ”¸ è¾“å…¥éªŒè¯ï¼šä¸¥æ ¼æ£€æŸ¥æ‰€æœ‰ç”¨æˆ·è¾“å…¥
ğŸ”¸ è¾“å‡ºç¼–ç ï¼šå®‰å…¨åœ°æ˜¾ç¤ºç”¨æˆ·æ•°æ®
ğŸ”¸ é”™è¯¯å¤„ç†ï¼šä¸æ³„éœ²ç³»ç»Ÿå†…éƒ¨ä¿¡æ¯
ğŸ”¸ æƒé™æ§åˆ¶ï¼šæœ€å°æƒé™åŸåˆ™
ğŸ”¸ å®‰å…¨æ—¥å¿—ï¼šè®°å½•å…³é”®å®‰å…¨äº‹ä»¶
```

### 7.2 å¼€å‘ä¸­çš„å®‰å…¨æ£€æŸ¥æ¸…å•


**âœ… æ¯æ¬¡å¼€å‘å®Œæˆåçš„è‡ªæ£€**
```
æ•°æ®åº“æ“ä½œï¼š
â–¡ ä½¿ç”¨PreparedStatementè€Œä¸æ˜¯Statement
â–¡ åŠ¨æ€SQLä½¿ç”¨ç™½åå•éªŒè¯
â–¡ æ•°æ®åº“è¿æ¥ä½¿ç”¨æœ€å°æƒé™

ç”¨æˆ·è¾“å…¥å¤„ç†ï¼š
â–¡ æ‰€æœ‰è¾“å…¥éƒ½è¿›è¡ŒéªŒè¯å’Œæ¸…ç†
â–¡ æ–‡ä»¶ä¸Šä¼ é™åˆ¶ç±»å‹å’Œå¤§å°
â–¡ è¡¨å•æäº¤æ·»åŠ CSRF Token

æ•°æ®è¾“å‡ºï¼š
â–¡ HTMLè¾“å‡ºè¿›è¡Œç¼–ç 
â–¡ JavaScriptè¾“å‡ºè¿›è¡Œè½¬ä¹‰
â–¡ é”™è¯¯ä¿¡æ¯ä¸æ³„éœ²æ•æ„Ÿä¿¡æ¯

è®¿é—®æ§åˆ¶ï¼š
â–¡ éªŒè¯ç”¨æˆ·èº«ä»½å’Œæƒé™
â–¡ æ•æ„Ÿæ“ä½œäºŒæ¬¡ç¡®è®¤
â–¡ ä¼šè¯ç®¡ç†å®‰å…¨é…ç½®
```

### 7.3 å¸¸è§å®‰å…¨æ¼æ´é€ŸæŸ¥


| æ¼æ´ç±»å‹ | **äº§ç”ŸåŸå› ** | **é˜²æŠ¤æ–¹æ³•** | **ä¼˜å…ˆçº§** |
|---------|-------------|-------------|-----------|
| **SQLæ³¨å…¥** | `å­—ç¬¦ä¸²æ‹¼æ¥SQL` | `å‚æ•°åŒ–æŸ¥è¯¢` | `ğŸ”´ æœ€é«˜` |
| **XSSæ”»å‡»** | `æœªç¼–ç è¾“å‡ºç”¨æˆ·æ•°æ®` | `HTMLç¼–ç ` | `ğŸŸ¡ é«˜` |
| **æ–‡ä»¶ä¸Šä¼ ** | `æœªé™åˆ¶æ–‡ä»¶ç±»å‹` | `ç™½åå•+é‡å‘½å` | `ğŸ”´ æœ€é«˜` |
| **è¶Šæƒè®¿é—®** | `æœªéªŒè¯ç”¨æˆ·æƒé™` | `æƒé™æ£€æŸ¥` | `ğŸŸ¡ é«˜` |
| **ä¿¡æ¯æ³„éœ²** | `é”™è¯¯ä¿¡æ¯è¿‡è¯¦ç»†` | `é€šç”¨é”™è¯¯ä¿¡æ¯` | `ğŸŸ¢ ä¸­` |

**ğŸ¯ æ ¸å¿ƒè®°å¿†**ï¼š
- å®‰å…¨ç¼–ç å°±æ˜¯ä¸é»‘å®¢æ–—æ™ºæ–—å‹‡çš„è¿‡ç¨‹
- å‚æ•°åŒ–æŸ¥è¯¢æ˜¯é˜²SQLæ³¨å…¥çš„æœ€æœ‰æ•ˆæ–¹æ³•
- æ°¸è¿œä¸è¦ç›¸ä¿¡ä»»ä½•æ¥è‡ªç”¨æˆ·çš„è¾“å…¥æ•°æ®
- é”™è¯¯ä¿¡æ¯è¦å¯¹ç”¨æˆ·å‹å¥½ï¼Œå¯¹æ”»å‡»è€…æ— ç”¨
- å®‰å…¨æ˜¯ä¸€ä¸ªæŒç»­çš„è¿‡ç¨‹ï¼Œä¸æ˜¯ä¸€æ¬¡æ€§çš„å·¥ä½œ

> ğŸ’¡ **å®‰å…¨ç¼–ç é‡‘å¥**ï¼š
> "åœ¨å®‰å…¨é¢å‰ï¼Œæ²¡æœ‰å°äº‹ã€‚æ¯ä¸€è¡Œä»£ç éƒ½å¯èƒ½æ˜¯æ”»å‡»è€…çš„çªç ´å£ï¼Œä¹Ÿå¯èƒ½æ˜¯å®ˆæŠ¤ç³»ç»Ÿçš„é˜²çº¿ã€‚"