---
title: 7ã€è¾“å…¥éªŒè¯ä¸è¿‡æ»¤æœºåˆ¶
---
## ğŸ“š ç›®å½•

1. [è¾“å…¥éªŒè¯åŸºç¡€æ¦‚å¿µ](#1-è¾“å…¥éªŒè¯åŸºç¡€æ¦‚å¿µ)
2. [æ•°æ®ç±»å‹éªŒè¯æœºåˆ¶](#2-æ•°æ®ç±»å‹éªŒè¯æœºåˆ¶)
3. [é•¿åº¦é™åˆ¶ä¸æ ¼å¼æ ¡éªŒ](#3-é•¿åº¦é™åˆ¶ä¸æ ¼å¼æ ¡éªŒ)
4. [ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤æŠ€æœ¯](#4-ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤æŠ€æœ¯)
5. [æ­£åˆ™è¡¨è¾¾å¼éªŒè¯](#5-æ­£åˆ™è¡¨è¾¾å¼éªŒè¯)
6. [ä¸šåŠ¡é€»è¾‘éªŒè¯](#6-ä¸šåŠ¡é€»è¾‘éªŒè¯)
7. [å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯éªŒè¯ç­–ç•¥](#7-å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯éªŒè¯ç­–ç•¥)
8. [è¾“å…¥éªŒè¯æ¡†æ¶ä¸å·¥å…·](#8-è¾“å…¥éªŒè¯æ¡†æ¶ä¸å·¥å…·)
9. [æ•°æ®æ¶ˆæ¯’æŠ€æœ¯è¯¦è§£](#9-æ•°æ®æ¶ˆæ¯’æŠ€æœ¯è¯¦è§£)
10. [éªŒè¯ç»•è¿‡é˜²æŠ¤æ–¹æ³•](#10-éªŒè¯ç»•è¿‡é˜²æŠ¤æ–¹æ³•)
11. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#11-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ›¡ï¸ è¾“å…¥éªŒè¯åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯è¾“å…¥éªŒè¯


è¾“å…¥éªŒè¯æ˜¯æ£€æŸ¥ç”¨æˆ·æä¾›çš„æ•°æ®æ˜¯å¦ç¬¦åˆé¢„æœŸæ ¼å¼ã€ç±»å‹å’Œä¸šåŠ¡è§„åˆ™çš„è¿‡ç¨‹ï¼Œæ˜¯é˜²æ­¢SQLæ³¨å…¥æ”»å‡»çš„ç¬¬ä¸€é“é˜²çº¿ã€‚

**æ ¸å¿ƒç†å¿µ**ï¼šæ°¸è¿œä¸è¦ä¿¡ä»»ç”¨æˆ·è¾“å…¥

```
æ”»å‡»è€…è¾“å…¥ï¼š' OR 1=1 --
é¢„æœŸè¾“å…¥ï¼šç”¨æˆ·åæˆ–é‚®ç®±
éªŒè¯ç»“æœï¼šâŒ ä¸ç¬¦åˆé‚®ç®±æ ¼å¼ï¼Œæ‹’ç»å¤„ç†
```

### 1.2 è¾“å…¥éªŒè¯çš„é˜²æŠ¤åŸç†


```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    éªŒè¯    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    å¤„ç†    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·è¾“å…¥   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â†’  â”‚  éªŒè¯è¿‡æ»¤   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â†’  â”‚  æ•°æ®åº“æ“ä½œ â”‚
â”‚   æ•°æ®      â”‚            â”‚    å±‚       â”‚            â”‚     å±‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â†“                           â†“                           â†“
  ä»»æ„æ•°æ®                   å¯ä¿¡æ•°æ®                     å®‰å…¨æ‰§è¡Œ
```

> ğŸ’¡ **å…³é”®ç†è§£**ï¼šè¾“å…¥éªŒè¯ä¸æ˜¯ç®€å•çš„å­—ç¬¦æ›¿æ¢ï¼Œè€Œæ˜¯ä»æ ¹æœ¬ä¸Šç¡®ä¿æ•°æ®çš„åˆæ³•æ€§å’Œå®‰å…¨æ€§

### 1.3 éªŒè¯æœºåˆ¶çš„åˆ†ç±»


```
è¾“å…¥éªŒè¯ç±»å‹ï¼š
â”œâ”€â”€ æ ¼å¼éªŒè¯ â†’ æ•°æ®ç±»å‹ã€é•¿åº¦ã€æ ¼å¼æ˜¯å¦æ­£ç¡®
â”œâ”€â”€ å†…å®¹éªŒè¯ â†’ æ˜¯å¦åŒ…å«å±é™©å­—ç¬¦æˆ–æ¨¡å¼
â”œâ”€â”€ ä¸šåŠ¡éªŒè¯ â†’ æ˜¯å¦ç¬¦åˆä¸šåŠ¡é€»è¾‘è§„åˆ™
â””â”€â”€ å®‰å…¨éªŒè¯ â†’ æ˜¯å¦å­˜åœ¨æ”»å‡»ç‰¹å¾
```

---

## 2. ğŸ”¢ æ•°æ®ç±»å‹éªŒè¯æœºåˆ¶


### 2.1 åŸºæœ¬æ•°æ®ç±»å‹éªŒè¯


æ•°æ®ç±»å‹éªŒè¯ç¡®ä¿è¾“å…¥æ•°æ®ç¬¦åˆé¢„æœŸçš„æ•°æ®ç±»å‹ï¼Œé¿å…ç±»å‹æ··æ·†æ”»å‡»ã€‚

**æ•´æ•°éªŒè¯ç¤ºä¾‹**ï¼š
```java
// âœ… å®‰å…¨çš„æ•´æ•°éªŒè¯
public boolean isValidInteger(String input) {
    try {
        int value = Integer.parseInt(input);
        return value >= 0 && value <= Integer.MAX_VALUE;
    } catch (NumberFormatException e) {
        return false; // ä¸æ˜¯æœ‰æ•ˆæ•´æ•°
    }
}

// ä½¿ç”¨ç¤ºä¾‹
String userId = request.getParameter("id");
if (!isValidInteger(userId)) {
    throw new ValidationException("ç”¨æˆ·IDå¿…é¡»æ˜¯æœ‰æ•ˆæ•´æ•°");
}
```

**æµ®ç‚¹æ•°éªŒè¯**ï¼š
```java
public boolean isValidDecimal(String input, int maxDecimalPlaces) {
    try {
        BigDecimal decimal = new BigDecimal(input);
        // æ£€æŸ¥å°æ•°ä½æ•°
        return decimal.scale() <= maxDecimalPlaces;
    } catch (NumberFormatException e) {
        return false;
    }
}
```

### 2.2 æ—¥æœŸæ—¶é—´éªŒè¯


```java
public boolean isValidDate(String dateStr, String pattern) {
    try {
        SimpleDateFormat sdf = new SimpleDateFormat(pattern);
        sdf.setLenient(false); // ä¸¥æ ¼æ¨¡å¼
        Date date = sdf.parse(dateStr);
        
        // æ£€æŸ¥æ—¥æœŸèŒƒå›´
        Date minDate = sdf.parse("1900-01-01");
        Date maxDate = new Date();
        
        return date.after(minDate) && date.before(maxDate);
    } catch (ParseException e) {
        return false;
    }
}
```

### 2.3 æšä¸¾å€¼éªŒè¯


```java
public enum UserRole {
    ADMIN, USER, GUEST
}

public boolean isValidRole(String roleStr) {
    try {
        UserRole.valueOf(roleStr.toUpperCase());
        return true;
    } catch (IllegalArgumentException e) {
        return false; // ä¸æ˜¯æœ‰æ•ˆçš„è§’è‰²
    }
}
```

---

## 3. ğŸ“ é•¿åº¦é™åˆ¶ä¸æ ¼å¼æ ¡éªŒ


### 3.1 é•¿åº¦é™åˆ¶éªŒè¯


é•¿åº¦é™åˆ¶æ˜¯é˜²æ­¢ç¼“å†²åŒºæº¢å‡ºå’Œè¶…é•¿æ¶æ„è¾“å…¥çš„é‡è¦æ‰‹æ®µã€‚

```java
public class LengthValidator {
    
    // å­—ç¬¦ä¸²é•¿åº¦éªŒè¯
    public boolean validateLength(String input, int minLen, int maxLen) {
        if (input == null) return false;
        int length = input.length();
        return length >= minLen && length <= maxLen;
    }
    
    // ç”¨æˆ·åé•¿åº¦éªŒè¯ï¼ˆ3-20ä¸ªå­—ç¬¦ï¼‰
    public boolean isValidUsername(String username) {
        return validateLength(username, 3, 20);
    }
    
    // é‚®ç®±é•¿åº¦éªŒè¯ï¼ˆ5-100ä¸ªå­—ç¬¦ï¼‰
    public boolean isValidEmailLength(String email) {
        return validateLength(email, 5, 100);
    }
}
```

### 3.2 å­—èŠ‚é•¿åº¦éªŒè¯


```java
// UTF-8å­—èŠ‚é•¿åº¦éªŒè¯ï¼ˆé˜²æ­¢æ•°æ®åº“å­—æ®µæº¢å‡ºï¼‰
public boolean validateByteLength(String input, int maxBytes) {
    if (input == null) return false;
    try {
        byte[] bytes = input.getBytes("UTF-8");
        return bytes.length <= maxBytes;
    } catch (UnsupportedEncodingException e) {
        return false;
    }
}
```

### 3.3 æ ¼å¼è§„èŒƒéªŒè¯


```java
public class FormatValidator {
    
    // ç”¨æˆ·åæ ¼å¼ï¼šå­—æ¯æ•°å­—ä¸‹åˆ’çº¿ï¼Œä¸èƒ½ä»¥æ•°å­—å¼€å¤´
    private static final String USERNAME_PATTERN = "^[a-zA-Z][a-zA-Z0-9_]{2,19}$";
    
    // å¯†ç æ ¼å¼ï¼šè‡³å°‘8ä½ï¼ŒåŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—
    private static final String PASSWORD_PATTERN = 
        "^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)[a-zA-Z\\d@$!%*?&]{8,}$";
    
    public boolean isValidUsername(String username) {
        return username != null && username.matches(USERNAME_PATTERN);
    }
    
    public boolean isValidPassword(String password) {
        return password != null && password.matches(PASSWORD_PATTERN);
    }
}
```

---

## 4. ğŸ”’ ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤æŠ€æœ¯


### 4.1 SQLæ³¨å…¥å±é™©å­—ç¬¦è¯†åˆ«


```java
public class SpecialCharacterFilter {
    
    // SQLæ³¨å…¥å¸¸ç”¨çš„å±é™©å­—ç¬¦
    private static final String[] DANGEROUS_CHARS = {
        "'", "\"", ";", "--", "/*", "*/", "xp_", "sp_",
        "SELECT", "INSERT", "UPDATE", "DELETE", "DROP", 
        "UNION", "OR", "AND", "EXEC"
    };
    
    // æ£€æŸ¥æ˜¯å¦åŒ…å«å±é™©å­—ç¬¦
    public boolean containsDangerousChars(String input) {
        if (input == null) return false;
        
        String upperInput = input.toUpperCase();
        for (String dangerous : DANGEROUS_CHARS) {
            if (upperInput.contains(dangerous.toUpperCase())) {
                return true;
            }
        }
        return false;
    }
}
```

### 4.2 å­—ç¬¦è½¬ä¹‰å¤„ç†


```java
public String escapeSpecialChars(String input) {
    if (input == null) return null;
    
    return input
        .replace("'", "''")        // å•å¼•å·è½¬ä¹‰
        .replace("\"", "\\\"")     // åŒå¼•å·è½¬ä¹‰
        .replace("\\", "\\\\")     // åæ–œæ è½¬ä¹‰
        .replace("\n", "\\n")      // æ¢è¡Œç¬¦è½¬ä¹‰
        .replace("\r", "\\r");     // å›è½¦ç¬¦è½¬ä¹‰
}
```

### 4.3 HTMLæ ‡ç­¾è¿‡æ»¤


```java
// ç§»é™¤HTMLæ ‡ç­¾ï¼ˆé˜²æ­¢XSSï¼‰
public String removeHtmlTags(String input) {
    if (input == null) return null;
    
    // ç§»é™¤æ‰€æœ‰HTMLæ ‡ç­¾
    return input.replaceAll("<[^>]*>", "");
}

// å…è®¸ç‰¹å®šçš„å®‰å…¨æ ‡ç­¾
public String sanitizeHtml(String input) {
    if (input == null) return null;
    
    // åªä¿ç•™å®‰å…¨çš„æ ‡ç­¾
    return input.replaceAll("<(?!/?(?:b|i|em|strong)\\b)[^>]*>", "");
}
```

---

## 5. ğŸ¯ æ­£åˆ™è¡¨è¾¾å¼éªŒè¯


### 5.1 å¸¸ç”¨éªŒè¯æ­£åˆ™è¡¨è¾¾å¼


```java
public class RegexValidator {
    
    // é‚®ç®±éªŒè¯
    private static final String EMAIL_REGEX = 
        "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$";
    
    // æ‰‹æœºå·éªŒè¯ï¼ˆä¸­å›½ï¼‰
    private static final String PHONE_REGEX = "^1[3-9]\\d{9}$";
    
    // IPåœ°å€éªŒè¯
    private static final String IP_REGEX = 
        "^((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)$";
    
    // URLéªŒè¯
    private static final String URL_REGEX = 
        "^https?://[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}(/.*)?$";
    
    public boolean isValidEmail(String email) {
        return email != null && email.matches(EMAIL_REGEX);
    }
    
    public boolean isValidPhone(String phone) {
        return phone != null && phone.matches(PHONE_REGEX);
    }
    
    public boolean isValidIP(String ip) {
        return ip != null && ip.matches(IP_REGEX);
    }
}
```

### 5.2 è‡ªå®šä¹‰ä¸šåŠ¡è§„åˆ™éªŒè¯


```java
// å•†å“ç¼–å·éªŒè¯ï¼šå­—æ¯å¼€å¤´ + 6ä½æ•°å­—
private static final String PRODUCT_CODE_REGEX = "^[A-Z]{2}\\d{6}$";

// é“¶è¡Œå¡å·éªŒè¯ï¼š16-19ä½æ•°å­—
private static final String BANK_CARD_REGEX = "^\\d{16,19}$";

// èº«ä»½è¯éªŒè¯ï¼ˆç®€åŒ–ç‰ˆï¼‰
private static final String ID_CARD_REGEX = "^\\d{17}[\\dX]$";

public boolean isValidProductCode(String code) {
    return code != null && code.matches(PRODUCT_CODE_REGEX);
}
```

### 5.3 æ­£åˆ™è¡¨è¾¾å¼å®‰å…¨è€ƒè™‘


> âš ï¸ **å®‰å…¨æé†’**ï¼šå¤æ‚çš„æ­£åˆ™è¡¨è¾¾å¼å¯èƒ½å¯¼è‡´ReDoSï¼ˆæ­£åˆ™è¡¨è¾¾å¼æ‹’ç»æœåŠ¡ï¼‰æ”»å‡»

```java
// âŒ å±é™©çš„æ­£åˆ™è¡¨è¾¾å¼ï¼ˆå¯èƒ½å¯¼è‡´ReDoSï¼‰
private static final String DANGEROUS_REGEX = "^(a+)+$";

// âœ… å®‰å…¨çš„æ­£åˆ™è¡¨è¾¾å¼
private static final String SAFE_REGEX = "^a{1,100}$";

// è®¾ç½®è¶…æ—¶é˜²æŠ¤
public boolean isValidWithTimeout(String input, String regex) {
    Pattern pattern = Pattern.compile(regex);
    Matcher matcher = pattern.matcher(input);
    
    // è®¾ç½®åŒ¹é…è¶…æ—¶ï¼ˆéœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“æˆ–è‡ªå®šä¹‰å®ç°ï¼‰
    return matcher.matches();
}
```

---

## 6. ğŸ’¼ ä¸šåŠ¡é€»è¾‘éªŒè¯


### 6.1 ä¸šåŠ¡è§„åˆ™éªŒè¯æ¡†æ¶


ä¸šåŠ¡é€»è¾‘éªŒè¯ç¡®ä¿æ•°æ®ä¸ä»…æ ¼å¼æ­£ç¡®ï¼Œè¿˜ç¬¦åˆä¸šåŠ¡è§„åˆ™å’Œçº¦æŸã€‚

```java
public class BusinessValidator {
    
    // ç”¨æˆ·æ³¨å†ŒéªŒè¯
    public ValidationResult validateUserRegistration(User user) {
        ValidationResult result = new ValidationResult();
        
        // 1. ç”¨æˆ·åå”¯ä¸€æ€§éªŒè¯
        if (userExists(user.getUsername())) {
            result.addError("ç”¨æˆ·åå·²å­˜åœ¨");
        }
        
        // 2. é‚®ç®±å”¯ä¸€æ€§éªŒè¯
        if (emailExists(user.getEmail())) {
            result.addError("é‚®ç®±å·²è¢«æ³¨å†Œ");
        }
        
        // 3. å¹´é¾„ä¸šåŠ¡è§„åˆ™éªŒè¯
        if (user.getAge() < 18) {
            result.addError("ç”¨æˆ·å¹´é¾„å¿…é¡»æ»¡18å²");
        }
        
        return result;
    }
    
    // è®¢å•é‡‘é¢éªŒè¯
    public boolean validateOrderAmount(BigDecimal amount, User user) {
        // æ£€æŸ¥é‡‘é¢èŒƒå›´
        if (amount.compareTo(BigDecimal.ZERO) <= 0) {
            return false;
        }
        
        // æ£€æŸ¥ç”¨æˆ·ä¿¡ç”¨é¢åº¦
        if (amount.compareTo(user.getCreditLimit()) > 0) {
            return false;
        }
        
        return true;
    }
}
```

### 6.2 å…³è”æ•°æ®éªŒè¯


```java
// éªŒè¯å¤–é”®å…³ç³»æ˜¯å¦å­˜åœ¨
public boolean validateForeignKey(Long categoryId, Long productId) {
    // éªŒè¯åˆ†ç±»æ˜¯å¦å­˜åœ¨
    if (!categoryExists(categoryId)) {
        return false;
    }
    
    // éªŒè¯äº§å“æ˜¯å¦å±äºè¯¥åˆ†ç±»
    if (!productBelongsToCategory(productId, categoryId)) {
        return false;
    }
    
    return true;
}

// éªŒè¯æ•°æ®çŠ¶æ€çš„ä¸šåŠ¡çº¦æŸ
public boolean canDeleteUser(Long userId) {
    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æœªå®Œæˆçš„è®¢å•
    if (hasActiveOrders(userId)) {
        return false;
    }
    
    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æœªç»“æ¸…çš„è´¦æ¬¾
    if (hasUnpaidBills(userId)) {
        return false;
    }
    
    return true;
}
```

---

## 7. ğŸŒ å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯éªŒè¯ç­–ç•¥


### 7.1 å®¢æˆ·ç«¯éªŒè¯ï¼ˆå‰ç«¯éªŒè¯ï¼‰


å®¢æˆ·ç«¯éªŒè¯æä¾›å³æ—¶åé¦ˆï¼Œæ”¹å–„ç”¨æˆ·ä½“éªŒï¼Œä½†**ä¸èƒ½ä½œä¸ºå®‰å…¨ä¾èµ–**ã€‚

```javascript
// JavaScriptå‰ç«¯éªŒè¯ç¤ºä¾‹
function validateForm() {
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    
    // é‚®ç®±æ ¼å¼éªŒè¯
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
        showError('è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€');
        return false;
    }
    
    // å¯†ç å¼ºåº¦éªŒè¯
    if (password.length < 8) {
        showError('å¯†ç é•¿åº¦è‡³å°‘8ä½');
        return false;
    }
    
    return true;
}
```

### 7.2 æœåŠ¡ç«¯éªŒè¯ï¼ˆåç«¯éªŒè¯ï¼‰


æœåŠ¡ç«¯éªŒè¯æ˜¯å®‰å…¨çš„æœ€åé˜²çº¿ï¼Œå¿…é¡»å¯¹æ‰€æœ‰è¾“å…¥è¿›è¡Œå®Œæ•´éªŒè¯ã€‚

```java
@RestController
public class UserController {
    
    @PostMapping("/register")
    public ResponseEntity<?> register(@RequestBody UserDto userDto) {
        
        // ğŸ”¸ é‡è¦ï¼šå³ä½¿å‰ç«¯å·²éªŒè¯ï¼ŒæœåŠ¡ç«¯ä»éœ€å®Œæ•´éªŒè¯
        ValidationResult validation = validateUser(userDto);
        if (!validation.isValid()) {
            return ResponseEntity.badRequest()
                .body(validation.getErrors());
        }
        
        // æ‰§è¡Œä¸šåŠ¡é€»è¾‘
        User user = userService.createUser(userDto);
        return ResponseEntity.ok(user);
    }
    
    private ValidationResult validateUser(UserDto userDto) {
        ValidationResult result = new ValidationResult();
        
        // é‡å¤æ‰€æœ‰å®¢æˆ·ç«¯éªŒè¯é€»è¾‘
        if (!isValidEmail(userDto.getEmail())) {
            result.addError("æ— æ•ˆçš„é‚®ç®±æ ¼å¼");
        }
        
        if (!isStrongPassword(userDto.getPassword())) {
            result.addError("å¯†ç å¼ºåº¦ä¸è¶³");
        }
        
        return result;
    }
}
```

### 7.3 åŒé‡éªŒè¯ç­–ç•¥


```
éªŒè¯ç­–ç•¥å¯¹æ¯”ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    éªŒè¯å±‚æ¬¡     â”‚      ä¼˜ç‚¹       â”‚      ç¼ºç‚¹       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å®¢æˆ·ç«¯éªŒè¯    â”‚ å³æ—¶åé¦ˆã€ä½“éªŒå¥½ â”‚ å®¹æ˜“è¢«ç»•è¿‡      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   æœåŠ¡ç«¯éªŒè¯    â”‚ å®‰å…¨å¯é         â”‚ åé¦ˆç¨æ…¢        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   åŒé‡éªŒè¯      â”‚ ä½“éªŒå¥½ä¸”å®‰å…¨    â”‚ å¼€å‘å·¥ä½œé‡å¤§    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> ğŸ’¡ **æœ€ä½³å®è·µ**ï¼šå‰ç«¯éªŒè¯æå‡ä½“éªŒï¼Œåç«¯éªŒè¯ä¿è¯å®‰å…¨ï¼Œä¸¤è€…ç¼ºä¸€ä¸å¯

---

## 8. ğŸ› ï¸ è¾“å…¥éªŒè¯æ¡†æ¶ä¸å·¥å…·


### 8.1 JavaéªŒè¯æ¡†æ¶ - Bean Validation


```java
import javax.validation.constraints.*;

public class UserDto {
    
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @Size(min = 3, max = 20, message = "ç”¨æˆ·åé•¿åº¦å¿…é¡»åœ¨3-20å­—ç¬¦ä¹‹é—´")
    @Pattern(regexp = "^[a-zA-Z][a-zA-Z0-9_]*$", 
             message = "ç”¨æˆ·ååªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œä¸”ä»¥å­—æ¯å¼€å¤´")
    private String username;
    
    @NotBlank(message = "é‚®ç®±ä¸èƒ½ä¸ºç©º")
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String email;
    
    @NotNull(message = "å¹´é¾„ä¸èƒ½ä¸ºç©º")
    @Min(value = 18, message = "å¹´é¾„ä¸èƒ½å°äº18å²")
    @Max(value = 120, message = "å¹´é¾„ä¸èƒ½å¤§äº120å²")
    private Integer age;
    
    // getters and setters
}

// éªŒè¯ä½¿ç”¨
@PostMapping("/user")
public ResponseEntity<?> createUser(@Valid @RequestBody UserDto userDto, 
                                   BindingResult bindingResult) {
    if (bindingResult.hasErrors()) {
        return ResponseEntity.badRequest()
            .body(bindingResult.getAllErrors());
    }
    
    // å¤„ç†æœ‰æ•ˆæ•°æ®
    return ResponseEntity.ok("ç”¨æˆ·åˆ›å»ºæˆåŠŸ");
}
```

### 8.2 è‡ªå®šä¹‰éªŒè¯æ³¨è§£


```java
// è‡ªå®šä¹‰å¯†ç å¼ºåº¦éªŒè¯æ³¨è§£
@Target({ElementType.FIELD})
@Retention(RetentionPolicy.RUNTIME)
@Constraint(validatedBy = StrongPasswordValidator.class)
public @interface StrongPassword {
    String message() default "å¯†ç å¼ºåº¦ä¸è¶³";
    Class<?>[] groups() default {};
    Class<? extends Payload>[] payload() default {};
}

// éªŒè¯å™¨å®ç°
public class StrongPasswordValidator 
    implements ConstraintValidator<StrongPassword, String> {
    
    @Override
    public boolean isValid(String password, ConstraintValidatorContext context) {
        if (password == null) return false;
        
        // è‡³å°‘8ä½ï¼ŒåŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—
        return password.length() >= 8 &&
               password.matches(".*[a-z].*") &&
               password.matches(".*[A-Z].*") &&
               password.matches(".*\\d.*");
    }
}
```

### 8.3 Spring Securityä¸­çš„éªŒè¯


```java
@Configuration
@EnableWebSecurity
public class SecurityConfig {
    
    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }
    
    // è‡ªå®šä¹‰ç”¨æˆ·è¯¦æƒ…æœåŠ¡
    @Bean
    public UserDetailsService userDetailsService() {
        return new CustomUserDetailsService();
    }
    
    // è¾“å…¥éªŒè¯è¿‡æ»¤å™¨
    @Bean
    public InputValidationFilter inputValidationFilter() {
        return new InputValidationFilter();
    }
}
```

---

## 9. ğŸ§¼ æ•°æ®æ¶ˆæ¯’æŠ€æœ¯è¯¦è§£


### 9.1 æ•°æ®æ¶ˆæ¯’çš„æ¦‚å¿µ


æ•°æ®æ¶ˆæ¯’ï¼ˆData Sanitizationï¼‰æ˜¯æ¸…ç†å’Œè§„èŒƒåŒ–è¾“å…¥æ•°æ®çš„è¿‡ç¨‹ï¼Œç¡®ä¿æ•°æ®å®‰å…¨ä¸”ç¬¦åˆé¢„æœŸæ ¼å¼ã€‚

```java
public class DataSanitizer {
    
    // HTMLå†…å®¹æ¶ˆæ¯’
    public String sanitizeHtml(String input) {
        if (input == null) return null;
        
        // ç§»é™¤å±é™©æ ‡ç­¾
        String cleaned = input.replaceAll("<script[^>]*>.*?</script>", "");
        cleaned = cleaned.replaceAll("<iframe[^>]*>.*?</iframe>", "");
        cleaned = cleaned.replaceAll("javascript:", "");
        
        return cleaned;
    }
    
    // SQLå†…å®¹æ¶ˆæ¯’
    public String sanitizeSql(String input) {
        if (input == null) return null;
        
        // ç§»é™¤SQLå…³é”®å­—å’Œç‰¹æ®Šå­—ç¬¦
        String cleaned = input.replaceAll("(?i)(union|select|insert|update|delete|drop)", "");
        cleaned = cleaned.replace("'", "''");
        cleaned = cleaned.replace("--", "");
        
        return cleaned;
    }
    
    // æ–‡ä»¶åæ¶ˆæ¯’
    public String sanitizeFileName(String fileName) {
        if (fileName == null) return null;
        
        // ç§»é™¤è·¯å¾„éå†å­—ç¬¦
        String cleaned = fileName.replace("..", "");
        cleaned = cleaned.replace("/", "");
        cleaned = cleaned.replace("\\", "");
        
        // åªä¿ç•™å®‰å…¨å­—ç¬¦
        return cleaned.replaceAll("[^a-zA-Z0-9._-]", "");
    }
}
```

### 9.2 ç¼–ç è½¬æ¢æ¶ˆæ¯’


```java
public class EncodingSanitizer {
    
    // URLç¼–ç æ¶ˆæ¯’
    public String sanitizeUrl(String url) {
        try {
            // è§£ç åé‡æ–°ç¼–ç ï¼Œé˜²æ­¢åŒé‡ç¼–ç æ”»å‡»
            String decoded = URLDecoder.decode(url, "UTF-8");
            return URLEncoder.encode(decoded, "UTF-8");
        } catch (UnsupportedEncodingException e) {
            return null;
        }
    }
    
    // Base64æ¶ˆæ¯’
    public String sanitizeBase64(String input) {
        try {
            // éªŒè¯æ˜¯å¦ä¸ºæœ‰æ•ˆçš„Base64
            byte[] decoded = Base64.getDecoder().decode(input);
            return Base64.getEncoder().encodeToString(decoded);
        } catch (IllegalArgumentException e) {
            return null; // æ— æ•ˆçš„Base64
        }
    }
}
```

### 9.3 æ•°æ®æ ¼å¼æ ‡å‡†åŒ–


```java
public class DataNormalizer {
    
    // é‚®ç®±æ ‡å‡†åŒ–
    public String normalizeEmail(String email) {
        if (email == null) return null;
        
        return email.toLowerCase().trim();
    }
    
    // æ‰‹æœºå·æ ‡å‡†åŒ–
    public String normalizePhone(String phone) {
        if (phone == null) return null;
        
        // ç§»é™¤æ‰€æœ‰éæ•°å­—å­—ç¬¦
        String digits = phone.replaceAll("\\D", "");
        
        // ä¸­å›½æ‰‹æœºå·æ ¼å¼åŒ–
        if (digits.length() == 11 && digits.startsWith("1")) {
            return digits;
        }
        
        return null; // æ— æ•ˆæ‰‹æœºå·
    }
    
    // é‡‘é¢æ ‡å‡†åŒ–
    public BigDecimal normalizeAmount(String amount) {
        if (amount == null) return null;
        
        try {
            // ç§»é™¤è´§å¸ç¬¦å·å’Œç©ºæ ¼
            String cleaned = amount.replaceAll("[Â¥$â‚¬Â£\\s,]", "");
            return new BigDecimal(cleaned).setScale(2, RoundingMode.HALF_UP);
        } catch (NumberFormatException e) {
            return null;
        }
    }
}
```

---

## 10. ğŸ”“ éªŒè¯ç»•è¿‡é˜²æŠ¤æ–¹æ³•


### 10.1 å¸¸è§ç»•è¿‡æŠ€æœ¯è¯†åˆ«


```java
public class BypassDetector {
    
    // æ£€æµ‹ç¼–ç ç»•è¿‡
    public boolean detectEncodingBypass(String input) {
        if (input == null) return false;
        
        // æ£€æµ‹URLç¼–ç ç»•è¿‡
        if (input.contains("%27") || input.contains("%22")) { // ' æˆ– "
            return true;
        }
        
        // æ£€æµ‹Unicodeç¼–ç ç»•è¿‡
        if (input.contains("\\u")) {
            return true;
        }
        
        // æ£€æµ‹åå…­è¿›åˆ¶ç¼–ç 
        if (input.matches(".*0x[0-9a-fA-F]+.*")) {
            return true;
        }
        
        return false;
    }
    
    // æ£€æµ‹å¤§å°å†™ç»•è¿‡
    public boolean detectCaseBypass(String input) {
        if (input == null) return false;
        
        String lower = input.toLowerCase();
        return lower.contains("select") || 
               lower.contains("union") || 
               lower.contains("insert");
    }
    
    // æ£€æµ‹æ³¨é‡Šç»•è¿‡
    public boolean detectCommentBypass(String input) {
        if (input == null) return false;
        
        return input.contains("/*") || 
               input.contains("*/") || 
               input.contains("--") ||
               input.contains("#");
    }
}
```

### 10.2 å¤šå±‚éªŒè¯é˜²æŠ¤


```java
public class MultiLayerValidator {
    
    public ValidationResult validateWithMultipleLayers(String input) {
        ValidationResult result = new ValidationResult();
        
        // ç¬¬ä¸€å±‚ï¼šåŸºç¡€æ ¼å¼éªŒè¯
        if (!basicFormatCheck(input)) {
            result.addError("åŸºç¡€æ ¼å¼éªŒè¯å¤±è´¥");
            return result;
        }
        
        // ç¬¬äºŒå±‚ï¼šç¼–ç æ£€æµ‹
        if (detectEncodingBypass(input)) {
            result.addError("æ£€æµ‹åˆ°ç¼–ç ç»•è¿‡å°è¯•");
            return result;
        }
        
        // ç¬¬ä¸‰å±‚ï¼šå†…å®¹å®‰å…¨æ£€æŸ¥
        if (containsMaliciousPattern(input)) {
            result.addError("æ£€æµ‹åˆ°æ¶æ„æ¨¡å¼");
            return result;
        }
        
        // ç¬¬å››å±‚ï¼šä¸šåŠ¡é€»è¾‘éªŒè¯
        if (!businessRuleCheck(input)) {
            result.addError("ä¸šåŠ¡è§„åˆ™éªŒè¯å¤±è´¥");
            return result;
        }
        
        return result;
    }
    
    private boolean containsMaliciousPattern(String input) {
        // ä½¿ç”¨æœºå™¨å­¦ä¹ æˆ–è§„åˆ™å¼•æ“æ£€æµ‹æ¶æ„æ¨¡å¼
        return MaliciousPatternDetector.detect(input);
    }
}
```

### 10.3 åŠ¨æ€éªŒè¯ç­–ç•¥


```java
public class DynamicValidator {
    
    private final AtomicInteger attemptCounter = new AtomicInteger(0);
    private final Map<String, LocalDateTime> ipAttempts = new ConcurrentHashMap<>();
    
    public boolean validateWithRateLimit(String input, String clientIP) {
        
        // æ£€æŸ¥IPè¯·æ±‚é¢‘ç‡
        LocalDateTime lastAttempt = ipAttempts.get(clientIP);
        if (lastAttempt != null && 
            Duration.between(lastAttempt, LocalDateTime.now()).toMinutes() < 1) {
            // 1åˆ†é’Ÿå†…é‡å¤è¯·æ±‚ï¼Œå¢å¼ºéªŒè¯
            return enhancedValidation(input);
        }
        
        ipAttempts.put(clientIP, LocalDateTime.now());
        return standardValidation(input);
    }
    
    private boolean enhancedValidation(String input) {
        // å¢å¼ºéªŒè¯ï¼šæ›´ä¸¥æ ¼çš„è§„åˆ™
        return input != null && 
               input.length() <= 50 && 
               !containsAnySpecialChars(input);
    }
}
```

---

## 11. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 11.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ è¾“å…¥éªŒè¯åŸåˆ™ï¼šæ°¸è¿œä¸è¦ä¿¡ä»»ç”¨æˆ·è¾“å…¥ï¼Œæ‰€æœ‰æ•°æ®éƒ½éœ€éªŒè¯
ğŸ”¸ éªŒè¯å±‚æ¬¡ï¼šæ ¼å¼éªŒè¯ â†’ å†…å®¹éªŒè¯ â†’ ä¸šåŠ¡éªŒè¯ â†’ å®‰å…¨éªŒè¯
ğŸ”¸ æ•°æ®ç±»å‹éªŒè¯ï¼šç¡®ä¿è¾“å…¥ç¬¦åˆé¢„æœŸçš„æ•°æ®ç±»å‹å’ŒèŒƒå›´
ğŸ”¸ é•¿åº¦é™åˆ¶ï¼šé˜²æ­¢ç¼“å†²åŒºæº¢å‡ºå’Œè¶…é•¿æ¶æ„è¾“å…¥
ğŸ”¸ ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤ï¼šè¯†åˆ«å’Œå¤„ç†SQLæ³¨å…¥çš„å±é™©å­—ç¬¦
ğŸ”¸ æ­£åˆ™è¡¨è¾¾å¼ï¼šçµæ´»çš„æ ¼å¼éªŒè¯å·¥å…·ï¼Œéœ€æ³¨æ„ReDoSé£é™©
ğŸ”¸ ä¸šåŠ¡é€»è¾‘éªŒè¯ï¼šç¡®ä¿æ•°æ®ç¬¦åˆä¸šåŠ¡è§„åˆ™å’Œçº¦æŸæ¡ä»¶
ğŸ”¸ åŒé‡éªŒè¯ï¼šå‰ç«¯éªŒè¯æå‡ä½“éªŒï¼Œåç«¯éªŒè¯ä¿è¯å®‰å…¨
```

### 11.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ éªŒè¯ä¸è¿‡æ»¤çš„åŒºåˆ«**
```
éªŒè¯ï¼ˆValidationï¼‰ï¼š
- æ£€æŸ¥æ•°æ®æ˜¯å¦ç¬¦åˆé¢„æœŸ
- ä¸ç¬¦åˆå°±æ‹’ç»å¤„ç†
- æ¨èçš„å®‰å…¨åšæ³•

è¿‡æ»¤ï¼ˆFilteringï¼‰ï¼š
- ä¿®æ”¹æ•°æ®ä½¿å…¶å˜"å®‰å…¨"
- å¯èƒ½æ”¹å˜åŸå§‹å«ä¹‰
- å­˜åœ¨è¢«ç»•è¿‡çš„é£é™©
```

**ğŸ”¹ å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯éªŒè¯çš„å®‰å…¨ç­–ç•¥**
```
å®‰å…¨åŸåˆ™ï¼š
âœ… æœåŠ¡ç«¯éªŒè¯æ˜¯å¿…é¡»çš„
âœ… å®¢æˆ·ç«¯éªŒè¯åªæ˜¯è¾…åŠ©
âŒ æ°¸è¿œä¸è¦åªä¾èµ–å®¢æˆ·ç«¯éªŒè¯
âŒ ä¸è¦å‡è®¾å®¢æˆ·ç«¯éªŒè¯æœ‰æ•ˆ
```

**ğŸ”¹ éªŒè¯ç­–ç•¥çš„è®¾è®¡åŸåˆ™**
```
ç™½åå• > é»‘åå•ï¼š
âœ… åªå…è®¸æ˜ç¡®å®‰å…¨çš„å­—ç¬¦
âŒ ç¦æ­¢å·²çŸ¥å±é™©çš„å­—ç¬¦

ä¸¥æ ¼éªŒè¯ > å®½æ¾è¿‡æ»¤ï¼š
âœ… ä¸¥æ ¼æ£€æŸ¥ï¼Œä¸ç¬¦åˆå°±æ‹’ç»
âŒ å°è¯•æ¸…ç†ï¼Œå¯èƒ½è¢«ç»•è¿‡
```

### 11.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ é˜²æŠ¤æ•ˆæœ**
- **SQLæ³¨å…¥é˜²æŠ¤**ï¼šé˜»æ­¢90%ä»¥ä¸Šçš„æ³¨å…¥æ”»å‡»
- **æ•°æ®è´¨é‡ä¿è¯**ï¼šç¡®ä¿æ•°æ®åº“æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§
- **ç³»ç»Ÿç¨³å®šæ€§**ï¼šé˜²æ­¢å¼‚å¸¸æ•°æ®å¯¼è‡´çš„ç¨‹åºå´©æºƒ
- **ç”¨æˆ·ä½“éªŒæå‡**ï¼šåŠæ—¶çš„é”™è¯¯æç¤ºå’Œæ ¼å¼æŒ‡å¯¼

**ğŸ”§ å®æ–½å»ºè®®**
```
1. å»ºç«‹éªŒè¯æ ‡å‡†ï¼š
   - åˆ¶å®šç»Ÿä¸€çš„éªŒè¯è§„åˆ™
   - åˆ›å»ºå¯å¤ç”¨çš„éªŒè¯ç»„ä»¶
   - å®šæœŸæ›´æ–°éªŒè¯ç­–ç•¥

2. å®æ–½ç›‘æ§ï¼š
   - è®°å½•éªŒè¯å¤±è´¥çš„å°è¯•
   - åˆ†ææ”»å‡»æ¨¡å¼
   - æŒç»­ä¼˜åŒ–éªŒè¯è§„åˆ™

3. æ€§èƒ½è€ƒè™‘ï¼š
   - é¿å…è¿‡åº¦å¤æ‚çš„æ­£åˆ™è¡¨è¾¾å¼
   - åˆç†ä½¿ç”¨ç¼“å­˜
   - å¹³è¡¡å®‰å…¨æ€§å’Œæ€§èƒ½
```

### 11.4 å®æˆ˜æ ¸å¿ƒè®°å¿†


> ğŸ’¡ **æ ¸å¿ƒå£è¯€**ï¼š
> 
> **æ•°æ®è¿›é—¨å…ˆéªŒèº«ï¼Œæ ¼å¼ç±»å‹é•¿åº¦æ¸…**
> 
> **ç‰¹æ®Šå­—ç¬¦è¦è¿‡æ»¤ï¼Œä¸šåŠ¡è§„åˆ™ä¸èƒ½æ¾**
> 
> **å‰ç«¯ä½“éªŒåç«¯å®‰å…¨ï¼Œå¤šå±‚é˜²æŠ¤ä¿å¤ªå¹³**
> 
> **ç™½åå•èƒœè¿‡é»‘åå•ï¼Œä¸¥æ ¼éªŒè¯èƒœè¿‡æ¸…æ´—**

**ğŸ¯ å…³é”®æ“ä½œè¦ç‚¹**ï¼š
1. **éªŒè¯é¡ºåº**ï¼šæ ¼å¼ â†’ ç±»å‹ â†’ é•¿åº¦ â†’ å†…å®¹ â†’ ä¸šåŠ¡
2. **éªŒè¯ä½ç½®**ï¼šå®¢æˆ·ç«¯ + æœåŠ¡ç«¯ï¼Œåç«¯éªŒè¯æ˜¯æ ¸å¿ƒ
3. **éªŒè¯ç­–ç•¥**ï¼šç™½åå•ä¼˜äºé»‘åå•ï¼Œæ‹’ç»ä¼˜äºæ¸…æ´—
4. **éªŒè¯èŒƒå›´**ï¼šæ‰€æœ‰ç”¨æˆ·è¾“å…¥ï¼Œæ— è®ºæ¥æºå’Œæ ¼å¼
5. **éªŒè¯æ›´æ–°**ï¼šæŒç»­ç›‘æ§å’Œä¼˜åŒ–éªŒè¯è§„åˆ™