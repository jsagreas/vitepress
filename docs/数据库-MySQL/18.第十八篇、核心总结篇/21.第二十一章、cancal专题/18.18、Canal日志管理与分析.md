---
title: 18ã€Canalæ—¥å¿—ç®¡ç†ä¸åˆ†æ
---
## ğŸ“š ç›®å½•

1. [Canalæ—¥å¿—ä½“ç³»æ¦‚è¿°](#1-Canalæ—¥å¿—ä½“ç³»æ¦‚è¿°)
2. [æ—¥å¿—çº§åˆ«é…ç½®è¯¦è§£](#2-æ—¥å¿—çº§åˆ«é…ç½®è¯¦è§£)
3. [æ—¥å¿—æ–‡ä»¶ç»“æ„åˆ†æ](#3-æ—¥å¿—æ–‡ä»¶ç»“æ„åˆ†æ)
4. [é”™è¯¯æ—¥å¿—åˆ†æä¸è¯Šæ–­](#4-é”™è¯¯æ—¥å¿—åˆ†æä¸è¯Šæ–­)
5. [è°ƒè¯•æ—¥å¿—ä¸æ•…éšœæ’æŸ¥](#5-è°ƒè¯•æ—¥å¿—ä¸æ•…éšœæ’æŸ¥)
6. [æ—¥å¿—è½®è½¬ä¸å­˜å‚¨ç®¡ç†](#6-æ—¥å¿—è½®è½¬ä¸å­˜å‚¨ç®¡ç†)
7. [æ—¥å¿—èšåˆä¸åˆ†æå·¥å…·](#7-æ—¥å¿—èšåˆä¸åˆ†æå·¥å…·)
8. [æ€§èƒ½ç›‘æ§ä¸å®¡è®¡æ—¥å¿—](#8-æ€§èƒ½ç›‘æ§ä¸å®¡è®¡æ—¥å¿—)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ“Š Canalæ—¥å¿—ä½“ç³»æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯Canalæ—¥å¿—ç³»ç»Ÿ


**æ ¸å¿ƒå®šä¹‰**
```
Canalæ—¥å¿—ç³»ç»Ÿï¼šè®°å½•Canalè¿è¡Œè¿‡ç¨‹ä¸­æ‰€æœ‰å…³é”®ä¿¡æ¯çš„æœºåˆ¶
ä½œç”¨ï¼šç›‘æ§è¿è¡ŒçŠ¶æ€ã€æ’æŸ¥é—®é¢˜ã€æ€§èƒ½åˆ†æã€å®¡è®¡è¿½è¸ª
é‡è¦æ€§ï¼šCanalç¨³å®šè¿è¡Œçš„é‡è¦ä¿éšœï¼Œè¿ç»´äººå‘˜çš„å¾—åŠ›åŠ©æ‰‹
```

**ğŸ” æ—¥å¿—çš„æœ¬è´¨ä½œç”¨**
- **æ•…éšœè¯Šæ–­**ï¼šå¿«é€Ÿå®šä½é—®é¢˜æ ¹æº
- **æ€§èƒ½ç›‘æ§**ï¼šäº†è§£ç³»ç»Ÿè¿è¡Œæ•ˆç‡
- **å®‰å…¨å®¡è®¡**ï¼šè¿½è¸ªæ•°æ®å˜æ›´è®°å½•
- **è¿ç»´å†³ç­–**ï¼šåŸºäºæ—¥å¿—æ•°æ®ä¼˜åŒ–é…ç½®

### 1.2 Canalæ—¥å¿—åˆ†ç±»ä½“ç³»


```
Canalæ—¥å¿—åˆ†ç±»æ¶æ„ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Canalæ—¥å¿—ä½“ç³»              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“‹ åº”ç”¨æ—¥å¿— (Application Logs)      â”‚
â”‚    â”œâ”€â”€ å¯åŠ¨æ—¥å¿—                     â”‚ 
â”‚    â”œâ”€â”€ åŒæ­¥æ—¥å¿—                     â”‚
â”‚    â””â”€â”€ å¼‚å¸¸æ—¥å¿—                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”§ ç³»ç»Ÿæ—¥å¿— (System Logs)          â”‚
â”‚    â”œâ”€â”€ JVM GCæ—¥å¿—                   â”‚
â”‚    â”œâ”€â”€ ç½‘ç»œè¿æ¥æ—¥å¿—                 â”‚
â”‚    â””â”€â”€ èµ„æºä½¿ç”¨æ—¥å¿—                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ¯ ä¸šåŠ¡æ—¥å¿— (Business Logs)        â”‚
â”‚    â”œâ”€â”€ æ•°æ®åŒæ­¥ç»Ÿè®¡                 â”‚
â”‚    â”œâ”€â”€ ä½ç‚¹ä¿¡æ¯è®°å½•                 â”‚
â”‚    â””â”€â”€ è¡¨ç»“æ„å˜æ›´æ—¥å¿—               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âš ï¸ é”™è¯¯æ—¥å¿— (Error Logs)           â”‚
â”‚    â”œâ”€â”€ è¿æ¥å¼‚å¸¸                     â”‚
â”‚    â”œâ”€â”€ è§£æé”™è¯¯                     â”‚
â”‚    â””â”€â”€ æ¶ˆè´¹å¼‚å¸¸                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 æ—¥å¿—åœ¨Canalæ¶æ„ä¸­çš„ä½ç½®


```
Canalè¿è¡Œæµç¨‹ä¸æ—¥å¿—è®°å½•ç‚¹ï¼š

MySQL Binlog â†’ Canal Server â†’ Consumer
     â†“              â†“           â†“
  è¿æ¥æ—¥å¿—      è§£æ/è½¬æ¢æ—¥å¿—   æ¶ˆè´¹æ—¥å¿—
     â†“              â†“           â†“
  é”™è¯¯è¯Šæ–­      æ€§èƒ½åˆ†æ      ä¸šåŠ¡ç›‘æ§
```

---

## 2. âš™ï¸ æ—¥å¿—çº§åˆ«é…ç½®è¯¦è§£


### 2.1 Canalæ”¯æŒçš„æ—¥å¿—çº§åˆ«


**ğŸ“‹ æ—¥å¿—çº§åˆ«è¯´æ˜**

| çº§åˆ« | **ä½œç”¨** | **è®°å½•å†…å®¹** | **é€‚ç”¨åœºæ™¯** | **æ€§èƒ½å½±å“** |
|------|---------|-------------|-------------|-------------|
| `ERROR` | **é”™è¯¯ä¿¡æ¯** | `è‡´å‘½é”™è¯¯ã€å¼‚å¸¸ä¸­æ–­` | `ç”Ÿäº§ç¯å¢ƒ` | `æä½` |
| `WARN` | **è­¦å‘Šä¿¡æ¯** | `æ½œåœ¨é—®é¢˜ã€é™çº§å¤„ç†` | `ç”Ÿäº§ç¯å¢ƒ` | `å¾ˆä½` |
| `INFO` | **ä¸€èˆ¬ä¿¡æ¯** | `é‡è¦æ“ä½œã€çŠ¶æ€å˜æ›´` | `ç”Ÿäº§ç¯å¢ƒ` | `ä½` |
| `DEBUG` | **è°ƒè¯•ä¿¡æ¯** | `è¯¦ç»†æ‰§è¡Œè¿‡ç¨‹` | `å¼€å‘/æµ‹è¯•` | `ä¸­ç­‰` |
| `TRACE` | **è·Ÿè¸ªä¿¡æ¯** | `æœ€è¯¦ç»†çš„æ‰§è¡Œæ­¥éª¤` | `æ·±åº¦è°ƒè¯•` | `é«˜` |

### 2.2 æ—¥å¿—çº§åˆ«é…ç½®æ–¹æ³•


**ğŸ”§ é…ç½®æ–‡ä»¶æ–¹å¼**

```properties
# canal.properties ä¸»é…ç½®æ–‡ä»¶
# è®¾ç½®å…¨å±€æ—¥å¿—çº§åˆ«
canal.instance.filter.druid.ddl = true
canal.instance.filter.query.dcl = false
canal.instance.filter.query.dml = false
canal.instance.filter.query.ddl = false

# è®¾ç½®å…·ä½“æ¨¡å—æ—¥å¿—çº§åˆ«
canal.instance.global.spring.xml = classpath:spring/file-instance.xml
```

**ğŸ“ logback.xmlé…ç½®ç¤ºä¾‹**

```xml
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <!-- æ§åˆ¶å°è¾“å‡º -->
    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n</pattern>
        </encoder>
    </appender>
    
    <!-- æ–‡ä»¶è¾“å‡º -->
    <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <file>/opt/canal/logs/canal.log</file>
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <fileNamePattern>/opt/canal/logs/canal.%d{yyyy-MM-dd}.log</fileNamePattern>
            <maxHistory>30</maxHistory>
        </rollingPolicy>
        <encoder>
            <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n</pattern>
        </encoder>
    </appender>
    
    <!-- ä¸åŒæ¨¡å—è®¾ç½®ä¸åŒçº§åˆ« -->
    <logger name="com.alibaba.otter.canal" level="INFO"/>
    <logger name="com.alibaba.otter.canal.parse" level="DEBUG"/>
    <logger name="com.alibaba.otter.canal.sink" level="INFO"/>
    
    <root level="INFO">
        <appender-ref ref="STDOUT"/>
        <appender-ref ref="FILE"/>
    </root>
</configuration>
```

### 2.3 åŠ¨æ€è°ƒæ•´æ—¥å¿—çº§åˆ«


**ğŸ’¡ è¿è¡Œæ—¶è°ƒæ•´æŠ€å·§**

```bash
# é€šè¿‡JMXåŠ¨æ€è°ƒæ•´ï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒï¼‰
# 1. å¼€å¯JMXç®¡ç†ç«¯å£
JAVA_OPTS="-Dcom.sun.management.jmxremote.port=1099"

# 2. ä½¿ç”¨jconsoleè¿æ¥è°ƒæ•´
# æˆ–è€…é€šè¿‡Canal Adminç•Œé¢è°ƒæ•´

# é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆéœ€è¦é‡å¯ï¼‰
# ä¸´æ—¶è°ƒè¯•æ—¶ä¿®æ”¹logback.xmlä¸­çš„levelå±æ€§
```

---

## 3. ğŸ“ æ—¥å¿—æ–‡ä»¶ç»“æ„åˆ†æ


### 3.1 Canalæ—¥å¿—æ–‡ä»¶ç›®å½•ç»“æ„


```
Canalæ—¥å¿—ç›®å½•ç»“æ„ï¼š

/opt/canal/logs/
â”œâ”€â”€ canal.log                 â† ä¸»æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ canal.2024-01-11.log     â† æŒ‰æ—¥æœŸè½®è½¬çš„å†å²æ—¥å¿—
â”œâ”€â”€ canal.2024-01-10.log
â”œâ”€â”€ instance/                â† å®ä¾‹çº§åˆ«æ—¥å¿—
â”‚   â”œâ”€â”€ example/
â”‚   â”‚   â”œâ”€â”€ example.log      â† å®ä¾‹è¿è¡Œæ—¥å¿—
â”‚   â”‚   â”œâ”€â”€ meta.log         â† ä½ç‚¹å…ƒæ•°æ®æ—¥å¿—
â”‚   â”‚   â””â”€â”€ parse.log        â† è§£æè¿‡ç¨‹æ—¥å¿—
â”‚   â””â”€â”€ order/
â”‚       â””â”€â”€ order.log
â”œâ”€â”€ admin/                   â† Canal Adminæ—¥å¿—
â”‚   â”œâ”€â”€ admin.log
â”‚   â””â”€â”€ access.log
â””â”€â”€ gc/                      â† GCæ—¥å¿—
    â”œâ”€â”€ gc.log
    â””â”€â”€ gc.log.0
```

### 3.2 ä¸»è¦æ—¥å¿—æ–‡ä»¶è¯¦è§£


**ğŸ“‹ canal.log - ä¸»æ—¥å¿—æ–‡ä»¶**
```
ä½œç”¨ï¼šè®°å½•Canal Serveræ•´ä½“è¿è¡ŒçŠ¶æ€
å†…å®¹ï¼šå¯åŠ¨ä¿¡æ¯ã€é…ç½®åŠ è½½ã€å®ä¾‹ç®¡ç†ã€å…¨å±€å¼‚å¸¸
é‡è¦æ€§ï¼šâ˜…â˜…â˜…â˜…â˜… (è¿ç»´å¿…çœ‹)

å…¸å‹æ—¥å¿—æ ¼å¼ï¼š
2024-01-12 10:30:15.123 [main] INFO  com.alibaba.otter.canal.deployer.CanalLauncher - ## start the canal server.
2024-01-12 10:30:15.456 [pool-1-thread-1] INFO  com.alibaba.otter.canal.instance.manager.CanalInstanceWithManager - start CannalInstance for 1-example
```

**ğŸ“‹ instanceæ—¥å¿— - å®ä¾‹çº§æ—¥å¿—**
```
ä½œç”¨ï¼šè®°å½•ç‰¹å®šå®ä¾‹çš„è¯¦ç»†è¿è¡Œä¿¡æ¯
å†…å®¹ï¼šbinlogè§£æã€æ•°æ®åŒæ­¥ã€ä½ç‚¹æ›´æ–°
å‘½åè§„åˆ™ï¼šinstance_name.log

é‡è¦å­—æ®µè§£é‡Šï¼š
- timestamp: æ—¥å¿—æ—¶é—´æˆ³
- thread: æ‰§è¡Œçº¿ç¨‹
- level: æ—¥å¿—çº§åˆ«  
- logger: æ—¥å¿—æ¥æºç±»
- message: å…·ä½“æ—¥å¿—å†…å®¹
```

### 3.3 æ—¥å¿—å†…å®¹ç»“æ„è§£æ


**ğŸ” æ ‡å‡†æ—¥å¿—æ ¼å¼è§£è¯»**

```
æ—¥å¿—æ ¼å¼æ¨¡æ¿ï¼š
[æ—¶é—´æˆ³] [çº¿ç¨‹å] [çº§åˆ«] [ç±»å] - [æ¶ˆæ¯å†…å®¹]

å®ä¾‹è§£æï¼š
2024-01-12 10:30:15.123 [destination = example , address = /127.0.0.1:3306] INFO  
com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser - 
prepare to find start position just show master status

å­—æ®µå«ä¹‰ï¼š
ğŸ“… æ—¶é—´æˆ³: 2024-01-12 10:30:15.123
ğŸ§µ çº¿ç¨‹ä¿¡æ¯: destination = example, address = /127.0.0.1:3306  
ğŸ“Š çº§åˆ«: INFO
ğŸ“¦ ç±»å: com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser
ğŸ’¬ æ¶ˆæ¯: prepare to find start position just show master status
```

---

## 4. ğŸš¨ é”™è¯¯æ—¥å¿—åˆ†æä¸è¯Šæ–­


### 4.1 å¸¸è§é”™è¯¯ç±»å‹åˆ†ç±»


**ğŸ“Š Canalé”™è¯¯åˆ†ç±»ä½“ç³»**

```
Canalé”™è¯¯åˆ†ç±»ï¼š

ğŸ”Œ è¿æ¥ç±»é”™è¯¯
â”œâ”€â”€ MySQLè¿æ¥è¶…æ—¶
â”œâ”€â”€ ç½‘ç»œä¸­æ–­å¼‚å¸¸  
â”œâ”€â”€ æƒé™è®¤è¯å¤±è´¥
â””â”€â”€ binlogæ–‡ä»¶ä¸¢å¤±

ğŸ” è§£æç±»é”™è¯¯  
â”œâ”€â”€ binlogæ ¼å¼ä¸æ”¯æŒ
â”œâ”€â”€ å­—ç¬¦é›†ç¼–ç é—®é¢˜
â”œâ”€â”€ DDLè¯­å¥è§£æå¤±è´¥
â””â”€â”€ äº‹åŠ¡çŠ¶æ€å¼‚å¸¸

ğŸ“¤ æ¶ˆè´¹ç±»é”™è¯¯
â”œâ”€â”€ æ¶ˆæ¯é˜Ÿåˆ—æ»¡è½½
â”œâ”€â”€ æ¶ˆè´¹è€…è¿æ¥æ–­å¼€
â”œâ”€â”€ æ•°æ®æ ¼å¼è½¬æ¢å¤±è´¥
â””â”€â”€ ç›®æ ‡ç³»ç»Ÿå†™å…¥å¼‚å¸¸
```

### 4.2 å…¸å‹é”™è¯¯æ—¥å¿—åˆ†æ


**âš ï¸ è¿æ¥é”™è¯¯ç¤ºä¾‹**

```bash
# é”™è¯¯æ—¥å¿—å†…å®¹
2024-01-12 10:35:22.456 [destination = example] ERROR 
com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser - 
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: 
Communications link failure

# é”™è¯¯åˆ†æ
é—®é¢˜ç±»å‹ï¼šMySQLè¿æ¥å¼‚å¸¸
å¯èƒ½åŸå› ï¼š
1. ç½‘ç»œä¸ç¨³å®šå¯¼è‡´è¿æ¥ä¸­æ–­
2. MySQLæœåŠ¡é‡å¯  
3. é˜²ç«å¢™è§„åˆ™å˜æ›´
4. è¿æ¥æ•°è¶…é™

# è§£å†³æ–¹æ¡ˆ
âœ… æ£€æŸ¥ç½‘ç»œè¿é€šæ€§: ping mysql_host
âœ… æ£€æŸ¥MySQLæœåŠ¡çŠ¶æ€: systemctl status mysqld  
âœ… æ£€æŸ¥è¿æ¥é…ç½®: canal.propertiesä¸­çš„æ•°æ®åº“é…ç½®
âœ… å¢åŠ é‡è¿æœºåˆ¶: canal.instance.connectionCharset = UTF-8
```

**âš ï¸ è§£æé”™è¯¯ç¤ºä¾‹**

```bash
# é”™è¯¯æ—¥å¿—å†…å®¹  
2024-01-12 11:15:33.789 [destination = example] ERROR
com.alibaba.otter.canal.parse.inbound.mysql.dbsync.LogEventConvert - 
parse row data failed

# é”™è¯¯åˆ†æ
é—®é¢˜ç±»å‹ï¼šæ•°æ®è§£æå¤±è´¥
å¸¸è§åŸå› ï¼š
1. binlogæ ¼å¼å˜æ›´(MIXED â†’ ROW)
2. è¡¨ç»“æ„ä¸Canalé…ç½®ä¸åŒ¹é…
3. å­—ç¬¦é›†ç¼–ç é—®é¢˜
4. å¤§å­—æ®µ(BLOB/TEXT)å¤„ç†å¼‚å¸¸

# è§£å†³æ–¹æ¡ˆ  
âœ… æ£€æŸ¥binlogæ ¼å¼: SHOW VARIABLES LIKE 'binlog_format'
âœ… éªŒè¯è¡¨ç»“æ„: DESC table_name
âœ… æ£€æŸ¥å­—ç¬¦é›†: SHOW CREATE TABLE table_name
âœ… è°ƒæ•´å®ä¾‹é…ç½®: canal.instance.filter.regex
```

### 4.3 é”™è¯¯æ—¥å¿—å¿«é€Ÿå®šä½æŠ€å·§


**ğŸ” æ—¥å¿—æŸ¥æ‰¾å‘½ä»¤**

```bash
# å¿«é€ŸæŸ¥æ‰¾é”™è¯¯æ—¥å¿—
grep -n "ERROR" /opt/canal/logs/canal.log

# æŸ¥æ‰¾ç‰¹å®šæ—¶é—´æ®µçš„é”™è¯¯
sed -n '/2024-01-12 10:30:00/,/2024-01-12 11:00:00/p' canal.log | grep ERROR

# ç»Ÿè®¡é”™è¯¯ç±»å‹åˆ†å¸ƒ
grep "ERROR" canal.log | awk '{print $5}' | sort | uniq -c | sort -nr

# æŸ¥æ‰¾è¿æ¥ç›¸å…³é”™è¯¯
grep -i "connection\|connect" canal.log | grep ERROR
```

**ğŸ’¡ é”™è¯¯æ—¥å¿—åˆ†æå·¥å…·**

```bash
# ä½¿ç”¨awkåˆ†æé”™è¯¯æ¨¡å¼
awk '/ERROR/ {
    time = $1 " " $2
    error_type = $5
    print time, error_type
}' canal.log | sort | uniq -c

# ä½¿ç”¨Pythonè„šæœ¬åˆ†æ(ç®€åŒ–ç‰ˆ)
python3 -c "
import re
with open('canal.log') as f:
    errors = re.findall(r'ERROR.*?Exception.*?:', f.read())
    for e in set(errors[:10]):
        print(e)
"
```

---

## 5. ğŸ”§ è°ƒè¯•æ—¥å¿—ä¸æ•…éšœæ’æŸ¥


### 5.1 å¼€å¯è°ƒè¯•æ—¥å¿—


**ğŸ› ï¸ è°ƒè¯•æ¨¡å¼é…ç½®**

```xml
<!-- logback.xmlä¸­å¼€å¯è°ƒè¯•çº§åˆ« -->
<configuration>
    <!-- è§£ææ¨¡å—è°ƒè¯• -->
    <logger name="com.alibaba.otter.canal.parse" level="DEBUG"/>
    
    <!-- åŒæ­¥æ¨¡å—è°ƒè¯• -->  
    <logger name="com.alibaba.otter.canal.sink" level="DEBUG"/>
    
    <!-- Storeæ¨¡å—è°ƒè¯• -->
    <logger name="com.alibaba.otter.canal.store" level="DEBUG"/>
    
    <!-- Metaæ¨¡å—è°ƒè¯• -->
    <logger name="com.alibaba.otter.canal.meta" level="DEBUG"/>
</configuration>
```

**ğŸ“ åŠ¨æ€å¼€å¯è°ƒè¯•**

```bash
# é€šè¿‡JMXå¼€å¯è°ƒè¯•(ç”Ÿäº§ç¯å¢ƒæ¨è)
# 1. è¿æ¥JMXæ§åˆ¶å°
jconsole service:jmx:rmi:///jndi/rmi://localhost:1099/jmxrmi

# 2. åœ¨MBeansæ ‡ç­¾é¡µæ‰¾åˆ°ch.qos.logback.classic
# 3. æ‰¾åˆ°å¯¹åº”Loggerï¼Œä¿®æ”¹Levelå±æ€§ä¸ºDEBUG

# ä¸´æ—¶å¼€å¯è°ƒè¯•æ¨¡å¼
kill -USR1 canal_pid  # æŸäº›ç‰ˆæœ¬æ”¯æŒä¿¡å·è°ƒæ•´
```

### 5.2 è°ƒè¯•æ—¥å¿—è§£è¯»


**ğŸ” è§£æè¿‡ç¨‹è°ƒè¯•æ—¥å¿—**

```bash
# å…¸å‹è°ƒè¯•æ—¥å¿—å†…å®¹
2024-01-12 12:00:01.123 [destination = example] DEBUG 
com.alibaba.otter.canal.parse.inbound.mysql.MysqlEventParser - 
received binlog event: 
{
  "eventType": "UPDATE",
  "serverId": 1,
  "timestamp": 1705046401123,
  "database": "test_db",
  "table": "user_info", 
  "eventPosition": {
    "gtid": "xxx-xxx-xxx:100",
    "journalName": "mysql-bin.000001",
    "position": 1234,
    "timestamp": 1705046401123
  }
}

# å…³é”®ä¿¡æ¯è§£è¯»ï¼š
ğŸ¯ eventType: äº‹ä»¶ç±»å‹ (INSERT/UPDATE/DELETE/DDL)
ğŸ  database/table: å½±å“çš„æ•°æ®åº“å’Œè¡¨
ğŸ“ position: binlogä½ç½®ä¿¡æ¯
â° timestamp: äº‹ä»¶å‘ç”Ÿæ—¶é—´
```

**ğŸ” æ¶ˆè´¹è¿‡ç¨‹è°ƒè¯•æ—¥å¿—**

```bash
# æ¶ˆè´¹è€…è°ƒè¯•æ—¥å¿—ç¤ºä¾‹
2024-01-12 12:00:02.456 [destination = example] DEBUG
com.alibaba.otter.canal.sink.AbstractCanalEventSink -
sink consume event: batchId = 100, size = 50, events = [
  {eventType: INSERT, rowChange: {...}},
  {eventType: UPDATE, rowChange: {...}}
]

# å…³é”®ä¿¡æ¯ï¼š
ğŸ“¦ batchId: æ‰¹æ¬¡IDï¼Œç”¨äºå¹‚ç­‰æ€§æ§åˆ¶  
ğŸ“Š size: æœ¬æ‰¹æ¬¡äº‹ä»¶æ•°é‡
ğŸ“‹ events: å…·ä½“äº‹ä»¶åˆ—è¡¨
```

### 5.3 æ•…éšœæ’æŸ¥æµç¨‹


**ğŸ”„ æ ‡å‡†æ’æŸ¥æµç¨‹**

```
æ•…éšœæ’æŸ¥æ­¥éª¤ï¼š

1ï¸âƒ£ é—®é¢˜ç°è±¡ç¡®è®¤
   â”œâ”€â”€ æ•°æ®ä¸åŒæ­¥
   â”œâ”€â”€ åŒæ­¥å»¶è¿Ÿé«˜
   â”œâ”€â”€ Canalè¿›ç¨‹å¼‚å¸¸
   â””â”€â”€ æ¶ˆè´¹è€…æ¥æ”¶å¼‚å¸¸

2ï¸âƒ£ æ—¥å¿—å¿«é€Ÿæ‰«æ  
   â”œâ”€â”€ grep ERROR recent logs
   â”œâ”€â”€ æ£€æŸ¥æœ€è¿‘çš„WARNING
   â”œâ”€â”€ æŸ¥çœ‹å®ä¾‹çŠ¶æ€æ—¥å¿—
   â””â”€â”€ ç¡®è®¤ä½ç‚¹æ›´æ–°æƒ…å†µ

3ï¸âƒ£ å¼€å¯è¯¦ç»†è°ƒè¯•
   â”œâ”€â”€ è®¾ç½®DEBUGçº§åˆ«
   â”œâ”€â”€ é‡ç°é—®é¢˜åœºæ™¯
   â”œâ”€â”€ æ”¶é›†è¯¦ç»†æ—¥å¿—
   â””â”€â”€ åˆ†æè°ƒç”¨é“¾è·¯

4ï¸âƒ£ æ ¹å› åˆ†æå®šä½
   â”œâ”€â”€ ç½‘ç»œè¿æ¥é—®é¢˜
   â”œâ”€â”€ MySQLé…ç½®é—®é¢˜  
   â”œâ”€â”€ Canalé…ç½®é—®é¢˜
   â””â”€â”€ ä¸šåŠ¡é€»è¾‘é—®é¢˜

5ï¸âƒ£ è§£å†³æ–¹æ¡ˆå®æ–½
   â”œâ”€â”€ ä¿®å¤é…ç½®é—®é¢˜
   â”œâ”€â”€ é‡å¯ç›¸å…³æœåŠ¡
   â”œâ”€â”€ æ¢å¤åŒæ­¥ä½ç‚¹
   â””â”€â”€ éªŒè¯ä¿®å¤æ•ˆæœ
```

---

## 6. ğŸ”„ æ—¥å¿—è½®è½¬ä¸å­˜å‚¨ç®¡ç†


### 6.1 æ—¥å¿—è½®è½¬ç­–ç•¥é…ç½®


**âš™ï¸ åŸºäºæ—¶é—´çš„è½®è½¬**

```xml
<!-- logback.xml æ—¶é—´è½®è½¬é…ç½® -->
<appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
    <file>/opt/canal/logs/canal.log</file>
    
    <!-- æŒ‰å¤©è½®è½¬ -->
    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
        <fileNamePattern>/opt/canal/logs/canal.%d{yyyy-MM-dd}.log</fileNamePattern>
        <maxHistory>30</maxHistory>
        <totalSizeCap>10GB</totalSizeCap>
    </rollingPolicy>
    
    <encoder>
        <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n</pattern>
    </encoder>
</appender>
```

**âš™ï¸ åŸºäºå¤§å°çš„è½®è½¬**

```xml
<!-- æŒ‰æ–‡ä»¶å¤§å°è½®è½¬ -->
<appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
    <file>/opt/canal/logs/canal.log</file>
    
    <rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
        <fileNamePattern>/opt/canal/logs/canal.%d{yyyy-MM-dd}.%i.log</fileNamePattern>
        <maxFileSize>100MB</maxFileSize>
        <maxHistory>30</maxHistory>
        <totalSizeCap>5GB</totalSizeCap>
    </rollingPolicy>
    
    <encoder>
        <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n</pattern>
    </encoder>
</appender>
```

### 6.2 æ—¥å¿—å­˜å‚¨ä¼˜åŒ–ç­–ç•¥


**ğŸ’¾ å­˜å‚¨é…ç½®å»ºè®®**

| ç¯å¢ƒç±»å‹ | **æ—¥å¿—çº§åˆ«** | **ä¿ç•™å¤©æ•°** | **æ–‡ä»¶å¤§å°é™åˆ¶** | **æ€»å®¹é‡é™åˆ¶** |
|---------|-------------|-------------|----------------|---------------|
| **å¼€å‘ç¯å¢ƒ** | `DEBUG` | `7å¤©` | `50MB` | `1GB` |
| **æµ‹è¯•ç¯å¢ƒ** | `INFO` | `15å¤©` | `100MB` | `3GB` |
| **ç”Ÿäº§ç¯å¢ƒ** | `INFO` | `30å¤©` | `500MB` | `10GB` |
| **ç´§æ€¥è°ƒè¯•** | `DEBUG` | `3å¤©` | `100MB` | `2GB` |

**ğŸ—‚ï¸ æ—¥å¿—å½’æ¡£è„šæœ¬**

```bash
#!/bin/bash
# canal_log_archive.sh - Canalæ—¥å¿—å½’æ¡£è„šæœ¬

CANAL_LOG_DIR="/opt/canal/logs"
ARCHIVE_DIR="/data/canal_archive"
DAYS_TO_KEEP=7

# åˆ›å»ºå½’æ¡£ç›®å½•
mkdir -p $ARCHIVE_DIR

# å‹ç¼©7å¤©å‰çš„æ—¥å¿—æ–‡ä»¶
find $CANAL_LOG_DIR -name "*.log.*" -mtime +$DAYS_TO_KEEP -exec gzip {} \;

# ç§»åŠ¨å‹ç¼©æ–‡ä»¶åˆ°å½’æ¡£ç›®å½•
find $CANAL_LOG_DIR -name "*.log.*.gz" -mtime +$DAYS_TO_KEEP \
  -exec mv {} $ARCHIVE_DIR/ \;

# æ¸…ç†30å¤©å‰çš„å½’æ¡£æ–‡ä»¶
find $ARCHIVE_DIR -name "*.gz" -mtime +30 -delete

echo "Canal logs archived successfully at $(date)"
```

### 6.3 æ—¥å¿—æ¸…ç†è‡ªåŠ¨åŒ–


**â° å®šæ—¶ä»»åŠ¡é…ç½®**

```bash
# æ·»åŠ åˆ°crontab
crontab -e

# æ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œæ—¥å¿—å½’æ¡£
0 2 * * * /opt/scripts/canal_log_archive.sh >> /var/log/canal_archive.log 2>&1

# æ¯å‘¨æ—¥å‡Œæ™¨3ç‚¹æ¸…ç†GCæ—¥å¿—
0 3 * * 0 find /opt/canal/logs/gc -name "*.log.*" -mtime +7 -delete
```

**ğŸ“Š æ—¥å¿—å­˜å‚¨ç›‘æ§**

```bash
#!/bin/bash
# æ—¥å¿—å­˜å‚¨ç©ºé—´ç›‘æ§è„šæœ¬

CANAL_LOG_DIR="/opt/canal/logs"
THRESHOLD=80  # ç£ç›˜ä½¿ç”¨ç‡é˜ˆå€¼

# æ£€æŸ¥ç£ç›˜ä½¿ç”¨ç‡
USAGE=$(df $CANAL_LOG_DIR | tail -1 | awk '{print $5}' | sed 's/%//')

if [ $USAGE -gt $THRESHOLD ]; then
    echo "WARNING: Canal logs directory usage is ${USAGE}%"
    # å‘é€å‘Šè­¦é€šçŸ¥
    # curl -X POST http://alertmanager:9093/api/v1/alerts ...
fi

# ç»Ÿè®¡å„ç±»å‹æ—¥å¿—æ–‡ä»¶å¤§å°
echo "Canal log files statistics:"
du -sh $CANAL_LOG_DIR/* | sort -hr
```

---

## 7. ğŸ“ˆ æ—¥å¿—èšåˆä¸åˆ†æå·¥å…·


### 7.1 ELK Stacké›†æˆ


**ğŸ”§ Filebeaté…ç½®**

```yaml
# filebeat.yml - æ”¶é›†Canalæ—¥å¿—åˆ°ELK
filebeat.inputs:
- type: log
  enabled: true
  paths:
    - /opt/canal/logs/canal.log
    - /opt/canal/logs/instance/*/example.log
  
  # æ—¥å¿—è§£æé…ç½®
  multiline.pattern: '^\d{4}-\d{2}-\d{2}'
  multiline.negate: true
  multiline.match: after
  
  # æ·»åŠ å­—æ®µæ ‡è¯†
  fields:
    service: canal
    environment: production
  fields_under_root: true

output.elasticsearch:
  hosts: ["elasticsearch:9200"]
  index: "canal-logs-%{+yyyy.MM.dd}"
  
# æ—¥å¿—å¤„ç†pipeline
processors:
- add_host_metadata: ~
- add_docker_metadata: ~
```

**ğŸ” Logstashè§£æé…ç½®**

```ruby
# logstash.conf - Canalæ—¥å¿—è§£æ
input {
  beats {
    port => 5044
  }
}

filter {
  if [service] == "canal" {
    grok {
      match => { 
        "message" => "%{TIMESTAMP_ISO8601:timestamp} \[%{DATA:thread}\] %{LOGLEVEL:level}\s+%{DATA:logger} - %{GREEDYDATA:msg}"
      }
    }
    
    date {
      match => [ "timestamp", "yyyy-MM-dd HH:mm:ss.SSS" ]
    }
    
    if [level] == "ERROR" {
      mutate {
        add_tag => [ "error", "alert" ]
      }
    }
  }
}

output {
  elasticsearch {
    hosts => ["elasticsearch:9200"]
    index => "canal-logs-%{+YYYY.MM.dd}"
  }
}
```

### 7.2 Grafanaç›‘æ§é¢æ¿


**ğŸ“Š Canalæ—¥å¿—ç›‘æ§é¢æ¿é…ç½®**

```json
{
  "dashboard": {
    "title": "Canalæ—¥å¿—ç›‘æ§",
    "panels": [
      {
        "title": "æ—¥å¿—çº§åˆ«åˆ†å¸ƒ",
        "type": "piechart",
        "datasource": "elasticsearch",
        "targets": [
          {
            "query": "service:canal",
            "bucketAggs": [
              {
                "field": "level.keyword",
                "type": "terms"
              }
            ]
          }
        ]
      },
      {
        "title": "é”™è¯¯æ—¥å¿—è¶‹åŠ¿",
        "type": "graph", 
        "datasource": "elasticsearch",
        "targets": [
          {
            "query": "service:canal AND level:ERROR",
            "timeField": "@timestamp"
          }
        ]
      }
    ]
  }
}
```

### 7.3 è‡ªå®šä¹‰æ—¥å¿—åˆ†æè„šæœ¬


**ğŸ Pythonæ—¥å¿—åˆ†æå·¥å…·**

```python
#!/usr/bin/env python3
# canal_log_analyzer.py - Canalæ—¥å¿—åˆ†æå·¥å…·

import re
import json
from datetime import datetime
from collections import defaultdict, Counter

class CanalLogAnalyzer:
    def __init__(self, log_file):
        self.log_file = log_file
        self.log_pattern = re.compile(
            r'(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d{3}) '
            r'\[([^\]]+)\] (\w+)\s+([^\s]+) - (.+)'
        )
    
    def parse_logs(self):
        """è§£ææ—¥å¿—æ–‡ä»¶"""
        logs = []
        with open(self.log_file, 'r', encoding='utf-8') as f:
            for line in f:
                match = self.log_pattern.match(line.strip())
                if match:
                    logs.append({
                        'timestamp': match.group(1),
                        'thread': match.group(2),
                        'level': match.group(3),
                        'logger': match.group(4),
                        'message': match.group(5)
                    })
        return logs
    
    def analyze_errors(self, logs):
        """åˆ†æé”™è¯¯æ—¥å¿—"""
        errors = [log for log in logs if log['level'] == 'ERROR']
        error_types = Counter()
        
        for error in errors:
            # æå–å¼‚å¸¸ç±»å‹
            if 'Exception' in error['message']:
                exception_match = re.search(r'(\w+Exception)', error['message'])
                if exception_match:
                    error_types[exception_match.group(1)] += 1
        
        return {
            'total_errors': len(errors),
            'error_types': dict(error_types.most_common(10)),
            'recent_errors': errors[-5:]  # æœ€è¿‘5ä¸ªé”™è¯¯
        }
    
    def generate_report(self):
        """ç”Ÿæˆåˆ†ææŠ¥å‘Š"""
        logs = self.parse_logs()
        
        report = {
            'summary': {
                'total_logs': len(logs),
                'log_levels': dict(Counter(log['level'] for log in logs)),
                'time_range': {
                    'start': logs[0]['timestamp'] if logs else None,
                    'end': logs[-1]['timestamp'] if logs else None
                }
            },
            'errors': self.analyze_errors(logs)
        }
        
        return report

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    analyzer = CanalLogAnalyzer('/opt/canal/logs/canal.log')
    report = analyzer.generate_report()
    print(json.dumps(report, indent=2, ensure_ascii=False))
```

---

## 8. ğŸ“Š æ€§èƒ½ç›‘æ§ä¸å®¡è®¡æ—¥å¿—


### 8.1 æ€§èƒ½æ—¥å¿—ç»Ÿè®¡


**ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡æ”¶é›†é…ç½®**

```xml
<!-- logback.xml æ€§èƒ½æ—¥å¿—é…ç½® -->
<appender name="PERF" class="ch.qos.logback.core.rolling.RollingFileAppender">
    <file>/opt/canal/logs/performance.log</file>
    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
        <fileNamePattern>/opt/canal/logs/performance.%d{yyyy-MM-dd}.log</fileNamePattern>
        <maxHistory>7</maxHistory>
    </rollingPolicy>
    <encoder>
        <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS}|%msg%n</pattern>
    </encoder>
</appender>

<!-- æ€§èƒ½æ—¥å¿—è®°å½•å™¨ -->
<logger name="canal.performance" level="INFO" additivity="false">
    <appender-ref ref="PERF"/>
</logger>
```

**ğŸ“Š æ€§èƒ½æŒ‡æ ‡è®°å½•ç¤ºä¾‹**

```java
// åœ¨Canalä»£ç ä¸­æ·»åŠ æ€§èƒ½ç›‘æ§
public class PerformanceLogger {
    private static final Logger perfLogger = 
        LoggerFactory.getLogger("canal.performance");
    
    public static void logSyncPerformance(String instance, 
            long batchSize, long processingTime, long position) {
        perfLogger.info("SYNC_PERF|{}|{}|{}|{}|{}", 
            instance, batchSize, processingTime, position, System.currentTimeMillis());
    }
    
    public static void logParsePerformance(String instance,
            String eventType, long parseTime) {
        perfLogger.info("PARSE_PERF|{}|{}|{}|{}", 
            instance, eventType, parseTime, System.currentTimeMillis());
    }
}
```

### 8.2 å®¡è®¡æ—¥å¿—è®°å½•


**ğŸ” å®¡è®¡æ—¥å¿—é…ç½®**

```xml
<!-- å®¡è®¡æ—¥å¿—ç‹¬ç«‹é…ç½® -->
<appender name="AUDIT" class="ch.qos.logback.core.rolling.RollingFileAppender">
    <file>/opt/canal/logs/audit.log</file>
    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
        <fileNamePattern>/opt/canal/logs/audit.%d{yyyy-MM-dd}.log</fileNamePattern>
        <maxHistory>90</maxHistory>  <!-- å®¡è®¡æ—¥å¿—ä¿ç•™æ›´é•¿æ—¶é—´ -->
    </rollingPolicy>
    <encoder>
        <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS}|%msg%n</pattern>
    </encoder>
</appender>

<logger name="canal.audit" level="INFO" additivity="false">
    <appender-ref ref="AUDIT"/>
</logger>
```

**ğŸ“ å®¡è®¡äº‹ä»¶è®°å½•**

```java
// å®¡è®¡æ—¥å¿—è®°å½•å™¨
public class AuditLogger {
    private static final Logger auditLogger = 
        LoggerFactory.getLogger("canal.audit");
    
    // è®°å½•æ•°æ®åŒæ­¥æ“ä½œ
    public static void logDataSync(String instance, String database, 
            String table, String operation, long timestamp) {
        auditLogger.info("DATA_SYNC|{}|{}|{}|{}|{}|{}", 
            instance, database, table, operation, timestamp, getUserInfo());
    }
    
    // è®°å½•é…ç½®å˜æ›´
    public static void logConfigChange(String instance, String config, 
            String oldValue, String newValue) {
        auditLogger.info("CONFIG_CHANGE|{}|{}|{}|{}|{}|{}", 
            instance, config, oldValue, newValue, 
            System.currentTimeMillis(), getUserInfo());
    }
    
    // è®°å½•è¿æ¥äº‹ä»¶
    public static void logConnection(String instance, String host, 
            String action, boolean success) {
        auditLogger.info("CONNECTION|{}|{}|{}|{}|{}|{}", 
            instance, host, action, success, 
            System.currentTimeMillis(), getUserInfo());
    }
    
    private static String getUserInfo() {
        // è·å–æ“ä½œç”¨æˆ·ä¿¡æ¯ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰
        return "system";
    }
}
```

### 8.3 æ—¥å¿—åˆ†æä¸å‘Šè­¦


**âš ï¸ åŸºäºæ—¥å¿—çš„å‘Šè­¦è§„åˆ™**

```bash
#!/bin/bash
# canal_log_alert.sh - Canalæ—¥å¿—å‘Šè­¦è„šæœ¬

CANAL_LOG="/opt/canal/logs/canal.log"
ERROR_THRESHOLD=10  # 5åˆ†é’Ÿå†…é”™è¯¯æ•°é˜ˆå€¼
ALERT_URL="http://alertmanager:9093/api/v1/alerts"

# æ£€æŸ¥æœ€è¿‘5åˆ†é’Ÿçš„é”™è¯¯æ•°é‡
FIVE_MIN_AGO=$(date -d "5 minutes ago" "+%Y-%m-%d %H:%M:%S")
ERROR_COUNT=$(awk -v start="$FIVE_MIN_AGO" '
  $1 " " $2 >= start && /ERROR/ { count++ } 
  END { print count+0 }
' $CANAL_LOG)

if [ $ERROR_COUNT -gt $ERROR_THRESHOLD ]; then
    # å‘é€å‘Šè­¦
    curl -X POST $ALERT_URL -H "Content-Type: application/json" -d '[
      {
        "labels": {
          "alertname": "CanalHighErrorRate",
          "service": "canal",
          "severity": "warning"
        },
        "annotations": {
          "summary": "Canal error rate is high",
          "description": "Canal has '$ERROR_COUNT' errors in last 5 minutes"
        }
      }
    ]'
fi

# æ£€æŸ¥å®ä¾‹çŠ¶æ€
INSTANCES=$(grep "start CannalInstance" $CANAL_LOG | tail -5)
if [ -z "$INSTANCES" ]; then
    echo "WARNING: No recent instance start logs found"
fi
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æ—¥å¿—ä½“ç³»ï¼šCanalæ—¥å¿—åˆ†ä¸ºåº”ç”¨ã€ç³»ç»Ÿã€ä¸šåŠ¡ã€é”™è¯¯å››å¤§ç±»
ğŸ”¸ çº§åˆ«é…ç½®ï¼šERROR/WARN/INFO/DEBUG/TRACEï¼Œç”Ÿäº§ç¯å¢ƒç”¨INFO
ğŸ”¸ æ–‡ä»¶ç»“æ„ï¼šä¸»æ—¥å¿—canal.log + å®ä¾‹æ—¥å¿— + å®¡è®¡æ—¥å¿—åˆ†ç¦»
ğŸ”¸ é”™è¯¯åˆ†æï¼šè¿æ¥ã€è§£æã€æ¶ˆè´¹ä¸‰ç±»é”™è¯¯çš„å¿«é€Ÿå®šä½æ–¹æ³•
ğŸ”¸ è°ƒè¯•æŠ€å·§ï¼šåŠ¨æ€è°ƒæ•´æ—¥å¿—çº§åˆ«ï¼Œå¼€å¯è¯¦ç»†è°ƒè¯•ä¿¡æ¯
ğŸ”¸ è½®è½¬ç®¡ç†ï¼šåŸºäºæ—¶é—´å’Œå¤§å°çš„æ—¥å¿—è½®è½¬ç­–ç•¥
ğŸ”¸ ç›‘æ§é›†æˆï¼šELK Stack + Grafanaå®ç°æ—¥å¿—å¯è§†åŒ–åˆ†æ
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æ—¥å¿—çº§åˆ«çš„é€‰æ‹©åŸåˆ™**
```
ç”Ÿäº§ç¯å¢ƒè€ƒè™‘ï¼š
- INFOçº§åˆ«ï¼šè®°å½•å…³é”®æ“ä½œï¼Œæ€§èƒ½å½±å“å°
- DEBUGçº§åˆ«ï¼šä»…åœ¨æ•…éšœæ’æŸ¥æ—¶ä¸´æ—¶å¼€å¯
- ERRORçº§åˆ«ï¼šå¿…é¡»è®°å½•ï¼Œç”¨äºå‘Šè­¦å’Œæ•…éšœåˆ†æ
- åŠ¨æ€è°ƒæ•´ï¼šé€šè¿‡JMXåœ¨ä¸é‡å¯çš„æƒ…å†µä¸‹è°ƒæ•´çº§åˆ«
```

**ğŸ”¹ æ—¥å¿—æ–‡ä»¶çš„ç®¡ç†ç­–ç•¥**
```
å­˜å‚¨ä¼˜åŒ–ï¼š
- æŒ‰ä¸šåŠ¡é‡è¦æ€§åˆ†çº§å­˜å‚¨ï¼ˆä¸»æ—¥å¿—vsè°ƒè¯•æ—¥å¿—ï¼‰
- åˆç†è®¾ç½®è½®è½¬å‘¨æœŸå’Œä¿ç•™æ—¶é—´
- å®šæœŸå½’æ¡£å’Œæ¸…ç†ï¼Œé¿å…ç£ç›˜ç©ºé—´ä¸è¶³
- æ€§èƒ½å’Œå®¡è®¡æ—¥å¿—ç‹¬ç«‹ç®¡ç†
```

**ğŸ”¹ æ•…éšœæ’æŸ¥çš„æ€è·¯**
```
æ’æŸ¥é¡ºåºï¼š
1. å…ˆçœ‹ERRORçº§åˆ«æ—¥å¿—ç¡®å®šé—®é¢˜ç±»å‹
2. å¼€å¯DEBUGçº§åˆ«è·å–è¯¦ç»†ä¿¡æ¯  
3. ç»“åˆæ€§èƒ½æ—¥å¿—åˆ†ææ˜¯å¦ä¸ºæ€§èƒ½é—®é¢˜
4. æŸ¥çœ‹å®¡è®¡æ—¥å¿—ç¡®è®¤æ“ä½œæ—¶åº
5. ä½¿ç”¨åˆ†æå·¥å…·è¿›è¡Œæ¨¡å¼è¯†åˆ«
```

### 9.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ“Š è¿ç»´åœºæ™¯åº”ç”¨**
- **æ•…éšœè¯Šæ–­**ï¼šé€šè¿‡æ—¥å¿—å¿«é€Ÿå®šä½CanalåŒæ­¥å¼‚å¸¸åŸå› 
- **æ€§èƒ½ä¼˜åŒ–**ï¼šåŸºäºæ€§èƒ½æ—¥å¿—è°ƒæ•´Canalé…ç½®å‚æ•°
- **å®¹é‡è§„åˆ’**ï¼šé€šè¿‡æ—¥å¿—åˆ†æé¢„æµ‹å­˜å‚¨å’Œè®¡ç®—èµ„æºéœ€æ±‚
- **å®‰å…¨å®¡è®¡**ï¼šå®¡è®¡æ—¥å¿—æä¾›æ•°æ®å˜æ›´çš„å®Œæ•´è¿½è¸ªé“¾è·¯

**ğŸ”§ å¼€å‘è°ƒè¯•åº”ç”¨**
- **åŠŸèƒ½æµ‹è¯•**ï¼šé€šè¿‡è°ƒè¯•æ—¥å¿—éªŒè¯æ•°æ®åŒæ­¥é€»è¾‘
- **æ€§èƒ½æµ‹è¯•**ï¼šæ€§èƒ½æ—¥å¿—å¸®åŠ©è¯†åˆ«åŒæ­¥ç“¶é¢ˆ
- **é›†æˆæµ‹è¯•**ï¼šæ—¥å¿—å¸®åŠ©æ’æŸ¥ä¸ä¸‹æ¸¸ç³»ç»Ÿçš„é›†æˆé—®é¢˜

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- Canalæ—¥å¿—æ˜¯è¿ç»´çš„çœ¼ç›ï¼Œè¦å–„ç”¨ä¸åŒçº§åˆ«
- é”™è¯¯æ—¥å¿—çœ‹ç°è±¡ï¼Œè°ƒè¯•æ—¥å¿—çœ‹è¿‡ç¨‹  
- æ—¥å¿—ç®¡ç†è¦å¹³è¡¡è¯¦ç»†åº¦å’Œå­˜å‚¨æˆæœ¬
- è‡ªåŠ¨åŒ–çš„æ—¥å¿—åˆ†ææ¯”äººå·¥æŸ¥çœ‹æ›´é«˜æ•ˆ