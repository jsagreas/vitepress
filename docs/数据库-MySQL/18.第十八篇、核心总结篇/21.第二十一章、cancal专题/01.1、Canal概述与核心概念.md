---
title: 1ã€Canalæ¦‚è¿°ä¸æ ¸å¿ƒæ¦‚å¿µ
---
## ğŸ“š ç›®å½•

1. [Canalæ˜¯ä»€ä¹ˆ](#1-Canalæ˜¯ä»€ä¹ˆ)
2. [Canalçš„æ ¸å¿ƒä½œç”¨](#2-Canalçš„æ ¸å¿ƒä½œç”¨)
3. [MySQL binlogè§£ææœºåˆ¶](#3-MySQL-binlogè§£ææœºåˆ¶)
4. [æ•°æ®åŒæ­¥çš„åŸºæœ¬åŸç†](#4-æ•°æ®åŒæ­¥çš„åŸºæœ¬åŸç†)
5. [Canalåœ¨ä¼ä¸šä¸­çš„åº”ç”¨åœºæ™¯](#5-Canalåœ¨ä¼ä¸šä¸­çš„åº”ç”¨åœºæ™¯)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” Canalæ˜¯ä»€ä¹ˆ


### 1.1 Canalçš„åŸºæœ¬å®šä¹‰


> **Canal** æ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„ä¸€ä¸ª**MySQLæ•°æ®åº“å¢é‡è®¢é˜…&æ¶ˆè´¹ç»„ä»¶**ï¼Œè¯´ç™½äº†å°±æ˜¯ä¸€ä¸ªèƒ½å¤Ÿ**å®æ—¶ç›‘å¬MySQLæ•°æ®å˜åŒ–**çš„å·¥å…·ã€‚

**ğŸ”¸ é€šä¿—ç†è§£**
```
æŠŠCanalæƒ³è±¡æˆä¸€ä¸ª"æ•°æ®åº“ç›‘å¬å™¨"ï¼š

ä¼ ç»Ÿæ–¹å¼ï¼šæ•°æ®å˜äº†ä¹Ÿä¸çŸ¥é“ï¼Œéœ€è¦ä¸»åŠ¨å»æŸ¥è¯¢
Canalæ–¹å¼ï¼šæ•°æ®ä¸€å˜åŒ–ï¼ŒCanalç«‹åˆ»å‘Šè¯‰ä½ å‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–

å°±åƒå¾®ä¿¡æ¶ˆæ¯æé†’ä¸€æ ·ï¼š
- ä¼ ç»Ÿæ–¹å¼ï¼šä½ å¾—ä¸æ–­æ‰“å¼€å¾®ä¿¡çœ‹æœ‰æ²¡æœ‰æ–°æ¶ˆæ¯  
- Canalæ–¹å¼ï¼šæœ‰æ–°æ¶ˆæ¯ç«‹åˆ»å¼¹å‡ºé€šçŸ¥å‘Šè¯‰ä½ 
```

### 1.2 Canalçš„æŠ€æœ¯èƒŒæ™¯


**ğŸ“‹ é˜¿é‡Œå·´å·´ä¸ºä»€ä¹ˆè¦å¼€å‘Canalï¼Ÿ**

åœ¨é˜¿é‡Œå·´å·´çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œç»å¸¸éœ€è¦ï¼š
- **å®æ—¶æ•°æ®åŒæ­¥**ï¼šè®¢å•æ•°æ®è¦åŒæ­¥åˆ°å¤šä¸ªç³»ç»Ÿ
- **æ•°æ®ç¼“å­˜æ›´æ–°**ï¼šMySQLæ•°æ®å˜äº†ï¼ŒRedisç¼“å­˜ä¹Ÿè¦è·Ÿç€å˜
- **æœç´¢å¼•æ“åŒæ­¥**ï¼šå•†å“ä¿¡æ¯å˜åŒ–è¦å®æ—¶æ›´æ–°åˆ°æœç´¢å¼•æ“
- **æ•°æ®ä»“åº“ETL**ï¼šå®æ—¶æŠŠä¸šåŠ¡æ•°æ®æŠ½å–åˆ°æ•°æ®ä»“åº“

ä¼ ç»Ÿçš„è§£å†³æ–¹æ¡ˆæœ‰å¾ˆå¤šé—®é¢˜ï¼š
- **å®šæ—¶è½®è¯¢**ï¼šå»¶è¿Ÿé«˜ï¼Œå¯¹æ•°æ®åº“å‹åŠ›å¤§
- **è§¦å‘å™¨æ–¹æ¡ˆ**ï¼šæ€§èƒ½å·®ï¼Œç»´æŠ¤å¤æ‚
- **åº”ç”¨å±‚é€šçŸ¥**ï¼šä»£ç ä¾µå…¥æ€§å¼ºï¼Œå®¹æ˜“é—æ¼

Canalå°±æ˜¯ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜è€Œè¯ç”Ÿçš„ã€‚

### 1.3 Canalçš„æ ¸å¿ƒç‰¹ç‚¹


```
Canalçš„æ ¸å¿ƒç‰¹ç‚¹å›¾è°±ï¼š

                    Canalæ ¸å¿ƒç‰¹ç‚¹
                   /              \
           æ— ä¾µå…¥æ€§                  é«˜æ€§èƒ½
          /        \              /        \
    ä¸æ”¹åº”ç”¨ä»£ç    ä¸æ”¹æ•°æ®åº“    ä½å»¶è¿Ÿ      é«˜åå
          \        /              \        /
           å®æ—¶æ€§                  å¯é æ€§
                   \              /
                    æ˜“äºä½¿ç”¨å’Œéƒ¨ç½²
```

| **ç‰¹ç‚¹** | **å…·ä½“è¯´æ˜** | **å®é™…æ„ä¹‰** |
|---------|-------------|-------------|
| **ğŸ”¸ æ— ä¾µå…¥** | `ä¸éœ€è¦ä¿®æ”¹åº”ç”¨ä»£ç å’Œæ•°æ®åº“` | `ç°æœ‰ç³»ç»Ÿé›¶æ”¹åŠ¨æ¥å…¥` |
| **ğŸ”¸ å®æ—¶æ€§** | `æ¯«ç§’çº§æ•°æ®å˜æ›´æ„ŸçŸ¥` | `æ¥è¿‘å®æ—¶çš„æ•°æ®åŒæ­¥` |
| **ğŸ”¸ é«˜æ€§èƒ½** | `å•æœºæ”¯æŒä¸‡çº§TPS` | `é€‚åˆé«˜å¹¶å‘åœºæ™¯` |
| **ğŸ”¸ å¯é æ€§** | `æ”¯æŒHAéƒ¨ç½²ï¼Œæ•°æ®ä¸ä¸¢å¤±` | `ç”Ÿäº§ç¯å¢ƒç¨³å®šè¿è¡Œ` |
| **ğŸ”¸ æ˜“ä½¿ç”¨** | `é…ç½®ç®€å•ï¼Œéƒ¨ç½²æ–¹ä¾¿` | `é™ä½æŠ€æœ¯é—¨æ§›` |

---

## 2. ğŸ¯ Canalçš„æ ¸å¿ƒä½œç”¨


### 2.1 å¢é‡æ•°æ®è®¢é˜…æ¶ˆè´¹


**ğŸ”¸ ä»€ä¹ˆæ˜¯å¢é‡æ•°æ®ï¼Ÿ**

```
å…¨é‡æ•°æ® vs å¢é‡æ•°æ®ï¼š

å…¨é‡æ•°æ®ï¼šæ•´å¼ è¡¨çš„æ‰€æœ‰æ•°æ®
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·è¡¨(100ä¸‡è¡Œ)  â”‚
â”‚ ID  å§“å  å¹´é¾„   â”‚
â”‚ 1   å¼ ä¸‰  25    â”‚
â”‚ 2   æå››  30    â”‚
â”‚ ... (æ‰€æœ‰æ•°æ®)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¢é‡æ•°æ®ï¼šåªå…³å¿ƒå˜åŒ–çš„éƒ¨åˆ†
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å˜æ›´äº‹ä»¶        â”‚
â”‚ æ–°å¢äº†ID=3çš„ç”¨æˆ· â”‚ â† åªè¦è¿™äº›å˜åŒ–
â”‚ ä¿®æ”¹äº†ID=1çš„å¹´é¾„ â”‚
â”‚ åˆ é™¤äº†ID=2çš„ç”¨æˆ· â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ’¡ ä¸ºä»€ä¹ˆè¦å…³æ³¨å¢é‡æ•°æ®ï¼Ÿ**

1. **æ•ˆç‡é«˜**ï¼šåªå¤„ç†å˜åŒ–çš„æ•°æ®ï¼Œä¸é‡å¤å¤„ç†
2. **å®æ—¶æ€§**ï¼šæ•°æ®ä¸€å˜åŒ–å°±èƒ½æ„ŸçŸ¥åˆ°
3. **èµ„æºçœ**ï¼šä¸éœ€è¦å…¨è¡¨æ‰«æï¼ŒèŠ‚çœCPUå’Œå†…å­˜
4. **ç²¾ç¡®æ€§**ï¼šçŸ¥é“å…·ä½“å‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–

### 2.2 MySQL binlogè§£ææ ¸å¿ƒæœºåˆ¶


**ğŸ”¸ ä»€ä¹ˆæ˜¯MySQL binlogï¼Ÿ**

> **binlog**ï¼ˆbinary logï¼‰æ˜¯MySQLçš„**äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶**ï¼Œè®°å½•äº†æ‰€æœ‰æ”¹å˜æ•°æ®çš„SQLè¯­å¥ã€‚

```
MySQL binlogå·¥ä½œåŸç†ï¼š

MySQLæœåŠ¡å™¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                     â”‚
â”‚  æ‰§è¡ŒSQL: UPDATE user SET age=26    â”‚
â”‚           WHERE id=1                â”‚
â”‚                â†“                    â”‚
â”‚  å†™å…¥binlog: è®°å½•è¿™æ¬¡æ›´æ–°æ“ä½œ       â”‚
â”‚                â†“                    â”‚
â”‚  binlogæ–‡ä»¶: mysql-bin.000001       â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“ Canalè¯»å–è§£æ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Canalè§£æ                â”‚
â”‚                                     â”‚
â”‚  è§£æå‡ºï¼šè¡¨å=user, æ“ä½œ=UPDATE     â”‚
â”‚  æ—§å€¼ï¼š{id:1, name:"å¼ ä¸‰", age:25}  â”‚
â”‚  æ–°å€¼ï¼š{id:1, name:"å¼ ä¸‰", age:26}  â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”§ Canalæ˜¯å¦‚ä½•è§£æbinlogçš„ï¼Ÿ**

Canal**ä¼ªè£…æˆMySQLçš„ä»åº“**ï¼ˆslaveï¼‰ï¼Œåˆ©ç”¨MySQLä¸»ä»å¤åˆ¶çš„æœºåˆ¶ï¼š

```
MySQLä¸»ä»å¤åˆ¶åŸç†ï¼š
                                          
MySQLä¸»åº“          ç½‘ç»œä¼ è¾“         MySQLä»åº“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       binlogäº‹ä»¶       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‰§è¡ŒSQL â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚ æ¥æ”¶å¹¶  â”‚
â”‚ å†™binlogâ”‚                       â”‚ é‡æ”¾SQL â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Canalçš„å·¥ä½œæ–¹å¼ï¼š
                                          
MySQLä¸»åº“          ç½‘ç»œä¼ è¾“         Canal
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       binlogäº‹ä»¶       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‰§è¡ŒSQL â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚ è§£æä½†  â”‚
â”‚ å†™binlogâ”‚                       â”‚ ä¸æ‰§è¡Œ  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â†“
                                 è½¬æ¢ä¸ºäº‹ä»¶
                                 å‘é€ç»™åº”ç”¨
```

**âš¡ å…³é”®ç†è§£è¦ç‚¹**ï¼š
- Canal**ä¸ä¼šä¿®æ”¹**MySQLçš„ä»»ä½•æ•°æ®
- Canal**åªæ˜¯è¯»å–**binlogå†…å®¹è¿›è¡Œè§£æ
- Canalè·å¾—çš„ä¿¡æ¯åŒ…æ‹¬ï¼š**å“ªå¼ è¡¨ã€ä»€ä¹ˆæ“ä½œã€æ—§æ•°æ®ã€æ–°æ•°æ®**

### 2.3 æ•°æ®åŒæ­¥ä¸­é—´ä»¶çš„å®šä½


**ğŸ”¸ ä»€ä¹ˆæ˜¯æ•°æ®åŒæ­¥ä¸­é—´ä»¶ï¼Ÿ**

ä¸­é—´ä»¶å°±æ˜¯**è¿æ¥ä¸åŒç³»ç»Ÿçš„æ¡¥æ¢**ï¼Œæ•°æ®åŒæ­¥ä¸­é—´ä»¶ä¸“é—¨è´Ÿè´£åœ¨ä¸åŒæ•°æ®å­˜å‚¨ä¹‹é—´ä¼ é€’æ•°æ®ã€‚

```
æ•°æ®åŒæ­¥åœºæ™¯ç¤ºä¾‹ï¼š

ä¸šåŠ¡ç³»ç»ŸA (MySQL)  â”€â”€â”
                     â”‚    â”Œâ”€â”€â”€ ç¼“å­˜ç³»ç»Ÿ (Redis)
ä¸šåŠ¡ç³»ç»ŸB (MySQL)  â”€â”€â”¼â”€â”€â”€â”€â”¤
                     â”‚    â”œâ”€â”€â”€ æœç´¢å¼•æ“ (ES)  
ä¸šåŠ¡ç³»ç»ŸC (MySQL)  â”€â”€â”˜    â””â”€â”€â”€ æ•°æ®ä»“åº“ (Hive)

ä¼ ç»Ÿæ–¹å¼ï¼šæ¯ä¸ªç³»ç»Ÿéƒ½è¦å†™ä»£ç å»åŒæ­¥æ•°æ® (å¤æ‚!)
Canalæ–¹å¼ï¼šCanalä½œä¸ºä¸­é—´ä»¶ç»Ÿä¸€å¤„ç†æ•°æ®åŒæ­¥ (ç®€å•!)
```

**ğŸ’¼ Canalä½œä¸ºä¸­é—´ä»¶çš„ä»·å€¼**ï¼š

| **è§£å†³çš„é—®é¢˜** | **ä¼ ç»Ÿæ–¹å¼** | **Canalæ–¹å¼** |
|---------------|-------------|--------------|
| **ä»£ç å¤æ‚åº¦** | `æ¯ä¸ªç³»ç»Ÿéƒ½è¦å†™åŒæ­¥é€»è¾‘` | `åªéœ€è¦é…ç½®Canal` |
| **å®æ—¶æ€§** | `å®šæ—¶è½®è¯¢ï¼Œæœ‰å»¶è¿Ÿ` | `å®æ—¶æ¨é€ï¼Œæ¯«ç§’çº§` |
| **æ•°æ®ä¸€è‡´æ€§** | `å®¹æ˜“å‡ºç°ä¸ä¸€è‡´` | `åŸºäºbinlogï¼Œå¼ºä¸€è‡´` |
| **ç³»ç»Ÿè€¦åˆ** | `å„ç³»ç»Ÿç´§å¯†è€¦åˆ` | `é€šè¿‡Canalè§£è€¦` |
| **ç»´æŠ¤æˆæœ¬** | `ä¿®æ”¹ä¸€å¤„è¦æ”¹å¤šå¤„` | `é›†ä¸­ç®¡ç†ï¼Œæ˜“ç»´æŠ¤` |

---

## 3. ğŸ“Š MySQL binlogè§£ææœºåˆ¶è¯¦è§£


### 3.1 binlogçš„åŸºæœ¬æ¦‚å¿µ


**ğŸ”¸ binlogæ˜¯ä»€ä¹ˆï¼Ÿ**

> binlogå°±åƒMySQLçš„"è®°è´¦æœ¬"ï¼Œè®°å½•äº†**æ‰€æœ‰å¯¹æ•°æ®çš„ä¿®æ”¹æ“ä½œ**ã€‚

```
æƒ³è±¡binlogå°±åƒé“¶è¡Œæµæ°´ï¼š

é“¶è¡Œæµæ°´è®°å½•ï¼š
æ—¶é—´         æ“ä½œ      é‡‘é¢      ä½™é¢
09:00       å­˜æ¬¾      +1000     5000
10:30       å–æ¬¾      -200      4800  
11:15       è½¬è´¦      -500      4300

MySQL binlogè®°å½•ï¼š
æ—¶é—´              æ“ä½œ           è¡¨å    æ•°æ®å˜åŒ–
2024-01-01 09:00  INSERT        user    æ–°å¢id=1çš„ç”¨æˆ·
2024-01-01 10:30  UPDATE        user    ä¿®æ”¹id=1çš„å¹´é¾„  
2024-01-01 11:15  DELETE        order   åˆ é™¤id=100çš„è®¢å•
```

### 3.2 binlogçš„ä¸‰ç§æ ¼å¼


MySQLçš„binlogæœ‰ä¸‰ç§è®°å½•æ ¼å¼ï¼ŒCanaléƒ½èƒ½è§£æï¼š

**ğŸ“‹ Statementæ ¼å¼ï¼ˆåŸºäºSQLè¯­å¥ï¼‰**
```sql
-- binlogè®°å½•çš„å†…å®¹
UPDATE user SET age = 26 WHERE id = 1;
```
- **ä¼˜ç‚¹**ï¼šbinlogæ–‡ä»¶å°ï¼ŒèŠ‚çœç©ºé—´
- **ç¼ºç‚¹**ï¼šæŸäº›å‡½æ•°ï¼ˆå¦‚NOW()ï¼‰åœ¨ä»åº“æ‰§è¡Œç»“æœå¯èƒ½ä¸åŒ

**ğŸ“‹ Rowæ ¼å¼ï¼ˆåŸºäºè¡Œå˜æ›´ï¼‰**
```json
-- binlogè®°å½•çš„å†…å®¹ï¼ˆæ¦‚å¿µç¤ºæ„ï¼‰
{
  "table": "user",
  "type": "UPDATE", 
  "before": {"id": 1, "name": "å¼ ä¸‰", "age": 25},
  "after":  {"id": 1, "name": "å¼ ä¸‰", "age": 26}
}
```
- **ä¼˜ç‚¹**ï¼šè®°å½•ç²¾ç¡®ï¼Œå®Œå…¨ä¸€è‡´
- **ç¼ºç‚¹**ï¼šbinlogæ–‡ä»¶è¾ƒå¤§

**ğŸ“‹ Mixedæ ¼å¼ï¼ˆæ··åˆæ¨¡å¼ï¼‰**
- ä¸€èˆ¬æƒ…å†µç”¨Statementæ ¼å¼
- ç‰¹æ®Šæƒ…å†µè‡ªåŠ¨åˆ‡æ¢åˆ°Rowæ ¼å¼

> **ğŸ’¡ Canalæ¨èé…ç½®**ï¼šä½¿ç”¨**Rowæ ¼å¼**ï¼Œå› ä¸ºèƒ½è·å¾—æœ€å®Œæ•´çš„æ•°æ®å˜æ›´ä¿¡æ¯ã€‚

### 3.3 Canalè§£æbinlogçš„è¯¦ç»†è¿‡ç¨‹


**ğŸ”„ Canalè§£ææµç¨‹å›¾**

```
Canalè§£æbinlogå®Œæ•´æµç¨‹ï¼š

ç¬¬1æ­¥ï¼šè¿æ¥MySQL
Canal â”€â”€â”€â”€è¿æ¥â”€â”€â”€â”€> MySQL (ä¼ªè£…æˆslave)

ç¬¬2æ­¥ï¼šè¯·æ±‚binlog
Canal â”€â”€â”€â”€è¯·æ±‚â”€â”€â”€â”€> MySQLå‘é€binlogäº‹ä»¶

ç¬¬3æ­¥ï¼šæ¥æ”¶åŸå§‹æ•°æ®  
Canal <â”€â”€â”€æ¥æ”¶â”€â”€â”€â”€â”€ MySQL (äºŒè¿›åˆ¶binlogæ•°æ®)

ç¬¬4æ­¥ï¼šè§£æè½¬æ¢
Canalå†…éƒ¨: äºŒè¿›åˆ¶æ•°æ® â†’ ç»“æ„åŒ–äº‹ä»¶å¯¹è±¡

ç¬¬5æ­¥ï¼šè¿‡æ»¤å¤„ç†
Canalå†…éƒ¨: æ ¹æ®é…ç½®è¿‡æ»¤è¡¨åã€æ“ä½œç±»å‹ç­‰

ç¬¬6æ­¥ï¼šæ¨é€äº‹ä»¶
Canal â”€â”€â”€â”€æ¨é€â”€â”€â”€â”€> åº”ç”¨ç¨‹åº (JSONæ ¼å¼äº‹ä»¶)
```

**ğŸ”§ Canalè§£æåçš„äº‹ä»¶æ ¼å¼**

Canalä¼šæŠŠbinlogè§£ææˆæ ‡å‡†çš„äº‹ä»¶æ ¼å¼ï¼š

```java
// Canaläº‹ä»¶å¯¹è±¡ç¤ºä¾‹
{
  "database": "test_db",           // æ•°æ®åº“å
  "table": "user",                 // è¡¨å  
  "type": "UPDATE",                // æ“ä½œç±»å‹ï¼šINSERT/UPDATE/DELETE
  "ts": 1635749982000,            // æ—¶é—´æˆ³
  "data": [                       // æ–°æ•°æ®ï¼ˆINSERT/UPDATEåçš„å€¼ï¼‰
    {"id": 1, "name": "å¼ ä¸‰", "age": 26}
  ],
  "old": [                        // æ—§æ•°æ®ï¼ˆUPDATE/DELETEå‰çš„å€¼ï¼‰  
    {"id": 1, "name": "å¼ ä¸‰", "age": 25}
  ]
}
```

---

## 4. ğŸ”„ æ•°æ®åŒæ­¥çš„åŸºæœ¬åŸç†


### 4.1 å®æ—¶æ•°æ®æµå¤„ç†æ¦‚å¿µ


**ğŸ”¸ ä»€ä¹ˆæ˜¯å®æ—¶æ•°æ®æµï¼Ÿ**

> **æ•°æ®æµ**å°±æ˜¯**è¿ç»­ä¸æ–­äº§ç”Ÿçš„æ•°æ®**ï¼Œå®æ—¶æ•°æ®æµå¤„ç†å°±æ˜¯**æ•°æ®ä¸€äº§ç”Ÿå°±ç«‹åˆ»å¤„ç†**ã€‚

```
ä¼ ç»Ÿæ‰¹å¤„ç† vs å®æ—¶æµå¤„ç†ï¼š

æ‰¹å¤„ç†æ–¹å¼ï¼š
æ—¶é—´: 00:00    01:00    02:00    03:00
æ•°æ®: [ç§¯ç´¯]   [ç§¯ç´¯]   [ç§¯ç´¯]   [æ‰¹é‡å¤„ç†]
ç‰¹ç‚¹: å»¶è¿Ÿå¤§ï¼Œä½†å¤„ç†æ•ˆç‡é«˜

æµå¤„ç†æ–¹å¼ï¼š  
æ—¶é—´: 00:00:01  00:00:02  00:00:03  00:00:04
æ•°æ®: [å¤„ç†]    [å¤„ç†]    [å¤„ç†]    [å¤„ç†]
ç‰¹ç‚¹: å»¶è¿Ÿå°ï¼Œæ¥è¿‘å®æ—¶
```

**ğŸ’¡ Canalçš„å®æ—¶æµå¤„ç†èƒ½åŠ›**ï¼š
- **æ•°æ®å˜æ›´**ï¼šMySQLè¡¨æ•°æ®ä¸€å˜åŒ–
- **ç«‹å³æ„ŸçŸ¥**ï¼šCanalæ¯«ç§’çº§æ„ŸçŸ¥åˆ°å˜æ›´
- **å³æ—¶æ¨é€**ï¼šç«‹åˆ»æŠŠå˜æ›´äº‹ä»¶æ¨é€ç»™åº”ç”¨
- **å®æ—¶å¤„ç†**ï¼šåº”ç”¨æ”¶åˆ°äº‹ä»¶åç«‹å³å¤„ç†

### 4.2 ETLæ•°æ®ä¼ è¾“æ¨¡å¼


**ğŸ”¸ ä»€ä¹ˆæ˜¯ETLï¼Ÿ**

**ETL** = **E**xtractï¼ˆæå–ï¼‰+ **T**ransformï¼ˆè½¬æ¢ï¼‰+ **L**oadï¼ˆåŠ è½½ï¼‰

```
ä¼ ç»ŸETLæµç¨‹ï¼š
                                              
æºæ•°æ®åº“ â”€â”€æå–â”€â”€> ä¸´æ—¶å­˜å‚¨ â”€â”€è½¬æ¢â”€â”€> ç›®æ ‡ç³»ç»Ÿ
(MySQL)         (æ–‡ä»¶/å†…å­˜)       (Redis/ES)

Canalçš„å®æ—¶ETLï¼š
                                              
æºæ•°æ®åº“ â”€â”€å®æ—¶ç›‘å¬â”€â”€> Canal â”€â”€å®æ—¶è½¬æ¢â”€â”€> ç›®æ ‡ç³»ç»Ÿ
(MySQL)             (è§£æå¤„ç†)        (Redis/ES)
```

**ğŸ”§ Canalåœ¨ETLä¸­çš„ä½œç”¨**ï¼š

1. **Extractï¼ˆæå–ï¼‰**ï¼šä»MySQL binlogæå–å˜æ›´æ•°æ®
2. **Transformï¼ˆè½¬æ¢ï¼‰**ï¼šå°†binlogäº‹ä»¶è½¬æ¢ä¸ºåº”ç”¨éœ€è¦çš„æ ¼å¼  
3. **Loadï¼ˆåŠ è½½ï¼‰**ï¼šå°†è½¬æ¢åçš„æ•°æ®å‘é€ç»™ç›®æ ‡ç³»ç»Ÿ

**ğŸ’¼ å®é™…åº”ç”¨ä¾‹å­**ï¼š
```
ç”µå•†è®¢å•åœºæ™¯ï¼š
1. ç”¨æˆ·ä¸‹å• â†’ MySQLè®¢å•è¡¨æ–°å¢è®°å½•
2. Canalæå– â†’ æ„ŸçŸ¥åˆ°æ–°è®¢å•äº‹ä»¶  
3. Canalè½¬æ¢ â†’ è½¬æ¢ä¸ºæ ‡å‡†äº‹ä»¶æ ¼å¼
4. CanalåŠ è½½ â†’ å‘é€åˆ°Redisç¼“å­˜ã€æœç´¢å¼•æ“ã€æ¨èç³»ç»Ÿ
```

### 4.3 äº‹ä»¶é©±åŠ¨æ¶æ„


**ğŸ”¸ ä»€ä¹ˆæ˜¯äº‹ä»¶é©±åŠ¨æ¶æ„ï¼Ÿ**

> **äº‹ä»¶é©±åŠ¨æ¶æ„**å°±æ˜¯**ä»¥äº‹ä»¶ä¸ºæ ¸å¿ƒçš„ç³»ç»Ÿè®¾è®¡æ¨¡å¼**ï¼Œç³»ç»Ÿå„éƒ¨åˆ†é€šè¿‡äº‹ä»¶æ¥é€šä¿¡ã€‚

```
ä¼ ç»Ÿçš„è°ƒç”¨æ¨¡å¼ï¼š
åº”ç”¨A â”€â”€ç›´æ¥è°ƒç”¨â”€â”€> åº”ç”¨B â”€â”€ç›´æ¥è°ƒç”¨â”€â”€> åº”ç”¨C
é—®é¢˜ï¼šç³»ç»Ÿç´§è€¦åˆï¼Œä¸€ä¸ªæŒ‚äº†å…¨éƒ¨å—å½±å“

äº‹ä»¶é©±åŠ¨æ¨¡å¼ï¼š
åº”ç”¨A â”€â”€å‘äº‹ä»¶â”€â”€> äº‹ä»¶æ€»çº¿ â”€â”€æ”¶äº‹ä»¶â”€â”€> åº”ç”¨B
                    â†“
                  åº”ç”¨Cä¹Ÿæ”¶äº‹ä»¶
ä¼˜ç‚¹ï¼šç³»ç»Ÿæ¾è€¦åˆï¼Œå®¹æ˜“æ‰©å±•
```

**ğŸ¯ Canalåœ¨äº‹ä»¶é©±åŠ¨æ¶æ„ä¸­çš„å®šä½**ï¼š

Canalå……å½“**äº‹ä»¶ç”Ÿäº§è€…**çš„è§’è‰²ï¼š
- **ç›‘å¬æºå¤´**ï¼šç›‘å¬MySQLæ•°æ®å˜åŒ–
- **ç”Ÿäº§äº‹ä»¶**ï¼šå°†æ•°æ®å˜åŒ–è½¬æ¢ä¸ºæ ‡å‡†äº‹ä»¶
- **å‘å¸ƒäº‹ä»¶**ï¼šå°†äº‹ä»¶å‘å¸ƒåˆ°æ¶ˆæ¯é˜Ÿåˆ—æˆ–ç›´æ¥æ¨é€

```
Canaläº‹ä»¶é©±åŠ¨æ¶æ„ç¤ºä¾‹ï¼š

MySQLæ•°æ®å˜åŒ–
       â†“
   Canalç›‘å¬è§£æ  
       â†“
   ç”Ÿæˆæ ‡å‡†äº‹ä»¶
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ¶ˆæ¯é˜Ÿåˆ—      â”‚
â”‚  (Kafka/RocketMQ) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
å¤šä¸ªæ¶ˆè´¹è€…è®¢é˜…ï¼š
- ç¼“å­˜æ›´æ–°æœåŠ¡
- æœç´¢ç´¢å¼•æœåŠ¡  
- æ•°æ®ä»“åº“ETL
- æ¶ˆæ¯æ¨é€æœåŠ¡
```

### 4.4 æ•°æ®ä¸€è‡´æ€§ä¿éšœæœºåˆ¶


**ğŸ”¸ ä»€ä¹ˆæ˜¯æ•°æ®ä¸€è‡´æ€§ï¼Ÿ**

> **æ•°æ®ä¸€è‡´æ€§**æ˜¯æŒ‡**å¤šä¸ªæ•°æ®å­˜å‚¨ä¹‹é—´çš„æ•°æ®ä¿æŒåŒæ­¥ä¸€è‡´**ã€‚

**ğŸ’¡ Canalå¦‚ä½•ä¿éšœæ•°æ®ä¸€è‡´æ€§ï¼Ÿ**

1. **åŸºäºbinlogçš„å¼ºä¸€è‡´æ€§**ï¼š
   - binlogæ˜¯MySQLçš„äº‹åŠ¡æ—¥å¿—ï¼Œå¤©ç„¶ä¿è¯ä¸€è‡´æ€§
   - åªæœ‰äº‹åŠ¡æäº¤åæ‰ä¼šå†™å…¥binlog
   - CanalåŸºäºbinlogï¼Œä¿è¯äº†æ•°æ®çš„å‡†ç¡®æ€§

2. **é¡ºåºæ€§ä¿éšœ**ï¼š
   ```
   MySQLäº‹åŠ¡æ‰§è¡Œé¡ºåºï¼š
   äº‹åŠ¡1ï¼šINSERT user (id=1) 
   äº‹åŠ¡2ï¼šUPDATE user (id=1, age=25)
   äº‹åŠ¡3ï¼šDELETE user (id=1)
   
   Canalè§£æé¡ºåºï¼š
   äº‹ä»¶1ï¼šç”¨æˆ·æ–°å¢äº‹ä»¶
   äº‹ä»¶2ï¼šç”¨æˆ·æ›´æ–°äº‹ä»¶  
   äº‹ä»¶3ï¼šç”¨æˆ·åˆ é™¤äº‹ä»¶
   
   ä¿è¯ï¼šCanalè¾“å‡ºçš„äº‹ä»¶é¡ºåº = MySQLæ‰§è¡Œé¡ºåº
   ```

3. **At-Least-Onceè¯­ä¹‰**ï¼š
   - Canalç¡®ä¿æ¯ä¸ªbinlogäº‹ä»¶è‡³å°‘è¢«å¤„ç†ä¸€æ¬¡
   - å¯èƒ½å‡ºç°é‡å¤ï¼Œä½†ä¸ä¼šä¸¢å¤±
   - åº”ç”¨ç«¯éœ€è¦åšå¹‚ç­‰å¤„ç†

**âš ï¸ æ³¨æ„äº‹é¡¹**ï¼š
- Canalä¿è¯**äº‹ä»¶ä¸ä¸¢å¤±**ï¼Œä½†éœ€è¦åº”ç”¨ç«¯å¤„ç†**é‡å¤äº‹ä»¶**
- ç½‘ç»œå¼‚å¸¸å¯èƒ½å¯¼è‡´äº‹ä»¶é‡å‘ï¼Œéœ€è¦ä¸šåŠ¡å±‚é¢åšå¥½**å¹‚ç­‰è®¾è®¡**

---

## 5. ğŸ¢ Canalåœ¨ä¼ä¸šä¸­çš„åº”ç”¨åœºæ™¯


### 5.1 æ•°æ®åº“æ—¥å¿—æŒ–æ˜


**ğŸ”¸ ä»€ä¹ˆæ˜¯æ—¥å¿—æŒ–æ˜ï¼Ÿ**

> **æ—¥å¿—æŒ–æ˜**å°±æ˜¯ä»æ•°æ®åº“æ—¥å¿—ä¸­**æŒ–æ˜å‡ºæœ‰ä»·å€¼çš„ä¸šåŠ¡ä¿¡æ¯**ã€‚

**ğŸ’¼ å®é™…åº”ç”¨åœºæ™¯**ï¼š

```
1. ç”¨æˆ·è¡Œä¸ºåˆ†æï¼š
MySQLè®°å½•ç”¨æˆ·æ“ä½œ â†’ Canalè§£æ â†’ å®æ—¶åˆ†æç”¨æˆ·è¡Œä¸ºæ¨¡å¼

2. ä¸šåŠ¡ç›‘æ§å‘Šè­¦ï¼š  
å…³é”®æ•°æ®å˜åŒ– â†’ Canalæ„ŸçŸ¥ â†’ è§¦å‘å®æ—¶å‘Šè­¦

3. æ•°æ®å®¡è®¡åˆè§„ï¼š
æ‰€æœ‰æ•°æ®å˜æ›´ â†’ Canalè®°å½• â†’ å½¢æˆå®Œæ•´å®¡è®¡æ—¥å¿—

4. å®æ—¶é£æ§ï¼š
äº¤æ˜“æ•°æ®å˜åŒ– â†’ Canalç›‘å¬ â†’ å®æ—¶é£é™©è¯„ä¼°
```

**ğŸ”§ æ—¥å¿—æŒ–æ˜çš„æŠ€æœ¯å®ç°**ï¼š

```java
// Canaläº‹ä»¶å¤„ç†ç¤ºä¾‹
public void handleCanalEvent(CanalEntry.Entry entry) {
    String tableName = entry.getHeader().getTableName();
    
    if ("user_login".equals(tableName)) {
        // ç”¨æˆ·ç™»å½•è¡Œä¸ºåˆ†æ
        analyzeUserBehavior(entry);
    } else if ("order".equals(tableName)) {
        // è®¢å•æ•°æ®å®æ—¶ç›‘æ§
        monitorOrderData(entry);
    } else if ("payment".equals(tableName)) {
        // æ”¯ä»˜æ•°æ®é£æ§æ£€æµ‹
        riskControlCheck(entry);
    }
}
```

### 5.2 å®æ—¶ç¼“å­˜æ›´æ–°


**ğŸ”¸ ç¼“å­˜åŒæ­¥çš„ç»å…¸é—®é¢˜**

ä¼ ç»Ÿçš„ç¼“å­˜æ›´æ–°ç­–ç•¥æœ‰å¾ˆå¤šé—®é¢˜ï¼š

```
é—®é¢˜åœºæ™¯ï¼š
1. æ•°æ®åº“æ›´æ–°äº†ï¼Œä½†å¿˜è®°æ›´æ–°ç¼“å­˜ â†’ æ•°æ®ä¸ä¸€è‡´
2. å…ˆæ›´æ–°ç¼“å­˜å†æ›´æ–°æ•°æ®åº“ â†’ å¦‚æœæ•°æ®åº“æ›´æ–°å¤±è´¥ï¼Œç¼“å­˜è„æ•°æ®
3. å…ˆæ›´æ–°æ•°æ®åº“å†æ›´æ–°ç¼“å­˜ â†’ å¦‚æœç¼“å­˜æ›´æ–°å¤±è´¥ï¼Œæ•°æ®ä¸ä¸€è‡´
4. å®šæ—¶åŒæ­¥ç¼“å­˜ â†’ æœ‰å»¶è¿Ÿï¼Œç”¨æˆ·å¯èƒ½çœ‹åˆ°æ—§æ•°æ®
```

**âœ… Canalè§£å†³ç¼“å­˜åŒæ­¥é—®é¢˜**ï¼š

```
Canalç¼“å­˜åŒæ­¥æ–¹æ¡ˆï¼š

MySQLæ•°æ®å˜æ›´
       â†“
Canalå®æ—¶æ„ŸçŸ¥ (æ¯«ç§’çº§)
       â†“
è§£æå˜æ›´äº‹ä»¶
       â†“
æ¨é€ç»™ç¼“å­˜æœåŠ¡
       â†“
Redisç¼“å­˜æ›´æ–°

ä¼˜åŠ¿ï¼š
âœ“ å®æ—¶æ€§ï¼šæ¯«ç§’çº§æ„ŸçŸ¥æ•°æ®å˜åŒ–
âœ“ å‡†ç¡®æ€§ï¼šåŸºäºbinlogï¼Œä¸ä¼šé—æ¼  
âœ“ è‡ªåŠ¨åŒ–ï¼šæ— éœ€ä¿®æ”¹ä¸šåŠ¡ä»£ç 
âœ“ å¯é æ€§ï¼šæ”¯æŒé‡è¯•å’Œæ•…éšœæ¢å¤
```

**ğŸ”§ ç¼“å­˜æ›´æ–°ä»£ç ç¤ºä¾‹**ï¼š

```java
@Component
public class CacheUpdateHandler {
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    public void handleUserUpdate(CanalEntry.Entry entry) {
        // è§£æç”¨æˆ·æ•°æ®å˜æ›´
        for (CanalEntry.RowData rowData : entry.getStoreValue()) {
            String userId = getColumnValue(rowData, "id");
            
            if (entry.getHeader().getEventType() == EventType.DELETE) {
                // åˆ é™¤ç¼“å­˜
                redisTemplate.delete("user:" + userId);
            } else {
                // æ›´æ–°ç¼“å­˜ 
                User user = buildUserFromRowData(rowData);
                redisTemplate.opsForValue().set("user:" + userId, user);
            }
        }
    }
}
```

### 5.3 æœç´¢å¼•æ“å®æ—¶åŒæ­¥


**ğŸ”¸ æœç´¢å¼•æ“åŒæ­¥çš„æŒ‘æˆ˜**

ç”µå•†ã€å†…å®¹å¹³å°ç­‰éœ€è¦æŠŠMySQLçš„æ•°æ®å®æ—¶åŒæ­¥åˆ°æœç´¢å¼•æ“ï¼ˆå¦‚Elasticsearchï¼‰ï¼š

```
æŒ‘æˆ˜ï¼š
1. å•†å“ä¿¡æ¯æ›´æ–°äº†ï¼Œæœç´¢ç»“æœè¦ç«‹å³ä½“ç°
2. åº“å­˜å˜åŒ–äº†ï¼Œæœç´¢è¦å®æ—¶æ˜¾ç¤ºåº“å­˜çŠ¶æ€  
3. å•†å“ä¸‹æ¶äº†ï¼Œæœç´¢ç»“æœè¦ç«‹å³ç§»é™¤
4. æ–°å•†å“ä¸Šæ¶ï¼Œè¦ç«‹å³å¯ä»¥è¢«æœç´¢åˆ°
```

**ğŸš€ Canalå®ç°æœç´¢å¼•æ“å®æ—¶åŒæ­¥**ï¼š

```
å®æ—¶åŒæ­¥æµç¨‹ï¼š

å•†å“æ•°æ®å˜æ›´ (MySQL)
       â†“
Canalç›‘å¬è§£æ
       â†“  
ç”ŸæˆåŒæ­¥äº‹ä»¶
       â†“
Elasticsearchç´¢å¼•æ›´æ–°
       â†“
ç”¨æˆ·æœç´¢çœ‹åˆ°æœ€æ–°ç»“æœ

æ—¶é—´å»¶è¿Ÿï¼š< 1ç§’
```

### 5.4 æ•°æ®ä»“åº“ETL


**ğŸ”¸ ä¼ ç»Ÿæ•°æ®ä»“åº“ETLçš„é—®é¢˜**

```
ä¼ ç»ŸT+1 ETLæ¨¡å¼ï¼š
ä»Šå¤©çš„æ•°æ® â†’ æ˜å¤©å‡Œæ™¨å¤„ç† â†’ æ˜å¤©ä¸Šåˆæ‰èƒ½çœ‹åˆ°æŠ¥è¡¨

é—®é¢˜ï¼š
- æ•°æ®å»¶è¿Ÿ24å°æ—¶
- æ— æ³•åšå®æ—¶å†³ç­–
- é”™è¿‡æœ€ä½³ä¸šåŠ¡æ—¶æœº
```

**âš¡ Canalå®ç°å‡†å®æ—¶æ•°æ®ä»“åº“**ï¼š

```
Canalå®æ—¶ETLï¼š

ä¸šåŠ¡æ•°æ®å˜æ›´ (MySQL)
       â†“
Canalå®æ—¶æ•è·
       â†“
æ•°æ®æ¸…æ´—è½¬æ¢
       â†“
å®æ—¶å†™å…¥æ•°æ®ä»“åº“ (Hive/ClickHouse)
       â†“  
å®æ—¶æŠ¥è¡¨æ›´æ–°

å»¶è¿Ÿï¼šåˆ†é’Ÿçº§åˆ«
```

**ğŸ’¼ åº”ç”¨ä»·å€¼**ï¼š
- **å®æ—¶å¤§å±**ï¼šè€æ¿å¯ä»¥å®æ—¶çœ‹åˆ°ä¸šåŠ¡æ•°æ®
- **å®æ—¶å†³ç­–**ï¼šåŸºäºæœ€æ–°æ•°æ®åšä¸šåŠ¡è°ƒæ•´
- **å®æ—¶å‘Šè­¦**ï¼šä¸šåŠ¡å¼‚å¸¸ç«‹å³å‘ç°
- **å®æ—¶åˆ†æ**ï¼šè¿è¥äººå‘˜éšæ—¶åˆ†ææœ€æ–°è¶‹åŠ¿

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Canalæœ¬è´¨ï¼šMySQLæ•°æ®å˜æ›´çš„å®æ—¶ç›‘å¬å™¨å’Œäº‹ä»¶ç”Ÿäº§è€…
ğŸ”¸ å·¥ä½œåŸç†ï¼šä¼ªè£…æˆMySQLä»åº“ï¼Œè§£æbinlogï¼Œè¾“å‡ºæ ‡å‡†äº‹ä»¶
ğŸ”¸ æ ¸å¿ƒä»·å€¼ï¼šå®ç°æ•°æ®çš„å®æ—¶åŒæ­¥ï¼Œæ”¯æ’‘äº‹ä»¶é©±åŠ¨æ¶æ„
ğŸ”¸ æŠ€æœ¯ç‰¹ç‚¹ï¼šæ— ä¾µå…¥ã€é«˜æ€§èƒ½ã€å®æ—¶æ€§ã€å¯é æ€§
ğŸ”¸ åº”ç”¨åœºæ™¯ï¼šç¼“å­˜åŒæ­¥ã€æœç´¢æ›´æ–°ã€æ•°æ®ä»“åº“ã€æ—¥å¿—æŒ–æ˜
```

### 6.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ Canal vs ä¼ ç»ŸåŒæ­¥æ–¹æ¡ˆ**
```
ä¼ ç»Ÿæ–¹æ¡ˆï¼šå®šæ—¶è½®è¯¢ã€è§¦å‘å™¨ã€åº”ç”¨é€šçŸ¥
Canalæ–¹æ¡ˆï¼šåŸºäºbinlogçš„å®æ—¶ç›‘å¬

ä¼˜åŠ¿å¯¹æ¯”ï¼š
å®æ—¶æ€§ï¼šæ¯«ç§’çº§ vs åˆ†é’Ÿçº§  
å‡†ç¡®æ€§ï¼šä¸ä¼šé—æ¼ vs å¯èƒ½é—æ¼
ä¾µå…¥æ€§ï¼šé›¶ä¾µå…¥ vs éœ€è¦æ”¹ä»£ç 
æ€§èƒ½ï¼šé«˜æ€§èƒ½ vs æœ‰æ€§èƒ½æŸè€—
```

**ğŸ”¹ binlogè§£æçš„æ ¸å¿ƒæœºåˆ¶**
```
å…³é”®ç†è§£ï¼š
1. Canalä¸ä¿®æ”¹æ•°æ®ï¼Œåªè¯»å–binlog
2. Canalä¼ªè£…æˆMySQLä»åº“è·å–binlog
3. è§£æå‡ºï¼šè¡¨åã€æ“ä½œç±»å‹ã€æ—§å€¼ã€æ–°å€¼
4. è½¬æ¢ä¸ºæ ‡å‡†äº‹ä»¶æ ¼å¼æ¨é€ç»™åº”ç”¨
```

**ğŸ”¹ æ•°æ®ä¸€è‡´æ€§çš„ä¿éšœ**
```
ä¸€è‡´æ€§åŸºç¡€ï¼š
- åŸºäºMySQLäº‹åŠ¡æ—¥å¿—binlog
- ä¿è¯äº‹ä»¶é¡ºåºä¸æ•°æ®åº“æ“ä½œé¡ºåºä¸€è‡´
- At-Least-Onceè¯­ä¹‰ï¼Œä¸ä¸¢æ•°æ®
- éœ€è¦åº”ç”¨ç«¯å¤„ç†å¹‚ç­‰æ€§
```

### 6.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ’¼ è§£å†³çš„æ ¸å¿ƒé—®é¢˜**
- **æ•°æ®åŒæ­¥å»¶è¿Ÿ**ï¼šä»å°æ—¶çº§é™ä½åˆ°æ¯«ç§’çº§
- **ç³»ç»Ÿè€¦åˆåº¦**ï¼šè§£è€¦æ•°æ®ç”Ÿäº§æ–¹å’Œæ¶ˆè´¹æ–¹
- **å¼€å‘å¤æ‚åº¦**ï¼šæ— éœ€ä¿®æ”¹ç°æœ‰ä¸šåŠ¡ä»£ç 
- **è¿ç»´æˆæœ¬**ï¼šé›†ä¸­åŒ–çš„æ•°æ®åŒæ­¥ç®¡ç†

**ğŸš€ æ”¯æ’‘çš„æŠ€æœ¯æ¶æ„**
- **å¾®æœåŠ¡æ¶æ„**ï¼šæœåŠ¡é—´é€šè¿‡äº‹ä»¶è§£è€¦
- **CQRSæ¨¡å¼**ï¼šå‘½ä»¤æŸ¥è¯¢èŒè´£åˆ†ç¦»
- **äº‹ä»¶æº¯æº**ï¼šåŸºäºäº‹ä»¶é‡å»ºç³»ç»ŸçŠ¶æ€
- **å®æ—¶è®¡ç®—**ï¼šæ”¯æ’‘æµè®¡ç®—å’Œå®æ—¶åˆ†æ

**ğŸ“ˆ ä¸šåŠ¡ä»·å€¼ä½“ç°**
- **ç”¨æˆ·ä½“éªŒ**ï¼šæ•°æ®å®æ—¶æ€§æå‡ç”¨æˆ·æ»¡æ„åº¦
- **è¿è¥æ•ˆç‡**ï¼šå®æ—¶æ•°æ®æ”¯æŒå¿«é€Ÿå†³ç­–
- **æŠ€æœ¯æ•ˆç‡**ï¼šå‡å°‘é‡å¤å¼€å‘ï¼Œæé«˜å¼€å‘æ•ˆç‡
- **ç³»ç»Ÿç¨³å®š**ï¼šé™ä½ç³»ç»Ÿå¤æ‚åº¦ï¼Œæé«˜ç¨³å®šæ€§

### 6.4 å­¦ä¹ è·¯å¾„å»ºè®®


**ğŸ¯ æ–°æ‰‹å­¦ä¹ é¡ºåº**
```
ç¬¬1æ­¥ï¼šç†è§£MySQL binlogæœºåˆ¶ (åŸºç¡€)
ç¬¬2æ­¥ï¼šæŒæ¡CanalåŸºæœ¬ä½¿ç”¨ (å…¥é—¨)  
ç¬¬3æ­¥ï¼šå­¦ä¹ Canalé…ç½®å’Œéƒ¨ç½² (å®è·µ)
ç¬¬4æ­¥ï¼šäº†è§£Canalé›†ç¾¤å’Œé«˜å¯ç”¨ (è¿›é˜¶)
ç¬¬5æ­¥ï¼šç»“åˆæ¶ˆæ¯é˜Ÿåˆ—å®ç°å®Œæ•´æ–¹æ¡ˆ (é«˜çº§)
```

**âš ï¸ å¸¸è§å­¦ä¹ è¯¯åŒº**
- **è¯¯åŒº1**ï¼šè®¤ä¸ºCanalä¼šå½±å“MySQLæ€§èƒ½
  - **å®é™…**ï¼šCanalåªè¯»å–binlogï¼Œå¯¹MySQLå½±å“å¾ˆå°
- **è¯¯åŒº2**ï¼šè®¤ä¸ºCanalèƒ½è§£å†³æ‰€æœ‰æ•°æ®åŒæ­¥é—®é¢˜  
  - **å®é™…**ï¼šè¿˜éœ€è¦è€ƒè™‘ç½‘ç»œã€æ¶ˆè´¹ç«¯å¤„ç†èƒ½åŠ›ç­‰
- **è¯¯åŒº3**ï¼šè®¤ä¸ºä½¿ç”¨Canalä¸éœ€è¦è€ƒè™‘æ•°æ®ä¸€è‡´æ€§
  - **å®é™…**ï¼šä»éœ€è¦åœ¨åº”ç”¨ç«¯åšå¥½å¹‚ç­‰å’Œå¼‚å¸¸å¤„ç†

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
```
Canalæ˜¯å®æ—¶æ•°æ®åŒæ­¥çš„åˆ©å™¨ï¼š
- ç›‘å¬MySQLå˜åŒ–ä¸ä¾µå…¥
- è§£æbinlogè½¬äº‹ä»¶æµ  
- æ”¯æ’‘å®æ—¶æ¶æ„å¥½å¸®æ‰‹
- ç¼“å­˜æœç´¢ä»“åº“éƒ½èƒ½ç”¨
```