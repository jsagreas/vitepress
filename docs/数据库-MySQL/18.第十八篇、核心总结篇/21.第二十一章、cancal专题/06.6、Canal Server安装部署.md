---
title: 6ã€Canal Serverå®‰è£…éƒ¨ç½²
---
## ğŸ“š ç›®å½•å¯¼èˆª

1. [Canal Serveræ¦‚è¿°](#1-canal-serveræ¦‚è¿°)
2. [ç¯å¢ƒå‡†å¤‡ä¸å‰ç½®æ¡ä»¶](#2-ç¯å¢ƒå‡†å¤‡ä¸å‰ç½®æ¡ä»¶)
3. [Canalä¸‹è½½ä¸è§£å‹](#3-canal-ä¸‹è½½ä¸è§£å‹)
4. [ç›®å½•ç»“æ„è¯¦è§£](#4-ç›®å½•ç»“æ„è¯¦è§£)
5. [æ ¸å¿ƒé…ç½®è¯¦è§£](#5-æ ¸å¿ƒé…ç½®è¯¦è§£)
6. [å¯åŠ¨ä¸è¿è¡Œç®¡ç†](#6-å¯åŠ¨ä¸è¿è¡Œç®¡ç†)
7. [éƒ¨ç½²éªŒè¯ä¸æµ‹è¯•](#7-éƒ¨ç½²éªŒè¯ä¸æµ‹è¯•)
8. [æ•…éšœæ’æŸ¥æŒ‡å—](#8-æ•…éšœæ’æŸ¥æŒ‡å—)
9. [ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–](#9-ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ Canal Serveræ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯Canal Server


**ğŸ”¸ ç®€å•ç†è§£**
Canal Serverå°±åƒæ˜¯ä¸€ä¸ª"æ•°æ®åº“ç›‘å¬å™¨"ï¼Œå®ƒä¸“é—¨ç›‘å¬MySQLæ•°æ®åº“çš„å˜åŒ–ï¼ŒæŠŠè¿™äº›å˜åŒ–å®æ—¶ä¼ é€’ç»™å…¶ä»–ç³»ç»Ÿã€‚

**ğŸ”¸ å·¥ä½œåŸç†**
```
MySQLæ•°æ®åº“ â”€â”€å˜åŒ–â”€â”€> Canal Server â”€â”€è§£æâ”€â”€> ä¸‹æ¸¸ç³»ç»Ÿ
    â”‚                    â”‚                  â”‚
 å¢åˆ æ”¹æ“ä½œ          å®æ—¶ç›‘å¬æ•è·         æ¶ˆæ¯é˜Ÿåˆ—/ESç­‰
```

**ğŸ”¸ æ ¸å¿ƒä½œç”¨**
- **ğŸ“Š æ•°æ®åŒæ­¥**: å®æ—¶åŒæ­¥MySQLæ•°æ®åˆ°å…¶ä»–ç³»ç»Ÿ
- **ğŸ”„ ç¼“å­˜æ›´æ–°**: æ•°æ®å˜åŒ–æ—¶è‡ªåŠ¨åˆ·æ–°Redisç¼“å­˜  
- **ğŸ“ˆ æ•°æ®åˆ†æ**: å°†æ•°æ®å®æ—¶æ¨é€åˆ°æ•°æ®ä»“åº“
- **ğŸ” æœç´¢å¼•æ“**: å®æ—¶æ›´æ–°Elasticsearchç´¢å¼•

### 1.2 ä¸ºä»€ä¹ˆé€‰æ‹©Canal


> ğŸ’¡ **æ ¸å¿ƒä¼˜åŠ¿**  
> Canalæœ€å¤§çš„ä¼˜åŠ¿æ˜¯"æ— ä¾µå…¥"ï¼Œä¸éœ€è¦ä¿®æ”¹ç°æœ‰ä¸šåŠ¡ä»£ç ï¼Œå°±èƒ½å®ç°æ•°æ®çš„å®æ—¶åŒæ­¥

**ğŸ”¸ æŠ€æœ¯ä¼˜åŠ¿å¯¹æ¯”**

| æ–¹æ¡ˆç±»å‹ | **å®ç°æ–¹å¼** | **æ€§èƒ½å½±å“** | **å¼€å‘æˆæœ¬** | **å®æ—¶æ€§** |
|---------|------------|------------|------------|----------|
| ğŸ”¸ **Canalæ–¹æ¡ˆ** | `åŸºäºbinlogç›‘å¬` | `å‡ ä¹æ— å½±å“` | `æä½` | `æ¯«ç§’çº§` |
| ğŸ”¸ **ä»£ç åŸ‹ç‚¹** | `ä¸šåŠ¡ä»£ç ä¿®æ”¹` | `æœ‰ä¸€å®šå½±å“` | `é«˜` | `å®æ—¶` |
| ğŸ”¸ **å®šæ—¶åŒæ­¥** | `å®šæ—¶ä»»åŠ¡æ‰«æ` | `æ•°æ®åº“å‹åŠ›å¤§` | `ä¸­ç­‰` | `åˆ†é’Ÿçº§` |
| ğŸ”¸ **è§¦å‘å™¨æ–¹æ¡ˆ** | `æ•°æ®åº“è§¦å‘å™¨` | `å½±å“è¾ƒå¤§` | `ä¸­ç­‰` | `å®æ—¶` |

---

## 2. ğŸ› ï¸ ç¯å¢ƒå‡†å¤‡ä¸å‰ç½®æ¡ä»¶


### 2.1 ç³»ç»Ÿç¯å¢ƒè¦æ±‚


**ğŸ”¸ æ“ä½œç³»ç»Ÿæ”¯æŒ**
```bash
# æ¨èæ“ä½œç³»ç»Ÿ
âœ… CentOS 7/8
âœ… Ubuntu 18.04+  
âœ… Red Hat Enterprise Linux 7+
âœ… Windows 10+ (å¼€å‘ç¯å¢ƒ)
```

**ğŸ”¸ ç¡¬ä»¶é…ç½®å»ºè®®**

| ç¯å¢ƒç±»å‹ | **CPU** | **å†…å­˜** | **ç£ç›˜** | **ç½‘ç»œ** |
|---------|---------|---------|---------|---------|
| ğŸ”° **å¼€å‘ç¯å¢ƒ** | `2æ ¸+` | `4GB+` | `20GB+` | `100Mbps+` |
| ğŸ”¸ **æµ‹è¯•ç¯å¢ƒ** | `4æ ¸+` | `8GB+` | `50GB+` | `1Gbps+` |
| â­ **ç”Ÿäº§ç¯å¢ƒ** | `8æ ¸+` | `16GB+` | `200GB+` | `10Gbps+` |

### 2.2 è½¯ä»¶ä¾èµ–æ£€æŸ¥


**ğŸ”¸ Javaç¯å¢ƒ**
```bash
# æ£€æŸ¥Javaç‰ˆæœ¬ (è¦æ±‚JDK 8+)
java -version

# å¦‚æœæ²¡æœ‰å®‰è£…Java
# CentOS/RHEL
yum install -y java-1.8.0-openjdk java-1.8.0-openjdk-devel

# Ubuntu/Debian  
apt-get install -y openjdk-8-jdk
```

**ğŸ”¸ MySQLç¯å¢ƒé…ç½®**
```sql
-- 1. å¼€å¯binlog (å¿…é¡»)
-- åœ¨my.cnfä¸­æ·»åŠ ä»¥ä¸‹é…ç½®
[mysqld]
log-bin=mysql-bin
binlog-format=ROW
server-id=1

-- 2. åˆ›å»ºCanalä¸“ç”¨è´¦å·
CREATE USER 'canal'@'%' IDENTIFIED BY 'canal123';
GRANT SELECT, REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO 'canal'@'%';
FLUSH PRIVILEGES;

-- 3. éªŒè¯binlogçŠ¶æ€
SHOW VARIABLES LIKE 'log_bin';
SHOW MASTER STATUS;
```

> âš ï¸ **é‡è¦æé†’**  
> MySQLå¿…é¡»å¼€å¯binlogä¸”æ ¼å¼ä¸ºROWï¼Œè¿™æ˜¯Canalå·¥ä½œçš„åŸºç¡€æ¡ä»¶

### 2.3 ç½‘ç»œç¯å¢ƒå‡†å¤‡


**ğŸ”¸ ç«¯å£è§„åˆ’**
```
11111  - Canal Serveré»˜è®¤ç«¯å£
3306   - MySQLæ•°æ®åº“ç«¯å£  
9090   - Canal Adminç®¡ç†ç«¯å£(å¯é€‰)
8080   - Canalç›‘æ§ç«¯å£(å¯é€‰)
```

**ğŸ”¸ é˜²ç«å¢™é…ç½®**
```bash
# CentOS 7 é˜²ç«å¢™è®¾ç½®
firewall-cmd --zone=public --add-port=11111/tcp --permanent
firewall-cmd --reload

# Ubuntu é˜²ç«å¢™è®¾ç½®  
ufw allow 11111/tcp
```

---

## 3. ğŸ“¦ Canalä¸‹è½½ä¸è§£å‹


### 3.1 ç‰ˆæœ¬é€‰æ‹©ç­–ç•¥


**ğŸ”¸ ç‰ˆæœ¬å…¼å®¹æ€§è¯´æ˜**

| Canalç‰ˆæœ¬ | **MySQLç‰ˆæœ¬** | **Javaç‰ˆæœ¬** | **ç¨³å®šæ€§** | **æ¨èåº¦** |
|----------|-------------|-------------|-----------|----------|
| `1.1.6` | `5.7-8.0` | `JDK 8+` | `ğŸŸ¢ ç¨³å®š` | `â­â­â­â­â­` |
| `1.1.5` | `5.6-8.0` | `JDK 8+` | `ğŸŸ¢ ç¨³å®š` | `â­â­â­â­` |
| `1.1.4` | `5.6-7.x` | `JDK 8+` | `ğŸŸ¡ ä¸€èˆ¬` | `â­â­â­` |

> ğŸ’¡ **ç‰ˆæœ¬é€‰æ‹©å»ºè®®**  
> ç”Ÿäº§ç¯å¢ƒæ¨èä½¿ç”¨1.1.6ç‰ˆæœ¬ï¼Œè¿™æ˜¯ç›®å‰æœ€ç¨³å®šä¸”åŠŸèƒ½æœ€å®Œå–„çš„ç‰ˆæœ¬

### 3.2 ä¸‹è½½æ–¹å¼è¯¦è§£


**ğŸ”¸ å®˜æ–¹ä¸‹è½½(æ¨è)**
```bash
# åˆ›å»ºå·¥ä½œç›®å½•
mkdir -p /opt/canal
cd /opt/canal

# ä¸‹è½½Canalæœ€æ–°ç¨³å®šç‰ˆ
wget https://github.com/alibaba/canal/releases/download/canal-1.1.6/canal.deployer-1.1.6.tar.gz

# ä¸‹è½½Canal Adapter(å¦‚éœ€è¦)
wget https://github.com/alibaba/canal/releases/download/canal-1.1.6/canal.adapter-1.1.6.tar.gz
```

**ğŸ”¸ å¤‡ç”¨ä¸‹è½½æº**
```bash
# å¦‚æœGitHubè®¿é—®æ…¢ï¼Œå¯ä½¿ç”¨é•œåƒæº
wget https://gitee.com/mirrors/canal/releases/download/canal-1.1.6/canal.deployer-1.1.6.tar.gz
```

**ğŸ”¸ æ–‡ä»¶å®Œæ•´æ€§æ ¡éªŒ**
```bash
# æ£€æŸ¥æ–‡ä»¶å¤§å°å’ŒMD5(å¯é€‰)
ls -lh canal.deployer-1.1.6.tar.gz
md5sum canal.deployer-1.1.6.tar.gz
```

### 3.3 è§£å‹ä¸ç›®å½•åˆ›å»º


**ğŸ”¸ è§£å‹æ­¥éª¤**
```bash
# è§£å‹åˆ°æŒ‡å®šç›®å½•
tar -zxvf canal.deployer-1.1.6.tar.gz

# æŸ¥çœ‹è§£å‹ç»“æœ
ls -la
```

**ğŸ”¸ ç›®å½•æƒé™è®¾ç½®**
```bash
# åˆ›å»ºcanalç”¨æˆ·(æ¨è)
useradd -r -s /bin/false canal

# è®¾ç½®ç›®å½•æƒé™
chown -R canal:canal /opt/canal
chmod -R 755 /opt/canal
```

---

## 4. ğŸ“ ç›®å½•ç»“æ„è¯¦è§£


### 4.1 æ•´ä½“ç›®å½•æ¶æ„


```
/opt/canal/
â”œâ”€â”€ bin/                    â† å¯åŠ¨è„šæœ¬ç›®å½•
â”‚   â”œâ”€â”€ startup.sh         â† Linuxå¯åŠ¨è„šæœ¬  
â”‚   â”œâ”€â”€ stop.sh           â† åœæ­¢è„šæœ¬
â”‚   â””â”€â”€ restart.sh        â† é‡å¯è„šæœ¬
â”œâ”€â”€ conf/                  â† é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ canal.properties  â† ä¸»é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ example/          â† ç¤ºä¾‹å®ä¾‹é…ç½®
â”‚   â””â”€â”€ logback.xml       â† æ—¥å¿—é…ç½®
â”œâ”€â”€ lib/                   â† ä¾èµ–jaråŒ…ç›®å½•
â”œâ”€â”€ logs/                  â† æ—¥å¿—æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ canal/            â† canalä¸»æ—¥å¿—
â”‚   â””â”€â”€ example/          â† å®ä¾‹æ—¥å¿—
â””â”€â”€ plugin/               â† æ’ä»¶ç›®å½•
```

### 4.2 æ ¸å¿ƒç›®å½•åŠŸèƒ½è¯´æ˜


**ğŸ”¸ binç›®å½• - æ‰§è¡Œè„šæœ¬**
```bash
bin/
â”œâ”€â”€ startup.sh     # å¯åŠ¨Canal Server
â”œâ”€â”€ stop.sh        # åœæ­¢Canal Server  
â”œâ”€â”€ restart.sh     # é‡å¯Canal Server
â””â”€â”€ startup.bat    # Windowså¯åŠ¨è„šæœ¬
```

**ğŸ”¸ confç›®å½• - é…ç½®ç®¡ç†**
```bash
conf/
â”œâ”€â”€ canal.properties        # Canal Serverå…¨å±€é…ç½®
â”œâ”€â”€ example/               # é»˜è®¤å®ä¾‹é…ç½®ç›®å½•
â”‚   â””â”€â”€ instance.properties # å®ä¾‹é…ç½®æ–‡ä»¶
â”œâ”€â”€ logback.xml            # æ—¥å¿—æ¡†æ¶é…ç½®
â””â”€â”€ spring/                # Springé…ç½®æ–‡ä»¶
```

**ğŸ”¸ logsç›®å½• - æ—¥å¿—ç®¡ç†**
```bash
logs/
â”œâ”€â”€ canal/
â”‚   â”œâ”€â”€ canal.log         # Canalä¸»æœåŠ¡æ—¥å¿—
â”‚   â””â”€â”€ canal_stdout.log  # æ§åˆ¶å°è¾“å‡ºæ—¥å¿—
â””â”€â”€ example/              # å®ä¾‹æ—¥å¿—ç›®å½•
    â”œâ”€â”€ example.log       # å®ä¾‹è¿è¡Œæ—¥å¿—
    â””â”€â”€ meta.log          # å…ƒæ•°æ®æ—¥å¿—
```

### 4.3 å…³é”®æ–‡ä»¶ä½œç”¨è§£æ


> ğŸ“‹ **æ–‡ä»¶åŠŸèƒ½ä¸€è§ˆè¡¨**

| æ–‡ä»¶è·¯å¾„ | **åŠŸèƒ½æè¿°** | **é‡è¦ç¨‹åº¦** | **æ˜¯å¦å¿…éœ€** |
|---------|------------|------------|------------|
| `canal.properties` | `Canal Serverå…¨å±€é…ç½®` | `ğŸ”´ æé«˜` | `âœ… å¿…éœ€` |
| `instance.properties` | `æ•°æ®æºå®ä¾‹é…ç½®` | `ğŸ”´ æé«˜` | `âœ… å¿…éœ€` |
| `logback.xml` | `æ—¥å¿—è¾“å‡ºé…ç½®` | `ğŸŸ¡ ä¸­ç­‰` | `ğŸ“ å»ºè®®é…ç½®` |
| `startup.sh` | `æœåŠ¡å¯åŠ¨è„šæœ¬` | `ğŸŸ¢ é«˜` | `âœ… å¿…éœ€` |

---

## 5. âš™ï¸ æ ¸å¿ƒé…ç½®è¯¦è§£


### 5.1 Canal Serverä¸»é…ç½®


**ğŸ”¸ canal.propertiesæ ¸å¿ƒé…ç½®**
```properties
# ===========================================
# Canal Server åŸºç¡€é…ç½®
# ===========================================

# æœåŠ¡ç«¯å£é…ç½® (å®¢æˆ·ç«¯è¿æ¥ç«¯å£)
canal.port = 11111

# æ•°æ®ç›®å½•é…ç½® (å­˜å‚¨ä½ç½®ä¿¡æ¯)
canal.file.data.dir = ${canal.conf.dir}
canal.file.flush.period = 1000

# ===========================================
# ç½‘ç»œç›¸å…³é…ç½®  
# ===========================================

# ç½‘ç»œæ¥æ”¶ç¼“å†²åŒºå¤§å°
canal.instance.network.receiveBufferSize = 16384
# ç½‘ç»œå‘é€ç¼“å†²åŒºå¤§å°  
canal.instance.network.sendBufferSize = 16384
# ç½‘ç»œè¶…æ—¶æ—¶é—´
canal.instance.network.soTimeout = 30

# ===========================================
# å®ä¾‹ç®¡ç†é…ç½®
# ===========================================

# é»˜è®¤å¯åŠ¨çš„å®ä¾‹åç§° (å¤šä¸ªç”¨é€—å·åˆ†éš”)
canal.destinations = example
# è‡ªåŠ¨æ‰«æå®ä¾‹é…ç½®å˜æ›´
canal.auto.scan = true
canal.auto.scan.interval = 5

# ===========================================  
# ç›‘æ§ä¸ç®¡ç†é…ç½®
# ===========================================

# æ˜¯å¦å¼€å¯ç›‘æ§
canal.admin.manager = 
# ç›‘æ§ç«¯å£
canal.admin.port = 11110
```

> ğŸ’¡ **é…ç½®è¯´æ˜**  
> è¿™ä¸ªé…ç½®æ–‡ä»¶æ§åˆ¶Canal Serverçš„å…¨å±€è¡Œä¸ºï¼Œç±»ä¼¼äº"æ€»æ§åˆ¶å°"

### 5.2 å®ä¾‹é…ç½®è¯¦è§£


**ğŸ”¸ instance.propertiesè¯¦ç»†é…ç½®**
```properties
# ===========================================
# MySQLè¿æ¥é…ç½® (æœ€é‡è¦éƒ¨åˆ†)
# ===========================================

# MySQLæœåŠ¡å™¨åœ°å€å’Œç«¯å£
canal.instance.master.address=127.0.0.1:3306

# æ•°æ®åº“è¿æ¥è´¦å·å¯†ç 
canal.instance.dbUsername=canal
canal.instance.dbPassword=canal123

# å­—ç¬¦é›†è®¾ç½®
canal.instance.connectionCharset = UTF-8

# ===========================================
# binlogç›¸å…³é…ç½®
# ===========================================

# binlogæ–‡ä»¶åå’Œä½ç½® (ç©ºè¡¨ç¤ºä»å½“å‰ä½ç½®å¼€å§‹)
canal.instance.master.journal.name=
canal.instance.master.position=

# binlogæ—¶é—´æˆ³ (ç©ºè¡¨ç¤ºä»å½“å‰æ—¶é—´å¼€å§‹)  
canal.instance.master.timestamp=

# ===========================================
# è¿‡æ»¤å™¨é…ç½® (æ§åˆ¶ç›‘å¬å“ªäº›è¡¨)
# ===========================================

# æ•°æ®åº“å’Œè¡¨è¿‡æ»¤è§„åˆ™
# .*\\..*  è¡¨ç¤ºç›‘å¬æ‰€æœ‰åº“æ‰€æœ‰è¡¨
# test\\.user è¡¨ç¤ºåªç›‘å¬teståº“çš„userè¡¨  
# test\\..*  è¡¨ç¤ºç›‘å¬teståº“çš„æ‰€æœ‰è¡¨
canal.instance.filter.regex=.*\\..*

# é»‘åå•è¿‡æ»¤ (ä¸ç›‘å¬çš„è¡¨)
canal.instance.filter.black.regex=mysql\\.slave_.*

# ===========================================
# è§£æç›¸å…³é…ç½®
# ===========================================

# æ˜¯å¦è§£æDDLè¯­å¥
canal.instance.parser.parallel=true
canal.instance.parser.parallelBufferSize=256

# è§£æè¶…æ—¶æ—¶é—´
canal.instance.parser.parallelThreadSize=60
```

> âš ï¸ **é…ç½®é‡ç‚¹**  
> filter.regexæ˜¯æ ¸å¿ƒé…ç½®ï¼Œå®ƒå†³å®šCanalç›‘å¬å“ªäº›æ•°æ®åº“è¡¨çš„å˜åŒ–

### 5.3 æ—¥å¿—é…ç½®ä¼˜åŒ–


**ğŸ”¸ logback.xmlæ—¥å¿—é…ç½®**
```xml
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <!-- æ§åˆ¶å°è¾“å‡ºé…ç½® -->
    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>
    
    <!-- æ–‡ä»¶è¾“å‡ºé…ç½® -->
    <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <file>${canal.conf.dir}/../logs/canal/canal.log</file>
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <!-- æŒ‰å¤©æ»šåŠ¨ -->
            <fileNamePattern>${canal.conf.dir}/../logs/canal/canal.%d{yyyy-MM-dd}.log</fileNamePattern>
            <!-- ä¿ç•™30å¤© -->
            <maxHistory>30</maxHistory>
        </rollingPolicy>
        <encoder>
            <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>
    
    <!-- æ—¥å¿—çº§åˆ«è®¾ç½® -->
    <root level="INFO">
        <appender-ref ref="STDOUT" />
        <appender-ref ref="FILE" />
    </root>
    
    <!-- Canalç›¸å…³æ—¥å¿—å•ç‹¬é…ç½® -->
    <logger name="com.alibaba.otter.canal" level="INFO"/>
    <logger name="com.alibaba.otter.canal.parse" level="WARN"/>
</configuration>
```

### 5.4 JVMå‚æ•°è°ƒä¼˜


**ğŸ”¸ startup.shè„šæœ¬JVMé…ç½®**
```bash
#!/bin/bash
# Canal Serverå¯åŠ¨è„šæœ¬

# ===========================================
# JVMå†…å­˜é…ç½®
# ===========================================
# å †å†…å­˜å¤§å° (æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´)
JAVA_OPTS="-Xms2g -Xmx4g"

# æ–°ç”Ÿä»£å†…å­˜é…ç½®
JAVA_OPTS="$JAVA_OPTS -Xmn1g"

# ===========================================  
# GCåƒåœ¾å›æ”¶é…ç½®
# ===========================================
# ä½¿ç”¨G1åƒåœ¾å›æ”¶å™¨ (æ¨è)
JAVA_OPTS="$JAVA_OPTS -XX:+UseG1GC"
JAVA_OPTS="$JAVA_OPTS -XX:MaxGCPauseMillis=200"

# GCæ—¥å¿—é…ç½®
JAVA_OPTS="$JAVA_OPTS -XX:+PrintGCDetails"
JAVA_OPTS="$JAVA_OPTS -XX:+PrintGCTimeStamps"  
JAVA_OPTS="$JAVA_OPTS -Xloggc:../logs/canal/gc.log"

# ===========================================
# å…¶ä»–JVMå‚æ•°
# ===========================================
# è®¾ç½®æ—¶åŒº
JAVA_OPTS="$JAVA_OPTS -Duser.timezone=Asia/Shanghai"

# æ–‡ä»¶ç¼–ç 
JAVA_OPTS="$JAVA_OPTS -Dfile.encoding=UTF-8"

# å¯åŠ¨Canal
java $JAVA_OPTS -cp .:../lib/* com.alibaba.otter.canal.deployer.CanalLauncher
```

---

## 6. ğŸš€ å¯åŠ¨ä¸è¿è¡Œç®¡ç†


### 6.1 å¯åŠ¨è„šæœ¬è¯¦è§£


**ğŸ”¸ Linuxç¯å¢ƒå¯åŠ¨**
```bash
# è¿›å…¥Canalç›®å½•
cd /opt/canal

# æ–¹å¼1: å‰å°å¯åŠ¨ (è°ƒè¯•ç”¨)
sh bin/startup.sh

# æ–¹å¼2: åå°å¯åŠ¨ (ç”Ÿäº§ç¯å¢ƒæ¨è)
nohup sh bin/startup.sh > /dev/null 2>&1 &

# æ–¹å¼3: ä½¿ç”¨systemdç®¡ç† (æœ€æ¨è)
systemctl start canal
```

**ğŸ”¸ Windowsç¯å¢ƒå¯åŠ¨**
```cmd
# è¿›å…¥Canalç›®å½•
cd C:\canal

# å¯åŠ¨Canal
bin\startup.bat
```

### 6.2 è¿›ç¨‹ç®¡ç†æ–¹æ³•


**ğŸ”¸ æŸ¥çœ‹Canalè¿›ç¨‹çŠ¶æ€**
```bash
# æ–¹å¼1: é€šè¿‡è¿›ç¨‹åæŸ¥æ‰¾
ps -ef | grep canal

# æ–¹å¼2: é€šè¿‡ç«¯å£æŸ¥æ‰¾  
netstat -tlnp | grep 11111

# æ–¹å¼3: æŸ¥çœ‹è¿›ç¨‹è¯¦ç»†ä¿¡æ¯
jps -l | grep canal
```

**ğŸ”¸ åœæ­¢CanalæœåŠ¡**
```bash
# æ–¹å¼1: ä½¿ç”¨åœæ­¢è„šæœ¬
sh bin/stop.sh

# æ–¹å¼2: ç›´æ¥ç»ˆæ­¢è¿›ç¨‹
kill -15 `ps -ef | grep canal | grep -v grep | awk '{print $2}'`

# æ–¹å¼3: å¼ºåˆ¶ç»ˆæ­¢ (ä¸æ¨è)
kill -9 `ps -ef | grep canal | grep -v grep | awk '{print $2}'`
```

**ğŸ”¸ é‡å¯CanalæœåŠ¡**
```bash
# ä½¿ç”¨é‡å¯è„šæœ¬
sh bin/restart.sh

# æ‰‹åŠ¨é‡å¯
sh bin/stop.sh
sleep 3
sh bin/startup.sh
```

### 6.3 è‡ªåŠ¨å¯åŠ¨é…ç½®


**ğŸ”¸ systemdæœåŠ¡é…ç½®**
```bash
# åˆ›å»ºsystemdæœåŠ¡æ–‡ä»¶
cat > /etc/systemd/system/canal.service << EOF
[Unit]
Description=Canal Server
After=network.target

[Service]
Type=forking
User=canal
Group=canal
WorkingDirectory=/opt/canal
ExecStart=/opt/canal/bin/startup.sh
ExecStop=/opt/canal/bin/stop.sh
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
EOF

# é‡è½½systemdé…ç½®
systemctl daemon-reload

# å¯ç”¨è‡ªåŠ¨å¯åŠ¨
systemctl enable canal

# å¯åŠ¨æœåŠ¡
systemctl start canal

# æŸ¥çœ‹çŠ¶æ€
systemctl status canal
```

### 6.4 å¯åŠ¨çŠ¶æ€ç›‘æ§


**ğŸ”¸ å¯åŠ¨æ—¥å¿—æ£€æŸ¥**
```bash
# å®æ—¶æŸ¥çœ‹å¯åŠ¨æ—¥å¿—
tail -f logs/canal/canal.log

# æŸ¥çœ‹æœ€è¿‘çš„å¯åŠ¨ä¿¡æ¯
tail -n 100 logs/canal/canal.log | grep "start"

# æ£€æŸ¥é”™è¯¯æ—¥å¿—
grep -i "error\|exception" logs/canal/canal.log
```

**ğŸ”¸ ç«¯å£ç›‘å¬æ£€æŸ¥**
```bash
# æ£€æŸ¥Canalç«¯å£æ˜¯å¦æ­£å¸¸ç›‘å¬
netstat -tlnp | grep 11111

# ä½¿ç”¨telnetæµ‹è¯•è¿æ¥
telnet localhost 11111
```

---

## 7. âœ… éƒ¨ç½²éªŒè¯ä¸æµ‹è¯•


### 7.1 åŸºç¡€è¿é€šæ€§æµ‹è¯•


**ğŸ”¸ æœåŠ¡å¯åŠ¨éªŒè¯**
```bash
# 1. æ£€æŸ¥è¿›ç¨‹æ˜¯å¦å­˜åœ¨
ps -ef | grep canal | grep -v grep

# 2. æ£€æŸ¥ç«¯å£æ˜¯å¦ç›‘å¬
ss -tlnp | grep 11111

# 3. æ£€æŸ¥æ—¥å¿—æ˜¯å¦æ­£å¸¸
tail -f logs/canal/canal.log
```

**ğŸ”¸ é¢„æœŸçš„æ­£å¸¸æ—¥å¿—è¾“å‡º**
```
2024-09-11 15:30:00.123 [main] INFO  c.a.o.canal.deployer.CanalLauncher - ### start the canal server.
2024-09-11 15:30:01.456 [main] INFO  c.a.o.canal.deployer.CanalController - ### start the canal server[11111]
2024-09-11 15:30:02.789 [main] INFO  c.a.o.canal.instance.manager.CanalInstanceWithManager - start CannalInstance for example
```

### 7.2 MySQLè¿æ¥æµ‹è¯•


**ğŸ”¸ æ•°æ®åº“è¿æ¥éªŒè¯**
```bash
# åœ¨MySQLä¸­æ‰§è¡Œæµ‹è¯•
mysql -u canal -p canal123 -h 127.0.0.1 -e "SHOW MASTER STATUS;"

# æ£€æŸ¥Canalæ˜¯å¦èƒ½è¿æ¥åˆ°MySQL
grep "connected to MySQL" logs/example/example.log
```

**ğŸ”¸ binlogè§£ææµ‹è¯•**
```sql
-- åœ¨ç›‘å¬çš„æ•°æ®åº“ä¸­åˆ›å»ºæµ‹è¯•è¡¨
CREATE DATABASE IF NOT EXISTS test;
USE test;

CREATE TABLE canal_test (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50),
    create_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- æ’å…¥æµ‹è¯•æ•°æ®
INSERT INTO canal_test (name) VALUES ('test1');
INSERT INTO canal_test (name) VALUES ('test2');

-- æ›´æ–°æµ‹è¯•
UPDATE canal_test SET name = 'updated_test1' WHERE id = 1;

-- åˆ é™¤æµ‹è¯•  
DELETE FROM canal_test WHERE id = 2;
```

**ğŸ”¸ æŸ¥çœ‹Canalè§£ææ—¥å¿—**
```bash
# æŸ¥çœ‹å®ä¾‹æ—¥å¿—ä¸­çš„è§£æè®°å½•
tail -f logs/example/example.log

# åº”è¯¥èƒ½çœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„æ—¥å¿—
# 2024-09-11 15:35:00.123 [pool-1-thread-1] INFO c.a.o.canal.parse.inbound.mysql.MysqlEventParser - receive change event...
```

### 7.3 å®¢æˆ·ç«¯è¿æ¥æµ‹è¯•


**ğŸ”¸ ä½¿ç”¨Canal Javaå®¢æˆ·ç«¯æµ‹è¯•**
```java
// ç®€å•çš„Javaå®¢æˆ·ç«¯æµ‹è¯•ä»£ç 
public class CanalClientTest {
    public static void main(String[] args) {
        // åˆ›å»ºè¿æ¥
        CanalConnector connector = CanalConnectors.newSingleConnector(
            new InetSocketAddress("127.0.0.1", 11111), 
            "example", "", ""
        );
        
        try {
            // è¿æ¥Canal
            connector.connect();
            // è®¢é˜…æ•°æ®åº“è¡¨
            connector.subscribe(".*\\..*");
            // å›æ»šåˆ°æœªè¿›è¡Œackçš„åœ°æ–¹
            connector.rollback();
            
            System.out.println("Canalè¿æ¥æˆåŠŸ!");
            
        } catch (Exception e) {
            System.out.println("Canalè¿æ¥å¤±è´¥: " + e.getMessage());
        } finally {
            connector.disconnect();
        }
    }
}
```

### 7.4 æ€§èƒ½åŸºå‡†æµ‹è¯•


**ğŸ”¸ ç®€å•æ€§èƒ½æµ‹è¯•**
```bash
# åˆ›å»ºæ€§èƒ½æµ‹è¯•è„šæœ¬
cat > test_performance.sh << 'EOF'
#!/bin/bash

echo "å¼€å§‹Canalæ€§èƒ½æµ‹è¯•..."

# æ‰¹é‡æ’å…¥æµ‹è¯•æ•°æ®
mysql -u root -p -e "
USE test;
DROP PROCEDURE IF EXISTS batch_insert;
DELIMITER //
CREATE PROCEDURE batch_insert()
BEGIN
    DECLARE i INT DEFAULT 1;
    WHILE i <= 10000 DO
        INSERT INTO canal_test (name) VALUES (CONCAT('test_', i));
        SET i = i + 1;
    END WHILE;
END //
DELIMITER ;
CALL batch_insert();
"

echo "æ€§èƒ½æµ‹è¯•å®Œæˆï¼Œè¯·æ£€æŸ¥Canalæ—¥å¿—å¤„ç†æƒ…å†µ"
EOF

# æ‰§è¡Œæ€§èƒ½æµ‹è¯•
chmod +x test_performance.sh
./test_performance.sh
```

---

## 8. ğŸ”§ æ•…éšœæ’æŸ¥æŒ‡å—


### 8.1 å¸¸è§å¯åŠ¨é—®é¢˜


**ğŸ”¸ é—®é¢˜1: Javaç¯å¢ƒé—®é¢˜**
```bash
# é”™è¯¯ç°è±¡
-bash: java: command not found

# è§£å†³æ–¹æ¡ˆ
# 1. æ£€æŸ¥Javaæ˜¯å¦å®‰è£…
which java

# 2. æ£€æŸ¥JAVA_HOMEç¯å¢ƒå˜é‡
echo $JAVA_HOME

# 3. è®¾ç½®Javaç¯å¢ƒå˜é‡
export JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk
export PATH=$PATH:$JAVA_HOME/bin
```

**ğŸ”¸ é—®é¢˜2: ç«¯å£è¢«å ç”¨**
```bash
# é”™è¯¯æ—¥å¿—
java.net.BindException: Address already in use

# æ’æŸ¥æ­¥éª¤
# 1. æŸ¥çœ‹ç«¯å£å ç”¨æƒ…å†µ
netstat -tlnp | grep 11111

# 2. ç»ˆæ­¢å ç”¨è¿›ç¨‹
kill -9 è¿›ç¨‹ID

# 3. æˆ–è€…ä¿®æ”¹Canalç«¯å£é…ç½®
vim conf/canal.properties
# canal.port = 11112
```

**ğŸ”¸ é—®é¢˜3: æƒé™é—®é¢˜**
```bash
# é”™è¯¯ç°è±¡
Permission denied

# è§£å†³æ–¹æ¡ˆ
# 1. æ£€æŸ¥æ–‡ä»¶æƒé™
ls -la bin/startup.sh

# 2. æ·»åŠ æ‰§è¡Œæƒé™
chmod +x bin/startup.sh

# 3. æ£€æŸ¥ç›®å½•æ‰€æœ‰è€…
chown -R canal:canal /opt/canal
```

### 8.2 MySQLè¿æ¥é—®é¢˜


**ğŸ”¸ è¿æ¥å¤±è´¥æ’æŸ¥æµç¨‹**
```
Canalæ— æ³•è¿æ¥MySQL
         â”‚
         â–¼
    æ£€æŸ¥ç½‘ç»œè¿é€šæ€§ â”€â”€â”€ ping MySQLæœåŠ¡å™¨IP
         â”‚
         â–¼  
    æ£€æŸ¥MySQLæœåŠ¡ â”€â”€â”€ systemctl status mysqld
         â”‚
         â–¼
    æ£€æŸ¥ç”¨æˆ·æƒé™ â”€â”€â”€ éªŒè¯canalç”¨æˆ·æƒé™
         â”‚
         â–¼
    æ£€æŸ¥binlogé…ç½® â”€â”€â”€ SHOW VARIABLES LIKE 'log_bin'
```

**ğŸ”¸ å…·ä½“æ’æŸ¥å‘½ä»¤**
```bash
# 1. ç½‘ç»œè¿é€šæ€§æµ‹è¯•
ping 192.168.1.100
telnet 192.168.1.100 3306

# 2. MySQLç”¨æˆ·éªŒè¯
mysql -u canal -p canal123 -h 192.168.1.100 -e "SELECT 1"

# 3. binlogçŠ¶æ€æ£€æŸ¥
mysql -u root -p -e "
SHOW VARIABLES LIKE 'log_bin';
SHOW VARIABLES LIKE 'binlog_format';  
SHOW MASTER STATUS;
"

# 4. ç”¨æˆ·æƒé™æ£€æŸ¥
mysql -u root -p -e "
SELECT user,host FROM mysql.user WHERE user='canal';
SHOW GRANTS FOR 'canal'@'%';
"
```

### 8.3 æ€§èƒ½é—®é¢˜è¯Šæ–­


**ğŸ”¸ å†…å­˜ä½¿ç”¨é—®é¢˜**
```bash
# æŸ¥çœ‹Canalè¿›ç¨‹å†…å­˜ä½¿ç”¨
ps aux | grep canal

# æŸ¥çœ‹JVMå†…å­˜ä½¿ç”¨æƒ…å†µ
jstat -gc `pgrep -f canal` 1s 5

# åˆ†æGCæ—¥å¿—
tail -f logs/canal/gc.log
```

**ğŸ”¸ ç½‘ç»œå»¶è¿Ÿé—®é¢˜**
```bash
# æ£€æŸ¥Canalåˆ°MySQLçš„ç½‘ç»œå»¶è¿Ÿ
ping -c 10 mysql_server_ip

# æ£€æŸ¥MySQLè¿æ¥æ•°
mysql -u root -p -e "SHOW STATUS LIKE 'Threads_connected'"

# æ£€æŸ¥Canalå¤„ç†å»¶è¿Ÿ
grep "delay" logs/example/example.log
```

### 8.4 æ—¥å¿—åˆ†ææŠ€å·§


**ğŸ”¸ å…³é”®æ—¥å¿—å…³é”®å­—**
```bash
# å¯åŠ¨ç›¸å…³
grep -i "start\|startup" logs/canal/canal.log

# é”™è¯¯ç›¸å…³  
grep -i "error\|exception\|failed" logs/canal/canal.log

# è¿æ¥ç›¸å…³
grep -i "connect\|disconnect" logs/example/example.log

# æ€§èƒ½ç›¸å…³
grep -i "delay\|slow\|timeout" logs/example/example.log
```

**ğŸ”¸ æ—¥å¿—çº§åˆ«è°ƒæ•´**
```xml
<!-- ä¸´æ—¶è°ƒæ•´æ—¥å¿—çº§åˆ«è¿›è¡Œé—®é¢˜æ’æŸ¥ -->
<logger name="com.alibaba.otter.canal" level="DEBUG"/>
<logger name="com.alibaba.otter.canal.parse" level="DEBUG"/>
```

---

## 9. ğŸ† ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–


### 9.1 é«˜å¯ç”¨éƒ¨ç½²æ¶æ„


**ğŸ”¸ Canal HAæ¶æ„å›¾**
```
       è´Ÿè½½å‡è¡¡å™¨
           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”
    â”‚      â”‚      â”‚
Canal-1  Canal-2  Canal-3
    â”‚      â”‚      â”‚
    â””â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”˜
           â”‚
       MySQLä¸»åº“
      /         \
   MySQLä»åº“1  MySQLä»åº“2
```

**ğŸ”¸ HAé…ç½®è¦ç‚¹**
```properties
# canal.propertiesä¸­é…ç½®ZooKeeper
canal.zkServers = zk1:2181,zk2:2181,zk3:2181

# å¼€å¯HAæ¨¡å¼
canal.instance.global.mode = manager
canal.instance.global.lazy = false

# é…ç½®Canalé›†ç¾¤
canal.instance.global.manager.address = manager1:1099,manager2:1099
```

### 9.2 æ€§èƒ½è°ƒä¼˜ç­–ç•¥


**ğŸ”¸ JVMæ€§èƒ½è°ƒä¼˜**
```bash
# ç”Ÿäº§ç¯å¢ƒJVMå‚æ•°ä¼˜åŒ–
JAVA_OPTS="-server"
JAVA_OPTS="$JAVA_OPTS -Xms8g -Xmx8g"           # å †å†…å­˜8G
JAVA_OPTS="$JAVA_OPTS -Xmn3g"                  # æ–°ç”Ÿä»£3G  
JAVA_OPTS="$JAVA_OPTS -XX:+UseG1GC"            # ä½¿ç”¨G1æ”¶é›†å™¨
JAVA_OPTS="$JAVA_OPTS -XX:MaxGCPauseMillis=200" # GCæš‚åœæ—¶é—´æ§åˆ¶
JAVA_OPTS="$JAVA_OPTS -XX:+DisableExplicitGC"   # ç¦ç”¨æ˜¾å¼GC
JAVA_OPTS="$JAVA_OPTS -XX:+HeapDumpOnOutOfMemoryError" # OOMæ—¶dump
```

**ğŸ”¸ Canalå‚æ•°è°ƒä¼˜**
```properties
# è§£ææ€§èƒ½ä¼˜åŒ–
canal.instance.parser.parallel=true
canal.instance.parser.parallelBufferSize=512
canal.instance.parser.parallelThreadSize=16

# ç½‘ç»œæ€§èƒ½ä¼˜åŒ–  
canal.instance.network.receiveBufferSize=65536
canal.instance.network.sendBufferSize=65536
canal.instance.network.soTimeout=60

# æ‰¹å¤„ç†ä¼˜åŒ–
canal.instance.memory.buffer.size=32768
canal.instance.memory.buffer.memunit=1024
```

### 9.3 ç›‘æ§å‘Šè­¦ä½“ç³»


**ğŸ”¸ å…³é”®ç›‘æ§æŒ‡æ ‡**

| ç›‘æ§é¡¹ç›® | **æ­£å¸¸èŒƒå›´** | **å‘Šè­¦é˜ˆå€¼** | **ç›‘æ§æ–¹å¼** |
|---------|------------|------------|------------|
| **CPUä½¿ç”¨ç‡** | `< 70%` | `> 80%` | `ç³»ç»Ÿç›‘æ§` |
| **å†…å­˜ä½¿ç”¨ç‡** | `< 80%` | `> 90%` | `JVMç›‘æ§` |
| **è§£æå»¶è¿Ÿ** | `< 100ms` | `> 1000ms` | `Canalæ—¥å¿—` |
| **è¿æ¥çŠ¶æ€** | `Connected` | `Disconnected` | `å¥åº·æ£€æŸ¥` |

**ğŸ”¸ ç›‘æ§è„šæœ¬ç¤ºä¾‹**
```bash
#!/bin/bash
# Canalå¥åº·æ£€æŸ¥è„šæœ¬

# æ£€æŸ¥è¿›ç¨‹æ˜¯å¦å­˜åœ¨
if ! pgrep -f canal > /dev/null; then
    echo "CRITICAL: Canalè¿›ç¨‹ä¸å­˜åœ¨"
    exit 2
fi

# æ£€æŸ¥ç«¯å£æ˜¯å¦ç›‘å¬
if ! netstat -tlnp | grep -q 11111; then
    echo "CRITICAL: Canalç«¯å£æœªç›‘å¬"
    exit 2  
fi

# æ£€æŸ¥æœ€è¿‘5åˆ†é’Ÿæ˜¯å¦æœ‰ERRORæ—¥å¿—
error_count=$(grep -c "ERROR" logs/canal/canal.log | tail -n 5)
if [ $error_count -gt 10 ]; then
    echo "WARNING: é”™è¯¯æ—¥å¿—è¿‡å¤š"
    exit 1
fi

echo "OK: Canalè¿è¡Œæ­£å¸¸"
exit 0
```

### 9.4 å¤‡ä»½ä¸æ¢å¤ç­–ç•¥


**ğŸ”¸ é…ç½®å¤‡ä»½**
```bash
#!/bin/bash
# Canalé…ç½®å¤‡ä»½è„šæœ¬

backup_dir="/backup/canal/$(date +%Y%m%d)"
mkdir -p $backup_dir

# å¤‡ä»½é…ç½®æ–‡ä»¶
cp -r /opt/canal/conf $backup_dir/
cp -r /opt/canal/bin $backup_dir/

# å¤‡ä»½ä½ç½®ä¿¡æ¯
cp -r /opt/canal/conf/example/meta.dat $backup_dir/ 2>/dev/null

echo "é…ç½®å¤‡ä»½å®Œæˆ: $backup_dir"
```

**ğŸ”¸ æ•°æ®æ¢å¤**
```bash
# æ¢å¤Canalåˆ°æŒ‡å®šä½ç½®
# 1. åœæ­¢CanalæœåŠ¡
systemctl stop canal

# 2. æ¢å¤é…ç½®æ–‡ä»¶
cp -r /backup/canal/20240911/conf/* /opt/canal/conf/

# 3. æ¢å¤ä½ç½®ä¿¡æ¯(å¦‚éœ€è¦)
cp /backup/canal/20240911/meta.dat /opt/canal/conf/example/

# 4. é‡å¯æœåŠ¡
systemctl start canal
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å®‰è£…éƒ¨ç½²æ ¸å¿ƒè¦ç‚¹


**ğŸ”¸ ç¯å¢ƒå‡†å¤‡è¦ç‚¹**
```
âœ… Java 8+ ç¯å¢ƒå¿…é¡»
âœ… MySQL binlogå¿…é¡»å¼€å¯ä¸”ä¸ºROWæ ¼å¼  
âœ… Canalä¸“ç”¨ç”¨æˆ·æƒé™é…ç½®
âœ… ç½‘ç»œç«¯å£11111å¼€æ”¾
âœ… é˜²ç«å¢™é…ç½®æ­£ç¡®
```

**ğŸ”¸ é…ç½®æ ¸å¿ƒè¦ç‚¹**
```
ğŸ“‹ canal.properties - Canal Serverå…¨å±€é…ç½®
ğŸ“‹ instance.properties - æ•°æ®æºå®ä¾‹é…ç½®  
ğŸ“‹ filter.regex - è¡¨è¿‡æ»¤è§„åˆ™è®¾ç½®
ğŸ“‹ JVMå‚æ•°è°ƒä¼˜ - å†…å­˜å’ŒGCä¼˜åŒ–
ğŸ“‹ æ—¥å¿—é…ç½® - ä¾¿äºé—®é¢˜æ’æŸ¥
```

### 10.2 è¿ç»´ç®¡ç†è¦ç‚¹


**ğŸ”¹ å¯åŠ¨ç®¡ç†**
- æ¨èä½¿ç”¨systemdç®¡ç†CanalæœåŠ¡
- é…ç½®è‡ªåŠ¨å¯åŠ¨å’Œæ•…éšœé‡å¯
- å®šæœŸæ£€æŸ¥è¿›ç¨‹å’Œç«¯å£çŠ¶æ€

**ğŸ”¹ ç›‘æ§å‘Šè­¦**  
- å…³æ³¨CPUã€å†…å­˜ã€ç½‘ç»œä½¿ç”¨æƒ…å†µ
- ç›‘æ§Canalè§£æå»¶è¿Ÿå’Œé”™è¯¯æ—¥å¿—
- å»ºç«‹å®Œå–„çš„å‘Šè­¦é€šçŸ¥æœºåˆ¶

**ğŸ”¹ æ•…éšœå¤„ç†**
- å®šæœŸå¤‡ä»½é…ç½®æ–‡ä»¶å’Œä½ç½®ä¿¡æ¯
- ç†Ÿæ‚‰å¸¸è§é—®é¢˜çš„æ’æŸ¥æ–¹æ³•
- å»ºç«‹æ•…éšœå¤„ç†æ ‡å‡†æ“ä½œæµç¨‹

### 10.3 ç”Ÿäº§ä½¿ç”¨å»ºè®®


> ğŸ’¡ **éƒ¨ç½²å»ºè®®**  
> ç”Ÿäº§ç¯å¢ƒå»ºè®®é‡‡ç”¨Canal HAæ¨¡å¼éƒ¨ç½²ï¼Œç¡®ä¿æœåŠ¡é«˜å¯ç”¨æ€§

> âš ï¸ **æ€§èƒ½å»ºè®®**  
> æ ¹æ®æ•°æ®é‡å¤§å°åˆç†é…ç½®JVMå†…å­˜ï¼Œä¸€èˆ¬å»ºè®®8GBä»¥ä¸Š

> ğŸ”’ **å®‰å…¨å»ºè®®**  
> Canalç”¨æˆ·åªåˆ†é…å¿…è¦çš„æœ€å°æƒé™ï¼Œå®šæœŸæ›´æ–°å¯†ç 

**ğŸ“ˆ å‘å±•å­¦ä¹ è·¯å¾„**
```
åŸºç¡€éƒ¨ç½² â†’ é…ç½®ä¼˜åŒ– â†’ ç›‘æ§å‘Šè­¦ â†’ é«˜å¯ç”¨æ¶æ„ â†’ æ€§èƒ½è°ƒä¼˜
    â†“         â†“         â†“         â†“         â†“
 å•æœºéƒ¨ç½²   å‚æ•°è°ƒæ•´   æ•…éšœå¤„ç†   é›†ç¾¤éƒ¨ç½²   æ·±åº¦ä¼˜åŒ–
```

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- ğŸ¯ MySQL binlogæ˜¯Canalå·¥ä½œçš„åŸºç¡€ï¼Œå¿…é¡»æ­£ç¡®é…ç½®
- ğŸ”§ instance.propertiesä¸­çš„filter.regexå†³å®šç›‘å¬èŒƒå›´  
- ğŸ“Š å®šæœŸç›‘æ§Canalæ€§èƒ½å’Œå¥åº·çŠ¶æ€è‡³å…³é‡è¦
- ğŸš€ ç”Ÿäº§ç¯å¢ƒå¿…é¡»è€ƒè™‘é«˜å¯ç”¨å’Œæ€§èƒ½ä¼˜åŒ–