---
title: 3ã€Canalæ¶æ„ç»„ä»¶è¯¦è§£
---
## ğŸ“š ç›®å½•

1. [Canalæ•´ä½“æ¶æ„æ¦‚è§ˆ](#1-Canalæ•´ä½“æ¶æ„æ¦‚è§ˆ)
2. [Canal Serveræ ¸å¿ƒç»„ä»¶](#2-Canal-Serveræ ¸å¿ƒç»„ä»¶)
3. [Canal Clientå®¢æˆ·ç«¯è¯¦è§£](#3-Canal-Clientå®¢æˆ·ç«¯è¯¦è§£)
4. [Canal Adminç®¡ç†å¹³å°](#4-Canal-Adminç®¡ç†å¹³å°)
5. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#5-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ—ï¸ Canalæ•´ä½“æ¶æ„æ¦‚è§ˆ


### 1.1 Canalæ˜¯ä»€ä¹ˆï¼Ÿ

**ç®€å•ç†è§£**ï¼šCanalå°±åƒæ˜¯ä¸€ä¸ª"å·å¬è€…"ï¼Œä¸“é—¨ç›‘å¬MySQLæ•°æ®åº“çš„å˜åŒ–

```
çœŸå®åœºæ™¯ç±»æ¯”ï¼š
é“¶è¡ŒæŸœå° â†’ MySQLæ•°æ®åº“
ç›‘æ§æ‘„åƒå¤´ â†’ Canal
å®‰ä¿ä¸­å¿ƒ â†’ åº”ç”¨ç³»ç»Ÿ

å½“æœ‰äººåœ¨æŸœå°åŠä¸šåŠ¡æ—¶ï¼Œæ‘„åƒå¤´ä¼šè®°å½•ä¸‹æ‰€æœ‰æ“ä½œ
Canalä¹Ÿæ˜¯è¿™æ ·ï¼Œå½“MySQLæœ‰æ•°æ®å˜åŒ–æ—¶ï¼Œå®ƒä¼šæ•è·å¹¶ä¼ é€’ç»™éœ€è¦çš„ç³»ç»Ÿ
```

**æ ¸å¿ƒä½œç”¨**ï¼š
- ğŸ¯ **å®æ—¶ç›‘å¬**ï¼šæ•è·MySQLçš„æ•°æ®å˜åŒ–ï¼ˆå¢åˆ æ”¹ï¼‰
- ğŸ“¤ **æ•°æ®ä¼ é€’**ï¼šæŠŠå˜åŒ–çš„æ•°æ®å‘é€ç»™å…¶ä»–ç³»ç»Ÿ
- ğŸ”„ **æ•°æ®åŒæ­¥**ï¼šå¸®åŠ©ä¸åŒç³»ç»Ÿä¿æŒæ•°æ®ä¸€è‡´

### 1.2 æ•´ä½“æ¶æ„å›¾ç¤º


```
MySQLæ•°æ®åº“ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Canal Server â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ åº”ç”¨ç³»ç»Ÿ
    â”‚                           â”‚                           â”‚
    â”‚                           â”‚                           â”‚
 [binlog]                  [è§£æ+å¤„ç†]                 [æ¶ˆè´¹æ•°æ®]
    â”‚                           â”‚                           â”‚
    â”‚                           â”‚                           â”‚
å¢åˆ æ”¹æ“ä½œ                   ç»„ä»¶ååŒå·¥ä½œ               ä¸šåŠ¡é€»è¾‘å¤„ç†
```

**æ¶æ„å±‚æ¬¡å…³ç³»**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Canal Admin                          â”‚ â† ç®¡ç†æ§åˆ¶å°
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   Canal Server                         â”‚ â† æ ¸å¿ƒæœåŠ¡
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ EventParser  â”‚  EventSink   â”‚     EventStore       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   Canal Client                         â”‚ â† å®¢æˆ·ç«¯åº”ç”¨
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†‘                                    â†“
    [è¿æ¥è·å–æ•°æ®]                          [å¤„ç†ä¸šåŠ¡é€»è¾‘]
```

---

## 2. âš™ï¸ Canal Serveræ ¸å¿ƒç»„ä»¶


### 2.1 ä»€ä¹ˆæ˜¯Canal Serverï¼Ÿ

**é€šä¿—è§£é‡Š**ï¼šCanal Serverå°±æ˜¯æ•´ä¸ªCanalç³»ç»Ÿçš„"å¤§è„‘"ï¼Œè´Ÿè´£æ‰€æœ‰æ ¸å¿ƒå·¥ä½œ

**ä¸»è¦èŒè´£**ï¼š
- ğŸ“¡ **è¿æ¥MySQL**ï¼šä¼ªè£…æˆMySQLçš„ä»åº“
- ğŸ“‹ **è§£æbinlog**ï¼šç†è§£MySQLçš„å˜åŒ–è®°å½•
- ğŸ’¾ **å­˜å‚¨æ•°æ®**ï¼šä¸´æ—¶ä¿å­˜è§£æåçš„æ•°æ®
- ğŸ“¤ **æä¾›æœåŠ¡**ï¼šç­‰å¾…å®¢æˆ·ç«¯æ¥è·å–æ•°æ®

### 2.2 Instanceå®ä¾‹æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯Instanceï¼Ÿ**
ç®€å•è¯´å°±æ˜¯Canal Serverä¸­çš„ä¸€ä¸ª"å·¥ä½œå•å…ƒ"

```
ç†è§£Instanceï¼š
ä¸€å°MySQLæœåŠ¡å™¨ â†â†’ ä¸€ä¸ªCanal Instance
ä¸€ä¸ªCanal Serverå¯ä»¥ç®¡ç†å¤šä¸ªInstance

å®é™…åœºæ™¯ï¼š
å…¬å¸æœ‰3ä¸ªMySQLæ•°æ®åº“ï¼š
â”œâ”€ ç”¨æˆ·æ•°æ®åº“ â†’ Canal Instance-1
â”œâ”€ è®¢å•æ•°æ®åº“ â†’ Canal Instance-2  
â””â”€ å•†å“æ•°æ®åº“ â†’ Canal Instance-3

ä¸€ä¸ªCanal ServeråŒæ—¶ç®¡ç†è¿™3ä¸ªInstance
```

**Instanceé…ç½®ç¤ºä¾‹**ï¼š
```yaml
# ç”¨æˆ·æ•°æ®åº“å®ä¾‹é…ç½®
canal.instance.mysql.slaveId = 1001
canal.instance.master.address = 192.168.1.100:3306
canal.instance.dbUsername = canal
canal.instance.dbPassword = canal123
canal.instance.defaultDatabaseName = user_db
```

### 2.3 Destinationç›®æ ‡å®šä¹‰


**ä»€ä¹ˆæ˜¯Destinationï¼Ÿ**
å°±æ˜¯ç»™æ¯ä¸ªInstanceèµ·çš„"åå­—"ï¼Œæ–¹ä¾¿å®¢æˆ·ç«¯æ‰¾åˆ°å¯¹åº”çš„æ•°æ®

```
Destinationçš„ä½œç”¨ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MySQLç”¨æˆ·åº“    â”‚â”€â”€â”€â–¶â”‚ Destination:    â”‚
â”‚                â”‚    â”‚   "user_sync"   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Canal Client   â”‚
                    â”‚ è®¢é˜…"user_sync" â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®é™…ä½¿ç”¨**ï¼š
```java
// å®¢æˆ·ç«¯ä»£ç ç¤ºä¾‹
CanalConnector connector = CanalConnectors.newSingleConnector(
    new InetSocketAddress("127.0.0.1", 11111), 
    "user_sync",  // è¿™å°±æ˜¯destinationåç§°
    "", ""
);
```

### 2.4 EventParseräº‹ä»¶è§£æå™¨


**EventParseræ˜¯åšä»€ä¹ˆçš„ï¼Ÿ**
å®ƒå°±æ˜¯Canalçš„"ç¿»è¯‘å®˜"ï¼ŒæŠŠMySQLçš„binlogç¿»è¯‘æˆCanalèƒ½ç†è§£çš„æ ¼å¼

```
EventParserå·¥ä½œæµç¨‹ï¼š

MySQL Binlog    EventParserå¤„ç†    Canal Event
    â”‚                â”‚                â”‚
    â–¼                â–¼                â–¼
åŸå§‹äºŒè¿›åˆ¶  â”€â”€â”€â”€â”€â”€â–¶  è§£æç¿»è¯‘  â”€â”€â”€â”€â”€â”€â–¶  ç»“æ„åŒ–æ•°æ®
[ä¹±ç å†…å®¹]        [æ™ºèƒ½è¯†åˆ«]        [æ¸…æ™°å†…å®¹]

å…·ä½“è½¬æ¢ï¼š
Binlog: 0x1A2B3C... (äºŒè¿›åˆ¶)
  â†“
Event: {
  eventType: "INSERT",
  database: "user_db", 
  table: "users",
  data: {id: 123, name: "å¼ ä¸‰"}
}
```

**EventParserçš„å…³é”®åŠŸèƒ½**ï¼š
- ğŸ”— **è¿æ¥ç®¡ç†**ï¼šç»´æŒä¸MySQLçš„è¿æ¥
- ğŸ“– **åè®®è§£æ**ï¼šç†è§£MySQLå¤åˆ¶åè®®
- ğŸ”„ **ä½ç‚¹è®°å½•**ï¼šè®°ä½è¯»å–åˆ°å“ªé‡Œäº†
- âŒ **å¼‚å¸¸å¤„ç†**ï¼šç½‘ç»œæ–­å¼€æ—¶è‡ªåŠ¨é‡è¿

### 2.5 EventSinkäº‹ä»¶å¤„ç†å™¨


**EventSinkæ˜¯åšä»€ä¹ˆçš„ï¼Ÿ**
å®ƒæ˜¯Canalçš„"è¿‡æ»¤å™¨"å’Œ"åŠ å·¥å‚"ï¼Œå¯¹è§£æå‡ºçš„æ•°æ®è¿›è¡Œç­›é€‰å’Œå¤„ç†

```
EventSinkå¤„ç†æµç¨‹ï¼š

åŸå§‹Event â”€â”€â–¶ è¿‡æ»¤ç­›é€‰ â”€â”€â–¶ æ•°æ®è½¬æ¢ â”€â”€â–¶ è¾“å‡ºEvent
    â”‚            â”‚            â”‚            â”‚
    â–¼            â–¼            â–¼            â–¼
æ‰€æœ‰æ•°æ®      åªè¦éœ€è¦çš„     æ ¼å¼ç»Ÿä¸€      æœ€ç»ˆç»“æœ

å®é™…ä¾‹å­ï¼š
è¾“å…¥ï¼šuser_db.usersè¡¨çš„INSERTäº‹ä»¶
è¿‡æ»¤ï¼šåªè¦usersè¡¨çš„æ•°æ®ï¼ˆå¿½ç•¥å…¶ä»–è¡¨ï¼‰
è½¬æ¢ï¼šç»Ÿä¸€æ—¶é—´æ ¼å¼ã€å­—æ®µæ˜ å°„
è¾“å‡ºï¼šæ ‡å‡†åŒ–çš„ç”¨æˆ·æ•°æ®å˜æ›´äº‹ä»¶
```

**EventSinkçš„æ ¸å¿ƒèƒ½åŠ›**ï¼š
- ğŸ¯ **æ•°æ®è¿‡æ»¤**ï¼šåªå¤„ç†å…³å¿ƒçš„è¡¨å’Œå­—æ®µ
- ğŸ”„ **æ ¼å¼è½¬æ¢**ï¼šç»Ÿä¸€æ•°æ®æ ¼å¼
- ğŸ“Š **æ•°æ®èšåˆ**ï¼šåˆå¹¶ç›¸å…³çš„å˜æ›´
- âš¡ **æ€§èƒ½ä¼˜åŒ–**ï¼šæ‰¹é‡å¤„ç†æé«˜æ•ˆç‡

### 2.6 EventStoreäº‹ä»¶å­˜å‚¨


**EventStoreæ˜¯åšä»€ä¹ˆçš„ï¼Ÿ**
å®ƒæ˜¯Canalçš„"ä»“åº“ç®¡ç†å‘˜"ï¼Œè´Ÿè´£æš‚æ—¶å­˜å‚¨å¤„ç†å¥½çš„æ•°æ®

```
EventStoreå·¥ä½œåŸç†ï¼š

å¤„ç†å®Œçš„Event â”€â”€â–¶ ä¸´æ—¶å­˜å‚¨ â”€â”€â–¶ å®¢æˆ·ç«¯è·å– â”€â”€â–¶ æ¸…ç†æ•°æ®
       â”‚              â”‚           â”‚           â”‚
       â–¼              â–¼           â–¼           â–¼
   æ–°é²œæ•°æ®        æ’é˜Ÿç­‰å¾…      æŒ‰éœ€å‘é€      é‡Šæ”¾ç©ºé—´

å­˜å‚¨ç­–ç•¥ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             EventStore Queue                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚Eventâ”‚Eventâ”‚Eventâ”‚Eventâ”‚Eventâ”‚Eventâ”‚ ... â”‚
â”‚  â”‚  1  â”‚  2  â”‚  3  â”‚  4  â”‚  5  â”‚  6  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜     â”‚
â”‚       â†‘                           â†‘        â”‚
â”‚     å·²æ¶ˆè´¹                      æ–°æ•°æ®       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**EventStoreçš„ç‰¹ç‚¹**ï¼š
- ğŸ’¾ **å†…å­˜å­˜å‚¨**ï¼šé«˜é€Ÿè¯»å†™ï¼Œæ”¯æŒé«˜å¹¶å‘
- ğŸ”„ **ç¯å½¢é˜Ÿåˆ—**ï¼šå›ºå®šå¤§å°ï¼Œè‡ªåŠ¨è¦†ç›–æ—§æ•°æ®
- ğŸ“ **ä½ç‚¹ç®¡ç†**ï¼šè®°å½•å®¢æˆ·ç«¯æ¶ˆè´¹è¿›åº¦
- ğŸ”’ **çº¿ç¨‹å®‰å…¨**ï¼šæ”¯æŒå¤šå®¢æˆ·ç«¯åŒæ—¶è®¿é—®

### 2.7 MetaManagerå…ƒæ•°æ®ç®¡ç†


**MetaManageræ˜¯åšä»€ä¹ˆçš„ï¼Ÿ**
å®ƒæ˜¯Canalçš„"è®°è´¦å‘˜"ï¼Œè´Ÿè´£è®°å½•å„ç§é‡è¦ä¿¡æ¯

```
MetaManagerç®¡ç†çš„ä¿¡æ¯ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ä½ç‚¹ä¿¡æ¯       â”‚  â”‚   å®¢æˆ·ç«¯çŠ¶æ€     â”‚  â”‚   å®ä¾‹é…ç½®       â”‚
â”‚                â”‚  â”‚                â”‚  â”‚                â”‚
â”‚ â€¢ binlogæ–‡ä»¶å  â”‚  â”‚ â€¢ è¿æ¥æ—¶é—´      â”‚  â”‚ â€¢ MySQLåœ°å€     â”‚
â”‚ â€¢ æ–‡ä»¶ä½ç½®      â”‚  â”‚ â€¢ æ¶ˆè´¹è¿›åº¦      â”‚  â”‚ â€¢ ç”¨æˆ·åå¯†ç      â”‚
â”‚ â€¢ æ¶ˆè´¹æ—¶é—´      â”‚  â”‚ â€¢ å¿ƒè·³çŠ¶æ€      â”‚  â”‚ â€¢ è¿‡æ»¤è§„åˆ™      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®é™…ä½œç”¨åœºæ™¯**ï¼š
```
åœºæ™¯1ï¼šCanalé‡å¯æ¢å¤
1. Canalé‡å¯å‰ï¼šè®°å½•è¯»å–åˆ° mysql-bin.000123 ä½ç½®456789
2. Canalé‡å¯åï¼šä»MetaManagerè·å–ä¸Šæ¬¡ä½ç½®
3. ç»§ç»­è¯»å–ï¼šä» mysql-bin.000123 ä½ç½®456789å¼€å§‹

åœºæ™¯2ï¼šå®¢æˆ·ç«¯æ–­çº¿é‡è¿
1. å®¢æˆ·ç«¯æ–­çº¿å‰ï¼šæ¶ˆè´¹åˆ°Event ID 98765
2. é‡æ–°è¿æ¥åï¼šMetaManagerå‘ŠçŸ¥ä»98766å¼€å§‹
3. æ— ç¼è¡”æ¥ï¼šä¸ä¼šé‡å¤æ¶ˆè´¹æˆ–ä¸¢å¤±æ•°æ®
```

---

## 3. ğŸ’» Canal Clientå®¢æˆ·ç«¯è¯¦è§£


### 3.1 ä»€ä¹ˆæ˜¯Canal Clientï¼Ÿ

**ç®€å•ç†è§£**ï¼šCanal Clientå°±æ˜¯ä½¿ç”¨Canalæ•°æ®çš„åº”ç”¨ç¨‹åº

```
Canal Clientçš„è§’è‰²ï¼š

Canal Server        Canal Client        ä¸šåŠ¡ç³»ç»Ÿ
    â”‚                   â”‚                 â”‚
    â”‚â”€â”€[æä¾›æ•°æ®]â”€â”€â”€â”€â”€â”€â–¶â”‚                 â”‚
    â”‚                   â”‚â”€â”€[å¤„ç†é€»è¾‘]â”€â”€â”€â–¶â”‚
    â”‚                   â”‚                 â”‚
  æ•°æ®ç”Ÿäº§è€…            æ•°æ®æ¶ˆè´¹è€…        æœ€ç»ˆä½¿ç”¨è€…
```

### 3.2 CanalConnectorè¿æ¥å™¨


**ä»€ä¹ˆæ˜¯CanalConnectorï¼Ÿ**
å®ƒæ˜¯Canal Clientä¸Canal Serverä¹‹é—´çš„"é€šä¿¡æ¡¥æ¢"

```java
// åˆ›å»ºè¿æ¥å™¨çš„åŸºæœ¬ä»£ç 
CanalConnector connector = CanalConnectors.newSingleConnector(
    new InetSocketAddress("canalæœåŠ¡å™¨åœ°å€", 11111),
    "destinationåç§°",  // è¦è®¢é˜…çš„å®ä¾‹
    "ç”¨æˆ·å", "å¯†ç "
);
```

**CanalConnectorçš„æ ¸å¿ƒæ–¹æ³•**ï¼š
```java
// è¿æ¥åˆ°Canal Server
connector.connect();

// è®¢é˜…æ•°æ®å˜æ›´ï¼ˆå¯æŒ‡å®šè¿‡æ»¤è§„åˆ™ï¼‰
connector.subscribe(".*\\..*");  // è®¢é˜…æ‰€æœ‰åº“æ‰€æœ‰è¡¨

// è·å–æ•°æ®ï¼ˆæ‰¹é‡è·å–ï¼‰
Message message = connector.getWithoutAck(100);  // ä¸€æ¬¡è·å–100æ¡

// ç¡®è®¤æ¶ˆè´¹ï¼ˆç¡®è®¤æ•°æ®å·²å¤„ç†ï¼‰
connector.ack(message.getId());

// æ–­å¼€è¿æ¥
connector.disconnect();
```

### 3.3 å®¢æˆ·ç«¯æ¶ˆè´¹æµç¨‹


```
Canal Clientæ¶ˆè´¹æ•°æ®çš„å®Œæ•´æµç¨‹ï¼š

1. å»ºç«‹è¿æ¥
   connector.connect()
   
2. è®¢é˜…æ•°æ®  
   connector.subscribe()
   
3. å¾ªç¯è·å–æ•°æ®
   while(true) {
     Message message = connector.get(batch);
     
4. å¤„ç†ä¸šåŠ¡é€»è¾‘
     processEntries(message.getEntries());
     
5. ç¡®è®¤æ¶ˆè´¹
     connector.ack(message.getId());
   }
   
6. æ–­å¼€è¿æ¥
   connector.disconnect()
```

**å®é™…ä»£ç ç¤ºä¾‹**ï¼š
```java
public class SimpleCanalClient {
    public static void main(String[] args) {
        // 1. åˆ›å»ºè¿æ¥å™¨
        CanalConnector connector = CanalConnectors.newSingleConnector(
            new InetSocketAddress("127.0.0.1", 11111), 
            "example", "", "");
        
        try {
            // 2. è¿æ¥Canal Server
            connector.connect();
            
            // 3. è®¢é˜…æ•°æ®å˜æ›´
            connector.subscribe("test\\..*");  // åªè®¢é˜…testæ•°æ®åº“
            
            while (true) {
                // 4. è·å–æ•°æ®ï¼ˆä¸€æ¬¡æœ€å¤š100æ¡ï¼‰
                Message message = connector.getWithoutAck(100);
                
                long batchId = message.getId();
                if (batchId != -1) {
                    // 5. å¤„ç†æ•°æ®
                    printEntries(message.getEntries());
                    
                    // 6. ç¡®è®¤æ¶ˆè´¹
                    connector.ack(batchId);
                } else {
                    // æ²¡æœ‰æ•°æ®ï¼Œä¼‘æ¯1ç§’
                    Thread.sleep(1000);
                }
            }
        } finally {
            connector.disconnect();
        }
    }
    
    private static void printEntries(List<Entry> entries) {
        for (Entry entry : entries) {
            if (entry.getEntryType() == EntryType.ROWDATA) {
                RowChange rowChange = RowChange.parseFrom(entry.getStoreValue());
                for (RowData rowData : rowChange.getRowDatasList()) {
                    System.out.println("æ•°æ®å˜æ›´ï¼š" + rowData);
                }
            }
        }
    }
}
```

---

## 4. ğŸ›ï¸ Canal Adminç®¡ç†å¹³å°


### 4.1 ä»€ä¹ˆæ˜¯Canal Adminï¼Ÿ

**ç®€å•ç†è§£**ï¼šCanal Adminå°±æ˜¯Canalçš„"æ§åˆ¶å°"ï¼Œæä¾›å¯è§†åŒ–ç®¡ç†ç•Œé¢

```
æ²¡æœ‰Canal Adminçš„æ—¶å€™ï¼š
1. ä¿®æ”¹é…ç½® â†’ æ‰‹åŠ¨ç¼–è¾‘é…ç½®æ–‡ä»¶
2. æŸ¥çœ‹çŠ¶æ€ â†’ çœ‹æ—¥å¿—æ–‡ä»¶
3. é‡å¯æœåŠ¡ â†’ æ‰‹åŠ¨æ“ä½œå‘½ä»¤è¡Œ
4. ç›‘æ§é—®é¢˜ â†’ äººå·¥æ£€æŸ¥

æœ‰äº†Canal Adminåï¼š
1. ä¿®æ”¹é…ç½® â†’ ç½‘é¡µç•Œé¢ç‚¹å‡»
2. æŸ¥çœ‹çŠ¶æ€ â†’ ç›´è§‚çš„çŠ¶æ€é¢æ¿  
3. é‡å¯æœåŠ¡ â†’ ä¸€é”®æ“ä½œ
4. ç›‘æ§é—®é¢˜ â†’ å®æ—¶å‘Šè­¦
```

### 4.2 Canal Adminæ ¸å¿ƒåŠŸèƒ½


**ğŸ¯ å®ä¾‹ç®¡ç†**ï¼š
```
åŠŸèƒ½åˆ—è¡¨ï¼š
â”œâ”€ ğŸ“‹ å®ä¾‹åˆ—è¡¨ï¼šæŸ¥çœ‹æ‰€æœ‰Canalå®ä¾‹
â”œâ”€ â• æ–°å¢å®ä¾‹ï¼šåˆ›å»ºæ–°çš„åŒæ­¥ä»»åŠ¡
â”œâ”€ âš™ï¸ é…ç½®ç®¡ç†ï¼šåœ¨çº¿ä¿®æ”¹å®ä¾‹é…ç½®
â”œâ”€ ğŸ”„ å¯åœæ§åˆ¶ï¼šè¿œç¨‹å¯åŠ¨/åœæ­¢å®ä¾‹
â””â”€ ğŸ“Š çŠ¶æ€ç›‘æ§ï¼šå®æ—¶æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
```

**ğŸ”§ é…ç½®ç®¡ç†ç•Œé¢ç¤ºä¾‹**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               å®ä¾‹é…ç½®                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å®ä¾‹åç§°: [user_sync          ]             â”‚
â”‚ MySQLåœ°å€: [192.168.1.100:3306]             â”‚
â”‚ ç”¨æˆ·å:   [canal              ]             â”‚
â”‚ å¯†ç :     [**********         ]             â”‚
â”‚ æ•°æ®åº“:   [user_db            ]             â”‚
â”‚ è¡¨è¿‡æ»¤:   [users,user_logs    ]             â”‚
â”‚                                             â”‚
â”‚ [ä¿å­˜é…ç½®]  [æµ‹è¯•è¿æ¥]  [é‡å¯å®ä¾‹]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ“Š ç›‘æ§é¢æ¿åŠŸèƒ½**ï¼š
```
å®æ—¶ç›‘æ§æŒ‡æ ‡ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è¿æ¥çŠ¶æ€       â”‚     å»¶è¿Ÿç›‘æ§     â”‚     ååé‡       â”‚
â”‚                â”‚                â”‚                â”‚
â”‚ ğŸŸ¢ MySQLè¿æ¥æ­£å¸¸ â”‚ â±ï¸ å»¶è¿Ÿ: 50ms   â”‚ ğŸ“ˆ 1000 TPS     â”‚
â”‚ ğŸŸ¢ å®¢æˆ·ç«¯å·²è¿æ¥  â”‚ ğŸ“Š å¹³å‡: 45ms   â”‚ ğŸ“Š å³°å€¼: 1500   â”‚
â”‚ ğŸ”„ è¿è¡Œæ—¶é—´: 2å¤© â”‚ âš ï¸ æœ€å¤§: 200ms  â”‚ ğŸ“‰ æœ€ä½: 800    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 Canal Adminéƒ¨ç½²æ¶æ„


```
Canal Adminéƒ¨ç½²ç»“æ„ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Canal Admin                         â”‚
â”‚                    (ç®¡ç†æ§åˆ¶å°)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ (ç®¡ç†æ§åˆ¶)
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Canal Node 1  â”‚   Canal Node 2  â”‚   Canal Node 3  â”‚
â”‚                â”‚                â”‚                â”‚
â”‚ Instance A      â”‚ Instance C      â”‚ Instance E      â”‚
â”‚ Instance B      â”‚ Instance D      â”‚ Instance F      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**éƒ¨ç½²é…ç½®ç¤ºä¾‹**ï¼š
```yaml
# Canal Adminé…ç½®
server:
  port: 8089

spring:
  datasource:
    address: 127.0.0.1:3306
    database: canal_manager
    username: canal
    password: canal

# Canal Nodeæ³¨å†Œåˆ°Admin
canal:
  admin:
    manager: 127.0.0.1:8089  # Adminåœ°å€
    port: 11110              # ç®¡ç†ç«¯å£
    user: admin
    passwd: admin
```

---

## 5. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 5.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Canal Serverï¼šæ•´ä¸ªç³»ç»Ÿçš„æ ¸å¿ƒï¼Œè´Ÿè´£ç›‘å¬MySQLå’Œå¤„ç†æ•°æ®
ğŸ”¸ Instanceå®ä¾‹ï¼šä¸€ä¸ªMySQLæ•°æ®åº“å¯¹åº”ä¸€ä¸ªInstance
ğŸ”¸ Destinationï¼šInstanceçš„åç§°ï¼Œå®¢æˆ·ç«¯é€šè¿‡å®ƒæ¥è®¢é˜…æ•°æ®
ğŸ”¸ EventParserï¼šè§£æMySQL binlogçš„ç»„ä»¶
ğŸ”¸ EventSinkï¼šè¿‡æ»¤å’Œå¤„ç†äº‹ä»¶çš„ç»„ä»¶  
ğŸ”¸ EventStoreï¼šä¸´æ—¶å­˜å‚¨äº‹ä»¶çš„ç»„ä»¶
ğŸ”¸ Canal Clientï¼šæ¶ˆè´¹Canalæ•°æ®çš„åº”ç”¨ç¨‹åº
ğŸ”¸ CanalConnectorï¼šå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„è¿æ¥å™¨
ğŸ”¸ Canal Adminï¼šå¯è§†åŒ–ç®¡ç†å¹³å°
```

### 5.2 ç»„ä»¶åä½œå…³ç³»ç†è§£


**ğŸ“Š æ•°æ®æµè½¬è¿‡ç¨‹**ï¼š
```
MySQLå˜æ›´ â†’ EventParserè§£æ â†’ EventSinkå¤„ç† â†’ EventStoreå­˜å‚¨ â†’ Clientæ¶ˆè´¹
    â”‚            â”‚              â”‚             â”‚            â”‚
    â–¼            â–¼              â–¼             â–¼            â–¼
 åŸå§‹binlog   ç»“æ„åŒ–Event    è¿‡æ»¤åEvent   æ’é˜ŸEvent    ä¸šåŠ¡å¤„ç†
```

**ğŸ”§ ç®¡ç†æ§åˆ¶å…³ç³»**ï¼š
```
Canal Admin â”€â”€â”€â”€â”€ç®¡ç†æ§åˆ¶â”€â”€â”€â”€â”€â†’ Canal Server
     â”‚                           â”‚
     â”‚                           â”‚
  é…ç½®ä¸‹å‘                    çŠ¶æ€ä¸ŠæŠ¥
  å¯åœæ§åˆ¶                    è¿è¡Œç›‘æ§
  å®ä¾‹ç®¡ç†                    æ—¥å¿—æ”¶é›†
```

### 5.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ å…¸å‹ä½¿ç”¨åœºæ™¯**ï¼š
- **æ•°æ®åŒæ­¥**ï¼šMySQL â†’ Redis/ES/HBase
- **ç¼“å­˜æ›´æ–°**ï¼šæ•°æ®å˜æ›´æ—¶è‡ªåŠ¨åˆ·æ–°ç¼“å­˜
- **æ¶ˆæ¯å‘é€**ï¼šæ•°æ®å˜æ›´è§¦å‘æ¶ˆæ¯é€šçŸ¥
- **å®æ—¶è®¡ç®—**ï¼šæ•°æ®å˜æ›´å®æ—¶ç»Ÿè®¡åˆ†æ

**ğŸ’¡ æ¶æ„è®¾è®¡ä¼˜åŠ¿**ï¼š
- **è§£è€¦è®¾è®¡**ï¼šå„ç»„ä»¶èŒè´£æ¸…æ™°ï¼Œä¾¿äºç»´æŠ¤
- **å¯æ‰©å±•æ€§**ï¼šæ”¯æŒå¤šå®ä¾‹ã€å¤šå®¢æˆ·ç«¯
- **é«˜å¯ç”¨æ€§**ï¼šæ”¯æŒæ•…éšœæ¢å¤å’Œæ–­ç‚¹ç»­ä¼ 
- **æ˜“ç®¡ç†æ€§**ï¼šAdminå¹³å°æä¾›å¯è§†åŒ–ç®¡ç†

**ğŸ”§ å®é™…éƒ¨ç½²å»ºè®®**ï¼š
- **å°è§„æ¨¡**ï¼šå•æœºéƒ¨ç½²Canal Serverå³å¯
- **ä¸­ç­‰è§„æ¨¡**ï¼šCanal Server + Canal Admin
- **å¤§è§„æ¨¡**ï¼šå¤šèŠ‚ç‚¹Canal Serveré›†ç¾¤ + Canal Admin
- **ä¼ä¸šçº§**ï¼šé«˜å¯ç”¨éƒ¨ç½² + ç›‘æ§å‘Šè­¦ + è¿ç»´è‡ªåŠ¨åŒ–

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- Canal Serveræ˜¯å¤§è„‘ï¼Œè´Ÿè´£æ ¸å¿ƒæ•°æ®å¤„ç†
- Instanceæ˜¯å·¥ä½œå•å…ƒï¼Œä¸€ä¸ªMySQLå¯¹åº”ä¸€ä¸ª
- Clientæ˜¯æ¶ˆè´¹è€…ï¼Œè·å–æ•°æ®è¿›è¡Œä¸šåŠ¡å¤„ç†  
- Adminæ˜¯ç®¡å®¶ï¼Œæä¾›å¯è§†åŒ–ç®¡ç†å’Œç›‘æ§
- å„ç»„ä»¶åˆ†å·¥æ˜ç¡®ï¼Œåä½œå®Œæˆæ•°æ®åŒæ­¥ä»»åŠ¡