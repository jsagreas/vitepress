---
title: 12、安全相关配置参数
---
## 📚 目录

1. [网络安全配置](#1-网络安全配置)
2. [文件操作安全](#2-文件操作安全)
3. [SQL执行安全](#3-SQL执行安全)
4. [密码安全策略](#4-密码安全策略)
5. [权限控制安全](#5-权限控制安全)
6. [数据库访问安全](#6-数据库访问安全)
7. [安全配置最佳实践](#7-安全配置最佳实践)
8. [核心要点总结](#8-核心要点总结)

---

## 1. 🌐 网络安全配置


### 1.1 bind_address 绑定地址


**🔸 核心概念**
```
bind_address：控制MySQL服务器监听哪些网络接口
作用：限制客户端连接来源，提升网络安全性
默认值：*(所有接口) 或 0.0.0.0
```

**💡 工作原理**
想象MySQL服务器就像一个房子，`bind_address`就是决定这个房子的门开在哪里：
- `bind_address = 127.0.0.1` → 只开内部门，只有本机能进来
- `bind_address = 192.168.1.100` → 只开指定IP的门
- `bind_address = *` → 所有门都开，任何网络都能尝试连接

```ini
# my.cnf配置示例
[mysqld]
# 只允许本机连接（最安全）
bind_address = 127.0.0.1

# 只允许指定IP连接
bind_address = 192.168.1.100

# 允许多个IP连接（MySQL 8.0+）
bind_address = 127.0.0.1,192.168.1.100

# 允许所有连接（不推荐）
bind_address = 0.0.0.0
```

**⚠️ 安全影响**
```
高安全：127.0.0.1 → 只有本机应用能连接
中安全：内网IP → 只有内网能连接  
低安全：0.0.0.0 → 全网都能尝试连接
```

### 1.2 skip_networking 禁用网络


**🔸 核心概念**
```
skip_networking：完全禁用TCP/IP网络连接
效果：只能通过Unix socket或命名管道连接
适用场景：单机应用，最高安全级别
```

**💡 理解说明**
就像把房子的所有对外门窗都封死，只留一个内部通道。外部网络完全无法访问MySQL，只有本机程序通过特殊通道连接。

```ini
# my.cnf配置
[mysqld]
# 禁用所有网络连接
skip_networking = 1

# 或者写成
skip-networking

# 指定socket文件位置
socket = /var/lib/mysql/mysql.sock
```

**🔄 连接方式对比**
```
启用网络：
mysql -h 192.168.1.100 -u user -p  ✅ 可以
mysql -h localhost -u user -p      ✅ 可以

禁用网络：
mysql -h 192.168.1.100 -u user -p  ❌ 无法连接
mysql -h localhost -u user -p      ✅ 可以（通过socket）
```

---

## 2. 📁 文件操作安全


### 2.1 local_infile 本地文件加载


**🔸 核心概念**
```
local_infile：控制是否允许LOAD DATA LOCAL INFILE语句
风险：可能被恶意利用读取服务器文件
建议：生产环境建议禁用
```

**💡 安全风险解释**
想象有个功能可以让用户说"把我电脑上的文件传到数据库"，但恶意用户可能说"把服务器上的密码文件传给我"。

```ini
# my.cnf安全配置
[mysqld]
# 禁用本地文件加载（推荐）
local_infile = 0

[mysql]
# 客户端也禁用
local_infile = 0
```

**🚨 风险示例**
```sql
-- 正常用途：导入数据
LOAD DATA LOCAL INFILE 'data.csv' INTO TABLE users;

-- 恶意用途：读取系统文件
LOAD DATA LOCAL INFILE '/etc/passwd' INTO TABLE temp_table;
```

### 2.2 secure_file_priv 安全文件目录


**🔸 核心概念**
```
secure_file_priv：限制文件操作的目录范围
取值：
- NULL：禁用所有文件操作
- 空字符串：不限制目录
- 具体路径：只允许指定目录
```

**💡 工作机制**
就像给MySQL划定一个"安全区域"，只能在这个区域内进行文件读写，不能随意访问系统其他位置。

```ini
# my.cnf配置选项
[mysqld]
# 禁用所有文件操作（最安全）
secure_file_priv = NULL

# 限制在指定目录
secure_file_priv = /var/lib/mysql-files/

# 不限制（不推荐）
secure_file_priv = ""
```

**📊 安全级别对比**

| 配置值 | **安全级别** | **影响** | **适用场景** |
|--------|------------|---------|-------------|
| `NULL` | `🔴 最高` | `禁用所有文件操作` | `高安全要求环境` |
| `/path/` | `🟡 中等` | `限制指定目录` | `需要文件操作的应用` |
| `""` | `🟢 最低` | `不限制目录` | `开发测试环境` |

---

## 3. ⚙️ SQL执行安全


### 3.1 sql_mode SQL模式设置


**🔸 核心概念**
```
sql_mode：控制SQL语句的执行行为和数据校验
作用：防止危险操作，确保数据完整性
包含多个模式，用逗号分隔
```

**💡 重要安全模式解释**

```ini
# my.cnf推荐安全配置
[mysqld]
sql_mode = STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION
```

**🛡️ 关键安全模式说明**

```
STRICT_TRANS_TABLES：严格模式
- 含义：对数据类型和长度进行严格检查
- 好处：防止插入无效数据

ERROR_FOR_DIVISION_BY_ZERO：除零错误
- 含义：除以0时报错而不是返回NULL
- 好处：避免静默的计算错误

NO_AUTO_CREATE_USER：禁止自动创建用户
- 含义：GRANT语句不能自动创建用户
- 好处：防止意外创建空密码用户

NO_ENGINE_SUBSTITUTION：禁止引擎替换
- 含义：指定的存储引擎不可用时报错
- 好处：避免使用错误的存储引擎
```

**⚡ 安全模式示例对比**

```sql
-- 非严格模式下的危险行为
INSERT INTO users(name) VALUES('Very long name that exceeds column length');
-- 结果：数据被截断，静默插入

-- 严格模式下
INSERT INTO users(name) VALUES('Very long name that exceeds column length');
-- 结果：报错，拒绝插入
```

---

## 4. 🔐 密码安全策略


### 4.1 validate_password 密码验证


**🔸 核心概念**
```
validate_password：密码强度验证插件
作用：强制用户使用复杂密码
级别：LOW、MEDIUM、STRONG
```

**💡 密码策略详解**

```ini
# my.cnf密码安全配置
[mysqld]
# 启用密码验证插件
validate_password = ON

# 密码策略级别
validate_password_policy = MEDIUM

# 最小密码长度
validate_password_length = 8

# 必须包含的数字个数
validate_password_number_count = 1

# 必须包含的小写字母个数
validate_password_lowercase_count = 1

# 必须包含的大写字母个数
validate_password_uppercase_count = 1

# 必须包含的特殊字符个数
validate_password_special_char_count = 1
```

**📊 密码强度级别**

| 级别 | **要求** | **示例** |
|------|---------|---------|
| `LOW` | `只检查长度` | `12345678` |
| `MEDIUM` | `长度+数字+大小写+特殊字符` | `Abc123@#` |
| `STRONG` | `MEDIUM+字典检查` | `MyP@ssw0rd2024` |

### 4.2 密码生命周期管理


**🔸 default_password_lifetime 密码生命周期**

```ini
# my.cnf配置
[mysqld]
# 密码180天后过期
default_password_lifetime = 180

# 密码永不过期（不推荐）
default_password_lifetime = 0
```

**🔸 password_history 密码历史**

```ini
# 不能重复使用最近5个密码
password_history = 5
```

**🔸 password_reuse_interval 密码重用间隔**

```ini
# 365天内不能重复使用密码
password_reuse_interval = 365
```

**💡 密码策略工作流程**

```
用户修改密码
    ↓
检查密码长度
    ↓
检查密码复杂度
    ↓
检查密码历史
    ↓
检查重用间隔
    ↓
设置过期时间
    ↓
密码修改成功
```

---

## 5. 🔒 权限控制安全


### 5.1 automatic_sp_privileges 存储过程权限


**🔸 核心概念**
```
automatic_sp_privileges：是否自动授予存储过程权限
默认：ON（自动授予）
安全建议：OFF（手动控制）
```

**💡 安全风险解释**
当用户创建存储过程时，系统自动给他执行权限。这就像造了把钥匙就自动能开门，可能存在权限滥用风险。

```ini
# my.cnf安全配置
[mysqld]
# 禁用自动权限授予
automatic_sp_privileges = 0
```

**🔄 权限控制对比**

```sql
-- automatic_sp_privileges = ON 时
CREATE PROCEDURE test_proc() BEGIN SELECT 1; END;
-- 用户自动获得EXECUTE权限

-- automatic_sp_privileges = OFF 时  
CREATE PROCEDURE test_proc() BEGIN SELECT 1; END;
-- 需要手动授权：GRANT EXECUTE ON PROCEDURE test_proc TO user;
```

### 5.2 safe_user_create 安全用户创建


**🔸 核心概念**
```
safe_user_create：控制普通用户是否能创建新用户
启用后：只有拥有mysql.user表INSERT权限的用户才能创建用户
目的：防止权限滥用
```

```ini
# my.cnf配置
[mysqld]
# 启用安全用户创建
safe_user_create = 1
```

---

## 6. 🏠 数据库访问安全


### 6.1 skip_show_database 隐藏数据库


**🔸 核心概念**
```
skip_show_database：隐藏用户无权访问的数据库
效果：SHOW DATABASES只显示有权限的数据库
安全价值：信息隐藏，减少攻击面
```

**💡 隐藏机制说明**
就像图书馆只让你看到有权限借阅的书籍清单，其他书籍对你"隐身"。

```ini
# my.cnf配置
[mysqld]
# 启用数据库隐藏
skip_show_database = 1
# 或者
skip-show-database
```

**🔍 效果对比**

```sql
-- 未启用skip_show_database
SHOW DATABASES;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql             |
| performance_schema |
| test              |
| app_db            |
| secret_db         |
+--------------------+

-- 启用skip_show_database（普通用户）
SHOW DATABASES;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| app_db            |
+--------------------+
```

---

## 7. 🛡️ 安全配置最佳实践


### 7.1 生产环境推荐配置


```ini
# my.cnf生产环境安全配置模板
[mysqld]
# === 网络安全 ===
bind_address = 127.0.0.1  # 只允许本机连接
# skip_networking = 1     # 如果不需要网络连接

# === 文件安全 ===
local_infile = 0          # 禁用本地文件加载
secure_file_priv = NULL   # 禁用文件操作

# === SQL安全 ===
sql_mode = STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION

# === 密码安全 ===
validate_password = ON
validate_password_policy = MEDIUM
validate_password_length = 8
default_password_lifetime = 90
password_history = 5
password_reuse_interval = 365

# === 权限安全 ===
automatic_sp_privileges = 0
safe_user_create = 1
skip_show_database = 1

# === 其他安全设置 ===
max_connections = 100     # 限制连接数
connect_timeout = 10      # 连接超时
wait_timeout = 600        # 等待超时
```

### 7.2 安全配置检查清单


**🔸 网络层安全**
```
✅ bind_address设置为具体IP
✅ 关闭不必要的网络监听
✅ 配置防火墙规则
✅ 使用SSL加密连接
```

**🔸 文件系统安全**
```
✅ 禁用local_infile
✅ 设置secure_file_priv
✅ 限制MySQL用户权限
✅ 保护配置文件权限
```

**🔸 认证授权安全**
```
✅ 启用密码复杂度验证
✅ 设置密码过期策略
✅ 删除默认用户账号
✅ 使用最小权限原则
```

### 7.3 安全配置验证


**🔍 检查当前安全配置**

```sql
-- 查看网络绑定
SHOW VARIABLES LIKE 'bind_address';

-- 查看文件安全设置
SHOW VARIABLES LIKE 'local_infile';
SHOW VARIABLES LIKE 'secure_file_priv';

-- 查看SQL模式
SHOW VARIABLES LIKE 'sql_mode';

-- 查看密码策略
SHOW VARIABLES LIKE 'validate_password%';

-- 查看权限设置
SHOW VARIABLES LIKE 'automatic_sp_privileges';
SHOW VARIABLES LIKE 'skip_show_database';
```

---

## 8. 📋 核心要点总结


### 8.1 必须掌握的安全配置


```
🔸 网络安全：bind_address限制连接来源
🔸 文件安全：local_infile和secure_file_priv控制文件操作
🔸 SQL安全：sql_mode启用严格模式
🔸 密码安全：validate_password强制密码复杂度
🔸 权限安全：automatic_sp_privileges和safe_user_create控制权限
🔸 访问安全：skip_show_database隐藏敏感信息
```

### 8.2 安全配置原则


**🔹 最小权限原则**
```
只给必需的权限：
- 网络访问：只允许必要的IP连接
- 文件操作：只允许安全目录操作  
- 用户权限：只给必需的数据库权限
- 功能开关：关闭不需要的危险功能
```

**🔹 纵深防御原则**
```
多层安全保护：
网络层 → 认证层 → 授权层 → 数据层
每一层都有相应的安全配置
```

**🔹 安全与可用性平衡**
```
安全配置要考虑：
- 业务功能需求
- 性能影响
- 管理复杂度
- 用户体验
```

### 8.3 常见安全误区


**❌ 错误做法**
```
1. 使用默认配置上生产
2. 为了方便关闭所有安全限制
3. 使用简单密码
4. 给所有用户超级权限
5. 忽略安全日志和监控
```

**✅ 正确做法**
```
1. 根据环境定制安全配置
2. 采用白名单而非黑名单思维
3. 定期审查和更新安全配置
4. 建立安全监控和告警机制
5. 进行定期安全评估
```

**核心记忆**：
- MySQL安全配置是多层次的防护体系
- 网络、文件、SQL、密码、权限各有重点
- 安全配置要在安全性和可用性之间找平衡
- 定期检查和更新安全配置是必要的