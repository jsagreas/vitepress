---
title: 30ã€é«˜å¯ç”¨ä¸Žé›†ç¾¤é…ç½®
---
## ðŸ“š ç›®å½•

1. [é«˜å¯ç”¨é…ç½®åŸºç¡€æ¦‚å¿µ](#1-é«˜å¯ç”¨é…ç½®åŸºç¡€æ¦‚å¿µ)
2. [GTIDå…¨å±€äº‹åŠ¡æ ‡è¯†ç¬¦è¯¦è§£](#2-GTIDå…¨å±€äº‹åŠ¡æ ‡è¯†ç¬¦è¯¦è§£)
3. [æ ¸å¿ƒGTIDé…ç½®å‚æ•°](#3-æ ¸å¿ƒGTIDé…ç½®å‚æ•°)
4. [ä¸»ä»Žå¤åˆ¶é…ç½®è¯¦è§£](#4-ä¸»ä»Žå¤åˆ¶é…ç½®è¯¦è§£)
5. [æœåŠ¡å™¨è¯†åˆ«é…ç½®](#5-æœåŠ¡å™¨è¯†åˆ«é…ç½®)
6. [æ ¡éªŒå’Œå®‰å…¨é…ç½®](#6-æ ¡éªŒå’Œå®‰å…¨é…ç½®)
7. [å®žé™…é…ç½®åº”ç”¨æ¡ˆä¾‹](#7-å®žé™…é…ç½®åº”ç”¨æ¡ˆä¾‹)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ðŸŒ é«˜å¯ç”¨é…ç½®åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯MySQLé«˜å¯ç”¨


**ðŸ”¸ é«˜å¯ç”¨çš„æœ¬è´¨**
```
é«˜å¯ç”¨ï¼ˆHigh Availabilityï¼‰ï¼šç¡®ä¿æ•°æ®åº“æœåŠ¡æŒç»­å¯ç”¨
ç›®æ ‡ï¼šå³ä½¿æŸä¸ªæœåŠ¡å™¨å‡ºæ•…éšœï¼Œæ•´ä¸ªæ•°æ®åº“ç³»ç»Ÿä¾ç„¶èƒ½æ­£å¸¸å·¥ä½œ
å®žçŽ°æ–¹å¼ï¼šå¤šå°æœåŠ¡å™¨ååŒå·¥ä½œï¼Œäº’ç›¸å¤‡ä»½
```

**ðŸ  ç”Ÿæ´»ç±»æ¯”**
> å°±åƒä¸€ä¸ªå…¬å¸æœ‰å¤šä¸ªåˆ†åº—ï¼Œå¦‚æžœæ€»åº—å‡ºé—®é¢˜äº†ï¼Œåˆ†åº—è¿˜èƒ½ç»§ç»­è¥ä¸šï¼Œå®¢æˆ·ä¸ä¼šå—åˆ°å½±å“ã€‚MySQLçš„é«˜å¯ç”¨å°±æ˜¯è¿™ä¸ªé“ç†ã€‚

### 1.2 é«˜å¯ç”¨æž¶æž„ç±»åž‹


**ðŸ“Š å¸¸è§æž¶æž„å¯¹æ¯”**

| æž¶æž„ç±»åž‹ | **å·¥ä½œåŽŸç†** | **é€‚ç”¨åœºæ™¯** | **ä¼˜ç¼ºç‚¹** |
|---------|------------|-------------|-----------|
| ðŸ”„ **ä¸»ä»Žå¤åˆ¶** | `ä¸€ä¸ªä¸»åº“ï¼Œå¤šä¸ªä»Žåº“` | `è¯»å¤šå†™å°‘åœºæ™¯` | `ç®€å•æ˜“ç”¨ï¼Œä½†ä¸»åº“å•ç‚¹` |
| âš–ï¸ **åŒä¸»äº’å¤‡** | `ä¸¤ä¸ªä¸»åº“äº’ç›¸å¤‡ä»½` | `é«˜å¯ç”¨è¦æ±‚è¾ƒé«˜` | `é¿å…å•ç‚¹ï¼Œä½†é…ç½®å¤æ‚` |
| ðŸŒ **é›†ç¾¤æ¨¡å¼** | `å¤šä¸ªèŠ‚ç‚¹ç»„æˆé›†ç¾¤` | `å¤§åž‹ä¼ä¸šåº”ç”¨` | `æ€§èƒ½å¼ºï¼Œæˆæœ¬é«˜` |

### 1.3 é«˜å¯ç”¨çš„æ ¸å¿ƒè¦ç´ 


**ðŸŽ¯ æ ¸å¿ƒç»„ä»¶æž¶æž„å›¾**
```
é«˜å¯ç”¨MySQLæž¶æž„ç»„æˆï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            åº”ç”¨å±‚                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         è´Ÿè½½å‡è¡¡å™¨                   â”‚ â† åˆ†å‘è¯»å†™è¯·æ±‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸»åº“(Master)  â”‚  ä»Žåº“(Slave1,2...) â”‚ â† æ•°æ®åŒæ­¥
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         GTIDäº‹åŠ¡ç®¡ç†                 â”‚ â† ä¿è¯æ•°æ®ä¸€è‡´æ€§
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         ç›‘æŽ§ä¸Žæ•…éšœåˆ‡æ¢               â”‚ â† è‡ªåŠ¨æ•…éšœå¤„ç†
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ðŸ”¢ GTIDå…¨å±€äº‹åŠ¡æ ‡è¯†ç¬¦è¯¦è§£


### 2.1 GTIDæ˜¯ä»€ä¹ˆ


**ðŸ’¡ GTIDæ ¸å¿ƒå®šä¹‰**
```
GTIDï¼ˆGlobal Transaction Identifierï¼‰ï¼šå…¨å±€äº‹åŠ¡æ ‡è¯†ç¬¦
ä½œç”¨ï¼šç»™æ¯ä¸ªäº‹åŠ¡åˆ†é…ä¸€ä¸ªå…¨çƒå”¯ä¸€çš„IDå·
æ ¼å¼ï¼šserver_uuid:transaction_id
ç¤ºä¾‹ï¼š3E11FA47-71CA-11E1-9E33-C80AA9429562:1
```

**ðŸ  ç”Ÿæ´»ç±»æ¯”**
> GTIDå°±åƒå¿«é€’å•å·ï¼Œæ¯ä¸ªåŒ…è£¹ï¼ˆäº‹åŠ¡ï¼‰éƒ½æœ‰ä¸€ä¸ªå…¨çƒå”¯ä¸€çš„ç¼–å·ã€‚æ— è®ºåŒ…è£¹åœ¨å“ªä¸ªç½‘ç‚¹ï¼ˆæœåŠ¡å™¨ï¼‰ï¼Œéƒ½èƒ½é€šè¿‡è¿™ä¸ªç¼–å·å‡†ç¡®è·Ÿè¸ªã€‚

### 2.2 GTIDè§£å†³çš„é—®é¢˜


**âš ï¸ ä¼ ç»Ÿå¤åˆ¶çš„é—®é¢˜**
```
ä¼ ç»ŸåŸºäºŽä½ç½®çš„å¤åˆ¶ï¼š
é—®é¢˜1ï¼šéœ€è¦è®°ä½binlogæ–‡ä»¶åå’Œä½ç½®
é—®é¢˜2ï¼šä¸»ä»Žåˆ‡æ¢æ—¶ä½ç½®å¯èƒ½å¯¹ä¸ä¸Š
é—®é¢˜3ï¼šå¤šä¸ªä»Žåº“åŒæ­¥å¤æ‚

GTIDå¤åˆ¶çš„ä¼˜åŠ¿ï¼š
âœ… è‡ªåŠ¨å®šä½ï¼šä¸éœ€è¦æ‰‹åŠ¨æŒ‡å®šä½ç½®
âœ… ç®€åŒ–åˆ‡æ¢ï¼šæ–°ä¸»åº“è‡ªåŠ¨ç»§ç»­
âœ… æ•°æ®ä¸€è‡´ï¼šä¿è¯äº‹åŠ¡å®Œæ•´æ€§
```

### 2.3 GTIDçš„å·¥ä½œæµç¨‹


**ðŸ”„ GTIDäº‹åŠ¡å¤„ç†æµç¨‹**
```
GTIDäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ï¼š

ä¸»åº“ç«¯ï¼š
å®¢æˆ·ç«¯ â”€â”€SQLâ”€â”€> ä¸»åº“ â”€â”€ç”ŸæˆGTIDâ”€â”€> å†™å…¥binlog
  â†‘                â†“
åº”ç”¨ç¡®è®¤ <â”€â”€â”€â”€â”€â”€â”€â”€ äº‹åŠ¡æäº¤

ä»Žåº“ç«¯ï¼š
ä¸»åº“binlog â”€â”€è¯»å–â”€â”€> ä»Žåº“ â”€â”€æ£€æŸ¥GTIDâ”€â”€> æ‰§è¡Œäº‹åŠ¡
     â†“                      â†“
  GTIDè®°å½• <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ›´æ–°gtid_executed
```

**ðŸ“ è¯¦ç»†æ‰§è¡Œæ­¥éª¤**
1. **äº‹åŠ¡å¼€å§‹**ï¼šä¸»åº“æ”¶åˆ°SQLè¯­å¥
2. **åˆ†é…GTID**ï¼šç”Ÿæˆå”¯ä¸€çš„GTIDæ ‡è¯†
3. **è®°å½•æ—¥å¿—**ï¼šå°†GTIDå’ŒSQLå†™å…¥binlog
4. **ä¼ è¾“åˆ°ä»Žåº“**ï¼šä»Žåº“è¯»å–binlogå†…å®¹
5. **æ£€æŸ¥é‡å¤**ï¼šä»Žåº“æ£€æŸ¥è¯¥GTIDæ˜¯å¦å·²æ‰§è¡Œ
6. **æ‰§è¡Œäº‹åŠ¡**ï¼šå¦‚æžœæ²¡æ‰§è¡Œè¿‡ï¼Œåˆ™æ‰§è¡Œå¹¶è®°å½•

---

## 3. âš™ï¸ æ ¸å¿ƒGTIDé…ç½®å‚æ•°


### 3.1 GTIDæ¨¡å¼é…ç½®


#### ðŸ”§ gtid_modeå‚æ•°è¯¦è§£


**ðŸ“‹ é…ç½®è¯´æ˜Ž**
```ini
# GTIDæ¨¡å¼è®¾ç½®
gtid_mode = ON

# å¯é€‰å€¼è¯´æ˜Žï¼š
# OFF        - å®Œå…¨å…³é—­GTID
# OFF_PERMISSIVE - å…³é—­ä½†å…è®¸GTIDäº‹åŠ¡
# ON_PERMISSIVE  - å¼€å¯ä½†å…è®¸éžGTIDäº‹åŠ¡  
# ON         - å®Œå…¨å¼€å¯GTIDï¼ˆæŽ¨èï¼‰
```

**ðŸ’¡ æ¨¡å¼åˆ‡æ¢ç­–ç•¥**
```
GTIDå¯ç”¨çš„å®‰å…¨è·¯å¾„ï¼š
OFF â†’ OFF_PERMISSIVE â†’ ON_PERMISSIVE â†’ ON

ä¸ºä»€ä¹ˆè¦åˆ†æ­¥éª¤ï¼Ÿ
1. é¿å…ä¸»ä»Žæ•°æ®ä¸ä¸€è‡´
2. ç¡®ä¿æ‰€æœ‰ä»Žåº“éƒ½æ”¯æŒGTID
3. å¹³æ»‘è¿‡æ¸¡ï¼Œä¸å½±å“ä¸šåŠ¡
```

#### ðŸ”§ enforce_gtid_consistencyå‚æ•°


**ðŸ“‹ GTIDä¸€è‡´æ€§å¼ºåˆ¶**
```ini
# å¼ºåˆ¶GTIDä¸€è‡´æ€§
enforce_gtid_consistency = ON

# ä½œç”¨ï¼š
# - ç¦æ­¢åœ¨äº‹åŠ¡ä¸­ä½¿ç”¨CREATE TABLE ... SELECT
# - ç¦æ­¢åœ¨äº‹åŠ¡ä¸­ä½¿ç”¨CREATE TEMPORARY TABLE
# - ç¦æ­¢åœ¨äº‹åŠ¡ä¸­æ‰§è¡ŒDDLå’ŒDMLæ··åˆæ“ä½œ
```

**âš ï¸ å¸¸è§é™åˆ¶è¯´æ˜Ž**
```sql
-- âŒ è¿™äº›æ“ä½œåœ¨GTIDæ¨¡å¼ä¸‹è¢«ç¦æ­¢ï¼š

-- äº‹åŠ¡ä¸­åˆ›å»ºä¸´æ—¶è¡¨
BEGIN;
CREATE TEMPORARY TABLE temp_data (id INT);
COMMIT;  -- ä¼šæŠ¥é”™

-- äº‹åŠ¡ä¸­æ··åˆDDLå’ŒDML
BEGIN;
UPDATE users SET name = 'test';
CREATE TABLE test_table (id INT);  -- ä¼šæŠ¥é”™
COMMIT;

-- âœ… æ­£ç¡®çš„åšæ³•ï¼š
-- å°†DDLå’ŒDMLåˆ†å¼€æ‰§è¡Œ
```

### 3.2 GTIDæ‰§è¡Œå’Œæ¸…ç†é…ç½®


#### ðŸ”§ gtid_executedå’Œgtid_purged


**ðŸ“‹ GTIDçŠ¶æ€ç®¡ç†**
```ini
# GTIDæ‰§è¡Œè®°å½•ï¼ˆåªè¯»å˜é‡ï¼Œç³»ç»Ÿç»´æŠ¤ï¼‰
# gtid_executed = è‡ªåŠ¨ç»´æŠ¤ï¼Œè®°å½•å·²æ‰§è¡Œçš„GTIDé›†åˆ

# GTIDæ¸…ç†è®¾ç½®ï¼ˆä¸»è¦ç”¨äºŽæ¢å¤åœºæ™¯ï¼‰
# SET GLOBAL gtid_purged = 'uuid:1-100';  -- æ‰‹åŠ¨è®¾ç½®å·²æ¸…ç†çš„GTID
```

**ðŸ” GTIDçŠ¶æ€æŸ¥çœ‹**
```sql
-- æŸ¥çœ‹å½“å‰å·²æ‰§è¡Œçš„GTID
SHOW GLOBAL VARIABLES LIKE 'gtid_executed';

-- æŸ¥çœ‹å·²æ¸…é™¤çš„GTID  
SHOW GLOBAL VARIABLES LIKE 'gtid_purged';

-- æŸ¥çœ‹GTIDæ¨¡å¼
SHOW GLOBAL VARIABLES LIKE 'gtid_mode';
```

#### ðŸ”§ gtid_executed_compression_period


**ðŸ“‹ GTIDåŽ‹ç¼©é…ç½®**
```ini
# GTIDæ‰§è¡Œè®°å½•åŽ‹ç¼©å‘¨æœŸï¼ˆäº‹åŠ¡æ•°ï¼‰
gtid_executed_compression_period = 1000

# å«ä¹‰ï¼š
# æ¯æ‰§è¡Œ1000ä¸ªäº‹åŠ¡åŽï¼ŒåŽ‹ç¼©ä¸€æ¬¡gtid_executedè¡¨
# ç›®çš„ï¼šå‡å°‘è¡¨å¤§å°ï¼Œæé«˜æŸ¥è¯¢æ€§èƒ½
# è®¾ç½®0è¡¨ç¤ºå…³é—­è‡ªåŠ¨åŽ‹ç¼©
```

**ðŸ’¡ åŽ‹ç¼©æœºåˆ¶è¯´æ˜Ž**
```
GTIDåŽ‹ç¼©çš„ä½œç”¨ï¼š

åŽ‹ç¼©å‰ï¼šgtid_executedè¡¨å¯èƒ½æœ‰1000è¡Œè®°å½•
uuid:1, uuid:2, uuid:3, ..., uuid:1000

åŽ‹ç¼©åŽï¼šåˆå¹¶ä¸ºä¸€è¡Œ
uuid:1-1000

å¥½å¤„ï¼š
- å‡å°‘å­˜å‚¨ç©ºé—´
- æé«˜æŸ¥è¯¢é€Ÿåº¦
- ä¼˜åŒ–å†…å­˜ä½¿ç”¨
```

### 3.3 GTIDæ¢å¤å’Œè·Ÿè¸ªé…ç½®


#### ðŸ”§ binlog_gtid_simple_recovery


**ðŸ“‹ ç®€å•GTIDæ¢å¤**
```ini
# å¯ç”¨ç®€å•GTIDæ¢å¤æ¨¡å¼
binlog_gtid_simple_recovery = ON

# ä½œç”¨ï¼š
# - å¯åŠ¨æ—¶åªè¯»å–æœ€æ–°çš„binlogæ–‡ä»¶æ¥æ¢å¤GTIDçŠ¶æ€
# - è€Œä¸æ˜¯æ‰«ææ‰€æœ‰binlogæ–‡ä»¶
# - å¤§å¤§åŠ å¿«MySQLå¯åŠ¨é€Ÿåº¦
```

**âš¡ æ€§èƒ½å¯¹æ¯”**
```
å¯åŠ¨æ—¶é—´å¯¹æ¯”ï¼ˆæœ‰100ä¸ªbinlogæ–‡ä»¶ï¼‰ï¼š

ç®€å•æ¢å¤ï¼ˆONï¼‰ï¼š
- åªè¯»å–æœ€æ–°çš„binlogæ–‡ä»¶
- å¯åŠ¨æ—¶é—´ï¼š5-10ç§’

å®Œæ•´æ¢å¤ï¼ˆOFFï¼‰ï¼š
- æ‰«ææ‰€æœ‰binlogæ–‡ä»¶
- å¯åŠ¨æ—¶é—´ï¼š2-5åˆ†é’Ÿ

æŽ¨èï¼šç”Ÿäº§çŽ¯å¢ƒå»ºè®®å¼€å¯
```

#### ðŸ”§ session_track_gtids


**ðŸ“‹ ä¼šè¯GTIDè·Ÿè¸ª**
```ini
# ä¼šè¯çº§åˆ«GTIDè·Ÿè¸ª
session_track_gtids = OWN_GTID

# å¯é€‰å€¼ï¼š
# OFF      - ä¸è·Ÿè¸ªGTID
# OWN_GTID - åªè·Ÿè¸ªå½“å‰ä¼šè¯çš„GTID
# ALL_GTIDS - è·Ÿè¸ªæ‰€æœ‰GTIDï¼ˆæ€§èƒ½å½±å“å¤§ï¼‰
```

**ðŸŽ¯ åº”ç”¨åœºæ™¯**
```
é€‚ç”¨æƒ…å†µï¼š
âœ… åº”ç”¨éœ€è¦çŸ¥é“äº‹åŠ¡çš„GTID
âœ… å®žçŽ°è‡ªå®šä¹‰çš„è¯»å†™åˆ†ç¦»é€»è¾‘
âœ… ç¡®ä¿è¯»å–åˆ°æœ€æ–°å†™å…¥çš„æ•°æ®

ä¸é€‚ç”¨ï¼š
âŒ æ™®é€šåº”ç”¨ï¼ˆå¢žåŠ ç½‘ç»œå¼€é”€ï¼‰
âŒ é«˜å¹¶å‘åœºæ™¯ï¼ˆæ€§èƒ½å½±å“ï¼‰
```

---

## 4. ðŸ”„ ä¸»ä»Žå¤åˆ¶é…ç½®è¯¦è§£


### 4.1 æœåŠ¡å™¨UUIDé…ç½®


#### ðŸ”§ server_uuidè¯¦è§£


**ðŸ“‹ æœåŠ¡å™¨å”¯ä¸€æ ‡è¯†**
```ini
# æœåŠ¡å™¨UUIDï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼Œé€šå¸¸ä¸éœ€è¦æ‰‹åŠ¨è®¾ç½®ï¼‰
# server_uuid = 3E11FA47-71CA-11E1-9E33-C80AA9429562

# UUIDç‰¹ç‚¹ï¼š
# - å…¨çƒå”¯ä¸€æ ‡è¯†ç¬¦
# - 128ä½é•¿åº¦
# - è‡ªåŠ¨ç”Ÿæˆå¹¶ä¿å­˜åœ¨dataç›®å½•çš„auto.cnfæ–‡ä»¶ä¸­
```

**ðŸ’¡ UUIDçš„é‡è¦æ€§**
```
ä¸ºä»€ä¹ˆéœ€è¦server_uuidï¼Ÿ

1. GTIDç”Ÿæˆï¼šGTID = server_uuid + äº‹åŠ¡åºå·
2. å¤åˆ¶è¯†åˆ«ï¼šåŒºåˆ†ä¸åŒçš„MySQLæœåŠ¡å™¨
3. é¿å…å†²çªï¼šé˜²æ­¢å¤åˆ¶çŽ¯è·¯å’Œæ•°æ®å†²çª

UUIDç”Ÿæˆä½ç½®ï¼š
ä¸»åº“ï¼š3E11FA47-71CA-11E1-9E33-C80AA9429562:1-100
ä»Žåº“ï¼š8B2E3D1A-85F2-11E1-9C33-D70AA9429562:1-50
```

**âš ï¸ UUIDæ³¨æ„äº‹é¡¹**
```
å¸¸è§é—®é¢˜å’Œè§£å†³ï¼š

é—®é¢˜1ï¼šå…‹éš†è™šæ‹ŸæœºåŽUUIDç›¸åŒ
è§£å†³ï¼šåˆ é™¤dataç›®å½•ä¸‹çš„auto.cnfæ–‡ä»¶ï¼Œé‡å¯MySQL

é—®é¢˜2ï¼šæ‰‹åŠ¨ä¿®æ”¹UUIDåŽå¤åˆ¶å¼‚å¸¸
è§£å†³ï¼šé‡æ–°é…ç½®ä¸»ä»Žå¤åˆ¶å…³ç³»

é—®é¢˜3ï¼šUUIDä¸¢å¤±å¯¼è‡´GTIDå¼‚å¸¸
è§£å†³ï¼šä»Žå¤‡ä»½æ¢å¤æˆ–é‡å»ºå¤åˆ¶å…³ç³»
```

### 4.2 ä¸»åº“ä¿¡æ¯é…ç½®


#### ðŸ”§ master_info_file


**ðŸ“‹ ä¸»åº“ä¿¡æ¯æ–‡ä»¶é…ç½®**
```ini
# ä¸»åº“ä¿¡æ¯å­˜å‚¨æ–¹å¼
master_info_repository = TABLE  # æŽ¨èä½¿ç”¨TABLEæ–¹å¼
relay_log_info_repository = TABLE

# ä¼ ç»Ÿæ–‡ä»¶æ–¹å¼ï¼ˆä¸æŽ¨èï¼‰
# master_info_file = master.info
```

**ðŸ“Š å­˜å‚¨æ–¹å¼å¯¹æ¯”**

| å­˜å‚¨æ–¹å¼ | **å¯é æ€§** | **æ€§èƒ½** | **ç»´æŠ¤æ€§** | **æŽ¨èåº¦** |
|---------|-----------|---------|-----------|-----------|
| ðŸ“ **FILE** | `æ™®é€š` | `è¾ƒå¿«` | `å¤æ‚` | `âŒ ä¸æŽ¨è` |
| ðŸ“‹ **TABLE** | `é«˜` | `ç¨æ…¢` | `ç®€å•` | `âœ… æŽ¨è` |

**ðŸ’¡ TABLEæ–¹å¼çš„ä¼˜åŠ¿**
```
ä¸ºä»€ä¹ˆæŽ¨èTABLEæ–¹å¼ï¼Ÿ

1. äº‹åŠ¡å®‰å…¨ï¼š
   - ä¸»åº“ä¿¡æ¯å’Œrelay logä¿¡æ¯åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­æ›´æ–°
   - é¿å…crashæ—¶çš„æ•°æ®ä¸ä¸€è‡´

2. å´©æºƒæ¢å¤ï¼š
   - ä¿¡æ¯å­˜å‚¨åœ¨InnoDBè¡¨ä¸­
   - å¯ä»¥åˆ©ç”¨InnoDBçš„crash recoveryæœºåˆ¶

3. ç»´æŠ¤ç®€å•ï¼š
   - å¯ä»¥ç”¨SQLæŸ¥è¯¢å¤åˆ¶çŠ¶æ€
   - æ–¹ä¾¿ç›‘æŽ§å’Œæ•…éšœæŽ’æŸ¥
```

---

## 5. ðŸ†” æœåŠ¡å™¨è¯†åˆ«é…ç½®


### 5.1 server_idé…ç½®è¯¦è§£


**ðŸ“‹ æœåŠ¡å™¨IDè®¾ç½®**
```ini
# æœåŠ¡å™¨IDé…ç½®ï¼ˆå¿…é¡»å”¯ä¸€ï¼‰
server_id = 1

# è§„åˆ’å»ºè®®ï¼š
# ä¸»åº“ï¼š1
# ä»Žåº“1ï¼š2  
# ä»Žåº“2ï¼š3
# ä¾æ­¤ç±»æŽ¨...
```

**ðŸŽ¯ server_idè§„åˆ’ç­–ç•¥**
```
å¤§åž‹çŽ¯å¢ƒçš„IDè§„åˆ’ï¼š

æŒ‰æœºæˆ¿åˆ’åˆ†ï¼š
æœºæˆ¿Aï¼š1001-1999
æœºæˆ¿Bï¼š2001-2999  
æœºæˆ¿Cï¼š3001-3999

æŒ‰ä¸šåŠ¡åˆ’åˆ†ï¼š
ç”¨æˆ·åº“ï¼š1001-1099
è®¢å•åº“ï¼š1101-1199
å•†å“åº“ï¼š1201-1299

æŒ‰è§’è‰²åˆ’åˆ†ï¼š
ä¸»åº“ï¼šX001
ä»Žåº“ï¼šX002, X003, X004
```

**âš ï¸ å¸¸è§é…ç½®é”™è¯¯**
```
é¿å…è¿™äº›é”™è¯¯ï¼š

âŒ server_idç›¸åŒï¼š
ä¸»åº“å’Œä»Žåº“ä½¿ç”¨ç›¸åŒçš„server_idä¼šå¯¼è‡´å¤åˆ¶å¼‚å¸¸

âŒ server_idä¸º0ï¼š
server_id=0è¡¨ç¤ºè¯¥æœåŠ¡å™¨ä¸å‚ä¸Žå¤åˆ¶

âŒ åŠ¨æ€ä¿®æ”¹server_idï¼š
è¿è¡Œä¸­ä¿®æ”¹server_idå¯èƒ½å¯¼è‡´å¤åˆ¶ä¸­æ–­

âœ… æ­£ç¡®åšæ³•ï¼š
- è§„åˆ’å¥½IDåˆ†é…
- é…ç½®æ–‡ä»¶ä¸­å›ºå®šè®¾ç½®
- é¿å…è¿è¡Œæ—¶ä¿®æ”¹
```

---

## 6. ðŸ›¡ï¸ æ ¡éªŒå’Œå®‰å…¨é…ç½®


### 6.1 ä¸»åº“æ ¡éªŒå’Œé…ç½®


#### ðŸ”§ master_verify_checksum


**ðŸ“‹ ä¸»åº“æ ¡éªŒå’ŒéªŒè¯**
```ini
# ä¸»åº“è¯»å–binlogæ—¶éªŒè¯æ ¡éªŒå’Œ
master_verify_checksum = ON

# ä½œç”¨ï¼š
# - éªŒè¯binlogäº‹ä»¶çš„å®Œæ•´æ€§
# - æ£€æµ‹binlogæ˜¯å¦æŸå
# - æé«˜æ•°æ®ä¼ è¾“å¯é æ€§
```

**ðŸ” æ ¡éªŒå’Œå·¥ä½œåŽŸç†**
```
æ ¡éªŒå’ŒéªŒè¯æµç¨‹ï¼š

1. å†™å…¥binlogæ—¶ï¼š
   ä¸»åº“è®¡ç®—æ¯ä¸ªäº‹ä»¶çš„æ ¡éªŒå’Œå¹¶å­˜å‚¨

2. è¯»å–binlogæ—¶ï¼š
   é‡æ–°è®¡ç®—æ ¡éªŒå’Œå¹¶ä¸Žå­˜å‚¨çš„å€¼æ¯”è¾ƒ

3. æ ¡éªŒå¤±è´¥æ—¶ï¼š
   æŠ¥é”™å¹¶åœæ­¢å¤åˆ¶ï¼Œé˜²æ­¢æŸåæ•°æ®ä¼ æ’­

æ ¡éªŒå’Œç®—æ³•ï¼šCRC32
```

### 6.2 ä»Žåº“æ ¡éªŒå’Œé…ç½®


#### ðŸ”§ slave_sql_verify_checksum


**ðŸ“‹ ä»Žåº“SQLæ ¡éªŒå’ŒéªŒè¯**
```ini
# ä»Žåº“æ‰§è¡ŒSQLå‰éªŒè¯æ ¡éªŒå’Œ
slave_sql_verify_checksum = ON

# ä½œç”¨ï¼š
# - éªŒè¯ä»Žä¸»åº“æŽ¥æ”¶çš„äº‹ä»¶å®Œæ•´æ€§
# - æ£€æµ‹ç½‘ç»œä¼ è¾“ä¸­çš„æ•°æ®æŸå
# - ç¡®ä¿ä»Žåº“æ•°æ®å‡†ç¡®æ€§
```

**ðŸŽ¯ æ ¡éªŒå’Œé…ç½®ç»„åˆ**
```
æŽ¨èçš„æ ¡éªŒå’Œé…ç½®ï¼š

ä¸»åº“ç«¯ï¼š
master_verify_checksum = ON     # è¯»å–æœ¬åœ°binlogæ—¶éªŒè¯
binlog_checksum = CRC32         # å†™å…¥binlogæ—¶ç”Ÿæˆæ ¡éªŒå’Œ

ä»Žåº“ç«¯ï¼š
slave_sql_verify_checksum = ON  # æ‰§è¡ŒSQLå‰éªŒè¯
master_verify_checksum = ON     # è¯»å–relay logæ—¶éªŒè¯
```

**ðŸ“Š æ€§èƒ½ä¸Žå®‰å…¨å¹³è¡¡**
```
æ ¡éªŒå’Œå¼€é”€åˆ†æžï¼š

æ€§èƒ½å½±å“ï¼š
- CPUå¼€é”€ï¼šçº¦1-3%
- ç½‘ç»œå¼€é”€ï¼šæ¯ä¸ªäº‹ä»¶å¢žåŠ 4å­—èŠ‚
- IOå¼€é”€ï¼šé¢å¤–çš„æ ¡éªŒè®¡ç®—

å®‰å…¨æ”¶ç›Šï¼š
- æ£€æµ‹ç¡¬ä»¶æ•…éšœ
- å‘çŽ°ç½‘ç»œé”™è¯¯  
- é¿å…æ•°æ®æŸå

ç»“è®ºï¼šç”Ÿäº§çŽ¯å¢ƒå»ºè®®å…¨éƒ¨å¼€å¯
```

### 6.3 æäº¤é¡ºåºæŽ§åˆ¶


#### ðŸ”§ binlog_order_commits


**ðŸ“‹ äºŒè¿›åˆ¶æ—¥å¿—æäº¤é¡ºåº**
```ini
# æŽ§åˆ¶binlogæäº¤é¡ºåº
binlog_order_commits = ON

# ä½œç”¨ï¼š
# - ä¿è¯binlogä¸­äº‹åŠ¡çš„æäº¤é¡ºåº
# - ç¡®ä¿ä¸»ä»Žå¤åˆ¶çš„ä¸€è‡´æ€§
# - ç»´æŠ¤äº‹åŠ¡çš„å¯ä¸²è¡ŒåŒ–
```

**ðŸ”„ æäº¤é¡ºåºçš„é‡è¦æ€§**
```
ä¸ºä»€ä¹ˆéœ€è¦æŽ§åˆ¶æäº¤é¡ºåºï¼Ÿ

åœºæ™¯ï¼šä¸¤ä¸ªå¹¶å‘äº‹åŠ¡T1å’ŒT2

ä¸»åº“æ‰§è¡Œé¡ºåºï¼šT1æäº¤ â†’ T2æäº¤
binlogè®°å½•ï¼šT1 â†’ T2

å¦‚æžœä¸æŽ§åˆ¶é¡ºåºï¼š
ä»Žåº“å¯èƒ½çœ‹åˆ°ï¼šT2 â†’ T1
å¯¼è‡´ï¼šä¸»ä»Žæ•°æ®ä¸ä¸€è‡´

å¼€å¯binlog_order_commitsï¼š
ä»Žåº“ä¸¥æ ¼æŒ‰ç…§ï¼šT1 â†’ T2 æ‰§è¡Œ
ä¿è¯ï¼šä¸»ä»Žæ•°æ®å®Œå…¨ä¸€è‡´
```

**âš¡ æ€§èƒ½å½±å“åˆ†æž**
```
binlog_order_commitsæ€§èƒ½å½±å“ï¼š

å¼€å¯æ—¶ï¼ˆONï¼‰ï¼š
- ç¡®ä¿æäº¤é¡ºåºï¼Œå¹¶å‘åº¦ç¨é™
- é«˜å¹¶å‘ä¸‹æœ‰ä¸€å®šæ€§èƒ½å½±å“
- æ•°æ®ä¸€è‡´æ€§æœ€é«˜

å…³é—­æ—¶ï¼ˆOFFï¼‰ï¼š
- æäº¤é¡ºåºå¯èƒ½ä¹±åºï¼Œå¹¶å‘åº¦é«˜
- æ€§èƒ½ç•¥æœ‰æå‡
- å¯èƒ½å¯¼è‡´ä¸»ä»Žä¸ä¸€è‡´

æŽ¨èè®¾ç½®ï¼š
ç”Ÿäº§çŽ¯å¢ƒï¼šONï¼ˆæ•°æ®ä¸€è‡´æ€§ä¼˜å…ˆï¼‰
æµ‹è¯•çŽ¯å¢ƒï¼šå¯ä»¥OFFï¼ˆæ€§èƒ½ä¼˜å…ˆï¼‰
```

---

## 7. ðŸš€ å®žé™…é…ç½®åº”ç”¨æ¡ˆä¾‹


### 7.1 æ ‡å‡†ä¸»ä»Žé…ç½®ç¤ºä¾‹


**ðŸ”§ ä¸»åº“é…ç½®æ–‡ä»¶ï¼ˆmy.cnfï¼‰**
```ini
[mysqld]
# åŸºç¡€é…ç½®
server_id = 1
port = 3306

# GTIDé…ç½®
gtid_mode = ON
enforce_gtid_consistency = ON
binlog_gtid_simple_recovery = ON

# äºŒè¿›åˆ¶æ—¥å¿—é…ç½®
log_bin = mysql-bin
binlog_format = ROW
binlog_checksum = CRC32
binlog_order_commits = ON

# ä¸»åº“æ ¡éªŒå’Œ
master_verify_checksum = ON

# å¤åˆ¶ä¿¡æ¯å­˜å‚¨
master_info_repository = TABLE
relay_log_info_repository = TABLE

# GTIDç®¡ç†
gtid_executed_compression_period = 1000
session_track_gtids = OFF
```

**ðŸ”§ ä»Žåº“é…ç½®æ–‡ä»¶ï¼ˆmy.cnfï¼‰**
```ini
[mysqld]
# åŸºç¡€é…ç½®
server_id = 2
port = 3306

# GTIDé…ç½®
gtid_mode = ON
enforce_gtid_consistency = ON
binlog_gtid_simple_recovery = ON

# ä»Žåº“ä¸“ç”¨é…ç½®
read_only = ON
super_read_only = ON

# æ ¡éªŒå’Œé…ç½®
slave_sql_verify_checksum = ON
master_verify_checksum = ON

# å¤åˆ¶ä¿¡æ¯å­˜å‚¨
master_info_repository = TABLE
relay_log_info_repository = TABLE

# ä¸­ç»§æ—¥å¿—é…ç½®
relay_log = relay-bin
relay_log_checksum = CRC32

# GTIDç®¡ç†
gtid_executed_compression_period = 1000
```

### 7.2 é«˜å¯ç”¨é›†ç¾¤é…ç½®


**ðŸŒ åŒä¸»äº’å¤‡é…ç½®æž¶æž„**
```
åŒä¸»äº’å¤‡æž¶æž„ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    åŒå‘å¤åˆ¶    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ä¸»åº“A     â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’   â”‚   ä¸»åº“B     â”‚
â”‚ server_id=1 â”‚               â”‚ server_id=2 â”‚
â”‚   å†™å…¥      â”‚               â”‚   å¤‡ç”¨      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                             â”‚
       â†“                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ä»Žåº“A1    â”‚               â”‚   ä»Žåº“B1    â”‚
â”‚ server_id=3 â”‚               â”‚ server_id=4 â”‚
â”‚   åªè¯»      â”‚               â”‚   åªè¯»      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ðŸ”§ åŒä¸»é…ç½®è¦ç‚¹**
```ini
# ä¸»åº“Aé…ç½®
[mysqld]
server_id = 1
auto_increment_increment = 2  # è‡ªå¢žæ­¥é•¿
auto_increment_offset = 1     # è‡ªå¢žåç§»

# GTIDé…ç½®
gtid_mode = ON
enforce_gtid_consistency = ON

# é¿å…å¤åˆ¶çŽ¯è·¯
log_slave_updates = ON
replicate_same_server_id = OFF

# ä¸»åº“Bé…ç½®  
[mysqld]
server_id = 2
auto_increment_increment = 2  # è‡ªå¢žæ­¥é•¿
auto_increment_offset = 2     # è‡ªå¢žåç§»

# å…¶ä»–é…ç½®ä¸Žä¸»åº“Aç›¸åŒ
```

### 7.3 æ•…éšœåˆ‡æ¢é…ç½®


**ðŸ”„ è‡ªåŠ¨æ•…éšœåˆ‡æ¢é…ç½®**
```ini
# ä»Žåº“æ•…éšœåˆ‡æ¢é…ç½®
[mysqld]
# ä¸»åº“å¤±æ•ˆæ£€æµ‹
slave_net_timeout = 30
master_retry_count = 3

# è‡ªåŠ¨åˆ‡æ¢ç›¸å…³
relay_log_recovery = ON
relay_log_purge = ON

# GTIDè‡ªåŠ¨å®šä½
master_auto_position = ON

# å¹¶è¡Œå¤åˆ¶é…ç½®
slave_parallel_type = LOGICAL_CLOCK
slave_parallel_workers = 4
slave_preserve_commit_order = ON
```

**ðŸ“ åˆ‡æ¢æ“ä½œæµç¨‹**
```sql
-- 1. æ£€æŸ¥ä»Žåº“çŠ¶æ€
SHOW SLAVE STATUS\G

-- 2. åœæ­¢å¤åˆ¶
STOP SLAVE;

-- 3. æå‡ä»Žåº“ä¸ºä¸»åº“
SET GLOBAL read_only = OFF;
SET GLOBAL super_read_only = OFF;

-- 4. é…ç½®æ–°çš„ä»Žåº“æŒ‡å‘æ–°ä¸»åº“
CHANGE MASTER TO
    MASTER_HOST = 'new_master_ip',
    MASTER_USER = 'repl_user',
    MASTER_PASSWORD = 'password',
    MASTER_AUTO_POSITION = 1;

-- 5. å¯åŠ¨å¤åˆ¶
START SLAVE;
```

### 7.4 ç›‘æŽ§å’Œç»´æŠ¤é…ç½®


**ðŸ“Š GTIDçŠ¶æ€ç›‘æŽ§**
```sql
-- ç›‘æŽ§GTIDçŠ¶æ€çš„å¸¸ç”¨æŸ¥è¯¢

-- 1. æŸ¥çœ‹GTIDæ¨¡å¼å’Œä¸€è‡´æ€§
SHOW GLOBAL VARIABLES LIKE 'gtid%';
SHOW GLOBAL VARIABLES LIKE 'enforce_gtid_consistency';

-- 2. æŸ¥çœ‹å·²æ‰§è¡Œçš„GTID
SELECT $$GLOBAL.gtid_executed;

-- 3. æŸ¥çœ‹å¤åˆ¶çŠ¶æ€
SHOW SLAVE STATUS\G

-- 4. æŸ¥çœ‹GTIDç›¸å…³çš„æ€§èƒ½æŒ‡æ ‡
SELECT * FROM performance_schema.replication_group_members;
```

**ðŸ”§ è‡ªåŠ¨åŒ–ç»´æŠ¤è„šæœ¬**
```bash
#!/bin/bash
# GTIDå¤åˆ¶ç›‘æŽ§è„šæœ¬

# æ£€æŸ¥GTIDæ¨¡å¼
gtid_mode=$(mysql -e "SELECT $$gtid_mode" -s -N)
if [ "$gtid_mode" != "ON" ]; then
    echo "è­¦å‘Šï¼šGTIDæ¨¡å¼æœªå¼€å¯"
fi

# æ£€æŸ¥å¤åˆ¶å»¶è¿Ÿ
delay=$(mysql -e "SHOW SLAVE STATUS\G" | grep "Seconds_Behind_Master" | awk '{print $2}')
if [ "$delay" -gt 10 ]; then
    echo "è­¦å‘Šï¼šå¤åˆ¶å»¶è¿Ÿ ${delay} ç§’"
fi

# æ£€æŸ¥GTIDä¸€è‡´æ€§
executed=$(mysql -e "SELECT $$gtid_executed" -s -N)
echo "å·²æ‰§è¡ŒGTIDï¼š$executed"
```

---

## 8. ðŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŽŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ðŸ”¸ GTIDæœ¬è´¨ï¼šå…¨å±€å”¯ä¸€çš„äº‹åŠ¡æ ‡è¯†ç¬¦ï¼Œç®€åŒ–å¤åˆ¶ç®¡ç†
ðŸ”¸ é«˜å¯ç”¨æž¶æž„ï¼šé€šè¿‡å¤šæœåŠ¡å™¨ååŒä¿è¯æœåŠ¡è¿žç»­æ€§
ðŸ”¸ é…ç½®å±‚æ¬¡ï¼šåŸºç¡€é…ç½® â†’ GTIDé…ç½® â†’ å®‰å…¨é…ç½® â†’ ç›‘æŽ§é…ç½®
ðŸ”¸ æ•…éšœåˆ‡æ¢ï¼šåŸºäºŽGTIDçš„è‡ªåŠ¨å®šä½å’Œå¿«é€Ÿæ¢å¤
ðŸ”¸ æ•°æ®ä¸€è‡´æ€§ï¼šé€šè¿‡æ ¡éªŒå’Œå’Œæäº¤é¡ºåºä¿è¯
```

### 8.2 å…³é”®é…ç½®ç†è§£è¦ç‚¹


**ðŸ”¹ GTIDé…ç½®çš„æ ¸å¿ƒé€»è¾‘**
```
GTIDå¯ç”¨ä¸‰æ­¥èµ°ï¼š
1. åŸºç¡€è®¾ç½®ï¼šgtid_mode = ON
2. ä¸€è‡´æ€§å¼ºåˆ¶ï¼šenforce_gtid_consistency = ON  
3. ä¼˜åŒ–é…ç½®ï¼šåŽ‹ç¼©ã€æ¢å¤ã€è·Ÿè¸ªç­‰

è®°å¿†å£è¯€ï¼š
"æ¨¡å¼ä¸€è‡´è¦å¼€å¯ï¼Œæ¢å¤åŽ‹ç¼©æ¥ä¼˜åŒ–"
```

**ðŸ”¹ å¤åˆ¶é…ç½®çš„å®‰å…¨ä¿éšœ**
```
æ•°æ®å®‰å…¨å››é‡ä¿æŠ¤ï¼š
1. server_uuidï¼šå”¯ä¸€æ ‡è¯†é˜²å†²çª
2. æ ¡éªŒå’ŒéªŒè¯ï¼šé˜²æ­¢æ•°æ®æŸå
3. æäº¤é¡ºåºï¼šä¿è¯ä¸€è‡´æ€§  
4. GTIDç®¡ç†ï¼šç®€åŒ–è¿ç»´

è®°å¿†è¦ç‚¹ï¼š
"å”¯ä¸€æ ¡éªŒä¿é¡ºåºï¼ŒGTIDç®¡ç†æœ€è½»æ¾"
```

**ðŸ”¹ æ€§èƒ½ä¸Žå®‰å…¨çš„å¹³è¡¡**
```
é…ç½®æƒè¡¡è€ƒè™‘ï¼š
- æ ¡éªŒå’Œï¼šå®‰å…¨vsæ€§èƒ½ï¼ˆå»ºè®®å¼€å¯ï¼‰
- æäº¤é¡ºåºï¼šä¸€è‡´æ€§vså¹¶å‘ï¼ˆå»ºè®®å¼€å¯ï¼‰
- GTIDåŽ‹ç¼©ï¼šç©ºé—´vsé¢‘çŽ‡ï¼ˆæ ¹æ®è´Ÿè½½è°ƒæ•´ï¼‰
- å¹¶è¡Œå¤åˆ¶ï¼šé€Ÿåº¦vsèµ„æºï¼ˆæ ¹æ®ç¡¬ä»¶é…ç½®ï¼‰
```

### 8.3 å®žé™…åº”ç”¨æŒ‡å¯¼


**ðŸŽ¯ é…ç½®é€‰æ‹©ç­–ç•¥**
```
ç”Ÿäº§çŽ¯å¢ƒé…ç½®åŽŸåˆ™ï¼š
âœ… å®‰å…¨ä¼˜å…ˆï¼šæ‰€æœ‰æ ¡éªŒå’ŒåŠŸèƒ½å¼€å¯
âœ… ä¸€è‡´æ€§ä¿è¯ï¼šGTIDå’Œæäº¤é¡ºåºæŽ§åˆ¶
âœ… ç›‘æŽ§å®Œå–„ï¼šçŠ¶æ€è·Ÿè¸ªå’Œè‡ªåŠ¨å‘Šè­¦
âœ… æ•…éšœæ¢å¤ï¼šè‡ªåŠ¨å®šä½å’Œå¿«é€Ÿåˆ‡æ¢

å¼€å‘æµ‹è¯•çŽ¯å¢ƒï¼š
ðŸ”¸ å¯é€‚å½“å…³é—­éƒ¨åˆ†æ ¡éªŒåŠŸèƒ½æå‡æ€§èƒ½
ðŸ”¸ ç®€åŒ–é…ç½®ä¾¿äºŽå¿«é€Ÿéƒ¨ç½²
ðŸ”¸ é‡ç‚¹æµ‹è¯•æ•…éšœåˆ‡æ¢æµç¨‹
```

**ðŸ”§ è¿ç»´æœ€ä½³å®žè·µ**
```
æ—¥å¸¸ç»´æŠ¤è¦ç‚¹ï¼š
1. å®šæœŸæ£€æŸ¥GTIDçŠ¶æ€å’Œå¤åˆ¶å»¶è¿Ÿ
2. ç›‘æŽ§binlogå¤§å°å’Œæ¸…ç†ç­–ç•¥
3. æµ‹è¯•æ•…éšœåˆ‡æ¢æµç¨‹
4. å¤‡ä»½é…ç½®æ–‡ä»¶å’ŒGTIDçŠ¶æ€
5. æ–‡æ¡£åŒ–æ‰€æœ‰é…ç½®å˜æ›´

æ•…éšœå¤„ç†æµç¨‹ï¼š
1. å¿«é€Ÿè¯Šæ–­ï¼šæ£€æŸ¥å¤åˆ¶çŠ¶æ€å’ŒGTID
2. å†³ç­–åˆ‡æ¢ï¼šè¯„ä¼°æ•°æ®å®Œæ•´æ€§
3. æ‰§è¡Œåˆ‡æ¢ï¼šä½¿ç”¨GTIDè‡ªåŠ¨å®šä½
4. éªŒè¯ç»“æžœï¼šç¡®è®¤æ•°æ®ä¸€è‡´æ€§
5. äº‹åŽåˆ†æžï¼šæ€»ç»“ç»éªŒæ”¹è¿›é…ç½®
```

### 8.4 å­¦ä¹ è¿›é˜¶è·¯å¾„


**ðŸ“ˆ çŸ¥è¯†æ·±åŒ–æ–¹å‘**
```
åŸºç¡€æŽŒæ¡åŽçš„è¿›é˜¶å­¦ä¹ ï¼š

1. é«˜çº§å¤åˆ¶æŠ€æœ¯ï¼š
   - å¤šæºå¤åˆ¶é…ç½®
   - åŸºäºŽç»„çš„å¤åˆ¶ï¼ˆMGRï¼‰
   - åŠåŒæ­¥å¤åˆ¶ä¼˜åŒ–

2. æ€§èƒ½è°ƒä¼˜ï¼š
   - å¹¶è¡Œå¤åˆ¶å‚æ•°è°ƒä¼˜
   - binlogç›¸å…³å‚æ•°ä¼˜åŒ–
   - ç½‘ç»œå’Œå­˜å‚¨ä¼˜åŒ–

3. ç›‘æŽ§ä¸Žè‡ªåŠ¨åŒ–ï¼š
   - Prometheus + Grafanaç›‘æŽ§
   - è‡ªåŠ¨åŒ–æ•…éšœåˆ‡æ¢å·¥å…·
   - é…ç½®ç®¡ç†è‡ªåŠ¨åŒ–

4. æ•…éšœæŽ’æŸ¥ï¼š
   - å¤åˆ¶ä¸­æ–­é—®é¢˜è¯Šæ–­
   - GTIDä¸ä¸€è‡´å¤„ç†
   - æ€§èƒ½ç“¶é¢ˆåˆ†æž
```

**ðŸ’¡ å…³é”®ç†è§£æ€»ç»“**
```
MySQLé«˜å¯ç”¨é…ç½®çš„æœ¬è´¨ï¼š
é€šè¿‡GTIDæŠ€æœ¯ç®€åŒ–å¤åˆ¶ç®¡ç†ï¼Œç”¨æ ¡éªŒå’Œä¿è¯æ•°æ®å®‰å…¨ï¼Œ
é€šè¿‡åˆç†çš„é…ç½®ç»„åˆå®žçŽ°è‡ªåŠ¨åŒ–çš„æ•…éšœæ£€æµ‹å’Œæ¢å¤ï¼Œ
æœ€ç»ˆè¾¾åˆ°ä¸šåŠ¡è¿žç»­æ€§å’Œæ•°æ®ä¸€è‡´æ€§çš„ç›®æ ‡ã€‚

æ ¸å¿ƒè®°å¿†ï¼š
"GTIDæ ‡è¯†äº‹åŠ¡æµï¼Œæ ¡éªŒä¿è¯æ•°æ®å‡†ï¼Œ
 é…ç½®åˆç†ä¿ƒé«˜ç”¨ï¼Œç›‘æŽ§ç»´æŠ¤ä¿å¹³å®‰"
```