---
title: 2、数值函数
---
## 📚 目录

1. [基础数学运算](#1-基础数学运算)
2. [舍入与取整函数](#2-舍入与取整函数)
3. [高级数学运算](#3-高级数学运算)
4. [核心要点总结](#4-核心要点总结)

---

## 1. 🧮 基础数学运算


### 1.1 ABS(x) - 绝对值函数


**🔸 基本概念**
```
绝对值就是数字到0的距离，永远是正数
ABS函数的作用：去掉数字前面的负号
```

**💡 通俗理解**
想象一下体重秤，不管你站正着还是倒着，显示的重量都是正数。ABS函数就像这个体重秤，不管输入的数字是正是负，输出的结果都是正数。

```sql
-- 基本用法示例
SELECT ABS(-5);        -- 结果：5
SELECT ABS(3.14);      -- 结果：3.14
SELECT ABS(-10.5);     -- 结果：10.5
SELECT ABS(0);         -- 结果：0

-- 实际应用：计算温差
SELECT 
    city,
    morning_temp,
    evening_temp,
    ABS(morning_temp - evening_temp) AS temp_difference
FROM weather_data;
```

**🎯 实际用途**
- 计算两个数值的差值（不关心正负）
- 数据清理：统一正负数格式
- 距离计算：求两点间的绝对距离

### 1.2 MOD(n,m) - 取模运算


**🔸 基本概念**
```
取模就是求除法的余数
比如：7除以3等于2余1，那么MOD(7,3)=1
```

**💡 通俗理解**
就像分糖果给小朋友，7颗糖分给3个小朋友，每人能分到2颗，还剩1颗。这个剩下的1就是取模的结果。

```sql
-- 基本用法示例
SELECT MOD(10, 3);     -- 结果：1 (10÷3=3余1)
SELECT MOD(15, 4);     -- 结果：3 (15÷4=3余3)
SELECT MOD(8, 2);      -- 结果：0 (8÷2=4余0，能整除)

-- 实际应用：判断奇偶数
SELECT 
    user_id,
    CASE 
        WHEN MOD(user_id, 2) = 0 THEN '偶数用户'
        ELSE '奇数用户'
    END AS user_type
FROM users;

-- 应用：数据分组（比如按星期几分组）
SELECT 
    order_id,
    MOD(order_id, 7) + 1 AS week_group
FROM orders;
```

**🎯 实际用途**
- 判断奇偶性：`MOD(数字, 2)`
- 数据分组：按余数分成几个组
- 循环处理：实现轮循效果

### 1.3 GREATEST(x1,x2,...) - 求最大值


**🔸 基本概念**
```
从多个数值中找出最大的那个
可以比较2个、3个或更多个数值
```

**💡 通俗理解**
就像在一群人中找最高的那个人，GREATEST函数会把所有数字排队，然后告诉你谁是老大。

```sql
-- 基本用法示例
SELECT GREATEST(10, 5, 8);          -- 结果：10
SELECT GREATEST(3.14, 2.71, 1.41);  -- 结果：3.14
SELECT GREATEST(-5, -10, -2);       -- 结果：-2

-- 实际应用：比较多个分数，取最高分
SELECT 
    student_name,
    math_score,
    english_score,
    science_score,
    GREATEST(math_score, english_score, science_score) AS highest_score
FROM student_grades;

-- 应用：确保数值不低于某个最小值
SELECT 
    product_name,
    original_price,
    GREATEST(original_price * 0.8, 10) AS final_price  -- 打8折但不低于10元
FROM products;
```

**🎯 实际用途**
- 多列数据比较：找出最大值
- 设置下限：确保结果不低于某个值
- 数据验证：检查多个条件的最大值

### 1.4 LEAST(x1,x2,...) - 求最小值


**🔸 基本概念**
```
从多个数值中找出最小的那个
与GREATEST相反，找的是最小值
```

**💡 通俗理解**
就像找一群人中年龄最小的，LEAST函数会把所有数字比较一遍，告诉你谁是最小的。

```sql
-- 基本用法示例
SELECT LEAST(10, 5, 8);          -- 结果：5
SELECT LEAST(3.14, 2.71, 1.41);  -- 结果：1.41
SELECT LEAST(-5, -10, -2);       -- 结果：-10

-- 实际应用：比较多个价格，选最便宜的
SELECT 
    product_name,
    store_a_price,
    store_b_price,
    store_c_price,
    LEAST(store_a_price, store_b_price, store_c_price) AS best_price
FROM price_comparison;

-- 应用：设置上限
SELECT 
    employee_name,
    base_salary,
    bonus,
    LEAST(bonus, base_salary * 0.5) AS final_bonus  -- 奖金不超过基本工资的50%
FROM employee_salary;
```

**🎯 实际用途**
- 多列数据比较：找出最小值
- 设置上限：确保结果不超过某个值
- 成本控制：选择最低成本方案

---

## 2. 🔢 舍入与取整函数


### 2.1 ROUND(x) - 四舍五入到整数


**🔸 基本概念**
```
按照四舍五入规则将小数变成整数
小数部分>=0.5就进位，<0.5就舍去
```

**💡 通俗理解**
就像我们平时说的"四舍五入"，比如3.4变成3，3.6变成4。这是我们从小学就会的数学规则。

```sql
-- 基本用法示例
SELECT ROUND(3.4);     -- 结果：3
SELECT ROUND(3.6);     -- 结果：4
SELECT ROUND(3.5);     -- 结果：4
SELECT ROUND(-2.3);    -- 结果：-2
SELECT ROUND(-2.7);    -- 结果：-3

-- 实际应用：处理平均分
SELECT 
    class_name,
    total_score,
    student_count,
    ROUND(total_score / student_count) AS average_score
FROM class_statistics;
```

**🎯 实际用途**
- 显示整数结果：避免小数点干扰
- 数据汇总：计算平均值后取整
- 报表展示：让数字更整齐

### 2.2 ROUND(x,d) - 指定精度四舍五入


**🔸 基本概念**
```
可以指定保留几位小数
d是小数位数，可以是正数、0或负数
```

**💡 通俗理解**
就像调节显微镜的精度，你可以选择看到小数点后几位。d=2就保留两位小数，d=-1就精确到十位数。

```sql
-- 基本用法示例
SELECT ROUND(3.14159, 2);    -- 结果：3.14（保留2位小数）
SELECT ROUND(3.14159, 0);    -- 结果：3（保留0位小数，等同于ROUND(x)）
SELECT ROUND(1234.56, -1);   -- 结果：1230（精确到十位）
SELECT ROUND(1234.56, -2);   -- 结果：1200（精确到百位）

-- 实际应用：金额计算（保留2位小数）
SELECT 
    order_id,
    item_price,
    quantity,
    ROUND(item_price * quantity * 1.1, 2) AS total_with_tax
FROM order_items;

-- 应用：统计数据精确到千位
SELECT 
    region,
    ROUND(population, -3) AS population_thousands
FROM city_data;
```

**🎯 实际用途**
- 金额计算：保留两位小数
- 统计报表：控制数据精度
- 数据展示：让数字更易读

### 2.3 CEIL(x) - 向上取整


**🔸 基本概念**
```
总是向上取整，只要有小数部分就进位
也叫做"天花板函数"
```

**💡 通俗理解**
就像坐电梯，你在2.1层，电梯只停整数层，那就得到3层去。CEIL总是往上走，哪怕只差0.01也要到上一层。

```sql
-- 基本用法示例
SELECT CEIL(3.1);      -- 结果：4
SELECT CEIL(3.9);      -- 结果：4
SELECT CEIL(3.0);      -- 结果：3（已经是整数）
SELECT CEIL(-2.1);     -- 结果：-2（向上是趋向0的方向）
SELECT CEIL(-2.9);     -- 结果：-2

-- 实际应用：计算需要的页数
SELECT 
    total_records,
    records_per_page,
    CEIL(total_records / records_per_page) AS total_pages
FROM pagination_info;

-- 应用：包装计算（需要几个盒子）
SELECT 
    product_name,
    quantity,
    CEIL(quantity / 12) AS boxes_needed  -- 每盒装12个
FROM inventory;
```

**🎯 实际用途**
- 分页计算：确定总页数
- 包装计算：需要多少个容器
- 资源预算：确保资源充足

### 2.4 FLOOR(x) - 向下取整


**🔸 基本概念**
```
总是向下取整，直接砍掉小数部分
也叫做"地板函数"
```

**💡 通俗理解**
就像走楼梯，你在3.9层，但楼梯只能到整数层，那你现在实际在3层。FLOOR总是往下走，直接忽略小数部分。

```sql
-- 基本用法示例
SELECT FLOOR(3.1);     -- 结果：3
SELECT FLOOR(3.9);     -- 结果：3
SELECT FLOOR(3.0);     -- 结果：3
SELECT FLOOR(-2.1);    -- 结果：-3（向下是远离0的方向）
SELECT FLOOR(-2.9);    -- 结果：-3

-- 实际应用：计算完整的周期数
SELECT 
    employee_name,
    total_days,
    FLOOR(total_days / 7) AS complete_weeks
FROM attendance;

-- 应用：折扣计算（每满100减10）
SELECT 
    order_amount,
    FLOOR(order_amount / 100) * 10 AS discount_amount
FROM orders;
```

**🎯 实际用途**
- 周期计算：完整的周期数
- 等级计算：当前达到的等级
- 折扣计算：满足条件的次数

```
取整函数对比图：

数轴示意：
    -3    -2    -1     0     1     2     3     4
     |     |     |     |     |     |     |     |
           ↑                       ↑
         -2.7                    3.4

FLOOR(-2.7) = -3  ←向下取整
CEIL(-2.7)  = -2  ←向上取整
ROUND(-2.7) = -3  ←四舍五入

FLOOR(3.4)  = 3   ←向下取整
CEIL(3.4)   = 4   ←向上取整
ROUND(3.4)  = 3   ←四舍五入
```

---

## 3. 🚀 高级数学运算


### 3.1 POWER(x,y) - 幂运算


**🔸 基本概念**
```
计算x的y次方，即x^y
x是底数，y是指数
```

**💡 通俗理解**
就像计算器上的"^"按钮，比如2的3次方就是2×2×2=8。在数据库里POWER(2,3)就等于8。

```sql
-- 基本用法示例
SELECT POWER(2, 3);        -- 结果：8 (2的3次方)
SELECT POWER(5, 2);        -- 结果：25 (5的平方)
SELECT POWER(10, 3);       -- 结果：1000 (10的3次方)
SELECT POWER(4, 0.5);      -- 结果：2 (4的0.5次方，即平方根)

-- 实际应用：复利计算
SELECT 
    principal_amount,
    interest_rate,
    years,
    ROUND(principal_amount * POWER(1 + interest_rate/100, years), 2) AS final_amount
FROM investment_plans;

-- 应用：数据增长预测
SELECT 
    current_users,
    growth_rate,
    months,
    ROUND(current_users * POWER(1 + growth_rate, months)) AS predicted_users
FROM growth_forecast;
```

**🎯 实际用途**
- 复利计算：投资收益预测
- 增长计算：用户增长、销售增长
- 面积体积：几何计算

### 3.2 SQRT(x) - 平方根


**🔸 基本概念**
```
计算x的平方根，即√x
就是找一个数，这个数乘以自己等于x
```

**💡 通俗理解**
就像问"什么数乘以自己等于9？"答案是3，所以√9=3。SQRT函数就是帮你找这个答案的。

```sql
-- 基本用法示例
SELECT SQRT(9);        -- 结果：3
SELECT SQRT(16);       -- 结果：4
SELECT SQRT(2);        -- 结果：1.4142135623731 (约等于1.41)
SELECT SQRT(100);      -- 结果：10

-- 实际应用：计算距离（勾股定理）
SELECT 
    point_a_x,
    point_a_y,
    point_b_x,
    point_b_y,
    ROUND(SQRT(POWER(point_b_x - point_a_x, 2) + POWER(point_b_y - point_a_y, 2)), 2) AS distance
FROM coordinate_points;

-- 应用：标准差计算的一部分
SELECT 
    ROUND(SQRT(variance), 2) AS standard_deviation
FROM statistics_table;
```

**🎯 实际用途**
- 距离计算：两点间直线距离
- 统计计算：标准差等统计指标
- 几何计算：涉及开方的数学计算

### 3.3 RAND() - 生成0-1随机数


**🔸 基本概念**
```
生成0到1之间的随机小数
每次调用结果都不同（除非设置种子）
```

**💡 通俗理解**
就像掷骰子，每次结果都不一样。RAND()就是一个电子骰子，不过它给出的是0到1之间的小数。

```sql
-- 基本用法示例
SELECT RAND();              -- 结果：0.123456789（每次都不同）
SELECT RAND();              -- 结果：0.876543210（和上面不同）

-- 实际应用：随机抽样
SELECT *
FROM users
WHERE RAND() < 0.1          -- 随机选择约10%的用户
LIMIT 100;

-- 应用：生成随机ID或编号
SELECT 
    name,
    CONCAT('USER_', FLOOR(RAND() * 10000)) AS random_id
FROM temp_users;

-- 应用：随机排序
SELECT product_name, price
FROM products
ORDER BY RAND()             -- 随机显示商品
LIMIT 5;
```

**🎯 实际用途**
- 随机抽样：从大量数据中随机选择
- 随机排序：打乱数据顺序
- 测试数据：生成随机的测试数据

### 3.4 RAND(n) - 指定种子随机数


**🔸 基本概念**
```
使用指定的种子n生成随机数
相同的种子会产生相同的随机数序列
```

**💡 通俗理解**
就像给随机数发生器一个"起始密码"。用相同密码的话，每次产生的随机数都一样。这样可以让"随机"变得可预测，方便测试。

```sql
-- 基本用法示例
SELECT RAND(123);           -- 结果：0.447498364... (固定的)
SELECT RAND(123);           -- 结果：0.447498364... (和上面相同)
SELECT RAND(456);           -- 结果：0.661427471... (不同种子，不同结果)

-- 实际应用：可重现的随机测试
SELECT 
    user_id,
    name,
    RAND(20231215) AS test_group_seed
FROM users
WHERE RAND(20231215) < 0.5  -- 每次运行结果都相同
ORDER BY user_id;

-- 应用：基于ID的伪随机分组
SELECT 
    user_id,
    name,
    CASE 
        WHEN RAND(user_id) < 0.33 THEN 'A组'
        WHEN RAND(user_id) < 0.66 THEN 'B组'
        ELSE 'C组'
    END AS test_group
FROM users;
```

**🎯 实际用途**
- 可重现测试：确保测试结果一致
- 稳定分组：基于固定规则分组
- 数据调试：便于问题重现和调试

```
随机数使用对比：

RAND()使用场景：
真正需要随机性 → 抽奖、随机推荐
每次结果都要不同 → 打乱显示顺序

RAND(n)使用场景：
需要可重现性 → 测试、调试
基于某个值分组 → 用户ID做种子
```

---

## 4. 📋 核心要点总结


### 4.1 函数功能速查表


| **函数分类** | **函数名** | **作用** | **最常用场景** |
|-------------|-----------|---------|---------------|
| **基础运算** | `ABS(x)` | 取绝对值 | 计算差值、距离 |
| **基础运算** | `MOD(n,m)` | 取余数 | 判断奇偶、分组 |
| **基础运算** | `GREATEST(...)` | 取最大值 | 多列比较、设下限 |
| **基础运算** | `LEAST(...)` | 取最小值 | 多列比较、设上限 |
| **取整舍入** | `ROUND(x)` | 四舍五入整数 | 显示整数结果 |
| **取整舍入** | `ROUND(x,d)` | 指定精度舍入 | 金额计算、精度控制 |
| **取整舍入** | `CEIL(x)` | 向上取整 | 分页、包装计算 |
| **取整舍入** | `FLOOR(x)` | 向下取整 | 等级、完整周期 |
| **高级运算** | `POWER(x,y)` | 幂运算 | 复利、增长计算 |
| **高级运算** | `SQRT(x)` | 平方根 | 距离、统计计算 |
| **随机函数** | `RAND()` | 随机数 | 抽样、随机排序 |
| **随机函数** | `RAND(n)` | 种子随机数 | 可重现测试 |

### 4.2 实际应用记忆口诀


```
🔸 ABS求绝对值，差值距离不用愁
🔸 MOD取余很实用，奇偶分组有一手  
🔸 GREATEST找最大，多列比较它最棒
🔸 LEAST找最小值，设置上限用得着
🔸 ROUND四舍五入好，金额计算少不了
🔸 CEIL向上要取整，分页计算它最行
🔸 FLOOR向下砍小数，等级计算就用它
🔸 POWER计算做幂运算，增长预测很方便
🔸 SQRT开方求根号，距离计算跑不掉
🔸 RAND随机数生成，抽样测试都能行
```

### 4.3 常见使用误区


**⚠️ 取整函数误区**
```sql
-- ❌ 错误理解：以为CEIL和FLOOR对负数的处理
SELECT CEIL(-2.3);   -- 结果是-2，不是-3
SELECT FLOOR(-2.3);  -- 结果是-3，不是-2

-- ✅ 正确理解：
-- CEIL永远向上（朝正无穷方向）
-- FLOOR永远向下（朝负无穷方向）
```

**⚠️ 随机函数误区**
```sql
-- ❌ 错误：想要1-10的随机整数
SELECT RAND() * 10;  -- 得到0-10的小数

-- ✅ 正确：1-10的随机整数
SELECT FLOOR(RAND() * 10) + 1;
```

### 4.4 性能使用建议


**💡 优化建议**
- **能用简单函数就不用复杂函数**：`x*x` 比 `POWER(x,2)` 更快
- **避免在WHERE子句中使用随机函数**：会导致无法使用索引
- **大量随机数生成考虑在应用层处理**：数据库计算随机数较慢

**🎯 最佳实践**
- 金额计算统一用 `ROUND(amount, 2)` 保留两位小数
- 分页计算统一用 `CEIL(total_count / page_size)`
- 随机抽样先用 `ORDER BY RAND()` 再 `LIMIT`

**核心记忆**：
- 数值函数让计算更简单，选对函数是关键
- 取整舍入要分清，向上向下有区别  
- 随机函数很实用，种子控制可重现
- 实际应用要灵活，性能优化别忘记