---
title: 6、Otter Manager安装部署
---
## 📚 目录

1. [Otter Manager概述](#1-Otter-Manager概述)
2. [安装前准备工作](#2-安装前准备工作)
3. [Manager安装包获取](#3-Manager安装包获取)
4. [数据库环境配置](#4-数据库环境配置)
5. [Manager部署配置](#5-Manager部署配置)
6. [Web管理界面部署](#6-Web管理界面部署)
7. [启动与验证测试](#7-启动与验证测试)
8. [常见问题处理](#8-常见问题处理)
9. [核心要点总结](#9-核心要点总结)

---

## 1. 🎯 Otter Manager概述


### 1.1 Manager的作用是什么


**🔸 简单理解**
- **Manager就是Otter的"大脑"**，负责管理整个数据同步系统
- 就像工厂的调度中心，统一安排各个同步任务的执行
- 提供Web界面，让你能可视化管理所有的数据同步配置

**🔸 核心功能**
```
📊 任务管理：创建、配置、监控数据同步任务
👥 节点管理：管理多个Node节点的状态和分配
📈 性能监控：实时查看同步进度、错误信息、性能指标
⚙️ 配置中心：统一管理同步规则、数据源配置等
```

### 1.2 Manager在整体架构中的位置


```
            ┌─────────────────┐
            │   Web浏览器     │ ← 用户通过浏览器操作
            └─────────────────┘
                     │
                     ▼
            ┌─────────────────┐
            │ Otter Manager   │ ← 管理控制中心
            │   (本文主角)     │
            └─────────────────┘
                     │
        ┌────────────┼────────────┐
        ▼            ▼            ▼
   ┌─────────┐ ┌─────────┐ ┌─────────┐
   │ Node 1  │ │ Node 2  │ │ Node 3  │ ← 执行同步任务
   └─────────┘ └─────────┘ └─────────┘
        │            │            │
        ▼            ▼            ▼
   ┌─────────┐ ┌─────────┐ ┌─────────┐
   │源数据库A │ │目标数据库B│ │源数据库C │
   └─────────┘ └─────────┘ └─────────┘
```

**🧠 记忆口诀**：Manager管全局，Node干活忙，数据库间传真相

---

## 2. 🛠️ 安装前准备工作


### 2.1 系统环境要求


**🔸 操作系统要求**
- **Linux系统**：CentOS 7+、Ubuntu 16+、红帽系列
- **Windows系统**：Windows Server 2012+（不推荐生产环境）

**🔸 Java环境要求**
```bash
# 必须是JDK 8或以上版本
java -version
# 应该看到类似输出：
# java version "1.8.0_271"
# Java(TM) SE Runtime Environment (build 1.8.0_271-b09)
```

> 💡 **为什么需要JDK 8+**  
> Otter是用Java开发的，JDK 8提供了更好的性能和稳定性，特别是在处理大量数据同步时

### 2.2 硬件资源建议


| 环境类型 | **CPU** | **内存** | **磁盘** | **网络** |
|---------|---------|----------|----------|----------|
| 🔰 **测试环境** | `2核` | `4GB` | `50GB` | `100Mbps` |
| 🔸 **生产环境** | `4核+` | `8GB+` | `200GB+` | `1Gbps+` |
| ⭐ **高并发环境** | `8核+` | `16GB+` | `500GB+` | `10Gbps+` |

### 2.3 依赖服务准备


**🔸 MySQL数据库**
```
作用：存储Manager的配置信息、任务状态、监控数据
版本要求：MySQL 5.6+
建议配置：独立的MySQL实例，不要与业务数据库混用
```

**🔸 网络连通性**
```
Manager需要能够：
✅ 连接到MySQL配置数据库
✅ 与各个Node节点通信
✅ 用户能通过浏览器访问Web界面
```

---

## 3. 📦 Manager安装包获取


### 3.1 官方下载渠道


**🔸 GitHub官方地址**
```bash
# Otter官方GitHub仓库
https://github.com/alibaba/otter

# 进入Releases页面下载最新版本
https://github.com/alibaba/otter/releases
```

**🔸 推荐版本选择**
```
📋 版本选择建议：

🔰 新手学习：选择最新的稳定版（如4.2.18）
🔸 生产环境：选择使用量大的稳定版（如4.2.16）
⚠️ 避免选择：Beta版本、RC版本（测试版）
```

### 3.2 安装包文件说明


**🔸 下载文件类型**
```
manager.deployer-4.2.18.tar.gz    ← Manager部署包
node.deployer-4.2.18.tar.gz       ← Node部署包（本文不涉及）
```

**🔸 文件大小参考**
- Manager包大小：约80-100MB
- 包含：Tomcat容器、Otter Manager应用、启动脚本等

### 3.3 安装包验证


```bash
# 下载完成后验证文件完整性
ls -lh manager.deployer-4.2.18.tar.gz

# 解压测试（不要在生产目录解压）
tar -tzf manager.deployer-4.2.18.tar.gz | head -10
```

---

## 4. 🗃️ 数据库环境配置


### 4.1 为什么需要配置数据库


**🤔 数据库的作用**
- **存储配置信息**：数据源配置、同步规则、用户权限等
- **记录运行状态**：任务执行情况、错误日志、性能指标
- **协调多节点**：在多个Node之间共享任务分配信息

> 🌰 **生活类比**  
> 就像公司的人事档案系统，记录所有员工信息、工作安排、考勤记录等

### 4.2 创建Manager专用数据库


**🔸 登录MySQL创建数据库**
```sql
-- 1. 登录MySQL（用root或有权限的用户）
mysql -u root -p

-- 2. 创建Otter专用数据库
CREATE DATABASE otter_manager DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- 3. 创建专用用户（安全考虑）
CREATE USER 'otter_user'@'%' IDENTIFIED BY 'otter_password_123';

-- 4. 授权用户访问数据库
GRANT ALL PRIVILEGES ON otter_manager.* TO 'otter_user'@'%';
FLUSH PRIVILEGES;
```

> ⚠️ **安全提醒**  
> 生产环境请使用强密码，并限制连接来源IP（将%改为具体IP）

### 4.3 初始化数据库表结构


**🔸 找到初始化脚本**
```bash
# 解压Manager安装包
tar -xzf manager.deployer-4.2.18.tar.gz
cd manager.deployer-4.2.18

# 查找初始化脚本
find . -name "*.sql" -type f
# 通常在：conf/sql/otter-manager-schema.sql
```

**🔸 执行初始化脚本**
```bash
# 方法1：通过命令行执行
mysql -u otter_user -p otter_manager < conf/sql/otter-manager-schema.sql

# 方法2：在MySQL客户端执行
mysql -u otter_user -p
USE otter_manager;
SOURCE /path/to/manager.deployer-4.2.18/conf/sql/otter-manager-schema.sql;
```

**🔸 验证表创建成功**
```sql
-- 检查表是否创建成功
USE otter_manager;
SHOW TABLES;

-- 应该看到类似这些表：
-- canal_config, node_task, pipeline_config, data_source等
```

---

## 5. ⚙️ Manager部署配置


### 5.1 解压和目录结构了解


**🔸 解压安装包**
```bash
# 选择安装目录（建议统一路径）
mkdir -p /opt/otter
cd /opt/otter

# 解压Manager包
tar -xzf manager.deployer-4.2.18.tar.gz
mv manager.deployer-4.2.18 otter-manager

# 查看目录结构
cd otter-manager
tree -L 2
```

**🔸 目录结构说明**
```
otter-manager/
├── bin/                 ← 启动脚本目录
│   ├── startup.sh      ← Linux启动脚本
│   └── stop.sh         ← 停止脚本
├── conf/               ← 配置文件目录
│   ├── otter.properties ← 主配置文件
│   └── sql/            ← 数据库初始化脚本
├── lib/                ← 依赖包目录
├── logs/               ← 日志文件目录
└── webapps/            ← Web应用目录
    └── otter/          ← Manager Web应用
```

### 5.2 核心配置文件设置


**🔸 编辑主配置文件**
```bash
# 编辑otter.properties配置文件
vim conf/otter.properties
```

**🔸 关键配置参数详解**
```properties
# ===== 数据库连接配置 =====
# 这是最重要的配置，连接你刚才创建的数据库
otter.zookeeper.cluster.default=127.0.0.1:2181
otter.database.driver.class.name=com.mysql.jdbc.Driver
otter.database.driver.url=jdbc:mysql://localhost:3306/otter_manager?useUnicode=true&characterEncoding=UTF-8
otter.database.driver.username=otter_user
otter.database.driver.password=otter_password_123

# ===== Manager服务配置 =====
# Manager的唯一标识，多个Manager集群时不能重复
otter.manager.id=1
# Web管理界面端口
otter.port=8080
# Manager监听IP，0.0.0.0表示监听所有网卡
otter.ip=0.0.0.0

# ===== 性能调优配置 =====
# JVM内存设置（根据服务器配置调整）
otter.manager.jvm=-Xms1024m -Xmx2048m -XX:PermSize=128m -XX:MaxPermSize=512m
```

> 💡 **配置理解技巧**  
> - `database.driver.url`：告诉Manager去哪找配置数据库  
> - `manager.id`：给Manager一个身份证号  
> - `port`：Web界面的访问端口  
> - `jvm`：给Manager分配多少内存来干活

### 5.3 Tomcat容器配置优化


**🔸 修改Tomcat配置**
```bash
# 进入Tomcat配置目录
cd conf/

# 编辑server.xml（如果需要HTTPS或其他高级配置）
vim server.xml
```

**🔸 重要的Tomcat参数**
```xml
<!-- 在server.xml中找到Connector配置 -->
<Connector port="8080" 
           protocol="HTTP/1.1"
           connectionTimeout="20000"
           maxThreads="200"
           acceptCount="100"
           enableLookups="false"
           redirectPort="8443" />
```

**参数含义解释**：
- `maxThreads`：最大处理线程数，控制并发能力
- `connectionTimeout`：连接超时时间，毫秒单位
- `acceptCount`：等待队列长度

---

## 6. 🌐 Web管理界面部署


### 6.1 Web应用部署原理


**🔸 部署方式说明**
```
Otter Manager = Tomcat容器 + Manager Web应用

工作流程：
用户浏览器 ──▶ Tomcat容器 ──▶ Manager应用 ──▶ MySQL数据库
              (端口8080)     (业务逻辑)      (配置存储)
```

**🔸 Web应用目录结构**
```bash
# 查看Web应用内容
ls -la webapps/otter/
# 包含：WEB-INF/, css/, js/, images/, jsp页面等
```

### 6.2 访问权限配置


**🔸 默认管理员账号**
```
默认用户名：admin
默认密码：admin

⚠️ 首次登录后务必修改默认密码！
```

**🔸 防火墙端口开放**
```bash
# CentOS 7/8 防火墙配置
firewall-cmd --permanent --add-port=8080/tcp
firewall-cmd --reload

# Ubuntu 防火墙配置
ufw allow 8080/tcp

# 验证端口开放
netstat -tlnp | grep 8080
```

### 6.3 反向代理配置（可选）


**🔸 为什么需要反向代理**
- 隐藏真实端口，提高安全性
- 提供HTTPS加密访问
- 实现负载均衡（多Manager实例）

**🔸 Nginx反向代理示例**
```nginx
# /etc/nginx/sites-available/otter-manager
server {
    listen 80;
    server_name otter.yourdomain.com;
    
    location / {
        proxy_pass http://127.0.0.1:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

---

## 7. 🚀 启动与验证测试


### 7.1 启动Manager服务


**🔸 使用启动脚本**
```bash
# 进入bin目录
cd /opt/otter/otter-manager/bin

# 给启动脚本执行权限
chmod +x startup.sh stop.sh

# 启动Manager服务
./startup.sh

# 查看启动日志
tail -f ../logs/manager.log
```

**🔸 启动过程观察**
```bash
# 正常启动应该看到类似日志：
2025-09-12 15:30:01 INFO  - Manager starting...
2025-09-12 15:30:05 INFO  - Database connection established
2025-09-12 15:30:08 INFO  - Web server started on port 8080
2025-09-12 15:30:10 INFO  - Manager started successfully
```

### 7.2 验证服务启动成功


**🔸 检查进程状态**
```bash
# 方法1：查看Java进程
jps | grep -i manager
# 应该看到Manager相关进程

# 方法2：检查端口监听
netstat -tlnp | grep 8080
# 应该看到8080端口在监听

# 方法3：检查服务健康状态
curl -I http://localhost:8080/
# 应该返回HTTP 200状态码
```

### 7.3 Web管理界面访问测试


**🔸 浏览器访问测试**
```
访问地址：http://your-server-ip:8080/
登录用户：admin
登录密码：admin
```

**🔸 界面功能验证**
```
✅ 登录成功进入主界面
✅ 左侧导航菜单正常显示
✅ 能看到"数据源管理"、"Pipeline管理"等功能
✅ 右上角显示当前登录用户
✅ 系统状态显示正常
```

> 🎯 **验证成功标志**  
> 能够正常登录Web界面，看到Manager的各个功能模块，说明部署成功

### 7.4 数据库连接验证


**🔸 在Manager界面中验证**
```
1. 登录Web界面
2. 进入"系统管理" → "系统信息"
3. 查看数据库连接状态
4. 确认显示"数据库连接正常"
```

**🔸 手动数据库验证**
```sql
-- 登录数据库检查
USE otter_manager;

-- 查看是否有初始化数据
SELECT COUNT(*) FROM node_task;
-- 新安装应该返回0

-- 查看表结构是否正常
DESCRIBE pipeline_config;
```

---

## 8. ❗ 常见问题处理


### 8.1 启动失败问题


**🔸 端口被占用**
```bash
# 问题现象：启动时报错"Address already in use"
# 解决方法：
# 1. 查看占用端口的进程
netstat -tlnp | grep 8080

# 2. 杀死占用进程
kill -9 进程ID

# 3. 或者修改Manager端口
vim conf/otter.properties
# 修改：otter.port=8081
```

**🔸 数据库连接失败**
```bash
# 问题现象：日志显示"Database connection failed"
# 排查步骤：

# 1. 验证数据库服务是否启动
systemctl status mysql

# 2. 验证数据库连接信息
mysql -u otter_user -p -h localhost otter_manager

# 3. 检查配置文件中的连接参数
grep -E "database|username|password" conf/otter.properties
```

**🔸 内存不足问题**
```bash
# 问题现象：启动后很快崩溃，日志显示OutOfMemoryError
# 解决方法：调整JVM内存参数

vim conf/otter.properties
# 根据服务器内存调整：
otter.manager.jvm=-Xms512m -Xmx1024m -XX:PermSize=64m -XX:MaxPermSize=256m
```

### 8.2 Web访问问题


**🔸 无法访问Web界面**
```bash
# 排查清单：
□ 检查Manager服务是否启动：jps | grep -i manager
□ 检查端口是否监听：netstat -tlnp | grep 8080  
□ 检查防火墙是否开放：firewall-cmd --list-ports
□ 检查网络连通性：telnet server-ip 8080
```

**🔸 登录失败问题**
```
常见原因：
1. 用户名密码错误（默认admin/admin）
2. 数据库初始化不完整
3. Session配置问题

解决方法：
1. 确认使用默认账号登录
2. 重新执行数据库初始化脚本
3. 清除浏览器缓存重试
```

### 8.3 性能问题调优


**🔸 响应速度慢**
```
优化建议：

📊 数据库优化：
- 增加数据库连接池大小
- 为关键表添加索引
- 定期清理历史日志数据

⚡ JVM优化：
- 增大堆内存分配
- 调整垃圾回收参数
- 使用G1垃圾收集器

🌐 网络优化：
- 确保Manager与数据库间网络延迟低
- 使用本地数据库而非远程数据库
```

---

## 9. 📋 核心要点总结


### 9.1 必须掌握的基本概念


```
🔸 Manager作用：Otter系统的管理控制中心，提供Web界面管理数据同步
🔸 部署架构：Tomcat容器 + Manager应用 + MySQL配置数据库
🔸 核心配置：数据库连接、服务端口、JVM内存参数
🔸 验证方法：Web界面访问、服务进程检查、数据库连接测试
```

### 9.2 关键安装步骤回顾


**🔹 安装步骤总结**
```
1️⃣ 环境准备：JDK 8+、MySQL 5.6+、足够的硬件资源
2️⃣ 下载安装包：从GitHub获取官方发布版本
3️⃣ 数据库初始化：创建数据库、用户、执行初始化脚本
4️⃣ 解压配置：修改otter.properties核心配置
5️⃣ 启动服务：运行startup.sh启动Manager
6️⃣ 验证测试：Web界面访问、功能检查
```

**🔹 重要配置参数**
```
数据库连接：otter.database.driver.url（最关键）
服务端口：otter.port（Web访问端口）
Manager ID：otter.manager.id（集群唯一标识）
内存分配：otter.manager.jvm（性能关键）
```

### 9.3 实际应用价值


**🎯 部署完成后能做什么**
- **可视化管理**：通过Web界面管理所有数据同步任务
- **集中配置**：统一配置数据源、同步规则、监控策略
- **实时监控**：查看同步进度、性能指标、错误告警
- **多节点协调**：管理和调度多个Node节点的工作负载

**🔧 生产环境建议**
- **高可用部署**：多Manager实例+负载均衡
- **安全加固**：修改默认密码、启用HTTPS、限制访问IP
- **监控告警**：集成监控系统、设置关键指标告警
- **定期维护**：清理历史日志、备份配置数据库、更新版本

**🚀 下一步学习方向**
- Node节点安装部署
- 数据源配置管理
- Pipeline同步任务创建
- 系统监控和故障处理

**核心记忆**：
- Manager是Otter的大脑，负责统一管理和调度
- 成功部署的关键在于数据库配置和网络连通性
- Web界面能正常访问就说明基础部署成功
- 生产环境需要考虑高可用、安全和性能优化