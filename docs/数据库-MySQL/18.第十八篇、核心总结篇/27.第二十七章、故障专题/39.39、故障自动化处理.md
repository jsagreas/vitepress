---
title: 39ã€æ•…éšœè‡ªåŠ¨åŒ–å¤„ç†
---
## ğŸ“š ç›®å½•

1. [æ•…éšœè‡ªåŠ¨åŒ–å¤„ç†æ¦‚è¿°](#1-æ•…éšœè‡ªåŠ¨åŒ–å¤„ç†æ¦‚è¿°)
2. [è‡ªåŠ¨æ•…éšœæ£€æµ‹æœºåˆ¶](#2-è‡ªåŠ¨æ•…éšœæ£€æµ‹æœºåˆ¶)
3. [è‡ªåŠ¨æ¢å¤ä¸åˆ‡æ¢æœºåˆ¶](#3-è‡ªåŠ¨æ¢å¤ä¸åˆ‡æ¢æœºåˆ¶)
4. [æ™ºèƒ½å‘Šè­¦ä¸è¿‡æ»¤ç³»ç»Ÿ](#4-æ™ºèƒ½å‘Šè­¦ä¸è¿‡æ»¤ç³»ç»Ÿ)
5. [æ•…éšœè‡ªæ„ˆç³»ç»Ÿæ¶æ„](#5-æ•…éšœè‡ªæ„ˆç³»ç»Ÿæ¶æ„)
6. [è‡ªåŠ¨åŒ–è¿ç»´å¹³å°å®è·µ](#6-è‡ªåŠ¨åŒ–è¿ç»´å¹³å°å®è·µ)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ æ•…éšœè‡ªåŠ¨åŒ–å¤„ç†æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯æ•…éšœè‡ªåŠ¨åŒ–å¤„ç†


**ğŸ”¸ æ ¸å¿ƒå®šä¹‰**
```
æ•…éšœè‡ªåŠ¨åŒ–å¤„ç†ï¼šç³»ç»Ÿåœ¨æ— äººå·¥å¹²é¢„çš„æƒ…å†µä¸‹ï¼Œè‡ªåŠ¨æ£€æµ‹ã€åˆ†æã€å¤„ç†å’Œæ¢å¤æ•…éšœçš„èƒ½åŠ›

ç®€å•ç†è§£ï¼šå°±åƒç»™ç³»ç»Ÿè£…äº†ä¸€ä¸ª"è‡ªåŠ¨åŒ»ç”Ÿ"
â€¢ èƒ½è‡ªå·±å‘ç°é—®é¢˜ï¼ˆæ£€æµ‹ï¼‰
â€¢ èƒ½è‡ªå·±åˆ¤æ–­ç—…æƒ…ï¼ˆåˆ†æï¼‰  
â€¢ èƒ½è‡ªå·±å¼€è¯æ²»ç–—ï¼ˆå¤„ç†ï¼‰
â€¢ èƒ½è‡ªå·±åº·å¤æ£€æŸ¥ï¼ˆæ¢å¤ï¼‰
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦æ•…éšœè‡ªåŠ¨åŒ–


**ğŸ’¡ ç°å®ç—›ç‚¹**
```
ä¼ ç»Ÿäººå·¥å¤„ç†çš„é—®é¢˜ï¼š

å¤œé—´æ•…éšœï¼š
â€¢ å‡Œæ™¨3ç‚¹ç³»ç»Ÿå®•æœºï¼Œè¿ç»´äººå‘˜åœ¨ç¡è§‰
â€¢ å‘ç°æ•…éšœå·²ç»æ˜¯æ—©ä¸Š8ç‚¹ï¼ŒæŸå¤±5å°æ—¶
â€¢ ç”¨æˆ·æŠ•è¯‰ï¼Œä¸šåŠ¡æŸå¤±å·¨å¤§

äººå·¥å¤„ç†é€Ÿåº¦ï¼š
â€¢ å‘ç°é—®é¢˜ï¼š5-30åˆ†é’Ÿ
â€¢ åˆ†æå®šä½ï¼š10-60åˆ†é’Ÿ  
â€¢ æ‰§è¡Œæ¢å¤ï¼š5-30åˆ†é’Ÿ
â€¢ æ€»è€—æ—¶ï¼š20åˆ†é’Ÿ-2å°æ—¶

è‡ªåŠ¨åŒ–å¤„ç†é€Ÿåº¦ï¼š
â€¢ å‘ç°é—®é¢˜ï¼š1-5ç§’
â€¢ åˆ†æå¤„ç†ï¼š1-10ç§’
â€¢ æ‰§è¡Œæ¢å¤ï¼š10-60ç§’
â€¢ æ€»è€—æ—¶ï¼šå‡ ç§’åˆ°1åˆ†é’Ÿ
```

### 1.3 æ•…éšœè‡ªåŠ¨åŒ–çš„ä»·å€¼


**ğŸ¯ æ ¸å¿ƒä»·å€¼**
- **å¿«é€Ÿå“åº”**ï¼šç§’çº§å‘ç°å’Œå¤„ç†æ•…éšœ
- **å‡å°‘æŸå¤±**ï¼šæœ€å°åŒ–ä¸šåŠ¡ä¸­æ–­æ—¶é—´
- **é™ä½æˆæœ¬**ï¼šå‡å°‘äººå·¥è¿ç»´æŠ•å…¥
- **æé«˜å¯é æ€§**ï¼š7Ã—24å°æ—¶ä¸é—´æ–­ç›‘æ§

```
æŠ•èµ„å›æŠ¥ç‡è®¡ç®—ï¼š
å‡è®¾ï¼šç”µå•†ç½‘ç«™æ¯å°æ—¶æ”¶å…¥100ä¸‡
â€¢ äººå·¥å¤„ç†å¹³å‡æ•…éšœæ—¶é—´ï¼š1å°æ—¶
â€¢ è‡ªåŠ¨åŒ–å¤„ç†å¹³å‡æ•…éšœæ—¶é—´ï¼š1åˆ†é’Ÿ
â€¢ æ¯æ¬¡æ•…éšœèŠ‚çœæŸå¤±ï¼š100ä¸‡ Ã— (59/60) = 98.3ä¸‡
â€¢ ä¸€å¹´å‘ç”Ÿ10æ¬¡æ•…éšœï¼šèŠ‚çœ983ä¸‡
```

---

## 2. ğŸ” è‡ªåŠ¨æ•…éšœæ£€æµ‹æœºåˆ¶


### 2.1 æ•…éšœæ£€æµ‹çš„åŸºæœ¬åŸç†


**ğŸ”¸ æ£€æµ‹æ–¹å¼åˆ†ç±»**
```
ä¸»åŠ¨æ£€æµ‹ï¼ˆæ¢é’ˆæ–¹å¼ï¼‰ï¼š
ç³»ç»Ÿä¸»åŠ¨å»"ä½“æ£€"
â€¢ å®šæœŸå‘é€å¿ƒè·³åŒ…
â€¢ æ¨¡æ‹Ÿç”¨æˆ·è¯·æ±‚
â€¢ æ£€æŸ¥å…³é”®æŒ‡æ ‡

è¢«åŠ¨æ£€æµ‹ï¼ˆç›‘å¬æ–¹å¼ï¼‰ï¼š  
ç³»ç»Ÿè¢«åŠ¨"å¬è¯Š"
â€¢ ç›‘å¬é”™è¯¯æ—¥å¿—
â€¢ ç»Ÿè®¡å¼‚å¸¸æŒ‡æ ‡
â€¢ æ¥æ”¶å‘Šè­¦ä¿¡æ¯

æ··åˆæ£€æµ‹ï¼š
ä¸»åŠ¨+è¢«åŠ¨ç»“åˆä½¿ç”¨
```

### 2.2 å¥åº·æ£€æŸ¥æœºåˆ¶è¯¦è§£


**ğŸ’“ å¿ƒè·³æ£€æµ‹ï¼ˆHealth Checkï¼‰**

**åŸºæœ¬æ¦‚å¿µ**ï¼šå®šæœŸæ£€æŸ¥ç³»ç»Ÿæ˜¯å¦æ­£å¸¸è¿è¡Œ
```python
# ç®€å•çš„HTTPå¥åº·æ£€æŸ¥
import requests
import time

def health_check(url, timeout=5):
    """æ£€æŸ¥æœåŠ¡æ˜¯å¦å¥åº·"""
    try:
        response = requests.get(url, timeout=timeout)
        if response.status_code == 200:
            return True, "æœåŠ¡æ­£å¸¸"
        else:
            return False, f"çŠ¶æ€ç å¼‚å¸¸: {response.status_code}"
    except requests.exceptions.Timeout:
        return False, "è¯·æ±‚è¶…æ—¶"
    except Exception as e:
        return False, f"è¿æ¥å¤±è´¥: {str(e)}"

# ä½¿ç”¨ç¤ºä¾‹
while True:
    is_healthy, message = health_check("http://api.example.com/health")
    if not is_healthy:
        print(f"æ•…éšœæ£€æµ‹: {message}")
        # è§¦å‘è‡ªåŠ¨æ¢å¤æµç¨‹
        trigger_recovery()
    time.sleep(30)  # 30ç§’æ£€æŸ¥ä¸€æ¬¡
```

**ğŸ¯ å¤šå±‚æ¬¡å¥åº·æ£€æŸ¥**
```
Level 1 - åŸºç¡€æ£€æŸ¥ï¼š
â€¢ æœåŠ¡è¿›ç¨‹æ˜¯å¦å­˜åœ¨
â€¢ ç«¯å£æ˜¯å¦å¯è®¿é—®
â€¢ åŸºæœ¬HTTPå“åº”

Level 2 - åŠŸèƒ½æ£€æŸ¥ï¼š
â€¢ æ•°æ®åº“è¿æ¥æ˜¯å¦æ­£å¸¸
â€¢ ç¼“å­˜æ˜¯å¦å¯ç”¨
â€¢ å…³é”®APIæ˜¯å¦å“åº”

Level 3 - ä¸šåŠ¡æ£€æŸ¥ï¼š
â€¢ æ ¸å¿ƒä¸šåŠ¡æµç¨‹æ˜¯å¦æ­£å¸¸
â€¢ æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥
â€¢ æ€§èƒ½æŒ‡æ ‡æ˜¯å¦åœ¨é˜ˆå€¼å†…
```

### 2.3 æ™ºèƒ½é˜ˆå€¼ç›‘æ§


**ğŸ“Š åŠ¨æ€é˜ˆå€¼è®¾ç½®**

**ä¼ ç»Ÿå›ºå®šé˜ˆå€¼çš„é—®é¢˜**ï¼š
```
é—®é¢˜ç¤ºä¾‹ï¼š
â€¢ è®¾ç½®CPUä½¿ç”¨ç‡>80%æŠ¥è­¦
â€¢ ä½†æ·±å¤œæ­£å¸¸æ˜¯20%ï¼Œç™½å¤©æ­£å¸¸æ˜¯70%
â€¢ å¯¼è‡´å¤§é‡æ— æ•ˆå‘Šè­¦æˆ–æ¼æŠ¥

è§£å†³æ–¹æ¡ˆï¼šåŸºäºå†å²æ•°æ®çš„åŠ¨æ€é˜ˆå€¼
```

**æ™ºèƒ½é˜ˆå€¼ç®—æ³•**ï¼š
```python
import numpy as np
from datetime import datetime, timedelta

class SmartThreshold:
    def __init__(self, window_days=7):
        self.window_days = window_days
        self.historical_data = []
    
    def calculate_threshold(self, current_time):
        """åŸºäºå†å²åŒæ—¶æ®µæ•°æ®è®¡ç®—é˜ˆå€¼"""
        # è·å–è¿‡å»7å¤©åŒä¸€æ—¶é—´æ®µçš„æ•°æ®
        same_time_data = self.get_same_time_historical_data(current_time)
        
        if len(same_time_data) < 3:
            return 80  # é»˜è®¤é˜ˆå€¼
        
        # è®¡ç®—å‡å€¼å’Œæ ‡å‡†å·®
        mean = np.mean(same_time_data)
        std = np.std(same_time_data)
        
        # é˜ˆå€¼ = å‡å€¼ + 2å€æ ‡å‡†å·®
        threshold = mean + 2 * std
        
        return min(threshold, 95)  # æœ€å¤§ä¸è¶…è¿‡95%
    
    def is_anomaly(self, current_value, current_time):
        """åˆ¤æ–­å½“å‰å€¼æ˜¯å¦å¼‚å¸¸"""
        threshold = self.calculate_threshold(current_time)
        return current_value > threshold
```

### 2.4 æ•…éšœæ£€æµ‹ç­–ç•¥


**ğŸª åˆ†å±‚æ£€æµ‹ç­–ç•¥**
```
ç½‘ç»œå±‚æ£€æµ‹ï¼š
â€¢ Pingæ£€æµ‹ï¼šæ£€æŸ¥ç½‘ç»œè¿é€šæ€§
â€¢ ç«¯å£æ‰«æï¼šæ£€æŸ¥æœåŠ¡ç«¯å£çŠ¶æ€
â€¢ ç½‘ç»œå»¶è¿Ÿç›‘æ§

åº”ç”¨å±‚æ£€æµ‹ï¼š
â€¢ HTTPçŠ¶æ€ç æ£€æµ‹
â€¢ å“åº”æ—¶é—´ç›‘æ§  
â€¢ APIåŠŸèƒ½æµ‹è¯•

ä¸šåŠ¡å±‚æ£€æµ‹ï¼š
â€¢ å…³é”®ä¸šåŠ¡æµç¨‹æµ‹è¯•
â€¢ æ•°æ®å®Œæ•´æ€§æ£€æŸ¥
â€¢ ç”¨æˆ·ä½“éªŒç›‘æ§
```

---

## 3. ğŸ”„ è‡ªåŠ¨æ¢å¤ä¸åˆ‡æ¢æœºåˆ¶


### 3.1 è‡ªåŠ¨æ¢å¤çš„åŸºæœ¬ç­–ç•¥


**ğŸ”¸ æ¢å¤ç­–ç•¥åˆ†ç±»**
```
é‡å¯æ¢å¤ï¼š
æœ€ç®€å•ç²—æš´çš„æ–¹å¼
â€¢ è¿›ç¨‹é‡å¯
â€¢ æœåŠ¡é‡å¯  
â€¢ ç³»ç»Ÿé‡å¯

åˆ‡æ¢æ¢å¤ï¼š
è½¬ç§»åˆ°å¤‡ç”¨èµ„æº
â€¢ ä¸»å¤‡åˆ‡æ¢
â€¢ è´Ÿè½½é‡æ–°åˆ†é…
â€¢ æ•…éšœèŠ‚ç‚¹éš”ç¦»

é™çº§æ¢å¤ï¼š
ä¿è¯æ ¸å¿ƒåŠŸèƒ½
â€¢ å…³é—­éæ ¸å¿ƒåŠŸèƒ½
â€¢ é™åˆ¶å¹¶å‘è®¿é—®
â€¢ ä½¿ç”¨ç¼“å­˜æ•°æ®
```

### 3.2 æœåŠ¡è‡ªåŠ¨é‡å¯æœºåˆ¶


**ğŸ’» è¿›ç¨‹ç›‘æ§ä¸é‡å¯**
```bash
#!/bin/bash
# ç®€å•çš„æœåŠ¡ç›‘æ§è„šæœ¬

SERVICE_NAME="my-web-service"
MAX_RESTART_COUNT=3
RESTART_COUNT=0

check_service() {
    # æ£€æŸ¥è¿›ç¨‹æ˜¯å¦å­˜åœ¨
    if pgrep -f "$SERVICE_NAME" > /dev/null; then
        return 0  # æœåŠ¡è¿è¡Œä¸­
    else
        return 1  # æœåŠ¡å·²åœæ­¢
    fi
}

restart_service() {
    echo "æ£€æµ‹åˆ°æœåŠ¡æ•…éšœï¼Œæ­£åœ¨é‡å¯..."
    systemctl restart $SERVICE_NAME
    RESTART_COUNT=$((RESTART_COUNT + 1))
    
    # ç­‰å¾…æœåŠ¡å¯åŠ¨
    sleep 10
    
    if check_service; then
        echo "æœåŠ¡é‡å¯æˆåŠŸ"
        RESTART_COUNT=0  # é‡ç½®è®¡æ•°å™¨
        return 0
    else
        echo "æœåŠ¡é‡å¯å¤±è´¥"
        return 1
    fi
}

# ä¸»ç›‘æ§å¾ªç¯
while true; do
    if ! check_service; then
        if [ $RESTART_COUNT -lt $MAX_RESTART_COUNT ]; then
            restart_service
        else
            echo "é‡å¯æ¬¡æ•°è¶…é™ï¼Œå‘é€å‘Šè­¦ï¼"
            # å‘é€å‘Šè­¦é€šçŸ¥
            send_alert "æœåŠ¡ $SERVICE_NAME å¤šæ¬¡é‡å¯å¤±è´¥"
            break
        fi
    fi
    
    sleep 30  # 30ç§’æ£€æŸ¥ä¸€æ¬¡
done
```

### 3.3 æ•…éšœè‡ªåŠ¨åˆ‡æ¢ï¼ˆFailoverï¼‰


**ğŸ”€ ä¸»å¤‡è‡ªåŠ¨åˆ‡æ¢**

**åŸºæœ¬æ¦‚å¿µ**ï¼šå½“ä¸»æœåŠ¡å™¨æ•…éšœæ—¶ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡ç”¨æœåŠ¡å™¨

```
åˆ‡æ¢æ¶æ„ç¤ºæ„ï¼š
            è´Ÿè½½å‡è¡¡å™¨
                |
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
        |               |
   ä¸»æœåŠ¡å™¨A â†â†’ å¤‡æœåŠ¡å™¨B
   (Active)    (Standby)
   
æ•…éšœå‘ç”Ÿï¼š
1. æ£€æµ‹åˆ°ä¸»æœåŠ¡å™¨Aæ•…éšœ
2. è‡ªåŠ¨å°†æµé‡åˆ‡æ¢åˆ°å¤‡æœåŠ¡å™¨B  
3. å¤‡æœåŠ¡å™¨Bå˜ä¸ºä¸»æœåŠ¡å™¨
4. é€šçŸ¥ç®¡ç†å‘˜å¤„ç†æ•…éšœçš„AæœåŠ¡å™¨
```

**åˆ‡æ¢å®ç°ç¤ºä¾‹**ï¼š
```python
import time
import subprocess
import requests

class AutoFailover:
    def __init__(self):
        self.primary_server = "http://server-a:8080"
        self.backup_server = "http://server-b:8080"
        self.current_active = "primary"
        self.check_interval = 10
    
    def check_server_health(self, server_url):
        """æ£€æŸ¥æœåŠ¡å™¨å¥åº·çŠ¶æ€"""
        try:
            response = requests.get(f"{server_url}/health", timeout=5)
            return response.status_code == 200
        except:
            return False
    
    def switch_to_backup(self):
        """åˆ‡æ¢åˆ°å¤‡ç”¨æœåŠ¡å™¨"""
        print("æ£€æµ‹åˆ°ä¸»æœåŠ¡å™¨æ•…éšœï¼Œæ­£åœ¨åˆ‡æ¢åˆ°å¤‡ç”¨æœåŠ¡å™¨...")
        
        # æ›´æ–°è´Ÿè½½å‡è¡¡å™¨é…ç½®
        self.update_load_balancer(self.backup_server)
        
        # æ›´æ–°å½“å‰æ´»è·ƒæœåŠ¡å™¨
        self.current_active = "backup"
        
        print("å·²æˆåŠŸåˆ‡æ¢åˆ°å¤‡ç”¨æœåŠ¡å™¨")
        
        # å‘é€å‘Šè­¦é€šçŸ¥
        self.send_alert("ä¸»æœåŠ¡å™¨æ•…éšœï¼Œå·²è‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡ç”¨æœåŠ¡å™¨")
    
    def update_load_balancer(self, active_server):
        """æ›´æ–°è´Ÿè½½å‡è¡¡å™¨é…ç½®"""
        # è¿™é‡Œæ˜¯ä¼ªä»£ç ï¼Œå®é™…éœ€è¦è°ƒç”¨å…·ä½“çš„è´Ÿè½½å‡è¡¡å™¨API
        config = f"""
        upstream backend {{
            server {active_server.replace('http://', '')} weight=1;
        }}
        """
        # æ›´æ–°nginxé…ç½®å¹¶é‡æ–°åŠ è½½
        subprocess.run(["nginx", "-s", "reload"])
    
    def monitor(self):
        """ä¸»ç›‘æ§å¾ªç¯"""
        while True:
            if self.current_active == "primary":
                if not self.check_server_health(self.primary_server):
                    self.switch_to_backup()
            
            time.sleep(self.check_interval)

# å¯åŠ¨è‡ªåŠ¨åˆ‡æ¢ç›‘æ§
failover = AutoFailover()
failover.monitor()
```

### 3.4 æ™ºèƒ½é™çº§æœºåˆ¶


**ğŸ“‰ è‡ªåŠ¨æœåŠ¡é™çº§**

**ä»€ä¹ˆæ˜¯æœåŠ¡é™çº§**ï¼šåœ¨ç³»ç»Ÿå‹åŠ›è¿‡å¤§æˆ–éƒ¨åˆ†åŠŸèƒ½æ•…éšœæ—¶ï¼Œä¸»åŠ¨å…³é—­éƒ¨åˆ†éæ ¸å¿ƒåŠŸèƒ½ï¼Œä¿è¯æ ¸å¿ƒä¸šåŠ¡æ­£å¸¸è¿è¡Œ

```
é™çº§ç­–ç•¥ç¤ºä¾‹ï¼š
ç”µå•†ç½‘ç«™åœ¨é«˜å¹¶å‘æ—¶çš„é™çº§ï¼š

Level 1 - è½»å¾®é™çº§ï¼š
â€¢ å…³é—­æ¨èåŠŸèƒ½
â€¢ ç®€åŒ–é¡µé¢æ ·å¼
â€¢ å‡å°‘å¹¿å‘Šæ˜¾ç¤º

Level 2 - ä¸­åº¦é™çº§ï¼š
â€¢ å…³é—­è¯„è®ºåŠŸèƒ½  
â€¢ ç¦ç”¨ä¼˜æƒ åˆ¸æŸ¥è¯¢
â€¢ é™åˆ¶æœç´¢åŠŸèƒ½

Level 3 - é‡åº¦é™çº§ï¼š
â€¢ åªä¿ç•™ä¸‹å•åŠŸèƒ½
â€¢ ä½¿ç”¨é™æ€å•†å“é¡µé¢
â€¢ é™åˆ¶ç”¨æˆ·è®¿é—®æ•°é‡
```

**é™çº§å®ç°ç¤ºä¾‹**ï¼š
```python
class ServiceDegrader:
    def __init__(self):
        self.degradation_level = 0
        self.cpu_threshold = [70, 85, 95]  # ä¸åŒçº§åˆ«çš„CPUé˜ˆå€¼
        self.features = {
            1: ['recommendation', 'ads'],
            2: ['comment', 'coupon', 'search'],
            3: ['detail_page', 'user_profile']
        }
    
    def check_system_load(self):
        """æ£€æŸ¥ç³»ç»Ÿè´Ÿè½½"""
        # è·å–CPUä½¿ç”¨ç‡ï¼ˆç®€åŒ–ç¤ºä¾‹ï¼‰
        import psutil
        return psutil.cpu_percent()
    
    def auto_degrade(self):
        """è‡ªåŠ¨é™çº§åˆ¤æ–­"""
        cpu_usage = self.check_system_load()
        
        new_level = 0
        for i, threshold in enumerate(self.cpu_threshold):
            if cpu_usage > threshold:
                new_level = i + 1
        
        if new_level != self.degradation_level:
            self.apply_degradation(new_level)
            self.degradation_level = new_level
    
    def apply_degradation(self, level):
        """åº”ç”¨é™çº§ç­–ç•¥"""
        if level > self.degradation_level:
            # å‡çº§é™çº§ç­‰çº§
            for i in range(self.degradation_level + 1, level + 1):
                for feature in self.features.get(i, []):
                    self.disable_feature(feature)
                    print(f"å·²å…³é—­åŠŸèƒ½: {feature}")
        else:
            # é™ä½é™çº§ç­‰çº§ï¼Œæ¢å¤åŠŸèƒ½
            for i in range(level + 1, self.degradation_level + 1):
                for feature in self.features.get(i, []):
                    self.enable_feature(feature)
                    print(f"å·²æ¢å¤åŠŸèƒ½: {feature}")
    
    def disable_feature(self, feature):
        """ç¦ç”¨åŠŸèƒ½"""
        # é€šè¿‡é…ç½®ä¸­å¿ƒæˆ–ç‰¹æ€§å¼€å…³ç¦ç”¨åŠŸèƒ½
        pass
    
    def enable_feature(self, feature):
        """å¯ç”¨åŠŸèƒ½"""
        # é€šè¿‡é…ç½®ä¸­å¿ƒæˆ–ç‰¹æ€§å¼€å…³å¯ç”¨åŠŸèƒ½
        pass
```

---

## 4. ğŸš¨ æ™ºèƒ½å‘Šè­¦ä¸è¿‡æ»¤ç³»ç»Ÿ


### 4.1 å‘Šè­¦é£æš´é—®é¢˜


**âš¡ ä»€ä¹ˆæ˜¯å‘Šè­¦é£æš´**
```
é—®é¢˜åœºæ™¯ï¼š
ä¸€ä¸ªç½‘ç»œæ•…éšœå¯¼è‡´ï¼š
â€¢ 100å°æœåŠ¡å™¨æ— æ³•è®¿é—®
â€¢ æ¯å°æœåŠ¡å™¨äº§ç”Ÿ10ä¸ªå‘Šè­¦
â€¢ 1åˆ†é’Ÿå†…æ”¶åˆ°1000æ¡å‘Šè­¦çŸ­ä¿¡
â€¢ è¿ç»´äººå‘˜æ‰‹æœºè¢«æ‰“çˆ†ï¼Œæ— æ³•æœ‰æ•ˆå¤„ç†

æ ¹æœ¬é—®é¢˜ï¼š
â€¢ é‡å¤å‘Šè­¦ï¼šç›¸åŒé—®é¢˜çš„å¤šæ¬¡å‘Šè­¦
â€¢ å…³è”å‘Šè­¦ï¼šä¸€ä¸ªæ ¹å› å¯¼è‡´çš„å¤šä¸ªç°è±¡å‘Šè­¦
â€¢ æ— æ„ä¹‰å‘Šè­¦ï¼šå·²çŸ¥é—®é¢˜çš„é‡å¤é€šçŸ¥
```

### 4.2 æ™ºèƒ½å‘Šè­¦è¿‡æ»¤æœºåˆ¶


**ğŸ§  å‘Šè­¦å»é‡ä¸åˆå¹¶**

**åŸºæœ¬æ¦‚å¿µ**ï¼šç›¸åŒæˆ–ç›¸ä¼¼çš„å‘Šè­¦è¿›è¡Œå»é‡å¤„ç†ï¼Œé¿å…é‡å¤æ‰“æ‰°

```python
import hashlib
import time
from collections import defaultdict

class AlertFilter:
    def __init__(self):
        self.alert_cache = {}  # å­˜å‚¨å·²å‘é€çš„å‘Šè­¦
        self.suppress_duration = 300  # 5åˆ†é’Ÿå†…ç›¸åŒå‘Šè­¦åªå‘ä¸€æ¬¡
        self.correlation_rules = {}  # å‘Šè­¦å…³è”è§„åˆ™
    
    def generate_alert_key(self, alert):
        """ç”Ÿæˆå‘Šè­¦çš„å”¯ä¸€æ ‡è¯†"""
        key_parts = [
            alert.get('host', ''),
            alert.get('service', ''),
            alert.get('type', ''),
            alert.get('level', '')
        ]
        key_string = '|'.join(key_parts)
        return hashlib.md5(key_string.encode()).hexdigest()
    
    def should_send_alert(self, alert):
        """åˆ¤æ–­æ˜¯å¦åº”è¯¥å‘é€å‘Šè­¦"""
        alert_key = self.generate_alert_key(alert)
        current_time = time.time()
        
        # æ£€æŸ¥æ˜¯å¦åœ¨æŠ‘åˆ¶æ—¶é—´å†…
        if alert_key in self.alert_cache:
            last_sent_time = self.alert_cache[alert_key]
            if current_time - last_sent_time < self.suppress_duration:
                return False  # åœ¨æŠ‘åˆ¶æ—¶é—´å†…ï¼Œä¸å‘é€
        
        # æ›´æ–°å‘é€æ—¶é—´
        self.alert_cache[alert_key] = current_time
        return True
    
    def process_alert(self, alert):
        """å¤„ç†å‘Šè­¦"""
        if self.should_send_alert(alert):
            self.send_alert(alert)
            print(f"å‘é€å‘Šè­¦: {alert['message']}")
        else:
            print(f"å‘Šè­¦è¢«è¿‡æ»¤: {alert['message']}")
    
    def send_alert(self, alert):
        """å‘é€å‘Šè­¦ï¼ˆçŸ­ä¿¡ã€é‚®ä»¶ã€å¾®ä¿¡ç­‰ï¼‰"""
        # å®é™…çš„å‘Šè­¦å‘é€é€»è¾‘
        pass

# ä½¿ç”¨ç¤ºä¾‹
filter_system = AlertFilter()

# æ¨¡æ‹Ÿè¿ç»­çš„ç›¸åŒå‘Šè­¦
alerts = [
    {'host': 'web-01', 'service': 'nginx', 'type': 'down', 'level': 'critical', 'message': 'NginxæœåŠ¡å¼‚å¸¸'},
    {'host': 'web-01', 'service': 'nginx', 'type': 'down', 'level': 'critical', 'message': 'NginxæœåŠ¡å¼‚å¸¸'},
    {'host': 'web-01', 'service': 'nginx', 'type': 'down', 'level': 'critical', 'message': 'NginxæœåŠ¡å¼‚å¸¸'},
]

for alert in alerts:
    filter_system.process_alert(alert)
# è¾“å‡ºï¼šåªæœ‰ç¬¬ä¸€æ¡å‘Šè­¦ä¼šè¢«å‘é€ï¼Œåç»­é‡å¤å‘Šè­¦è¢«è¿‡æ»¤
```

### 4.3 å‘Šè­¦çº§åˆ«ä¸ä¼˜å…ˆçº§


**ğŸ“Š å‘Šè­¦åˆ†çº§ç®¡ç†**

```
å‘Šè­¦çº§åˆ«åˆ’åˆ†ï¼š

ğŸ”´ Criticalï¼ˆä¸¥é‡ï¼‰ï¼š
â€¢ æ ¸å¿ƒä¸šåŠ¡ä¸å¯ç”¨
â€¢ æ•°æ®ä¸¢å¤±é£é™©
â€¢ å®‰å…¨æ¼æ´
â€¢ å¤„ç†æ—¶é—´ï¼šç«‹å³ï¼ˆ5åˆ†é’Ÿå†…ï¼‰

ğŸŸ¡ Warningï¼ˆè­¦å‘Šï¼‰ï¼š  
â€¢ æ€§èƒ½ä¸‹é™
â€¢ å®¹é‡æ¥è¿‘é˜ˆå€¼
â€¢ éæ ¸å¿ƒåŠŸèƒ½å¼‚å¸¸
â€¢ å¤„ç†æ—¶é—´ï¼š1å°æ—¶å†…

ğŸŸ¢ Infoï¼ˆä¿¡æ¯ï¼‰ï¼š
â€¢ çŠ¶æ€å˜æ›´é€šçŸ¥
â€¢ æ—¥å¸¸æ“ä½œè®°å½•
â€¢ æ€§èƒ½ç»Ÿè®¡ä¿¡æ¯
â€¢ å¤„ç†æ—¶é—´ï¼šä¸‹ä¸ªå·¥ä½œæ—¥

ğŸ“± é€šçŸ¥æ–¹å¼ï¼š
â€¢ Criticalï¼šç”µè¯ + çŸ­ä¿¡ + é‚®ä»¶
â€¢ Warningï¼šçŸ­ä¿¡ + é‚®ä»¶  
â€¢ Infoï¼šä»…é‚®ä»¶
```

**æ™ºèƒ½çº§åˆ«åˆ¤æ–­**ï¼š
```python
class AlertLevelClassifier:
    def __init__(self):
        self.critical_keywords = ['down', 'å®•æœº', 'æ— æ³•è®¿é—®', 'æ•°æ®ä¸¢å¤±']
        self.warning_keywords = ['æ…¢', 'è¶…æ—¶', 'ä½¿ç”¨ç‡é«˜', 'è¿æ¥å¤±è´¥']
        self.business_critical_services = ['è®¢å•æœåŠ¡', 'æ”¯ä»˜æœåŠ¡', 'ç”¨æˆ·è®¤è¯']
    
    def classify_alert(self, alert):
        """æ™ºèƒ½åˆ†ç±»å‘Šè­¦çº§åˆ«"""
        message = alert.get('message', '').lower()
        service = alert.get('service', '')
        
        # ä¸šåŠ¡å…³é”®æœåŠ¡çš„å‘Šè­¦å‡çº§
        if service in self.business_critical_services:
            if any(keyword in message for keyword in self.warning_keywords):
                return 'critical'  # å…³é”®æœåŠ¡çš„è­¦å‘Šå‡çº§ä¸ºä¸¥é‡
        
        # åŸºäºå…³é”®è¯åˆ¤æ–­
        if any(keyword in message for keyword in self.critical_keywords):
            return 'critical'
        elif any(keyword in message for keyword in self.warning_keywords):
            return 'warning'
        else:
            return 'info'
    
    def get_notification_method(self, level):
        """æ ¹æ®çº§åˆ«ç¡®å®šé€šçŸ¥æ–¹å¼"""
        methods = {
            'critical': ['phone', 'sms', 'email'],
            'warning': ['sms', 'email'],
            'info': ['email']
        }
        return methods.get(level, ['email'])
```

### 4.4 å‘Šè­¦å…³è”åˆ†æ


**ğŸ”— æ ¹å› åˆ†æ**

**åŸºæœ¬æ¦‚å¿µ**ï¼šå½“å¤šä¸ªå‘Šè­¦åŒæ—¶å‘ç”Ÿæ—¶ï¼Œè‡ªåŠ¨åˆ†æå®ƒä»¬ä¹‹é—´çš„å…³è”å…³ç³»ï¼Œæ‰¾å‡ºæ ¹æœ¬åŸå› 

```
å…³è”åˆ†æç¤ºä¾‹ï¼š

æ ¹å› ï¼šç½‘ç»œäº¤æ¢æœºæ•…éšœ
   â†“
ç°è±¡1ï¼šWebæœåŠ¡å™¨è¿æ¥è¶…æ—¶
ç°è±¡2ï¼šæ•°æ®åº“è¿æ¥å¤±è´¥  
ç°è±¡3ï¼šç¼“å­˜æœåŠ¡å™¨æ— å“åº”
ç°è±¡4ï¼šè´Ÿè½½å‡è¡¡å™¨å¥åº·æ£€æŸ¥å¤±è´¥

ä¼ ç»Ÿå¤„ç†ï¼šæ”¶åˆ°4ä¸ªå‘Šè­¦ï¼Œéœ€è¦é€ä¸€å¤„ç†
æ™ºèƒ½å…³è”ï¼šè¯†åˆ«ä¸ºåŒä¸€æ ¹å› ï¼Œåªå‘é€1ä¸ªæ ¹å› å‘Šè­¦
```

```python
class AlertCorrelation:
    def __init__(self):
        self.correlation_rules = {
            'network_failure': {
                'root_cause': 'ç½‘ç»œæ•…éšœ',
                'symptoms': ['connection_timeout', 'unreachable', 'network_error']
            },
            'database_failure': {
                'root_cause': 'æ•°æ®åº“æ•…éšœ',
                'symptoms': ['db_connection_failed', 'query_timeout', 'deadlock']
            }
        }
        self.pending_alerts = []
        self.correlation_window = 60  # 60ç§’å†…çš„å‘Šè­¦è¿›è¡Œå…³è”åˆ†æ
    
    def add_alert(self, alert):
        """æ·»åŠ å‘Šè­¦å¹¶è¿›è¡Œå…³è”åˆ†æ"""
        current_time = time.time()
        self.pending_alerts.append({
            'alert': alert,
            'timestamp': current_time
        })
        
        # æ¸…ç†è¿‡æœŸçš„å‘Šè­¦
        self.clean_expired_alerts(current_time)
        
        # è¿›è¡Œå…³è”åˆ†æ
        root_cause = self.analyze_correlation()
        if root_cause:
            self.send_root_cause_alert(root_cause)
            self.clear_related_alerts(root_cause)
        else:
            # æ²¡æœ‰å…³è”ï¼Œæ­£å¸¸å‘é€å‘Šè­¦
            self.send_normal_alert(alert)
    
    def analyze_correlation(self):
        """åˆ†æå‘Šè­¦å…³è”"""
        alert_types = [item['alert'].get('type') for item in self.pending_alerts]
        
        for rule_name, rule in self.correlation_rules.items():
            symptoms = rule['symptoms']
            matched_symptoms = [symptom for symptom in symptoms if symptom in alert_types]
            
            # å¦‚æœåŒ¹é…åˆ°å¤šä¸ªç—‡çŠ¶ï¼Œè®¤ä¸ºæ‰¾åˆ°äº†æ ¹å› 
            if len(matched_symptoms) >= 2:
                return rule['root_cause']
        
        return None
```

---

## 5. ğŸ¥ æ•…éšœè‡ªæ„ˆç³»ç»Ÿæ¶æ„


### 5.1 è‡ªæ„ˆç³»ç»Ÿçš„æ ¸å¿ƒç†å¿µ


**ğŸ§¬ ä»€ä¹ˆæ˜¯æ•…éšœè‡ªæ„ˆ**
```
ç”Ÿç‰©å­¦ç±»æ¯”ï¼š
äººä½“å…ç–«ç³»ç»Ÿ = æ•…éšœè‡ªæ„ˆç³»ç»Ÿ
â€¢ æ£€æµ‹ç—…æ¯’ = æ£€æµ‹æ•…éšœ
â€¢ äº§ç”ŸæŠ—ä½“ = æ‰§è¡Œä¿®å¤  
â€¢ å½¢æˆè®°å¿† = å­¦ä¹ é¢„é˜²
â€¢ è‡ªåŠ¨æ„ˆåˆ = ç³»ç»Ÿæ¢å¤

æ ¸å¿ƒç›®æ ‡ï¼š
ç³»ç»Ÿèƒ½å¤Ÿåƒç”Ÿç‰©ä½“ä¸€æ ·ï¼Œè‡ªåŠ¨æ£€æµ‹ã€è¯Šæ–­ã€ä¿®å¤æ•…éšœï¼Œ
å¹¶ä¸”ä»æ•…éšœä¸­å­¦ä¹ ï¼Œæé«˜æœªæ¥çš„æŠ—é£é™©èƒ½åŠ›
```

### 5.2 è‡ªæ„ˆç³»ç»Ÿæ¶æ„è®¾è®¡


**ğŸ—ï¸ åˆ†å±‚æ¶æ„**
```
è‡ªæ„ˆç³»ç»Ÿæ¶æ„å›¾ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        å†³ç­–è°ƒåº¦å±‚              â”‚ â† å†³ç­–å¼•æ“ã€çŸ¥è¯†åº“
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        åˆ†æè¯Šæ–­å±‚              â”‚ â† æ•…éšœåˆ†æã€æ ¹å› å®šä½
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  
â”‚        æ£€æµ‹ç›‘æ§å±‚              â”‚ â† æŒ‡æ ‡é‡‡é›†ã€å¼‚å¸¸æ£€æµ‹
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        æ‰§è¡Œæ“ä½œå±‚              â”‚ â† æ¢å¤è„šæœ¬ã€è‡ªåŠ¨æ“ä½œ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        åŸºç¡€è®¾æ–½å±‚              â”‚ â† æœåŠ¡å™¨ã€ç½‘ç»œã€å­˜å‚¨
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å„å±‚åŠŸèƒ½è¯¦è§£**ï¼š
```
ğŸ” æ£€æµ‹ç›‘æ§å±‚ï¼š
â€¢ å®æ—¶ç›‘æ§ç³»ç»Ÿå„é¡¹æŒ‡æ ‡
â€¢ å¤šç»´åº¦å¼‚å¸¸æ£€æµ‹
â€¢ æ•…éšœäº‹ä»¶è§¦å‘

ğŸ§  åˆ†æè¯Šæ–­å±‚ï¼š  
â€¢ æ•…éšœç±»å‹è¯†åˆ«
â€¢ å½±å“èŒƒå›´è¯„ä¼°
â€¢ æ ¹å› åˆ†æå®šä½

ğŸ¯ å†³ç­–è°ƒåº¦å±‚ï¼š
â€¢ ä¿®å¤ç­–ç•¥é€‰æ‹©
â€¢ æ“ä½œæ‰§è¡Œè°ƒåº¦
â€¢ é£é™©è¯„ä¼°æ§åˆ¶

âš¡ æ‰§è¡Œæ“ä½œå±‚ï¼š
â€¢ è‡ªåŠ¨åŒ–è„šæœ¬æ‰§è¡Œ
â€¢ ç³»ç»Ÿæ“ä½œæ‰§è¡Œ
â€¢ æ¢å¤ç»“æœéªŒè¯
```

### 5.3 æ™ºèƒ½å†³ç­–å¼•æ“


**ğŸ¤– åŸºäºè§„åˆ™çš„å†³ç­–ç³»ç»Ÿ**

```python
class SelfHealingEngine:
    def __init__(self):
        self.healing_rules = {
            'high_cpu_usage': {
                'condition': lambda metrics: metrics.get('cpu_usage', 0) > 80,
                'actions': ['scale_out', 'restart_heavy_processes'],
                'priority': 'medium'
            },
            'memory_leak': {
                'condition': lambda metrics: metrics.get('memory_growth_rate', 0) > 10,
                'actions': ['restart_service', 'clear_cache'],
                'priority': 'high'
            },
            'disk_full': {
                'condition': lambda metrics: metrics.get('disk_usage', 0) > 90,
                'actions': ['clean_logs', 'archive_old_files'],
                'priority': 'high'
            },
            'service_down': {
                'condition': lambda metrics: not metrics.get('service_alive', True),
                'actions': ['restart_service', 'failover_to_backup'],
                'priority': 'critical'
            }
        }
        
        self.action_handlers = {
            'scale_out': self.scale_out_service,
            'restart_service': self.restart_service,
            'clean_logs': self.clean_old_logs,
            'failover_to_backup': self.failover_to_backup
        }
    
    def diagnose_and_heal(self, system_metrics):
        """è¯Šæ–­é—®é¢˜å¹¶æ‰§è¡Œè‡ªæ„ˆ"""
        # 1. é—®é¢˜è¯Šæ–­
        detected_issues = self.diagnose_issues(system_metrics)
        
        # 2. åˆ¶å®šä¿®å¤è®¡åˆ’
        healing_plan = self.create_healing_plan(detected_issues)
        
        # 3. æ‰§è¡Œä¿®å¤æ“ä½œ
        results = self.execute_healing_plan(healing_plan)
        
        # 4. éªŒè¯ä¿®å¤æ•ˆæœ
        success = self.verify_healing_results(results)
        
        return success
    
    def diagnose_issues(self, metrics):
        """è¯Šæ–­ç³»ç»Ÿé—®é¢˜"""
        issues = []
        for rule_name, rule in self.healing_rules.items():
            if rule['condition'](metrics):
                issues.append({
                    'type': rule_name,
                    'priority': rule['priority'],
                    'actions': rule['actions']
                })
        return issues
    
    def create_healing_plan(self, issues):
        """åˆ¶å®šä¿®å¤è®¡åˆ’"""
        # æŒ‰ä¼˜å…ˆçº§æ’åº
        priority_map = {'critical': 0, 'high': 1, 'medium': 2, 'low': 3}
        issues.sort(key=lambda x: priority_map.get(x['priority'], 3))
        
        plan = []
        for issue in issues:
            plan.extend(issue['actions'])
        
        # å»é‡å¹¶ä¿æŒé¡ºåº
        return list(dict.fromkeys(plan))
    
    def execute_healing_plan(self, plan):
        """æ‰§è¡Œä¿®å¤è®¡åˆ’"""
        results = []
        for action in plan:
            if action in self.action_handlers:
                try:
                    result = self.action_handlers[action]()
                    results.append({'action': action, 'success': True, 'result': result})
                except Exception as e:
                    results.append({'action': action, 'success': False, 'error': str(e)})
        return results
    
    def scale_out_service(self):
        """æ‰©å®¹æœåŠ¡"""
        # å®é™…çš„æ‰©å®¹é€»è¾‘
        print("æ­£åœ¨æ‰§è¡ŒæœåŠ¡æ‰©å®¹...")
        return "æ‰©å®¹å®Œæˆ"
    
    def restart_service(self):
        """é‡å¯æœåŠ¡"""
        print("æ­£åœ¨é‡å¯æœåŠ¡...")
        return "é‡å¯å®Œæˆ"
    
    def clean_old_logs(self):
        """æ¸…ç†æ—§æ—¥å¿—"""
        print("æ­£åœ¨æ¸…ç†æ—¥å¿—æ–‡ä»¶...")
        return "æ—¥å¿—æ¸…ç†å®Œæˆ"
```

### 5.4 å­¦ä¹ ä¸è¿›åŒ–æœºåˆ¶


**ğŸ“š æ•…éšœçŸ¥è¯†åº“å»ºè®¾**

**åŸºæœ¬æ¦‚å¿µ**ï¼šç³»ç»Ÿä»æ¯æ¬¡æ•…éšœå¤„ç†ä¸­å­¦ä¹ ï¼Œä¸æ–­å®Œå–„è‡ªå·±çš„"è¯Šç–—ç»éªŒ"

```python
class FaultKnowledgeBase:
    def __init__(self):
        self.fault_patterns = {}  # æ•…éšœæ¨¡å¼åº“
        self.solution_success_rate = {}  # è§£å†³æ–¹æ¡ˆæˆåŠŸç‡
        self.learning_enabled = True
    
    def record_fault_case(self, fault_signature, symptoms, solution, success):
        """è®°å½•æ•…éšœæ¡ˆä¾‹"""
        case = {
            'symptoms': symptoms,
            'solution': solution,
            'success': success,
            'timestamp': time.time()
        }
        
        if fault_signature not in self.fault_patterns:
            self.fault_patterns[fault_signature] = []
        
        self.fault_patterns[fault_signature].append(case)
        
        # æ›´æ–°è§£å†³æ–¹æ¡ˆæˆåŠŸç‡
        self.update_solution_success_rate(solution, success)
    
    def get_recommended_solution(self, fault_signature, symptoms):
        """åŸºäºå†å²ç»éªŒæ¨èè§£å†³æ–¹æ¡ˆ"""
        if fault_signature in self.fault_patterns:
            cases = self.fault_patterns[fault_signature]
            
            # æ‰¾åˆ°ç—‡çŠ¶æœ€ç›¸ä¼¼çš„æ¡ˆä¾‹
            best_match = None
            best_similarity = 0
            
            for case in cases:
                similarity = self.calculate_similarity(symptoms, case['symptoms'])
                if similarity > best_similarity:
                    best_similarity = similarity
                    best_match = case
            
            if best_match and best_similarity > 0.7:
                return best_match['solution']
        
        return None
    
    def calculate_similarity(self, symptoms1, symptoms2):
        """è®¡ç®—ç—‡çŠ¶ç›¸ä¼¼åº¦"""
        common_symptoms = set(symptoms1) & set(symptoms2)
        total_symptoms = set(symptoms1) | set(symptoms2)
        
        if not total_symptoms:
            return 0
        
        return len(common_symptoms) / len(total_symptoms)
    
    def update_solution_success_rate(self, solution, success):
        """æ›´æ–°è§£å†³æ–¹æ¡ˆæˆåŠŸç‡"""
        if solution not in self.solution_success_rate:
            self.solution_success_rate[solution] = {'success': 0, 'total': 0}
        
        self.solution_success_rate[solution]['total'] += 1
        if success:
            self.solution_success_rate[solution]['success'] += 1

# ä½¿ç”¨ç¤ºä¾‹
knowledge_base = FaultKnowledgeBase()

# è®°å½•ä¸€ä¸ªæˆåŠŸçš„æ•…éšœå¤„ç†æ¡ˆä¾‹
knowledge_base.record_fault_case(
    fault_signature="high_cpu_nginx",
    symptoms=["cpu_usage_high", "response_slow", "connection_timeout"],
    solution="restart_nginx_and_optimize_config",
    success=True
)

# å½“é‡åˆ°ç±»ä¼¼æ•…éšœæ—¶ï¼Œç³»ç»Ÿå¯ä»¥è‡ªåŠ¨æ¨èè§£å†³æ–¹æ¡ˆ
recommended = knowledge_base.get_recommended_solution(
    fault_signature="high_cpu_nginx",
    symptoms=["cpu_usage_high", "response_slow"]
)
```

---

## 6. ğŸ›ï¸ è‡ªåŠ¨åŒ–è¿ç»´å¹³å°å®è·µ


### 6.1 è¿ç»´å¹³å°æ•´ä½“æ¶æ„


**ğŸ¢ å¹³å°æ¶æ„æ¦‚è§ˆ**
```
è‡ªåŠ¨åŒ–è¿ç»´å¹³å°æ¶æ„ï¼š

                    å‰ç«¯ç•Œé¢
                       |
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              |                   |
         ç®¡ç†æ§åˆ¶å°           ç›‘æ§å¤§å±
              |                   |
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        |
                   APIç½‘å…³å±‚
                        |
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          |             |             |
    æ•…éšœæ£€æµ‹æ¨¡å—    è‡ªåŠ¨å¤„ç†æ¨¡å—    é€šçŸ¥å‘Šè­¦æ¨¡å—
          |             |             |
    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
  æŒ‡æ ‡é‡‡é›†   æ—¥å¿—åˆ†æ  è„šæœ¬å¼•æ“  å·¥ä½œæµ   çŸ­ä¿¡    é‚®ä»¶
    |         |       |       |     |      |
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
                        |
                   åŸºç¡€è®¾æ–½å±‚
              (æœåŠ¡å™¨ã€ç½‘ç»œã€å­˜å‚¨)
```

### 6.2 æ•…éšœå¤„ç†å·¥ä½œæµ


**âš™ï¸ æ ‡å‡†åŒ–æ•…éšœå¤„ç†æµç¨‹**

```python
class FaultHandlingWorkflow:
    def __init__(self):
        self.workflow_steps = [
            'fault_detection',      # æ•…éšœæ£€æµ‹
            'impact_assessment',    # å½±å“è¯„ä¼°
            'solution_selection',   # æ–¹æ¡ˆé€‰æ‹©
            'approval_check',       # å®¡æ‰¹æ£€æŸ¥
            'execution',           # æ‰§è¡Œæ“ä½œ
            'result_verification', # ç»“æœéªŒè¯
            'notification',        # é€šçŸ¥ç›¸å…³äººå‘˜
            'case_recording'       # æ¡ˆä¾‹è®°å½•
        ]
        
        self.step_handlers = {
            'fault_detection': self.detect_fault,
            'impact_assessment': self.assess_impact,
            'solution_selection': self.select_solution,
            'approval_check': self.check_approval,
            'execution': self.execute_solution,
            'result_verification': self.verify_result,
            'notification': self.send_notification,
            'case_recording': self.record_case
        }
    
    def process_fault(self, fault_info):
        """å¤„ç†æ•…éšœçš„å®Œæ•´å·¥ä½œæµ"""
        workflow_context = {
            'fault_info': fault_info,
            'results': {},
            'current_step': 0,
            'status': 'in_progress'
        }
        
        for step in self.workflow_steps:
            try:
                print(f"æ‰§è¡Œæ­¥éª¤: {step}")
                result = self.step_handlers[step](workflow_context)
                workflow_context['results'][step] = result
                
                # æ£€æŸ¥æ˜¯å¦éœ€è¦ä¸­æ–­æµç¨‹
                if result.get('should_stop', False):
                    break
                    
            except Exception as e:
                print(f"æ­¥éª¤ {step} æ‰§è¡Œå¤±è´¥: {str(e)}")
                workflow_context['status'] = 'failed'
                break
        
        return workflow_context
    
    def detect_fault(self, context):
        """æ•…éšœæ£€æµ‹æ­¥éª¤"""
        fault_info = context['fault_info']
        # éªŒè¯æ•…éšœä¿¡æ¯çš„å®Œæ•´æ€§
        required_fields = ['type', 'severity', 'affected_services']
        
        for field in required_fields:
            if field not in fault_info:
                return {'status': 'incomplete', 'should_stop': True}
        
        return {'status': 'detected', 'fault_confirmed': True}
    
    def assess_impact(self, context):
        """å½±å“è¯„ä¼°æ­¥éª¤"""
        fault_info = context['fault_info']
        severity = fault_info.get('severity', 'low')
        
        impact_level = {
            'critical': 'business_critical',
            'high': 'service_degraded', 
            'medium': 'partial_impact',
            'low': 'minimal_impact'
        }.get(severity, 'minimal_impact')
        
        return {'impact_level': impact_level, 'auto_approve': severity in ['low', 'medium']}
    
    def select_solution(self, context):
        """è§£å†³æ–¹æ¡ˆé€‰æ‹©"""
        fault_info = context['fault_info']
        fault_type = fault_info.get('type')
        
        # åŸºäºæ•…éšœç±»å‹é€‰æ‹©è§£å†³æ–¹æ¡ˆ
        solutions = {
            'service_down': ['restart_service', 'failover'],
            'high_cpu': ['scale_out', 'restart'],
            'disk_full': ['clean_logs', 'expand_storage'],
            'memory_leak': ['restart_service', 'heap_dump']
        }
        
        selected_solution = solutions.get(fault_type, ['manual_intervention'])
        return {'solution': selected_solution[0], 'alternatives': selected_solution[1:]}
    
    def check_approval(self, context):
        """å®¡æ‰¹æ£€æŸ¥"""
        impact_assessment = context['results']['impact_assessment']
        
        if impact_assessment.get('auto_approve', False):
            return {'approved': True, 'approval_type': 'auto'}
        else:
            # éœ€è¦äººå·¥å®¡æ‰¹
            return {'approved': False, 'approval_type': 'manual', 'should_stop': True}
    
    def execute_solution(self, context):
        """æ‰§è¡Œè§£å†³æ–¹æ¡ˆ"""
        solution_info = context['results']['solution_selection']
        solution = solution_info['solution']
        
        # æ‰§è¡Œå…·ä½“çš„è§£å†³æ–¹æ¡ˆ
        execution_result = self.execute_action(solution)
        
        return {
            'solution_executed': solution,
            'execution_success': execution_result['success'],
            'execution_details': execution_result
        }
    
    def execute_action(self, action):
        """æ‰§è¡Œå…·ä½“æ“ä½œ"""
        actions = {
            'restart_service': lambda: {'success': True, 'message': 'æœåŠ¡é‡å¯å®Œæˆ'},
            'failover': lambda: {'success': True, 'message': 'æ•…éšœåˆ‡æ¢å®Œæˆ'},
            'scale_out': lambda: {'success': True, 'message': 'æ‰©å®¹å®Œæˆ'},
            'clean_logs': lambda: {'success': True, 'message': 'æ—¥å¿—æ¸…ç†å®Œæˆ'}
        }
        
        if action in actions:
            return actions[action]()
        else:
            return {'success': False, 'message': f'æœªçŸ¥æ“ä½œ: {action}'}
```

### 6.3 è¿ç»´å¹³å°é›†æˆ


**ğŸ”— ä¸ç°æœ‰ç³»ç»Ÿçš„é›†æˆ**

```python
class OperationPlatform:
    def __init__(self):
        self.monitoring_systems = []  # ç›‘æ§ç³»ç»Ÿåˆ—è¡¨
        self.automation_tools = []    # è‡ªåŠ¨åŒ–å·¥å…·åˆ—è¡¨
        self.notification_channels = [] # é€šçŸ¥æ¸ é“åˆ—è¡¨
    
    def register_monitoring_system(self, system):
        """æ³¨å†Œç›‘æ§ç³»ç»Ÿ"""
        self.monitoring_systems.append(system)
    
    def register_automation_tool(self, tool):
        """æ³¨å†Œè‡ªåŠ¨åŒ–å·¥å…·"""
        self.automation_tools.append(tool)
    
    def collect_metrics_from_all_systems(self):
        """ä»æ‰€æœ‰ç›‘æ§ç³»ç»Ÿæ”¶é›†æŒ‡æ ‡"""
        all_metrics = {}
        
        for system in self.monitoring_systems:
            try:
                metrics = system.get_current_metrics()
                all_metrics[system.name] = metrics
            except Exception as e:
                print(f"ä» {system.name} æ”¶é›†æŒ‡æ ‡å¤±è´¥: {e}")
        
        return all_metrics
    
    def execute_automation_task(self, task_type, parameters):
        """æ‰§è¡Œè‡ªåŠ¨åŒ–ä»»åŠ¡"""
        for tool in self.automation_tools:
            if tool.supports_task_type(task_type):
                return tool.execute_task(task_type, parameters)
        
        raise Exception(f"æ²¡æœ‰æ‰¾åˆ°æ”¯æŒ {task_type} çš„è‡ªåŠ¨åŒ–å·¥å…·")

# é›†æˆç¤ºä¾‹
platform = OperationPlatform()

# æ³¨å†Œä¸åŒçš„ç›‘æ§ç³»ç»Ÿ
class PrometheusMonitoring:
    name = "prometheus"
    
    def get_current_metrics(self):
        # ä»Prometheusè·å–æŒ‡æ ‡
        return {"cpu_usage": 75, "memory_usage": 60}
    
    def supports_task_type(self, task_type):
        return False

class ZabbixMonitoring:
    name = "zabbix"
    
    def get_current_metrics(self):
        # ä»Zabbixè·å–æŒ‡æ ‡
        return {"disk_usage": 85, "network_io": 120}
    
    def supports_task_type(self, task_type):
        return False

# æ³¨å†Œè‡ªåŠ¨åŒ–å·¥å…·
class AnsibleAutomation:
    name = "ansible"
    
    def supports_task_type(self, task_type):
        return task_type in ['restart_service', 'deploy_config', 'scale_service']
    
    def execute_task(self, task_type, parameters):
        # æ‰§è¡ŒAnsibleå‰§æœ¬
        return f"é€šè¿‡Ansibleæ‰§è¡Œäº† {task_type}"

platform.register_monitoring_system(PrometheusMonitoring())
platform.register_monitoring_system(ZabbixMonitoring())
platform.register_automation_tool(AnsibleAutomation())
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ æ•…éšœè‡ªåŠ¨åŒ–å¤„ç†ï¼šç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹ã€åˆ†æã€å¤„ç†å’Œæ¢å¤æ•…éšœçš„èƒ½åŠ›
ğŸ”¸ è‡ªåŠ¨æ•…éšœæ£€æµ‹ï¼šé€šè¿‡å¿ƒè·³æ£€æŸ¥ã€é˜ˆå€¼ç›‘æ§ç­‰æ–¹å¼è‡ªåŠ¨å‘ç°é—®é¢˜
ğŸ”¸ è‡ªåŠ¨æ¢å¤æœºåˆ¶ï¼šé‡å¯ã€åˆ‡æ¢ã€é™çº§ç­‰è‡ªåŠ¨åŒ–æ¢å¤ç­–ç•¥
ğŸ”¸ æ™ºèƒ½å‘Šè­¦è¿‡æ»¤ï¼šå»é‡ã€åˆå¹¶ã€å…³è”åˆ†æï¼Œé¿å…å‘Šè­¦é£æš´
ğŸ”¸ æ•…éšœè‡ªæ„ˆç³»ç»Ÿï¼šå…·å¤‡å­¦ä¹ èƒ½åŠ›çš„æ™ºèƒ½æ•…éšœå¤„ç†ç³»ç»Ÿ
ğŸ”¸ è‡ªåŠ¨åŒ–è¿ç»´å¹³å°ï¼šé›†æˆç›‘æ§ã€å¤„ç†ã€é€šçŸ¥çš„ç»Ÿä¸€å¹³å°
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä¸ºä»€ä¹ˆéœ€è¦æ•…éšœè‡ªåŠ¨åŒ–**
```
æ—¶æ•ˆæ€§è¦æ±‚ï¼š
â€¢ ç°ä»£ä¸šåŠ¡7Ã—24å°æ—¶ä¸é—´æ–­
â€¢ æ•…éšœå½±å“ç›´æ¥è½¬åŒ–ä¸ºç»æµæŸå¤±
â€¢ äººå·¥å¤„ç†é€Ÿåº¦è¿œä¸èƒ½æ»¡è¶³éœ€æ±‚

è§„æ¨¡åŒ–è¦æ±‚ï¼š
â€¢ å¤§å‹ç³»ç»Ÿç»„ä»¶æ•°é‡åºå¤§
â€¢ äººå·¥ç›‘æ§æˆæœ¬é«˜ä¸”å®¹æ˜“é—æ¼
â€¢ è‡ªåŠ¨åŒ–æ˜¯è§„æ¨¡åŒ–è¿ç»´çš„å¿…ç„¶é€‰æ‹©
```

**ğŸ”¹ è‡ªåŠ¨åŒ–å¤„ç†çš„å±‚æ¬¡**
```
Level 1 - è‡ªåŠ¨æ£€æµ‹ï¼š
å‘ç°é—®é¢˜ä½†éœ€è¦äººå·¥å¤„ç†

Level 2 - è‡ªåŠ¨æ¢å¤ï¼š  
ç®€å•æ•…éšœå¯ä»¥è‡ªåŠ¨ä¿®å¤

Level 3 - è‡ªåŠ¨åˆ‡æ¢ï¼š
å¤æ‚æ•…éšœè‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡ç”¨æ–¹æ¡ˆ

Level 4 - è‡ªæ„ˆç³»ç»Ÿï¼š
å…·å¤‡å­¦ä¹ å’Œè¿›åŒ–èƒ½åŠ›
```

**ğŸ”¹ æ™ºèƒ½åŒ–çš„å‘å±•æ–¹å‘**
```
è§„åˆ™é©±åŠ¨ â†’ æ•°æ®é©±åŠ¨ â†’ AIé©±åŠ¨

è§„åˆ™é©±åŠ¨ï¼šåŸºäºé¢„è®¾è§„åˆ™å¤„ç†å·²çŸ¥é—®é¢˜
æ•°æ®é©±åŠ¨ï¼šåŸºäºå†å²æ•°æ®åˆ†æå’Œé¢„æµ‹
AIé©±åŠ¨ï¼šæœºå™¨å­¦ä¹ è‡ªåŠ¨å‘ç°è§„å¾‹å’Œä¼˜åŒ–ç­–ç•¥
```

### 7.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ ä¸šåŠ¡ä»·å€¼**
- **å¿«é€Ÿæ¢å¤**ï¼šæ•…éšœæ¢å¤æ—¶é—´ä»å°æ—¶çº§é™åˆ°åˆ†é’Ÿçº§
- **å‡å°‘æŸå¤±**ï¼šæœ€å°åŒ–ä¸šåŠ¡ä¸­æ–­æ—¶é—´å’Œç»æµæŸå¤±
- **æé«˜å¯ç”¨æ€§**ï¼šç³»ç»Ÿå¯ç”¨æ€§ä»99%æå‡åˆ°99.9%ä»¥ä¸Š
- **é™ä½æˆæœ¬**ï¼šå‡å°‘äººå·¥è¿ç»´æŠ•å…¥ï¼Œæé«˜è¿ç»´æ•ˆç‡

**ğŸ”§ æŠ€æœ¯ä»·å€¼**
- **æ ‡å‡†åŒ–**ï¼šå»ºç«‹æ ‡å‡†åŒ–çš„æ•…éšœå¤„ç†æµç¨‹
- **çŸ¥è¯†ç§¯ç´¯**ï¼šé€šè¿‡æ¡ˆä¾‹åº“ç§¯ç´¯æ•…éšœå¤„ç†ç»éªŒ
- **æŒç»­ä¼˜åŒ–**ï¼šåŸºäºæ•°æ®åˆ†ææŒç»­ä¼˜åŒ–å¤„ç†ç­–ç•¥
- **é£é™©æ§åˆ¶**ï¼šé€šè¿‡è‡ªåŠ¨åŒ–å‡å°‘äººä¸ºæ“ä½œé£é™©

### 7.4 å®æ–½å»ºè®®


**ğŸ“ å®æ–½æ­¥éª¤**
```
ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€è‡ªåŠ¨åŒ–
â€¢ å»ºç«‹ç›‘æ§å‘Šè­¦ä½“ç³»
â€¢ å®ç°åŸºæœ¬çš„è‡ªåŠ¨æ£€æµ‹
â€¢ å¼€å‘æ ¸å¿ƒæ•…éšœå¤„ç†è„šæœ¬

ç¬¬äºŒé˜¶æ®µï¼šæ™ºèƒ½åŒ–å‡çº§
â€¢ å®ç°æ™ºèƒ½å‘Šè­¦è¿‡æ»¤
â€¢ å»ºç«‹è‡ªåŠ¨æ¢å¤æœºåˆ¶
â€¢ é›†æˆå¤šä¸ªç›‘æ§ç³»ç»Ÿ

ç¬¬ä¸‰é˜¶æ®µï¼šå¹³å°åŒ–å»ºè®¾
â€¢ å»ºè®¾ç»Ÿä¸€è¿ç»´å¹³å°
â€¢ å®ç°å·¥ä½œæµè‡ªåŠ¨åŒ–
â€¢ å»ºç«‹æ•…éšœçŸ¥è¯†åº“

ç¬¬å››é˜¶æ®µï¼šæ™ºèƒ½è‡ªæ„ˆ
â€¢ å¼•å…¥æœºå™¨å­¦ä¹ ç®—æ³•
â€¢ å®ç°é¢„æµ‹æ€§ç»´æŠ¤
â€¢ å»ºç«‹è‡ªé€‚åº”ç³»ç»Ÿ
```

**âš ï¸ æ³¨æ„äº‹é¡¹**
```
å®‰å…¨è€ƒè™‘ï¼š
â€¢ è‡ªåŠ¨åŒ–æ“ä½œæƒé™æ§åˆ¶
â€¢ é‡è¦æ“ä½œéœ€è¦å®¡æ‰¹æœºåˆ¶
â€¢ æ“ä½œæ—¥å¿—å®Œæ•´è®°å½•

å¯é æ€§ä¿è¯ï¼š
â€¢ è‡ªåŠ¨åŒ–ç³»ç»Ÿæœ¬èº«çš„é«˜å¯ç”¨
â€¢ å›æ»šæœºåˆ¶å’Œå¤±è´¥å¤„ç†
â€¢ äººå·¥å¹²é¢„çš„ç´§æ€¥é€šé“

é€æ­¥æ¼”è¿›ï¼š
â€¢ ä»ç®€å•åœºæ™¯å¼€å§‹
â€¢ ç§¯ç´¯ç»éªŒåæ‰©å±•èŒƒå›´
â€¢ æŒç»­ç›‘æ§å’Œä¼˜åŒ–æ•ˆæœ
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- æ•…éšœè‡ªåŠ¨åŒ–æ˜¯ç°ä»£è¿ç»´çš„å¿…ç„¶è¶‹åŠ¿
- æ™ºèƒ½å‘Šè­¦è¿‡æ»¤æ˜¯è§£å†³å‘Šè­¦é£æš´çš„å…³é”®
- è‡ªæ„ˆç³»ç»Ÿéœ€è¦å…·å¤‡å­¦ä¹ å’Œè¿›åŒ–èƒ½åŠ›
- å®æ–½éœ€è¦å¾ªåºæ¸è¿›ï¼Œå®‰å…¨ç¬¬ä¸€