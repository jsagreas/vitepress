---
title: 32ã€åˆ†å¸ƒå¼ç¯å¢ƒæ…¢æŸ¥è¯¢ç®¡ç†
---
## ğŸ“š ç›®å½•

1. [åˆ†å¸ƒå¼ç¯å¢ƒæ…¢æŸ¥è¯¢æ¦‚è¿°](#1-åˆ†å¸ƒå¼ç¯å¢ƒæ…¢æŸ¥è¯¢æ¦‚è¿°)
2. [å¤šå®ä¾‹æ…¢æŸ¥è¯¢æ±‡æ€»](#2-å¤šå®ä¾‹æ…¢æŸ¥è¯¢æ±‡æ€»)
3. [è¯»å†™åˆ†ç¦»ç¯å¢ƒç›‘æ§](#3-è¯»å†™åˆ†ç¦»ç¯å¢ƒç›‘æ§)
4. [åˆ†åº“åˆ†è¡¨æŸ¥è¯¢åˆ†æ](#4-åˆ†åº“åˆ†è¡¨æŸ¥è¯¢åˆ†æ)
5. [ä¸­é—´ä»¶å±‚é¢ç›‘æ§](#5-ä¸­é—´ä»¶å±‚é¢ç›‘æ§)
6. [å…¨é“¾è·¯æŸ¥è¯¢è·Ÿè¸ª](#6-å…¨é“¾è·¯æŸ¥è¯¢è·Ÿè¸ª)
7. [åˆ†å¸ƒå¼äº‹åŠ¡åˆ†æ](#7-åˆ†å¸ƒå¼äº‹åŠ¡åˆ†æ)
8. [è·¨åº“æŸ¥è¯¢ä¼˜åŒ–](#8-è·¨åº“æŸ¥è¯¢ä¼˜åŒ–)
9. [æ•°æ®åŒæ­¥å»¶è¿Ÿå½±å“](#9-æ•°æ®åŒæ­¥å»¶è¿Ÿå½±å“)
10. [åˆ†å¸ƒå¼ç›‘æ§æ–¹æ¡ˆ](#10-åˆ†å¸ƒå¼ç›‘æ§æ–¹æ¡ˆ)
11. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#11-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ åˆ†å¸ƒå¼ç¯å¢ƒæ…¢æŸ¥è¯¢æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ç¯å¢ƒçš„æ…¢æŸ¥è¯¢


**é€šä¿—ç†è§£**ï¼šå°±åƒç®¡ç†å¤šå®¶åˆ†åº—ä¸€æ ·ï¼Œæ¯å®¶åº—éƒ½å¯èƒ½å‡ºç°æœåŠ¡æ…¢çš„é—®é¢˜

```
ä¼ ç»Ÿå•æœºç¯å¢ƒï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åº”ç”¨ç¨‹åº   â”‚
â”‚      â†“      â”‚
â”‚  MySQLæ•°æ®åº“ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
é—®é¢˜ç®€å•ï¼šåªéœ€è¦çœ‹ä¸€ä¸ªæ•°æ®åº“çš„æ…¢æŸ¥è¯¢

åˆ†å¸ƒå¼ç¯å¢ƒï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åº”ç”¨ç¨‹åº   â”‚â”€â”€â”€â†’â”‚ ä¸­é—´ä»¶    â”‚â”€â”€â”€â†’â”‚  æ•°æ®åº“1  â”‚
â”‚             â”‚    â”‚          â”‚â”€â”€â”€â†’â”‚  æ•°æ®åº“2  â”‚
â”‚             â”‚    â”‚          â”‚â”€â”€â”€â†’â”‚  æ•°æ®åº“3  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
é—®é¢˜å¤æ‚ï¼šéœ€è¦ç»¼åˆåˆ†æå¤šä¸ªç»„ä»¶çš„æ€§èƒ½
```

### 1.2 åˆ†å¸ƒå¼ç¯å¢ƒçš„æŒ‘æˆ˜


**ğŸ”¸ å¤æ‚æ€§å¢åŠ **
```
å•æœºé—®é¢˜ï¼š
- æŸ¥è¯¢æ…¢äº† â†’ ç›´æ¥çœ‹MySQLæ…¢æŸ¥è¯¢æ—¥å¿—
- æ‰¾åˆ°é—®é¢˜SQL â†’ ç›´æ¥ä¼˜åŒ–

åˆ†å¸ƒå¼é—®é¢˜ï¼š
- å“åº”æ…¢äº† â†’ å¯èƒ½æ˜¯ç½‘ç»œã€ä¸­é—´ä»¶ã€æŸä¸ªDBå®ä¾‹
- SQLè¢«æ‹†åˆ† â†’ åŸå§‹SQLå’Œå®é™…æ‰§è¡Œçš„ä¸ä¸€æ ·
- è·¨åº“æŸ¥è¯¢ â†’ éœ€è¦å¤šæ¬¡æ•°æ®åº“äº¤äº’
- æ•°æ®åŒæ­¥ â†’ ä¸»ä»å»¶è¿Ÿå¯¼è‡´çš„æ•°æ®ä¸ä¸€è‡´
```

**ğŸ”¸ ç›‘æ§éš¾ç‚¹**
- **ä½ç½®åˆ†æ•£**ï¼šæ…¢æŸ¥è¯¢å¯èƒ½å‘ç”Ÿåœ¨ä»»ä½•ä¸€ä¸ªæ•°æ®åº“å®ä¾‹
- **å…³è”å›°éš¾**ï¼šä¸€ä¸ªä¸šåŠ¡è¯·æ±‚å¯èƒ½æ¶‰åŠå¤šä¸ªæ•°æ®åº“æ“ä½œ
- **å®šä½å¤æ‚**ï¼šé—®é¢˜å¯èƒ½å‡ºç°åœ¨åº”ç”¨ã€ä¸­é—´ä»¶ã€æ•°æ®åº“ä»»ä½•ä¸€å±‚

### 1.3 åˆ†å¸ƒå¼æ…¢æŸ¥è¯¢çš„ç‰¹ç‚¹


> ğŸ’¡ **æ ¸å¿ƒç†è§£**ï¼šåˆ†å¸ƒå¼ç¯å¢ƒçš„æ…¢æŸ¥è¯¢ä¸åªæ˜¯SQLæ…¢ï¼Œè¿˜åŒ…æ‹¬æ•´ä¸ªé“¾è·¯çš„æ€§èƒ½é—®é¢˜

**ä¸»è¦è¡¨ç°**ï¼š
```
ğŸ”¸ æŸ¥è¯¢æ‹†åˆ†æ•ˆåº”
åŸå§‹æŸ¥è¯¢ï¼šSELECT * FROM user_order WHERE user_id = 123
å®é™…æ‰§è¡Œï¼š
- å…ˆæŸ¥ç”¨æˆ·åº“ï¼šSELECT * FROM user WHERE id = 123
- å†æŸ¥è®¢å•åº“ï¼šSELECT * FROM order WHERE user_id = 123
- æœ€ååˆå¹¶ç»“æœ

ğŸ”¸ ç½‘ç»œå¼€é”€
- å•æœºï¼šå†…å­˜è®¿é—®ï¼ˆçº³ç§’çº§ï¼‰
- åˆ†å¸ƒå¼ï¼šç½‘ç»œä¼ è¾“ï¼ˆæ¯«ç§’çº§ï¼‰
- å¤šæ¬¡ç½‘ç»œäº¤äº’ç´¯ç§¯å»¶è¿Ÿ

ğŸ”¸ äº‹åŠ¡å¤æ‚åº¦
- å•æœºï¼šç®€å•çš„ACIDäº‹åŠ¡
- åˆ†å¸ƒå¼ï¼šéœ€è¦åˆ†å¸ƒå¼äº‹åŠ¡åè°ƒ
- ä¸¤é˜¶æ®µæäº¤å¸¦æ¥é¢å¤–å¼€é”€
```

---

## 2. ğŸ“Š å¤šå®ä¾‹æ…¢æŸ¥è¯¢æ±‡æ€»


### 2.1 å¤šå®ä¾‹ç¯å¢ƒçš„æŒ‘æˆ˜


**ç°å®åœºæ™¯**ï¼šä¸€ä¸ªç”µå•†ç³»ç»Ÿå¯èƒ½æœ‰è¿™æ ·çš„æ¶æ„
```
ç”¨æˆ·æ•°æ®åº“é›†ç¾¤ï¼š
â”œâ”€ user-db-master-01
â”œâ”€ user-db-slave-01-01
â”œâ”€ user-db-slave-01-02
â””â”€ user-db-slave-01-03

è®¢å•æ•°æ®åº“é›†ç¾¤ï¼š
â”œâ”€ order-db-master-01
â”œâ”€ order-db-slave-01-01
â””â”€ order-db-slave-01-02

å•†å“æ•°æ®åº“é›†ç¾¤ï¼š
â”œâ”€ product-db-master-01
â”œâ”€ product-db-slave-01-01
â””â”€ product-db-slave-01-02
```

**é—®é¢˜**ï¼šæ¯ä¸ªæ•°æ®åº“å®ä¾‹éƒ½æœ‰è‡ªå·±çš„æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå¦‚ä½•ç»Ÿä¸€ç®¡ç†ï¼Ÿ

### 2.2 æ…¢æŸ¥è¯¢æ—¥å¿—æ”¶é›†æ¶æ„


**ğŸ”§ é›†ä¸­åŒ–æ”¶é›†æ–¹æ¡ˆ**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   DBå®ä¾‹1    â”‚    â”‚   DBå®ä¾‹2    â”‚    â”‚   DBå®ä¾‹3    â”‚
â”‚             â”‚    â”‚             â”‚    â”‚             â”‚
â”‚ slow.log    â”‚    â”‚ slow.log    â”‚    â”‚ slow.log    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                  â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
                    â”‚  æ—¥å¿—æ”¶é›†  â”‚
                    â”‚  (Fluentd) â”‚
                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                          â”‚
                    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
                    â”‚ åˆ†æå¤„ç†   â”‚
                    â”‚(Logstash) â”‚
                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                          â”‚
                    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
                    â”‚ å­˜å‚¨å±•ç¤º   â”‚
                    â”‚(ES+Kibana)â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ› ï¸ å®é™…é…ç½®ç¤ºä¾‹**

```bash
# 1. åœ¨æ¯ä¸ªMySQLå®ä¾‹å¯ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—
[mysqld]
slow_query_log = ON
slow_query_log_file = /var/log/mysql/slow.log
long_query_time = 0.1
log_queries_not_using_indexes = ON

# 2. ä½¿ç”¨Filebeatæ”¶é›†æ—¥å¿—
# filebeat.yml
filebeat.inputs:
- type: log
  enabled: true
  paths:
    - /var/log/mysql/slow.log
  fields:
    service: mysql
    instance: ${MYSQL_INSTANCE_NAME}
  multiline.pattern: '^# Time:'
  multiline.negate: true
  multiline.match: after

output.elasticsearch:
  hosts: ["elasticsearch:9200"]
  index: "mysql-slow-logs-%{+yyyy.MM.dd}"
```

### 2.3 å¤šå®ä¾‹æ±‡æ€»åˆ†æ


**ğŸ“ˆ æ±‡æ€»ç»´åº¦åˆ†æ**

```sql
-- 1. æŒ‰å®ä¾‹ç»Ÿè®¡æ…¢æŸ¥è¯¢æ•°é‡
SELECT 
    instance_name,
    COUNT(*) as slow_query_count,
    AVG(query_time) as avg_query_time,
    MAX(query_time) as max_query_time
FROM slow_query_summary 
WHERE timestamp >= NOW() - INTERVAL 1 HOUR
GROUP BY instance_name
ORDER BY slow_query_count DESC;

-- 2. æŒ‰SQLæ¨¡å¼æ±‡æ€»ï¼ˆå»é™¤å…·ä½“å‚æ•°å€¼ï¼‰
SELECT 
    sql_pattern,
    COUNT(*) as occurrence_count,
    COUNT(DISTINCT instance_name) as affected_instances,
    AVG(query_time) as avg_time
FROM slow_query_normalized
WHERE timestamp >= NOW() - INTERVAL 1 DAY
GROUP BY sql_pattern
HAVING occurrence_count > 10
ORDER BY occurrence_count DESC;
```

**ğŸ¯ å…³é”®ç›‘æ§æŒ‡æ ‡**

> ğŸ“Š **å®ä¾‹çº§åˆ«æŒ‡æ ‡**
> - æ…¢æŸ¥è¯¢æ€»æ•°ï¼šæ¯ä¸ªå®ä¾‹çš„æ…¢æŸ¥è¯¢æ•°é‡
> - å¹³å‡æ‰§è¡Œæ—¶é—´ï¼šåæ˜ å®ä¾‹æ•´ä½“æ€§èƒ½
> - æ…¢æŸ¥è¯¢å¢é•¿ç‡ï¼šæ˜¯å¦æœ‰çªå‘æ€§èƒ½é—®é¢˜

> ğŸ“Š **SQLçº§åˆ«æŒ‡æ ‡**  
> - è·¨å®ä¾‹SQLï¼šåŒä¸€ä¸ªSQLåœ¨å¤šä¸ªå®ä¾‹éƒ½æ…¢
> - å®ä¾‹ç‰¹æœ‰SQLï¼šåªåœ¨æŸä¸ªå®ä¾‹æ…¢çš„SQL
> - æ—¶é—´è¶‹åŠ¿ï¼šæ…¢æŸ¥è¯¢çš„æ—¶é—´åˆ†å¸ƒæ¨¡å¼

### 2.4 å¤šå®ä¾‹é—®é¢˜å®šä½


**ğŸ” é—®é¢˜åˆ†ææ€è·¯**

```
æ­¥éª¤1ï¼šå…¨å±€æ¦‚è§ˆ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä»Šæ—¥æ…¢æŸ¥è¯¢æ€»æ•°ï¼š1,234              â”‚
â”‚ æ¶‰åŠå®ä¾‹ï¼š8ä¸ª                       â”‚
â”‚ æœ€ä¸¥é‡å®ä¾‹ï¼šorder-db-01 (456ä¸ª)     â”‚
â”‚ æœ€æ…¢SQLï¼šUPDATE user SET...        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ­¥éª¤2ï¼šå®ä¾‹å¯¹æ¯”
å®ä¾‹åç§°        æ…¢æŸ¥è¯¢æ•°    å¹³å‡æ—¶é—´    è´Ÿè½½
order-db-01        456       2.3s      85%
user-db-01         234       1.2s      60%
product-db-01      123       0.8s      45%

æ­¥éª¤3ï¼šSQLåˆ†æ
SQLç±»å‹         å‡ºç°æ¬¡æ•°    æ¶‰åŠå®ä¾‹    å»ºè®®æ“ä½œ
UPDATE user        89         3ä¸ª      æ·»åŠ ç´¢å¼•
SELECT order      156         2ä¸ª      ä¼˜åŒ–WHEREæ¡ä»¶
INSERT log        234         1ä¸ª      æ‰¹é‡æ’å…¥ä¼˜åŒ–
```

---

## 3. ğŸ”„ è¯»å†™åˆ†ç¦»ç¯å¢ƒç›‘æ§


### 3.1 è¯»å†™åˆ†ç¦»æ¶æ„ç†è§£


**é€šä¿—è§£é‡Š**ï¼šå°±åƒé“¶è¡Œçš„æœåŠ¡çª—å£åˆ†å·¥

```
ä¼ ç»Ÿæ¨¡å¼ï¼ˆä¸€ä¸ªçª—å£å¤„ç†æ‰€æœ‰ä¸šåŠ¡ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åº”ç”¨ç¨‹åº   â”‚
â”‚      â†“      â”‚
â”‚ MySQLä¸»åº“   â”‚ â† è¯»å†™éƒ½åœ¨è¿™é‡Œï¼Œå‹åŠ›å¤§
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è¯»å†™åˆ†ç¦»æ¨¡å¼ï¼ˆä¸“é—¨çª—å£ä¸“é—¨æœåŠ¡ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åº”ç”¨ç¨‹åº   â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”˜
      â”‚   â”‚
   å†™æ“ä½œ è¯»æ“ä½œ
      â”‚   â”‚
      â–¼   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¸»åº“    â”‚â†’â”‚ ä»åº“1   â”‚ â”‚ ä»åº“2   â”‚
â”‚(Master) â”‚ â”‚(Slave1) â”‚ â”‚(Slave2) â”‚ 
â”‚ åªå†™    â”‚ â”‚ åªè¯»    â”‚ â”‚ åªè¯»    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 è¯»å†™åˆ†ç¦»çš„æ…¢æŸ¥è¯¢ç‰¹ç‚¹


**ğŸ”¸ ä¸»åº“æ…¢æŸ¥è¯¢**
```
ç‰¹ç‚¹ï¼š
- ä¸»è¦æ˜¯å†™æ“ä½œï¼šINSERTã€UPDATEã€DELETE
- å½±å“é¢å¤§ï¼šå†™å…¥æ…¢ä¼šå½±å“æ‰€æœ‰ä¸šåŠ¡
- é”ç«äº‰ï¼šå†™æ“ä½œå®¹æ˜“äº§ç”Ÿé”ç­‰å¾…

å¸¸è§é—®é¢˜ï¼š
âœ— å¤§æ‰¹é‡UPDATEæ²¡æœ‰åˆé€‚ç´¢å¼•
âœ— é•¿äº‹åŠ¡æŒæœ‰é”æ—¶é—´è¿‡é•¿  
âœ— ä¸»ä»åŒæ­¥çš„binlogå†™å…¥æ…¢
```

**ğŸ”¸ ä»åº“æ…¢æŸ¥è¯¢**
```
ç‰¹ç‚¹ï¼š
- ä¸»è¦æ˜¯è¯»æ“ä½œï¼šSELECTæŸ¥è¯¢
- æ•°æ®å»¶è¿Ÿï¼šå¯èƒ½è¯»åˆ°æ—§æ•°æ®
- å¤åˆ¶å»¶è¿Ÿï¼šä¸»ä»åŒæ­¥è·Ÿä¸ä¸Š

å¸¸è§é—®é¢˜ï¼š
âœ— å¤æ‚çš„ç»Ÿè®¡æŸ¥è¯¢æ²¡æœ‰åˆé€‚ç´¢å¼•
âœ— å¤§è¡¨çš„å…¨è¡¨æ‰«æ
âœ— ä¸»ä»å»¶è¿Ÿå¯¼è‡´çš„é‡å¤æŸ¥è¯¢
```

### 3.3 è¯»å†™åˆ†ç¦»ç›‘æ§è¦ç‚¹


**ğŸ“Š ä¸»åº“ç›‘æ§é‡ç‚¹**

```sql
-- ç›‘æ§å†™æ“ä½œçš„æ…¢æŸ¥è¯¢
SELECT 
    SUBSTRING(sql_text, 1, 50) as sql_preview,
    operation_type,
    query_time,
    rows_affected,
    timestamp
FROM slow_query_log 
WHERE server_role = 'master'
AND operation_type IN ('UPDATE', 'INSERT', 'DELETE')
AND query_time > 1.0
ORDER BY query_time DESC
LIMIT 20;
```

**ğŸ“Š ä»åº“ç›‘æ§é‡ç‚¹**

```sql
-- ç›‘æ§è¯»æ“ä½œçš„æ…¢æŸ¥è¯¢
SELECT 
    sql_text,
    query_time,
    rows_examined,
    rows_sent,
    timestamp
FROM slow_query_log 
WHERE server_role = 'slave'
AND operation_type = 'SELECT'
AND rows_examined > 10000  -- æ‰«æè¡Œæ•°è¿‡å¤š
ORDER BY query_time DESC;
```

### 3.4 ä¸»ä»å»¶è¿Ÿå¯¹æ…¢æŸ¥è¯¢çš„å½±å“


**ğŸ”¸ å»¶è¿Ÿäº§ç”Ÿçš„é—®é¢˜**

```
åœºæ™¯æè¿°ï¼š
æ—¶é—´ç‚¹1ï¼šç”¨æˆ·ä¸‹å• â†’ ä¸»åº“å†™å…¥è®¢å•æ•°æ®
æ—¶é—´ç‚¹2ï¼šç”¨æˆ·æŸ¥è¯¢è®¢å• â†’ ä»åº“è¿˜æ²¡æœ‰è¿™æ¡æ•°æ®
ç»“æœï¼šæŸ¥è¯¢ä¸åˆ°ï¼Œä¸šåŠ¡é‡è¯• â†’ å¢åŠ æ•°æ®åº“å‹åŠ›

å»¶è¿Ÿç›‘æ§ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¸»ä»å»¶è¿Ÿç›‘æ§                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å½“å‰å»¶è¿Ÿï¼š2.3ç§’                         â”‚
â”‚ å»¶è¿ŸçŠ¶æ€ï¼šâš ï¸ è­¦å‘Šï¼ˆ>2ç§’ï¼‰                â”‚
â”‚ å½±å“ä¸šåŠ¡ï¼šè®¢å•æŸ¥è¯¢ã€ç”¨æˆ·ä¿¡æ¯æ›´æ–°         â”‚
â”‚ å»ºè®®æ“ä½œï¼šæ£€æŸ¥ä»åº“æ€§èƒ½ï¼Œè€ƒè™‘è¯»ä¸»åº“       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ› ï¸ å»¶è¿Ÿç›‘æ§SQL**

```sql
-- æ£€æŸ¥ä¸»ä»å»¶è¿Ÿ
SHOW SLAVE STATUS\G

-- å…³é”®æŒ‡æ ‡
Seconds_Behind_Master: 2    -- å»¶è¿Ÿç§’æ•°
SQL_Delay: 0               -- äººä¸ºè®¾ç½®çš„å»¶è¿Ÿ
Slave_SQL_Running: Yes     -- SQLçº¿ç¨‹æ˜¯å¦æ­£å¸¸
Slave_IO_Running: Yes      -- IOçº¿ç¨‹æ˜¯å¦æ­£å¸¸
```

---

## 4. ğŸ—‚ï¸ åˆ†åº“åˆ†è¡¨æŸ¥è¯¢åˆ†æ


### 4.1 åˆ†åº“åˆ†è¡¨åŸºæœ¬æ¦‚å¿µ


**é€šä¿—ç†è§£**ï¼šå°±åƒæŠŠä¸€ä¸ªå¤§ä»“åº“åˆ†æˆå¤šä¸ªå°ä»“åº“

```
åŸå§‹å¤§è¡¨ï¼ˆ1000ä¸‡ç”¨æˆ·æ•°æ®ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           user_table            â”‚
â”‚  user_id | name | age | city    â”‚
â”‚     1    | å¼ ä¸‰ | 25  | åŒ—äº¬    â”‚
â”‚     2    | æå›› | 30  | ä¸Šæµ·    â”‚
â”‚    ...   | ... | ... | ...     â”‚
â”‚ 10000000 | ç‹äº” | 28  | æ·±åœ³    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
é—®é¢˜ï¼šè¡¨å¤ªå¤§ï¼ŒæŸ¥è¯¢æ…¢ï¼Œç»´æŠ¤å›°éš¾

åˆ†åº“åˆ†è¡¨åï¼š
æ•°æ®åº“1ï¼š              æ•°æ®åº“2ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   user_table_0  â”‚    â”‚   user_table_1  â”‚
â”‚ ç”¨æˆ·ID: 1-500ä¸‡  â”‚    â”‚ ç”¨æˆ·ID:501-1000ä¸‡â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ä¼˜åŠ¿ï¼šæ¯ä¸ªè¡¨å˜å°ï¼ŒæŸ¥è¯¢å˜å¿«
```

### 4.2 åˆ†åº“åˆ†è¡¨çš„æ…¢æŸ¥è¯¢æŒ‘æˆ˜


**ğŸ”¸ æŸ¥è¯¢è·¯ç”±å¤æ‚åŒ–**

```
åŸå§‹æŸ¥è¯¢ï¼š
SELECT * FROM user WHERE user_id = 123456;
æ‰§è¡Œè¿‡ç¨‹ï¼šç›´æ¥æŸ¥è¯¢ï¼Œç®€å•å¿«é€Ÿ

åˆ†åº“åˆ†è¡¨åï¼š
SELECT * FROM user WHERE user_id = 123456;
æ‰§è¡Œè¿‡ç¨‹ï¼š
1. è®¡ç®—åˆ†ç‰‡ï¼š123456 % 2 = 0ï¼Œè·¯ç”±åˆ°æ•°æ®åº“1
2. ç¡®å®šè¡¨åï¼šuser_table_0  
3. æ‰§è¡ŒæŸ¥è¯¢ï¼šSELECT * FROM user_table_0 WHERE user_id = 123456;
å¢åŠ äº†è·¯ç”±è®¡ç®—çš„å¼€é”€
```

**ğŸ”¸ è·¨åˆ†ç‰‡æŸ¥è¯¢é—®é¢˜**

```
å¤æ‚æŸ¥è¯¢ç¤ºä¾‹ï¼š
SELECT * FROM user WHERE age > 25 AND city = 'åŒ—äº¬';

é—®é¢˜åˆ†æï¼š
- ageå’Œcityéƒ½ä¸æ˜¯åˆ†ç‰‡é”®(user_id)
- æ— æ³•ç¡®å®šæ•°æ®åœ¨å“ªä¸ªåˆ†ç‰‡
- éœ€è¦æŸ¥è¯¢æ‰€æœ‰åˆ†ç‰‡ç„¶ååˆå¹¶ç»“æœ

æ‰§è¡Œè¿‡ç¨‹ï¼š
å¹¶è¡ŒæŸ¥è¯¢ â†’ â”Œâ”€ æ•°æ®åº“1: SELECT * FROM user_table_0 WHERE age>25 AND city='åŒ—äº¬'
           â””â”€ æ•°æ®åº“2: SELECT * FROM user_table_1 WHERE age>25 AND city='åŒ—äº¬'
                          â†“
                    åˆå¹¶ç»“æœ + æ’åº/åˆ†é¡µ
```

### 4.3 åˆ†ç‰‡æ…¢æŸ¥è¯¢ç›‘æ§


**ğŸ“Š åˆ†ç‰‡æ€§èƒ½å¯¹æ¯”**

```sql
-- å„åˆ†ç‰‡æ…¢æŸ¥è¯¢ç»Ÿè®¡
SELECT 
    shard_name,
    COUNT(*) as slow_count,
    AVG(query_time) as avg_time,
    SUM(CASE WHEN operation = 'cross_shard' THEN 1 ELSE 0 END) as cross_shard_count
FROM slow_query_sharded
WHERE timestamp >= NOW() - INTERVAL 1 HOUR
GROUP BY shard_name
ORDER BY slow_count DESC;

-- è·¨åˆ†ç‰‡æŸ¥è¯¢åˆ†æ
SELECT 
    sql_pattern,
    COUNT(*) as occurrence,
    AVG(total_time) as avg_total_time,
    AVG(merge_time) as avg_merge_time,
    involved_shards
FROM cross_shard_queries
WHERE timestamp >= NOW() - INTERVAL 1 DAY
GROUP BY sql_pattern
ORDER BY occurrence DESC;
```

### 4.4 åˆ†åº“åˆ†è¡¨ä¼˜åŒ–ç­–ç•¥


**ğŸ¯ æŸ¥è¯¢ä¼˜åŒ–åŸåˆ™**

> ğŸ’¡ **æ ¸å¿ƒæ€è·¯**ï¼šå°½é‡é¿å…è·¨åˆ†ç‰‡æŸ¥è¯¢ï¼Œå°†æŸ¥è¯¢é™åˆ¶åœ¨å•ä¸ªåˆ†ç‰‡å†…

**ä¼˜åŒ–æ–¹æ³•**ï¼š
```
1. åˆ†ç‰‡é”®é€‰æ‹©ä¼˜åŒ–
   âŒ é”™è¯¯ï¼šæŒ‰æ—¶é—´åˆ†ç‰‡ï¼Œä½†ç»å¸¸æŒ‰ç”¨æˆ·æŸ¥è¯¢
   âœ… æ­£ç¡®ï¼šæŒ‰ç”¨æˆ·IDåˆ†ç‰‡ï¼Œä¸šåŠ¡ä¸»è¦æŒ‰ç”¨æˆ·æ“ä½œ

2. æŸ¥è¯¢æ¡ä»¶ä¼˜åŒ–  
   âŒ é”™è¯¯ï¼šWHERE age > 25 (è·¨åˆ†ç‰‡æŸ¥è¯¢)
   âœ… æ­£ç¡®ï¼šWHERE user_id = 123 AND age > 25 (å•åˆ†ç‰‡æŸ¥è¯¢)

3. ä¸šåŠ¡é€»è¾‘è°ƒæ•´
   âŒ é”™è¯¯ï¼šä¸€æ¬¡æŸ¥è¯¢è·å–æ‰€æœ‰æ•°æ®
   âœ… æ­£ç¡®ï¼šå…ˆæŸ¥ç”¨æˆ·ç»´åº¦ï¼Œå†æŸ¥ç›¸å…³æ•°æ®
```

**ğŸ”§ å®é™…æ¡ˆä¾‹**

```sql
-- é—®é¢˜SQLï¼ˆè·¨åˆ†ç‰‡æŸ¥è¯¢ï¼‰
SELECT u.name, o.amount 
FROM user u 
JOIN order o ON u.user_id = o.user_id 
WHERE o.create_time > '2024-01-01'
AND u.city = 'åŒ—äº¬';

-- ä¼˜åŒ–æ–¹æ¡ˆï¼ˆåˆ†æ­¥æŸ¥è¯¢ï¼‰
-- æ­¥éª¤1ï¼šåœ¨è®¢å•åº“æŸ¥æ‰¾è®¢å•
SELECT DISTINCT user_id 
FROM order 
WHERE create_time > '2024-01-01';

-- æ­¥éª¤2ï¼šæ ¹æ®user_idæŸ¥ç”¨æˆ·ä¿¡æ¯
SELECT user_id, name 
FROM user 
WHERE user_id IN (123, 456, 789) 
AND city = 'åŒ—äº¬';

-- æ­¥éª¤3ï¼šåº”ç”¨å±‚åˆå¹¶æ•°æ®
```

---

## 5. ğŸ›¡ï¸ ä¸­é—´ä»¶å±‚é¢ç›‘æ§


### 5.1 ä¸­é—´ä»¶çš„ä½œç”¨


**é€šä¿—ç†è§£**ï¼šä¸­é—´ä»¶å°±åƒæ™ºèƒ½å®¢æœç³»ç»Ÿ

```
æ²¡æœ‰ä¸­é—´ä»¶ï¼š
åº”ç”¨ç¨‹åº â”€â”€ç›´æ¥è¿æ¥â”€â”€â†’ æ•°æ®åº“
é—®é¢˜ï¼šåº”ç”¨éœ€è¦è‡ªå·±å¤„ç†åˆ†åº“åˆ†è¡¨é€»è¾‘

æœ‰ä¸­é—´ä»¶ï¼š
åº”ç”¨ç¨‹åº â”€â”€â†’ ä¸­é—´ä»¶ â”€â”€â†’ æ•°æ®åº“1
              â”‚    â”€â”€â†’ æ•°æ®åº“2  
              â””â”€â”€â”€â”€â†’ æ•°æ®åº“3
å¥½å¤„ï¼šä¸­é—´ä»¶å¸®å¿™å¤„ç†å¤æ‚çš„è·¯ç”±å’ŒæŸ¥è¯¢ä¼˜åŒ–
```

**ğŸ”§ å¸¸è§ä¸­é—´ä»¶**
- **MyCat**ï¼šå¼€æºåˆ†åº“åˆ†è¡¨ä¸­é—´ä»¶
- **ShardingSphere**ï¼šApacheçš„åˆ†å¸ƒå¼æ•°æ®åº“ä¸­é—´ä»¶
- **TDDL**ï¼šé˜¿é‡Œå·´å·´çš„æ•°æ®åº“ä¸­é—´ä»¶
- **Cobar**ï¼šåŸºäºMySQLçš„åˆ†å¸ƒå¼æ•°æ®åº“æœåŠ¡ä¸­é—´ä»¶

### 5.2 ä¸­é—´ä»¶ç›‘æ§è¦ç‚¹


**ğŸ“Š ä¸­é—´ä»¶æ€§èƒ½æŒ‡æ ‡**

```
æ ¸å¿ƒç›‘æ§æŒ‡æ ‡ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¿æ¥æ± çŠ¶æ€                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ´»è·ƒè¿æ¥æ•°ï¼š45/100                  â”‚
â”‚ ç­‰å¾…è¿æ¥æ•°ï¼š12                      â”‚  
â”‚ è¿æ¥è¶…æ—¶æ•°ï¼š3                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SQLè§£æä¸è·¯ç”±                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SQLè§£ææ—¶é—´ï¼šå¹³å‡2ms                â”‚
â”‚ è·¯ç”±è®¡ç®—æ—¶é—´ï¼šå¹³å‡1ms               â”‚
â”‚ è·¨åˆ†ç‰‡æŸ¥è¯¢æ¯”ä¾‹ï¼š15%                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åç«¯æ•°æ®åº“è¿æ¥                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DB1è¿æ¥æ•°ï¼š25ä¸ª                     â”‚
â”‚ DB2è¿æ¥æ•°ï¼š23ä¸ª                     â”‚
â”‚ DB3è¿æ¥æ•°ï¼š27ä¸ª                     â”‚
â”‚ è¿æ¥å¼‚å¸¸æ•°ï¼š0ä¸ª                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 ä¸­é—´ä»¶æ…¢æŸ¥è¯¢åˆ†æ


**ğŸ” ä¸­é—´ä»¶å±‚çš„æ…¢æŸ¥è¯¢ç‰¹å¾**

```
1. SQLè§£ææ…¢
åŸå› ï¼šå¤æ‚SQLçš„è¯­æ³•è§£ææ¶ˆè€—æ—¶é—´
è¡¨ç°ï¼šè§£ææ—¶é—´ > 10ms

ç¤ºä¾‹æ—¥å¿—ï¼š
[WARN] SQL parse took 15ms: 
SELECT * FROM (SELECT ... FROM user WHERE ...) t1 
JOIN (SELECT ... FROM order WHERE ...) t2 ON ...

2. è·¯ç”±è®¡ç®—æ…¢  
åŸå› ï¼šå¤æ‚çš„åˆ†ç‰‡è·¯ç”±é€»è¾‘
è¡¨ç°ï¼šè·¯ç”±æ—¶é—´ > 5ms

ç¤ºä¾‹æ—¥å¿—ï¼š
[WARN] Route calculate took 8ms for cross-shard query:
SELECT COUNT(*) FROM user WHERE create_time > '2024-01-01'

3. ç»“æœåˆå¹¶æ…¢
åŸå› ï¼šå¤§é‡æ•°æ®çš„æ’åºã€åˆ†é¡µå¤„ç†
è¡¨ç°ï¼šåˆå¹¶æ—¶é—´ > 50ms

ç¤ºä¾‹æ—¥å¿—ï¼š
[WARN] Result merge took 120ms: 
ORDER BY create_time LIMIT 10000, 100
```

**ğŸ› ï¸ ä¸­é—´ä»¶ç›‘æ§é…ç½®**

```xml
<!-- MyCATç›‘æ§é…ç½®ç¤ºä¾‹ -->
<system>
    <!-- å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿— -->
    <property name="enableSlowLog">1</property>
    <property name="slowLogTime">100</property> <!-- 100ms -->
    
    <!-- å¼€å¯SQLç»Ÿè®¡ -->
    <property name="enableSqlStat">1</property>
    <property name="sqlStatHistorySize">1000</property>
    
    <!-- è¿æ¥æ± ç›‘æ§ -->
    <property name="enableConnectionMonitor">1</property>
</system>
```

### 5.4 ä¸­é—´ä»¶ä¼˜åŒ–å»ºè®®


**ğŸš€ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥**

```
1. è¿æ¥æ± ä¼˜åŒ–
é…ç½®å»ºè®®ï¼š
- åˆå§‹è¿æ¥æ•°ï¼šæ ¸å¿ƒçº¿ç¨‹æ•°çš„1-2å€  
- æœ€å¤§è¿æ¥æ•°ï¼šæ ¹æ®æ•°æ®åº“è¿æ¥é™åˆ¶è®¾ç½®
- è¿æ¥è¶…æ—¶ï¼š3-5ç§’
- ç©ºé—²æ£€æµ‹ï¼š30ç§’

2. SQLè·¯ç”±ä¼˜åŒ–
- é¿å…å¤æ‚çš„è·¨åˆ†ç‰‡JOIN
- ä¼˜åŒ–åˆ†ç‰‡é”®çš„é€‰æ‹©
- åˆç†è®¾è®¡åˆ†ç‰‡è§„åˆ™

3. ç»“æœå¤„ç†ä¼˜åŒ–  
- é™åˆ¶å¤§ç»“æœé›†çš„è¿”å›
- ä¼˜åŒ–ORDER BYå’ŒLIMITçš„ä½¿ç”¨
- è€ƒè™‘åœ¨åº”ç”¨å±‚åšåˆ†é¡µ
```

---

## 6. ğŸ”— å…¨é“¾è·¯æŸ¥è¯¢è·Ÿè¸ª


### 6.1 ä»€ä¹ˆæ˜¯å…¨é“¾è·¯è·Ÿè¸ª


**é€šä¿—ç†è§£**ï¼šå°±åƒå¿«é€’çš„å…¨ç¨‹è·Ÿè¸ª

```
å¿«é€’è·Ÿè¸ªï¼š
ä¸‹å• â†’ æ½ä»¶ â†’ è¿è¾“ â†’ åˆ†æ‹£ â†’ æ´¾é€ â†’ ç­¾æ”¶
æ¯ä¸ªç¯èŠ‚éƒ½æœ‰æ—¶é—´è®°å½•ï¼Œå‡ºé—®é¢˜èƒ½å¿«é€Ÿå®šä½

æŸ¥è¯¢é“¾è·¯è·Ÿè¸ªï¼š
è¯·æ±‚ â†’ åº”ç”¨ â†’ ä¸­é—´ä»¶ â†’ æ•°æ®åº“ â†’ è¿”å›ç»“æœ
æ¯ä¸ªç¯èŠ‚éƒ½æœ‰æ€§èƒ½æ•°æ®ï¼Œæ…¢æŸ¥è¯¢èƒ½å¿«é€Ÿå®šä½
```

**ğŸ” è·Ÿè¸ªçš„å¿…è¦æ€§**

```
ç”¨æˆ·åé¦ˆï¼šé¡µé¢æ‰“å¼€å¾ˆæ…¢ï¼ˆæ€»å…±3ç§’ï¼‰
é—®é¢˜å®šä½ï¼š
- ç½‘ç»œå»¶è¿Ÿï¼š50ms
- åº”ç”¨å¤„ç†ï¼š200ms  
- ä¸­é—´ä»¶è·¯ç”±ï¼š30ms
- æ•°æ®åº“æŸ¥è¯¢ï¼š2.7ç§’ â† é—®é¢˜åœ¨è¿™é‡Œï¼
- ç»“æœè¿”å›ï¼š20ms

æ²¡æœ‰é“¾è·¯è·Ÿè¸ªï¼šåªçŸ¥é“æ…¢ï¼Œä¸çŸ¥é“å“ªé‡Œæ…¢
æœ‰äº†é“¾è·¯è·Ÿè¸ªï¼šå¿«é€Ÿå®šä½åˆ°æ•°æ®åº“æŸ¥è¯¢é—®é¢˜
```

### 6.2 é“¾è·¯è·Ÿè¸ªå®ç°


**ğŸ› ï¸ è·Ÿè¸ªç³»ç»Ÿæ¶æ„**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯é¡µé¢   â”‚â”€â”€â”€â†’â”‚   åº”ç”¨æœåŠ¡   â”‚â”€â”€â”€â†’â”‚  æ•°æ®åº“æœåŠ¡  â”‚
â”‚             â”‚    â”‚             â”‚    â”‚             â”‚
â”‚ TraceID:    â”‚    â”‚ TraceID:    â”‚    â”‚ TraceID:    â”‚  
â”‚ abc123      â”‚    â”‚ abc123      â”‚    â”‚ abc123      â”‚
â”‚ SpanID: 001 â”‚    â”‚ SpanID: 002 â”‚    â”‚ SpanID: 003 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                   â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
                    â”‚ é“¾è·¯æ”¶é›†   â”‚
                    â”‚ (Jaeger)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”§ å®é™…å®ç°ä»£ç **

```java
// Spring Boot + Sleuth å®ç°é“¾è·¯è·Ÿè¸ª
@RestController
public class UserController {
    
    @Autowired
    private UserService userService;
    
    @GetMapping("/user/{id}")
    @Traced("getUserInfo") // è‡ªå®šä¹‰è·Ÿè¸ªæ³¨è§£
    public User getUserInfo(@PathVariable Long id) {
        // è‡ªåŠ¨ç”ŸæˆTraceIDå’ŒSpanID
        long startTime = System.currentTimeMillis();
        
        try {
            User user = userService.findById(id);
            return user;
        } finally {
            // è®°å½•æ‰§è¡Œæ—¶é—´
            long endTime = System.currentTimeMillis();
            log.info("getUserInfo took: {}ms", endTime - startTime);
        }
    }
}

@Service  
public class UserService {
    
    @Autowired
    private UserRepository userRepository;
    
    @NewSpan("findUserById") // åˆ›å»ºæ–°çš„Span
    public User findById(Long id) {
        // è¿™é‡Œä¼šè‡ªåŠ¨è®°å½•æ•°æ®åº“æŸ¥è¯¢çš„æ‰§è¡Œæ—¶é—´
        return userRepository.findById(id);
    }
}
```

### 6.3 æ…¢æŸ¥è¯¢é“¾è·¯åˆ†æ


**ğŸ“Š é“¾è·¯æ€§èƒ½åˆ†æ**

```
é“¾è·¯è·Ÿè¸ªæŠ¥å‘Šï¼š
TraceID: abc123-def456-789
æ€»è€—æ—¶: 2.8ç§’

Spanè¯¦æƒ…ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. HTTPè¯·æ±‚æ¥æ”¶     è€—æ—¶: 5ms           â”‚
â”‚ 2. ä¸šåŠ¡é€»è¾‘å¤„ç†     è€—æ—¶: 50ms          â”‚  
â”‚ 3. æ•°æ®åº“æŸ¥è¯¢       è€—æ—¶: 2.7ç§’ âš ï¸      â”‚
â”‚    â”œâ”€ SQLè§£æ      è€—æ—¶: 2ms           â”‚
â”‚    â”œâ”€ æ‰§è¡Œè®¡åˆ’     è€—æ—¶: 3ms           â”‚
â”‚    â”œâ”€ æ•°æ®è¯»å–     è€—æ—¶: 2.69ç§’ âŒ     â”‚
â”‚    â””â”€ ç»“æœè¿”å›     è€—æ—¶: 5ms           â”‚
â”‚ 4. ç»“æœåºåˆ—åŒ–       è€—æ—¶: 15ms          â”‚
â”‚ 5. HTTPå“åº”å‘é€     è€—æ—¶: 3ms           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é—®é¢˜å®šä½ï¼šæ•°æ®è¯»å–é˜¶æ®µè€—æ—¶è¿‡é•¿ï¼Œå¯èƒ½æ˜¯ï¼š
- ç¼ºå°‘ç´¢å¼•å¯¼è‡´å…¨è¡¨æ‰«æ
- é”ç­‰å¾…æ—¶é—´è¿‡é•¿
- ç£ç›˜IOæ€§èƒ½é—®é¢˜
```

### 6.4 é“¾è·¯ä¼˜åŒ–å®è·µ


**ğŸ¯ ä¼˜åŒ–ç­–ç•¥**

```
1. å¹¶è¡ŒåŒ–æ”¹é€ 
åŸå§‹æµç¨‹ï¼ˆä¸²è¡Œï¼‰ï¼š
æŸ¥ç”¨æˆ·ä¿¡æ¯(100ms) â†’ æŸ¥è®¢å•ä¿¡æ¯(200ms) â†’ æŸ¥å•†å“ä¿¡æ¯(150ms)
æ€»è€—æ—¶ï¼š450ms

ä¼˜åŒ–æµç¨‹ï¼ˆå¹¶è¡Œï¼‰ï¼š
â”Œâ”€ æŸ¥ç”¨æˆ·ä¿¡æ¯(100ms) â”€â”
â”œâ”€ æŸ¥è®¢å•ä¿¡æ¯(200ms) â”€â”¼â”€â†’ åˆå¹¶ç»“æœ(10ms)
â””â”€ æŸ¥å•†å“ä¿¡æ¯(150ms) â”€â”˜
æ€»è€—æ—¶ï¼š210ms

2. ç¼“å­˜ç­–ç•¥
çƒ­ç‚¹æ•°æ®ç¼“å­˜ï¼š
ç¬¬ä¸€æ¬¡æŸ¥è¯¢ï¼šæ•°æ®åº“(100ms) â†’ å†™å…¥ç¼“å­˜(5ms)
åç»­æŸ¥è¯¢ï¼šç¼“å­˜è¯»å–(2ms)

3. å¼‚æ­¥å¤„ç†
åŒæ­¥æ“ä½œï¼šç”¨æˆ·ç­‰å¾…æ‰€æœ‰å¤„ç†å®Œæˆ(300ms)
å¼‚æ­¥æ“ä½œï¼šæ ¸å¿ƒæ•°æ®ç«‹å³è¿”å›(50ms) + åå°å¼‚æ­¥å¤„ç†
```

---

## 7. ğŸ’¼ åˆ†å¸ƒå¼äº‹åŠ¡åˆ†æ


### 7.1 åˆ†å¸ƒå¼äº‹åŠ¡åŸºæœ¬æ¦‚å¿µ


**é€šä¿—ç†è§£**ï¼šå°±åƒå¤šäººåˆä½œå®Œæˆä¸€ä»¶äº‹

```
å•æœºäº‹åŠ¡ï¼ˆä¸€ä¸ªäººåšäº‹ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é“¶è¡Œè½¬è´¦äº‹åŠ¡ï¼š                  â”‚
â”‚ 1. æ£€æŸ¥ä½™é¢     âœ“              â”‚
â”‚ 2. æ‰£é™¤é‡‘é¢     âœ“              â”‚  
â”‚ 3. å¢åŠ ç›®æ ‡é‡‘é¢  âœ“              â”‚
â”‚ 4. è®°å½•æµæ°´     âœ“              â”‚
â”‚ ç»“æœï¼šå…¨éƒ¨æˆåŠŸ æˆ– å…¨éƒ¨å›æ»š      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åˆ†å¸ƒå¼äº‹åŠ¡ï¼ˆå¤šäººåä½œï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·æ•°æ®åº“ â”‚  â”‚  è®¢å•æ•°æ®åº“  â”‚  â”‚  åº“å­˜æ•°æ®åº“  â”‚
â”‚             â”‚  â”‚             â”‚  â”‚             â”‚
â”‚ 1.æ‰£å‡ä½™é¢   â”‚  â”‚ 2.åˆ›å»ºè®¢å•   â”‚  â”‚ 3.å‡å°‘åº“å­˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
é—®é¢˜ï¼šå¦‚æœä»»ä½•ä¸€æ­¥å¤±è´¥ï¼Œå¦‚ä½•ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Ÿ
```

### 7.2 åˆ†å¸ƒå¼äº‹åŠ¡çš„æ…¢æŸ¥è¯¢ç‰¹ç‚¹


**ğŸ”¸ ä¸¤é˜¶æ®µæäº¤çš„æ€§èƒ½å¼€é”€**

```
2PCï¼ˆTwo-Phase Commitï¼‰è¿‡ç¨‹ï¼š

é˜¶æ®µ1 - å‡†å¤‡é˜¶æ®µï¼š
åè°ƒè€… â†’ æ‰€æœ‰å‚ä¸è€…ï¼šprepareè¯·æ±‚
å‚ä¸è€… â†’ åè°ƒè€…ï¼švote-commit/vote-abort

é˜¶æ®µ2 - æäº¤é˜¶æ®µï¼š  
åè°ƒè€… â†’ æ‰€æœ‰å‚ä¸è€…ï¼šcommit/abortè¯·æ±‚
å‚ä¸è€… â†’ åè°ƒè€…ï¼šç¡®è®¤æ¶ˆæ¯

æ€§èƒ½é—®é¢˜ï¼š
- ç½‘ç»œé€šä¿¡ï¼šè‡³å°‘4æ¬¡ç½‘ç»œäº¤äº’
- é”æŒæœ‰æ—¶é—´ï¼šä»prepareåˆ°commitæœŸé—´ä¸€ç›´æŒæœ‰é”
- é˜»å¡ç­‰å¾…ï¼šä»»ä½•ä¸€ä¸ªå‚ä¸è€…å“åº”æ…¢éƒ½ä¼šå½±å“æ•´ä¸ªäº‹åŠ¡
```

**ğŸ”¸ å®é™…æ€§èƒ½åˆ†æ**

```
ä¼ ç»Ÿå•æœºäº‹åŠ¡ï¼š
BEGIN;
UPDATE account SET balance = balance - 100 WHERE id = 1;
UPDATE account SET balance = balance + 100 WHERE id = 2;  
COMMIT;
è€—æ—¶ï¼šçº¦5-10ms

åˆ†å¸ƒå¼äº‹åŠ¡ï¼š
// é˜¶æ®µ1ï¼šå‡†å¤‡
XA START 'tx123';
UPDATE account SET balance = balance - 100 WHERE id = 1;
XA END 'tx123';
XA PREPARE 'tx123';

// ç­‰å¾…å…¶ä»–å‚ä¸è€…...

// é˜¶æ®µ2ï¼šæäº¤  
XA COMMIT 'tx123';
è€—æ—¶ï¼šçº¦50-100msï¼ˆå¢åŠ 10å€ï¼‰
```

### 7.3 åˆ†å¸ƒå¼äº‹åŠ¡ç›‘æ§


**ğŸ“Š å…³é”®ç›‘æ§æŒ‡æ ‡**

```sql
-- ç›‘æ§XAäº‹åŠ¡çŠ¶æ€
SELECT 
    xa_state,
    COUNT(*) as transaction_count,
    AVG(TIMESTAMPDIFF(SECOND, start_time, end_time)) as avg_duration
FROM xa_transaction_log
WHERE start_time >= NOW() - INTERVAL 1 HOUR
GROUP BY xa_state;

-- é•¿æ—¶é—´æœªæäº¤çš„XAäº‹åŠ¡
SELECT 
    xid,
    state,
    start_time,
    TIMESTAMPDIFF(SECOND, start_time, NOW()) as duration_seconds
FROM information_schema.INNODB_TRX t
JOIN performance_schema.events_transactions_current e ON t.trx_id = e.thread_id
WHERE e.transaction_state = 'PREPARED'
AND start_time < NOW() - INTERVAL 30 MINUTE;
```

**ğŸš¨ ç›‘æ§å‘Šè­¦è§„åˆ™**

```
å‘Šè­¦çº§åˆ«ï¼š
ğŸ”´ ä¸¥é‡ï¼šXAäº‹åŠ¡è¶…æ—¶>5åˆ†é’Ÿ
ğŸŸ¡ è­¦å‘Šï¼šXAäº‹åŠ¡è¶…æ—¶>1åˆ†é’Ÿ  
ğŸŸ¢ æ­£å¸¸ï¼šXAäº‹åŠ¡<30ç§’

ç›‘æ§æŒ‡æ ‡ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ XAäº‹åŠ¡ç›‘æ§é¢æ¿                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ´»è·ƒXAäº‹åŠ¡æ•°ï¼š23ä¸ª                  â”‚
â”‚ å¹³å‡äº‹åŠ¡æ—¶é•¿ï¼š1.2ç§’                 â”‚
â”‚ è¶…æ—¶äº‹åŠ¡æ•°ï¼š2ä¸ª âš ï¸                  â”‚
â”‚ å›æ»šäº‹åŠ¡æ•°ï¼š5ä¸ª                     â”‚
â”‚ æœ€é•¿ç­‰å¾…äº‹åŠ¡ï¼š2åˆ†34ç§’ ğŸ”´            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.4 åˆ†å¸ƒå¼äº‹åŠ¡ä¼˜åŒ–


**ğŸ¯ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥**

```
1. å‡å°‘å‚ä¸è€…æ•°é‡
âŒ é”™è¯¯è®¾è®¡ï¼šä¸€ä¸ªäº‹åŠ¡æ¶‰åŠ5ä¸ªæ•°æ®åº“
âœ… ä¼˜åŒ–è®¾è®¡ï¼šåˆå¹¶ç›¸å…³æ“ä½œï¼Œå‡å°‘åˆ°2-3ä¸ªæ•°æ®åº“

2. ç¼©çŸ­äº‹åŠ¡æ—¶é—´
âŒ é”™è¯¯åšæ³•ï¼šäº‹åŠ¡ä¸­åŒ…å«å¤æ‚ä¸šåŠ¡é€»è¾‘
âœ… æ­£ç¡®åšæ³•ï¼šäº‹åŠ¡åªåšæ•°æ®ä¿®æ”¹ï¼Œä¸šåŠ¡é€»è¾‘æå‰å¤„ç†

3. å¼‚æ­¥äº‹åŠ¡æ¨¡å¼
åŒæ­¥æ¨¡å¼ï¼šç”¨æˆ·ç­‰å¾…äº‹åŠ¡å®Œæˆ(500ms)
å¼‚æ­¥æ¨¡å¼ï¼šç«‹å³è¿”å›æˆåŠŸï¼Œåå°å¤„ç†äº‹åŠ¡(50ms)

4. æœ€ç»ˆä¸€è‡´æ€§  
å¼ºä¸€è‡´æ€§ï¼šXAäº‹åŠ¡ä¿è¯ï¼Œæ€§èƒ½å·®
æœ€ç»ˆä¸€è‡´æ€§ï¼šæ¶ˆæ¯é˜Ÿåˆ—+è¡¥å¿æœºåˆ¶ï¼Œæ€§èƒ½å¥½
```

**ğŸ”§ å…·ä½“ä¼˜åŒ–æ¡ˆä¾‹**

```java
// ä¼˜åŒ–å‰ï¼šé•¿äº‹åŠ¡
@Transactional
public void processOrder(Order order) {
    // 1. éªŒè¯ç”¨æˆ·ä¿¡æ¯ï¼ˆå¯èƒ½å¾ˆæ…¢ï¼‰
    validateUser(order.getUserId());
    
    // 2. æ£€æŸ¥åº“å­˜ï¼ˆè·¨åº“æŸ¥è¯¢ï¼‰
    checkInventory(order.getItems());
    
    // 3. è®¡ç®—ä»·æ ¼ï¼ˆå¤æ‚é€»è¾‘ï¼‰
    calculatePrice(order);
    
    // 4. åˆ›å»ºè®¢å•ï¼ˆçœŸæ­£çš„æ•°æ®ä¿®æ”¹ï¼‰
    createOrder(order);
    
    // 5. æ‰£å‡åº“å­˜ï¼ˆè·¨åº“ä¿®æ”¹ï¼‰
    deductInventory(order.getItems());
}

// ä¼˜åŒ–åï¼šçŸ­äº‹åŠ¡
public void processOrder(Order order) {
    // 1-3æ­¥ï¼šäº‹åŠ¡å¤–é¢„å¤„ç†
    validateUser(order.getUserId());
    checkInventory(order.getItems());
    calculatePrice(order);
    
    // 4-5æ­¥ï¼šçŸ­äº‹åŠ¡å¤„ç†
    try {
        doTransactionalWork(order);
    } catch (Exception e) {
        // è¡¥å¿æœºåˆ¶
        compensate(order);
        throw e;
    }
}

@Transactional
private void doTransactionalWork(Order order) {
    createOrder(order);           // 50ms
    deductInventory(order.getItems()); // 30ms
    // æ€»äº‹åŠ¡æ—¶é—´ï¼š80msï¼ˆåŸæ¥å¯èƒ½500msï¼‰
}
```

---

## 8. ğŸŒ‰ è·¨åº“æŸ¥è¯¢ä¼˜åŒ–


### 8.1 è·¨åº“æŸ¥è¯¢çš„æŒ‘æˆ˜


**é€šä¿—ç†è§£**ï¼šå°±åƒåœ¨ä¸åŒåŸå¸‚çš„å›¾ä¹¦é¦†æŸ¥èµ„æ–™

```
å•åº“æŸ¥è¯¢ï¼ˆæœ¬åœ°å›¾ä¹¦é¦†ï¼‰ï¼š
éœ€è¦èµ„æ–™ â†’ ç›´æ¥æŸ¥æ‰¾ â†’ æ‰¾åˆ°èµ„æ–™
ç®€å•å¿«é€Ÿï¼Œæ‰€æœ‰èµ„æ–™åœ¨ä¸€èµ·

è·¨åº“æŸ¥è¯¢ï¼ˆå¤šä¸ªå›¾ä¹¦é¦†ï¼‰ï¼š
éœ€è¦èµ„æ–™ â†’ Aå›¾ä¹¦é¦†æŸ¥æ‰¾ â†’ æ²¡æ‰¾åˆ°
        â†’ Bå›¾ä¹¦é¦†æŸ¥æ‰¾ â†’ æ‰¾åˆ°éƒ¨åˆ†  
        â†’ Cå›¾ä¹¦é¦†æŸ¥æ‰¾ â†’ æ‰¾åˆ°éƒ¨åˆ†
        â†’ æ±‡æ€»æ•´ç†èµ„æ–™
å¤æ‚è€—æ—¶ï¼Œéœ€è¦å¤šæ¬¡æŸ¥æ‰¾å’Œæ±‡æ€»
```

### 8.2 è·¨åº“æŸ¥è¯¢ç±»å‹åˆ†æ


**ğŸ”¸ JOINæŸ¥è¯¢é—®é¢˜**

```sql
-- é—®é¢˜SQLï¼šè·¨åº“JOIN
SELECT u.name, o.amount, p.title
FROM user_db.user u
JOIN order_db.order o ON u.id = o.user_id  
JOIN product_db.product p ON o.product_id = p.id
WHERE u.city = 'åŒ—äº¬' AND o.create_time > '2024-01-01';

æ‰§è¡Œé—®é¢˜ï¼š
1. æ— æ³•ç›´æ¥JOINï¼šä¸‰ä¸ªè¡¨åœ¨ä¸åŒæ•°æ®åº“
2. æ•°æ®ä¼ è¾“ï¼šéœ€è¦åœ¨åº”ç”¨å±‚æˆ–ä¸­é—´ä»¶å±‚åˆå¹¶
3. æ€§èƒ½ä½ä¸‹ï¼šå¯èƒ½éœ€è¦ä¼ è¾“å¤§é‡ä¸­é—´ç»“æœ
```

**ğŸ”¸ èšåˆæŸ¥è¯¢é—®é¢˜**

```sql
-- é—®é¢˜SQLï¼šè·¨åº“èšåˆ  
SELECT COUNT(*), SUM(amount)
FROM (
    SELECT amount FROM order_db1.order WHERE create_time > '2024-01-01'
    UNION ALL
    SELECT amount FROM order_db2.order WHERE create_time > '2024-01-01' 
    UNION ALL
    SELECT amount FROM order_db3.order WHERE create_time > '2024-01-01'
) combined;

æ‰§è¡Œè¿‡ç¨‹ï¼š
1. åˆ†åˆ«æŸ¥è¯¢ä¸‰ä¸ªåº“ï¼šå¯èƒ½è¿”å›å¤§é‡æ•°æ®
2. åº”ç”¨å±‚åˆå¹¶ï¼šå†…å­˜æ¶ˆè€—å¤§  
3. é‡æ–°èšåˆï¼šCPUæ¶ˆè€—é«˜
```

### 8.3 è·¨åº“æŸ¥è¯¢ä¼˜åŒ–æ–¹æ¡ˆ


**ğŸš€ ä¼˜åŒ–ç­–ç•¥ä¸€ï¼šæŸ¥è¯¢æ‹†åˆ†**

```java
// åŸå§‹è·¨åº“æŸ¥è¯¢ï¼ˆæ€§èƒ½å·®ï¼‰
public List<UserOrderInfo> getUserOrders(String city) {
    // è¿™æ ·çš„SQLæ— æ³•ç›´æ¥æ‰§è¡Œ
    String sql = """
        SELECT u.name, o.amount 
        FROM user_db.user u 
        JOIN order_db.order o ON u.id = o.user_id 
        WHERE u.city = ?
    """;
}

// ä¼˜åŒ–ï¼šæ‹†åˆ†æŸ¥è¯¢ï¼ˆæ€§èƒ½å¥½ï¼‰
public List<UserOrderInfo> getUserOrdersOptimized(String city) {
    // æ­¥éª¤1ï¼šæŸ¥è¯¢ç”¨æˆ·æ•°æ®åº“
    List<User> users = userDB.query(
        "SELECT id, name FROM user WHERE city = ?", city);
    
    if (users.isEmpty()) {
        return Collections.emptyList();
    }
    
    // æ­¥éª¤2ï¼šæå–ç”¨æˆ·IDåˆ—è¡¨
    List<Long> userIds = users.stream()
        .map(User::getId)
        .collect(Collectors.toList());
    
    // æ­¥éª¤3ï¼šæ‰¹é‡æŸ¥è¯¢è®¢å•æ•°æ®åº“  
    List<Order> orders = orderDB.query(
        "SELECT user_id, amount FROM order WHERE user_id IN (?)", userIds);
    
    // æ­¥éª¤4ï¼šåº”ç”¨å±‚å…³è”æ•°æ®
    return mergeUserAndOrder(users, orders);
}
```

**ğŸš€ ä¼˜åŒ–ç­–ç•¥äºŒï¼šæ•°æ®å†—ä½™**

```sql
-- ç­–ç•¥ï¼šåœ¨è®¢å•è¡¨å†—ä½™ç”¨æˆ·ä¿¡æ¯
-- åŸå§‹è®¾è®¡ï¼ˆéœ€è¦è·¨åº“æŸ¥è¯¢ï¼‰
CREATE TABLE order (
    id BIGINT PRIMARY KEY,
    user_id BIGINT,
    amount DECIMAL(10,2),
    create_time DATETIME
);

-- ä¼˜åŒ–è®¾è®¡ï¼ˆé¿å…è·¨åº“æŸ¥è¯¢ï¼‰
CREATE TABLE order (
    id BIGINT PRIMARY KEY,
    user_id BIGINT,
    user_name VARCHAR(50),    -- å†—ä½™ç”¨æˆ·å§“å
    user_city VARCHAR(50),    -- å†—ä½™ç”¨æˆ·åŸå¸‚
    amount DECIMAL(10,2),
    create_time DATETIME
);

-- æŸ¥è¯¢å˜æˆå•åº“æ“ä½œ
SELECT user_name, amount 
FROM order 
WHERE user_city = 'åŒ—äº¬' 
AND create_time > '2024-01-01';
```

**ğŸš€ ä¼˜åŒ–ç­–ç•¥ä¸‰ï¼šç¼“å­˜é¢„çƒ­**

```java
// çƒ­ç‚¹æ•°æ®ç¼“å­˜
@Service
public class UserOrderService {
    
    @Autowired
    private RedisTemplate<String, Object> redis;
    
    public UserOrderInfo getUserOrderInfo(Long userId) {
        // å…ˆæŸ¥ç¼“å­˜
        String cacheKey = "user_order:" + userId;
        UserOrderInfo cached = (UserOrderInfo) redis.opsForValue().get(cacheKey);
        if (cached != null) {
            return cached;
        }
        
        // ç¼“å­˜æœªå‘½ä¸­ï¼ŒæŸ¥è¯¢æ•°æ®åº“
        UserOrderInfo info = queryFromDatabase(userId);
        
        // å†™å…¥ç¼“å­˜ï¼ˆ5åˆ†é’Ÿè¿‡æœŸï¼‰
        redis.opsForValue().set(cacheKey, info, Duration.ofMinutes(5));
        
        return info;
    }
    
    private UserOrderInfo queryFromDatabase(Long userId) {
        // è·¨åº“æŸ¥è¯¢é€»è¾‘
        User user = userDB.findById(userId);
        List<Order> orders = orderDB.findByUserId(userId);
        return new UserOrderInfo(user, orders);
    }
}
```

### 8.4 è·¨åº“æŸ¥è¯¢ç›‘æ§


**ğŸ“Š ç›‘æ§æŒ‡æ ‡è®¾è®¡**

```sql
-- è·¨åº“æŸ¥è¯¢æ€§èƒ½ç›‘æ§
CREATE TABLE cross_db_query_log (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    trace_id VARCHAR(64),
    query_pattern TEXT,
    involved_databases VARCHAR(200),
    total_time_ms INT,
    db_query_time_ms INT,
    merge_time_ms INT,
    result_rows INT,
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- æ…¢è·¨åº“æŸ¥è¯¢åˆ†æ
SELECT 
    query_pattern,
    COUNT(*) as query_count,
    AVG(total_time_ms) as avg_total_time,
    AVG(db_query_time_ms) as avg_db_time,
    AVG(merge_time_ms) as avg_merge_time,
    MAX(total_time_ms) as max_time
FROM cross_db_query_log
WHERE create_time >= NOW() - INTERVAL 1 HOUR
AND total_time_ms > 1000  -- è¶…è¿‡1ç§’çš„æŸ¥è¯¢
GROUP BY query_pattern
ORDER BY avg_total_time DESC;
```

---

## 9. â±ï¸ æ•°æ®åŒæ­¥å»¶è¿Ÿå½±å“


### 9.1 æ•°æ®åŒæ­¥å»¶è¿Ÿçš„äº§ç”Ÿ


**é€šä¿—ç†è§£**ï¼šå°±åƒæ–°é—»ä¼ æ’­çš„å»¶è¿Ÿ

```
ä¸»åº“ï¼ˆæ–°é—»æºï¼‰ï¼š
æ—¶é—´ 09:00:00 â†’ å‘å¸ƒæ–°é—»A
æ—¶é—´ 09:00:05 â†’ å‘å¸ƒæ–°é—»B
æ—¶é—´ 09:00:10 â†’ å‘å¸ƒæ–°é—»C

ä»åº“1ï¼ˆæŠ¥çº¸ï¼‰ï¼š
æ—¶é—´ 09:00:02 â†’ æ”¶åˆ°æ–°é—»Aï¼ˆå»¶è¿Ÿ2ç§’ï¼‰
æ—¶é—´ 09:00:08 â†’ æ”¶åˆ°æ–°é—»Bï¼ˆå»¶è¿Ÿ3ç§’ï¼‰
æ—¶é—´ 09:00:15 â†’ æ”¶åˆ°æ–°é—»Cï¼ˆå»¶è¿Ÿ5ç§’ï¼‰

ä»åº“2ï¼ˆç”µè§†ï¼‰ï¼š
æ—¶é—´ 09:00:01 â†’ æ”¶åˆ°æ–°é—»Aï¼ˆå»¶è¿Ÿ1ç§’ï¼‰
æ—¶é—´ 09:00:07 â†’ æ”¶åˆ°æ–°é—»Bï¼ˆå»¶è¿Ÿ2ç§’ï¼‰
æ—¶é—´ 09:00:13 â†’ æ”¶åˆ°æ–°é—»Cï¼ˆå»¶è¿Ÿ3ç§’ï¼‰

é—®é¢˜ï¼šä¸åŒçš„"è¯»è€…"åœ¨åŒä¸€æ—¶é—´çœ‹åˆ°çš„æ–°é—»å¯èƒ½ä¸ä¸€æ ·
```

### 9.2 å»¶è¿Ÿäº§ç”Ÿçš„åŸå› 


**ğŸ”¸ æŠ€æœ¯å±‚é¢åŸå› **

```
1. ç½‘ç»œå»¶è¿Ÿ
ä¸»åº“ â”€â”€â”€â”€ç½‘ç»œä¼ è¾“â”€â”€â”€â”€â†’ ä»åº“
å»¶è¿Ÿæ¥æºï¼š
- ç‰©ç†è·ç¦»ï¼šè·¨åŸå¸‚ã€è·¨å›½éƒ¨ç½²
- ç½‘ç»œè´¨é‡ï¼šå¸¦å®½é™åˆ¶ã€ä¸¢åŒ…é‡ä¼ 
- ç½‘ç»œæ‹¥å¡ï¼šé«˜å³°æœŸç½‘ç»œç¹å¿™

2. ä»åº“æ€§èƒ½
ä¸»åº“å†™å…¥ï¼šSSDé«˜æ€§èƒ½å­˜å‚¨
ä»åº“åº”ç”¨ï¼šæ™®é€šSATAç›˜ï¼Œæ€§èƒ½å·®å¼‚å¯¼è‡´å»¶è¿Ÿ

3. å¤åˆ¶æ–¹å¼
å¼‚æ­¥å¤åˆ¶ï¼šä¸»åº“å†™å…¥åç«‹å³è¿”å›ï¼Œä¸ç­‰ä»åº“ç¡®è®¤
åŠåŒæ­¥å¤åˆ¶ï¼šç­‰å¾…è‡³å°‘ä¸€ä¸ªä»åº“ç¡®è®¤
åŒæ­¥å¤åˆ¶ï¼šç­‰å¾…æ‰€æœ‰ä»åº“ç¡®è®¤ï¼ˆå‡ ä¹ä¸ç”¨ï¼‰
```

**ğŸ”¸ ä¸šåŠ¡å±‚é¢å½±å“**

```
åœºæ™¯1ï¼šç”¨æˆ·ä¿¡æ¯æ›´æ–°
æ—¶é—´ 10:00:00 â†’ ç”¨æˆ·ä¿®æ”¹ä¸ªäººä¿¡æ¯ï¼ˆå†™ä¸»åº“ï¼‰
æ—¶é—´ 10:00:03 â†’ ç”¨æˆ·åˆ·æ–°é¡µé¢ï¼ˆè¯»ä»åº“ï¼‰
ç»“æœï¼šçœ‹åˆ°çš„è¿˜æ˜¯æ—§ä¿¡æ¯ï¼ˆå»¶è¿Ÿ3ç§’ï¼‰

åœºæ™¯2ï¼šè®¢å•çŠ¶æ€æŸ¥è¯¢
æ—¶é—´ 15:30:00 â†’ æ”¯ä»˜æˆåŠŸï¼Œè®¢å•çŠ¶æ€æ›´æ–°ï¼ˆå†™ä¸»åº“ï¼‰
æ—¶é—´ 15:30:02 â†’ ç”¨æˆ·æŸ¥è¯¢è®¢å•çŠ¶æ€ï¼ˆè¯»ä»åº“ï¼‰  
ç»“æœï¼šæ˜¾ç¤ºè®¢å•è¿˜æ˜¯"æœªæ”¯ä»˜"çŠ¶æ€

åœºæ™¯3ï¼šåº“å­˜æ‰£å‡
æ—¶é—´ 11:15:00 â†’ å•†å“ä¸‹å•ï¼Œåº“å­˜-1ï¼ˆå†™ä¸»åº“ï¼‰
æ—¶é—´ 11:15:01 â†’ å…¶ä»–ç”¨æˆ·æŸ¥çœ‹åº“å­˜ï¼ˆè¯»ä»åº“ï¼‰
ç»“æœï¼šçœ‹åˆ°é”™è¯¯çš„åº“å­˜æ•°é‡
```

### 9.3 å»¶è¿Ÿç›‘æ§ä¸æµ‹é‡


**ğŸ“Š å»¶è¿Ÿç›‘æ§SQL**

```sql
-- æ£€æŸ¥ä¸»ä»å»¶è¿Ÿ
SHOW SLAVE STATUS\G

-- å…³é”®æŒ‡æ ‡è§£è¯»
Seconds_Behind_Master: 3      -- ä»åº“è½åä¸»åº“3ç§’
Master_Log_File: mysql-bin.000123
Read_Master_Log_Pos: 4567890  -- å·²è¯»å–ä¸»åº“æ—¥å¿—ä½ç½®
Relay_Log_File: relay-bin.000456  
Exec_Master_Log_Pos: 4567800  -- å·²æ‰§è¡Œä¸»åº“æ—¥å¿—ä½ç½®

-- è®¡ç®—ç²¾ç¡®å»¶è¿Ÿ
SELECT 
    TIMESTAMPDIFF(SECOND, 
        (SELECT MAX(timestamp) FROM master_heartbeat),
        (SELECT MAX(timestamp) FROM slave_heartbeat)
    ) as replication_delay_seconds;
```

**ğŸ”§ è‡ªå®šä¹‰å»¶è¿Ÿç›‘æ§**

```sql
-- åˆ›å»ºå¿ƒè·³è¡¨ï¼ˆä¸»åº“ï¼‰
CREATE TABLE replication_heartbeat (
    id INT PRIMARY KEY,
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- å®šæœŸæ›´æ–°å¿ƒè·³ï¼ˆä¸»åº“ï¼‰
-- æ¯ç§’æ‰§è¡Œä¸€æ¬¡
UPDATE replication_heartbeat SET timestamp = NOW() WHERE id = 1;

-- æ£€æŸ¥å»¶è¿Ÿï¼ˆä»åº“ï¼‰
SELECT 
    TIMESTAMPDIFF(SECOND, timestamp, NOW()) as delay_seconds
FROM replication_heartbeat WHERE id = 1;
```

### 9.4 å»¶è¿Ÿä¼˜åŒ–ç­–ç•¥


**ğŸš€ æŠ€æœ¯ä¼˜åŒ–**

```
1. ç½‘ç»œä¼˜åŒ–
- ä¸“çº¿è¿æ¥ï¼šä½¿ç”¨ä¸“ç”¨ç½‘ç»œè¿æ¥
- å°±è¿‘éƒ¨ç½²ï¼šä¸»ä»åº“åœ°ç†ä½ç½®æ¥è¿‘
- å¸¦å®½ä¿è¯ï¼šç¡®ä¿å……è¶³çš„ç½‘ç»œå¸¦å®½

2. ç¡¬ä»¶ä¼˜åŒ–  
- SSDå­˜å‚¨ï¼šæå‡ä»åº“ç£ç›˜æ€§èƒ½
- å†…å­˜å¢åŠ ï¼šå¢å¤§innodb_buffer_pool_size
- CPUä¼˜åŒ–ï¼šå¤šæ ¸CPUå¹¶è¡Œå¤„ç†

3. å‚æ•°è°ƒä¼˜
# ä¸»åº“é…ç½®
sync_binlog = 1                    # æ¯æ¬¡æäº¤éƒ½åˆ·æ–°binlog
innodb_flush_log_at_trx_commit = 1 # æ¯æ¬¡æäº¤éƒ½åˆ·æ–°redo log

# ä»åº“é…ç½®  
slave_parallel_workers = 4         # å¹¶è¡Œå¤åˆ¶çº¿ç¨‹æ•°
slave_parallel_type = LOGICAL_CLOCK # é€»è¾‘æ—¶é’Ÿå¹¶è¡Œæ¨¡å¼
relay_log_recovery = ON            # è‡ªåŠ¨æ¢å¤relay log
```

**ğŸš€ ä¸šåŠ¡ä¼˜åŒ–**

```java
// ç­–ç•¥1ï¼šè¯»å†™åˆ†ç¦»æ™ºèƒ½è·¯ç”±
@Service
public class UserService {
    
    @Autowired
    private DataSource masterDS;
    
    @Autowired  
    private DataSource slaveDS;
    
    public User getUserById(Long id, boolean requireLatest) {
        DataSource ds = requireLatest ? masterDS : slaveDS;
        return queryUser(ds, id);
    }
    
    // æ›´æ–°åç«‹å³æŸ¥è¯¢ï¼Œä½¿ç”¨ä¸»åº“
    public User updateAndGet(Long id, User updates) {
        updateUser(masterDS, id, updates);
        return getUserById(id, true); // å¼ºåˆ¶è¯»ä¸»åº“
    }
    
    // æ™®é€šæŸ¥è¯¢ï¼Œä½¿ç”¨ä»åº“
    public User getUser(Long id) {
        return getUserById(id, false); // å…è®¸è¯»ä»åº“
    }
}

// ç­–ç•¥2ï¼šç¼“å­˜è¡¥å¿
@Service
public class OrderService {
    
    @Autowired
    private RedisTemplate<String, Object> redis;
    
    public void updateOrderStatus(Long orderId, String status) {
        // 1. æ›´æ–°æ•°æ®åº“ï¼ˆä¸»åº“ï¼‰
        updateOrderInDB(orderId, status);
        
        // 2. ç«‹å³æ›´æ–°ç¼“å­˜ï¼Œé¿å…è¯»åˆ°æ—§æ•°æ®
        String cacheKey = "order:" + orderId;
        Order order = getOrderFromDB(orderId);
        redis.opsForValue().set(cacheKey, order, Duration.ofMinutes(10));
        
        // 3. è®¾ç½®çŸ­æœŸå¼ºåˆ¶è¯»ä¸»åº“æ ‡è®°
        redis.opsForValue().set("order:force_master:" + orderId, "1", 
                               Duration.ofSeconds(30));
    }
    
    public Order getOrder(Long orderId) {
        // æ£€æŸ¥æ˜¯å¦éœ€è¦å¼ºåˆ¶è¯»ä¸»åº“
        String forceMaster = (String) redis.opsForValue()
            .get("order:force_master:" + orderId);
            
        if ("1".equals(forceMaster)) {
            return getOrderFromMaster(orderId);
        } else {
            return getOrderFromSlave(orderId);
        }
    }
}
```

---

## 10. ğŸ“ˆ åˆ†å¸ƒå¼ç›‘æ§æ–¹æ¡ˆ


### 10.1 ç›‘æ§ä½“ç³»æ¶æ„


**ğŸ—ï¸ æ•´ä½“ç›‘æ§æ¶æ„**

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚         ç›‘æ§å¤§å±æ˜¾ç¤º             â”‚
                    â”‚    (Grafana Dashboard)          â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚         æ•°æ®æŸ¥è¯¢æ¥å£             â”‚
                    â”‚     (Prometheus + InfluxDB)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                      â”‚                      â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   åº”ç”¨å±‚ç›‘æ§    â”‚  â”‚   ä¸­é—´ä»¶ç›‘æ§      â”‚  â”‚   æ•°æ®åº“ç›‘æ§      â”‚
    â”‚               â”‚  â”‚                  â”‚  â”‚                  â”‚
    â”‚ â€¢ æ¥å£å“åº”æ—¶é—´  â”‚  â”‚ â€¢ SQLè§£ææ—¶é—´     â”‚  â”‚ â€¢ æ…¢æŸ¥è¯¢æ—¥å¿—      â”‚
    â”‚ â€¢ é”™è¯¯ç‡ç»Ÿè®¡    â”‚  â”‚ â€¢ è¿æ¥æ± çŠ¶æ€      â”‚  â”‚ â€¢ è¿æ¥æ•°ç›‘æ§      â”‚
    â”‚ â€¢ è¯·æ±‚é‡ç›‘æ§    â”‚  â”‚ â€¢ è·¯ç”±è€—æ—¶       â”‚  â”‚ â€¢ ä¸»ä»å»¶è¿Ÿ       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.2 æ ¸å¿ƒç›‘æ§æŒ‡æ ‡


**ğŸ“Š åº”ç”¨å±‚é¢æŒ‡æ ‡**

```yaml
# Prometheusç›‘æ§é…ç½®ç¤ºä¾‹
groups:
- name: application_metrics
  rules:
  # æ¥å£å“åº”æ—¶é—´
  - alert: SlowAPIResponse
    expr: histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m])) > 2
    for: 2m
    labels:
      severity: warning
    annotations:
      summary: "APIå“åº”æ—¶é—´è¿‡æ…¢"
      description: "95%è¯·æ±‚å“åº”æ—¶é—´è¶…è¿‡2ç§’"

  # æ•°æ®åº“è¿æ¥æ± 
  - alert: DatabaseConnectionPoolHigh
    expr: hikaricp_connections_active / hikaricp_connections_max > 0.8
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "æ•°æ®åº“è¿æ¥æ± ä½¿ç”¨ç‡è¿‡é«˜"
      description: "è¿æ¥æ± ä½¿ç”¨ç‡è¶…è¿‡80%"
```

**ğŸ“Š æ•°æ®åº“å±‚é¢æŒ‡æ ‡**

```sql
-- MySQLç›‘æ§æŸ¥è¯¢
-- 1. æ…¢æŸ¥è¯¢ç»Ÿè®¡
SELECT 
    SUBSTRING(sql_text, 1, 100) as sql_preview,
    COUNT(*) as occurrence_count,
    AVG(query_time) as avg_time,
    MAX(query_time) as max_time,
    SUM(rows_examined) as total_rows_examined
FROM mysql.slow_log
WHERE start_time >= NOW() - INTERVAL 1 HOUR
GROUP BY SUBSTRING(sql_text, 1, 100)
HAVING COUNT(*) > 5
ORDER BY occurrence_count DESC;

-- 2. è¿æ¥çŠ¶æ€ç›‘æ§
SHOW PROCESSLIST;

-- 3. InnoDBçŠ¶æ€ç›‘æ§
SHOW ENGINE INNODB STATUS\G
```

### 10.3 å‘Šè­¦è§„åˆ™è®¾è®¡


**ğŸš¨ åˆ†çº§å‘Šè­¦ä½“ç³»**

```
å‘Šè­¦çº§åˆ«åˆ†ç±»ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”´ ä¸¥é‡å‘Šè­¦ (Critical)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ æ•°æ®åº“ä¸å¯ç”¨                          â”‚
â”‚ â€¢ ä¸»ä»å¤åˆ¶ä¸­æ–­                          â”‚
â”‚ â€¢ è¿æ¥æ± è€—å°½                            â”‚
â”‚ â€¢ ç£ç›˜ç©ºé—´ä¸è¶³(<10%)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸŸ¡ è­¦å‘Šå‘Šè­¦ (Warning)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ æ…¢æŸ¥è¯¢æ•°é‡æ¿€å¢(>å¹³æ—¶2å€)               â”‚
â”‚ â€¢ ä¸»ä»å»¶è¿Ÿè¿‡å¤§(>10ç§’)                   â”‚
â”‚ â€¢ è¿æ¥æ•°è¿‡å¤š(>æœ€å¤§å€¼80%)                â”‚
â”‚ â€¢ CPUä½¿ç”¨ç‡è¿‡é«˜(>80%)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”µ ä¿¡æ¯å‘Šè­¦ (Info)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ æ–°æ…¢æŸ¥è¯¢å‡ºç°                          â”‚
â”‚ â€¢ æ•°æ®åº“é‡å¯                            â”‚
â”‚ â€¢ é…ç½®å˜æ›´                              â”‚
â”‚ â€¢ å®šæœŸå¥åº·æ£€æŸ¥æŠ¥å‘Š                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ğŸ”§ å‘Šè­¦è§„åˆ™é…ç½®**

```yaml
# AlertManageré…ç½®ç¤ºä¾‹
route:
  group_by: ['alertname', 'instance']
  group_wait: 10s
  group_interval: 10s
  repeat_interval: 1h
  receiver: 'web.hook'

receivers:
- name: 'web.hook'
  webhook_configs:
  - url: 'http://alert-manager:9093/webhook'
    send_resolved: true

inhibit_rules:
- source_match:
    severity: 'critical'
  target_match:
    severity: 'warning'
  equal: ['alertname', 'instance']
```

### 10.4 ç›‘æ§å¤§å±è®¾è®¡


**ğŸ“± å®æ—¶ç›‘æ§é¢æ¿**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MySQLåˆ†å¸ƒå¼ç›‘æ§å¤§å±                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   QPSç›‘æ§    â”‚  â”‚  æ…¢æŸ¥è¯¢ç›‘æ§   â”‚  â”‚  è¿æ¥æ•°ç›‘æ§   â”‚         â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚         â”‚
â”‚  â”‚    1,234     â”‚  â”‚     23       â”‚  â”‚   156/500    â”‚         â”‚
â”‚  â”‚   queries/s  â”‚  â”‚   slow/min   â”‚  â”‚  connections â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   æ…¢æŸ¥è¯¢TOP10                           â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ 1. SELECT * FROM user WHERE name LIKE '%å¼ %'  (2.3s)   â”‚   â”‚
â”‚  â”‚ 2. UPDATE order SET status = 'paid' WHERE...  (1.8s)   â”‚   â”‚
â”‚  â”‚ 3. SELECT COUNT(*) FROM log WHERE date >...   (1.2s)   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚    ä¸»ä»å»¶è¿Ÿç›‘æ§      â”‚  â”‚    å®ä¾‹å¥åº·çŠ¶æ€      â”‚             â”‚
â”‚  â”‚                    â”‚  â”‚                    â”‚             â”‚
â”‚  â”‚  Master â†’ Slave1   â”‚  â”‚  âœ… DB1-Master     â”‚             â”‚
â”‚  â”‚       2.1s         â”‚  â”‚  âœ… DB1-Slave1     â”‚             â”‚
â”‚  â”‚  Master â†’ Slave2   â”‚  â”‚  âš ï¸  DB2-Slave2     â”‚             â”‚
â”‚  â”‚       1.8s         â”‚  â”‚  âŒ DB3-Master     â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 11. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 11.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ åˆ†å¸ƒå¼ç¯å¢ƒå¤æ‚æ€§ï¼šä¸åªæ˜¯SQLæ…¢ï¼Œæ•´ä¸ªé“¾è·¯éƒ½å¯èƒ½æœ‰é—®é¢˜
ğŸ”¸ å¤šå®ä¾‹ç®¡ç†ï¼šéœ€è¦ç»Ÿä¸€æ”¶é›†åˆ†æå„ä¸ªæ•°æ®åº“å®ä¾‹çš„æ…¢æŸ¥è¯¢
ğŸ”¸ è¯»å†™åˆ†ç¦»ç›‘æ§ï¼šä¸»åº“å†™æ“ä½œå’Œä»åº“è¯»æ“ä½œæœ‰ä¸åŒçš„ç›‘æ§é‡ç‚¹
ğŸ”¸ åˆ†åº“åˆ†è¡¨æŒ‘æˆ˜ï¼šæŸ¥è¯¢è·¯ç”±ã€è·¨åˆ†ç‰‡æ“ä½œå¸¦æ¥çš„æ€§èƒ½é—®é¢˜
ğŸ”¸ ä¸­é—´ä»¶ä½œç”¨ï¼šæ‰¿æ‹…è·¯ç”±ã€è§£æã€åˆå¹¶ç­‰å…³é”®åŠŸèƒ½
ğŸ”¸ å…¨é“¾è·¯è·Ÿè¸ªï¼šä»è¯·æ±‚åˆ°å“åº”çš„å®Œæ•´æ€§èƒ½åˆ†æ
ğŸ”¸ åˆ†å¸ƒå¼äº‹åŠ¡ï¼šXAäº‹åŠ¡å¸¦æ¥çš„é¢å¤–æ€§èƒ½å¼€é”€
ğŸ”¸ è·¨åº“æŸ¥è¯¢ä¼˜åŒ–ï¼šé€šè¿‡æ‹†åˆ†ã€å†—ä½™ã€ç¼“å­˜ç­‰æ–¹å¼ä¼˜åŒ–
ğŸ”¸ ä¸»ä»å»¶è¿Ÿå½±å“ï¼šæ•°æ®ä¸€è‡´æ€§ä¸æŸ¥è¯¢æ€§èƒ½çš„å¹³è¡¡
ğŸ”¸ ç›‘æ§ä½“ç³»ï¼šåˆ†å±‚æ¬¡ã€å¤šç»´åº¦çš„ç»¼åˆç›‘æ§æ–¹æ¡ˆ
```

### 11.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ åˆ†å¸ƒå¼ç¯å¢ƒçš„æœ¬è´¨åŒºåˆ«**
```
å•æœºç¯å¢ƒï¼š
- é—®é¢˜ç®€å•æ˜ç¡®ï¼šæ…¢å°±æ˜¯SQLæ…¢
- å®šä½å®¹æ˜“ï¼šç›´æ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—
- ä¼˜åŒ–ç›´æ¥ï¼šåŠ ç´¢å¼•ã€æ”¹SQLå°±è¡Œ

åˆ†å¸ƒå¼ç¯å¢ƒï¼š
- é—®é¢˜å¤æ‚å¤šæ ·ï¼šå¯èƒ½æ˜¯ç½‘ç»œã€ä¸­é—´ä»¶ã€æ•°æ®åº“
- å®šä½å›°éš¾ï¼šéœ€è¦è·Ÿè¸ªæ•´ä¸ªé“¾è·¯
- ä¼˜åŒ–ç»¼åˆï¼šéœ€è¦ä»æ¶æ„ã€ä¸šåŠ¡ã€æŠ€æœ¯å¤šæ–¹é¢è€ƒè™‘
```

**ğŸ”¹ æ€§èƒ½é—®é¢˜çš„å±‚æ¬¡æ€§**
```
ç¬¬1å±‚ - ç½‘ç»œå±‚ï¼šç½‘ç»œå»¶è¿Ÿã€å¸¦å®½é™åˆ¶
ç¬¬2å±‚ - ä¸­é—´ä»¶å±‚ï¼šSQLè§£æã€è·¯ç”±è®¡ç®—ã€è¿æ¥æ± 
ç¬¬3å±‚ - æ•°æ®åº“å±‚ï¼šå…·ä½“çš„SQLæ‰§è¡Œã€é”ç­‰å¾…
ç¬¬4å±‚ - å­˜å‚¨å±‚ï¼šç£ç›˜IOã€å†…å­˜ä½¿ç”¨
ç¬¬5å±‚ - ä¸šåŠ¡å±‚ï¼šæŸ¥è¯¢è®¾è®¡ã€äº‹åŠ¡è®¾è®¡

ä¼˜åŒ–è¦ç‚¹ï¼šå…ˆä¼˜åŒ–ä¸Šå±‚ï¼Œå†ä¼˜åŒ–ä¸‹å±‚
```

**ğŸ”¹ ç›‘æ§çš„é‡è¦æ€§**
```
æ²¡æœ‰ç›‘æ§ï¼š
- é—®é¢˜å‘ç”Ÿåæ‰çŸ¥é“
- åªèƒ½çŒœæµ‹é—®é¢˜åŸå› 
- ä¼˜åŒ–æ•ˆæœæ— æ³•é‡åŒ–

æœ‰äº†ç›‘æ§ï¼š
- é—®é¢˜è¶‹åŠ¿æå‰å‘ç°
- ç²¾ç¡®å®šä½é—®é¢˜ä½ç½®
- ä¼˜åŒ–æ•ˆæœæ•°æ®å¯è§
```

### 11.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ é—®é¢˜å®šä½æµç¨‹**
```
æ­¥éª¤1ï¼šç¡®å®šé—®é¢˜èŒƒå›´
- æ˜¯å…¨å±€æ…¢è¿˜æ˜¯ä¸ªåˆ«å®ä¾‹æ…¢ï¼Ÿ
- æ˜¯æŸç±»æŸ¥è¯¢æ…¢è¿˜æ˜¯æ‰€æœ‰æŸ¥è¯¢æ…¢ï¼Ÿ

æ­¥éª¤2ï¼šåˆ†å±‚åˆ†æ
- åº”ç”¨å±‚ï¼šæ¥å£å“åº”æ—¶é—´åˆ†æ
- ä¸­é—´ä»¶å±‚ï¼šè·¯ç”±å’Œè¿æ¥åˆ†æ  
- æ•°æ®åº“å±‚ï¼šå…·ä½“SQLåˆ†æ

æ­¥éª¤3ï¼šç»¼åˆä¼˜åŒ–
- çŸ­æœŸï¼šé’ˆå¯¹å…·ä½“æ…¢SQLä¼˜åŒ–
- ä¸­æœŸï¼šè°ƒæ•´æ¶æ„è®¾è®¡
- é•¿æœŸï¼šé‡æ–°è®¾è®¡åˆ†åº“åˆ†è¡¨ç­–ç•¥
```

**ğŸ”§ ä¼˜åŒ–ç­–ç•¥é€‰æ‹©**
```
æ€§èƒ½è¦æ±‚æé«˜ï¼š
âœ… æ•°æ®å†—ä½™ï¼Œé¿å…è·¨åº“æŸ¥è¯¢
âœ… ç¼“å­˜çƒ­ç‚¹æ•°æ®
âœ… è¯»å†™åˆ†ç¦»ï¼Œä¸“åº“ä¸“ç”¨

ä¸€è‡´æ€§è¦æ±‚æé«˜ï¼š
âœ… åˆ†å¸ƒå¼äº‹åŠ¡ä¿è¯å¼ºä¸€è‡´æ€§
âœ… ä¸»åº“è¯»å†™ï¼Œç¡®ä¿æ•°æ®å‡†ç¡®
âœ… å®æ—¶ç›‘æ§ä¸»ä»å»¶è¿Ÿ

å¹³è¡¡æ€§èƒ½å’Œä¸€è‡´æ€§ï¼š
âœ… æœ€ç»ˆä¸€è‡´æ€§è®¾è®¡
âœ… å¼‚æ­¥å¤„ç†éå…³é”®æ“ä½œ
âœ… æ™ºèƒ½è·¯ç”±é€‰æ‹©åˆé€‚çš„æ•°æ®æº
```

### 11.4 æœ€ä½³å®è·µå»ºè®®


**ğŸ“ˆ ç›‘æ§ä½“ç³»å»ºè®¾**
```
ç›‘æ§å±‚æ¬¡ï¼š
1. åŸºç¡€ç›‘æ§ï¼šCPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œ
2. æ•°æ®åº“ç›‘æ§ï¼šè¿æ¥æ•°ã€QPSã€æ…¢æŸ¥è¯¢ã€ä¸»ä»å»¶è¿Ÿ
3. åº”ç”¨ç›‘æ§ï¼šæ¥å£å“åº”æ—¶é—´ã€é”™è¯¯ç‡ã€ä¸šåŠ¡æŒ‡æ ‡
4. é“¾è·¯ç›‘æ§ï¼šç«¯åˆ°ç«¯çš„è¯·æ±‚è·Ÿè¸ªåˆ†æ

å‘Šè­¦ç­–ç•¥ï¼š
- åˆ†çº§å‘Šè­¦ï¼šä¸¥é‡ã€è­¦å‘Šã€ä¿¡æ¯
- æ™ºèƒ½å‘Šè­¦ï¼šé¿å…å‘Šè­¦é£æš´
- ä¸šåŠ¡å‘Šè­¦ï¼šç»“åˆä¸šåŠ¡æŒ‡æ ‡è®¾ç½®
```

**ğŸ› ï¸ æ—¥å¸¸è¿ç»´é‡ç‚¹**
```
æ¯æ—¥æ£€æŸ¥ï¼š
â–¡ æ…¢æŸ¥è¯¢æ—¥å¿—åˆ†æ
â–¡ ä¸»ä»å»¶è¿Ÿæ£€æŸ¥
â–¡ è¿æ¥æ± çŠ¶æ€ç¡®è®¤
â–¡ ç£ç›˜ç©ºé—´æ£€æŸ¥

æ¯å‘¨æ£€æŸ¥ï¼š
â–¡ æ…¢æŸ¥è¯¢è¶‹åŠ¿åˆ†æ
â–¡ æ€§èƒ½åŸºçº¿å¯¹æ¯”
â–¡ å®¹é‡è§„åˆ’è¯„ä¼°
â–¡ ç´¢å¼•ä½¿ç”¨æƒ…å†µåˆ†æ

æ¯æœˆæ£€æŸ¥ï¼š
â–¡ æ¶æ„ä¼˜åŒ–è¯„ä¼°
â–¡ åˆ†ç‰‡å‡è¡¡æ€§æ£€æŸ¥
â–¡ ä¸šåŠ¡å¢é•¿å½±å“åˆ†æ
â–¡ æŠ€æœ¯å€ºåŠ¡æ¸…ç†
```

### 11.5 æŠ€æœ¯å‘å±•è¶‹åŠ¿


**ğŸš€ æ–°æŠ€æœ¯åº”ç”¨**
```
äº‘åŸç”Ÿæ•°æ®åº“ï¼š
- è‡ªåŠ¨åˆ†ç‰‡ã€è‡ªåŠ¨æ‰©å®¹
- å†…ç½®ç›‘æ§å’Œå‘Šè­¦
- è¯»å†™åˆ†ç¦»è‡ªåŠ¨åŒ–

æ™ºèƒ½åŒ–è¿ç»´ï¼š
- AIé©±åŠ¨çš„æ…¢æŸ¥è¯¢ä¼˜åŒ–å»ºè®®
- è‡ªåŠ¨ç´¢å¼•æ¨è
- æ™ºèƒ½å®¹é‡é¢„æµ‹

åˆ†å¸ƒå¼æ•°æ®åº“ï¼š
- NewSQLæ•°æ®åº“ï¼ˆTiDBã€CockroachDBï¼‰
- åŸç”Ÿæ”¯æŒåˆ†å¸ƒå¼äº‹åŠ¡
- è‡ªåŠ¨è´Ÿè½½å‡è¡¡
```

**ğŸ“Š ç›‘æ§æŠ€æœ¯å‘å±•**
```
å®æ—¶ç›‘æ§ï¼š
- æ¯«ç§’çº§å»¶è¿Ÿç›‘æ§
- å®æ—¶å‘Šè­¦å’Œè‡ªåŠ¨å¤„ç†
- å¯è§†åŒ–é“¾è·¯è¿½è¸ª

é¢„æµ‹æ€§ç›‘æ§ï¼š
- åŸºäºæœºå™¨å­¦ä¹ çš„æ€§èƒ½é¢„æµ‹
- å®¹é‡è§„åˆ’è‡ªåŠ¨åŒ–
- å¼‚å¸¸æ£€æµ‹å’Œé¢„è­¦
```

### 11.6 å¸¸è§è¯¯åŒºé¿å…


**âŒ é¿å…çš„é”™è¯¯åšæ³•**
```
è¿‡åº¦åˆ†ç‰‡ï¼š
- é”™è¯¯ï¼šä¸ºäº†æ€§èƒ½æ— é™åˆ¶åˆ†ç‰‡
- æ­£ç¡®ï¼šæ ¹æ®å®é™…æ•°æ®é‡å’ŒæŸ¥è¯¢æ¨¡å¼åˆç†åˆ†ç‰‡

å¿½ç•¥ç½‘ç»œå› ç´ ï¼š
- é”™è¯¯ï¼šåªå…³æ³¨æ•°æ®åº“å±‚é¢çš„ä¼˜åŒ–
- æ­£ç¡®ï¼šç»¼åˆè€ƒè™‘ç½‘ç»œã€ä¸­é—´ä»¶ã€æ•°æ®åº“å„å±‚

ç›²ç›®è¿½æ±‚å¼ºä¸€è‡´æ€§ï¼š
- é”™è¯¯ï¼šæ‰€æœ‰åœºæ™¯éƒ½ç”¨åˆ†å¸ƒå¼äº‹åŠ¡
- æ­£ç¡®ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©åˆé€‚çš„ä¸€è‡´æ€§çº§åˆ«
```

**âœ… æ¨èçš„æœ€ä½³å®è·µ**
```
æ¸è¿›å¼ä¼˜åŒ–ï¼š
1. å…ˆè§£å†³æœ€æ˜æ˜¾çš„é—®é¢˜
2. å»ºç«‹ç›‘æ§åŸºçº¿
3. é€æ­¥ä¼˜åŒ–æ¶æ„
4. æŒç»­ç›‘æ§å’Œè°ƒæ•´

ä¸šåŠ¡é©±åŠ¨ï¼š
- ä¼˜åŒ–è¦å›´ç»•å®é™…ä¸šåŠ¡éœ€æ±‚
- ä¸ä¸ºäº†æŠ€æœ¯è€ŒæŠ€æœ¯
- å¹³è¡¡æ€§èƒ½ã€æˆæœ¬ã€å¤æ‚åº¦

å›¢é˜Ÿåä½œï¼š
- DBAã€å¼€å‘ã€è¿ç»´å¯†åˆ‡é…åˆ
- å»ºç«‹æ ‡å‡†åŒ–çš„æµç¨‹
- çŸ¥è¯†å…±äº«å’ŒæŠ€èƒ½æå‡
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- åˆ†å¸ƒå¼æ…¢æŸ¥è¯¢ï¼Œé“¾è·¯å…¨åˆ†æ
- å¤šå®ä¾‹ç»Ÿä¸€ç®¡ï¼Œè¯»å†™åˆ†ç¦»çœ‹
- è·¨åº“æŸ¥è¯¢è¦é¿å…ï¼Œç¼“å­˜å†—ä½™æ¥å¸®å¿™
- ç›‘æ§å‘Šè­¦å…¨è¦†ç›–ï¼Œé—®é¢˜å®šä½ä¸è¿·èŒ«
- æ¸è¿›ä¼˜åŒ–æ­¥æ­¥æ¥ï¼Œä¸šåŠ¡ä¸ºæœ¬æŠ€æœ¯è·Ÿ