---
title: 15ã€MySQLå®‰è£…éƒ¨ç½²è§„èŒƒ
---
## ðŸ“š ç›®å½•

1. [å®‰è£…å‰çŽ¯å¢ƒå‡†å¤‡](#1-å®‰è£…å‰çŽ¯å¢ƒå‡†å¤‡)
2. [ç³»ç»Ÿå‚æ•°é…ç½®ä¼˜åŒ–](#2-ç³»ç»Ÿå‚æ•°é…ç½®ä¼˜åŒ–)
3. [MySQLå®‰è£…æµç¨‹](#3-MySQLå®‰è£…æµç¨‹)
4. [ç›®å½•ç»“æž„è§„èŒƒ](#4-ç›®å½•ç»“æž„è§„èŒƒ)
5. [é…ç½®æ–‡ä»¶ç®¡ç†](#5-é…ç½®æ–‡ä»¶ç®¡ç†)
6. [æœåŠ¡å¯åŠ¨ä¸Žç®¡ç†](#6-æœåŠ¡å¯åŠ¨ä¸Žç®¡ç†)
7. [å®‰å…¨åˆå§‹åŒ–é…ç½®](#7-å®‰å…¨åˆå§‹åŒ–é…ç½®)
8. [çŽ¯å¢ƒå˜é‡ä¸Žè·¯å¾„](#8-çŽ¯å¢ƒå˜é‡ä¸Žè·¯å¾„)
9. [å®‰è£…éªŒè¯ä¸Žæµ‹è¯•](#9-å®‰è£…éªŒè¯ä¸Žæµ‹è¯•)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ðŸ–¥ï¸ å®‰è£…å‰çŽ¯å¢ƒå‡†å¤‡


### 1.1 ç¡¬ä»¶çŽ¯å¢ƒè¦æ±‚


**åŸºæœ¬é…ç½®è¦æ±‚**
```
ç”Ÿäº§çŽ¯å¢ƒæœ€ä½Žé…ç½®ï¼š
â€¢ CPUï¼š4æ ¸å¿ƒä»¥ä¸Š
â€¢ å†…å­˜ï¼š8GBä»¥ä¸Šï¼ˆæŽ¨è16GB+ï¼‰
â€¢ ç£ç›˜ï¼šSSDç¡¬ç›˜ï¼Œå¯ç”¨ç©ºé—´100GB+
â€¢ ç½‘ç»œï¼šåƒå…†ç½‘å¡

é«˜æ€§èƒ½çŽ¯å¢ƒæŽ¨èé…ç½®ï¼š
â€¢ CPUï¼š8æ ¸å¿ƒä»¥ä¸Š
â€¢ å†…å­˜ï¼š32GBä»¥ä¸Š
â€¢ ç£ç›˜ï¼šNVMe SSDï¼ŒRAID 10é…ç½®
â€¢ ç½‘ç»œï¼šä¸‡å…†ç½‘å¡
```

### 1.2 æ“ä½œç³»ç»ŸçŽ¯å¢ƒ


**æ”¯æŒçš„æ“ä½œç³»ç»Ÿ**
- **Linuxç³»ç»Ÿ**ï¼šCentOS 7/8ã€Ubuntu 18.04/20.04ã€Red Hat 7/8
- **ç‰ˆæœ¬é€‰æ‹©**ï¼šæŽ¨èä½¿ç”¨LTSé•¿æœŸæ”¯æŒç‰ˆæœ¬
- **æž¶æž„æ”¯æŒ**ï¼šx86_64æž¶æž„ï¼ˆ64ä½ï¼‰

**ç³»ç»ŸåŸºç¡€æ£€æŸ¥**
```bash
# æ£€æŸ¥ç³»ç»Ÿç‰ˆæœ¬
cat /etc/os-release

# æ£€æŸ¥ç³»ç»Ÿæž¶æž„
uname -m

# æ£€æŸ¥å¯ç”¨å†…å­˜
free -h

# æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h

# æ£€æŸ¥ç½‘ç»œçŠ¶æ€
ip addr show
```

### 1.3 ä¾èµ–è½¯ä»¶å‡†å¤‡


**å¿…é¡»å®‰è£…çš„ä¾èµ–åŒ…**
```bash
# CentOS/RHELç³»ç»Ÿ
yum install -y wget curl vim net-tools

# Ubuntu/Debianç³»ç»Ÿ
apt-get update
apt-get install -y wget curl vim net-tools
```

---

## 2. âš™ï¸ ç³»ç»Ÿå‚æ•°é…ç½®ä¼˜åŒ–


### 2.1 å†…æ ¸å‚æ•°è°ƒæ•´


MySQLæ•°æ®åº“å¯¹ç³»ç»Ÿæ€§èƒ½è¦æ±‚è¾ƒé«˜ï¼Œéœ€è¦è°ƒæ•´ä¸€äº›å…³é”®çš„å†…æ ¸å‚æ•°æ¥èŽ·å¾—æœ€ä½³æ€§èƒ½ã€‚

**å…³é”®å‚æ•°è¯´æ˜Ž**

**æ–‡ä»¶æè¿°ç¬¦é™åˆ¶**
```bash
# ä»€ä¹ˆæ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼Ÿ
# ç®€å•è¯´å°±æ˜¯ç³»ç»Ÿèƒ½åŒæ—¶æ‰“å¼€æ–‡ä»¶çš„æ•°é‡é™åˆ¶
# MySQLéœ€è¦åŒæ—¶æ‰“å¼€å¾ˆå¤šæ•°æ®æ–‡ä»¶å’Œè¿žæŽ¥ï¼Œæ‰€ä»¥è¦è°ƒå¤§è¿™ä¸ªå€¼

# ä¸´æ—¶è°ƒæ•´ï¼ˆé‡å¯å¤±æ•ˆï¼‰
ulimit -n 65535

# æ°¸ä¹…è°ƒæ•´ - ç¼–è¾‘ /etc/security/limits.conf
* soft nofile 65535
* hard nofile 65535
mysql soft nofile 65535
mysql hard nofile 65535
```

**å†…å­˜ç®¡ç†å‚æ•°**
```bash
# ç¼–è¾‘ /etc/sysctl.conf
# è¿™äº›å‚æ•°å½±å“ç³»ç»Ÿå†…å­˜å’Œç½‘ç»œæ€§èƒ½

# è™šæ‹Ÿå†…å­˜äº¤æ¢ç­–ç•¥ï¼ˆ0-100ï¼Œè¶Šå°è¶Šä¸çˆ±ç”¨swapï¼‰
vm.swappiness = 1

# è„é¡µå†™å…¥ç­–ç•¥ï¼ˆå½±å“æ•°æ®å†™ç£ç›˜çš„æ—¶æœºï¼‰
vm.dirty_ratio = 15
vm.dirty_background_ratio = 5

# ç½‘ç»œè¿žæŽ¥é˜Ÿåˆ—å¤§å°
net.core.somaxconn = 65535
net.ipv4.tcp_max_syn_backlog = 65535
```

**åº”ç”¨ç”Ÿæ•ˆ**
```bash
# é‡æ–°åŠ è½½ç³»ç»Ÿå‚æ•°
sysctl -p

# éªŒè¯å‚æ•°æ˜¯å¦ç”Ÿæ•ˆ
ulimit -n
sysctl vm.swappiness
```

### 2.2 é˜²ç«å¢™é…ç½®


**ç«¯å£å¼€æ”¾è§„èŒƒ**

MySQLé»˜è®¤ä½¿ç”¨3306ç«¯å£ï¼Œéœ€è¦åœ¨é˜²ç«å¢™ä¸­å¼€æ”¾æ­¤ç«¯å£ã€‚

```bash
# CentOS 7/8 ä½¿ç”¨ firewalld
# å¼€æ”¾3306ç«¯å£
firewall-cmd --permanent --add-port=3306/tcp
firewall-cmd --reload

# æŸ¥çœ‹å¼€æ”¾çš„ç«¯å£
firewall-cmd --list-ports

# Ubuntu ä½¿ç”¨ ufw
ufw allow 3306/tcp
ufw reload
ufw status
```

---

## 3. ðŸ”§ MySQLå®‰è£…æµç¨‹


### 3.1 å®‰è£…æ–¹å¼é€‰æ‹©


**ä¸‰ç§ä¸»è¦å®‰è£…æ–¹å¼å¯¹æ¯”**

| å®‰è£…æ–¹å¼ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|---------|------|------|---------|
| **YUM/APTåŒ…ç®¡ç†** | `å®‰è£…ç®€å•ï¼Œè‡ªåŠ¨ä¾èµ–` | `ç‰ˆæœ¬å¯èƒ½ä¸æ˜¯æœ€æ–°` | `å¿«é€Ÿéƒ¨ç½²ï¼Œæµ‹è¯•çŽ¯å¢ƒ` |
| **RPM/DEBåŒ…** | `ç‰ˆæœ¬å¯æŽ§ï¼Œä¾èµ–æ˜Žç¡®` | `éœ€æ‰‹åŠ¨å¤„ç†ä¾èµ–` | `ç”Ÿäº§çŽ¯å¢ƒï¼Œç‰ˆæœ¬å›ºå®š` |
| **æºç ç¼–è¯‘** | `å®šåˆ¶åŒ–å¼ºï¼Œæ€§èƒ½æœ€ä¼˜` | `ç¼–è¯‘å¤æ‚ï¼Œè€—æ—¶é•¿` | `ç‰¹æ®Šéœ€æ±‚ï¼Œæ€§èƒ½è¦æ±‚æžé«˜` |

### 3.2 å®˜æ–¹YUMä»“åº“å®‰è£…ï¼ˆæŽ¨èï¼‰


è¿™æ˜¯æœ€ç®€å•å¯é çš„å®‰è£…æ–¹å¼ï¼Œé€‚åˆå¤§å¤šæ•°åœºæ™¯ã€‚

**å®‰è£…æ­¥éª¤è¯¦è§£**

```bash
# ç¬¬1æ­¥ï¼šä¸‹è½½MySQLå®˜æ–¹YUMæº
# è¿™ä¸ªæºåŒ…å«äº†æœ€æ–°ç‰ˆæœ¬çš„MySQL
wget https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm

# ç¬¬2æ­¥ï¼šå®‰è£…YUMæº
rpm -ivh mysql80-community-release-el7-3.noarch.rpm

# ç¬¬3æ­¥ï¼šæŸ¥çœ‹å¯ç”¨ç‰ˆæœ¬ï¼ˆå¯é€‰ï¼‰
yum repolist enabled | grep mysql

# ç¬¬4æ­¥ï¼šå®‰è£…MySQLæœåŠ¡å™¨
# è¿™ä¼šå®‰è£…MySQLæœåŠ¡å™¨å’Œå¿…è¦çš„å®¢æˆ·ç«¯å·¥å…·
yum install -y mysql-community-server

# ç¬¬5æ­¥ï¼šæŸ¥çœ‹å®‰è£…ç»“æžœ
rpm -qa | grep mysql
```

### 3.3 äºŒè¿›åˆ¶åŒ…å®‰è£…


é€‚åˆéœ€è¦ç²¾ç¡®æŽ§åˆ¶å®‰è£…ä½ç½®å’Œé…ç½®çš„åœºæ™¯ã€‚

```bash
# ç¬¬1æ­¥ï¼šåˆ›å»ºMySQLç”¨æˆ·
# MySQLæœåŠ¡éœ€è¦ä¸“é—¨çš„ç”¨æˆ·æ¥è¿è¡Œï¼Œæé«˜å®‰å…¨æ€§
useradd -r -s /bin/false mysql

# ç¬¬2æ­¥ï¼šä¸‹è½½äºŒè¿›åˆ¶åŒ…
wget https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-8.0.32-linux-glibc2.12-x86_64.tar.xz

# ç¬¬3æ­¥ï¼šè§£åŽ‹åˆ°æŒ‡å®šç›®å½•
tar -xf mysql-8.0.32-linux-glibc2.12-x86_64.tar.xz -C /usr/local/
cd /usr/local/
ln -s mysql-8.0.32-linux-glibc2.12-x86_64 mysql

# ç¬¬4æ­¥ï¼šåˆ›å»ºå¿…è¦çš„ç›®å½•
mkdir -p /usr/local/mysql/data
mkdir -p /var/log/mysql
chown -R mysql:mysql /usr/local/mysql
chown -R mysql:mysql /var/log/mysql
```

---

## 4. ðŸ“ ç›®å½•ç»“æž„è§„èŒƒ


### 4.1 æ ‡å‡†ç›®å½•è§„åˆ’


è§„èŒƒçš„ç›®å½•ç»“æž„æœ‰åŠ©äºŽåŽæœŸçš„è¿ç»´ç®¡ç†å’Œé—®é¢˜æŽ’æŸ¥ã€‚

**ç›®å½•ç»“æž„å›¾ç¤º**
```
MySQLç›®å½•ç»“æž„è§„èŒƒï¼š
/usr/local/mysql/           â† å®‰è£…ä¸»ç›®å½•
â”œâ”€â”€ bin/                    â† å¯æ‰§è¡Œæ–‡ä»¶
â”œâ”€â”€ lib/                    â† åº“æ–‡ä»¶
â”œâ”€â”€ include/                â† å¤´æ–‡ä»¶
â”œâ”€â”€ share/                  â† å…±äº«æ–‡ä»¶
â””â”€â”€ support-files/          â† é…ç½®æ¨¡æ¿

/var/lib/mysql/             â† æ•°æ®ç›®å½•
â”œâ”€â”€ mysql/                  â† ç³»ç»Ÿæ•°æ®åº“
â”œâ”€â”€ performance_schema/     â† æ€§èƒ½ç›‘æŽ§åº“
â”œâ”€â”€ sys/                    â† ç³»ç»Ÿä¿¡æ¯åº“
â”œâ”€â”€ your_database/          â† ä¸šåŠ¡æ•°æ®åº“
â”œâ”€â”€ mysql-bin.000001        â† äºŒè¿›åˆ¶æ—¥å¿—
â””â”€â”€ ib_logfile0            â† InnoDBæ—¥å¿—

/var/log/mysql/             â† æ—¥å¿—ç›®å½•
â”œâ”€â”€ error.log               â† é”™è¯¯æ—¥å¿—
â”œâ”€â”€ slow.log                â† æ…¢æŸ¥è¯¢æ—¥å¿—
â”œâ”€â”€ general.log             â† é€šç”¨æŸ¥è¯¢æ—¥å¿—
â””â”€â”€ binlog.000001           â† äºŒè¿›åˆ¶æ—¥å¿—
```

### 4.2 ç›®å½•æƒé™è®¾ç½®


**å®‰å…¨æƒé™é…ç½®**
```bash
# è®¾ç½®MySQLä¸»ç›®å½•æƒé™
chown -R mysql:mysql /usr/local/mysql
chmod -R 755 /usr/local/mysql

# è®¾ç½®æ•°æ®ç›®å½•æƒé™ï¼ˆé‡è¦ï¼ï¼‰
chown -R mysql:mysql /var/lib/mysql
chmod -R 700 /var/lib/mysql

# è®¾ç½®æ—¥å¿—ç›®å½•æƒé™
chown -R mysql:mysql /var/log/mysql
chmod -R 755 /var/log/mysql

# è®¾ç½®é…ç½®æ–‡ä»¶æƒé™
chown root:mysql /etc/my.cnf
chmod 644 /etc/my.cnf
```

**æƒé™è¯´æ˜Ž**
- **700æƒé™**ï¼šåªæœ‰æ‰€æœ‰è€…èƒ½è¯»å†™æ‰§è¡Œï¼Œç”¨äºŽæ•°æ®ç›®å½•ä¿æŠ¤
- **755æƒé™**ï¼šæ‰€æœ‰è€…å¯è¯»å†™æ‰§è¡Œï¼Œå…¶ä»–äººåªèƒ½è¯»æ‰§è¡Œ
- **644æƒé™**ï¼šæ‰€æœ‰è€…å¯è¯»å†™ï¼Œå…¶ä»–äººåªèƒ½è¯»

---

## 5. âš™ï¸ é…ç½®æ–‡ä»¶ç®¡ç†


### 5.1 é…ç½®æ–‡ä»¶ä½ç½®æ ‡å‡†


MySQLé…ç½®æ–‡ä»¶çš„ä½ç½®æœ‰ä¼˜å…ˆçº§é¡ºåºï¼Œç³»ç»Ÿä¼šæŒ‰é¡ºåºæŸ¥æ‰¾å¹¶åº”ç”¨é…ç½®ã€‚

**é…ç½®æ–‡ä»¶æŸ¥æ‰¾é¡ºåº**
```
MySQLé…ç½®æ–‡ä»¶æŸ¥æ‰¾é¡ºåºï¼š
1. /etc/my.cnf              â† å…¨å±€é…ç½®ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
2. /etc/mysql/my.cnf        â† ç³»ç»Ÿçº§é…ç½®
3. /usr/local/mysql/my.cnf  â† å®‰è£…ç›®å½•é…ç½®
4. ~/.my.cnf                â† ç”¨æˆ·çº§é…ç½®
5. å‘½ä»¤è¡Œå‚æ•°                â† æœ€ç»ˆè¦†ç›–

æŸ¥çœ‹å½“å‰é…ç½®æ–‡ä»¶ä½ç½®ï¼š
mysql --help --verbose | grep -A 1 'Default options'
```

### 5.2 åŸºç¡€é…ç½®æ¨¡æ¿


**æ ‡å‡†my.cnfé…ç½®æ¨¡æ¿**
```ini
[client]
# å®¢æˆ·ç«¯é»˜è®¤è¿žæŽ¥å‚æ•°
port = 3306
socket = /var/lib/mysql/mysql.sock
default-character-set = utf8mb4

[mysql]
# mysqlå‘½ä»¤è¡Œå·¥å…·é…ç½®
default-character-set = utf8mb4

[mysqld]
# === åŸºç¡€é…ç½® ===
port = 3306
socket = /var/lib/mysql/mysql.sock
basedir = /usr/local/mysql
datadir = /var/lib/mysql
pid-file = /var/run/mysqld/mysqld.pid
user = mysql
bind-address = 0.0.0.0

# === å­—ç¬¦é›†é…ç½® ===
character-set-server = utf8mb4
collation-server = utf8mb4_unicode_ci

# === è¿žæŽ¥é…ç½® ===
max_connections = 1000          # æœ€å¤§è¿žæŽ¥æ•°
max_connect_errors = 1000       # æœ€å¤§è¿žæŽ¥é”™è¯¯æ•°

# === ç¼“å­˜é…ç½® ===
innodb_buffer_pool_size = 1G    # InnoDBç¼“å†²æ± å¤§å°
key_buffer_size = 256M          # MyISAMé”®ç¼“å­˜å¤§å°

# === æ—¥å¿—é…ç½® ===
log-error = /var/log/mysql/error.log
slow_query_log = 1
slow_query_log_file = /var/log/mysql/slow.log
long_query_time = 2
```

### 5.3 é…ç½®å‚æ•°è¯¦è§£


**å…³é”®å‚æ•°å«ä¹‰è¯´æ˜Ž**

```ini
# ä»€ä¹ˆæ˜¯å­—ç¬¦é›†ï¼Ÿ
# å°±æ˜¯æ–‡å­—ç¼–ç æ–¹å¼ï¼Œutf8mb4æ”¯æŒæ‰€æœ‰Unicodeå­—ç¬¦ï¼ŒåŒ…æ‹¬emoji
character-set-server = utf8mb4

# ä»€ä¹ˆæ˜¯ç¼“å†²æ± ï¼Ÿ  
# å°±æ˜¯å†…å­˜ä¸­çš„æ•°æ®ç¼“å­˜åŒºï¼Œè¶Šå¤§è¯»å†™è¶Šå¿«ï¼Œä¸€èˆ¬è®¾ä¸ºå†…å­˜çš„70-80%
innodb_buffer_pool_size = 1G

# ä»€ä¹ˆæ˜¯æ…¢æŸ¥è¯¢ï¼Ÿ
# æ‰§è¡Œæ—¶é—´è¶…è¿‡è®¾å®šå€¼çš„SQLè¯­å¥ï¼Œç”¨äºŽæ€§èƒ½ä¼˜åŒ–
long_query_time = 2

# ä»€ä¹ˆæ˜¯æœ€å¤§è¿žæŽ¥æ•°ï¼Ÿ
# åŒæ—¶è¿žæŽ¥åˆ°MySQLçš„å®¢æˆ·ç«¯æ•°é‡ä¸Šé™
max_connections = 1000
```

---

## 6. ðŸš€ æœåŠ¡å¯åŠ¨ä¸Žç®¡ç†


### 6.1 systemdæœåŠ¡é…ç½®


çŽ°ä»£Linuxç³»ç»Ÿä½¿ç”¨systemdç®¡ç†æœåŠ¡ï¼Œéœ€è¦åˆ›å»ºMySQLçš„æœåŠ¡æ–‡ä»¶ã€‚

**æœåŠ¡æ–‡ä»¶åˆ›å»º**
```bash
# åˆ›å»ºsystemdæœåŠ¡æ–‡ä»¶
cat > /etc/systemd/system/mysql.service << 'EOF'
[Unit]
Description=MySQL Server
Documentation=man:mysqld(8)
Documentation=http://dev.mysql.com/doc/refman/en/using-systemd.html
After=network.target
After=syslog.target

[Install]
WantedBy=multi-user.target

[Service]
User=mysql
Group=mysql
Type=notify
TimeoutSec=0
PermissionsStartOnly=true
ExecStartPre=/usr/local/mysql/bin/mysqld_safe_helper
ExecStart=/usr/local/mysql/bin/mysqld --defaults-file=/etc/my.cnf
ExecReload=/bin/kill -HUP $MAINPID
KillMode=process
Restart=on-failure
RestartPreventExitStatus=1
PrivateTmp=false
EOF
```

### 6.2 æœåŠ¡ç®¡ç†å‘½ä»¤


**å¸¸ç”¨æœåŠ¡æ“ä½œ**
```bash
# é‡æ–°åŠ è½½systemdé…ç½®
systemctl daemon-reload

# å¯åŠ¨MySQLæœåŠ¡
systemctl start mysql

# åœæ­¢MySQLæœåŠ¡
systemctl stop mysql

# é‡å¯MySQLæœåŠ¡
systemctl restart mysql

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
systemctl status mysql

# è®¾ç½®å¼€æœºè‡ªå¯åŠ¨
systemctl enable mysql

# å–æ¶ˆå¼€æœºè‡ªå¯åŠ¨
systemctl disable mysql

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
journalctl -u mysql -f
```

### 6.3 ç«¯å£åˆ†é…è§„èŒƒ


**æ ‡å‡†ç«¯å£é…ç½®**

| ç”¨é€” | é»˜è®¤ç«¯å£ | è¯´æ˜Ž |
|------|---------|------|
| **ä¸»åº“æœåŠ¡** | `3306` | `MySQLä¸»å®žä¾‹é»˜è®¤ç«¯å£` |
| **ä»Žåº“æœåŠ¡** | `3307` | `è¯»å†™åˆ†ç¦»ä»Žåº“ç«¯å£` |
| **æµ‹è¯•çŽ¯å¢ƒ** | `3308` | `å¼€å‘æµ‹è¯•çŽ¯å¢ƒç«¯å£` |
| **ç®¡ç†ç«¯å£** | `33060` | `MySQL X Protocolç«¯å£` |

**å¤šå®žä¾‹ç«¯å£è§„åˆ’**
```
ç”Ÿäº§çŽ¯å¢ƒç«¯å£è§„åˆ’ï¼š
ä¸»åº“å®žä¾‹ï¼š3306
ä»Žåº“å®žä¾‹ï¼š3307ã€3308ã€3309
æµ‹è¯•çŽ¯å¢ƒï¼š3310-3320
å¼€å‘çŽ¯å¢ƒï¼š3321-3330
```

---

## 7. ðŸ”’ å®‰å…¨åˆå§‹åŒ–é…ç½®


### 7.1 æ•°æ®åº“åˆå§‹åŒ–


å®‰è£…å®ŒæˆåŽéœ€è¦åˆå§‹åŒ–æ•°æ®åº“ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šåˆ›å»ºç³»ç»Ÿæ•°æ®åº“å’Œç®¡ç†å‘˜è´¦æˆ·ã€‚

**åˆå§‹åŒ–æµç¨‹**
```bash
# ç¬¬1æ­¥ï¼šåˆå§‹åŒ–æ•°æ®åº“
# è¿™ä¸ªå‘½ä»¤ä¼šåˆ›å»ºMySQLçš„ç³»ç»Ÿæ•°æ®åº“
/usr/local/mysql/bin/mysqld --initialize --user=mysql --datadir=/var/lib/mysql

# æ³¨æ„ï¼šåˆå§‹åŒ–ä¼šç”Ÿæˆä¸´æ—¶å¯†ç ï¼Œè®°å½•åœ¨é”™è¯¯æ—¥å¿—ä¸­
grep 'temporary password' /var/log/mysql/error.log

# ç¬¬2æ­¥ï¼šå¯åŠ¨MySQLæœåŠ¡
systemctl start mysql

# ç¬¬3æ­¥ï¼šä½¿ç”¨ä¸´æ—¶å¯†ç ç™»å½•
mysql -u root -p
# è¾“å…¥ä¸Šé¢æ‰¾åˆ°çš„ä¸´æ—¶å¯†ç 
```

### 7.2 å®‰å…¨é…ç½®è„šæœ¬


**è¿è¡Œå®‰å…¨é…ç½®å‘å¯¼**
```bash
# MySQLæä¾›äº†å®‰å…¨é…ç½®è„šæœ¬ï¼Œè‡ªåŠ¨å®Œæˆå®‰å…¨è®¾ç½®
/usr/local/mysql/bin/mysql_secure_installation

# è¯¥è„šæœ¬ä¼šè¿›è¡Œä»¥ä¸‹é…ç½®ï¼š
# 1. ä¿®æ”¹rootå¯†ç 
# 2. åˆ é™¤åŒ¿åç”¨æˆ·
# 3. ç¦æ­¢rootè¿œç¨‹ç™»å½•
# 4. åˆ é™¤testæ•°æ®åº“
# 5. é‡æ–°åŠ è½½æƒé™è¡¨
```

**æ‰‹åŠ¨å®‰å…¨é…ç½®**
```sql
-- è¿žæŽ¥åˆ°MySQLåŽæ‰§è¡Œä»¥ä¸‹å‘½ä»¤

-- 1. ä¿®æ”¹rootå¯†ç ï¼ˆå¼ºåˆ¶è¦æ±‚ï¼‰
ALTER USER 'root'@'localhost' IDENTIFIED BY 'NewStrongPassword123!';

-- 2. åˆ é™¤åŒ¿åç”¨æˆ·
DELETE FROM mysql.user WHERE User='';

-- 3. åˆ é™¤è¿œç¨‹rootç”¨æˆ·ï¼ˆæ ¹æ®éœ€è¦ï¼‰
DELETE FROM mysql.user WHERE User='root' AND Host NOT IN ('localhost', '127.0.0.1', '::1');

-- 4. åˆ é™¤testæ•°æ®åº“
DROP DATABASE IF EXISTS test;
DELETE FROM mysql.db WHERE Db='test' OR Db='test\\_%';

-- 5. é‡æ–°åŠ è½½æƒé™
FLUSH PRIVILEGES;
```

### 7.3 ç”¨æˆ·æƒé™ç®¡ç†


**åˆ›å»ºåº”ç”¨ç”¨æˆ·**
```sql
-- åˆ›å»ºä¸“ç”¨çš„åº”ç”¨æ•°æ®åº“ç”¨æˆ·ï¼ˆä¸ä½¿ç”¨rootï¼‰
-- è¿™æ ·æ›´å®‰å…¨ï¼Œç¬¦åˆæœ€å°æƒé™åŽŸåˆ™

-- åˆ›å»ºæ•°æ®åº“
CREATE DATABASE myapp DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- åˆ›å»ºåº”ç”¨ç”¨æˆ·
CREATE USER 'myapp_user'@'localhost' IDENTIFIED BY 'StrongPassword123!';

-- æŽˆäºˆæ•°æ®åº“æƒé™
GRANT ALL PRIVILEGES ON myapp.* TO 'myapp_user'@'localhost';

-- åˆ›å»ºåªè¯»ç”¨æˆ·ï¼ˆç”¨äºŽæ•°æ®åˆ†æžç­‰åœºæ™¯ï¼‰
CREATE USER 'myapp_readonly'@'%' IDENTIFIED BY 'ReadOnlyPassword123!';
GRANT SELECT ON myapp.* TO 'myapp_readonly'@'%';

-- åº”ç”¨æƒé™
FLUSH PRIVILEGES;
```

---

## 8. ðŸŒ çŽ¯å¢ƒå˜é‡ä¸Žè·¯å¾„


### 8.1 çŽ¯å¢ƒå˜é‡è®¾ç½®


**ç³»ç»ŸçŽ¯å¢ƒå˜é‡é…ç½®**
```bash
# ç¼–è¾‘ /etc/profile æ·»åŠ MySQLè·¯å¾„
cat >> /etc/profile << 'EOF'
# MySQL Environment Variables
export MYSQL_HOME=/usr/local/mysql
export PATH=$PATH:$MYSQL_HOME/bin
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$MYSQL_HOME/lib
EOF

# ç«‹å³ç”Ÿæ•ˆ
source /etc/profile

# éªŒè¯çŽ¯å¢ƒå˜é‡
echo $MYSQL_HOME
which mysql
mysql --version
```

### 8.2 å®¢æˆ·ç«¯é…ç½®


**ç”¨æˆ·çº§é…ç½®æ–‡ä»¶**
```bash
# ä¸ºæ–¹ä¾¿ä½¿ç”¨ï¼Œå¯ä»¥åˆ›å»ºç”¨æˆ·çº§é…ç½®æ–‡ä»¶
cat > ~/.my.cnf << 'EOF'
[client]
host = localhost
port = 3306
user = myapp_user
password = your_password
default-character-set = utf8mb4
EOF

# è®¾ç½®æ–‡ä»¶æƒé™ï¼ˆé‡è¦ï¼å¯†ç æ–‡ä»¶éœ€è¦ä¿æŠ¤ï¼‰
chmod 600 ~/.my.cnf
```

**è¿žæŽ¥æµ‹è¯•è„šæœ¬**
```bash
#!/bin/bash
# MySQLè¿žæŽ¥æµ‹è¯•è„šæœ¬

echo "=== MySQLè¿žæŽ¥æµ‹è¯• ==="

# æµ‹è¯•æœ¬åœ°è¿žæŽ¥
mysql -e "SELECT VERSION(), NOW();"

if [ $? -eq 0 ]; then
    echo "âœ… MySQLè¿žæŽ¥æˆåŠŸ"
    mysql -e "SHOW DATABASES;"
else
    echo "âŒ MySQLè¿žæŽ¥å¤±è´¥"
    exit 1
fi
```

---

## 9. âœ… å®‰è£…éªŒè¯ä¸Žæµ‹è¯•


### 9.1 å®‰è£…å®Œæ•´æ€§æ£€æŸ¥


**ç³»ç»Ÿçº§éªŒè¯**
```bash
# 1. æ£€æŸ¥MySQLè¿›ç¨‹
ps -ef | grep mysql

# 2. æ£€æŸ¥ç«¯å£ç›‘å¬
netstat -tuln | grep 3306
ss -tuln | grep 3306

# 3. æ£€æŸ¥æœåŠ¡çŠ¶æ€
systemctl status mysql

# 4. æ£€æŸ¥MySQLç‰ˆæœ¬
mysql --version
mysqladmin version
```

**æ•°æ®åº“è¿žæŽ¥æµ‹è¯•**
```bash
# åŸºæœ¬è¿žæŽ¥æµ‹è¯•
mysql -u root -p -e "SELECT 1;"

# æ•°æ®åº“åˆ—è¡¨
mysql -u root -p -e "SHOW DATABASES;"

# ç”¨æˆ·åˆ—è¡¨
mysql -u root -p -e "SELECT User, Host FROM mysql.user;"

# çŠ¶æ€ä¿¡æ¯
mysql -u root -p -e "SHOW STATUS LIKE 'Uptime';"
```

### 9.2 æ€§èƒ½åŸºå‡†æµ‹è¯•


**ä½¿ç”¨mysqlslapè¿›è¡ŒåŸºå‡†æµ‹è¯•**
```bash
# åŸºæœ¬æ€§èƒ½æµ‹è¯•
mysqlslap --defaults-file=/etc/my.cnf \
  --concurrency=10 \
  --iterations=3 \
  --number-int-cols=2 \
  --number-char-cols=3 \
  --auto-generate-sql

# è‡ªå®šä¹‰æŸ¥è¯¢æµ‹è¯•
mysqlslap --defaults-file=/etc/my.cnf \
  --query="SELECT * FROM mysql.user" \
  --concurrency=20 \
  --iterations=5
```

### 9.3 æ—¥å¿—æ£€æŸ¥


**é‡è¦æ—¥å¿—æ–‡ä»¶æ£€æŸ¥**
```bash
# é”™è¯¯æ—¥å¿—æ£€æŸ¥
tail -f /var/log/mysql/error.log

# æ£€æŸ¥å¯åŠ¨è¿‡ç¨‹
grep -i "ready for connections" /var/log/mysql/error.log

# æ£€æŸ¥è­¦å‘Šä¿¡æ¯
grep -i "warning" /var/log/mysql/error.log

# æ…¢æŸ¥è¯¢æ—¥å¿—
tail -f /var/log/mysql/slow.log
```

---

## 10. ðŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 éƒ¨ç½²è§„èŒƒæ£€æŸ¥æ¸…å•


```
ðŸ”¸ çŽ¯å¢ƒå‡†å¤‡æ£€æŸ¥æ¸…å•ï¼š
  âœ… ç¡¬ä»¶é…ç½®æ»¡è¶³è¦æ±‚
  âœ… æ“ä½œç³»ç»Ÿç‰ˆæœ¬å…¼å®¹
  âœ… ç³»ç»Ÿå‚æ•°å·²è°ƒä¼˜
  âœ… é˜²ç«å¢™ç«¯å£å·²å¼€æ”¾
  âœ… ä¾èµ–è½¯ä»¶å·²å®‰è£…

ðŸ”¸ å®‰è£…é…ç½®æ£€æŸ¥æ¸…å•ï¼š
  âœ… MySQLç‰ˆæœ¬é€‰æ‹©æ­£ç¡®
  âœ… å®‰è£…æ–¹å¼ç¬¦åˆçŽ¯å¢ƒè¦æ±‚
  âœ… ç›®å½•ç»“æž„è§„èŒƒæ¸…æ™°
  âœ… æƒé™è®¾ç½®å®‰å…¨åˆç†
  âœ… é…ç½®æ–‡ä»¶å®Œæ•´æœ‰æ•ˆ

ðŸ”¸ å®‰å…¨åˆå§‹åŒ–æ£€æŸ¥æ¸…å•ï¼š
  âœ… æ•°æ®åº“åˆå§‹åŒ–å®Œæˆ
  âœ… rootå¯†ç å·²ä¿®æ”¹
  âœ… åŒ¿åç”¨æˆ·å·²åˆ é™¤
  âœ… æµ‹è¯•æ•°æ®åº“å·²åˆ é™¤
  âœ… åº”ç”¨ç”¨æˆ·å·²åˆ›å»º
```

### 10.2 å…³é”®é…ç½®å‚æ•°


**å¿…é¡»è®¾ç½®çš„æ ¸å¿ƒå‚æ•°**
```ini
# å­—ç¬¦é›†é…ç½®ï¼ˆæ”¯æŒä¸­æ–‡å’Œemojiï¼‰
character-set-server = utf8mb4
collation-server = utf8mb4_unicode_ci

# å†…å­˜é…ç½®ï¼ˆæ ¹æ®æœåŠ¡å™¨å†…å­˜è°ƒæ•´ï¼‰
innodb_buffer_pool_size = 1G

# è¿žæŽ¥é…ç½®ï¼ˆæ ¹æ®åº”ç”¨éœ€æ±‚è°ƒæ•´ï¼‰
max_connections = 1000

# æ—¥å¿—é…ç½®ï¼ˆä¾¿äºŽé—®é¢˜æŽ’æŸ¥ï¼‰
log-error = /var/log/mysql/error.log
slow_query_log = 1
slow_query_log_file = /var/log/mysql/slow.log
```

### 10.3 å¸¸è§é—®é¢˜è§£å†³


**å¯åŠ¨å¤±è´¥æŽ’æŸ¥**
```bash
# 1. æ£€æŸ¥é”™è¯¯æ—¥å¿—
tail -20 /var/log/mysql/error.log

# 2. æ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•
mysqld --defaults-file=/etc/my.cnf --validate-config

# 3. æ£€æŸ¥ç«¯å£å ç”¨
netstat -tuln | grep 3306

# 4. æ£€æŸ¥æƒé™è®¾ç½®
ls -la /var/lib/mysql/
ls -la /etc/my.cnf
```

**è¿žæŽ¥è¢«æ‹’ç»è§£å†³**
```bash
# 1. æ£€æŸ¥é˜²ç«å¢™
firewall-cmd --list-ports

# 2. æ£€æŸ¥bind-addressé…ç½®
grep bind-address /etc/my.cnf

# 3. æ£€æŸ¥ç”¨æˆ·æƒé™
mysql -u root -p -e "SELECT User, Host FROM mysql.user;"
```

### 10.4 éƒ¨ç½²æ–‡æ¡£è¦æ±‚


**å¿…é¡»æ–‡æ¡£åŒ–çš„å†…å®¹**
- âœ… **æœåŠ¡å™¨é…ç½®æ¸…å•**ï¼šç¡¬ä»¶é…ç½®ã€OSç‰ˆæœ¬ã€IPåœ°å€
- âœ… **å®‰è£…å‚æ•°è®°å½•**ï¼šå®‰è£…è·¯å¾„ã€é…ç½®å‚æ•°ã€ç«¯å£ä¿¡æ¯
- âœ… **ç”¨æˆ·æƒé™æ–‡æ¡£**ï¼šæ•°æ®åº“ç”¨æˆ·ã€æƒé™åˆ†é…ã€å¯†ç ç­–ç•¥
- âœ… **å¤‡ä»½æ¢å¤æ–¹æ¡ˆ**ï¼šå¤‡ä»½ç­–ç•¥ã€æ¢å¤æ­¥éª¤ã€æµ‹è¯•è®°å½•
- âœ… **ç›‘æŽ§å‘Šè­¦é…ç½®**ï¼šç›‘æŽ§æŒ‡æ ‡ã€å‘Šè­¦é˜ˆå€¼ã€è”ç³»äººä¿¡æ¯
- âœ… **åº”æ€¥å¤„ç†æ‰‹å†Œ**ï¼šå¸¸è§æ•…éšœã€å¤„ç†æ­¥éª¤ã€è”ç³»æ–¹å¼

**æ ¸å¿ƒè®°å¿†**ï¼š
- MySQLéƒ¨ç½²è¦ç³»ç»ŸåŒ–ï¼Œä»ŽçŽ¯å¢ƒå‡†å¤‡åˆ°å®‰å…¨é…ç½®ä¸€ä¸ªä¸èƒ½å°‘
- é…ç½®æ–‡ä»¶æ˜¯æ ¸å¿ƒï¼Œå­—ç¬¦é›†ã€å†…å­˜ã€è¿žæŽ¥æ•°è¦é‡ç‚¹å…³æ³¨  
- å®‰å…¨åˆå§‹åŒ–æ˜¯å¿…é¡»ï¼Œrootå¯†ç ã€ç”¨æˆ·æƒé™ã€åŒ¿åè´¦æˆ·è¦å¤„ç†å¥½
- æ–‡æ¡£è®°å½•è¦å®Œæ•´ï¼Œä¾¿äºŽåŽæœŸè¿ç»´å’Œé—®é¢˜æŽ’æŸ¥