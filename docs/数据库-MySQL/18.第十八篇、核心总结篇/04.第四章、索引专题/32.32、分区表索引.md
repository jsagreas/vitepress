---
title: 32ã€åˆ†åŒºè¡¨ç´¢å¼•
---
## ðŸ“š ç›®å½•

1. [åˆ†åŒºè¡¨ç´¢å¼•åŸºç¡€æ¦‚å¿µ](#1-åˆ†åŒºè¡¨ç´¢å¼•åŸºç¡€æ¦‚å¿µ)
2. [æœ¬åœ°ç´¢å¼•ä¸Žå…¨å±€ç´¢å¼•](#2-æœ¬åœ°ç´¢å¼•ä¸Žå…¨å±€ç´¢å¼•)
3. [åˆ†åŒºé”®ç´¢å¼•ç­–ç•¥](#3-åˆ†åŒºé”®ç´¢å¼•ç­–ç•¥)
4. [åˆ†åŒºå‰ªè£ä¼˜åŒ–æœºåˆ¶](#4-åˆ†åŒºå‰ªè£ä¼˜åŒ–æœºåˆ¶)
5. [è·¨åˆ†åŒºæŸ¥è¯¢å¤„ç†](#5-è·¨åˆ†åŒºæŸ¥è¯¢å¤„ç†)
6. [åˆ†åŒºç´¢å¼•ç»´æŠ¤ä¸Žç›‘æŽ§](#6-åˆ†åŒºç´¢å¼•ç»´æŠ¤ä¸Žç›‘æŽ§)
7. [åˆ†åŒºç´¢å¼•è®¾è®¡æœ€ä½³å®žè·µ](#7-åˆ†åŒºç´¢å¼•è®¾è®¡æœ€ä½³å®žè·µ)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ðŸ“Š åˆ†åŒºè¡¨ç´¢å¼•åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯åˆ†åŒºè¡¨ç´¢å¼•


**ðŸ”¸ åˆ†åŒºè¡¨ç´¢å¼•çš„æœ¬è´¨**
åˆ†åŒºè¡¨ç´¢å¼•å°±æ˜¯å»ºç«‹åœ¨åˆ†åŒºè¡¨ä¸Šçš„ç´¢å¼•ã€‚æƒ³è±¡ä¸€ä¸‹å›¾ä¹¦é¦†æŠŠä¹¦åˆ†æˆäº†å¤šä¸ªåŒºåŸŸï¼ˆåˆ†åŒºï¼‰ï¼Œæ¯ä¸ªåŒºåŸŸéƒ½æœ‰è‡ªå·±çš„ç´¢å¼•å¡ç‰‡ï¼ˆæœ¬åœ°ç´¢å¼•ï¼‰ï¼Œè¿™æ ·æŸ¥æ‰¾ä¹¦ç±å°±æ›´é«˜æ•ˆäº†ã€‚

```
ðŸ’­ ç”Ÿæ´»ç±»æ¯”ï¼š
æ™®é€šè¡¨ = ä¸€ä¸ªå¤§ä¹¦åº“ï¼Œæ‰€æœ‰ä¹¦æ··åœ¨ä¸€èµ·
åˆ†åŒºè¡¨ = æŒ‰ä¸»é¢˜åˆ†æˆå¤šä¸ªå°ä¹¦åº“
åˆ†åŒºç´¢å¼• = æ¯ä¸ªå°ä¹¦åº“éƒ½æœ‰è‡ªå·±çš„ç›®å½•
```

**ðŸ”¸ ä¸ºä»€ä¹ˆéœ€è¦åˆ†åŒºè¡¨ç´¢å¼•**
```
è§£å†³çš„æ ¸å¿ƒé—®é¢˜ï¼š
â€¢ å¤§è¡¨æŸ¥è¯¢æ…¢ â†’ åˆ†åŒºåŽæ¯ä¸ªåˆ†åŒºæ•°æ®é‡å°ï¼ŒæŸ¥è¯¢æ›´å¿«
â€¢ ç´¢å¼•ç»´æŠ¤éš¾ â†’ åˆ†åŒºç´¢å¼•ç»´æŠ¤èŒƒå›´å°ï¼Œæ“ä½œæ›´å¿«
â€¢ å¹¶å‘è®¿é—®å†²çª â†’ ä¸åŒåˆ†åŒºå¯ä»¥å¹¶è¡Œå¤„ç†
â€¢ æ•°æ®ç®¡ç†å¤æ‚ â†’ æŒ‰åˆ†åŒºç®¡ç†æ•°æ®æ›´çµæ´»
```

### 1.2 åˆ†åŒºè¡¨ç´¢å¼•çš„å·¥ä½œåŽŸç†


**ðŸ”¸ åŸºæœ¬å·¥ä½œæµç¨‹**
```
æŸ¥è¯¢è¯·æ±‚ â†’ MySQLä¼˜åŒ–å™¨åˆ†æž â†’ ç¡®å®šéœ€è¦è®¿é—®çš„åˆ†åŒº â†’ åœ¨å¯¹åº”åˆ†åŒºä¸Šä½¿ç”¨ç´¢å¼• â†’ è¿”å›žç»“æžœ

å…·ä½“ä¾‹å­ï¼š
è¡¨ï¼šuser_log (æŒ‰æœˆåˆ†åŒº)
æŸ¥è¯¢ï¼šSELECT * FROM user_log WHERE log_date = '2024-03-15'

æµç¨‹ï¼š
1. åˆ†æžæŸ¥è¯¢æ¡ä»¶ä¸­çš„log_date
2. ç¡®å®šåªéœ€è¦è®¿é—®2024å¹´3æœˆçš„åˆ†åŒº
3. åœ¨è¯¥åˆ†åŒºçš„ç´¢å¼•ä¸­æŸ¥æ‰¾æ•°æ®
4. è¿”å›žç»“æžœï¼ˆå…¶ä»–11ä¸ªæœˆçš„åˆ†åŒºå®Œå…¨ä¸ç”¨è®¿é—®ï¼‰
```

**ðŸ“Š æ€§èƒ½æå‡ç¤ºä¾‹**
```
ä¼ ç»Ÿå¤§è¡¨æŸ¥è¯¢ï¼š
éœ€è¦æ‰«æ 1000ä¸‡æ¡è®°å½• â†’ è€—æ—¶ 5ç§’

åˆ†åŒºè¡¨æŸ¥è¯¢ï¼š
åªéœ€æ‰«æ 80ä¸‡æ¡è®°å½•ï¼ˆå½“æœˆæ•°æ®ï¼‰ â†’ è€—æ—¶ 0.4ç§’
æ€§èƒ½æå‡ï¼š12.5å€
```

---

## 2. ðŸ—ï¸ æœ¬åœ°ç´¢å¼•ä¸Žå…¨å±€ç´¢å¼•


### 2.1 æœ¬åœ°ç´¢å¼•è¯¦è§£


**ðŸ”¸ æœ¬åœ°ç´¢å¼•æ˜¯ä»€ä¹ˆ**
æœ¬åœ°ç´¢å¼•å°±æ˜¯æ¯ä¸ªåˆ†åŒºå†…éƒ¨ç‹¬ç«‹çš„ç´¢å¼•ï¼Œå°±åƒæ¯ä¸ªå°ä¹¦åº“éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„ç›®å½•ä¸€æ ·ã€‚

```
æœ¬åœ°ç´¢å¼•ç‰¹ç‚¹ï¼š
âœ… æ¯ä¸ªåˆ†åŒºæœ‰ç‹¬ç«‹çš„ç´¢å¼•æ–‡ä»¶
âœ… ç´¢å¼•åªåŒ…å«å½“å‰åˆ†åŒºçš„æ•°æ®
âœ… ç»´æŠ¤ç®€å•ï¼Œåªå½±å“å•ä¸ªåˆ†åŒº
âœ… å¹¶è¡Œå¤„ç†èƒ½åŠ›å¼º
```

**ðŸ’¡ æœ¬åœ°ç´¢å¼•ç¤ºä¾‹**
```sql
-- åˆ›å»ºæŒ‰æœˆåˆ†åŒºçš„è®¢å•è¡¨
CREATE TABLE orders (
    id INT PRIMARY KEY,
    order_date DATE,
    user_id INT,
    amount DECIMAL(10,2),
    INDEX idx_user_id (user_id),    -- æœ¬åœ°ç´¢å¼•
    INDEX idx_amount (amount)       -- æœ¬åœ°ç´¢å¼•
) PARTITION BY RANGE (YEAR(order_date) * 100 + MONTH(order_date)) (
    PARTITION p202401 VALUES LESS THAN (202402),
    PARTITION p202402 VALUES LESS THAN (202403),
    PARTITION p202403 VALUES LESS THAN (202404)
);

-- æ¯ä¸ªåˆ†åŒºéƒ½æœ‰ç‹¬ç«‹çš„ç´¢å¼•ï¼š
-- p202401åˆ†åŒºï¼šidx_user_id_p202401, idx_amount_p202401
-- p202402åˆ†åŒºï¼šidx_user_id_p202402, idx_amount_p202402
-- p202403åˆ†åŒºï¼šidx_user_id_p202403, idx_amount_p202403
```

### 2.2 å…¨å±€ç´¢å¼•æ¦‚å¿µ


**ðŸ”¸ å…¨å±€ç´¢å¼•æ˜¯ä»€ä¹ˆ**
å…¨å±€ç´¢å¼•æ˜¯è·¨è¶Šæ‰€æœ‰åˆ†åŒºçš„ç»Ÿä¸€ç´¢å¼•ï¼Œå°±åƒå›¾ä¹¦é¦†æœ‰ä¸€ä¸ªæ€»ç›®å½•ï¼Œå¯ä»¥æŸ¥åˆ°ä»»ä½•åŒºåŸŸçš„ä¹¦ç±ä½ç½®ã€‚

> **âš ï¸ é‡è¦æé†’**ï¼šMySQLç›®å‰**ä¸æ”¯æŒçœŸæ­£çš„å…¨å±€ç´¢å¼•**ï¼Œä½†æˆ‘ä»¬éœ€è¦ç†è§£è¿™ä¸ªæ¦‚å¿µï¼Œå› ä¸ºå…¶ä»–æ•°æ®åº“ç³»ç»Ÿï¼ˆå¦‚Oracleï¼‰æœ‰è¿™ä¸ªåŠŸèƒ½ã€‚

```
å…¨å±€ç´¢å¼•ç‰¹ç‚¹ï¼ˆç†è®ºä¸Šï¼‰ï¼š
â€¢ ç´¢å¼•è·¨è¶Šæ‰€æœ‰åˆ†åŒº
â€¢ å¯ä»¥å¿«é€Ÿå®šä½æ•°æ®åœ¨å“ªä¸ªåˆ†åŒº
â€¢ ç»´æŠ¤å¤æ‚ï¼Œæ›´æ–°æˆæœ¬é«˜
â€¢ é€‚åˆè·¨åˆ†åŒºçš„å”¯ä¸€æ€§çº¦æŸ
```

**ðŸ”¸ MySQLçš„è§£å†³æ–¹æ¡ˆ**
```
MySQLé€šè¿‡ä»¥ä¸‹æ–¹å¼æ¨¡æ‹Ÿå…¨å±€ç´¢å¼•æ•ˆæžœï¼š

1. åˆ†åŒºé”®å¿…é¡»åŒ…å«åœ¨ä¸»é”®ä¸­
CREATE TABLE user_log (
    id INT,
    user_id INT,
    log_date DATE,
    PRIMARY KEY (id, log_date)  -- å¿…é¡»åŒ…å«åˆ†åŒºé”®log_date
) PARTITION BY RANGE (YEAR(log_date));

2. åº”ç”¨å±‚å¤„ç†è·¨åˆ†åŒºæŸ¥è¯¢
-- éœ€è¦æŸ¥è¯¢å¤šä¸ªåˆ†åŒºæ—¶ï¼Œåº”ç”¨å±‚åˆå¹¶ç»“æžœ
```

### 2.3 æœ¬åœ°ç´¢å¼• vs å…¨å±€ç´¢å¼•å¯¹æ¯”


| ç‰¹æ€§ | **æœ¬åœ°ç´¢å¼•** | **å…¨å±€ç´¢å¼•ï¼ˆç†è®ºï¼‰** |
|------|-------------|-------------------|
| ðŸŽ¯ **ç´¢å¼•èŒƒå›´** | `å•ä¸ªåˆ†åŒºå†…` | `è·¨è¶Šæ‰€æœ‰åˆ†åŒº` |
| âš¡ **æŸ¥è¯¢æ€§èƒ½** | `åˆ†åŒºå†…æŸ¥è¯¢å¿«` | `è·¨åˆ†åŒºæŸ¥è¯¢å¿«` |
| ðŸ”§ **ç»´æŠ¤å¤æ‚åº¦** | `ç®€å•ï¼Œç‹¬ç«‹ç»´æŠ¤` | `å¤æ‚ï¼Œéœ€è¦åŒæ­¥` |
| ðŸ’¾ **å­˜å‚¨å¼€é”€** | `è¾ƒå°` | `è¾ƒå¤§` |
| ðŸƒ **å¹¶å‘å¤„ç†** | `ä¼˜ç§€` | `ä¸€èˆ¬` |
| ðŸ“Š **MySQLæ”¯æŒ** | `âœ… å®Œå…¨æ”¯æŒ` | `âŒ ä¸æ”¯æŒ` |

---

## 3. ðŸ”‘ åˆ†åŒºé”®ç´¢å¼•ç­–ç•¥


### 3.1 åˆ†åŒºé”®ç´¢å¼•çš„é‡è¦æ€§


**ðŸ”¸ åˆ†åŒºé”®æ˜¯ä»€ä¹ˆ**
åˆ†åŒºé”®å°±æ˜¯å†³å®šæ•°æ®å­˜æ”¾åœ¨å“ªä¸ªåˆ†åŒºçš„å­—æ®µï¼Œå°±åƒé‚®æ”¿ç¼–ç å†³å®šé‚®ä»¶é€åˆ°å“ªä¸ªé‚®å±€ä¸€æ ·ã€‚

```
ðŸ’­ ç”Ÿæ´»ç±»æ¯”ï¼š
åˆ†åŒºé”® = é‚®æ”¿ç¼–ç 
æ•°æ®è®°å½• = é‚®ä»¶
åˆ†åŒº = ä¸åŒåœ°åŒºçš„é‚®å±€
æœ‰äº†é‚®æ”¿ç¼–ç ï¼Œé‚®ä»¶å°±èƒ½å‡†ç¡®é€åˆ°å¯¹åº”é‚®å±€
```

**ðŸ”¸ åˆ†åŒºé”®ç´¢å¼•çš„ä½œç”¨**
```
æ ¸å¿ƒä½œç”¨ï¼š
1. å¿«é€Ÿç¡®å®šæ•°æ®åœ¨å“ªä¸ªåˆ†åŒº â†’ åˆ†åŒºå‰ªè£
2. é¿å…å…¨è¡¨æ‰«æ â†’ åªæ‰«æç›¸å…³åˆ†åŒº
3. æé«˜æŸ¥è¯¢æ•ˆçŽ‡ â†’ å‡å°‘æ•°æ®è®¿é—®é‡
4. æ”¯æŒåˆ†åŒºç®¡ç†æ“ä½œ â†’ å¿«é€Ÿå®šä½åˆ†åŒº
```

### 3.2 åˆ†åŒºé”®ç´¢å¼•è®¾è®¡ç­–ç•¥


**ðŸ”¸ å•åˆ—åˆ†åŒºé”®ç´¢å¼•**
```sql
-- æŒ‰æ—¥æœŸåˆ†åŒºï¼ˆæœ€å¸¸è§ï¼‰
CREATE TABLE sales_data (
    id INT AUTO_INCREMENT,
    sale_date DATE,
    product_id INT,
    amount DECIMAL(10,2),
    PRIMARY KEY (id, sale_date),           -- ä¸»é”®åŒ…å«åˆ†åŒºé”®
    INDEX idx_sale_date (sale_date),       -- åˆ†åŒºé”®ä¸“ç”¨ç´¢å¼•
    INDEX idx_product_date (product_id, sale_date)  -- å¤åˆç´¢å¼•
) PARTITION BY RANGE (YEAR(sale_date)) (
    PARTITION p2023 VALUES LESS THAN (2024),
    PARTITION p2024 VALUES LESS THAN (2025)
);

-- æŸ¥è¯¢ç¤ºä¾‹ï¼šèƒ½å¤Ÿå®žçŽ°åˆ†åŒºå‰ªè£
SELECT * FROM sales_data 
WHERE sale_date BETWEEN '2024-01-01' AND '2024-03-31';
-- åªè®¿é—®p2024åˆ†åŒº
```

**ðŸ”¸ å¤åˆåˆ†åŒºé”®ç´¢å¼•**
```sql
-- æŒ‰åœ°åŒºå’Œæ—¶é—´åˆ†åŒº
CREATE TABLE user_behavior (
    id INT,
    region_id INT,
    log_date DATE,
    user_id INT,
    action VARCHAR(50),
    PRIMARY KEY (id, region_id, log_date),
    INDEX idx_region_date (region_id, log_date),  -- å¤åˆåˆ†åŒºé”®ç´¢å¼•
    INDEX idx_user_region_date (user_id, region_id, log_date)
) PARTITION BY RANGE (region_id * 10000 + YEAR(log_date)) (
    PARTITION p_north_2024 VALUES LESS THAN (10024),
    PARTITION p_south_2024 VALUES LESS THAN (20024)
);
```

### 3.3 åˆ†åŒºé”®ç´¢å¼•çš„æ€§èƒ½ä¼˜åŒ–


**ðŸ“Š ç´¢å¼•é€‰æ‹©æ€§åˆ†æž**
```sql
-- æ£€æŸ¥åˆ†åŒºé”®çš„é€‰æ‹©æ€§
SELECT 
    sale_date,
    COUNT(*) as record_count,
    COUNT(*) * 100.0 / (SELECT COUNT(*) FROM sales_data) as percentage
FROM sales_data 
GROUP BY sale_date 
ORDER BY record_count DESC 
LIMIT 10;

-- ç†æƒ³çš„åˆ†åŒºé”®ç‰¹å¾ï¼š
-- âœ… æ•°æ®åˆ†å¸ƒå‡åŒ€ï¼ˆæ¯ä¸ªåˆ†åŒºæ•°æ®é‡ç›¸è¿‘ï¼‰
-- âœ… æŸ¥è¯¢ç»å¸¸ä½¿ç”¨ï¼ˆå¤§éƒ¨åˆ†æŸ¥è¯¢åŒ…å«åˆ†åŒºé”®ï¼‰
-- âœ… é€‰æ‹©æ€§å¥½ï¼ˆèƒ½æœ‰æ•ˆç¼©å°æŸ¥è¯¢èŒƒå›´ï¼‰
```

**ðŸŽ¯ åˆ†åŒºé”®ç´¢å¼•ä¼˜åŒ–æŠ€å·§**
```sql
-- 1. å‰ç¼€ç´¢å¼•ä¼˜åŒ–ï¼ˆå¯¹äºŽå­—ç¬¦ä¸²åˆ†åŒºé”®ï¼‰
CREATE TABLE log_data (
    id INT,
    log_time DATETIME,
    log_level VARCHAR(20),
    message TEXT,
    INDEX idx_level_prefix (log_level(5), log_time)  -- å‰ç¼€ç´¢å¼•
) PARTITION BY HASH(CRC32(log_level));

-- 2. å‡½æ•°ç´¢å¼•æ¨¡æ‹Ÿï¼ˆMySQL 8.0+ï¼‰
CREATE TABLE events (
    id INT,
    event_time TIMESTAMP,
    event_type VARCHAR(50),
    INDEX idx_month ((YEAR(event_time) * 100 + MONTH(event_time)))
) PARTITION BY RANGE (YEAR(event_time) * 100 + MONTH(event_time));
```

---

## 4. âœ‚ï¸ åˆ†åŒºå‰ªè£ä¼˜åŒ–æœºåˆ¶


### 4.1 åˆ†åŒºå‰ªè£æ˜¯ä»€ä¹ˆ


**ðŸ”¸ åˆ†åŒºå‰ªè£çš„æ¦‚å¿µ**
åˆ†åŒºå‰ªè£å°±æ˜¯MySQLä¼˜åŒ–å™¨æ™ºèƒ½åœ°åˆ¤æ–­æŸ¥è¯¢åªéœ€è¦è®¿é—®å“ªäº›åˆ†åŒºï¼Œè€Œä¸æ˜¯å‚»å‚»åœ°æ‰«ææ‰€æœ‰åˆ†åŒºã€‚

```
ðŸ’­ ç”Ÿæ´»ç±»æ¯”ï¼š
ä½ è¦æ‰¾2024å¹´3æœˆçš„é”€å”®è®°å½•
æ™®é€šåšæ³•ï¼šç¿»éæ‰€æœ‰æœˆä»½çš„æ–‡ä»¶å¤¹
åˆ†åŒºå‰ªè£ï¼šç›´æŽ¥æ‰¾åˆ°2024å¹´3æœˆçš„æ–‡ä»¶å¤¹ï¼Œå…¶ä»–çš„çœ‹éƒ½ä¸çœ‹
```

**ðŸ”¸ åˆ†åŒºå‰ªè£çš„å·¥ä½œåŽŸç†**
```
åˆ†åŒºå‰ªè£æµç¨‹ï¼š
SQLæŸ¥è¯¢ â†’ ä¼˜åŒ–å™¨åˆ†æžWHEREæ¡ä»¶ â†’ ç¡®å®šæ¶‰åŠçš„åˆ†åŒºèŒƒå›´ â†’ ç”Ÿæˆæ‰§è¡Œè®¡åˆ’ â†’ åªè®¿é—®å¿…è¦çš„åˆ†åŒº

å…³é”®è¦ç´ ï¼š
1. æŸ¥è¯¢æ¡ä»¶å¿…é¡»åŒ…å«åˆ†åŒºé”®
2. æ¡ä»¶å¿…é¡»æ˜¯å¸¸é‡æˆ–å¯è®¡ç®—çš„è¡¨è¾¾å¼
3. ä¼˜åŒ–å™¨èƒ½å¤ŸæŽ¨æ–­å‡ºåˆ†åŒºèŒƒå›´
```

### 4.2 åˆ†åŒºå‰ªè£çš„å®žçŽ°æ¡ä»¶


**ðŸ”¸ èƒ½å¤Ÿå®žçŽ°åˆ†åŒºå‰ªè£çš„æŸ¥è¯¢**
```sql
-- âœ… èƒ½å®žçŽ°åˆ†åŒºå‰ªè£çš„æŸ¥è¯¢ç¤ºä¾‹
-- 1. ç­‰å€¼æŸ¥è¯¢
SELECT * FROM orders WHERE order_date = '2024-03-15';

-- 2. èŒƒå›´æŸ¥è¯¢
SELECT * FROM orders WHERE order_date BETWEEN '2024-01-01' AND '2024-03-31';

-- 3. INæŸ¥è¯¢
SELECT * FROM orders WHERE order_date IN ('2024-01-01', '2024-02-01');

-- 4. å‡½æ•°æŸ¥è¯¢ï¼ˆå¦‚æžœåˆ†åŒºå‡½æ•°åŒ¹é…ï¼‰
SELECT * FROM orders WHERE YEAR(order_date) = 2024;

-- æ£€æŸ¥æ˜¯å¦å®žçŽ°äº†åˆ†åŒºå‰ªè£
EXPLAIN PARTITIONS 
SELECT * FROM orders WHERE order_date = '2024-03-15';
-- æŸ¥çœ‹partitionsåˆ—ï¼Œåº”è¯¥åªæ˜¾ç¤ºç›¸å…³åˆ†åŒº
```

**ðŸ”¸ æ— æ³•å®žçŽ°åˆ†åŒºå‰ªè£çš„æŸ¥è¯¢**
```sql
-- âŒ æ— æ³•å®žçŽ°åˆ†åŒºå‰ªè£çš„æŸ¥è¯¢
-- 1. ä¸åŒ…å«åˆ†åŒºé”®
SELECT * FROM orders WHERE user_id = 1001;  -- éœ€è¦æ‰«ææ‰€æœ‰åˆ†åŒº

-- 2. åˆ†åŒºé”®ä½¿ç”¨äº†ä¸å…¼å®¹çš„å‡½æ•°
SELECT * FROM orders WHERE DATE_FORMAT(order_date, '%Y-%m') = '2024-03';

-- 3. åŠ¨æ€æ¡ä»¶ï¼ˆæ— æ³•åœ¨ä¼˜åŒ–é˜¶æ®µç¡®å®šï¼‰
SELECT * FROM orders WHERE order_date > @dynamic_date;

-- 4. å¤æ‚çš„è¡¨è¾¾å¼
SELECT * FROM orders WHERE order_date + INTERVAL 1 DAY = '2024-03-16';
```

### 4.3 åˆ†åŒºå‰ªè£æ€§èƒ½ç›‘æŽ§


**ðŸ“Š åˆ†åŒºå‰ªè£æ•ˆæžœæ£€æŸ¥**
```sql
-- æŸ¥çœ‹åˆ†åŒºå‰ªè£æƒ…å†µ
EXPLAIN PARTITIONS 
SELECT * FROM orders 
WHERE order_date BETWEEN '2024-01-01' AND '2024-01-31';

-- è¾“å‡ºç¤ºä¾‹ï¼š
-- partitions: p202401  â† åªè®¿é—®ä¸€ä¸ªåˆ†åŒºï¼Œå‰ªè£æˆåŠŸ
-- å¦‚æžœæ˜¾ç¤º p202401,p202402,p202403... è¡¨ç¤ºå‰ªè£å¤±è´¥

-- æŸ¥çœ‹æ‰§è¡Œç»Ÿè®¡
SHOW SESSION STATUS LIKE 'Handler_read%';
-- Handler_read_next: ç´¢å¼•æ‰«ææ¬¡æ•°
-- Handler_read_key: ç´¢å¼•æŸ¥æ‰¾æ¬¡æ•°
```

**ðŸ” åˆ†åŒºå‰ªè£ä¼˜åŒ–å»ºè®®**
```sql
-- 1. ä¼˜åŒ–æŸ¥è¯¢æ¡ä»¶å†™æ³•
-- ä¸å¥½çš„å†™æ³•
WHERE DATE_FORMAT(order_date, '%Y-%m') = '2024-01'

-- å¥½çš„å†™æ³•  
WHERE order_date >= '2024-01-01' AND order_date < '2024-02-01'

-- 2. ä½¿ç”¨è¦†ç›–ç´¢å¼•å‡å°‘å›žè¡¨
CREATE INDEX idx_cover ON orders (order_date, user_id, amount);
SELECT user_id, amount FROM orders WHERE order_date = '2024-01-01';

-- 3. æ‰¹é‡æŸ¥è¯¢ä¼˜åŒ–
-- ä¸å¥½ï¼šå¤šæ¬¡å•æ¡æŸ¥è¯¢
SELECT * FROM orders WHERE order_date = '2024-01-01';
SELECT * FROM orders WHERE order_date = '2024-01-02';

-- å¥½ï¼šä¸€æ¬¡èŒƒå›´æŸ¥è¯¢
SELECT * FROM orders WHERE order_date BETWEEN '2024-01-01' AND '2024-01-02';
```

---

## 5. ðŸ”€ è·¨åˆ†åŒºæŸ¥è¯¢å¤„ç†


### 5.1 è·¨åˆ†åŒºæŸ¥è¯¢çš„æŒ‘æˆ˜


**ðŸ”¸ ä»€ä¹ˆæ˜¯è·¨åˆ†åŒºæŸ¥è¯¢**
è·¨åˆ†åŒºæŸ¥è¯¢å°±æ˜¯éœ€è¦ä»Žå¤šä¸ªåˆ†åŒºèŽ·å–æ•°æ®çš„æŸ¥è¯¢ï¼Œå°±åƒè¦ä»Žå›¾ä¹¦é¦†çš„å¤šä¸ªåŒºåŸŸæ‰¾ä¹¦ä¸€æ ·ã€‚

```
è·¨åˆ†åŒºæŸ¥è¯¢çš„å¸¸è§åœºæ™¯ï¼š
â€¢ ä¸åŒ…å«åˆ†åŒºé”®çš„æŸ¥è¯¢
â€¢ å¤§èŒƒå›´çš„æ—¶é—´æŸ¥è¯¢
â€¢ èšåˆç»Ÿè®¡æŸ¥è¯¢
â€¢ JOINæ“ä½œæ¶‰åŠå¤šä¸ªåˆ†åŒºè¡¨
```

**ðŸ”¸ è·¨åˆ†åŒºæŸ¥è¯¢çš„æ€§èƒ½é—®é¢˜**
```
æ€§èƒ½æŒ‘æˆ˜ï¼š
1. éœ€è¦è®¿é—®å¤šä¸ªåˆ†åŒº â†’ å¢žåŠ I/Oå¼€é”€
2. ç»“æžœéœ€è¦åˆå¹¶æŽ’åº â†’ å¢žåŠ CPUå¼€é”€  
3. æ— æ³•åˆ©ç”¨åˆ†åŒºå‰ªè£ â†’ å¤±åŽ»åˆ†åŒºä¼˜åŠ¿
4. é”ç«žäº‰å¢žåŠ  â†’ å½±å“å¹¶å‘æ€§èƒ½
```

### 5.2 è·¨åˆ†åŒºæŸ¥è¯¢ä¼˜åŒ–ç­–ç•¥


**ðŸ”¸ æŸ¥è¯¢é‡å†™ä¼˜åŒ–**
```sql
-- åŽŸå§‹æŸ¥è¯¢ï¼ˆè·¨åˆ†åŒºï¼‰
SELECT * FROM orders WHERE user_id = 1001;

-- ä¼˜åŒ–æ–¹æ¡ˆ1ï¼šå¦‚æžœçŸ¥é“ç”¨æˆ·çš„æ—¶é—´èŒƒå›´ï¼ŒåŠ ä¸Šåˆ†åŒºé”®
SELECT * FROM orders 
WHERE user_id = 1001 
  AND order_date >= '2024-01-01';  -- æ·»åŠ åˆ†åŒºé”®æ¡ä»¶

-- ä¼˜åŒ–æ–¹æ¡ˆ2ï¼šåº”ç”¨å±‚åˆ†æ‰¹æŸ¥è¯¢
-- åœ¨åº”ç”¨ä»£ç ä¸­åˆ†æœˆæŸ¥è¯¢ï¼Œç„¶åŽåˆå¹¶ç»“æžœ
SELECT * FROM orders WHERE user_id = 1001 AND order_date >= '2024-01-01' AND order_date < '2024-02-01';
SELECT * FROM orders WHERE user_id = 1001 AND order_date >= '2024-02-01' AND order_date < '2024-03-01';
-- ...åˆå¹¶ç»“æžœ
```

**ðŸ”¸ ç´¢å¼•ä¼˜åŒ–ç­–ç•¥**
```sql
-- ä¸ºè·¨åˆ†åŒºæŸ¥è¯¢åˆ›å»ºåˆé€‚çš„ç´¢å¼•
-- æ¯ä¸ªåˆ†åŒºéƒ½æœ‰ç›¸åŒçš„ç´¢å¼•ç»“æž„
CREATE INDEX idx_user_status ON orders (user_id, order_status, order_date);

-- æŸ¥è¯¢æ—¶èƒ½åœ¨æ¯ä¸ªåˆ†åŒºå†…å¿«é€Ÿå®šä½
SELECT * FROM orders 
WHERE user_id = 1001 AND order_status = 'completed';
-- è™½ç„¶æ˜¯è·¨åˆ†åŒºï¼Œä½†æ¯ä¸ªåˆ†åŒºå†…çš„æŸ¥è¯¢å¾ˆå¿«
```

### 5.3 è·¨åˆ†åŒºJOINä¼˜åŒ–


**ðŸ”¸ åˆ†åŒºè¡¨ä¸Žæ™®é€šè¡¨JOIN**
```sql
-- ä¼˜åŒ–å‰ï¼šæ•ˆçŽ‡ä½Ž
SELECT o.*, u.username 
FROM orders o 
JOIN users u ON o.user_id = u.id 
WHERE u.region = 'north';

-- ä¼˜åŒ–åŽï¼šå…ˆè¿‡æ»¤å†JOIN
SELECT o.*, u.username 
FROM orders o 
JOIN (
    SELECT id, username 
    FROM users 
    WHERE region = 'north'
) u ON o.user_id = u.id 
WHERE o.order_date >= '2024-01-01';  -- æ·»åŠ åˆ†åŒºé”®æ¡ä»¶
```

**ðŸ”¸ ä¸¤ä¸ªåˆ†åŒºè¡¨JOIN**
```sql
-- æœ€ä½³å®žè·µï¼šä¸¤ä¸ªè¡¨ä½¿ç”¨ç›¸åŒçš„åˆ†åŒºç­–ç•¥
CREATE TABLE orders (
    order_id INT,
    user_id INT, 
    order_date DATE,
    ...
) PARTITION BY RANGE (YEAR(order_date));

CREATE TABLE order_items (
    item_id INT,
    order_id INT,
    order_date DATE,  -- ç›¸åŒçš„åˆ†åŒºé”®
    ...
) PARTITION BY RANGE (YEAR(order_date));  -- ç›¸åŒçš„åˆ†åŒºæ–¹å¼

-- è¿™æ ·JOINæ—¶å¯ä»¥åˆ†åŒºå¯¹åˆ†åŒºè¿›è¡Œï¼Œæ•ˆçŽ‡æ›´é«˜
SELECT o.*, i.product_name 
FROM orders o 
JOIN order_items i ON o.order_id = i.order_id 
WHERE o.order_date = '2024-03-15';  -- åªåœ¨å¯¹åº”åˆ†åŒºä¸­JOIN
```

---

## 6. ðŸ”§ åˆ†åŒºç´¢å¼•ç»´æŠ¤ä¸Žç›‘æŽ§


### 6.1 åˆ†åŒºç´¢å¼•ç»´æŠ¤æ“ä½œ


**ðŸ”¸ åˆ†åŒºç´¢å¼•çš„æ—¥å¸¸ç»´æŠ¤**
åˆ†åŒºç´¢å¼•ç»´æŠ¤å°±åƒä¿å…»æ±½è½¦ä¸€æ ·ï¼Œå®šæœŸæ£€æŸ¥å’Œç»´æŠ¤æ‰èƒ½ä¿æŒæœ€ä½³æ€§èƒ½ã€‚

```sql
-- 1. æŸ¥çœ‹åˆ†åŒºç´¢å¼•ä¿¡æ¯
SELECT 
    TABLE_SCHEMA,
    TABLE_NAME,
    PARTITION_NAME,
    INDEX_NAME,
    CARDINALITY,
    SUB_PART
FROM INFORMATION_SCHEMA.STATISTICS 
WHERE TABLE_NAME = 'orders' 
ORDER BY PARTITION_NAME, INDEX_NAME;

-- 2. åˆ†æžåˆ†åŒºç´¢å¼•ç»Ÿè®¡ä¿¡æ¯
ANALYZE TABLE orders;  -- æ›´æ–°æ‰€æœ‰åˆ†åŒºçš„ç´¢å¼•ç»Ÿè®¡ä¿¡æ¯

-- 3. é‡å»ºåˆ†åŒºç´¢å¼•ï¼ˆå½“ç´¢å¼•ç¢Žç‰‡åŒ–ä¸¥é‡æ—¶ï¼‰
ALTER TABLE orders REBUILD PARTITION p202401;  -- é‡å»ºç‰¹å®šåˆ†åŒº
```

**ðŸ”¸ åˆ†åŒºç®¡ç†æ“ä½œå¯¹ç´¢å¼•çš„å½±å“**
```sql
-- 1. æ·»åŠ æ–°åˆ†åŒºï¼ˆç´¢å¼•ä¼šè‡ªåŠ¨åˆ›å»ºï¼‰
ALTER TABLE orders 
ADD PARTITION (PARTITION p202405 VALUES LESS THAN (202406));

-- 2. åˆ é™¤åˆ†åŒºï¼ˆç´¢å¼•ä¼šè‡ªåŠ¨åˆ é™¤ï¼‰
ALTER TABLE orders DROP PARTITION p202301;

-- 3. åˆ†åŒºåˆå¹¶ï¼ˆç´¢å¼•éœ€è¦é‡å»ºï¼‰
ALTER TABLE orders 
REORGANIZE PARTITION p202401, p202402 
INTO (PARTITION p2024_q1 VALUES LESS THAN (202403));

-- 4. åˆ†åŒºæ‹†åˆ†ï¼ˆç´¢å¼•ä¼šè‡ªåŠ¨å¤„ç†ï¼‰
ALTER TABLE orders 
REORGANIZE PARTITION p2024_q1 
INTO (
    PARTITION p202401 VALUES LESS THAN (202402),
    PARTITION p202402 VALUES LESS THAN (202403)
);
```

### 6.2 åˆ†åŒºç´¢å¼•æ€§èƒ½ç›‘æŽ§


**ðŸ“Š ç›‘æŽ§å…³é”®æŒ‡æ ‡**
```sql
-- 1. æŸ¥çœ‹åˆ†åŒºå¤§å°å’Œè¡Œæ•°
SELECT 
    PARTITION_NAME,
    TABLE_ROWS,
    DATA_LENGTH / 1024 / 1024 as DATA_SIZE_MB,
    INDEX_LENGTH / 1024 / 1024 as INDEX_SIZE_MB
FROM INFORMATION_SCHEMA.PARTITIONS 
WHERE TABLE_NAME = 'orders'
ORDER BY PARTITION_ORDINAL_POSITION;

-- 2. ç›‘æŽ§åˆ†åŒºæŸ¥è¯¢æ€§èƒ½
-- å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå…³æ³¨è·¨åˆ†åŒºæŸ¥è¯¢
SET GLOBAL slow_query_log = 1;
SET GLOBAL long_query_time = 1;

-- 3. æŸ¥çœ‹åˆ†åŒºå‰ªè£ç»Ÿè®¡
SHOW SESSION STATUS LIKE 'Com_select';
SHOW SESSION STATUS LIKE 'Handler_read%';
```

**ðŸ” æ€§èƒ½é—®é¢˜è¯Šæ–­**
```sql
-- æ£€æŸ¥æ˜¯å¦å­˜åœ¨çƒ­ç‚¹åˆ†åŒº
SELECT 
    PARTITION_NAME,
    TABLE_ROWS,
    CASE 
        WHEN TABLE_ROWS > (
            SELECT AVG(TABLE_ROWS) * 2 
            FROM INFORMATION_SCHEMA.PARTITIONS 
            WHERE TABLE_NAME = 'orders'
        ) THEN 'HOT_PARTITION'
        ELSE 'NORMAL'
    END as PARTITION_STATUS
FROM INFORMATION_SCHEMA.PARTITIONS 
WHERE TABLE_NAME = 'orders';

-- æ£€æŸ¥ç´¢å¼•ä½¿ç”¨æƒ…å†µ
SELECT 
    OBJECT_SCHEMA,
    OBJECT_NAME,
    INDEX_NAME,
    COUNT_FETCH,
    COUNT_INSERT,
    COUNT_UPDATE,
    COUNT_DELETE
FROM performance_schema.table_io_waits_summary_by_index_usage
WHERE OBJECT_NAME = 'orders'
ORDER BY COUNT_FETCH DESC;
```

### 6.3 åˆ†åŒºç´¢å¼•ç»´æŠ¤æœ€ä½³å®žè·µ


**ðŸŽ¯ ç»´æŠ¤ç­–ç•¥**
```
å®šæœŸç»´æŠ¤è®¡åˆ’ï¼š
ðŸ“… æ¯æ—¥ï¼šç›‘æŽ§åˆ†åŒºå¤§å°å’ŒæŸ¥è¯¢æ€§èƒ½
ðŸ“… æ¯å‘¨ï¼šæ£€æŸ¥ç´¢å¼•ç¢Žç‰‡çŽ‡å’Œç»Ÿè®¡ä¿¡æ¯
ðŸ“… æ¯æœˆï¼šæ‰§è¡ŒANALYZE TABLEæ›´æ–°ç»Ÿè®¡
ðŸ“… æ¯å­£åº¦ï¼šè¯„ä¼°åˆ†åŒºç­–ç•¥æ˜¯å¦éœ€è¦è°ƒæ•´
```

**âš™ï¸ è‡ªåŠ¨åŒ–ç»´æŠ¤è„šæœ¬**
```sql
-- åˆ›å»ºç»´æŠ¤å­˜å‚¨è¿‡ç¨‹
DELIMITER //
CREATE PROCEDURE maintain_partition_indexes()
BEGIN
    DECLARE done INT DEFAULT FALSE;
    DECLARE partition_name VARCHAR(64);
    DECLARE cur CURSOR FOR 
        SELECT PARTITION_NAME 
        FROM INFORMATION_SCHEMA.PARTITIONS 
        WHERE TABLE_NAME = 'orders';
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;
    
    OPEN cur;
    maintenance_loop: LOOP
        FETCH cur INTO partition_name;
        IF done THEN
            LEAVE maintenance_loop;
        END IF;
        
        -- åˆ†æžåˆ†åŒºç»Ÿè®¡ä¿¡æ¯
        SET @sql = CONCAT('ANALYZE TABLE orders PARTITION ', partition_name);
        PREPARE stmt FROM @sql;
        EXECUTE stmt;
        DEALLOCATE PREPARE stmt;
        
    END LOOP;
    CLOSE cur;
END //
DELIMITER ;

-- å®šæœŸæ‰§è¡Œç»´æŠ¤
-- å¯ä»¥é…åˆcronå®šæ—¶ä»»åŠ¡æ‰§è¡Œ
CALL maintain_partition_indexes();
```

---

## 7. ðŸ† åˆ†åŒºç´¢å¼•è®¾è®¡æœ€ä½³å®žè·µ


### 7.1 åˆ†åŒºç­–ç•¥é€‰æ‹©


**ðŸ”¸ é€‰æ‹©åˆé€‚çš„åˆ†åŒºæ–¹å¼**
```
åˆ†åŒºæ–¹å¼é€‰æ‹©æŒ‡å—ï¼š

ðŸ“… æŒ‰æ—¶é—´åˆ†åŒºï¼ˆæœ€å¸¸ç”¨ï¼‰ï¼š
âœ… é€‚ç”¨åœºæ™¯ï¼šæ—¥å¿—è¡¨ã€äº¤æ˜“è®°å½•ã€åŽ†å²æ•°æ®
âœ… ä¼˜åŠ¿ï¼šå¤©ç„¶çš„æ•°æ®ç”Ÿå‘½å‘¨æœŸç®¡ç†
âœ… åˆ†åŒºé”®ï¼šæ—¥æœŸã€æ—¶é—´æˆ³å­—æ®µ

ðŸ·ï¸ æŒ‰èŒƒå›´åˆ†åŒºï¼š
âœ… é€‚ç”¨åœºæ™¯ï¼šæœ‰æ˜Žç¡®èŒƒå›´çš„æ•°æ®ï¼ˆåœ°åŒºã€å¹´é¾„æ®µç­‰ï¼‰
âœ… ä¼˜åŠ¿ï¼šæŸ¥è¯¢æ¡ä»¶æ˜Žç¡®æ—¶æ€§èƒ½å¥½
âœ… åˆ†åŒºé”®ï¼šæ•°å€¼åž‹å­—æ®µ

ðŸ”€ æŒ‰å“ˆå¸Œåˆ†åŒºï¼š
âœ… é€‚ç”¨åœºæ™¯ï¼šæ•°æ®åˆ†å¸ƒå‡åŒ€ï¼Œä¸»è¦ç›®çš„æ˜¯å‡å°‘å•è¡¨å¤§å°
âœ… ä¼˜åŠ¿ï¼šæ•°æ®åˆ†å¸ƒå‡åŒ€
âœ… åˆ†åŒºé”®ï¼šä¸»é”®æˆ–å”¯ä¸€å­—æ®µ

ðŸ“‹ æŒ‰åˆ—è¡¨åˆ†åŒºï¼š
âœ… é€‚ç”¨åœºæ™¯ï¼šæœ‰é™çš„æžšä¸¾å€¼ï¼ˆçŠ¶æ€ã€åœ°åŒºä»£ç ç­‰ï¼‰
âœ… ä¼˜åŠ¿ï¼šé€»è¾‘æ¸…æ™°
âœ… åˆ†åŒºé”®ï¼šæžšä¸¾ç±»åž‹å­—æ®µ
```

**ðŸ’¡ åˆ†åŒºè®¾è®¡ç¤ºä¾‹**
```sql
-- 1. æ—¶é—´åˆ†åŒºè®¾è®¡ï¼ˆæŽ¨èï¼‰
CREATE TABLE user_orders (
    order_id BIGINT AUTO_INCREMENT,
    user_id INT,
    order_time DATETIME,
    amount DECIMAL(10,2),
    status VARCHAR(20),
    
    PRIMARY KEY (order_id, order_time),      -- ä¸»é”®åŒ…å«åˆ†åŒºé”®
    INDEX idx_user_time (user_id, order_time),  -- å¸¸ç”¨æŸ¥è¯¢ç´¢å¼•
    INDEX idx_status_time (status, order_time)  -- çŠ¶æ€æŸ¥è¯¢ç´¢å¼•
) PARTITION BY RANGE (YEAR(order_time) * 100 + MONTH(order_time)) (
    PARTITION p202401 VALUES LESS THAN (202402),
    PARTITION p202402 VALUES LESS THAN (202403),
    -- å»ºè®®é¢„åˆ›å»ºæœªæ¥å‡ ä¸ªæœˆçš„åˆ†åŒº
    PARTITION p202412 VALUES LESS THAN (202501),
    PARTITION p_future VALUES LESS THAN MAXVALUE
);

-- 2. æ··åˆåˆ†åŒºè®¾è®¡
CREATE TABLE user_behavior (
    id BIGINT AUTO_INCREMENT,
    user_id INT,
    behavior_type ENUM('login', 'purchase', 'view', 'search'),
    behavior_time DATETIME,
    
    PRIMARY KEY (id, behavior_type, behavior_time),
    INDEX idx_user_type_time (user_id, behavior_type, behavior_time)
) PARTITION BY LIST (behavior_type) 
  SUBPARTITION BY RANGE (YEAR(behavior_time)) (
    PARTITION p_login VALUES IN ('login') (
        SUBPARTITION p_login_2024 VALUES LESS THAN (2025)
    ),
    PARTITION p_purchase VALUES IN ('purchase') (
        SUBPARTITION p_purchase_2024 VALUES LESS THAN (2025)
    )
);
```

### 7.2 ç´¢å¼•è®¾è®¡åŽŸåˆ™


**ðŸŽ¯ åˆ†åŒºè¡¨ç´¢å¼•è®¾è®¡è¦ç‚¹**
```
æ ¸å¿ƒåŽŸåˆ™ï¼š

1. åˆ†åŒºé”®å¿…é¡»åŒ…å«åœ¨ä¸»é”®ä¸­
   âœ… ä¿è¯æ•°æ®å”¯ä¸€æ€§
   âœ… æ”¯æŒåˆ†åŒºå‰ªè£

2. ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µåˆ›å»ºç´¢å¼•
   âœ… ç»“åˆåˆ†åŒºé”®è®¾è®¡å¤åˆç´¢å¼•
   âœ… è€ƒè™‘è¦†ç›–ç´¢å¼•å‡å°‘å›žè¡¨

3. é¿å…è¿‡å¤šç´¢å¼•
   âœ… æ¯ä¸ªåˆ†åŒºçš„ç´¢å¼•ç»“æž„ç›¸åŒ
   âœ… ç´¢å¼•ç»´æŠ¤æˆæœ¬ä¼šä¹˜ä»¥åˆ†åŒºæ•°é‡

4. è€ƒè™‘æŸ¥è¯¢æ¨¡å¼
   âœ… å•åˆ†åŒºæŸ¥è¯¢ vs è·¨åˆ†åŒºæŸ¥è¯¢
   âœ… ç‚¹æŸ¥è¯¢ vs èŒƒå›´æŸ¥è¯¢ vs èšåˆæŸ¥è¯¢
```

**ðŸ“Š ç´¢å¼•è®¾è®¡ç¤ºä¾‹**
```sql
-- é’ˆå¯¹ä¸åŒæŸ¥è¯¢æ¨¡å¼è®¾è®¡ç´¢å¼•
CREATE TABLE order_logs (
    log_id BIGINT AUTO_INCREMENT,
    order_id BIGINT,
    user_id INT,
    log_time DATETIME,
    log_type VARCHAR(50),
    log_content TEXT,
    
    PRIMARY KEY (log_id, log_time),
    
    -- 1. æ”¯æŒæŒ‰è®¢å•æŸ¥è¯¢ï¼ˆå•åˆ†åŒºå†…é«˜æ•ˆï¼‰
    INDEX idx_order_time (order_id, log_time),
    
    -- 2. æ”¯æŒæŒ‰ç”¨æˆ·æŸ¥è¯¢ï¼ˆå¯èƒ½è·¨åˆ†åŒºï¼Œéœ€è¦ä¼˜åŒ–ï¼‰
    INDEX idx_user_type_time (user_id, log_type, log_time),
    
    -- 3. æ”¯æŒæŒ‰ç±»åž‹ç»Ÿè®¡ï¼ˆè¦†ç›–ç´¢å¼•ï¼‰
    INDEX idx_type_time_id (log_type, log_time, log_id),
    
    -- 4. ä¸å»ºè®®ï¼šè¿‡äºŽç»†åŒ–çš„ç´¢å¼•
    -- INDEX idx_content (log_content(100))  -- ä¸å¿…è¦
    
) PARTITION BY RANGE (YEAR(log_time) * 100 + MONTH(log_time));
```

### 7.3 æ€§èƒ½ä¼˜åŒ–å»ºè®®


**âš¡ æŸ¥è¯¢ä¼˜åŒ–ç­–ç•¥**
```sql
-- 1. ä¼˜å…ˆä½¿ç”¨åˆ†åŒºé”®è¿›è¡ŒæŸ¥è¯¢
-- å¥½çš„æŸ¥è¯¢æ¨¡å¼
SELECT * FROM orders 
WHERE order_time >= '2024-03-01' 
  AND order_time < '2024-04-01'
  AND user_id = 1001;

-- 2. åˆ©ç”¨è¦†ç›–ç´¢å¼•
-- åˆ›å»ºè¦†ç›–ç´¢å¼•
CREATE INDEX idx_cover ON orders (user_id, order_time, status, amount);

-- æŸ¥è¯¢åªéœ€è¦ç´¢å¼•æ•°æ®ï¼Œä¸éœ€è¦å›žè¡¨
SELECT user_id, status, amount 
FROM orders 
WHERE order_time = '2024-03-15';

-- 3. æ‰¹é‡æ“ä½œä¼˜åŒ–
-- æ‰¹é‡æ’å…¥æ—¶æŒ‰åˆ†åŒºé”®æŽ’åº
INSERT INTO orders (user_id, order_time, amount) VALUES
(1001, '2024-03-01', 100.00),
(1002, '2024-03-01', 200.00),  -- åŒä¸€åˆ†åŒºçš„æ•°æ®æ”¾ä¸€èµ·
(1003, '2024-03-02', 150.00);

-- 4. åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–
-- åœ¨å•åˆ†åŒºå†…åˆ†é¡µ
SELECT * FROM orders 
WHERE order_time >= '2024-03-01' 
  AND order_time < '2024-04-01'
ORDER BY order_id 
LIMIT 20 OFFSET 0;
```

**ðŸ” ç›‘æŽ§å’Œè°ƒä¼˜**
```sql
-- å®šæœŸæ£€æŸ¥åˆ†åŒºæ•ˆæžœ
-- 1. æ£€æŸ¥å„åˆ†åŒºæ•°æ®åˆ†å¸ƒ
SELECT 
    PARTITION_NAME,
    TABLE_ROWS,
    ROUND(DATA_LENGTH/1024/1024, 2) as DATA_MB,
    ROUND(INDEX_LENGTH/1024/1024, 2) as INDEX_MB
FROM INFORMATION_SCHEMA.PARTITIONS 
WHERE TABLE_NAME = 'orders'
ORDER BY PARTITION_ORDINAL_POSITION;

-- 2. åˆ†æžæŸ¥è¯¢æ‰§è¡Œè®¡åˆ’
EXPLAIN PARTITIONS 
SELECT * FROM orders WHERE order_time = '2024-03-15';

-- 3. ç›‘æŽ§æ…¢æŸ¥è¯¢ä¸­çš„è·¨åˆ†åŒºæŸ¥è¯¢
-- åœ¨æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­å…³æ³¨åŒ…å«å¤šä¸ªpartitionçš„æŸ¥è¯¢
```

### 7.4 åˆ†åŒºè¡¨é™åˆ¶ä¸Žæ³¨æ„äº‹é¡¹


**âš ï¸ MySQLåˆ†åŒºè¡¨é™åˆ¶**
```
é‡è¦é™åˆ¶ï¼š
1. ä¸»é”®å’Œå”¯ä¸€é”®å¿…é¡»åŒ…å«åˆ†åŒºé”®
   âŒ PRIMARY KEY (order_id)  -- é”™è¯¯
   âœ… PRIMARY KEY (order_id, order_time)  -- æ­£ç¡®

2. ä¸æ”¯æŒå¤–é”®çº¦æŸ
   âŒ åˆ†åŒºè¡¨ä¸èƒ½æœ‰å¤–é”®å¼•ç”¨

3. ä¸æ”¯æŒå…¨æ–‡ç´¢å¼•
   âŒ åˆ†åŒºè¡¨ä¸èƒ½åˆ›å»ºFULLTEXTç´¢å¼•

4. å­˜å‚¨å¼•æ“Žé™åˆ¶
   âœ… InnoDBå’ŒMyISAMæ”¯æŒåˆ†åŒº
   âŒ Memoryç­‰å¼•æ“Žæ”¯æŒæœ‰é™

5. åˆ†åŒºæ•°é‡é™åˆ¶
   âœ… æœ€å¤§æ”¯æŒ8192ä¸ªåˆ†åŒºï¼ˆå­åˆ†åŒºç®—åœ¨å†…ï¼‰
```

**ðŸŽ¯ è®¾è®¡æ³¨æ„äº‹é¡¹**
```
è®¾è®¡å»ºè®®ï¼š

1. åˆ†åŒºç­–ç•¥è¦ç¨³å®š
   â€¢ é¿å…é¢‘ç¹ä¿®æ”¹åˆ†åŒºæ–¹å¼
   â€¢ é¢„ç•™è¶³å¤Ÿçš„åˆ†åŒºç©ºé—´

2. ç›‘æŽ§åˆ†åŒºå‡è¡¡æ€§
   â€¢ å®šæœŸæ£€æŸ¥å„åˆ†åŒºå¤§å°
   â€¢ é¿å…å‡ºçŽ°çƒ­ç‚¹åˆ†åŒº

3. å¤‡ä»½æ¢å¤ç­–ç•¥
   â€¢ å¯ä»¥æŒ‰åˆ†åŒºè¿›è¡Œå¤‡ä»½
   â€¢ æ¢å¤æ—¶æ³¨æ„åˆ†åŒºä¸€è‡´æ€§

4. åº”ç”¨ç¨‹åºé€‚é…
   â€¢ æŸ¥è¯¢å°½é‡åŒ…å«åˆ†åŒºé”®
   â€¢ è€ƒè™‘åˆ†åŒºå¯¹äº‹åŠ¡çš„å½±å“
```

---

## 8. ðŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŽŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ðŸ”¸ åˆ†åŒºè¡¨ç´¢å¼•æœ¬è´¨ï¼šæ¯ä¸ªåˆ†åŒºç‹¬ç«‹ç»´æŠ¤çš„æœ¬åœ°ç´¢å¼•
ðŸ”¸ åˆ†åŒºå‰ªè£ï¼šé€šè¿‡åˆ†åŒºé”®å¿«é€Ÿå®šä½éœ€è¦è®¿é—®çš„åˆ†åŒº
ðŸ”¸ æœ¬åœ°ç´¢å¼•ç‰¹æ€§ï¼šç‹¬ç«‹ç»´æŠ¤ã€å¹¶è¡Œå¤„ç†ã€èŒƒå›´æœ‰é™
ðŸ”¸ åˆ†åŒºé”®ç´¢å¼•ï¼šåŒ…å«åˆ†åŒºé”®çš„ç´¢å¼•ï¼Œæ˜¯åˆ†åŒºå‰ªè£çš„åŸºç¡€
ðŸ”¸ è·¨åˆ†åŒºæŸ¥è¯¢ï¼šéœ€è¦è®¿é—®å¤šä¸ªåˆ†åŒºçš„æŸ¥è¯¢ï¼Œæ€§èƒ½ç›¸å¯¹è¾ƒå·®
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ðŸ”¹ åˆ†åŒºç´¢å¼•çš„æ ¸å¿ƒä»·å€¼**
```
æ€§èƒ½æå‡ï¼š
â€¢ å‡å°‘æ•°æ®æ‰«æèŒƒå›´ â†’ æŸ¥è¯¢æ›´å¿«
â€¢ æ”¯æŒå¹¶è¡Œå¤„ç† â†’ å……åˆ†åˆ©ç”¨å¤šæ ¸
â€¢ é™ä½Žé”ç«žäº‰ â†’ æé«˜å¹¶å‘èƒ½åŠ›
â€¢ ä¾¿äºŽæ•°æ®ç®¡ç† â†’ æŒ‰åˆ†åŒºç»´æŠ¤

ä½¿ç”¨åœºæ™¯ï¼š
â€¢ å¤§è¡¨æŸ¥è¯¢ä¼˜åŒ–
â€¢ åŽ†å²æ•°æ®ç®¡ç†
â€¢ å¹¶å‘å†™å…¥ä¼˜åŒ–
â€¢ æ•°æ®ç”Ÿå‘½å‘¨æœŸç®¡ç†
```

**ðŸ”¹ è®¾è®¡å…³é”®ç‚¹**
```
åˆ†åŒºç­–ç•¥ï¼š
â€¢ é€‰æ‹©åˆé€‚çš„åˆ†åŒºå­—æ®µï¼ˆé€šå¸¸æ˜¯æ—¶é—´ï¼‰
â€¢ ç¡®ä¿æ•°æ®åˆ†å¸ƒå‡åŒ€
â€¢ é¢„ç•™æœªæ¥æ‰©å±•ç©ºé—´

ç´¢å¼•è®¾è®¡ï¼š
â€¢ ä¸»é”®å¿…é¡»åŒ…å«åˆ†åŒºé”®
â€¢ ä¸ºå¸¸ç”¨æŸ¥è¯¢åˆ›å»ºåˆé€‚ç´¢å¼•
â€¢ é¿å…ç´¢å¼•è¿‡å¤šå¢žåŠ ç»´æŠ¤æˆæœ¬

æŸ¥è¯¢ä¼˜åŒ–ï¼š
â€¢ å°½é‡åœ¨æŸ¥è¯¢ä¸­åŒ…å«åˆ†åŒºé”®
â€¢ åˆ©ç”¨è¦†ç›–ç´¢å¼•å‡å°‘å›žè¡¨
â€¢ é¿å…ä¸å¿…è¦çš„è·¨åˆ†åŒºæŸ¥è¯¢
```

### 8.3 å®žé™…åº”ç”¨æŒ‡å¯¼


**ðŸ“Š é€‚ç”¨åœºæ™¯åˆ¤æ–­**
```
âœ… é€‚åˆä½¿ç”¨åˆ†åŒºè¡¨ç´¢å¼•ï¼š
â€¢ è¡¨æ•°æ®é‡å¾ˆå¤§ï¼ˆç™¾ä¸‡çº§ä»¥ä¸Šï¼‰
â€¢ æœ‰æ˜Žç¡®çš„åˆ†åŒºç»´åº¦ï¼ˆæ—¶é—´ã€åœ°åŒºç­‰ï¼‰
â€¢ æŸ¥è¯¢ç»å¸¸åŒ…å«åˆ†åŒºå­—æ®µ
â€¢ éœ€è¦å¹¶è¡Œå¤„ç†æå‡æ€§èƒ½

âŒ ä¸é€‚åˆä½¿ç”¨åˆ†åŒºè¡¨ï¼š
â€¢ å°è¡¨ï¼ˆå‡ åä¸‡æ¡ä»¥ä¸‹ï¼‰
â€¢ æ²¡æœ‰åˆé€‚çš„åˆ†åŒºå­—æ®µ
â€¢ æŸ¥è¯¢å¾ˆå°‘ä½¿ç”¨åˆ†åŒºå­—æ®µ
â€¢ éœ€è¦å¤æ‚çš„äº‹åŠ¡å¤„ç†
```

**ðŸ› ï¸ å®žæ–½æ­¥éª¤**
```
1. éœ€æ±‚åˆ†æž
   â€¢ åˆ†æžè¡¨å¤§å°å’Œå¢žé•¿è¶‹åŠ¿
   â€¢ ç»Ÿè®¡æŸ¥è¯¢æ¨¡å¼å’Œçƒ­ç‚¹å­—æ®µ
   â€¢ ç¡®å®šåˆ†åŒºç»´åº¦å’Œç­–ç•¥

2. è®¾è®¡é˜¶æ®µ
   â€¢ è®¾è®¡åˆ†åŒºæ–¹æ¡ˆ
   â€¢ è§„åˆ’ç´¢å¼•ç»“æž„
   â€¢ è€ƒè™‘åº”ç”¨ç¨‹åºæ”¹åŠ¨

3. å®žæ–½é˜¶æ®µ
   â€¢ åˆ›å»ºåˆ†åŒºè¡¨ç»“æž„
   â€¢ è¿ç§»åŽ†å²æ•°æ®
   â€¢ åˆ›å»ºå¿…è¦ç´¢å¼•

4. ä¼˜åŒ–é˜¶æ®µ
   â€¢ ç›‘æŽ§æŸ¥è¯¢æ€§èƒ½
   â€¢ è°ƒæ•´ç´¢å¼•ç­–ç•¥
   â€¢ ä¼˜åŒ–åº”ç”¨æŸ¥è¯¢
```

### 8.4 æ€§èƒ½ç›‘æŽ§è¦ç‚¹


**ðŸ“ˆ å…³é”®æ€§èƒ½æŒ‡æ ‡**
```
æŸ¥è¯¢æ€§èƒ½ï¼š
â€¢ æŸ¥è¯¢å“åº”æ—¶é—´
â€¢ åˆ†åŒºå‰ªè£æˆåŠŸçŽ‡
â€¢ è·¨åˆ†åŒºæŸ¥è¯¢æ¯”ä¾‹

å­˜å‚¨æ•ˆçŽ‡ï¼š
â€¢ å„åˆ†åŒºå¤§å°åˆ†å¸ƒ
â€¢ ç´¢å¼•ç©ºé—´å ç”¨
â€¢ æ•°æ®å¢žé•¿è¶‹åŠ¿

ç³»ç»Ÿèµ„æºï¼š
â€¢ CPUä½¿ç”¨çŽ‡
â€¢ I/Oåžåé‡
â€¢ é”ç­‰å¾…æ—¶é—´
```

**ðŸ”§ å¸¸è§é—®é¢˜è§£å†³**
```
é—®é¢˜1ï¼šæŸ¥è¯¢æ€§èƒ½æ²¡æœ‰æå‡
è§£å†³ï¼šæ£€æŸ¥æ˜¯å¦å®žçŽ°äº†åˆ†åŒºå‰ªè£ï¼Œä¼˜åŒ–æŸ¥è¯¢æ¡ä»¶

é—®é¢˜2ï¼šåˆ†åŒºæ•°æ®åˆ†å¸ƒä¸å‡
è§£å†³ï¼šè°ƒæ•´åˆ†åŒºç­–ç•¥ï¼Œé‡æ–°åˆ†å¸ƒæ•°æ®

é—®é¢˜3ï¼šè·¨åˆ†åŒºæŸ¥è¯¢è¿‡å¤š
è§£å†³ï¼šä¼˜åŒ–åº”ç”¨æŸ¥è¯¢é€»è¾‘ï¼Œæ·»åŠ åˆ†åŒºé”®æ¡ä»¶

é—®é¢˜4ï¼šç´¢å¼•ç»´æŠ¤æˆæœ¬é«˜
è§£å†³ï¼šå‡å°‘ä¸å¿…è¦çš„ç´¢å¼•ï¼Œåˆå¹¶ç›¸ä¼¼ç´¢å¼•
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- åˆ†åŒºè¡¨ç´¢å¼•ä»¥åˆ†åŒºå‰ªè£ä¸ºæ ¸å¿ƒï¼Œåˆç†çš„åˆ†åŒºé”®æ˜¯å…³é”®
- æœ¬åœ°ç´¢å¼•ç‹¬ç«‹ç»´æŠ¤ï¼Œé€‚åˆå¹¶è¡Œå¤„ç†å’Œå¤§è¡¨ä¼˜åŒ–
- æŸ¥è¯¢ä¼˜åŒ–é‡åœ¨åŒ…å«åˆ†åŒºé”®ï¼Œé¿å…å…¨åˆ†åŒºæ‰«æ
- ç›‘æŽ§å’Œç»´æŠ¤æ˜¯ä¿æŒæ€§èƒ½çš„é‡è¦æ‰‹æ®µ