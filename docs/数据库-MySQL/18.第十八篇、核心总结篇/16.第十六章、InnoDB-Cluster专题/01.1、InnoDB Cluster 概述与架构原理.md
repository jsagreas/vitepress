---
title: 1ã€InnoDB Cluster æ¦‚è¿°ä¸Žæž¶æž„åŽŸç†
---
## ðŸ“š ç›®å½•

1. [InnoDB Cluster åŸºæœ¬æ¦‚å¿µ](#1-InnoDB-Cluster-åŸºæœ¬æ¦‚å¿µ)
2. [ä¸‰å¤§æ ¸å¿ƒç»„ä»¶è¯¦è§£](#2-ä¸‰å¤§æ ¸å¿ƒç»„ä»¶è¯¦è§£)
3. [åˆ†å¸ƒå¼é›†ç¾¤æž¶æž„åŽŸç†](#3-åˆ†å¸ƒå¼é›†ç¾¤æž¶æž„åŽŸç†)
4. [é«˜å¯ç”¨ä¸Žæ•…éšœè½¬ç§»æœºåˆ¶](#4-é«˜å¯ç”¨ä¸Žæ•…éšœè½¬ç§»æœºåˆ¶)
5. [æ•°æ®ä¸€è‡´æ€§ä¿è¯æœºåˆ¶](#5-æ•°æ®ä¸€è‡´æ€§ä¿è¯æœºåˆ¶)
6. [é›†ç¾¤æ‹“æ‰‘ç»“æž„è§£æž](#6-é›†ç¾¤æ‹“æ‰‘ç»“æž„è§£æž)
7. [ä¸Žä¼ ç»Ÿå¤åˆ¶æ–¹æ¡ˆå¯¹æ¯”](#7-ä¸Žä¼ ç»Ÿå¤åˆ¶æ–¹æ¡ˆå¯¹æ¯”)
8. [é€‚ç”¨åœºæ™¯ä¸Žä¸šåŠ¡ä»·å€¼](#8-é€‚ç”¨åœºæ™¯ä¸Žä¸šåŠ¡ä»·å€¼)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ðŸ—ï¸ InnoDB Cluster åŸºæœ¬æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯InnoDB Cluster


> **ç®€å•ç†è§£**ï¼šInnoDB Clusterå°±åƒæ˜¯æŠŠå¤šå°MySQLæœåŠ¡å™¨ç»„æˆä¸€ä¸ª"è¶…çº§æ•°æ®åº“å›¢é˜Ÿ"ï¼Œè¿™ä¸ªå›¢é˜Ÿé‡Œçš„æ¯å°æœåŠ¡å™¨éƒ½èƒ½å¤„ç†è¯»å†™æ“ä½œï¼Œå¦‚æžœå…¶ä¸­ä¸€å°å‡ºé—®é¢˜äº†ï¼Œå…¶ä»–æœåŠ¡å™¨ä¼šè‡ªåŠ¨é¡¶ä¸Šï¼Œä¿è¯ä¸šåŠ¡ä¸ä¸­æ–­ã€‚

**ðŸ“‹ æ ¸å¿ƒå®šä¹‰**
```
InnoDB Cluster = ä¸€å¥—å®Œæ•´çš„MySQLé«˜å¯ç”¨è§£å†³æ–¹æ¡ˆ

ä½œç”¨ï¼šè§£å†³å•å°MySQLæœåŠ¡å™¨çš„ä¸¤å¤§ç—›ç‚¹
ðŸ’” å•ç‚¹æ•…éšœï¼šä¸€å°æœåŠ¡å™¨æŒ‚äº†ï¼Œæ•´ä¸ªç³»ç»Ÿå°±åœäº†
ðŸ“ˆ æ€§èƒ½ç“¶é¢ˆï¼šä¸€å°æœåŠ¡å™¨å¤„ç†èƒ½åŠ›æœ‰é™ï¼Œè®¿é—®é‡å¤§å°±æ‰›ä¸ä½
```

**ðŸŽ¯ InnoDB Clusterçš„æ ¸å¿ƒä»·å€¼**

| **ç—›ç‚¹** | **ä¼ ç»Ÿæ–¹æ¡ˆ** | **InnoDB Clusterè§£å†³æ–¹æ¡ˆ** |
|---------|-------------|--------------------------|
| **æœåŠ¡å™¨å®•æœº** | `ä¸šåŠ¡ä¸­æ–­ï¼Œæ‰‹åŠ¨æ¢å¤` | `è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼Œç§’çº§åˆ‡æ¢` |
| **æ•°æ®ä¸¢å¤±é£Žé™©** | `ä¾èµ–å¤‡ä»½æ¢å¤` | `å¤šå‰¯æœ¬å®žæ—¶åŒæ­¥ï¼Œé›¶æ•°æ®ä¸¢å¤±` |
| **æ‰©å±•å›°éš¾** | `åž‚ç›´æ‰©å±•ï¼ˆå‡çº§ç¡¬ä»¶ï¼‰` | `æ°´å¹³æ‰©å±•ï¼ˆå¢žåŠ æœåŠ¡å™¨ï¼‰` |
| **è¿ç»´å¤æ‚** | `æ‰‹åŠ¨ç›‘æŽ§å’Œç»´æŠ¤` | `è‡ªåŠ¨åŒ–ç®¡ç†å’Œç›‘æŽ§` |

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦InnoDB Cluster


**ðŸ”¥ ä¸šåŠ¡åœºæ™¯ä¸¾ä¾‹**

```
ç”µå•†ç½‘ç«™çš„å›°å¢ƒï¼š

å•å°MySQLæœåŠ¡å™¨ï¼š
ðŸ›’ åŒ11æœŸé—´ï¼š10ä¸‡ç”¨æˆ·åŒæ—¶ä¸‹å•
ðŸ’¥ ç»“æžœï¼šæ•°æ®åº“åŽ‹åŠ›è¿‡å¤§ï¼Œå“åº”ç¼“æ…¢ç”šè‡³å®•æœº
ðŸ˜± å½±å“ï¼šç”¨æˆ·æ— æ³•ä¸‹å•ï¼Œä¸šåŠ¡æŸå¤±å·¨å¤§

InnoDB Clusteræ–¹æ¡ˆï¼š
ðŸ›’ åŒ11æœŸé—´ï¼šåŒæ ·10ä¸‡ç”¨æˆ·ä¸‹å•
âœ… ç»“æžœï¼š3å°æœåŠ¡å™¨åˆ†æ‹…åŽ‹åŠ›ï¼Œè¿è¡Œå¹³ç¨³
ðŸŽ‰ å½±å“ï¼šç”¨æˆ·ä½“éªŒè‰¯å¥½ï¼Œè®¢å•æ­£å¸¸å¤„ç†
```

**ðŸ’¡ çŽ°å®žéœ€æ±‚åˆ†æž**

- **ä¸šåŠ¡è¿žç»­æ€§éœ€æ±‚**ï¼š7Ã—24å°æ—¶ä¸é—´æ–­æœåŠ¡
- **æ•°æ®å®‰å…¨éœ€æ±‚**ï¼šäº¤æ˜“æ•°æ®ç»å¯¹ä¸èƒ½ä¸¢å¤±  
- **æ€§èƒ½æ‰©å±•éœ€æ±‚**ï¼šä¸šåŠ¡å¢žé•¿æ—¶èƒ½å¿«é€Ÿæ‰©å®¹
- **è¿ç»´æ•ˆçŽ‡éœ€æ±‚**ï¼šå‡å°‘äººå·¥å¹²é¢„ï¼Œè‡ªåŠ¨åŒ–ç®¡ç†

### 1.3 InnoDB Cluster vs å…¶ä»–é«˜å¯ç”¨æ–¹æ¡ˆ


```
é«˜å¯ç”¨æ–¹æ¡ˆå¯¹æ¯”å›¾ï¼š

ä¼ ç»Ÿä¸»ä»Žå¤åˆ¶              InnoDB Cluster
     ä¸»åº“                     ä¸»åº“1  ä¸»åº“2  ä¸»åº“3
     / \                      |  \  /  |  /  \  |
   ä»Žåº“1 ä»Žåº“2                 |   \/   |   \/   |
                              |   /\   |   /\   |
é—®é¢˜ï¼š                        |  /  \  |  /  \  |
- æ•…éšœåˆ‡æ¢éœ€æ‰‹åŠ¨              å¤šä¸»æž¶æž„ï¼Œè‡ªåŠ¨æ•…éšœè½¬ç§»
- æ•°æ®å¯èƒ½ä¸ä¸€è‡´
- æ‰©å±•æ€§å·®
```

---

## 2. ðŸ§© ä¸‰å¤§æ ¸å¿ƒç»„ä»¶è¯¦è§£


### 2.1 ç»„ä»¶æž¶æž„å…¨è§ˆ


```
InnoDB Cluster ä¸‰å¤§ç»„ä»¶å…³ç³»å›¾ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åº”ç”¨ç¨‹åº                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  MySQL Router                          â”‚
â”‚              (æ™ºèƒ½è·¯ç”±å’Œè´Ÿè½½å‡è¡¡)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            MySQL Group Replication                     â”‚
â”‚        (æ•°æ®åŒæ­¥å’Œä¸€è‡´æ€§ä¿è¯)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   MySQLå®žä¾‹1     â”‚   MySQLå®žä¾‹2     â”‚   MySQLå®žä¾‹3        â”‚
â”‚   (Primary)     â”‚   (Secondary)   â”‚   (Secondary)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                  MySQL Shell                           â”‚
â”‚              (é›†ç¾¤ç®¡ç†å’Œè¿ç»´)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> **é€šä¿—ç†è§£**ï¼šå°±åƒä¸€ä¸ªå…¬å¸çš„ç»„ç»‡æž¶æž„ï¼ŒMySQL Shellæ˜¯æ€»ç»ç†ï¼ˆç®¡ç†æ•´ä¸ªé›†ç¾¤ï¼‰ï¼ŒMySQL Routeræ˜¯å‰å°ï¼ˆæŽ¥å¾…å®¢æˆ·è¯·æ±‚ï¼‰ï¼ŒGroup Replicationæ˜¯å„ä¸ªéƒ¨é—¨ä¹‹é—´çš„åè°ƒæœºåˆ¶ï¼ˆä¿è¯ä¿¡æ¯åŒæ­¥ï¼‰ã€‚

### 2.2 MySQL Group Replication - æ•°æ®åŒæ­¥æ ¸å¿ƒ


**ðŸ”„ Group Replicationæ˜¯ä»€ä¹ˆ**

æŠŠGroup Replicationæƒ³è±¡æˆä¸€ä¸ª"æ•°æ®åŒæ­¥å°ç»„"ï¼š
- å°ç»„é‡Œæœ‰å¤šä¸ªæˆå‘˜ï¼ˆMySQLå®žä¾‹ï¼‰
- ä»»ä½•ä¸€ä¸ªæˆå‘˜æŽ¥æ”¶åˆ°æ•°æ®å˜æ›´ï¼Œéƒ½ä¼šç«‹å³é€šçŸ¥å…¶ä»–æ‰€æœ‰æˆå‘˜
- åªæœ‰å½“å¤§å¤šæ•°æˆå‘˜éƒ½ç¡®è®¤æ”¶åˆ°äº†ï¼Œè¿™ä¸ªå˜æ›´æ‰ç®—æ­£å¼ç”Ÿæ•ˆ
- è¿™æ ·å°±ä¿è¯äº†æ‰€æœ‰æˆå‘˜çš„æ•°æ®éƒ½æ˜¯ä¸€è‡´çš„

**âš™ï¸ å·¥ä½œåŽŸç†ç®€åŒ–è¯´æ˜Ž**

```
æ•°æ®å†™å…¥æµç¨‹ç¤ºä¾‹ï¼š

1. ç”¨æˆ·æäº¤è®¢å• â†’ MySQLå®žä¾‹1æŽ¥æ”¶
2. å®žä¾‹1ç”Ÿæˆå˜æ›´è®°å½• â†’ å‘é€ç»™å®žä¾‹2ã€å®žä¾‹3
3. å®žä¾‹2ã€å®žä¾‹3ç¡®è®¤æŽ¥æ”¶ â†’ è¿”å›žç¡®è®¤æ¶ˆæ¯
4. å®žä¾‹1æ”¶åˆ°ç¡®è®¤ â†’ æ­£å¼æäº¤äº‹åŠ¡
5. æ‰€æœ‰å®žä¾‹æ•°æ®ä¿æŒä¸€è‡´ â†’ è®¢å•æ•°æ®å®‰å…¨ä¿å­˜
```

**ðŸŽ¯ æ ¸å¿ƒç‰¹æ€§**

| **ç‰¹æ€§** | **è¯´æ˜Ž** | **å¥½å¤„** |
|---------|---------|---------|
| **å¤šä¸»å¤åˆ¶** | `æ‰€æœ‰èŠ‚ç‚¹éƒ½èƒ½è¯»å†™` | `è´Ÿè½½åˆ†æ•£ï¼Œæ€§èƒ½æ›´å¥½` |
| **å¼ºä¸€è‡´æ€§** | `äº‹åŠ¡è¦å¤šæ•°èŠ‚ç‚¹ç¡®è®¤` | `æ•°æ®ç»å¯¹ä¸ä¼šä¸¢å¤±` |
| **è‡ªåŠ¨æ•…éšœæ£€æµ‹** | `èŠ‚ç‚¹å¼‚å¸¸è‡ªåŠ¨å‰”é™¤` | `æ•…éšœå½±å“æœ€å°åŒ–` |
| **è‡ªåŠ¨æ¢å¤** | `æ•…éšœèŠ‚ç‚¹ä¿®å¤åŽè‡ªåŠ¨åŠ å…¥` | `è¿ç»´å·¥ä½œé‡å°‘` |

### 2.3 MySQL Router - æ™ºèƒ½è·¯ç”±å™¨


**ðŸš— Routeræ˜¯ä»€ä¹ˆ**

æŠŠMySQL Routeræ¯”ä½œä¸€ä¸ª"æ™ºèƒ½å¯¼èˆªç³»ç»Ÿ"ï¼š
- åº”ç”¨ç¨‹åºæƒ³è¦è®¿é—®æ•°æ®åº“æ—¶ï¼Œä¸ç›´æŽ¥è¿žæŽ¥æŸå°å…·ä½“çš„MySQLæœåŠ¡å™¨
- è€Œæ˜¯è¿žæŽ¥Routerï¼Œç”±Routeræ¥å†³å®šæŠŠè¯·æ±‚å‘é€ç»™å“ªå°æœåŠ¡å™¨
- RouterçŸ¥é“å“ªäº›æœåŠ¡å™¨æ˜¯å¥åº·çš„ï¼Œå“ªäº›æœåŠ¡å™¨è´Ÿè½½è¾ƒè½»
- å°±åƒå¯¼èˆªç³»ç»Ÿä¼šé€‰æ‹©æœ€ä½³è·¯çº¿ä¸€æ ·ï¼ŒRouterä¼šé€‰æ‹©æœ€ä½³çš„æ•°æ®åº“æœåŠ¡å™¨

**ðŸŽ›ï¸ æ ¸å¿ƒåŠŸèƒ½è¯¦è§£**

```
Routerå·¥ä½œç¤ºä¾‹ï¼š

åº”ç”¨ç¨‹åºå‘èµ·100ä¸ªæŸ¥è¯¢è¯·æ±‚
        â†“
    MySQL Router
   (æ™ºèƒ½åˆ†å‘å†³ç­–)
        â†“
è¯·æ±‚1-30 â†’ MySQLå®žä¾‹1 (è´Ÿè½½30%)
è¯·æ±‚31-70 â†’ MySQLå®žä¾‹2 (è´Ÿè½½40%)  
è¯·æ±‚71-100 â†’ MySQLå®žä¾‹3 (è´Ÿè½½30%)

ç»“æžœï¼šè´Ÿè½½å‡åŒ€åˆ†å¸ƒï¼Œæ€§èƒ½æœ€ä½³
```

**ðŸ“Š Routerçš„æ™ºèƒ½ç‰¹æ€§**

| **åŠŸèƒ½** | **ä½œç”¨** | **åœºæ™¯ä¸¾ä¾‹** |
|---------|---------|-------------|
| **è¯»å†™åˆ†ç¦»** | `å†™æ“ä½œå‘ç»™ä¸»èŠ‚ç‚¹ï¼Œè¯»æ“ä½œåˆ†å‘ç»™æ‰€æœ‰èŠ‚ç‚¹` | `è®¢å•æäº¤èµ°ä¸»åº“ï¼Œå•†å“æŸ¥è¯¢èµ°ä»Žåº“` |
| **è´Ÿè½½å‡è¡¡** | `æ ¹æ®æœåŠ¡å™¨è´Ÿè½½æƒ…å†µåˆ†å‘è¯·æ±‚` | `é«˜å³°æœŸè‡ªåŠ¨é¿å¼€ç¹å¿™æœåŠ¡å™¨` |
| **æ•…éšœè½¬ç§»** | `æ£€æµ‹åˆ°æœåŠ¡å™¨æ•…éšœç«‹å³åˆ‡æ¢` | `æœåŠ¡å™¨å®•æœºç”¨æˆ·æ— æ„ŸçŸ¥` |
| **è¿žæŽ¥æ± ç®¡ç†** | `å¤ç”¨æ•°æ®åº“è¿žæŽ¥ï¼Œæé«˜æ•ˆçŽ‡` | `å‡å°‘è¿žæŽ¥å»ºç«‹å¼€é”€` |

### 2.4 MySQL Shell - é›†ç¾¤ç®¡ç†å·¥å…·


**ðŸ› ï¸ Shellæ˜¯ä»€ä¹ˆ**

MySQL Shellå°±åƒé›†ç¾¤çš„"é¥æŽ§å™¨"ï¼š
- é€šè¿‡ç®€å•çš„å‘½ä»¤å°±èƒ½åˆ›å»ºã€ç®¡ç†ã€ç›‘æŽ§æ•´ä¸ªé›†ç¾¤
- ä¸éœ€è¦æ‰‹å†™å¤æ‚çš„é…ç½®æ–‡ä»¶ï¼Œä¸éœ€è¦è®°å¿†å¤§é‡çš„SQLè¯­å¥
- ä¸€é”®å®Œæˆé›†ç¾¤çš„éƒ¨ç½²ã€æ‰©å®¹ã€æ•…éšœæ¢å¤ç­‰æ“ä½œ

**ðŸŽ® å¸¸ç”¨ç®¡ç†æ“ä½œ**

```javascript
// åˆ›å»ºé›†ç¾¤ - ä¸€è¡Œå‘½ä»¤æžå®š
dba.createCluster('myCluster')

// æ·»åŠ æ–°èŠ‚ç‚¹ - é›†ç¾¤æ‰©å®¹
cluster.addInstance('mysql2:3306')

// æŸ¥çœ‹é›†ç¾¤çŠ¶æ€ - å¥åº·æ£€æŸ¥
cluster.status()

// æ•…éšœæ¢å¤ - è‡ªåŠ¨ä¿®å¤
cluster.rescan()
```

**ðŸ’¼ Shellçš„ç®¡ç†ä»·å€¼**

- **ç®€åŒ–è¿ç»´**ï¼šå¤æ‚æ“ä½œå˜æˆç®€å•å‘½ä»¤
- **é™ä½Žé—¨æ§›**ï¼šä¸éœ€è¦æ·±åº¦DBAçŸ¥è¯†ä¹Ÿèƒ½ç®¡ç†é›†ç¾¤
- **å‡å°‘é”™è¯¯**ï¼šè‡ªåŠ¨åŒ–æ“ä½œé¿å…äººä¸ºå¤±è¯¯
- **æé«˜æ•ˆçŽ‡**ï¼šæ‰¹é‡æ“ä½œèŠ‚çœå¤§é‡æ—¶é—´

---

## 3. ðŸ›ï¸ åˆ†å¸ƒå¼é›†ç¾¤æž¶æž„åŽŸç†


### 3.1 åˆ†å¸ƒå¼æ•°æ®åº“çš„åŸºæœ¬æ€æƒ³


**ðŸ¤” ä¸ºä»€ä¹ˆè¦åˆ†å¸ƒå¼**

æƒ³è±¡ä¸€ä¸‹å›¾ä¹¦é¦†çš„ä¾‹å­ï¼š
```
ä¼ ç»Ÿå•ä½“å›¾ä¹¦é¦†ï¼ˆå•å°MySQLï¼‰ï¼š
ðŸ“š æ‰€æœ‰ä¹¦éƒ½åœ¨ä¸€ä¸ªå›¾ä¹¦é¦†
ðŸ˜° é—®é¢˜ï¼šå€Ÿä¹¦çš„äººå¤ªå¤šï¼ŒæŽ’é˜Ÿæ—¶é—´é•¿
ðŸ˜± é£Žé™©ï¼šå›¾ä¹¦é¦†å…³é—¨ï¼Œæ‰€æœ‰äººéƒ½å€Ÿä¸åˆ°ä¹¦

åˆ†å¸ƒå¼å›¾ä¹¦é¦†ï¼ˆInnoDB Clusterï¼‰ï¼š
ðŸ“šðŸ“šðŸ“š åŒæ ·çš„ä¹¦åœ¨å¤šä¸ªå›¾ä¹¦é¦†éƒ½æœ‰
ðŸ˜Š å¥½å¤„ï¼šå°±è¿‘å€Ÿä¹¦ï¼Œä¸ç”¨æŽ’é˜Ÿ
ðŸ”’ ä¿éšœï¼šä¸€ä¸ªå›¾ä¹¦é¦†å…³é—¨ï¼Œå…¶ä»–å›¾ä¹¦é¦†ç…§å¸¸å¼€æ”¾
```

**âš¡ åˆ†å¸ƒå¼çš„æ ¸å¿ƒä¼˜åŠ¿**

| **æ–¹é¢** | **å•ä½“æž¶æž„** | **åˆ†å¸ƒå¼æž¶æž„** |
|---------|-------------|---------------|
| **å¯ç”¨æ€§** | `å•ç‚¹æ•…éšœï¼ŒæœåŠ¡ä¸­æ–­` | `å¤šç‚¹å†—ä½™ï¼ŒæŒç»­æœåŠ¡` |
| **æ€§èƒ½** | `å•æœºæ€§èƒ½ä¸Šé™` | `å¤šæœºæ€§èƒ½å åŠ ` |
| **æ‰©å±•æ€§** | `ç¡¬ä»¶å‡çº§ï¼ˆè´µï¼‰` | `èŠ‚ç‚¹å¢žåŠ ï¼ˆä¾¿å®œï¼‰` |
| **æ•°æ®å®‰å…¨** | `ä¾èµ–å¤‡ä»½` | `å¤šå‰¯æœ¬å®žæ—¶ä¿æŠ¤` |

### 3.2 InnoDB Clusterçš„åˆ†å¸ƒå¼ç­–ç•¥


**ðŸŽ¯ æ•°æ®åˆ†å¸ƒç­–ç•¥**

```
InnoDB Cluster æ•°æ®åˆ†å¸ƒæ–¹å¼ï¼š

å…¨é‡å¤åˆ¶æ¨¡å¼ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MySQL-1    â”‚  â”‚  MySQL-2    â”‚  â”‚  MySQL-3    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ è¡¨A å®Œæ•´â”‚ â”‚  â”‚ â”‚ è¡¨A å®Œæ•´â”‚ â”‚  â”‚ â”‚ è¡¨A å®Œæ•´â”‚ â”‚
â”‚ â”‚ è¡¨B å®Œæ•´â”‚ â”‚  â”‚ â”‚ è¡¨B å®Œæ•´â”‚ â”‚  â”‚ â”‚ è¡¨B å®Œæ•´â”‚ â”‚
â”‚ â”‚ è¡¨C å®Œæ•´â”‚ â”‚  â”‚ â”‚ è¡¨C å®Œæ•´â”‚ â”‚  â”‚ â”‚ è¡¨C å®Œæ•´â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‰¹ç‚¹ï¼šæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰å®Œæ•´æ•°æ®å‰¯æœ¬
```

**ðŸ’¡ ä¸ºä»€ä¹ˆé€‰æ‹©å…¨é‡å¤åˆ¶**

- **æŸ¥è¯¢æ€§èƒ½**ï¼šä»»ä½•èŠ‚ç‚¹éƒ½èƒ½ç‹¬ç«‹å¤„ç†æŸ¥è¯¢ï¼Œæ— éœ€è·¨èŠ‚ç‚¹åè°ƒ
- **æ•…éšœæ¢å¤**ï¼šå•ä¸ªèŠ‚ç‚¹æ•…éšœä¸å½±å“æ•°æ®å®Œæ•´æ€§  
- **è¿ç»´ç®€å•**ï¼šä¸éœ€è¦è€ƒè™‘æ•°æ®åˆ†ç‰‡çš„å¤æ‚æ€§
- **å¼ºä¸€è‡´æ€§**ï¼šæ‰€æœ‰èŠ‚ç‚¹æ•°æ®å®žæ—¶åŒæ­¥ï¼Œä¿è¯ä¸€è‡´æ€§

### 3.3 é›†ç¾¤èŠ‚ç‚¹è§’è‰²ä¸ŽèŒè´£


**ðŸ‘¥ èŠ‚ç‚¹è§’è‰²è¯´æ˜Ž**

```
InnoDB Cluster èŠ‚ç‚¹è§’è‰²ï¼š

PrimaryèŠ‚ç‚¹ï¼ˆä¸»èŠ‚ç‚¹ï¼‰ï¼š
ðŸŽ¯ èŒè´£ï¼šå¤„ç†æ‰€æœ‰å†™æ“ä½œï¼Œåè°ƒé›†ç¾¤å†³ç­–
ðŸ“Š ç‰¹ç‚¹ï¼šåŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªPrimary
âš¡ æ€§èƒ½ï¼šæ‰¿æ‹…ä¸»è¦å†™å…¥åŽ‹åŠ›

SecondaryèŠ‚ç‚¹ï¼ˆä»ŽèŠ‚ç‚¹ï¼‰ï¼š
ðŸŽ¯ èŒè´£ï¼šå¤„ç†è¯»æ“ä½œï¼Œå‚ä¸Žé›†ç¾¤æŠ•ç¥¨
ðŸ“Š ç‰¹ç‚¹ï¼šå¯ä»¥æœ‰å¤šä¸ªSecondary
âš¡ æ€§èƒ½ï¼šåˆ†æ‹…è¯»å–åŽ‹åŠ›ï¼Œæä¾›å†—ä½™
```

**ðŸ”„ è§’è‰²è‡ªåŠ¨åˆ‡æ¢æœºåˆ¶**

```
Primaryæ•…éšœè‡ªåŠ¨åˆ‡æ¢æµç¨‹ï¼š

æ­£å¸¸çŠ¶æ€ï¼š
Primary(èŠ‚ç‚¹1) + Secondary(èŠ‚ç‚¹2) + Secondary(èŠ‚ç‚¹3)
        â†“
PrimaryèŠ‚ç‚¹1æ•…éšœï¼š
âŒèŠ‚ç‚¹1(æ•…éšœ) + Secondary(èŠ‚ç‚¹2) + Secondary(èŠ‚ç‚¹3)
        â†“
è‡ªåŠ¨é€‰ä¸¾æ–°Primaryï¼š
âŒèŠ‚ç‚¹1(æ•…éšœ) + Primary(èŠ‚ç‚¹2) + Secondary(èŠ‚ç‚¹3)
        â†“
æ•…éšœèŠ‚ç‚¹æ¢å¤ï¼š
Secondary(èŠ‚ç‚¹1) + Primary(èŠ‚ç‚¹2) + Secondary(èŠ‚ç‚¹3)
```

---

## 4. ðŸ›¡ï¸ é«˜å¯ç”¨ä¸Žæ•…éšœè½¬ç§»æœºåˆ¶


### 4.1 é«˜å¯ç”¨çš„å«ä¹‰å’Œé‡è¦æ€§


**ðŸŽ¯ ä»€ä¹ˆæ˜¯é«˜å¯ç”¨**

> **é€šä¿—è§£é‡Š**ï¼šé«˜å¯ç”¨å°±åƒåŸŽå¸‚çš„ä¾›ç”µç³»ç»Ÿï¼Œå³ä½¿æŸä¸ªå‘ç”µåŽ‚å‡ºé—®é¢˜äº†ï¼Œå…¶ä»–å‘ç”µåŽ‚ä¼šç«‹å³è¡¥ä¸Šï¼Œä¿è¯å¸‚æ°‘å®¶é‡Œçš„ç¯ä¸ä¼šç†„ç­ã€‚

**ðŸ“Š å¯ç”¨æ€§ç­‰çº§æ ‡å‡†**

| **å¯ç”¨æ€§çº§åˆ«** | **å¹´åœæœºæ—¶é—´** | **æœˆåœæœºæ—¶é—´** | **åº”ç”¨åœºæ™¯** |
|---------------|---------------|---------------|-------------|
| **99%** | `87.6å°æ—¶` | `7.2å°æ—¶` | `ä¸€èˆ¬ä¸šåŠ¡ç³»ç»Ÿ` |
| **99.9%** | `8.8å°æ—¶` | `43åˆ†é’Ÿ` | `é‡è¦ä¸šåŠ¡ç³»ç»Ÿ` |
| **99.99%** | `53åˆ†é’Ÿ` | `4.3åˆ†é’Ÿ` | `æ ¸å¿ƒä¸šåŠ¡ç³»ç»Ÿ` |
| **99.999%** | `5.3åˆ†é’Ÿ` | `26ç§’` | `é‡‘èžäº¤æ˜“ç³»ç»Ÿ` |

> **ðŸ’¡ InnoDB Clusterç›®æ ‡**ï¼šå®žçŽ°99.99%ä»¥ä¸Šçš„å¯ç”¨æ€§ï¼Œå³å…¨å¹´åœæœºæ—¶é—´å°‘äºŽ1å°æ—¶ã€‚

### 4.2 æ•…éšœæ£€æµ‹æœºåˆ¶


**ðŸ” å¦‚ä½•å‘çŽ°æ•…éšœ**

```
å¤šå±‚æ•…éšœæ£€æµ‹ä½“ç³»ï¼š

1. å¿ƒè·³æ£€æµ‹ï¼ˆæœ€åŸºç¡€ï¼‰
   èŠ‚ç‚¹1 â†â†’ èŠ‚ç‚¹2 â†â†’ èŠ‚ç‚¹3
   æ¯éš”5ç§’äº’ç›¸å‘é€"æˆ‘è¿˜æ´»ç€"çš„ä¿¡å·

2. ç½‘ç»œåˆ†åŒºæ£€æµ‹ï¼ˆé˜²è¯¯åˆ¤ï¼‰
   æ£€æŸ¥æ˜¯ç½‘ç»œé—®é¢˜è¿˜æ˜¯èŠ‚ç‚¹é—®é¢˜
   
3. æ•°æ®åº“æœåŠ¡æ£€æµ‹ï¼ˆæ›´ç²¾ç¡®ï¼‰
   æ£€æŸ¥MySQLæœåŠ¡æ˜¯å¦æ­£å¸¸å“åº”
   
4. åº”ç”¨å±‚æ£€æµ‹ï¼ˆç”¨æˆ·è§†è§’ï¼‰
   Routeræ£€æµ‹èŠ‚ç‚¹æ˜¯å¦èƒ½æ­£å¸¸å¤„ç†è¯·æ±‚
```

**â±ï¸ æ•…éšœæ£€æµ‹æ—¶é—´çº¿**

```
æ•…éšœå‘ç”Ÿ â†’ æ£€æµ‹åˆ°æ•…éšœ â†’ å†³ç­–åˆ‡æ¢ â†’ å®Œæˆåˆ‡æ¢
   0ç§’      5-15ç§’        1-2ç§’      1-2ç§’

æ€»æ—¶é—´ï¼šçº¦10-20ç§’å†…å®Œæˆæ•…éšœè½¬ç§»
```

### 4.3 è‡ªåŠ¨æ•…éšœè½¬ç§»è¯¦è§£


**ðŸ”„ æ•…éšœè½¬ç§»æ­¥éª¤æ‹†è§£**

```
è‡ªåŠ¨æ•…éšœè½¬ç§»å®Œæ•´æµç¨‹ï¼š

æ­¥éª¤1ï¼šæ•…éšœæ£€æµ‹
ðŸ” å…¶ä»–èŠ‚ç‚¹å‘çŽ°Primaryæ— å“åº”
â° è¿žç»­3æ¬¡å¿ƒè·³æ£€æµ‹å¤±è´¥ï¼ˆçº¦15ç§’ï¼‰

æ­¥éª¤2ï¼šé€‰ä¸¾æ–°Primary
ðŸ—³ï¸ å‰©ä½™èŠ‚ç‚¹è¿›è¡ŒæŠ•ç¥¨é€‰ä¸¾
ðŸ“Š æ•°æ®æœ€æ–°çš„èŠ‚ç‚¹æˆä¸ºæ–°Primary

æ­¥éª¤3ï¼šæ›´æ–°é›†ç¾¤æ‹“æ‰‘
ðŸ“ è®°å½•æ–°çš„é›†ç¾¤ç»“æž„
ðŸ”„ æ›´æ–°å„èŠ‚ç‚¹çš„è§’è‰²ä¿¡æ¯

æ­¥éª¤4ï¼šè·¯ç”±åˆ‡æ¢
ðŸš— Routerè‡ªåŠ¨å‘çŽ°æ–°Primary
ðŸ”€ å°†å†™è¯·æ±‚é‡å®šå‘åˆ°æ–°Primary

æ­¥éª¤5ï¼šåº”ç”¨é‡è¿ž
ðŸ“± åº”ç”¨ç¨‹åºè‡ªåŠ¨é‡æ–°è¿žæŽ¥
âœ… ä¸šåŠ¡æ¢å¤æ­£å¸¸å¤„ç†
```

**ðŸŽ¯ æ•…éšœè½¬ç§»çš„å…³é”®ç‰¹ç‚¹**

- **æ— äººå·¥å¹²é¢„**ï¼šå…¨ç¨‹è‡ªåŠ¨åŒ–ï¼Œæ— éœ€DBAæ‰‹åŠ¨æ“ä½œ
- **æ•°æ®é›¶ä¸¢å¤±**ï¼šåªæœ‰åŒæ­¥å®Œæˆçš„äº‹åŠ¡æ‰ä¼šæäº¤
- **æœåŠ¡å¿«é€Ÿæ¢å¤**ï¼šé€šå¸¸åœ¨30ç§’å†…å®Œæˆåˆ‡æ¢
- **ä¸šåŠ¡æ„ŸçŸ¥åº¦ä½Ž**ï¼šç”¨æˆ·å¯èƒ½åªæ˜¯æ„Ÿè§‰ç¨å¾®æ…¢äº†ä¸€ä¸‹

### 4.4 æ•…éšœæ¢å¤æœºåˆ¶


**ðŸ”§ èŠ‚ç‚¹æ•…éšœåŽçš„æ¢å¤**

```
æ•…éšœèŠ‚ç‚¹æ¢å¤æµç¨‹ï¼š

æ•…éšœèŠ‚ç‚¹é‡å¯
    â†“
è‡ªåŠ¨æ£€æµ‹æ•°æ®å·®å¼‚
    â†“
å¢žé‡æ•°æ®åŒæ­¥
    â†“
çŠ¶æ€éªŒè¯é€šè¿‡
    â†“
é‡æ–°åŠ å…¥é›†ç¾¤ï¼ˆä½œä¸ºSecondaryï¼‰
```

**ðŸ’¾ æ•°æ®æ¢å¤ç­–ç•¥**

| **æ•…éšœç±»åž‹** | **æ¢å¤æ–¹å¼** | **æ¢å¤æ—¶é—´** |
|-------------|-------------|-------------|
| **çŸ­æš‚ç½‘ç»œä¸­æ–­** | `è‡ªåŠ¨é‡è¿žï¼Œæ— éœ€æ¢å¤` | `ç§’çº§` |
| **è¿›ç¨‹å´©æºƒé‡å¯** | `å¢žé‡æ—¥å¿—åŒæ­¥` | `åˆ†é’Ÿçº§` |
| **ç£ç›˜æ•…éšœä¿®å¤** | `å…¨é‡æ•°æ®å¤åˆ¶` | `å°æ—¶çº§` |
| **ç¡¬ä»¶å½»åº•æŸå** | `æ›¿æ¢ç¡¬ä»¶ï¼Œé‡æ–°åˆå§‹åŒ–` | `å°æ—¶åˆ°å¤©çº§` |

---

## 5. ðŸ”’ æ•°æ®ä¸€è‡´æ€§ä¿è¯æœºåˆ¶


### 5.1 ä»€ä¹ˆæ˜¯æ•°æ®ä¸€è‡´æ€§


**ðŸŽ¯ ä¸€è‡´æ€§çš„é€šä¿—ç†è§£**

æƒ³è±¡é“¶è¡Œè½¬è´¦çš„ä¾‹å­ï¼š
```
å¼ ä¸‰ç»™æŽå››è½¬è´¦100å…ƒ

ä¸ä¸€è‡´çš„æƒ…å†µï¼ˆç»ä¸å…è®¸ï¼‰ï¼š
- å¼ ä¸‰è´¦æˆ·æ‰£äº†100å…ƒ
- æŽå››è´¦æˆ·æ²¡æœ‰å¢žåŠ 100å…ƒ
- æˆ–è€…ç›¸åçš„æƒ…å†µ

ä¸€è‡´çš„æƒ…å†µï¼ˆå¿…é¡»ä¿è¯ï¼‰ï¼š
- å¼ ä¸‰è´¦æˆ·æ‰£100å…ƒ
- æŽå››è´¦æˆ·åŠ 100å…ƒ  
- ä¸¤ä¸ªæ“ä½œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥
```

**ðŸ“Š ä¸€è‡´æ€§çº§åˆ«åˆ†ç±»**

| **ä¸€è‡´æ€§çº§åˆ«** | **ç‰¹ç‚¹** | **åº”ç”¨åœºæ™¯** | **InnoDB Clusteræ”¯æŒ** |
|---------------|---------|-------------|---------------------|
| **å¼ºä¸€è‡´æ€§** | `æ‰€æœ‰èŠ‚ç‚¹æ•°æ®å®žæ—¶åŒæ­¥` | `é‡‘èžäº¤æ˜“` | `âœ… é»˜è®¤æ¨¡å¼` |
| **æœ€ç»ˆä¸€è‡´æ€§** | `çŸ­æ—¶é—´å†…å¯èƒ½ä¸ä¸€è‡´ï¼Œæœ€ç»ˆä¼šä¸€è‡´` | `ç¤¾äº¤åª’ä½“` | `âŒ ä¸æ”¯æŒ` |
| **å¼±ä¸€è‡´æ€§** | `ä¸ä¿è¯ä¸€è‡´æ€§` | `æ—¥å¿—ç³»ç»Ÿ` | `âŒ ä¸æ”¯æŒ` |

### 5.2 Group Replicationçš„ä¸€è‡´æ€§ç®—æ³•


**ðŸ¤ Paxosç®—æ³•ç®€åŒ–ç†è§£**

Group Replicationä½¿ç”¨ç±»ä¼¼Paxosçš„å…±è¯†ç®—æ³•ï¼Œå¯ä»¥è¿™æ ·ç†è§£ï¼š

```
æƒ³è±¡å…¬å¸å¼€ä¼šå†³ç­–çš„è¿‡ç¨‹ï¼š

1. ææ¡ˆé˜¶æ®µï¼ˆProposalï¼‰
   å¼ ä¸‰æè®®ï¼š"æˆ‘ä»¬æ”¹å˜æŸä¸ªä¸šåŠ¡æµç¨‹"
   
2. æŠ•ç¥¨é˜¶æ®µï¼ˆVotingï¼‰  
   å¼ ä¸‰ã€æŽå››ã€çŽ‹äº”ä¸‰äººæŠ•ç¥¨
   éœ€è¦è‡³å°‘2äººåŒæ„ï¼ˆå¤šæ•°åŒæ„ï¼‰
   
3. å†³ç­–é˜¶æ®µï¼ˆDecisionï¼‰
   å¦‚æžœå¾—åˆ°å¤šæ•°åŒæ„ï¼Œå†³ç­–ç”Ÿæ•ˆ
   å¦‚æžœæ²¡æœ‰ï¼Œå†³ç­–å¤±æ•ˆ

æ•°æ®åº“çš„ä¸€è‡´æ€§ç®—æ³•å°±æ˜¯ç±»ä¼¼çš„æŠ•ç¥¨è¿‡ç¨‹ï¼
```

**âš™ï¸ äº‹åŠ¡æäº¤çš„å…±è¯†è¿‡ç¨‹**

```
äº‹åŠ¡æäº¤çš„ç¾¤ä½“å†³ç­–ï¼š

æ­¥éª¤1ï¼šäº‹åŠ¡å‡†å¤‡
èŠ‚ç‚¹1æŽ¥æ”¶åˆ°å†™æ“ä½œ â†’ ç”Ÿæˆäº‹åŠ¡æ—¥å¿—

æ­¥éª¤2ï¼šå¹¿æ’­ææ¡ˆ  
èŠ‚ç‚¹1å‘èŠ‚ç‚¹2ã€èŠ‚ç‚¹3å‘é€ï¼š
"æˆ‘è¦æäº¤è¿™ä¸ªäº‹åŠ¡ï¼Œä½ ä»¬åŒæ„å—ï¼Ÿ"

æ­¥éª¤3ï¼šèŠ‚ç‚¹æŠ•ç¥¨
èŠ‚ç‚¹2æ£€æŸ¥äº‹åŠ¡ â†’ åŒæ„ âœ…
èŠ‚ç‚¹3æ£€æŸ¥äº‹åŠ¡ â†’ åŒæ„ âœ…

æ­¥éª¤4ï¼šæäº¤å†³ç­–
æ”¶åˆ°å¤šæ•°åŒæ„(2/3) â†’ æ‰€æœ‰èŠ‚ç‚¹æäº¤äº‹åŠ¡
æ”¶åˆ°å°‘æ•°åŒæ„(1/3) â†’ æ‰€æœ‰èŠ‚ç‚¹å›žæ»šäº‹åŠ¡
```

### 5.3 å†²çªæ£€æµ‹ä¸Žè§£å†³


**âš¡ å¹¶å‘å†²çªåœºæ™¯**

```
å¹¶å‘å†²çªç¤ºä¾‹ï¼š

æ—¶é—´ç‚¹1ï¼š
ç”¨æˆ·Aåœ¨èŠ‚ç‚¹1ï¼šUPDATE å•†å“è¡¨ SET åº“å­˜=åº“å­˜-1 WHERE ID=100
ç”¨æˆ·Båœ¨èŠ‚ç‚¹2ï¼šUPDATE å•†å“è¡¨ SET åº“å­˜=åº“å­˜-1 WHERE ID=100

é—®é¢˜ï¼šä¸¤ä¸ªç”¨æˆ·åŒæ—¶è´­ä¹°æœ€åŽä¸€ä»¶å•†å“
```

**ðŸ”§ å†²çªæ£€æµ‹æœºåˆ¶**

```
å†²çªæ£€æµ‹æµç¨‹ï¼š

1. äº‹åŠ¡æ‰§è¡Œæ—¶è®°å½•è®¿é—®çš„æ•°æ®è¡Œ
2. æäº¤æ—¶æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–äº‹åŠ¡ä¿®æ”¹äº†ç›¸åŒæ•°æ®  
3. å¦‚æžœæœ‰å†²çªï¼š
   - å…ˆæäº¤çš„äº‹åŠ¡æˆåŠŸ
   - åŽæäº¤çš„äº‹åŠ¡å›žæ»šé‡è¯•
4. åº”ç”¨ç¨‹åºæ”¶åˆ°é‡è¯•ä¿¡å·ï¼Œé‡æ–°æ‰§è¡Œä¸šåŠ¡é€»è¾‘
```

**ðŸ“‹ å†²çªè§£å†³ç­–ç•¥**

| **å†²çªç±»åž‹** | **æ£€æµ‹æ–¹å¼** | **è§£å†³æ–¹æ¡ˆ** |
|-------------|-------------|-------------|
| **å†™-å†™å†²çª** | `è¡Œçº§é”æ£€æµ‹` | `ç¬¬ä¸€ä¸ªæˆåŠŸï¼Œç¬¬äºŒä¸ªå›žæ»š` |
| **è¯»-å†™å†²çª** | `ç‰ˆæœ¬å·æ£€æµ‹` | `è¯»æ“ä½œä½¿ç”¨å¿«ç…§ç‰ˆæœ¬` |
| **DDLå†²çª** | `å…¨å±€åºåˆ—å·` | `ä¸²è¡Œæ‰§è¡ŒDDLæ“ä½œ` |

### 5.4 ä¸€è‡´æ€§çº§åˆ«é…ç½®


**âš™ï¸ ä¸€è‡´æ€§å‚æ•°è°ƒä¼˜**

```sql
-- è®¾ç½®ä¸€è‡´æ€§çº§åˆ«ï¼ˆå¸¸ç”¨é…ç½®ï¼‰

-- æœ€å¼ºä¸€è‡´æ€§ï¼ˆé»˜è®¤ï¼‰ï¼šç­‰å¾…æ‰€æœ‰èŠ‚ç‚¹ç¡®è®¤
group_replication_consistency = 'BEFORE_ON_PRIMARY_FAILOVER'

-- å¹³è¡¡æ¨¡å¼ï¼šç­‰å¾…å¤šæ•°èŠ‚ç‚¹ç¡®è®¤  
group_replication_consistency = 'BEFORE'

-- æ€§èƒ½ä¼˜å…ˆï¼šå¼‚æ­¥å¤åˆ¶ï¼Œå¯èƒ½çŸ­æš‚ä¸ä¸€è‡´
group_replication_consistency = 'EVENTUAL'
```

**âš–ï¸ ä¸€è‡´æ€§ä¸Žæ€§èƒ½çš„æƒè¡¡**

- **å¼ºä¸€è‡´æ€§**ï¼šæ•°æ®ç»å¯¹å®‰å…¨ï¼Œä½†æ€§èƒ½ç¨æ…¢
- **æœ€ç»ˆä¸€è‡´æ€§**ï¼šæ€§èƒ½æœ€å¥½ï¼Œä½†æœ‰çŸ­æš‚æ•°æ®å»¶è¿Ÿé£Žé™©
- **å»ºè®®**ï¼šé‡‘èžã€ç”µå•†ç­‰å…³é”®ä¸šåŠ¡ä½¿ç”¨å¼ºä¸€è‡´æ€§

---

## 6. ðŸ—ºï¸ é›†ç¾¤æ‹“æ‰‘ç»“æž„è§£æž


### 6.1 åŸºæœ¬æ‹“æ‰‘ç»“æž„


**ðŸ—ï¸ æ ‡å‡†ä¸‰èŠ‚ç‚¹æ‹“æ‰‘**

```
æ ‡å‡†InnoDB Clusteræ‹“æ‰‘å›¾ï¼š

      åº”ç”¨æœåŠ¡å™¨1        åº”ç”¨æœåŠ¡å™¨2        åº”ç”¨æœåŠ¡å™¨3
           |                  |                  |
           +------------------+------------------+
                              |
                         MySQL Router
                         (ç«¯å£: 6446/6447)
                              |
        +---------------------+---------------------+
        |                     |                     |
   MySQLå®žä¾‹1              MySQLå®žä¾‹2           MySQLå®žä¾‹3
   (Primary)              (Secondary)         (Secondary)
   ç«¯å£: 3306             ç«¯å£: 3306          ç«¯å£: 3306
        |                     |                     |
        +---------------------+---------------------+
              Group Replication é€šä¿¡ (ç«¯å£: 33061)
```

**ðŸ“Š èŠ‚ç‚¹æ•°é‡é€‰æ‹©æŒ‡å—**

| **èŠ‚ç‚¹æ•°** | **å®¹é”™èƒ½åŠ›** | **å†™æ€§èƒ½** | **è¯»æ€§èƒ½** | **é€‚ç”¨åœºæ™¯** |
|-----------|-------------|-----------|-----------|-------------|
| **1ä¸ª** | `æ— å®¹é”™` | `æœ€é«˜` | `ä¸€èˆ¬` | `å¼€å‘æµ‹è¯•` |
| **3ä¸ª** | `å®¹é”™1ä¸ª` | `ä¸­ç­‰` | `å¥½` | `å°åž‹ç”Ÿäº§çŽ¯å¢ƒ` |
| **5ä¸ª** | `å®¹é”™2ä¸ª` | `è¾ƒä½Ž` | `å¾ˆå¥½` | `å¤§åž‹ç”Ÿäº§çŽ¯å¢ƒ` |
| **7ä¸ª** | `å®¹é”™3ä¸ª` | `ä½Ž` | `æžå¥½` | `è¶…å¤§è§„æ¨¡çŽ¯å¢ƒ` |

> **ðŸ’¡ æŽ¨èé…ç½®**ï¼šç”Ÿäº§çŽ¯å¢ƒå»ºè®®ä½¿ç”¨3æˆ–5ä¸ªèŠ‚ç‚¹ï¼Œ3ä¸ªèŠ‚ç‚¹æ€§ä»·æ¯”æœ€é«˜ã€‚

### 6.2 ç½‘ç»œé€šä¿¡æž¶æž„


**ðŸŒ é€šä¿¡ç«¯å£è¯¦è§£**

```
InnoDB Clusterç½‘ç»œé€šä¿¡ç¤ºæ„ï¼š

å®¢æˆ·ç«¯è¿žæŽ¥å±‚ï¼š
åº”ç”¨ç¨‹åº â†â†’ MySQL Router (6446å†™/6447è¯»)

è·¯ç”±åˆ†å‘å±‚ï¼š  
MySQL Router â†â†’ MySQLå®žä¾‹ (3306)

é›†ç¾¤åŒæ­¥å±‚ï¼š
MySQLå®žä¾‹ â†â†’ Group Replication (33061)

ç®¡ç†æŽ§åˆ¶å±‚ï¼š
MySQL Shell â†â†’ MySQLå®žä¾‹ (3306 + ç®¡ç†åè®®)
```

**ðŸ”§ ç«¯å£ç”¨é€”è¯´æ˜Ž**

| **ç«¯å£** | **ç”¨é€”** | **è¿žæŽ¥æ–¹å‘** | **è¯´æ˜Ž** |
|---------|---------|-------------|---------|
| **3306** | `MySQLæ ‡å‡†ç«¯å£` | `Router â†” MySQLå®žä¾‹` | `SQLæŸ¥è¯¢å’Œäº‹åŠ¡å¤„ç†` |
| **33061** | `Group Replication` | `MySQLå®žä¾‹ â†” MySQLå®žä¾‹` | `é›†ç¾¤å†…éƒ¨æ•°æ®åŒæ­¥` |
| **6446** | `Routerè¯»å†™ç«¯å£` | `åº”ç”¨ â†” Router` | `è¯»å†™è¯·æ±‚ç»Ÿä¸€å…¥å£` |
| **6447** | `Routeråªè¯»ç«¯å£` | `åº”ç”¨ â†” Router` | `åªè¯»è¯·æ±‚ä¸“ç”¨å…¥å£` |

### 6.3 åœ°ç†åˆ†å¸ƒå¼éƒ¨ç½²


**ðŸŒ è·¨æœºæˆ¿éƒ¨ç½²ç­–ç•¥**

```
å¤šæœºæˆ¿å®¹ç¾æ‹“æ‰‘ï¼š

æœºæˆ¿A (ä¸»æœºæˆ¿)              æœºæˆ¿B (å¤‡æœºæˆ¿)              æœºæˆ¿C (å¤‡æœºæˆ¿)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MySQLå®žä¾‹1     â”‚        â”‚  MySQLå®žä¾‹2     â”‚        â”‚  MySQLå®žä¾‹3     â”‚
â”‚  (Primary)      â”‚ â†â”€â”€â”€â”€â†’ â”‚  (Secondary)    â”‚ â†â”€â”€â”€â”€â†’ â”‚  (Secondary)    â”‚
â”‚  Routerä¸»å®žä¾‹   â”‚        â”‚  Routerå¤‡å®žä¾‹   â”‚        â”‚  Routerå¤‡å®žä¾‹   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†‘                          â†‘                          â†‘
    æœ¬åœ°åº”ç”¨è®¿é—®              å¤‡ç”¨åº”ç”¨è®¿é—®              ç¾å¤‡åº”ç”¨è®¿é—®

ä¼˜åŠ¿ï¼š
âœ… å•æœºæˆ¿æ•…éšœä¸å½±å“æœåŠ¡
âœ… ç½‘ç»œåˆ†åŒºæ—¶ä¿æŒå¯ç”¨
âœ… å°±è¿‘è®¿é—®é™ä½Žå»¶è¿Ÿ
```

**âš ï¸ è·¨æœºæˆ¿éƒ¨ç½²æ³¨æ„äº‹é¡¹**

- **ç½‘ç»œå»¶è¿Ÿ**ï¼šæœºæˆ¿é—´å»¶è¿Ÿåº”å°äºŽ10msï¼Œå¦åˆ™å½±å“æ€§èƒ½
- **ç½‘ç»œç¨³å®šæ€§**ï¼šéœ€è¦ä¸“çº¿è¿žæŽ¥ï¼Œé¿å…å…¬ç½‘ä¸ç¨³å®š
- **æ—¶é’ŸåŒæ­¥**ï¼šå„æœºæˆ¿æœåŠ¡å™¨æ—¶é—´å¿…é¡»åŒæ­¥
- **åˆ†åŒºå®¹å¿**ï¼šè®¾è®¡æ—¶è€ƒè™‘ç½‘ç»œåˆ†åŒºåœºæ™¯

### 6.4 æ‰©å±•æ€§æž¶æž„è®¾è®¡


**ðŸ“ˆ é›†ç¾¤æ‰©å±•æ–¹æ¡ˆ**

```
é›†ç¾¤æ‰©å±•æ¼”è¿›è·¯å¾„ï¼š

é˜¶æ®µ1ï¼šèµ·æ­¥é…ç½® (3èŠ‚ç‚¹)
MySQL1(P) + MySQL2(S) + MySQL3(S)

é˜¶æ®µ2ï¼šè¯»æ€§èƒ½æ‰©å±• (5èŠ‚ç‚¹)  
MySQL1(P) + MySQL2(S) + MySQL3(S) + MySQL4(S) + MySQL5(S)

é˜¶æ®µ3ï¼šåœ°åŸŸåˆ†å¸ƒ (å¤šåœ°å¤šæ´»)
åŒ—äº¬: MySQL1(P) + MySQL2(S)
ä¸Šæµ·: MySQL3(S) + MySQL4(S)  
æ·±åœ³: MySQL5(S) + MySQL6(S)

é˜¶æ®µ4ï¼šè¯»å†™åˆ†ç¦»ä¼˜åŒ–
ä¸»å†™é›†ç¾¤: 3ä¸ªèŠ‚ç‚¹ä¸“é—¨å¤„ç†å†™æ“ä½œ
åªè¯»é›†ç¾¤: å¤šä¸ªèŠ‚ç‚¹ä¸“é—¨å¤„ç†è¯»æ“ä½œ
```

**ðŸ”§ æ‰©å±•æ“ä½œç®€åŒ–æµç¨‹**

```javascript
// MySQL Shellä¸­æ·»åŠ èŠ‚ç‚¹
var cluster = dba.getCluster()

// åœ¨çº¿æ·»åŠ æ–°èŠ‚ç‚¹ï¼ˆæ— æœåŠ¡ä¸­æ–­ï¼‰
cluster.addInstance('newnode:3306')

// è‡ªåŠ¨æ•°æ®åŒæ­¥ï¼ŒèŠ‚ç‚¹è‡ªåŠ¨åŠ å…¥é›†ç¾¤
// æ‰©å®¹å®Œæˆï¼Œç«‹å³åˆ†æ‹…è¯»å–è´Ÿè½½
```

---

## 7. âš”ï¸ ä¸Žä¼ ç»Ÿå¤åˆ¶æ–¹æ¡ˆå¯¹æ¯”


### 7.1 ä¼ ç»Ÿä¸»ä»Žå¤åˆ¶å›žé¡¾


**ðŸ“š ä¼ ç»Ÿä¸»ä»Žå¤åˆ¶çš„å·¥ä½œæ–¹å¼**

```
ä¼ ç»Ÿä¸»ä»Žå¤åˆ¶æž¶æž„ï¼š

        åº”ç”¨ç¨‹åº
           |
    +------+------+
    |             |
  å†™æ“ä½œ        è¯»æ“ä½œ
    |             |
   ä¸»åº“ ---------> ä»Žåº“1
    |      binlog  |
    +-----------> ä»Žåº“2
           binlog  |
    +-----------> ä»Žåº“3
           binlog

ç‰¹ç‚¹ï¼š
- ä¸»åº“å¤„ç†å†™æ“ä½œ
- ä»Žåº“å¤„ç†è¯»æ“ä½œ  
- é€šè¿‡binlogå¼‚æ­¥å¤åˆ¶
```

**ðŸ¤” ä¼ ç»Ÿæ–¹æ¡ˆçš„æ ¸å¿ƒé—®é¢˜**

| **é—®é¢˜** | **å…·ä½“è¡¨çŽ°** | **ä¸šåŠ¡å½±å“** |
|---------|-------------|-------------|
| **å•ç‚¹å†™å…¥** | `åªæœ‰ä¸»åº“èƒ½å†™ï¼Œæˆä¸ºç“¶é¢ˆ` | `é«˜å¹¶å‘å†™å…¥æ—¶æ€§èƒ½å·®` |
| **æ•…éšœåˆ‡æ¢å¤æ‚** | `éœ€è¦æ‰‹åŠ¨æå‡ä»Žåº“ä¸ºä¸»åº“` | `æ•…éšœæ¢å¤æ—¶é—´é•¿ï¼Œå¯èƒ½ä¸¢æ•°æ®` |
| **æ•°æ®å»¶è¿Ÿ** | `ä»Žåº“æ•°æ®å¯èƒ½è½åŽä¸»åº“` | `è¯»åˆ°è¿‡æœŸæ•°æ®ï¼Œä¸šåŠ¡é€»è¾‘é”™è¯¯` |
| **æ‰©å±•æ€§å·®** | `å†™èƒ½åŠ›æ— æ³•æ°´å¹³æ‰©å±•` | `ä¸šåŠ¡å¢žé•¿æ—¶éš¾ä»¥åº”å¯¹` |

### 7.2 InnoDB Clusterçš„é©å‘½æ€§æ”¹è¿›


**ðŸš€ æ ¸å¿ƒæ”¹è¿›å¯¹æ¯”**

```
æ”¹è¿›å¯¹æ¯”ä¸€è§ˆè¡¨ï¼š

æ–¹é¢              ä¼ ç»Ÿä¸»ä»Žå¤åˆ¶              InnoDB Cluster
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å†™å…¥èƒ½åŠ›          å•ç‚¹å†™å…¥                  å¤šç‚¹å†™å…¥
æ•…éšœæ¢å¤          æ‰‹åŠ¨åˆ‡æ¢(åˆ†é’Ÿçº§)          è‡ªåŠ¨åˆ‡æ¢(ç§’çº§)  
æ•°æ®ä¸€è‡´æ€§        å¯èƒ½ä¸ä¸€è‡´                å¼ºä¸€è‡´æ€§ä¿è¯
æ‰©å±•æ–¹å¼          åž‚ç›´æ‰©å±•                  æ°´å¹³æ‰©å±•
è¿ç»´å¤æ‚åº¦        éœ€è¦DBAä¸“ä¸šæŠ€èƒ½           è‡ªåŠ¨åŒ–è¿ç»´
æ•°æ®å®‰å…¨          ä¾èµ–å¤‡ä»½                  å¤šå‰¯æœ¬å®žæ—¶ä¿æŠ¤
```

**ðŸ’¡ è¯¦ç»†å¯¹æ¯”è¯´æ˜Ž**

**å†™å…¥èƒ½åŠ›å¯¹æ¯”ï¼š**
```
ä¼ ç»Ÿæ–¹æ¡ˆï¼š
æ‰€æœ‰å†™æ“ä½œ â†’ ä¸»åº“ (å•ç‚¹åŽ‹åŠ›)

InnoDB Clusterï¼š
å†™æ“ä½œ1 â†’ èŠ‚ç‚¹1
å†™æ“ä½œ2 â†’ èŠ‚ç‚¹2  (è´Ÿè½½åˆ†æ•£)
å†™æ“ä½œ3 â†’ èŠ‚ç‚¹3
```

**æ•…éšœæ¢å¤å¯¹æ¯”ï¼š**
```
ä¼ ç»Ÿæ–¹æ¡ˆæ•…éšœæ¢å¤ï¼š
1. å‘çŽ°ä¸»åº“æ•…éšœ (äººå·¥å‘çŽ°ï¼Œå¯èƒ½å‡ åˆ†é’Ÿ)
2. é€‰æ‹©ä»Žåº“æå‡ (äººå·¥å†³ç­–)
3. ä¿®æ”¹åº”ç”¨é…ç½® (åœæœåŠ¡ï¼Œæ”¹é…ç½®)
4. é‡å¯åº”ç”¨æœåŠ¡ (ä¸šåŠ¡ä¸­æ–­)
æ€»æ—¶é—´ï¼š10-30åˆ†é’Ÿ

InnoDB Clusteræ•…éšœæ¢å¤ï¼š
1. è‡ªåŠ¨æ£€æµ‹æ•…éšœ (5-15ç§’)
2. è‡ªåŠ¨é€‰ä¸¾æ–°Primary (1-2ç§’)
3. Routerè‡ªåŠ¨åˆ‡æ¢ (1-2ç§’)  
4. åº”ç”¨é€æ˜Žé‡è¿ž (2-3ç§’)
æ€»æ—¶é—´ï¼š10-20ç§’
```

### 7.3 é€‚ç”¨åœºæ™¯å¯¹æ¯”


**ðŸŽ¯ æ–¹æ¡ˆé€‰æ‹©æŒ‡å¯¼**

| **åœºæ™¯** | **æŽ¨èæ–¹æ¡ˆ** | **ç†ç”±** |
|---------|-------------|---------|
| **å°åž‹ç½‘ç«™** | `ä¼ ç»Ÿä¸»ä»Žå¤åˆ¶` | `æž¶æž„ç®€å•ï¼Œæˆæœ¬ä½Žï¼Œæ»¡è¶³åŸºæœ¬éœ€æ±‚` |
| **ä¸­åž‹ä¼ä¸šåº”ç”¨** | `InnoDB Cluster` | `è‡ªåŠ¨åŒ–è¿ç»´ï¼Œå¯é æ€§é«˜` |
| **å¤§åž‹ç”µå•†å¹³å°** | `InnoDB Cluster` | `é«˜å¯ç”¨è¦æ±‚ï¼Œè‡ªåŠ¨æ•…éšœè½¬ç§»` |
| **é‡‘èžäº¤æ˜“ç³»ç»Ÿ** | `InnoDB Cluster` | `æ•°æ®ä¸€è‡´æ€§è¦æ±‚ï¼Œé›¶ä¸¢å¤±å®¹å¿` |
| **æ•°æ®åˆ†æžç³»ç»Ÿ** | `ä¼ ç»Ÿä¸»ä»Žå¤åˆ¶` | `è¯»å¤šå†™å°‘ï¼Œå¯¹ä¸€è‡´æ€§è¦æ±‚ä¸é«˜` |

### 7.4 è¿ç§»è€ƒè™‘å› ç´ 


**ðŸ”„ ä»Žä¼ ç»Ÿå¤åˆ¶è¿ç§»åˆ°InnoDB Cluster**

**ä¼˜åŠ¿æ”¶ç›Šï¼š**
- âœ… **å¯ç”¨æ€§æå‡**ï¼šä»Ž99%æå‡åˆ°99.99%
- âœ… **è¿ç»´æ•ˆçŽ‡**ï¼šäººå·¥è¿ç»´å˜ä¸ºè‡ªåŠ¨åŒ–
- âœ… **æ€§èƒ½æ”¹å–„**ï¼šå†™å…¥èƒ½åŠ›æ°´å¹³æ‰©å±•
- âœ… **æ•°æ®å®‰å…¨**ï¼šå¼ºä¸€è‡´æ€§ä¿è¯

**è¿ç§»æˆæœ¬ï¼š**
- ðŸ’° **ç¡¬ä»¶æˆæœ¬**ï¼šè‡³å°‘éœ€è¦3å°æœåŠ¡å™¨
- ðŸ“š **å­¦ä¹ æˆæœ¬**ï¼šå›¢é˜Ÿéœ€è¦å­¦ä¹ æ–°æŠ€æœ¯
- â±ï¸ **è¿ç§»æ—¶é—´**ï¼šä¸šåŠ¡è¿ç§»éœ€è¦è§„åˆ’çª—å£
- ðŸ”§ **åº”ç”¨æ”¹é€ **ï¼šå¯èƒ½éœ€è¦ä¿®æ”¹è¿žæŽ¥æ–¹å¼

**ðŸŽ¯ è¿ç§»å†³ç­–å»ºè®®**

```
è¯„ä¼°æ¸…å•ï¼š

ä¸šåŠ¡éœ€æ±‚è¯„ä¼°ï¼š
â–¡ å¯ç”¨æ€§è¦æ±‚ > 99.9%ï¼Ÿ
â–¡ å†™å…¥åŽ‹åŠ›æŒç»­å¢žé•¿ï¼Ÿ
â–¡ éœ€è¦è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼Ÿ
â–¡ æ•°æ®ä¸€è‡´æ€§è¦æ±‚ä¸¥æ ¼ï¼Ÿ

æŠ€æœ¯èµ„æºè¯„ä¼°ï¼š  
â–¡ æœ‰è¶³å¤Ÿçš„ç¡¬ä»¶èµ„æºï¼Ÿ
â–¡ å›¢é˜Ÿå…·å¤‡å­¦ä¹ èƒ½åŠ›ï¼Ÿ
â–¡ æœ‰è¿ç§»çª—å£æ—¶é—´ï¼Ÿ
â–¡ æœ‰å›žæ»šé¢„æ¡ˆï¼Ÿ

å¦‚æžœå¤šæ•°ç­”æ¡ˆæ˜¯"æ˜¯"ï¼Œå»ºè®®è¿ç§»åˆ°InnoDB Cluster
```

---

## 8. ðŸŽ¯ é€‚ç”¨åœºæ™¯ä¸Žä¸šåŠ¡ä»·å€¼


### 8.1 ç†æƒ³é€‚ç”¨åœºæ™¯


**ðŸ† æœ€ä½³é€‚ç”¨åœºæ™¯åˆ†æž**

**ç”µå•†å¹³å°æ¡ˆä¾‹ï¼š**
```
ä¸šåŠ¡ç‰¹ç‚¹ï¼š
- 7Ã—24å°æ—¶è¿è¥ï¼Œä¸èƒ½åœæœº
- åŒ11ç­‰ä¿ƒé”€æœŸé—´æµé‡æš´å¢ž
- è®¢å•æ•°æ®ç»å¯¹ä¸èƒ½ä¸¢å¤±
- ç”¨æˆ·ä½“éªŒè¦æ±‚å¾ˆé«˜

InnoDB Clusterä»·å€¼ï¼š
âœ… è‡ªåŠ¨æ•…éšœè½¬ç§» â†’ ä¿ƒé”€æœŸé—´æœåŠ¡ç¨³å®š
âœ… æ°´å¹³æ‰©å±•èƒ½åŠ› â†’ åº”å¯¹æµé‡é«˜å³°
âœ… å¼ºä¸€è‡´æ€§ â†’ è®¢å•æ•°æ®å®‰å…¨
âœ… è´Ÿè½½å‡è¡¡ â†’ ç”¨æˆ·è®¿é—®ä½“éªŒå¥½
```

**é‡‘èžç³»ç»Ÿæ¡ˆä¾‹ï¼š**
```
ä¸šåŠ¡ç‰¹ç‚¹ï¼š
- äº¤æ˜“æ•°æ®å…³ç³»åˆ°å®¢æˆ·èµ„é‡‘å®‰å…¨
- ç›‘ç®¡è¦æ±‚é«˜å¯ç”¨ã€é«˜å®‰å…¨
- å¯¹æ•°æ®ä¸€è‡´æ€§è¦æ±‚æžå…¶ä¸¥æ ¼
- æ•…éšœå½±å“å·¨å¤§ï¼Œå®¹å¿åº¦ä¸ºé›¶

InnoDB Clusterä»·å€¼ï¼š
âœ… é›¶æ•°æ®ä¸¢å¤± â†’ æ»¡è¶³ç›‘ç®¡è¦æ±‚
âœ… ç§’çº§æ•…éšœæ¢å¤ â†’ å‡å°‘ä¸šåŠ¡æŸå¤±
âœ… å¤šå‰¯æœ¬ä¿æŠ¤ â†’ æ•°æ®å®‰å…¨å¯é 
âœ… è‡ªåŠ¨åŒ–è¿ç»´ â†’ é™ä½Žäººä¸ºé”™è¯¯é£Žé™©
```

### 8.2 é€‚ç”¨æ€§è¯„ä¼°æ ‡å‡†


**ðŸ“Š é€‚ç”¨æ€§è¯„ä¼°çŸ©é˜µ**

| **è¯„ä¼°ç»´åº¦** | **é«˜åº¦é€‚ç”¨** | **ä¸­åº¦é€‚ç”¨** | **ä¸å¤ªé€‚ç”¨** |
|-------------|-------------|-------------|-------------|
| **å¯ç”¨æ€§è¦æ±‚** | `>99.9%` | `99%-99.9%` | `<99%` |
| **æ•°æ®é‡è¦æ€§** | `æ ¸å¿ƒä¸šåŠ¡æ•°æ®` | `é‡è¦ä¸šåŠ¡æ•°æ®` | `æ—¥å¿—ã€ç¼“å­˜æ•°æ®` |
| **å¹¶å‘å†™å…¥é‡** | `é«˜å¹¶å‘å†™å…¥` | `ä¸­ç­‰å¹¶å‘` | `è¯»å¤šå†™å°‘` |
| **æ•…éšœå®¹å¿åº¦** | `åˆ†é’Ÿçº§ä¸å¯æŽ¥å—` | `å°æ—¶çº§å¯æŽ¥å—` | `å¤©çº§å¯æŽ¥å—` |
| **æŠ€æœ¯å›¢é˜Ÿ** | `æœ‰DBAæˆ–è¿ç»´` | `æœ‰ä¸€å®šæŠ€æœ¯èƒ½åŠ›` | `æŠ€æœ¯èƒ½åŠ›æœ‰é™` |
| **ç¡¬ä»¶é¢„ç®—** | `å……è¶³` | `ä¸­ç­‰` | `æœ‰é™` |

**ðŸŽ¯ é€‚ç”¨åœºæ™¯æ€»ç»“**

```
å¼ºçƒˆæŽ¨èï¼š
ðŸ¦ é“¶è¡Œæ ¸å¿ƒç³»ç»Ÿ
ðŸ›’ ç”µå•†äº¤æ˜“å¹³å°  
ðŸ“± ç¤¾äº¤åª’ä½“å¹³å°
ðŸŽ® åœ¨çº¿æ¸¸æˆç³»ç»Ÿ
ðŸ“Š å®žæ—¶æ•°æ®å¹³å°

ä¸­ç­‰æŽ¨èï¼š
ðŸ“° æ–°é—»é—¨æˆ·ç½‘ç«™
ðŸ¢ ä¼ä¸šç®¡ç†ç³»ç»Ÿ
ðŸ“š åœ¨çº¿æ•™è‚²å¹³å°
ðŸ¥ åŒ»é™¢ä¿¡æ¯ç³»ç»Ÿ

ä¸å¤ªæŽ¨èï¼š
ðŸ“ ä¸ªäººåšå®¢ç½‘ç«™
ðŸ”§ å†…éƒ¨å·¥å…·ç³»ç»Ÿ
ðŸ“Š ç¦»çº¿æ•°æ®åˆ†æž
ðŸ§ª å¼€å‘æµ‹è¯•çŽ¯å¢ƒ
```

### 8.3 ä¸šåŠ¡ä»·å€¼é‡åŒ–


**ðŸ’° ç›´æŽ¥ç»æµŽä»·å€¼**

```
æˆæœ¬æ•ˆç›Šåˆ†æžæ¡ˆä¾‹ï¼š

æŸç”µå•†å¹³å°å¹´äº¤æ˜“é¢ï¼š10äº¿å…ƒ
ç³»ç»Ÿå¯ç”¨æ€§ï¼šä»Ž99%æå‡åˆ°99.99%

åœæœºæ—¶é—´å‡å°‘ï¼š
99%å¯ç”¨æ€§ï¼šå¹´åœæœº87.6å°æ—¶
99.99%å¯ç”¨æ€§ï¼šå¹´åœæœº0.9å°æ—¶
å‡å°‘åœæœºï¼š86.7å°æ—¶

ä¸šåŠ¡æŸå¤±å‡å°‘ï¼š
æŒ‰å¹³å‡æ—¶äº¤æ˜“é¢è®¡ç®—ï¼š10äº¿Ã·(365Ã—24) â‰ˆ 114ä¸‡/å°æ—¶
å¹´å‡å°‘æŸå¤±ï¼š86.7 Ã— 114ä¸‡ â‰ˆ 9,884ä¸‡å…ƒ

æŠ•å…¥æˆæœ¬ï¼š
InnoDB Clusterå»ºè®¾ï¼šçº¦100ä¸‡å…ƒ
å¹´è¿ç»´æˆæœ¬ï¼šçº¦50ä¸‡å…ƒ

æŠ•èµ„å›žæŠ¥çŽ‡ï¼š(9,884-150)Ã·150 = 6,489%
```

**ðŸ“ˆ é—´æŽ¥ä¸šåŠ¡ä»·å€¼**

| **ä»·å€¼ç»´åº¦** | **ä¼ ç»Ÿæ–¹æ¡ˆ** | **InnoDB Cluster** | **æå‡æ•ˆæžœ** |
|-------------|-------------|------------------|-------------|
| **å®¢æˆ·æ»¡æ„åº¦** | `æ•…éšœå½±å“ä½“éªŒ` | `æœåŠ¡ç¨³å®šå¯é ` | `ç”¨æˆ·ç•™å­˜çŽ‡+15%` |
| **è¿ç»´æ•ˆçŽ‡** | `äººå·¥å€¼ç­ç›‘æŽ§` | `è‡ªåŠ¨åŒ–è¿ç»´` | `è¿ç»´æˆæœ¬-60%` |
| **ä¸šåŠ¡æ‰©å±•** | `æ‰©å®¹å¤æ‚è€—æ—¶` | `åœ¨çº¿å¿«é€Ÿæ‰©å®¹` | `å¸‚åœºå“åº”é€Ÿåº¦+50%` |
| **åˆè§„é£Žé™©** | `æ•°æ®ä¸¢å¤±é£Žé™©` | `å¼ºä¸€è‡´æ€§ä¿è¯` | `ç›‘ç®¡é£Žé™©é™ä½Ž` |

### 8.4 æˆåŠŸæ¡ˆä¾‹å‚è€ƒ


**ðŸ† çŸ¥åä¼ä¸šåº”ç”¨æ¡ˆä¾‹**

**æ¡ˆä¾‹1ï¼šæŸå¤§åž‹é“¶è¡Œ**
```
èƒŒæ™¯ï¼šæ ¸å¿ƒè´¦åŠ¡ç³»ç»Ÿï¼Œæ—¥äº¤æ˜“é‡åƒä¸‡ç¬”
æŒ‘æˆ˜ï¼šä¼ ç»Ÿæž¶æž„æ•…éšœåˆ‡æ¢éœ€20åˆ†é’Ÿï¼Œç›‘ç®¡ä¸æ»¡æ„
æ–¹æ¡ˆï¼šéƒ¨ç½²InnoDB Clusterä¸‰èŠ‚ç‚¹é›†ç¾¤
æ•ˆæžœï¼š
- æ•…éšœåˆ‡æ¢æ—¶é—´ï¼š20åˆ†é’Ÿ â†’ 30ç§’
- ç³»ç»Ÿå¯ç”¨æ€§ï¼š99.5% â†’ 99.99%
- ç›‘ç®¡è¯„ä¼°ï¼šä»ŽCçº§æå‡åˆ°Açº§
```

**æ¡ˆä¾‹2ï¼šæŸç”µå•†å¹³å°**
```
èƒŒæ™¯ï¼šåŒ11æµé‡å³°å€¼ï¼Œä¼ ç»Ÿæž¶æž„æ‰›ä¸ä½
æŒ‘æˆ˜ï¼šå†™å…¥åŽ‹åŠ›é›†ä¸­åœ¨ä¸»åº“ï¼Œæ€§èƒ½ç“¶é¢ˆæ˜Žæ˜¾
æ–¹æ¡ˆï¼šInnoDB Cluster + è¯»å†™åˆ†ç¦»
æ•ˆæžœï¼š
- å†™å…¥æ€§èƒ½ï¼šæå‡200%
- æ•…éšœé›¶åˆ‡æ¢ï¼šåŒ11æœŸé—´é›¶æ•…éšœ
- ç”¨æˆ·ä½“éªŒï¼šå“åº”æ—¶é—´ç¼©çŸ­50%
```

**æ¡ˆä¾‹3ï¼šæŸæ¸¸æˆå…¬å¸**
```
èƒŒæ™¯ï¼šå®žæ—¶æ¸¸æˆæ•°æ®ï¼ŒçŽ©å®¶å¯¹å»¶è¿Ÿæ•æ„Ÿ
æŒ‘æˆ˜ï¼šæ•°æ®åº“æ•…éšœç›´æŽ¥å¯¼è‡´æ¸¸æˆä¸å¯çŽ©
æ–¹æ¡ˆï¼šè·¨æœºæˆ¿InnoDB Clusteréƒ¨ç½²
æ•ˆæžœï¼š
- æœåŠ¡å¯ç”¨æ€§ï¼š99.95% â†’ 99.99%
- çŽ©å®¶æŠ•è¯‰ï¼šå‡å°‘80%
- æ”¶å…¥ä¿éšœï¼šé¿å…åœæœºæŸå¤±2000ä¸‡å…ƒ/å¹´
```

### 8.5 æŠ•èµ„å†³ç­–æŒ‡å¯¼


**ðŸ’¼ å†³ç­–è€ƒè™‘æ¡†æž¶**

```
æŠ•èµ„å†³ç­–æµç¨‹ï¼š

ç¬¬ä¸€æ­¥ï¼šä¸šåŠ¡éœ€æ±‚è¯„ä¼°
â–¡ å½“å‰ç³»ç»Ÿå¯ç”¨æ€§æ˜¯å¦æ»¡è¶³ä¸šåŠ¡è¦æ±‚ï¼Ÿ
â–¡ æ˜¯å¦ç»å¸¸å› ä¸ºæ•°æ®åº“é—®é¢˜å½±å“ä¸šåŠ¡ï¼Ÿ
â–¡ æœªæ¥3å¹´ä¸šåŠ¡å¢žé•¿é¢„æœŸå¦‚ä½•ï¼Ÿ

ç¬¬äºŒæ­¥ï¼šæŠ€æœ¯å¯è¡Œæ€§è¯„ä¼°  
â–¡ çŽ°æœ‰å›¢é˜Ÿæ˜¯å¦å…·å¤‡å®žæ–½èƒ½åŠ›ï¼Ÿ
â–¡ ç¡¬ä»¶èµ„æºæ˜¯å¦è¶³å¤Ÿï¼Ÿ
â–¡ æ˜¯å¦æœ‰åˆé€‚çš„è¿ç§»çª—å£ï¼Ÿ

ç¬¬ä¸‰æ­¥ï¼šæˆæœ¬æ•ˆç›Šåˆ†æž
â–¡ æŠ•å…¥æˆæœ¬vsé¢„æœŸæ”¶ç›Š
â–¡ é£Žé™©æˆæœ¬vsä¿éšœä»·å€¼
â–¡ äººåŠ›æˆæœ¬vsè‡ªåŠ¨åŒ–æ”¶ç›Š

ç¬¬å››æ­¥ï¼šå®žæ–½ç­–ç•¥è§„åˆ’
â–¡ åˆ†é˜¶æ®µå®žæ–½è¿˜æ˜¯ä¸€æ¬¡æ€§åˆ‡æ¢ï¼Ÿ
â–¡ è¯•ç‚¹éªŒè¯è¿˜æ˜¯å…¨é¢éƒ¨ç½²ï¼Ÿ
â–¡ åŸ¹è®­è®¡åˆ’å’Œåº”æ€¥é¢„æ¡ˆæ˜¯å¦å®Œå¤‡ï¼Ÿ
```

**ðŸŽ¯ å†³ç­–å»ºè®®**

- **ç«‹å³æŽ¨è¿›**ï¼šæ ¸å¿ƒä¸šåŠ¡ç³»ç»Ÿï¼ŒåœæœºæŸå¤±å·¨å¤§
- **è®¡åˆ’æŽ¨è¿›**ï¼šé‡è¦ä¸šåŠ¡ç³»ç»Ÿï¼Œæœ‰æ˜Žç¡®ROI
- **è§‚æœ›è¯„ä¼°**ï¼šéžæ ¸å¿ƒç³»ç»Ÿï¼Œå¯å…ˆè¯•ç‚¹éªŒè¯
- **æš‚ä¸è€ƒè™‘**ï¼šç®€å•ä¸šåŠ¡ç³»ç»Ÿï¼Œä¼ ç»Ÿæ–¹æ¡ˆè¶³å¤Ÿ

---

## 9. ðŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŽŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ðŸ”¸ InnoDB Clusteræœ¬è´¨ï¼šMySQLé«˜å¯ç”¨çš„å®Œæ•´è§£å†³æ–¹æ¡ˆ
ðŸ”¸ ä¸‰å¤§ç»„ä»¶ï¼šGroup Replication(æ•°æ®åŒæ­¥) + Router(æ™ºèƒ½è·¯ç”±) + Shell(ç®¡ç†å·¥å…·)
ðŸ”¸ åˆ†å¸ƒå¼ç‰¹æ€§ï¼šå¤šä¸»æž¶æž„ï¼Œæ°´å¹³æ‰©å±•ï¼Œè‡ªåŠ¨æ•…éšœè½¬ç§»
ðŸ”¸ ä¸€è‡´æ€§ä¿è¯ï¼šå¼ºä¸€è‡´æ€§ï¼Œå…±è¯†ç®—æ³•ï¼Œå†²çªæ£€æµ‹
ðŸ”¸ é«˜å¯ç”¨æœºåˆ¶ï¼šè‡ªåŠ¨æ•…éšœæ£€æµ‹ï¼Œç§’çº§åˆ‡æ¢ï¼Œæ— äººå·¥å¹²é¢„
ðŸ”¸ é€‚ç”¨åœºæ™¯ï¼šé«˜å¯ç”¨è¦æ±‚ï¼Œå¼ºä¸€è‡´æ€§éœ€æ±‚ï¼Œè‡ªåŠ¨åŒ–è¿ç»´
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ðŸ”¹ InnoDB Clusterè§£å†³çš„æ ¸å¿ƒé—®é¢˜**
```
ä¼ ç»Ÿç—›ç‚¹ â†’ InnoDB Clusterè§£å†³æ–¹æ¡ˆï¼š
å•ç‚¹æ•…éšœ â†’ å¤šèŠ‚ç‚¹å†—ä½™ï¼Œè‡ªåŠ¨æ•…éšœè½¬ç§»
æ•°æ®ä¸¢å¤± â†’ å¼ºä¸€è‡´æ€§ä¿è¯ï¼Œå¤šå‰¯æœ¬ä¿æŠ¤  
æ‰©å±•å›°éš¾ â†’ æ°´å¹³æ‰©å±•ï¼Œåœ¨çº¿å¢žå‡èŠ‚ç‚¹
è¿ç»´å¤æ‚ â†’ è‡ªåŠ¨åŒ–ç®¡ç†ï¼Œç®€åŒ–è¿ç»´æ“ä½œ
æ€§èƒ½ç“¶é¢ˆ â†’ è¯»å†™åˆ†ç¦»ï¼Œè´Ÿè½½å‡è¡¡
```

**ðŸ”¹ ä¸Žä¼ ç»Ÿæ–¹æ¡ˆçš„æœ¬è´¨åŒºåˆ«**
```
æž¶æž„ç†å¿µï¼šä»Žä¸»ä»Žæž¶æž„è¿›åŒ–åˆ°å¤šä¸»æž¶æž„
æ•…éšœå¤„ç†ï¼šä»Žäººå·¥è¿ç»´è¿›åŒ–åˆ°è‡ªåŠ¨åŒ–è¿ç»´
æ•°æ®å®‰å…¨ï¼šä»Žå¤‡ä»½æ¢å¤è¿›åŒ–åˆ°å®žæ—¶å¤šå‰¯æœ¬
æ€§èƒ½æ‰©å±•ï¼šä»Žåž‚ç›´æ‰©å±•è¿›åŒ–åˆ°æ°´å¹³æ‰©å±•
```

**ðŸ”¹ æŠ€æœ¯é€‰åž‹çš„å…³é”®å› ç´ **
```
ä¸šåŠ¡é©±åŠ¨ï¼šå¯ç”¨æ€§è¦æ±‚ã€æ•°æ®é‡è¦æ€§ã€å¹¶å‘åŽ‹åŠ›
æŠ€æœ¯æ¡ä»¶ï¼šå›¢é˜Ÿèƒ½åŠ›ã€ç¡¬ä»¶èµ„æºã€è¿ç§»çª—å£
æˆæœ¬è€ƒé‡ï¼šå»ºè®¾æˆæœ¬ã€è¿ç»´æˆæœ¬ã€é£Žé™©æˆæœ¬
```

### 9.3 å®žé™…åº”ç”¨ä»·å€¼


**ðŸ’¼ ä¸šåŠ¡ä»·å€¼å®žçŽ°**
- **å¯ç”¨æ€§æå‡**ï¼šä»Ž99%æå‡åˆ°99.99%ï¼Œå¤§å¹…å‡å°‘åœæœºæŸå¤±
- **æ€§èƒ½æ”¹å–„**ï¼šæ°´å¹³æ‰©å±•å†™å…¥èƒ½åŠ›ï¼Œæ”¯æ’‘ä¸šåŠ¡å¿«é€Ÿå¢žé•¿
- **è¿ç»´ç®€åŒ–**ï¼šè‡ªåŠ¨åŒ–è¿ç»´å‡å°‘äººå·¥æˆæœ¬å’Œäººä¸ºé”™è¯¯
- **é£Žé™©é™ä½Ž**ï¼šå¼ºä¸€è‡´æ€§ä¿è¯æ•°æ®å®‰å…¨ï¼Œæ»¡è¶³åˆè§„è¦æ±‚

**ðŸŽ¯ åº”ç”¨æœ€ä½³å®žè·µ**
- **åœºæ™¯é€‰æ‹©**ï¼šä¼˜å…ˆåº”ç”¨äºŽæ ¸å¿ƒä¸šåŠ¡ç³»ç»Ÿ
- **æž¶æž„è§„åˆ’**ï¼šåˆç†è§„åˆ’èŠ‚ç‚¹æ•°é‡å’Œç½‘ç»œæ‹“æ‰‘
- **è¿ç§»ç­–ç•¥**ï¼šåˆ¶å®šè¯¦ç»†çš„è¿ç§»è®¡åˆ’å’Œå›žæ»šé¢„æ¡ˆ
- **è¿ç»´å‡†å¤‡**ï¼šå»ºç«‹ç›‘æŽ§ä½“ç³»å’Œåº”æ€¥å“åº”æœºåˆ¶

**ðŸ”§ æŠ€æœ¯å®žæ–½è¦ç‚¹**
- **ç¡¬ä»¶é…ç½®**ï¼šä¿è¯è¶³å¤Ÿçš„è®¡ç®—ã€å­˜å‚¨ã€ç½‘ç»œèµ„æº
- **ç½‘ç»œä¼˜åŒ–**ï¼šç¡®ä¿èŠ‚ç‚¹é—´ç½‘ç»œå»¶è¿Ÿå’Œç¨³å®šæ€§
- **å‚æ•°è°ƒä¼˜**ï¼šæ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹è°ƒæ•´ä¸€è‡´æ€§å’Œæ€§èƒ½å‚æ•°
- **ç›‘æŽ§å‘Šè­¦**ï¼šå»ºç«‹å®Œå–„çš„é›†ç¾¤å¥åº·ç›‘æŽ§ä½“ç³»

### 9.4 å­¦ä¹ è¿›é˜¶è·¯å¾„


**ðŸ“š åŽç»­æ·±å…¥å­¦ä¹ æ–¹å‘**
- **éƒ¨ç½²å®žè·µ**ï¼šåŠ¨æ‰‹æ­å»ºæµ‹è¯•çŽ¯å¢ƒï¼Œç†Ÿæ‚‰å®‰è£…é…ç½®
- **è¿ç»´ç®¡ç†**ï¼šå­¦ä¹ æ—¥å¸¸ç®¡ç†ã€ç›‘æŽ§ã€æ•…éšœå¤„ç†
- **æ€§èƒ½è°ƒä¼˜**ï¼šæŽŒæ¡å‚æ•°ä¼˜åŒ–ã€æ€§èƒ½åˆ†æžæ–¹æ³•
- **é«˜çº§ç‰¹æ€§**ï¼šäº†è§£æ–°ç‰ˆæœ¬ç‰¹æ€§ã€æ‰©å±•åŠŸèƒ½

**ðŸš€ æŠ€èƒ½å‘å±•å»ºè®®**
- **ç†è®ºåŸºç¡€**ï¼šæ·±å…¥ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿã€å…±è¯†ç®—æ³•
- **å®žè·µç»éªŒ**ï¼šé€šè¿‡é¡¹ç›®ç§¯ç´¯å®žæˆ˜ç»éªŒ
- **ç”Ÿæ€å­¦ä¹ **ï¼šäº†è§£MySQL 8.0æ–°ç‰¹æ€§ã€äº‘æ•°æ®åº“æœåŠ¡
- **æž¶æž„æ€ç»´**ï¼šåŸ¹å…»é«˜å¯ç”¨æž¶æž„è®¾è®¡èƒ½åŠ›

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
```
ä¸‰ç»„ä»¶åä½œä¿é«˜å¯ç”¨ï¼ŒGroupåŒæ­¥Routerè·¯ç”±Shellç®¡ç†
å¤šä¸»æž¶æž„æ°´å¹³æ‰©å±•å¥½ï¼Œè‡ªåŠ¨æ•…éšœè½¬ç§»ç§’çº§æ¢å¤
å¼ºä¸€è‡´æ€§é›¶æ•°æ®ä¸¢å¤±ï¼Œå…±è¯†ç®—æ³•å†²çªè‡ªåŠ¨è§£å†³
é€‚ç”¨åœºæ™¯æ ¸å¿ƒä¸šåŠ¡ç³»ç»Ÿï¼ŒæŠ•èµ„å›žæŠ¥æ˜¾è‘—æ•ˆæžœæ˜Žæ˜¾
```