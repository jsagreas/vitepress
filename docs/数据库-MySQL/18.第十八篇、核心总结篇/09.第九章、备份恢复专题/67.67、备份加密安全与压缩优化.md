---
title: 67ã€å¤‡ä»½åŠ å¯†å®‰å…¨ä¸å‹ç¼©ä¼˜åŒ–
---
## ğŸ“š ç›®å½•

1. [å¤‡ä»½å®‰å…¨åŸºç¡€æ¦‚å¿µ](#1-å¤‡ä»½å®‰å…¨åŸºç¡€æ¦‚å¿µ)
2. [å¤‡ä»½æ•°æ®åŠ å¯†æŠ€æœ¯](#2-å¤‡ä»½æ•°æ®åŠ å¯†æŠ€æœ¯)
3. [ä¼ è¾“åŠ å¯†ä¸ç½‘ç»œå®‰å…¨](#3-ä¼ è¾“åŠ å¯†ä¸ç½‘ç»œå®‰å…¨)
4. [å­˜å‚¨åŠ å¯†æœºåˆ¶](#4-å­˜å‚¨åŠ å¯†æœºåˆ¶)
5. [å¯†é’¥ç®¡ç†ç­–ç•¥](#5-å¯†é’¥ç®¡ç†ç­–ç•¥)
6. [å¤‡ä»½è®¿é—®æ§åˆ¶ä¸å®¡è®¡](#6-å¤‡ä»½è®¿é—®æ§åˆ¶ä¸å®¡è®¡)
7. [å¤‡ä»½å‹ç¼©æŠ€æœ¯è¯¦è§£](#7-å¤‡ä»½å‹ç¼©æŠ€æœ¯è¯¦è§£)
8. [å‹ç¼©ç®—æ³•é€‰æ‹©ä¸ä¼˜åŒ–](#8-å‹ç¼©ç®—æ³•é€‰æ‹©ä¸ä¼˜åŒ–)
9. [å‹ç¼©æ€§èƒ½å¹³è¡¡ç­–ç•¥](#9-å‹ç¼©æ€§èƒ½å¹³è¡¡ç­–ç•¥)
10. [æµå¼å‹ç¼©å¤‡ä»½å®ç°](#10-æµå¼å‹ç¼©å¤‡ä»½å®ç°)
11. [å­˜å‚¨ç©ºé—´ä¼˜åŒ–æ–¹æ¡ˆ](#11-å­˜å‚¨ç©ºé—´ä¼˜åŒ–æ–¹æ¡ˆ)
12. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#12-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” å¤‡ä»½å®‰å…¨åŸºç¡€æ¦‚å¿µ


### 1.1 ä¸ºä»€ä¹ˆå¤‡ä»½éœ€è¦å®‰å…¨ä¿æŠ¤


**æ ¸å¿ƒé—®é¢˜**ï¼šå¤‡ä»½æ–‡ä»¶åŒ…å«å®Œæ•´æ•°æ®åº“ä¿¡æ¯ï¼Œä¸€æ—¦æ³„éœ²åæœä¸¥é‡

```
æ•°æ®æ³„éœ²é£é™©ï¼š
â€¢ å®¢æˆ·ä¸ªäººä¿¡æ¯æš´éœ²
â€¢ å•†ä¸šæœºå¯†æ•°æ®å¤–æ³„  
â€¢ è´¢åŠ¡äº¤æ˜“è®°å½•æ³„éœ²
â€¢ ç³»ç»Ÿé…ç½®ä¿¡æ¯æš´éœ²

å®‰å…¨å¨èƒæ¥æºï¼š
â€¢ å†…éƒ¨äººå‘˜æ¶æ„è®¿é—®
â€¢ å¤–éƒ¨é»‘å®¢æ”»å‡»çªƒå–
â€¢ å­˜å‚¨è®¾å¤‡ç‰©ç†ä¸¢å¤±
â€¢ ç½‘ç»œä¼ è¾“è¢«æˆªè·
```

**ğŸ’¡ é€šä¿—ç†è§£**ï¼š
æƒ³è±¡å¤‡ä»½æ–‡ä»¶å°±åƒé“¶è¡Œçš„ä¿é™©ç®±ï¼Œé‡Œé¢è£…ç€æ‰€æœ‰é‡è¦èµ„æ–™ã€‚å¦‚æœä¿é™©ç®±æ²¡æœ‰é”ï¼Œæˆ–è€…é’¥åŒ™éšä¾¿æ”¾ï¼Œä»»ä½•äººéƒ½èƒ½çœ‹åˆ°é‡Œé¢çš„ç§˜å¯†ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»™"ä¿é™©ç®±"åŠ é”ï¼ˆåŠ å¯†ï¼‰ï¼Œæ§åˆ¶è°èƒ½æ‹¿åˆ°é’¥åŒ™ï¼ˆè®¿é—®æ§åˆ¶ï¼‰ï¼Œè¿˜è¦è®°å½•è°åŠ¨è¿‡ä¿é™©ç®±ï¼ˆå®¡è®¡æ—¥å¿—ï¼‰ã€‚

### 1.2 å¤‡ä»½å®‰å…¨çš„æ ¸å¿ƒè¦ç´ 


**ğŸ”¸ æ•°æ®å®Œæ•´æ€§**ï¼šç¡®ä¿å¤‡ä»½æ•°æ®æ²¡æœ‰è¢«ç¯¡æ”¹
**ğŸ”¸ æ•°æ®æœºå¯†æ€§**ï¼šç¡®ä¿åªæœ‰æˆæƒäººå‘˜èƒ½çœ‹åˆ°æ•°æ®
**ğŸ”¸ æ•°æ®å¯ç”¨æ€§**ï¼šç¡®ä¿éœ€è¦æ—¶èƒ½æ­£å¸¸æ¢å¤æ•°æ®
**ğŸ”¸ æ•°æ®çœŸå®æ€§**ï¼šç¡®ä¿å¤‡ä»½æ•°æ®æ¥æºå¯ä¿¡

```
å®‰å…¨ä¿æŠ¤å±‚æ¬¡ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    åº”ç”¨å±‚å®‰å…¨æ§åˆ¶        â”‚ â† ç”¨æˆ·æƒé™ã€æ“ä½œå®¡è®¡
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    ä¼ è¾“å±‚åŠ å¯†ä¿æŠ¤        â”‚ â† SSL/TLSã€VPNéš§é“
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    å­˜å‚¨å±‚æ•°æ®åŠ å¯†        â”‚ â† æ–‡ä»¶åŠ å¯†ã€ç£ç›˜åŠ å¯†
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    ç‰©ç†å±‚è®¿é—®æ§åˆ¶        â”‚ â† æœºæˆ¿å®‰å…¨ã€è®¾å¤‡ä¿æŠ¤
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ğŸ›¡ï¸ å¤‡ä»½æ•°æ®åŠ å¯†æŠ€æœ¯


### 2.1 åŠ å¯†åŸºæœ¬åŸç†


**ä»€ä¹ˆæ˜¯åŠ å¯†**ï¼Ÿ
ç®€å•è¯´å°±æ˜¯æŠŠèƒ½çœ‹æ‡‚çš„æ•°æ®ï¼ˆæ˜æ–‡ï¼‰å˜æˆçœ‹ä¸æ‡‚çš„ä¹±ç ï¼ˆå¯†æ–‡ï¼‰ï¼Œåªæœ‰æ‹¿åˆ°æ­£ç¡®é’¥åŒ™ï¼ˆå¯†é’¥ï¼‰çš„äººæ‰èƒ½è¿˜åŸã€‚

```
åŠ å¯†è¿‡ç¨‹ç¤ºæ„ï¼š
åŸå§‹æ•°æ®: "SELECT * FROM users"
â†“ (ä½¿ç”¨å¯†é’¥åŠ å¯†)
åŠ å¯†æ•°æ®: "x8K9mL2pQ5vN7uR3sF6hG1..."
â†“ (ä½¿ç”¨ç›¸åŒå¯†é’¥è§£å¯†)  
æ¢å¤æ•°æ®: "SELECT * FROM users"
```

### 2.2 MySQLå¤‡ä»½åŠ å¯†æ–¹æ³•


#### ğŸ”§ mysqldump åŠ å¯†å¤‡ä»½


**æ–¹æ³•ä¸€ï¼šç»“åˆ GPG åŠ å¯†**
```bash
# å¯¼å‡ºå¹¶ç«‹å³åŠ å¯†
mysqldump -u root -p mydb | gpg --cipher-algo AES256 --compress-algo 1 \
  --symmetric --output mydb_backup.sql.gpg

# è§£å¯†æ¢å¤
gpg --decrypt mydb_backup.sql.gpg | mysql -u root -p mydb_restored
```

**ğŸ’¡ é€šä¿—è§£é‡Š**ï¼š
è¿™å°±åƒå†™ä¿¡æ—¶æŠŠå†…å®¹ç”¨å¯†ç æœ¬ç¿»è¯‘æˆå¯†æ–‡ï¼Œæ”¶ä¿¡äººç”¨ç›¸åŒå¯†ç æœ¬æ‰èƒ½çœ‹æ‡‚ã€‚GPGæ˜¯ä¸€ä¸ªå¾ˆå¯é çš„"å¯†ç æœ¬"ï¼ŒAES256æ˜¯åŠ å¯†å¼ºåº¦ï¼ˆç›¸å½“äºå¯†ç å¤æ‚åº¦ï¼‰ã€‚

**æ–¹æ³•äºŒï¼šç»“åˆ OpenSSL åŠ å¯†**
```bash
# å¯¼å‡ºå¹¶åŠ å¯†
mysqldump -u root -p mydb | openssl enc -aes-256-cbc -salt \
  -out mydb_backup.sql.enc -pass pass:your_password

# è§£å¯†æ¢å¤
openssl enc -aes-256-cbc -d -salt -in mydb_backup.sql.enc \
  -pass pass:your_password | mysql -u root -p mydb_restored
```

#### ğŸ”§ MySQL Enterprise Backup åŠ å¯†


```bash
# ä½¿ç”¨ MySQL Enterprise Backup è¿›è¡ŒåŠ å¯†å¤‡ä»½
mysqlbackup --user=backup_user --password=backup_pass \
  --backup-dir=/backup/encrypted \
  --encrypt --encrypt-password=encryption_key \
  backup-and-apply-log

# æ¢å¤åŠ å¯†å¤‡ä»½
mysqlbackup --datadir=/var/lib/mysql \
  --backup-dir=/backup/encrypted \
  --encrypt-password=encryption_key \
  copy-back-and-apply-log
```

### 2.3 æ–‡ä»¶çº§åŠ å¯†å®ç°


```bash
# åˆ›å»ºåŠ å¯†å¤‡ä»½è„šæœ¬
#!/bin/bash

# é…ç½®å‚æ•°
DB_NAME="production_db"
BACKUP_DIR="/secure/backups"
ENCRYPT_KEY="your_strong_encryption_key"
DATE=$(date +%Y%m%d_%H%M%S)

# åˆ›å»ºå¤‡ä»½å¹¶åŠ å¯†
mysqldump -u backup_user -p${DB_PASSWORD} \
  --single-transaction \
  --routines \
  --triggers \
  ${DB_NAME} | \
  gzip | \
  openssl enc -aes-256-cbc -salt -k ${ENCRYPT_KEY} \
  > ${BACKUP_DIR}/${DB_NAME}_${DATE}.sql.gz.enc

echo "åŠ å¯†å¤‡ä»½å®Œæˆ: ${BACKUP_DIR}/${DB_NAME}_${DATE}.sql.gz.enc"
```

**ğŸ”¸ åŠ å¯†å¼ºåº¦å¯¹æ¯”**ï¼š

| åŠ å¯†ç®—æ³• | **å¯†é’¥é•¿åº¦** | **å®‰å…¨çº§åˆ«** | **æ€§èƒ½å½±å“** | **é€‚ç”¨åœºæ™¯** |
|---------|-------------|-------------|-------------|-------------|
| AES-128 | 128ä½ | é«˜ | è¾ƒå° | ä¸€èˆ¬ä¸šåŠ¡æ•°æ® |
| AES-256 | 256ä½ | æé«˜ | ä¸­ç­‰ | æ•æ„Ÿä¸šåŠ¡æ•°æ® |
| 3DES | 168ä½ | ä¸­ç­‰ | è¾ƒå¤§ | å…¼å®¹æ€§è¦æ±‚é«˜ |

---

## 3. ğŸŒ ä¼ è¾“åŠ å¯†ä¸ç½‘ç»œå®‰å…¨


### 3.1 ç½‘ç»œä¼ è¾“é£é™©


**ä¼ è¾“è¿‡ç¨‹ä¸­çš„å®‰å…¨å¨èƒ**ï¼š
```
æ•°æ®ä¼ è¾“è·¯å¾„ï¼š
æ•°æ®åº“æœåŠ¡å™¨ â†’ ç½‘ç»œ â†’ å¤‡ä»½å­˜å‚¨
     â†‘              â†‘          â†‘
  æºå¤´é£é™©      ä¼ è¾“é£é™©    ç›®æ ‡é£é™©

å¸¸è§æ”»å‡»æ–¹å¼ï¼š
â€¢ ç½‘ç»œå—…æ¢ï¼šæˆªè·ä¼ è¾“æ•°æ®åŒ…
â€¢ ä¸­é—´äººæ”»å‡»ï¼šå†’å……åˆæ³•æœåŠ¡å™¨
â€¢ æ•°æ®ç¯¡æ”¹ï¼šä¿®æ”¹ä¼ è¾“ä¸­çš„æ•°æ®
â€¢ é‡æ”¾æ”»å‡»ï¼šé‡å¤å‘é€æˆªè·çš„æ•°æ®
```

### 3.2 SSL/TLS ä¼ è¾“åŠ å¯†


**ä»€ä¹ˆæ˜¯ SSL/TLS**ï¼Ÿ
æƒ³è±¡ä½ å’Œæœ‹å‹é€šç”µè¯ï¼Œæ‹…å¿ƒè¢«äººå·å¬ï¼Œæ‰€ä»¥ä½ ä»¬çº¦å®šç”¨æš—å·äº¤æµã€‚SSL/TLS å°±æ˜¯è¿™æ ·çš„"æš—å·ç³»ç»Ÿ"ï¼Œç¡®ä¿æ•°æ®åœ¨ç½‘ç»œä¸Šä¼ è¾“æ—¶ä¸ä¼šè¢«å·çœ‹æˆ–ç¯¡æ”¹ã€‚

```bash
# MySQL è¿æ¥å¯ç”¨ SSL
mysqldump -u backup_user -p \
  --ssl-mode=REQUIRED \
  --ssl-ca=ca-cert.pem \
  --ssl-cert=client-cert.pem \
  --ssl-key=client-key.pem \
  production_db > backup.sql
```

### 3.3 VPN éš§é“ä¿æŠ¤


```
VPN ä¼ è¾“ç¤ºæ„ï¼š
æœ¬åœ°å¤‡ä»½å®¢æˆ·ç«¯ â†â†’ VPNéš§é“ â†â†’ è¿œç¨‹MySQLæœåŠ¡å™¨
      â†‘              â†‘              â†‘
   æ˜æ–‡æ•°æ®      åŠ å¯†ä¼ è¾“       æ˜æ–‡æ•°æ®
```

**é…ç½®ç¤ºä¾‹**ï¼š
```bash
# é€šè¿‡ VPN è¿›è¡Œè¿œç¨‹å¤‡ä»½
# 1. å»ºç«‹ VPN è¿æ¥
openvpn --config production.ovpn

# 2. é€šè¿‡ VPN éš§é“å¤‡ä»½
mysqldump -h 10.0.1.100 -u backup_user -p \
  --single-transaction \
  production_db > /secure/backups/remote_backup.sql
```

---

## 4. ğŸ’¾ å­˜å‚¨åŠ å¯†æœºåˆ¶


### 4.1 ç£ç›˜çº§åŠ å¯†


**ä»€ä¹ˆæ˜¯ç£ç›˜åŠ å¯†**ï¼Ÿ
å°±åƒç»™æ•´ä¸ªæ–‡ä»¶æŸœåŠ é”ï¼Œä¸ç®¡é‡Œé¢æ”¾ä»€ä¹ˆæ–‡ä»¶ï¼Œæ²¡æœ‰é’¥åŒ™éƒ½æ‰“ä¸å¼€ã€‚å³ä½¿ç¡¬ç›˜è¢«å·ï¼Œå°å·ä¹Ÿçœ‹ä¸åˆ°é‡Œé¢çš„æ•°æ®ã€‚

```bash
# Linux LUKS ç£ç›˜åŠ å¯†
# 1. åˆ›å»ºåŠ å¯†åˆ†åŒº
cryptsetup luksFormat /dev/sdb1

# 2. æ‰“å¼€åŠ å¯†åˆ†åŒº
cryptsetup luksOpen /dev/sdb1 encrypted_backup

# 3. æ ¼å¼åŒ–å¹¶æŒ‚è½½
mkfs.ext4 /dev/mapper/encrypted_backup
mount /dev/mapper/encrypted_backup /secure/backups
```

### 4.2 æ–‡ä»¶ç³»ç»Ÿçº§åŠ å¯†


```bash
# ä½¿ç”¨ EncFS åˆ›å»ºåŠ å¯†ç›®å½•
# 1. åˆ›å»ºåŠ å¯†æ–‡ä»¶ç³»ç»Ÿ
encfs /encrypted/backups /decrypted/backups

# 2. å¤‡ä»½åˆ°åŠ å¯†ç›®å½•
mysqldump -u root -p mydb > /decrypted/backups/mydb.sql

# 3. å¸è½½åŠ å¯†æ–‡ä»¶ç³»ç»Ÿ
fusermount -u /decrypted/backups
```

**ğŸ’¡ ç†è§£è¦ç‚¹**ï¼š
- **ç£ç›˜åŠ å¯†**ï¼šæ•´ä¸ªç¡¬ç›˜éƒ½æ˜¯å¯†æ–‡ï¼Œé€‚åˆç‰©ç†å®‰å…¨è¦æ±‚é«˜çš„åœºæ™¯
- **æ–‡ä»¶åŠ å¯†**ï¼šåªæœ‰ç‰¹å®šæ–‡ä»¶æ˜¯å¯†æ–‡ï¼Œæ›´çµæ´»ä½†ç®¡ç†å¤æ‚
- **ç›®å½•åŠ å¯†**ï¼šä»‹äºä¸¤è€…ä¹‹é—´ï¼Œå¯¹ç‰¹å®šç›®å½•åŠ å¯†

### 4.3 äº‘å­˜å‚¨åŠ å¯†


```bash
# AWS S3 æœåŠ¡ç«¯åŠ å¯†ä¸Šä¼ 
aws s3 cp backup.sql s3://my-backup-bucket/ \
  --server-side-encryption AES256

# å®¢æˆ·ç«¯åŠ å¯†åä¸Šä¼ 
gpg --cipher-algo AES256 --symmetric backup.sql
aws s3 cp backup.sql.gpg s3://my-backup-bucket/
```

---

## 5. ğŸ”‘ å¯†é’¥ç®¡ç†ç­–ç•¥


### 5.1 å¯†é’¥ç®¡ç†åŸºæœ¬åŸåˆ™


**å¯†é’¥å°±åƒæˆ¿é—¨é’¥åŒ™**ï¼Œç®¡ç†ä¸å¥½ä¼šå¸¦æ¥ä¸¥é‡åæœï¼š

```
å¯†é’¥ç®¡ç†è¦ç‚¹ï¼š
ğŸ”¸ ç”Ÿæˆå¼ºåº¦ï¼šä½¿ç”¨å¼ºéšæœºæ•°ç”Ÿæˆ
ğŸ”¸ å­˜å‚¨å®‰å…¨ï¼šä¸èƒ½æ˜æ–‡ä¿å­˜å¯†é’¥  
ğŸ”¸ è®¿é—®æ§åˆ¶ï¼šé™åˆ¶å¯†é’¥è®¿é—®æƒé™
ğŸ”¸ å®šæœŸè½®æ¢ï¼šå®šæœŸæ›´æ¢å¯†é’¥
ğŸ”¸ å¤‡ä»½æ¢å¤ï¼šå¯†é’¥ä¸¢å¤±çš„åº”æ€¥æ–¹æ¡ˆ
ğŸ”¸ å®¡è®¡è¿½è¸ªï¼šè®°å½•å¯†é’¥ä½¿ç”¨æƒ…å†µ
```

### 5.2 å¯†é’¥å­˜å‚¨æ–¹æ¡ˆ


#### ğŸ”§ ç¯å¢ƒå˜é‡å­˜å‚¨


```bash
# åœ¨ç¯å¢ƒå˜é‡ä¸­è®¾ç½®å¯†é’¥
export BACKUP_ENCRYPTION_KEY="your_super_secret_key_here"

# å¤‡ä»½è„šæœ¬ä½¿ç”¨ç¯å¢ƒå˜é‡
#!/bin/bash
if [ -z "$BACKUP_ENCRYPTION_KEY" ]; then
    echo "é”™è¯¯ï¼šæœªè®¾ç½®åŠ å¯†å¯†é’¥"
    exit 1
fi

mysqldump -u backup_user -p mydb | \
  openssl enc -aes-256-cbc -salt -k "$BACKUP_ENCRYPTION_KEY" \
  > backup_encrypted.sql.enc
```

#### ğŸ”§ å¯†é’¥æ–‡ä»¶å­˜å‚¨


```bash
# åˆ›å»ºå¯†é’¥æ–‡ä»¶ï¼ˆæƒé™ä¸¥æ ¼æ§åˆ¶ï¼‰
echo "your_encryption_key" > /secure/keys/backup.key
chmod 600 /secure/keys/backup.key
chown backup_user:backup_group /secure/keys/backup.key

# ä½¿ç”¨å¯†é’¥æ–‡ä»¶
ENCRYPTION_KEY=$(cat /secure/keys/backup.key)
mysqldump -u backup_user -p mydb | \
  openssl enc -aes-256-cbc -salt -k "$ENCRYPTION_KEY" \
  > backup_encrypted.sql.enc
```

### 5.3 å¯†é’¥è½®æ¢ç­–ç•¥


```bash
# å¯†é’¥è½®æ¢è„šæœ¬ç¤ºä¾‹
#!/bin/bash

OLD_KEY_FILE="/secure/keys/backup_old.key"
NEW_KEY_FILE="/secure/keys/backup_new.key"
BACKUP_DIR="/secure/backups"

# ç”Ÿæˆæ–°å¯†é’¥
openssl rand -base64 32 > $NEW_KEY_FILE
chmod 600 $NEW_KEY_FILE

# é‡æ–°åŠ å¯†ç°æœ‰å¤‡ä»½
for backup_file in $BACKUP_DIR/*.enc; do
    # ç”¨æ—§å¯†é’¥è§£å¯†
    openssl enc -aes-256-cbc -d -salt -in "$backup_file" \
      -k "$(cat $OLD_KEY_FILE)" > temp_decrypted.sql
    
    # ç”¨æ–°å¯†é’¥åŠ å¯†
    openssl enc -aes-256-cbc -salt -in temp_decrypted.sql \
      -k "$(cat $NEW_KEY_FILE)" > "${backup_file}.new"
    
    # æ›¿æ¢æ—§æ–‡ä»¶
    mv "${backup_file}.new" "$backup_file"
    rm temp_decrypted.sql
done

echo "å¯†é’¥è½®æ¢å®Œæˆ"
```

---

## 6. ğŸ‘¤ å¤‡ä»½è®¿é—®æ§åˆ¶ä¸å®¡è®¡


### 6.1 è®¿é—®æ§åˆ¶åŸºæœ¬æ¦‚å¿µ


**è®¿é—®æ§åˆ¶å°±åƒå…¬å¸çš„é—¨ç¦ç³»ç»Ÿ**ï¼š
- è°èƒ½è¿›å…¥ï¼ˆèº«ä»½è®¤è¯ï¼‰
- èƒ½å»å“ªäº›åŒºåŸŸï¼ˆæƒé™æˆæƒï¼‰  
- ä»€ä¹ˆæ—¶é—´èƒ½è¿›å…¥ï¼ˆæ—¶é—´æ§åˆ¶ï¼‰
- è¿›å…¥åèƒ½åšä»€ä¹ˆï¼ˆæ“ä½œæ§åˆ¶ï¼‰

### 6.2 ç”¨æˆ·æƒé™ç®¡ç†


```sql
-- åˆ›å»ºä¸“ç”¨å¤‡ä»½ç”¨æˆ·
CREATE USER 'backup_user'@'localhost' IDENTIFIED BY 'strong_password';

-- æˆäºˆæœ€å°å¿…è¦æƒé™
GRANT SELECT, LOCK TABLES, SHOW VIEW, EVENT, TRIGGER 
ON production_db.* TO 'backup_user'@'localhost';

-- æˆäºˆå¤‡ä»½ç›¸å…³çš„å…¨å±€æƒé™
GRANT RELOAD, PROCESS, SUPER ON *.* TO 'backup_user'@'localhost';

-- åˆ·æ–°æƒé™
FLUSH PRIVILEGES;
```

**ğŸ’¡ æƒé™è¯´æ˜**ï¼š
- `SELECT`ï¼šè¯»å–è¡¨æ•°æ®
- `LOCK TABLES`ï¼šé”å®šè¡¨ç¡®ä¿ä¸€è‡´æ€§
- `SHOW VIEW`ï¼šæŸ¥çœ‹è§†å›¾å®šä¹‰
- `RELOAD`ï¼šåˆ·æ–°æƒé™å’Œç¼“å­˜
- `PROCESS`ï¼šæŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨

### 6.3 æ“ä½œå®¡è®¡æ—¥å¿—


```bash
# å¤‡ä»½æ“ä½œå®¡è®¡è„šæœ¬
#!/bin/bash

# å®¡è®¡æ—¥å¿—æ–‡ä»¶
AUDIT_LOG="/var/log/backup_audit.log"
USER=$(whoami)
TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')

# è®°å½•å¤‡ä»½å¼€å§‹
echo "[$TIMESTAMP] USER: $USER ACTION: BACKUP_START DATABASE: $1" >> $AUDIT_LOG

# æ‰§è¡Œå¤‡ä»½
mysqldump -u backup_user -p$BACKUP_PASSWORD $1 > /backups/$1_$(date +%Y%m%d).sql

# è®°å½•å¤‡ä»½ç»“æœ
if [ $? -eq 0 ]; then
    echo "[$TIMESTAMP] USER: $USER ACTION: BACKUP_SUCCESS DATABASE: $1" >> $AUDIT_LOG
else
    echo "[$TIMESTAMP] USER: $USER ACTION: BACKUP_FAILED DATABASE: $1" >> $AUDIT_LOG
fi
```

### 6.4 è®¿é—®ç›‘æ§å‘Šè­¦


```bash
# å¼‚å¸¸è®¿é—®ç›‘æ§è„šæœ¬
#!/bin/bash

# ç›‘æ§å¤‡ä»½ç›®å½•è®¿é—®
inotifywait -m -r -e access,modify,create,delete /secure/backups \
  --format '%T %w%f %e' --timefmt '%Y-%m-%d %H:%M:%S' | \
while read timestamp file event; do
    # è®°å½•è®¿é—®æ—¥å¿—
    echo "[$timestamp] FILE: $file EVENT: $event USER: $(whoami)" >> /var/log/backup_access.log
    
    # æ£€æŸ¥æ˜¯å¦ä¸ºå¼‚å¸¸è®¿é—®
    if [[ $event == "DELETE" ]]; then
        # å‘é€å‘Šè­¦
        echo "è­¦å‘Šï¼šå¤‡ä»½æ–‡ä»¶è¢«åˆ é™¤ - $file" | \
          mail -s "å¤‡ä»½å®‰å…¨å‘Šè­¦" admin@company.com
    fi
done
```

---

## 7. ğŸ“¦ å¤‡ä»½å‹ç¼©æŠ€æœ¯è¯¦è§£


### 7.1 ä¸ºä»€ä¹ˆéœ€è¦å‹ç¼©


**å‹ç¼©çš„å¥½å¤„**ï¼š
```
å­˜å‚¨ç©ºé—´èŠ‚çœï¼š
â€¢ åŸå§‹å¤‡ä»½ï¼š10GB
â€¢ å‹ç¼©åï¼š2-3GB  
â€¢ èŠ‚çœç‡ï¼š70-80%

ä¼ è¾“æ•ˆç‡æå‡ï¼š
â€¢ ç½‘ç»œä¼ è¾“æ—¶é—´ç¼©çŸ­
â€¢ å¸¦å®½å ç”¨å‡å°‘
â€¢ æˆæœ¬é™ä½æ˜æ˜¾

ä½†æ˜¯æœ‰ä»£ä»·ï¼š
â€¢ CPUèµ„æºæ¶ˆè€—å¢åŠ 
â€¢ å‹ç¼©/è§£å‹æ—¶é—´å¼€é”€
â€¢ å†…å­˜ä½¿ç”¨é‡ä¸Šå‡
```

**ğŸ’¡ é€šä¿—ç†è§£**ï¼š
å‹ç¼©å°±åƒæ•´ç†è¡£æŸœï¼ŒæŠŠè“¬æ¾çš„è¡£æœå‹ç´§æ‰“åŒ…ï¼Œèƒ½èŠ‚çœå¾ˆå¤šç©ºé—´ã€‚ä½†æ‰“åŒ…éœ€è¦æ—¶é—´ï¼Œå–ç”¨æ—¶ä¹Ÿè¦å…ˆè§£åŒ…ã€‚

### 7.2 å¸¸ç”¨å‹ç¼©ç®—æ³•å¯¹æ¯”


| å‹ç¼©ç®—æ³• | **å‹ç¼©æ¯”** | **å‹ç¼©é€Ÿåº¦** | **è§£å‹é€Ÿåº¦** | **CPUå ç”¨** | **é€‚ç”¨åœºæ™¯** |
|---------|-----------|-------------|-------------|-------------|-------------|
| **gzip** | ä¸­ç­‰(6:1) | ä¸­ç­‰ | å¿« | ä¸­ç­‰ | é€šç”¨åœºæ™¯ |
| **bzip2** | é«˜(8:1) | æ…¢ | è¾ƒæ…¢ | é«˜ | å­˜å‚¨ä¼˜å…ˆ |
| **lz4** | ä½(3:1) | æå¿« | æå¿« | ä½ | é€Ÿåº¦ä¼˜å…ˆ |
| **xz** | æé«˜(10:1) | å¾ˆæ…¢ | è¾ƒæ…¢ | å¾ˆé«˜ | é•¿æœŸå­˜å‚¨ |
| **zstd** | é«˜(7:1) | å¿« | å¿« | è¾ƒä½ | ç°ä»£æ¨è |

### 7.3 MySQL å‹ç¼©å¤‡ä»½å®ç°


#### ğŸ”§ ä½¿ç”¨ gzip å‹ç¼©


```bash
# è¾¹å¤‡ä»½è¾¹å‹ç¼©ï¼ˆæ¨èï¼‰
mysqldump -u root -p mydb | gzip > mydb_backup.sql.gz

# è§£å‹æ¢å¤
gunzip < mydb_backup.sql.gz | mysql -u root -p mydb_restored

# æŒ‡å®šå‹ç¼©çº§åˆ«ï¼ˆ1-9ï¼Œ9æœ€é«˜ï¼‰
mysqldump -u root -p mydb | gzip -9 > mydb_backup_max.sql.gz
```

#### ğŸ”§ ä½¿ç”¨ bzip2 é«˜å‹ç¼©æ¯”


```bash
# bzip2 å‹ç¼©å¤‡ä»½
mysqldump -u root -p mydb | bzip2 > mydb_backup.sql.bz2

# è§£å‹æ¢å¤
bunzip2 < mydb_backup.sql.bz2 | mysql -u root -p mydb_restored
```

#### ğŸ”§ ä½¿ç”¨ç°ä»£ zstd ç®—æ³•


```bash
# zstd å‹ç¼©ï¼ˆé€Ÿåº¦å¿«ã€å‹ç¼©æ¯”é«˜ï¼‰
mysqldump -u root -p mydb | zstd > mydb_backup.sql.zst

# æŒ‡å®šå‹ç¼©çº§åˆ«
mysqldump -u root -p mydb | zstd -19 > mydb_backup_max.sql.zst

# è§£å‹æ¢å¤  
unzstd < mydb_backup.sql.zst | mysql -u root -p mydb_restored
```

---

## 8. âš™ï¸ å‹ç¼©ç®—æ³•é€‰æ‹©ä¸ä¼˜åŒ–


### 8.1 å‹ç¼©ç®—æ³•é€‰æ‹©å†³ç­–


```
é€‰æ‹©å†³ç­–æµç¨‹ï¼š
                å¼€å§‹
                 â†“
         å­˜å‚¨ç©ºé—´æ˜¯å¦ç´§å¼ ï¼Ÿ
         â†™ æ˜¯      å¦ â†˜
     ä¼ è¾“é€Ÿåº¦é‡è¦ï¼Ÿ    CPUèµ„æºå……è¶³ï¼Ÿ
     â†™ æ˜¯  å¦ â†˜    â†™ æ˜¯    å¦ â†˜
    lz4   xz    bzip2   zstd   gzip
```

**ğŸ”¸ å…·ä½“é€‰æ‹©å»ºè®®**ï¼š

```bash
# é«˜é¢‘å¤‡ä»½ï¼ˆæ¯å°æ—¶ï¼‰- é€Ÿåº¦ä¼˜å…ˆ
mysqldump -u root -p mydb | lz4 > backup_hourly.sql.lz4

# æ—¥å¤‡ä»½ - å¹³è¡¡é€‰æ‹©
mysqldump -u root -p mydb | gzip -6 > backup_daily.sql.gz

# å‘¨å¤‡ä»½ - å‹ç¼©æ¯”ä¼˜å…ˆ  
mysqldump -u root -p mydb | xz -9 > backup_weekly.sql.xz

# ç°ä»£ç¯å¢ƒ - æ¨èé€‰æ‹©
mysqldump -u root -p mydb | zstd -10 > backup_modern.sql.zst
```

### 8.2 å‹ç¼©çº§åˆ«è°ƒä¼˜


```bash
# æµ‹è¯•ä¸åŒå‹ç¼©çº§åˆ«çš„æ•ˆæœ
#!/bin/bash

DB_NAME="test_db"
TEST_FILE="test_backup.sql"

# ç”Ÿæˆæµ‹è¯•å¤‡ä»½
mysqldump -u root -p mydb > $TEST_FILE
ORIGINAL_SIZE=$(ls -l $TEST_FILE | awk '{print $5}')

echo "åŸå§‹å¤§å°: $(($ORIGINAL_SIZE / 1024 / 1024)) MB"
echo "å‹ç¼©çº§åˆ«æµ‹è¯•ç»“æœï¼š"

# æµ‹è¯•ä¸åŒ gzip å‹ç¼©çº§åˆ«
for level in {1..9}; do
    start_time=$(date +%s.%N)
    gzip -${level} < $TEST_FILE > test_${level}.gz
    end_time=$(date +%s.%N)
    
    compressed_size=$(ls -l test_${level}.gz | awk '{print $5}')
    compression_ratio=$(echo "scale=2; $ORIGINAL_SIZE / $compressed_size" | bc)
    time_taken=$(echo "scale=2; $end_time - $start_time" | bc)
    
    echo "çº§åˆ« $level: å‹ç¼©æ¯” ${compression_ratio}:1, è€—æ—¶ ${time_taken}s"
    rm test_${level}.gz
done

rm $TEST_FILE
```

### 8.3 å¤šçº¿ç¨‹å‹ç¼©ä¼˜åŒ–


```bash
# ä½¿ç”¨ pigz (å¹¶è¡Œ gzip)
mysqldump -u root -p mydb | pigz -p 4 > mydb_backup.sql.gz

# ä½¿ç”¨ pbzip2 (å¹¶è¡Œ bzip2)  
mysqldump -u root -p mydb | pbzip2 -p4 > mydb_backup.sql.bz2

# ä½¿ç”¨ pxz (å¹¶è¡Œ xz)
mysqldump -u root -p mydb | pxz -T 4 > mydb_backup.sql.xz
```

**ğŸ’¡ ç†è§£è¦ç‚¹**ï¼š
- å¹¶è¡Œå‹ç¼©åˆ©ç”¨å¤šCPUæ ¸å¿ƒ
- å‹ç¼©é€Ÿåº¦æ˜¾è‘—æå‡ï¼ˆ2-4å€ï¼‰
- é€‚åˆå¤§å‹æ•°æ®åº“å¤‡ä»½
- éœ€è¦æ›´å¤šå†…å­˜èµ„æº

---

## 9. âš–ï¸ å‹ç¼©æ€§èƒ½å¹³è¡¡ç­–ç•¥


### 9.1 æ€§èƒ½å½±å“åˆ†æ


```
å‹ç¼©å¯¹ç³»ç»Ÿèµ„æºçš„å½±å“ï¼š

CPUä½¿ç”¨ç‡ï¼š
æ— å‹ç¼©ï¼š     â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 40%
gzipå‹ç¼©ï¼š   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 80%  
xzå‹ç¼©ï¼š     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100%

å†…å­˜ä½¿ç”¨ï¼š
æ— å‹ç¼©ï¼š     â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 100MB
gzipå‹ç¼©ï¼š   â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 200MB
xzå‹ç¼©ï¼š     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘ 500MB

ç£ç›˜I/Oï¼š
æ— å‹ç¼©ï¼š     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100%
gzipå‹ç¼©ï¼š   â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 40%
xzå‹ç¼©ï¼š     â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 20%
```

### 9.2 ä¸šåŠ¡åœºæ™¯é€‚é…ç­–ç•¥


#### ğŸ¯ åœ¨çº¿ä¸šåŠ¡ç¯å¢ƒ


```bash
# ä¸šåŠ¡é«˜å³°æœŸ - ä½å½±å“ç­–ç•¥
# ä½¿ç”¨å¿«é€Ÿå‹ç¼©ï¼Œå‡å°‘å¯¹ä¸šåŠ¡çš„å½±å“
mysqldump -u backup_user -p \
  --single-transaction \
  --quick \
  --routines \
  mydb | lz4 -1 > /backups/online_backup.sql.lz4

# è®¾ç½®è¿›ç¨‹ä¼˜å…ˆçº§
nice -n 19 iostat -n 7 mysqldump -u backup_user -p mydb | \
  nice -n 19 gzip -1 > /backups/low_priority_backup.sql.gz
```

#### ğŸ¯ ç¦»çº¿ç»´æŠ¤ç¯å¢ƒ


```bash
# ç»´æŠ¤çª—å£æœŸ - é«˜å‹ç¼©æ¯”ç­–ç•¥
mysqldump -u backup_user -p \
  --single-transaction \
  --routines \
  --triggers \
  --events \
  mydb | xz -9 > /backups/maintenance_backup.sql.xz
```

### 9.3 åŠ¨æ€å‹ç¼©ç­–ç•¥


```bash
# æ ¹æ®ç³»ç»Ÿè´Ÿè½½åŠ¨æ€é€‰æ‹©å‹ç¼©ç®—æ³•
#!/bin/bash

# è·å–ç³»ç»Ÿè´Ÿè½½
LOAD_AVG=$(uptime | awk -F'load average:' '{print $2}' | awk '{print $1}' | sed 's/,//')
CPU_CORES=$(nproc)
LOAD_RATIO=$(echo "scale=2; $LOAD_AVG / $CPU_CORES" | bc)

echo "å½“å‰è´Ÿè½½æ¯”ç‡: $LOAD_RATIO"

# æ ¹æ®è´Ÿè½½é€‰æ‹©å‹ç¼©ç­–ç•¥
if (( $(echo "$LOAD_RATIO < 0.3" | bc -l) )); then
    echo "ç³»ç»Ÿè´Ÿè½½ä½ï¼Œä½¿ç”¨é«˜å‹ç¼©æ¯”"
    COMPRESS_CMD="xz -6"
elif (( $(echo "$LOAD_RATIO < 0.7" | bc -l) )); then
    echo "ç³»ç»Ÿè´Ÿè½½ä¸­ç­‰ï¼Œä½¿ç”¨å¹³è¡¡å‹ç¼©"  
    COMPRESS_CMD="gzip -6"
else
    echo "ç³»ç»Ÿè´Ÿè½½é«˜ï¼Œä½¿ç”¨å¿«é€Ÿå‹ç¼©"
    COMPRESS_CMD="lz4"
fi

# æ‰§è¡Œå¤‡ä»½
mysqldump -u backup_user -p production_db | $COMPRESS_CMD > backup.sql.compressed
```

---

## 10. ğŸš€ æµå¼å‹ç¼©å¤‡ä»½å®ç°


### 10.1 æµå¼å‹ç¼©åŸºæœ¬æ¦‚å¿µ


**ä»€ä¹ˆæ˜¯æµå¼å‹ç¼©**ï¼Ÿ
æƒ³è±¡ç”¨æ°´ç®¡æ¥æ°´ï¼Œä¸€è¾¹æ¥æ°´ä¸€è¾¹é€šè¿‡å‹ç¼©è£…ç½®ï¼Œå‹ç¼©åçš„æ°´ç›´æ¥æµåˆ°å­˜å‚¨æ¡¶ã€‚ä¸éœ€è¦å…ˆæ¥æ»¡ä¸€æ¡¶æ°´å†å»å‹ç¼©ï¼ŒèŠ‚çœæ—¶é—´å’Œç©ºé—´ã€‚

```
ä¼ ç»Ÿæ–¹å¼ï¼š
å¤‡ä»½ â†’ ä¸´æ—¶æ–‡ä»¶ â†’ å‹ç¼© â†’ æœ€ç»ˆæ–‡ä»¶
(éœ€è¦2å€å­˜å‚¨ç©ºé—´)

æµå¼æ–¹å¼ï¼š  
å¤‡ä»½ â†’ ç›´æ¥å‹ç¼© â†’ æœ€ç»ˆæ–‡ä»¶
(åªéœ€1å€å­˜å‚¨ç©ºé—´)
```

### 10.2 æµå¼å¤‡ä»½å®ç°


```bash
# åŸºæœ¬æµå¼å‹ç¼©å¤‡ä»½
mysqldump -u backup_user -p mydb | gzip > backup_stream.sql.gz

# å¸¦è¿›åº¦æ˜¾ç¤ºçš„æµå¼å¤‡ä»½
mysqldump -u backup_user -p mydb | \
  pv -p -t -e -r -a | \
  gzip > backup_with_progress.sql.gz

# å¤šé‡å¤„ç†æµæ°´çº¿
mysqldump -u backup_user -p mydb | \
  tee >(sha256sum > backup.sha256) | \
  gzip | \
  tee backup_compressed.sql.gz | \
  openssl enc -aes-256-cbc -salt -k "encryption_key" \
  > backup_encrypted.sql.gz.enc
```

**ğŸ’¡ ä¸Šé¢å‘½ä»¤è§£é‡Š**ï¼š
- `pv`ï¼šæ˜¾ç¤ºä¼ è¾“è¿›åº¦å’Œé€Ÿåº¦
- `tee`ï¼šå°†æ•°æ®åŒæ—¶è¾“å‡ºåˆ°å¤šä¸ªåœ°æ–¹  
- `sha256sum`ï¼šè®¡ç®—æ ¡éªŒå’Œ
- æ•´ä¸ªè¿‡ç¨‹ä¸€æ°”å‘µæˆï¼Œä¸äº§ç”Ÿä¸­é—´æ–‡ä»¶

### 10.3 é«˜çº§æµå¼å¤‡ä»½è„šæœ¬


```bash
#!/bin/bash

# é«˜çº§æµå¼å¤‡ä»½è„šæœ¬
DB_NAME="production_db"
BACKUP_DIR="/secure/backups"
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_FILE="${BACKUP_DIR}/${DB_NAME}_${DATE}"

# åˆ›å»ºå‘½åç®¡é“ç”¨äºå¤šé‡å¤„ç†
PIPE_COMPRESS="/tmp/compress_pipe_$$"
PIPE_ENCRYPT="/tmp/encrypt_pipe_$$"
mkfifo $PIPE_COMPRESS $PIPE_ENCRYPT

# åå°å¯åŠ¨å‹ç¼©è¿›ç¨‹
gzip < $PIPE_COMPRESS > $PIPE_ENCRYPT &
GZIP_PID=$!

# åå°å¯åŠ¨åŠ å¯†è¿›ç¨‹  
openssl enc -aes-256-cbc -salt -k "your_key" \
  < $PIPE_ENCRYPT > "${BACKUP_FILE}.sql.gz.enc" &
ENCRYPT_PID=$!

# å¼€å§‹å¤‡ä»½ï¼ˆè¾“å‡ºåˆ°å‹ç¼©ç®¡é“ï¼‰
echo "å¼€å§‹æµå¼å¤‡ä»½..."
start_time=$(date +%s)

mysqldump -u backup_user -p${DB_PASSWORD} \
  --single-transaction \
  --routines \
  --triggers \
  --events \
  $DB_NAME > $PIPE_COMPRESS

# ç­‰å¾…æ‰€æœ‰è¿›ç¨‹å®Œæˆ
wait $GZIP_PID $ENCRYPT_PID

# æ¸…ç†ä¸´æ—¶æ–‡ä»¶
rm $PIPE_COMPRESS $PIPE_ENCRYPT

end_time=$(date +%s)
duration=$((end_time - start_time))

echo "å¤‡ä»½å®Œæˆï¼Œè€—æ—¶: ${duration}ç§’"
echo "å¤‡ä»½æ–‡ä»¶: ${BACKUP_FILE}.sql.gz.enc"
```

---

## 11. ğŸ’½ å­˜å‚¨ç©ºé—´ä¼˜åŒ–æ–¹æ¡ˆ


### 11.1 å­˜å‚¨ç©ºé—´åˆ†æ


```bash
# å¤‡ä»½ç©ºé—´ä½¿ç”¨åˆ†æè„šæœ¬
#!/bin/bash

BACKUP_DIR="/var/backups/mysql"

echo "======= å¤‡ä»½å­˜å‚¨ç©ºé—´åˆ†æ ======="
echo

# æ€»ä½“ç©ºé—´ä½¿ç”¨
echo "1. æ€»ä½“ç©ºé—´ä½¿ç”¨æƒ…å†µï¼š"
df -h $BACKUP_DIR

echo
echo "2. å¤‡ä»½æ–‡ä»¶è¯¦æƒ…ï¼š"
ls -lh $BACKUP_DIR/*.sql* | while read line; do
    filename=$(echo $line | awk '{print $9}')
    size=$(echo $line | awk '{print $5}')
    date=$(echo $line | awk '{print $6,$7,$8}')
    echo "æ–‡ä»¶: $(basename $filename), å¤§å°: $size, æ—¥æœŸ: $date"
done

echo
echo "3. å‹ç¼©æ•ˆæœåˆ†æï¼š"
for file in $BACKUP_DIR/*.sql; do
    if [ -f "$file" ]; then
        original_size=$(ls -l "$file" | awk '{print $5}')
        gzip_size=$(gzip -c "$file" | wc -c)
        ratio=$(echo "scale=2; $original_size / $gzip_size" | bc)
        echo "æ–‡ä»¶: $(basename $file)"
        echo "  åŸå§‹å¤§å°: $(($original_size / 1024 / 1024)) MB"
        echo "  å‹ç¼©å¤§å°: $(($gzip_size / 1024 / 1024)) MB"  
        echo "  å‹ç¼©æ¯”: ${ratio}:1"
        echo
    fi
done
```

### 11.2 è‡ªåŠ¨æ¸…ç†ç­–ç•¥


```bash
# æ™ºèƒ½å¤‡ä»½æ¸…ç†è„šæœ¬
#!/bin/bash

BACKUP_DIR="/var/backups/mysql"
MAX_BACKUP_SIZE="50G"  # æœ€å¤§æ€»å¤‡ä»½å¤§å°
KEEP_DAILY=7          # ä¿ç•™7å¤©çš„æ—¥å¤‡ä»½
KEEP_WEEKLY=4         # ä¿ç•™4å‘¨çš„å‘¨å¤‡ä»½  
KEEP_MONTHLY=12       # ä¿ç•™12ä¸ªæœˆçš„æœˆå¤‡ä»½

# å‡½æ•°ï¼šè½¬æ¢å¤§å°åˆ°å­—èŠ‚
size_to_bytes() {
    echo $1 | awk '
        /G$/ { printf "%.0f", $1 * 1024 * 1024 * 1024; next }
        /M$/ { printf "%.0f", $1 * 1024 * 1024; next }
        /K$/ { printf "%.0f", $1 * 1024; next }
        { print $1 }
    '
}

# è·å–å½“å‰å¤‡ä»½æ€»å¤§å°
current_size=$(du -sb $BACKUP_DIR | awk '{print $1}')
max_size=$(size_to_bytes $MAX_BACKUP_SIZE)

echo "å½“å‰å¤‡ä»½å¤§å°: $(($current_size / 1024 / 1024 / 1024)) GB"
echo "æœ€å¤§å…è®¸å¤§å°: $(($max_size / 1024 / 1024 / 1024)) GB"

# å¦‚æœè¶…è¿‡é™åˆ¶ï¼Œå¼€å§‹æ¸…ç†
if [ $current_size -gt $max_size ]; then
    echo "è¶…è¿‡å­˜å‚¨é™åˆ¶ï¼Œå¼€å§‹æ¸…ç†æ—§å¤‡ä»½..."
    
    # åˆ é™¤è¶…è¿‡ä¿ç•™æœŸé™çš„å¤‡ä»½
    find $BACKUP_DIR -name "daily_*.sql*" -mtime +$KEEP_DAILY -delete
    find $BACKUP_DIR -name "weekly_*.sql*" -mtime +$((KEEP_WEEKLY * 7)) -delete  
    find $BACKUP_DIR -name "monthly_*.sql*" -mtime +$((KEEP_MONTHLY * 30)) -delete
    
    echo "æ¸…ç†å®Œæˆ"
fi
```

### 11.3 åˆ†å±‚å­˜å‚¨ç­–ç•¥


```bash
# åˆ†å±‚å­˜å‚¨ç®¡ç†
#!/bin/bash

BACKUP_DIR="/var/backups/mysql"
COLD_STORAGE="/mnt/cold_storage/mysql"  # å†·å­˜å‚¨ï¼ˆå¦‚NASã€äº‘å­˜å‚¨ï¼‰
ARCHIVE_STORAGE="/mnt/archive/mysql"    # å½’æ¡£å­˜å‚¨

# çƒ­å­˜å‚¨ï¼ˆæœ¬åœ°SSDï¼‰- ä¿ç•™æœ€è¿‘7å¤©
echo "ç®¡ç†çƒ­å­˜å‚¨..."
find $BACKUP_DIR -name "*.sql*" -mtime +7 -type f | while read file; do
    echo "ç§»åŠ¨åˆ°å†·å­˜å‚¨: $file"
    mv "$file" "$COLD_STORAGE/"
done

# å†·å­˜å‚¨ - ä¿ç•™æœ€è¿‘3ä¸ªæœˆï¼Œä¹‹åç§»åˆ°å½’æ¡£
echo "ç®¡ç†å†·å­˜å‚¨..."
find $COLD_STORAGE -name "*.sql*" -mtime +90 -type f | while read file; do
    # é‡æ–°å‹ç¼©ä»¥èŠ‚çœç©ºé—´
    if [[ $file == *.gz ]]; then
        echo "é‡æ–°å‹ç¼©å½’æ¡£: $file"
        gunzip "$file"
        xz -9 "${file%.gz}"
        mv "${file%.gz}.xz" "$ARCHIVE_STORAGE/"
    else
        echo "ç§»åŠ¨åˆ°å½’æ¡£: $file"
        mv "$file" "$ARCHIVE_STORAGE/"
    fi
done

echo "åˆ†å±‚å­˜å‚¨ç®¡ç†å®Œæˆ"
```

---

## 12. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 12.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ” å¤‡ä»½å®‰å…¨è¦ç´ ï¼š
â€¢ æ•°æ®åŠ å¯†ï¼šä¿æŠ¤å¤‡ä»½å†…å®¹ä¸è¢«çªƒå–
â€¢ ä¼ è¾“å®‰å…¨ï¼šç¡®ä¿ç½‘ç»œä¼ è¾“è¿‡ç¨‹å®‰å…¨
â€¢ è®¿é—®æ§åˆ¶ï¼šé™åˆ¶å¤‡ä»½æ–‡ä»¶è®¿é—®æƒé™
â€¢ å®¡è®¡ç›‘æ§ï¼šè®°å½•å¤‡ä»½æ“ä½œå’Œè®¿é—®æ—¥å¿—

ğŸ“¦ å‹ç¼©æŠ€æœ¯è¦ç‚¹ï¼š
â€¢ å‹ç¼©ç®—æ³•ï¼šæ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚ç®—æ³•
â€¢ æ€§èƒ½å¹³è¡¡ï¼šåœ¨å‹ç¼©æ¯”å’Œé€Ÿåº¦é—´æ‰¾å¹³è¡¡
â€¢ æµå¼å¤„ç†ï¼šèŠ‚çœå­˜å‚¨ç©ºé—´å’Œå¤„ç†æ—¶é—´
â€¢ æ™ºèƒ½ç­–ç•¥ï¼šæ ¹æ®ç³»ç»Ÿè´Ÿè½½åŠ¨æ€è°ƒæ•´
```

### 12.2 å…³é”®å®è·µè¦ç‚¹


**ğŸ”¹ å®‰å…¨å®æ–½æ­¥éª¤**ï¼š
```
1. è¯„ä¼°å®‰å…¨éœ€æ±‚ï¼šç¡®å®šä¿æŠ¤çº§åˆ«
2. é€‰æ‹©åŠ å¯†æ–¹æ¡ˆï¼šç®—æ³•+å¯†é’¥ç®¡ç†
3. é…ç½®è®¿é—®æ§åˆ¶ï¼šç”¨æˆ·æƒé™+å®¡è®¡
4. å»ºç«‹ç›‘æ§å‘Šè­¦ï¼šå¼‚å¸¸æ£€æµ‹+å“åº”
5. å®šæœŸå®‰å…¨æ£€æŸ¥ï¼šæ¼æ´æ‰«æ+æ›´æ–°
```

**ğŸ”¹ å‹ç¼©ä¼˜åŒ–ç­–ç•¥**ï¼š
```
1. æ€§èƒ½æµ‹è¯•ï¼šæµ‹è¯•ä¸åŒç®—æ³•æ•ˆæœ
2. åœºæ™¯é€‚é…ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©
3. èµ„æºç›‘æ§ï¼šè§‚å¯Ÿç³»ç»Ÿèµ„æºä½¿ç”¨
4. åŠ¨æ€è°ƒæ•´ï¼šæ ¹æ®è´Ÿè½½è‡ªåŠ¨ä¼˜åŒ–
5. å®šæœŸè¯„ä¼°ï¼šæ£€æŸ¥å‹ç¼©æ•ˆæœå’Œæˆæœ¬
```

### 12.3 æœ€ä½³å®è·µå»ºè®®


**ğŸ¯ å®‰å…¨æœ€ä½³å®è·µ**ï¼š
- ä½¿ç”¨å¼ºåŠ å¯†ç®—æ³•ï¼ˆAES-256ï¼‰
- å®æ–½å¯†é’¥è½®æ¢æœºåˆ¶
- å»ºç«‹å®Œå–„çš„è®¿é—®æ§åˆ¶
- å®šæœŸè¿›è¡Œå®‰å…¨å®¡è®¡
- åˆ¶å®šåº”æ€¥å“åº”è®¡åˆ’

**ğŸ¯ å‹ç¼©æœ€ä½³å®è·µ**ï¼š
- æ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹é€‰æ‹©ç®—æ³•
- ä½¿ç”¨æµå¼å¤„ç†èŠ‚çœèµ„æº
- å®æ–½åˆ†å±‚å­˜å‚¨ç­–ç•¥
- ç›‘æ§å‹ç¼©æ•ˆæœå’Œæ€§èƒ½
- å»ºç«‹è‡ªåŠ¨åŒ–æ¸…ç†æœºåˆ¶

### 12.4 å¸¸è§é—®é¢˜ä¸è§£å†³


```
â“ å¤‡ä»½åŠ å¯†åæ— æ³•æ¢å¤ï¼Ÿ
âœ… æ£€æŸ¥å¯†é’¥æ˜¯å¦æ­£ç¡®ï¼Œç¡®ä¿å¯†é’¥ç®¡ç†æµç¨‹

â“ å‹ç¼©å¤‡ä»½å ç”¨CPUè¿‡é«˜ï¼Ÿ
âœ… é™ä½å‹ç¼©çº§åˆ«æˆ–ä½¿ç”¨æ›´å¿«çš„ç®—æ³•

â“ å¤‡ä»½æ–‡ä»¶è¢«æ„å¤–åˆ é™¤ï¼Ÿ
âœ… å®æ–½ç‰ˆæœ¬æ§åˆ¶å’Œå¼‚åœ°å¤‡ä»½ç­–ç•¥

â“ åŠ å¯†æ€§èƒ½å½±å“ä¸šåŠ¡ï¼Ÿ
âœ… åœ¨ä¸šåŠ¡ä½å³°æœŸè¿›è¡ŒåŠ å¯†å¤‡ä»½

â“ å‹ç¼©åå¤‡ä»½æŸåæ— æ³•æ¢å¤ï¼Ÿ
âœ… å®šæœŸéªŒè¯å¤‡ä»½å®Œæ•´æ€§ï¼Œä¿ç•™å¤šä¸ªç‰ˆæœ¬
```

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
> å¤‡ä»½å®‰å…¨ä¸‰è¦ç´ ï¼šåŠ å¯†ä¼ è¾“æ§è®¿é—®  
> å‹ç¼©ä¼˜åŒ–æ‰¾å¹³è¡¡ï¼šé€Ÿåº¦ç©ºé—´çœ‹åœºæ™¯  
> æµå¼å¤„ç†çœèµ„æºï¼šä¸€æ°”å‘µæˆä¸åœé¡¿  
> åˆ†å±‚å­˜å‚¨é™æˆæœ¬ï¼šçƒ­æ¸©å†·æ¡£æŒ‰éœ€å­˜