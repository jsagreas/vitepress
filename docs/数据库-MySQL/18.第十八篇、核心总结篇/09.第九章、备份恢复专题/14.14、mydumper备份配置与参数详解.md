---
title: 14ã€mydumperå¤‡ä»½é…ç½®ä¸å‚æ•°è¯¦è§£
---
## ğŸ“š ç›®å½•

1. [mydumperå·¥å…·æ¦‚è¿°](#1-mydumperå·¥å…·æ¦‚è¿°)
2. [åŸºæœ¬è¿æ¥å‚æ•°](#2-åŸºæœ¬è¿æ¥å‚æ•°)
3. [å¤‡ä»½èŒƒå›´æ§åˆ¶å‚æ•°](#3-å¤‡ä»½èŒƒå›´æ§åˆ¶å‚æ•°)
4. [æ€§èƒ½ä¼˜åŒ–å‚æ•°](#4-æ€§èƒ½ä¼˜åŒ–å‚æ•°)
5. [æ•°æ®ä¸€è‡´æ€§å‚æ•°](#5-æ•°æ®ä¸€è‡´æ€§å‚æ•°)
6. [é«˜çº§åŠŸèƒ½å‚æ•°](#6-é«˜çº§åŠŸèƒ½å‚æ•°)
7. [å®é™…é…ç½®æ¡ˆä¾‹](#7-å®é™…é…ç½®æ¡ˆä¾‹)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ› ï¸ mydumperå·¥å…·æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯mydumper


**ç®€å•ç†è§£**ï¼šmydumperæ˜¯MySQLæ•°æ®åº“çš„å¹¶è¡Œå¤‡ä»½å·¥å…·ï¼Œå°±åƒæ˜¯ä¸€ä¸ª"è¶…çº§æ¬å®¶å·¥å…·"

```
ä¼ ç»Ÿmysqldumpï¼š          mydumperï¼š
    å•çº¿ç¨‹å¤‡ä»½               å¤šçº¿ç¨‹å¹¶è¡Œå¤‡ä»½
      æ…¢æ…¢æ¬å®¶                å¤šäººåŒæ—¶æ¬å®¶
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  æ•°æ®åº“   â”‚ â”€â”€â”€â†’       â”‚  æ•°æ®åº“   â”‚ â•â•â•â‡’
   â”‚    æ…¢     â”‚            â”‚    å¿«     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- **å¹¶è¡Œå¤„ç†**ï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶å·¥ä½œï¼Œé€Ÿåº¦å¿«å¾ˆå¤š
- **çµæ´»å¤‡ä»½**ï¼šå¯ä»¥é€‰æ‹©ç‰¹å®šæ•°æ®åº“ã€è¡¨ï¼Œä¸ç”¨å…¨éƒ¨å¤‡ä»½
- **å‹ç¼©æ”¯æŒ**ï¼šå¤‡ä»½æ–‡ä»¶å¯ä»¥å‹ç¼©ï¼ŒèŠ‚çœç©ºé—´
- **ä¸€è‡´æ€§ä¿è¯**ï¼šç¡®ä¿å¤‡ä»½æ•°æ®åœ¨åŒä¸€æ—¶é—´ç‚¹ï¼Œæ•°æ®ä¸ä¼šæ··ä¹±

### 1.2 mydumper vs mysqldump


| å¯¹æ¯”é¡¹ç›® | **mysqldump** | **mydumper** |
|---------|--------------|-------------|
| **å·¥ä½œæ–¹å¼** | `å•çº¿ç¨‹ä¸²è¡Œ` | `å¤šçº¿ç¨‹å¹¶è¡Œ` |
| **å¤‡ä»½é€Ÿåº¦** | `è¾ƒæ…¢` | `å¿«å¾ˆå¤š` |
| **æ–‡ä»¶æ ¼å¼** | `å•ä¸ªSQLæ–‡ä»¶` | `å¤šä¸ªåˆ†ç¦»æ–‡ä»¶` |
| **å‹ç¼©æ”¯æŒ** | `éœ€è¦é¢å¤–å¤„ç†` | `å†…ç½®å‹ç¼©` |
| **æ¢å¤æ–¹å¼** | `sourceå‘½ä»¤` | `myloaderå·¥å…·` |

**ç®€å•æ¯”å–»**ï¼š
- mysqldumpåƒæ˜¯ä¸€ä¸ªäººæ¬å®¶ï¼Œä¸œè¥¿å¤šäº†å°±å¾ˆæ…¢
- mydumperåƒæ˜¯è¯·äº†æ¬å®¶å…¬å¸ï¼Œå¤šä¸ªå·¥äººåŒæ—¶å¹²æ´»ï¼Œæ•ˆç‡é«˜

---

## 2. ğŸ”— åŸºæœ¬è¿æ¥å‚æ•°


### 2.1 æ•°æ®åº“è¿æ¥æ ¸å¿ƒå‚æ•°


**è¿™äº›å‚æ•°å‘Šè¯‰mydumperï¼š"è¦è¿æ¥å“ªä¸ªæ•°æ®åº“"**

#### -h ä¸»æœºåœ°å€è®¾ç½®


**ä½œç”¨**ï¼šæŒ‡å®šMySQLæœåŠ¡å™¨çš„ä½ç½®ï¼ˆIPåœ°å€æˆ–ä¸»æœºåï¼‰

```bash
# è¿æ¥æœ¬åœ°æ•°æ®åº“
mydumper -h localhost

# è¿æ¥è¿œç¨‹æ•°æ®åº“
mydumper -h 192.168.1.100

# è¿æ¥åŸŸååœ°å€
mydumper -h mysql.company.com
```

**ç†è§£è¦ç‚¹**ï¼š
- `localhost` = æœ¬æœºæ•°æ®åº“
- `127.0.0.1` = æœ¬æœºæ•°æ®åº“ï¼ˆIPå½¢å¼ï¼‰
- å…¶ä»–IP = è¿œç¨‹æ•°æ®åº“æœåŠ¡å™¨

#### -u ç”¨æˆ·åé…ç½®


**ä½œç”¨**ï¼šæŒ‡å®šç™»å½•MySQLçš„ç”¨æˆ·å

```bash
# ä½¿ç”¨rootç”¨æˆ·
mydumper -u root

# ä½¿ç”¨æ™®é€šç”¨æˆ·
mydumper -u backup_user

# ä½¿ç”¨åªè¯»ç”¨æˆ·ï¼ˆæ¨èå¤‡ä»½æ—¶ä½¿ç”¨ï¼‰
mydumper -u readonly_user
```

> **ğŸ’¡ å®‰å…¨å»ºè®®**ï¼šå¤‡ä»½æ—¶æœ€å¥½ä½¿ç”¨ä¸“é—¨çš„å¤‡ä»½ç”¨æˆ·ï¼Œä¸è¦ç›´æ¥ç”¨root

#### -p å¯†ç å‚æ•°


**ä½œç”¨**ï¼šæä¾›ç™»å½•å¯†ç 

```bash
# æ–¹å¼1ï¼šå‘½ä»¤è¡Œç›´æ¥è¾“å…¥ï¼ˆä¸å®‰å…¨ï¼‰
mydumper -u root -p123456

# æ–¹å¼2ï¼šäº¤äº’å¼è¾“å…¥ï¼ˆå®‰å…¨ï¼‰
mydumper -u root -p
# ç³»ç»Ÿä¼šæç¤ºï¼šEnter password: [è¾“å…¥å¯†ç ï¼Œä¸æ˜¾ç¤º]

# æ–¹å¼3ï¼šä½¿ç”¨é…ç½®æ–‡ä»¶ï¼ˆæ¨èï¼‰
mydumper --defaults-file=/etc/mysql/backup.cnf
```

**å®‰å…¨é…ç½®æ–‡ä»¶ç¤ºä¾‹**ï¼ˆ/etc/mysql/backup.cnfï¼‰ï¼š
```ini
[client]
user=backup_user
password=your_secure_password
host=localhost
port=3306
```

#### -P ç«¯å£å·è®¾ç½®


**ä½œç”¨**ï¼šæŒ‡å®šMySQLæœåŠ¡ç«¯å£ï¼ˆé»˜è®¤3306ï¼‰

```bash
# é»˜è®¤ç«¯å£ï¼ˆå¯çœç•¥ï¼‰
mydumper -P 3306

# è‡ªå®šä¹‰ç«¯å£
mydumper -P 3307

# å®Œæ•´è¿æ¥ç¤ºä¾‹
mydumper -h 192.168.1.100 -u backup_user -p -P 3306
```

### 2.2 è¿æ¥å‚æ•°ç»„åˆä½¿ç”¨


**å®é™…åº”ç”¨ç¤ºä¾‹**ï¼š

```bash
# è¿æ¥æœ¬åœ°æ•°æ®åº“
mydumper -h localhost -u root -p

# è¿æ¥è¿œç¨‹ç”Ÿäº§ç¯å¢ƒ
mydumper -h prod-mysql.company.com -u backup_user -p -P 3306

# ä½¿ç”¨é…ç½®æ–‡ä»¶è¿æ¥
mydumper --defaults-file=/etc/mysql/backup.cnf
```

---

## 3. ğŸ“Š å¤‡ä»½èŒƒå›´æ§åˆ¶å‚æ•°


### 3.1 æ•°æ®åº“é€‰æ‹©å‚æ•°


#### -B æ•°æ®åº“é€‰æ‹©


**ä½œç”¨**ï¼šæŒ‡å®šè¦å¤‡ä»½å“ªäº›æ•°æ®åº“ï¼Œä¸æŒ‡å®šå°±å¤‡ä»½æ‰€æœ‰æ•°æ®åº“

```bash
# å¤‡ä»½å•ä¸ªæ•°æ®åº“
mydumper -B ecommerce

# å¤‡ä»½å¤šä¸ªæ•°æ®åº“
mydumper -B "ecommerce,blog,forum"

# å¤‡ä»½æ‰€æœ‰æ•°æ®åº“ï¼ˆä¸æŒ‡å®š-Bï¼‰
mydumper
```

**ç†è§£è¦ç‚¹**ï¼š
- ä¸ç”¨-B = å¤‡ä»½æ•´ä¸ªMySQLæœåŠ¡å™¨çš„æ‰€æœ‰æ•°æ®åº“
- ç”¨-B = åªå¤‡ä»½æŒ‡å®šçš„æ•°æ®åº“
- å¤šä¸ªæ•°æ®åº“ç”¨é€—å·åˆ†éš”ï¼Œç”¨å¼•å·åŒ…å›´

#### -T è¡¨åæŒ‡å®š


**ä½œç”¨**ï¼šåœ¨æŒ‡å®šæ•°æ®åº“ä¸­ï¼Œåªå¤‡ä»½æŸäº›è¡¨

```bash
# å¤‡ä»½ecommerceæ•°æ®åº“ä¸­çš„usersè¡¨
mydumper -B ecommerce -T users

# å¤‡ä»½å¤šä¸ªè¡¨
mydumper -B ecommerce -T "users,orders,products"

# å¤‡ä»½æ‰€æœ‰è¡¨ï¼ˆä¸æŒ‡å®š-Tï¼‰
mydumper -B ecommerce
```

**å®é™…åœºæ™¯**ï¼š
```bash
# åªå¤‡ä»½ç”¨æˆ·æ•°æ®å’Œè®¢å•æ•°æ®
mydumper -B ecommerce -T "users,orders" -h localhost -u backup_user -p
```

### 3.2 æ•°æ®è¿‡æ»¤å‚æ•°


#### -e æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤


**ä½œç”¨**ï¼šä½¿ç”¨æ¨¡å¼åŒ¹é…æ¥é€‰æ‹©è¦å¤‡ä»½çš„æ•°æ®åº“æˆ–è¡¨

```bash
# å¤‡ä»½æ‰€æœ‰ä»¥"shop_"å¼€å¤´çš„æ•°æ®åº“
mydumper -e "^shop_.*"

# å¤‡ä»½æ‰€æœ‰ä»¥"_log"ç»“å°¾çš„è¡¨
mydumper -B ecommerce -e ".*_log$"

# æ’é™¤æµ‹è¯•æ•°æ®åº“ï¼ˆä½¿ç”¨!å–åï¼‰
mydumper -e "^(?!test_).*"
```

**å¸¸ç”¨æ­£åˆ™æ¨¡å¼**ï¼š
- `^shop_.*` = ä»¥"shop_"å¼€å¤´
- `.*_log$` = ä»¥"_log"ç»“å°¾  
- `user.*` = åŒ…å«"user"çš„åç§°

#### --where æ¡ä»¶è¿‡æ»¤


**ä½œç”¨**ï¼šåªå¤‡ä»½ç¬¦åˆæ¡ä»¶çš„æ•°æ®è¡Œ

```bash
# åªå¤‡ä»½æœ€è¿‘ä¸€ä¸ªæœˆçš„è®¢å•
mydumper -B ecommerce -T orders --where "created_at >= '2025-08-01'"

# åªå¤‡ä»½æ´»è·ƒç”¨æˆ·
mydumper -B ecommerce -T users --where "status = 'active'"

# åªå¤‡ä»½å¤§é¢è®¢å•
mydumper -B ecommerce -T orders --where "amount > 1000"
```

**æ³¨æ„äº‹é¡¹**ï¼š
- WHEREæ¡ä»¶ä¼šåº”ç”¨åˆ°æ‰€æœ‰æŒ‡å®šçš„è¡¨
- æ¡ä»¶è¦ç¬¦åˆSQLè¯­æ³•
- å­—ç¬¦ä¸²å€¼è¦ç”¨å•å¼•å·åŒ…å›´

---

## 4. âš¡ æ€§èƒ½ä¼˜åŒ–å‚æ•°


### 4.1 å¹¶å‘æ§åˆ¶å‚æ•°


#### -t çº¿ç¨‹æ•°é…ç½®


**ä½œç”¨**ï¼šè®¾ç½®å¹¶å‘å¤‡ä»½çš„çº¿ç¨‹æ•°é‡ï¼Œçº¿ç¨‹è¶Šå¤šé€Ÿåº¦è¶Šå¿«ï¼ˆä½†ä¹Ÿè¦è€ƒè™‘æœåŠ¡å™¨æ€§èƒ½ï¼‰

```bash
# ä½¿ç”¨4ä¸ªçº¿ç¨‹
mydumper -t 4

# ä½¿ç”¨8ä¸ªçº¿ç¨‹ï¼ˆé€‚åˆé«˜æ€§èƒ½æœåŠ¡å™¨ï¼‰
mydumper -t 8

# ä½¿ç”¨1ä¸ªçº¿ç¨‹ï¼ˆç­‰åŒäºä¸²è¡Œï¼Œé€‚åˆä½é…ç½®ï¼‰
mydumper -t 1
```

**çº¿ç¨‹æ•°é€‰æ‹©æŒ‡å—**ï¼š

```
æœåŠ¡å™¨é…ç½®å»ºè®®ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CPUæ ¸å¿ƒæ•°    â”‚ å†…å­˜å¤§å°    â”‚ æ¨èçº¿ç¨‹æ•°    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2æ ¸         â”‚ 4GB        â”‚ 2-4ä¸ªçº¿ç¨‹    â”‚
â”‚ 4æ ¸         â”‚ 8GB        â”‚ 4-6ä¸ªçº¿ç¨‹    â”‚
â”‚ 8æ ¸         â”‚ 16GB       â”‚ 6-8ä¸ªçº¿ç¨‹    â”‚
â”‚ 16æ ¸ä»¥ä¸Š     â”‚ 32GBä»¥ä¸Š   â”‚ 8-16ä¸ªçº¿ç¨‹   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®é™…æµ‹è¯•å»ºè®®**ï¼š
```bash
# å…ˆæµ‹è¯•é»˜è®¤çº¿ç¨‹æ•°
time mydumper -B test_db

# å†æµ‹è¯•ä¸åŒçº¿ç¨‹æ•°ï¼Œæ¯”è¾ƒæ—¶é—´
time mydumper -B test_db -t 4
time mydumper -B test_db -t 8
```

#### è¾“å‡ºç›®å½•è®¾ç½®


**ä½œç”¨**ï¼šæŒ‡å®šå¤‡ä»½æ–‡ä»¶å­˜æ”¾ä½ç½®

```bash
# å¤‡ä»½åˆ°æŒ‡å®šç›®å½•
mydumper -o /backup/mysql/2025-09-11

# è‡ªåŠ¨åˆ›å»ºæ—¶é—´ç›®å½•
mydumper -o /backup/mysql/$(date +%Y%m%d_%H%M%S)

# å¤‡ä»½åˆ°ç½‘ç»œå­˜å‚¨
mydumper -o /mnt/nfs/mysql_backup
```

**ç›®å½•è§„åˆ’å»ºè®®**ï¼š
```
/backup/mysql/
â”œâ”€â”€ daily/
â”‚   â”œâ”€â”€ 20250911_080000/
â”‚   â”œâ”€â”€ 20250910_080000/
â”‚   â””â”€â”€ 20250909_080000/
â”œâ”€â”€ weekly/
â”‚   â”œâ”€â”€ week_37_2025/
â”‚   â””â”€â”€ week_36_2025/
â””â”€â”€ monthly/
    â”œâ”€â”€ 2025_09/
    â””â”€â”€ 2025_08/
```

### 4.2 å‹ç¼©ä¼˜åŒ–å‚æ•°


#### -c å‹ç¼©é€‰é¡¹


**ä½œç”¨**ï¼šå¯ç”¨å‹ç¼©ï¼Œå‡å°‘å¤‡ä»½æ–‡ä»¶å¤§å°ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´

```bash
# å¯ç”¨é»˜è®¤å‹ç¼©
mydumper -c

# å®Œæ•´å¤‡ä»½å‘½ä»¤ç¤ºä¾‹
mydumper -h localhost -u backup_user -p -B ecommerce -c -t 4 -o /backup/mysql/ecommerce_backup
```

**å‹ç¼©æ•ˆæœå¯¹æ¯”**ï¼š
```
åŸå§‹å¤‡ä»½æ–‡ä»¶ï¼š    å‹ç¼©åæ–‡ä»¶ï¼š       å‹ç¼©æ¯”ï¼š
â”œâ”€â”€ 1GB          â”œâ”€â”€ 200MB         80%å‹ç¼©
â”œâ”€â”€ 5GB          â”œâ”€â”€ 800MB         84%å‹ç¼©  
â””â”€â”€ 10GB         â””â”€â”€ 1.5GB         85%å‹ç¼©
```

**å­˜å‚¨ç©ºé—´è®¡ç®—**ï¼š
```bash
# æŸ¥çœ‹å¤‡ä»½æ–‡ä»¶å¤§å°
du -sh /backup/mysql/ecommerce_backup

# å¯¹æ¯”å‹ç¼©æ•ˆæœ
ls -lh /backup/mysql/ecommerce_backup/*.sql.gz
```

---

## 5. ğŸ”’ æ•°æ®ä¸€è‡´æ€§å‚æ•°


### 5.1 äº‹åŠ¡ä¸€è‡´æ€§æ§åˆ¶


#### --single-transaction äº‹åŠ¡ä¸€è‡´æ€§


**ä½œç”¨**ï¼šç¡®ä¿å¤‡ä»½æ•°æ®åœ¨åŒä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§

```bash
# å¯ç”¨äº‹åŠ¡ä¸€è‡´æ€§ï¼ˆæ¨èï¼‰
mydumper --single-transaction

# å®Œæ•´ç¤ºä¾‹
mydumper -h localhost -u backup_user -p -B ecommerce --single-transaction -t 4 -c
```

**ä¸ºä»€ä¹ˆéœ€è¦äº‹åŠ¡ä¸€è‡´æ€§**ï¼š

```
æ²¡æœ‰äº‹åŠ¡ä¸€è‡´æ€§ï¼š
æ—¶é—´ç‚¹1: å¤‡ä»½usersè¡¨      â† 1000ä¸ªç”¨æˆ·
æ—¶é—´ç‚¹2: æœ‰äººä¸‹å•         â† æ–°å¢è®¢å•
æ—¶é—´ç‚¹3: å¤‡ä»½ordersè¡¨     â† åŒ…å«æ–°è®¢å•
ç»“æœï¼šordersè¡¨æœ‰è®¢å•ï¼Œä½†usersè¡¨æ²¡æœ‰å¯¹åº”ç”¨æˆ· âŒ

æœ‰äº‹åŠ¡ä¸€è‡´æ€§ï¼š
æ—¶é—´ç‚¹1: å¼€å§‹äº‹åŠ¡         â† é”å®šæ•°æ®çŠ¶æ€
æ—¶é—´ç‚¹1: å¤‡ä»½usersè¡¨      â† 1000ä¸ªç”¨æˆ·  
æ—¶é—´ç‚¹1: å¤‡ä»½ordersè¡¨     â† å¯¹åº”çš„è®¢å•
ç»“æœï¼šæ•°æ®å®Œå…¨ä¸€è‡´ âœ…
```

#### --trx-consistency-only é€‰é¡¹


**ä½œç”¨**ï¼šåªä½¿ç”¨äº‹åŠ¡ä¸€è‡´æ€§ï¼Œä¸ä½¿ç”¨å…¶ä»–é”æœºåˆ¶

```bash
# åªç”¨äº‹åŠ¡ï¼Œä¸é”è¡¨
mydumper --trx-consistency-only

# é€‚åˆInnoDBå¼•æ“çš„è¡¨
mydumper -B ecommerce --trx-consistency-only -t 4
```

**é€‚ç”¨åœºæ™¯**ï¼š
- æ‰€æœ‰è¡¨éƒ½æ˜¯InnoDBå¼•æ“
- ä¸å¸Œæœ›å½±å“æ­£å¸¸ä¸šåŠ¡è®¿é—®
- æ•°æ®åº“è´Ÿè½½è¾ƒé«˜çš„ç”Ÿäº§ç¯å¢ƒ

### 5.2 é”è¡¨ç­–ç•¥å‚æ•°


#### -L é”è¡¨ç­–ç•¥


**ä½œç”¨**ï¼šæ§åˆ¶å¤‡ä»½æ—¶çš„é”å®šè¡Œä¸º

```bash
# ä¸ä½¿ç”¨ä»»ä½•é”ï¼ˆæœ€å¿«ï¼Œä½†å¯èƒ½ä¸ä¸€è‡´ï¼‰
mydumper -L 0

# ä½¿ç”¨è¡¨é”ï¼ˆé€‚åˆMyISAMï¼‰
mydumper -L 1

# ä½¿ç”¨å…¨å±€è¯»é”ï¼ˆæœ€å®‰å…¨ï¼Œä½†å½±å“æ€§èƒ½ï¼‰
mydumper -L 2
```

**é”å®šç­–ç•¥å¯¹æ¯”**ï¼š

| é”å®šçº§åˆ« | **å½±å“èŒƒå›´** | **ä¸€è‡´æ€§** | **æ€§èƒ½å½±å“** | **é€‚ç”¨åœºæ™¯** |
|---------|-------------|-----------|-------------|-------------|
| `-L 0` | `æ— é”å®š` | `å¯èƒ½ä¸ä¸€è‡´` | `å½±å“æœ€å°` | `ä»åº“å¤‡ä»½` |
| `-L 1` | `è¡¨çº§é”` | `è¡¨å†…ä¸€è‡´` | `ä¸­ç­‰å½±å“` | `MyISAMè¡¨` |
| `-L 2` | `å…¨å±€è¯»é”` | `å®Œå…¨ä¸€è‡´` | `å½±å“æœ€å¤§` | `å°å‹æ•°æ®åº“` |

### 5.3 GTIDæ”¯æŒå‚æ•°


#### -G GTIDæ”¯æŒ


**ä½œç”¨**ï¼šåœ¨ä¸»ä»å¤åˆ¶ç¯å¢ƒä¸­ï¼Œè®°å½•GTIDä¿¡æ¯

```bash
# å¯ç”¨GTIDæ”¯æŒ
mydumper -G

# ä¸»ä»ç¯å¢ƒå¤‡ä»½ç¤ºä¾‹
mydumper -h slave-server -u backup_user -p -B ecommerce -G --single-transaction
```

**GTIDçš„ä½œç”¨**ï¼š
- **Global Transaction ID**ï¼šå…¨å±€äº‹åŠ¡æ ‡è¯†ç¬¦
- **ä¸»ä»å¤åˆ¶**ï¼šå¸®åŠ©ä»åº“çŸ¥é“å¤åˆ¶åˆ°å“ªä¸ªä½ç½®
- **æ•…éšœæ¢å¤**ï¼šæ–¹ä¾¿ç¡®å®šæ¢å¤ç‚¹

---

## 6. ğŸš€ é«˜çº§åŠŸèƒ½å‚æ•°


### 6.1 å¯¹è±¡å¤‡ä»½æ§åˆ¶


#### --triggers è§¦å‘å™¨å¤‡ä»½


**ä½œç”¨**ï¼šå†³å®šæ˜¯å¦å¤‡ä»½æ•°æ®åº“è§¦å‘å™¨

```bash
# å¤‡ä»½è§¦å‘å™¨ï¼ˆé»˜è®¤ï¼‰
mydumper --triggers

# ä¸å¤‡ä»½è§¦å‘å™¨
mydumper --skip-triggers

# å®é™…åº”ç”¨
mydumper -B ecommerce --triggers -t 4
```

**è§¦å‘å™¨è¯´æ˜**ï¼š
- **ä»€ä¹ˆæ˜¯è§¦å‘å™¨**ï¼šæ•°æ®åº“ä¸­çš„è‡ªåŠ¨æ‰§è¡Œç¨‹åº
- **ä¾‹å¦‚**ï¼šå½“æ’å…¥è®¢å•æ—¶ï¼Œè‡ªåŠ¨æ›´æ–°åº“å­˜
- **æ˜¯å¦å¤‡ä»½**ï¼šçœ‹ä¸šåŠ¡éœ€è¦ï¼Œé€šå¸¸å»ºè®®å¤‡ä»½

#### --routines å­˜å‚¨è¿‡ç¨‹å¤‡ä»½


**ä½œç”¨**ï¼šå†³å®šæ˜¯å¦å¤‡ä»½å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°

```bash
# å¤‡ä»½å­˜å‚¨è¿‡ç¨‹
mydumper --routines

# ä¸å¤‡ä»½å­˜å‚¨è¿‡ç¨‹  
mydumper --skip-routines

# å®Œæ•´ä¸šåŠ¡é€»è¾‘å¤‡ä»½
mydumper -B ecommerce --routines --triggers --events
```

**å­˜å‚¨è¿‡ç¨‹è¯´æ˜**ï¼š
- **ä»€ä¹ˆæ˜¯å­˜å‚¨è¿‡ç¨‹**ï¼šé¢„ç¼–è¯‘çš„SQLä»£ç å—
- **ä¾‹å¦‚**ï¼šè®¡ç®—ç”¨æˆ·ç§¯åˆ†çš„å¤æ‚é€»è¾‘
- **å»ºè®®**ï¼šä¸šåŠ¡ç›¸å…³çš„å­˜å‚¨è¿‡ç¨‹å»ºè®®å¤‡ä»½

#### --events äº‹ä»¶å¤‡ä»½


**ä½œç”¨**ï¼šå†³å®šæ˜¯å¦å¤‡ä»½å®šæ—¶äº‹ä»¶

```bash
# å¤‡ä»½å®šæ—¶äº‹ä»¶
mydumper --events

# å®Œæ•´å¤‡ä»½ç¤ºä¾‹
mydumper -B ecommerce --single-transaction --triggers --routines --events -t 4 -c
```

**äº‹ä»¶è¯´æ˜**ï¼š
- **ä»€ä¹ˆæ˜¯äº‹ä»¶**ï¼šå®šæ—¶æ‰§è¡Œçš„æ•°æ®åº“ä»»åŠ¡
- **ä¾‹å¦‚**ï¼šæ¯å¤©å‡Œæ™¨è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ•°æ®
- **æ³¨æ„**ï¼šæ¢å¤æ—¶è¦è€ƒè™‘æ˜¯å¦éœ€è¦è¿™äº›å®šæ—¶ä»»åŠ¡

---

## 7. ğŸ“‹ å®é™…é…ç½®æ¡ˆä¾‹


### 7.1 ç”Ÿäº§ç¯å¢ƒå®Œæ•´å¤‡ä»½


```bash
#!/bin/bash
# ç”Ÿäº§ç¯å¢ƒæ¯æ—¥å…¨å¤‡è„šæœ¬

# è®¾ç½®å˜é‡
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/backup/mysql/daily/$DATE"
LOG_FILE="/var/log/mysql_backup.log"

# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p $BACKUP_DIR

# æ‰§è¡Œå¤‡ä»½
mydumper \
  --defaults-file=/etc/mysql/backup.cnf \
  --single-transaction \
  --routines \
  --triggers \
  --events \
  -G \
  --compress \
  --threads=6 \
  --outputdir=$BACKUP_DIR \
  --verbose=2 \
  --logfile=$LOG_FILE

# æ£€æŸ¥å¤‡ä»½ç»“æœ
if [ $? -eq 0 ]; then
    echo "å¤‡ä»½æˆåŠŸ: $BACKUP_DIR" | tee -a $LOG_FILE
    # åˆ é™¤7å¤©å‰çš„å¤‡ä»½
    find /backup/mysql/daily -type d -mtime +7 -exec rm -rf {} +
else
    echo "å¤‡ä»½å¤±è´¥!" | tee -a $LOG_FILE
    exit 1
fi
```

### 7.2 ç‰¹å®šæ•°æ®åº“å¤‡ä»½


```bash
# åªå¤‡ä»½ç”µå•†æ ¸å¿ƒæ•°æ®
mydumper \
  -h localhost \
  -u backup_user \
  -p \
  -B ecommerce \
  -T "users,orders,products,categories" \
  --single-transaction \
  --compress \
  --threads=4 \
  --outputdir=/backup/mysql/ecommerce_core
```

### 7.3 å¢é‡å¤‡ä»½é…ç½®


```bash
# å¤‡ä»½æœ€è¿‘ä¿®æ”¹çš„æ•°æ®
mydumper \
  -B ecommerce \
  -T orders \
  --where "updated_at >= DATE_SUB(NOW(), INTERVAL 1 DAY)" \
  --single-transaction \
  --compress \
  --outputdir=/backup/mysql/incremental/$(date +%Y%m%d)
```

### 7.4 ä»åº“å¤‡ä»½é…ç½®


```bash
# ä»åªè¯»ä»åº“å¤‡ä»½ï¼ˆæ¨èï¼‰
mydumper \
  -h slave-mysql.company.com \
  -u readonly_user \
  -p \
  --single-transaction \
  --compress \
  --threads=8 \
  -G \
  --outputdir=/backup/mysql/slave_backup/$(date +%Y%m%d_%H%M%S)
```

---

## 8. ğŸ“ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒå‚æ•°


```
ğŸ”¸ è¿æ¥å‚æ•°ï¼š-hä¸»æœº -uç”¨æˆ· -på¯†ç  -Pç«¯å£
ğŸ”¸ èŒƒå›´æ§åˆ¶ï¼š-Bæ•°æ®åº“ -Tè¡¨å --whereæ¡ä»¶
ğŸ”¸ æ€§èƒ½ä¼˜åŒ–ï¼š-tçº¿ç¨‹æ•° -cå‹ç¼© -oè¾“å‡ºç›®å½•  
ğŸ”¸ ä¸€è‡´æ€§ä¿è¯ï¼š--single-transactionäº‹åŠ¡ä¸€è‡´æ€§
ğŸ”¸ å®Œæ•´å¤‡ä»½ï¼š--triggers --routines --eventså¯¹è±¡å¤‡ä»½
```

### 8.2 å¸¸ç”¨å‚æ•°ç»„åˆ


**ğŸ”¹ æ—¥å¸¸å…¨å¤‡å‘½ä»¤**ï¼š
```bash
mydumper -h localhost -u backup_user -p --single-transaction --routines --triggers --events --compress --threads=4 -o /backup/mysql/full_backup
```

**ğŸ”¹ å¿«é€Ÿè¡¨å¤‡ä»½**ï¼š
```bash
mydumper -B mydb -T mytable --single-transaction --compress -t 4 -o /backup/mysql/table_backup
```

**ğŸ”¹ ç”Ÿäº§ç¯å¢ƒå¤‡ä»½**ï¼š
```bash
mydumper --defaults-file=/etc/mysql/backup.cnf --single-transaction -G --compress --threads=6 -o /backup/mysql/production
```

### 8.3 æœ€ä½³å®è·µå»ºè®®


**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–**ï¼š
- çº¿ç¨‹æ•° = CPUæ ¸å¿ƒæ•°çš„1-2å€
- ä½¿ç”¨å‹ç¼©èŠ‚çœ50-80%å­˜å‚¨ç©ºé—´  
- ä»åªè¯»ä»åº“å¤‡ä»½ï¼Œä¸å½±å“ä¸»åº“æ€§èƒ½

**ğŸ”¹ æ•°æ®å®‰å…¨**ï¼š
- å¿…é¡»ä½¿ç”¨`--single-transaction`ä¿è¯ä¸€è‡´æ€§
- ç”Ÿäº§ç¯å¢ƒç”¨é…ç½®æ–‡ä»¶ï¼Œä¸åœ¨å‘½ä»¤è¡Œæš´éœ²å¯†ç 
- å¤‡ä»½åéªŒè¯æ–‡ä»¶å®Œæ•´æ€§

**ğŸ”¹ å­˜å‚¨ç®¡ç†**ï¼š
- æŒ‰æ—¥æœŸç»„ç»‡ç›®å½•ç»“æ„
- å®šæœŸæ¸…ç†æ—§å¤‡ä»½æ–‡ä»¶
- è€ƒè™‘å¼‚åœ°å¤‡ä»½å­˜å‚¨

**æ ¸å¿ƒè®°å¿†**ï¼š
- mydumperå¹¶è¡Œå¿«ï¼Œå‚æ•°è®¾ç½®è¦åˆç†
- ä¸€è‡´æ€§ç¬¬ä¸€ä½ï¼Œæ€§èƒ½ä¼˜åŒ–ç¬¬äºŒä½  
- å¤‡ä»½éªŒè¯ä¸èƒ½å¿˜ï¼Œå®šæœŸæ¸…ç†è¦è®°ç‰¢