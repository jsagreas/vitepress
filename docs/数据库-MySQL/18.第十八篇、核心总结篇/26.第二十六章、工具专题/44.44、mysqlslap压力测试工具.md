---
title: 44ã€mysqlslapå‹åŠ›æµ‹è¯•å·¥å…·
---
## ğŸ“š ç›®å½•

1. [mysqlslapåŸºç¡€æ¦‚å¿µ](#1-mysqlslapåŸºç¡€æ¦‚å¿µ)
2. [å·¥å…·æ ¸å¿ƒåŠŸèƒ½è¯¦è§£](#2-å·¥å…·æ ¸å¿ƒåŠŸèƒ½è¯¦è§£)
3. [å‹åŠ›æµ‹è¯•å®æˆ˜æ“ä½œ](#3-å‹åŠ›æµ‹è¯•å®æˆ˜æ“ä½œ)
4. [æµ‹è¯•åœºæ™¯é…ç½®ä¸ä¼˜åŒ–](#4-æµ‹è¯•åœºæ™¯é…ç½®ä¸ä¼˜åŒ–)
5. [æ€§èƒ½åˆ†æä¸è°ƒä¼˜æŒ‡å¯¼](#5-æ€§èƒ½åˆ†æä¸è°ƒä¼˜æŒ‡å¯¼)
6. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#6-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ mysqlslapåŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯mysqlslap


**ğŸ”¸ é€šä¿—ç†è§£**
```
mysqlslapå°±åƒæ˜¯ç»™MySQLæ•°æ®åº“åš"ä½“æ£€"çš„ä¸“ä¸šå·¥å…·
- å°±åƒåŒ»é™¢çš„è·‘æ­¥æœºæµ‹è¯•å¿ƒè„æ‰¿å—èƒ½åŠ›
- mysqlslapæµ‹è¯•æ•°æ®åº“åœ¨é«˜è´Ÿè½½ä¸‹çš„è¡¨ç°
- å¸®æˆ‘ä»¬å‘ç°æ•°æ®åº“çš„æ€§èƒ½æé™åœ¨å“ªé‡Œ
```

**ğŸ“– æ¦‚å¿µå¡ç‰‡**
| æ¦‚å¿µ | å«ä¹‰ | ç”¨é€” | ç‰¹ç‚¹ |
|------|------|------|------|
| **mysqlslap** | MySQLå®˜æ–¹å‹åŠ›æµ‹è¯•å·¥å…· | æ¨¡æ‹Ÿå¤šç”¨æˆ·å¹¶å‘è®¿é—® | å…è´¹ã€å®˜æ–¹ã€æ˜“ç”¨ |
| **å‹åŠ›æµ‹è¯•** | é«˜è´Ÿè½½ä¸‹çš„æ€§èƒ½æµ‹è¯• | æ‰¾å‡ºç³»ç»Ÿæ€§èƒ½ç“¶é¢ˆ | æ¨¡æ‹ŸçœŸå®ä½¿ç”¨åœºæ™¯ |
| **å¹¶å‘è¿æ¥** | åŒæ—¶è®¿é—®æ•°æ®åº“çš„ç”¨æˆ·æ•° | æµ‹è¯•å¤šç”¨æˆ·åœºæ™¯ | åæ˜ çœŸå®ä¸šåŠ¡å‹åŠ› |

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦mysqlslap


**ğŸ¤” å®é™…é—®é¢˜**
```
æ—¥å¸¸å¼€å‘ä¸­çš„å›°æƒ‘ï¼š
- æˆ‘çš„æ•°æ®åº“èƒ½æ”¯æŒå¤šå°‘ç”¨æˆ·åŒæ—¶è®¿é—®ï¼Ÿ
- æ–°å†™çš„SQLè¯­å¥åœ¨é«˜å¹¶å‘ä¸‹ä¼šä¸ä¼šå¾ˆæ…¢ï¼Ÿ
- æœåŠ¡å™¨é…ç½®å¤Ÿä¸å¤Ÿç”¨ï¼Ÿéœ€è¦å‡çº§å—ï¼Ÿ
- ç³»ç»Ÿä¸Šçº¿å‰æ€ä¹ˆéªŒè¯æ€§èƒ½ï¼Ÿ

mysqlslapå¸®ä½ è§£ç­”è¿™äº›é—®é¢˜ï¼
```

**ğŸ’¡ æ ¸å¿ƒä»·å€¼**
- **é¢„é˜²é—®é¢˜**ï¼šä¸Šçº¿å‰å‘ç°æ€§èƒ½é—®é¢˜ï¼Œé¿å…çº¿ä¸Šæ•…éšœ
- **å®¹é‡è§„åˆ’**ï¼šå¸®åŠ©è¯„ä¼°éœ€è¦å¤šå°‘æœåŠ¡å™¨èµ„æº
- **ä¼˜åŒ–æŒ‡å¯¼**ï¼šæ‰¾å‡ºæ€§èƒ½ç“¶é¢ˆï¼ŒæŒ‡å¯¼ä¼˜åŒ–æ–¹å‘
- **æˆæœ¬æ§åˆ¶**ï¼šé¿å…è¿‡åº¦é…ç½®æˆ–é…ç½®ä¸è¶³

### 1.3 mysqlslapçš„å·¥ä½œåŸç†


**ğŸ”„ å·¥ä½œæµç¨‹**
```
å‡†å¤‡é˜¶æ®µ â†’ æµ‹è¯•æ‰§è¡Œ â†’ æ•°æ®æ”¶é›† â†’ ç»“æœåˆ†æ
    â†“          â†“         â†“         â†“
åˆ›å»ºæµ‹è¯•è¡¨   å¹¶å‘æ‰§è¡ŒSQL   è®°å½•æ€§èƒ½    ç”ŸæˆæŠ¥å‘Š
å»ºç«‹è¿æ¥     æ¨¡æ‹Ÿç”¨æˆ·      ç»Ÿè®¡è€—æ—¶    è¯†åˆ«é—®é¢˜
```

**ğŸ­ åœºæ™¯æ¨¡æ‹Ÿ**
```
çœŸå®ä¸šåŠ¡åœºæ™¯ï¼š
100ä¸ªç”¨æˆ·åŒæ—¶ç™»å½•ç³»ç»Ÿ â†’ mysqlslapæ¨¡æ‹Ÿ100ä¸ªå¹¶å‘è¿æ¥
æ¯ä¸ªç”¨æˆ·æŸ¥è¯¢è®¢å•ä¿¡æ¯  â†’ æ¯ä¸ªè¿æ¥æ‰§è¡ŒæŸ¥è¯¢SQL
ç³»ç»Ÿéœ€è¦å¿«é€Ÿå“åº”     â†’ æµ‹è¯•å“åº”æ—¶é—´å’Œååé‡
```

---

## 2. âš™ï¸ å·¥å…·æ ¸å¿ƒåŠŸèƒ½è¯¦è§£


### 2.1 å¹¶å‘è¿æ¥æµ‹è¯•åŠŸèƒ½


**ğŸ”¸ åŠŸèƒ½è¯´æ˜**
```
å¹¶å‘è¿æ¥ = åŒæ—¶è¿æ¥æ•°æ®åº“çš„å®¢æˆ·ç«¯æ•°é‡
å°±åƒé¤å…åŒæ—¶æ¥å¾…çš„å®¢äººæ•°é‡
- æµ‹è¯•æ•°æ®åº“èƒ½å¤„ç†å¤šå°‘ä¸ªåŒæ—¶è¿æ¥
- å‘ç°è¿æ¥æ•°ä¸Šé™å’Œæ€§èƒ½æ‹ç‚¹
- æ¨¡æ‹ŸçœŸå®çš„å¤šç”¨æˆ·è®¿é—®åœºæ™¯
```

**ğŸ“Š æµ‹è¯•ç»´åº¦**
| æµ‹è¯•é¡¹ç›® | å«ä¹‰ | é‡è¦æ€§ | å½±å“å› ç´  |
|----------|------|--------|----------|
| **æœ€å¤§è¿æ¥æ•°** | ç³»ç»Ÿæ”¯æŒçš„è¿æ¥ä¸Šé™ | â­â­â­ | max_connectionsé…ç½® |
| **å¹¶å‘å¤„ç†èƒ½åŠ›** | åŒæ—¶å¤„ç†è¯·æ±‚çš„èƒ½åŠ› | â­â­â­ | CPUã€å†…å­˜ã€ç£ç›˜IO |
| **è¿æ¥å»ºç«‹é€Ÿåº¦** | å»ºç«‹æ–°è¿æ¥çš„å¿«æ…¢ | â­â­ | ç½‘ç»œå»¶è¿Ÿã€ç³»ç»Ÿè´Ÿè½½ |

### 2.2 æŸ¥è¯¢æ€§èƒ½æµ‹è¯•åŠŸèƒ½


**ğŸ” æ€§èƒ½æµ‹è¯•æ ¸å¿ƒæŒ‡æ ‡**
```
ğŸ¯ å“åº”æ—¶é—´
- æ‰§è¡Œä¸€æ¡SQLéœ€è¦å¤šé•¿æ—¶é—´
- åŒ…æ‹¬ç½‘ç»œä¼ è¾“ã€SQLè§£æã€æ‰§è¡Œã€è¿”å›ç»“æœ

ğŸ“ˆ ååé‡  
- æ¯ç§’èƒ½å¤„ç†å¤šå°‘ä¸ªæŸ¥è¯¢è¯·æ±‚
- åæ˜ ç³»ç»Ÿçš„æ•´ä½“å¤„ç†èƒ½åŠ›

âš¡ å¹¶å‘æ€§èƒ½
- å¤šç”¨æˆ·åŒæ—¶æ“ä½œæ—¶çš„æ€§èƒ½è¡¨ç°
- è€ƒéªŒç³»ç»Ÿçš„å¹¶å‘å¤„ç†èƒ½åŠ›
```

**ğŸ’» æµ‹è¯•ç±»å‹**
```
SELECTæŸ¥è¯¢æµ‹è¯•ï¼š
- ç®€å•æŸ¥è¯¢ï¼šSELECT * FROM users WHERE id = 1
- å¤æ‚æŸ¥è¯¢ï¼šå¤šè¡¨JOINã€èšåˆå‡½æ•°ã€å­æŸ¥è¯¢
- èŒƒå›´æŸ¥è¯¢ï¼šBETWEENã€LIKEæ¨¡ç³ŠåŒ¹é…

INSERTæ’å…¥æµ‹è¯•ï¼š
- å•æ¡æ’å…¥æ€§èƒ½
- æ‰¹é‡æ’å…¥æ€§èƒ½  
- é«˜å¹¶å‘æ’å…¥å†²çªå¤„ç†

UPDATE/DELETEæµ‹è¯•ï¼š
- æ›´æ–°æ€§èƒ½æµ‹è¯•
- åˆ é™¤æ“ä½œæ€§èƒ½
- äº‹åŠ¡å¤„ç†èƒ½åŠ›
```

### 2.3 è‡ªå®šä¹‰æµ‹è¯•åœºæ™¯


**ğŸ¨ æµ‹è¯•åœºæ™¯è®¾è®¡**
```
ç”µå•†ç½‘ç«™åœºæ™¯ï¼š
- ç”¨æˆ·æµè§ˆå•†å“ï¼ˆSELECTæŸ¥è¯¢ï¼‰
- æ·»åŠ è´­ç‰©è½¦ï¼ˆINSERTæ“ä½œï¼‰
- ä¸‹å•æ”¯ä»˜ï¼ˆäº‹åŠ¡å¤„ç†ï¼‰
- æŸ¥çœ‹è®¢å•ï¼ˆJOINæŸ¥è¯¢ï¼‰

ç¤¾äº¤å¹³å°åœºæ™¯ï¼š
- ç”¨æˆ·ç™»å½•éªŒè¯
- å‘å¸ƒåŠ¨æ€å†…å®¹
- æŸ¥çœ‹å¥½å‹åŠ¨æ€
- ç‚¹èµè¯„è®ºæ“ä½œ
```

---

## 3. ğŸš€ å‹åŠ›æµ‹è¯•å®æˆ˜æ“ä½œ


### 3.1 åŸºç¡€æµ‹è¯•å‘½ä»¤


**ğŸ”° å…¥é—¨çº§æµ‹è¯•**
```bash
# æœ€ç®€å•çš„æµ‹è¯• - ç†è§£åŸºæœ¬ç”¨æ³•
mysqlslap --user=root --password=yourpassword \
          --host=localhost \
          --concurrency=10 \
          --iterations=5 \
          --create-schema=test_db

è§£é‡Šæ¯ä¸ªå‚æ•°ï¼š
--user          æ•°æ®åº“ç”¨æˆ·åï¼ˆå°±åƒç™»å½•è´¦å·ï¼‰
--password      æ•°æ®åº“å¯†ç 
--host          æ•°æ®åº“æœåŠ¡å™¨åœ°å€
--concurrency   å¹¶å‘ç”¨æˆ·æ•°ï¼ˆæ¨¡æ‹Ÿ10ä¸ªç”¨æˆ·åŒæ—¶è®¿é—®ï¼‰
--iterations    æµ‹è¯•é‡å¤æ¬¡æ•°ï¼ˆæµ‹è¯•5è½®å–å¹³å‡å€¼ï¼‰
--create-schema åˆ›å»ºæµ‹è¯•ç”¨çš„æ•°æ®åº“
```

**ğŸ”¸ è¿›é˜¶æµ‹è¯•ç¤ºä¾‹**
```bash
# æµ‹è¯•ç‰¹å®šè¡¨çš„æŸ¥è¯¢æ€§èƒ½
mysqlslap --user=root --password=123456 \
          --host=localhost \
          --concurrency=50 \
          --iterations=3 \
          --number-of-queries=1000 \
          --query="SELECT * FROM users WHERE age > 18" \
          --create-schema=test_performance

å‚æ•°è¯´æ˜ï¼š
--concurrency=50        æ¨¡æ‹Ÿ50ä¸ªç”¨æˆ·å¹¶å‘
--iterations=3          é‡å¤æµ‹è¯•3æ¬¡
--number-of-queries     æ€»å…±æ‰§è¡Œ1000æ¬¡æŸ¥è¯¢
--query                 æŒ‡å®šè¦æµ‹è¯•çš„SQLè¯­å¥
```

### 3.2 æµ‹è¯•æ•°æ®è‡ªåŠ¨ç”Ÿæˆ


**ğŸ² è‡ªåŠ¨å»ºè¡¨æµ‹è¯•**
```bash
# mysqlslapè‡ªåŠ¨åˆ›å»ºè¡¨å’Œæ•°æ®è¿›è¡Œæµ‹è¯•
mysqlslap --user=root --password=123456 \
          --concurrency=20 \
          --iterations=5 \
          --auto-generate-sql \
          --auto-generate-sql-add-autoincrement \
          --auto-generate-sql-load-type=mixed \
          --number-of-queries=500

åŠŸèƒ½è§£é‡Šï¼š
--auto-generate-sql               è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•SQL
--auto-generate-sql-add-autoincrement  æ·»åŠ è‡ªå¢ä¸»é”®
--auto-generate-sql-load-type=mixed    æ··åˆæ“ä½œç±»å‹ï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰
```

**ğŸ“‹ load-typeç±»å‹è¯´æ˜**
```
readï¼š   åªè¿›è¡ŒSELECTæŸ¥è¯¢æµ‹è¯•
writeï¼š  åªè¿›è¡ŒINSERTæ’å…¥æµ‹è¯•  
keyï¼š    åŸºäºä¸»é”®çš„SELECTæŸ¥è¯¢
updateï¼š UPDATEæ›´æ–°æ“ä½œæµ‹è¯•
mixedï¼š  æ··åˆå„ç§æ“ä½œï¼ˆæœ€æ¥è¿‘çœŸå®åœºæ™¯ï¼‰
```

### 3.3 è‡ªå®šä¹‰SQLæ–‡ä»¶æµ‹è¯•


**ğŸ“„ åˆ›å»ºæµ‹è¯•SQLæ–‡ä»¶**
```sql
-- åˆ›å»º test_queries.sql æ–‡ä»¶
-- æ¨¡æ‹Ÿç”¨æˆ·ç™»å½•æŸ¥è¯¢
SELECT id, username FROM users WHERE username = 'user1' AND password = 'pass123';

-- æ¨¡æ‹Ÿå•†å“æŸ¥è¯¢
SELECT * FROM products WHERE category_id = 1 AND price < 100;

-- æ¨¡æ‹Ÿè®¢å•æŸ¥è¯¢
SELECT o.*, u.username FROM orders o 
JOIN users u ON o.user_id = u.id 
WHERE o.status = 'pending';
```

**ğŸ”§ æ‰§è¡Œè‡ªå®šä¹‰æµ‹è¯•**
```bash
# ä½¿ç”¨è‡ªå®šä¹‰SQLæ–‡ä»¶è¿›è¡Œæµ‹è¯•
mysqlslap --user=root --password=123456 \
          --concurrency=30 \
          --iterations=3 \
          --query="test_queries.sql" \
          --delimiter=";" \
          --create-schema=ecommerce_test

é‡è¦å‚æ•°ï¼š
--query="test_queries.sql"  æŒ‡å®šSQLæ–‡ä»¶è·¯å¾„
--delimiter=";"             SQLè¯­å¥åˆ†éš”ç¬¦
```

---

## 4. ğŸ“ˆ æµ‹è¯•åœºæ™¯é…ç½®ä¸ä¼˜åŒ–


### 4.1 ä¸åŒä¸šåŠ¡åœºæ™¯çš„æµ‹è¯•é…ç½®


**ğŸ›’ ç”µå•†ç³»ç»Ÿæµ‹è¯•é…ç½®**
```bash
# ç”µå•†é«˜å³°æœŸåœºæ™¯æµ‹è¯•
mysqlslap --user=root --password=123456 \
          --concurrency=100 \
          --iterations=5 \
          --number-of-queries=2000 \
          --auto-generate-sql \
          --auto-generate-sql-load-type=mixed \
          --auto-generate-sql-secondary-indexes=3 \
          --auto-generate-sql-unique-query-number=10

ç”µå•†ç‰¹ç‚¹é…ç½®è¯´æ˜ï¼š
--concurrency=100              æ¨¡æ‹Ÿä¿ƒé”€æ—¶100äººåŒæ—¶ä¸‹å•
--auto-generate-sql-secondary-indexes=3  åˆ›å»º3ä¸ªäºŒçº§ç´¢å¼•ï¼ˆå•†å“åˆ†ç±»ã€ä»·æ ¼ç­‰ï¼‰
--auto-generate-sql-unique-query-number 10ç§ä¸åŒçš„æŸ¥è¯¢æ¨¡å¼
```

**ğŸ“Š æŠ¥è¡¨ç³»ç»Ÿæµ‹è¯•é…ç½®**
```bash
# å¤æ‚æŸ¥è¯¢å’Œèšåˆæ“ä½œæµ‹è¯•
mysqlslap --user=root --password=123456 \
          --concurrency=20 \
          --iterations=3 \
          --query="SELECT DATE(created_at), COUNT(*), AVG(amount) FROM orders GROUP BY DATE(created_at)" \
          --create-schema=report_test

æŠ¥è¡¨ç‰¹ç‚¹ï¼š
- å¹¶å‘æ•°ä¸é«˜ä½†æŸ¥è¯¢å¤æ‚
- æ¶‰åŠå¤§é‡æ•°æ®èšåˆè®¡ç®—
- è€ƒéªŒæ•°æ®åº“çš„åˆ†æå¤„ç†èƒ½åŠ›
```

### 4.2 æ¸è¿›å¼å‹åŠ›æµ‹è¯•


**ğŸ“Š å‹åŠ›é€’å¢æµ‹è¯•ç­–ç•¥**
```bash
# ç¬¬ä¸€é˜¶æ®µï¼šè½»å‹åŠ›æµ‹è¯•
mysqlslap --concurrency=10 --iterations=3 --number-of-queries=100 ...

# ç¬¬äºŒé˜¶æ®µï¼šä¸­ç­‰å‹åŠ›
mysqlslap --concurrency=50 --iterations=3 --number-of-queries=500 ...

# ç¬¬ä¸‰é˜¶æ®µï¼šé«˜å‹åŠ›æµ‹è¯•  
mysqlslap --concurrency=200 --iterations=3 --number-of-queries=1000 ...

# ç¬¬å››é˜¶æ®µï¼šæé™å‹åŠ›
mysqlslap --concurrency=500 --iterations=3 --number-of-queries=2000 ...
```

**ğŸ“ˆ æµ‹è¯•ç»“æœå¯¹æ¯”åˆ†æ**
```
å‹åŠ›çº§åˆ«    å¹¶å‘æ•°    å¹³å‡å“åº”æ—¶é—´    QPS    CPUä½¿ç”¨ç‡
è½»å‹åŠ›      10       0.05s         200     30%
ä¸­ç­‰å‹åŠ›    50       0.15s         333     60%  
é«˜å‹åŠ›      200      0.80s         250     85%
æé™å‹åŠ›    500      2.50s         200     95%

åˆ†æç»“è®ºï¼š
- 200å¹¶å‘æ˜¯æ€§èƒ½æ‹ç‚¹ï¼ˆQPSå¼€å§‹ä¸‹é™ï¼‰
- 500å¹¶å‘æ—¶ç³»ç»Ÿæ¥è¿‘é¥±å’Œ
- å»ºè®®ç”Ÿäº§ç¯å¢ƒæ§åˆ¶åœ¨150å¹¶å‘ä»¥å†…
```

### 4.3 é•¿æ—¶é—´ç¨³å®šæ€§æµ‹è¯•


**â° æŒç»­å‹åŠ›æµ‹è¯•**
```bash
# æ¨¡æ‹Ÿé•¿æ—¶é—´è¿è¡Œåœºæ™¯
mysqlslap --user=root --password=123456 \
          --concurrency=50 \
          --iterations=100 \
          --number-of-queries=10000 \
          --auto-generate-sql \
          --verbose

é•¿æ—¶é—´æµ‹è¯•ç›®çš„ï¼š
- æ£€æµ‹å†…å­˜æ³„æ¼é—®é¢˜
- éªŒè¯è¿æ¥æ± ç¨³å®šæ€§  
- å‘ç°é•¿æœŸè¿è¡Œçš„æ€§èƒ½è¡°å‡
- æµ‹è¯•ç³»ç»Ÿæ¢å¤èƒ½åŠ›
```

---

## 5. ğŸ“Š æ€§èƒ½åˆ†æä¸è°ƒä¼˜æŒ‡å¯¼


### 5.1 æµ‹è¯•ç»“æœè§£è¯»


**ğŸ“‹ å…¸å‹æµ‹è¯•è¾“å‡ºè§£æ**
```
Benchmark
        Running for engine rbind
        Average number of seconds to run all queries: 28.015 seconds
        Minimum number of seconds to run all queries: 25.000 seconds  
        Maximum number of seconds to run all queries: 32.768 seconds
        Number of clients running queries: 50
        Average number of queries per client: 200

å…³é”®æŒ‡æ ‡å«ä¹‰ï¼š
Average: å¹³å‡æ‰§è¡Œæ—¶é—´ï¼ˆè¶Šå°è¶Šå¥½ï¼‰
Minimum: æœ€å¿«ä¸€è½®çš„æ—¶é—´ï¼ˆæœ€ä½³æ€§èƒ½ï¼‰
Maximum: æœ€æ…¢ä¸€è½®çš„æ—¶é—´ï¼ˆæœ€å·®æ€§èƒ½ï¼‰  
Number of clients: å¹¶å‘å®¢æˆ·ç«¯æ•°é‡
Queries per client: æ¯ä¸ªå®¢æˆ·ç«¯æ‰§è¡Œçš„æŸ¥è¯¢æ•°
```

**âš¡ æ€§èƒ½æŒ‡æ ‡è®¡ç®—**
```
QPSè®¡ç®—ï¼š
æ€»æŸ¥è¯¢æ•° = 50ä¸ªå®¢æˆ·ç«¯ Ã— 200ä¸ªæŸ¥è¯¢ = 10,000ä¸ªæŸ¥è¯¢
å¹³å‡QPS = 10,000 Ã· 28.015 = 357 æŸ¥è¯¢/ç§’

å“åº”æ—¶é—´è®¡ç®—ï¼š
å¹³å‡å“åº”æ—¶é—´ = 28.015ç§’ Ã· 10,000ä¸ªæŸ¥è¯¢ = 0.0028ç§’ = 2.8æ¯«ç§’
```

### 5.2 æ€§èƒ½ç“¶é¢ˆè¯†åˆ«


**ğŸ” å¸¸è§æ€§èƒ½é—®é¢˜è¯†åˆ«**

```markdown
ğŸ“Š **æ€§èƒ½é—®é¢˜è¯Šæ–­è¡¨**
| ç°è±¡ | å¯èƒ½åŸå›  | è§£å†³æ–¹å‘ | éªŒè¯æ–¹æ³• |
|------|----------|----------|----------|
| **QPSå¾ˆä½** | æ…¢æŸ¥è¯¢ã€ç¼ºå°‘ç´¢å¼• | ä¼˜åŒ–SQLã€æ·»åŠ ç´¢å¼• | EXPLAINåˆ†æ |
| **å“åº”æ—¶é—´é•¿** | è¡¨é”äº‰ç”¨ã€IOç“¶é¢ˆ | ä¼˜åŒ–é”ç­–ç•¥ã€å‡çº§ç¡¬ä»¶ | ç›‘æ§é”ç­‰å¾… |
| **å¹¶å‘ä¸Šä¸å»** | è¿æ¥æ•°é™åˆ¶ã€å†…å­˜ä¸è¶³ | è°ƒæ•´é…ç½®ã€æ‰©å®¹ | æ£€æŸ¥ç³»ç»Ÿèµ„æº |
| **æ—¶å¿«æ—¶æ…¢** | ç¼“å­˜å‘½ä¸­ç‡ä½ | ä¼˜åŒ–ç¼“å­˜ç­–ç•¥ | ç›‘æ§ç¼“å­˜æŒ‡æ ‡ |
```

**ğŸš¨ å‘Šè­¦é˜ˆå€¼è®¾å®š**
```
æ€§èƒ½å‘Šè­¦æ ‡å‡†ï¼š
ğŸŸ¢ æ­£å¸¸ï¼š    å“åº”æ—¶é—´ < 100ms,  QPS > 500
ğŸŸ¡ æ³¨æ„ï¼š    å“åº”æ—¶é—´ 100-500ms, QPS 200-500  
ğŸŸ  è­¦å‘Šï¼š    å“åº”æ—¶é—´ 500ms-2s,  QPS 50-200
ğŸ”´ ä¸¥é‡ï¼š    å“åº”æ—¶é—´ > 2s,      QPS < 50
```

### 5.3 ä¼˜åŒ–å»ºè®®ä¸æœ€ä½³å®è·µ


**ğŸ”§ æ•°æ®åº“é…ç½®ä¼˜åŒ–**
```sql
-- åŸºäºæµ‹è¯•ç»“æœçš„é…ç½®è°ƒä¼˜å»ºè®®
-- å¦‚æœè¿æ¥æ•°æ˜¯ç“¶é¢ˆï¼Œè°ƒæ•´è¿æ¥ç›¸å…³å‚æ•°
SET GLOBAL max_connections = 500;
SET GLOBAL max_user_connections = 450;

-- å¦‚æœå†…å­˜ä¸è¶³ï¼Œè°ƒæ•´ç¼“å­˜å¤§å°  
SET GLOBAL innodb_buffer_pool_size = '2G';
SET GLOBAL query_cache_size = '256M';

-- å¦‚æœå¹¶å‘å†™å…¥æ…¢ï¼Œè°ƒæ•´äº‹åŠ¡ç›¸å…³å‚æ•°
SET GLOBAL innodb_flush_log_at_trx_commit = 2;
SET GLOBAL sync_binlog = 0;
```

**ğŸ’¡ åº”ç”¨å±‚ä¼˜åŒ–å»ºè®®**
```
è¿æ¥æ± ä¼˜åŒ–ï¼š
- è®¾ç½®åˆé€‚çš„è¿æ¥æ± å¤§å°ï¼ˆé€šå¸¸ä¸ºCPUæ ¸æ•°çš„2-4å€ï¼‰
- é…ç½®è¿æ¥è¶…æ—¶å’Œå›æ”¶æœºåˆ¶
- ä½¿ç”¨é•¿è¿æ¥å‡å°‘è¿æ¥å¼€é”€

SQLä¼˜åŒ–ï¼š
- ä¸ºé«˜é¢‘æŸ¥è¯¢æ·»åŠ é€‚å½“ç´¢å¼•
- é¿å…SELECT * æŸ¥è¯¢
- ä½¿ç”¨æ‰¹é‡æ“ä½œä»£æ›¿å•æ¡æ“ä½œ
- åˆç†ä½¿ç”¨åˆ†é¡µLIMIT

æ¶æ„ä¼˜åŒ–ï¼š
- è¯»å†™åˆ†ç¦»å‡è½»ä¸»åº“å‹åŠ›
- ä½¿ç”¨Redisç¼“å­˜çƒ­ç‚¹æ•°æ®
- è€ƒè™‘åˆ†åº“åˆ†è¡¨æ–¹æ¡ˆ
```

### 5.4 å®¹é‡è§„åˆ’æŒ‡å¯¼


**ğŸ“Š å®¹é‡è¯„ä¼°æ–¹æ³•**
```
åŸºäºæµ‹è¯•ç»“æœè¯„ä¼°ï¼š

å•æœºæ‰¿è½½èƒ½åŠ›è¯„ä¼°ï¼š
- æµ‹è¯•å¾—å‡ºï¼š50å¹¶å‘æ—¶QPS=300ï¼Œå“åº”æ—¶é—´100ms
- æ¨ç®—ï¼š100å¹¶å‘æ—¶QPSçº¦500ï¼Œå“åº”æ—¶é—´çº¦200ms
- å»ºè®®ï¼šç”Ÿäº§ç¯å¢ƒæ§åˆ¶åœ¨80å¹¶å‘ä»¥å†…ä¿è¯ç¨³å®š

ç¡¬ä»¶é…ç½®å»ºè®®ï¼š
å½“å‰é…ç½®ï¼š4æ ¸CPUï¼Œ8Gå†…å­˜ï¼Œæœºæ¢°ç¡¬ç›˜
æµ‹è¯•ç»“æœï¼šQPS=300
å¦‚æœç›®æ ‡QPS=1000ï¼Œéœ€è¦ï¼š
- CPUï¼šè‡³å°‘8æ ¸ï¼ˆæå‡å¹¶å‘å¤„ç†èƒ½åŠ›ï¼‰
- å†…å­˜ï¼šè‡³å°‘16Gï¼ˆå¢å¤§ç¼“å­˜å‘½ä¸­ç‡ï¼‰
- å­˜å‚¨ï¼šSSDç¡¬ç›˜ï¼ˆé™ä½IOå»¶è¿Ÿï¼‰
```

---

## 6. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 6.1 å¿…é¡»æŒæ¡çš„åŸºæœ¬æ¦‚å¿µ


```
ğŸ¯ **mysqlslapæ ¸å¿ƒç†è§£**
- å‹åŠ›æµ‹è¯•å·¥å…·ï¼šæ¨¡æ‹ŸçœŸå®ç”¨æˆ·è®¿é—®å‹åŠ›
- å®˜æ–¹å·¥å…·ï¼šMySQLè‡ªå¸¦ï¼Œå…è´¹å¯é 
- å¤šç»´åº¦æµ‹è¯•ï¼šå¹¶å‘ã€ååé‡ã€å“åº”æ—¶é—´
- åœºæ™¯æ¨¡æ‹Ÿï¼šå¯ä»¥æ¨¡æ‹Ÿå„ç§ä¸šåŠ¡åœºæ™¯

ğŸ”§ **å…³é”®åŠŸèƒ½ç‰¹æ€§**  
- å¹¶å‘è¿æ¥æµ‹è¯•ï¼šéªŒè¯å¤šç”¨æˆ·è®¿é—®èƒ½åŠ›
- è‡ªå®šä¹‰SQLæµ‹è¯•ï¼šæµ‹è¯•ç‰¹å®šä¸šåŠ¡æŸ¥è¯¢
- è‡ªåŠ¨æ•°æ®ç”Ÿæˆï¼šæ— éœ€å‡†å¤‡æµ‹è¯•æ•°æ®
- æ€§èƒ½ç»Ÿè®¡æŠ¥å‘Šï¼šæä¾›è¯¦ç»†æ€§èƒ½æ•°æ®
```

### 6.2 å®é™…åº”ç”¨ä»·å€¼


**ğŸ’¼ ä¸šåŠ¡åº”ç”¨åœºæ™¯**
- **ä¸Šçº¿å‰éªŒè¯**ï¼šæ–°ç³»ç»Ÿä¸Šçº¿å‰çš„æ€§èƒ½éªŒæ”¶
- **å®¹é‡è§„åˆ’**ï¼šè¯„ä¼°éœ€è¦å¤šå°‘ç¡¬ä»¶èµ„æº
- **ä¼˜åŒ–æŒ‡å¯¼**ï¼šæ‰¾å‡ºæ€§èƒ½ç“¶é¢ˆå’Œä¼˜åŒ–æ–¹å‘
- **æ—¥å¸¸ç›‘æ§**ï¼šå®šæœŸæ£€æŸ¥ç³»ç»Ÿæ€§èƒ½çŠ¶å†µ

**ğŸ¯ ä½¿ç”¨æ—¶æœº**
```
å¼€å‘é˜¶æ®µï¼šéªŒè¯SQLæ€§èƒ½ï¼Œå‘ç°æ…¢æŸ¥è¯¢
æµ‹è¯•é˜¶æ®µï¼šå‹åŠ›æµ‹è¯•ï¼ŒéªŒè¯ç³»ç»Ÿæ‰¿è½½èƒ½åŠ›  
ä¸Šçº¿å‰ï¼š  æœ€ç»ˆæ€§èƒ½éªŒæ”¶ï¼Œç¡®ä¿æ»¡è¶³éœ€æ±‚
è¿è¡Œä¸­ï¼š  å®šæœŸä½“æ£€ï¼Œç›‘æ§æ€§èƒ½å˜åŒ–è¶‹åŠ¿
```

### 6.3 æœ€ä½³å®è·µæ€»ç»“


**âœ… ä½¿ç”¨å»ºè®®**
```
æµ‹è¯•ç­–ç•¥ï¼š
- ä»å°å‹åŠ›å¼€å§‹ï¼Œé€æ­¥å¢åŠ å¹¶å‘æ•°
- å¤šæ¬¡æµ‹è¯•å–å¹³å‡å€¼ï¼Œé¿å…å¶ç„¶å› ç´ 
- ç»“åˆä¸šåŠ¡åœºæ™¯è®¾è®¡æµ‹è¯•ç”¨ä¾‹
- å…³æ³¨ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ

æ³¨æ„äº‹é¡¹ï¼š
- ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒç›´æ¥æµ‹è¯•
- æµ‹è¯•æ•°æ®è¦æ¥è¿‘çœŸå®æ•°æ®è§„æ¨¡
- å…³æ³¨æµ‹è¯•è¿‡ç¨‹ä¸­çš„ç³»ç»Ÿç¨³å®šæ€§
- ç»“åˆå…¶ä»–ç›‘æ§å·¥å…·å…¨é¢åˆ†æ
```

**ğŸš¨ å¸¸è§è¯¯åŒºé¿å…**
```
é”™è¯¯åšæ³• â†’ æ­£ç¡®åšæ³•ï¼š
åªæµ‹è¯•å³°å€¼æ€§èƒ½ â†’ æµ‹è¯•ä¸åŒå‹åŠ›çº§åˆ«çš„æ€§èƒ½è¡¨ç°
å¿½ç•¥ä¸šåŠ¡åœºæ™¯ â†’ åŸºäºå®é™…ä¸šåŠ¡è®¾è®¡æµ‹è¯•ç”¨ä¾‹  
å•æ¬¡æµ‹è¯•ä¸‹ç»“è®º â†’ å¤šè½®æµ‹è¯•å–å¹³å‡å€¼
åªçœ‹QPSæŒ‡æ ‡ â†’ ç»¼åˆåˆ†æå“åº”æ—¶é—´ã€ç³»ç»Ÿèµ„æºç­‰
```

**ğŸ§  æ ¸å¿ƒè®°å¿†è¦ç‚¹**
```
mysqlslapä¸‰å¤§æ ¸å¿ƒç”¨é€”ï¼š
1. å‹åŠ›æµ‹è¯• - æ‰¾å‡ºç³»ç»Ÿæ‰¿è½½æé™
2. æ€§èƒ½åˆ†æ - è¯†åˆ«æ€§èƒ½ç“¶é¢ˆé—®é¢˜  
3. å®¹é‡è§„åˆ’ - æŒ‡å¯¼ç¡¬ä»¶é…ç½®å†³ç­–

å…³é”®å‘½ä»¤å‚æ•°ï¼š
--concurrency    å¹¶å‘ç”¨æˆ·æ•°ï¼ˆæ ¸å¿ƒå‚æ•°ï¼‰
--iterations     æµ‹è¯•è½®æ¬¡ï¼ˆä¿è¯ç»“æœå¯é ï¼‰
--query          è‡ªå®šä¹‰SQLï¼ˆè´´è¿‘ä¸šåŠ¡åœºæ™¯ï¼‰
--number-of-queries  æ€»æŸ¥è¯¢æ•°ï¼ˆæ§åˆ¶æµ‹è¯•å¼ºåº¦ï¼‰
```

**è®°å¿†å£è¯€**ï¼š
- mysqlslapå‹åŠ›æµ‹ï¼Œå®˜æ–¹å·¥å…·å¾ˆå¯é 
- å¹¶å‘è¿æ¥åŠ æŸ¥è¯¢ï¼Œæ€§èƒ½ç“¶é¢ˆå…¨çŸ¥æ™“  
- å®¹é‡è§„åˆ’æœ‰ä¾æ®ï¼Œç³»ç»Ÿä¼˜åŒ–æ–¹å‘æ˜
- ä¸Šçº¿ä¹‹å‰å…ˆä½“æ£€ï¼Œç”Ÿäº§ç¨³å®šæœ‰ä¿éšœ