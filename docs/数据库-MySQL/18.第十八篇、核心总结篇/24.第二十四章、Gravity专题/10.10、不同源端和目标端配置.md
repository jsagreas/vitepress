---
title: 10ã€ä¸åŒæºç«¯å’Œç›®æ ‡ç«¯é…ç½®
---
## ğŸ“š ç›®å½•

1. [é…ç½®ç¤ºä¾‹æ¦‚è§ˆ](#1-é…ç½®ç¤ºä¾‹æ¦‚è§ˆ)
2. [MySQLåˆ°MySQLåŒæ­¥é…ç½®](#2-MySQLåˆ°MySQLåŒæ­¥é…ç½®)
3. [MySQLåˆ°æ¶ˆæ¯é˜Ÿåˆ—é…ç½®](#3-MySQLåˆ°æ¶ˆæ¯é˜Ÿåˆ—é…ç½®)
4. [MySQLåˆ°æ•°æ®ä»“åº“é…ç½®](#4-MySQLåˆ°æ•°æ®ä»“åº“é…ç½®)
5. [NoSQLæºç«¯é…ç½®ç¤ºä¾‹](#5-NoSQLæºç«¯é…ç½®ç¤ºä¾‹)
6. [é«˜çº§é…ç½®æ¨¡å¼](#6-é«˜çº§é…ç½®æ¨¡å¼)
7. [é…ç½®ç®¡ç†æœ€ä½³å®è·µ](#7-é…ç½®ç®¡ç†æœ€ä½³å®è·µ)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ” é…ç½®ç¤ºä¾‹æ¦‚è§ˆ


### 1.1 Gravityæ”¯æŒçš„æ•°æ®æºç±»å‹


**ä»€ä¹ˆæ˜¯æ•°æ®åŒæ­¥é…ç½®ï¼Ÿ**
ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å‘Šè¯‰Gravityï¼š**ä»å“ªé‡Œå–æ•°æ®**ï¼ˆæºç«¯ï¼‰ã€**å¾€å“ªé‡Œæ”¾æ•°æ®**ï¼ˆç›®æ ‡ç«¯ï¼‰ã€**æ€ä¹ˆå¤„ç†æ•°æ®**ï¼ˆè§„åˆ™é…ç½®ï¼‰ã€‚

```
æ•°æ®åŒæ­¥é…ç½®çš„æœ¬è´¨ï¼š
æºç«¯ â†’ [å¤„ç†è§„åˆ™] â†’ ç›®æ ‡ç«¯

ä¸¾ä¸ªä¾‹å­ï¼š
MySQL â†’ [è¿‡æ»¤+è½¬æ¢] â†’ Kafka
å°±åƒæ¬å®¶ä¸€æ ·ï¼Œè¦çŸ¥é“ä»å“ªæ¬åˆ°å“ªï¼Œå“ªäº›ä¸œè¥¿è¦æ¬
```

### 1.2 æ”¯æŒçš„æ•°æ®æºç»„åˆ


| æºç«¯ç±»å‹ | ç›®æ ‡ç«¯ç±»å‹ | **ä½¿ç”¨åœºæ™¯** | **é…ç½®å¤æ‚åº¦** |
|---------|-----------|-------------|---------------|
| MySQL | MySQL | `æ•°æ®åº“è¿ç§»ã€ä¸»ä»å¤åˆ¶` | â­â­ |
| MySQL | Kafka | `å®æ—¶æ•°æ®æµã€äº‹ä»¶é©±åŠ¨` | â­â­â­ |
| MySQL | Elasticsearch | `å…¨æ–‡æœç´¢ã€æ—¥å¿—åˆ†æ` | â­â­â­ |
| MySQL | ClickHouse | `æ•°æ®åˆ†æã€OLAPæŸ¥è¯¢` | â­â­â­â­ |
| MongoDB | MySQL | `æ•°æ®è§„èŒƒåŒ–ã€å…³ç³»åŒ–` | â­â­â­â­ |
| PostgreSQL | Kafka | `äº‹ä»¶æµå¤„ç†` | â­â­â­ |

### 1.3 é…ç½®æ–‡ä»¶åŸºæœ¬ç»“æ„


```yaml
# Gravityé…ç½®æ–‡ä»¶çš„åŸºæœ¬éª¨æ¶
# å°±åƒå¡«è¡¨æ ¼ä¸€æ ·ï¼Œæ¯ä¸ªéƒ¨åˆ†éƒ½æœ‰å›ºå®šçš„æ ¼å¼

name: "my-sync-job"           # ç»™è¿™ä¸ªåŒæ­¥ä»»åŠ¡èµ·ä¸ªåå­—
version: "1.0"                # é…ç½®ç‰ˆæœ¬å·

# æºç«¯é…ç½®ï¼šæ•°æ®ä»å“ªæ¥
input:
  type: "mysql"               # æºç«¯ç±»å‹
  config:                     # å…·ä½“çš„è¿æ¥é…ç½®
    host: "æºæ•°æ®åº“åœ°å€"
    # å…¶ä»–é…ç½®...

# ç›®æ ‡ç«¯é…ç½®ï¼šæ•°æ®åˆ°å“ªå»  
output:
  type: "kafka"               # ç›®æ ‡ç«¯ç±»å‹
  config:                     # å…·ä½“çš„è¿æ¥é…ç½®
    brokers: "Kafkaåœ°å€"
    # å…¶ä»–é…ç½®...

# å¤„ç†è§„åˆ™ï¼šæ€ä¹ˆå¤„ç†æ•°æ®
filters:                      # è¿‡æ»¤å’Œè½¬æ¢è§„åˆ™
  - type: "table-filter"      # è¡¨è¿‡æ»¤
  - type: "column-map"        # åˆ—æ˜ å°„
```

---

## 2. ğŸ—„ï¸ MySQLåˆ°MySQLåŒæ­¥é…ç½®


### 2.1 åŸºç¡€MySQLåˆ°MySQLé…ç½®


**ä½¿ç”¨åœºæ™¯ï¼š** ä¸»ä»å¤åˆ¶ã€æ•°æ®è¿ç§»ã€å¤‡ä»½åŒæ­¥

```yaml
# MySQLåˆ°MySQLçš„æœ€ç®€é…ç½®
# é€‚ç”¨äºï¼šæ•°æ®åº“è¿ç§»ã€ä¸»ä»å¤‡ä»½
name: "mysql-to-mysql-basic"
version: "1.0"

# æºç«¯MySQLé…ç½®
input:
  type: "mysql"
  config:
    # æ•°æ®åº“è¿æ¥ä¿¡æ¯
    host: "192.168.1.100"      # æºæ•°æ®åº“IP
    port: 3306                 # ç«¯å£å·
    username: "replication"    # ä¸“ç”¨çš„å¤åˆ¶ç”¨æˆ·
    password: "your_password"  # å¯†ç 
    database: "ecommerce"      # è¦åŒæ­¥çš„æ•°æ®åº“å
    
    # MySQLç‰¹æœ‰é…ç½®
    server-id: 12345           # å”¯ä¸€çš„æœåŠ¡å™¨ID
    binlog-file: ""            # ç©ºè¡¨ç¤ºä»æœ€æ–°å¼€å§‹
    binlog-pos: 0              # ä½ç½®è®¾ä¸º0
    
    # è¿æ¥æ± é…ç½®ï¼ˆå¯é€‰ï¼‰
    max-connections: 10        # æœ€å¤§è¿æ¥æ•°
    idle-timeout: "30s"        # ç©ºé—²è¶…æ—¶

# ç›®æ ‡ç«¯MySQLé…ç½®  
output:
  type: "mysql"
  config:
    host: "192.168.1.200"      # ç›®æ ‡æ•°æ®åº“IP
    port: 3306
    username: "writer"         # å†™å…¥ç”¨æˆ·
    password: "write_password"
    database: "ecommerce_backup" # ç›®æ ‡æ•°æ®åº“å
    
    # å†™å…¥é…ç½®
    batch-size: 1000           # æ‰¹é‡å†™å…¥å¤§å°
    flush-interval: "5s"       # åˆ·æ–°é—´éš”
    max-retry: 3               # å¤±è´¥é‡è¯•æ¬¡æ•°

# åŒæ­¥è§„åˆ™
filters:
  # åªåŒæ­¥ç‰¹å®šè¡¨
  - type: "table-filter"
    config:
      tables: 
        - "users"              # ç”¨æˆ·è¡¨
        - "orders"             # è®¢å•è¡¨
        - "products"           # å•†å“è¡¨
```

### 2.2 MySQLè·¨æœºæˆ¿åŒæ­¥é…ç½®


**ä½¿ç”¨åœºæ™¯ï¼š** è·¨åœ°åŸŸæ•°æ®åŒæ­¥ã€ç¾å¤‡

```yaml
# è·¨æœºæˆ¿MySQLåŒæ­¥é…ç½®
# è§£å†³ç½‘ç»œå»¶è¿Ÿã€æ–­çº¿é‡è¿ç­‰é—®é¢˜
name: "mysql-cross-datacenter"
version: "1.0"

input:
  type: "mysql"
  config:
    # åŸºç¡€è¿æ¥
    host: "beijing.mysql.internal"
    port: 3306
    username: "replicator"
    password: "${MYSQL_REPL_PASSWORD}"  # ä½¿ç”¨ç¯å¢ƒå˜é‡
    database: "production"
    
    # ç½‘ç»œä¼˜åŒ–é…ç½®
    connect-timeout: "30s"     # è¿æ¥è¶…æ—¶å»¶é•¿
    read-timeout: "60s"        # è¯»å–è¶…æ—¶å»¶é•¿
    write-timeout: "30s"       # å†™å…¥è¶…æ—¶
    
    # æ–­çº¿é‡è¿é…ç½®
    max-reconnect: 10          # æœ€å¤§é‡è¿æ¬¡æ•°
    reconnect-interval: "5s"   # é‡è¿é—´éš”
    
    # binlogé…ç½®
    server-id: 10001           # å”¯ä¸€ID
    include-table-regex:       # æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤
      - "user_.*"              # æ‰€æœ‰userå¼€å¤´çš„è¡¨
      - "order_.*"             # æ‰€æœ‰orderå¼€å¤´çš„è¡¨

output:
  type: "mysql"
  config:
    host: "shanghai.mysql.internal"
    port: 3306
    username: "sync_writer"
    password: "${MYSQL_WRITE_PASSWORD}"
    database: "production_backup"
    
    # å†™å…¥æ€§èƒ½ä¼˜åŒ–
    batch-size: 2000           # å¢å¤§æ‰¹é‡å¤§å°
    batch-timeout: "10s"       # æ‰¹é‡è¶…æ—¶
    parallel-workers: 4        # å¹¶è¡Œå†™å…¥çº¿ç¨‹
    
    # é”™è¯¯å¤„ç†
    ignore-duplicate-key: true # å¿½ç•¥ä¸»é”®å†²çª
    max-retry: 5              # å¢åŠ é‡è¯•æ¬¡æ•°
```

---

## 3. ğŸ“¨ MySQLåˆ°æ¶ˆæ¯é˜Ÿåˆ—é…ç½®


### 3.1 MySQLåˆ°Kafkaé…ç½®


**ä½¿ç”¨åœºæ™¯ï¼š** å®æ—¶æ•°æ®æµã€äº‹ä»¶é©±åŠ¨æ¶æ„ã€å¾®æœåŠ¡è§£è€¦

```yaml
# MySQLåˆ°Kafkaé…ç½®
# æŠŠæ•°æ®åº“å˜æ›´è½¬æˆäº‹ä»¶æµ
name: "mysql-to-kafka-events"
version: "1.0"

input:
  type: "mysql"
  config:
    host: "mysql.production.com"
    port: 3306
    username: "binlog_reader"
    password: "${MYSQL_PASSWORD}"
    database: "ecommerce"
    
    # binlogé…ç½®
    server-id: 20001
    binlog-format: "ROW"       # å¿…é¡»æ˜¯ROWæ ¼å¼
    
    # ç›‘å¬çš„è¡¨
    include-tables:
      - "orders"               # è®¢å•è¡¨
      - "payments"             # æ”¯ä»˜è¡¨
      - "user_activities"      # ç”¨æˆ·è¡Œä¸ºè¡¨

output:
  type: "kafka"
  config:
    # Kafkaé›†ç¾¤åœ°å€
    brokers: 
      - "kafka1.internal:9092"
      - "kafka2.internal:9092"
      - "kafka3.internal:9092"
    
    # Topicé…ç½®
    topic-prefix: "mysql."     # Topicå‰ç¼€
    # æœ€ç»ˆTopicå: mysql.ecommerce.orders
    
    # æ¶ˆæ¯é…ç½®
    key-format: "json"         # æ¶ˆæ¯keyæ ¼å¼
    value-format: "json"       # æ¶ˆæ¯å€¼æ ¼å¼
    
    # æ€§èƒ½é…ç½®
    batch-size: 500           # æ‰¹é‡å‘é€å¤§å°
    compression: "gzip"       # å‹ç¼©ç®—æ³•
    
    # å¯é æ€§é…ç½®
    acks: "all"              # ç­‰å¾…æ‰€æœ‰å‰¯æœ¬ç¡®è®¤
    retries: 3               # é‡è¯•æ¬¡æ•°
    
    # è®¤è¯é…ç½®ï¼ˆå¦‚æœéœ€è¦ï¼‰
    security-protocol: "SASL_SSL"
    sasl-mechanism: "PLAIN"
    sasl-username: "kafka_user"
    sasl-password: "${KAFKA_PASSWORD}"

# æ•°æ®è½¬æ¢é…ç½®
filters:
  # å­—æ®µæ˜ å°„
  - type: "column-map"
    config:
      mappings:
        "user_id": "userId"    # é©¼å³°å‘½åè½¬æ¢
        "order_id": "orderId"
        "created_at": "timestamp"
  
  # æ·»åŠ å…ƒæ•°æ®
  - type: "add-metadata"
    config:
      fields:
        "source": "mysql"     # æ ‡è®°æ•°æ®æº
        "sync_time": "@now"   # åŒæ­¥æ—¶é—´æˆ³
```

### 3.2 MySQLåˆ°å¤šä¸ªKafka Topicé…ç½®


```yaml
# æ ¹æ®è¡¨åè·¯ç”±åˆ°ä¸åŒTopic
name: "mysql-to-kafka-routing"
version: "1.0"

input:
  type: "mysql"
  config:
    host: "mysql.app.com"
    port: 3306
    username: "reader"
    password: "${DB_PASSWORD}"
    database: "business"

output:
  type: "kafka"
  config:
    brokers: ["kafka.cluster:9092"]
    
    # è·¯ç”±è§„åˆ™ï¼šæ ¹æ®è¡¨åå†³å®šTopic
    routing:
      - table: "users"
        topic: "user-events"
        partition-key: "user_id"    # æŒ‰ç”¨æˆ·IDåˆ†åŒº
        
      - table: "orders"  
        topic: "order-events"
        partition-key: "order_id"   # æŒ‰è®¢å•IDåˆ†åŒº
        
      - table: "products"
        topic: "product-events" 
        partition-key: "category_id" # æŒ‰åˆ†ç±»IDåˆ†åŒº
    
    # é»˜è®¤é…ç½®
    default-topic: "misc-events"   # å…¶ä»–è¡¨çš„é»˜è®¤Topic
```

---

## 4. ğŸ¢ MySQLåˆ°æ•°æ®ä»“åº“é…ç½®


### 4.1 MySQLåˆ°Elasticsearché…ç½®


**ä½¿ç”¨åœºæ™¯ï¼š** å…¨æ–‡æœç´¢ã€æ—¥å¿—åˆ†æã€å®æ—¶æŸ¥è¯¢

```yaml
# MySQLåˆ°Elasticsearché…ç½®
# ç”¨äºæ„å»ºæœç´¢ç³»ç»Ÿ
name: "mysql-to-elasticsearch"
version: "1.0"

input:
  type: "mysql"
  config:
    host: "mysql.search.com"
    port: 3306
    username: "search_reader"
    password: "${MYSQL_SEARCH_PASSWORD}"
    database: "content"
    
    # åªåŒæ­¥éœ€è¦æœç´¢çš„è¡¨
    include-tables:
      - "articles"             # æ–‡ç« è¡¨
      - "products"             # å•†å“è¡¨
      - "users"                # ç”¨æˆ·è¡¨

output:
  type: "elasticsearch"
  config:
    # ESé›†ç¾¤é…ç½®
    hosts:
      - "https://es1.search.com:9200"
      - "https://es2.search.com:9200"
    
    # è®¤è¯ä¿¡æ¯
    username: "elastic"
    password: "${ES_PASSWORD}"
    
    # ç´¢å¼•é…ç½®
    index-prefix: "mysql_"     # ç´¢å¼•å‰ç¼€
    # æœ€ç»ˆç´¢å¼•å: mysql_articles_2023_09
    
    # æ–‡æ¡£é…ç½®
    document-id-field: "id"    # ç”¨å“ªä¸ªå­—æ®µä½œä¸ºæ–‡æ¡£ID
    
    # æ€§èƒ½é…ç½®
    bulk-size: 1000           # æ‰¹é‡ç´¢å¼•å¤§å°
    bulk-timeout: "30s"       # æ‰¹é‡è¶…æ—¶
    flush-interval: "5s"      # åˆ·æ–°é—´éš”

# æ•°æ®å¤„ç†è§„åˆ™
filters:
  # å…¨æ–‡æœç´¢å­—æ®µå¤„ç†
  - type: "text-process"
    config:
      # æ–‡ç« å†…å®¹å¤„ç†
      text-fields:
        - field: "content"
          analyzer: "ik_smart"  # ä¸­æ–‡åˆ†è¯å™¨
          max-length: 10000     # æœ€å¤§é•¿åº¦é™åˆ¶
        
        - field: "title"
          analyzer: "ik_max_word"
          boost: 2.0           # æ ‡é¢˜æƒé‡åŠ å€
  
  # æ—¶é—´å­—æ®µå¤„ç†  
  - type: "datetime-format"
    config:
      fields:
        "created_at": "yyyy-MM-dd HH:mm:ss"
        "updated_at": "yyyy-MM-dd HH:mm:ss"
  
  # åˆ é™¤ä¸éœ€è¦ç´¢å¼•çš„å­—æ®µ
  - type: "field-filter"
    config:
      exclude:
        - "password"           # æ•æ„Ÿä¿¡æ¯
        - "internal_notes"     # å†…éƒ¨å¤‡æ³¨
```

### 4.2 MySQLåˆ°ClickHouseé…ç½®


**ä½¿ç”¨åœºæ™¯ï¼š** æ•°æ®åˆ†æã€OLAPæŸ¥è¯¢ã€æŠ¥è¡¨ç³»ç»Ÿ

```yaml
# MySQLåˆ°ClickHouseé…ç½®
# ç”¨äºæ•°æ®åˆ†æå’ŒæŠ¥è¡¨
name: "mysql-to-clickhouse-analytics"
version: "1.0"

input:
  type: "mysql"
  config:
    host: "mysql.oltp.com"
    port: 3306
    username: "analytics_reader"
    password: "${MYSQL_ANALYTICS_PASSWORD}"
    database: "business"
    
    # åªåŒæ­¥åˆ†æç›¸å…³çš„è¡¨
    include-tables:
      - "order_items"          # è®¢å•æ˜ç»†
      - "user_behaviors"       # ç”¨æˆ·è¡Œä¸º
      - "product_views"        # å•†å“æµè§ˆ

output:
  type: "clickhouse"
  config:
    # ClickHouseè¿æ¥
    host: "clickhouse.analytics.com"
    port: 9000
    username: "writer"
    password: "${CH_PASSWORD}"
    database: "analytics"
    
    # è¡¨é…ç½®
    table-prefix: "mysql_"     # è¡¨åå‰ç¼€
    
    # å†™å…¥é…ç½®
    batch-size: 10000         # å¤§æ‰¹é‡å†™å…¥
    batch-timeout: "60s"      # è¾ƒé•¿çš„æ‰¹é‡è¶…æ—¶
    
    # ClickHouseç‰¹æœ‰é…ç½®
    engine: "MergeTree"       # å­˜å‚¨å¼•æ“
    partition-by: "toYYYYMM(created_at)" # æŒ‰æœˆåˆ†åŒº
    order-by: "created_at"    # æ’åºé”®

# æ•°æ®è½¬æ¢è§„åˆ™
filters:
  # æ•°æ®ç±»å‹è½¬æ¢
  - type: "type-convert"
    config:
      conversions:
        "price": "Decimal(10,2)"      # ç²¾ç¡®çš„ä»·æ ¼ç±»å‹
        "quantity": "UInt32"          # æ— ç¬¦å·æ•´æ•°
        "created_at": "DateTime"      # æ—¶é—´ç±»å‹
  
  # æ·»åŠ åˆ†æå­—æ®µ
  - type: "add-computed"
    config:
      fields:
        "total_amount": "price * quantity"  # è®¡ç®—æ€»é‡‘é¢
        "date_only": "toDate(created_at)"   # æå–æ—¥æœŸ
        "hour_only": "toHour(created_at)"   # æå–å°æ—¶
  
  # æ•°æ®æ¸…æ´—
  - type: "data-clean"
    config:
      # å¤„ç†å¼‚å¸¸å€¼
      rules:
        - field: "price"
          condition: "< 0"
          action: "set_to_zero"     # è´Ÿä»·æ ¼è®¾ä¸º0
        - field: "quantity"  
          condition: "> 10000"
          action: "set_to_10000"    # æ•°é‡ä¸Šé™
```

---

## 5. ğŸƒ NoSQLæºç«¯é…ç½®ç¤ºä¾‹


### 5.1 MongoDBåˆ°MySQLé…ç½®


**ä½¿ç”¨åœºæ™¯ï¼š** æ•°æ®è§„èŒƒåŒ–ã€å…³ç³»åŒ–æŸ¥è¯¢ã€æŠ¥è¡¨ç”Ÿæˆ

```yaml
# MongoDBåˆ°MySQLé…ç½®
# æŠŠæ–‡æ¡£æ•°æ®è½¬æˆå…³ç³»å‹æ•°æ®
name: "mongodb-to-mysql-normalize"
version: "1.0"

input:
  type: "mongodb"
  config:
    # MongoDBè¿æ¥
    uri: "mongodb://mongo.app.com:27017"
    database: "social_app"
    username: "reader"
    password: "${MONGO_PASSWORD}"
    
    # ç›‘å¬çš„é›†åˆ
    collections:
      - "users"                # ç”¨æˆ·é›†åˆ
      - "posts"                # å¸–å­é›†åˆ  
      - "comments"             # è¯„è®ºé›†åˆ
    
    # MongoDBç‰¹æœ‰é…ç½®
    replica-set: "rs0"         # å‰¯æœ¬é›†åç§°
    read-preference: "secondary" # ä»å‰¯æœ¬è¯»å–
    
    # å˜æ›´æµé…ç½®
    change-stream:
      full-document: "updateLookup" # è·å–å®Œæ•´æ–‡æ¡£

output:
  type: "mysql"
  config:
    host: "mysql.warehouse.com"
    port: 3306
    username: "warehouse_writer"
    password: "${MYSQL_WAREHOUSE_PASSWORD}"
    database: "social_warehouse"
    
    # è¡¨ç»“æ„è‡ªåŠ¨åˆ›å»º
    auto-create-table: true    # è‡ªåŠ¨å»ºè¡¨
    table-charset: "utf8mb4"   # æ”¯æŒemoji

# æ–‡æ¡£åˆ°å…³ç³»å‹è½¬æ¢
filters:
  # æ–‡æ¡£å±•å¹³
  - type: "document-flatten"
    config:
      # åµŒå¥—å¯¹è±¡å¤„ç†
      nested-objects:
        "profile": "profile_"   # profile.name -> profile_name
        "address": "addr_"      # address.city -> addr_city
      
      # æ•°ç»„å¤„ç†
      arrays:
        "tags": "separate_table" # æ ‡ç­¾å•ç‹¬å»ºè¡¨
        "skills": "json_string"  # æŠ€èƒ½è½¬JSONå­—ç¬¦ä¸²
  
  # æ•°æ®ç±»å‹æ˜ å°„
  - type: "type-mapping"
    config:
      mappings:
        "ObjectId": "VARCHAR(24)"    # MongoDB ID
        "Date": "DATETIME"           # æ—¥æœŸç±»å‹
        "NumberLong": "BIGINT"       # é•¿æ•´å‹
        "Boolean": "TINYINT(1)"      # å¸ƒå°”å‹
  
  # å­—æ®µé‡å‘½å
  - type: "field-rename"
    config:
      renames:
        "_id": "mongo_id"           # MongoDB IDå­—æ®µ
        "createdAt": "created_at"   # æ—¶é—´å­—æ®µè§„èŒƒåŒ–
        "updatedAt": "updated_at"
```

### 5.2 PostgreSQLåˆ°Kafkaé…ç½®


**ä½¿ç”¨åœºæ™¯ï¼š** äº‹ä»¶æµå¤„ç†ã€å¾®æœåŠ¡é€šä¿¡

```yaml
# PostgreSQLåˆ°Kafkaé…ç½®
# åˆ©ç”¨PostgreSQLçš„é€»è¾‘å¤åˆ¶åŠŸèƒ½
name: "postgresql-to-kafka-events"
version: "1.0"

input:
  type: "postgresql"
  config:
    # PostgreSQLè¿æ¥
    host: "postgres.app.com"
    port: 5432
    username: "replicator"
    password: "${PG_PASSWORD}"
    database: "application"
    
    # é€»è¾‘å¤åˆ¶é…ç½®
    slot-name: "gravity_slot"      # å¤åˆ¶æ§½åç§°
    publication: "gravity_pub"     # å‘å¸ƒåç§°
    
    # ç›‘å¬çš„è¡¨
    tables:
      - "public.events"            # äº‹ä»¶è¡¨
      - "public.notifications"     # é€šçŸ¥è¡¨
      - "audit.user_actions"       # å®¡è®¡è¡¨
    
    # è¿æ¥æ± é…ç½®
    max-connections: 5
    connection-timeout: "30s"

output:
  type: "kafka"
  config:
    brokers: ["kafka.events.com:9092"]
    
    # Topicé…ç½®
    topic-template: "pg.{schema}.{table}" # pg.public.events
    
    # æ¶ˆæ¯æ ¼å¼
    message-format: "avro"         # ä½¿ç”¨Avroæ ¼å¼
    schema-registry: "http://schema-registry:8081"
    
    # æ€§èƒ½é…ç½®
    producer:
      batch-size: 1000
      linger-ms: 100              # æ‰¹é‡å»¶è¿Ÿ
      compression-type: "snappy"   # å‹ç¼©ç±»å‹

# PostgreSQLç‰¹æœ‰å¤„ç†
filters:
  # JSONBå­—æ®µå¤„ç†
  - type: "jsonb-extract"
    config:
      fields:
        "metadata": ["user_id", "session_id"] # æå–JSONBå­—æ®µ
        "properties": ["category", "action"]
  
  # æ•°ç»„å­—æ®µå¤„ç†
  - type: "array-process"
    config:
      array-fields:
        "tags": "comma_separated"   # æ•°ç»„è½¬é€—å·åˆ†éš”
        "permissions": "json_array" # ä¿æŒJSONæ•°ç»„æ ¼å¼
```

---

## 6. ğŸ”€ é«˜çº§é…ç½®æ¨¡å¼


### 6.1 å¤šæºç«¯æ±‡èšé…ç½®


**ä½¿ç”¨åœºæ™¯ï¼š** æ•°æ®æ¹–å»ºè®¾ã€ç»Ÿä¸€æ•°æ®è§†å›¾

```yaml
# å¤šæºç«¯æ±‡èšåˆ°æ•°æ®æ¹–
# æŠŠä¸åŒæ•°æ®æºçš„æ•°æ®ç»Ÿä¸€æ”¶é›†
name: "multi-source-to-datalake"
version: "1.0"

# é…ç½®å¤šä¸ªè¾“å…¥æº
inputs:
  # MySQLä¸šåŠ¡æ•°æ®
  - name: "mysql-business"
    type: "mysql"
    config:
      host: "mysql.business.com"
      database: "ecommerce"
      username: "reader"
      password: "${MYSQL_BIZ_PASSWORD}"
      tables: ["orders", "users", "products"]
  
  # PostgreSQLç”¨æˆ·æ•°æ®  
  - name: "postgres-users"
    type: "postgresql"
    config:
      host: "postgres.users.com"
      database: "userdb" 
      username: "reader"
      password: "${PG_USER_PASSWORD}"
      tables: ["profiles", "preferences"]
  
  # MongoDBæ—¥å¿—æ•°æ®
  - name: "mongo-logs"
    type: "mongodb"
    config:
      uri: "mongodb://mongo.logs.com:27017"
      database: "logs"
      collections: ["access_logs", "error_logs"]

# ç»Ÿä¸€è¾“å‡ºåˆ°æ•°æ®æ¹–
output:
  type: "s3"                    # æˆ–è€…HDFSã€MinIOç­‰
  config:
    bucket: "company-datalake"
    region: "us-west-2"
    access-key: "${AWS_ACCESS_KEY}"
    secret-key: "${AWS_SECRET_KEY}"
    
    # åˆ†åŒºç­–ç•¥
    partition-by: 
      - "source"                # æŒ‰æ•°æ®æºåˆ†åŒº
      - "date"                  # æŒ‰æ—¥æœŸåˆ†åŒº
    
    # æ–‡ä»¶æ ¼å¼
    format: "parquet"           # åˆ—å¼å­˜å‚¨æ ¼å¼
    compression: "gzip"

# ç»Ÿä¸€æ•°æ®å¤„ç†
filters:
  # æ·»åŠ æ•°æ®æºæ ‡è¯†
  - type: "add-source-tag"
    config:
      source-field: "data_source" # æ ‡è®°æ•°æ®æ¥æº
  
  # ç»Ÿä¸€æ—¶é—´æ ¼å¼
  - type: "timestamp-normalize"
    config:
      target-format: "ISO8601"   # ç»Ÿä¸€æ—¶é—´æ ¼å¼
      timezone: "UTC"            # ç»Ÿä¸€æ—¶åŒº
  
  # æ•°æ®è´¨é‡æ£€æŸ¥
  - type: "data-quality"
    config:
      rules:
        - field: "user_id"
          required: true          # å¿…å¡«å­—æ®µ
        - field: "created_at"
          format: "datetime"      # æ ¼å¼æ£€æŸ¥
```

### 6.2 ä¸€å¯¹å¤šåˆ†å‘é…ç½®


**ä½¿ç”¨åœºæ™¯ï¼š** æ•°æ®åˆ†å‘ã€å¤šç³»ç»ŸåŒæ­¥

```yaml
# ä¸€å¯¹å¤šæ•°æ®åˆ†å‘
# ä¸€ä¸ªæ•°æ®æºåŒæ—¶åŒæ­¥åˆ°å¤šä¸ªç›®æ ‡
name: "one-to-many-distribution"
version: "1.0"

# å•ä¸€æ•°æ®æº
input:
  type: "mysql"
  config:
    host: "mysql.master.com"
    database: "central"
    username: "distributor"
    password: "${MYSQL_DIST_PASSWORD}"

# å¤šä¸ªè¾“å‡ºç›®æ ‡
outputs:
  # åˆ†å‘åˆ°ä»åº“
  - name: "slave-db"
    type: "mysql"
    config:
      host: "mysql.slave.com"
      database: "central_replica"
      username: "writer"
      password: "${MYSQL_SLAVE_PASSWORD}"
    
    # åªåŒæ­¥æ ¸å¿ƒè¡¨
    filters:
      - type: "table-filter"
        config:
          include: ["users", "orders"]
  
  # åˆ†å‘åˆ°ç¼“å­˜
  - name: "redis-cache"
    type: "redis"
    config:
      host: "redis.cache.com"
      port: 6379
      password: "${REDIS_PASSWORD}"
      database: 0
    
    # åªç¼“å­˜çƒ­ç‚¹æ•°æ®
    filters:
      - type: "hot-data-filter"
        config:
          conditions:
            - "updated_at > NOW() - INTERVAL 1 DAY"
  
  # åˆ†å‘åˆ°æœç´¢å¼•æ“
  - name: "elasticsearch"
    type: "elasticsearch" 
    config:
      hosts: ["es.search.com:9200"]
      username: "elastic"
      password: "${ES_PASSWORD}"
    
    # åªç´¢å¼•å¯æœç´¢å­—æ®µ
    filters:
      - type: "search-fields-only"
        config:
          include-fields: ["title", "content", "tags"]

# åˆ†å‘è·¯ç”±è§„åˆ™
routing:
  # æ ¹æ®è¡¨åè·¯ç”±
  by-table:
    "users": ["slave-db", "redis-cache"]       # ç”¨æˆ·æ•°æ®åˆ°ä»åº“å’Œç¼“å­˜
    "orders": ["slave-db", "elasticsearch"]    # è®¢å•åˆ°ä»åº“å’Œæœç´¢
    "products": ["elasticsearch"]              # å•†å“åªåˆ°æœç´¢å¼•æ“
  
  # æ ¹æ®æ“ä½œç±»å‹è·¯ç”±  
  by-operation:
    "INSERT": ["slave-db", "redis-cache", "elasticsearch"] # æ–°å¢åŒæ­¥åˆ°æ‰€æœ‰
    "UPDATE": ["slave-db", "redis-cache"]                  # æ›´æ–°åˆ°åº“å’Œç¼“å­˜
    "DELETE": ["slave-db"]                                 # åˆ é™¤åªåˆ°ä»åº“
```

### 6.3 å¼‚æ„æ•°æ®åº“é…ç½®æ¨¡æ¿


```yaml
# å¼‚æ„æ•°æ®åº“åŒæ­¥æ¨¡æ¿
# å¤„ç†ä¸åŒæ•°æ®åº“é—´çš„å·®å¼‚
name: "heterogeneous-db-sync"
version: "1.0"

# æ•°æ®ç±»å‹æ˜ å°„é…ç½®
type-mappings:
  # MySQLåˆ°PostgreSQLç±»å‹æ˜ å°„
  mysql-to-postgresql:
    "TINYINT": "SMALLINT"
    "INT": "INTEGER" 
    "BIGINT": "BIGINT"
    "VARCHAR(255)": "VARCHAR(255)"
    "TEXT": "TEXT"
    "DATETIME": "TIMESTAMP"
    "DECIMAL(10,2)": "NUMERIC(10,2)"
  
  # PostgreSQLåˆ°MySQLç±»å‹æ˜ å°„
  postgresql-to-mysql:
    "SMALLINT": "SMALLINT"
    "INTEGER": "INT"
    "BIGINT": "BIGINT" 
    "VARCHAR": "VARCHAR"
    "TEXT": "LONGTEXT"
    "TIMESTAMP": "DATETIME"
    "NUMERIC": "DECIMAL"

# å­—ç¬¦é›†è½¬æ¢é…ç½®
charset-conversion:
  source-charset: "utf8"         # æºå­—ç¬¦é›†
  target-charset: "utf8mb4"      # ç›®æ ‡å­—ç¬¦é›†
  
  # ç‰¹æ®Šå­—ç¬¦å¤„ç†
  special-chars:
    handle-emoji: true           # å¤„ç†emoji
    handle-unicode: true         # å¤„ç†Unicode

# ç´¢å¼•æ˜ å°„é…ç½®
index-mappings:
  # ä¸»é”®æ˜ å°„
  primary-key:
    strategy: "preserve"         # ä¿æŒåŸæœ‰ä¸»é”®
    
  # å¤–é”®æ˜ å°„
  foreign-key:
    strategy: "reference-check"  # æ£€æŸ¥å¼•ç”¨å®Œæ•´æ€§
    
  # ç´¢å¼•æ˜ å°„
  indexes:
    strategy: "recreate"         # é‡æ–°åˆ›å»ºç´¢å¼•
    naming: "prefix"             # ç´¢å¼•å‘½åç­–ç•¥
    prefix: "sync_"              # ç´¢å¼•å‰ç¼€

# æ•°æ®ä¸€è‡´æ€§é…ç½®
consistency:
  # äº‹åŠ¡å¤„ç†
  transaction:
    batch-size: 1000            # äº‹åŠ¡æ‰¹é‡å¤§å°
    timeout: "30s"              # äº‹åŠ¡è¶…æ—¶
  
  # å†²çªå¤„ç†
  conflict-resolution:
    strategy: "last-write-wins"  # å†²çªè§£å†³ç­–ç•¥
    
  # æ•°æ®æ ¡éªŒ
  validation:
    checksum: true              # ä½¿ç”¨æ ¡éªŒå’Œ
    row-count: true             # è¡Œæ•°éªŒè¯
```

---

## 7. ğŸ“‹ é…ç½®ç®¡ç†æœ€ä½³å®è·µ


### 7.1 ç¯å¢ƒå·®å¼‚åŒ–é…ç½®


**ä¸ºä»€ä¹ˆéœ€è¦ç¯å¢ƒå·®å¼‚åŒ–ï¼Ÿ**
ç®€å•è¯´ï¼Œå°±æ˜¯å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒçš„æ•°æ®åº“åœ°å€ã€ç”¨æˆ·åå¯†ç éƒ½ä¸ä¸€æ ·ï¼Œä½†é…ç½®é€»è¾‘æ˜¯ç›¸åŒçš„ã€‚

```yaml
# åŸºç¡€é…ç½®æ¨¡æ¿ (base.yaml)
name: "mysql-sync-${ENV}"        # ä½¿ç”¨ç¯å¢ƒå˜é‡
version: "1.0"

input:
  type: "mysql"
  config:
    host: "${MYSQL_SOURCE_HOST}"  # ä»ç¯å¢ƒå˜é‡è¯»å–
    port: ${MYSQL_SOURCE_PORT}
    username: "${MYSQL_SOURCE_USER}"
    password: "${MYSQL_SOURCE_PASSWORD}"
    database: "${MYSQL_SOURCE_DB}"

output:
  type: "mysql"
  config:
    host: "${MYSQL_TARGET_HOST}"
    port: ${MYSQL_TARGET_PORT}
    username: "${MYSQL_TARGET_USER}"  
    password: "${MYSQL_TARGET_PASSWORD}"
    database: "${MYSQL_TARGET_DB}"

# é€šç”¨è¿‡æ»¤è§„åˆ™
filters:
  - type: "table-filter"
    config:
      include: ${SYNC_TABLES}     # åŒæ­¥çš„è¡¨åˆ—è¡¨
```

```bash
# å¼€å‘ç¯å¢ƒé…ç½®æ–‡ä»¶ (dev.env)
ENV=dev
MYSQL_SOURCE_HOST=dev-mysql.internal
MYSQL_SOURCE_PORT=3306
MYSQL_SOURCE_USER=dev_reader
MYSQL_SOURCE_PASSWORD=dev_password
MYSQL_SOURCE_DB=app_dev

MYSQL_TARGET_HOST=dev-mysql-slave.internal
MYSQL_TARGET_PORT=3306
MYSQL_TARGET_USER=dev_writer
MYSQL_TARGET_PASSWORD=dev_write_password
MYSQL_TARGET_DB=app_dev_backup

SYNC_TABLES=["users","orders","products"]
```

```bash
# ç”Ÿäº§ç¯å¢ƒé…ç½®æ–‡ä»¶ (prod.env)
ENV=prod
MYSQL_SOURCE_HOST=prod-mysql.internal
MYSQL_SOURCE_PORT=3306
MYSQL_SOURCE_USER=prod_reader
MYSQL_SOURCE_PASSWORD=${SECRET_PROD_READ_PASSWORD}  # ä»å¯†é’¥ç®¡ç†è·å–
MYSQL_SOURCE_DB=app_production

MYSQL_TARGET_HOST=prod-mysql-slave.internal
MYSQL_TARGET_PORT=3306
MYSQL_TARGET_USER=prod_writer
MYSQL_TARGET_PASSWORD=${SECRET_PROD_WRITE_PASSWORD}
MYSQL_TARGET_DB=app_production_backup

SYNC_TABLES=["users","orders","products","analytics"]
```

### 7.2 é…ç½®éªŒè¯ä¸æµ‹è¯•


```yaml
# é…ç½®éªŒè¯è§„åˆ™ (validation.yaml)
validation-rules:
  # è¿æ¥éªŒè¯
  connectivity:
    - name: "source-connection"
      type: "database-ping"
      config:
        timeout: "10s"
        retry: 3
    
    - name: "target-connection"  
      type: "database-ping"
      config:
        timeout: "10s"
        retry: 3
  
  # æƒé™éªŒè¯
  permissions:
    - name: "source-read-permission"
      type: "table-access-check"
      config:
        operation: "SELECT"
        tables: ${SYNC_TABLES}
    
    - name: "target-write-permission"
      type: "table-access-check" 
      config:
        operation: "INSERT,UPDATE,DELETE"
        tables: ${SYNC_TABLES}
  
  # æ•°æ®ä¸€è‡´æ€§éªŒè¯
  consistency:
    - name: "schema-compatibility"
      type: "schema-compare"
      config:
        ignore-fields: ["id", "created_at", "updated_at"]
    
    - name: "data-sampling"
      type: "sample-compare"
      config:
        sample-size: 1000
        compare-fields: ["user_id", "order_id", "amount"]

# æµ‹è¯•ç”¨ä¾‹é…ç½®
test-cases:
  # åŸºç¡€åŠŸèƒ½æµ‹è¯•
  basic:
    - name: "sync-new-record"
      description: "æµ‹è¯•æ–°è®°å½•åŒæ­¥"
      steps:
        - insert-source-data: "test_users"
        - wait: "5s"
        - verify-target-data: "test_users"
    
    - name: "sync-update-record"
      description: "æµ‹è¯•è®°å½•æ›´æ–°åŒæ­¥"
      steps:
        - update-source-data: "test_users"
        - wait: "5s"  
        - verify-target-updated: "test_users"
  
  # å¼‚å¸¸æƒ…å†µæµ‹è¯•
  failure:
    - name: "network-interruption"
      description: "æµ‹è¯•ç½‘ç»œä¸­æ–­æ¢å¤"
      steps:
        - simulate-network-failure: "30s"
        - insert-source-data: "test_orders"
        - restore-network: {}
        - wait: "60s"
        - verify-target-data: "test_orders"
```

### 7.3 æ‰¹é‡é…ç½®ç®¡ç†


```bash
#!/bin/bash
# æ‰¹é‡é…ç½®ç®¡ç†è„šæœ¬ (manage-configs.sh)

# é…ç½®æ–‡ä»¶ç›®å½•ç»“æ„
# configs/
# â”œâ”€â”€ templates/          # é…ç½®æ¨¡æ¿
# â”œâ”€â”€ environments/       # ç¯å¢ƒé…ç½®
# â”œâ”€â”€ generated/         # ç”Ÿæˆçš„é…ç½®
# â””â”€â”€ validations/       # éªŒè¯è§„åˆ™

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
CONFIG_DIR="${SCRIPT_DIR}/configs"

# ç”Ÿæˆé…ç½®æ–‡ä»¶
generate_config() {
    local env=$1
    local template=$2
    
    echo "ğŸ”§ ç”Ÿæˆ ${env} ç¯å¢ƒçš„ ${template} é…ç½®..."
    
    # åŠ è½½ç¯å¢ƒå˜é‡
    source "${CONFIG_DIR}/environments/${env}.env"
    
    # ä½¿ç”¨envsubstæ›¿æ¢æ¨¡æ¿å˜é‡
    envsubst < "${CONFIG_DIR}/templates/${template}.yaml" \
        > "${CONFIG_DIR}/generated/${env}-${template}.yaml"
    
    echo "âœ… é…ç½®æ–‡ä»¶å·²ç”Ÿæˆ: ${env}-${template}.yaml"
}

# éªŒè¯é…ç½®æ–‡ä»¶
validate_config() {
    local config_file=$1
    
    echo "ğŸ” éªŒè¯é…ç½®æ–‡ä»¶: ${config_file}..."
    
    # YAMLè¯­æ³•æ£€æŸ¥
    if ! gravity config validate "${config_file}"; then
        echo "âŒ é…ç½®æ–‡ä»¶è¯­æ³•é”™è¯¯"
        return 1
    fi
    
    # è¿æ¥æµ‹è¯•
    if ! gravity config test-connection "${config_file}"; then
        echo "âŒ è¿æ¥æµ‹è¯•å¤±è´¥"
        return 1
    fi
    
    echo "âœ… é…ç½®éªŒè¯é€šè¿‡"
}

# éƒ¨ç½²é…ç½®
deploy_config() {
    local env=$1
    local config_name=$2
    
    echo "ğŸš€ éƒ¨ç½² ${env} ç¯å¢ƒçš„ ${config_name} é…ç½®..."
    
    local config_file="${CONFIG_DIR}/generated/${env}-${config_name}.yaml"
    
    # éªŒè¯é…ç½®
    if ! validate_config "${config_file}"; then
        echo "âŒ é…ç½®éªŒè¯å¤±è´¥ï¼Œå–æ¶ˆéƒ¨ç½²"
        return 1
    fi
    
    # éƒ¨ç½²åˆ°Gravity
    gravity job create \
        --config "${config_file}" \
        --name "${env}-${config_name}" \
        --environment "${env}"
    
    echo "âœ… é…ç½®éƒ¨ç½²å®Œæˆ"
}

# æ‰¹é‡æ“ä½œ
batch_operation() {
    local operation=$1
    local env=$2
    
    case $operation in
        "generate")
            for template in mysql-to-mysql mysql-to-kafka mysql-to-es; do
                generate_config "$env" "$template"
            done
            ;;
        "validate") 
            for config in "${CONFIG_DIR}/generated/${env}"-*.yaml; do
                validate_config "$config"
            done
            ;;
        "deploy")
            for config in "${CONFIG_DIR}/generated/${env}"-*.yaml; do
                config_name=$(basename "$config" .yaml | sed "s/${env}-//")
                deploy_config "$env" "$config_name"
            done
            ;;
    esac
}

# ä¸»å‡½æ•°
main() {
    case $1 in
        "generate")
            if [[ -n $3 ]]; then
                generate_config "$2" "$3"
            else
                batch_operation "generate" "$2"
            fi
            ;;
        "validate")
            if [[ -n $2 ]]; then
                validate_config "$2"
            else
                echo "è¯·æŒ‡å®šé…ç½®æ–‡ä»¶"
                exit 1
            fi
            ;;
        "deploy")
            if [[ -n $3 ]]; then
                deploy_config "$2" "$3"
            else
                batch_operation "deploy" "$2"
            fi
            ;;
        "batch")
            batch_operation "$2" "$3"
            ;;
        *)
            echo "ç”¨æ³•: $0 {generate|validate|deploy|batch} [env] [config]"
            echo "ç¤ºä¾‹:"
            echo "  $0 generate dev mysql-to-mysql    # ç”Ÿæˆå•ä¸ªé…ç½®"
            echo "  $0 generate dev                   # ç”Ÿæˆæ‰€æœ‰é…ç½®"
            echo "  $0 validate dev-mysql-to-mysql.yaml"
            echo "  $0 deploy dev mysql-to-mysql"
            echo "  $0 batch generate dev             # æ‰¹é‡ç”Ÿæˆ"
            exit 1
            ;;
    esac
}

main "$@"
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„é…ç½®è¦ç‚¹


```
ğŸ”¸ é…ç½®æ–‡ä»¶ç»“æ„ï¼šinput(æºç«¯) + output(ç›®æ ‡ç«¯) + filters(å¤„ç†è§„åˆ™)
ğŸ”¸ è¿æ¥é…ç½®ï¼šhostã€portã€usernameã€passwordç­‰åŸºç¡€è¿æ¥ä¿¡æ¯
ğŸ”¸ è®¤è¯ä¿¡æ¯ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†æ•æ„Ÿä¿¡æ¯ï¼Œä¸è¦ç¡¬ç¼–ç å¯†ç 
ğŸ”¸ æ•°æ®è¿‡æ»¤ï¼štable-filterã€column-mapç­‰è¿‡æ»¤è§„åˆ™çš„ä½¿ç”¨
ğŸ”¸ æ€§èƒ½é…ç½®ï¼šbatch-sizeã€timeoutã€å¹¶å‘æ•°ç­‰æ€§èƒ½å‚æ•°è°ƒä¼˜
ğŸ”¸ é”™è¯¯å¤„ç†ï¼šé‡è¯•æœºåˆ¶ã€è¶…æ—¶è®¾ç½®ã€å¼‚å¸¸æ¢å¤ç­–ç•¥
```

### 8.2 ä¸åŒæ•°æ®æºçš„é…ç½®ç‰¹ç‚¹


| æ•°æ®æºç±»å‹ | **é…ç½®é‡ç‚¹** | **æ³¨æ„äº‹é¡¹** | **å¸¸è§é—®é¢˜** |
|-----------|-------------|-------------|-------------|
| **MySQL** | `binlogé…ç½®ã€server-idè®¾ç½®` | `binlogæ ¼å¼å¿…é¡»æ˜¯ROW` | `æƒé™ä¸è¶³ã€binlogä½ç½®` |
| **Kafka** | `Topicè·¯ç”±ã€åˆ†åŒºç­–ç•¥` | `æ¶ˆæ¯æ ¼å¼ã€å‹ç¼©ç®—æ³•` | `åºåˆ—åŒ–ã€ç½‘ç»œå»¶è¿Ÿ` |
| **Elasticsearch** | `ç´¢å¼•æ˜ å°„ã€åˆ†è¯å™¨é…ç½®` | `æ–‡æ¡£IDã€æ‰¹é‡å¤§å°` | `æ˜ å°„å†²çªã€æ€§èƒ½è°ƒä¼˜` |
| **ClickHouse** | `è¡¨å¼•æ“ã€åˆ†åŒºé”®è®¾ç½®` | `æ•°æ®ç±»å‹è½¬æ¢` | `æ‰¹é‡å†™å…¥ã€æ’åºé”®` |
| **MongoDB** | `å˜æ›´æµã€å‰¯æœ¬é›†é…ç½®` | `æ–‡æ¡£ç»“æ„å±•å¹³` | `è¿æ¥æ± ã€è®¤è¯æ–¹å¼` |

### 8.3 é…ç½®æœ€ä½³å®è·µ


**ğŸ”¹ å®‰å…¨æ€§åŸåˆ™**
```
ç¯å¢ƒå˜é‡ç®¡ç†ï¼šæ‰€æœ‰å¯†ç é€šè¿‡ç¯å¢ƒå˜é‡ä¼ é€’
æƒé™æœ€å°åŒ–ï¼šæ•°æ®åº“ç”¨æˆ·åªç»™å¿…è¦çš„æƒé™  
ç½‘ç»œéš”ç¦»ï¼šä½¿ç”¨VPNæˆ–å†…ç½‘è¿æ¥
æ•°æ®åŠ å¯†ï¼šä¼ è¾“è¿‡ç¨‹ä½¿ç”¨SSL/TLSåŠ å¯†
```

**ğŸ”¹ å¯ç»´æŠ¤æ€§åŸåˆ™**  
```
æ¨¡æ¿åŒ–é…ç½®ï¼šä½¿ç”¨é…ç½®æ¨¡æ¿å‡å°‘é‡å¤
ç¯å¢ƒåˆ†ç¦»ï¼šå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒé…ç½®åˆ†ç¦»
ç‰ˆæœ¬æ§åˆ¶ï¼šé…ç½®æ–‡ä»¶çº³å…¥Gitç®¡ç†
æ–‡æ¡£å®Œå–„ï¼šæ¯ä¸ªé…ç½®éƒ½è¦æœ‰æ¸…æ™°çš„æ³¨é‡Š
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–åŸåˆ™**
```
æ‰¹é‡é…ç½®ï¼šåˆç†è®¾ç½®batch-sizeæé«˜ååé‡
è¿æ¥æ± ï¼šé…ç½®åˆé€‚çš„è¿æ¥æ± å¤§å°
ç›‘æ§å‘Šè­¦ï¼šè®¾ç½®æ€§èƒ½ç›‘æ§å’Œå¼‚å¸¸å‘Šè­¦
èµ„æºé™åˆ¶ï¼šé¿å…å•ä¸ªä»»åŠ¡å ç”¨è¿‡å¤šèµ„æº
```

### 8.4 å®é™…åº”ç”¨å»ºè®®


**ğŸ¯ é…ç½®é€‰å‹æŒ‡å—**
- **MySQL â†’ MySQL**ï¼šæ•°æ®åº“è¿ç§»ã€ä¸»ä»å¤åˆ¶ã€ç¾å¤‡åœºæ™¯
- **MySQL â†’ Kafka**ï¼šå®æ—¶æ•°æ®æµã€äº‹ä»¶é©±åŠ¨æ¶æ„ã€å¾®æœåŠ¡è§£è€¦
- **MySQL â†’ Elasticsearch**ï¼šå…¨æ–‡æœç´¢ã€æ—¥å¿—åˆ†æã€å®æ—¶æŸ¥è¯¢
- **MySQL â†’ ClickHouse**ï¼šæ•°æ®åˆ†æã€OLAPæŸ¥è¯¢ã€æŠ¥è¡¨ç³»ç»Ÿ
- **MongoDB â†’ MySQL**ï¼šæ•°æ®è§„èŒƒåŒ–ã€å…³ç³»åŒ–æŸ¥è¯¢éœ€æ±‚

**ğŸ”§ é…ç½®è°ƒä¼˜é‡ç‚¹**
- **ç½‘ç»œä¼˜åŒ–**ï¼šè°ƒæ•´è¿æ¥è¶…æ—¶ã€é‡è¿ç­–ç•¥åº”å¯¹ç½‘ç»œæŠ–åŠ¨
- **æ‰¹é‡ä¼˜åŒ–**ï¼šæ ¹æ®ç›®æ ‡ç³»ç»Ÿç‰¹ç‚¹è°ƒæ•´æ‰¹é‡å¤§å°å’Œé¢‘ç‡
- **èµ„æºæ§åˆ¶**ï¼šé™åˆ¶å†…å­˜ä½¿ç”¨ã€æ§åˆ¶å¹¶å‘æ•°é¿å…ç³»ç»Ÿè¿‡è½½
- **é”™è¯¯æ¢å¤**ï¼šå®Œå–„çš„é‡è¯•æœºåˆ¶å’Œæ–­ç‚¹ç»­ä¼ åŠŸèƒ½

**æ ¸å¿ƒè®°å¿†è¦ç‚¹**ï¼š
- é…ç½®æ–‡ä»¶å°±æ˜¯å‘Šè¯‰Gravity"ä»å“ªå–æ•°æ®ã€åˆ°å“ªæ”¾æ•°æ®ã€æ€ä¹ˆå¤„ç†æ•°æ®"
- ä¸åŒæ•°æ®æºæœ‰ä¸åŒçš„ç‰¹ç‚¹å’Œé…ç½®è¦æ±‚ï¼Œè¦å¯¹ç—‡ä¸‹è¯
- å®‰å…¨æ€§ã€å¯ç»´æŠ¤æ€§ã€æ€§èƒ½æ˜¯é…ç½®ç®¡ç†çš„ä¸‰å¤§è¦ç´ 
- ç¯å¢ƒå·®å¼‚åŒ–å’Œæ‰¹é‡ç®¡ç†æ˜¯å¤§è§„æ¨¡éƒ¨ç½²çš„å…³é”®