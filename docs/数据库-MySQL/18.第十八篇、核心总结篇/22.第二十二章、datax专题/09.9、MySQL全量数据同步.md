---
title: 9ã€MySQLå…¨é‡æ•°æ®åŒæ­¥
---
## ðŸ“š ç›®å½•

1. [DataXå…¨é‡åŒæ­¥æ¦‚è¿°](#1-DataXå…¨é‡åŒæ­¥æ¦‚è¿°)
2. [å…¨è¡¨æ•°æ®å¯¼å‡ºç­–ç•¥](#2-å…¨è¡¨æ•°æ®å¯¼å‡ºç­–ç•¥)
3. [å¤§è¡¨åˆ†ç‰‡è¯»å–æŠ€æœ¯](#3-å¤§è¡¨åˆ†ç‰‡è¯»å–æŠ€æœ¯)
4. [æ•°æ®å®Œæ•´æ€§æ ¡éªŒ](#4-æ•°æ®å®Œæ•´æ€§æ ¡éªŒ)
5. [åŒæ­¥è¿›åº¦ç›‘æŽ§](#5-åŒæ­¥è¿›åº¦ç›‘æŽ§)
6. [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#6-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
7. [æ•°æ®å¤„ç†æŠ€æœ¯](#7-æ•°æ®å¤„ç†æŠ€æœ¯)
8. [éªŒè¯ä¸Žæµ‹è¯•](#8-éªŒè¯ä¸Žæµ‹è¯•)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ðŸŒ DataXå…¨é‡åŒæ­¥æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯DataXå…¨é‡æ•°æ®åŒæ­¥


**é€šä¿—ç†è§£**ï¼š
DataXå…¨é‡æ•°æ®åŒæ­¥å°±åƒ"æ¬å®¶"ä¸€æ ·ï¼ŒæŠŠä¸€ä¸ªæ•°æ®åº“é‡Œçš„æ‰€æœ‰æ•°æ®å®Œæ•´åœ°æ¬åˆ°å¦ä¸€ä¸ªåœ°æ–¹ã€‚æ¯”å¦‚ä½ è¦æŠŠå®¶é‡Œçš„æ‰€æœ‰ä¸œè¥¿æ¬åˆ°æ–°æˆ¿å­ï¼Œéœ€è¦ç¡®ä¿ä¸€æ ·ä¸å°‘ã€ä¸€æ ·ä¸åã€‚

```
æ•°æ®åŒæ­¥çš„æœ¬è´¨ï¼š
æºæ•°æ®åº“ â”€â”€â”€â”€â”€â”€å®Œæ•´å¤åˆ¶â”€â”€â”€â”€â”€â”€> ç›®æ ‡æ•°æ®åº“
  (æ—§å®¶)                      (æ–°å®¶)
   
ç‰¹ç‚¹ï¼š
â€¢ ä¸€æ¬¡æ€§ä¼ è¾“æ‰€æœ‰æ•°æ®
â€¢ ä¿è¯æ•°æ®å®Œæ•´æ€§å’Œä¸€è‡´æ€§  
â€¢ é€‚åˆåˆå§‹åŒ–æ•°æ®è¿ç§»
â€¢ ä¸åŒ…å«å¢žé‡å˜åŒ–
```

**ðŸ”¸ æ ¸å¿ƒæ¦‚å¿µè§£é‡Š**
- **å…¨é‡åŒæ­¥**ï¼šä¸€æ¬¡æ€§åŒæ­¥è¡¨ä¸­çš„æ‰€æœ‰çŽ°æœ‰æ•°æ®
- **DataX**ï¼šé˜¿é‡Œå¼€æºçš„æ•°æ®åŒæ­¥å·¥å…·ï¼Œæ”¯æŒå¤šç§æ•°æ®æº
- **Readeræ’ä»¶**ï¼šè´Ÿè´£ä»Žæºæ•°æ®åº“è¯»å–æ•°æ®
- **Writeræ’ä»¶**ï¼šè´Ÿè´£å‘ç›®æ ‡æ•°æ®åº“å†™å…¥æ•°æ®

### 1.2 å…¨é‡åŒæ­¥çš„åº”ç”¨åœºæ™¯


**å®žé™…ä¸šåŠ¡åœºæ™¯**ï¼š
```
åœºæ™¯1ï¼šæ•°æ®åº“è¿ç§»
è€ç³»ç»ŸMySQL â†’ æ–°ç³»ç»ŸMySQL
éœ€æ±‚ï¼šå®Œæ•´è¿ç§»åŽ†å²æ•°æ®

åœºæ™¯2ï¼šæ•°æ®ä»“åº“å»ºè®¾  
ä¸šåŠ¡æ•°æ®åº“ â†’ æ•°æ®ä»“åº“
éœ€æ±‚ï¼šåˆ†æžç”¨åŽ†å²æ•°æ®

åœºæ™¯3ï¼šå¤‡ä»½æ¢å¤
ç”Ÿäº§çŽ¯å¢ƒ â†’ æµ‹è¯•çŽ¯å¢ƒ
éœ€æ±‚ï¼šæµ‹è¯•çŽ¯å¢ƒæ•°æ®åˆå§‹åŒ–

åœºæ™¯4ï¼šå¤šæ´»éƒ¨ç½²
ä¸»æ•°æ®ä¸­å¿ƒ â†’ å¤‡æ•°æ®ä¸­å¿ƒ
éœ€æ±‚ï¼šç¾å¤‡æ•°æ®å‡†å¤‡
```

### 1.3 DataXå·¥ä½œåŽŸç†


**æž¶æž„ç»„æˆ**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MySQL      â”‚    â”‚   DataX     â”‚    â”‚   ç›®æ ‡DB    â”‚
â”‚   Reader    â”‚â”€â”€â”€â–¶â”‚   Engine    â”‚â”€â”€â”€â–¶â”‚   Writer    â”‚
â”‚             â”‚    â”‚             â”‚    â”‚             â”‚
â”‚ â€¢ æ•°æ®è¯»å–   â”‚    â”‚ â€¢ æ•°æ®è½¬æ¢   â”‚    â”‚ â€¢ æ•°æ®å†™å…¥   â”‚
â”‚ â€¢ åˆ†ç‰‡å¤„ç†   â”‚    â”‚ â€¢ æµé‡æŽ§åˆ¶   â”‚    â”‚ â€¢ æ‰¹é‡æ’å…¥   â”‚
â”‚ â€¢ è¿›åº¦ç›‘æŽ§   â”‚    â”‚ â€¢ é”™è¯¯å¤„ç†   â”‚    â”‚ â€¢ äº‹åŠ¡ç®¡ç†   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ðŸ“Š å…¨è¡¨æ•°æ®å¯¼å‡ºç­–ç•¥


### 2.1 åŸºæœ¬å¯¼å‡ºé…ç½®


**é…ç½®æ–‡ä»¶ç»“æž„**ï¼š
```json
{
  "job": {
    "content": [
      {
        "reader": {
          "name": "mysqlreader",
          "parameter": {
            "username": "è¯»å–ç”¨æˆ·å",
            "password": "è¯»å–å¯†ç ", 
            "column": ["*"],
            "connection": [
              {
                "jdbcUrl": ["jdbc:mysql://æºåº“åœ°å€:3306/æ•°æ®åº“å"],
                "table": ["è¦åŒæ­¥çš„è¡¨å"]
              }
            ]
          }
        },
        "writer": {
          "name": "mysqlwriter",
          "parameter": {
            "username": "å†™å…¥ç”¨æˆ·å",
            "password": "å†™å…¥å¯†ç ",
            "column": ["*"],
            "connection": [
              {
                "jdbcUrl": "jdbc:mysql://ç›®æ ‡åº“åœ°å€:3306/æ•°æ®åº“å",
                "table": ["ç›®æ ‡è¡¨å"]
              }
            ]
          }
        }
      }
    ],
    "setting": {
      "speed": {
        "channel": 3
      }
    }
  }
}
```

**å‚æ•°è¯´æ˜Ž**ï¼š
- `channel`ï¼šå¹¶å‘é€šé“æ•°ï¼Œå°±åƒåŒæ—¶å¼€å‡ æ¡"ä¼ é€å¸¦"
- `column: ["*"]`ï¼šå¯¼å‡ºæ‰€æœ‰åˆ—ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šå…·ä½“åˆ—å
- `jdbcUrl`ï¼šæ•°æ®åº“è¿žæŽ¥åœ°å€ï¼ŒåŒ…å«IPã€ç«¯å£ã€æ•°æ®åº“å

### 2.2 ç›®æ ‡è¡¨å‡†å¤‡ç­–ç•¥


**è¡¨ç»“æž„å‡†å¤‡**ï¼š
```sql
-- æ–¹å¼1ï¼šæ‰‹åŠ¨åˆ›å»ºè¡¨ç»“æž„ï¼ˆæŽ¨èï¼‰
CREATE TABLE target_table LIKE source_table;

-- æ–¹å¼2ï¼šå®Œæ•´å¤åˆ¶è¡¨ç»“æž„å’Œç´¢å¼•
CREATE TABLE target_table AS SELECT * FROM source_table WHERE 1=0;

-- æ–¹å¼3ï¼šDataXé…ç½®ä¸­æŒ‡å®šé¢„å¤„ç†
"preSql": [
  "CREATE TABLE IF NOT EXISTS target_table LIKE source_table",
  "TRUNCATE TABLE target_table"
]
```

> **ðŸ’¡ é‡è¦æç¤º**ï¼šç›®æ ‡è¡¨æœ€å¥½æå‰åˆ›å»ºå¥½ï¼Œè¿™æ ·å¯ä»¥é¿å…åŒæ­¥è¿‡ç¨‹ä¸­çš„è¡¨ç»“æž„é—®é¢˜ã€‚

### 2.3 æ•°æ®ç±»åž‹å¤„ç†ç­–ç•¥


**å¸¸è§æ•°æ®ç±»åž‹æ˜ å°„**ï¼š
| æºç±»åž‹ | ç›®æ ‡ç±»åž‹ | å¤„ç†è¯´æ˜Ž |
|--------|----------|----------|
| `BIGINT` | `BIGINT` | ç›´æŽ¥æ˜ å°„ |
| `DECIMAL` | `DECIMAL` | ä¿æŒç²¾åº¦ |
| `DATETIME` | `DATETIME` | æ—¶åŒºæ³¨æ„ |
| `TEXT` | `TEXT` | å­—ç¬¦é›†ç»Ÿä¸€ |
| `JSON` | `JSON/TEXT` | ç‰ˆæœ¬å…¼å®¹æ€§ |

**ç‰¹æ®Šå¤„ç†é…ç½®**ï¼š
```json
"reader": {
  "parameter": {
    "column": [
      "id",
      "name", 
      "DATE_FORMAT(create_time,'%Y-%m-%d %H:%i:%s') as create_time",
      "CAST(amount AS DECIMAL(10,2)) as amount"
    ]
  }
}
```

---

## 3. ðŸ”€ å¤§è¡¨åˆ†ç‰‡è¯»å–æŠ€æœ¯


### 3.1 ä¸ºä»€ä¹ˆéœ€è¦åˆ†ç‰‡è¯»å–


**é—®é¢˜åˆ†æž**ï¼š
```
å¤§è¡¨é—®é¢˜ï¼š
è¡¨æ•°æ®é‡ï¼š1äº¿æ¡è®°å½•
å•æ¬¡æŸ¥è¯¢ï¼šSELECT * FROM big_table
é—®é¢˜ï¼š
â€¢ å†…å­˜æº¢å‡ºï¼šä¸€æ¬¡æ€§åŠ è½½å¤ªå¤šæ•°æ®
â€¢ æŸ¥è¯¢è¶…æ—¶ï¼šå•ä¸ªSQLæ‰§è¡Œæ—¶é—´è¿‡é•¿
â€¢ é”è¡¨é£Žé™©ï¼šé•¿æ—¶é—´å ç”¨æ•°æ®åº“èµ„æº
```

**åˆ†ç‰‡è¯»å–åŽŸç†**ï¼š
```
åŽŸç†ï¼šæŠŠå¤§è¡¨åˆ†æˆå¤šä¸ªå°ç‰‡æ®µï¼Œåˆ†åˆ«è¯»å–

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    å¤§è¡¨ 1äº¿æ¡    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    åˆ†ç‰‡å¤„ç†
         â†“
â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â”
â”‚ç‰‡1â”‚ â”‚ç‰‡2â”‚ â”‚ç‰‡3â”‚ â”‚...â”‚  æ¯ç‰‡100ä¸‡æ¡
â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜
```

### 3.2 åˆ†ç‰‡ç­–ç•¥é…ç½®


**åŸºäºŽä¸»é”®åˆ†ç‰‡**ï¼š
```json
{
  "reader": {
    "name": "mysqlreader",
    "parameter": {
      "splitPk": "id",
      "where": "id >= 1 AND id <= 10000000",
      "connection": [
        {
          "jdbcUrl": ["jdbc:mysql://localhost:3306/test"],
          "table": ["big_table"]
        }
      ]
    }
  },
  "setting": {
    "speed": {
      "channel": 5
    }
  }
}
```

**å‚æ•°è§£é‡Š**ï¼š
- `splitPk`ï¼šåˆ†ç‰‡é”®ï¼Œé€šå¸¸ç”¨ä¸»é”®ID
- `where`ï¼šæ•°æ®èŒƒå›´é™åˆ¶
- `channel`ï¼šå¹¶å‘æ•°ï¼Œå†³å®šåˆ†æˆå‡ ä¸ªç‰‡æ®µåŒæ—¶å¤„ç†

**åˆ†ç‰‡èŒƒå›´è®¡ç®—**ï¼š
```
å‡è®¾ï¼š
â€¢ æ€»è®°å½•æ•°ï¼š1000ä¸‡
â€¢ å¹¶å‘é€šé“ï¼š5ä¸ª
â€¢ åˆ†ç‰‡å¤§å°ï¼š1000ä¸‡ Ã· 5 = 200ä¸‡/ç‰‡

å®žé™…åˆ†ç‰‡ï¼š
ç‰‡1ï¼šid >= 1 AND id < 2000000
ç‰‡2ï¼šid >= 2000000 AND id < 4000000  
ç‰‡3ï¼šid >= 4000000 AND id < 6000000
ç‰‡4ï¼šid >= 6000000 AND id < 8000000
ç‰‡5ï¼šid >= 8000000 AND id <= 10000000
```

### 3.3 å¤§è¡¨ä¼˜åŒ–é…ç½®


**å†…å­˜ä½¿ç”¨ä¼˜åŒ–**ï¼š
```json
{
  "core": {
    "transport": {
      "channel": {
        "speed": {
          "record": 10000,     // æ¯æ‰¹å¤„ç†1ä¸‡æ¡è®°å½•
          "byte": 104857600    // æ¯æ‰¹æœ€å¤§100MB
        }
      }
    }
  }
}
```

**ç½‘ç»œä¼ è¾“ä¼˜åŒ–**ï¼š
```json
{
  "reader": {
    "parameter": {
      "fetchSize": 1024,        // JDBC fetch size
      "queryTimeOut": 300,      // æŸ¥è¯¢è¶…æ—¶5åˆ†é’Ÿ
      "connection": [
        {
          "jdbcUrl": [
            "jdbc:mysql://host:3306/db?useSSL=false&rewriteBatchedStatements=true"
          ]
        }
      ]
    }
  }
}
```

---

## 4. âœ… æ•°æ®å®Œæ•´æ€§æ ¡éªŒ


### 4.1 æ ¡éªŒç­–ç•¥æ¦‚è¿°


**ä¸ºä»€ä¹ˆè¦æ ¡éªŒ**ï¼š
æ•°æ®åŒæ­¥å°±åƒæ¬å®¶ï¼Œéœ€è¦ç¡®ä¿ä¸œè¥¿æ²¡ä¸¢ã€æ²¡åã€‚æ ¡éªŒå°±æ˜¯åœ¨æ¬å®ŒåŽæ¸…ç‚¹ç‰©å“ã€‚

**æ ¡éªŒç»´åº¦**ï¼š
```
1. æ•°é‡æ ¡éªŒï¼šè®°å½•æ¡æ•°æ˜¯å¦ä¸€è‡´
2. å†…å®¹æ ¡éªŒï¼šæ•°æ®å†…å®¹æ˜¯å¦æ­£ç¡®
3. ç»“æž„æ ¡éªŒï¼šè¡¨ç»“æž„æ˜¯å¦åŒ¹é…
4. çº¦æŸæ ¡éªŒï¼šä¸»é”®ã€ç´¢å¼•æ˜¯å¦æ­£å¸¸
```

### 4.2 è®°å½•æ•°é‡æ ¡éªŒ


**åŸºæœ¬æ•°é‡å¯¹æ¯”**ï¼š
```sql
-- æºè¡¨è®°å½•æ•°
SELECT COUNT(*) as source_count FROM source_db.user_table;

-- ç›®æ ‡è¡¨è®°å½•æ•°  
SELECT COUNT(*) as target_count FROM target_db.user_table;

-- æ ¡éªŒç»“æžœ
SELECT 
  s.source_count,
  t.target_count,
  (s.source_count - t.target_count) as diff_count,
  CASE 
    WHEN s.source_count = t.target_count THEN 'æ•°é‡ä¸€è‡´'
    ELSE 'æ•°é‡ä¸ä¸€è‡´' 
  END as check_result
FROM 
  (SELECT COUNT(*) as source_count FROM source_db.user_table) s,
  (SELECT COUNT(*) as target_count FROM target_db.user_table) t;
```

**åˆ†æ®µæ•°é‡æ ¡éªŒ**ï¼š
```sql
-- æŒ‰æ—¶é—´æ®µæ ¡éªŒ
SELECT 
  DATE(create_time) as date_key,
  COUNT(*) as daily_count
FROM source_db.user_table 
GROUP BY DATE(create_time)
ORDER BY date_key;

-- å¯¹æ¯”ç›®æ ‡è¡¨ç›¸åŒç»Ÿè®¡
```

### 4.3 æ•°æ®å†…å®¹æ ¡éªŒ


**checksumæ ¡éªŒ**ï¼š
```sql
-- æºè¡¨æ•°æ®æ ¡éªŒå’Œ
SELECT 
  COUNT(*) as record_count,
  SUM(CRC32(CONCAT_WS('|', id, name, email, create_time))) as checksum
FROM source_db.user_table;

-- ç›®æ ‡è¡¨æ•°æ®æ ¡éªŒå’Œ
SELECT 
  COUNT(*) as record_count,
  SUM(CRC32(CONCAT_WS('|', id, name, email, create_time))) as checksum  
FROM target_db.user_table;
```

**æŠ½æ ·å¯¹æ¯”æ ¡éªŒ**ï¼š
```sql
-- éšæœºæŠ½å–1000æ¡è®°å½•å¯¹æ¯”
SELECT * FROM source_db.user_table 
WHERE id IN (
  SELECT id FROM (
    SELECT id FROM source_db.user_table 
    ORDER BY RAND() LIMIT 1000
  ) t
) ORDER BY id;
```

### 4.4 DataXå†…ç½®æ ¡éªŒ


**é…ç½®æ•°æ®æ ¡éªŒ**ï¼š
```json
{
  "job": {
    "content": [
      {
        "reader": {...},
        "writer": {...}
      }
    ],
    "setting": {
      "speed": {
        "channel": 3
      },
      "errorLimit": {
        "record": 100,          // å…è®¸æœ€å¤š100æ¡é”™è¯¯è®°å½•
        "percentage": 0.1       // é”™è¯¯çŽ‡ä¸è¶…è¿‡0.1%
      }
    }
  }
}
```

---

## 5. ðŸ“ˆ åŒæ­¥è¿›åº¦ç›‘æŽ§


### 5.1 DataXå†…ç½®ç›‘æŽ§


**ç›‘æŽ§ä¿¡æ¯å±•ç¤º**ï¼š
```
DataXæ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šå®žæ—¶æ˜¾ç¤ºï¼š

2025-01-15 10:30:15.123 [job-0] INFO  JobContainer - 
ä»»åŠ¡å¯åŠ¨æ—¶åˆ»                    : 2025-01-15 10:30:00
ä»»åŠ¡ç»“æŸæ—¶åˆ»                    : 2025-01-15 10:35:15
ä»»åŠ¡æ€»è®¡è€—æ—¶                    : 315s
ä»»åŠ¡å¹³å‡æµé‡                    : 2.5MB/s
è®°å½•å†™å…¥é€Ÿåº¦                    : 8000rec/s
è¯»å‡ºè®°å½•æ€»æ•°                    : 2520000
è¯»å†™å¤±è´¥æ€»æ•°                    : 0
```

**å…³é”®æŒ‡æ ‡è§£è¯»**ï¼š
- **æµé‡é€Ÿåº¦**ï¼šæ•°æ®ä¼ è¾“çš„å¿«æ…¢ï¼Œç±»ä¼¼ç½‘é€Ÿ
- **è®°å½•é€Ÿåº¦**ï¼šæ¯ç§’å¤„ç†å¤šå°‘æ¡è®°å½•
- **å¤±è´¥è®¡æ•°**ï¼šå‡ºé”™çš„è®°å½•æ•°é‡

### 5.2 è‡ªå®šä¹‰ç›‘æŽ§è„šæœ¬


**è¿›åº¦ç›‘æŽ§è„šæœ¬**ï¼š
```bash
#!/bin/bash
# ç›‘æŽ§DataXåŒæ­¥è¿›åº¦

SOURCE_DB="source_database"
TARGET_DB="target_database" 
TABLE_NAME="user_table"

while true; do
    # èŽ·å–æºè¡¨æ€»æ•°
    SOURCE_COUNT=$(mysql -hæºåº“IP -uç”¨æˆ·å -på¯†ç  -e "SELECT COUNT(*) FROM ${SOURCE_DB}.${TABLE_NAME}" | tail -1)
    
    # èŽ·å–ç›®æ ‡è¡¨å½“å‰æ•°é‡
    TARGET_COUNT=$(mysql -hç›®æ ‡åº“IP -uç”¨æˆ·å -på¯†ç  -e "SELECT COUNT(*) FROM ${TARGET_DB}.${TABLE_NAME}" | tail -1)
    
    # è®¡ç®—è¿›åº¦ç™¾åˆ†æ¯”
    PROGRESS=$(echo "scale=2; $TARGET_COUNT * 100 / $SOURCE_COUNT" | bc)
    
    echo "$(date '+%Y-%m-%d %H:%M:%S') - åŒæ­¥è¿›åº¦: ${TARGET_COUNT}/${SOURCE_COUNT} (${PROGRESS}%)"
    
    sleep 30  # æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡
done
```

### 5.3 åŒæ­¥çŠ¶æ€æ£€æŸ¥


**å®žæ—¶çŠ¶æ€æŸ¥è¯¢**ï¼š
```sql
-- æ£€æŸ¥åŒæ­¥ä»»åŠ¡çŠ¶æ€
SELECT 
  TABLE_NAME,
  TABLE_ROWS,
  DATA_LENGTH,
  UPDATE_TIME
FROM information_schema.TABLES 
WHERE TABLE_SCHEMA = 'target_database'
AND TABLE_NAME = 'user_table';

-- æ£€æŸ¥æœ€æ–°åŒæ­¥æ—¶é—´
SELECT 
  MAX(create_time) as latest_sync_time,
  COUNT(*) as current_count
FROM target_database.user_table;
```

---

## 6. âš¡ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


### 6.1 å†…å­˜ä½¿ç”¨ä¼˜åŒ–


**JVMå‚æ•°è°ƒä¼˜**ï¼š
```bash
# DataXå¯åŠ¨è„šæœ¬ä¼˜åŒ–
export DATAX_HEAP_SIZE="4g"
export DATAX_JVM_OPTS="-Xms4g -Xmx4g -XX:+UseG1GC -XX:MaxGCPauseMillis=200"

# å¯åŠ¨DataX
python datax.py job.json
```

**å†…å­˜é…ç½®è¯´æ˜Ž**ï¼š
- `Xms/Xmx`ï¼šå †å†…å­˜å¤§å°ï¼Œæ ¹æ®æ•°æ®é‡è°ƒæ•´
- `UseG1GC`ï¼šä½¿ç”¨G1åžƒåœ¾æ”¶é›†å™¨ï¼Œé€‚åˆå¤§å†…å­˜
- `MaxGCPauseMillis`ï¼šæŽ§åˆ¶GCåœé¡¿æ—¶é—´

### 6.2 ç½‘ç»œä¼ è¾“ä¼˜åŒ–


**JDBCè¿žæŽ¥ä¼˜åŒ–**ï¼š
```json
{
  "jdbcUrl": [
    "jdbc:mysql://host:3306/db?useSSL=false&rewriteBatchedStatements=true&useServerPrepStmts=false&useLocalSessionState=true&useLocalTransactionState=true&useCursorFetch=true&defaultFetchSize=1000&useCompression=true"
  ]
}
```

**å‚æ•°å«ä¹‰**ï¼š
- `rewriteBatchedStatements=true`ï¼šæ‰¹é‡æ“ä½œä¼˜åŒ–
- `useCompression=true`ï¼šå¯ç”¨æ•°æ®åŽ‹ç¼©
- `defaultFetchSize=1000`ï¼šæ¯æ¬¡èŽ·å–1000æ¡è®°å½•

### 6.3 æ•°æ®åº“ä¼˜åŒ–é…ç½®


**æºåº“ä¼˜åŒ–**ï¼š
```sql
-- ä¸´æ—¶è°ƒæ•´æºåº“å‚æ•°
SET SESSION tx_isolation = 'READ-UNCOMMITTED';  -- é™ä½Žäº‹åŠ¡éš”ç¦»çº§åˆ«
SET SESSION innodb_lock_wait_timeout = 300;     -- å¢žåŠ é”ç­‰å¾…æ—¶é—´
```

**ç›®æ ‡åº“ä¼˜åŒ–**ï¼š
```sql
-- ä¸´æ—¶è°ƒæ•´ç›®æ ‡åº“å‚æ•°
SET SESSION autocommit = 0;                     -- å…³é—­è‡ªåŠ¨æäº¤
SET SESSION unique_checks = 0;                  -- å…³é—­å”¯ä¸€æ€§æ£€æŸ¥
SET SESSION foreign_key_checks = 0;             -- å…³é—­å¤–é”®æ£€æŸ¥
SET SESSION sql_log_bin = 0;                    -- å…³é—­äºŒè¿›åˆ¶æ—¥å¿—
```

### 6.4 å¹¶å‘é€šé“ä¼˜åŒ–


**é€šé“æ•°é‡é…ç½®**ï¼š
```json
{
  "setting": {
    "speed": {
      "channel": 8,              // å¹¶å‘é€šé“æ•°
      "record": 50000,           // æ¯é€šé“æ¯ç§’è®°å½•æ•°é™åˆ¶
      "byte": 104857600         // æ¯é€šé“æ¯ç§’å­—èŠ‚æ•°é™åˆ¶(100MB)
    }
  }
}
```

**æœ€ä½³å®žè·µ**ï¼š
```
é€šé“æ•°é€‰æ‹©å»ºè®®ï¼š
â€¢ CPUæ ¸å¿ƒæ•° Ã— 2 = æŽ¨èé€šé“æ•°
â€¢ æ•°æ®åº“è¿žæŽ¥æ±  Ã· 2 = æœ€å¤§é€šé“æ•°
â€¢ ç½‘ç»œå¸¦å®½ Ã· é€šé“æ•° = å•é€šé“å¸¦å®½

ç¤ºä¾‹ï¼š
8æ ¸CPUï¼Œæœ€å¤§è¿žæŽ¥100ï¼Œç½‘ç»œ1Gbps
æŽ¨èé…ç½®ï¼š6-8ä¸ªé€šé“
```

---

## 7. ðŸ› ï¸ æ•°æ®å¤„ç†æŠ€æœ¯


### 7.1 ç©ºå€¼æ•°æ®å¤„ç†


**ç©ºå€¼å¤„ç†ç­–ç•¥**ï¼š
```json
{
  "reader": {
    "parameter": {
      "column": [
        "id",
        "IFNULL(name, '') as name",           // ç©ºå­—ç¬¦ä¸²æ›¿æ¢NULL
        "IFNULL(age, 0) as age",              // æ•°å­—0æ›¿æ¢NULL  
        "IFNULL(email, 'unknown@example.com') as email"  // é»˜è®¤å€¼æ›¿æ¢
      ]
    }
  }
}
```

**ç©ºå€¼æ£€æŸ¥SQL**ï¼š
```sql
-- æ£€æŸ¥æºè¡¨ç©ºå€¼æƒ…å†µ
SELECT 
  'name' as column_name,
  COUNT(*) as total_count,
  SUM(CASE WHEN name IS NULL THEN 1 ELSE 0 END) as null_count,
  ROUND(SUM(CASE WHEN name IS NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*), 2) as null_percentage
FROM source_table
UNION ALL
SELECT 
  'email' as column_name,
  COUNT(*) as total_count, 
  SUM(CASE WHEN email IS NULL THEN 1 ELSE 0 END) as null_count,
  ROUND(SUM(CASE WHEN email IS NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*), 2) as null_percentage
FROM source_table;
```

### 7.2 ç‰¹æ®Šå­—ç¬¦å¤„ç†


**å­—ç¬¦ç¼–ç å¤„ç†**ï¼š
```json
{
  "reader": {
    "parameter": {
      "connection": [
        {
          "jdbcUrl": [
            "jdbc:mysql://host:3306/db?useUnicode=true&characterEncoding=utf8mb4&autoReconnect=true"
          ]
        }
      ],
      "column": [
        "id",
        "REPLACE(REPLACE(name, '\r', ''), '\n', '') as name",  // åŽ»é™¤æ¢è¡Œç¬¦
        "TRIM(description) as description"                      // åŽ»é™¤é¦–å°¾ç©ºæ ¼
      ]
    }
  }
}
```

**ç‰¹æ®Šå­—ç¬¦æ¸…ç†**ï¼š
```sql
-- æ¸…ç†å¸¸è§ç‰¹æ®Šå­—ç¬¦
UPDATE target_table SET 
  name = REPLACE(REPLACE(REPLACE(name, '\r', ''), '\n', ''), '\t', ' ')
WHERE name REGEXP '[\r\n\t]';
```

### 7.3 æ•°æ®ç±»åž‹è½¬æ¢


**å¸¸è§è½¬æ¢åœºæ™¯**ï¼š
```json
{
  "reader": {
    "parameter": {
      "column": [
        "id",
        "CAST(amount AS DECIMAL(10,2)) as amount",           // é‡‘é¢ç²¾åº¦è½¬æ¢
        "DATE_FORMAT(create_time, '%Y-%m-%d %H:%i:%s') as create_time",  // æ—¶é—´æ ¼å¼åŒ–
        "CASE WHEN status = 1 THEN 'active' ELSE 'inactive' END as status_text"  // çŠ¶æ€è½¬æ¢
      ]
    }
  }
}
```

---

## 8. âœ… éªŒè¯ä¸Žæµ‹è¯•


### 8.1 å…¨é‡åŒæ­¥éªŒè¯


**æ•°æ®ä¸€è‡´æ€§éªŒè¯è„šæœ¬**ï¼š
```sql
-- å®Œæ•´æ€§éªŒè¯æŠ¥å‘Š
SELECT 
  'æºè¡¨è®°å½•æ•°' as check_item,
  COUNT(*) as value
FROM source_db.user_table
UNION ALL
SELECT 
  'ç›®æ ‡è¡¨è®°å½•æ•°' as check_item,
  COUNT(*) as value  
FROM target_db.user_table
UNION ALL
SELECT 
  'ä¸»é”®é‡å¤æ£€æŸ¥(ç›®æ ‡è¡¨)' as check_item,
  COUNT(*) - COUNT(DISTINCT id) as value
FROM target_db.user_table
UNION ALL
SELECT
  'ç©ºå€¼æ£€æŸ¥(å…³é”®å­—æ®µ)' as check_item,
  COUNT(*) as value
FROM target_db.user_table 
WHERE name IS NULL OR email IS NULL;
```

### 8.2 æ€§èƒ½åŸºå‡†æµ‹è¯•


**æµ‹è¯•ç”¨ä¾‹è®¾è®¡**ï¼š
```
æµ‹è¯•åœºæ™¯ï¼š
1. å°è¡¨æµ‹è¯•ï¼ˆ1ä¸‡æ¡è®°å½•ï¼‰
   - éªŒè¯é…ç½®æ­£ç¡®æ€§
   - æµ‹è¯•åŸºæœ¬åŠŸèƒ½

2. ä¸­è¡¨æµ‹è¯•ï¼ˆ100ä¸‡æ¡è®°å½•ï¼‰  
   - éªŒè¯åˆ†ç‰‡æœºåˆ¶
   - æµ‹è¯•å†…å­˜ä½¿ç”¨

3. å¤§è¡¨æµ‹è¯•ï¼ˆ1000ä¸‡æ¡è®°å½•ï¼‰
   - éªŒè¯æ€§èƒ½è¡¨çŽ°
   - æµ‹è¯•ç¨³å®šæ€§

4. å¤æ‚æ•°æ®æµ‹è¯•
   - åŒ…å«ç‰¹æ®Šå­—ç¬¦
   - åŒ…å«ç©ºå€¼æ•°æ®
   - åŒ…å«å¤§å­—æ®µ(TEXT/BLOB)
```

**æ€§èƒ½æŒ‡æ ‡è®°å½•**ï¼š
```bash
# æµ‹è¯•ç»“æžœè®°å½•æ¨¡æ¿
echo "========== DataXæ€§èƒ½æµ‹è¯•æŠ¥å‘Š =========="
echo "æµ‹è¯•æ—¶é—´: $(date)"
echo "æ•°æ®é‡: 1000ä¸‡æ¡è®°å½•"
echo "è¡¨å¤§å°: 2GB"
echo "åŒæ­¥è€—æ—¶: 15åˆ†é’Ÿ"
echo "å¹³å‡é€Ÿåº¦: 11,111 è®°å½•/ç§’"
echo "ç½‘ç»œæµé‡: 2.3 MB/ç§’"
echo "å†…å­˜å³°å€¼: 4GB"
echo "CPUä½¿ç”¨çŽ‡: 65%"
echo "é”™è¯¯è®°å½•: 0æ¡"
echo "======================================="
```

### 8.3 å¼‚å¸¸å¤„ç†æµ‹è¯•


**å¼‚å¸¸åœºæ™¯æµ‹è¯•**ï¼š
```json
{
  "setting": {
    "errorLimit": {
      "record": 1000,        // å…è®¸1000æ¡é”™è¯¯è®°å½•
      "percentage": 0.5      // é”™è¯¯çŽ‡ä¸è¶…è¿‡0.5%
    },
    "speed": {
      "channel": 3
    }
  }
}
```

**å¸¸è§å¼‚å¸¸å¤„ç†**ï¼š
```
1. ç½‘ç»œä¸­æ–­å¤„ç†
   - DataXä¼šè‡ªåŠ¨é‡è¯•
   - å¯é…ç½®é‡è¯•æ¬¡æ•°å’Œé—´éš”

2. æ•°æ®ç±»åž‹ä¸åŒ¹é…
   - æ£€æŸ¥æºè¡¨å’Œç›®æ ‡è¡¨ç»“æž„
   - ä½¿ç”¨ç±»åž‹è½¬æ¢å‡½æ•°

3. ä¸»é”®å†²çªå¤„ç†
   - é…ç½®INSERT IGNORE
   - æˆ–ä½¿ç”¨REPLACE INTO

4. ç£ç›˜ç©ºé—´ä¸è¶³
   - ç›‘æŽ§ç›®æ ‡åº“ç©ºé—´
   - åˆ†æ‰¹æ¬¡åŒæ­¥å¤§è¡¨
```

---

## 9. ðŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŽŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ðŸ”¸ å…¨é‡åŒæ­¥ï¼šä¸€æ¬¡æ€§åŒæ­¥æ‰€æœ‰çŽ°æœ‰æ•°æ®ï¼Œé€‚ç”¨äºŽåˆå§‹åŒ–åœºæ™¯
ðŸ”¸ åˆ†ç‰‡è¯»å–ï¼šå°†å¤§è¡¨åˆ†å‰²æˆå°å—å¹¶è¡Œå¤„ç†ï¼Œæé«˜æ•ˆçŽ‡
ðŸ”¸ æ•°æ®æ ¡éªŒï¼šç¡®ä¿åŒæ­¥åŽæ•°æ®å®Œæ•´æ€§å’Œä¸€è‡´æ€§
ðŸ”¸ è¿›åº¦ç›‘æŽ§ï¼šå®žæ—¶æŽŒæ¡åŒæ­¥çŠ¶æ€ï¼ŒåŠæ—¶å‘çŽ°é—®é¢˜
ðŸ”¸ æ€§èƒ½ä¼˜åŒ–ï¼šé€šè¿‡å‚æ•°è°ƒä¼˜æå‡åŒæ­¥é€Ÿåº¦
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ðŸ”¹ ä¸ºä»€ä¹ˆéœ€è¦åˆ†ç‰‡è¯»å–**
```
é—®é¢˜ï¼šå¤§è¡¨ä¸€æ¬¡æ€§è¯»å–ä¼šå¯¼è‡´
â€¢ å†…å­˜æº¢å‡ºï¼šæ•°æ®é‡å¤ªå¤§
â€¢ æŸ¥è¯¢è¶…æ—¶ï¼šSQLæ‰§è¡Œæ—¶é—´è¿‡é•¿  
â€¢ èµ„æºå ç”¨ï¼šé•¿æ—¶é—´é”å®šæ•°æ®åº“

è§£å†³ï¼šåˆ†ç‰‡å¹¶è¡Œå¤„ç†
â€¢ åŒ–æ•´ä¸ºé›¶ï¼šå¤§ä»»åŠ¡å˜å°ä»»åŠ¡
â€¢ å¹¶è¡Œæ‰§è¡Œï¼šå¤šä¸ªç‰‡æ®µåŒæ—¶å¤„ç†
â€¢ èµ„æºå¯æŽ§ï¼šæ¯ç‰‡èµ„æºä½¿ç”¨é‡å›ºå®š
```

**ðŸ”¹ åŒæ­¥é…ç½®çš„æ ¸å¿ƒè¦ç´ **
```
æ•°æ®æºé…ç½®ï¼š
â€¢ è¿žæŽ¥ä¿¡æ¯ï¼šIPã€ç«¯å£ã€ç”¨æˆ·åã€å¯†ç 
â€¢ è¯»å–èŒƒå›´ï¼šæŒ‡å®šè¡¨ã€åˆ—ã€æ¡ä»¶
â€¢ åˆ†ç‰‡ç­–ç•¥ï¼šåˆ†ç‰‡é”®ã€å¹¶å‘æ•°

æ€§èƒ½é…ç½®ï¼š
â€¢ å†…å­˜è®¾ç½®ï¼šJVMå †å¤§å°
â€¢ ç½‘ç»œä¼˜åŒ–ï¼šè¿žæŽ¥æ± ã€æ‰¹é‡å¤§å°
â€¢ å¹¶å‘æŽ§åˆ¶ï¼šé€šé“æ•°ã€é™é€Ÿé…ç½®

è´¨é‡ä¿è¯ï¼š
â€¢ é”™è¯¯å®¹å¿ï¼šå…è®¸çš„é”™è¯¯æ•°é‡å’Œæ¯”ä¾‹
â€¢ æ•°æ®æ ¡éªŒï¼šchecksumã€æŠ½æ ·éªŒè¯
â€¢ ç›‘æŽ§æŠ¥è­¦ï¼šè¿›åº¦è·Ÿè¸ªã€å¼‚å¸¸é€šçŸ¥
```

### 9.3 å®žé™…åº”ç”¨ä»·å€¼


**ðŸ’¼ ä¸šåŠ¡åœºæ™¯åº”ç”¨**
- **æ•°æ®è¿ç§»**ï¼šç³»ç»Ÿå‡çº§æ—¶çš„åŽ†å²æ•°æ®è¿ç§»
- **å¤‡ä»½æ¢å¤**ï¼šç”Ÿäº§æ•°æ®åˆ°æµ‹è¯•çŽ¯å¢ƒçš„å¤åˆ¶
- **æ•°æ®åˆ†æž**ï¼šä¸šåŠ¡æ•°æ®åˆ°æ•°æ®ä»“åº“çš„åŒæ­¥
- **ç¾å¤‡å»ºè®¾**ï¼šä¸»å¤‡æ•°æ®ä¸­å¿ƒçš„æ•°æ®åˆå§‹åŒ–

**ðŸ”§ è¿ç»´å®žè·µè¦ç‚¹**
- **èµ„æºè§„åˆ’**ï¼šæ ¹æ®æ•°æ®é‡ä¼°ç®—æ—¶é—´å’Œèµ„æºéœ€æ±‚
- **ç›‘æŽ§å‘Šè­¦**ï¼šå»ºç«‹å®Œå–„çš„åŒæ­¥ç›‘æŽ§ä½“ç³»
- **åº”æ€¥é¢„æ¡ˆ**ï¼šå¤„ç†åŒæ­¥å¤±è´¥çš„å›žæ»šå’Œæ¢å¤ç­–ç•¥
- **æ€§èƒ½è°ƒä¼˜**ï¼šæ ¹æ®å®žé™…çŽ¯å¢ƒä¼˜åŒ–é…ç½®å‚æ•°

**ðŸŽ¯ æˆåŠŸå…³é”®å› ç´ **
```
å……åˆ†å‡†å¤‡ï¼š
âœ… æå‰åˆ›å»ºç›®æ ‡è¡¨ç»“æž„
âœ… è¯„ä¼°ç½‘ç»œå¸¦å®½å’Œæ•°æ®åº“æ€§èƒ½
âœ… å‡†å¤‡å……è¶³çš„å­˜å‚¨ç©ºé—´

åˆç†é…ç½®ï¼š
âœ… æ ¹æ®æ•°æ®é‡é€‰æ‹©åˆé€‚çš„åˆ†ç‰‡å¤§å°
âœ… è®¾ç½®åˆç†çš„å¹¶å‘é€šé“æ•°
âœ… é…ç½®é€‚å½“çš„é”™è¯¯å®¹å¿åº¦

å…¨ç¨‹ç›‘æŽ§ï¼š
âœ… å®žæ—¶ç›‘æŽ§åŒæ­¥è¿›åº¦
âœ… åŠæ—¶å‘çŽ°å’Œå¤„ç†å¼‚å¸¸
âœ… å®ŒæˆåŽè¿›è¡Œæ•°æ®æ ¡éªŒ
```

### 9.4 å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ


| é—®é¢˜ç±»åž‹ | **çŽ°è±¡** | **åŽŸå› ** | **è§£å†³æ–¹æ¡ˆ** |
|---------|----------|----------|-------------|
| ðŸŒ **åŒæ­¥é€Ÿåº¦æ…¢** | å‡ å°æ—¶æ‰åŒæ­¥å°‘é‡æ•°æ® | ç½‘ç»œå¸¦å®½ä¸è¶³æˆ–é…ç½®ä¸å½“ | å¢žåŠ å¹¶å‘é€šé“ï¼Œä¼˜åŒ–ç½‘ç»œé…ç½® |
| ðŸ’¥ **å†…å­˜æº¢å‡º** | Java heap spaceé”™è¯¯ | JVMå†…å­˜ä¸è¶³ | å¢žåŠ å †å†…å­˜ï¼Œå‡å°‘åˆ†ç‰‡å¤§å° |
| ðŸ” **æ•°æ®ä¸¢å¤±** | ç›®æ ‡è¡¨è®°å½•æ•°å°‘äºŽæºè¡¨ | åŒæ­¥è¿‡ç¨‹ä¸­æ•°æ®å˜åŒ–æˆ–é”™è¯¯ | é‡æ–°åŒæ­¥ï¼Œè®¾ç½®è¯»é”å®š |
| âš ï¸ **å­—ç¬¦ä¹±ç ** | ä¸­æ–‡æ˜¾ç¤ºä¸ºé—®å· | å­—ç¬¦ç¼–ç ä¸ä¸€è‡´ | ç»Ÿä¸€ä½¿ç”¨utf8mb4ç¼–ç  |

**æ ¸å¿ƒè®°å¿†å£è¯€**ï¼š
- å…¨é‡åŒæ­¥ä¸€æ¬¡æ¸…ï¼Œåˆ†ç‰‡å¹¶è¡Œæ•ˆçŽ‡é«˜
- æ ¡éªŒç›‘æŽ§ä¸å¯å°‘ï¼Œä¼˜åŒ–é…ç½®æ€§èƒ½å¥½
- å¼‚å¸¸å¤„ç†è¦å‘¨å…¨ï¼ŒæˆåŠŸåŒæ­¥æœ‰ä¿éšœ

**å®žè·µå»ºè®®**ï¼š
1. **å…ˆå°åŽå¤§**ï¼šä»Žå°è¡¨å¼€å§‹æµ‹è¯•ï¼ŒéªŒè¯é…ç½®æ­£ç¡®æ€§
2. **æ¸è¿›ä¼˜åŒ–**ï¼šæ ¹æ®å®žé™…è¡¨çŽ°é€æ­¥è°ƒæ•´å‚æ•°
3. **å¤‡ä»½ä¿é™©**ï¼šé‡è¦æ•°æ®åŒæ­¥å‰å…ˆåšå¤‡ä»½
4. **æ–‡æ¡£è®°å½•**ï¼šè®°å½•é…ç½®å‚æ•°å’Œä¼˜åŒ–ç»éªŒ