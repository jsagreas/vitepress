---
title: 21ã€æ€§èƒ½é—®é¢˜æ’æŸ¥ä¼˜åŒ–
---
## ğŸ“š ç›®å½•

1. [DataXæ€§èƒ½é—®é¢˜æ¦‚è¿°](#1-DataXæ€§èƒ½é—®é¢˜æ¦‚è¿°)
2. [æ€§èƒ½ç“¶é¢ˆå®šä½ä¸è¯Šæ–­](#2-æ€§èƒ½ç“¶é¢ˆå®šä½ä¸è¯Šæ–­)
3. [è¯»å–æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#3-è¯»å–æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
4. [å†™å…¥æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#4-å†™å…¥æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
5. [ç³»ç»Ÿèµ„æºé…ç½®è°ƒä¼˜](#5-ç³»ç»Ÿèµ„æºé…ç½®è°ƒä¼˜)
6. [æ•°æ®åº“å±‚é¢ä¼˜åŒ–](#6-æ•°æ®åº“å±‚é¢ä¼˜åŒ–)
7. [ç½‘ç»œä¸è¿æ¥ä¼˜åŒ–](#7-ç½‘ç»œä¸è¿æ¥ä¼˜åŒ–)
8. [æ€§èƒ½ç›‘æ§ä¸å·¥å…·](#8-æ€§èƒ½ç›‘æ§ä¸å·¥å…·)
9. [å®æˆ˜æ¡ˆä¾‹åˆ†æ](#9-å®æˆ˜æ¡ˆä¾‹åˆ†æ)
10. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#10-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ DataXæ€§èƒ½é—®é¢˜æ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯DataXæ€§èƒ½é—®é¢˜


**DataXæ€§èƒ½é—®é¢˜**å°±æ˜¯æ•°æ®åŒæ­¥è¿‡ç¨‹ä¸­å‡ºç°çš„é€Ÿåº¦æ…¢ã€å¡é¡¿ã€è¶…æ—¶ç­‰å½±å“æ•°æ®ä¼ è¾“æ•ˆç‡çš„é—®é¢˜ã€‚

```
å¸¸è§çš„æ€§èƒ½è¡¨ç°ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ…¢ï¼šåŒæ­¥100ä¸‡æ¡æ•°æ®è¦å‡ ä¸ªå°æ—¶         â”‚
â”‚ å¡ï¼šæ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­ç»å¸¸æš‚åœ           â”‚
â”‚ å µï¼šå¤§é‡ä»»åŠ¡æ’é˜Ÿç­‰å¾…æ‰§è¡Œ             â”‚
â”‚ å´©ï¼šå†…å­˜ä¸è¶³å¯¼è‡´ä»»åŠ¡å¤±è´¥             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æ€§èƒ½é—®é¢˜çš„å¸¸è§è¡¨ç°


**ğŸ”¸ é€Ÿåº¦æ…¢çš„è¡¨ç°**
- æ•°æ®åŒæ­¥é€Ÿåº¦è¿œä½äºé¢„æœŸï¼ˆæ¯”å¦‚æ¯ç§’åªèƒ½å¤„ç†å‡ ç™¾æ¡è®°å½•ï¼‰
- å¤§è¡¨åŒæ­¥éœ€è¦åå‡ ä¸ªå°æ—¶ç”šè‡³ä¸€å¤©
- åŒæ ·çš„æ•°æ®é‡ï¼ŒDataXæ¯”å…¶ä»–å·¥å…·æ…¢å¾ˆå¤š

**ğŸ”¸ èµ„æºå ç”¨å¼‚å¸¸**
- CPUä½¿ç”¨ç‡æŒç»­å¾ˆé«˜æˆ–å¾ˆä½
- å†…å­˜ä½¿ç”¨é‡ä¸æ–­å¢é•¿ï¼Œç”šè‡³æº¢å‡º
- ç£ç›˜IOè¯»å†™é¢‘ç¹ï¼Œæˆä¸ºç“¶é¢ˆ
- ç½‘ç»œå¸¦å®½åˆ©ç”¨ç‡ä½ï¼Œä¼ è¾“æ•ˆç‡å·®

### 1.3 æ€§èƒ½é—®é¢˜çš„å½±å“


```
ä¸šåŠ¡å½±å“é“¾æ¡ï¼š
æ•°æ®åŒæ­¥æ…¢ â†’ æ•°æ®å»¶è¿Ÿ â†’ æŠ¥è¡¨ä¸åŠæ—¶ â†’ å†³ç­–å—å½±å“

ç³»ç»Ÿå½±å“ï¼š
èµ„æºå ç”¨é«˜ â†’ å…¶ä»–ä»»åŠ¡å—å½±å“ â†’ æ•´ä½“ç³»ç»Ÿæ€§èƒ½ä¸‹é™
```

---

## 2. ğŸ” æ€§èƒ½ç“¶é¢ˆå®šä½ä¸è¯Šæ–­


### 2.1 æ€§èƒ½ç“¶é¢ˆçš„å¸¸è§ç±»å‹


**DataXæ€§èƒ½ç“¶é¢ˆ**å°±åƒäº¤é€šæ‹¥å µä¸€æ ·ï¼Œå¯èƒ½å‘ç”Ÿåœ¨æ•°æ®ä¼ è¾“é“¾è·¯çš„ä»»ä½•ä¸€ä¸ªç¯èŠ‚ï¼š

```
æ•°æ®ä¼ è¾“é“¾è·¯å›¾ï¼š
æºæ•°æ®åº“ â†’ è¯»å–ç»„ä»¶ â†’ DataXå¼•æ“ â†’ å†™å…¥ç»„ä»¶ â†’ ç›®æ ‡æ•°æ®åº“
    â†“         â†“         â†“         â†“         â†“
  æ•°æ®åº“      ç½‘ç»œ      å†…å­˜      ç½‘ç»œ     æ•°æ®åº“
  æ€§èƒ½       å¸¦å®½      CPU       å¸¦å®½     æ€§èƒ½
```

**ğŸ”¸ æ•°æ®åº“å±‚ç“¶é¢ˆ**
- **æºåº“è¯»å–æ…¢**ï¼šSQLæŸ¥è¯¢æ•ˆç‡ä½ã€ç´¢å¼•ç¼ºå¤±
- **ç›®æ ‡åº“å†™å…¥æ…¢**ï¼šæ‰¹é‡æ’å…¥æ€§èƒ½å·®ã€é”å†²çª
- **è¿æ¥æ•°é™åˆ¶**ï¼šæ•°æ®åº“è¿æ¥æ± æ»¡äº†

**ğŸ”¸ ç³»ç»Ÿèµ„æºç“¶é¢ˆ**
- **CPUç“¶é¢ˆ**ï¼šæ•°æ®å¤„ç†é€»è¾‘å¤æ‚ï¼ŒCPUè·‘æ»¡
- **å†…å­˜ç“¶é¢ˆ**ï¼šå¤§é‡æ•°æ®ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œå¯¼è‡´æº¢å‡º
- **ç£ç›˜IOç“¶é¢ˆ**ï¼šä¸´æ—¶æ–‡ä»¶è¯»å†™é¢‘ç¹

**ğŸ”¸ ç½‘ç»œç“¶é¢ˆ**
- **å¸¦å®½ä¸è¶³**ï¼šç½‘ç»œä¼ è¾“æˆä¸ºé™åˆ¶å› ç´ 
- **å»¶è¿Ÿè¿‡é«˜**ï¼šè·¨åœ°åŸŸä¼ è¾“å»¶è¿Ÿå¤§

### 2.2 ç“¶é¢ˆå®šä½çš„åŸºæœ¬æ–¹æ³•


**æ­¥éª¤ä¸€ï¼šè§‚å¯Ÿæ•´ä½“æ€§èƒ½æŒ‡æ ‡**

```bash
# æŸ¥çœ‹DataXä»»åŠ¡æ‰§è¡Œæ—¥å¿—
tail -f datax.log | grep -E "(READ|WRITE|SPEED)"

# å…³æ³¨è¿™äº›å…³é”®æŒ‡æ ‡ï¼š
# - è¯»å–é€Ÿåº¦ï¼šrecords/s
# - å†™å…¥é€Ÿåº¦ï¼šrecords/s  
# - é”™è¯¯ç‡ï¼šerror count
# - å†…å­˜ä½¿ç”¨ï¼šmemory usage
```

**æ­¥éª¤äºŒï¼šåˆ†æ®µæµ‹è¯•å®šä½**

```
æµ‹è¯•ç­–ç•¥ï¼š
1. å°æ•°æ®é‡æµ‹è¯•ï¼šå…ˆåŒæ­¥1ä¸‡æ¡æ•°æ®çœ‹é€Ÿåº¦
2. å•æ–¹å‘æµ‹è¯•ï¼šåªæµ‹è¯»å–æˆ–åªæµ‹å†™å…¥
3. ç©ºè½½æµ‹è¯•ï¼šæµ‹è¯•DataXæœ¬èº«çš„å¤„ç†èƒ½åŠ›
4. ç½‘ç»œæµ‹è¯•ï¼šæµ‹è¯•ç½‘ç»œä¼ è¾“é€Ÿåº¦
```

### 2.3 æ€§èƒ½ç“¶é¢ˆè¯Šæ–­å·¥å…·


**ğŸ”§ ç³»ç»Ÿçº§ç›‘æ§å·¥å…·**

| **å·¥å…·** | **ç›‘æ§å¯¹è±¡** | **ä½¿ç”¨åœºæ™¯** | **å…³é”®æŒ‡æ ‡** |
|---------|-------------|-------------|-------------|
| `top/htop` | CPUã€å†…å­˜ | å®æ—¶ç›‘æ§ç³»ç»Ÿèµ„æº | CPUä½¿ç”¨ç‡ã€å†…å­˜å ç”¨ |
| `iostat` | ç£ç›˜IO | ç£ç›˜è¯»å†™æ€§èƒ½åˆ†æ | IOPSã€ååé‡ |
| `iftop` | ç½‘ç»œæµé‡ | ç½‘ç»œä¼ è¾“ç›‘æ§ | å¸¦å®½ä½¿ç”¨ç‡ã€è¿æ¥æ•° |
| `jstack` | Javaè¿›ç¨‹ | JVMçº¿ç¨‹çŠ¶æ€åˆ†æ | çº¿ç¨‹å †æ ˆã€æ­»é”æ£€æµ‹ |

**ğŸ”§ æ•°æ®åº“ç›‘æ§å·¥å…·**

```sql
-- MySQLæ…¢æŸ¥è¯¢ç›‘æ§
SHOW VARIABLES LIKE 'slow_query_log';
SHOW VARIABLES LIKE 'long_query_time';

-- æŸ¥çœ‹å½“å‰è¿æ¥æ•°
SHOW STATUS LIKE 'Threads_connected';
SHOW VARIABLES LIKE 'max_connections';

-- æŸ¥çœ‹é”ç­‰å¾…æƒ…å†µ
SHOW ENGINE INNODB STATUS;
```

---

## 3. ğŸ“– è¯»å–æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


### 3.1 SQLæŸ¥è¯¢ä¼˜åŒ–


**è¯»å–æ€§èƒ½ä¼˜åŒ–**çš„æ ¸å¿ƒå°±æ˜¯è®©DataXä»æºæ•°æ®åº“å–æ•°æ®æ—¶æ›´å¿«æ›´ç¨³å®šã€‚

**ğŸ”¸ ç´¢å¼•ä¼˜åŒ–**

æœ€é‡è¦çš„ä¼˜åŒ–ç‚¹æ˜¯ç¡®ä¿è¯»å–æŸ¥è¯¢èƒ½æœ‰æ•ˆä½¿ç”¨ç´¢å¼•ï¼š

```sql
-- âŒ é”™è¯¯ç¤ºä¾‹ï¼šå…¨è¡¨æ‰«æ
SELECT * FROM user_table WHERE create_time > '2023-01-01';

-- âœ… æ­£ç¡®ç¤ºä¾‹ï¼šä½¿ç”¨ç´¢å¼•
-- é¦–å…ˆåˆ›å»ºç´¢å¼•
CREATE INDEX idx_create_time ON user_table(create_time);
-- ç„¶åæ‰§è¡ŒæŸ¥è¯¢
SELECT * FROM user_table WHERE create_time > '2023-01-01';

-- éªŒè¯æ˜¯å¦ä½¿ç”¨ç´¢å¼•
EXPLAIN SELECT * FROM user_table WHERE create_time > '2023-01-01';
```

**ğŸ”¸ åˆ†é¡µè¯»å–ä¼˜åŒ–**

å¤§è¡¨è¯»å–æ—¶è¦é¿å…ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰æ•°æ®ï¼š

```json
{
  "reader": {
    "name": "mysqlreader",
    "parameter": {
      "connection": [
        {
          "querySql": [
            "SELECT * FROM user_table WHERE id >= ? AND id < ? ORDER BY id"
          ]
        }
      ],
      "splitPk": "id",
      "fetchSize": 1000
    }
  }
}
```

**é…ç½®è¯´æ˜ï¼š**
- `splitPk`ï¼šæŒ‡å®šåˆ†ç‰‡å­—æ®µï¼Œé€šå¸¸é€‰æ‹©ä¸»é”®
- `fetchSize`ï¼šæ¯æ¬¡è¯»å–çš„è®°å½•æ•°ï¼Œå»ºè®®1000-5000

### 3.2 å¹¶å‘è¯»å–é…ç½®


**ğŸ”¸ channelæ•°é‡è°ƒä¼˜**

```json
{
  "core": {
    "transport": {
      "channel": {
        "capacity": 2048,
        "byteCapacity": 67108864
      }
    }
  },
  "job": {
    "setting": {
      "speed": {
        "channel": 4
      }
    }
  }
}
```

**å‚æ•°è§£é‡Šï¼š**
- `channel`ï¼šå¹¶å‘é€šé“æ•°ï¼Œç›¸å½“äºåŒæ—¶å¼€å‡ ä¸ª"ç®¡é“"ä¼ è¾“æ•°æ®
- `capacity`ï¼šæ¯ä¸ªé€šé“çš„è®°å½•ç¼“å­˜æ•°é‡
- `byteCapacity`ï¼šæ¯ä¸ªé€šé“çš„å­—èŠ‚ç¼“å­˜å¤§å°

**ğŸ”¸ å¹¶å‘åº¦é€‰æ‹©åŸåˆ™**

```
å¹¶å‘åº¦é€‰æ‹©å…¬å¼ï¼š
ç†æƒ³å¹¶å‘æ•° = min(CPUæ ¸æ•°, æ•°æ®åº“è¿æ¥æ•°é™åˆ¶, ç½‘ç»œå¸¦å®½/å•é€šé“å¸¦å®½)

å®é™…å»ºè®®ï¼š
- å°è¡¨(<100ä¸‡è®°å½•)ï¼š2-4ä¸ªchannel
- ä¸­è¡¨(100ä¸‡-1000ä¸‡)ï¼š4-8ä¸ªchannel  
- å¤§è¡¨(>1000ä¸‡)ï¼š8-16ä¸ªchannel
```

### 3.3 è¯»å–è¿æ¥æ± ä¼˜åŒ–


```json
{
  "reader": {
    "name": "mysqlreader", 
    "parameter": {
      "connection": [
        {
          "jdbcUrl": ["jdbc:mysql://localhost:3306/test?useSSL=false&serverTimezone=Asia/Shanghai&rewriteBatchedStatements=true"],
          "table": ["user_table"]
        }
      ],
      "username": "root",
      "password": "password",
      "fetchSize": 1000,
      "queryTimeOut": 300
    }
  }
}
```

**é‡è¦å‚æ•°ï¼š**
- `rewriteBatchedStatements=true`ï¼šå¼€å¯æ‰¹é‡æŸ¥è¯¢ä¼˜åŒ–
- `queryTimeOut`ï¼šæŸ¥è¯¢è¶…æ—¶æ—¶é—´ï¼Œé˜²æ­¢é•¿æ—¶é—´ç­‰å¾…
- `fetchSize`ï¼šJDBCæ¯æ¬¡è·å–çš„è®°å½•æ•°

---

## 4. âœï¸ å†™å…¥æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


### 4.1 æ‰¹é‡å†™å…¥ä¼˜åŒ–


**å†™å…¥æ€§èƒ½ä¼˜åŒ–**çš„å…³é”®æ˜¯å‡å°‘æ•°æ®åº“å†™å…¥æ¬¡æ•°ï¼Œæé«˜å•æ¬¡å†™å…¥çš„æ•°æ®é‡ã€‚

**ğŸ”¸ æ‰¹é‡å¤§å°è°ƒä¼˜**

```json
{
  "writer": {
    "name": "mysqlwriter",
    "parameter": {
      "writeMode": "insert",
      "batchSize": 2048,
      "connection": [
        {
          "jdbcUrl": "jdbc:mysql://localhost:3306/target?rewriteBatchedStatements=true&useSSL=false",
          "table": ["target_table"]
        }
      ]
    }
  }
}
```

**batchSizeé€‰æ‹©æŒ‡å—ï¼š**

| **æ•°æ®ç‰¹ç‚¹** | **å»ºè®®batchSize** | **è¯´æ˜** |
|-------------|------------------|---------|
| å°è®°å½•(<1KB) | 2048-4096 | å¯ä»¥æ‰¹é‡æ›´å¤šè®°å½• |
| ä¸­ç­‰è®°å½•(1-10KB) | 1024-2048 | å¹³è¡¡å†…å­˜å’Œæ•ˆç‡ |
| å¤§è®°å½•(>10KB) | 512-1024 | é¿å…å†…å­˜æº¢å‡º |

**ğŸ”¸ å†™å…¥æ¨¡å¼é€‰æ‹©**

```json
{
  "writeMode": "insert",     // æ™®é€šæ’å…¥ï¼Œæœ€å¿«
  "writeMode": "replace",    // æ›¿æ¢æ¨¡å¼ï¼Œæœ‰é‡å¤æ—¶è¦†ç›–
  "writeMode": "update"      // æ›´æ–°æ¨¡å¼ï¼Œæœ€æ…¢ä½†æœ€çµæ´»
}
```

### 4.2 æ•°æ®åº“å†™å…¥è¿æ¥ä¼˜åŒ–


**ğŸ”¸ JDBCè¿æ¥å‚æ•°ä¼˜åŒ–**

```
å…³é”®è¿æ¥å‚æ•°ï¼š
jdbc:mysql://host:port/db?å‚æ•°1&å‚æ•°2&å‚æ•°3

é‡è¦å‚æ•°è§£é‡Šï¼š
- rewriteBatchedStatements=true  # æ‰¹é‡è¯­å¥é‡å†™
- useServerPrepStmts=false       # å…³é—­é¢„ç¼–è¯‘
- cachePrepStmts=false           # å…³é—­è¯­å¥ç¼“å­˜
- useCompression=true            # å¼€å¯ä¼ è¾“å‹ç¼©
- autoReconnect=true             # è‡ªåŠ¨é‡è¿
```

**å®Œæ•´çš„é«˜æ€§èƒ½è¿æ¥URLç¤ºä¾‹ï¼š**
```
jdbc:mysql://localhost:3306/test?useSSL=false&serverTimezone=Asia/Shanghai&rewriteBatchedStatements=true&useServerPrepStmts=false&cachePrepStmts=false&useCompression=true&autoReconnect=true
```

### 4.3 ç›®æ ‡æ•°æ®åº“ä¼˜åŒ–


**ğŸ”¸ ä¸´æ—¶å…³é—­çº¦æŸæ£€æŸ¥**

å†™å…¥å¤§é‡æ•°æ®æ—¶ï¼Œå¯ä»¥ä¸´æ—¶å…³é—­ä¸€äº›æ£€æŸ¥æ¥æé€Ÿï¼š

```sql
-- å†™å…¥å‰æ‰§è¡Œ
SET foreign_key_checks = 0;        -- å…³é—­å¤–é”®æ£€æŸ¥
SET unique_checks = 0;              -- å…³é—­å”¯ä¸€æ€§æ£€æŸ¥  
SET sql_log_bin = 0;                -- å…³é—­binlog(è°¨æ…ä½¿ç”¨)

-- æ•°æ®å†™å…¥å®Œæˆåæ¢å¤
SET foreign_key_checks = 1;
SET unique_checks = 1;
SET sql_log_bin = 1;
```

**âš ï¸ æ³¨æ„ï¼š** è¿™äº›æ“ä½œæœ‰é£é™©ï¼Œåªåœ¨æ•°æ®è´¨é‡æœ‰ä¿éšœçš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚

---

## 5. âš™ï¸ ç³»ç»Ÿèµ„æºé…ç½®è°ƒä¼˜


### 5.1 å†…å­˜é…ç½®è°ƒä¼˜


**å†…å­˜é…ç½®**å†³å®šäº†DataXèƒ½åŒæ—¶å¤„ç†å¤šå°‘æ•°æ®ï¼Œé…ç½®ä¸å½“å®¹æ˜“å‡ºç°å†…å­˜æº¢å‡ºã€‚

**ğŸ”¸ JVMå†…å­˜å‚æ•°è°ƒä¼˜**

```bash
# DataXå¯åŠ¨è„šæœ¬ä¸­çš„å†…å­˜é…ç½®
export DATAX_HEAP_SIZE=4g
export DATAX_HEAP_DUMP_PATH=/tmp/datax-heap-dump

# å®Œæ•´çš„JVMå‚æ•°ç¤ºä¾‹
java -Xms4g -Xmx4g -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/tmp/datax-heap-dump -jar datax.jar job.json
```

**å†…å­˜å¤§å°é€‰æ‹©æŒ‡å—ï¼š**

```
å†…å­˜é…ç½®å…¬å¼ï¼š
æ‰€éœ€å†…å­˜ â‰ˆ channelæ•°é‡ Ã— byteCapacity Ã— 2

å®é™…å»ºè®®ï¼š
- å°ä»»åŠ¡(channelâ‰¤4)ï¼š2-4GB
- ä¸­ç­‰ä»»åŠ¡(channel 4-8)ï¼š4-8GB  
- å¤§ä»»åŠ¡(channel>8)ï¼š8GBä»¥ä¸Š
```

**ğŸ”¸ é€šé“ç¼“å­˜é…ç½®**

```json
{
  "core": {
    "transport": {
      "channel": {
        "capacity": 2048,        // è®°å½•æ•°ç¼“å­˜
        "byteCapacity": 67108864,// å­—èŠ‚ç¼“å­˜(64MB)
        "flowControlInterval": 20,// æµæ§æ£€æŸ¥é—´éš”
        "speed": {
          "byte": 1048576,       // å­—èŠ‚é™é€Ÿ(1MB/s)
          "record": 10000        // è®°å½•æ•°é™é€Ÿ
        }
      }
    }
  }
}
```

### 5.2 CPUé…ç½®è°ƒä¼˜


**ğŸ”¸ å¹¶å‘åº¦ä¸CPUçš„å…³ç³»**

```
CPUä½¿ç”¨ä¼˜åŒ–åŸåˆ™ï¼š
1. å¹¶å‘channelæ•° â‰ˆ CPUæ ¸æ•°
2. é¿å…è¿‡åº¦å¹¶å‘å¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢
3. ä¸ºå…¶ä»–è¿›ç¨‹é¢„ç•™CPUèµ„æº

å®é™…é…ç½®å»ºè®®ï¼š
- 4æ ¸CPUï¼šå»ºè®®2-4ä¸ªchannel
- 8æ ¸CPUï¼šå»ºè®®4-6ä¸ªchannel
- 16æ ¸CPUï¼šå»ºè®®8-12ä¸ªchannel
```

**ğŸ”¸ CPUå¯†é›†å‹ä¼˜åŒ–**

å½“DataXæ¶‰åŠæ•°æ®è½¬æ¢æ—¶ï¼ŒCPUå¯èƒ½æˆä¸ºç“¶é¢ˆï¼š

```json
{
  "transformer": [
    {
      "name": "dx_groovy",
      "parameter": {
        "code": "return record;"  // ç®€åŒ–è½¬æ¢é€»è¾‘
      }
    }
  ]
}
```

### 5.3 ç£ç›˜IOä¼˜åŒ–


**ğŸ”¸ ä¸´æ—¶æ–‡ä»¶é…ç½®**

```bash
# è®¾ç½®ä¸´æ—¶ç›®å½•åˆ°é«˜é€Ÿç£ç›˜
export JAVA_OPTS="-Djava.io.tmpdir=/data/tmp"

# ç¡®ä¿ä¸´æ—¶ç›®å½•æœ‰è¶³å¤Ÿç©ºé—´
df -h /data/tmp
```

**ğŸ”¸ æ—¥å¿—è¾“å‡ºä¼˜åŒ–**

```xml
<!-- logback.xmlé…ç½®å¼‚æ­¥æ—¥å¿— -->
<appender name="ASYNC" class="ch.qos.logback.classic.AsyncAppender">
    <discardingThreshold>0</discardingThreshold>
    <queueSize>512</queueSize>
    <appender-ref ref="FILE"/>
</appender>
```

---

## 6. ğŸ—„ï¸ æ•°æ®åº“å±‚é¢ä¼˜åŒ–


### 6.1 MySQLæ•°æ®åº“å‚æ•°è°ƒä¼˜


**æ•°æ®åº“å‚æ•°è°ƒä¼˜**å°±æ˜¯è°ƒæ•´MySQLçš„é…ç½®ï¼Œè®©å®ƒåœ¨DataXåœºæ™¯ä¸‹è¡¨ç°æ›´å¥½ã€‚

**ğŸ”¸ è¿æ¥ç›¸å…³å‚æ•°**

```sql
-- æŸ¥çœ‹å½“å‰è¿æ¥æ•°è®¾ç½®
SHOW VARIABLES LIKE '%connect%';

-- è°ƒä¼˜å»ºè®®
SET GLOBAL max_connections = 1000;        -- æœ€å¤§è¿æ¥æ•°
SET GLOBAL max_user_connections = 800;    -- å•ç”¨æˆ·æœ€å¤§è¿æ¥æ•°
SET GLOBAL connect_timeout = 30;          -- è¿æ¥è¶…æ—¶æ—¶é—´
SET GLOBAL wait_timeout = 3600;           -- ç©ºé—²è¿æ¥è¶…æ—¶
```

**ğŸ”¸ ç¼“å†²åŒºå‚æ•°è°ƒä¼˜**

```sql
-- InnoDBç¼“å†²æ± å¤§å°(æœ€é‡è¦çš„å‚æ•°)
SET GLOBAL innodb_buffer_pool_size = '2G';

-- æŸ¥è¯¢ç¼“å­˜(å¦‚æœä½¿ç”¨)
SET GLOBAL query_cache_size = 268435456;   -- 256MB
SET GLOBAL query_cache_type = 1;

-- æ’åºç¼“å†²åŒº
SET GLOBAL sort_buffer_size = 2097152;     -- 2MB

-- æ‰¹é‡æ’å…¥ç¼“å†²åŒº
SET GLOBAL bulk_insert_buffer_size = 67108864; -- 64MB
```

### 6.2 ç´¢å¼•ä¼˜åŒ–ç­–ç•¥


**ğŸ”¸ è¯»å–ç«¯ç´¢å¼•ä¼˜åŒ–**

```sql
-- ä¸ºåˆ†ç‰‡å­—æ®µåˆ›å»ºç´¢å¼•
CREATE INDEX idx_split_pk ON source_table(id);

-- ä¸ºè¿‡æ»¤æ¡ä»¶åˆ›å»ºå¤åˆç´¢å¼•
CREATE INDEX idx_filter ON source_table(status, create_time);

-- æ£€æŸ¥ç´¢å¼•ä½¿ç”¨æƒ…å†µ
EXPLAIN SELECT * FROM source_table WHERE status = 1 AND create_time > '2023-01-01';
```

**ğŸ”¸ å†™å…¥ç«¯ç´¢å¼•ä¼˜åŒ–**

å†™å…¥æ—¶è¿‡å¤šçš„ç´¢å¼•ä¼šæ‹–æ…¢é€Ÿåº¦ï¼š

```sql
-- å†™å…¥å‰åˆ é™¤éå¿…éœ€ç´¢å¼•
DROP INDEX idx_optional ON target_table;

-- å†™å…¥å®Œæˆåé‡å»ºç´¢å¼•
CREATE INDEX idx_optional ON target_table(column_name);

-- æˆ–è€…ç¦ç”¨ç´¢å¼•æ›´æ–°
ALTER TABLE target_table DISABLE KEYS;
-- æ‰§è¡Œæ•°æ®å†™å…¥
-- ...
ALTER TABLE target_table ENABLE KEYS;
```

### 6.3 äº‹åŠ¡ä¸é”ä¼˜åŒ–


**ğŸ”¸ äº‹åŠ¡éš”ç¦»çº§åˆ«è°ƒæ•´**

```sql
-- æŸ¥çœ‹å½“å‰éš”ç¦»çº§åˆ«
SELECT $$transaction_isolation;

-- è°ƒæ•´ä¸ºè¯»å·²æäº¤(æé«˜å¹¶å‘æ€§èƒ½)
SET SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED;
```

**ğŸ”¸ é”ç­‰å¾…ä¼˜åŒ–**

```sql
-- è°ƒæ•´é”ç­‰å¾…è¶…æ—¶æ—¶é—´
SET GLOBAL innodb_lock_wait_timeout = 50;

-- æŸ¥çœ‹é”ç­‰å¾…æƒ…å†µ
SELECT * FROM information_schema.INNODB_LOCKS;
SELECT * FROM information_schema.INNODB_LOCK_WAITS;
```

---

## 7. ğŸŒ ç½‘ç»œä¸è¿æ¥ä¼˜åŒ–


### 7.1 ç½‘ç»œé…ç½®ä¼˜åŒ–


**ç½‘ç»œä¼˜åŒ–**é‡ç‚¹æ˜¯å‡å°‘ç½‘ç»œå»¶è¿Ÿå’Œæé«˜ä¼ è¾“æ•ˆç‡ã€‚

**ğŸ”¸ è¿æ¥æ± é…ç½®**

```json
{
  "reader": {
    "parameter": {
      "connection": [
        {
          "jdbcUrl": ["jdbc:mysql://localhost:3306/test?useSSL=false&tcpKeepAlive=true&socketTimeout=60000&connectTimeout=10000"]
        }
      ]
    }
  }
}
```

**ç½‘ç»œç›¸å…³å‚æ•°è¯´æ˜ï¼š**
- `tcpKeepAlive=true`ï¼šä¿æŒTCPè¿æ¥æ´»è·ƒ
- `socketTimeout=60000`ï¼šSocketè¯»å–è¶…æ—¶60ç§’
- `connectTimeout=10000`ï¼šè¿æ¥å»ºç«‹è¶…æ—¶10ç§’

**ğŸ”¸ å‹ç¼©ä¼ è¾“é…ç½®**

```
å¼€å¯æ•°æ®å‹ç¼©ï¼š
useCompression=true          # JDBCçº§åˆ«å‹ç¼©
useServerPrepStmts=false     # å…³é—­é¢„ç¼–è¯‘å‡å°‘ç½‘ç»œäº¤äº’
```

### 7.2 è·¨ç½‘ç»œç¯å¢ƒä¼˜åŒ–


**ğŸ”¸ è·¨åœ°åŸŸä¼ è¾“ä¼˜åŒ–**

```json
{
  "core": {
    "transport": {
      "channel": {
        "speed": {
          "byte": 10485760,     // é™åˆ¶å¸¦å®½10MB/s
          "record": 5000        // é™åˆ¶è®°å½•æ•°
        }
      }
    }
  }
}
```

**ğŸ”¸ ç½‘ç»œè´¨é‡æ£€æµ‹**

```bash
# æ£€æµ‹ç½‘ç»œå»¶è¿Ÿ
ping target_host

# æ£€æµ‹å¸¦å®½
iperf3 -c target_host -t 30

# æ£€æµ‹æ•°æ®åº“è¿æ¥å»¶è¿Ÿ
mysql -h target_host -u user -p -e "SELECT 1;" --time
```

---

## 8. ğŸ“Š æ€§èƒ½ç›‘æ§ä¸å·¥å…·


### 8.1 DataXå†…ç½®ç›‘æ§


**DataXè‡ªå¸¦ç›‘æ§**èƒ½å¸®æˆ‘ä»¬å®æ—¶äº†è§£ä»»åŠ¡æ‰§è¡Œæƒ…å†µã€‚

**ğŸ”¸ å®æ—¶æ€§èƒ½ç›‘æ§**

```bash
# å¯åŠ¨ä»»åŠ¡æ—¶å¼€å¯è¯¦ç»†æ—¥å¿—
python datax.py --jvm="-Xms2g -Xmx2g" --loglevel=INFO job.json

# ç›‘æ§å…³é”®æŒ‡æ ‡
tail -f datax.log | grep -E "(é€Ÿåº¦|SPEED|ERROR|WARN)"
```

**ğŸ”¸ ç›‘æ§æŒ‡æ ‡è§£è¯»**

```
ä»»åŠ¡æ‰§è¡ŒæŠ¥å‘Šç¤ºä¾‹ï¼š
2024-09-11 15:30:00.000 [job-0] INFO  JobContainer - 
ä»»åŠ¡å¯åŠ¨æ—¶åˆ»                    : 2024-09-11 15:28:00
ä»»åŠ¡ç»“æŸæ—¶åˆ»                    : 2024-09-11 15:30:00
ä»»åŠ¡æ€»è®¡è€—æ—¶                    : 120s
ä»»åŠ¡å¹³å‡æµé‡                    : 5.12MB/s
è®°å½•å†™å…¥é€Ÿåº¦                    : 25000rec/s
è¯»å‡ºè®°å½•æ€»æ•°                    : 3000000
å†™å…¥è®°å½•æ€»æ•°                    : 3000000
```

### 8.2 ç³»ç»Ÿçº§ç›‘æ§å·¥å…·


**ğŸ”§ å®æ—¶ç›‘æ§è„šæœ¬**

```bash
#!/bin/bash
# datax_monitor.sh - DataXæ€§èƒ½ç›‘æ§è„šæœ¬

echo "=== DataXæ€§èƒ½ç›‘æ§ ==="
echo "æ—¶é—´: $(date)"
echo ""

# CPUä½¿ç”¨ç‡
echo "CPUä½¿ç”¨ç‡:"
top -b -n1 | grep "Cpu(s)" | awk '{print $2}' | sed 's/%us,//'

# å†…å­˜ä½¿ç”¨
echo "å†…å­˜ä½¿ç”¨:"
free -h | grep Mem | awk '{print "ä½¿ç”¨:" $3 "/" $2 " (" $3/$2*100 "%)"}'

# ç£ç›˜IO
echo "ç£ç›˜IO:"
iostat -x 1 1 | grep -v "^$" | tail -n +4

# ç½‘ç»œè¿æ¥æ•°
echo "æ•°æ®åº“è¿æ¥æ•°:"
netstat -an | grep :3306 | wc -l

# DataXè¿›ç¨‹çŠ¶æ€
echo "DataXè¿›ç¨‹:"
ps aux | grep datax | grep -v grep
```

### 8.3 æ•°æ®åº“ç›‘æ§


**ğŸ”¸ MySQLæ€§èƒ½ç›‘æ§**

```sql
-- å®æ—¶æŸ¥çœ‹MySQLçŠ¶æ€
SHOW PROCESSLIST;

-- æŸ¥çœ‹æ…¢æŸ¥è¯¢
SHOW VARIABLES LIKE 'slow_query_log_file';
tail -f /var/log/mysql/mysql-slow.log

-- æŸ¥çœ‹è¿æ¥æ•°ä½¿ç”¨æƒ…å†µ
SHOW STATUS LIKE 'Threads_connected';
SHOW VARIABLES LIKE 'max_connections';

-- æŸ¥çœ‹ç¼“å†²æ± å‘½ä¸­ç‡
SHOW STATUS LIKE 'Innodb_buffer_pool_read%';
```

**ğŸ”¸ å…³é”®æ€§èƒ½æŒ‡æ ‡**

| **æŒ‡æ ‡** | **è¯´æ˜** | **æ­£å¸¸èŒƒå›´** | **å¼‚å¸¸å¤„ç†** |
|---------|---------|-------------|-------------|
| CPUä½¿ç”¨ç‡ | DataXè¿›ç¨‹CPUå ç”¨ | 50-80% | >90%éœ€è¦é™ä½å¹¶å‘ |
| å†…å­˜ä½¿ç”¨ç‡ | JVMå †å†…å­˜ä½¿ç”¨ | <80% | >90%éœ€è¦å¢åŠ å†…å­˜ |
| æ•°æ®åº“è¿æ¥æ•° | æ´»è·ƒè¿æ¥æ•°é‡ | <æœ€å¤§è¿æ¥æ•°80% | æ¥è¿‘ä¸Šé™éœ€è¦è°ƒæ•´ |
| ç½‘ç»œå¸¦å®½ | æ•°æ®ä¼ è¾“é€Ÿåº¦ | æ ¹æ®å¸¦å®½å®¹é‡ | æ¥è¿‘ä¸Šé™éœ€è¦é™é€Ÿ |

---

## 9. ğŸ’¼ å®æˆ˜æ¡ˆä¾‹åˆ†æ


### 9.1 æ¡ˆä¾‹ä¸€ï¼šå¤§è¡¨åŒæ­¥é€Ÿåº¦æ…¢


**ğŸ”¸ é—®é¢˜æè¿°**
ä¸€å¼ 5000ä¸‡è®°å½•çš„ç”¨æˆ·è¡¨ï¼Œä»MySQLåŒæ­¥åˆ°å¦ä¸€ä¸ªMySQLï¼Œé€Ÿåº¦åªæœ‰æ¯ç§’2000æ¡è®°å½•ï¼Œé¢„è®¡éœ€è¦7å°æ—¶å®Œæˆã€‚

**ğŸ”¸ é—®é¢˜åˆ†æ**

```
æ€§èƒ½ç“¶é¢ˆåˆ†æï¼š
1. æŸ¥çœ‹DataXæ—¥å¿—å‘ç°è¯»å–é€Ÿåº¦æ­£å¸¸ï¼Œå†™å…¥é€Ÿåº¦æ…¢
2. æ£€æŸ¥ç›®æ ‡æ•°æ®åº“å‘ç°æœ‰å¾ˆå¤šç´¢å¼•
3. æ£€æŸ¥batchSizeè®¾ç½®ä¸º512ï¼Œåå°
```

**ğŸ”¸ ä¼˜åŒ–æ–¹æ¡ˆ**

```json
{
  "job": {
    "setting": {
      "speed": {
        "channel": 8,           // å¢åŠ å¹¶å‘åº¦
        "record": 50000         // æé«˜é™é€Ÿ
      }
    },
    "content": [
      {
        "reader": {
          "name": "mysqlreader",
          "parameter": {
            "splitPk": "id",     // ä½¿ç”¨ä¸»é”®åˆ†ç‰‡
            "fetchSize": 2000    // å¢åŠ è¯»å–æ‰¹é‡
          }
        },
        "writer": {
          "name": "mysqlwriter", 
          "parameter": {
            "batchSize": 4096,   // å¢åŠ å†™å…¥æ‰¹é‡
            "writeMode": "insert"
          }
        }
      }
    ]
  }
}
```

**ğŸ”¸ ä¼˜åŒ–ç»“æœ**
- ä¼˜åŒ–å‰ï¼š2000è®°å½•/ç§’ï¼Œé¢„è®¡7å°æ—¶
- ä¼˜åŒ–åï¼š15000è®°å½•/ç§’ï¼Œå®é™…55åˆ†é’Ÿå®Œæˆ
- æ€§èƒ½æå‡ï¼š7.5å€

### 9.2 æ¡ˆä¾‹äºŒï¼šå†…å­˜æº¢å‡ºé—®é¢˜


**ğŸ”¸ é—®é¢˜æè¿°**
DataXä»»åŠ¡æ‰§è¡Œåˆ°ä¸€åŠæ—¶å‡ºç°`OutOfMemoryError`ï¼Œä»»åŠ¡å¤±è´¥ã€‚

**ğŸ”¸ é—®é¢˜åˆ†æ**

```
å†…å­˜ä½¿ç”¨åˆ†æï¼š
1. æ—¥å¿—æ˜¾ç¤ºï¼šjava.lang.OutOfMemoryError: Java heap space
2. jstat -gc æ˜¾ç¤ºè€å¹´ä»£å†…å­˜ä½¿ç”¨ç‡100%
3. é…ç½®æ£€æŸ¥ï¼š-Xmx2gï¼Œä½†channel=16ï¼ŒbyteCapacity=128MB
```

**ğŸ”¸ å†…å­˜ä½¿ç”¨é‡è®¡ç®—**

```
å†…å­˜éœ€æ±‚ä¼°ç®—ï¼š
channelæ•°é‡ Ã— byteCapacity Ã— å®‰å…¨ç³»æ•°
= 16 Ã— 128MB Ã— 2
= 4096MB = 4GB

ä½†JVMå †å†…å­˜åªæœ‰2GBï¼Œå¯¼è‡´å†…å­˜ä¸è¶³
```

**ğŸ”¸ è§£å†³æ–¹æ¡ˆ**

```bash
# æ–¹æ¡ˆ1ï¼šå¢åŠ JVMå†…å­˜
export DATAX_HEAP_SIZE=6g

# æ–¹æ¡ˆ2ï¼šå‡å°‘å†…å­˜ä½¿ç”¨
```

```json
{
  "core": {
    "transport": {
      "channel": {
        "capacity": 1024,        // å‡å°‘è®°å½•ç¼“å­˜
        "byteCapacity": 33554432 // å‡å°‘å­—èŠ‚ç¼“å­˜åˆ°32MB
      }
    }
  },
  "job": {
    "setting": {
      "speed": {
        "channel": 8            // å‡å°‘å¹¶å‘åº¦
      }
    }
  }
}
```

### 9.3 æ¡ˆä¾‹ä¸‰ï¼šè·¨åœ°åŸŸåŒæ­¥ä¼˜åŒ–


**ğŸ”¸ é—®é¢˜æè¿°**
ä»åŒ—äº¬MySQLåŒæ­¥æ•°æ®åˆ°ä¸Šæµ·MySQLï¼Œç½‘ç»œå»¶è¿Ÿé«˜ï¼ŒåŒæ­¥é€Ÿåº¦å¾ˆæ…¢ã€‚

**ğŸ”¸ ç½‘ç»œç¯å¢ƒåˆ†æ**

```bash
# å»¶è¿Ÿæµ‹è¯•
ping shanghai-mysql-host
# ç»“æœï¼šå¹³å‡å»¶è¿Ÿ80ms

# å¸¦å®½æµ‹è¯•  
iperf3 -c shanghai-mysql-host
# ç»“æœï¼šå¯ç”¨å¸¦å®½50Mbps
```

**ğŸ”¸ ä¼˜åŒ–é…ç½®**

```json
{
  "core": {
    "transport": {
      "channel": {
        "capacity": 4096,      // å¢åŠ ç¼“å­˜å‡å°‘ç½‘ç»œäº¤äº’
        "byteCapacity": 134217728, // 128MBç¼“å­˜
        "speed": {
          "byte": 6291456      // é™åˆ¶å¸¦å®½6MB/sï¼Œé¿å…ç½‘ç»œæ‹¥å¡
        }
      }
    }
  },
  "reader": {
    "parameter": {
      "fetchSize": 5000,       // å¢åŠ æ¯æ¬¡è¯»å–é‡
      "connection": [
        {
          "jdbcUrl": ["jdbc:mysql://beijing-host:3306/db?useCompression=true&socketTimeout=300000&connectTimeout=60000"]
        }
      ]
    }
  },
  "writer": {
    "parameter": {
      "batchSize": 8192,       // å¢åŠ æ‰¹é‡å†™å…¥
      "connection": [
        {
          "jdbcUrl": ["jdbc:mysql://shanghai-host:3306/db?useCompression=true&rewriteBatchedStatements=true"]
        }
      ]
    }
  }
}
```

---

## 10. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 10.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


**ğŸ”¸ æ€§èƒ½ç“¶é¢ˆçš„ä¸‰ä¸ªå±‚é¢**
```
åº”ç”¨å±‚ï¼šDataXé…ç½®å‚æ•°ä¼˜åŒ–
ç³»ç»Ÿå±‚ï¼šCPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œèµ„æº
æ•°æ®åº“å±‚ï¼šè¿æ¥æ± ã€ç´¢å¼•ã€äº‹åŠ¡ã€é”
```

**ğŸ”¸ æ€§èƒ½ä¼˜åŒ–çš„åŸºæœ¬æ€è·¯**
```
å®šä½ç“¶é¢ˆ â†’ é’ˆå¯¹æ€§ä¼˜åŒ– â†’ æ•ˆæœéªŒè¯ â†’ æŒç»­ç›‘æ§
```

**ğŸ”¸ å…³é”®é…ç½®å‚æ•°**
- **channel**ï¼šå¹¶å‘åº¦ï¼Œå½±å“å¤„ç†é€Ÿåº¦
- **batchSize**ï¼šæ‰¹é‡å¤§å°ï¼Œå½±å“å†™å…¥æ•ˆç‡  
- **fetchSize**ï¼šè¯»å–æ‰¹é‡ï¼Œå½±å“è¯»å–æ•ˆç‡
- **capacity/byteCapacity**ï¼šç¼“å­˜å¤§å°ï¼Œå½±å“å†…å­˜ä½¿ç”¨

### 10.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ å¹¶å‘åº¦ä¸æ˜¯è¶Šå¤§è¶Šå¥½**
```
å¹¶å‘åº¦ä¼˜åŒ–åŸåˆ™ï¼š
- è¦è€ƒè™‘ç³»ç»Ÿèµ„æºé™åˆ¶ï¼ˆCPUã€å†…å­˜ã€è¿æ¥æ•°ï¼‰
- è¦è€ƒè™‘æ•°æ®åº“æ‰¿å—èƒ½åŠ›
- è¦è€ƒè™‘ç½‘ç»œå¸¦å®½é™åˆ¶
- é€‚ä¸­çš„å¹¶å‘åº¦å¾€å¾€æ•ˆæœæœ€å¥½
```

**ğŸ”¹ å†…å­˜é…ç½®çš„é‡è¦æ€§**
```
å†…å­˜è®¡ç®—å…¬å¼ï¼š
æ‰€éœ€å†…å­˜ â‰ˆ channelæ•° Ã— byteCapacity Ã— 2 + JVMå›ºå®šå¼€é”€

å¸¸è§é—®é¢˜ï¼š
- å†…å­˜ä¸è¶³ï¼šOutOfMemoryError
- å†…å­˜è¿‡å¤§ï¼šæµªè´¹èµ„æºï¼ŒGCå‹åŠ›å¤§
```

**ğŸ”¹ æ•°æ®åº“ä¼˜åŒ–çš„å…³é”®ç‚¹**
```
è¯»å–ç«¯ä¼˜åŒ–ï¼š
- ç´¢å¼•ï¼šç¡®ä¿æŸ¥è¯¢èƒ½ä½¿ç”¨ç´¢å¼•
- åˆ†ç‰‡ï¼šåˆç†é€‰æ‹©splitPkå­—æ®µ
- è¿æ¥ï¼šæ§åˆ¶è¿æ¥æ•°å’Œè¶…æ—¶æ—¶é—´

å†™å…¥ç«¯ä¼˜åŒ–ï¼š
- æ‰¹é‡ï¼šå¢å¤§batchSizeæé«˜æ•ˆç‡
- ç´¢å¼•ï¼šä¸´æ—¶åˆ é™¤éå¿…éœ€ç´¢å¼•
- äº‹åŠ¡ï¼šè°ƒæ•´éš”ç¦»çº§åˆ«
```

### 10.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ğŸ¯ æ€§èƒ½ä¼˜åŒ–æ£€æŸ¥æ¸…å•**

```
âœ… é…ç½®ä¼˜åŒ–
â–¡ channelæ•°é‡æ˜¯å¦åˆç†ï¼ˆ2-16ä¸ªï¼‰
â–¡ batchSizeæ˜¯å¦è¶³å¤Ÿå¤§ï¼ˆ1024-4096ï¼‰
â–¡ å†…å­˜é…ç½®æ˜¯å¦å……è¶³
â–¡ ç½‘ç»œå‚æ•°æ˜¯å¦ä¼˜åŒ–

âœ… æ•°æ®åº“ä¼˜åŒ–  
â–¡ æºè¡¨æ˜¯å¦æœ‰åˆé€‚çš„ç´¢å¼•
â–¡ ç›®æ ‡è¡¨ç´¢å¼•æ˜¯å¦è¿‡å¤š
â–¡ æ•°æ®åº“è¿æ¥æ•°æ˜¯å¦è¶³å¤Ÿ
â–¡ æ˜¯å¦å¼€å¯äº†æ‰¹é‡æ’å…¥ä¼˜åŒ–

âœ… ç³»ç»Ÿèµ„æº
â–¡ CPUä½¿ç”¨ç‡æ˜¯å¦æ­£å¸¸
â–¡ å†…å­˜æ˜¯å¦å……è¶³
â–¡ ç£ç›˜IOæ˜¯å¦æˆä¸ºç“¶é¢ˆ
â–¡ ç½‘ç»œå¸¦å®½æ˜¯å¦å……è¶³

âœ… ç›‘æ§å‘Šè­¦
â–¡ æ˜¯å¦æœ‰å®æ—¶æ€§èƒ½ç›‘æ§
â–¡ æ˜¯å¦è®¾ç½®äº†å¼‚å¸¸å‘Šè­¦
â–¡ æ˜¯å¦è®°å½•æ€§èƒ½åŸºçº¿
```

**ğŸ¯ å¸¸è§é—®é¢˜å¿«é€Ÿè¯Šæ–­**

| **ç—‡çŠ¶** | **å¯èƒ½åŸå› ** | **è§£å†³æ–¹æ¡ˆ** |
|---------|-------------|-------------|
| åŒæ­¥é€Ÿåº¦æ…¢ | å¹¶å‘åº¦ä½ã€æ‰¹é‡å° | å¢åŠ channelå’ŒbatchSize |
| å†…å­˜æº¢å‡º | ç¼“å­˜é…ç½®è¿‡å¤§ | å‡å°‘byteCapacityæˆ–å¢åŠ å†…å­˜ |
| CPUä½¿ç”¨ç‡ä½ | å¹¶å‘åº¦ä¸å¤Ÿ | å¢åŠ channelæ•°é‡ |
| æ•°æ®åº“è¿æ¥è¶…æ—¶ | è¿æ¥æ± æ»¡ | å¢åŠ æ•°æ®åº“max_connections |
| ç½‘ç»œä¼ è¾“æ…¢ | è·¨åœ°åŸŸå»¶è¿Ÿé«˜ | å¼€å¯å‹ç¼©ï¼Œå¢åŠ ç¼“å­˜ |

**ğŸ¯ æ€§èƒ½è°ƒä¼˜æœ€ä½³å®è·µ**

```
1. æ¸è¿›å¼ä¼˜åŒ–ï¼š
   å…ˆå°æ•°æ®é‡æµ‹è¯• â†’ é€æ­¥å¢åŠ æ•°æ®é‡ â†’ æœ€ç»ˆå…¨é‡æµ‹è¯•

2. ç›‘æ§é©±åŠ¨ä¼˜åŒ–ï¼š
   å»ºç«‹æ€§èƒ½åŸºçº¿ â†’ è¯†åˆ«ç“¶é¢ˆç‚¹ â†’ é’ˆå¯¹æ€§ä¼˜åŒ– â†’ æ•ˆæœéªŒè¯

3. ç»¼åˆè€ƒè™‘èµ„æºï¼š
   CPU + å†…å­˜ + ç£ç›˜IO + ç½‘ç»œ + æ•°æ®åº“ï¼Œä¸èƒ½é¡¾æ­¤å¤±å½¼

4. å»ºç«‹æ ‡å‡†é…ç½®ï¼š
   ä¸ºä¸åŒè§„æ¨¡çš„ä»»åŠ¡å»ºç«‹æ ‡å‡†é…ç½®æ¨¡æ¿
```

### 10.4 æ ¸å¿ƒè®°å¿†å£è¯€


```
DataXä¼˜åŒ–ä¸‰æ­¥èµ°ï¼šå…ˆæ‰¾ç“¶é¢ˆåœ¨å“ªå¤´
å¹¶å‘æ‰¹é‡è¦è°ƒå¥½ï¼Œå†…å­˜ç½‘ç»œä¸èƒ½å°‘  
æ•°æ®åº“é‡Œå»ºç´¢å¼•ï¼Œç›‘æ§æ—¥å¿—è¦çœ‹é½
æ¸è¿›æµ‹è¯•æ•ˆæœä½³ï¼Œæ ‡å‡†é…ç½®èµ°å¤©ä¸‹
```

**å…³é”®æ•°å­—è®°å¿†ï¼š**
- **å¹¶å‘åº¦**ï¼š2-16ä¸ªchannelï¼Œæ ¹æ®CPUæ ¸æ•°
- **æ‰¹é‡å¤§å°**ï¼šè¯»å–1000-5000ï¼Œå†™å…¥1024-4096
- **å†…å­˜é…ç½®**ï¼šchannelæ•° Ã— 64MB Ã— 2
- **è¶…æ—¶è®¾ç½®**ï¼šè¿æ¥10ç§’ï¼ŒæŸ¥è¯¢300ç§’ï¼ŒSocket60ç§’