---
title: 22ã€é”™è¯¯æ—¥å¿—ç›‘æ§ä¸å‘Šè­¦å®è·µ
---
## ğŸ“š ç›®å½•

1. [é”™è¯¯æ—¥å¿—ç›‘æ§åŸºç¡€æ¦‚å¿µ](#1-é”™è¯¯æ—¥å¿—ç›‘æ§åŸºç¡€æ¦‚å¿µ)
2. [å®æ—¶ç›‘æ§å·¥å…·é…ç½®](#2-å®æ—¶ç›‘æ§å·¥å…·é…ç½®)
3. [å…³é”®é”™è¯¯è¯†åˆ«ä¸è¿‡æ»¤](#3-å…³é”®é”™è¯¯è¯†åˆ«ä¸è¿‡æ»¤)
4. [å‘Šè­¦é˜ˆå€¼è®¾ç½®ç­–ç•¥](#4-å‘Šè­¦é˜ˆå€¼è®¾ç½®ç­–ç•¥)
5. [è‡ªåŠ¨åŒ–åˆ†æè„šæœ¬å®è·µ](#5-è‡ªåŠ¨åŒ–åˆ†æè„šæœ¬å®è·µ)
6. [ç›‘æ§Dashboardè®¾è®¡](#6-ç›‘æ§Dashboardè®¾è®¡)
7. [é›†ä¸­åŒ–æ”¶é›†æ–¹æ¡ˆ](#7-é›†ä¸­åŒ–æ”¶é›†æ–¹æ¡ˆ)
8. [ELK Stackå®è·µåº”ç”¨](#8-ELK-Stackå®è·µåº”ç”¨)
9. [Prometheusç›‘æ§é›†æˆ](#9-Prometheusç›‘æ§é›†æˆ)
10. [å‘Šè­¦é€šçŸ¥æœºåˆ¶](#10-å‘Šè­¦é€šçŸ¥æœºåˆ¶)
11. [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#11-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
12. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#12-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ“Š é”™è¯¯æ—¥å¿—ç›‘æ§åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯é”™è¯¯æ—¥å¿—ç›‘æ§


**é€šä¿—ç†è§£**ï¼šé”™è¯¯æ—¥å¿—ç›‘æ§å°±åƒç»™MySQLæ•°æ®åº“å®‰è£…ä¸€ä¸ª"å¥åº·ç›‘æ§å™¨"ï¼Œå®æ—¶è§‚å¯Ÿæ•°æ®åº“çš„è¿è¡ŒçŠ¶æ€ï¼Œä¸€æ—¦å‡ºç°é—®é¢˜å°±ç«‹å³å‘å‡ºè­¦æŠ¥ã€‚

```
ç±»æ¯”ç”Ÿæ´»åœºæ™¯ï¼š
åŒ»é™¢çš„å¿ƒç”µç›‘æŠ¤ä»ª â†’ MySQLé”™è¯¯æ—¥å¿—ç›‘æ§
ç—…äººçš„å¿ƒè·³å¼‚å¸¸ â†’ æ•°æ®åº“é”™è¯¯
åŒ»ç”Ÿç«‹å³å¾—åˆ°è­¦æŠ¥ â†’ DBAæ”¶åˆ°å‘Šè­¦é€šçŸ¥
åŠæ—¶å¤„ç†ç—…æƒ… â†’ å¿«é€Ÿä¿®å¤æ•°æ®åº“é—®é¢˜
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦é”™è¯¯æ—¥å¿—ç›‘æ§


**æ ¸å¿ƒä»·å€¼**ï¼š
- **ğŸ” é—®é¢˜å‘ç°**ï¼šç¬¬ä¸€æ—¶é—´å‘ç°æ•°æ®åº“å¼‚å¸¸
- **âš¡ å¿«é€Ÿå“åº”**ï¼šé¿å…å°é—®é¢˜å˜æˆå¤§æ•…éšœ
- **ğŸ“ˆ è¶‹åŠ¿åˆ†æ**ï¼šäº†è§£æ•°æ®åº“å¥åº·çŠ¶å†µå˜åŒ–
- **ğŸ’° æˆæœ¬èŠ‚çº¦**ï¼šå‡å°‘å› æ•…éšœå¯¼è‡´çš„ä¸šåŠ¡æŸå¤±

**å®é™…åœºæ™¯ä¸¾ä¾‹**ï¼š
```
æ²¡æœ‰ç›‘æ§çš„æƒ…å†µï¼š
ç”¨æˆ·åé¦ˆ â†’ ç½‘ç«™æ‰“ä¸å¼€äº†
æ£€æŸ¥å‘ç° â†’ MySQLè¿æ¥æ•°è€—å°½
æŸ¥çœ‹æ—¥å¿— â†’ å‘ç°2å°æ—¶å‰å°±å¼€å§‹æŠ¥é”™
ç»“æœ â†’ ä¸šåŠ¡ä¸­æ–­2å°æ—¶ï¼ŒæŸå¤±å·¨å¤§

æœ‰ç›‘æ§çš„æƒ…å†µï¼š
ç³»ç»Ÿæ£€æµ‹ â†’ MySQLè¿æ¥æ•°å¿«æ»¡äº†
ç«‹å³å‘Šè­¦ â†’ DBAæ”¶åˆ°çŸ­ä¿¡é€šçŸ¥
å¿«é€Ÿå¤„ç† â†’ é‡å¯è¿æ¥æ± ï¼Œä¼˜åŒ–æŸ¥è¯¢
ç»“æœ â†’ 5åˆ†é’Ÿè§£å†³ï¼Œä¸šåŠ¡æ— æ„ŸçŸ¥
```

### 1.3 ç›‘æ§çš„æ ¸å¿ƒæŒ‡æ ‡


**å…³é”®ç›‘æ§å†…å®¹**ï¼š
- **ğŸš¨ è‡´å‘½é”™è¯¯**ï¼šæœåŠ¡å™¨å´©æºƒã€æ— æ³•å¯åŠ¨
- **âš ï¸ è­¦å‘Šä¿¡æ¯**ï¼šè¿æ¥æ•°è¿‡å¤šã€ç£ç›˜ç©ºé—´ä¸è¶³
- **ğŸ”„ é‡å¯äº‹ä»¶**ï¼šå¼‚å¸¸é‡å¯ã€é…ç½®å˜æ›´
- **ğŸ“Š æ€§èƒ½é—®é¢˜**ï¼šæ…¢æŸ¥è¯¢ã€æ­»é”ã€è¶…æ—¶

---

## 2. ğŸ› ï¸ å®æ—¶ç›‘æ§å·¥å…·é…ç½®


### 2.1 ä½¿ç”¨tailå‘½ä»¤å®æ—¶æŸ¥çœ‹


**æœ€ç®€å•çš„ç›‘æ§æ–¹å¼**ï¼š
```bash
# å®æ—¶æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f /var/log/mysql/error.log

# åªæŸ¥çœ‹åŒ…å«ERRORçš„è¡Œ
tail -f /var/log/mysql/error.log | grep -i error

# æŸ¥çœ‹æœ€è¿‘50è¡Œå¹¶å®æ—¶è·Ÿè¸ª
tail -50f /var/log/mysql/error.log
```

> ğŸ’¡ **æ–°æ‰‹æç¤º**ï¼š`tail -f` å‘½ä»¤å°±åƒä¸€ä¸ª"å®æ—¶æ’­æ”¾å™¨"ï¼Œèƒ½å¤ŸæŒç»­æ˜¾ç¤ºæ—¥å¿—æ–‡ä»¶çš„æœ€æ–°å†…å®¹ï¼Œéå¸¸é€‚åˆå®æ—¶ç›‘æ§ã€‚

### 2.2 é…ç½®rsyslogé›†ä¸­æ”¶é›†


**ä»€ä¹ˆæ˜¯rsyslog**ï¼šrsyslogæ˜¯Linuxç³»ç»Ÿçš„æ—¥å¿—ç®¡ç†æœåŠ¡ï¼Œå¯ä»¥æŠŠå„ç§æ—¥å¿—ç»Ÿä¸€æ”¶é›†åˆ°æŒ‡å®šä½ç½®ã€‚

```bash
# ç¼–è¾‘rsyslogé…ç½®æ–‡ä»¶
sudo vim /etc/rsyslog.conf

# æ·»åŠ MySQLé”™è¯¯æ—¥å¿—é…ç½®
$ModLoad imfile
$InputFileName /var/log/mysql/error.log
$InputFileTag mysql-error:
$InputFileStateFile mysql-error-state
$InputFileSeverity error
$InputFileFacility local0
$InputRunFileMonitor

# å‘é€åˆ°è¿œç¨‹æ—¥å¿—æœåŠ¡å™¨
local0.* $$log-server.company.com:514
```

### 2.3 ä½¿ç”¨logrotateç®¡ç†æ—¥å¿—è½®è½¬


**é¿å…æ—¥å¿—æ–‡ä»¶è¿‡å¤§**ï¼š
```bash
# åˆ›å»ºMySQLæ—¥å¿—è½®è½¬é…ç½®
sudo vim /etc/logrotate.d/mysql

# é…ç½®å†…å®¹
/var/log/mysql/*.log {
    daily          # æ¯å¤©è½®è½¬
    missingok      # æ–‡ä»¶ä¸å­˜åœ¨ä¸æŠ¥é”™
    rotate 52      # ä¿ç•™52ä¸ªå¤‡ä»½(ä¸€å¹´)
    compress       # å‹ç¼©æ—§æ–‡ä»¶
    delaycompress  # å»¶è¿Ÿä¸€å¤©å‹ç¼©
    notifempty     # ç©ºæ–‡ä»¶ä¸è½®è½¬
    create 640 mysql mysql  # æ–°æ–‡ä»¶æƒé™
    postrotate
        # è½®è½¬åé‡æ–°åŠ è½½MySQLæ—¥å¿—
        /usr/bin/mysqladmin flush-logs
    endscript
}
```

---

## 3. ğŸ¯ å…³é”®é”™è¯¯è¯†åˆ«ä¸è¿‡æ»¤


### 3.1 å¸¸è§é”™è¯¯ç±»å‹è¯†åˆ«


**é«˜ä¼˜å…ˆçº§é”™è¯¯å…³é”®è¯**ï¼š
```bash
# æœåŠ¡å™¨çº§åˆ«çš„ä¸¥é‡é”™è¯¯
CRITICAL_ERRORS=(
    "server shutdown"     # æœåŠ¡å™¨å…³é—­
    "out of memory"       # å†…å­˜ä¸è¶³
    "disk full"           # ç£ç›˜æ»¡
    "corruption"          # æ•°æ®æŸå
    "crash"               # å´©æºƒ
)

# è¿æ¥ç›¸å…³é”™è¯¯
CONNECTION_ERRORS=(
    "too many connections"    # è¿æ¥æ•°è¿‡å¤š
    "connection refused"      # è¿æ¥è¢«æ‹’ç»
    "access denied"          # è®¿é—®è¢«æ‹’ç»
    "host blocked"           # ä¸»æœºè¢«é˜»æ­¢
)

# æ€§èƒ½ç›¸å…³è­¦å‘Š
PERFORMANCE_WARNINGS=(
    "long query"             # æ…¢æŸ¥è¯¢
    "deadlock"              # æ­»é”
    "lock wait timeout"     # é”ç­‰å¾…è¶…æ—¶
    "temporary table"       # ä¸´æ—¶è¡¨è¿‡å¤š
)
```

### 3.2 æ™ºèƒ½è¿‡æ»¤è„šæœ¬


**è¿‡æ»¤é‡è¦é”™è¯¯çš„è„šæœ¬**ï¼š
```bash
#!/bin/bash
# mysql_error_filter.sh

ERROR_LOG="/var/log/mysql/error.log"
ALERT_LOG="/var/log/mysql/alerts.log"

# å®šä¹‰é”™è¯¯çº§åˆ«
declare -A ERROR_LEVELS=(
    ["CRITICAL"]="server shutdown|out of memory|corruption|crash"
    ["HIGH"]="too many connections|access denied|deadlock"
    ["MEDIUM"]="long query|temporary table|warning"
)

# ç›‘æ§å‡½æ•°
monitor_errors() {
    tail -f "$ERROR_LOG" | while read line; do
        timestamp=$(date '+%Y-%m-%d %H:%M:%S')
        
        # æ£€æŸ¥å…³é”®é”™è¯¯
        for level in "${!ERROR_LEVELS[@]}"; do
            if echo "$line" | grep -iE "${ERROR_LEVELS[$level]}" > /dev/null; then
                echo "[$timestamp] [$level] $line" >> "$ALERT_LOG"
                
                # å‘é€å‘Šè­¦
                send_alert "$level" "$line"
                break
            fi
        done
    done
}

# å‘é€å‘Šè­¦å‡½æ•°
send_alert() {
    local level=$1
    local message=$2
    
    case $level in
        "CRITICAL")
            # ç«‹å³å‘é€çŸ­ä¿¡å’Œé‚®ä»¶
            echo "CRITICAL MySQL Error: $message" | mail -s "MySQL CRITICAL Alert" admin@company.com
            ;;
        "HIGH")
            # å‘é€é‚®ä»¶
            echo "High Priority MySQL Error: $message" | mail -s "MySQL Alert" dba@company.com
            ;;
    esac
}

# å¯åŠ¨ç›‘æ§
monitor_errors
```

### 3.3 æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æ¨¡å¼


**ç²¾ç¡®åŒ¹é…é”™è¯¯æ¨¡å¼**ï¼š
```bash
# åŒ¹é…æ—¶é—´æˆ³æ ¼å¼çš„é”™è¯¯
ERROR_PATTERN="^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z.*\[ERROR\]"

# åŒ¹é…è¿æ¥é”™è¯¯
CONNECTION_PATTERN="connection.*refused|access.*denied|too many connections"

# åŒ¹é…æ•°æ®åº“æ“ä½œé”™è¯¯
SQL_ERROR_PATTERN="syntax error|table.*doesn't exist|duplicate entry"

# ç»„åˆä½¿ç”¨
grep -E "$ERROR_PATTERN.*($CONNECTION_PATTERN|$SQL_ERROR_PATTERN)" error.log
```

---

## 4. âš™ï¸ å‘Šè­¦é˜ˆå€¼è®¾ç½®ç­–ç•¥


### 4.1 é”™è¯¯é¢‘ç‡é˜ˆå€¼è®¾ç½®


**ä»€ä¹ˆæ˜¯é˜ˆå€¼**ï¼šé˜ˆå€¼å°±åƒä½“æ¸©è®¡ä¸Šçš„è­¦æˆ’çº¿ï¼Œè¶…è¿‡è¿™ä¸ªå€¼å°±è¯´æ˜æœ‰é—®é¢˜äº†ã€‚

```bash
#!/bin/bash
# error_threshold_monitor.sh

# å®šä¹‰é˜ˆå€¼é…ç½®
declare -A THRESHOLDS=(
    ["connection_errors_per_minute"]=5      # æ¯åˆ†é’Ÿè¿æ¥é”™è¯¯è¶…è¿‡5æ¬¡
    ["critical_errors_per_hour"]=1          # æ¯å°æ—¶ä¸¥é‡é”™è¯¯è¶…è¿‡1æ¬¡
    ["total_errors_per_hour"]=50            # æ¯å°æ—¶æ€»é”™è¯¯è¶…è¿‡50æ¬¡
    ["duplicate_errors_per_minute"]=3       # æ¯åˆ†é’Ÿé‡å¤é”™è¯¯è¶…è¿‡3æ¬¡
)

# æ£€æŸ¥é”™è¯¯é¢‘ç‡
check_error_frequency() {
    local timeframe=$1  # æ—¶é—´èŒƒå›´ï¼š1m, 5m, 1h
    local error_type=$2 # é”™è¯¯ç±»å‹
    
    # è·å–æŒ‡å®šæ—¶é—´å†…çš„é”™è¯¯æ•°é‡
    case $timeframe in
        "1m")
            count=$(tail -n 1000 /var/log/mysql/error.log | \
                   grep "$(date -d '1 minute ago' '+%Y-%m-%d %H:%M')" | \
                   grep -ci "$error_type")
            ;;
        "1h")
            count=$(tail -n 10000 /var/log/mysql/error.log | \
                   grep "$(date -d '1 hour ago' '+%Y-%m-%d %H')" | \
                   grep -ci "$error_type")
            ;;
    esac
    
    echo $count
}

# ç¤ºä¾‹ï¼šæ£€æŸ¥è¿æ¥é”™è¯¯é¢‘ç‡
connection_errors=$(check_error_frequency "1m" "connection")
if [ $connection_errors -gt ${THRESHOLDS["connection_errors_per_minute"]} ]; then
    echo "WARNING: Connection errors exceeded threshold: $connection_errors/min"
fi
```

### 4.2 åŸºäºä¸šåŠ¡æ—¶é—´çš„åŠ¨æ€é˜ˆå€¼


**ä¸ºä»€ä¹ˆéœ€è¦åŠ¨æ€é˜ˆå€¼**ï¼šä¸šåŠ¡é«˜å³°æœŸå’Œæ·±å¤œçš„é”™è¯¯å®¹å¿åº¦åº”è¯¥ä¸åŒï¼Œå°±åƒåŒ»ç”Ÿä¼šæ ¹æ®ç—…äººçš„å¹´é¾„è°ƒæ•´æ­£å¸¸æŒ‡æ ‡èŒƒå›´ä¸€æ ·ã€‚

```bash
# åŠ¨æ€é˜ˆå€¼é…ç½®
get_dynamic_threshold() {
    local error_type=$1
    local current_hour=$(date +%H)
    
    # æ ¹æ®æ—¶é—´æ®µè°ƒæ•´é˜ˆå€¼
    if [ $current_hour -ge 9 ] && [ $current_hour -le 18 ]; then
        # å·¥ä½œæ—¶é—´ï¼šé˜ˆå€¼è¾ƒä½ï¼Œæ›´æ•æ„Ÿ
        case $error_type in
            "connection") echo 3 ;;
            "slow_query") echo 10 ;;
        esac
    elif [ $current_hour -ge 19 ] && [ $current_hour -le 23 ]; then
        # æ™šé«˜å³°ï¼šé˜ˆå€¼é€‚ä¸­
        case $error_type in
            "connection") echo 5 ;;
            "slow_query") echo 20 ;;
        esac
    else
        # æ·±å¤œï¼šé˜ˆå€¼è¾ƒé«˜ï¼Œé¿å…è¯¯æŠ¥
        case $error_type in
            "connection") echo 10 ;;
            "slow_query") echo 50 ;;
        esac
    fi
}
```

---

## 5. ğŸ¤– è‡ªåŠ¨åŒ–åˆ†æè„šæœ¬å®è·µ


### 5.1 é”™è¯¯ç»Ÿè®¡åˆ†æè„šæœ¬


**è‡ªåŠ¨ç”Ÿæˆé”™è¯¯æŠ¥è¡¨**ï¼š
```bash
#!/bin/bash
# mysql_error_analyzer.sh

ERROR_LOG="/var/log/mysql/error.log"
REPORT_FILE="/tmp/mysql_error_report_$(date +%Y%m%d).txt"

# ç”Ÿæˆé”™è¯¯ç»Ÿè®¡æŠ¥å‘Š
generate_error_report() {
    echo "MySQLé”™è¯¯æ—¥å¿—åˆ†ææŠ¥å‘Š - $(date)" > "$REPORT_FILE"
    echo "================================================" >> "$REPORT_FILE"
    
    # 1. é”™è¯¯æ€»æ•°ç»Ÿè®¡
    echo -e "\nã€é”™è¯¯æ€»æ•°ç»Ÿè®¡ã€‘" >> "$REPORT_FILE"
    total_errors=$(grep -c "\[ERROR\]" "$ERROR_LOG")
    echo "æ€»é”™è¯¯æ•°: $total_errors" >> "$REPORT_FILE"
    
    # 2. æŒ‰é”™è¯¯ç±»å‹åˆ†ç±»ç»Ÿè®¡
    echo -e "\nã€é”™è¯¯ç±»å‹åˆ†æã€‘" >> "$REPORT_FILE"
    echo "è¿æ¥é”™è¯¯: $(grep -ci "connection" "$ERROR_LOG")" >> "$REPORT_FILE"
    echo "è®¿é—®æ‹’ç»: $(grep -ci "access denied" "$ERROR_LOG")" >> "$REPORT_FILE"
    echo "æ­»é”é”™è¯¯: $(grep -ci "deadlock" "$ERROR_LOG")" >> "$REPORT_FILE"
    echo "è¯­æ³•é”™è¯¯: $(grep -ci "syntax error" "$ERROR_LOG")" >> "$REPORT_FILE"
    
    # 3. æ—¶é—´åˆ†å¸ƒåˆ†æ
    echo -e "\nã€æ—¶é—´åˆ†å¸ƒåˆ†æã€‘" >> "$REPORT_FILE"
    echo "ä»Šæ—¥é”™è¯¯åˆ†å¸ƒ:" >> "$REPORT_FILE"
    for hour in {00..23}; do
        count=$(grep "$(date +%Y-%m-%d) $hour:" "$ERROR_LOG" | wc -l)
        if [ $count -gt 0 ]; then
            echo "$hour:00-$hour:59 -> $count ä¸ªé”™è¯¯" >> "$REPORT_FILE"
        fi
    done
    
    # 4. æœ€é¢‘ç¹çš„é”™è¯¯
    echo -e "\nã€æœ€é¢‘ç¹é”™è¯¯ Top5ã€‘" >> "$REPORT_FILE"
    grep "\[ERROR\]" "$ERROR_LOG" | \
    sed 's/.*\[ERROR\]//' | \
    sort | uniq -c | sort -nr | head -5 >> "$REPORT_FILE"
}

# æ‰§è¡Œåˆ†æ
generate_error_report
echo "æŠ¥å‘Šå·²ç”Ÿæˆ: $REPORT_FILE"
```

### 5.2 æ™ºèƒ½é”™è¯¯åˆ†ç±»è„šæœ¬


**è‡ªåŠ¨è¯†åˆ«é”™è¯¯æ¨¡å¼**ï¼š
```bash
#!/bin/bash
# intelligent_error_classifier.sh

# é”™è¯¯åˆ†ç±»å‡½æ•°
classify_error() {
    local error_line="$1"
    
    # æ•°æ®åº“è¿æ¥ç›¸å…³
    if echo "$error_line" | grep -qi "connection\|connect"; then
        echo "CONNECTION"
        return
    fi
    
    # æƒé™ç›¸å…³
    if echo "$error_line" | grep -qi "access denied\|permission"; then
        echo "PERMISSION"
        return
    fi
    
    # SQLè¯­æ³•ç›¸å…³
    if echo "$error_line" | grep -qi "syntax error\|sql"; then
        echo "SQL_SYNTAX"
        return
    fi
    
    # èµ„æºç›¸å…³
    if echo "$error_line" | grep -qi "memory\|disk\|space"; then
        echo "RESOURCE"
        return
    fi
    
    # æ€§èƒ½ç›¸å…³
    if echo "$error_line" | grep -qi "slow\|timeout\|deadlock"; then
        echo "PERFORMANCE"
        return
    fi
    
    # æœªåˆ†ç±»
    echo "UNKNOWN"
}

# å¤„ç†é”™è¯¯æ—¥å¿—
process_error_log() {
    while IFS= read -r line; do
        if echo "$line" | grep -q "\[ERROR\]"; then
            category=$(classify_error "$line")
            timestamp=$(echo "$line" | grep -o "^[0-9-]* [0-9:]*")
            echo "[$timestamp] [$category] $line"
        fi
    done < /var/log/mysql/error.log
}
```

---

## 6. ğŸ“ˆ ç›‘æ§Dashboardè®¾è®¡


### 6.1 æ ¸å¿ƒç›‘æ§æŒ‡æ ‡


**Dashboardå¿…å¤‡æŒ‡æ ‡**ï¼š

```
é”™è¯¯ç›‘æ§é¢æ¿è®¾è®¡:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MySQLé”™è¯¯æ—¥å¿—ç›‘æ§Dashboard                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“Š å®æ—¶çŠ¶æ€                                              â”‚
â”‚   ğŸŸ¢ æ­£å¸¸è¿è¡Œ  ğŸ”´ ä¸¥é‡é”™è¯¯  ğŸŸ¡ è­¦å‘Šä¿¡æ¯                    â”‚
â”‚                                                         â”‚
â”‚ ğŸ“ˆ é”™è¯¯è¶‹åŠ¿å›¾ (æœ€è¿‘24å°æ—¶)                                â”‚
â”‚   â”Œâ”€ERRORâ”€â”                                            â”‚
â”‚   â”‚   /\  â”‚  é”™è¯¯æ•°é‡éšæ—¶é—´å˜åŒ–                           â”‚
â”‚   â”‚  /  \ â”‚                                            â”‚
â”‚   â”‚ /    \â”‚                                            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚                                                         â”‚
â”‚ ğŸ·ï¸ é”™è¯¯åˆ†ç±»ç»Ÿè®¡                                          â”‚
â”‚   è¿æ¥é”™è¯¯: 45   æƒé™é”™è¯¯: 12   SQLé”™è¯¯: 8                â”‚
â”‚   æ€§èƒ½é—®é¢˜: 23   èµ„æºä¸è¶³: 5    å…¶ä»–: 15                  â”‚
â”‚                                                         â”‚
â”‚ âš ï¸ æœ€æ–°è­¦æŠ¥                                              â”‚
â”‚   [14:30] è¿æ¥æ•°æ¥è¿‘ä¸Šé™                                  â”‚
â”‚   [14:25] æ…¢æŸ¥è¯¢å¢å¤š                                     â”‚
â”‚   [14:20] ç£ç›˜ä½¿ç”¨ç‡85%                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 Grafana Dashboardé…ç½®


**åˆ›å»ºå¯è§†åŒ–é¢æ¿**ï¼š
```json
{
  "dashboard": {
    "title": "MySQLé”™è¯¯æ—¥å¿—ç›‘æ§",
    "panels": [
      {
        "title": "é”™è¯¯æ€»æ•°",
        "type": "stat",
        "targets": [
          {
            "expr": "mysql_error_total",
            "legendFormat": "æ€»é”™è¯¯æ•°"
          }
        ]
      },
      {
        "title": "é”™è¯¯è¶‹åŠ¿",
        "type": "graph",
        "targets": [
          {
            "expr": "rate(mysql_error_total[5m])",
            "legendFormat": "é”™è¯¯é¢‘ç‡/åˆ†é’Ÿ"
          }
        ]
      },
      {
        "title": "é”™è¯¯ç±»å‹åˆ†å¸ƒ",
        "type": "piechart",
        "targets": [
          {
            "expr": "mysql_error_by_type",
            "legendFormat": "{{error_type}}"
          }
        ]
      }
    ]
  }
}
```

---

## 7. ğŸ”„ é›†ä¸­åŒ–æ”¶é›†æ–¹æ¡ˆ


### 7.1 å¤šæœåŠ¡å™¨æ—¥å¿—æ”¶é›†æ¶æ„


**é›†ä¸­æ”¶é›†çš„å¥½å¤„**ï¼šå°±åƒæŠŠåˆ†æ•£åœ¨å„ä¸ªé—¨åº—çš„ç›‘æ§è§†é¢‘éƒ½æ±‡æ€»åˆ°æ€»éƒ¨ä¸€æ ·ï¼Œä¾¿äºç»Ÿä¸€ç®¡ç†å’Œåˆ†æã€‚

```
é›†ä¸­åŒ–æ—¥å¿—æ”¶é›†æ¶æ„:

MySQLæœåŠ¡å™¨1 â”€â”€â”
              â”‚
MySQLæœåŠ¡å™¨2 â”€â”€â”¼â”€â”€> æ—¥å¿—æ”¶é›†å™¨ â”€â”€> å­˜å‚¨é›†ç¾¤ â”€â”€> åˆ†æå¹³å°
              â”‚    (Fluentd)     (Elasticsearch)  (Kibana)
MySQLæœåŠ¡å™¨3 â”€â”€â”˜
```

### 7.2 ä½¿ç”¨Fluentdæ”¶é›†é…ç½®


**Fluentdé…ç½®æ–‡ä»¶**ï¼š
```ruby
# /etc/fluent/fluent.conf

# è¾“å…¥æºï¼šMySQLé”™è¯¯æ—¥å¿—
<source>
  @type tail
  path /var/log/mysql/error.log
  pos_file /var/log/fluentd/mysql-error.log.pos
  tag mysql.error
  format none
  read_from_head true
</source>

# è§£æé”™è¯¯æ—¥å¿—æ ¼å¼
<filter mysql.error>
  @type parser
  key_name message
  reserve_data true
  <parse>
    @type regexp
    expression /^(?<timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)\s+\d+\s+\[(?<level>\w+)\]\s+(?<message>.*)$/
    time_key timestamp
    time_format %Y-%m-%dT%H:%M:%S.%LZ
  </parse>
</filter>

# è¾“å‡ºåˆ°Elasticsearch
<match mysql.error>
  @type elasticsearch
  host elasticsearch.company.com
  port 9200
  index_name mysql-error-logs
  type_name error_log
  logstash_format true
  logstash_prefix mysql-error
</match>
```

### 7.3 ç®€åŒ–ç‰ˆrsyslogæ”¶é›†æ–¹æ¡ˆ


**é€‚åˆå°å‹ç¯å¢ƒçš„æ–¹æ¡ˆ**ï¼š
```bash
# åœ¨æ¯å°MySQLæœåŠ¡å™¨ä¸Šé…ç½®
echo "*.* $$log-server:514" >> /etc/rsyslog.conf

# åœ¨æ—¥å¿—æœåŠ¡å™¨ä¸Šé…ç½®æ¥æ”¶
cat >> /etc/rsyslog.conf << EOF
# å¯ç”¨UDPæ¥æ”¶
$ModLoad imudp
$UDPServerRun 514
$UDPServerAddress 0.0.0.0

# MySQLæ—¥å¿—å­˜å‚¨è§„åˆ™
:programname, isequal, "mysql" /var/log/centralized/mysql-all.log
& stop
EOF

# é‡å¯rsyslogæœåŠ¡
systemctl restart rsyslog
```

---

## 8. ğŸ” ELK Stackå®è·µåº”ç”¨


### 8.1 ELK Stackç®€ä»‹


**ä»€ä¹ˆæ˜¯ELK Stack**ï¼š
- **E**lasticsearchï¼šæœç´¢å¼•æ“ï¼Œåƒå›¾ä¹¦é¦†çš„ç´¢å¼•ç³»ç»Ÿ
- **L**ogstashï¼šæ—¥å¿—å¤„ç†å™¨ï¼Œåƒæ•°æ®æ¸…æ´—å·¥
- **K**ibanaï¼šå¯è§†åŒ–å·¥å…·ï¼Œåƒæ•°æ®åˆ†æå¸ˆçš„å›¾è¡¨å·¥å…·

### 8.2 Logstashé…ç½®å¤„ç†MySQLé”™è¯¯æ—¥å¿—


```ruby
# mysql-error.conf
input {
  file {
    path => "/var/log/mysql/error.log"
    start_position => "beginning"
    type => "mysql-error"
  }
}

filter {
  if [type] == "mysql-error" {
    # è§£æMySQLé”™è¯¯æ—¥å¿—æ ¼å¼
    grok {
      match => { 
        "message" => "%{TIMESTAMP_ISO8601:timestamp} %{NUMBER:thread_id} \[%{WORD:level}\] %{GREEDYDATA:error_message}"
      }
    }
    
    # è½¬æ¢æ—¶é—´æ ¼å¼
    date {
      match => [ "timestamp", "yyyy-MM-dd'T'HH:mm:ss.SSSSSSX" ]
    }
    
    # é”™è¯¯åˆ†ç±»
    if [error_message] =~ /connection|connect/ {
      mutate { add_field => { "error_category" => "connection" } }
    } else if [error_message] =~ /access denied|permission/ {
      mutate { add_field => { "error_category" => "permission" } }
    } else if [error_message] =~ /syntax error|sql/ {
      mutate { add_field => { "error_category" => "sql" } }
    } else {
      mutate { add_field => { "error_category" => "other" } }
    }
  }
}

output {
  elasticsearch {
    hosts => ["elasticsearch:9200"]
    index => "mysql-error-%{+YYYY.MM.dd}"
  }
}
```

### 8.3 Kibanaå¯è§†åŒ–é…ç½®


**åˆ›å»ºDashboardçš„æ­¥éª¤**ï¼š
1. **åˆ›å»ºç´¢å¼•æ¨¡å¼**ï¼š`mysql-error-*`
2. **è®¾è®¡å¯è§†åŒ–å›¾è¡¨**ï¼š
   - é”™è¯¯æ•°é‡è¶‹åŠ¿çº¿å›¾
   - é”™è¯¯çº§åˆ«é¥¼å›¾  
   - é”™è¯¯ç±»å‹æŸ±çŠ¶å›¾
   - æœ€æ–°é”™è¯¯åˆ—è¡¨

---

## 9. âš¡ Prometheusç›‘æ§é›†æˆ


### 9.1 MySQL Exporteré…ç½®


**å®‰è£…å’Œé…ç½®MySQL Exporter**ï¼š
```bash
# ä¸‹è½½MySQL Exporter
wget https://github.com/prometheus/mysqld_exporter/releases/download/v0.14.0/mysqld_exporter-0.14.0.linux-amd64.tar.gz

# è§£å‹å’Œå®‰è£…
tar xzf mysqld_exporter-0.14.0.linux-amd64.tar.gz
sudo mv mysqld_exporter-0.14.0.linux-amd64/mysqld_exporter /usr/local/bin/

# åˆ›å»ºMySQLç›‘æ§ç”¨æˆ·
mysql -u root -p << EOF
CREATE USER 'exporter'@'localhost' IDENTIFIED BY 'exporter_password';
GRANT PROCESS, REPLICATION CLIENT, SELECT ON *.* TO 'exporter'@'localhost';
FLUSH PRIVILEGES;
EOF

# é…ç½®æ–‡ä»¶
cat > /etc/mysql/mysqld_exporter.cnf << EOF
[client]
user=exporter
password=exporter_password
host=localhost
port=3306
EOF

# å¯åŠ¨Exporter
export DATA_SOURCE_NAME="exporter:exporter_password@(localhost:3306)/"
/usr/local/bin/mysqld_exporter --config.my-cnf=/etc/mysql/mysqld_exporter.cnf
```

### 9.2 è‡ªå®šä¹‰é”™è¯¯æ—¥å¿—æŒ‡æ ‡


**åˆ›å»ºé”™è¯¯è®¡æ•°æŒ‡æ ‡**ï¼š
```bash
#!/bin/bash
# mysql_error_metrics.sh

METRICS_FILE="/var/lib/prometheus/mysql_errors.prom"

# ç”ŸæˆPrometheusæ ¼å¼çš„æŒ‡æ ‡
generate_metrics() {
    echo "# HELP mysql_errors_total Total number of MySQL errors" > "$METRICS_FILE"
    echo "# TYPE mysql_errors_total counter" >> "$METRICS_FILE"
    
    # ç»Ÿè®¡å„ç±»é”™è¯¯
    connection_errors=$(grep -c "connection" /var/log/mysql/error.log)
    permission_errors=$(grep -c "access denied" /var/log/mysql/error.log)
    sql_errors=$(grep -c "syntax error" /var/log/mysql/error.log)
    
    echo "mysql_errors_total{type=\"connection\"} $connection_errors" >> "$METRICS_FILE"
    echo "mysql_errors_total{type=\"permission\"} $permission_errors" >> "$METRICS_FILE"
    echo "mysql_errors_total{type=\"sql\"} $sql_errors" >> "$METRICS_FILE"
}

# æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡
while true; do
    generate_metrics
    sleep 60
done
```

### 9.3 Prometheuså‘Šè­¦è§„åˆ™


```yaml
# mysql_error_alerts.yml
groups:
- name: mysql_errors
  rules:
  - alert: MySQLHighErrorRate
    expr: rate(mysql_errors_total[5m]) > 0.1
    for: 2m
    labels:
      severity: warning
    annotations:
      summary: "MySQL error rate is high"
      description: "MySQL error rate is {{ $value }} errors per second"
      
  - alert: MySQLConnectionErrors
    expr: mysql_errors_total{type="connection"} > 100
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "Too many MySQL connection errors"
      description: "MySQL has {{ $value }} connection errors"
```

---

## 10. ğŸ“± å‘Šè­¦é€šçŸ¥æœºåˆ¶


### 10.1 å¤šæ¸ é“å‘Šè­¦é…ç½®


**å‘Šè­¦é€šçŸ¥çš„é‡è¦æ€§**ï¼šå°±åƒç«è­¦æŠ¥è­¦å™¨ä¸€æ ·ï¼Œå‘ç°é—®é¢˜è¦ç«‹å³é€šçŸ¥ç›¸å…³äººå‘˜ã€‚

```bash
#!/bin/bash
# multi_channel_alert.sh

# å‘é€é‚®ä»¶å‘Šè­¦
send_email_alert() {
    local subject="$1"
    local message="$2"
    local priority="$3"
    
    # æ ¹æ®ä¼˜å…ˆçº§é€‰æ‹©æ”¶ä»¶äºº
    case $priority in
        "CRITICAL")
            recipients="dba@company.com,manager@company.com"
            ;;
        "HIGH")
            recipients="dba@company.com"
            ;;
        "MEDIUM")
            recipients="ops@company.com"
            ;;
    esac
    
    echo "$message" | mail -s "$subject" "$recipients"
}

# å‘é€çŸ­ä¿¡å‘Šè­¦ï¼ˆä½¿ç”¨APIï¼‰
send_sms_alert() {
    local message="$1"
    local phone_numbers="$2"
    
    # è°ƒç”¨çŸ­ä¿¡API
    curl -X POST "https://sms-api.company.com/send" \
         -H "Content-Type: application/json" \
         -d "{
           \"phones\": \"$phone_numbers\",
           \"message\": \"$message\"
         }"
}

# å‘é€ä¼ä¸šå¾®ä¿¡å‘Šè­¦
send_wechat_alert() {
    local message="$1"
    local webhook_url="$2"
    
    curl -X POST "$webhook_url" \
         -H "Content-Type: application/json" \
         -d "{
           \"msgtype\": \"text\",
           \"text\": {
             \"content\": \"$message\"
           }
         }"
}

# ç»Ÿä¸€å‘Šè­¦å‡½æ•°
send_alert() {
    local level="$1"
    local error_msg="$2"
    
    case $level in
        "CRITICAL")
            send_email_alert "MySQL Critical Error" "$error_msg" "CRITICAL"
            send_sms_alert "$error_msg" "13800138000,13900139000"
            send_wechat_alert "ğŸš¨ MySQLä¸¥é‡é”™è¯¯: $error_msg" "$WECHAT_WEBHOOK"
            ;;
        "HIGH")
            send_email_alert "MySQL High Priority Error" "$error_msg" "HIGH"
            send_wechat_alert "âš ï¸ MySQLé«˜ä¼˜å…ˆçº§é”™è¯¯: $error_msg" "$WECHAT_WEBHOOK"
            ;;
        "MEDIUM")
            send_email_alert "MySQL Warning" "$error_msg" "MEDIUM"
            ;;
    esac
}
```

### 10.2 å‘Šè­¦æŠ‘åˆ¶å’Œå»é‡


**é¿å…å‘Šè­¦é£æš´**ï¼š
```bash
#!/bin/bash
# alert_deduplication.sh

ALERT_STATE_FILE="/tmp/mysql_alert_state"
ALERT_COOLDOWN=300  # 5åˆ†é’Ÿå†·å´æœŸ

# æ£€æŸ¥æ˜¯å¦éœ€è¦å‘é€å‘Šè­¦
should_send_alert() {
    local error_hash="$1"
    local current_time=$(date +%s)
    
    # æ£€æŸ¥ä¸Šæ¬¡å‘Šè­¦æ—¶é—´
    if [ -f "$ALERT_STATE_FILE" ]; then
        last_alert_time=$(grep "^$error_hash:" "$ALERT_STATE_FILE" | cut -d: -f2)
        
        if [ -n "$last_alert_time" ]; then
            time_diff=$((current_time - last_alert_time))
            if [ $time_diff -lt $ALERT_COOLDOWN ]; then
                return 1  # åœ¨å†·å´æœŸå†…ï¼Œä¸å‘é€å‘Šè­¦
            fi
        fi
    fi
    
    # æ›´æ–°å‘Šè­¦çŠ¶æ€
    grep -v "^$error_hash:" "$ALERT_STATE_FILE" > "$ALERT_STATE_FILE.tmp" 2>/dev/null
    echo "$error_hash:$current_time" >> "$ALERT_STATE_FILE.tmp"
    mv "$ALERT_STATE_FILE.tmp" "$ALERT_STATE_FILE"
    
    return 0  # å¯ä»¥å‘é€å‘Šè­¦
}

# ä½¿ç”¨ç¤ºä¾‹
error_signature=$(echo "connection refused" | md5sum | cut -d' ' -f1)
if should_send_alert "$error_signature"; then
    send_alert "HIGH" "MySQL connection refused"
fi
```

---

## 11. ğŸš€ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


### 11.1 ç›‘æ§ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–


**é¿å…ç›‘æ§ç³»ç»Ÿå½±å“æ•°æ®åº“æ€§èƒ½**ï¼š

```bash
# ä¼˜åŒ–æ—¥å¿—è¯»å–æ€§èƒ½
optimize_log_reading() {
    # 1. ä½¿ç”¨inotifyè€Œä¸æ˜¯polling
    apt-get install inotify-tools
    
    # ç›‘æ§æ–‡ä»¶å˜åŒ–
    inotifywait -m -e modify /var/log/mysql/error.log | while read event; do
        # åªè¯»å–æ–°å¢çš„è¡Œ
        tail -n 10 /var/log/mysql/error.log | process_new_errors
    done
    
    # 2. è®¾ç½®åˆç†çš„æ—¥å¿—è½®è½¬
    # é¿å…å•ä¸ªæ—¥å¿—æ–‡ä»¶è¿‡å¤§
    logrotate -f /etc/logrotate.d/mysql
    
    # 3. é™åˆ¶ç›‘æ§è„šæœ¬çš„èµ„æºä½¿ç”¨
    # ä½¿ç”¨niceå‘½ä»¤é™ä½ä¼˜å…ˆçº§
    nice -n 10 ./mysql_monitor.sh
    
    # é™åˆ¶CPUä½¿ç”¨ç‡
    cpulimit -l 10 -p $(pgrep mysql_monitor)
}
```

### 11.2 å­˜å‚¨ä¼˜åŒ–ç­–ç•¥


```bash
# æ—¥å¿—å­˜å‚¨ä¼˜åŒ–é…ç½®
optimize_log_storage() {
    # 1. åˆ†ç¦»æ—¥å¿—å­˜å‚¨
    # å°†æ—¥å¿—å­˜å‚¨åˆ°ç‹¬ç«‹çš„ç£ç›˜åˆ†åŒº
    mkdir -p /var/log/mysql_archive
    
    # 2. ä½¿ç”¨å‹ç¼©å­˜å‚¨å†å²æ—¥å¿—
    find /var/log/mysql -name "*.log.1" -exec gzip {} \;
    
    # 3. è‡ªåŠ¨æ¸…ç†æ—§æ—¥å¿—
    find /var/log/mysql_archive -name "*.gz" -mtime +30 -delete
    
    # 4. ä½¿ç”¨é«˜æ€§èƒ½æ–‡ä»¶ç³»ç»Ÿ
    # ext4æˆ–xfsï¼Œå¯ç”¨noatimeé€‰é¡¹
    mount -o remount,noatime /var/log
}
```

### 11.3 ç½‘ç»œä¼˜åŒ–


```bash
# ä¼˜åŒ–æ—¥å¿—ä¼ è¾“æ€§èƒ½
optimize_log_transmission() {
    # 1. æ‰¹é‡å‘é€æ—¥å¿—
    # æ¯100è¡Œæˆ–æ¯10ç§’å‘é€ä¸€æ¬¡
    buffer_logs() {
        local buffer=""
        local count=0
        
        while IFS= read -r line; do
            buffer="$buffer\n$line"
            count=$((count + 1))
            
            if [ $count -ge 100 ]; then
                send_logs_batch "$buffer"
                buffer=""
                count=0
            fi
        done
    }
    
    # 2. å¯ç”¨å‹ç¼©ä¼ è¾“
    # ä½¿ç”¨gzipå‹ç¼©å‡å°‘ç½‘ç»œä¼ è¾“é‡
    cat error.log | gzip | curl -X POST \
        -H "Content-Encoding: gzip" \
        -H "Content-Type: application/octet-stream" \
        --data-binary @- \
        http://log-server/api/logs
}
```

---

## 12. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 12.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ ç›‘æ§ç›®æ ‡ï¼šå®æ—¶å‘ç°é—®é¢˜ï¼Œå¿«é€Ÿå“åº”ï¼Œé¿å…æ•…éšœæ‰©å¤§
ğŸ”¸ å…³é”®æŒ‡æ ‡ï¼šé”™è¯¯é¢‘ç‡ã€é”™è¯¯ç±»å‹ã€ä¸¥é‡ç¨‹åº¦ã€å½±å“èŒƒå›´
ğŸ”¸ å‘Šè­¦ç­–ç•¥ï¼šåˆ†çº§å‘Šè­¦ã€å¤šæ¸ é“é€šçŸ¥ã€å»é‡æœºåˆ¶ã€å†·å´æœŸè®¾ç½®
ğŸ”¸ å·¥å…·é€‰æ‹©ï¼šç®€å•åœºæ™¯ç”¨shellè„šæœ¬ï¼Œå¤æ‚åœºæ™¯ç”¨ELKæˆ–Prometheus
ğŸ”¸ æ€§èƒ½å¹³è¡¡ï¼šç›‘æ§ä¸èƒ½å½±å“æ•°æ®åº“æ€§èƒ½ï¼Œè¦åˆç†åˆ†é…èµ„æº
```

### 12.2 å…³é”®å®æ–½è¦ç‚¹


**ğŸ”¹ ç›‘æ§ç³»ç»Ÿè®¾è®¡åŸåˆ™**ï¼š
```
å‡†ç¡®æ€§ > æ€§èƒ½ > å¤æ‚åº¦
- å®å¯å¤šæŠ¥è­¦ä¹Ÿä¸èƒ½æ¼æŠ¥ä¸¥é‡é”™è¯¯
- ç›‘æ§ç³»ç»Ÿæœ¬èº«è¦ç¨³å®šå¯é 
- ä»ç®€å•å¼€å§‹ï¼Œé€æ­¥å®Œå–„
```

**ğŸ”¹ å‘Šè­¦è®¾ç½®ç­–ç•¥**ï¼š
```
åˆ†çº§å¤„ç†ï¼š
- ä¸¥é‡é”™è¯¯ï¼šç«‹å³çŸ­ä¿¡+ç”µè¯
- é‡è¦è­¦å‘Šï¼šé‚®ä»¶+ä¼ä¸šå¾®ä¿¡
- ä¸€èˆ¬ä¿¡æ¯ï¼šä»…è®°å½•æ—¥å¿—

æ—¶é—´è€ƒè™‘ï¼š
- å·¥ä½œæ—¶é—´ï¼šé˜ˆå€¼è¾ƒä½ï¼Œå¿«é€Ÿå“åº”
- éå·¥ä½œæ—¶é—´ï¼šé˜ˆå€¼é€‚ä¸­ï¼Œé¿å…è¯¯æ‰°
```

**ğŸ”¹ å·¥å…·é€‰æ‹©å»ºè®®**ï¼š
```
å°è§„æ¨¡ç¯å¢ƒï¼ˆ< 10å°æœåŠ¡å™¨ï¼‰ï¼š
â†’ shellè„šæœ¬ + rsyslog + ç®€å•Dashboard

ä¸­ç­‰è§„æ¨¡ï¼ˆ10-50å°æœåŠ¡å™¨ï¼‰ï¼š
â†’ Fluentd + Elasticsearch + Kibana

å¤§è§„æ¨¡ç¯å¢ƒï¼ˆ> 50å°æœåŠ¡å™¨ï¼‰ï¼š
â†’ Prometheus + Grafana + AlertManager
â†’ æˆ–è€…å•†ä¸šè§£å†³æ–¹æ¡ˆ
```

### 12.3 æœ€ä½³å®è·µå»ºè®®


**ğŸ¯ æ—¥å¸¸è¿ç»´è¦ç‚¹**ï¼š
- **å®šæœŸæ£€æŸ¥**ï¼šæ¯å‘¨æ£€æŸ¥ç›‘æ§ç³»ç»Ÿè¿è¡ŒçŠ¶æ€
- **é˜ˆå€¼è°ƒä¼˜**ï¼šæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´å‘Šè­¦é˜ˆå€¼
- **æ–‡æ¡£ç»´æŠ¤**ï¼šè®°å½•å‘Šè­¦å¤„ç†æµç¨‹å’Œè§£å†³æ–¹æ¡ˆ
- **å›¢é˜ŸåŸ¹è®­**ï¼šç¡®ä¿å›¢é˜Ÿæˆå‘˜ç†Ÿæ‚‰ç›‘æ§ç³»ç»Ÿ

**ğŸ’¡ æ•…éšœå¤„ç†æµç¨‹**ï¼š
```
æ”¶åˆ°å‘Šè­¦ â†’ ç¡®è®¤é—®é¢˜ â†’ è¯„ä¼°å½±å“ â†’ å¿«é€Ÿä¿®å¤ â†’ æ ¹å› åˆ†æ â†’ é¢„é˜²æªæ–½
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- ç›‘æ§ç³»ç»Ÿæ˜¯æ•°æ®åº“è¿ç»´çš„"çœ¼ç›"ï¼Œè¦ä¿è¯å…¶å‡†ç¡®å¯é 
- åˆç†çš„å‘Šè­¦ç­–ç•¥æ¯”å¤æ‚çš„å·¥å…·æ›´é‡è¦
- ä»ä¸šåŠ¡è§’åº¦è®¾è®¡ç›‘æ§ï¼Œå…³æ³¨ç”¨æˆ·æ„ŸçŸ¥çš„é—®é¢˜
- æŒç»­ä¼˜åŒ–å’Œæ”¹è¿›ï¼Œé¿å…ç›‘æ§ç³»ç»Ÿæˆä¸ºæ–°çš„è¿ç»´è´Ÿæ‹…