---
title: 7ã€MySQL Shell JavaScriptæ¨¡å¼ç¼–ç¨‹
---
## ğŸ“š ç›®å½•

1. [JavaScriptæ¨¡å¼åŸºç¡€æ¦‚å¿µ](#1-JavaScriptæ¨¡å¼åŸºç¡€æ¦‚å¿µ)
2. [å†…ç½®å¯¹è±¡è¯¦è§£](#2-å†…ç½®å¯¹è±¡è¯¦è§£)
3. [å˜é‡ä¸å‡½æ•°æ“ä½œ](#3-å˜é‡ä¸å‡½æ•°æ“ä½œ)
4. [æ§åˆ¶æµä¸å¼‚å¸¸å¤„ç†](#4-æ§åˆ¶æµä¸å¼‚å¸¸å¤„ç†)
5. [æ¨¡å—å¯¼å…¥ä¸ç®¡ç†](#5-æ¨¡å—å¯¼å…¥ä¸ç®¡ç†)
6. [å¼‚æ­¥æ“ä½œå¤„ç†](#6-å¼‚æ­¥æ“ä½œå¤„ç†)
7. [è°ƒè¯•æŠ€å·§ä¸æœ€ä½³å®è·µ](#7-è°ƒè¯•æŠ€å·§ä¸æœ€ä½³å®è·µ)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”§ JavaScriptæ¨¡å¼åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯MySQL Shell JavaScriptæ¨¡å¼


**æ ¸å¿ƒå®šä¹‰**ï¼šMySQL Shell JavaScriptæ¨¡å¼æ˜¯MySQL Shellæä¾›çš„ä¸€ç§äº¤äº’å¼ç¼–ç¨‹ç¯å¢ƒï¼Œå…è®¸ä½¿ç”¨JavaScriptè¯­æ³•æ¥æ“ä½œMySQLæ•°æ®åº“å’Œé›†ç¾¤ã€‚

```
MySQL Shellçš„ä¸‰ç§æ¨¡å¼ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    SQLæ¨¡å¼          â”‚ â† æ ‡å‡†SQLå‘½ä»¤
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  JavaScriptæ¨¡å¼     â”‚ â† JSè¯­æ³•æ“ä½œæ•°æ®åº“  
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Pythonæ¨¡å¼        â”‚ â† Pythonè¯­æ³•æ“ä½œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> ğŸ’¡ **é€šä¿—ç†è§£**ï¼šå°±åƒåœ¨æµè§ˆå™¨ä¸­å†™JavaScriptä¸€æ ·ï¼Œä½†è¿™é‡Œæ˜¯ä¸“é—¨ç”¨æ¥ç®¡ç†MySQLæ•°æ®åº“çš„JavaScriptç¯å¢ƒ

### 1.2 JavaScriptæ¨¡å¼çš„ç‹¬ç‰¹ç‰¹æ€§


**ğŸ¯ æ ¸å¿ƒç‰¹æ€§**ï¼š
- **åŸç”ŸJavaScriptè¯­æ³•**ï¼šæ”¯æŒES6+è¯­æ³•ç‰¹æ€§
- **å†…ç½®æ•°æ®åº“å¯¹è±¡**ï¼šsessionã€dbaã€clusterç­‰ä¸“ç”¨å¯¹è±¡
- **äº¤äº’å¼æ‰§è¡Œ**ï¼šå¯ä»¥é€è¡Œæ‰§è¡Œï¼Œä¹Ÿå¯ä»¥è¿è¡Œè„šæœ¬æ–‡ä»¶
- **ä¸°å¯Œçš„API**ï¼šä¸“é—¨ä¸ºæ•°æ®åº“æ“ä½œè®¾è®¡çš„å‡½æ•°åº“

**ğŸ’¡ ä¸ºä»€ä¹ˆè¦ç”¨JavaScriptæ¨¡å¼**ï¼š
```
ä¼ ç»ŸSQLçš„é™åˆ¶ï¼š
â€¢ åªèƒ½æ‰§è¡Œå•ä¸ªSQLè¯­å¥
â€¢ ç¼ºä¹ç¼–ç¨‹é€»è¾‘æ§åˆ¶
â€¢ éš¾ä»¥å¤„ç†å¤æ‚ä¸šåŠ¡åœºæ™¯

JavaScriptæ¨¡å¼çš„ä¼˜åŠ¿ï¼š
â€¢ å¯ä»¥å†™å¤æ‚çš„ç¨‹åºé€»è¾‘
â€¢ æ”¯æŒå˜é‡ã€å‡½æ•°ã€å¾ªç¯ç­‰
â€¢ å†…ç½®æ•°æ®åº“æ“ä½œAPI
â€¢ æ›´å¥½çš„é”™è¯¯å¤„ç†æœºåˆ¶
```

### 1.3 æ¨¡å¼åˆ‡æ¢ä¸åŸºæœ¬ä½¿ç”¨


**åˆ‡æ¢åˆ°JavaScriptæ¨¡å¼**ï¼š
```javascript
// åœ¨MySQL Shellä¸­åˆ‡æ¢æ¨¡å¼
\js                    // åˆ‡æ¢åˆ°JavaScriptæ¨¡å¼
\sql                   // åˆ‡æ¢åˆ°SQLæ¨¡å¼  
\py                    // åˆ‡æ¢åˆ°Pythonæ¨¡å¼

// æŸ¥çœ‹å½“å‰æ¨¡å¼
\status
```

**åŸºæœ¬è¯­æ³•éªŒè¯**ï¼š
```javascript
// åŸºæœ¬å˜é‡æ“ä½œ
var userName = "admin";
let dbPort = 3306;
const maxConnections = 1000;

// è¾“å‡ºå†…å®¹
print("Hello MySQL Shell!");
println("ç”¨æˆ·å: " + userName);

// åŸºæœ¬æ•°å­¦è¿ç®—
let result = 10 + 20;
print("è®¡ç®—ç»“æœ: " + result);
```

---

## 2. ğŸ—ï¸ å†…ç½®å¯¹è±¡è¯¦è§£


### 2.1 æ ¸å¿ƒå†…ç½®å¯¹è±¡æ¦‚è§ˆ


**ğŸ”¸ ä¸»è¦å†…ç½®å¯¹è±¡**ï¼š
```
å†…ç½®å¯¹è±¡ä½“ç³»ï¼š
session â”€â”€â”
          â”œâ”€â”€ æ•°æ®åº“è¿æ¥å’ŒåŸºæœ¬æ“ä½œ
          â””â”€â”€ SQLæ‰§è¡Œå’Œç»“æœå¤„ç†

dba â”€â”€â”€â”€â”€â”€â”  
          â”œâ”€â”€ æ•°æ®åº“ç®¡ç†å‘˜åŠŸèƒ½
          â””â”€â”€ é›†ç¾¤ç®¡ç†å’Œé…ç½®

cluster â”€â”€â”
          â”œâ”€â”€ InnoDB Clusteræ“ä½œ
          â””â”€â”€ èŠ‚ç‚¹ç®¡ç†å’Œç›‘æ§

shell â”€â”€â”€â”€â”
          â”œâ”€â”€ Shellç¯å¢ƒæ§åˆ¶
          â””â”€â”€ å·¥å…·å‡½æ•°å’Œé…ç½®
```

### 2.2 sessionå¯¹è±¡è¯¦è§£


**ğŸ”¸ ä»€ä¹ˆæ˜¯sessionå¯¹è±¡**ï¼š
> sessionå¯¹è±¡ä»£è¡¨ä¸MySQLæœåŠ¡å™¨çš„ä¸€ä¸ªè¿æ¥ä¼šè¯ï¼Œé€šè¿‡å®ƒå¯ä»¥æ‰§è¡ŒSQLè¯­å¥ã€ç®¡ç†äº‹åŠ¡ç­‰åŸºæœ¬æ•°æ®åº“æ“ä½œã€‚

**è¿æ¥å»ºç«‹**ï¼š
```javascript
// å»ºç«‹æ•°æ®åº“è¿æ¥
session = mysql.getSession('root@localhost:3306');

// æˆ–è€…ä½¿ç”¨å®Œæ•´è¿æ¥å­—ç¬¦ä¸²
session = mysql.getSession('mysql://root:password@localhost:3306');

// æ£€æŸ¥è¿æ¥çŠ¶æ€
if (session.isOpen()) {
    print("æ•°æ®åº“è¿æ¥æˆåŠŸ!");
} else {
    print("è¿æ¥å¤±è´¥!");
}
```

**åŸºæœ¬SQLæ‰§è¡Œ**ï¼š
```javascript
// æ‰§è¡ŒæŸ¥è¯¢è¯­å¥
var result = session.sql("SELECT * FROM users LIMIT 5").execute();

// å¤„ç†æŸ¥è¯¢ç»“æœ
var rows = result.fetchAll();
for (let row of rows) {
    print("ç”¨æˆ·ID: " + row[0] + ", ç”¨æˆ·å: " + row[1]);
}

// æ‰§è¡Œæ›´æ–°è¯­å¥
session.sql("UPDATE users SET status = 'active' WHERE id = 1").execute();
print("æ›´æ–°å®Œæˆ!");
```

### 2.3 dbaå¯¹è±¡è¯¦è§£


**ğŸ”¸ ä»€ä¹ˆæ˜¯dbaå¯¹è±¡**ï¼š
> dbaå¯¹è±¡æä¾›æ•°æ®åº“ç®¡ç†å‘˜çº§åˆ«çš„åŠŸèƒ½ï¼Œä¸»è¦ç”¨äºé›†ç¾¤ç®¡ç†ã€é…ç½®æ£€æŸ¥ã€å¤‡ä»½æ¢å¤ç­‰é«˜çº§æ“ä½œã€‚

**é›†ç¾¤çŠ¶æ€æ£€æŸ¥**ï¼š
```javascript
// æ£€æŸ¥å®ä¾‹æ˜¯å¦é€‚åˆåŠ å…¥é›†ç¾¤
dba.checkInstanceConfiguration('root@localhost:3306');

// é…ç½®å®ä¾‹
dba.configureInstance('root@localhost:3306');

// åˆ›å»ºé›†ç¾¤
var cluster = dba.createCluster('myCluster');
```

**å®ç”¨ç®¡ç†åŠŸèƒ½**ï¼š
```javascript
// è·å–é›†ç¾¤å¯¹è±¡
var cluster = dba.getCluster();

// æŸ¥çœ‹é›†ç¾¤çŠ¶æ€
cluster.status();

// æ·»åŠ å®ä¾‹åˆ°é›†ç¾¤
cluster.addInstance('root@server2:3306');

// åˆ é™¤å®ä¾‹
cluster.removeInstance('root@server2:3306');
```

### 2.4 shellå¯¹è±¡åŠŸèƒ½


**ğŸ”¸ ç¯å¢ƒæ§åˆ¶åŠŸèƒ½**ï¼š
```javascript
// è·å–Shellé€‰é¡¹
shell.options;

// è®¾ç½®è¾“å‡ºæ ¼å¼
shell.options.outputFormat = "json";

// è¿æ¥åˆ°æ•°æ®åº“
shell.connect('root@localhost:3306');

// æ‰§è¡Œå¤–éƒ¨å‘½ä»¤
shell.execute('ls -la');
```

---

## 3. ğŸ“ å˜é‡ä¸å‡½æ•°æ“ä½œ


### 3.1 å˜é‡å®šä¹‰ä¸ä½œç”¨åŸŸ


**ğŸ”¸ å˜é‡å£°æ˜æ–¹å¼**ï¼š
```javascript
// ä¸‰ç§å˜é‡å£°æ˜æ–¹å¼
var globalVar = "å…¨å±€å˜é‡";        // å‡½æ•°ä½œç”¨åŸŸ
let blockVar = "å—ä½œç”¨åŸŸå˜é‡";      // å—ä½œç”¨åŸŸ  
const constVar = "å¸¸é‡";           // å—ä½œç”¨åŸŸï¼Œä¸å¯ä¿®æ”¹

// æ•°æ®ç±»å‹ç¤ºä¾‹
var number = 42;                   // æ•°å­—
var string = "Hello MySQL";        // å­—ç¬¦ä¸²
var boolean = true;                // å¸ƒå°”å€¼
var array = [1, 2, 3, 4];         // æ•°ç»„
var object = {name: "å¼ ä¸‰", age: 25}; // å¯¹è±¡
```

**ä½œç”¨åŸŸæ¼”ç¤º**ï¼š
```javascript
function testScope() {
    var functionVar = "å‡½æ•°å†…å˜é‡";
    
    if (true) {
        let blockVar = "å—çº§å˜é‡";
        const blockConst = "å—çº§å¸¸é‡";
        
        print(functionVar);    // å¯ä»¥è®¿é—®
        print(blockVar);       // å¯ä»¥è®¿é—®
    }
    
    // print(blockVar);       // é”™è¯¯ï¼æ— æ³•è®¿é—®å—çº§å˜é‡
}
```

### 3.2 å‡½æ•°å®šä¹‰ä¸è°ƒç”¨


**ğŸ”¸ å‡½æ•°å£°æ˜æ–¹å¼**ï¼š
```javascript
// æ™®é€šå‡½æ•°å£°æ˜
function connectToDatabase(host, port, user) {
    print("è¿æ¥åˆ°: " + host + ":" + port);
    try {
        var session = mysql.getSession(user + '@' + host + ':' + port);
        return session;
    } catch (error) {
        print("è¿æ¥å¤±è´¥: " + error.message);
        return null;
    }
}

// ç®­å¤´å‡½æ•°ï¼ˆæ¨èç”¨äºç®€å•æ“ä½œï¼‰
const getUserCount = (tableName) => {
    var result = session.sql(`SELECT COUNT(*) FROM ${tableName}`).execute();
    return result.fetchOne()[0];
};

// åŒ¿åå‡½æ•°
var formatOutput = function(data) {
    return JSON.stringify(data, null, 2);
};
```

**å‡½æ•°è°ƒç”¨ç¤ºä¾‹**ï¼š
```javascript
// è°ƒç”¨è‡ªå®šä¹‰å‡½æ•°
var mySession = connectToDatabase("localhost", 3306, "root");

if (mySession) {
    // ä½¿ç”¨ç®­å¤´å‡½æ•°
    var userCount = getUserCount("users");
    print("ç”¨æˆ·æ€»æ•°: " + userCount);
    
    // ä½¿ç”¨åŒ¿åå‡½æ•°
    var userData = {name: "å¼ ä¸‰", count: userCount};
    print(formatOutput(userData));
}
```

### 3.3 å®ç”¨å·¥å…·å‡½æ•°


**æ•°æ®åº“æ“ä½œå°è£…**ï¼š
```javascript
// æ‰§è¡ŒæŸ¥è¯¢å¹¶è¿”å›ç»“æœ
function queryData(sql, params = []) {
    try {
        var stmt = session.sql(sql);
        
        // ç»‘å®šå‚æ•°
        if (params.length > 0) {
            stmt = stmt.bind(params);
        }
        
        var result = stmt.execute();
        return result.fetchAll();
    } catch (error) {
        print("æŸ¥è¯¢å¤±è´¥: " + error.message);
        return [];
    }
}

// æ‰¹é‡æ’å…¥æ•°æ®
function batchInsert(tableName, dataArray) {
    session.startTransaction();
    
    try {
        for (let data of dataArray) {
            var sql = `INSERT INTO ${tableName} (name, email) VALUES (?, ?)`;
            session.sql(sql).bind([data.name, data.email]).execute();
        }
        
        session.commit();
        print(`æˆåŠŸæ’å…¥ ${dataArray.length} æ¡è®°å½•`);
        
    } catch (error) {
        session.rollback();
        print("æ’å…¥å¤±è´¥ï¼Œå·²å›æ»š: " + error.message);
    }
}
```

---

## 4. ğŸ”„ æ§åˆ¶æµä¸å¼‚å¸¸å¤„ç†


### 4.1 æ¡ä»¶æ§åˆ¶è¯­å¥


**ğŸ”¸ if/elseæ¡ä»¶åˆ¤æ–­**ï¼š
```javascript
// æ£€æŸ¥æ•°æ®åº“è¿æ¥çŠ¶æ€
function checkDatabaseHealth() {
    if (session && session.isOpen()) {
        print("âœ… æ•°æ®åº“è¿æ¥æ­£å¸¸");
        
        // æ£€æŸ¥ç”¨æˆ·æ•°é‡
        var userCount = session.sql("SELECT COUNT(*) FROM users").execute().fetchOne()[0];
        
        if (userCount > 1000) {
            print("âš ï¸ ç”¨æˆ·æ•°é‡è¾ƒå¤šï¼Œå»ºè®®ä¼˜åŒ–æŸ¥è¯¢");
        } else if (userCount > 100) {
            print("ğŸ“Š ç”¨æˆ·æ•°é‡é€‚ä¸­");
        } else {
            print("ğŸ“ˆ ç”¨æˆ·æ•°é‡è¾ƒå°‘");
        }
        
    } else {
        print("âŒ æ•°æ®åº“è¿æ¥å¼‚å¸¸");
        return false;
    }
    return true;
}
```

**switchè¯­å¥ç¤ºä¾‹**ï¼š
```javascript
// æ ¹æ®ç”¨æˆ·è§’è‰²æ‰§è¡Œä¸åŒæ“ä½œ
function handleUserRole(role) {
    switch (role.toLowerCase()) {
        case 'admin':
            print("ğŸ”§ æ‰§è¡Œç®¡ç†å‘˜æ“ä½œ");
            // æ‰§è¡Œç®¡ç†å‘˜æƒé™çš„æ•°æ®åº“æ“ä½œ
            break;
            
        case 'user':
            print("ğŸ‘¤ æ‰§è¡Œæ™®é€šç”¨æˆ·æ“ä½œ");
            // æ‰§è¡Œæ™®é€šç”¨æˆ·æƒé™çš„æ“ä½œ
            break;
            
        case 'guest':
            print("ğŸ‘ï¸ æ‰§è¡Œè®¿å®¢æ“ä½œ");
            // åªè¯»æ“ä½œ
            break;
            
        default:
            print("â“ æœªçŸ¥è§’è‰²: " + role);
    }
}
```

### 4.2 å¾ªç¯æ§åˆ¶è¯­å¥


**ğŸ”¸ forå¾ªç¯å¤„ç†æ•°æ®**ï¼š
```javascript
// å¤„ç†ç”¨æˆ·æ•°æ®
function processUsers() {
    var users = session.sql("SELECT id, name, status FROM users").execute().fetchAll();
    
    // ä¼ ç»Ÿforå¾ªç¯
    for (var i = 0; i < users.length; i++) {
        var user = users[i];
        print(`å¤„ç†ç”¨æˆ· ${i+1}: ID=${user[0]}, å§“å=${user[1]}, çŠ¶æ€=${user[2]}`);
    }
    
    // for...ofå¾ªç¯ï¼ˆæ¨èï¼‰
    var activeCount = 0;
    for (let user of users) {
        if (user[2] === 'active') {
            activeCount++;
        }
    }
    
    print(`æ´»è·ƒç”¨æˆ·æ•°é‡: ${activeCount}`);
}
```

**whileå¾ªç¯ç¤ºä¾‹**ï¼š
```javascript
// ç›‘æ§æ•°æ®åº“è¿æ¥çŠ¶æ€
function monitorConnection() {
    var attempts = 0;
    var maxAttempts = 5;
    
    while (attempts < maxAttempts) {
        try {
            if (session.isOpen()) {
                print("âœ… è¿æ¥æ­£å¸¸");
                break;
            }
        } catch (error) {
            attempts++;
            print(`âŒ è¿æ¥å¤±è´¥ï¼Œé‡è¯•ç¬¬ ${attempts} æ¬¡`);
            
            if (attempts < maxAttempts) {
                // ç­‰å¾…2ç§’å†é‡è¯•
                shell.sleep(2);
            }
        }
    }
    
    if (attempts === maxAttempts) {
        print("ğŸš¨ è¿æ¥å¤±è´¥ï¼Œå·²è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°");
    }
}
```

### 4.3 å¼‚å¸¸å¤„ç†æœºåˆ¶


**ğŸ”¸ try/catchåŸºæœ¬ç”¨æ³•**ï¼š
```javascript
// å®‰å…¨çš„æ•°æ®åº“æ“ä½œ
function safeQueryExecution(sql) {
    try {
        print("ğŸ“ æ‰§è¡ŒSQL: " + sql);
        
        var result = session.sql(sql).execute();
        var rows = result.fetchAll();
        
        print("âœ… æŸ¥è¯¢æˆåŠŸï¼Œè¿”å› " + rows.length + " æ¡è®°å½•");
        return rows;
        
    } catch (error) {
        // è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å¤„ç†
        print("âŒ æŸ¥è¯¢å¤±è´¥:");
        print("   é”™è¯¯ç±»å‹: " + error.type);
        print("   é”™è¯¯æ¶ˆæ¯: " + error.message);
        print("   é”™è¯¯ä»£ç : " + error.code);
        
        return [];
        
    } finally {
        // æ— è®ºæˆåŠŸå¤±è´¥éƒ½ä¼šæ‰§è¡Œ
        print("ğŸ”„ æŸ¥è¯¢æ“ä½œå®Œæˆ");
    }
}
```

**é«˜çº§å¼‚å¸¸å¤„ç†**ï¼š
```javascript
// äº‹åŠ¡å¤„ç†withå¼‚å¸¸å¤„ç†
function safeTransaction(operations) {
    try {
        session.startTransaction();
        print("ğŸš€ å¼€å§‹äº‹åŠ¡å¤„ç†");
        
        // æ‰§è¡Œå¤šä¸ªæ“ä½œ
        for (let operation of operations) {
            try {
                session.sql(operation.sql).bind(operation.params || []).execute();
                print("âœ… " + operation.description + " - æˆåŠŸ");
            } catch (opError) {
                print("âŒ " + operation.description + " - å¤±è´¥: " + opError.message);
                throw opError; // é‡æ–°æŠ›å‡ºé”™è¯¯ï¼Œè§¦å‘äº‹åŠ¡å›æ»š
            }
        }
        
        session.commit();
        print("ğŸ‰ äº‹åŠ¡æäº¤æˆåŠŸ");
        
    } catch (error) {
        session.rollback();
        print("ğŸ”„ äº‹åŠ¡å›æ»š: " + error.message);
        throw error; // å¯ä»¥é€‰æ‹©æ˜¯å¦é‡æ–°æŠ›å‡º
        
    } finally {
        print("ğŸ“Š äº‹åŠ¡å¤„ç†ç»“æŸ");
    }
}
```

---

## 5. ğŸ“¦ æ¨¡å—å¯¼å…¥ä¸ç®¡ç†


### 5.1 æ¨¡å—ç³»ç»Ÿæ¦‚è¿°


**ğŸ”¸ ä»€ä¹ˆæ˜¯æ¨¡å—ç³»ç»Ÿ**ï¼š
> MySQL Shellçš„æ¨¡å—ç³»ç»Ÿå…è®¸ä½ å°†ä»£ç ç»„ç»‡æˆå¯é‡ç”¨çš„æ¨¡å—ï¼Œå°±åƒNode.jsçš„requireç³»ç»Ÿä¸€æ ·ï¼Œå¯ä»¥å¯¼å…¥å¤–éƒ¨JavaScriptæ–‡ä»¶å’Œå†…ç½®æ¨¡å—ã€‚

**æ¨¡å—ç±»å‹**ï¼š
```
æ¨¡å—åˆ†ç±»ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å†…ç½®æ¨¡å—          â”‚ â† mysql, mysqlxç­‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ç”¨æˆ·è‡ªå®šä¹‰æ¨¡å—    â”‚ â† è‡ªå·±ç¼–å†™çš„.jsæ–‡ä»¶
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ç¬¬ä¸‰æ–¹æ¨¡å—        â”‚ â† ç¤¾åŒºæä¾›çš„æ¨¡å—
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 å†…ç½®æ¨¡å—ä½¿ç”¨


**ğŸ”¸ mysqlæ¨¡å—ä½¿ç”¨**ï¼š
```javascript
// å¯¼å…¥mysqlæ¨¡å—
const mysql = require('mysql');

// ä½¿ç”¨ç»å…¸MySQLåè®®è¿æ¥
var classicSession = mysql.getClassicSession('root@localhost:3306');

// æ‰§è¡ŒæŸ¥è¯¢
var result = classicSession.runSql("SELECT VERSION()");
var row = result.fetchOne();
print("MySQLç‰ˆæœ¬: " + row[0]);

// å…³é—­è¿æ¥
classicSession.close();
```

**mysqlxæ¨¡å—ä½¿ç”¨**ï¼š
```javascript
// å¯¼å…¥mysqlxæ¨¡å—ï¼ˆXåè®®ï¼‰
const mysqlx = require('mysqlx');

// ä½¿ç”¨Xåè®®è¿æ¥
var xSession = mysqlx.getSession('root@localhost:33060');

// è·å–schema
var schema = xSession.getSchema('test');

// ä½¿ç”¨Collection APIæ“ä½œJSONæ–‡æ¡£
var collection = schema.getCollection('users');

// æ’å…¥JSONæ–‡æ¡£
collection.add({
    name: "å¼ ä¸‰",
    age: 25,
    email: "zhangsan@example.com"
}).execute();

print("JSONæ–‡æ¡£æ’å…¥æˆåŠŸ");
```

### 5.3 è‡ªå®šä¹‰æ¨¡å—åˆ›å»º


**ğŸ”¸ åˆ›å»ºæ•°æ®åº“å·¥å…·æ¨¡å—**ï¼š

åˆ›å»ºæ–‡ä»¶ `dbUtils.js`ï¼š
```javascript
// dbUtils.js - æ•°æ®åº“å·¥å…·æ¨¡å—

// å¯¼å‡ºçš„å·¥å…·å‡½æ•°
var dbUtils = {
    // å»ºç«‹è¿æ¥
    connect: function(connectionString) {
        try {
            var session = mysql.getSession(connectionString);
            print("âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ");
            return session;
        } catch (error) {
            print("âŒ è¿æ¥å¤±è´¥: " + error.message);
            return null;
        }
    },
    
    // å®‰å…¨æŸ¥è¯¢
    safeQuery: function(session, sql, params = []) {
        try {
            var stmt = session.sql(sql);
            if (params.length > 0) {
                stmt = stmt.bind(params);
            }
            return stmt.execute().fetchAll();
        } catch (error) {
            print("æŸ¥è¯¢å¤±è´¥: " + error.message);
            return [];
        }
    },
    
    // è¡¨æ ¼å¼è¾“å‡º
    printTable: function(data, headers = []) {
        if (data.length === 0) {
            print("ğŸ“­ æ²¡æœ‰æ•°æ®");
            return;
        }
        
        // ç®€å•çš„è¡¨æ ¼è¾“å‡º
        if (headers.length > 0) {
            print(headers.join("\t"));
            print("-".repeat(50));
        }
        
        for (let row of data) {
            print(row.join("\t"));
        }
    }
};

// å¯¼å‡ºæ¨¡å—
module.exports = dbUtils;
```

**ä½¿ç”¨è‡ªå®šä¹‰æ¨¡å—**ï¼š
```javascript
// å¯¼å…¥è‡ªå®šä¹‰æ¨¡å—
var dbUtils = require('./dbUtils.js');

// ä½¿ç”¨æ¨¡å—åŠŸèƒ½
var session = dbUtils.connect('root@localhost:3306');

if (session) {
    // æŸ¥è¯¢ç”¨æˆ·æ•°æ®
    var users = dbUtils.safeQuery(session, "SELECT id, name, email FROM users LIMIT 5");
    
    // æ ¼å¼åŒ–è¾“å‡º
    dbUtils.printTable(users, ["ID", "å§“å", "é‚®ç®±"]);
}
```

### 5.4 æ¨¡å—è·¯å¾„ç®¡ç†


**ğŸ”¸ æ¨¡å—æœç´¢è·¯å¾„**ï¼š
```javascript
// æŸ¥çœ‹æ¨¡å—æœç´¢è·¯å¾„
print("æ¨¡å—æœç´¢è·¯å¾„:");
for (let path of __module_paths__) {
    print("  " + path);
}

// æ·»åŠ è‡ªå®šä¹‰æ¨¡å—è·¯å¾„
__module_paths__.push("/path/to/my/modules");

// ç›¸å¯¹è·¯å¾„å¯¼å…¥
var myUtil = require('./utils/myUtil.js');      // ç›¸å¯¹å½“å‰ç›®å½•
var dbHelper = require('../helpers/db.js');     // ä¸Šçº§ç›®å½•

// ç»å¯¹è·¯å¾„å¯¼å…¥
var globalUtil = require('/opt/mysql-shell/modules/globalUtil.js');
```

---

## 6. âš¡ å¼‚æ­¥æ“ä½œå¤„ç†


### 6.1 å¼‚æ­¥æ“ä½œåŸºç¡€æ¦‚å¿µ


**ğŸ”¸ ä»€ä¹ˆæ˜¯å¼‚æ­¥æ“ä½œ**ï¼š
> å¼‚æ­¥æ“ä½œæ˜¯æŒ‡ä¸ä¼šç«‹å³å®Œæˆçš„æ“ä½œï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å†™ã€æ•°æ®åº“æŸ¥è¯¢ç­‰ã€‚åœ¨MySQL Shellä¸­ï¼ŒæŸäº›å¤æ‚çš„æ•°æ®åº“æ“ä½œå¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´å®Œæˆã€‚

**åŒæ­¥vså¼‚æ­¥å¯¹æ¯”**ï¼š
```
åŒæ­¥æ“ä½œæµç¨‹ï¼š
æ“ä½œ1 â”€â”€â†’ ç­‰å¾…å®Œæˆ â”€â”€â†’ æ“ä½œ2 â”€â”€â†’ ç­‰å¾…å®Œæˆ â”€â”€â†’ æ“ä½œ3

å¼‚æ­¥æ“ä½œæµç¨‹ï¼š
æ“ä½œ1 â”€â”€â†’ ç»§ç»­æ‰§è¡Œå…¶ä»–ä»£ç 
æ“ä½œ2 â”€â”€â†’ ç»§ç»­æ‰§è¡Œå…¶ä»–ä»£ç   
æ“ä½œ3 â”€â”€â†’ ç­‰å¾…æ‰€æœ‰æ“ä½œå®Œæˆåå¤„ç†ç»“æœ
```

### 6.2 PromiseåŸºç¡€ä½¿ç”¨


**ğŸ”¸ Promiseæ¦‚å¿µ**ï¼š
> Promiseæ˜¯JavaScriptä¸­å¤„ç†å¼‚æ­¥æ“ä½œçš„ä¸€ç§æ–¹å¼ï¼Œå®ƒä»£è¡¨ä¸€ä¸ªå¯èƒ½ç°åœ¨ã€å°†æ¥æˆ–æ°¸è¿œä¸ä¼šå®Œæˆçš„æ“ä½œçš„ç»“æœã€‚

```javascript
// åˆ›å»ºä¸€ä¸ªPromise
function asyncDatabaseOperation() {
    return new Promise((resolve, reject) => {
        try {
            // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ
            var result = session.sql("SELECT * FROM large_table").execute();
            var data = result.fetchAll();
            
            // æ“ä½œæˆåŠŸ
            resolve(data);
            
        } catch (error) {
            // æ“ä½œå¤±è´¥
            reject(error);
        }
    });
}

// ä½¿ç”¨Promise
asyncDatabaseOperation()
    .then(function(data) {
        print("âœ… æ“ä½œæˆåŠŸï¼Œè·å¾— " + data.length + " æ¡è®°å½•");
        return data;
    })
    .catch(function(error) {
        print("âŒ æ“ä½œå¤±è´¥: " + error.message);
    })
    .finally(function() {
        print("ğŸ”„ å¼‚æ­¥æ“ä½œå®Œæˆ");
    });
```

### 6.3 å¤šä¸ªå¼‚æ­¥æ“ä½œå¤„ç†


**å¹¶è¡Œæ‰§è¡Œå¤šä¸ªæ“ä½œ**ï¼š
```javascript
// åŒæ—¶æŸ¥è¯¢å¤šä¸ªè¡¨çš„æ•°æ®
function queryMultipleTables() {
    var queries = [
        session.sql("SELECT COUNT(*) FROM users"),
        session.sql("SELECT COUNT(*) FROM orders"), 
        session.sql("SELECT COUNT(*) FROM products")
    ];
    
    // åˆ›å»ºPromiseæ•°ç»„
    var promises = queries.map(function(query, index) {
        return new Promise((resolve, reject) => {
            try {
                var result = query.execute();
                var count = result.fetchOne()[0];
                resolve({
                    table: ['users', 'orders', 'products'][index],
                    count: count
                });
            } catch (error) {
                reject(error);
            }
        });
    });
    
    // ç­‰å¾…æ‰€æœ‰Promiseå®Œæˆ
    Promise.all(promises)
        .then(function(results) {
            print("ğŸ“Š æ•°æ®åº“ç»Ÿè®¡ä¿¡æ¯:");
            for (let result of results) {
                print(`  ${result.table}: ${result.count} æ¡è®°å½•`);
            }
        })
        .catch(function(error) {
            print("âŒ æŸ¥è¯¢å¤±è´¥: " + error.message);
        });
}
```

### 6.4 å®é™…åº”ç”¨åœºæ™¯


**ğŸ”¸ æ‰¹é‡æ•°æ®å¤„ç†**ï¼š
```javascript
// åˆ†æ‰¹å¤„ç†å¤§é‡æ•°æ®
function processBatchData(tableName, batchSize = 1000) {
    return new Promise((resolve, reject) => {
        try {
            // è·å–æ€»è®°å½•æ•°
            var totalCount = session.sql(`SELECT COUNT(*) FROM ${tableName}`)
                .execute().fetchOne()[0];
            
            print(`ğŸ“Š æ€»å…±éœ€è¦å¤„ç† ${totalCount} æ¡è®°å½•`);
            
            var processed = 0;
            var offset = 0;
            
            // åˆ†æ‰¹å¤„ç†
            while (offset < totalCount) {
                var batch = session.sql(
                    `SELECT * FROM ${tableName} LIMIT ${batchSize} OFFSET ${offset}`
                ).execute().fetchAll();
                
                // å¤„ç†å½“å‰æ‰¹æ¬¡
                for (let row of batch) {
                    // è¿™é‡Œè¿›è¡Œå…·ä½“çš„æ•°æ®å¤„ç†
                    processed++;
                }
                
                offset += batchSize;
                
                // æ˜¾ç¤ºè¿›åº¦
                var progress = Math.round((processed / totalCount) * 100);
                print(`â³ å¤„ç†è¿›åº¦: ${progress}% (${processed}/${totalCount})`);
            }
            
            resolve(processed);
            
        } catch (error) {
            reject(error);
        }
    });
}

// ä½¿ç”¨æ‰¹é‡å¤„ç†
processBatchData('large_table', 500)
    .then(function(processedCount) {
        print(`ğŸ‰ æ‰¹é‡å¤„ç†å®Œæˆï¼Œå…±å¤„ç† ${processedCount} æ¡è®°å½•`);
    })
    .catch(function(error) {
        print(`âŒ æ‰¹é‡å¤„ç†å¤±è´¥: ${error.message}`);
    });
```

---

## 7. ğŸ” è°ƒè¯•æŠ€å·§ä¸æœ€ä½³å®è·µ


### 7.1 è°ƒè¯•åŸºç¡€æŠ€å·§


**ğŸ”¸ è¾“å‡ºè°ƒè¯•ä¿¡æ¯**ï¼š
```javascript
// ä¸åŒçº§åˆ«çš„è°ƒè¯•è¾“å‡º
function debugExample() {
    // åŸºæœ¬è¾“å‡º
    print("è¿™æ˜¯æ™®é€šä¿¡æ¯");
    println("è¿™æ˜¯å¸¦æ¢è¡Œçš„ä¿¡æ¯");
    
    // æ ¼å¼åŒ–è¾“å‡º
    var user = {name: "å¼ ä¸‰", age: 25};
    print("ç”¨æˆ·ä¿¡æ¯: " + JSON.stringify(user, null, 2));
    
    // æ¡ä»¶è°ƒè¯•è¾“å‡º
    var DEBUG = true;
    
    if (DEBUG) {
        print("ğŸ” è°ƒè¯•æ¨¡å¼å¼€å¯");
        print("ğŸ” å½“å‰æ—¶é—´: " + new Date().toISOString());
    }
}

// å‡½æ•°æ‰§è¡Œæ—¶é—´æµ‹é‡
function measureExecutionTime(func, ...args) {
    var startTime = Date.now();
    
    try {
        var result = func.apply(null, args);
        var endTime = Date.now();
        
        print(`â±ï¸ å‡½æ•°æ‰§è¡Œæ—¶é—´: ${endTime - startTime}ms`);
        return result;
        
    } catch (error) {
        print(`âŒ å‡½æ•°æ‰§è¡Œå¤±è´¥: ${error.message}`);
        throw error;
    }
}
```

**é”™è¯¯è·Ÿè¸ªæŠ€å·§**ï¼š
```javascript
// è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯è®°å½•
function detailedErrorHandling() {
    try {
        // å¯èƒ½å‡ºé”™çš„æ“ä½œ
        session.sql("SELECT * FROM non_existent_table").execute();
        
    } catch (error) {
        // æ”¶é›†è¯¦ç»†é”™è¯¯ä¿¡æ¯
        var errorInfo = {
            message: error.message,
            type: error.type || 'Unknown',
            code: error.code || 'N/A',
            timestamp: new Date().toISOString(),
            stack: error.stack || 'No stack trace'
        };
        
        print("ğŸš¨ è¯¦ç»†é”™è¯¯ä¿¡æ¯:");
        print(JSON.stringify(errorInfo, null, 2));
        
        // æ ¹æ®é”™è¯¯ç±»å‹é‡‡å–ä¸åŒè¡ŒåŠ¨
        if (error.code === 1146) { // Table doesn't exist
            print("ğŸ’¡ å»ºè®®: æ£€æŸ¥è¡¨åæ˜¯å¦æ­£ç¡®ï¼Œæˆ–è€…åˆ›å»ºæ‰€éœ€çš„è¡¨");
        }
    }
}
```

### 7.2 ä»£ç ç»„ç»‡æœ€ä½³å®è·µ


**ğŸ”¸ æ¨¡å—åŒ–ä»£ç ç»“æ„**ï¼š
```javascript
// é…ç½®ç®¡ç†æ¨¡å—
var Config = {
    database: {
        host: 'localhost',
        port: 3306,
        user: 'root',
        password: '',
        schema: 'test'
    },
    
    app: {
        debug: true,
        logLevel: 'info',
        batchSize: 1000
    },
    
    getConnectionString: function() {
        return `${this.database.user}@${this.database.host}:${this.database.port}`;
    }
};

// æ—¥å¿—ç®¡ç†æ¨¡å—
var Logger = {
    levels: {
        ERROR: 0,
        WARN: 1, 
        INFO: 2,
        DEBUG: 3
    },
    
    currentLevel: 2, // INFOçº§åˆ«
    
    log: function(level, message) {
        if (this.levels[level] <= this.currentLevel) {
            var timestamp = new Date().toISOString();
            print(`[${timestamp}] ${level}: ${message}`);
        }
    },
    
    error: function(message) { this.log('ERROR', message); },
    warn: function(message) { this.log('WARN', message); },
    info: function(message) { this.log('INFO', message); },
    debug: function(message) { this.log('DEBUG', message); }
};
```

**ä»£ç è§„èŒƒç¤ºä¾‹**ï¼š
```javascript
// å¥½çš„ä»£ç å®è·µç¤ºä¾‹
class DatabaseManager {
    constructor(config) {
        this.config = config;
        this.session = null;
        this.logger = Logger;
    }
    
    // è¿æ¥æ•°æ®åº“
    connect() {
        try {
            this.session = mysql.getSession(this.config.getConnectionString());
            this.logger.info("æ•°æ®åº“è¿æ¥æˆåŠŸ");
            return true;
        } catch (error) {
            this.logger.error(`æ•°æ®åº“è¿æ¥å¤±è´¥: ${error.message}`);
            return false;
        }
    }
    
    // å®‰å…¨æŸ¥è¯¢æ–¹æ³•
    query(sql, params = []) {
        if (!this.session || !this.session.isOpen()) {
            throw new Error("æ•°æ®åº“æœªè¿æ¥");
        }
        
        this.logger.debug(`æ‰§è¡ŒSQL: ${sql}`);
        
        try {
            var stmt = this.session.sql(sql);
            
            if (params.length > 0) {
                stmt = stmt.bind(params);
                this.logger.debug(`å‚æ•°: ${JSON.stringify(params)}`);
            }
            
            var result = stmt.execute();
            this.logger.debug("æŸ¥è¯¢æ‰§è¡ŒæˆåŠŸ");
            
            return result.fetchAll();
            
        } catch (error) {
            this.logger.error(`æŸ¥è¯¢å¤±è´¥: ${error.message}`);
            throw error;
        }
    }
    
    // æ¸…ç†èµ„æº
    close() {
        if (this.session && this.session.isOpen()) {
            this.session.close();
            this.logger.info("æ•°æ®åº“è¿æ¥å·²å…³é—­");
        }
    }
}
```

### 7.3 æ€§èƒ½ä¼˜åŒ–æŠ€å·§


**ğŸ”¸ æŸ¥è¯¢ä¼˜åŒ–å»ºè®®**ï¼š
```javascript
// æŸ¥è¯¢æ€§èƒ½ç›‘æ§
function monitorQueryPerformance(sql, params = []) {
    var startTime = Date.now();
    
    try {
        // æ‰§è¡ŒæŸ¥è¯¢
        var result = session.sql(sql).bind(params).execute();
        var data = result.fetchAll();
        
        var endTime = Date.now();
        var duration = endTime - startTime;
        
        // æ€§èƒ½åˆ†æ
        if (duration > 1000) {
            print(`âš ï¸ æ…¢æŸ¥è¯¢è­¦å‘Š: ${duration}ms`);
            print(`ğŸ“ SQL: ${sql}`);
            
            // å»ºè®®ä¼˜åŒ–
            if (sql.toLowerCase().includes('select') && !sql.toLowerCase().includes('limit')) {
                print("ğŸ’¡ å»ºè®®: æ·»åŠ LIMITå­å¥é™åˆ¶ç»“æœé›†");
            }
        } else {
            print(`âœ… æŸ¥è¯¢æ€§èƒ½è‰¯å¥½: ${duration}ms`);
        }
        
        return data;
        
    } catch (error) {
        print(`âŒ æŸ¥è¯¢å¤±è´¥: ${error.message}`);
        throw error;
    }
}

// æ‰¹é‡æ“ä½œä¼˜åŒ–
function optimizedBatchInsert(tableName, dataArray) {
    var batchSize = 100; // æ¯æ‰¹æ¬¡100æ¡
    var batches = [];
    
    // åˆ†å‰²æ•°æ®
    for (var i = 0; i < dataArray.length; i += batchSize) {
        batches.push(dataArray.slice(i, i + batchSize));
    }
    
    print(`ğŸ“¦ æ•°æ®åˆ†ä¸º ${batches.length} ä¸ªæ‰¹æ¬¡å¤„ç†`);
    
    session.startTransaction();
    
    try {
        for (var batchIndex = 0; batchIndex < batches.length; batchIndex++) {
            var batch = batches[batchIndex];
            
            // æ„å»ºæ‰¹é‡æ’å…¥SQL
            var values = batch.map(() => "(?, ?)").join(", ");
            var sql = `INSERT INTO ${tableName} (name, email) VALUES ${values}`;
            
            // å‡†å¤‡å‚æ•°
            var params = [];
            for (let item of batch) {
                params.push(item.name, item.email);
            }
            
            session.sql(sql).bind(params).execute();
            
            print(`âœ… æ‰¹æ¬¡ ${batchIndex + 1}/${batches.length} å®Œæˆ`);
        }
        
        session.commit();
        print(`ğŸ‰ æ‰¹é‡æ’å…¥å®Œæˆï¼Œå…± ${dataArray.length} æ¡è®°å½•`);
        
    } catch (error) {
        session.rollback();
        print(`âŒ æ‰¹é‡æ’å…¥å¤±è´¥: ${error.message}`);
        throw error;
    }
}
```

### 7.4 è„šæœ¬å¼€å‘å·¥ä½œæµ


**ğŸ”¸ å¼€å‘æµç¨‹å»ºè®®**ï¼š
```javascript
// è„šæœ¬æ¨¡æ¿
(function() {
    'use strict';
    
    // 1. é…ç½®åŒºåŸŸ
    var CONFIG = {
        connection: 'root@localhost:3306',
        schema: 'test',
        debug: true
    };
    
    // 2. å·¥å…·å‡½æ•°
    function setup() {
        if (CONFIG.debug) {
            print("ğŸš€ è„šæœ¬å¼€å§‹æ‰§è¡Œ");
            print("ğŸ“… æ‰§è¡Œæ—¶é—´: " + new Date().toISOString());
        }
        
        // è¿æ¥æ•°æ®åº“
        try {
            global.session = mysql.getSession(CONFIG.connection);
            global.session.sql(`USE ${CONFIG.schema}`).execute();
            return true;
        } catch (error) {
            print("âŒ åˆå§‹åŒ–å¤±è´¥: " + error.message);
            return false;
        }
    }
    
    function cleanup() {
        if (global.session && global.session.isOpen()) {
            global.session.close();
        }
        
        if (CONFIG.debug) {
            print("ğŸ”„ è„šæœ¬æ‰§è¡Œå®Œæˆ");
        }
    }
    
    // 3. ä¸»è¦ä¸šåŠ¡é€»è¾‘
    function main() {
        try {
            // è¿™é‡Œå†™å…·ä½“çš„ä¸šåŠ¡é€»è¾‘
            print("ğŸ’¼ æ‰§è¡Œä¸»è¦ä¸šåŠ¡é€»è¾‘");
            
            // ç¤ºä¾‹ï¼šæŸ¥è¯¢æ•°æ®
            var result = session.sql("SELECT VERSION()").execute();
            print("ğŸ“Š MySQLç‰ˆæœ¬: " + result.fetchOne()[0]);
            
            return true;
            
        } catch (error) {
            print("âŒ ä¸»é€»è¾‘æ‰§è¡Œå¤±è´¥: " + error.message);
            return false;
        }
    }
    
    // 4. è„šæœ¬å…¥å£
    if (setup()) {
        try {
            main();
        } finally {
            cleanup();
        }
    }
    
})();
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ JavaScriptæ¨¡å¼ï¼šMySQL Shellçš„äº¤äº’å¼JSç¼–ç¨‹ç¯å¢ƒ
ğŸ”¸ å†…ç½®å¯¹è±¡ï¼šsession(è¿æ¥)ã€dba(ç®¡ç†)ã€cluster(é›†ç¾¤)ã€shell(ç¯å¢ƒ)
ğŸ”¸ å˜é‡ä½œç”¨åŸŸï¼švar(å‡½æ•°)ã€let(å—)ã€const(å—+ä¸å¯å˜)  
ğŸ”¸ å¼‚å¸¸å¤„ç†ï¼štry/catch/finallyç¡®ä¿ç¨‹åºç¨³å®šæ€§
ğŸ”¸ æ¨¡å—ç³»ç»Ÿï¼šrequire()å¯¼å…¥ï¼Œmodule.exportså¯¼å‡º
ğŸ”¸ å¼‚æ­¥æ“ä½œï¼šPromiseå¤„ç†è€—æ—¶æ“ä½œï¼Œé¿å…é˜»å¡
ğŸ”¸ è°ƒè¯•æŠ€å·§ï¼šprint()è¾“å‡ºã€é”™è¯¯è·Ÿè¸ªã€æ€§èƒ½ç›‘æ§
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ JavaScriptæ¨¡å¼çš„ä¼˜åŠ¿**
```
ç›¸æ¯”çº¯SQLçš„ä¼˜åŠ¿ï¼š
â€¢ ç¼–ç¨‹é€»è¾‘æ§åˆ¶ï¼šå¾ªç¯ã€æ¡ä»¶ã€å‡½æ•°
â€¢ é”™è¯¯å¤„ç†æœºåˆ¶ï¼štry/catchå¼‚å¸¸å¤„ç†  
â€¢ ä»£ç å¤ç”¨ï¼šæ¨¡å—åŒ–å’Œå‡½æ•°å°è£…
â€¢ å¤æ‚æ“ä½œï¼šæ‰¹é‡å¤„ç†ã€äº‹åŠ¡ç®¡ç†
â€¢ åŠ¨æ€äº¤äº’ï¼šæ ¹æ®ç»“æœè°ƒæ•´æ‰§è¡Œæµç¨‹
```

**ğŸ”¹ å†…ç½®å¯¹è±¡çš„åˆ†å·¥**
```
sessionå¯¹è±¡ï¼šåŸºç¡€æ•°æ®åº“æ“ä½œ
â€¢ æ‰§è¡ŒSQLè¯­å¥
â€¢ ç®¡ç†äº‹åŠ¡
â€¢ å¤„ç†æŸ¥è¯¢ç»“æœ

dbaå¯¹è±¡ï¼šé«˜çº§ç®¡ç†åŠŸèƒ½  
â€¢ é›†ç¾¤ç®¡ç†
â€¢ å®ä¾‹é…ç½®
â€¢ å¤‡ä»½æ¢å¤

å®é™…ä½¿ç”¨ï¼šæ ¹æ®éœ€æ±‚é€‰æ‹©åˆé€‚çš„å¯¹è±¡
```

**ğŸ”¹ å¼‚æ­¥ç¼–ç¨‹çš„é‡è¦æ€§**
```
ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥ï¼š
â€¢ å¤§æ•°æ®é‡æŸ¥è¯¢éœ€è¦è¾ƒé•¿æ—¶é—´
â€¢ é¿å…ç•Œé¢å¡æ­»
â€¢ æé«˜ç¨‹åºå“åº”æ€§
â€¢ å¹¶è¡Œå¤„ç†å¤šä¸ªæ“ä½œ

å…³é”®æ¦‚å¿µï¼š
â€¢ Promiseï¼šå¼‚æ­¥æ“ä½œçš„å®¹å™¨
â€¢ then/catchï¼šç»“æœå¤„ç†
â€¢ async/awaitï¼šæ›´ä¼˜é›…çš„è¯­æ³•
```

### 8.3 å®é™…åº”ç”¨ä»·å€¼


**ğŸ¯ å…¸å‹ä½¿ç”¨åœºæ™¯**
- **æ•°æ®åº“ç»´æŠ¤è„šæœ¬**ï¼šè‡ªåŠ¨åŒ–æ—¥å¸¸ç»´æŠ¤ä»»åŠ¡
- **æ•°æ®è¿ç§»å·¥å…·**ï¼šæ‰¹é‡æ•°æ®å¤„ç†å’Œè½¬æ¢
- **ç›‘æ§æŠ¥å‘Šç”Ÿæˆ**ï¼šå®šæœŸç”Ÿæˆæ•°æ®åº“çŠ¶æ€æŠ¥å‘Š
- **é›†ç¾¤ç®¡ç†è‡ªåŠ¨åŒ–**ï¼šInnoDB Clusterçš„è‡ªåŠ¨åŒ–ç®¡ç†
- **æ€§èƒ½åˆ†æå·¥å…·**ï¼šæŸ¥è¯¢æ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–å»ºè®®

**ğŸ”§ å¼€å‘å®è·µå»ºè®®**
- **æ¨¡å—åŒ–è®¾è®¡**ï¼šå°†åŠŸèƒ½æ‹†åˆ†ä¸ºç‹¬ç«‹æ¨¡å—
- **é”™è¯¯å¤„ç†**ï¼šå……åˆ†çš„å¼‚å¸¸å¤„ç†æœºåˆ¶
- **æ—¥å¿—è®°å½•**ï¼šè¯¦ç»†çš„æ“ä½œæ—¥å¿—
- **æ€§èƒ½ç›‘æ§**ï¼šå…³æ³¨æ‰§è¡Œæ—¶é—´å’Œèµ„æºä½¿ç”¨
- **ä»£ç è§„èŒƒ**ï¼šæ¸…æ™°çš„å‘½åå’Œæ³¨é‡Š

**ğŸš€ è¿›é˜¶å­¦ä¹ è·¯å¾„**
1. **åŸºç¡€è¯­æ³•**ï¼šæŒæ¡JavaScriptè¯­æ³•å’ŒMySQL Shellç‰¹æ€§
2. **å†…ç½®API**ï¼šç†Ÿæ‚‰sessionã€dbaç­‰å¯¹è±¡çš„ä½¿ç”¨
3. **æ¨¡å—å¼€å‘**ï¼šåˆ›å»ºå¯å¤ç”¨çš„å·¥å…·æ¨¡å—
4. **å¼‚æ­¥ç¼–ç¨‹**ï¼šæŒæ¡Promiseå’Œå¼‚æ­¥æ“ä½œå¤„ç†
5. **å®é™…é¡¹ç›®**ï¼šç»“åˆä¸šåŠ¡éœ€æ±‚å¼€å‘å®ç”¨è„šæœ¬

**æ ¸å¿ƒè®°å¿†**ï¼š
- MySQL Shell JavaScriptæ¨¡å¼æä¾›äº†æ¯”çº¯SQLæ›´å¼ºå¤§çš„ç¼–ç¨‹èƒ½åŠ›
- å†…ç½®å¯¹è±¡å°è£…äº†ä¸°å¯Œçš„æ•°æ®åº“æ“ä½œAPIï¼Œå¤§å¤§ç®€åŒ–äº†å¤æ‚ä»»åŠ¡
- æ¨¡å—åŒ–å’Œå¼‚æ­¥ç¼–ç¨‹æ˜¯å¼€å‘å¤§å‹è„šæœ¬çš„å…³é”®æŠ€æœ¯
- è‰¯å¥½çš„é”™è¯¯å¤„ç†å’Œè°ƒè¯•ä¹ æƒ¯æ˜¯å†™å‡ºç¨³å®šè„šæœ¬çš„åŸºç¡€