---
title: 5ã€Redis-Exporterç¼“å­˜ç›‘æ§
---
## ğŸ“š ç›®å½•

1. [Redis Exporteræ¦‚è¿°](#1-Redis-Exporteræ¦‚è¿°)
2. [å®‰è£…é…ç½®Redis Exporter](#2-å®‰è£…é…ç½®Redis-Exporter)
3. [æ ¸å¿ƒç›‘æ§æŒ‡æ ‡è¯¦è§£](#3-æ ¸å¿ƒç›‘æ§æŒ‡æ ‡è¯¦è§£)
4. [ä¸åŒåœºæ™¯ä¸‹çš„ç›‘æ§ç­–ç•¥](#4-ä¸åŒåœºæ™¯ä¸‹çš„ç›‘æ§ç­–ç•¥)
5. [æ€§èƒ½ä¼˜åŒ–ä¸æ•…éšœæ’æŸ¥](#5-æ€§èƒ½ä¼˜åŒ–ä¸æ•…éšœæ’æŸ¥)
6. [å®æˆ˜ç›‘æ§é…ç½®æ¡ˆä¾‹](#6-å®æˆ˜ç›‘æ§é…ç½®æ¡ˆä¾‹)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ Redis Exporteræ¦‚è¿°


### 1.1 ä»€ä¹ˆæ˜¯Redis Exporter


**ç®€å•ç†è§£**ï¼šRedis Exporterå°±åƒæ˜¯Redisæ•°æ®åº“çš„"ä½“æ£€åŒ»ç”Ÿ"ï¼Œå®ƒä¼šå®šæœŸæ£€æŸ¥Redisçš„å„é¡¹å¥åº·æŒ‡æ ‡ï¼Œç„¶åæŠŠæ£€æŸ¥ç»“æœå‘Šè¯‰Prometheusã€‚

```
Redisæ•°æ®åº“ â†--æ£€æŸ¥çŠ¶æ€--> Redis Exporter â†--æ”¶é›†æŒ‡æ ‡--> Prometheus
     â†“                         â†“                      â†“
   è¿è¡Œä¸šåŠ¡                   è½¬æ¢æ ¼å¼                ç›‘æ§å‘Šè­¦
```

**æ ¸å¿ƒä½œç”¨**ï¼š
- ğŸ” **å¥åº·æ£€æŸ¥**ï¼šå®æ—¶ç›‘æ§Redisè¿è¡ŒçŠ¶æ€
- ğŸ“Š **æ€§èƒ½ç»Ÿè®¡**ï¼šæ”¶é›†å†…å­˜ã€CPUã€ç½‘ç»œç­‰æ€§èƒ½æ•°æ®
- âš ï¸ **å¼‚å¸¸é¢„è­¦**ï¼šåŠæ—¶å‘ç°æ½œåœ¨é—®é¢˜
- ğŸ“ˆ **è¶‹åŠ¿åˆ†æ**ï¼šä¸ºå®¹é‡è§„åˆ’æä¾›æ•°æ®æ”¯æŒ

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦ç›‘æ§Redis


**ä¸šåŠ¡åœºæ™¯ä¸¾ä¾‹**ï¼š
```
ç”µå•†ç½‘ç«™ä½¿ç”¨Redisä½œä¸ºç¼“å­˜ï¼š
- å•†å“ä¿¡æ¯ç¼“å­˜
- ç”¨æˆ·ä¼šè¯å­˜å‚¨  
- è´­ç‰©è½¦ä¸´æ—¶æ•°æ®
- çƒ­é—¨å•†å“æ’è¡Œ

å¦‚æœRediså‡ºé—®é¢˜ï¼š
âŒ é¡µé¢åŠ è½½å˜æ…¢ï¼ˆç¼“å­˜å¤±æ•ˆï¼‰
âŒ ç”¨æˆ·éœ€è¦é‡æ–°ç™»å½•ï¼ˆä¼šè¯ä¸¢å¤±ï¼‰
âŒ è´­ç‰©è½¦å•†å“æ¶ˆå¤±ï¼ˆæ•°æ®ä¸¢å¤±ï¼‰
âŒ ç³»ç»Ÿå“åº”è¶…æ—¶ï¼ˆæ€§èƒ½ä¸‹é™ï¼‰
```

**ç›‘æ§çš„ä»·å€¼**ï¼š
- **æå‰é¢„è­¦**ï¼šåœ¨é—®é¢˜å½±å“ç”¨æˆ·å‰å‘ç°
- **å¿«é€Ÿå®šä½**ï¼šç²¾ç¡®æ‰¾åˆ°æ€§èƒ½ç“¶é¢ˆ
- **å®¹é‡è§„åˆ’**ï¼šåŸºäºæ•°æ®å†³ç­–æ‰©å®¹æ—¶æœº
- **ä¼˜åŒ–æŒ‡å¯¼**ï¼šä¸ºæ€§èƒ½è°ƒä¼˜æä¾›ä¾æ®

### 1.3 Redis Exporterå·¥ä½œåŸç†


```
å·¥ä½œæµç¨‹å›¾ï¼š

Rediså®ä¾‹ â”€â”€INFOå‘½ä»¤â”€â”€> Redis Exporter â”€â”€HTTPæ¥å£â”€â”€> Prometheus
    â†“                        â†“                     â†“
  å®æ—¶æ•°æ®                  æ ¼å¼è½¬æ¢               å®šæœŸé‡‡é›†
    â”‚                        â”‚                     â”‚
    â”œâ”€ å†…å­˜ä½¿ç”¨              â”œâ”€ redis_memory_used   â”‚
    â”œâ”€ è¿æ¥æ•°é‡              â”œâ”€ redis_connected     â”‚
    â”œâ”€ å‘½ä»¤ç»Ÿè®¡              â”œâ”€ redis_commands      â”‚
    â””â”€ é”®ç©ºé—´ä¿¡æ¯            â””â”€ redis_keyspace      â”‚
                                                   â†“
                                               å­˜å‚¨å±•ç¤º
```

**æŠ€æœ¯å®ç°**ï¼š
- **æ•°æ®è·å–**ï¼šé€šè¿‡Redisçš„`INFO`å‘½ä»¤è·å–ç»Ÿè®¡ä¿¡æ¯
- **æ ¼å¼è½¬æ¢**ï¼šå°†Redisè¿”å›çš„æ–‡æœ¬æ ¼å¼è½¬æ¢ä¸ºPrometheusæŒ‡æ ‡æ ¼å¼
- **HTTPæš´éœ²**ï¼šé€šè¿‡HTTPæ¥å£æš´éœ²æŒ‡æ ‡ä¾›Prometheusé‡‡é›†

---

## 2. ğŸ”§ å®‰è£…é…ç½®Redis Exporter


### 2.1 Dockeræ–¹å¼å¿«é€Ÿéƒ¨ç½²


**æœ€ç®€å•çš„å¯åŠ¨æ–¹å¼**ï¼š
```bash
# åŸºç¡€å¯åŠ¨å‘½ä»¤
docker run -d \
  --name redis-exporter \
  -p 9121:9121 \
  oliver006/redis_exporter \
  --redis.addr=redis://localhost:6379
```

**å¸¦è®¤è¯çš„Redisè¿æ¥**ï¼š
```bash
# Redisæœ‰å¯†ç çš„æƒ…å†µ
docker run -d \
  --name redis-exporter \
  -p 9121:9121 \
  oliver006/redis_exporter \
  --redis.addr=redis://:password123@redis-server:6379
```

### 2.2 é…ç½®æ–‡ä»¶æ–¹å¼éƒ¨ç½²


**åˆ›å»ºé…ç½®æ–‡ä»¶**ï¼š`redis_exporter.yml`
```yaml
# Redisè¿æ¥é…ç½®
redis:
  # å•å®ä¾‹é…ç½®
  addr: "localhost:6379"
  password: "your_password"
  db: 0
  
# ç›‘æ§é…ç½®
exporter:
  # ç›‘å¬ç«¯å£
  port: 9121
  # æŒ‡æ ‡è·¯å¾„
  path: "/metrics"
  
# å®‰å…¨é…ç½®
auth:
  # æ˜¯å¦å¯ç”¨è®¤è¯
  enabled: false
  username: "monitor"
  password: "monitor123"
```

### 2.3 è¿æ¥ä¸åŒç±»å‹çš„Redis


**ğŸ”¸ å•æœºRedisè¿æ¥**ï¼š
```bash
# æ ‡å‡†è¿æ¥
redis.addr=redis://localhost:6379

# å¸¦å¯†ç è¿æ¥  
redis.addr=redis://:password@localhost:6379

# æŒ‡å®šæ•°æ®åº“
redis.addr=redis://:password@localhost:6379/2
```

**ğŸ”¸ Redisé›†ç¾¤è¿æ¥**ï¼š
```bash
# é›†ç¾¤æ¨¡å¼éœ€è¦æŒ‡å®šå¤šä¸ªèŠ‚ç‚¹
--redis.addr=redis://node1:6379
--redis.addr=redis://node2:6379  
--redis.addr=redis://node3:6379
--check-keys=myapp:*
```

**ğŸ”¸ Redis Sentinelè¿æ¥**ï¼š
```bash
# é€šè¿‡Sentinelå‘ç°ä¸»èŠ‚ç‚¹
--redis.addr=redis-sentinel://sentinel1:26379
--redis.sentinel-master=mymaster
--redis.password=password123
```

### 2.4 Prometheusé…ç½®é‡‡é›†


**åœ¨prometheus.ymlä¸­æ·»åŠ job**ï¼š
```yaml
scrape_configs:
  - job_name: 'redis-exporter'
    static_configs:
      - targets: ['localhost:9121']
    scrape_interval: 15s
    metrics_path: /metrics
    
    # æ·»åŠ æ ‡ç­¾ç”¨äºåŒºåˆ†ä¸åŒRediså®ä¾‹
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
      - target_label: service
        replacement: redis-cache
```

---

## 3. ğŸ“Š æ ¸å¿ƒç›‘æ§æŒ‡æ ‡è¯¦è§£


### 3.1 å†…å­˜ä½¿ç”¨ç›‘æ§


**ğŸ”¸ å…³é”®å†…å­˜æŒ‡æ ‡**ï¼š

| æŒ‡æ ‡åç§° | å«ä¹‰è§£é‡Š | æ­£å¸¸èŒƒå›´ | å‘Šè­¦é˜ˆå€¼ |
|---------|---------|---------|---------|
| `redis_memory_used_bytes` | å·²ä½¿ç”¨å†…å­˜å­—èŠ‚æ•° | æ ¹æ®é…ç½® | >80%æœ€å¤§å†…å­˜ |
| `redis_memory_used_rss_bytes` | å®é™…ç‰©ç†å†…å­˜å ç”¨ | ç•¥å¤§äºused | >90%ç³»ç»Ÿå†…å­˜ |
| `redis_memory_used_peak_bytes` | å†å²æœ€å¤§å†…å­˜ä½¿ç”¨ | - | ç”¨äºå®¹é‡è§„åˆ’ |
| `redis_memory_used_lua_bytes` | Luaè„šæœ¬å ç”¨å†…å­˜ | <1MB | >10MBéœ€å…³æ³¨ |

**ğŸ’¡ é€šä¿—è§£é‡Š**ï¼š
- **used_bytes**ï¼šå°±åƒä½ æ‰‹æœºæ˜¾ç¤ºçš„"å·²ç”¨å­˜å‚¨ç©ºé—´"
- **rss_bytes**ï¼šå®é™…å ç”¨çš„ç‰©ç†å†…å­˜ï¼ŒåŒ…å«ä¸€äº›ç³»ç»Ÿå¼€é”€
- **peak_bytes**ï¼šå†å²æœ€é«˜ç”¨é‡ï¼Œå¸®ä½ äº†è§£å³°å€¼éœ€æ±‚

```
å†…å­˜ä½¿ç”¨æƒ…å†µå¯è§†åŒ–ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Rediså†…å­˜ä½¿ç”¨æƒ…å†µ               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å·²ä½¿ç”¨: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 80% (800MB) â”‚
â”‚ RSS:   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘ 90% (900MB)  â”‚
â”‚ å³°å€¼:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% (1GB)   â”‚
â”‚ å¯ç”¨:  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 20% (200MB)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 é”®ç©ºé—´ç»Ÿè®¡ç›‘æ§


**ğŸ”¸ é”®ç›¸å…³æ ¸å¿ƒæŒ‡æ ‡**ï¼š

```yaml
# é”®ç©ºé—´åŸºç¡€ä¿¡æ¯
redis_db_keys{db="0"}: å½“å‰æ•°æ®åº“é”®æ€»æ•°
redis_db_keys_expiring{db="0"}: è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®æ•°é‡
redis_keyspace_hits_total: é”®å‘½ä¸­æ¬¡æ•°ï¼ˆç¼“å­˜å‘½ä¸­ï¼‰
redis_keyspace_misses_total: é”®æœªå‘½ä¸­æ¬¡æ•°ï¼ˆç¼“å­˜ç©¿é€ï¼‰
```

**ğŸ“ˆ ç¼“å­˜å‘½ä¸­ç‡è®¡ç®—**ï¼š
```
å‘½ä¸­ç‡ = redis_keyspace_hits / (redis_keyspace_hits + redis_keyspace_misses) Ã— 100%

å¥åº·çŠ¶æ€åˆ¤æ–­ï¼š
âœ… å‘½ä¸­ç‡ > 90%ï¼šç¼“å­˜æ•ˆæœå¾ˆå¥½
âš ï¸ å‘½ä¸­ç‡ 60-90%ï¼šå¯ä»¥ä¼˜åŒ–
âŒ å‘½ä¸­ç‡ < 60%ï¼šç¼“å­˜ç­–ç•¥æœ‰é—®é¢˜
```

### 3.3 å‘½ä»¤æ‰§è¡Œç»Ÿè®¡


**ğŸ”¸ å‘½ä»¤æ€§èƒ½æŒ‡æ ‡**ï¼š
```yaml
redis_commands_total{cmd="get"}: GETå‘½ä»¤æ‰§è¡Œæ€»æ¬¡æ•°
redis_commands_duration_seconds{cmd="get"}: GETå‘½ä»¤å¹³å‡è€—æ—¶
redis_slowlog_length: æ…¢æŸ¥è¯¢æ—¥å¿—æ¡æ•°
redis_slowlog_last_id: æœ€æ–°æ…¢æŸ¥è¯¢ID
```

**âš¡ æ€§èƒ½å¥åº·åº¦è¯„ä¼°**ï¼š
```
å‘½ä»¤æ‰§è¡Œæƒ…å†µåˆ†æï¼š

å¿«é€Ÿå‘½ä»¤ï¼ˆå¾®ç§’çº§ï¼‰ï¼š
â”œâ”€ GET/SET: < 100Î¼s  âœ…
â”œâ”€ HGET/HSET: < 200Î¼s  âœ…
â””â”€ ç®€å•LISTæ“ä½œ: < 500Î¼s  âœ…

éœ€è¦å…³æ³¨çš„å‘½ä»¤ï¼ˆæ¯«ç§’çº§ï¼‰ï¼š
â”œâ”€ SORT: 1-10ms  âš ï¸
â”œâ”€ å¤æ‚èšåˆ: 5-50ms  âš ï¸
â””â”€ å¤§æ‰¹é‡æ“ä½œ: >50ms  âŒ
```

### 3.4 è¿æ¥ä¸ç½‘ç»œç›‘æ§


**ğŸ”¸ è¿æ¥çŠ¶æ€æŒ‡æ ‡**ï¼š
```yaml
redis_connected_clients: å½“å‰è¿æ¥å®¢æˆ·ç«¯æ•°é‡
redis_blocked_clients: è¢«é˜»å¡çš„å®¢æˆ·ç«¯æ•°é‡
redis_tracking_clients: å®¢æˆ·ç«¯è·Ÿè¸ªæ•°é‡
redis_max_clients: æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°é™åˆ¶
```

**ğŸŒ ç½‘ç»œIOç»Ÿè®¡**ï¼š
```yaml
redis_net_input_bytes_total: ç½‘ç»œè¾“å…¥å­—èŠ‚æ€»æ•°
redis_net_output_bytes_total: ç½‘ç»œè¾“å‡ºå­—èŠ‚æ€»æ•°
redis_connections_received_total: å†å²è¿æ¥æ€»æ•°
redis_connections_rejected_total: è¢«æ‹’ç»è¿æ¥æ€»æ•°
```

**è¿æ¥å¥åº·åº¦åˆ¤æ–­**ï¼š
```
è¿æ¥æ± çŠ¶æ€å›¾ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¿æ¥çŠ¶æ€åˆ†å¸ƒ       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ´»è·ƒè¿æ¥: â–ˆâ–ˆâ–ˆâ–ˆ  40 â”‚ âœ… æ­£å¸¸ä½¿ç”¨
â”‚ ç©ºé—²è¿æ¥: â–ˆâ–ˆ    20 â”‚ âœ… è¿æ¥æ± å¥åº·
â”‚ é˜»å¡è¿æ¥: â–‘     0  â”‚ âœ… æ— é˜»å¡
â”‚ æœ€å¤§é™åˆ¶: â–ˆâ–ˆâ–ˆâ–ˆ 100 â”‚ âš ï¸ 60%ä½¿ç”¨ç‡
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.5 æŒä¹…åŒ–ç›‘æ§


**ğŸ”¸ RDBå¿«ç…§ç›‘æ§**ï¼š
```yaml
redis_rdb_last_save_time: æœ€åä¸€æ¬¡RDBä¿å­˜æ—¶é—´æˆ³
redis_rdb_changes_since_last_save: è‡ªä¸Šæ¬¡ä¿å­˜åçš„å˜æ›´æ•°
redis_rdb_bgsave_in_progress: æ˜¯å¦æ­£åœ¨è¿›è¡Œåå°ä¿å­˜
redis_last_bgsave_status: æœ€åä¸€æ¬¡åå°ä¿å­˜çŠ¶æ€
```

**ğŸ”¸ AOFæ—¥å¿—ç›‘æ§**ï¼š
```yaml
redis_aof_enabled: AOFæ˜¯å¦å¯ç”¨
redis_aof_rewrite_in_progress: æ˜¯å¦æ­£åœ¨AOFé‡å†™
redis_aof_last_rewrite_duration_sec: æœ€åä¸€æ¬¡é‡å†™è€—æ—¶
redis_aof_current_size_bytes: å½“å‰AOFæ–‡ä»¶å¤§å°
```

---

## 4. ğŸ›ï¸ ä¸åŒåœºæ™¯ä¸‹çš„ç›‘æ§ç­–ç•¥


### 4.1 ç¼“å­˜å±‚ç›‘æ§é‡ç‚¹


**ç”µå•†ç³»ç»Ÿç¼“å­˜ç›‘æ§**ï¼š
```
é‡ç‚¹å…³æ³¨æŒ‡æ ‡ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¼“å­˜æ€§èƒ½æ ¸å¿ƒæŒ‡æ ‡    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ¯ å‘½ä¸­ç‡: >95%     â”‚ â† å½±å“ç”¨æˆ·ä½“éªŒ
â”‚ âš¡ å“åº”æ—¶é—´: <5ms   â”‚ â† é¡µé¢åŠ è½½é€Ÿåº¦
â”‚ ğŸ’¾ å†…å­˜ä½¿ç”¨: <80%   â”‚ â† é¿å…å†…å­˜æº¢å‡º
â”‚ ğŸ”„ è¿‡æœŸç­–ç•¥: åˆç†   â”‚ â† æ•°æ®ä¸€è‡´æ€§
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¸šåŠ¡åœºæ™¯æ˜ å°„ï¼š
â”œâ”€ å•†å“è¯¦æƒ…ç¼“å­˜ â†’ é«˜å‘½ä¸­ç‡è¦æ±‚
â”œâ”€ ç”¨æˆ·ä¼šè¯å­˜å‚¨ â†’ ç¨³å®šæ€§è¦æ±‚
â”œâ”€ è´­ç‰©è½¦æ•°æ® â†’ å®æ—¶æ€§è¦æ±‚
â””â”€ çƒ­é—¨æ’è¡Œæ¦œ â†’ æ›´æ–°é¢‘ç‡è¦æ±‚
```

### 4.2 ä¼šè¯å­˜å‚¨ç›‘æ§é‡ç‚¹


**ç”¨æˆ·ä¼šè¯Redisç›‘æ§**ï¼š
```yaml
# ä¼šè¯ç›¸å…³ç›‘æ§é…ç½®
alerting_rules:
  - alert: SessionRedisDown
    expr: up{job="redis-session"} == 0
    for: 1m
    annotations:
      summary: "ä¼šè¯RedisæœåŠ¡ä¸å¯ç”¨"
      
  - alert: SessionMemoryHigh
    expr: redis_memory_used_bytes / redis_memory_max_bytes > 0.8
    for: 5m
    annotations:
      summary: "ä¼šè¯å­˜å‚¨å†…å­˜ä½¿ç”¨è¿‡é«˜"
```

### 4.3 é›†ç¾¤æ¨¡å¼ç›‘æ§ç­–ç•¥


**Redisé›†ç¾¤ç‰¹æ®Šç›‘æ§ç‚¹**ï¼š
```
é›†ç¾¤å¥åº·æ£€æŸ¥ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Redisé›†ç¾¤ç›‘æ§å¤§å±               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ èŠ‚ç‚¹çŠ¶æ€: âœ…âœ…âœ… âŒâœ…âœ…       â”‚ â† 6ä¸ªèŠ‚ç‚¹1ä¸ªå¼‚å¸¸
â”‚ æ§½ä½åˆ†å¸ƒ: å¹³è¡¡åˆ†é…              â”‚ â† æ•°æ®åˆ†å¸ƒå‡åŒ€
â”‚ ä¸»ä»å¤åˆ¶: æ­£å¸¸åŒæ­¥              â”‚ â† å¤åˆ¶å»¶è¿Ÿ<1s
â”‚ æ•…éšœè½¬ç§»: è‡ªåŠ¨åˆ‡æ¢              â”‚ â† é«˜å¯ç”¨ä¿éšœ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å…³é”®æŒ‡æ ‡ï¼š
â”œâ”€ redis_cluster_nodes: é›†ç¾¤èŠ‚ç‚¹æ•°é‡
â”œâ”€ redis_cluster_slots_assigned: å·²åˆ†é…æ§½ä½æ•°
â”œâ”€ redis_cluster_slots_ok: æ­£å¸¸æ§½ä½æ•°  
â””â”€ redis_cluster_state: é›†ç¾¤æ•´ä½“çŠ¶æ€
```

### 4.4 é«˜å¯ç”¨åœºæ™¯ç›‘æ§


**ä¸»ä»å¤åˆ¶ç›‘æ§**ï¼š
```yaml
# å¤åˆ¶å»¶è¿Ÿç›‘æ§
redis_master_repl_offset: ä¸»èŠ‚ç‚¹å¤åˆ¶åç§»é‡
redis_slave_repl_offset: ä»èŠ‚ç‚¹å¤åˆ¶åç§»é‡
redis_master_last_io_seconds_ago: ä¸»èŠ‚ç‚¹æœ€åIOæ—¶é—´
redis_connected_slaves: è¿æ¥çš„ä»èŠ‚ç‚¹æ•°é‡
```

**Sentinelç›‘æ§**ï¼š
```bash
# Sentinelç‰¹æ®Šé…ç½®
--redis.check-single-keys=*
--redis.check-streams=*
--include-system-metrics
```

---

## 5. ğŸ”§ æ€§èƒ½ä¼˜åŒ–ä¸æ•…éšœæ’æŸ¥


### 5.1 å¸¸è§æ€§èƒ½ç“¶é¢ˆè¯†åˆ«


**ğŸ”¸ å†…å­˜ç“¶é¢ˆè¯†åˆ«**ï¼š
```
å†…å­˜é—®é¢˜è¯Šæ–­æµç¨‹ï¼š

1. æ£€æŸ¥å†…å­˜ä½¿ç”¨ç‡
   redis_memory_used_bytes / redis_memory_max_bytes > 0.8
   â†“
2. åˆ†æå†…å­˜åˆ†å¸ƒ
   â”œâ”€ æ•°æ®å†…å­˜: redis_memory_used_dataset_bytes
   â”œâ”€ ç¼“å†²åŒºå†…å­˜: redis_memory_used_overhead_bytes  
   â””â”€ Luaè„šæœ¬å†…å­˜: redis_memory_used_lua_bytes
   â†“
3. æŸ¥çœ‹é”®ç©ºé—´åˆ†å¸ƒ
   redis_db_keys{db="0"} â†’ å„æ•°æ®åº“é”®æ•°é‡
   â†“
4. æ£€æŸ¥å¤§é”®é—®é¢˜
   ä½¿ç”¨ --check-single-keys å‚æ•°ç›‘æ§
```

**ğŸ”¸ CPUç“¶é¢ˆè¯†åˆ«**ï¼š
```yaml
# CPUç›¸å…³æŒ‡æ ‡
redis_cpu_user_seconds_total: ç”¨æˆ·æ€CPUæ—¶é—´
redis_cpu_sys_seconds_total: ç³»ç»Ÿæ€CPUæ—¶é—´
redis_instantaneous_ops_per_sec: å½“å‰QPS
redis_commands_duration_seconds: å‘½ä»¤å¹³å‡è€—æ—¶
```

### 5.2 ç½‘ç»œIOä¼˜åŒ–ç›‘æ§


**ç½‘ç»œæ€§èƒ½åˆ†æ**ï¼š
```
ç½‘ç»œIOè¯Šæ–­ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç½‘ç»œæµé‡åˆ†æ            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å…¥ç«™æµé‡: â–ˆâ–ˆâ–ˆâ–ˆ  800MB/h â”‚ â† å®¢æˆ·ç«¯è¯·æ±‚é‡
â”‚ å‡ºç«™æµé‡: â–ˆâ–ˆâ–ˆâ–ˆ  1.2GB/h â”‚ â† å“åº”æ•°æ®é‡
â”‚ è¿æ¥æ•°é‡: â–ˆâ–ˆ    45ä¸ª    â”‚ â† å¹¶å‘è¿æ¥
â”‚ æ‹’ç»è¿æ¥: â–‘     0ä¸ª     â”‚ â† è¿æ¥å¥åº·åº¦
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¼˜åŒ–å»ºè®®ï¼š
â”œâ”€ æ‰¹é‡æ“ä½œä»£æ›¿å•æ¬¡æ“ä½œ
â”œâ”€ ä½¿ç”¨Pipelineå‡å°‘RTT
â”œâ”€ åˆç†è®¾ç½®è¿æ¥æ± å¤§å°
â””â”€ å¯ç”¨å‹ç¼©å‡å°‘ä¼ è¾“é‡
```

### 5.3 æ…¢æŸ¥è¯¢ç›‘æ§ä¸ä¼˜åŒ–


**æ…¢æŸ¥è¯¢åˆ†æé…ç½®**ï¼š
```bash
# å¯ç”¨æ…¢æŸ¥è¯¢è¯¦ç»†ç›‘æ§
redis_exporter \
  --redis.addr=redis://localhost:6379 \
  --check-single-keys=key_* \
  --check-streams=stream_* \
  --collect-slowlog-max=100
```

**æ…¢æŸ¥è¯¢å‘Šè­¦è§„åˆ™**ï¼š
```yaml
groups:
  - name: redis-slowlog
    rules:
      - alert: RedisSlowlogIncreasing
        expr: increase(redis_slowlog_length[5m]) > 10
        for: 2m
        annotations:
          summary: "Redisæ…¢æŸ¥è¯¢å¢é•¿è¿‡å¿«"
          description: "5åˆ†é’Ÿå†…æ–°å¢{{$value}}æ¡æ…¢æŸ¥è¯¢"
```

### 5.4 æ•…éšœå¿«é€Ÿå®šä½


**æ•…éšœæ’æŸ¥æ£€æŸ¥æ¸…å•**ï¼š
```
æ•…éšœè¯Šæ–­æ­¥éª¤ï¼š

1ï¸âƒ£ åŸºç¡€è¿é€šæ€§æ£€æŸ¥
   â”œâ”€ up{job="redis-exporter"} â†’ Exporteræ˜¯å¦æ­£å¸¸
   â”œâ”€ redis_up â†’ RedisæœåŠ¡æ˜¯å¦å¯ç”¨
   â””â”€ redis_ping_latency â†’ ç½‘ç»œå»¶è¿Ÿ

2ï¸âƒ£ èµ„æºä½¿ç”¨æ£€æŸ¥  
   â”œâ”€ å†…å­˜: redis_memory_used_bytes
   â”œâ”€ CPU: redis_cpu_user_seconds_total
   â”œâ”€ ç½‘ç»œ: redis_net_input_bytes_total
   â””â”€ ç£ç›˜: redis_rdb_last_save_time

3ï¸âƒ£ ä¸šåŠ¡æŒ‡æ ‡æ£€æŸ¥
   â”œâ”€ QPS: redis_instantaneous_ops_per_sec
   â”œâ”€ å‘½ä¸­ç‡: redis_keyspace_hits_total
   â”œâ”€ é”™è¯¯æ•°: redis_errorstat_*
   â””â”€ æ…¢æŸ¥è¯¢: redis_slowlog_length

4ï¸âƒ£ é›†ç¾¤çŠ¶æ€æ£€æŸ¥ï¼ˆå¦‚é€‚ç”¨ï¼‰
   â”œâ”€ èŠ‚ç‚¹çŠ¶æ€: redis_cluster_state
   â”œâ”€ æ§½ä½åˆ†é…: redis_cluster_slots_ok
   â””â”€ ä¸»ä»åŒæ­¥: redis_connected_slaves
```

---

## 6. ğŸ› ï¸ å®æˆ˜ç›‘æ§é…ç½®æ¡ˆä¾‹


### 6.1 ç”Ÿäº§ç¯å¢ƒå®Œæ•´é…ç½®


**Docker Composeéƒ¨ç½²ç¤ºä¾‹**ï¼š
```yaml
version: '3.8'
services:
  redis-exporter:
    image: oliver006/redis_exporter:latest
    container_name: redis-exporter
    ports:
      - "9121:9121"
    environment:
      REDIS_ADDR: "redis://redis-server:6379"
      REDIS_PASSWORD: "${REDIS_PASSWORD}"
      REDIS_EXPORTER_CHECK_KEYS: "cache:*,session:*"
      REDIS_EXPORTER_CHECK_SINGLE_KEYS: "important_key_*"
    command:
      - '--include-system-metrics'
      - '--check-single-keys=cache:*'
      - '--collect-slowlog-max=50'
    restart: unless-stopped
    
  redis-server:
    image: redis:7-alpine
    container_name: redis-server
    command: redis-server --appendonly yes --requirepass ${REDIS_PASSWORD}
    volumes:
      - redis-data:/data
    restart: unless-stopped

volumes:
  redis-data:
```

### 6.2 Grafanaä»ªè¡¨æ¿é…ç½®


**æ ¸å¿ƒç›‘æ§é¢æ¿**ï¼š
```json
{
  "dashboard": {
    "title": "Redisç›‘æ§ä»ªè¡¨æ¿",
    "panels": [
      {
        "title": "å†…å­˜ä½¿ç”¨æƒ…å†µ",
        "type": "stat",
        "targets": [
          {
            "expr": "redis_memory_used_bytes / redis_memory_max_bytes * 100",
            "legendFormat": "å†…å­˜ä½¿ç”¨ç‡"
          }
        ]
      },
      {
        "title": "QPSè¶‹åŠ¿", 
        "type": "graph",
        "targets": [
          {
            "expr": "rate(redis_commands_total[5m])",
            "legendFormat": "{{cmd}}"
          }
        ]
      },
      {
        "title": "ç¼“å­˜å‘½ä¸­ç‡",
        "type": "singlestat", 
        "targets": [
          {
            "expr": "rate(redis_keyspace_hits_total[5m]) / (rate(redis_keyspace_hits_total[5m]) + rate(redis_keyspace_misses_total[5m])) * 100",
            "legendFormat": "å‘½ä¸­ç‡"
          }
        ]
      }
    ]
  }
}
```

### 6.3 å‘Šè­¦è§„åˆ™å®Œæ•´é…ç½®


**ç”Ÿäº§çº§å‘Šè­¦è§„åˆ™**ï¼š
```yaml
groups:
  - name: redis-alerts
    rules:
      # æœåŠ¡å¯ç”¨æ€§å‘Šè­¦
      - alert: RedisDown
        expr: redis_up == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "RedisæœåŠ¡ä¸å¯ç”¨"
          description: "å®ä¾‹ {{$labels.instance}} RedisæœåŠ¡å·²åœæ­¢"
          
      # å†…å­˜ä½¿ç”¨å‘Šè­¦
      - alert: RedisMemoryHigh
        expr: redis_memory_used_bytes / redis_memory_max_bytes > 0.8
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Rediså†…å­˜ä½¿ç”¨è¿‡é«˜"
          description: "å®ä¾‹ {{$labels.instance}} å†…å­˜ä½¿ç”¨ç‡ {{$value | humanizePercentage}}"
          
      # ç¼“å­˜å‘½ä¸­ç‡å‘Šè­¦
      - alert: RedisCacheHitRateLow
        expr: |
          (
            rate(redis_keyspace_hits_total[5m]) / 
            (rate(redis_keyspace_hits_total[5m]) + rate(redis_keyspace_misses_total[5m]))
          ) < 0.8
        for: 10m
        labels:
          severity: warning
        annotations:
          summary: "Redisç¼“å­˜å‘½ä¸­ç‡è¿‡ä½"
          description: "ç¼“å­˜å‘½ä¸­ç‡ä»…ä¸º {{$value | humanizePercentage}}"
          
      # è¿æ¥æ•°å‘Šè­¦
      - alert: RedisConnectionsHigh
        expr: redis_connected_clients > redis_max_clients * 0.8
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Redisè¿æ¥æ•°è¿‡é«˜"
          
      # æ…¢æŸ¥è¯¢å‘Šè­¦
      - alert: RedisSlowlogGrowing
        expr: increase(redis_slowlog_length[10m]) > 20
        for: 0m
        labels:
          severity: warning
        annotations:
          summary: "Redisæ…¢æŸ¥è¯¢å¢é•¿è¿‡å¿«"
```

### 6.4 å¤šå®ä¾‹ç›‘æ§é…ç½®


**ç›‘æ§å¤šä¸ªRediså®ä¾‹**ï¼š
```yaml
# prometheus.ymlé…ç½®
scrape_configs:
  - job_name: 'redis-cache-cluster'
    static_configs:
      - targets: 
          - 'cache-1.example.com:9121'
          - 'cache-2.example.com:9121'  
          - 'cache-3.example.com:9121'
    relabel_configs:
      - source_labels: [__address__]
        regex: '(.*):9121'
        target_label: redis_instance
        replacement: '${1}'
      - target_label: redis_role
        replacement: 'cache'
        
  - job_name: 'redis-session-cluster' 
    static_configs:
      - targets:
          - 'session-1.example.com:9121'
          - 'session-2.example.com:9121'
    relabel_configs:
      - target_label: redis_role
        replacement: 'session'
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„ç›‘æ§è¦ç‚¹


```
ğŸ”¸ åŸºç¡€ç›‘æ§å››å¤§æ”¯æŸ±ï¼š
â”œâ”€ ğŸ’¾ å†…å­˜ä½¿ç”¨ï¼šé˜²æ­¢OOMï¼ŒåŠæ—¶æ‰©å®¹
â”œâ”€ âš¡ æ€§èƒ½æŒ‡æ ‡ï¼šQPSã€å»¶è¿Ÿã€å‘½ä¸­ç‡
â”œâ”€ ğŸ”— è¿æ¥çŠ¶æ€ï¼šè¿æ¥æ•°ã€é˜»å¡æƒ…å†µ
â””â”€ ğŸ’¿ æŒä¹…åŒ–ï¼šRDBã€AOFçŠ¶æ€ç›‘æ§

ğŸ”¸ å…³é”®ä¸šåŠ¡æŒ‡æ ‡ï¼š
â”œâ”€ ç¼“å­˜å‘½ä¸­ç‡ >90%ï¼šä¸šåŠ¡æ€§èƒ½ä¿éšœ
â”œâ”€ å“åº”æ—¶é—´ <5msï¼šç”¨æˆ·ä½“éªŒæŒ‡æ ‡
â”œâ”€ å†…å­˜ä½¿ç”¨ç‡ <80%ï¼šç³»ç»Ÿç¨³å®šæ€§
â””â”€ é”™è¯¯ç‡ <1%ï¼šæœåŠ¡è´¨é‡æŒ‡æ ‡
```

### 7.2 æ•…éšœé¢„é˜²æœ€ä½³å®è·µ


**ğŸ”¹ å®¹é‡è§„åˆ’è¦ç‚¹**ï¼š
```
å†…å­˜å®¹é‡è§„åˆ’ï¼š
â”œâ”€ å½“å‰ä½¿ç”¨é‡ Ã— 1.5 = æ—¥å¸¸é¢„ç•™
â”œâ”€ å³°å€¼ä½¿ç”¨é‡ Ã— 1.2 = å³°å€¼é¢„ç•™  
â”œâ”€ è€ƒè™‘æ•°æ®å¢é•¿è¶‹åŠ¿
â””â”€ é¢„ç•™20%ç´§æ€¥ç¼“å†²ç©ºé—´

æ€§èƒ½åŸºçº¿å»ºç«‹ï¼š
â”œâ”€ è®°å½•æ­£å¸¸QPSèŒƒå›´
â”œâ”€ å»ºç«‹å“åº”æ—¶é—´åŸºçº¿
â”œâ”€ ç›‘æ§å‘½ä¸­ç‡è¶‹åŠ¿
â””â”€ å®šæœŸå®¹é‡è¯„ä¼°
```

**ğŸ”¹ å‘Šè­¦ç­–ç•¥å»ºè®®**ï¼š
```
å‘Šè­¦çº§åˆ«è®¾è®¡ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”´ Criticalï¼šå½±å“ä¸šåŠ¡       â”‚
â”‚   â”œâ”€ æœåŠ¡ä¸å¯ç”¨             â”‚
â”‚   â”œâ”€ å†…å­˜å³å°†è€—å°½           â”‚
â”‚   â””â”€ ä¸»ä»å¤åˆ¶ä¸­æ–­           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸŸ¡ Warningï¼šéœ€è¦å…³æ³¨        â”‚
â”‚   â”œâ”€ å†…å­˜ä½¿ç”¨ç‡>80%         â”‚
â”‚   â”œâ”€ ç¼“å­˜å‘½ä¸­ç‡<90%         â”‚
â”‚   â””â”€ æ…¢æŸ¥è¯¢å¢é•¿             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”µ Infoï¼šè¶‹åŠ¿ä¿¡æ¯           â”‚
â”‚   â”œâ”€ QPSå˜åŒ–è¶‹åŠ¿            â”‚
â”‚   â”œâ”€ è¿æ¥æ•°æ³¢åŠ¨             â”‚
â”‚   â””â”€ é”®ç©ºé—´å˜åŒ–             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.3 å®é™…åº”ç”¨æŒ‡å¯¼


**ä¸åŒåœºæ™¯ç›‘æ§é‡ç‚¹**ï¼š
- **ç¼“å­˜å±‚**ï¼šé‡ç‚¹å…³æ³¨å‘½ä¸­ç‡å’Œå“åº”æ—¶é—´
- **ä¼šè¯å­˜å‚¨**ï¼šé‡ç‚¹å…³æ³¨å¯ç”¨æ€§å’Œæ•°æ®å®Œæ•´æ€§  
- **æ¶ˆæ¯é˜Ÿåˆ—**ï¼šé‡ç‚¹å…³æ³¨ç§¯å‹æƒ…å†µå’Œå¤„ç†é€Ÿåº¦
- **è®¡æ•°å™¨**ï¼šé‡ç‚¹å…³æ³¨å¹¶å‘æ€§èƒ½å’Œå‡†ç¡®æ€§

**è¿ç»´å®è·µå»ºè®®**ï¼š
- **å®šæœŸå·¡æ£€**ï¼šæ¯æ—¥æ£€æŸ¥å…³é”®æŒ‡æ ‡è¶‹åŠ¿
- **å®¹é‡é¢„è­¦**ï¼šæå‰1-2å‘¨å‘ç°å®¹é‡é—®é¢˜
- **æ€§èƒ½åŸºçº¿**ï¼šå»ºç«‹ä¸šåŠ¡é«˜å³°æœŸæ€§èƒ½åŸºå‡†
- **æ•…éšœæ¼”ç»ƒ**ï¼šå®šæœŸæµ‹è¯•ç›‘æ§å‘Šè­¦çš„æœ‰æ•ˆæ€§

**æ ¸å¿ƒè®°å¿†**ï¼š
- Redisç›‘æ§é‡åœ¨é¢„é˜²ï¼Œä¸æ˜¯äº‹åè¡¥æ•‘
- ç¼“å­˜å‘½ä¸­ç‡æ˜¯æœ€é‡è¦çš„ä¸šåŠ¡æŒ‡æ ‡
- å†…å­˜ä½¿ç”¨æ˜¯æœ€éœ€è¦å…³æ³¨çš„èµ„æºæŒ‡æ ‡
- ç›‘æ§é…ç½®è¦ç»“åˆå…·ä½“ä¸šåŠ¡åœºæ™¯å®šåˆ¶