---
title: 2、单值图-配置
---
## 📚 目录

1. [单值图基础概念](#1-单值图基础概念)
2. [Stat面板核心功能](#2-Stat面板核心功能)
3. [数值显示格式配置](#3-数值显示格式配置)
4. [单位设置详解](#4-单位设置详解)
5. [阈值配置与应用](#5-阈值配置与应用)
6. [颜色映射机制](#6-颜色映射机制)
7. [趋势指示器使用](#7-趋势指示器使用)
8. [实际应用场景](#8-实际应用场景)
9. [核心要点总结](#9-核心要点总结)

---

## 1. 📊 单值图基础概念


### 1.1 什么是单值图


**🔸 直观理解**
```
想象一下汽车仪表盘上的数字显示：
- 当前车速：80 km/h
- 油箱余量：45%
- 发动机温度：90°C

Grafana的单值图就像这样，专门显示一个关键数字
```

**💡 核心特点**
- **一目了然**：大字体显示最重要的数值
- **状态指示**：通过颜色表示健康状态
- **趋势提示**：显示数值是上升还是下降
- **空间高效**：小面板展示关键信息

### 1.2 单值图的应用价值


**🎯 为什么需要单值图**
```
监控大屏场景：
┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐
│   CPU使用率     │ │   内存使用率    │ │   磁盘使用率    │
│                 │ │                 │ │                 │
│      75%        │ │      45%        │ │      89%        │
│     ↗ +5%       │ │     ↘ -2%       │ │     ↗ +15%      │
│   [绿色背景]    │ │   [绿色背景]    │ │   [红色背景]    │
└─────────────────┘ └─────────────────┘ └─────────────────┘

一眼就能看出：磁盘空间告急！需要立即处理
```

**🔸 适用场景**
- **KPI监控**：关键业务指标
- **系统监控**：CPU、内存、网络等
- **业务监控**：订单量、用户数、收入等
- **告警状态**：当前告警数量

---

## 2. ⚙️ Stat面板核心功能


### 2.1 Stat面板是什么


**🔸 核心定义**
```
Stat = Statistics（统计）的缩写
专门用来显示单个数值的面板类型

就像是：数据仪表盘上的一个"数字显示器"
```

**📋 主要组成部分**
```
┌─────────────────────┐
│ [标题]  CPU使用率   │ ← 面板标题
│                     │
│       75.2%         │ ← 主要数值（大字体）
│      ↗ +5.2%        │ ← 趋势指示器
│                     │
│ ■■■■■■■□□□          │ ← 可选：进度条
└─────────────────────┘
```

### 2.2 创建Stat面板的步骤


**🔧 基本操作流程**
```
步骤1：添加面板
Dashboard → Add panel → Add a new panel

步骤2：选择面板类型
Visualization → Stat

步骤3：配置数据源
Data source → 选择Prometheus/InfluxDB等

步骤4：编写查询语句
Query → 输入监控指标查询

步骤5：配置显示选项
Field → 设置单位、格式、阈值等
```

### 2.3 Stat面板的显示模式


**🎨 三种显示风格**

| 显示模式 | **效果** | **适用场景** |
|---------|---------|-------------|
| 🔸 **单值模式** | `只显示数字` | `简洁明了，空间有限时` |
| 🔸 **单值+名称** | `数字+标签名` | `需要说明数值含义时` |
| 🔸 **自动模式** | `根据空间自适应` | `响应式布局，推荐使用` |

---

## 3. 📝 数值显示格式配置


### 3.1 数值格式的重要性


**💡 为什么要设置格式**
```
原始数据：1536870912
格式化后：1.5 GB

哪个更容易理解？显然是格式化后的！
```

### 3.2 常用数值格式类型


**🔸 基础数值格式**
```java
// 整数格式
1234567 → 1,234,567     // 千分位分隔
1234567 → 1.23M         // 科学计数法

// 小数格式
3.14159 → 3.14          // 保留2位小数
0.1234  → 12.34%        // 百分比格式
```

**📊 格式配置选项**

| 格式类型 | **配置项** | **效果示例** | **使用场景** |
|---------|-----------|-------------|-------------|
| `Number` | `小数位数` | `1234.56` | `一般数值` |
| `Percent` | `百分比` | `85.2%` | `使用率、完成度` |
| `Bytes` | `字节单位` | `1.5 GB` | `存储空间、网络流量` |
| `Short` | `科学计数` | `1.23K` | `大数值简化显示` |
| `Currency` | `货币格式` | `$1,234.56` | `金额、成本` |

### 3.3 小数位数控制


**🎯 精度设置原则**
```
监控指标类型 → 建议小数位数

CPU使用率：      75.2%     (1位小数)
内存使用量：     8.5 GB    (1位小数)  
网络延迟：       15.67 ms  (2位小数)
错误率：         0.05%     (2位小数)
QPS：           1,234     (整数即可)
```

---

## 4. 📏 单位设置详解


### 4.1 单位设置的作用


**🔸 让数据更有意义**
```
没有单位：75        → 75是什么？不知道
有单位：  75%       → 明确是百分比
有单位：  75 MB/s   → 明确是网络速度
```

### 4.2 常用单位分类


**⚡ 系统监控单位**
```
时间类：
- s (秒)、ms (毫秒)、μs (微秒)
- m (分钟)、h (小时)、d (天)

数据量：
- bytes、KB、MB、GB、TB
- bits、Kbits、Mbits、Gbits

速率：
- MB/s、KB/s、packets/s、ops/s
- requests/sec、writes/sec
```

**📊 业务监控单位**
```
数量：
- short (自动K/M/B后缀)
- none (纯数字)

货币：
- currencyUSD ($)
- currencyEUR (€)
- currencyYEN (¥)

百分比：
- percent (0-100)
- percentunit (0-1)
```

### 4.3 单位设置实践


**🔧 配置路径**
```
Field → Standard options → Unit
```

**💡 选择建议**
```
✅ 根据监控指标选择合适单位：
- CPU/内存使用率 → percent (0-100)
- 磁盘空间 → bytes
- 网络流量 → bytes/sec
- 响应时间 → ms
- QPS → short

❌ 避免的错误：
- 不设置单位（用户困惑）
- 单位与数据不匹配（显示错误）
```

---

## 5. 🎯 阈值配置与应用


### 5.1 阈值的概念与作用


**🔸 什么是阈值**
```
阈值就像"警戒线"：

安全区域：    0% ────────── 70%     [绿色]
警告区域：   70% ────────── 90%     [黄色] 
危险区域：   90% ────────── 100%    [红色]

当数值超过阈值时，自动改变颜色提醒用户
```

**💡 阈值的实际价值**
- **预警功能**：提前发现问题
- **优先级排序**：快速识别最紧急的问题
- **视觉管理**：一眼看出系统状态

### 5.2 阈值配置方法


**🔧 基础阈值设置**
```
Field → Thresholds → Add threshold

配置示例：
阈值1：0    → 绿色 (正常)
阈值2：70   → 黄色 (警告)  
阈值3：90   → 红色 (危险)
```

**📊 阈值配置界面**
```
┌─────────────────────────────────┐
│ Thresholds                      │
├─────────────────────────────────┤
│ ● Base     [绿色] Value: 0      │
│ ● Warning  [黄色] Value: 70     │  
│ ● Critical [红色] Value: 90     │
│                                 │
│ [+ Add threshold]               │
└─────────────────────────────────┘
```

### 5.3 不同类型监控的阈值设置


**⚡ 系统监控阈值建议**
```
CPU使用率：
0-70%   → 绿色 (正常)
70-90%  → 黄色 (需要关注)
90-100% → 红色 (需要处理)

内存使用率：
0-80%   → 绿色 (正常)
80-95%  → 黄色 (警告)
95-100% → 红色 (紧急)

磁盘使用率：
0-85%   → 绿色 (正常)
85-95%  → 黄色 (警告)
95-100% → 红色 (严重)
```

**📈 业务监控阈值示例**
```
API响应时间：
0-200ms   → 绿色 (优秀)
200-500ms → 黄色 (一般)
500ms+    → 红色 (慢)

错误率：
0-1%   → 绿色 (正常)
1-5%   → 黄色 (关注)
5%+    → 红色 (异常)
```

---

## 6. 🎨 颜色映射机制


### 6.1 颜色映射的工作原理


**🔸 基本概念**
```
颜色映射 = 根据数值大小自动选择颜色

数值范围     对应颜色        视觉效果
0-70       → 绿色        → 一切正常
70-90      → 黄色        → 需要注意  
90-100     → 红色        → 立即处理
```

**🎯 颜色心理学应用**
- **绿色**：安全、正常、健康
- **黄色**：警告、注意、准备
- **红色**：危险、紧急、异常
- **蓝色**：信息、中性、默认

### 6.2 颜色模式选择


**🔧 三种颜色模式**

| 模式类型 | **特点** | **适用场景** |
|---------|---------|-------------|
| `Value` | `根据实际数值` | `有明确阈值的指标` |
| `Percentage` | `根据百分比` | `使用率类指标` |
| `Palette` | `自定义色板` | `特殊业务需求` |

### 6.3 自定义颜色方案


**🎨 色彩搭配原则**
```
经典方案（推荐）：
正常：#52c41a (绿色)
警告：#faad14 (黄色)  
错误：#f5222d (红色)

企业方案：
正常：#1890ff (蓝色)
警告：#fa8c16 (橙色)
错误：#ff4d4f (红色)
```

---

## 7. 📈 趋势指示器使用


### 7.1 趋势指示器是什么


**🔸 直观解释**
```
趋势指示器就像股票的涨跌箭头：

当前值：75%
与之前比较：
↗ +5%   → 上升趋势 (可能需要关注)
↘ -3%   → 下降趋势 (情况在改善)
→ 0%    → 保持稳定 (没有变化)
```

**💡 趋势的价值**
- **变化感知**：知道是好转还是恶化
- **预测能力**：预判未来趋势
- **决策支持**：是否需要干预

### 7.2 趋势计算方式


**📊 时间窗口设置**
```
Stat panel → Options → Calculation

选项说明：
- Last：最新值
- Last (non-null)：最新非空值
- Difference：与上一个值的差异
- Difference percent：百分比差异
```

**🔧 趋势配置步骤**
```
步骤1：启用趋势显示
Graph styles → Show trend

步骤2：选择计算方式  
Calculation → Difference percent

步骤3：设置时间范围
通常使用最近5-15分钟的数据对比
```

### 7.3 趋势指示器样式


**🎨 显示样式选项**
```
箭头样式：
↗ ↘ →    (简单箭头)
⬆ ⬇ ➡   (粗箭头)
△ ▽ ◊    (三角形)

颜色设置：
上升：红色 (通常表示使用率增加，需要关注)
下降：绿色 (通常表示使用率降低，情况改善)
持平：灰色 (没有明显变化)
```

---

## 8. 🚀 实际应用场景


### 8.1 系统监控大屏


**💻 服务器监控面板布局**
```
┌─────────────┬─────────────┬─────────────┬─────────────┐
│ CPU使用率   │ 内存使用率  │ 磁盘使用率  │ 网络流量    │
│             │             │             │             │
│    68%      │    45%      │    89%      │  156 MB/s   │
│   ↗ +3%     │   ↘ -2%     │   ↗ +12%    │   ↗ +45%    │
│  [绿色]     │  [绿色]     │  [红色]     │  [黄色]     │
└─────────────┴─────────────┴─────────────┴─────────────┘

一眼看出：磁盘空间紧张，需要立即处理！
```

### 8.2 业务监控KPI


**📊 电商业务监控示例**
```
┌──────────────┬──────────────┬──────────────┬──────────────┐
│ 在线用户数   │ 今日订单数   │ 支付成功率   │ 平均响应时间 │
│              │              │              │              │
│   12,456     │    2,891     │   98.5%      │   145 ms     │
│   ↗ +8%      │   ↗ +15%     │   ↘ -0.2%    │   ↗ +12%     │
│  [绿色]      │  [绿色]      │  [黄色]      │  [绿色]      │
└──────────────┴──────────────┴──────────────┴──────────────┘

分析：订单增长良好，但支付成功率略降，响应时间略慢
```

### 8.3 告警统计面板


**⚠️ 告警状态监控**
```
当前告警统计：
┌─────────────┬─────────────┬─────────────┐
│ 严重告警    │ 警告告警    │ 信息告警    │
│             │             │             │
│     3       │     12      │     28      │
│   ↗ +1      │   ↘ -2      │   ↗ +5      │
│  [红色]     │  [黄色]     │  [蓝色]     │
└─────────────┴─────────────┴─────────────┘
```

### 8.4 配置最佳实践


**✅ 推荐做法**
```
1. 标题清晰：
   ❌ "metric_cpu"
   ✅ "CPU使用率"

2. 单位明确：
   ❌ 显示 "75"
   ✅ 显示 "75%"

3. 阈值合理：
   ❌ 95%才警告 (太晚了)
   ✅ 80%开始警告 (有缓冲时间)

4. 颜色直观：
   ✅ 绿色=好，黄色=注意，红色=危险

5. 趋势有用：
   ✅ 显示与1小时前的对比
   ❌ 显示与1秒前的对比 (变化太频繁)
```

**❌ 常见错误**
```
- 阈值设置不合理 (90%才警告，来不及处理)
- 没有设置单位 (用户不知道数值含义)
- 颜色使用混乱 (红色表示正常)
- 趋势时间太短 (变化太频繁，没有参考价值)
- 面板标题不清楚 (metric名称对用户无意义)
```

---

## 9. 📋 核心要点总结


### 9.1 必须掌握的核心概念


```
🔸 Stat面板：专门显示单个关键数值的面板类型
🔸 数值格式：让原始数据变得易读易懂
🔸 单位设置：为数值添加含义，避免歧义
🔸 阈值配置：设置警戒线，自动状态提醒
🔸 颜色映射：根据数值自动改变颜色
🔸 趋势指示器：显示数值变化方向和幅度
```

### 9.2 关键理解要点


**🔹 单值图的核心价值**
```
解决问题：在有限空间内展示关键信息
设计理念：一目了然，重点突出
使用原则：大字体数值 + 状态颜色 + 变化趋势
```

**🔹 配置的核心思路**
```
数据层面：选择合适的查询和计算方式
显示层面：设置合理的格式、单位、精度
状态层面：配置有意义的阈值和颜色
趋势层面：显示有参考价值的变化信息
```

**🔹 实用配置原则**
```
简洁明了：避免信息过载
色彩清晰：使用直观的颜色映射
阈值合理：预留足够的反应时间  
趋势有用：选择合适的对比时间窗口
```

### 9.3 实际应用价值


**🎯 监控大屏应用**
- **快速识别**：一眼看出系统状态
- **优先级管理**：红色>黄色>绿色处理顺序
- **趋势预警**：提前发现潜在问题
- **决策支持**：基于数据的客观判断

**🔧 配置实践要点**
- **以用户为中心**：考虑谁会看这个面板
- **业务导向**：阈值设置要符合业务实际
- **持续优化**：根据使用反馈调整配置
- **标准化**：团队内保持一致的配置规范

**核心记忆**：
- 单值图专为关键数值显示而生
- 格式+单位+阈值+颜色构成完整配置
- 趋势指示器让静态数值有了"生命力"
- 好的配置让监控数据"会说话"