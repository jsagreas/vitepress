---
title: 4、介质访问控制与CSMA协议
---
## 📚 目录

1. [介质访问控制概述](#1-介质访问控制概述)
2. [信道划分协议](#2-信道划分协议)
3. [随机访问协议](#3-随机访问协议)
4. [CSMA协议详解](#4-CSMA协议详解)
5. [轮询访问协议](#5-轮询访问协议)
6. [核心要点总结](#6-核心要点总结)

---

## 1. 🚦 介质访问控制概述


### 1.1 MAC的基本概念


**🔸 核心定义**
```
介质访问控制（MAC - Medium Access Control）：
控制多个设备对共享传输介质访问的协议和机制
目标：有序、高效地使用共享信道资源
应用：广播链路、多点连接网络
```

### 1.2 共享介质的挑战


**📡 多点访问问题**
```
核心挑战：多个设备同时发送导致信号冲突
问题表现：
🔸 信号碰撞：同时传输导致信号重叠失真
🔸 数据丢失：冲突的数据无法正确接收
🔸 效率下降：冲突导致重传，浪费带宽
🔸 不公平：某些设备可能长期无法接入

解决目标：
• 避免或减少冲突
• 提高信道利用率
• 保证访问公平性
• 适应网络负载变化
```

### 1.3 MAC协议分类


**📊 协议分类体系**
```
MAC协议分类
├── 🏗️ 信道划分协议（Channel Partitioning）
│   ├── 频分多址（FDMA）
│   ├── 时分多址（TDMA）
│   └── 码分多址（CDMA）
├── 🎲 随机访问协议（Random Access）
│   ├── ALOHA协议
│   ├── CSMA协议
│   └── CSMA/CD、CSMA/CA
└── 🔄 轮询协议（Taking Turns）
    ├── 轮询（Polling）
    └── 令牌传递（Token Passing）
```

---

## 2. 🏗️ 信道划分协议


### 2.1 频分多址（FDMA）


#### 🔸 基本原理


**📻 FDMA工作机制**
```
基本思想：将信道的频率资源划分成多个子频段
分配方式：每个用户独占一个频段
特点：用户间在频域上分离，时域上共享

频谱分配示例：
用户1: |████|    |    |    |    | 
用户2: |    |████|    |    |    |
用户3: |    |    |████|    |    |
用户4: |    |    |    |████|    |
保护带:|    |    |    |    |████|
频率:  f1   f2   f3   f4   f5
```

#### 🔸 FDMA特点分析


**✅ 主要优势**
```
🔸 无冲突：用户间频段隔离，不会相互干扰
🔸 容量固定：每个用户有固定的传输容量
🔸 延迟确定：无需等待，可立即传输
🔸 技术成熟：模拟通信时代就广泛应用
```

**❌ 固有缺陷**
```
🔸 频谱浪费：用户不活跃时频段空闲
🔸 保护带开销：相邻频段需要保护带宽
🔸 硬件复杂：需要精确的频率控制
🔸 灵活性差：用户数量和带宽分配相对固定
```

### 2.2 时分多址（TDMA）


#### 🔸 基本原理


**⏰ TDMA工作机制**
```
基本思想：将时间划分成周期性的时隙
分配方式：每个用户在指定时隙内独占全部带宽
特点：用户间在时域上分离，频域上共享

时隙分配示例：
时间轴: |─T1─|─T2─|─T3─|─T4─|─T1─|─T2─|─T3─|─T4─|
用户1:  |████|    |    |    |████|    |    |    |
用户2:  |    |████|    |    |    |████|    |    |
用户3:  |    |    |████|    |    |    |████|    |
用户4:  |    |    |    |████|    |    |    |████|
```

#### 🔸 TDMA实现要点


**🔧 技术要求**
```
🔸 精确同步：所有用户必须严格时间同步
🔸 时隙保护：时隙间需要保护时间防止重叠
🔸 帧结构：定义时隙在帧中的组织方式
🔸 时隙分配：根据用户需求分配时隙数量

同步方法：
• 主站同步：中心站发送同步信号
• GPS同步：使用GPS提供时间基准
• 网络同步：通过协议实现同步
```

### 2.3 码分多址（CDMA）


#### 🔸 基本原理


**🔐 CDMA工作机制**
```
基本思想：每个用户使用唯一的码序列调制数据
分配方式：所有用户同时使用相同频率和时间
特点：用户间在码域上分离，频域时域共享

码片序列特性：
• 正交性：不同用户的码序列相互正交
• 自相关：码序列与自身相关性强
• 互相关：码序列与其他码序列相关性弱
```

#### 🔸 CDMA编码示例


**💡 码分复用过程**
```
示例设置：
用户A码片：[+1, -1, +1, -1]
用户B码片：[+1, +1, -1, -1]

数据编码：
用户A发送1：[+1, -1, +1, -1] × 1 = [+1, -1, +1, -1]
用户A发送0：[+1, -1, +1, -1] × (-1) = [-1, +1, -1, +1]
用户B发送1：[+1, +1, -1, -1] × 1 = [+1, +1, -1, -1]

信道合成：
A发1 + B发1 = [+1, -1, +1, -1] + [+1, +1, -1, -1] = [+2, 0, 0, -2]

接收解码：
A的接收：[+2, 0, 0, -2] · [+1, -1, +1, -1] = 2-0+0+2 = 4 → 1
B的接收：[+2, 0, 0, -2] · [+1, +1, -1, -1] = 2+0+0+2 = 4 → 1
```

### 2.4 信道划分协议对比


| 协议类型 | **分离域** | **容量分配** | **同步要求** | **适用场景** |
|---------|-----------|-------------|-------------|-------------|
| **FDMA** | `频域` | `固定分配` | `低` | `语音通信、广播` |
| **TDMA** | `时域` | `动态可调` | `高` | `数字移动通信` |
| **CDMA** | `码域` | `软容量` | `中等` | `3G移动通信、GPS` |

---

## 3. 🎲 随机访问协议


### 3.1 ALOHA协议


#### 🔸 纯ALOHA协议


**📡 纯ALOHA工作原理**
```
基本思想：用户有数据就立即发送，不进行载波检测
冲突处理：发生冲突后等待随机时间再重传
特点：完全分布式，无需中央控制

工作流程：
1. 有数据需要发送时立即发送
2. 设置定时器等待确认
3. 超时未收到确认则认为发生冲突
4. 等待随机时间后重传
5. 重复直到成功或放弃
```

#### 🔸 时隙ALOHA协议


**⏰ 时隙ALOHA改进**
```
改进思想：将时间划分成时隙，只能在时隙开始时发送
优势：减少冲突时间，提高信道利用率
代价：需要全网时钟同步

时隙对齐效果：
纯ALOHA冲突：
帧1: |████████|
帧2:    |████████|  ← 部分重叠也冲突
      时间→

时隙ALOHA：
时隙: |─────────|─────────|─────────|
帧1:  |████████|         |         |
帧2:  |         |████████|         |
                ↑ 要么完全重叠，要么不重叠
```

#### 🔸 ALOHA性能分析


**📊 吞吐量分析**
```
纯ALOHA最大吞吐量：
S = G × e^(-2G)
最大值：S_max = 1/(2e) ≈ 0.184 (18.4%)

时隙ALOHA最大吞吐量：
S = G × e^(-G)  
最大值：S_max = 1/e ≈ 0.368 (36.8%)

其中：
S = 成功传输的帧数/时间单位
G = 尝试传输的帧数/时间单位（包括重传）
```

### 3.2 ALOHA协议的优缺点


**✅ 主要优势**
```
🔸 简单易实现：无需复杂的协调机制
🔸 完全分布：无需中央控制节点
🔸 延迟小：有数据立即可以发送
🔸 适应性强：用户数量变化适应性好
```

**❌ 主要缺陷**
```
🔸 效率低：最大信道利用率仅36.8%
🔸 不稳定：高负载时性能急剧下降
🔸 不公平：重传机制可能导致不公平
🔸 冲突严重：网络负载高时冲突频繁
```

---

## 4. 🔍 CSMA协议详解


### 4.1 载波监听多址访问（CSMA）


#### 🔸 基本概念


**📡 CSMA核心思想**
```
载波监听（Carrier Sense）：发送前先监听信道
多址访问（Multiple Access）：多用户共享信道
基本原则："先听后说"

改进原理：
通过监听减少冲突概率，提高信道利用率
比ALOHA更智能的接入策略
```

#### 🔸 CSMA监听策略


**🔸 1-坚持CSMA**
```
算法流程：
1. 需要发送时，监听信道
2. 如果信道空闲，立即发送
3. 如果信道忙，持续监听
4. 一旦信道空闲，立即发送
5. 如果冲突，等待随机时间重复过程

特点：
• 发送延迟小
• 冲突概率较高（多站同时检测到空闲）
```

**🔸 非坚持CSMA**
```
算法流程：
1. 需要发送时，监听信道
2. 如果信道空闲，立即发送
3. 如果信道忙，等待随机时间后重新监听
4. 重复直到发送成功

特点：
• 冲突概率较低
• 可能浪费信道空闲时间
• 平均延迟较大
```

**🔸 p-坚持CSMA**
```
算法流程：
1. 监听信道，如果忙则等待
2. 如果空闲，以概率p发送数据
3. 以概率(1-p)推迟到下一个时隙
4. 如果下一时隙仍空闲，重复步骤2-3

特点：
• 平衡了冲突概率和延迟
• p值可以根据网络负载调整
• 适用于时隙化系统
```

### 4.2 CSMA/CD协议


#### 🔸 冲突检测机制


**⚡ CSMA/CD原理**
```
CSMA/CD = CSMA + Collision Detection
核心改进：边发送边监听，检测到冲突立即停止

工作原理：
1. 载波监听：发送前监听信道
2. 开始发送：信道空闲时开始发送
3. 冲突检测：发送过程中持续监听
4. 立即停止：检测到冲突立即停止发送
5. 发送干扰信号：确保所有站点都检测到冲突
6. 随机退避：等待随机时间后重试
```

#### 🔸 冲突检测实现


**🔧 检测方法**
```
电气检测：
• 比较发送信号和接收信号
• 不一致表明发生冲突
• 适用于总线型网络

信号强度检测：
• 监测信号功率水平
• 超过阈值表明多个信号叠加
• 需要精确的功率控制
```

#### 🔸 最小帧长计算


**📏 最小帧长原理**
```
问题：确保冲突能被及时检测到
要求：在最坏情况下，发送站能检测到冲突

最坏情况分析：
• 站A开始发送
• 信号即将到达最远站B时，B也开始发送
• 冲突发生，冲突信号需要传播回A
• A必须在帧发送完成前检测到冲突

计算公式：
最小帧长 = 2 × 传播时延 × 数据率
T_min = 2 × (L_max / v) × R

其中：
L_max = 网络最大物理距离
v = 信号传播速度
R = 数据传输速率
```

**💡 以太网最小帧长示例**
```
10Mbps以太网参数：
• 最大网段长度：2500m
• 信号传播速度：2×10⁸ m/s
• 数据传输速率：10×10⁶ bps

计算过程：
传播时延 = 2500m ÷ (2×10⁸ m/s) = 12.5μs
往返时延 = 2 × 12.5μs = 25μs
最小帧长 = 25μs × 10×10⁶ bps = 250 bit = 31.25字节

标准取值：64字节（512位）
```

#### 🔸 二进制指数退避算法


**🎲 退避算法原理**
```
目的：分散冲突站点的重传时间
方法：退避时间随冲突次数指数增长

算法步骤：
1. 第k次冲突后，选择退避参数n
2. n从{0, 1, 2, ..., 2^k - 1}中随机选择
3. 退避时间 = n × 时隙时间
4. k最大值通常为10，避免退避时间过长

示例：
第1次冲突：n ∈ {0, 1}，退避0或1个时隙
第2次冲突：n ∈ {0, 1, 2, 3}，退避0-3个时隙
第3次冲突：n ∈ {0, 1, 2, ..., 7}，退避0-7个时隙
```

### 4.3 CSMA/CA协议


#### 🔸 冲突避免机制


**📶 CSMA/CA原理**
```
CSMA/CA = CSMA + Collision Avoidance
应用场景：无线网络（难以实现冲突检测）
核心思想：尽量避免冲突发生

基本机制：
1. 载波监听：监听信道是否空闲
2. 随机退避：即使信道空闲也要退避
3. 发送数据：退避结束后发送
4. 等待确认：接收方发送ACK确认
5. 未收到ACK则重传
```

#### 🔸 RTS/CTS机制


**🤝 握手协议**
```
RTS/CTS目的：解决隐藏终端问题
工作流程：

1. 发送方发送RTS（Request to Send）
   包含：源地址、目标地址、传输时间

2. 接收方回复CTS（Clear to Send）  
   包含：传输时间信息

3. 周围节点收到RTS/CTS后：
   • 设置NAV（Network Allocation Vector）
   • 在指定时间内不发送数据

4. 数据传输：
   • 发送方开始发送数据
   • 接收方发送ACK确认

5. 传输完成：
   • NAV超时，其他节点可以竞争信道
```

**📊 隐藏终端问题解决**
```
问题场景：
A ←→ B ←→ C
A和C相互听不到，但都能与B通信

不使用RTS/CTS：
• A向B发送数据
• C检测信道空闲（听不到A）
• C也向B发送数据
• 在B处发生冲突

使用RTS/CTS：
• A向B发送RTS
• B回复CTS（A和C都能听到）
• C收到CTS，设置NAV，暂停发送
• A成功向B发送数据
```

---

## 5. 🔄 轮询访问协议


### 5.1 轮询协议（Polling）


#### 🔸 基本原理


**🎯 轮询机制**
```
基本思想：由主节点轮流询问各从节点是否有数据要发送
控制方式：集中控制，主从结构
适用场景：终端数量不多，数据量不大的环境

工作流程：
1. 主节点发送轮询消息给第一个从节点
2. 从节点有数据则发送，无数据则回复空应答
3. 主节点继续轮询下一个从节点
4. 循环轮询所有从节点
5. 可以根据优先级调整轮询顺序
```

#### 🔸 轮询协议特点


**✅ 主要优势**
```
🔸 无冲突：完全避免了数据冲突
🔸 可控性强：主节点完全控制访问顺序
🔸 公平性好：可以保证每个节点的访问机会
🔸 效率可预测：性能相对稳定
```

**❌ 主要缺陷**
```
🔸 轮询开销：每次轮询都有协议开销
🔸 延迟大：必须等待轮询才能发送
🔸 单点故障：主节点故障影响整个网络
🔸 扩展性差：节点增加时轮询周期增长
```

### 5.2 令牌传递协议


#### 🔸 基本原理


**🎫 令牌机制**
```
基本思想：在网络中传递一个令牌，只有持有令牌的站点才能发送数据
控制方式：分布式控制，无主从关系
网络拓扑：通常采用环型或总线型

工作流程：
1. 令牌在网络中按预定顺序传递
2. 站点收到令牌时检查是否有数据要发送
3. 有数据则持有令牌并发送数据
4. 发送完成后立即释放令牌
5. 令牌继续传递给下一个站点
```

#### 🔸 令牌环网络


**💍 令牌环特点**
```
物理拓扑：站点连接成环形
逻辑拓扑：令牌按环方向传递
IEEE标准：IEEE 802.5

令牌帧格式：
┌──────┬──────┬──────┐
│ SD   │ AC   │ ED   │
└──────┴──────┴──────┘
SD: 起始定界符
AC: 访问控制（包含令牌位）
ED: 结束定界符

数据帧格式：
┌──────┬──────┬────────┬──────┬────────┬──────┐
│ SD   │ AC   │ FC     │ 地址  │ 数据    │ ED   │
└──────┴──────┴────────┴──────┴────────┴──────┘
```

#### 🔸 令牌传递特点


**✅ 主要优势**
```
🔸 无冲突：令牌控制保证无数据冲突
🔸 公平访问：每个站点都有平等的访问机会
🔸 性能稳定：重负载下性能不会急剧下降
🔸 实时性好：最大访问延迟可以预测
🔸 高效率：轻载时延迟小，重载时利用率高
```

**❌ 主要缺陷**
```
🔸 令牌管理：令牌丢失或重复需要特殊处理
🔸 故障恢复：站点故障可能影响令牌传递
🔸 维护复杂：需要复杂的环维护机制
🔸 扩展困难：添加新站点需要重构环
```

---

## 6. 📋 核心要点总结


### 6.1 必须掌握的基本概念


```
🔸 MAC分类：信道划分、随机访问、轮询访问三大类
🔸 CSMA原理：载波监听多址访问，"先听后说"
🔸 CSMA/CD：冲突检测，边发边听，适用于有线网络
🔸 CSMA/CA：冲突避免，RTS/CTS机制，适用于无线网络
🔸 性能权衡：效率、公平性、复杂度的平衡
```

### 6.2 关键理解要点


**🔹 协议选择原则**
```
网络特性匹配：
• 有线网络：CSMA/CD（以太网）
• 无线网络：CSMA/CA（WiFi）
• 实时系统：令牌传递（确定性延迟）
• 简单系统：轮询（集中控制）

性能需求：
• 高效率：随机访问协议
• 高可靠：信道划分或轮询
• 低延迟：CSMA系列协议
• 公平性：令牌传递
```

**🔹 技术演进趋势**
```
从简单到智能：
ALOHA → CSMA → CSMA/CD → CSMA/CA

从冲突到避免：
随机发送 → 载波监听 → 冲突检测 → 冲突避免

从有线到无线：
总线共享 → 点对点连接 → 无线信道竞争
```

**🔹 实际应用考虑**
```
工程实践：
• 以太网：CSMA/CD + 交换技术
• WiFi：CSMA/CA + 多天线技术
• 蓝牙：跳频 + 时分复用
• 移动通信：TDMA/CDMA/OFDMA
```

### 6.3 性能分析要点


**📊 关键性能指标**
```
🔸 吞吐量：单位时间成功传输的数据量
🔸 延迟：从发送请求到成功传输的时间
🔸 公平性：各节点获得服务的公平程度
🔸 稳定性：负载变化时性能的稳定性
```

**📈 协议性能对比**

| 协议类型 | **最大吞吐量** | **延迟特性** | **公平性** | **复杂度** |
|---------|-------------|-------------|-----------|-----------|
| **ALOHA** | `36.8%` | `不稳定` | `差` | `低` |
| **CSMA/CD** | `>90%` | `低负载时小` | `较好` | `中` |
| **令牌传递** | `接近100%` | `可预测` | `好` | `高` |
| **轮询** | `取决于轮询开销` | `轮询周期限制` | `完全公平` | `中` |

### 6.4 实际应用价值


**📚 网络理解**
- **协议原理**：理解不同MAC协议的工作机制
- **性能分析**：掌握协议性能评估方法
- **应用场景**：根据需求选择合适的协议

**🔧 工程实践**
- **网络设计**：选择合适的MAC机制
- **参数优化**：调整协议参数提高性能
- **故障诊断**：基于协议原理分析网络问题

**🚀 技术发展**
- **新技术理解**：理解现代网络技术的MAC机制
- **创新应用**：基于基本原理进行技术创新
- **标准演进**：跟踪MAC技术的发展趋势

**核心记忆**：
- MAC协议解决多用户共享信道的访问控制问题
- CSMA/CD是有线网络的经典解决方案
- CSMA/CA是无线网络的主流技术
- 不同协议在性能、复杂度、应用场景上各有特点
- 理解协议原理有助于网络设计和问题诊断