---
title: 5ã€è·¯ç”±å®ˆå«ä¸æƒé™æ§åˆ¶
---
## ğŸ“š ç›®å½•

1. [ä»€ä¹ˆæ˜¯è·¯ç”±å®ˆå«](#1-ä»€ä¹ˆæ˜¯è·¯ç”±å®ˆå«)
2. [å…¨å±€è·¯ç”±å®ˆå«](#2-å…¨å±€è·¯ç”±å®ˆå«)
3. [è·¯ç”±ç‹¬äº«å®ˆå«](#3-è·¯ç”±ç‹¬äº«å®ˆå«)
4. [ç»„ä»¶å†…å®ˆå«](#4-ç»„ä»¶å†…å®ˆå«)
5. [å¯¼èˆªè§£ææµç¨‹](#5-å¯¼èˆªè§£ææµç¨‹)
6. [è·¯ç”±å…ƒä¿¡æ¯meta](#6-è·¯ç”±å…ƒä¿¡æ¯meta)
7. [æƒé™æ§åˆ¶å®è·µ](#7-æƒé™æ§åˆ¶å®è·µ)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ›¡ï¸ ä»€ä¹ˆæ˜¯è·¯ç”±å®ˆå«


### 1.1 è·¯ç”±å®ˆå«çš„æœ¬è´¨


**ç®€å•ç†è§£**ï¼šè·¯ç”±å®ˆå«å°±åƒæ˜¯é—¨å«ï¼Œåœ¨ç”¨æˆ·è¿›å…¥é¡µé¢ä¹‹å‰æ£€æŸ¥èº«ä»½å’Œæƒé™

```
ç”¨æˆ·ç‚¹å‡»é“¾æ¥ â†’ è·¯ç”±å®ˆå«æ£€æŸ¥ â†’ å†³å®šæ˜¯å¦å…è®¸è¿›å…¥
                  â†“
              âœ… å…è®¸ï¼šæ­£å¸¸è·³è½¬
              âŒ æ‹’ç»ï¼šé‡å®šå‘æˆ–é˜»æ­¢
```

**ğŸ”¸ æ ¸å¿ƒä½œç”¨**
- **æƒé™éªŒè¯**ï¼šæ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰è®¿é—®æƒé™
- **ç™»å½•æ‹¦æˆª**ï¼šæœªç™»å½•ç”¨æˆ·è·³è½¬åˆ°ç™»å½•é¡µ
- **æ•°æ®é¢„åŠ è½½**ï¼šè¿›å…¥é¡µé¢å‰å‡†å¤‡æ•°æ®
- **é¡µé¢åŸ‹ç‚¹**ï¼šè®°å½•ç”¨æˆ·è®¿é—®è¡Œä¸º

### 1.2 è·¯ç”±å®ˆå«çš„ç±»å‹


```
è·¯ç”±å®ˆå«åˆ†ç±»ï¼š

ğŸŒ å…¨å±€å®ˆå«
â”œâ”€ beforeEach     ï¼ˆè¿›å…¥å‰æ£€æŸ¥ï¼‰
â”œâ”€ beforeResolve  ï¼ˆè§£æå®Œæˆå‰ï¼‰
â””â”€ afterEach      ï¼ˆè¿›å…¥åæ‰§è¡Œï¼‰

ğŸ  è·¯ç”±ç‹¬äº«å®ˆå«
â””â”€ beforeEnter    ï¼ˆå•ä¸ªè·¯ç”±ä¸“ç”¨ï¼‰

ğŸ§© ç»„ä»¶å†…å®ˆå«
â”œâ”€ beforeRouteEnter  ï¼ˆè¿›å…¥ç»„ä»¶å‰ï¼‰
â”œâ”€ beforeRouteUpdate ï¼ˆè·¯ç”±æ›´æ–°æ—¶ï¼‰
â””â”€ beforeRouteLeave  ï¼ˆç¦»å¼€ç»„ä»¶å‰ï¼‰
```

---

## 2. ğŸŒ å…¨å±€è·¯ç”±å®ˆå«


### 2.1 å…¨å±€å‰ç½®å®ˆå« beforeEach


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**ï¼šæœ€å¸¸ç”¨çš„å®ˆå«ï¼Œåœ¨æ¯æ¬¡è·¯ç”±è·³è½¬**å‰**æ‰§è¡Œ

```javascript
// åœ¨è·¯ç”±å™¨é…ç½®ä¸­è®¾ç½®
router.beforeEach((to, from, next) => {
  // to: å³å°†è¿›å…¥çš„è·¯ç”±å¯¹è±¡
  // from: å½“å‰å¯¼èˆªæ­£è¦ç¦»å¼€çš„è·¯ç”±
  // next: æ§åˆ¶å¯¼èˆªçš„å‡½æ•°
  
  console.log('å‡†å¤‡ä»', from.path, 'è·³è½¬åˆ°', to.path)
  next() // å¿…é¡»è°ƒç”¨next()æ‰èƒ½ç»§ç»­å¯¼èˆª
})
```

**ğŸ”§ å‚æ•°è¯¦è§£**

| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `to` | Routeå¯¹è±¡ | å³å°†è¿›å…¥çš„ç›®æ ‡è·¯ç”± |
| `from` | Routeå¯¹è±¡ | å½“å‰å¯¼èˆªæ­£è¦ç¦»å¼€çš„è·¯ç”± |
| `next` | Function | **å¿…é¡»è°ƒç”¨**ï¼Œæ§åˆ¶å¯¼èˆªè¡Œä¸º |

**ğŸ’¡ next() çš„ç”¨æ³•**

```javascript
// âœ… æ­£ç¡®ç”¨æ³•
next()                    // ç»§ç»­å¯¼èˆª
next(false)              // ä¸­æ–­å¯¼èˆª
next('/login')           // è·³è½¬åˆ°æŒ‡å®šè·¯å¾„
next({ name: 'Login' })  // è·³è½¬åˆ°æŒ‡å®šè·¯ç”±

// âŒ é”™è¯¯ç”¨æ³•
// å¿˜è®°è°ƒç”¨next() - å¯¼èˆªä¼šå¡ä½ï¼
```

### 2.2 ç®€å•ç™»å½•æ‹¦æˆªç¤ºä¾‹


```javascript
router.beforeEach((to, from, next) => {
  // è·å–tokenï¼ˆå‡è®¾å­˜åœ¨localStorageä¸­ï¼‰
  const token = localStorage.getItem('token')
  
  // éœ€è¦ç™»å½•çš„é¡µé¢åˆ—è¡¨
  const needAuth = ['/profile', '/dashboard', '/admin']
  
  // æ£€æŸ¥å½“å‰é¡µé¢æ˜¯å¦éœ€è¦ç™»å½•
  if (needAuth.includes(to.path)) {
    if (token) {
      next() // æœ‰tokenï¼Œå…è®¸è®¿é—®
    } else {
      next('/login') // æ²¡tokenï¼Œè·³è½¬ç™»å½•
    }
  } else {
    next() // ä¸éœ€è¦ç™»å½•çš„é¡µé¢ï¼Œç›´æ¥é€šè¿‡
  }
})
```

### 2.3 å…¨å±€è§£æå®ˆå« beforeResolve


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**ï¼šåœ¨å¯¼èˆªè¢«ç¡®è®¤ä¹‹å‰ï¼ŒåŒæ—¶åœ¨æ‰€æœ‰ç»„ä»¶å†…å®ˆå«å’Œå¼‚æ­¥è·¯ç”±ç»„ä»¶è¢«è§£æä¹‹åè°ƒç”¨

```javascript
router.beforeResolve((to, from, next) => {
  // åœ¨è¿™é‡Œå¯ä»¥ç¡®ä¿æ‰€æœ‰ç»„ä»¶éƒ½å·²ç»å‡†å¤‡å¥½äº†
  console.log('è·¯ç”±å³å°†è§£æå®Œæˆ')
  next()
})
```

> ğŸ’¡ **ä½¿ç”¨åœºæ™¯**ï¼šéœ€è¦ç¡®ä¿æ‰€æœ‰å¼‚æ­¥ç»„ä»¶éƒ½åŠ è½½å®Œæˆåå†æ‰§è¡Œçš„é€»è¾‘

### 2.4 å…¨å±€åç½®å®ˆå« afterEach


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**ï¼šå¯¼èˆª**å®Œæˆå**æ‰§è¡Œï¼Œä¸ä¼šæ”¹å˜å¯¼èˆªæœ¬èº«

```javascript
router.afterEach((to, from) => {
  // æ³¨æ„ï¼šæ²¡æœ‰nextå‚æ•°ï¼Œå› ä¸ºå¯¼èˆªå·²ç»å®Œæˆ
  
  // ä¿®æ”¹é¡µé¢æ ‡é¢˜
  document.title = to.meta.title || 'é»˜è®¤æ ‡é¢˜'
  
  // å‘é€é¡µé¢è®¿é—®ç»Ÿè®¡
  analytics.track('page_view', {
    page: to.path,
    title: to.meta.title
  })
})
```

**ğŸ¯ å¸¸ç”¨åœºæ™¯**
- ä¿®æ”¹é¡µé¢æ ‡é¢˜
- å‘é€è®¿é—®ç»Ÿè®¡
- å…³é—­loadingçŠ¶æ€
- é¡µé¢åŸ‹ç‚¹ç»Ÿè®¡

---

## 3. ğŸ  è·¯ç”±ç‹¬äº«å®ˆå«


### 3.1 beforeEnter å®ˆå«


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**ï¼šåªå¯¹ç‰¹å®šè·¯ç”±ç”Ÿæ•ˆçš„å®ˆå«ï¼Œå†™åœ¨è·¯ç”±é…ç½®ä¸­

```javascript
const routes = [
  {
    path: '/admin',
    component: AdminPanel,
    // åªæœ‰è®¿é—®adminé¡µé¢æ‰ä¼šæ‰§è¡Œè¿™ä¸ªå®ˆå«
    beforeEnter: (to, from, next) => {
      // æ£€æŸ¥æ˜¯å¦æ˜¯ç®¡ç†å‘˜
      const userRole = localStorage.getItem('userRole')
      
      if (userRole === 'admin') {
        next() // æ˜¯ç®¡ç†å‘˜ï¼Œå…è®¸è®¿é—®
      } else {
        next('/') // ä¸æ˜¯ç®¡ç†å‘˜ï¼Œè·³è½¬é¦–é¡µ
      }
    }
  }
]
```

**ğŸ”§ æ•°ç»„å½¢å¼çš„å¤šä¸ªå®ˆå«**

```javascript
// å¯ä»¥ä½¿ç”¨æ•°ç»„å®šä¹‰å¤šä¸ªå®ˆå«
const checkAuth = (to, from, next) => {
  // æ£€æŸ¥ç™»å½•çŠ¶æ€
  next()
}

const checkPermission = (to, from, next) => {
  // æ£€æŸ¥æƒé™
  next()
}

const routes = [
  {
    path: '/vip',
    component: VipPage,
    beforeEnter: [checkAuth, checkPermission] // æŒ‰é¡ºåºæ‰§è¡Œ
  }
]
```

---

## 4. ğŸ§© ç»„ä»¶å†…å®ˆå«


### 4.1 beforeRouteEnter


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**ï¼šåœ¨æ¸²æŸ“è¯¥ç»„ä»¶çš„å¯¹åº”è·¯ç”±è¢«ç¡®è®¤å‰è°ƒç”¨

```vue
<script>
export default {
  name: 'UserProfile',
  
  beforeRouteEnter(to, from, next) {
    // æ³¨æ„ï¼šæ­¤æ—¶ç»„ä»¶å®ä¾‹è¿˜æ²¡åˆ›å»ºï¼Œä¸èƒ½è®¿é—®thisï¼
    
    // è·å–ç”¨æˆ·ID
    const userId = to.params.id
    
    // é¢„åŠ è½½ç”¨æˆ·æ•°æ®
    fetchUserData(userId).then(userData => {
      next(vm => {
        // é€šè¿‡å›è°ƒè®¿é—®ç»„ä»¶å®ä¾‹
        vm.userData = userData
      })
    }).catch(() => {
      next('/404') // åŠ è½½å¤±è´¥è·³è½¬404
    })
  }
}
</script>
```

> âš ï¸ **é‡è¦æé†’**ï¼š`beforeRouteEnter` ä¸­æ— æ³•ç›´æ¥è®¿é—® `this`ï¼Œå› ä¸ºç»„ä»¶è¿˜æ²¡åˆ›å»º

### 4.2 beforeRouteUpdate


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**ï¼šåœ¨å½“å‰è·¯ç”±æ”¹å˜ï¼Œä½†æ˜¯è¯¥ç»„ä»¶è¢«å¤ç”¨æ—¶è°ƒç”¨

```vue
<script>
export default {
  name: 'UserProfile',
  
  beforeRouteUpdate(to, from, next) {
    // è·¯å¾„ä» /user/1 å˜ä¸º /user/2 æ—¶è§¦å‘
    // æ­¤æ—¶å¯ä»¥è®¿é—®thisï¼Œå› ä¸ºç»„ä»¶å·²ç»åˆ›å»º
    
    const userId = to.params.id
    
    // æ›´æ–°ç”¨æˆ·æ•°æ®
    this.loadUserData(userId)
    next()
  },
  
  methods: {
    loadUserData(id) {
      // åŠ è½½ç”¨æˆ·æ•°æ®çš„æ–¹æ³•
    }
  }
}
</script>
```

**ğŸ¯ ä½¿ç”¨åœºæ™¯**ï¼š
- ç”¨æˆ·ä» `/user/1` è·³è½¬åˆ° `/user/2`
- åŒä¸€ä¸ªç»„ä»¶ï¼Œä½†å‚æ•°å˜åŒ–æ—¶

### 4.3 beforeRouteLeave


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**ï¼šå¯¼èˆªç¦»å¼€è¯¥ç»„ä»¶çš„å¯¹åº”è·¯ç”±æ—¶è°ƒç”¨

```vue
<script>
export default {
  name: 'EditForm',
  data() {
    return {
      hasUnsavedChanges: false
    }
  },
  
  beforeRouteLeave(to, from, next) {
    // æ£€æŸ¥æ˜¯å¦æœ‰æœªä¿å­˜çš„æ•°æ®
    if (this.hasUnsavedChanges) {
      const confirmed = confirm('æœ‰æœªä¿å­˜çš„å†…å®¹ï¼Œç¡®å®šè¦ç¦»å¼€å—ï¼Ÿ')
      if (confirmed) {
        next() // ç¡®è®¤ç¦»å¼€
      } else {
        next(false) // å–æ¶ˆç¦»å¼€
      }
    } else {
      next() // æ²¡æœ‰æœªä¿å­˜å†…å®¹ï¼Œç›´æ¥ç¦»å¼€
    }
  }
}
</script>
```

---

## 5. ğŸ”„ å¯¼èˆªè§£ææµç¨‹


### 5.1 å®Œæ•´çš„å¯¼èˆªè§£ææµç¨‹


```
ç”¨æˆ·ç‚¹å‡»è·¯ç”±é“¾æ¥
        â†“
1. å¯¼èˆªè¢«è§¦å‘
        â†“
2. åœ¨å¤±æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteLeave å®ˆå«
        â†“
3. è°ƒç”¨å…¨å±€çš„ beforeEach å®ˆå«
        â†“
4. åœ¨é‡ç”¨çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteUpdate å®ˆå«
        â†“
5. åœ¨è·¯ç”±é…ç½®é‡Œè°ƒç”¨ beforeEnter
        â†“
6. è§£æå¼‚æ­¥è·¯ç”±ç»„ä»¶
        â†“
7. åœ¨è¢«æ¿€æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteEnter
        â†“
8. è°ƒç”¨å…¨å±€çš„ beforeResolve å®ˆå«
        â†“
9. å¯¼èˆªè¢«ç¡®è®¤
        â†“
10. è°ƒç”¨å…¨å±€çš„ afterEach é’©å­
        â†“
11. è§¦å‘ DOM æ›´æ–°
        â†“
12. è°ƒç”¨ beforeRouteEnter å®ˆå«ä¸­ä¼ ç»™ next çš„å›è°ƒå‡½æ•°
```

### 5.2 æ‰§è¡Œé¡ºåºè®°å¿†æŠ€å·§


> ğŸ’¡ **è®°å¿†æ–¹æ³•**ï¼šç¦»å¼€ â†’ å…¨å±€æ£€æŸ¥ â†’ è·¯ç”±æ£€æŸ¥ â†’ ç»„ä»¶æ£€æŸ¥ â†’ ç¡®è®¤ â†’ å®Œæˆ

---

## 6. ğŸ“ è·¯ç”±å…ƒä¿¡æ¯meta


### 6.1 ä»€ä¹ˆæ˜¯è·¯ç”±å…ƒä¿¡æ¯


**ğŸ“‹ åŸºæœ¬æ¦‚å¿µ**ï¼šå­˜å‚¨åœ¨è·¯ç”±é…ç½®ä¸­çš„è‡ªå®šä¹‰ä¿¡æ¯ï¼Œç”¨äºè·¯ç”±å®ˆå«åˆ¤æ–­

```javascript
const routes = [
  {
    path: '/login',
    component: Login,
    meta: { 
      title: 'ç™»å½•',
      requireAuth: false // ä¸éœ€è¦ç™»å½•
    }
  },
  {
    path: '/dashboard',
    component: Dashboard,
    meta: { 
      title: 'ä»ªè¡¨ç›˜',
      requireAuth: true,  // éœ€è¦ç™»å½•
      roles: ['admin', 'user'] // å…è®¸çš„è§’è‰²
    }
  }
]
```

### 6.2 åœ¨è·¯ç”±å®ˆå«ä¸­ä½¿ç”¨meta


```javascript
router.beforeEach((to, from, next) => {
  // è®¾ç½®é¡µé¢æ ‡é¢˜
  document.title = to.meta.title || 'é»˜è®¤æ ‡é¢˜'
  
  // æ£€æŸ¥æ˜¯å¦éœ€è¦ç™»å½•
  if (to.meta.requireAuth) {
    const token = localStorage.getItem('token')
    if (token) {
      next()
    } else {
      next('/login')
    }
  } else {
    next()
  }
})
```

### 6.3 åµŒå¥—è·¯ç”±çš„metaå¤„ç†


```javascript
router.beforeEach((to, from, next) => {
  // to.matched åŒ…å«æ‰€æœ‰åŒ¹é…çš„è·¯ç”±è®°å½•
  const requireAuth = to.matched.some(record => record.meta.requireAuth)
  
  if (requireAuth) {
    // æœ‰ä»»ä½•ä¸€å±‚éœ€è¦è®¤è¯
    checkAuth(next)
  } else {
    next()
  }
})
```

---

## 7. ğŸ” æƒé™æ§åˆ¶å®è·µ


### 7.1 åŸºäºè§’è‰²çš„æƒé™æ§åˆ¶


```javascript
// æƒé™æ£€æŸ¥å·¥å…·å‡½æ•°
function hasPermission(userRoles, routeRoles) {
  if (!routeRoles) return true // æ²¡æœ‰è§’è‰²é™åˆ¶
  return routeRoles.some(role => userRoles.includes(role))
}

// è·¯ç”±é…ç½®
const routes = [
  {
    path: '/admin',
    component: AdminPanel,
    meta: { 
      requireAuth: true,
      roles: ['admin'] // åªæœ‰adminå¯ä»¥è®¿é—®
    }
  },
  {
    path: '/vip',
    component: VipPage,
    meta: { 
      requireAuth: true,
      roles: ['admin', 'vip'] // adminå’Œvipéƒ½å¯ä»¥è®¿é—®
    }
  }
]

// å…¨å±€å®ˆå«
router.beforeEach((to, from, next) => {
  const token = localStorage.getItem('token')
  const userRoles = JSON.parse(localStorage.getItem('userRoles') || '[]')
  
  if (to.meta.requireAuth) {
    if (!token) {
      next('/login')
      return
    }
    
    if (to.meta.roles && !hasPermission(userRoles, to.meta.roles)) {
      next('/403') // æ²¡æœ‰æƒé™
      return
    }
  }
  
  next()
})
```

### 7.2 åŠ¨æ€è·¯ç”±ä¸æƒé™


```javascript
// æ ¹æ®ç”¨æˆ·æƒé™åŠ¨æ€æ·»åŠ è·¯ç”±
function addRoutesBasedOnRole(userRole) {
  const dynamicRoutes = []
  
  if (userRole === 'admin') {
    dynamicRoutes.push({
      path: '/admin-dashboard',
      component: AdminDashboard
    })
  }
  
  if (['admin', 'manager'].includes(userRole)) {
    dynamicRoutes.push({
      path: '/reports',
      component: Reports
    })
  }
  
  // åŠ¨æ€æ·»åŠ è·¯ç”±
  dynamicRoutes.forEach(route => {
    router.addRoute(route)
  })
}
```

### 7.3 å®Œæ•´çš„æƒé™æ§åˆ¶ç¤ºä¾‹


```javascript
// store/auth.js - ç”¨æˆ·çŠ¶æ€ç®¡ç†
export const authStore = {
  state: {
    token: localStorage.getItem('token'),
    user: null,
    roles: []
  },
  
  mutations: {
    SET_TOKEN(state, token) {
      state.token = token
      localStorage.setItem('token', token)
    },
    
    SET_USER(state, user) {
      state.user = user
      state.roles = user.roles || []
    },
    
    LOGOUT(state) {
      state.token = null
      state.user = null
      state.roles = []
      localStorage.removeItem('token')
    }
  }
}

// router/index.js - è·¯ç”±å®ˆå«
router.beforeEach(async (to, from, next) => {
  const token = authStore.state.token
  
  // ç™½åå•è·¯ç”±ï¼ˆä¸éœ€è¦ç™»å½•ï¼‰
  const whiteList = ['/login', '/register', '/']
  
  if (token) {
    if (to.path === '/login') {
      next('/dashboard') // å·²ç™»å½•ç”¨æˆ·è®¿é—®ç™»å½•é¡µï¼Œé‡å®šå‘åˆ°ä»ªè¡¨ç›˜
    } else {
      // æ£€æŸ¥ç”¨æˆ·ä¿¡æ¯æ˜¯å¦å­˜åœ¨
      if (!authStore.state.user) {
        try {
          // è·å–ç”¨æˆ·ä¿¡æ¯
          const userInfo = await getUserInfo()
          authStore.commit('SET_USER', userInfo)
          next()
        } catch (error) {
          // tokenå¤±æ•ˆï¼Œæ¸…é™¤å¹¶è·³è½¬ç™»å½•
          authStore.commit('LOGOUT')
          next('/login')
        }
      } else {
        // æ£€æŸ¥é¡µé¢æƒé™
        if (hasPagePermission(to, authStore.state.roles)) {
          next()
        } else {
          next('/403')
        }
      }
    }
  } else {
    // æœªç™»å½•
    if (whiteList.includes(to.path)) {
      next() // ç™½åå•é¡µé¢ç›´æ¥è®¿é—®
    } else {
      next('/login') // å…¶ä»–é¡µé¢è·³è½¬ç™»å½•
    }
  }
})
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ è·¯ç”±å®ˆå«æœ¬è´¨ï¼šé¡µé¢è®¿é—®çš„"é—¨å«"ï¼Œæ§åˆ¶ç”¨æˆ·èƒ½å¦è¿›å…¥é¡µé¢
ğŸ”¸ å®ˆå«ç±»å‹ï¼šå…¨å±€å®ˆå«ï¼ˆæ‰€æœ‰è·¯ç”±ï¼‰ã€è·¯ç”±å®ˆå«ï¼ˆå•ä¸ªè·¯ç”±ï¼‰ã€ç»„ä»¶å®ˆå«ï¼ˆç»„ä»¶å†…ï¼‰
ğŸ”¸ next()å‡½æ•°ï¼šå¿…é¡»è°ƒç”¨ï¼Œæ§åˆ¶å¯¼èˆªæ˜¯ç»§ç»­ã€ä¸­æ–­è¿˜æ˜¯é‡å®šå‘
ğŸ”¸ metaä¿¡æ¯ï¼šå­˜å‚¨åœ¨è·¯ç”±ä¸­çš„è‡ªå®šä¹‰æ•°æ®ï¼Œç”¨äºæƒé™åˆ¤æ–­
ğŸ”¸ æ‰§è¡Œé¡ºåºï¼šç¦»å¼€ â†’ å…¨å±€æ£€æŸ¥ â†’ è·¯ç”±æ£€æŸ¥ â†’ ç»„ä»¶æ£€æŸ¥ â†’ ç¡®è®¤ â†’ å®Œæˆ
```

### 8.2 å®é™…åº”ç”¨è¦ç‚¹


**ğŸ”¹ ç™»å½•æ‹¦æˆªæœ€ä½³å®è·µ**
```javascript
// âœ… æ¨èå†™æ³•
router.beforeEach((to, from, next) => {
  const token = getToken()
  const whiteList = ['/login', '/'] // ç™½åå•
  
  if (whiteList.includes(to.path) || token) {
    next()
  } else {
    next('/login')
  }
})

// âŒ é¿å…çš„å†™æ³•
router.beforeEach((to, from, next) => {
  // é€»è¾‘è¿‡äºå¤æ‚ï¼Œéš¾ä»¥ç»´æŠ¤
  if (to.path === '/login') {
    if (hasToken()) {
      next('/dashboard')
    } else {
      next()
    }
  } else if (to.path === '/register') {
    // ... å¤ªå¤šif-else
  }
})
```

**ğŸ”¹ æƒé™æ§åˆ¶å…³é”®ç‚¹**
- ä½¿ç”¨è·¯ç”±metaæ ‡è®°æƒé™è¦æ±‚
- ç™½åå•æœºåˆ¶é¿å…é€’å½’é‡å®šå‘
- åŠ¨æ€è·¯ç”±ä¸é™æ€æƒé™æ£€æŸ¥ç»“åˆ
- ç”¨æˆ·ä¿¡æ¯å¤±æ•ˆæ—¶çš„é™çº§å¤„ç†

**ğŸ”¹ å¸¸è§é”™è¯¯é¿å…**
```javascript
// âŒ å¿˜è®°è°ƒç”¨next()
router.beforeEach((to, from, next) => {
  if (checkAuth()) {
    // å¿˜è®°next()ï¼Œå¯¼èˆªä¼šå¡ä½ï¼
  }
})

// âœ… ç¡®ä¿æ‰€æœ‰åˆ†æ”¯éƒ½æœ‰next()
router.beforeEach((to, from, next) => {
  if (checkAuth()) {
    next()
  } else {
    next('/login')
  }
})
```

### 8.3 å­¦ä¹ å»ºè®®


**ğŸ“š å­¦ä¹ è·¯å¾„**
1. å…ˆæŒæ¡ `beforeEach` å…¨å±€å®ˆå«
2. ç†è§£ `next()` å‡½æ•°çš„å„ç§ç”¨æ³•  
3. å­¦ä¼šä½¿ç”¨ `meta` ä¿¡æ¯è¿›è¡Œæƒé™åˆ¤æ–­
4. äº†è§£ç»„ä»¶å†…å®ˆå«çš„åº”ç”¨åœºæ™¯
5. å®è·µå®Œæ•´çš„æƒé™æ§åˆ¶ç³»ç»Ÿ

**ğŸ› ï¸ å®è·µæé†’**
- è·¯ç”±å®ˆå«æ˜¯SPAåº”ç”¨å®‰å…¨çš„ç¬¬ä¸€é“é˜²çº¿
- å‰ç«¯æƒé™æ§åˆ¶ä¸»è¦ç”¨äºç”¨æˆ·ä½“éªŒï¼ŒçœŸæ­£çš„å®‰å…¨éªŒè¯åœ¨åç«¯
- åˆç†ä½¿ç”¨å®ˆå«ï¼Œé¿å…è¿‡åº¦å¤æ‚çš„é€»è¾‘
- åšå¥½é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º

**æ ¸å¿ƒè®°å¿†**ï¼š
> è·¯ç”±å®ˆå«åƒé—¨å«ï¼Œæ£€æŸ¥èº«ä»½æ§æƒé™  
> beforeEachæœ€å¸¸ç”¨ï¼Œnextè°ƒç”¨è¦è®°æ¸…  
> metaä¿¡æ¯åšæ ‡è®°ï¼Œæƒé™åˆ¤æ–­æ›´æ¸…æ™°  
> å‰ç«¯ä½“éªŒåç«¯å®‰å…¨ï¼Œä¸¤æ‰‹éƒ½è¦æŠ“å¾—ç´§