---
title: 2ã€è‡ªå®šä¹‰æŒ‡ä»¤å¼€å‘
---
## ğŸ“š ç›®å½•

1. [è‡ªå®šä¹‰æŒ‡ä»¤åŸºç¡€æ¦‚å¿µ](#1-è‡ªå®šä¹‰æŒ‡ä»¤åŸºç¡€æ¦‚å¿µ)
2. [æŒ‡ä»¤æ³¨å†Œæ–¹å¼](#2-æŒ‡ä»¤æ³¨å†Œæ–¹å¼)
3. [æŒ‡ä»¤é’©å­å‡½æ•°è¯¦è§£](#3-æŒ‡ä»¤é’©å­å‡½æ•°è¯¦è§£)
4. [æŒ‡ä»¤å‚æ•°ä¸ä¿®é¥°ç¬¦](#4-æŒ‡ä»¤å‚æ•°ä¸ä¿®é¥°ç¬¦)
5. [å®ç”¨æŒ‡ä»¤ç¤ºä¾‹](#5-å®ç”¨æŒ‡ä»¤ç¤ºä¾‹)
6. [æŒ‡ä»¤ä¸ç»„ä»¶äº¤äº’](#6-æŒ‡ä»¤ä¸ç»„ä»¶äº¤äº’)
7. [è‡ªå®šä¹‰æŒ‡ä»¤æœ€ä½³å®è·µ](#7-è‡ªå®šä¹‰æŒ‡ä»¤æœ€ä½³å®è·µ)
8. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#8-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ è‡ªå®šä¹‰æŒ‡ä»¤åŸºç¡€æ¦‚å¿µ


### 1.1 ä»€ä¹ˆæ˜¯è‡ªå®šä¹‰æŒ‡ä»¤


**ğŸ”¸ ç®€å•ç†è§£**
```
è‡ªå®šä¹‰æŒ‡ä»¤å°±åƒæ˜¯ç»™HTMLå…ƒç´ æ·»åŠ ç‰¹æ®ŠåŠŸèƒ½çš„"é­”æ³•"
å°±åƒ v-ifã€v-show ä¸€æ ·ï¼Œä½ ä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå·±çš„ v-xxx æŒ‡ä»¤
```

**ğŸ’¡ ç”Ÿæ´»ç±»æ¯”**
```
æƒ³è±¡ä¸€ä¸‹é¥æ§å™¨çš„æŒ‰é’®ï¼š
- v-show å°±åƒ"æ˜¾ç¤º/éšè—"æŒ‰é’®
- v-model å°±åƒ"éŸ³é‡è°ƒèŠ‚"æŒ‰é’®  
- è‡ªå®šä¹‰æŒ‡ä»¤å°±æ˜¯ä½ è‡ªå·±æ·»åŠ çš„"ä¸€é”®æ¸…ç†"æŒ‰é’®

éƒ½æ˜¯é€šè¿‡ç®€å•æ“ä½œï¼Œå®ç°å¤æ‚åŠŸèƒ½
```

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦è‡ªå®šä¹‰æŒ‡ä»¤


**ğŸ¯ è§£å†³çš„é—®é¢˜**
```
åœºæ™¯1ï¼šæ¯æ¬¡éƒ½è¦å†™é‡å¤çš„DOMæ“ä½œä»£ç 
åœºæ™¯2ï¼šæŸäº›åŠŸèƒ½åœ¨å¤šä¸ªç»„ä»¶ä¸­éƒ½è¦ç”¨åˆ°
åœºæ™¯3ï¼šéœ€è¦å¯¹å…ƒç´ è¿›è¡Œåº•å±‚çš„DOMæ§åˆ¶

è‡ªå®šä¹‰æŒ‡ä»¤çš„ä½œç”¨ï¼š
âœ… å°è£…å¸¸ç”¨çš„DOMæ“ä½œ
âœ… æé«˜ä»£ç å¤ç”¨æ€§
âœ… è®©æ¨¡æ¿æ›´ç®€æ´æ˜“è¯»
```

**ğŸ“ ä¸¾ä¸ªä¾‹å­**
```html
<!-- ä¸ç”¨æŒ‡ä»¤ï¼šæ¯æ¬¡éƒ½è¦å†™é‡å¤ä»£ç  -->
<input ref="myInput" />
<script>
mounted() {
  this.$refs.myInput.focus()
}
</script>

<!-- ç”¨æŒ‡ä»¤ï¼šä¸€å¥è¯æå®š -->
<input v-focus />
```

### 1.3 æŒ‡ä»¤ vs ç»„ä»¶çš„åŒºåˆ«


| ç‰¹æ€§ | **æŒ‡ä»¤** | **ç»„ä»¶** |
|------|----------|----------|
| ğŸ¯ **ä½œç”¨** | `æ“ä½œç°æœ‰å…ƒç´ ` | `åˆ›å»ºæ–°çš„åŠŸèƒ½å—` |
| ğŸ”§ **ç”¨æ³•** | `v-æŒ‡ä»¤å` | `<ç»„ä»¶å>` |
| ğŸ“¦ **å°è£…** | `DOMæ“ä½œé€»è¾‘` | `å®Œæ•´çš„UIå’Œé€»è¾‘` |
| ğŸª **åœºæ™¯** | `ç»™å…ƒç´ åŠ åŠŸèƒ½` | `ç‹¬ç«‹çš„åŠŸèƒ½æ¨¡å—` |

---

## 2. ğŸ“ æŒ‡ä»¤æ³¨å†Œæ–¹å¼


### 2.1 å…¨å±€æ³¨å†ŒæŒ‡ä»¤


**ğŸ”¸ åŸºæœ¬è¯­æ³•**
```javascript
// åœ¨ main.js ä¸­æ³¨å†Œ
app.directive('æŒ‡ä»¤å', {
  // æŒ‡ä»¤çš„é…ç½®
})

// ä½¿ç”¨
<div v-æŒ‡ä»¤å></div>
```

**ğŸ’» å®é™…ç¤ºä¾‹**
```javascript
// main.js
import { createApp } from 'vue'
import App from './App.vue'

const app = createApp(App)

// æ³¨å†Œå…¨å±€æŒ‡ä»¤
app.directive('highlight', {
  mounted(el) {
    el.style.backgroundColor = 'yellow'
  }
})

app.mount('#app')
```

```html
<!-- ä»»ä½•ç»„ä»¶ä¸­éƒ½å¯ä»¥ä½¿ç”¨ -->
<template>
  <p v-highlight>è¿™æ®µæ–‡å­—ä¼šè¢«é«˜äº®æ˜¾ç¤º</p>
</template>
```

### 2.2 å±€éƒ¨æ³¨å†ŒæŒ‡ä»¤


**ğŸ”¸ åœ¨ç»„ä»¶ä¸­æ³¨å†Œ**
```javascript
export default {
  // å±€éƒ¨æ³¨å†ŒæŒ‡ä»¤
  directives: {
    // æŒ‡ä»¤å: é…ç½®
    focus: {
      mounted(el) {
        el.focus()
      }
    }
  }
}
```

**ğŸ’» å®Œæ•´ç¤ºä¾‹**
```vue
<template>
  <div>
    <input v-focus placeholder="é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨èšç„¦" />
    <input placeholder="æ™®é€šè¾“å…¥æ¡†" />
  </div>
</template>

<script>
export default {
  directives: {
    focus: {
      mounted(el) {
        // å…ƒç´ æ’å…¥åˆ°é¡µé¢æ—¶è‡ªåŠ¨èšç„¦
        el.focus()
      }
    }
  }
}
</script>
```

### 2.3 æ³¨å†Œæ–¹å¼çš„é€‰æ‹©


> ğŸ’¡ **é€‰æ‹©å»ºè®®**:
> - **å…¨å±€æ³¨å†Œ**: åœ¨å¤šä¸ªç»„ä»¶ä¸­éƒ½è¦ç”¨çš„æŒ‡ä»¤
> - **å±€éƒ¨æ³¨å†Œ**: åªåœ¨å½“å‰ç»„ä»¶ä¸­ä½¿ç”¨çš„æŒ‡ä»¤

---

## 3. âš™ï¸ æŒ‡ä»¤é’©å­å‡½æ•°è¯¦è§£


### 3.1 ä»€ä¹ˆæ˜¯é’©å­å‡½æ•°


**ğŸ”¸ ç®€å•ç†è§£**
```
é’©å­å‡½æ•°å°±æ˜¯åœ¨ç‰¹å®šæ—¶æœºè‡ªåŠ¨æ‰§è¡Œçš„å‡½æ•°
å°±åƒäººç”Ÿçš„é‡è¦èŠ‚ç‚¹ï¼šå‡ºç”Ÿã€ä¸Šå­¦ã€å·¥ä½œã€é€€ä¼‘
å…ƒç´ ä¹Ÿæœ‰ç”Ÿå‘½å‘¨æœŸï¼šåˆ›å»ºã€æ’å…¥ã€æ›´æ–°ã€ç§»é™¤
```

### 3.2 ä¸»è¦é’©å­å‡½æ•°


**ğŸ”„ Vue 3 é’©å­å‡½æ•°**
```javascript
app.directive('example', {
  // 1. å…ƒç´ ç»‘å®šæŒ‡ä»¤æ—¶ï¼ˆè¿˜æ²¡æ’å…¥é¡µé¢ï¼‰
  created(el, binding) {
    console.log('æŒ‡ä»¤ç»‘å®šåˆ°å…ƒç´ ')
  },
  
  // 2. å…ƒç´ æ’å…¥åˆ°é¡µé¢æ—¶
  mounted(el, binding) {
    console.log('å…ƒç´ å·²ç»åœ¨é¡µé¢ä¸Šäº†')
  },
  
  // 3. å…ƒç´ æ›´æ–°å‰
  beforeUpdate(el, binding) {
    console.log('å…ƒç´ å‡†å¤‡æ›´æ–°')
  },
  
  // 4. å…ƒç´ æ›´æ–°å
  updated(el, binding) {
    console.log('å…ƒç´ æ›´æ–°å®Œæˆ')
  },
  
  // 5. å…ƒç´ ä»é¡µé¢ç§»é™¤å‰
  beforeUnmount(el, binding) {
    console.log('å…ƒç´ å‡†å¤‡è¢«ç§»é™¤')
  },
  
  // 6. å…ƒç´ ä»é¡µé¢ç§»é™¤å
  unmounted(el, binding) {
    console.log('å…ƒç´ å·²è¢«ç§»é™¤')
  }
})
```

### 3.3 é’©å­å‡½æ•°å‚æ•°è¯¦è§£


**ğŸ“‹ å‚æ•°è¯´æ˜**
```javascript
directive('example', {
  mounted(el, binding, vnode, prevVnode) {
    // el: ç»‘å®šæŒ‡ä»¤çš„DOMå…ƒç´ 
    // binding: æŒ‡ä»¤çš„ç»‘å®šä¿¡æ¯
    // vnode: è™šæ‹ŸèŠ‚ç‚¹
    // prevVnode: ä¹‹å‰çš„è™šæ‹ŸèŠ‚ç‚¹
  }
})
```

**ğŸ” binding å¯¹è±¡è¯¦è§£**
```javascript
// ä½¿ç”¨: <div v-example:arg.modifier="value">
{
  value: 'value',      // æŒ‡ä»¤çš„å€¼
  arg: 'arg',          // æŒ‡ä»¤çš„å‚æ•°
  modifiers: {         // æŒ‡ä»¤çš„ä¿®é¥°ç¬¦
    modifier: true
  },
  instance: vm,        // ç»„ä»¶å®ä¾‹
  dir: directive       // æŒ‡ä»¤å®šä¹‰å¯¹è±¡
}
```

### 3.4 å®ç”¨é’©å­å‡½æ•°ç¤ºä¾‹


**ğŸ’» ç›‘å¬å…ƒç´ å¯è§æ€§**
```javascript
app.directive('visible', {
  mounted(el, binding) {
    // åˆ›å»ºè§‚å¯Ÿå™¨
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          // å…ƒç´ å¯è§æ—¶æ‰§è¡Œå›è°ƒ
          binding.value()
        }
      })
    })
    
    // å¼€å§‹è§‚å¯Ÿ
    observer.observe(el)
    
    // æŠŠè§‚å¯Ÿå™¨å­˜èµ·æ¥ï¼Œå¸è½½æ—¶è¦ç”¨
    el._observer = observer
  },
  
  unmounted(el) {
    // æ¸…ç†è§‚å¯Ÿå™¨
    if (el._observer) {
      el._observer.disconnect()
    }
  }
})
```

```html
<!-- ä½¿ç”¨ -->
<div v-visible="onVisible">å½“æˆ‘å‡ºç°åœ¨å±å¹•ä¸Šæ—¶ä¼šè§¦å‘å‡½æ•°</div>
```

---

## 4. ğŸ›ï¸ æŒ‡ä»¤å‚æ•°ä¸ä¿®é¥°ç¬¦


### 4.1 æŒ‡ä»¤å‚æ•°çš„ä½¿ç”¨


**ğŸ”¸ åŸºæœ¬æ¦‚å¿µ**
```
æŒ‡ä»¤å‚æ•°å°±æ˜¯ä¼ ç»™æŒ‡ä»¤çš„é¢å¤–ä¿¡æ¯
æ ¼å¼: v-æŒ‡ä»¤å:å‚æ•°
ä¾‹å¦‚: v-on:clickã€v-bind:class
```

**ğŸ’» è‡ªå®šä¹‰æŒ‡ä»¤ä½¿ç”¨å‚æ•°**
```javascript
// å®šä¹‰å¸¦å‚æ•°çš„æŒ‡ä»¤
app.directive('color', {
  mounted(el, binding) {
    // binding.arg å°±æ˜¯å‚æ•°
    const color = binding.arg || 'blue'
    el.style.color = color
  }
})
```

```html
<!-- ä½¿ç”¨å‚æ•° -->
<p v-color:red>çº¢è‰²æ–‡å­—</p>
<p v-color:green>ç»¿è‰²æ–‡å­—</p>
<p v-color>é»˜è®¤è“è‰²æ–‡å­—</p>
```

### 4.2 åŠ¨æ€å‚æ•°


**ğŸ’» å‚æ•°ä¹Ÿå¯ä»¥æ˜¯åŠ¨æ€çš„**
```javascript
export default {
  data() {
    return {
      colorName: 'red'
    }
  }
}
```

```html
<!-- åŠ¨æ€å‚æ•° -->
<p v-color:[colorName]>é¢œè‰²ä¼šæ ¹æ® colorName å˜åŒ–</p>
```

### 4.3 æŒ‡ä»¤ä¿®é¥°ç¬¦


**ğŸ”¸ ä¿®é¥°ç¬¦çš„ä½œç”¨**
```
ä¿®é¥°ç¬¦ç”¨æ¥æŒ‡å®šæŒ‡ä»¤çš„ç‰¹æ®Šè¡Œä¸º
æ ¼å¼: v-æŒ‡ä»¤å.ä¿®é¥°ç¬¦
ä¾‹å¦‚: v-model.lazyã€v-on.prevent
```

**ğŸ’» å¤„ç†ä¿®é¥°ç¬¦ç¤ºä¾‹**
```javascript
app.directive('scroll', {
  mounted(el, binding) {
    const options = {
      // æ ¹æ®ä¿®é¥°ç¬¦å†³å®šè¡Œä¸º
      passive: binding.modifiers.passive,
      once: binding.modifiers.once
    }
    
    el.addEventListener('scroll', binding.value, options)
  }
})
```

```html
<!-- ä½¿ç”¨ä¿®é¥°ç¬¦ -->
<div v-scroll.passive.once="handleScroll">æ»šåŠ¨åŒºåŸŸ</div>
```

### 4.4 ç»¼åˆç¤ºä¾‹ï¼šçµæ´»çš„æ ·å¼æŒ‡ä»¤


**ğŸ’» å¼ºå¤§çš„æ ·å¼æŒ‡ä»¤**
```javascript
app.directive('style', {
  mounted(el, binding) {
    applyStyle(el, binding)
  },
  updated(el, binding) {
    applyStyle(el, binding)
  }
})

function applyStyle(el, binding) {
  const { arg, value, modifiers } = binding
  
  if (arg === 'color') {
    el.style.color = value
  } else if (arg === 'size') {
    el.style.fontSize = value + 'px'
  }
  
  // å¤„ç†ä¿®é¥°ç¬¦
  if (modifiers.bold) {
    el.style.fontWeight = 'bold'
  }
  if (modifiers.italic) {
    el.style.fontStyle = 'italic'
  }
}
```

```html
<!-- çµæ´»ä½¿ç”¨ -->
<p v-style:color.bold="'red'">çº¢è‰²ç²—ä½“</p>
<p v-style:size.italic="16">16pxæ–œä½“</p>
```

---

## 5. ğŸš€ å®ç”¨æŒ‡ä»¤ç¤ºä¾‹


### 5.1 è‡ªåŠ¨èšç„¦æŒ‡ä»¤


**ğŸ’» å®Œæ•´çš„èšç„¦æŒ‡ä»¤**
```javascript
app.directive('focus', {
  mounted(el, binding) {
    // å»¶è¿Ÿæ‰§è¡Œï¼Œç¡®ä¿å…ƒç´ å·²ç»æ¸²æŸ“å®Œæˆ
    setTimeout(() => {
      el.focus()
      
      // å¦‚æœæœ‰å€¼ï¼Œé€‰ä¸­æ–‡æœ¬
      if (binding.value && el.select) {
        el.select()
      }
    }, 100)
  }
})
```

```html
<!-- ä½¿ç”¨ç¤ºä¾‹ -->
<input v-focus placeholder="è‡ªåŠ¨èšç„¦" />
<input v-focus="true" value="èšç„¦å¹¶é€‰ä¸­æ–‡æœ¬" />
```

### 5.2 å¤åˆ¶åˆ°å‰ªè´´æ¿æŒ‡ä»¤


**ğŸ’» ä¸€é”®å¤åˆ¶æŒ‡ä»¤**
```javascript
app.directive('copy', {
  mounted(el, binding) {
    el.addEventListener('click', () => {
      const text = binding.value || el.textContent
      
      // ç°ä»£æµè§ˆå™¨çš„å¤åˆ¶æ–¹æ³•
      if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(() => {
          console.log('å¤åˆ¶æˆåŠŸ')
          // å¯ä»¥æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
        })
      } else {
        // å…¼å®¹æ—§æµè§ˆå™¨
        const textarea = document.createElement('textarea')
        textarea.value = text
        document.body.appendChild(textarea)
        textarea.select()
        document.execCommand('copy')
        document.body.removeChild(textarea)
      }
    })
  }
})
```

```html
<!-- ä½¿ç”¨ç¤ºä¾‹ -->
<button v-copy="'Hello World'">ç‚¹å‡»å¤åˆ¶</button>
<p v-copy>ç‚¹å‡»å¤åˆ¶è¿™æ®µæ–‡å­—</p>
```

### 5.3 å›¾ç‰‡æ‡’åŠ è½½æŒ‡ä»¤


**ğŸ’» ç®€å•çš„æ‡’åŠ è½½**
```javascript
app.directive('lazy', {
  mounted(el, binding) {
    // åˆ›å»ºè§‚å¯Ÿå™¨
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          // å…ƒç´ è¿›å…¥è§†å£ï¼ŒåŠ è½½å›¾ç‰‡
          el.src = binding.value
          observer.unobserve(el)
        }
      })
    })
    
    observer.observe(el)
    el._observer = observer
  },
  
  unmounted(el) {
    if (el._observer) {
      el._observer.disconnect()
    }
  }
})
```

```html
<!-- ä½¿ç”¨ç¤ºä¾‹ -->
<img v-lazy="'./real-image.jpg'" src="./placeholder.jpg" />
```

### 5.4 é˜²æŠ–ç‚¹å‡»æŒ‡ä»¤


**ğŸ’» é˜²æ­¢é‡å¤ç‚¹å‡»**
```javascript
app.directive('debounce', {
  mounted(el, binding) {
    let timer = null
    const delay = binding.arg || 500 // é»˜è®¤500ms
    
    el.addEventListener('click', (e) => {
      if (timer) {
        e.preventDefault()
        e.stopPropagation()
        return false
      }
      
      timer = setTimeout(() => {
        timer = null
      }, delay)
    })
  }
})
```

```html
<!-- ä½¿ç”¨ç¤ºä¾‹ -->
<button v-debounce:1000 @click="submit">æäº¤ï¼ˆ1ç§’å†…åªèƒ½ç‚¹å‡»ä¸€æ¬¡ï¼‰</button>
```

---

## 6. ğŸ¤ æŒ‡ä»¤ä¸ç»„ä»¶äº¤äº’


### 6.1 æŒ‡ä»¤è®¿é—®ç»„ä»¶å®ä¾‹


**ğŸ’» åœ¨æŒ‡ä»¤ä¸­è°ƒç”¨ç»„ä»¶æ–¹æ³•**
```javascript
app.directive('validate', {
  mounted(el, binding, vnode) {
    el.addEventListener('blur', () => {
      // è·å–ç»„ä»¶å®ä¾‹
      const instance = binding.instance
      
      // è°ƒç”¨ç»„ä»¶çš„éªŒè¯æ–¹æ³•
      if (instance && instance.validateField) {
        instance.validateField(binding.arg)
      }
    })
  }
})
```

```vue
<template>
  <input v-validate:username />
</template>

<script>
export default {
  methods: {
    validateField(fieldName) {
      console.log(`éªŒè¯å­—æ®µ: ${fieldName}`)
      // æ‰§è¡ŒéªŒè¯é€»è¾‘
    }
  }
}
</script>
```

### 6.2 æŒ‡ä»¤ç›‘å¬ç»„ä»¶æ•°æ®å˜åŒ–


**ğŸ’» å“åº”æ•°æ®å˜åŒ–çš„æŒ‡ä»¤**
```javascript
app.directive('highlight', {
  mounted(el, binding) {
    updateHighlight(el, binding)
  },
  updated(el, binding) {
    updateHighlight(el, binding)
  }
})

function updateHighlight(el, binding) {
  // æ ¹æ®ç»‘å®šå€¼å†³å®šæ˜¯å¦é«˜äº®
  if (binding.value) {
    el.classList.add('highlight')
  } else {
    el.classList.remove('highlight')
  }
}
```

```vue
<template>
  <div>
    <p v-highlight="isImportant">é‡è¦ä¿¡æ¯</p>
    <button @click="isImportant = !isImportant">
      åˆ‡æ¢é‡è¦æ€§
    </button>
  </div>
</template>

<script>
export default {
  data() {
    return {
      isImportant: false
    }
  }
}
</script>

<style>
.highlight {
  background-color: yellow;
  font-weight: bold;
}
</style>
```

---

## 7. ğŸŒŸ è‡ªå®šä¹‰æŒ‡ä»¤æœ€ä½³å®è·µ


### 7.1 æŒ‡ä»¤å‘½åè§„èŒƒ


**ğŸ“ å‘½åå»ºè®®**
```javascript
// âœ… å¥½çš„å‘½å
v-focus         // ç®€æ´æ˜äº†
v-lazy-load     // ç”¨è¿å­—ç¬¦åˆ†éš”
v-copy-text     // åŠŸèƒ½æ˜ç¡®

// âŒ é¿å…çš„å‘½å
v-f             // å¤ªç®€çŸ­
v-myDirective   // é©¼å³°å‘½åï¼ˆæ¨¡æ¿ä¸­ä¼šæœ‰é—®é¢˜ï¼‰
v-do-something  // å¤ªå®½æ³›
```

### 7.2 æ€§èƒ½ä¼˜åŒ–


**âš¡ é¿å…é‡å¤æ“ä½œ**
```javascript
app.directive('example', {
  mounted(el, binding) {
    // âœ… ç¼“å­˜DOMæŸ¥è¯¢ç»“æœ
    const button = el.querySelector('.btn')
    el._cachedButton = button
  },
  
  updated(el, binding) {
    // âœ… ä½¿ç”¨ç¼“å­˜ï¼Œé¿å…é‡å¤æŸ¥è¯¢
    const button = el._cachedButton
    if (button) {
      button.textContent = binding.value
    }
  },
  
  unmounted(el) {
    // âœ… æ¸…ç†ç¼“å­˜
    delete el._cachedButton
  }
})
```

### 7.3 é”™è¯¯å¤„ç†


**ğŸ›¡ï¸ å¥å£®çš„æŒ‡ä»¤**
```javascript
app.directive('safe-operation', {
  mounted(el, binding) {
    try {
      // æ£€æŸ¥å‚æ•°
      if (typeof binding.value !== 'function') {
        console.warn('æŒ‡ä»¤éœ€è¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°')
        return
      }
      
      // æ£€æŸ¥å…ƒç´ ç±»å‹
      if (el.tagName !== 'BUTTON') {
        console.warn('æŒ‡ä»¤åªèƒ½ç”¨äºæŒ‰é’®å…ƒç´ ')
        return
      }
      
      el.addEventListener('click', binding.value)
      
    } catch (error) {
      console.error('æŒ‡ä»¤æ‰§è¡Œå‡ºé”™:', error)
    }
  }
})
```

### 7.4 æŒ‡ä»¤å¤ç”¨æ€§è®¾è®¡


**ğŸ”„ å¯é…ç½®çš„é€šç”¨æŒ‡ä»¤**
```javascript
app.directive('animation', {
  mounted(el, binding) {
    const config = {
      // é»˜è®¤é…ç½®
      duration: 300,
      easing: 'ease',
      delay: 0,
      // ç”¨æˆ·é…ç½®è¦†ç›–é»˜è®¤å€¼
      ...binding.value
    }
    
    el.style.transition = `all ${config.duration}ms ${config.easing} ${config.delay}ms`
    
    // æ ¹æ®ä¿®é¥°ç¬¦åº”ç”¨ä¸åŒåŠ¨ç”»
    if (binding.modifiers.fade) {
      el.style.opacity = '0'
      setTimeout(() => el.style.opacity = '1', 10)
    }
    
    if (binding.modifiers.slide) {
      el.style.transform = 'translateY(-20px)'
      setTimeout(() => el.style.transform = 'translateY(0)', 10)
    }
  }
})
```

```html
<!-- çµæ´»ä½¿ç”¨ -->
<div v-animation.fade="{ duration: 500 }">æ·¡å…¥æ•ˆæœ</div>
<div v-animation.slide="{ delay: 200 }">æ»‘å…¥æ•ˆæœ</div>
```

---

## 8. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 8.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ è‡ªå®šä¹‰æŒ‡ä»¤æœ¬è´¨ï¼šå°è£…DOMæ“ä½œï¼Œæé«˜ä»£ç å¤ç”¨æ€§
ğŸ”¸ æ³¨å†Œæ–¹å¼ï¼šå…¨å±€æ³¨å†Œï¼ˆapp.directiveï¼‰vs å±€éƒ¨æ³¨å†Œï¼ˆdirectivesé€‰é¡¹ï¼‰
ğŸ”¸ é’©å­å‡½æ•°ï¼šmountedã€updatedã€unmounted æ˜¯æœ€å¸¸ç”¨çš„
ğŸ”¸ å‚æ•°ä¼ é€’ï¼šé€šè¿‡ binding å¯¹è±¡è·å–æŒ‡ä»¤çš„å€¼ã€å‚æ•°ã€ä¿®é¥°ç¬¦
ğŸ”¸ åº”ç”¨åœºæ™¯ï¼šDOMæ“ä½œã€äº‹ä»¶å¤„ç†ã€å…ƒç´ è¡Œä¸ºå¢å¼º
```

### 8.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ æŒ‡ä»¤ vs ç»„ä»¶çš„é€‰æ‹©**
```
é€‰æ‹©æŒ‡ä»¤çš„æƒ…å†µï¼š
âœ… éœ€è¦ç›´æ¥æ“ä½œDOMå…ƒç´ 
âœ… ä¸ºç°æœ‰å…ƒç´ æ·»åŠ è¡Œä¸º
âœ… åŠŸèƒ½å•ä¸€ä¸”å¯å¤ç”¨

é€‰æ‹©ç»„ä»¶çš„æƒ…å†µï¼š
âœ… éœ€è¦å¤æ‚çš„UIç»“æ„
âœ… åŒ…å«çŠ¶æ€ç®¡ç†
âœ… éœ€è¦æ’æ§½å’Œäº‹ä»¶
```

**ğŸ”¹ ç”Ÿå‘½å‘¨æœŸé’©å­çš„ä½¿ç”¨**
```
mountedï¼šåˆå§‹åŒ–æ“ä½œï¼ˆäº‹ä»¶ç›‘å¬ã€æ ·å¼è®¾ç½®ï¼‰
updatedï¼šå“åº”æ•°æ®å˜åŒ–
unmountedï¼šæ¸…ç†å·¥ä½œï¼ˆç§»é™¤äº‹ä»¶ç›‘å¬ã€æ¸…ç†å®šæ—¶å™¨ï¼‰
```

**ğŸ”¹ å‚æ•°å’Œä¿®é¥°ç¬¦çš„çµæ´»è¿ç”¨**
```
å‚æ•°ï¼šä¼ é€’é…ç½®ä¿¡æ¯ï¼ˆå¦‚é¢œè‰²ã€å¤§å°ï¼‰
ä¿®é¥°ç¬¦ï¼šæ”¹å˜æŒ‡ä»¤è¡Œä¸ºï¼ˆå¦‚ .onceã€.passiveï¼‰
å€¼ï¼šä¼ é€’æ•°æ®æˆ–å›è°ƒå‡½æ•°
```

### 8.3 å®é™…å¼€å‘å»ºè®®


**ğŸ“ å¼€å‘æŒ‡å—**
- **èµ·æ­¥ç®€å•**ï¼šå…ˆä»åŸºç¡€çš„DOMæ“ä½œæŒ‡ä»¤å¼€å§‹
- **é€æ­¥å®Œå–„**ï¼šæ·»åŠ å‚æ•°ã€ä¿®é¥°ç¬¦æ”¯æŒ
- **æ³¨é‡å¤ç”¨**ï¼šè®¾è®¡æ—¶è€ƒè™‘åœ¨ä¸åŒåœºæ™¯ä¸‹çš„ä½¿ç”¨
- **æ–‡æ¡£æ¸…æ™°**ï¼šä¸ºå›¢é˜Ÿæˆå‘˜æä¾›ä½¿ç”¨ç¤ºä¾‹

**ğŸ”§ å¸¸ç”¨æŒ‡ä»¤ç±»å‹**
- **è¡Œä¸ºå¢å¼º**ï¼šèšç„¦ã€å¤åˆ¶ã€æ‹–æ‹½
- **è§†è§‰æ•ˆæœ**ï¼šåŠ¨ç”»ã€é«˜äº®ã€æ‡’åŠ è½½  
- **äº‹ä»¶å¤„ç†**ï¼šé˜²æŠ–ã€èŠ‚æµã€é•¿æŒ‰
- **åŠŸèƒ½é›†æˆ**ï¼šæƒé™æ§åˆ¶ã€æ•°æ®éªŒè¯

**âš ï¸ æ³¨æ„äº‹é¡¹**
- é¿å…åœ¨æŒ‡ä»¤ä¸­è¿›è¡Œå¤æ‚çš„ä¸šåŠ¡é€»è¾‘
- è®°å¾—åœ¨ unmounted ä¸­æ¸…ç†èµ„æº
- è€ƒè™‘SSRç¯å¢ƒä¸‹çš„å…¼å®¹æ€§
- ä¸ºæŒ‡ä»¤æä¾›åˆç†çš„é»˜è®¤å€¼

**æ ¸å¿ƒè®°å¿†**ï¼š
- è‡ªå®šä¹‰æŒ‡ä»¤ä¸“é—¨å¤„ç†DOMæ“ä½œå’Œå…ƒç´ è¡Œä¸º
- é€šè¿‡é’©å­å‡½æ•°åœ¨åˆé€‚çš„æ—¶æœºæ‰§è¡Œé€»è¾‘
- å‚æ•°å’Œä¿®é¥°ç¬¦è®©æŒ‡ä»¤æ›´åŠ çµæ´»æ˜“ç”¨
- è‰¯å¥½çš„è®¾è®¡è®©æŒ‡ä»¤æ—¢å¼ºå¤§åˆæ˜“äºç»´æŠ¤