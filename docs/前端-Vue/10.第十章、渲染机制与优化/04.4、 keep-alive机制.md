---
title: 4ã€ keep-aliveæœºåˆ¶
---
## ğŸ“š ç›®å½•

1. [keep-aliveæ˜¯ä»€ä¹ˆ](#1-keep-aliveæ˜¯ä»€ä¹ˆ)
2. [keep-aliveç¼“å­˜åŸç†](#2-keep-aliveç¼“å­˜åŸç†)
3. [åŸºæœ¬ä½¿ç”¨æ–¹å¼](#3-åŸºæœ¬ä½¿ç”¨æ–¹å¼)
4. [ç¼“å­˜æ§åˆ¶æœºåˆ¶](#4-ç¼“å­˜æ§åˆ¶æœºåˆ¶)
5. [ç”Ÿå‘½å‘¨æœŸå˜åŒ–](#5-ç”Ÿå‘½å‘¨æœŸå˜åŒ–)
6. [Vue3æ–°ç‰¹æ€§æ”¯æŒ](#6-Vue3æ–°ç‰¹æ€§æ”¯æŒ)
7. [å®æˆ˜åº”ç”¨åœºæ™¯](#7-å®æˆ˜åº”ç”¨åœºæ™¯)
8. [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#8-æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
9. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#9-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ”„ keep-aliveæ˜¯ä»€ä¹ˆ


### 1.1 æ¦‚å¿µç†è§£


**keep-alive** æ˜¯Vueæä¾›çš„ä¸€ä¸ª**å†…ç½®ç»„ä»¶**ï¼Œä½œç”¨å°±åƒä¸€ä¸ª"ä¿é²œç›’"ï¼Œèƒ½æŠŠç»„ä»¶çš„çŠ¶æ€å’Œæ•°æ®"å†·å†»ä¿å­˜"èµ·æ¥ã€‚

```
æ™®é€šç»„ä»¶åˆ‡æ¢ï¼š
é¡µé¢A â†’ é¡µé¢B â†’ é¡µé¢A (é‡æ–°åˆ›å»ºï¼Œæ•°æ®ä¸¢å¤±)

keep-aliveåŒ…è£¹ï¼š
é¡µé¢A â†’ é¡µé¢B â†’ é¡µé¢A (ä»ç¼“å­˜æ¢å¤ï¼Œæ•°æ®ä¿ç•™)
```

> **ğŸ’¡ é€šä¿—æ¯”å–»ï¼š** å°±åƒç”µè„‘çš„ä¼‘çœ åŠŸèƒ½ï¼Œç¨‹åºä¸å…³é—­åªæ˜¯æš‚åœï¼Œä¸‹æ¬¡æ‰“å¼€æ—¶æ‰€æœ‰å†…å®¹éƒ½è¿˜åœ¨ã€‚

### 1.2 è§£å†³çš„æ ¸å¿ƒé—®é¢˜


**ğŸ”¸ æ•°æ®çŠ¶æ€ä¸¢å¤±é—®é¢˜**
```javascript
// æ²¡æœ‰keep-aliveï¼šç”¨æˆ·å¡«å†™è¡¨å•åˆ°ä¸€åŠï¼Œåˆ‡æ¢é¡µé¢å†å›æ¥ï¼Œæ•°æ®å…¨æ²¡äº†
// æœ‰keep-aliveï¼šç”¨æˆ·å¡«å†™çš„å†…å®¹è¿˜åœ¨ï¼Œå¯ä»¥ç»§ç»­å¡«å†™
```

**ğŸ”¸ é‡å¤åˆ›å»ºæ€§èƒ½é—®é¢˜**
```javascript
// æ²¡æœ‰keep-aliveï¼šæ¯æ¬¡åˆ‡æ¢éƒ½è¦é‡æ–°åˆ›å»ºç»„ä»¶ï¼Œé‡æ–°è¯·æ±‚æ•°æ®
// æœ‰keep-aliveï¼šç»„ä»¶ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œåˆ‡æ¢ç§’å¼€
```

### 1.3 ä½¿ç”¨åœºæ™¯ä¸€è§ˆ


```
âœ… é€‚åˆç”¨keep-aliveçš„åœºæ™¯ï¼š
â€¢ è¡¨å•é¡µé¢ - å¡«å†™åˆ°ä¸€åŠä¸æƒ³ä¸¢å¤±
â€¢ åˆ—è¡¨é¡µé¢ - æ»šåŠ¨ä½ç½®ã€ç­›é€‰æ¡ä»¶ä¿æŒ
â€¢ Tabåˆ‡æ¢ - å¤šä¸ªæ ‡ç­¾é¡µå†…å®¹ä¿ç•™
â€¢ è¯¦æƒ…é¡µé¢ - é¿å…é‡å¤è¯·æ±‚ç›¸åŒæ•°æ®

âŒ ä¸é€‚åˆç”¨keep-aliveçš„åœºæ™¯ï¼š
â€¢ å®æ—¶æ•°æ®é¡µé¢ - éœ€è¦æ¯æ¬¡éƒ½è·å–æœ€æ–°æ•°æ®
â€¢ ç™»å½•æ³¨å†Œé¡µ - ä¸éœ€è¦ä¿ç•™çŠ¶æ€
â€¢ ä¸€æ¬¡æ€§æ“ä½œé¡µé¢ - å®Œæˆåä¸å†è¿”å›
```

---

## 2. âš™ï¸ keep-aliveç¼“å­˜åŸç†


### 2.1 ç¼“å­˜æœºåˆ¶å›¾è§£


```
ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå¯¹æ¯”ï¼š

ã€æ™®é€šç»„ä»¶ã€‘
åˆ›å»º â†’ æŒ‚è½½ â†’ é”€æ¯ â†’ åˆ›å»º â†’ æŒ‚è½½ â†’ é”€æ¯...
  â†“      â†“      â†“      â†“      â†“      â†“
 è€—æ—¶   è€—æ—¶   æ•°æ®ä¸¢å¤±  è€—æ—¶   è€—æ—¶   æ•°æ®ä¸¢å¤±

ã€keep-aliveåŒ…è£¹çš„ç»„ä»¶ã€‘
åˆ›å»º â†’ æŒ‚è½½ â†’ ç¼“å­˜ â†’ æ¿€æ´» â†’ ç¼“å­˜ â†’ æ¿€æ´»...
  â†“      â†“      â†“      â†“      â†“      â†“
 è€—æ—¶   è€—æ—¶   ç¬é—´   ç¬é—´   ç¬é—´   æ•°æ®ä¿ç•™
```

### 2.2 å†…éƒ¨å·¥ä½œæµç¨‹


**ğŸ”§ ç¼“å­˜å·¥ä½œåŸç†**
```
ç¬¬ä¸€æ¬¡è®¿é—®ç»„ä»¶ï¼š
1. åˆ›å»ºç»„ä»¶å®ä¾‹
2. æ‰§è¡Œæ­£å¸¸ç”Ÿå‘½å‘¨æœŸ
3. å°†ç»„ä»¶å®ä¾‹å­˜å…¥ç¼“å­˜Map
4. æ˜¾ç¤ºç»„ä»¶

å†æ¬¡è®¿é—®ç»„ä»¶ï¼š
1. æ£€æŸ¥ç¼“å­˜Mapä¸­æ˜¯å¦å­˜åœ¨
2. å¦‚æœå­˜åœ¨ï¼Œç›´æ¥ä»ç¼“å­˜å–å‡º
3. è§¦å‘activatedé’©å­
4. æ˜¾ç¤ºç»„ä»¶ï¼ˆæ— éœ€é‡æ–°åˆ›å»ºï¼‰

ç¦»å¼€ç»„ä»¶ï¼š
1. ç»„ä»¶ä¸é”€æ¯ï¼Œä¿ç•™åœ¨ç¼“å­˜ä¸­
2. è§¦å‘deactivatedé’©å­
3. ç»„ä»¶å˜ä¸ºéæ´»è·ƒçŠ¶æ€
```

### 2.3 å†…å­˜ç®¡ç†ç­–ç•¥


**ğŸ“Š LRUç®—æ³•ï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰**
```
ç¼“å­˜æ·˜æ±°æœºåˆ¶ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¼“å­˜é˜Ÿåˆ— (æœ€å¤§ç¼“å­˜æ•°é‡é™åˆ¶)          â”‚
â”‚ [æœ€æ–°] â† [è¾ƒæ–°] â† [è¾ƒæ—§] â† [æœ€æ—§]    â”‚
â”‚                               â†‘     â”‚
â”‚                        è¶…å‡ºé™åˆ¶æ—¶æ·˜æ±° â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å½“ç¼“å­˜æ»¡äº†ï¼š
â€¢ æ–°ç»„ä»¶è¿›å…¥ â†’ æœ€æ—§çš„ç»„ä»¶è¢«ç§»é™¤å¹¶é”€æ¯
â€¢ è®¿é—®ç¼“å­˜ç»„ä»¶ â†’ è¯¥ç»„ä»¶ç§»åŠ¨åˆ°é˜Ÿåˆ—æœ€å‰é¢
```

---

## 3. ğŸ› ï¸ åŸºæœ¬ä½¿ç”¨æ–¹å¼


### 3.1 æœ€ç®€å•çš„ç”¨æ³•


```vue
<template>
  <!-- ç¼“å­˜å•ä¸ªç»„ä»¶ -->
  <keep-alive>
    <component :is="currentComponent" />
  </keep-alive>
  
  <!-- ç¼“å­˜è·¯ç”±ç»„ä»¶ -->
  <keep-alive>
    <router-view />
  </keep-alive>
</template>
```

> **ğŸ’¡ è§£é‡Šï¼š** `keep-alive`åƒä¸€ä¸ªé€æ˜çš„å®¹å™¨ï¼ŒæŠŠé‡Œé¢çš„ç»„ä»¶"ä¿æŠ¤"èµ·æ¥ï¼Œè®©å®ƒä»¬ä¸è¢«é”€æ¯ã€‚

### 3.2 åŠ¨æ€ç»„ä»¶ç¼“å­˜


```vue
<template>
  <div>
    <!-- åˆ‡æ¢æŒ‰é’® -->
    <button @click="currentTab = 'home'">é¦–é¡µ</button>
    <button @click="currentTab = 'profile'">ä¸ªäººä¸­å¿ƒ</button>
    <button @click="currentTab = 'settings'">è®¾ç½®</button>
    
    <!-- ç¼“å­˜åŠ¨æ€ç»„ä»¶ -->
    <keep-alive>
      <component :is="currentTab" />
    </keep-alive>
  </div>
</template>

<script>
export default {
  data() {
    return {
      currentTab: 'home'
    }
  },
  components: {
    home: () => import('./Home.vue'),
    profile: () => import('./Profile.vue'),
    settings: () => import('./Settings.vue')
  }
}
</script>
```

### 3.3 è·¯ç”±çº§åˆ«ç¼“å­˜


```vue
<!-- App.vue -->
<template>
  <div id="app">
    <keep-alive>
      <router-view />
    </keep-alive>
  </div>
</template>
```

```javascript
// è·¯ç”±é…ç½®
const routes = [
  {
    path: '/form',
    component: FormPage,
    meta: { keepAlive: true } // æ ‡è®°éœ€è¦ç¼“å­˜
  },
  {
    path: '/list',
    component: ListPage,
    meta: { keepAlive: true }
  }
]
```

---

## 4. ğŸ¯ ç¼“å­˜æ§åˆ¶æœºåˆ¶


### 4.1 include - æŒ‡å®šç¼“å­˜ç»„ä»¶


**ğŸ”¸ æŒ‰ç»„ä»¶åç§°ç¼“å­˜**
```vue
<template>
  <!-- åªç¼“å­˜åä¸º FormPage çš„ç»„ä»¶ -->
  <keep-alive include="FormPage">
    <router-view />
  </keep-alive>
  
  <!-- ç¼“å­˜å¤šä¸ªæŒ‡å®šç»„ä»¶ -->
  <keep-alive :include="['FormPage', 'ListPage']">
    <router-view />
  </keep-alive>
  
  <!-- ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ -->
  <keep-alive :include="/Form|List/">
    <router-view />
  </keep-alive>
</template>
```

> **âš ï¸ é‡è¦ï¼š** `include`åŒ¹é…çš„æ˜¯ç»„ä»¶çš„`name`é€‰é¡¹ï¼Œä¸æ˜¯æ–‡ä»¶åï¼

```javascript
// ç»„ä»¶å¿…é¡»æœ‰nameå±æ€§æ‰èƒ½è¢«includeåŒ¹é…
export default {
  name: 'FormPage', // è¿™ä¸ªnameè¦å’Œincludeä¿æŒä¸€è‡´
  data() {
    return {
      // ...
    }
  }
}
```

### 4.2 exclude - æ’é™¤ç¼“å­˜ç»„ä»¶


```vue
<template>
  <!-- é™¤äº†LoginPageï¼Œå…¶ä»–éƒ½ç¼“å­˜ -->
  <keep-alive exclude="LoginPage">
    <router-view />
  </keep-alive>
  
  <!-- æ’é™¤å¤šä¸ªç»„ä»¶ -->
  <keep-alive :exclude="['LoginPage', 'RegisterPage']">
    <router-view />
  </keep-alive>
</template>
```

### 4.3 max - é™åˆ¶ç¼“å­˜æ•°é‡


```vue
<template>
  <!-- æœ€å¤šç¼“å­˜3ä¸ªç»„ä»¶ï¼Œè¶…å‡ºåˆ™æŒ‰LRUç®—æ³•æ·˜æ±° -->
  <keep-alive :max="3">
    <router-view />
  </keep-alive>
</template>
```

**ğŸ“Š ç¼“å­˜æ•°é‡æ§åˆ¶ç¤ºä¾‹**
```
è®¾ç½®max="3"æ—¶çš„ç¼“å­˜å˜åŒ–ï¼š

è®¿é—®é¡ºåºï¼šA â†’ B â†’ C â†’ D

ç¼“å­˜çŠ¶æ€å˜åŒ–ï¼š
1. è®¿é—®Aï¼š[A]
2. è®¿é—®Bï¼š[A, B]  
3. è®¿é—®Cï¼š[A, B, C]
4. è®¿é—®Dï¼š[B, C, D] (Aè¢«æ·˜æ±°)
5. å†è®¿é—®Aï¼š[C, D, A] (Bè¢«æ·˜æ±°ï¼ŒAé‡æ–°åˆ›å»º)
```

### 4.4 åŠ¨æ€æ§åˆ¶ç¼“å­˜


```vue
<template>
  <keep-alive :include="cacheList" :max="maxCache">
    <router-view />
  </keep-alive>
</template>

<script>
export default {
  data() {
    return {
      cacheList: ['FormPage'], // åŠ¨æ€ç¼“å­˜åˆ—è¡¨
      maxCache: 5
    }
  },
  methods: {
    // æ·»åŠ åˆ°ç¼“å­˜
    addCache(componentName) {
      if (!this.cacheList.includes(componentName)) {
        this.cacheList.push(componentName)
      }
    },
    
    // ä»ç¼“å­˜ä¸­ç§»é™¤
    removeCache(componentName) {
      const index = this.cacheList.indexOf(componentName)
      if (index > -1) {
        this.cacheList.splice(index, 1)
      }
    },
    
    // æ¸…ç©ºæ‰€æœ‰ç¼“å­˜
    clearCache() {
      this.cacheList = []
    }
  }
}
</script>
```

---

## 5. ğŸ”„ ç”Ÿå‘½å‘¨æœŸå˜åŒ–


### 5.1 æ–°å¢çš„ç”Ÿå‘½å‘¨æœŸé’©å­


**ğŸ”¸ activated - ç»„ä»¶æ¿€æ´»æ—¶**
```javascript
export default {
  name: 'CachedComponent',
  
  // ç»„ä»¶ç¬¬ä¸€æ¬¡åˆ›å»ºæ—¶æ‰§è¡Œ
  created() {
    console.log('ç»„ä»¶åˆ›å»ºäº†')
  },
  
  // ç»„ä»¶æŒ‚è½½æ—¶æ‰§è¡Œï¼ˆåªæ‰§è¡Œä¸€æ¬¡ï¼‰
  mounted() {
    console.log('ç»„ä»¶æŒ‚è½½äº†')
    this.fetchData()
  },
  
  // æ¯æ¬¡ä»ç¼“å­˜ä¸­æ¿€æ´»æ—¶æ‰§è¡Œ
  activated() {
    console.log('ç»„ä»¶è¢«æ¿€æ´»äº†')
    // å¯ä»¥åœ¨è¿™é‡Œåˆ·æ–°æ•°æ®
    this.refreshData()
  },
  
  // æ¯æ¬¡è¢«ç¼“å­˜æ—¶æ‰§è¡Œ
  deactivated() {
    console.log('ç»„ä»¶è¢«ç¼“å­˜äº†')
    // å¯ä»¥åœ¨è¿™é‡Œä¿å­˜çŠ¶æ€
    this.saveCurrentState()
  }
}
```

### 5.2 ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œé¡ºåº


```
ã€ç¬¬ä¸€æ¬¡è®¿é—®ç»„ä»¶ã€‘
beforeCreate â†’ created â†’ beforeMount â†’ mounted â†’ activated

ã€åˆ‡æ¢åˆ°å…¶ä»–ç»„ä»¶ã€‘
deactivated (ç»„ä»¶è¢«ç¼“å­˜ï¼Œä¸æ‰§è¡ŒbeforeDestroyå’Œdestroyed)

ã€å†æ¬¡åˆ‡æ¢å›æ¥ã€‘
activated (åªæ‰§è¡Œè¿™ä¸€ä¸ªï¼Œä¸æ‰§è¡Œcreatedã€mountedç­‰)

ã€ç»„ä»¶è¢«ä»ç¼“å­˜ä¸­ç§»é™¤æ—¶ã€‘
deactivated â†’ beforeDestroy â†’ destroyed
```

### 5.3 å®é™…åº”ç”¨ç¤ºä¾‹


```vue
<template>
  <div>
    <h2>å•†å“åˆ—è¡¨</h2>
    <div>å½“å‰é¡µï¼š{{ currentPage }}</div>
    <div>æœç´¢å…³é”®è¯ï¼š{{ keyword }}</div>
    <!-- å•†å“åˆ—è¡¨ -->
  </div>
</template>

<script>
export default {
  name: 'ProductList',
  data() {
    return {
      products: [],
      currentPage: 1,
      keyword: '',
      lastUpdateTime: null
    }
  },
  
  mounted() {
    // ç»„ä»¶æŒ‚è½½æ—¶åŠ è½½æ•°æ®
    this.loadProducts()
  },
  
  activated() {
    // æ¯æ¬¡æ¿€æ´»æ—¶æ£€æŸ¥æ˜¯å¦éœ€è¦åˆ·æ–°
    const now = Date.now()
    const fiveMinutes = 5 * 60 * 1000
    
    if (!this.lastUpdateTime || (now - this.lastUpdateTime) > fiveMinutes) {
      console.log('æ•°æ®è¾ƒæ—§ï¼Œé‡æ–°åŠ è½½')
      this.loadProducts()
    } else {
      console.log('ä½¿ç”¨ç¼“å­˜æ•°æ®')
    }
  },
  
  deactivated() {
    // ç»„ä»¶è¢«ç¼“å­˜æ—¶ä¿å­˜æ»šåŠ¨ä½ç½®
    this.saveScrollPosition()
  },
  
  methods: {
    loadProducts() {
      // åŠ è½½å•†å“æ•°æ®
      this.lastUpdateTime = Date.now()
    },
    
    saveScrollPosition() {
      // ä¿å­˜å½“å‰æ»šåŠ¨ä½ç½®
      localStorage.setItem('productListScrollTop', window.scrollY)
    }
  }
}
</script>
```

---

## 6. ğŸš€ Vue3æ–°ç‰¹æ€§æ”¯æŒ


### 6.1 å¤šslotæ”¯æŒ


**Vue3ä¸­çš„å¢å¼ºåŠŸèƒ½**
```vue
<!-- Vue3æ”¯æŒå¤šä¸ªslotçš„keep-alive -->
<template>
  <keep-alive>
    <template #default>
      <router-view />
    </template>
    
    <template #sidebar>
      <SidebarComponent />
    </template>
  </keep-alive>
</template>
```

### 6.2 ä¸Suspenseç»“åˆä½¿ç”¨


```vue
<template>
  <keep-alive>
    <Suspense>
      <template #default>
        <AsyncComponent />
      </template>
      
      <template #fallback>
        <div>Loading...</div>
      </template>
    </Suspense>
  </keep-alive>
</template>

<script>
import { defineAsyncComponent } from 'vue'

export default {
  components: {
    AsyncComponent: defineAsyncComponent(() => import('./AsyncComponent.vue'))
  }
}
</script>
```

### 6.3 Composition APIä¸­çš„ä½¿ç”¨


```vue
<script setup>
import { ref, onActivated, onDeactivated } from 'vue'

const count = ref(0)
const isActive = ref(false)

// ç»„ä»¶æ¿€æ´»æ—¶æ‰§è¡Œ
onActivated(() => {
  console.log('ç»„ä»¶æ¿€æ´»äº†')
  isActive.value = true
  // å¯ä»¥åœ¨è¿™é‡Œé‡æ–°è·å–æ•°æ®
})

// ç»„ä»¶ç¼“å­˜æ—¶æ‰§è¡Œ
onDeactivated(() => {
  console.log('ç»„ä»¶è¢«ç¼“å­˜äº†')
  isActive.value = false
  // å¯ä»¥åœ¨è¿™é‡Œæ¸…ç†å®šæ—¶å™¨ç­‰
})
</script>
```

---

## 7. ğŸ’¼ å®æˆ˜åº”ç”¨åœºæ™¯


### 7.1 è¡¨å•é¡µé¢ç¼“å­˜


**ğŸ”¸ é—®é¢˜åœºæ™¯**
```
ç”¨æˆ·å¡«å†™å¤æ‚è¡¨å• â†’ ä¸­é€”æŸ¥çœ‹å¸®åŠ©é¡µé¢ â†’ è¿”å›è¡¨å•é¡µé¢
æœŸæœ›ï¼šå¡«å†™çš„å†…å®¹è¿˜åœ¨ï¼Œä¸ç”¨é‡æ–°å¡«å†™
```

**ğŸ”§ è§£å†³æ–¹æ¡ˆ**
```vue
<!-- è·¯ç”±é…ç½® -->
<template>
  <keep-alive :include="['FormPage']">
    <router-view />
  </keep-alive>
</template>
```

```vue
<!-- FormPage.vue -->
<template>
  <form>
    <h2>ç”¨æˆ·æ³¨å†Œè¡¨å•</h2>
    
    <input v-model="form.username" placeholder="ç”¨æˆ·å" />
    <input v-model="form.email" placeholder="é‚®ç®±" />
    <textarea v-model="form.description" placeholder="ä¸ªäººæè¿°"></textarea>
    
    <button @click="$router.push('/help')">æŸ¥çœ‹å¡«å†™å¸®åŠ©</button>
    <button @click="submitForm">æäº¤</button>
  </form>
</template>

<script>
export default {
  name: 'FormPage',
  data() {
    return {
      form: {
        username: '',
        email: '',
        description: ''
      }
    }
  },
  
  activated() {
    console.log('è¡¨å•é¡µé¢æ¿€æ´»ï¼Œæ•°æ®ä¿ç•™ï¼š', this.form)
  },
  
  deactivated() {
    // å¯ä»¥åœ¨è¿™é‡Œè‡ªåŠ¨ä¿å­˜è‰ç¨¿
    this.saveDraft()
  },
  
  methods: {
    saveDraft() {
      localStorage.setItem('formDraft', JSON.stringify(this.form))
    }
  }
}
</script>
```

### 7.2 Tabåˆ‡æ¢çŠ¶æ€ä¿ç•™


```vue
<template>
  <div>
    <!-- Tabå¯¼èˆª -->
    <div class="tab-nav">
      <button 
        v-for="tab in tabs" 
        :key="tab.name"
        :class="{ active: currentTab === tab.name }"
        @click="currentTab = tab.name"
      >
        {{ tab.label }}
      </button>
    </div>
    
    <!-- Tabå†…å®¹åŒº -->
    <keep-alive>
      <component :is="currentTab" />
    </keep-alive>
  </div>
</template>

<script>
export default {
  data() {
    return {
      currentTab: 'UserList',
      tabs: [
        { name: 'UserList', label: 'ç”¨æˆ·åˆ—è¡¨' },
        { name: 'OrderList', label: 'è®¢å•åˆ—è¡¨' },
        { name: 'ProductList', label: 'å•†å“åˆ—è¡¨' }
      ]
    }
  },
  components: {
    UserList: () => import('./UserList.vue'),
    OrderList: () => import('./OrderList.vue'),
    ProductList: () => import('./ProductList.vue')
  }
}
</script>
```

### 7.3 åˆ—è¡¨é¡µæ»šåŠ¨ä½ç½®ä¿æŒ


```vue
<template>
  <div class="list-page">
    <div class="search-bar">
      <input v-model="keyword" placeholder="æœç´¢..." />
    </div>
    
    <div class="list-container" ref="listContainer">
      <div 
        v-for="item in filteredList" 
        :key="item.id"
        class="list-item"
      >
        {{ item.name }}
      </div>
    </div>
  </div>
</template>

<script>
export default {
  name: 'ListPage',
  data() {
    return {
      keyword: '',
      list: [],
      scrollTop: 0
    }
  },
  
  computed: {
    filteredList() {
      return this.list.filter(item => 
        item.name.includes(this.keyword)
      )
    }
  },
  
  activated() {
    // æ¢å¤æ»šåŠ¨ä½ç½®
    this.$nextTick(() => {
      if (this.$refs.listContainer) {
        this.$refs.listContainer.scrollTop = this.scrollTop
      }
    })
  },
  
  deactivated() {
    // ä¿å­˜æ»šåŠ¨ä½ç½®
    if (this.$refs.listContainer) {
      this.scrollTop = this.$refs.listContainer.scrollTop
    }
  }
}
</script>
```

---

## 8. âš¡ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥


### 8.1 åˆç†æ§åˆ¶ç¼“å­˜æ•°é‡


```javascript
// âŒ ä¸å¥½çš„åšæ³•ï¼šæ— é™åˆ¶ç¼“å­˜
<keep-alive>
  <router-view />
</keep-alive>

// âœ… å¥½çš„åšæ³•ï¼šé™åˆ¶ç¼“å­˜æ•°é‡
<keep-alive :max="10">
  <router-view />
</keep-alive>
```

> **ğŸ’¡ å»ºè®®ï¼š** æ ¹æ®åº”ç”¨å®é™…æƒ…å†µè®¾ç½®åˆç†çš„maxå€¼ï¼Œä¸€èˆ¬å»ºè®®5-10ä¸ªã€‚

### 8.2 æŒ‰éœ€ç¼“å­˜é‡è¦é¡µé¢


```vue
<template>
  <keep-alive :include="importantPages">
    <router-view />
  </keep-alive>
</template>

<script>
export default {
  data() {
    return {
      // åªç¼“å­˜é‡è¦çš„ã€ç”¨æˆ·é¢‘ç¹è®¿é—®çš„é¡µé¢
      importantPages: [
        'FormPage',     // è¡¨å•é¡µé¢ - é¿å…æ•°æ®ä¸¢å¤±
        'ListPage',     // åˆ—è¡¨é¡µé¢ - ä¿æŒç­›é€‰å’Œæ»šåŠ¨çŠ¶æ€
        'ShoppingCart'  // è´­ç‰©è½¦ - ä¿æŒè´­ä¹°çŠ¶æ€
      ]
    }
  }
}
</script>
```

### 8.3 ç›‘æ§ç¼“å­˜ä½¿ç”¨æƒ…å†µ


```javascript
export default {
  data() {
    return {
      cacheStats: {
        hitCount: 0,    // ç¼“å­˜å‘½ä¸­æ¬¡æ•°
        missCount: 0,   // ç¼“å­˜æœªå‘½ä¸­æ¬¡æ•°
        cacheSize: 0    // å½“å‰ç¼“å­˜å¤§å°
      }
    }
  },
  
  methods: {
    // ç›‘æ§ç¼“å­˜æ€§èƒ½
    trackCachePerformance() {
      const hitRate = this.cacheStats.hitCount / 
        (this.cacheStats.hitCount + this.cacheStats.missCount)
      
      console.log(`ç¼“å­˜å‘½ä¸­ç‡: ${(hitRate * 100).toFixed(2)}%`)
      
      // å¦‚æœå‘½ä¸­ç‡å¤ªä½ï¼Œè¯´æ˜ç¼“å­˜ç­–ç•¥éœ€è¦è°ƒæ•´
      if (hitRate < 0.5) {
        console.warn('ç¼“å­˜å‘½ä¸­ç‡è¾ƒä½ï¼Œå»ºè®®è°ƒæ•´ç¼“å­˜ç­–ç•¥')
      }
    }
  }
}
```

### 8.4 å†…å­˜æ³„æ¼é¢„é˜²


```javascript
export default {
  name: 'CachedComponent',
  
  activated() {
    // é‡æ–°å¯åŠ¨å®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬ç­‰
    this.startTimer()
    this.addEventListeners()
  },
  
  deactivated() {
    // æ¸…ç†å®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
    this.clearTimer()
    this.removeEventListeners()
  },
  
  methods: {
    startTimer() {
      this.timer = setInterval(() => {
        // å®šæ—¶ä»»åŠ¡
      }, 1000)
    },
    
    clearTimer() {
      if (this.timer) {
        clearInterval(this.timer)
        this.timer = null
      }
    },
    
    addEventListeners() {
      window.addEventListener('resize', this.handleResize)
    },
    
    removeEventListeners() {
      window.removeEventListener('resize', this.handleResize)
    }
  }
}
```

---

## 9. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 9.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ keep-aliveæœ¬è´¨ï¼šVueå†…ç½®çš„ç¼“å­˜ç»„ä»¶ï¼Œä¿å­˜ç»„ä»¶å®ä¾‹å’ŒçŠ¶æ€
ğŸ”¸ æ ¸å¿ƒä½œç”¨ï¼šé¿å…é‡å¤åˆ›å»ºé”€æ¯ï¼Œä¿æŒç”¨æˆ·æ“ä½œçŠ¶æ€
ğŸ”¸ ç¼“å­˜æœºåˆ¶ï¼šLRUç®—æ³•ç®¡ç†ç¼“å­˜ï¼Œè¶…å‡ºé™åˆ¶è‡ªåŠ¨æ·˜æ±°æœ€ä¹…æœªç”¨
ğŸ”¸ ç”Ÿå‘½å‘¨æœŸï¼šæ–°å¢activated/deactivatedé’©å­
ğŸ”¸ æ§åˆ¶å±æ€§ï¼šinclude/exclude/maxç²¾ç¡®æ§åˆ¶ç¼“å­˜è¡Œä¸º
```

### 9.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä»€ä¹ˆæ—¶å€™ç”¨keep-alive**
```
æ•°æ®çŠ¶æ€å¾ˆé‡è¦ï¼šè¡¨å•å¡«å†™ã€è´­ç‰©è½¦ã€ç­›é€‰æ¡ä»¶
ç”¨æˆ·ä½“éªŒè¦æ±‚é«˜ï¼šTabåˆ‡æ¢ã€åˆ—è¡¨æ»šåŠ¨ä½ç½®ä¿æŒ
æ€§èƒ½ä¼˜åŒ–éœ€æ±‚ï¼šé¿å…é‡å¤è¯·æ±‚ç›¸åŒæ•°æ®
```

**ğŸ”¹ ç”Ÿå‘½å‘¨æœŸçš„å˜åŒ–**
```
æ™®é€šç»„ä»¶ï¼šcreated â†’ mounted â†’ destroyed
ç¼“å­˜ç»„ä»¶ï¼šcreated â†’ mounted â†’ activated â†” deactivated
```

**ğŸ”¹ æ€§èƒ½ä¼˜åŒ–å¹³è¡¡**
```
ç¼“å­˜å¸¦æ¥å¥½å¤„ï¼š
â€¢ åˆ‡æ¢é€Ÿåº¦å¿«
â€¢ çŠ¶æ€å¾—ä»¥ä¿ç•™
â€¢ å‡å°‘é‡å¤è¯·æ±‚

éœ€è¦æ³¨æ„é—®é¢˜ï¼š
â€¢ å†…å­˜å ç”¨å¢åŠ 
â€¢ æ•°æ®å¯èƒ½è¿‡æ—¶
â€¢ éœ€è¦æ‰‹åŠ¨æ¸…ç†èµ„æº
```

### 9.3 å®é™…åº”ç”¨æŒ‡å¯¼


**âœ… é€‚ç”¨åœºæ™¯**
- ğŸ“ è¡¨å•é¡µé¢ç¼“å­˜
- ğŸ“‹ åˆ—è¡¨é¡µé¢çŠ¶æ€ä¿æŒ
- ğŸ·ï¸ Tabåˆ‡æ¢å†…å®¹ä¿ç•™
- ğŸ›’ è´­ç‰©è½¦ç­‰çŠ¶æ€æ€§é¡µé¢

**âŒ é¿å…åœºæ™¯**
- ğŸ”„ å®æ—¶æ•°æ®å±•ç¤ºé¡µé¢
- ğŸ” ç™»å½•æ³¨å†Œç­‰ä¸€æ¬¡æ€§é¡µé¢
- ğŸ“Š æŠ¥è¡¨ç­‰æ¯æ¬¡éƒ½éœ€è¦æœ€æ–°æ•°æ®çš„é¡µé¢

**âš¡ æ€§èƒ½å»ºè®®**
```javascript
// æ¨èçš„keep-aliveé…ç½®
<keep-alive 
  :include="['FormPage', 'ListPage', 'ShoppingCart']"
  :max="8"
>
  <router-view />
</keep-alive>
```

### 9.4 å¸¸è§é—®é¢˜è§£å†³


**ğŸ”§ ç»„ä»¶nameé—®é¢˜**
```javascript
// âŒ é”™è¯¯ï¼šæ²¡æœ‰nameå±æ€§
export default {
  // ç¼ºå°‘nameï¼Œincludeæ— æ³•åŒ¹é…
}

// âœ… æ­£ç¡®ï¼šæ·»åŠ nameå±æ€§
export default {
  name: 'FormPage', // å¿…é¡»æœ‰nameæ‰èƒ½è¢«includeåŒ¹é…
}
```

**ğŸ”„ æ•°æ®åˆ·æ–°é—®é¢˜**
```javascript
// åœ¨activatedä¸­å¤„ç†æ•°æ®æ›´æ–°
activated() {
  // æ ¹æ®ä¸šåŠ¡éœ€è¦å†³å®šæ˜¯å¦åˆ·æ–°æ•°æ®
  if (this.needRefresh()) {
    this.fetchData()
  }
}
```

**æ ¸å¿ƒè®°å¿†**ï¼š
- keep-aliveæ˜¯ç»„ä»¶ä¿é²œç›’ï¼ŒçŠ¶æ€ä¸ä¸¢å¤±
- activatedæ¿€æ´»æ—¶ã€deactivatedç¼“å­˜æ—¶
- includeåŒ…å«ã€excludeæ’é™¤ã€maxé™æ•°é‡
- è¡¨å•Tabåˆ—è¡¨ç”¨ï¼Œå®æ—¶ç™»å½•ä¸é€‚ç”¨