---
title: 2ã€Composition APIè¿›é˜¶åº”ç”¨
---
## ğŸ“š ç›®å½•

1. [Composition APIæ ¸å¿ƒç†å¿µ](#1-composition-apiæ ¸å¿ƒç†å¿µ)
2. [é€»è¾‘å¤ç”¨ä¸æŠ½å–](#2-é€»è¾‘å¤ç”¨ä¸æŠ½å–)
3. [è‡ªå®šä¹‰Hookç¼–å†™](#3-è‡ªå®šä¹‰hookç¼–å†™)
4. [ç»„åˆå¼å‡½æ•°è®¾è®¡æ¨¡å¼](#4-ç»„åˆå¼å‡½æ•°è®¾è®¡æ¨¡å¼)
5. [TypeScripté›†æˆå®è·µ](#5-typescripté›†æˆå®è·µ)
6. [ç»„åˆå¼APIæœ€ä½³å®è·µ](#6-ç»„åˆå¼apiæœ€ä½³å®è·µ)
7. [æ ¸å¿ƒè¦ç‚¹æ€»ç»“](#7-æ ¸å¿ƒè¦ç‚¹æ€»ç»“)

---

## 1. ğŸ¯ Composition APIæ ¸å¿ƒç†å¿µ


### 1.1 ä»€ä¹ˆæ˜¯Composition API

**ç®€å•ç†è§£**ï¼šComposition APIå°±æ˜¯æŠŠVue2ä¸­åˆ†æ•£åœ¨ä¸åŒé€‰é¡¹é‡Œçš„ä»£ç ï¼Œæ•´åˆåˆ°ä¸€ä¸ª`setup()`å‡½æ•°ä¸­ç®¡ç†ã€‚

```
Vue2çš„å†™æ³•ï¼š                   Vue3çš„å†™æ³•ï¼š
data() { return {...} }        setup() {
methods: {...}          â†’       const data = ref(...)
computed: {...}                 const method = () => {...}
watch: {...}                    const computed = computed(...)
                               return { data, method, computed }
                              }
```

**ğŸ’¡ æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- ğŸ”¸ **é€»è¾‘èšåˆ**ï¼šç›¸å…³åŠŸèƒ½çš„ä»£ç å†™åœ¨ä¸€èµ·ï¼Œè€Œä¸æ˜¯åˆ†æ•£åœ¨å„ä¸ªé€‰é¡¹ä¸­
- ğŸ”¸ **æ›´å¥½å¤ç”¨**ï¼šæŠŠé€»è¾‘å°è£…æˆå‡½æ•°ï¼Œå¯ä»¥åœ¨å¤šä¸ªç»„ä»¶é—´å¤ç”¨
- ğŸ”¸ **ç±»å‹æ”¯æŒ**ï¼šå¯¹TypeScriptæ›´å‹å¥½ï¼Œç±»å‹æ¨å¯¼æ›´å‡†ç¡®

### 1.2 ä¸ºä»€ä¹ˆéœ€è¦Composition API


**Vue2çš„ç—›ç‚¹**ï¼š
```javascript
// Vue2ä¸­ä¸€ä¸ªå¤æ‚ç»„ä»¶çš„ç»“æ„
export default {
  data() {
    return {
      userInfo: {},     // ç”¨æˆ·ç›¸å…³æ•°æ®
      todoList: [],     // å¾…åŠäº‹é¡¹æ•°æ®
      loading: false    // åŠ è½½çŠ¶æ€
    }
  },
  methods: {
    getUserInfo() {...},    // ç”¨æˆ·ç›¸å…³æ–¹æ³•
    addTodo() {...},        // å¾…åŠäº‹é¡¹æ–¹æ³•
    setLoading() {...}      // åŠ è½½çŠ¶æ€æ–¹æ³•
  },
  computed: {
    userName() {...},       // ç”¨æˆ·ç›¸å…³è®¡ç®—å±æ€§
    todoCount() {...}       // å¾…åŠäº‹é¡¹è®¡ç®—å±æ€§
  }
  // åŒä¸€ä¸ªåŠŸèƒ½çš„ä»£ç æ•£è½åœ¨ä¸åŒåœ°æ–¹ï¼
}
```

**Composition APIçš„è§£å†³æ–¹æ¡ˆ**ï¼š
```javascript
// Vue3ä¸­åŒæ ·åŠŸèƒ½çš„ç»„ç»‡æ–¹å¼
export default {
  setup() {
    // ç”¨æˆ·ç›¸å…³é€»è¾‘èšåˆåœ¨ä¸€èµ·
    const { userInfo, userName, getUserInfo } = useUser()
    
    // å¾…åŠäº‹é¡¹é€»è¾‘èšåˆåœ¨ä¸€èµ·
    const { todoList, todoCount, addTodo } = useTodo()
    
    // åŠ è½½çŠ¶æ€é€»è¾‘
    const { loading, setLoading } = useLoading()
    
    return {
      userInfo, userName, getUserInfo,
      todoList, todoCount, addTodo,
      loading, setLoading
    }
  }
}
```

---

## 2. ğŸ”„ é€»è¾‘å¤ç”¨ä¸æŠ½å–


### 2.1 é€»è¾‘æŠ½å–çš„åŸºæœ¬æ€è·¯


**æ ¸å¿ƒæ¦‚å¿µ**ï¼šæŠŠç»„ä»¶ä¸­é‡å¤ä½¿ç”¨çš„é€»è¾‘æå–å‡ºæ¥ï¼Œå°è£…æˆç‹¬ç«‹çš„å‡½æ•°ã€‚

```
åŸæ¥çš„ç»„ä»¶A:          æŠ½å–å:              åŸæ¥çš„ç»„ä»¶B:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚è®¡æ•°å™¨é€»è¾‘   â”‚  â†’   â”‚useCounter() â”‚  â†   â”‚è®¡æ•°å™¨é€»è¾‘   â”‚
â”‚+å…¶ä»–é€»è¾‘    â”‚      â”‚ç‹¬ç«‹å‡½æ•°     â”‚      â”‚+å…¶ä»–é€»è¾‘    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 å®é™…æŠ½å–ç¤ºä¾‹


**åŸå§‹ç»„ä»¶ï¼ˆé‡å¤é€»è¾‘ï¼‰**ï¼š
```javascript
// ç»„ä»¶Aï¼šç”¨æˆ·è®¡æ•°å™¨
export default {
  setup() {
    const count = ref(0)
    const increment = () => count.value++
    const decrement = () => count.value--
    const reset = () => count.value = 0
    
    // ...å…¶ä»–é€»è¾‘
    
    return { count, increment, decrement, reset }
  }
}

// ç»„ä»¶Bï¼šå•†å“è®¡æ•°å™¨ï¼ˆå®Œå…¨ç›¸åŒçš„é€»è¾‘ï¼ï¼‰
export default {
  setup() {
    const count = ref(0)
    const increment = () => count.value++
    const decrement = () => count.value--
    const reset = () => count.value = 0
    
    // ...å…¶ä»–é€»è¾‘
    
    return { count, increment, decrement, reset }
  }
}
```

**æŠ½å–åçš„å¤ç”¨å‡½æ•°**ï¼š
```javascript
// composables/useCounter.js
import { ref } from 'vue'

export function useCounter(initialValue = 0) {
  const count = ref(initialValue)
  
  const increment = () => {
    count.value++
  }
  
  const decrement = () => {
    count.value--
  }
  
  const reset = () => {
    count.value = initialValue
  }
  
  return {
    count,
    increment,
    decrement,
    reset
  }
}
```

**ä½¿ç”¨æŠ½å–åçš„å‡½æ•°**ï¼š
```javascript
// ç»„ä»¶A
import { useCounter } from '@/composables/useCounter'

export default {
  setup() {
    const { count, increment, decrement, reset } = useCounter(0)
    
    // ...ä¸“æ³¨äºç»„ä»¶Aç‰¹æœ‰çš„é€»è¾‘
    
    return { count, increment, decrement, reset }
  }
}

// ç»„ä»¶B
import { useCounter } from '@/composables/useCounter'

export default {
  setup() {
    const { count, increment, decrement, reset } = useCounter(10) // ä¸åŒåˆå§‹å€¼
    
    // ...ä¸“æ³¨äºç»„ä»¶Bç‰¹æœ‰çš„é€»è¾‘
    
    return { count, increment, decrement, reset }
  }
}
```

---

## 3. ğŸª è‡ªå®šä¹‰Hookç¼–å†™


### 3.1 ä»€ä¹ˆæ˜¯è‡ªå®šä¹‰Hook


**ç®€å•ç†è§£**ï¼šè‡ªå®šä¹‰Hookå°±æ˜¯ä»¥`use`å¼€å¤´çš„å‡½æ•°ï¼Œé‡Œé¢åŒ…å«äº†å¯å¤ç”¨çš„å“åº”å¼é€»è¾‘ã€‚

```
æ™®é€šå‡½æ•°:                   è‡ªå®šä¹‰Hook:
function getData() {        function useData() {
  // æ™®é€šé€»è¾‘                 // å“åº”å¼é€»è¾‘
  return data               // åŒ…å«refã€computedã€watchç­‰
}                          // è¿”å›å“åº”å¼æ•°æ®å’Œæ–¹æ³•
                          }
```

### 3.2 ç¼–å†™å®ç”¨çš„è‡ªå®šä¹‰Hook


**ğŸ’¡ ç”¨æˆ·ä¿¡æ¯ç®¡ç†Hook**ï¼š
```javascript
// composables/useUser.js
import { ref, computed } from 'vue'

export function useUser() {
  // å“åº”å¼æ•°æ®
  const userInfo = ref({
    name: '',
    age: 0,
    email: ''
  })
  
  const isLoggedIn = ref(false)
  
  // è®¡ç®—å±æ€§
  const displayName = computed(() => {
    return userInfo.value.name || 'æ¸¸å®¢'
  })
  
  const isAdult = computed(() => {
    return userInfo.value.age >= 18
  })
  
  // æ–¹æ³•
  const login = (user) => {
    userInfo.value = user
    isLoggedIn.value = true
  }
  
  const logout = () => {
    userInfo.value = { name: '', age: 0, email: '' }
    isLoggedIn.value = false
  }
  
  const updateAge = (newAge) => {
    userInfo.value.age = newAge
  }
  
  return {
    // æ•°æ®
    userInfo,
    isLoggedIn,
    // è®¡ç®—å±æ€§
    displayName,
    isAdult,
    // æ–¹æ³•
    login,
    logout,
    updateAge
  }
}
```

**âš¡ å¼‚æ­¥æ•°æ®è·å–Hook**ï¼š
```javascript
// composables/useApi.js
import { ref } from 'vue'

export function useApi(apiFunction) {
  const data = ref(null)
  const loading = ref(false)
  const error = ref(null)
  
  const execute = async (...args) => {
    try {
      loading.value = true
      error.value = null
      
      const result = await apiFunction(...args)
      data.value = result
      
    } catch (err) {
      error.value = err.message
    } finally {
      loading.value = false
    }
  }
  
  const reset = () => {
    data.value = null
    error.value = null
    loading.value = false
  }
  
  return {
    data,
    loading,
    error,
    execute,
    reset
  }
}
```

**ä½¿ç”¨è‡ªå®šä¹‰Hook**ï¼š
```javascript
// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
import { useUser } from '@/composables/useUser'
import { useApi } from '@/composables/useApi'

export default {
  setup() {
    // ç”¨æˆ·ç®¡ç†
    const { userInfo, displayName, login, logout } = useUser()
    
    // APIè°ƒç”¨
    const { data: posts, loading, execute: fetchPosts } = useApi(fetchPostsApi)
    
    // ç»„ä»¶æŒ‚è½½æ—¶è·å–æ•°æ®
    onMounted(() => {
      fetchPosts()
    })
    
    return {
      userInfo,
      displayName,
      login,
      logout,
      posts,
      loading
    }
  }
}
```

### 3.3 Hookç¼–å†™æœ€ä½³å®è·µ


**ğŸ“‹ å‘½åè§„èŒƒ**ï¼š
- âœ… ä»¥`use`å¼€å¤´ï¼š`useCounter`ã€`useUser`ã€`useApi`
- âœ… è§åçŸ¥æ„ï¼š`useLocalStorage`ã€`useDebounce`
- âŒ é¿å…ï¼š`getUser`ã€`counterHook`

**ğŸ”§ è¿”å›å€¼è§„èŒƒ**ï¼š
```javascript
// âœ… å¥½çš„åšæ³•ï¼šè¿”å›å¯¹è±¡ï¼Œä¾¿äºæŒ‰éœ€ä½¿ç”¨
export function useCounter() {
  return {
    count,
    increment,
    decrement,
    reset
  }
}

// âŒ ä¸å¥½çš„åšæ³•ï¼šè¿”å›æ•°ç»„ï¼Œä½¿ç”¨æ—¶ä¸å¤Ÿæ¸…æ™°
export function useCounter() {
  return [count, increment, decrement, reset]
}
```

---

## 4. ğŸ¨ ç»„åˆå¼å‡½æ•°è®¾è®¡æ¨¡å¼


### 4.1 å•ä¸€èŒè´£æ¨¡å¼


**æ ¸å¿ƒç†å¿µ**ï¼šæ¯ä¸ªç»„åˆå¼å‡½æ•°åªè´Ÿè´£ä¸€ä¸ªæ˜ç¡®çš„åŠŸèƒ½ã€‚

```javascript
// âœ… å¥½çš„è®¾è®¡ï¼šä¸“æ³¨å•ä¸€åŠŸèƒ½
export function useLocalStorage(key, defaultValue) {
  // åªå¤„ç†æœ¬åœ°å­˜å‚¨ç›¸å…³é€»è¾‘
}

export function useValidation(rules) {
  // åªå¤„ç†è¡¨å•éªŒè¯é€»è¾‘
}

// âŒ ä¸å¥½çš„è®¾è®¡ï¼šåŠŸèƒ½æ··æ‚
export function useUserForm() {
  // æ—¢å¤„ç†ç”¨æˆ·æ•°æ®ï¼Œåˆå¤„ç†æœ¬åœ°å­˜å‚¨ï¼Œåˆå¤„ç†éªŒè¯...
}
```

### 4.2 ç»„åˆå¼è®¾è®¡æ¨¡å¼


**å¤šä¸ªHookç»„åˆä½¿ç”¨**ï¼š
```javascript
// è¡¨å•ç»„ä»¶ä¸­ç»„åˆå¤šä¸ªHook
export default {
  setup() {
    // è¡¨å•æ•°æ®ç®¡ç†
    const { formData, updateField, resetForm } = useForm({
      name: '',
      email: ''
    })
    
    // è¡¨å•éªŒè¯
    const { errors, validate, isValid } = useValidation({
      name: { required: true, minLength: 2 },
      email: { required: true, email: true }
    })
    
    // æ•°æ®æŒä¹…åŒ–
    const { save, load } = useLocalStorage('userForm', formData)
    
    // æäº¤é€»è¾‘
    const handleSubmit = async () => {
      if (validate(formData.value)) {
        await save()
        // æäº¤åˆ°æœåŠ¡å™¨...
      }
    }
    
    return {
      formData,
      errors,
      isValid,
      updateField,
      handleSubmit
    }
  }
}
```

### 4.3 å“åº”å¼ä¾èµ–æ¨¡å¼


**Hookä¹‹é—´çš„å“åº”å¼è¿æ¥**ï¼š
```javascript
// useSearch.js - æœç´¢åŠŸèƒ½Hook
export function useSearch() {
  const keyword = ref('')
  const results = ref([])
  
  // ç›‘å¬å…³é”®è¯å˜åŒ–ï¼Œè‡ªåŠ¨æœç´¢
  watch(keyword, async (newKeyword) => {
    if (newKeyword.trim()) {
      results.value = await searchApi(newKeyword)
    } else {
      results.value = []
    }
  })
  
  return {
    keyword,
    results
  }
}

// useFilter.js - è¿‡æ»¤åŠŸèƒ½Hook
export function useFilter(sourceData) {
  const filterType = ref('all')
  
  const filteredData = computed(() => {
    if (filterType.value === 'all') {
      return sourceData.value
    }
    return sourceData.value.filter(item => item.type === filterType.value)
  })
  
  return {
    filterType,
    filteredData
  }
}

// åœ¨ç»„ä»¶ä¸­ç»„åˆä½¿ç”¨
export default {
  setup() {
    const { keyword, results } = useSearch()
    const { filterType, filteredData } = useFilter(results) // ä¾èµ–æœç´¢ç»“æœ
    
    return {
      keyword,
      filterType,
      filteredData // æœ€ç»ˆå±•ç¤ºçš„æ•°æ®
    }
  }
}
```

---

## 5. ğŸ“ TypeScripté›†æˆå®è·µ


### 5.1 åŸºæœ¬ç±»å‹æ”¯æŒ


**ç±»å‹å®šä¹‰ç¤ºä¾‹**ï¼š
```typescript
// types/user.ts
export interface User {
  id: number
  name: string
  email: string
  age?: number
}

// composables/useUser.ts
import { ref, computed, type Ref } from 'vue'
import type { User } from '@/types/user'

export function useUser() {
  const userInfo: Ref<User | null> = ref(null)
  const isLoggedIn = ref(false)
  
  const displayName = computed((): string => {
    return userInfo.value?.name ?? 'æ¸¸å®¢'
  })
  
  const login = (user: User): void => {
    userInfo.value = user
    isLoggedIn.value = true
  }
  
  const logout = (): void => {
    userInfo.value = null
    isLoggedIn.value = false
  }
  
  return {
    userInfo,
    isLoggedIn,
    displayName,
    login,
    logout
  }
}
```

### 5.2 æ³›å‹Hookè®¾è®¡


**é€šç”¨APIè°ƒç”¨Hook**ï¼š
```typescript
// composables/useApi.ts
export function useApi<T = any, P extends any[] = any[]>(
  apiFunction: (...args: P) => Promise<T>
) {
  const data: Ref<T | null> = ref(null)
  const loading = ref(false)
  const error: Ref<string | null> = ref(null)
  
  const execute = async (...args: P): Promise<void> => {
    try {
      loading.value = true
      error.value = null
      
      const result = await apiFunction(...args)
      data.value = result
      
    } catch (err) {
      error.value = err instanceof Error ? err.message : 'Unknown error'
    } finally {
      loading.value = false
    }
  }
  
  return {
    data: readonly(data),
    loading: readonly(loading),
    error: readonly(error),
    execute
  } as const
}
```

**ä½¿ç”¨æ³›å‹Hook**ï¼š
```typescript
// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
import type { Post } from '@/types/post'

export default defineComponent({
  setup() {
    // TypeScriptä¼šè‡ªåŠ¨æ¨å¯¼ç±»å‹
    const { data: posts, loading, execute: fetchPosts } = useApi<Post[]>(getPostsApi)
    
    onMounted(() => {
      fetchPosts()
    })
    
    return {
      posts, // ç±»å‹ä¸º Readonly<Ref<Post[] | null>>
      loading,
      fetchPosts
    }
  }
})
```

### 5.3 ç±»å‹çº¦æŸä¸éªŒè¯


**å¸¦çº¦æŸçš„Hookè®¾è®¡**ï¼š
```typescript
// å­˜å‚¨Hookçš„ç±»å‹çº¦æŸ
export function useLocalStorage<T>(
  key: string,
  defaultValue: T,
  serializer = JSON
) {
  const storedValue = ref<T>(defaultValue)
  
  const setValue = (value: T | ((prev: T) => T)): void => {
    const newValue = typeof value === 'function' 
      ? (value as (prev: T) => T)(storedValue.value)
      : value
      
    storedValue.value = newValue
    localStorage.setItem(key, serializer.stringify(newValue))
  }
  
  return {
    value: storedValue,
    setValue
  }
}
```

---

## 6. ğŸš€ ç»„åˆå¼APIæœ€ä½³å®è·µ


### 6.1 ä»£ç ç»„ç»‡åŸåˆ™


**ğŸ“ æ–‡ä»¶ç»“æ„**ï¼š
```
src/
â”œâ”€â”€ composables/          # ç»„åˆå¼å‡½æ•°
â”‚   â”œâ”€â”€ useUser.js       # ç”¨æˆ·ç›¸å…³
â”‚   â”œâ”€â”€ useApi.js        # APIè°ƒç”¨
â”‚   â”œâ”€â”€ useStorage.js    # æœ¬åœ°å­˜å‚¨
â”‚   â””â”€â”€ index.js         # ç»Ÿä¸€å¯¼å‡º
â”œâ”€â”€ components/          # ç»„ä»¶
â””â”€â”€ views/              # é¡µé¢
```

**ğŸ”„ é€»è¾‘åˆ†å±‚**ï¼š
```javascript
// ç»„ä»¶ä¸­çš„é€»è¾‘åˆ†å±‚
export default {
  setup() {
    // 1. æ•°æ®å±‚ï¼šåŸºç¡€æ•°æ®ç®¡ç†
    const { user, login, logout } = useUser()
    const { posts, loading } = useApi(fetchPosts)
    
    // 2. ä¸šåŠ¡å±‚ï¼šä¸šåŠ¡é€»è¾‘å¤„ç†
    const handleUserLogin = async (credentials) => {
      await login(credentials)
      // ç™»å½•æˆåŠŸåè·å–ç”¨æˆ·ç›¸å…³æ•°æ®
      await fetchUserPosts()
    }
    
    // 3. è¡¨ç°å±‚ï¼šUIäº¤äº’é€»è¾‘
    const showLoginDialog = ref(false)
    const toggleLoginDialog = () => {
      showLoginDialog.value = !showLoginDialog.value
    }
    
    return {
      // æ•°æ®
      user, posts, loading,
      // ä¸šåŠ¡æ–¹æ³•
      handleUserLogin,
      // UIçŠ¶æ€
      showLoginDialog, toggleLoginDialog
    }
  }
}
```

### 6.2 æ€§èƒ½ä¼˜åŒ–æŠ€å·§


**ğŸ’¡ æŒ‰éœ€è¿”å›**ï¼š
```javascript
// âœ… å¥½çš„åšæ³•ï¼šæŒ‰éœ€è¿”å›ï¼Œé¿å…ä¸å¿…è¦çš„å“åº”å¼
export function useUser() {
  const userInfo = ref({})
  const isLoggedIn = ref(false)
  
  // è¿”å›å¯¹è±¡ï¼Œä½¿ç”¨è€…å¯ä»¥æŒ‰éœ€é€‰æ‹©
  return {
    userInfo: readonly(userInfo), // åªè¯»ä¿æŠ¤
    isLoggedIn: readonly(isLoggedIn),
    login,
    logout
  }
}

// ä½¿ç”¨æ—¶æŒ‰éœ€è§£æ„
const { isLoggedIn, login } = useUser() // åªä½¿ç”¨éœ€è¦çš„éƒ¨åˆ†
```

**âš¡ è®¡ç®—å±æ€§ä¼˜åŒ–**ï¼š
```javascript
// åˆç†ä½¿ç”¨computedï¼Œé¿å…é‡å¤è®¡ç®—
export function useShoppingCart() {
  const items = ref([])
  
  // ç¼“å­˜è®¡ç®—ç»“æœ
  const totalPrice = computed(() => {
    return items.value.reduce((sum, item) => sum + item.price * item.quantity, 0)
  })
  
  const itemCount = computed(() => {
    return items.value.reduce((sum, item) => sum + item.quantity, 0)
  })
  
  return {
    items,
    totalPrice,
    itemCount
  }
}
```

### 6.3 é”™è¯¯å¤„ç†æ¨¡å¼


**ğŸ›¡ï¸ ç»Ÿä¸€é”™è¯¯å¤„ç†**ï¼š
```javascript
// composables/useErrorHandler.js
export function useErrorHandler() {
  const error = ref(null)
  
  const handleError = (err) => {
    console.error('Error caught:', err)
    error.value = err.message || 'Unknown error'
    
    // å¯ä»¥é›†æˆé”™è¯¯ä¸ŠæŠ¥æœåŠ¡
    // errorReportService.report(err)
  }
  
  const clearError = () => {
    error.value = null
  }
  
  return {
    error: readonly(error),
    handleError,
    clearError
  }
}

// åœ¨å…¶ä»–Hookä¸­ä½¿ç”¨
export function useApi(apiFunction) {
  const { handleError } = useErrorHandler()
  
  const execute = async (...args) => {
    try {
      // APIè°ƒç”¨é€»è¾‘
    } catch (err) {
      handleError(err) // ç»Ÿä¸€é”™è¯¯å¤„ç†
    }
  }
  
  return { execute }
}
```

---

## 7. ğŸ“‹ æ ¸å¿ƒè¦ç‚¹æ€»ç»“


### 7.1 å¿…é¡»æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ


```
ğŸ”¸ Composition APIæœ¬è´¨ï¼šæŠŠåˆ†æ•£çš„é€»è¾‘èšåˆåˆ°setup()ä¸­ç®¡ç†
ğŸ”¸ é€»è¾‘å¤ç”¨ï¼šé€šè¿‡å‡½æ•°æŠ½å–å®ç°ä»£ç å¤ç”¨ï¼Œæé«˜å¼€å‘æ•ˆç‡
ğŸ”¸ è‡ªå®šä¹‰Hookï¼šä»¥useå¼€å¤´çš„å‡½æ•°ï¼ŒåŒ…å«å“åº”å¼é€»è¾‘
ğŸ”¸ ç»„åˆå¼è®¾è®¡ï¼šå¤šä¸ªHookç»„åˆä½¿ç”¨ï¼Œå®ç°å¤æ‚åŠŸèƒ½
ğŸ”¸ TypeScripté›†æˆï¼šæ›´å¥½çš„ç±»å‹æ”¯æŒï¼Œæå‡å¼€å‘ä½“éªŒ
```

### 7.2 å…³é”®ç†è§£è¦ç‚¹


**ğŸ”¹ ä»€ä¹ˆæ—¶å€™ä½¿ç”¨Composition API**ï¼š
```
é€‚ç”¨åœºæ™¯ï¼š
âœ… é€»è¾‘å¤æ‚çš„ç»„ä»¶ï¼ˆä¾¿äºç»„ç»‡ä»£ç ï¼‰
âœ… éœ€è¦å¤ç”¨çš„é€»è¾‘ï¼ˆæŠ½å–ä¸ºHookï¼‰
âœ… TypeScripté¡¹ç›®ï¼ˆæ›´å¥½çš„ç±»å‹æ”¯æŒï¼‰
âœ… å¤§å‹é¡¹ç›®ï¼ˆæ›´å¥½çš„ä»£ç ç»„ç»‡ï¼‰

Options APIä»ç„¶é€‚ç”¨ï¼š
âœ… ç®€å•ç»„ä»¶ï¼ˆæ— éœ€è¿‡åº¦è®¾è®¡ï¼‰
âœ… å­¦ä¹ é˜¶æ®µï¼ˆé™ä½è®¤çŸ¥è´Ÿæ‹…ï¼‰
âœ… å›¢é˜Ÿä¹ æƒ¯ï¼ˆæ¸è¿›å¼è¿ç§»ï¼‰
```

**ğŸ”¹ Hookè®¾è®¡åŸåˆ™**ï¼š
```
å•ä¸€èŒè´£ï¼šä¸€ä¸ªHookåªåšä¸€ä»¶äº‹
å‘½åæ¸…æ™°ï¼šuse + åŠŸèƒ½åç§°
è¿”å›å¯¹è±¡ï¼šä¾¿äºæŒ‰éœ€ä½¿ç”¨
ç±»å‹å‹å¥½ï¼šé…åˆTypeScriptä½¿ç”¨
```

### 7.3 å®é™…åº”ç”¨ä»·å€¼


- **ğŸ¯ ä»£ç ç»„ç»‡**ï¼šç›¸å…³é€»è¾‘èšåˆï¼Œæé«˜ä»£ç å¯è¯»æ€§
- **â™»ï¸ é€»è¾‘å¤ç”¨**ï¼šä¸€æ¬¡ç¼–å†™ï¼Œå¤šå¤„ä½¿ç”¨ï¼Œå‡å°‘é‡å¤ä»£ç 
- **ğŸ”§ æ›´å¥½ç»´æŠ¤**ï¼šåŠŸèƒ½ç‹¬ç«‹ï¼Œä¿®æ”¹å½±å“èŒƒå›´å°
- **ğŸ“ˆ å¼€å‘æ•ˆç‡**ï¼šä¸°å¯Œçš„ç”Ÿæ€Hookï¼Œå¿«é€Ÿå®ç°åŠŸèƒ½
- **ğŸ›¡ï¸ ç±»å‹å®‰å…¨**ï¼šTypeScriptæ”¯æŒï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯

**ğŸ’¡ è®°å¿†è¦ç‚¹**ï¼š
- Composition API = é€»è¾‘èšåˆ + æ›´å¥½å¤ç”¨
- è‡ªå®šä¹‰Hook = useå¼€å¤´ + å“åº”å¼é€»è¾‘
- ç»„åˆè®¾è®¡ = å¤šä¸ªHook + ååŒå·¥ä½œ
- TypeScript = æ›´å¥½ä½“éªŒ + ç±»å‹å®‰å…¨